[
    {
        "content": "[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P4088)\n\n> \u9898\u610f\uff1a\u6709\u4e00\u4e2a\u6570\u8f74\uff0c\u4e0a\u9762\u6709 $n$ \u4e2a\u4f20\u9001\u95e8\uff0c\u4f7f\u7528\u7b2c $i$ \u4e2a\u4f20\u9001\u95e8\uff0c\u4f60\u53ef\u4ee5\u4ece $x_i$ \u8d70\u5230 $y_i$\uff0c\u82b1\u8d39\u7684\u65f6\u95f4\u4e3a $t_i$ \u79d2\u3002\u4f60\u7684\u901f\u5ea6\u4e3a $1$ \u683c/\u79d2\uff0c\u6709 $m$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u4f60\u8981\u4ece $a_i$ \u8d70\u5230 $b_i$\uff0c\u6700\u591a\u4f7f\u7528\u4e00\u6b21\u4f20\u9001\u95e8\uff0c\u95ee\u6700\u5c11\u9700\u8981\u591a\u5c11\u79d2\u3002\n\n> $1 \\leq n,m \\leq 10^5$\uff0c$0 \\leq a_i,b_i \\leq 10^9$\n\n\u6211\u679c\u7136\u662f\u8981\u9000\u5f79\u4e86\uff0c\u7528\u672a\u53bb\u91cd\u7684\u6570\u7ec4\u79bb\u6563\u5316\uff08\n\n\u5f88\u663e\u7136\u5bf9\u4e8e\u7b2c $j$ \u4e2a\u8be2\u95ee\u4f7f\u7528\u7b2c $i$ \u4e2a\u4f20\u9001\u95e8\u7684\u60c5\u51b5\uff0c\u9700\u8981 $|x_i-a_j|+|y_i-b_j|+t_i$ \u79d2\u7684\u65f6\u95f4\u3002\u770b\u90a3\u4e2a\u7edd\u5bf9\u503c\u6709\u70b9\u50cf\u66fc\u54c8\u987f\u8ddd\u79bb\u2026\u2026\u8fd9\u5c31\u542f\u53d1\u6211\u4eec\u5c06\u9898\u76ee\u8f6c\u6362\u4e3a\uff1a\u5e73\u9762\u4e0a\u6709 $n$ \u4e2a\u70b9\uff0c\u7b2c $i$ \u4e2a\u70b9\u4f4d\u4e8e $(x_i,y_i)$\uff0c\u6709\u70b9\u6743 $t_i$\u3002\u6709 $m$ \u6b21\u8be2\u95ee\uff0c\u8981\u6c42\u4e0e $(a_i,b_i)$ \u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u52a0\u4e0a\u70b9\u7684\u6743\u503c\u6700\u5c0f\u7684\u70b9\u3002\n\n\u4e3a\u4ec0\u4e48\u8981\u8fd9\u4e48\u8f6c\u5316\u5462\uff1f\u770b\u5230\u5e73\u9762\uff0c\u6211\u4eec\u5c31\u60f3\u5230\u4e8c\u7ef4\u6570\u70b9\u3002\u5c06\u8fd9 $n+m$ \u4e2a\u70b9\u6309 $x$ \u5750\u6807\u6392\u5e8f\uff0c\u66b4\u529b\u5c06\u7edd\u5bf9\u503c\u62c6\u5f00\uff0c\u5206\u56db\u79cd\u60c5\u51b5\u66f4\u65b0\u7b54\u6848\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u6ce8\u610f\u4e8b\u9879\uff1a\u5bf9\u6bcf\u4e2a\u8be2\u95ee\uff0c\u8bb0\u5f97\u8d4b\u521d\u503c $|b_i-a_i|$\n\n```cpp\n//Coded by tzc_wk\n/*\n\u6570\u636e\u4e0d\u6e05\u7a7a\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u591a\u6d4b\u4e0d\u8bfb\u5b8c\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8fb9\u754c\u4e0d\u7279\u5224\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8d2a\u5fc3\u4e0d\u8bc1\u660e\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\nD P \u987a\u5e8f\u9519\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u5927\u5c0f\u5c11\u7b49\u53f7\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u53d8\u91cf\u4e0d\u7edf\u4e00\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8d8a\u754c\u4e0d\u5224\u65ad\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8c03\u8bd5\u4e0d\u6ce8\u91ca\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u6ea2\u51fa\u4e0d l l\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n*/\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi\t\t\tfirst\n#define se\t\t\tsecond\n#define fz(i,a,b)\tfor(int i=a;i<=b;i++)\n#define fd(i,a,b)\tfor(int i=a;i>=b;i--)\n#define foreach(it,v) for(__typeof(v.begin()) it=v.begin();it!=v.end();it++)\n#define all(a)\t\ta.begin(),a.end()\n#define giveup(...) return printf(__VA_ARGS__),0;\n#define fill0(a)\tmemset(a,0,sizeof(a))\n#define fill1(a)\tmemset(a,-1,sizeof(a))\n#define fillbig(a)\tmemset(a,0x3f,sizeof(a))\n#define fillsmall(a) memset(a,0xcf,sizeof(a))\n#define mask(a)\t\t(1ll<<(a))\n#define maskx(a,x)\t((a)<<(x))\n#define _bit(a,x)\t(((a)>>(x))&1)\n#define _sz(a)\t\t((int)(a).size())\n#define filei(a)\tfreopen(a,\"r\",stdin);\n#define fileo(a)\tfreopen(a,\"w\",stdout);\n#define fileio(a) \tfreopen(a\".in\",\"r\",stdin);freopen(a\".out\",\"w\",stdout)\n#define eprintf(...) fprintf(stderr,__VA_ARGS__)\n#define put(x)\t\tputchar(x)\n#define eoln        put('\\n')\n#define space\t\tput(' ')\n#define y1\t\t\ty_chenxiaoyan_1\n#define y0\t\t\ty_chenxiaoyan_0\n#define int long long\ntypedef pair<int,int> pii;\ninline int read(){\n\tint x=0,neg=1;char c=getchar();\n\twhile(!isdigit(c)){\n\t\tif(c=='-')\tneg=-1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c))\tx=x*10+c-'0',c=getchar();\n\treturn x*neg;\n}\ninline void print(int x){\n\tif(x<0){\n\t\tputchar('-');\n\t\tprint(abs(x));\n\t\treturn;\n\t}\n\tif(x<=9)\tputchar(x+'0');\n\telse{\n\t\tprint(x/10);\n\t\tputchar(x%10+'0');\n\t}\n}\ninline int qpow(int x,int e,int _MOD){\n\tint ans=1;\n\twhile(e){\n\t\tif(e&1)\tans=ans*x%_MOD;\n\t\tx=x*x%_MOD;\n\t\te>>=1;\n\t}\n\treturn ans;\n}\nint _abs(int x){\n\treturn (x<0)?-x:x;\n}\nint n,m;\nstruct ycxakioi{\n\tint x,y,t;\n\tfriend bool operator <(ycxakioi ycx,ycxakioi tzc){\n\t\treturn ycx.x<tzc.x;\n\t}\n} p[200005];\nstruct query{\n\tint x,y,id,ans;\n\tfriend bool operator <(query x,query y){\n\t\treturn x.x<y.x;\n\t}\n} q[200005];\nint keyx[200005],xc,yc,keyy[200005],hsx[200005],cx,hsy[200005],cy;\nstruct SegTree{\n\tstruct node{\n\t\tint l,r,mn;\n\t} s[200005<<2];\n\tinline void init(){\n\t\tfz(i,0,(200005<<2)-1)\ts[i].mn=0x3f3f3f3f3f3f3f3fll;\n\t}\n\tinline void build(int k,int l,int r){\n\t\ts[k].l=l;s[k].r=r;\n\t\tif(l==r)\treturn;\n\t\tint mid=(l+r)>>1;\n\t\tbuild(k<<1,l,mid);\n\t\tbuild(k<<1|1,mid+1,r);\n\t}\n\tinline void modify(int k,int ind,int x){\n\t\tif(s[k].l==s[k].r){\n\t\t\ts[k].mn=min(s[k].mn,x);\n\t\t\treturn;\n\t\t}\n\t\tint mid=(s[k].l+s[k].r)>>1;\n\t\tif(ind<=mid)\tmodify(k<<1,ind,x);\n\t\telse\t\t\tmodify(k<<1|1,ind,x);\n\t\ts[k].mn=min(s[k<<1].mn,s[k<<1|1].mn);\n\t}\n\tinline int query(int k,int l,int r){\n\t\tif(l<=s[k].l&&s[k].r<=r){\n\t\t\treturn s[k].mn;\n\t\t}\n\t\tint mid=(s[k].l+s[k].r)>>1;\n\t\tif(r<=mid)\treturn query(k<<1,l,r);\n\t\telse if(l>mid)\treturn query(k<<1|1,l,r);\n\t\telse\t\treturn min(query(k<<1,l,mid),query(k<<1|1,mid+1,r));\n\t}\n} s1,s2,s3,s4;\nint anss[200005];\nsigned main(){\n//\tfilei(\"P4088_5.in\");\n\tn=read(),m=read();\n\tfz(i,1,n){\n\t\tp[i].x=read();\n\t\tp[i].y=read();\n\t\tp[i].t=read();\n\t\tkeyx[++xc]=p[i].x;\n\t\tkeyy[++yc]=p[i].y;\n\t}\n\tfz(i,1,m){\n\t\tq[i].x=read();\n\t\tq[i].y=read();\n\t\tq[i].id=i;\n\t\tq[i].ans=_abs(q[i].y-q[i].x);\n\t\tkeyx[++xc]=q[i].x;\n\t\tkeyy[++yc]=q[i].y;\n\t}\n\tsort(keyx+1,keyx+xc+1);sort(keyy+1,keyy+yc+1);\n\tkeyx[0]=0x3f3f3f3f;keyy[0]=0x3f3f3f3f;\n\tfz(i,1,xc)\tif(keyx[i]!=keyx[i-1])\thsx[++cx]=keyx[i];\n\tfz(i,1,yc)\tif(keyy[i]!=keyy[i-1])\thsy[++cy]=keyy[i];\n\tfz(i,1,n)\tp[i].x=lower_bound(hsx+1,hsx+cx+1,p[i].x)-hsx;\n\tfz(i,1,n)\tp[i].y=lower_bound(hsy+1,hsy+cy+1,p[i].y)-hsy;\n\tfz(i,1,m)\tq[i].x=lower_bound(hsx+1,hsx+cx+1,q[i].x)-hsx;\n\tfz(i,1,m)\tq[i].y=lower_bound(hsy+1,hsy+cy+1,q[i].y)-hsy;\n//\tfz(i,1,n)\tcout<<p[i].x<<\" \"<<p[i].y<<\" \"<<p[i].t<<endl;\n//\tfz(i,1,m)\tcout<<q[i].x<<\" \"<<q[i].y<<endl;\n\tsort(p+1,p+n+1);\n\tsort(q+1,q+m+1);\n\ts1.build(1,1,cy);s2.build(1,1,cy);s3.build(1,1,cy);s4.build(1,1,cy);\n\ts1.init();s2.init();s3.init();s4.init();\n\tp[n+1].x=0x3f3f3f3f;\n\tint cur=1;\n\tfz(i,1,m){\n//\t\tif(i>=5000)\tcerr<<i<<endl;\n\t\twhile(p[cur].x<=q[i].x){\n\t\t\ts1.modify(1,p[cur].y,-hsy[p[cur].y]-hsx[p[cur].x]+p[cur].t);\n\t\t\ts2.modify(1,p[cur].y,hsy[p[cur].y]-hsx[p[cur].x]+p[cur].t);\n\t\t\tcur++;\n\t\t}\n\t\tq[i].ans=min(q[i].ans,s1.query(1,1,q[i].y)+hsx[q[i].x]+hsy[q[i].y]);\n\t\tq[i].ans=min(q[i].ans,s2.query(1,q[i].y,cy)+hsx[q[i].x]-hsy[q[i].y]);\n\t}\n\tcur=n;\n\tfd(i,m,1){\n//\t\tcerr<<i<<endl;\n\t\twhile(p[cur].x>=q[i].x&&cur>=1){\n\t\t\ts3.modify(1,p[cur].y,hsy[p[cur].y]+hsx[p[cur].x]+p[cur].t);\n\t\t\ts4.modify(1,p[cur].y,-hsy[p[cur].y]+hsx[p[cur].x]+p[cur].t);\n\t\t\tcur--;\n\t\t}\n\t\tq[i].ans=min(q[i].ans,s4.query(1,1,q[i].y)-hsx[q[i].x]+hsy[q[i].y]);\n\t\tq[i].ans=min(q[i].ans,s3.query(1,q[i].y,cy)-hsx[q[i].x]-hsy[q[i].y]);\n\t}\n\tfz(i,1,m)\tanss[q[i].id]=q[i].ans;\n\tfz(i,1,m)\tcout<<anss[i]<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1587305466,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4088 \u3010[USACO18FEB]Slingshot P\u3011"
    },
    {
        "content": "[\u9898\u9762](https://www.luogu.org/problemnew/show/P4088)\n\n\u626b\u63cf\u7ebf+\u7ebf\u6bb5\u6811\u3002\n\n\u88ab\u697c\u4e0a\u9707\u60ca\u4e86\uff0c\u6811\u5957\u6811\u4ec0\u4e48\u7684\u5b8c\u5168\u4e0d\u4f1a\u554a\uff0c\u8868\u793a\u840c\u65b0\u53ea\u4f1a\u7ebf\u6bb5\u6811\u3002\n\n\u9996\u5148\u8f6c\u6362\u9898\u76ee\uff0c\u5c06\u9898\u76ee\u8f6c\u6362\u6210\uff1a\n\n\u4e00\u4e2a\u5e73\u9762\u4e0a\u6709$n$\u4e2a\u70b9\uff0c\u5750\u6807\u4e3a$(xi,yi)$\uff0c\u4e14\u6bcf\u4e2a\u70b9\u6709\u4e00\u4e2a\u70b9\u503c$ti$\u3002\u73b0\u6709$m$\u4e2a\u70b9$(ai,bi)$\uff0c\u4f7f\u8fd9$m$\u4e2a\u70b9\u6bcf\u4e2a\u70b9\u4e0e\u5176\u4ed6$n$\u4e2a\u70b9\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u52a0\u4e0a\u70b9\u503c\u6700\u5c0f\u3002\u8bf4\u767d\u4e86\uff0c\u5c31\u662f$|ai-xi|+|bi-yi|+ti$\u6700\u5c0f\uff0c\u8fd9\u4e5f\u6b63\u662f\u9898\u76ee\u6240\u6c42\u3002\n\n\u4e3a\u4ec0\u4e48\u8981\u8f6c\u6362\u9898\u76ee\u5462\uff1f\u56e0\u4e3a\u8fd9\u6837\u4f1a\u53d8\u5f97\u66f4\u52a0\u76f4\u89c2\u3002\u6211\u4eec\u5206\u7c7b\u8ba8\u8bba$a$\u4e0e$x$\uff0c$b$\u4e0e$y$\u7684\u5173\u7cfb\uff0c\u7528\u7ebf\u6bb5\u6811+\u626b\u63cf\u7ebf\u7ef4\u62a4\u4e00\u4e0b\u5c31\u597d\u4e86\u3002\n\ncode:\n```\n//2018.9.27 by ljz\n#include<bits/stdc++.h>\nusing namespace std;\n#define res register LL\n#define LL long long\n#define inf 0x3f3f3f3f3f3f3f\n#define eps 1e-15\ninline LL read(){\n    res s=0;\n    bool w=0;\n    char ch=getchar();\n    while(ch<'0'||ch>'9'){if(ch=='-')w=1;ch=getchar();}\n    while(ch>='0'&&ch<='9')s=s*10+ch-'0',ch=getchar();\n    return w?-s:s;\n}\ninline void _swap(res &x,res &y){\n    x^=y^=x^=y;\n}\ninline LL _abs(const res &x){\n    return x>0?x:-x;\n}\ninline LL _max(const res &x,const res &y){\n    return x>y?x:y;\n}\ninline LL _min(const res &x,const res &y){\n    return x<y?x:y;\n}\nconst LL N=2e5+10;\nnamespace MAIN{\n    struct P{\n        LL x,y,t,opt,id;\n        P() {}\n        P(res x,res y,res t,res opt,res id):x(x),y(y),t(t),opt(opt),id(id) {}\n    }pos[N];\n    LL X[N],Y[N],n,m,cnt,nw;\n    inline bool cmp(const P &a,const P &b){\n        return a.x!=b.x?a.x<b.x:a.y<b.y;\n    }\n    namespace Segtree{\n        LL mn[N<<2];\n        inline void init(){\n            memset(mn,inf,sizeof(mn));\n        }\n        inline void pushup(const res &rt){\n            mn[rt]=_min(mn[rt<<1],mn[rt<<1|1]);\n        }\n        void update(const res &rt,const res &l,const res &r,const res &p,const res &v){\n            if(l==r){mn[rt]=_min(mn[rt],v);return;}\n            res mid=(l+r)>>1;\n            if(p<=mid)update(rt<<1,l,mid,p,v);\n            else update(rt<<1|1,mid+1,r,p,v);\n            pushup(rt);\n        }\n        LL query(const res &rt,const res &l,const res &r,const res &L,const res &R){\n            if(L<=l&&r<=R)return mn[rt];\n            res mid=(l+r)>>1,ret=inf;\n            if(L<=mid)ret=_min(ret,query(rt<<1,l,mid,L,R));\n            if(R>mid)ret=_min(ret,query(rt<<1|1,mid+1,r,L,R));\n            return ret;\n        }\n    }\n    using namespace Segtree;\n    LL ans[N];\n    inline void MAIN(){\n        n=read(),m=read();\n        for(res i=1;i<=n;i++){\n            res x=read(),y=read(),t=read();\n            pos[++cnt]=P(x,y,t,0,0);\n            X[cnt]=x,Y[cnt]=y;\n        }\n        for(res i=1;i<=m;i++){\n            res x=read(),y=read();\n            pos[++cnt]=P(x,y,0,1,i);\n            X[cnt]=x,Y[cnt]=y;\n            ans[i]=_abs(x-y);\n        }\n        sort(X+1,X+cnt+1);\n        nw=unique(X+1,X+cnt+1)-X-1;\n        for(res i=1;i<=cnt;i++)pos[i].x=lower_bound(X+1,X+nw+1,pos[i].x)-X;\n        sort(Y+1,Y+cnt+1);\n        nw=unique(Y+1,Y+cnt+1)-Y-1;\n        for(res i=1;i<=cnt;i++)pos[i].y=lower_bound(Y+1,Y+nw+1,pos[i].y)-Y;\n        sort(pos+1,pos+cnt+1,cmp);\n        init();\n        for(res i=1;i<=cnt;i++){\n            if(!pos[i].opt)update(1,1,cnt,pos[i].y,-X[pos[i].x]-Y[pos[i].y]+pos[i].t);\n            else ans[pos[i].id]=_min(ans[pos[i].id],query(1,1,cnt,1,pos[i].y)+X[pos[i].x]+Y[pos[i].y]);\n        }\n        init();\n        for(res i=cnt;i>=1;i--){\n            if(!pos[i].opt)update(1,1,cnt,pos[i].y,X[pos[i].x]+Y[pos[i].y]+pos[i].t);\n            else ans[pos[i].id]=_min(ans[pos[i].id],query(1,1,cnt,pos[i].y,cnt)-X[pos[i].x]-Y[pos[i].y]);\n        }\n        init();\n        for(res i=1;i<=cnt;i++){\n            if(!pos[i].opt)update(1,1,cnt,pos[i].y,-X[pos[i].x]+Y[pos[i].y]+pos[i].t);\n            else ans[pos[i].id]=_min(ans[pos[i].id],query(1,1,cnt,pos[i].y,cnt)+X[pos[i].x]-Y[pos[i].y]);\n        }\n        init();\n        for(res i=cnt;i>=1;i--){\n            if(!pos[i].opt)update(1,1,cnt,pos[i].y,X[pos[i].x]-Y[pos[i].y]+pos[i].t);\n            else ans[pos[i].id]=_min(ans[pos[i].id],query(1,1,cnt,1,pos[i].y)-X[pos[i].x]+Y[pos[i].y]);\n        }\n        for(res i=1;i<=m;i++)printf(\"%lld\\n\",ans[i]);\n    }\n}\nint main(){\n    MAIN::MAIN();\n    return 0;\n}\n```",
        "postTime": 1538049154,
        "uid": 32878,
        "name": "foreverlasting",
        "ccfLevel": 7,
        "title": "\u3010USACO18FEB\u3011Slingshot"
    },
    {
        "content": "\u9996\u5148\u6309\u7167\u9898\u610f\u5199\u51fa\u5f0f\u5b50\uff0c\u5bf9\u4e8e $(a,b)$ \u7684\u8be2\u95ee\u4f7f\u7528 $(x,y)$ \u7684\u5f39\u5f13\uff0c\u9700\u8981\u7684\u82b1\u8d39\u662f $|a-x|-|b-y|+t$\uff0c\u90a3\u4e48\u6b64\u65f6\u628a $(a,b)$ \u770b\u6210\u70b9\uff0c$(x,y)$ \u4e5f\u770b\u6210\u70b9\uff0c\u5c31\u53d8\u6210\u4e86\u5e73\u9762\u95ee\u9898\u3002    \n\u6309\u7167\u5957\u8def\u5c06\u7edd\u5bf9\u503c\u5206\u7c7b\u8ba8\u8bba\u62c6\u5f00\uff0c\u4ee5 $x\\le a$ \u4e14 $y\\le b$ \u4e3a\u4f8b\uff0c\u7b54\u6848\u4e3a $a+b-(x+y-t)$\uff0c\u53d8\u6210\u7ecf\u5178\u7684\u4e8c\u7ef4\u504f\u5e8f\u95ee\u9898\u3002\u6b64\u65f6\u6309\u7167 $x$ \u6392\u5e8f\u540e\u628a\u540e\u534a\u90e8\u5206\u63d2\u5165\u6811\u72b6\u6570\u7ec4\uff0c\u5728 $(a,b)$ \u51fa\u67e5\u8be2\u5373\u53ef\u3002   \n\n\u4e00\u4e2a\u5c0f $trick$ \u662f\u5176\u5b9e\u6ca1\u6709\u5fc5\u8981\u5efa\u51fa\u56db\u68f5\u4e0d\u540c\u7684\u6811\u72b6\u6570\u7ec4\uff0c\u53ea\u9700\u8981\u5c06\u5750\u6807\u7cfb\u65cb\u8f6c\u56db\u6b21\u5373\u53ef\u7edf\u8ba1\u5230\u5168\u90e8\u7684\u7b54\u6848\u3002\n\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nconst int maxn=2e5+5;\nconst int inf=2e9;\nint n,m,lshx[maxn],lshy[maxn],x[maxn],y[maxn],w[maxn],c[maxn],ans[maxn],nm;\nint read(){\n\tint x=0,f=1;char ch=getchar();\n\twhile(!isdigit(ch)){if(ch=='-')f=-1;ch=getchar();}\n\twhile(isdigit(ch)){x=x*10+ch-48;ch=getchar();}\n\treturn x*f;\n}\nstruct Node{\n\tint x,y,w,op,rx,ry;\n}a[maxn];\nvoid solve(int x[],int lsh[]){\n\tfor(int i=1;i<=nm;i++)lsh[i]=x[i];\n\tsort(lsh+1,lsh+nm+1);int tot=unique(lsh+1,lsh+nm+1)-lsh-1;\n\tfor(int i=1;i<=nm;i++)x[i]=lower_bound(lsh+1,lsh+tot+1,x[i])-lsh;\n\treturn ;\n}\nvoid add(int x,int w){for(;x<=nm;x+=x&-x)c[x]=min(c[x],w);}\nint ask(int x){int res=0;for(;x;x-=x&-x)res=min(res,c[x]);return res;}\nvoid solve(){\n\tsort(a+1,a+nm+1,[](Node x,Node y){return x.x<y.x;});\n\tmemset(c,0x3f,sizeof c);\n\tfor(int i=1;i<=nm;i++){\n\t\tif(a[i].op)add(a[i].y,-a[i].rx-a[i].ry+a[i].w);\n\t\telse ans[a[i].w]=min(ans[a[i].w],ask(a[i].y)+a[i].rx+a[i].ry);\n\t}\n\treturn ;\n}\nsigned main(){\n\tn=read(),m=read();nm=n+m;\n\tfor(int i=1;i<=n;i++)x[i]=read(),y[i]=read(),w[i]=read();\n\tfor(int i=1;i<=m;i++)x[i+n]=read(),y[i+n]=read(),ans[i]=abs(x[i+n]-y[i+n]);\n\tsolve(x,lshx),solve(y,lshy);\n\tfor(int i=1;i<=nm;i++)a[i]={x[i],y[i],i<=n?w[i]:i-n,i<=n,lshx[x[i]],lshy[y[i]]};\n\tsolve();for(int i=1;i<=nm;i++)a[i].x=nm-a[i].x+1,a[i].rx=inf-a[i].rx;\n\tsolve();for(int i=1;i<=nm;i++)a[i].y=nm-a[i].y+1,a[i].ry=inf-a[i].ry;\n\tsolve();for(int i=1;i<=nm;i++)a[i].x=nm-a[i].x+1,a[i].rx=inf-a[i].rx;\n\tsolve();for(int i=1;i<=m;i++)printf(\"%lld\\n\",ans[i]);\n\treturn 0;\n}\n```",
        "postTime": 1652836878,
        "uid": 232987,
        "name": "yangchenxiao",
        "ccfLevel": 9,
        "title": "P4088 [USACO18FEB]Slingshot P \u9898\u89e3"
    },
    {
        "content": "\u6811\u72b6\u6570\u7ec4\uff08\u867d\u8bf4\u697c\u4e0a\u5927\u4f6c\u5199\u8fc7\u4e86 QAQ\uff09\n\n# noteskey\n\n\n\u8fd9\u9053\u9898\u53ef\u4ee5\u5c31\u53ea\u7528\u4e00\u4e2a\u6811\u72b6\u6570\u7ec4\u7684\u6570\u636e\u7ed3\u6784...\n\n\u4e8e\u662f\u6811\u5957\u6811\u5c31\u6ca1\u6709\u6253\u8fc7\u4e86...QWQ \u6211\u592ac\u4e86\n\n\u603b\u4e4b\u5c31\u662f\u5206\u56db\u79cd\u60c5\u51b5\u66f4\u65b0\u7b54\u6848\uff1a\n\n![](https://ws4.sinaimg.cn/large/005S5cb6ly1g2bpyxz5aqj31500ist8x.jpg\n)\n\n\u6700\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\u6bcf\u6b21\u53d6 min \u8f93\u51fa\u5373\u53ef\n\n\u7136\u540e\u6ca1\u6709\u7136\u540e\uff0c\u6ce8\u610f\u7cbe\u5ea6\u95ee\u9898\u5c31\u884c\u4e86\uff08\u5b9e\u5728\u4e0d\u884c\u5c31 $ \\#define ~int~ long~ long$?\uff09\n\n\n# code\n\n\u4ee3\u7801\u77ed\u4f46\u662f\u4e11\uff0c\u9898\u89e3\u533a\u7801\u98ce++\n\n```cpp\n//by Judge\n#include<bits/stdc++.h>\n#define Rg register\n#define fp(i,a,b) for(Rg int i=(a),I=(b)+1;i<I;++i)\n#define fd(i,a,b) for(Rg int i=(a),I=(b)-1;i>I;--i)\n#define ll long long\nusing namespace std;\nconst int M=2e5+3;\ntypedef int arr[M];\ntypedef ll ARR[M];\n#ifndef Judge\n#define getchar() (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\n#endif\nchar buf[1<<21],*p1=buf,*p2=buf;\ninline bool cmin(ll& a,ll b){return a>b?a=b,1:0;}\ninline int read(){ int x=0,f=1; char c=getchar();\n\tfor(;!isdigit(c);c=getchar()) if(c=='-') f=-1;\n\tfor(;isdigit(c);c=getchar()) x=x*10+c-'0'; return x*f;\n} char sr[1<<21],z[20];int CCF=-1,Z;\ninline void Ot(){fwrite(sr,1,CCF+1,stdout),CCF=-1;}\ninline void print(ll x,char chr='\\n'){\n\tif(CCF>1<<20)Ot();if(x<0)sr[++CCF]=45,x=-x;\n\twhile(z[++Z]=x%10+48,x/=10);\n\twhile(sr[++CCF]=z[Z],--Z);sr[++CCF]=chr;\n}\nint n,m,nm,cnt; arr px,py; ARR c,ans;\nstruct node{ int x,y,v,id; node(){}\n\tnode(int xx,int yy,int vv,int iid){x=xx,y=yy,v=vv,id=iid;}\n}a[M];\ninline bool cmp(node& a,node& b){return a.x^b.x?a.x<b.x:a.y<b.y;}\ninline void update(int x,ll d){for(;x<=cnt;x+=x&-x) cmin(c[x],d);}\ninline ll query(int x){ll s=2e9;for(;x;x^=x&-x) cmin(s,c[x]); return s;}\nsigned main(){ n=read(),m=read(); int x,y,t;\n\tfp(i,1,n) x=read(),y=read(),t=read(),\n\t\ta[++cnt]=node(x,y,t,0),px[cnt]=x,py[cnt]=y;\n\tfp(i,1,m) x=read(),y=read(),a[++cnt]=node(x,y,0,i),\n\t\tpx[cnt]=x,py[cnt]=y,ans[i]=abs(y-x);\n\tsort(px+1,px+1+cnt),sort(py+1,py+1+cnt);\n\tsort(a+1,a+1+cnt,cmp);\n\tnm=unique(px+1,px+1+cnt)-1-px;\n\tfp(i,1,cnt) a[i].x=lower_bound(px+1,px+1+cnt,a[i].x)-px;\n\tnm=unique(py+1,py+1+cnt)-1-py;\n\tfp(i,1,cnt) a[i].y=lower_bound(py+1,py+1+cnt,a[i].y)-py;\n\tmemset(c,0x3f,(cnt+2)<<3);\n\tfp(i,1,cnt) if(!a[i].id) update(a[i].y,1ll*-px[a[i].x]-py[a[i].y]+a[i].v);\n\t\telse cmin(ans[a[i].id],query(a[i].y)+px[a[i].x]+py[a[i].y]);\n\tmemset(c,0x3f,(cnt+2)<<3);\n\tfp(i,1,cnt) if(!a[i].id) update(cnt-a[i].y+1,1ll*-px[a[i].x]+py[a[i].y]+a[i].v);\n\t\telse cmin(ans[a[i].id],query(cnt-a[i].y+1)+px[a[i].x]-py[a[i].y]);\n\tmemset(c,0x3f,(cnt+2)<<3);\n\tfd(i,cnt,1) if(!a[i].id) update(a[i].y,1ll*px[a[i].x]-py[a[i].y]+a[i].v);\n\t\telse cmin(ans[a[i].id],query(a[i].y)-px[a[i].x]+py[a[i].y]);\n\tmemset(c,0x3f,(cnt+2)<<3);\n\tfd(i,cnt,1) if(!a[i].id) update(cnt-a[i].y+1,1ll*px[a[i].x]+py[a[i].y]+a[i].v);\n\t\telse cmin(ans[a[i].id],query(cnt-a[i].y+1)-px[a[i].x]-py[a[i].y]);\n\tfp(i,1,m) print(ans[i]); return Ot(),0;\n}\n```",
        "postTime": 1555939096,
        "uid": 38576,
        "name": "J\u03bcdge",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4088 \u3010[USACO18FEB]Slingshot\u3011"
    },
    {
        "content": "\u5927\u6982\u662f\u6811\u5957\u6811\uff1f\n\n\u53ef\u4ee5\u5f97\u5230dp\u65b9\u7a0b\u3002\u7136\u540e\u53d1\u73b0\u6709\u7edd\u5bf9\u503c\uff0c\u5f88\u4e0d\u4f18\u7f8e\u3002\n\n\u8003\u8651\u7528\u6570\u636e\u7ed3\u6784\u53bb\u6389\u3002\u6211\u6bd4\u8f83\u66b4\u529b\u3002\u76f4\u63a5\u7528\u4e86\u6811\u5957\u6811\u3002\u56db\u79cd\u60c5\u51b5\u5206\u56db\u4e2a\u6811\u5957\u6811\u3002\u6bcf\u4e2a\u505a\u4e8c\u7ef4\u6570\u70b9\u3002\n\n```cpp\n// luogu-judger-enable-o2\n#include<cstdio>\n#include<algorithm>\n#define int long long\nusing namespace std;\ninline int read(){int x=0,f=1; int ch=getchar(); while(ch<'0'||ch>'9'){if(ch=='-') f=-1; ch=getchar();} while(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();} return x*f;}\ninline void write(int x){if (x<0) putchar('-'),x=-x; if (x>=10) write(x/10); putchar(x%10+'0');}\ninline void writeln(int x){write(x); puts(\"\");}\nconst int inf=1e18,maxn=2e5+5;\nstruct pp{\n    int x,y,v;\n}q[maxn],b[maxn];\nint n,m,ha1[maxn],tot1,tot2,ha2[maxn];\nstruct node{\n    int ls,rs,mn;\n};\nstruct seg{\n    int tot,root[530000];\n    node a[maxn*12];\n    inline int get(int x){\n        if (!x) return inf; else return a[x].mn;\n    }\n    inline void pushup(int k){\n        a[k].mn=min(get(a[k].ls),get(a[k].rs));\n    }\n    void update(int &k,int l,int r,int x,int v){\n        if (!k){k=++tot; a[k].mn=inf;}\n        if (l==r){\n            a[k].mn=min(a[k].mn,v);\n            return;\n        }\n        int mid=(l+r)>>1;\n        if (mid>=x) update(a[k].ls,l,mid,x,v);\n            else update(a[k].rs,mid+1,r,x,v);\n        pushup(k);\n    }\n    void upd(int k,int l,int r,int x,int y,int v){\n        update(root[k],1,tot2,y,v);\n        if (l==r){\n            return;\n        }\n        int mid=(l+r)>>1;\n        if (mid>=x) upd(k<<1,l,mid,x,y,v);\n            else upd(k<<1|1,mid+1,r,x,y,v);\n    }\n    int query(int &k,int l,int r,int x,int y){\n        if (!k){k=++tot; a[k].mn=inf;}\n        if (l==x&&r==y){\n            return a[k].mn;\n        }\n        int mid=(l+r)>>1;\n        if (mid>=y) return query(a[k].ls,l,mid,x,y);\n            else if (mid<x) return query(a[k].rs,mid+1,r,x,y);\n                else return min(query(a[k].ls,l,mid,x,mid),query(a[k].rs,mid+1,r,mid+1,y));\n    }\n    int qry(int k,int l,int r,int x,int y,int X,int Y){\n        if (l==x&&r==y){\n            return query(root[k],1,tot2,X,Y);\n        }\n        int mid=(l+r)>>1;\n        if (mid>=y) return qry(k<<1,l,mid,x,y,X,Y);\n            else if (mid<x) return qry(k<<1|1,mid+1,r,x,y,X,Y);\n                else return min(qry(k<<1,l,mid,x,mid,X,Y),qry(k<<1|1,mid+1,r,mid+1,y,X,Y));\n    }\n}tree[4];\ninline void init(){\n    n=read(); m=read();\n    for (int i=1;i<=n;i++){\n        b[i]=(pp){read(),read(),read()};\t\n        ha1[++tot1]=b[i].x;\n        ha2[++tot2]=b[i].y;\n    }\n    for (int i=1;i<=m;i++){\n        q[i]=(pp){read(),read(),0};\t\n        ha1[++tot1]=q[i].x;\n        ha2[++tot2]=q[i].y;\t\n    }\n    sort(ha1+1,ha1+tot1+1);\n    sort(ha2+1,ha2+tot2+1);\n    int temp=tot1; tot1=1;\n    for (int i=2;i<=temp;i++){\n        if (ha1[i]!=ha1[tot1]){\n            ha1[++tot1]=ha1[i];\n        }\n    }\n    temp=tot2; tot2=1;\n    for (int i=2;i<=temp;i++){\n        if (ha2[i]!=ha2[tot2]){\n            ha2[++tot2]=ha2[i];\n        }\n    }\n}\ninline void solve(){\n    for (int i=1;i<=n;i++){\n        int x=lower_bound(ha1+1,ha1+1+tot1,b[i].x)-ha1,y=lower_bound(ha2+1,ha2+1+tot2,b[i].y)-ha2;\n        tree[0].upd(1,1,tot1,x,y,b[i].x+b[i].y+b[i].v);\n        tree[1].upd(1,1,tot1,x,y,b[i].x-b[i].y+b[i].v);\n        tree[2].upd(1,1,tot1,x,y,-b[i].x+b[i].y+b[i].v);\n        tree[3].upd(1,1,tot1,x,y,-b[i].x-b[i].y+b[i].v);\n    }\n    for (int i=1;i<=m;i++){\n        int x=lower_bound(ha1+1,ha1+1+tot1,q[i].x)-ha1,y=lower_bound(ha2+1,ha2+1+tot2,q[i].y)-ha2;\n        int ans1,ans2,ans3,ans4,ans;\n        ans1=tree[0].qry(1,1,tot1,x,tot1,y,tot2)-q[i].x-q[i].y;\n        ans2=tree[1].qry(1,1,tot1,x,tot1,1,y)-q[i].x+q[i].y;\n        ans3=tree[2].qry(1,1,tot1,1,x,y,tot2)+q[i].x-q[i].y;\n        ans4=tree[3].qry(1,1,tot1,1,x,1,y)+q[i].x+q[i].y;\n        ans=min(ans1,ans2);\n        ans=min(ans3,ans4);\n        ans=min(ans,abs(q[i].x-q[i].y));\n        writeln(ans);\n    }\n}\nsigned main(){\n//\tfreopen(\"slingshot.in\",\"r\",stdin);\n//\tfreopen(\"slingshot.out\",\"w\",stdout);\n    init();\n    solve();\n    return 0;\n}\n```",
        "postTime": 1522995148,
        "uid": 34444,
        "name": "\u5927\u83dc\u9e21fks",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4088 \u3010[USACO18FEB]Slingshot\u3011"
    },
    {
        "content": "> \u88ab\u6211\u7528\u66b4\u529b\u8349\u8fc7\u53bb\u4e86\u54c8\u54c8\u54c8\n\n\u5c31\u50cf\u662f\u5176\u4ed6\u9898\u89e3\u6240\u8bf4\u7684\u4e00\u6837\uff0c\u95ee\u9898\u53ef\u4ee5\u8f6c\u5316\u4e3a\u627e\u4e0e\u7ed9\u5b9a\u70b9\u8ddd\u79bb\u4e0e\u6743\u503c\u548c\u7684\u6700\u5c0f\u503c\u3002\u6211\u4eec\u8003\u8651\u82e5\u6240\u6709\u70b9\u6743\u5747\u4e3a $0$ \uff0c\u90a3\u4e48\u5c31\u662f\u627e\u5e73\u9762\u4e0e\u7ed9\u5b9a\u70b9\u6700\u5c0f\u8ddd\u79bb\uff0c\u53ef\u4ee5\u4f7f\u7528 KD \u6811\u89e3\u51b3\u3002\u6b64\u9898\u5e26\u6709\u6743\u503c\uff0c\u4e0d\u80fd\u76f4\u63a5\u4e8c\u7ef4\u7684 KD \u6811\u89e3\u51b3\u3002\u8003\u8651\u5c06\u6743\u503c\u770b\u505a\u7b2c\u4e09\u4e2a\u7ef4\u5ea6\uff0c\u90a3\u4e48\u6b64\u9898\u5c31\u8f6c\u5316\u4e3a\u4e09\u7ef4\u6700\u8fd1\u70b9\u5bf9\u95ee\u9898\uff0c\u4f9d\u7136\u53ef\u4ee5\u4f7f\u7528 KD \u6811\u89e3\u51b3\u3002\n\n\u6700\u7ec8\u590d\u6742\u5ea6 $O(\\text{\u7384\u5b66})$ \u4f46\u662f\u5b9e\u6d4b\u53ef\u4ee5\u901a\u8fc7\u3002\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n\n#define ll long long\n// #define  int long long\nusing namespace std;\n\nint read()\n{\n\tint a = 0,x = 1;char ch = getchar();\n\twhile(ch > '9' || ch < '0') {if(ch == '-') x = -1;ch = getchar();}\n\twhile(ch >= '0' && ch <= '9') {a = a*10 + ch-'0';ch = getchar();}\n\treturn a*x;\n}\nconst int N=2e6+7;\nll inf = 2e18+7;\nint n,m,rt,tot,WD;\n\nstruct Point{int p[3];}A[N];\nbool operator < (Point a,Point b) {return a.p[WD] < b.p[WD];}\nstruct node{Point tp;int ls,rs,mi[3],mx[3];}tre[N];\nvoid push_up(int root)\n{\n\tint l = tre[root].ls,r = tre[root].rs;\n\tfor(int i = 0;i < 3;i ++) {\n\t\ttre[root].mi[i] = tre[root].mx[i] = tre[root].tp.p[i];\n\t\tif(l) tre[root].mi[i] = min(tre[root].mi[i],tre[l].mi[i]),tre[root].mx[i] = max(tre[root].mx[i],tre[l].mx[i]);\n\t\tif(r) tre[root].mi[i] = min(tre[root].mi[i],tre[r].mi[i]),tre[root].mx[i] = max(tre[root].mx[i],tre[r].mx[i]);\n\t}\n}\nll calc(Point x,node y)\n{\n\tll ret = 0;\n\tfor(int i = 0;i < 3;i ++) {\n\t\tret += max(0,y.mi[i]-x.p[i]) + max(0,x.p[i]-y.mx[i]);\n\t}\n\treturn ret;\n}\nll calc(Point a,Point b)\n{\n\tll ret = 0;\n\tfor(int i = 0;i < 3;i ++) {\n\t\tret += abs(a.p[i]-b.p[i]);\n\t}\n\treturn ret;\n}\nvoid build(int &root,int l,int r,int wd)\n{\n\tint mid = l+r>>1;WD = wd;\n\tnth_element(A+l,A+mid,A+r+1);\n\troot = ++tot;tre[root].tp = A[mid];\n\tif(l<=mid-1) build(tre[root].ls,l,mid-1,(wd+1)%3);\n\tif(r>=mid+1) build(tre[root].rs,mid+1,r,(wd+1)%3);\n\tpush_up(root);\n}\nll ans;\nvoid dfs(int root,Point x)\n{\n\tans = min(ans,calc(x,tre[root].tp));\n\tll tmp1 = inf,tmp2 = inf;int l = tre[root].ls,r = tre[root].rs;\n\tif(l) tmp1 = min(tmp1,calc(x,tre[l]));\n\tif(r) tmp2 = min(tmp2,calc(x,tre[r]));\n\tif(l<r) {\n\t\tif(l && ans > tmp1) dfs(l,x);\n\t\tif(r && ans > tmp2) dfs(r,x);\n\t} else {\n\t\tif(r && ans > tmp2) dfs(r,x);\n\t\tif(l && ans > tmp1) dfs(l,x);\n\t}\n}\nsigned main()\n{\n\t// freopen(\"random.in\",\"r\",stdin);\n\t// freopen(\"sol.out\",\"w\",stdout);\n\tn = read(),m = read();\n\tfor(int i = 1;i <= n;i ++) {\n\t\tfor(int j = 0;j < 3;j ++) A[i].p[j] = read();\n\t}\n\t// puts(\"!\");\n\tbuild(rt,1,n,0);\n\tfor(int i = 1;i <= m;i ++) {\n\t\tPoint x;x.p[0] = read(),x.p[1] = read(),x.p[2] = 0;\n\t\tans = abs(x.p[1]-x.p[0]);\n\t\tdfs(rt,x);printf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1618396464,
        "uid": 305911,
        "name": "\u5fd8\u6000\u661f",
        "ccfLevel": 0,
        "title": "p4088\u9898\u89e3"
    },
    {
        "content": "\u7531\u4e8e\u5750\u6807\u5f88\u5927\uff0c\u5148\u79bb\u6563\u5316\uff0c\u7136\u540e\u79bb\u7ebf\u5904\u7406\u8be2\u95ee\uff0c\u7136\u540e\u901a\u8fc7\u8c03\u6574\u679a\u4e3e\u987a\u5e8f\u4e0e\u5728\u6811\u72b6\u6570\u7ec4\u7684\u63d2\u5165\u4f4d\u7f6e\u7b49\u5904\u7406\u4e0d\u540c\u60c5\u51b5\uff0c\u624b\u63a8\u4e00\u4e0b\u5e94\u8be5\u4e0d\u96be\u7406\u89e3\uff0c\u60c5\u51b5\u5982\u4e0b\u56fe\u6240\u793a\n\n\u8bbex,y\u4e3a\u5f39\u5f13\u5de6\u7aef\u70b9\u4e0e\u53f3\u7aef\u70b9\uff0cs,t\u4e3a\u67e5\u8be2\u5de6\u7aef\u70b9\u4e0e\u53f3\u7aef\u70b9\n\n![](https://i.loli.net/2019/03/25/5c98dbd7cda1b.png)\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nstruct node{\n    int x,y,v,id;\n}a[200200];\ninline int read(){\n    int x=0,w=0;char ch=getchar();\n    while (!isdigit(ch))w|=ch=='-',ch=getchar();\n    while (isdigit(ch))x=(x<<1)+(x<<3)+ch-'0',ch=getchar();\n    return w?-x:x;\n}\nint c[200200],cnt,nm,px[200200],py[200200],ans[100100];\ninline bool cmp(node a,node b){return (a.x!=b.x)?a.x<b.x:a.y<b.y;}\ninline void change(int x,int d){\n    for (;x<=cnt;x+=x&-x)\n        c[x]=min(c[x],d);\n}\ninline int query(int x){\n    int res=0x3f3f3f3f3f3f3f3f;\n    for (;x;x-=x&-x)\n        res=min(res,c[x]);\n    return res;\n}\nsigned main(){\n    int n=read(),m=read();\n    for (int i=1;i<=n;++i){\n        int x=read(),y=read(),t=read();\n        a[++cnt]=node{x,y,t,0};\n        px[cnt]=x;py[cnt]=y;\n    }\n    for (int i=1;i<=m;++i){\n        int x=read(),y=read();\n        a[++cnt]=node{x,y,0,i};\n        px[cnt]=x;py[cnt]=y;\n        ans[i]=abs(y-x);\n    }\n    sort(px+1,px+1+cnt);\n    sort(py+1,py+1+cnt);\n    sort(a+1,a+1+cnt,cmp);\n    nm=unique(px+1,px+1+cnt)-px-1;\n    for (int i=1;i<=cnt;++i)a[i].x=lower_bound(px+1,px+1+nm,a[i].x)-px;\n    nm=unique(py+1,py+1+cnt)-py-1;\n    for (int i=1;i<=cnt;++i)a[i].y=lower_bound(py+1,py+1+nm,a[i].y)-py;//\u79bb\u6563\u5316\n    memset(c,0x3f,sizeof(c));\n    for (int i=1;i<=cnt;++i)\n        if (!a[i].id)\n        \tchange(a[i].y,-px[a[i].x]-py[a[i].y]+a[i].v);\n        else ans[a[i].id]=min(ans[a[i].id],query(a[i].y)+px[a[i].x]+py[a[i].y]);\n    memset(c,0x3f,sizeof(c));\n    for (int i=1;i<=cnt;++i)\n        if (!a[i].id)\n        \tchange(cnt-a[i].y+1,-px[a[i].x]+py[a[i].y]+a[i].v);\n        else ans[a[i].id]=min(ans[a[i].id],query(cnt-a[i].y+1)+px[a[i].x]-py[a[i].y]);\n    memset(c,0x3f,sizeof(c));\n    for (int i=cnt;i;--i)\t\n        if (!a[i].id)\n        \tchange(a[i].y,px[a[i].x]-py[a[i].y]+a[i].v);\n        else ans[a[i].id]=min(ans[a[i].id],query(a[i].y)-px[a[i].x]+py[a[i].y]);\n    memset(c,0x3f,sizeof(c));\n    for (int i=cnt;i;--i)\n        if (!a[i].id)\n        \tchange(cnt-a[i].y+1,px[a[i].x]+py[a[i].y]+a[i].v);\n        else ans[a[i].id]=min(ans[a[i].id],query(cnt-a[i].y+1)-px[a[i].x]-py[a[i].y]);//\u56db\u79cd\u60c5\u51b5\n    for (int i=1;i<=m;++i)\n        printf(\"%lld\\n\",ans[i]);\n    return 0;\n}\n```",
        "postTime": 1553526066,
        "uid": 54260,
        "name": "tcchyc",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4088 \u3010[USACO18FEB]Slingshot\u3011"
    },
    {
        "content": "\u9996\u5148\u5bf9\u4e8e\u4e00\u6761\u8def\u5f84a\uff0c\u5047\u8bbe\u4efb\u610f\u4e00\u4e2a\u5f39\u5f13\u90fd\u4e0d\u4f7f\u7528\uff0c\u5219\u65f6\u95f4\u4e3ar[a]-l[a]\u7684\u7edd\u5bf9\u503c\n\n\u5047\u8bbe\u9700\u8981\u4f7f\u7528\u5f39\u5f13d\uff0c\u6240\u82b1\u8d39\u7684\u65f6\u95f4\u662f|l[a]-l[d]|+|r[a]-r[d]|+time[d];\n\n\u5047\u8bbel[a]>=l[d],r[a]>=r[d],\u5219\u65f6\u95f4\u662fl[a]+r[a]-l[d]-r[d]+time[d];\n\n\u5bf9\u4e8el[a]<=l[d],r[a]>=r[d],\u5219\u65f6\u95f4\u662fr[a]-l[a]+l[d]-r[d]+time[d];\n\n\u5bf9\u4e8el[a]>=l[d],r[a]<=r[d],\u5219\u65f6\u95f4\u662fl[a]-r[a]-l[d]+r[d]+time[d];\n\n\u5bf9\u4e8el[a]<=l[d],r[a]<=r[d],\u5219\u65f6\u95f4\u662f-l[a]-r[a]+l[d]+r[d]+time[d];\n\n\u9996\u5148l[a]\u4e0er[a]\u90fd\u662f\u5b9a\u503c\uff0c\u90a3\u4e48\u5c31\u5206\u6210\u56db\u79cd\u60c5\u51b5\uff0c\u4f9d\u6b21\u5728\u56db\u79cd\u60c5\u51b5\u4e0b\u7528\u540e\u9762\u548cd\u6709\u5173\u7684\u4e00\u4e2a\u5f0f\u5b50\u53bb\u66f4\u65b0\u7b54\u6848\u5373\u53ef\u3002\n\n\u90a3\u4e48\u5c31\u53ef\u4ee5\u5c06\u95ee\u9898\u8f6c\u5316\u4e3a\u4e00\u4e2a\u4e8c\u7ef4\u504f\u5e8f\u95ee\u9898\uff0c\u53ea\u6709\u4e24\u4e2a\u6761\u4ef6\u5747\u6ee1\u8db3\u7684\u5f39\u5f13\u624d\u80fd\u5bf9\u7b54\u6848\u4ea7\u751f\u8d21\u732e\u3002\n\n\u5176\u5b9e\u4e8c\u4f4d\u504f\u5e8f\u5e76\u4e0d\u9700\u8981\u6811\u5957\u6811\u7684\u2026\u2026\u4e00\u7ef4\u6392\u5e8f+\u4e00\u7ef4\u7ebf\u6bb5\u6811\u5373\u53ef\u89e3\u51b3\u3002\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\n\nint n,m;\nstruct node {\n    int l,r,time,ans,id;\n} nd[200010];\nlong long d[6000100];\nint l[6000100],r[6000100],gs,rt;\nbool cmp1(node a,node b) {\n    return a.l==b.l?a.time>b.time:a.l<b.l;\n}\nbool cmp2(node a,node b) {\n    return a.l==b.l?a.time>b.time:a.l>b.l;\n}\nbool cmp3(node a,node b) {\n    return a.l==b.l?a.time>b.time:a.l<b.l;\n}\nbool cmp4(node a,node b) {\n    return a.l==b.l?a.time>b.time:a.l>b.l;\n}\nbool cmp5(node a,node b) {\n    return a.id<b.id;\n}\n\nvoid update(int &x,int li,int ri,int p,long long v) {\n    if(!x) {\n        x=++gs;\n    }\n    if(li==ri) {\n        d[x]=min(d[x],v);\n        return;\n    }\n    int mid=(li+ri)>>1;\n    if(p<=mid)update(l[x],li,mid,p,v);\n    else update(r[x],mid+1,ri,p,v);\n    d[x]=min(d[l[x]],d[r[x]]);\n}\n\nlong long query(int x,int li,int ri,int nl,int nr) {\n    if(!x || li>nr || ri<nl)return 0x3f3f3f3f3f3f3f3fll;\n    if(li>=nl && ri<=nr) {\n        return d[x];\n    }\n    int mid=(li+ri)>>1;\n    return min(query(l[x],li,mid,nl,nr),query(r[x],mid+1,ri,nl,nr));\n}\n\nint main() {\n    scanf(\"%d %d\",&n,&m);\n    for(int i=1; i<=n; i++) {\n        scanf(\"%d %d %d\",&nd[i].l,&nd[i].r,&nd[i].time);\n        nd[i].id=i;\n    }\n    for(int i=n+1; i<=n+m; i++) {\n        scanf(\"%d %d\",&nd[i].l,&nd[i].r);\n        nd[i].time=-1;\n        nd[i].id=i;\n        nd[i].ans=nd[i].r-nd[i].l;\n        if(nd[i].ans<0)nd[i].ans*=-1;\n    }\n\n    sort(nd+1,nd+n+m+1,cmp1);\n    memset(d,0x3f,sizeof(d));\n    for(int i=1; i<=n+m; i++) {\n        if(~nd[i].time)update(rt,1,1000000000,nd[i].r,(long long)-nd[i].l-nd[i].r+nd[i].time);\n        else nd[i].ans=min((long long)nd[i].ans,nd[i].l+nd[i].r+query(1,1,1000000000,1,nd[i].r));\n    }\n    memset(d,0x3f,sizeof(d));\n    sort(nd+1,nd+n+m+1,cmp2);\n    for(int i=1; i<=n+m; i++) {\n        if(~nd[i].time)update(rt,1,1000000000,nd[i].r,(long long)nd[i].l-nd[i].r+nd[i].time);\n        else nd[i].ans=min((long long)nd[i].ans,nd[i].r-nd[i].l+query(1,1,1000000000,1,nd[i].r));\n    }\n    memset(d,0x3f,sizeof(d));\n    sort(nd+1,nd+n+m+1,cmp3);\n    for(int i=1; i<=n+m; i++) {\n        if(~nd[i].time)update(rt,1,1000000000,nd[i].r,(long long)-nd[i].l+nd[i].r+nd[i].time);\n        else nd[i].ans=min((long long)nd[i].ans,nd[i].l-nd[i].r+query(1,1,1000000000,nd[i].r,1000000000));\n    }\n    memset(d,0x3f,sizeof(d));\n    sort(nd+1,nd+n+m+1,cmp4);\n    for(int i=1; i<=n+m; i++) {\n        if(~nd[i].time)update(rt,1,1000000000,nd[i].r,(long long)nd[i].l+nd[i].r+nd[i].time);\n        else nd[i].ans=min((long long)nd[i].ans,-nd[i].l-nd[i].r+query(1,1,1000000000,nd[i].r,1000000000));\n    }\n    sort(nd+1,nd+n+m+1,cmp5);\n    for(int i=n+1;i<=n+m;i++)printf(\"%d\\n\",nd[i].ans);\n}\n\n```",
        "postTime": 1541572127,
        "uid": 82611,
        "name": "PurpleWonder",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4088 \u3010[USACO18FEB]Slingshot\u3011"
    }
]
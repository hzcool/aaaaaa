[
    {
        "content": "## \u9898\u76ee\u5927\u610f\uff1a\n\n\u7ed9\u51fa$n$\u4e2a\u6570\uff0c\u53ef\u5c06\u5b83\u4eec\u5206\u4e3a\u82e5\u5e72\u4e2a\u4e32\uff0c\u6bcf\u4e2a\u4e32\u6709$k$\u4e2a\u6570\uff08\u957f\u5ea6\u4e0d\u8db3$k$\u5219\u4e22\u5f03\uff09\uff0c\u6c42\u4f7f\u5f97\u4e0d\u540c\u7684\u4e32\u6700\u591a\u7684$k$\u503c\u53ca\u4e32\u7684\u4e2a\u6570\u3002\u4e32\u53ef\u7ffb\u8f6c\uff0c\u5373\u5b50\u4e32$1,2,3$\u548c$3,2,1$\u88ab\u8ba4\u4e3a\u662f\u4e00\u6837\u7684\u3002 \n\n## \u601d\u8def\uff1a\n\n\u672c\u9898\u6734\u7d20\u7684\u601d\u8def\u662f\u679a\u4e3e$k$\u548c\u5404\u4e2a\u4e32\uff0c\u6bd4\u8f83\u5404\u4e2a\u4e32\u5e76\u8bb0\u5f55\u4e0d\u540c\u7684\u4e32\uff0c\u4f46\u8fd9\u6837\u6bd4\u8f83\u548c\u8bb0\u5f55\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e0d\u80fd\u505a\u5230$O(1)$\uff0c\u5c31\u80af\u5b9a\u4f1a\u8d85\u65f6\u3002\u4f46\u5982\u679c\u6bd4\u8f83\u548c\u8bb0\u5f55\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f$O(1)$\u662f\u4e0d\u662f\u5c31\u4e0d\u4f1a\u8d85\u65f6\u4e86\u5462\uff1f\u6211\u4eec\u8ba1\u7b97\u4e00\u4e0b\uff1a\n\n\u679a\u4e3e$k$\u8981$O(n)$\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u800c\u4e32\u6709$\\lfloor\\dfrac{n}{k}\\rfloor$\u4e2a\uff0c\u6240\u4ee5\u679a\u4e3e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\n\n$$\\displaystyle\\sum_{k=1}^n\\lfloor\\dfrac{n}{k}\\rfloor$$\n\n\u5c55\u5f00\u540e\u5f97\u5230\n\n$$\\lfloor\\dfrac{n}{1}\\rfloor+\\lfloor\\dfrac{n}{2}\\rfloor+...+\\lfloor\\dfrac{n}{n}\\rfloor$$\n\n\u8fd1\u4f3c\u4e8e\n\n$$\\dfrac{n}{1}+\\dfrac{n}{2}+...+\\dfrac{n}{n}$$\n\n\u628a$n$\u63d0\u51fa\u6765\u5f97\u5230\n\n$$n(1+\\dfrac{1}{2}+...+\\dfrac{1}{n})$$\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0$1+\\dfrac{1}{2}+...+\\dfrac{1}{n}$\u4e3a\u8c03\u548c\u7ea7\u6570\uff0c\u6709\n\n$$1+\\dfrac{1}{2}+...+\\dfrac{1}{n}\\approx\\ln n<\\log_2n$$\n\n\u53c8\u56e0\u4e3a\u6211\u4eec\u7684\u6bd4\u8f83\u548c\u8bb0\u5f55\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f$O(1)$\u7684\uff0c\u6240\u4ee5\u603b\u5171\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4fbf\u662f$O(n\\log n)$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u4fbf\u53ef\u4ee5\u60f3\u5230\u4f7f\u7528**\u54c8\u5e0c**\u3002\n\n\u4e0e\u4e00\u822c\u7684\u54c8\u5e0c\u4e00\u6837\uff0c\u6211\u4eec\u5148\u4ece\u5934\u5f04\u4e00\u4e2a\u524d\u7f00\u54c8\u5e0c\u548c\u5e42\u6570\u7ec4\uff0c\u8fd9\u6837\u82e5\u8981\u6c42$i$\u5230$j$\u4f4d\u6570\u5b57\u7684\u54c8\u5e0c\u503c\u4fbf\u53ef\u4ee5\u7528$hash[j]-hash[i-1]*power[j-i+1]$\u8fd9\u6837\u6765\u8fdb\u884c\u8ba1\u7b97\u3002\u4f46\u7279\u522b\u7684\uff0c\u8fd9\u9898\u89c4\u5b9a\u4e32\u662f\u53ef\u4ee5\u7ffb\u8f6c\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u4e5f\u8981\u4ece\u5c3e\u5f04\u4e00\u4e2a\u540e\u7f00\u54c8\u5e0c\uff0c\u4e0e\u524d\u9762\u4e00\u6837\uff0c\u53ea\u4e0d\u8fc7\u987a\u5e8f\u76f8\u53cd\u7f62\u4e86\u3002\u8981\u6c42$i$\u5230$j$\u4f4d\u6570\u5b57\u7684\u54c8\u5e0c\u503c\u53ef\u4ee5\u8fd9\u6837\u8ba1\u7b97\uff1a$hash[i]-hash[j+1]*power[j-i+1]$\u3002\u8fd9\u6837\uff0c\u67e5\u8be2\u67d0\u4e2a\u5b50\u4e32\u4fbf\u53ef\u4ee5\u8fd9\u6837\u5b9e\u73b0$O(1)$\u67e5\u8be2\u3002\u4e3a\u4e86\u4e0d\u51b2\u7a81\uff0c\u6b64\u5904$power$\u6bcf\u6b21\u8981**\u4e58\u4e00\u4e2a\u5f88\u5927\u7684\u8d28\u6570**\u624d\u884c\uff0c\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u3002\n\n\u90a3\u4e48\u6211\u4eec\u7684\u54c8\u5e0c\u600e\u4e48\u5224\u91cd\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u7528\u9664\u4f59\u6cd5\uff0c\u82e5\u51b2\u7a81\u5219\u5728\u4e0b\u4e00\u4f4d\u4fdd\u5b58\u3002\u5982\u679c\u6211\u4eec\u5728\u5224\u91cd\u65f6\u6b63\u53cd\u987a\u5e8f\u4e24\u4e2a\u90fd\u4e0d\u51b2\u7a81\uff0c\u6211\u4eec\u624d\u8ba4\u4e3a\u5b83\u662f\u65b0\u4e32\uff0c\u5e76\u5c06\u6b63\u53cd\u987a\u5e8f\u7684\u54c8\u5e0c\u503c\u4fdd\u5b58\u4e0b\u6765\u3002\n\n\u4f46\u662f\u6211\u4eec\u8fd9\u91cc\u6bcf\u679a\u4e3e\u4e00\u6b21$k$\uff0c\u90fd\u8981\u6e05\u7a7a\u5224\u91cd\u6570\u7ec4\uff0c\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u5f88\u9ad8\u7684\uff0c\u600e\u4e48\u529e\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a$time$\u6570\u7ec4\uff0c\u8868\u793a\u4f7f\u7528\u5f53\u524d\u4f4d\u7684\u65f6\u95f4\uff0c\u82e5\u4ed6\u7684\u503c\u4e3a\u89c4\u5b9a\u7684\u65f6\u95f4\uff0c\u5c31\u8bf4\u660e\u5b83\u5728\u5f53\u524d\u65f6\u95f4\u88ab\u66f4\u65b0\u8fc7\u4e86\uff0c\u5c31\u8981\u5bf9\u5f53\u524d\u4f4d\u7684\u6570\u8fdb\u884c\u5224\u91cd\uff0c\u5426\u5219\u8bf4\u660e\u8fd9\u4e2a\u503c\u53ea\u662f\u5728\u4e4b\u524d\u7684\u65f6\u95f4\u88ab\u66f4\u65b0\u8fc7\uff0c\u4e0e\u73b0\u5728\u65e0\u5173\uff0c\u5c31\u8868\u660e\u5f53\u524d\u4f4d\u65e0\u503c\u3002\u8fd9\u6837\u5c31\u4e0d\u7528\u6bcf\u6b21\u90fd\u66f4\u65b0\u5224\u91cd\u6570\u7ec4\u4e86\u3002\n\n\u5176\u4ed6\u8bb0\u5f55\u7b54\u6848\u4ec0\u4e48\u7684\u5c31\u662f\u6734\u7d20\u7684\u66b4\u529b\u505a\u6cd5\u5566~\n\n## \u4ee3\u7801\uff1a\n\n```c++\n#include<cstdio>//\u4ee5\u4e0b\u4e3a\u4e86\u9632\u6b62\u4e0d\u5fc5\u8981\u7684\u9519\u8bef\uff0c\u7c7b\u578b\u6211\u5168\u90fd\u5f00\u6210\u4e86unsigned long long\nunsigned long long n,m,i,j1,j2,k,max,nans,ans[200005],a[200005],hash[1000007],b[1000007],power[200005],ha1[200005],ha2[200005];//\u6b64\u5904\u7684hash\u4e3a\u5224\u91cd\u6570\u7ec4\uff0cb\u4e3atime\u6570\u7ec4\uff0cpower\u4e3a\u5e42\u6570\u7ec4\uff0cha1\u4e3a\u524d\u7f00\u54c8\u5e0c\uff0cha2\u4e3a\u540e\u7f00\u54c8\u5e0c\nunsigned long long ha(unsigned long long x)//\u5224\u91cd\n{\n\tunsigned long long y=x%1000007;\n\tif (b[y]==m&&hash[y]!=x)\n\t{\n\t\ty++;\n\t\tif (y==n/m)\n\t\ty=0;\n\t}\n\treturn y;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tpower[0]=1;\n\tfor (m=1;m<=n;m++)\n\tscanf(\"%d\",&a[m]),power[m]=power[m-1]*19260817,ha1[m]=ha1[m-1]*19260817+a[m];//\u8bfb\u5165\u5e76\u9884\u5904\u7406\u5e42\u6570\u7ec4\u4e0e\u524d\u7f00\u54c8\u5e0c\n\tfor (m=n;m;m--)\n\tha2[m]=ha2[m+1]*19260817+a[m];//\u9884\u5904\u7406\u540e\u7f00\u54c8\u5e0c\n\tfor (m=1;m<=n;m++)//\u679a\u4e3e\u9898\u76ee\u4e2d\u7684k\n\t{\n\t\tk=0;//k\u4e3a\u4e0d\u540c\u4e32\u7684\u4e2a\u6570\n\t\tfor (i=m+1;i<=n+1;i+=m)\n\t\t{\n\t\t\tj1=ha(ha1[i-1]-ha1[i-m-1]*power[m]);\n\t\t\tif (hash[j1]==ha1[i-1]-ha1[i-m-1]*power[m])//\u5224\u65ad\u6b63\u5e8f\u662f\u5426\u91cd\u590d\n\t\t\tcontinue;\n\t\t\tj2=ha(ha2[i-m]-ha2[i]*power[m]);\n\t\t\tif (hash[j2]==ha2[i-m]-ha2[i]*power[m])//\u5224\u65ad\u53cd\u5e8f\u662f\u5426\u91cd\u590d\n\t\t\tcontinue;\n\t\t\tb[j1]=b[j2]=m,hash[j1]=ha1[i-1]-ha1[i-m-1]*power[m],hash[j2]=ha2[i-m]-ha2[i]*power[m],k++;//\u8bb0\u5f55\u65f6\u95f4\u6233\uff0c\u4fdd\u5b58\u6b63\u53cd\u987a\u5e8f\u4e24\u4e2a\u4e32\n\t\t}\n\t\t//\u4ee5\u4e0b\u4e3a\u8bb0\u5f55\u7b54\u6848\n\t\tif (k>max)\n\t\tmax=k,nans=1,ans[1]=m;\n\t\telse\n\t\tif (k==max)\n\t\tnans++,ans[nans]=m;\n\t}\n\tprintf(\"%lld %lld\\n\",max,nans);\n\tfor (m=1;m<=nans;m++)\n\tprintf(\"%lld \",ans[m]);\n\treturn 0;\n}\n```\n",
        "postTime": 1534408157,
        "uid": 7535,
        "name": "beng",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3498 \u3010[POI2010]KOR-Beads\u3011"
    },
    {
        "content": "\u6b64\u9898\u4e0e\u54c8\u5e0c\u8868\u5173\u7cfb\u4e0d\u5927\uff0c\u53ea\u8981\u6c42\u51fa\u54c8\u5e0c\u524d\u7f00\u548c\u540e\u7f00\u548c\u5373\u53ef\uff01\n\n\u8be6\u7ec6\u4ee3\u7801\u6ce8\u91ca\u5982\u4e0b\uff1a\n\n\n```cpp\n//#pragma GCC optimize(3)\n\n#include<bits/stdc++.h>\n\nusing namespace std;\n\ninline int read() {\n\tint x = 0, f = 1;\n\tchar c = getchar();\n\twhile (c < '0' || c > '9') {\n\t\tif(c == '-') {\n\t\t\tf = -1;\n\t\t}\n\t\tc = getchar();\n\t}\n\twhile (c <= '9' && c >= '0') {\n\t\tx = (x << 1) + (x << 3) + (c ^ 48), c = getchar();\n\t}\n\treturn x * f;\n}\n\n#define Mem(a, x) memset(a, x, sizeof(a))\n#define Binary l + r >> 1\n#define Inf 2147483647\n\nusing namespace std;\n\nconst unsigned int kM = 10000007;  // \u8d28\u6570\nconst unsigned int kB = 19260817;  // \u8fdb\u5236\u5e95\u6570\nconst int Maxn = 200003;\n\nint h[kM];  // \u54c8\u5e0c\u8868\uff0c\u6807\u8bb0\u6309k\u5207\u5206\u662f\u5426\u5360\u7528\nint a[Maxn], l[Maxn];\nunsigned long long pre[Maxn], suf[Maxn], pw[Maxn];  // \u524d\u7f00\u54c8\u5e0c\u548c\u3001\u540e\u7f00\u54c8\u5e0c\u548c\u3001\u5e95\u6570\u6307\u6570 \nint n, m, ans, ansc;\n\nvoid Init() {  // \u521d\u59cb\u5316\u54c8\u5e0c\u548c\n\tpw[0] = 1;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tpw[i] = pw[i - 1] * kB % kM;           // \u6307\u6570\u7d2f\u4e58\n\t\tpre[i] = (pre[i - 1] * kB + a[i]) % kM;  // \u524d\u7f00\u7d2f\u52a0\n\t}\n\tfor (int i = n; i >= 1; --i) {\n\t\tsuf[i] = (suf[i + 1] * kB + a[i]) % kM;  // \u540e\u7f00\u7d2f\u52a0\n\t}\n\treturn; \n}\n\nint main() {\n\tn = read();\n\tfor (int i = 1; i <= n; ++i) {\n\t\tcin >> a[i];\n\t}\n\tInit();\n\tfor (int k = 1; n / k >= ans; ++k) {              // \u5207\u5272\u957f\u5ea6\n\t\tint t = 0;                                      // \u4e0d\u540c\u5b50\u5e8f\u5217\u4e2a\u6570\n\t\tfor (int i = k; i <= n; i += k) {               // \u5207\u5272\n\t\t\tint p = (pre[i] - pre[i - k] * pw[k]) % kM;  // \u6b63\u5411\u5e8f\u5217\u54c8\u5e0c\n\t\t\tif (h[p] == k) {                              // \u51fa\u73b0\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tt++;                                              // \u7d2f\u52a0\u7b54\u6848\n\t\t\th[p] = k;                                         // \u6807\u8bb0\u6b63\u5411\u5e8f\u5217\n\t\t\tp = (suf[i - k + 1] - suf[i + 1] * pw[k]) % kM;  // \u53cd\u5411\u5e8f\u5217\u54c8\u5e0c\n\t\t\th[p] = k;                                         // \u6807\u8bb0\u53cd\u5411\u5e8f\u5217\n\t\t}\n\t\tif (t > ans) {  // \u66f4\u65b0\u7b54\u6848\n\t\t\tans = t;\n\t\t\tansc = 0;\n\t\t}\n\t\tif (t == ans) {\n\t\t\tl[++ansc] = k;\n\t\t}\n\t}\n\t// \u8f93\u51fa\u7b54\u6848\n\tprintf(\"%d \", ans);\n\tprintf(\"%d\\n\", ansc);\n\tfor (int i = 1; i <= ansc; ++i) {\n\t\tprintf(\"%d \", l[i]);\n\t}\n\tputs(\"\");\n\treturn 0;\n}\n```\n",
        "postTime": 1578815908,
        "uid": 130812,
        "name": "XyzL",
        "ccfLevel": 0,
        "title": "P3498 [POI2010]KOR-Beads \u9898\u89e3"
    },
    {
        "content": "\u54c8\u5e0c\u9898\u3002\u5c3d\u81ea\u5df1\u6240\u80fd\u5199\u4e00\u7bc7\u4f5c\u4e3a\u849f\u84bb\u90fd\u80fd\u770b\u61c2\u7684\u9898\u89e3\u3002\n\n\u7b80\u5316\u9898\u610f\uff1a\u5c06\u4e00\u6574\u6bb5\u5b57\u7b26\u4e32\u5206\u6210\u82e5\u5e72\u6bb5\uff0c\u6bcf\u6bb5\u7684\u957f\u5ea6\u76f8\u7b49\u3002\u76f4\u81f3\u5269\u4e0b\u7684\u957f\u5ea6\u5c0f\u4e8e\u4e00\u5c0f\u6bb5\u7684\u957f\u5ea6.\u6c42\u6700\u591a\u80fd\u5206\u6210\u51e0\u6bb5\uff1f\u6709\u51e0\u79cd\u5206\u6cd5\uff1f\u5206\u522b\u4ee5\u54ea\u4e9b\u957f\u5ea6\u4f5c\u4e3a\u4e00\u5c0f\u6bb5\u53bb\u5206\uff1f\n\n\u672c\u9898\u4e3b\u8981\u5206\u4e3a\u4e24\u90e8\u5206: \n- \u679a\u4e3e\u5206\u6210\u7684\u6bb5  \n- \u5224\u91cd\uff0c\u8ba1\u6570\n\n\u5206\u6790\uff1a\u56e0\u4e3a\u786e\u5b9a\u4e86 $k$ \uff0c\u5206\u6210\u82e5\u5e72\u6bb5\u7684\u7ed3\u679c\u5c31\u786e\u5b9a\u4e86\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $k$ \u76f4\u63a5\u679a\u4e3e\u5206\u6210\u7684\u6bb5\uff0c\u7136\u540e\u53bb\u6389\u91cd\u590d\u7684\uff0c\u518d\u8ba1\u6570\u3002\u6709\u4e9b\u4eba\u8ba4\u4e3a\u8fd9\u6837\u679a\u4e3e\u7684\u65f6\u95f4\u4f1a\u662f $O(n^2)$\u3002\u5176\u5b9e\u4e0d\u7136\u3002\n\n\u56e0\u4e3a\u6bcf\u4e00\u4e2a $k$\uff0c\u5206\u6210\u7684\u6bb5\u6570\u4e3a $n/k$\uff0c\u6240\u4ee5\u5bf9\u4e8e\u6240\u6709\u7684 $k$ \u5168\u90e8\u52a0\u8d77\u6765\u7684\u6bb5\u6570\u4e3a :$\\sum_{k=1}^n \\frac{n}{k}= n(\\sum_{k=1}^n\\frac{1}{k} )$  \u5bf9\u4e8e\u8c03\u548c\u7ea7\u6570$\\sum_{k=1}^n\\frac{1}{k}$\uff0c\u6709\u5b9a\u7406\uff1a$\\frac{1}{1}+\\frac{1}{2}+\\frac{1}{3}+\\frac{1}{4}+......+\\frac{1}{n}\u2248\\ln n $ \uff1c $logn$\u3002\u6b64\u65f6\u7684\u679a\u4e3e\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f $O(nlogn)$\n\n\u4f18\u5316\uff1a\u6839\u636e\u6837\u4f8b\u7ed9\u51fa\u7684\uff0c\u89c2\u5bdf\u53d1\u73b0\uff0c\u56e0\u4e3a\u662f\u6309\u987a\u5e8f $k$ \u4e00\u622a\uff0c $k$ \u622a\uff0c\u6240\u4ee5\u5982\u679c\u786e\u5b9a\u4e86$k$\uff0c\u90a3\u4e48\u5206\u6210\u82e5\u5e72\u6bb5\u7684\u7ed3\u679c\u5c31\u786e\u5b9a\u4e86\u3002\u540c\u65f6\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $k$ \uff0c\u4e0d\u540c\u7684\u6bb5\u6700\u591a\u80fd\u6709 $n/k$ \u79cd\u3002\u6240\u4ee5\uff0c\u5982\u679c\u5f53\u524d\u5df2\u7ecf\u5f97\u5230\u4e86 $m$ \u6bb5\uff0c\u90a3\u4e48 $k\u2265n/m$ \u7684\u60c5\u51b5\u5c31\u4e0d\u7528\u8003\u8651\u4e86\u3002\n- \u4f8b\u5982\uff1a$k=2$ \u7684\u65f6\u5019\uff0c\u6211\u4eec\u5f97\u5230 6 \u4e2a\u4e0d\u540c\u7684\u6bb5\u3002\u90a3\u4e48k\u6700\u5927\u5c31\u4e5f\u53ea\u53ef\u80fd\u53d6\u5230 $21/6$ $->3$ \n\n\n\u63a5\u4e0b\u6765\u662f\u5224\u91cd\uff0c\u8ba1\u6570\u90e8\u5206\u3002\n\n\u6b63\u5e8f\u7684\u6bb5\uff0c\u5c31\u7528\u524d\u7f00\u54c8\u5e0c\u5904\u7406\u3002\u540e\u5e8f\u7684\u6bb5\uff0c\u5c31\u7528\u540e\u7f00\u7684\u54c8\u5e0c\u5904\u7406\u3002\n\n\u6839\u636e\u54c8\u5e0c\u516c\u5f0f\uff1a$H(C')=H(C,k+n)-H(C,k)\u00d7b^n$\n\n\u6bb5 $s_{i+1}-s_{i+4}$ \u6b63\u5e8f\u5c31\u4e3a $sum_{i+4}-s_{i}\u00d7b^3$ \u9006\u5e8f\u5c31\u4e3a $num_{i+1}-num_{i+5}\u00d7b^3$ \uff08\u56e0\u4e3a**\u524d\u7f00\u54c8\u5e0c\u662f\u4ece\u524d\u5f80\u540e\u8fdb\u884c\u54c8\u5e0c**\u7684\uff0c\u800c**\u540e\u7f00\u662f\u4ece\u540e\u5f80\u524d\u8fdb\u884c\u54c8\u5e0c**\u7684\uff1b\u6240\u4ee5\u524d\u7f00\u54c8\u5e0c\u662f\u540e\u51cf\u524d\uff0c\u540e\u7f00\u54c8\u5e0c\u5c31\u662f\u524d\u51cf\u540e\uff09\n\n\u5904\u7406\u597d\u54c8\u5e0c\u540e\uff0c\u5c31\u662f\u5224\u91cd\uff1a\n\n\u65b9\u6cd5\u4e00\uff1a\u7528 $map$ \u6807\u8bb0\n\n\u65b9\u6cd5\u4e8c\uff1a\u7528 $set$ \u5b58\u50a8\u81ea\u52a8\u53bb\u91cd\n\n\uff08\u4fd7\u8bdd\u8bf4\uff1a~~\u80fd\u7528 STL \u7684\uff0c\u4e3a\u4ec0\u4e48\u8981\u81ea\u5df1\u5199~~\uff09\n\n\u5bf9\u4e8e\u65b9\u6cd5\u4e00\uff0c\u76f4\u63a5\n```cpp\nif(mp[sum[j]-sum[j-k]*a[k]]!=1)\n{\n\t\tmp[sum[j]-sum[j-k]*a[k]]=1;\n\t\tmp[num[j-k+1]-num[j+1]*a[k]]=1;\n\t\tres++;\n}\n```\n\n\u5bf9\u4e8e\u65b9\u6cd5\u4e8c\uff1a\u628a\u524d\u7f00\u7684\u54c8\u5e0c\u503c $\u00d7$ \u540e\u7f00\u7684\u54c8\u5e0c\u503c\u3002\u518d\u5b58\u5165 $set$ \u3002\u5982\u679c $set$ \u4e2d\u5b58\u5728\uff0c\u5c31\u8df3\u8fc7\n\n```cpp\n\tif(S.count(t3)) \n    continue;\n\tS.insert(t3);\n\tres++;\n```\n\n$End$ $!$ $!$ $!$\n\n$Code:$\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll base=1e9+7;\nstruct node{\n\tint ans,seat;\n}q[300010];\nint s[200010];\nll a[200010],sum[200010],num[200010];\nll res,cnt;\nset<ll> S;\nbool cmp(node x,node y)\n{\n\tif(x.ans==y.ans)\n\treturn x.seat<y.seat;\n\treturn x.ans>y.ans;\n}\nint main()\n{\n\tll i,j,k;\n\tll n,m;\n\tcin>>n;\n\tfor(i=1;i<=n;i++)\n\t{\n\t\tcin>>s[i];\n\t}\n\ta[0]=1;\n\tfor(i=1;i<=n;i++)\n\ta[i]=a[i-1]*base;\n\tfor(i=1;i<=n;i++)\n\tsum[i]=sum[i-1]*base+s[i];\n\tfor(i=n;i>=1;i--)\n\tnum[i]=num[i+1]*base+s[i];\n\tm=n;\n\tfor(k=1;k<=m;k++)\n\t{\n\t\tres=0;\n\t\tfor(j=k;j<=n;j+=k)\n\t\t{\n\t\t\tll t1=sum[j]-sum[j-k]*a[k];\n\t\t\tll t2=num[j-k+1]-num[j+1]*a[k];\n\t\t\tll t3=t1*t2;\n\t\t\tif(S.count(t3))continue;\n            S.insert(t3);\n            res++;\n\t\t}\n\t\tif(res!=0)\n\t\t{\n\t\t\tm=min(m,n/res);\n\t\t\tq[++cnt].ans=res;\n\t\t\tq[cnt].seat=k;\n\t\t}\n\t}\n\tsort(q+1,q+1+cnt,cmp);\n   //\u7edf\u8ba1\u65b9\u6848\u7684 k\n\tfor(i=2;i<=cnt;i++)\n\t{\n\t\tif(q[i].ans!=q[i-1].ans)\n\t\tbreak;\n\t}\n\tcout<<q[1].ans<<\" \"<<i-1<<endl;\n\tfor(j=1;j<i;j++)\n\tprintf(\"%d \",q[j].seat);\n\treturn 0;\n}\n\n```\n\n",
        "postTime": 1598922033,
        "uid": 225100,
        "name": "ice_in_sky",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3498 \u3010[POI2010]KOR-Beads\u3011"
    },
    {
        "content": "**Upd\uff1a\u62b1\u6b49\uff0c\u6ca1\u6709\u6ce8\u610f\u5230 md \u70b8\u4e86 qwq**\n\n### Description\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3498)\n\n\u6709 $n$ \u4e2a\u6570 $a_1\\sim a_n$\uff0c\u5c06\u8fd9 $n$ \u4e2a\u6570\u5206\u5272\u4e3a\u8fde\u7eed\u7684\u3001\u957f\u5ea6\u4e3a $k$ \u7684 $\\large\\lfloor\\frac nk\\rfloor$ \u6bb5\uff0c\u95ee\u6709\u54ea\u4e9b $k$ \u53ef\u4ee5\u4f7f\u5f97\u5305\u542b\u6570\u4e0d\u540c\u7684\u6bb5\u6570\u6700\u591a\u3002\n\n\u6ce8\uff1a\u6bb5\u53ef\u4ee5\u7ffb\u8f6c\uff0c\u5982 $1,2,3$ \u5728\u672c\u9898\u7b49\u4ef7\u4e8e $3,2,1$\u3002\n\n***\n\n### Solution\n\n\u4e00\u4e2a\u5f88\u597d\u60f3\u5230\u7684\u66b4\u529b\u6253\u6cd5\u5c31\u662f\uff0c\u628a $a$ \u7528\u6b63\u53cd\u4e24\u4e2a `string` \u5b58\u50a8\uff0c\u679a\u4e3e $k$\uff0c\u6a21\u62df\u5206\u5272\u8fc7\u7a0b\uff0c\u4ee5 $k$ \u4e3a\u8d77\u70b9\uff0c\u4e0d\u65ad\u622a\u53d6\u957f\u5ea6\u4e3a $k$ \u7684\u5b50\u4e32\uff0c\u7528 `set<string>` \u6216 `map<string,bool>` \u5224\u91cd\u3002\n\n\u6b64\u65f6\u6e05\u7a7a $\\mathcal O(\\log n)$\uff0c\u66f4\u65b0 $\\mathcal O(\\log n)$\uff0c\u67e5\u8be2 & \u5224\u91cd $\\mathcal O(\\log n)$\uff0c\u603b\u4f53\u65f6\u95f4\u590d\u6742\u5ea6 $\\large\\mathcal O(\\sum\\limits_{i=1}^n\\frac ni\\times \\log n)$\u3002\n\n\u6b38\uff1f\u90a3\u4e48\u4e0a\u9762\u8fd9\u4e00\u5927\u5768\u5927\u6982\u662f\u4e2a\u4ec0\u4e48\u6570\u91cf\u7ea7\u5462\uff1f\n\n\u4e0d\u77e5\u9053\u5927\u5bb6\u6709\u6ca1\u6709\u542c\u8bf4\u8fc7\u4e00\u4e2a\u540d\u4e3a [\u8c03\u548c\u7ea7\u6570](https://baike.baidu.com/item/%E8%B0%83%E5%92%8C%E7%BA%A7%E6%95%B0/8019971) \u7684\u4e1c\u897f\u3002\n\n> $$\n> \\sum_{i=1}^n\\frac1i=\\ln(n+1)+\\gamma\n> $$\n>\n> \u6ce8\uff1a\u6765\u81ea\u4e8e [\u8c03\u548c\u7ea7\u6570_\u767e\u5ea6\u767e\u79d1](https://baike.baidu.com/item/%E8%B0%83%E5%92%8C%E7%BA%A7%E6%95%B0/8019971)\u3002\n\n\u5176\u4e2d\uff0c$\\gamma$ \u8868\u793a [\u6b27\u62c9\u5e38\u6570](https://baike.baidu.com/item/\u6b27\u62c9\u5e38\u6570/5371177)\uff0c\u5176\u503c\u7ea6\u4e3a $0.57721$\uff1b$\\ln(n+1)\\approx\\log_2(n)$\n\n\u6240\u4ee5\u6211\u4eec\u5927\u53ef\u4ee5\u5728\u8ba1\u7b97\u65f6\u7701\u7565\u6389\u5b83\u3002\u63a5\u7740\u5bf9\u5f0f\u5b50\u53d8\u5f62\u3002\n$$\n\\begin{aligned}\n\\sum_{i=1}^n\\frac ni\\times\\log_2(n)&=n\\times \\log_2(n)\\times\\sum_{i=1}^n\\frac1i\\\\\n&=n\\times\\log_2(n)\\times[\\ \\ln(n+1)+\\gamma\\ ]\\\\\n&\\approx n\\log n\\log n\n\\end{aligned}\n$$\n\u55ef\uff0c\u770b\u8d77\u6765 $2\\times10^5$ \u7684\u6570\u636e\u5f88\u5403\u529b\u7684\u6837\u5b50\u3002\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u4f18\u5316\u3002\n\n#### \u4f18\u53161\uff1a\u5b57\u7b26\u4e32 Hash\n\n\u8fd9\u4e2a\u4f18\u5316\u53ef\u4ee5\u76f4\u63a5\u8ba9\u4ee3\u7801\u6548\u7387\u63d0\u5347\u4e00\u4e2a\u6863\u6b21\u3002\n\n\u540c\u6837\u4f7f\u7528\u6b63\u53cd\u4e24\u4e2a `hash` \u6570\u7ec4\u5bf9 $a$ \u8fdb\u884c\u54c8\u5e0c\uff0c\u5373\u53ef\u5c06\u4f4e\u6548\u7684 `string` \u66f4\u6362\u4e3a\u6548\u7387\u66f4\u9ad8\u7684 `ull`\u3002\n\n\u4e3b\u8981\u662f\u6ce8\u610f\u521d\u59cb\u5316\u548c\u67e5\u8be2\u54c8\u5e0c\u503c\u65f6\u7684\u6b63\u53cd\u95ee\u9898\u3002\n\n#### \u4f18\u53162\uff1a\u6700\u4f18\u6027 ~~\u526a\u679d~~\n\n\u5047\u8bbe\u7edf\u8ba1\u5230 $[\\ i,i+k)$ \u8fd9\u4e2a\u5b50\u4e32\u65f6\u5171\u6709 $tot$ \u4e2a\u4e92\u4e0d\u76f8\u540c\u7684\u5b50\u4e32\uff0c\u5269\u4f59\u7684\u90e8\u5206\uff08\u5373 $[\\ i+k,n\\ ]$ \uff09\u4e2d\uff0c\u6309\u5269\u4e0b\u7684\u6bcf\u4e00\u4e32\u90fd\u4e0e\u524d\u9762\u7684\u4e0d\u76f8\u540c\u6765\u7b97\uff0c\u6700\u591a\u4e5f\u5c31 $(n-i+k)\\div k$ \u4e2a\uff0c\u82e5 $tot+(n-i+k)\\div k$ \u4ecd\u7136\u6ca1\u6709\u5f53\u524d\u6700\u5927\u7b54\u6848\u591a\uff0c\u5373\u6309\u6700\u4f18\u53ef\u80fd\u6027\u6765\u7b97\uff0c\u4ecd\u7136\u65e0\u6cd5\u66f4\u65b0\u7b54\u6848\uff0c\u76f4\u63a5 `break`\u3002\n\n#### \u4f18\u53163\uff1a\u6570\u636e\u7ed3\u6784\u4f18\u5316\n\n\u80fd\u7528 STL \u5e72\u561b\u8981\u624b\u5199\u5224\u91cd\u5462\uff1f\n\n\u7ecf\u8fc7\u4f5c\u8005\u5b9e\u9a8c\uff0c\u5728 O2 \u73af\u5883\u4e0b\uff0c\u7b97\u4e0a\u8bc4\u6d4b\u59ec\u6ce2\u52a8\u7b49\u539f\u56e0\uff0c\u4ee5\u4e0b\u6570\u636e\u7ed3\u6784\u7528\u65f6\u4f9d\u6b21\u4e3a `unordered_map/hash_map > set \u2248 map`\uff0c\u4e14\u5747\u80fdAC\u3002\n\n\u7ecf\u8fc7\u4e0a\u8ff0\u4f18\u5316\uff0c\u4f60\u7684\u4ee3\u7801\u5c31\u53ef\u4ee5\u4ece TLE $\\to$ \u8f83\u4f18\u89e3\u4e86\u3002\n\n***\n\n### Code\n\n```cpp\n#include<set>\n#include<cstdio>\n#define GetHash0(l,r) HasH[0][r]-HasH[0][l-1]*PoW[r-l+1]\n#define GetHash1(l,r) HasH[1][l]-HasH[1][r+1]*PoW[r-l+1]\n#define int unsigned long long\nconst int maxn=2e5+5;\nconst int LEN=(1<<20);\nconst int _P_=1504831;  //\u7b2c 114514 \u4e2a\u8d28\u6570\nint n,tot,cnt,mx;\nstd::set<int>vis;\nint a[maxn],HasH[2][maxn],PoW[maxn],ans[maxn];\ninline int nec(){\n    static char buf[LEN],*p=buf,*e=buf;\n    if(p==e){\n        if((e=buf+fread(buf,1,LEN,stdin))==buf)\n            return EOF;\n        p=buf;\n    }\n    return *p++;\n}\ninline bool read(int&x){\n    static char neg=0,c=nec();\n    neg=0,x=0;\n    while((c<'0'||c>'9')&&c!='-'){\n        if(c==EOF)return 0;\n        c=nec();\n    }\n    if(c=='-'){\n        neg=1;\n        c=nec();\n    }\n    do{x=x*10+c-'0';}while((c=nec())>='0');\n    if(neg)x=-x;\n    return 1;\n}\ninline void init(void){\n    PoW[0]=1;\n    for(int i=1;i<=n;++i){\n        HasH[0][i]=HasH[0][i-1]*_P_+a[i];\t\t\t//\u6b63\u5411 hash\n        HasH[1][n-i+1]=HasH[1][n-i+2]*_P_+a[n-i+1];\t//\u53cd\u5411 hash\n        PoW[i]=PoW[i-1]*_P_;\t\t\t\t\t\t//\u5feb\u901f\u5e42\n    }\n    return;\n}\nsigned main(){\n    read(n);\n    for(int i=1;i<=n;++i)\n        read(a[i]);\n    init();\n    for(int i=1;i<=n;++i){\n        vis.clear();tot=0;\n        for(int j=i;j<=n;j+=i){\n            if(tot+(n-j+i)/i<mx)break;\t\t\t\t//\u4fdd\u8bc1\u7b54\u6848\u6700\u4f18\u6027\n            if(vis.find(GetHash0((j-i+1),j))==vis.end()){\n                vis.insert(GetHash0((j-i+1),j));\n                vis.insert(GetHash1((j-i+1),j));\n                ++tot;\n            }\n        }\n        if(tot>mx){mx=tot;ans[cnt=1]=i;}else if(tot==mx)\t//\u66f4\u65b0\u7b54\u6848 & \u5b58\u7b54\u6848\u5e8f\u5217\n        ans[++cnt]=i;\n    }\n    printf(\"%llu %llu\\n\",mx,cnt);\n    for(int i=1;i<=cnt;++i)\n        printf(\"%llu \",ans[i]);\n    return 0;\n}\n```\n\n***\n\n**end.**\n\n",
        "postTime": 1621703229,
        "uid": 245052,
        "name": "ollll62",
        "ccfLevel": 7,
        "title": "\u3010\u9898\u89e3\u3011 P3498 - [POI2010]KOR-Beads"
    },
    {
        "content": "[link](https://www.luogu.com.cn/problem/P3498)\u3002\n\n## \u9898\u76ee\u5927\u610f\n\n\u7ed9\u5b9a ${n}$ \u4e2a\u6570\uff0c\u5c06\u5b83\u4eec\u5206\u6210 **\u7b49\u957f** \u7684\u82e5\u5e72\u6bb5\uff0c\u6bcf\u4e00\u6bb5\u7684\u957f\u5ea6\u4e3a ${k}$\uff08\u957f\u5ea6\u4e0d\u8db3 ${k}$ \u7684\u4e0d\u7528\u7ba1\uff09\u3002\n\n\u95ee ${k}$ \u4e3a\u591a\u5c11\u65f6\u4f7f\u4e0d\u91cd\u590d\u6bb5\u7684\u6570\u91cf\u6700\u591a\uff0c\u6c42\u51fa\u8fd9\u4e2a\u6570\u91cf\u53ca ${k}$ \u7684\u503c\u3002\n\n**\u6ce8\u610f\uff1a\u82e5\u4e24\u4e2a\u4e32\u53ea\u662f\u6b63\u53cd\u98a0\u5012\uff0c\u90a3\u4e48\u4e5f\u7b97\u76f8\u540c\u3002**\n\n## \u601d\u8def\n\n\u9996\u5148\u770b\u5230\u6570\u636e\u8303\u56f4\uff1a${1 \\leq n \\leq 2 \\times 10 ^ 5}$\uff0c\u5c31\u7acb\u9a6c\u6253\u6d88\u4e86\u66b4\u529b\u7684\u5ff5\u5934\u3002\n\n\u8981\u6bd4\u8f83\u67d0\u4e00\u6bb5\u76f8\u7b49\u6211\u60f3\u5230\u53ef\u4ee5\u4f7f\u7528\u54c8\u5e0c\uff08[\u4e0d\u4f1a\u7684\u6233\u8fd9\u91cc](https://www.luogu.com.cn/problem/P3370))\u3002\n\n\u4f46\u662f\u8fd9\u9053\u9898\u6c42\u7684\u662f\u6574\u4e2a\u4e32\u4e2d\u7684\u5b50\u4e32\u60c5\u51b5\uff0c\u6240\u4ee5\u5e94\u8be5\u662f\u4e00\u4e2a\u533a\u95f4\u7684\u54c8\u5e0c\u503c\uff0c\n\u81ea\u7136\u60f3\u5230\u7528\u524d\u7f00\u548c\u7ef4\u62a4\u3002\n\n\u4f46\u7531\u4e8e\u82e5\u4e24\u4e2a\u4e32\u53ea\u662f\u6b63\u53cd\u98a0\u5012\u4e5f\u7b97\u76f8\u540c\uff0c\u6240\u4ee5\u8fd8\u9700\u7ef4\u62a4\u4e00\u4e2a\u540e\u7f00\u6570\u7ec4\u3002\n\n\u53e6\u5916\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u54c8\u5e0c\u7b97\u6cd5\u7684\u6b63\u786e\u7387\u66f4\u9ad8\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6570\u7ec4\u5b9a\u4e49\u4e3a `long long` \u7c7b\u578b\uff0c\u5e76\u4e14\u9002\u5f53\u628a\u8fdb\u5236 $base$ \u8c03\u5927\u3002\n\n\u8fd8\u6709\uff0c\u5176\u5b9e\u6211\u4eec\u5e76\u4e0d\u7528\u53bb\u5bf9\u54c8\u5e0c\u503c\u53d6\u6a21\uff0c\u53ef\u4ee5\u8ba9\u5b83\u81ea\u7136\u6ea2\u51fa\uff0c\u4ece\u800c\u4f7f\u54c8\u5e0c\u503c\u5728 `long long` \u7c7b\u578b\u4e2d\u8fdb\u884c\u5faa\u73af\uff08~~\u5176\u5b9e\u597d\u50cf\u548c\u53d6\u6a21\u6ca1\u4ec0\u4e48\u4e24\u6837~~\uff09\u3002\n\n**\u6ce8\u610f\uff1a\u6b64\u65f6\u6211\u4eec\u5e76\u4e0d\u80fd\u7528\u6570\u7ec4\u6765\u8bb0\u5f55\u6bcf\u4e2a\u54c8\u5e0c\u503c\u662f\u5426\u88ab\u6807\u8bb0\u8fc7\uff0c\u4e00\u662f\u6570\u7ec4\u6839\u672c\u5f00\u4e0d\u4e86\u8fd9\u4e48\u5927\uff0c\u4e8c\u662f\u6570\u7ec4\u4e0b\u6807\u4e0d\u80fd\u4e3a\u8d1f\uff01**\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 `set` \u6765\u8bb0\u5f55\uff0c\u6b63\u597d `set` \u4e5f\u53ef\u5bf9\u6570\u636e\u53bb\u91cd\u3002\n\n\u4ee3\u7801\u4e2d\u9644\u6709\u6ce8\u91ca\u3002\n\n## code\n```cpp\n#include <cstdio>\n#include <set>\n#define ll long long\n\nstatic char buf[10000], *p1 = buf, *p2 = buf;\n#define getchar() p1 == p2 && (p2 = (p1 = buf) + fread(buf, 1, 1000000, stdin), p1 == p2) ? EOF : *p1++\t//\u52a0\u5feb getchar \u7684\u901f\u5ea6\uff0c\u672c\u5730\u7f16\u8bd1\u5668\u53ca\u6bd4\u8d5b\u614e\u7528\u3002 \ninline void read(ll &t) {\n\tt = 0;\n\tll a = 1;\n\tchar ch = getchar();\n\twhile (ch < 48 || ch > 57) {\n\t\tif (ch == '-')\n\t\t\ta = -1;\n\t\tch = getchar();\n\t}\n\twhile (ch >= 48 && ch <= 57) {\n\t\tt = (t << 1) + (t << 3) + (ch ^ 48);\n\t\tch = getchar();\n\t}\n\tt *= a;\n}\n\ninline void write(ll t) {\n\tif (t < 10) {\n\t\tputchar(t + 48);\n\t\treturn ;\n\t}\n\twrite(t / 10);\n\tputchar(t % 10 + 48);\n}\t//\u4ee5\u4e0a\u662f\u5361\u5e38\u3002 \n\nconst int N = 2e5 + 5, base = 1331;\n\nusing namespace std;\n\nll n, a[N], sum1[N], sum2[N], p[N], res, l, x[N], s;\nbool f[N];\nset<ll> Hash;\nint main() {\n\tread(n);\n\tp[0] = 1;\n\tfor (int i = 1; i <= n; i++) {\n\t\tread(a[i]);\n\t\tif (!f[a[i]])\t//\u533a\u95f4\u957f\u4e3a 1 \u65f6\u7b54\u6848\u5c31\u662f\u4e0d\u540c\u5143\u7d20\u4e2a\u6570\uff0c\u8f93\u5165\u65f6\u7edf\u8ba1\u5373\u53ef\u3002 \n\t\t\tf[a[i]] = true, s++;\n\t\tsum1[i] = sum1[i - 1] * base + a[i];\t//sum1 \u8868\u793a Hash \u503c\u524d\u7f00\u548c\u3002 \n\t\tp[i] = p[i - 1] * base;\t//\u6c42 base \u7684\u5e42\uff08\u65b9\u4fbf\u540e\u7eed\u8ba1\u7b97\uff09\u3002 \n\t}\n\tfor (int i = n; i; i--)\n\t\tsum2[i] = sum2[i + 1] * base + a[i];\t//\u56e0\u4e3a sum2 \u4e3a Hash \u503c\u7684\u540e\u7f00\u548c\uff0c\u6240\u4ee5\u8981\u5728\u8f93\u5165\u5b8c\u6bd5\u540e\u4ece\u540e\u5f80\u524d\u5faa\u73af\u6c42\u5230\u3002 \n\tres = s, x[l = 1] = 1;\t//\u533a\u95f4\u957f\u4e3a 1 \u7684\u60c5\u51b5\u3002 \n\tfor (int i = 2; i <= n; i++) {\n\t\tHash.clear();\t//\u6bcf\u6b21\u8bb0\u5f97\u521d\u59cb\u5316\u3002 \n\t\tfor (int j = i; j <= n; j += i)\n\t\t\tHash.insert((sum1[j] - sum1[j - i] * p[i]) * (sum2[j - i + 1] - sum2[j + 1] * p[i]));\t//\u628a\u4e00\u4e2a\u4e32\u7684\u6b63\u5e8f\u54c8\u5e0c\u503c\u4e0e\u5012\u5e8f\u54c8\u5e0c\u503c\u4e58\u8d77\u6765\uff0c\u589e\u52a0\u6b63\u786e\u7387\u3002\n\t\tint ans = Hash.size();\t//\u53bb\u91cd\u540e\u7684\u6570\u91cf\u5c31\u662f\u5f53\u524d\u957f\u5ea6\u7684\u7b54\u6848\u3002 \n\t\tif (ans > res)\n\t\t\tres = ans, l = 1, x[l] = i;\t\t//\u66f4\u65b0\u7b54\u6848\u3002 \n\t\telse if (ans == res)\n\t\t\tx[++l] = i;\t\t//\u82e5\u4e0e\u5f53\u524d\u89e3\u76f8\u540c\uff0c\u589e\u52a0\u6b64\u7b54\u6848\u3002 \n\t}\n\twrite(res), putchar('\\n'), write(l), putchar('\\n');\n\tfor (int i = 1; i <= l; i++)\n\t\twrite(x[i]), putchar(' ');\n\treturn 0;\n}\n```\n\n## \u4f18\u5316\n\u867d\u7136\u8fd9\u6837\u53ef\u4ee5\u8fc7\u4e86\uff0c\u4f46\u8fd9\u4e2a[\u65f6\u95f4](https://www.luogu.com.cn/record/80682162)\u2026\u2026\n\n~~\u597d\u50cf\u6bd4\u6700\u4f18\u89e3\u6162 $40$ \u591a\u6beb\u79d2~~\u3002\n\n\u6211\u60f3\u4e00\u5b9a\u6709\u4ec0\u4e48\u65b9\u6cd5\u53ef\u4ee5\u4f18\u5316\uff0c\u4f46\u7b97\u6cd5\u4e2d\u679a\u4e3e\u5b50\u4e32\u7684\u5faa\u73af\u4e0d\u53ef\u7701\uff0c\u4e5f\u65e0\u6cd5\u7ee7\u7eed\u4f18\u5316\u3002\n\n\u4e8e\u662f\u6211\u628a\u76ee\u5149\u653e\u5728\u4e86\u679a\u4e3e\u5b50\u4e32\u7684\u957f\u5ea6\u7684\u5faa\u73af\u4e0a\u3002\n\n```cpp\n\tfor (int i = 2; i <= n; i++)\n```\n\u597d\u50cf\u5e76\u4e0d\u9700\u8981\u4ece $1$ \u679a\u4e3e\u5230 $n$\uff0c\u56e0\u4e3a\u5f53\u524d\u5df2\u7ecf\u6709\u6700\u4f18\u7b54\u6848 $res$ \u4e86\u3002\n\n\u800c\u679a\u4e3e\u4e00\u4e2a\u957f\u5ea6 $i$\uff0c\u6700\u4f18\u65f6\u5c31\u7b97\u6bcf\u4e00\u6bb5\u90fd\u4e0d\u540c\uff0c\u4e5f\u53ea\u6709 ${\\lfloor \\dfrac{n} {i}\\rfloor}$ \u79cd\uff0c\u6240\u4ee5\u5f53 ${\\dfrac{n} {i} > res}$ \u65f6\u6211\u4eec\u5c31\u4e0d\u7528\u7ee7\u7eed\u679a\u4e3e\u4e86\u3002\n\n\u5982\u4e0b\uff1a\n\n```cpp\n\tfor (int i = 2; i <= n / res; i++)\n```\n\n\u73b0\u5728\u5c31\u5feb\u591a\u4e86\uff1a[link](https://www.luogu.com.cn/record/80680314)\u3002",
        "postTime": 1658410208,
        "uid": 476921,
        "name": "_zhy",
        "ccfLevel": 7,
        "title": "P3498 [POI2010]KOR-Beads \u9898\u89e3"
    },
    {
        "content": "\u6709\u4e00\u4e2a\u795e\u5947\u7684\u4e1c\u897f\uff08\u8c03\u548c\u7ea7\u6570\uff09\uff1a\n\n\n\nn1+n2+n3+n4+\u22c5\u22c5\u22c5nn\u2248lnn<logn\n\n\u77e5\u9053\u4e86\u8fd9\u4e2a\u4ee5\u540e\uff0c\u8fd9\u9053\u9898\u5c31\u662f\u7b80\u5355\u7684\u5b57\u7b26\u4e32\u54c8\u5e0c\u4e86\u3002\n\n\u539f\u672c\u60f3\u7528Hash\u5224\u91cd\uff0c\u7ed3\u679c\u4ea4\u4e86\u4e00\u9762\u7684WA\u2026\u4e8e\u662f\u5c31\u7528set\u4e86\u3002\u4f46\u662f\u7f51\u4e0a\u770b\u9898\u89e3\uff0c\u8c8c\u4f3c\u6709\u4e00\u4e2aHash\u7528\u7684B\u7279\u522b\u5f3a\uff0c\u5728\u6b64\u5148\u8bb0\u4e0b\uff1a\n\n\n**\u4e0a\u4ee3\u7801**\n\n```cpp\n#include<stdio.h>\n#include<iostream>\n#include<set>\n#define ll unsigned long long\n#define B 200019\n#define M 200005\nusing namespace std;\nll Base[M],H1[M],H2[M];\nint A[M],Ans[M];\nset<ll>S;\nvoid Rd(int &res){\n    char c;res=0;\n    while(c=getchar(),!isdigit(c));\n    do{\n        res=(res<<1)+(res<<3)+(c^48);\n    }while(c=getchar(),isdigit(c));\n}\nint main(){\n    int n,ans=0,sz=0;\n    Rd(n);\n    for(int i=1;i<=n;i++)\n        Rd(A[i]);\n    Base[0]=1;\n    for(int i=1;i<=n;i++)\n        Base[i]=Base[i-1]*B;\n    for(int i=1;i<=n;i++)\n        H1[i]=H1[i-1]*B+A[i];\n    for(int i=n;i>=1;i--)\n        H2[i]=H2[i+1]*B+A[i];\n    for(int k=1;k<=n;k++){\n        if(n/k<ans)break;\n        S.clear();\n        int cnt=0;\n        for(int j=k;j<=n;j+=k){\n            ll t1=H1[j]-H1[j-k]*Base[k];\n            ll t2=H2[j-k+1]-H2[j+1]*Base[k];\n            ll t3=t1*t2;\n            if(S.count(t3))continue;\n            S.insert(t3);\n            cnt++;\n        }\n        if(cnt>ans){\n            ans=cnt;\n            sz=0;\n            Ans[++sz]=k;\n        }else if(cnt==ans)Ans[++sz]=k;\n    }\n    printf(\"%d %d\\n\",ans,sz);\n    for(int i=1;i<=sz;i++)\n        printf(\"%d%c\",Ans[i],i==sz?'\\n':' ');\n    return 0;\n}\n```",
        "postTime": 1486993631,
        "uid": 35946,
        "name": "\u795e\u7287\u7684\u849f\u84bb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3498 \u3010[POI2010]KOR-Beads\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u5e94\u8be5\u662f\u4e00\u9053\u4e0d\u9519\u7684\u54c8\u5e0c\u9898\u3002\n\n\u77e5\u9053\u90a3\u4e2a\u8c03\u548c\u7ea7\u6570\uff08\u5927\u5bb6\u53ef\u4ee5\u5728\u67d0\u5ea6\u4e0a\u627e\u5230\u5b9a\u4e49\uff09\u5e94\u8be5\u5c31\u53ef\u4ee5\u76f4\u63a5\u7528\u54c8\u5e0c\u6c42\u89e3\u4e86\u3002\n\n\u54e6\uff0c\u5bf9\uff0c\u5dee\u70b9\u5fd8\u4e86\uff0c\u6211\u4eec\u5e94\u8be5\u7528$set$\u53bb\u5224\u91cd\u3002\n\n# Code\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define N 200005\nconst int base=998344353;\nint n,a[N],hash_fr[N],hash_be[N],power[N],cnt,tot,num;\nint ans[N];\nset <int> st;\nsigned main()\n{\n\tcin>>n;\n\tpower[0]=1;\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",&a[i]),hash_fr[i]=hash_fr[i-1]*base+a[i],power[i]=power[i-1]*base;\n\tfor(int i=n;i;i--)hash_be[i]=hash_be[i+1]*base+a[i];\n\tfor(int k=1;k<=n;k++)\n\t{\n\t\tst.clear();cnt=0;\n\t\tfor(int i=k;i<=n;i+=k)\n\t\t{\n\t\t\tint now=(hash_fr[i]-hash_fr[i-k]*power[k])*(hash_be[i-k+1]-hash_be[i+1]*power[k]);\n\t\t\tif(st.count(now))continue;\n\t\t\tst.insert(now);\n\t\t\tcnt++;\n\t\t}\n\t\tif(cnt>tot)tot=cnt,num=1,ans[1]=k;\n\t\telse if(cnt==tot)ans[++num]=k;\n\t}\n\tcout<<tot<<\" \"<<num<<\"\\n\";\n\tfor(int i=1;i<=num;i++)\n\tcout<<ans[i]<<\" \";\n\treturn 0;\n}\n```\n",
        "postTime": 1620004341,
        "uid": 363272,
        "name": "FLAMEs_",
        "ccfLevel": 5,
        "title": "P3498 [POI2010]KOR-Beads \u9898\u89e3"
    },
    {
        "content": "\u8fd9\u9053\u9898\u662f\u8981\u6c42\u8fdb\u884c\u533a\u95f4\u5224\u91cd\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u50cf\u5b57\u7b26\u4e32\u5224\u91cd\u4e00\u6837\u7528\u54c8\u5e0c\u6765\u505a\uff0c\u56e0\u4e3a\u9898\u76ee\u4e0a\u8bf4\u4e86\u6b63\u5e8f\u548c\u5012\u5e8f\u90fd\u662f\u4e00\u6837\u7684\u3002\u6240\u4ee5\u6211\u4eec\u5f97\u5f00\u4e24\u4e2a\u54c8\u5e0c\u6570\u7ec4\uff0c\u4e00\u4e2a\u662f\u524d\u7f00\u54c8\u5e0c\u6570\u7ec4\uff0c\u4e00\u4e2a\u662f\u540e\u7f00\u54c8\u5e0c\u6570\u7ec4\uff0c\u81f3\u4e8e\u600e\u4e48\u6784\u9020\u54c8\u5e0c\uff0c\u6211\u4eec\u53ef\u4ee5\u50cf\u8fdb\u5236\u4e00\u6837\u6765\u6784\u9020\uff0c\u6211\u4eec\u4ee5\u524d\u7f00\u54c8\u5e0c\u6570\u7ec4\u4e3a\u4f8b\uff0c\u5c06\u7b2c $i$ \u4f4d\u7684\u54c8\u5e0c\u503c\u8bbe\u4e3a\u7b2c $i-1$ \u4f4d\u7684\u54c8\u5e0c\u503c\u4e0e\u8fd9\u4e00\u4f4d\u7684\u6570\u4e58\u4ee5\u67d0\u4e00\u4e2a\u6570\u7684 $i-1$ \u6b21\u5e42\uff0c\u81f3\u4e8e\u8fd9\u4e2a\u67d0\u4e00\u4e2a\u6570\u662f\u4ec0\u4e48\uff0c\u5efa\u8bae\u662f\u4e00\u4e2a\u8d28\u6570\uff0c\u6bd4\u5982 $19260817,10^9+7,10^9+9\u2026\u2026$\u5728\u8fd9\u91cc\u6211\u53d6\u7684\u8fd9\u4e00\u4e2a\u6570\u662f $n+1$\uff0c\u56e0\u4e3a\u9898\u76ee\u4e0a\u8bf4\u4e86\u6bcf\u4e2a\u6570\u6700\u5927\u4e0d\u8d85\u8fc7 $n$ \uff0c\u6240\u4ee5\u6211\u5c31\u53d6\u4e86\u4e2a $n+1$\uff08\u4f46\u6700\u597d\u8fd8\u662f\u53d6\u4e00\u4e2a\u8d28\u6570\uff0c\u8fd9\u6837\u53ef\u4ee5\u907f\u514d\u53d1\u751f\u54c8\u5e0c\u51b2\u7a81\u5931\u6389\u4e00\u4e9b\u4e0d\u8be5\u5931\u7684\u5206\uff0c\u4f46\u662f\u53d6 $n+1$ \u5bf9\u4e8e\u8fd9\u9053\u9898\u6765\u8bf4\u8fd8\u662f\u80fd AC \u7684\uff09\u3002\u63a5\u4e0b\u6765\u5c31\u662f\u8fdb\u884c\u54c8\u5e0c\u5224\u91cd\u4e86\uff0c\u4f46\u662f\u6211\u4eec\u5728\u8ba1\u7b97\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u65f6\u5019\u9700\u8981\u7528\u5230\u4e00\u4e2a\u53eb\u8c03\u548c\u7ea7\u6570\uff0c\u8fd9\u4e2a\u8c03\u548c\u7ea7\u6570\u662f\u8fd9\u6837\u7684\uff1a$1+\\dfrac{1}{2}+\\dfrac{1}{3}+\\dfrac{1}{4}+\u2026\u2026+\\dfrac{1}{n}<\\log n$\u3002\u6240\u4ee5\u5728\u8fdb\u884c\u679a\u4e3e $k$ \u7136\u540e\u679a\u4e3e\u6bcf\u4e00\u4e2a\u533a\u95f4\u5c31\u4e0d\u4f1a\u8d85\u8fc7 $n \\log n$ \u6b21\u3002\u6240\u4ee5\u53ef\u4ee5\u653e\u5fc3\u98df\u7528\u3002\u5728\u54c8\u5e0c\u5224\u91cd\u65f6\u6211\u7528\u7684\u662f map\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u7528 set \u6765\u8fdb\u884c\u3002\n\n# code:\n```cpp\n#include<cstdio>\n#include<map>\nusing namespace std;\nunsigned long long a[200005],c[200005],d[200005]={1};\nint b[200005],maxnn[200005],cnt;\nmap<unsigned long long,bool> mp;\nint main(){\n\tint n,i,j,maxn=0;\n\tscanf(\"%d\",&n);\n\tfor(i=1;i<=n;i++){\n\t\td[i]=d[i-1]*(n+1);\n\t}\n\tfor(i=1;i<=n;i++){\n\t\tscanf(\"%d\",&b[i]);\n\t\ta[i]=a[i-1]+b[i]*d[i-1];\n\t}\n\tfor(i=n;i;i--){\n\t\tc[i]=c[i+1]+b[i]*d[n-i];\n\t}\n\tfor(i=1;i<=n;i++){\n        int ans=0;\n\t\tmp.clear();\n\t\tfor(j=1;j<=n/i;j++){\n\t\t\tunsigned long long s=(c[(j-1)*i+1]-c[j*i+1])*d[j*i],t=(a[j*i]-a[(j-1)*i])*d[n-(j-1)*i];\n            if(!mp[s]&&!mp[t]){\n\t\t\t\tmp[s]=1;\n\t\t\t\tmp[t]=1;\n                ans++;\n\t\t\t}\n\t\t}\n\t\tif(maxn==ans){\n\t\t\tmaxnn[++cnt]=i;\n\t\t}\n\t\tif(maxn<ans){\n\t\t\tmaxn=ans;\n\t\t\tcnt=1;\n\t\t\tmaxnn[1]=i;\n\t\t}\n\t}\n\tprintf(\"%d %d\\n\",maxn,cnt);\n\tfor(i=1;i<=cnt;i++){\n\t\tprintf(\"%d \",maxnn[i]);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1587377165,
        "uid": 80614,
        "name": "ZCPB",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3498 \u3010[POI2010]KOR-Beads\u3011"
    },
    {
        "content": "## \u9898\u76ee\u7b80\u8ff0\n\n$n$\u4e2a\u6570\uff0c\u53ef\u4ee5\u6309\u7167\u957f\u5ea6\u4e3a$k$\u5206\u4e3a$[1,k],[k+1,2\\times k],\\cdots$\u5171$\\left\\lfloor\\dfrac{n}{k}\\right\\rfloor$\u6761\u6570\u5b57\u4e32\u3002\u8981\u6c42\u4e92\u4e0d\u76f8\u540c\u7684\u4e32\u5c3d\u91cf\u591a\u3002**\u4e00\u6761\u4e32\u7ffb\u8f6c\u540e\u88ab\u8ba4\u4e3a\u662f\u540c\u4e00\u6761\u4e32**\u3002\n\n## \u9898\u89e3\n\n\u975e\u5e38\u597d\u7684\u5b57\u7b26\u4e32\u54c8\u5e0c\u9898\u3002\n\n### \u6c42\u54c8\u5e0c\u503c\n\n\u5f88\u663e\u7136\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u6bcf\u4e2a$k$\uff0c\u7136\u540e\u5224\u65ad$\\left\\lfloor\\dfrac{n}{k}\\right\\rfloor$\u4e2a\u4e32\u4e2d\u4e92\u4e0d\u76f8\u540c\u7684\u4e32\u6709\u591a\u5c11\u4e2a\u3002\u6211\u4eec\u53ef\u4ee5\u7528\u54c8\u5e0c\u8868\u5224\u91cd\u3002\u4f46\u662f\u5982\u4f55\u5feb\u901f\u7b97\u51fa$[(i-1)\\times k+1,i\\times k]$\u8fd9\u4e2a\u5b50\u4e32\u7684\u54c8\u5e0c\u503c\u5462\uff1f\n\n\u6211\u4eec\u53ef\u4ee5\u6309\u7167\u8fd9\u6837\u7684\u65b9\u6cd5\u8fdb\u884c\u5b57\u7b26\u4e32\u54c8\u5e0c\uff1a\n\n$$H(S)=\\left(\\sum_{i=1}^{S.length}S_i\\times seed^{i-1}\\right) \\bmod 2^{64}$$\n\n\u8fd9\u79cd\u65b9\u6cd5\uff0c**\u672c\u8d28\u4e0a**\u5c31\u662f\u628a\u5b57\u7b26\u4e32\u8f6c\u6210\u4e86$seed$\u8fdb\u5236\u7684\u6570\uff0c\u5e76\u5bf9$2^{64}$\u53d6\u6a21\uff08\u5373$\\text{unsigned long long}$\u81ea\u7136\u6ea2\u51fa\uff09\n\u3002\u4e3e\u4e2a\u6817\u5b50\uff1a\u4e00\u4e2a\u5341\u8fdb\u5236\u6570$1145141919810$\uff0c\u6211\u4eec\u8981\u53d6\u51fa\u5b83\u4ece\u5de6\u5f80\u53f3\u7b2c\u4e09\u4f4d\u5230\u7b2c\u4e03\u4f4d\uff0c\u90a3\u4e48\u5c31\u662f$1145141-11\\times 10^5=45141$\u3002$seed$\u8fdb\u5236\u540c\u7406\uff0c\n\n$$H(S_{sub[l,r]})=\\left(pre_r-pre^{l-1}\\times seed^{r-l+1}\\right) \\bmod 2^{64}$$\n\n\u5176\u4e2d$pre_i$\u8868\u793a$S$\u7684\u524d$i$\u4e2a\u5b57\u7b26\u7684\u54c8\u5e0c\u503c\u3002\u7ffb\u8f6c\u7684\u6570\u5b57\u4e32\u540c\u7406\u5373\u53ef\u3002\n\n\u7136\u540e\u662f\u5173\u4e8e\u54c8\u5e0c\u8868\u7684\u95ee\u9898\u3002\n\n### \u5efa\u54c8\u5e0c\u8868\n\n\u6700\u7b80\u5355\u7684\u65b9\u6cd5\uff0c\u5c31\u662f\u7528$\\rm map$\u76f4\u63a5\u63d2\u5165\u54c8\u5e0c\u503c\u3002\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u5355\u6b21\u5176\u5b9e\u662f$\\mathcal O(\\log N)$\u3002\u6211\u4eec\u5e0c\u671b\u66f4\u5feb\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u53c8\u5e0c\u671b\u8f83\u5c11\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\uff0c\u8fd8\u4e0d\u5e0c\u671b\u56e0\u6b64\u589e\u52a0\u54c8\u5e0c\u78b0\u649e\u7684\u6982\u7387\uff0c\u600e\u4e48\u529e\uff1f\u8fd9\u91cc\u7ed9\u51fa\u66f4\u5feb\u7684\u65b9\u6cd5\u3002\n\n\u56fe\u8bba\u4e2d\u7684\u94fe\u5f0f\u524d\u5411\u661f\uff0c\u7ed9\u6bcf\u4e2a\u90bb\u63a5\u8868\u6dfb\u52a0\u8282\u70b9$\\operatorname{add}(u,v)$\uff0c\u672c\u8d28\u4e0a\u5c31\u662f\u7ed9\u94fe\u8868$u$\u589e\u52a0\u4e86\u4e00\u4e2a\u5143\u7d20$v$\u3002\u90a3\u4e48\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u5c06$u$\u53d8\u4e3a\u54c8\u5e0c\u503c\u5bf9\u5206\u914d\u7684\u5185\u5b58$SIZE$\u53d6\u6a21\u540e\u7684\u7ed3\u679c\uff0c\u800c$v$\u53d8\u4e3a\u54c8\u5e0c\u503c\u672c\u6765\u7684\u503c\u3002\n\n```\n\\\\\u94fe\u5f0f\u524d\u5411\u661f\u52a0\u70b9\nvoid add(int u,ULL v){\n    ver[++tot]=v,nxt[tot]=head[u],head[u]=tot;\n}\n\\\\\u7ed9\u54c8\u5e0c\u8868\u589e\u52a0\u5143\u7d20\nadd(h%SIZ,h);\n```\n\n\u5173\u4e8e\u67e5\u8be2\u64cd\u4f5c\uff0c\u4e3a\u4e86\u51cf\u5c11\u54c8\u5e0c\u78b0\u649e\uff0c\u6211\u4eec\u626b\u63cf\u4e00\u904d\u54c8\u5e0c\u503c\u53d6\u6a21\u540e\u7684\u503c\u6240\u5bf9\u5e94\u7684\u90bb\u63a5\u8868\u7684\u5143\u7d20\uff0c\u68c0\u67e5\u662f\u5426\u5b58\u5728\u5143\u7d20\u7684\u503c\u7b49\u4e8e\u5b83\u3002\n\n```\nbool fnd(ULL hsh){\n    int p=hsh%SIZ; for(int i=head[p];i;i=nxt[i])\n    if(ver[i]==hsh) return true; return false;\n}\n```\n\u8fd9\u6837\u53ef\u4ee5\u5728\u6700\u5927\u7a0b\u5ea6\u907f\u514d\u54c8\u5e0c\u78b0\u649e\u7684\u60c5\u51b5\u4e0b\u51cf\u5c11\u4e86\u7a7a\u95f4\u635f\u8017\u3002\n\n### \u7b97\u590d\u6742\u5ea6\n\n\u867d\u7136\u597d\u50cf\u679a\u4e3e\u4e86\u4e00\u904d$k$\uff0c\u53c8\u679a\u4e3e\u4e86\u6bcf\u4e2a\u5757\uff0c\u4f46\u662f\u65f6\u95f4\u590d\u6742\u5ea6\u662f$\\sum\\limits_{i=1}^{N}\\left\\lfloor\\dfrac{N}{i}\\right\\rfloor\\le N \\log N$\uff0c\u8fd1\u4f3c\u4e3a$\\mathcal O(N \\log N)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n\u7528\u54c8\u5e0c\u8868\u66ff\u4ee3$\\text{map}$\uff0c\u6709\u4e2a\u597d\u5904\u5c31\u662f\u65f6\u95f4\u6781\u77ed\uff0c\u5728$\\text{171ms}$\u5c31\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\u662f\u6240\u6709\u4e0d\u5f00$\\rm O2$\u7684\u7a0b\u5e8f\u4e2d\u8f83\u5feb\u7684\u7a0b\u5e8f\u3002\u6700\u5927\u7684\u70b9\u4e5f\u53ea\u9700\u8981$\\rm 60+ms$\u3002\n\n~~\u5f00$\\sout{\\rm{O2}}$\u88ab$\\sout\\text{map}$\u540a\u6253\uff0c\u6211\u4e5f\u5f88\u65e0\u5948\u5440~~\n\n\n## \u53c2\u8003\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define up(l,r,i) for(int i=l;i<=r;i++)\n#define dn(l,r,i) for(int i=l;i>=r;i--)\nusing namespace std;\n\ntypedef long long LL;\nconst int INF =2147483647;\nint qread(){\n    int w=1,c,ret;\n    while((c=getchar())> '9'||c< '0')\n    w=(c=='-'?-1:1); ret=c-'0';\n    while((c=getchar())>='0'&&c<='9')\n    ret=ret*10+c-'0';\n    return ret*w;\n}\ntypedef unsigned long long ULL;\nconst int SIZ =999997,MAXN=2e5+3;\nint head[SIZ+3],nxt[SIZ+3],tot;ULL ver[SIZ+3];\nvoid add(int u,ULL v){ver[++tot]=v,nxt[tot]=head[u],head[u]=tot;}\nULL seed[MAXN]={19260817},pre[MAXN],suf[MAXN];\nULL getA(int l,int r){return pre[r]-pre[l-1]*seed[r-l];}\nULL getB(int l,int r){return suf[l]-suf[r+1]*seed[r-l];}\nbool fnd(ULL hsh){\n    int p=hsh%SIZ; for(int i=head[p];i;i=nxt[i])\n    if(ver[i]==hsh) return true; return false;\n}\nint P[MAXN],vis[MAXN*2],res[MAXN],cnt,flg,top,ans,n;\nint main(){\n    n=qread(); up(1,n,i) P[i]=qread();\n    up(1,n,i) seed[i]=seed[i-1]*seed[0];\n    up(1,n,i) pre[i]=pre[i-1]*seed[0]+P[i];\n    dn(n,1,i) suf[i]=suf[i+1]*seed[0]+P[i];\n    up(1,n,i){\n        up(1,cnt,i) head[vis[i]]=0; tot=cnt=flg=0;\n        if(n/i<ans) break;\n        for(int j=1;i*j<=n;++j){int l=(j-1)*i+1,r=j*i;\n            ULL wA=getA(l,r),wB=getB(l,r);\n            if(!(fnd(wA)||fnd(wB))){\n                add(wA%SIZ,wA),add(wB%SIZ,wB),++flg;\n                vis[++cnt]=wA%SIZ,vis[++cnt]=wB%SIZ;\n            }\n        }\n        if(flg==ans) res[++top]=i; else if(flg<ans) continue;\n        else top=0,ans=flg,res[++top]=i;\n    }\n    printf(\"%d %d\\n\",ans,top);\n    up(1,top,i) printf(\"%d \",res[i]); puts(\"\");\n    return 0;\n}\n```",
        "postTime": 1584512152,
        "uid": 68344,
        "name": "\u79bb\u6563\u5c0f\u6ce2\u53d8\u6362\u00b0",
        "ccfLevel": 9,
        "title": "\u3010\u9898\u89e3\u3011\u3010P3498 [POI2010]KOR-Beads\u3011"
    },
    {
        "content": "\u5927\u5bb6\u597d\uff0c\u6211\u662f CQ-FZOIer\uff0cC2024 \u7ea7\u849f\u84bb CJH\u3002\n\n~~\u6691\u5047\u4f5c\u4e1a\u592a\u591a\u4e86\uff0c\u6765\u8865\u4e00\u7bc7\u9898\u89e3\u3002~~\n\n\u6b64\u9898 tag\uff1a\u679a\u4e3e\uff0c\u66b4\u529b\uff1b\u54c8\u5e0c\uff0cHASH\u3002\n\n\u6d1b\u8c37\uff1a[P3498 [POI2010]KOR-Beads](https://www.luogu.com.cn/problem/P3498)\n\n---\n\n# \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217\uff0c\u95ee\u5728\u5e8f\u5217\u4e2d\u8fde\u7eed\u9009\u53d6\u957f\u5ea6\u4e3a $k(1 \\le k \\le n)$ \u7684\u5e8f\u5217\u65f6\u5b57\u4e32\u6700\u591a\uff08\u5b50\u4e32\u90fd\u662f\u53ef\u4ee5\u53cd\u8f6c\u7684\uff0c\u4e00\u4e2a\u5b57\u4e32\u7684\u6b63\u5e8f\u548c\u5012\u5e8f\u4e3a\u4e00\u4e2a\u5b50\u4e32\uff09\u3002\n\n# \u5206\u6790\u9898\u76ee\n\n1. \u56e0\u4e3a\u6570\u7ec4\u6ca1\u6709\u529e\u6cd5\u4f7f\u7528 `STL map`\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u662f\u53ea\u6709\u4f7f\u7528\u54c8\u5e0c\u7b97\u6cd5\u6765\u9884\u5904\u7406\u51fa\u5e8f\u5217\u7684\u524d\u540e\u7f00\uff0c\u8fd9\u91cc\u6211\u4eec\u4eff\u7167\u5b57\u7b26\u4e32\u54c8\u5e0c\u7684 BKDR \u7b97\u6cd5\u3002\n\n2. \u5728 $1 \\sim n$ \u4e2d\u679a\u4e3e $k$\uff0c\u6c42\u51fa\u6bcf\u4e00\u6bb5\u5e8f\u5217\u7684\u54c8\u5e0c\u503c\u540e\u518d\u7528 `map`\uff08\u5c31\u53ef\u4ee5\u4e0d\u9700\u8981\u54c8\u5e0c\u4e86\uff09\u5b58\u50a8\uff0c\u5224\u65ad\u662f\u5426\u8fd9\u6bb5\u54c8\u5e0c\u503c\u662f\u5426\u5b58\u5728\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5c31\u53ef\u4ee5\u589e\u52a0\u4e0d\u540c\u5b50\u4e32\u7684\u6570\u91cf\u3002\n\n# \u6ce8\u610f\u4e8b\u9879\n\n1. `map` \u6bcf\u4e00\u6b21\u7528\u5b8c\u4ee5\u540e\u4e00\u5b9a\u8981**\u6e05\u7a7a**\uff01\n\n2. \u54c8\u5e0c\u524d\u7f00**\u4ece\u524d\u5f80\u540e**\u5904\u7406\uff0c\u54c8\u5e0c\u540e\u7f00**\u4ece\u540e\u5f80\u524d**\u5904\u7406\u3002\n\n# \u4ee3\u7801\n\n```cpp\n//the code is from chenjh\n#include<bits/stdc++.h>\n#define MAXN 200002\nusing namespace std;\ntypedef long long LL;//\u7528 LL \u66ff\u6362 long long\uff0c\u7b80\u77ed\u4ee3\u7801\u91cf\u3002\nint n,a[MAXN];\nLL Hash1[MAXN],Hash2[MAXN],pn[MAXN];//\u5206\u522b\u4e3a\uff1a\u524d\u7f00\u54c8\u5e0c\u3001\u540e\u7f00\u54c8\u5e0c\u3001p \u7684 n \u6b21\u5e42\u3002\nmap<LL,bool> M;//\u5224\u65ad\u662f\u5426\u6709\u91cd\u5408\u7684 Hash1&Hash2\u3002\nconst int p=103;//\u9009\u53d6\u4e00\u4e2a\u8fdc\u79bb 2 \u7684\u6574\u6570\u6b21\u5e42\u7684\u8d28\u6570\u3002\nint kkk[MAXN],size=0;//\u6240\u6709\u7684 k \u548c\u80fd\u83b7\u5f97\u6700\u5927\u503c\u7684k\u7684\u4e2a\u6570\u3002\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)\n\t\tscanf(\"%d\",&a[i]);\n\tpn[0]=1;//\u8fd9\u4e00\u53e5\u5f88\u91cd\u8981\uff01\u521d\u59cb\u5316 p^0=1\u3002\n\tfor(int i=1;i<=n;i++)\n\t\tHash1[i]=Hash1[i-1]*p+a[i],pn[i]=pn[i-1]*p;//\u9884\u5904\u7406\u54c8\u5e0c\u524d\u7f00\u548c p \u7684 n \u6b21\u5e42\u3002\n\tfor(int i=n;i;i--)\n\t\tHash2[i]=Hash2[i+1]*p+a[i];//\u9884\u5904\u7406\u54c8\u5e0c\u540e\u7f00\u3002\n\tint ans=0;//\u80fd\u83b7\u5f97\u7684\u6700\u5927\u4e0d\u540c\u7684\u5b50\u4e32\u4e2a\u6570\u3002\n\tfor(int k=1;k<=n;k++){\n\t\tint s=0;M.clear();//\u5f53\u524d\u957f\u5ea6\u4e3a k \u80fd\u83b7\u5f97\u7684\u4e0d\u540c\u7684\u5b50\u4e32\u4e2a\u6570\u3002\n\t\tfor(int i=1;i<=n-k+1;i+=k){\n\t\t\tLL hs1=Hash1[i+k-1]-Hash1[i-1]*pn[k],hs2=Hash2[i]-Hash2[i+k]*pn[k];//\u6c42\u533a\u95f4\u54c8\u5e0c\u524d\u7f00 & \u540e\u7f00\u3002\n\t\t\ths1*=hs2;//\u4e24\u6570\u76f8\u4e58\u8fdb\u884c\u8ba1\u7b97\u3002\n\t\t\tif(M[hs1]) continue;//\u5982\u679c\u5df2\u7ecf\u5b58\u5728\u5c31\u5224\u65ad\u4e0b\u4e00\u4e2a\u5b57\u4e32\u3002\n\t\t\tM[hs1]=1,s++;//\u6807\u8bb0\u6b64\u5b50\u4e32\u5df2\u5b58\u5728\uff0c\u4e2a\u6570\u589e\u52a0\u3002\n\t\t}\n\t\tif(s>ans)\n\t\t\tans=s,kkk[size=1]=k;//\u66f4\u65b0\u7b54\u6848\uff0c\u4e2a\u6570\u8d4b\u503c\u4e3a 1 \u540e\u5b58\u50a8\u5f53\u524d\u7684 k\u3002\n\t\telse if(s==ans)\n\t\t\tkkk[++size]=k;//\u76f8\u7b49\u5219\u7d2f\u52a0\n\t}\n\tprintf(\"%d %d\\n\",ans,size);\n\tfor(int i=1;i<=size;i++)\n\t\tprintf(\"%d \",kkk[i]);//\u8f93\u51fa\u6240\u6709 k\u3002\n\treturn 0;\n}\n\n```\n\n*\u8c22\u8c22\u5927\u5bb6\uff01*",
        "postTime": 1661064527,
        "uid": 577880,
        "name": "cjh20090318",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P3498 [POI2010]KOR-Beads"
    },
    {
        "content": "~~\u4e00\u9053\u5f88\u597d\u7684\u54c8\u5e0c\u9898\uff01~~\n\n## \u4e00\uff1a\u66b4\u529b\u9a8c\u8bc1\n\n\u4ece\u4e00\u679a\u4e3e\u5230n\uff0c\u9010\u4e00\u9a8c\u8bc1\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u7ea6\u4e3a:n(n/1+n/2+...+n/n)\u7ea6\u7b49\u4e8e$n^2logn$,\u800c\u6b64\u9898\u7684$n<=2e5$\n\u65e9\u5df2\u4e0d\u77e5\u9053\u7206\u5230\u54ea\u91cc\u53bb\u4e86\n\n## \u4e8c\uff1a\u54c8\u5e0c\u503c\u7684\u5224\u91cd\n\n\u4ee3\u7801\uff08\u6211\u4eec\u53d62^64+1\u4e3a\u6a21\u6570\uff0c\u6ea2\u51fa\u5c31\u76f8\u5f53\u4e8e\u4f5c\u6a21\u4e86\uff09\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define ll unsigned long long\n#define Maxn 200005\nconst ll p=1e9+7;\nusing namespace std;\nll read()\n{\n\tll r=0,f=1;char c=getchar();\n\twhile((c<'0'||c>'9')&&(c!='-')) c=getchar();\n\tif(c=='-') f=-1,c=getchar();\n\twhile(c>='0'&&c<='9') r=r*10+c-'0',c=getchar();\n\treturn r*f;\n}\nll n,s1[Maxn],s2[Maxn],mi[Maxn],a[Maxn],ans[Maxn],cnt,num;\nmap<ll,bool> pd;\nint main()\n{\n\tn=read();\n\tfor(int i=1;i<=n;i++) a[i]=read();\n\tmi[0]=1;\n\tfor(int i=1;i<=n;i++) mi[i]=mi[i-1]*p;//\u9884\u5904\u7406p\u7684k\u6b21\u65b9\n\tfor(int i=1;i<=n;i++) s1[i]=s1[i-1]*p+a[i];//\u53cc\u54c8\u5e0c\uff0cs1,s2,\u8fd9\u91cc\u662f\u987a\u7740\u4e00\u904d\u54c8\u5e0c\n\tfor(int i=n;i;i--) s2[i]=s2[i+1]*p+a[i];//\u53cd\u8fc7\u6765\u54c8\u5e0c\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(n/i<num) break;//\u603b\u6bb5\u6570\u5982\u679c\u6bd4\u7b54\u6848\u8fd8\u5c0f\uff0c\u5c31\u4e0d\u7528\u627e\u4e86\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u526a\u679d\n\t\tll c=0;//c-\u300b\u5f53\u524d\u627e\u5230\u7684\u957f\u5ea6\u4e0b\u627e\u5230\u7684\u91cd\u590d\u6bb5\u6570\n\t\tpd.clear();\n\t\tfor(int j=i;j<=n;j+=i)//j\u662f\u6bcf\u4e00\u6bb5\u7684\u7ec8\u70b9\uff0c\u8d77\u70b9\u662fj-i+1\n\t\t{\n\t\t\tif(c+(n-j+i)/i<num) break;//\u5f53\u524d\u627e\u5230\u7684+\u5269\u4f59\u7684\u6bd4\u7b54\u6848\u8fd8\u5c0f\uff0c\u4e5f\u4e0d\u7528\u627e\u4e86\n\t\t\tll t1=s1[j]-s1[j-i]*mi[i];\n\t\t\tif(pd[t1]) continue;\n\t\t\tll t2=s2[j-i+1]-s2[j+1]*mi[i];\n\t\t\t++c;\n\t\t\tpd[t1]=pd[t2]=true;\n\t\t}\n\t\tif(c==num) ans[++cnt]=i;//\u5b58\u8def\n\t\telse if(c>num) cnt=0,num=c,ans[++cnt]=i;//\u91cd\u65b0\u5f00\u59cb\n\t}\n\tprintf(\"%lld %lld\\n\",num,cnt);\n\tfor(int i=1;i<=cnt;++i) printf(\"%lld \",ans[i]);\n\treturn 0;\n}\n```",
        "postTime": 1581055848,
        "uid": 138649,
        "name": "\u7237\uff0c\u65e0\u9650\u9738\u6c14",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P3498 \u3010[POI2010]KOR-Beads\u3011"
    },
    {
        "content": "### \u540e\u7f00\u6570\u7ec4smg\uff1f\u62b1\u6b49\u849f\u84bb\u53ea\u4f1a\u666e\u901aHash\n\u8fd9\u9053\u9898\u8981\u6c42\u9009\u53d6\u5b50\u4e32\u5982\u679c\u53cd\u7740\u4e5f\u88ab\u9009\u4e86\u7684\u8bdd\u5c31\u4e0d\u80fd\u9009,\u6240\u4ee5\u5f88\u5bb9\u6613\u60f3\u5230\u6b63\u53cd\u4e24\u904dhash.  \n\u5728\u8fd9\u91cc\u6709\u5f88\u591a\u65b9\u5f0f\u5224\u91cd\uff0c\u6bd4\u5982lower_bound\uff0c\u94fe\u8868\u554a\uff0c\u6211\u5728\u6b64\u5904\u4f7f\u7528\u7684\u662f\u94fe\u8868.\n### \u4f18\u5316\n\u53ef\u4ee5\u8003\u8651\u63d0\u9ad8\u4ee3\u7801\u6548\u7387.  \n\u6bd4\u5982\u8bf4\u5982\u679c\u5f53\u524d\u5df2\u7ecf\u5206\u914d\u4e86\u7684\u5b50\u4e32\u52a0\u4e0a\u4e4b\u540e\u80fd\u591f\u5f97\u5230\u7684\u6700\u5927\u5b50\u4e32\u90fd\u6ca1\u6709\u5df2\u77e5\u7684\u6700\u591a\u5b50\u4e32\u591a\uff0c\u90a3\u4e48\u5c31\u6ca1\u5fc5\u8981\u7ee7\u7eed\u505a\u4e86\u3002  \n\u6bcf\u6b21\u53ea\u9009\u62e9\u53ef\u80fd\u5927\u4e8e\u6700\u5927\u503c\u7684k\u53bb\u505a.\n\u5177\u4f53\u5b9e\u73b0\u4e5f\u4e0d\u662f\u7279\u522b\u96be\uff0c\u53ef\u4ee5\u5bf9\u6bd4\u770b\u4e00\u4e0b.\n#### \u53c2\u8003\u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n/*\n    \u6b63\u7740\u4e00\u904d\u5012\u7740\u4e00\u904d\u54c8\u5e0c.\n    \u6bcf\u6b21\u53bb\u4e00\u4e2a\u5c31\u5c06\u4e24\u4e2a\u54c8\u5e0c\u90fd\u5b58\u8fdb\u53bb.\n*/\n#define ull unsigned long long\nusing namespace std;\nconst int maxn=200005,p=100007;\nint n,maxx,cnt,k;\nint a[maxn],b[maxn],head[p+5];\null h1[maxn],h2[maxn],bas[maxn];\nstruct Kano{\n\tint nxt;\n\tull val;\n}kano[maxn];\null get(int l,int r){\n\treturn min(h1[r]-h1[l-1]*bas[r-l+1],h2[l]-h2[r+1]*bas[r-l+1]);\n}\nvoid add(ull x,int y){\n\tkano[++cnt].val=x;\n\tkano[cnt].nxt=head[y];\n\thead[y]=cnt;\n}\nbool check(ull x){\n\tint y=x%p;\n\tfor (int i=head[y];i;i=kano[i].nxt){\n\t\tif (kano[i].val==x) return 0;\n\t}\n\tadd(x,y);\n\treturn 1;\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;i++) scanf(\"%d\",&a[i]);\n    for(int i=1;i<=n;i++) h1[i]=h1[i-1]*p+a[i];\n    for(int i=n;i>=1;i--) h2[i]=h2[i+1]*p+a[i];\n    bas[0]=1;\n    for(int i=1;i<=n;i++)bas[i]=bas[i-1]*p;\n    for(int i=1;i<=n;i++){\n    \tif(n/i<maxx) continue;\n    \tint num=0;\n    \tfor(int j=1;j<=n;j+=i){\n    \t\tif(j+i-1>n) break;\n    \t\tif(num+(n-j+1)/i<maxx) break;//\u526a\u679d\uff1f\n    \t\tif(check(get(j,j+i-1))) num++;\n\t\t}\n\t\tif(num>maxx){\n    \t\tmaxx=num;\n    \t\tk=1;\n    \t\tb[k]=i;\n\t\t}else if(num==maxx) b[++k]=i;\n\t}\n\tprintf(\"%d %d\\n\",maxx,k);\n\tfor (int i=1;i<=k;i++)\n\tprintf(\"%d \",b[i]);\n\treturn 0;\n}\n```\n",
        "postTime": 1575280987,
        "uid": 170518,
        "name": "\u5b50\u5f52",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3498 \u3010[POI2010]KOR-Beads\u3011"
    },
    {
        "content": "**\u524d\u7f6e\u829d\u58eb\uff1a\u5b57\u7b26\u4e32\u54c8\u5e0c\u3001$\\text{set}$**\n\n\u679a\u4e3e\u957f\u5ea6 $k$\uff0c\u66b4\u529b\u68c0\u6d4b\u4e0d\u76f8\u540c\u7684\u4e32\u6570\u3002\u5224\u91cd\u65f6\u7528\u5b57\u7b26\u4e32\u54c8\u5e0c\u548c $\\text{set}$ \u7ef4\u62a4\u5c31\u884c\u3002\n\n\u5177\u4f53\u6765\u8bf4\uff0c\u6211\u4eec\u524d\u540e\u505a\u4e00\u904d\uff0c\u5404\u7ef4\u62a4\u51fa\u524d\u540e\u7f00\u7684\u54c8\u5e0c\u503c\uff0c\u7ed3\u5408\u6c42\u5b50\u6bb5\u54c8\u5e0c\u503c\u7684\u67ff\u5b50\u5c31\u4e0d\u96be\u5f97\u51fa\u4e00\u4e2a\u5b57\u4e32\u7ffb\u8f6c\u524d\u548c\u7ffb\u8f6c\u540e\u7684\u54c8\u5e0c\u503c\uff0c\u63d2\u5230 $\\text{set}$ \u5c31\u884c\u4e86\u3002\n\n+ \u524d\u7f00\u54c8\u5e0c\u6c42\u957f\u5ea6\u4e3a $k$ \u5b50\u6bb5\u54c8\u5e0c\u503c\u7684\u67ff\u5b50:\n$$hash(l,r) = hsh[r] - hsh[(r - k - 1) + 1] \\times p^{k}$$\n$$hash(l,r) = hsh[r] - hsh[r - k] \\times p ^ k$$\n+ \u540e\u7f00\u54c8\u5e0c\u6c42\u957f\u5ea6\u4e3a $k$ \u5b50\u6bb5\u54c8\u5e0c\u503c\u7684\u67ff\u5b50\uff1a\n$$Ohash(l,r) = Ohsh[r - k + 1] - Ohsh[r + 1] \\times p^k$$\n\n$\\text{set}$ \u7ef4\u62a4\u65f6\u4e0d\u59a8\u7528\u524d\u540e\u7f00\u54c8\u5e0c\u503c\u76f8\u4e58\u7684\u7ed3\u679c\u63d2\u5165\u96c6\u5408\u4e2d\u3002\n\n\u5269\u4e0b\u7684\u5c31\u662f\u4ee3\u7801\u5566\uff1a\n```cpp\n#include<bits/stdc++.h>\n\nusing namespace std;\n\n#define int long long\nconst int N = 2e5 + 10, P = 13331;\nint n, a[N], maxx = INT_MIN, res[N], cnt = 0;\ntypedef unsigned long long ull;\null p[N], hsh[N], Ohsh[N];\n\ninline int get(int l, int r)\n{\n\treturn hsh[r] - hsh[l - 1] * p[r - l + 1];\n}\n\ninline int Oget(int l, int r)\n{\n\treturn hsh[l] - hsh[r + 1] * p[r - l + 1];\n}\n\nsigned main()\n{\n\tscanf(\"%lld\", &n);\n\tp[0] = 1;\n\tfor(int i(1);i <= n; ++ i)\n\t{\n\t\tscanf(\"%lld\", &a[i]);\n\t\thsh[i] = hsh[i - 1] * P + a[i];\n\t\tp[i] = p[i - 1] * P;\n\t}\n\tfor(int i(n);i >= 1; -- i)\n\t\tOhsh[i] = Ohsh[i + 1] * P + a[i];\n\tset<int>s;\n\tfor(int i(1);i <= n; ++ i)\n\t{\n\t\tint sum = 0;\n\t\ts.clear();\n\t\tfor(int j(i);j <= n; j += i)\n\t\t{\n\t\t\tint val = hsh[j] - hsh[j - i] * p[i];\n\t\t\tint Oval = Ohsh[j - i + 1] - Ohsh[j + 1] * p[i];\n\t\t\tif(s.count(val * Oval))\n\t\t\t\tcontinue;\n\t\t\ts.insert(val * Oval);\n\t\t\t++ sum;\n\t\t} \n\t\tif(sum > maxx)\n\t\t\tcnt = 0, maxx = sum, res[++ cnt] = i;\n\t\telse if(sum == maxx)\n\t\t\tres[++ cnt] = i;\n\t}\n\tprintf(\"%lld %lld\\n\", maxx, cnt);\n\tfor(int i(1);i <= cnt; ++ i)\n\t\tprintf(\"%lld \", res[i]);\n\treturn 0;\n}\n```",
        "postTime": 1675753392,
        "uid": 666796,
        "name": "Rainsheeep",
        "ccfLevel": 0,
        "title": "P3498 [POI2010]KOR-Beads \u9898\u89e3"
    },
    {
        "content": "### \u524d\u8a00\n\u53d6\u8fdb\u5236\u5e95\u6570\u4e00\u5b9a\u8981\u6ce8\u610f\uff0c\u56e0\u4e3a\u8fd9\u4e1c\u897f\u771f\u7684\u5f88\u7384\u5b66\u3002\n\n### \u89e3\u6790\n- \u4e0d\u96be\u770b\u51fa\u8fd9\u9053\u9898\u8003\u5bdf\u7684\u662f\u54c8\u5e0c\uff0c\u7528\u4e8e\u5224\u65ad\u662f\u5426\u662f\u4e0d\u540c\u7684\u6bb5\u3002\u8be5\u6bb5\u5bf9\u7b54\u6848\u6709\u8d21\u732e\uff0c\u5f53\u4e14\u4ec5\u5f53\u8be5\u6bb5\u672c\u8eab\u5e8f\u5217\u4e0e\u5b83\u7684\u7ffb\u8f6c\u5e8f\u5217\u90fd\u662f\u7b2c\u4e00\u6b21\u88ab\u904d\u5386\u3002\u7136\u540e\u5c06\u539f\u5e8f\u5217\u4e0e\u7ffb\u8f6c\u5e8f\u5217\u90fd\u8bb0\u5f55\u3002\n\n- \u5bf9\u4e8e\u7b54\u6848\u7684\u6c42\u89e3\uff0c\u4ece\u5c0f\u5230\u5927\u679a\u4e3e $k$\uff0c\u4ee4 $k$ \u7684\u8d21\u732e\u4e3a $x$\uff0c\u5c06 $k$ \u52a0\u5165\u4e0d\u540c \u7684 $k$ \u8d21\u732e\u7686\u4e3a $x$ \u7684\u96c6\u5408 \u3002\n\n- \u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n\u4e0b\u9644\u4ee3\u7801\uff1a\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\n#include <map>\n#include <vector> \nusing namespace std;\n\ntypedef unsigned long long ULL;\nconst int N=2e5+10,P1=19260817,P2=2e5+1,Mod1=1e9+9,Mod2=1e9+7;\nint p[3][N],pp[3][N],hh[5][N],h[5][N];\nint a[N],b[N];\nint n; \nint ans[N],cnt;\nmap<int,int> S1;\nint idx1;\ninline int read()\n{\n\tint ans=0,sign=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9')\n\t{\n\t\tif(ch=='-')\n\t\t{\n\t\t\tsign=-1;\n\t\t}\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9')\n\t{\n\t\tans=ans*10+ch-'0';\n\t\tch=getchar();\n\t}\n\treturn ans*sign;\n}\n\nint query1(int l,int r,int type)\n{\n\treturn ((h[type][r]-1LL*h[type][l-1]*p[1][r-l+1])%Mod1+Mod1)%Mod1;\n}\n\nint main()\n{\n\tn=read();\n\tfor(int i=1;i<=n;++i)  a[i]=read(),b[n-i+1]=a[i];\n\tpp[1][0]=p[1][0]=pp[2][0]=p[2][0]=1;\n\tfor(int i=1;i<=n;++i)\n\t{\n\t   p[1][i]=((1LL*p[1][i-1]*P1))%Mod1;\n//\t   pp[1][i]=(pp[1][i-1]*P2+Mod1)%Mod1;\n//\t   p[2][i]=(p[2][i-1]*P1)%Mod2;\n//\t   pp[2][i]=(pp[2][i-1]*P2)%Mod2;\n\t   \n\t   h[0][i]=((1LL*h[0][i-1]*P1+a[i]))%Mod1; \n\t   h[1][i]=((1LL*h[1][i-1]*P1+b[i]))%Mod1;\n\t}\n\tint res=0;\n\tfor(int k=1;k<=n;++k)\n\t{\n\t\tint tot=0;\n\t\tS1.clear();\n\t\tfor(int i=1;i+k-1<=n;i+=k)\n\t\t{\n\t\t   int j=i+k-1;\n\t\t   int t1=query1(i,j,0),t2=query1(n-j+1,n-i+1,1);\n\t\t   int tt=min(t1,t2);\n\t\t   if(!S1.count(tt))  \n\t\t   {\n\t\t   \t ++tot;\n\t\t   \t S1[tt]=1;\n\t\t   }\n\t\t}\n\t\tif(res<tot)  res=tot,cnt=0,ans[++cnt]=k;\n\t\telse if(res==tot)  ans[++cnt]=k;\n\t}\n\t\n\tprintf(\"%d %d\\n\",res,cnt);\n\t\n\tfor(int i=1;i<=cnt;i++)  printf(\"%d \",ans[i]);\n\t\n\treturn 0;\n}\n```\n\u5b8c\u7ed3\u6492\u82b1~\n",
        "postTime": 1673260638,
        "uid": 295398,
        "name": "1105Lee",
        "ccfLevel": 0,
        "title": "[POI2010]KOR-Beads \u9898\u89e3"
    },
    {
        "content": "## \u5206\u6790\u9898\u76ee\uff1a\n\u6570\u636e\u8303\u56f4\u4e3a $2 \\times 10^5$\uff0c\u663e\u7136\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n \\log n)$\u3002\n\n\u5bb9\u6613\u60f3\u5230\uff0c\u6211\u4eec\u5fc5\u987b\u679a\u4e3e\u6bcf\u4e00\u4e2a $k$ \u503c\u548c\u5b83\u7684\u5b50\u4e32\uff0c\u800c\u5b50\u4e32\u5171\u6709     $\\sum\\limits_{k=1}^n\\left\\lfloor\\dfrac{n}{k}\\right\\rfloor$ \u4e2a\uff0c\u5c55\u5f00\u540e\u53ef\u4ee5\u5316\u4e3a\u8c03\u548c\u7ea7\u6570\uff0c\u800c\u8c03\u548c\u7ea7\u6570\u8fd1\u4f3c\u4e8e $\\log n$ ,\u6240\u4ee5\u679a\u4e3e\u7684\u590d\u6742\u5ea6\u5373\u4e3a $O(n \\log n)$\u3002\n\n\u67e5\u8be2\u548c\u5224\u91cd\u5e94\u8be5\u600e\u4e48\u505a\u5462\uff1f\n\n\u5f80\u5f80\u8fd9\u7c7b\u5b57\u7b26\u4e32\u9898\uff0c\u90fd\u53ef\u4ee5\u4f7f\u7528\u5b57\u7b26\u4e32\u54c8\u5e0c\u8fd9\u4e00\u5229\u5668\uff0c\u628a\u67e5\u8be2\u4f18\u5316\u4e3a $O(1)$\u3002\n\n\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u53ef\u4ee5\u8fdb\u884c\u6b63\u53cd\u4e24\u6b21\u54c8\u5e0c\uff0c\u6765\u5904\u7406\u5b50\u4e32\u53cd\u8f6c\u7684\u60c5\u51b5\u3002\n\n\u5224\u91cd\u53ef\u4ee5\u4f7f\u7528\u54c8\u5e0c\u8868\uff0c\u4e0d\u8fc7STL\u91cc\u9762\u6709\u81ea\u5e26\u7684 set \u548c map\uff0c\u61d2\u4eba\u5fc5\u5907\u3002\n\n\u5982\u679c\u7528STL\u7684\u8bdd\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5e94\u4e3a $O(n \\log n \\log n)$\uff0c\u4ecd\u7136\u53ef\u4ee5\u901a\u8fc7\u672c\u9898 ~~\uff08\u5f00\u4e86O2\u4f3c\u4e4e\u8dd1\u7684\u98de\u5feb\uff09~~\u3002\n## \u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n;\nunsigned int a[200010];\nconst int M=1145141;\nint num[200010],len;\nunsigned int hash_front[200010],hash_back[200010],ppow[200010];\nvoid init(){\n\tfor(int i=1;i<=n;i++) hash_front[i]=hash_front[i-1]*M+a[i];\n\tfor(int i=n;i>=1;i--) hash_back[i]=hash_back[i+1]*M+a[i];\n\tppow[0]=1;\n\tfor(int i=1;i<=n;i++) ppow[i]=ppow[i-1]*M;\n}\nunsigned int Hash(int l,int r){\n\tunsigned a=hash_front[r]-hash_front[l-1]*ppow[r-l+1],b=hash_back[l]-hash_back[r+1]*ppow[r-l+1];\n\treturn a*b;\n}\nset<unsigned int> st;\nint check(int k){\n\tint ans=0;\n\tfor(int i=k;i<=n;i+=k){\n\t\tunsigned int t=Hash(i-k+1,i);\n\t\tif(!st.count(t)){\n\t\t\tst.insert(t);\n\t\t\tans++;\n\t\t}\n\t}\n\treturn ans;\n}\nint tot;\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&a[i]);\n\tinit();\n\tfor(int i=1;i<=n;i++){\n\t\tst.clear();\n\t\tint t=check(i);\n\t\tif(tot<t){\n\t\t\tnum[1]=i;\n\t\t\tlen=1;\n\t\t\ttot=t;\n\t\t\tcontinue;\n\t\t}\n\t\tif(tot==t){\n\t\t\tnum[++len]=i;\n\t\t}\n\t}\n\tprintf(\"%d %d\\n\",tot,len);\n\tfor(int i=1;i<=len;i++) printf(\"%d \",num[i]);\n\treturn 0;\n}\n```\n",
        "postTime": 1626883058,
        "uid": 232516,
        "name": "harqwq",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P3498 [POI2010]KOR-Beads"
    },
    {
        "content": "#### Description\n\n> \u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217 $a_i$\uff0c\u6c42\u6240\u6709\u6ee1\u8db3\u8981\u6c42\u7684 $k$ \u4f7f\u5f97\u5c06 $a_i$ \u5206\u4e3a $\\lfloor\\frac n k\\rfloor$ \u6bb5 $[1,k],[k+1,2k],\\cdots,[(\\lfloor\\frac n k\\rfloor -1) \\times k,\\lfloor\\frac n k\\rfloor \\times k]$\uff0c\u4f7f\u5f97\u8fd9 $\\lfloor\\frac n k\\rfloor$ \u6bb5\u4e2d\u4e0d\u540c\u7684\u5b50\u5e8f\u5217\u6570\u91cf\u6700\u591a\uff0c\u5176\u4e2d $1,2,3=3,2,1$\uff08\u7ffb\u8f6c\u540e\u5e8f\u5217\u76f8\u540c\uff09\u3002\n\n#### Solution\n\n\u54c8\u5e0c\u6c34\u9898\u3002\n\n\u76f4\u63a5\u4ece\u66b4\u529b\u5f00\u59cb\u8003\u8651\uff0c\u679a\u4e3e $k \\in [1,n]$ \u505a\u5b50\u5e8f\u5217\u957f\u5ea6\uff0c\u518d\u679a\u4e3e\u5de6\u7aef\u70b9 $i$\uff0c\u6bcf\u6b21\u7528\u54c8\u5e0c\u8fdb\u884c\u6bd4\u8f83\uff0c\u5177\u4f53\u7ec6\u8282\u5c31\u662f\u5bf9\u54c8\u5e0c\u503c\u5efa\u7acb\u4e00\u4e2a map\uff0c\u610f\u4e49\u5c31\u662f\u5bf9\u5e94\u54c8\u5e0c\u503c\u662f\u5426\u6709\u533a\u95f4\u4e0e\u4e4b\u5bf9\u5e94\uff0c\u7136\u540e\u6bcf\u6b21\u6ca1\u6709\u91cd\u590d\u7684\u5c31\u66f4\u65b0\u7b54\u6848\uff0c\u7edf\u8ba1\u5b8c\u4e00\u6b21 $k$ \u4e4b\u540e\u518d\u7edf\u8ba1\u4e00\u4e0b\u7b54\u6848\uff0c\u5c31\u6ca1\u4e86\uff1f\u5c31\u6ca1\u4e86\u3002\n\n~~\u54c8\u54c8\u54c8\u8349\u3002~~ \u6211\u4eec\u6765\u5206\u6790\u4e00\u4e0b\u590d\u6742\u5ea6\uff0c\u5916\u5c42\u5faa\u73af\u662f $\\mathcal O(n)$ \u7684\uff0c\u5185\u5c42\u5faa\u73af\u662f $\\mathcal O(\\ln n)$ \u7684\uff08\u5982\u679c\u4e0d\u660e\u767d\u53ef\u4ee5\u770b\u5e95\u4e0b\u7684\u4ee3\u7801\u7ec6\u8282\uff09\uff0c\u9884\u5904\u7406\u54c8\u5e0c\u4e5f\u5c31 $\\mathcal O(n)$\uff0c\u6700\u591a\u5e26\u4e2a map \u7684 $\\log$\uff0c\u5c31\u6ca1\u4e86\u3002\n\n\u6700\u540e\u8bf4\u4e00\u4e0b\u7ffb\u8f6c\u7b97\u540c\u4e00\u5e8f\u5217\u7684\u5904\u7406\u65b9\u5f0f\uff0c\u5c31\u6b63\u53cd\u90fd\u6765\u4e00\u904d\u54c8\u5e0c\uff0c\u7136\u540e\u7edf\u8ba1\u54c8\u5e0c\u503c\u65f6\u6b63\u53cd\u4e24\u7aef\u540c\u65f6\u64cd\u4f5c\u5373\u53ef\u3002\n\n#### Code\n\n```cpp\n#include <bits/stdc++.h>\n#define ull unsigned long long\n\nusing namespace std;\n\nconst ull P = 1000000007;\nint n;\nint a[200010];\null h1[200010];\null h2[200010];\n\nmap<ull, bool> mp;\n\null binpow (ull b, ull p) {\n\tull res = 1;\n\twhile (p > 0) {\n\t\tif (p & 1)\n\t\t\tres = res * b;\n\t\tb = b * b;\n\t\tp >>= 1;\n\t}\n\treturn res;\n}\n\null getHash1 (int l, int r) {\n\treturn h1[r] - h1[l - 1] * binpow(P, r - l + 1);\n}\n\null getHash2 (int r, int l) {\n\treturn h2[l] - h2[r + 1] * binpow(P, r - l + 1);\n}\n\nint answer[200010];\nint cnt[200010];\n\nint main () {\n\tscanf(\"%d\", &n);\n\tint ans = 0;\n\tfor (int i = 1; i <= n; i++) scanf(\"%d\", &a[i]);\n\tfor (int i = 1; i <= n; i++) h1[i] = h1[i - 1] * P + a[i];\n\tfor (int i = n; i >= 1; i--) h2[i] = h2[i + 1] * P + a[i];\n\tfor (int k = 1; k <= n; k++) {\n\t\tmp.clear();\n\t\tint C = 0;\n\t\tfor (int i = 1; i + k - 1 <= n; i += k) {\n\t\t\tull gh1 = getHash1(i, i + k - 1);\n\t\t\tull gh2 = getHash2(i + k - 1, i);\n\t\t\tif (mp.count(gh1) || mp.count(gh2)) continue;\n\t\t\telse mp[gh1] = true, mp[gh2] = true, C++;\n\t\t}\n\t\tans = max(ans, C);\n\t\tanswer[k] = C;\n\t}\n\tint A = 0;\n\tfor (int i = 1; i <= n; i++)\n\t\tif (answer[i] == ans)\n\t\t\tcnt[++A] = i;\n\tprintf(\"%d %d\\n\", ans, A);\n\tfor (int i = 1; i <= A; i++) printf(\"%d \", cnt[i]); \n\treturn 0;\n}\n```",
        "postTime": 1626513930,
        "uid": 114914,
        "name": "\u4e00\u53ea\u4e66\u866b\u4ed4",
        "ccfLevel": 4,
        "title": "P3498 \u9898\u89e3"
    },
    {
        "content": "###\u3010\u601d\u8def\u5206\u6790\u3011\n\n\u90fd\u6807\u7740 $Hash$ \u7684\u6807\u7b7e\uff0c\u6240\u4ee5\u4e00\u822c\u8981\u7528 $Hash$ \u505a~~\u778e\u7f16\u4e2d~~\uff1b\n\u6b64\u65b9\u6cd5\u6781\u5176\u66b4\u529b\uff0c\u4f46\u662f\u81f3\u5c11\u6211 $AC$ \u4e86\u3002\n\n**\u603b\u4f53\u601d\u8def** : \n\u53ef\u4ee5\u6c42\u8fd9 $n$ \u4e2a\u6570\u7684**\u524d\u540e\u7f00 $Hash$\u503c**\uff0c\u4e4b\u540e\u4ece\u6bcf $1$ \u4e2a\u5206\u4e3a\u4e00\u6bb5\u5230\u6bcf $n - 1$ \u4e2a\u5206\u4e3a\u4e00\u6bb5\uff0c\u4f9d\u6b21\u8fdb\u884c\u5224\u65ad\u3002\n\n\u56e0\u4e3a\u9898\u76ee\u4e2d\u8bf4 \uff1a **\u5b50\u4e32\u90fd\u662f\u53ef\u4ee5\u53cd\u8f6c\u7684** \uff0c\u6240\u4ee5\u9996\u5148\u6c42\u524d\u540e\u7f00 $Hash$ \u503c\uff0c\u540e\u7f00 $Hash$ \u503c\u5c31\u662f\u628a\u524d\u7f00 $Hash$ \u503c\u7684\u6c42\u6cd5\u53cd\u8fc7\u6765\u3002\n\n**\u3010Code\u3011**\n```cpp\nvoid prepare()//\u524d\u540e\u7f00Hash\u503c\u548c\u8fdb\u5236\u3002 \n{\n\tpo[0] = 1;\n\tfor(int i = 1;i <= n;i ++) {//\u8fdb\u5236\n\t\tpo[i] = po[i - 1] * p;\n\t}\n\tfor(int i = 1;i <= n;i ++) {\n\t\tHash_z[i] = Hash_z[i - 1] * p + s[i];//\u524d\u7f00Hash\u503c\n\t}\n\tfor(int i = n;i >= 1;i --) {\n\t\tHash_f[i] = Hash_f[i + 1] * p + s[i];//\u540e\u7f00Hash\u503c\n\t}\n\treturn;\n}\n```\n\u5982\u4f55\u6765\u6c42\u4e00\u4e2a\u5b50\u4e32\u7684 $Hash$ \u503c \uff1a\n\n\u5982\u679c\u6211\u4eec\u5df2\u77e5\u5b57\u7b26\u4e32 $S$ \u7684 $Hash$ \u503c\u662f $H(S)$ \uff0c\u5b57\u7b26\u4e32 $S + T$ \u7684 $Hash$ \u503c\u662f $H(S + T)$ \uff0c\u90a3\u4e48\u5b57\u7b26\u4e32 $T$ \u7684 $Hash$ \u503c\u5c31\u662f \n\n$$H(T) = (H(S +  T) - H(S) * p^{length(T)})\\ mod\\ M$$\n\n\u6839\u636e\u8fd9\u4e2a\u6027\u8d28\u5c31\u53ef\u4ee5\u8fdb\u884c\u8fd0\u7b97\u3002\n\n\u6240\u4ee5\u5728\u8fd9\u4e2a\u9898\u76ee\u4e2d\u524d\u7f00 $Hash$ \u503c\u53ef\u4ee5 $$Hash[k] = Hash[i] - Hash[i - k] * power[k]$$\n\n\u540e\u7f00 $Hash$ \u503c $$Hash[k] = Hash[i - k + 1] - Hash[i + 1] * power[k]$$\n\n\u4e4b\u540e\u5c31\u5f00\u59cb\u8fdb\u884c\u5bf9\u6bcf\u6b21\u5206\u5272\u7684\u8ba1\u7b97\uff0c\u5bf9\u6bcf\u6b21\u7684\u7ed3\u679c\u8fdb\u884c\u6bd4\u8f83\u548c\u50a8\u5b58\uff0c\u5f97\u51fa\u7b54\u6848\uff0c\u4f46\u662f\uff0c\u6211\u8bd5\u4e86\u4e00\u4e0b\uff0c\u53d1\u73b0 $TLE$ \u4e86\u4e24\u4e2a\u70b9 \u7b2c\u4e03\u4e2a\u548c\u7b2c\u4e5d\u4e2a (\u5176\u5b9e\u5438\u6c27\u4e5f\u80fd $AC$ )\u3002\n\n\u4e8e\u662f\u5f00\u59cb\u4e86\u6211\u4eec\u7684\u526a\u679d\u4e4b\u8def\uff0c\u53d1\u73b0\u4e86\u4e24\u4e2a\u89c4\u7387 \uff1a \n\n1. \u56e0\u4e3a\u5b58\u7684\u662f\u6b63\u53cd\u4e24\u4e2a\u5b50\u4e32\uff0c\u6240\u4ee5\u518d\u5224\u91cd\u7684\u65f6\u5019\u53ea\u9700\u5224\u65ad\u524d\u7f00 $Hash$ \u662f\u5426\u76f8\u7b49\u5373\u53ef\uff0c\u4f18\u5316 $0.1$ \u79d2\u3002\n2. \u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6c42\u51fa\u7684\u7b54\u6848\uff0c\u5982\u679c\u5728\u540e\u9762\u7684\u679a\u4e3e\u4e2d\u53ef\u5206\u7684\u6bb5\u6570\u8fd8\u6bd4\u5df2\u77e5\u7b54\u6848\u8981\u5c0f\uff0c\u80af\u5b9a\u4e0d\u662f\u6700\u4f18\u89e3\uff0c\u6240\u4ee5\u76f4\u63a5\u6392\u9664\u5373\u53ef\uff0c\u4f18\u5316 $0.69$ \u79d2\u3002\n\n\u4e4b\u540e\u6211\u4e5f\u60f3\u4e0d\u51fa\u4ec0\u4e48\u53ef\u4ee5\u4f18\u5316\u7684\u65b9\u6cd5\u4e86\uff0c\u5438\u4e86\u53e3\u5c0f\u6c27\u5c31\u8fc7\u53bb\u4e86\uff0c\u6700\u540e\u4e0d\u5438\u6c27\u7684\u60c5\u51b5\u4e0b\u662f $1.5$ \u79d2(\u7b2c\u4e5d\u4e2a\u70b9\u8d85\u65f6)\uff0c\u5438\u4e86\u6c27\u662f $339ms$ \u3002\uff08 $STL$ \u7684\u5e38\u6570\u592a\u5927\u4e86\uff0c\u7528\u6570\u7ec4\u6765\u6a21\u62df\u65f6\u95f4\u8981\u5c11\uff09\u3002\n\n-----\n#### \u3010Code\u3011\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<iostream>\n#include<cstring>\n#include<queue>\n#include<algorithm>\n#include<map>\n#include<vector>\n#include<set>\n#define ull unsigned long long\n#define ll long long\n#define M 1000010\n#define N 1010\n#define INF 0x3f3f3f3f\nusing namespace std;\nconst int p = 10007;\n/*================================================*/\n\nint n;\nint s[M];\null Hash_z[M], Hash_f[M], po[M];;//\u6b63Hash\u503c \uff0c\u53cdHash\u503c\uff0c\u8fdb\u5236\nint cnt;//\u8ba1\u7b97\u6709\u51e0\u4e2a\u6700\u4f18\u89e3\nint ans_cnt;//\u770b\u53ef\u5206\u4e3a\u51e0\u6bb5\u4e0d\u540c\u7684\u503c\nvector<ull> qp;//\u50a8\u5b58\u6bcf\u6b21\u5206\u5272\u7684\u7b54\u6848\nint maxn = -1e5;//\u8ba1\u7b97\u6700\u7ec8\u7684\u53ef\u5206\u7684\u6700\u5927\u7684\u6bb5\u6570\nvector<int> ans;//\u50a8\u5b58\u6bcf\u4e2a\u6700\u4f18\u89e3\nint m; //\u526a\u679d\u7528\n\n\n/*================================================*/\n\ninline int read()\n{\n\tint s = 0, f = 0;char ch = getchar();\n\twhile (!isdigit(ch)) f |= ch == '-', ch = getchar();\n\twhile (isdigit(ch)) s = s * 10 + (ch ^ 48), ch = getchar();\n\treturn f ? -s : s;\n}\n\nvoid prepare()//\u524d\u540e\u7f00Hash \u503c\u548c\u8fdb\u5236\u4f4d \n{\n\tpo[0] = 1;\n\tfor(int i = 1;i <= n;i ++) {\n\t\tpo[i] = po[i - 1] * p;\n\t}\n\tfor(int i = 1;i <= n;i ++) {\n\t\tHash_z[i] = Hash_z[i - 1] * p + s[i];\n\t}\n\tfor(int i = n;i >= 1;i --) {\n\t\tHash_f[i] = Hash_f[i + 1] * p + s[i];\n\t}\n\treturn;\n}\n\nbool check(int x)//\u5224\u65ad\u51fd\u6570\uff0c\u5224\u65ad\u662f\u5426\u6709\u8fd9\u4e2a\u5b50\u4e32\n{\n\tfor(int i = 0;i <qp.size(); i ++) {\n\t\tif(qp[i] == x) return false;\n\t}\n\treturn true;\n}\n\nvoid solve(int k)\n{\t\n\tans_cnt = 0;\n\tfor(int i = k;i <= n;i += k) {\n\t\tint sum_z = Hash_z[i] - Hash_z[i - k] * po[k];\n\t\t//\u8fd9\u4e2a\u5b50\u4e32\u524d\u7f00Hash\u503c\n\t\tint sum_f = Hash_f[i - k + 1] - Hash_f[i + 1] * po[k];//\u540e\u7f00\n\t\tif(check(sum_z)) {//\u5224\u65ad\n\t\t\tqp.push_back(sum_z);\n\t\t\tans_cnt++;//\u7d2f\u52a0\u53ef\u5206\u7684\u6bb5\u6570\n\t\t\t//if(check(sum_f)) //\u526a\u679d 1 ,\u6548\u679c\u5982\u4e0a\n\t\t\tqp.push_back(sum_f);\n\t\t}\n\t}\n\tif(maxn == ans_cnt) {//\u5f53\u5df2\u77e5\u7684\u6700\u4f18\u89e3\u548c\u65b0\u6c42\u51fa\u7684\u89e3\u76f8\u540c\u65f6\n\t\tans.push_back(k);//\u8bb0\u5f55k \u503c \n\t\tcnt++;//\u6700\u4f18\u89e3\u4e2a\u6570++\n\t} else if(maxn < ans_cnt) {//\u53c8\u65b0\u6c42\u51fa\u66f4\u4f18\u7684\u89e3\n\t\tans.clear();//\u6e05\u7a7a\u539f\u6765\u7684\u7b54\u6848\u5e8f\u5217\n\t\tans.push_back(k);//\u6dfb\u52a0\u89e3\n\t\tmaxn = ans_cnt;\n\t\tcnt = 1; \n\t}\n\tif(ans_cnt != 0) {\n\t\tm = min(m,n / ans_cnt);//\u526a\u679d 2 \u6548\u679c\u5982\u4e0a\n\t}\n\tqp.clear();//\u591a\u6b21\u5206\u5272\u8bb0\u5f97\u6e05\u7a7a\n}\n/*=================================================*/\n\nsigned main()\n{\n//\tfreopen(\".in\",\"r\",stdin);\n//\tfreopen(\".out\",\"w\",stdout);\n\tn = read();\n\tfor(int i = 1;i <= n;i ++) {\n\t\ts[i] = read();\n\t}\n\tprepare();\n\tm = n;\n\tfor(int i = 1;i <= m;i ++) solve(i);\n\tprintf(\"%d %d\\n\",maxn,cnt);\n\tfor(int i = 0;i <ans.size();i ++) printf(\"%d \",ans[i]);//\u8f93\u51fa\n\treturn 0;\n}\n```\n**\u5c0f\u9519\u8bef**\n\n\u53d6\u5e95\u6570\u7684\u65f6\u5019\u8981\u53d6\u4e2a\u5927\u70b9\u7684\u503c(\u6216\u8005\u5199\u53cc $Hash$)\uff0c\u5229\u7528 $unsigned$ $long$ $long$ \u7684\u81ea\u7136\u6ea2\u51fa\u6765\u5224\u65ad\uff0c\u5426\u5219\u5f88\u5bb9\u6613\u548c\u6211\u4e00\u6837\uff0c\u7528 $31$ \u6765\u505a\u8fdb\u5236\uff0c\u4f7f\u5f97 $WA$ \u58f0\u4e00\u7247\u3002\n\n\n",
        "postTime": 1610021355,
        "uid": 381904,
        "name": "\u659c\u63fd\u6b8b\u7bab",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3498 \u3010[POI2010]KOR-Beads\u3011"
    },
    {
        "content": "~~\u7edd\u4e86\uff0c\u6211\u968f\u53e3\u5411\u8001\u5e08\u8bb2\u4e86\u51e0\u9053hash\u6c34\u9898\uff0c\u8001\u5e08\u9694\u5929\u5c31\u653e\u51fa\u6765\u7ed9\u5b66\u5f1f\u4eec\u8003\u4e86233~~\n\n\u53c2\u8003\u4e86claris\u7684\u8bb2\u89e3\u3002\n\n\u66b4\u529b\u679a\u4e3ek\u3002\u5bf9\u4e8e\u6bcf\u4e2ak\uff0c\u4e00\u5171\u6709\u230an/k\u230b\u4e2a\u5b50\u4e32\uff0c\u8fd9\u4e2a\u7684\u548c\u503c\u662f\u8c03\u548c\u7ea7\u6570\uff0c\u590d\u6742\u5ea6\u7ea6\u7b49\u4e8e(nlogn).\n\n\u6b63\u5411\u53cd\u5411\u9884\u5904\u7406\u4e00\u904d\uff0c\u6bcf\u6b21\u6c42hash\u503c\u53d6\u6b63\u53cdhash\u503c\u4e2d\u7684\u8f83\u5c0f\u503c\u3002\u5728hash\u8868\u4e2d\u67e5\u627e\u662f\u5426\u5df2\u7ecf\u51fa\u73b0\u8fc7\u4e86\u3002\n\n\u4f46\u6211\u4eec\u53d1\u73b0\u56e0\u4e3a\u8981\u9488\u5bf9\u591a\u4e2a\u957f\u5ea6k\u8fdb\u884c\u591a\u6b21hash\uff0c\u5c06\u6570\u7ec4\u6e05\u7a7a\u4f1a\u6d6a\u8d39\u5927\u91cf\u65f6\u95f4\u3002\u6240\u4ee5\u7528vis\u6570\u7ec4\u8868\u793a\u5f53\u524d\u4f4d\u7684\u65f6\u95f4\uff0c\u5f53\u524d\u4f4dvis\u6570\u7ec4\u66f4\u65b0\u65f6\u5c06\u5176head\u8bbe\u4e3a0\u5373\u53ef\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5ffd\u7565\u4e4b\u524d\u8fdb\u884c\u7684\u64cd\u4f5c\u4ece\u800c\u907f\u514d\u6e05\u7a7a\u6570\u7ec4\u4e86\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<string>\n#include<cstring>\n#include<queue>\nusing namespace std;\ntypedef long long ll;\nconst int N=200010,P=2333333,D=1000173169,M=1048575;\nint n,i,j,tot,head[M],ver[M],next[M],pow[N],a[N],pre[N],suf[N],val[N],ans,cnt,now,vis[M+1];\ninline int read(){\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();}\n\treturn x*f;\n}\ninline int hash(int l,int r){\n\treturn min((ll)(pre[r]-(ll)pre[l-1]*pow[r-l+1]%D+D)%D,(ll)(suf[l]-(ll)suf[r+1]*pow[r-l+1]%D+D)%D);\n}\ninline bool ins(int v){\n\tint u=v&M;\n\tif(vis[u]<i) vis[u]=i,head[u]=0;\n\tfor(int s=head[u];s;s=next[s]) if(ver[s]==v) return 0;\n\t++tot;next[tot]=head[u];head[u]=tot;ver[tot]=v;\n\treturn 1;\n}\nint main(){\n\tn=read();pow[0]=1;\n\tfor(i=1;i<=n;i++){a[i]=read();}\n\tfor(i=1;i<=n;i++){pow[i]=(ll)((ll)pow[i-1]*P)%D;}\n\tfor(i=1;i<=n;i++){pre[i]=(ll)((ll)pre[i-1]*P+a[i])%D;}\n\tfor(i=n;i>=1;i--){suf[i]=(ll)((ll)suf[i+1]*P+a[i])%D;}\n\tfor(i=1;i<=n;i++){\n\t\tfor(tot=0,j=i;j<=n;j+=i){\n\t\t\tif(ins(hash(j-i+1,j))) val[i]++;\n\t\t}\n\t}\n\tfor(i=1;i<=n;i++) if(val[i]>ans) ans=val[i],cnt=1;else if(val[i]==ans) cnt++;\n\tprintf(\"%d %d\\n\",ans,cnt);\n\tfor(i=1;i<=n;i++){\n\t\tif(val[i]==ans){\n\t\t\tprintf(\"%d \",i);\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n\n\n",
        "postTime": 1544259631,
        "uid": 53032,
        "name": "\u5c0f\u5858\u7a7a\u660e",
        "ccfLevel": 0,
        "title": "P3498 [POI2010]KOR-Beads"
    },
    {
        "content": "\u9898\u610f:\u7ed9\u4f60\u4e00\u4e2a\u4e32\uff0c\u4f60\u8981\u9009\u4e00\u4e2ak\uff0c\u4e4b\u540e\u8fd9\u4e2a\u4e32\u4f1a\u88ab\u5206\u6210\u7c7b\u4f3c1..k,k+1..2k\u7684\u51e0\u4e2a\u5b50\u4e32\uff0c\n\n\u5982\u679c\u6700\u540e\u4e00\u622a<k\u5c31\u4e0d\u8981\u4e86\u3002\u4e4b\u540e\u5982\u679c\u4e24\u4e2a\u5b50\u4e32\u76f8\u540c\u6216\u8005\u7ffb\u8f6c\u540e\u76f8\u540c\uff0c\u5c31\u53bb\u6389\u4e00\u4e2a\u3002\n\n\u95ee\u6700\u591a\u5269\u4e0b\u591a\u5c11\u4e2a\u5b50\u4e32\uff0c\u8f93\u51fa\u6240\u6709\u53ef\u4ee5\u7684k\u3002\n\n\u9898\u89e3:\u66b4\u529b\u679a\u4e3e\uff0chash\u4e4b\u540e\u7528sort\u6216\u8005hash\u53bb\u91cd nlogn\n",
        "postTime": 1486812839,
        "uid": 9168,
        "name": "kczno1",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3498 \u3010[POI2010]KOR-Beads\u3011"
    }
]
[
    {
        "content": "> \u5f15\u7406\uff1a\u4efb\u610f\u5408\u5e76\u65b9\u6848\u7684\u603b\u4ee3\u4ef7\u662f\u76f8\u540c\u7684\u3002\n\n\u8bc1\u660e\uff1a\u8ffd\u8e2a\u521d\u59cb\u7684\u67d0\u4e00\u5806\u77f3\u5b50\uff0c\u6211\u4eec\u53d1\u73b0\u5728\u5408\u5e76\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5b83\u603b\u4e0e\u5176\u5b83\u6240\u6709\u5806\u77f3\u5b50\u90fd\u4ea7\u751f\u4e86\u4e00\u5bf9\u4e58\u79ef\u7684\u8d21\u732e\uff0c\u7531\u6b64\u5f97\u8bc1\u3002\n\n\u7531\u5f15\u7406\u53ef\u77e5\uff0c\u5408\u5e76\u7684\u603b\u4ee3\u4ef7\u5c31\u662f\u6240\u6709 $a_i\\times a_j \\ (i<j)$ \u7684\u548c\uff0c\u56e0\u6b64\u6240\u6709\u60c5\u51b5\u7684\u4ee3\u4ef7\u4e4b\u548c\u5c31\u662f\n$$[x^2]\\sum_{a_1+\\cdots+a_n=S }\\prod_{i=1}^n(a_ix+1)[a_i>0]$$\n$$=[x^2y^S]\\left( \\sum_{i=1}^\\infty (ix+1)y^i\\right)^n$$\n\u597d\u5728\u8fd9\u4e2a\u4e8c\u5143 GF \u975e\u5e38\u7b80\u5355\uff0c\u5206\u4e24\u90e8\u5206\u6c42\u548c\u5316\u4e3a\n$$[x^2y^S]\\left( \\frac{xy}{(1-y)^2}+\\frac{y}{1-y}\\right)^n$$\n$$=[x^2y^{S-n}]\\frac{(x+(1-y))^n}{(1-y)^{2n}}$$\n\u628a\u4e0d\u542b $x$ \u7684\u9879\u63d0\u51fa\u6765\u5c31\u662f\n$$[y^{S-n}](1-y)^{-2n}[x^2](x+(1-y))^n$$\n$$=[y^{S-n}](1-y)^{-2n} \\binom n2(1-y)^{n-2}$$\n$$=\\binom n2 [y^{S-n}](1-y)^{-(n+2)}$$\n$$=\\binom n2 \\binom{S+1}{n+1}$$\n\u76f4\u63a5 $\\Theta(n)$ \u8ba1\u7b97\u5373\u53ef\u901a\u8fc7\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u505a\u5230 $\\Theta(\\sqrt n \\log n)$\u3002",
        "postTime": 1636809650,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "[\u2717\u2713OI R1] \u540e\u65b9\u4e4b\u6c34 Solution"
    },
    {
        "content": "# \u540e\u65b9\u4e4b\u6c34\n## \u9898\u76ee\u5927\u610f\n\u5b9a\u4e49\u4e00\u6b21\u77f3\u5b50\u5408\u5e76\u7684\u8fc7\u7a0b\u5982\u4e0b\uff1a\u6709\u4e00\u6392 $n$ \u5806\u77f3\u5b50\uff0c\u6bcf\u4e00\u5806\u6709 $a_i(a_i\\ge1)$ \u4e2a\u3002\u6bcf\u6b21\u4f60\u53ef\u4ee5\u9009\u62e9\u76f8\u90bb\u7684\u4e24\u5806\u77f3\u5b50\u5408\u5e76\uff0c\u8bbe\u4e2a\u6570\u5206\u522b\u4e3a $x,y$\uff0c\u5219\u4f60\u4f1a\u5f97\u5230\u4e00\u5806 $(x+y)$ \u4e2a\u77f3\u5b50\uff0c\u540c\u65f6\u4f60\u8981\u4ed8\u51fa $xy$ \u7684\u4ee3\u4ef7\u3002\u6700\u540e\u8981\u628a\u6240\u6709\u77f3\u5b50\u5408\u5e76\u6210\u4e00\u5806\u3002\u8bb0 $f(a_1,\\ldots,a_n)$ \u4e3a\u5408\u5e76\u8fd9\u4e9b\u77f3\u5b50\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n\u7ed9\u51fa\u77f3\u5b50\u603b\u6570 $S$\uff0c\u6c42\n$$ \\sum_{\\sum a_i=S}f(a_1,\\ldots,a_n) $$\n\u7b54\u6848\u5bf9 $998244353$ \u53d6\u6a21\u3002\n## \u9898\u89e3\n### \u7b97\u6cd5\u4e00\uff1a\u6211\u4f1a\u66b4\u529b\uff01\n\u679a\u4e3e\u6bcf\u4e00\u5806\u77f3\u5b50\u7684\u5927\u5c0f $a_i$\uff0c\u7136\u540e $O(n^3)$ \u533a\u95f4 DP\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O\\left(\\dbinom{S-1}{n-1}n^3\\right)$\u3002  \n\u53ef\u4ee5\u901a\u8fc7\u6d4b\u8bd5\u70b9 1,2\uff0c\u671f\u671b\u5f97\u5206\uff1a8\u3002\n### \u7b97\u6cd5\u4e8c\uff1a\u6211\u4f1a\u89c2\u5bdf\u6027\u8d28\uff01\n\u5982\u679c\u4f60\u624b\u73a9\u4e00\u4e0b\u5c31\u4f1a\u53d1\u73b0\u5bf9\u4e8e\u4e00\u4e2a $\\{a_i\\}$\uff0c\u4ee5\u4efb\u610f\u987a\u5e8f\u5408\u5e76\u7b54\u6848\u90fd\u662f\u4e00\u6837\u7684\u3002\u5177\u4f53\u7684\uff0c\u5982\u679c\u6211\u4eec\u628a\u5408\u5e76\u5f97\u5230\u7684\u77f3\u5b50\u5806\u4ee5\u53ef\u91cd\u96c6\u5408\u7684\u5f62\u5f0f\u5199\u51fa\u6765\uff0c\u5176\u5143\u7d20\u662f\u521d\u59cb\u7684\u77f3\u5b50\u6570\u91cf\uff0c\u90a3\u4e48\u5408\u5e76 $S,T$ \u7684\u8d21\u732e\u76f8\u5f53\u4e8e $\\displaystyle\\prod_{a\\in S,b\\in T}ab$\u3002\u6700\u540e\u6240\u6709\u90fd\u88ab\u5408\u5e76\u6210\u4e86\u4e00\u5806\uff0c\u76f8\u5f53\u4e8e\u521d\u59cb\u7684\u6bcf\u4e00\u5806\u548c\u5176\u4ed6\u6bcf\u4e00\u5806\u90fd\u5408\u5e76\u4e86\u4e00\u6b21\uff0c\u56e0\u6b64\u7b54\u6848\u5c31\u662f $\\dfrac{\\sum a_i(S-a_i)}{2}$\u3002  \n\u679a\u4e3e\u62c6\u5206\u6570\u7136\u540e\u7edf\u8ba1\u7b54\u6848\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\operatorname{partition(S,n)}n)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6d4b\u8bd5\u70b9 1~7\uff0c\u671f\u671b\u5f97\u5206 28\u3002\n### \u7b97\u6cd5\u4e09\uff1a\u6211\u4f1a DP\uff01\n\u4ece\u8fd9\u91cc\u5f00\u59cb\u90fd\u662f\u591a\u9879\u5f0f\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u7b97\u6cd5\u4e86\u3002  \n\u9996\u5148\u5c06\u5f0f\u5b50\u53d8\u5f62\uff1a\n$$ \\begin{aligned}\\mathit{ans}&=\\sum_{\\sum a_i=S}\\dfrac{\\sum a_i(S-a_i)}{2}\\\\&=\\dfrac{1}{2}\\sum_{\\sum a_i=S}\\left(\\sum a_iS-\\sum a_i^2\\right)\\\\&=\\dfrac{1}{2}\\sum_{\\sum a_i=S}\\left(S^2-\\sum a_i^2\\right)\\\\&=\\dfrac{1}{2}\\dbinom{S-1}{n-1}S^2-\\dfrac{1}{2}\\sum_{\\sum a_i=S}\\sum a_i^2\\end{aligned} $$\n\u63a5\u4e0b\u6765\u7684\u76ee\u6807\u5c31\u662f\u6c42 $\\displaystyle\\sum_{\\sum a_i=S}\\sum a_i^2$\u3002  \n\u8bbe $f_{i,j}$ \u8868\u793a\u524d $i$ \u4e2a\u6570\u548c\u4e3a $j$ \u7684\u7b54\u6848\uff0c\u5219 $f_{i,j}=\\sum_{k<j}\\left(f_{i-1,k}+\\dbinom{k-1}{i-2}(j-k)^2\\right)$\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(nS^2)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6d4b\u8bd5\u70b9 1~9\uff0c\u671f\u671b\u5f97\u5206 36\u3002\n### \u7b97\u6cd5\u56db\uff1a\u6211\u4f1a\u4f18\u5316\u8f6c\u79fb\uff01\n\u5c06\u4e0a\u9762\u7684 $(j-k)^2$ \u5c55\u5f00\uff0c\u7136\u540e\u524d\u7f00\u548c\u4f18\u5316\u8f6c\u79fb\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(nS)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6d4b\u8bd5\u70b9 1~11\uff0c\u671f\u671b\u5f97\u5206 44\u3002\n### \u7b97\u6cd5\u4e94\uff1a\u6211\u4f1a\u4ea4\u6362\u6c42\u548c\u987a\u5e8f\uff01\n\u76f8\u5f53\u4e8e\u6c42\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u8d21\u732e\u4e4b\u548c\u3002\u679a\u4e3e\u8fd9\u4e2a\u4f4d\u7f6e\u586b\u7684\u6570\uff0c\u53ef\u5f97 $n\\sum_{i=1}^{S-n+1}i^2\\dbinom{S-i-1}{n-2}$\u3002\u76f4\u63a5\u6c42\u548c\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(S)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6d4b\u8bd5\u70b9 1~14\uff0c\u671f\u671b\u5f97\u5206 56\u3002\n### \u7b97\u6cd5\u516d\uff1a\u6211\u4f1a\u6c42\u548c\u516c\u5f0f\uff01\n$n=2$ \u7684\u60c5\u51b5\u5c31\u662f $\\sum i(S-i)$\uff0c\u7528 $1^2+2^2+\\cdots+n^2=\\dfrac{n(n+1)(2n+1)}{6}$ \u8ba1\u7b97\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(1)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6d4b\u8bd5\u70b9 15\uff0c\u7ed3\u5408\u4e4b\u524d\u671f\u671b\u5f97\u5206 60\u3002\n### \u7b97\u6cd5\u4e03\uff1a\u6211\u4f1a\u63d2\u503c\uff01\n\u7b54\u6848\u662f\u4e00\u4e2a\u5173\u4e8e $S$ \u7684 $O(n)$ \u6b21\u591a\u9879\u5f0f\uff0c\u7b97\u51fa\u524d $O(n)$ \u9879\u4e4b\u540e\u63d2\u503c\u53ef\u5f97\u5728 $S$ \u5904\u7684\u503c\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6d4b\u8bd5\u70b9 1~11,15~18\uff0c\u7ed3\u5408\u4e4b\u524d\u671f\u671b\u5f97\u5206 72\u3002\n### \u7b97\u6cd5\u516b\uff1a\u6211\u4f1a\u63a8\u5f0f\u5b50\uff01\n\u63d0\u4f9b\u4e09\u79cd\u65b9\u5f0f\uff1a\u751f\u6210\u51fd\u6570\u3001\u7ec4\u5408\u6052\u7b49\u5f0f\u3001\u7ec4\u5408\u610f\u4e49\u3002  \n**\u751f\u6210\u51fd\u6570**\uff1a  \n\u4f17\u6240\u5468\u77e5\uff1a\n$$ \\sum_{i}ix^i=\\dfrac{x}{(1-x)^2} $$\n\u5bf9\u5176\u6c42\u5bfc\u4e58 $x$ \u5373\u53ef\u5f97\n$$ F(x)=\\sum_{i}i^2x^i=\\dfrac{x(x+1)}{(1-x)^3} $$\n\u5bb9\u6613\u77e5\u9053\n$$ G(x)=\\sum_{i}\\dbinom{i-1}{n-2}x^i=\\dfrac{x^{n-1}}{(1-x)^{n-1}} $$\n\u6240\u4ee5\n$$ F(x)G(x)=\\dfrac{x^n+x^{n+1}}{(1-x)^{n+2}}=\\sum_{k}\\sum_{i}i^2\\dbinom{k-i-1}{n-2}x^k $$\n\u6240\u4ee5\n$$ \\sum_{i}i^2\\dbinom{S-i-1}{n-2}=\\left[x^S\\right]\\dfrac{x^n+x^{n+1}}{(1-x)^{n+2}}=\\dbinom{S+1}{n+1}+\\dbinom{S}{n+1} $$\n\n**\u7ec4\u5408\u6052\u7b49\u5f0f**\uff1a\n$$ \\begin{aligned}\\mathit{ans}&=\\sum_{i=1}^{S-1}i^2\\dbinom{S-i-1}{n-2}\\\\&=\\sum_{i=0}^{S-2}\\dbinom{i}{n-2}(S-i-1)^2\\end{aligned} $$\n\u628a $(S-i-1)^2$ \u62c6\u6210 $c_1(i+1)(i+2)+c_2(i+1)+c_3$ \u7684\u5f62\u5f0f\u3002\u7136\u540e\u5c31\u6709\n$$ \\begin{aligned}\\mathit{ans}&=\\sum_{i=0}^{S-2}\\dbinom{i}{n-2}\\left((i+1)(i+2)-(2S+1)(i+1)+S^2\\right)\\\\&=\\sum_{i=0}^{S-2}\\dbinom{i}{n-2}(i+1)(i+2)-\\sum_{i=0}^{S-2}\\dbinom{i}{n-2}(2S+1)(i+1)+\\sum_{i=0}^{S-2}\\dbinom{i}{n-2}S^2\\\\&=n(n-1)\\sum_{i=0}^{S-2}\\dbinom{i+2}{n}-(2S+1)(n-1)\\sum_{i=0}^{S-2}\\dbinom{i+1}{n-1}+n(n-1)\\sum_{i=0}^{S-2}\\dbinom{i}{n-2}\\\\&=S^2\\sum_{i=0}^{S}\\dbinom{i}{n}-(2S+1)(n-1)\\sum_{i=0}^{S-1}\\dbinom{i}{n-1}+S^2\\sum_{i=0}^{S-2}\\dbinom{i}{n-2}\\\\&=n(n-1)\\dbinom{S+1}{n+1}-(2S+1)(n-1)\\dbinom{S}{n}+S^2\\dbinom{S-1}{n-1}\\end{aligned} $$\n\u6700\u540e\u4e00\u6b65\u7528\u5230\u7ec4\u5408\u6570\u6052\u7b49\u5f0f $\\sum_{i=0}^n\\dbinom{i}{k}=\\dbinom{n+1}{k+1}$\u3002\n\n**\u7ec4\u5408\u610f\u4e49**\uff1a  \n\u770b\u6210\u628a $(S-1)$ \u4e2a\u7269\u54c1\u5207\u5f00\uff0c\u53f3\u8fb9\u9009 $(n-2)$ \u4e2a\u7269\u54c1\uff0c\u5de6\u8fb9\u9009\u4e24\u4e2a\u7269\u54c1\uff0c\u5de6\u8fb9\u7684\u4e24\u4e2a\u7269\u54c1\u53ef\u4ee5\u91cd\u5408\uff0c\u4e5f\u53ef\u4ee5\u4ea4\u6362\u3002  \n\u9996\u5148\u628a\u5206\u754c\u7ebf\u770b\u6210\u4e00\u4e2a\u7269\u54c1\uff0c\u7136\u540e\u8ba8\u8bba\u5de6\u8fb9\u4e24\u4e2a\u7269\u54c1\u7684\u4f4d\u7f6e\u5173\u7cfb\u3002  \n$x\\le y$\uff1a\u5c06 $y$ \u4e5f\u770b\u6210\u5206\u754c\u7ebf\u3002  \n$x>y$\uff1a\u76f4\u63a5\u9009\u3002  \n\u628a\u5206\u754c\u7ebf\u770b\u6210\u7269\u54c1\u7684\u8bdd\uff0c\u7b2c\u4e00\u79cd\u60c5\u51b5\u8981\u6dfb\u52a0\u4e24\u4e2a\u7269\u54c1\uff0c\u7b2c\u4e8c\u79cd\u60c5\u51b5\u8981\u52a0\u4e00\u4e2a\u3002\u90a3\u7b2c\u4e00\u79cd\u60c5\u51b5\u5c31\u662f $\\dbinom{S+1}{n+1}$\uff0c\u7b2c\u4e8c\u79cd\u60c5\u51b5\u5c31\u662f $\\dbinom{S}{n+1}$\u3002\n\n---\n\u56e0\u6b64\u6700\u7ec8\u7b54\u6848\u5c31\u662f\n$$\\sum_{\\sum a_i=S}f(a_1,\\ldots, a_n)=\\dfrac{S^2\\dbinom{S-1}{n-1}-n\\left(\\dbinom{S+1}{n+1}+\\dbinom{S}{n+1}\\right)}{2}$$  \n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6240\u6709\u6d4b\u8bd5\u70b9\uff0c\u671f\u671b\u5f97\u5206 100\u3002",
        "postTime": 1637219465,
        "uid": 68273,
        "name": "xyf007",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P7950 \u3010[\u2717\u2713OI R1] \u540e\u65b9\u4e4b\u6c34\u3011"
    },
    {
        "content": "\u7b80\u5355\u7684\u6570\u5b66\u9898\u3002\n\n\u9996\u5148\u5bb9\u6613\u53d1\u73b0\u65e0\u8bba\u600e\u4e48\u5408\u5e76\u603b\u4ee3\u4ef7\u662f\u4e00\u6837\u7684\u3002\u8fd9\u662f\u7531\u4e8e\u4e24\u5806\u6570\u91cf\u5206\u522b\u4e3a $a,b$ \u7684\u77f3\u5b50\u4e4b\u95f4\u4ec5\u5728\u88ab\u5408\u5e76\u5230\u4e00\u5806\u7684\u90a3\u4e00\u6b21\u64cd\u4f5c\u5bf9\u603b\u4ee3\u4ef7\u8d21\u732e $ab$\uff0c\u4e14\u9664\u6b64\u8d21\u732e\u5916\u65e0\u5176\u4ed6\u8d21\u732e\u3002\u6545\u603b\u4ee3\u4ef7\u4e3a\n\n$$\\sum_{1 \\le i<j \\le n}a_ia_j=\\dfrac{S^2-\\sum\\limits_{i=1}^{n}a_i^2}{2}.$$\n\n\u63a5\u4e0b\u6765\u8981\u505a\u7684\u5c31\u662f\u63a8\u5f0f\u5b50\u3002\u9996\u5148\u7531\u63d2\u677f\u6cd5\u6709 $m$ \u9897\u77f3\u5b50\u5206\u4e3a $k$ \u5806\u6bcf\u5806\u81f3\u5c11\u4e00\u9897\u77f3\u5b50\u7684\u65b9\u6cd5\u6570\u4e3a $\\binom{m-1}{k-1}$\uff0c\u7136\u540e\u6211\u4eec\u5408\u5e76\u540c\u7c7b\u9879\u5f97\u5230\u4e0b\u9762\u7684\u5f0f\u5b50\uff1a\n\n$$\\sum_{\\sum a_i=S}\\dfrac{S^2-\\sum\\limits_{i=1}^{n}a_i^2}{2}=\\dfrac{1}{2}\\left(S\\binom{S-1}{n-1}-n\\sum_{i=1}^{S}i^2\\binom{S-i-1}{n-2}\\right).$$\n\n\u53f3\u8fb9\u90a3\u4e2a $\\sum$ \u662f\u4e2a\u5f88\u660e\u663e\u7684\u5377\u79ef\u5f62\u5f0f\uff0c\u6211\u4eec\u5f97\u5230\u4e24\u4e2a GF\uff1a\n\n$$\\dfrac{x(1+x)}{(1-x)^3}=\\sum_{n \\ge 0}n^2x^n,$$\n\n$$\\left(\\dfrac{x}{1-x}\\right)^{k-1}=\\sum_{n \\ge 0}\\binom{n-1}{k-2}x^n.$$\n\n\u6545\n\n$$\\sum_{i=1}^{S}i^2\\binom{S-i-1}{n-2}=[x^S]\\dfrac{x^n(1+x)}{(1-x)^{n+2}}=\\binom{S+1}{n+1}+\\binom{S}{n+1}.$$\n\n\u56e0\u6b64\n\n$$\\sum_{\\sum a_i=S}\\dfrac{S^2-\\sum\\limits_{i=1}^{n}a_i^2}{2}=\\dfrac{1}{2}\\left(S^2\\binom{S-1}{n-1}-n\\left(\\binom{S+1}{n+1}+\\binom{S}{n+1}\\right)\\right)=\\binom{S+1}{n+1}\\binom{n}{2}.$$\n\n\u9884\u5904\u7406\u9636\u4e58\u53ef\u4ee5\u505a\u5230 $O(tn)$\u3002\n\nCode:\n```cpp\n#include<cstdio>\n#define rg register\n#define ll long long\nconst int ntf=998244353;\ninline ll qpw(ll x,int v=ntf-2)\n{\n\tll r=1;\n\twhile(v)\n\t{\n\t\t(v&1)&&(r=r*x%ntf);\n\t\tx=x*x%ntf,v>>=1;\n\t}\n\treturn r;\n}\nint t,n[7],s[7],mxn;\nll fac[1000003];\nll fic[1000003];\nll ans;\nint main()\n{\n\tscanf(\" %d\",&t);\n\tfor(rg int i=0;i<t;++i)\n\t{\n\t\tscanf(\" %d %d\",&n[i],&s[i]);\n\t\tif(n[i]>mxn)mxn=n[i];\n\t}\n\t++mxn,fac[0]=1;\n\tfor(rg int i=1;i<=mxn;++i)fac[i]=fac[i-1]*i%ntf;\n\tfic[mxn]=qpw(fac[mxn]);\n\tfor(rg int i=mxn;i;--i)fic[i-1]=fic[i]*i%ntf;\n\tfor(rg int i=0;i<t;++i)\n\t{\n\t\tans=fic[n[i]+1];\n\t\tfor(rg int j=-1;j<n[i];++j)ans=ans*(s[i]-j)%ntf;\n\t\tans=ans*n[i]%ntf*(n[i]-1)%ntf*499122177%ntf;\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1636954200,
        "uid": 59388,
        "name": "VinstaG173",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7950 \u3010[\u2717\u2713OI R1] \u540e\u65b9\u4e4b\u6c34\u3011"
    },
    {
        "content": "\u4f17\u6240\u5468\u77e5\uff0c\u770b\u5230\u8fd9\u79cd\u8f93\u5165\u91cf\u5c11\u7684\u9898\u76ee\uff0c\u6211\u4eec\u5e94\u8be5 **\u627e \u89c4 \u5f8b**\u3002\n\n\u770b\u5230\u6570\u636e\u70b9\u4e2d\u6709 $k=2$\uff0c\u90a3\u6211\u4eec\u5148\u627e $k=2$ \u65f6\u7684\u89c4\u5f8b\uff0c\u53d1\u73b0\u5e8f\u5217\u4e3a $0,1,4,10,20,35$\uff0c\u901a\u9879\u516c\u5f0f\u4e3a $\\frac{(n+1) \\times n \\times (n-1)}{6}$\u3002$4$ \u5206\u5230\u624b\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u6765\u624b\u73a9 $k=3$\uff0c\u53d1\u73b0\u5e8f\u5217\u4e3a $0,0,3,15,45,105,210$\uff0c\u901a\u9879\u516c\u5f0f\u4e3a $\\frac{(n+1) \\times n \\times (n-1) \\times (n-2)}{8}$\uff08\u4eb2\u6d4boeis\u4e5f\u80fd\u627e\u5230\u89c4\u5f8b\uff09\u3002\n\n\u518d\u901a\u8fc7\u6837\u4f8b1\u4e2d\u7b2c3\u4e2a\u70b9\uff0c\u6211\u4eec\u731c\u6d4b\u89c4\u5f8b\u4e3a $\\frac{\\prod_{i=n-k+1}^{n+1}i}{x}$\uff0c\u63a5\u4e0b\u6765\u9700\u8981\u6c42\u51fa $x$\u3002\n\n\u5728\u624b\u73a9\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0\u65e0\u8bba\u600e\u4e48\u5408\u5e76\u6700\u7ec8\u4ee3\u4ef7\u76f8\u7b49\uff0c\u6240\u4ee5 $n=k$ \u65f6\u7b54\u6848\u4e3a $\\frac{n \\times (n-1)}{2}$\uff0c\u6240\u4ee5\u6c42\u5f97 $x=\\frac{2 \\times (n+1)!}{n \\times (n-1)}$\u3002\n\n\u6700\u7ec8\u7b54\u6848\u4e3a $\\frac{n \\times (n-1) \\times \\prod_{i=n-k+1}^{n+1}i}{2 \\times (n+1)!}$\u3002\n\n\u4ee3\u7801\u5b9e\u73b0\n\n```cpp\n#include<iostream>\n#include<cstdio>\nusing namespace std;\nlong long t,n,m,k,a,b,c,d,q,i;\nlong long p(long long a)\n{\n\tb=998244351;c=1;\n\twhile(b>0)\n\t{\n\t\tif(b%2==1)c=a*c%998244353;\n\t\ta=a*a%998244353;b=b/2;\n\t}\n\treturn c;\n}\nint main()\n{\n\ta=6;b=998244351;c=1;\n\twhile(b>0)\n\t{\n\t\tif(b%2==1)c=a*c%998244353;\n\t\ta=a*a%998244353;b=b/2;\n\t}\n\tscanf(\"%lld\",&t);\n\tfor(k=1;k<=t;k=k+1)\n\t{\n\t\tscanf(\"%lld%lld\",&n,&m);d=1;q=1;\n\t\tfor(i=m+1;i>=m-n+1;i=i-1)d=d*i%998244353;\n\t\tfor(i=1;i<=n+1;i=i+1)q=q*i%998244353;\n\t\ta=q*2*p(n)%998244353*p(n-1)%998244353;\n\t\tprintf(\"%lld\\n\",d*p(a)%998244353);\n\t}\n\treturn 0;\n}\n```\n\u6700\u540e\u8bf4\u53e5\u95f2\u8bdd\uff1a\n\n**\u627e \u89c4 \u5f8b t x d y\uff01\uff01\uff01**",
        "postTime": 1637067132,
        "uid": 87318,
        "name": "\u732b\u732c\u517d",
        "ccfLevel": 7,
        "title": "P7950"
    },
    {
        "content": "\u4e0d\u4f1a\u6570\u5b66/ll\n\n\u8003\u8651\u627e\u89c4\u5f8b\u3002\n\n\u9996\u5148\u5bb9\u6613\u53d1\u73b0\u4e0d\u7ba1\u6309\u4ec0\u4e48\u987a\u5e8f\u5408\u5e76\uff0c\u4efb\u610f\u4e24\u5806\u77f3\u5b50\u603b\u4f1a\u4ea7\u751f\u4e00\u6b21\u8d21\u732e\u3002\u6240\u4ee5\n\n$$f(a_1,...,a_n)=\\sum_{1\\leq i<j\\leq n}a_ia_j=\\dfrac{\\left(\\sum_{i=1}^na_i\\right)^2-\\sum_{i=1}^na_i^2}{2}=\\dfrac{1}{2}\\left(S^2-{\\sum_{i=1}^na_i^2}\\right)$$\n\n\u7531\u9694\u677f\u6cd5\u53ef\u4ee5\u77e5\u9053 $\\sum_{i=1}^na_i=S$ \u4e14 $a_i>0$ \u7684\u65b9\u6848\u6570\u4e3a $\\binom{S-1}{n-1}$\uff0c\u7136\u540e\u6c42 $\\sum_{i=1}^n a_i^2$\u3002\n\n\u8003\u8651\u5bf9\u6bcf\u4e2a $i=1\\sim S$ \u7684\u6570\u7b97\u8d21\u732e\u3002\n\n\u94a6\u5b9a $a$ \u4e2d\u6709\u4e00\u4e2a\u4e3a $i$\uff0c\u5176\u5b83\u7684 $n-1$ \u4e2a\u6570\u4efb\u610f\uff0c\u65b9\u6848\u6570\u4e3a $\\binom{S-i-1}{n-2}$\uff0c\u56e0\u4e3a\u6709 $n$ \u4e2a\u4f4d\u7f6e\u53ef\u4ee5\u653e $i$\uff0c\u6240\u4ee5\u4ea7\u751f\u7684\u8d21\u732e\u4e3a $i^2n\\binom{S-i-1}{n-2}$\u3002\n\n\u6545\u4e0a\u9762\u7684\u5f0f\u5b50\u53ef\u4ee5\u5316\u4e3a\n\n$$\\dfrac{1}{2}\\left(S^2\\binom{S-1}{n-1}-n\\sum_{i=1}^Si^2\\binom{S-i-1}{n-2}\\right)$$\n\n~~\u62ff\u5230\u4e86 56 \u5206\u7684\u597d\u6210\u7ee9\uff01~~\n\n\u7136\u540e\u53d1\u73b0\u590d\u6742\u5ea6\u74f6\u9888\u5728\u540e\u9762\u7684\u679a\u4e3e $i$\u3002\n\n~~\u6839\u636e\u7ecf\u9a8c~~\uff0c\u540e\u9762\u7684\u90a3\u4e00\u5768\u5f0f\u5b50\u663e\u7136\u53ef\u4ee5\u5316\u7b80\u3002\n\n\u8003\u8651\u6253\u8868\u627e\u540e\u9762\u90a3\u4e00\u5768\u5f0f\u5b50\u7684\u89c4\u5f8b\u3002\n\n[\u627e\u89c4\u5f8b\u90e8\u5206](https://www.luogu.com.cn/paste/a2xnj8vy)\n\n\u4e8e\u662f\u5f0f\u5b50\u5c31\u53d8\u6210\u4e86\n\n$$\\dfrac{1}{2}\\left(S^2\\binom{S-1}{n-1}-n\\left(\\binom{S+1}{n+1}+\\binom{S}{n+1}\\right)\\right)$$\n\n\u7136\u540e\u7ec4\u5408\u6570\u53ef\u4ee5\u9884\u5904\u7406\u9006\u5143 $O(n)$ \u66b4\u529b\u7b97\uff0c\u8fd9\u9898\u5c31\u505a\u5b8c\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define il inline\n#define re register\nusing namespace std;\n#define MAXA 1000005\n#define mod 998244353\n#define inv2 499122177\nil int QP(int p,int n){\n    re int ans=1;\n    for(;n;p=1ll*p*p%mod,n>>=1)if(n&1)ans=1ll*ans*p%mod;\n    return ans;\n}\nint fac[MAXA],inv[MAXA];\nint n,S;\nil int C(int n,int m){\n    if(n<m)return 0;re int ans=1;\n    for(re int i=0;i<m;++i)ans=1ll*ans*(n-i)%mod*inv[i+1]%mod;\n    return ans;\n}\nil void WORK(){\n    scanf(\"%d%d\",&n,&S);if(n==1){printf(\"0\\n\");return;}\n    re int ans=1ll*C(S-1,n-1)*S%mod*S%mod;\n    ans=(ans+mod-1ll*n*(C(S+1,n+1)+C(S,n+1))%mod)%mod;\n    printf(\"%lld\\n\",1ll*ans*inv2%mod);\n}\nint main(){\n    fac[0]=inv[0]=1;\n    for(re int i=1;i<MAXA;++i)fac[i]=1ll*fac[i-1]*i%mod;\n    inv[MAXA-1]=QP(fac[MAXA-1],mod-2);\n    for(re int i=MAXA-2;i;--i)inv[i]=1ll*inv[i+1]*(i+1)%mod;\n    for(re int i=1;i<MAXA;++i)inv[i]=1ll*fac[i-1]*inv[i]%mod;\n    re int T;scanf(\"%d\",&T);\n    for(re int i=0;i<T;++i)WORK();\n}\n```",
        "postTime": 1637508365,
        "uid": 150843,
        "name": "\u5510\u4e00\u6587",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P7950 \u3010[\u2717\u2713OI R1] \u540e\u65b9\u4e4b\u6c34\u3011"
    },
    {
        "content": "\u672c\u9898\u51fa\u9898\u4eba\u4e4b\u4e00\u3002\uff08xyf \u7ed9\u51fa\u4e86 $f$ \u7684\u5b9a\u4e49\u6253\u7b97\u653e 2B\uff0c\u6211\u89c9\u5f97\u592a\u900a\u4e86\u7136\u540e\u52a0\u5f3a\u6210\u4e86\u73b0\u5728\u7684\u6837\u5b50\uff0c\u5e76\u7ed9\u51fa\u4e86 poly \u505a\u6cd5\u5982\u4e0b\uff09\n\n$n=1$ \u65f6\u663e\u7136\u7b54\u6848\u662f $0$\uff0c\u8ba8\u8bba $n>1$ \u7684\u60c5\u51b5\u3002\n\n\u5bb9\u6613\u77e5\u9053\n$$\nf(a_1\\dots a_n)=\\sum_{i<j}a_ia_j=\\frac{S^2-\\sum_{i}a_i^2}{2}\n$$\n\u6240\u4ee5\n$$\n\\sum_{\\sum a_i=S}f(a_1\\dots a_n)=\\frac{S^2\\dbinom{S-1}{n-1}-\\sum_{\\sum a_i=S}(a_1^2+\\dots+a_n^2)}{2}\n$$\n\u8003\u8651\n$$\n\\sum_{\\sum a_i=S}(a_1^2+\\dots+a_n^2)=n\\sum_{x}x^2\\binom{S-x-1}{n-2}\n$$\n\u8003\u8651\u5377\u79ef\u5904\u7406\u8fd9\u4e2a\u5f0f\u5b50\u3002\n\n\u4f17\u6240\u5468\u77e5\uff1a\n$$\n\\sum_{i}ix^i=\\frac{x}{(1-x)^2}\n$$\n\n\u5bf9\u5176\u6c42\u5bfc\u4e58 $x$ \u5373\u53ef\u5f97\n$$\nF(x)=\\sum_{i}i^2x^i=\\frac{x(x+1)}{(1-x)^3}\n$$\n\u5bb9\u6613\u77e5\u9053\n$$\nG(x)=\\sum_{i}\\binom{i-1}{n-2}x^i=\\frac{x^{n-1}}{(1-x)^{n-1}}\n$$\n\u6240\u4ee5\n$$\nF(x)G(x)=\\frac{x^n+x^{n+1}}{(1-x)^{n+2}}=\\sum_{k}\\sum_{i}i^2\\binom{k-i-1}{n-2}x^k\n$$\n\u6240\u4ee5\n$$\nn\\sum_{x}x^2\\binom{S-x-1}{n-2}=n[x^S]\\frac{x^n+x^{n+1}}{(1-x)^{n+2}}=n(\\binom{S+1}{n+1}+\\binom{S}{n+1})\n$$\n\u5e26\u56de\u53bb\n\n$$\n\\sum_{\\sum a_i=S}f(a_1\\dots a_n)=\\frac{S^2\\dbinom{S-1}{n-1}-n(\\dbinom{S+1}{n+1}+\\dbinom{S}{n+1})}{2}\n$$",
        "postTime": 1637501790,
        "uid": 121027,
        "name": "Spasmodic",
        "ccfLevel": 7,
        "title": "\u540e\u65b9\u4e4b\u6c34"
    }
]
[
    {
        "content": "\u8fd9\u9053$dp$\u9898\u611f\u89c9\u4e5f\u633a\u795e\u7684\u3002\u3002\u6211\u4eec\u8003\u8651\u6bcf\u4e2a\u70b9\u6309\u591a\u6b21\u90fd\u53ef\u4ee5\u5f52\u5316\u6210\u6309\u6216\u4e0d\u6309\u4e24\u79cd\u72b6\u6001\uff0c\u800c\u4e14\u5f88\u663e\u7136\u53ef\u4ee5\u53d1\u73b0\uff0c\u6bcf\u4e2a\u6309\u952e\u90fd\u4e0d\u53ef\u80fd\u88ab\u5176\u4ed6\u6309\u952e\u7684\u7ec4\u5408\u952e\u66ff\u4ee3\uff0c\u4e8e\u662f\u6211\u4eec\u5b9e\u9645\u4e0a\u53ef\u4ee5\u4ece\u5927\u5230\u5c0f\u626b\u4e00\u904d\uff0c\u78b0\u5230\u4eae\u7684\u5c31\u6309\u4e00\u904d\uff0c\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u5c31\u53ef\u4ee5\u627e\u5230\u6240\u6709\u5fc5\u987b\u8981\u6309\u7684\u952e\uff0c\u5b9e\u9645\u4e0a\u5c31\u76f8\u5f53\u4e8e\u9664\u5f00\u8fd9\u4e9b\u952e\u6309\u4e86\u5176\u4ed6\u7684\u952e\u5c31\u8fd8\u8981\u5fc5\u987b\u6309\u4e00\u4e2a\u76f8\u540c\u7684\u952e\u7ed9\u6309\u56de\u6765\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5$dp$\u4e86\u3002\u6211\u4eec\u8bbe$f[i]$\u8868\u793a\u4ece$i$\u4e2a\u9700\u8981\u6309\u7684\u952e\u5230$i-1$\u4e2a\u9700\u8981\u6309\u7684\u952e\u7684\u671f\u671b\u64cd\u4f5c\u6b21\u6570\uff0c\u8fd9\u4e2a\u8f6c\u79fb\u65b9\u7a0b\u662f\u8fd9\u6837\u7684\uff1a\n$$f[i]=\\frac{i}{n}+\\frac{n-i}{n}\\times(f[i]+f[i+1]+1)$$\n\u8fd9\u4e2a\u7684\u610f\u601d\u5b9e\u9645\u4e0a\u662f\uff0c\u6709$\\frac{i}{n}$\u7684\u6982\u7387\u53ef\u4ee5\u6309\u5230\u6b63\u786e\u7684\u952e\u4f4d\uff0c\u6709\u53e6\u5916$\\frac{n-i}{n}$\u7684\u6982\u7387\u662f\u9519\u8bef\u7684\u4f4d\u7f6e\uff0c\u6240\u4ee5\u5728\u4e4b\u540e\u7684\u64cd\u4f5c\u4e2d\u9700\u8981\u5c06\u8fd9\u4e2a\u6309\u952e\u6309\u56de\u6765\uff0c\u6240\u4ee5\u5c31\u591a\u4e86\u4e00\u4e2a\u9700\u8981\u6309\u7684\u952e\uff0c\u6309\u56de\u6765$i$\u4e4b\u540e\u8fd8\u662f\u9700\u8981$f[i]$\u7684\u64cd\u4f5c\u6b21\u6570\u5230$i-1$\uff0c\u8fd9\u6837\u5c31\u89e3\u91ca\u5b8c\u4e86\u3002\u3002\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u4e0a\u9762\u90a3\u4e2a\u5f0f\u5b50\u7b80\u5316\u4e00\u4e0b\uff1a\n$$f[i]=\\frac{n+(n-i)\\times f[i+1]}{i}$$\n\u7136\u540e\u6c42\u51fa\u8fd9\u4e2a\u4e1c\u897f\u4e4b\u540e\uff0c\u6211\u4eec\u5148\u6bd4\u8f83\u4e00\u4e0b\u5fc5\u987b\u6309\u7684\u6309\u952e\u4e2a\u6570\uff08\u8bbe\u4e3a$cnt$\uff09\u548c$k$\uff0c\u5982\u679c\u8fd8\u8981\u5c0f\uff0c\u5c31\u80af\u5b9a\u662f\u524d\u8005\u4f5c\u4e3a\u7b54\u6848\u3002\u4e0d\u7136\u6211\u4eec\u5c31\u76f4\u63a5\u628a$f[cnt]+f[cnt-1]+....+f[k+1]$\u4f5c\u4e3a\u7b54\u6848\u5373\u53ef\uff0c\u5c31\u76f8\u5f53\u4e8e\u662f\u4ece$cnt$\u5230$k$\u7684\u671f\u671b\u64cd\u4f5c\u6b21\u6570\uff0c\u7136\u540e\uff0c**\u8bb0\u5f97\u8981\u52a0\u4e2a$k$!!!**\uff0c\u7136\u540e\u5c31\u4e58\u4e0a$n$\u7684\u9636\u4e58\u5373\u53ef\u3002\n\n\u4e0b\u9762\u662f\u4ee3\u7801\n```cpp\n// luogu-judger-enable-o2\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<cmath>\n#define maxn 100010\n#define mod 100003\nusing namespace std;\ntypedef long long ll;\nll read()\n{\n    ll x=0,f=1;\n    char ch=getchar();\n    while(ch-'0'<0||ch-'0'>9){if(ch=='-') f=-1;ch=getchar();}\n    while(ch-'0'>=0&&ch-'0'<=9){x=x*10+ch-'0';ch=getchar();}\n    return x*f;\n}\nint n,k;\nint a[maxn];\nint cnt=0;\nll f[maxn];\nll quick_pow(ll x,ll p)\n{\n    ll an=1;\n    ll po=x;\n    while(p)\n    {\n        if(p%2)  an=(an*po)%mod;\n        po=(po*po)%mod;\n        p/=2;   \n    }\n    return an;\n}\nint main()\n{\n    n=read();k=read();\n    for(int i=1;i<=n;i++)   a[i]=read();\n    for(int i=n;i>=1;i--)\n    {\n        if(a[i])\n        {\n            cnt++;\n            for(int j=1;j*j<=i;j++)\n            {\n                if(i%j==0)\n                {\n                    a[j]^=1;\n                    if(j*j!=i)  a[i/j]^=1;\n                }\n            }\n        }\n    }\n    f[n+1]=0;\n    for(int i=n;i>=1;i--)\n    {\n        ll tmp=(ll)(n-i)*f[i+1]%mod;\n        tmp=(tmp+(ll)n)%mod;\n        tmp=tmp*quick_pow(i,mod-2)%mod;\n        f[i]=tmp;\n    }\n    ll tmp=0;\n    if(cnt<=k)   tmp=cnt;\n    else{\n        for(int i=cnt;i>k;i--)  tmp=(tmp+f[i])%mod;\n        tmp=(tmp+k)%mod;\n    }\n    for(int i=1;i<=n;i++)  tmp=(tmp*(ll)i)%mod;\n    printf(\"%lld\\n\",tmp);\n    return 0;\n}\n```",
        "postTime": 1541077454,
        "uid": 46396,
        "name": "justin_cao",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3750 \u3010[\u516d\u7701\u8054\u80032017]\u5206\u624b\u662f\u795d\u613f\u3011"
    },
    {
        "content": "\u4e00\u9053\u4e0d\u9519\u7684\u6982\u7387\u9898\uff0c\"\u76f8\u9022\u662f\u95ee\u5019\"\u592a\u795e\u4e86,\u8003\u8bd5\u65f6\u6ca1\u6562\u55d1\u8fd9\u9898\u3002\n\n\n\u5148\u8003\u8651\u5173\u706f\u7684\u6700\u5c11\u6b21\u6570\uff0c\u4e00\u4e2a\u5f00\u5173\u6309\u4e24\u6b21\u548c\u6ca1\u6309\u4e00\u6837\uff0c\u4ece\u5927\u5230\u5c0f\u6709\u4eae\u7684\u5c31\u706d\u6389\uff0c\u5b83\u7684\u7ea6\u6570\u53ef\u4ee5$n*\\sqrt{n}$\u679a\u4e3e\uff0c\u66f4\u5feb\u7684\u505a\u6cd5\u662f\u679a\u4e3e\u7ea6\u6570i\uff0c\u627e\u5b83\u7684\u500d\u6570i,i\\*2,i\\*3...,\u590d\u6742\u5ea6$n/1+n/2+n/3+...=n*log(n)$,\u8fd9\u6837\u5c31\u670980\u5206\u4e86(\\*\uffe3\ufe36\uffe3)\n\n\n\u8003\u8651\u671f\u671b\uff0c\u8bbef[i]\u8868\u793a\u4ece\u6709i\u4e2a\u6b63\u786e\u9009\u62e9\u53d8\u4e3a\u6709i-1\u4e2a\u6b63\u786e\u9009\u62e9\u7684\u671f\u671b\u64cd\u4f5c\u6b21\u6570,$f[i]=\\dfrac{i}{n}+(1-\\dfrac{i}{n})*(1+f[i+1]+f[i])$\n\n(n\u4e2a\u5f00\u5173\uff0ci\u4e2a\u6b63\u786e\uff0c\u5176\u4ed6n-i\u4e2a\u4f1a\u589e\u52a0\u4e00\u4e2a\u9519\u8bef\uff0c\u9700f[n+1]+f[n]\u6b21\u64cd\u4f5c\u53d8\u5230i-1)\n\n\u79fb\u9879$ f[i]=1+\\dfrac{(1*n-i)*(f[i+1]+1)}{i}$,\n\nf[n] = 1,\u628af\u7d2f\u52a0\u4e00\u4e0b\u5c31\u53ef\u4ee5\u3002\n\n\u4e0d\u8981\u5fd8\u4e86\u4e58$n!$\n\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <vector>\n\nusing namespace std;\ntypedef long long LL;\n \ninline void read(int &x) {\n    static char c; bool flag = 0;\n    while((c=getchar())<'0'||c>'9') flag |= (c=='-');\n    x=c-'0';while((c=getchar())>='0'&&c<='9') x = x*10+c-'0';\n    flag?x=-x:x;\n}\n\ntypedef long long LL;\n\nconst int p = 100003;\nint n,k,b[101000];\nLL f[101000],inv[101000];\nvector<int> g[101000];\n\nvoid work() {\n    LL ans = 0,tp = 0;\n    for (int i = 1; i <= n; i++)\n     for (int j = i; j <= n; j += i)\n       g[j].push_back(i);         \n    for (int i = n; i >= 1; i--) \n     if (b[i]) {\n         for (int j = 0; j < g[i].size(); j++) b[g[i][j]] ^= 1; \n         tp++;\n     }\n    if (tp <= k) ans = tp; \n    else {\n       f[n] = 1;\n       for (int i = n-1; i > 1; i--) f[i] = (1LL+(1LL*n-i)*(f[i+1]+1)*inv[i])%p;\n       for (int i = tp; i > k; i--) ans = (ans+f[i])%p;\n       ans = (ans+k)%p; \n    }\n    for (int i = 1; i <= n; i++) ans = (ans*i)%p; \n    printf(\"%lld\",ans);\n}\n\nint main() {\n    read(n); read(k);\n    for (int i = 1; i <= n; i++) read(b[i]);\n    inv[1] = 1;\n    for (int i = 2; i <= n; i++) inv[i] = ((p-p/i)*inv[p%i])%p;\n    work();\n    return 0;\n}\n```\n",
        "postTime": 1508334274,
        "uid": 24701,
        "name": "wine",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3750 \u3010[\u516d\u7701\u8054\u80032017]\u5206\u624b\u662f\u795d\u613f\u3011"
    },
    {
        "content": "\u7565\u6709\u8ba2\u6b63\uff0c\u6c42\u7ba1\u7406\u5458\u901a\u8fc7\u3002\n\n---\n\n\u4e0d\u77e5\u9053\u4ec0\u4e48\u65f6\u5019\u8fc7\u7684\u9898\uff0c\u4eca\u5929\u770b\u5230\u6709\u540c\u5b66\u5728\u505a\uff0c\u89c9\u5f97\u6709\u5fc5\u8981\u5199\u4e00\u5199\u9898\u89e3\u3002\n\n[\u9898\u76ee](https://www.luogu.org/problem/P3750)\n\n\u9898\u610f\uff1a\u6709\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684 $01$ \u4e32\uff0c\u4e0b\u6807\u7f16\u53f7 $1$ \u5230 $n$\u3002\u5bf9\u4f4d\u7f6e $p$ \u64cd\u4f5c\u4e00\u6b21\u53ef\u4ee5\u4f7f\u6240\u6709\u7f16\u53f7\u4e3a $p$ \u7684\u7ea6\u6570\u7684\u4f4d\u7f6e $0$ \u53d8 $1$\uff0c$1$ \u53d8 $0$\u3002\u76ee\u6807\u662f\u4f7f\u6240\u6709\u4f4d\u7f6e\u53d8\u6210 $0$\u3002B \u541b\u5148\u968f\u673a\u64cd\u4f5c\u82e5\u5e72\u6b21\uff0c\u7b49\u5230\u5f53\u524d\u5c40\u9762\u53ef\u4ee5\u5728 $k$ \u6b21\u64cd\u4f5c\u4ee5\u5185\u8fbe\u6210\u76ee\u6807\u65f6\u5c31\u4f7f\u7528\u6700\u4f18\u7b56\u7565\uff0c\u8fbe\u6210\u76ee\u6807\u540e\u7ed3\u675f\u64cd\u4f5c\u3002\u6c42\u671f\u671b\u64cd\u4f5c\u6b21\u6570\u3002\n\n\u5bb9\u6613\u8bc1\u660e\uff0c\u4e00\u79cd\u6700\u4f18\u7684\u64cd\u4f5c\u7b56\u7565\u662f\u6bcf\u6b21\u64cd\u4f5c\u6700\u53f3\u8fb9\u7684\u4e3a $1$ \u7684\u4f4d\u7f6e\uff0c\u76f4\u5230\u8fbe\u6210\u76ee\u6807\u3002\u800c\u4e14\u64cd\u4f5c\u7684\u5148\u540e\u987a\u5e8f\u5e76\u4e0d\u91cd\u8981\u3002\n\n\u8bbe $f_i$ \u8868\u793a\u5f53\u524d\u6700\u4f18\u7b56\u7565\u9700\u8981 $i$ \u6b65\uff0c\u4ece\u5f53\u524d\u5c40\u9762\u8fbe\u5230\u76ee\u6807\u7684\u671f\u671b\u6b65\u6570\u3002\n\n\u5219\n\n$$\nf_i=\n\\begin{cases}\ni(i\\le k)\\\\\n\\frac{i}{n}f_{i-1}+\\frac{n-i}{n}f_{i+1}+1(i > k)\n\\end{cases}\n$$\n\n\u66b4\u529b\u9ad8\u65af\u6d88\u5143\u590d\u6742\u5ea6\u7206\u70b8\u3002\n\n\u8bbe $f_i=f_{i-1}+b_{i}$\uff0c\u90a3\u4e48\u6211\u4eec\u53d1\u73b0 $b_i$\u662f\u597d\u6c42\u7684\u3002\n\n$f_i=\\frac{i}{n}f_{i-1}+\\frac{n-i}{n}f_{i+1}+1$\n\n\u4ee3\u5165\u5f97 $f_i=\\frac{i}{n}(f_i-b_i)+\\frac{n-i}{n}(f_{i}+b_{i+1})+1$\n\n\u6574\u7406\u5f97\u5230 $b_i=\\frac{(n-i)b_{i+1}+n}{i}$\n\n\u8fb9\u754c\u6761\u4ef6 $b_n=1$\n\n\u505a\u5b8c\u4e86\u3002\n\n\u4ee5\u4e0b\u4ee3\u7801\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^{1.5})$\u3002\u5982\u679c\u4f7f\u7528\u4e00\u4e9b\u6570\u8bba\u6280\u5de7\u6765\u4f18\u5316\uff0c\u53ef\u4ee5\u505a\u5230 $O(n\\log n)$\u3002\n\n```cpp\n#include<cstdio>\nconst int N=1e5+1,M=1e5+3;\nint n,m,c,a[N],inv[M],f[N],b[N];\ninline int F(int n){return n?1ll*F(n-1)*n%M:1;}\nint main(){\n\tint t;\n\tinv[1]=1;\n\tfor(int i=2;i<M;i++)inv[i]=1ll*inv[M%i]*(M-M/i)%M;\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",a+i);\n\tfor(int i=n,j;i;i--)if(a[i]){\n\t  for(j=1;j*j<i;j++)\n\t\tif(i%j==0)a[j]^=1,a[i/j]^=1;\n\t  if(j*j==i)a[j]^=1;\n\t  c++;\n\t}\n\tif(m==n||m==n-1)return 0*printf(\"%lld\",1ll*F(n)*c%M);\n\tfor(int i=0;i<=m;i++)f[i]=i;\n\tb[n]=1;\n\tfor(int i=n-1;i>m;i--)\n\t  b[i]=(1ll*(n-i)*b[i+1]+n)%M*inv[i]%M;\n\tfor(int i=m+1;i<=n;i++)f[i]=(f[i-1]+b[i])%M;\n\treturn 0*printf(\"%lld\",1ll*F(n)*f[c]%M);\n}\n```",
        "postTime": 1578585313,
        "uid": 72487,
        "name": "Dreamunk",
        "ccfLevel": 9,
        "title": "\u516d\u7701\u8054\u80032017 \u5206\u624b\u662f\u795d\u613f"
    },
    {
        "content": "\u5bf9\u4e8e\u6bcf\u4e2a\u706f\u6765\u8bf4\uff0c\u64cd\u4f5c\u4e24\u6b21\u7684\u7ed3\u679c\u4e0e\u4e0d\u64cd\u4f5c\u76f8\u540c\u7684\n\n\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u521d\u59cb\u5c40\u9762\u9700\u8981\u7684\u64cd\u4f5c\u6b21\u6570\n\n\u7ea6\u6570\u7684\u8bdd\u76f4\u63a5$O(nlogn)$vector\u66b4\u529b\u6c42\n\n\u8fd9\u6837\u7684\u8bdd\u6700\u66b4\u529b\u7684\u60f3\u6cd5\u5c31\u662f\u4ece\u5927\u7684\u5411\u5c0f\u7684\u4f9d\u6b21\u679a\u4e3e\uff0c\u5b9e\u9645\u8fd9\u5c31\u662f\u6700\u4f18\u7b56\u7565\n\n\u7528$dp[i]$\u8868\u793a\u5bf9\u4e8e$n$\u76cf\u706f\uff0c\u4ece\u9700\u8981\u6309$i$\u6b21\u80fd\u5168\u90e8\u7184\u706d\u5230\u6309$i-1$\u6b21\u80fd\u5168\u90e8\u7184\u706d\u7684\u671f\u671b\n\n\u8003\u8651\u8fd9\u4e00\u6b21\u7684\u60c5\u51b5\n\n\u6709$\\frac{i}{n}$\u7684\u6982\u7387\u6309\u5230\u9700\u8981\u6309\u7684\u706f\uff0c\u6b64\u65f6\u7684\u671f\u671b\u4e3a$\\frac{i}{n}*1$\n\n\u6709$\\frac{n-i}{n}$\u7684\u6982\u7387\u6309\u5230\u4e0d\u9700\u8981\u6309\u7684\u706f\uff0c\u6b64\u65f6\u7684\u671f\u671b\u4e3a$\\frac{n-i}{n}*(dp[i]+dp[i+1]+1)$\n\n\u90a3\u4e48$dp[i]=\\frac{i}{n}+\\frac{n-i}{n}*(dp[i]+dp[i+1]+1)$\n\n\u5316\u7b80\u4e00\u4e0b\n\n$dp[i]=\\frac{n}{i}+\\frac{(n-i)dp[i+1]}{i}$\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u7ebf\u6027\u9012\u63a8\u4e86\n\n\u6ce8\u610f\u63a8\u7684\u65f6\u5019\u4ece$n$\u63a8\u5c31\u53ef\u4ee5\uff0c\u56e0\u4e3a\u6700\u4f18\u72b6\u6001\u4e0b\u9700\u8981\u7684\u64cd\u4f5c\u6b21\u6570\u4e00\u5b9a\u5c0f\u4e8e\u7b49\u4e8e$n$\n\n\u7b54\u6848\u4e3a$n!\\sum_{i=1}^{need}$\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<vector>\n#define int long long \nusing namespace std;\nconst int MAXN=1e6+10;\nconst int mod=100003;\n//#define getchar() (p1==p2&&(p2=(p1=buf)+fread(buf,1,MAXN,stdin),p1==p2)?EOF:*p1++)\n//int buf[1<<20],*p1=buf,*p2=buf;\ninline int read()\n{\n\tchar c=getchar();int x=0,f=1;\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n\treturn x*f;\n}\nint N,k;\nint a[MAXN];\nvector<int>Yue[MAXN];\nint need;\nint dp[MAXN],inv[MAXN];\nmain()\n{\n\t#ifdef WIN32\n\tfreopen(\"a.in\",\"r\",stdin);\n\t#endif\n\tN=read();k=read();\n\tinv[1]=1;\n\tfor(int i=2;i<=N;i++) inv[i] = ((-(mod/i)*inv[mod%i]%mod)+mod)%mod;\n\tfor(int i=1;i<=N;i++) a[i]=read();\n\tfor(int i=1;i<=N;i++)\n\t\tfor(int j=i;j<=N;j+=i)\n\t\t\tYue[j].push_back(i);\n\tfor(int i=N;i>=1;i--)\n\t\tif(a[i])\n\t\t{\n\t\t\tfor(int j=0;j<Yue[i].size();j++)\n\t\t\t\ta[Yue[i][j]]^=1;\n\t\t\tneed++;\n\t\t}\n\tdp[N]=1;\n\tfor(int i=N-1;i>k;i--) dp[i]=(N+(N-i)*dp[i+1])*inv[i]%mod;\n\tfor(int i=k;i>=1;i--) dp[i]=1;\n\tint ans=0;\n\tfor(int i=1;i<=need;i++) ans=(ans+dp[i])%mod;\n\tfor(int i=1;i<=N;i++) ans=(ans*i)%mod;\n\tprintf(\"%lld\",ans);\n\treturn 0;\n} \n```",
        "postTime": 1521549461,
        "uid": 36984,
        "name": "attack",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3750 \u3010[\u516d\u7701\u8054\u80032017]\u5206\u624b\u662f\u795d\u613f\u3011"
    },
    {
        "content": "\u5728Flandre\\_495\u7684\u9898\u89e3\u901a\u8fc7\u540e\u8fd9\u9898\u5e94\u8be5\u5c31\u5df2\u7ecf\u6709\u4e94\u7bc7\u9898\u89e3\u4e86\u3002\u6240\u4ee5\u6211\u4e5f\u4e0d\u592a\u60f3\u8bf4\u8fd9\u9898\u7684\u5177\u4f53\u601d\u8def\uff0c\u5176\u4ed6\u9898\u89e3\u8bf4\u7684\u5df2\u7ecf\u5f88\u660e\u767d\u4e86\u3002\n\n~~Flandre\\_495\u8bf4\u7684rainy\u5c31\u662f\u6211~~\n\n\u8fd9\u91cc\u6211\u4eec\u6765\u8003\u8651\u4e00\u4e9b\u6bd4\u8f83\u7279\u6b8a\u7684\u4e8b\u60c5\uff1a\n\n\u6211\u4eec\u5982\u4f55\u8bc1\u660e\u4e00\u4e2a\u5c40\u9762\u7684\u6700\u4f18\u89e3\u662f\u4ece\u540e\u5f80\u524d\u626b\u4e00\u904d\u80fd\u5173\u5c31\u5173\uff1f\n\n\u5b9e\u9645\u4e0a\u6211\u4eec\u53ea\u80fd\u77e5\u9053\u4ece\u540e\u5f80\u524d\u626b\u4e00\u904d\u5fc5\u7136\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u89e3\u6cd5\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u662f\u4e00\u4e2a\u53ef\u884c\u89e3\uff0c\u4f46\u6211\u4eec\u60f3\u8981\u8bc1\u660e\u5b83\u662f\u552f\u4e00\u89e3\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u4e00\u4e2a\u5408\u6cd5\u7684\u89e3\u6cd5\u662f\u4e00\u4e2a\u53ef\u91cd\u96c6\u5408$S$\uff0c\u5176\u5305\u542b\u7684\u6240\u6709\u6570\u5373\u4e3a\u6b64\u89e3\u6cd5\u9700\u8981\u6309\u4e0b\u7684\u6240\u6709\u6309\u94ae\u7684\u4f4d\u7f6e\uff0c\u4e5f\u5c31\u662f\u6240\u6709\u7684\u64cd\u4f5c\u3002\n\n\u4f8b\u5982\u5bf9\u4e8e$\\{1,0,1\\}$\uff0c\u6709$S=\\{3\\}$\u3002\n\n\u5b9a\u4e49\u4e3a\u53ef\u91cd\u96c6\u5408\u662f\u56e0\u4e3a$S=\\{1,1,3\\}$\u540c\u6837\u4e5f\u662f\u4e0a\u8ff0\u5c40\u9762\u7684\u4e00\u4e2a\u89e3\u3002\n\n\u6211\u4eec\u53d1\u73b0\u5b9e\u9645\u4e0a\u4e00\u4e2a\u64cd\u4f5c\u91cd\u590d\u4e24\u6b21\u5c31\u76f8\u5f53\u4e8e\u8fd9\u4e24\u6b21\u64cd\u4f5c\u6ca1\u6709\u8fdb\u884c\uff0c\u56e0\u4e3a\u5b83\u4f1a\u4f7f\u540c\u6837\u7684\u51e0\u4e2a\u4f4d\u7f6e\u4e0a\u7684\u6570$\\text{xor~1~xor~1}$,\u76f8\u5f53\u4e8e\u4e0d\u53d8\u3002\u6240\u4ee5\u6211\u4eec\u4e0d\u8ba4\u4e3a\u8fd9\u6837\u7684\u4e24\u4e2a\u89e3\u6cd5\u662f\u4e0d\u540c\u7684\u3002  \n\n\u8003\u8651\u4e00\u4e2a\u89e3\u6cd5\u7684\u5b9e\u8d28\uff0c\u5176\u4ee3\u8868\u4e86\u4e00\u4e2a$n$\u7ef4\u7684\u5411\u91cf\uff0c\u5176\u4e2d\u6bcf\u4e00\u7ef4\u90fd\u572801\u4e2d\u53d6\u503c\uff0c\u800c\u8fd9\u4e2a\u89e3\u6cd5\u5c31\u662f\u5c06\u539f\u5c40\u9762\u7684\u6bcf\u4e00\u4e2a\u6570\u5f02\u6216\u4e0a\u8fd9\u4e2a\u5411\u91cf\u4e2d\u7684\u5bf9\u5e94\u7ef4\u7684\u90a3\u4e2a\u6570\u3002\n\n\u5f88\u660e\u663e\u6211\u4eec\u53ef\u4ee5\u5bf9\u4efb\u4f55\u4e00\u4e2a\u89e3\u6cd5\u6784\u9020\u8fd9\u6837\u4e00\u4e2a\u5411\u91cf\uff0c\u5e76\u4e14\u6bcf\u4e00\u4e2a\u89e3\u6cd5\u80fd\u89e3\u51b3\u7684\u5c40\u9762\u662f\u552f\u4e00\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u77e5\u9053\u89e3\u6cd5\u7684\u96c6\u5408$A$\u548c\u5c40\u9762\u7684\u96c6\u5408$B$\u7684\u6709\u6620\u5c04$f:A\\to B$\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u60f3\u8bc1\u660e\u7684\u5176\u5b9e\u662f\u8fd9\u4e2a\u6620\u5c04\u662f\u5355\u5c04\u3002\n\n\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4efb\u4f55\u4e00\u4e2a\u89e3\u6cd5\u53ea\u80fd\u5bf9\u5e94\u4e00\u4e2a\u5c40\u9762\uff0c\u5e76\u4e14\u89e3\u6cd5\u7684\u6570\u91cf($2^n$)\u548c\u5c40\u9762\u7684\u6570\u91cf($2^n$)\u662f\u76f8\u540c\u7684\uff0c\u4e8e\u662f\u5982\u679c\u6211\u4eec\u80fd\u8bc1\u660e\u5176\u4e3a\u6ee1\u5c04\uff0c\u5c31\u80fd\u77e5\u9053\u5b83\u662f\u4e00\u4e2a\u5355\u5c04\u3002\n\n\u6211\u4eec\u5148\u5047\u8bbe\u5176\u4e3a\u6ee1\u5c04\uff0c\u8bc1\u660e\u5176\u4e3a\u5355\u5c04\u3002\u4f7f\u7528\u53cd\u8bc1\u6cd5\uff0c\u5047\u8bbe\u5176\u4e0d\u4e3a\u5355\u5c04\u3002\n\n\u90a3\u4e48\u5c31\u4e00\u5b9a\u5b58\u5728\u4e24\u4e2a\u4e0d\u540c\u7684\u89e3\u6cd5\u96c6\u5408\u5bf9\u5e94\u4e86\u540c\u4e00\u4e2a\u5c40\u9762\uff0c\u6b64\u65f6\u5fc5\u7136\u4f1a\u51fa\u73b0\u5c40\u9762\u6ca1\u6709\u88ab\u5bf9\u5e94\u5230\uff0c\u4e8e\u662f\u6b64\u65f6\u6620\u5c04\u4e0d\u662f\u4e00\u4e2a\u6ee1\u5c04\uff0c\u4e0e\u6761\u4ef6\u77db\u76fe\uff0c\u6240\u4ee5\u5176\u4e3a\u5355\u5c04\u3002\n\n\u4e4b\u540e\u6211\u4eec\u53d1\u73b0\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u5c40\u9762\uff0c\u6309\u7167\u5982\u4e0a\u6240\u8ff0\u7684\u6784\u9020\u65b9\u6cd5\u4e00\u5b9a\u80fd\u6784\u9020\u51fa\u4e00\u4e2a\u89e3\u6cd5\uff0c\u4e8e\u662f\u53ef\u4ee5\u77e5\u9053\u5176\u4e3a\u6ee1\u5c04\u3002\u4e8e\u662f\u5176\u4e3a\u5355\u5c04\u3002\uff08\u5f53\u7136\u5b83\u4e5f\u662f\u53cc\u5c04\uff09\n\n\u6362\u53e5\u8bdd\u800c\u8a00\uff0c\u5bf9\u4e8e\u4efb\u4f55\u4e00\u4e2a\u5c40\u9762\uff0c\u5176\u89e3\u6cd5\u662f\u552f\u4e00\u7684\uff0c\u800c\u6211\u4eec\u505a\u7684\u4efb\u4f55\u64cd\u4f5c\u90fd\u76f8\u5f53\u4e8e\u5411\u8fd9\u4e2a\u8fd9\u4e2a\u5c40\u9762\u7684\u89e3\u6cd5\u8ffd\u52a0\u4e86\u4e00\u4e2a\u64cd\u4f5c\u3002   \n\n\u800c\u89e3\u51b3\u4e00\u4e2a\u5c40\u9762\u7684\u552f\u4e00\u65b9\u6cd5\u5c31\u662f\u8fdb\u884c\u6570\u6b21\u8ffd\u52a0\u540e\u5c06\u8fd9\u4e2a\u96c6\u5408\u53d8\u4e3a\u7a7a\u96c6\uff0c\u8fd9\u57fa\u4e8e\u4e0a\u9762\u5bf9\u6620\u5c04\u4e3a\u5355\u5c04\u7684\u8bc1\u660e\u3002\n\n\u5982\u679c\u6211\u4eec\u8fdb\u884c\u7684\u64cd\u4f5c\u662f\u89e3\u6cd5\u4e2d\u7684\u67d0\u4e2a\u64cd\u4f5c\uff0c\u90a3\u4e48\u89e3\u6cd5\u4e2d\u7684\u8fd9\u4e2a\u64cd\u4f5c\u4f1a\u548c\u6211\u4eec\u8fdb\u884c\u7684\u8fd9\u4e2a\u64cd\u4f5c\u62b5\u6d88\uff0c\u4f7f\u5f97\u89e3\u6cd5\u7684\u96c6\u5408\u7684\u5927\u5c0f\u53d8\u4e3a$k-1$\uff0c\u6b64\u65f6\u5373\u4ee3\u8868\u6211\u4eec\u4ece\u9700\u8981$k$\u6b21\u64cd\u4f5c\u7684\u72b6\u6001\u8f6c\u79fb\u5230\u4e86\u9700\u8981$k-1$\u6b21\u64cd\u4f5c\u7684\u72b6\u6001\u3002\n\n\u5982\u679c\u6211\u4eec\u8fdb\u884c\u7684\u64cd\u4f5c\u4e0d\u5c5e\u4e8e\u8fd9\u4e2a\u89e3\u6cd5\u4e2d\u7684\u64cd\u4f5c\uff0c\u90a3\u4e48\u8fd9\u4e2a\u89e3\u6cd5\u5728\u6dfb\u52a0\u8fd9\u4e2a\u64cd\u4f5c\u540e\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a\u6709$k+1$\u4e2a\u5143\u7d20\u7684\u96c6\u5408\uff0c\u800c\u5b9e\u9645\u4e0a\u4e0a\u9762\u8fd9\u4e24\u4e2a\u60c5\u51b5\u90fd\u662f\u53ea\u548c\u5c40\u9762\u6240\u9700\u64cd\u4f5c\u6570\u6709\u5173\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u5c40\u9762\u6240\u9700\u64cd\u4f5c\u6570\u4f5c\u4e3a\u72b6\u6001\u8fdb\u884cdp\u800c\u4e0d\u5fc5\u5173\u5fc3\u5177\u4f53\u5c40\u9762\u3002",
        "postTime": 1570363264,
        "uid": 74020,
        "name": "Rainy_chen",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3750 \u3010[\u516d\u7701\u8054\u80032017]\u5206\u624b\u662f\u795d\u613f\u3011"
    },
    {
        "content": "**\u505a\u6cd5:\u6a21\u62df\u9ad8\u65af\u6d88\u5143**\n\n~~\u4e3a\u4ec0\u4e48\u6ca1\u51e0\u7bc7\u6a21\u62df\u9ad8\u65af\u6d88\u5143\u7684\u9898\u89e3\u554a\uff1f\u8fd9\u4e0d\u662f\u6700\u5bb9\u6613\u60f3\u5230\u7684\u5417\uff1f~~\n\n\u9996\u5148\u6839\u636e\u90e8\u5206\u5206\u63d0\u793a\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u60f3\u600e\u6837\u64cd\u4f5c\u6b21\u6570\u6700\u5c11\u3002\u6bd4\u8f83\u660e\u663e\u7684\u662f\uff0c**\u6211\u4eec\u6bcf\u6b21\u9009\u62e9\u6700\u540e\u4e00\u4e2a\u4eae\u7740\u7684\u706f\u662f\u6700\u4f18\u7684**\uff0c\u56e0\u4e3a\u9009\u62e9\u7b2c $i$ \u53f7\u706f\u80fd\u5f71\u54cd\u5230\u7684\u53ea\u6709\u5c0f\u4e8e\u7b49\u4e8e $i$ \u7684\u706f\uff0c\u800c\u4e0d\u5f71\u54cd\u540e\u9762\u7684\u706f\u3002\u56e0\u6b64\uff0c\u5982\u679c\u4e0d\u53bb\u64cd\u4f5c\u6700\u540e\u4e00\u4e2a\u4eae\u7740\u7684\u706f\u7684\u8bdd\uff0c\u4ee5\u540e\u53bb\u524d\u9762\u64cd\u4f5c\u4e0d\u4f1a\u518d\u8ba9\u5176\u706d\u6389\u3002\n\n\u4f9d\u7167\u8fd9\u79cd\u65b9\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u6700\u4f18\u7684\u64cd\u4f5c\u5e8f\u5217\uff0c\u5e76\u4e14\u53ef\u4ee5\u5bf9\u8fd9\u4e2a\u5e8f\u5217\u4ee5\u4efb\u610f\u987a\u5e8f\u8fdb\u884c\u64cd\u4f5c\u3002\n\n\u7136\u540e\u518d\u8003\u8651\u968f\u673a\u64cd\u4f5c\u3002\u6211\u4eec\u53d1\u73b0\u968f\u4fbf\u5bf9\u4e00\u4e2a\u706f\u8fdb\u884c\u64cd\u4f5c\uff0c\u8981\u4e48\u6070\u597d\u7b26\u5408\u6211\u4eec\u7684\u671f\u671b\uff0c\u63d0\u524d\u5e2e\u6211\u4eec\u641e\u5b9a\u4e00\u6b65\uff1b\u8981\u4e48\u64cd\u4f5c\u4e86\u5176\u5b83\u7684\u70b9\uff0c\u6211\u4eec\u7684\u6700\u5c11\u64cd\u4f5c\u6b21\u6570\u53c8\u591a\u4e86\u4e00\u3002\n\n\u6839\u636e\u5957\u8def\uff0c\u6211\u4eec\u8bbe $f[i]$ \u8868\u793a\u201c\u6700\u5c11\u9700\u8981 $i$ \u6b65\u201d\u7684\u72b6\u6001\uff0c\u5230\u7ed3\u675f\u7684\u671f\u671b\u6b21\u6570\uff0c\u5e76\u4e14\u6709\u5f0f\u5b50:\n\n$$f[t] = t, t <= k$$\n\n$$f[i] = 1 + \\frac{i}{n}f[i-1] + \\frac{n-i}{n}f[i+1],t>k$$\n\n\u53d1\u73b0\u65e0\u6cd5\u9012\u63a8\uff0c\u4e0d\u8fc7\u9ad8\u65af\u6d88\u5143\u8db3\u4ee5\u901a\u8fc7\u524d\u4e00\u534a\u7684\u6570\u636e\u3002\u6211\u4eec\u8003\u8651\u5bf9\u9ad8\u65af\u6d88\u5143\u8fdb\u884c\u4f18\u5316\u3002\u6211\u4eec\u53d1\u73b0\u77e9\u9635\u5927\u6982\u957f\u8fd9\u4e2a\u6837\u5b50\uff1a\n\n$$\\begin{bmatrix}\n 1 &  &  &  &  &  &  &  &  &  & 1\\\\\n  & 1 &  &  &  &  &  &  &  &  & 2\\\\\n  &  & ... &  &  &  &  &  &  &  & \\\\\n  &  &  & 1 &  &  &  &  &  &  & k\\\\\n  &  &  & -\\frac{k+1}{n}  & 1 & -\\frac{n-k-1}{n}  &  &  &  &  & 1\\\\\n  &  &  &  & -\\frac{k+2}{n} & 1 & -\\frac{n-k-2}{n} &  &  &  & 1\\\\\n  &  &  &  &  & -\\frac{k+3}{n} & 1 & -\\frac{n-k-3}{n} &  &  & 1\\\\\n  &  &  &  &  &  & ... & ... & ... &  & \\\\\n  &  &  &  &  &  &  & -\\frac{n-1}{n}  & 1 & -\\frac{1}{n}  & 1\\\\\n  &  &  &  &  &  &  &  & -\\frac{n}{n}  & 1 &1\n\\end{bmatrix}$$\n\n\u53ea\u6709\u4e00\u6761\u5bf9\u89d2\u7ebf\uff0c\u81ea\u7136\u53ef\u4ee5 $O(n)$ \u9ad8\u65af\u6d88\u5143\u6c42\uff08\u907f\u8fc7\u90a3\u4e9b\u90a3\u96f6\u51cf\u6765\u51cf\u53bb\u7684\u6b65\u9aa4\u5c31\u597d)\u3002\u4e0d\u8fc7\u7a7a\u95f4\u5f00\u4e0d\u4e0b $n^2$ \u6570\u7ec4\uff0c\u9700\u8981\u624b\u52a8\u6a21\u62df\uff08\u8be6\u89c1\u4ee3\u7801\uff09\u3002\n\n\u590d\u6742\u5ea6\uff1a$O(nlogn)$\uff08\u74f6\u9888\u5728\u6c42\u9006\u5143\uff09\n\n\u4e0d\u8fc7\uff0c\u8fd9\u9898\u6bd4\u8f83\u6076\u5fc3\u7684\u4e00\u70b9\u662f\uff0c\u6a21\u6570\u53ea\u6709 $1e5$ \u5927\u5c0f\uff0c\u5f88\u5bb9\u6613\u52a0\u52a0\u51cf\u51cf\u51fa\u73b0 $0$\uff0c\u4f7f\u5f97\u6211\u4eec\u65e0\u6cd5\u6c42\u9006\u5143\uff0c\u8fd9\u65f6\u9700\u8981\u4ea4\u6362\u76f8\u90bb\u4e24\u884c\uff0c\u5bf9\u5176\u8fdb\u884c\u7279\u6b8a\u5904\u7406\uff08\u8be6\u89c1\u4ee3\u7801\uff09\u3002\u5982\u679c\u6a21\u6570\u5f00\u5230 $1e9$ \u90a3\u4e48\u5927\u5c31\u57fa\u672c\u6ca1\u6709\u8fd9\u4e2a\u95ee\u9898\u4e86\u3002\n\n$Code:$\n\n```cpp\n#define N 101000\ntypedef long long ll;\ntemplate <typename T> inline void read(T &x) {\n\tx = 0; char c = getchar(); bool flag = false;\n\twhile (!isdigit(c)) { if (c == '-')\tflag = true; c = getchar(); }\n\twhile (isdigit(c)) { x = (x << 1) + (x << 3) + (c ^ 48); c = getchar(); }\n\tif (flag)\tx = -x;\n}\nusing namespace std;\nconst int P = 100003;\ninline ll quickpow(ll x, int k) {\n\tll res = 1;\n\twhile (k) {\n\t\tif (k & 1)\tres = res * x % P;\n\t\tx = x * x % P;\n\t\tk >>= 1;\n\t}\n\treturn res;\n}\nint n, K;\nint state[N];\nll f[N], h[N][4];\nbool tag[N];\ninline void work() {\n\tfor (register int i = 1; i <= K; ++i)\tf[i] = i;\n\th[K][1] = 1, h[K][3] = K;\n\tfor (register int i = K + 1; i <= n; ++i) {\n\t\th[i][0] = -i, h[i][1] = n, h[i][2] = i - n, h[i][3] = n;\n\t}\n\tfor (register int i = K + 1; i <= n; ++i) {\n\t\tll t = h[i][0];\n\t\th[i][0] = 0; h[i][1] = (h[i][1] - t * h[i - 1][2]) % P;\n\t\th[i][3] = (h[i][3] - t * h[i - 1][3]) % P;\n\t\t\n\t\tif (h[i][1]) {\n\t\t\tt = quickpow(h[i][1], P - 2);\n\t\t\th[i][2] = h[i][2] * t % P; h[i][3] = h[i][3] * t % P;\n\t\t\th[i][1] = 1;\n\t\t} else {//\u4e0d\u5b58\u5728\u9006\u5143\n\t\t\tt = quickpow(h[i][2], P - 2);\n\t\t\th[i][2] = 1, h[i][3] = h[i][3] * t % P;\n\t\t\tt = h[i + 1][1];\n\t\t\th[i + 1][1] = 0, h[i + 1][3] = (h[i + 1][3] - t * h[i][3]) % P;//\u6d88\u53bb\u4e0b\u9762\u4e00\u884c\u7684\u4e2d\u95f4\u7684\u90a3\u4e2a\u6570\n\t\t\ttag[i + 1] = true;\n\t\t\tswap(h[i][2], h[i][1]);//\u201c\u504f\u79fb\u201d\u6570\u7ec4\n\t\t\tswap(h[i], h[i + 1]);//\u4ea4\u6362\u4e24\u884c\n\t\t}\n\t}\n\tfor (register int i = n - 1; i > K; --i) {\n\t\tif (!tag[i]) {\n\t\t\tll t = h[i][2];\n\t\t\th[i][2] = 0; h[i][3] = (h[i][3] - t * h[i + 1][3]) % P;\n\t\t} else {//\u5bf9\u65e0\u9006\u5143\u60c5\u51b5\u7684\u7279\u6b8a\u5904\u7406\n\t\t\tll t = h[i - 1][2];\n\t\t\th[i - 1][2] = 0, h[i - 1][3] = (h[i - 1][3] - t * h[i + 1][3]) % P;\n\t\t\tt = quickpow(h[i - 1][0], P - 2);\n\t\t\th[i - 1][3] = h[i - 1][3] * t % P;\n\t\t\tswap(h[i - 1][1], h[i - 1][0]);\n\t\t\t--i;\n\t\t}\n\t}\n\tfor (register int i = K + 1; i <= n; ++i)\tf[i] = h[i][3];\n}\n\n\nvector<int> vec[N];\ninline void get_ans() {\n\tfor (register int i = 1; i <= n; ++i)\n\t\tfor (register int j = i; j <= n; j += i)\n\t\t\tvec[j].push_back(i);//\u8ba1\u7b97\u64cd\u4f5c\u5e8f\u5217\n\tint nw = 0;\n\tfor (register int i = n; i; --i) {\n\t\tif (state[i]) {\n\t\t\tfor (register unsigned int j = 0; j < vec[i].size(); ++j) {\n\t\t\t\tstate[vec[i][j]] ^= 1;//\u8ba1\u7b97\u72b6\u6001\u7684\u6700\u5c11\u64cd\u4f5c\u6b21\u6570\n\t\t\t}\n\t\t\t++nw;\n\t\t}\n\t}\n\tll res = 1;\n\tfor (register int i = 1; i <= n; ++i)\tres = res * i % P;\n\tprintf(\"%lld\\n\", ((res * f[nw] % P) + P) % P);\n}\n\nint main() {\n\tread(n), read(K);\n\tfor (register int i = 1; i <= n; ++i)\tread(state[i]);\n\twork();\n\tget_ans();\n\treturn 0;\n}\n```",
        "postTime": 1595598099,
        "uid": 221897,
        "name": "jiazhaopeng",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3750 \u3010[\u516d\u7701\u8054\u80032017]\u5206\u624b\u662f\u795d\u613f\u3011"
    },
    {
        "content": "\n# 50\u5206\u90e8\u5206\u5206\u5165\u624b\n\n~~\u5176\u5b9e\u670980\u5206~~\n\n\u9996\u5148\u8003\u8651$k=n$\u7684\u90e8\u5206\u5206\n\n- \u5012\u7740\u626b\uff0c\u9047\u5230\u6709$1$\u7684\u4f4d\u7f6e\u5c31\u64cd\u4f5c\u4e00\u4e0b\n\n\u6b63\u786e\u6027\uff1a\n\n- \u4e00\u4e2a\u70b9\u4e0d\u4f1a\u88ab\u64cd\u4f5c$2$\u6b21\u4ee5\u4e0a\uff0c\u56e0\u4e3a$2$\u6b21\u64cd\u4f5c\u76f8\u5f53\u4e8e\u6ca1\u64cd\u4f5c\n\n- \u64cd\u4f5c$i$\u4e0d\u4f1a\u5f71\u54cd\u5230\u6bd4$i$\u5927\u7684\u6570\n- \u6240\u4ee5\u4ece\u540e\u5f80\u524d\u626b\uff0c\u82e5\u9047\u5230$1$\u4e0d\u64cd\u4f5c\uff0c\u90a3\u4e48\u524d\u9762\u7684\u64cd\u4f5c\u4e5f\u4e0d\u4f1a\u6539\u53d8\u8fd9\u4e2a$1$\uff0c\u6240\u4ee5\u5fc5\u987b\u64cd\u4f5c\n\n# \u6b63\u89e3\n\n\u9996\u5148\u82e5\u6700\u5c0f\u6b65\u6570\u5c0f\u4e8e\u7b49\u4e8e$k$\uff0c\u76f4\u63a5\u8f93\u51fa$ans\\cdot n!$\u5c31\u597d\u4e86\n\n\u95ee\u9898\u5728\u4e8e\u6700\u5c0f\u6b65\u6570\u5927\u4e8e$k$\u7684\u60c5\u51b5\n\n\u5bb9\u6613\u53d1\u73b0\u4e0a\u9762\u90a3\u4e2a\u64cd\u4f5c\u5e8f\u5217\u662f\u56fa\u5b9a\u7684\n\n\u7528\u4e00\u4e2a$01$\u5e8f\u5217\u8868\u793a\u6bcf\u4e2a\u70b9\u9700\u4e0d\u9700\u8981\u64cd\u4f5c\uff08\u4f8b\u5b50\uff1a$101100$\u8868\u793a$1,3,4$\u9700\u8981\u88ab\u64cd\u4f5c\uff09\n\n\u7136\u540e\u5bb9\u6613\u53d1\u73b0\u6700\u4f18\u7684\u64cd\u4f5c\u6b21\u6570\u5373\u4e3a\u8fd9\u4e2a\u5e8f\u5217\u4e2d$1$\u7684\u4e2a\u6570\uff0c\u4e5f\u5c31\u662f\u8bf4\u548c\u5e8f\u5217\u957f\u4ec0\u4e48\u6837\u5b50\u65e0\u5173\uff0c\u53ea\u5173\u5fc3\u6709\u591a\u5c11\u4e2a$1$\n\n\u6240\u4ee5\u8003\u8651\u8bbe$f[i]$\u8868\u793a\u5e8f\u5217\u4e2d\u6709$i$\u4e2a$1$\u7684\u671f\u671b\u64cd\u4f5c\u6b21\u6570\n\n- \u5982\u679c\u4e71\u9009\u9009\u5230\u4e86$0$\uff0c$1$\u7684\u4e2a\u6570\u4f1a\u591a\u4e00\u4e2a\n- \u5982\u679c\u4e71\u9009\u9009\u5230\u4e86$1$\uff0c$1$\u7684\u4e2a\u6570\u4f1a\u5c11\u4e00\u4e2a\n- \u6240\u4ee5\u6709\uff1a$f[i]=\\frac inf[i-1]+\\frac{n-i}nf[i+1]+1$\n\n\u7136\u540e\u662f\u7384\u5b66\u63a8\u5f0f\u5b50\n\n- \u6ce8\u610f\u5230$f[n]=f[n-1]+1$\uff0c\u6211\u4eec\u628a\u5b83\u4f5c\u4e3a\u8fb9\u754c\u6761\u4ef6\n- $f[n-1]=\\frac{n-1}n f[n-2]+\\frac1n f[n]+1$\n- \u5c06\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u5e26\u5165\n- $f[n-1]=\\frac{n-1}n f[n-2]+\\frac1n f[n-1]+\\frac{n+1}n$\n- \u79fb\u9879\u540e\u5904\u7406\u4e00\u4e0b\u7cfb\u6570\u5f97\u5230\uff1a\n- $f[n-1]=f[n-2]+\\frac{n+1}{n-1}$\n\n\u53d1\u73b0\u8fd9\u4e2a\u4e1c\u897f\u957f\u6210\u8fd9\u4e2a\u6837\u5b50$f[n]=f[n-1]+$\u5e38\u6570\uff0c$f[n-1]=f[n-2]$+\u5e38\u6570\n\n\u7136\u540e\u5927\u80c6\u731c\u60f3~~\u4e0d\u9700\u8981\u6c42\u8bc1~~\uff0c\u52a0\u7684\u8fd9\u4e2a\u5e38\u6570(\u8bbe\u4e3a$g[i]$)\u53ef\u4ee5\u9012\u63a8\u51fa\u6765\n\n- $f[i-1]=\\frac{i-1}n f[i-2]+\\frac{n-i+1}n f[i]+1$\n- \u56e0\u4e3a\u6211\u4eec\u731c\u60f3$f[i]=f[i-1]+g[i]$\uff0c\u5c06\u5b83\u5e26\u5165\n- $f[i-1]=\\frac{i-1}n f[i-2]+\\frac{n-i+1}n f[i-1]+\\frac{n-i+1}ng[i]+1$\n- \u79fb\u9879\u540e\u5904\u7406\u4e00\u4e0b\u7cfb\u6570\uff1a\n- $f[i-1]=f[i-2]+\\frac{n-i+1}{i-1}g[i]+\\frac n{i-1}$\n- \u6240\u4ee5\u6709\uff1a$g[i-1]=\\frac{(n-i+1)g[i]+n}{i-1}$\n- \u6362\u4e2a\u6837\u5b50\uff1a$g[i]=\\frac{(n-i)g[i+1]+n}i$\n\n\u7136\u540e$g[i]$\u5c31\u53ef\u4ee5\u5012\u7740\u9012\u63a8\u51fa\u6765\u4e86\n\n\u63a5\u7740$f[i]$\u4e5f\u53ef\u4ee5\u6b63\u7740\u9012\u63a8\u51fa\u6765\n# dp\u5f0f\u5b50\u603b\u7ed3\n\n\n- $f[k]=k$\n- $f[i]=f[i-1]+g[i]$\n- $g[n]=1$\n- $g[i]=\\frac{(n-i)g[i+1]+n}i$\n- $ans=f[min\\_step]\\cdot n!$\uff08$min\\_step$\u6307\u7684\u662f\u539f\u5e8f\u5217\u6700\u5c0f\u64cd\u4f5c\u6b21\u6570\uff09\n\n",
        "postTime": 1588752220,
        "uid": 56825,
        "name": "oisdoaiu",
        "ccfLevel": 9,
        "title": "\u3010SHOI2017\u3011\u5206\u624b\u662f\u795d\u613f\u9898\u89e3(dp\u6bd2\u7624)"
    },
    {
        "content": "\u6211\u5f88\u5c11\u505a\u6982\u7387\u671f\u671b\u9898\uff0c\u8fd9\u9898\u662f\u67d0Rainy\u5927\u4f6c\u63a8\u8350\u8fc7\u6765\u7684\u3002\u3002\n\n\u6211\u671f\u671b\u83dc\u7684\u4e00pi\u554a\uff0c\u786e\u5b9e\u662f\u4e00\u9053\u4e0d\u9519\u7684\u671f\u671b\u9898\uff0c\u6240\u4ee5A\u6389\u4e4b\u540e\u5199\u7bc7\u9898\u89e3\u7eaa\u5ff5\u4e00\u4e0b\n\n\n\u8868\u793a\u505a\u5b8c\u9898\u624d\u77e5\u9053\u4e3a\u5565\u7b54\u6848\u4e58\u4e0a$n!$\u662f\u6574\u6570\u3002\u3002\u3002\u56e0\u4e3a\u671f\u671b\u8f6c\u79fb\u7684\u5206\u6bcd\u90fd\u662f1~n\u7684\u6570\u3002\n\n____________\n\n#### \u6211\u63a8dp\u7684\u65b9\u5f0f\u4e0e\u5176\u4ed6\u9898\u89e3\u90fd\u4e0d\u76f8\u540c\uff0c\u4f46\u5f0f\u5b50\u6700\u540e\u662f\u4e00\u6837\u7684\uff0c~~\u4f46\u6211\u89c9\u5f97\u6211\u7684\u601d\u8def\u66f4\u597d\u61c2\u3002\u3002\u3002~~\n\n\u8fd9\u9898\u4e00\u5f00\u59cb\u4e00\u70b9\u601d\u8def\u90fd\u6ca1\u6709\uff0c\u7136\u540e\u542c\u4e86\u673a\u623f\u67d0Rainy\u5927\u4f6c\u7684\u8bb2\u89e3\uff0c\u4eff\u4f5b~~\u611f\u609f\u4e86\u4eba\u751f~~\u3002\n\n50\u5206\uff1a\u6b63\u89e3\u603b\u662f\u4ece\u90e8\u5206\u5206\u6765\u7684\u561b\uff0c\u800c\u8fd950\u5206\u7684\u6570\u636e$k=n,$ \u663e\u7136\u662f\u60f3\u8ba9\u4f60\u660e\u767d\u6700\u4f18\u89e3\u600e\u4e48\u6765\u7684\u4e86~\uff0c\u7a0d\u5fae\u60f3\u4e00\u60f3\uff0c\u53d1\u73b0\u8d2a\u5fc3\u53ef\u884c\uff0c\u56e0\u4e3a\u4eae\u7740\u6700\u5927\u7f16\u53f7\u7684\u706f\uff0c\u80af\u5b9a\u5f97\u7528\u5b83\u81ea\u5df1\u7684\u5f00\u5173\u706d\u6389\uff0c\u7528\u66f4\u5927\u7684\u5c31\u4f1a\u6709\u65b0\u7684\u706f\u4eae\u4e86\u3002\u6240\u4ee5\u4ecen\u626b\u52301\uff0c\u54ea\u4e2a\u706f\u4eae\u7740\u5c31\u52a8\u54ea\u4e2a\u5f00\u5173\uff0c\u7b97\u51fa\u6765\u73b0\u5728\u6700\u5c11\u9700\u8981\u7684\u6b21\u6570\u3002\n\n100\u5206\uff1a\u5728\u6700\u5c11\u6b65\u6570\u5927\u4e8ek\u65f6\uff0c\u6211\u4eec\u968f\u673a\u5f00\u5173\uff0c\u5230\u4e86k\uff0c\u5c31\u76f4\u63a5+k\u5373\u4e3a\u7b54\u6848\uff0c\u6211\u4eec\u53d1\u73b0\u5982\u679c\u968f\u673a\u7740\u6765\u7684\u8bdd\uff0c\u6211\u4eec\u6ca1\u5fc5\u8981\u77e5\u9053\u72b6\u6001\u5982\u4f55\uff0c\u6211\u4eec\u53ea\u9700\u8981\u77e5\u9053\u6b64\u72b6\u6001\u6700\u5c11\u9700\u8981\u51e0\u6b65\u3002\n\n\u5f53\u6211\u4eec\u968f\u673a\u5f00\u4e00\u4e2a\u5f00\u5173\u6ca1\u6709\u9009\u4e2d\u6b63\u786e\u7684\u5f00\u5173\u65f6\uff0c\u6211\u4eec\u7684\u6700\u5c11\u6b65\u6570\u53c8\u9700\u8981\u591a\u4e00\u6b65\u3002\u800c\u6211\u4eec\u5982\u679c\u9009\u5bf9\u5176\u4e2d\u4e4b\u4e00\uff0c\u6211\u4eec\u7684\u6700\u5c11\u6b65\u6570\u80af\u5b9a\u8981\u5c11\u4e00\u6b65\uff0c\u6240\u4ee5\u6211\u4eec\u4ee4$f[i]$\u8868\u793a\u4ece\u6700\u5c11\u9700\u8981$i$\u4e2a\u5f00\u5173\u7684\u72b6\u6001\uff0c\u968f\u673a\u5230\u6700\u5c11$i-1$\u4e2a\u5f00\u5173\u7684\u72b6\u6001\u65f6\u671f\u671b\u7684\u64cd\u4f5c\u6b21\u6570\u3002\n\n\u65e2\u7136\u6211\u4eec\u81f3\u5c11\u9700\u8981$i$\u4e2a\u5f00\u5173\uff0c\u90a3\u4e48\u8fd9$i$\u4e2a\u5f00\u5173\u5f88\u663e\u7136\u987a\u5e8f\u968f\u610f\uff0c\u800c\u4e14\u4e0d\u91cd\u590d\uff0c\u6240\u4ee5\u6211\u4eec\u968f\u673a\u4e00\u6b21\u6709$\\frac{i}n$\u7684\u6982\u7387\u9009\u5bf9$i$\u4e2a\u5f00\u5173\u4e4b\u4e00\uff0c\u5373\u76f4\u63a5\u8df3\u8f6c\u5230\u4e0b\u4e00\u6b65$i-1$\u3002\n\n\u4f46\u6211\u4eec\u80af\u5b9a\u4f1a\u9009\u9519\u5bf9\u5427~\n\n\n\u6211\u4eec\u628a\u5b83\u671f\u671b\u8d70\u9519\u7684\u6b65\u6570\u7b97\u597d\uff0c\u518d\u52a01\uff0c\u5c31\u662f\u8d70\u5230$i-1$\u7684\u671f\u671b\u6b65\u6570\u3002\u90a3\u4e48\u5b83\u671f\u671b\u8d70\u9519\u4e00\u6b21\uff0c\u8981\u52a0\u4e0a\u5f80\u56de\u8d70\u76841\u6b65\uff0c\u518d\u52a0\u4e0a\u4ece$i+1$\u56de\u5230$i$\u7684\u671f\u671b\u6b21\u6570\uff0c\u5373$f[i+1]$\u3002\u6211\u4eec\u671f\u671b\u8d70$\\frac{n}i$\u6b21\u5230\u4e0b\u4e00\u5c42\uff0c\u90a3\u6211\u4eec\u5c31\u671f\u671b\u8d70\u9519$\\frac{n}i-1 = \\frac{n-i}i$\u6b21\u3002\n\n\u4e8e\u662f\u6211\u4eec\u6709\u4e86\u65b9\u7a0b\uff1a $f[i] = \\frac{n-i}i(f[i+1]+1) + 1$\u3002\n\n\u6700\u540e\u7edf\u8ba1\u7b54\u6848\u5373\u4e3a\u4ece $f[$\u539f\u59cb\u72b6\u6001\u7684\u6700\u5c11\u6b65\u6570$]$ \u52a0\u5230$f[k]$\uff0c\u7136\u540e\u8bb0\u5f97$+k$,\u6700\u540e\u8bb0\u5f97$*n!$\u3002\u641e\u5b9a\uff01\n\ncode\uff1a\n```cpp\n#include<algorithm>\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<cmath>\n#define QWQ cout<<\"QwQ\"<<endl;\n#define ll long long \n#include<vector>\n#include<queue>\n#include<stack>\n#include<map>\nusing namespace std;\nconst ll N=101010;\nconst ll qwq=303030;\nconst ll inf=0x3f3f3f3f;\nconst ll mp=100003;\nll n;\nll a[N];\nll k;\nll now;\nll ans;\nll f[N],inv[N];\n\ninline ll read() {\n\tll sum = 0, ff = 1; char c = getchar();\n\twhile(c<'0' || c>'9') { if(c=='-') ff = -1; c = getchar(); }\n\twhile(c>='0'&&c<='9') { sum = sum * 10 + c - '0'; c = getchar(); }\n\treturn sum * ff;\n}\n\nint main() {\n\tn = read(); k = read();\n\tfor(ll i=1;i<=n;i++) a[i] = read();\n\tinv[1] = 1; for(ll i=2;i<=n;i++) inv[i]=( (mp-mp/i) * inv[mp%i] )%mp;\n\tfor(ll i=n;i>=1;i--) {\n\t\tif(!a[i]) continue; now++;\n\t\tfor(ll j=1;j<=sqrt(i);j++) {\n\t\t\tif(i%j==0) {\n\t\t\t\ta[j] ^= 1;\n\t\t\t\tif(i/j!=j)\n\t\t\t\ta[i/j] ^= 1;\n\t\t\t}\n\t\t}\n\t}\n\tf[n] = 1;\n\tfor(ll i=n-1;i>k;i--)\n\tf[i] = (n-i) * (f[i+1]+1) %mp * inv[i] %mp + 1;\n\tfor(ll i=k+1;i<=now;i++) ans = (ans+f[i]) % mp;\n\tfor(ll i=n-1;i>=1;i--) n = (n*i) % mp;\n\tprintf(\"%lld\",(ans+min(k,now))*n%mp);\n\treturn 0;\n}\n\n\n```\n",
        "postTime": 1570357251,
        "uid": 102726,
        "name": "Flandre_495",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3750 \u3010[\u516d\u7701\u8054\u80032017]\u5206\u624b\u662f\u795d\u613f\u3011"
    },
    {
        "content": "### \u9996\u5148\u8003\u8651\u6700\u4f18\u7b56\u7565\u600e\u4e48\u505a\uff1a\n\n- \u4ece\u5927\u5f80\u5c0f\u8d2a\u5fc3\u663e\u7136\u662f\u6b63\u786e\u7684\uff0c\u56e0\u4e3a\u6700\u5927\u7684\u6570\u4e0d\u4f1a\u88ab\u5c0f\u6570\u5f71\u54cd\uff0c\u6240\u4ee5\u5148\u6d88\u9664\u6700\u5927\u7684\uff0c\u518d\u4f9d\u6b21\u5f80\u5c0f\u7684\u6d88\u9664\u3002\n- \u73b0\u5728\u7684\u95ee\u9898\u5c31\u5728\u4e8e\u5feb\u901f\u679a\u4e3e\u4e00\u4e2a\u6570\u7684\u7ea6\u6570\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u5148\u679a\u4e3e\u4e00\u4e2a\u6570\u7684\u500d\u6570\uff0c\u7136\u540e\u52a0\u5728\u5bf9\u5e94\u6570\u7684$vector$\u91cc\u9762\uff0c\u6700\u540e\u53ea\u8981\u67e5\u627e\u5c31\u53ef\u4ee5\u4e86\u3002\n- \u8fd9\u4e2a\u590d\u6742\u5ea6\u662f\u8c03\u548c\u7ea7\u6570\uff0c\u4e3a$nlogn$\u3002\n\n### \u8003\u8651\u968f\u673a\u600e\u4e48\u505a\u3002\n- \u6211\u4eec\u53d1\u73b0\u5f53\u524d\u5c40\u9762\u662f\u4ec0\u4e48\u5bf9\u968f\u673a\u90fd\u662f\u6ca1\u6709\u5f71\u54cd\u7684\uff0c\u5c31\u662f\u4e0d\u7ba1\u4f60\u8fd9\u4e2a\u5c40\u9762\u662f\u4ec0\u4e48\u6837\uff0c\u5982\u679c\u4ed6\u7684\u6700\u4f18\u7b56\u7565\u662f$n$\u6b65\uff0c\u90a3\u4e48\u4ed6\u5c31\u548c\u5176\u4ed6$n$\u6b65\u7684\u5c40\u9762\u6ca1\u6709\u533a\u522b\u3002\n- \u56e0\u4e3a\u64cd\u4f5c\u7684\u7b56\u7565\u662f\u552f\u4e00\u786e\u5b9a\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u9700\u8981\u8003\u8651\u5c40\u9762\u7a76\u7adf\u662f\u4ec0\u4e48\u6837\u5b50\uff0c\u53ea\u9700\u8981\u77e5\u9053\u8fd9\u4e2a\u5c40\u9762\u7684\u6b65\u6570\u5c31\u884c\u4e86\u3002\n- \u8bbe$f_i$\u8868\u793a\u5230\u7b2c$i$\u6b65\uff0c\u8f6c\u79fb\u5230$i-1$\u6b65\u7684\u671f\u671b\u6b65\u6570\u662f\u591a\u5c11\uff0c\u6709:\n#### $$f_i=1+\\frac {n-i}{n}*(f_{i+1}+f_i)$$\n- \u5982\u679c\u64cd\u4f5c\u5728\u6700\u4f18\u7684$i$\u6b65\u4e2d\uff0c\u5c31\u53ef\u4ee5\u4e86\uff0c\u5426\u5219\u8fd8\u8981\u56de\u5230\u8fd9\u4e00\u6b65\uff0c\u518d\u8d70\u5230\u4e0a\u4e00\u6b65\u3002\n- \u56e0\u4e3a\u64cd\u4f5c\u987a\u5e8f\u662f\u4e0d\u5f71\u54cd\u7b54\u6848\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8ba4\u4e3a\u53ea\u8981\u5728\u8fd9$i$\u6b65\u91cc\u9762\uff0c\u90fd\u662f\u6ee1\u8db3\u8981\u6c42\u7684\u6b65\u9aa4\uff0c\u5426\u5219\u5c31\u662f\u4e0d\u5408\u6cd5\u7684\u6b65\u9aa4\u3002\n- \u5316\u7b80\u4e00\u4e0b\n#### $$f_i=(n+(n-i)*f_{i+1})*inv(i)$$\n- \u7ebf\u6027\u6c42\u9006\u5143\u540e\u9012\u63a8\u5373\u53ef\uff0c\u6ce8\u610f$f_n=1$\u3002",
        "postTime": 1538625602,
        "uid": 66915,
        "name": "Tyher",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3750 \u3010[\u516d\u7701\u8054\u80032017]\u5206\u624b\u662f\u795d\u613f\u3011"
    },
    {
        "content": "sb \u9009\u624b\u7684sb\u505a\u6cd5\n\n\u770b\u5230\u9898\n\n\u6211\u4eec\u628a\u6bcf\u4e2a\u683c\u5b50\u770b\u6210\u5411\u91cf\uff0c\u7ea6\u6570\u7684\u5bf9\u5e94\u4f4d\u6570\u662f1\uff0cn\u4e2a\u53d8\u91cfn\u4e2a\u5f02\u6216\u65b9\u7a0b\uff0c\u597d\u50cf\u53ea\u67092^n\u65b9\u4e2a\u72b6\u6001\u554a\n\nemmm\n\nnE(i)=i*E(i-1)+(n-i)*E(i+1))+n;\n\n\u624b\u7b97\u4e0b\u6837\u4f8b\nemmmm\n\n\u4e3a\u5565\u6211\u7b97\u4e864\u904d4\u4e2a\u6570\n\n~~\u4e0d\u7ba1\u4e86\u7b2c\u56db\u904d\u662f512~~\n\n\u9ad8\u65af\u6d88\u5143\u4e00\u53d1\n\n\u86e495\u4e86\uff1f\uff08\u5927\u96fe\uff09\n\n\u8fd9\u4e2a\u9ad8\u65af\u6d88\u5143\u5f88\u7279\u6b8a\u554a\u662f\u4e0d\u662f\u53ef\u4ee5O(n)\u6d88\u554a\n\n```\n#include <bits/stdc++.h>\n#define pb push_back\n#define cmin(a, b) (a > b ? a = b : a)\n#define cmax(a, b) (a < b ? a = b : a)\n#define lop(i, s, t) for(int i = s;i < (t);++i)\n#define rep(i, s, t) for(int i = s;i <= (t);++i)\n#define dec(i, s, t) for(int i = s;i >= (t);--i)\nusing namespace std;\n\n#define Pr(f,...) printf(f, ##__VA_ARGS__), fflush(stdout)\n\ntypedef long long ll; \n\nconst int N = 3e5 + 50, M = 1005;\nconst ll P = 100003; \n\nint n, qk, q, sp[N], s[N], pri[N], pn;\n\nvoid gao() {\n\tdec(i, n, 1) {\n\t\tif (s[i]) {\n\t\t\tfor (int j = 1;j * j <= i;++j) {\n\t\t\t\tif (i % j == 0) {\n\t\t\t\t\ts[j] ^= 1;\n\t\t\t\t\tif (i / j != j) s[i / j] ^= 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\t++q;\n\t\t}\n\t}\n}\n\n//E[i] = a * E[i-1] + b\nll E[N],inv[P], a[N], b[N];\n\nint main(int argc,char *argv[]){\n#ifndef ONLINE_JUDGE\n    freopen(\"dat.in\",\"r\",stdin); \n    freopen(\"my.out\",\"w\",stdout); \n#endif\n\tscanf(\"%d%d\", &n, &qk); \n\trep(i, 1, n) scanf(\"%d\", s + i); \n\tgao(); \n\trep(i, 0, qk) {\n\t\tE[i] = i;\n\t}\n\tinv[1] = 1;\n\trep(i, 2, P - 1) {\n\t\tinv[i] = (P - P / i) * inv[P % i] % P;\n\t}\n\t//E(n) = E(n - 1) + 1\n\ta[n] = 1, b[n] = 1;\n\tdec(i, n - 1, qk + 1) {\n\t\t//n*E(i)=i*E(i-1)+(n-i)*E(i+1)+n\n\t\t//n*E(i)=i*E(i-1)+(n-i)*(a[i+1]*E(i)+b[i+1])+n\n\t\t//(n-(n-i)*a[i+1])*E(i)=i*E(i-1)+(n-i)*b[i+1]+n\n\t\tll x=n-(n-i)*a[i+1]%P;\n\t\tx=(x%P+P)%P;\n\t\tx=inv[x];\n\t\ta[i]=i*x%P;\n\t\tb[i]=(n-i)*b[i+1]+n;\n\t\tb[i]=b[i]%P*x%P;\n\t}\n\trep(i,qk+1,n){\n\t\tE[i]=(a[i]*E[i-1]+b[i])%P;\n\t}\n\tll res = E[q];\n\trep(i, 1, n) res = res * i % P;\n\tprintf(\"%lld\\n\", res);\n    return 0; \n}\n\n```",
        "postTime": 1521644852,
        "uid": 24745,
        "name": "CuriousCat",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P3750 \u3010[\u516d\u7701\u8054\u80032017]\u5206\u624b\u662f\u795d\u613f\u3011"
    },
    {
        "content": "~~\u6211\u8fd9\u4e2a\u5c0f\u83dc\u9e21\u6765\u6c34\u9898\u89e3\uff0c\u5b8c\u5168\u662f\u56e0\u4e3a\u6ca1\u6709\u770b\u5230\u548c\u6211\u4e00\u6837\u89e3dp\u7684\u4ebaQAQ~~\n\n#### $50\\%$ \u7684\u6570\u636e\n\u5bf9\u4e8e $k=n$ \u7684\u6570\u636e\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa\uff0c\u6700\u5c11\u8981\u64cd\u4f5c\u591a\u5c11\u6b21\uff0c\u80fd\u591f\u5173\u4e0a\u6240\u6709\u7684\u706f\u3002\n\n\u6ce8\u610f\u5230 $n$ \u53f7\u706f\u53ea\u80fd\u7528\u5f00\u5173 $n$ \u63a7\u5236\uff0c\u6240\u4ee5\u5f00\u5173 $n$ \u662f\u5426\u8981\u64cd\u4f5c\u662f\u56fa\u5b9a\u7684\u3002\u6b64\u65f6\uff0c\u5bf9\u4e8e $n-1$ \u53f7\u706f\u6765\u8bf4\uff0c\u524d\u9762\u7684\u5f00\u5173\u90fd\u65e0\u6cd5\u8c03\u6574\uff0c\u6240\u4ee5\u5f00\u5173 $n-1$ \u662f\u5426\u8981\u64cd\u4f5c\u4e5f\u552f\u4e00\u56fa\u5b9a\u3002\u5bf9\u4e8e $n-2,n-3,\\dots,1$ \u90fd\u662f\u4e00\u6837\u7684\u3002\n\n\u8c03\u548c\u7ea7\u6570 $\\mathcal O(\\sum_{i=1}^{n}\\lfloor\\frac{n}{i}\\rfloor)=\\mathcal O(n\\log n)$ \uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u6709\u4fdd\u969c\u3002\n\n#### $100\\%$ \u7684\u6570\u636e\n\u4ece\u4e0a\u9762\u7684\u5206\u6790\u6765\u770b\uff0c\u6700\u4f18\u64cd\u4f5c\u65b9\u6848\u662f\u552f\u4e00\u7684\u3002\u6240\u4ee5\uff0c\u5982\u679c\u6211\u4eec\u6309\u4e86\u672c\u5c31\u8be5\u6309\u7684\u5f00\u5173\uff0c\u6700\u4f18\u65b9\u6848\u5c31\u53ef\u4ee5\u5c11\u6309\u4e00\u6b21\uff1b\u53cd\u4e4b\uff0c\u6700\u4f18\u65b9\u6848\u5c31\u8981\u591a\u6309\u4e00\u6b21\u5f00\u5173\u3002\u6240\u4ee5\uff0c__\u8f6c\u79fb\u53ea\u8ddf\u6700\u4f18\u65b9\u6848\u9700\u8981\u6309\u5f00\u5173\u7684\u6b21\u6570\u6709\u5173__\u3002\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u8ba1\u51fa\u4e00\u4e2a $dp$ \uff0c\u7528 $f(x)$ \u8868\u793a\u6700\u4f18\u65b9\u6848\u9700\u8981\u6309 $x$ \u6b21\u6309\u94ae\u65f6\uff0c\u671f\u671b\u64cd\u4f5c\u6b21\u6570\u3002\u5f88\u7b80\u5355\u53ef\u4ee5\u5199\u51fa\n\n$$f(x)=\\frac{x}{n}\\cdot f(x-1)+\\frac{n-x}{n}\\cdot f(x+1)+1$$\n\n$$\\Rightarrow\\;(n-x)\\cdot f(x+1)=n\\cdot f(x)-x\\cdot f(x-1)-n$$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u53ea\u5bf9 $x\\in(k,n]$ \u6709\u6548\uff0c\u6240\u4ee5\u4e0d\u80fd\u628a $x=k$ \u76f4\u63a5\u4ee3\u5165\u6c42\u503c\u3002\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u89e3\u65b9\u7a0b\uff01\n\n\u4e0d\u59a8\u8bbe\n\n$$f(x)=a_x\\cdot f(k+1)+b_x$$\n\n\u6839\u636e $dp$ \u65b9\u7a0b\u5f0f\uff0c$a_{x+1}$ \u53ef\u4ee5\u7531 $a_{x-1},a_x$ \u63a8\u51fa\uff0c$b$ \u7c7b\u4f3c\u3002\u8fb9\u754c\u4e5f\u5f88\u597d\u5199\uff0c\n\n$$\\begin{cases}a_k=0\\\\b_k=f(k)\\end{cases},\\;\\begin{cases}a_{k+1}=1\\\\b_{k+1}=0\\end{cases}$$\n\n\u6700\u540e\u4e00\u8def\u63a8\u5230 $a_{n+1},b_{n+1}$ \uff0c\u62ff\u5230\u8fd9\u4e2a\u5f0f\u5b50\n\n$$(n-n)\\cdot f(n+1)=a_{n+1}\\cdot f(k+1)+b_{n+1} = 0$$\n\n$$\\Rightarrow\\;f(k+1)=\\frac{-b_{n+1}}{a_{n+1}}$$\n\n\u5982\u679c $a_{n+1}=0$ \u5462\uff1f\u4e0d\u4f1a\u7684\u3002\u4e0b\u8bc1 $\\forall i\\in[k,n),a_{i}<a_{i+1}$ \u3002\n\n\u5229\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u3002$0=a_k<a_{k+1}=1$ \u3002\u800c\u5728 $i\\in(k,n),a_{i-1}<a_i$ \u65f6\uff0c\u6211\u4eec\u6709\n\n$$a_{i+1}=na_i-ia_{i-1}=a_i+(n-i-1)a_i+i(a_i-a_{i-1})>a_i$$\n\n\u6240\u4ee5 $a_{n-1}<a_n$ \uff0c\u7531\u662f\u5219 $a_{n+1}=n(a_n-a_{n-1})>0$ \uff0c\u6545\u53ef\u884c\u3002\n\n~~\u8bdd\u8bf4\u4e3a\u4ec0\u4e48\u6211\u60f3\u4e0d\u5230\u9898\u89e3\u91cc\u9762\u90a3\u4e9b\u7b80\u5355\u7684\u505a\u6cd5\u554a TAT~~\n\n# \u4ee3\u7801\n\u8fd9\u4e2a\u6a21\u6570 $10^5+3$ \u6709\u51e0\u4e2a\u597d\u5904\uff1a\n\n- \u662f\u4e00\u4e2a\u5c0f\u8d28\u6570\uff0c\u9006\u5143\u5747\u5b58\u5728\u3002\n- \u7565\u5927\u4e8e $n$ \uff0c\u4e0d\u4f1a\u51fa\u73b0\u6070\u597d\u9664\u4ee5\u8be5\u6a21\u6570\u7684\u60c5\u51b5\u3002\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <vector>\nusing namespace std;\ntypedef long long int_;\ninline int readint(){\n\tint a = 0; char c = getchar(), f = 1;\n\tfor(; c<'0'||c>'9'; c=getchar())\n\t\tif(c == '-') f = -f;\n\tfor(; '0'<=c&&c<='9'; c=getchar())\n\t\ta = (a<<3)+(a<<1)+(c^48);\n\treturn a*f;\n}\n\nconst int zxy = 100003;\nint inv[zxy], a[zxy], n, dp[zxy];\nvector< int > son[zxy];\n\nint main(){\n\tinv[0] = inv[1] = 1; n = readint();\n\tfor(int i=2; i<zxy; ++i)\n\t\tinv[i] = (0ll+zxy-zxy/i)\n\t\t\t*inv[zxy%i]%zxy;\n\tint k = readint();\n\t// dp[i] = 1+i*dp[i-1]/n+(n-i)*dp[i+1]/n\n\t// (n-i)*dp[i+1] = n*dp[i]-n-i*dp[i-1]\n\tfor(int i=0; i<=k; ++i) dp[i] = i;\n\tint_ a0 = 0, b0 = k, a1 = 1, b1 = 0;\n\tfor(int i=k+1; i<=n; ++i){\n\t\t// dp[i-1] = a0*dp[k+1]+b0\n\t\t// dp[ i ] = a1*dp[k+1]+b1\n\t\tint_ a2 = (n*a1-i*a0)%zxy;\n\t\tint_ b2 = (n*b1-n-i*b0)%zxy;\n\t\ta2 = (a2*inv[n-i]%zxy+zxy)%zxy;\n\t\tb2 = (b2*inv[n-i]%zxy+zxy)%zxy;\n\t\ta0 = a1, b0 = b1; // \u5411\u524d\u79fb\u52a8\n\t\ta1 = a2, b1 = b2; // \u5411\u524d\u79fb\u52a8\n\t}\n\tdp[k+1] = (zxy-b1)*inv[a1]%zxy;\n\tfor(int i=k+1; i<n; ++i){\n\t\tint &t = dp[i+1] = (1ll*n*dp[i]\n\t\t\t-n-1ll*i*dp[i-1])%zxy;\n\t\tt = (0ll+t+zxy)*inv[n-i]%zxy;\n\t}\n\tfor(int i=1; i<=n; ++i)\n\t\ta[i] = readint();\n\tfor(int i=1; i<=n; ++i)\n\t\tfor(int j=1; j<=n/i; ++j)\n\t\t\tson[i*j].push_back(i);\n\tint cnt = 0;\n\tfor(int i=n; i>=1; --i){\n\t\tcnt += a[i];\n\t\tfor(auto j : son[i])\n\t\t\ta[j] ^= a[i];\n\t}\n\tint ans = dp[cnt];\n\tfor(int i=1; i<=n; ++i)\n\t\tans = 1ll*ans*i%zxy;\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1592295084,
        "uid": 123796,
        "name": "Damo",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3750 \u3010[\u516d\u7701\u8054\u80032017]\u5206\u624b\u662f\u795d\u613f\u3011"
    },
    {
        "content": "~~\u8fd9\u9053\u5386\u53f2\u9057\u7559\u95ee\u9898\u7ec8\u4e8e\u89e3\u51b3\u4e86~~\n\n\u53ef\u4ee5\u53d1\u73b0\u6bcf\u76cf\u706f\u6700\u591a\u53ea\u4f1a\u5f00\u4e00\u6b21\u3002\n\n\u56e0\u4e3a\u6bcf\u6b21\u5f00\u706f\u5f71\u54cd\u7684\u90fd\u662f\u5b83\u7684\u7ea6\u6570\uff0c\u6240\u4ee5\u5b83\u5f71\u54cd\u7684\u8303\u56f4\u4e25\u683c\u5c0f\u4e8e\u5b83\u3002\n\n\u9898\u76ee\u53eb\u6211\u4eec\u6c42\u6700\u5c0f\u64cd\u4f5c\u6b21\u6570\uff0c\u8fd9\u662f\u4e2a\u6bd4\u8f83\u7ecf\u5178\u7684\u8d2a\u5fc3\u6a21\u578b\u3002\u4ece\u5927\u5f80\u5c0f\u626b\uff0c\u5982\u679c\u6709\u4e00\u76cf\u706f\u5f00\u7740\uff0c\u5c31\u628a\u5b83\u5173\u6389\uff0c\u5e76\u5bf9\u5b83\u7684\u7ea6\u6570\u96c6\u5408\u8fdb\u884c\u64cd\u4f5c\uff0c\u7d2f\u8ba1\u6b21\u6570cnt\u3002\n\n\u5f53cnt\u5c0f\u4e8ek\u65f6\uff0ccnt\u5c31\u662f\u7b54\u6848\u3002\n\n\u5426\u5219\uff0c\u6b64\u65f6\u6709cnt\u4e2a\u6b63\u786e\u64cd\u4f5c\uff0c\u6211\u4eec\u8003\u8651\u628acnt\u51cf\u5230k\u7684\u671f\u671b\u3002\n\n\u8bbef[i]\u8868\u793a\u6709i\u4e2a\u6b63\u786e\u9009\u62e9\uff0c\u5c06\u6b63\u786e\u9009\u62e9\u51cf\u5230i-1\u7684\u671f\u671b\u3002\n\nf[i]=i/n+(1-(i/n))*(1+f[i+1]+f[i])\n\ni/n\u53ef\u80fd\u6b63\u786e\u64cd\u4f5c\uff0c\u4e0d\u6b63\u786e\u64cd\u4f5c\u65f6\u9664\u4e86\u672c\u6b21\u64cd\u4f5c\u5916\uff0c\u8fd8\u8981\u671f\u671b\u8fdb\u884cf[i],f[i+1]\u6b21\u64cd\u4f5c\u3002\n\n\u9884\u5904\u7406\u4e0b\u9006\u5143\u5373\u53ef\u3002\n\n```\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<string>\n#include<cstring>\n#include<cmath>\n#include<vector>\nusing namespace std;\ntypedef long long ll;\nconst ll size=1e5+10,p=1e5+3;\nll n,ans,k,cnt,a[size],inv[size],f[size];vector<ll> g[size];\ninline ll read(){\n\tll x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=(x<<1)+(x<<3)+ch-'0';ch=getchar();}\n\treturn x*f;\n}\nint main(){\n\tn=read();k=read();inv[1]=1;\n\tfor(ll i=1;i<=n;i++) a[i]=read();\n\tfor(ll i=2;i<=n;i++) inv[i]=((p-p/i)*inv[p%i])%p;\n\tfor(ll i=1;i<=n;i++){\n\t\tfor(ll j=i;j<=n;j+=i) g[j].push_back(i);\n\t}\n\tfor(ll i=n;i>=1;i--){\n\t\tif(a[i]){\n\t\t\tcnt++;\n\t\t\tfor(ll j=0;j<g[i].size();j++){\n\t\t\t\ta[g[i][j]]^=1;\n\t\t\t}\n\t\t}\n\t}\n\tif(cnt<=k) ans=cnt;\n\telse{\n\t\tf[n]=1;\n\t\tfor(ll i=n-1;i>=1;i--) f[i]=(n+(n-i)*f[i+1])*inv[i]%p;\n\t\tfor(ll i=cnt;i>k;i--) ans=(ans+f[i])%p;\n\t\tans=(ans+k)%p;\n\t}\n\tfor(ll i=1;i<=n;i++) ans=(ans*i)%p;\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1543842745,
        "uid": 53032,
        "name": "\u5c0f\u5858\u7a7a\u660e",
        "ccfLevel": 0,
        "title": "P3750 [\u516d\u7701\u8054\u80032017]\u5206\u624b\u662f\u795d\u613f"
    }
]
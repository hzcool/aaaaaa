[
    {
        "content": "\u5176\u5b9e\u8fd9\u4e2a\u79d1\u6280\u5728 2017 \u5e74\u5c31\u88ab\u795e\u4ed9\u4eec\u6240\u719f\u77e5\u4e86\uff0c\u8fd9\u91cc\u5e94 [\u5154\u5154](https://www.luogu.com.cn/user/10703) \u7684\u8981\u6c42\uff0c\u9020\u4e86\u9053\u6a21\u677f\u9898\uff0c\u6765\u6d1b\u8c37\u666e\u53ca\u4e00\u4e0b\uff0c\uff0c\u6c42\u8f7b\u55b7\u3002\n****\n\u4efb\u610f\u4e00\u9636\u5fae\u5206\u65b9\u7a0b\u90fd\u80fd\u5199\u6210\u8fd9\u79cd\u5f62\u5f0f\uff1a\n$$F'(x)\\equiv G(F(x)) \\pmod{x^n}$$\n\u5728\u6d1b\u8c37\u6a21\u677f\u9898\u4e2d\uff0c$G(F(x))=A(x)\\text e^{F(x)-1}+B(x)$\uff0c$G'(F(x))=A(x)\\text e^{F(x)-1}$\u3002\n\n\u5047\u8bbe\u5df2\u7ecf\u6c42\u5f97 $F_0(x)$\uff0c\u5728\u524d $\\lceil n/2 \\rceil$ \u9879\u6ee1\u8db3\u4e0a\u5f0f\uff1b\u7c7b\u6bd4\u666e\u901a\u725b\u987f\u8fed\u4ee3\u7684\u505a\u6cd5\uff0c\u5728 $F_0(x)$ \u5904\u505a Taylor \u5c55\u5f00\u540e\u53d6\u524d\u4e24\u9879\uff0c\u6709\uff1a\n\n$$F'(x) \\equiv G(F_0(x))+G'(F_0(x))(F(x)-F_0(x)) \\pmod{x^n}$$ \n\uff08\u540e\u9762\u7684\u9879\u5728\u6a21 $x^n$ \u4e0b\u4e3a\u96f6\uff0c\u5f53\u7136\u53ef\u4ee5\u5ffd\u7565\uff09  \n\n\u6211\u4eec\u5e0c\u671b\u628a\u5e26 $F(x)$ \u7684\u9879\u5168\u90fd\u79fb\u5230\u4e00\u8fb9\u6765\n$$F'(x)-G'(F_0(x))F(x) \\equiv G(F_0(x))-G'(F_0(x))F_0(x) \\pmod{x^n}$$\n\u5982\u679c\u80fd\u6784\u9020\u4e00\u4e2a $P(x)$\uff0c\u4f7f\u5f97\u4e24\u8fb9\u540c\u4e58 $P(x)$ \u540e\uff0c\u5de6\u8fb9\u53d8\u6210 $(F(x)P(x))'$ \u7684\u8bdd\uff1a\n\n$$F(x) \\equiv  \\frac{1}{P(x)} \\left( \\int P(x)(G(F_0(x))-G'(F_0(x))F_0(x))  \\text dx +1\\right)\\pmod{x^n}$$\n\u53f3\u8fb9\u90a3\u4e2a $+1$ \u662f\u56e0\u4e3a\uff0c\u8fd9\u6837\u79ef\u5206\u6f0f\u4e86\u4e00\u9879\uff0c\u8865\u56de\u53bb\u5c31\u597d\u4e86\u3002  \n\u6ce8\u610f\u53f3\u8fb9\u7684 $F_0(x)$ \u90fd\u662f\u6211\u4eec\u63d0\u524d\u7b97\u597d\u7684\uff0c\u6240\u4ee5\u5c31\u80fd\u76f4\u63a5\u8fed\u4ee3......\u4e86\uff1f\n\n\u554a\uff0c\u597d\u50cf\u5fd8\u4e86\u8bf4 $P(x)$ \u5e94\u8be5\u600e\u4e48\u6784\u9020\uff0c\u5176\u5b9e\u5c31\u662f\uff1a\n$$(F(x)P(x))'=F'(x)P(x)+P'(x)F(x)$$\n\u5bf9\u6bd4\u4e00\u4e0b $P(x)F'(x)-P(x)G'(F_0(x))F(x)$ \u7684\u5f0f\u5b50\uff0c\u4e0d\u96be\u53d1\u73b0\u6211\u4eec\u8981\u6c42\u7684\u5c31\u662f\n\n$$P'(x)=-P(x)G'(F_0(x))$$\n$$(\\ln P(x))'=-G'(F_0(x))$$\n$$P(x) = \\exp \\left( \\int -G'(F_0(x)) \\text dx \\right)$$\n\u76f4\u63a5\u505a\u5c31\u597d\u4e86\u3002~~\u5e38\u6570\u5947\u5927\u65e0\u6bd4\uff0c\u5b8c\u5168\u6253\u4e0d\u8fc7\u5206\u6cbb fft~~  \n\n\u4ee3\u7801\u4e3a\u4e86\u597d\u5199\uff0c\u6ca1\u600e\u4e48\u5361\u5e38\uff0c\u4ec5\u4f9b\u53c2\u8003\u3002\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#define N 262147\n#define ll long long\n#define reg register\n#define p 998244353\nusing namespace std;\n\ninline int add(const int& x,const int& y){ return x+y>=p?x+y-p:x+y; }\ninline int dec(const int& x,const int& y){ return x<y?x-y+p:x-y; }\n\ninline void read(int &x){\n    x = 0;\n    char c = getchar();\n    while(c<'0'||c>'9') c = getchar();\n    while(c>='0'&&c<='9'){\n        x = (x<<3)+(x<<1)+(c^48);\n        c = getchar();\n    }\n}\n\nvoid print(int x){\n    if(x>9) print(x/10);\n    putchar(x%10+'0');\n}\n\ninline int power(int a,int t){\n    int res = 1;\n    while(t){\n        if(t&1) res = (ll)res*a%p;\n        a = (ll)a*a%p;\n        t >>= 1;\n    }\n    return res;\n}\n\nint siz;\nint rev[N],rt[N],inv[N];\n\nvoid init(int n){\n    int lim = 1;\n    while(lim<=n) lim <<= 1,++siz;\n    for(reg int i=0;i!=lim;++i) rev[i] = (rev[i>>1]>>1)|((i&1)<<(siz-1));\n    int w = power(3,(p-1)>>siz);\n    inv[1] = rt[lim>>1] = 1;\n    for(reg int i=(lim>>1)+1;i!=lim;++i) rt[i] = (ll)rt[i-1]*w%p;\n    for(reg int i=(lim>>1)-1;i;--i) rt[i] = rt[i<<1];\n    for(reg int i=2;i<=n;++i) inv[i] = (ll)(p-p/i)*inv[p%i]%p;\n}\n\ninline void dft(int *f,int n){\n    static unsigned long long a[N];\n    reg int x,shift = siz-__builtin_ctz(n);\n    for(reg int i=0;i!=n;++i) a[rev[i]>>shift] = f[i];\n    for(reg int mid=1;mid!=n;mid<<=1)\n    for(reg int j=0;j!=n;j+=(mid<<1))\n    for(reg int k=0;k!=mid;++k){\n        x = a[j|k|mid]*rt[mid|k]%p;\n        a[j|k|mid] = a[j|k]+p-x;\n        a[j|k] += x;\n    }\n    for(reg int i=0;i!=n;++i) f[i] = a[i]%p;\n}\n\ninline void idft(int *f,int n){\n    reverse(f+1,f+n);\n    dft(f,n);\n    int x = p-((p-1)>>__builtin_ctz(n));\n    for(reg int i=0;i!=n;++i) f[i] = (ll)f[i]*x%p;\n}\n\ninline int getlen(int n){\n    return 1<<(32-__builtin_clz(n));\n}\n\ninline void inverse(const int *f,int n,int *r){\n    static int g[N],h[N],st[30];\n    memset(g,0,getlen(n<<1)<<2);\n    int lim = 1,top = 0;\n    while(n){\n        st[++top] = n;\n        n >>= 1;\n    }\n    g[0] = 1;\n    while(top--){\n        n = st[top+1];\n        while(lim<=(n<<1)) lim <<= 1;\n        memcpy(h,f,(n+1)<<2);\n        memset(h+n+1,0,(lim-n)<<2);\n        dft(g,lim),dft(h,lim);\n        for(reg int i=0;i!=lim;++i) g[i] = g[i]*(2-(ll)g[i]*h[i]%p+p)%p;\n        idft(g,lim);\n        memset(g+n+1,0,(lim-n)<<2);\n    }\n    memcpy(r,g,(n+1)<<2);\n}\n\ninline void log(const int *f,int n,int *r){\n    static int g[N],h[N];\n    inverse(f,n,g);\n    for(reg int i=0;i!=n;++i) h[i] = (ll)f[i+1]*(i+1)%p;\n    h[n] = 0;\n    int lim = getlen(n<<1);\n    memset(g+n+1,0,(lim-n)<<2);\n    memset(h+n+1,0,(lim-n)<<2);\n    dft(g,lim),dft(h,lim);\n    for(reg int i=0;i!=lim;++i) g[i] = (ll)g[i]*h[i]%p;\n    idft(g,lim);\n    for(reg int i=1;i<=n;++i) r[i] = (ll)g[i-1]*inv[i]%p;\n    r[0] = 0;\n}\n\ninline void exp(const int *f,int n,int *r){\n    static int g[N],h[N],st[30];\n    memset(g,0,getlen(n<<1)<<2);\n    int lim = 1,top = 0;\n    while(n){\n        st[++top] = n;\n        n >>= 1;\n    }\n    g[0] = 1;\n    while(top--){\n        n = st[top+1];\n        while(lim<=(n<<1)) lim <<= 1;\n        memcpy(h,g,(n+1)<<2);\n        memset(h+n+1,0,(lim-n)<<2);\n        log(g,n,g);\n        for(reg int i=0;i<=n;++i) g[i] = dec(f[i],g[i]);\n        g[0] = add(g[0],1);\n        dft(g,lim),dft(h,lim);\n        for(reg int i=0;i!=lim;++i) g[i] = (ll)g[i]*h[i]%p;\n        idft(g,lim);\n        memset(g+n+1,0,(lim-n)<<2);\n    }\n    memcpy(r,g,(n+1)<<2);\n}\n\ninline void multiply(const int *f,const int *g,int n,int m,int *r,int len){\n    static int a[N],b[N];\n    int lim = getlen(n+m);\n    memcpy(a,f,(n+1)<<2),memcpy(b,g,(m+1)<<2);\n    memset(a+n+1,0,(lim-n)<<2),memset(b+m+1,0,(lim-m)<<2);\n    dft(a,lim),dft(b,lim);\n    for(reg int i=0;i!=lim;++i) a[i] = (ll)a[i]*b[i]%p;\n    idft(a,lim);\n    memcpy(r,a,(len+1)<<2);\n}\n\ninline void solve(const int *a,const int *b,int n,int *r){\n    static int f[N],ef[N],gf[N],dgf[N],h[N],q[N],st[30]; // P(x) in this code is h(x)\n    int top = 0,lim = getlen(n<<1)<<1;\n    memset(f,0,lim<<2);\n    while(n){\n        st[++top] = n;\n        n >>= 1;\n    }\n    f[0] = 1;\n    while(top--){\n        n = st[top+1];\n        memcpy(ef+1,f+1,n<<2);\n        ef[0] = 0;\n        exp(ef,n,ef);\n        multiply(ef,a,n,n,dgf,n);\n        for(reg int i=0;i<=n;++i) gf[i] = add(dgf[i],b[i]);\n        for(reg int i=0;i<=n;++i) h[i] = dgf[i]==0?0:p-dgf[i];\n        for(reg int i=n;i;--i) h[i] = (ll)h[i-1]*inv[i]%p;\n        h[0] = 0;\n        exp(h,n,h);\n        multiply(dgf,f,n,n,q,n);\n        for(reg int i=0;i<=n;++i) q[i] = dec(gf[i],q[i]);\n        multiply(q,h,n,n,q,n);\n        for(reg int i=n;i;--i) q[i] = (ll)q[i-1]*inv[i]%p;\n        q[0] = 1;\n        inverse(h,n,h);\n        multiply(q,h,n,n,q,n);\n        memcpy(f+1,q+1,n<<2);\n    }\n    memcpy(r,f,(n+1)<<2);\n}\n\nint a[N],b[N],f[N];\nint n;\n\nint main(){\n    read(n);\n    init(n<<1);\n    for(reg int i=0;i<=n;++i) read(a[i]);\n    for(reg int i=0;i<=n;++i) read(b[i]);\n    solve(a,b,n,f);\n    for(reg int i=0;i<=n;++i) print(f[i]),putchar(' ');\n    return 0;   \n}\n```",
        "postTime": 1591878652,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "\u4e00\u9636\u5fae\u5206\u65b9\u7a0b\u7684\u8fed\u4ee3\u6c42\u6cd5"
    },
    {
        "content": "[\u53ef\u80fd\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.luogu.com.cn/blog/wangrx/p6613-ti-xie)  \n\u9898\u89e3\u533a\u7684\u5f88\u591a\u5927\u4f6c\u90fd\u662f\u5f3a\u89e3\u5fae\u5206\u65b9\u7a0b\u7684\uff0c\u4f46\u5e38\u6570\u53d8\u6613\u6cd5\u849f\u84bb\u5bf9\u6b64\u6709\u8bb8\u591a\u4e0d\u89e3\u3002  \n\u56e0\u6b64\u849f\u84bb\u5728\u6b64\u7ed9\u51fa\u672c\u9898\u5e38\u6570\u53d8\u6613\u6cd5\u7684\u8bc1\u660e\u3002 \n\n------------------------------\n## \u4e00\u9636\u7ebf\u6027\u5fae\u5206\u65b9\u7a0b\u7684\u5e38\u6570\u53d8\u6613\u6cd5\n\n\u8fd9\u91cc\u6709\u57fa\u7840\u7684\u5927\u4f6c\u53ef\u4ee5\u76f4\u63a5\u8df3\u8fc7\u3002\n\n\u8ba9\u6211\u4eec\u5148\u8003\u8651 \u4e00\u9636\u9f50\u6b21\u7ebf\u6027\u5fae\u5206\u65b9\u7a0b\uff1a\n$$y'=P(x)y$$\n\n\u663e\u7136\uff0c\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86 $(\\ln y)'=\\dfrac{y'}{y}$\uff0c\u56e0\u6b64\u8be5\u65b9\u7a0b\u5316\u4e3a\n$$(\\ln y)'=P(x)$$\n$$\\ln y=\\int P(x)\\mathrm{d}x+\\ln C$$\n$$y=Ce^{\\int P(x)\\mathrm{d}x}$$\n\u5176\u4e2d $C$ \u4e3a\u5e38\u6570\uff0c\u7531\u5b9e\u9645\u60c5\u51b5\u51b3\u5b9a\u3002\n\n\u8fd9\u4e2a\u8fc7\u7a0b\u88ab\u79f0\u4e3a\u5206\u79bb\u53d8\u91cf\u6cd5\uff0c\u76f8\u5f53\u5730\u7b80\u5355\u3002\n\n\u4f46\u5bf9\u4e8e\u4e00\u822c\u7684 \u4e00\u9636\u7ebf\u6027\u5fae\u5206\u65b9\u7a0b\uff0c\u591a\u4e86\u4e00\u4e2a\u4e0e $y$ \u65e0\u5173\u7684 $Q(x)$\uff0c\u96be\u5ea6\u5c31\u76f4\u7ebf\u98d9\u5347\uff1a\n$$y'=P(x)y+Q(x)$$\n\u4e3a\u6c42\u51fa\u8be5\u65b9\u7a0b\u7684\u901a\u89e3\uff0c\u62c9\u683c\u6717\u65e5\u82b1\u4e86\u6574\u6574 11 \u5e74\u7684\u65f6\u95f4\uff08\u5728\u6b64\u4f69\u670d\u5927\u4f6c\u7684\u6bc5\u529b\uff09\uff0c  \n\u6700\u540e\u53d1\u73b0\uff0c\u5982\u679c\u628a $y$ \u62c6\u5f00\uff0c\u53d8\u4e3a $y=uv$\uff0c\u65b9\u7a0b\u5c31\u53ef\u89e3\u4e86\uff1a\n$$u'v+uv'=P(x)uv+Q(x)$$\n$$u'v+u(v'-P(x)v)=Q(x)$$\n\u53ea\u8981\u4f7f $v$ \u6ee1\u8db3\u7279\u5b9a\u7684\u6761\u4ef6\uff0c\u4ee3\u5165\u89e3\u51fa\u5bf9\u5e94\u7684 $u$\uff0c\u5c31\u53ef\u4ee5\u6c42\u51fa $y$ \u4e86\uff08\u53cd\u4e4b\u4ea6\u7136\uff09\u3002  \n\u53ef\u4ee5\u770b\u5230\uff0c\u5982\u679c\u4f7f $v'-P(x)v=0$\uff0c\u65b9\u7a0b\u5c31\u53d8\u4e3a $u'=\\dfrac{Q(x)}{v}$\uff0c\u53ef\u4ee5\u76f4\u63a5\u79ef\u5206\u6c42\u51fa $u$\u3002  \n\u81f3\u4e8e $v'-P(x)v=0$\uff0c\u8fd9\u4e0d\u5c31\u662f\u4e4b\u524d\u5df2\u7ecf\u89e3\u51b3\u4e86\u7684 \u4e00\u9636\u9f50\u6b21\u7ebf\u6027\u5fae\u5206\u65b9\u7a0b \u5417\uff1f  \n\u7531\u6b64\u5f97\u5230\u4e86 \u4e00\u9636\u7ebf\u6027\u5fae\u5206\u65b9\u7a0b \u7684\u901a\u89e3\uff1a\n$$v=C_ve^{\\int P(x)\\mathrm{d}x}$$\n$$u=C_v^{-1}(\\int Q(x)e^{-\\int P(x)\\mathrm{d}x}\\mathrm{d}x+C_u)$$\n$$y=uv=e^{\\int P(x)\\mathrm{d}x}(\\int Q(x)e^{-\\int P(x)\\mathrm{d}x}\\mathrm{d}x+C_u)$$\n\n\u62c9\u683c\u6717\u65e5\u53d1\u73b0\uff0c\u8fd9\u4e2a\u901a\u89e3\u6ee1\u8db3 $y=C(x)e^{\\int P(x)\\mathrm{d}x}$ \u7684\u5f62\u5f0f\u3002  \n\u5176\u5b9e\u4e0d\u96be\u7406\u89e3\uff0c$e^{\\int P(x)\\mathrm{d}x}$ \u6765\u81ea\u539f\u672c\u7684 $v$\uff0c\u6c42\u89e3 $u$ \u7684\u8fc7\u7a0b\u5c31\u662f\u6c42\u89e3 $C(x)$\u3002  \n\u56e0\u6b64\u4e4b\u540e\u6c42\u89e3\u7684\u65f6\u5019\u5c31\u7565\u53bb\u62c6\u5f00 $y$ \u7684\u8fc7\u7a0b\uff0c\u76f4\u63a5\u5148\u89e3\u5bf9\u5e94\u7684\u9f50\u6b21\u65b9\u7a0b\uff0c  \n\u7136\u540e\u5c06\u5e38\u6570\u53d8\u4e3a\u51fd\u6570\u4ee3\u5165\u56de\u53bb\uff0c\u8fd9\u5c31\u662f\u4e00\u9636\u7ebf\u6027\u5fae\u5206\u65b9\u7a0b\u7684\u5e38\u6570\u53d8\u6613\u6cd5\u3002\n\n-----------------------------\n## \u672c\u9898\u5fae\u5206\u65b9\u7a0b\u7684\u5e38\u6570\u53d8\u6613\u6cd5\n\u63a5\u4e0b\u6765\uff0c\u8ba9\u6211\u4eec\u8003\u8651\u672c\u9898\u7684\u5fae\u5206\u65b9\u7a0b\uff0c\u5b83\u6ee1\u8db3\u4ee5\u4e0b\u5f62\u5f0f\uff1a\n$$y'=P(x)f'^{-1}(y)+Q(x)$$\n\u4e4b\u524d\u7684\u7ecf\u9a8c\u544a\u8bc9\u6211\u4eec\u8003\u8651\u5bf9\u5e94\u7684\u9f50\u6b21\u65b9\u7a0b\uff1a\n$$y'=P(x)f'^{-1}(y)$$\n$$f'(y)y'=P(x)$$\n$$f(y)=\\int P(x)\\mathrm{d}x+C$$\n$$y=\\operatorname{arc}f(\\int P(x)\\mathrm{d}x+C)$$\n\u5176\u4e2d $\\operatorname{arc}f$ \u4e3a $f$ \u5bf9\u5e94\u7684\u53cd\u51fd\u6570\uff0c\u5373\n$$f:A\\rightarrow B,\\operatorname{arc}f:B\\rightarrow A$$\n$$\\forall x\\in A,\\operatorname{arc}f(f(x))=x$$\n$$\\forall x\\in B,f(\\operatorname{arc}f(x))=x$$\n\n\u63a8\u5e7f\u5230\u975e\u9f50\u6b21\uff0c\u6211\u4eec\u731c\u60f3\uff0c\u672c\u9898\u5fae\u5206\u65b9\u7a0b\u901a\u89e3\u7684\u5f62\u5f0f\u4e3a\uff1a\n$$y=\\operatorname{arc}f(\\int P(x)\\mathrm{d}x+C(x))$$\n\u63a5\u4e0b\u6765\u8bc1\u660e\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u505a\u662f\u6b63\u786e\u7684\u3002  \n\u540c\u6837\u5c06 $y$ \u62c6\u5f00\uff0c\u8003\u8651\u5230\u4e4b\u524d $u,v$ \u4e0e\u901a\u89e3\u4e24\u9879\u7684\u5bf9\u5e94\uff0c\u53ef\u8ba4\u4e3a\n$$y=\\operatorname{arc}f(v+u)$$\n\u5f53 $\\operatorname{arc}f(x)=e^x$ \u65f6\uff0c$f'^{-1}(x)=x$\uff0c  \n$y=e^{v+u}=e^ue^v$\uff0c\u521a\u597d\u5bf9\u5e94\u4e0a\u4e86\u4e00\u5f00\u59cb\u7684\u62c6\u6cd5 $y=uv$\u3002\n\n$\\operatorname{arc}f$ \u503c\u57df $=f$ \u5b9a\u4e49\u57df $\\supseteq f'^{-1}$ \u5b9a\u4e49\u57df\uff0c  \n\u56e0\u6b64\u4ecd\u7136\u53ef\u4ee5\u4f7f $f,v$ \u6ee1\u8db3\u7279\u5b9a\u7684\u6761\u4ef6\uff0c\u4ee3\u5165\u89e3\u51fa\u5bf9\u5e94\u7684 $u$ \u6765\u6c42\u89e3 $y$\u3002\n\n\u4ee3\u5165 $y=\\operatorname{arc}f(v+u)$\uff0c\u5f97\n$$\\operatorname{arc}f'(v+u)(v'+u')=P(x)f'^{-1}(\\operatorname{arc}f(v+u))+Q(x)$$\n\u5bf9 $f(\\operatorname{arc}f(x))=x$ \u6c42\u5bfc\uff0c\u5f97\n$$f'(\\operatorname{arc}f(x))\\operatorname{arc}f'(x)=1$$\n$$\\operatorname{arc}f'(x)=f'^{-1}(\\operatorname{arc}f(x))$$\n\u56e0\u6b64\u539f\u65b9\u7a0b\u53ef\u5316\u4e3a \n$$\\operatorname{arc}f'(v+u)(v'+u')=P(x)\\operatorname{arc}f'(v+u)+Q(x)$$\n$$\\operatorname{arc}f'(v+u)(v'+u'-P(x))=Q(x)$$\n\u82e5 $v'-P(x)=0$\uff0c\u89e3\u5f97 $v=\\displaystyle\\int P(x)\\mathrm{d}x+C_v$ \u3002  \n\u56e0\u6b64\u4e4b\u524d\u901a\u89e3\u7684\u5f62\u5f0f\uff08\u5e38\u6570\u53d8\u6613\u6cd5\uff09\u662f\u6b63\u786e\u7684\u3002\n\n------------------------------\n## \u672c\u9898\u5fae\u5206\u65b9\u7a0b\u7684\u6c42\u89e3\n\u56de\u5230\u672c\u9898\u7684\u5fae\u5206\u65b9\u7a0b\n\n$$y'=P(x)e^{y-1}+Q(x)$$\n\u6b64\u65f6 $f'^{-1}(x)=e^{x-1}$\uff0c\u8bbe $f(x)=-e^{1-x}$\uff0c\u5219 $\\operatorname{arc}f(x)=1-\\ln(-x)$\u3002  \n\u4ee3\u5165\u901a\u89e3 $y=\\operatorname{arc}f(\\displaystyle\\int P(x)\\mathrm{d}x+C(x))$ \u5f97\n\n$$\\operatorname{arc}f'(\\int P(x)\\mathrm{d}x+C(x))C'(x)=Q(x)$$\n$$\\frac{C'(x)}{\\displaystyle-(\\int P(x)\\mathrm{d}x+C(x))}=Q(x)$$\n$$C'(x)=-Q(x)C(x)-Q(x)\\int P(x)\\mathrm{d}x$$\n\n\u7531\u6b64\u8f6c\u5316\u4e3a\u4e00\u9636\u7ebf\u6027\u5fae\u5206\u65b9\u7a0b\uff0c\u89e3\u5f97\n\n$$C(x)=e^{-\\int Q(x)\\mathrm{d}x}(\\int(-Q(x)\\int P(x)\\mathrm{d}x)e^{\\int Q(x)\\mathrm{d}x}\\mathrm{d}x+C_u)$$\n$$y=\\operatorname{arc}f(\\int P(x)\\mathrm{d}x+C(x))$$\n$$=1-\\ln(-\\int P(x)\\mathrm{d}x-C(x))$$\n\n-------------------------------\n\u8bbe $A(x)=\\displaystyle\\int P(x)\\mathrm{d}x,B(x)=\\displaystyle e^{\\int Q(x)\\mathrm{d}x}$\uff0c\u5219\n$$C(x)=B^{-1}(x)(\\int -Q(x)A(x)B(x)\\mathrm{d}x+C_u)$$\n$$y=1-\\ln(-A(x)-C(x))$$\n$$=1-\\ln(-A(x)+B^{-1}(x)(\\int Q(x)A(x)B(x)\\mathrm{d}x-C_u))$$\n$$=1+\\ln B(x)-\\ln(-A(x)B(x)+\\int Q(x)A(x)B(x)\\mathrm{d}x-C_u)$$\n\u7531 $y(0)=1$ \u5f97\n$$\\ln B(0)-\\ln(-A(0)B(0)+\\displaystyle\\int^0 Q(x)A(x)B(x)\\mathrm{d}x-C_u)=0$$\n$$B(0)=-A(0)B(0)-C_u$$\n$$-C_u=A(0)B(0)+B(0)=B(0)=1$$\n\n\n$$y=1+\\int Q(x)\\mathrm{d}x-\\ln(-A(x)B(x)+\\int Q(x)A(x)B(x)\\mathrm{d}x+1)$$\n\n\u5df2\u77e5 $B'(x)=Q(x)B(x),(A(x)B(x))'=A'(x)B(x)+A(x)B'(x)$  \n\n\u4e8e\u662f\u5f97 $Q(x)A(x)B(x)=A(x)B'(x)=(A(x)B(x))'-A'(x)B(x)$  \n$$-A(x)B(x)+\\int Q(x)A(x)B(x)\\mathrm{d}x$$\n$$=-\\int A'(x)B(x)\\mathrm{d}x=-\\int P(x)e^{\\int Q(x)\\mathrm{d}x}\\mathrm{d}x$$\n\n$$y=1+\\int Q(x)\\mathrm{d}x-\\ln(1-\\int P(x)e^{\\int Q(x)\\mathrm{d}x}\\mathrm{d}x)$$\n\u7531\u6b64\u5f97\u89e3\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n\\log n)$\u3002\n\n## Code\n```cpp\n/*\nthis code is made by wangrx\n2021.5.22 20:00\n*/\n#include<stdio.h>\n#include<string.h>\ntypedef unsigned char byte;\ntypedef unsigned long long ull;\ntypedef long long ll;\ntypedef unsigned int word;\nstruct READ{//\u5feb\u8bfb\n\tchar c;\n\tinline READ(){c=getchar();}\n\ttemplate<typename type>\n\tinline READ& operator>>(register type& num){\n\t\twhile('0'>c||c>'9') c=getchar();\n\t\tfor(num=0;'0'<=c&&c<='9';c=getchar())\n\t\t\tnum=num*10+(c-'0');\n\t\treturn *this;\n\t}\n}cin;\nclass WRITE{//\u5feb\u5199\n\tprivate:\n\t\tchar out[1<<20],*top;\n\tpublic:\n\t\tinline WRITE(){top=out;}\n\t\tinline ~WRITE(){if(top!=out) fwrite(out,1,top-out,stdout);}\n\t\tinline WRITE& operator <<(char c){\n\t\t\t*(top++)=c;\n\t\t\tif(top==out+(1<<20))\n\t\t\t\tfwrite(top=out,1,1<<20,stdout);\n\t\t\treturn *this;\n\t\t}\n\t\tinline void outnum(word num){\n\t\t\tif(num) outnum(num/10),*this<<(char)(num%10+'0');\n\t\t}\n\t\ttemplate<typename type>\n\t\tinline WRITE& operator <<(type num){\n\t\t    if(num) return outnum(num),*this;\n\t\t\treturn *this<<'0';\n\t\t}\n}cout;\n#define mx 18\n#define mx_ 17\nword root[1<<mx],inv[1<<mx],realid[1<<mx];\null size,ni2;\nconst word mod=998244353;\ninline ull pow(register ull a,register word b){\n\tregister ull ans=1;\n\tfor(;b;b>>=1){\n\t\tif(b&1) (ans*=a)%=mod;\n\t\t(a*=a)%=mod;\n\t}\n\treturn ans;\n}\n//\u9884\u5904\u7406\u5355\u4f4d\u6839\uff0c\u7ffb\u8f6c\u7684 id\n#define loading()\t\t\t\\\n\tregister ull num1=pow(3,(mod-1)>>mx);\t\\\n\tregister ull num2=pow(num1,mod-2);\t\\\n\tregister word head,i,floor;\t\\\n\troot[1<<mx_]=inv[1<<mx_]=1;\t\\\n\tni2=pow(2,mod-2);\t\t\\\n\tfor(i=1;head=i,i<(1<<mx);++i)\t\\\n\t\tfor(floor=0;floor<mx;++floor,head>>=1)\t\\\n\t\t\trealid[i]=realid[i]<<1|(head&1);\t\\\n\tfor(i=1;i<(1<<mx_);++i){\t\\\n\t\troot[1<<mx_|i]=num1*root[1<<mx_|(i-1)]%mod;\t\\\n\t\tinv[1<<mx_|i]=num2*inv[1<<mx_|(i-1)]%mod;\t\\\n\t}\t\\\n\tfor(i=(1<<mx_)-1;i;--i)\t\\\n\t\troot[i]=root[i<<1],inv[i]=inv[i<<1];\n#define load()\t\\\n\tregister ull num1,num2;\\\n\tregister word head,i,floor;\n#define nttfor(size)\t\\\n\tfor(floor=1;floor<1u<<(size);floor<<=1)\t\\\n\t\tfor(head=0;head<1u<<(size);head+=floor<<1)\t\\\n\t\t\tfor(i=0;i<floor;++i)\n//floor \u53d8\u6362\u533a\u95f4\u5927\u5c0f\n//head \u53d8\u6362\u533a\u95f4\u5934\u6307\u9488 \n//i \u53d8\u6362\u4f4d\u7f6e \n#define ntt(num,root)(\t\\\n\tnum1=(num)[head|i],\t\\\n\tnum2=(num)[head|i|floor],\t\\\n\t(num)[head|i]=(num1+((num2*=root[i|floor])%=mod))%mod,\t\\\n\t(num)[head|i|floor]=(num1+mod-num2)%mod)\n#define id(size,i) (realid[i]>>(mx-(size)))\n#define modx(num,size) memset(num+(1<<(size)),0,4<<(size))\n#define set0(num,size) memset(num,0,4<<(size))\n#define FOR(size) for(i=0;i<1u<<(size);i++)\n#define newton(size)\t\\\n\tull ni=ni2,size_=1;\t\\\n\twhile(size_++,ni=ni*ni2%mod,size_-2<(size))\nword in[1<<mx],eax[1<<mx],ebx[1<<mx],ecx[1<<mx],edx[1<<mx];\nword out[1<<mx];\ninline void _1(word size){//\u6c42 eax \u7684\u9006\u5143\uff0c\u653e\u5165 ebx\n\tebx[0]=pow(eax[0],mod-2);\n    load()\n\tnewton(size){\n\t\tFOR(size_-1){\n            head=id(size_,i);\n\t\t\tecx[head]=eax[i]? mod-eax[i]:0;\n\t\t\tedx[head]=ebx[i];\n            head=id(size_,i+(1<<(size_-1)));\n            ecx[head]=edx[head]=0;\n\t\t}\n\t\tnttfor(size_) ntt(ecx,root),ntt(edx,root);\n\t\tFOR(size_) ebx[id(size_,i)]=(ull)(ecx[i])*edx[i]%mod;\n\t\tnttfor(size_) ntt(ebx,inv);\n\t\tmodx(ebx,size_-1);\n\t\tFOR(size_) ecx[id(size_,i)]=ni*ebx[i]%mod;\n\t\tecx[0]=(ecx[0]+2)%mod;\n\t\tnttfor(size_) ntt(ecx,root);\n\t\tFOR(size_) ebx[id(size_,i)]=(ull)(ecx[i])*edx[i]%mod;\n\t\tnttfor(size_) ntt(ebx,inv);\n\t\tmodx(ebx,size_-1);\n\t\tFOR(size_-1) ebx[i]=ni*ebx[i]%mod;\n\t}\n}\ninline void ln(word size){//\u6c42 eax \u7684 ln\uff0c\u653e\u5165 ebx\n\t_1(size);\n    load()\n\tFOR(size){\n        head=id(size+1,i);\n\t\tecx[head]=ebx[i];\n\t\tedx[head]=(ll)(eax[i+1])*(i+1)%mod;\n        head=id(size+1,i+(1<<size));\n        ecx[head]=edx[head]=0;\n\t}\n\tnttfor(size+1) ntt(ecx,root),ntt(edx,root);\n\tFOR(size+1) ebx[id(size+1,i)]=(ull)(ecx[i])*edx[i]%mod;\n\tnttfor(size+1) ntt(ebx,inv);\n\tmodx(ebx,size);\n\tfor(register word i=(1u<<size)-1,ni=pow(1u<<(size+1),mod-2);i>0;i--)\n\t\tebx[i]=pow(i,mod-2)*ebx[i-1]%mod*ni%mod;\n\tebx[0]=0;\n}\ninline void exp(word size){// \u6c42 in \u7684\u9006\u5143\uff0c\u653e\u5165 eax\n\teax[0]=1;\n    load();\n\tnewton(size){\n\t\tln(size_-1);\n\t\tFOR(size_-1){\n            head=id(size_,i);\n\t\t\tecx[head]=eax[i];\n\t\t\tedx[head]=(mod-ebx[i]+in[i])%mod;\n            head=id(size_,i+(1<<(size_-1)));\n            ecx[head]=edx[head]=0;\n\t\t}\n\t\tedx[0]=(1ull+edx[0])%mod;\n\t\tnttfor(size_) ntt(ecx,root),ntt(edx,root);\n\t\tFOR(size_) eax[id(size_,i)]=(ull)(ecx[i])*edx[i]%mod;\n\t\tnttfor(size_) ntt(eax,inv);\n\t\tmodx(eax,size_-1);\n\t\tFOR(size_-1) eax[i]=ni*eax[i]%mod;\n\t}\n}\nint main(){\n\tloading();\n\tword n,size=0;\n\tcin>>n;\n\tfor(;1u<<size<=n+1;size++);\n\tfor(i=0;i<=n;++i)\n\t\tcin>>out[id(size+1,i)];\n\tfor(i=1;i<=n+1;++i)\n\t\tcin>>num1,in[i]=pow(i,mod-2)*num1%mod;\n\texp(size);\n\tFOR(size){\n\t\tecx[id(size+1,i)]=eax[i]? mod-eax[i]:0;\n\t\tecx[id(size+1,i+(1u<<size))]=0;\n\t}\n\tnttfor(size+1) ntt(out,root),ntt(ecx,root);\n\tFOR(size+1) ebx[id(size+1,i)]=(ull)(out[i])*ecx[i]%mod;\n\tnttfor(size+1) ntt(ebx,inv);\n\teax[0]=1;\n\tnum1=pow(1u<<(size+1),mod-2);\n\tfor(i=1;i<1u<<(size);++i)\n\t\teax[i]=pow(i,mod-2)*num1%mod*ebx[i-1]%mod;\n\tln(size);\n\t++in[0];\n\tfor(register word i=0;i<=n;i++)\n\t\tcout<<((ull)(in[i])+mod-ebx[i])%mod<<' ';\n\treturn 0;\n}\n```",
        "postTime": 1621684639,
        "uid": 104726,
        "name": "wangrx",
        "ccfLevel": 7,
        "title": "\u5e38\u6570\u53d8\u6613\u6cd5\u7684\u8bc1\u660e/P6613 \u9898\u89e3"
    },
    {
        "content": "\u4f17\u6240\u5468\u77e5\uff0c\u8fd9\u662f\u4e00\u9053\u6570\u5b66\u9898\n$$\n\\begin{aligned}\n\\frac{\\mathrm{d}F(x)}{\\mathrm{d}x}&=A(x)\\exp(F(x)-1)+B(x)\\\\\n\\frac{\\mathrm{d}y}{\\mathrm{d}x}&=A(x)\\exp(y-1)+B(x)\n\\end{aligned}\n$$\n\u6211\u4eec\u5148\u5206\u79bb\u53d8\u91cf\uff0c\u7528\u53ef\u5206\u79bb\u53d8\u91cf\u65b9\u7a0b\u7684\u65b9\u6cd5\u89e3\n$$\n\\begin{aligned}\n\\frac{\\mathrm{d}y}{\\mathrm{d}x}&=A(x)\\exp(y-1)\\\\\n\\frac{\\mathrm{d}y}{\\exp(y-1)}&=A(x)\\mathrm{d}x\\\\\n\\int\\frac{\\mathrm{d}y}{\\exp(y-1)}&=\\int A(x)\\mathrm{d}x\\\\\n-\\exp(1-y)&=A_1(x)-C\\\\\n\\exp(1-y)&=C-A_1(x)\\\\\n1-y&=\\ln(C-A_1(x))\\\\\ny&=1-\\ln(C-A_1(x))\\\\\ny&=1+\\ln\\frac{1}{C-A_1(x)}\n\\end{aligned}\n$$\n\u5176\u4e2d\n$$\nA_1(x)=\\int A(x)\\mathrm{d}x\n$$\n\u4f7f\u7528\u5e38\u6570\u53d8\u6613\u6cd5\uff0c\u8bbe\n$$\ny=1+\\ln\\frac{1}{C(x)-A_1(x)}\n$$\n\u4ee3\u5165\u539f\u65b9\u7a0b\n$$\n\\begin{aligned}\n\\frac{\\mathrm{d}y}{\\mathrm{d}x}&=A(x)\\exp(y-1)+B(x)\\\\\n-\\frac{C'(x)-A(x)}{C(x)-A_1(x)}&=\\frac{A(x)}{C(x)-A_1(x)}+B(x)\\\\\n\\frac{C'(x)}{C(x)-A_1(x)}&=-B(x)\\\\\n\\frac{\\mathrm{d}C(x)}{\\mathrm{d}x}&=A_1(x)B(x)-B(x)C(x)\\\\\n\\frac{\\mathrm{d}z}{\\mathrm{d}x}&=-B(x)z+A_1(x)B(x)\n\\end{aligned}\n$$\n\u6211\u4eec\u8fd8\u662f\u5148\u5206\u79bb\u53d8\u91cf\uff0c\u7528\u53ef\u5206\u79bb\u53d8\u91cf\u65b9\u7a0b\u7684\u65b9\u6cd5\u89e3\n$$\n\\begin{aligned}\n\\frac{\\mathrm{d}z}{\\mathrm{d}x}&=-B(x)z\\\\\n\\frac{\\mathrm{d}z}{z}&=-B(x)\\mathrm{d}x\\\\\n\\int\\frac{\\mathrm{d}z}{z}&=-\\int B(x)\\mathrm{d}x\\\\\n\\ln z&=-B_1(x)+C\\\\\nz&=C\\exp(-B_1(x))\n\\end{aligned}\n$$\n\u5176\u4e2d\n$$\nB_1(x)=\\int B(x)\\mathrm{d}x\n$$\n\u4f7f\u7528\u5e38\u6570\u53d8\u6613\u6cd5\uff0c\u8bbe\n$$\nz=C_1(x)\\exp(-B_1(x))\n$$\n\u4ee3\u5165\u539f\u65b9\u7a0b\n$$\n\\begin{aligned}\n\\frac{\\mathrm{d}z}{\\mathrm{d}x}&=-B(x)z+A_1(x)B(x)\\\\\nC_1'(x)\\exp(-B_1(x))-C_1(x)\\exp(-B_1(x))B(x)&=-B(x)C_1(x)\\exp(-B_1(x))+A_1(x)B(x)\\\\\nC_1'(x)\\exp(-B_1(x))&=A_1(x)B(x)\\\\\nC_1(x)&=\\int A_1(x)B(x)\\exp(B_1(x))\\mathrm{d}x+C\n\\end{aligned}\n$$\n\u6240\u4ee5\n$$\n\\begin{aligned}\nF(x)&=1+\\ln\\frac{1}{C(x)-A_1(x)}\\\\\n&=1+\\ln\\frac{1}{C_1(x)\\exp(-B_1(x))-A_1(x)}\\\\\n&=1-\\ln(C_1(x)\\exp(-B_1(x))-A_1(x))\\\\\n&=1+B_1(x)-\\ln(C_1(x)-A_1(x)\\exp(B_1(x)))\\\\\n&=1+B_1(x)-\\ln(\\int A_1(x)B(x)\\exp(B_1(x))\\mathrm{d}x-A_1(x)\\exp(B_1(x))+C)\n\\end{aligned}\n$$\n\u53d6 $C=1$ \u5373\u53ef\uff0c\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n\u76ee\u524d~~\u501f\u52a9 EI \u7684\u677f\u5b50~~\u8dd1\u5230\u4e86\u6700\u4f18\u89e3 rk3\uff08\u6253\u4e0d\u8fc7\u534a\u5728\u7ebf\u5377\u79ef\uff09\u3002\n```cpp\nint main(){\n\tint n;IO>>n;\n\tpoly A=zeroes(n),B=zeroes(n);\n\tIO>>A.a>>B.a;\n\tpoly A1=A.integ().slice(n),B1=B.integ().slice(n),expB1=B1.exp();\n\t(1+B1-(((A1*B).slice(n-1)*expB1).slice(n-1).integ()-(A1*expB1).slice(n)+1).ln()).println();\n\treturn 0;\n}\n```",
        "postTime": 1611626523,
        "uid": 121027,
        "name": "Spasmodic",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6613 \u3010\u4e00\u9636\u5fae\u5206\u65b9\u7a0b\u3011"
    },
    {
        "content": "[\u539f\u9898\u94fe\u63a5](https://www.luogu.com.cn/problem/P6613)\n\n\u9898\u610f\uff1a\n\u6c42\u6ee1\u8db3$\\frac{d F(x)}{d x}=A(x)\\times e^{F(x)-1}+B(x)$ \u7684$F(x)$\u7684\u524d$n$\u9879\u7cfb\u6570\uff0c\u4e14$F(0)=1$\n\n\u5f3a\u89e3\u5fae\u5206\u65b9\u7a0b\uff01\n\n\u8bbe$y=F(x),A1(x)=\\int^{}{}{A(x)d x},B1(x)=\\int^{}{}{B(x)d x}$\n\n\u5148\u6c42$\\frac{d y}{d x}=A(x)\\times e^{y-1}$\u7684\u89e3\uff1a\n\n$\\int^{}{}{e^{1-y}dy}$=$\\int^{}{}{A(x)d x}-C$($C\u4e3a\u5e38\u6570$)\n\n$-e^{1-y}=A1(x)-C$\n\n\u56fa$y=1+\\ln{\\frac{1}{C-A1(x)}}$\n\n\n\u518d\u7531\u5e38\u6570\u53d8\u6613\u6cd5\u8bbe$C=u(x)$\n\n\u5219$\\frac{d y}{d x}=(u(x)-A1(x))(\\frac{-1}{(u(x)-A1(x))^2})(\\frac{du(x)}{dx}-A(x))$\n$=\\frac{A(x)-\\frac{du(x)}{dx}}{u(x)-A1(x)}$\n\n\u800c$A(x)e^{F(x)-1}+B(x)=\\frac{A(x)}{u(x)-A1(x)}+B(x)$\n\n\u6240\u4ee5$\\frac{du(x)}{dx}=A1(x)B(x)-u(x)B(x)$\n\n\u518d\u4e00\u6b21\uff0c\u5148\u6c42$\\frac{du(x)}{dx}=-u(x)B(x)$\u7684\u89e3\uff1a\n\n$\\int^{}{}{\\frac{1}{u}du}=-\\int^{}{}{B(x)d x}+D$($D$\u4e3a\u5e38\u6570)\n\n$\\ln(u(x))=-B1(x)+D$\n\n\u56fa$u(x)=e^{-B1(x)}\\times E$\uff08\u5e38\u6570$E=e^D$\uff09\n\n\u518d\u8bbe$E=v(x)$\n\n\u5219$\\frac{du(x)}{dx}=-v(x)B(x)e^{-B1(x)}+\\frac{dv(x)}{dx}e^{-B1(x)}$\n\n\u800c$A1(x)B(x)-u(x)B(x)=-v(x)B(x)e^{-B1(x)}+A1(x)B(x)$\n\n\u4e8e\u662f\u5f97\u5230$\\frac{dv(x)}{dx}=e^{B1(x)}A1(x)B(x)$\n\n\u56e0\u6b64$v(x)=\\int^{}{}{e^{B1(x)}A1(x)B(x)dx}+G$($G$\u4e3a\u5e38\u6570)\n\n\n\u7531\u4e8e$C=u(x)=e^{-B1(x)}v(x)$\n\n\u6240\u4ee5$F(x)=y=1+\\ln{\\frac{1}{e^{-B1(x)}v(x)-A1(x)}}=1+B1(x)-\\ln(v(x)-A1(x)e^{B1(x)})$\n\n$=1+B1(x)-\\ln(\\int^{}{}{e^{B1(x)}A1(x)B(x)dx}-A1(x)e^{B1(x)}+G)$\n\n\u53c8$F(0)=1$,\u53d6$G=1$\u5373\u53ef\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int N=2e6+10;\nconst int mod=998244353;\nint n,g;\nint a[N],b[N];\nint a1[N],b1[N],eb[N];\nint c1[N],c2[N],c[N],d[N],dd[N];\nint tmp[N],tmp1[N];\nint tt[N],t1[N];\nint tln[N],tinv[N];\nint rev[N];\nint inv[N];\nvoid getinv(int n){\n\tinv[1]=1;\n\tfor(int i=2;i<n;i++)inv[i]=(mod-mod/i)*inv[mod%i]%mod;\n}\nint getrev(int n){\n\tint n1=1,len=0;\n\twhile(n1<(n<<1))n1<<=1,len++;\n\tfor(int i=0;i<n1;i++)rev[i]=(rev[i>>1]>>1)|((i&1)<<(len-1));\n\treturn n1;\n}\nint qpow(int x,int k){\n\tint cnt=1;\n\twhile(k){\n\t\tif(k&1)cnt=(cnt*x)%mod;\n\t\tx=(x*x)%mod;\n\t\tk>>=1;\n\t}\n\treturn cnt;\n}\nvoid integral(int n,int *x,int *y){\n\tfor(int i=1;i<n;i++)y[i]=x[i-1]*inv[i]%mod;\n\ty[0]=0;\n} \nvoid ntt(int n,int *a,int t){\n\tfor(int i=0;i<n;i++)if(i<rev[i])swap(a[i],a[rev[i]]);\n\tif(t==1)g=3;\n\telse g=332748118;\n\tfor(int mid=1;mid<n;mid<<=1){\n\t\tint wn=qpow(g,(mod-1)/(mid<<1));\n\t\tfor(int j=0;j<n;j+=(mid<<1)){\n\t\t\tint w=1;\n\t\t\tfor(int k=0;k<mid;k++){\n\t\t\t\tint x=a[j+k],y=w*a[j+k+mid]%mod;\n\t\t\t\ta[j+k]=(x+y)%mod;\n\t\t\t\ta[j+k+mid]=(x-y+mod)%mod;\n\t\t\t\tw=w*wn%mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(t==1)return;\n\tint inv=qpow(n,mod-2);\n\tfor(int i=0;i<n;i++)a[i]=a[i]*inv%mod;\n}\nvoid polyinv(int n,int *f,int *g){\n\tif(n==1){\n\t\tg[0]=qpow(f[0],mod-2);\n\t\treturn;\n\t}\n\tpolyinv((n+1)>>1,f,g);\n\tint n1=getrev(n);\n\tfor(int i=0;i<n;i++)tmp[i]=f[i];\n\tfor(int i=n;i<n1;i++)tmp[i]=0;\n\tntt(n1,tmp,1);\n\tntt(n1,g,1);\n\tfor(int i=0;i<n1;i++)g[i]=(2ll-tmp[i]*g[i]%mod+mod)%mod*g[i]%mod;\n\tntt(n1,g,-1);\n\tfor(int i=n;i<n1;i++)g[i]=0;\n}\nvoid polyln(int n,int *ff,int *gg){\n\tint n1=getrev(n);\n\tfor(int i=0;i<n;i++)tt[i]=(i+1)*ff[i+1]%mod;\n\tfor(int i=n;i<n1;i++)tt[i]=0,gg[i]=0;\n\tpolyinv(n,ff,gg);\n\tntt(n1,gg,1);\n\tntt(n1,tt,1);\n\tfor(int i=0;i<n1;i++)tt[i]=tt[i]*gg[i]%mod;\n\tntt(n1,tt,-1);\n\tintegral(n,tt,gg);\n\tfor(int i=n;i<n1;i++)gg[i]=0;\n}\nvoid polyexp(int n,int *f1,int *g1){\n\tif(n==1){\n\t\tg1[0]=1;\n\t\treturn;\n\t}\n\tpolyexp((n+1)>>1,f1,g1);\n\tint n1=getrev(n);\n\tfor(int i=0;i<n;i++)tmp1[i]=f1[i],tln[i]=0;\n\tfor(int i=n;i<n1;i++)tmp1[i]=0,tln[i]=0,g1[i]=0;\n\tpolyln(n,g1,tln);\n\ttmp1[0]=1;\n\tfor(int i=0;i<n;i++)tmp1[i]=(tmp1[i]-tln[i]+mod)%mod;\n\tntt(n1,g1,1);\n\tntt(n1,tmp1,1);\n\tfor(int i=0;i<n1;i++)g1[i]=g1[i]*tmp1[i]%mod;\n\tntt(n1,g1,-1);\n\tfor(int i=n;i<n1;i++)g1[i]=0;\n}\nsigned main(){\n\tscanf(\"%d\",&n),n++;\n\tfor(int i=0;i<n;i++)scanf(\"%d\",&a[i]);\n\tfor(int i=0;i<n;i++)scanf(\"%d\",&b[i]);\n\tint n1=getrev(n);\n\tgetinv(n);\n\tintegral(n,a,a1),integral(n,b,b1);\n\tpolyexp(n,b1,eb);\n\tntt(n1,eb,1),ntt(n1,a1,1);\n\tfor(int i=0;i<n1;i++)c2[i]=a1[i]*eb[i]%mod;\n\tntt(n1,c2,-1);\n\tfor(int i=n;i<n1;i++)c2[i]=0;\n\tntt(n1,c2,1);\n\tntt(n1,b,1);\n\tfor(int i=0;i<n1;i++)c1[i]=c2[i]*b[i]%mod;\n\tntt(n1,c1,-1);\n\tintegral(n,c1,d);\n\tntt(n1,c2,-1);\n\tfor(int i=0;i<n;i++)d[i]=(d[i]-c2[i]+mod)%mod;\n\td[0]=1;\n\tpolyln(n,d,dd);\n\tfor(int i=0;i<n;i++)c[i]=(b1[i]-dd[i]+mod)%mod;\n\tc[0]=(c[0]+1)%mod;\n\tfor(int i=0;i<n;i++)printf(\"%d \",c[i]);\n}\n```",
        "postTime": 1610727688,
        "uid": 334380,
        "name": "Y_B_X",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6613 \u3010\u4e00\u9636\u5fae\u5206\u65b9\u7a0b\u3011"
    },
    {
        "content": "\u778e\u641e\u5b8c\u4e86\u624d\u53d1\u73b0\uff0c\u9898\u89e3\u91cc\u7adf\u7136\u6ca1\u4eba\u548c\u6211\u6709\u76f8\u540c\u7684\u60f3\u6cd5\u3002\n\n~~\u63d0\u4ea4\u91cc\u90a3\u4e9b\u5206\u6cbb\u4ee3\u7801\u6211\u770b\u4e0d\u61c2\uff0c\u770b\u7740\u597d\u7384\u5b66\u3002\u54ea\u4f4d dalao \u80fd\u591f\u6559\u6559\u6211~~\n\n\u5206\u6790\u4e00\u4e0b\u96be\u70b9\uff0c\u6211\u4eec\u4e4b\u6240\u4ee5\u96be\u7b97\uff0c\u5c31\u662f\u56e0\u4e3a\u8fd9\u4e2a\u95ee\u9898\u91cc\u6709 $e^x$\u3002\n\n$$\nF' = A \\ast e^{F - 1} + B\n$$\n\n\u90a3\u4e48\u628a\u5b83\u6362\u6389\u5c31\u597d\u5566\u3002\u4ee4 $H = \\frac{1}{e^{F-1}}$\uff0c\u53ef\u4ee5\u53d1\u73b0\n\n$$\nH' = -\\frac{F'}{e^{F-1} } = -F' \\ast H\n$$\n\n\u628a\u6240\u6709 $F$ \u6362\u6389\uff0c\u53ef\u4ee5\u5f97\u5230\n\n$$\n-H' = A + B \\ast H\n$$\n\n\u8fd9\u4e2a\u5f62\u5f0f\u53ef\u4ee5\u65b9\u4fbf\u7684\u534a\u5728\u7ebf\u5377\u79ef\u3002\n\n$$\n-(n+1)H_{n+1} = \\sum_{i=0}^n B_i H_{n-i} + A_n\n$$\n\n\u81f3\u4e8e\u8fd8\u539f $H$\uff0c\u5176\u5b9e\u4e0d\u7528\u6c42\u9006\uff0c\u56e0\u4e3a\u6709\n\n$$\nF = 1 + \\ln\\frac{1}{H} = 1 - \\ln H\n$$\n\n\u4e8e\u662f\u53ef\u4ee5\u5199\u51fa\u4ee3\u7801\n\n```cpp\nint main() {\n    int n = rr() + 1;\n    Poly A(n), B(n);\n    for (int i = 0; i < n; i++)\n        A[i] = rr();\n    for (int i = 0; i < n; i++)\n        B[i] = rr();\n    pre_inv(n);\n\n    // -DH = A + B * H, H = 1 / exp(F - 1)\n    PolyCDQ DH(B);\n    DH.G[0] = 1;\n    for (int i = 1; i < n; i++) {\n    \tDH.next();\n        DH.G[i] = -(DH.conv[i - 1] + A[i - 1]) * Inv[i];\n    }\n    \n    Poly F = Poly{1} - DH.G.ln();\n    for (int i = 0; i < n; i++)\n        printf(\"%d \", F[i].v);\n    return 0;\n}\n```\n\n\u5168\u90e8\u4ee3\u7801\u53ef\u4ee5\u770b\u6211\u7684[\u63d0\u4ea4](https://www.luogu.com.cn/record/65441752)\uff0c[\u4e8c\u53c9](https://www.luogu.com.cn/record/65442192)\u5199\u6cd5\u4e5f\u8fd8\u7b97\u5feb\u3002\n\n\u82e5\u4ee4 $H = e^{F-1}$\uff0c\u5219\u6709\u4e24\u4e2a\u7f20\u5728\u4e00\u8d77\u7684\u5377\u79ef\u5f0f\uff0c\u9700\u8981\u4e00\u4e2a\u5728\u7ebf\u7684\u548c\u4e00\u4e2a\u534a\u5728\u7ebf\u7684\u3002\n\n\u56e0\u4e3a $\\ln$ \u4e5f\u76f8\u5f53\u4e8e\u662f\u4e00\u6b21\u534a\u5728\u7ebf\u5377\u79ef\uff0c\u6211\u8fd9\u79cd\u65b9\u6cd5\u5408\u8ba1\u662f\u4e24\u6b21\u534a\u5728\u7ebf\uff0c\u5feb\u4e0d\u5c11\u3002\n\n\n",
        "postTime": 1639974083,
        "uid": 112362,
        "name": "rogeryoungh",
        "ccfLevel": 0,
        "title": "P6613 \u9898\u89e3"
    },
    {
        "content": "\u5f0f\u5b50\u9c7c\u9c7c\u90fd\u7ed9\u7684\u5f88\u6e05\u695a\u4e86\uff0c\u6709\n\n$$\n\\begin{aligned}\n&F(x) \\equiv \\frac 1{P(x)}\\left(\\int P(x)(G(F_0(x))-G'(F_0(x))F_0(x))\\mathrm{d}x+1\\right)\\pmod {x^n} \\\\\n&P(x)=\\exp\\left(\\int -G'(F_0(x))\\mathrm{d}x\\right)\n\\end{aligned}\n$$\n\n\u8bb2\u4e00\u4e0b\u4e00\u4e2a\u5bb9\u6613\u9519\u7684\u5730\u65b9\n\n$$\nG'(F_0(x))=A(x)e^{F_0(x)-1}\n$$\n\n$A(x),B(x)$ \u770b\u4f5c\u5e38\u9879\uff0c\u540e\u9762\u6ca1\u6709 $F_0'(x)$\u3002\n\n\u81f3\u4e8e\u8fd9\u4e1c\u897f\u6709\u4ec0\u4e48\u7528\uff0c\u8fd8\u662f\u5f97\u770b EGF \u90a3\u4e00\u5957\u63a8\u5bfc\u3002\u6c42\u5bfc\u53ef\u4ee5\u62b9\u53bb\u4e00\u4e2a\u6807\u53f7\uff0c\u540c\u7406\u79ef\u5206\u53ef\u4ee5\u589e\u52a0\u4e00\u4e2a\u6807\u53f7\uff0c\u6bd4\u5982\u6709\u6807\u53f7\u65e0\u6839\u975e\u5e73\u9762 $k$ \u53c9\u6811\u7684 EGF \u4e3a\n\n$$\nT=\\int (xT')^k\n$$\n\n\u7ed9\u4e2a\u9012\u5f52\u7248\u7684\u4ee3\u7801\u5427\uff0c\u4e00\u5343\u4e2a\u4eba\u6709\u4e00\u5343\u4e2a\u591a\u9879\u5f0f\u677f\u5b50\uff0c\u4ec5\u4f9b\u53c2\u8003\n\n```cpp\n#pragma GCC optimize(2,3,\"Ofast\")\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define db double\n#define in inline\nnamespace fast_io\n{\n\tchar buf[1<<12],*p1=buf,*p2=buf,sr[1<<23],z[23],nc;int C=-1,Z=0,Bi=0,ny;\n\tin char gc() {return p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<12,stdin),p1==p2)?EOF:*p1++;}\n\tin int read()\n\t{\n\t\tint x=0;ny=1;while(nc=gc(),(nc<48||nc>57)&&nc!=EOF)if(nc==45)ny=-1;Bi=1;if(nc<0)return nc;\n\t\tx=nc-48;while(nc=gc(),47<nc&&nc<58&&nc!=EOF)x=(x<<3)+(x<<1)+(nc^48),Bi++;return x*ny;\n\t}\n\tin db gf() {int a=read(),y=ny,b=(nc!='.')?0:read();return (b?a+(db)b/pow(10,Bi)*y:a);}\n\tin int gs(char *s) {char c,*t=s;while(c=gc(),c<=32);*s++=c;while(c=gc(),c>32)*s++=c;return s-t;}\n\tin void ot() {fwrite(sr,1,C+1,stdout);C=-1;}\n\tin void flush() {if(C>1<<22) ot();}\n\ttemplate <typename T>\n\tin void write(T x,char t)\n\t{\n\t\tint y=0;if(x<0)y=1,x=-x;while(z[++Z]=x%10+48,x/=10);\n\t\tif(y)z[++Z]='-';while(sr[++C]=z[Z],--Z);sr[++C]=t;flush();\n\t}\n\tin void write(char *s) {int l=strlen(s);for(int i=0;i<l;i++)sr[++C]=*s++;sr[++C]='\\n';flush();}\n};\nusing namespace fast_io;\n#define init(x,n) static int x[N];memset(x,0,4*n);\nconst int N=4e5+5,p=998244353,mod=p,G=3;\nint n,m,ans,len,L,a[N],b[N],c[N],fac[N],inv[N];\nin void M(int&x) {x-=p,x+=x>>31&p;}\nin int add(int x,int y) {return M(x+=y),x;}\nin int sub(int x,int y) {return M(x-=y),x;}\nin int qpow(int x,int y) {int z=1;for(;y;y>>=1,x=1ll*x*x%p) if(y&1) z=1ll*x*z%p;return z;}\nin void read(int *a,int n) {for(int i=0;i<n;i++) a[i]=read();}\nin void print(int *a,int n) {for(int i=0;i<n;i++) write(a[i],\" \\n\"[i==n-1]);}\nin void pre()\n{\n\tfac[0]=fac[1]=inv[0]=inv[1]=1;for(int i=2;i<N;i++) inv[i]=1ll*(p-p/i)*inv[p%i]%p;\n\tfor(int i=2;i<N;i++) inv[i]=1ll*inv[i]*inv[i-1]%p,fac[i]=1ll*fac[i-1]*i%p;\n}\nnamespace poly\n{\n\tint r[N],ny[N],o[N],_o[N];\n\tin int qpow(int x,int y) {int z=1;for(;y;y>>=1,x=1ll*x*x%p) if(y&1) z=1ll*x*z%p;return z;}\n\tin void inter(int *a,int n) {for(int i=n-1;i;i--) a[i]=1ll*a[i-1]*qpow(i,p-2)%p;a[0]=0;}\n\tin void direv(int *a,int n) {for(int i=1;i<n;i++) a[i-1]=1ll*a[i]*i%p;a[n-1]=0;}\n\tin void calrev(int len,int L)\n\t{\n\t\tfor(int i=1;i<=len;i++) r[i]=(r[i>>1]>>1)|((i&1)<<(L-1));\n\t\to[0]=1;o[1]=qpow(G,(p-1)/len);\n\t\tfor(int i=2;i<=len;i++) o[i]=1ll*o[1]*o[i-1]%p;\n\t\tfor(int i=0;i<len;i++) _o[i]=o[len-i];\n\t}\n\tin void ntt(int *a,int n,int op)\n\t{\n\t\tfor(int i=0;i<n;i++) if(i<r[i]) swap(a[i],a[r[i]]);int *w=(op==1)?o:_o;\n\t\tfor(int i=1;i<n;i<<=1) for(int j=0,d=i<<1;j<n;j+=d) for(int k=0,x,y;k<i;k++)\n\t\tx=a[j|k],y=1ll*w[n/(i<<1)*k]*a[i|j|k]%p,M(a[j|k]=x+y),M(a[i|j|k]=x+p-y);\n\t\tif(op==1) return; int inv=qpow(n,p-2);for(int i=0;i<n;i++) a[i]=1ll*a[i]*inv%p;\n\t}\n\tin void mul(int *a,int *b,int l1,int l2,int n,int *c=0)\n\t{\n\t\tif(c==0) c=a;if((int)ceil(log2(l1+l2-1))^L) L=ceil(log2(l1+l2-1)),calrev(len=1<<L,L);\n\t\tinit(x,len);memcpy(x,a,4*l1);init(y,len);memcpy(y,b,4*l2);\n\t\tntt(x,len,1);ntt(y,len,1);for(int i=0;i<len;i++) c[i]=1ll*x[i]*y[i]%p;\n\t\tntt(c,len,-1);memset(c+n,0,4*(len-n));\n\t}\n\tvoid inv(int *a,int *b,int n)\n\t{\n\t\tif(n==1) return b[0]=qpow(a[0],p-2),void();\n\t\tinv(a,b,(n+1)>>1);L=ceil(log2(2*n));\n\t\tcalrev(len=1<<L,L);init(c,len);memcpy(c,a,4*n);ntt(b,len,1);ntt(c,len,1);\n\t\tfor(int i=0;i<len;i++) b[i]=(2ll-1ll*b[i]*c[i]%p+p)%p*b[i]%p;\n\t\tntt(b,len,-1);memset(b+n,0,4*(len));\n\t}\n\tin void inv(int *a,int n) {init(b,n<<1);inv(a,b,n);memcpy(a,b,4*n);memset(b,0,4*len);}\n\tin void ln(int *a,int n)\n\t{\n\t\tinit(b,n<<1);memcpy(b,a,4*n);direv(b,n);inv(a,n);\n\t\tmul(a,b,n,n,n);inter(a,n);memset(a+n,0,4*len/2);\n\t}\n\tvoid exp(int *a,int *b,int n)\n\t{\n\t\tif(n==1) return b[0]=1,void();\n\t\texp(a,b,(n+1)>>1);init(c,n<<1);memcpy(c,b,4*n);ln(c,n);\n\t\tfor(int i=0;i<n;i++) c[i]=((1ll*a[i]-c[i]+(i==0))%p+p)%p;mul(b,c,n,n,n);\n\t}\n\tin void exp(int *a,int n) {init(b,n<<1);exp(a,b,n);memcpy(a,b,4*n);memset(b,0,4*len);}\n\tin void div(int *a,int *b,int n,int m)\n\t{\n\t\tinit(c,n<<1);memcpy(c,a,4*n);init(d,n<<1);memcpy(d,b,4*m);\n\t\treverse(c,c+n);reverse(b,b+m);inv(b,n-m+1);\n\t\tmul(c,b,n<<1,n<<1,n);reverse(c,c+n-m+1);memset(c+(n-m+1),0,4*(m-1));\n\t\tmul(d,c,n<<1,n<<1,n);for(int i=0;i<m;i++) b[i]=((a[i]-d[i])%p+p)%p;\n\t\tmemcpy(a,c,4*n);\n\t}\n\tin void sqrt(int *a,int *b,int n)\n\t{\n\t\tif(n==1) return b[0]=1,void();\n\t\tsqrt(a,b,(n+1)>>1);init(c,n<<1);init(d,n<<1);memcpy(c,b,4*n);memcpy(d,a,4*n);inv(c,n);\n\t\tL=ceil(log2(n*2));len=1<<L;calrev(len,L);ntt(b,len,1);ntt(c,len,1);ntt(d,len,1);\n\t\tfor(int i=0;i<len;i++) b[i]=(1ll*b[i]+1ll*c[i]*d[i]%p)%p*qpow(2,p-2)%p;\n\t\tntt(b,len,-1);memset(b+n,0,4*(len>>1));\n\t}\n\tin void sqrt(int *a,int n) {init(b,n<<1);sqrt(a,b,n);memcpy(a,b,4*n);}\n\tint *f[N],*g[N],bin[N<<3],*np(bin);\n\tvoid eva_init(int p,int l,int r,int *a)\n\t{\n\t\tg[p]=np;np+=r-l+2;f[p]=np;np+=r-l+2;if(l==r) return g[p][0]=1,M(g[p][1]=mod-a[l]);\n\t\tint ls=p<<1,rs=ls|1,mid=(l+r)>>1,l1=mid-l+2,l2=r-mid+1;\n\t\teva_init(ls,l,mid,a);eva_init(rs,mid+1,r,a);\n\t\tmul(g[ls],g[rs],l1,l2,l1+l2-1,g[p]);\n\t}\n\tin void eva_mul(int *a,int *b,int l1,int l2,int n,int *c)\n\t{\n\t\tif(c==0) c=a;if((int)ceil(log2(l1+l2-1))^L) L=ceil(log2(l1+l2-1)),calrev(len=1<<L,L);\n\t\tinit(x,len);memcpy(x,a,4*l1);init(y,len);memcpy(y,b,4*l2);reverse(y,y+l2);\n\t\tntt(x,len,1);ntt(y,len,1);for(int i=0;i<len;i++) x[i]=1ll*x[i]*y[i]%p;\n\t\tntt(x,len,-1);memcpy(c,x+l2-1,4*(l1-l2+1));\n\t}\n\tvoid eva_work(int p,int l,int r,int *a)\n\t{\n\t\tif(l==r) return a[l]=f[p][0],void();\n\t\tint ls=p<<1,rs=ls|1,mid=(l+r)>>1,lp=r-l+1,l1=mid-l+2,l2=r-mid+1;\n\t\teva_mul(f[p],g[rs],lp,l2,lp+l2-1,f[ls]);eva_work(ls,l,mid,a);\n\t\teva_mul(f[p],g[ls],lp,l1,lp+l1-1,f[rs]);eva_work(rs,mid+1,r,a);\n\t}\n\tin void eva(int *a,int *b,int n,int m,int *c)\n\t{\n\t\tinit(x,n);init(y,n);eva_init(1,0,m-1,b);inv(g[1],x,m+1);\n\t\treverse(x,x+m+1);mul(a,x,n,m+1,n+m,y);\n\t\tmemcpy(f[1],y+n,4*(m+1));eva_work(1,0,m-1,c);\n\t\tfor(int i=0;i<m;i++) M(c[i]=1ll*b[i]*c[i]%p+a[0]);\n\t}\n\tin void sin(int *a,int n)\n\t{\n\t\tstatic const int i=qpow(G,(p-1)/4);for(int j=0;j<n;j++) a[j]=1ll*a[j]*i%p;\n\t\tinit(b,n<<1);for(int j=0;j<n;j++) M(b[j]=-a[j]);\n\t\texp(a,n);exp(b,n);for(int j=0;j<n;j++) a[j]=1ll*sub(a[j],b[j])*qpow(2*i,p-2)%p;\n\t}\n\tin void cos(int *a,int n)\n\t{\n\t\tstatic const int i=qpow(G,(p-1)/4);for(int j=0;j<n;j++) a[j]=1ll*a[j]*i%p;\n\t\tinit(b,n<<1);for(int j=0;j<n;j++) b[j]=-a[j];\n\t\texp(a,n);exp(b,n);for(int j=0;j<n;j++) a[j]=1ll*add(a[j],b[j])*qpow(2,p-2)%p;\n\t}\n\tin void arcsin(int *a,int n)\n\t{\n\t\tinit(b,n<<1);memcpy(b,a,4*n);direv(a,n);\n\t\tmul(b,b,n,n,n);for(int i=0;i<n;i++) b[i]=p-b[i];b[0]++;\n\t\tsqrt(b,n);inv(b,n);mul(a,b,n,n,n);inter(a,n);\n\t}\n\tin void arctan(int *a,int n)\n\t{\n\t\tinit(b,n<<1);memcpy(b,a,4*n);direv(a,n);\n\t\tmul(b,b,n,n,n);b[0]++;inv(b,n);mul(a,b,n,n,n);inter(a,n);\n\t}\n\tin void qpow(int *a,int n,int k) {ln(a,n);for(int i=0;i<n;i++) a[i]=1ll*a[i]*k%p;exp(a,n);}\n\tin int lagrange(int *a,int n,int k) \n    {\n    \tinit(b,n);inv(a,b,n);qpow(b,n,k);\n        return 1ll*b[k-1]*qpow(k,p-2)%p;\n    }\n\tin void G(int *f,int *a,int *b,int n) \n    {\n    \tM(f[0]+=p-1);exp(f,n);mul(f,a,n,n,n);\n        for(int i=0;i<n;i++) M(f[i]+=b[i]);\n    }\n\tin void direv(int *a,int *b,int *c,int n)\n\t{\n\t\tif(n==1) return c[0]=1,void();direv(a,b,c,(n+1)>>1);\n\t\tinit(d,n<<1);memcpy(d,c,4*n);G(d,a,b,n);\n        init(d1,n<<1);memcpy(d1,d,4*n);for(int i=0;i<n;i++) M(d1[i]+=p-b[i]);\n\t\tinit(h,n<<1);memcpy(h,d1,4*n);mul(h,c,n,n,n);for(int i=0;i<n;i++) M(h[i]=d[i]+p-h[i]);\n\t\tinit(P,n<<1);for(int i=0;i<n;i++) P[i]=p-d1[i];inter(P,n);exp(P,n);\n\t\tmul(h,P,n,n,n);inter(h,n);M(h[0]+=1);inv(P,n);mul(h,P,n,n,n);memcpy(c,h,4*n);\n\t}\n}\nint main()\n{\n\tn=read()+1;read(a,n);read(b,n);\n\tpoly::direv(a,b,c,n);print(c,n);\n\treturn ot(),0;\n}\n//Author: disangan233\n//Welcome to the Phigros!\n```",
        "postTime": 1591946119,
        "uid": 72679,
        "name": "disangan233",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6613 \u3010\u4e00\u9636\u5fae\u5206\u65b9\u7a0b\u3011"
    },
    {
        "content": "\u6211\u7ec8\u4e8e\u4f1a\u4e86\uff01\u6211\u7ec8\u4e8e\u4f1a\u4e86\uff01\u6211\u7ec8\u4e8e\u4f1a\u4e86\uff01\n\n\u6559\u6388\u53ea\u8bb2\u4e86\u4e00\u9636\u9f50\u6b21\u5fae\u5206\u65b9\u7a0b\uff0c\u6211\u5c45\u7136\u628a\u4e00\u9636\u5fae\u5206\u65b9\u7a0b\u7684\u89e3 yy \u51fa\u6765\u4e86\u3002\n\n\u9898\u610f\uff1a\u6c42\u65b9\u7a0b\u7684\u901a\u89e3\n\n$$\\frac{\\text{d}y}{\\text{d}x}=A(x)e^{y-1}+B(x)$$\n\n\u5148\u89e3\n\n$$\\frac{\\text{d}y}{\\text{d}x}=A(x)e^{y-1}$$\n\n$$\\int e^{1-y}\\text{d}y=\\int A(x)\\text{d}x$$\n\n$$-e^{1-y}=\\int A(x)\\text{d}x+C$$\n\n$$y=1-\\ln(-\\int A(x)\\text{d}x-C)$$\n\n\u4f7f\u7528\u5e38\u6570\u53d8 yee \u6cd5\uff0c\u4ee4 $C$ \u4e3a\u5173\u4e8e $x$ \u7684\u51fd\u6570 $C(x)$\u3002\n\n$$\\frac{\\text{d}(1-\\ln(-\\int A(x)\\text{d}x-C(x)))}{\\text{d}x}=\\frac{A(x)}{-\\int A(x)\\text{d}x-C(x)}+B(x)$$\n$${\\text{d}(\\ln(-\\int A(x)\\text{d}x-C(x)))}=\\frac{A(x)\\text{d}x}{\\int A(x)\\text{d}x+C(x)}-B(x)\\text{d}x$$\n$${\\frac{\\text{d}(\\int A(x)\\text{d}x+C(x))}{\\int A(x)\\text{d}x+C(x)}}=\\frac{A(x)\\text{d}x}{\\int A(x)\\text{d}x+C(x)}-B(x)\\text{d}x$$\n$${\\frac{\\text{d}C(x)}{\\int A(x)\\text{d}x+C(x)}}=-B(x)\\text{d}x$$\n$$\\frac{\\text{d}C(x)}{\\text{d}x}+B(x)C(x)=-B(x)\\int A(x)\\text{d}x$$\n\n\u5bf9\u4e8e\u65b9\u7a0b\n\n$$\\frac{\\text{d}y}{\\text{d}x}+P(x)y=Q(x)$$\n\n\u6709\u901a\u89e3\n\n$$y=e^{-\\int P(x)\\text{d}x}(\\int Q(x)e^{\\int P(x)\\text{d}x}\\text{d}x+C)$$\n\n\u5bf9\u4e8e\u8fd9\u4e2a\u901a\u89e3\u7684\u89e3\u6cd5\u6709\u4e24\u79cd\uff1a\n\n\u7b2c\u4e00\u79cd\uff1a\u4e24\u8fb9\u540c\u4e58 $e^{\\int P(x)\\text{d}x}$\n\n$$\\frac{\\text{d}(ye^{\\int P(x)\\text{d}x})}{\\text{d}x}=Q(x)e^{\\int P(x)\\text{d}x}$$\n\n$$ye^{\\int P(x)\\text{d}x}=\\int Q(x)e^{\\int P(x)\\text{d}x}\\text{d}x+C$$\n\n\u5c31\u80fd\u89e3\u4e86\u3002\n\n\u7b2c\u4e8c\u79cd\uff1a\u5e38\u6570\u53d8\u6613\u6cd5\n\n\u5bf9\u4e8e\u65b9\u7a0b $\\dfrac{\\text{d}y}{\\text{d}x}+P(x)y=0$\n\n\u8f83\u6613\u6c42\u89e3\uff1a\n\n$$\\frac{\\text{d}y}{y}=-P(x)\\text{d}x$$\n\n$$y=Ce^{-\\int P(x)\\text{d}x}$$\n\n\u6b64\u65f6\u4ee4 $C$ \u4e3a\u5173\u4e8e $x$ \u7684\u51fd\u6570 $C(x)$\n\n$$\\frac{\\text{d}(C(x)e^{-\\int P(x)\\text{d}x})}{\\text{d}x}+P(x)C(x)e^{-\\int P(x)\\text{d} x}=Q(x)$$\n\u5316\u7b80\u5f97\n\n$$\\frac{\\text{d}C(x)}{\\text{d}x}=Q(x)e^{\\int P(x)\\text{d}x}$$\n$$C(x)=\\int Q(x)e^{\\int P(x)\\text{d}x}\\text{d}x+C$$\n\n\u56de\u4ee3\u5373\u53ef\u5f97\u5230\n\n$$y=e^{-\\int P(x)\\text{d}x}(\\int Q(x)e^{\\int P(x)\\text{d}x}\\text{d}x+C)$$\n\n\u4ee3\u5165\u53ef\u5f97\n\n$$C(x)=e^{-\\int B(x)\\text{d}x}(\\int-B(x)\\int A(x)\\text{d}xe^{\\int B(x)\\text{d}x}\\text{d}x+C)$$\n\n$$y=1-\\ln(-\\int A(x)\\text{d}x-e^{-\\int B(x)\\text{d}x}(\\int-B(x)\\int A(x)\\text{d}xe^{\\int B(x)\\text{d}x}\\text{d}x+C))$$",
        "postTime": 1669626828,
        "uid": 100325,
        "name": "peterwuyihong",
        "ccfLevel": 7,
        "title": "P6613 \u4e00\u9636\u5fae\u5206\u65b9\u7a0b \u8bb0\u5f55"
    }
]
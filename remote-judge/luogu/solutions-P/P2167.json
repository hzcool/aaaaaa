[
    {
        "content": "# \u5168\u7f51\u552f\u4e00\u4e00\u7bc7\u5bb9\u65a5\u9898\u89e3\n\u5b89\u5229\u535a\u5ba2 \uff1a[[SDOI2009]Bill\u7684\u6311\u6218\u2014\u2014\u5927\u529b\u5bb9\u65a5](https://www.cnblogs.com/Miracevin/p/9585609.html)\n\n\u770b\u5230\u8fd9\u4e2a\u9898\uff0c\u5927\u90e8\u5206\u4eba\u60f3\u7684\u662f\u72b6\u538bdp\n\n\u4f46\u662f\u6211\u662f\u4e2a\u849f\u84bb\u6ca1\u60f3\u5230\uff0c\u5c31\u7528\u5bb9\u65a5\u5207\u6389\u4e86\u3002\n\n\u5e76\u4e14\u590d\u6742\u5ea6\u6bd4\u4e00\u822c\u72b6\u538b\u4f4e\uff0c\n\n\u76ee\u524d\u662fluogu rank1 \uff08\u867d\u7136\u5f00\u4e86O2\uff0c\u4f46\u662f\u5927\u5bb6\u90fd\u5f00\u4e86\u554a\uff09\n\n\uff08\u5176\u5b9e\u8fd9\u4e2a\u5bb9\u65a5\u7684\u7b97\u6cd5\uff0c\u63d0\u51fa\u6765\u6e90\u4e8eywy_c_asm\uff09\n\n\uff08\u7136\u800c\u6211\u77e5\u9053\u4e86\u8fd9\u4e2a\u7b97\u6cd5\uff0c\u7adf\u7136\u548c\u4ed6\u5199\u7684\u4e0d\u4e00\u6837\uff0c\u800c\u4e14\u6bd4\u4ed6\u8dd1\u7684\u5feb\uff09\n\n\u8fdb\u5165\u6b63\u9898\uff1a\n\n\u6211\u4eec\u9700\u8981\u7edf\u8ba1\u6070\u597d\u6ee1\u8db3\u5339\u914dk\u4e2a\u7684\u60c5\u51b5\u3002\n\n\u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u627e\u51fa\u6765\uff0c\u6070\u597d\u6ee1\u8db3n\u4e2a\uff0cn-1\uff0cn-2\u3002\u3002\u3002k\u4e2a\u7684\u60c5\u51b5\u3002\n\n\u5206\u522b\u8bb0\u4e3aans[i]\n\nans[i]\u600e\u4e48\u7b97\u5462\uff1f\n\n\u5148\u7ed9\u51fa\u516c\u5f0f\uff1a\n\n### ans[i]=cal(i)-\u2211C(j,i)\u00d7ans[j] \u5176\u4e2d\uff0ci+1<=j<=n\n\ncal(i)\u8868\u793a\uff0c\u4ecen\u4e2a\u4e2d\u4efb\u610f\u9009\u62e9i\u4e2a\uff0c\u5bf9\u4e8e\u6240\u6709\u9009\u62e9\u7684\u60c5\u51b5\uff0c\u7684\u65b9\u6848\u6570\u7684\u548c\u3002\n\ncal(i)\u53ef\u4ee5dfs\u66b4\u529bC(n,i)\u679a\u4e3e\uff0c\u6bcf\u6b21\u7edf\u8ba1\u7b54\u6848\u3002\u8ba1\u5165tot\n\n```cpp\nvoid dfs(int x,int has){\n\tif(x==n+1){\n\t\tif(has!=up) return;\n\t\tll lp=1;\n\t\tfor(int j=1;j<=len;j++){\n\t\t\tlas=-1;\n\t\t\tfor(int i=1;i<=up;i++){\n\t\t\t\tif(a[mem[i]][j]!='?'){\n\t\t\t\t\tif(las==-1){\n\t\t\t\t\t\tlas=a[mem[i]][j]-'a';\n\t\t\t\t\t}\n\t\t\t\t\telse if(las!=a[mem[i]][j]-'a') return;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(las==-1)lp=(lp*26)%mod;\n\t\t}\n\t\t(tot+=lp)%=mod;\n\t\treturn;\n\t}\n\tif(has<up) {\n\t\tmem[++cnt]=x;\n\t\tdfs(x+1,has+1);\n\t\tmem[cnt--]=0;\n\t}\n\tif(n-x>=up-has) dfs(x+1,has);\n}\n```\n\n\u81f3\u4e8e\u540e\u9762\u51cf\u53bb\u7684\u90e8\u5206\u3002\u5c31\u662f\u5bb9\u65a5\u7684\u5185\u5bb9\u4e86\u3002\n\n\u5927\u5bb6\u53ef\u4ee5\u81ea\u5df1\u753b\u4e00\u4e2a\u97e6\u6069\u56fe\u7406\u89e3\u4e00\u4e0b\u3002\n\n![](https://cdn.luogu.com.cn/upload/pic/31926.png )\n\n\u8fd9\u91cc\u6709\u4e00\u4e2a\u4f8b\u5b50\uff1an=4\n\n\u73b0\u5728\u6211\u4eec\u8981\u7b97ans[2],\u4e5f\u5c31\u662f\u6070\u597d\u5339\u914d2\u4e2a\u7684T\u7684\u65b9\u6848\u6570\n\n\u5c31\u662f\u9ec4\u8272\u7684\u90e8\u5206\u3002\n\n\u7ea2\u8272\u7684\u6570\u5b57\u662f\u8fd9\u4e2a\u533a\u57df\u88ab\u7b97cal(i)\u7684\u6b21\u6570\u3002\n\n\u53ef\u89c1\uff0c\u4e09\u4e2a\u70b9\u7684\u91cd\u590d\u533a\u57df\uff0c\u7531\u4e8e\u6709C(3,2)\u79cd\u65b9\u6cd5\u9009\u5230\uff0c\u6240\u4ee5\u4f1a\u88ab\u7b97C(3,2)\u6b21\u3002\n\n\u6240\u4ee5\u51cf\u53bb\u6240\u6709\u7684ans[3]\u5373\u53ef\u3002\n\n\u5176\u4ed6\u60c5\u51b5\u540c\u7406\u3002\n\n\u6700\u540e\u8f93\u51faans[1]\n\n\u7ec4\u5408\u6570\u6253\u8868\u3002\n\n\u7406\u8bba\u590d\u6742\u5ea6\uff1a\n\nO(n\u00d7len\u00d72^15)\n\n## \u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N=20;\nconst int M=52;\nconst int mod=1000003;\nchar a[N][M];\nint len;\nint n,t,k;\nint mem[N],cnt;\nll ans[N];\nll c[N][N];\nll sum;\nll tot;//tot measures\nint up;//choose \nint las;\nvoid dfs(int x,int has){//dfs\u8ba1\u7b97tot \n\tif(x==n+1){\n\t\tif(has!=up) return;\n\t\tll lp=1;\n\t\tfor(int j=1;j<=len;j++){\n\t\t\tlas=-1;\n\t\t\tfor(int i=1;i<=up;i++){\n\t\t\t\tif(a[mem[i]][j]!='?'){\n\t\t\t\t\tif(las==-1){\n\t\t\t\t\t\tlas=a[mem[i]][j]-'a';\n\t\t\t\t\t}\n\t\t\t\t\telse if(las!=a[mem[i]][j]-'a') return;//\u4e24\u4e2a\u5b57\u7b26\u4e0d\u4e00\u6837\uff0c\u65e0\u5408\u6cd5\u65b9\u6848 \n\t\t\t\t}\n\t\t\t}\n\t\t\tif(las==-1)lp=(lp*26)%mod;//\u5982\u679c\u90fd\u662f\u2018\uff1f\u2019\u53ef\u4ee5\u968f\u4fbf\u586b\uff0c\u5426\u5219\u53ea\u6709\u4e00\u79cd \n\t\t}\n\t\t(tot+=lp)%=mod;\n\t\treturn;\n\t}\n\tif(has<up) {\n\t\tmem[++cnt]=x;\n\t\tdfs(x+1,has+1);\n\t\tmem[cnt--]=0;\n\t}\n\tif(n-x>=up-has) dfs(x+1,has);\n}\n\nvoid clear(){\n\tmemset(ans,0,sizeof ans);\n\tsum=0;\n\tlen=0;\n}\nint main()\n{\n\tfor(int i=0;i<=N-1;i++){\n\t\tc[i][0]=1;\n\t\tfor(int j=1;j<=i;j++){\n\t\t\tc[i][j]=(c[i-1][j-1]+c[i-1][j])%mod;\n\t\t}\n\t}\n\tscanf(\"%d\",&t);\n\twhile(t--){\n\t\tclear();//\u6e05\u7a7a\u6570\u7ec4\uff0c\u5176\u5b9e\u6ca1\u6709\u5fc5\u8981 \n\t\tscanf(\"%d%d\",&n,&k);\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tscanf(\"%s\",a[i]+1);\n\t\t}\n\t\tlen=strlen(a[1]+1);//\u957f\u5ea6 \n\t\t\n\t\tfor(int i=n;i>=k;i--){//ans[i]\u8ba1\u7b97 \n\t\t\ttot=0;up=i;\n\t\t\tdfs(1,0);\n\t\t\tsum=0;\n\t\t\tfor(int j=i+1;j<=n;j++){//\u5bb9\u65a5\u7684\u5904\u7406 \n\t\t\t\t(sum+=c[j][i]*ans[j])%=mod;\n\t\t\t}\n\t\t\tans[i]=(tot-sum+mod)%mod;\n\t\t}\n\t\tprintf(\"%lld\\n\",ans[k]);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1536050998,
        "uid": 56672,
        "name": "\u67ab\u6797\u665a",
        "ccfLevel": 9,
        "title": "[SDOI2009]Bill\u7684\u6311\u6218"
    },
    {
        "content": "\u5b89\u5229\u4e00\u4e0b[\u535a\u5ba2](http://www.yhzq-blog.cc/luogu-2167-sdoi2009bill\u7684\u6311\u6218/)\n\n\n\u4e00\u773c\u6570\u636e\u8303\u56f4\uff1a\u4f60\u597d\u72b6\u538b\n\n\n\u56e0\u4e3a\u6bcf\u4e2a\u5b57\u7b26\u4e32\u90fd\u662f\u76f8\u540c\u957f\u5ea6\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u9884\u5904\u7406\u4e00\u4e2a$match[1 \\cdots len][a \\cdots z]$\uff0c\u91cc\u9762\u7528\u4e8c\u8fdb\u5236\u8868\u793a$1 \\cdots n$\u4f4d\u7684\u5b57\u7b26\u4e32\u7684\u7b2c$i$\u4f4d\u662f\u5426\u53ef\u4ee5\u5339\u914d\u4e0a$a \\cdots z$\u3002\n\n\n\u7136\u540e\u8f6c\u79fb\u5c31\u975e\u5e38\u597d\u60f3\u4e86\uff0c$f[i][j]$\u8868\u793a\u7b2ci\u4f4d\u7684\u5339\u914d\u4e0a\u4e86j\u8fd9\u4e2a\u72b6\u6001\u7684\u65b9\u6848\u6570\uff0c\u7136\u540e\u968f\u4fbf\u778e\u641e\u7edf\u8ba1\u7ed3\u679c\u5c31\u884c\u4e86\u3002\u3002\u3002\n\n\n```cpp\n#include <cstdio>\n#include <cstring>\nusing namespace std;\nchar s[100][100];\nint f[55][1<<15];\nint n,k,len,tot,mod=1000003;\nint match[50][50];\nvoid check(int x,int y)\n{\n    for (int i=0;i<=len;i++)\n        if (!(s[x][i]=='?'||s[y][i]=='?'||s[x][i]==s[y][i]))\n            return;\n    match[x][y]=match[y][x]=1;\n}\nmain()\n{\n    int T;\n    scanf(\"%d\",&T);\n    while(T--)\n    {\n        memset(f,0,sizeof f);\n        memset(match,0,sizeof match);\n        tot=0;\n        scanf(\"%d%d\",&n,&k);\n        for (int i=1;i<=n;i++)\n            scanf(\"%s\",s[i]);\n        len=strlen(s[1]);\n        \n        for (int i=0;i<len;i++)\n            for (char ch='a';ch<='z';ch++)\n                for (int j=1;j<=n;j++)\n                    if (s[j][i]=='?'||s[j][i]==ch)\n                        match[i][ch-'a']|=(1<<j-1);\n        int cnt=(1<<n)-1;\n        f[0][cnt]=1;\n        for (int i=0;i<len;i++)\n            for (int j=0;j<=cnt;j++)\n                if (f[i][j])\n                    for (char ch='a';ch<='z';ch++)\n                        f[i+1][match[i][ch-'a']&j]+=f[i][j],\n                        f[i+1][match[i][ch-'a']&j]%=mod;\n        for (int i=0;i<=cnt;i++)\n        {\n            int ans=0;\n            for (int j=1;j<=cnt;j<<=1) ans+=(bool)(i&j);\n            if (ans==k) tot=(tot+f[len][i])%mod;\n        }\n        printf(\"%d\\n\",tot);\n    }\n}\n```",
        "postTime": 1492303267,
        "uid": 17689,
        "name": "\u8fdc\u822a\u4e4b\u66f2",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2167 \u3010[SDOI2009]Bill\u7684\u6311\u6218\u3011"
    },
    {
        "content": "\u4e00\u822c\u5316\u7684\u9898\u76ee\u63cf\u8ff0\uff1a\n\n> \u6709$n$\u4e2a\u5c5e\u6027\uff0c\u6c42\u6070\u597d\u6ee1\u8db3$k$\u4e2a\u5c5e\u6027\u7684\u7269\u54c1\u4e2a\u6570\n>\n> \u4f60\u6709\u4e00\u4e2a\u51fd\u6570$q(S)$\uff0c\u53ef\u4ee5\u5feb\u901f\u7b97\u51fa\u81f3\u5c11\u6ee1\u8db3\u5c5e\u6027\u96c6\u5408$S$\u7684\u7269\u54c1\u4e2a\u6570\uff08\u4fdd\u8bc1\u6bcf\u4e2a\u7269\u54c1\u6700\u591a\u53ea\u4f1a\u88ab\u7edf\u8ba1\u4e00\u6b21\uff09\n\n\u8bbe$f(S)$\u8868\u793a\u53ea\u6ee1\u8db3\u5c5e\u6027\u96c6\u5408$S$\u4e2d\u7684\u7269\u54c1\u7684\u4e2a\u6570\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f$\\sum_{S \\subseteq U \\wedge |S| = k}f(S)$\n\n\u8bbe$f(S)=\\sum\\limits_{S \\subseteq P}q(P)g(|P|)$\uff0c\u5176\u4e2d$|S|=k$\uff0c\u663e\u7136\u6709$g(x)=(-1)^{x-k}$\n\n\u8bc1\u660e\uff1a\n\n>\u5bf9\u4e8e\u4e00\u4e2a\u7269\u54c1$t$\uff0c\u5047\u8bbe\u5b83\u7684\u5c5e\u6027\u96c6\u5408\u4e3a$Q$\uff0c\u4e14$S \\subseteq Q$\uff0c\u4e14$|Q|=k+u$\n>\n>\u90a3\u4e48\u5b83\u5bf9$f(S)$\u7684\u8d21\u732e\u662f\n>$$\\sum_{i=0}^{u}{u \\choose i}(-1)^{i}=(-1+1)^{u}=[u=0]$$\n>\n\n\u4e5f\u5c31\u662f\u8bf4$f(S)=\\sum\\limits_{S \\subseteq P}q(P)(-1)^{|P|-k}$\n\n\u4e5f\u5c31\u662f\u8bf4\n$$\\begin{aligned}T&=\\sum\\limits_{S \\subseteq U \\wedge |S| = k}f(S) \\\\&=\\sum\\limits_{S \\subseteq U \\wedge |S| = k} \\sum_{S \\subseteq P}q(P)(-1)^{|P|-k} \\\\&=\\sum\\limits_{P \\subseteq U \\wedge |P| \\ge k} q(P)(-1)^{|P|-k}{|P| \\choose k}\\end{aligned}$$\n\n\u4e8e\u662f\u5c31\u505a\u5b8c\u4e86\u2026\u2026\n\n\u7531\u4e8e\u8fd9\u9053\u9898\u7684$q(S)$\u6c42\u6cd5\u5341\u5206\u7b80\u5355\uff0c\u5728\u6b64\u5c31\u4e0d\u8d58\u8ff0\u4e86\n\n---\n\n``` cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int mod = 1e6 + 3;\nchar s[20][55];\nint n, k, vis[55], len;\nll pw(ll a, ll b) {\n    ll r = 1;\n    for( ; b ; b >>= 1, a = a * a % mod) if(b & 1) r = r * a % mod;\n    return r;\n}\nll calc(int s) {\n    for(int i = 1 ; i <= len ; ++ i) {\n        vis[i] = 0;\n    }\n    for(int i = 1 ; i <= n ; ++ i) {\n        if((s >> (i - 1)) & 1) {\n            for(int j = 1 ; j <= len ; ++ j) {\n                char c = :: s[i][j];\n                if(c == '?') continue;\n                if(vis[j] && vis[j] != c) {\n                    return 0;\n                }\n                vis[j] = c;\n            }\n        }\n    }\n    \n    ll res = 1;\n    for(int i = 1 ; i <= len ; ++ i) {\n        if(vis[i]) continue;\n        res = res * 26 % mod;\n    }\n    \n    return res;\n}\n\nint C[20][20];\n\nvoid sol() {\n    scanf(\"%d%d\", &n, &k);\n    for(int i = 1 ; i <= n ; ++ i) {\n        scanf(\"%s\", s[i] + 1);\n    }\n    len = strlen(s[1] + 1);\n    int ans = 0;\n    for(int s = 0 ; s < (1 << n) ; ++ s) {\n        int cnt = 0;\n        for(int i = 1 ; i <= n ; ++ i) {\n            if((s >> (i - 1)) & 1) {\n                ++ cnt;\n            }\n        }\n        if(cnt >= k) {\n            ll sig = ((cnt - k) & 1) ? -1 : 1;\n            ans = (ans + sig * C[cnt][k] * calc(s)) % mod;\n        }\n    }\n    ans = (ans % mod + mod) % mod;\n    printf(\"%d\\n\", ans);\n}\n\nint main() {\n    C[0][0] = 1;\n    for(int i = 1 ; i < 20 ; ++ i) {\n        C[i][0] = 1;\n        for(int j = 1 ; j < 20 ; ++ j) {\n            C[i][j] = (C[i - 1][j - 1] + C[i - 1][j]) % mod;\n        }\n    }\n    int T; scanf(\"%d\", &T);\n    while(T --) sol(); \n}\n```\n\n",
        "postTime": 1536414613,
        "uid": 47111,
        "name": "nekko",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2167 \u3010[SDOI2009]Bill\u7684\u6311\u6218\u3011"
    },
    {
        "content": "## \u601d\u8def\n\n* \u8fd9\u9053\u9898\u662f\u771f\u7684\u96be\u60f3\uff0c\u4e00\u5f00\u59cb\u6211\u89c9\u5f97\u5e94\u8be5\u4ece\u884c\u6570\u5f00\u59cb\u679a\u4e3e\u8fdb\u884c\u88c5\u538bDP\uff0c\u4f46\u662f\u770b\u5230\u5b57\u7b26\u4e32\u957f\u5ea6\u6700\u5927\u4e3a$50$\uff0c\u8fd8\u662f\u7b97\u4e86\uff08\u6c57\uff09\uff0c\u5bb9\u6613\u7206\u6389\uff0c\u6240\u4ee5\u8f6c\u6362\u601d\u60f3\uff0c\u679a\u4e3e\u4f4d\u6570\uff0c\u7ef4\u62a4\u6570\u7ec4$g[i][j]$\u8868\u793a\u7b2c$i$\u4e2a\u4f4d\u6570\u4e0b\u653e$j$\u7684\u60c5\u51b5\u4e0b\u8be5\u5217\u7684\u5339\u914d\u60c5\u51b5\uff0c\u9884\u5904\u7406\u597d\u50cf\u5c31\u8fd9\u4e9b\uff08\u6c57\uff09;\n\n* \u63a5\u4e0b\u6765\u5c31\u662f\u7d27\u5f20\u523a\u6fc0\u7684DP\u73af\u8282\u4e86\uff0c\u6211\u4eec\u5b9a\u4e49$f[i][j]$\u4e3a$T$\u4e32\u5df2\u7ecf\u5339\u914d\u4e86$i$\u4f4d\uff0c\u4e14\u4e0e$n$\u4e2a\u5b57\u7b26\u4e32\u662f\u5426\u5339\u914d\u7684\u96c6\u5408\u4e3a$j$\uff0c\u72b6\u6001\u8fb9\u754c\u4e3a$lim$\uff0c$f[0][lim-1]=1$,\u9996\u5148\u679a\u4e3e\u4f4d\u6570\uff0c\u7136\u540e\u679a\u4e3e\u72b6\u6001\uff0c\u5982\u679c$f[i][j]==0$\u4e0d\u9700\u8981\u8fdb\u884c\u64cd\u4f5c\uff0c\u53ef\u4ee5\u526a\u679d\uff0c\u7136\u540e\u679a\u4e3e\u5b57\u7b26\uff0c\u5728\u4e0b\u4e00\u72b6\u6001\u4e0b\u6dfb\u52a0\u5b57\u7b26\u7684\u79cd\u7c7b\u6570\u4e3a\u672c\u72b6\u6001\u52a0\u4e0a\u4e0b\u4e00\u72b6\u6001\u7684\u539f\u79cd\u7c7b\u6570\n\n* \u6700\u540e\u679a\u4e3e\u4e0d\u540c\u72b6\u6001\uff0c\u8bb0\u5f55\u8be5\u72b6\u6001\u4e0e\u539f\u6570\u7ec4\u7684\u5339\u914d\u60c5\u51b5\uff0c\u5224\u65ad\u8be5\u72b6\u6001\u662f\u5426\u5305\u62ec\u67d0\u4e00\u884c\u7684\u4f4d\u6570\uff08\u5373\u8be5\u884c\u5339\u914d\uff09\uff0c\u5982\u679c\u662f\u5219$tot++$\uff0c\u5982\u679c$tot=m$\uff0c\u53e0\u52a0$f[len][\u5f53\u524d\u72b6\u6001]$\uff0c\u6c42\u89e3$ans$\u3002\n\n## \u5982\u679c\u8fd8\u4e0d\u660e\u767d\u7684\u8bdd\uff0c\u8bf7\u770b\u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mod=1e6+3;\nconst int maxn=100010;\nint f[50+5][1<<15],g[50+5][30];\nchar s[16][50+5];\nint T,n,m;\nint main(){\n\tscanf(\"%d\",&T);\n\twhile(T--){\n\t\tmemset(f,0,sizeof(f));\n\t\tmemset(g,0,sizeof(g));\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tfor(int i=0;i<n;i++)scanf(\"%s\",s[i]);\n\t\tint len=strlen(s[0]);\n\t\tfor(int i=0;i<len;i++){//\u679a\u4e3e\u4f4d\u6570\n\t\t\tfor(int j=0;j<26;j++){//\u679a\u4e3e\u5b57\u7b26\n\t\t\t\tfor(int k=0;k<n;k++){//\u679a\u4e3e\u884c\u6570\n\t\t\t\t\tif(s[k][i]=='?' || s[k][i]==j+'a')g[i][j]|=(1<<k);//\u4f4d\u6570\u4e3ai\u65f6j\u5b57\u7b26\u7684\u5339\u914d\u60c5\u51b5\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint lim=(1<<n);\n\t\tf[0][lim-1]=1;\n\t\tfor(int i=0;i<len;i++){//\u679a\u4e3e\u4f4d\u6570\n\t\t\tfor(int j=0;j<lim;j++){//\u679a\u4e3e\u72b6\u6001\n\t\t\t\tif(f[i][j])//\u526a\u679d\n\t\t\t\t\tfor(int k=0;k<26;k++){//\u679a\u4e3e\u5b57\u7b26\n\t\t\t\t\t\tf[i+1][j&g[i][k]]=(f[i+1][j&g[i][k]]+f[i][j])%mod;\n\t\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans=0;\n\t\tfor(int i=0;i<lim;i++){//\u679a\u4e3e\u72b6\u6001\n\t\t\tint tot=0;\n\t\t\tfor(int j=0;j<n;j++){\n\t\t\t\tif(i & (1<<j))tot++;\n\t\t\t}\n\t\t\tif(tot==m)ans=(ans+f[len][i])%mod;\n\t\t}\n\t\tprintf(\"%d\\n\",ans);\n\t\t\n\t}\n}\n```\n",
        "postTime": 1595936478,
        "uid": 345927,
        "name": "sodak",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2167 \u3010[SDOI2009]Bill\u7684\u6311\u6218\u3011"
    },
    {
        "content": "\u5ef6\u7eed\u67ab\u6797\u665a\u5927\u4f6c\u7684\u5bb9\u65a5\u601d\u60f3\uff0c\u7528\u7b80\u5355\u7684**\u4e8c\u9879\u5f0f\u53cd\u6f14**\u6765\u4e2a\u5c0f\u5c0f\u7684\u5e38\u6570\u4f18\u5316\uff0c\u76ee\u524d\u6700\u4f18\u89e3rk2\n\n---\n\n### \u9898\u89e3\uff1a\n\n\u4e8c\u53cd\u7ecf\u5178\u5957\u8def\uff1a\u8bbe $f(i)$ \u8868\u793a\u94a6\u5b9a\u80fd\u591f\u5339\u914d\u7684\u662f\u67d0 $i$ \u4e2a\u4e32\u7684\u65b9\u6848\u6570\uff0c $g(i)$ \u8868\u793a\u80fd\u5339\u914d\u7684\u4e32\u6070\u597d\u4e3a $i$ \u4e2a\u7684\u65b9\u6848\u6570\n\n$f(i)$\u6211\u4eec\u53ef\u4ee5\u7528dfs\u66b4\u529b\u641e\u51fa\uff0c\u800c$g(k)$\u5c31\u662f\u6211\u4eec\u7684\u7b54\u6848\n\n\u7136\u540e\u6839\u636e\u5b9a\u4e49\u4ee5\u53ca\u4e8c\u9879\u5f0f\u53cd\u6f14\u8f6c\u5316\uff1a\n\n$$f(n)=\\sum\\limits_{i=n}^m{i\\choose n}g(i)\\Leftrightarrow g(n)=\\sum\\limits_{i=n}^m(-1)^{i-n}{i\\choose n}f(i)$$\n\n\u4e8e\u662f\uff1a\n\n$$ans=g(k)=\\sum\\limits_{i=k}^n(-1)^{i-k}{i\\choose k}f(i)$$\n\n\n---\n\n### \u4ee3\u7801\uff1a\n\n```cpp\n#pragma GCC optimize(\"Ofast,no-stack-protector,unroll-loops,fast-math\")\n#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4.1,sse4.2,avx,avx2,popcnt,tune=native\")\n#include <bits/stdc++.h>\nusing namespace std;\ntemplate<class t> inline t read(t &x){\n    char c=getchar();bool f=0;x=0;\n    while(!isdigit(c)) f|=c=='-',c=getchar();\n    while(isdigit(c)) x=(x<<1)+(x<<3)+(c^48),c=getchar();\n    if(f) x=-x;return x;\n}\ntemplate<class t> inline void write(t x){\n    if(x<0) putchar('-'),write(-x);\n    else{if(x>9) write(x/10);putchar('0'+x%10);}\n}\n\nconst int mod=1e6+3,N=55,M=16;\nchar s[M][N],ch[N];\nint pw[N],pn,n,m,k,f[M],c[N][N],p[N];\n\nvoid dfs(int x,int cnt){ //\u66b4\u529b\u641e\u51faf(i)\n\tif(n-x+1+cnt<k) return ; //\u8303\u56f4\u526a\u679d\n\tif(x==n+1){\n\t\tf[cnt]+=pw[m-pn]; //\u7d2f\u52a0\n\t\tif(f[cnt]>mod) f[cnt]-=mod;\n\t\treturn ;\n\t}\n\tdfs(x+1,cnt);\n\tfor(int i=0;i<m;i++) if(ch[i]&&s[x][i]>='a'&&ch[i]!=s[x][i]) return ; //ch[i]\u8868\u793a\u7b2ci\u4e2a\u4f4d\u7f6e\u4e0a\u5e94\u8be5\u662f\u54ea\u4e2a\u5b57\u6bcd\n\tint now=pn;\n\tfor(int i=0;i<m;i++) if(!ch[i]&&s[x][i]!='?') ch[i]=s[x][i],p[++pn]=i;\n\tdfs(x+1,cnt+1);\n\twhile(pn>now) ch[p[pn--]]=0; //\u4fee\u6539\u56de\u53bb\n}\n\nvoid doit(){\n\tread(n);read(k);\n\tfor(int i=1;i<=n;i++) scanf(\"%s\",s[i]);\n\tm=strlen(s[1]);\n\tfor(int i=k;i<=n;i++) f[i]=0;\n\tdfs(1,0);\n\tint ans=0;\n\tfor(int i=k;i<=n;i++){\n\t\tif(i-k&1) ans+=mod-1ll*c[i][k]*f[i]%mod; //\u4e8c\u9879\u5f0f\u53cd\u6f14\n\t\telse ans+=1ll*c[i][k]*f[i]%mod;\n\t\tif(ans>=mod) ans-=mod;\n\t}\n\twrite(ans);puts(\"\");\n}\n\nsigned main(){\n\tfor(int i=0;i<=15;i++){\n\t\tc[i][0]=1;\n\t\tfor(int j=1;j<=i;j++){\n\t\t\tc[i][j]=c[i-1][j-1]+c[i-1][j];\n\t\t\tif(c[i][j]>mod) c[i][j]-=mod;\n\t\t}\n\t}\n\tfor(int i=0;i<=50;i++) pw[i]=i?pw[i-1]*26%mod:1;\n\tint t;\n\tread(t);\n\twhile(t--) doit();\n}\n```",
        "postTime": 1590124916,
        "uid": 65735,
        "name": "yuzhechuan",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P2167 \u3010[SDOI2009]Bill\u7684\u6311\u6218\u3011"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u65e0\u8111\u7684\uff0c\u672c\u83dc\u9e21~~\u4e0a\u6587\u5316\u8bfe\u65f6~~\u81ea\u5df1\u60f3\u5230\u7684\u5f31\u667a\u72b6\u538b\uff0c\u7ed3\u679c\u662f\u5bf9\u7684~~\u53ea\u662f\u975e\u5e38\u6162~~\uff0c\u770b\u6ca1\u6709\u4eba\u7528\u8fd9\u79cd\u5199\u6cd5\u4e8e\u662f\u6211\u5c31\u51b3\u5b9a\u53d1\u4e00\u7bc7qwq\n\n### \u975e\u5e38\u65e0\u8111\uff01\n\n\u8bbe$f[i][j]$\u8868\u793a\u6709\u591a\u5c11\u4e2a\u4e32\u6ee1\u8db3\u6761\u4ef6\u3002\n\n$j$\u662f\u72b6\u6001\uff0c\u8868\u793a\u7b54\u6848\u4e0e\u54ea\u4e9b$S$\u4e32\u5339\u914d\n\n$i$\u8868\u793a\u73b0\u5728\u5339\u914d\u5230\u4e86\u7b2c$i$\u4f4d\n\n\u6bd4\u5982\uff1a\n$S1=a?,S2=ab,f[1][3(11)]=f[2][3(11)]=1,f[2][1(01)]=26$\n\n\u7136\u540e\u5047\u8bbe\u6211\u4eec\u6709\u4e86$f[i][j],$\u5982\u4f55\u8f6c\u79fb\u5230$f[i+1][???]\\ \\ ??????$\n\n\u6211\u4eec\u5148\u5f00\u4e00\u4e2a\u6570\u7ec4$hash[][]$\u8bb0\u5f55\u6bcf\u4e00\u79cd\u5b57\u7b26\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u628a$?$\u5b57\u7b26\u8f6c\u5316\u6210$a$~$z$\n\n\u6bd4\u5982\n\n$S1=a$\n\n$S2=?$\n\n$S2=z$\n\n\u90a3\u4e48$hash[\\text{a}]=${$1,2$}\uff0c$1$\u6765\u6e90\u4e8e$S1$\uff0c$2$\u6765\u6e90\u4e8e$S2$\n\n$hash[\\text{b}]=hash[\\text{c}]=...=hash[\\text{y}]=${$2$}\uff0c$2$\u6765\u6e90\u4e8e$S2$\n\n$hash[\\text{z}]=${$2,3$}\uff0c$2$\u6765\u6e90\u4e8e$S2$,$3$\u6765\u6e90\u4e8e$S3$\n\n\u53d1\u73b0\uff0c\u5982\u679c\u6211\u4eec\u679a\u4e3e$i+1$\u4f4d\u7684\u5b57\u7b26$ch$\uff0c\u9009\u62e9$ch$\u4e4b\u540e\u5339\u914d\u7684$S$\u4e32\uff0c\u5c31\u662f$hash[ch]!!!$ \n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5feb\u4e50\u7684\u8f6c\u79fb\u4e86~\n\n\u8bbe$hash[ch]$\u6709$size$\u4e2a\u6570:\n\n$f[i+1][\\sum_{i\\le size}(1<<(has[ch][i]))]+=f[i][j]$\n\n\u4ee3\u7801\u5982\u4e0b:\n\n```\n#include<bits/stdc++.h>\n#define ljc 1000003\nusing namespace std;\ninline int getit(){\n\t//\u8f6c\u5316 a->1,b->2,...,z->26,?->27\n    char ch=getchar();\n    while (!isalpha(ch)&&(ch!='?')) ch=getchar();\n    if (isalpha(ch)) return ch-'a'+1;\n    else return 27;\n}\ninline int read(){\n    int x=0,f=1;char ch=getchar();\n    while (!isdigit(ch)){if (ch=='-') f=-1;ch=getchar();}\n    while (isdigit(ch)){x=(x<<1)+(x<<3)+ch-48;ch=getchar();}\n    return x*f;\n}\nchar s[10000];\nint a[1600][5100],has[280][5100],len,T,n,m,f[51][33333];\ninline int countbit(int x){\n    //\u8fd4\u56de\u4e8c\u8fdb\u5236\u6570x\u4e2d\u6709\u591a\u5c11\u4e3a1\n    int ans=0;\n    while (x){\n        if (x&1) ans++;\n        x>>=1;\n    }\n    return ans;\n}\nint main(){\n    T=read();\n    while (T--){\n        memset(f,-1,sizeof(f));\n        memset(has,0,sizeof(has));\n        n=read(),m=read();int ans=0;\n        scanf(\"%s\",s);len=strlen(s);\n        for (int i=0;i<len;i++){\n            if (isalpha(s[i])) a[1][i+1]=s[i]-'a'+1;\n            else a[1][i+1]=27;\n        }\n        for (int i=2;i<=n;i++){\n            for (int j=1;j<=len;j++){\n                a[i][j]=getit();\n            }\n        }\n\t\tf[0][(1<<n)-1]=1;\n        for (int i=0;i<len;i++){\n            for (int P=0;P<(1<<n);P++){//P\u5c31\u662f\u4e0a\u8ff0\u7684j\u72b6\u6001qwq\n                if (f[i][P]==-1) continue;\n                for (int k=1;k<=26;k++) has[k][0]=0;//has[i][0]\u8868\u793a\u4e0a\u8ff0\u7684size qwq\n                for (int j=1;j<=n;j++){\n                \tif ((P&(1<<j-1))==0) continue;\n                    if (a[j][i+1]<=26) has[a[j][i+1]][++has[a[j][i+1]][0]]=j;\n                    else{\n                    \tfor (int k=1;k<=26;k++) has[k][++has[k][0]]=j;\n                    }\t\n                }\n                for (int j=1;j<=26;j++){\n                    if (has[j][0]){\n       \t\t     \t\tint rev=0;\n                        for (int k=1;k<=has[j][0];k++) rev+=(1<<has[j][k]-1);\n                        if (f[i+1][rev]==-1) f[i+1][rev]=0;\n                        f[i+1][rev]=(f[i+1][rev]+f[i][P])%ljc;//\u8f6c\u79fb\n                    }\n                }\n            }\n        }\n        for (int P=0;P<(1<<n);P++){\n            if (f[len][P]==-1) continue;\n            if (countbit(P)==m) ans=(ans+f[len][P])%ljc;\n        }\n        cout<<ans<<endl;\n    }\n    return 0;\n}\n```",
        "postTime": 1542874520,
        "uid": 20309,
        "name": "Fading",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2167 \u3010[SDOI2009]Bill\u7684\u6311\u6218\u3011"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/Coros-Trusds/p/16293123.html)\n\n\u72b6\u538b $\\rm Dp$ \u5c0f\u6e05\u65b0\u9898\u3002\n\n# \u9898\u76ee\u5927\u610f\n\n$\\rm Sheng\\_bill$ \u4e0d\u4ec5\u6709\u60ca\u4eba\u7684\u5fc3\u7b97\u80fd\u529b\uff0c\u8fd8\u53ef\u4ee5\u8f7b\u677e\u5730\u5b8c\u6210\u5404\u79cd\u7edf\u8ba1\u3002\u5728\u6628\u5929\u7684\u6bd4\u8d5b\u4e2d\uff0c\u4f60\u51ed\u501f\u4f18\u79c0\u7684\u7a0b\u5e8f\u4e0e\u4ed6\u6253\u6210\u4e86\u5e73\u5c40\uff0c\u8fd9\u5bfc\u81f4 $\\rm Sheng\\_bill$  \u6781\u5ea6\u7684\u4e0d\u6ee1\u3002\u4e8e\u662f\u4ed6\u518d\u6b21\u6311\u6218\u4f60\u3002\u8fd9\u6b21\u4f60\u53ef\u4e0d\u80fd\u8f93\u3002\n\n\u8fd9\u6b21\uff0c\u6bd4\u8d5b\u89c4\u5219\u662f\u8fd9\u6837\u7684\uff1a\n\n\u7ed9\u51fa $N$ \u4e2a\u957f\u5ea6\u76f8\u540c\u7684\u5b57\u7b26\u4e32\uff08\u7531\u5c0f\u5199\u82f1\u6587\u5b57\u6bcd\u548c `?` \u7ec4\u6210\uff09\uff0c$S_1,S_2,\\dots,S_N$\uff0c\u6c42\u4e0e\u8fd9 $N$ \u4e2a\u4e32\u4e2d\u7684\u521a\u597d $K$ \u4e2a\u4e32\u5339\u914d\u7684\u5b57\u7b26\u4e32 $T$ \u7684\u4e2a\u6570\uff0c\u7b54\u6848\u5bf9 $1000003$ \u53d6\u6a21\u3002\n\n\u82e5\u5b57\u7b26\u4e32 $S_x(1\\le x\\le N)$ \u548c $T$ \u5339\u914d\uff0c\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a\n\n1. $|S_x|=|T|$\u3002\n\n2. \u5bf9\u4e8e\u4efb\u610f\u7684 $1\\le i\\le|S_x|$\uff0c\u6ee1\u8db3 $S_x[i]= \\texttt{?}$ \u6216\u8005 $S_x[i]=T[i]$\u3002\n\n\u5176\u4e2d $T$ \u53ea\u5305\u542b\u5c0f\u5199\u82f1\u6587\u5b57\u6bcd\u3002\n\n# \u9898\u76ee\u5206\u6790\n\n\u4ee4 $dp[i][s]$ \u8868\u793a\u6240\u6709\u5b57\u7b26\u4e32\u5339\u914d\u5230\u7b2c $i$ \u4e2a\u5b57\u7b26\uff0c\u9009\u62e9\u7684\u5b57\u7b26\u4e32\u96c6\u5408\u4e3a $s$ \u65f6\u5339\u914d\u7684\u65b9\u6848\u6570\uff0c$g[i][ch]$ \u8868\u793a\u5728\u6240\u6709\u5b57\u7b26\u4e32\u7684\u7b2c $i$ \u4e2a\u5b57\u7b26\u4e2d\u5b57\u7b26 $ch$ \u51fa\u73b0\u7684\u72b6\u6001\u96c6\u5408\u3002\n\n\u521d\u59cb\u5316 $dp[0][2^n-1]=1$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u4e0d\u96be\u6c42\u51fa\u8f6c\u79fb\u5f0f\uff1a$dp[i+1][s\\operatorname{and}g[i+1][ch]]\\gets dp[i+1][s\\operatorname{and}g[i+1][ch]]+dp[i][s]$\u3002\n\n\u6ce8\u610f `?` \u53ef\u4ee5\u8ba4\u4e3a\u662f\u4efb\u610f\u4e00\u79cd\u5b57\u7b26\uff0c\u6240\u4ee5\u4f1a\u51fa\u73b0\u5728\u4efb\u610f\u5c5e\u4e8e\u5b57\u7b26 $ch$ \u7684\u96c6\u5408\u5185\u3002\n\n# \u4ee3\u7801\n\n```cpp\n//2022/5/20\n#define _CRT_SECURE_NO_WARNINGS\n#include <iostream>\n#include <cstdio>\n#include <climits>//need \"INT_MAX\",\"INT_MIN\"\n#include <cstring>//need \"memset\"\n#include <numeric>\n#include <algorithm>\n#define enter putchar(10)\n#define debug(c,que) std::cerr << #c << \" = \" << c << que\n#define cek(c) puts(c)\n#define blow(arr,st,ed,w) for(register int i = (st);i <= (ed); ++ i) std::cout << arr[i] << w;\n#define speed_up() std::ios::sync_with_stdio(false),std::cin.tie(0),std::cout.tie(0)\n#define mst(a,k) memset(a,k,sizeof(a))\n#define stop return(0)\nconst int mod = 1e6 + 3;\ninline int MOD(int x) {\n\tif(x < 0) x += mod;\n\treturn x % mod;\n}\nnamespace Newstd {\n\tchar buf[1 << 21],*p1 = buf,*p2 = buf;\n\tinline int getc() {\n\t\treturn p1 == p2 && (p2 = (p1 = buf) + fread(buf,1,1 << 21,stdin),p1 == p2) ? EOF : *p1 ++;\n\t}\n\tinline int read() {\n\t\tint ret = 0,f = 0;char ch = getc();\n\t\twhile (!isdigit(ch)) {\n\t\t\tif(ch == '-') f = 1;\n\t\t\tch = getc();\n\t\t}\n\t\twhile (isdigit(ch)) {\n\t\t\tret = (ret << 3) + (ret << 1) + ch - 48;\n\t\t\tch = getc();\n\t\t}\n\t\treturn f ? -ret : ret;\n\t}\n\tinline void write(int x) {\n\t\tif(x < 0) {\n\t\t\tputchar('-');\n\t\t\tx = -x;\n\t\t}\n\t\tif(x > 9) write(x / 10);\n\t\tputchar(x % 10 + '0');\n\t}\n}\nusing namespace Newstd;\n\nconst int N = 55,M = 16;\nint g[N][N],dp[N][1 << M];\n//dp[i][s]:\u9009\u62e9\u7684\u5b57\u7b26\u4e32\u96c6\u5408\u4e3a s,\u5339\u914d\u5230\u7b2c i \u4e2a\u5b57\u7b26\u65f6\u5339\u914d\u7684\u65b9\u6848\u6570\nchar s[M][N];\nint T,n,m;\ninline void init() {\n\tmst(dp,0),mst(g,0);\n}\ninline int getid(char ch) {\n\treturn ch - 'a';\n}\ninline int popcount(int x) {\n\tint res = 0;\n\twhile (x) {\n\t\tif (x & 1) res ++;\n\t\tx >>= 1;\n\t}\n\treturn res;\n}\ninline void solve() {\n\tscanf(\"%d%d\",&n,&m);\n\tfor (register int i = 1;i <= n; ++ i) scanf(\"%s\",s[i] + 1);\n\tint len = strlen(s[1] + 1);\n\tfor (register int i = 1;i <= len; ++ i) {\n\t\tfor (register char ch = 'a';ch <= 'z'; ++ ch) {\n\t\t\tfor (register int j = 1;j <= n; ++ j) {\n\t\t\t\tif (s[j][i] == '?' || s[j][i] == ch) {\n\t\t\t\t\tg[i][getid(ch)] |= (1 << (j - 1));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tdp[0][(1 << n) - 1] = 1;\n\tfor (register int i = 0;i < len; ++ i) {\n\t\tfor (register int j = 0;j < (1 << n); ++ j) {\n\t\t\tif (dp[i][j] == 0) continue;\n\t\t\tfor (register char ch = 'a';ch <= 'z'; ++ ch) {\n\t\t\t\tdp[i + 1][j & g[i + 1][getid(ch)]] = MOD(dp[i + 1][j & g[i + 1][getid(ch)]] + dp[i][j]);\n\t\t\t}\n\t\t}\n\t}\n\tint ans = 0;\n\tfor (register int i = 0;i < (1 << n); ++ i) {\n\t\tif (popcount(i) == m) {\n\t\t\tans = MOD(ans + dp[len][i]);\n\t\t}\n\t}\n\tprintf(\"%d\\n\",ans);\n}\nint main(void) {\n#ifndef ONLINE_JUDGE\n\tfreopen(\"in.txt\",\"r\",stdin);\n#endif\n\tscanf(\"%d\",&T);\n\twhile (T --) {\n\t\tinit();\n\t\tsolve();\n\t}\n\n\treturn 0;\n}\n```",
        "postTime": 1653038670,
        "uid": 430409,
        "name": "Coros_Trusds",
        "ccfLevel": 6,
        "title": "P2167 [SDOI2009]Bill\u7684\u6311\u6218"
    },
    {
        "content": "\u8003\u8651\u72b6\u538b dp .\n\n\u80af\u5b9a\u662f\u538b $n$ \u8fd9\u4e00\u7ef4\u4e86\uff0c\u8bbe $dp_{i, S}$ \u8868\u793a\u76ee\u524d\u5339\u914d\u5230\u4e86\u7b2c $i$ \u4f4d\uff0c\u5339\u914d\u72b6\u6001\u662f $S$ \u7684\u65b9\u6848\u6570 .\n\n\u4e8e\u662f\u8f7b\u6613\u8f6c\u79fb\uff1a\n$$\\large dp_{i+1, S\\cap S'}=\\sum_{ch} dp_{i, S}$$\n\u5176\u4e2d $S'$ \u662f\u5b57\u7b26 $ch$ \u80fd\u5339\u914d\u54ea\u4e9b\u4e32\u4e32 .\n\n$S'$ \u663e\u7136\u53ef\u4ee5\u9884\u5904\u7406\u5427\uff0c\u7136\u540e\u5c31\u505a\u5b8c\u4e86 .\n\n\u6ce8\u610f\u5982\u679c $dp_{i,S}=0$ \u8f6c\u79fb\u5c31\u6ca1\u7528\u4e86\uff0c\u76f4\u63a5\u8fdb\u4e0b\u4e00\u4e2a\u5c31\u5b8c\u4e86\uff0c\u8fd9\u4e2a\u526a\u679d\u53ef\u4ee5\u8ba9\u4f60\u591a\u5bf9\u4e09\u4e2a\u70b9 .\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(T\\cdot 2^n\\Sigma m)$\uff0c$\\Sigma$ \u662f\u5b57\u7b26\u96c6\u5927\u5c0f\uff0c$m$ \u662f\u5b57\u7b26\u4e32\u957f\u5ea6 .\n\nCode:\n\n```cpp\nusing namespace std;\nconst int N = 16, S = 55, R = (1 << N), sigma = 128, P =  1000003;\ntypedef char str[S];\n// dp[i][S]: \u5339\u914d\u5230\u7b2c i \u4e2a\u5b57\u7b26\uff0c\u76ee\u524d\u5339\u914d\u72b6\u6001\u4e3a S \ninline int popcnt(const int& x){return __builtin_popcount(x);}\nint n, k, dp[S][R], g[S][sigma];\nstr s[N];\nvoid solve()\n{\n\tmemset(g, 0, sizeof g);\n\tmemset(dp, 0, sizeof dp);\n\tscanf(\"%d%d\", &n, &k); int m = (1 << n);\n\tfor (int i=1; i<=n; i++) scanf(\"%s\", s[i]+1);\n\tint l = strlen(s[1]+1);\n\tfor (int i=1; i<=l; i++)\n\t\tfor (char ch='a'; ch<='z'; ch++)\n\t\t\tfor (int k=1; k<=n; k++)\n\t\t\t\tif ((s[k][i] == '?') || (s[k][i] == ch)) g[i][ch] |= (1 << (k-1));\n\tdp[0][m-1] = 1;\n\tfor (int i=0; i<l; i++)\n\t\tfor (int j=0; j<m; j++)\n\t\t{\n\t\t\tif (!dp[i][j]) continue;\n\t\t\tfor (char ch='a'; ch<='z'; ch++)\n\t\t\t{\n\t\t\t\tint& _ = dp[i+1][j & g[i+1][ch]] ;\n\t\t\t\t_ = (_ + dp[i][j]) % P;\n\t\t\t}\n\t\t}\n\tint ans = 0;\n\tfor (int i=0; i<m; i++)\n\t\tif (popcnt(i) == k) ans = (ans + dp[l][i]) % P;\n\tprintf(\"%d\\n\", ans);\n}\nint main()\n{\n#ifndef ONLINE_JUDGE\n\tfreopen(\"i.in\", \"r\", stdin);\n#endif\n\tint T; scanf(\"%d\", &T);\n\twhile (T--) solve();\n\treturn 0;\n}\n```",
        "postTime": 1642384549,
        "uid": 325613,
        "name": "Implicit",
        "ccfLevel": 0,
        "title": "P2167 \u9898\u89e3"
    },
    {
        "content": "### \u4e00\u770b\u9898\u89e3\u597d\u50cf\u5168\u662f\u72b6\u538b$DP$\uff0c\u90a3\u4e48\u6211\u5c31\u6765\u8865\u5145\u4e00\u4e2a\u5bb9\u65a5\u5199\u6cd5\u5427\n\n### \u4e4d\u4e00\u770b\uff0c\u597d\u50cf\u662f\u6c34\u9898\uff0c\u679a\u4e3e\u9009\u54ea$k$\u4e2a\u4e32\uff0c\u7136\u540e\u5224\u65ad\n\n$\\text{1\uff0c\u5982\u679c\u8fd9k\u4e2a\u4e32\u4e2d\\red{\u81f3\u5c11\u4e24\u4e2a}\u4e32\u67d0\u4f4d\u7f6e\u786e\u5b9a\u4e14\u4e0d\u76f8\u540c\uff0c\u7b54\u6848\u663e\u7136\u4e3a0}$\n\n$\\text{2\uff0c\u5982\u679c\u8fd9\u4e2a\u4f4d\u7f6e\u53ea\u88ab\\red{\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a}\u4e32\u786e\u5b9a\uff0c\u8fd9\u4e2a\u4f4d\u7f6e\u5c31\u552f\u4e00\u786e\u5b9a\u4e86}$\n\n$\\text{3\uff0c\u5426\u5219\u8fd9\u4e2a\u4f4d\u7f6e\u670926\u79cd\u4e0d\u540c\u586b\u6570\u60c5\u51b5\uff0c\u7edf\u8ba1\u7b54\u6848\u65f6\u53ea\u8981\u7528\u4e58\u6cd5\u539f\u7406\u641e\u4e00\u4e0b\u5c31\u884c}$\n\n### \u4f46\u662f\u5bb9\u6613\u60f3\u5230\uff0c\u8fd9\u6837\u505a\u662f\u6709\u95ee\u9898\u7684\uff0c\u4ee5\u6837\u4f8b\u7684\u7b2c\u4e00\u7ec4\u6570\u636e\u4e3a\u4f8b\n\n$\\text{\u6211\u4eec\u9009\u5b9a\u4e321\uff0c2\uff0c\u7136\u540e\u53d1\u73b0\u7b2c\u56db\u4e2a\u4f4d\u7f6e\u786e\u5b9a\u662fr\uff0c\u5176\u4ed6\u4f4d\u7f6e\u4efb\u9009\uff0c}$\n$\\text{\u4f46\u662f\u65e0\u8bba\u6211\u4eec\u6784\u9020\u51fa\u600e\u6837\u7684\u4e32\uff0cT\u603b\u662f\u53ef\u4ee5\u540c\u65f6\u5339\u914d\u4e323\u7684}$\n\n### \u8003\u8651\u5bb9\u65a5\u6389\u8fd9\u4e9b\u5339\u914d\u5230\u66f4\u591a\u4e32\u7684\u65b9\u6848\n\n#### \u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u4e0a\u8ff0\u65b9\u6cd5\u6c42\u51fa\u5339\u914d\u81f3\u5c11$i$\u4e2a\u4e32\u7684\u65b9\u6848\u6570\uff0c\u8bb0\u4e3a$num[i]$\n\n#### \u6211\u4eec\u9700\u8981\u7edf\u8ba1\u6070\u597d\u6ee1\u8db3\u5339\u914d$i$\u4e2a\u7684\u60c5\u51b5\uff0c\u8bb0\u4e3a$ans[i]$\n\n#### \u73b0\u5728\u95ee\u9898\u6765\u4e86\uff0c\u600e\u4e48\u5bb9\u65a5\n\n$\\text{\u8003\u8651ans[i]\u4e0eans[j]\u7684\u8054\u7cfb\uff08i>j\uff09\uff0c\u5b9a\u4e49\u4fdd\u8bc1ans[j]\u662f\u6070\u597d\u5339\u914dj\u4e2a\u4e32}$\n\n$\\text{\u5982\u679c\u518d\u5339\u914d\u5230i-j\u4e2a\u4e32\uff0c\u5c31\u662fans[j]}$\n\n$\\text{\u5728i\u4e2a\u4e32\u4e2d\uff0c\u8fd9i-j\u4e2a\u4e32\u7684\u9009\u62e9\u5f53\u7136\u5c31\u6709C(i,i-j)\u79cd\u65b9\u6848}$\n\n$\\text{\u6211\u4eec\u6709num[j]\uff0c\u5f97\u51fa\u516c\u5f0f}ans[j]=num[j]-\\sum{C(i,i-j)*ans[i]}$\n\n$\\text{\u5012\u5e8f\u5904\u7406ans\u6570\u7ec4\u5373\u53ef}$\n\n### \u4e0a\u4ee3\u7801\uff1a\n```\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\ntypedef long long ll;\nconst int mod=1000003;\nint t,n,k,num[20],len,c[20][20],ans[20];\nchar s[20][60];\nint ksm(int x,int t)\n{\n    int ret=1;\n    while(t)\n    {\n        if(t&1)\n            ret=(ll)ret*x%mod;\n        x=(ll)x*x%mod,t>>=1;\n    }\n    return ret%mod;\n}\nint check(int x)\n{\n    char tmp[60];\n    for(int i=0;i<len;i++)\n        tmp[i]='?';\n    int rest=len;\n    for(int i=0;i<n;i++)\n    {\n        if(x&(1<<i))\n            for(int j=0;j<len;j++)\n                if(!isalpha(tmp[j])&&isalpha(s[i+1][j]))\n                {\n                    tmp[j]=s[i+1][j];\n                    rest--;\n                }\n                else if(isalpha(tmp[j])&&isalpha(s[i+1][j])&&tmp[j]!=s[i+1][j])\n                    return 0;\n    }\n    return ksm(26,rest);\n}\nint main()\n{\n    for(int i=0;i<20;i++){\n        c[i][0]=1;\n        for(int j=1;j<=i;j++){\n            c[i][j]=(c[i-1][j-1]+c[i-1][j])%mod;\n        }\n    }\n    scanf(\"%d\",&t);\n    while(t--)\n    {\n        memset(num,0,sizeof(num));\n        scanf(\"%d%d\",&n,&k);\n        for(int i=1;i<=n;i++)\n            scanf(\"%s\",s[i]);\n        len=strlen(s[1]);\n        int mul=1;\n        if(k>n)\n        {\n            printf(\"0\\n\");\n            continue;\n        }\n        for(int i=1;i<(1<<n);i++)\n        {\n            int cnt=0;\n            for(int j=0;j<n;j++)\n                if(i&(1<<j))\n                    cnt++;\n            if(cnt<k)\n                continue;\n            (num[cnt]+=check(i))%=mod;\n        }\n        for(int i=n;i>=k;i--)\n        {\n            int sum=0;\n            for(int j=i+1;j<=n;j++)\n                (sum+=(ll)c[j][i]*ans[j]%mod)%=mod;\n            ans[i]=((num[i]-sum)%mod+mod)%mod;\n        }\n        printf(\"%d\\n\",(ans[k]%mod+mod)%mod);\n    }\n    return 0;\n}\n```",
        "postTime": 1536140170,
        "uid": 57045,
        "name": "communist",
        "ccfLevel": 7,
        "title": "P2167 \u3010[SDOI2009]Bill\u7684\u6311\u6218\u3011"
    },
    {
        "content": "\u7fa4\u53cb\u628a\u8fd9\u9898\u5f53\u4e86\u80e1\u7b56\u7684\u7b7e\u5230\u9898\uff0c\u8111\u6d1e\u4e0d\u591f\u5927\u6ca1\u628a\u5927\u5bb6\u90fd\u5728\u8bf4\u7684\u76f4\u63a5\u5bb9\u65a5\u7684\u6b63\u786e\u6027\u60f3\u51fa\u6765\uff0c\u6240\u4ee5\u6211\u5199\u4e86\u4e2a\u9ad8\u7ef4\u540e\u7f00\u5dee\u5206\uff0c\u5b83\u4e5f\u662f\u5bf9\u7684\u3002\n\n----\n\n\u5148\u8003\u8651\u6c42\u51fa\u5bf9\u4e8e\u6bcf\u4e2a\u5b57\u7b26\u4e32\u7684\u96c6\u5408 $T$ \u6c42\u51fa**\u81f3\u5c11**\u6ee1\u8db3\u8fd9\u4e2a\u96c6\u5408\u4e2d\u5b57\u7b26\u4e32\u7684\u9650\u5236\u7684\u7b54\u6848\u603b\u6570 $f(T)$\uff0c\u8fd9\u4e2a\u597d\u505a\uff0c\u76f4\u63a5\u770b\u770b\u54ea\u4e9b\u4f4d\u4e0a\u88ab\u786e\u5b9a\u5fc5\u987b\u9009\u67d0\u4e2a\u5b57\u7b26\u5373\u53ef\u3002\u53e6\u5916\u8bbe\u4e00\u4e2a**\u6070\u597d**\u6ee1\u8db3 $S$ \u4e2d\u9650\u5236\u7684\u7b54\u6848\u603b\u6570\u4e3a $g(S)$\uff0c\u5219 $f(T) = \\displaystyle\\sum_{T \\subset S}g(S)$ \u5373\u4e3a\u6240\u6709 $T$ \u7684\u8d85\u96c6 $S$ \u7684\u6070\u597d\u7684\u7b54\u6848\u4e4b\u548c\uff0c\u5176\u5b9e\u5c31\u662f\u8bf4 $f$ \u662f $g$ \u7684\u5b50\u96c6\u540e\u7f00\u548c\uff0c\u672c\u8d28\u4e0a\u662f\u4e2a\u9ad8\u7ef4\u540e\u7f00\u548c\uff0c\u505a\u4e00\u4e0b\u5b83\u7684\u9006\u8fd0\u7b97\u5373\u53ef\u5f97\u5230 $g$ \u6570\u7ec4\uff0c\u5177\u4f53\u5b9e\u73b0\u5c31\u662f\u505a\u4e00\u904d $\\operatorname{and}$ \u5377\u79ef\u7684 idmt\u3002\n\n\u6700\u540e\u7b54\u6848\u5373\u4e3a $\\displaystyle\\sum_{\\operatorname{popcount(S)} = k}g(S)$\u3002",
        "postTime": 1648047839,
        "uid": 118196,
        "name": "zimujun",
        "ccfLevel": 6,
        "title": "P2167 \u5bb9\u65a5\u7684\u53e6\u4e00\u79cd\u6253\u5f00\u65b9\u5f0f\uff1f"
    },
    {
        "content": "### [[SDOI2009]Bill\u7684\u6311\u6218](https://www.luogu.com.cn/problem/solution/P2167)\n\n\u8fd9\u9053\u9898\u53ef\u4ee5\u8fd0\u7528\u5bb9\u65a5\u539f\u7406\u89e3\u51b3\u3002\n\n\u8fd9\u91cc\u5c1d\u8bd5\u5bf9\u7b2c\u4e00\u7bc7\u9898\u89e3\u7684\u90a3\u6761\u516c\u5f0f\u4f5c\u51fa\u66f4\u5bb9\u6613\u7406\u89e3\u7684\u89e3\u91ca\u3002\n\n# solution\n\n\u6211\u4eec\u8bbe $Ans_i$ \u8868\u793a**\u6070\u597d**\u4e0e $i$ \u4e2a\u5b57\u7b26\u4e32\u5339\u914d\u7684\u5b57\u7b26\u4e32 $T$ \u7684\u4e2a\u6570\u3002\n\n\u4ece $n$ \u4e2a\u5b57\u7b26\u4e32\u91cc\u9009\u51fa $i$ \u4e2a\u5b57\u7b26\u4e32\u4e3a\u4e00\u7ec4\uff0c\u8bb0\u4e0e\u8fd9\u4e00\u7ec4\u6240\u6709\u5b57\u7b26\u4e32\u5339\u914d\u7684\u5b57\u7b26\u4e32\u4e2a\u6570\u4e3a $cnt$\uff0c\u7528 $calc_i$ \u8bb0\u6240\u6709\u7ec4\u7684 $cnt$ \u603b\u548c\u3002\n\n\u7528\u66b4\u529b\u53ef\u4ee5\u5728 $O(2^nlen \\times i)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u6c42\u51fa $calc_i$\uff0c\u4ee3\u7801\u5982\u4e0b\u3002\n\n```cpp\nint cnt;\nint Solve(string state){\n\tint x = 1;\n\trep(i , 0 , len - 1)\n\t\t(x *= (state[i] == '?') ? 26 : 1) %= MOD;\n\treturn x;\n}\nvoid dfs(int adr , int num , string state , int lim){\n\tif(num == lim){\n\t\t(cnt += Solve(state)) %= MOD;\n\t\treturn;\n\t}\n\tif(adr > n)return;\n\tdfs(adr + 1 , num , state , lim);\n\tbool flag = true;\n\trep(i , 0 , len - 1){\n\t\tif(state[i] != '?' && s[adr][i] != '?' && s[adr][i] != state[i])flag = false;\n\t\tif(s[adr][i] != '?')state[i] = s[adr][i];\n\t}\n\tif(!flag)return;\n\tdfs(adr + 1 , num + 1 , state , lim);\n}\nint calc(int num){\n\tstring state = \"\";\n\tcnt = 0;\n\trep(i , 0 , len - 1)state += '?';\n\tdfs(1 , 0 , state , num);\n\treturn cnt;\n}\n```\n\n\u73b0\u5728\u8003\u8651 $Ans_i$ \u7684\u6c42\u6cd5\u3002\n\n\u4e3e\u4e2a\u4f8b\u5b50\u4fbf\u4e8e\u7406\u89e3\u3002\n\n```\n4 2\na????\n?b???\n??c??\n???d?\n```\n\u5047\u8bbe\u73b0\u5728 $Ans_3$\uff0c$Ans_4$ \u5747\u5df2\u6c42\u51fa\u3002\n\n\u6211\u4eec\u4e00\u5f00\u59cb\u4ee4 $Ans_2=calc_2$\u3002\n\n\u5728 $calc_2$ \u4e2d\uff0c`abcdd` \u8fd9\u4e2a\u5b57\u7b26\u4e32\u4e00\u5171\u88ab\u7d2f\u8ba1\u4e86 $6$ \u6b21\uff08`{a????,?b???}`\u3001`{a????,??c??}`\u3001`{a????,???d?}`\u3001`{?b???,??c??}`\u3001`{?b???,???d?}`\u3001`{??c??,???d?}` \u8fd9 $6$ \u7ec4\u5b57\u7b26\u4e32\u4e2d\u90fd\u7d2f\u8ba1\u4e86\u4e00\u6b21\uff09\uff0c\u4f46\u663e\u7136 `abcdd` \u8fd9\u4e2a\u5b57\u7b26\u4e32\u4e0d\u5e94\u8be5\u7edf\u8ba1\u5728 $Ans_2$ \u91cc\u9762\uff0c\u56e0\u4e3a\u5b83\u6070\u597d\u53ef\u4ee5\u4e0e $4$ \u4e2a\u5b57\u7b26\u4e32\u8fdb\u884c\u5339\u914d\uff0c\u800c\u4e0d\u662f\u6070\u597d\u53ef\u4ee5\u548c $2$ \u4e2a\u5b57\u7b26\u4e32\u5339\u914d\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e `abcdd` \u8fd9\u4e2a\u5b57\u7b26\u4e32\uff0c\u6211\u4eec\u5e94\u8be5\u7528 $Ans_2$ \u51cf\u53bb $C_{4}^{2}$\u3002\n\n\u90a3\u6709\u591a\u5c11\u4e2a\u7c7b\u4f3c\u4e8e `abcdd` \u8fd9\u6837\u53ef\u4ee5\u4e0e $4$ \u4e2a\u5b57\u7b26\u4e32\u8fdb\u884c\u5339\u914d\u7684\u5b57\u7b26\u4e32\u5462\uff1f\u663e\u7136\u6709 $Ans_4$ \u4e2a\u3002\n\n\u540c\u6837\u7684\uff0c\u5bf9\u4e8e\u4f8b\u5982 `abccd` \u8fd9\u79cd\u53ef\u4ee5\u548c $3$ \u4e2a\u5b57\u7b26\u4e32\u5339\u914d\u7684\u5b57\u7b26\u4e32\uff0c\u6211\u4eec\u5e94\u8be5\u7528 $Ans_2$ \u51cf\u53bb $C_{3}^{2}Ans_3$\u3002\n\n\u4e8e\u662f\u6211\u4eec\u6700\u7ec8\u53ef\u4ee5\u5f97\u5230\u4e0b\u9762\u8fd9\u6761\u516c\u5f0f\uff1a\n\n$$Ans_i=calc_i - \\sum_{i < j \\leqslant n}Ans_j$$\n\n\u6700\u540e\u8f93\u51fa $Ans_k$ \u5373\u53ef\u3002\n\n# code\n\n```cpp\n#include<bits/stdc++.h>\n#define rep(i , m , n) for(register int i = m; i <= n; i++)\n#define drp(i , m , n) for(register int i = n; i >= m; i--)\n\nusing namespace std;\nconst int MOD = 1000003;\nint G;\nint n , k;\nint c[20][20];\nint len;\nint ans[20];\nstring s[20];\nvoid YHSJ(){\n\tc[1][0] = c[1][1] = 1;\n\trep(i , 2 , 15)\n\t\trep(j , 0 , i)\n\t\t\tc[i][j] = (j == '0') ? 1 : (c[i - 1][j - 1] + c[i - 1][j]);\n}\nint cnt;\nint Solve(string state){\n\tint x = 1;\n\trep(i , 0 , len - 1)\n\t\t(x *= (state[i] == '?') ? 26 : 1) %= MOD;\n\treturn x;\n}\nvoid dfs(int adr , int num , string state , int lim){\n\tif(num == lim){\n\t\t(cnt += Solve(state)) %= MOD;\n\t\treturn;\n\t}\n\tif(adr > n)return;\n\tdfs(adr + 1 , num , state , lim);\n\tbool flag = true;\n\trep(i , 0 , len - 1){\n\t\tif(state[i] != '?' && s[adr][i] != '?' && s[adr][i] != state[i])flag = false;\n\t\tif(s[adr][i] != '?')state[i] = s[adr][i];\n\t}\n\tif(!flag)return;\n\tdfs(adr + 1 , num + 1 , state , lim);\n}\nint calc(int num){\n\tstring state = \"\";\n\tcnt = 0;\n\trep(i , 0 , len - 1)state += '?';\n\tdfs(1 , 0 , state , num);\n\treturn cnt;\n}\nint main(){\n\tcin >> G;\n\tYHSJ();\n\twhile(G--){\n\t\tmemset(ans , 0 , sizeof ans);\n\t\tcin >> n >> k;\n\t\trep(i , 1 , n)cin >> s[i];\n\t\tlen = s[1].size();\n\t\tdrp(i , k , n){\n\t\t\tint tot = 0;\n\t\t\trep(j , i + 1 , n)\n\t\t\t\t(tot += c[j][i] * ans[j]) %= MOD;\n\t\t\tans[i] = (calc(i) - tot + MOD) % MOD;\n\t\t}\n\t\tcout << ans[k] << '\\n';\t\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1684156333,
        "uid": 59691,
        "name": "\u51d1\u4e2a\u70ed\u95f9\u5416",
        "ccfLevel": 7,
        "title": "[SDOI2009]Bill\u7684\u6311\u6218\u2014\u2014\u5bb9\u65a5"
    },
    {
        "content": "## Solution 1\n\n\u76f4\u63a5\u88f8\u72b6\u538b dp \u3002\u7ec6\u8282\u89c1\u4ee3\u7801\u3002\n\n```cpp\n#define int long long\n#define Rpp(i, n) for(int i=1; i<=(int)n; i++)\n#define Rep(i, n) for(int i=0; i< (int)n; i++)\n#define Frr(i, s, e) for(int i=(int)s; i<=(int)e; i++)\n#define Mem0(cont) memset(cont, 0, sizeof(cont))\n\nstring s[19];\nint dp[55][1 << 17]; //dp[i][S] \u8868\u793a\u7b2c i \u4f4d\u53ea\u80fd\u8ba9 S \uff08\u96c6\u5408\uff09\u7684\u5b57\u7b26\u4e32\u4e0d\u5339\u914d\u7684\u65b9\u6848\u6570\u3002\n                     //\u6ce8\u610f S \u7684\u7b2c j \u4f4d\u4e3a 0 \u4ee3\u8868\u5339\u914d\uff0c\u4e3a 1 \u4ee3\u8868\u4e0d\u5339\u914d\u3002\n\nvoid Main()\n{\n\tMem0(dp);\n\tint n, k; cin >> n >> k;\n\tRpp(i, n) cin >> s[i];\n\tdp[0][0] = 1; int res = 0;\n\tRep(i, s[1].size()) Rep(j, 1<<n)\n\t\tif(dp[i][j]) Frr(k, 'a', 'z') //\u8981\u52a0\u4e00\u4e0b if(dp[i][j]) \uff0c\u8981\u4e0d\u4f1a TLE \u3002\n\t\t{\n\t\t\tint now = j;\n\t\t\tRpp(l, n) if(s[l][i] != '?' && s[l][i] != k)\n\t\t\t\tnow |= (1<<(l-1)); //now -> \u76ee\u524d\u7684\u72b6\u51b5\n\t\t\t(dp[i+1][now] += dp[i][j]) %= 1000003; //\u5237\u8868\u6cd5\n\t\t}\n//\tRep(i, s[1].size()) Rep(j, 1<<n) cout << i << ' ' << j << ' ' << dp[i][j] << endl;\n\tRep(i, 1<<n) if(__builtin_popcount(i) == n-k) //n-k \u5c31\u662f\u56e0\u4e3a i \u662f\u53d6\u53cd\u540e\u7684\u7ed3\u679c\u3002\n\t\t(res += dp[(int)s[1].size()][i]) %= 1000003;\n\tcout << res << endl;\n}\n```\n\n\n\n## Solution 2\n\n\u9884\u5904\u7406\u51fa `dp[S]` \u3002`dp[S]` \u8868\u793a\u5339\u914d\u4e86\u7528 $S$ \u6765\u8868\u793a\u7684\u5b57\u7b26\u4e32\u7684\u65b9\u6848\u6570\u3002\u5176\u4e2d\uff0c\u5982\u679c $S$ \u7684\u7b2c $i$ \u4f4d\u4e3a $1$ \uff0c\u5219\u4e00\u5b9a\u5339\u914d\u4e86\u7b2c $i$ \u4e2a\u5b57\u7b26\u4e32\u3002\u5426\u5219\uff0c\u5219\u8868\u793a\u7b2c $i$ \u4e2a\u5b57\u7b26\u4e32 **\u53ef\u80fd\u5339\u914d\uff0c\u4e5f\u53ef\u80fd\u4e0d\u5339\u914d** \u3002\n\n\u5b9a\u4e49\u4e00\u4e2a `dq[S]` \u8868\u793a\u5339\u914d\u4e86\u7528 $S$ \u6765\u8868\u793a\u7684\u5b57\u7b26\u4e32\u7684\u65b9\u6848\u6570\u3002\u5176\u4e2d\uff0c\u5982\u679c $S$ \u7684\u7b2c $i$ \u4f4d\u4e3a $1$ \uff0c\u5219\u4e00\u5b9a\u5339\u914d\u4e86\u7b2c $i$ \u4e2a\u5b57\u7b26\u4e32\u3002\u5426\u5219\uff0c\u5219\u8868\u793a\u7b2c $i$ \u4e2a\u5b57\u7b26\u4e32 **\u4e00\u5b9a\u4e0d\u5339\u914d** \u3002\u5219\u7b54\u6848\u4e3a\n\n$$\n\\sum_{S}^{\\operatorname{popcount}(S) = k \\texttt{ \\  and \\  } S < 2^n} \\text{dq}_S\n$$\n\n\u73b0\u5728\u6211\u4eec\u6765\u770b\u770b\u5982\u4f55\u8ba1\u7b97 `dq[S]` \u3002\u6211\u4eec\u53d1\u73b0\u4e00\u4e2a\u6027\u8d28\uff1a\n$$\n\\text{dq}_S = \\text{dp}_S - \\sum_{S^{'}}^{S^{'}\\&S = S \\texttt{ \\  and \\  } S < S^{'} < 2^n} \\text{dq}_S\n$$\n\n\n\u4e8e\u662f\u5c31\u662f\u8fd9\u6837\uff1a\n\n```cpp\nfor(int i=(1<<n)-1; i; i--)\n    for(int j=i&(i-1); j; j=(j-1)&i)\n        dp[j] -= dp[i]; //\u5012\u7740\u5faa\u73af\uff0c\u8fd9\u65f6\u7684 dp[i] \u5176\u5b9e\u5df2\u7ecf\u88ab\u66f4\u65b0\u8fc7\u4e86\uff0c\u662f\u4e0a\u6587\u7684 dq[i]\n```\n\n**\u5176\u5b9e\u8fd8\u6709\u4e00\u79cd\u53eb\u9ad8\u7ef4\u540e\u7f00\u5dee\u7684\u7b97\u6cd5\uff0c\u53ef\u4ee5\u628a** $O(3^n)$ **\u7684\u590d\u6742\u5ea6\u4f18\u5316\u6210** $O(2^n \\times n)$ **\uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\uff0c\u8bf7\u81ea\u884c\u67e5\u9605\u8d44\u6599\u3002**\n\n`dp[S]` \u7684\u9884\u5904\u7406\u4ee3\u7801\u5c31\u4e0d\u653e\u5566\u3002\n\n",
        "postTime": 1647416818,
        "uid": 380730,
        "name": "LKX_Wata",
        "ccfLevel": 7,
        "title": "P2167 \u9898\u89e3"
    },
    {
        "content": "\u8fd9\u9053\u9898\u6211\u4eec\u53ef\u4ee5\u4ee4 dp[i][j] \u4e3a\u5728\u72b6\u6001j\u4e0b\u7b2ci\u4f4d\u53ef\u4ee5\u9009\u7684\u65b9\u6848\u6570\n\n\u4f46\u4ed4\u7ec6\u60f3\u4e00\u60f3\u4f1a\u53d1\u73b0\u8fd9\u6837\u6ca1\u6709\u8003\u8651\u5230\u5f53\u95ee\u53f7\u4e32\u4e2d\u6709\u660e\u786e\u5b57\u6bcd\u7684\u60c5\u51b5\u3002\u4e00\u5f00\u59cb\u6211\u7684\u601d\u8def\u662f\u5bb9\u65a5\uff0c\u4f46\u6211\u6570\u5b66\u592a\u83dc\u4e86\uff0c\u4e0d\u4f1a\u641e\u3002\u6240\u4ee5\u540e\u6765\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u5728\u7b2c i \u4f4d\u65f6\uff0c\u5b57\u6bcd\u662f j \u7684\u60c5\u51b5\u4e00\u5171\u6709\u54ea\u4e9b\u5b57\u7b26\u4e32\uff0c\u7136\u540e\u6839\u636e\u8fd9\u4e2a\u5b58\u5728\u6570\u7ec4 g[i][j] \u91cc\u3002\n\n\u7136\u540e\u6211\u4eec\u4fbf\u53ef\u4ee5\u63a8\u51fa\u516c\u5f0f\n\n```latex\ndp[i][j&g[i][k]]=(dp[i][j&g[i][k]]+dp[i-1][j])\n```\n\n\n\u4ee3\u7801\u5982\u4e0b\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint T;\nint g[55][31];\nint dp[55][40001];\nconst int mod=1e6+3;\nchar s[16][52];\nint solve(){\n    int n,k;\n    scanf(\"%lld %lld\",&n,&k);\n    \n    int ans=0;\n    scanf(\"%lld %lld\",&n,&k);\n    //cout<<n<<k<<endl;\n    memset(dp,0,sizeof(dp));\n    memset(g,0,sizeof(g));\n    //cout<<1<<endl;\n    for(int i=1;i<=n;i++)\n        scanf(\"%s\",s[i]+1);\n    int len=strlen(s[1]+1);\n    for(int i=1;i<=len;i++){\n        for(int j=0;j<26;j++){\n            for(int k=1;k<=n;k++){\n                //cout<<1<<endl;\n                if(s[k][i]=='?'||s[k][i]==j+'a')g[i][j]|=(1<<k-1);\n            }\n        }\n    }\n    int sum=1<<n;\n    sum--;\n    dp[0][sum]=1;\n    //cout<<len<<endl;\n    for(int i=1;i<=len;i++){\n        for(int j=0;j<=sum;j++){\n            if(dp[i-1][j]){\n                for(int k=0;k<26;k++){\n                    dp[i][j&g[i][k]]=(dp[i][j&g[i][k]]+dp[i-1][j])%mod;\n                }\n            }\n        }\n    }\n    for(int i=0;i<=sum;i++){\n        int x=i,chk=0;\n        while(x){\n            if(x&1)chk++;\n            x=x>>1;\n        }\n        if(chk==k)ans=(ans+dp[len][i])%mod;\n        //cout<<dp[len][i]<<endl;\n    }\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\nsigned main(){\n    scanf(\"%lld\",&T);\n    //cout<<1<<endl;\n    while(T--){\n        //cout<<1<<endl;\n        solve();\n    }\n    return 0;\n}\n```\n",
        "postTime": 1647415282,
        "uid": 454955,
        "name": "ktq_cpp",
        "ccfLevel": 7,
        "title": "Bill\u7684\u6311\u6218"
    },
    {
        "content": "\u6570\u636e\u89c4\u6a21\u4e0e\u7ea6\u5b9a:\n\n\u5bf9\u4e8e $100\\%$ \u7684\u6570\u636e\uff0c$1\\le T\\le 5,1\\le N \\le15$\n\n\u4e00\u773c\u72b6\u538b\u65e0\u7591\u4e86\u3002\n\n\u7136\u540e\u5c31\u6bd4\u8f83\u81ea\u7136\u5730\u60f3\u5230\u5c06\u80fd\u591f\u5339\u914d\u7684\u538b\u5230\u4e00\u4e2a\u96c6\u5408 $S$ \u4e2d\u3002\n\n\u72b6\u6001\u8bbe\u8ba1\uff1a$f_{i,S}$ \u8868\u793a\u5f53\u524d\u5339\u914d\u5230\u7b2c $i$ \u4e2a\u5b57\u7b26\uff0c\u80fd\u591f\u5339\u914d\u7684\u5b57\u7b26\u4e32\u96c6\u5408\u4e3a $S$ \u7684\u5b57\u4e32\u4e2a\u6570\u3002\n\n\u8f6c\u79fb\u5c31\u6bd4\u8f83\u663e\u7136\u4e86\uff1a$f_{i+1,S \\cap S'}=\\sum \\limits_{ch=\\texttt{a}} ^{\\texttt{z}}f_{i,S}$ \uff08\u5176\u4e2d $S'$ \u8868\u793a\u53ea\u8003\u8651\u7b2c $i + 1$ \u4f4d\u53d6 $ch$ \u80fd\u5339\u914d\u7684\u5b57\u7b26\u4e32\u96c6\uff0c\u4e0e\u539f\u6709\u7684\u80fd\u5339\u914d\u7684\u5b57\u7b26\u4e32\u96c6 $S$ \u6c42\u4ea4\u5c31\u662f\u5f53\u524d\u8fd9\u4f4d\u53d6 $ch$ \u65f6\u524d $i + 1$ \u4f4d\u90fd\u80fd\u5339\u914d\u7684\u5b57\u7b26\u4e32\u96c6\uff09\u3002\n\n\u7136\u540e\u8003\u8651\u5c06\u6240\u6709\u7684 $S'$ \u9884\u5904\u7406\u51fa\u6765\uff0c\u8bb0 $g_{i,ch}$ \u8868\u793a\u7b2c $i$ \u4f4d\u53d6\u5b57\u7b26 $ch$ \u65f6\u5f53\u524d\u8fd9\u4f4d\u80fd\u5339\u914d\u7684\u5b57\u7b26\u4e32\u96c6\u3002\n\n\u7136\u540e\u8f6c\u79fb\u65b9\u7a0b\u5c31\u662f\uff1a \n\n$$f_{i+1,S \\cap {g_{i+1,ch}}}= \\sum \\limits_{ch=\\texttt{a}} ^{\\texttt{z}} f_{i,S}$$\n\n\u663e\u7136 $O(26\\times2^n\\times m)$\uff0c\u80fd\u8fc7\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\ninline void read(int &x)\n{\n\tx = 0;\n\tint f = 0;\n\tchar ch = getchar();\n\twhile(ch < '0' || ch > '9')\n\t{\n\t\tf |= ch == '-';\n\t\tch = getchar();\n\t}\n\twhile(ch >= '0' && ch <= '9')\n\t{\n\t\tx = x * 10 + ch - 48;\n\t\tch = getchar();\n\t}\n\tx = f ? -x : x;\n\treturn;\n}\nconst int mod = 1000003;\n#define N 16\n#define M 55\nint n, m, k;\nchar s[N][M];\nint f[M][1 << N], g[M][26];\nsigned main()\n{\n\tint T;\n\tread(T);\n\twhile(T--)\n\t{\n\t\tread(n), read(k);\n\t\tfor(int i = 1; i <= n; i++)\n\t\t{\n\t\t\tscanf(\"%s\", s[i] + 1);\n\t\t}\n\t\tm = strlen(s[1] + 1);\n\t\tmemset(f, 0, sizeof(f)), memset(g, 0, sizeof(g));\n\t\tfor(int i = 1; i <= m; i++)\n\t\t{\n\t\t\tfor(int j = 1; j <= n; j++)\n\t\t\t{\n\t\t\t\tfor(int ch = 0; ch < 26; ch++)\n\t\t\t\t{\n\t\t\t\t\tif(s[j][i] - 'a' == ch || s[j][i] == '?')\n\t\t\t\t\t{\n\t\t\t\t\t\tg[i][ch] |= (1 << (j - 1));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tf[0][(1 << n) - 1] = 1;\n\t\tfor(int i = 0; i < m; i++)\n\t\t{\n\t\t\tfor(int state = 0; state < (1 << n); state++)\n\t\t\t{\n\t\t\t\tif(!f[i][state])\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tfor(int ch = 0; ch < 26; ch++)\n\t\t\t\t{\n\t\t\t\t\tf[i + 1][state & g[i + 1][ch]] = (f[i + 1][state & g[i + 1][ch]] + f[i][state]) % mod;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans = 0;\n\t\tfor(int state = 0; state < (1 << n); state++)\n\t\t{\n\t\t\tint tot = 0;\n\t\t\tfor(int i = 0; i < n; i++)\n\t\t\t{\n\t\t\t\tif(state & (1 << i))\n\t\t\t\t{\n\t\t\t\t\ttot++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(tot == k)\n\t\t\t{\n\t\t\t\tans = (ans + f[m][state]) % mod;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\", ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1636253854,
        "uid": 90027,
        "name": "GG_jok_er",
        "ccfLevel": 0,
        "title": "P2167 [SDOI2009]Bill\u7684\u6311\u6218 \u9898\u89e3"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.moyujiang.com/969.html)\n\n\u9898\u610f\uff1a\n\n\u7ed9\u5b9a $n$ \u4e2a\u957f\u5ea6\u4e3a $l$ \u7684\u5b57\u7b26\u4e32 $s_{1...n}$\uff0c\u4e32\u7531\u5c0f\u5199\u5b57\u6bcd\u548c\u5b57\u7b26 `?` \u6784\u6210\uff0c\u5b9a\u4e49\u4e32 $s_x$ \u548c\u4e32 $t$ \u5339\u914d\uff0c\u5f53\u4e14\u4ec5\u5f53\u6ee1\u8db3\uff1a\n\n - $|t|=l$\n - $\\forall i\\in[1,l],t[i]=s_x[i]\\text\u6216s_x[i]= ?$\n\n\u6c42\u6709\u591a\u5c11\u4e2a\u4e32 $t$ \u6070\u597d\u5339\u914d $k$ \u4e2a $s_x$\u3002\n\n$1\\leq n\\leq15,1\\leq l\\leq50,k\u22651$\u3002\n\n\u8fd9\u6570\u636e\u8303\u56f4\u7206\u641c\u5c31\u597d\u4e86\u3002\n\n\u679a\u4e3e\u9009 $k$ \u4e2a\u4e32\u5339\u914d\uff0c\u6bcf\u4e2a\u4f4d\u7f6e\u8981\u4e48\u6709\u56fa\u5b9a\u7684\u5b57\u6bcd\uff0c\u8981\u4e0d\u5c31\u5168\u662f `?`\uff0c\u7edf\u8ba1\u4e00\u4e0b\u5373\u53ef\u3002\u8fd9\u4e00\u6b65\u662f\u7206\u641c\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(2^n*n*l)$\n\n\u4f46\u662f\u53d1\u73b0\u5b83\u53ef\u80fd\u4e0d\u4e00\u5b9a\u53ea\u5339\u914d\u4e86\u679a\u4e3e\u7684\u8fd9 $k$ \u4e2a\u4e32\uff0c\u6bd4\u5982 $5$ \u4e2a\u4e32\u7684\u6240\u6709\u5143\u7d20\u90fd\u662f `?`\uff0c $k=1$\uff0c\u7b54\u6848\u5c31\u662f $0$\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53d1\u73b0\uff0c\u521a\u521a\u679a\u4e3e\u7684\u662f**\u81f3\u5c11**\u5339\u914d\u6211\u4eec\u9009\u62e9\u7684 $k$ \u4e2a\u4e32\u7684\u4e32\u6570\uff0c\u800c\u9898\u76ee\u8981\u6c42\u7684\u662f**\u6070\u597d**\u5339\u914d $k$ \u4e2a\u4e32\u7684\u4e32\u6570\uff0c\u6240\u4ee5\u5957\u4e2a\u4e8c\u9879\u5f0f\u53cd\u6f14\u5c31\u597d\u4e86\u3002\n\n[\u4e8c\u9879\u5f0f\u53cd\u6f14\u57fa\u7840](https://www.moyujiang.com/968.html)\n\n[\u5b8c\u6574\u4ee3\u7801Link](https://www.luogu.com.cn/paste/yo3j3wo9)\n \n\u8fd8\u662f\u86ee\u5feb\u7684\uff0c\u6211\u8fd9\u6837\u7684\u5927\u5e38\u6570\u9009\u624b\u90fd\u80fd\u4e0d\u5f00 O2 \u5361\u8fdb\u6700\u4f18\u89e3\u7b2c\u4e00\u9875\u3002",
        "postTime": 1618843179,
        "uid": 173685,
        "name": "\u6478\u9c7c\u9171",
        "ccfLevel": 8,
        "title": "P2167 [SDOI2009]Bill\u7684\u6311\u6218"
    },
    {
        "content": "# [\u67d0\u5ba2\u98df\u7528\u4f53\u9a8c\u66f4\u4f73](\n\n[\u67d0\u9001\u95e8](https://www.luogu.com.cn/problem/P2167)\n\n~~\u770b\u6570\u636e\u8303\u56f4\u662f\u4e00\u79cd\u4f18\u826f\u7684\u4f20\u7edf~~\uff0c\u672c\u9898 $N\\leq 15$\uff0c\u72b6\u538b\u65e0\u7591\u4e86QAQ\u3002\n\n\u7136\u540e\u6211\u4eec\u770b\u5230\uff1a**\u521a\u597d\u4e0e $K$ \u4e2a\u4e32\u5339\u914d\u7684\u4e2a\u6570**\uff0c\u5c31\u60f3\u5230\u4e86\u5bb9\u65a5\u3002\n\n~~\u611f\u89c9\u81ea\u5df1\u601d\u7ef4\u597d\u8df3\u8dc3\u554a\u4e0d\u8fc7\u4f3c\u4e4e\u4e5f\u662f\u6b63\u5e38\u601d\u8def\uff1f~~\n\n\u7531\u4e8e\u662f\u4e0e $K$ \u4e2a\u4e32\u5339\u914d\uff0c\u4e0d\u80fd\u5355\u7eaf\u7684\u201c\u5947\u52a0\u5076\u51cf\u201d\uff0c\u6211\u4eec\u7528 $f[i]$ \u8868\u793a\u6070\u597d\u4e0e $K$ \u4e2a\u4e32\u5339\u914d\u7684\u4e32\u7684\u4e2a\u6570\uff0c$Cnt[i]$ \u8868\u793a\u4e0e**\u81f3\u5c11** $K$ \u4e2a\u4e32\u5339\u914d\u7684\u4e32\u7684\u4e2a\u6570\u3002\n\n\u753b\u51e0\u4e2a\u97e6\u6069\u56fe\uff08~~\u4e0d\u8fc7\u633a\u96be\u753b\u7684~~\uff09\uff0c\u53ef\u4ee5\u53d1\u73b0\u5bf9\u4e8e\u6bcf\u4e2a\u8868\u793a\u4e0e\u81f3\u5c11 $K$ \u4e2a\u4e32\u5339\u914d\u7684\u4e2a\u6570\u7684\u201c\u5706\u5708\u201d\u90fd\u6709\u4ea4\u96c6\uff0c\u6240\u4ee5\u6211\u4eec\u4f9d\u6b21\u51cf\u53bb\u8fd9\u4e9b\u4ea4\u96c6\uff1a\n\n$f[i]=Cnt[i]-\\sum\\limits^N_{i+1} C[j][i] * f[j]$\n\n\u5bf9\u4e8e $Cnt$ \u6570\u7ec4\u7684\u8ba1\u7b97\uff0c\u8981\u6839\u636e\u6bcf\u4e2a\u5b57\u7b26\u4e32\u7684\u96c6\u5408\u7b97\u51fa\u5b83\u4eec\u7684\u4ea4\u96c6\uff0c\u7136\u540e\u6839\u636e\u8fd9\u4e9b\u96c6\u5408\u8868\u793a\u7684\u5b57\u7b26\u4e32\u7684\u4e2a\u6570\u6765\u5224\u65ad\u5e94\u8be5\u628a\u5b83\u52a0\u5230\u54ea\u4e2a $Cnt$ \u4e2d\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u5f88\u7b80\u5355\uff0c\u8be6\u89c1\u4ee3\u7801\uff08\u8bdd\u8bf4\u8fd9\u4e2a\u90e8\u5206\u6211\u5f00\u59cb\u4ee5\u4e3a\u81ea\u5df1\u7684\u601d\u8def\u6709\u95ee\u9898\uff0c\u53c8\u662fdebug\u53c8\u662f\u5728\u8349\u7a3f\u7eb8\u4e0a\u753b\u6765\u753b\u53bb\uff0c\u6700\u540e\u770b\u4e86\u9898\u89e3\u4e00\u6012\u4e4b\u4e0b\u5220\u4e86 $^{tm}$ \u4e00\u5927\u6bb5\u4ee3\u7801\u76f4\u63a5 $A$ \u4e86\u3002\uff08~~\u67af\u4e86~~\uff09\n\n\u7801\u98ce\u8d3c\u4e11\uff0c\u89c1\u8c05\u3002\n\n# $Code:$\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#define MOD 1000003\n#define MAXS 1 << 16\n#define lowbit(x) (x & ~x + 1)\n#define max(x, y) (x > y ? x : y)\n\nchar S[16][51], Union[MAXS][51];\nint Pow[51] = {1}, Log[MAXS], bitlen[MAXS], C[16][16], f[16], Cnt[20];\nbool vis[MAXS];\n\nint main() {\n\tfor (int i(1); i <= 50; ++ i) Pow[i] = Pow[i - 1] * 26 % MOD;\n\tfor (int i(0); i < 16; ++ i) Log[1 << i] = i;\n\tfor (register int i(1); i < MAXS; ++ i) bitlen[i] = bitlen[i ^ lowbit(i)] + 1;\n\tfor (int i(0); i <= 15; ++ i) {\n\t\tC[i][0] = 1;\n\t\tfor (int j(1); j <= i; ++ j) C[i][j] = (C[i - 1][j - 1] + C[i - 1][j]) % MOD;\n\t}\n\tint T;\n\tscanf(\"%d\", &T);\n\twhile (T --) {\n\t\tint N, K, len;\n\t\tscanf(\"%d%d\", &N, &K);\n\t\tmemset(vis, 0, sizeof(vis)), memset(Cnt, 0, sizeof(Cnt));\n\t\tfor (register int i(0); i < N; ++ i) scanf(\"%s\", S[i]);\n\t\tlen = strlen(S[0]);\n\t\tmemset(Union, '\\0', sizeof(Union));\n\t\tfor (register int i(0); i < 50; ++ i) Union[0][i] = '?';\n\t\t\n\t\tfor (register int i(1); i < 1 << N; ++ i) {\n\t\t\tif (!vis[i ^ lowbit(i)]) strcpy(Union[i], Union[i ^ lowbit(i)]);\n\t\t\telse {vis[i] = true; continue;}\n\t\t\t\n\t\t\tregister char * s(S[Log[lowbit(i)]]), * Uni(Union[i]);\n\t\t\tfor (register int j(0); j < len; ++ j)\n\t\t\tif (Uni[j] != '?' && s[j] != '?' && Uni[j] != s[j]) {vis[i] = true; break;}\n\t\t\telse if (s[j] != '?') Uni[j] = s[j];\n\t\t}\n\t\t\n\t\tfor (register int i(1); i < 1 << N; ++ i) if (!vis[i] && bitlen[i] >= K) {\n\t\t\tint cnt(0);\n\t\t\tfor (register int j(0); j < len; ++ j) if (Union[i][j] == '?') ++ cnt;\n\t\t\t(Cnt[bitlen[i]] += Pow[cnt]) %= MOD;\n\t\t}\n\t\t\n\t\tfor (int i(N); i >= K; -- i) {\n\t\t\tf[i] = Cnt[i];\n\t\t\tint sum(0);\n\t\t\tfor (int j(i + 1); j <= N; ++ j)\n\t\t\tsum += C[j][i] * f[j], sum = (sum + MOD) % MOD;\n\t\t\tf[i] = ((f[i] - sum) % MOD + MOD) % MOD;\n\t\t}\n\t \tprintf(\"%d\\n\", f[K]);\n\t}\n}\n````",
        "postTime": 1605613931,
        "uid": 361308,
        "name": "Stinger",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2167 \u3010[SDOI2009]Bill\u7684\u6311\u6218\u3011"
    },
    {
        "content": "> \u6d1b\u8c37 P2167\n\n> \u9898\u610f\uff1a\u7ed9\u51fa $n$ \u4e2a\u542b\u95ee\u53f7\uff0c\u5e76\u4e14\u957f\u5ea6\u76f8\u7b49\u7684\u5b57\u7b26\u4e32\uff0c\u6c42\u6709\u591a\u5c11\u4e2a\u957f\u5ea6\u4e0e\u5b83\u4eec\u76f8\u7b49\u7684\u5b57\u7b26\u4e32\uff0c\u80fd\u591f\u4e0e\u8fd9 $n$ \u4e2a\u5b57\u7b26\u4e32\u4e2d\u6070\u597d $k$ \u4e2a\u5339\u914d\u3002\u7b54\u6848\u5bf9 $10^6+3$ \u53d6\u6a21\u3002\n\n> $1 \\leq n \\leq 15$\uff0c\u5b57\u7b26\u4e32\u957f\u5ea6\u4e0d\u8d85\u8fc7 $50$\u3002\n\n\u4e3a\u4ec0\u4e48\u5927\u4f6c\u90fd\u559c\u6b22\u7528\u5bb9\u65a5\u554a /yiw\uff0c\u4e00\u4e2a\u7528\u72b6\u538b dp \u7684\u5c0f\u849f\u84bb\u745f\u745f\u53d1\u6296 /fad\n\n\u770b\u5230 $1 \\leq n \\leq 15$ \u81ea\u7136\u53ef\u4ee5\u60f3\u5230\u72b6\u538b\u3002\u6211\u4eec\u8003\u8651\u4e00\u4f4d\u4e00\u4f4d\u5730\u586b\u5145\u3002$dp[i][j]$ \u8868\u793a\u586b\u5145\u5230\u7b2c $i$ \u4f4d\uff0c\u53ef\u4ee5\u5339\u914d\u7684\u5b57\u7b26\u4e32\u96c6\u5408\u4e3a $j$ \u7684\u65b9\u6848\u6570\u3002\n\n\u90a3\u4e48\u6211\u4eec\u679a\u4e3e\u7b2c $i$ \u4f4d\u586b\u7684\u4ec0\u4e48\u5b57\u7b26\uff0c\u7136\u540e\u518d\u679a\u4e3e\u6bcf\u4e2a\u5b57\u7b26\u4e32\u770b\u770b\u54ea\u4e9b\u5b57\u7b26\u4e32\u662f\u5426\u80fd\u591f\u4e0e\u5b83\u5339\u914d\uff0c\u5047\u8bbe\u8868\u793a\u4e3a\u4e8c\u8fdb\u5236\u96c6\u5408\u4e3a $t$\uff0c\u90a3\u4e48\u53ef\u4ee5\u4ece $dp[i-1][j]$ \u8f6c\u79fb\u5230 $dp[i][j\\&t]$\uff0c\u5176\u4e2d $\\&$ \u4e3a\u6309\u4f4d\u4e0e\u3002\n\n\u8fb9\u754c $dp[0][2^n-1]=1$\n\n\u6700\u7ec8\u8981\u6c42\u7684\u7b54\u6848\u5c31\u662f $\\sum dp[k][s]$ \u5176\u4e2d $k$ \u4e3a\u5b57\u7b26\u4e32\u957f\u5ea6\uff0c$s$ \u7684\u4e8c\u8fdb\u5236\u4e2d $1$ \u7684\u4e2a\u6570\u521a\u597d\u4e3a $m$\u3002\n\n\u4e0d\u8fc7\u8fd9\u6837\u662f $\\mathcal O(26 \\times 2^n \\times n \\times m)$ \u7684\uff0c\u8fd8\u662f\u6ca1\u6cd5\u8fc7\u53bb\u3002\u4f46\u662f\u53d1\u73b0\u8f6c\u79fb\u5230\u65f6\u5019\u7684\u72b6\u6001\u96c6\u5408 $t$ \u4e0e\u5f53\u524d\u7684\u72b6\u6001\u65e0\u5173\u3002\u56e0\u6b64\u53ea\u8981\u9884\u5904\u7406\u51fa\u72b6\u6001\u96c6\u5408 $t$ \u5c31\u53ef\u4ee5\u7701\u53bb\u4e00\u4e2a $n$ \u4e86\u3002\n\n~~\u53c8\u6c34\u4e86\u4e00\u7247\u9898\u89e3\u3002~~\n\n```cpp\n//Coded by tzc_wk\n/*\n\u6570\u636e\u4e0d\u6e05\u7a7a\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u591a\u6d4b\u4e0d\u8bfb\u5b8c\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8fb9\u754c\u4e0d\u7279\u5224\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8d2a\u5fc3\u4e0d\u8bc1\u660e\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\nD P \u987a\u5e8f\u9519\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u5927\u5c0f\u5c11\u7b49\u53f7\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u53d8\u91cf\u4e0d\u7edf\u4e00\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8d8a\u754c\u4e0d\u5224\u65ad\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8c03\u8bd5\u4e0d\u6ce8\u91ca\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u6ea2\u51fa\u4e0d l l\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n*/\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi\t\t\tfirst\n#define se\t\t\tsecond\n#define fz(i,a,b)\tfor(int i=a;i<=b;i++)\n#define fd(i,a,b)\tfor(int i=a;i>=b;i--)\n#define foreach(it,v) for(__typeof(v.begin()) it=v.begin();it!=v.end();it++)\n#define all(a)\t\ta.begin(),a.end()\n#define giveup(...) return printf(__VA_ARGS__),0;\n#define fill0(a)\tmemset(a,0,sizeof(a))\n#define fill1(a)\tmemset(a,-1,sizeof(a))\n#define fillbig(a)\tmemset(a,0x3f,sizeof(a))\n#define fillsmall(a) memset(a,0xcf,sizeof(a))\n#define mask(a)\t\t(1ll<<(a))\n#define maskx(a,x)\t((a)<<(x))\n#define _bit(a,x)\t(((a)>>(x))&1)\n#define _sz(a)\t\t((int)(a).size())\n#define filei(a)\tfreopen(a,\"r\",stdin);\n#define fileo(a)\tfreopen(a,\"w\",stdout);\n#define fileio(a) \tfreopen(a\".in\",\"r\",stdin);freopen(a\".out\",\"w\",stdout)\n#define eprintf(...) fprintf(stderr,__VA_ARGS__)\n#define put(x)\t\tputchar(x)\n#define eoln        put('\\n')\n#define space\t\tput(' ')\n#define y1\t\t\ty_chenxiaoyan_1\n#define y0\t\t\ty_chenxiaoyan_0\ntypedef pair<int,int> pii;\ninline int read(){\n\tint x=0,neg=1;char c=getchar();\n\twhile(!isdigit(c)){\n\t\tif(c=='-')\tneg=-1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c))\tx=x*10+c-'0',c=getchar();\n\treturn x*neg;\n}\ninline void print(int x){\n\tif(x<0){\n\t\tputchar('-');\n\t\tprint(abs(x));\n\t\treturn;\n\t}\n\tif(x<=9)\tputchar(x+'0');\n\telse{\n\t\tprint(x/10);\n\t\tputchar(x%10+'0');\n\t}\n}\ninline int qpow(int x,int e,int _MOD){\n\tint ans=1;\n\twhile(e){\n\t\tif(e&1)\tans=ans*x%_MOD;\n\t\tx=x*x%_MOD;\n\t\te>>=1;\n\t}\n\treturn ans;\n}\nint n,m,k,dp[55][32768],msk[55][26];\nchar s[17][55];\nconst int MOD=1e6+3;\ninline void solve(){\n\tn=read(),k=read();\n\tfz(i,1,n)\tscanf(\"%s\",s[i]+1);\n\tm=strlen(s[1]+1);\n\tfill0(dp);fill0(msk);\n\tint whole=(1<<n)-1;\n\tdp[0][whole]=1;\n\tfz(i,1,m){\n\t\tfor(int j=0;j<26;j++){\n\t\t\tfor(int o=1;o<=n;o++){\n\t\t\t\tif(s[o][i]=='?'||s[o][i]-'a'==j){\n\t\t\t\t\tmsk[i][j]|=(1<<(o-1));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=0;i<m;i++){\n\t\tfor(int j=0;j<(1<<n);j++){\n\t\t\tfor(int l=0;l<26;l++){\n\t\t\t\tint nt=j&msk[i+1][l];\n\t\t\t\tdp[i+1][nt]+=dp[i][j];\n\t\t\t\tif(dp[i+1][nt]>=MOD)\tdp[i+1][nt]-=MOD;\n\t\t\t}\n\t\t}\n\t}\n\tint ans=0;\n\tfor(int i=0;i<(1<<n);i++){\n\t\tif(__builtin_popcount(i)==k){\n\t\t\tans=(ans+dp[m][i])%MOD;\n\t\t}\n\t}\n\tcout<<ans<<endl;\n}\nsigned main(){\n\tint T=read();\n\twhile(T--)\tsolve();\n\treturn 0;\n}\n```",
        "postTime": 1584524991,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2167 \u3010[SDOI2009]Bill\u7684\u6311\u6218\u3011"
    },
    {
        "content": "# \u601d\u8def\n\n$f[i][j]$\u8868\u793a\u7b2c$i$\u4f4d\u5339\u914d$j$(\u4e8c\u8fdb\u5236\u8868\u793a\u7684)\u5b57\u7b26\u4e32\u3002  \n\u7136\u540e\u9884\u5904\u7406\u4e00\u4e0b\u6bcf\u4e00\u4f4d\u7684\u6bcf\u4e00\u4e2a\u5b57\u7b26\u80fd\u5339\u914d\u54ea\u4e9b\u5b57\u7b26\u4e32(\u8fd8\u662f\u4e8c\u8fdb\u5236\u8868\u793a),\u4e0b\u9762\u4ee3\u7801\u4e2d\u5373\u4e3a$mc$\u3002  \n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5373\u4e3a\n$$f[i][j]=\\sum_{k \\& mc[i]['a'...'z'] = j}f[i - 1][k]$$\n\u4e5f\u8bb8\u4e00\u822cDP\u7684\u5199\u6cd5\u5e76\u4e0d\u662f\u5f88\u597d\u5199,\u5177\u4f53\u53c2\u8003\u4ee3\u7801\u7684\u5199\u6cd5\u597d\u4e86\u3002  \n\u6eda\u52a8\u6570\u7ec4\u901f\u5ea6\u4f1a\u53d8\u5feb\u662f\u4ec0\u4e48\u9b3c)  \n\u6211\u7684\u4ee3\u7801\u76ee\u524d\u5927\u6982\u662f\u5168\u8c37\u5199\u72b6\u538bDP\u91cc\u9762\u8dd1\u5f97\u6700\u5feb\u7684\u4e86,\u62a2\u5230rk2,rk1\u7684\u5de8\u4f6c\u770b\u8d77\u6765\u662f\u5199\u5bb9\u65a5\u7684)  \n\n# \u4ee3\u7801\n\n```cpp\n#include<cstdio>\n#include<cctype>\n#include<ctime>\n#include<cmath>\n#include<cstring>\n#define u32 unsigned\n#define i64 long long\n#define u64 unsigned long long\n#define f80 long double\n#define rgt register\nusing namespace std;\n#define mod 1000003\n\ntemplate<typename T>\ninline void read( rgt T &x ){ x = 0; rgt char t, flg(0);\n    for ( t = getchar(); !isdigit(t); t = getchar() ) flg = t == '-';\n    for ( ; isdigit(t); t = getchar() ) x = x * 10 + ( t & 15 ); x = flg ? -x : x;\n}\n\nclock_t __t_bg, __t_ed;\n\nint T, N, L, K, M;\nchar s[17][55];\nint mc[55][30], f[2][1<<15], cr, nx, cnt[1<<15];\ninline void dec( rgt int &x ){ x = x >= mod ? x - mod : x; }\n\nsigned main(){\n    __t_bg = clock();\n    read(T), M = 1 << 15;\n    for ( rgt int i = 1; i < M; ++i ) cnt[i] = cnt[i >> 1] + ( i & 1 );\n    while( T-- ){\n        read(N), read(K), memset( mc, 0, sizeof mc );\n        for ( rgt int i = 0; i < N; ++i )\n            scanf( \"%s\", s[i] + 1 );\n        L = strlen(s[0] + 1);\n        for ( rgt int i = 0; i < N; ++i )\n            for ( rgt int w = 1; w <= L; ++w )\n                for ( rgt char j = 'a'; j <= 'z'; ++j )\n                    if ( s[i][w] == '?' || s[i][w] == j )\n                        mc[w][j & 31] |= 1 << i;\n        M = 1 << N, memset( f[0], 0, M << 2 ), f[0][M - 1] = 1, cr = 0, nx = 1;\n        for ( rgt int l = 0; l < L; ++l, cr = !cr, nx = !nx ){\n            memset( f[nx], 0, M << 2 );\n            for ( rgt int i = 0; i < M; ++i ) if ( f[cr][i] && cnt[i] >= K ){\n                for ( rgt char j = 'a'; j <= 'z'; ++j )\n                    dec( f[nx][i & mc[l + 1][j & 31]] += f[cr][i] );\n            }\n        } rgt int ans(0);\n        for ( rgt int i = 0; i < M; ++i ) if ( cnt[i] == K ) dec( ans += f[cr][i] );\n        printf( \"%d\\n\", ans );\n    }\n    __t_ed = clock(), fprintf( stderr, \"time: %.5lfs\\n\", double( __t_ed - __t_bg ) / CLOCKS_PER_SEC );\n    return 0;\n}\n```",
        "postTime": 1555325115,
        "uid": 70786,
        "name": "_louhc",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2167 \u3010[SDOI2009]Bill\u7684\u6311\u6218\u3011"
    },
    {
        "content": "P2167 Bill\u7684\u6311\u6218\n\n\u9898\u610f\uff1a\u7ed9\u5b9a $n$ \u4e2a\u957f\u5ea6\u76f8\u540c\u7684\u53ea\u542b\u5c0f\u5199\u5b57\u6bcd\u548c `?` \u7684\u5b57\u7b26\u4e32\uff0c\u6c42\u4e0e\u8fd9 $n$ \u4e2a\u5b57\u7b26\u4e32\u4e2d\u7684\u6070\u597d $k$ \u4e2a\u5b57\u7b26\u4e32\u5339\u914d\u7684\u5b57\u7b26\u4e32\u7684\u4e2a\u6570\uff0c\u5339\u914d\u6307\u7684\u662f\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u7684\u5b57\u6bcd\u90fd\u76f8\u540c \uff0c`?` \u53ef\u4ee5\u4ee3\u66ff\u6240\u6709\u5c0f\u5199\u5b57\u6bcd\uff0c\u6570\u636e\u8303\u56f4\uff1a$1\\leq T\\leq 5,1\\leq n\\leq 15,1\\leq |S_i|\\leq 50$ \n\n\u9996\u5148\u6211\u4eec\u5047\u8bbe\u6c42\u51fa\u4e86\u53ef\u4ee5\u5feb\u901f\u5f97\u5230\u81f3\u5c11\u4e0e\u96c6\u5408 $S$ \u5185\u7684\u5b57\u7b26\u4e32\u5339\u914d\u7684\u5b57\u7b26\u4e32\u4e2a\u6570\u7684\u51fd\u6570 $q(S)$\uff0c\u63a5\u4e0b\u6765\u5c31\u662f\u731c\u5bb9\u65a5\u7cfb\u6570\u73af\u8282\uff0c\u5148\u5217\u51fa\u5f0f\u5b50\n\n\u8bbe $f(S)$ \u4e3a\u6070\u597d\u53ea\u4e0e\u96c6\u5408\u5185\u7684\u5b57\u7b26\u4e32\u5339\u914d\u7684\u5b57\u7b26\u4e32\u4e2a\u6570\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f $\\sum_{S\\subseteq U\\land |S|=k} f(S)$ \n\n$f(S)=\\sum_{S\\subseteq P\\subseteq U}q(P)g(|P|)$ \u5176\u4e2d $|S|=k$\uff0c\u6709 $g(x)=(-1)^{x-k}$\uff0c\u4e3a\u5565\u5462\uff1f\n\n\u5bf9\u4e8e\u4e00\u4e2a\u7b54\u6848\u5b57\u7b26\u4e32\uff0c\u5047\u8bbe\u5b83\u53ef\u4ee5\u548c $Q$ \u96c6\u5408\u5185\u7684\u5b57\u7b26\u4e32\u5339\u914d\uff0c\u4e14 $S\\subseteq Q$\uff0c$|Q|=k+u$\uff0c\u90a3\u4e48\u5b83\u5bf9 $f(S)$ \u7684\u8d21\u732e\u662f $\\sum_{i=0}^u\\binom ui(-1)^i=(-1+1)^u=[u=0]$\uff0c\u91cc\u9762\u7684 $(-1)^i$ \u5c31\u53ef\u4ee5\u5145\u5f53\u5bb9\u65a5\u7cfb\u6570\u5566\n\n\u4e8e\u662f $f(S)=\\sum_{S\\subseteq P\\subseteq U} q(P)(-1)^{|P|-k}$\uff0c\u4e8e\u662f\uff1a\n\n$$\n\\begin{aligned}\nans=&\\sum_{S\\subseteq U\\land |S|=k} f(S)\\\\\n=&\\sum_{S\\subseteq U\\land |S|=k} \\sum_{S\\subseteq P\\subseteq U} q(P)(-1)^{|P|-k}\\\\\n=&\\sum_{P\\subseteq U\\land |P|\\geq k} q(P)(-1)^{|P|-k}\\binom {|P|}k\n\\end{aligned}\n$$\n\n\u5927\u529b\u5bb9\u65a5\n\n$q(S)$ \u76f4\u63a5\u770b\u770b $S$ \u91cc\u9762\u7684\u5b57\u7b26\u4e32\u5339\u914d\u60c5\u51b5\uff0c\u5982\u679c\u4e0d\u80fd\u5339\u914d\u5c31\u662f $0$\uff0c\u6709\u591a\u5c11\u4e2a\u5168\u662f `?`\uff0c\u5c31\u662f $26$ \u7684\u591a\u5c11\u6b21\u65b9\n\n\u7801\uff1a\n```cpp\n\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cstdlib>\n#include<algorithm>\n#include<queue>\n#define N 100010\n#define int long long\n#define re register\nusing namespace std;\ntemplate<typename T>\ninline void read(T &x){\n    x=0;bool flg=0;char c=getchar();\n    for(;!isdigit(c);c=getchar()) if(c=='-') flg=1;\n    for(;isdigit(c);c=getchar()) x=x*10+(c^48);\n    if(flg) x=-x; \n}\nconst int Mod=1000003;\n\nint T,n,m,k,all=0,ans=0;\nint jc[N],bit[N];\nchar str[30][60];\n\nint fpow(int a,int b){\n    int res=1%Mod;a%=Mod;\n    for(;b;b>>=1,a=a*a%Mod) if(b&1) res=res*a%Mod;\n    return res%Mod;\n}\n\nint calc(int S){\n    int res,sum=m;\n    int s[60];\n    memset(s,0,sizeof s);\n    res=jc[bit[S]]*fpow(jc[k],Mod-2)%Mod*fpow(jc[bit[S]-k],Mod-2)%Mod;\n    for(int i=1;i<=n;i++){\n        if(S&(1<<(i-1))){\n            for(int j=1;j<=m;j++){\n                if(str[i][j]=='?'||str[i][j]==s[j]) continue;\n                if(!s[j]){s[j]=str[i][j];sum--;continue;}\n                return 0;\n            }\n        }\n    }\n    (res*=fpow(26,sum))%=Mod;\n    if((bit[S]-k)%2) return (-res+Mod)%Mod;\n    else return (res+Mod)%Mod;\n}\n\nsigned main(){\n\n    jc[0]=1;\n    for(int i=1;i<=15;i++) jc[i]=jc[i-1]*i%Mod;\n    for(int i=0;i<(1<<15);i++) bit[i]=bit[i>>1]+(i&1);\n\n    read(T);\n    while(T--){\n        ans=0;\n        read(n);read(k);\n        all=(1<<n);\n        for(int i=1;i<=n;i++) scanf(\"%s\",str[i]+1);\n        m=strlen(str[1]+1);\n        for(int i=0;i<all;i++){\n            if(bit[i]<k) continue;\n            (ans+=calc(i)+Mod)%=Mod;\n        }\n        printf(\"%lld\\n\",ans);\n    }\n\n    \n\n    return 0;\n}\n\n```",
        "postTime": 1633680280,
        "uid": 81736,
        "name": "wsy_jim",
        "ccfLevel": 3,
        "title": "P2167 Bill\u7684\u6311\u6218"
    }
]
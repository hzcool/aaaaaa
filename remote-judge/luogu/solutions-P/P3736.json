[
    {
        "content": "\u8fd9\u9053\u9898\u6211\u89c9\u5f97\u771f\u5b9e\u96be\u5ea6\u5e94\u8be5\u5728\u7701\u9009/NOI-\u4ee5\u4e0b\u3002\n\n\u4e3b\u8981\u601d\u8def\u4e3a\u533a\u95f4dp+\u72b6\u538bdp\n\n\u7531\u9898\u76ee\u7684k<=8\u8003\u8651\u4f7f\u7528\u72b6\u6001\u538b\u7f29\u3002\n\n\u4e3a\u4e86\u5f97\u5230\u6700\u5927\u7684\u5206\u6570\u6211\u4eec\u5e94\u8be5\u5c3d\u91cf\u5408\u5e76\u6570\u5b57\u5230\u4e0d\u80fd\u5408\u5e76\u4e3a\u6b62\uff0c\u4e8e\u662f\u6700\u7ec8\u5f97\u5230\u768401\u4e32\u4e2d\u7684\u6bcf\u4e00\u4e2a\u6570\u5b57 \u5c55\u5f00\uff08\u8fd8\u539f\u540e\uff09\u662f\u4e00\u7cfb\u5217\u4e0d\u76f8\u4ea4\u7684\u533a\u95f4\uff0c\u6211\u4eec\u8003\u8651\u7528\u533a\u95f4dp\u7684\u601d\u7ef4\u6765\u8f6c\u79fb\u72b6\u6001\u3002\n\n\u6211\u4eec\u7528f[ i ][ j ][ t ]\u8868\u793a\u539f\u4e32\u4e2d\u7b2ci\u5230j\u4e2a\u6570\u5b57\u6700\u7ec8\u5408\u5e76\u6210t\u7684\u72b6\u6001\u7684\u6700\u5927\u5206\u6570\u3002\n\n\u6211\u4eec\u679a\u4e3e\u4e2d\u95f4\u7684\u65ad\u70b9mid\uff0c\uff08i<=mid<=j\uff09,\u4e0a\u6587\u5df2\u8bc1\u533a\u95f4\u4e0d\u76f8\u4ea4\uff0c\u4e8e\u662f\u4e0d\u59a8\u4f7fmid\u53f3\u8fb9\u7684\u5b50\u4e32\u5408\u5e76\u6210t\u7684\u6700\u540e\u4e00\u4f4d\u6570\u5b57\uff0cmid\u5de6\u8fb9\u7684\u5408\u5e76\u6210\u5176\u4ed6\u4f4d\u7684\u6570\u5b57\u3002\n\u56e0\u4e3a\u80fd\u5408\u5e76\u62101\u4f4d\u6570\u5b57\u7684\u539f\u4e32\u957f\u5ea6\u53ef\u4ee5\u4e3a1\uff0ck\uff0c2k-1......\uff0c\u6240\u4ee5\u6211\u4eec\u6bcf\u6b21\u5c06mid\u7684\u503c\u6539\u53d8k-1\u5373\u53ef\u3002\n\n\u53e6\u6709\u4e00\u79cd\u7279\u6b8a\u60c5\u51b5\uff0c\u5373i\u5230j\u6070\u597d\u6709k\u4f4d\u6570\u5b57\uff0c\u6211\u4eec\u76f4\u63a5\u628a\u5b83\u5408\u5e76\u4e00\u6b21\u3002\u7528\u4e00\u4e2a\u8f85\u52a9\u6570\u7ec4\u5b58\u50a8\u6700\u5927\u503c\uff08\u76f4\u63a5\u4fee\u6539f\u6570\u7ec4\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4fee\u6539\u540e\u7684\u6570\u80fd\u591f\u518d\u4fee\u6539\u5176\u4ed6\u6570\u7ec4\u5143\u7d20\uff0c\u5177\u4f53\u770b\u4ee3\u7801\u7406\u89e3\u4e00\u4e0b\uff09\u3002\n\n\u6700\u540e\u7684\u7b54\u6848\u5c31\u662ff[ 1 ][ n ][\u6240\u6709\u72b6\u6001]\u4e2d\u7684\u6700\u5927\u503c\u5566\u3002\n\u7531\u4e8ewi\u7684\u503c\u53ef\u80fd\u5f88\u5927\uff0c\u6240\u4ee5\u8bb0\u5f97\u4f7f\u7528long long\u3002\n\n\u9644\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define N 310\n#define K 8\n#define inf (ll)1<<60\n#define ll long long\nusing namespace std;\n\nll n,k,a[N],c[1<<K],w[1<<K],f[N][N][1<<K];\n \nint main()\n{\n\tscanf(\"%lld%lld\",&n,&k);\n\tfor (ll i=1;i<=n;i++) scanf(\"%1lld\",&a[i]);\n\tfor (ll i=0;i<(1<<k);i++) scanf(\"%lld%lld\",&c[i],&w[i]);\n\tfor (ll i=1;i<=n;i++)\n\t for (ll j=1;j<=n;j++)\n\t  for (ll z=0;z<(1<<k);z++)\n\t  f[i][j][z]=-inf;\n    //\u8bfb\u5165\u53ca\u521d\u59cb\u5316 \n    for (ll i=n;i>=1;i--)\n      for (ll j=i;j<=n;j++)    \n      //\u6ce8\u610f\u5faa\u73af\u7684\u6b63\u9006\u987a\u5e8f\uff0c\u56e0\u4e3amid\u6bd4j\u5c0f\uff0cj\u6b63\u5e8f\u679a\u4e3e\uff1bmid\u6bd4i\u5927\uff0ci\u5012\u5e8f\u679a\u4e3e\n\t  //(\u4f7f\u72b6\u6001\u8f6c\u79fb\u65f6f[i][mid-1][..],f[mid][j][..]\u7684\u503c\u5df2\u88ab\u5904\u7406\u597d) \n      { \n        if (i==j) { f[i][j][a[i]]=0;continue;}\n        ll len=j-i;\n        len%=k-1; if (!len) len=k-1;\n        for (ll mid=j;mid>i;mid-=k-1)\n        for (ll op=0;op<(1<<(len));op++)\n        { f[i][j][op<<1]=max(f[i][j][op<<1],f[i][mid-1][op]+f[mid][j][0]);\n          f[i][j][op<<1|1]=max(f[i][j][op<<1|1],f[i][mid-1][op]+f[mid][j][1]);\n            \n\t\t}\n\t\tif (len==k-1) \n\t\t{\n\t\t\tll g[2];\n\t\t\tg[0]=g[1]=-inf;\n\t\t\tfor (ll op=0;op<(1<<k);op++)\n\t\t\tg[c[op]]=max(g[c[op]],f[i][j][op]+w[op]);\n\t\t\tf[i][j][0]=g[0];f[i][j][1]=g[1];\n\t\t}\n\t  }\n\t  ll ans=-inf;\n\t  for (ll i=0;i<(1<<k);i++) ans=max(ans,f[1][n][i]);\n\t  printf(\"%lld\",ans);\n}\n```",
        "postTime": 1523521858,
        "uid": 69098,
        "name": "zxTLE",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3736 \u3010[HAOI2016]\u5b57\u7b26\u5408\u5e76\u3011"
    },
    {
        "content": "\u8fd9\u9898\u63d0\u4f9b\u4e86\u4e00\u79cd\u72b6\u538bDP\u7684 **idea**\uff0c\u72b6\u6001\u538b\u7f29\u53ef\u4ee5\u548c\u5176\u4ed6DP\u65b9\u5f0f\u5171\u540c\u4f7f\u7528\u6765\u8bb0\u5f55\u4e00\u79cd\u72b6\u6001.\n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u9898\u7684 $k$ \u6781\u5176\u7684\u5c0f\uff0c$2 \\leq k \\leq 8$\uff0c\u8fd9\u4e48\u5c0f\u7684\u6570\u636e\u8303\u56f4\u80af\u5b9a\u8003\u8651\u72b6\u538bDP.\n\n\u6211\u4eec\u540c\u65f6\u53d1\u73b0\uff0c\u4e3a\u4e86\u4f7f\u7b54\u6848\u6700\u5927\uff0c\u5408\u5e76\u7684\u533a\u95f4\u4e4b\u95f4\u5fc5\u7136\u4e0d\u76f8\u4ea4\uff0c\u90a3\u6211\u4eec\u5c31\u53ef\u4ee5\u638f\u51fa\u533a\u95f4DP.\n\n\u8fd9\u9898\u6211\u4eec\u5927\u6982\u5c31\u6709\u4e86\u4e00\u4e2a\u60f3\u6cd5\uff0c\u8bbe $f_{l,r,S}$ \u4e3a $[l,r]$\u533a\u95f4\uff0c\u5408\u5e76\u540e\u7684\u72b6\u6001\u4e3a $S$ \u7684\u6700\u5c0f\u4ee3\u4ef7.\n\n\u600e\u4e48\u8f6c\u79fb\u5462\uff0c\u5982\u679c\u66b4\u529b\u8f6c\u79fb\u662f $O(n^3*2^{k-1})$\uff0c\u7edd\u5bf9\u4f1a**TLE**.\n\n\u63a5\u4e0b\u6765\u5c31\u8003\u8651\u627e\u89c4\u5f8b\uff0c\u6211\u4eec\u53d1\u73b0\uff1a**\u4e0d\u8bba\u5408\u5e76\u7684\u8fc7\u7a0b\u5982\u4f55\uff0c\u53ea\u8981\u7ed9\u51fa\u4e00\u4e2a\u4e32\u7684\u957f\u5ea6\uff0c\u5b83\u5408\u5e76\u540e\u7684\u957f\u5ea6\u4e00\u5b9a\u4e0d\u53d8**.\n\n\u90a3\u63a5\u4e0b\u6765\u5c31\u6765\u627e\u51fa\u8fd9\u4e2a\u957f\u5ea6\u5427\uff1a\n\n- \u4e32\u7684\u957f\u5ea6\u4e3a $1$ \u65f6\uff0c\u65e0\u6cd5\u5408\u5e76\uff0c\u957f\u5ea6\u4ecd\u4e3a $1$.\n- \u4e32\u7684\u957f\u5ea6\u4e3a $k$ \u65f6\uff0c\u957f\u5ea6\u4e3a $k$ \u7684\u4e32\u80fd\u591f\u5408\u5e76\uff0c\u6700\u7ec8\u751f\u6210\u957f\u5ea6\u4e3a $1$ \u7684\u65b0\u4e32.\n- \u4e32\u7684\u957f\u5ea6\u4e3a $2k-1$ \u65f6\uff0c\u957f\u5ea6\u4e3a $k$ \u7684\u4e32\u5148\u5408\u5e76\uff0c\u751f\u6210\u957f\u5ea6\u4e3a $1$ \u7684\u4e32\u540e\u4e0e\u5269\u4e0b\u7684\u957f\u5ea6\u4e3a $k-1$ \u7684\u4e32\u4e00\u8d77\u5408\u5e76\uff0c\u751f\u6210\u957f\u5ea6\u4e3a $1$ \u7684\u4e32.\n- ...\n\n\u5f88\u660e\u663e\u53ef\u4ee5\u53d1\u73b0\uff0c\u5f53\u4e32\u7684\u957f\u5ea6\u4e3a $a(k-1)+1$\u65f6\uff0c\u8be5\u4e32\u6700\u540e\u751f\u6210\u7684\u4e32\u7684\u957f\u5ea6\u4e00\u5b9a\u4e3a $1$.\n\n\u5e76\u4e14\u8fdb\u4e00\u6b65\u53ef\u4ee5\u5f97\u5230\uff0c\u5f53\u4e32\u7684\u957f\u5ea6\u4e3a $len$ \u65f6\uff0c\u6700\u540e\u8be5\u4e32\u7684\u957f\u5ea6\u4e3a $(len-1) \\bmod (k-1)+1$.\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u7f29\u5c0f\u4e86DP\u8f6c\u79fb\u8fc7\u7a0b\u4e2d\u679a\u4e3e\u7684\u8303\u56f4.\n\nDP\u8fc7\u7a0b\u5982\u4e0b\uff1a\n\n- $f_{l,r,S}=\\max \\{f_{l,mid,S}+f_{mid+1,r,S}\\}((r-l) \\bmod (k-1)\\not=0)$\n- \u5f53$(r-l) \\bmod (k-1)=0$ \u65f6\uff0c\u8fd8\u9700\u8ba1\u7b97\u4e0a\u6574\u4e2a\u4e32\u5408\u5e76\u7684\u4ee3\u4ef7\uff0c\u8fd9\u4e00\u70b9\u4e0d\u592a\u597d\u8868\u8fbe\uff0c\u76f4\u63a5\u770b\u4ee3\u7801.\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^2 \\lfloor \\frac{n}{k} \\rfloor*2^{k-1})$\uff0c\u8fd9\u4e2a\u590d\u6742\u5ea6\u867d\u7136\u770b\u4e0a\u53bb\u548c\u66b4\u529b\u5dee\u4e0d\u591a\uff0c\u4f46\u5b9e\u9645\u8fd0\u884c\u8fdc\u4f4e\u4e8e\u8be5\u4e0a\u754c.\n\n**PS:\u8fd9\u9898\u5982\u679c\u4e0d\u5c06\u975e\u6cd5\u503c\u7f6e\u4e3a $-\\infty$ \u4f1a\u51fa\u73b0\u7384\u5b66\u9519\u8bef.**\n\n**Show the Code**\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#define max(a,b) ((a)>(b)? (a):(b))\ntypedef long long ll;\nll inf;\nint a[305],c[1<<8|1];\nll f[305][305][1<<8|1],g[2],w[1<<8|1];\ninline int read() {\n\tregister int x=0,f=1;register char s=getchar();\n\twhile(s>'9'||s<'0') {if(s=='-') f=-1;s=getchar();}\n\twhile(s>='0'&&s<='9') {x=x*10+s-'0';s=getchar();}\n\treturn x*f;\n}\nint main() {\n\tint n=read(),k=read();\n\tfor(register int i=1;i<=n;++i) a[i]=read();\n\tfor(register int i=0;i<(1<<k);++i) {c[i]=read();w[i]=read();}\n\tmemset(f,-0x3f,sizeof(f));\n\tmemset(&inf,-0x3f,sizeof(inf));\n\tfor(register int i=1;i<=n;++i) f[i][i][a[i]]=0;\n\tfor(register int len=2;len<=n;++len) {\n\t\tfor(register int l=1;l<=n-len+1;++l) {\n\t\t\t//(len-1)%(k-1)\n\t\t\t//0*k+1 1*k 2*k-1 3*k-2 4*k-3... \n\t\t\t//1 2k-1 3k-1 4k-1\n\t\t\tint r=l+len-1,x=(len-1)%(k-1);\n\t\t\tif(x==0) x=k-1;\n\t\t\tfor(register int mid=r-1;mid>=l;mid-=k-1) {//l~mid mid+1~r\n\t\t\t\tfor(register int S=0;S<(1<<x);++S) {\n\t\t\t\t\tf[l][r][S<<1]=max(f[l][r][S<<1],f[l][mid][S]+f[mid+1][r][0]);\n\t\t\t\t\tf[l][r][S<<1|1]=max(f[l][r][S<<1|1],f[l][mid][S]+f[mid+1][r][1]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(x==k-1) {\n\t\t\t\tg[0]=g[1]=inf;\n\t\t\t\tfor(register int S=0;S<(1<<k);++S) g[c[S]]=max(g[c[S]],f[l][r][S]+w[S]);\n\t\t\t\tf[l][r][0]=g[0];f[l][r][1]=g[1];\n\t\t\t}\n\t\t}\n\t}\n\tll res=inf;\n\tfor(register int i=0;i<(1<<k);++i) res=max(res,f[1][n][i]);\n\tprintf(\"%lld\\n\",res);\n\treturn 0;\n}\n```",
        "postTime": 1584969444,
        "uid": 95244,
        "name": "tommymio",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3736 \u3010[HAOI2016]\u5b57\u7b26\u5408\u5e76\u3011"
    },
    {
        "content": "$\\ \\ \\ \\ \\ \\ \\ $[luogu](https://www.luogu.com.cn/problem/P3736)\uff0c\u540c\u6b65\u4e8e[\u52a8\u6001\u89c4\u5212100\u9898](https://www.luogu.com.cn/blog/blog10086001/dong-tai-gui-hua-100-ti)\u7b2c16\u9898\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u6839\u636e\u7ecf\u9a8c\uff0c$k$ \u5f88\u5c0f\uff0c\u5e76\u4e14\u53ea\u6709 01 \u4e32\uff0c\u5f88\u5bb9\u6613\u60f3\u5230\u72b6\u538b dp\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u56e0\u4e3a\u5206\u6570\u975e\u8d1f\uff0c\u8003\u8651\u628a\u80fd\u5408\u7684\u5168\u90e8\u90fd\u5408\u8d77\u6765\u3002\u6211\u4eec\u8003\u8651\u5408\u5e76\u5b8c\u6210\u540e\u5c55\u5f00\uff0c\u5404\u4e2a\u533a\u95f4\u4e00\u5b9a\u662f\u4e0d\u76f8\u4ea4\u7684\u3002\u8003\u8651\u7528\u4e0a\u533a\u95f4 dp\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u533a\u95f4 dp \u5957\u8def\uff0c\u679a\u4e3e\u4e2d\u95f4\u7aef\u70b9\u3002\u5408\u5e76\u6210\u4e00\u4f4d 0 \u6216 1 \u4e00\u5b9a\u4f1a\u5f04\u6389 $k$ \u4e2a\u5b57\u7b26\u53d8\u6210 1 \u4e2a\uff08\u56e0\u4e3a\u5176\u4e2d\u533a\u95f4\u4e0d\u76f8\u4ea4\uff09\uff0c\u6240\u4ee5\u76f4\u63a5 `ptt+=k-1` \u5c31\u597d\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u7136\u540e\u7279\u6b8a\u60c5\u51b5\u662f\u533a\u95f4\u957f\u5ea6\u521a\u597d\u662f $k$\u3002\u90a3\u4e48\u76f4\u63a5\u5408\u5e76\uff0c\u7528\u4e24\u4e2a\u4e34\u65f6\u53d8\u91cf\u50a8\u5b58\u3002\uff08\u56e0\u4e3a\u4fee\u6539\u4e4b\u540e\u80fd\u591f\u4fee\u6539\u5176\u4ed6\u7684\u503c\uff0c\u4e0d\u597d\u64cd\u4f5c\uff09\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u6700\u540e\u8bf4\u4e00\u4e0b\u72b6\u6001\u5b9a\u4e49\uff1a\u5b9a\u4e49 $dp_{i,j,S}$ \u4e3a\u5408\u5e76 $[i,j]$ \u533a\u95f4\uff0c\u72b6\u6001\u4e3a $S$\u3002\u6709 dp \u65b9\u7a0b\uff1a\n\n$$\\begin{cases}\ndp_{i,j,now \\times 2}=\\max \\{ dp_{i,ptt-1,now} + dp_{ptt,j,0}\\}(dp_{ptt,j,0}!=-inf) \\\\\\\\ dp_{i,j,now \\times 2+1}=\\max \\{ dp_{i,ptt-1,now} + dp_{ptt,j,1}\\}(dp_{ptt,j,1}!=-inf)\n\\end{cases}$$\n\n$\\ \\ \\ \\ \\ \\ \\ $\u6700\u540e\u6ce8\u610f\u4e0b\u679a\u4e3e\u987a\u5e8f\uff0c\u8003\u8651\u7528\u5230 $dp_{i,ptt-1}$ \u548c $dp_{ptt,j}$\uff0c\u679a\u4e3e\u533a\u95f4\u4e00\u5b9a\u8981\u5012\u5e8f\u679a\u4e3e\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u7b54\u6848\u4e3a $\\max \\{ dp_{1,n}\\}$\n\n```cpp\n#include<cstdio>\n#include<queue>\n#include<algorithm>\n#include<cstring>\n#include<iostream>\n#include<set>\n#include<map>\n#define lc(x) x<<1ll\n#define rc(x) x<<1ll|1ll\nusing namespace std;\nchar t[3005];\nint n,m;\nlong long NegaInf,a[3005],cnt[2600],val[2600],dp[305][305][305];\nint main(){\n\tscanf(\"%d %d\",&n,&m);\n\tfor(int i=1;i<=n;++i)\tscanf(\"%lld\",&a[i]);\n\tfor(int i=0;i<=(1<<m)-1;++i)\tscanf(\"%lld %lld\",&cnt[i],&val[i]);\n\tmemset(dp,128,sizeof dp);\n\tfor(int i=1;i<=n;++i)\tdp[i][i][a[i]]=0;\n\tNegaInf=dp[0][0][0]; \n\tfor(int dis=2;dis<=n;++dis)\n\t{\n\t\tfor(int i=1,j=dis;j<=n;++i,++j)\n\t\t{\n\t\t\tlong long lena=(j-i)%(m-1);\n\t\t\tlena=!lena?m-1:lena;\n\t\t\tfor(int ptt=j;ptt>=i+1;ptt-=m-1)\n\t\t\t{\n\t\t\t\tfor(int k=0;k<=(1<<lena)-1;++k)\n\t\t\t\t{\n\t\t\t\t\tif(dp[i][ptt-1][k]==NegaInf)\tcontinue;\n\t\t\t\t\tif(dp[ptt][j][0]!=NegaInf)\tdp[i][j][lc(k)]=max(dp[i][j][lc(k)],dp[i][ptt-1][k]+dp[ptt][j][0]);\n\t\t\t\t\tif(dp[ptt][j][1]!=NegaInf)\tdp[i][j][rc(k)]=max(dp[i][j][rc(k)],dp[i][ptt-1][k]+dp[ptt][j][1]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(lena==m-1)\n\t\t\t{\n\t\t\t\tlong long rear0=NegaInf,rear1=NegaInf;\n\t\t\t\tfor(int k=0;k<=(1<<m)-1;++k)\n\t\t\t\t{\n\t\t\t\t\tif(dp[i][j][k]!=NegaInf)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(cnt[k])\trear1=max(rear1,dp[i][j][k]+val[k]);\n\t\t\t\t\t\telse\trear0=max(rear0,dp[i][j][k]+val[k]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tdp[i][j][0]=rear0,dp[i][j][1]=rear1;\n\t\t\t}\n\t\t}\n\t}\n\tlong long ans=NegaInf;\n\tfor(int i=0;i<=(1<<m)-1;++i)\tans=max(ans,dp[1][n][i]);\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1578462572,
        "uid": 184977,
        "name": "pomelo_nene",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3736 \u3010[HAOI2016]\u5b57\u7b26\u5408\u5e76\u3011"
    },
    {
        "content": "## P3736 [HAOI2016]\u5b57\u7b26\u5408\u5e76\n\n**\u8003\u70b9** \n> \u533a\u95f4DP\u548c\u72b6\u538bDP\u7ec4\u5408\u597d\u9898\uff01\n\n\u9996\u5148\u662f\u7406\u89e3\u9898\u76ee\u610f\u601d\uff0c\u6211\u53ef\u662f\u5728\u7406\u89e3\u9898\u610f\u4e0a\u5c31\u82b1\u4e86\u8fd1\u534a\u4e2a\u5c0f\u65f6\uff0c\u8c8c\u4f3c\u9898\u9762\u6709\u4e2a\u5730\u65b9\u6253\u9519\u4e86\u3002\n\n\u9009\u62e9 $k$ \u4e2a\u5b57\u7b26\u5408\u5e76\u6bd4\u8f83\u7b80\u5355\uff0c\u4f46\u662f $k$ \u4e2a\u5b57\u7b26\u5408\u5e76\u540e\u4f1a\u4ea7\u751f\u4e00\u4e2a\u5b57\u7b26\uff0c\u8fd9\u8ba9\u6211\u7acb\u9a6c\u60f3\u5230\u4e86 [\u86af\u8693](https://www.luogu.com.cn/problem/P2827)[\u8d2a\u5403\u86c7](https://www.luogu.com.cn/problem/P7078)\uff0c\u53ef\u662f\u9898\u76ee\u5e76\u4e0d\u662f\u7ef4\u62a4\u5927\u5c0f\u95ee\u9898\uff0c\u6240\u4ee5\u5e76\u4e0d\u9700\u8981\u6570\u636e\u7ed3\u6784\u7ef4\u62a4\uff0c\u8003\u8651DP\u3002\u9898\u76ee\u4e2d\u4ee5\u72b6\u6001\u7684\u5f62\u5f0f\u7ed9\u51fa\u6bcf $k$ \u4e2a\u5b57\u7b26\u4e32\u7684\u8d21\u732e\uff0c\u8fd9\u662f\u8ba9\u6211\u4eec\u53bb\u60f3\u72b6\u538b\uff0c\u5982\u4f55\u65e2\u6ee1\u8db3\u533a\u95f4\u7684DP\u5f0f\u5b50\uff0c\u53c8\u80fd\u5b8c\u6210\u72b6\u538b\u64cd\u4f5c\u5462\uff1f\n\n\u4e0d\u96be\u53d1\u73b0\u5bf9\u4e8e\u4e00\u4e2a\u533a\u95f4\uff0c\u6211\u4eec\u53ef\u4ee5\u51b3\u5b9a\u4ed6\u7684\u6700\u7ec8\u5f62\u6001\uff0c\u6211\u4eec\u5728\u533a\u95f4DP\u4e2d\u518d\u5f00\u4e00\u7ef4\u8bb0\u5f55\u6700\u7ec8\u5f62\u6001\uff0c\u4e0d\u5c31\u53ef\u4ee5DP\u4e86\u561b\u3002\u8bbe $f_{i,j,S}$ \u8868\u793a\u533a\u95f4 $[i,j]$ \u6700\u7ec8\u5f62\u6001\u4e3a $S$ \u7684\u6700\u5927\u5f97\u5206\u3002\u6211\u4eec\u4ece\u533a\u95f4DP\u7684\u6027\u8d28\u53bb\u5206\u6790\u5982\u4f55\u8f6c\u79fb\uff0c\u5bf9\u4e8e\u6211\u4eec\u679a\u4e3e\u7684\u4e2d\u95f4\u503c $mid$\uff0c\u5018\u82e5 $[mid,j]$ \u5185\u6070\u597d\u6709 $k$ \u90a3\u4e48\u5c31\u53ef\u4ee5\u5408\u5e76\u6210\u4e00\u4e2a\u4e86\uff0c\u8f6c\u6362\u6210\u5f0f\u5b50\u662f\uff1a\n$$\nf_{i,j,S}=\\max\\{f_{i,mid-1,S/2} + f_{mid,j,0/1}\\}\n$$\n\u5176\u4e2d\u7b2c\u4e00\u4e2a `\\` \u662f\u9664\u53f7\uff0c\u8fd9\u91cc\u662f\u5de6\u79fb\u7684\u610f\u601d\uff0c\u7b49\u4ef7\u4e8e\u5c06\u53f3\u8fb9\u7684\u4e00\u4f4d\u6254\u6389\u3002\u7b2c\u4e8c\u4e2a `\\` \u8868\u793a\u6216\u8005\u7684\u610f\u601d\u3002\n\n\u8fd9\u79cd\u5bfb\u627e\u4e2d\u95f4\u4e0e\u8fb9\u754c\u7684\u5173\u7cfb\u7684\u601d\u8def\u6765\u6e90\u4e8e [P4170 [CQOI2007]\u6d82\u8272](https://www.luogu.com.cn/problem/P4170) \uff0c\u8fd9\u662f\u533a\u95f4DP\u5173\u7cfb\u7684\u5e38\u89c4\u627e\u6cd5\u3002\n\n\u63a5\u4e0b\u6765\u7ec6\u8bf4\u4e2d\u95f4\u503c $mid$ \u7684\u679a\u4e3e\uff0c\u6211\u4eec\u76f4\u63a5\u4fdd\u8bc1 $[mid,j]$ \u603b\u662f\u4ee5 $nk-(n-1)$ \u7684\u5f62\u5f0f\u51fa\u73b0\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u5f0f\u5b50\u6700\u7ec8\u5408\u5e76\u540e\u662f\u4e00\u4e2a\u5b57\u7b26\u3002\u5f53\u533a\u95f4\u6070\u597d\u662f $k$ \u65f6\u53ef\u4ee5\u76f4\u63a5\u5408\u5e76\uff0c\u90a3\u4e48\u6211\u4eec\u7684 $f_{i,j,0/1}$ \u5c31\u4ef7\u503c\u4e86\uff0c\u56e0\u4e3a\u5408\u5e76\u540e\u53ea\u6709\u4e24\u79cd\u6570\u5b57\uff0c\u5219\u7528 $g_{0/1}$ \u8868\u793a\u957f\u5ea6\u4e3a $k$ \u7684\u6700\u5927\u4ef7\u503c\u3002\u8f6c\u79fb\u6709\uff1a\n$$\ng_{c[S]}=\\max\\{f_{i,j,S}+w_S\\}\n$$\n\u5176\u4e2d $S$ \u662f\u679a\u4e3e\u7684\u5b50\u96c6\u72b6\u6001\u3002\u6700\u540e\u5c06 $g$ \u5411 $f_{i,j,0/1}$ \u8f6c\u79fb\u5c31\u597d\u4e86\uff0c\u8fd9\u9053\u9898\u76ee\u5c31\u6109\u5feb\u7684\u505a\u5b8c\u4e86\u3002\n\n\u6ce8\uff1a\u4ee5\u4e0a\u601d\u8def\u6765\u81ea\u9898\u89e3\u533a\uff0c\u56e0\u4e3a\u8fd9\u9898\u662f\u6211\u7684**\u767e\u7d2b\u9898**\uff0c\u56e0\u6b64\u7279\u610f\u7eaa\u5ff5\u4e00\u4e0b\u3002\n\n**\u503c\u5f97\u6ce8\u610f\u7684\u662f**\n\n1. `memset-0x80` \u7684\u8d4b\u503c\u6211\u5199\u6302\u4e86\uff0c\u5efa\u8bae\u5faa\u73af\u8d4b\u503c\uff0c\u6211\u6302\u4e86\u597d\u4e45\u3002\n2. \u7406\u89e3 `Len=(j-i)%(k-1)` \u7684\u542b\u4e49\uff0c\u5b83\u5e76\u4e0d\u8868\u793a\u533a\u95f4\u957f\u5ea6(\u6211\u5927\u5199\u4e86)\uff0c\u8868\u793a\u7684\u662f\u6709\u591a\u5c11\u4e2a $k-1$\uff0c\u5176\u4e2d `(j-i)` \u4f1a\u7559\u4e0b\u4e00\u4e2a\uff0c\u5728\u52a0\u4e0a\u8fd9 $n(k-1)$\uff0c\u5c31\u6784\u6210\u4e0a\u9762\u63d0\u5230\u7684\u5f0f\u5b50\uff1a$nk-(n-1)$ \uff0c\u4ed6\u6700\u540e\u5408\u5e76\u5c31\u53ea\u6709\u4e00\u9879\uff0c\u6240\u4ee5\u4e0d\u4f1a\u505a\u51fa\u8d21\u732e\u3002\n3. \u679a\u4e3e\u5b50\u96c6\u72b6\u6001\u65f6\u4e0d\u53ef\u6709\u524d\u9762\u7684\u8f6c\u79fb\u8fc7\u6765\uff0c\u56e0\u4e3a\u53f3\u79fb\u4f1a\u7206\uff0c\u5e94\u8be5\u662f\u60f3\u540e\u9762\u8f6c\u79fb\u3002\n\n**\u4ee3\u7801**\n```c\n/*\n    17:58 \u521a\u8bfb\u61c2\u9898\u76ee\n     \n*/\n#include <set>\n#include <cmath>\n#include <queue>\n#include <cstdio>\n#include <vector>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\n#include <string.h> \n#define int long long\nusing namespace std;\n\nconst int A = 1e5+10;\nconst int B = 2e4+10;\nconst int mod = 1e9 + 7;\nconst int inf = 0x3f3f3f3f;\n\ninline int read() {\n  char c = getchar();\n  int x = 0, f = 1;\n  for ( ; !isdigit(c); c = getchar()) if (c == '-') f = -1;\n  for ( ; isdigit(c); c = getchar()) x = x * 10 + (c ^ 48);\n  return x * f;\n}\nint n,k;\nint g[4];\nint a[B];\nint c[B],w[B];\nint f[309][309][1<<(8)];\nmain()\n{\n    n=read(); k=read();\n    for (int i=1;i<=n;i++) a[i]=read();\n    for (int i=0;i<(1<<k);i++) c[i]=read(),w[i]=read();\n    for (int i=1;i<=n;i++)\n\t for (int j=1;j<=n;j++)\n\t  for (int z=0;z<(1<<k);z++)\n\t  f[i][j][z]=-inf; //\u4e0d\u80fd\u7528memset!!! \n    for (int len=1;len<=n;len++)\n    {\n        for (int i=1;i+len-1<=n;i++)\n        {\n            int j=i+len-1;\n            if (i==j) {f[i][j][a[i]]=0; continue;}\n            int Len=(len-1)%(k-1);//\u5f97\u5230\u6700\u7b80\u7684\u72b6\u6001 \n            if (!Len && len!=1) Len=k-1;\n            for (int l=j;l>i;l-=k-1)\n            {\n                for (int S=0;S<(1<<(Len+1));S++)//\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u8001\u72b6\u6001\u8f6c\u7ebf\u72b6\u6001\uff0c\u800c\u662f\u7ebf\u72b6\u6001\u8f6c\u53bb\u8f6c\u522b\u7684\u88c5\u586b \n                { \n                    f[i][j][S<<1]=max(f[i][j][S<<1],f[i][l-1][S]+f[l][j][0]);\n                    f[i][j][S<<1|1]=max(f[i][j][S<<1|1],f[i][l-1][S]+f[l][j][1]);\n                }\n            } \n            if (Len==k-1)//\u521a\u597d\u53ef\u4ee5\u5408\u6210\u4e00\u4e2a\u6570\n            {\n                g[1]=g[0]=-inf;\n                for (int S=0;S<(1<<k);S++)\n                {\n                    g[c[S]]=max(g[c[S]],f[i][j][S]+w[S]);\n                }\n                f[i][j][0]=g[0], f[i][j][1]=g[1];\n            } \n        }\n    } \n    int ans=-inf;\n    for (int i=0;i<(1<<k);i++) ans=max(ans,f[1][n][i]);\n    printf(\"%lld\",ans);\n} \n```\n\u82e5\u6709\u4e0d\u7b26\u5408\u89c4\u77e9\u7684\u5730\u65b9\u8bf7\u7ba1\u7406\u5458\u5927\u5927\u52a1\u5fc5\u8be6\u7ec6\u70b9\u51fa\uff0c\u8c22\u8c22\u4e86\u3002 qwq",
        "postTime": 1626697433,
        "uid": 230808,
        "name": "Zxsoul",
        "ccfLevel": 4,
        "title": "P3736 [HAOI2016]\u5b57\u7b26\u5408\u5e76 \u9898\u89e3"
    },
    {
        "content": "## \u524d\u7f6e\u829d\u58eb\n\n \u533a\u95f4DP\uff0c\u72b6\u538bDP\n\n## \u6570\u7ec4\u542b\u4e49\u3000\n$dp[s][i][j]$\uff1a$s$ \u8868\u793a\u72b6\u6001\uff0c $i$ \u8868\u793a\u5de6\u7aef\u70b9\uff0c $j$ \u8868\u793a\u53f3\u7aef\u70b9\u3000\u3002\n\n## \u57fa\u672c\u601d\u60f3\n\n 1. \u5927\u533a\u95f4\u53ef\u4ee5\u88ab\u5c0f\u533a\u95f4\u66f4\u65b0\uff0c\u8003\u8651**\u533a\u95f4DP**\u3002\n\n  2. \u5e94\u8bb0\u5f55\u6bcf\u4e00\u6b21\u72b6\u6001\uff0c\u5373\u5408\u5e76\u5b8c\u4e4b\u540e\u7684\u6570\u5b57\uff0c\u6765\u66f4\u65b0\u4e0b\u4e00\u4e2a\u72b6\u6001\uff0c\u8003\u8651**\u72b6\u538b**\u3002\n\n  * **tips** \uff1a \u7531\u4e8e\u6309\u7167\u4e8c\u8fdb\u5236\u4ece\u5927\u5230\u5c0f\u987a\u5e8f\uff0c\u5219\u5fc5\u7136\u6309\u539f\u6570\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u5219\u4e0e\u539f\u6570\u6309\u987a\u5e8f\u4e00\u4e00\u5bf9\u5e94\u3002\n\n## \u4ee3\u7801\u5b9e\u73b0\n\n  1. \u679a\u4e3e\u533a\u95f4\u957f\u5ea6\uff08\u533a\u95f4 DP \u57fa\u672c\u601d\u60f3\uff09\uff0c\u679a\u4e3e\u5de6\u53f3\u7aef\u70b9\u3002\n \n  2. \u56e0\u4e3a\u533a\u95f4\u786e\u5b9a\u5219\u5408\u5e76\u540e\u6570\u5b57\u6570\u91cf\u786e\u5b9a\uff0c\u5219\u53ef\u4ee5\u679a\u4e3e\u72b6\u6001\uff0c\u5206\u4e3a\u524d\u90e8\u5206\u548c\u540e\u90e8\u5206\uff0c\u8fdb\u800c\u5408\u5e76\u533a\u95f4\u3002\n\n  3. \u5206\u60c5\u51b5\u8003\u8651\uff0c\u5982\u679c\u957f\u5ea6\u4e3a $k$ , $2k-1$ ...... \u5219\u5408\u5e76\u4e3a 0 , 1\uff0c\u4ef7\u503c\u4e3a**\u5de6\u533a\u95f4+\u53f3\u533a\u95f4+\u5408\u5e76\u4ef7\u503c**\uff1b\u5982\u679c\u4e0d\u4e3a\u4e0a\u4e00\u4e2a\u60c5\u51b5\u5219\u4e3a\u5de6\u533a\u95f4+\u53f3\u533a\u95f4\u4e14\u533a\u95f4\u72b6\u6001\u5408\u5e76\u3002\n\n* ### DP\u8f6c\u79fb\n\n```cpp\nif(Len!=m)\n{\n    dp[p][l][r]=max(dp[p][l][r],dp[p>>j][l][k-1]+dp[p&((1<<j)-1)][k][r]);\n    ans=max(ans,dp[p][l][r]);\n}\nelse\n{\n    dp[to[p]][l][r]=max(dp[to[p]][l][r],dp[p>>j][l][k-1]+dp[p&((1<<j))-1][k][r]+val[p]);\n    ans=max(ans,dp[to[p]][l][r]);\n}\n```\n**\u4e00\u8fb9\u66f4\u65b0\u4e00\u8fb9\u8bb0\u5f55 ans**\uff0c\u6700\u540e\u8f93\u51fa\u3002\n\n## AC\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint dp[258][301][301],len[2000],val[258],to[258],ans;\ntemplate <typename T>\ninline void read (T &a) {\n\tT x = 0, f = 1;\n\tchar ch = getchar ();\n\twhile (! isdigit (ch)) {\n\t\tif (ch == '-') f = 0;\n\t\tch = getchar ();\n\t}\n\twhile (isdigit (ch)) {\n\t\tx = (x << 1) + (x << 3) + (ch ^ '0');\n\t\tch = getchar ();\n\t}\n\ta = f ? x : -x;\n}\ninline int max (int a , int b) {\n    if(a > b) return a;\n    return b;\n}\nsigned main()\n{\n\tint n,m;\n    read(n),read(m);\n    memset(dp,0xcf,sizeof(dp));\n\tfor(int i = 1 ; i <= n ; i ++) {\n        char s;\n        while(true) {\n            s = getchar();\n            if(s == '0' or s == '1') break;\n        }\n        dp[s - '0'][i][i] = 0;\n    }\n    for(int i = 0 ; i < (1 << m) ; i ++) \n\tread(to[i]),read(val[i]);\n    for(int i=1;i<=m;i++)\n    {\n    \tlen[i]=i;\n    }\n    for(int i=m;i<=n;i++)\n    {\n    \tlen[i]=len[i-m+1];\n    }\n    for(int L=1;L<n;L++)\n    {\n    \tfor(int l=1;l+L<=n;l++)\n    \t{\n    \t\tint r=l+L,Len=len[L+1];\n    \t\tif(Len==1) Len=m;\n    \t\tfor(int p=0;p<(1<<Len);p++)\n    \t\t{\n    \t\t\tfor(int j=1;j<Len;j++){\n    \t\t\tint k=l;\n    \t\t\tfor(;k<=n;k++) if(len[r-k+1]==j) break;\n    \t\t\tfor(;k<=r;k+=m-1)\n    \t\t\t{\n    \t\t\t\tif(Len!=m)\n    \t\t\t\t{\n    \t\t\t\t\tdp[p][l][r]=max(dp[p][l][r],dp[p>>j][l][k-1]+dp[p&((1<<j)-1)][k][r]);\n    \t\t\t\t\tans=max(ans,dp[p][l][r]);\n    \t\t\t\t}\n    \t\t\t\telse\n    \t\t\t\t{\n    \t\t\t\t\tdp[to[p]][l][r]=max(dp[to[p]][l][r],dp[p>>j][l][k-1]+dp[p&((1<<j))-1][k][r]+val[p]);\n    \t\t\t\t\tans=max(ans,dp[to[p]][l][r]);\n    \t\t\t\t}\n    \t\t\t}\n\t\t\t  }\n    \t\t}\n    \t}\n    }\n    printf(\"%lld\",ans);\n}\n```",
        "postTime": 1622895185,
        "uid": 250036,
        "name": "Eternal_Battle",
        "ccfLevel": 0,
        "title": "P3736 \u9898\u89e3"
    },
    {
        "content": "> \u4e00\u4e2a\u957f\u4e3a $1\\le n\\le 300$ \u7684 01 \u4e32 $a$\uff0c\u53ef\u4ee5\u9009\u957f\u4e3a $2\\le k\\le 8$ \u7684\u8fde\u7eed\u6bb5 $[l,r]$ \u66ff\u6362\u4e3a $c_x\\in \\{0,1\\}$\uff0c\u5f97\u5230 $1\\le w_x\\le 10^9$ \u4ef7\u503c\uff0c\u5176\u4e2d $x$ \u8868\u793a $a:[l,r]$ \u6784\u6210\u7684\u4e8c\u8fdb\u5236\u6570\u3002\u4f8b\u5982 `10011` \u5c06\u4e2d\u95f4\u4e09\u4e2a\u5b57\u7b26\u66ff\u6362\u4e3a `1`\uff0c\u4f1a\u5f97\u5230\u65b0\u5b57\u7b26\u4e32 `111`\uff0c\u800c\u540e\u7eed\u7684\u64cd\u4f5c\u5747\u5728\u65b0\u5b57\u7b26\u4e32\u4e0a\u8fdb\u884c\u3002\n\n#### \u53d7\u5230\u542f\u53d1\n\n- \u770b\u5230 $k\\le 8$ \u60f3\u5230\u72b6\u6001\u538b\u7f29\u3002\n- \u770b\u5230 $n\\le 300$ \u60f3\u5230\u533a\u95f4 dp\u3002\n\n#### \u89c2\u5bdf\u6027\u8d28\n\n- \u5c06\u4e00\u4e2a\u533a\u95f4\u4ece\u59cb\u6001\u5230\u7ec8\u6001\u7684\u8fc7\u7a0b\u672c\u8d28\u662f\u5c06\u533a\u95f4\u5212\u5206\u6210 $<k$ \u6bb5\uff0c\u6bcf\u4e00\u6bb5\u4e2d\u7684\u6570\u5408\u5e76\u6210\u4e00\u4e2a\u6570\u3002\n- \u7531\u4e8e $w_x\\le 1$\uff0c\u5bf9\u4e8e\u4e00\u56fa\u5b9a\u957f\u5ea6\u533a\u95f4\uff0c\u5b83\u6700\u540e\u7684\u957f\u5ea6\u662f\u786e\u5b9a\u7684\uff0c\u56e0\u4e00\u6b21\u64cd\u4f5c\u5c06\u533a\u95f4\u957f\u524a\u51cf $k-1$\u3002\u4e3a `y=len%(k-1)==0?(k-1):len%(k-1)`\u3002\n\n#### \u9898\u89e3\n\n\n$f[l,r,s]$ \u8868\u793a\u533a\u95f4 $[l,r]$ \u7684\u7ec8\u6001\u4e3a $s$ \u7684\u6700\u5927\u4ef7\u503c\u3002$s$ \u662f\u4e00\u4e2a `y` \u4f4d\u4e8c\u8fdb\u5236\u6570\uff0c`y` \u7684\u542b\u4e49\u89c1\u4e0a\u3002\n\u679a\u4e3e $s$ \u7684\u6700\u540e\u4e00\u4f4d\u6240\u4ee3\u8868\u7684\u533a\u95f4\u540e\u7f00\u7684\u8d77\u59cb\u70b9 $i>l$\uff0c$f[l,r,s]=f[l,i-1,s>>1]+f[i,r,s\\&1]$\u3002\n$O(n^32^y)\\le O(n^32^k)$\u3002\n\n\u89c2\u5bdf\u5230\u6709\u6548\u5730 $i$ \u53ea\u53ef\u80fd\u662f $r,r-(k-1),r-2(k-1),...$\uff0c\u8fd9\u6837\u679a\u4e3e\u53ef\u5c06\u5e38\u6570 $\\div k$\u3002\n$O(n^32^k/k)$\u3002\u533a\u95f4 dp \u5e38\u6570\u5c0f\uff0c\u53ef\u901a\u8fc7\u3002\n\n\u4e00\u4e9b\u6ce8\u610f\u4e8b\u9879\uff1a\n1. LL\n2. \u679a\u4e3e $s$ \u65f6\uff0c\u5982\u679c `y==1`\uff0c\u53d1\u73b0\u6ca1\u6cd5\u8f6c\u79fb\u3002\u8003\u8651\u5012\u6570\u7b2c\u4e8c\u6b21\u8f6c\u79fb\u7684\u672b\u6001\u4f5c\u4e3a $s$ \u6765\u3002\u5373 `y+=(k-1)`\u3002\u4f46**\u50a8\u5b58** `f[l,r,s]` \u65f6\u7684 $s$ \u8fd8\u662f\u5f97\u6309\u6700\u540e\u4e00\u6b21\u7684 $s$ \u6765\u8868\u793a\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int N=305;\nint n,k,ans,a[N],c[260],v[260],f[N][N][260];\nsigned main(){\n\tcin>>n>>k;\n\tfor(int i=1;i<=n;i++)cin>>a[i];\n\tfor(int i=0;i<(1<<k);i++)cin>>c[i]>>v[i];\n\tmemset(f,-0x3f,sizeof(f));\n\tfor(int i=1;i<=n;i++)f[i][i][a[i]]=0;\n\tfor(int l=1;l+k-1<=n;l++){\n\t\tint x=0;\n\t\tfor(int i=l;i<=l+k-1;i++)x=(x<<1)+a[i];\n\t\tf[l][l+k-1][c[x]]=v[x];\n\t}\n\tfor(int len=2;len<=n;len++){\n\t\tfor(int l=1,r=len;r<=n;l++,r++){\n\t\t\tint x=len%(k-1);if(!x)x+=k-1;if(x<=1)x+=k-1;\n\t\t\tfor(int s=0;s<(1<<x);s++){\n\t\t\t\tint _s=x==k?c[s]:s;\n\t\t\t\tint tmp=f[0][0][0];\n\t\t\t\tfor(int i=r;i>l;i-=k-1)\n\t\t\t\t\tif(f[l][i-1][s>>1]!=f[0][0][0]&&f[i][r][s&1]!=f[0][0][0])\n\t\t\t\t\t\ttmp=max(tmp,f[l][i-1][s>>1]+f[i][r][s&1]);\n\t\t\t\tif(x==k&&tmp!=f[0][0][0])tmp+=v[s];\n\t\t\t\tf[l][r][_s]=max(f[l][r][_s],tmp);\n\t\t\t\tif(len==n)ans=max(ans,f[l][r][_s]);\n\t\t\t}\n\t\t}\n\t}\n\tcout<<ans;\n}\n```",
        "postTime": 1645170494,
        "uid": 300078,
        "name": "pengyule",
        "ccfLevel": 7,
        "title": "[HAOI2016]\u5b57\u7b26\u5408\u5e76"
    },
    {
        "content": "\u53d1\u73b0 $2 \\leq k \\leq 8$\uff0c\u4e8e\u662f\u53ef\u4ee5\u8003\u8651\u72b6\u538b DP\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u8bbe $f_{l,r,S}$ \u8868\u793a\u533a\u95f4 $[l, r]$ \u7ecf\u8fc7\u82e5\u5e72\u6b21\u64cd\u4f5c\u53d8\u6210 01 \u4e32 $S$ \u7684\u6700\u5927\u5206\u6570\u3002\n\n\u57fa\u4e8e\u8d2a\u5fc3\u7684\u601d\u60f3\uff0c\u6211\u4eec\u4e00\u5b9a\u8981**\u4f7f\u5f97\u6574\u4e2a 01 \u4e32\u6700\u7ec8\u4e0d\u53ef\u64cd\u4f5c**\uff0c\u6240\u4ee5 01 \u4e32 $S$ \u7684\u957f\u5ea6\u4e0d\u8d85\u8fc7 $k - 1$\uff0c\u5426\u5219 $S$ \u53ef\u4ee5\u7ee7\u7eed\u8fdb\u884c\u5408\u5e76\uff0c\u76f4\u5230\u5176\u957f\u5ea6\u5c0f\u4e8e\u7b49\u4e8e $k - 1$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u6709\u4e00\u4e2a\u5f88\u66b4\u529b\u7684\u505a\u6cd5\uff1a\n\n\u5bf9\u4e8e $l, r$\uff0c\u679a\u4e3e\u4e2d\u70b9 $mid$\uff0c\u518d\u679a\u4e3e\u533a\u95f4 $[l, mid]$ \u548c $[mid + 1, r]$ \u7684\u6240\u6709\u72b6\u6001\uff0c\u540c\u65f6\u679a\u4e3e\u5408\u5e76\u7684\u533a\u95f4 $[p, p + k - 1]$\uff0c\u76f4\u63a5\u8f6c\u79fb\u5373\u53ef\u3002\n\n\u8fd9\u6837\u505a\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(kn^32^{2k - 2})$ \u7684\uff0c\u4f1a T \u98de\u3002\n\n\u8fd9\u4e2a\u65f6\u5019\uff0c\u4e00\u822c\u7684\u60f3\u6cd5\u662f**\u627e\u5230\u4e00\u4e9b\u6709\u5229\u4e8e\u7edf\u8ba1\u7684\u6027\u8d28**\u3002\n\n------\n\n\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u4e00\u4e2a $p$ \u53ef\u80fd\u4f1a\u88ab\u591a\u4e2a\u533a\u95f4\u679a\u4e3e\u5230\uff0c**\u4f46\u662f\u5b83\u4eec\u8f6c\u79fb\u7684\u6548\u679c\u662f\u4e00\u6837\u7684**\u3002\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff1a\n\n\u5047\u8bbe\u6211\u4eec\u6709\u4e24\u4e2a\u533a\u95f4 $[l_1, r_1], [l_2, r_2]$\u3002\n\n\u524d\u8005\u679a\u4e3e\u51fa\u7684\u72b6\u6001\u5206\u522b\u4e3a\uff1a$00010, 10100$\uff1b\n\n\u540e\u8005\u679a\u4e3e\u51fa\u7684\u72b6\u6001\u5206\u522b\u4e3a\uff1a$00101, 01000$\uff1b\n\n\u5982\u679c\u524d\u8005\u53d6\u533a\u95f4 $[4, 8]$ \u5408\u5e76\uff0c\u540e\u8005\u53d6\u533a\u95f4 $[3, 7]$ \u5408\u5e76\uff0c\u90a3\u4e48\u4e0a\u9762\u7684\u4e24\u4e2a\u533a\u95f4\u5408\u5e76\u51fa\u6765\u662f\u7b49\u4ef7\u7684\u3002\n\n\u6240\u4ee5\u6211\u4eec\u9075\u4ece\u6700\u7b80\u5316\u539f\u5219\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u533a\u95f4\uff0c\u6211\u4eec\u94a6\u5b9a\u540e\u9762\u4e00\u90e8\u5206\u533a\u95f4\uff08\u5373 $[mid + 1, r]$ \u8fd9\u4e00\u90e8\u5206\uff09\u7684\u72b6\u6001\u53ea\u80fd\u4e3a 0 \u6216 1\uff08\u5373\u957f\u5ea6\u4e3a 1 \u7684 01 \u4e32\uff09\u3002\u5b9e\u9645\u4e0a\uff0c\u8fd9\u6837\u7684\u64cd\u4f5c\u76f8\u5f53\u4e8e\u4e0d\u65ad\u5f80\u4e00\u4e2a\u4e32\u4e2d\u6dfb 0 \u6216 1\u3002\n\n\u63a5\u7740\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u957f\u5ea6\u4e3a $len$ \u7684\u4e32\uff0c\u6700\u7ec8\u4e00\u5b9a\u4f1a\u88ab\u64cd\u4f5c\u6210\u957f\u5ea6\u4e3a $(len - 1)\\bmod (k - 1) + 1$ \u7684\u4e32\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u53ea\u8981\u6700\u521d\u7684 01 \u4e32\u7684\u957f\u5ea6\u662f\u786e\u5b9a\u7684\uff0c\u90a3\u4e48\u6700\u7ec8\u7684 01 \u4e32\u957f\u5ea6\u540c\u6837\u662f\u786e\u5b9a\u7684\u3002\n\n\u6240\u4ee5\uff0c\u5982\u679c\u4e00\u6bb5\u533a\u95f4\u7684\u957f\u5ea6 $len$ \u6ee1\u8db3 $(len - 1)\\bmod (k - 1) = 0$\uff0c\u90a3\u4e48\u7ecf\u8fc7\u82e5\u5e72\u6b21\u64cd\u4f5c\u540e\uff0c\u8fd9\u4e2a\u533a\u95f4\u4e00\u5b9a\u53ef\u4ee5\u53d8\u6210\u957f\u5ea6\u4e3a 1 \u7684 01 \u4e32\u3002\n\n\u56e0\u6b64\uff0c\u679a\u4e3e $mid$ \u65f6\uff0c\u6211\u4eec\u4e0d\u9700\u8981\u4e00\u4e2a\u4e2a\u4f4d\u7f6e\u5730\u679a\u4e3e\uff0c\u53ea\u9700\u8981\u6ee1\u8db3 $(r - mid - 1) \\bmod (k - 1) = 0$ \u5373\u53ef\u3002\n\n\uff08\u6240\u4ee5\uff0cDP \u72b6\u6001\u4e2d\u7684 $S$ \u5b9e\u9645\u4e0a\u53ef\u80fd\u5e26\u6709\u82e5\u5e72\u4e2a\u524d\u5bfc 0\uff0c\u53d6\u51b3\u4e8e\u6700\u7ec8\u53d8\u6210\u7684 01 \u4e32\u7684\u957f\u5ea6\uff09\n\n------\n\n\u7efc\u5408\u4e0a\u8ff0\u6027\u8d28\uff0c\u6211\u4eec\u5c31\u6709\u4e86\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n^2\\lfloor\\frac{n}{k}\\rfloor 2^{k - 1})$ \u7684\u505a\u6cd5\uff0c\u4e0d\u8fc7\u8fd9\u53ea\u662f\u4e00\u4e2a\u4e0a\u754c\uff0c\u5e76\u4e14\u533a\u95f4 DP \u672c\u8eab\u5c31\u662f\u8dd1\u4e0d\u6ee1\u7684\uff0c\u6240\u4ee5\u8fd9\u4e2a\u590d\u6742\u5ea6\u662f\u53ef\u4ee5\u901a\u8fc7\u7684\u3002\n\n\u4f46\u662f\uff0c\u4e0a\u8ff0\u505a\u6cd5\u5c31\u4e0d\u80fd\u5728\u8f6c\u79fb\u7684\u8fc7\u7a0b\u4e2d\u8ba1\u7b97\u7b54\u6848\u4e86\u3002\n\n\u4e0d\u8fc7\uff0c\u7ed3\u5408\u524d\u9762\u7684\u8fd9\u53e5 \u201c\u5b9e\u9645\u4e0a\uff0c\u8fd9\u6837\u7684\u64cd\u4f5c\u76f8\u5f53\u4e8e\u4e0d\u65ad\u5f80\u4e00\u4e2a\u4e32\u4e2d\u6dfb 0 \u6216 1\u201d\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u5f53 $(len - 1) \\bmod (k-1) = 0$ \u65f6\uff0c01 \u4e32\u4e2d\u6b63\u597d\u6dfb\u52a0\u4e86 $k$ \u4e2a\u5b57\u7b26\u3002\u6b64\u65f6\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u5b83\u4eec\u518d\u5408\u5e76\u4e00\u6b21\uff0c\u540c\u65f6\u8ba1\u7b97\u7b54\u6848\u4e86\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cassert>\n#include<cstring>\n\n#define MAXN 305\n#define MAXM 8\n\nusing LL = long long;\nusing namespace std;\n\nint n, k, a[MAXN], c[1 << MAXM];\nLL ans, w[1 << MAXM], f[MAXN][MAXN][1 << MAXM];\nconst LL INF = 0x3F3F3F3F3F3F3F3F;\n\nint main()\n{\n    #ifdef FILE\n        freopen(\"Input.in\", \"r\", stdin);\n        freopen(\"Output.out\", \"w\", stdout);\n    #endif\n    scanf(\"%d%d\", &n, &k);\n    for(register int i = 1; i <= n; i++) scanf(\"%d\", a + i);\n    for(register int i = 0; i < (1 << k); i++) scanf(\"%d%lld\", c + i, w + i);\n    for(register int i = 1; i <= n; i++) for(register int j = 1; j <= n; j++) for(register int S = 0; S < (1 << k); S++) f[i][j][S] = -INF;\n    for(register int i = 1; i <= n; i++) f[i][i][a[i]] = 0;\n    for(register int len = 2; len <= n; len++)\n    {\n        for(register int l = 1, r = l + len - 1; r <= n; ++l, ++r)\n        {\n            int t = (len - 1) % (k - 1);\n            if(t == 0) t = k - 1;\n            for(register int mid = r - 1; mid >= l; mid -= k - 1)\n            {\n                for(register int S = 0; S < (1 << t); S++)\n                {\n                    f[l][r][S << 1] = max(f[l][r][S << 1], f[l][mid][S] + f[mid + 1][r][0]);\t//\u6dfb\u52a0\u4e00\u4e2a 0\n                    f[l][r][S << 1 | 1] = max(f[l][r][S << 1 | 1], f[l][mid][S] + f[mid + 1][r][1]);\t//\u6dfb\u52a0\u4e00\u4e2a 1\n                }\n            }\n            if(t == k - 1)\t//\u518d\u6b21\u5408\u5e76\n            {\n                LL g[2] = {-1LL, -1LL};\n                for(register int S = 0; S < (1 << k); S++) g[c[S]] = max(g[c[S]], f[l][r][S] + w[S]);\n                f[l][r][0] = g[0], f[l][r][1] = g[1];\n            }\n        }\n    }\n    ans = -INF;\n    for(register int i = 0; i < (1 << (k - 1)); i++) ans = max(ans, f[1][n][i]);\n    printf(\"%lld\\n\", ans);\n    return 0;\n}\n```",
        "postTime": 1641816257,
        "uid": 183562,
        "name": "_ReClouds_",
        "ccfLevel": 7,
        "title": "P3736 [HAOI2016] \u5b57\u7b26\u5408\u5e76 \u9898\u89e3"
    },
    {
        "content": "## \u9898\u76ee\u63cf\u8ff0\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3736)\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](http://cmsblog.top/archives/haoi2016-zi-fu-he-bing)\n\n## \u601d\u8def\n\n\u5047\u8bbe $dp_{l,r,S}$ \u8868\u793a\u533a\u95f4 $[l,r]$ \u5408\u5e76\u6210\u4e8c\u8fdb\u5236\u6570 $S$ \u7684\u6700\u5927\u5206\u6570\u3002\n\n\u7136\u540e\u8003\u8651\u8f6c\u79fb\u3002\n\n\u9996\u5148\u6709\u4e00\u4e2a\u7ed3\u8bba\uff0c\u5c3d\u53ef\u80fd\u591a\u7684\u5408\u5e76\u76f4\u5230\u4e0d\u80fd\u5408\u5e76\u4f4d\u7f6e\u3002\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5408\u5e76\u540e\u957f\u5ea6\u4e3a $1$ \u7684\u533a\u95f4\u3002\u663e\u7136\uff0c\u8fd9\u4e2a\u533a\u95f4\u7684\u5927\u5c0f\u4e3a\u96c6\u5408 $S =\\{x|n \\in \\mathbb{N}\\ x=nk-n+1\\}$\uff0c\u7136\u540e\u5c31\u6709 $dp_{l,r,2w}=dp_{l,mid,w}+dp_{mid+1,r,0}$\uff0c\u5176\u4e2d $r - mid \\in S$\uff1b\u4ee5\u53ca $dp_{l,r,2w+1}=dp_{l,mid,w} + dp_{mid+1,r,1}$\uff0c\u5176\u4e2d $r-mid\\in S$\u3002\n\n\u7136\u540e\u5c31\u662f\u521d\u59cb\u5316\uff0c$i$ \u5230 $j$ \u6070\u597d\u6709 $k$ \u4f4d\u6570\u5b57\uff0c\u6211\u4eec\u76f4\u63a5\u628a\u5b83\u5408\u5e76\u4e00\u6b21\uff0c\u5177\u4f53\u5b9e\u73b0\u770b\u4ee3\u7801\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\n\nconst int MAXK = 8, MAXN = 310;\n\nint N, K;\nint A[MAXN], W[MAXN], C[MAXN];\nint Dp[MAXN][MAXN][1 << MAXK];\n\nsigned main() {\n\tmemset(Dp, 0xcf, sizeof Dp);\n\tcin >> N >> K;\n\tfor (int i = 1; i <= N; i++) cin >> A[i];\n\tfor (int i = 0; i < (1 << K); i++)\n\t\tcin >> C[i] >> W[i];\n\tfor (int i = 1; i <= N; i++) \n\t\tDp[i][i][A[i]] = 0;\n\tfor (int len = 2; len <= N; len++) {\n\t\tfor (int l = 1; l + len - 1 <= N; l++) {\n\t\t\tint r = l + len - 1;\n\t\t\tint tmp = (len - 1) % (K - 1);\n\t\t\tif (!tmp) tmp = K - 1;\n\t\t\tfor (int k = r - 1; k >= l; k -= (K - 1)) {\n\t\t\t\tfor (int w = 0; w < (1 << tmp); w++) {\n\t\t\t\t\tDp[l][r][w << 1] = max(Dp[l][r][w << 1], Dp[l][k][w] + Dp[k + 1][r][0]);\n\t\t\t\t\tDp[l][r][w << 1 | 1] = max(Dp[l][r][w << 1 | 1], Dp[l][k][w] + Dp[k + 1][r][1]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (tmp == K - 1) {\n\t\t\t\tint CYB1 = INT_MIN, CYB2 = INT_MIN;\n\n                for (int k = 0; k < (1 << K); ++ k) {\n                    if (C[k] == 0)\n                        CYB1 = max(CYB1, Dp[l][r][k] + W[k]);\n                    else\n                        CYB2 = max(CYB2, Dp[l][r][k] + W[k]);\n                }\n\n                Dp[l][r][0] = CYB1;\n\t\t\t\tDp[l][r][1] = CYB2;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tint Ans = INT_MIN;\n\tfor (int i = 0; i < (1 << K); i++)\n\t\tAns = max(Ans, Dp[1][N][i]);\t\n\tcout << Ans << endl;\n\treturn 0;\n}\n```",
        "postTime": 1664873055,
        "uid": 461426,
        "name": "CmsMartin",
        "ccfLevel": 6,
        "title": "[HAOI2016]\u5b57\u7b26\u5408\u5e76"
    },
    {
        "content": "~~\u4e0d\u77e5\u9053\u6709\u6ca1\u6709\u4eba\u548c\u6211\u4e00\u6837\u6ca1\u8bfb\u61c2\u9898\u76ee\u3002~~\n\n**\u9898\u610f\uff1a**\n\n\u6709\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$  \u7684 $01$ \u4e32\uff0c\u4f60\u53ef\u4ee5\u6bcf\u6b21\u5c06\u76f8\u90bb\u7684 $k$ \u4e2a\u5b57\u7b26\u5408\u5e76\uff0c\u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u5b57\u7b26\u5e76\u83b7\u5f97\u4e00\u5b9a\u5206\u6570\u3002\u8bfb\u5165\u7684 $c_i$ \u548c $w_i$ \u8868\u793a\uff0c\u5982\u679c\u957f\u5ea6\u4e3a $k$ \u7684 $01$ \u4e32\u8fde\u6210\u4e8c\u8fdb\u5236\u540e\u5f97\u5230\u7684\u6570\u4e3a $i$, \u90a3\u4e48\uff0c\u8fd9\u4e2a\u5b57\u7b26\u4e32\u5c06\u4f1a\u53d8\u4e3a $c_i$, \u83b7\u5f97\u7684\u5206\u6570\u4e3a $w_i$\u200b\u3002\n\n\u4f8b\u5982\uff0c\u6837\u4f8b\u5c31\u8868\u793a\uff1a\n\n>1 10       00\u2014\u2014>1    \u5f97\u5206\uff1a10\n>\n>1 10       01\u2014\u2014>1    \u5f97\u5206\uff1a10\n>\n>0 20       10\u2014\u2014>0    \u5f97\u5206\uff1a 20\n>\n>1 30       11\u2014\u2014>1     \u5f97\u5206\uff1a30\n\n**\u9898\u89e3\uff1a**\n\n$w_i$\u200b \u90fd\u662f\u6b63\u6570\u53ea\u6709\u628a\u4e00\u4e2a\u533a\u95f4\u5408\u5e76\u5230\u4e0d\u80fd\u518d\u5408\u5e76\uff0c\u5f97\u5230\u7684\u7b54\u6848\u624d\u662f\u6700\u4f18\u7684\u3002\n\n\u770b\u5230 $k$\u200b\u200b\u200b \u7684\u53d6\u503c\u53ef\u4ee5\u60f3\u5230\u72b6\u538bdp\uff0c\u6839\u636e\u9898\u76ee\u4e2d\u5e8f\u5217\u5408\u5e76\u7684\u64cd\u4f5c\uff0c\u5408\u5e76\u7684\u533a\u95f4\u4e4b\u95f4\u662f\u4e0d\u76f8\u4ea4\u7684\uff0c\u53ef\u4ee5\u60f3\u5230\u533a\u95f4dp\u3002\n\n\u8bbe $f(i,j,s)$\u200b\u200b \u8868\u793a\u5c06\u5b57\u7b26\u4ece $i$\u200b\u200b \u5230 $j$\u200b\u200b \u5408\u5e76\u6210 $s$\u200b\u200b\u200b\u200b \u6240\u5f97\u7684\u6700\u9ad8\u5206\u6570\u3002\n\n\u6700\u540e\u7b54\u6848\u4e3a $f(1,n, $\u200b\u6240\u4ee5\u72b6\u6001$)$\u200b\u200b\u200b \u4e2d\u7684\u6700\u5927\u503c\u3002\n\n\u8f6c\u79fb\u65f6\uff0c\u66b4\u529b\u7684\u8f6c\u79fb\u80af\u5b9a\u4f1a\u8d85\u65f6\uff0c\u6211\u4eec\u8003\u8651\u679a\u4e3e\u4e2d\u95f4\u65ad\u70b9\uff0c\u4f7f\u65ad\u70b9\u53f3\u8fb9\u7684\u5b50\u4e32\u5408\u6210 $s$\u200b \u7684\u6700\u540e\u4e00\u4f4d\uff0c\u65ad\u70b9\u53f3\u8fb9\u5408\u6210\u5176\u4ed6\u7684\u6570\u5b57\u3002\n\n\u60f3\u8ba9\u5b50\u4e32\u5408\u6210\u4e00\u4f4d\uff0c\u90a3\u4e48\u539f\u4e32\u7684\u957f\u5ea6\u4e3a $x \\times (k - 1) + 1$\u200b, (\u4e0d\u660e\u767d\u7684\uff0c \u53ef\u4ee5\u60f3\u51e0\u4e2a\u4f8b\u5b50)\uff0c\u6240\u4ee5\u6211\u4eec\u6bcf\u6b21\u5c06\u4e2d\u95f4\u65ad\u70b9\u7684\u503c\u6539\u53d8\u200b $k - 1$\u200b\u200b \u5c31\u53ef\u4ee5\u3002\u8fd9\u6837\u5c31\u7f29\u5c0f\u4e86\u8f6c\u79fb\u4e2d\u679a\u4e3e\u7684\u8303\u56f4\u3002\n\n\u5f53 $(j - i) \\bmod (k - 1) \\not= 0$\u200b\u200b\u200b\u200b  \u65f6\uff0c\n\n$f(i,j,s) = \\max(f(i,j,s), f(i,mid,s) + f(mid + 1,j,s))$\u200b\u200b\n\n\u5f53 $(j - i) \\bmod (k - 1) = 0$\u200b \u65f6\uff0c\u9700\u8981\u76f4\u63a5\u628a\u5b83\u4eec\u5408\u5e76\u4e00\u6b21\u3002\n\n~~\u4ee3\u7801\u548c zxTLE\u5f88\u50cf\uff0c\u56e0\u4e3a\u770b\u4e86\u4ed6\u7684\u9898\u89e3\u3002~~\n\n```c\n/*\nDate:2021.8.2\nSource:luogu 3736   \nkonwledge:\u533a\u95f4dp + \u72b6\u538bdp \n*/\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#define orz cout << \"AK IOI\"\n#define int long long\n\nusing namespace std;\n\ninline int read()\n{\n\tint f = 0, x = 0; char ch = getchar();\n\twhile(!isdigit(ch)) f |= (ch == '-'), ch = getchar();\n\twhile(isdigit(ch)) x = x * 10 + (ch ^ 48), ch = getchar();\n\treturn f ? -x : x;\n}\ninline void print(int X)\n{\n\tif(X < 0) {X = ~(X - 1); putchar('-');}\n\tif(X > 9) print(X / 10);\n\tputchar(X % 10 + '0');\n}\nint n, k, s[310], c[310], w[310], f[310][310][310]; \nsigned main()\n{\n\tn = read(), k = read();\n\tfor(int i = 1; i <= n; i++) s[i] = read();\n\tfor(int i = 0; i < (1 << k); i++) c[i] = read(), w[i] = read();\n\tmemset(f, -63, sizeof f);\n\tfor(int i = n; i >= 1; i--)\n\t{\n\t\tfor(int j = i; j <= n; j++)\n\t\t{\n\t\t\tif(i == j) { f[i][j][s[i]] = 0; continue;}\n\t\t\tint len = j - i;\n\t\t\tlen %= (k - 1);\n\t\t\tif(len == 0) len = k - 1;\n\t\t\tfor(int mid = j; mid > i; mid -= k - 1)\n\t\t\t\tfor(int s = 0; s < (1 << len); s++)\n\t\t\t\t{\n\t\t\t\t\tf[i][j][s << 1] = max(f[i][j][s << 1], f[i][mid - 1][s] + f[mid][j][0]);\n\t\t\t\t\tf[i][j][s << 1 | 1] = max(f[i][j][s << 1 | 1], f[i][mid - 1][s] + f[mid][j][1]);\n\t\t\t\t}\n\t\t\tif(len == k - 1)\n\t\t\t{\n\t\t\t\tint g[2];\n\t\t\t\tg[0] = g[1] = -0x3f3f3f3f;\n\t\t\t\tfor(int s = 0; s < (1 << k); s++)\n\t\t\t\tg[c[s]] = max(g[c[s]], f[i][j][s] + w[s]);\n\t\t\t\tf[i][j][0] = g[0], f[i][j][1] = g[1];\n\t\t\t}\n\t\t}\n\t}\t\n\tint ans = -0x3f3f3f3f;\n\tfor(int i = 0; i < (1 << k); i++) ans = max(ans, f[1][n][i]);\n\tprint(ans);\n\treturn 0;\t\n}\n```\n\n\u611f\u8c22 https://www.luogu.com.cn/blog/kingjack/solution1-p3736\n",
        "postTime": 1627893684,
        "uid": 174685,
        "name": "\u7a0b\u95e8\u7acb\u96ea",
        "ccfLevel": 4,
        "title": "[HAOI2016]\u5b57\u7b26\u5408\u5e76 \u9898\u89e3"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/Coros-Trusds/p/16413282.html)\n\n# \u9898\u76ee\u5927\u610f\n\n\u6709\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684 $01$ \u4e32\uff0c\u4f60\u53ef\u4ee5\u6bcf\u6b21\u5c06\u76f8\u90bb\u7684 $k$ \u4e2a\u5b57\u7b26\u5408\u5e76\uff0c\u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u5b57\u7b26\u5e76\u83b7\u5f97\u4e00\u5b9a\u5206\u6570\u3002\n\n\u5f97\u5230\u7684\u65b0\u5b57\u7b26\u548c\u5206\u6570\u7531\u8fd9 $k$ \u4e2a\u5b57\u7b26\u786e\u5b9a\u3002\u4f60\u9700\u8981\u6c42\u51fa\u4f60\u80fd\u83b7\u5f97\u7684\u6700\u5927\u5206\u6570\u3002\n\n# \u9898\u76ee\u5206\u6790\n\n\u56e0\u4e3a\u6240\u6709\u7684\u5206\u6570\u90fd\u4e0d\u5b58\u5728\u8d1f\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u80af\u5b9a\u8981\u9009\u5230\u4e0d\u80fd\u9009\uff0c\u4e5f\u5c31\u662f\u76f4\u5230\u6574\u4e2a $01$ \u4e32\u7684\u957f\u5ea6\u5c0f\u4e8e $k$ \u4e3a\u6b62\u3002\u7ecf\u8fc7\u6570\u5b66\u5f52\u7eb3\u6cd5\uff0c\u6211\u4eec\u4e5f\u80fd\u591f\u53d1\u73b0\uff1a\u5f53\u539f\u4e32\u7684\u957f\u5ea6\u4e3a $l$ \u65f6\uff0c\u6700\u540e\u5269\u4e0b\u7684\u957f\u5ea6\u4e3a $(l-1)\\bmod(k-1)+1$\u3002\n\n\u53ef\u4ee5\u901a\u8fc7\u8ba1\u7b97\u5f97\u5230\u5f53\u524d\u4e32\u5269\u4e0b\u7684\u957f\u5ea6\u800c\u8fdb\u884c\u679a\u4e3e\u3002\n\n--------------\n\u4ee4 $dp[l][r][i]$ \u8868\u793a\u533a\u95f4 $[l,r]$ \u53d8\u6210\u72b6\u6001 $i$ \u7684\u6700\u5927\u5206\u6570\u3002\n\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u7c7b\u4f3c\u4e8e\u77f3\u5b50\u5408\u5e76\uff0c$dp[l,r,s]=\\max\\{dp[l][k][s>>1]+dp[k+1][r][0/1]\\}$\u3002\n\n\u4f46\u8981\u6ce8\u610f\u679a\u4e3e\u65ad\u70b9\u65f6\u6bcf\u6b21\u51cf\u53bb $k-1$\u3002\u56e0\u4e3a\u6211\u4eec\u72b6\u6001\u8f6c\u79fb\u4e2d\u53f3\u8fb9\u533a\u95f4\u5408\u5e76\u6210\u4e00\u4f4d\uff0c\u800c\u53ea\u6709\u957f\u5ea6\u4e3a $a(k-1)+1$ \u7684\u533a\u95f4\u624d\u80fd\u5408\u5e76\u6210 $1$ \u4f4d\uff0c\u6545\u5982\u6b64\u3002\u5e76\u4e14\u679a\u4e3e\u9700\u8981\u5012\u5e8f\u679a\u4e3e\u3002\n\n# \u4ee3\u7801\n\n```cpp\n// Problem: P3736 [HAOI2016]\u00d7\u00d6\u00b7\u00fb\u00ba\u00cf\u00b2\u00a2\n// Contest: Luogu\n// URL: https://www.luogu.com.cn/problem/P3736\n// Memory Limit: 250 MB\n// Time Limit: 1000 ms\n// Date:2022-06-25 22:30\n// \n// Powered by CP Editor (https://cpeditor.org)\n\n#include <iostream>\n#include <cstdio>\n#include <climits>//need \"INT_MAX\",\"INT_MIN\"\n#include <cstring>//need \"memset\"\n#include <numeric>\n#include <algorithm>\n#include <cmath>\n#define int long long\n#define enter putchar(10)\n#define debug(c,que) std::cerr << #c << \" = \" << c << que\n#define cek(c) puts(c)\n#define blow(arr,st,ed,w) for(register int i = (st);i <= (ed); ++ i) std::cout << arr[i] << w;\n#define speed_up() std::ios::sync_with_stdio(false),std::cin.tie(0),std::cout.tie(0)\n#define mst(a,k) memset(a,k,sizeof(a))\n#define stop return(0)\nconst int mod = 1e9 + 7;\ninline int MOD(int x) {\n\tif(x < 0) x += mod;\n\treturn x % mod;\n}\nnamespace Newstd {\n\tchar buf[1 << 21],*p1 = buf,*p2 = buf;\n\tinline int getc() {\n\t\treturn p1 == p2 && (p2 = (p1 = buf) + fread(buf,1,1 << 21,stdin),p1 == p2) ? EOF : *p1 ++;\n\t}\n\tinline int read() {\n\t\tint ret = 0,f = 0;char ch = getc();\n\t\twhile (!isdigit(ch)) {\n\t\t\tif(ch == '-') f = 1;\n\t\t\tch = getc();\n\t\t}\n\t\twhile (isdigit(ch)) {\n\t\t\tret = (ret << 3) + (ret << 1) + ch - 48;\n\t\t\tch = getc();\n\t\t}\n\t\treturn f ? -ret : ret;\n\t}\n\tinline double double_read() {\n\t\tlong long ret = 0,w = 1,aft = 0,dot = 0,num = 0;\n\t\tchar ch = getc();\n\t\twhile (!isdigit(ch)) {\n\t\t\tif (ch == '-') w = -1;\n\t\t\tch = getc();\n\t\t}\n\t\twhile (isdigit(ch) || ch == '.') {\n\t\t\tif (ch == '.') {\n\t\t\t\tdot = 1;\n\t\t\t} else if (dot == 0) {\n\t\t\t\tret = (ret << 3) + (ret << 1) + ch - 48;\n\t\t\t} else {\n\t\t\t\taft = (aft << 3) + (aft << 1) + ch - '0';\n\t\t\t\tnum ++;\n\t\t\t}\n\t\t\tch = getc();\n\t\t}\n\t\treturn (pow(0.1,num) * aft + ret) * w;\n\t}\n\tinline void write(int x) {\n\t\tif(x < 0) {\n\t\t\tputchar('-');\n\t\t\tx = -x;\n\t\t}\n\t\tif(x > 9) write(x / 10);\n\t\tputchar(x % 10 + '0');\n\t}\n}\nusing namespace Newstd;\n\nconst int INF = 0x3f3f3f3f3f3f3f3f;\nconst int N = 305,M = 8;\nint a[N],c[(1 << M) + 1],w[(1 << M) + 1],dp[N][N][(1 << M) + 1];\n//dp[l][r][k]:[l,r] \u00b1\u00e4\u00b3\u00c9\u00d7\u00b4\u00cc\u00ac i \u00b5\u00c4\u00d7\u00ee\u00b4\u00f3\u00b7\u00d6\u00ca\u00fd\nint n,m;\nint32_t main(void) {\n    scanf(\"%lld%lld\",&n,&m);\n\tfor (register int i = 1;i <= n; ++ i) scanf(\"%1lld\",a + i);\n\tfor (register int i = 0;i < (1 << m); ++ i) scanf(\"%lld%lld\",c + i,w + i);\n\tmst(dp,-0x3f);\n\tfor (register int i = 1;i <= n; ++ i) dp[i][i][a[i]] = 0;\n\tfor (register int len = 2;len <= n; ++ len) {\n\t\tfor (register int l = 1;l + len - 1 <= n; ++ l) {\n\t\t\tint r = l + len - 1;\n\t\t\tint tmp = (len - 1) % (m - 1);\n\t\t\tif (!tmp) tmp = m - 1;\n\t\t\tfor (register int k = r - 1;k >= l;k -= m - 1) {\n\t\t\t\tfor (register int v = 0;v < (1 << tmp); ++ v) {\n\t\t\t\t\tdp[l][r][v << 1] = std::max(dp[l][r][v << 1],dp[l][k][v] + dp[k + 1][r][0]);\n\t\t\t\t\tdp[l][r][v << 1 | 1] = std::max(dp[l][r][v << 1 | 1],dp[l][k][v] + dp[k + 1][r][1]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (tmp == m - 1) {\n\t\t\t\tint t1 = -INF,t2 = -INF;\n\t\t\t\tfor (register int k = 0;k < (1 << m); ++ k) {\n\t\t\t\t\tif (c[k] == 0) t1 = std::max(t1,dp[l][r][k] + w[k]);\n\t\t\t\t\telse t2 = std::max(t2,dp[l][r][k] + w[k]);\n\t\t\t\t}\n\t\t\t\tdp[l][r][0] = t1,dp[l][r][1] = t2;\n\t\t\t}\n\t\t}\n\t}\n\tint res = -INF;\n\tfor (register int i = 0;i < (1 << m); ++ i) {\n\t\tres = std::max(res,dp[1][n][i]);\n\t}\n\tprintf(\"%lld\\n\",res);\n\t\n\treturn 0;\n}\n```",
        "postTime": 1656197452,
        "uid": 430409,
        "name": "Coros_Trusds",
        "ccfLevel": 6,
        "title": "P3736 [HAOI2016]\u5b57\u7b26\u5408\u5e76"
    }
]
[
    {
        "content": "~~\u524d\u8a00\uff1a\u5b89\u5229\u4e00\u53d1\u81ea\u5df1\u7684[\u535a\u5ba2](https://www.cnblogs.com/ezsyshx/p/10449623.html)\uff08LaTeX\u6302\u4e86\u8fd9\u8fb9\u8d70\uff09~~\uff08\u6b63\u5728\u8fc1\u79fb\uff09\n\nUPD:\u53d1\u73b0$LaTeX$\u6709\u90e8\u5206\u4e0d\u80fd\u6b63\u5e38\u663e\u793a\uff0c~~\u5728\u6d1b\u8c37\u535a\u5ba2\u91cc\u8fd8\u597d\u597d\u7684~~\uff0c\u8bd5\u7740\u8c03\u4e86\u4e00\u4e0b\uff0c\u5e76\u5220\u9664\u4e86\u4e00\u4e9b\u53ef\u6709\u53ef\u65e0\u7684\u8bdd\uff0c\u6c42\u901a\u8fc7\n\n\u9898\u76ee\u63cf\u8ff0\uff1a\n> \u6570\u5217 $a$ \u6ee1\u8db3\n$$A_i=\\frac{A_{i-1}-A_{i+1}}{2}+d$$\n> \u7ed9\u51fa\uff1a\u9996\u9879 $A_1$\u3001\u672b\u9879 $A_n$\u3001$d$\u3001$m$\uff0c\u6c42$A_m$\n\n\u7b97\u6cd5\u5206\u6790\uff1a\n\n\u77e9\u9635\u5feb\u901f\u5e42\uff1f~~\u8fd8\u6ca1\u5b66~~\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u7528\u6570(mo)\u5b66(fa)\u6765\u89e3\u51b3\u8fd9\u9053\u9898\u3002\n\n\u9884\u5907\u77e5\u8bc6\uff1a\u7279\u5f81\u65b9\u7a0b\n\n-----\n\n\u6211\u4eec\u4ee5\u8fd9\u4e2a\u5f0f\u5b50\u4e3a\u4f8b\u2014\u2014 $f_i=f_{i-1}+6f_{i-2}$\n\n\u9996\u5148\u6211\u4eec\u6765\u770b\u4e24\u4e2a\u6570\u96c6\n\n$A=\\{x\\mid x=(-2)^k,k\\in\\mathbb{N^*}\\}\\ ,\\ B=\\{x\\mid x=3^k,k\\in\\mathbb{N^*}\\}$\n\n\u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u4ee5\u5217\u51fa $A$ \u7684\u524d\u51e0\u9879\uff1a$-2,4,-8,16,...$\uff0c$B$ \u7684\u524d\u51e0\u9879\uff1a$3,9,27,81,...$\n\n\u5c06 $A$ \u4ee3\u5165\u9012\u63a8\u5f0f\uff0c\u795e\u5947\u7684\u53d1\u73b0\u2014\u2014\n\n$f_1=-2$\n\n$f_2=4$\n\n$f_3=4+6\\times(-2)=-8$\n\n$f_4=-8+6\\times4=16$\n\n$......$\n\n$A$ \u4e2d\u7684\u6570\u90fd\u6ee1\u8db3\u4e0a\u8ff0\u7684\u9012\u63a8\u5f0f\uff0c\u540c\u6837\u7684\uff0c$B$ \u4e5f\u6ee1\u8db3\u3002\n\n\u5f88\u660e\u663e\uff0c$f_i=(-2)^k$ \u548c $f_i=3^k$ \u90fd\u662f\u4e0a\u8ff0\u9012\u63a8\u5f0f\u7684**\u901a\u9879\u516c\u5f0f**\n\n\u4e0b\u9762\u6211\u4eec\u6765\u770b\u4e24\u4e2a\u5f15\u7406\u2014\u2014\n\n> 1\u3001\u82e5 $f_i=a^i$ \u662f\u67d0\u4e00\u9012\u63a8\u5f0f\u7684\u901a\u9879\u516c\u5f0f\uff0c\u90a3\u4e48\uff0c$f_i=\\lambda a^i$ \u540c\u6837\u6ee1\u8db3\u9012\u63a8\u5f0f\uff08\u4e24\u8fb9\u540c\u4e58\u4e0a\u7cfb\u6570\u5373\u53ef\uff09\n\n> 2\u3001\u82e5 $f_i=a^i$ \u548c $f_i=b^i$ \u90fd\u6ee1\u8db3\u9012\u63a8\u5f0f\uff0c\u90a3\u4e48\uff0c$f_i=\\alpha\\times a^i+\\beta\\times b^i$ \u540c\u6837\u6ee1\u8db3\uff08\u4e24\u5f0f\u4e58\u4e0a\u7cfb\u6570\u76f8\u52a0\u5373\u53ef\uff09\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u6765\u770b\u4e00\u4e2a\u7ecf\u5178\u7684\u4f8b\u5b50\u2014\u2014\u6590\u6ce2\u62c9\u5951\u6570\u5217 $f_i=f_{i-1}+f_{i-2}$\n\n\u73b0\u5728\u6211\u4eec\u4e0d\u80fd\u50cf\u521a\u624d\u90a3\u4e2a\u5f0f\u5b50\u201c\u89c2\u5bdf\u201d\u51fa\u4e00\u4e2a\u901a\u89e3\u4e86\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u6211\u4eec\u81ea\u5df1\u8fdb\u884c\u6784\u9020\n\n\u73b0\u5728\u6211\u4eec\u8bbe\u5b58\u5728\u4e00\u7ec4\u7b49\u6bd4\u6570\u5217\u6ee1\u8db3\u8fd9\u4e2a\u9012\u63a8\u5f0f\uff0c\u5176\u516c\u6bd4\u4e3a $q$ \uff0c\u90a3\u4e48\u6211\u4eec\u770b\u4e00\u4e0b\u8fd9\u4e2a\u5f0f\u5b50\u2014\u2014\n\n$$f_i=f_{i-1}+f_{i-2}$$\n\n$$q^2\\times f_{i-2}=q\\times f_{i-2}+f_{i-2}$$\n\n$$q^2=q+1$$\n\n$$q^2-q-1=0$$\n\n\u8fd9\u5c31\u662f\u6590\u6ce2\u62c9\u5951\u6570\u5217\u7684**\u7279\u5f81\u65b9\u7a0b**\n\n\uff08\u5f53\u7136\uff0c\u8fd9\u4e2a\u662f\u6bd4\u8f83\u5bb9\u6613\u7406\u89e3\u7684\u89e3\u91ca\uff0c\u8be6\u7ec6\u8bf4\u660e\uff1a\n[\u7279\u5f81\u65b9\u7a0b](https://baike.baidu.com/link?url=FFx3c3daptyvLOFdsZpkiiAh9lR4UmULMkB8LnslGBH1QshZxqnRD6VN675it7fMFnAyikI57TCzL7vqY0WgS2VEQtwpUDrr6iuS2bdQByVE8-UsHTBxQALE7uTrFFUL))\n\n\u628a\u5b83\u89e3\u51fa\u6765\uff0c\u53ef\u4ee5\u5f97\u5230\u2014\u2014 $q_1=\\frac{\\sqrt5+1}{2},q_2=\\frac{-\\sqrt5+1}{2}$\n\n\u90a3\u4e48\uff0c\u6211\u4eec\u5c31\u77e5\u9053\u4e86\u2014\u2014\u516c\u6bd4\u4e3a$\\frac{\\pm\\sqrt5+1}{2}$\u7684\u7b49\u6bd4\u6570\u5217\u6ee1\u8db3\u6590\u6ce2\u62c9\u5951\u6570\u5217\n\n\u90a3\u4e48\uff0c\u6211\u4eec\u53c8\u77e5\u9053\u4e86\u6570\u5217\u7684\u524d\u4e24\u9879\uff1a$f_1=f_2=1$\n\n\u6211\u4eec\u8bbe $f_i=\\alpha\\times(\\frac{\\sqrt5+1}{2})^i+\\beta\\times(\\frac{-\\sqrt5+1}{2})^i$\uff0c\u4ee3\u5165$f_1,f_2$\n\n\u5219\u2014\u2014\n\n$$\\begin{cases}\n\\alpha(\\frac{\\sqrt5+1}{2})+\\beta(\\frac{-\\sqrt5+1}{2})=f_1=1\\\\\\\\\n\\alpha(\\frac{\\sqrt5+1}{2})^2+\\beta(\\frac{-\\sqrt5+1}{2})^2=f_2=1\\\\\n\\end{cases}\n$$\n\n\u5f97 $\\alpha=\\frac{\\sqrt5}{5},\\beta=-\\frac{\\sqrt5}{5}$\uff0c\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u6c42\u51fa\u4e86\u901a\u9879\u516c\u5f0f\n\n\u56de\u5230\u4e4b\u524d\u7684\u9012\u63a8\u6570\u5217\u2014\u2014$f_i=f_{i-1}+6f_{i-2}$\uff0c\u600e\u4e48\u5f97\u51fa\u5176\u901a\u89e3\u7684\uff1f\n\n\u5176\u5b9e\u5f88\u7b80\u5355\u3002\u6211\u4eec\u8bbe\u7b49\u6bd4\u6570\u5217\u516c\u6bd4\u4e3a $q$\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u7279\u5f81\u65b9\u7a0b\u2014\u2014 $q^2-q-6=0 \\Rightarrow q_1=-2,q_2=3$\n\n-----\n\n\u8fdb\u5165\u6b63\u9898\uff0c\u9996\u5148\u6765\u819c\u6539\u4e00\u4e0b\u5f0f\u5b50\uff1a\n$$A_i=\\frac{A_{i-1}-A_{i+1}}{2}+d$$\n$$2A_i=A_{i-1}-A_{i+1}+2d$$\n$$A_{i+1}=-2A_{i}+A_{i-1}+2d$$\n\u8fd9\u662f $A$ \u7684\u9012\u63a8\u5f0f\uff0c\u6211\u4eec\u5c06 $i$ \u51cf $1$\uff1a\n$$A_{i}=-2A_{i-1}+A_{i-2}+2d$$\n\u73b0\u5728\u6211\u4eec\u5f97\u51fa\u4e86\u7b54\u6848 \u2014\u2014 $A_{i}=-2A_{i-1}+A_{i-2}+2d$\n\n\u90a3\u4e48\u6211\u4eec\u5148\u5c06 $2d$ \u653e\u5728\u4e00\u8fb9\uff0c\u8bbe\u6570\u5217 $a$ \u6ee1\u8db3 $a_{i}=-2a_{i-1}+a_{i-2}$\n\u8bbe\u6b64\u6570\u5217\u516c\u6bd4\u4e3a $q$\uff0c\u73b0\u5728\u4ee3\u5165\u2014\u2014\n$$q^2a_{i-2}=-2qa_{i-2}+a_{i-2}$$\n$$q^2+2q-1=0$$\n\u8fd9\u5c31\u662f\u4e0a\u8ff0\u9012\u63a8\u5f0f\u7684**\u7279\u5f81\u65b9\u7a0b**\n\u73b0\u5728\u89e3\u4e00\u4e0b\u8fd9\u4e2a\u65b9\u7a0b\uff0c\u53ef\u4ee5\u5f97\u5230\u2014\u2014 $q_1=-\\sqrt{2}-1,q_2=\\sqrt{2}-1$\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u8fd9\u4e2a\u6570\u5217\u7684\u901a\u9879\u516c\u5f0f\u2014\u2014\n$$a_i=\\alpha(-\\sqrt{2}-1)^i+\\beta(\\sqrt{2}-1)^i$$\n\u5176\u4e2d $i\\leq n$\uff0c\u5e76\u4e14\n$$\\begin{cases}\n\\alpha(-\\sqrt{2}-1)+\\beta(\\sqrt{2}-1)=a_1\\\\\n\\alpha(-\\sqrt{2}-1)^n+\\beta(\\sqrt{2}-1)^n=a_n\\\\\n\\end{cases}\n$$\n\u5c06\u4e0a\u9762\u7684\u65b9\u7a0b\u89e3\u51fa\u6765\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u2014\u2014\n$$\\begin{cases}\n\\alpha=\\frac{a_1(\\sqrt{2}-1)^{n-1}-a_n}{(-\\sqrt{2}-1)(\\sqrt{2}-1)^{n-1}-(-\\sqrt{2}-1)^n}\\\\\n\\\\\n\\beta=\\frac{a_1(-\\sqrt{2}-1)^{n-1}-a_n}{(\\sqrt{2}-1)(-\\sqrt{2}-1)^{n-1}-(\\sqrt{2}-1)^n}\\\\\n\\end{cases}\n$$\n\u4ee3\u5165\u901a\u9879\u516c\u5f0f\u5e76\u6574\u7406\u2014\u2014\n$$a_m=\\frac{a_n[(\\sqrt{2}-1)^{m-1}-(-1)^{m-1}(\\sqrt{2}+1)^{m-1}]+(-1)^{m-1}a_1[(\\sqrt{2}-1)^{n-m}-(-\\sqrt{2}-1)^{n-m}]}{(\\sqrt{2}-1)^{n-1}-(-1)^{n-1}(\\sqrt{2}+1)^{n-1}}$$\n\u8bbe$f(x)=(\\sqrt2-1)^x-(-1)^x(\\sqrt2+1)^x$\uff0c\u53ef\u5f97\n$$a_m=\\frac{a_n\\times f(m-1)+(-1)^{m-1}a_1\\times f(n-m)}{f(n-1)}$$\n\u597d\u4e86\uff0c\u73b0\u5728\u662f\u6700\u540e\u4e00\u4e2a\u95ee\u9898\u2014\u2014\u8fd8\u6709$d$\u5462\uff01\n\n\u89c2\u5bdf\u9012\u63a8\u5f0f\u2014\u2014 $A_i=-2A_{i-1}+A_{i-2}+2d$\n\n\u6211\u4eec\u8bbe $A_i=a_i+p\\times d$\uff0c\u4ee3\u5165\u2014\u2014\n\n$$A_i=-2A_{i-1}+A_{i-2}+2d$$\n$$a_i+pd=-2a_{i-1}-2pd+a_{i-2}+pd+2d$$\n\u6211\u4eec\u53c8\u6709 $a_{i}=-2a_{i-1}+a_{i-2}$\uff0c\u90a3\u4e48\u4e24\u8fb9\u7ea6\u53bb\uff0c\u53ef\u5f97\u2014\u2014\n$$pd=-2pd+pd+2d \\Rightarrow p=1$$\n\u6545 $A_i=a_i+d$\n\u90a3\u4e48\uff0c\u6839\u636e\u9898\u610f\uff0c\u6211\u4eec\u6765\u819c\u6539\u4e00\u4e0b\u5f0f\u5b50\u2014\u2014\n$$A_m=\\frac{(A_n-d)\\times f(m-1)+(-1)^{m-1}(A_1-d)\\times f(n-m)}{f(n-1)}+d$$\n\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u6570\u5217\u7684\u901a\u9879\u516c\u5f0f\uff0c\u4ee3\u7801\u5c31\u5f88\u597d\u5199\u4e86~~\uff08\u6ca1\u7528\u9f9f(kuai)\u901f\u5e42\uff0c\u6570\u636e\u592a\u5f31QwQ\uff09~~\n\n-----\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst double p=sqrt(2)-1;\nint n,m; double d,a1,an;\ndouble c(int op) {return (op&1)?-1:1;}\ndouble f(int x) {return pow(p,x)-c(x)*pow(p+2,x);}\nint main()\n{\n    scanf(\"%d%d%lf%lf%lf\",&n,&m,&d,&a1,&an);\n    if(m==0) printf(\"0.000\");\n    else printf(\"%.3lf\",((an-d)*f(m-1)+c(m-1)*(a1-d)*f(n-m))/f(n-1)+d);\n    return 0;\n}\n```\n#### \u5b8c\u7ed3\u6492\u82b1QwQ",
        "postTime": 1551329394,
        "uid": 38947,
        "name": "\u5e38\u9752\u85e4",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P1487 \u3010\u5931\u843d\u7684\u6210\u7ee9\u5355\u3011"
    },
    {
        "content": "\u8fd9\u9898\u771f\u7684\u6709\u697c\u4e0b\u90a3\u4e9b\u5927\u4f6c\u4eec\u8bb2\u7684\u90a3\u4e48\u590d\u6742\u5417\uff1f\u6765\u4e00\u4e2a\u4e8c\u5206\u7684\u9898\u89e3\u3002\n\n\u9996\u5148\u73b0\u6839\u636e\u9898\u76ee\u91cc\u7684\n$$a_i = {(a_{i-1} + a_{i+1}) \\over 2} + d$$\n\n\u7528\u4e00\u70b9\u5c0f\u5b66\u6570\u5b66\u77e5\u8bc6\u53d8\u6362\u4e00\u4e0b\uff0c\u5f97\u5230\n$$a_{i+1} = {a_{i-1} - 2(a_i - d)}$$\n\n\u628a\u4e0b\u6807\u51cf$1$\uff0c\u5f97\u5230\u9012\u63a8\u5f0f\n$$a_i = a_{i-2} - 2(a_{i-1} - d)$$\n\n\u7136\u540e\u6211\u4eec\u5206\u6790$a_n$\u4e0e$a_2$\u7684\u5173\u7cfb\n\n\u6211\u4eec\u5148\u89c2\u5bdf$a_3 = a_1 - 2(a_2 - d)$\uff0c$a_2$\u524d\u9762\u662f\u8d1f\u53f7\uff0c\u663e\u7136$a_2$\u8d8a\u5927\uff0c$a_3$\u8d8a\u5c0f\u3002\n\n\u540c\u7406$a_3$\u8d8a\u5927\uff0c$a_4$\u8d8a\u5c0f\u3002\u6240\u4ee5$a_2$\u8d8a\u5927\uff0c$a_4$\u8d8a\u5927\u3002\n\n\u7ed3\u8bba\u5c31\u5f88~~\u663e\u7136~~\u4e86\uff0c$a_2$\u8d8a\u5927\u5947\u6570\u9879\uff08\u4e0d\u8981\u7ba1$a_1$\uff09\u8d8a\u5c0f\uff0c\u5076\u6570\u9879\uff08\u4e0d\u8981\u7ba1$a_0$\uff09\u8d8a\u5927\u3002\n\n\u7136\u540e\u5462\uff1f\n\n\u6211\u4eec**\u4e8c\u5206**$a_2$\uff0c\u56e0\u4e3a\u4e0a\u9762\u5df2\u7ecf\u8bf4\u660e\u4e86\u6bcf\u4e00\u9879\u4e0e$a_2$\u7684\u5927\u5c0f\u5173\u7cfb\uff0c\u5c31\u6709\u4e86**\u5355\u8c03\u6027**\uff0c\u7528$a_2$\u7684\u503c\u9012\u63a8\u51fa$a_n$\uff0c\u7136\u540e**\u5224\u65ad**\u3002\n\n\u8d34\u4ee3\u7801\uff1a\uff08\u65f6\u95f4\u590d\u6742\u5ea6$O(n log n)$\uff09\n```cpp\n#include <cstdio>\nconst double eps = 1e-12; //\u6211<del>\u4e0d</del>\u611f\u89c9\u8fd9\u9898\u5361\u7cbe\u5ea6\u554a\ndouble d, a[100], an; //an\u8868\u793a\u7ed9\u5b9a\u7684a[n]\u7684\u503c\nint n, m; //\u603b\u7684\u9879\u6570\u548c\u8981\u6c42\u7684\u4e00\u9879\n\nbool check(){ //\u5224\u65ad\u662f\u5426a[n] >= an\n\tfor(int i=3; i<=n; i++)\n\t\ta[i] = a[i-2] - 2 * (a[i-1] - d); //\u6839\u636e\u9012\u63a8\u5f0f\u8ba1\u7b97\n\treturn a[n] >= an;\n}\n\nint main(){\n\tscanf(\"%d%d\", &n, &m);\n\tscanf(\"%lf%lf%lf\", &d, &a[1], &an);\n\tdouble l = -1e12, r = 1e12;\n\twhile(r - l > eps){\n\t\ta[2] = (l + r) / 2; //\u4e8c\u5206a[2]\u7684\u503c\n\t\tif(check())\n\t\t\tif(n & 1) l = a[2]; //\u6839\u636en\u7684\u5947\u5076\u6027\u5206\u7c7b\n\t\t\telse      r = a[2]; //\u5076\u6570\u9879\u548ca[2]\u662f\u4e00\u6837\u7684\u5927\u5c0f\u53d8\u5316\u5173\u7cfb\n\t\telse\n\t\t\tif(n & 1) r = a[2]; //\u5947\u6570\u9879\u548ca[2]\u76f8\u53cd\n\t\t\telse      l = a[2];\n\t}\n\tprintf(\"%.3lf\\n\", a[m]);\n\treturn 0;\n}\n```",
        "postTime": 1538568724,
        "uid": 31756,
        "name": "RiverHamster",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P1487 \u3010\u5931\u843d\u7684\u6210\u7ee9\u5355\u3011"
    },
    {
        "content": "\u6211\u5c31\u5f88\u597d\u5947\u4e3a\u4ec0\u4e48\u8fd9\u4e2a\u9898\u6ca1\u4eba\u5957\u9ad8\u65af\u6d88\u5143\u6a21\u677f\uff0c\u8fd9\u9898\u957f\u5f97\u591a\u50cf\u9ad8\u65af\u6d88\u5143\u554aqwq\n\n\n\u79fb\u9879\u53ef\u4ee5\u5f97\u5230a[i]+a[i+1]/2-a[i-1]/2=d\uff0c\u8fd9\u5c82\u4e0d\u5c31\u662f\u9ad8\u65af\u6d88\u5143\u7684\u5f0f\u5b50qwq\n\n\n\u6784\u9020\u51fa\u77e9\u9635\u4e4b\u540e\u76f4\u63a5\u5957\u4e0a\u6a21\u677f\u8dd1\u4e00\u904d\u5c31\u597d\u5566\n\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<cctype>\n#include<algorithm>\n#include<cstdio>\n#include<cmath>\n#define maxn 100\nusing namespace std;\n\ninline long long read(){\n    long long num=0,f=1;\n    char ch=getchar();\n    while(!isdigit(ch)){\n        if(ch=='-')    f=-1;\n        ch=getchar();\n    }\n    while(isdigit(ch)){\n        num=num*10+ch-'0';\n        ch=getchar();\n    }\n    return num*f;\n}\n\ndouble s[maxn][maxn];\ndouble ans[maxn];\nint main(){\n    int n=read(),m=read();\n    double d,a1,an;\n    scanf(\"%lf%lf%lf\",&d,&a1,&an);\n    s[1][1]=1;s[1][n+1]=a1;\n    s[n][n]=1;s[n][n+1]=an;\n    for(int i=2;i<n;++i){\n        s[i][i]=1;\n        s[i][i-1]=-0.5;\n        s[i][i+1]=0.5;\n        s[i][n+1]=d;\n    }\n    for(int i=1;i<=n;++i){\n        int now=i;\n        for(int j=i+1;j<=n;++j)\n            if(fabs(s[j][i])>fabs(s[now][i]))    now=j;\n        if(now!=i)    swap(s[now],s[i]);\n        for(int j=i+1;j<=n;++j){\n            double ret=s[j][i]/s[i][i];\n            for(int k=i;k<=n+1;++k)    s[j][k]-=s[i][k]*ret;\n        }\n    }\n    ans[n]=an;    ans[1]=a1;\n    for(int i=n-1;i>1;--i){\n        double now=0;\n        for(int j=i+1;j<=n;++j)    now+=ans[j]*s[i][j];\n        ans[i]=(s[i][n+1]-now)/s[i][i];\n    }\n    printf(\"%.3lf\",ans[m]);\n    return 0;\n}\n\n```",
        "postTime": 1516534468,
        "uid": 25815,
        "name": "\u5c01\u766b",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1487 \u3010\u5931\u843d\u7684\u6210\u7ee9\u5355\u3011"
    },
    {
        "content": "~~\u9898\u76ee\u96be\u5ea6\u5413\u4eba~~\n\n\u6839\u636e\u9898\u610f\uff1a\n\n$A_i = \\frac{A_{i-1} - A_{i+1}}{2} + d$\n\n\u6240\u4ee5\uff0c\u7ecf\u521d\u7b49\u53d8\u6362\u540e\uff1a\n\n$A_{i+1} = -2 * A_i + A_{i-1} + 2d$\n\n\u8bbe$A_2 = x$\uff1a\n\n$A_1 = 0 * x + a_1$\n\n$A_2 = 1 * x + 0$\n\n$A_3 = -2 * A_2 + A_1 + 2d = -2 * x + (a_1 + 2d)$\n\n$A_4 = -2 * A_3 + A_2 + 2d = 5 * x + (-2 * a_1 - 2d)$\n\n......\n\n$A_{i+1} = -2 * A_i + A_{i-1} + 2d$\n\n......\n\n$A_n = -2 * A_{n-1} + A_{n-2} + 2d$\n\n\u53ea\u9700\u8981\u8bb0\u5f55$A_i$\u7684$x$\u7cfb\u6570\u548c\u5e38\u6570\u9879\uff0c\u6211\u4eec\u4f1a\u5f97\u5230\u4e00\u4e2a**\u4e00\u5143\u4e00\u6b21\u65b9\u7a0b**\uff1a\n\n$A_n = coefficient_n * x + constant_n$\n\n\u5373\uff1a\n\n$x = A_2 = \\frac{a_n - constant_n}{coefficient_n}$\n\n\u518d\u63a8\u4e00\u904d\u6216\u76f4\u63a5\u56de\u4ee3\u53ef\u5f97\u5230\u6240\u6709\u503c\u3002\n\n\u65f6\u7a7a\u590d\u6742\u5ea6\uff1a$O(n)$\n\n~~\u9ad8\u65af\u6d88\u5143\uff1f\u7279\u5f81\u65b9\u7a0b\uff1flong double\uff1f\u7edf\u7edf\u4e0d\u9700\u8981\uff01~~\n\n\u4ee3\u7801\uff1a\n```c\n#include<stdio.h>\nint main(){\n\tint n,m;double a[66],d,lin[66],cst[66],x;\n\t//lin as linear, cst as constant\n\tscanf(\"%d%d\",&n,&m);\n\tscanf(\"%lf%lf%lf\",&d,&a[1],&a[n]);\n\tlin[1]=0;cst[1]=a[1];\n\tlin[2]=1;cst[2]=0;\n\tfor(int i=3;i<=n;++i){\n\t\tlin[i]=-2*lin[i-1]+lin[i-2];\n\t\tcst[i]=-2*cst[i-1]+cst[i-2]+2*d;\n\t}\n\tx=(a[n]-cst[n])/lin[n];\n\tfor(int i=2;i< n;++i){\n\t\ta[i]=lin[i]*x+cst[i];\n\t}\n\tprintf(\"%.3lf\\n\",a[m]);\n}\n```",
        "postTime": 1619674846,
        "uid": 56489,
        "name": "\u4e00\u53ea\u5c0f\u5154\u5b50",
        "ccfLevel": 0,
        "title": "P1487 \u5931\u843d\u7684\u6210\u7ee9\u5355 \u9898\u89e3"
    },
    {
        "content": "**\u8fd9\u91cc\u4ecb\u7ecd\u8ddf\u5927\u5bb6\u4e0d\u4e00\u6837\u7684\u65b9\u6cd5\uff1a\u4e8c\u5206\u3002**\n\n\u9898\u76ee\u7ed9\u51fa\u4e86\u7b2c $1$ \u9879,\u7b2c $N$ \u9879, $d$ ,\u4ee5\u53ca\u9012\u63a8\u516c\u5f0f $A_i=\\dfrac {A_{i-1}-A_{i+1}}  2+d$,\n\n\u628a\u5730\u63a8\u516c\u5f0f\u53d8\u5f62\u5f97\uff1a\n\n$A_{i+1}=A_{i-1}-(A_i-d)\\times 2$\n\n$=A_{i-1}-2\\times A_i+2\\times d$\n\n\u8fd9\u662f\u4e00\u4e2a\u76f8\u90bb 3 \u9879\u7684\u9012\u63a8\u5f0f\u3002\n\n\u9898\u76ee\u7ed9\u51fa\u4e86\u7b2c\u4e00\u9879\uff0c\u5982\u679c\u6211\u4eec\u77e5\u9053\u7b2c\u4e8c\u9879\uff0c\u5c31\u53ef\u4ee5\u6839\u636e\u9012\u63a8\u5f0f\u8ba1\u7b97\u51fa\u540e\u7eed\u6bcf\u4e00\u9879\u7684\u503c\u3002\n\n\u4f46\u6211\u4eec\u5e76\u4e0d\u77e5\u9053\u7b2c\u4e8c\u9879\u7684\u503c\uff0c\u600e\u4e48\u529e\u5462\uff1f\n\n\u6211\u4eec\u7528\u5982\u4e0b\u7684\u7a0b\u5e8f\u53bb\u89c2\u5bdf\u8fd9\u4e2a\u6570\u5217\u7684\u89c4\u5f8b\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint a[1005];\nint n,d;\nint main(){\n\tcin>>n>>d>>a[1];\n\tdo{\n\t\tcin>>a[2];\n\t\tif(a[2]==0){\n\t\t\tbreak;\n\t\t}\n\t\tcout<<a[1]<<' '<<a[2]<<' ';\n\t\tfor(int i=3;i<=n;i++){\n\t\t\ta[i]=a[i-2]+2*d-2*a[i-1];\n\t\t\tcout<<a[i]<<' ';\n\t\t}\n\t\tcout<<endl;\n\t}while(1);\n}\n```\n### \u53d1\u73b0\u7684\u89c4\u5f8b\n![](https://cdn.luogu.com.cn/upload/image_hosting/ls9efuph.png?x-oss-process=image/resize,m_lfit,h_1170,w_2225)\n\n\u8fd9\u662f\u4e00\u4e2a\u5143\u7d20\u7684\u503c\u4e00\u6b63\u4e00\u8d1f\u7684\u6447\u6446\u6570\u5217\u3002\u4f46\u660e\u663e\u7684\uff0c\u6570\u5217\u5143\u7d20\u7684\u7edd\u5bf9\u503c\u8d8a\u6765\u8d8a\u5927\u3002\u8fd9\u5c31\u4e3a\u4e8c\u5206\u521b\u9020\u4e86\u6761\u4ef6\u3002\n\n\u89c2\u5bdf\u4e0a\u9762\u7684\u5f0f\u5b50\u3002\u5bf9\u4e8e $d=1$ , $a[1]=1$ ,\u5f53 $a[2]$ \u7684\u7edd\u5bf9\u503c\u8d8a\u5927\uff0c\u751f\u6210\u7684\u5e8f\u5217\u4e5f\u8d8a\u5927\u3002\n\n### \u6447\u6446\u5e8f\u5217\n\u5bf9\u4e8e\u6447\u6446\u5e8f\u5217\uff0c\u5728\u8ba1\u7b97\u51fa\u7b2c $n$ \u9879\u4e0e\u7ed9\u51fa\u7684\u7b2c $n$ \u9879\u7684\u503c\u7684\u5927\u5c0f\u6bd4\u8f83\u65f6\uff0c\u8981\u53bb\u522b\u662f\u6b63\u6570\u6bd4\u5927\u5c0f\u8fd8\u662f\u8d1f\u6570\u6bd4\u5927\u5c0f\u3002\n\n\u8fd9\u65f6\uff0c\u6570\u5217\u7684\u9879\u6570\u5c31\u51b3\u5b9a\u4e86\u7b2c $n$ \u9879\u662f\u6b63\u662f\u8d1f\u3002\n\n\u5982\u679c\u4e3a\u6b63\u6570\uff0c\u8ba1\u7b97\u51fa\u6765\u7684\u7b2c $n$ \u9879\u5927\u4e86\uff0c\u8bf4\u660e\u5e94\u8be5\u51cf\u5c0f $a[2]$ \u7684\u503c\u3002\n\n\u5982\u679c\u662f\u8d1f\u6570\uff0c\u8ba1\u7b97\u51fa\u6765\u7684\u503c\u7684\u7b2c $n$ \u9879\u5927\u4e86\uff0c\u8bf4\u660e\u5e94\u8be5\u589e\u5927 $a[2]$.\n\n### \u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h> \nusing namespace std;\ndouble a[105],d,an;\ndouble EPS=1e-11;\nint n,m;\nbool check(){\n\tfor(int i=3;i<=n;i++){\n\t\ta[i]=a[i-2]-2*(a[i-1]-d);\n\t}\n\tif(a[n]>an){\n\t\treturn 1;\n\t}\n\treturn 0;\n}\nint main(){\n\tcin>>n>>m;\n\tcin>>d>>a[1]>>an;\n\tdouble lo=-1e11;\n\tdouble ri=1e11;\n\twhile(ri-lo>EPS){\n\t\ta[2]=(ri+lo)/2;\n\t\tif(check()==1){\n\t\t\tif(n%2==1){\n\t\t\t\tlo=a[2];\n\t\t\t}\n\t\t\telse{\n\t\t\t\tri=a[2];\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tif(n%2==1){\n\t\t\t\tri=a[2];\n\t\t\t}\n\t\t\telse{\n\t\t\t\tlo=a[2];\n\t\t\t}\n\t\t}\n\t}\n\tcout<<fixed<<setprecision(3)<<a[m]<<endl;\n}\n```",
        "postTime": 1622462189,
        "uid": 411727,
        "name": "stOtue",
        "ccfLevel": 0,
        "title": "P1487 \u5931\u843d\u7684\u6210\u7ee9\u5355"
    },
    {
        "content": "qwq\u6ca1\u4eba\u5199\u4e00\u4e2a\u89e3\u9012\u63a8\u65b9\u7a0b\u7684\u9898\u89e3\u4e48\n\n\u6211\u4eec\u628a\n\n![](http://latex.codecogs.com/gif.latex?r%5E%7Bk%7D-c_%7B1%7Dr%5E%7Bk-1%7D-c_%7B2%7Dr%5E%7Bk-2%7D-...-c_%7Bk-1%7Dr-c_%7Bk%7D),\u5176\u4e2dci\u4e3a\u5e38\u6570\n\n\u53eb\u505a**\u5e38\u7cfb\u6570k\u9636\u7ebf\u6027\u9f50\u6b21\u9012\u63a8\u5173\u7cfb**\n\n![](http://latex.codecogs.com/gif.latex?a_%7Bn%7D%3Dc_%7B1%7Da_%7Bn-1%7D&plus;c_%7B2%7Da_%7Bn-2%7D&plus;...&plus;c_%7Bk%7Dr_%7Bn-k%7D)\n\n\u7684**\u7279\u5f81\u65b9\u7a0b**\n\n\u4e24\u4e2a\u5b9a\u7406\uff08~~\u5efa\u8bae\u8df3\u8fc7\u56e0\u4e3a~~\u5f88\u590d\u6742\uff09:\n\n\u5b9a\u74061:\u82e5\u4e0a\u8ff0\u9012\u63a8\u5f0f\u7684\u7279\u5f81\u65b9\u7a0b\u6709t\u4e2a\u4e92\u4e0d\u76f8\u7b49\u7684\u6839![](http://latex.codecogs.com/gif.latex?r_%7B1%7D%2Cr_%7B2%7D%2C...r_%7Bt%7D%2C)\u5176\u91cd\u6570(\u5373\u8be5\u6839\u7684\u51fa\u73b0\u6b21\u6570\uff0c\u6bd4\u5982![](http://latex.codecogs.com/gif.latex?%28a-1%29%5E2%3D0)\u6709a=1\u7684\u4e8c\u91cd\u6839)\u5206\u522b\u4e3am1,m2...mt,\u6ee1\u8db3mi>=1,![](http://latex.codecogs.com/gif.latex?%5Csum_%7Bi%3D1%7D%5E%7Bt%7Dm_i%3Dk),\u90a3\n\n\u4e48\u5176\u89e3\u4e3a\n\n\u5176\u4e2d![](http://latex.codecogs.com/gif.latex?%5Calpha%20_%7Bij%7D)\u53ef\u4ee5\u7531\u521d\u59cb\u6761\u4ef6\u89e3\u4e00\u6b21\u65b9\u7a0b\u7ec4\u5f97\u5230\n\n![](http://latex.codecogs.com/gif.latex?a_n%3D%5Csum_%7Bi%3D1%7D%5E%7Bt%7Dr_%7Bi%7D%5E%7Bn%7D%5Csum_%7Bj%3D0%7D%5E%7Bm_%7Bi%7D-1%7D%5Calpha_%7Bij%7Dn%5E%7Bj%7D)\n\n\u6211\u4eec\u628a\n\n![](http://latex.codecogs.com/gif.latex?a_%7Bn%7D%3DF%28n%29&plus;%5Csum_%7Bi%3D1%7D%5E%7Bk%7Dc_%7Bi%7Da_%7Bn-i%7D)\u53eb\u505a**\u5e38\u7cfb\u6570\u7ebf\u6027\u975e\u9f50\u6b21\u9012\u63a8\u5173\u7cfb**\uff0cF(n)\u662f\u5173\u4e8en\u7684\u975e0\u51fd\u6570\n\n\u8fd9\u65f6\u9012\u63a8\u5173\u7cfb![](http://latex.codecogs.com/gif.latex?a_%7Bn%7D%3D%5Csum_%7Bi%3D1%7D%5E%7Bk%7Dc_%7Bi%7Da_%7Bn-i%7D)\u53eb\u505a**\u76f8\u4f34\u7684\u9f50\u6b21\u9012\u63a8\u5173\u7cfb**\n\n\u5b9a\u74062:\u4e00\u4e2a\u5e38\u7cfb\u6570\u7ebf\u6027\u975e\u9f50\u6b21\u9012\u63a8\u5173\u7cfb\u7684\u89e3\u662f\u4e00\u4e2a\u7279\u89e3\u548c\u76f8\u4f34\u7684\u7ebf\u6027\u9f50\u6b21\u9012\u63a8\u5173\n\n\u7cfb\u7684\u4e00\u4e2a\u89e3\u7684\u548c\uff0c\u5373\n\n\u5982\u679c![](http://latex.codecogs.com/gif.latex?%5Cleft%20%5C%7B%20a_%7Bn%7D%5E%7B%28p%29%7D%20%5Cright%20%5C%7D)\u662f\u4e0a\u8ff0\u9012\u63a8\u5173\u7cfb\u7684\u4e00\u4e2a\u7279\u89e3\uff0c\u90a3\u4e48\u6bcf\u4e2a\u89e3\u90fd\u662f![](http://latex.codecogs.com/gif.latex?%5Cleft%20%5C%7B%20a_%7Bn%7D%5E%7B%28p%29%7D&plus;a_%7Bn%7D%5E%7B%28h%29%7D%20%5Cright%20%5C%7D)\u7684\u5f62\u5f0f\uff0c\u5176\u4e2d\n\n![](http://latex.codecogs.com/gif.latex?%5Cleft%20%5C%7B%20a_%7Bn%7D%5E%7B%28h%29%7D%20%5Cright%20%5C%7D)\u662f\u5176\u76f8\u4f34\u7684\u9f50\u6b21\u9012\u63a8\u5173\u7cfb\u7684\u4e00\u4e2a\u89e3\n\n\u5047\u8bbe![](http://latex.codecogs.com/gif.latex?%7B%5Cleft%20%5C%7B%20a_%7Bn%7D%7D%20%5Cright%20%5C%7D)\u6ee1\u8db3\u4e0a\u8ff0\u7ebf\u6027\u975e\u9f50\u6b21\u9012\u63a8\u5173\u7cfb\uff0c\u4e14![](http://latex.codecogs.com/gif.latex?F%28n%29%3Ds%5E%7Bn%7D%5Csum_%7Bi%3D0%7D%5E%7Bt%7Db_%7Bi%7Dn%5E%7Bi%7D),\u5176\u4e2dbi\u548cs\u662f\u5e38\u6570.\u5f53\n\ns\u4e0d\u662f\u76f8\u4f34\u7684\u9012\u63a8\u5173\u7cfb\u7684\u7279\u5f81\u65b9\u7a0b\u7684\u6839\u65f6\uff0c\u5b58\u5728\u4e00\u4e2a\u5f62\u5982![](http://latex.codecogs.com/gif.latex?s%5E%7Bn%7D%5Csum_%7Bi%3D0%7D%5E%7Bt%7Dp_%7Bi%7Dn%5E%7Bi%7D)\u7684\u7279\u89e3\n\n\u53cd\u4e4b\uff0c\u5219\u5b58\u5728\u4e00\u4e2a\u5f62\u5982![](http://latex.codecogs.com/gif.latex?n%5E%7Bm%7Ds%5E%7Bn%7D%5Csum_%7Bi%3D0%7D%5E%7Bt%7Dp_%7Bi%7Dn%5E%7Bi%7D)\n\u7684\u7279\u89e3,\u5176\u4e2dm\u662fs\u7684\u91cd\u6570\uff0c\u8fd9\u53ef\u4ee5\u4fdd\u8bc1\u8be5\u7279\u89e3\u4e0d\n\n\u662f\u76f8\u4f34\u9012\u63a8\u5173\u7cfb\u7684\u4e00\u4e2a\u89e3.\n\n\u63a5\u4e0b\u6765\u5229\u7528\u8fd9\u4e24\u4e2a\u5b9a\u7406A\u6389\u8fd9\u4e2a\u9898\n\n\u9996\u5148\u7531\u9898\u8bbe\u53ef\u4ee5\u5f97\u5230Ai\u7684\u9012\u63a8\u5173\u7cfb\n\n![](http://latex.codecogs.com/gif.latex?A_%7Bi%7D%3D%5Cfrac%7BA_%7Bi-1%7D-A_%7Bi&plus;1%7D%7D%7B2%7D&plus;d%20%5C%5C%5C%5C2A_%7Bi%7D%3DA_%7Bi-1%7D-A_%7Bi&plus;1%7D&plus;2d%20%5C%5C%5C%5CA_%7Bi&plus;1%7D%3DA_%7Bi-1%7D-2A_%7Bi%7D&plus;2d%20%5C%5C%5C%5CA_%7Bi%7D%3DA_%7Bi-2%7D-2A_%7Bi-1%7D&plus;2d)\n\n\n\u4e8e\u662f\u53ef\u4ee5\u5e94\u7528\u4e24\u4e2a\u5b9a\u7406\u6c42\u89e3\n\n\u7531\u5b9a\u74061\u6709![](http://latex.codecogs.com/gif.latex?r%5E%7B2%7D&plus;2r-1%3D0%20%5C%5C%5C%5Cr_%7B1%7D%3D-1&plus;%20%5Csqrt%7B2%7D%2Cr_%7B2%7D%3D-1-%5Csqrt%7B2%7D)\n\n\u4ece\u800c![](http://latex.codecogs.com/gif.latex?%5Cleft%5C%7Ba_%7Bn%7D%5E%7B%28h%29%7D%20%5Cright%5C%7D%3D%5Calpha%20r_%7B1%7D%5E%7Bn%7D%20&plus;%5Cbeta%20r_%7B2%7D%5E%7Bn%7D%3D%5Calpha%20%28-1&plus;%5Csqrt%7B2%7D%29%5E%7Bn%7D%20&plus;%5Cbeta%20%28-1-%5Csqrt%7B2%7D%29%5E%7Bn%7D)\n\n\u6211\u4eec\u53ef\u4ee5\u89e3\u51fa\u6765\n\n![](http://latex.codecogs.com/gif.latex?s_%7B1%7D%3D-1-%5Csqrt%7B2%7D%20%5C%5C%5C%5Cs_%7B2%7D%3D-1&plus;%5Csqrt%7B2%7D%20%5C%5C%5C%5C%5Calpha%20%3D%5Cfrac%7BA_%7Bn%7D-d-s_%7B2%7D%5E%7Bn-1%7D%28A_%7B1%7D-d%29%7D%7Bs_%7B1%7D%5E%7Bn%7D&plus;s_%7B2%7D%5E%7Bn-2%7D%7D%20%5C%5C%5C%5C%5C%5C%5Cbeta%3D%5Cfrac%7BA_%7B1%7D-d-s_%7B1%7D%5Calpha%20%7D%7Bs_%7B2%7D%7D)\n\n\u7279\u89e3\u663e\u7136\u5c31\u662fd\n\n\u4e8e\u662f\u8fd9\u4e2a\u901a\u89e3\u4e0d\u96be\u5f97\u5230\uff0c\u56e0\u4e3a\u5f88\u957f\uff0c\u5177\u4f53\u770b\u4ee3\u7801\n\n\u6211\u4eec\u53ef\u4ee5\u6309\u7167l\u6bd2\u7624xl\u8bb2\u5206\u5757\u90a3\u6837\u7c7b\u6bd4\u4e00\u4e0b\n\n\u5982\u679c\u6211\u4e0d\u6c42\u901a\u89e3\u76f4\u63a5\u628a\u6240\u6709\u7684f(i)\u5217\u6210\u65b9\u7a0b\u7ec4\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230O(n^3)\u7684\u9ad8\u65af\u6d88\u5143\n\n\u5982\u679c\u76f4\u63a5\u6309\u7167\u9012\u63a8\u5f0f\u6c42\u89e3\uff0c\u662fO(n)\u7684,\u53ef\u4ee5\u77e9\u9635\u52a0\u901f\u5230O(27logn)\n\n\u5982\u679c\u6c42\u901a\u89e3~~(\u7136\u800c\u7279\u522b\u8d39\u52b2)~~\u662fO(logn)\u7684(\u5feb\u901f\u5e42)\uff0c\u53ef\u4ee5\u6253\u8868\u5230O(1),\u662f\u6700\u4f18\u7684\n\n\u4f46\u901a\u5e38\u60c5\u51b5\u4e0b\u5982\u679cr\u7b97\u51fa\u6765\u662f\u5b9e\u6570\u90a3\u4e48\u6700\u597d\u77e9\u9635\u52a0\u901f\u505a\uff0c\u56e0\u4e3a\u6709\u6d6e\u70b9\u8bef\u5dee\u800c\u4e14\u4e0d\u80fd%\n\n\u8fd9\u4e2a\u9898\u7684\u5751\u70b9\uff0c\u540e5\u4e2a\u6570\u636e\u7684m\u5168\u90fd\u662f0,\u5269\u4e0b\u7684\u6570\u636e\u6781\u6c34\n\n\u4e3a\u4e86\u7f29\u4ee3\u7801\uff0c\u7528\u4e86\u81ea\u5e26pow\u800c\u4e0d\u662f\u5feb\u901f\u5e42\n\n```cpp\n#include<cstdio>\n#include<cmath>\nconst double o1=sqrt(2)-1,o2=-sqrt(2)-1;\nint main()\n{\n\tdouble r1,r2,d,a1,an,alpha;\n\tint n,m;\n\tscanf(\"%d%d\",&n,&m);\n\tscanf(\"%lf%lf%lf\",&d,&a1,&an);\n\tif(!m)\n\t{\n\t\tprintf(\"0.000\");\n\t\treturn 0;\n\t}\n\tr1=pow(o1,n),r2=pow(o2,n-2);\n\talpha=(an-d-r2*o2*(a1-d))/(r1+r2);\n\tprintf(\"%.3lf\",alpha*pow(o1,m)+(a1-d-o1*alpha)*pow(o2,m-1)+d);\n}```",
        "postTime": 1519474883,
        "uid": 22136,
        "name": "qwaszx",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P1487 \u3010\u5931\u843d\u7684\u6210\u7ee9\u5355\u3011"
    },
    {
        "content": "\u6211\u4eec\u5982\u679c\u5f97\u51faa[2]\u7684\u503c\uff0c\u90a3\u4e48\u6211\u4eec\u4fbf\u53ef\u4ee5\u6c42\u51faa[m]\u7684\u503c\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u4ee4a[2]=y,a[n-1]=x,\u53ef\u4ee5\u7528\u542bx\u8868\u8fbe\u5f0f\u8868\u8fbey\u7684\u503c\uff0c\u7528\u542by\u7684\u8868\u8fbe\u5f0f\u8868\u793ax\uff0c\u5219\u5c06\u6b64\u9898\u8f6c\u5316\u4e3a\u4e00\u4e2a\u89e3\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\u7ec4\u7684\u9898\u3002\n\n\u4eae\u4ee3\u7801\uff1a\n\t\n    #include <cstdio>\n  \n\tdouble a[65][3],b[65][3],c[65],d,fir,las;\n  \n\tint j,k;\n  \n\tint main() {\n  \n\t\tscanf(\"%d %d\",&j,&k);\n\t\tscanf(\"%lf %lf %lf\",&d,&fir,&las);\n\t\ta[j][0] = 1;\n\t\ta[j-1][1] = 1;\n  \n\t\tfor(int i=j-2;i>=2;--i) {\n\t\t\ta[i][0] = a[i+2][0]+a[i+1][0]*2;//\u4ee5a[i][0]\u8868\u793aa[n]\u7684\u7cfb\u6570\n\t\t\ta[i][1] = a[i+2][1]+a[i+1][1]*2;//\u4ee5a[i][1]\u8868\u793ax\u7684\u7cfb\u6570\n\t\t\ta[i][2] = a[i+2][2]+a[i+1][2]*2-2;//\u4ee5a[i][2]\u8868\u793ad\u7684\u7cfb\u6570\n\t\t}\n\t\tdouble n = a[2][1],l1 = a[2][0]*las+a[2][2]*d;//\u5408\u6210\u5e38\u6570\u9879\n\t\tb[1][0]=1;\n\t\tb[2][1]=1;\n \n\t\tfor(int i=3;i<=j-1;++i) {\n\t\t\tb[i][0] = b[i-2][0]-b[i-1][0]*2;\n\t\t\tb[i][1] = b[i-2][1]-b[i-1][1]*2;\n\t\t\tb[i][2] = b[i-2][2]-b[i-1][2]*2+2;\n\t\t}\n\t\tdouble m = b[j-1][1],l2 = b[j-1][0]*fir+b[j-1][2]*d;//\u4ee5\u4e0a\u7c7b\u4e0a\n\t\tdouble sec = (-n*l2-l1)/(n*m-1);//\u8ba1\u7b97\u51faa[2]\u7684\u503c\n\t\tc[1] = fir,c[2] = sec;\n\t\tfor(int i=3;i<=k;++i) {\n\t\t\tc[i] = c[i-2]-2*c[i-1]+2*d;\n\t\t}//\u5957\u7528\u9012\u63a8\u5f0f\n\t\tprintf(\"%.3lf\",c[k]);\n\t\treturn 0;\n\t}\n",
        "postTime": 1552887869,
        "uid": 171554,
        "name": "Reanap",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P1487 \u3010\u5931\u843d\u7684\u6210\u7ee9\u5355\u3011"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u4e2a\u66f4\u597d\u7406\u89e3\u7684\u9898\u89e3\uff1a\n\n**\u77e9\u9635\u5feb\u901f\u5e42**\n\n\u7531\u9898\u8868\u8fbe\u5f0f\u53ef\u4ee5\u5316\u4e3a\u8fd9\u6837\u4e00\u4e2a\u9012\u63a8\u8868\u8fbe\u5f0f\uff1a\n\na[n+1]=a[n-1]-2\\*a[n]+2d\n\n\u4e8e\u662f\u4e4e\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u8fd9\u6837\u4e00\u4e2a\u77e9\u9635\u8868\u8fbe\u5f0f\uff1a\n\n ![](https://cdn.luogu.com.cn/upload/pic/7892.png) \n\n\u6211\u4eec\u8bbe\u8fd9\u4e09\u4e2a\u77e9\u9635\u5206\u522b\u4e3aFn,A,Fn-1\n\n\u90a3\u4e48\u5bf9\u4e8e\u4efb\u610fn>1,\u90fd\u6709Fn=A^(n-2)\\*F2\n\n\u800cF2\u5305\u542ba2,a1,d\uff0c\u8fd8\u6709a2\u672a\u77e5\uff0c\u6211\u4eec\u5c31\u7528FN=A^(N-2)\\*F2\u6784\u9020\u51fa\u4e00\u4e2a\u5173\u4e8ea2\u7684\u65b9\u7a0b\uff0c\u5c31\u53ef\u4ee5\u89e3\u51faa2\u4e86\n\n\n\u6ce8\u610f\uff1a\u9898\u76ee\u4e2d\u4e00\u534a\u7684\u6570\u636e\u90fd\u6709N=0\u6216M=0\uff0c\u8fd9\u4e2a\u65f6\u5019\u9700\u8981\u8f93\u51fa0.000     = =\u3010\u592a\u5751\u4e86\u5427\u3011\n\n\n\n\n\n\n\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define LL long long int\nusing namespace std;\nconst int maxn=5,INF=2000000000,P=1000000007;\nstruct Matrix{\n    double s[maxn][maxn];\n    int n,m;\n    Matrix() {fill(s[0],s[0]+maxn*maxn,0);n=m=0;}\n}A,F;\ninline Matrix operator *(const Matrix& a,const Matrix& b){\n    Matrix c;\n    if(a.m!=b.n) return c;\n    c.n=a.n;c.m=b.m;\n    for(int i=1;i<=c.n;i++)\n        for(int j=1;j<=c.m;j++)\n            for(int k=1;k<=a.m;k++)\n                c.s[i][j]+=a.s[i][k]*b.s[k][j];\n    return c;\n}\ninline Matrix qpow(Matrix a,int b){\n    Matrix ans;ans.n=ans.m=a.n;\n    for(int i=1;i<=ans.n;i++) ans.s[i][i]=1;\n    for(;b;b>>=1,a=a*a) if(b&1) ans=ans*a;\n    return ans;\n}\nint N,M,AA[9]={-2,1,2,1,0,0,0,0,1};\ndouble a1,an,d,a2;\nvoid init(){\n    A.n=A.m=3;\n    for(int i=0;i<3;i++)\n        for(int j=0;j<3;j++)\n            A.s[i+1][j+1]=AA[i*3+j];\n    cin>>N>>M>>d>>a1>>an;\n    if(N==1||M==1) {printf(\"%.3lf\\n\",a1);exit(0);}\n    else if(N==0||M==0) {printf(\"%.3lf\\n\",0.000);exit(0);}\n    else{\n        Matrix An=qpow(A,N-2);\n        a2=(an-An.s[1][2]*a1-An.s[1][3]*d)/An.s[1][1];\n    }\n    F.n=3;F.m=1;\n    F.s[1][1]=a2;F.s[2][1]=a1;F.s[3][1]=d;\n}\nvoid solve(){\n    Matrix Fn=qpow(A,M-2)*F;\n    printf(\"%.3lf\\n\",Fn.s[1][1]);\n}\nint main(){\n    init();\n    solve();\n    return 0;\n}\n\n```",
        "postTime": 1505024586,
        "uid": 32842,
        "name": "Mychael",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P1487 \u3010\u5931\u843d\u7684\u6210\u7ee9\u5355\u3011"
    },
    {
        "content": "# Description\n\n[P1487 \u5931\u843d\u7684\u6210\u7ee9\u5355](https://www.luogu.com.cn/problem/P1487)\n\n\u5bf9\u4e8e\u4e00\u4e2a\u6ee1\u8db3\uff1a\n$$A_{i}=\\dfrac{A_{i-1}-A_{i+1}}{2} + d$$\n\u7684\u6570\u5217 $a$\uff0c\u7ed9\u51fa\u9996\u9879 $A_{1}$\uff0c\u672b\u9879 $A_{n}$\uff0c\u4ee5\u53ca\u5e38\u6570\u9879 $d$\u3002\u8bf7\u6c42\u51fa $A_{m}$ \u7684\u503c\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\le n\\le 60$\uff0c$0\\le m\\le n$\uff0c$|d|,|A_1|,|A_n|<10^4$\u3002\n \n# Analysis\n\u7531\uff1a\n$$A_{i}=\\dfrac{A_{i-1}-A_{i+1}}{2} + d$$\n\u5f97\uff1a\n$$2A_{i}=A_{i-1}-A_{i+1}+2d$$\n\u79fb\u9879\u540e\uff1a\n$$A_{i+1}=A_{i-1}-2A_{i}+2d$$ \n\u4ee4 $i=i-1$\uff0c\u5f97\uff1a\n$$A_{i}=A_{i-2}-2A_{i-1}+2d$$\n\u56e0\u4e3a\uff1a\n$$A_{3}=A_{1}-2A_{2}+2d$$\n$$A_{4}=A_{2}-2A_{3}+2d$$\n\u5f97\uff1a\n$$\n\\begin{aligned}\nA_{4}&=A_{2}-2(A_{1}-2A_{2}+2d)+2d\\\\\nA_{4}&=A_{2}-2A_{1}+4A_{2}-4d+2d\\\\\nA_{4}&=-2A_{1}+5A_{2}-2d\n\\end{aligned}\n$$\n\u5219\u53ef\u4ee5\u6839\u636e\u4e0a\u5f0f\u9012\u63a8\u5f97\u6b64\u5f0f\uff1a\n$$A_{n}=\\color{red}x\\color{black}A_{1}+\\color{red}y\\color{black}A_{2}+\\color{red}z\\color{black}d$$\n\u4e2d\u7684 $\\color{red}x\\color{black},\\color{red}y\\color{black},\\color{red}z$\uff0c\u5e76\u63a8\u51fa\uff1a\n$$A_{2}=\\dfrac{A_{n}-\\color{red}x\\color{black}A_{1}-\\color{red}z\\color{black}d}{\\color{red}y}$$\n# CODE\n```cpp\n#include<stdio.h>\nstruct test\n{\n    int x, y, z;\n} score[61];\nint main()\n{\n    double a[61], d;\n    int n, m;\n    scanf(\"%d %d\", &n, &m);\n    scanf(\"%lf %lf %lf\", &d, &a[1], &a[n]);\n    score[3].x = 1, score[3].y = -2, score[3].z = 2;\n    score[4].x = -2, score[4].y = 5, score[4].z = -2;\n    for(int i = 5; i <= n; i++)\n    {\n        score[i].x = score[i-2].x - 2 * score[i-1].x;\n        score[i].y = score[i-2].y - 2 * score[i-1].y;\n        score[i].z = score[i-2].z - 2 * score[i-1].z + 2;\n    }\n    a[2] = (a[n] - score[n].x * a[1] - score[n].z * d) / score[n].y;\n    for(int i = 3; i <= m; i++)\n    {\n        a[i] = a[i-2] - 2 * a[i-1] + 2 * d;\n    }\n    printf(\"%.3f\",a[m]);\n    return 0;\n}\n```",
        "postTime": 1669531513,
        "uid": 897776,
        "name": "Infinite_Eternity",
        "ccfLevel": 0,
        "title": "P1487 \u5931\u843d\u7684\u6210\u7ee9\u5355"
    },
    {
        "content": "## $\\text{Solution}$\n\n\u6c42\n\n$$ A_i=\\dfrac{A_{i-1}-A_{i+1}}{2}+d$$\n\n\u5373\n\n$$2A_i-A_{i-1}+A_{i+1}=2d$$\n\n\u9ad8\u65af-\u7ea6\u65e6\u6d88\u5143\u5373\u53ef\u3002\n\n\u4f46\u662f $A_1,A_n$ \u662f\u5e38\u6570\u4e86\uff0c\u8be5\u600e\u4e48\u529e\uff1f\n\n\u7c7b\u6bd4\u5230 $n=5$\uff0c\u5219\n\n$$ 2A_2+A_3=2d+A_1$$\n\n$$ 2A_3-A_2+A_4=2d$$\n\n$$ 2A_4-A_3=2d-A_5$$\n\n\u5df2\u6709\n\n$$A_1=a,A_5=b$$\n\n\u90a3\u4e48\u5f97 $n-2$ \u4e2a\u5143\uff0c $n-2$ \u4e2a\u65b9\u7a0b\u3002\n\n## $\\text{Code}$\n\n```cpp\n#include <bits/stdc++.h>\n\n#define N 65\n#define db double\n\nusing namespace std;\n\ndb d,a,b,A[N][N];\nint n,m,rn;\n\ndb fabs(db x) {\n\treturn x>0?x:-x; \n}\n\nint main() {\n\tmemset(A,0.0,sizeof(A));\n\tscanf(\"%d%d%lf%lf%lf\",&n,&m,&d,&a,&b);\n\trn=n-2;\n\tA[1][1]=2.0; A[1][2]=1.0; A[1][rn+1]=2.0*d+a;\n\tA[rn][rn]=2.0; A[rn][rn-1]=-1.0; A[rn][rn+1]=2.0*d-b;\n\tfor(int i=2;i<rn;i++) {\n\t\tA[i][i]=2.0; A[i][i-1]=-1.0; A[i][i+1]=1.0; A[i][rn+1]=2.0*d;\n\t}\n\tfor(int i=1;i<=rn;i++) {\n\t\tint mx=i;\n\t\tfor(int j=i+1;j<=rn;j++) {\n\t\t\tif(fabs(A[j][i])>fabs(A[mx][i])) mx=j;\n\t\t}\n\t//\tcout<<mx<<endl;\n\t\tfor(int j=1;j<=rn+1;j++) swap(A[mx][j],A[i][j]);\n\t\tfor(int j=1;j<=n;j++) {\n\t\t\tif(j^i) {\n\t\t\t\tdb tmp=A[j][i]/A[i][i];\n\t\t\t//\tcout<<tmp<<endl;\n\t\t\t\tfor(int k=i+1;k<=rn+1;k++) {\n\t\t\t\t\tA[j][k]-=tmp*A[i][k];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%.3lf\\n\",A[m-1][rn+1]/A[m-1][m-1]);\n\treturn 0;\n}\n```",
        "postTime": 1624715333,
        "uid": 125901,
        "name": "FxorG",
        "ccfLevel": 7,
        "title": "P1487 \u5931\u843d\u7684\u6210\u7ee9\u5355"
    },
    {
        "content": "[\u6211\u7684blog](https://www.cnblogs.com/suxxsfe/p/13172938.html)  \n\n\u4e4b\u524d\u4f3c\u4e4e\u63d0\u4ea4\u5230\u522b\u7684\u9898\u91cc\u53bb\u4e86/jk\uff0c\u8d76\u7d27\u5220\u4e86\u91cd\u65b0\u4ea4\u4e00\u904d  \n\nhttps://www.luogu.com.cn/problem/P1487  \n\n\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217\uff0c\u5df2\u77e5 $A_1,A_n,n,d$\uff0c\u5e76\u6ee1\u8db3 $A_i=\\dfrac{A_{i-1}+A_{i+1}}{2}+d$\uff0c\u6c42 $A_m$  \n\n\u6700\u8fd1\u6570\u5b66\u8bfe\u5b66\u4e86\u70b9\u7279\u5f81\u65b9\u7a0b\uff0c\u6240\u4ee5\u7528\u5b83\u505a\u4e86\u4e0b\u8fd9\u9898  \n\n\u4e00\u822c\u7528\u7279\u5f81\u65b9\u7a0b\u6c42\u901a\u9879\u7684\u65f6\u5019\uff0c\u662f\u5df2\u77e5\u6570\u5217\u6ee1\u8db3 $a_{i+1}+Ba_i+Ca_{i-1}=0$  \n\u90a3\u4e48\u8bbe $a_{n+1}-pa_n=q(a_n-pa_{n-1})$\uff0c\u8f6c\u5316\u6210 $a_{n+1}-(p+q)a_n+pqa_{n-1}=0$  \n\u6b64\u65f6\u5e94\u6ee1\u8db3 $p+q=-B,pq=C$  \n\u7136\u540e\u7528\u97e6\u8fbe\u5b9a\u7406\u6784\u9020\u4e00\u4e2a\u4e24\u4e2a\u89e3\u5206\u522b\u662f $p,q$ \u7684\u4e8c\u6b21\u65b9\u7a0b\u5e76\u628a\u5b83\u89e3\u51fa\u6765\uff0c\u5c31\u77e5\u9053 $p,q$ \u4e86  \n\u5982\u679c\u65e0\u89e3\u5f53\u7136\u5c31\u662f\u4e0d\u80fd\u8fd9\u6837\u6784\u9020  \n\n\u8fdb\u800c\u8bbe $b_n=a_{n+1}-pa_n$\uff0c\u5219\uff1a  \n\n$$b_n=qb_{n-1}\\Rightarrow b_n=a_{n+1}-pa_n=b_1q^{n-1}=(a_2-pa_1)q^{n-1}$$  \n\n\u540c\u65f6\u9664\u4ee5 $p^{n+1}$\uff0c\u5c31\u662f\uff1a  \n\n$$\\dfrac{a_{n+1}}{p^{n+1}}-\\dfrac{a_n}{p^n}=\\dfrac{(a_2-pa_1)q^{n-1}}{p^{n+1}}$$  \n\n\u518d\u8bbe $c_n=\\dfrac{a_n}{p^n}$  \n\u5c31\u53ef\u4ee5\u8868\u793a\u6210\uff1a  \n\n$$c_{n+1}-c_n=\\dfrac{(a_2-pa_1)q^{n-1}}{p^{n+1}}$$  \n\n\u90a3\u4e48\u5bf9 $c$ \u505a\u4e00\u4e2a\u7d2f\u52a0\uff0c\u4e2d\u95f4\u7684\u4e00\u5806\u9879\u5c31\u6d88\u6ca1\u4e86\uff0c\u5f97\u5230\uff1a  \n\n$$c_n-c_1=\\sum_{i=1}^{n-1}\\dfrac{(a_2-pa_1)q^{i-1}}{p^{i+1}}$$  \n\n\u4e00\u901a\u6574\u7406\uff0c\u53d1\u73b0\u4ece\u91cc\u9762\u628a\u4e0e\u6c42\u548c\u65e0\u5173\u7684\u56e0\u5f0f\u63d0\u51fa\u6765\uff0c\u5c31\u662f\u4e2a\u7b49\u6bd4\u6570\u5217\uff0c\u7528\u4e00\u4e0b\u6c42\u548c\u516c\u5f0f\uff0c\u4e8e\u662f\uff1a  \n\n$$c_n=\\dfrac{a_2-pa_1}{p^2}\\cdot \\dfrac{1-(\\frac{q}{p})^{n-1}}{1-\\frac{q}{p}}+\\dfrac{a_1}{p}$$  \n\n\u8fd8\u539f\u6210 $a_n$\uff0c\u5c31\u662f\uff1a  \n\n$$a_n=\\dfrac{p^{n-2}(a_2-pa_1)(1-(\\frac{q}{p})^{n-1})}{1-\\frac{q}{p}}+a_1p^{n-1}$$  \n$$a_n=\\dfrac{(\\frac{q^{n-1}}{p}-p^{n-2})(a_2-pa_1)}{\\frac{q}{p}-1}+a_1p^{n-1}$$  \n\n\u4e5f\u8bb8\u80fd\u518d\u5316\u7b80\u8ba9\u5f62\u5f0f\u66f4\u597d\u770b\u4e00\u4e9b\uff1f\u4f46\u6211\u61d2\u5f97\u5316\u4e86  \n\n-----------------  \n\n\u518d\u770b\u8fd9\u4e2a\u9898  \n\n$$A_{i+1}+2A_i-A_{i-1}=2d$$  \n\n\u53d1\u73b0\u8fd9\u4e2a $2d$ \u5f88\u803d\u8bef\u4e8b\uff0c\u4f46\u662f\u53ef\u4ee5\u8bbe $a_i=A_i+d$\uff0c\u4e8e\u662f\uff1a  \n\n$$a_{i+1}+2a_i-a_{i-1}=0$$  \n\n\u6309\u7167\u4e4b\u524d\u8bb2\u7684\uff0c\u6b64\u65f6\u5e94\u6ee1\u8db3 $p+q=-2,pq=-1$\uff0c\u4e8e\u662f\u6784\u9020\u65b9\u7a0b $x^2+2x-1=0$  \n\u4e24\u4e2a\u89e3\u5bf9\u5e94 $p,q$\uff0c\u4e5f\u5c31\u662f $p=\\sqrt{2}-1,q=-\\sqrt{2}-1$\uff0c\u5f53\u7136\u628a\u5b83\u4eec\u7684\u503c\u4e92\u6362\u4e5f\u4e0d\u4f1a\u5bf9\u7ed3\u679c\u4ea7\u751f\u5f71\u54cd  \n\u4f46\u6211\u4eec\u5e76\u4e0d\u77e5\u9053 $a_n$ \u8868\u8fbe\u5f0f\u91cc\u7684 $a_2$ \u662f\u4ec0\u4e48\uff0c\u4f46\u662f\u77e5\u9053 $a_n$\uff0c\u4e8e\u662f\u53ef\u4ee5\u53d8\u4e00\u4e0b\u90a3\u4e2a\u5f0f\u5b50\u628a $a_2$ \u6c42\u51fa\u6765\uff1a  \n\n$$a_2=\\frac{(\\frac{q}{p}-1)(a_n-a_1p^{n-1})}{\\frac{q^{n-1}}{p}-p^{n-2}}+a_1p$$  \n\n\u7136\u540e\u5c31\u53ef\u4ee5\u5e26\u5165 $n=m$ \u6765\u6c42\u51fa\u7b54\u6848\u4e86  \n\n\u6ce8\u610f\u5224\u65ad\u4e00\u4e0b $m=0$ \u8fd9\u79cd\u5947\u602a\u7684\u60c5\u51b5  \n\n```cpp  \n#include<cstdio>\n#include<algorithm>\n#include<iostream>\n#include<cmath>\n#include<map>\n#include<iomanip>\n#include<cstring>\n#define reg register\n#define EN std::puts(\"\")\n#define LL long long\ninline long double power(long double a,int b){\n\tlong double ret=1;\n\twhile(b--) ret*=a;\n\treturn ret;\n}\nint main(){\n\tint n,m;scanf(\"%d%d\",&n,&m);\n\tif(!m) return puts(\"0.000\"),0;\n\tlong double d,A1,An,a1,an,a2,am,Am;scanf(\"%Lf%Lf%Lf\",&d,&A1,&An);\n\ta1=A1-d;an=An-d;\n\tlong double p=std::sqrt(2)-1,q=-std::sqrt(2)-1;\n\ta2=(q/p-1)*(an-a1*power(p,n-1))/(power(q,n-1)/p-power(p,n-2))+p*a1;\n\tam=(power(q,m-1)/p-power(p,m-2))*(a2-p*a1)/(q/p-1)+a1*power(p,m-1);\n\tAm=am+d;\n\tprintf(\"%.3Lf\",Am);\n\treturn 0;\n}\n```",
        "postTime": 1592731939,
        "uid": 164432,
        "name": "suxxsfe",
        "ccfLevel": 9,
        "title": "P1487 \u5931\u843d\u7684\u6210\u7ee9\u5355"
    },
    {
        "content": "\u7531\u9898\u610f\uff0c\n$$A_i=\\frac{(A_{i-1})-(A_{i+1})}{2}+d$$\n\n\u7136\u540e\u79fb\u9879\u53ef\u5f97\uff1a\n$$-\\frac{1}{2}A_{i-1}+A_i+\\frac{1}{2}A_{i+1}=d$$\n\n\u7136\u540e\u7531\u4e8e\u6570\u636e\u8303\u56f4\u5f88\u5c0f\uff0c\u6240\u4ee5\u76f4\u63a5\u5957\u4e00\u4e0b\u9ad8\u65af\u6d88\u5143\u6a21\u677f\u5c31\u53ef\u4ee5\u4e86\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nconst int MAXN=65;\ndouble a[MAXN][MAXN],b[MAXN],eps=1e-7,d,a1,an;\nint n,m;\n\nint main(){\n\tcin>>n>>m>>d>>a1>>an;\n\tif(n==0||m==0){\n\t\tcout<<\"0.000\"<<endl;\n\t\treturn 0;\n\t}\n\ta[1][1]=1;b[1]=a1;\n\ta[n][n]=1;b[n]=an;\n\tfor(int i=2;i<n;i++){\n\t\ta[i][i-1]=-1;\n\t\ta[i][i]=2;\n\t\ta[i][i+1]=1;\n\t\tb[i]=d*2;\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tint id=i;\n\t\tfor(int j=i+1;j<=n;j++){\n\t\t\tif(fabs(a[j][i])>fabs(a[id][i])){\n\t\t\t\tid=j;\n\t\t\t}\n\t\t}\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tswap(a[i][j],a[id][j]);\n\t\t}\n\t\tswap(b[i],b[id]);\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tif(i!=j){\n\t\t\t\tdouble t=a[j][i]/a[i][i];\n\t\t\t\tfor(int k=i+1;k<=n;k++){\n\t\t\t\t\ta[j][k]-=a[i][k]*t;\n\t\t\t\t}\n\t\t\t\tb[j]-=b[i]*t;\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%.3lf\",b[m]/a[m][m]);\n\treturn 0;\n}\n```\n\u5f53\u7136\u8fd8\u6709\u4e00\u79cd\u601d\u8def\u662f\u8bbe\u51faA2\u901a\u8fc7\u4e0b\u5f0f\u5f97\u5230An\u7684\u8868\u8fbe\u5f0f\n$$A_{i+1}=2d+A_{i-1}-2A_i$$\n\u8fd9\u91cc\u5c31\u4e0d\u7ed9\u51fa\u4ee3\u7801\u4e86",
        "postTime": 1563633376,
        "uid": 89929,
        "name": "wanghanjun",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1487 \u3010\u5931\u843d\u7684\u6210\u7ee9\u5355\u3011"
    },
    {
        "content": "\u9898\u76ee\u7684\u6570\u5217\u5982\u4e0b\uff08\u7531\u4e8e\u7cbe\u5ea6\u548c\u8ba1\u7b97\u987a\u5e8f\u95ee\u9898\uff0c\u8d8a\u9760\u8fd1an\u7b54\u6848\u8d8a\u7cbe\u786e\uff09\n\n\n```cpp\na[1]=1.213\na[2]=-491.500\na[3]=-615.000\na[4]=227.375\na[5]=-44.750\na[6]=62.062\na[7]=24.203\na[8]=14.746\na[9]=3.793\na[10]=4.247\na[11]=0.386\na[12]=1.060\na[13]=0.602\na[14]=0.567\na[15]=0.554\na[16]=0.561\na[17]=0.542\na[18]=0.545\na[19]=0.544\na[20]=0.543\na[21]=0.543\na[22]=0.543\na[23]=0.543\na[24]=0.543\na[25]=0.543\na[26]=0.543\na[27]=0.543\na[28]=0.543\na[29]=0.543\na[30]=0.543\na[31]=0.543\na[32]=0.543\na[33]=0.543\na[34]=0.542\na[35]=0.544\na[36]=0.540\na[37]=0.550\na[38]=0.525\na[39]=0.586\na[40]=0.440\na[41]=0.792\na[42]=-0.059\na[43]=1.995\na[44]=-2.963\na[45]=9.007\na[46]=-19.891\na[47]=49.876\na[48]=-118.556\na[49]=288.074\na[50]=-693.618\na[51]=1676.397\na[52]=-4045.326\na[53]=9768.134\n```\n\u8ba1\u7b97\u65b9\u6cd5\u662f\uff1a\n\u5148\u5047\u8bbeA(n-1)\u5df2\u77e5\uff0c\u518d\u7528An\u548cd\u9012\u63a8\u51faA(n-2),A(n-3)\u7b49\u7b49\uff0c\u6240\u6709\u6570\u5217\u5747\u8868\u8fbe\u4e3a\u4e00\u4e2a\u5173\u4e8eA(n-1),A(n)\u548cd\u7684\u4e00\u4e2a\u65b9\u7a0b\uff0c\u53ea\u7528\u8bb0\u5f55\u4e0b\u6bcf\u9879\u7684\u7cfb\u6570\u5373\u53ef\uff0c\u5728\u63a8\u5230A2\u548cA3\u65f6\uff0c\u5c31\u53c8\u53ef\u4ee5\u8054\u7acbA1\uff0cA2\uff0cA3\u8ba1\u7b97\u51fa\u65b9\u7a0b\u4e2d\u7684A(n-1),\u5728\u5e26\u56de\u539f\u5f0f\u4e2d\uff0c\u5373\u53ef\u8ba1\u7b97\u51fa\u6574\u4e2a\u6570\u5217\n\n\n\u6ce8\u610f\u4e8b\u9879\uff1a\n\n\u7531\u4e8e\u7cbe\u5ea6\u95ee\u9898\uff0c\u5728\u8fd9\u91cclong long\u4e5f\u4f1a\u7206\u6389\uff0c\u6240\u4ee5\u5e94\u7528long double\uff0c\u6ce8\u610f\u5360\u4f4d\u7b26\u548c\u8f93\u5165\u8f93\u51fa\u683c\u5f0f\uff08\u4e0d\u8981\u95ee\u6211\u662f\u600e\u4e48\u77e5\u9053\u8fd9\u4e9b\u7684\uff0c\u76f4\u63a5\u770b\u6211\u60e8\u75db\u7684\u63d0\u4ea4\u8bb0\u5f55\uff09\n\n\n\n\n\n\n```cpp\n//by\uff1a\u4fe1\u51af\u54e5\n#include<stdio.h>\n#include<iostream>\n#include<stdlib.h>\n#include<algorithm>\n#include<string.h>\n#include<math.h>\n#include<time.h>\n#include<vector>\n#include<queue>\n#include<limits.h>\n#include <iomanip>\nusing namespace std;\n#define maxn 1005\n#define MOD 9999999999\n#define bugb puts(\"begin\");\n#define buge puts(\"end\");\ntypedef long long ll;\ntypedef long double ld;\nll n,m,k,l,s,t,r,T,ans,cas;\nld a[maxn];\nld d;\nstruct st\n{\n    ld x1,x2,x3;\n} node[maxn];\nint main()\n{\n    freopen(\"in.txt\",\"r\",stdin);\n    freopen(\"out.txt\",\"w\",stdout);\n    ll i,j;\n    cin>>n>>m;\n    cin>>d>>a[1]>>a[n];\n    if(n==3)\n        {\n            a[2]=(a[1]-a[2])/2.0+d;\n            printf(\"%.3lf\",a[m]);\n            return 0;\n        }\n    if(n<=2)\n        {\n            printf(\"%.3lf\",a[m]);\n            return 0;\n        }\n    node[n-1].x1=1;\n    node[n-1].x2=0;\n    node[n-1].x3=0;\n    node[n-2].x1=2;\n    node[n-2].x2=1;\n    node[n-2].x3=-2;\n    for(i=n-3; i>=2; i--)\n        {\n            node[i].x1=2*node[i+1].x1+node[i+2].x1;\n            node[i].x2=2*node[i+1].x2+node[i+2].x2;\n            node[i].x3=2*node[i+1].x3+node[i+2].x3-2;\n        }\n    ld xn1=2*node[2].x1+node[3].x1,xn2=2*node[2].x2+node[3].x2,xn3=2*node[2].x3+node[3].x3;\n    ld opt=(a[1]+2*d-(ld)xn2*a[n]-(ld)xn3*d)/(ld)xn1;\n    for(i=2; i<=n-1; i++)\n        a[i]=opt*(ld)node[i].x1+(ld)node[i].x2*a[n]+(ld)node[i].x3*d;\n   /* for(i=1; i<=n; i++)\n        cout << \"a[\"<<i<<\"]=\"<<fixed << setprecision(3) << a[i]<<endl;*/\ncout << <<fixed << setprecision(3) << a[m]<<endl;\n    return 0;\n}\n\n```",
        "postTime": 1488332178,
        "uid": 31813,
        "name": "fengjk",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1487 \u3010\u5931\u843d\u7684\u6210\u7ee9\u5355\u3011"
    }
]
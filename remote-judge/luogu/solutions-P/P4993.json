[
    {
        "content": "\u6bd4\u8f83\u826f\u5fc3\u7684\u90e8\u5206\u5206\uff0850pts\uff09   \n\u524d30\u5206\u53ef\u4ee5\u66b4\u529b  \n\u53e620\u5206\u53ef\u4ee5\u9012\u63a8  \n\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u5316\u7b80\u4e0b\u6765\uff0c\u5c31\u662f$C_{minx+1}^n+C_{minx+2}^n+...+C_n^n$  \n(n\u4e3a\u5408\u683c\u7684\u6c34\u519b\u6570\u91cf\uff0cminx\u4e3a\u6700\u5c11\u9700\u8981\u7684\u6c34\u519b\u6570\u91cf\uff08\u56e0\u4e3a\u8981\u53bb\u6389\u6700\u9ad8\u5206\uff0c\u6240\u4ee5\u6211\u4eec\u8981+1\uff09)  \n\u7136\u540e\u5bf9\u4e8ep=\u8d28\u6570\u7684\u60c5\u51b5\uff0clucas\u5b9a\u7406\u5373\u53ef  \np!=\u8d28\u6570\u7684\u8bdd\u7528exlucas\u5c31\u884c    \n\u5f53\u7136\uff0c\u636e\u8bf4\u6709\u4eba\u66b4\u529b\u80fd\u6c34\u4e0d\u5c11\u5206\uff1ftql\uff01\uff08\u53ef\u80fd\u662f\u6211\u6570\u636e\u51fa\u6c34\u4e86\uff09  \n```\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define rii register int i\n#define rij register int j \n#define int long long\nusing namespace std;\nint n1,m1,p,nl[100005],t;\nint pf[10]={0,1,10,15,25,40,55,75,100};\nint pow(int a,int b,int p)\n{\n    int res=1;\n    while(b)\n    {\n        if(b&1)\n        {\n            res=res*a%p;\n        }\n        a=a*a%p;\n        b>>=1;\n    }\n    return res;\n}\nint exgcd(int a,int b,int& x,int& y)\n{\n    if(!b)\n    {\n        x=1;\n        y=0;\n        return a;\n    }\n    int res=exgcd(b,a%b,y,x);\n    y-=(a/b)*x;\n    return res;\n}\nint reverse(int a,int p)\n{\n    int x,y;\n    exgcd(a,p,x,y);\n    return (x%p+p)%p;\n}\nint C(int n,int m,int p)\n{\n    if(m>n)\n    {\n        return 0;\n    }\n    int res=1,i,a,b;\n    for(i=1;i<=m;i++)\n    {\n        a=(n+1-i)%p;\n        b=reverse(i%p,p);\n        res=res*a%p*b%p;\n    }\n    return res;\n}\nint Lucas(int n,int m,int p)\n{\n    if(m==0)\n    {\n        return 1;\n    }\n    return Lucas(n/p,m/p,p)*C(n%p,m%p,p)%p;\n}\nint cal(int n,int a,int b,int p)\n{\n    if(!n)\n    {\n        return 1;\n    } \n    int i,y=n/p,tmp=1;\n    for(i=1;i<=p;i++)\n    {\n        if(i%a)\n        {\n            tmp=tmp*i%p;\n        }\n    }\n    int ans=pow(tmp,y,p);\n    for(i=y*p+1;i<=n;i++)\n    {\n        if(i%a)\n        {\n            ans=ans*i%p;\n        } \n        \n    } \n    return ans*cal(n/a,a,b,p)%p;\n}\nint multiLucas(int n,int m,int a,int b,int p)\n{\n    int i,t1,t2,t3,s=0,tmp;\n    for(i=n;i;i/=a)\n    {\n        s+=i/a;\n    }\n    for(i=m;i;i/=a)\n    {\n        s-=i/a;\n    }\n    for(i=n-m;i;i/=a)\n    {\n        s-=i/a;\n    }\n    tmp=pow(a,s,p);\n    t1=cal(n,a,b,p);\n    t2=cal(m,a,b,p);\n    t3=cal(n-m,a,b,p);\n    return tmp*t1%p*reverse(t2,p)%p*reverse(t3,p)%p;\n}\nint exLucas(int n,int m,int p)\n{\n    int i,d,c,t,x,y,q[100],a[100],e=0;\n    for(i=2;i*i<=p;i++)\n    {\n        if(p%i==0)\n        {\n            q[++e]=1;\n            t=0;\n            while(p%i==0)\n            {\n                p/=i;\n                q[e]*=i;\n                t++;\n            }\n            if(q[e]==i)\n            {\n                a[e]=Lucas(n,m,q[e]);\n            }\n            else\n            {\n                a[e]=multiLucas(n,m,i,t,q[e]);\n            }\n        }\n    }\n    if(p>1)\n    {\n    \te++;\n        q[e]=p;\n        a[e]=Lucas(n,m,p);\n    }\n    for(i=2;i<=e;i++)\n    {\n        d=exgcd(q[1],q[i],x,y);\n        c=a[i]-a[1];\n        if(c%d)\n        {\n            exit(-1);\n        }\n        t=q[i]/d;\n        x=(c/d*x%t+t)%t;\n        a[1]=q[1]*x+a[1];\n        q[1]=q[1]*q[i]/d;\n    }\n    return a[1];\n}\ninline int rd(){\n    int x=0,f=1;char ch=getchar();\n    while(!isdigit(ch)) {f=ch=='-'?0:1;ch=getchar();}\n    while(isdigit(ch))  {x=(x<<1)+(x<<3)+ch-'0';ch=getchar();}\n    return f?x:-x;\n}\nbool cmp(int lk,int kl)\n{\n\treturn lk<kl;\n}\nvoid solve()\n{\n\tn1=rd();\n\tm1=rd();\n\tp=rd();\n//\tscanf(\"%lld%lld%lld\",&n,&m,&p);\n\tfor(rii=1;i<=n1;i++)\n\t{\n\t\tnl[i]=rd();\n//\t\tscanf(\"%lld\",&nl[i]);\n\t}\n\tsort(nl+1,nl+n1+1,cmp);\n\tint minx=10,jsq=0;\n\tfor(rii=1;i<=m1;i++)\n\t{\n\t\tint val;\n\t\tval=rd();\n//\t\tscanf(\"%lld\",&val);\n\t\tminx=min(minx,val);\n\t\tjsq+=pf[val];\n\t}\n\tjsq-=pf[minx];\n\tint cha=(m1-1)*71-jsq;\n\tint mins=cha/29;\n\tif(mins*29<cha)\n\t{\n\t\tmins++;\n\t}\n\tif(cha<=0)\n\t{\n\t\tmins=0;\n\t}\n\tint ans=0;\n\tint zx;\n\tzx=rd();\n//\tscanf(\"%lld\",&zx);\n\tint cnt=n1;\n\tfor(rii=1;i<=n1;i++)\n\t{\n\t\tif(nl[i]<zx)\n\t\t{\n\t\t\tcnt--;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tbreak;\n\t\t}\n\t}\n\tn1=cnt;\n\tfor(rii=mins+1;i<=n1;i++)\n\t{\n\t\tans+=exLucas(n1,i,p);\n\t\tans%=p;\n\t}\n    printf(\"%lld\\n\",ans);\n}\nsigned main()\n{\n// \tfreopen(\"pf10.in\",\"r\",stdin);\n// \tfreopen(\"pf10.out\",\"w\",stdout);\n    scanf(\"%lld\",&t);\n    for(rii=1;i<=t;i++)\n    {\n    \tsolve();\n\t}\n}\n```",
        "postTime": 1541303356,
        "uid": 52176,
        "name": "ztz11",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4993 \u3010\u8bc4\u5206\u7cfb\u7edf\u3011"
    }
]
[
    {
        "content": "\u6211\u987a\u4fbf\u6765\u5b89\u5229\u4e00\u4e0b\u81ea\u5df1\u7684\u535a\u5ba2[peng-ym's blog](http://www.cnblogs.com/peng-ym/)\u91cc\u9762\u4e5f\u6709[\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14](http://www.cnblogs.com/peng-ym/p/8647856.html)\u4e0e[\u6574\u9664\u5206\u5757](http://www.cnblogs.com/peng-ym/p/8661118.html)\u7684\u4ecb\u7ecd\uff0c\u4e0d\u77e5\u9053\u7684\u53ef\u4ee5\u770b\u4e00\u770b\u54e6\uff01\n## \u9898\u76ee\u63cf\u8ff0\n- \u5bf9\u4e8e\u7ed9\u51fa\u7684n\u4e2a\u8be2\u95ee\uff0c\u6bcf\u6b21\u6c42\u6709\u591a\u5c11\u4e2a\u6570\u5bf9(x,y)\uff0c\u6ee1\u8db3a\u2264x\u2264b\uff0cc\u2264y\u2264d\uff0c\u4e14gcd(x,y) = k\uff0cgcd(x,y)\u51fd\u6570\u4e3ax\u548cy\u7684\u6700\u5927\u516c\u7ea6\u6570\u3002\n\n## \u8f93\u5165\u8f93\u51fa\u683c\u5f0f\n- \u8f93\u5165\u683c\u5f0f\uff1a\n\u7b2c\u4e00\u884c\u4e00\u4e2a\u6574\u6570n\uff0c\u63a5\u4e0b\u6765n\u884c\u6bcf\u884c\u4e94\u4e2a\u6574\u6570\uff0c\u5206\u522b\u8868\u793aa\u3001b\u3001c\u3001d\u3001k\n- \u8f93\u51fa\u683c\u5f0f\uff1a\n\u5171n\u884c\uff0c\u6bcf\u884c\u4e00\u4e2a\u6574\u6570\u8868\u793a\u6ee1\u8db3\u8981\u6c42\u7684\u6570\u5bf9(x,y)\u7684\u4e2a\u6570\n\n## \u89e3\u9898\u601d\u8def\n- \u8fd9\u4e2a\u9898\u8981\u6c42\u7684\u5176\u5b9e\u5c31\u662f:$Ans=\\sum_{i=a}^{b}\\sum_{j=c}^{d}[gcd(i,j)=k]$\n- \u5982\u679c\u505a\u8fc7\u4e00\u9053\u53eb:[[POI2007]ZAP-Queries](http://www.cnblogs.com/peng-ym/p/8660937.html )\u7684\u9898\uff0c\u90a3\u4e48\u8fd9\u9898\u5c31\u663e\u5f97\u975e\u5e38\u7684\u7b80\u5355\u4e86\u3002\u56e0\u4e3a\u90a3\u9053\u9898\u5c31\u662f\u8fd9\u9053\u9898\u7684\u4e00\u4e2a\u7279\u6b8a\u60c5\u51b5$(a=1,c=d)$\n- \u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u672c\u9898\u6240\u7b97\u7684$a$~$b$,$c$~$d$\u7684\u7b54\u6848\uff0c\u5b9e\u8d28\u4e0a\u7531\u4e00\u4e2a\u7b80\u5355\u7684\u5bb9\u65a5\u5c31\u53ef\u4ee5\u8f6c\u6362\u6210:\n$$Ans((1,b),(1,d))-Ans((1,b),(1,c-1))-Ans((1,a-1),(1,d))+Ans((1,a-1),(1,c-1))$$\n- \u4e5f\u5c31\u662f\u4e00\u79cd\u7c7b\u4f3c\u4e8e\u524d\u7f00\u548c\u7684\u5bb9\u65a5\u3002\u5177\u4f53\u7684\u539f\u56e0\uff0c\u5176\u5b9e\u628a$\\sum$\u968f\u4fbf\u624b\u5199\u51e0\u9879\uff0c\u5c31\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e00\u5b9a\u662f\u6b63\u786e\u7684\u3002\n- \u81f3\u4e8e\u5982\u4f55\u6c42$1$~$n$,$1$~$m$\uff0c\u5c31\u6309\u7167\u90a3\u9053\u9898\u5316\u7b80\u4e00\u4e0b\u5f0f\u5b50\u5c31\u53ef\u4ee5\u4e86\u3002\n- \u6211\u4eec\u8bbe\uff1a\n$$f(k)=\\sum_{i=1}^{a}\\sum_{j=1}^{b}[gcd(i,j)=k]$$\n$$F(n)=\\sum_{n|k}f(k)=\\lfloor\\frac{a}{n}\\rfloor\\lfloor\\frac{b}{n}\\rfloor$$\n\u5219\u53ef\u4ee5\u7531\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u53ef\u4ee5\u63a8\u51fa\uff1a\n$$f(n)=\\sum_{n|k}\\mu(\\lfloor\\frac{k}{n}\\rfloor)F(k)$$\n- **(PS:\u5982\u679c\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u8981\u8bbe\u8fd9\u4e24\u4e2a\u51fd\u6570\uff0c\u53ef\u4ee5\u70b9\u5f00\u6211\u4e0a\u9762\u653e\u7684\u94fe\u63a5)**\n- \u8bbe\u5b8c\u8fd9\u4e24\u4e2a\u51fd\u6570\u4e4b\u540e\uff0c\u6211\u4eec\u4fbf\u60ca\u559c\u7684\u53d1\u73b0\uff0c$Ans=f(d)$\n- \u4e8e\u662f\u5c31\u76f4\u63a5\u5f00\u59cb\u63a8\u7b54\u6848\uff1a\n$$Ans=\\sum_{d|k}\\mu(\\lfloor\\frac{k}{d}\\rfloor)F(k)$$\n\u679a\u4e3e$\\lfloor\\frac{k}{d}\\rfloor$\u8bbe\u4e3a$t$\n$$Ans=\\sum_{t=1}^{min(a,b)}\\mu(t)\\lfloor\\frac{a}{td}\\rfloor\\lfloor\\frac{b}{td}\\rfloor$$\n\u8fd9\u65f6\u5019\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u5df2\u7ecf\u53ef\u4ee5\u505a\u5230$O(n)$\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e86\uff0c\u4f46\u662f\u56e0\u4e3a\u6709\u591a\u7ec4\u6570\u636e\uff0c\u6240\u4ee5\u6211\u4eec\u518d\u7528\u4e00\u4e0b**[\u6574\u9664\u5206\u5757](http://www.cnblogs.com/peng-ym/p/8661118.html)**\uff0c\u8fd9\u5f0f\u5b50\u5c31\u53ef\u4ee5\u505a\u5230$O(\\sqrt{n})$\u4e86\u3002\n- \u6211\u4eec\u53ea\u9700\u8981\u5199\u4e00\u4e2a\u8fd9\u6837\u7684\u51fd\u6570\uff0c\u6bcf\u6b21\u8be2\u95ee\u8c03\u7528\u56db\u904d\u5c31\u53ef\u4ee5\u4e86\u3002\n\n## \u4e0b\u9644\u4ee3\u7801:\n\n```cpp\n// luogu-judger-enable-o2\n#include<bits/stdc++.h>\n#define N 60010\nusing namespace std;\ninline void read(int &x)\n{\n    x=0;\n    static int p;p=1;\n    static char c;c=getchar();\n    while(!isdigit(c)){if(c=='-')p=-1;c=getchar();}\n    while(isdigit(c)) {x=(x<<1)+(x<<3)+(c-48);c=getchar();}\n    x*=p;\t\n}\nbool vis[N];\nint prim[N],mu[N],sum[N],cnt,k;\nvoid get_mu(int n)\n{\n    mu[1]=1;\n    for(int i=2;i<=n;i++)\n    {\n        if(!vis[i]){mu[i]=-1;prim[++cnt]=i;}\n        for(int j=1;j<=cnt&&i*prim[j]<=n;j++)\n        {\n            vis[i*prim[j]]=1;\n            if(i%prim[j]==0)break;\n            else mu[i*prim[j]]=-mu[i];\n        }\n    }\n    for(int i=1;i<=n;i++)sum[i]=sum[i-1]+mu[i];\n}\nlong long calc(int a,int b)\n{\n    static int max_rep;\n    static long long ans;\n    max_rep=min(a,b);ans=0;\n    for(int l=1,r;l<=max_rep;l=r+1)\n    {\n        r=min(a/(a/l),b/(b/l));\n        ans+=(1ll*a/(1ll*l*k))*(1ll*b/(1ll*l*k))*(sum[r]-sum[l-1]);\n    }\n    return ans;\n}\nint main()\n{\n//\tfreopen(\"P3455.in\",\"r\",stdin);\n//\tfreopen(\"P3455.out\",\"w\",stdout);\n    int t;\n    read(t);\n    get_mu(50000);\n    while(t--)\n    {\n        static int a,b,c,d;\n        read(a);read(b);read(c);read(d);read(k);\n        printf(\"%lld\\n\",calc(b,d)-calc(b,c-1)-calc(a-1,d)+calc(a-1,c-1));\n    }\n    return 0;\n}\n```",
        "postTime": 1522337476,
        "uid": 22016,
        "name": "pengym",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    },
    {
        "content": "\u6211\u6765\u63d0\u4f9b\u4e00\u4e0b\u8fd9\u9898\u7684\u4f18\u5316\u65b9\u6848\n\n\u9996\u5148\u662f\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5185\u5bb9\n\n$$f(x)=\\sum_{i=a}^b \\sum_{j=c}^d [(i,j)=x] $$\n\n$$F(x)=\\sum_{i=a}^b \\sum_{j=c}^d [x|(i,j)]=(\\lfloor \\frac{b}{x} \\rfloor - \\lfloor \\frac{a-1}{x} \\rfloor)(\\lfloor \\frac{d}{x} \\rfloor - \\lfloor \\frac{c-1}{x} \\rfloor)$$\n\n$$F(x)=\\sum_{x|d} f(d)$$\n\n$$f(x)=\\sum_{x|d} \\mu(\\frac{d}{x}) F(d)$$\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u6574\u9664\u5206\u5757\u4f18\u5316\uff0c\u4f46\u6ca1\u5fc5\u8981\u7528\u5206\u5757\u8ba1\u7b974\u904d\n\n\u53ea\u9700\u8981\u5206\u4e09\u6bb5\u6c42\u89e3\u5c31\u53ef\u4ee5\u4e86\n\n$$a \\leq b,c \\leq d$$\n\n\u4ee4$$a \\leq c$$\n\n\u90a3\u4e48\u9700\u8981\u6c42\u89e3\u7684\u4e09\u6bb5\u533a\u95f4\u4e3a\uff1a\n\n$$[1,\\lfloor \\frac{a-1}{x} \\rfloor]$$\n\n$$(\\lfloor \\frac{a-1}{x} \\rfloor,min(\\lfloor \\frac{c-1}{x} \\rfloor,\\lfloor \\frac{b}{x} \\rfloor)]$$\n\n$$(min(\\lfloor \\frac{c-1}{x} \\rfloor,\\lfloor \\frac{b}{x} \\rfloor),min(\\lfloor \\frac{d}{x} \\rfloor,\\lfloor \\frac{b}{x} \\rfloor)]$$\n\n\u6574\u9664\u5206\u5757\u4f18\u5316\u53ef\u505a\u5230\u6839\u53f7\u590d\u6742\u5ea6\uff0c\u4e14\u6b64\u7b97\u6cd5\u5e38\u6570\u662f\u5176\u4ed6\u9898\u89e3\u5bb9\u65a5\u4f5c\u6cd5\u7684\u4e00\u534a\n\n```cpp\n#include<cstdio>\n#include<bitset>\n#include<algorithm>\nusing namespace std;\n\nconst int MAXN=5e4+5;\n\nint T,x,a,b,c,d;\nlong long p[MAXN],mu[MAXN],lis[MAXN];\nlong long sum;\nbitset<MAXN> bist;\n\nint main()\n{\n\tmu[1]=lis[1]=1;scanf(\"%d\",&T);\n\tfor(int i=2;i<=MAXN-5;++i){\n\t\tif(!bist[i]) p[++p[0]]=i,mu[i]=-1;\n\t\tlis[i]=lis[i-1]+mu[i];\n\t\tfor(int j=1;j<=p[0]&&i*p[j]<=MAXN-5;++j){\n\t\t\tbist[i*p[j]]=1;\n\t\t\tif(i%p[j]) mu[i*p[j]]=-mu[i];\n\t\t\telse {mu[i*p[j]]=0;break;}\n\t\t}\n\t}while(T--){\n\t\tscanf(\"%d%d%d%d%d\",&a,&b,&c,&d,&x);\n\t\ta=(a-1)/x;b/=x;c=(c-1)/x;d/=x;sum=0;\n\t\tif(a>c){swap(a,c);swap(b,d);}\n\t\tint l=1,r;\n\t\tfor(;l<=a;l=r+1){\n\t\t\tint ra=a/(a/l),rb=b/(b/l),rc=c/(c/l),rd=d/(d/l);\n\t\t\tr=min(ra,min(rb,min(rc,rd)));\n\t\t\tsum+=(lis[r]-lis[l-1])*(b/l-a/l)*(d/l-c/l);\n\t\t}for(;l<=min(b,c);l=r+1){\n\t\t\tint rb=b/(b/l),rc=c/(c/l),rd=d/(d/l);\n\t\t\tr=min(rb,min(rc,rd));\n\t\t\tsum+=(lis[r]-lis[l-1])*(b/l)*(d/l-c/l);\n\t\t}for(;l<=min(b,d);l=r+1){\n\t\t\tint rb=b/(b/l),rd=d/(d/l);\n\t\t\tr=min(rb,rd);\n\t\t\tsum+=(lis[r]-lis[l-1])*(b/l)*(d/l);\n\t\t}printf(\"%lld\\n\",sum);\n\t}return 0;\n}\n```\n\n~~\u76ee\u524d2520ms\u6700\u4f18\u89e3~~\n\n[\u849f\u84bb\u7684blog](https://mhrlovezmy.coding.me/)",
        "postTime": 1529449979,
        "uid": 31293,
        "name": "Adove",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    },
    {
        "content": "**\u5148\u5b89\u5229\u6211\u7684\u535a\u5ba2:**\n1. [\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f141](https://www.cnblogs.com/linzhengmin/p/10994520.html) \u5b9a\u7406  \n2. [\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f142](https://www.cnblogs.com/linzhengmin/p/11046230.html) \u8bc1\u660e  \n3. [\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f143](https://www.cnblogs.com/linzhengmin/p/11060871.html) \u6280\u5de7  \n\n&ensp;&ensp;&ensp;[\u6574\u9664\u5206\u5757](https://www.cnblogs.com/linzhengmin/p/11061244.html) \u7b97\u6cd5\u4ecb\u7ecd\n\n**\u524d\u7f6e\u6280\u5de7:**  \n\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u7ebf\u6027\u7b5b\uff0c\u6574\u9664\u5206\u5757\uff0c\u7b80\u5355\u5bb9\u65a5  \n**\u9996\u5148\u6211\u4eec\u8981\u4f1a\u8fd9\u6837\u4e00\u9053\u9898:**  \n\u8ba1\u7b97$1 \\leq x \\leq a$\uff0c$1 \\leq y \\leq b$\uff0c$gcd(x,y)=d$  \n\u6211\u5148\u653e\u4e00\u4e2a\u4e0a\u9762\u90a3\u9898\u7684\u9898\u89e3\uff1a  \n\u9898\u76ee\u8981\u6211\u4eec\u6c42\n$$\\sum_{i=1}^a\\sum_{j=1}^b[gcd(i,j)=d]$$\n\u6309\u7167[\u5957\u8def1](https://www.cnblogs.com/linzhengmin/p/11060871.html)\uff0c\u6211\u4eec\u5c06\u5176\u540c\u65f6\u9664\u4ee5d\u8f6c\u6362\u4e3a\n$$\\sum_{i=1}^{\\lfloor\\frac{a}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{b}{d}\\rfloor}[gcd(i,j)=1]$$\n\u6309\u7167[\u6280\u5de71](https://www.cnblogs.com/linzhengmin/p/11060871.html)\uff0c\u6211\u4eec\u5c06\u5176\u53d8\u6362\u4e3a\n$$\\sum_{i=1}^{\\lfloor\\frac{a}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{b}{d}\\rfloor}\\sum_{x|gcd(i,j)}\\mu(x)$$\n\u6309\u7167[\u6280\u5de73](https://www.cnblogs.com/linzhengmin/p/11060871.html)\uff0c\u6211\u4eec\u5c06\u5176\u53d8\u6362\u4e3a\n$$\\sum_{i=1}^{\\lfloor\\frac{a}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{b}{d}\\rfloor}\\sum_{x=1}^{\\lfloor\\frac{a}{d}\\rfloor}\\mu(x)\\times[x|gcd(i,j)]$$\n\u6211\u4eec\u53d1\u73b0\u8981\u6ee1\u8db3$d|gcd(i,j)$\uff0c\u6211\u4eec\u7684i\uff0cj\u5fc5\u987b\u662fd\u7684\u500d\u6570\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5f00\u5fc3\u5730\u53bb\u6389\u4e24\u4e2a$\\sum$\n$$\\sum_{x=1}^{\\lfloor\\frac{a}{d}\\rfloor}\\mu(x)\\times\\lfloor\\frac{a}{xd}\\rfloor\\lfloor\\frac{b}{xd}\\rfloor$$\n\u81f3\u6b64\u5316\u7b80\u7ed3\u675f\uff0c\u6211\u4eec\u6c42\u51fa[$\\mu$\u51fd\u6570](https://www.cnblogs.com/linzhengmin/p/10994520.html)\u7684\u524d\u7f00\u548c  \n\u7136\u540e\u6211\u4eec[\u6574\u9664\u5206\u5757](https://www.cnblogs.com/linzhengmin/p/11061244.html)\uff0c\u89e3\u51b3\u95ee\u9898  \n**\u597d\u4e86\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u56de\u5230\u672c\u9898**  \n\u7136\u540e\u53d1\u73b0\u8fd9\u9898\u5c31\u662f\u90a3\u9053\u9898\u52a0\u4e00\u4e2a\u5bb9\u65a5\u539f\u7406  \n\u6211\u4eec\u8981\u6c42\u7684\u7b54\u6848\u5c31\u662f$ans(b,d)-ans(b,c-1)-ans(a-1,d)+ans(a-1,c-1)$  \n~~\u5c0f\u5b66\u751f\u90fd\u4f1a\u8bc1\u554a~~  \n\u4e8e\u662f\u6109\u5feb\u7684AC\u4e86  \n\n**\u653e\u4e00\u4e2a\u4ee3\u7801**\n```cpp\n#include <cstdio>\n#include <algorithm>\n#define ll long long\n#define MAXNUM 50005\n\nint mu[MAXNUM], is_not_prime[MAXNUM], primes[MAXNUM / 10], prime_num;\n// prefix\nll qzh[MAXNUM];\n\nint read(){\n    int x = 0; int zf = 1; char ch = ' ';\n    while (ch != '-' && (ch < '0' || ch > '9')) ch = getchar();\n    if (ch == '-') zf = -1, ch = getchar();\n    while (ch >= '0' && ch <= '9') x = x * 10 + ch - '0', ch = getchar(); return x * zf;\n}\n\nvoid init(){\n    mu[1] = 1; is_not_prime[0] = is_not_prime[1] = 1;\n    for (int i = 2; i <= MAXNUM; ++i){\n        if (!is_not_prime[i]) mu[primes[++prime_num] = i] = -1;\n        for (int j = 1; j <= prime_num && primes[j] * i <= MAXNUM; ++j){\n            is_not_prime[i * primes[j]] = 1;\n            if (!(i % primes[j])) break;\n            else\n                mu[primes[j] * i] = -mu[i];\n        }\n    }\n    for (int i = 1; i <= MAXNUM; ++i)\n        qzh[i] = qzh[i - 1] + mu[i];\n}\n\nll solve(int n, int m, int d){\n\tif (n == 0 || m == 0) return 0;\n\tll ans = 0;\n\tn /= d, m /= d;\n    if (n > m) n ^= m ^= n ^= m; ans = 0;\n    for (int l = 1, r; l <= n; l = r + 1){\n        r = std::min(n / (n / l), m / (m / l));\n        ans += (ll)(qzh[r] - qzh[l - 1]) * (n / l) * (m / l);\n    }\n\treturn ans;\n}\n\nint main(){\n    init();\n    int T = read(), a, b, n, m, d; ll ans;\n    while (T--){\n        a = read(), n = read(), b = read(), m = read(), d = read();\n        ans = solve(n, m, d) - solve(n, b - 1, d) - solve(a - 1, m, d) + solve(a - 1, b - 1, d);\n        printf(\"%lld\\n\", ans);\n    }\n    return 0;\n}\n```",
        "postTime": 1561124669,
        "uid": 20462,
        "name": "lukelin",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    },
    {
        "content": "\u8fd9\u9898\u53ef\u4ee5\u88ab\u8ba4\u4e3a\u662fP2257\u7684\u6269\u5c55\u3002   \n\u8003\u8651\u5bb9\u65a5\u539f\u7406\uff1a\uff08\u4e3a\u907f\u514d\u516c\u5f0f\u8fc7\u957f\uff0c\u8bbe$[\\gcd(i,j)=k]$\u4e3a$\\text{A}$\uff09   \n$$\\sum_{i=a}^b \\sum_{j=c}^{d}[A]=\\sum_{i=1}^b \\sum_{j=1}^{d}[A]-\\sum_{i=1}^{a-1} \\sum_{j=1}^{d}[A]-\\sum_{i=1}^b \\sum_{j=1}^{c-1}[A]+\\sum_{i=1}^{a-1} \\sum_{j=1}^{c-1}[A] $$   \n\u6240\u4ee5\u95ee\u9898\u4fbf\u8f6c\u5316\u4e3a\u6c42\n$$\\sum_{i=1}^n \\sum_{j=1}^{m}[\\gcd(i,j)=k]$$\n\u5982\u679c\u505a\u8fc7[P2257](https://www.luogu.org/problemnew/show/P2257)\u7684\u8bdd\uff0c\u53ef\u4ee5\u9a6c\u4e0a\u5f97\u51fa\u7b54\u6848\uff1a\u8fd9\u4e2a\u67ff\u5b50$=\\sum_{T=1}^{min(n,m)}(\\lfloor \\frac{N}{T} \\rfloor \\times \\lfloor \\frac{M}{T} \\rfloor) \\times \\sum_{k\\in prim,k|T}\\mu(\\frac{T}{k})$   \n\u5982\u679c\u6ca1\u505a\u8fc7\u7684\u8bdd\uff0c\u53ef\u4ee5\u770b\u770b\u6211\u7684[\u9898\u89e3](https://www.luogu.org/blog/70780/solution-p2257).\n\n#### \uff08\u91cd\u70b9\uff09\u4e00\u4e9b\u8ba9\u4ee3\u7801\u66f4\u5feb\u7684\u65b9\u6cd5   \n\u89e3\u6cd5\u5df2\u7ecf\u6709\u592a\u591a\u7684\u5927\u4f6c\u8bb2\u8fc7\u4e86\uff0c\u5305\u62ec\u590d\u6742\u5ea6\u66f4\u4f4e\u7684\u65b9\u6cd5\uff0c\u4f46\u4f18\u5316\u548c\u4e0d\u4f18\u5316\u4ecd\u6709\u5de8\u5927\u7684\u5dee\u8ddd\u3002   \n\u9996\u5148\uff0c\u5728\u6240\u6709\u53d8\u91cf\u90fd\u662f```long long```\u7684\u60c5\u51b5\u4e0b\uff08```#define int long long```\uff09\uff0c\u5c3d\u7ba1\u4e24\u6b21\u589e\u5927\u65f6\u9650\uff0c\u8fd8\u662f\u4f1a\u8d85\u65f6\u3002   \n\u5982\u679c\u53ea\u7ed9\u9700\u8981```long long```\u7684\u53d8\u91cf\u5f00```long long```\uff0c\u867d\u7136\u4e0d\u8d85\u65f6\uff0c\u4f46\u8fd8\u662f\u6bd4\u8f83\u6162\u3002   \n\u8fd9\u65f6\u5019\u53d1\u73b0$b,d\\leq 50000$\uff0c\u90a3\u4e48\u4e00\u5171\u7684\u6392\u5217\u4e5f\u53ea\u6709$50000^2=2500000000$\u79cd\uff0c\u521a\u597d\u8d85\u51fa\u4e86int\u7684\u8303\u56f4\uff0c\u4f46\u9650\u5236\u544a\u8bc9\u6211\u4eec\uff0c\u53ea\u6709\u8f83\u5c11\u4e00\u90e8\u5206\u6570\u7b26\u5408\u6761\u4ef6\uff0c\u90a3\u6700\u5927\u7684\u7b54\u6848\u662f\u591a\u5c11\u5462\uff1f   \n\u5728$a=c=1,b=d=50000$\u65f6\uff0c\u6253\u8868\u53d1\u73b0$k=1$\u7684\u65f6\u5019\u7b54\u6848\u6700\u5927\uff0c\u4e14\u7b49\u4e8e$1519848527$\uff0c\u8fd9\u7684\u786e\u5728int\u7684\u8303\u56f4\u5185\u3002\u4e8e\u662f\u5c06\u6240\u6709\u53d8\u91cf\u5f00\u6210int\u4e0d\u4f1a\u6ea2\u51fa\u3002   \n\u8fd9\u6837\u4f18\u5316\u4e4b\u540e\u4ee3\u7801\u8fd8\u662f\u5f88\u5feb\u7684\u3002   \n\n#### \u6700\u540e\uff0c\u5728\u4ee3\u7801\u4e4b\u524d\uff0c\u795d\u5927\u5bb6NOIP/NOI/\u7701\u9009 2019 RP++   \n\n\u4ee3\u7801\uff1a\n``` cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint mu[50005];\nint sum[50005];\nint prim[50005];\nbool mark[50005];\nint cnt;\ninline int read()\n{\n\tchar x=getchar();\n\twhile(!isdigit(x))\n\t{\n\t\tx=getchar();\n\t}\n\tint ans=0;\n\twhile(isdigit(x))\n\t{\n\t\tans=ans*10+x-48;\n\t\tx=getchar();\n\t}\n\treturn ans;\n}\nvoid getmu()\n{\n\tint N=50000;\n\tmu[1]=1;\n\tfor(int i=2;i<=N;i++)\n\t{\n\t\tif(mark[i]==false)\n\t\t{\n\t\t\tprim[++cnt]=i;\n\t\t\tmu[i]=-1;\n\t\t}\n\t\tfor(int j=1;j<=cnt;j++)\n\t\t{\n\t\t\tif(i*prim[j]>N)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmark[i*prim[j]]=true;\n\t\t\tif(i%prim[j]==0)\n\t\t\t{\n\t\t\t\tmu[i*prim[j]]=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmu[i*prim[j]]=-mu[i];\n\t\t}\n\t}\n\tfor(int i=1;i<=N;i++)\n\t{\n\t\tsum[i]=sum[i-1]+mu[i];\n\t}\n}\nint work(int a,int b,int k)\n{\n\tint ans=0;\n\tint mx=a/k;\n\tint my=b/k;\n\tfor(int l=1,r;l<=min(mx,my);l=r+1)\n\t{\n\t\tr=min(mx/(mx/l),my/(my/l));\n\t\tans+=(mx/l)*(my/l)*(sum[r]-sum[l-1]);\n\t}\n//\tprintf(\"%lld %lld %lld : %lld\\n\",a,b,k,ans);\n\treturn ans;\n}\nint main()\n{\n\tgetmu();\n\tint T;\n\tcin>>T;\n\tint a,b,c,d,k;\n\tfor(int i=1;i<=T;i++)\n\t{\n\t\ta=read();\n\t\tb=read();\n\t\tc=read();\n\t\td=read();\n\t\tk=read();\n\t\tprintf(\"%d\\n\",work(b,d,k)-work(a-1,d,k)-work(b,c-1,k)+work(a-1,c-1,k));\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1550498574,
        "uid": 70780,
        "name": "wasa855",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    },
    {
        "content": "\n\u663e\u7136\uff0c\u6b64\u9898\u53ef\u7528\u5bb9\u65a5\u5316\u7b80\uff1a\n\n$$\\sum_{i=a}^b\\sum_{j=c}^d[gcd(i,j)=k]$$\n\n$$\\Rightarrow\\sum_{i=1}^b\\sum_{j=1}^d[gcd(i,j)=k]-\\sum_{i=1}^{a-1}\\sum_{j=1}^d[gcd(i,j)=k]-\\sum_{i=1}^b\\sum_{j=1}^{c-1}[gcd(i,j)=k]+\\sum_{i=1}^{a-1}\\sum_{j=1}^{c-1}[gcd(i,j)=k]$$\n\n\u5bf9\u4e8e\u6bcf\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u53ef\u4ee5\u5355\u72ec\u8ba1\u7b97\uff1a\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m[gcd(i,j)=k]$$\n\n$$\\sum_{i=1}^{\\lfloor \\frac{n}{k} \\rfloor }\\sum_{j=1}^{\\lfloor \\frac{m}{k} \\rfloor}[gcd(i,j)=1]$$\n\n$$\\sum_{i=1}^{\\lfloor \\frac{n}{k} \\rfloor }\\sum_{j=1}^{\\lfloor \\frac{m}{k} \\rfloor}\\sum_{d|gcd(i,j)}\\mu(d)$$\n\n$$\\sum_{d=1}^{min(n,m)}\\mu(d)\\sum_{i=1}^{\\lfloor \\frac{n}{kd} \\rfloor }\\sum_{j=1}^{\\lfloor \\frac{m}{kd} \\rfloor}$$\n\n$$\\sum_{d=1}^{min(n,m)}\\mu(d)\\lfloor \\frac{n}{kd} \\rfloor\\lfloor \\frac{m}{kd} \\rfloor$$\n\n\u53ef\u4ee5\u7528\u6570\u8bba\u5206\u5757$\\Theta(\\sqrt{n}~)$\u89e3\u51b3\uff0c\u603b\u590d\u6742\u5ea6\u4e3a$\\Theta(t\\sqrt{n})$\u3002\n\n\u6ce8\u610f\uff0c\u8fd9\u9053\u9898 #$define~int~~~long~long$\u4f1a\u89c1\u7956\u5b97\u7684\uff0c\u7b54\u6848\u5f00$long ~long$\u5373\u53ef\u3002\n\n\n```cpp\n#include <cstdio>\n#include <iostream>\nusing namespace std;\n\nconst int MAXN = 50000;\nint n , a , b , c , d , f[ MAXN + 5 ];\n\nint mu[ MAXN + 5 ] , prime[ MAXN + 5 ] , k;\nbool vis[ MAXN + 5 ];\nvoid sieve( ) {\n\tmu[ 1 ] = 1;\n\tfor( int i = 2 ; i <= MAXN ; i ++ ) {\n\t\tif( !vis[ i ] ) {\n\t\t\tprime[ ++ k ] = i;\n\t\t\tmu[ i ] = -1;\n\t\t}\n\t\tfor( int j = 1 ; j <= k && 1ll * i * prime[ j ] <= MAXN ; j ++ ) {\n\t\t\tvis[ i * prime[ j ] ] = 1;\n\t\t\tif( i % prime[ j ] == 0 ) break;\n\t\t\tmu[ i * prime[ j ] ] = -mu[ i ];\n\t\t}\n\t}\n\tfor( int i = 1 ; i <= MAXN ; i ++ )\n\t\tf[ i ] = f[ i - 1 ] + mu[ i ];\n}\n\nlong long solve( int n , int m ) {\n\tint d = min( n , m );\n\tlong long Ans = 0;\n\tfor( int l = 1 , r ; l <= d ; l = r + 1 ) {\n\t\tr = min( n / ( n / l ) , m / ( m / l ) );\n\t\tAns = Ans + 1ll * ( f[ r ] - f[ l - 1 ] ) * ( n / k / l ) * ( m / k / l );\n\t}\n\treturn Ans;\n}\nlong long Get( ) {\n\treturn solve( b , d ) - solve( a - 1 , d ) - solve( b , c - 1 ) + solve( a - 1 , c - 1 );\n}\n\nsigned main( ) {\n\tsieve( ); \n\tscanf(\"%d\",&n);\n\twhile( n -- ) {\n\t\tscanf(\"%d %d %d %d %d\",&a,&b,&c,&d,&k);\n\t\tprintf(\"%lld\\n\",Get( )); \n\t} \n\treturn 0;\n}\n```\n",
        "postTime": 1571750829,
        "uid": 123802,
        "name": "chihik",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2522 [HAOI2011]Problem b"
    },
    {
        "content": "[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P2522)\n\n## \u9898\u610f\u7b80\u8ff0\n\n\u6c42 $\\sum_{x=a}^{b}\\sum_{y=c}^{d}[\\gcd(x,y)=k]$\n\n## \u601d\u8def\n\u8fd9\u662f\u4e00\u79cd\u4e0d\u9700\u8981\u5bb9\u65a5\u539f\u7406\u7684\u505a\u6cd5\n\n\u6ce8\u610f\uff1a\u4ee5\u4e0b\u67ff\u5b50\u9ed8\u8ba4 $b \\leqslant d$\n\n\u628a\u67ff\u5b50\u6574\u4f53\u9664 $k$\uff0c\u5f97\n$$\\sum_{x=\\lceil \\frac{a}{k} \\rceil}^{\\lfloor\\frac{b}{k}\\rfloor}\\sum_{y=\\lceil \\frac{c}{k} \\rceil}^{\\lfloor\\frac{d}{k}\\rfloor}[\\gcd(x,y)=1]$$\n\n\u5229\u7528 $\\mu$ \u7684\u6027\u8d28 $\\sum_{d|n} \\mu(d)=[n=1]$\uff0c\u5f97\n$$\\sum_{x=\\lceil \\frac{a}{k} \\rceil}^{\\lfloor\\frac{b}{k}\\rfloor}\\sum_{y=\\lceil \\frac{c}{k} \\rceil}^{\\lfloor\\frac{d}{k}\\rfloor}\\sum_{z|\\gcd(x,y)}\\mu(z)$$\n\n\u628a\u67ff\u5b50\u6539\u4e3a\u679a\u4e3e $z$\uff0c\u5f97\n$$\\sum_{z=1}^{\\lfloor\\frac{b}{k}\\rfloor}\\mu(z)\\sum_{x=\\lceil \\frac{a}{k} \\rceil}^{\\lfloor\\frac{b}{k}\\rfloor}\\sum_{y=\\lceil \\frac{c}{k} \\rceil}^{\\lfloor\\frac{d}{k}\\rfloor}[z|\\gcd(x,y)]$$\n\n\u7531 $\\gcd$ \u7684\u6027\u8d28\uff0c\u53ef\u4ee5\u63a8\u51fa\n$$\\sum_{z=1}^{\\lfloor\\frac{b}{k}\\rfloor}\\mu(z)\\sum_{x=\\lceil \\frac{a}{k} \\rceil}^{\\lfloor\\frac{b}{k}\\rfloor}\\sum_{y=\\lceil \\frac{c}{k} \\rceil}^{\\lfloor\\frac{d}{k}\\rfloor}[z|x][z|y]$$\n\n\u53c8\u56e0\u4e3a\u4efb\u610f\u4e24\u6570 $n,m(n \\geqslant m)$ \u4e4b\u95f4\u6709 $\\lfloor\\dfrac{n}{k}\\rfloor-\\lfloor\\dfrac{m-1}{k}\\rfloor$ \u4e2a\u6570\u80fd\u88ab $k$ \u6574\u9664\uff0c\u5f97\n$$\\sum_{z=1}^{\\lfloor\\frac{b}{k}\\rfloor}\\mu(z)(\\lfloor\\frac{\\lfloor\\frac{b}{k}\\rfloor}{z}\\rfloor-\\lfloor \\frac{\\lceil \\frac{a}{k} \\rceil-1}{z} \\rfloor)(\\lfloor\\frac{\\lfloor\\frac{d}{k}\\rfloor}{z}\\rfloor-\\lfloor \\frac{\\lceil \\frac{c}{k} \\rceil-1}{z} \\rfloor)$$\n\n\u5316\u7b80\uff0c\u5f97\n\n$$\\sum_{z=1}^{\\lfloor\\frac{b}{k}\\rfloor}\\mu(z)(\\lfloor\\frac{b}{kz}\\rfloor-\\lceil \\frac{a-1}{kz} \\rceil)(\\lfloor\\frac{d}{kz}\\rfloor-\\lceil \\frac{c-1}{kz} \\rceil)$$\n\n\u9884\u5904\u7406 $\\mu$ \u7684\u524d\u7f00\u548c\uff0c\u518d\u628a\u540e\u9762\u7684\u4e00\u5927\u5768\u6574\u9664\u5206\u5757\u5c31\u53ef\u4ee5\u4e86\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n+T\\sqrt n)$\n\n\u8fd9\u4e2a\u65b9\u6cd5\u5e94\u8be5\u662f**\u7406\u8bba\u5e38\u6570\u8f83\u5c0f**\u7684\u7b97\u6cd5\uff0c\u4f46\u6211\u4eba\u6bd4\u8f83\u50bb\uff0c\u8fde\u7b2c\u4e00\u9875\u90fd\u6324\u4e0d\u8fdb\u53bb\n\nCode\uff1a\n\n```cpp\n#include <iostream>\nconst int MAXN = 50000;\nint Prime[5200], size, sum[MAXN + 5];\n//Prime[i]=\u7b2ci\u4e2a\u8d28\u6570\uff0csize=\u5f53\u524d\u7b5b\u51fa\u7684\u8d28\u6570\u6570\u91cf\uff0csum[i]=mu[1]+mu[2]+...+mu[i] \nbool mark[MAXN + 5]; //mark[i]=true\u8868\u793ai\u4e3a\u5408\u6570\uff0c\u53cd\u4e4b\u4e3a\u8d28\u6570 \n\nvoid sieve(int n) { //\u6b27\u62c9\u7b5b\u9884\u5904\u7406mu \n\tmark[1] = true;\n\tsum[1] = 1;\n\t//\u7279\u52241 \n\tfor(int i = 2; i <= n; ++i) {\n\t\tif(mark[i] == false) { //\u82e5mark[i]\u672a\u88ab\u7b5b\u6389 \n\t\t\tPrime[size++] = i; //\u52a0\u5165\u8d28\u6570\u8868 \n\t\t\tsum[i] = -1; //\u4e3a\u4e86\u8282\u7701\u7a7a\u95f4\uff0c\u6211\u628amu[]\u4e0esum[]\u5408\u5e76\n\t\t\t//\u8fd9\u4e2asum[i]\u5c31\u662fmu[i] \n\t\t}\n\t\tfor(int j = 0; j < size && i*Prime[j] <= n; ++j) {\n\t\t\tmark[i*Prime[j]] = true; //\u7b5b\u53bb \n\t\t\tif(i%Prime[j] == 0) break;\n\t\t\t//\u6ce8\u610f\uff0c\u8fd9\u53e5\u8bdd\u5fc5\u987b\u5728break\u540e\n\t\t\t//\u56e0\u4e3abreak\u5c31\u4ee3\u8868i*Prime[j]\u6709\u91cd\u590d\u7684\u8d28\u56e0\u5b50\uff0c\u6b64\u65f6mu[i*Prime[j]]=0 \n\t\t\tsum[i*Prime[j]] = -sum[i]; //\u8d28\u56e0\u5b50\u6570\u91cf\u589e\u52a0\uff0c\u6545\u4e3a\u539f\u6765\u7684-1\u500d \n\t\t}\n\t\tsum[i] += sum[i - 1]; //\u8fd9\u65f6sum[i]\u4e0d\u4f1a\u518d\u6539\u53d8\u4e86\uff0c\u53e0\u52a0\u524d\u7f00\u548c \n\t}\n}\n\n//\u4e3a\u4e86\u5361\u5e38\u800c\u751f\u76843\u4e2a\u51fd\u6570 \ninline int Min(int a, int b)\n{ return a < b ? a : b; }\n\ninline void swap(int& a, int& b) {\n\ta ^= b;\n\tb ^= a;\n\ta ^= b;\n}\n\ninline void equal_min(int& a, int b)\n{ if(a > b) a = b; }\n\nint solve(int a, int b, int c, int d, int k) {\n\tif(b > d) { //\u4e3a\u4e86\u4fdd\u8bc1b<=d \n\t\tswap(a, c);\n\t\tswap(b, d);\n\t}\n\ta = (a - 1)/k, b /= k, c = (c - 1)/k, d /= k; //\u90fd\u9664\u4ee5k\uff0c\u51cf\u5c0f\u5e38\u6570 \n\tint ans = 0;\n\tfor(int i = 1, ni; i <= b; i = ni + 1) { //ni\u8868\u793a\u4e0b\u4e00\u4e2ai \n\t\tni = Min(b/(b/i), d/(d/i)); //\u53d6\u6700\u5c0f\u503c\uff0c\u5426\u5219\u4e24\u4e2a\u5757\u53ef\u80fd\u4e0d\u4e00\u6837\u5927\uff08\u201c\u6728\u6876\u6548\u5e94\u201d\uff09 \n\t\tif(a >= i) equal_min(ni, a/(a/i));\n\t\tif(c >= i) equal_min(ni, c/(c/i));\n\t\t//\u8fd9\u4e24\u4e2aif\u662f\u4e3a\u4e86\u907f\u514d\u9664\u4ee50\u800c\u5bfc\u81f4RE \n\t\tans += (sum[ni] - sum[i - 1])*(b/i - a/i)*(d/i - c/i);\n\t}\n\treturn ans;\n}\n\nint main() {\n\tstd::ios_base::sync_with_stdio(false);\n\tstd::cin.tie(0), std::cout.tie(0); //\u52a0\u901fcin,cout \n\tsieve(MAXN); //\u6b27\u62c9\u7b5b \n\tint n, k, a, b, c, d;\n\tstd::cin >> n;\n\twhile(n--) {\n\t\tstd::cin >> a >> b >> c >> d >> k;\n\t\tstd::cout << solve(a, b, c, d, k) << \"\\n\";\n\t}\n\treturn 0;\n}\n```\n\n\u6700\u540e\u9644\u4e0a2\u9053\u7ec3\u4e60\u9898\uff1a\n\n[[POI2007]ZAP-Queries](https://www.luogu.com.cn/problem/P3455)\n\n[YY\u7684GCD](https://www.luogu.com.cn/problem/P2257)\n\n\u4e2a\u4eba\u8ba4\u4e3a\u7684\u96be\u5ea6\u6392\u5e8f\uff1a\n\n[POI2007]ZAP-Queries < [HAOI2011]Problem b < YY\u7684GCD",
        "postTime": 1588478788,
        "uid": 225734,
        "name": "derta",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    },
    {
        "content": "\u5b66\u4e60\u5927\u4f6c\u8d34[\u535a\u5ba2](https://www.luogu.com.cn/blog/Ye-Star/)\uff0c\u5982\u679c\u9898\u89e3\u53c8\u70b8\u4e86\u90a3\u5c31\u53bb\u535a\u5ba2\u770b\u5427\u3002QAQ\n- \u9898\u610f\n\n\u6c42$\\sum\\limits_{i=a}^b\\sum\\limits_{j=c}^d[gcd(i,j)=d]$\n\n- \u53cd\u6f14\n\n\u6bd4\u8d77\u4e0a\u5f0f\uff0c\u6211\u4eec\u66f4\u5bb9\u6613\u5f97\u51fa\n\n$ans(n,m)=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m[gcd(i,j)=d]$\n\n\u7684\u503c  \n\n$\\because [gcd(i,j)=d]$\n\n$\\therefore \\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m[gcd(i,j)=d]=\\sum\\limits_{i=1}^{n/d}\\sum\\limits_{j=1}^{m/d}[gcd(i,j)=1]$\n\n\u8bbe\uff1a\n\n$f(x)=\\sum\\limits_{i=1}^{n/d}\\sum\\limits_{j=1}^{m/d}[gcd(i,j)=x]$\n\n$g(x)=\\sum\\limits_{i=1}^{n/d}\\sum\\limits_{j=1}^{m/d}[x|gcd(i,j)]$\n\n$f(x)$\u8868\u793a\u6700\u5927\u516c\u56e0\u6570\u662f$x$\u7684\u70b9\u5bf9\n\n$g(x)$\u8868\u793a\u516c\u56e0\u6570\u662f$x$\u7684\u70b9\u5bf9\n\n\u663e\u7136\u6709\uff1a\n\n$g(x)=\\sum\\limits_{x|k,k \\le n}f(x)$\n\n~~\u4e00\u6ce2~~\u53cd\u6f14~~\u731b\u5982\u864e~~\uff1a\n\n$f(x)=\\sum\\limits_{x|k}f(x)\\mu(\\frac{k}{x})\\iff f(x)=\\sum\\limits_{x|k}\\mu(x)f(\\frac{k}{x})$\n\n$g(x)=\\sum\\limits_{i=1}^{n/d}\\sum\\limits_{j=1}^{m/d}[x|gcd(i,j)]$\n\n$=\\sum\\limits_{i=1}^{\\frac{n}{dx}}\\sum\\limits_{j=1}^{\\frac{m}{dx}}[1|gcd(i,j)]$\n\n$=\\sum\\limits_{i=1}^{\\frac{n}{dx}}\\sum\\limits_{j=1}^{\\frac{m}{dx}}1$\n\n$=\\lfloor\\frac{n}{dx}\\rfloor\\cdot\\lfloor\\frac{m}{dx}\\rfloor$\n\n\u6545\uff1a\n\n$ans(n,m)=f(1)=\\sum\\limits_{i=1}^n\\mu(i)\\lfloor\\frac{n}{dx}\\rfloor\\lfloor\\frac{m}{dx}\\rfloor$\n\n- \u6c42\u89e3\n\n\u6211\u4eec\u8981\u6c42$\\sum\\limits_{i=a}^b\\sum\\limits_{j=c}^d[gcd(i,j)=d]$  \n\u76f4\u63a5\u6c42\u4e0d\u597d\u6c42\uff0c\u90a3\u54b1\u5c31\u95f4\u63a5\u6c42   \n\u95f4\u63a5\u6c42\u5c31\u8003\u8651\u5bb9\u65a5\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ldxqgbgr.png)\n\n\n\u9ed1\u5708\uff1a$ans(b,d)$  \n\u7ea2\u5708\uff1a$ans(a-1,d)$  \n\u7eff\u5708\uff1a$ans(c-1,b)$  \n\u7d2b\u8272\u90e8\u5206\uff08\u7ea2\u7eff\u4ea4\u96c6\uff09\uff1a$ans(a-1,c-1)$   \n\u84dd\u8272\u90e8\u5206\uff08\u7b54\u6848\uff09\uff1a$ans(b,d)-ans(a-1,d)-ans(c-1,b)+ans(a-1,c-1)$ \n\n\n\u6570\u8bba\u5206\u5757\u4e00\u4e0b\u5c31\u53ef\u4ee5$O(\\sqrt{n})$\u505a\u5b8c\u5566\uff01    \n\u5206\u5757\u4e0d\u4f1a\u7684\u8bdd[[P1403]](https://www.luogu.com.cn/problem/P1403)\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=5e4+5;\n#define ll long long\nll prime[maxn],mu[maxn],sum[maxn],cnt;\nbool used[maxn];\ninline int read()//\u5feb\u8bfb\n{\n    int x=0;\n    int p=1;\n    char c=getchar();\n    while(c<'0'||c>'9'){if(c=='-')p=-1;c=getchar();}\n    while(c>='0'&&c<='9') {x=(x<<1)+(x<<3)+(c-48);c=getchar();}\n    return x*=p;   \n}\nvoid get_mu()//\u7b5bmu\n{\n    mu[1]=1;\n    for(register int i=2;i<=maxn;i++)\n    {\n        if(!used[i]){mu[i]=-1;prime[++cnt]=i;}\n        for(register int j=1;j<=cnt&&i*prime[j]<=maxn;++j)\n        {\n            used[i*prime[j]]=1;\n            if(i%prime[j]==0)break;\n            else mu[i*prime[j]]=-mu[i];\n        }\n    }\n    for(register int i=1;i<=maxn;++i)sum[i]=sum[i-1]+mu[i];\n}\nll getans(int a,int b,int k)//\u5206\u5757\n{\n    if(a==0||b==0)return 0;\n    if(a>b)swap(a,b);\n    ll ans=0,g=a;\n    for(register int l=1,r;l<=g;l=r+1)\n    {\n        r=min(a/(a/l),b/(b/l));\n        ans+=(long long)(a/(l*k))*(b/(l*k))*(sum[r]-sum[l-1]);\n    }\n    return ans;\n}\nvoid work()\n{\n    int a;int b;int c;int d;int k;\n    a=read(),b=read(),c=read(),d=read(),k=read();\n    //\u5f0f\u5b50\u5728\u9898\u89e3\u91cc\u5199\u4e86\n    printf(\"%lld\\n\",getans(b,d,k)-getans(a-1,d,k)-getans(b,c-1,k)+getans(a-1,c-1,k));\n}\nint main()\n{\n    int t;\n    t=read();\n    get_mu();\n    while(t--)work();//\u591a\u7ec4\u6570\u636e\n    return 0;\n}\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "postTime": 1588225995,
        "uid": 115855,
        "name": "Yyxxxxx",
        "ccfLevel": 4,
        "title": "P2522[HAOI2011]\u9898\u89e3"
    },
    {
        "content": "## [\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P2522)\n\n## \u9898\u610f\n\n\u6709$n$\u7ec4\u8be2\u95ee\uff0c\u6bcf\u6b21\u7ed9\u51fa$a,b,c,d,k$\uff0c\u6c42$\\sum\\limits_{x=a}^{b}\\sum\\limits_{y=c}^{d}[\\gcd(x,y)=k]$ \n\n## \u601d\u8def\n\n> \u5bb9\u65a5\u539f\u7406+\u6570\u8bba\u5206\u5757+\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n\n\u6211\u505a\u7684\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u7b2c\u4e00\u9053\u9898= =\n\n\u8bbe$f(n,m)=\\sum\\limits_{i=1}^{n}\\sum\\limits_{j= 1}^{m}[\\gcd(i,j)=k]$\n\n\u90a3\u4e48\u6839\u636e\u5bb9\u65a5\u539f\u7406\uff0c\u9898\u76ee\u4e2d\u7684\u5f0f\u5b50\u5c31\u8f6c\u5316\u6210\u4e86$f(b,d)-f(b, c - 1) - f(a - 1,d) + f(a - 1, c - 1)$\n\n\u6240\u4ee5\u6211\u4eec\u63a5\u4e0b\u6765\u7684\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a\u4e86\u5982\u4f55\u6c42$f$\u7684\u503c\n\n\u73b0\u5728\u6765\u5316\u7b80$f$\u7684\u503c\n\n1. \u5bb9\u6613\u5f97\u51fa\u539f\u5f0f\u7b49\u4ef7\u4e8e$$\\sum\\limits_{i = 1}^{\\lfloor\\frac{n}{k}\\rfloor}\\sum\\limits_{j = 1}^{\\lfloor\\frac{m}{k}\\rfloor}[\\gcd(i,j) = 1]$$\n\n2. \u56e0\u4e3a$\\epsilon(n) =\\sum\\limits_{d|n}\\mu(d)=[n=1]$\uff0c\u7531\u6b64\u53ef\u5c06\u539f\u5f0f\u5316\u4e3a$$\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{k}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{m}{k}\\rfloor}\\sum\\limits_{d|gcd(i,j)}\\mu(d)$$\n\n3. \u6539\u53d8\u679a\u4e3e\u5bf9\u8c61\u5e76\u6539\u53d8\u679a\u4e3e\u987a\u5e8f\uff0c\u5148\u679a\u4e3e$d$\uff0c\u5f97$$\\sum\\limits_{d=1}^{\\min(n,m)}\\mu(d)\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{k}\\rfloor}[d|i]\\sum\\limits_{j=1}^{\\lfloor\\frac{m}{k}\\rfloor}[d|j]$$\n\n   \u4e5f\u5c31\u662f\u8bf4\u5f53$d|i$\u4e14$d|j$\u65f6\uff0c$d|\\gcd(i,j)$\n\n4. \u6613\u5f97$1\\sim \\lfloor\\frac{n}{k}\\rfloor$\u4e2d\u4e00\u5171\u6709$\\lfloor\\frac{n}{dk}\\rfloor$\u4e2a$d$\u7684\u500d\u6570\uff0c\u540c\u7406$1\\sim \\lfloor\\frac{m}{k}\\rfloor$\u4e2d\u4e00\u5171\u6709$\\lfloor\\frac{m}{dk}\\rfloor$\u4e2a$d$\u7684\u500d\u6570\uff0c\u4e8e\u662f\u539f\u5f0f\u5316\u4e3a$$\\sum\\limits_{d=1}^{\\min(n,m)}\\mu(d)\\lfloor\\frac{n}{dk}\\rfloor\\lfloor\\frac{m}{dk}\\rfloor$$\n\n\u6b64\u65f6\u5df2\u7ecf\u53ef\u4ee5$O(n)$\u6c42\u89e3\uff0c\u4f46\u662f\u8fc7\u4e0d\u4e86\uff0c\u56e0\u4e3a\u6709\u5f88\u591a\u503c\u76f8\u540c\u7684\u533a\u95f4\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u6570\u8bba\u5206\u5757\u6765\u505a\n\n\u5148\u9884\u5904\u7406$\\mu$\uff0c\u518d\u7528\u6570\u8bba\u5206\u5757\uff0c\u590d\u6742\u5ea6$O(n+T\\sqrt n)$\n\n\u6211\u7684\u4ee3\u7801\u6bcf\u6b21\u5f97\u5206\u7384\u5b66\uff0c\u770b\u8bc4\u6d4b\u673a\u5fc3\u60c5\uff0c\u5efa\u8bae\u81ea\u5df1\u5199\n\n## \u4ee3\u7801\n\n```cpp\n/*\nAuthor:loceaner\n*/\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\n\nconst int A = 1e6 + 11;\nconst int B = 1e6 + 11;\nconst int mod = 1e9 + 7;\nconst int inf = 0x3f3f3f3f;\n\ninline int read() {\n\tchar c = getchar(); int x = 0, f = 1;\n\tfor( ; !isdigit(c); c = getchar()) if(c == '-') f = -1;\n\tfor( ; isdigit(c); c = getchar()) x = x * 10 + (c ^ 48);\n\treturn x * f;\n}\n\nint n, a, b, c, d, k, cnt, p[A], mu[A], sum[A];\nbool vis[A];\n\nvoid getmu() {\n\tint MAX = 50010;\n\tmu[1] = 1;\n\tfor (int i = 2; i <= MAX; i++) {\n\t\tif (!vis[i]) mu[i] = -1, p[++cnt] = i;\n\t\tfor (int j = 1; j <= cnt && i * p[j] <= MAX; j++) {\n\t\t\tvis[i * p[j]] = true;\n\t\t\tif (i % p[j] == 0) break;\n\t\t\tmu[i * p[j]] -= mu[i];\n\t\t}\n\t}\n\tfor (int i = 1; i <= MAX; i++) sum[i] = sum[i - 1] + mu[i];\n}\n\nint work(int x, int y) {\n\tint ans = 0ll;\n\tint max = min(x, y);\n\tfor (int l = 1, r; l <= max; l = r + 1) {\n\t\tr = min(x / (x / l), y / (y / l));\n\t\tans += (1ll * x / (l * k)) * (1ll * y / (l * k)) * 1ll * (sum[r] - sum[l - 1]); \n\t}\n\treturn ans;\n}\n\nvoid solve() {\n\ta = read(), b = read(), c = read(), d = read(), k = read();\n\tcout << work(b, d) - work(a - 1, d) - work(b, c - 1) + work(a - 1, c - 1) << '\\n';\n}\n\nsigned main() {\n\tgetmu();\n\tint T = read();\n\twhile (T--) solve();\n\treturn 0;\n}\n\n```",
        "postTime": 1587083626,
        "uid": 198323,
        "name": "loceaner",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    },
    {
        "content": "\u6700\u8fd1\u5f00\u59cb\u5b66\u4e60\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570,\u548c\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14,\u8fd9\u4e9b\u9898\u90fd\u597d\u96be\u554a.\n\n\u8fd9\u4e00\u9053\u603b\u7b97\u662f\u4e00\u9053\u6bd4\u8f83\u7b80\u5355\u7684.\n\n\u4ee5\u4e0b\u662f\u63a8\u5bfc\u8fc7\u7a0b:\n\n\u6211\u4eec\u8981\u6c42\u7684\u662f\n$$ans = \\sum_{ a\\leq i \\leq b}\\sum_{c\\leq j \\leq d}[gcd(i,j) = k]$$\n\n\u6211\u4eec\u7528\u4e00\u4e2a\u800c\u4e3a\u524d\u7f00\u548c\uff0c\u8f6c\u5316\u4e3a\u6c42\n$$ans = \\sum^n_{i = 1}\\sum^m_{j = 1}[gcd(i,j) = k]$$\n\n\u6d88\u53bb$i$\u548c$j$\u7684\u6700\u5927\u516c\u7ea6\u6570$k$,\u5f97\u5230\n$$ans = \\sum^{\\lfloor\\frac{n}{k} \\rfloor}_{i = 1}\\sum^{\\lfloor\\frac{m}{k} \\rfloor}_{j = 1}[gcd(i,j) = 1]$$\n\n\u56e0\u4e3a\u5f53\u4e14\u4ec5\u5f53$gcd(i,j) = 1$\u65f6,\u65b9\u62ec\u53f7\u7684\u503c\u4e3a1,\u5426\u5219\u4e3a0,\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u7684\u6027\u8d28\uff0c\u5f97\u5230\n\n$$ans = \\sum^{\\lfloor\\frac{n}{k} \\rfloor}_{i = 1}\\sum^{\\lfloor\\frac{m}{k} \\rfloor}_{j = 1}\\sum_{d|gcd(i,j)}\\mu(d)$$\n\n\u6539\u53d8\u4e00\u4e0b\u679a\u4e3e\u7684\u5bf9\u8c61,\u4e0d\u662f\u679a\u4e3e$i$\u548c$j$,\u800c\u662f\u679a\u4e3e$d$,\u6539\u53d8\u679a\u4e3e\u987a\u5e8f,\u5f97\u5230\n$$ans = \\sum_{d = 1}^{min(n,m)}\\mu(d)\\sum_{dki \\leq n}\\sum_{dkj \\leq m}1$$\n\u5373\n$$ans =\\sum_{d = 1}^{min(n,m)}\\mu(d)\\lfloor\\frac{n}{kd} \\rfloor\\lfloor\\frac{m}{kd} \\rfloor$$\n\n\u8fd9\u65f6\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(n)$,\u5bf9\u4e8e\u6709\u591a\u7ec4\u6570\u636e\u7684\u9898\u76ee\u8fd8\u662f\u7565\u6162\uff0c\u6709\u6ca1\u6709\u7ee7\u7eed\u4f18\u5316\u7684\u4f59\u5730?\n\n\u8fd9\u65f6\u5019\u6211\u4eec\u53d1\u73b0:\u6709\u8bb8\u591a\u7684$\\lfloor \\frac{n}{i}\\rfloor$\u7684\u503c\u662f\u76f8\u7b49\u7684,\u800c\u4e14\u5b83\u4eec\u662f\u8fde\u7eed\u7684\u4e00\u6bb5\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u7528\u5230\u6570\u8bba\u4e2d\u4e00\u4e2a\u5f88\u597d\u7528\u7684\u6280\u5de7-------\u6574\u9664\u5206\u5757,\u53ef\u4ee5\u5c06\u65f6\u95f4\u590d\u6742\u5ea6\u8fdb\u4e00\u6b65\u964d\u4f4e\u5230$O(\\sqrt n)$,\u5c31\u53ef\u4ee5AC\u4e86.\n \ncode:\n```cpp\nint n,m,k;\nint mu[50000 + 5];\nint is_prime[50000 + 5];\nint prime[50000 + 5];\n\nvoid get_mu(){\n    int tot = 0;\n    mu[1] = 1;\n    for(int i = 2; i <= 50000; ++i) {\n        if(!is_prime[i]) prime[++tot] = i, mu[i] = -1;\n        for(int j = 1; j <= tot; ++j) {\n            if(prime[j] > 50000 / i) break;\n            is_prime[i * prime[j]] = 1;\n            if(i % prime[j] == 0) {\n                mu[i * prime[j]] = 0;\n                break;\n            }\n            mu[i * prime[j]] = -mu[i];\n        }\n    }\n    for(int i = 1; i <= 50000; ++i) mu[i] += mu[i - 1];\n}\n\n\nll solve(int n,int m){\n    ll ans = 0;\n    for(int d = 1,next_d;d * k <= min(n,m);d = next_d + 1){\n        next_d = min(\n            n / (n / d),\n            m / (m / d)\n        );\n        ans += (ll)(mu[next_d] - mu[d - 1]) * (n / k / d) * (m / k / d);\n    }\n    return ans;\n}\n// completed\nint main(){\n    get_mu();\n    int T = read();\n    while(T--){\n        int a = read();\n        int b = read();\n        int c = read();\n        int d = read();\n        k = read();\n        cout<<(solve(b,d) - solve(b,c - 1) - solve(a - 1,d) + solve(a - 1,c - 1))<<endl;\n    }\n    return 0;\n}\n```",
        "postTime": 1554552401,
        "uid": 111847,
        "name": "Colin_Lovecraft",
        "ccfLevel": 0,
        "title": "P2522 [HAOI2011]Problem b(\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14)"
    },
    {
        "content": "### Description \n\n\u6c42\u6709\u591a\u5c11\u4e2a\u6570\u5bf9 $(x,y)$ \uff0c\u6ee1\u8db3$ a \\leq x \\leq b$ \uff0c$c \\leq y \\leq d$ \uff0c\u4e14 $\\gcd(x,y) = k$\uff0c$\\gcd(x,y)$\u51fd\u6570\u4e3a $x$ \u548c $y$ \u7684\u6700\u5927\u516c\u7ea6\u6570\u3002\u591a\u7ec4\u8be2\u95ee\u3002$a,b,c,d,k,T \\leq 50000$\n\n### Solution\n\n\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u7ecf\u5178\u9898\u76eeQAQ\n\n\u9996\u76f8\u5c06\u95ee\u9898\u8f6c\u5316\u6210\u524d\u7f00\u4e0a\u7684\u95ee\u9898\u3002\u5373\u9700\u8981\u6c42\u51fa \u6709\u591a\u5c11\u4e2a\u6570\u5bf9 $(x,y)$ \uff0c\u6ee1\u8db3$ 1 \\leq x \\leq a$ \uff0c$1 \\leq y \\leq b$ \uff0c\u4e14 $\\gcd(x,y) = k$\u3002\u5982\u679c\u80fd\u591f\u5feb\u901f\u7b97\u51fa\u6765\u8fd9\u4e2a\uff0c\u5bb9\u65a5\u4e00\u4e0b\u5c31\u53ef\u4ee5\u6c42\u51fa\u6700\u540e\u7b54\u6848\u3002\n\n\u8003\u8651\u8fd9\u4e2a\u600e\u4e48\u6c42\uff0c\u5f00\u59cb\u63a8\u5f0f\u5b50\u3002\u8fd9\u4e2a\u4e1c\u897f\u663e\u7136\u5c31\u662f\n\n$$\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{m}[\\gcd(i,j)=k]$$\n\n\u628a $k$ \u63d0\u51fa\u6765\u53ef\u5f97\n\n$$\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{k}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{m}{k}\\rfloor}[\\gcd(i, j)=1]$$\n\n\u7136\u540e\u628a\u540e\u9762\u8fd9\u4e2a $[\\gcd(i,j)=1]$ \u53cd\u6f14\u6389\uff0c\u5f97\n\n$$\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{k}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{m}{k}\\rfloor}\\sum\\limits_{d|\\gcd(i,j)}\\mu(d)$$\n\n\u628a $d$ \u641e\u5230\u524d\u9762\u6765\uff0c\u5f97\u5230\n\n$$\\sum\\limits_{d=1}^{\\lfloor \\frac{n}{k} \\rfloor} \\mu(d)\\lfloor \\frac{n}{kd} \\rfloor\\lfloor \\frac{m}{kd} \\rfloor$$\n\n\u597d\u4e86\uff0c\u8fd9\u4e2a\u73a9\u610f\u53ef\u4ee5\u9884\u5904\u7406\u51fa $\\mu$ \u5f97\u524d\u7f00\u548c\u7136\u540e\u5206\u5757\u5b8c\u4e8b\u3002\n\n### Code \n[\u770b\u4ee3\u7801\u6233\u8fd9\u91cc](https://www.cnblogs.com/acfunction/p/10127599.html)",
        "postTime": 1544958649,
        "uid": 54745,
        "name": "Gypsophila",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    },
    {
        "content": "[..........](https://blog.luojinyao.top/post/2c9e796c.html)  \n$f(i)$\u8868\u793a$x\\in[1,n]$\uff0c$y\\in[1,m]$\u4e14$gcd(x,y)=i$\u7684\u6570\u5bf9$(x,y)$\u6570\u91cf  \n$F(i)$\u8868\u793a$x\\in[1,n]$\uff0c$y\\in[1,m]$\u4e14$i|gcd(x,y)$\u7684\u6570\u5bf9$(x,y$\u6570\u91cf  \n$$F(i)=\\sum_{i|d}f(d)=\\lfloor\\frac{n}{i}\\rfloor\\lfloor\\frac{m}{i}\\rfloor$$\n\u53cd\u6f14$F$\u51fd\u6570\u5f97\u5230\uff1a  \n$$f(i)=\\sum_{i|d}\\mu(\\frac{d}{i})F(d)=\\sum_{i|d}\\mu(\\frac{d}{i})\\cdot \\lfloor\\frac{n}{d}\\rfloor\\lfloor\\frac{m}{d}\\rfloor$$\n$O(50000n)$\u8fd8\u8fc7\u4e0d\u4e86\u9898\u76ee\uff0c\u5206\u5757\u6c42\u540e\u9762\u90e8\u5206\u5c31\u80fd\u8fbe\u5230\u4f18\u79c0\u7684$O(nsqrt(50000))$\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<iostream>\n#include<cstring>\n#include<map>\n#include<bitset>\n#define mk make_pair\n#define fi first\n#define nd second\n#define pii pair<int,int>\n#define pb push_back\n#define sqr(x) ((x)*(x))\nusing namespace std;\ntypedef long long ll;\ninline ll read() {ll x = 0; char ch = getchar(), w = 1;while(ch < '0' || ch > '9') {if(ch == '-') w = -1;\nch = getchar();}while(ch >= '0' && ch <= '9') {x = x * 10 + ch - '0';ch = getchar();}return x * w;}\nvoid write(ll x) {if(x < 0) putchar('-'), x = -x;if(x > 9) write(x / 10);putchar(x % 10 + '0');}\ninline void writeln(ll x) {write(x);puts(\"\");}\nint k;\nconst int N = 61000;\nint miu[N];\nbool v[N];\nint p[N], tot;\nvoid pre() {\n\tmiu[1] = 1;\n\tfor(int i = 2; i <= 50000; ++i) {\n\t\tif(!v[i]) p[++tot] = i, miu[i] = -1;\n\t\tfor(int j = 1; j <= tot; ++j) {\n\t\t\tif(p[j] > 50000/ i) break;\n\t\t\tv[i * p[j]] = 1;\n\t\t\tif(i % p[j] == 0) {\n\t\t\t\tmiu[i * p[j]] = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmiu[i * p[j]] = -miu[i];\n\t\t}\n\t}\n\tfor(int i = 1; i <= 50000; ++i) miu[i] += miu[i - 1];\n}\nll solve(int n, int m) {\n\tll res = 0;\n\t/*for(int i = k; i <= min(n, m); i += k)\n\t\tres += miu[i / k] * (n / i) * (m / i);*/\n\t//printf(\"n=%d,m=%d\\n\",n,m);\n\tfor(int i = 1, r; i * k <= min(n, m); i = r + 1) {\n\t\tr = min(n / (n / i), m / (m / i));\n\t\tres += (ll)(miu[r] - miu[i - 1]) * (n / k / i) * (m / k / i);\n\t\t//printf(\"i=%d,r=%d,%d\\n\", i, r,(miu[r] - miu[i - 1]) * (n / i) * (m / i));\n\t}\n\treturn res;\n}\n\nint main() {\n\tpre();\n\tint T = read();\n\twhile(T--) {\n\t\tint a = read(), b = read(), c = read(), d = read();\n\t\tk = read();\n\t\twriteln(solve(b,d) - solve(b, c - 1) - solve(a - 1, d) + solve(a - 1, c - 1));\t\t\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1547083217,
        "uid": 22150,
        "name": "\u548c\u5176\u6b63",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    },
    {
        "content": "## \u9898\u76ee\u63cf\u8ff0\n\n\u6709$T$\u7ec4\u8be2\u95ee\uff0c\u6bcf\u6b21\u7ed9\u5b9a\u6574\u6570$a,b,c,d,k$\uff0c\u6c42\u6709\u591a\u5c11\u5bf9\u6b63\u6574\u6570$x,y$\uff0c\u6ee1\u8db3$a \\le x \\le b \\wedge c \\le y \\le d \\wedge (x,y)=k$\n\n$1 \\le a,b,c,d,k,T \\le 50000 \\wedge a \\le b \\wedge c \\le d$\n\n## \u9898\u89e3\n\n\u4e0d\u59a8\u8003\u8651$x \\le a, y \\le b$\u7684\u60c5\u51b5\uff08\u5373bzoj 1101\uff09\uff0c\u7136\u540e\u4e8c\u7ef4\u524d\u7f00\u548c\u5bb9\u65a5\u4e00\u4e0b\u5c31\u597d\u4e86\n\n$\\begin{aligned}a \\le b \\\\\\sum_{i=1}^{a}\\sum_{j=1}^{b}[(i,j)=d] &=\\sum_{i=1}^{\\lfloor \\frac{a}{d} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{b}{d} \\rfloor}[(i,j)=1] \\\\&=\\sum_{i=1}^{\\lfloor \\frac{a}{d} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{b}{d} \\rfloor}\\sum_{d' \\mid (i,j)}\\mu(d') \\\\&=\\sum_{i=1}^{\\lfloor \\frac{a}{d} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{b}{d} \\rfloor}\\sum_{d' \\mid i \\wedge d' \\mid j}\\mu(d') \\\\&=\\sum_{d'=1}^{\\lfloor \\frac{a}{d} \\rfloor}\\mu(d')\\sum_{d' \\mid i}^{\\lfloor \\frac{a}{d} \\rfloor}\\sum_{d' \\mid j}^{\\lfloor \\frac{b}{d} \\rfloor}1 \\\\&=\\sum_{d'=1}^{\\lfloor \\frac{a}{d} \\rfloor}\\mu(d') \\lfloor \\frac{a}{dd'} \\rfloor \\lfloor \\frac{b}{dd'} \\rfloor\\end{aligned}$\n\n$\\lfloor \\frac{a}{dd'} \\rfloor \\lfloor \\frac{b}{dd'} \\rfloor$\u7684\u53d6\u503c\u53ea\u6709$O(\\sqrt a + \\sqrt b)$\u79cd\uff0c\u9884\u5904\u7406$\\mu$\u7684\u524d\u7f00\u548c\uff0c\u5355\u6b21\u8be2\u95ee\u53ef\u4ee5$O(\\sqrt n)$\u8ba1\u7b97\n\n## \u4ee3\u7801\n\n``` cpp\n#include \"bits/stdc++.h\"\nusing namespace std;\ntypedef long long ll;\nconst int N = 50000 + 10;\n\nint mu[N], vis[N], p[N], tot;\n\nll sol(int n, int m, int d) {\n    ll ans = 0;\n    if(n > m) swap(n, m);\n    n /= d, m /= d;\n    for(int i = 1, j ; i <= n ; i = j + 1) {\n        j = min(n / (n / i), m / (m / i));\n        ans += (ll) (mu[j] - mu[i - 1]) * (n / i) * (m / i);\n    }\n    return ans;\n}\n\nvoid sol() {\n    int a, b, c, d, k; scanf(\"%d%d%d%d%d\", &a, &b, &c, &d, &k);\n    ll ans = sol(b, d, k) + sol(a - 1, c - 1, k) - sol(a - 1, d, k) - sol(b, c - 1, k);\n    printf(\"%lld\\n\", ans);\n}\n\nint main() {\n    mu[1] = 1;\n    for(int i = 2 ; i <= 50000 ; ++ i) {\n        if(!vis[i]) mu[i] = -1, p[++ tot] = i;\n        for(int j = 1 ; j <= tot && (ll) i * p[j] <= 50000 ; ++ j) {\n            vis[i * p[j]] = 1;\n            if(i % p[j] == 0) break;\n            mu[i * p[j]] = -mu[i];\n        }\n        mu[i] += mu[i - 1];\n    }\n    int T; scanf(\"%d\", &T);\n    while(T --) sol();\n}\n```\n\n\n",
        "postTime": 1530754384,
        "uid": 47111,
        "name": "nekko",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    },
    {
        "content": "\u6700\u8fd1\u5728\u5b66\u4e60\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u7ec8\u4e8e\u770b\u5230\u4e00\u9053\u88f8\u9898\u53ef\u4ee5\u8ba9\u6211A\u6389\u4e86\n\n\u8be2\u95ee a\u2264x\u2264b\uff0cc\u2264y\u2264d\uff0c\u4e14gcd(x,y) = k \u7684\u4e2a\u6570\n\n\u5373$F(a, b, c, d) = \\sum_a^b{x}\\sum_c^d{y}[gcd(x, y) == k]$\n\n\n\u5f88\u660e\u663e\u6211\u4eec\u53ef\u4ee5\u7528\u5bb9\u65a5\u8f6c\u6362\u6210\n\n$F(a, b, c, d)= F(1, b, 1, d) - F(1, b, 1, c - 1) - F(1, a - 1, 1, d) + F(1, a - 1, 1, c - 1)$\n\n\n\u6240\u4ee5\u53ea\u9700\u8981\u6c42\u51fa:\n\n\n$f(k, b, d) = \\sum_1^b{x}\\sum_1^d{y}[gcd(x, y) == k]$\n\n\n\u901a\u8fc7\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14:\n\n\n$f(k, b, d) =  \\sum_ {k | t} g(t)\u03bc(t / k)$\n\n\n\u6240\u4ee5\n\n$f(k, b, d) =  \\sum_ {k | x}\u03bc(\\frac{x}{k}){[\\frac{b}{x}]}[\\frac{d}{x}]$\n\n\n$   =  \\sum_ {i = 1}^{[\\frac{n}{k}]}\u03bc(i){[\\frac{\\frac{b}{k}}{i}]}[\\frac{\\frac{d}{k}}{i}]$\n\n\n\n\u7136\u540e\u9884\u5904\u7406\u03bc(n)\u7684\u524d\u7f00\u548c\uff0c\u540e\u9762\u53ef\u4ee5$\\sqrt{n}$ \u7b97\u51fa\n\n\u603b\u590d\u6742\u5ea6 $n\\sqrt{n}$\n",
        "postTime": 1516263476,
        "uid": 6469,
        "name": "\u5434\u6069\u6cfd",
        "ccfLevel": 0,
        "title": "[HAOI2011]Problem b"
    },
    {
        "content": "## \u5206\u6790  \n[\u770b\u535a\u5ba2\u4f53\u9a8c\u66f4\u597d](https://pro_11d_beyonder.gitee.io/2020/07/03/%E6%B4%9B%E8%B0%B7P2522-HAOI2011-Problem-b/)   \n&emsp;&emsp;\u4ee4\u4e8c\u5143\u51fd\u6570 $f(x,y)=\\sum\\limits_{i=1}^x\\sum\\limits_{j=1}^y [\\gcd(i,j)=k]$\uff0c\u5176\u4e2d $x,y\\in N^*$\u3002\u7531\u9898\u610f\uff0c\u6240\u6c42\u7b54\u6848\u4e3a $\\sum\\limits_{i=a}^b\\sum\\limits_{j=c}^d[\\gcd(i,j)=k]$\uff1b\u4f9d\u636e\u5bb9\u65a5\u539f\u7406\uff0c$ans=f(b,d)-f(a-1,d)-f(b,c-1)+f(a-1,c-1)$\u3002  \n&emsp;&emsp;\u4efb\u52a1\u8f6c\u5316\u4e3a\uff0c\u5bf9\u4e8e\u7ed9\u5b9a\u7684 $n,m\\in N^*$\uff0c\u6c42 $f(n,m)=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m [\\gcd(i,j)=k]$ \u7684\u503c\u3002  \n&emsp;&emsp;\u9996\u5148\uff0c$k$ \u4e3a $i,j$ \u7684\u6700\u5927\u516c\u7ea6\u6570\uff0c\u6545 $\\frac{i}{k}$ \u4e0e $\\frac{j}{k}$ \u4e92\u8d28\uff0c\u5373 $\\gcd(\\frac{i}{k},\\frac{j}{k})=1$\u3002\u6240\u4ee5 $f(n,m)=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m \\left[\\gcd\\left(\\frac{i}{k},\\frac{j}{k}\\right)=1\\right]$\uff1b\u4ece\u6b64\u5f0f\u770b\u51fa\uff0c$\\frac{i}{k}$ \u7684\u4e0a\u9650\u4e3a $\\left\\lfloor\\frac{n}{k}\\right\\rfloor$\uff0c$\\frac{j}{k}$ \u7684\u4e0a\u9650\u4e3a $\\left\\lfloor\\frac{m}{k}\\right\\rfloor$\uff1b\u56e0\u6b64\u7b49\u4ef7\u4e8e\uff0c $f(n,m)=\\sum\\limits_{i=1}^{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}\\sum\\limits_{j=1}^{\\left\\lfloor\\frac{m}{k}\\right\\rfloor}[\\gcd(i,j)=1]$\u3002  \n&emsp;&emsp;\u63a5\u4e0b\u6765\u5229\u7528\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u6027\u8d28\uff0c$\\gcd(i,j)=1\\Leftrightarrow\\sum\\limits_{d\\mid\\gcd(i,j)}\\mu(d)$\u3002\u6545 $f(n,m)=\\sum\\limits_{i=1}^{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}\\sum\\limits_{j=1}^{\\left\\lfloor\\frac{m}{k}\\right\\rfloor}\\sum\\limits_{d\\mid\\gcd(i,j)}\\mu(d)$\u3002    \n&emsp;&emsp;\u63a5\u4e0b\u6765\u53d8\u6362\u6c42\u548c\u6b21\u5e8f\uff0c\u6539\u4e3a\u679a\u4e3e $d$\u3002$f(n,m)=\\sum\\limits_{d=1}^{\\min\\left(\\left\\lfloor\\frac{n}{k}\\right\\rfloor,\\left\\lfloor\\frac{n}{k}\\right\\rfloor\\right)}\\sum\\limits_{i=1}^{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}\\sum\\limits_{j=1}^{\\left\\lfloor\\frac{m}{k}\\right\\rfloor}\\mu(d)[d\\mid\\gcd(i,j)]$\uff1b\u7531\u4e8e $\\mu(d)$ \u4e3a\u53ea\u4e0e $d$ \u76f8\u5173\u7684\u51fd\u6570\uff0c\u5219 $f(n,m)=\\sum\\limits_{d=1}^{\\min\\left(\\left\\lfloor\\frac{n}{k}\\right\\rfloor,\\left\\lfloor\\frac{n}{k}\\right\\rfloor\\right)}\\mu(d)\\sum\\limits_{i=1}^{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}\\sum\\limits_{j=1}^{\\left\\lfloor\\frac{m}{k}\\right\\rfloor}[d\\mid\\gcd(i,j)]$\u3002  \n&emsp;&emsp;\u6709\u6761\u4ef6 $d\\mid\\gcd(i,j)$\uff0c\u6545\u53ef\u8bbe $\\gcd(i,j)=pd$\uff1b\u7531\u6700\u5927\u516c\u7ea6\u6570\u7684\u5b9a\u4e49 $pd\\mid i$ \u4e14 $pd\\mid j$\uff0c\u56e0\u6b64\u5047\u8bbe $i=p_1pd$\uff0c$j=p_2pd$\uff1b\u5176\u4e2d\uff0c$p,p_1,p_2\\in N^*$\u3002\u7ecf\u8fc7\u4e0a\u8ff0\u7565\u8bc1\uff0c $d\\mid\\gcd(i,j)$ \u7684\u5145\u8981\u6761\u4ef6\u662f\uff1a$i,j$ \u90fd\u4e3a $d$ \u7684\u500d\u6570\u3002\u5728\u533a\u95f4 $\\left[1,\\left\\lfloor\\frac{n}{k}\\right\\rfloor\\right]$ \u4e2d\uff0c$d$ \u7684\u500d\u6570\u6709 $\\left\\lfloor\\frac{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}{d}\\right\\rfloor$ \u4e2a\uff1b\u5728\u533a\u95f4 $\\left[1,\\left\\lfloor\\frac{m}{k}\\right\\rfloor\\right]$ \u4e2d\uff0c$d$ \u7684\u500d\u6570\u6709 $\\left\\lfloor\\frac{\\left\\lfloor\\frac{m}{k}\\right\\rfloor}{d}\\right\\rfloor$ \u4e2a\uff1b\u56e0\u6b64\uff0c\u6ee1\u8db3\u6761\u4ef6 $d\\mid\\gcd(i,j)$ \u7684\u6570\u5bf9 $(i,j)$ \u7684\u4e2a\u6570\u6709 $\\sum\\limits_{i=1}^{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}\\sum\\limits_{j=1}^{\\left\\lfloor\\frac{m}{k}\\right\\rfloor}[d\\mid\\gcd(i,j)]=\\left\\lfloor\\frac{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}{d}\\right\\rfloor\\times\\left\\lfloor\\frac{\\left\\lfloor\\frac{m}{k}\\right\\rfloor}{d}\\right\\rfloor$\u3002   \n&emsp;&emsp;\u5c06 $\\sum\\limits_{i=1}^{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}\\sum\\limits_{j=1}^{\\left\\lfloor\\frac{m}{k}\\right\\rfloor}[d\\mid\\gcd(i,j)]=\\left\\lfloor\\frac{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}{d}\\right\\rfloor\\times\\left\\lfloor\\frac{\\left\\lfloor\\frac{m}{k}\\right\\rfloor}{d}\\right\\rfloor$ \u4ee3\u5165\uff0c\u5f97 $f(n,m)=\\sum\\limits_{d=1}^{\\min\\left(\\left\\lfloor\\frac{n}{k}\\right\\rfloor,\\left\\lfloor\\frac{n}{k}\\right\\rfloor\\right)}\\left\\lfloor\\frac{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}{d}\\right\\rfloor\\left\\lfloor\\frac{\\left\\lfloor\\frac{m}{k}\\right\\rfloor}{d}\\right\\rfloor\\mu(d)$\u3002\u8be5\u5f0f\u53ef\u7528\u6570\u8bba\u5206\u5757\u89e3\u51b3\u3002  \n&emsp;&emsp;\u7ed3\u5408\u4ee5\u4e0a  \n&emsp;&emsp;$\\begin{aligned}f(n,m)&=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m [\\gcd(i,j)=k]\\\\&=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m \\left[\\gcd\\left(\\frac{i}{k},\\frac{j}{k}\\right)=1\\right]\\\\&=\\sum\\limits_{i=1}^{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}\\sum\\limits_{j=1}^{\\left\\lfloor\\frac{m}{k}\\right\\rfloor}[\\gcd(i,j)=1]\\\\&=\\sum\\limits_{i=1}^{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}\\sum\\limits_{j=1}^{\\left\\lfloor\\frac{m}{k}\\right\\rfloor}\\sum\\limits_{d\\mid\\gcd(i,j)}\\mu(d)\\\\&=\\sum\\limits_{d=1}^{\\min\\left(\\left\\lfloor\\frac{n}{k}\\right\\rfloor,\\left\\lfloor\\frac{n}{k}\\right\\rfloor\\right)}\\sum\\limits_{i=1}^{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}\\sum\\limits_{j=1}^{\\left\\lfloor\\frac{m}{k}\\right\\rfloor}\\mu(d)[d\\mid\\gcd(i,j)]\\\\&=\\sum\\limits_{d=1}^{\\min\\left(\\left\\lfloor\\frac{n}{k}\\right\\rfloor,\\left\\lfloor\\frac{n}{k}\\right\\rfloor\\right)}\\mu(d)\\sum\\limits_{i=1}^{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}\\sum\\limits_{j=1}^{\\left\\lfloor\\frac{m}{k}\\right\\rfloor}[d\\mid\\gcd(i,j)]\\\\&=\\sum\\limits_{d=1}^{\\min\\left(\\left\\lfloor\\frac{n}{k}\\right\\rfloor,\\left\\lfloor\\frac{n}{k}\\right\\rfloor\\right)}\\left\\lfloor\\frac{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}{d}\\right\\rfloor\\left\\lfloor\\frac{\\left\\lfloor\\frac{m}{k}\\right\\rfloor}{d}\\right\\rfloor\\mu(d)\\end{aligned}$   \n&emsp;&emsp;\u7efc\u4e0a\u6240\u8ff0\uff0c\u5bf9\u4e8e\u7ed9\u5b9a\u7684 $n,m$ \u6700\u7ec8\u7528\u6570\u8bba\u5206\u5757\u6c42\u89e3 $f(n,m)$ \u7684\u503c \u3002\u5047\u8bbe\u5728\u533a\u95f4 $[l,r]$ \u5185\uff0c$\\left\\lfloor\\frac{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}{d}\\right\\rfloor\\times\\left\\lfloor\\frac{\\left\\lfloor\\frac{m}{k}\\right\\rfloor}{d}\\right\\rfloor$ \u6052\u4e3a $A$\uff0c\u5219 $\\sum\\limits_{d=l}^r\\left\\lfloor\\frac{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}{d}\\right\\rfloor\\left\\lfloor\\frac{\\left\\lfloor\\frac{m}{k}\\right\\rfloor}{d}\\right\\rfloor\\mu(d)=A\\sum\\limits_{d=l}^r\\mu(d)$\uff1b\u663e\u7136\uff0c\u6211\u4eec\u8981\u9884\u5904\u7406\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u7684\u524d\u7f00\u548c\uff0c\u624d\u80fd\u5728 $O(1)$ \u5185\u6c42\u51fa\u4e00\u4e2a\u5206\u5757\u7684\u503c\u3002  \n&emsp;&emsp;\u9898\u76ee\u7684\u6700\u7ec8\u7b54\u6848\u4e3a $f(b,d)-f(a-1,d)-f(b,c-1)+f(a-1,c-1)$\u3002  \n## \u4ee3\u7801  \n```cpp\n#include<iostream>\n#include<cstring>\n#include<algorithm>\n#define ll long long\n#define N 50006\nusing namespace std;\nbool vis[N];\nint prime[N>>1];//\u8d28\u6570\nint mu[N];//\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\nint sum[N];//mu[i]\u7684\u524d\u7f00\u548c\nint cnt;\nint a,b,c,d,k;\n//--------------------------------------------\n//\u6b27\u62c9\u7b5b\u6c42\u5f97\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\n//\u6c42\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u7684\u524d\u7f00\u548c\nvoid init(int n)\n{\n\tmu[1]=1;\n\tint i,j;\n\tfor(i=2;i<=n;i++)\n\t{\n\t\tif(!vis[i])\n\t\t{\n\t\t\tprime[++cnt]=i;\n\t\t\tmu[i]=-1;\n\t\t}\n\t\tfor(j=1;j<=cnt&&i*prime[j]<=n;j++)\n\t\t{\n\t\t\tvis[i*prime[j]]=1;\n\t\t\tif(i%prime[j]==0) \n\t\t\t{\n\t\t\t\tmu[i*prime[j]]=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse mu[i*prime[j]]=-mu[i];\n\t\t}\n\t}\n\tfor(i=1;i<=n;i++) sum[i]=sum[i-1]+mu[i];\n}\n//--------------------------------------------\n//--------------------------------------------------\n//\u5bf9\u4e8e\u7ed9\u5b9a\u7684n,m\n//\u8ba1\u7b97f(n,m)\n//\u5c06n/k,m/k\u770b\u4f5c\u6574\u4f53\ninline ll f(int n,int m)\n{\n\tn/=k;\n\tm/=k;\n\tif(n>m) swap(n,m);\n\tint l,r;\n\tll res=0;\n\tfor(l=1;l<=n;l=r+1)\n\t{\n\t\tr=min(n/(n/l),m/(m/l));\n\t\tres=res+1ll*(n/l)*(m/l)*(sum[r]-sum[l-1]);\n\t}\n\treturn res;\n}\n//--------------------------------------------------\nint main()\n{\n\tinit(50000);\n\tint _;\n\tfor(cin>>_;_;_--)\n\t{\n\t\tscanf(\"%d%d%d%d%d\",&a,&b,&c,&d,&k);\n\t\t//\u5bb9\u65a5\u539f\u7406\n\t\tprintf(\"%lld\\n\",f(b,d)-f(a-1,d)-f(b,c-1)+f(a-1,c-1));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1593793956,
        "uid": 253240,
        "name": "11D_Beyonder",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    },
    {
        "content": "$$\\sum\\limits_{i=a}^{b} \\sum\\limits_{j=c}^{d} [\\gcd(i,j)=k]$$\n\n\u8bbe\n\n\u51fd\u6570 $f(x,y)$ \u4e3a\uff1a\n\n$$\\sum\\limits_{i=1}^{x} \\sum\\limits_{j=1}^{y} [\\gcd(i,j)=k]$$\n\n\u90a3\u4e48\uff0c\u8fd0\u7528\u5bb9\u65a5\u539f\u7406\uff0c\u539f\u5f0f\u5c31 $= f(b,d) - f(a,d) - f(b,c) + f(a,c)$\n\n\u6240\u4ee5\u73b0\u5728\u95ee\u9898\u5c31\u8f6c\u6362\u4e3a\u4e86\u6c42 $f$ \u51fd\u6570\u3002\n\n$$\\begin{aligned}&\\sum\\limits_{i=1}^{x} \\sum\\limits_{j=1}^{y} [\\gcd(i,j)=k] \\\\=& \\sum_{i=1}^{\\lfloor\\frac{n}{k}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{m}{k}\\rfloor}[\\gcd(i,j)=1]\\\\=& \\sum_{i=1}^{\\lfloor\\frac{n}{k}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{m}{k}\\rfloor}\\varepsilon(\\gcd(i,j))\\\\=& \\sum_{i=1}^{\\lfloor\\frac{n}{k}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{m}{k}\\rfloor}\\sum_{d \\mid \\gcd(i,j) }\\mu(d)\\\\=& \\sum_{d=1 }\\mu(d)\\sum_{i=1}^{\\lfloor\\frac{n}{k}\\rfloor}[d \\mid i]\\sum_{j=1}^{\\lfloor\\frac{m}{k}\\rfloor}[d \\mid j]\\\\=&\\sum_{d=1}\\mu(d)\\lfloor\\frac{n}{kd}\\rfloor\\lfloor\\frac{m}{kd}\\rfloor\\end{aligned}$$\n\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u6570\u8bba\u5206\u5757\u8fdb\u884c\u6c42\u89e3\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntemplate<typename T>inline void read(T &FF){\n\tT RR=1;FF=0;char CH=getchar();\n\tfor(;!isdigit(CH);CH=getchar())if(CH=='-')RR=-1;\n\tfor(;isdigit(CH);CH=getchar())FF=(FF<<1)+(FF<<3)+(CH^48);\n\tFF*=RR;\n}\nconst int N=50010;\nint prim[N],mu[N],sum[N],cnt,k,T;\nbool vis[N];\nvoid init(){\n\tmu[1]=1;\n\tfor(register int i=2;i<N;i++){\n\t\tif(!vis[i]){\n\t\t\tmu[i]=-1;\n\t\t\tprim[++cnt]=i;\n\t\t}\n\t\tfor(register int j=1;j<=cnt&&i*prim[j]<N;j++){\n\t\t\tvis[i*prim[j]]=1;\n\t\t\tif(i%prim[j]==0)break;\n\t\t\tmu[i*prim[j]]=-mu[i];\n\t\t}\n\t}\n\tfor(register int i=1;i<N;i++)sum[i]=sum[i-1]+mu[i];\n}//\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u677f\u5b50\nll calc(int a,int b){\n\tll ans=0;\n\tfor(register int l=1,r;l<=min(a,b);l=r+1){\n\t\tr=min(a/(a/l),b/(b/l));\n\t\tans+=(1ll*a/l)*(1ll*b/l)*(sum[r]-sum[l-1]);\n\t}\n\treturn ans;\n}\nint main(){\n\tinit();\n\tfor(read(T);T--;){\n\t\tint a,b,c,d;\n\t\tread(a);read(b);read(c);read(d);read(k);\n\t\ta--;c--;a/=k;b/=k;c/=k;d/=k;\n\t\tprintf(\"%lld\\n\",calc(b,d)-calc(b,c)-calc(a,d)+calc(a,c));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1587907966,
        "uid": 180242,
        "name": "orzdevinwang",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    },
    {
        "content": "\u5982\u679c $\\LaTeX$ \u5d29\u4e86\u5c31\u8bf7\u5230[\u6211\u7684\u535a\u5ba2](https://www.luogu.com.cn/blog/My-luoguBuoke-HZR/solution-p2522)\u6765\u5427QAQ\n\n\u9898\u610f\uff1a\n\n\u6c42\uff1a\n\n$$\\sum_{i=a}^b\\sum_{j=c}^d[\\gcd(i,j)=e]$$\n\n\u6570\u636e\u7ec4\u6570 $T\\leq 5 \\times 10^4\\ \\ \\ \\ a,b,c,d,e\\leq5\\times10^4$ \n\n---\n\n\u8003\u8651\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u3002\n\n\u5bf9 $i,j$ \u5206\u522b\u9664\u4ee5 $e$ \u6709\uff1a\n\n$$\n\\sum_{i=\\left\\lfloor{\\frac{a-1}{e}}\\right\\rfloor+1}^{\\left\\lfloor{\\frac{b}{e}}\\right\\rfloor}\n\n\\sum_{j=\\left\\lfloor{\\frac{c-1}{e}}\\right\\rfloor+1}^{\\left\\lfloor{\\frac{d}{e}}\\right\\rfloor}\n\n[\\gcd(i,j)=1]\n$$\n\n\u90a3\u4e48\u8bbe $A=\\left\\lfloor{\\frac{a-1}{e}}\\right\\rfloor+1,B=\\left\\lfloor{\\frac{b}{e}}\\right\\rfloor,C=\\left\\lfloor{\\frac{c-1}{e}}\\right\\rfloor+1,D=\\left\\lfloor{\\frac{d}{e}}\\right\\rfloor$ \uff0c\u90a3\u4e48\u539f\u5f0f\u7b49\u4e8e\uff1a\n\n$$\n\\sum_{i=A}^{B}\n\n\\sum_{j=C}^{D}\n\n[\\gcd(i,j)=1]\n$$\n\n\u4e8e\u662f\u53ef\u4ee5\u76f4\u63a5\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u539f\u5f0f\u8f6c\u6362\u5982\u4e0b\uff1a\n\n$$\n\\sum_{i=A}^{B}\n\n\\sum_{j=C}^{D}\n\n\\sum_{d|i,j}\n\n\\mu(d)\n$$\n\n\u6539\u53d8\u679a\u4e3e\u987a\u5e8f\uff1a ( \u8bbe $B\\leq D$ )\n\n$$\n\\sum_{d=1}^D\n\n\\mu(d)\n\n\\sum_{i=\\left\\lfloor{\\frac{A-1}{d}}\\right\\rfloor+1}^{\\left\\lfloor{\\frac{B}{d}}\\right\\rfloor}\n\n\\sum_{j=\\left\\lfloor{\\frac{C-1}{d}}\\right\\rfloor+1}^{\\left\\lfloor{\\frac{D}{d}}\\right\\rfloor}\n\n$$\n\n$$\n\\sum_{d=1}^D\n\n\\mu(d)\n\n(\\left\\lfloor{\\tfrac{B}{d}}\\right\\rfloor-\\left\\lfloor{\\tfrac{A-1}{d}}\\right\\rfloor)\n\n(\\left\\lfloor{\\tfrac{D}{d}}\\right\\rfloor-\\left\\lfloor{\\tfrac{C-1}{d}}\\right\\rfloor)\n$$\n\n\u4e8e\u662f\u7b5b\u51fa $\\mu$ \u4ee5\u540e\u5957\u4e2a\u6570\u8bba\u5206\u5757\u5373\u53ef\u3002\n\n~~\u56db\u5c42\u6570\u8bba\u5206\u5757\u53ef\u8fd8\u884c~~\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\ninline int read(){\n\tchar c=getchar();int x=0,f=1;\n    while(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n    while(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n    return x*f;\n}\nconst int N=50010;\nint i,j,k,n,m,T;\nint is_prime[N],prime[N],mu[N],Mu[N],num;\nvoid init(){\n\tmu[1]=1;\n\tfor(int i=2;i<N;i++)is_prime[i]=1;\n\tfor(int i=2;i<N;i++){\n\t\tif(is_prime[i])prime[++num]=i,mu[i]=-1;\n\t\tfor(int j=1;i*prime[j]<N&&j<=num;j++){\n\t\t\tis_prime[i*prime[j]]=0;\n\t\t\tif(i%prime[j]==0)break;\n\t\t\tmu[i*prime[j]]=-mu[i];\n\t\t}\n\t}\n\tfor(int i=1;i<N;i++)Mu[i]=Mu[i-1]+mu[i];\n}\ninline int Min(int a,int b,int c,int d){\n\treturn min(min(min(a,b),c),d);\n}\ninline int Get(int x,int y){\n\treturn x>=y? x/(x/y):0x7f7f7f7f;\n}\nint A,B,C,D,E;\nint main(){\n\tinit();\n\tcin>>T;\n\twhile(T--){\n\t\tcin>>A>>B>>C>>D>>E;\n\t\tA=(A-1)/E+1;B/=E;\n\t\tC=(C-1)/E+1;D/=E;\n\t\tll ans=0;\n//\t\tcout<<A<<' '<<B<<' '<<C<<' '<<D<<endl;\n\t\tfor(int l=1,r=0;l<=max(B,D);l=r+1){\n\t\t\tr=Min(Get(B,l),Get(A-1,l),Get(D,l),Get(C-1,l));\n\t\t\tans+=((ll)B/l-(A-1)/l)*(D/l-(C-1)/l)*(Mu[r]-Mu[l-1]);\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1584628538,
        "uid": 35891,
        "name": "huangzirui",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    },
    {
        "content": "\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u5165\u95e8\u63a8\u5f0f\u5b50\u5957\u8def\u9898\u3002\n\n\u524d\u7f6e\u829d\u58eb\uff1a\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u57fa\u672c\u6027\u8d28\u3002\n\n\u663e\u7136\u53ea\u8981\u6c42\u51fa\u4e8c\u7ef4\u524d\u7f00\u548c\u5c31\u53ef\u4ee5\u4e86\uff0c\u5c31\u8f6c\u5316\u6210\u4e86[\u8fd9\u9053\u9898](https://www.luogu.com.cn/problem/P3455)\u3002\n\n\u4e0b\u9762\u5c31\u662f\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5957\u8def\u90e8\u5206\u4e86\u3002\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{m}[\\gcd(i,j)=k]$$\n$$=\\sum_{i=1}^{[\\frac{n}{k}]}\\sum_{j=1}^{[\\frac{m}{k}]}[\\gcd(i,j)=1]$$\n\n$$=\\sum_{i=1}^{[\\frac{n}{k}]}\\sum_{j=1}^{[\\frac{m}{k}]}\\sum_{d|i,d|j}\\mu(d)$$\n$$=\\sum_{d=1}^{min([\\frac{n}{k}],[\\frac{m}{k}])}\\mu(d)\\sum_{i=1,d|i}^{[\\frac{n}{k}]}\\sum_{j=1,d|j}^{[\\frac{m}{k}]}1$$\n$$=\\sum_{d=1}^{min([\\frac{n}{k}],[\\frac{m}{k}])}\\left[\\frac{n}{dk}\\right]\\left[\\frac{m}{dk}\\right]$$\n\u7136\u540e\u4f7f\u7528\u6574\u6570\u5206\u5757\u5c31\u5b8c\u4e8b\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=50005;\ntypedef long long ll; \ninline void read(int&x)\n{\n    int f=1;x=0;char s=getchar();\n    while(!isdigit(s)){if(s=='-')f=-1;s=getchar();}\n    while(isdigit(s)){x=(x<<1)+(x<<3)+s-'0';s=getchar();}\n    x*=f;\n}\ninline void print(ll x)\n{\n    if(x<0)putchar('-'),x=-x;\n    if(x>9)print(x/10);\n    putchar(x%10+'0');\n}\nint pr[N],mu[N],sum[N],n;\nint T,a,b,c,d,k;\nbool vst[N];\nll calc(ll a,ll b,ll d){\n\ta/=d;b/=d;\n\tll ans=0;\n\tfor(int i=1,j;i<=min(a,b);i=j+1){\n\t\tj=min(a/(a/i),b/(b/i));\n\t\tans+=(ll)(a/i)*(b/i)*(sum[j]-sum[i-1]);\n\t}\n\treturn ans;\n}\nint main(){\n\tmu[1]=1;\n\tfor(int i=2,tot=0;i<=50000;++i){\n\t\tif(!vst[i]){mu[i]=-1;pr[++tot]=i;}\n\t\tfor(int j=1;i*pr[j]<=50000;++j){\n\t\t\tvst[i*pr[j]]=1;\n\t\t\tif(i%pr[j])mu[i*pr[j]]=-mu[i];\n\t\t\telse break;\n\t\t}\n\t}\n\tsum[1]=mu[1];\n\tfor(int i=2;i<=50000;++i)sum[i]+=mu[i]+sum[i-1];\n\tread(T);\n\twhile(T--){\n\t\tread(a),read(b),read(c),read(d),read(k);\n\t\tprintf(\"%lld\\n\",calc(b,d,k)-calc(a-1,d,k)-calc(b,c-1,k)+calc(a-1,c-1,k));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1584278393,
        "uid": 121027,
        "name": "Spasmodic",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    },
    {
        "content": "\u524d\u8a00\uff1a\u5176\u5b9e\u6211\u5728\u5199\u8fd9\u9053\u9898\u7684\u65f6\u5019\u5e76\u6ca1\u6709\u7528\u5bb9\u65a5\u7edf\u8ba1\u7b54\u6848\uff0c\u800c\u662f\u76f4\u63a5\u628a\u56db\u4e2a\u7aef\u70b9\u5957\u8fdb\u6570\u8bba\u5206\u5757\u91cc\u8fdb\u884c\u7edf\u8ba1\uff0c\u7136\u540e\u4e24\u4e24\u505a\u4e2a\u5dee\u5206\uff08\u542c\u8d77\u6765\u53ef\u80fd\u5f88\u62bd\u8c61\uff0c\u4e0b\u9762\u4f1a\u6709\u8be6\u7ec6\u89e3\u91ca\uff09\u3002\u7ed3\u679c\u63d0\u4ea4\u540e\u53d1\u73b0\u9519\u4e86\uff0c\u67e5\u770b\u9898\u89e3\u5e76\u6539\u6210\u5bb9\u65a5\u4ee5\u540e\u8fd8\u662f$WA$\uff0c\u4e0d\u7ecf\u610f\u95f4\u779f\u5230\u4e00\u884c\u4ee3\u7801\uff0c\u624d\u53d1\u73b0\u539f\u6765$min$\u5199\u6210\u4e86$max......$\u6539\u8fc7\u6765\u4ee5\u540e\u53d1\u73b0\u539f\u505a\u6cd5\u7adf\u7136\u8fc7\u4e86\u3002\u5728\u6211\u5927\u81f4\u770b\u4e86\u4e00\u904d\u9898\u89e3\u533a\u5e76\u786e\u4fdd\u6ca1\u6709\u91cd\u590d\u505a\u6cd5\u4ee5\u540e\uff0c\u6211\u51b3\u5b9a\u5206\u4eab\u4e00\u4e0b\u8fd9\u4e2a\u4e0d\u7528\u5bb9\u65a5\u7684\u505a\u6cd5\u3002\n\n[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P2522)\n\n\u9898\u76ee\u63cf\u8ff0\uff1a\u7ed9\u51fa\u4e94\u4e2a\u6574\u6570$a,b,c,d,k$\uff0c\u8bbe$a\u2264x\u2264b,c\u2264y\u2264d$\uff0c\u6c42$gcd(x,y)=k$\u7684$(x,y)$\u5bf9\u6570\u3002\n\n\u5177\u4f53\u505a\u6cd5\u5927\u4f6c\u4eec\u7684\u9898\u89e3\u4e2d\u5df2\u7ecf\u8bb2\u7684\u5f88\u8be6\u7ec6\u4e86\uff0c\u6211\u8fd9\u91cc\u5c31\u8bf4\u4e00\u4e0b\u5982\u4f55\u53bb\u6c42\u8fd9\u4e2a\u5f0f\u5b50\uff1a\n\n$\\sum_{x=\\frac{a}{k}}^{\\frac{b}{k}}\\sum_{y=\\frac{c}{k}}^{\\frac{d}{k}}\\sum_{d|gcd(x,y)}\\mu(d)$\n\n\u9996\u5148\u4e0d\u96be\u8bc1\u5f97$d|gcd(x,y)$\u76f8\u5f53\u4e8e$d|x$\u4e14$d|y$\uff0c\u4e5f\u5c31\u662f\u8bf4\u5f53\u6211\u4eec\u679a\u4e3e\u7ea6\u6570$d$\u7684\u65f6\u5019\uff0c\u6211\u4eec\u8981\u786e\u4fdd\u7ea6\u6570$d$\u7684\u500d\u6570\u65e2\u5b58\u5728\u4e8e$[\\frac{a}{k},\\frac{b}{k}]$\uff08\u8bbe\u5b58\u5728\u4e2a\u6570\u4e3a$u$\uff09\uff0c\u4e5f\u5b58\u5728\u4e8e$[\\frac{c}{k},\\frac{d}{k}]$\uff08\u8bbe\u5b58\u5728\u4e2a\u6570\u4e3a$v$\uff09\uff0c\u5219\u7ea6\u6570$d$\u5bf9\u7b54\u6848\u505a\u51fa\u7684\u8d21\u732e\u5c31\u662f$\\mu(d)\\times u\\times v$\u3002\u7136\u540e\u518d\u8ba1\u7b97\u6bcf\u4e2a\u7ea6\u6570$d$\u7684\u8d21\u732e\uff0c\u6700\u540e\u6c42\u548c\u5c31\u884c\u4e86\u3002\n\n\u7136\u800c\u5355\u6b21\u8ba1\u7b97\u65f6\u95f4\u590d\u6742\u5ea6\u662f$O(n)$\u7684\uff0c\u591a\u7ec4\u6570\u636e\u4f1a$TLE$\uff0c\u53ef\u4ee5\u8003\u8651\u7528\u6570\u8bba\u5206\u5757\u4f18\u5316\u4e00\u4e0b\u3002\u666e\u901a\u7684\u6570\u8bba\u5206\u5757\u4e00\u822c\u90fd\u662f\u5361\u4e00\u4e2a\u7aef\u70b9\uff08\u5373\u4e00\u6bb5\u8fde\u7eed\u7684$d$\u4f7f\u5f97$\\frac{x}{d}$\u7684\u503c\u76f8\u540c\uff09\uff0c\u4e00\u4e2a\u533a\u95f4\u8303\u56f4\u5185\u7684\u6570\u5c31\u9700\u8981\u5361\u4e24\u4e2a\u7aef\u70b9\uff08\u5373\u4e00\u6bb5\u8fde\u7eed\u7684$d$\u4f7f\u5f97$\\frac{y}{d}-\\frac{x-1}{d}$\u7684\u503c\u76f8\u540c\uff09\uff0c\u800c\u4e24\u4e2a\u533a\u95f4\u8303\u56f4\u5185\u7684\u6570\u5c31\u9700\u8981\u5361\u56db\u4e2a\u7aef\u70b9\uff08\u5373\u4e00\u6bb5\u8fde\u7eed\u7684$d$\u4f7f\u5f97$u=\\frac{y1}{d}-\\frac{x1-1}{d}$\u7684\u503c\u76f8\u540c\u4e14$v=\\frac{y2}{d}-\\frac{x2-1}{d}$\u7684\u503c\u76f8\u540c\u4e14$u=v$\uff09\u3002\n\n\u603b\u800c\u8a00\u4e4b\uff0c\u4e0a\u8ff0\u8fc7\u7a0b\u5c31\u662f\u628a$u\\times v$\u76f8\u540c\u7684$d$\u7edf\u4e00\u8ba1\u7b97\u4e3a$(sum\\mu(r)-sum\\mu(l-1))\\times u \\times v$\u2460\uff0c\u8fd9\u6837\u5c31\u80fd\u628a\u590d\u6742\u5ea6\u7b80\u5316\u4e3a$O(\\sqrt{n})$\u3002\n\n\u7531\u4e8e\u8981\u6c42\u5361\u56db\u4e2a\u7aef\u70b9\uff0c\u6240\u4ee5\u5e38\u6570\u4f1a\u7a0d\u5fae\u5927\u4e00\u70b9\uff0c\u4f46\u662f\u53ef\u4ee5\u4e0d\u9700\u8981\u5bb9\u65a5\u3002\uff08\u7136\u800c\u8fd9\u6837\u505a\u7684\u672c\u8d28\u5176\u5b9e\u548c\u5bb9\u65a5\u662f\u76f8\u540c\u7684\uff0c\u611f\u5174\u8da3\u7684\u8bfb\u8005\u53ef\u4ee5\u628a\u521a\u624d\u7edf\u8ba1\u7684\u2460\u5f0f\u62c6\u5f00\uff0c\u7136\u540e\u5c31\u80fd\u53d1\u73b0\u8fd9\u5c31\u662f\u5bb9\u65a5\u3002\uff09\n\n\u8be6\u7ec6\u7684\u53ef\u4ee5\u770b\u4e00\u4e0b\u4ee3\u7801\u3002\n\n\u4e0a\u4ee3\u7801\uff1a\n~~~cpp\n//\u4e00\u5f00\u59cb\u6302\u4e86\uff0c\u7136\u540e\u9519\u8bef\u5730\u4ee5\u4e3a\u81ea\u5df1\u60f3\u9519\u4e86\n//\u7136\u800c\u5e76\u6ca1\u6709\uff08\u53ea\u662f\u5355\u7eaf\u5730\u628amin\u5199\u6210\u4e86max\uff09 \n//\u53ef\u4ee5\u76f4\u63a5\u628a\u56db\u4e2a\u7aef\u70b9\u4e00\u8d77\u653e\u8fdb\u53bb\u641e\u6570\u8bba\u5206\u5757\uff0c\u7136\u540e\u505a\u4e2a\u5dee\u5206\u5373\u53ef\uff0c\u4e0d\u9700\u5bb9\u65a5 \n//\u591a\u4f59\u5e38\u6570\u5927\u7684\u4e00\u6279\uff0c\u53c2\u7167\u9700\u8c28\u614e \n#include<cstdio>\n#include<iostream>\n#define N 50005\n#define ll long long\nusing namespace std;\nint mu[N],prime[N],T;\nll sum_mu[N];\nbool vis[N];\nvoid init()\n{\n\tmu[1]=1,vis[1]=1;\n\tfor(int i=2;i<=50000;i++)\n\t{\n\t\tif(!vis[i])\n\t\t{\n\t\t\tprime[++prime[0]]=i;\n\t\t\tmu[i]=-1;\n\t\t}\n\t\tfor(int j=1;j<=prime[0]&&prime[j]*i<=50000;j++)\n\t\t{\n\t\t\tvis[i*prime[j]]=1;\n\t\t\tif(i%prime[j])mu[i*prime[j]]=mu[i]*(-1);\n\t\t\telse\n\t\t\t{\n\t\t\t\tmu[i*prime[j]]=0;break;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=50000;i++)sum_mu[i]=sum_mu[i-1]+mu[i];\n}\nll ask(ll xa,ll ya,ll xb,ll yb)\n{\n\tll res=0; \n\tfor(ll l=1,r=0;l<=min(ya,yb);l=r+1)\n\t{\n\t\tr=min(min(xa/l?xa/(xa/l):0x3f3f3f3f,ya/(ya/l)),min(xb/l?xb/(xb/l):0x3f3f3f3f,yb/(yb/l)));\n\t\t//xa/l\uff08\u6216\u8005xb/l\uff09\u53ef\u80fd\u4f1a\u662f0\uff0cxa/l=0\u8bf4\u660e\u533a\u95f4[1,xa]\u4e0d\u53ef\u80fd\u5b58\u5728l~r\u7684\u500d\u6570\uff0c\u56e0\u6b64\u4e0d\u9700\u8003\u8651\u5b83\u7684\u5206\u5757\u53f3\u7aef\u70b9\u7684\u53d6\u503c\uff0c\u5373\u8bbe\u4e3a\u65e0\u7a77\u5927\n\t\t//\u800cya/l=0\u6216yb/l=0\u65f6\u4f1a\u81ea\u52a8\u8df3\u51fa\uff0c\u56e0\u6b64\u4e0d\u9700\u7279\u5224\u3002 \n\t\tres+=(sum_mu[r]-sum_mu[l-1])*(ya/r-xa/r)*(yb/r-xb/r);\n\t}\n\treturn res;\n}\nint main()\n{\n\tinit();\n\tscanf(\"%d\",&T);\n\twhile(T--)\n\t{\n\t\tint a,b,c,d,k;\n\t\tscanf(\"%d %d %d %d %d\",&a,&b,&c,&d,&k);\n\t\ta--,c--;\n\t\ta/=k,b/=k,c/=k,d/=k;\n\t\tprintf(\"%lld\\n\",ask(a,b,c,d));\n\t}\n\treturn 0;\n}\n~~~",
        "postTime": 1576155512,
        "uid": 110471,
        "name": "Tommy_clas",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    },
    {
        "content": "# \u9898\u610f\n\n\u5bf9\u4e8e\u7ed9\u51fa\u7684n\u4e2a\u8be2\u95ee\uff0c\u6bcf\u6b21\u6c42\u6709\u591a\u5c11\u4e2a\u6570\u5bf9(x,y)\uff0c\u6ee1\u8db3a\u2264x\u2264b\uff0cc\u2264y\u2264d\uff0c\u4e14gcd(x,y) = k\uff0cgcd(x,y)\u51fd\u6570\u4e3ax\u548cy\u7684\u6700\u5927\u516c\u7ea6\u6570\u3002\n\n# \u5206\u6790\n\n\u6240\u6c42 \uff1a$\\sum_{i=a}^b \\sum_{j=c}^d [gcd(i,j)==k]$\n\n\u4e8c\u7ef4\u533a\u95f4\u548c\u7684\u95ee\u9898\u901a\u5e38\u4f1a\u8f6c\u5316\u4e3a\u4e8c\u7ef4\u524d\u7f00\u548c\u6765\u5bb9\u65a5\n\n\u6240\u6c42\uff1a $solve(n,m) = \\sum_{i=1}^n \\sum_{j=1}^m [gcd(i,j)==k]$\n\n\u4e3a\u4e86\u540c\u4e00\u63a8\u5bfc\uff0c\u9ed8\u8ba4$n\\leq m$ \uff0c\u5982\u679c $n >m$\u53ef\u4ee5\u4ea4\u6362$n,m$,\u56e0\u4e3asolve(n,m) == solve(m,n)\n\n\u6211\u4eec\u5e38\u5e38\u7814\u7a76\u4e92\u8d28\u7684\u60c5\u51b5\u548c\u6027\u8d28\uff0c\u5982\u679c\u4e92\u8d28\u5c31\u5bb9\u6613\u8054\u60f3\u5230\u4e00\u7cfb\u5217\u79ef\u6027\u51fd\u6570\n\n\u53d8\u5f62\uff1a$\\sum_{i=1}^{\\frac n k} \\sum_{j=1}^{\\frac m k} [gcd(i,j)==1]$\n\n\u8054\u60f3\u5230$\\epsilon (n)$ \u4e5f\u662f\u5728gcd == 1 \u7684\u65f6\u5019\u53d6\u503c\u4e3a1,\u5176\u4ed6\u60c5\u51b5\u53d6\u503c\u4e3a0\n\n\u53d8\u5f62\uff1a$\\sum_{i=1}^{\\frac n k} \\sum_{j=1}^{\\frac m k} \\epsilon (gcd(i,j))$\n\n\u56e0\u4e3a $1* \\mu = \\epsilon$ \uff08\u8fd9\u91cc$*$\u6307\u72c4\u5229\u514b\u96f7\u5377\u79ef\uff09\n\n\u53d8\u5f62\uff1a$\\sum_{i=1}^{\\frac n k} \\sum_{j=1}^{\\frac m k} \\sum_{d|gcd(i,j)} \\mu(d)$\n\n\u4ea4\u6362\u6c42\u548c\u987a\u5e8f\uff1a\u901a\u5e38\u53ef\u4ee5\u4ece\u610f\u4e49\u51fa\u53d1\u6765\u63a8\uff0c\u5b9e\u5728\u4e0d\u4f1a\u53ef\u4ee5\u5c55\u5f00\u627e\u89c4\u5f8b,\u5728\u6211\u4eec\u60f3\u8981\u628a$\\mu(d)$\u63d0\u5230\u6700\u524d\u9762\uff0c\u4fbf\u4e8e\u8ba1\u6570 \u53c2\u8003[\u53e6\u4e00\u7bc7\u535a\u5ba2\u7684\u548c\u5f0f\u77e5\u8bc6\u90e8\u5206](https://www.luogu.org/blog/greenty1208/post-shuo-lun-mu-bi-wu-si-fan-yan)\n\n\u56e0\u4e3a$gcd(i,j) <= min(i,j)$\n\n\u53d8\u5f62\uff1a$\\sum_{d=1}^{\\frac n k} \\mu(d) \\sum_{i=1}^{\\frac n k}[d|i] \\sum_{i=1}^{\\frac m k}[d|j] $\n\n\u8003\u8651\uff1a\u5df2\u77e5d, \u5728\\[1,n\\] \u4e2d\uff0c\u5171\u6709 $\\lfloor \\frac n d\\rfloor$ \u4e2a\u6570\u6ee1\u8db3\u80fd\u6574\u9664\u4e8ed\uff0c\n\n\u53d8\u5f62\uff1a$\\sum_{d=1}^{\\frac n k} \\mu(d) \\lfloor \\frac n {kd} \\rfloor \\lfloor \\frac m {kd} \\rfloor$\n\n\u8fd9\u91cc\u6211\u4eec\u53d8\u6210\u4e86\u53ef\u4ee5O(n)\u6c42\u89e3\u7684\u5f0f\u5b50\n\n\u56e0\u4e3a\u5411\u4e0b\u53d6\u6574\u5176\u5b9e\u662f\u9636\u68af\u51fd\u6570\uff0c\u4f1a\u6709\u5f88\u591a\u8fde\u7eed\u76f8\u7b49\u7684\u90e8\u5206\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u805a\u5408\u8fde\u7eed\u76f8\u7b49\u7684\u90e8\u5206\u4e00\u8d77\u7b97\uff08\u4e5f\u5c31\u662f\u6570\u8bba\u5206\u5757\uff09\n\n\u8003\u8651\u542b\u6709$\\lfloor \\frac n i\\rfloor$ \u7684\u5f0f\u5b50\uff08\uff4e\u4e3a\u5e38\u6570\uff09\n\n\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a$i$ \u6211\u4eec\u9700\u8981\u627e\u5230\u4e00\u4e2a\u6700\u5927\u7684$j$ \u4f7f\u5f97$\\lfloor \\frac n i \\rfloor = \\lfloor \\frac n j \\rfloor$\n\n\u5219$j = \\lfloor \\frac n {\\lfloor \\frac n i \\rfloor} \\rfloor$\n\n\n\u5229\u7528\u4e0a\u8ff0\u7ed3\u8bba\uff0c\u6bcf\u6b21\u4ee5$[i,j]$\u4e3a\u4e00\u5757\n\n# \u4ee3\u7801\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N = 1e5+5;\nbool not_prime[N];\nint read() {\n    int x=0;char ch = getchar();\n    while(!isdigit(ch)) ch=getchar();\n    while(isdigit(ch)) x=x*10+ch-'0',ch=getchar();\n    return x;\n}\nint prime[N],cnt,mu[N];\nint sum[N];\nvoid mus(int n) {\n    mu[1] = 1;\n    cnt=0;\n    for(int i=2;i<=n;i++) {\n        if(!not_prime[i]) {\n            prime[++cnt] = i;\n            mu[i] = -1;\n        }\n        for(int j=1;j<=cnt && i*prime[j] <= n;j++) {\n            not_prime[i*prime[j]]=1;\n            if(i%prime[j]==0) {\n                mu[i*prime[j]] = 0;\n                break;\n            } \n            else{\n                mu[i*prime[j]] = -mu[i];\n            }\n        }\n    }\n    sum[0]=0;\n    for(int i=1;i<=n;i++) {\n        sum[i] = sum[i-1] + mu[i];\n    }\n}\nint solve(int n,int m,int k) {\n    if(n < k || m < k ) return 0;\n    if(n > m) swap(n,m);\n    int nn = n/k;\n    int mm = m/k;\n    int res=0;\n    for(int d=1;d<=nn;) {\n        int enn = nn/(nn/d);\n        int enm = mm/(mm/d);\n        int en = min(enn,enm);\n        res += (sum[en]-sum[d-1])*(nn/d)*(mm/d);\n        d = en+1;\n    }\n\n    return res;\n}\nint main() {\n    mus(100000);\n    int _=read();\n    while(_--) {\n        int a=read(),b=read(),c=read(),d=read(),k=read();\n        int ans = solve(b,d,k) - solve(a-1,d,k) - solve(b,c-1,k) + solve(a-1,c-1,k);\n        printf(\"%d\\n\",ans);\n    }\n}\n```\n\n\n",
        "postTime": 1562660900,
        "uid": 24071,
        "name": "greenty",
        "ccfLevel": 0,
        "title": "\u3010 HAOI2011\u3011 Problem b \uff08\u6570\u8bba\uff0c\u5206\u5757\uff0c\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\uff09"
    },
    {
        "content": "\u7eaa\u5ff5\u7b2c\u4e00\u6b21\u4e0d\u770b\u9898\u89e3A\u7684\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n\n\u6c42$\\sum\\limits_{i=a}^{b}\\sum\\limits_{j=c}^{d}[gcd(i,j)=k]$\n\n\u7531\u5bb9\u65a5\u539f\u7406\u53ef\u5f97\u539f\u5f0f\u53ef\u5316\u4e3a\uff1a\n\n$\\sum\\limits_{i=1}^{b}\\sum\\limits_{j=1}^{d}[gcd(i,j)=k]-(\\sum\\limits_{i=1}^{a-1}\\sum\\limits_{j=1}^{d}[gcd(i,j)=k])+\\sum\\limits_{i=1}^{b}\\sum\\limits_{j=1}^{c-1}[gcd(i,j)=k]-\\sum\\limits_{i=1}^{a-1}\\sum\\limits_{j=1}^{c-1}[gcd(i,j)=k]$\n\n\u53d1\u73b0\u8fd9\u51e0\u4e2a\u5f0f\u5b50\u53ea\u6709\u4e0a\u754c\u4e0d\u540c\uff0c\u5219\u5b9e\u9645\u4e0a\u8981\u5316\u7b80\u7684\u5f0f\u5b50\u4e3a\uff1a\n\n$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m[gcd( i,j)=k]$\n\n\u8bbe\u51fd\u6570$f(k)=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m[gcd(i,j)=k]$ \uff1a\u516c\u7ea6\u6570\u4e3a$k$\u7684\u4e2a\u6570\n\n\u8bbe\u51fd\u6570$F(k)=\\sum\\limits_{k|d}f(d) (d<=min(n,m))$\u516c\u7ea6\u6570\u4e3a$k$\u7684\u500d\u6570$(d)$\u7684\u4e2a\u6570\n\n\u5219\u6839\u636e\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff1a\n\n$f(k)=\\sum\\limits_{k|d}\\mu(\\left\\lfloor\\dfrac{d}{k}\\right\\rfloor)F(k)$\n\n$k|d$\u4e0d\u597d\u5904\u7406\uff0c\u6539\u4e3a\u679a\u4e3e$x=\\left\\lfloor\\dfrac{d}{k}\\right\\rfloor$\uff0c\u5316\u4e3a\uff1a\n\n$f(k)=\\sum\\limits_{x=1}^{min(\\frac{n}{k},\\frac{m}{k})}\\mu(x)F(xk)$\n\n$~~~~~~~~=\\sum\\limits_{x=1}^{min(\\frac{n}{k},\\frac{m}{k})}\\mu(x)\\left\\lfloor \\dfrac{n}{xk}\\right\\rfloor \\left\\lfloor \\dfrac{m}{xk}\\right\\rfloor$\n\n\u5bf9\u540e\u9762\u5206\u5757\u4e00\u4e0b\u5c31\u597d\u4e86\n\n```cpp\n#include<cstring>\n#include<string>\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\nusing namespace std;\ntypedef long long LL;\nconst int maxn=50000+9;\ninline int Read(){\n\tint x=0,f=1; char c=getchar();\n\twhile(c<'0'||c>'9'){\n\t\tif(c=='-') f=-1; c=getchar();\n\t}\n\twhile(c>='0'&&c<='9'){\n\t\tx=(x<<3)+(x<<1)+c-'0',c=getchar();\n\t}\n\treturn x*f;\n}\nint T;\nint mu[maxn],sum[maxn],prime[maxn];\nbool visit[maxn];\ninline void F_phi(LL N){\n\tmu[1]=1;\n\tint tot(0);\n\tfor(int i=2;i<=N;++i){\n\t\tif(!visit[i]){\n\t\t\tprime[++tot]=i;\n\t\t\tmu[i]=-1;\n\t\t}\n\t\tfor(int j=1;j<=tot&&i*prime[j]<=N;++j){\n\t\t\tvisit[i*prime[j]]=true;\n\t\t\tif(i%prime[j]==0)\n\t\t\t    break;\n\t\t\telse\n\t\t\t    mu[i*prime[j]]=-mu[i];\n\t\t}\n\t}\n\tfor(int i=1;i<=N;++i)\n\t    sum[i]=sum[i-1]+mu[i];\n}\ninline LL Solve(int n,int m,int d){\n\tif(n>m)\n\t\tswap(n,m);\n\tLL num(0);\n\tint N=n/d;\n\tfor(int l=1,r;l<=N;l=r+1){\n\t\tr=min((n/d)/(n/l/d),(m/d)/(m/l/d));\n\t\tnum=num+1ll*(sum[r]-sum[l-1])*1ll*((n/l/d)*1ll*(m/l/d));\n\t}\n\treturn num;\n}\nint main(){\n\tT=Read();\n\tF_phi(50000);\n\twhile(T--){\n\t\tint a=Read(),b=Read(),c=Read(),d=Read(),k=Read();\n\t\tLL ans=Solve(b,d,k)-Solve(a-1,d,k)-Solve(b,c-1,k)+Solve(a-1,c-1,k);\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}/*\n2\n2 5 1 5 1\n1 5 1 5 2\n\n14\n3\n*/\n```",
        "postTime": 1546679158,
        "uid": 88804,
        "name": "y2823774827y",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    },
    {
        "content": "\uff08\u6211\u7684\u63a8\u5bfc\u4f3c\u4e4e\u548c\u5927\u90e8\u5206\u4eba\u7684\u4e0d\u592a\u4e00\u6837  \n\u8fd9\u4e2a\u662f\u8ddd\u79bb\u9ad8\u8003\u8fd8\u670910\u5929\u5199\u7684\u2026\u2026  \n\u56e0\u4e3a\u5feb\u9ad8\u8003\u4e86\u6240\u4ee5\u653e\u98de\u81ea\u6211\uff0c\u81ea\u4e60\u8bfe\u4e0d\u60f3\u590d\u4e60\u62ff\u53cd\u6f14\u73a9\u4e00\u73a9\uff0c\u53d1\u73b0\u8fd9\u4e2a\u633a\u7b80\u5355\u7684\u554a\uff0c\u4ee5\u524d\u600e\u4e48\u5b66\u4e0d\u4f1a\u5462  \n\u5927\u6982\u662f\u5b66\u9ad8\u8003\u589e\u5f3a\u4e86\u6211\u7684\u63a8\u516c\u5f0f\u7684\u80fd\u529b\u5427  \n\n\u554a\u4e0d\u626f\u4e86\uff0c\u76f4\u63a5\u5f00\u59cb\u9898\u89e3 \n\u9996\u5148\u5fc5\u987b\u8981\u60f3\u5230\u7684\u601d\u8def\u662f\u56db\u9879\u5bb9\u65a5\u7b80\u5316\u95ee\u9898  \n\u95ee\u9898\u8f6c\u5316\u4e3a\u6c42\u6709\u5bf9\u5c11\u4e2a\u6570\u5bf9$ (x,y) $\u6ee1\u8db3$ 1\\leq x \\leq n, 1\\leq y \\leq m $\u4e14$ gcd(x,y)=1 $  \n\u770b\u8fc7\u5176\u4ed6\u53cd\u6f14\u9898\u7684\u8bdd\u53ef\u80fd\u5bb9\u6613\u60f3\u5230\uff0c$ \\sum \\sum [gcd(i,j)=1] $\u662f\u6bd4\u8f83\u597d\u7b97\u7684  \n\u90a3\u4e48\u53ef\u4ee5\u628an\u548cm\u90fd\u9664\u7b49\u4e8ek\uff0c\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a\u6c42$ \\displaystyle\\sum_{i=1}^{n} \\sum_{j=1}^{m} [gcd(i,j)=1] $  \n\u56e0\u4e3a\u8003\u8651\u5230\u5bf9\u4e8e\u539f\u6765\u7684\u6ee1\u8db3\u6761\u4ef6\u7684\u4e00\u4e2a\u6570\u5bf9$ (i,j) $\uff0c\u56e0\u4e3ai\u548cj\u7684gcd\u662fk\uff0c\u6240\u4ee5\u53ef\u4ee5\u5199\u6210\u8fd9\u6837$ (i'\\cdot k,j'\\cdot k) $\uff0c\u5e76\u4e14i'\u548cj'\u7684gcd\u662f1  \n\u663e\u7136\u82e5$ i'\\cdot k\\leq n $\uff0c\u5219$ i'\\leq \\lfloor \\frac{n}{k} \\rfloor$\uff0cj'\u540c\u7406  \n\u73b0\u5728\u7684\u95ee\u9898\u5df2\u7ecf\u76f8\u5bf9\u7b80\u5355\uff0c\u5269\u4e0b\u7684\u5c31\u662f\u63a8\u63a8\u63a8\u4e86~  \n$$ ans(n,m)=\\sum_{i=1}^{n}\\sum_{j=1}^{m}[gcd(i,j)=1] $$\n$$ =\\sum_{i=1}^{n}\\sum_{j=1}^{m}\\sum_{d|gcd(i,j)}\\mu(d) $$\n\u8fd9\u91cc\u5e94\u7528\u5230\u4e86\n$$ \\sum_{d|n}\\mu(d)=\\begin{cases}0& n=1\\\\ 1& n\\neq1 \\end{cases} $$\n\u7684\u6027\u8d28  \n\u56e0\u4e3a$ d|gcd(i,j) $\u8fd9\u4e2a\u8868\u73b0\u5f62\u5f0f\u4e0d\u597d\uff0c\u65e2\u4e0d\u5229\u4e8e\u7ee7\u7eed\u5316\u7b80\uff0c\u4ea6\u4e0d\u5229\u4e8e\u4ee3\u7801\u5b9e\u73b0\uff0c\u6240\u4ee5\u73b0\u5728\u6362\u4e00\u79cd\u8868\u793a\u65b9\u5f0f\n$$ ans(n,m)=\\sum_{d}^{min(n,m)}\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{m}{d}\\rfloor}\\mu(d) $$\n\u5148\u679a\u4e3e\u6240\u6709\u53ef\u80fd\u7684gcd\uff0c\u518d\u679a\u4e3e\u6240\u6709\u56e0\u5b50\u6709\u8fd9\u4e2agcd\u7684i\u548cj\uff0c\u4e0d\u96be\u60f3\u8c61\u548c\u5148\u679a\u4e3eij\u518d\u679a\u4e3ed\u6240\u679a\u4e3e\u5230\u7684\u4e1c\u897f\u662f\u4e00\u6837\u7684\uff0c\u8fd9\u4e2a\u4f3c\u4e4e\u662f\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u91cc\u5e38\u7528\u7684\u8f6c\u5316\u65b9\u6cd5  \n$$ ans(n,m)=\\sum_{d}^{min(n,m)}\\mu(d)\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{m}{d}\\rfloor}1 $$\n\u56e0\u4e3ad\u548cij\u7684\u679a\u4e3e\u60c5\u51b5\u65e0\u5173\u6240\u4ee5\u53ef\u4ee5\u63d0\u5230\u524d\u9762\u6765  \n\u540e\u9762\u7684\u4e1c\u897f\u5c31\u53ef\u4ee5\u79d2\u7b97\u4e86\n$$ ans(n,m)=\\sum_{d}^{min(n,m)}\\mu(d)\\cdot \\lfloor \\frac{n}{d} \\rfloor \\cdot \\lfloor \\frac{m}{d}\\rfloor $$\n\u81f3\u6b64\u516c\u5f0f\u63a8\u5bfc\u5b8c\u6bd5  \n\u6211\u7684\u63a8\u5bfc\u548cpopoqqq\u7684\u4e0d\u592a\u4e00\u6837\uff0c\u4ed6\u662f\u6784\u9020\u4e86f\u548cF\u5e76\u4f7f\u7528\u53cd\u6f14\u7684\u516c\u5f0f\uff0c\u6211\u662f\u6839\u636e\u53cd\u6f14\u7684\u6027\u8d28\u6765\u8f6c\u5316\u95ee\u9898\uff0c\u73b0\u5728\u770b\u6765\u4e24\u79cd\u65b9\u6cd5\u672c\u8d28\u662f\u4e00\u6837\u7684  \n\u6211\u7684\u601d\u8def\u53d7\u300acrash\u7684\u8868\u683c\u300b\u8fd9\u9053\u9898\u7684\u5f71\u54cd\u6bd4\u8f83\u6df1  \n\u76f4\u63a5$ O(n) $\u8ba1\u7b97\u4f1aT\uff08\u56e0\u4e3a\u6709n\u7ec4\u8be2\u95ee\uff09\uff0c\u9700\u8981\u7528\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5e38\u7528\u7684$ O(\\sqrt{n}) $\u6c42\u7b54\u6848\u7684\u8ba1\u7b97\u65b9\u5f0f\uff0c\u8fd9\u4e2a\u5728po\u59d0\u7684ppt\u91cc\u89e3\u91ca\u5f97\u5f88\u6e05\u695a\uff0c\u4e0d\u5728\u8d58\u8ff0  \n\u4ee3\u7801\uff1a  \n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\nusing namespace std;\nint rd(){int z=0,mk=1;  char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')mk=-1;  ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){z=(z<<3)+(z<<1)+ch-'0';  ch=getchar();}\n\treturn z*mk;\n}\nint n,m,n1,n2,m1,m2;\nint mu[51000],mus[51000];  //mu's!!!!!!\nint prm[51000],prt=0;  bool prg[51000];\nvoid gtmu(){\n\tmemset(prg,0,sizeof(prg));\n\tmu[1]=mus[1]=1;  //\u6ce8\u610fmu[1]=1\n\tfor(int i=2;i<=50000;++i){\n\t\tif(!prg[i])  prm[++prt]=i,mu[i]=-1;\n\t\tfor(int j=1;prm[j]*i<=50000 && j<=prt;++j){\n\t\t\tprg[prm[j]*i]=true;\n\t\t\tif(!(i%prm[j])){  mu[i*prm[j]]=0;  break;}\n\t\t\tmu[prm[j]*i]=-mu[i];\n\t\t}\n\t\tmus[i]=mus[i-1]+mu[i];\n\t}\n}\nint sm(int x,int y){  return (x+1)*x*(y+1)*y/4;}\nint cclt(int x,int y){\n\tif(x>y)  swap(x,y);\n\tint tmp,bwl=0;\n\tfor(int i=1;i<=x;i=tmp+1){\n\t\ttmp=min(x/(x/i),y/(y/i));\n\t\t//bwl+=sm(x/i,y/i)*(mus[tmp]-mus[i-1]);\n\t\tbwl+=(x/i)*(y/i)*(mus[tmp]-mus[i-1]);\n\t}\n\treturn bwl;\n}\nint main(){freopen(\"ddd.in\",\"r\",stdin);\n\tgtmu();\n\tcin>>n;\n\twhile(n --> 0){  //\u8d8b\u5411\u4e8e\n\t\t//cin>>n1>>n2>>m1>>m2>>m;\n\t\tn1=rd(),n2=rd(),m1=rd(),m2=rd(),m=rd();\n\t\tprintf(\"%d\\n\",cclt(n2/m,m2/m)+cclt((n1-1)/m,(m1-1)/m)-cclt((n1-1)/m,m2/m)-cclt(n2/m,(m1-1)/m));\n\t\t//\u6ce8\u610f-1\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1527415286,
        "uid": 26087,
        "name": "cdcq",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    },
    {
        "content": "\u5bf9\u4e8e\u5355\u6b21\u8be2\u95ee:\n\n\u7c7b\u4f3c\u4e8c\u7ef4\u524d\u7f00\u548c,\u95ee\u9898\u53ef\u4ee5\u8f6c\u6362\u4e3a\u6c42[1,n] [1,m]\u4e2d\u6ee1\u8db3gcd==k\u7684\u5bf9\u6570;\n\n\u6700\u66b4\u529bO(n2)\u5c31\u4e0d\u8bf4\u4e86\u5427;\n\n\u4f7f\u7528NOI2010\u80fd\u91cf\u91c7\u96c6\u7684\u65b9\u6cd5,\u6211\u4eec\u53ef\u4ee5\u505a\u5230nlogn\n\n//\u8bbef(i)\u8868\u793agcd==i\u7684\u5bf9\u6570,g(i)\u8868\u793agcd|(\u6574\u9664)i\u7684\u4e2a\u6570,\u5219g(i)=(n/i)\\*(m/i);   f(i)=g(i)-sigemaf(i\\*kkk);(kkk\\*i<=n);\n\n\u53c8\u56e0\u4e3ag(i)=\u03a3i|d f(d); \u53cd\u6f14\u540e\u5f97:f(i)=\u03a3i|d mu(d/i)g(d)=\u03a3i|d mu(d/i) (n/i)\\*(m/i);\n\u6211\u4eec\u5c31\u53ef\u4ee5O(n)\u5730\u5904\u7406\u6bcf\u4e00\u4e2a\u8be2\u95ee\u4e86;\n\n\n\u4f46\u8be2\u95ee\u592a\u591a,\u6211\u4eec\u65e0\u6cd5\u5904\u7406\n\n\u89c2\u5bdf\u5f0f\u5b50,\u6211\u4eec\u53d1\u73b0 (n/i) \u53ea\u6709sqrt(n)\u79cd\u53d6\u503c; (n/i) \\*(m/i) \u5c31\u53ea\u67092sqrt(n)+2sqrt(m) \u79cd\u53d6\u503c\n\n\u679a\u4e3e\u8fd9\u4e9b\u53d6\u503c,\u5e76\u5bf9mu\u7ef4\u62a4\u524d\u7f00\u548c\u5c31\u53ef\u4ee5\u505a\u5230\u603b\u590d\u6742\u5ea6O(nsqrt(n))\u4e86;\n\n\n\u540e\u9762\u6838\u5fc3\u4ee3\u7801:\n\n\n```cpp\nlong long solve(long long n,long long m)\n{\n    n/=k;m/=k;\n    long long last,tot=0;if (m<n) swap(n,m);\n    for (long long i=1;i<=n;i=last+1)\n    {\n        last=min(n/(n/i),m/(m/i));\n        tot+=(n/i)*(m/i)*(sum[last]-sum[i-1]);\n    }\n    return tot;\n}\n```\n\u53c2\u89c1 \u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14 byPoPoQQQ;",
        "postTime": 1478090537,
        "uid": 10450,
        "name": "fcba",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    },
    {
        "content": "\u6b64\u9898\u5999\u4e0d\u53ef\u8a00\uff0c\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u88f8\u9898\uff0c\u548cHDU1695\u5f88\u50cf\uff0c\u4f46\u662f\u90a3\u9898\u4fdd\u8bc1\u4e86a=c=1\uff0c\u6240\u4ee5\u90a3\u9898\u662f\u771f\u7684\u6c34\u7206\u4e86\uff0c\u8fd9\u9053\u9898\u4e2d\u628aa\u548cc\u4e0d\u4e3a0\u7b97\u4e4b\u540e\uff0c\u5c31\u53c8\u591a\u4e86\u4e00\u4e2a\u8003\u70b9\uff1a\u5bb9\u65a5\u539f\u7406\n```cpp\n#include<bits/stdc++.h>\n#define MAX 50001\nusing namespace std;\nint p[50005],mu[50005],MU[50005];\nbool p_b[50005];\nvoid mobius()\n{\n    int i,j,num;\n    num=0;\n    p_b[1]=true;\n    mu[1]=1;\n    MU[1]=1;\n    for (i=2;i<=MAX;i++)\n    {\n        if (!p_b[i])\n        {\n            p[num++]=i;\n            mu[i]=-1;\n        }\n        for (j=0;j<=num&&i*p[j]<=MAX;j++)\n        {\n            p_b[i*p[j]]=true;\n            if (i%p[j]==0)\n            {\n                mu[i*p[j]]=0;\n                break;\n            }\n            mu[i*p[j]]=-mu[i];\n        }\n    }\n    for (i=2;i<=MAX;i++) MU[i]=MU[i-1]+mu[i];\n}\nint solve(int l,int r)\n{\n    int i,last,ans;\n    last=ans=0;\n    for (i=1;i<=min(l,r);i=last+1)\n    {\n        last=min(l/(l/i),r/(r/i));\n        ans+=(MU[last]-MU[i-1])*int(l/i)*int(r/i);\n    }\n    return ans;\n}\nint main()\n{\n    mobius();\n    int n;\n    scanf(\"%d\",&n);\n    for (;n--;)\n    {\n        int a,b,c,d,x;\n     \tscanf(\"%d%d%d%d%d\",&a,&b,&c,&d,&x);\n     \ta-=1,c-=1;\n        a/=x,b/=x,c/=x,d/=x;\n        printf(\"%d\\n\",solve(b,d)+solve(a,c)-solve(a,d)-solve(c,b));\n    }\n}\n```",
        "postTime": 1520866046,
        "uid": 20648,
        "name": "WJCwjc142857",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    },
    {
        "content": "\u8fd9\u9898\u4f1a\u7528\u5230\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u5176\u4e2d\u7684\u539f\u7406\u5df2\u7ecf\u88ab\u4e24\u4f4d\u795e\u7287\u8bb2\u7684\u5f88\u6e05\u695a\u4e86\u3002\u8fd9\u91cc\u5c31\u7ed9\u51fa\u4ee3\u7801\uff1a\n\n```cpp\n#include <iostream>\n\nusing namespace std;\n\nconst int maxn=100007;\n\nint u[maxn];\n\nbool notprime[maxn]={};\nint prime[maxn]={};\nint primenum=0;\n\nint prefix[maxn]={};\n\nint min(int a,int b)\n{\n\treturn a<b?a:b;\n}\n\nvoid swap(int &a,int &b)\n{\n\tint tmp=a;\n\ta=b;\n\tb=tmp;\n}\n\nint N;\nint a,b,c,d,k;\n\nvoid Mobius()//\u6c42\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\n{\n\tu[1]=1;\n\tfor(int i=2;i<maxn;i++)\n\t{\n\t\tif(!notprime[i])\n\t\t{\n\t\t\tprime[++primenum]=i;\n\t\t\tu[i]=-1;\n\t\t}\n\t\tfor(int j=1;j<=primenum && prime[j]*i<maxn;j++)\n\t\t{\n\t\t\tnotprime[prime[j]*i]=1;\n\t\t\tif(i%prime[j]==0)\n\t\t\t{\n\t\t\t\tu[prime[j]*i]=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tu[prime[j]*i]=-u[i];\n\t\t}\n\t}\n}\n\nint solve(int n,int m)\n{\n\tn/=k;\n\tm/=k;\n\tint tot=0,last=0;\n\tif(m<n)\n\t    swap(n,m);\n\tfor(int i=1;i<=n;i=1+last)\n\t{\n\t\tlast=min(n/(n/i),m/(m/i));\n\t\ttot+=(prefix[last]-prefix[i-1])*(n/i)*(m/i);\n\t}\n\treturn tot;\n}\n\nint main()\n{\n\tMobius();\n\tfor(int i=1;i<maxn;i++)\n\t\tprefix[i]=prefix[i-1]+u[i];//\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u7684\u524d\u7f00\u548c\n\tcin>>N;\n\tint ans=0;\n\tfor(int i=0;i<N;i++)\n\t{\n\t\tans=0;\n\t\tcin>>a>>b>>c>>d>>k;\n\t\tans=solve(b,d)+solve(a-1,c-1)-solve(a-1,d)-solve(c-1,b);//\u5bb9\u65a5\u539f\u7406\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}\n\n```\n\n\u5176\u4e2d\u6c42\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u7528\u5230\u4e86\u7ebf\u6027\u7b5b\u3002\n\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u6027\u8d28\uff1a\n\n(1) d=1  \nu(d)=1\n\n(2) d=p1*p2*p3*...*pk,\u5176\u4e2dpi\u4e3a\u4e92\u5f02\u7d20\u6570  \nu(d)=(-1)^k\n\n(3) \u5176\u4ed6\u60c5\u51b5  \nu(d)=0\n",
        "postTime": 1520040211,
        "uid": 38188,
        "name": "\u6570\u5b66\u7cfb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2522 \u3010[HAOI2011]Problem b\u3011"
    }
]
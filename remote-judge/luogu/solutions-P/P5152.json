[
    {
        "content": "# \u849f\u84bb\u7684\u7b2c\u4e00\u7bc7\u9898\u89e3\n\n(update:\u4e8c\u7ef4\u6570\u7ec4\u533a\u95f4\u4fee\u6539\u6a21\u677f\u4e2d\u6709\u5730\u65b9\u6709\u8bef\uff0c\u5df2\u66f4\u6b63)\n~~\u4e00\u4f4d\u9898\u89e3\u91cd\u5ea6\u4f9d\u8d56\u60a3\u8005\u7531\u4e8e\u6ca1\u6709\u9898\u89e3\u88ab\u8feb\u8425\u4e1a\u7684\u60b2\u60e8\u7ecf\u5386~~\n\n\u62ff\u5230\u9898\u7684\u7684\u7b2c\u4e00\u6b65\u5f53\u7136\u662f~~\u67e5\u770b\u9898\u89e3~~\u5ba1\u9898\u3002\u76f8\u4fe1\u5728\u5ea7\u7684\u795e\u7287\u4eec\u90fd\u5df2\u7ecf\u770b\u51fa\u6765\u4e86\uff0c(~~\u6211\u771f\u7684\u6ca1\u6709\u770b\u7b97\u6cd5\u6807\u7b7e~~)\uff0c\n\u8fd9\u9898\u662f\u4e00\u9053\u6811\u72b6\u6570\u7ec4\u7684\u9898\uff0c\u5728\u5237\u5b8c\u4e24\u9053\u6811\u72b6\u6570\u7ec4\u7684\u6a21\u677f\u9898\u540e\uff0c\u76f4\u63a5\u5f00\u59cb\u4e86\u5f3a\u8f6c\u4e00\u7ef4\u6811\u72b6\u6570\u7ec4\u7684\u66b4\u529b\u89e3\u6cd5\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 2500;\nconst int K = 31;\nint x0, Y0, x1, Y1;\nint m, n, k;\nint sum1[N*N + 1][K], sum2[N*N + 1][K];\nchar op;\nint lowbit(int x) {\n\treturn x & -x;\n}\nvoid update(int i, int ak, int bk) {\n\tint x = i;\n\twhile (i <= n * n) {\n\t\tsum1[i][ak] += bk;\n\t\tsum2[i][ak] += (x - 1)*bk;\n\t\ti += lowbit(i);\n\t}\n}\nint getsum(int i, int k) {\n\tint x = i;\n\tint ans = 0;\n\twhile (i != 0) {\n\t\tans += (x * sum1[i][k] - sum2[i][k]);\n\t\ti -= lowbit(i);\n\t}\n\treturn ans;\n}\nint main()\n{\n\tcin >> n >> m;\n\twhile (m--) {\n\t\tcin >> op;\n\t\tif (op == 'P') {\n\t\t\tcin >> x0 >> Y0 >> x1 >> Y1 >> k;\n\t\t\twhile (k--) {\n\t\t\t\tint ak, bk;\n\t\t\t\tcin >> ak >> bk;\n\t\t\t\tif (bk & 1) {\n\t\t\t\t\tfor (int y = Y0; y <= Y1; y++) {\n\t\t\t\t\t\tupdate(x0 + (y - 1) * n, ak, bk);\n\t\t\t\t\t\tupdate(x1 + (y - 1) * n + 1, ak, -bk);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (op == 'Q') {\n\t\t\tcin >> x0 >> Y0 >> x1 >> Y1;\n\t\t\tfor (int i = 1; i <= 30; i++)\n\t\t\t{\n\t\t\t\tint sum = 0;\n\t\t\t\tfor (int y = Y0; y <= Y1; y++) {\n\t\t\t\t\tsum += getsum(x1 + (y - 1) * n, i) - getsum(x0 + (y - 1) * n - 1, i);\n\t\t\t\t}\n\t\t\t\tcout << ((sum % 2) + 1);\n\t\t\t}\n\t\t\tcout << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n\u7ed3\u679c\u5f53\u7136\u662fMLE+TLE\u5927\u9910(~~\u5176\u5b9e\u4e09\u4e2a\u70b9\u771f\u9999~~)\uff0c\u663e\u7136\u6b64\u9898\u7684\u6b63\u89e3\u4e0d\u662f\n\u5f3a\u8f6c\u4e00\u7ef4\u6811\u72b6\u6570\u7ec4\uff0c\u800c\u662f\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\uff0c\u5728\u5206\u6790\u5f00\u59cb\u6211\u5148\u4ecb\u7ecd\u4e00\u4e0b\u4e8c\u7ef4\u6570\u7ec4\u7684\u4e09\u79cd\u9898\u578b\u4ee5\u53ca\u5bf9\u5e94\u7684\u6a21\u677f\u4ee3\u7801\u3002\n\n\n## \u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\n\n### 1.\u5355\u70b9\u4fee\u6539+\u533a\u95f4\u67e5\u8be2\n\n\n```cpp\n//while\u7528for\u5199\u4e5f\u662f\u4e00\u6837\u7684\nvoid update(int x, int y, int z){\n    int _y = y;\n    while(x <= n){\n        y = _y;\n        while(y <= n)\n            tree[x][y] += z, y += lowbit(y);\n        x += lowbit(x);\n    }\n}\nvoid query(int x, int y){\n    int ans = 0, _y = y;\n    while(x){\n        y = _y;\n        while(y)\n            ans += tree[x][y], y -= lowbit(y);\n        x -= lowbit(x);\n    }\n}\n\n```\n### 2.\u533a\u95f4\u4fee\u6539+\u5355\u70b9\u67e5\u8be2\n\n\u7c7b\u4f3c\u4e8e\u4e00\u7ef4\u7684\u5904\u7406\uff0c\u53ef\u4ee5\u8bbe\u5dee\u5206\u6570\u7ec4\n$d[i]=a[i][j]-a[i-1][j]+a[i][j-1]-a[i-1][j-1]$\n\u6a21\u677f\u5982\u4e0b\uff1a\n```cpp\n//\u7528\u4e07\u80fd\u5934\u7684\u9009\u624b\u4e0d\u8981\u4f7f\u7528x1,y1\nvoid update(int x, int y, int z){ \n    int _y = y;\n    while(x <= n){\n        y = _y;\n        while(y <= n)\n            tree[x][y] += z, y += y & -y;\n        x += x & -x;\n    }\n}\nvoid range_update(int x1, int y1, int x2, int y2, int val){\n    update(x1, y1, val);\n    update(x1, y2 + 1, -val);\n    update(x2 + 1, y1, -val);\n    update(x2 + 1, y2 + 1, val);\n}\nvoid ask(int x, int y){\n    int ans = 0, _y = y;\n    while(x){\n        y = _y;\n        while(y)\n            ans += tree[x][y], y -= lowbit(y);\n        x -= lowbit(x);\n    }\n}\n```\n### 3.\u533a\u95f4\u4fee\u6539+\u533a\u95f4\u67e5\u8be2\n\u7c7b\u6bd4\u4e00\u7ef4\u6811\u72b6\u6570\u7ec4\u7684\u533a\u95f4\u4fee\u6539\u67e5\u8be2\uff0c(x,y)\u7684\u524d\u7f00\u548c\uff1a\n$\\sum_{i=1}^{x}\\sum_{j=1}^{y}\\sum_{k=1}^{i}\\sum_{h=1}^{j}d[h][k]$\n\u5176\u4e2d,$d[1][1]$\u51fa\u73b0\u4e86$x*y$\u6b21,$d[1][2]$\u51fa\u73b0\u4e86$x*(y-1)$\u6b21\n\u4e8e\u662f\n$\\sum_{i=1}^{x}\\sum_{j=1}^{y}\\sum_{k=1}^{i}\\sum_{h=1}^{j}d[h][k]=\\sum_{i=1}^{x}\\sum_{j=1}^{y}d[i][j]*(x+1-i)*(y+1-j)$\n\u5c55\u5f00\u5f97\n\n$(x+1)*(y+1)*\\sum_{i=1}^{x}\\sum_{j=1}^{y}d[i][j]$\n$-(y+1)*\\sum_{i=1}^{x}\\sum_{j=1}^{y}d[i][j]*i$\n$-(x+1)*\\sum_{i=1}^{x}\\sum_{j=1}^{y}d[i][j]*j$\n$+\\sum_{i=1}^{x}\\sum_{j=1}^{y}d[i][j]*i*j$\n\n\u90a3\u4e48\u6211\u4eec\u9700\u8981\u7ef4\u62a4\u56db\u4e2a\u6811\u72b6\u6570\u7ec4\uff1a\n$d[i][j],d[i][j]*i,d[i][j]*j,d[i][j]*i*j$\n\n\u4ee3\u7801\u6a21\u677f\u5982\u4e0b\uff1a\n\n```cpp\nvoid update(int x, int y, int val) {\n\tfor (int X = x; X <= n; X += lowbit(X))\n\t\tfor (int Y = y; Y <= m; Y += lowbit(Y)) {\n\t\t\tt1[X][Y] += val;\n\t\t\tt2[X][Y] += val *x;\n\t\t\tt3[X][Y] += val * y;\n\t\t\tt4[X][Y] += val * x * y;\n\t\t}\n}\nvoid range_update(int xa, int ya, int xb, int yb, int val) { \n\tupdate(xa, ya, val);\n\tupdate(xa, yb + 1, -val);\n\tupdate(xb + 1, ya, -val);\n\tupdate(xb + 1, yb + 1, val);\n}\nint query(int x, int y) {\n\tint res = 0;\n\tfor (int i = x; i; i -= i & -i)\n\t\tfor (int j = y; j; j -= j & -j)\n\t\t\tres += (x + 1) * (y + 1) * t1[i][j]\n\t\t\t- (y + 1) * t2[i][j]\n\t\t\t- (x + 1) * t3[i][j]\n\t\t\t+ t4[i][j];\n\treturn res;\n}\nint range_query(int xa, int ya, int xb, int yb) {\n\treturn query(xb, yb) - query(xb, ya - 1) - query(xa - 1, yb) + query(xa - 1, ya - 1);\n}\n```\n## \u9898\u76ee\u5206\u6790\n\n\u5f88\u660e\u663e\u8fd9\u9053\u9898\u5c5e\u4e8e\u4ee5\u4e0a\u5206\u6790\u7684\u7b2c\u4e09\u79cd\u9898\u578b\u533a\u95f4\u4fee\u6539+\u533a\u95f4\u67e5\u8be2\uff0c\u5957\u7528\u6a21\u677f\u53ef\u5f97\u4ee5\u4e0b\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 2500 + 1;\nconst int K = 31;\nint t1[N][N][K], t2[N][N][K], t3[N][N][K], t4[N][N][K];\t//\u7b2c\u4e09\u4e2a\u7ef4\u5ea6\u8868\u793a\u79cd\u7c7b\nint m, n, k;\nint X1, Y1, X2, Y2;\nint ak, bk;\nchar op;\nint lowbit(int x)\n{\n\treturn x & -x;\n}\nvoid update(int x, int y, int k, int p)\n{\n\tfor (int X = x; X <= n; X += lowbit(X))\n\t\tfor (int Y = y; Y <= n; Y += lowbit(Y)) {\n\t\t\tt1[X][Y][k] += p;\n\t\t\tt2[X][Y][k] += p * x;\n\t\t\tt3[X][Y][k] += p * y;\n\t\t\tt4[X][Y][k] += p * x * y;\n\t\t}\n}\nvoid range_update(int xa, int ya, int xb, int yb, int k, int p)\n{\n\tupdate(xa, ya, k, p);\n\tupdate(xa, yb + 1, k ,-p);\n\tupdate(xb + 1, ya, k, -p);\n\tupdate(xb + 1, yb + 1, k, p);\n}\nint query(int x, int y, int k)\n{\n\tint ans = 0;\n\tfor (int i = x; i; i -= lowbit(i))\n\t\tfor (int j = y; j; j -= lowbit(j))\n\t\t\tans += (x + 1)*(y + 1)*t1[i][j][k]\n\t\t\t- (y + 1)*t2[i][j][k]\n\t\t\t- (x + 1)*t3[i][j][k]\n\t\t\t+ t4[i][j][k];\n\treturn ans;\n}\nint range_query(int xa, int ya, int xb, int yb, int k)\n{\n\treturn query(xb, yb, k) - query(xb, ya - 1, k) - query(xa - 1, yb, k) + query(xa - 1, ya - 1, k)  ;\n}\nint main()\n{\n\tios::sync_with_stdio(false);\n\tcin >> n >> m;\n\twhile (m--) {\n\t\tcin >> op;\n\t\tif (op == 'P')\n\t\t{\n\t\t\tcin >> X1 >> Y1 >> X2 >> Y2 >> k;\n\t\t\twhile (k--)\n\t\t\t{\n\t\t\t\tcin >> ak >> bk;\n\t\t\t\trange_update(X1, Y1, X2, Y2, ak, bk);\n\t\t\t}\n\t\t}\n\t\tif (op == 'Q')\n\t\t{\n\t\t\tcin >> X1 >> Y1 >> X2 >> Y2;\n\t\t\tfor (int i = 1; i <= 30; i++)\n\t\t\t\tcout<<((range_query(X1, Y1, X2, Y2, i)%2)+1);\n\t\t\tcout << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\u5f88\u62b1\u6b49\uff0c\u8fd9\u6b2130\u5206\u4e5f\u6ca1\u6709\uff0c\u672c\u5730\u4f1a\u76f4\u63a5\u62a5\u9519\uff1aLNK1248\t\u6620\u50cf\u5927\u5c0f(BA135000)\u8d85\u8fc7\u5141\u8bb8\u7684\u6700\u5927\u5927\u5c0f(80000000)\uff0c(~~\u901a\u8fc7\u67e5\u9605\u8d44\u6599)~~\u4ed4\u7ec6\u5206\u6790\u53d1\u73b0\u8fd9\u548c\u5f3a\u8f6c\u4e00\u7ef4\u5f97\u5230\u5927\u5c0f\u6ca1\u6709\u53d8\u5316\u53ef\u80fd\u751a\u81f3\u8fd8\u8d85\u8fc7\u3002\u89c2\u5bdf\u5230\u9898\u76ee\u4ec5\u6709\u6700\u591a30\u79cd\u7269\u4ef6\uff0c\u4e8e\u662f\u6211\u4eec\u8003\u8651\u72b6\u6001\u538b\u7f29\uff0c\u7528\u6bcf\u4e00\u4f4d\u8868\u793a\u7269\u54c1\u5947\u5076\u6027(0\u8868\u793a\u5076\u6570\u4e2a\uff0c1\u8868\u793a\u5947\u6570\u4e2a)\uff0c\u81ea\u7136\u800c\u7136\u5730\u5c31\u4f1a\u60f3\u5230\u5f02\u6216\u8fd0\u7b97\u3002\u5b8c\u6574AC\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 2500 + 1;\nconst int K = 5;\nunsigned int t1[N][N], t2[N][N], t3[N][N], t4[N][N];\nint m, n, k;\nint X1, Y1, X2, Y2;\nint ak, bk;\nunsigned int ans, val;\nchar op;\nint lowbit(int x)\n{\n\treturn x & -x;\n}\nvoid update(int x, int y, unsigned int p)\n{\n\tfor (int X = x; X <= n; X += lowbit(X))\n\t\tfor (int Y = y; Y <= n; Y += lowbit(Y)) {\n\t\t\tt1[X][Y] ^= p;\n\t\t\tt2[X][Y] ^= ((y) & 1) ? p : 0;\t//\u5982\u679c(y-1)\u662f\u5076\u6570\uff0c\u4e58\u4ee5\u4efb\u4f55\u6570\u4e5f\u662f\u5076\u6570\uff0c\u5bf9\u7ed3\u679c\u4e0d\u5f71\u54cd\n\t\t\tt3[X][Y] ^= ((x) & 1) ? p : 0;\n\t\t\tt4[X][Y] ^= ((x)&(y) & 1) ? p : 0;\n\t\t}\n}\nvoid range_update(int xa, int ya, int xb, int yb, int p)\n{\n\tupdate(xa, ya, p);\n\tupdate(xa, yb + 1 ,p);\n\tupdate(xb + 1, ya, p);\n\tupdate(xb + 1, yb + 1, p);\n}\nunsigned int query(int x , int y)\n{\n\tunsigned int ans = 0;\n\tfor (int i = x; i; i -= lowbit(i))\n\t\tfor (int j = y; j; j -= lowbit(j))\n\t\t\tans ^= (((x + 1)&(y + 1)&1)?t1[i][j]:0)^\n\t\t\t(((x + 1) & 1) ? t2[i][j] : 0) ^\n\t\t\t(((y + 1) & 1) ? t3[i][j] : 0) ^\n\t\t\tt4[i][j];\n\treturn ans;\n}\nunsigned int range_query(int xa, int ya, int xb, int yb)\n{\n\treturn query(xb, yb) ^ query(xb, ya - 1) ^ query(xa - 1, yb) ^ query(xa - 1, ya - 1)  ;\n}\nint main()\n{\n\tios::sync_with_stdio(false);\n\tcin >> n >> m;\n\twhile (m--) {\n\t\tcin >> op;\n\t\tif (op == 'P')\n\t\t{\n\t\t\tval = 0;\n\t\t\tcin >> X1 >> Y1 >> X2 >> Y2 >> k;\n\t\t\twhile (k--)\n\t\t\t{\n\t\t\t\tcin >> ak >> bk;\n\t\t\t\tif (bk & 1)\n\t\t\t\t\tval ^= (1 << ak);//\u53ea\u6709\u5947\u6570\u4e2a\u6709\u66f4\u65b0\u7684\u5fc5\u8981\uff0c\u5076\u6570\u4e2a\u4e0d\u5f71\u54cd\u7ed3\u679c\n\t\t\t}\n\t\t\trange_update(X1, Y1, X2, Y2, val);\n\t\t}\n\t\tif (op == 'Q')\n\t\t{\n\t\t\tcin >> X1 >> Y1 >> X2 >> Y2;\n\t\t\tans = range_query(X1, Y1, X2, Y2);\n\t\t\tfor (int i = 1; i <= 30; i++)\n\t\t\t{\n\t\t\t\tans = ans >> 1;\n\t\t\t\tif (ans & 1)\n\t\t\t\t\tcout << 2;\n\t\t\t\telse\n\t\t\t\t\tcout << 1;\n\t\t\t}\n\t\t\t\tcout << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n\u770b\u5728~~\u6211\u7801\u7684\u8f9b\u82e6~~\u8fd9\u662f\u7b2c\u4e00\u7bc7\u8be5\u9898\u7684\u8be6\u7ec6\u9898\u89e3\u7684\u4efd\u4e0a\uff0c\u5404\u4f4d\u5927\u4f6c\u4f55\u4e0d\u7559\u4e2a\u8d5e\u518d\u8d70\uff1f",
        "postTime": 1584239687,
        "uid": 235344,
        "name": "tcl_tcl_tcl",
        "ccfLevel": 0,
        "title": "P5152"
    },
    {
        "content": "\u611f\u89c9\u662f\u4e00\u9053\u8fd8\u884c\u7684\u7ebf\u6bb5\u6811\uff08~~\u6811\u72b6\u6570\u7ec4~~\uff09\u9898\n\n\u9996\u5148\u4e8c\u7ef4\u7684\u7ebf\u6bb5\u6811\u663e\u7136\u6211\u662f\u4e0d\u4f1a\u7684\uff0c\u4e8e\u662f\u628a\u4e8c\u7ef4\u8f6c\u6210\u4e00\u7ef4\u518d\u8fdb\u884c\u8ba1\u7b97$\uff082500*2500\uff09$\u7684\u6570\u636e\u5e94\u8be5\u4e0d\u4f1a\u7206\u7a7a\u95f4\u3002\u3002\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u50cf\u4e00\u822c\u7684\u7ebf\u6bb5\u6811\u4e00\u6837\u8ba1\u7b97\u4e86\uff0c\u53ea\u662f\u628a\u548c$ /$\u6700\u5c0f\u503c\u6539\u4e3a\u5947\u5076\u5224\u65ad\u5427\u2026\u2026\uff0c\u6ce8\u610f\u50761\u59472\uff0c\u518d\u62ff\u4e2a\u6570\u7ec4\u5b58\u4e00\u4e0b1\u8fd8\u662f2\uff0c\u5e94\u8be5\u5dee\u4e0d\u591a\u4e86\u3002\n\n\u4e00\u773c\u770b\u4e0a\u53bb\u5c31\u662f\u8fd9\u4e2a\u6837\u5b50\uff0c\u4ee3\u7801\u81ea\u5df1\u6ca1\u5199\u8fc7\uff0c\u601d\u8def\u5e94\u8be5\u662f\u6b63\u5e38\u7684\u3002\n\n\u5495\u5495",
        "postTime": 1583221978,
        "uid": 46354,
        "name": "\u8ff7\u6b8b\u4e91",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5152 \u3010\u5b9d\u85cf\u3011"
    }
]
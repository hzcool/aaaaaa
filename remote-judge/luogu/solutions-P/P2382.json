[
    {
        "content": "\u5316\u5b66\u5206\u5b50\u5f0f\uff0c\u55ef\uff0c\u5927\u5bb6\u5f88\u719f\u6089\u7684\u5bf9\u5427\u2026\u2026\n\n\u4f46\u662f\uff0c\u8fd9\u6539\u53d8\u4e0d\u4e86\u53ea\u662f\u4e00\u9053\u6a21\u62df\u9898\u7684\u4e8b\u5b9e\uff01\n\n\u6211\u4eec\u53d1\u73b0\u6709\u4e00\u7cfb\u5217\u8fd9\u6837\u7684\u9898\u76ee\u2014\u2014\u5b57\u7b26\u4e32\uff0c\u53c8\u5d4c\u5957\uff0c\u7c7b\u4f3c\u4e8e2017\u63d0\u9ad8\u7ec4\u7684Day1T2\uff0c\u5b83\u4eec\u7684\u89e3\u6cd5\u4e5f\u6709\u4e00\u79cd\u5171\u6027\uff0c\u5806\u6808\u7f62\u4e86\u3002\u9012\u5f52\u4e5f\u597d\uff0c\u5faa\u73af\u4e5f\u7f62\u2026\u2026\u53cd\u6b63\u80fd\u641e\u51fa\u6765\u5c31OK\u5566qwq~\n\n\u672c\u4eba\u6b3a\u8fd9\u9898\u6570\u636e\u7279\u5c0f\uff0cmap, string\u4e71\u641e\u4e00\u4e0b\uff0c\u54c8\u5e0c\u6216\u8005\u66b4\u529b\u626b\u63cf\u4e5f\u884c\u7684\u5566\u3002\n\n1\u3001\u9047\u5230'('\uff0c\u6211\u4eec\u5c31\u628a\u6808\u7684\u5c42\u6570+1\uff0c\u4ee5\u4fbf\u51fa\u6808\u65f6\u7d2f\u8ba1\n\n2\u3001\u9047\u5230\u5b57\u6bcd\u540e\uff0c\u5224\u65ad\u4e0b\u4e00\u4f4d\u662f\u5426\u662f\u5c0f\u5199\u5b57\u6bcd\uff0c\u5c06\u5176\u5728map\u4e2d\u7684\u503c\u53d6\u51fa\u52a0\u5165\u6808\u4e2d\uff0c\u518d\u5c06\u6700\u8fd1\u4e00\u6b21\u7684\u5143\u7d20\u4fdd\u5b58\uff08\u6682\u8bb0\u4f5ckey\uff09\uff0c\u7b49\u4f1a\u6709\u7528^\\_^\uff0c\u522b\u5fd8\u4e86\u5224\u65adUNKNOWN\u3002\n\n3\u3001\u9047\u5230\u6570\u5b57\uff0cwhile\u5faa\u73af\u53d6\u51fa\u5b83\uff08\u8bb0\u4f5cx\uff09\uff0c\u8bf4\u660e\u4e0a\u6b21\u7684key\u6709\u4e86\u7528\u6b66\u4e4b\u5730\uff0c\u5728\u6808\u4e2d\u52a0\u5165\uff08x - 1\uff09\u500d\u7684key\u5143\u7d20\u8d28\u91cf\uff0c\u56e0\u4e3a\u4e0a\u4e00\u6b21\u52a0\u4e86\u4e00\u4efd\u561b\n\n4\u3001\u82e5\u9047\u5230')'\uff0c\u6211\u4eec\u8003\u8651\u76f4\u63a5\u53d6\u51fa\u540e\u9762\u7684\u6570\u5b57\uff08\u8fd8\u662fx\uff09\uff0c\u7136\u540e\u5c06\u672c\u5c42\u6808\u4e2d\u7b54\u6848\u4e58\u4e0ax\uff0c\u52a0\u5165\u4e0a\u4e00\u5c42\u6808\u4e2d\u5e76\u6e05\u7a7a\u8fd9\u4e00\u5c42\u3002\n\n\u5b8c\u7ed3\u6492\u82b1\uff01\n\n\uff08PS: stirng\u7c7b\u578b\u5c5e\u4e8ec++\u7684\u4e00\u7b49\u516c\u6c11\uff0c\u4f7f\u7528\u603b\u6709\u610f\u60f3\u4e0d\u5230\u7684\u6548\u679c\uff0c\u4f46\u662f\u5bb9\u6613\u7206\u65f6\u95f4\u7206\u7a7a\u95f4\uff0c\u7ade\u8d5b\u614e\u7528\uff09\n\n\n\n\n\n\n```cpp\n#include<map>\n#include<cstdio>\n#include<cctype>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nconst int N = 100;\nmap<string, int> ref;//\u5b9a\u4e49map\nstring s, END = \"END_OF_FIRST_PART\";\nint a[N], top;\nint read() {//\u65e0\u804a\u7684\u8bfb\u5165\u4f18\u5316\n    int x = 0; char ch = getchar(); bool f = 0;\n    while(!isdigit(ch)) {\n        if(ch == '-') f = 1;\n        ch = getchar();\n    }\n    while(isdigit(ch)) {\n        x = (x << 1) + (x << 3) + (ch ^ '0');\n        ch = getchar();\n    }\n    return ! f ? x : -x;\n}\nbool sum(string ss) {\n    a[0] = 0; int x; string key; top = 0;\n    for(int i = 0; i < ss.length(); i++) {\n        if(ss[i] == '(') top++;//\u7b2c\u4e00\u6b65\n        if(isalpha(ss[i])) {//STEP 2\n            if('a' <= ss[i + 1] && ss[i + 1] <= 'z')\n                key = ss.substr(i, 2), a[top] += ref[key], i++;//substr\u622a\u53d6\u5b50\u4e32\u771f\u5fc3\u597d\u7528\n            else key = ss.substr(i, 1), a[top] += ref[key];\n            if(!ref[key]) return 0;//\u5224\u65ad\u65e0\u89e3\n        }\n        if(isdigit(ss[i])) {//STEP 3\n            x = 0;\n            while(isdigit(ss[i]))\n                x = (x << 1) + (x << 3) + (ss[i] ^ '0'), i++;//\u7c7b\u8bfb\u5165\u4f18\u5316\u6253\u6cd5\n            i--; a[top] += (x - 1) * ref[key];\n        }\n        if(ss[i] == ')') {//STEP 4\n            i++; x = 0;\n            while(isdigit(ss[i]))\n                x = (x << 1) + (x << 3) + (ss[i] ^ '0'), i++;\n            a[top - 1] += x * a[top];\n            i--; a[top] = 0; top --;\n        }\n    }\n    return 1;\n}\nint main() {\n    cin >> s;\n    while(s != END) {//\u4e00\u7b49\u516c\u6c11\u5224\u65ad\u4f7f\u7528\u4e0d\u7b49\u53f7\uff0c\u5c31\u662f\u8fd9\u4e48\u7b80\u5355\n        int x = read();\n        ref[s] = x; cin >> s;\n    }\n    cin >> s;\n    while(s != \"0\") {\n        if(!sum(s)) printf(\"UNKNOWN\\n\");\n            else printf(\"%d\\n\", a[0]);\n        cin >> s;\n    }\n    return 0;\n}\n```",
        "postTime": 1514191599,
        "uid": 20094,
        "name": "\u68a6\u56de\u8fd8",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2382 \u3010\u5316\u5b66\u5206\u5b50\u5f0f\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\uff0c\u7528stl\u53ef\u4ee5\u4ee5\u5b57\u7b26\u4e3a\u4e0b\u6807\u4fbf\u4e8e\u64cd\u4f5c\uff08\u679c\u7136\u662fstl\u5927\u6cd5\u597d\uff09\n\n\u6211\u662f\u4e00\u4e2a\u849f\u84bb\uff0c\u5927\u4f6c\u770b\u5230\u52ff\u55b7\n\n\u57fa\u672c\u601d\u8def\uff1a\n\n\u5c06\u7b26\u53f7\uff0c\u6570\u5b57\uff0c\u5b57\u6bcd\uff0c\u5206\u5f00\u6765\u8fdb\u884c\u64cd\u4f5c\uff08\u6a21\u62df\u6808\uff09\n```c\n#include<bits/stdc++.h>//\u4e07\u80fd\u5934\u6587\u4ef6\uff08\u672c\u4eba\u5f88\u61d2\uff09\nusing namespace std;\nmap<string, int>mp;//\u7528map\u6765\u5b58\uff0c\u6548\u679c\u5728\u540e\u9762\u53ef\u4ee5\u4f53\u73b0\nstring s;\nint a[10000],top,x;\nint main()\n{\n    cin>>s;\n    while(s!=\"END_OF_FIRST_PART\")//\u4e0d\u65ad\u8f93\u5165\u5b57\u7b26\u4e32s\uff0c\u4ee5\"END_OF_FIRST_PART\"\u7ed3\u675f\n    {\n        cin>>x;\n        mp[s]=x;//\u5b58\u5165mp\u6570\u7ec4\u4e2d\n        cin>>s;//\u4fbf\u4e8e\u5224\u65ad\u662f\u5426\u7ed3\u675f\n    }\n    cin>>s;\n    while(s!=\"0\")//\u5224\u65ad\u662f\u4e0d\u662f\u5b57\u7b26\uff0c\u7279\u6b8a\u8003\u8651\u4e00\u4e0b\n    {\n        int flag=1;\n        s=' '+s;//\u5c06\u8d77\u59cb\u4f4d\u7f6e\u4ece1\u5f00\u59cb\uff0c\u4fbf\u4e8e\u64cd\u4f5c\n        memset(a,0,sizeof\uff08a\uff09);\n        top=0;\n        int x;\n        string ss;\n        for(int i=1;i<=s.length();i++)\n        {\n            if(s[i]>='A'&&s[i]<='Z')//\u5c06\u5b57\u7b26\u53d6\u51fa\uff0c\u8fdb\u884c\u5339\u914d\u4e4b\u540e\uff0c\u65e2\u53ef\u4ee5\u4ee5\u6570\u5b57\u5f62\u5f0f\u8fdb\u884c\u8ba1\u7b97\n            {\n                if('a'<=s[i+1]&&s[i+1]<='z')\n                {\n                    ss=s.substr(i,2);//substr\u662f\u4e00\u4e2a\u51fd\u6570\uff0c\u4e0d\u61c2\u7684\u53ef\u4ee5\u770b\u4e0b\u8fd9\u4e2a\u7f51\u7ad9\uff1a[substr](https://www.cnblogs.com/dshore123/p/7805050.html)\n                    i++;\n                }\n                else ss=s.substr(i,1);\n                if(!mp[ss])\n                {\n                    cout<<\"UNKNOWN\"<<endl;//\u5982\u679c\u6ca1\u6709\u8fd9\u4e2a\u5b57\u7b26\u4e32\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u8f93\u51fa\u201cUNKNOWN\u201d\u5c31\u53ef\u4ee5\u7ed3\u675f\n                    flag=0;\n                    break;\n                }\n                else\n                a[top]+=mp[ss];//\u5982\u679c\u6709\u8fd9\u4e2a\u5b57\u7b26\u4e32\uff0c\u5c31\u7528\u4e00\u5f00\u59cb\u7684\u90a3\u4e2amp\u6570\u7ec4\u4ee5\u6570\u5b57\u5b58\u8d77\u6765\uff1b\n            }\n            if(s[i]>='0'&&s[i]<='9')//\u5316\u5b66\u5f0f\u7684\u6570\u5b57\u53d6\u51fa\n            {\n                x=0;\n                while(s[i]>='0'&&s[i]<='9')\n                {\n                    x=x*10+s[i]-'0';//\u5c06\u6570\u5b57\u4e32\u53d8\u6210\u6574\u6570\n                    i++;\n                }\n                i--;\n                a[top]+=(x-1)*mp[ss];\n            }\n            if(s[i]=='(')\n            top++;\n            if(s[i]==')')//\u6076\u5fc3\u7684\u62ec\u53f7\u5339\u914d\uff1b\n            {\n                i++;\n                x=0;\n                while(s[i]>='0'&&s[i]<='9')\n                {\n                    x=x*10+s[i]-'0';\n                    i++;\n                }\n                a[--top]+=x*a[top+1];\n                a[top+1]=0;\n                i--;\n            }\n        }\n        if(flag)//flag\u5982\u679c\u4e3a\u4e00\u5c31\u53ef\u4ee5\u8f93\u51fa\n        cout<<a[0]<<endl;\n        cin>>s;//\u505a\u4e0b\u4e00\u6b21\n    }\n    return 0;\n}\n\n```\n\u53ef\u80fd\u8bf4\u4e86\u597d\u591a\u65e0\u7528\u4e1c\u897f\uff0c\u8bf7\u89c1\u8c05",
        "postTime": 1526465092,
        "uid": 87454,
        "name": "\u98ce\u53ea\u662f\u7565\u8fc7",
        "ccfLevel": 0,
        "title": "\u849f\u84bb\u7684\u9898\u89e3"
    },
    {
        "content": "## \u601d\u8def\n**\u6838\u5fc3**\uff1a\n\u5229\u7528 ```exec()``` \u51fd\u6570\u5b9a\u4e49\u539f\u5b50\u91cf\uff0c\u5229\u7528 ```eval()``` \u51fd\u6570\u4ee3\u5165\u8ba1\u7b97\u3002\n\n**\u82e5\u5e72\u7ec6\u8282**\n\n- \u7531\u4e8e\u5b57\u6bcd\u548c\u6570\u5b57\u4e2d\u95f4\u53ef\u80fd\u9694\u51fa\u591a\u4e2a\u7a7a\u683c\uff0c\u6240\u4ee5\u9700\u8981\u5c06\u5176\u8c03\u6210\u4e00\u4e2a\uff0c\u7136\u540e\u66ff\u4ee3\u4e3a\u7b49\u53f7\uff0c\u8fd9\u6837\u5c31\u80fd\u7528 ```exec()``` \u51fd\u6570\u5bf9\u539f\u5b50\u8d4b\u503c\u3002\n- \u7531\u4e8e\u539f\u5b50\u4e4b\u95f4\u662f\u52a0\u548c\u5173\u7cfb\uff0c\u5e76\u4e14\u5927\u5199\u5b57\u6bcd\u4e00\u5b9a\u662f\u60df\u4e00\u7684\u4e14\u662f\u7b2c\u4e00\u4e2a\uff0c\u6240\u4ee5\u8981\u5728\u6bcf\u4e2a\u5927\u5199\u5b57\u6bcd\u524d\u52a0\u52a0\u53f7\uff0c\u5206\u5f00\u5404\u4e2a\u539f\u5b50\uff0c\u8ba9 ```eval()``` \u6b63\u786e\u8ba1\u7b97\u3002\u8003\u8651\u5230\u5de6\u62ec\u5f27\u524d\u4e5f\u53ef\u80fd\u6709\u539f\u5b50\uff0c\u5de6\u62ec\u5f27\u524d\u4e5f\u8981\u52a0\u52a0\u53f7\u3002\u7531\u4e8e\u6570\u5b57\u4ee3\u8868\u6570\u91cf\uff0c\u6570\u5b57\u524d\u52a0\u4e58\u53f7\u3002\n- \u5bf9\u4e8e\u90e8\u5206\u539f\u5b50\u91cf\u6ca1\u6709\u5728\u7b2c\u4e00\u90e8\u5206\u7ed9\u51fa\u7684\u5206\u5b50\uff0c\u76f4\u63a5\u5229\u7528 ```try``` \u548c ```except``` \u7684\u201c\u8bd5\u9519\u201d\u529f\u80fd\u625b\u4e0b NameError \uff0c\u8f93\u51fa UNKNOWN \u3002\n- \u8bb0\u5f97\u5bf9\u4e24\u4e2a\u90e8\u5206\u7684\u7ed3\u675f\u884c\u7279\u5224\uff01\n\n\u4e3a\u4e86\u66f4\u52a0\u6e05\u695a\u5730\u8868\u8ff0\u8f93\u5165\u5b57\u7b26\u4e32\u5e94\u8be5\u88ab\u4fee\u9970\u6210\u4ec0\u4e48\u6837\uff0c\u5728\u6b64\u7ed9\u51fa\u793a\u4f8b\uff1a\n- \u670d\u52a1\u4e8e ```exec()``` \uff0c 'S (\u6b64\u5904\u7701\u7565\u82e5\u5e72\u7a7a\u683c) 32' \u5e94\u8be5\u8f6c\u5316\u6210 'S=32'\n- \u670d\u52a1\u4e8e ```eval()``` \uff0c 'Cu2(OH)2CO3' \u5e94\u8be5\u8f6c\u5316\u6210 '+Cu\\*2+(+O+H)\\*2+C+O\\*3'\n## \u53c2\u8003\u4ee3\u7801\n```python\nwhile 1:\n    a=input().strip()\n    if a=='END_OF_FIRST_PART':#\u7279\u5224\n        break\n    else:\n        while'  'in a:\n            a=a.replace('  ',' ')#\u8c03\u7a7a\u683c\u6570\u91cf\n        exec(a.replace(' ','='))\nwhile'0#'!=a:\n    try:\n        a,b,c=input().strip()+'#','',0#\u989d\u5916\u7684\u5b57\u7b26'#'\u7528\u6765\u4fdd\u62a4\u8f93\u5165\u5b57\u7b26\u4e32\uff0c\u9632\u6b62\u5728\u540e\u9762\u8bfb\u53d6\u6570\u5b57\u7684\u65f6\u5019\u51fa\u73b0 IndexError\n        for i in range(len(a)-1):#\u7f16\u8f91\u5b57\u7b26\u4e32\n            if c:\n                if i<j:\n                    continue\n                else:\n                    c=0\n            if a[i]in'(QWERTYUIOPASDFGHJKLZXCVBNM':\n                b+='+'+a[i]\n            elif a[i]in'1234567890':\n                c=1\n                for j in range(i,len(a)):\n                    if a[j]not in'1234567890':\n                        break\n                b+='*'+a[i:j]\n            else:\n                b+=a[i]\n        print(eval(b))\n    except NameError:\n        print('UNKNOWN')\n    except SyntaxError:#\u7279\u5224\u8f93\u51650\n        exit()\n```\n",
        "postTime": 1633009168,
        "uid": 532320,
        "name": "Ag2WO4",
        "ccfLevel": 0,
        "title": "P2382\u9898\u89e3"
    },
    {
        "content": "\u901a\u8fc7\u5bf9\u9898\u76ee\u7684\u5206\u6790\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u4e2a\u95ee\u9898\u53ea\u5206\u4e3a\u4e24\u90e8\u5206\uff1a\n\n1.\u5efa\u7acb\u5143\u7d20\u7b26\u53f7\u548c\u539f\u5b50\u91cf\u7684\u6620\u5c04\u3002\n\n2.\u8ba1\u7b97\u5206\u5b50\u7684\u5206\u5b50\u91cf\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u5206\u522b\u89e3\u51b3\u8fd9\u4e24\u4e2a\u95ee\u9898\u3002\n\n## Part 1\n\n\u89e3\u51b3\u5b57\u7b26\u4e32-\u6574\u6570\u7684\u6620\u5c04\uff0c\u5e38\u7528\u7684\u65b9\u6cd5\u662f\u54c8\u5e0c\u3002\n\n\u4f46\u662f\uff0c\u8003\u8651\u5230\u672c\u9898\u6570\u636e\u91cf\u8f83\u5c0f\uff0c\u4f7f\u7528map\u4e5f\u662f\u53ef\u4ee5\u7684\u3002\n\n\u6b64\u5916\uff0c\u8f93\u5165\u4e5f\u9700\u8981\u4e00\u5b9a\u7684\u6280\u5de7\uff0c\u5177\u4f53\u8bf7\u770b\u4ee3\u7801\uff1a\n\n```cpp\nmap<string,int> ele;\n\twhile(1){\n\t\tcin>>a;\n\t\tif(a==\"END_OF_FIRST_PART\")break;\n\t\tint x;\n\t\tcin>>x;\n\t\tele[a]=x;\n\t}\n```\n\n## Part 2\n\n\u8f93\u5165\u5e76\u4e0d\u662f\u6b64\u9898\u7684\u96be\u70b9\uff0c\u771f\u6b63\u7684\u8003\u70b9\u5728\u8ba1\u7b97\u3002\n\n\u6839\u636e\u5316\u5b66\u77e5\u8bc6\uff0c\u5f62\u5982 $CO$ \u7684\u5206\u5b50\u53ef\u4ee5\u770b\u6210 $12+16$ \uff0c\u800c $O_{2}$ \u53ef\u4ee5\u770b\u6210 $16*2$\n\n\u56e0\u800c\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u4e00\u4e2a\u5206\u5b50\u5f0f\u770b\u6210\u4e00\u4e2a\u4e2d\u7f00\u8868\u8fbe\u5f0f\uff0c\u5229\u7528\u6808\u8fdb\u884c\u8ba1\u7b97\u3002\n\n\u53e6\u5916\uff0c\u7531\u4e8e\u53ea\u6709\u52a0\u6cd5\u548c\u4e58\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0d\u5f00\u7b26\u53f7\u6808\uff0c\u800c\u662f\u5728\u9047\u5230\u6570\u5b57\u65f6\uff0c\u76f4\u63a5\u8fdb\u884c\u4e58\u6cd5\u64cd\u4f5c\u3002\u6b64\u5916\uff0c\u5355\u72ec\u4e00\u4e2a\u539f\u5b50\u7684\u7cfb\u6570\uff0c\u5728\u5165\u6808\u65f6\u76f4\u63a5\u4e58\u4e0a\u5373\u53ef\u3002\n\n\u53c2\u8003\u4ee3\u7801\uff1a\n```cpp\nwhile(1){\n\t\tcin>>a;\n\t\tif(a==\"0\") break;//\u7ed3\u675f\u6807\u5fd7 \n\t\tlong long ans=0;\n\t\tbool is=1;\n\t\tfor(int i=0;i<a.size();i++){\n\t\t\tif(a[i]=='('){\n\t\t\t\ts.push(-1);//\u4e00\u5b9a\u4e0d\u80fds.push((int)'(') \n\t\t\t}\n\t\t\tif((a[i]>='A'&&a[i]<='Z')){//\u539f\u5b50 \n\t\t\t\tstring b=\"\";\n\t\t\t\tb+=a[i];\n\t\t\t\tif(a[i+1]>='a'&&a[i+1]<='z'&&i+1<a.size()){\n\t\t\t\t\ti++;\n\t\t\t\t\tb+=a[i];\n\t\t\t\t}\n\t\t\t\tif(ele.find(b)==ele.end()){//UNKNOWN\n\t\t\t\t\tis=0; \n\t\t\t\t\tcout<<\"UNKNOWN\\n\";break;\n\t\t\t\t}else{//\u83b7\u53d6\u7cfb\u6570 \n\t\t\t\t\tint res=0;\n\t\t\t\t\twhile(a[i+1]>='0'&&a[i+1]<='9'&&i+1<a.size()){\n\t\t\t\t\t\tres*=10;\n\t\t\t\t\t\tres+=a[i+1]-'0';\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\tres=max(res,1ll);//\u5982\u679c\u6ca1\u6709\u7cfb\u6570\uff0c\u9ed8\u8ba4\u552f\u4e00 \n\t\t\t\t\ts.push(ele.find(b)->second*res);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(a[i]==')'){\n\t\t\t\tint res=0;//\u540c\u4e0a \n\t\t\t\twhile(a[i+1]>='0'&&a[i+1]<='9'&&i+1<a.size()){\n\t\t\t\t\tres*=10;\n\t\t\t\t\tres+=a[i+1]-'0';\n\t\t\t\t\ti++;\n\t\t\t\t}\n\t\t\t\tres=max(res,1ll);\n\t\t\t\tint tmp=0;\n\t\t\t\twhile(1){//\u5904\u7406\u62ec\u53f7 \n\t\t\t\t\tint c=s.top();\n\t\t\t\t\ts.pop();\n\t\t\t\t\tif(c==-1)break;//\u5de6\u62ec\u53f7 \n\t\t\t\t\ttmp+=res*c;\n\t\t\t\t}\n\t\t\t\ts.push(tmp);\n\t\t\t}\n\t\t}\n\t\twhile(s.size()){//\u6ce8\u610f\uff1a\u6700\u540e\u6808\u91cc\u4e0d\u4e00\u5b9a\u53ea\u6709\u4e00\u4e2a\u6570 \n\t\t\tans+=s.top();s.pop();\n\t\t}\n\t\tif(is)\n\t\tcout<<ans<<'\\n';\n\t}\n```\n\n\u6b64\u5916\u8fd8\u6709\u4e00\u4e2a\u7ec6\u8282\uff1a\u5c06\u5de6\u62ec\u53f7\u5165\u6808\u65f6\uff0c\u4e00\u5b9a\u4e0d\u80fd\u76f4\u63a5\u63d2\u5165\uff0c\u5426\u5219\u4f1a\u4e0e\u5176\u4ed6\u6570\u51b2\u7a81\u3002\n\n\u7efc\u4e0a\uff0c\u5c31\u53ef\u4ee5 $AC$ \u8fd9\u9053\u9898\u5566~",
        "postTime": 1609136933,
        "uid": 128273,
        "name": "Rolling_L",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2382 \u3010\u5316\u5b66\u5206\u5b50\u5f0f\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u96be\u5ea6\u4e0d\u5927\uff0c\u6a21\u62df\u5373\u53ef\uff0c\u4f46\u662f\u6709\u5f88\u591a\u7ec6\u8282\u9700\u8981\u6ce8\u610f\u3002\n\n\u697c\u4e0b\u5927\u7287\u4eec\u90fd\u6ca1\u600e\u4e48\u8bb2\u601d\u8def\uff0c\u90a3\u6211\u6765\u8bb2\u4e00\u8bb2\u3002\n\n## \u3010\u601d\u8def\u3011\n\u9047\u5230\u5316\u5b66\u5206\u5b50\u5f0f\uff0c\u5b66\u6821\u91cc\u9762\u5bf9\u5404\u79cd\u539f\u5b50\u7684\u6574\u4f53\uff0c\uff08\u5c31\u662f\u62ec\u53f7\u91cc\u7684\u4e1c\u897f\uff09\uff0c\u6211\u4eec\u7684\u79d1\u5b66\u8001\u5e08\u544a\u8bc9\u6211\u4eec\u8981\u628a\u5b83\u770b\u6210\u4e00\u4e2a\u5927\u5206\u5b50\u8ba1\u7b97\u5f0f\u91cf\u3002\n\n\u4f8b\u5982\uff1a\n$$Ca(OH)_2$$\n\n($Ca~40$\uff0c$O~16$,$H~1$)\n\n\u6211\u4eec\u5c31\u8ba1\u7b97\n$$40 + (16 + 1) * 2$$\n\n\u90a3\u4e48\u95ee\u9898\u5c31\u89e3\u51b3\u4e86\uff0c\u6bcf\u6b21\u8bfb\u5230\u62ec\u53f7\u5c31\u9012\u5f52\u7684\u8ba1\u7b97\u62ec\u53f7\u5185\u5206\u5b50\u7684\u5f0f\u91cf\uff0c\u4e58\u4e0a\u62ec\u53f7\u540e\u9762\u7684\u7cfb\u6570\uff08\u53ef\u80fd\u6ca1\u6709\uff0c\u8981\u7279\u5224\uff09\u3002\u6bd4\u5982\u4e0b\u9762\u7684\u5f0f\u5b50\uff1a(\u73b0\u5b9e\u4e2d\u4e0d\u5b58\u5728)\n$$A(BC(DE)_2)_3$$\n\u6211\u4eec\u5c31\u5148\u9012\u5f52\n$$A + 3 * BC(DE)_2$$\n\u7136\u540e\u7ee7\u7eed\u7b97\n$$A + 3 * (B + C + (D + E) * 2)$$\n\u7a0b\u5e8f\u91cc\u5148\u7b97$D + E$\uff0c\u7136\u540e\u662f$B + C + (D+E)*2$\uff0c\u6700\u540e\u7b97$A + 3 * (B + C + (D + E) * 2)$\u3002\n\n\u7136\u540e\u4f60\u5c31\u6109\u5feb\u7684$AC$\u4e86\u3002\n\n\u81f3\u4e8e\u5b58\u5316\u5b66\u5f0f\uff0c\u7528$map$\u548c$string$\u968f\u4fbf\u79bb\u6563\u641e\u641e\uff0c\u60f3\u624b\u5199\u79bb\u6563\u7684\u5de8\u4f6c\u5728\u4e0b\u4e5f\u4f1a\u8868\u793a\u4f69\u670d\u3002\n$map<string,int>$\u76f4\u63a5\u628a\u76f8\u5bf9\u539f\u5b50\u8d28\u91cf\u5b58\u8d77\u6765\u5c31\u597d\u4e86\u3002\uff08\u627e\u4e0d\u5230\u7684\u5c31\u662f\u6ca1\u6709\u55bd\uff09\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nstring END_MARK = \"END_OF_FIRST_PART\";\nmap <string, int> ele;\nbool ans = true;\ntemplate <typename T>\ninline void read(T &x)\n{\n    char c;\n    x = 0;\n    int fu = 1;\n    c = getchar();\n    while(c > 57 || c < 48)\n    {\n        if(c == 45)\n        {\n            fu = -1;\n        }\n        c = getchar();\n    }\n    while(c <= 57 && c >= 48)\n    {\n        x = (x << 3) + (x << 1) + c - 48;\n        c = getchar();\n    }\n    x *= fu;\n}\ntemplate <typename T>\ninline void fprint(T x)\n{\n    if(x < 0)\n    {\n        putchar(45);\n        x = -x;\n    }\n    if(x > 9)\n    {\n        fprint(x / 10);\n    }\n    putchar(x % 10 + 48);\n}\n\ninline void first_part()\n{\n    string s;\n    int num;\n    cin >> s;\n    if(s == END_MARK) return;\n    read(num);\n    ele[s] = num;\n    first_part();\n}\nstring a;\n// stack <char> t;\nint work(int l, int r)\n{\n    if(l > r) return 0;\n    // cout << l << ' ' << r << endl;//debug\n    int tmp = l;\n    if(a[l] == 40)\n    {\n        int tot = 1;\n        while(tot > 0)\n        {\n            l ++;\n            if(a[l] == 40) tot ++;\n            if(a[l] == 41) tot --;\n        }\n        if(l == r)\n            return work(tmp + 1, r - 1);\n        else\n        {\n            int num = 0, tmpp = l;\n            l ++;\n            while(a[l] >= 48 && a[l] <= 57)\n            {\n                num = (num << 3) + (num << 1);\n                num += a[l] - 48;\n                l ++;\n            }\n            return work(tmp + 1, tmpp - 1) * (num? num : 1) + work(l, r);\n        }\n    }\n    else\n    {\n        // cout << \"Task2\" << endl;//debug\n        string ss;\n        ss += a[l];\n        l ++;\n        while(l <= r && a[l] >= 97 && a[l] <= 122)\n        {\n            ss += a[l];\n            l ++;\n        }\n        // cout << ss << endl;//debug\n        if(!ele[ss]) return ans = false;\n        if(l > r)\n        {\n            return ele[ss];\n        }\n        int num = 0, tmpp = l;\n        while(a[l] >= 48 && a[l] <= 57)\n        {\n            num = (num << 3) + (num << 1);\n            num += a[l] - 48;\n            l ++;\n        }\n        return work(tmp, tmpp - 1) * (num? num : 1) + work(l, r);\n    }\n}\n\nint main()\n{\n    first_part();\n    END_MARK = \"0\";\n    while(true)\n    {\n        ans = true;\n        cin >> a;\n        if(a == END_MARK) break;\n        int ret = work(0, a.size() - 1);\n        if(!ans)\n        {\n            printf(\"UNKNOWN\\n\");\n        }\n        else{\n            fprint(ret);\n            putchar('\\n');\n        }\n    }\n}\n```",
        "postTime": 1557312254,
        "uid": 66511,
        "name": "DPair",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2382 \u3010\u5316\u5b66\u5206\u5b50\u5f0f\u3011"
    },
    {
        "content": "#### ~~luogu\u7684oier\u5316\u5b66\u4e00\u5b9a\u90fd\u5f88\u597d~~\n\n\u8fd9\u4e2a\u9898\u662f\u8ba9\u6211\u4eec\u6a21\u62df\u8ba1\u7b97\u5316\u5b66\u65b9\u7a0b\u5f0f\u7684\u8fc7\u7a0b\u3002\n\n\u548c[\u65f6\u95f4\u590d\u6742\u5ea6](https://www.luogu.org/problemnew/show/P3952)\u7c7b\u4f3c\u7684\u9898\u76ee\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u62ec\u53f7\uff0c\u5c06\u6c42\u89e3\u5206\u6210\u82e5\u5e72\u4e2a\u6b65\u9aa4\u3002\n\n\u4ece\u5916\u90e8\u770b\uff0c\u9700\u8981\u5c06\u4e00\u5bf9\u62ec\u53f7\u770b\u505a\u4e00\u4e2a\u6574\u4f53\u3002\u7136\u540e\u8fdb\u884c\u8ba1\u7b97\u3002\n\n\u4ece\u5185\u90e8\u770b\uff0c\u62ec\u53f7\u5916\u9762\u7684\u4e0b\u6807\u5bf9\u5185\u90e8\u6ca1\u6709\u5f71\u54cd\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5c06\u7ed9\u5b9a\u7684\u5206\u5b50\u5f0f\uff0c\u770b\u505a\u5728\u4e00\u4e2a\u5927\u62ec\u53f7\u5185\u3002\n\n\u7136\u540e\u5199\u51fa\u4e00\u4e2a\u51fd\u6570\uff0c\u51fd\u6570\u7684\u4f5c\u7528\u5c31\u662f\u6c42\u89e3\u67d0\u4e00\u4e2a\u62ec\u53f7\u5185\u7684\u8d28\u91cf\u3002\n\n\u5f53\u7136\uff0c\u8fd9\u4e2a\u51fd\u6570\u5f88\u663e\u7136\u662f\u9012\u5f52\u7684\u3002\u9012\u5f52\u5c31\u8981\u7528\u5230\u6808\u3002\u6240\u4ee5\u662f\u9690\u5f62\u7684\u5f00\u4e86\u6808\u3002\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<iostream>\nconst int maxn=5000;\nint T[maxn][100],tail;\nint End[maxn];\nchar c[maxn];\nvoid insert(char *A,int len,int w)\n{\n    int now=0;\n    for(int i=1;i<=len;i++)\n    {\n        int nxt=A[i]-'A';\n        if(!T[now][nxt])    T[now][nxt]=++tail;\n        now=T[now][nxt];\n    }//trie\u6811\n    End[now]=w;\n    return ;\n}\nint get(int &now,int len)\n{\n    int res=0,R=T[0][c[now++]-'A'];\n    while(c[now]>='a'&&c[now]<='z')//\u8fd8\u5728\u4e00\u4e2a\u539f\u5b50\u5185\n    {\n        int nxt=c[now]-'A';\n        if(!T[R][nxt])  return -0x7fffffff;\n        R=T[R][nxt];\n        now++;\n    }\n    if(!End[R]) return -0x7fffffff;//\u6ca1\u6709\u8fd9\u4e2a\u539f\u5b50\uff0c\u8fd4\u56de\u975e\u6cd5\n    return End[R];//\u8fd4\u56de\u5355\u4e2a\u539f\u5b50\u7684\u8d28\u91cf\n}\nint calc(int &now,int len)\n{\n    int res=0;\n    while(c[now]<='9'&&c[now]>='0'&&now<=len)\n    {\n        res=res*10+c[now]-'0';\n        now++;\n    }//\u6570\u5b57\n    return res;\n}\nint dfs(int &now,int len)//\n{\n    int sum=0;//\u62ec\u53f7\u5185\u539f\u5b50\u7684\u8d28\u91cf\u603b\u548c\n    while(c[now]!=')'&&now<=len)//\u6ca1\u6709\u5230\u53f3\u62ec\u53f7\u3002PS\uff1a\u4e00\u6b21\u5faa\u73af\u5904\u7406\u4e00\u4e2a\u539f\u5b50\u548c\u5176\u4e0b\u6807\uff08\u82e5\u6ca1\u6709\u5219\u4e0d\u5904\u7406\uff09\n    {\n        int pas=0,x=1;//pas\u4e3a\u539f\u5b50\u8d28\u91cf\uff0cx\u4e3a\u4e0b\u6807\n        if(c[now]=='(')//\u9047\u5230\u4e00\u4e2a\u5de6\u62ec\u53f7\n            pas=dfs(++now,len);//\u9012\u5f52\u5904\u7406\n        else\n        if(c[now]<'0'||c[now]>'9')\n            pas=get(now,len);//\u8ba1\u7b97\u539f\u5b50\u8d28\u91cf\n        if(c[now]==')'||pas<0)//\u540e\u9762\u6ca1\u6709\u4e0b\u6807\u800c\u4e14\u5230\u4e86\u53f3\u62ec\u53f7\n        {\n            sum+=pas;//\u52a0\u4e0a\uff0c\u9000\u51fa\u5faa\u73af\n            break;\n        }\n        if(c[now]>='0'&&c[now]<='9')\n            x=calc(now,len);//\u8ba1\u7b97\u4e0b\u6807\n        sum+=pas*x;//\u76f8\u4e58\n    }\n    now++;//\u8d8a\u8fc7\u53f3\u62ec\u53f7\n    return sum;\n}\nint main()\n{\n    while(true)\n    {\n        int weight;\n        scanf(\"%s\",c+1);\n        scanf(\"%d\",&weight);\n        int len=strlen(c+1);\n        if(c[1]=='E'&&c[2]=='N'&&c[3]=='D') break;\n        insert(c,len,weight);\n    }//\u8f93\u5165\u5143\u7d20\n    while(true)\n    {\n        scanf(\"%s\",c+1);\n        if(c[1]=='0')   break;//\u7ec8\u6b62\u6761\u4ef6\n        int len=strlen(c+1);//\u957f\u5ea6\n        c[len+1]=')';//\u5c06\u6574\u4e2a\u5206\u5b50\u5f0f\u62ec\u53f7\u6269\u8d77\u6765\uff0c\u53ea\u62ec\u53f3\u534a\u90e8\u5206\u7684\u539f\u56e0\u662f\uff0c\u6211\u5199\u7684\u51fd\u6570\uff0c\u5728\u6240\u5904\u7406\u7684\u62ec\u53f7\u7684\u533a\u95f4\u662f\u5de6\u5f00\u53f3\u95ed\u7684\u3002\n        int n=1;\n        int ans=dfs(n,len+1);\n        if(ans<0)   printf(\"UNKNOWN\\n\");//\u4e0d\u5408\u6cd5\u3002\n        else    printf(\"%d\\n\",ans);\n    }//\u8ba1\u7b97\n}\n\n```\n\n[\u9644\u5e26\uff1a\u8c6a\u534e\u5927\u6837\u4f8b~~\uff08\u5f53\u7136\u53ef\u80fd\u6709\u9505\uff09~~](https://www.luogu.org/paste/epiref22)",
        "postTime": 1540990033,
        "uid": 28007,
        "name": "Lance1ot",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2382 \u3010\u5316\u5b66\u5206\u5b50\u5f0f\u3011"
    },
    {
        "content": "## Description\n\u4f60\u7684\u4efb\u52a1\u662f\u7f16\u5199\u4e00\u4e2a\u80fd\u5904\u7406\u5728\u865a\u62df\u7684\u5316\u5b66\u91cc\u5206\u5b50\u5f0f\u7684\u7a0b\u5e8f\uff0c\u5177\u4f53\u5730\u8bf4\uff0c\u7ed9\u5b9a\u4f60\u6240\u6709\u539f\u5b50\u7684\u76f8\u5bf9\u539f\u5b50\u8d28\u91cf\uff0c\u6c42\u51fa\u6240\u6709\u8be2\u95ee\u7684\u5206\u5b50\u7684\u76f8\u5bf9\u5206\u5b50\u8d28\u91cf\uff0c\u6216\u8005\u62a5\u544a\u4e0d\u5b58\u5728\u3002\n\n**\u6570\u636e\u8303\u56f4\uff1a\u539f\u5b50\u8d28\u91cf $\\leqslant 1000$\uff0c\u5206\u5b50\u5f0f\u957f\u5ea6 $\\leqslant 80$\uff0c\u5206\u5b50\u5305\u542b\u7684\u539f\u5b50\u4e2a\u6570 $\\leqslant 10^5$\u3002**\n## Solution\n\u8fd9\u7bc7\u9898\u89e3\u6309\u7167\u9898\u9762\u5206 Part \u6765\u8bb2\u3002\n\n### Part 1\n\u5982\u4f55\u5c06\u539f\u5b50\u5f0f\u548c\u76f8\u5bf9\u539f\u5b50\u8d28\u91cf\u4e4b\u95f4\u7684\u5173\u7cfb\u6620\u5c04\u51fa\u6765\uff1fSTL \u91cc\u9762\u6709\u4e00\u4e2a\u5173\u8054\u5bb9\u5668\u53eb `map`\uff0c\u53ef\u4ee5\u5904\u7406\u672c\u9898\u4e2d\u539f\u5b50\u5f0f\u548c\u76f8\u5bf9\u539f\u5b50\u8d28\u91cf\u4e4b\u95f4\u7684\u5bf9\u5e94\u5173\u7cfb\u3002\u5177\u4f53\u5730\uff0c\u4f60\u53ef\u4ee5\u5c06\u539f\u5b50\u5f0f\u4e3a\u5173\u952e\u5b57\uff0c\u5c06\u76f8\u5bf9\u539f\u5b50\u8d28\u91cf\u4f5c\u4e3a\u8fd9\u4e2a\u5173\u952e\u5b57\u7684\u503c\u5b58\u50a8\uff0c\u8fd9\u6837\u5c31\u5efa\u7acb\u4e86\u8fd9\u4e48\u4e2a\u5173\u7cfb\u3002\n\nSTL \u91cc\u9762\u8fd8\u6709\u4e2a\u5bb9\u5668\u53eb `vector`\uff0c\u4f60\u53ef\u4ee5\u628a\u5b83\u770b\u4f5c\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c\u4f46\u662f\u5b83\u5176\u5b9e\u6bd4\u6570\u7ec4\u8fd8\u8981\u9ad8\u7ea7\uff0c\u56e0\u4e3a\u5b83\u7684\u5927\u5c0f\u662f\u52a8\u6001\u7684\uff0c\u800c\u4e14\u540c\u6837\u4e5f\u53ef\u4ee5\u652f\u6301\u4efb\u4f55\u7c7b\u578b\u7684\u5b58\u50a8\u3002\u90a3\u4e48\u5728\u8fd9\u91cc\u8bf4 `vector` \u6709\u4ec0\u4e48\u7528\u5462\uff1f\u6211\u4eec\u5728\u5904\u7406\u5173\u7cfb\u65f6\uff0c\u987a\u4fbf\u5c06\u6240\u6709\u7684\u539f\u5b50\u5f0f\u5168\u90e8\u4e22\u8fdb `vector`\uff0c\u4ee5\u65b9\u4fbf\u63a5\u4e0b\u6765\u7684 Part 2 \u4e2d\u5224\u65ad\u5206\u5b50\u5f0f\u91cc\u9762\u662f\u5426\u6709\u4e0d\u5b58\u5728\u7684\u539f\u5b50\u5f0f\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u8fd8\u8bf7\u770b\u4ee3\u7801\u3002\n### Part 2\n\u8fd9\u4e5f\u662f\u8fd9\u9053\u9898\u76ee\u6700\u6838\u5fc3\u7684\u90e8\u5206\u4e86\u3002\n\n\u9996\u5148\uff0c\u5982\u679c\u6ca1\u6709\u62ec\u53f7\u7684\u8bdd\uff0c\u7531\u4e8e\u539f\u5b50\u5f0f\u53ea\u6709\u53ef\u80fd\u662f\u7531\u4e00\u4e2a\u5927\u5199\u5b57\u6bcd\u6216\u8005\u4e00\u4e2a\u5927\u5199\u5b57\u6bcd + \u4e00\u4e2a\u5c0f\u5199\u5b57\u6bcd\u7ec4\u6210\uff0c\u6240\u4ee5\u5c31\u53ef\u4ee5\u626b\u4e00\u904d\u8fc7\u53bb\uff0c\u78b0\u5230\u5927\u5199\u5b57\u6bcd\u5224\u65ad\u5927\u5199\u5b57\u6bcd\u540e\u9762\u5224\u65ad\u662f\u5426\u6709\u5c0f\u5199\u5b57\u6bcd\uff0c\u6709\u7684\u8bdd\u52a0\u4e0a\u53bb\u3002\u7136\u540e\u5224\u65ad\u540e\u9762\u662f\u5426\u6709\u6570\u5b57\uff0c\u6ca1\u6709\u6570\u5b57\u5c31\u9ed8\u8ba4\u6309\u7167\u4e00\u4e2a\u6765\u8ba1\u7b97\uff0c\u5426\u5219\u63d0\u53d6\u51fa\u540e\u9762\u7684\u6570\u5b57\u5e76\u5c06\u8fd9\u4e2a\u6570\u5b57\u4e58\u4e0a\u8be5\u5143\u7d20\u7684\u76f8\u5bf9\u539f\u5b50\u8d28\u91cf\u3002\n\n\u6709\u62ec\u53f7\u6539\u600e\u4e48\u529e\uff1f\u8fd9\u91cc\u5c31\u7528\u5230\u9012\u5f52\u7684\u601d\u60f3\u4e86\u3002\u6211\u4eec\u78b0\u5230\u6709\u62ec\u53f7\u7684\uff0c\u5148\u628a\u62ec\u53f7\u91cc\u9762\u7684\u6240\u6709\u90e8\u5206\u5168\u90e8\u63d0\u53d6\u51fa\u6765\uff0c\u7136\u540e\u5224\u65ad\u540e\u9762\u662f\u5426\u6709\u6570\u5b57\uff0c\u6ca1\u6709\u6570\u5b57\u5c31\u9ed8\u8ba4\u6309\u7167\u4e00\u4e2a\u6765\u8ba1\u7b97\uff0c\u5426\u5219\u63d0\u53d6\u51fa\u540e\u9762\u7684\u6570\u5b57\u5e76\u5c06\u8fd9\u4e2a\u6570\u5b57\u4e58\u4e0a\u8be5\u90e8\u5206\u7684\u76f8\u5bf9\u539f\u5b50\u8d28\u91cf\u603b\u548c\u3002\u7136\u540e\u8fd9\u4e2a\u90e8\u5206\u518d\u8fdb\u884c\u4e00\u904d\u9012\u5f52\u5904\u7406\u76f4\u5230\u6ca1\u6709\u62ec\u53f7\u4e3a\u6b62\u3002\n\n\u90a3\u4e48\u8fd9\u9053\u9898\u76ee\u5c31\u505a\u5b8c\u4e86\u3002\n## Code\n```cpp\nnamespace Solution {\n\tstring s; int x;\n\tmap<string, int> elements;\n\tvector<string> elements_list;\n\t\n\tii work(string s) {\n\t\tint n = s.size(), i = 0, ans = 0;\n\t\twhile(i < n) {\n\t\t\tif(s[i] == '(') {\n\t\t\t\tstack<char> q;\n\t\t\t\tq.push(s[i]), ++i;\n\t\t\t\tstring tmp = \"\";\n\t\t\t\twhile(1) {\n\t\t\t\t\tif(s[i] == '(') q.push(s[i]);\n\t\t\t\t\telse if(s[i] == ')') {\n\t\t\t\t\t\tq.pop();\n\t\t\t\t\t\tif(q.empty()) break;\n\t\t\t\t\t}\n\t\t\t\t\ttmp += s[i++];\n\t\t\t\t}\n\t\t\t\ti++;\n\t\t\t\tint mul = 0;\n\t\t\t\tif(!isdigit(s[i])) mul = 1;\n\t\t\t\telse while(isdigit(s[i])) mul = mul * 10 + s[i] - '0', i++;\n\t\t\t\tans += work(tmp) * mul;\n\t\t\t}\n\t\t\tstring element = \"\"; \n\t\t\tif(isupper(s[i])) {\n\t\t\t\telement += s[i];\n\t\t\t\tif(islower(s[i + 1])) i++, element += s[i];\n\t\t\t\tint fl = 0; \n\t\t\t\tF(int, j, 0, (int)elements_list.size() - 1) if(elements_list[j] == element) {fl = 1; break;}\n\t\t\t\tif(!fl) return -1;\n\t\t\t\ti++;\n\t\t\t\tint mul = 0;\n\t\t\t\tif(!isdigit(s[i])) mul = 1;\n\t\t\t\telse while(isdigit(s[i])) mul = mul * 10 + s[i] - '0', i++;\n\t\t\t\tans += elements[element] * mul; \n\t\t\t}\n\t\t}\n\t\treturn ans;\n\t}\n\t\n\tiv Main() {\n\t\twhile(1) {\n\t\t\tcin >> s;\n\t\t\tif(s == \"END_OF_FIRST_PART\") break;\n\t\t\tread(x), elements[s] = x, elements_list.push_back(s);\n\t\t}\n\t\twhile(1) {\n\t\t\tcin >> s;\n\t\t\tif(s == \"0\") break;\n\t\t\tint ans = work(s);\n\t\t\tif(ans == -1) puts(\"UNKNOWN\");\n\t\t\telse println(ans);\n\t\t}\n\t\treturn;\n\t}\n}\n```",
        "postTime": 1630147714,
        "uid": 112917,
        "name": "Eason_AC",
        "ccfLevel": 6,
        "title": "P2382 \u5316\u5b66\u5206\u5b50\u5f0f"
    },
    {
        "content": "## P2382 \u5316\u5b66\u5206\u5b50\u5f0f \u9898\u89e3\n\u770b\u5230\u5176\u5b83\u9898\u89e3\u90fd\u7528\u4e86\u6808\u6216\u662f\u9012\u5f52\u7684\u65b9\u6cd5\uff0c\u8fd9\u91cc\u6211\u6709\u4e00\u79cd\u65b0\u601d\u8def\u3002\\\n\\\n\u6211\u7684\u4ee3\u7801\u91cc\uff0c\u9012\u5f52\u548c\u6808\u90fd\u7528\u4e86\u3002\u4f46\u662f\u8fd9\u91cc\u7684\u9012\u5f52\u4e0d\u662f**\u9012\u5f52\u51fd\u6570**\uff0c\u800c\u662f**\u9012\u5f52\u7ed3\u6784**\u3002\\\n\\\n\u4ec0\u4e48\u610f\u601d\u5462\uff1f\u6211\u4eec\u7684[\u67d0\u4e0d\u613f\u900f\u9732\u59d3\u540d\u7684\u5b66\u957f](https://www.luogu.com.cn/user/65363)\u66fe\u7ecf\u7ed9\u6211\u4eec\u8bb2\u8fc7\u7528\u7ed3\u6784\u4f53+\u6307\u9488\u5b9e\u73b0\u7684\u7ebf\u6bb5\u6811(1)\u3002\u56e0\u4e3a\u7ebf\u6bb5\u6811\u91cc\u6700\u91cd\u8981\u7684\u4e00\u90e8\u5206\u662f\u201c\u7531\u5b50\u8282\u70b9\u7684\u4fe1\u606f\u5f97\u5230\u7236\u8282\u70b9\u7684\u4fe1\u606f\u201d\uff0c\u6240\u4ee5\u5979\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u4f7f\u7528\u4e86\u4e24\u4e2a\u6307\u5411\u5176\u5b50\u8282\u70b9\u7684\u6307\u9488\uff0c\u7136\u540e\u518d\u5728\u7ed3\u6784\u4f53\u91cc\u5b9e\u73b0`pushup()`\u3001`pushdown()`\u3001`query()`\u7b49\u51fd\u6570\uff0c\u8fd9\u4e9b\u51fd\u6570\u90fd\u662f\u76f4\u63a5\u5bf9\u4e24\u4e2a\u6307\u9488\u8fdb\u884c\u64cd\u4f5c\u7684\u3002\u6211\u4e2a\u4eba\u8ba4\u4e3a\u8fd9\u6837\u7684\u65b9\u6cd5\u6bd4\u7eaf\u5c5e\u7528\u51fd\u6570\u5b9e\u73b0\u7ebf\u6bb5\u6811\u8981\u7b80\u660e\u5f97\u591a\uff0c\u53c8\u4e0d\u5931\u6548\u7387\u3002\u6240\u4ee5\uff0c\u8fd9\u4e2a\u9898\u91cc\u6211\u987a\u627f\u4e86\u8fd9\u4e2a\u601d\u8def\u3002\\\n\\\n\u5f88\u660e\u663e\uff0c\u8fd9\u4e2a\u9898\u76ee\u91cc\u6709\u62ec\u53f7\uff0c\u5e76\u4e14\u6709\u62ec\u53f7\u7684\u5d4c\u5957\u3002\u6211\u4eec\u4e0d\u59a8\u5148\u8003\u8651\u4e00\u4e2a\u9000\u5316\u7684\u95ee\u9898\uff1a\\\n\u7ed9\u4f60\u4e00\u4e2a\u5316\u5b66\u5206\u5b50\u5f0f\uff0c**\u5176\u4e2d\u6ca1\u6709\u4efb\u4f55\u62ec\u53f7**\uff0c\u6c42\u5b83\u7684\u76f8\u5bf9\u5206\u5b50\u8d28\u91cf\u3002\\\n\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u4e0d\u662f\u6613\u5982\u53cd\u638c\u5417\uff1f\u6211\u4eec\u7528`map<string,int>`\u6765\u641e\u6620\u5c04\uff0c\u7136\u540e\u7528\u6700\u7b80\u5355\u7c97\u66b4\u7684\u601d\u8def\uff1a\u5047\u8bbe `A` \u8868\u793a\u4efb\u610f\u5927\u5199\u5b57\u6bcd\uff0c `a` \u8868\u793a\u4efb\u610f\u5c0f\u5199\u5b57\u6bcd\uff0c `1` \u8868\u793a\u4efb\u610f\u6570\u5b57\uff0c\u90a3\u4e48\u4e00\u4e2a\u8fd9\u6837\u7684\u5316\u5b66\u5206\u5b50\u5f0f\u80af\u5b9a\u662f\u7531 `Aa11`,`A11`,`Aa1`,`A11`,`A1`,`A`\u8fd9\u51e0\u79cd\u57fa\u672c\u7684\u5355\u5143\u7ec4\u6210\uff0c\u5206\u522b\u5224\u65ad\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(str.length())$\uff1a\n```cpp\nmap<string, int> mp;\nint getValue(string str)\n{\n    if (!str.length())\n        return 0;\n    int ans = 0;\n    for (signed int i = 0; i < str.length();)\n    {\n        int mul;// \u5143\u7d20\u7684\u8ba1\u91cf\u6570\n        string elem;// \u76ee\u6807\u5143\u7d20\n        if (i + 3 < str.length() && isupper(str[i]) && islower(str[i + 1]) && isdigit(str[i + 2]) && isdigit(str[i + 3]))\n        {\n            mul = (str[i + 2] - '0') * 10 + str[i + 3] - '0';\n            elem += str[i];\n            elem += str[i + 1];\n            i += 4;// \u76f4\u63a5\u8df3\u8f6c\u5230\u4e0b\u4e00\u4e2a\u5143\u7d20\n        }\n        else if (i + 2 < str.length() && isupper(str[i]) && isdigit(str[i + 1]) && isdigit(str[i + 2]))\n        {\n            mul = (str[i + 1] - '0') * 10 + str[i + 2] - '0';\n            elem += str[i];\n            i += 3;\n        }\n        else if (i + 2 < str.length() && isupper(str[i]) && islower(str[i + 1]) && isdigit(str[i + 2]))\n        {\n            mul = str[i + 2] - '0';\n            elem += str[i];\n            elem += str[i + 1];\n            i += 3;\n        }\n        else if (i + 1 < str.length() && isupper(str[i]) && islower(str[i + 1]))\n        {\n            mul = 1;\n            elem += str[i];\n            elem += str[i + 1];\n            i += 2;\n        }\n        else if (i + 1 < str.length() && isupper(str[i]) && isdigit(str[i + 1]))\n        {\n            mul = str[i + 1] - '0';\n            elem += str[i];\n            i += 2;\n        }\n        else if (isupper(str[i]))\n        {\n            mul = 1;\n            elem += str[i];\n            i++;\n        }\n        else\n            i++;\n        if (!mp[elem])// \u5931\u8d25\n        {\n            return -2147483648;\n        }\n        else\n        {\n            ans += mul * mp[elem];\n        }\n    }\n    return ans;\n}\n```\n\u73b0\u5728\u6211\u4eec\u8003\u8651\uff0c\u52a0\u4e0a\u4e86\u62ec\u53f7\uff0c\u6211\u4eec\u5e94\u8be5\u600e\u4e48\u505a\uff0c\u6211\u7684\u601d\u8def\u662f\uff1a\\\n\u9996\u5148\uff0c\u5efa\u7acb\u4e00\u4e2a\u7ed3\u6784\u4f53\uff08\u628a\u5b83\u770b\u4f5c\u201c\u7ed3\u70b9\u201d\uff09\uff0c\u5b58\u50a8\u4ee5\u4e0b\u6570\u636e\uff1a\n- \u4e00\u4e2a\u6307\u9488\u96c6\u5408\uff0c\u6307\u5411\u5b83\u6240\u4ee3\u8868\u7684\u5b57\u7b26\u4e32\u4e2d\u542b\u6709\u7684**\u4e00\u7ea7\u62ec\u53f7(\u8fde\u540c\u5b83\u540e\u9762\u7684\u6570\u5b57)**\u4e0b\u7684\u5185\u5bb9\u3002\n- \u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u8868\u793a\u8fd9\u4e2a\u7ed3\u70b9\u539f\u6765\u4ee3\u8868\u7684\u5b57\u7b26\u4e32**\u53bb\u6389\u62ec\u53f7\u53ca\u5176\u8fde\u540c\u7684\u6570\u5b57\u90e8\u5206**\u5269\u4f59\u7684\u5185\u5bb9\u3002\n- \u4e00\u4e2a\u6570\u5b57\uff0c\u8868\u793a\u5316\u5b66\u8ba1\u91cf\u6570\u3002\n\n\u53ef\u80fd\u4e0d\u662f\u5f88\u597d\u7406\u89e3\uff0c\u6211\u4e3e\u4e2a\u4f8b\u5b50\uff1a\\\n$$Ca(OH(CO2)2SO2)2O2(SO4)10 \\quad (1) $$ \n~~\u4ec0\u4e48\u9b3c\u755c\u73a9\u610f~~ \\\n\u73b0\u5728\u5047\u8bbe\u6839\u7ed3\u70b9\u5c31\u662f\u8fd9\u4e2a\u5b57\u7b26\u4e32\uff0c\u8fd9\u4e2a\u6574\u4f53\u53ea\u6709\u4e00\u4e2a\uff0c\u6240\u4ee5\u5316\u5b66\u8ba1\u91cf\u6570\u4e3a $1$ \uff08\u6ce8\u610f\u662f\u8fd9\u6574\u4e2a\u5206\u5b50\u5f0f\u7684\u5316\u5b66\u8ba1\u91cf\u6570\uff0c\u6240\u4ee5\u662f $1$ \uff0c\u800c\u4e0d\u662f\u6700\u540e\u7684 $10$ \uff09\u3002\u73b0\u5728\u6211\u4eec\u628a\u5176\u4e2d\u5e26\u62ec\u53f7\u8fde\u540c\u5176\u540e\u9762\u7684\u6570\u5b57\u90e8\u5206\u53bb\u6389\uff0c\u5f97\u5230\uff1a\n$$ CaO2 $$\n\uff08\u7531\u4e8e\u90a3\u4e2a $2$ \u8ddf\u7740 $O$ \u800c\u4e0d\u662f\u62ec\u53f7\uff0c\u6240\u4ee5\u4e0d\u5220\u3002\uff09\\\n\u5220\u53bb\u7684\u90e8\u5206\u5462\uff1f\u6210\u4e3a\u4e24\u4e2a\u6307\u9488\uff0c\u4e00\u4e2a\u6307\u9488\u662f\n$$\nOH(CO2)2SO2 \\quad (2)\n$$\n\u5b83\u8ddf\u7740\u7684\u5316\u5b66\u8ba1\u91cf\u6570\u662f $2$ \uff08\u5373\u5b57\u7b26\u4e32 $(1)$ \u7684\u7b2c $16$ \u4e2a\u5b57\u7b26\uff09\u3002\u53e6\u4e00\u4e2a\u6307\u9488\u662f\uff1a\n$$\nSO4\n$$\n\u5b83\u8ddf\u7740\u7684\u5316\u5b66\u8ba1\u91cf\u6570\u662f $10$ \uff08\u5373\u6700\u540e\u7684\u6570\u5b57\uff09\u3002\u7136\u540e\u5b57\u7b26\u4e32 $(2)$ \u91cc\u8fd8\u6709\u4e00\u5bf9\u62ec\u53f7\uff0c\u518d\u7528\u540c\u6837\u7684\u65b9\u6cd5\uff0c\u628a\u5b83\u5206\u89e3\u6210\u5269\u4f59\u90e8\u5206 $OHSO2$ \u5176\u6307\u9488 $CO2$ \uff08\u5316\u5b66\u8ba1\u91cf\u6570\uff1a $2$ )\u3002\\\n\u753b\u56fe\u8868\u793a\u6574\u4e2a\u7ed3\u6784\uff1a\\\n![](https://cdn.luogu.com.cn/upload/image_hosting/ixmw4vo2.png)\n\n\u5efa\u7acb\u8fd9\u4e2a\u7ed3\u6784\u7684\u65b9\u6cd5\uff1a\u521d\u59cb\u5316\u51fd\u6570\uff0c\u5148\u626b\u63cf\u6574\u4e2a\u5b57\u7b26\u4e32\uff0c\u7ef4\u62a4\u4e00\u4e2a\u6808\uff0c\u9047\u5230\u5de6\u62ec\u53f7\u5c31\u538b\u8fdb\u5b83\u7684\u4f4d\u7f6e\uff0c\u9047\u5230\u53f3\u62ec\u53f7\u5c31\u5f39\u51fa\uff0c\u5982\u679c\u6b64\u65f6\u6808\u4e3a\u7a7a\uff0c\u8868\u660e\u9047\u5230\u4e86\u4e00\u5bf9\u201c\u4e00\u7ea7\u62ec\u53f7\u201d\uff0c\u5c31\u83b7\u53d6\u5b83\u540e\u9762\u7684\u6570\u5b57\uff08\u5982\u679c\u6ca1\u6709\u5219\u4e3a $1$ \uff09\uff0c\u8bb0\u5f55\u4e0b\u8fd9\u5bf9\u62ec\u53f7\u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u6839\u636e\u62ec\u53f7\u91cc\u7684\u5185\u5bb9\u5efa\u7acb\u5bf9\u5e94\u7684\u6307\u9488\uff0c\u8fd9\u4e9b\u6307\u9488\u521d\u59cb\u5316\u4e5f\u7528\u540c\u6837\u7684\u65b9\u6cd5\u9012\u5f52\u8fdb\u884c\u3002\u6700\u540e\u6839\u636e\u521a\u624d\u8bb0\u5f55\u7684\u4e00\u7ea7\u6210\u5bf9\u62ec\u53f7\u7684\u4f4d\u7f6e\u6765\u5220\u9664\u62ec\u53f7\u90e8\u5206\u3002\\\n\\\n\u7136\u540e\u5c31\u662f\u8ba1\u7b97\u4e86\uff0c\u8fd9\u5f88\u7b80\u5355\uff0c\u76f4\u63a5\u9012\u5f52\u7b97\u5c31\u884c\uff0c\u9012\u5f52\u5230\u6700\u540e\u4e00\u5c42\uff08\u5373\u6ca1\u6709\u5b50\u8282\u70b9\u6307\u9488\uff09\u65f6\u5c31\u76f4\u63a5\u8c03\u7528`getValue`\u51fd\u6570\u3002\u5927\u5bb6\u60f3\u4e00\u60f3\u5c31\u53ef\u4ee5\u60f3\u51fa\u6765\uff0c\u5b9e\u5728\u60f3\u4e0d\u51fa\u6765\u5c31\u89c1\u4ee3\u7801\u3002\\\n\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u600e\u4e48\u5224\u65ad\u65e0\u89e3\u60c5\u51b5\uff1f\u8fd9\u65f6`getValue`\u4f1a\u8fd4\u56de\u4e00\u4e2a\u65e0\u9650\u5c0f\uff0c\u4e0d\u51fa\u610f\u5916\u7684\u8bdd\uff0c\u6574\u4e2a\u5206\u5b50\u5f0f\u7684\u76f8\u5bf9\u5206\u5b50\u8d28\u91cf\u5c31\u4f1a\u5c0f\u4e8e $0$ \uff0c\u636e\u6b64\u5224\u65ad\u5373\u53ef\u3002\n## Code:\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nmap<string, int> mp;\nint getValue(string);\nstruct Part\n{\n    string remain;// \u53bb\u9664\u62ec\u53f7\u5269\u4f59\u7684\u90e8\u5206\n    int mul;// \u5316\u5b66\u8ba1\u91cf\u6570\n    vector<Part *> deeper;// \u5b50\u8282\u70b9\u6307\u9488\u96c6\n    Part(string str, int n)\n    {\n        mul = n;\n        stack<int> st;\n        vector<pair<int, int>> d;\n        for (int i = 0; i < str.length(); i++)\n        {\n            if (str[i] == '(')\n                st.push(i);\n            else if (str[i] == ')')\n            {\n                int x = st.top();\n                st.pop();\n                if (st.empty()) // \u9047\u5230\u201c\u4e00\u7ea7\u62ec\u53f7\u201d\n                {\n                    int t = 0;\n                    if (i + 2 < str.length() && isdigit(str[i + 1]) && isdigit(str[i + 2]))\n                    {\n                        t = (str[i + 1] - '0') * 10 + str[i + 2] - '0';\n                        d.push_back(make_pair(x, i + 2));\n                    }\n                    else if (i + 1 < str.length() && isdigit(str[i + 1]))\n                    {\n                        t = str[i + 1] - '0';\n                        d.push_back(make_pair(x, i + 1));\n                    }\n                    else\n                    {\n                        t = 1;\n                        d.push_back(make_pair(x, i));\n                    }\n                    deeper.push_back(new Part(str.substr(x + 1, i - x - 1), t)); // \u9012\u5f52\u8c03\u7528\u521d\u59cb\u5316\u51fd\u6570\uff0c\u5bf9\u5e94\u62ec\u53f7\u91cc\u7684\u90e8\u5206\n                }\n            }\n        }\n        for (int i = d.size() - 1; i >= 0; i--)\n        {\n            str.erase(d[i].first, d[i].second - d[i].first + 1);// \u7531\u4e8e\u5220\u9664\u4f1a\u5bfc\u81f4\u76f8\u540c\u5b57\u7b26\u5728\u5b57\u7b26\u4e32\u5185\u4e0b\u6807\u7684\u6539\u53d8\uff0c\u6240\u4ee5\u4ece\u524d\u5f80\u540e\u5220\n        }\n        remain = str;\n    }\n    int getResult()// \u83b7\u53d6\u76f8\u5bf9\u5206\u5b50\u8d28\u91cf\n    {\n        if (deeper.empty())\n            return getValue(remain) * mul;// \u4e00\u4e2a\u53f6\u8282\u70b9\u7684\u76f8\u5bf9\u5206\u5b50\u8d28\u91cf\n        int ans = getValue(remain);// \u5269\u4f59\u90e8\u5206\u7684\u76f8\u5bf9\u5206\u5b50\u8d28\u91cf\n        for (auto i : deeper)\n        {\n            ans += i->getResult();// \u9012\u5f52\u83b7\u53d6\u5b50\u8282\u70b9\u7684\u76f8\u5bf9\u5206\u5b50\u8d28\u91cf\n        }\n        return ans * mul;// \u4e58\u4e0a\u5316\u5b66\u8ba1\u91cf\u6570\n    }\n};\nint getValue(string str)\n{\n    if (!str.length())\n        return 0;\n    int ans = 0;\n    for (signed int i = 0; i < str.length();)\n    {\n        int mul;\n        string elem;\n        if (i + 3 < str.length() && isupper(str[i]) && islower(str[i + 1]) && isdigit(str[i + 2]) && isdigit(str[i + 3]))\n        {\n            mul = (str[i + 2] - '0') * 10 + str[i + 3] - '0';\n            elem += str[i];\n            elem += str[i + 1];\n            i += 4;\n        }\n        else if (i + 2 < str.length() && isupper(str[i]) && isdigit(str[i + 1]) && isdigit(str[i + 2]))\n        {\n            mul = (str[i + 1] - '0') * 10 + str[i + 2] - '0';\n            elem += str[i];\n            i += 3;\n        }\n        else if (i + 2 < str.length() && isupper(str[i]) && islower(str[i + 1]) && isdigit(str[i + 2]))\n        {\n            mul = str[i + 2] - '0';\n            elem += str[i];\n            elem += str[i + 1];\n            i += 3;\n        }\n        else if (i + 1 < str.length() && isupper(str[i]) && islower(str[i + 1]))\n        {\n            mul = 1;\n            elem += str[i];\n            elem += str[i + 1];\n            i += 2;\n        }\n        else if (i + 1 < str.length() && isupper(str[i]) && isdigit(str[i + 1]))\n        {\n            mul = str[i + 1] - '0';\n            elem += str[i];\n            i += 2;\n        }\n        else if (isupper(str[i]))\n        {\n            mul = 1;\n            elem += str[i];\n            i++;\n        }\n        else\n            i++;\n        if (!mp[elem])\n        {\n            return -2147483648;\n        }\n        else\n        {\n            ans += mul * mp[elem];\n        }\n    }\n    return ans;\n}\nint main()\n{\n\t//\u8f93\u5165\u6570\u636e\u4e0d\u7528\u591a\u8bf4\u4e86\u5427\uff1f\n    string s;\n    cin >> s;\n    while (s != \"END_OF_FIRST_PART\")\n    {\n        int x;\n        cin >> x;\n        mp[s] = x;\n        cin >> s;\n    }\n    cin >> s;\n    while (s != \"0\")\n    {\n        Part *pt = new Part(s, 1);\n        int res = pt->getResult();\n        if (res < 0)\n            printf(\"UNKNOWN\\n\");\n        else\n            printf(\"%d\\n\", res);\n        cin >> s;\n    }\n    return 0;\n}\n```\n\n\n\n",
        "postTime": 1603012410,
        "uid": 306945,
        "name": "J_Ignite",
        "ccfLevel": 4,
        "title": "P2382 \u5316\u5b66\u5206\u5b50\u5f0f \u9898\u89e3"
    },
    {
        "content": "### \u8fd8\u6ca1\u6709Pascal\u7684\u4ee3\u7801\uff1f\n\n#### \u90a3\u5c31\u6765\u4e00\u7bc7\u5427\n\n\u9996\u5148\uff0c\u6211\u4eec\u81ea\u7136\u800c\u7136\u8054\u60f3\u5230\u8868\u8fbe\u5f0f\u6c42\u503c\u7684\u4e00\u9053\u9898\uff0c\u53ea\u8981\u5c06\u5143\u7d20\u7b26\u53f7\u8f6c\u5316\u4e3a\u6570\u5b57\uff0c\u518d\u5728\u5206\u5b50\u5f0f\u5185\u52a0\u4e0a\u52a0\u53f7\u548c\u4e58\u53f7\u5c31\u53ef\u4ee5\u4e86\u3002\u5f53\u7136\uff0c\u8fd9\u6837\u505a\u80af\u5b9a\u8d39\u65f6\u8d39\u529b\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u90a3\u9053\u9898\u76ee\u7684\u6808\u7ed3\u6784\u6539\u53d8\u4e00\u4e0b\u3002\n\n\u51e0\u4e2a\u5143\u7d20\u7b26\u53f7\u770b\u7740\u5f88\u4e0d\u987a\u773c\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u4ed6\u4eec\u8f6c\u5316\u6210$Hash$\u503c\uff0c\u5373\u9996\u4f4d\u548c\u672b\u4f4d\u6309\u6743\u5c55\u5f00\uff1a\n\n```\nfunction hash(s:string):longint;\nbegin\n  if length(s)=1 then exit(ord(s[1])-64)\n  else exit((ord(s[1])-64)*100+ord(s[2])-96);\nend;\n```\n\u8bfb\u5165\u90e8\u5206\u5f88\u7b80\u5355\n```\n  while true do\n  begin\n    readln(st);\n    if st='END_OF_FIRST_PART' then break;//\u7ed3\u675f\u4e86\u5c31\u9000\u51fa\n    k:=pos(' ',st);\n    val(copy(st,k+1,length(st)),m);//\u6570\u5b57\u90e8\u5206\n    mass[hash(copy(st,1,k-1))]:=m;//\u5b9a\u4e49\u539f\u5b50\u8d28\u91cf\n  end;\n```\n\u7136\u540e\uff0c\u6b63\u6587\u90e8\u5206\u5982\u4f55\u5c55\u5f00\u5462\uff1f\n\n\u6211\u4eec\u6709\u5982\u4e0b\u6b65\u9aa4\uff1a\n\n\u7b2c\u4e00\u6b65\uff0c\u5982\u679c\u9047\u5230\u5de6\u62ec\u53f7\uff0c\u76f4\u63a5\u8fdb\u6808\uff0c\u7b49\u7ea7$+1$\n\n\u7b2c\u4e8c\u6b65\uff0c\u5982\u679c\u9047\u5230\u5927\u5199\u5b57\u6bcd\uff0c\u5411\u540e\u5bfb\u627e\u8fd8\u6709\u6ca1\u6709\u5c0f\u5199\u5b57\u6bcd\u548c\u6570\u5b57\uff0c\u5e76\u5f97\u5230\u8fd9\u4e9b\u4e1c\u897f\u3002\n\n$sum=mass\\times cnt$\n\n\u7b2c\u4e09\u6b65\uff0c\u5982\u679c\u9047\u5230\u53f3\u62ec\u53f7\uff0c\u5411\u540e\u5bfb\u627e\u8fd8\u6709\u6ca1\u6709\u6570\u5b57\uff0c\u5e76\u5f97\u5230\u8fd9\u4e9b\u4e1c\u897f\u3002\n\n$ans[i]=ans[i+1]\\times cnt[i+1]$\n\n\u7136\u540e\u51fa\u6808\u3002\n\n\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u5f97\u4e0d\u5230\u6570\u5b57\uff0c\u5219$cnt=1$\n\n```\n  while true do\n  begin\n    readln(st);\n    fillchar(num,sizeof(num),0);//\u521d\u59cb\u5316\n    w:=0;//\u5f53\u524d\u7ea7\u522b\n    if st='0' then break;//\u5b8c\u6210\u4e86\u5c31\u9000\u51fa\n    flag:=true;\n    st:='('+st+')';//\u65b9\u4fbf\u6700\u540e\u7684\u5904\u7406\n    for i:=1 to length(st) do\n    begin\n      if st[i]='(' then//\u8fdb\u6808\n      begin\n        inc(w);\n        num[w]:=0;\n      end;\n      if st[i] in ['A'..'Z'] then//\u78b0\u5230\u5143\u7d20\u7b26\u53f7\n      begin\n        if st[i+1] in ['a'..'z'] then name:=st[i]+st[i+1]\n        else name:=st[i];//\u5f97\u5230\u5b8c\u6574\u540d\u79f0\n        if mass[hash(name)]=-1 then//\u5982\u679c\u627e\u4e0d\u5230\u8fd9\u4e2a\u5143\u7d20\u7b26\u53f7\n        begin\n          writeln('UNKNOWN');\n          flag:=false;\n          break;\n        end;\n        j:=i+length(name);//\u7ee7\u7eed\u5411\u540e\u5bfb\u627e\u6570\u5b57\n        cnt:=0;\n        while st[j] in ['0'..'9'] do\n        begin\n          cnt:=cnt*10+ord(st[j])-48;//\u548cC++\u7684\u5feb\u8bfb\u5dee\u4e0d\u591a\n          inc(j);\n        end;\n        if cnt=0 then cnt:=1;//\u5982\u679c\u6ca1\u6709\u6570\u5b57\u5c31\u662f1\n        num[w]:=num[w]+mass[hash(name)]*cnt;//\u83b7\u5f97\u6574\u4e2a\u90e8\u5206\u7684\u8d28\u91cf\u5206\u6570\n      end;\n      if st[i]=')' then//\u51fa\u6808\n      begin\n        j:=i+1;//\u5411\u540e\u5bfb\u627e\u6570\u5b57\n        cnt:=0;\n        while st[j] in ['0'..'9'] do\n        begin\n          cnt:=cnt*10+ord(st[j])-48;\n          inc(j);\n        end;\n        if cnt=0 then cnt:=1;\n        dec(w);//\u66f4\u65b0\u4e0a\u4e00\u7ea7\u522b\u7684\u8d28\u91cf\u5206\u6570\n        num[w]:=num[w]+num[w+1]*cnt;\n      end;\n    end;\n    if flag=true then writeln(num[0]);//\u5982\u679c\u6ca1\u6709\u51fa\u73b0UNKNOWN\u60c5\u51b5\n  end;\n```\n### \u5b8c\u6574\u7a0b\u5e8f\n\n```\nvar mass,num:array[0..10000]of longint;\n    st,name:string;\n    flag:boolean;\n    k,i,j,cnt,w,m:longint;\nfunction hash(s:string):longint;\nbegin\n  if length(s)=1 then exit(ord(s[1])-64)\n  else exit((ord(s[1])-64)*100+ord(s[2])-96);\nend;\nbegin\n  fillchar(mass,sizeof(mass),255);\n  while true do\n  begin\n    readln(st);\n    if st='END_OF_FIRST_PART' then break;\n    k:=pos(' ',st);\n    val(copy(st,k+1,length(st)),m);\n    mass[hash(copy(st,1,k-1))]:=m;\n  end;\n  while true do\n  begin\n    readln(st);\n    fillchar(num,sizeof(num),0);\n    w:=0;\n    if st='0' then break;\n    flag:=true;\n    st:='('+st+')';\n    for i:=1 to length(st) do\n    begin\n      if st[i]='(' then\n      begin\n        inc(w);\n        num[w]:=0;\n      end;\n      if st[i] in ['A'..'Z'] then\n      begin\n        if st[i+1] in ['a'..'z'] then name:=st[i]+st[i+1]\n        else name:=st[i];\n        if mass[hash(name)]=-1 then\n        begin\n          writeln('UNKNOWN');\n          flag:=false;\n          break;\n        end;\n        j:=i+length(name);\n        cnt:=0;\n        while st[j] in ['0'..'9'] do\n        begin\n          cnt:=cnt*10+ord(st[j])-48;\n          inc(j);\n        end;\n        if cnt=0 then cnt:=1;\n        num[w]:=num[w]+mass[hash(name)]*cnt;\n      end;\n      if st[i]=')' then\n      begin\n        j:=i+1;\n        cnt:=0;\n        while st[j] in ['0'..'9'] do\n        begin\n          cnt:=cnt*10+ord(st[j])-48;\n          inc(j);\n        end;\n        if cnt=0 then cnt:=1;\n        dec(w);\n        num[w]:=num[w]+num[w+1]*cnt;\n      end;\n    end;\n    if flag=true then writeln(num[0]);\n  end;\nend.\n```",
        "postTime": 1546523801,
        "uid": 107231,
        "name": "zombie462",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2382 \u3010\u5316\u5b66\u5206\u5b50\u5f0f\u3011"
    },
    {
        "content": "\u770b\u5230\u6709\u62ec\u53f7\u4f18\u5148\u7ea7\u5c31\u60f3\u5230\u4e86\u7528DFS(\u4f5c\u7528\u7c7b\u4f3c\u4e8e\u6808)\n\ndfs\u7684\u610f\u4e49\u7c7b\u4f3c\u4e8e\u53d6\u4ece\u7b2c'p'\u4f4d\u7f6e\u5f00\u59cb\u7684\u5316\u5b66\u5f0f\u7684\u8d28\u91cf\uff0c\u90a3\u4e48\u53ea\u8981\u4e00\u9047\u5230\u524d\u62ec\u53f7\u5c31dfs\uff0c\u9047\u5230\u540e\u62ec\u53f7\u8868\u793a\u8fd9\u4e00\u5768\u5316\u5b66\u5f0f\u7b97\u5b8c\u4e86\uff0c\u90a3\u4e48\u5c31\u8fd4\u56de\n\n\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4e3a\u4e86\u9632\u6b62\u91cd\u590d\u5224\u65ad\u540e\u62ec\u53f7(\u6bd4\u5982\u4e00\u4e2a\u540e\u62ec\u53f7\u4e0d\u662f\u548c\u524d\u9762\u7684\u4e00\u4e2a\u524d\u62ec\u53f7\u5339\u914d\u800c\u662f\u548c\u53e6\u4e00\u4e2a\u66f4\u8fd1\u7684\u524d\u62ec\u53f7\u5339\u914d)\uff0c\u5728dfs\u7684\u8fd4\u56de\u503c\u4e0a\u505a\u51fa\u4e86\u4e00\u4e9b\u5904\u7406\uff0c\u7528pair\u53ef\u4ee5\u8ba9\u8fd4\u56de\u503c\u6709\u4e24\u4e2a(\u81ea\u5df1\u5199struct\u4e5f\u53ef\u4ee5)\u4e00\u4e2a\u662f\u7b54\u6848\uff0c\u4e00\u4e2a\u662f\u5f53\u524d\u8fd9\u4e2a\u5316\u5b66\u5f0f\u7ed3\u675f\u7684\u4f4d\u7f6e\u3002\u8fd9\u6837\u5f53dfs\u5b8c\u5c31\u53ef\u4ee5\u5c06i\u79fb\u5230\u5316\u5b66\u5f0f\u7ed3\u675f\u7684\u5730\u65b9\u7ee7\u7eed\u5f00\u59cb\u627e\u62ec\u53f7(\u6216\u5316\u5b66\u5f0f)\uff0c\u4e0d\u4f1a\u91cd\u590d\n\n\u627e\u6570\u5b57\u548c\u627e\u5316\u5b66\u5f0f\u90fd\u5f88\u7b80\u5355\uff0c\u5c01\u88c5\u4e86\u4e24\u4e2a\u51fd\u6570\uff0c\u590d\u6742\u5ea6\u6709\u70b9\u9ad8\u4e0d\u8fc7\u4e5f\u53ef\u4ee5AC\n\n```cpp\n//\u5316\u5b66\u5143\u7d20                            \u8d77\u59cb\u4f4d\u7f6e\ninline string getElement(string &ele,int sta){\n\tstring ret;\n\tret += ele[sta];\n\tsta++;\n\twhile(ele[sta] >= 'a' && ele[sta] <= 'z'){\n\t\tret += ele[sta];\n\t\tsta++;\n\t}\n\treturn ret;\n}\n//\u7cfb\u6570\ninline string getNum(string &ele,int sta){\n\tstring ret;\n\tret += ele[sta];\n\tsta++;\n\twhile(ele[sta] >= '0' && ele[sta] <= '9'){\n\t\tret += ele[sta];\n\t\tsta++;\n\t}\n\treturn ret;\n}\n//string -> num\ninline ll string2Num(string str){\n\tll ret = 0;\n\tfor(int i=0;i<str.size();i++){\n\t\tret += (str[i]-'0') * pow(10,str.size()-i-1);\n\t}\n\treturn ret;\n}\n```\n\u5b8c\u6574\u4ee3\u7801:\n```cpp\n#include <bits/stdc++.h>\ntypedef long long ll;\nusing namespace std;\nmap< string , ll> elem;\ninline string getElement(string &ele,int sta){\n\tstring ret;\n\tret += ele[sta];\n\tsta++;\n\twhile(ele[sta] >= 'a' && ele[sta] <= 'z'){\n\t\tret += ele[sta];\n\t\tsta++;\n\t}\n\treturn ret;\n}\ninline string getNum(string &ele,int sta){\n\tstring ret;\n\tret += ele[sta];\n\tsta++;\n\twhile(ele[sta] >= '0' && ele[sta] <= '9'){\n\t\tret += ele[sta];\n\t\tsta++;\n\t}\n\treturn ret;\n}\ninline ll string2Num(string str){\n\tll ret = 0;\n\tfor(int i=0;i<str.size();i++){\n\t\tret += (str[i]-'0') * pow(10,str.size()-i-1);\n\t}\n\treturn ret;\n}\nbool unknow = false;\npair<ll,ll> dfs(string ele,int p,int deep){\n\tif(unknow) return make_pair(-1,-1);\n\tll ret = 0;\n\tfor(int i=p;i<ele.size();i++){\n\t\tif(unknow) return make_pair(-1,-1);\n\t\tif(ele[i]=='('){\n\t\t\tpair<ll,ll> tmp = dfs(ele,i+1,deep+1);\n\t\t\tret += tmp.first;\n\t\t\ti = tmp.second;\n\t\t}else if(ele[i]==')'){\n\t\t\tif(i+1 < ele.size() && ele[i+1] >= '0' && ele[i+1] <= '9'){\n\t\t\t\tstring nn = getNum(ele,i+1);\n\t\t\t\tll num = string2Num(nn);\n\t\t\t\treturn make_pair(ret*num,i+nn.size());\n\t\t\t}\n\t\t\treturn make_pair(ret,i+1);\n\t\t}else if(ele[i] >= 'A' && ele[i] <= 'Z'){\n\t\t\tstring nowele = getElement(ele,i);\n\t\t\tif(!elem.count(nowele)){\n\t\t\t\tunknow = true;\n\t\t\t\treturn make_pair(-1,-1);\n\t\t\t}\n\t\t\tif(ele[i+nowele.size()] >= '0' && ele[i+nowele.size()] <= '9'){\n\t\t\t\tstring nn = getNum(ele,i+nowele.size());\n\t\t\t\tll num = string2Num(nn);\n\t\t\t\tret += elem[nowele] * num;\n\t\t\t}else{\n\t\t\t\tret += elem[nowele];\n\t\t\t}\t\t\n\t\t}\n\t}\n\treturn make_pair(ret,ele.size());\n}\nvoid solve(string ele){\n\tunknow = false;\n\tpair<ll,ll> ans = dfs(ele,0,1);\n\tif(unknow){\n\t\tcout << \"UNKNOWN\" << endl;\n\t}else{\n\t\tcout << ans.first << endl;\n\t}\n}\nint main(){\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\tstring ele;\n\twhile(cin >> ele){\n\t\tif(ele == \"END_OF_FIRST_PART\") break;\n\t\tll mm;\n\t\tcin >> mm;\n\t\telem[ele] = mm;\n\t}\n\t\n\twhile(cin >> ele){\n\t\tif(ele == \"0\") break;\n\t\tsolve(ele);\n\t}\n\t\n\treturn 0;\n}\n```",
        "postTime": 1538534298,
        "uid": 83266,
        "name": "aRenBigFather",
        "ccfLevel": 0,
        "title": "[P2382]\u5316\u5b66\u5206\u5b50\u5f0f"
    },
    {
        "content": "\u4e0d\u61c2\u4e3a\u4ec0\u4e48\uff0c\u672c\u849f\u84bb\u7528\u5728\u7ebf\u7b97\u6cd5\u6253\u5c31\u4e00\u76f4\u70b8......\n\n\u76f4\u5230\u7528\u4e86\"\u534a\u79bb\u7ebf\"\u7b97\u6cd5......\n\n\u4e00\u904d\u5c31\u8fc7\u4e86\u597d\u5417......\n\n\u67d0\u4f4d\u673a\u623f\u7684\u5c0f\u4f19\u4f34\u4e00\u904d\u5c31\u8fc7\u4e86\n\n\u53e6\u4e00\u4f4d\u673a\u623f\u7684\u5c0f\u4f19\u4f34\u4e5f\u662f\u6bcf\u6b21\u90fd\u7206\u96f6\uff0c\u8fd8\u5927\u53eb\"\u6211\u518d\u4e5f\u4e0d\u6253\u8fd9\u4e00\u9898\u4e86\"\n\n\u55ef......\u771f\u9999\uff01\n\n---\n\n**\u3010\u5206\u6790\u3011**\n--\n\n\u672c\u849f\u84bb\u770b\u5230\u9898\u76ee\u7684\u7b2c\u4e00\u505a\u6cd5\u662f\u8003\u8651\u600e\u4e48\u50a8\u5b58\u5143\u7d20\u7684\u8d28\u91cf\n\n\u5047\u8bbe\u6211\u4eec\u628a\u53ea\u7531\u4e00\u4e2a\u5b57\u6bcd\u6784\u6210\u7684\u5143\u7d20\u7b26\u53f7\u770b\u6210\u540e\u9762\u8865\u4e86\u4e00\u4e2a\u7a7a\u683c\n\n\u90a3\u4e48\uff0c\u6bcf\u4e2a\u5143\u7d20\u90fd\u662f\u7531\u4e24\u4f4d\u5b57\u7b26\u7ec4\u6210\n\n\u5176\u4e2d\u7b2c\u4e00\u4f4d\u4e00\u5b9a\u4e3a\u5927\u5199\uff0c\u7b2c\u4e8c\u4f4d\u4e00\u5b9a\u4e3a\u5c0f\u5199\u6216\u7a7a\u683c\n\n\u90a3\u4e48\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6700\u591a\u7ed9\u5b9a $26 \\times 27 = 702$ \u79cd\u4e0d\u540c\u7684\u5143\u7d20\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u76f4\u63a5\u53ef\u4ee5\u5f00\u4e00\u4e2a\u6570\u7ec4 $m_i$ \u5b58\u5404\u4e2a\u5143\u7d20\u7684\u8d28\u91cf\n\n\u6839\u636e\u4e0a\u9762\u7684\u63d0\u793a\uff0c\u663e\u7136\uff0c\u8fd9\u8fb9\u752827\u8fdb\u5236\u4f1a\u6bd4\u8f83 ~~elegant~~ \u4f18\u96c5\n\n\u540c\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8bfb\u5165\u5b57\u7b26\u65f6\u52a0\u4e00\u4e2a\u5224\u5b9a\n\n\u8bfb\u5165\u5b8c\u5927\u5199\u5b57\u7b26\u540e\uff0c\u76f4\u63a5\u8bfb\u5165\u4e0b\u4e00\u4f4d\n\n\u5982\u679c\u662f\u7a7a\u683c\uff0c\u663e\u7136\u5e94\u8be5\u8df3\u51fa\n\n\u5982\u679c\u662f\u5c0f\u5199\uff0c\u663e\u7136\u5e94\u8be5\u8fdb\u5236\u8f6c\u6362\n\n\u6839\u636e\u9898\u76ee\uff0c\u8f93\u5165\u7ed3\u675f\u7684\u6807\u5fd7\u4e3a\n\n\"END_OF_FIRST_PART\"\n\n\u8fd9\u662f\u4e2a\u5f88\u660e\u663e\u7684\u6807\u5fd7\uff0c\u5b83\u7684\u7b2c\u4e8c\u4f4d\u4e5f\u662f\u5927\u5199\n\n\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u6807\u5fd7\uff0c\u5224\u65ad\u4ec0\u4e48\u65f6\u5019\u8bfb\u5165\u90e8\u5206\u7ed3\u675f\n\n\u81f3\u4e8e\u6570\u5b57\u8bfb\u5165\uff0c\u53ef\u4ee5\u53c2\u8003\u8bfb\u5165\u4f18\u5316\u7684\u601d\u8def\n\n\u8fd9\u8fb9\u52a0\u4e00\u6761\u5fe0\u544a ~~(\u8fc7\u6765\u4eba\u7684\u8bed\u6c14)~~ \uff1a\u8bfb\u5230\u7ed3\u675f\u6807\u5fd7\u4e86\u8bb0\u5f97\u541e\u6389\u6574\u884c\n\n---\n\n\u55ef\uff0c\u7ee7\u7eed\u8bb2\u4e00\u4e0b\u8ba1\u7b97\u5206\u5b50\u91cf\u7684\u5b9e\u73b0\n\n\u8fd9\u8fb9\u672c\u849f\u84bb\u4e0d\u61c2\u4e3a\u4ec0\u4e48\uff0c\u6309\u4e00\u8fb9\u8bfb\u5165\u4e00\u8fb9\u538b\u6808\u4e00\u8fb9\u7b97\u7684\u5728\u7ebf\u7b97\u6cd5\u6253\u4e00\u76f4\u4f1a\u51fa\u9519(\u91cd\u70b9\u662f\u672c\u5730\u6d4b\u8fd8\u6ca1\u95ee\u9898)\uff0c\u6240\u4ee5\u5c31\u7528\u5b57\u7b26\u6570\u7ec4\u6765\u5b58\u4e86......\n\n\u6211\u4eec\u7528\u4e00\u4e2a\u5b57\u7b26\u6570\u7ec4 **(\u8fd9\u91cc\u7279\u5730\u5f3a\u8c03\uff0c\u4e0d\u662f\u5b57\u7b26\u4e32 string \uff0c\u56e0\u4e3a\u672c\u849f\u84bb\u89c9\u5f97\u90a3\u4e2a\u5f88\u8017\u65f6\u95f4)** \u6765\u5b58\u5316\u5b66\u5f0f\n\n\u63a5\u4e0b\u6765\u7684\u8fd0\u884c\u8ddf\u8bfb\u5165\u5176\u5b9e\u5dee\u4e0d\u591a\n\n\u4e0d\u8fc7\uff0c\u8fd9\u8fb9\u8981\u52a0\u4e00\u4e2a\u9650\u5236\n\n\u5982\u679c\u51fa\u73b0\u62ec\u53f7\uff0c\u6211\u4eec\u9700\u8981\u5148\u8ba1\u7b97\u62ec\u53f7\u5185\u7684\u503c\uff0c\u518d\u4e58\u4e0a\u62ec\u53f7\u7684\u7cfb\u6570(\u5728\u53cd\u62ec\u53f7\u540e)\n\n\u8fd9\u8fb9\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u6808\n\n\u4e00\u65e6\u51fa\u73b0\u62ec\u53f7\uff0c\u8bf4\u660e\u8981\u5148\u7b97\u91cc\u9762\u7684\uff0c\u6211\u5c31\u628a\u4e4b\u524d\u7b97\u597d\u7684\u5148\u653e\u5230\u6808\u91cc\u9762\n\n\u7b49\u5bf9\u5e94\u7684\u53cd\u62ec\u53f7\u51fa\u73b0\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u7b97\u51fa\u8fd9\u4e2a\u62ec\u53f7\u63cf\u8ff0\u7684\u539f\u5b50\u56e2\u7684\u503c\n\n\u628a\u8fd9\u4e2a\u503c\u4e0e\u7cfb\u6570\u7684\u4e58\u79ef\u52a0\u56de\u4e0a\u4e00\u5c42\u7684\u6808\u91cc\uff0c\u5c31\u53ef\u4ee5\u628a\u8fd9\u4e2a\u62ec\u53f7\u89e3\u51b3\u4e86\n\n\u90a3\u5176\u4ed6\u7684\u7ec6\u8282\u5c31\u770b\u4e00\u4e0b\u672c\u849f\u84bb ~~\u5947\u4e11\u65e0\u6bd4~~ \u7684\u4ee3\u7801\u5427\n\n---\n\n**\u3010\u4ee3\u7801\u3011**\n--\n\n\u90a3\u672c\u849f\u84bb\u5c31\u653e\u4ee3\u7801\u4e86\n\n```cpp\n#include<cstdio>\n#include<cctype>\n#include<cstring>\nusing namespace std;\nint m[800]={0};\nchar s[100]={0};\ninline int READ_NAME(char &c){\n    register int ans=0; while(!isupper(c)) c=getchar();\n    ans=c-'A'; c=getchar();\n    if(islower(c)) ans+=(c-'a'+1)*26,c=getchar();\n    return ans;\n}//\u5143\u7d20\u540d\u8bfb\u5165\ninline int READ_NUM(char &c){\n    register int ans=0; while(!isdigit(c)) c=getchar();\n    while(isdigit(c)) ans=(ans<<3)+(ans<<1)+c-'0',c=getchar();\n    return ans;\n}//\u6570\u5b57\u8bfb\u5165\nint READ_CHE(){\n\tint stack[80]={0},size=0,pos=0,len=strlen(s);\n    //stack[i]\u8868\u793a\u7b2ci\u5c42\u62ec\u53f7\u5185\u7684\u503c\n\twhile(pos<len){\n\t\t\t if(!(s[pos]^'(')) stack[size++],pos++;\n             //\u6307\u9488\u8bb0\u5f97\u540e\u79fb\n\t\telse if(!(s[pos]^')')){\n\t\t\tint tmp=0;\n\t\t\tif(!isdigit(s[pos+1])) tmp=1;\n\t\t\twhile(isdigit(s[pos+1])) tmp=(tmp<<3)+(tmp<<1)+s[++pos]-'0';\n            //\u8bfb\u5165\u4f18\u5316\u7c7b\u4f3c\u4ee3\u7801\n\t\t\tpos++;\n\t\t\tstack[size-1]+=stack[size]*tmp;\n\t\t\tstack[size--]=0;\n            //\u907f\u514d\u51fa\u73b0\u88ab(NH4)[Al(OH)4]\u5361\u6389\u7684\u60c5\u51b5\uff0c\u867d\u7136\u4e0d\u77e5\u9053\u662f\u5426\u5b58\u5728\u8fd9\u4e2a\u7269\u8d28\n\t\t}\n\t\telse if(isupper(s[pos])){\n\t\t\tint Tmp=s[pos]-'A';\n\t\t\tif(islower(s[pos+1])) Tmp+=(s[pos+1]-'a'+1)*26,pos++;\n            //\u8ba1\u7b97\u7f16\u7801\n\t\t\tif(!m[Tmp]) return -1;\n            //\u6ca1\u8bfb\u5165\u5230\uff0c\u76f4\u63a5\u8fd4\u56de\"UNKNOWN\"\u7684\u6307\u4ee4\n\t\t\tint tmp=0;\n\t\t\tif(!isdigit(s[pos+1])) tmp=1;\n\t\t\twhile(isdigit(s[pos+1])) tmp=(tmp<<3)+(tmp<<1)+s[++pos]-'0';\n\t\t\tpos++;\n\t\t\tstack[size]+=m[Tmp]*tmp;\n\t\t}\n\t}\n\treturn stack[0];//\u8fd4\u56de\u7b2c0\u5c42\u62ec\u53f7\u5185\u7684\u503c\n}//\u8d28\u91cf\u8ba1\u7b97\ninline void pre(){\n    char c=getchar();\n    while(1){\n        int tmp=READ_NAME(c);\n        if(isupper(c)){//\u8bfb\u5230\u7ed3\u675f\u8bed\u53e5\n            while((c^'\\n')&(c^'\\r')) c=getchar();//\u541e\u6389\u6574\u884c\n            return ;\n        }\n        m[tmp]=READ_NUM(c);\n    }\n}\nint main(){\n    pre();\n    scanf(\"%s\",s);\n    while(s[0]^'0'){\n        int tmp=READ_CHE();\n        if(tmp>0) printf(\"%d\\n\",tmp);\n        else puts(\"UNKNOWN\");\n        //\u8bfb\u5230\u672a\u77e5\u5143\u7d20\u4f1a\u8fd4\u56de -1\n        memset(s,0,sizeof(s));\n        //\u8bb0\u5f97\u6e05\u96f6\uff0c\u907f\u514d\u88ab H2O F2 \u5361\u6389\n        scanf(\"%s\",s);\n    }\n    return 0;\n}\n```",
        "postTime": 1536411405,
        "uid": 36031,
        "name": "JustinRochester",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2382 \u3010\u5316\u5b66\u5206\u5b50\u5f0f\u3011"
    }
]
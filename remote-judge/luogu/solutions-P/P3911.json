[
    {
        "content": "\u6211\u4eec\u5148\u7528c\u6570\u7ec4\u9884\u5904\u7406\u51fa\u6bcf\u4e2a\u6570\u51fa\u73b0\u7684\u6b21\u6570,\u90a3\u4e48\u539f\u95ee\u9898\u53d8\u4e3a\u6c42\u89e3\n$$\\sum_{i=1}^n\\sum_{j=1}^n lcm(i,j)\\times c_i \\times c_j$$\n\u5176\u4e2dn\u8868\u793a\u6700\u5927\u7684\u6570\u3002\n\n\u7136\u540e\uff1f\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u6765\u4e00\u53d1\n\n\u4e3a\u4e86\u907f\u514d\u9ebb\u70e6,\u8fd9\u91cc\u5148\u4f7f$T=kd$\n\n\n\nLaTeX\u70b8\u4e86\uff1f\u5907\u4efd\u4e00\u4efd\u6e90\u7801\u3002\u5148\u7528\u56fe\u7247\u4ee3\u66ff\u3002\n![](https://cdn.luogu.com.cn/upload/pic/56545.png)\n```latex\n\\begin{aligned}\n& \\sum_{i=1}^n\\sum_{j=1}^n lcm(i,j)\\times c_i \\times c_j\\\\\n=& \\sum_{i=1}^n\\sum_{j=1}^n \\frac{i \\times j\\times c_i \\times c_j}{\\gcd(i,j)} \\\\ \n=& \\sum_{d=1}^n\\sum_{i=1}^{\\lfloor n/d \\rfloor}\\sum_{j=1}^{\\lfloor n/d \\rfloor}[\\gcd(i,j)=1]d\\times i \\times j \\times c_{id} \\times c_{jd} \\\\\n=& \\sum_{d=1}^n\\sum_{i=1}^{\\lfloor n/d \\rfloor}\\sum_{j=1}^{\\lfloor n/d \\rfloor}\\sum_{k|\\gcd(i,j)}\\mu(k) \\times d\\times i \\times j \\times c_{id} \\times c_{jd} \\\\\n=& \\sum_{d=1}^n\\sum_{k=1}^{\\lfloor n/d\\rfloor}\\sum_{i=1}^{\\lfloor n/kd\\rfloor}\\sum_{j=1}^{\\lfloor n/kd\\rfloor}\\mu(k)\\times d \\times i \\times j \\times k^2 \\times c_{idk} \\times c_{jdk} \\\\\n=& \\sum_{T=1}^{n}T\\times(\\sum_{i=1}^{\\lfloor n/T \\rfloor}i\\times c_{iT})^2\\sum_{k|T}\\mu(k)\\times k\n\\end{aligned}\n```\n\u770b\u8d77\u6765\u5341\u5206\u53ef\u6015,\u5176\u5b9e\u90fd\u662f\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u9898\u7684\u57fa\u672c\u64cd\u4f5c\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u5f00\u5fc3\u5730\u9884\u5904\u7406\u51fa$\\sum_{k|T}\\mu(k)\\times k$,\u66b4\u529b\u6c42\u89e3\u5566\uff01\n\n\u8fd9\u6837\u7684\u590d\u6742\u5ea6\u4e3a$O(\\sum^n_{i=1}\\frac ni)$,\u5373$O(n \\ln n)$,\u53ef\u4ee5\u8f7b\u677e\u8fc7\u6b64\u9898\u3002\n\n# \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define LL long long\n#define MAXN 50005\n#define rgt register\n\nint N, M, cnt[MAXN], mu[MAXN], p[MAXN], tot, v[MAXN];\nLL s[MAXN];\nLL ans(0);\n\nint main(){\n\tscanf( \"%d\", &N ); for ( rgt int i = 1, x; i <= N; ++i ) scanf( \"%d\", &x ), ++cnt[x], M = max( M, x );\n\tN = M, mu[1] = 1;\n\tfor ( rgt int i = 2; i <= N; ++i ){//\u7ebf\u6027\u7b5b\u51famu\n\t\tif ( !v[i] ) p[++tot] = i, mu[i] = -1;\n\t\tfor ( rgt int j = 1; j <= tot && i * p[j] <= N; ++j ){\n\t\t\tv[i * p[j]] = 1;\n\t\t\tif ( i % p[j] == 0 ){ mu[i * p[j]] = 0; break; }\n\t\t\telse mu[i * p[j]] = -mu[i];\n\t\t}\n\t}\n\t\n\tfor ( rgt int i = 1; i <= N; ++i )\n\t\tfor ( rgt int j = i; j <= N; j += i )\n\t\t\ts[j] += 1ll * mu[i] * i;//\u9884\u5904\u7406\u63d0\u5230\u8fc7\u7684\u90a3\u73a9\u610f\n\t\n\tfor ( rgt int T = 1; T <= N; ++T ){\n\t\trgt LL cur(0);\n\t\tfor ( rgt int i = 1, I = N / T; i <= I; ++i ) cur += 1ll * cnt[i * T] * i;//\u66b4\u529b\u6c42\u89e3\n\t\tans += T * cur * cur * s[T];\n\t} printf( \"%lld\\n\", ans );\n\treturn 0;\n}\n```\n\n",
        "postTime": 1555153945,
        "uid": 70786,
        "name": "_louhc",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3911 \u3010\u6700\u5c0f\u516c\u500d\u6570\u4e4b\u548c\u3011"
    },
    {
        "content": "~~\u7b80\u5355\u95ee\u9898\u590d\u6742\u5316\u662f\u89e3\u51b3\u95ee\u9898\u7684\u4e00\u4e2a\u597d\u65b9\u6cd5\u3002~~\n\n\u4ee4 $c_i$ \u8868\u793a $i$ \u51fa\u73b0\u7684\u6b21\u6570\uff0c$n$ \u4e3a\u6700\u5927\u6570\u5b57\u3002\n\n$$\\sum_{i=1}^n \\sum_{j=1}^nc_i  \\times c_j \\times lcm(i,j)$$\n\n$$\\sum_{i=1}^n \\sum_{j=1}^nc_i  \\times c_j \\times \\frac{i \\times j}{gcd(i,j)}$$\n\n$$\\sum_{k=1}^n\\sum_{i=1}^n \\sum_{j=1}^n [gcd(i,j)=k] c_i  \\times c_j \\times \\frac{i \\times j}{k}$$\n\n$$\\sum_{k=1}^n\\sum_{i=1}^{\\lfloor \\frac{n}{k} \\rfloor } \\sum_{j=1}^{\\lfloor \\frac{n}{k} \\rfloor} [gcd(i,j)=1] c_{ik}  \\times c_{jk} \\times i \\times j \\times k$$\n\n$$\\sum_{k=1}^n\\sum_{i=1}^{\\lfloor \\frac{n}{k} \\rfloor } \\sum_{j=1}^{\\lfloor \\frac{n}{k} \\rfloor} \\sum_{d|gcd(i,j)}\\mu(d) \\times c_{ik}  \\times c_{jk} \\times i \\times j \\times k$$\n\n$$\\sum_{k=1}^n\\sum_{d=1}^{\\lfloor \\frac{n}{k} \\rfloor} \\mu(d) \\times d^2 \\sum_{i=1}^{\\lfloor \\frac{n}{kd} \\rfloor } \\sum_{j=1}^{\\lfloor \\frac{n}{kd} \\rfloor}  c_{ikd}  \\times c_{jkd} \\times i \\times j \\times k$$\n\n$$\\sum_{k=1}^n\\sum_{kd=1}^{n}\\mu(d) \\times d^2\\sum_{i=1}^{\\lfloor \\frac{n}{kd} \\rfloor } \\sum_{j=1}^{\\lfloor \\frac{n}{kd} \\rfloor} c_{ikd}  \\times c_{jkd} \\times i \\times j \\times k$$\n\n$$\\sum_{T=1}^n T(\\sum_{d|T}\\mu(d) \\times d )\\sum_{i=1}^{\\lfloor \\frac{n}{T} \\rfloor } \\sum_{j=1}^{\\lfloor \\frac{n}{T} \\rfloor} c_{iT}  \\times c_{jT} \\times i \\times j$$\n\n$$\\sum_{T=1}^n T(\\sum_{d|T}\\mu(d) \\times d ) (\\sum_{i=1}^{\\lfloor \\frac{n}{T} \\rfloor } c_{iT} \\times i)^2$$\n\n\u7b2c\u4e00\u4e2a\u62ec\u53f7\u9884\u5904\u7406\uff0c\u7b2c\u4e8c\u4e2a\u62ec\u53f7\u76f4\u63a5\u66b4\u529b\u7b97\u3002\n\n\u9884\u5904\u7406\u548c\u67e5\u8be2\u590d\u6742\u5ea6\u5747\u4e3a $\\Theta(n \\ln n)$\u3002\n\n```cpp\n#include <cstdio>\n#include <iostream>\nusing namespace std;\n\nconst int MAXN = 5e4;\nint n , m , k , cnt[ MAXN + 5 ] , prime[ MAXN + 5 ] , mu[ MAXN + 5 ];\nlong long Ans , f[ MAXN + 5 ];\nbool vis[ MAXN + 5 ];\n\nvoid sieve( ) {\n\tmu[ 1 ] = 1;\n\tfor( int i = 2 ; i <= MAXN ; i ++ ) {\n\t\tif( !vis[ i ] ) {\n\t\t\tprime[ ++ k ] = i;\n\t\t\tmu[ i ] = -1;\n\t\t}\n\t\tfor( int j = 1 ; j <= k && i * prime[ j ] <= MAXN ; j ++ ) {\n\t\t\tvis[ i * prime[ j ] ] = 1;\n\t\t\tif( i % prime[ j ] == 0 ) break;\n\t\t\tmu[ i * prime[ j ] ] = -mu[ i ];\n\t\t}\n\t}\n    for( int i = 1 ; i <= MAXN ; i ++ )\n        for( int j = i ; j <= MAXN ; j += i )\n            f[ j ] += i * mu[ i ];\n}\n\nint main( ) {\n\tsieve( );\n\tscanf(\"%d\",&n);\n\tfor( int i = 1 , x ; i <= n ; i ++ )\n\t\tscanf(\"%d\",&x) , cnt[ x ] ++ , m = max( m , x );\n\tn = m;\n\n    for( int i = 1 ; i <= n ; i ++ ) {\n        long long tmp = 0;\n        for( int j = 1 ; j <= n / i ; j ++ )\n            tmp += 1ll * cnt[ i * j ] * j;\n        Ans += i * f[ i ] * tmp * tmp;\n    }\n    printf(\"%lld\", Ans );\n\treturn 0;\n}\n```\n",
        "postTime": 1582375651,
        "uid": 123802,
        "name": "chihik",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3911 \u3010\u6700\u5c0f\u516c\u500d\u6570\u4e4b\u548c\u3011"
    },
    {
        "content": "\u7136\u800c\u672c\u849f\u84bb\u5e76\u4e0d\u4f1adp\u83ab\u53cd\u5c31\u53ea\u80fd\u83bd\u4e86QAQ\u2026\u2026\n\u6bcf\u6b21\u52a0\u8fdb\u65b0\u6570\u5b57\u65f6\u7edf\u8ba1\u8be5\u6570\u5b57\u4e0e\u524d\u9762\u6240\u6709\u6570\u7684lcm,\n\u53c8\u56e0\u4e3alcm(a,b)=a*b/gcd(a,b),\n\u5e76\u4e14gcd\u662f\u65b0\u52a0\u6570\u5b57\u7684\u56e0\u6570,\n\u6240\u4ee5\u6211\u4eec\u679a\u4e3e\u56e0\u6570\u4f5c\u4e3agcd,\n\u518d\u7edf\u8ba1\u5df2\u52a0\u5165\u6570\u5b57\u4e0e\u65b0\u6570gcd\u7b49\u4e8e\u8be5\u56e0\u6570\u7684\u6570\u7684\u548c,\n\u7528\u548c\u4e58\u4ee5\u65b0\u6570\u5b57\u9664\u4ee5\u8be5\u56e0\u6570\u6765\u7edf\u8ba1lcm\u3002\n\u56e0\u6570\u53ef\u4ee5\u679a\u4e3e(\u8981\u5148\u5904\u740650000\u5185\u6bcf\u4e2a\u6570\u7684\u6700\u5c0f\u8d28\u56e0\u6570)\uff0c\n\u7528\u5bb9\u65a5\u539f\u7406\u6c42\u548c\u3002\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define N 50000\n#define Re register\ninline ll readln() \n{\n    char cc=getchar();\n    ll f=1,num=0;\n    while (cc<'0'||cc>'9') {if(cc=='-') f=-1; cc = getchar();}\n    while (cc>='0'&&cc<='9') num=(num<<1)+(num<<3)+(cc^48),cc=getchar();\n    return num*f;\n}\nint Min[N*2],ys[N*2],gs[N*2],vis[N*2],num,n,tot; ll tot_ans,anser,f[N*2],sum;\ninline void ready()//\u53ef\u4ee5\u6253\u7ebf\u6027\u7b5b\uff0c\u4f46\u6839\u53f7\u6548\u7387\u53ef\u8fc7 \n{\n\tfor (Re int i=2;i<=N;i++)\n\t{\n\t\tint k=sqrt(i);\n\t\tfor (int j=2;j<=k;j++) if (i%j==0) {Min[i]=j; break;}\n\t\tif (!Min[i]) Min[i]=i;\n\t}\n}\ninline void pre(ll x)//\u8d28\u56e0\u6570\u62c6\u5206 gs=\u4e2a\u6570\uff0cys=\u56e0\u6570 \u5bf9\u5e94 \n{\n\tll tmp=x; tot=0;\n\twhile (tmp>1)\n\t{\n\t\tys[++tot]=Min[tmp]; gs[tot]=0;\n\t\twhile (tmp>1&&tmp%ys[tot]==0) \n\t\t\ttmp/=ys[tot],gs[tot]++;\n\t}\n}\ninline ll ask(ll x,int fh,int plc)//\u5bb9\u65a5\u539f\u7406\u6c42\u548c \n{\n\tll ans=1ll*fh*f[x];\n\tfor (Re int i=plc;i<=tot;i++)\n\t\tif (gs[i]&&!vis[i]) vis[i]=1,ans+=ask(x*ys[i],fh*(-1),i),vis[i]=0;//\u6ce8\u610f\u5bb9\u65a5\u65f6\u5355\u4e2a\u56e0\u6570\u53ea\u7528\u4e00\u6b21 \n\treturn ans;\n}\ninline ll done(ll x,int plc,ll aim) //\u679a\u4e3e\u56e0\u6570x \n{\n\tll ans=ask(x,1,1)*aim/x;//\u6c42gcd\u7b49\u4e8ex\u7684\u6570\u7684\u548c \n\tfor (Re int i=plc;i<=tot;i++)\n\t\tif (gs[i]) gs[i]--,ans+=done(x*ys[i],i,aim),gs[i]++;\n\treturn ans;\n}\ninline void add(ll x,int plc,ll aim)\n{\n\tf[x]+=aim;\n\tfor (Re int i=plc;i<=tot;i++)\n\t\tif (gs[i]) gs[i]--,add(x*ys[i],i,aim),gs[i]++;\n}\nint main()\n{\n\tscanf(\"%d\",&n); ready();\n\tfor (Re int i=1;i<=n;i++)\n\t{\n\t\tll a=readln(); pre(a); sum+=a;\n\t\tanser+=done(1,1,a); add(1,1,a);\n\t}\n\tprintf(\"%lld\\n\",anser*2+sum); //\u56e0\u4e3a\u4ee5\u4e0a\u6c42\u5f97\u6bcf\u4e2a\u6570\u4e0e\u524d\u6570\u5b57lcm\u8fd8\u8981*2+sum \n}\n```\n",
        "postTime": 1572153980,
        "uid": 113084,
        "name": "\u6e5b\u5362",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3911 \u3010\u6700\u5c0f\u516c\u500d\u6570\u4e4b\u548c\u3011"
    },
    {
        "content": "\u8bbe $cnt_i$ \u4e3a $i$ \u7684\u51fa\u73b0\u6b21\u6570\u3002\n\n\u5219\u8fd9\u9898\u8981\u6c42\u7684\u662f $\\sum_{i=1}^{N} \\sum_{j=1}^{N} lcm(i, j) \\times cnt_i \\times cnt_j$\n\n$\\left( lcm (i,j) = \\frac{ij}{\\gcd(i,j)}\\right)$\n\n$\\sum_{i=1}^{N} \\sum_{j=1}^{N} \\frac{ij}{\\gcd(i,j)} \\times cnt_i \\times cnt_j$\n\n\n\u679a\u4e3e $\\gcd$\u3002\n\n$\\sum_{d=1}^{N} \\sum_{i=1}^{N/d} \\sum_{j=1}^{N/d} [\\gcd(i,j) =1]d\\times ij\\times cnt_{id} \\times cnt_{jd}$\n\n$\\sum_{k|n} \\mu_k = [n==1]$\n\n$\\sum_{d=1}^{N} \\sum_{i=1}^{N/d} \\sum_{j=1}^{N/d} \\sum_{k|\\gcd(i,j)}\\mu_k \\times d\\times ij\\times cnt_{id} \\times cnt_{jd}$\n\n\u679a\u4e3e $k$\u3002\n\n$\\sum_{d=1}^{N} \\sum_{k=1}^{N/d}\\sum_{i=1}^{n/kd}\\sum_{j=1}^{n/kd}\\mu_k \\times d \\times k^2 \\times i \\times j \\times cnt_{idk} \\times cnt_{jdk}$\n\n$T = dk$\u3002\n\n$\\sum_{T=1}^{N} T \\times \\left(\\sum_{i=1}^{N/T} i \\times cnt_{iT}\\right)^2 \\sum_{k|T} \\mu_k \\times k$\n\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\u3002",
        "postTime": 1597198643,
        "uid": 96580,
        "name": "SXNhdW5veWE",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3911 \u3010\u6700\u5c0f\u516c\u500d\u6570\u4e4b\u548c\u3011"
    },
    {
        "content": "\u7ed9\u5b9a\u957f\u5ea6\u4e3a $N$ \u7684\u5e8f\u5217 $A$\uff0c\u6c42\uff1a\n\n$$\\sum_{i=1}^N\\sum_{j=1}^N\\operatorname {lcm}(A_i,A_j)$$\n\n\u5229\u7528\u5c0f\u5b66\u77e5\u8bc6\u53ef\u4ee5\u5316\u6210\uff1a\n\n$$\\sum_{i=1}^N\\sum_{j=1}^N\\frac{A_i\\times A_j}{\\gcd(A_i,A_j)}$$\n\n\u8003\u8651\u5230 $A_i\\le5\\times 10^4$\u3002\n\n\u5f00\u4e00\u4e2a\u6876 $a$\uff0c$a_i=\\sum_{j=1}^N[A_j=i]$\u3002\n\n\u8bbe $n$ \u4e3a $\\max_{A_i},i\\in[1,N]$\u3002\n\n\u539f\u5f0f\u5b50\u5c31\u53ef\u4ee5\u5316\u6210\uff1a\n\n$$\\sum_{i=1}^n\\sum_{j=1}^n a_i\\times a_j\\times \\frac{i\\times j}{\\gcd(i,j)}$$\n\n$$=\\sum_{d=1}^n d\\times \\sum_{i=1}^{\\left\\lfloor \\frac{n}{d} \\right\\rfloor}\\sum_{j=1}^{\\left\\lfloor \\frac{n}{d} \\right\\rfloor} a_{i\\times d}\\times a_{j\\times d}\\times i\\times j\\times [\\gcd(i,j)=1]$$\n\n$$=\\sum_{d=1}^n d\\times \\sum_{i=1}^{\\left\\lfloor \\frac{n}{d} \\right\\rfloor}\\sum_{j=1}^{\\left\\lfloor \\frac{n}{d} \\right\\rfloor} a_{i\\times d}\\times a_{j\\times d}\\times i\\times j\\times \\sum_{p|\\gcd(i,j)}\\mu(p)$$\n\n$$=\\sum_{d=1}^n d\\times \\sum_{p=1}^{\\left\\lfloor \\frac{n}{d} \\right\\rfloor}\\mu(p)\\times p^2 \\times \\sum_{i=1}^{\\left\\lfloor \\frac{n}{dp} \\right\\rfloor} \\sum_{j=1}^{\\left\\lfloor \\frac{n}{dp} \\right\\rfloor}a_{i\\times d\\times p}\\times a_{j\\times d\\times p}\\times i\\times j$$\n\n\u5728\u53bb\u6389 $a_{i\\times d\\times p}\\times a_{j\\times d\\times p}$ \u7684\u65f6\u5019\uff0c $\\sum_{i=1}^{\\left\\lfloor \\frac{n}{dp} \\right\\rfloor} \\sum_{j=1}^{\\left\\lfloor \\frac{n}{dp} \\right\\rfloor}i\\times j$ \u662f\u53ef\u4ee5 $\\operatorname O(1)$ \u8fd0\u7b97\u51fa\u6765\u7684\uff0c\u53ef\u4ee5\u5b9e\u73b0 $\\operatorname O(n\\sqrt n)$\uff0c\u5373 $d$ \u8fd9\u4e00\u5c42\u76f4\u63a5\u679a\u4e3e\uff0c\u7136\u540e $p$ \u8fd9\u4e00\u5c42\u7528\u6574\u9664\u5206\u5757\u4f18\u5316\u3002\n\n\u90a3\u4e48\u8fd9\u4e2a $a$ \u8be5\u600e\u4e48\u8003\u8651\u5462\uff1f\n\n\u63d0\u53d6 $d\\times p$\uff0c\u5316\u4e3a\uff1a\n\n$$\\sum_{T=1}^nT\\times \\sum_{p|T}\\mu(p)\\times p\\times \\sum_{i=1}^{\\left\\lfloor \\frac{n}{T} \\right\\rfloor} \\sum_{j=1}^{\\left\\lfloor \\frac{n}{T} \\right\\rfloor}a_{i\\times T}\\times a_{j\\times T}\\times i\\times j$$\n\n\u8bbe \n\n$$s_i=i\\times \\sum_{p|i}\\mu(p)\\times p$$\n\n\u8fd9\u4e2a $s$ \u662f\u53ef\u4ee5\u9884\u5904\u7406\u7684\u4e1c\u897f\u3002\n\n\u539f\u5f0f\u53ef\u5316\u4e3a\uff1a\n\n$$\\sum_{T=1}^ns_T\\times \\sum_{i=1}^{\\left\\lfloor \\frac{n}{T} \\right\\rfloor} \\sum_{j=1}^{\\left\\lfloor \\frac{n}{T} \\right\\rfloor}a_{i\\times T}\\times a_{j\\times T}\\times i\\times j$$\n\n\u628a $i$ \u63d0\u5230\u81ea\u5df1\u90a3\u4e00\u5c42\uff1a\n\n$$\\sum_{T=1}^n s_T\\times \\sum_{i=1}^{\\left\\lfloor \\frac{n}{T} \\right\\rfloor}a_{i\\times T}\\times i\\times \\sum_{j=1}^{\\left\\lfloor \\frac{n}{T} \\right\\rfloor}a_{j\\times T}\\times j$$\n\n\u8fd9\u91cc\u540e\u9762\u4e24\u4e2a $\\sum$ \u4e4b\u95f4\u5e76\u6ca1\u6709\u8054\u7cfb\uff0c\u5b9e\u9645\u4e0a\u53ef\u4ee5\u770b\u6210\uff1a\n\n$$\\sum_{T=1}^n s_T\\times (\\sum_{i=1}^{\\left\\lfloor \\frac{n}{T} \\right\\rfloor}a_{i\\times T}\\times i)\\times (\\sum_{j=1}^{\\left\\lfloor \\frac{n}{T} \\right\\rfloor}a_{j\\times T}\\times j)$$\n\n\u540e\u9762\u4e24\u9879\u662f\u76f8\u540c\u7684\uff0c\u6240\u4ee5\u63d0\u53d6\u516c\u56e0\u5f0f\uff0c\u5f97\u5230\uff1a\n\n$$\\sum_{T=1}^n s_T\\times (\\sum_{i=1}^{\\left\\lfloor \\frac{n}{T} \\right\\rfloor}a_{i\\times T}\\times i)^2$$\n\n\u60ca\u559c\u7684\u53d1\u73b0\u540e\u9762\u8fd9\u4e2a\u4e5f\u662f\u53ef\u4ee5\u9884\u5904\u7406\u7684\uff0c\u4e24\u4e2a\u9884\u5904\u7406\u4e4b\u540e\u5c31\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e $T$ \u6c42\u7b54\u6848\u4e86\u3002\n\n\u867d\u7136\u770b\u7740\u540e\u9762\u8fd9\u4e2a\u4e1c\u897f\u5f88\u50cf\u6574\u9664\u5206\u5757\u7684\u5f0f\u5b50\uff0c\u4f46\u56e0\u4e3a\u5185\u90e8\u6709\u4e00\u4e2a $a_{i\\times T}$\uff0c\u8fd9\u4e2a\u4e1c\u897f\u4e0b\u6807\u4e2d\u542b\u6709 $T$\uff0c\u6240\u4ee5\u5e76\u4e0d\u80fd\u6574\u9664\u5206\u5757\u3002\n\n\u5b9e\u9645\u4e0a\u4ece\u53e6\u4e00\u4e2a\u89d2\u5ea6\u7406\u89e3\uff0c\u5c31\u8ddf $\\left\\lfloor \\frac{n}{T} \\right\\rfloor$ \u8fd9\u4e00\u9879\u6ca1\u6709\u5173\u7cfb\u4e86\u3002\u5177\u4f53\u7684\u64cd\u4f5c\uff0c\u8bbe\u51fd\u6570 $g$\uff0c\u6ee1\u8db3\uff1a\n\n$$g_T=(\\sum_{i=1}^{\\left\\lfloor \\frac{n}{T} \\right\\rfloor}a_{i\\times T}\\times i)^2$$\n\n$g_T$ \u662f**\u6240\u6709\u6ee1\u8db3\u662f**  $T$ **\u7684\u500d\u6570**\u7684\u6570\u80fd\u5bf9\u5b83\u4ea7\u751f\u8d21\u732e\u3002\n\n\u672c\u8eab\u8fd9\u4e2a\u590d\u6742\u5ea6\u4e5f\u662f\u80fd\u591f\u63a5\u53d7\u7684\u8303\u56f4\uff0c\u4e5f\u4e0d\u9700\u8981\u53bb\u6574\u9664\u5206\u5757\u4f18\u5316\u3002\n\n~~\u867d\u7136\u6211\u7b97\u4e0d\u6765\u8fd9\u4e2a\u7406\u8bba\u590d\u6742\u5ea6~~\n\n```cpp\n#include <bits/stdc++.h>\n#define LL long long\n#define max(a,b) a>b?a:b\nusing namespace std;\nconst int MAN=5e4;\nbool bj[MAN+3];\nint mu[MAN+3];\nint d[MAN+3];\nLL a[MAN+3];\nLL s[MAN+3];\nLL g[MAN+3];\nint tail;\nint n,N;\nLL rin()\n{\n    LL s=0;\n    char c=getchar();\n    bool bj=false;\n    for(;(c>'9'||c<'0')&&c!='-';c=getchar());\n    if(c=='-')c=getchar(),bj=true;\n    for(;c>='0'&&c<='9';c=getchar())s=(s<<1)+(s<<3)+(c^'0');\n    if(bj)return -s;\n    return s;\n}\nint main()\n{\n    N=rin();\n    int x;\n    for(int i=1;i<=N;i++)\n    {\n        x=rin();\n        a[x]++;\n        n=max(n,x);\n    }\n    \n    //\u7b2c\u4e8c\u4e2a\u4e1c\u897f\u7684\u9884\u5904\u7406\n    for(int i=1;i<=n;i++)\n    {\n        for(int j=1;true;j++)\n        {\n            int now=i*j;\n            if(now>n)break;\n            g[i]+=a[now]*j;\n        }\n        g[i]=g[i]*g[i];\n    }\n    \n    mu[1]=1;\n    tail=0;\n    for(int i=2;i<=n;i++)\n    {\n        if(!bj[i])mu[i]=-1,d[++tail]=i;\n        for(int j=1;j<=tail;j++)\n        {\n            int now=i*d[j];\n            if(now>n)break;\n            bj[now]=true;\n            if(i%d[j]==0)break;\n            mu[now]=-mu[i];\n        }\n    }\n    //s\u7684\u9884\u5904\u7406\n    for(int i=1;i<=n;i++)\n    for(int j=1;true;j++)\n    {\n        int now=i*j;\n        if(now>n)break;\n        s[now]+=mu[i]*i;\n    }\n    LL ans=0;\n    for(int i=1;i<=n;i++)ans+=s[i]*g[i]*i;\n    printf(\"%lld\",ans);\n    return 0;\n}\n```\n",
        "postTime": 1598965594,
        "uid": 73551,
        "name": "zjjws",
        "ccfLevel": 7,
        "title": "P3911 \u6700\u5c0f\u516c\u500d\u6570\u4e4b\u548c"
    },
    {
        "content": "\u53c8\u662f\u6211\u6700\u559c\u6b22\u7684\u6570\u8bba\u9898\uff01\uff01\n\n\n\u53d1\u73b0100%\u7684\u6570\u636e\u4e2dA\u572850000\u4e4b\u5185\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7528a[i]\u6765\u8bb0\u5f55A==i\u7684\u6570A\u6709\u591a\u5c11\u4e2a\u3002\n\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u63a8\u5f0f\u5b50\u4e86\uff08\u6211\u7684\u65b9\u6cd5\u6709\u70b9\u9b3c\u755c\uff0c\u63a5\u4e0b\u6765\u5199\u4e00\u4e0b\u6211\u521a\u521a\u60f3\u8d77\u7684\u4e00\u4e2a\u7b80\u5355\u7684\u65b9\u6cd5\u3002\uff09\n\n\n\u9996\u5148\u6211\u4eec\u8bbeh[i]\u4e3a\u662fi\u500d\u6570\u7684A\u7684\u4e24\u4e24\u4e4b\u79ef\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u628a\u662fi\u7684\u500d\u6570\u7684A\u5148\u52a0\u5230h[i]\u4e2d\u6700\u540e\u8ba9h[i]\\*=h[i]\u5c31\u597d\u4e86\u3002\n\n\u7136\u540e\u518d\u8bbeg[i]\u4e3agcd==i\u7684\u4e24\u4e24\u6570\u4e4b\u79ef\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u5f97\uff1a\n\n\n     h[i]=\u2211g[j]    (i|j)\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u53cd\u6f14\u5f97\uff1a\n\n\n   g[i]=\u2211\u03bc[j/i]\\*h[j]  (i|j)\n\n\u6211\u4eec\u53cd\u6f14\u5f97\u5230g\u4e4b\u548c\uff0c\u6700\u540e\u7684\u7b54\u6848\u5c31\u662f\u2211g[i]/i  (1<=i<=N),N\u662f\u6240\u6709A\u4e2d\u6700\u5927\u7684\u4e00\u4e2a\u3002\n\n(\u6211\u4e00\u5f00\u59cb\u7684\u65b9\u5f0f\u662f\u7528\u6240\u6709\u4e24\u6570\u4e4b\u79ef\u518d\u51cf\u53bbgcd\u4e0d\u4e3a1\u7684\u3002\u3002\u3002\u3002\u5176\u5b9e\u539f\u7406\u90fd\u4e00\u6837)\n\n\n    \n    \n    \n\n    \n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\n#define maxn 50005\nll us[maxn],zs[maxn],t;\nbool v[maxn];\nll h[maxn],g[maxn],a[maxn],x,n,N,tot=0;\ninline void read(ll&x){\n    x=0; char ch=getchar();\n    while(!isdigit(ch)) ch=getchar();\n    for(;isdigit(ch);ch=getchar())  x=x*10+ch-'0';\n}\ninline void init(){\n    us[1]=1;\n    for(int i=2;i<=maxn;i++){\n        if(!v[i]) zs[++t]=i,us[i]=-1;\n        for(int j=1,u;j<=t&&(u=zs[j]*i)<=maxn;j++){\n            v[u]=1;\n            if(!(i%zs[j])) break;\n            us[u]=-us[i];\n        }\n    }\n}\nint main(){\n    init();\n    read(n);\n    for(int i=1;i<=n;i++) read(x),a[x]++,N=max(N,x),tot+=x;\n    tot*=tot;\n    for(int i=1;i<=N;i++){\n      for(int j=i;j<=N;j+=i) if(a[j]) h[i]+=j*a[j];\n      h[i]*=h[i];\n    }\n    for(int i=1;i<=N;i++){\n        for(int j=i;j<=N;j+=i) g[i]+=us[j/i]*h[j];\n        tot-=g[i]-g[i]/i;\n    }\n    cout<<tot<<endl;\n    return 0;\n}\n```",
        "postTime": 1503544884,
        "uid": 31377,
        "name": "\u91d1\u7237\u7237\u54c8\u54c8",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3911 \u3010\u6700\u5c0f\u516c\u500d\u6570\u4e4b\u548c\u3011"
    },
    {
        "content": "### \u63d0\u4f9b\u4e00\u79cd\u4e0d\u9700\u8981\u6c42\u83ab\u6bd4\u4e4c\u65af**\u51fd\u6570**\u7684\u7b97\u6cd5\u3002\n\n----\n\n\u9996\u5148 $A_i,A_j$ \u7684\u6700\u5c0f\u516c\u500d\u6570\u53ef\u4ee5\u5316\u4e3a $\\frac{A_i \\cdot A_j}{\\gcd(A_i,A_j)}$\u3002\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u8f83\u5e38\u89c1\u7684\u63a8\u5bfc\u8fc7\u7a0b\uff0c**\u4ee5\u4e0b\u8fc7\u7a0b\u6574\u4e2a\u5e8f\u5217 $A$ \u6700\u5927\u503c\u8bb0\u4e3a $N$**\u3002\n\n\u6211\u4eec\u53d1\u73b0 $A_i,A_j$ \u7684\u6700\u5927\u516c\u7ea6\u6570\u4f1a\u968f\u7740 $A_i,A_j$ \u7684\u53d8\u5316\u800c\u53d8\u5316\uff0c\u4e0d\u597d\u6c42\u51fa\u3002\n\n\u6240\u4ee5\u53ef\u4ee5**\u63d0\u524d\u679a\u4e3e**\u6700\u5927\u516c\u7ea6\u6570 $d$\uff0c\u5728\u4e24\u4e24\u679a\u4e3e\u7684\u65f6\u5019\u53ea\u627e $\\gcd(A_i,A_j)=d$ \u7684\u6570\u5bf9\u5e76\u8fdb\u884c\u8ba1\u7b97\uff0c\u5f0f\u5b50\u5199\u4f5c\n\n$$\\sum_{d=1}^N\\sum_{i=1}^n\\sum_{j=1}^n[\\gcd(A_i,A_j)=d]\\frac{A_i \\cdot A_j}{d}$$\n\n\u7136\u540e $\\frac{1}{d}$ \u53ef\u4ee5\u63d0\u5230\u524d\u9762\u53bb\u3002\n\n\u4f46\u662f $A_i$ \u662f\u8f93\u5165\u5f97\u5230\u7684\uff0c\u56e0\u6b64 $[\\gcd(A_i,A_j)=d]$ \u8fd9\u4e2a\u6761\u4ef6\u4e0d\u597d\u4f7f\u7528\uff0c\u6240\u4ee5\u9700\u8981\u6362\u4e00\u79cd\u65b9\u5f0f\u8bb0\u5f55\u3002\n\n\u6211\u4eec\u4ee4\u6570\u5b57 $i$ \u5728\u539f\u5e8f\u5217\u7684\u51fa\u73b0\u6b21\u6570\u4e3a $s_i$\uff0c\u90a3\u4e48\u6240\u6c42\u4e3a\n\n$$\\sum_{d=1}^N\\frac{1}{d}\\sum_{i=1}^N\\sum_{j=1}^N[\\gcd(i,j)=d]\\cdot s_i \\cdot s_j \\cdot i \\cdot j$$\n\n\u8fd9\u4e00\u6b65\u63a8\u5bfc\u4f7f\u5f97 $i,j$ \u53d8\u6210\u679a\u4e3e\u503c\u57df\uff0c\u56e0\u4e3a\u76f8\u540c\u7684\u6570\u5bf9\u663e\u7136\u6700\u5927\u516c\u7ea6\u6570\u4e00\u6837\uff0c\u6240\u4ee5\u4e00\u8d77\u5904\u7406\u4e0d\u4f1a\u6709\u6240\u5f71\u54cd\u3002\n\n\u7136\u540e\u53d1\u73b0\u5f0f\u5b50\u91cc\u7684 $s_i$ \u90fd\u4f34\u968f $i$ \u51fa\u73b0\uff0c\u56e0\u6b64\u53ef\u4ee5\u4ee4 $c_i=s_i \\cdot i$\uff0c\u5f0f\u5b50\u5199\u6210\n\n$$\\sum_{d=1}^N\\frac{1}{d}\\sum_{i=1}^N\\sum_{j=1}^N[\\gcd(i,j)=d]\\cdot c_i \\cdot c_j$$\n\n---------\n\n\u628a\u5f0f\u5b50\u7684\u540e\u534a\u90e8\u5206\u5355\u72ec\u62ff\u51fa\u6765\u770b\uff0c\u4ee4\n\n$$f(d)=\\sum_{i=1}^N\\sum_{j=1}^N[\\gcd(i,j)=d]\\cdot c_i \\cdot c_j$$\n\n\u90a3\u4e48\u6240\u6c42\u5c31\u53d8\u6210 $\\sum\\limits_{d=1}^Nf(d)$ \u4e86\u3002\n\n\u73b0\u5728\u6700\u96be\u5904\u7406\u7684\uff0c\u65e0\u975e\u662f $\\gcd(i,j)=d$ \u8fd9\u4e2a\u6761\u4ef6\u3002\n\n\u4f46\u662f\u6211\u4eec\u5148\u964d\u4f4e\u70b9\u96be\u5ea6\u3002**\u5982\u679c\u6761\u4ef6\u53d8\u6210 $d \\mid \\gcd(i,j)$\uff0c\u7b54\u6848\u600e\u4e48\u6c42\uff1f**\n\n\u663e\u7136\uff0c\u82e5 $\\gcd(i,j)$ \u4e3a $d$ \u7684\u500d\u6570\uff0c\u90a3\u4e48 $i,j$ \u90fd\u8981\u662f $d$ \u7684\u500d\u6570\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5728\u679a\u4e3e $i,j$ \u7684\u65f6\u5019\u5c31\u5f3a\u5236\u5b83\u53ea\u80fd\u53d6 $d$ \u7684\u500d\u6570\uff0c$d \\mid \\gcd(i,j)$ \u7684\u6761\u4ef6\u5c31\u80fd\u6d88\u9664\u4e86\u3002\n\n\u7136\u540e\u518d\u8fd4\u56de\u6765\uff0c\u5982\u4f55\u6c42 $\\gcd(i,j)=d$ \u6761\u4ef6\u7684\u60c5\u51b5\uff1f\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c $d \\mid \\gcd(i,j)$\uff0c\u90a3\u4e48 $i,j$ \u53ef\u4ee5\u53d6\u5230 $d,2d,3d,...$\n\n\u76f8\u5f53\u4e8e $d \\mid \\gcd(i,j)$ \u662f\u6240\u6709\u6ee1\u8db3 $\\gcd(i,j)=kd$\uff08$k$ \u53d6\u4efb\u610f\u6b63\u6574\u6570\uff09\u6761\u4ef6\u7684 $i,j$ \u7684\u7b54\u6848\u3002\n\n\u4e3a\u4e86\u63cf\u8ff0\u65b9\u4fbf\uff0c\u6211\u4eec\u8bbe\n\n$$g(d)=\\sum_{i=1}^N\\sum_{j=1}^N[d \\mid \\gcd(i,j)]\\cdot c_i \\cdot c_j$$\n\n\u90a3\u4e48\u6709 $g(d)=\\sum\\limits_{k \\mid x}f(x)$\uff0c\u5373 $g(d)=\n\\sum\\limits_{k=1}^{\\lfloor\\frac{N}{d}\\rfloor}f(kd)$\u3002\n\n\u5230\u8fd9\u91cc\u5f88\u591a\u4eba\u5c31\u76f4\u63a5\u4e0a**\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14**\u4e86\uff0c\u5176\u5b9e\u6709\u66f4\u7b80\u5355\u7684\u529e\u6cd5\u3002\n\n\u5c06\u53f3\u5f0f\u62c6\u6210 $g(d)=\nf(d)+\\sum\\limits_{k=2}^{\\lfloor\\frac{N}{d}\\rfloor}f(kd)$\u3002\n\n\u79fb\u9879\u4e00\u4e0b\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\n\n$$f(d)=g(d)-\\sum_{k=2}^{\\lfloor\\frac{N}{d}\\rfloor}f(kd)$$\n\n---------------\n\n\u7531\u4e8e\u5bf9\u4e8e\u6bcf\u4e2a $d$\uff0c\u9664\u4e86 $g$ \u51fd\u6570\u6211\u4eec\u53ea\u9700\u8981\u8ba1\u7b97 $\\lfloor\\frac{N}{d}\\rfloor$ \u6b21\u5c31\u53ef\u4ee5\u6c42\u51fa $f(d)$\u3002\n\n\u800c $\\sum\\limits_{k=1}^N\\lfloor\\frac{N}{k}\\rfloor$ \u7684\u89c4\u6a21\u662f\u5728 $\\mathcal{O}(N \\ln N)$ \u7ea7\u522b\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u5c3d\u53ef\u80fd\u5728\u4f18\u79c0\u7684\u65f6\u95f4\u590d\u6742\u5ea6**\u6c42\u51fa\u6240\u6709 $g$ \u51fd\u6570**\uff0c\u95ee\u9898\u5c31\u89e3\u51b3\u4e86\u3002\n\n\u6839\u636e\u4e0a\u6587\u5f97\u5230\u7684\u7ed3\u679c\uff1a\n\n$$g(d)=\\sum_{i=1}^N\\sum_{j=1}^N[d \\mid \\gcd(i,j)]\\cdot c_i \\cdot c_j$$\n\n\u6211\u4eec\u5c06\u51fd\u6570 $g(d)$ \u91cd\u65b0\u5199\u6210\u539f\u6765\u4ee5 $A_i,A_j$ \u8868\u793a\u7684\u5f62\u5f0f\u3002\u89c2\u5bdf\u4e00\u4e0b\uff1a\n\n$$g(d)=\\sum_{j=1}^n \\sum_{j=1}^n[d \\mid \\gcd(A_i,A_j)] \\cdot A_i \\cdot A_j$$\n\n\u540c\u6837\u7684\uff0c\u6839\u636e\u4e0a\u6587\uff0c\u5982\u679c\u679a\u4e3e\u7684 $A_i,A_j$ \u90fd\u662f $d$ \u7684\u500d\u6570\uff0c\u90a3\u4e48\u6761\u4ef6\u5c31\u53ef\u4ee5\u6d88\u9664\u3002\n\n\u7136\u540e\u4f60\u5c31\u53ef\u4ee5\u53d1\u73b0 $g(d)$ \u5c31\u662f\u5e8f\u5217 $A$ \u4e2d\u4efb\u610f\u4e24\u4e2a\u4e3a $d$ \u500d\u6570\u7684\u6570\uff0c\u5176**\u4e24\u4e24\u4e58\u79ef\u4e4b\u548c**\u3002\n\n\u56e0\u6b64\uff0c\u53ef\u4ee5\u6839\u636e\u6bcf\u4e2a\u4e0d\u540c\u7684 $d$\uff0c**\u9884\u5904\u7406**\u5e8f\u5217 $A$ \u4e2d\u6240\u6709 $d$ \u7684\u500d\u6570\u4e4b\u548c $S_d$\uff0c\u5c31\u6709 $g(d)=S_d^2$\u3002 \n\n\u81f3\u4e8e\u5e8f\u5217 $A$ \u4e2d\u6240\u6709 $d$ \u7684\u500d\u6570\u4e4b\u548c\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u679a\u4e3e $d$\uff0c\u518d\u679a\u4e3e $d$ \u7684\u500d\u6570 $k$\uff0c\u7d2f\u52a0\u6240\u6709 $k$ \u7684\u7b54\u6848\u3002\u8fd9\u6837\u7b97\u65f6\u95f4\u590d\u6742\u5ea6\u540c\u6837\u662f $\\mathcal{O}(N \\ln N)$ \u7684\u3002\n\n-------\n\n\u6700\u7ec8\u5e26\u56de\u539f\u5f0f\n\n$$\\sum_{d=1}^N\\frac{1}{d} \\cdot \\left(g(d)-\\sum_{k=2}^{\\lfloor\\frac{N}{d}\\rfloor}f(kd)\\right)$$\n\n\u5148\u9884\u5904\u7406 $g$ \u51fd\u6570\uff0c\u518d**\u5012\u5e8f\u679a\u4e3e** $d$\uff0c\u56e0\u4e3a\u4f60\u9700\u8981\u8c03\u7528 $f(kd)$\u3002\n\n\u4e4b\u540e\u7b97\u4e00\u4e0b\u4e0a\u9762\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u8fd9\u9898\u5c31\u505a\u5b8c\u4e86\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(N \\ln N)$\u3002\n\n\u8d34\u4e0a\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define INF 1e9\n#define eps 1e-6\n#define N 50000\ntypedef long long ll;\nusing namespace std;\n\nint n;\nll s[100010], f[100010], d[100010], ans;\n// d[i] \u8bb0\u5f55\u5e8f\u5217 A \u4e2d i \u7684\u500d\u6570\u4e4b\u548c\uff0cs[i] \u8bb0\u5f55\u5e8f\u5217 A \u4e2d\u7b49\u4e8e i \u7684\u6570\u4e4b\u548c\n\nint main(){\n\n\tscanf(\"%d\", &n);\n\tfor(int i = 1, a; i <= n; i++)\n\t\tscanf(\"%d\", &a), s[a]++;\n\tfor(int i = 1; i <= N; i++)\n\t\ts[i] *= i;\n\tfor(int i = 1; i <= N; i++)\n\t\tfor(int j = i; j <= N; j += i)\n\t\t\td[i] += s[j];\n\tfor(int i = N; i >= 1; i--){\n\t\tf[i] = d[i] * d[i];\n\t\tfor(int j = i + i; j <= N; j += i)\n\t\t\tf[i] -= f[j];\n\t\tans += f[i] / i;\n\t}\n\tprintf(\"%lld\\n\", ans);\n\n\treturn 0;\n}\n```",
        "postTime": 1628426080,
        "uid": 87573,
        "name": "HoshizoraZ",
        "ccfLevel": 7,
        "title": "P3911 \u6700\u5c0f\u516c\u500d\u6570\u4e4b\u548c \u9898\u89e3"
    },
    {
        "content": "## \u9898\u76ee\u5927\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u5217 $A_i$ \uff0c\u6c42\n\n$Ans=\\sum_{i=1}^n \\sum_{j=1}^n lcm(A_i,A_j)$\n\n\u7684\u503c\u3002\n\n$1\\le n,A_i\\le 50000$\n\n## \u89e3\u9898\u601d\u8def\n\n\u89c2\u5bdf\u5230 $A_i$ \u7684\u503c\u7279\u522b\u5c0f\u3002\u5b9a\u4e49 $a_i=\\sum_{j=1}^n [a_j=i],m=\\max\\{a_i\\}$ \uff0c$a_i$ \u4e3a $i$ \u5728 $A$ \u4e2d\u51fa\u73b0\u7684\u6b21\u6570\uff0c $m$ \u4e3a\u4e00\u4e2a\u503c\u6700\u591a\u51fa\u73b0\u7684\u6b21\u6570\u3002\n\n$Ans=\\sum_{i=1}^m \\sum_{j=1}^m a_ia_j\\times lcm(i,j)$\n\n\u679a\u4e3e $gcd$ \u7684\u503c\uff0c\u7531 $gcd(a,b)\\times lcm(a,b)=a\\times b$ \uff0c\u5f97\n\n$Ans=\\sum_{d=1}^m \\sum_{i=1}^m \\sum_{j=1}^m \\frac {ija_ia_j}{d} [gcd(i,j)=d]$\n\n\u63d0\u51fa\u516c\u7ea6\u6570\uff0c\u5f97\n\n$Ans=\\sum_{d=1}^m \\frac 1 d\\sum_{i=1}^m\\sum_{j=1}^m ija_ia_j[gcd(i,j)=d]$\n\n\u8003\u8651\u6c42\u540e\u9762\u4e00\u90e8\u5206\u7684\u5f0f\u5b50\uff0c\u4ee4\n\n$f(x)=\\sum_{i=1}^m\\sum_{j=1}^m ija_ia_j[gcd(i,j)=x]$\n\n\u6784\u9020 $F(x)=\\sum_{x|d} f(d)$ \uff0c\u53d1\u73b0\n\n$F(x)=\\sum_{i=1}^m\\sum_{j=1}^m ija_ia_j[x|gcd(i,j)]$\n\n$=\\sum_{x|i}\\sum_{x|j}ija_ia_j$\n\n$=\\sum_{x|i}ia_i\\times \\sum_{x|j} ja_j$\n\n$=(\\sum_{x|i}ia_i)^2$\n\n$F(x)$ \u53ef\u4ee5\u5728 $O(n\\ln n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u9884\u5904\u7406\u3002\n\n\u7531\u53cd\u6f14\u5f97\uff0c\n\n$f(d)=\\sum_{x=1}^{\\lfloor \\frac m d\\rfloor} \\mu(x)F(dx)$\n\n\u5e26\u5165 $Ans$ \uff0c\n\n$Ans=\\sum_{d=1}^m \\frac 1 d f(d)$\n\n$=\\sum_{d=1}^m \\frac 1 d \\sum_{g=1}^{\\lfloor \\frac m d\\rfloor} \\mu(g)F(gd)$\n\n\u5728\u9884\u5904\u7406\u51fa $F$ \u540e\uff0c\u6211\u4eec\u540c\u6837\u53ef\u4ee5\u5728 $O(n\\ln n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u6c42\u89e3\u8fd9\u4e00\u5f0f\u5b50\u3002\n\n\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\ln n)$ \u3002\n\n## \u4ee3\u7801\u5c55\u793a\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define int long long\nusing namespace std;\nconst int maxn=50010;\nint n,A[maxn],m,a[maxn],f[maxn],ans,tot;\nint cur,pri[maxn],mu[maxn];\nbool tf[maxn];\nmain()\n{\n    scanf(\"%lld\",&n);\n    for(int i=1;i<=n;i++)scanf(\"%lld\",A+i),a[A[i]]++,m=50000;\n    for(int i=1;i<=m;i++)for(int j=i;j<=m;j+=i)f[i]+=a[j]*j;\n    for(int i=1;i<=m;i++)f[i]=f[i]*f[i];\n    mu[1]=1;\n    for(int i=2;i<=m;i++)\n    {\n        if(!tf[i]){pri[++cur]=i;mu[i]=-1;}\n        for(int j=1;j<=cur&&pri[j]<=m/i;j++)\n        {\n            tf[i*pri[j]]=true;\n            if(i%pri[j]==0){mu[i*pri[j]]=0;break;}\n            else mu[i*pri[j]]=-mu[i];\n        }\n    }\n    for(int d=1;d<=m;d++)\n    {\n        tot=0;\n        for(int g=1;g<=m/d;g++)tot+=mu[g]*f[g*d];\n        ans+=tot/d;\n    }\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1552640169,
        "uid": 43486,
        "name": "hsfzLZH1",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3911 \u3010\u6700\u5c0f\u516c\u500d\u6570\u4e4b\u548c\u3011"
    },
    {
        "content": "## \u9898\u610f\n~~\u5e94\u8be5\u6ca1\u4eba\u4e0d\u8bc6\u5b57~~\n## \u601d\u8def\n\u5148\u8003\u8651\u628a\u89e3\u51b3\u5982\u4f55\u628a\u6570\u5217\u53bb\u6389\uff0c\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u6570 $x$ \u51fa\u73b0 $k$ \u6b21\uff0c\u5c31\u4f1a\u5bf9\u7b54\u6848\u4ea7\u751f $k$ \u6b21\u8d21\u732e\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u9898\u76ee\u7684\u5f0f\u5b50\u5316\u6210\u5e38\u89c1\u7684\u5f0f\u5b50 $\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\textit{lcm}(i,j)$ \u56e0\u4e3a\u4e00\u4e2a\u6570\u51fa\u73b0 $k$ \u6b21\u5c31\u4f1a\u5bf9\u7b54\u6848\u4ea7\u751f $k$ \u6b21\u8d21\u732e\uff0c\u6240\u4ee5\u6211\u4eec\u8bb0\u5f55\u6bcf\u4e2a\u6570\u51fa\u73b0\u7684\u6b21\u6570 $num_i$ \uff0c\u518d\u5728\u5f0f\u5b50\u91cc\u5c06\u5176\u52a0\u4e0a\u5f97\u5230\n\n$\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\textit{lcm}(i,j)\\cdot num_i\\cdot num_j$ \n\n\u56e0\u4e3a $A_i$ \u7684\u6700\u5927\u503c\u53ea\u6709 $5 \\cdot 10^4$ \u6240\u4ee5\u8bb0\u5f55\u4e0b\u6765\u662f\u53ef\u884c\u7684\n\n## \u5f00\u59cb\u6109\u5feb\u7684\u5316\u7b80\n\n\u6839\u636e~~\u591a\u5e74\u7684~~\u505a\u9898\u7ecf\u9a8c\uff0c$\\textit{gcd}$ \u4e00\u822c\u90fd\u6bd4 $\\textit{lcm}$ \u597d\u5316\u7b80\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u5c06 $\\textit{lcm}$ \u5316\u6389\uff0c $\\textit{lcm}(i,j)=\\frac{ij}{\\textit{gcd}(i,j)}$ ,\u4e8e\u662f\u5f0f\u5b50\u53d8\u6210\u4e86 \n\n$\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\frac{ij}{\\textit{gcd}(i,j)}\\cdot num_i\\cdot num_j$ \n\n\u8003\u8651\u5c06 $\\textit{gcd}$ \u5316\u6389\uff0c\u6211\u4eec\u8bbe\u5b83\u4e3a $d$ \uff0c\u5219\u5f0f\u5b50\u53d8\u6210 \n\n$\\sum_{i=1}^{n}\\sum_{j=1}^{n}\\frac{ij}{d}\\cdot num_i\\cdot num_j $\n\n$=\\sum_{d=1}^{n} \\frac{1}{d} \\sum_{i=1}^{n/d}\\sum_{j=1}^{n/d}[\\textit{gcd}(i,j)=1]id\\cdot jd\\cdot num_{id}\\cdot num_{jd} $\n\n$=\\sum_{d=1}^{n} d \\sum_{i=1}^{n/d}\\sum_{j=1}^{n/d}[\\textit{gcd}(i,j)=1]ij\\cdot num_{id}\\cdot num_{jd}$\n\n\u63a5\u4e0b\u6765\u8003\u8651\u5316\u6389 $[\\textit{gcd}(i,j)=1]$ \uff0c\u6211\u4eec\u8bbe\u4e00\u4e2a\u51fd\u6570 $f$ \uff0c\u4f7f\u5f97\n\n$f(x)=\\left\\{\\begin{matrix}1 &x=1 \\\\ 0 & x!=1 \\end{matrix}\\right.$\n\n\u518d\u8bbe\u4e00\u4e2a\u51fd\u6570\u4f7f\u5f97 $f=g\\ast 1$ \u6839\u636e\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u6211\u4eec\u5f97\u77e5 $g(n)=\\sum_{d|n}\\mu (d)f(\\frac{n}{d})$ \u56e0\u4e3a\u53ea\u6709 $n=1$ \u7684\u65f6\u5019 $f(n)$ \u624d\u7b49\u4e8e $1$ \uff0c\u6240\u4ee5 $g(n)=\\mu (n)$ \u6240\u4ee5 $f(n)=\\sum_{d|n}\\mu (d)$ \u4e8e\u662f\u6211\u4eec\u5c06\u539f\u5f0f\u5316\u4e3a\n\n$\\sum_{d=1}^{n} d \\sum_{i=1}^{n/d}\\sum_{j=1}^{n/d}\\sum_{k|i,k|j}\\mu (k)ij\\cdot num_{id}\\cdot num_{jd}$\n\n$=\\sum_{d=1}^{n} d \\sum_{k=1}^{n/d}\\mu(k) k^2\\sum_{i=1}^{n/kd}\\sum_{j=1}^{n/kd}ij\\cdot num_{ikd}\\cdot num_{jkd}$\n\n$=\\sum_{d=1}^{n} d \\sum_{k=1}^{n/d}\\mu(k) k^2 (\\sum_{i=1}^{n/kd}i\\cdot num_{ikd})^2$\n\n\n\u8003\u8651\u5c06 $k,d$ \u5316\u4e3a\u4e00\u4e2a\u6570\uff0c\u4e8e\u662f\u6211\u4eec\u8bbe $T=kd$ \u56e0\u4e3a $k\\leq n/d$ \u6240\u4ee5 $kd\\leq n$ \u4e8e\u662f\u5c06\u539f\u5f0f\u5316\u4e3a\n\n$\\sum_{T=1}^{n}\\sum_{d|T} d\\cdot \\mu(\\frac{T}{d})\\cdot  (\\frac{T}{d})^2 \\cdot (\\sum_{i=1}^{n/T}i\\cdot num_{iT})^2$ \n\n$=\\sum_{T=1}^{n}\\sum_{d|T} T\\cdot \\mu(\\frac{T}{d})\\cdot  (\\frac{T}{d}) \\cdot (\\sum_{i=1}^{n/T}i\\cdot num_{iT})^2$ \n\n$=\\sum_{T=1}^{n}T\\sum_{d|T} \\cdot \\mu(\\frac{T}{d})\\cdot  (\\frac{T}{d}) \\cdot (\\sum_{i=1}^{n/T}i\\cdot num_{iT})^2$ \n\n\n\u6211\u4eec\u628a\u679a\u4e3e\u7684\u5bf9\u8c61\u4ece $d$ \u53d8\u6210 $x=\\frac{T}{d}$ \u5219\u539f\u5f0f\u53d8\u6210\n\n $\\sum_{T=1}^{n}T \\cdot (\\sum_{x|T} \\cdot \\mu(x)\\cdot  x) \\cdot (\\sum_{i=1}^{n/T}i\\cdot num_{iT})^2$\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u9884\u5904\u7406\u51fa $\\sum_{x|T} \\cdot \\mu(x)\\cdot  x$ \u4e4b\u540e\u66b4\u529b\u6c42\u89e3 $(\\sum_{i=1}^{n/T}i\\cdot num_{iT})^2$ \u5f97\u51fa\u7b54\u6848\n\n## Code\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<vector>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\n\n#define pb push_back\n\ntypedef long long  LL;\n\nconst int N = 1000010;\n\nLL n;\nLL mu[N], mu_sum[N], num[N];\nvector<LL> prime;\nbool st[N];\n\ninline void init()\n{\n\tmu[1] = 1;\n\tfor (int i = 2; i <= n; i++)\n\t{\n\t\tif (!st[i]) st[i] = true, prime.pb(i), mu[i] = -1;\n\t\tfor (int j = 0; j < prime.size() && i * prime[j] <= n; j++)\n\t\t{\n\t\t\tst[i * prime[j]] = true;\n\t\t\tif (i % prime[j] == 0)\n\t\t\t{\n\t\t\t\tmu[i * prime[j]] = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmu[i * prime[j]] = -mu[i];\n\t\t}\n\t}\n\n\tfor (int i = 1; i <= n; i++)\n\t{\n\t\tfor (int j = i; j <= n; j += i)\n\t\t{\n\t\t\tmu_sum[j] += mu[i] * i;\n\t\t}\n\t}\n}\n\nint main()\n{\n\tscanf(\"%lld\", &n);\n\n\tLL mx = 0;\n\tfor (int i = 1; i <= n; i++)\n\t{\n\t\tLL x;\n\t\tscanf(\"%lld\", &x);\n\t\tnum[x]++;\n\t\tmx = max(mx, x);\n\t}\n\tn = mx;\n\n\tinit();\n\n\tLL ans = 0;\n\tfor (int T = 1; T <= n; T++)\n\t{\n\t\tLL res = 0;\n\t\tfor (int i = 1; i <= n / T; i++)\n\t\t{\n\t\t\tres += i * num[i * T];\n\t\t}\n\t\tans += T * res * res * mu_sum[T];\n\t}\n\tprintf(\"%lld\", ans);\n}\n```\nEND",
        "postTime": 1630418315,
        "uid": 99908,
        "name": "ArrogHie",
        "ccfLevel": 8,
        "title": "\u9898\u89e3P3911 \u3010\u6700\u5c0f\u516c\u500d\u6570\u4e4b\u548c\u3011"
    },
    {
        "content": "[CSDN\u540c\u6b65](https://blog.csdn.net/bifanwen/article/details/105935861)\n\n[\u535a\u5ba2\u56ed\u540c\u6b65](https://www.cnblogs.com/bifanwen/p/12831569.html)\n\n[\u6d1b\u8c37\u535a\u5ba2\u540c\u6b65](https://www.luogu.com.cn/blog/bfw/solution-p3911)\n\n[\u539f\u9898\u94fe\u63a5](https://www.luogu.com.cn/problem/P3911)\n\n\u524d\u7f6e\u77e5\u8bc6\uff1a\n\n[\u672c\u9898\u7684\u5f31\u5316\u7248](https://www.luogu.com.cn/problem/P3911)\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u539f\u6765\u7684\uff1a\n\n$$\\sum_{i=1}^n \\sum_{j=1}^n \\operatorname{lcm}(i,j)$$\n\n\u53d8\u6210\u4e86\uff1a\n\n$$\\sum_{i=1}^n \\sum_{j=1}^n \\operatorname{lcm}(a_i , a_j)$$\n\n\u4e00\u8a00\u4e0d\u5408\u5c31\u5f00\u59cb\u63a8\u5f0f\u5b50\u3002\n\n\u8003\u8651\u7528 $c_i$ \u8868\u793a $i$ \u51fa\u73b0\u7684\u6b21\u6570\uff0c\u7136\u540e\uff1a\n\n$$\\begin{aligned}\n& \\sum_{i=1}^n \\sum_{j=1}^n \\operatorname{lcm}(a_i , a_j) \\\\\n=& \\sum_{i=1}^n\\sum_{j=1}^n \\operatorname{lcm}(i,j)\\times c_i \\times c_j\\\\\n=& \\sum_{i=1}^n\\sum_{j=1}^n \\frac{i \\times j\\times c_i \\times c_j}{\\gcd(i,j)} \\\\ \n=& \\sum_{d=1}^n\\sum_{i=1}^{\\lfloor  \\frac{n}{d} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{n}{d}\\rfloor}[\\gcd(i,j)=1]d\\times i \\times j \\times c_{id} \\times c_{jd} \\\\\n=& \\sum_{d=1}^n\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{n}{d}\\rfloor}\\sum_{k|\\gcd(i,j)}\\mu(k) \\times d\\times i \\times j \\times c_{id} \\times c_{jd} \\\\\n=& \\sum_{d=1}^n\\sum_{k=1}^{\\lfloor \\frac{n}{d} \\rfloor}\\sum_{i=1}^{\\lfloor \\frac{n}{kd} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{n}{kd}\\rfloor}\\mu(k)\\times d \\times i \\times j \\times k^2 \\times c_{idk} \\times c_{jdk} \\\\\n=& \\sum_{T=1}^{n}T\\times(\\sum_{i=1}^{\\lfloor \\frac{n}{T} \\rfloor}i\\times c_{iT})^2\\sum_{k|T}\\mu(k)\\times k\n\\end{aligned}\n$$\n\n\u5bf9\u4e8e\u540e\u9762\u7684\uff1a\n\n$$\\sum_{k|T} \\mu_k \\times k$$\n\n\u53ef\u4ee5\u7528 $O(n \\ln n)$ \u7684\u65f6\u95f4\u5b8c\u6210\u9884\u5904\u7406\u3002\n\n$$n \\ln n =\\sum_{i=1}^n \\lfloor \\frac{n}{i} \\rfloor$$\n\n\u7136\u540e\uff0c\u5bf9\u4e2d\u95f4\u90a3\u5757\u66b4\u529b\u8ba1\u7b97\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(n \\ln n)$.\n\n\u5b9e\u9645\u5f97\u5206\uff1a$100pts$.\n\n```cpp\n#pragma GCC optimize(2)\n#include<bits/stdc++.h>\nusing namespace std;\n\nconst int N=5e4+1;\ntypedef long long ll;\n\ninline int read(){char ch=getchar(); int f=1; while(ch<'0' || ch>'9') {if(ch=='-') f=-f; ch=getchar();}\n\tint x=0; while(ch>='0' && ch<='9') x=(x<<3)+(x<<1)+ch-'0',ch=getchar(); return x*f;}\n\ninline void write(ll x) {\n\tif(x<0) {putchar('-');write(-x);return;}\n\tif(x<10) {putchar(char(x%10+'0'));return;}\n\twrite(x/10);putchar(char(x%10+'0'));\n}\n\nint n,c[N],mu[N],prime[N];\nint cnt=0; bool h[N];\nll s[N],ans=0;\n\ninline void Euler(int n) {\n\tmu[1]=1; for(register int i=2;i<=n;i++) {\n\t\tif(!h[i]) mu[i]=-1,prime[++cnt]=i;\n\t\tfor(register int j=1;j<=cnt && i*prime[j]<=n;j++) {\n\t\t\th[i*prime[j]]=1;\n\t\t\tif(i%prime[j]==0) {mu[i*prime[j]]=0;break;}\n\t\t\tmu[i*prime[j]]-=mu[i];\n\t\t}\n\t} \n} \n\nint main() {\n\tn=read(); int maxi=0;\n\tfor(register int i=1,t;i<=n;i++) {t=read(); c[t]++; maxi=max(maxi,t);}\n\tEuler(maxi); for(register int i=1;i<=maxi;i++)\n\tfor(register int j=i;j<=maxi;j+=i) s[j]+=1ll*mu[i]*i; //\u9884\u5904\u7406\n\tfor(register int T=1;T<=maxi;T++) {\n\t\tll sum=0;\n\t\tfor(register int i=1;i<=maxi/T;i++) sum+=1ll*c[i*T]*i;\n\t\tans+=T*sum*sum*s[T]; //\u66b4\u529b\u8ba1\u7b97\n\t} write(ans);\n\treturn 0;\n}\n\n\n```",
        "postTime": 1588671664,
        "uid": 181276,
        "name": "bifanwen",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3911 \u3010\u6700\u5c0f\u516c\u500d\u6570\u4e4b\u548c\u3011"
    },
    {
        "content": "[P3911 \u6700\u5c0f\u516c\u500d\u6570\u4e4b\u548c](https://www.luogu.com.cn/problem/P3911)\n\n$$\\begin{aligned}\n\\sum_{i=1}^{n} \\sum_{j=1}^{n} lcm(A_i, A_j)&=\\sum_{i=1}^n \\sum_{j=1}^n lcm(i, j)\\cdot cnt_i\\cdot cnt_j \\\\\n&=\\sum_{i=1}^n  \\sum_{j=1}^n\\frac{i\\cdot j}{gcd(i,j)}\\cdot cnt_i \\cdot cnt_j\\\\\n&=\\sum_{d=1}^n \\sum_{i=1}^n \\sum_{j=1}^n[gcd(i, j)==d]\\frac{i\\cdot j}{d}\\cdot cnt_i \\cdot cnt_j \\\\\n&=\\sum_{d=1}^n \\sum_{i=1}^{\\lfloor \\frac{n}{d}\\rfloor} \\sum_{j=1}^{\\lfloor \\frac{n}{d}\\rfloor}[gcd(i, j)==1]\\frac{id\\cdot jd}{d}\\cdot cnt_{id} \\cdot cnt_{jd}\\\\\n&=\\sum_{d=1}^n \\sum_{i=1}^{\\lfloor \\frac{n}{d}\\rfloor} \\sum_{j=1}^{\\lfloor \\frac{n}{d}\\rfloor}[gcd(i, j)==1] i\\cdot j\\cdot d\\cdot cnt_{id} \\cdot cnt_{jd}\\\\\n\n&=\\sum_{d=1}^n \\sum_{i=1}^{\\lfloor \\frac{n}{d}\\rfloor} \\sum_{j=1}^{\\lfloor \\frac{n}{d}\\rfloor}\\sum_{s|gcd(i, j)}\\mu(s)\\cdot i\\cdot j\\cdot d\\cdot cnt_{id} \\cdot cnt_{jd}\\\\\n&=\\sum_{d=1}^n d\\sum_{i=1}^{\\lfloor \\frac{n}{d}\\rfloor} \\sum_{j=1}^{\\lfloor \\frac{n}{d}\\rfloor}\\sum_{s|gcd(i, j)}\\mu(s)\\cdot i\\cdot j\\cdot cnt_{id} \\cdot cnt_{jd}\\\\\n&=\\sum_{d=1}^nd\\sum_{s=1}^{\\lfloor \\frac{n}{d}\\rfloor}\\mu(s)\\sum_{i=1}^{\\lfloor \\frac{n}{ds} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{n}{ds} \\rfloor}s^2\\cdot i\\cdot j\\cdot cnt_{ids}\\cdot cnt_{jds}\\\\\n\n&=\\sum_{d=1}^nd\\sum_{s=1}^{\\lfloor \\frac{n}{d}\\rfloor}\\mu(s)s^2(\\sum_{i=1}^{\\lfloor \\frac{n}{ds} \\rfloor}i\\cdot cnt_{ids})^2\\\\\n\n&=\\sum_{ds=1}^n ds \\sum_{s|ds}\\mu(s)\\cdot s\\cdot (\\sum_{i=1}^{\\lfloor \\frac{n}{ds} \\rfloor}i\\cdot cnt_{ids})^2\n\\end{aligned}\n$$\n\n\u4ee4$T=ds$,\u5219\u6709\n$$\\begin{aligned}\n\\sum_{i=1}^{n} \\sum_{j=1}^{n} lcm(A_i, A_j)&=\\sum_{T=1}^{n}T\\sum_{s|T}(\\mu(s)\\cdot s)\\cdot (\\sum_{i=1}^{\\lfloor \\frac{n}{T} \\rfloor}i\\cdot cnt_{iT})^2\n\\end{aligned}\n$$\n\n\u4e2d\u95f4\u62ec\u53f7\u53ef\u4ee5\u7206\u7b97\uff0c\u540e\u9762\u62ec\u53f7\u4e5f\u53ef\u4ee5\u7206\u7b97\uff0c\u5177\u4f53\u505a\u6cd5\u662f\u679a\u4e3e\u500d\u6570\u5237\u8868\uff0c\u590d\u6742\u5ea6\u4e3a\u8c03\u548c\u7ea7\u6570\uff0c\u4e0a\u754c$O(n\\log n)$.\n\n\u8bb0\u5f97\u5f00$long \\ long$\n```cpp\nconst ll N=5e4+4;\n\nll prime[N], tot, mu[N];\nbool book[N];\n\ninline void euler_solve(ll lim){\n\tmu[1]=1;\n\tfor (R ll i=2; i<=lim; i++){\n\t\tif (!book[i]) prime[++tot]=i, mu[i]=-1;\n\t\tfor (R ll j=1; j<=tot && 1ll*prime[j]*i<=lim; j++){\n\t\t\tbook[i*prime[j]]=true;\n\t\t\tif (i%prime[j]==0){\n\t\t\t\tmu[i*prime[j]]=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmu[i*prime[j]]=-mu[i];\n\t\t}\n\t}\n} \n\nll n, cnt[N];\n\nll sum1[N], sum2[N];\nll res;\nint main(){\n\tread(n);\n\tfor (R ll i=1, x; i<=n; i++){\n\t\tread(x); ++cnt[x];\n\t}\n\teuler_solve(50000);\n\tfor (R ll i=1; i<=50000; i++)\n\t\tfor (R ll j=i; j<=50000; j+=i)\n\t\t\tsum1[j]+=mu[i]*i;\n\tfor (R ll i=1; i<=50000; i++){\n\t\tfor (R ll j=1; j<=50000/i; j++) sum2[i]+=j*cnt[j*i];\n\t}\n\tfor (R ll i=1; i<=50000; i++) res+=i*sum2[i]*sum2[i]*sum1[i];\n\twriteln(res);\n}\n\n```\n",
        "postTime": 1606138158,
        "uid": 220285,
        "name": "Saber_Master",
        "ccfLevel": 7,
        "title": "P3911 \u6700\u5c0f\u516c\u500d\u6570\u4e4b\u548c"
    },
    {
        "content": "\u5f15\u7406\uff1a$ \\sum_{i|n} \\mu(i) =[n=1] $\n\n\u8bc1 ~~\uff08\u4e0d\u77e5\u9053\u8fd9\u4e2a\u7ed3\u8bba\u7684\u662f\u4e0d\u662f\u70b9\u9519\u9898\u6216\u8005\u968f\u673a\u8df3\u9898\u7684\u2026\u2026\uff09~~\n\n\u5f53$ n=1 $\u65f6\u663e\u7136\u6210\u7acb\n\n\u5426\u5219\u8bbe$ n=p_1^{x_1}*p_2^{x_2}*p_3^{x_3}*......*p_k^{x_k},n'=p_1*p_2*p_3*......*p_k,k>=1 $\n\n\u5219\u6709$ \\sum_{i|n}\\mu(i)=\\sum_{i|n'}\\mu(i)=(1+(-1))^k=0 $\n\n\u6240\u4ee5\u5f15\u7406\u6210\u7acb\n\n~~\u8bf4\u4e86\u4e00\u5927\u5806\u5e9f\u8bdd\u73b0\u5728~~\u8fdb\u5165\u6b63\u9898\n# P3911 \u9898\u89e3\n\n\u4ee4$ a_x $\u8868\u793a$ x $\u5728$ A_x $\u4e2d\u51fa\u73b0\u7684\u6b21\u6570\uff0c$ T $\u4e3a$ A_x $\u4e2d\u51fa\u73b0\u7684\u6700\u5927\u7684\u6b63\u6574\u6570\n\n\u5219\u6709$ \\sum_{i=1}^n \\sum_{j=1}^n lcm(i,j)=\\sum_{i=1}^T \\sum_{j=1}^T lcm(i,j)*a_i*a_j $\n\n\u90a3\u600e\u4e48\u6c42$ \\sum_{i=1}^T \\sum_{j=1}^T lcm(i,j)*a_i*a_j $\u5462\uff1f\u9996\u5148\uff0c\u56e0\u4e3a$ lcm(i,j)=\\frac{i*j}{gcd(i,j)} $\n\n\u6240\u4ee5\u539f\u5f0f\u53ef\u4ee5\u5199\u6210$\\sum_{i=1}^T \\sum_{j=1}^T \\frac{i*j*a_i*a_j}{gcd(i,j)} $\n\n\u6362\u4e00\u4e0b\u987a\u5e8f\uff0c\u5148\u679a\u4e3e$ gcd(i,j) $\n\n$\\sum_{i=1}^T \\sum_{j=1}^T \\frac{i*j*a_i*a_j}{gcd(i,j)} $\n$ =\\sum_{d=1}^T\\sum_{i=1}^{\\lfloor T/d \\rfloor}\\sum_{j=1}^{\\lfloor T/d \\rfloor} [gcd(i,j)=1]*d*i*j*a_{id}*a_{jd}$\n\n\u6839\u636e\u5f15\u7406\n\n$\\sum_{d=1}^T\\sum_{i=1}^{\\lfloor T/d \\rfloor}\\sum_{j=1}^{\\lfloor T/d \\rfloor} [gcd(i,j)=1]*d*i*j*a_{id}*a_{jd}$\n$ =\\sum_{d=1}^T\\sum_{i=1}^{\\lfloor T/d \\rfloor}\\sum_{j=1}^{\\lfloor T/d \\rfloor} \\sum_{k|gcd(i,j)} \\mu(k)*d*i*j*a_{id}*a_{jd} $\n\n\u518d\u628a$ k $\u5f80\u524d\u653e\n\n$\\sum_{d=1}^T\\sum_{i=1}^{\\lfloor T/d \\rfloor}\\sum_{j=1}^{\\lfloor T/d \\rfloor} \\sum_{k|gcd(i,j)} \\mu(k)*d*i*j*a_{id}*a_{jd}$\n$=\\sum_{d=1}^T\\sum_{k=1}^{\\lfloor T/d \\rfloor}\\sum_{i=1}^{\\lfloor T/kd \\rfloor}\\sum_{j=1}^{\\lfloor T/kd \\rfloor}\\mu(k)*d*i*j*k^2*a_{idk}*a_{jdk}$\n\n~~\uff08\u600e\u4e48\u8d8a\u53d8\u8d8a\u590d\u6742\u4e86\u554aQAQ\uff09~~\n\n\u6700\u540e\u4e00\u6b65\uff0c\u5c06\u524d\u4e24\u4e2a$ \\sum $\u5408\u5e76\u8d77\u6765\uff0c\u5e76\u5408\u5e76$i,j$\n\n$\\sum_{d=1}^T\\sum_{k=1}^{\\lfloor T/d \\rfloor}\\sum_{i=1}^{\\lfloor T/kd \\rfloor}\\sum_{j=1}^{\\lfloor T/kd \\rfloor}\\mu(k)*d*i*j*k^2*a_{idk}*a_{jdk}$\n$=\\sum_{d=1}^T(\\sum_{i=1}^{\\lfloor T/d \\rfloor}i*a_{id})^2\\sum_{k|n}\\mu(k)*k$\n\n$ \\sum_{k|n}\\mu(k)*k $\u53ef\u4ee5\u7528$ O(T*\\sum_{i=1}^T\\frac1{i}) $\u7684\u65f6\u95f4(\u7ea6\u4e3a$ O(n logn) $)\u7b5b\n\n\u6240\u4ee5\u8fd9\u9898\u5c31\u7ed3\u675f\u4e86 ~~\uff08\u8fd9\u4e2a\u5f0f\u5b50\u7adf\u7136\u662f\u66b4\u529b\u6c42\u7684\uff09~~\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,a[50010],prime[50010],check[50010],miu[50010],tot,maxx;\nlong long sum[50010];\nvoid init(){\n    miu[1]=1;\n    for(int i=2;i<=50000;i++){\n        if(!check[i]){\n            prime[tot++]=i;\n            miu[i]=-1;\n        }\n        for(int j=0;j<tot&&i*prime[j]<=50000;j++){\n            check[i*prime[j]]=1;\n            if(i%prime[j]==0){\n                miu[i*prime[j]]=0;\n                break;\n            }\n            miu[i*prime[j]]=-miu[i];\n        }\n    }\n    for(int i=1;i<=50000;i++){\n        for(int j=i;j<=50000;j+=i) sum[j]+=1ll*i*miu[i];\n    }\n}\nlong long work(){\n    long long ans=0;\n    for(int i=1;i<=maxx;i++){\n        long long temp=0;\n        for(int j=1;j<=maxx/i;j++){\n            temp+=1ll*a[i*j]*j;\n        }\n        ans+=1ll*temp*temp*sum[i]*i;\n    }\n    return ans;\n}\nint main(){\n    init();\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;i++){\n    \tint temp;\n        scanf(\"%d\",&temp);\n        a[temp]++;\n        maxx=max(maxx,temp);\n    }\n    long long ans=work();\n    printf(\"%lld\",ans);\n    return 0;\n}\n```\n",
        "postTime": 1605794295,
        "uid": 289230,
        "name": "ricky0916",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3911 \u3010\u6700\u5c0f\u516c\u500d\u6570\u4e4b\u548c\u3011"
    },
    {
        "content": "\u9898\u76ee\u94fe\u63a5:[P3911 \u6700\u5c0f\u516c\u500d\u6570\u4e4b\u548c](https://www.luogu.com.cn/problem/P3911)\n\n### \u9898\u76ee\u5927\u610f\n\n\u7b80\u6d01\u6613\u61c2,\u6211\u5c31\u4e0d\u8bf4\u4e86\n\n### solution\n\n\u6211\u4eec\u6765\u89c2\u5bdf\u8fd9\u4e2a\u5f0f\u5b50, $lcm$\u600e\u4e48\u64cd\u4f5c\u554a? \u90a3\u6211\u4eec\u5c31\u8f6c\u5316\u6210$gcd$\n\n$\\sum\\limits_{i = 1}^n\\sum\\limits_{j = 1}^n lcm(A_i, A_j) \\iff \\sum\\limits_{i = 1}^n\\sum\\limits_{j = 1}^n \\dfrac{A_iA_j}{gcd(A_i, A_j)}$\n\n\u90a3\u8fd8\u662f\u5f88\u96be\u5904\u7406\u554a, \u90a3\u6211\u4eec\u600e\u4e48\u529e\u5462, \u6211\u4eec\u662f\u4e0d\u662f\u53ef\u4ee5\u8f6c\u5316\u6210\u503c\u57df\u6765\u505a\u554a,\u8bb0\u5f55\u4e00\u4e0b\u6bcf\u4e2a\u6570\u7684\u4e2a\u6570.\n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u6837\u662f\u53ef\u884c\u7684, \u6bd5\u7adf $A_i \\in [1, 50000]$\n\n\u6211\u4eec\u8bbe $N$ \u4e3a\u503c\u57df\u7684\u6700\u5927\u503c, $C_i$ \u662f\u6bcf\u4e2a\u5143\u7d20\u7684\u4e2a\u6570, \u90a3\u6211\u4eec\u8981\u6c42\u7684\u5c31\u53d8\u6210\u4e86:\n\n$\\sum\\limits_{i = 1}^N\\sum\\limits_{j = 1}^N \\dfrac{i \\times j \\times C_i \\times C_j}{gcd(A_i, A_j)}$ \n\n\u8fd9\u4e0d\u5c31\u662f\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u677f\u5b50\u9898\u4e48, \u90a3\u6211\u4eec\u6765\u63a8\u4e00\u4e0b\u53cd\u6f14\u8fc7\u7a0b:\n\n\u679a\u4e3e\u516c\u7ea6\u6570:\n\n$\\sum\\limits_{d = 1}^N\\sum\\limits_{i = 1}^N\\sum\\limits_{j = 1}^N \\dfrac{ij}{d}[gcd(A_i, A_j) == d] \\times C_i \\times C_j$\n\n\u5c06\u540e\u4e24\u91cd\u5faa\u73af\u9664\u4ee5 $d$ , $i$ \u548c $j$ \u53d8\u6210 $id$ \u548c $jd$ :\n\n$\\sum\\limits_{d = 1}^N\\sum\\limits_{i = 1}^{\\left\\lfloor\\frac{N}{d}\\right\\rfloor}\\sum\\limits_{j = 1}^{\\left\\lfloor\\frac{N}{d}\\right\\rfloor} ijd[gcd(A_i, A_j) == 1] \\times C_{id} \\times C_{jd}$\n\n\u6211\u4eec\u4f1f\u5927\u7684\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u6765\u4e86:\n\n$\\sum\\limits_{d = 1}^N\\sum\\limits_{i = 1}^{\\left\\lfloor\\frac{N}{d}\\right\\rfloor}\\sum\\limits_{j = 1}^{\\left\\lfloor\\frac{N}{d}\\right\\rfloor}\\sum\\limits_{k|gcd(i, j)} \\mu(k)ijd \\times C_{id} \\times C_{jd}$\n\n\u6211\u4eec\u53d1\u73b0 $gcd(i,j) == 1$, \u5171\u6709 $\\left\\lfloor\\frac{N}{d}\\right\\rfloor$ \u4e2a, \u7136\u540e\u6539\u53d8\u4e00\u4e0b $k$ \u7684\u679a\u4e3e\u65b9\u5f0f:\n\n$\\sum\\limits_{d = 1}^N\\sum\\limits_{i = 1}^{\\left\\lfloor\\frac{N}{d}\\right\\rfloor}\\sum\\limits_{j = 1}^{\\left\\lfloor\\frac{N}{d}\\right\\rfloor}\\sum\\limits_{k}^{\\left\\lfloor\\frac{N}{d}\\right\\rfloor} \\mu(k)ijd\\times C_{id} \\times C_{jd}$\n\n\u4ea4\u6362\u4e00\u4e0b\u679a\u4e3e\u987a\u5e8f:\n\n$\\sum\\limits_{d = 1}^N\\sum\\limits_{k}^{\\left\\lfloor\\frac{N}{d}\\right\\rfloor}\\sum\\limits_{i = 1}^{\\left\\lfloor\\frac{N}{d}\\right\\rfloor}\\sum\\limits_{j = 1}^{\\left\\lfloor\\frac{N}{d}\\right\\rfloor} \\mu(k)ijd\\times C_{id} \\times C_{jd}$\n\n\u7136\u540e\u5c06\u6700\u540e\u4e24\u91cd\u5faa\u73af\u9664\u4ee5 $k$, $id, jd$ \u5c31\u53d8\u6210\u4e86 $idk, jdk$ :\n\n$\\sum\\limits_{d = 1}^N\\sum\\limits_{k}^{\\left\\lfloor\\frac{N}{d}\\right\\rfloor}\\sum\\limits_{i = 1}^{\\left\\lfloor\\frac{N}{dk}\\right\\rfloor}\\sum\\limits_{j = }^{\\left\\lfloor\\frac{N}{dk}\\right\\rfloor} \\mu(k)ijdk^2 \\times C_{idk} \\times C_{jdk}$\n\n\u6211\u4eec\u4ee4 $T = dk$ :\n\n$\\sum\\limits_{T = 1}^N\\sum\\limits_{k | T}\\sum\\limits_{i = 1}^{\\left\\lfloor\\frac{N}{T}\\right\\rfloor}\\sum\\limits_{j = 1}^{\\left\\lfloor\\frac{N}{T}\\right\\rfloor} \\mu(k)k T ij\\times C_{iT} \\times C_{jT}$\n\n\u7136\u540e\u4ea4\u6362\u4e00\u4e0b\u679a\u4e3e\u987a\u5e8f:\n\n$\\sum\\limits_{T = 1}^N T \\sum\\limits_{i = 1}^{\\left\\lfloor\\frac{N}{T}\\right\\rfloor}\\sum\\limits_{j = 1}^{\\left\\lfloor\\frac{N}{T}\\right\\rfloor} ij\\times C_{iT} \\times C_{jT}\\sum\\limits_{k | T}\\mu(k)k$\n\n\u628a $ij$ \u7684\u4e24\u7ef4\u5408\u5e76:\n\n$\\sum\\limits_{T = 1}^N T \\sum\\limits_{i = 1}^{\\left\\lfloor\\frac{N}{T}\\right\\rfloor} (i\\times C_{iT})^2\\sum\\limits_{k | T}\\mu(k)k$\n\n\u6700\u540e\u6211\u4eec\u9884\u5904\u7406\u51fa $\\mu(k)k$ \u5c31\u505a\u5b8c\u4e86.\n\n### Code:\n\n```cpp\n/**\n*    Author: Alieme\n*    Data: 2020.9.8\n*    Problem: P3911\n*    Time: O()\n*/\n#include <cstdio>\n#include <iostream>\n#include <string>\n#include <cstring>\n#include <cmath>\n#include <algorithm>\n\n#define int long long\n#define rr register\n\n#define inf 1e9\n#define MAXN 100010\n\nusing namespace std;\n\ninline int read() {\n\tint s = 0, f = 0;\n\tchar ch = getchar();\n\twhile (!isdigit(ch)) f |= ch == '-', ch = getchar();\n\twhile (isdigit(ch)) s = s * 10 + (ch ^ 48), ch = getchar();\n\treturn f ? -s : s;\n}\n\nvoid print(int x) {\n\tif (x < 0) putchar('-'), x = -x;\n\tif (x > 9) print(x / 10);\n\tputchar(x % 10 + 48);\n}\n\nint tot, n, ans;\n\nint c[MAXN], mu[MAXN], prime[MAXN], sum[MAXN];\n\nbool vis[MAXN];\n\ninline void init() {  // \u9884\u5904\u7406mu\u548c\u516c\u5f0f\n\tmu[1] = 1;\n\tfor (rr int i = 2; i <= 50000; i++) {   // \u7ebf\u6027\u7b5b\u9884\u5904\u7406mu\n\t\tif (!vis[i]) prime[++tot] = i, mu[i] = -1;\n\t\tfor (rr int j = 1; j <= tot; j++) {\n\t\t\tif (i * prime[j] > 50000) break;\n\t\t\tvis[i * prime[j]] = 1;\n\t\t\tmu[i * prime[j]] = -mu[i];\n\t\t\tif (i % prime[j] == 0) {\n\t\t\t\tmu[i * prime[j]] = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tfor (rr int i = 1; i <= 50000; i++)  // \u9884\u5904\u7406 mu(k)*k\n\t\tfor (rr int j = i; j <= 50000; j += i) \n\t\t\tsum[j] += mu[i] * i;\n}\n\nsigned main() {\n\tinit();\n\tn = read();\n\tfor (rr int i = 1; i <= n; i++) c[read()]++;\n\tfor (rr int i = 1; i <= 50000; i++) {          // \u66b4\u529b\u6c42\u89e3\n\t\tint s = 0;\t\n\t\tfor (rr int j = 1; j <= 50000 / i; j++) s += c[i * j] * j;\n\t\tans += i * s * s * sum[i];\n\t}\n\tprint(ans);\n}\n```",
        "postTime": 1599566852,
        "uid": 187253,
        "name": "Aliemo",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3911 \u3010\u6700\u5c0f\u516c\u500d\u6570\u4e4b\u548c\u3011"
    },
    {
        "content": "~~\u4fee\u590d\u4e86\u4e00\u4e9b\u5c0fbug\uff0c(\u3002\u30fb\uff3f\u30fb\u3002)\uff89I\u2019m sorry~~~\n\n\u7ed9\u51fa\u96c6\u5408 $A$\uff0c\u8bbe $n=\\mid A\\mid$\uff0c\u6c42 $\\sum_{i=1}^n\\sum_{j=1}^n\\text{lcm}(A_i,A_j)$\u3002\n\n\u6478\u5230\u8fd9\u9053\u9898\uff0c\u6211\u4eec\u9a6c\u4e0a\u5c31\u53ef\u4ee5\u53d1\u73b0 $A$ \u4e2d\u7684\u5143\u7d20\u662f\u65e0\u5e8f\u7684\uff0c\u9898\u76ee\u4e2d\u7ed9\u51fa\u7684\u5f0f\u5b50\u6ca1\u6cd5\u5316\u7b80\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u5f97\u4e0d\u8003\u8651\u8f6c\u5316\u5f0f\u5b50\u3002\n\n\u6570\u636e\u8303\u56f4 $1\\le A_i\\le5e4$\uff0c\u8fd9\u5c31\u5f88\u597d\u529e\u4e86\u2026\u2026\n\n\u5f00\u4e00\u4e2a\u6876\uff08\u8fd9\u91cc\u7528\u6570\u7ec4 $t$ \u8868\u793a\uff09\uff0c$t[i]$ \u8868\u793a\u6570 $i$ \u5728\u96c6\u5408\u4e2d\u51fa\u73b0\u7684\u6b21\u6570\u3002\n\n\u8fd9\u6837\u539f\u5f0f\u5c31\u8f6c\u5316\u4e3a\u4e86:\n$$\n\\sum_{i=1}^n\\sum_{j=1}^n\\text{lcm}(i,j)\\times t[i]\\times t[j]\n$$\n**\u6ce8\u610f\u6b64\u540e $n$ \u6307\u96c6\u5408 $A$ \u4e2d\u5143\u7d20\u7684\u6700\u5927\u503c\u3002**\n\n\u8fd9\u6837\u597d\u50cf\u5c31\u53ef\u4ee5\u8f6c\u5316 $\\text{gcd}$ \u6c42\u89e3\u4e86\u3002\n\n\uff08\u4e3a\u4e86\u6b64\u7bc7\u9898\u89e3\u66f4\u901a\u4fd7\u6613\u61c2\uff0c\u63a5\u4e0b\u6765\u7684\u63a8\u5bfc\u4f1a\u6709\u4e9b\u5197\u4f59\u90e8\u5206\uff0c\u89c1\u8c05~\uff09\n\n\u6109\u5feb\u7684\u63a8\u5f0f\u5b50\u65f6\u95f4~\uff1a\n$$\n\\large\n\\begin{aligned}\n&\\sum_{i=1}^n\\sum_{j=1}^n\\text{lcm}(i,j)\\times t[i]\\times t[j]\\\\\n\n&\\Rightarrow\\sum_{i=1}^n\\sum_{j=1}^n\\frac{i\\times j}{\\text{gcd}(i,j)}\\times t[i]\\times t[j]\\\\\n\n&\\Rightarrow\\sum_{d=1}^n\\sum_{i=1}^n\\sum_{j=1}^n\\frac{i\\times j}{[\\text{gcd}(i, j)=d]\\times d}\\times t[i]\\times t[j]\\\\\n\n&\\Rightarrow\\sum_{d=1}^n\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\frac{i d\\times jd}{[\\text{gcd}(i, j)=1]\\times d}\\times t[id]\\times t[jd]\\\\\n\n&\\Rightarrow\\sum_{d=1}^n\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}d\\times i\\times j\\times[\\text{gcd}(i, j)=1]\\times t[id]\\times t[jd]\\\\\n\n&\\Rightarrow\\sum_{d=1}^n\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}d\\times i\\times j\\times\\sum_{k\\mid i,k\\mid j}\\mu(k)\\times t[id]\\times t[jd]\\\\\n\n&\\Rightarrow\\sum_{d=1}^n\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{k\\mid i,k\\mid j}\\mu(k)\\times d\\times i\\times j\\times t[id]\\times t[jd]\\\\\n\n&\\Rightarrow\\sum_{d=1}^n\\sum_{k=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{i=1}^{\\lfloor\\frac{n}{kd}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{n}{kd}\\rfloor}\\mu(k)\\times d\\times ik\\times jk\\times t[ikd]\\times t[jkd]\\\\\n\n&\\Rightarrow\\sum_{s=1}^ns\\times\\sum_{k\\mid s}\\mu(k)\\times k\\ (\\sum_{i=1}^{\\lfloor\\frac{n}{s}\\rfloor}i\\times t[is])^2\n\\end{aligned}\n$$\n\u4e00\u4e9b\u89e3\u91ca\uff08\u5927\u4f6c\u53ef\u76f4\u63a5\u8df3\u8fc7\uff09\uff1a\n\n1. $s=kd$\u3002\n2. \u7ed3\u679c\u4e2d\u7684\u5e73\u65b9\u4e3a\u4e0a\u9762\u7684\u5f0f\u5b50\u4e2d\u7684 $i$ \u548c $j$\uff0c\u4ed6\u4fe9\u5176\u5b9e\u662f\u4e00\u6837\u7684\u3002\n\n\u6700\u540e\uff0c\u6211\u4eec\u4f7f\u7528\u7ebf\u6027\u7b5b\u9884\u5904\u7406 $\\sum_{k\\mid s}\\mu(k)\\times k$\uff0c\u8f93\u5165\u65f6\u76f4\u63a5\u5904\u7406 $t$\uff0c\u7136\u540e\u66b4\u529b\u5c31\u5b8c\u4e86\u3002\n\n\u4ee3\u7801\u6309\u7167\u4e0a\u9762\u7684\u66b4\u529b\u5373\u53ef\uff0c\u5c31\u4e0d\u7ed9\u4e86 QVQ\u3002",
        "postTime": 1630821820,
        "uid": 101620,
        "name": "aleph_blanc",
        "ccfLevel": 4,
        "title": "P3911"
    }
]
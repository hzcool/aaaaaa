[
    {
        "content": "## Solution\n\n\u9898\u76ee\u7684\u9650\u5236\u6709\u4e9b\u590d\u6742\uff0c\u5148\u505a\u4e00\u4e9b\u7b80\u5316\u3002\n\n\u9996\u5148\u67d3\u8272\u4e00\u5b9a\u4e0d\u4f1a\u6298\u53e0\u7684\u8fc7\u7a0b\u4e2d\u8fdb\u884c\uff0c\u56e0\u4e3a\u539a\u5ea6\u53ef\u4ee5\u53e0\u52a0\u7684\u9650\u5236\u6070\u597d\u4fdd\u8bc1\u4e86\u5728\u6298\u53e0\u8fc7\u7a0b\u4e2d\u67d3\u8272\u4e0d\u4f1a\u6bd4\u4e00\u5f00\u59cb\u67d3\u8272\u66f4\u4f18\uff0c\u5e76\u4e14\u4e5f\u6ca1\u6709\u5fc5\u8981\u628a\u540c\u4e00\u6839\u7ebf\u67d3\u8272\u591a\u6b21\u3002\n\n\u7531\u6b64\u53ef\u77e5\uff0c\u67d3\u8272\u4e4b\u540e\u7684\u7ef3\u5b50\u81f3\u591a\u53ea\u6709\u4e24\u79cd\u989c\u8272\u3002\n\n\u4e00\u4e2a\u5173\u952e\u7684\u7ed3\u8bba\uff1a\n\n>  \u67d3\u8272\u4e4b\u540e\u7ef3\u957f\u53ef\u4ee5\u7f29\u77ed\u81f3 $2$ \u7684\u5145\u5206\u5fc5\u8981\u6761\u4ef6\u662f\uff1a\u9664\u4e86\u9996\u5c3e\u4e24\u6bb5\uff0c\u5176\u4f59\u7684**\u540c\u8272\u8fde\u7eed\u6bb5**\u7684\u957f\u5ea6\u90fd\u4e3a\u5076\u6570\u3002\n\n\u8bc1\u660e\uff1a\n\n> 1. \u5145\u5206\u6027\uff1a\n>\n>    \u5373\u9700\u8981\u5bf9\u4e8e\u6bcf\u79cd\u6ee1\u8db3\u8be5\u6761\u4ef6\u7684\u7ef3\u5b50\u6784\u9020\u51fa\u4e00\u79cd\u65b9\u6848\uff0c\u4f7f\u5f97\u7ef3\u957f\u80fd\u591f\u7f29\u77ed\u81f3 $2$\u3002\n>\n>    - \u9996\u5148\u5c06\u6700\u540e\u4e00\u6bb5\u7684\u957f\u5ea6\u7f29\u77ed\u81f3 $1$\uff1b\n>\n>    - \u82e5\u5012\u6570\u7b2c\u4e8c\u6bb5\u4e0d\u662f\u7b2c\u4e00\u6bb5\uff0c\u53d6\u5012\u6570\u7b2c\u4e8c\u6bb5\u7684\u4e2d\u7ebf\uff0c\u5c06\u7ef3\u5b50\u6cbf\u7740\u8fd9\u6761\u4e2d\u7ebf\u7ffb\u6298\uff0c\u7ffb\u6298\u4e4b\u540e\u5012\u6570\u7b2c\u4e8c\u6bb5\u53d8\u4e3a\u6700\u540e\u4e00\u6bb5\uff0c\u91cd\u590d\u4e0a\u8ff0\u8fc7\u7a0b\uff1b\n>    - \u82e5\u5012\u6570\u7b2c\u4e8c\u6bb5\u662f\u7b2c\u4e00\u6bb5\uff0c\u5c06\u7b2c\u4e00\u6bb5\u7684\u957f\u5ea6\u7f29\u77ed\u81f3 $1$\uff0c\u603b\u7684\u7ef3\u957f\u7f29\u77ed\u81f3 $2$\uff0c\u6298\u53e0\u7ed3\u675f\u3002\n>\n> 2. \u5fc5\u8981\u6027\uff1a\n>\n>    \u5373\u9700\u8981\u8bc1\u660e\u4e0d\u6ee1\u8db3\u8be5\u6761\u4ef6\u7684\u7ef3\u5b50\u90fd\u65e0\u6cd5\u6784\u9020\u51fa\u65b9\u6848\uff0c\u4f7f\u5f97\u7ef3\u957f\u80fd\u591f\u7f29\u77ed\u81f3 $2$\u3002\n>\n>    - \u53d6\u51fa\u65e2\u4e0d\u662f\u9996\u6bb5\u4e5f\u4e0d\u662f\u5c3e\u6bb5\u7684\u67d0\u4e00\u4e2a\u957f\u5ea6\u4e3a\u5947\u6570\u7684\u6bb5\uff0c\u8003\u8651\u6bcf\u4e00\u6b21\u6298\u53e0\u7684\u5f71\u54cd\uff1b\n>    - \u56e0\u4e3a\u4e0e\u8be5\u6bb5\u76f8\u90bb\u7684\u662f\u4e24\u4e2a\u5f02\u8272\u7684\u6bb5\uff0c\u6bcf\u6b21\u6298\u53e0\u6240\u53d6\u7684\u4e2d\u7ebf\u4e00\u5b9a\u4e0d\u80fd\u5728\u8be5\u6bb5\u5185\uff1b\n>    - \u5bf9\u4e8e\u6240\u53d6\u4e2d\u7ebf\u5728\u8be5\u6bb5\u5916\u7684\u6298\u53e0\uff0c\u6298\u53e0\u8fc7\u540e\u4e0e\u8be5\u6bb5\u76f8\u90bb\u7684\u4ecd\u662f\u4e24\u4e2a\u5f02\u8272\u7684\u6bb5\uff1b\n>    - \u53ea\u8981\u4e0e\u8be5\u6bb5\u76f8\u90bb\u7684\u662f\u4e24\u4e2a\u5f02\u8272\u7684\u6bb5\uff0c\u7ef3\u957f\u5c31\u6c38\u8fdc\u65e0\u6cd5\u88ab\u7f29\u77ed\u81f3 $2$\u3002\n\n\u56e0\u4e3a\u957f\u5ea6\u4e3a\u5076\u6570\u7684\u8fde\u7eed\u6bb5\u53ef\u4ee5\u5212\u5206\u4e3a\u82e5\u5e72\u4e2a\u957f\u5ea6\u4e3a $2$ \u7684\u5c0f\u6bb5\uff0c\u6211\u4eec\u53ea\u9700\u8981\u679a\u4e3e\u7b2c\u4e00\u4e2a\u957f\u5ea6\u4e3a $2$ \u7684\u5c0f\u6bb5\u662f\u5728\u4f4d\u7f6e $1$ \u8fd8\u662f\u5728\u4f4d\u7f6e $2$\uff0c\u4fdd\u8bc1\u6bcf\u4e00\u4e2a\u957f\u5ea6\u4e3a $2$ \u7684\u5c0f\u6bb5\u5185\u7ebf\u7684\u989c\u8272\u90fd\u76f8\u540c\uff0c\u6700\u540e\u5728\u4e24\u79cd\u60c5\u51b5\u4e2d\u53d6\u6700\u4f18\u89e3\u3002\n\n\u8003\u8651\u679a\u4e3e\u5176\u4e2d\u4e00\u79cd\u989c\u8272 $i$\uff0c\u8ba1\u7b97\u5305\u542b\u989c\u8272 $i$ \u7684\u7b54\u6848\u3002\n\n\u8ba8\u8bba\u4e00\u4e2a\u957f\u5ea6\u4e3a $2$ \u7684\u5c0f\u6bb5\u4e2d\u7684\u51e0\u79cd\u60c5\u51b5\uff1a\n\n1. \u5982\u679c\u5c0f\u6bb5\u5185\u4e24\u6839\u7ebf\u540c\u8272\u4e14\u90fd\u4e3a $i$\uff0c\u663e\u7136\u4e0d\u9700\u8981\u518d\u66f4\u6539\uff1b\n2. \u5982\u679c\u5c0f\u6bb5\u5185\u5176\u4e2d\u4e00\u6839\u7ebf\u989c\u8272\u4e3a $i$\uff0c\u5c06\u53e6\u4e00\u6839\u7ebf\u4e5f\u6539\u4e3a $i$ \u663e\u7136\u4e0d\u4f1a\u66f4\u52a3\uff1b\n3. \u5982\u679c\u5c0f\u6bb5\u5185\u4e24\u6839\u7ebf\u7684\u989c\u8272\u90fd\u4e0d\u4e3a $i$\uff0c\u5219\u9700\u8981\u6839\u636e\u6240\u53d6\u7684\u53e6\u4e00\u79cd\u989c\u8272\u6765\u51b3\u5b9a\u8d39\u7528\u3002\n\n\u8bbe $cnt_i$ \u8868\u793a\u521d\u59cb\u65f6\u989c\u8272 $i$ \u7684\u51fa\u73b0\u6b21\u6570\uff0c$f_{i,j}$ \u8868\u793a\u4e24\u6839\u7ebf\u7684\u989c\u8272\u6070\u597d\u4e3a $i,j$ \u7684\u5c0f\u6bb5\u6570\uff0c\u5219\u6211\u4eec\u6240\u6c42\u5373\u4e3a $\\min \\limits_{j \\neq i}\\{n - cnt_i - cnt_j + f_{i,j}\\}$\u3002\n\n\u8003\u8651\u679a\u4e3e\u6bcf\u4e2a\u989c\u8272\u4e3a $i$ \u7684\u7ebf\u7684\u51fa\u73b0\u4f4d\u7f6e\uff0c\u82e5\u4e0e\u5176\u540c\u5904\u4e00\u4e2a\u5c0f\u6bb5\u7684\u7ebf\u7684\u989c\u8272\u4e3a $j(j \\neq i)$\uff0c\u5219\u4ee4 $cnt_j$ \u51cf\u4e00\uff0c\u9700\u8981\u52a8\u6001\u7ef4\u62a4 $\\max\\limits_{j \\neq i}\\{cnt_j\\}$\uff0c\u53ef\u4ee5\u7528\u4e00\u4e2a\u6876\u7ef4\u62a4\uff0c\u652f\u6301 $\\mathcal O(1)$ \u4fee\u6539\u548c\u67e5\u8be2\u3002\n\n\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n)$\u3002\n\n## Code\n\n```cpp\n#include <bits/stdc++.h>\n\nconst int S = 1 << 20;\nchar frd[S], *ihead = frd + S;\nconst char *itail = ihead;\n\ninline char nxtChar()\n{\n\tif (ihead == itail)\n\t\tfread(frd, 1, S, stdin), ihead = frd;\n\treturn *ihead++;\n}\n\ntemplate <class T>\ninline void read(T &res)\n{\n\tchar ch; \n\twhile (ch = nxtChar(), !isdigit(ch));\n\tres = ch ^ 48;\n\twhile (ch = nxtChar(), isdigit(ch))\n\t\tres = res * 10 + ch - 48;\n} \n\nchar fwt[S], *ohead = fwt;\nconst char *otail = ohead + S;\n\ninline void outChar(char ch)\n{\n\tif (ohead == otail)\n\t\tfwrite(fwt, 1, S, stdout), ohead = fwt;\n\t*ohead++ = ch;\n}\n\ntemplate <class T>\ninline void put(T x)\n{\n\tif (x > 9)\n\t\tput(x / 10);\n\toutChar(x % 10 + 48);\n}\n\nusing std::vector;\nconst int N = 1e6 + 5;\nconst int Maxn = 0x3f3f3f3f;\n\nvector<int> v[N];\nint n, m, mx;\nint cnt[N], apr[N], ans[N], col[N], mth[N];\n\ntemplate <class T>\ninline void CkMin(T &x, T y) {x > y ? x = y : 0;}\ntemplate <class T>\ninline void CkMax(T &x, T y) {x < y ? x = y : 0;}\n\ninline void del(int x)\n{\n\t--apr[cnt[x]];\n\t!apr[cnt[x]] && cnt[x] == mx ? --mx : 0;\n\t++apr[--cnt[x]];\n}\n\ninline void add(int x)\n{\n\t--apr[cnt[x]];\n\tcnt[x] == mx ? ++mx : 0;\n\t++apr[++cnt[x]];\n}\n\ninline void solve()\n{\n\tfor (int i = 1; i <= m; ++i)\n\t{\n\t\tint tmp = cnt[i];\n\t\tfor (int j = 1; j <= tmp; ++j)\n\t\t\tdel(i);\n\t\tfor (int j = 0, jm = v[i].size(); j < jm; ++j)\n\t\t{\n\t\t\tint x = v[i][j];\n\t\t\tif (mth[x] && col[mth[x]] != i)\n\t\t\t\tdel(col[mth[x]]);\n\t\t}\n\t\tCkMin(ans[i], n - tmp - mx);\n\t\tfor (int j = 0, jm = v[i].size(); j < jm; ++j)\n\t\t{\n\t\t\tint x = v[i][j];\n\t\t\tif (mth[x] && col[mth[x]] != i)\n\t\t\t\tadd(col[mth[x]]);\n\t\t}\n\t\tfor (int j = 1; j <= tmp; ++j)\n\t\t\tadd(i);\n\t}\n}\n\nint main()\n{\n\tread(n); read(m);\n\tif (m == 1)\n\t\treturn puts(\"0\"), 0;\n\n\tfor (int i = 1; i <= m; ++i)\n\t\tans[i] = Maxn;\n\tfor (int i = 1; i <= n; ++i)\n\t{\n\t\tread(col[i]);\n\t\tv[col[i]].push_back(i);\n\t\t++cnt[col[i]];\n\t}\t\n\tfor (int i = 1; i <= m; ++i)\n\t\tCkMax(mx, cnt[i]), ++apr[cnt[i]];\n\tfor (int i = 1; i <= n; i += 2)\n\t\tif (i < n)\n\t\t\tmth[i] = i + 1, mth[i + 1] = i;\n\t\telse\n\t\t\tmth[i] = 0;\n\tsolve();\n\n\tmth[1] = 0;\n\tfor (int i = 2; i <= n; i += 2)\n\t\tif (i < n)\n\t\t\tmth[i] = i + 1, mth[i + 1] = i;\n\t\telse\n\t\t\tmth[i] = 0;\n\tsolve();\n\n\tfor (int i = 1; i <= m; ++i)\n\t\tput(ans[i]), outChar('\\n');\n\tfwrite(fwt, 1, ohead - fwt, stdout);\n\treturn 0;\t\n}\n\n```",
        "postTime": 1582783390,
        "uid": 17952,
        "name": "Log_x",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5101 \u3010[JOI 2017 Final]\u7ef3\u3011"
    },
    {
        "content": "\u8c14\u8c14\uff0c\u7ed3\u8bba\u5f88\u597d\u731c\u4e5f\u5f88\u597d\u8bc1\u3002\n\n--------\n\n\u7531\u4e8e\u67d3\u8272\u9700\u8981\u539a\u5ea6\u7684\u4ee3\u4ef7\uff0c\u90a3\u4e48\u76f8\u5f53\u4e8e\u5bf9\u6bcf\u6839\u53e0\u5728\u8fd9\u91cc\u7684\u7ebf\u90fd\u67d3\u4e86\u4e00\u6b21\u3002\n\n\u90a3\u4e48\u5728\u628a\u7ef3\u5b50\u5148\u67d3\u8272\u518d\u5bf9\u6298\u5fc5\u7136\u4e0d\u52a3\u3002\n\n\u76f4\u63a5\u8003\u8651\u8fd9\u6839\u7ef3\u5b50\u6700\u540e\u4f1a\u53d8\u6210\u4ec0\u4e48\u6837\uff1a\n\n\u9996\u5148\u5bf9\u6298\u540e\u603b\u957f\u5ea6\u4e3a $2$\uff0c\u4e0d\u59a8\u5047\u8bbe\u4ed6\u5c31\u5728\u6570\u8f74\u7684 $[0,2]$ \u4e4b\u95f4\uff0c\u5176\u4e2d $[0,1]$ \u548c $[1,2]$ \u4e0a\u7684\u7ebf\u6bb5\u5fc5\u7136\u662f\u540c\u4e00\u79cd\u989c\u8272\u3002\n\n\u7136\u540e\u4f60\u4f1a\u53d1\u73b0\uff0c\u987a\u7740\u8fd9\u8ddf\u7ef3\u5b50\u8d70\uff0c\uff08\u9664\u4e86\u5f00\u5934\u548c\u7ed3\u5c3e\uff09\u5fc5\u7136\u662f\u4ece $1$ \u8d70\u5230 $0$ \u6216 $2$ \u518d\u8d70\u56de\u6765\uff0c\u800c\u8fd9\u4e24\u6b65\u8d70\u7684\u7ef3\u5b50\u989c\u8272\u5fc5\u7136\u76f8\u540c\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u6709\u4e00\u4e2a\u5fc5\u8981\u6761\u4ef6\uff1a\u9664\u4e86\u5f00\u5934\u6216\u8005\u7ed3\u5c3e\uff0c**\u989c\u8272\u8fde\u7eed\u6bb5\u957f\u5ea6\u5fc5\u7136\u4e3a\u5076\u6570**\u3002\n\n\u5145\u5206\u6027\u662f\u597d\u8bc1\u660e\u7684\uff0c\u4ece\u6700\u540e\u4e00\u76f4\u5f80\u524d\u6298\u5c31\u884c\uff0c\u4e00\u76f4\u628a\u6700\u540e\u7684\u989c\u8272\u8fde\u7eed\u6bb5\u957f\u5ea6\u6298\u6210 $1$\uff0c\u5c31\u80fd\u5f80\u524d\u5bf9\u6298\u4e86\u3002\n\n----------\n\n\u8003\u8651\u76f4\u63a5\u5bf9\uff08\u539f\u6765\u7ef3\u5b50\u4e0a\u7684\uff09\u7ebf\u6bb5\u914d\u5bf9\uff0c\u90a3\u4e48 $i$ \u53ea\u80fd\u548c $i-1$ \u548c $i+1$ \u914d\u5bf9\uff1b\u679a\u4e3e\u4e24\u79cd\u60c5\u51b5\u3002\n\n\u5bf9\u4e8e\u989c\u8272 $c$\uff0c\u6211\u4eec\u627e\u51fa\u6709\u989c\u8272 $c$ \u7684\u6bcf\u4e2a\u4f4d\u7f6e\uff0c\u628a\u548c\u8fd9\u6761\u7ebf\u6bb5\u914d\u5bf9\u7684\u7ebf\u6bb5\u67d3\u6210 $c$ \u5fc5\u7136\u4e0d\u52a3\u3002\n\n\u5269\u4e0b\u7684\u90e8\u5206\u76f8\u5f53\u4e8e\u6c42\u5176\u4ed6\u989c\u8272\u6570\u91cf\u7684\u6700\u5927\u503c\uff0c\u4fdd\u5b58\u6bcf\u79cd\u989c\u8272\u6570\u91cf\u7684\u6876\uff0c\u5c31\u80fd\u505a\u5230 $\\Theta(1)$ \u4fee\u6539\u67e5\u8be2\u6700\u5927\u503c\u4e86\u3002\n\n\u590d\u6742\u5ea6 $\\Theta(n+m)$\u3002\n\n--------\n\n**Code:**\n\n```cpp\n// #pragma GCC optimize(\"Ofast\")\n// #pragma GCC optimize(\"unroll-loops\")\n// #pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,avx2\")\n#include <bits/stdc++.h>\n// #define int long long\n#define i64 long long\n#define pii pair <int, int> \nusing namespace std;\ninline int read(void) {\n    int x=0,sgn=1; char ch=getchar();\n    while(ch<48||57<ch) {if(ch==45)sgn=0;ch=getchar();}\n    while(47<ch&&ch<58) {x=x*10+ch-48;   ch=getchar();}\n    return sgn? x:-x;\n}\nvoid write(int x) {\n    if(x<0) putchar('-'),x=-x;\n    if(x>9) write(x/10);\n    putchar(x%10+'0');\n}\nint n,m;\nint col[1000006],cnt[1000006],ccc[1000006],MXCNT,MXCOL,NXCNT;\nvector <int> E[1000006];\ninline int trans(int x,int st) {\n    if(st==1) return x^1;\n    else return ((x+1)^1)-1;\n}\ninline int work(int c,int st) {\n    int k,res;\n    for(int x : E[c]) {\n        if(x==st) continue;\n        k=trans(x,st);\n        if(col[k]==c) continue;\n        --ccc[cnt[col[k]]];\n        --cnt[col[k]];\n        ++ccc[cnt[col[k]]];\n    }\n    k=(c==MXCOL ? NXCNT : MXCNT);\n    --ccc[cnt[c]];\n    for(; k>=0; --k) if(ccc[k]) { res=n-cnt[c]-k; break; }\n    ++ccc[cnt[c]];  // reverse\n    for(int x : E[c]) {\n        if(x==st) continue;\n        k=trans(x,st);\n        if(col[k]==c) continue;\n        --ccc[cnt[col[k]]];\n        ++cnt[col[k]];\n        ++ccc[cnt[col[k]]];\n    }\n    return res;\n}\nsigned main() {\n    n=read(); m=read();\n    for(int i=1; i<=n; ++i) {\n        E[col[i]=read()].push_back(i);\n        ++cnt[col[i]];\n    }\n    for(int i=1; i<=m; ++i) {\n        ++ccc[cnt[i]];\n        if(cnt[i]>=MXCNT) NXCNT=MXCNT,MXCNT=cnt[i],MXCOL=i;\n        else if(cnt[i]>=NXCNT) NXCNT=cnt[i];\n    }\n    if(m==1) return puts(\"0\"),0;\n    for(int i=1; i<=m; ++i) write(min(work(i,1),work(i,n))),puts(\"\");\n    return 0;\n}\n\n```\n\n",
        "postTime": 1678949391,
        "uid": 197493,
        "name": "unputdownable",
        "ccfLevel": 7,
        "title": "P5101 [JOI 2017 Final] \u7ef3"
    }
]
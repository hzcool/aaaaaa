[
    {
        "content": "\u611f\u89c9\u8fd9\u9898\u6bd4 T1T2 \u7b80\u5355\u3002\u3002\r\n\r\n\u9996\u5148\u9898\u76ee\u8981\u6c42\u7684\u5c31\u662f\u5bf9\u957f\u4e3a $2n$ \u7684\u6bcf\u4e00\u4e2a\u5408\u6cd5\u62ec\u53f7\u5e8f\u5217\u4e2d\uff0c\u914d\u5bf9\u7684\u5de6\u53f3\u62ec\u53f7\u6743\u503c\u4e58\u79ef\u4e4b\u548c\u6c42\u548c\u3002\u8fd9\u79cd\u5bf9\u548c\u518d\u6c42\u548c\u5f88\u5bb9\u6613\u60f3\u5230\u62c6\u8d21\u732e\uff0c\u8003\u8651\u8ba1\u7b97 $a_xa_y$ \u7684\u8d21\u732e\uff0c\u4e5f\u5373\u6709\u591a\u5c11\u4e2a\u5408\u6cd5\u62ec\u53f7\u5e8f\u5217\u6ee1\u8db3\u4f4d\u7f6e $x$ \u548c\u4f4d\u7f6e $y$ \u4e0a\u7684\u62ec\u53f7\u662f\u914d\u5bf9\u7684\u3002\u8fd9\u8981\u6c42 $(x,y)$ \u548c $[1,x)\\cup(y,2n]$ \u5206\u522b\u662f\u5408\u6cd5\u62ec\u53f7\u5e8f\u5217\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f $H_{\\frac{(y-x-1)}{2}}H_{n-\\frac{(y-x+1)}{2}}$\u3002\u663e\u7136\u8fd9\u4e2a\u503c\u53ea\u4e0e $l=y-x$ \u7684\u503c\u6709\u5173\uff0c\u90a3\u6211\u4eec\u53ea\u9700\u5bf9\u6bcf\u4e00\u4e2a $l$ \u6c42\u51fa $\\sum_{y-x=l}a_xa_y$ \u5c31\u884c\u4e86\u3002\u8fd9\u662f\u4e00\u4e2a\u5dee\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u7ffb\u8f6c\u4e00\u4e0b\u518d NTT \u5377\u8d77\u6765\u5373\u53ef\u3002\u590d\u6742\u5ea6 $O(n\\log n)$\u3002",
        "postTime": 1674132097,
        "uid": 314991,
        "name": "zhouyuhang",
        "ccfLevel": 7,
        "title": "P8958"
    },
    {
        "content": "\u591a\u9879\u5f0f\u7ecf\u5178\u9898\u3002\u3001\n\n## \u601d\u8def\n\n\u5148\u6362 $\\sum$\uff0c\u679a\u4e3e $i,j$\uff0c\u5224\u65ad $a_{i}\\times a_{j}$ \u88ab\u591a\u5c11\u4e2a\u62ec\u53f7\u5e8f\u5217\u7ed9\u5305\u542b\u4e86\u3002\n\n\u4e0d\u96be\u53d1\u73b0\u957f\u5ea6\u4e3a $2x$ \u7684\u62ec\u53f7\u5e8f\u5217\u6570\u91cf\u4e3a[\u5361\u7279\u5170\u6570](https://baike.baidu.com/item/%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0/6125746?fr=aladdin)\u7b2c $x$ \u9879\uff08\u4ee4\u5176\u4e3a $H_x$\uff0c\u5f53 $x$ \u4e0d\u4e3a\u81ea\u7136\u6570\u65f6 $H_x=0$\uff09\n\n\u4e0d\u96be\u53d1\u73b0\u5f0f\u5b50\u53d8\u6210\u4e86 $\\sum_{i=1}^n\\sum_{j=i+1}^na_i\\times a_j\\times H_{\\frac{j-i-1}{2}}\\times H_{\\frac{i-1+2\\times n-j}{2}}$\u3002\n\n\u4ee4 $G_x=H_{\\frac{x-1}{2}}\\times H_{\\frac{2\\times n-1-x}{2}}$\u3002\u4e0d\u96be\u53d1\u73b0\u5bf9\u4e8e\u6240\u6709 $j-i=x$\uff0c$a_i\\times a_j$ \u7684\u7cfb\u6570\u5747\u4e3a $G_x$\u3002\u8003\u8651\u8fd9\u4e2a $j-i$\uff0c\u662f\u4e00\u4e2a\u7ecf\u5178\u7684\u5dee\u5377\u79ef\u5f0f\u5b50\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5728 $\\Theta(n\\log n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u89e3\u51b3\u672c\u9898\u3002\n\n## \u4ee3\u7801\n\n```\n\nsigned main(){\n\tinit();\n\tint n=read(),m,ans=0;n*=2;\n\tfor(int i=0;i<n;i++) a[i]=read(),b[i]=a[i]; m=n;//\u5c06\u6b63\u65b9\u5411\u4e0e\u53cd\u65b9\u5411\u7684 a[i] \u5377\u8d77\u6765\n\treverse(b,b+n);//\u7ffb\u8f6c\u505a\u5dee\u5377\u79ef\n\tt=1;//\u5377\u79ef\u6a21\u677f \u5f00\u5934\n\tint len=0;\n\twhile(t<=n+m) t*=2,len++;\n\tfor(int i=0;i<t;i++) id[i]=(id[i>>1]>>1)|((i&1)<<(len-1));\n\tfor(int i=2;i<=t;i*=2) g[i][1]=qp(3,(mod-1)/i),g[i][0]=qp(g[i][1],mod-2);\n\tntt(a,1); ntt(b,1)\n\tfor(int i=0;i<t;i++) f[i]=a[i]*b[i]%mod;\n\tntt(f,0);\n\tint x=qp(t,mod-2);\n\tfor(int i=0;i<n;i++) (f[i]*=x)%=mod;//\u5377\u79ef\u6a21\u677f \u7ed3\u5c3e\n\treverse(f,f+n);//\u5dee\u5377\u79ef\u7ffb\u8f6c\u56de\u6765\n\tfor(int i=1;i<n;i+=2) (ans+=f[i]*Ca((i-1)/2)%mod*Ca((n-i-1)/2)%mod)%=mod;//Ca \u8868\u793a\u5361\u7279\u5170\u6570\uff0c\u5f0f\u5b50\u5982\u4e0a\u3002\n\tcout<<ans;\n\treturn 0;\n}\n```",
        "postTime": 1671887211,
        "uid": 116664,
        "name": "Daniel_lele",
        "ccfLevel": 8,
        "title": "P8958 \u9898\u89e3"
    }
]
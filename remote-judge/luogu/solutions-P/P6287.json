[
    {
        "content": "# \u7ed3\u8bba\n\n\u4e3a\u65b9\u4fbf\u8868\u8ff0\uff0c\u79f0\u4e00\u6761\u8def\u5f84\u7684\u8282\u70b9\u6570\u4e3a\u5176\u957f\u5ea6\u3002\n\n\u6b64\u9898\u6709\u8fd9\u6837\u7684\u7ed3\u8bba\uff1a\n\n- \u82e5\u4e0d\u5b58\u5728\u9b54\u529b\u503c\u4e3a $1$ \u7684\u8282\u70b9\uff0c\u5219\u9b54\u529b\u503c\u6700\u5c0f\u7684\u8def\u5f84\u5373\u4e3a\u9b54\u529b\u503c\u6700\u5c0f\u7684\u8282\u70b9\u3002\n\n- \u82e5\u5b58\u5728\u9b54\u529b\u503c\u4e3a $1$ \u7684\u8282\u70b9\uff0c\u8bb0\u6240\u6709\u8282\u70b9\u7684\u9b54\u529b\u503c\u5747\u4e3a $1$ \u7684\u6700\u957f\u8def\u5f84\u7684\u957f\u5ea6\u4e3a $l$\uff0c\u5219\u9b54\u529b\u503c\u6700\u5c0f\u7684\u8def\u5f84\u4e3a\u4e0b\u9762\u4e24\u8005\u4e4b\u4e00\uff1a\n\n\t1. \u4e00\u6761\u957f\u5ea6\u4e3a $l$ \u7684\u8def\u5f84\uff0c\u6240\u6709\u8282\u70b9\u7684\u9b54\u529b\u503c\u5747\u4e3a $1$\u3002\n    2. \u4e00\u6761\u957f\u5ea6\u4e3a $2\\times l+1$ \u7684\u8def\u5f84\uff0c\u7b2c $l+1$ \u4e2a\u8282\u70b9\u7684\u9b54\u529b\u503c\u4e3a $2$\uff0c\u5176\u4f59\u8282\u70b9\u7684\u9b54\u529b\u503c\u5747\u4e3a $1$\u3002\n    \n# \u8bc1\u660e\n\n\u4e0b\u6587\u4e2d\u7684\u6240\u6709\u5185\u5bb9\u5747\u5728\u6b63\u6574\u6570\u8303\u56f4\u5185\u8ba8\u8bba\u3002\n\n\u8bb0\u8def\u5f84 $p$ \u7684\u957f\u5ea6\u4e3a $l(p)$\uff0c\u9b54\u529b\u503c\u4e3a $f(p)$\uff0c\u6240\u6709\u8282\u70b9\u9b54\u529b\u503c\u7684\u4e58\u79ef\u4e3a $m(p)$\u3002\n\n------------\n\n- \u82e5\u4e0d\u5b58\u5728\u9b54\u529b\u503c\u4e3a $1$ \u7684\u8282\u70b9\u3002\n\n\t\u5047\u8bbe\u8def\u5f84 $p_1$ \u5c06\u4e0e\u8def\u5f84 $p_2$ \u8fde\u63a5\u4e3a\u4e00\u6761\u65b0\u7684\u8def\u5f84\u3002\n\n\t\u4e0d\u59a8\u4ee4 $f(p_1)<f(p_2)$\u3002\u5373 $\\frac{m(p_1)}{l(p_1)}<\\frac{m(p_2)}{l(p_2)}$\u3002\u53d8\u5f62\u53ef\u5f97 $\\frac{l(p_2)}{l(p_1)}<\\frac{m(p_2)}{m(p_1)}$\u3002\n\n\t\u82e5\u8fde\u63a5\u540e\u5f97\u5230\u7684\u8def\u5f84\u4e3a\u66f4\u4f18\u89e3\uff0c\u5219 $\\frac{m(p_1)\\times m(p_2)}{l(p_1)+l(p_2)}<\\frac{m(p_1)}{l(p_1)}$\u3002\n\n\t\u53d8\u5f62\u5f97 $m(p_2)-1<\\frac{l(p_2)}{l(p_1)}$\u3002\n\n\t\u6240\u4ee5 $m(p_2)-1<\\frac{m(p_2)}{m(p_1)}$\u3002\n\n\t\u53d8\u5f62\u5f97  $(m(p_1)-1)(m(p_1)-1)<1$\u3002\n\n\t\u7531\u4e8e\u4e0d\u5b58\u5728\u9b54\u529b\u503c\u4e3a $1$ \u7684\u8282\u70b9\uff0c$m(p_1)-1\\ge 1 \\bigwedge m(p_2)-1\\ge 1$\u3002\n\n\t\u4e0d\u7b49\u5f0f\u65e0\u89e3\u3002\u5373\u5c06\u4e24\u6761\u8def\u5f84\u5408\u5e76\u540e\u4e00\u5b9a\u65e0\u6cd5\u5f97\u5230\u66f4\u4f18\u89e3\u3002\n\n\t\u663e\u7136\uff0c\u6b64\u65f6\u9b54\u529b\u503c\u6700\u5c0f\u7684\u8def\u5f84\u5373\u4e3a\u9b54\u529b\u503c\u6700\u5c0f\u7684\u8282\u70b9\u3002\u5373\u7ed3\u8bba\u7684\u7b2c\u4e00\u90e8\u5206\u3002\n\n------------\n\n- \u82e5\u5b58\u5728\u9b54\u529b\u503c\u4e3a $1$ \u7684\u8282\u70b9\u3002\n\n\t\u5047\u8bbe\u6709\u6700\u957f\u7684\u8def\u5f84 $p_1$ \u4f7f\u5f97 $m(p_1)=1$\uff0c\u4e0e\u4efb\u610f\u8def\u5f84 $p_2$\u3002\n\n\t\u82e5 $f(p_2)<f(p_1)$\uff0c\u5219 $\\frac{m(p_2)}{l(p_2)}<\\frac{1}{l(p_1)}$\u3002\n\n\t\u53d8\u5f62\u5f97 $\\frac{l(p_2)}{l(p_1)}>m(p_2)$\u3002\n    \n\t\u9700\u8981\u6ce8\u610f\uff0c\u5047\u8bbe $p_2$ \u6709\u6700\u957f\u7684\u5b50\u8def\u5f84 $p_t$ \u4f7f\u5f97 $m(p_t)=1$\uff0c\u5176\u8fd8\u5e94\u6ee1\u8db3 $l(p_t)\\le l(p_1)$\u3002\n    \n\t\u8bbe $m(p_2)$ \u7684\u8d28\u56e0\u6570\u4e2a\u6570\u4e3a $k$\u3002\u7528\u9b54\u529b\u503c\u4e3a\u8fd9\u4e9b\u8d28\u56e0\u6570\u7684 $k$ \u4e2a\u8282\u70b9\u8fde\u63a5 $k+1$ \u6bb5\u957f\u5ea6\u4e3a $l(p_1)$\u3001\u9b54\u529b\u503c\u4e3a $1$ \u7684\u8def\u5f84\uff0c\u5373\u53ef\u5f97\u5230 $l(p_2)\\le k+(k+1)\\times l(p_1)$\u3002\n\n\t\u7531\u4e8e $x$ \u7684\u8d28\u56e0\u6570\u4e2a\u6570\u4e0d\u5927\u4e8e $\\log_2(x)$\u3002\u6240\u4ee5 $l(p_2)\\le \\log_2(m(p_2))+(\\log_2(m(p_2))+1)\\times l(p_1)$\u3002\n\n\t\u53c8\u6709 $l(p1)\\ge 1$\u3002\u6240\u4ee5 $2\\times \\log_2(m(p_2))+1>m(p_2)$\u3002\n\n\t\u8fd9\u4e2a\u4e0d\u7b49\u5f0f\u7684\u6b63\u6574\u6570\u89e3\u4e3a $m(p_2)=2,3,4,5,6$\u3002\n\n\t\u7ecf\u68c0\u9a8c\uff0c\u53ea\u6709\u5f53 $m(p_2)=2,4$ \u65f6\uff0c\u5173\u4e8e $l(p_1)$ \u7684\u4e0d\u7b49\u5f0f $\\frac{k+\t\t(k+1)\\times l(p_1)}{l(p_1)}>m(p_2)$ \u6709\u6b63\u6574\u6570\u89e3\u3002\n\n\t1. $m(p_2)=4$\u3002\n    \n    \t\u6b64\u65f6 $l(p_1)=1$\u3002\u5373\u8def\u5f84 $p_2$ \u4e3a `1,2,1,2,1`\u3002\n        \n        \u4f46\u662f\uff0c\u8fd9\u6761\u8def\u5f84\u7684\u9b54\u529b\u503c\u5927\u4e8e\u8def\u5f84 `1,2,1`\u3002\n        \n\t2. $m(p_2)=2$\u3002\n    \n    \t\u4e0d\u7b49\u5f0f\u6052\u6210\u7acb\u3002\n        \n        \u5373\u5f53 $l(p_2)=2\\times l(p_1)+1$\uff0c\u8def\u5f84 $p_2$ \u7684\u7b2c $l(p_1)+1$ \u4e2a\u8282\u70b9\u7684\u9b54\u529b\u503c\u4e3a $2$\uff0c\u5176\u4f59\u8282\u70b9\u7684\u9b54\u529b\u503c\u5747\u4e3a $1$ \u65f6\uff0c$f(p_2)<f(p_1)$\u3002\n        \n        \u82e5 $l(p_2)$ \u4e0d\u518d\u53d6\u6700\u5927\u503c $k+(k+1)\\times l(p_1)$\uff0c\u4e0d\u7b49\u5f0f\u65e0\u6b63\u6574\u6570\u89e3\u3002\n        \n    \u6362\u8a00\u4e4b\uff0c\u5f53\u4e14\u4ec5\u5f53 $l(p_2)=2\\times l(p_1)+1$\uff0c\u7b2c $l(p_1)+1$ \u4e2a\u8282\u70b9\u7684\u9b54\u529b\u503c\u4e3a $2$\uff0c\u5176\u4f59\u8282\u70b9\u7684\u9b54\u529b\u503c\u5747\u4e3a $1$ \u65f6\uff0c$f(p_2)<f(p_1)$\u3002\u5373\u7ed3\u8bba\u7684\u7b2c\u4e8c\u90e8\u5206\u3002\n\n# \u5b9e\u73b0\n \n\u5b9e\u9645\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u7edf\u8ba1\u6240\u6709\u4ec5\u6709\u4e00\u4e2a\u8282\u70b9\u7684\u9b54\u529b\u503c\u4e3a $2$\u3001\u5176\u4f59\u8282\u70b9\u9b54\u529b\u503c\u5747\u4e3a $1$ \u7684\u8def\u5f84\uff0c\u4e0d\u5f71\u54cd\u7b54\u6848\u3002\u56e0\u4e3a\u82e5\u9b54\u529b\u503c\u4e3a $2$ \u7684\u8282\u70b9\u4e0d\u5728\u8be5\u8def\u5f84\u6b63\u4e2d\u95f4\uff0c\u5219\u4e00\u5b9a\u5b58\u5728\u4e00\u6761\u6240\u6709\u8282\u70b9\u9b54\u529b\u503c\u5747\u4e3a $1$ \u7684\u5b50\u8def\u5f84\uff0c\u9b54\u529b\u503c\u4e0d\u5c0f\u4e8e\u539f\u8def\u5f84\u3002\n\n\u82e5\u5b50\u8def\u5f84\u7684\u9b54\u529b\u503c\u548c\u539f\u8def\u5f84\u76f8\u7b49\uff0c\u4fbf\u53ef\u80fd\u51fa\u73b0\u9700\u8981\u7ea6\u5206\u7684\u60c5\u51b5\u3002\u6211\u4eec\u53ef\u4ee5\u4f18\u5316\u7edf\u8ba1\u7b54\u6848\u7684\u987a\u5e8f\uff0c\u4f7f\u5f97\u5b50\u8def\u5f84\u7684\u9b54\u529b\u503c\u4e00\u5b9a\u5148\u4e8e\u539f\u8def\u5f84\u88ab\u7edf\u8ba1\u3002\n\n------------\n \n- \u7528 $f(x)$ \u8868\u793a\u4ee5 $x$ \u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\u4e2d\uff0c\u4ee5 $x$ \u4e3a\u4e00\u7aef\u4e14\u9b54\u529b\u503c\u4e3a $1$ \u7684\u8def\u5f84\u7684\u6700\u5927\u957f\u5ea6\u3002\n\n- \u7528 $g(x)$ \u8868\u793a\u4ee5 $x$ \u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\u4e2d\uff0c\u4ee5 $x$ \u4e3a\u4e00\u7aef\u4e14\u9b54\u529b\u503c\u4e3a $2$ \u7684\u8def\u5f84\u7684\u6700\u5927\u957f\u5ea6\u3002\n\n- \u8282\u70b9 $x$ \u5f97\u51fa\u7684\u7b54\u6848\u7531\u5176\u81ea\u8eab\u4e0e\u4e24\u4e2a\u4e0d\u540c\u7684\u5b50\u8282\u70b9 $i,j$\uff08\u53ef\u80fd\u4e3a\u7a7a\uff09\u7ec4\u6210\uff1a\n\n\t1. \u8282\u70b9 $x$ \u7684\u9b54\u529b\u503c\u4e3a $1$\u3002\n    \n    \t\u5f97\u51fa\u7684\u7b54\u6848\u4e3a $1/(\\max(f(i)+f(j))+1)$ \u4e0e $2/(\\max(f(i)+g(j))+1)$\u3002\n        \n        $f(x)=\\max(f(i))+1,g(x)=\\max(g(i))+1$\u3002\n    \n\t2. \u8282\u70b9 $x$ \u7684\u9b54\u529b\u503c\u4e3a $2$\u3002\n    \t\n    \t\u5f97\u51fa\u7684\u7b54\u6848\u4e3a $2/\\max(f(i)+f(j))+1$\u3002\n        \n        $f(x)=0,g(x)=\\max(f(i))+1$\u3002\n        \n\t3. \u8282\u70b9 $x$ \u7684\u9b54\u529b\u503c\u5927\u4e8e $2$\u3002\n    \t\n        \u65e0\u6cd5\u5f97\u51fa\u7b54\u6848\u3002\n        \n        $f(x)=0,g(x)=0$\u3002\n\n------------\n        \n\u53c2\u8003\u4ee3\u7801\uff1a\n```\n//\u6ce8\uff1a\u672c\u4eba\u5b9e\u73b0\u4ee3\u7801\u65f6\u53c2\u8003\u4e86 @programme_C \u7684\u9898\u89e3\u3002\n#include<cstdio>\nconst int MAXN=1000000+10;\nstruct Node{\n\tint next;\n\tint to;\n}edge[MAXN<<1];\nint head[MAXN],cnt;\nvoid add(int u,int v){\n\tedge[cnt].next=head[u];\n\tedge[cnt].to=v;\n\thead[u]=cnt++;\n\treturn;\n}\nint mag[MAXN];\nint f[MAXN],g[MAXN];\nint p=1e9,q=1,mn=1e9;\nvoid update(int x,int y){\n\tif(p*y>q*x){\n\t\tp=x,q=y;\n\t}\n\treturn;\n}\n//\u66f4\u65b0\u7b54\u6848\u3002\u5316\u9664\u4e3a\u4e58\u3002\nvoid DP(int cur,int fa){\n\tint u1=0,u2=0,v1=0,v2=0;\n\t/*\n\t\tu1 \u8868\u793a cur \u7684\u5b50\u7ed3\u70b9\u4e2d f \u503c\u6700\u5927\u7684\u8282\u70b9\uff1b\n\t\tu2 \u8868\u793a cur \u7684\u5b50\u7ed3\u70b9\u4e2d f \u503c\u6b21\u5927\u7684\u8282\u70b9\uff1b\n\t\tv1 \u8868\u793a cur \u7684\u5b50\u7ed3\u70b9\u4e2d g \u503c\u6700\u5927\u7684\u8282\u70b9\uff1b\n\t\tv2 \u8868\u793a cur \u7684\u5b50\u7ed3\u70b9\u4e2d g \u503c\u6b21\u5927\u7684\u8282\u70b9\uff1b\n\t*/\n\tfor(int i=head[cur];~i;i=edge[i].next){\n\t\tint t=edge[i].to;\n\t\tif(t!=fa){\n\t\t\tDP(t,cur);\n\t\t\tif(f[t]>f[u1]){\n\t\t\t\tu2=u1,u1=t;\n\t\t\t}\n\t\t\telse if(f[t]>f[u2]){\n\t\t\t\tu2=t;\n\t\t\t}\n\t\t\tif(g[t]>g[v1]){\n\t\t\t\tv2=v1,v1=t;\n\t\t\t}\n\t\t\telse if(g[t]>g[v2]){\n\t\t\t\tv2=t;\n\t\t\t}\n\t\t}\n\t\t//\u66f4\u65b0 u1,u2,v1,v2\u3002\n\t}\n\tif(mag[cur]==1){\n\t\tf[cur]=f[u1]+1;\n\t\tupdate(1,f[u1]+f[u2]+1);\n\t\t//\u6ce8\u610f\u987a\u5e8f\u3002\u907f\u514d\u51fa\u73b0\u9700\u8981\u7ea6\u5206\u7684\u60c5\u51b5\u3002\n\t\tif(v1!=0){\n\t\t\tg[cur]=g[v1]+1;\n\t\t\tif(u1!=v1){\n\t\t\t\tupdate(2,f[u1]+g[v1]+1);\n\t\t\t}\n\t\t\t//\u7279\u5224 cur \u7684\u5b50\u7ed3\u70b9\u4e2d f \u503c\u6700\u5927\u7684\u8282\u70b9\u4e0e g \u503c\u6700\u5927\u7684\u8282\u70b9\u76f8\u540c\u7684\u60c5\u51b5\u3002\n\t\t\telse{\n\t\t\t\tupdate(2,f[u2]+g[v1]+1);\n\t\t\t\tif(v2!=0){\n\t\t\t\t\tupdate(2,f[u1]+g[v2]+1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//\u7279\u5224 g \u503c\u4e3a 0 \u7684\u60c5\u51b5\u3002\u6b64\u65f6\u65e0\u6cd5\u6784\u6210\u7b26\u5408\u8981\u6c42\u7684\u8def\u5f84\u3002\n\t\t//\u9700\u8981\u6ce8\u610f\uff0cf \u503c\u4e3a 0 \u65f6\u4ecd\u80fd\u6784\u6210\u7b26\u5408\u8981\u6c42\u7684\u8def\u5f84\u3002\n\t}\n\telse if(mag[cur]==2){\n\t\tg[cur]=f[u1]+1;\n\t\tupdate(2,f[u1]+f[u2]+1);\n\t}\n\treturn;\n}\nint main(){\n\tint n;\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;++i){\n\t\thead[i]=-1;\n\t}\n\tfor(int i=1;i<n;++i){\n\t\tint u,v;\n\t\tscanf(\"%d%d\",&u,&v);\n\t\tadd(u,v);\n\t\tadd(v,u);\n\t}\n\tfor(int i=1;i<=n;++i){\n\t\tscanf(\"%d\",mag+i);\n\t\tif(mag[i]<mn){\n\t\t\tmn=mag[i];\n\t\t}\n\t}\n\tif(mn>1){\n\t\tprintf(\"%d/1\",mn);\n\t\treturn 0;\n\t}\n\t//\u7279\u5224\u65e0\u9b54\u529b\u503c\u4e3a 1 \u7684\u8282\u70b9\u7684\u60c5\u51b5\u3002\n\tDP(1,0);\n\tprintf(\"%d/%d\",p,q);\n\treturn 0;\n}\n```",
        "postTime": 1586101653,
        "uid": 118228,
        "name": "Wenoide",
        "ccfLevel": 0,
        "title": "\u300c\u9898\u89e3\u300dP6287 [COCI2016-2017#1] Mag"
    },
    {
        "content": "## COCI2016/2017 #1 D Mag \u70b9\u5206\u6cbb\n\n\u200b\t\u9898\u76ee\u94fe\u63a5\uff1a[COCI2016-2017#1](https://www.luogu.com.cn/problem/P6287)\n\n---\n\n## \u7b97\u6cd5: \u70b9\u5206\u6cbb\n\n## \u8bc1\u660e&\u7ed3\u8bba\uff1a\n\n\u200b\t\u9996\u5148\u8fd9\u9898\u5173\u4e8e\u9009\u51fa\u6765\u7684\u8def\u5f84\u6709\u4e00\u4e2a\u7ed3\u8bba\uff1a\n\n+ \u8def\u5f84\u4e0a\u70b9\u6743\u5168\u4e3a $1$\u3002\n+ \u8def\u5f84\u957f\u5ea6\u4e3a $2\\times l+1$\uff0c\u6709\u4e14\u53ea\u6709\u4e00\u4e2a\u6743\u503c\u4e3a $2$ \u7684\u70b9\u5728 $l+1$ \u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u5176\u4ed6\u70b9\u6743\u90fd\u4e3a $1$\u3002\n+ \u5982\u679c\u6ca1\u6709\u70b9\u6743\u4e3a $1$ \u7684\u70b9\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f\u6700\u5c0f\u7684\u6743\u503c\u3002\n\n\u200b    \u9996\u5148\u58f0\u660e\u4e00\u70b9\uff0c\u636e\u9898\u610f\u53ef\u77e5\uff0c\u9898\u76ee\u4e2d\u51fa\u73b0\u7684**\u6570\u636e\u90fd\u662f\u6b63\u6574\u6570**\uff0c\u6240\u4ee5\u4ee5\u4e0b\u63a8\u5bfc\u4e2d\u51fa\u73b0\u7684**\u53d8\u91cf**\u5747\u4e3a**\u6b63\u6574\u6570**\u3002\n\n\u200b\t\u6211\u4eec\u5047\u8bbe\u4e00\u4e2a\u70b9\u6743\u4e3a $x$ \u7684\u70b9\u8fde\u63a5\u4e86\u4e24\u6761\u9b54\u529b\u503c\u5206\u522b\u4e3a $\\dfrac{a}{b},\\dfrac{c}{d}$ \u7684\u8def\u5f84\u3002\u90a3\u4e48\u8fde\u63a5\u5b8c\u540e\u8def\u5f84\u7684\u9b54\u529b\u503c\u5c31\u4e3a $\\dfrac{a\\times c\\times x}{b+d+1}$\u3002\u6211\u4eec\u5c06\u8fd9\u4e2a\u9b54\u529b\u503c\u4e0e $\\dfrac{a}{b}$ \u76f8\u6bd4\uff0c\u5982\u679c $\\dfrac{a\\times c\\times x}{b+d+1}\\le\\dfrac{a}{b}$ \u7684\u8bdd\uff0c\u5c31\u6709 $d+1+b\\ge c\\times x\\times b$ \u5426\u5219\u80af\u5b9a\u76f4\u63a5\u9009 $\\dfrac{a}{b}$ \u66f4\u4f18\u3002\n\n\u200b\t\u518d\u4e0e $\\dfrac{c}{d}$ \u6bd4\u8f83\uff0c\u5f97\u51fa\u76f8\u4f3c\u7684\u4e00\u6761\u5f0f\u5b50 $d+1+b\\ge a\\times x\\times d$\u3002\u4e24\u5f0f\u5de6\u53f3\u5206\u522b\u76f8\u52a0\uff0c\u5f97\u5230 $2\\ge (c\\times x-2)\\times b+(a\\times x-2)\\times d$ \u3002\u53c8\u56e0\u4e3a $b,d\\ge 1$ \u6240\u4ee5 $c\\times x,a\\times x\\le 3$\u3002\n\n\u200b\t\u4f46\u662f\u6ce8\u610f\u5230\uff0c $c\\times x,a\\times x$ \u80fd\u53d6\u5230 $3$ \u662f\u56e0\u4e3a\u539f\u4e0d\u7b49\u5f0f\u5e26\u7b49\u53f7\uff0c\u53d6 $3$ \u7684\u65f6\u5019\u53ef\u80fd\u4f1a\u4f7f\u8fd9\u4e2a\u4e0d\u7b49\u5f0f\u6ee1\u8db3\u7b49\u4e8e\u53f7\u800c\u6210\u7acb\u3002\u4f46\u662f\u6211\u4eec\u9009\u7b54\u6848\u7684\u8303\u56f4\u662f**\u6574\u5f20**\u56fe\uff0c\u5982\u679c\u53d6\u7b49\u53f7\u7684\u8bdd\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u76f4\u63a5\u53d6\u9b54\u529b\u503c\u4e3a $\\dfrac{a}{b}$  \u6216\u8005 $\\dfrac{c}{d}$ \u4f5c\u4e3a\u7b54\u6848\u5462\uff1f\n\n\u200b\t\u6240\u4ee5\u6211\u4eec\u5c1d\u8bd5\u628a\u4e0d\u7b49\u5f0f\u7684\u7b49\u53f7\u53bb\u6389\u5c31\u5f97\u5230 $c\\times x,a\\times x\\le2$ \u3002\u7531\u4e8e $a,c,x$ \u5747\u4e3a\u6b63\u6574\u6570\uff0c\u90a3\u4e48 $a,c,x$ \u53ea\u80fd\u4e3a $1,2$\u3002\u63a5\u4e0b\u6765\u5206\u7c7b\u8ba8\u8bba\n\n+ $x=2$ \u7684\u60c5\u51b5\u3002\n\n  \u90a3\u4e48 $a,c$ \u90fd\u53ea\u80fd\u4e3a $1$\u3002\u90a3\u4e48\u5c31\u6709 $\\dfrac{1}{b},\\dfrac{1}{d},\\dfrac{2}{b+d+1}$ \u8fd9 $3$ \u79cd\u60c5\u51b5\u3002\u5982\u679c\u62fc\u8d77\u6765\u66f4\u4f18\u7684$\\dfrac{2}{b+d+1}<\\dfrac{2}{2\\times b}$ \u4e14 $\\dfrac{2}{b+d+1}<\\dfrac{2}{2\\times d}$\u3002\u6240\u4ee5\u5f53\u4e14\u4ec5\u5f53 $b=d$ \u65f6\uff0c\u62fc\u8d77\u6765\u4f1a\u66f4\u4f18\uff0c\u4e5f\u5c31\u662f $x$ \u8fd9\u4e2a\u70b9\u8fde\u63a5\u4e86\u4e24\u6761\u957f\u5ea6\u4e00\u6837\uff0c\u70b9\u6743\u5168\u4e3a $1$ \u7684\u94fe\u3002\u8fd9\u5bf9\u6807\u6211\u4eec\u7684\u7ed3\u8bba $2$\u3002\n\n+ $x=1$ \u7684\u60c5\u51b5\u3002\n\n  \u9996\u5148\u5982\u679c $a,c$ \u90fd\u4e3a $1$\u3002\u90a3\u4e48\u62fc\u8d77\u6765\u662f\u66f4\u4f18\u7684\uff0c\u5bf9\u6807\u7ed3\u8bba $1$\u3002\u5982\u679c $a,c$ \u4e4b\u4e2d\u6709\u4e00\u4e2a\u662f $2$ \u3002\u5c31\u8bf4\u660e\u62fc\u8d77\u6765\u7684\u8def\u5f84\u4e2d\u53ea\u6709\u4e00\u4e2a\u70b9\u6743\u662f $2$\u3002\u6839\u636e\u6211\u4eec\u521a\u521a\u63a8\u5bfc\u7684\u60c5\u51b5\uff0c\u4e00\u6761\u8def\u5f84\u4e0a\u53ea\u6709\u4e00\u4e2a\u70b9\u6743\u4e3a $2$ \u65f6\u3002\u5f53\u4e14\u4ec5\u5f53\u8fd9\u4e2a\u70b9**\u5904\u4e8e\u8def\u5f84\u4e2d\u5fc3\u65f6**\u62fc\u63a5\u8d77\u6765\u66f4\u4f18\uff08\u5373\u7ed3\u8bba $2$\uff09\u3002\n\n  \u6700\u540e\u4e00\u79cd\u60c5\u51b5\uff1a$a,c$ \u90fd\u4e3a $2$\u3002\u4e5f\u5c31\u662f\u8fd9\u6761\u94fe\u4e0a\u6709 $2$ \u4e2a\u6743\u503c\u4e3a $2$ \u7684\u70b9\u7684\u60c5\u51b5\u3002 \u90a3\u4e48\u6211\u4eec\u8bbe\u8fd9\u4e24\u4e2a\u6743\u503c\u4e3a $2$ \u7684\u70b9\u5c06\u603b\u957f\u5ea6\u4e3a $b+d+1$ \u7684\u8def\u5f84\u5212\u5206\u6210\u4e86 $3$ \u6761\u53ea\u5305\u542b\u70b9\u6743\u4e3a $1$ \u7684\u70b9\u7684\u94fe\uff0c\u5b83\u4eec\u7684\u957f\u5ea6\u5206\u522b\u4e3a $u,v,p$\u3002\u90a3\u4e48\u53ef\u80fd\u7684\u6700\u5c0f\u7684\u6743\u503c\u60c5\u51b5\u5c31\u4e3a $\\dfrac{1}{\\max(u,v,p)},\\dfrac{4}{b+d+1},\\dfrac{2}{u+v+1},\\dfrac{2}{v+p+1}$\u3002\u76f4\u63a5\u5bf9\u6bd4 $\\dfrac{1}{max(u,v,p)},\\dfrac{4}{u+v+p+2}$\u3002 \u5f97 $4\\times\\max(u,v,p)<u+v+p+2$\uff0c\u5f53\u4e14\u4ec5\u5f53 $u,v,p$ \u5168\u4e3a $1$ \u65f6\u6210\u7acb\u3002\u90a3\u4e48\u8fd9 $4$ \u4e2a\u53ef\u80fd\u7684\u503c\u5c31\u5168\u662f\u5177\u4f53\u7684\u4e86\u3002\u5206\u522b\u662f $\\dfrac{1}{1},\\dfrac{4}{5},\\dfrac{2}{3},\\dfrac{2}{3}$ \uff0c\u663e\u7136 $\\dfrac{2}{3}<\\dfrac{4}{5}$\uff0c\u6240\u4ee5\u62fc\u63a5\u8d77\u6765\u4e00\u5b9a\u4e0d\u662f\u6700\u4f18\u7684\u3002\uff08\u53ef\u4ee5\u7ed3\u5408\u4e0b\u56fe\u7406\u89e3\uff09\n\n  ![](https://cdn.luogu.com.cn/upload/image_hosting/raqo1smh.png)\n\n\u200b    \u7efc\u4e0a\u6240\u8ff0\uff0c\u6211\u4eec\u5728\u6587\u7ae0\u4e00\u5f00\u59cb\u63d0\u51fa\u7684\u4e09\u4e2a\u7ed3\u8bba\u6210\u7acb\u3002\n\n---\n\n## \u89e3\u9898\uff1a\n\n\u200b\t\u77e5\u9053\u4e86\u7ed3\u8bba\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6839\u636e\u7ed3\u8bba\u8fdb\u884c\u6c42\u89e3\u4e86\uff0c\u90a3\u4e48\u6211\u4eec\u8981\u627e\u7684\u5c31\u662f\u4e24\u79cd\u94fe\u3002\u7b2c\u4e00\u79cd\u662f\u70b9\u6743\u5168\u662f $1$ \u7684\u3002\u7b2c\u4e8c\u79cd\u662f\u6743\u503c\u4e3a $2$ \u7684\u70b9\u5728\u94fe\u4e2d\u5fc3\u7684\u3002\n\n\u200b\t\u627e\u94fe\u7684\u5de5\u4f5c\u53ef\u4ee5\u4f7f\u7528\u6811\u5f62 dp \u6765\u6c42\u89e3\u3002\u5173\u4e8e\u6811\u5f62 dp \u7684\u5199\u6cd5\u7f51\u4e0a\u5df2\u7ecf\u6709\u5f88\u591a\u9898\u89e3\u4e86\u3002\u8fd9\u91cc\u4ecb\u7ecd\u4e00\u79cd\u70b9\u5206\u6cbb\u7684\u5199\u6cd5\u3002\n\n\u200b\t\u9996\u5148\u662f\u5173\u4e8e\u5168\u662f $1$ \u7684\u94fe\u7684\u6c42\u89e3\uff0c\u90a3\u4e48\u6211\u4eec\u5bfb\u627e\u8def\u5f84\u662f\u5c31\u53ea\u8981\u904d\u5386\u70b9\u6743\u4e3a $1$ \u7684\u70b9\u3002\u7136\u540e\u7ef4\u62a4\u8def\u5f84\u6700\u5927\u503c\u4e0e\u6b21\u5927\u503c\uff08\u6ce8\u610f\u6700\u5927\u503c\u4e0e\u6b21\u5927\u503c\u4e0d\u80fd\u5728**\u540c\u4e00\u5b50\u6811\u5185**\uff09\u3002\u5c40\u90e8\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\nvoid Get_dis(int p,int fa,int d)\n{\n\tif(val[p]!=1) return ;//\u70b9\u6743\u4e0d\u662f1\u4e0d\u7528\u8bb0\u5f55\u5230\u6570\u7ec4\u5185\n\tarr[++cnt]=d;\n\tfor(int i=0;i<e[p].size();++i)\n\t{\n\t\tint to=e[p][i];\n\t\tif(to==fa||vis[to]) continue;\n\t\tGet_dis(to,p,d+1);\n\t}\n}\nvoid solve(int p)\n{\n\tint mx[2]={},tmp=0,id[2];id[0]=id[1]=-1;\n\tfor(int i=0;i<e[p].size();++i)\n\t{\n\t\tint to=e[p][i];\n\t\tif(vis[to]) continue;\n\t\tcnt=0;Get_dis(to,p,1);tmp=0;\n\t\tfor(int j=1;j<=cnt;++j)\n\t\t\ttmp=max(tmp,arr[j]);//\u7ef4\u62a4\u5b50\u6811\u6700\u5927\u503c\n\t\tif(tmp>mx[1])//\u7ef4\u62a4\u6700\u5927\u503c\u4e0e\u6b21\u5927\u503c\n\t\t\tmx[1]=tmp;id[1]=i;\n\t\tif(mx[1]>mx[0])\n\t\t{\n\t\t\tswap(mx[1],mx[0]);\n\t\t\tswap(id[1],id[0]);\n\t\t}\n\t\tans=max(ans,mx[0]+mx[1]+1);//\u7528\u4e0d\u5728\u540c\u4e00\u5b50\u6811\u5185\u7684\u6700\u5927\u503c\u6b21\u5927\u503c\u66f4\u65b0\u7b54\u6848\n\t}\n}\n```\n\n\u200b\t\u540c\u65f6\u7684\uff0c``Get_dis`` \u8fd9\u4e2a\u51fd\u6570\u8fd8\u53ef\u4ee5\u5728\u83b7\u53d6\u5f53\u524d\u89e3\u51b3\u7684\u70b9\uff08\u5f53\u524d\u89e3\u51b3\u5b50\u6811\u7684\u91cd\u5fc3\uff09\u70b9\u6743\u4e3a $2$ \u65f6\u9700\u8981\u7684\u8def\u5f84\uff0c\u7136\u540e\u6211\u4eec\u7ef4\u62a4\u4e00\u4e0b\u6700\u957f\u7684\u4e24\u6761\u76f8\u7b49\u7684\u8def\u5f84\u5373\u53ef\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u5b9e\u73b0\u3002\n\n```cpp\nstruct Data\n{\n\tint x,y;//x\u662f\u5206\u5b50\uff0cy\u662f\u5206\u6bcd\n\tbool operator <(const Data&a) const\n\t{\n\t\treturn x*1.0/y<(a.x*1.0/a.y);\n\t}\n\tvoid print()\n\t{\n\t\tint d=gcd(x,y);\n\t\tprintf(\"%d/%d\\n\",x/d,y/d);\n\t}\n}res;\nvoid solve_(int p)\n{\n\tint mx=0;\n\tfor(int i=0;i<e[p].size();++i)\n\t{\n\t\tint to=e[p][i];\n\t\tif(vis[to]) continue;\n\t\tcnt=0;Get_dis(to,p,1);\n\t\tfor(int j=1;j<=cnt;++j)//\u56e0\u4e3a\u4e24\u4e2a\u94fe\u7684\u957f\u5ea6\u8981\u76f8\u7b49\uff0c\u6240\u4ee5\u53d6\u8f83\u5c0f\u503c\u66f4\u65b0\u7b54\u6848\u3002\n\t\t\tres=min(res,(Data){2,min(mx,arr[j])*2+1});\n\t\tfor(int j=1;j<=cnt;++j)//\u7ef4\u62a4\u4e00\u4e0b\u5df2\u7ecf\u904d\u5386\u5230\u7684\u6700\u5927\u503c\n\t\t\tmx=max(mx,arr[j]);\n\t}\n}\n```\n\n\u200b\t\u4f46\u662f\u6709\u4e00\u79cd\u53ef\u80fd\uff0c\u6211\u4eec\u5728\u89e3\u51b3\u7684\u70b9\u70b9\u6743\u662f $1$ \u4f46\u662f\u6211\u4eec\u83b7\u53d6\u7684\u94fe\u7684\u957f\u5ea6\u91cc\u9762\u6709\u70b9\u6743\u4e3a $2$ \u7684\u70b9\uff0c\u5982\u4e0b\u56fe\u8fd9\u79cd\u60c5\u51b5\uff0c$p$ \u662f\u6211\u4eec\u76ee\u524d\u5904\u7406\u7684\u70b9\uff08\u5f53\u524d\u5904\u7406\u5b50\u6811\u7684\u91cd\u5fc3\uff09\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ufjtrkse.png)\n\n\u200b\t\u6240\u4ee5\u6211\u4eec\u8fd8\u5f97\u518d\u5199\u4e00\u4e2a\u7c7b\u4f3c ``Get_dis`` \u7684\u51fd\u6570\u7528\u6765\u83b7\u53d6\u5e26\u4e00\u4e2a\u70b9\u6743\u4e3a $2$ \u7684\u70b9\u7684\u8def\u5f84\u3002\u5982\u4e0b\uff1a\n\n```cpp\nvoid Get_dis2(int p,int fa,int d,int d2,int c)\n{\n\tif(val[p]!=1&&val[p]!=2) return ;\n\tif(c>2) return ;\n\tdis[++all]={d,d2};//\u8fd9\u91cc\u7684dis\u6570\u7ec4\u662fdata\u7c7b\u578b\uff0c\u4f46\u53ea\u662f\u4e3a\u4e86\u5b58\u50a8\u4e24\u4e2a\u503c\uff0c\u53ef\u4ee5\u7528pair\u66ff\u4ee3\u3002\n\tfor(int i=0;i<e[p].size();++i)\n\t{\n\t\tint to=e[p][i];\n\t\tif(to==fa||vis[to]) continue;\n\t\tGet_dis2(to,p,c==2?d:d+1,c==2?d2+1:d2,c*val[p]);\n\t}\n}\n```\n\n\u200b\t\u81f3\u4e8e\u6839\u636e\u8def\u5f84\u6c42\u89e3\u7684\u4ee3\u7801\uff0c\u7531\u4e8e\u5f53\u524d\u5904\u7406\u7684\u70b9\uff08\u5904\u7406\u5b50\u6811\u7684\u91cd\u5fc3\uff09\u7684\u70b9\u6743\u662f $1$ \u6211\u4eec\u53ef\u4ee5\u5c06\u5b83\u4e0e\u4e0a\u9762\u7684 ``solve``\uff08\u5904\u7406\u5168\u662f $1$ \u7684\u94fe\u7684\u51fd\u6570\uff09\u5408\u5e76\u4e00\u4e0b\u3002\u5c31\u53d8\u6210\u4e86\u4e0b\u9762\u8fd9\u4e2a\u4ee3\u7801\uff1a\n\n```cpp\nvoid solve(int p)\n{\n\tint mx[2]={},tmp=0,id[2];id[0]=id[1]=-1;//\u4e0b\u9762\u8fd9\u90e8\u5206\u5c55\u793a\u8fc7\u4e86\uff0c\u53ef\u4ee5\u8df3\u8fc7\u3002\n\tfor(int i=0;i<e[p].size();++i)\n\t{\n\t\tint to=e[p][i];\n\t\tif(vis[to]) continue;\n\t\tcnt=0;Get_dis(to,p,1);tmp=0;\n\t\tfor(int j=1;j<=cnt;++j)\n\t\t\ttmp=max(tmp,arr[j]);\n\t\tif(tmp>mx[1])\n\t\t\tmx[1]=tmp;id[1]=i;\n\t\tif(mx[1]>mx[0])\n\t\t{\n\t\t\tswap(mx[1],mx[0]);\n\t\t\tswap(id[1],id[0]);\n\t\t}\n\t\tans=max(ans,mx[0]+mx[1]+1);\n\t}//\u4e0a\u9762\u8fd9\u90e8\u5206\u5c55\u793a\u8fc7\u4e86\uff0c\u53ef\u4ee5\u8df3\u8fc7\u3002\n\tfor(int i=0;i<e[p].size();++i)\n\t{\n\t\tint to=e[p][i];\n\t\tif(vis[to]) continue;\n\t\tall=0;Get_dis2(to,p,val[to]==1?1:0,0,val[to]);\n\t\tfor(int j=1;j<=all;++j)\n\t\t{\n\t\t\tint d1=dis[j].x,d2=dis[j].y;//\u4e00\u6837\uff0c\u7531\u4e8e\u5168\u4e3a1\u7684\u94fe\u7684\u957f\u5ea6\u9700\u8981\u76f8\u7b49\uff0c\u53d6\u8f83\u5c0f\u503c\u3002\n\t\t\tres=min(res,Data{2,min((i==id[0]?mx[1]:mx[0])+1+d1,d2)*2+1});\n\t\t}\n\t}\n}\n```\n\n\u200b\t\u4e0a\u8ff0\u95ee\u9898\u5230\u8fd9\u91cc\u5c31\u89e3\u51b3\u4e86\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\log(n))$\u3002~~\u52a0\u5927\u5e38\u6570\u3002~~\n\n\u200b\t\u5168\u90e8\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int MAXN = 1e6+5;\nint n,dp[MAXN],siz[MAXN],Tsiz,root,cnt,arr[MAXN],ans,val[MAXN],all;\nbool vis[MAXN];\nvector <int> e[MAXN];\nint gcd(int x,int y)\n{\n\tif(y==0) return x;\n\treturn gcd(y,x%y);\n}\nvoid Get_root(int p,int fa)\n{\n\tdp[p]=0;siz[p]=1;\n\tfor(int i=0;i<e[p].size();++i)\n\t{\n\t\tint to=e[p][i];\n\t\tif(to==fa||vis[to]) continue;\n\t\tGet_root(to,p);\n\t\tsiz[p]+=siz[to];\n\t\tdp[p]=max(siz[to],dp[p]);\n\t}\n\tdp[p]=max(dp[p],Tsiz-siz[p]);\n\tif(dp[p]<dp[root]) root=p;\n}\nstruct Data\n{\n\tint x,y;//x\u8868\u793a\u5206\u5b50\uff0cy\u8868\u793a\u5206\u6bcd\n\tbool operator <(const Data&a) const\n\t{\n\t\treturn x*1.0/y<(a.x*1.0/a.y);\n\t}\n\tvoid print()\n\t{\n\t\tint d=gcd(x,y);\n\t\tprintf(\"%d/%d\\n\",x/d,y/d);\n\t}\n}res,dis[MAXN];\nvoid Get_dis(int p,int fa,int d)\n{\n\tif(val[p]!=1) return ;\n\tarr[++cnt]=d;\n\tfor(int i=0;i<e[p].size();++i)\n\t{\n\t\tint to=e[p][i];\n\t\tif(to==fa||vis[to]) continue;\n\t\tGet_dis(to,p,d+1);\n\t}\n}\nvoid Get_dis2(int p,int fa,int d,int d2,int c)\n{\n\tif(val[p]!=1&&val[p]!=2) return ;\n\tif(c>2) return ;\n\tdis[++all]={d,d2};\n\tfor(int i=0;i<e[p].size();++i)\n\t{\n\t\tint to=e[p][i];\n\t\tif(to==fa||vis[to]) continue;\n\t\tGet_dis2(to,p,c==2?d:d+1,c==2?d2+1:d2,c*val[p]);\n\t}\n}\nvoid solve(int p)\n{\n\tint mx[2]={},tmp=0,id[2];id[0]=id[1]=-1;\n\tfor(int i=0;i<e[p].size();++i)\n\t{\n\t\tint to=e[p][i];\n\t\tif(vis[to]) continue;\n\t\tcnt=0;Get_dis(to,p,1);tmp=0;\n\t\tfor(int j=1;j<=cnt;++j)\n\t\t\ttmp=max(tmp,arr[j]);\n\t\tif(tmp>mx[1])\n\t\t\tmx[1]=tmp;id[1]=i;\n\t\tif(mx[1]>mx[0])\n\t\t{\n\t\t\tswap(mx[1],mx[0]);\n\t\t\tswap(id[1],id[0]);\n\t\t}\n\t\tans=max(ans,mx[0]+mx[1]+1);\n\t}\n\tfor(int i=0;i<e[p].size();++i)\n\t{\n\t\tint to=e[p][i];\n\t\tif(vis[to]) continue;\n\t\tall=0;Get_dis2(to,p,val[to]==1?1:0,0,val[to]);\n\t\tfor(int j=1;j<=all;++j)\n\t\t{\n\t\t\tint d1=dis[j].x,d2=dis[j].y;\n\t\t\tres=min(res,Data{2,min((i==id[0]?mx[1]:mx[0])+1+d1,d2)*2+1});\n\t\t}\n\t}\n}\nvoid solve_(int p)\n{\n\tint mx=0;\n\tfor(int i=0;i<e[p].size();++i)\n\t{\n\t\tint to=e[p][i];\n\t\tif(vis[to]) continue;\n\t\tcnt=0;Get_dis(to,p,1);\n\t\tfor(int j=1;j<=cnt;++j)\n\t\t\tres=min(res,(Data){2,min(mx,arr[j])*2+1});\t\n\t\tfor(int j=1;j<=cnt;++j)\n\t\t\tmx=max(mx,arr[j]);\n\t}\n}\nvoid Divide(int p)\n{\n\tvis[p]=1;\n\tif(val[p]==1) solve(p);\n\tif(val[p]==2) solve_(p);\n\tfor(int i=0;i<e[p].size();++i)\n\t{\n\t\tint to=e[p][i];\n\t\tif(vis[to]) continue;\n\t\tTsiz=siz[to];root=0;\n\t\tGet_root(to,p);\n\t\tDivide(root);\n\t}\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<n;++i)\n\t{\n\t\tint u,v;\n\t\tscanf(\"%d %d\",&u,&v);\n\t\te[u].push_back(v);\n\t\te[v].push_back(u);\n\t}\n\tfor(int i=1;i<=n;++i)\n\t\tscanf(\"%d\",&val[i]);\n\tdp[root=0]=n+1;Tsiz=n;ans=-1;res.y=1;res.x=1e9;\n\tGet_root(1,0);\n\tDivide(root);\n\tif(ans!=-1)\n\t{\n\t\tif(Data{1,ans}<res)\n\t\t\tprintf(\"1/%d\\n\",ans);\n\t\telse res.print();\t\t\t\n\t}\n\telse\n\t{\n\t\tif(res.x!=1e9)\n\t\t{\n\t\t\tres.print();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tans=1e9;\n\t\t\tfor(int i=1;i<=n;++i)\n\t\t\t\tans=min(ans,val[i]);\n\t\t\tprintf(\"%d/1\\n\",ans);\t\t\t\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n\u603b\u7ed3\uff1a\u70b9\u5206\u6cbb\uff0c\u89e3\u51b3\u6811\u4e0a\u8def\u5f84\u7684\u4e00\u79cd\u4f18\u79c0\u65b9\u6cd5\u3002\uff08\u867d\u7136\u5728\u8fd9\u9898\u5e76\u4e0d\u4f18\u79c0\uff09",
        "postTime": 1629443867,
        "uid": 141485,
        "name": "A_Sunny_Day",
        "ccfLevel": 0,
        "title": "COCI2016/2017 #1 D Mag \u70b9\u5206\u6cbb"
    },
    {
        "content": "[Blog](https://www.luogu.com.cn/blog/556362/solution-p6287)\n\n\u5f53\u6811\u4e0a\u6ca1\u6709\u6743\u4e3a $1$ \u7684\u8282\u70b9\u65f6\uff0c\u6211\u4eec\u53d6\u6700\u5c0f\u503c $v$\u3002\n\n\u8bc1\u660e\uff1a$v=\\dfrac{kv}{k}\\le\\dfrac{kv+\\Delta t}{k}$\uff0c\u53d6\u7b49\u6761\u4ef6\uff1a$\\Delta t=0$\u3002\n\n***\n\n\u5f53\u6811\u4e0a\u6709 $1$ \u7684\u70b9\u6743\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u4e00\u76f4\u5f80\u5916\u6269\u5c55\u70b9\u6743\u4e3a $1$ \u7684\u8282\u70b9\uff0c\u539f\u56e0\uff1a$\\dfrac{v}{k}>\\dfrac{v}{k+t}$\u3002\n\n\u90a3\u4e48\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u5047\u8bbe\u73b0\u5728\u662f\u8fd9\u6837\u7684\u60c5\u51b5\uff1a\n\n$$1\\rightarrow1\\rightarrow\\cdots\\rightarrow X\\rightarrow\\cdots\\rightarrow1\\rightarrow1$$\n\n\u6211\u4eec\u8bbe $1$ \u8f83\u5c11\u7684\u6709 $l$ \u4e2a $1$\uff0c\u8f83\u591a\u6709 $r$ \u4e2a $1$\uff0c\u90a3\u4e48\u5219\u6709 $1\\le l\\le r$\u3002\u90a3\u4e48\u6211\u4eec\u5f53\u4ec5\u8fd9\u79cd\u60c5\u51b5\u4e3a**\u552f\u4e00\u7684**\u6700\u4f18\u89e3\uff0c\u90a3\u4e48\u5219\u6709\uff1a$\\dfrac{X}{l+r+1}<\\dfrac{1}{r}$\uff0c\u79fb\u9879\u5f97 $(X-1)r<l+1$\uff0c\u6b64\u65f6\u6211\u4eec\u4f7f\u7528\u653e\u7f29\uff1a$l+1\\le r+1$\uff0c\u90a3\u4e48\u5982\u679c\u8981\u6ee1\u8db3 $(X-2)r<1$\uff0c\u5c31\u53ef\u4ee5\u6ee1\u8db3\u6761\u4ef6\uff0c\u5f53\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u884c\uff0c\u5f53\u4e14\u4ec5\u5f53 $X-2=0$ \u5373 $X=2$ \u65f6\u6709\u89e3\uff0c\u5e26\u56de\uff0c\u6709\uff1a$r<l+1$\uff0c\u6ce8\u610f\u5230 $l\\le r$\uff0c\u90a3\u4e48\u53ef\u4ee5\u6709\u5982\u4e0b\u7ed3\u8bba\uff1a\n\n$$l=r$$\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4e0d\u53ef\u4ee5\u52a0\u5165\u66f4\u591a\u7684\u6570\u5462\uff1f\u5982\u4e0b\uff1a\n\n$$1\\rightarrow1\\rightarrow\\cdots\\rightarrow X\\rightarrow\\cdots\\rightarrow1\\rightarrow1\\rightarrow\\cdots Y\\rightarrow\\cdots\\rightarrow1\\rightarrow1$$\n\n\u90a3\u4e48\u6b64\u65f6\u6211\u4eec\u5206\u522b\u8bbe\u4e3a $l_1,l_2,l_3$\uff0c\u7531\u4e8e $XY$ \u8981\u6700\u5c0f\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8bbe\u5b83\u4eec\u4e3a $4$\uff0c\u6709\uff1a\n\n$$\\dfrac{4}{l_1+l_2+l_3+2}>\\dfrac{2}{4l_3+2}=\\dfrac{1}{2l_3+1}$$\n\n\u90a3\u4e48\uff0c\u5f53 $l_3=l_2$ \u65f6\uff0c\u80af\u5b9a\u4e0d\u80fd\u63d2\u5165\u5143\u7d20\uff0c\u5982\u679c $l_3>l_2$\uff0c\u90a3\u4e48\u9664\u5f00\u6574\u4e2a\u5e8f\u5217\uff0c\u7531\u4e0a\u9762\u7684\u7ed3\u8bba\uff1a$\\dfrac{1}{l_3}$ \u6216 $\\dfrac{2}{l_1+l_2+1}$\uff08\u6b64\u65f6\u8981\u4fdd\u8bc1 $l_1=l_2$\uff09\u5c31\u662f\u6700\u4f18\u7684\u3002\n\n\u4f46\u662f\u6ce8\u610f\u5230 $l_1=l_2<l_3$\uff0c\u90a3\u4e48\u6211\u4eec\u6709\uff1a$l_1=l_2\\le l3-1$\uff0c\u6709\uff1a\n\n$$\\dfrac{2}{l_1+l_2+1}\\le\\dfrac{2}{2l_3-1}<\\dfrac{2}{2l_3-2}=\\dfrac{1}{l_3-1}<\\dfrac{1}{l_3}$$\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u77e5\u9053 $\\dfrac{1}{l_3}$ \u662f\u6700\u4f18\u7684\uff0c\u6211\u4eec\u5c06\u5b83\u4e0e $\\dfrac{4}{l_1+l_2+l_3+2}$ \u6bd4\u3002\n\n$\\dfrac{1}{l_3}<\\dfrac{4}{l_1+l_2+l_3+2}$ \u65f6\uff0c\u6211\u4eec\u6709\uff1a$l_1+l_2+l_3+2<4l_3$\uff0c\u4f46\u662f\u7531\u4e8e $1\\le l_1,l_1<l_3$\uff0c\u90a3\u4e48\u5219\u6709 $2\\le l_3$\uff0c\u90a3\u4e48\u6bcf\u9879\u90fd $<l_3$\uff0c\u90a3\u4e48\u5c0f\u4e8e\u53f7\u5f97\u8bc1\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u6709\u7b54\u6848\u4e3a\u70b9\u6269\u5c55 $1$ \u7684\u70b9\u7684\u94fe\u3002\n\n\u90a3\u4e48\u6ce8\u610f\u5230\u6211\u4eec\u4ece $3$ \u4e2a\u65b9\u5411\u6269\u5c55\uff1a\u5411\u4e0b\u6700\u5927\uff0c\u5411\u4e0b\u6b21\u5927\uff0c\u5411\u4e0a\uff08\u5168\u90e8\u662f $1$\uff09\u3002\n\n\u6ce8\u610f\u5230\u5411\u4e0b\u6b21\u5927\u548c\u5411\u4e0b\u6700\u5927\u4e0d\u80fd\u6765\u81ea\u540c\u4e00\u4e2a\u8282\u70b9\uff0c\u90a3\u4e48\u6211\u4eec\u5411\u4e0a\u8f6c\u79fb\u65f6\u5c31\u53ea\u9700\u8981\u8f6c\u79fb\u5411\u4e0a\u6700\u5927\u5c31\u884c\u4e86\u3002\n\n\u8865\uff1a\u53ef\u80fd\u662f\u60f3\u6cd5\u95ee\u9898\uff0c\u5411\u4e0a\u8def\u5f84\u9700\u8981\u5411\u4e0b\u8def\u5f84\uff0c\u6240\u4ee5\u8981\u5148\u6c42\u5411\u4e0b\u7684\uff0c\u7136\u540e\u518d\u6c42\u5411\u4e0a\u7684\u3002\n\n\u8fd9\u4e2a\u4ee3\u7801\u6709\u4e00\u4e2a\u4f18\u52bf\uff1a\u4e0d\u9700\u8981\u7ef4\u62a4 $2$ \u7684\u60c5\u51b5\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=1e6+5;\nint n,w[maxn],dp[maxn][2],flg[maxn][2],f[maxn],p=1e9,q=1;\nvector<int> G[maxn];\nvoid init(int u,int fa){\n\tfor(int i=0,len=G[u].size();i<len;++i){\n\t\tint v=G[u][i];\n\t\tif(v==fa)\n\t\t\tcontinue;\n\t\tinit(v,u);\n\t\tint p=(w[v]==1?dp[v][0]+1:0);\n\t\tif(p>dp[u][0])\n\t\t\tdp[u][1]=dp[u][0],flg[u][1]=flg[u][0],dp[u][0]=p,flg[u][0]=v;\n\t\telse if(p>dp[u][1])\n\t\t\tdp[u][1]=p,flg[u][1]=v;\n\t}\n}\nvoid dfs(int u,int fa){\n\tfor(int i=0,len=G[u].size();i<len;++i){\n\t\tint v=G[u][i];\n\t\tif(v==fa)\n\t\t\tcontinue;\n\t\tif(w[u]==1)\n\t\t\tf[v]=max((flg[u][0]==v?dp[u][1]:dp[u][0]),f[u])+1;\n\t\tdfs(v,u);\n\t}\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1,u,v;i<n;++i){\n\t\tscanf(\"%d%d\",&u,&v);\n\t\tG[u].push_back(v);\n\t\tG[v].push_back(u);\n\t}\n\tfor(int i=1;i<=n;++i){\n\t\tscanf(\"%d\",&w[i]);\n\t\tp=min(p,w[i]);\n\t}\n\tinit(1,0);\n\tdfs(1,0);\n\tfor(int i=1;i<=n;++i){\n\t\tif(1ll*w[i]*q<1ll*p*(dp[i][0]+max(f[i],dp[i][1])+1))\n\t\t\tp=w[i],q=dp[i][0]+max(f[i],dp[i][1])+1;\n\t\tif(q<1ll*p*max(f[i],dp[i][0]))\n\t\t\tp=1,q=max(f[i],dp[i][0]);\n\t}\n\tprintf(\"%d/%d\\n\",p/__gcd(p,q),q/__gcd(p,q));\n\treturn 0;\n}\n```",
        "postTime": 1670026209,
        "uid": 556362,
        "name": "UnnamedOrNamed",
        "ccfLevel": 5,
        "title": "P6287 [COCI2016-2017#1] Mag \u9898\u89e3"
    },
    {
        "content": "[COCI2016-2017#1\u9898\u89e3](https://www.luogu.com.cn/blog/chihik/post-2019-7-9-shu-jia-pei-xun-di-yi-ce)\n\n\u6b64\u9898\u6709\u4e00\u4e2a\u795e\u4ed9\u7ed3\u8bba\uff1a**\u6700\u4f18\u94fe\u4e0a\u6700\u591a\u5305\u542b\u4e00\u4e2a\u20182\u2019\uff0c\u4e14\u20182\u2019\u4e0d\u80fd\u5728\u94fe\u7684\u4e24\u8fb9\u3002** \u81f3\u4e8e\u8bc1\u660e\u8fc7\u4e8e\u7b80\u5355\u4f46\u5f88\u9ebb\u70e6\uff08~~\u5176\u5b9e\u662f\u6211\u61d2~~\uff09\uff0c\u7ed9\u5927\u5bb6\u63a8\u8350\u4e00\u4e2a\u535a\u5ba2\uff0c[\u70b9\u8fd9](https://www.luogu.org/blog/23j/ti-xie-ge-ren-ti-ku-u76193-mo-li-shu-post)\u3002\n\n\u6709\u4e86\u8fd9\u4e2a\u7ed3\u8bba\u4e4b\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5~~\u6109\u5feb~~\u7684\u5f00\u59cb\u6811\u5f62dp\u4e86\u3002\n\n\u6211\u4eec\u7528$dp1[u]$\u8868\u793a\u5305\u542bu\u8282\u70b9\u7684\u6700\u957f1\u94fe\uff0c$dp2[u]$\u8868\u793a\u5305\u542bu\u8282\u70b9\u7684\u542b\u4e00\u4e2a2\uff0c\u5176\u4f59\u5168\u662f1\u7684\u6700\u957f\u94fe\u3002\n\u90a3\u4e48\uff0c\u6211\u4eec\u4e0d\u96be\u5f97\u5230\uff1a\n\n1.\u5f53u\u4e3a1\u65f6\uff0c$dp1[u]=max(dp1[v])+1$\n\t\t\t$~~~~~~~~~~~~~~~~~~~~dp2[u]=max(dp2[v])+1$\n         \n2.\u5f53u\u4e3a2\u65f6\uff0c$dp2[u]=max(dp1[v])+1$\n\n\u6211\u4eec\u518d\u7528$f1_1$\u8868\u793a\u6700\u5927\u7684$dp1[v]$\u7684\u4e0b\u6807\uff0c$f1_2$\u8868\u793a\u6b21\u5927\u7684$dp1[v]$\u7684\u4e0b\u6807\uff0c$f2_1$\u8868\u793a\u6700\u5927\u7684$dp2[v]$\u7684\u4e0b\u6807\n\n\u6bcf\u6b21\u66f4\u65b0$dp1[u],dp2[u]$\u65f6\uff0c\u7ef4\u62a4\u4e0a\u8ff03\u4e2a\u503c\u3002\n\n\u6700\u540e\u6211\u4eec\u66f4\u65b0\u7b54\u6848\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u4ee5\u4e0b\u60c5\u51b5\uff1a\n\n#### 1.\u5f53u\u7684\u503c\u4e3a1\u65f6\n1.$f1_1=f2_1$\uff0c\u8bf4\u660e\u6700\u957f\u7684\u542b2\u94fe\u5305\u542b\u4e86\u6700\u957f\u76841\u94fe\uff0c\u66f4\u65b0\u7b54\u6848\u4e3a$Ans=\\frac{2}{dp1[f1_2]+dp2[f2_1]+1}$\n\n2.\u4e0d\u5b58\u5728\u8be5\u4e0a\u5173\u7cfb\u4f46\u6709\u542b2\uff0c\u66f4\u65b0\u7b54\u6848\u4e3a$Ans=\\frac{2}{dp1[f1_1]+dp2[f2_1]+1}$\n\n3.\u7b54\u6848\u7684\u94fe\u4e0d\u542b2\uff0c\u66f4\u65b0\u7b54\u6848\u4e3a$Ans=\\frac{1}{dp1[f1_1]+dp1[f1_2]+1}$\n\n#### 1.\u5f53u\u7684\u503c\u4e3a2\u65f6\n\u6700\u957f\u7684\u542b2\u94fe\u4e3a$Ans=\\frac{2}{dp1[f1_1]+dp1[f1_2]+1}$\n\n\n```cpp\n#include <cstdio>\n#include <vector>\n#include <algorithm>\n#include <iostream>\nusing namespace std;\n#define LL long long\n#define INF 1e15\n\nconst int MAXN = 1000000;\nint n,a,b;\nLL p = INF , q = 1 , Mag[ MAXN + 5 ];\nvector< int > Graph[ MAXN + 5 ];\n\nvoid update( LL a , LL b ) {\n\tif( a * q < b * p ) p = a , q = b;\t\t//\u66f4\u65b0\u65f6\u4e3a\u4e86\u907f\u514d\u9664\u6cd5\uff0c\u79fb\u9879\u53d8\u4e3a\u4e58\u6cd5\n\treturn;\n}\nLL f1[ MAXN + 5 ] , f2[ MAXN + 5 ];\nvoid dfs( int u , int fa ) {\n\tint f1_1 = 0 , f1_2 = 0 , f2_1 = 0;\n\tif( Mag[ u ] == 1 ) f1[ u ] = 1;\n\tif( Mag[ u ] == 2 ) f2[ u ] = 1;\n\t\n\tfor( int i = 0 ; i < Graph[ u ].size( ) ; i ++ ) {\n\t\tint v = Graph[ u ][ i ];\n\t\tif( v == fa ) continue;\n\t\tdfs( v , u );\n\t\t\n\t\tif( Mag[ u ] == 1 ) {\n\t\t\tf1[ u ] = max( f1[ u ] , f1[ v ] + 1 );\n\t\t\tf2[ u ] = max( f2[ u ] , f2[ v ] + 1 );\n\t\t}\n\t\telse if( Mag[ u ] == 2 )\n\t\t\tf2[ u ] = max( f2[ u ] , f1[ v ] + 1 );\n\t\t\n\t\tif( f1[ f1_1 ] < f1[ v ] ) {\n\t\t\tf1_2 = f1_1;\n\t\t\tf1_1 = v;\n\t\t}\n\t\telse if( f1[ f1_2 ] < f1[ v ] )\n\t\t\tf1_2 = v;\n\t\tif( f2[ f2_1 ] < f2[ v ] )\n\t\t\tf2_1 = v;\n\t}\n\tif( Mag[ u ] == 1 ) {\n\t\tif( f1_1 == f2_1 )\n\t\t\tupdate( 2 , f1[ f1_2 ] + f2[ f2_1 ] + 1 );\n\t\telse\n\t\t\tupdate( 2 , f1[ f1_1 ] + f2[ f2_1 ] + 1 );\n\t\tupdate( 1 , f1[ f1_1 ] + f1[ f1_2 ] + 1 );\n\t}\n\tif( Mag[ u ] == 2 )\n\t\tupdate( 2 , f1[ f1_1 ] + f1[ f1_2 ] + 1 );\n}\nint main( ) {\n\tscanf(\"%d\",&n);\n\tfor( int i = 1 ; i <= n - 1 ; i ++ ) {\n\t\tscanf(\"%d %d\",&a,&b);\n\t\tGraph[ a ].push_back( b );\n\t\tGraph[ b ].push_back( a );\n\t}\n\tfor( int i = 1 ; i <= n ; i ++ ) {\n\t\tscanf(\"%lld\",&Mag[ i ]);\n\t\tp = min( Mag[ i ] , p );\n\t}\n\tdfs( 1 , 0 );\n\t\n\tLL r = __gcd( p , q );\n\tprintf(\"%lld/%lld\\n\", p / r , q / r );\n\treturn 0;\n}\n```",
        "postTime": 1595997360,
        "uid": 123802,
        "name": "chihik",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6287 \u3010[COCI2016-2017#1] Mag\u3011"
    },
    {
        "content": "### \u6811\u5f84 \uff08\u8bc1\u660e\u5728\u6587\u672b\uff09\n\n```Hint #1```\n\n\u6ce8\u610f\u6743\u503c\u4e3a $1$ \u7684\u70b9\u3002\n\n```Hint #2```\n\n\u4ec0\u4e48\u60c5\u51b5\u4e0b\u4f1a\u9009\u6743\u503c $\\ge 3$ \u7684\u70b9\uff1f\n\n\u5982\u679c\u6709\u6743\u503c\u4e3a $1$ \u7684\u70b9\uff0c\u4f1a\u9009\u6743\u503c $\\ge 3$ \u7684\u70b9\u5417\uff1f\n\n```Hint #3```\n\n\u6743\u503c\u4e3a $2$ \u7684\u70b9\u6700\u591a\u9009 $1$ \u6b21\u3002\n\n### Solution\n\n\u5982\u679c\u6ca1\u6709\u6743\u503c\u4e3a $1$ \u7684\u70b9\uff0c\u4ee4 $A=\\min($ \u70b9\u6743 $)$\uff0c$\\text{Ans}=A$\u3002\n\n\u5982\u679c\u6709\u6743\u503c\u4e3a $1$ \u7684\u70b9\uff1a\n\n\u9996\u5148\u731c\u60f3\u53ea\u4f7f\u7528\u7ecf\u8fc7\u6743\u503c\u4e3a $1$ \u7684\u70b9\u7684\u8def\u5f84\u3002\n\n\u91cd\u5efa\u6811\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8fde\u901a\u5757\u8dd1\u76f4\u5f84\u5373\u53ef\u3002\n\n\u5b9e\u6d4b $60$ \u5206\u3002\n\n\u663e\u7136\u8fd9\u4e0d\u6b63\u786e\u3002\n\n\u7ed9\u51fa\u4e00\u7ec4 $\\text{hack}$ \u6570\u636e\uff1a\n\n```Input:```\n\n```cpp\n7\n1 2\n2 3\n3 4\n4 5\n5 6\n6 7\n1 1 1 2 1 1 1\n```\n\n```Output:```\n\n```cpp\n2/7\n```\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u7ecf\u8fc7\u6743\u503c\u4e3a $2$ \u7684\u70b9\uff0c\u53ef\u80fd\u5f97\u51fa\u66f4\u4f18\u89e3\u3002\n\n\u53ef\u4ee5\u8bc1\u660e\u6743\u503c\u4e3a $2$ \u7684\u70b9\u6700\u591a\u7ecf\u8fc7\u4e00\u6b21\u3002\n\n$\\text{dp}$ \u6c42\u51fa\u4ece\u6bcf\u4e2a\u70b9\u51fa\u53d1\u53ea\u7ecf\u8fc7\u6743\u503c\u4e3a $1$ \u7684\u70b9\u7684\u6700\u957f\u8def\u5f84\u957f\u5ea6\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u6743\u503c\u4e3a $2$ \u7684\u70b9\u8fde\u8fb9\u6c42\u89e3\u5373\u53ef\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nint n,p1[1000006],p2[1000006],val[1000006],vis[1000006],len,len2,ans=0,pans=1e9,tg=0,dp1[1000006];\nvector<int>v[1000006];\nvoid dfs1(int x,int l)\n{\n\tvis[x]=1;\n\tfor(int i=0;i<v[x].size();i++)\n\t{\n\t\tif(v[x][i]!=l)\n\t\t{\n\t\t\tdfs1(v[x][i],x);\n\t\t\tdp1[x]=max(dp1[x],dp1[v[x][i]]);\n\t\t}\n\t}\n\tdp1[x]++;\n}\nvoid dfs2(int x,int l,int fr)\n{\n\tint p1=max(0ll,fr-1),p2=0;\n\tdp1[x]=max(dp1[x],fr); \n\tfor(int i=0;i<v[x].size();i++)\n\t{\n\t\tif(v[x][i]!=l)\n\t\t{\n\t\t\tif(dp1[v[x][i]]>p1)\n\t\t\tp2=p1,p1=dp1[v[x][i]];\n\t\t\telse if(dp1[v[x][i]]>p2)\n\t\t\tp2=dp1[v[x][i]];\n\t\t}\n\t}\n\tfor(int i=0;i<v[x].size();i++)\n\t{\n\t\tif(v[x][i]!=l)\n\t\tdfs2(v[x][i],x,(dp1[v[x][i]]==p1?p2:p1)+2);\n\t}\n}\npair<int,int>rans;\npair<int,int>min2(pair<int,int>xx,pair<int,int>yy)\n{\n\tif(xx.first*yy.second<xx.second*yy.first)\n\treturn xx;\n\telse return yy;\n}\nsigned main()\n{\n\tcin>>n;\n\tfor(int i=1;i<n;i++)\n\tscanf(\"%lld%lld\",&p1[i],&p2[i]);\n\tfor(int i=1;i<=n;i++)\n\tscanf(\"%lld\",&val[i]),pans=min(pans,val[i]);\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tif(val[p1[i]]==1&&val[p2[i]]==1)\n\t\tv[p1[i]].push_back(p2[i]),v[p2[i]].push_back(p1[i]);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif((!vis[i])&&val[i]==1)\n\t\t{\n\t\t\tlen=len2=-1;\n\t\t\tdfs1(i,-1);\n\t\t\tdfs2(i,-1,1);\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)\n\tans=max(ans,dp1[i]);\n\trans=min2({pans,1},{1,ans});\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tv[p1[i]].push_back(p2[i]);\n\t\tv[p2[i]].push_back(p1[i]);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(val[i]==2)\n\t\t{\n\t\t\tint p1=0,p2=0;\n\t\t\tfor(int j=0;j<v[i].size();j++)\n\t\t\t{\n\t\t\t\tif(dp1[v[i][j]]>p1)\n\t\t\t\tp2=p1,p1=dp1[v[i][j]];\n\t\t\t\telse if(dp1[v[i][j]]>p2)\n\t\t\t\tp2=dp1[v[i][j]];\n\t\t\t}\n\t\t\trans=min2(rans,{2,p1+p2+1});\n\t\t}\n\t}\n\tcout<<rans.first/__gcd(rans.first,rans.second)<<\"/\"<<rans.second/__gcd(rans.first,rans.second)<<endl; \n\treturn 0;\n}\n```\n\n### \u8bc1\u660e\n\n\u5047\u5982\u6709\u6743\u503c\u4e3a $1$ \u7684\u70b9\uff1a\n\n\u663e\u7136 $\\text{Ans}\\le 1$\u3002\n\n\u5982\u679c\u4e00\u6761\u8def\u5f84\u6709\u6743\u503c\u8d85\u8fc7 $2$ \u7684\u70b9\uff1a\n\n\u5047\u8bbe\u8fd9\u6761\u8def\u5f84\u662f\u8fd9\u6837\u7684\uff1a\n\n${1,1,1,\\dots,3,\\dots,1,1,1}$\n\n$3$ \u524d\u9762\u7684 $1$ \u6709 $x$ \u4e2a\uff0c\u540e\u9762\u7684 $1$ \u6709 $y$ \u4e2a\u3002\n\n\u663e\u7136\u6709\u4e00\u89e3\u4e3a $1/x$\uff0c\u6709\u4e00\u89e3\u4e3a $1/y$\uff0c\u603b\u5e8f\u5217\u89e3\u4e3a $3/(x+y+1)$\u3002\n\n\u4ee4 $a=\\operatorname{Max}(x,y)$\uff0c\u663e\u7136 $2a\\ge (x+y),3a\\ge (x+y+1)$\uff0c\u56e0\u4e3a $a \\ge 1$\u3002\n\n\u4e8e\u662f\u4e0d\u96be\u5f97\u51fa\u7ed3\u8bba\uff0c\u53d6\u4efb\u4f55\u542b $3$ \u53ca\u4ee5\u4e0a\u6570\u7684\u957f\u5ea6 $\\ge 2$ \u7684\u8def\u5f84\u4e0d\u4f18\u3002\n\n\n\u5982\u679c\u4e00\u6761\u8def\u5f84\u6709\u6743\u503c\u7b49\u4e8e $2$ \u7684\u70b9\uff1a\n\n${1,1,1,\\dots,2,1,1,1,\\dots,2,1,1,1,\\dots,1,1,1}$\n\n$3$ \u524d\u9762\u7684 $1$ \u6709 $x$ \u4e2a\uff0c\u4e2d\u95f4\u7684 $1$ \u6709 $y$ \u4e2a\uff0c\u7ed3\u5c3e\u7684 $1$ \u6709 $z$ \u4e2a\u3002\n\n\u663e\u7136\u6709\u4e00\u89e3\u4e3a $1/x$ , \u6709\u4e00\u89e3\u4e3a $1/y$ , \u6709\u4e00\u89e3\u4e3a $1/z$ , \u603b\u5e8f\u5217\u89e3\u4e3a $4/(x+y+z+2)$\u3002\n\n\u4ee4 $a=\\operatorname{Max}(x,y,z)$\uff0c\u663e\u7136\u5f53 $a \\ge 1$ \u65f6\uff0c$4a\\ge (x+y+z+2)$\u3002\n\n\u5f53 $a=1,min(x,y,z)=0$ \u65f6\uff0c\u663e\u7136 $4a\\ge (x+y+z+2)$\u3002\n\n\u5f53 $a=1,min(x,y,z)=1$ \u65f6\uff0c\u5e8f\u5217 ${1,2,1}(2/3)$ \u4f18\u4e8e\u5e8f\u5217 ${1,2,1,2,1}(4/5)$\u3002\n\n\u6240\u4ee5\uff0c\u542b\u6709\u8d85\u8fc7\u4e00\u4e2a\u6743\u503c\u4e3a $2$ \u7684\u8282\u70b9\u7684\u8def\u5f84\u4e5f\u4e0d\u4f18\u3002\n\n\u8bc1\u6bd5\u3002",
        "postTime": 1660575605,
        "uid": 274271,
        "name": "_xinyu1113",
        "ccfLevel": 7,
        "title": "P6287 [COCI2016-2017#1] Mag"
    },
    {
        "content": "[\u539f\u535a\u5ba2\u98df\u7528\u66f4\u4f73](https://www.cnblogs.com/C202202chenkelin/p/14035444.html)\n## \u601d\u8def\n\u9996\u5148\u6765\u8bc1\u660e\u4e00\u70b9\u3002\u6ee1\u8db3\u9898\u610f\u7684\u6700\u4f18\u89e3\u4e00\u5b9a\u4e3a\u7531\u5168\u90e8\u662f1\uff0c\u6216\u4ec5\u542b\u67091\u4e2a2\u7684\u94fe\u6765\u7ec4\u6210\u7684\uff08\u5f53\u4e14\u4ec5\u5f532\u4e24\u8fb9\u7684\uff09\u3002\n\n\u8bc1\u660e\uff1a\n* \u5f53$a=b$\u65f6\uff0c\u542b\u67092\u7684\u94fe\u7684\u4ef7\u503c\u4e3a\uff1a$\\frac{2}{a+b+1}=\\frac{2}{2a +1}$\uff0c\u800c\u4e0d\u542b\u67092\u7684\u94fe\u4ef7\u503c\u4e3a$\\frac{1}{a}$\uff0c\u5f88\u660e\u663e\uff0c\u542b\u6709\u4e8c\u7684\u94fe\u6bd4\u542b\u67091\u7684\u94fe\u4f18\u3002\n* \u5f53$a\u2260b$\u65f6\uff0c\u4e0d\u59a8\u8bbe$a\uff1eb$\uff0c\u8bbe$a-b=k$\uff0c\u542b\u67092\u7684\u94fe\u4ef7\u503c\u4e3a$\\frac{2}{a+b+1}=\\frac{2}{2a-k +1}$\uff0c\u800c\u542b1\u7684\u94fe\u4e3a$\\frac{1}{a-k}=\\frac{2}{2a-2k}$\uff0c\u660e\u663e\u542b\u67091\u7684\u94fe\u66f4\u4f18\u3002\u57281\u94fe\u548c1\u94fe\u4e2d\u6dfb\u52a0\u4efb\u610f\u4e00\u4e2a\u5927\u4e8e2\u7684\u6570\uff0c\u5219\u90fd\u4f1a\u4e0a\u8ff0\u60c5\u51b5\u4e00\u6837\uff0c\u6ca1\u6709\u542b1\u7684\u94fe\u66f4\u4f18\uff0c\u53ef\u4ee5\u4ee5\u4e0a\u8ff0\u60c5\u51b5\u6765\u63a8\u5e7f\u3002\n\n\u6709\u4e86\u4e0a\u8ff0\u7684\u8bc1\u660e\uff0c\u5c31\u53ef\u4ee5\u8fdb\u884c\u6811\u5f62DP\u4e86\u3002\u5c31\u79f0\u53ea\u542b\u67091\u7684\u94fe\u4e3a1\u94fe\uff0c\u5176\u4e2d\u542b\u4e86\u4e00\u76841\u94fe\u4e3a2\u94fe\u3002\n\n\u8bbe$dp[i][0|1][0|1]$\u7684\u7b2c\u4e00\u7ef4\u8868\u793a\u662f\u54ea\u4e00\u4e2a\u8282\u70b9\u7684\u72b6\u6001\u3002\u5bf9\u5e94\u7684\u4ef7\u503c\u6700\u5c0f\u3002\u7b2c\u4e8c\u7ef4\u8868\u793a\u8be5\u8282\u70b9\u53c2\u4e0e\u7684\u94fe\u4e2d\u662f\u5426\u542b\u67092\u8fd9\u4e2a\u70b9\uff0c\u82e5\u542b\u67092\uff0c\u5219\u8be5\u7ef4\u5ea6\u5bf9\u5e94\u503c\u4e3a0\uff0c\u5426\u5219\u4e3a1\u3002\u7b2c\u4e09\u7ef4\u8868\u793a\u5206\u5b50\u5206\u6bcd\uff0c1\u4e3a\u5206\u5b50\uff0c0\u4e3a\u5206\u6bcd\u3002\n\n$sec[0|1][0|1]$\u5bf9\u5e94\u7684\u662f\u6b21\u5c0f\u503c\u3002\u5176\u4e2d\u7684\u7b2c\u4e00\u7ef4\u4e0e$dp[i]$\u7684\u7b2c\u4e8c\u7ef4\u610f\u4e49\u76f8\u540c\uff0c\u7b2c\u4e8c\u7ef4\u4e0e\u5176\u7b2c\u4e09\u7ef4\u76f8\u540c\u3002\n\n$id[0|1][0|1]$\u7684\u7b2c\u4e00\u7ef4\u8868\u793a\u8be5\u8282\u70b9\u53c2\u4e0e\u7684\u94fe\u4e2d\u662f\u5426\u542b\u67092\u8fd9\u4e2a\u70b9\uff0c\u82e5\u542b\u67092\uff0c\u5219\u8be5\u7ef4\u5ea6\u5bf9\u5e94\u503c\u4e3a0\uff0c\u5426\u5219\u4e3a1\u3002\u7b2c\u4e8c\u7ef4\u8868\u793a\u6700\u5c0f\u4e00\u6b21\u5bf9\u5e94\u6b21\u5c0f\u4e0e\u6700\u5c0f\u3002\n\n\u5148\u6765\u8bf4\u8bf4\u5982\u4f55\u72b6\u6001\u8f6c\u79fb\u3002\n\n\u5982\u4e0b\u9762\u7684\u4ee3\u7801\u6240\u793a\uff08\u4e3b\u4f53\u90e8\u5206\uff09\u3002\n\n```cpp\nfor(int i = 0; i < SIZ; i++) {\n\tint next = v[now][i];\n\tif(next == fa)\n\t\tcontinue;\n\tDP(next, now);\n\tif(val[now] == 1) {\n\t\tif(val[next] > 2)\n\t\t\tcontinue;\n\t\tdouble son1 = (dp[next][1][1] * 1.0) / ((dp[next][1][0] + 1) * 1.0);\n\t\tdouble son2 = (dp[next][0][1] * 1.0) / ((dp[next][0][0] + 1) * 1.0);\n\t\tdouble self1 = (dp[now][1][1] * 1.0) / (dp[now][1][0] * 1.0);\n\t\tdouble self2 = (dp[now][0][1] * 1.0) / (dp[now][0][0] * 1.0);\n\t\tdouble num1 = (sec[1][1] * 1.0) / (sec[1][0] * 1.0);\n\t\tdouble num2 = (sec[0][1] * 1.0) / (sec[0][0] * 1.0);\n\t\tif(son1 < self1) {\n\t\t\tsec[1][1] = dp[now][1][1];\n\t\t\tsec[1][0] = dp[now][1][0];\n\t\t\tid[1][0] = id[1][1];\n\t\t\tdp[now][1][1] = dp[next][1][1];\n\t\t\tdp[now][1][0] = dp[next][1][0] + 1;\n\t\t\tid[1][1] = next;\n\t\t}\n\t\telse if(son1 < num1) {\n\t\t\tid[1][0] = next;\n\t\t\tsec[1][1] = dp[next][1][1];\n\t\t\tsec[1][0] = dp[next][1][0] + 1;\n\t\t}\n\t\tif(son2 < self2) {\n\t\t\tsec[0][1] = dp[now][0][1];\n\t\t\tsec[0][0] = dp[now][0][0];\n\t\t\tid[0][0] = id[0][1];\n\t\t\tdp[now][0][1] = dp[next][0][1];\n\t\t\tdp[now][0][0] = dp[next][0][0] + 1;\n\t\t\tid[0][1] = next;\n\t\t}\n\t\telse if(son2 < num2) {\n\t\t\tsec[0][1] = dp[next][0][1];\n\t\t\tsec[0][0] = dp[next][0][0] + 1;\n\t\t\tid[0][0] = next;\n\t\t}\n\t}\n\telse if(val[now] == 2) {\n\t\tif(val[next] != 1)\n\t\t\tcontinue;\n\t\tdouble son = (dp[next][1][1] * 2.0) / ((dp[next][1][0] + 1) * 1.0);\n\t\tdouble self = (dp[now][0][1] * 1.0) / (dp[now][0][0] * 1.0);\n\t\tdouble num = (sec[0][1] * 1.0) / (sec[0][0] * 1.0);\n\t\tif(son < self) {\n\t\t\tsec[0][1] = dp[now][0][1];\n\t\t\tsec[0][0] = dp[now][0][0];\n\t\t\tid[0][0] = id[0][1];\n\t\t\tdp[now][0][1] = dp[next][1][1] * 2;\n\t\t\tdp[now][0][0] = dp[next][1][0] + 1;\n\t\t\tid[0][1] = next;\n\t\t}\n\t\telse if(son < num) {\n\t\t\tsec[0][1] = dp[next][1][1] * 2;\n\t\t\tsec[0][0] = dp[next][1][0] + 1;\n\t\t\tid[0][0] = next;\n\t\t}\n\t}\n}\n```\n### \u60c5\u51b5\u4e00\n\u8bbe\u5f53\u524d\u6b63\u5728\u904d\u5386\u7684\u8282\u70b9\u4e3anow\uff0c\u5bf9\u4e8enow\u7684\u6bcf\u4e00\u4e2a\u5b50\u8282\u70b9next\uff0c\u82e5\u6709now\u7684\u6743\u503c\u4e3a1\uff0c\u5219\u6709\uff1a\n\n* son1\uff1a\u5f53\u524d\u5b50\u8282\u70b9\u5e26\u6709\u7684\u6700\u5c0f1\u94fe\u52a0\u4e0a\u7236\u8282\u70b9\u7684\u4ef7\u503c\u3002\n* son2\uff1a\u5f53\u524d\u5b50\u8282\u70b9\u5e26\u6709\u7684\u6700\u5c0f2\u94fe\u52a0\u4e0a\u7236\u8282\u70b9\u7684\u4ef7\u503c\u3002\n* self1\uff1a\u6700\u5c0f1\u94fe\u7684\u4ef7\u503c\u3002\n* self2\uff1a\u6700\u5c0f2\u94fe\u7684\u4ef7\u503c\u3002\n* num1\uff1a\u6b21\u5c0f1\u94fe\u7684\u4ef7\u503c\u3002\n* num2\uff1a\u6b21\u5c0f2\u94fe\u7684\u4ef7\u503c\u3002\n\n\u82e5next\u7684\u6743\u503c\u5927\u4e8e2\uff0c\u5219\u6ca1\u6709\u8d44\u683c\u66f4\u65b0\u81ea\u5df1\u7684\u7236\u8282\u70b9\u3002\u9700\u8981\u5148\u5224\u65ad\u662f\u5426\u6709\u8d44\u683c\u66f4\u65b0\u7236\u8282\u70b9\u7684\u503c\u3002\n```cpp\nif(val[next] > 2)\n\tcontinue;\n```\n\u53c8\u6709\u51e0\u79cd\u60c5\u51b5\uff1a\n* \u5f53son1 < self1\u65f6\uff0c\u5373\u662f\u5f53\u524d\u5b50\u8282\u70b9\u76841\u94fe\u53ef\u4ee5\u66f4\u65b0\u6700\u5c0f\u94fe\u76841\u94fe\u3002\u5148\u4f7f\u7528\u6700\u5c0f1\u94fe\u6765\u66f4\u65b0\u6b21\u5c0f1\u94fe\u7684\u503c\u3002\u5728\u4f7f\u7528\u5b50\u8282\u70b9\u6765\u66f4\u65b0\u6700\u5c0f1\u94fe\u7684\u503c\u3002\u4ee3\u7801\u5982\u4e0b\u3002\n```cpp\nif(son1 < self1) {\n\tsec[1][1] = dp[now][1][1];\n\tsec[1][0] = dp[now][1][0];\n\tid[1][0] = id[1][1];\n\tdp[now][1][1] = dp[next][1][1];\n\tdp[now][1][0] = dp[next][1][0] + 1;\n\tid[1][1] = next;\n}\n```\n* \u5728\u4e0d\u6ee1\u8db3\u4e0a\u8ff0\u60c5\u51b5\u65f6\uff0c\u5f53\u524d\u5b50\u8282\u70b9\u4ec5\u4ec5\u53ea\u80fd\u66f4\u65b0\u6b21\u5c0f\u94fe\u7684\u503c\uff0c\u90a3\u4e48\u5c31\u7528\u6b21\u5c0f\u94fe\u66f4\u65b0\u6700\u5c0f\u94fe\u7684\u503c\u3002\u4ee3\u7801\u5982\u4e0b\u3002\n```cpp\nelse if(son1 < num1) {\n\tid[1][0] = next;\n\tsec[1][1] = dp[next][1][1];\n\tsec[1][0] = dp[next][1][0] + 1;\n}\n```\n* \u66f4\u65b0\u6700\u5c0f\u4e8c\u94fe\u4e0e\u6700\u6b21\u5c0f\u4e8c\u94fe\uff0c\u4e0e\u66f4\u65b01\u94fe\u7684\u65b9\u6cd5\u76f8\u4f3c\u3002\u66f4\u65b0\u6700\u5c0f2\u94fe\u7684\u4ee3\u7801\u5982\u4e0b\u3002\n```cpp\nif(son2 < self2) {\n\tsec[0][1] = dp[now][0][1];\n\tsec[0][0] = dp[now][0][0];\n\tid[0][0] = id[0][1];\n\tdp[now][0][1] = dp[next][0][1];\n\tdp[now][0][0] = dp[next][0][0] + 1;\n\tid[0][1] = next;\n}\n```\n* \u66f4\u65b0\u6b21\u5c0f2\u94fe\u7684\u4ef7\u503c\n```cpp\nelse if(son2 < num2) {\n\tsec[0][1] = dp[next][0][1];\n\tsec[0][0] = dp[next][0][0] + 1;\n\tid[0][0] = next;\n}\n```\n### \u60c5\u51b5\u4e8c\n\u8bbe\u5f53\u524d\u6b63\u5728\u904d\u5386\u7684\u8282\u70b9\u4e3anow\uff0c\u5bf9\u4e8enow\u7684\u6bcf\u4e00\u4e2a\u5b50\u8282\u70b9next\uff0c\u82e5\u6709now\u7684\u6743\u503c\u4e3a2\u3002\u56e0\u4e3a\u8fd9\u6761\u94fe\u4e2d\u5fc5\u4f1a\u67092\uff0c\u6240\u4ee5\u5c31\u4e0d\u9700\u8981\u8003\u8651\u66f4\u65b01\u94fe\u7684\u4ef7\u503c\u3002\u5219\u6709\uff1a\n* son\uff1a\u5f53\u524d\u5b50\u8282\u70b9\u5e26\u6709\u7684\u6700\u5c0f1\u94fe\u52a0\u4e0a\u7236\u8282\u70b9\u7684\u4ef7\u503c\u3002\n* self2\uff1a\u6700\u5c0f2\u94fe\u7684\u4ef7\u503c\u3002\n* num\uff1a\u6b21\u5c0f2\u94fe\u7684\u4ef7\u503c\u3002\n\n\u82e5\u5f53\u524d\u5b50\u8282\u70b9\u7684\u5b50\u8282\u70b9\u7684\u6743\u503c\u4e0d\u4e3a1\uff0c\u5219\u4e5f\u6ca1\u6709\u8d44\u683c\u66f4\u65b0\u7236\u8282\u70b9\u3002\n```cpp\nif(val[next] != 1)\n\tcontinue;\n```\n\u66f4\u65b0\u65b9\u5f0f\u4e0e\u4e0a\u8ff0\u76f8\u540c\u3002\n\n\u4f46\u6700\u5c0f2\u94fe\u53ea\u80fd\u7531\u513f\u5b50\u76841\u94fe\u6765\u66f4\u65b0\uff0c\u56e0\u4e3a\u4e00\u67612\u94fe\u4e2d\u53ea\u80fd\u542b\u67091\u4e2a2\uff0c\u800c\u5f53\u524d\u8282\u70b9\u5c31\u662f2\u3002\n\n* \u66f4\u65b0\u6700\u5c0f\n```cpp\nif(son < self) {\n\tsec[0][1] = dp[now][0][1];\n\tsec[0][0] = dp[now][0][0];\n\tid[0][0] = id[0][1];\n\tdp[now][0][1] = dp[next][1][1] * 2;\n\tdp[now][0][0] = dp[next][1][0] + 1;\n\tid[0][1] = next;\n}\n```\n* \u66f4\u65b0\u6b21\u5c0f\n```cpp\nelse if(son < num) {\n\tsec[0][1] = dp[next][1][1] * 2;\n\tsec[0][0] = dp[next][1][0] + 1;\n\tid[0][0] = next;\n}\n```\n### \u73b0\u5728\u6765\u66f4\u65b0\u7b54\u6848\n\u53c8\u5206\u4e86\u51e0\u79cd\u60c5\u51b5\n* \u53ea\u7528\u6700\u5c0f2\u94fe\u3002\u82e5\u5f53\u524d\u7236\u8282\u70b9\u53ea\u542b\u67091\u4e2a\u5b50\u8282\u70b9\uff0c\u5219\u53ea\u67091\u6761\u94fe\u6765\u66f4\u65b0\u7b54\u6848\u3002\n```cpp\ndouble Num = (dp[now][0][1] * 1.0) / (dp[now][0][0] * 1.0);\nif(Num < ans) {\n\tans = Num;\n\tans1 = dp[now][0][1];\n\tans2 = dp[now][0][0];\n}\n```\n* \u53ea\u7528\u6700\u5c0f1\u94fe\uff0c\u7406\u7531\u4e0e2\u94fe\u76f8\u540c\u3002\n```cpp\nNum = (dp[now][1][1] * 1.0) / (dp[now][1][0] * 1.0);\nif(Num < ans) {\n\tans = Num;\n\tans1 = dp[now][1][1];\n\tans2 = dp[now][1][0];\n}\n```\n* \u6700\u957f1\u94fe\u52a0\u6700\u957f2\u94fe\u3002\u5f53\u4e14\u4ec5\u5f53\u6700\u5c0f2\u94fe\u4e0e\u6700\u5c0f1\u94fe\u6765\u81ea\u4e8e\u4e0d\u540c\u7684\u5b50\u8282\u70b9\u3002\n```cpp\nif(id[1][1] != id[0][1]) {\n\tNum = ((dp[now][0][1] * dp[now][1][1]) * 1.0) / ((dp[now][0][0] + dp[now][1][0] - 1) * 1.0);\n\tif(Num < ans) {\n\t\tans = Num;\n\t\tans1 = dp[now][0][1] * dp[now][1][1];\n\t\tans2 = dp[now][0][0] + dp[now][1][0] - 1;\n\t}\n}\n```\n* \u82e5\u4e0d\u6ee1\u8db3\u6700\u5c0f2\u94fe\u4e0e\u6700\u5c0f1\u94fe\u6765\u81ea\u4e8e\u4e0d\u540c\u7684\u5b50\u8282\u70b9\uff0c\u5219\u4f7f\u7528\u6b21\u5c0f1\uff0c2\u94fe\u4e0e\u6700\u5c0f2\uff0c1\u94fe\u76f8\u7ed3\u5408\u6765\u66f4\u65b0\u7b54\u6848\uff08\u6ce8\u610f\u987a\u5e8f\uff09\u3002\n```cpp\nelse {\n\tif(id[1][0] != id[0][1]) {\n\t\tNum = ((dp[now][0][1] * sec[1][1]) * 1.0) / ((dp[now][0][0] + sec[1][0] - 1) * 1.0);\n\t\tif(Num < ans) {\n\t\t\tans = Num;\n\t\t\tans1 = dp[now][0][1] * sec[1][1];\n\t\t\tans2 = dp[now][0][0] + sec[1][0] - 1;\n\t\t}\n\t}\n\tif(id[0][0] != id[1][1]) {\n\t\tNum = ((sec[0][1] * dp[now][1][1]) * 1.0) / ((sec[0][0] + dp[now][1][0] - 1) * 1.0);\n\t\tif(Num < ans) {\n\t\t\tans = Num;\n\t\t\tans1 = sec[0][1] * dp[now][1][1];\n\t\t\tans2 = sec[0][0] + dp[now][1][0] - 1;\n\t\t}\n\t}\n}\n```\n* \u7528\u6700\u5c0f1\u94fe\u4e0e\u6b21\u5c0f1\u94fe\u6765\u66f4\u65b0\u7b54\u6848\u3002\n```cpp\nNum = ((dp[now][1][1] * sec[1][1]) * 1.0) / ((dp[now][1][0] + sec[1][0] - 1) * 1.0);\nif(Num < ans) {\n\tans = Num;\n\tans1 = dp[now][1][1] * sec[1][1];\n\tans2 = dp[now][1][0] + sec[1][0] - 1;\n}\n```\n## \u8f93\u51fa\n\u8bb0\u5f97\u5206\u5b50\u5206\u6bcd\u9700\u8981\u4e92\u8d28\u3002\n## C++\u4ee3\u7801\n```cpp\n#include <cstdio>\n#include <vector>\nusing namespace std;\n#define INF 1e8\n#define Min(a, b) ((a) < (b) ? (a) : (b))\nvoid Quick_Read(int &N) {\n\tN = 0;\n\tchar c = getchar();\n\tint op = 1;\n\twhile(c < '0' || c > '9') {\n\t\tif(c == '-')\n\t\t\top = -1;\n\t\tc = getchar();\n\t}\n\twhile(c >= '0' && c <= '9') {\n\t\tN = (N << 1) + (N << 3) + c - 48;\n\t\tc = getchar();\n\t}\n\tN *= op;\n}\nconst int MAXN = 1e6 + 5;\nbool flag;\nvector<int> v[MAXN];\nint down[MAXN], dp[MAXN][2][2];\nint val[MAXN];\nint n, minn;\ndouble ans;\nint ans1, ans2;\nint GCD(int a, int b) {\n\treturn b == 0 ? a : GCD(b, a % b);\n}\nvoid DP(int now, int fa) {\n\tint sec[2][2];\n\tint id[2][2];\n\tfor(int i = 0; i <= 1; i++)\n\t\tfor(int j = 0; j <= 1; j++)\n\t\t\tsec[i][j] = id[i][j] = INF;\n\tint SIZ = v[now].size();\n\tfor(int i = 0; i < SIZ; i++) {\n\t\tint next = v[now][i];\n\t\tif(next == fa)\n\t\t\tcontinue;\n\t\tDP(next, now);\n\t\tif(val[now] == 1) {\n\t\t\tif(val[next] > 2)\n\t\t\t\tcontinue;\n\t\t\tdouble son1 = (dp[next][1][1] * 1.0) / ((dp[next][1][0] + 1) * 1.0);\n\t\t\tdouble son2 = (dp[next][0][1] * 1.0) / ((dp[next][0][0] + 1) * 1.0);\n\t\t\tdouble self1 = (dp[now][1][1] * 1.0) / (dp[now][1][0] * 1.0);\n\t\t\tdouble self2 = (dp[now][0][1] * 1.0) / (dp[now][0][0] * 1.0);\n\t\t\tdouble num1 = (sec[1][1] * 1.0) / (sec[1][0] * 1.0);\n\t\t\tdouble num2 = (sec[0][1] * 1.0) / (sec[0][0] * 1.0);\n\t\t\tif(son1 < self1) {\n\t\t\t\tsec[1][1] = dp[now][1][1];\n\t\t\t\tsec[1][0] = dp[now][1][0];\n\t\t\t\tid[1][0] = id[1][1];\n\t\t\t\tdp[now][1][1] = dp[next][1][1];\n\t\t\t\tdp[now][1][0] = dp[next][1][0] + 1;\n\t\t\t\tid[1][1] = next;\n\t\t\t}\n\t\t\telse if(son1 < num1) {\n\t\t\t\tid[1][0] = next;\n\t\t\t\tsec[1][1] = dp[next][1][1];\n\t\t\t\tsec[1][0] = dp[next][1][0] + 1;\n\t\t\t}\n\t\t\tif(son2 < self2) {\n\t\t\t\tsec[0][1] = dp[now][0][1];\n\t\t\t\tsec[0][0] = dp[now][0][0];\n\t\t\t\tid[0][0] = id[0][1];\n\t\t\t\tdp[now][0][1] = dp[next][0][1];\n\t\t\t\tdp[now][0][0] = dp[next][0][0] + 1;\n\t\t\t\tid[0][1] = next;\n\t\t\t}\n\t\t\telse if(son2 < num2) {\n\t\t\t\tsec[0][1] = dp[next][0][1];\n\t\t\t\tsec[0][0] = dp[next][0][0] + 1;\n\t\t\t\tid[0][0] = next;\n\t\t\t}\n\t\t}\n\t\telse if(val[now] == 2) {\n\t\t\tif(val[next] != 1)\n\t\t\t\tcontinue;\n\t\t\tdouble son = (dp[next][1][1] * 2.0) / ((dp[next][1][0] + 1) * 1.0);\n\t\t\tdouble self = (dp[now][0][1] * 1.0) / (dp[now][0][0] * 1.0);\n\t\t\tdouble num = (sec[0][1] * 1.0) / (sec[0][0] * 1.0);\n\t\t\tif(son < self) {\n\t\t\t\tsec[0][1] = dp[now][0][1];\n\t\t\t\tsec[0][0] = dp[now][0][0];\n\t\t\t\tid[0][0] = id[0][1];\n\t\t\t\tdp[now][0][1] = dp[next][1][1] * 2;\n\t\t\t\tdp[now][0][0] = dp[next][1][0] + 1;\n\t\t\t\tid[0][1] = next;\n\t\t\t}\n\t\t\telse if(son < num) {\n\t\t\t\tsec[0][1] = dp[next][1][1] * 2;\n\t\t\t\tsec[0][0] = dp[next][1][0] + 1;\n\t\t\t\tid[0][0] = next;\n\t\t\t}\n\t\t}\n\t}\n\tdouble Num = (dp[now][0][1] * 1.0) / (dp[now][0][0] * 1.0);\n\tif(Num < ans) {\n\t\tans = Num;\n\t\tans1 = dp[now][0][1];\n\t\tans2 = dp[now][0][0];\n\t}\n\tNum = (dp[now][1][1] * 1.0) / (dp[now][1][0] * 1.0);\n\tif(Num < ans) {\n\t\tans = Num;\n\t\tans1 = dp[now][1][1];\n\t\tans2 = dp[now][1][0];\n\t}\n\tif(id[1][1] != id[0][1]) {\n\t\tNum = ((dp[now][0][1] * dp[now][1][1]) * 1.0) / ((dp[now][0][0] + dp[now][1][0] - 1) * 1.0);\n\t\tif(Num < ans) {\n\t\t\tans = Num;\n\t\t\tans1 = dp[now][0][1] * dp[now][1][1];\n\t\t\tans2 = dp[now][0][0] + dp[now][1][0] - 1;\n\t\t}\n\t}\n\telse {\n\t\tif(id[1][0] != id[0][1]) {\n\t\t\tNum = ((dp[now][0][1] * sec[1][1]) * 1.0) / ((dp[now][0][0] + sec[1][0] - 1) * 1.0);\n\t\t\tif(Num < ans) {\n\t\t\t\tans = Num;\n\t\t\t\tans1 = dp[now][0][1] * sec[1][1];\n\t\t\t\tans2 = dp[now][0][0] + sec[1][0] - 1;\n\t\t\t}\n\t\t}\n\t\tif(id[0][0] != id[1][1]) {\n\t\t\tNum = ((sec[0][1] * dp[now][1][1]) * 1.0) / ((sec[0][0] + dp[now][1][0] - 1) * 1.0);\n\t\t\tif(Num < ans) {\n\t\t\t\tans = Num;\n\t\t\t\tans1 = sec[0][1] * dp[now][1][1];\n\t\t\t\tans2 = sec[0][0] + dp[now][1][0] - 1;\n\t\t\t}\n\t\t}\n\t}\n\tNum = ((dp[now][1][1] * sec[1][1]) * 1.0) / ((dp[now][1][0] + sec[1][0] - 1) * 1.0);\n\tif(Num < ans) {\n\t\tans = Num;\n\t\tans1 = dp[now][1][1] * sec[1][1];\n\t\tans2 = dp[now][1][0] + sec[1][0] - 1;\n\t}\n}\nvoid Read() {\n\tans = INF;\n\tminn = INF;\n\tint A, B;\n\tQuick_Read(n);\n\tfor(int i = 1; i < n; i++) {\n\t\tQuick_Read(A);\n\t\tQuick_Read(B);\n\t\tv[A].push_back(B);\n\t\tv[B].push_back(A);\n\t}\n\tfor(int i = 1; i <= n; i++) {\n\t\tQuick_Read(val[i]);\n\t\tif(val[i] == 1) {\n\t\t\tflag = true;\n\t\t}\n\t\tminn = Min(minn, val[i]);\n\t}\n\tfor(int i = 1; i <= n; i++) {\n\t\tdp[i][0][1] = dp[i][1][1] = INF;\n\t\tif(val[i] == 1) {\n\t\t\tdp[i][1][1] = 1;\n\t\t\tdp[i][0][1] = 1;\n\t\t}\n\t\telse if(val[i] == 2) {\n\t\t\tdp[i][1][1] = 2;\n\t\t\tdp[i][0][1] = 2;\n\t\t}\n\t\tdp[i][0][0] = dp[i][1][0] = 1;\n\t}\n}\nint main() {\n\tRead();\n\tif(!flag) {\n\t\tprintf(\"%d/1\", minn);\n\t\treturn 0;\n\t}\n\tDP(1, -1);\n\tint gcd = GCD(ans1, ans2);\n\tans1 /= gcd;\n\tans2 /= gcd;\n\tprintf(\"%d/%d\", ans1, ans2);\n\treturn 0;\n}\n```",
        "postTime": 1606280759,
        "uid": 254733,
        "name": "Night_Bringer",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6287 \u3010[COCI2016-2017#1] Mag\u3011"
    },
    {
        "content": "## \u9898\u610f\u7b80\u8ff0\n\n\u5b9a\u4e49\u4e00\u6761\u94fe\u7684\u4ef7\u503c\u4e3a\u94fe\u4e0a\u70b9\u6743\u4e58\u79ef\u9664\u4ee5\u8282\u94fe\u4e0a\u70b9\u6570\uff0c\u6c42\u4e00\u6761\u4ef7\u503c\u6700\u5c0f\u7684\u94fe\u3002\n\n## \u9898\u89e3\n\n\u7ed3\u8bba\uff1a\u7b54\u6848\u94fe\u4e0a\u6700\u591a\u5305\u542b\u4e00\u4e2a $2$\uff08\u5176\u4f59\u5168\u4e3a $1$\uff09\uff0c\u5e76\u4e14\u4e0d\u5728\u94fe\u7684\u4e24\u7aef\u70b9\u3002\n\n\u8bc1\u660e\uff1a\u6211\u4eec\u95ee\u9898\u5206\u6210\u4e24\u4e2a $\\texttt{pass}$\u3002\n\n- $\\texttt{pass 1}$\uff1a$\\forall u,s.t.x_{u}\\ge2$\u3002\n\n\u7b54\u6848\u663e\u7136\u4e3a $\\min\\{x_{u}\\},u\\in V$\u3002\n\n- $\\texttt{pass 2}$\uff1a$\\exists E'\\subset E,s.t.x_{u}=1,u\\in E'\\wedge x_{v}\\ge2,v\\in E\\setminus E'$\u3002\n\n- - \u6211\u4eec\u8bbe\u6211\u4eec\u9009\u51fa\u7684\u94fe\u4e3a\u5927\u6982\u8fd9\u6837\u7684\u9020\u578b\uff1a\n\n$$\n1\\rightarrow1\\rightarrow\\cdots\\rightarrow X\\rightarrow1\\rightarrow1\\cdots\n$$\n\n\u5373\u4e00\u5806 $1$ \u4e2d\u5939\u4e86\u4e00\u4e2a $X$\u3002\n\n\u6211\u4eec\u8bbe $X$ \u5de6\u8fb9\u6709 $l$ \u4e2a\u8282\u70b9\uff0c\u53f3\u8fb9\u6709 $r$ \u4e2a\u8282\u70b9\u3002\n\n\u5219\u4ef7\u503c\u4e3a\u6574\u6761\u94fe $\\frac{X}{l+r+1}$\uff0c\u5de6\u8fb9 $\\frac{1}{l}$\uff0c\u53f3\u8fb9 $\\frac{1}{r}$\u3002\n\n\u4e3a\u65b9\u4fbf\u6211\u4eec\u8fd9\u91cc\u8bbe $l<r$\u3002\n\n\u90a3\u4e48\u5de6\u8fb9\u7684\u4ef7\u503c\u4e00\u5b9a\u5927\u4e8e\u53f3\u8fb9\u3002\n\n\u8fd9\u91cc\u5047\u8bbe $\\frac{1}{r}>\\frac{X}{l+r+1}$\uff0c\u5219\u6709 $X<\\frac{l+1}{r}+1$\uff0c\u53c8 $r\\ge l+1$\uff0c\u6240\u4ee5 $\\frac{l+1}{r}\\le1$\u3002\uff08\u53cd\u4e4b\u53ef\u4ee5\u8bc1\u4f2a\uff0c\u61d2\u5f97\u5199\u4e86 QwQ\uff09\n\n\u6240\u4ee5\u6709 $X\\le2$\u3002\n\n\u53c8 $X\\neq1$\uff0c\u6240\u4ee5 $X=2$\u3002\n\n- - \u6211\u4eec\u8bbe\u6211\u4eec\u9009\u51fa\u7684\u94fe\u4e3a\u5927\u6982\u8fd9\u6837\u7684\u9020\u578b\uff1a\n\n$$\n1\\rightarrow1\\rightarrow\\cdots\\rightarrow X\\rightarrow1\\rightarrow\\cdots\\rightarrow1\\rightarrow Y\\rightarrow1\\cdots\n$$\n\n\u5373\u4e00\u5806 $1$ \u4e2d\u5939\u4e86\u4e00\u4e2a $X$ \u4e00\u4e2a $Y$\u3002\n\n\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u628a $Y$ \u4ee5\u524d\u5f53\u6210 $\\texttt{pass 2}$ \u7684\u7b2c\u4e00\u4e2a\u7c7b\u578b\uff0c\u8bbe\u5176\u5171\u6709 $N$ \u4e2a\u6570\u3002\n\n\u90a3\u4e48\u5047\u8bbe\u6211\u4eec\u52a0\u5165 $Y$ \u66f4\u4f18\uff0c\u5373\u6709 $\\frac{XY}{N+1}<\\frac{X}{N}$\uff0c\u5219\u6709 $NY<N+1$\uff0c\u7531\u4e8e $Y\\neq1$\uff0c\u6240\u4ee5\u52a0\u5165 $Y$ \u662f\u66f4\u52a3\u7684\u3002\n\n\u540e\u9762\u7684\u540c\u7406\u5c31\u53ef\u4ee5\u63a8\u5e7f\u4e86\u3002\n\n\u4e8e\u662f\u5f97\u8bc1 QwQ\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5 DP \u4e86\u3002\n\n\u8bbe $f_{u,0/1}$ \u8868\u793a\u8282\u70b9 $u$ \u6743\u503c\u4e3a\u7684\u60c5\u51b5\u4e0b\u6700\u4f18\u7b54\u6848\u3002\n\n\u8f6c\u79fb\u5c31\u5206\u7c7b\u8ba8\u8bba\u4e00\u4e0b\uff1a\n\n- $x_{u}=1$\n\n$$\n\\begin{cases}\nf_{u,0}=\\max\\{f_{v,0}\\}+1 \\\\\nf_{u,1}=\\max\\{f_{v,1}\\}+1\n\\end{cases}\n$$\n\n- $x_{u}=2$\n\n$$\nf_{u,1}=\\max\\{f_{v,0}\\}+1\n$$\n\n\u7b54\u6848\u4e5f\u9700\u8981\u5206\u7c7b\u8ba8\u8bba\uff08\u8fd9\u91cc\u8bbe $x,y\\in\\text{son}(u)$\uff09\uff1a\n\n- $x_{u}=1$\n\n\u7b54\u6848\u4e3a $\\frac{1}{\\max\\{f_{x,0}+f_{y,0}+1\\}}$\uff0c\u4ee5\u53ca $\\frac{2}{\\max\\{f_{x,0}+f_{y,1}\\}+1}$\u3002\n\n- $x_{u}=2$\n\n\u7b54\u6848\u4e3a $\\frac{2}{\\max\\{f_{x,0}+f_{y,0}+1\\}}$\u3002\n\n\u7528\u56db\u4e2a\u53d8\u91cf\u7ef4\u62a4\u6700\u5927\u3001\u6b21\u5927\u7684 $f_{0},f_{1}$ \u5373\u53ef\u3002\n\n```cpp\n#include <cstdio>\n\nconst int MAXN = 1e6 + 5;\n\nint rint () {\n\tint x = 0, f = 1; char c = getchar ();\n\tfor ( ; c < '0' || c > '9'; c = getchar () )\tf = c == '-' ? -f : f;\n\tfor ( ; c >= '0' && c <= '9'; c = getchar () )\tx = ( x << 3 ) + ( x << 1 ) + ( c & 15 );\n\treturn x * f;\n}\n\ntemplate<typename _T>\nvoid wint ( _T x ) {\n\tif ( x < 0 )\tputchar ( '-' ), x = ~ x + 1;\n\tif ( x > 9 )\twint ( x / 10 );\n\tputchar ( x % 10 ^ '0' );\n}\n\ntemplate<typename _T> _T MIN ( const _T x, const _T y ) { return x > y ? y : x; }\n\nstruct starS {\n\tint to, nx;\n\tstarS ( int T = 0, int N = 0 ) { to = T, nx = N; }\n} as[MAXN * 2];\n\nint n, cnt, Up = 1e9, Dn = 1, mnMg = 1e9, a[MAXN], f[MAXN][2], bgin[MAXN];\n\nvoid pushEdge ( const int u, const int v ) { as[++ cnt] = starS ( v, bgin[u] ); bgin[u] = cnt; }\n\nvoid checkUpt ( const int x, const int y ) { if ( Up * y > Dn * x )\tUp = x, Dn = y; }\n\nvoid dfs ( const int u, const int lst ) {\n\tint mx0 = 0, se0 = 0, mx1 = 0, se1 = 0;\n\tfor ( int i = bgin[u]; i; i = as[i].nx ) {\n\t\tint v = as[i].to;\n\t\tif ( v == lst )\tcontinue;\n\t\tdfs ( v, u );\n\t\tif ( f[v][0] > f[mx0][0] )\tse0 = mx0, mx0 = v;\n\t\telse if ( f[v][0] > f[se0][0] )\tse0 = v;\n\t\tif ( f[v][1] > f[mx1][1] )\tse1 = mx1, mx1 = v;\n\t\telse if ( f[v][1] > f[se1][1] )\tse1 = v;\n\t}\n\tif ( a[u] == 1 ) {\n\t\tf[u][0] = f[mx0][0] + 1;\n\t\tcheckUpt ( 1, f[mx0][0] + f[se0][0] + 1 );\n\t\tif ( ! mx1 )\treturn;\n\t\tf[u][1] = f[mx1][1] + 1;\n\t\tif ( mx0 != mx1 )\tcheckUpt ( 2, f[mx0][0] + f[mx1][1] + 1 );\n\t\telse {\n\t\t\tcheckUpt ( 2, f[se0][0] + f[mx1][1] + 1 );\n\t\t\tif ( se1 )\tcheckUpt ( 2, f[mx0][0] + f[se1][1] + 1 );\n\t\t}\n\t}\n\telse if ( a[u] == 2 )\tf[u][1] = f[mx0][0] + 1, checkUpt ( 2, f[mx0][0] + f[se0][0] + 1 );\n}\n\nint main () {\n\tn = rint ();\n\tfor ( int i = 1, u, v; i < n; ++ i ) {\n\t\tu = rint (), v = rint ();\n\t\tpushEdge ( u, v ), pushEdge ( v, u );\n\t}\n\tfor ( int i = 1; i <= n; ++ i )\ta[i] = rint (), mnMg = MIN ( mnMg, a[i] );\n\tif ( mnMg > 1 )\twint ( mnMg ), putchar ( '/' ), wint ( 1 ), putchar ( '\\n' );\n\telse\tdfs ( 1, 0 ), wint ( Up ), putchar ( '/' ), wint ( Dn ), putchar ( '\\n' );\n\treturn 0;\n}\n```",
        "postTime": 1606279761,
        "uid": 161849,
        "name": "cirnovsky",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P6287 \u3010[COCI2016-2017#1] Mag\u3011"
    },
    {
        "content": "\u7ed3\u8bba\uff1a\u6700\u591a\u5305\u542b\u4e00\u4e2a $2$\uff0c\u5e76\u4e14\u4e0d\u5728\u94fe\u7684\u4e24\u7aef\u70b9\u3002\n\n\u8bc1\u660e\uff1a\u6211\u4eec\u95ee\u9898\u5206\u6210\u4e24\u4e2a $\\texttt{pass}$\u3002\n\n- $\\texttt{pass 1}$\uff1a$\\forall u,s.t.x_{u}\\ge2$\u3002\n\n\u7b54\u6848\u663e\u7136\u4e3a $\\min\\{x_{u}\\},u\\in V$\u3002\n\n- $\\texttt{pass 2}$\uff1a$\\exists E'\\subset E,s.t.x_{u}=1,u\\in E'\\wedge x_{v}\\ge2,v \\in E \\setminus E$\u3002\n\n- - \u6211\u4eec\u8bbe\u6211\u4eec\u9009\u51fa\u7684\u94fe\u4e3a\u5927\u6982\u8fd9\u6837\u7684\u9020\u578b\uff1a\n\n$$\n1\\rightarrow1\\rightarrow\\cdots\\rightarrow X\\rightarrow1\\rightarrow1\\cdots\n$$\n\n\u5373\u4e00\u5806 $1$ \u4e2d\u5939\u4e86\u4e00\u4e2a $X$\u3002\n\n\u6211\u4eec\u8bbe $X$ \u5de6\u8fb9\u6709 $l$ \u4e2a\u8282\u70b9\uff0c\u53f3\u8fb9\u6709 $r$ \u4e2a\u8282\u70b9\u3002\n\n\u5219\u4ef7\u503c\u4e3a\u6574\u6761\u94fe $\\frac{X}{l+r+1}$\uff0c\u5de6\u8fb9 $\\frac{1}{l}$\uff0c\u53f3\u8fb9 $\\frac{1}{r}$\u3002\n\n\u4e3a\u65b9\u4fbf\u6211\u4eec\u8fd9\u91cc\u8bbe $l<r$\u3002\n\n\u90a3\u4e48\u5de6\u8fb9\u7684\u4ef7\u503c\u4e00\u5b9a\u5927\u4e8e\u53f3\u8fb9\u3002\n\n\u8fd9\u91cc\u5047\u8bbe $\\frac{1}{r}>\\frac{X}{l+r+1}$\uff0c\u5219\u6709 $X<\\frac{l+1}{r}+1$\uff0c\u53c8 $r\\ge l+1$\uff0c\u6240\u4ee5 $\\frac{l+1}{r}\\le1$\u3002\uff08\u5047\u8bbe\u53cd\u8fc7\u6765\u53ef\u4ee5\u8bc1\u4f2a\u3002\n\n\u6240\u4ee5\u6709 $X\\le2$\u3002\n\n\u53c8 $X\\neq1$\uff0c\u6240\u4ee5 $X=2$\u3002\n\n- - \u6211\u4eec\u8bbe\u6211\u4eec\u9009\u51fa\u7684\u94fe\u4e3a\u5927\u6982\u8fd9\u6837\u7684\u9020\u578b\uff1a\n\n$$\n1\\rightarrow1\\rightarrow\\cdots\\rightarrow X\\rightarrow1\\rightarrow\\cdots\\rightarrow1\\rightarrow Y\\rightarrow1\\cdots\n$$\n\n\u5373\u4e00\u5806 $1$ \u4e2d\u5939\u4e86\u4e00\u4e2a $X$ \u4e00\u4e2a $Y$\u3002\n\n\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u628a $Y$ \u4ee5\u524d\u5f53\u6210 $\\texttt{pass 2}$ \u7684\u7b2c\u4e00\u4e2a\u7c7b\u578b\uff0c\u8bbe\u5176\u5171\u6709 $N$ \u4e2a\u6570\u3002\n\n\u90a3\u4e48\u5047\u8bbe\u6211\u4eec\u52a0\u5165 $Y$ \u66f4\u4f18\uff0c\u5373\u6709 $\\frac{XY}{N+1}<\\frac{X}{N}$\uff0c\u5219\u6709 $NY<N+1$\uff0c\u7531\u4e8e $Y\\neq1$\uff0c\u6240\u4ee5\u52a0\u5165 $Y$ \u662f\u66f4\u52a3\u7684\u3002",
        "postTime": 1606225058,
        "uid": 266779,
        "name": "STrAduts",
        "ccfLevel": 6,
        "title": "[COCI2016-2017#1]  Mag \u7ed3\u8bba\u8bc1\u660e"
    },
    {
        "content": "## \u9898\u89e3\uff1a\n\n~~2020.11.23\u6a21\u62df\u8d5bT4 25\u5206\u573a~~\n\n\u89c9\u5f97\u53ef\u4ee5\u7528\u70b9\u5206\u6cbb\u505a\u3002\u4f46\u662f\u8003\u573a\u4e0a\u4e00\u76f4\u6ca1\u5199\u51fa\u6765\u3002\u5982\u679c\u89c9\u5f97\u70b9\u5206\u6cbb\u505a\u6cd5\u53ef\u884c\u7684\u5c0f\u4f19\u4f34\u53ef\u4ee5\u79c1\u4fe1\u6216\u7559\u8a00\u8054\u7cfb\u6211\u3002\u54b1\u4fe9\u4e00\u8d77\u7814\u7a76\u3002\n\n\u5728\u8003\u573a\u4e0a\u53d1\u73b0\u4e00\u4e2a\u6027\u8d28\uff1a1\u8d8a\u591a\u8d21\u732e\u8d8a\u591a\u3002\u800c\u4e14\uff0c\u9664\u4e861\u4e4b\u5916\uff0c\u518d\u5f80\u91cc\u52a0\u4efb\u4f55\u6570\u90fd\u4e0d\u4f18\u3002\n\n\u4e8e\u662f\u6811\u5f62DP\u6c42\u4e86\u4e2a\u6700\u957f\u76841\u94fe\u3002\u6700\u540e\u5047\u4e86\uff0c\u6302\u4e86\u597d\u591a\u5206\u3002\n\n\u95ee\u9898\u51fa\u5728\u54ea\u5462\uff1f\n\n\u539f\u6765\uff0c2\u4e5f\u662f\u53ef\u4ee5\u88ab\u653e\u8fdb\u8fd9\u6761\u94fe\u7684\u3002\u53ef\u4ee5\u8fd9\u6837\u53bb\u60f3\uff1a\u73b0\u5728\u6709\u4e24\u6761\u6700\u957f1\u94fe\uff08\u5206\u5f00\u7684\uff09\uff0c\u53ea\u9700\u8981\u4e2d\u95f4\u7684\u4e00\u4e2a2\u5c31\u53ef\u4ee5\u628a\u5b83\u4eec\u6c9f\u901a\u8d77\u6765\u3002\u8fd9\u6837\u7684\u7b54\u6848\u6709\u53ef\u80fd\u66f4\u4f18\u79c0\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u7528$f[i],g[i]$\u5206\u522b\u7edf\u8ba1\u4ee5i\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\uff0c\u4ee5i\u4e3a\u4e00\u7aef\u4e14\u9b54\u529b\u503c\u4e3a1\u7684\u6700\u5927\u957f\u5ea6\u3001\u9b54\u529b\u503c\u4e3a2\u7684\u6700\u5927\u957f\u5ea6\u3002\n\n\u5f53\u7136\uff0c\u6839\u636e\u4e4b\u524d\u7684\u601d\u8def\uff0c\u6211\u4eec\u4e3a\u4e86\u7edf\u8ba1\u8fd9\u4e9b\u4fe1\u606f\uff0c\u8fd8\u9700\u8981\u7edf\u8ba1\u6700\u5927\u503c\u3001\u6b21\u5927\u503c\u3002\n\n\u5177\u4f53\u7684\u5728\u4ee3\u7801\u4e2d\u5b9e\u73b0\uff1a\n\n```cpp\n#include<cstdio>\nusing namespace std;\nconst int maxn=1e6+6;\nstruct Node\n{\n\tint next;\n\tint to;\n}edge[maxn<<1];\nint head[maxn],cnt;\nvoid add(int u,int v)\n{\n\tedge[cnt].next=head[u];\n\tedge[cnt].to=v;\n\thead[u]=cnt++;\n}\nint mag[maxn];\nint f[maxn],g[maxn];\nint p=1e9,q=1,mn=1e9;\nvoid update(int x,int y)\n{\n\tif(p*y>q*x)\n\t\tp=x,q=y;\n\treturn;\n}\nvoid dfs(int x,int fa)\n{\n\tint u1=0,u2=0,v1=0,v2=0;\n\tfor(int i=head[x];~i;i=edge[i].next)\n\t{\n\t\tint t=edge[i].to;\n\t\tif(t!=fa)\n\t\t{\n\t\t\tdfs(t,x);\n\t\t\tif(f[t]>f[u1]){\n\t\t\t\tu2=u1,u1=t;\n\t\t\t}\n\t\t\telse if(f[t]>f[u2]){\n\t\t\t\tu2=t;\n\t\t\t}\n\t\t\tif(g[t]>g[v1]){\n\t\t\t\tv2=v1,v1=t;\n\t\t\t}\n\t\t\telse if(g[t]>g[v2]){\n\t\t\t\tv2=t;\n\t\t\t}\n\t\t}\n\t}\n\tif(mag[x]==1)\n\t{\n\t\tf[x]=f[u1]+1;\n\t\tupdate(1,f[u1]+f[u2]+1);\n\t\tif(v1!=0)\n\t\t{\n\t\t\tg[x]=g[v1]+1;\n\t\t\tif(u1!=v1)\n\t\t\t\tupdate(2,f[u1]+g[v1]+1);\n\t\t\telse\n\t\t\t{\n\t\t\t\tupdate(2,f[u2]+g[v1]+1);\n\t\t\t\tif(v2!=0)\n\t\t\t\t\tupdate(2,f[u1]+g[v2]+1);\n\t\t\t}\n\t\t}\n\t}\n\telse if(mag[x]==2)\n\t{\n\t\tg[x]=f[u1]+1;\n\t\tupdate(2,f[u1]+f[u2]+1);\n\t}\n}\nint main()\n{\n\tint n;\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;++i)\n\t\thead[i]=-1;\n\tfor(int i=1;i<n;++i)\n\t{\n\t\tint u,v;\n\t\tscanf(\"%d%d\",&u,&v);\n\t\tadd(u,v);\n\t\tadd(v,u);\n\t}\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tscanf(\"%d\",mag+i);\n\t\tif(mag[i]<mn)\n\t\t\tmn=mag[i];\n\t}\n\tif(mn>1)\n\t{\n\t\tprintf(\"%d/1\",mn);\n\t\treturn 0;\n\t}\n\tdfs(1,0);\n\tprintf(\"%d/%d\",p,q);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1606134609,
        "uid": 175131,
        "name": "\u5085\u601d\u7ef4666",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6287 \u3010[COCI2016-2017#1] Mag\u3011"
    },
    {
        "content": "\u7ed3\u8bba\uff1a\u7b54\u6848\u4e00\u5b9a\u662f\u67d0\u4e2a\u70b9\uff0c\u6216\u8005\u4e00\u6bb51\uff0c\u6216\u8005\u4e00\u6bb51\u4e2d\u95f4\u6709\u4e2a2\n\n\u67d0\u4e2a\u70b9\u7684\u60c5\u51b5\u4e0d\u8bba\uff0c\u5982\u679c\u80fd\u6709\u7b54\u6848\u6bd4\u5355\u4e2a\u70b9\u66f4\u4f18\uff0c\u4e00\u5b9a\u6ee1\u8db3\u4e0a\u9762\u7684\u7ed3\u8bba\n\n\u8bc1\u660e\uff1a\n\n$1.11111(x\u4e2a)311111(y\u4e2a)$\uff0c\u603b\u7684\u503c\u662f$\\frac{3}{x+y+1}$\uff0c\u4ee4$x<=y$\uff0c\u5219\u8fd8\u6709\u4e00\u79cd\u60c5\u51b5\u662f$\\frac{1}{y}$\n\n$\\frac{3}{x+y+1}<\\frac{1}{y},3y<x+y+1,2y<x+1$\u4e0d\u53ef\u80fd\uff0c\u6240\u4ee5\u4e00\u6bb51\u4e2d\u95f4\u4e0d\u53ef\u80fd\u6709$>=3$\u7684\u6570\uff0c\u6216\u8005\u4e58\u79ef\u4f1a$>=3$\n\n$2.11111(x\u4e2a)3,\\frac{3}{x+1}<\\frac{1}{x},3x<x+1,2x<1$\uff0c\u4e0d\u53ef\u80fd\uff0c\u6240\u4ee5\u4e00\u6bb51\u7684\u7aef\u70b9\u4e0d\u53ef\u80fd\u63a5\u4e0a\u4e00\u4e2a$>=3$\u7684\u6570\n\n$3.11111(x\u4e2a)2,\\frac{2}{x+1}<\\frac{1}{x},2x<x+1,x<1$\uff0c\u4e0d\u53ef\u80fd\uff0c\u6240\u4ee5\u4e00\u6bb51\u7684\u7aef\u70b9\u4e0d\u53ef\u80fd\u63a5\u4e0a\u4e00\u4e2a$>=2$\u7684\u6570\n\n**\u6240\u4ee5\uff0c\u6b63\u786e\u7b54\u6848\u4e24\u7aef\u4e0d\u80fd>1**\n\n$4.11111(x\u4e2a)211111(y\u4e2a),x<=y$\n\n$\\frac{2}{x+y+1}<\\frac{1}{y},2y<x+y+1,y<x+1,y<=x$\n\n$\u53c8y>=x,\u6240\u4ee5y=x$\n\n\u5f53\u4e14\u4ec5\u5f53$x=y$\u65f6\uff0c\u53ef\u4ee5\u4f7f\u4e2d\u95f4\u63d2\u4e0a\u4e00\u4e2a2\uff0c\u66f4\u4f18\n\n\u80fd\u4e0d\u80fd\u591a\u63d2\u51e0\u4e2a2\uff1f\u7ed3\u8bba1\u544a\u8bc9\u6211\u4eec\u4e86\uff0c\u4e0d\u884c\n\n\u5176\u5b9e\u5462\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7528\u5230\u6b63\u786e\u7b54\u6848\u662f\u4e00\u6bb51\u4e2d\u95f4\u53ef\u80fd\u6709\u4e00\u4e2a2\u5c31\u884c\u4e86\n\n\u7528\u6811\u5f62dp\u89e3\u51b3\n\n$dp_{u,1}$\u8868\u793a\u5168\u662f1\u7684\u6700\u957f\u94fe\n\n$dp_{u,2}$\u8868\u793a\u5305\u542b\u4e00\u4e2a2\u7684\u6700\u957f\u94fe\n\n- $a_u=1:dp_{u,1}=max(dp_{u,1},dp_{v,1}+1),dp_{u,2}=max(dp_{u,2},dp_{v,2}+1)$\n- $a_u=2:dp_{u,2}=max(dp_{u,2},dp_{v,1}+1)$\n\n\u7136\u540e\u6bcf\u4e2a\u70b9\u7684\u65f6\u5019\u90fd\u6c42\u4e00\u4e2a\u7b54\u6848\n\n\u9700\u8981\u8bb0\u5f55\u4e0b\u513f\u5b50\u4e2d\u6700\u957f\uff0c\u6b21\u957f\u76841\u94fe\uff0c2\u94fe\n\n\u6ce8\u610f\u7684\u4e00\u70b9\u662f\u5982\u679c\u6700\u957f\u76841\u94fe\uff0c2\u94fe\u662f\u540c\u4e00\u6761\uff0c\u4e0d\u80fd\u540c\u53d6\n\nCode\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define maxn 1000010\n#define LL long long\nusing namespace std;\nstruct Edge{\n\tint to, next;\n}edge[maxn << 1];\nint num, head[maxn], n;\nLL a[maxn], dp[maxn][3], p, q; \n\ninline int read(){\n\tint s = 0, w = 1;\n\tchar c = getchar();\n\tfor (; !isdigit(c); c = getchar()) if (c == '-') w = -1;\n\tfor (; isdigit(c); c = getchar()) s = (s << 1) + (s << 3) + (c ^ 48);\n\treturn s * w;\n}\n\nvoid addedge(int x, int y){ edge[++num] = (Edge){y, head[x]}, head[x] = num; }\nLL gcd(LL m, LL n){ return n == 0 ? m : gcd(n, m % n); }\nvoid update(LL x, LL y){ if (x * q < y * p) p = x, q = y; }\n\nvoid dfs(int u, int pre){\n\tif (a[u] == 1) dp[u][1] = 1;\n\tif (a[u] == 2) dp[u][2] = 1;\n\tint fir = 0, sec = 0, fir2 = 0, sec2 = 0;\n\tfor (int i = head[u]; i; i = edge[i].next){\n\t\tint v = edge[i].to;\n\t\tif (v == pre) continue;\n\t\tdfs(v, u);\n\t}\n\tfor (int i = head[u]; i; i = edge[i].next){\n\t\tint v = edge[i].to;\n\t\tif (v == pre) continue;\n\t\tif (a[u] == 1) dp[u][1] = max(dp[u][1], dp[v][1] + 1), dp[u][2] = max(dp[u][2], dp[v][2] + 1);\n\t\tif (a[u] == 2) dp[u][2] = max(dp[u][2], dp[v][1] + 1);\n\t\tif (dp[v][1] > dp[fir][1]) sec = fir, fir = v;\n\t\telse if (dp[v][1] > dp[sec][1]) sec = v;\n\t\tif (dp[v][2] > dp[fir2][2]) sec2 = fir2, fir2 = v;\n\t\telse if (dp[v][2] > dp[sec2][2]) sec2 = v;\n\t}\n\tif (a[u] == 1){\n\t\tupdate(1, dp[fir][1] + dp[sec][1] + 1);\n\t\tif (fir == fir2) update(2, dp[sec][1] + dp[fir2][2] + 1), update(2, dp[fir][1] + dp[sec2][2] + 1);\n\t\telse update(2, dp[fir][1] + dp[fir2][2] + 1);\n\t}\n\tif (a[u] == 2) update(2, dp[fir][1] + dp[sec][1] + 1);\n}\n\nint main(){\n\tn = read();\n\tfor (int i = 1; i < n; ++i){\n\t\tint x = read(), y = read();\n\t\taddedge(x, y), addedge(y, x);\n\t}\n\tp = 1e9, q = 1;\n\tfor (int i = 1; i <= n; ++i) p = min(p, a[i] = read());\n\tdfs(1, 0);\n\tLL r = gcd(p, q);\n\tprintf(\"%lld/%lld\\n\", p / r, q / r);\n\treturn 0;\n}\n```\n",
        "postTime": 1603855807,
        "uid": 51719,
        "name": "ModestCoder_",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6287 \u3010[COCI2016-2017#1] Mag\u3011"
    },
    {
        "content": "[P6287 [COCI2016-2017#1] Mag](https://www.luogu.com.cn/problem/P6286)\n\n\u8003\u8651\u6211\u4eec\u5f53\u524d\u5f97\u5230\u7684\u4e00\u4e2a\u7b54\u6848\u4e3a$\\dfrac{a}{b}$\uff08\u672a\u7ea6\u5206\uff09\u3002\u5bf9\u4e8e\u4e00\u4e2a\u65b0\u7684\u8282\u70b9\uff0c\u5982\u679c\u628a\u5b83\u52a0\u5165\u8fd9\u6761\u8def\u5f84\uff0c\u7b54\u6848\u5c31\u53d8\u4e3a$\\dfrac{ax}{b+1}$\n\n\u5f88\u5bb9\u6613\u60f3\u5230$x$\u4e0d\u80fd\u592a\u5927\u3002\n\n\u90a3\u4ec0\u4e48\u60c5\u51b5\u4e0b\u624d\u80fd\u6ee1\u8db3$\\dfrac{ax}{b+1}\\leq \\dfrac{a}{b}$\n\n\u89e3\u8fd9\u4e2a\u4e0d\u7b49\u5f0f\u5f97\u5230\uff1a$b(x-1)\\leq 1$\n\n$\\therefore b=1,x\\leq 2$\u6216$b>1,x=1$\n\n\u8fd9\u4e5f\u5c31\u8bf4\u660e\u4e86\uff0c\u8fd9\u4e00\u6761\u8def\u5f84\u8981\u4e48\u5168\u662f$1$\uff0c\u8981\u4e48\u6709\u4e00\u4e2a$2$\uff0c\u5176\u4ed6\u90fd\u662f$1$\u3002\u597d\u50cf\u4e0d\u662f\u5f88\u4e25\u8c28\uff0c~~\u611f\u6027\u7406\u89e3~~\n\n\u90a3\u4e48\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5206\u5b50\u8981\u4e48\u662f$1$\uff0c\u8981\u4e48\u662f$2$\uff0c\u6211\u4eec\u8981\u8ba9\u5206\u6bcd\u5c3d\u53ef\u80fd\u5730\u5927\uff0c\u90a3\u4e48\u5c31\u8f6c\u6362\u6210\u5728\u8fd9\u68f5\u6811\u4e0a\u6c42\u6ee1\u8db3\u6761\u4ef6\u7684\u6700\u957f\u94fe\u3002\n\n\u8fd9\u4e2a\u53ef\u4ee5\u7528\u6811\u5f62DP\u6c42\u3002\u6211\u8fd9\u91cc\u5199\u6cd5\u4e0d\u662f\u901a\u5e38\u7684\u8bbe\u6700\u957f\u94fe\u548c\u6b21\u957f\u94fe\u3002\u6bd4\u5982\u8bf4\u8981\u6c42\u4e00\u9897\u6811\u7684\u76f4\u5f84\uff0c\u4ee4$f[p]$\u8868\u793a\u4ee5$p$\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\uff0c\u4e00\u5b9a\u7ecf\u8fc7$p$\u7684\u76f4\u5f84\u3002\u90a3\u4e48\u5728\u679a\u4e3e\u513f\u5b50$q$\u7684\u8fc7\u7a0b\u4e2d\uff0c$f[p]$\u4fdd\u5b58\u7684\u662f\u5230$q$\u7684\u5144\u5f1f\u7684\u6700\u957f\u94fe\uff0c\u90a3\u4e48$f[p]+f[q]$\u5c31\u6709\u53ef\u80fd\u6210\u4e3a\u4e00\u6761\u76f4\u5f84\uff0c\u66f4\u65b0\u7b54\u6848\uff0c\u7136\u540e\u518d\u66f4\u65b0$f[p]$\n\n\u8bbe$f1[p]$\u8868\u793a\u4ee5$p$\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\uff0c\u5e76\u4e14\u4e00\u7aef\u4e3a$p$\u7684\u5168$1$\u6700\u957f\u94fe\uff1b$f2[p]$\u8868\u793a\u4ee5$p$\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\uff0c\u5e76\u4e14\u4e00\u7aef\u4e3a$p$\u7684\u6709\u4e00\u4e2a$2$\u7684\u6700\u957f\u94fe\u3002\u6ce8\u610f\uff0c\u8fd9\u4e2a$f2$\u5b9a\u4e49\u4e3a\u4e00\u5b9a\u6709\u4e00\u4e2a$2$\uff0c\u53ef\u4ee5\u8fd8\u6ca1\u6709$1$\uff0c\u5373\u5982\u679c$f2[p]$\u6709\u503c\uff0c\u90a3\u4e48\u8def\u5f84\u4e0a\u4e00\u5b9a\u4f1a\u6709$2$\u3002\n\n\u8f6c\u79fb\u5f88\u597d\u60f3\uff0c\u770b\u4ee3\u7801\u5c31\u884c\u4e86\u3002\n\n\u90a3\u5982\u679c\u6574\u9897\u6811\u90fd\u6ca1\u6709$1$\u548c$2$\u5462\uff1f\u90a3\u5c31\u627e\u70b9\u6743\u6700\u5c0f\u7684\u70b9\u5c31\u884c\u4e86\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#define ll long long\nusing namespace std;\nconst int N=1e6+10;\nconst int INF=1e9+10;\nint tot,mx=INF,my=1,ans1,ans2;//ans1\u8868\u793a\u51681\u7684\u6700\u957f\u94fe\u3002ans2\u8868\u793a\u6709\u4e00\u4e2a2\u7684\u6700\u957f\u94fe \nint fir[N],val[N],f1[N],f2[N];\nstruct edge\n{\n\tint to;\n\tint nxt;\n}e[N*2];\ninline void add(int x,int y)\n{\n\te[++tot].to=y; e[tot].nxt=fir[x]; fir[x]=tot;\n\te[++tot].to=x; e[tot].nxt=fir[y]; fir[y]=tot;\n}\ninline void dfs(int p,int fa)\n{\n\tif(val[p]==1) f1[p]=1;\n\tif(val[p]==2) f2[p]=1;\n\tfor(int i=fir[p];i;i=e[i].nxt)\n\t{\n\t\tint q=e[i].to;\n\t\tif(q==fa) continue;\n\t\tdfs(q,p);\n\t\tans1=max(ans1,f1[q]+f1[p]);\n\t\tans2=max(ans2,max(f2[q]?f2[q]+f1[p]:-INF,f2[p]?f1[q]+f2[p]:-INF));//\u6ce8\u610f\u5224\u65ad\u662f\u5426\u6709\u503c \n\t\tif(val[p]==1)\n\t\t{\n\t\t\tf1[p]=max(f1[p],f1[q]+1);\n\t\t\tif(f2[q]) f2[p]=max(f2[p],f2[q]+1);//\u6ce8\u610f\u5224\u65ad\u662f\u5426\u6709\u503c \n\t\t}\n\t\tif(val[p]==2) f2[p]=max(f2[p],f1[q]+1);\n\t}\n\tans1=max(ans1,f1[p]);\n\tans2=max(ans2,f2[p]);\n}\ninline void update(int x,int y)\n{\n\tif((ll)x*my<(ll)y*mx) mx=x,my=y;\n}\ninline int gcd(int x,int y)\n{\n\treturn (y?gcd(y,x%y):x);\n}\nint main()\n{\n\tint n,a,b;\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tscanf(\"%d%d\",&a,&b);\n\t\tadd(a,b);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&val[i]);\n\t\tmx=min(mx,val[i]);//\u6c42\u6700\u5c0f\u70b9\u6743 \n\t}\n\tdfs(1,0);\n\tif(ans1) update(1,ans1);\n\tif(ans2) update(2,ans2);\n\tprintf(\"%d/%d\\n\",mx/gcd(mx,my),my/gcd(mx,my));\n\treturn 0;\n}\n```",
        "postTime": 1586756524,
        "uid": 81238,
        "name": "MCAdam",
        "ccfLevel": 7,
        "title": "P6287 [COCI2016-2017#1] Mag"
    }
]
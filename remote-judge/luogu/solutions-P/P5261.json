[
    {
        "content": "## \u9898\u89e3 JSOI2013 \u6570\u5b57\u7406\u8bba\n\n### \u9898\u9762\n\n[luogu5261](https://www.luogu.com.cn/problem/P5261)\n\n### \u89e3\u6790\n\n\u5148\u5224\u6389\u4e0d\u5b58\u5728\u7684\u60c5\u51b5:$S>K*9||P>K*9||(S*D \\ \\ mod \\ \\ 9)!=(P \\ \\ mod \\ \\ 9)$\n\n\u8003\u8651\u6570\u4f4d dp,\n\n\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u6c42 $k=x*D$.\n\n\u8bbe $f[i][s1][s2][l]=0/1$ \u8868\u793a\u662f\u5426\u5b58\u5728\u4e00\u4e2a\u6570 $x$ ,\u4f7f\u5f97\n\n- $dight(x/D)=s1$\n- $dight(x)=s2$,\n- $x \\ \\ mod \\ \\ D=l$,\n- \u5728$x$\u540e\u9762\u6dfb\u52a0$i$\u4f4d\u6570\u5b57\u540e\u80fd\u6ee1\u8db3\u9898\u76ee\u6761\u4ef6\n\n\u5176\u4e2d $dight(i)$ \u8868\u793a $i$ \u7684\u5404\u4f4d\u6570\u5b57\u4e4b\u548c.\n\n~~\u597d\u5947\u602a\u7684\u72b6\u6001...~~\n\n\u8fb9\u754c\u5c31\u662f $f[0][S][P][0]=1$.\n\n\u518d\u6765\u770b\u8f6c\u79fb:\n\n\u679a\u4e3e\u5728 $x$ \u540e\u6dfb\u52a0\u4e00\u4f4d\u6570\u5b57 $d$,\u5219\n\n$f[i][s1][s2][l]|=f[i-1][s1+(l*10+d)/D][s2+d][(l*10+d)\\ \\ mod \\ \\ D]$.\n\n\u5176\u5b9e\u5176\u4e2d\u7684\u542b\u4e49\u4ed4\u7ec6\u5206\u6790\u4e00\u4e0b\u5c31\u80fd\u660e\u767d\u4e86...\n\n\u7136\u540e\u8d2a\u5fc3\u5730\u4ece\u9ad8\u4f4d\u5f80\u4f4e\u4f4d\u627e,\u627e\u5230\u4e00\u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u5c31\u7ee7\u7eed\u627e\u4e0b\u4e00\u4f4d.\n\n\u8bfb\u5230\u8fd9\u91cc,\u7ec6\u5fc3\u7684\u8bfb\u8005\u4e00\u5b9a\u4f1a\u53d1\u73b0\u8fd9\u6837\u505a\u4f1aTLE,\u7136\u800c,\u8fd9\u6837\u505a\u786e\u5b9e\u4f1aTLE...\n\n\u53d1\u73b0\u5f53 $i\\times 9+s1<S$ \u6216 $i\\times 9+s2<P$\u662f\u90fd\u662f\u65e0\u610f\u4e49\u7684,\n\n\u5e76\u4e14\u5f53 $s1$ \u548c $l$ \u786e\u5b9a\u65f6,$s2 \\ \\ mod \\ \\ 9$ \u4e5f\u80fd\u77e5\u9053,\u56e0\u6b64\u53ef\u4ee5\u5c06 $s2$ \u96649.\n\n\u7136\u540e\u5c31\u80fd\u5947\u5999\u5730\u8fc7\u4e86...\n\n### code\n\n```cpp\n#include <iostream>\n#include <stdio.h>\n#include <cstring>\n#define ll long long\n#define filein(a) freopen(a\".cpp\",\"r\",stdin)\n#define fileout(a) freopen(a\".cpp\",\"w\",stdout);\nusing namespace std;\n\ninline int read(){\n\tint sum=0,f=1;char c=getchar();\n\twhile((c<'0'||c>'9')&&c!=EOF){if(c=='-') f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9'&&c!=EOF){sum=sum*10+c-'0';c=getchar();}\n\treturn sum*f;\n}\n\nconst int N=101;\nint K,P,S,D;\nbool f[N][N*9][N][10];\n\nint main(){\n\tK=read();S=read();P=read();D=read();\n\tif(S>K*9||P>K*9||((S*D%9)^(P%9))){puts(\"-1\");return 0;}\n\tf[0][S][P/9][0]=1;\n\tfor(int i=1;i<K;i++){\n\t\tint S_st=max(S-i*9,0),P_st=max(P-i*9,0);\n\t\tfor(int j=S_st;j<=S;j++){\n\t\t\tfor(int l=0;l<D;l++){\n\t\t\t\tint mod=(j*D+l)%9;\n\t\t\t\tfor(int k=P_st/9,realk=k*9+mod;realk<=P;k++,realk+=9){\n\t\t\t\t\tfor(int d=0;!f[i][j][k][l]&&d<10;d++){\n\t\t\t\t\t\tif(f[i-1][j+(l*10+d)/D][(realk+d)/9][(l*10+d)%D]) f[i][j][k][l]=1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint st=D;\n\twhile(st<D*10&&!f[K-1][st/D][(st/10+st%10)/9][st%D]) st++;\n\tif(st==D*10){puts(\"-1\");return 0;}\n\tprintf(\"%d\",st/D);\n\tint I=K-1,J=st/D,K=(st/10+st%10),L=st%D;\n\twhile(I){\n\t\tint d=0;\n\t\twhile(!f[I-1][J+(L*10+d)/D][(K+d)/9][(L*10+d)%D]) d++;\n\t\tprintf(\"%d\",(L*10+d)/D);\n\t\tI--;J+=(L*10+d)/D;K+=d;L=(L*10+d)%D;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1581559018,
        "uid": 172304,
        "name": "zsq259",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5261 \u3010[JSOI2013]\u6570\u5b57\u7406\u8bba \u3011"
    },
    {
        "content": "\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\uff1a[cnblogs](https://www.cnblogs.com/acceptedzhs/p/solution-p5261.html)\n\n\u6570\u4f4d DP \u597d\u9898\u3002\n\n\u4e3a\u5565\u6ca1\u4eba\u7528 `bitset` \u554a...\n\n\u4e0d\u59a8\u4ece\u4f4e\u4f4d\u5f80\u9ad8\u4f4d DP\u3002\u8bbe $f(i,s,x,p)$ \u8868\u793a\u5f53\u524d DP \u5230\u7b2c $i$ \u4f4d\uff0c\u539f\u6570\u6570\u4f4d\u548c\u4e3a $s$\uff0c$\\times d$ \u540e\u7ed9\u7b2c $i+1$ \u4f4d\u7684\u8fdb\u4f4d\u4e3a $x$\uff0c$\\times d$ \u540e\u7684\u6570\u4f4d\u548c\u4e3a $p$\uff08\u4e0d\u5305\u62ec $x$\uff09\u662f\u5426\u53ef\u884c\u3002\n\n\u679a\u4e3e\u7b2c $i+1$ \u4f4d\u7684\u53d6\u503c $j$\uff0c\u6709\u8f6c\u79fb\uff1a\n$$\nf(i+1,s+j,\\left\\lfloor \\frac{x+jd}{10} \\right\\rfloor,p+((x+jd) \\bmod 10)) \\gets \\\\\nf(i+1,s+j,\\left\\lfloor \\frac{x+jd}{10} \\right\\rfloor,p+((x+jd) \\bmod 10)) \\operatorname{or} f(i,s,x,p)\n$$\n\u5176\u4e2d $[i=k-1]<j\\le 9$\uff0c\u56e0\u4e3a\u6700\u9ad8\u4f4d\u4e0d\u80fd\u662f $0$\u3002\u4e0d\u96be\u53d1\u73b0\u8fd9\u53ef\u4ee5\u7528 `bitset` \u4f18\u5316\u3002\n\n\u8f93\u51fa\u65b9\u6848\u4e5f\u662f\u53ef\u884c\u7684\u3002\u9996\u5148\u679a\u4e3e\u6700\u9ad8\u4f4d\uff08\u7b2c $k$ \u4f4d\uff09\u7684\u8fdb\u4f4d $x$\uff0c\u518d\u4ece\u9ad8\u5f80\u4f4e\u679a\u4e3e\u4f4d $i$\uff0c\u6700\u540e\u679a\u4e3e\u5f53\u524d\u4f4d\u7684\u53d6\u503c $j$ \u548c\u7b2c $i-1$ \u4f4d\u7ed9\u7b2c $i$ \u4f4d\u7684\u8fdb\u4f4d $x'$\uff0c\u5219\u8be5\u53d6\u503c\u53ef\u884c\u5f53\u4e14\u4ec5\u5f53\uff1a\n\n- $f(i-1,s-j,x',(p-jd+px) \\bmod 10)=1$\n- $\\left\\lfloor \\dfrac{px+jd}{10} \\right\\rfloor = x$\n\n\u4e4b\u540e\u6267\u884c\u64cd\u4f5c\uff1a\n\n- $x \\gets x'$\n- $s \\gets s-j$\n- $p \\gets (p-jd+px) \\bmod 10$\n- $ans_i \\gets j$\n- $i \\gets i-1$\n\n\u76f4\u81f3 $i=0$\u3002\n\n\u6700\u540e\u7b54\u6848\u5c31\u662f $ans$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\frac{ksp}{\\omega} \\times b^2)$\uff0c\u5176\u4e2d $\\omega=64,b=10$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long i64;\ntypedef vector<int> vi;\ntypedef pair<int,int> pii;\n\ntemplate<typename T>\ninline T read(){\n    T x=0,f=0;char ch=getchar();\n    while(!isdigit(ch)) f|=(ch=='-'),ch=getchar();\n    while(isdigit(ch)) x=x*10+(ch^48),ch=getchar();\n    return f?-x:x;\n}\n\n#define rdi read<int>\n#define rdi64 read<i64>\n#define fi first\n#define se second\n#define pb push_back\n#define mp make_pair\n\nconst int K=110,S=1023;\n\nint k,s,p,d;\nbitset<S> f[K][S][10];\nint res[K];\n\nint main(){\n    k=rdi(),s=rdi(),p=rdi(),d=rdi();\n    f[0][0][0][0]=1;\n    for(int i=0;i<k;i++){\n        for(int j=0;j<=i*9;j++){\n            for(int x=0;x<10;x++){\n                for(int cur=i==k-1;cur<=9;cur++){\n                    int sum=x+cur*d;\n                    f[i+1][j+cur][sum/10]|=(f[i][j][x]<<(sum%10));\n                }\n            }\n        }\n    }\n    bool fl=0;\n    for(int x=0;x<10;x++){\n        if(p>=x&&f[k][s][x][p-x]){\n            p-=x,fl=1;\n            for(int i=k;i>=1;i--){\n                for(int cur=i==k;cur<=9;cur++){\n                    for(int px=0;px<10;px++){\n                        int ps=s-cur,sum=cur*d+px;\n                        if(ps<0||sum/10!=x) continue;\n                        int pp=p-sum%10;\n                        if(pp<0||!f[i-1][ps][px][pp]) continue;\n                        res[i]=cur,x=px,s=ps,p=pp;\n                        goto nxt;\n                    }\n                }\n                nxt:;\n            }\n            break;\n        }\n    }\n    if(!fl) puts(\"-1\");\n    else for(int i=k;i>=1;i--) putchar(res[i]+'0');\n    return 0;\n}\n\n```\n",
        "postTime": 1655987471,
        "uid": 107236,
        "name": "Zesty_Fox",
        "ccfLevel": 9,
        "title": "\u3010Luogu\u3011P5261 [JSOI2013]\u6570\u5b57\u7406\u8bba \u9898\u89e3"
    }
]
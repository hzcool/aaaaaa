[
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a\n\n**\u4e8c\u9879\u5f0f\u5b9a\u7406**\uff1a  \n\n$$ (x+y)^n=\\sum_{i=1}^nC_n^ix^iy^{n-i}  $$\n               \n\n**\u5362\u5361\u65af\u5b9a\u7406**\uff1a \n\n$$ Lucas(n,m,p)=C_{n \\bmod p}^{m \\bmod p}Lucas(n/p,m/p,p) $$\n\n\n\u9893\u4e00\u4e0b\u67ff\u5b50\n\n$$ (x^2+x+1)^n=((x-1)^2+3x)^n=\\sum_{i=1}^nC_n^i(x-1)^{2i}(3x)^{n-i}  $$\n\n\u53ef\u4ee5\u53d1\u73b0\u9664\u4e86 $ C_n^n(x-1)^{2n} $ \u8fd9\u4e00\u9879\uff0c\u5176\u4ed6\u9879\u7cfb\u6570\u7684\u56e0\u5b50\u90fd\u6709 $ 3 $\n\n\u663e\u7136\u662f\u6ca1\u6709\u610f\u4e49\u7684\n\n\u6240\u4ee5\u53ea\u8981\u8003\u8651 $ (x-1)^{2n} $ \u4e2d\u7b2c $ i $ \u9879\u7684\u7cfb\u6570\n\n $$ (x-1)^{2n}=\\sum_{i=1}^{2n}C_{2n}^ix^{i}(-1)^{2n-i} $$\n\n\u7b2c $ i $ \u9879\u7cfb\u6570\u5373 $ C_{2n}^{i}(-1)^{2n-i} $\n\n**\u5362\u5361\u65af\u5b9a\u7406**\u6c42\u4e00\u4e0b\u5c31\u597d\u4e86\n\n *\u2605,\u00b0*:.\u2606(\uffe3\u25bd\uffe3)/$:*.\u00b0\u2605* \u3002\n\n~~\u7801\u98ce\u6bd2\u7624\u83ab\u55b7~~\n\n```cpp\n#include<bits/stdc++.h>\n#define R register\n#define LL long long\nusing namespace std;\ninline long long read(){\n\tlong long x=0,d=1; char y=getchar();\n\twhile(y<'0'||y>'9'){if(y=='-')d=-1;y=getchar();}\n\twhile(y>='0'&&y<='9'){x=(x<<3)+(x<<1)+(y^'0');y=getchar();}\n\treturn x*d;\n}\nint k;\nLL n,i,fact[4],ny[4];\nint Cn(int a,int b){return a>b?0:fact[b]*ny[a]*ny[b-a]%3;}\nint lucas(LL a,LL b){return b?lucas(a/3,b/3)*Cn(a%3,b%3)%3:1;}\nint main(){\n\tk=read();\n\tfact[0]=fact[1]=ny[0]=ny[1]=1;\n\tfact[2]=ny[2]=2;\n\twhile(k--){\n\t\tn=read(); i=read();\n\t\tprintf(\"%d\\n\",(lucas(i,n<<1)*(i%2?-1:1)+3)%3);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1607072892,
        "uid": 86586,
        "name": "\u660e\u6708\u591c",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5947 \u3010[POI2003]Trinomial\u3011"
    },
    {
        "content": "### \u9898\u610f\u7b80\u8ff0\n\n$T$\u7ec4\u6570\u636e\u3002\u7ed9\u5b9a$n,m$\uff0c\u6c42$(x^2+x+1)^n$\u4e2d\uff0c$x^m$\u9879\u7684\u7cfb\u6570\u662f\u591a\u5c11\u3002\u7b54\u6848\u5bf9$3$\u53d6\u819c\u3002\n\uff08\u8fd9\u4e2a\u819c\u6570\u5f88\u795e\u5947\uff01\u6ce8\u610f\uff01\u7a81\u7834\u70b9\u5c31\u5728\u8fd9\uff01\uff09\n\n$T<=1e4$\uff0c$n<=1e15$\uff0c$m<=2n$\u3002\n\n### \u601d\u8def\u6846\u67b6\n\n\u7b54\u6848\u662f$C_{2n}^m\\times (m\\% 2+1)$\uff0c\u5bf9$3$\u53d6\u819c\uff08\u5199\u4e2a$Lucas$\u5373\u53ef\uff09\n\n### \u5177\u4f53\u601d\u8def\n\n\u9996\u5148\uff0c\u6211\u4eec\u5206\u62ec\u53f7\u8ba8\u8bba\u3002\u56e0\u4e3a\u662f$(x^2+x+1)^n$\uff0c\u6240\u4ee5\u6709$n$\u4e2a\u62ec\u53f7\uff0c\u5e76\u4e14\u6bcf\u4e2a\u62ec\u53f7\u53ef\u4ee5\u51fa$x^2,x,1$\u3002\u7136\u540e\u6211\u4eec\u8981\u6c42\uff0c\u6709\u591a\u5c11\u79cd\u65b9\u6848\u4f7f\u5f97\u6bcf\u4e2a\u62ec\u53f7\u4e2d\u51fa\u7684\u6570\u79ef\u4e3a$x^m$\u3002\n\n\u6211\u4eec\u5f00\u59cb\u6253\u8349\u7a3f\uff1a\u6211\u4eec\u628a$n$\u4e2a\u62ec\u53f7\u4ece$1$\u5230$n$\u987a\u5e8f\u7f16\u53f7\uff0c\u6bcf\u4e2a\u62ec\u53f7\u4e0a\u9762\u6709\u4e24\u4e2a\u590d\u9009\u6846\u3002\u6253\u4e86\u51e0\u4e2a\u52fe\uff0c\u5c31\u662f\u4ee3\u8868\u51fa$x$\u7684\u591a\u5c11\u6b21\u65b9\u3002\u5177\u4f53\u6765\u8bf4\u5c31\u662f\uff1a\n\u4e00\u4e2a\u90fd\u6ca1\u6253\u52fe\uff0c\u4ee3\u8868\u51fa$x^0$\uff08$x^0$\u5c31\u662f$1$\uff09\uff1b\u5176\u4e2d\u4e00\u4e2a\u6253\u4e86\u52fe\uff0c\u4ee3\u8868\u51fa$x$\uff1b\u4e24\u4e2a\u90fd\u6253\u4e86\u52fe\uff0c\u4ee3\u8868\u51fa$x^2$\u3002\n\n\u5982\u56fe\u6240\u793a\u662f$n=4$\u7684\u60c5\u51b5\uff1a\n![blog1.jpg](https://i.loli.net/2020/02/04/DsbuTYf5nrc3mRk.jpg)\n\n\u6211\u4eec\u8fd9\u6837\u52fe\u9009\uff1a\n![blog2.jpg](https://i.loli.net/2020/02/04/4E2JqIRoXkTnzha.jpg)\n\n\u90a3\u5c31\u76f8\u5f53\u4e8e\uff1a\n\u7b2c\u4e00\u4e2a\u62ec\u53f7\u51fa$x$\n\u7b2c\u4e8c\u4e2a\u62ec\u53f7\u51fa$x^2$\n\u7b2c\u4e09\u4e2a\u62ec\u53f7\u51fa$x$\n\u7b2c\u56db\u4e2a\u62ec\u53f7\u51fa$x$\n\u90a3\u5b83\u5c31\u4f1a\u7ed9$x^5$\u90a3\u4e00\u9879\u8d21\u732e\u4e00\u79cd\u60c5\u51b5\u3002\n\n\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u8003\u8651$x^m$\u9879\u7684\u7cfb\u6570\uff0c\u6362\u53e5\u8bdd\u8bf4\u5c31\u662f\u6709\u591a\u5c11\u79cd\u65b9\u6cd5\u51d1\u51fa$x^m$\u3002\n\n\u663e\u7136\uff0c\u4e0a\u9762\u7684\u590d\u9009\u6846\u4e2d\uff0c\u6211\u4eec\u6bcf\u6253\u4e00\u4e2a\u52fe\uff0c\u4e58\u51fa\u6765\u5c31\u591a\u4e00\u4e2a$x$\u3002\uff08\u4e0a\u9762\u6253\u4e86$5$\u4e2a\u52fe\uff0c\u4e58\u8d77\u6765\u5c31\u662f$x^5$\uff09\u7136\u540e\u4e00\u5171\u6709$2n$\u4e2a\u590d\u9009\u6846\uff0c\u6240\u4ee5\u7b54\u6848\u5c31\u662f$C_{2n}^m$\u3002\n\n\u8fd9\u5c31\u5b8c\u4e86\uff1f\u4e0d\uff01\u8fd9\u6837\u8003\u8651\u6709\u91cd\u590d\u7684\uff01\n\n\u5047\u5982\u7b2c$i$\u4e2a\u62ec\u53f7\u51fa\u7684\u662f$x$\uff0c\u90a3\u5c31\u76f8\u5f53\u4e8e\u5728$i$\u4e0a\u9762\u4e24\u4e2a\u590d\u9009\u6846\u4e2d\uff0c**\u5176\u4e2d\u4e00\u4e2a**\u8981\u6253\u52fe\u3002\u800c\u6211\u4eec**\u53ea\u5728\u610f\u6570\u91cf**\uff0c\u5177\u4f53\u6253\u52fe\u6253\u4e0a\u9762\u90a3\u4e2a\u6846\u8fd8\u662f\u4e0b\u9762\u7684\u90a3\u4e2a\uff0c**\u662f\u4e00\u6837\u7684**\u3002\u90a3\u5c31\u4f1a\u628a\u4e00\u4e2a\u7b54\u6848\u7b97\u4e24\u904d\uff0c\u6240\u4ee5\u8981\u9664\u4ee5$2$\u3002\n\n\u5047\u8bbe\u6211\u4eec\u6709$k$\u4e2a\u62ec\u53f7\u51fa\u7684\u662f$x$\uff0c\u90a3\u4e48\u6211\u4eec\u7684\u7b54\u6848\u5c31\u8981\u9664\u4ee5\u4e00\u4e2a$2^k$\u3002\n\n\u9996\u5148\uff0c$k$\u548c$m$\u80af\u5b9a\u662f\u540c\u5947\u5076\u7684\u3002\n\n> \u7a0d\u5fae\u8bc1\u4e00\u4e0b\uff08\u4f1a\u8bc1\u8df3\u8fc7\uff09\uff1a \u6709$k$\u4e2a\u62ec\u53f7\u51fa$x$\uff0c\u90a3\u5269\u4e0b$x^{m-k}$\u90fd\u662f\u7531\u51fa$1$\u6216$x^2$\u7ec4\u6210\u7684\u3002$m-k$\u7531\u82e5\u5e72\u4e2a$0$\u548c$2$\u76f8\u52a0\u800c\u6210\uff0c\u6240\u4ee5$m-k$\u662f\u5076\u6570\u3002\u6240\u4ee5$m$\u548c$k$\u540c\u5947\u5076\u3002\n\n\u7136\u540e\uff0c\u5728\u6a21\u4e09\u610f\u4e49\u4e0b\uff0c**2\u7684\u9006\u5143\u5c31\u662f\u5176\u672c\u8eab**\uff01\u6240\u4ee5\uff0c\u9664\u4ee5\u4e00\u4e2a$2^k$\uff0c\u5c31\u76f8\u5f53\u4e8e\u4e58\u4ee5\u4e00\u4e2a$2^k$\u3002\n\n\u8fd8\u6ca1\u5b8c\uff0c\u6211\u4eec\u7ee7\u7eed\u5316\u3002\u6211\u4eec\u53d1\u73b0\uff0c$2$\u7684\u5e42\u9664\u4ee5$3$\u7684\u4f59\u6570\u662f\uff1a$2,1,2,1,2,1...$\u3002\u5177\u4f53\u70b9\u8bf4\uff0c$2^k\\% 3=(k\\% 2)+1$\u3002\u800c$k$\u548c$m$\u53c8\u540c\u5947\u5076\uff0c\u6240\u4ee5\uff0c\u6240\u6709\u7684$k\\% 2+1$\u90fd\u7b49\u4e8e$m\\% 2+1$\u3002\n\n\u7efc\u4e0a\uff0c\u6211\u4eec\u7684\u7b54\u6848\u5c31\u662f$C_{2n}^m\\times (m\\% 2+1)$\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nnamespace Flandre_Scarlet\n{\n    #define int long long \n    #define F(i,l,r) for(int i=l;i<=r;++i)\n    #define D(i,r,l) for(int i=r;i>=l;--i)\n    #define Fs(i,l,r,c) for(int i=l;i<=r;c)\n    #define Ds(i,r,l,c) for(int i=r;i>=l;c)\n    #define MEM(x,a) memset(x,a,sizeof(x))\n    #define FK(x) MEM(x,0)\n    #define Tra(i,u) for(int i=G.Start(u),__v=G.To(i);~i;i=G.Next(i),__v=G.To(i))\n    #define p_b push_back\n    #define sz(a) ((int)a.size())\n    #define iter(a,p) (a.begin()+p)\n    void R1(int &x)\n    {\n        x=0;char c=getchar();int f=1;\n        while(c<'0' or c>'9') f=(c=='-')?-1:1,c=getchar();\n        while(c>='0' and c<='9') x=(x<<1)+(x<<3)+(c^48),c=getchar();\n        x=(f==1)?x:-x;\n    }\n    void Rd(int cnt,...)\n    {\n        va_list args;\n        va_start(args,cnt);\n        F(i,1,cnt) \n        {\n            int* x=va_arg(args,int*);R1(*x);\n        }\n        va_end(args);\n    }\n\n    int n,m;\n    void Input()\n    {\n        Rd(2,&n,&m);\n    }\n\n    int c[4][4];\n    int C(int n,int m) //\u5362\u5361\u65af\u5b9a\u7406\u6c42C(n,m)%3\n    {\n        if (n==0 and m==0) return 1;\n        return C(n/3,m/3)*c[n%3][m%3]%3;\n    }\n    void Soviet()\n    {\n        c[0][0]=1;\n        c[1][1]=c[1][0]=1;\n        c[2][0]=c[2][2]=1;c[2][1]=2; //\u9884\u5904\u7406<3\u7684\u7ec4\u5408\u6570\n        printf(\"%lld\\n\",C(2*n,m)*(m%2+1)%3); //\u7528\u4e0a\u9762\u7684\u5f0f\u5b50\n    }\n\n    #define Flan void\n    Flan IsMyWife()\n    {\n        int t;R1(t);\n        F(i,1,t)\n        {\n            Input();\n            Soviet();\n        }\n    }\n    #undef int //long long \n}\nint main(){\n    Flandre_Scarlet::IsMyWife();\n    getchar();getchar();\n    return 0;\n}\n```",
        "postTime": 1580822475,
        "uid": 106252,
        "name": "LightningUZ",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5947 \u3010[POI2003]Trinomial\u3011"
    },
    {
        "content": "\u770b\u8d77\u6765\u6ca1\u6709\u5934\u7eea\u7684\u9898\u76ee\uff0c\u5176\u5b9e\u5173\u952e\u5728\u4e8e\uff1a__\u8f93\u51fa $x_i\\bmod3$ \u7684\u7ed3\u679c\u3002__\n\n\u8003\u8651\u628a\u539f\u5f0f\u8f6c\u5316\u6210\u4e00\u4e2a\u7cfb\u6570\u5e26 3 \u7684\u5f0f\u5b50\uff1a\n\n$$(x^2+x+1)^n$$\n\n$$=[(x-1)^2+3x]^n$$\n\n\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c55\u5f00\u5f97\n\n$$=(x-1)^{2n}-C^{1}_{n}(x-1)^{2(n-1)}\\times3x+C^{2}_{n}(x-1)^{2(n-2)}\\times(3x)^2+...+(3x)^n$$\n\n\u53d1\u73b0\u540e\u9762\u7684\u6240\u6709\u9879\u4e2d\u90fd\u5305\u542b\u4e86 3\uff0c\u4e5f\u5c31\u662f\u8bf4\u7cfb\u6570\u6a21\u4e09\u4ee5\u540e\u90fd\u6ca1\u6709\u4e86 qwq\n\n\u56e0\u6b64\u8f93\u51fa $(x-1)^{2n}$ \u4e2d\u7684\u7cfb\u6570\u5373\u53ef\u3002\n\n```cpp\n#include<cstdio>\nusing namespace std;\ntypedef long long ll;\nconst ll mod=3;\ninline ll read()\n{\n\tll s=0; char c=getchar();\n\twhile(c<'0'||c>'9') c=getchar();\n\twhile(c>='0'&&c<='9') s=(s<<3)+(s<<1)+(c&15),c=getchar();\n\treturn s;\n}\nll T,x,y,a[1000010];\nll pow(ll x,ll y)\n{\n\tll l=1;\n\twhile(y)\n\t{\n\t\tif(y&1) l=l*x%mod;\n\t\tx=x*x%mod; y>>=1;\n\t}\n\treturn l;\n}//\u5feb\u901f\u5e42\nll C(ll n,ll m) {return m>n?0:(a[n]*pow(a[m],mod-2))%mod*pow(a[n-m],mod-2)%mod;}//\u7ec4\u5408\u6570\nll lucas(ll n,ll m) {return !m?1:C(n%mod,m%mod)*lucas(n/mod,m/mod)%mod;}//\u5362\u5361\u65af\nint main()\n{\n\ta[0]=a[1]=1;\n\tfor(int i=2;i<100010;i++) a[i]=a[i-1]*i%mod;\n\tT=read();\n\twhile(T--)\n\t{\n\t\tx=read(),y=read();\n\t\tprintf(\"%lld\\n\",(lucas(x*2,y)*pow(-1,2*x-y)+mod)%mod);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1636777915,
        "uid": 54372,
        "name": "A_\u0110ark_Horcrux",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P5947 \u3010[POI2003]Trinomial\u3011"
    }
]
[
    {
        "content": "[$$\\large\\texttt{My Blog}$$](https://yzxoi.top/archives/1615)\n\n## Description\n> [\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P4893)\n\n\u7ed9\u5b9a\u4e00\u4e2a $n$ \u6b21\u6574\u7cfb\u6570\u51fd\u6570 $f(x)$\uff0c\u95ee $f(x)$ \u7684 $k$ \u9636\u5bfc\u5728 $x_i$ \u5904\u7684\u5bfc\u6570\u3002\n\n$1\\leq n \\leq 100,k\\leq n,m\\leq 10,a_i\\leq 10^5,x_i\\leq 10^5$\n## Solution\n\u5f88\u597d\u5947\u8fd9\u9898\u662f\u600e\u4e48\u8bc4\u7d2b\u7684\uff08\uff1f\n\n\u54b3\u54b3\uff0c\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u4f60\u5148\u8981\u6709**\u4ebf**\u70b9**\u7b80\u5355**\u9ad8\u7b49\u6570\u5b66\u77e5\u8bc6\u3002\n\n- $f(x)=x^p$ \u7684 $k$ \u9636\u5bfc\u51fd\u6570\u4e3a $f^{(k)}(x)=\\prod_{i=1}^k(p-i+1)x^{p-k}$\n- $f(x)=g(x)+h(x)$ \u7684 $k$ \u9636\u5bfc\u51fd\u6570\u4e3a $f^{(k)}(x)=g^{(k)}(x)+h^{(k)}(x)$\n\n\u8bc1\u660e\u7565\uff08\n\n\u5047\u8bbe\u4f60\u5df2\u7ecf\u719f\u77e5\u4e86\u4ee5\u4e0a\u7ed3\u8bba\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u6109\u5feb\u7684\u628a\u8fd9\u9053\u9898\u5207\u6389\u4e86\u3002\n\n\u76f4\u63a5\u66b4\u529b\u62c6\u51fa\u6bcf\u4e00\u9879\u7684\u7cfb\u6570\uff0c\u66b4\u529b\u8fdb\u884c\u6c42\u5bfc\uff0c\u627e\u5230\u5176 $k$ \u9636\u5bfc\u51fd\u6570\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\uff0c\u76f4\u63a5\u66b4\u529b\u5e26\u5165\u5373\u53ef\u3002\n\n\u56e0\u4e3a $a_i\\leq 10^5,x_i \\leq 10^5$ \u53ef\u80fd\u4f1a\u5bfc\u81f4\u7b54\u6848\u7206 $int$\uff0c\u6240\u4ee5\u4f60\u8fd8\u8981~~\u8010\u5fc3\u5730\u5199\u4e00\u4e2a\u9ad8\u7cbe~~\u5957\u4e00\u4e2a\u9ad8\u7cbe\u6a21\u677f\u3002\n\n## Code\n```cpp\n#include<bits/stdc++.h>\n#define Tp template<typename Ty>\n#define Ts template<typename Ty,typename... Ar>\n#define W while\n#define I inline\n#define RI register int\n#define LL long long\n#define Cn const\n#define gc getchar\n#define DD isdigit(c=gc())\n#define pc(c) putchar((c))\n#define min(x,y) ((x)<(y)?(x):(y))\n#define max(x,y) ((x)>(y)?(x):(y))\nusing namespace std;\nnamespace Debug{\n\tTp I void _debug(Cn char* f,Ty t){cerr<<f<<'='<<t<<endl;}\n\tTs I void _debug(Cn char* f,Ty x,Ar... y){W(*f!=',') cerr<<*f++;cerr<<'='<<x<<\",\";_debug(f+1,y...);}\n\tTp ostream& operator<<(ostream& os,Cn vector<Ty>& V){os<<\"[\";for(Cn auto& vv:V) os<<vv<<\",\";os<<\"]\";return os;}\n\t#define gdb(...) _debug(#__VA_ARGS__,__VA_ARGS__)\n}using namespace Debug;\nnamespace FastIO{\n\tTp I void read(Ty& x){char c;int f=1;x=0;W(!DD) f=c^'-'?1:-1;W(x=(x<<3)+(x<<1)+(c&15),DD);x*=f;}\n\tTs I void read(Ty& x,Ar&... y){read(x),read(y...);}\n\tTp I void write(Ty x){x<0&&(pc('-'),x=-x,0),x<10?(pc(x+'0'),0):(write(x/10),pc(x%10+'0'),0);}\n\tTp I void writeln(Cn Ty& x){write(x),pc('\\n');}\n}using namespace FastIO;\nCn int N=110;\nclass Int{//Manchery\u7684\u9ad8\u7cbe\u6a21\u677f\n\t#define BASE 1000000000\n\tpublic:\n\ttypedef long long value;\n\tvoid New(size_t l){\n\t\tif (a!=NULL)delete[] a;a=new value[l];\n\t\tlen=1;a[0]=0;sign=1;\n\t}\n\tInt():a(NULL),base(BASE){New(1);}\n\tInt(value x):a(NULL),base(BASE){New(1);*this=x;}\n\tInt(value x,value _base):a(NULL),base(_base){New(1);*this=x;}\n\tInt(const Int &B):a(NULL),base(BASE){New(1);*this=B;}\n\t~Int(){delete[] a;}\n\tInt& operator =(value x){\n\t\tsize_t l=1;for (value x1=max(x,-x);x1>=base;++l,x1/=base);New(l);\n\t\tif (x<0)x=-x,sign=0;else sign=1;\n\t\tlen=0;while (x)a[len++]=x%base,x/=base;\n\t\tif (!len)a[len++]=0;\n\t\treturn *this;\n\t}\n\tInt& operator =(const Int &A){\n\t\tNew(A.len);len=A.len;memcpy(a,A.a,sizeof(value)*len);\n\t\tbase=A.base;sign=A.sign;return *this;\n\t}\n\tfriend Int operator -(Int A){A.sign=1-A.sign;return A;}\n\tbool operator !(){if (len==1&&a[0]==0)return 1;else return 0;}\n\tfriend Int operator +(Int A,Int B){\n\t\tif (A.sign!=B.sign){B.sign=1-B.sign;return A-B;}\n\t\tif (A.base!=B.base)\n\t\t\tif (A.base>B.base)B.set_base(A.base);\n\t\t\telse A.set_base(B.base);\n\t\tInt res;res.set_base(A.base); int len=A.len>B.len?A.len:B.len;\n\t\tres.New(len+1);res.sign=A.sign;\n\t\tmemset(res.a,0,(len+1)*sizeof(value));\n\t\tfor (int i=0;i<len;++i){\n\t\t\tif (i<A.len)res.a[i]+=A.a[i];\n\t\t\tif (i<B.len)res.a[i]+=B.a[i];\n\t\t}\n\t\tfor (int i=0;i<len;++i)\n\t\t\tif (res.a[i]>=res.base)++res.a[i+1],res.a[i]-=res.base;\n\t\tif (res.a[len])res.len=len+1;else res.len=len;\n\t\tif (!res)res.sign=1;return res;\n\t}\n\tfriend Int operator -(Int A,Int B){\n\t\tif (A.sign!=B.sign){B.sign=1-B.sign;return A+B;}\n\t\tif (A.base!=B.base)\n\t\t\tif (A.base>B.base)B.set_base(A.base);\n\t\t\telse A.set_base(B.base);\n\t\tif (small(A,B))swap(A,B),A.sign=1-A.sign;\n\t\tInt res;res.set_base(A.base); int len=A.len>B.len?A.len:B.len;\n\t\tres.New(len);res.sign=A.sign;\n\t\tmemset(res.a,0,len*sizeof(value));\n\t\tfor (int i=0;i<len;++i){\n\t\t\tif (i>=B.len)res.a[i]+=A.a[i];\n\t\t\telse res.a[i]+=A.a[i]-B.a[i];\n\t\t\tif (res.a[i]<0)res.a[i]+=res.base,--res.a[i+1];\n\t\t}\n\t\twhile (len>1&&!res.a[len-1])--len;res.len=len;\n\t\tif (!res)res.sign=1;return res;\n\t}\n\tfriend Int operator *(Int A,Int B){\n\t\tif (A.base!=B.base)\n\t\t\tif (A.base>B.base)B.set_base(A.base);\n\t\t\telse A.set_base(B.base);\n\t\tInt res;res.set_base(A.base); int len=A.len+B.len;\n\t\tres.New(len);res.sign=(A.sign==B.sign);\n\t\tmemset(res.a,0,len*sizeof(value));\n\t\tfor (int i=0;i<A.len;++i)\n\t\t\tfor (int j=0;j<B.len;++j){\n\t\t\t\tres.a[i+j]+=A.a[i]*B.a[j];\n\t\t\t\tres.a[i+j+1]+=res.a[i+j]/res.base;\n\t\t\t\tres.a[i+j]%=res.base;\n\t\t\t}\n\t\t/*\n\t\tfor (int i=0;i<A.len;++i)\n\t\t\tfor (int j=0;j<B.len;++j)res.a[i+j]+=A.a[i]*B.a[j];\n\t\tfor (int i=0;i<len-1;++i)res.a[i+1]+=res.a[i]/res.base,res.a[i]%=res.base;\n\t\t*/\n\t\twhile (len>1&&!res.a[len-1])--len;res.len=len;\n\t\treturn res;\n\t}\n\tfriend pair<Int,Int> divide(Int A,Int B){\n\t\tif (!B){puts(\"error:div zero!\");for (;;);}\n\t\tif (A.base!=B.base)\n\t\t\tif (A.base>B.base)B.set_base(A.base);\n\t\t\telse A.set_base(B.base);\n\t\tif (small(A,B))return make_pair(Int(0),A);\n\t\tInt C,D;C.set_base(A.base);D.set_base(A.base);C.New(A.len);C.len=A.len;\n\t\tbool Csign=(A.sign==B.sign),Dsign=A.sign;A.sign=B.sign=1;\n\t\tfor (int i=A.len-1;i>=0;--i){\n\t\t\tC.a[i]=0;D=D*D.base;D.a[0]=A.a[i];\n\t\t\tint l=0,r=A.base-1,mid;\n\t\t\twhile (l<r){\n\t\t\t\tmid=(l+r+1)>>1;\n\t\t\t\tif (small(B*mid,D+1))l=mid;\n\t\t\t\t\telse r=mid-1;\n\t\t\t}\n\t\t\tC.a[i]=l;D=D-B*l;\n\t\t}\n\t\tC.sign=Csign;D.sign=Dsign;if (!D)D.sign=1;\n\t\twhile (C.len>1&&!C.a[C.len-1])--C.len;\n\t\treturn make_pair(C,D);\n\t}\n\tInt operator /(value x){\n\t\tif (!x){puts(\"error:div zero!\");for (;;);}\n\t\tvalue d=0;Int res;res.set_base(base);res.New(len);res.len=len;\n\t\tif (x<0)x=-x,res.sign=(sign==0);\n\t\telse res.sign=(sign==1);\n\t\tfor (int i=len-1;i>=0;--i)\n\t\t\td=d*base+a[i],res.a[i]=d/x,d%=x;\n\t\twhile (res.len>1&&!res.a[res.len-1])--res.len;\n\t\treturn res;\n\t}\n\tInt operator %(value x){\n\t\tvalue d=0;if (x<0)x=-x;\n\t\tfor (int i=len-1;i>=0;--i)d=(d*base+a[i])%x;\n\t\treturn d;\n\t}\n\tfriend Int abs(Int A){A.sign=1;return A;}\n\tfriend bool small(Int A,Int B){\n\t\tif (A.base!=B.base)\n\t\t\tif (A.base>B.base)B.set_base(A.base);\n\t\t\telse A.set_base(B.base);\n\t\tif (A.len!=B.len)return A.len<B.len;\n\t\tfor (int i=A.len-1;i>=0;--i)\n\t\t\tif (A.a[i]!=B.a[i])return A.a[i]<B.a[i];\n\t\treturn 0;\n\t}\n\tfriend bool operator <(Int A,Int B){\n\t\tif (A.sign!=B.sign)return A.sign<B.sign;\n\t\treturn A.sign==1?small(A,B):small(B,A);\n\t}\n\tfriend bool operator ==(Int A,Int B){\n\t\tif (A.base!=B.base)\n\t\t\tif (A.base>B.base)B.set_base(A.base);\n\t\t\telse A.set_base(B.base);\n\t\tif (A.sign!=B.sign||A.len!=B.len)return 0;\n\t\tfor (int i=0;i<A.len;++i)if (A.a[i]!=B.a[i])return 0;\n\t\treturn 1;\n\t}\n\tfriend bool operator !=(Int A,Int B){return !(A==B);}\n\tfriend bool operator >(Int A,Int B){return !(A<B||A==B);}\n\tfriend bool operator <=(Int A,Int B){return A<B||A==B;}\n\tfriend bool operator >=(Int A,Int B){return A>B||A==B;}\n\tInt operator /(Int B){return divide(*this,B).first;}\n\tInt operator %(Int B){return divide(*this,B).second;}\n\tInt& operator +=(Int B){*this=*this+B;return *this;}\n\tInt& operator -=(Int B){*this=*this-B;return *this;}\n\tInt& operator *=(Int B){*this=*this*B;return *this;}\n\tInt& operator /=(Int B){*this=*this/B;return *this;}\n\tInt& operator %=(Int B){*this=*this%B;return *this;}\n\tInt& operator ++(){*this=*this+1;return *this;}\n\tInt& operator --(){*this=*this-1;return *this;}\n\tInt operator ++(int){Int res(*this);*this=*this+1;return res;}\n\tInt operator --(int){Int res(*this);*this=*this-1;return res;}\n\tInt operator +(value x){return *this+Int(x,this->base);}\n\tInt operator -(value x){return *this-Int(x,this->base);}\n\tInt operator *(value x){return *this*Int(x,this->base);}\n\t//Int operator /(value x){Int T;T=x;return *this/T;}\n\t//Int operator %(value x){Int T;T=x;return *this%T;}\n\tInt& operator *=(value x){*this=*this*x;return *this;}\n\tInt& operator +=(value x){*this=*this+x;return *this;}\n\tInt& operator -=(value x){*this=*this-x;return *this;}\n\tInt& operator /=(value x){*this=*this/x;return *this;}\n\tInt& operator %=(value x){*this=*this%x;return *this;}\n\tbool operator ==(value x){return *this==Int(x,this->base);}\n\tbool operator !=(value x){return *this!=Int(x,this->base);}\n\tbool operator <=(value x){return *this<=Int(x,this->base);}\n\tbool operator >=(value x){return *this>=Int(x,this->base);}\n\tbool operator <(value x){return *this<Int(x,this->base);}\n\tbool operator >(value x){return *this>Int(x,this->base);}\n\tfriend Int gcd(Int x,Int y){\n\t\tInt t;int cnt=0;\n\t\twhile (1){\n\t\t\tif (x<y)t=x,x=y,y=t;\n\t\t\tif (y==0){\n\t\t\t\twhile (cnt--)x*=2;\n\t\t\t\treturn x;\n\t\t\t}\n\t\t\tif (x%2==0&&y%2==0)x/=2,y/=2,++cnt;\n\t\t\telse if (x%2==0)x/=2;\n\t\t\telse if (y%2==0)y/=2;\n\t\t\telse {t=x;x=y;y=t-y;}\n\t\t}\n\t}\n\tvoid to_arr(char *c){\n\t\tchar *c1=c;\n\t\tfor (int i=0;i<len-1;++i)\n\t\t\tfor (value x=a[i],b=base/10;b>=1;b/=10)*c1++='0'+x%10,x/=10;\n\t\tfor (value x=a[len-1];x>0;x/=10)*c1++='0'+x%10;\n\t\tif (len==1&&a[len]==0)*c1++='0';\n\t\tif (sign==0)*c1++='-';*c1=0;reverse(c,c1);\n\t}\n\tvoid from_arr(char *c){\n\t\tsize_t base_l=get_basel(),b=1;int cl=strlen(c);value x=0;\n\t\tNew((cl+base_l-1)/base_l);len=0;\n\t\tif (*c=='-')sign=0,++c,--cl;else sign=1;\n\t\twhile (--cl>=0){\n\t\t\tx+=(c[cl]-'0')*b;b*=10;if (b==base)a[len++]=x,x=0,b=1;\n\t\t}\n\t\tif (!len||x)a[len++]=x;\n\t\twhile (len>1&&!a[len-1])--len;\n\t}\n\tvoid set_base(int _base){\n\t\tif (base==_base)return;\n\t\tchar *c=new char[len*get_basel()+1];\n\t\tto_arr(c);base=_base;from_arr(c);\n\t\tdelete[] c;\n\t}\n\tvoid set_basel(int _l){\n\t\tsize_t _base=1;while (_l--)_base*=10;set_base(_base);\n\t}\n\tvoid read(){\n\t\tvector<char> s;char ch;\n\t\tscanf(\" %c\",&ch);if (ch=='-')s.push_back('-'),ch=getchar();\n\t\tfor (;ch>='0'&&ch<='9';ch=getchar())s.push_back(ch);\n\t\tchar *c=new char[s.size()+1];\n\t\tfor (int i=0;i<s.size();++i)c[i]=s[i];c[s.size()]=0;\n\t\tfrom_arr(c);delete[] c;\n\t\tif (!*this)this->sign=1;\n\t}\n\tvoid print(){\n\t\tif (!sign)putchar('-');\n\t\tprintf(\"%d\",int(a[len-1]));\n\t\tfor (int i=len-2;i>=0;--i){\n\t\t\tfor (int j=base/10;j>=10;j/=10)\n\t\t\t\tif (a[i]<j)putchar('0');\n\t\t\t\t\telse break;\n\t\t\tprintf(\"%d\",(int)a[i]);\n\t\t}\n\t}\n\tvoid println(){print();putchar('\\n');}\n\tprivate:\n\tvalue *a,base;int len;bool sign;  //0=\"-\"\n\tsize_t get_basel()const{\n\t\tsize_t res=0;for (int b=base/10;b>=1;b/=10,++res);\n\t\treturn res;\n\t}\n\t#undef BASE\n};\nInt num[N],Ans[N],top=1,ans;\nint n,m,k,len;\nstring str;\nI Int fpow(int a,int b){Int A=a,s=1;W(b!=0){if(b%2==1) s*=A;A*=A;b=b/2;}return s;}//\u9ad8\u7cbe\u5feb\u901f\u5e42\nint main(){\n\tRI i,j,s;for(read(n,k),cin>>str,len=str.length(),i=5;i<len;)\n\t\tif(isdigit(str[i])){j=i+1;s=str[i]-'0';W(j<len&&isdigit(str[j])) s=s*10+str[j]-'0',j++;top=s,i=j;}//\u5904\u7406\u7cfb\u6570\n\t\telse if(str[i]=='x'){j=i+1;s=0;W(j<len&&str[j]!='^') ++j;j++;W(j<len&&isdigit(str[j])) s=s*10+str[j]-'0',++j;num[s]+=top;top=1;i=j;}//\u5904\u7406\u6b21\u6570\n\t\telse i++;\n\tfor(i=0;i<=n;i++)\n\t\tif(i-k>=0) for(Ans[i-k]=num[i],j=1;j<=k;j++) Ans[i-k]*=i-j+1;//\u76f4\u63a5\u6c42\u5bfc\u5957\u516c\u5f0f\n\tfor(read(m);m--;){for(read(s),ans=j=0;j<=n;j++) ans=ans+Ans[j]*fpow(s,j);ans.println();}//\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\u76f4\u63a5\u66b4\u529b\u8ba1\u7b97\n\treturn 0;\n}\n```",
        "postTime": 1612762928,
        "uid": 37103,
        "name": "yzxoi",
        "ccfLevel": 7,
        "title": "LuoguP4893 GodFly\u7684\u6c42\u5bfc\u5de5\u5177 \u9898\u89e3"
    }
]
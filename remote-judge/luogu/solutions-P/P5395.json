[
    {
        "content": "\u4f17\u6240\u5468\u77e5\uff0c\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u6709\u6027\u8d28\uff1a\n\n$$\nm^n=\\sum_{i=0}^m \\binom m i  \\left\\{ \\begin{matrix} n \\\\ i \\end{matrix} \\right\\} i!\n$$\n\n\u7136\u540e\u53ef\u4ee5\u6109\u5feb\u5730\u4e8c\u9879\u5f0f\u53cd\u6f14\u4e86\u3002\n\n\u8bbe\n$$\nf(m)=m^n,g(m)= \\left\\{ \\begin{matrix} n \\\\ m \\end{matrix} \\right\\}m!\n$$\n\n\u90a3\u4e48\u5c31\u6709\n\n$$\n\nf(m)=\\sum_{i=0}^m \\binom{m}{i}g(i) \\Leftarrow\\Rightarrow g(m)=\\sum_{i=0}^m \\binom{m}{i}(-1)^{m-i}f(i)=\\sum_{i=0}^m\\binom m i(-1)^{m-i} i^n\n$$\n\n\u4e8e\u662f\u5c31\u6709\n$$\n\\left\\{ \\begin{matrix} n \\\\ m \\end{matrix} \\right\\}m!=\\sum_{i=0}^m \\binom m i (-1)^{m-i} i^n\n$$\n\n$$\n\\left\\{ \\begin{matrix} n \\\\ m \\end{matrix} \\right\\}=\\sum_{i=0}^m \\frac{\\binom m i (-1)^{m-i}i^n}{m!}\n$$\n\n\u628a\u7ec4\u5408\u6570\u62c6\u5f00\u6765\uff0c\u5c31\u6709\uff1a\n\n$$\n\\left\\{ \\begin{matrix} n\\\\m \\end{matrix} \\right\\}=\\sum_{i=0}^m \\frac{i^n}{i!} \\frac{(-1)^{m-i}}{(m-i)!}\n$$\n\n\u53d1\u73b0\u8fd9\u663e\u7136\u5c31\u662f\u4e00\u4e2a\u5377\u79ef\u5f62\u5f0f\uff0c`NTT` \u78be\u8fc7\u53bb\u5373\u53ef\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long \ntypedef long long ll;\nconst ll mod=167772161;\nint G=3,invG;\nconst int N=2400000;\nll ksm(ll b,int n){\n    ll res=1;\n    while(n){\n        if(n&1) res=res*b%mod;\n        b=b*b%mod; n>>=1;\n    }\n    return res;\n}\nint tr[N];\nvoid NTT(ll *f,int n,int fl){\n    for(int i=0;i<n;++i)\n        if(i<tr[i]) swap(f[i],f[tr[i]]);\n    for(int p=2;p<=n;p<<=1){\n        int len=(p>>1);\n        ll w=ksm((fl==0)?G:invG,(mod-1)/p);\n        for(int st=0;st<n;st+=p){\n            ll buf=1,tmp;\n            for(int i=st;i<st+len;++i)\n                tmp=buf*f[i+len]%mod,\n                f[i+len]=(f[i]-tmp+mod)%mod,\n                f[i]=(f[i]+tmp)%mod,\n                buf=buf*w%mod;\n        }\n    }\n    if(fl==1){\n        ll invN=ksm(n,mod-2);\n        for(int i=0;i<n;++i)\n            f[i]=(f[i]*invN)%mod;\n    }\n}\nll f[N],g[N],a[N],b[N],fac[N],inv[N];\nvoid init(int n){\n    fac[0]=1;\n    for(int i=1;i<=n;++i)\n        fac[i]=1ll*fac[i-1]*i%mod;\n    inv[n]=ksm(fac[n],mod-2);\n    for(int i=n-1;i>=0;--i)\n        inv[i]=1ll*(i+1)*inv[i+1]%mod;\n}\nsigned main(){\n    invG=ksm(G,mod-2);\n    int n;\n    scanf(\"%lld\",&n);\n    init(n);\n    for(int i=0;i<=n;++i)\n        a[i]=(i&1?mod-inv[i]:inv[i]),\n        b[i]=ksm(i,n)*inv[i]%mod;\n    int limit=1;\n    while(limit<=(n<<1)) limit<<=1;\n    for(int i=0;i<=limit;++i)\n        tr[i]=(tr[i>>1]>>1)|(i&1?limit>>1:0);\n    NTT(a,limit,0);NTT(b,limit,0);\n    for(int i=0;i<=limit;++i)\n        a[i]=a[i]*b[i]%mod;\n    NTT(a,limit,1);\n    for(int i=0;i<=n;++i)\n        printf(\"%lld \",a[i]);\n    return 0;\n}\n```\n\n\n\u987a\u4fbf\u8bb2\u4e00\u4e0b\u5217\u7684\u505a\u6cd5\uff08\n\n\n\u6bcf\u4e2a\u76d2\u5b50\u7684 $EGF$ \u663e\u7136\u5c31\u662f $g(x)=\\sum_{i=1}^n \\frac{1}{i!}x^i=e^x-1$\uff0c\u628a\u76d2\u5b50\u7684 $EGF$ \u76f8\u4e58\u5c31\u53ef\u4ee5\u5f97\u5230 $(e^x-1)^k$ \uff08\u5176\u4e2d $k$ \u662f\u76d2\u5b50\u7684\u4e2a\u6570\uff09\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u5f97\u5230\"\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\"\u7684 $EGF$ \u4e86\u3002\u4f46\u662f\u8fd8\u6709\u4e2a\u95ee\u9898\u5c31\u662f\u76d2\u5b50\u662f\u76f8\u540c\u7684\uff0c\u800c\u6211\u4eec\u5728\u63a8\u5bfc $EGF$ \u7684\u8fc7\u7a0b\u4e2d\u662f\u628a\u6bcf\u4e2a\u76d2\u5b50\u6309\u4e0d\u540c\u7684\u6765\u770b\u5f85\u7684\uff0c\u76f4\u63a5\u628a\u8fd9\u4e2a\"\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\"\u9664\u4ee5 $k!$ \u5373\u53ef\uff0c\u662f\u975e\u5e38\u663e\u7136\u7684\u53bb\u91cd\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u5f97\u5230\u771f\u6b63\u7684\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u3002\n\n\u81f3\u4e8e $(e^x-1)^k$ \u600e\u4e48\u7b97\uff0c\u76f4\u63a5\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u5373\u53ef\u3002\n\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long \ntypedef long long ll;\nconst ll mod=167772161;\nll G=3,invG;\nconst int N=1200000;\nll ksm(ll b,int n){\n\tll res=1;\n\twhile(n){\n\t\tif(n&1) res=res*b%mod;\n\t\tb=b*b%mod; n>>=1;\n\t}\n\treturn res;\n}\nint read(){\n\tint x=0;char ch=getchar();\n\twhile(!isdigit(ch))ch=getchar();\n\twhile(isdigit(ch)) x=(x*10+(ch-'0'))%mod,ch=getchar();\n\treturn x;\n}\nint tr[N];\nvoid NTT(ll *f,int n,int fl){\n\tfor(int i=0;i<n;++i)\n\t\tif(i<tr[i]) swap(f[i],f[tr[i]]);\n\tfor(int p=2;p<=n;p<<=1){\n\t\tint len=(p>>1);\n\t\tll w=ksm((fl==0)?G:invG,(mod-1)/p);\n\t\tfor(int st=0;st<n;st+=p){\n\t\t\tll buf=1,tmp;\n\t\t\tfor(int i=st;i<st+len;++i)\n\t\t\t\ttmp=buf*f[i+len]%mod,\n\t\t\t\tf[i+len]=(f[i]-tmp+mod)%mod,\n\t\t\t\tf[i]=(f[i]+tmp)%mod,\n\t\t\t\tbuf=buf*w%mod;\n\t\t}\n\t}\n\tif(fl==1){\n\t\tll invN=ksm(n,mod-2);\n\t\tfor(int i=0;i<n;++i)\n\t\t\tf[i]=(f[i]*invN)%mod;\n\t}\n}\nvoid Mul(ll *f,ll *g,ll *p,int n,int m){\n\tm+=n;n=1;\n\twhile(n<m) n<<=1;\n\tfor(int i=0;i<n;++i)\n\t\ttr[i]=(tr[i>>1]>>1)|((i&1)?(n>>1):0);\n\tNTT(f,n,0);\n\tNTT(g,n,0);\n\tfor(int i=0;i<n;++i) p[i]=f[i]*g[i]%mod;\n\tNTT(p,n,1);\n\t\n}\n\nvoid Inv(ll *f,ll *g,int m){\n\tif(m==1){\n\t\tg[0]=ksm(f[0],mod-2);\n\t\treturn;\n\t}\n\tstatic ll w[N];\n\tInv(f,g,(m+1)>>1);\n\tint n=1;\n\twhile(n<(m<<1)) n<<=1;\n\tfor(int i=0;i<m;++i) w[i]=f[i];\n\tfor(int i=m;i<n;++i) w[i]=0;\n\tfor(int i=0;i<n;++i)\n\t\ttr[i]=(tr[i>>1]>>1)|((i&1)?(n>>1):0);\n\tNTT(w,n,0);\n\tNTT(g,n,0);\n\tfor(int i=0;i<n;++i)\n\t\tg[i]=((2*g[i]-g[i]*g[i]%mod*w[i]%mod)%mod+mod)%mod;\n\tNTT(g,n,1);\n\tfor(int i=m;i<n;++i) g[i]=0; \n}\nvoid diff(ll *f,ll *g,int n){\n\tfor(int i=1;i<n;++i)\n\t\tg[i-1]=f[i]*i%mod;\n\tg[n-1]=0;\n}\nvoid integ(ll *f,ll *g,int n){\n\tfor(int i=1;i<n;++i)\n\t\tg[i]=f[i-1]*ksm(i,mod-2)%mod;\n\tg[0]=0;\n}\nll f_wf[N],f_inv[N],ans[N];\nvoid Ln(ll *f,ll *g,int n){\n\tfor(int i=0;i<(n<<2);++i) f_wf[i]=f_inv[i]=ans[i]=0;\n\tdiff(f,f_wf,n);\n\tInv(f,f_inv,n);\n\tMul(f_wf,f_inv,ans,n,n);\n\tinteg(ans,g,n);\n}\nvoid Exp(ll *f,ll *g,int m){\n\tif(m==1){\n\t\tg[0]=1;return;\n\t}\n\tExp(f,g,(m+1)>>1);\n\tstatic ll w[N],ln[N];\n\tfor(int i=0;i<m;++i) ln[i]=0;\n\tLn(g,ln,m);\n\tint n=1;\n\twhile(n<(m<<1)) n<<=1;\n\tfor(int i=0;i<n;++i)\n\t\ttr[i]=(tr[i>>1]>>1)|(i&1?n>>1:0);\n\tfor(int i=0;i<m;++i) w[i]=f[i];\n\tfor(int i=m;i<n;++i) w[i]=0;\n\tNTT(w,n,0);NTT(g,n,0);NTT(ln,n,0);\n\tfor(int i=0;i<n;++i)\n\t\tg[i]=g[i]*(1-ln[i]+w[i]+mod)%mod;\n\tNTT(g,n,1);\n\tfor(int i=m;i<n;++i) g[i]=0;\n}\nint k2;\nvoid Pow(ll *f,ll *g,int n,int k){\n\tstatic ll _f[N],lnf[N];\n\tll deg=0;\n\twhile(f[deg]==0) ++deg;\n\tif(deg*k>n) return;\n\tn-=deg;\n\tfor(int i=0;i<n;++i)\n\t\t_f[i]=f[i+deg];\n\tll f0=_f[0],inv0=ksm(_f[0],mod-2);\n\tfor(int i=0;i<n;++i)\n\t\t_f[i]=_f[i]*inv0%mod;\n\tLn(_f,lnf,n);\n\tfor(int i=0;i<n;++i)\n\t\tlnf[i]=lnf[i]*k%mod;\n\tExp(lnf,g,n);\n\tdeg=deg*k2;\n\tfor(int i=n+deg-1;i>=deg;--i)\n\t\tg[i]=g[i-deg]*ksm(f0,k2)%mod;\n\tfor(int i=0;i<deg;++i) g[i]=0;\n}\nll f[N],g[N];\nll inv[N],fac[N];\nvoid init(int n){\n\tfac[0]=1;\n\tfor(int i=1;i<=n;++i)\n\t\tfac[i]=1ll*fac[i-1]*i%mod;\n\tinv[n]=ksm(fac[n],mod-2);\n\tfor(int i=n-1;i>=0;--i)\n\t\tinv[i]=1ll*inv[i+1]*(i+1)%mod;\n}\nstring s;\nsigned main(){\n\tinvG=ksm(G,mod-2);\n\tint n,k=0;\n\tcin>>n>>k;++n;\n\tif(k>=n){\n\t\tfor(int i=0;i<n;++i) putchar('0'),putchar(' ');\n\t\treturn 0;\n\t}\n\tk2=k;\n\tinit(max(n,k));\n\tfor(int i=1;i<n;++i)\n\t\tf[i]=inv[i];\n\tPow(f,g,n,k);\n\tfor(int i=0;i<n;++i)\n\t\tg[i]=g[i]*fac[i]%mod*inv[k]%mod,\n\t\tprintf(\"%lld \",g[i]);\n\treturn 0;\n}\n```\n\n\u672c\u6765\u60f3\u518d\u628a \u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u00b7\u884c/\u5217 \u7ed9\u8bb2\u6389\u7684\uff0c\u4f46\u8fd9\u6837\u535a\u5ba2\u5b9e\u5728\u592a\u957f\u4e86\uff0c\u5c31\u7b97\u4e86\u5427\uff08\n\n\u987a\u4fbf\u4e00\u63d0\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u00b7\u5217\u7684\u505a\u6cd5\u4e0e\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u00b7\u5217\u7684\u505a\u6cd5\u76f8\u4f3c",
        "postTime": 1594262322,
        "uid": 344016,
        "name": "wurzang",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5395 \u3010\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u00b7\u884c\u3011"
    },
    {
        "content": "\u6211\u4eec\u5b9a\u4e49\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570 $\\begin{Bmatrix} n \\\\m \\end{Bmatrix}$ \u8868\u793a\u628a $n$ \u4e2a\u4e0d\u540c\u5143\u7d20\u5212\u5206\u6210 $m$ \u4e2a\u76f8\u540c\u7684\u96c6\u5408\u4e2d\u7684\u65b9\u6848\u6570\u3002\n\n\u53c8\u540d\u6574\u6570\u7684\u65e0\u5e8f\u5206\u62c6\u6570\uff0c\u4e5f\u53ef\u4ee5\u8868\u793a\u4e3a $S(n,m)=\\begin{Bmatrix} n \\\\m \\end{Bmatrix}$\u3002\n\n\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u67092\u4e2a\u91cd\u8981\u6027\u8d28:\n\n1. $\\begin{Bmatrix} n \\\\m \\end{Bmatrix}$ $=$ $\\begin{Bmatrix} n-1 \\\\m-1 \\end{Bmatrix}+m\\times \\begin{Bmatrix} n-1 \\\\m \\end{Bmatrix}$\u3002\n\n\t\u8bc1\u660e\uff1a\u8bbe\u539f\u96c6\u5408\u4e3a $\\begin{Bmatrix}a_1,a_2\\cdots a_n\\end{Bmatrix}$ \u6211\u4eec\u5c06\u539f\u59cb\u72b6\u6001\u5206\u4e3a\u4e24\u79cd\u60c5\u51b5\u3002\n\n\t\u5206\u522b:$\\begin{Bmatrix}a_n\\end{Bmatrix}$ \u505a\u4e3a\u72ec\u7acb\u7684\u96c6\u5408\uff0c\u6b64\u65f6\u7b54\u6848\u4e3a $\\begin{Bmatrix} n-1 \\\\m-1 \\end{Bmatrix}$\uff1b\n\n\t\u53e6\u4e00\u79cd\u60c5\u51b5\u5219\u662f $\\begin{Bmatrix}a_n\\end{Bmatrix}$ \u88ab\u63d2\u5165\u4e86\u4e00\u4e2a\u975e\u7a7a\u96c6\u5408\uff0c\u56e0\u4e3a\u6709 $m$ \u79cd\u9009\u62e9\uff0c\u7b54\u6848\u663e\u7136\u4e3a $m\\times \\begin{Bmatrix} n-1 \\\\m \\end{Bmatrix}$\u3002\n\n1. $m^n=\\displaystyle \\sum _{i=1}^{m} \\begin{Bmatrix}n\\\\i\\end{Bmatrix} \\times i! \\times \\begin{pmatrix}m\\\\i\\end{pmatrix}$\u3002\n\n\t\u8fd9\u4e2a\u53ef\u4ee5\u8fd9\u4e48\u7406\u89e3\uff1a\u5de6\u9762\u4e3a\u5c06 $n$ \u4e2a\u6570\u968f\u610f\u653e\u5728 $m$ \u4e2a\u96c6\u5408\u4e2d\u7684\u65b9\u6848\u6570\uff0c\u53ef\u4ee5\u5b58\u5728\u7a7a\u96c6\uff1b\n\n\t\u800c\u53f3\u9762\u4e3a\u679a\u4e3e**\u975e\u7a7a\u96c6\u5408**\u4e2a\u6570 $i$ \u540e\u6c42\u89e3\u8be5\u60c5\u51b5\u7684\u7b54\u6848\uff0c\u5de6\u9762\u663e\u7136\u7b49\u4e8e\u53f3\u9762\u3002\u6ce8\u610f\u4e58\u7684 $i!$ \u542b\u4e49\u4e3a\u7ed9\u4e0e\u8fd9 $i$ \u4e2a\u96c6\u5408\u987a\u5e8f\u3002\n\n\u5316\u7b80\uff1a\u7531\u4e8c\u9879\u5f0f\u53cd\u6f14\n$$f(n) = \\sum_{i = 0}^{n} \\begin{pmatrix}n\\\\i\\end{pmatrix}g(i) \\Leftrightarrow g(n) = \\sum_{i = 0}^{n} (-1)^{n-i} \\begin{pmatrix}n\\\\i\\end{pmatrix}f(i)$$\n$$\\begin{Bmatrix}n\\\\m\\end{Bmatrix} m!=\\sum\\limits _{i=1}^{m}(-1)^{m-i}\\begin{pmatrix}m\\\\i\\end{pmatrix}i^n$$\n\n$$\\begin{Bmatrix}n\\\\m\\end{Bmatrix}=\\sum\\limits _{i=1}^{m}\\frac{(-1)^{m-i}}{(m-i)!}\\times \\frac{i^n}{i!}$$\n\n\u8fd9\u662f\u4e00\u4e2a\u5377\u79ef\u5f62\u5f0f\uff0c\u4f7f\u7528 ntt \u5373\u53ef\n\n\u4ee3\u7801\n``` cpp\n#include<bits/stdc++.h>\n#include<cstdlib>\nusing namespace std;\n#define int long long\ninline void read(int &x)\n{\n    char c=getchar();x=0;int f=1;\n    while(c>'9'||c<'0') {if(c=='-') f=-1;c=getchar();}\n    while(c<='9'&&c>='0') x=(x<<1)+(x<<3)+c-'0',c=getchar();\n    x=x*f;\n}\nconst int p=167772161ll,w=3,N=2e6+10;\ninline int qpow(int a,int b)\n{\n    int k=1ll;\n    while(b)\n    {\n        if(b&1) k=k*a%p;\n        a=a*a%p;\n        b=b>>1;\n    }\n    return k;\n}\nint inv[N],n,f[N],g[N],lim,len,rev[N];\ninline int upmod(int x)\n{\n    return (x%p+p)%p;\n}\ninline void ntt(int *a,int f)\n{\n    for(int i=0;i<lim;i++)\n        if(i<rev[i]) swap(a[i],a[rev[i]]);\n    for(int mid=1;mid<lim;mid<<=1)\n    {\n        int wn=qpow(w,(((p-1)/(mid<<1)*f)+p-1));\n        for(int j=0;j<lim;j+=(mid<<1))\n        {\n            int g=1;\n            for(int k=0;k<mid;k++,g=g*wn%p)\n            {\n                int x=a[k+j],y=g*a[k+j+mid]%p;\n                a[k+j]=upmod(x+y);\n                a[k+j+mid]=upmod(x-y+p);\n            }\n        }\n    }\n    if(f==-1)\n    {\n        int Inv=qpow(lim,(p-2));\n        for(int i=0;i<lim;i++) a[i]=a[i]*Inv%p;\n    }\n}\nsigned main()\n{\n    read(n);n++;\n    inv[0]=1;\n    for(int i=1;i<n;i++) inv[i]=inv[i-1]*i%p;\n    for(int i=1;i<n;i++) inv[i]=qpow(inv[i],p-2);\n    for(int i=0;i<n;i++)\n    {\n        f[i]=(i&1?(p-inv[i]):inv[i]);\n        g[i]=qpow(i,n-1)*inv[i]%p;\n    }\n    lim=1,len=0;\n    while(lim<=(n<<1)) len++,lim<<=1;\n    for(int i=0;i<lim;i++) rev[i]=(rev[i>>1]>>1)|((i&1)<<(len-1));\n    ntt(f,1);ntt(g,1);\n    for(int i=0;i<lim;i++) f[i]=f[i]*g[i]%p;\n    ntt(f,-1);\n    for(int i=0;i<n;i++) printf(\"%lld \",f[i]);\n\n}\n```",
        "postTime": 1586269010,
        "uid": 184069,
        "name": "Imitators",
        "ccfLevel": 0,
        "title": "\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u00b7\u884c"
    },
    {
        "content": "\u5982\u679c\u4f60\u4e0d\u77e5\u5230\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\uff0c\u53ef\u4ee5\u770b\u770b\u6211\u7684[\u7ec4\u5408\u6570\u5b66\u7684\u4e00\u4e9b\u5c0f\u77e5\u8bc6\u603b\u7ed3](https://www.luogu.org/blog/wohaocaia/zu-ge-shuo-xue-di-yi-suo-xiao-zhi-shi-zong-jie-wei-wan-post)\u624d\u521a\u5f00\u59cb\u5199\uff0c\u672a\u5b8c\u5f85\u7eed\uff0c\u5927\u4f6c\u8f7b\u55b7\u3002\n\n~~\u597d\u6c34\u7684\u6a21\u677f\u554a\uff0c\u4e0d\u5982\u6539\u6210\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5~~\n\n\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u7684\u901a\u9879\u516c\u5f0f~~\u8bc1\u660e\u5728\u535a\u6587\u91cc\u54e6\uff0c\u8fd8\u6709\u5404\u79cd\u6027\u8d28~~\n\n$$S_m^n=\\sum_ {i=0}^n \\frac {(-1)^{i}}{i!}\\times \\frac{(n-i)^m}{(n-i)!}$$\n\n\u7528\u9898\u76ee\u91cc\u7684\u8868\u793a\u65b9\u6cd5\u5c31\u662f\n\n$$\\begin{Bmatrix} m \\\\n \\end{Bmatrix}=\\sum_{i=0}^n \\frac {(-1)^{i}}{i!}\\times \\frac{(n-i)^m}{(n-i)!}$$\n\n\u8fd9\u663e\u7136\u5c31\u662f\u4e00\u4e2a\u5377\u79ef\u5f0f\u3002\n\n\u76f4\u63a5\u9884\u5904\u7406\u9636\u4e58\u9006\u5143\uff0c\u6253\u5feb\u901f\u5e42\u677f\u5b50\uff0c$NTT$\u5373\u53ef\n\n**\u6ce8\u610f**$167772161$\u7684**\u539f\u6839**\u662f$3$\n\n```cpp\n#include<bits/stdc++.h>\n#define ljc 167772161\n#define int long long\n#define ll long long\nusing namespace std;\nint n,m,k,r[800006],lim,w[800006],a[800006],b[800006],inv[800006];\ninline ll fast_pow(ll a,ll b,ll p){\n    ll t=1;a%=p;\n    while (b){\n        if (b&1) t=t*a%p;\n        b>>=1;a=a*a%p;\n    }\n    return t;\n}\ninline void NTT(ll f[],int lim,int id){\n    for (int i=0;i<lim;i++){\n        if (i<r[i]) swap(f[r[i]],f[i]);\n    }\n    w[0]=1;\n    for (int len=1;len<lim;len<<=1){\n        ll gen=fast_pow(3,(ljc-1)/(len<<1)*id+ljc-1,ljc);\n        for (int i=1;i<len;i++) w[i]=w[i-1]*gen%ljc;\n        for (int i=0;i<lim;i+=len<<1){\n            ll *f1=f+i,*f2=f1+len;\n            for (int j=0;j<len;j++){\n                ll x=f1[j]%ljc,y=f2[j]*w[j]%ljc;\n                f1[j]=(x+y)%ljc;f2[j]=(x-y+ljc)%ljc;\n            }\n        }\n    }\n    if (id==1) return;\n    ll Inv=fast_pow(lim,ljc-2,ljc);\n    for (int i=0;i<lim;i++) f[i]=f[i]*Inv%ljc;\n}\nsigned main(){\n    cin>>n;n++;\n    inv[0]=inv[1]=1;\n    for (int i=2;i<n;i++) inv[i]=(ljc-(ljc/i)*inv[ljc%i]%ljc)%ljc;\n    for (int i=1;i<n;i++) inv[i]=inv[i-1]*inv[i]%ljc;\n    for (int i=0,one=1;i<n;one=ljc-one,i++){\n        a[i]=one*inv[i]%ljc;b[i]=fast_pow(i,n-1,ljc)*inv[i]%ljc;\n    }\n    int lim=1,len=0;\n    while (lim<=(n<<1)) lim<<=1,len++;\n    for (int i=0;i<lim;i++) r[i]=(r[i>>1]>>1)|((i&1)<<(len-1));\n    NTT(a,lim,1);NTT(b,lim,1);\n    for (int i=0;i<lim;i++) a[i]=a[i]*b[i]%ljc;\n    NTT(a,lim,-1);\n    for (int i=0;i<n;i++) printf(\"%lld \",a[i]);\n}\n```\n\n",
        "postTime": 1558058955,
        "uid": 20309,
        "name": "Fading",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5395 \u3010\u3010\u6a21\u677f\u3011\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u00b7\u884c\u3011"
    },
    {
        "content": "\u6709\u5f0f\u5b50$x^n=\\sum_{i=0}^n \\begin{Bmatrix}n\\\\i\\end{Bmatrix}x^{\\underline i}$\u3002\n\n\u6240\u4ee5\u76f8\u5f53\u4e8e\u6c42\u4e00\u4e2a\u4e0b\u964d\u5e42\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u3002\n\n\u90a3\u4e48\u5148\u628a$x^n$\u5728$x\\in[0,n]$\u7684\u70b9\u503c\u641e\u51fa\u6765\uff08\u53ef\u4ee5\u7ebf\u6027\u7b5b\uff09\uff0c\u7136\u540e\u8f6c\u4e0b\u964d\u5e42\u7cfb\u6570\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\log n)$\u3002\n\n## Code\uff1a\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\nconst int md=167772161,N=524288,g3=(md+1)/3;\ntypedef long long LL;\nint n,lim,rev[N];\ninline void upd(int&a){a+=a>>31&md;}\ninline int pow(int a,int b){\n    int ret=1;\n    for(;b;b>>=1,a=(LL)a*a%md)if(b&1)ret=(LL)ret*a%md;\n    return ret;\n}\nint pri[N/10],isp[N],a[N],fac[N],inv[N],tot,k,b[N],c[N],iv[N];\nvoid init(const int n){\n    a[1]=1;\n    for(int i=2;i<=n;++i){\n        if(!isp[i])pri[++tot]=i,a[i]=pow(i,n);\n        for(int j=1;j<=tot&&i*pri[j]<=n;++j){\n            isp[i*pri[j]]=1,a[i*pri[j]]=a[i]*(LL)a[pri[j]]%md;\n            if(i%pri[j]==0)break;\n        }\n    }\n}\nvoid initFFT(int n){\n    int l=-1;\n    for(lim=1;lim<n;lim<<=1)++l;\n    for(int i=1;i<lim;++i)rev[i]=(rev[i>>1]>>1)|((i&1)<<l);\n}\nvoid NTT(int*a,int f){\n    for(int i=1;i<lim;++i)if(i<rev[i])std::swap(a[i],a[rev[i]]);\n    for(int i=1;i<lim;i<<=1){\n        const int gi=pow(f?3:g3,(md-1)/(i<<1));\n        for(int j=0;j<lim;j+=i<<1)\n        for(int k=0,g=1;k<i;++k,g=(LL)g*gi%md){\n            const int x=a[j+k],y=(LL)g*a[j+k+i]%md;\n            upd(a[j+k]+=y-md),upd(a[j+k+i]=x-y);\n        }\n    }\n    if(!f){\n        const int iv=pow(lim,md-2);\n        for(int i=0;i<lim;++i)a[i]=(LL)a[i]*iv%md;\n    }\n}\nint main(){\n    scanf(\"%d\",&n);\n    init(n);\n    initFFT(++n<<1);\n    for(int i=*fac=1;i<n;++i)fac[i]=(LL)fac[i-1]*i%md;\n    inv[n-1]=pow(fac[n-1],md-2);\n    for(int i=n-2;~i;--i)iv[i]=inv[i]=(i+1LL)*inv[i+1]%md;\n    for(int i=1;i<n;++i)a[i]=(LL)a[i]*inv[i]%md,b[i-1]=inv[i];\n    for(int i=0;i<n;++i)\n    if(i&1)inv[i]=md-inv[i];\n    NTT(a,1),NTT(inv,1);\n    for(int i=0;i<lim;++i)a[i]=(LL)a[i]*inv[i]%md;\n    NTT(a,0);\n    for(int i=0;i<n;++i)\n    printf(\"%d%c\",a[i],\" \\n\"[i==n-1]);\n    return 0;\n}\n\n```",
        "postTime": 1558161815,
        "uid": 6813,
        "name": "mrsrz",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5395 \u3010\u3010\u6a21\u677f\u3011\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u00b7\u884c\u3011"
    },
    {
        "content": "### \u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\n\n$S(n,k)$ \u4e3a\u628a $n$ \u4e2a\u6570\u5206\u6210 $k$ \u4e2a\u65e0\u533a\u5206\u96c6\u5408\u7684\u65b9\u6848\u6570\uff0c\u4e5f\u53ef\u4ee5\u8868\u793a\u4e3a $\\begin{Bmatrix}n\\\\k\\end{Bmatrix}$\u3002\n$$\n\\begin{Bmatrix}n\\\\k\\end{Bmatrix}=\\begin{Bmatrix}n-1\\\\k-1\\end{Bmatrix}+\\begin{Bmatrix}n-1\\\\k\\end{Bmatrix}k\n$$\n\u8003\u8651\u7ec4\u5408\u610f\u4e49\u5373\u53ef\uff0c$n$\u200b \u662f\u5355\u72ec\u4e00\u4e2a\u96c6\u5408\u8fd8\u662f\u5206\u5728\u524d\u9762\u7684\u96c6\u5408\u4e2d\u3002\n$$\n\\begin{Bmatrix}n\\\\k\\end{Bmatrix}=\\sum_{i=1}^n \\begin{Bmatrix}n-i\\\\k-1\\end{Bmatrix}\\binom{n-1}{i-1}\n$$\n\u8003\u8651\u7ec4\u5408\u610f\u4e49\u5373\u53ef\uff0c$i$ \u4e3a\u679a\u4e3e\u7684 $1$ \u6240\u5728\u7684\u96c6\u5408\u5927\u5c0f\u662f\u591a\u5c11\u3002\n\n#### \u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u901a\u9879 / \u4e00\u884c\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u6c42\u548c\n\n\u6709\u4e00\u4e2a\u6052\u7b49\u5f0f\uff1a\n$$\nm^n=\\sum_{i=0}^{n}m^{\\underline i}\\begin{Bmatrix}n\\\\i\\end{Bmatrix}=\\sum_{i=0}^n\\binom{m}{i}\\begin{Bmatrix}n\\\\i\\end{Bmatrix}i!\n$$\n\u8003\u8651\u7ec4\u5408\u610f\u4e49\u5373\u53ef\uff0c\u5de6\u8fb9\u662f $n$ \u4e2a\u7403\u653e\u5165 $m$\u200b\u200b \u4e2a\u53ef\u7a7a\u76d2\u5b50\u7684\u65b9\u6848\u6570\uff0c\u53f3\u8fb9\u662f\u679a\u4e3e\u975e\u7a7a\u7684\u96c6\u5408\u6570\uff0c\u4ea6\u53ef\u4ee5\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bc1\u660e\u3002\n\n\u4e8c\u9879\u5f0f\u53cd\u6f14\u5f97\uff1a\n$$\n\\begin{Bmatrix}n\\\\m\\end{Bmatrix}m!=\\sum_{i=0}^m(-1)^{m-i}\\binom{m}{i}i^n\n$$\n\u8fdb\u4e00\u6b65\u8f6c\u5316\u53ef\u5f97\uff1a\n$$\n\\begin{Bmatrix}n\\\\m\\end{Bmatrix}=\\sum_{i=0}^{m} \\frac{(-1)^{i}}{i !} \\cdot \\frac{(m-i)^{n}}{(m-i) !}\n$$\n\u8fd9\u6837\u5c31\u5316\u6210\u4e86\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u53ef\u4ee5 $\\mathcal{O}(n\\log n)$ \u6c42\u5f97\u6240\u6709\u7684 $\\begin{Bmatrix}n\\\\i\\end{Bmatrix}$\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\ntypedef long long ll;\nconst ll mod = 167772161;\nll Add(ll x, ll y) { return (x + y >= mod) ? (x + y - mod) : (x + y); }\nll Mul(ll x, ll y) { return x * y % mod; }\nll Mod(ll x) { return (x < 0) ? (x + mod) : (x >= mod ? (x - mod) : x); }\ntemplate <typename T>\nT &read(T &r) {\n\tr = 0; bool w = 0; char ch = getchar();\n\twhile(ch < '0' || ch > '9') w = ch == '-' ? 1 : 0, ch = getchar();\n\twhile(ch >= '0' && ch <= '9') r = r * 10 + (ch ^ 48), ch = getchar();\n\treturn r = w ? -r : r;\n}\nll qpow(ll x, ll y) {\n\tll sumq = 1;\n\twhile(y) {\n\t\tif(y&1) sumq = sumq * x % mod;\n\t\tx = x * x % mod;\n\t\ty >>= 1; \n\t}\n\treturn sumq;\n} \nconst int N = 4000010;\n\nint p[N];\nll *getw(int n, int type) {\n\tstatic ll w[N / 2];\n\tw[0] = 1;\n\tw[1] = qpow(type==1 ? 3 : 55924054, (mod-1) / n);\n\tfor(int i = 2; i < n / 2; ++i) w[i] = w[i-1] * w[1] % mod;\n\treturn w;\n}\nvoid NTT(ll *a, int n, int type) {\n\tfor(int i = 0; i < n; ++i)\n\t\tif(i < p[i]) std::swap(a[i], a[p[i]]);\n\tfor(int i = 1; i < n; i <<= 1) {\n\t\tll *w = getw(i << 1, type);\n\t\tfor(int j = 0; j < n; j += i << 1) {\n\t\t\tll *b = a + j, *c = b + i;\n\t\t\tfor(int k = 0; k < i; ++k) {\n\t\t\t\tll v = w[k] * c[k] % mod;\n\t\t\t\tc[k] = Add(b[k], Mod(-v));\n\t\t\t\tb[k] = Add(b[k], v);\n\t\t\t}\n\t\t}\n\t} ll inv = qpow(n, mod-2);\n\tif(type == -1) for(int i = 0; i < n; ++i) a[i] = a[i] * inv % mod;\n}\nint n, m;\nll fac[N], inv[N], a[N], b[N];\nsigned main() {\n\tm = read(n);\n\tfac[0] = 1; for(int i = 1; i <= n; ++i) fac[i] = fac[i-1] * i % mod;\n\tinv[0] = 1; inv[n] = qpow(fac[n], mod-2);\n\tfor(int i = n-1; i; --i) inv[i] = inv[i+1] * (i+1) % mod;\n\tfor(int i = 0; i <= n; ++i) a[i] = (i&1) ? (mod-inv[i]) : inv[i], b[i] = qpow(i, n) * inv[i] % mod;\n\tint ct = 0, len = 1;\n\twhile(len <= n + m) len <<= 1, ++ct;\n\tfor(int i = 0; i < len; ++i)\n\t\tp[i] = ((p[i>>1]>>1) | ((i & 1) << (ct - 1)));\n\tNTT(a, len, 1);\n\tNTT(b, len, 1);\n\tfor(int i = 0; i < len; ++i) a[i] = a[i] * b[i] % mod;\n\tNTT(a, len, -1);\n\tfor(int i = 0; i <= n; ++i) printf(\"%lld \", a[i]);\n\treturn 0;\n}\n```",
        "postTime": 1629681128,
        "uid": 223298,
        "name": "do_while_true",
        "ccfLevel": 8,
        "title": "\u300c\u9898\u89e3\u300d\u6d1b\u8c37P5395 \u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u00b7\u884c"
    },
    {
        "content": "## $\\texttt{Description}$\n\n\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570 $\\begin{Bmatrix} n \\\\m \\end{Bmatrix}$ \u8868\u793a\u628a $n$ \u4e2a\u4e0d\u540c\u5143\u7d20\u5212\u5206\u6210 $m$ \u4e2a\u76f8\u540c\u7684\u96c6\u5408\u4e2d\uff08\u4e0d\u80fd\u6709\u7a7a\u96c6\uff09\u7684\u65b9\u6848\u6570\u3002\n   \n   \u7ed9\u5b9a $n$\uff0c\u5bf9\u4e8e\u6240\u6709\u7684\u6574\u6570 $i\\in[0,n]$\uff0c\u4f60\u8981\u6c42\u51fa $\\begin{Bmatrix} n \\\\i \\end{Bmatrix}$\u3002\n   \n$1\\le n\\le 2\\times 10^5$\n\n## $\\texttt{Solution}$\n\n\u8bb2\u8bfe\u628a\u8fd9\u4e2a\u9898\u8bb2\u4e86\uff0c\u6765\u5199\u4e2a\u9898\u89e3\u3002\n\n\u5b9e\u9645\u4e0a\u662f\u4e8c\u9879\u5f0f\u53cd\u6f14\u7684\u6a21\u677f\u9898\u3002\n\n### \u524d\u7f6e\u77e5\u8bc6\n\n- ntt\n- \u4e8c\u9879\u5f0f\u53cd\u6f14\n\n### \u89e3\u6cd5\n\n\u8003\u8651\u5982\u4e0b\u5f0f\u5b50\uff1a\n$$\n    m^n = \\sum_{i=0}^m \\binom{m}{i} \\times \\begin{Bmatrix} n \\\\i \\end{Bmatrix} \\times i!\n    $$\n    \n\u5173\u4e8e\u5f0f\u5b50\u7684\u6b63\u786e\u6027\uff0c\u8003\u8651\u7ec4\u5408\u610f\u4e49\uff1a\u5de6\u4fa7\u662f $m$ \u4e2a**\u4e0d\u540c**\u76d2\u5b50\u653e $n$ \u4e2a\u7403\u7684\u65b9\u6848\u6570\uff0c\u53f3\u8fb9\u662f\u679a\u4e3e $i$ \u4e2a\u96c6\u5408\u975e\u7a7a\uff0c\u8d4b\u6807\u53f7\u3002\n\n\u7136\u540e\u968f\u4fbf\u4e8c\u9879\u5f0f\u53cd\u6f14\u4e00\u4e0b\uff1a\n   \n$$\n    m!\\begin{Bmatrix} n \\\\m \\end{Bmatrix} = \\sum_{i=0}^m(-1)^{m-i}\\binom{m}{i} i^n\n$$\n    \n $$\n    \\begin{Bmatrix} n \\\\m \\end{Bmatrix} = \\sum_{i=0}^m\\dfrac {(-1)^{m-i}} {(m-i)!} \\dfrac {i^n}{i!}\n$$\n\u663e\u7136\u7684\u52a0\u6cd5\u5377\u79ef\u3002\n\n## $\\texttt{Code}$\n```cpp\ninline void solve() {\n    cin >> n ; \n    for (int i = 0; i <= n; ++i) a[i] = (i&1?mod-ifac[i]:ifac[i]);\n    for (int i = 0; i <= n; ++i) b[i] = 1ll*ksm(i,n)*ifac[i] % mod ;\n //   for (int i = 0; i < n; ++i) cout << a[i] << \" \" << b[i] << endl ;\n    mul(a,b,c,n<<1) ;\n    for (int i = 0; i <= n; ++i) cout << c[i] << \" \";\n    cout << endl ;\n}\n```",
        "postTime": 1629611081,
        "uid": 413147,
        "name": "_Alejandro_",
        "ccfLevel": 0,
        "title": "Luogu P5395 \u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u00b7\u884c"
    },
    {
        "content": "\u591a\u4e86\u666e\u901a\u5e42\u8f6c\u4e0b\u964d\u5e42\u7b49\u5f0f\u7684\u8bc1\u660e\n\n\u6027\u8d28\uff1a\n\n$$n^m=\\sum_{k=0}^m \\begin{Bmatrix} m \\\\k \\end{Bmatrix} n^{\\underline k}$$\n\n\u8bc1\u660e\uff1a\n\n$$\\sum_{k=0}^m \\begin{Bmatrix}m\\\\k\\end{Bmatrix}n^{\\underline k}=\\sum_{k=1}^{m}\\begin{Bmatrix}m-1\\\\k-1\\end{Bmatrix} n^{\\underline {k}} +\\sum_{k=1}^{m} k\\begin{Bmatrix}m-1\\\\k\\end{Bmatrix} n^{\\underline {k}}=\\sum_{k=0}^{m-1} \\begin{Bmatrix} m-1\\\\k\\end{Bmatrix} n^{\\underline {k+1}} +\\sum_{k=1}^{m} k\\begin{Bmatrix} m-1\\\\k\\end{Bmatrix}n^{\\underline {k}}=(n-k+k)n^{m-1}=n^m$$\n\n$$n^m=\\sum_{k=0}^m \\begin{Bmatrix} m \\\\k \\end{Bmatrix} n^{\\underline k}=\\sum_{i=0}^{m}\\begin{Bmatrix}m\\\\i\\end{Bmatrix}\\dfrac{n!}{(n-i)!}$$\n\n\u628a\u540e\u9762\u7684\u4e0b\u964d\u5e42\u4e58\u4e2a $k!$\uff0c\u5f04\u51fa\u7ec4\u5408\u6570\n\n$$=\\sum_{i=0}^{m}\\begin{Bmatrix}m\\\\i\\end{Bmatrix}\\binom{n}{i}i!$$\n\n\u8bbe $f(m)=m^n,g(i)=\\begin{Bmatrix}m\\\\i\\end{Bmatrix}i!$\n\n\u4e8c\u9879\u5f0f\u53cd\u6f14\u518d\u5316\u7b80\u540e\u53ef\u5f97\n\n$$\\begin{Bmatrix} n \\\\m \\end{Bmatrix}=\\sum_{i=0}^{m}\\dfrac{(-1)^i}{i!}\\times\\dfrac{(m-i)^n}{(m-i)!}$$\n\n\u7136\u540e\u5c31\u662f\u4e2a\u5377\u79ef\uff0c\u7528NTT\u6c42\u5373\u53ef\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\n#define int long long \ninline int read(){\n\tregister int x=0,f=0,ch=getchar();\n\twhile('0'>ch||ch>'9')f^=ch=='-',ch=getchar();\n\twhile('0'<=ch&&ch<='9')x=(x<<1)+(x<<3)+(ch^'0'),ch=getchar();\n\treturn f?-x:x;\n}\nconst int P=167772161,G=3,MAX=1e6+5;\nint n,GG,inv;\ninline int mul(int a,int b){return 1ll*a*b%P;}\ninline int add(int a,int b){a+=b;if(a>P)a%=P;if(a<0)a=(a+P)%P;return a;}\ninline int qpow(int x,int p){\n\tregister int ret=1;\n\tfor(;p;p>>=1,x=mul(x,x))if(p&1)ret=mul(ret,x);\n\treturn ret;\n}\nint r[MAX];\ninline int NTT(int *a,int lim,int op){\n\tfor(register int i=0;i<lim;++i)if(i<r[i])swap(a[i],a[r[i]]);\n\tfor(register int mid=1,r,wx,w,x,y;mid<lim;mid<<=1){\n\t\tr=mid<<1;wx=qpow(op==1?G:GG,(P-1)/r);\n\t\tfor(register int j=0;j<lim;j+=r){\n\t\t\tw=1;\n\t\t\tfor(register int k=0;k<mid;++k,w=mul(w,wx)){\n\t\t\t\tx=a[j+k],y=mul(a[j+mid+k],w);\n\t\t\t\ta[j+k]=add(x,y);a[j+mid+k]=add(x,-y);\n\t\t\t}\n\t\t}\n\t}\n\tif(op==-1)for(register int i=0;i<lim;++i)a[i]=mul(a[i],inv); \n}\nint lim=1,l,fac[MAX],f[MAX],g[MAX];\ninline void solve(){\n\tfac[0]=1;GG=qpow(G,P-2);\n\tfor(register int i=1;i<=n;++i)fac[i]=mul(fac[i-1],i);\n\tfor(register int i=0;i<=n;++i){\n\t\tinv=qpow(fac[i],P-2);\n\t\tf[i]=mul(qpow(i,n),inv);\n\t\tg[i]=add(0,(i&1)?-inv:inv);\n\t}\n\twhile(lim<=n+n)lim<<=1,++l;inv=qpow(lim,P-2);\n\tfor(register int i=0;i<lim;++i)r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\tNTT(f,lim,1);NTT(g,lim,1);\n\tfor(register int i=0;i<lim;++i)f[i]=mul(f[i],g[i]); \n\tNTT(f,lim,-1);\n}\nsigned main(){\n\tn=read();\n\tsolve();\n\tfor(register int i=0;i<=n;++i)printf(\"%lld \",f[i]);\n\treturn 0;\n}\n\n\n\n```\n",
        "postTime": 1610248336,
        "uid": 119062,
        "name": "Lates",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5395 \u3010\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u00b7\u884c\u3011"
    },
    {
        "content": "\u4e0d\u4f1a\u65af\u7279\u6797\u6570\u7684[\u6233\u6211](https://www.luogu.com.cn/blog/jacky567/stirling-number)\n\n$\\begin{Bmatrix}n\\\\m\\end{Bmatrix}=\\frac{1}{m!}\\sum \\limits_{i=0}^m(-1)^i\\binom{m}{i}(m-i)^n=\\frac{1}{m!}\\sum \\limits_{i=0}^m(-1)^i\\frac{m!}{i!(m-i)!}(m-i)^n=\\sum \\limits_{i=0}^m\\frac{(-1)^i}{i!}\\frac{(m-i)^n}{(m-i)!}$\n\n\u770b\uff0c\u8fd9\u662f\u4ec0\u4e48\uff1f\u662f\u4e0d\u662f\u4e00\u4e2a\u6f02\u4eae\u7684\u5377\u79ef\u5f0f\uff1f\n\n\u8fd8\u6ca1\u770b\u51fa\u6765\uff1f\u8bbe$f(x)=\\sum \\limits_{i\\geqslant 0} \\frac{(-1)^i}{i!}x^i,g(x)=\\sum\\limits_{i\\geqslant 0}\\frac{i^n}{i!}x^i$\uff0c\u5219$\\begin{Bmatrix}n\\\\m\\end{Bmatrix}$\u5c31\u662f$f(x)$\u548c$g(x)$\u7684\u5377\u79ef\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6109\u5feb\u5730\u4f7f\u7528\u9006\u5929\u5854\uff08NTT\uff09\u4e86\uff01\n\n\u9644\u4e0a\u4ee3\u7801\uff1a\n```cpp\n#include<algorithm>\n#include<iostream>\n#include<cstring>\nusing namespace std;\nconst int mod=167772161,g=3;\nint n,len=1,ln,r[800010],cj[800010],a[800010],b[800010];\nint POW(int a,int b)\n{\n    int ans=1;\n    for(;b;b>>=1){\n        if(b&1) ans=1ll*ans*a%mod;\n        a=1ll*a*a%mod;\n\t}\n    return ans;\n}\nvoid NTT(int *a,int flag)\n{\n    for(int i=0;i<len;i++) if(i<r[i]) swap(a[i],a[r[i]]);\n    for(int k=1;k<len;k<<=1) for (int i=0,w1=POW(g,(mod-1)/(k<<1));i<len;i+=(k<<1)) for(int j=0,w=1;j<k;j++,w=1ll*w*w1%mod){\n        int x=a[i+j],y=1ll*w*a[i+j+k]%mod;\n        a[i+j]=(x+y)%mod,a[i+j+k]=(x-y+mod)%mod;\n\t}\n    if(flag==-1){\n        a[0]=1ll*a[0]*POW(len,mod-2)%mod;\n        for(int i=1,inv=POW(len,mod-2);i<=len/2;i++){\n            a[i]=1ll*a[i]*inv%mod;\n            if(i!=len-i) a[len-i]=1ll*a[len-i]*inv%mod;\n            swap(a[i],a[len-i]);\n        }\n    }\n}\nint main()\n{\n    cin>>n,n++,cj[0]=cj[1]=1;\n    for(int i=2;i<n;i++) cj[i]=(mod-1ll*(mod/i)*cj[mod%i]%mod)%mod;\n    for(int i=1;i<n;i++) cj[i]=1ll*cj[i-1]*cj[i]%mod;\n    for(int i=0,f=1;i<n;f=mod-f,i++) a[i]=1ll*f*cj[i]%mod,b[i]=1ll*POW(i,n-1)*cj[i]%mod;\n    while(len<=(n<<1)) len<<=1,ln++;\n    for(int i=0;i<len;i++) r[i]=(r[i>>1]>>1)|((i&1)<<(ln-1));\n    NTT(a,1),NTT(b,1);\n    for(int i=0;i<len;i++) a[i]=1ll*a[i]*b[i]%mod;\n    NTT(a,-1);\n    for(int i=0;i<n;i++) cout<<a[i]<<\" \";\n}\n```",
        "postTime": 1597844128,
        "uid": 43373,
        "name": "jacky567",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5395 \u3010\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u00b7\u884c\u3011"
    },
    {
        "content": "# \u9898\u89e3 P5395 \u3010\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u00b7\u884c\u3011\n\n[$\\mathfrak{View\\space it\\space on\\space my\\space Blog}$](https://blog.seniorious.cc/2020/luogu-5395/)\n\n## \u9898\u610f\n\n\u6c42$\\left\\{\\begin{matrix}n\\\\i\\end{matrix}\\right\\},i=0,1,\\dots,n$\n\n\u5176\u4e2d$\\left\\{\\begin{matrix}n\\\\i\\end{matrix}\\right\\}$\u4e3a\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\uff0c\u7ec4\u5408\u610f\u4e49\u4e3a\u5c06$n$\u4e2a\u4e0d\u540c\u5143\u7d20\u5212\u5165$i$\u4e2a\u76f8\u540c\u96c6\u5408\uff08\u6240\u6709\u96c6\u5408\u975e\u7a7a\uff09\u7684\u65b9\u6848\u6570\uff0c\u6709\u9012\u63a8\u5f0f$\\left\\{\\begin{matrix}n\\\\m\\end{matrix}\\right\\}=\\left\\{\\begin{matrix}n-1\\\\m-1\\end{matrix}\\right\\}+\\left\\{\\begin{matrix}n-1\\\\m\\end{matrix}\\right\\}\\times m$\n\n## \u63a8\u5bfc\n\n\u5148\u8bf4\u7ed3\u8bba\uff1a\n\n$$\\boxed{\\left\\{\\begin{matrix}n\\\\m\\end{matrix}\\right\\}=\\sum\\limits^n_{i=0}\\frac{(-1)^i}{i!}\\times\\frac{(m-i)^n}{(m-i)!}}$$\n\n\u8bc1\u660e\u5982\u4e0b\uff1a\n\n\u5148\u5c06$m$\u4e2a\u96c6\u5408\u6807\u53f7\uff0c\u94a6\u5b9a\u5176\u4e2d$i$\u4e2a\u96c6\u5408\u4e3a\u7a7a\uff0c$n$\u4e2a\u5143\u7d20\u4efb\u610f\u5b89\u6392\u5230\u5269\u4f59\u7684$m-i$\u4e2a\u96c6\u5408\uff08\u53ef\u4ee5\u4e3a\u7a7a\uff09\u7684\u65b9\u6848\u6570\u4e3a$\\binom{m}{i}\\times(m-i)^n$\uff0c\u7531\u4e8e\u539f\u5148\u7684\u96c6\u5408\u662f\u65e0\u6807\u53f7\u7684\uff0c\u6240\u4ee5\u8fd8\u8981\u9664\u4ee5$m!$\n\n\u4e8e\u662f\u5c31\u6709\uff1a$m$\u4e2a\u96c6\u5408\u4e2d**\u81f3\u5c11**\u6709$i$\u4e2a\u4e3a\u7a7a\u7684\u65b9\u6848\u6570\u4e3a$\\frac{1}{m!}\\times\\binom{m}{i}\\times(m-i)^n$\n\n\u8003\u8651\u5bf9\u5176\u8fdb\u884c\u5bb9\u65a5\uff0c\u5373\u53ef\u5f97\u6240\u6709\u96c6\u5408\u975e\u7a7a\u7684\u65b9\u6848\u6570\uff1a\n\n$$\\begin{aligned}\\left\\{\\begin{matrix}n\\\\m\\end{matrix}\\right\\}&=\\sum\\limits^m_{i=0}(-1)^i\\times\\frac{1}{m!}\\times\\binom{m}{i}\\times(m-i)^n\\\\&=\\sum\\limits^m_{i=0}(-1)^i\\times\\frac{1}{m!}\\times\\frac{m!}{i!\\times(m-i)!}\\times(m-i)^n\\\\&=\\sum\\limits^m_{i=0}\\frac{(-1)^i}{i!}\\times\\frac{(m-i)^n}{(m-i)!}\\end{aligned}$$\n\n\u53d1\u73b0\u662f\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u5c06$\\sum\\limits^n_{i=0}\\frac{(-1)^i}{i!}x^i$\u548c$\\sum\\limits^n_{i=0}\\frac{i^n}{i!}x^i$\u505a\u5377\u79ef\uff0c$i$\u6b21\u9879\u7684\u7cfb\u6570\u5373\u4e3a$\\left\\{\\begin{matrix}n\\\\i\\end{matrix}\\right\\}$\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\log_2n)$\n\n## \u4ee3\u7801\n\n\u5927\u7ea6\u5c31\u662f\u4e00\u4e2aNTT\u677f\u5b50\n\n```cpp\nconst int N = 530000;\nconst int Mod = 167772161, g = 3;\n\nclass Polynomial {\npublic:\n  int *a;\n  Polynomial() {\n    a = new int[N];\n    memset(a, 0, sizeof(int) * N);\n  }\n  void NTT(int, bool);\n};\n\nint pow(int a, int b, int m) {\n  int ans = 1, now = a;\n  while (b) {\n    if (b & 1) {\n      ans = ans * 1ll * now % m;\n    }\n    now = now * 1ll * now % m;\n    b >>= 1;\n  }\n  return ans;\n}\nvoid Polynomial::NTT(int lim, bool opt) {\n  if (opt) {\n    std::reverse(a + 1, a + lim);\n  }\n  for (int i = 0; i < lim; ++i) {\n    if (i < r[i]) {\n      std::swap(a[i], a[r[i]]);\n    }\n  }\n  for (int l = 1; l < lim; l <<= 1) {\n    int gw = pow(g, (Mod - 1) / (l << 1), Mod);\n    for (int i = 0; i < lim; i += (l << 1)) {\n      for (int j = 0, gn = 1; j < l; ++j, gn = gn * 1ll * gw % Mod) {\n        int x = a[i | j], y = a[i | j | l] * 1ll * gn % Mod;\n        a[i | j] = (x + y) % Mod;\n        a[i | j | l] = (x - y + Mod) % Mod;\n      }\n    }\n  }\n  if (opt) {\n    int iv = pow(lim, Mod - 2, Mod);\n    for (int i = 0; i < lim; ++i) {\n      a[i] = a[i] * 1ll * iv % Mod;\n    }\n  }\n}\nvoid solve(int n) {\n  fac[0] = 1;\n  for (int i = 1; i <= n; ++i) {\n    fac[i] = fac[i - 1] * 1ll * i % Mod;\n  }\n  ifac[n] = pow(fac[n], Mod - 2, Mod);\n  for (int i = n - 1; i >= 0; --i) {\n    ifac[i] = ifac[i + 1] * 1ll * (i + 1) % Mod;\n  }\n  Polynomial f, g;\n  f.a[0] = 1, g.a[0] = 0;\n  for (int i = 1; i <= n; ++i) {\n    f.a[i] = (i & 1) ? (Mod - ifac[i]) : ifac[i];\n    g.a[i] = pow(i, n, Mod) * 1ll * ifac[i] % Mod;\n  }\n  int lim = 1;\n  while (lim <= (n << 1)) {\n    lim <<= 1;\n  }\n  for (int i = 0; i < lim; ++i) {\n    r[i] = (r[i >> 1] >> 1) | ((i & 1) * (lim >> 1));\n  }\n  f.NTT(lim, false), g.NTT(lim, false);\n  for (int i = 0; i < lim; ++i) {\n    f.a[i] = f.a[i] * 1ll * g.a[i] % Mod;\n  }\n  f.NTT(lim, true);\n  for (int i = 0; i <= n; ++i) {\n    write(f.a[i]), SP;\n  }\n  EL;\n}\n```",
        "postTime": 1585702551,
        "uid": 25251,
        "name": "moongazer",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5395 \u3010\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u00b7\u884c\u3011"
    },
    {
        "content": "\u8003\u8651\u7ed9 $n$ \u4e2a\u76d2\u5b50\u6d82\u4e0a $m$ \u79cd\u989c\u8272\uff0c\u5176\u65b9\u6848\u6570\u4e3a $n^m$ \u3002\n\n\u6211\u4eec\u6362\u4e00\u79cd\u601d\u8def:\u679a\u4e3e\u6d82\u7684\u989c\u8272\u4e2a\u6570\uff0c\u7136\u540e\u518d\u5206\u914d\u4e0b\u53bb\u3002\n\n\u65b9\u6848\u6570\u4e3a:\n\n$$\\sum_{i=0}^m \\begin{Bmatrix}n\\\\i\\end{Bmatrix}\\binom{m}{i}i!=n^m$$\n\n\u5957\u7528\u4e8c\u9879\u5f0f\u53cd\u6f14\uff0c\u5f97\u5230:\n\n$$\\begin{Bmatrix}n\\\\m\\end{Bmatrix}m!=\\sum_{i=0}^m \\binom{m}{i}(-1)^{m-i}i^n$$\n\n\u5316\u7b80\u5f97:\n\n$$\\begin{Bmatrix}n\\\\m\\end{Bmatrix}=\\sum_{i=0}^m\\frac{(-1)^{m-i}}{(m-i)!}*\\frac{i^n}{i!}$$\n\n\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7\u5bb9\u65a5\u76f4\u63a5\u5f97\u5230\u8fd9\u4e2a\u5f0f\u5b50\u3002\n\n\u8fd9\u663e\u7136\u662f\u4e2a\u5377\u79ef\u5f62\u5f0f\u3002\u6784\u9020\u51fd\u6570 $F(x)=\\sum_{i=0}^\\infty \\frac{(-1)^i}{i!}x^i$ \u548c $G(x)=\\sum_{i=0}^\\infty \\frac{i^n}{i!}x^i$ \uff0c\u6211\u4eec\u6709:\n\n$$S=F*G$$\n\n\u76f4\u63a5\u5377\u5373\u53ef\u3002\u590d\u6742\u5ea6 $O(n\\log n)$ \u3002\n\n\u4ee3\u7801:\n```cpp\n#include<cstdio>\n#include<cstdlib>\n#include<cctype>\n#include<cstring>\n#include<algorithm>\n#include<cmath>\n#include<cassert>\n#include<iostream>\n#define Rep(i,a,b) for(register int i=(a);i<=(b);++i)\n#define Repe(i,a,b) for(register int i=(a);i>=(b);--i)\n#define rep(i,a,b) for(register int i=(a);i<(b);++i)\n#define pb push_back\n#define mx(a,b) (a>b?a:b)\n#define mn(a,b) (a<b?a:b)\ntypedef unsigned long long uint64;\ntypedef unsigned int uint32;\ntypedef long long ll;\nusing namespace std;\n\nnamespace IO\n{\n\tconst uint32 Buffsize=1<<15,Output=1<<24;\n\tstatic char Ch[Buffsize],*S=Ch,*T=Ch;\n\tinline char getc()\n\t{\n\t\treturn((S==T)&&(T=(S=Ch)+fread(Ch,1,Buffsize,stdin),S==T)?0:*S++);\n\t}\n\tstatic char Out[Output],*nowps=Out;\n\t\n\tinline void flush(){fwrite(Out,1,nowps-Out,stdout);nowps=Out;}\n\n\ttemplate<typename T>inline void read(T&x)\n\t{\n\t\tx=0;static char ch;T f=1;\n\t\tfor(ch=getc();!isdigit(ch);ch=getc())if(ch=='-')f=-1;\n\t\tfor(;isdigit(ch);ch=getc())x=x*10+(ch^48);\n\t\tx*=f;\n\t}\n\n\ttemplate<typename T>inline void write(T x,char ch='\\n')\n\t{\n\t\tif(!x)*nowps++='0';\n\t\tif(x<0)*nowps++='-',x=-x;\n\t\tstatic uint32 sta[111],tp;\n\t\tfor(tp=0;x;x/=10)sta[++tp]=x%10;\n\t\tfor(;tp;*nowps++=sta[tp--]^48);\n\t\t*nowps++=ch;\n\t}\n}\nusing namespace IO;\n\nvoid file()\n{\n#ifndef ONLINE_JUDGE\n\tFILE*DSD=freopen(\"water.in\",\"r\",stdin);\n\tFILE*CSC=freopen(\"water.out\",\"w\",stdout);\n#endif\n}\n\nconst int MAXN=1<<19;\n\nnamespace poly\n{\n\tconst int mod=167772161,gen=3;\n\t\n\tstatic int g[23][MAXN];\n\n\tinline int power(int u,int v)\n\t{\n\t\tregister int sm=1;\n\t\tfor(;v;v>>=1,u=(uint64)u*u%mod)if(v&1)\n\t\t\tsm=(uint64)sm*u%mod;\n\t\treturn sm;\n\t}\n\n\tinline void predone()\n\t{\n\t\tRep(i,1,21)\n\t\t{\n\t\t\tg[i][0]=1,g[i][1]=power(gen,(mod-1)>>i);\n\t\t\tRep(j,2,4e5)g[i][j]=(ll)g[i][j-1]*g[i][1]%mod;\n\t\t}\n\t}\n\n\tstatic int Len,rev[MAXN];\n\n\tinline void calrev()\n\t{\n\t\tint II=log(Len)/log(2)-1;\n\t\tRep(i,1,Len-1)rev[i]=rev[i>>1]>>1|(i&1)<<II;\n\t}\n\n\tinline int ad(int u,int v){return(u+=v)>=mod?u-mod:u;}\n\n\tinline void NTT(int*F,int typ)\n\t{\n\t\tRep(i,1,Len-1)if(i<rev[i])swap(F[i],F[rev[i]]);\n\t\tfor(register int i=2,ii=1,t=1;i<=Len;i<<=1,ii<<=1,++t)\n\t\t\tfor(register int j=0;j<Len;j+=i)rep(k,0,ii)\n\t\t\t{\n\t\t\t\tregister int tt=(uint64)*(F+j+k+ii)*g[t][k]%mod;\n\t\t\t\t*(F+j+k+ii)=ad(*(F+j+k),mod-tt);\n\t\t\t\t*(F+j+k)=ad(*(F+j+k),tt);\n\t\t\t}\n\t\tif(typ==-1)\n\t\t{\n\t\t\treverse(F+1,F+Len);\n\t\t\tregister uint64 invn=power(Len,mod-2);\n\t\t\trep(i,0,Len)*(F+i)=invn**(F+i)%mod;\n\t\t}\n\t}\n\n\tstatic int X[MAXN],Y[MAXN],Iv[MAXN];\n\n\tinline void mul(int *a,int *b,int *c,int lenl,int lenr)\n\t{\n\t\tif((ll)lenl*lenr<=100)\n\t\t{\n\t\t\tRep(i,0,lenl+lenr)X[i]=0;\n\t\t\tRep(i,0,lenl)Rep(j,0,lenr)\n\t\t\t\tX[i+j]=(X[i+j]+(ll)a[i]*b[j])%mod;\n\t\t\tRep(i,0,lenl+lenr)c[i]=X[i];\n\t\t\treturn;\n\t\t}\n\t\tfor(Len=2;Len<=lenl+lenr;Len<<=1);\n\t\tcalrev();\n\t\tRep(i,0,lenl)X[i]=a[i];\n\t\tRep(i,0,lenr)Y[i]=b[i];\n\t\trep(i,lenl+1,Len)X[i]=0;\n\t\trep(i,lenr+1,Len)Y[i]=0;\n\t\tNTT(X,1),NTT(Y,1);\n\t\trep(i,0,Len)X[i]=(ll)X[i]*Y[i]%mod;\n\t\tNTT(X,-1);\n\t\tRep(i,0,lenl+lenr)c[i]=X[i];\n\t\trep(i,lenl+lenr+1,Len)c[i]=0;\n\t}\n\n\tinline void Inv(int*F,int*G,int ln)\n\t{\n\t\tIv[0]=power(F[0],mod-2);\n\t\tfor(register int Ln=2;Ln>>1<=ln;Ln<<=1)\n\t\t{\n\t\t\trep(i,ln+1,Ln)F[i]=0;\n\t\t\trep(i,0,Ln)X[i]=F[i],Y[i]=0;\n\t\t\trep(i,0,(Ln>>1))Y[i]=Iv[i];\n\t\t\tLen=Ln,calrev();\n\t\t\tNTT(X,1),NTT(Y,1);\n\t\t\trep(i,0,Ln)X[i]=(uint64)X[i]*Y[i]%mod;\n\t\t\tNTT(X,-1);\n\t\t\trep(i,0,(Ln>>1))X[i]=0;\n\t\t\tNTT(X,1);\n\t\t\trep(i,0,Ln)X[i]=(uint64)X[i]*Y[i]%mod;\n\t\t\tNTT(X,-1);\n\t\t\trep(i,(Ln>>1),Ln)Iv[i]=mod-X[i];\n\t\t}\n\t\tRep(i,0,ln)G[i]=Iv[i];\n\t}\n}\nusing poly::mul;\nusing poly::power;\nusing poly::Len;\nusing poly::calrev;\nusing poly::NTT;\nusing poly::mod;\nusing poly::predone;\nusing poly::Inv;\nusing poly::ad;\n\nstatic int n,F[MAXN],G[MAXN];\n\nint main()\n{\n\tfile();\n\tpredone();\n\tread(n);\n\tF[0]=1;\n\tRep(i,1,n)F[i]=(ll)F[i-1]*i%mod;\n\tF[n]=power(F[n],mod-2);\n\tRepe(i,n,1)F[i-1]=(ll)F[i]*i%mod;\n\tRep(i,0,n)\n\t{\n\t\tG[i]=i&1?mod-F[i]:F[i];\n\t\tF[i]=(ll)F[i]*power(i,n)%mod;\n\t}\n\tmul(F,G,F,n,n);\n\tRep(i,0,n)write(F[i],' ');\n\tflush();\n\treturn 0;\n}\n```",
        "postTime": 1558255957,
        "uid": 7035,
        "name": "Great_Influence",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5395 \u3010\u3010\u6a21\u677f\u3011\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u00b7\u884c\u3011"
    }
]
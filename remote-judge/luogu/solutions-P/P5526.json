[
    {
        "content": "ynoi\u4e2a\u4e2a\u90fd\u662f\u6bd2\u7624\u9898\u2026\u2026\u53c8\u96be\u60f3\u53c8\u96be\u5199\u2026\u2026\n\n\u53ef\u80fd\u5199\u7684\u6709\u70b9\u4e71\uff0c\u6240\u4ee5\u63a8\u8350\u8fb9\u770b\u8fb9\u753b\u56fe\u7406\u89e3\u3002\n\n### \u524d\u7f6e\u829d\u58eb\n\n[QTREE6](https://www.luogu.org/problem/SP16549)\n\n~~\u4f17\u6240\u5468\u77e5\u767d\u9898\u6bd4\u9ed1\u9898\u96be~~\n\n## \u9898\u89e3\n\n\u9898\u610f\u7b80\u5355\u7c97\u66b4\uff0c\u5c31\u662f\u679a\u4e3e\u6240\u6709\u8def\u5f84\u6c42\u4e0d\u540c\u989c\u8272\u6570\u7136\u540e\u52a0\u8d77\u6765\uff0c\u5e26\u5355\u70b9\u4fee\u6539\u3002**\u53ea\u8981\u8d77\u70b9\u548c\u7ec8\u70b9\u5176\u4e2d\u4e00\u4e2a\u4e0d\u540c\u5c31\u7b97\u4e0d\u540c\u8def\u5f84\uff0c\u6240\u6709\u6240\u6709\u8def\u5f84\u5305\u62ec\u53ea\u6709\u4e00\u4e2a\u70b9\u7684\u8def\u5f84\uff0c\u800c\u4e14\u6709\u4e24\u4e2a\u4ee5\u4e0a\u70b9\u7684\u8def\u5f84\u8981\u6765\u56de\u7b97\u4e24\u6b21** ~~\u5176\u5b9e\u8ba4\u771f\u770b\u6837\u4f8b\u90fd\u770b\u5f97\u51fa\u6765~~\n\n~~\u6559\u7ec3\u6211\u4f1aO(n^3)\u7684dfs~~ \u660e\u663e\u8fc7\u4e0d\u4e86\uff0c\u4f46\u53ef\u4ee5\u62ff\u6765\u5bf9\u62cd\n\n\u7136\u540e\u6211\u4eec\u89c2\u5bdf\u4e00\u4e0b\u8fd9\u4e2a\u8be2\u95ee\u64cd\u4f5c\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u6bcf\u79cd\u989c\u8272\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u662f\u72ec\u7acb\u7684\uff0c\u7b80\u5355\u8bf4\u5c31\u662fdfs\u65f6\u5206\u5f00\u6bcf\u79cd\u989c\u8272\u51fa\u73b0\u6b21\u6570\uff0c\u6700\u540e\u5168\u90e8\u52a0\u8d77\u6765\u4e5f\u662f\u7b54\u6848\u3002\n\n\u4e8e\u662f\u5c31\u53ef\u4ee5\u628a\u8be2\u95ee\u5168\u90e8\u62c6\u5f00\uff0c\u6309\u989c\u8272\u6392\u5e8f\uff0c\u8fd9\u6837\u4e00\u6765\u5b9e\u9645\u8981\u5904\u7406\u7684\u5c31\u53ea\u6709\u4e24\u79cd\u989c\u8272\u3002\u6216\u8005\u8bf4\u95ee\u9898\u5c31\u8f6c\u6362\u4e3a\u4e86\u7ed9\u4e00\u68f5\u6811\uff0c\u6bcf\u4e2a\u70b9\u53ef\u80fd\u662f\u9ed1\u8272\u6216\u767d\u8272\uff0c\u6bcf\u6b21\u95ee\u8def\u5f84\u4e0a\u5b58\u5728\u81f3\u5c11\u4e00\u4e2a\u70b9\u662f\u9ed1\u8272\u7684\u8def\u5f84\u7684\u6570\u91cf\u662f\u591a\u5c11\uff0c\u5e26\u4fee\u6539\u3002\uff08\u53ef\u4ee5\u968f\u4fbf\u627e\u7ec4\u5c0f\u6570\u636e\u7406\u89e3\u4e00\u4e0b\uff09\n\n\u8003\u8651\u5230\u95ee\u5b58\u5728\u9ed1\u70b9\u7684\u8def\u5f84\u6570\u6709\u70b9\u96be\u641e\uff0c\u6211\u4eec\u53cd\u8fc7\u6765\u6c42\u6240\u6709\u70b9\u90fd\u662f\u767d\u70b9\u7684\u8def\u5f84\u6570\u3002\u8fd9\u5176\u5b9e\u5c31\u662f\u6bcf\u4e2a\u767d\u8fde\u901a\u5757\u7684\u5927\u5c0f\u7684\u5e73\u65b9\u3002\n\n\u5982\u679c\u6539\u52a8\u4e00\u4e2a\u70b9\u7684\u989c\u8272\uff0c\u90a3\u8def\u5f84\u6570\u7684\u53d8\u5316\u91cf\u5c31\u662f\u5728\u8fd9\u4e2a\u70b9\u4e3a\u9ed1\u8272\u65f6\u4e0e\u8fd9\u4e2a\u70b9\u76f8\u90bb\u7684\u767d\u70b9\u6240\u5728\u8fde\u901a\u5757\u5927\u5c0f\u4e4b\u548c\u52a0\u4e0a\u8fd9\u4e9b\u8fde\u901a\u5757\u5927\u5c0f\u4e24\u4e24\u76f8\u4e58\u7684\u548c+1\u3002\uff08\u4e5f\u63a8\u8350\u753b\u56fe\u7406\u89e3\u4e00\u4e0b\uff09\n\n\u8fd9\u4e2a\u5f0f\u5b50\u7b80\u5355\u53d8\u5316\u4e00\u4e0b\u5c31\u662f\u8fde\u901a\u5757\u5927\u5c0f\u4e4b\u548c\u7684\u5e73\u65b9\u51cf\u53bb\u6bcf\u4e2a\u8fde\u901a\u5757\u5927\u5c0f\u7684\u5e73\u65b9\u518d\u52a0\u4e0a\u8fde\u901a\u5757\u5927\u5c0f\u4e4b\u548c\u3002\n\n\u4e8e\u662f\u505a\u6cd5\u5c31\u6765\u4e86\uff0c\u50cfqtree6\u4e00\u6837\u7528$lct$\u7ef4\u62a4\u70b9\u6240\u5728\u8fde\u901a\u5757\u7684\u4fe1\u606f\uff0c\u7136\u540e\u5728\u8f7b\u513f\u5b50\u6709\u53d8\u52a8\u65f6\u628a\u8fd9\u4e9b\u5e73\u65b9\u548c\u5565\u7684\u5904\u7406\u4e00\u4e0b\u3002\u4e8e\u662f\u5c31\u80fd\u5f97\u5230\u7b54\u6848\u7684\u5dee\u5206\u5e8f\u5217\uff0c\u5f04\u4e2a\u524d\u7f00\u548c\u7136\u540e\u8f93\u51fa\u5c31\u884c\u4e86\u3002\n\n\u7531\u4e8e\u6bcf\u4e2a\u8be2\u95ee\u4f1a\u62c6\u6210\u628a\u4e00\u4e2a\u70b9\u9ed1\u6539\u767d\u548c\u628a\u4e00\u4e2a\u70b9\u767d\u6539\u9ed1\uff0c\u518d\u7b97\u4e0a\u521d\u59cb\u5316\u7684$n$\u6b21\u767d\u6539\u9ed1\u548c\u9ed1\u6539\u767d\uff0c\u603b\u7684\u64cd\u4f5c\u6b21\u6570\u662f$2n+2m$\uff0c\u4e8e\u662f\u65f6\u95f4\u590d\u6742\u5ea6$O((n+m)logn)$\uff0c\u7a7a\u95f4$O(n+m)$\u3002\u5927\u6982\u5c31\u662f$lct$\u8dd1$1e6$\u7684\u65f6\u95f4\uff0c\u5199\u7684\u592a\u4e11\u53ef\u80fd\u4f1a\u88ab\u5361\u5e38\u2026\u2026\n\n### \u4ee3\u7801\n\n\u4e3a\u4e86\u9632\u6b62\u65e0\u8111\u6284\u9898\u89e3\uff0c\u4ee5\u4e0b\u4ee3\u7801\u6709\u4e00\u4e2a\u9519\u8bef\uff0c\u76f4\u63a5\u63d0\u4ea4\u4f1a\u5168\u90e8$WA$\u3002~~\u771f\u7684\u6709\u8ba4\u771f\u770b\u7684\u4eba\u4e0d\u770b\u4ee3\u7801\u4e5f\u80fd\u81ea\u5df1\u5199\u51fa\u6765\u5427~~\n\n```cpp\n#include<iostream>\n#include<cstdlib>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\ntypedef long long ll;\nconst int N=4e5+5;\ninline int read()\n{\n\tint sum=0;\n\tchar c=getchar();\n\twhile(c<'0'||c>'9')c=getchar();\n\twhile(c>='0'&&c<='9')\n\t{\n\t\tsum=sum*10+c-'0';\n\t\tc=getchar();\n\t}\n\treturn sum;\n}\ninline void write(ll x)\n{\n\tif(x>9)write(x/10);\n\tputchar(x%10+'0');\n}\nstruct miaow\n{\n\tint ys;\n\tint siz,lh,rh;\n\tll ssum;\n\tll xsum,xsum2;\n\tint fz;\n\tint son[2],sfa,xfa;\n\tmiaow(int ls=0,int rs=0,int sfa=0,int xfa=0,int ys=0,int siz=1,int lh=1,int rh=1,ll ssum=1,ll xsum=0,ll xsum2=0,int fz=0):\n\t\tsfa(sfa),xfa(xfa),ys(ys),siz(siz),lh(lh),rh(rh),ssum(ssum),xsum(xsum),xsum2(xsum2),fz(fz){son[0]=ls,son[1]=rs;}\n}t[N];\n#define ys(x) t[x].ys\n#define siz(x) t[x].siz\n#define lh(x) t[x].lh\n#define rh(x) t[x].rh\n#define ssum(x) t[x].ssum\n#define xsum(x) t[x].xsum\n#define xsum2(x) t[x].xsum2\n#define fz(x) t[x].fz\n#define ls(x) t[x].son[0]\n#define rs(x) t[x].son[1]\n#define ks(x,k) t[x].son[k]\n#define sfa(x) t[x].sfa\n#define xfa(x) t[x].xfa\n#define zsum(x) (ssum(x)+xsum(x))\ninline int fx(int x)\n{\n\tif(!sfa(x))return -1;\n\treturn rs(sfa(x))==x;\n}\ninline void upd(int x)\n{\n\tif(fz(x))return;\n\tsiz(x)=siz(ls(x))+siz(rs(x))+1+xsum(x);\n\tlh(x)=lh(ls(x))+((lh(ls(x))!=siz(ls(x))||ys(x))?0:(1+xsum(x)+lh(rs(x))));\n\trh(x)=rh(rs(x))+((rh(rs(x))!=siz(rs(x))||ys(x))?0:(1+xsum(x)+rh(ls(x))));\n\tssum(x)=lh(x)+xsum(x);\n}\ninline void pdfz(int x)\n{\n\tif(!fz(x))return;\n\tfz(x)=0;\n\tswap(ls(x),rs(x));\n\tif(ls(x))\n\t{\n\t\tswap(lh(ls(x)),rh(ls(x)));\n\t\tssum(ls(x))=lh(ls(x));\n\t\tfz(ls(x))^=1;\n\t}\n\tif(rs(x))\n\t{\n\t\tswap(lh(rs(x)),rh(rs(x)));\n\t\tssum(rs(x))=lh(rs(x));\n\t\tfz(rs(x))^=1;\n\t}\n\tupd(x);\n}\ninline void rotate(int x)\n{\n\tif(!sfa(x))return;\n\tint y=sfa(x),k=fx(x),z=sfa(y);\n\tswap(xfa(x),xfa(y));\n\tks(y,k)=ks(x,k^1);\n\tif(ks(x,k^1))sfa(ks(x,k^1))=y;\n\tif(sfa(y))\n\t{\n\t\tint y2=sfa(y),k2=fx(y);\n\t\tks(y2,k2)=x;\n\t}\n\tks(x,k^1)=y;\n\tsfa(x)=sfa(y);\n\tsfa(y)=x;\n\tupd(y);\n\tupd(x);\n}\ninline void pd2(int x)\n{\n\tif(sfa(x))pd2(sfa(x));\n\tpdfz(x);\n}\ninline void splay(int x)\n{\n\tpd2(x);\n\tif(!sfa(x))return;\n\tint y=sfa(x),k=fx(x);\n\twhile(y)\n\t{\n\t\tint z=sfa(y);\n\t\tif(!z)\n\t\t{\n\t\t\trotate(x);\n\t\t\treturn;\n\t\t}\n\t\tif(fx(y)==k)rotate(y);\n\t\telse rotate(x);\n\t\trotate(x);\n\t\ty=sfa(x),k=fx(x);\n\t}\n}\ninline void access(int x)\n{\n\tsplay(x);\n\tif(rs(x))\n\t{\n\t\tsfa(rs(x))=0;\n\t\txfa(rs(x))=x;\n\t\txsum(x)+=ssum(rs(x));\n\t\txsum2(x)+=ssum(rs(x))*ssum(rs(x));\n\t\trs(x)=0;\n\t\tupd(x);\n\t}\n\tint x2=x;\n\twhile(xfa(x))\n\t{\n\t\tint y=xfa(x);\n\t\tsplay(y);\n\t\tif(rs(y))\n\t\t{\n\t\t\tsfa(rs(y))=0;\n\t\t\txfa(rs(y))=y;\n\t\t\txsum(y)+=ssum(rs(y));\n\t\t\txsum2(y)+=ssum(rs(y))*ssum(rs(y));\n\t\t}\n\t\txsum(y)-=ssum(x);\n\t\txsum2(y)-=ssum(x)*ssum(x);\n\t\trs(y)=x;\n\t\tsfa(x)=y;\n\t\tupd(y);\n\t\txfa(x)=0;\n\t\tx=y;\n\t}\n}\ninline void hg(int x)\n{\n\taccess(x);\n\tsplay(x);\n\tswap(lh(x),rh(x));\n\tssum(x)=lh(x);\n\tfz(x)^=1;\n}\ninline ll cx(int x,int y)\n{\n\thg(x);\n\tpdfz(x);\n\tif(rs(x))\n\t{\n\t\tupd(rs(x));\n\t\tsfa(rs(x))=0;\n\t\txfa(rs(x))=x;\n\t\txsum(x)+=ssum(rs(x));\n\t\txsum2(x)+=ssum(rs(x))*ssum(rs(x));\n\t\trs(x)=0;\n\t\tupd(x);\n\t}\n\tys(x)=y;\n\tupd(x);\n\tll sum=(xsum(x)*xsum(x)-xsum2(x)),sum2=xsum(x)*2+1;\n\treturn sum+sum2;\n}\ninline ll cz(int x,int y)\n{\n\tll sum=cx(x,y);\n\treturn sum;\n}\n\nstruct meow\n{\n\tint a,b,c,d;\n\tinline bool operator < (const meow& qwe) const\n\t{\n\t\treturn c==qwe.c?(a==qwe.a?d<qwe.d:a<qwe.a):c<qwe.c;\n\t}\n\tmeow(int a=0,int b=0,int c=0,int d=0):a(a),b(b),c(c),d(d){}\n}q[N*5];\nint js=1;\n\nstruct nya\n{\n\tint f,t,l;\n\tnya(int f=0,int t=0,int l=0):f(f),t(t),l(l){}\n}imap[N*2+1];\nint str[N]={0},cou=1;\ninline void jb(int f,int t)\n{\n\timap[cou]=nya(f,t,str[f]);str[f]=cou++;\n\timap[cou]=nya(t,f,str[t]);str[t]=cou++;\n}\ninline void dfs(int o,int fa)\n{\n\tfor(int i=str[o];i;i=imap[i].l)\n\t{\n\t\tint tt=imap[i].t;\n\t\tif(tt==fa)continue;\n\t\tdfs(tt,o);\n\t\txsum(o)+=ssum(tt);\n\t\txsum2(o)+=ssum(tt)*ssum(tt);\n\t\txfa(tt)=o;\n\t}\n\tupd(o);\n}\nint cs[N]={0},n,m;\nll ans[N]={0};\nint main()\n{\n\tn=read(),m=read();\n\tint zs=m+1;\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tint x=read();\n\t\tcs[i]=x;\n\t\tq[js]=meow(0,i,x,1);\n\t\t++js;\n\t}\n\tfor(int i=1;i<n;++i)\n\t{\n\t\tint x=read(),y=read();\n\t\tjb(x,y);\n\t}\n\tfor(int i=1;i<=m;++i)\n\t{\n\t\tint x=read(),y=read();\n\t\tq[js]=meow(i,x,cs[x],0);++js;\n\t\tq[js]=meow(i,x,y,1);++js;\n\t\tcs[x]=y;\n\t}\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tq[js]=meow(zs,i,cs[i],0);++js;\n\t}\n\tsiz(0)=0,lh(0)=0,rh(0)=0,ssum(0)=0;\n\tdfs(1,0);\n\tsort(q+1,q+js);\n\tint col=0;\n\tfor(int i=1;i<js;++i)\n\t{\n\t\tint a=q[i].a,b=q[i].b,c=q[i].c,d=q[i].d;\n\t\tif(c!=col)\n\t\t{\n\t\t\tcol=c;\n\t\t}\n\t\tll sum=cz(b,d);\n\t\tif(d==0)ans[a]-=sum;\n\t\telse ans[a]+=sum;\n\t}\n\twrite(ans[0]),putchar('\\n');\n\tfor(int i=1;i<=m;++i)\n\t{\n\t\tans[i]+=ans[i-1];\n\t\twrite(ans[i]);\n\t\tputchar('\\n');\n\t}\n}\n```\n",
        "postTime": 1568284341,
        "uid": 13105,
        "name": "miaow",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5526 \u3010[Ynoi2012]D1T3\u3011"
    },
    {
        "content": "\u7b2c\u4e00\u4e2a\u81ea\u5df1 YY \u51fa\u6765\u7684\u9ed1 Ynoi\uff0c\u5199\u4e00\u7bc7\u9898\u89e3\u7eaa\u5ff5\u4e00\u4e0b\u3002\n\n____\n\n\u9996\u5148\u8003\u8651\u8f6c\u5316\u8fd9\u4e2a\u67ff\u5b50\u3002\n\n\u7c7b\u4f3c\u4e8e Ynoi2016 \u8c01\u7684\u68a6\uff0c\u5bf9\u6bcf\u4e00\u79cd\u989c\u8272\u91c7\u7528**\u6b63\u96be\u5219\u53cd**\u2014\u2014\u8003\u8651**\u4e0d\u5305\u542b**\u8fd9\u4e2a\u989c\u8272\u7684\u8def\u5f84\u6761\u6570\u3002\n\n\u7ecf\u8fc7\u8fd9\u4e00\u6b65\u8f6c\u5316\u4e4b\u540e\uff0c\u7b54\u6848\u662f\u663e\u7136\u7684\u2014\u2014\u53ea\u4fdd\u7559\u4e0d\u7b49\u4e8e\u8fd9\u4e00\u79cd\u989c\u8272\u7684\u70b9\uff0c\u6240\u6709\u6811\u4e0a\u8fde\u901a\u5757\u5927\u5c0f\u7684**\u5e73\u65b9\u548c**\u3002\n\n\u6811\u4e0a\u8054\u901a\u5757\u7684\u4fe1\u606f\u7ef4\u62a4\uff0c\u4e0d\u96be\u60f3\u5230 Qtree6/7 \u7684\u5957\u8def\u2014\u2014\u5bf9\u6bcf\u4e00\u79cd\u989c\u8272\u5f00\u4e00\u4e2a LCT \u7ef4\u62a4\u5b50\u6811\u4fe1\u606f\uff0c\u5c06\u70b9\u7684\u989c\u8272\u6302\u5728\u7236\u4eb2\u8fb9\u4e0a\uff0c\u4f7f\u5f97\u4e00\u4e2a\u8fde\u901a\u5757\u7684\u6839\u53ef\u80fd\u5f02\u8272\uff0c\u67e5\u8be2\u4fe1\u606f\u7684\u65f6\u5019\u5728\u8fd9\u4e2a\u8fde\u901a\u5757\u7684\u6839\u4e0a\u67e5\u8be2\uff1b\u8f6c\u8272\u5c31\u5728\u539f\u5148\u989c\u8272\u7684 LCT \u4e0a cut\uff0c\u53d8\u4e3a\u7684\u989c\u8272\u7684 LCT \u4e0a link\u3002\n\n\u4f46\u662f\u4f1a\u51fa\u73b0\u4e00\u4e2a\u95ee\u9898\u2014\u2014\u8fd9\u91cc\u4e00\u5171 n \u79cd\u989c\u8272\uff0c\u603b\u4e0d\u53ef\u80fd\u5f00 n \u9897 LCT \u5427\u2026\u2026 \n\n\u89e3\u51b3\u65b9\u6848\u662f\uff1a\u56e0\u4e3a\u7ecf\u8fc7\u8f6c\u5316\u4e4b\u540e\uff0c\u663e\u7136\u6bcf\u4e00\u79cd\u989c\u8272\u5bf9\u4e8e\u7b54\u6848\u7684\u8d21\u732e\u662f\u72ec\u7acb\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5bf9\u6bcf\u4e00\u79cd\u989c\u8272\uff0c\u53ea\u5904\u7406\u64cd\u4f5c\u5e8f\u5217\u4e2d\u4e0e\u8fd9\u4e2a\u989c\u8272\u6709\u5173\u7684\u64cd\u4f5c\uff0c\u7136\u540e\u66f4\u65b0\u8fd9\u4e00\u4e2a\u989c\u8272\u7684\u7b54\u6848\u3002\n\n\u8fd9\u6837\u603b\u7684\u8f6c\u8272\u6b21\u6570\u53ef\u4ee5\u4fdd\u8bc1\u4e3a $2n+2m$\uff0c\u540c\u65f6\u5e26\u6765\u7684\u597d\u5904\u662f\u2014\u2014\u73b0\u5728\u53ea\u5269\u4e24\u79cd\u989c\u8272\u4e86\uff0c\u7b49\u4e8e\u8fd9\u6b21\u9009\u62e9\u7684\u989c\u8272\uff08\u767d\uff09\uff0c\u4ee5\u53ca\u4e0d\u7b49\u4e8e\uff08\u9ed1\uff09\uff0c\u4e24\u9897 LCT \u5c31\u53ef\u4ee5\u89e3\u51b3\u95ee\u9898\u3002\n\n\u8003\u8651\u4e00\u4e0b\u9700\u8981\u7ef4\u62a4\u4ec0\u4e48\u4fe1\u606f\u3002\n\n\u5b50\u6811\u5927\u5c0f\uff0c\u865a\u5b50\u6811\u5927\u5c0f\u5fc5\u7136\u8981\u7ef4\u62a4\u3002\n\n\u8003\u8651\u5728\u767d\u8f6c\u9ed1/\u9ed1\u8f6c\u767d\u4e2d\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e00\u4e2a\u70b9\u8f6c\u8272\u4e4b\u540e\uff0c\u8054\u901a/\u5206\u9694\u4e86\u5b83\u6240\u6709\u513f\u5b50\u6784\u6210\u7684\u8fde\u901a\u5757\u3002\u6b64\u65f6\u7b54\u6848\u9700\u8981\u5feb\u901f\u66f4\u65b0\u2014\u2014\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u70b9\u6240\u6709\u865a\u513f\u5b50\u7684\u5b50\u6811\u5927\u5c0f\u7684\u5e73\u65b9\u548c\u5c31\u884c\u4e86\u3002\n\n\u8fd9\u6240\u6709\u4e1c\u897f\u7684\u7ef4\u62a4\u53ea\u8981\u505a\u8fc7 BJOI2014 \u5927\u878d\u5408 \u5e94\u8be5\u90fd\u4f1a\uff0c\u6b64\u5904\u4e0d\u63d0\u3002\n\n\u90a3\u4e48\u8fd9\u9898\u5c31\u505a\u5b8c\u4e86\uff0c\u603b\u590d\u6742\u5ea6 $O((n+m)\\log n)$\u3002\n\n\u6ce8\u610f\u7684\u51e0\u70b9\uff1a\n\n- \u8f6c\u8272\u7684\u65f6\u5019\u4e00\u5b9a\u8981\u8ba8\u8bba\u6e05\u695a\uff0c\u5efa\u8bae\u81ea\u5df1\u753b\u56fe\u591a\u624b\u73a9\u51e0\u79cd\u60c5\u51b5\u3002\n\n- \u8bbf\u95ee\u4e00\u4e2a\u8fde\u901a\u5757\u7684\u6839\u8fc7\u540e\u9700\u8981\u5c06\u627e\u5230\u7684\u70b9 Splay \u4e0a\u6765\u624d\u80fd\u591f\u4fdd\u8bc1\u590d\u6742\u5ea6\u6b63\u786e\u3002\u5426\u5219\u4f60\u4f1a\u5728 CF \u4e0a `TLE on test 9`\u3002\n\n- ~~\u8fd9\u662f Ynoi\uff0c\u6240\u4ee5\u8981\u517b\u6210\u4e0d\u7528 vector \u7684\u597d\u4e60\u60ef~~\n\n___\n\n\n\u4ee3\u7801\uff1a\u56e0\u4e3a\u8fd9\u9898\u592a\u51b7\u6e05\uff0c\u6240\u4ee5\u76ee\u524d\u6682\u65f6\u662f Rank1\u3002\n\n```cpp\n//El Psy Kongroo\n#include <cstdio>\ntypedef long long LL;\nconst int maxn = 4e5+5;\nconst int Mxdt = (1<<16);\ninline char pc(char ch,bool bj) {\n\tstatic char buf[Mxdt],*p1=buf,*p2=buf+Mxdt;\n\treturn ((bj)||(*p1++=ch)&&p1==p2)&&fwrite(p1=buf,1,p1-buf,stdout),0;\n}\nvoid print(LL x) {\n\tif(x>9)print(x/10);\n\tpc(x%10^48,false);\n}\ninline void printnum(LL x,int ch) {\n\tif(x < 0)pc('-',false),x=-x;\n\tprint(x),pc(ch,false);\n}\nchar gc(){\n\tstatic char buf[1<<16],*S,*T;\n\tif(T==S){\n\t\tT=(S=buf)+fread(buf,1,1<<16,stdin);\n\t\tif(T==S) return EOF;\n\t}\n\treturn *S++;\n}\n#define getchar gc\ninline int re() {\n\tchar c;\n\twhile((c=getchar())<'0'||c>'9');\n\tint res = c-'0';\n\twhile((c=getchar())>='0'&&c<='9')res = res*10+c-'0';\n\treturn res;\n}\nstruct pair {int x,y;};\nint n,m,col[maxn],fth[maxn],head[maxn],tot;\nstruct Edge {\n\tint next,to;\n} e[maxn<<1];\nvoid add_edge(int x,int y){e[++tot].next = head[x],e[tot].to = y,head[x] = tot;}\nvoid getfa(int u,int F) {fth[u] = F;for(int i=head[u],v; v=e[i].to,i; i=e[i].next)if(v != F)getfa(v,u);}\nstruct Link_Cut_Tree {\n\t//\\sigma{white cluster siz^2}\n\tint col[maxn];\n\tLL fsizsq[maxn],Ans;\n\tint fa[maxn],ch[maxn][2],siz[maxn],fsiz[maxn];\n\tLL sq(int x) {return 1ll*x*x;}\n\tvoid psp(int x) {siz[x] = fsiz[x] + siz[ch[x][0]] + siz[ch[x][1]] + 1;}\n\tbool iden(int x) {return ch[fa[x]][1] == x;}\n\tbool nrt(int x) {return ch[fa[x]][0] == x || ch[fa[x]][1] == x;}\n\tvoid cnct(int x,int F,bool sid) {ch[fa[x] = F][sid] = x;}\n\tvoid rot(int x) {\n\t\tint y = fa[x],z = fa[y],xy = iden(x);\n\t\tif(nrt(y))ch[z][iden(y)] = x;\n\t\tcnct(ch[x][xy^1],y,xy),cnct(y,x,xy^1),fa[x] = z,psp(y);\n\t}\n\tvoid Splay(int x) {\n\t\twhile(nrt(x)) {\n\t\t\tint y = fa[x];\n\t\t\tif(nrt(y))iden(x)^iden(y)?rot(x):rot(y);\n\t\t\trot(x);\n\t\t}\n\t\tpsp(x);\n\t}\n\tvoid access(int x) {\n\t\tfor(int y=0; x; x=fa[y=x]) {\n\t\t\tSplay(x);\n\t\t\tfsiz[x] += siz[ch[x][1]]-siz[y],fsizsq[x] += sq(siz[ch[x][1]])-sq(siz[y]);\n\t\t\tch[x][1] = y,psp(x);\n\t\t}\n\t}\n\tvoid evert(int x) {access(x),Splay(x);}\n\tvoid setblack(int x) {\n\t\tif(x == 1)return evert(x),col[x] = 0,Ans += fsizsq[x],Ans -= sq(siz[x]),void();\n\t\taccess(x),Splay(fth[x]);\n\t\tcol[x] = 0,Ans += fsizsq[x];\n\t\tif(col[fth[x]] == 1) {\n\t\t\tint pos = fth[x],pr;\n\t\t\twhile(ch[pos][0])pos = ch[pos][0];\n\t\t\tif(pos == 1 && col[1])Ans -= sq(pr=siz[fth[x]]),Splay(pos);\n\t\t\telse Splay(pos),Ans -= sq(pr=siz[ch[pos][1]]);\n\t\t\taccess(x),Splay(fth[x]),ch[fth[x]][1] = fa[x] = 0,siz[fth[x]] -= siz[x];\n\t\t\tAns += sq(pr-siz[x]);\n\t\t} else ch[fth[x]][1] = fa[x] = 0,siz[fth[x]] -= siz[x],Ans -= sq(siz[x]);\n\t}\n\tvoid setwhite(int x) {\n\t\tif(x == 1)return evert(x),col[x] = 1,Ans -= fsizsq[x],Ans += sq(siz[x]),void();\n\t\tevert(x),evert(fth[x]);\n\t\tcol[x] = 1,Ans -= fsizsq[x]+sq(siz[ch[x][1]]);\n\t\tif(col[fth[x]] == 1) {\n\t\t\tint pos = fth[x],pr;\n\t\t\twhile(ch[pos][0])pos = ch[pos][0];\n\t\t\tif(pos == 1 && col[1])Ans -= sq(pr=siz[fth[x]]),Splay(pos);\n\t\t\telse Splay(pos),Ans -= sq(pr=siz[ch[pos][1]]);\n\t\t\tSplay(fth[x]),fa[x] = fth[x],fsizsq[fth[x]] += sq(siz[x]),fsiz[fth[x]] += siz[x],siz[fth[x]] += siz[x];\n\t\t\tAns += sq(pr+siz[x]);\n\t\t} else fa[x] = fth[x],fsizsq[fth[x]] += sq(siz[x]),fsiz[fth[x]] += siz[x],siz[fth[x]] += siz[x],Ans += sq(siz[x]);\n\t}\n} LCT;\nint frt[maxn],ed[maxn],nod;\nstruct Op {\n\tint tim,x,ty,next;\n} op[maxn<<2];\nvoid Add(int x,int t,int y,int ty) {\n\tif(!frt[x])frt[x] = ed[x] = ++nod,op[nod] = {t,y,ty,0};\n\telse op[ed[x]].next = ++nod,ed[x] = nod,op[nod] = {t,y,ty,0};\n}\nLL ans[maxn];\nint main() {\n\tn = re(),m = re();\n\tfor(int i=1; i<=n; ++i)col[i] = re(),Add(col[i],0,i,-1);\n\tfor(int i=1,x,y; i<n; ++i)x = re(),y = re(),add_edge(x,y),add_edge(y,x);\n\tgetfa(1,0);\n\tfor(int i=1,x,y; i<=m; ++i) x = re(),y = re(),Add(col[x],i,x,1),Add(col[x]=y,i,x,-1);\n\tfor(int i=1; i<=n; ++i)Add(col[i],m+1,i,1);\n\tfor(int i=1; i<=n; ++i)LCT.siz[i] = 1;\n\tfor(int i=1; i<=n; ++i)LCT.setwhite(i);\n\tfor(int i=1; i<=n; ++i) {\n\t\tfor(int j=frt[i]; j;) {\n\t\t\tLL preans = LCT.Ans;\n\t\t\tint tim = op[j].tim;\n\t\t\twhile(j && op[j].tim == tim) {op[j].ty==1?LCT.setwhite(op[j].x):LCT.setblack(op[j].x);j = op[j].next;}\n\t\t\tans[tim] += LCT.Ans-preans;\n\t\t}\n\t}\n\tfor(int i=1; i<=m; ++i)ans[i] += ans[i-1];\n\tfor(int i=0; i<=m; ++i)printnum(-ans[i],'\\n');\n\treturn pc('\u2642',1);\n}\n```\n\n",
        "postTime": 1620824798,
        "uid": 114153,
        "name": "Sali\u0435ri",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 \u60ca\u60f6\u7684SCOI2016"
    },
    {
        "content": "\u662f\u7684\u8fd9\u4f9d\u7136\u662f ouuan \u795e\u4ed9\u90a3\u573a\u7684[\u9898](https://www.luogu.com.cn/problem/CF1172E)\u3002\n\n~~lxl \u5bf9\u8fd9\u9898\u7684\u8bc4\u4ef7\uff08\u51fa\u81ea'[\u8fd9\u7bc7\u9898\u89e3](https://www.luogu.com.cn/blog/0123456-3456789/solution-p5609)\u7684\u8bc4\u8bba\u533a\uff09\uff1a~~\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wlvahbuo.png)\n\n\u4f46\u662f\u6211\u611f\u89c9\u8fd9\u9898\u5bf9\u6211\u6765\u8bf4\u786e\u5b9e\u6bd4 F \u96be\u5427\uff08\u96fe\n\n------------\n\u8981\u6c42\u6811\u4e0a\u6240\u6709\u8def\u5f84\u7684\u989c\u8272\u6570\u4e4b\u548c\u3002\n\n\u770b\u8d77\u6765\u4e0d\u597d\u7b97\uff0c\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e2a\u989c\u8272\u8ba1\u7b97\u8d21\u732e\uff0c\u5373\u8ba1\u7b97\u542b\u6709\u8fd9\u4e2a\u989c\u8272\u7684\u8def\u5f84\u6570\u3002\n\n\u7136\u540e\u4f3c\u4e4e\u4e5f\u4e0d\u597d\u7b97\uff1f\u6240\u4ee5\u6211\u4eec\u5bb9\u65a5\u4e00\u4e0b\uff0c\u53bb\u8ba1\u7b97\u4e0d\u542b\u8fd9\u4e2a\u989c\u8272\u7684\u8def\u5f84\u6570\u3002\u7136\u540e\u5982\u679c\u628a\u8fd9\u4e2a\u989c\u8272\u770b\u6210\u662f\u767d\u8272\uff0c\u5176\u4ed6\u989c\u8272\u770b\u6210\u662f\u9ed1\u8272\uff0c\u5219\u8fd9\u4e2a\u6570\u5c31\u662f\u6240\u6709\u9ed1\u8fde\u901a\u5757\u7684\u5927\u5c0f\u7684\u5e73\u65b9\u7684\u548c\u3002\n\n\u6bcf\u6b21\u4fee\u6539\u81f3\u591a\u4f1a\u6709\u4e24\u4e2a\u989c\u8272\uff0c\u5728\u5b83\u4eec\u770b\u6765\u8fd9\u4e2a\u70b9\u6539\u53d8\u4e86\u989c\u8272\uff08\u9ed1\u53d8\u767d\u6216\u8005\u767d\u53d8\u9ed1\uff09\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a\u4fee\u6539\u62c6\u6210\u8fd9\u6837\u7684\u5f62\u5f0f\uff0c\u7136\u540e\u8ba1\u7b97\u53d8\u5316\u91cf\uff0c\u6700\u540e\u505a\u4e00\u4e2a\u524d\u7f00\u548c\u5c31\u884c\u4e86\u3002\n\n\u95ee\u9898\u662f\u5982\u679c\u6211\u4eec\u76f4\u63a5\u4e0a lct \u7ef4\u62a4\u7684\u8bdd\u6bcf\u6b21\u6709\u53ef\u80fd\u4f1a\u8fde\u6216\u8005\u65ad\u4e00\u5806\u8fb9\uff0c\u6bd4\u5982\u4e00\u4e2a\u83ca\u82b1\u56fe\u5c31\u5361\u6389\u4e86\u3002\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u7528 Qtree6 \u90a3\u4e2a\u505a\u6cd5\uff0c\u5c31\u662f\u6bcf\u4e2a\uff0c\u8054\u901a\u5757\u6700\u4e0a\u9762\u7684\u4e00\u4e2a\u8282\u70b9\u989c\u8272\u53ef\u4ee5\u4e0d\u540c\u3002\n\n\u7136\u540e\u4e3a\u4e86\u5feb\u901f\u8ba1\u7b97\u53d8\u5316\u91cf\u6211\u4eec\u9700\u8981\u7ef4\u62a4\u4e00\u4e0b\u4e00\u4e2a\u8282\u70b9\u6240\u6709\u865a\u5b50\u6811\u7684\u5927\u5c0f\u7684\u5e73\u65b9\u548c\u3002\u63a5\u4e0b\u6765\u5c31\u662f\u5206\u7c7b\u8ba8\u8bba\u53bb\u7b97\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u7136\u540e\u7ec6\u8282\u8fd8\u662f\u7a0d\u5fae\u6709\u4e00\u70b9\u7684\uff0c\u4e0d\u61c2\u7684\u8bdd\u770b\u4ee3\u7801\u5427\u3002\n```cpp\n#include<vector>\n#include<cctype>\n#include<cstdio>\nusing namespace std;\ninline int readint(){\n\tint x=0;\n\tbool f=0;\n\tchar c=getchar();\n\twhile(!isdigit(c)&&c!='-') c=getchar();\n\tif(c=='-'){\n\t\tf=1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c)){\n\t\tx=x*10+c-'0';\n\t\tc=getchar();\n\t}\n\treturn f?-x:x;\n}\nconst int maxn=4e5+5;\nint n,m,c[maxn];\nvector<int> g[maxn];\nint fa[maxn];\nvoid dfs(int u){\n\tfor(int i=0;i<(int)g[u].size();i++){\n\t\tint v=g[u][i];\n\t\tif(v==fa[u]) continue;\n\t\tfa[v]=u;\n\t\tdfs(v);\n\t}\n}\ntypedef long long ll;\nstruct lct{\n\tint fa[maxn],ch[maxn][2],s[maxn],s2[maxn];\n\tll ss[maxn];\n\tvoid init(){\n\t\tfor(int i=1;i<=n;i++) s[i]=1;\n\t}\n\tvoid pushup(int x){\n\t\ts[x]=s2[x]+1;\n\t\tif(ch[x][0]) s[x]+=s[ch[x][0]];\n\t\tif(ch[x][1]) s[x]+=s[ch[x][1]];\n\t}\n\tbool isroot(int x){\n\t\treturn !fa[x]||(ch[fa[x]][0]!=x&&ch[fa[x]][1]!=x);\n\t}\n\tvoid rotate(int x){\n\t\tint y=fa[x],z=fa[fa[x]];\n\t\tif(!isroot(y)) ch[z][ch[z][1]==y]=x;\n\t\tbool d=ch[y][1]==x;\n\t\tint k=ch[x][!d];\n\t\tif(k) fa[k]=y;\n\t\tch[y][d]=k;\n\t\tch[x][!d]=y;\n\t\tfa[y]=x;\n\t\tfa[x]=z;\n\t\tpushup(y);\n\t\tpushup(x);\n\t}\n\tvoid splay(int x){\n\t\twhile(!isroot(x)){\n\t\t\tint y=fa[x],z=fa[fa[x]];\n\t\t\tif(!isroot(y)){\n\t\t\t\tif((ch[y][1]==x)^(ch[z][1]==y)) rotate(x);\n\t\t\t\telse rotate(y);\n\t\t\t}\n\t\t\trotate(x);\n\t\t}\n\t}\n\tvoid access(int x){\n\t\tint y=0;\n\t\twhile(x){\n\t\t\tsplay(x);\n\t\t\tif(ch[x][1]){\n\t\t\t\ts2[x]+=s[ch[x][1]];\n\t\t\t\tss[x]+=1ll*s[ch[x][1]]*s[ch[x][1]];\n\t\t\t}\n\t\t\tch[x][1]=y;\n\t\t\tif(y){\n\t\t\t\ts2[x]-=s[y];\n\t\t\t\tss[x]-=1ll*s[y]*s[y];\n\t\t\t}\n\t\t\ty=x;\n\t\t\tx=fa[x];\n\t\t}\n\t}\n\tint findroot(int x){\n\t\taccess(x);\n\t\tsplay(x);\n\t\twhile(ch[x][0]) x=ch[x][0];\n\t\tsplay(x);\n\t\treturn x;\n\t}\n\tvoid link(int x,int y){\n\t\taccess(y);\n\t\tsplay(y);\n\t\tsplay(x);\n\t\tfa[x]=y;\n\t\ts2[y]+=s[x];\n\t\tss[y]+=1ll*s[x]*s[x];\n\t\tpushup(y);\n\t}\n\tvoid cut(int x,int y){\n\t\taccess(y);\n\t\tsplay(y);\n\t\tsplay(x);\n\t\tfa[x]=0;\n\t\ts2[y]-=s[x];\n\t\tss[y]-=1ll*s[x]*s[x];\n\t\tpushup(y);\n\t}\n}t;\ntypedef pair<int,int> pii;\nvector<pii> q[maxn];\nbool c2[maxn];\nll query(int u){\n\tint x=t.findroot(u);\n\tif(c2[x]) return 1ll*t.s[t.ch[x][1]]*t.s[t.ch[x][1]];\n\telse return 1ll*t.s[x]*t.s[x];\n}\nll modify(int u){\n\tc2[u]^=1;\n\tif(c2[u]){\n\t\tif(u==1){\n\t\t\tt.access(1);\n\t\t\treturn t.ss[1]-1ll*t.s[1]*t.s[1];\n\t\t}\n\t\telse{\n\t\t\tll res=-query(u);\n\t\t\tt.cut(u,fa[u]);\n\t\t\tt.access(u);\n\t\t\tres+=t.ss[u];\n\t\t\tif(!c2[fa[u]]) res+=query(fa[u]);\n\t\t\treturn res;\n\t\t}\n\t}\n\telse{\n\t\tif(u==1){\n\t\t\tt.access(1);\n\t\t\treturn 1ll*t.s[1]*t.s[1]-t.ss[1];\n\t\t}\n\t\telse{\n\t\t\tt.access(u);\n\t\t\tll res=-t.ss[u];\n\t\t\tif(!c2[fa[u]]) res-=query(fa[u]);\n\t\t\tt.link(u,fa[u]);\n\t\t\tres+=query(u);\n\t\t\treturn res;\n\t\t}\n\t}\n}\nll ans[maxn];\nvoid solve(int c){\n\tfor(int i=0;i<(int)q[c].size();i++)\n\t\tans[q[c][i].first]+=modify(q[c][i].second);\n\tfor(int i=(int)q[c].size()-1;i>=0;i--)\n\t\tmodify(q[c][i].second);\n}\nint main(){\n\t#ifdef LOCAL\n\tfreopen(\"in.txt\",\"r\",stdin);\n\tfreopen(\"out.txt\",\"w\",stdout);\n\t#endif\n\tn=readint();\n\tm=readint();\n\tfor(int i=1;i<=n;i++) c[i]=readint();\n\tfor(int i=1;i<n;i++){\n\t\tint u,v;\n\t\tu=readint();\n\t\tv=readint();\n\t\tg[u].push_back(v);\n\t\tg[v].push_back(u);\n\t}\n\tdfs(1);\n\tt.init();\n\tfor(int i=2;i<=n;i++) t.link(i,fa[i]);\n\tfor(int i=1;i<=n;i++) q[c[i]].push_back(pii(0,i));\n\tfor(int i=1;i<=m;i++){\n\t\tint u,x;\n\t\tu=readint();\n\t\tx=readint();\n\t\tq[c[u]].push_back(pii(i,u));\n\t\tq[c[u]=x].push_back(pii(i,u));\n\t}\n\tfor(int i=1;i<=n;i++) solve(i);\n\tfor(int i=1;i<=m;i++) ans[i]+=ans[i-1];\n\tfor(int i=0;i<=m;i++) printf(\"%lld\\n\",-ans[i]);\n\treturn 0;\n}\n```",
        "postTime": 1587527623,
        "uid": 174045,
        "name": "FZzzz",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5526 \u3010[Ynoi2012]\u60ca\u60f6\u7684SCOI2016\u3011"
    },
    {
        "content": "\u611f\u89c9\u5f97\u964d\u7d2b\u554a\uff0c\u611f\u89c9\u8fd9\u9053\u9898\u786e\u5b9e\u548c Qtree6 \u6ca1\u6709\u4ec0\u4e48\u672c\u8d28\u533a\u522b\uff1f         \n\n\u79bb\u7ebf\u505a\u6cd5\uff0c\u9ed8\u8ba4\u5927\u5bb6\u90fd\u4f1a LCT \u7ef4\u62a4\u5b50\u6811\u4fe1\u606f\u3002\n\n\u9996\u5148\u5f88\u5bb9\u6613\u60f3\u5230 Qtree6 \u7684\u90a3\u4e2a\u9ed1\u767d\u67d3\u8272\u5757\u7684\u5957\u8def\uff0c\u5982\u679c\u6211\u4eec\u5c06\u6bcf\u79cd\u989c\u8272\u90fd\u62ff\u53bb\u8dd1\u9ed1\u767d\u67d3\u8272\u5757\uff0c\u5c06\u8be5\u79cd\u989c\u8272\u89c6\u4e3a\u767d\u8272\u53e6\u4e00\u79cd\u989c\u8272\u89c6\u4e3a\u9ed1\u8272\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u7ef4\u62a4\u6240\u6709\u9ed1\u8272\u67d3\u8272\u5757\u5927\u5c0f\u7684\u5e73\u65b9\u4ee5\u83b7\u5f97\u6709\u591a\u5c11\u6761\u8def\u7ecf\u4e0a\u6ca1\u6709\u8be5\u79cd\u989c\u8272\uff0c\u51cf\u4e00\u51cf\u5c31\u662f\u8be5\u79cd\u989c\u8272\u5728\u6811\u4e0a\u8def\u5f84\u7684\u51fa\u73b0\u6b21\u6570\u4e86\u3002                \n\n\u5047\u8bbe\u4f60\u6bd4\u8f83\u731b\uff0c\u76f4\u63a5\u5f00\u4e86 $n$ \u68f5 LCT\uff0c\u90a3\u4e48\u4f60\u53d1\u73b0\u6bcf\u6b21\u4fee\u6539\u64cd\u4f5c\u53ea\u4f1a\u5f71\u54cd\u4e24\u68f5 LCT \u800c\u5176\u5b83\u7684 LCT \u6839\u672c\u4e0d\u53d8\uff0c\u53ef\u4ee5\u5c06 $m + 1$ \u6b21\u64cd\u4f5c\u770b\u6210\u65f6\u95f4\uff0c\u4e00\u68f5 LCT \u4f1a\u5bf9 $m + 1$ \u65f6\u95f4\u91cc\u9762\u7684\u67d0\u4e9b\u6bb5\u65f6\u95f4\u5185\u8d21\u732e\u4e00\u4e2a\u56fa\u5b9a\u7684\u503c\uff0c\u90a3\u4e48\u4e0d\u96be\u53d1\u73b0\u6240\u6709 LCT \u7684\u6bb5\u5927\u5c0f\u52a0\u8d77\u6765\u603b\u5171\u4e5f\u53ea\u4f1a\u6709 $O(n + m)$ \u7ea7\u522b\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u8981\u5bf9\u5e94\u7684\u8dd1\u51fa\u6765\u8fd9\u4e9b\u6bb5\u7684\u8d21\u732e\u540e\u5dee\u5206\u6eda\u524d\u7f00\u548c\u5373\u53ef\u3002            \n\n\u8fd9\u91cc\u8bb2\u4e00\u4e0b\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u76f4\u63a5\u7ef4\u62a4\u5b50\u6811\u5927\u5c0f\u7136\u540e\u5e73\u65b9\u3002\u5728 Qtree6 \u65f6\u6211\u4eec\u76f4\u63a5\u5c31\u7ef4\u62a4\u4e86\u4e2a\u5b50\u6811\u5927\u5c0f\u7136\u540e\u5c31\u7ed3\u675f\u4e86\uff0c\u4f46\u662f\u8fd9\u9053\u9898\u91cc\u9762\u4f60\u8fd0\u7528\u540c\u6837\u7684\u65b9\u6cd5\u7ef4\u62a4\uff0c\u4f60\u662f\u65e0\u6cd5\u77e5\u9053\u5047\u6839\u662f\u628a\u54ea\u4e9b\u8fde\u901a\u5757\u5408\u5728\u4e86\u4e00\u8d77\uff0c\u81ea\u7136\u800c\u7136\u5c31\u4e0d\u80fd\u76f4\u63a5\u7ef4\u62a4\u5b50\u6811\u5927\u5c0f\u4e86\u3002               \n\n\u4e5f\u6bd4\u8f83\u597d\u89e3\u51b3\uff0c\u6839\u636e LCT \u7684\u539f\u7406\u6211\u4eec\u77e5\u9053\u6709\u6839\u6811\u5185\u4e00\u4e2a\u70b9\u7684\u5b50\u6811\u5c31\u662f\u5728\u539f\u5b9e\u6839\u5728 LCT \u7684\u6839\u4e0a\u65f6\u5b83\u7684\u865a\u5b50\u6811\u52a0\u4e0a\u5b83\u81ea\u5df1\uff0c\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u7ef4\u62a4\u4e00\u4e0b\u865a\u5b50\u6811\u7684\u5927\u5c0f\u5e73\u65b9\u4e4b\u548c\u5c31\u597d\u4e86\u3002               \n\n\u6ce8\u610f\u4e00\u4e0b\u522b\u5c11\u5f00 long long\uff0c\u522b\u5f00\u5c0f\u7a7a\u95f4\uff0c\u522b\u628a LCT \u5199\u5047\u4e86\u57fa\u672c\u4e0a\u5c31\u80fd\u8fc7\u4e86\uff0c\u4e0d\u5361\u5e38\u8fd8\u53ef\u4ee5\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O((n + m) \\log n)$\u3002\n\n",
        "postTime": 1640851150,
        "uid": 132533,
        "name": "Hakuoro",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5526 [Ynoi2012] \u60ca\u60f6\u7684 SCOI2016"
    }
]
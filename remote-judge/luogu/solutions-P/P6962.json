[
    {
        "content": "# \u9898\u610f\n\n\u7ed9 $n$ \u4e2a\u7269\u54c1\uff0c\u6bcf\u4e2a\u7269\u54c1\u53ea\u6709 $1$ \u4e2a\uff0c\u4f53\u79ef\u4e3a $b_i $\uff0c\u6c42\u53d6\u51fa\u7269\u54c1\u603b\u4f53\u79ef\u4e3a $s$ \u7684\u65b9\u6848\u3002(\u6a21 $2^{64}$\uff0c\u4fdd\u8bc1\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a\u89e3)\n\n$b_i$ \u7684\u751f\u6210\u65b9\u5f0f\u4e3a\uff1a\u968f\u673a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684 $a_i$ \u5e8f\u5217\uff0c\u6ee1\u8db3\u5bf9\u4e8e\u4efb\u610f $k$ \u90fd\u6709\uff1a\n$$(\\sum_{i=1}^{k-1}a_i)< a_k\\quad \\text{\u6027\u8d281}$$ \n$$\\sum a_i< 2^{64}\\quad\\text{\u6027\u8d282}$$\n\u518d\u968f\u673a\u4e00\u4e2a $r$\uff0c$r<2^{64}$ \u4e14 $r$ \u548c $2^{64}$ \u4e92\u8d28\u3002\u7136\u540e $b_i\\equiv a_i\\cdot r\\ (mod\\ 2^{64})$ \u3002\n\n$n\\leq64$\n\n# Case 1\n\n\u663e\u7136\u8fd9\u4e00\u4e2a\u8d85\u5927\u80cc\u5305\u95ee\u9898\uff0c\u90a3\u4e48\u6211\u4eec\u5b66\u8fc7\u4e00\u4e2a\u7ecf\u5178\u7684\u6298\u534a\u7684\u89e3\u51b3\u65b9\u6cd5\uff0c\u590d\u6742\u5ea6$O(2^{\\frac n2})$\uff0c\u53ef\u4ee5\u89e3\u51b3 $n\\leq46$ \u7684\u90e8\u5206\u3002\n\n\u7b80\u5355\u8bb2\u4e00\u4e0b\uff0c\u5c31\u662f\u66b4\u529b\u679a\u4e3e\u524d\u4e00\u534a\u7684\u6240\u6709\u9009\u62e9\u65b9\u6848\uff0c\u7528\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u628a\u6240\u6709 $(S,sum)$ \u5b58\u4e0b\u6765\uff0c\u7136\u540e\u518d\u679a\u4e3e\u540e\u4e00\u534a\u7684\u6240\u6709\u9009\u62e9\u65b9\u6848\uff0c\u770b\u662f\u5426\u5b58\u5728\u5bf9\u5e94\u7684\u524d\u4e00\u534a\u7684\u9009\u62e9\u65b9\u6848\u3002\n\n```cpp\ninline void Solve(){\n    int mid = n>>1, tp = 1<<mid;\n    for(register int s=0; s<tp; s++){\n        ull sum=0;\n        for(register int i=1; i<=mid; i++) if((s>>i-1)&1) sum += b[i];\n        insert(sum,s);\n    }\n    tp = 1<<(n-mid);\n    for(register int s=0; s<tp; s++){\n        ull sum=0;\n        for(register int i=1; i<=n-mid; i++) if((s>>i-1)&1) sum += b[mid+i];\n        int ps = find(S-sum);\n        if(ps!=-1){\n            for(register int i=1; i<=mid; i++) if((ps>>i-1)&1) putchar('1'); else putchar('0');\n            for(register int i=1; i<=n-mid; i++) if((s>>i-1)&1) putchar('1'); else putchar('0');\n            puts(\"\");\n            return;\n        }\n    }\n}\n```\n\n# Case 2\n\n\u8003\u8651 $n\\in(46,64]$ \u7684\u90e8\u5206\u3002\n\n\u6ce8\u610f\u4e00\u4e0b $b_i$ \u7684\u751f\u6210\u65b9\u5f0f\uff0c\u5982\u679c\u6211\u4eec\u77e5\u9053\u4e86 $r$\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u6c42\u51fa $a_i$ \u548c\u5bf9\u5e94\u7684 $s'$\u3002\u6839\u636e $a_i$ \u7684\u6027\u8d28\uff0c\u53ef\u4ee5\u76f4\u63a5\u8d2a\u5fc3\u6c42\u51fa\u7b54\u6848\u3002\n\n```cpp\nfor(register int i=n; i; i--) \n\tif(S>=a[i]) S -= a[i], ans[i] = '1';\n\telse ans[i] = '0';\n```\n\n*\u9996\u5148\u6839\u636e**\u6027\u8d282**\uff0c\u662f\u4e0d\u7528\u8003\u8651\u53d6\u6a21\u7684\u3002\u5176\u6b21\uff0c\u4ece\u5927\u5230\u5c0f\u8003\u8651\u65f6\uff0c\u5982\u679c $S\\geq a_k$ \u800c\u4e0d\u9009 $a_k$\uff0c\u6839\u636e**\u6027\u8d281**\uff0c\u5c31\u7b97\u540e\u9762\u5168\u90e8\u9009\u4e5f\u51d1\u4e0d\u9f50 $a_k$\uff0c\u66f4\u522b\u8bf4\u51d1\u9f50 $S$ \u4e86\u3002*\n\n\u90a3\u4e48\u6838\u5fc3\u95ee\u9898\u8f6c\u4e3a\u4e86\u5982\u4f55\u6c42 $r$\u3002\n\n\u6839\u636e**\u6027\u8d281**\u53ef\u4ee5\u63a8\u51fa $a_1<\\frac{2^{64}}{2^n}$\uff0c\u4e8e\u662f\u5f97\u5230\u4e86 $a_1$ \u7684\u8303\u56f4\uff0c$mx=\\frac{2^{64}}{2^n}$\u3002\u53c8\u56e0\u4e3a $r$ \u662f\u4e00\u4e2a\u5947\u6570\uff0c\u6240\u4ee5 $a_1$ \u672b\u5c3e $0$ \u7684\u4e2a\u6570\u4e00\u5b9a\u548c $b_1$ \u672b\u5c3e $0$ \u7684\u4e2a\u6570\u4e00\u6837\uff0c\u8bbe\u4e3a $cnt$\uff0c\u90a3\u4e48\u53ef\u80fd\u7684 $a_i$ \u5c31\u53ea\u6709 $\\frac{2^{64}}{2^{n-cnt-1}}$\u4e2a\uff0c\u5927\u6982\u662f $2^{18}$ \u7ea7\u522b\u3002\n\n\u4e8e\u662f\u60f3\u5230\u679a\u4e3e $a_1$\uff0c\u7136\u540e\u6c42\u51fa $r^{-1}$\u3002\u4e5f\u5c31\u662f\u6c42 $a_1\\equiv r^{-1}\\cdot b_1\\ (mod\\ 2^{64})$\uff0c\u5148\u540c\u9664 $2^{cnt}$\uff0c\u5f97\u5230 $a'\\equiv r^{-1}\\cdot b'\\ (mod\\ 2^{64-cnt})$\uff0c\u6b64\u65f6\u56e0\u4e3a $b'$ \u662f\u5947\u6570\u4e0e $2^{64-cnt}$ \u4e92\u8d28\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u7528\u5feb\u901f\u5e42\u6c42\u51fa $b'^{-1}$ \u3002\n\n```cpp\null tp=1ull<<(64-n-cnt-1);\nfor(register ull i=0; i<tp; i++){\n    ull a1 = (((i<<1)|1)<<cnt);\n    ull r = (a1>>cnt)*ksm(tmp,(1ull<<(64-cnt-1))-1); \n    if(cnt) r = r&((1ull<<64-cnt)-1);\n}\n```\n\n\u4f46\u662f\u8fd9\u6837\u6c42\u51fa\u7684\u662f\u6a21 $2^{64-cnt}$ \u610f\u4e49\u4e0b\u7684 $r^{-1}$\uff0c\u65e0\u6cd5\u6c42\u51fa\u771f\u6b63\u7684 $r^{-1}$ \u7684\u5f00\u5934 $cnt$ \u4f4d\uff0c\u6240\u4ee5\u8fd8\u8981 $2^{cnt}$ \u679a\u4e3e\u4e00\u4e0b\u3002\n\n```cpp\null tp1=1ull<<cnt;\nfor(register ull j=0; j<tp1; j++){\n    ull true_r = r|(j<<63-cnt+1);\n    check(true_r);\n}\n```\n# \u6742\u9879\n\n[\u4ee3\u7801](https://www.luogu.com.cn/paste/i9xg6mru)\n\n~~\u51fa\u5bc6\u7801\u5b66\u7684\u90fd\u662f\u6bd2\u7624~~\n\n\u5feb\u901f\u5e42\u90e8\u5206\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528\u81ea\u7136\u6ea2\u51fa\u5feb\u901f\u5e42\uff0c\u56e0\u4e3a $a\\mod b=(a\\mod kb)\\mod b$\n\n\u5173\u4e8e\u590d\u6742\u5ea6\uff0c\u8bbe\u4e24\u4e2a $Case$ \u5206\u754c\u70b9\u4e3a $k$\uff0c\u90a3\u4e48\u590d\u6742\u5ea6\u5206\u522b\u4e3a $O(2^{\\frac k2})$ \u548c $O(2^{n-k})$\uff0c\u6240\u4ee5\u7406\u8bba\u4e0a $k=\\frac23\\cdot64$ \u65f6\u53d6\u5230\u6700\u4f18\u590d\u6742\u5ea6\u3002",
        "postTime": 1615878251,
        "uid": 56825,
        "name": "oisdoaiu",
        "ccfLevel": 9,
        "title": "P6962 [NEERC2017]Knapsack Cryptosystem"
    },
    {
        "content": "### $1.n\\le20$\n\n\u66b4\u529b dfs\u3002  \n\u590d\u6742\u5ea6 $O(2^n)$\u3002\n\n### $2.n\\le40$   \n\n\u663e\u7136\u8fc7\u4e0d\u53bb,\u8003\u8651 $\\verb!meet-in-the-middle!$\u3002  \n\u628a\u6574\u4e2a\u5bc6\u7801\u4e32\u5206\u4e3a $2$ \u6bb5\u3002\n\u524d\u534a\u6bb5\u641c\u5b8c\u6254\u5230\u54c8\u5e0c\u8868\u91cc\uff0c\u540e\u534a\u6bb5\u641c\u7d22\u641c\u5b8c\u540e\u53bb\u54c8\u5e0c\u8868\u4e2d\u5408\u5e76\u7b54\u6848\u3002  \n\u590d\u6742\u5ea6 $O(2^\\frac{n}{2})$\u3002\n\nCode:\n```\nnamespace sub1\n{\n\tunordered_map<ull,int>mp;\n\tint c[66],len;\n\tull temp,hh,sum;\n\tint hf1,hf2;\n\tvoid main()\n\t{\n\t\thf1=n/2,hf2=n-hf1;\n\t\tfor(int i=0;i<(1<<hf1);i++)\n\t\t{\n\t\t\tsum=0;\n\t\t\tfor(int j=0;j<hf1;j++)\n\t\t\tif(i>>j&1)sum+=b[j+1];\n\t\t\tmp[sum]=i+1;\n\t\t}\n\t\tfor(int i=0;i<(1<<hf2);i++)\n\t\t{\n\t\t\tsum=0;\n\t\t\tfor(int j=0;j<hf2;j++)\n\t\t\tif(i>>j&1)sum+=b[hf1+j+1];\n\t\t\thh=s-sum;\n\t\t\tif(mp[hh])\n\t\t\t{\n\t\t\t\tmp[hh]--;\n\t\t\t\ttemp=mp[hh];while(temp)c[++len]=temp&1,temp>>=1;\n\t\t\t\tlen=hf1;\n\t\t\t\ttemp=i;while(temp)c[++len]=temp&1,temp>>=1;\n\t\t\t\tfor(int i=1;i<=n;i++)cout<<c[i];\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n}\n```\n\n### $3.r\\le10^6$\n\n\u8003\u8651 $r$ \u4e0d\u5927\uff0c\u9898\u76ee\u53c8\u8bf4 $r,q$ \u4e92\u8d28\uff0c\u76f4\u63a5\u679a\u4e3e $r$\uff0c\u7136\u540e\u6c42\u4e2a\u9006\u5143\uff0c\u4ece $b$ \u6570\u7ec4\u5012\u63a8\u56de $a$\uff0c\u7136\u540e check\u3002 \n\n\u8bc1\u660e:\n\n\u56e0 $s\\equiv \\sum_{i=1}^{n}[x_i=1]\\cdot b_i\\pmod q$\u3002  \n\u5219 $s\\cdot r^{-1}\\equiv \\sum_{i=1}^{n}[x_i=1]\\cdot b_i\\cdot r^{-1}\\pmod q$\u3002  \n\u5373 $s\\cdot r^{-1}\\equiv \\sum_{i=1}^{n}[x_i=1]\\cdot a_i\\pmod q$\u3002\n\n\u6839\u636e $a_i>\\sum\\limits_{j=1}\\limits^{i-1} {a_j}$ \u53ef\u77e5\uff0c\u5bf9\u4e8e\u4efb\u610f $s,r$, $a$ \u7684\u89e3\u552f\u4e00\u3002  \n\n~~\u539f\u56e0\u663e\u7136\u3002~~\n\n\u5c06\u8fd8\u539f\u51fa\u7684\u5408\u6cd5\u7684 $a$ \u5bf9 $s \\cdot r^{-1}$ \u8fdb\u884c\u4ece\u5927\u5230\u5c0f\u80fd\u51cf\u5c31\u51cf\u7684\u8d2a\u5fc3\u3002\n\n\n\u590d\u6742\u5ea6 $O(r\\times (n+\\log q))$\u3002   \n\n### $4.b$ \u4e3a\u5947\u6570 \n\u5f53 $b$ \u662f\u5947\u6570\u65f6\uff0c$a_1$ \u662f\u5947\u6570\u3002   \n\u8bc1\u660e\uff1a  \n\u82e5 $a$ \u4e3a\u5076\u6570\uff0c\u65e0\u8bba $r$ \u53d6\u5947\u8fd8\u662f\u5076\uff0c$b$ \u4e0d\u53ef\u80fd\u4e3a\u5947\u6570\u3002\n\n\u8003\u8651\u679a\u4e3e $a_1$\u3002\n\n\u53c8\u56e0\u4e3a $a_i>\\sum\\limits_{j=1}\\limits^{i-1} {a_j}, q > \\sum_{i=1}^{n}a_i$\uff0c\n\u6240\u4ee5 $0 \\le a_1 \\le 2^{65-n}$\u3002  \n\u518d\u548c\u7b2c $2$ \u6863\u53cc\u5411\u641c\u7d22\u8fdb\u884c\u6570\u636e\u5206\u6cbb\u3002\n\n\n### $5.\u6b63\u89e3$\n\u8fd9\u4e00\u6863\u8003\u8651\u89e3\u4ece $r$ \u51fa\u53d1\uff1a\n\u56e0\u4e3a $r,q$ \u4e92\u8d28\uff0c\u6240\u4ee5 $r$ \u5fc5\u7136\u662f\u5947\u6570\u3002\n\n\u8bbe $a_1=a'\\cdot 2^x$\uff0c\u90a3\u4e48 $b_1$ \u4e5f\u80fd\u88ab\u62c6\u6210 $b_1=b' \\cdot 2^x$\u3002\n\n\u56e0\u4e3a\u8981\u62c6\u5149\uff0c\u6240\u4ee5 $a'$ \u548c $b'$ \u90fd\u662f\u5947\u6570\u3002\n\n**\u611f\u6027\u8bc1\u660e\uff1a**  \n\u628a $a_1$ \u62c6\u6210 $a'\\cdot 2^x$ \u8fd9\u79cd\u5f62\u5f0f\uff0c $x$ \u76f8\u5f53\u4e8e $a$ \u5728\u4e8c\u8fdb\u5236\u4f4d\u4e0b\u672b\u5c3e $0$ \u7684\u4e2a\u6570\u3002  \n\u56e0\u4e3a $r$ \u662f\u5947\u6570\uff0c\u6240\u4ee5 $r \\cdot a_1$ \u4e0d\u4f1a\u4e3a $a_1$ \u5728\u672b\u5c3e\u589e\u52a0\u65b0\u7684 $0$ \u7684\u4e2a\u6570\u3002\n\n\u56e0\u4e3a $a_i\\equiv b_i \\cdot r^{-1}\\pmod{2^{64}}$\u3002  \n\u5148\u8f6c\u5316\u4e3a $a_1\\equiv b_1 \\cdot r^{-1}\\pmod{2^{64}}$\u3002   \n\u6839\u636e\u4e0a\u9762\u7684\u63a8\u8bba\u62c6\u6210\uff1a$a'\\cdot 2^x \\equiv b'\\cdot 2^x \\cdot r^{-1}\\pmod{2^{64}}$\u3002  \n\u53ef\u5f97\uff1a$a'\\equiv b' \\cdot r^{-1}\\pmod{2^{64-x}}$\u3002  \n\u6700\u7ec8\u5f97\u5230 $r^{-1} \\equiv a' \\cdot b'^{-1} \\pmod{2^{64-x}}$\u3002\n\n\u4f46\u8fd9\u6837\u6c42\u51fa\u7684\u662f\u6a21 $2^{64-x}$ \u610f\u4e49\u4e0b\u7684 $r^{-1}$\uff0c\u6240\u4ee5\u8fd8\u7f3a\u6700\u9ad8\u7684 $x$ \u4f4d\uff0c\u6240\u4ee5\u8981\u5bf9\u8fd9 $x$ \u4f4d\u679a\u4e3e\uff0c\u56e0\u4e3a\u4f60\u5e76\u4e0d\u77e5\u9053\u4ed6\u4eec\u662f\u4ec0\u4e48\uff08\n\n\n\u6298\u534a\u7684\u590d\u6742\u5ea6\u4e3a $O(2^\\frac{n}{2})$\uff0c\u6b63\u89e3\u7684\u590d\u6742\u5ea6\u4e3a $O(n \\times 2^{64-n})$\uff0c\u6240\u4ee5\u5bf9\u6570\u636e\u8fdb\u884c\u5206\u6cbb\u3002\n\n\u7406\u8bba\u4e0a $k=\\frac{2}{3} \\times 64\\approx 43$ \u65f6\u6700\u4f18\u3002\n\n[\u63d0\u4ea4\u8bb0\u5f55](https://www.luogu.com.cn/record/102070974)\n\n\u540e\u7eed\uff1a  \n\u5176\u5b9e $a_1$ \u7684\u4e0a\u754c\u4e0d\u7528\u7ba1\uff0c\u56e0\u4e3a\u6570\u636e\u4fdd\u8bc1\u6709\u89e3\uff0c\u800c\u4e14\u6570\u636e\u5206\u6cbb\u8fc7\u540e\u5176\u5b9e\u4e0a\u754c\u4e0d\u4f1a\u592a\u5927\u3002\u6240\u4ee5\u53ef\u4ee5\u5f00 $2^{63}-1$\uff08",
        "postTime": 1676272564,
        "uid": 230243,
        "name": "syf2008",
        "ccfLevel": 0,
        "title": "P6962 sol"
    }
]
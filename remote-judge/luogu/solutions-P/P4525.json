[
    {
        "content": "### \u6211\u8868\u793a\u6211\u662f\u6765\u7838\u573a\u5b50\u7684\n> \u7eaf\u6570\u5b66\u63a8\u5bfc\n$$\\int_L^R\\frac{cx+d}{ax+b}dx$$\n$$(\\frac{cx}{a}+(\\frac{d}{a}-\\frac{bc}{a^2})*\\ln|ax + b|)|^R_L$$\n\u7279\u52240\n\n### code\n```cpp\n#include<bits/stdc++.h>\n#define eps 1e-8\ndouble a, b, c, d, l, r;\ndouble f(double x)\n{\n    return c * x / a + (d / a - b * c / (a * a)) * log(a * x + b);\n}\ndouble f2(double x)\n{\n\tcout << \"o\";\n    return ((c * x * x) / (2 * b) + (d * x) / b);\n}\nusing namespace std;\nint main()\n{\n    scanf(\"%lf%lf%lf%lf%lf%lf\", &a, &b, &c, &d, &l, &r);\n    if(abs(a) == 0)\n        printf(\"%.6lf\", f2(r) - f2(l));\n    else printf(\"%.6lf\", f(r) - f(l));\n    return 0;\n}\n```",
        "postTime": 1526045927,
        "uid": 29519,
        "name": "qianfujia",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4525 \u3010\u3010\u6a21\u677f\u3011\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd51\u3011"
    },
    {
        "content": "# **\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\u8bf7\u53c2\u8003[\u6211\u7684\u535a\u5ba2](https://phqghume.github.io/2018/05/19/\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd5/)**\r\n\r\n# Simpson\u516c\u5f0f\r\n\r\n\u5728\u5b66\u4e60Simpson\u516c\u5f0f\u4e4b\u524d\u6700\u597d\u8981\u5bf9**\u5b9a\u79ef\u5206**\u6709\u4e00\u4e2a\u57fa\u672c\u7684\u4e86\u89e3\uff0c\u4e0d\u8fc7\u4e0d\u4e86\u89e3\u4e5f\u6ca1\u6709\u5173\u7cfb ~~\uff08\u6bd4\u5982\u6211\uff09~~\r\n\r\nSimpson\u516c\u5f0f\u5c31\u662f\u5728\u79ef\u5206\u533a\u95f4$[a,b]$\u4e0a\u53bb\u627e\u4e09\u4e2a\u70b9$a,b$\u548c$m=(a+b)/2$\uff0c\u8ba1\u7b97\u5176\u539f\u51fd\u6570\u7684\u5728\u6b64\u5904\u7684\u503c\uff0c\u7136\u540e\u7528\u629b\u7269\u7ebf\u6765\u62df\u5408\u539f\u51fd\u6570\u3002\r\n\r\n## \u5b9a\u79ef\u5206\u8ba1\u7b97\u65b9\u6cd5\r\n\r\n\u5b9a\u79ef\u5206\u5c31\u662f\u6c42\u51fd\u6570$f(x)$\u5728\u533a\u95f4$[a,b]$\u4e2d\u7684\u56fe\u50cf\u5305\u56f4\u7684\u9762\u79ef\u3002\u5373\u7531$y=0,x=a,x=b,y=f(x)$\u6240\u56f4\u6210\u56fe\u5f62\u7684\u9762\u79ef\u3002\r\n\r\n\u8fd9\u91cc\u7684\u9762\u79ef\u662f\u6709\u6b63\u8d1f\u7684\uff0c$y=0$\u4e0a\u65b9\u7684\u9762\u79ef\u4e3a\u6b63\uff0c\u4e0b\u65b9\u4e3a\u8d1f\u3002\r\n\r\n\u5982\u4f55\u8ba1\u7b97\u5462\uff0c\u53ef\u4ee5\u7528\u628a\u533a\u95f4\u5206\u6210\u51e0\u4e2a\u5c0f\u533a\u95f4\u7136\u540e\u628a\u5c0f\u533a\u95f4\u7684\u79ef\u5206\u6c42\u89e3\u518d\u6c42\u548c\u7684\u65b9\u6cd5\uff0c\u8fd9\u65f6\u5019\u5c31\u8981\u7528\u5230Simpson\u516c\u5f0f\u4e86\r\n\r\n## Simpson\u516c\u5f0f\u63a8\u5bfc\r\n\r\n\u63a8\u5bfc\u8fc7\u7a0b\u9664\u4e86\u4e00\u4e2a\u6b65\u9aa4\u5176\u4f59\u90fd\u662f\u521d\u4e2d\u5185\u5bb9\u4e86\uff0c\u63a8\u5bfc\u8fc7\u7a0b\u5982\u4e0b\r\n\r\n\u8bbe$f(x)$\u4e3a\u539f\u51fd\u6570\uff0c$g(x)=Ax^2+Bx+C$\u4e3a\u62df\u5408\u540e\u7684\u51fd\u6570\uff0c\u5219\u6709\r\n\r\n$$\\int_a^bf(x)dx$$\r\n$$\\approx\\int_a^bAx^2+Bx+C$$\r\n$$=\\frac{A}{3}(b^3-a^3)+\\frac{B}{2}(b^2-a^2)+C(a-b)$$\r\n$$=\\frac{(b-a)}{6}(2A(b^2+ab+a^2)+3B(b+a)+6C)$$\r\n$$=\\frac{(b-a)}{6}(2Ab^2+2Aab+2Aa^2+3Bb+3Ba+6C)$$\r\n$$=\\frac{(b-a)}{6}(Aa^2+Ba+C+Ab^2+Bb+C+4A(\\frac{a+b}{2})^2+4B(\\frac{a+b}{2})+4C)$$\r\n$$=\\frac{(b-a)}{6}(f(a)+f(b)+4f(\\frac{a+b}{2}))$$\r\n\r\n\u7136\u540e\u5c31\u5f97\u5230\u4e86**Simpson\u516c\u5f0f** \r\n\r\n$$\\int_a^bf(x)dx\\approx\\frac{(b-a)(f(a)+f(b)+4f(\\frac{a+b}{2}))}{6}$$\r\n\r\n\u7528C++\u8bed\u8a00\u63cf\u8ff0\u5982\u4e0b\r\n\r\n``` cpp\r\ninline double simpson(double l,double r) {\r\n\tdouble mid=(l+r)/2;\r\n\treturn (f(l)+4*f(mid)+f(r))*(r-l)/6; //f(x)\u662f\u539f\u51fd\u6570\r\n}\r\n```\r\n\r\n# \u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd5\r\n\r\n\u6211\u4eec\u77e5\u9053\u4e86\u5b9a\u79ef\u5206\u7684\u8ba1\u7b97\u65b9\u6cd5\uff0c\u4e5f\u77e5\u9053\u4e86Simpson\u516c\u5f0f\uff0c\u6309\u7406\u8bf4\u53ef\u4ee5\u8ba1\u7b97\u4e86\u3002\r\n\r\n\u4f46\u662f\u6709\u4e00\u4e2a\u5f88\u91cd\u8981\u7684\u95ee\u9898\u9700\u8981\u6ce8\u610f\uff1a**\u7cbe\u5ea6**\u3002\r\n\r\n\u533a\u95f4\u5206\u5c11\u4e86\u7cbe\u5ea6\u53ef\u80fd\u4e0d\u591f\uff0c\u533a\u95f4\u5206\u591a\u4e86\u53c8\u4f1a\u592a\u6162\uff0c**\u81ea\u52a8\u63a7\u5236\u533a\u95f4\u5206\u5272\u7684\u5927\u5c0f**\uff0c\u5c31\u662f\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd5\u7684\u597d\u5904\u3002\r\n\r\n\u5b9e\u73b0\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u4e8c\u5206\u9012\u5f52\u7684\u8fc7\u7a0b\uff0c\u5982\u679c\u6ee1\u8db3\u4e86\u7cbe\u5ea6\u9700\u8981\uff0c\u5219\u53ef\u4ee5\u7ec8\u6b62\u9012\u5f52\uff0c\u800c\u8fd9\u5c31\u662f\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd5\u80fd\u591f\u81ea\u52a8\u63a7\u5236\u533a\u95f4\u5206\u5272\u5927\u5c0f\u7684\u624b\u6bb5\u3002\r\n\r\n\u4ee3\u7801\u5982\u4e0b\r\n\r\n``` cpp\r\ndouble asr(double l,double r,double eps,double ans) {\r\n\tdouble mid=(l+r)/2;\r\n\tdouble l_=simpson(l,mid),r_=simpson(mid,r);\r\n\tif(fabs(l_+r_-ans)<=15*eps) return l_+r_+(l_+r_-ans)/15;\r\n\treturn asr(l,mid,eps/2,l_)+asr(mid,r,eps/2,r_);\r\n}\r\ninline double asr(double l,double r,double eps) {\r\n\treturn asr(l,r,eps,simpson(l,r));\r\n}\r\n```\r\n\r\n\u8c03\u7528\u7684\u65f6\u5019\u53ea\u8981\u7ed9\u51fa\u533a\u95f4\u8d77\u70b9\u548c\u7ec8\u70b9\u548c\u9700\u8981\u7684\u7cbe\u5ea6\u5c31\u53ef\u4ee5\u4e86\r\n\r\n---\r\n\r\n\u8fd9\u4e2a\u9898\u7684\u8bdd\u76f4\u63a5\u5957\u677f\u5b50\u5c31\u6ca1\u6709\u95ee\u9898\uff0c\u6ce8\u610f\u7cbe\u5ea6\u7cbe\u786e\u52301e-6\r\n\r\n``` cpp\r\n#include <bits/stdc++.h>\r\ndouble a,b,c,d,l,r;\r\ninline double f(double x) {\r\n\treturn (c*x+d)/(a*x+b);       //\u539f\u51fd\u6570\r\n}\r\ninline double simpson(double l,double r) {      //Simpson\u516c\u5f0f\r\n\tdouble mid=(l+r)/2;\r\n\treturn (f(l)+4*f(mid)+f(r))*(r-l)/6;\r\n}\r\ndouble asr(double l,double r,double eps,double ans) {\r\n\tdouble mid=(l+r)/2;\r\n\tdouble l_=simpson(l,mid),r_=simpson(mid,r);\r\n\tif(fabs(l_+r_-ans)<=15*eps) return l_+r_+(l_+r_-ans)/15;     //\u786e\u8ba4\u7cbe\u5ea6\r\n\treturn asr(l,mid,eps/2,l_)+asr(mid,r,eps/2,r_);     //\u7cbe\u5ea6\u4e0d\u591f\u5219\u9012\u5f52\u8c03\u7528\r\n}\r\ninline double asr(double l,double r,double eps) {\r\n\treturn asr(l,r,eps,simpson(l,r));\r\n}\r\nint main() {\r\n\tscanf(\"%lf%lf%lf%lf%lf%lf\",&a,&b,&c,&d,&l,&r);\r\n\tprintf(\"%.6lf\",asr(l,r,1e-6));\r\n\treturn 0;\r\n}\r\n```",
        "postTime": 1526727945,
        "uid": 47055,
        "name": "ikka",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4525 \u3010\u3010\u6a21\u677f\u3011\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd51\u3011"
    },
    {
        "content": "## \u5199\u5728\u524d\u9762\n\u672c\u9898\u89e3\u5305\u542b\u4e24\u90e8\u5206\uff1a\n1. \u4e00\u4e2a\u6211\u770b\u8d77\u6765\u6bd4\u8f83\u8212\u670d\u7684\u6570\u5b66\u63a8\u5bfc\n1. \u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u7684\u4e00\u4e2a\u7b80\u5355~~\u5e76\u4e14\u6ca1\u4ec0\u4e48\u5375\u7528~~\u7684\u4f18\u5316\n## \u6570\u5b66\u63a8\u5bfc\n\u770b\u597d\u591a\u5927\u4f6c\u90fd\u7528\u6570\u5b66\u65b9\u6cd5\u505a\u7684\uff0c\u4f46\u662f\u6211\u8fd9\u4e2a\u5783\u573e\u5e76\u770b\u4e0d\u61c2\u3002\u6240\u4ee5\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4e2a\u597d\u61c2\u4e00\u70b9\u7684\u4f18\u5316\u3002\n\n\u8bb0\u88ab\u79ef\u51fd\u6570\u4e3a$f(x)$\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u8c08\u5224$a=0$\u7684\u60c5\u51b5\u3002\n\n\u8fd9\u79cd\u60c5\u51b5\u6bd4\u8f83\u7b80\u5355\uff0c\u6211\u5c31\u4e0d\u8bf4\u4e86\u3002\uff08\u9003\n\n\u82e5$a\\not=0$\uff0c\u5c06\u88ab\u79ef\u51fd\u6570\u8fdb\u884c\u4ee3\u6570\u53d8\u5f62\n$$\\begin{aligned}f(x)&=\\frac{cx+d}{ax+b}\\\\&=\\frac{c}{a}+\\frac{\\frac{ad-bc}{a}}{ax+b}\\end{aligned}$$\n\u5219\n$$\\int f(x)\\mathrm{d}x=\\int\\frac{c}{a}\\mathrm{d}x+\\frac{ad-bc}{a}\\int\\frac{\\mathrm{d}x}{ax+b}$$\n\u52a0\u53f7\u5de6\u8fb9\u90a3\u4e2a\u79ef\u5206\u662f\u5f88\u5bb9\u6613\u79ef\u51fa\u6765\u7684\uff0c\u800c\u67e5\u4e00\u4e0b\u79ef\u5206\u8868\uff0c\u6709\n$$\\int\\frac{\\mathrm{d}x}{ax+b}=\\frac{1}{a}\\ln|ax+b|+C$$\n\u6545\n$$\\int f(x)\\mathrm{d}x=\\frac{ad-bc}{a^2}\\ln|ax+b|+\\frac{cx}{a}+C$$\n\u4e8e\u662f\u5c31\u53ef\u4ee5\u79ef\u51fa\u9898\u76ee\u4e2d\u90a3\u4e2a\u5f0f\u5b50\u4e86\u3002\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<cmath>\n#include<cstdio>\ndouble a,b,c,d;\ndouble F(double x){\n    return (a*d-b*c)*log(fabs(a*x+b))/(a*a)+c*x/a;\n}\ndouble F2(double x){\n    return c*x*x/(2*b)+d*x/b;\n}\nint main(){\n    #ifdef LOCAL\n    freopen(\"in.txt\",\"r\",stdin);\n    freopen(\"out.txt\",\"w\",stdout);\n    #endif\n    double l,r;\n    scanf(\"%lf%lf%lf%lf%lf%lf\",&a,&b,&c,&d,&l,&r);\n    if(a!=0.0) printf(\"%.6f\\n\",F(r)-F(l));\n    else printf(\"%.6f\\n\",F2(r)-F2(l));\n    return 0;\n}\n```\n## \u81ea\u9002\u5e94\u8f9b\u666e\u68ee\n\u666e\u901a\u7684\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6211\u5c31\u4e0d\u591a\u8bf4\u4e86\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<cmath>\n#include<cstdio>\ndouble a,b,c,d;\ndouble f(double x){\n    return (c*x+d)/(a*x+b);\n}\n//\u533a\u95f4[a,b]\u4e0a\u7684\u8f9b\u666e\u68ee\u503c\ndouble simpson(double a,double b){\n    double c=a+(b-a)/2;\n    return (f(a)+4*f(c)+f(b))*(b-a)/6;\n}\n//\u533a\u95f4[a,b]\u4e0a\u7684\u79ef\u5206\uff0c\u7cbe\u5ea6\u9650\u5236\u4e3aeps\uff0c\u5df2\u77e5\u6574\u4e2a\u533a\u95f4\u7684\u8f9b\u666e\u68ee\u503cA\ndouble asr(double a,double b,double eps,double A){\n    double c=a+(b-a)/2;\n    double L=simpson(a,c),R=simpson(c,b);\n    if(fabs(L+R-A)<=15*eps) return L+R+(L+R-A)/15;\n    else return asr(a,c,eps/2,L)+asr(c,b,eps/2,R);\n}\nconst double eps=1e-7;\nint main(){\n    #ifdef LOCAL\n    freopen(\"in.txt\",\"r\",stdin);\n    freopen(\"out.txt\",\"w\",stdout);\n    #endif\n    double l,r;\n    scanf(\"%lf%lf%lf%lf%lf%lf\",&a,&b,&c,&d,&l,&r);\n    printf(\"%.6f\\n\",asr(l,r,eps,simpson(l,r)));\n    return 0;\n}\n```\n\u7136\u540e\u6211\u7ffb\u4e86\u4e00\u4e0b\u9898\u89e3\uff0c\u7adf\u7136\u6240\u6709\u5927\u4f6c\u90fd\u662f\u8fd9\u4e48\u5199\u7684\u3002\n\n\u4ed4\u7ec6\u770b\u4e00\u4e0b\u8fd9\u4efd\u4ee3\u7801\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u6709\u5f88\u591a\u51fd\u6570\u503c\u88ab\u91cd\u590d\u8ba1\u7b97\u4e86\u5f88\u591a\u6b21\u3002\u5728\u672c\u9898\u4e2d\uff0c\u8fd9\u662f\u4e0d\u8981\u7d27\u7684\u3002\u4f46\u5728\u4e00\u4e9b\u9898\u4e2d\uff0c\u51fd\u6570\u503c\u4e0d\u80fd\u7528\u5e38\u6570\u65f6\u95f4\u8ba1\u7b97\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u9700\u8981\u7ef4\u62a4\u7b97\u8fc7\u7684\u51fd\u6570\u503c\u3002\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<cmath>\n#include<cstdio>\ndouble a,b,c,d;\ndouble f(double x){\n    return (c*x+d)/(a*x+b);\n}\n//\u533a\u95f4[a,b]\u4e0a\u7684\u8f9b\u666e\u68ee\u503c\uff0c\u5df2\u77e5\u533a\u95f4\u957f\u5ea6l\u548c\u7aef\u70b9\u53ca\u4e2d\u70b9\u5904\u7684\u51fd\u6570\u503cA\uff0cB\uff0cC\ndouble simpson(double l,double A,double B,double C){\n    return (A+4*C+B)*l/6;\n}\ndouble asr(double a,double b,double eps,double A,double B,double C){\n    double l=b-a;\n    double c=a+l/2;\n    double D=f(a+l/4),E=f(a+3*l/4);\n    double L=simpson(l/2,A,C,D),R=simpson(l/2,C,B,E),AB=simpson(l,A,B,C);\n    if(fabs(L+R-AB)<=15*eps) return L+R+(L+R-AB)/15;\n    else return asr(a,c,eps/2,A,C,D)+asr(c,b,eps/2,C,B,E);\n}\nconst double eps=1e-7;\nint main(){\n    #ifdef LOCAL\n    freopen(\"in.txt\",\"r\",stdin);\n    freopen(\"out.txt\",\"w\",stdout);\n    #endif\n    double l,r;\n    scanf(\"%lf%lf%lf%lf%lf%lf\",&a,&b,&c,&d,&l,&r);\n    printf(\"%.6f\\n\",asr(l,r,eps,f(l),f(r),f(l+(r-l)/2)));\n    return 0;\n}\n```\n\u6211\u77e5\u9053\u8fd9\u79cd\u7801\u98ce\u5f88\u96be\u770b\uff0c\u4f46\u662f\u6211\u627e\u4e0d\u5230\u597d\u770b\u7684\u4e86\u2026\u2026\n\n------------\n\u5b8c\u7ed3\u6492\u82b1\uff01~~\u987a\u4fbf\u9a97\u8d5e~~",
        "postTime": 1563078843,
        "uid": 174045,
        "name": "FZzzz",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4525 \u3010\u3010\u6a21\u677f\u3011\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd51\u3011"
    },
    {
        "content": "#### \u5e7f\u544a\uff1a[\u6211\u7684\u535a\u5ba2](http://ebola.blogwo.com/2018/06/20/%E8%BE%9B%E6%99%AE%E6%A3%AE%E7%A7%AF%E5%88%86-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/)\n\n## \u5bfc\u5165\n\u4f17\u6240\u5468\u77e5\uff0c\u5bf9\u4e8e\u8ba1\u7b97\u673a\u800c\u8a00\uff0c\u7ed9\u5b9a\u5177\u4f53\u6570\u503c\u7684\u8ba1\u7b97\u662f\u975e\u5e38\u7b80\u5355\u7684\uff0c\u4f46\u8981\u8ba9\u8ba1\u7b97\u673a\u5b9e\u73b0\u516c\u5f0f\u63a8\u5bfc\uff0c\u90a3\u662f\u96be\u4e0a\u52a0\u96be\u3002\u53ef\u662f\uff0c\u5361\u897f\u6b27\u8ba1\u7b97\u5668\u5374\u6709\u79ef\u5206\u8fd9\u4e48\u4e00\u9879\u529f\u80fd\u3002\u4f60\u89c9\u5f97\u662f\u5b83\u5185\u90e8\u5b9e\u73b0\u4e86\u516c\u5f0f\u63a8\u5bfc\uff1f\u90a3\u4e3a\u4ec0\u4e48\u5b83\u4e0d\u8f93\u51fa\u5b83\u201c\u63a8\u5bfc\u201d\u51fa\u7684\u4e0d\u5b9a\u79ef\u5206\u516c\u5f0f\uff0c\u800c\u662f\u53ea\u652f\u6301\u5b9a\u79ef\u5206\u6c42\u503c\u5462\uff1f\u800c\u4e14\u4e3a\u4ec0\u4e48\u8f93\u51fa\u7684\u7b54\u6848\u4e0e\u4eba\u5de5\u5e26\u5165\u79ef\u5206\u516c\u5f0f\u7b97\u51fa\u7684\u7ed3\u679c\u76f8\u5dee\u65e0\u51e0\u5462\uff1f\u672c\u6587\u5c31\u6765\u63a2\u8ba8\u8fd9\u4e00\u95ee\u9898\u3002\n\n## \u77e5\u8bc6\u9884\u5907\n\n### 1.\u51fd\u6570\u7684\u62df\u5408\n\u5982\u679c\u7ed9\u5b9a\u4e86\u4e00\u4e2a\u5947\u602a\u7684\u51fd\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a\u56fe\u50cf\u4e0e\u5b83\u8fd1\u4f3c\u7684\u521d\u7b49\u51fd\u6570\u6765\u4ee3\u66ff\u5b83\uff0c\u8fd9\u6837\u7684\u8fc7\u7a0b\u79f0\u4e4b\u4e3a\u201c\u62df\u5408\u201d\n\n### 2.\u4e8c\u6b21\u51fd\u6570\u7684\u5b9a\u79ef\u5206\n\n\u5bf9\u4e8e\u4e00\u4e2a\u4e8c\u6b21\u51fd\u6570F(x)\uff0c\u5b83\u5728[l,r]\u533a\u95f4\u5185\u7684\u5b9a\u79ef\u5206\u503c\u4e3a(F(l)+4F(mid)+F(r))*(r-l)/6\n\n## \u6b63\u6587\u90e8\u5206\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u7ed9\u5b9a\u51fd\u6570\u5f53\u505a\u4e00\u4e2a\u4e8c\u6b21\u51fd\u6570\uff0c\u7136\u540e\u76f4\u63a5\u5957\u4e8c\u6b21\u51fd\u6570\u7684\u5b9a\u79ef\u5206\u516c\u5f0f\n\n\u8fd9\u6837\u7684\u7cbe\u5ea6\u8bef\u5dee\u662f\u975e\u5e38\u5927\u7684\uff0c\u4f1a\u7b97\u51fa\u4e00\u4e9b\u79bb\u8c31\u7684\u7b54\u6848\u3002\u90a3\u6211\u4eec\u8003\u8651\u5c06\u51fd\u6570\u5206\u6bb5\n\n\u51fd\u6570\u7684\u6bcf\u4e00\u6bb5\uff0c\u6211\u4eec\u90fd\u7528\u4e00\u4e2a\u4e8c\u6b21\u51fd\u6570\u53bb\u62df\u5408\u5b83\uff0c\u5f97\u51fa\u8fd9\u4e00\u6bb5\u7684\u8fd1\u4f3c\u503c\u3002\u5982\u679c\u6211\u4eec\u628a\u6574\u4e2a\u51fd\u6570\u5206\u6210\u975e\u5e38\u591a\u6bb5\uff0c\u90a3\u6211\u4eec\u5f97\u51fa\u7684\u503c\u4e5f\u5c31\u8fd1\u4f3c\u4e8e\u7b54\u6848\u4e86\n\n\u5206\u6210\u975e\u5e38\u591a\u6bb5\uff1f\u7a76\u7adf\u662f\u591a\u5c11\u6bb5\uff1f\n\n\u4e00\u4e2a\u663e\u7136\u7684\u4e8b\u60c5\u5c31\u662f\uff1a\u5982\u679c\u6211\u4eec\u5206\u7684\u6bb5\u592a\u5c11\uff0c\u7b54\u6848\u4f1a\u4e0d\u7cbe\u786e\uff1b\u5982\u679c\u6211\u4eec\u5206\u7684\u6bb5\u592a\u591a\uff0c\u7a0b\u5e8f\u7684\u8fd0\u884c\u65f6\u95f4\u4f1a\u8ba9\u4eba\u7edd\u671b\n\n\u4e8e\u662f\u6211\u4eec\u8ba9\u7a0b\u5e8f\u8fdb\u884c\u4e00\u4e2a\u201c\u81ea\u9002\u5e94\u201d\u64cd\u4f5c\u3002\u5373\uff0c\u5982\u679c\u8fd9\u4e00\u6bb5\u51fd\u6570\u4e0e\u62df\u5408\u51fa\u7684\u4e8c\u6b21\u51fd\u6570\u975e\u5e38\u76f8\u4f3c\uff0c\u90a3\u4e48\u6211\u4eec\u76f4\u63a5\u628a\u8fd9\u4e00\u6bb5\u5f53\u505a\u4e8c\u6b21\u51fd\u6570\uff0c\u5957\u516c\u5f0f\u7b97\u51fa\u7ed3\u679c\uff1b\u5982\u679c\u8fd9\u4e00\u6bb5\u4e0e\u62df\u5408\u51fa\u7684\u4e8c\u6b21\u51fd\u6570\u4e0d\u751a\u76f8\u4f3c\uff0c\u90a3\u4e48\u6211\u4eec\u628a\u8fd9\u4e00\u6bb5\u5206\u6210\u4e24\u534a\uff0c\u5e76\u9012\u5f52\u8fdb\u884c\u8fd9\u4e00\u8fc7\u7a0b\n\n\u5982\u4f55\u5224\u65ad\u8fd9\u4e00\u6bb5\u51fd\u6570\u4e0e\u62df\u5408\u51fa\u7684\u4e8c\u6b21\u51fd\u6570\u7684\u76f8\u4f3c\u7a0b\u5ea6\u5462\uff1f\n\n\u6211\u4eec\u53ef\u4ee5\u5bf9\u6574\u6bb5\u3001\u5de6\u534a\u90e8\u5206\u3001\u53f3\u534a\u90e8\u5206\u5206\u522b\u5957\u4e8c\u6b21\u51fd\u6570\u5b9a\u79ef\u5206\u516c\u5f0f\u8fdb\u884c\u8ba1\u7b97\uff0c\u7ed3\u679c\u5206\u522b\u8bb0\u4f5cA,\u3001L\u3001R\uff0c\u82e5L+R\u4e0eA\u76f8\u5dee\u7684\u503c\u4e0d\u8d85\u8fc7\u6211\u4eec\u8bbe\u5b9a\u7684\u7cbe\u5ea6\u4e86\uff0c\u90a3\u5c31\u8ba4\u4e3a\u8fd9\u4e00\u6bb5\u51fd\u6570\u4e0e\u62df\u5408\u51fa\u7684\u4e8c\u6b21\u51fd\u6570\u975e\u5e38\u76f8\u4f3c\n\n\u8fd9\u6837\u8ba1\u7b97\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u53d6\u51b3\u4e8e\u7a0b\u5e8f\u7684\u8fed\u4ee3\u6b21\u6570\uff0c\u4e5f\u5c31\u662f\u7ed9\u5b9a\u51fd\u6570\u4e0e\u4e8c\u6b21\u51fd\u6570\u7684\u76f8\u4f3c\u7a0b\u5ea6\u3002\u5f53\u7136\uff0c\u4e5f\u53d6\u51b3\u4e8e\u4f60\u8bbe\u5b9a\u7684\u7cbe\u5ea6\uff0c\u7cbe\u5ea6\u8d8a\u4f4e\u8d8a\u5feb\uff0c\u4f46\u7b54\u6848\u8bef\u5dee\u4e5f\u8d8a\u5927\uff0c\u5177\u4f53\u7684\u7cbe\u5ea6\u9009\u62e9\u8981\u770b\u9898\u76ee\u7684\u8981\u6c42\n\n## \u6a21\u677f\n```cpp\nconst double eps=\u7cbe\u5ea6\u8981\u6c42;\ndouble F(double x){\u9700\u8981\u79ef\u5206\u7684\u51fd\u6570}\ndouble simpson(double l,double r)\n{\n\tdouble mid=(l+r)/2;\n\treturn (F(l)+4*F(mid)+F(r))*(r-l)/6;\n}\ndouble asr(double l,double r,double A)\n{\n\tdouble mid=(l+r)/2;\n\tdouble L=simpson(l,mid),R=simpson(mid,r);\n\tif(fabs(L+R-A)<=15*eps) return L+R+(L+R-A)/15.0;\n\treturn asr(l,mid,L)+asr(mid,r,R);\n}\ndouble asr(double l,double r){return asr(l,r,simpson(l,r));}\n```\n\n## \u672c\u9898\u9898\u89e3\n\n\u76f4\u63a5\u5f80\u4e0a\u9762\u6a21\u677f\u7684F\u51fd\u6570\u4e2d\u8f93\u5165\u672c\u9898\u7ed9\u5b9a\u51fd\u6570\uff0c\u7136\u540e\u8c03\u7528\u4e00\u6b21asr(l,r)\u5373\u53ef",
        "postTime": 1529485716,
        "uid": 20158,
        "name": "Ebola",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4525 \u3010\u3010\u6a21\u677f\u3011\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd51\u3011"
    },
    {
        "content": "## Romberg\u79ef\u5206\u6cd5\u7b80\u4ecb\n\u4f17\u6240\u5468\u77e5, \u5bf9\u4e8e\u5728\u533a\u95f4 $[L, R]$ \u8fde\u7eed\u7684\u51fd\u6570 $f(x)$ \u6709\u5982\u4e0b\u7684\u79ef\u5206\u903c\u8fd1\u516c\u5f0f:\n\n* $$\\int^R_Lf(x)\\mathrm dx\\approx \\frac{R-L}2(f(R)+f(L))\\qquad\\qquad\\quad\\quad\\qquad(1)$$\n* $$\\int^R_Lf(x)\\mathrm dx\\approx \\frac{R-L}6(f(R)+4f(\\frac{R+L}2)+f(L))\\qquad(2)$$\n\n\u5176\u4e2d $(1)$ \u5f0f\u79f0\u4f5c**\u68af\u5f62\u516c\u5f0f**, $(2)$ \u5f0f\u79f0\u4f5c **Simpson \u516c\u5f0f**.\n\n\u4e0b\u9762\u662f Romberg \u79ef\u5206\u6cd5\u7684\u7b80\u4ecb:\n\n```Romberg \u79ef\u5206\u6cd5\u4e5f\u79f0\u4e3a\u9010\u6b21\u5206\u534a\u52a0\u901f\u6cd5. \u5b83\u662f\u5728\u68af\u5f62\u516c\u5f0f, Simpson \u516c\u5f0f\u4e4b\u95f4\u7684\u5173\u7cfb\u7684\u57fa\u7840\u4e0a, \u6784\u9020\u51fa\u4e00\u79cd\u52a0\u901f\u8ba1\u7b97\u79ef\u5206\u7684\u65b9\u6cd5.\n\u4f5c\u4e3a\u4e00\u79cd\u5916\u63a8\u7b97\u6cd5, \u5b83\u5728\u4e0d\u589e\u52a0\u8ba1\u7b97\u91cf\u7684\u524d\u63d0\u4e0b\u63d0\u9ad8\u4e86\u8bef\u5dee\u7684\u7cbe\u5ea6.\n\u5728\u7b49\u8ddd\u57fa\u70b9\u7684\u60c5\u51b5\u4e0b, \u7528\u8ba1\u7b97\u673a\u8ba1\u7b97\u79ef\u5206\u503c\u901a\u5e38\u90fd\u91c7\u7528\u628a\u533a\u95f4\u9010\u6b21\u5206\u534a\u7684\u65b9\u6cd5\u8fdb\u884c.\n\u8fd9\u6837, \u524d\u4e00\u6b21\u5206\u5272\u5f97\u5230\u7684\u51fd\u6570\u503c\u5728\u5206\u534a\u4ee5\u540e\u4ecd\u53ef\u88ab\u5229\u7528, \u4e14\u6613\u4e8e\u7f16\u7a0b.\n```\n\n\u7b80\u5355\u5730\u8bf4, \u5c31\u662f\u4e8c\u5206\u533a\u95f4, \u63d0\u9ad8\u7cbe\u5ea6.\n\n\u4e0b\u9762\u6765\u8be6\u7ec6\u5730\u89e3\u91ca Romberg \u79ef\u5206\u6cd5\u7684\u8fc7\u7a0b.\n\n\u7ea6\u5b9a:\n\n* $I$ \u79f0\u4e3a\u7cbe\u786e\u503c.\n* $T_n(h)$ \u79f0\u6b65\u957f\u4e3a $h$ \u7684 $n$ \u9636\u903c\u8fd1\u7b97\u6cd5 ( \u610f\u5473\u7740\u5177\u6709 $O(h^n)$ \u7684\u622a\u65ad\u8bef\u5dee, \u5373 $I-T_n(h)=O(h^n)$ ).\n\n\u90a3\u4e48\u6709 ( Richardson \u5916\u63a8\u6cd5 ):\n\n$$\nT_{m+1}(h)=\\frac{r^{m+1}T_m(\\frac h2)-T_m(h)}{r^{m+1}-1}\\Rightarrow I-T_{m+1}=O(h^{n+1})\n$$\n\n\u5373\u7531 $T_m$ \u5916\u63a8\u51fa\u7684 $T_{m+1}$ \u5177\u6709\u66f4\u9ad8\u4e00\u9636\u7cbe\u5ea6, \u4f46\u8ba1\u7b97\u65f6\u95f4\u590d\u6742\u5ea6\u4e0d\u53d8(\u90fd\u662f $O(T_m(h))$ ).\n\n\n\u56de\u5230\u539f\u95ee\u9898, \u53d6\n\n$$\nI=\\int^R_Lf(x)\\mathrm dx\n$$\n\n\u6839\u636e\u68af\u5f62\u516c\u5f0f, \u6211\u4eec\u6709:\n\n$$\nT_0=\\frac{R-L}2(f(R)+f(L))\n$$\n\n\u53d6 $r=4$ \u5c06\u5176\u5916\u63a8, \u6709\n\n$$\nT_1=\\frac{4T_0(\\frac h2)-T_0(h)}{4-1}\n$$\n\n$$\nT_2=\\frac{4^2T_1(\\frac h2)-T_1(h)}{4^2-1}\n$$\n\n\u6211\u4eec\u53d1\u73b0, \u5bf9\u4e8e\u4e00\u4e9b\u9879, \u6211\u4eec\u8fdb\u884c\u4e86\u91cd\u590d\u7684\u8ba1\u7b97, \u8003\u8651\u5c06\u8ba1\u7b97\u7ed3\u679c\u6253\u6210\u4e00\u5f20\u8868.\n\n\u8bb0$h_0=h=R-L,h_1=\\frac h2,\\dots,h_i=2^{-i}h$,\n$R_{i,j}=T_j(h_i)$\n\n\u90a3\u4e48\n\n$$R_{0,0}=T_0(h_0)$$\n\n$$R_{j,0}=\\frac {R_{j-1,0}}2+h_j\\sum_{i=1}^{2^{j-2}}f(L+(2i-1)h_j)$$\n\n$$R_{j,k}=\\frac{4^{k-1}R_{j,k-1}-R_{j-1,k-1}}{4^{k-1}-1}$$\n\n\u5176\u4e2d $1\\leq k \\leq j \\leq n$\n\n\u53d6 $n=10$ \u5373\u53ef\u901a\u8fc7\u672c\u9898.\n```cpp\n#include<cmath>\n#include<cstdio>\ndouble a,b,c,d,L,R;\ndouble f(double x)\n{\n\treturn (c*x+d)/(a*x+b);\n}\ndouble Romberg(double g(double), double x1, double x2, int n)\n{\n\tdouble R[n + 1][n + 1];\n\tdouble h[n + 1] = {0};\n\tR[1][1] = (x2 - x1) * (g(x1) + g(x2)) / 2.0;\n\tfor(int j = 2; j <= n; ++j)\n\t{\n\t\th[j] = (x2 - x1) / pow(2.0, j - 1);\n\t\tdouble sum = 0;\n\t\tfor(int i = 1; i <= int(pow(2, j - 2)); ++i)\n\t\t\tsum += g(x1 + (2.0 * i - 1.0) * h[j]);\n\t\tR[j][1] = R[j - 1][1] / 2.0 + h[j] * sum;\n\t\tfor(int k = 2; k <= j; ++k)\n\t\t\tR[j][k] = (pow(4.0, k - 1) * R[j][k - 1] - R[j - 1][k - 1]) / (pow(4.0, k - 1) - 1.0);\n\t}\n\treturn R[n][n];\n}\nint main()\n{\n\tscanf(\"%lf%lf%lf%lf%lf%lf\",&a,&b,&c,&d,&L,&R);\n\tdouble d = Romberg(f,L,R,10);\n\tprintf(\"%.6lf\",d);\n\treturn 0;\n}\n```\n\n#### \u9644 Richardson \u5916\u63a8\u6cd5\u6b63\u786e\u6027\u7684\u8bc1\u660e\n\u91c7\u7528\u4e0a\u6587\u7ea6\u5b9a, \u53d6 $O(h)$ \u7684Taylor\u5c55\u5f00, \u6211\u4eec\u6709:\n$$\nI-T_1(h)=O(h)=C_1h+C_2h^2+C_3h^3+\\cdots\n$$\n$$\nI-T_1(\\frac h2)=O(\\frac h2)=C_1(\\frac h2)+C_2(\\frac h2)^2+C_3(\\frac h2)^3+\\cdots\n$$\n\u53e6\u5916\n$$\nT_2(h)=\\frac{rT_1(\\frac h2)-T_1(h)}{r-1}\n$$\n\u90a3\u4e48\n$$\nI-T_2(h)=-\\frac 1rC_2h^2-\\frac{r^2-1}{r^2}C_3h^3-\\cdots=O(h^2)\n$$\n\u53cd\u590d\u8fd0\u7528 $m$ \u6b21\u5373\u8bc1.\n#### \u53c2\u8003\u6587\u732e\n[1] Timothy Sauer.\u300a\u6570\u503c\u5206\u6790\u300b[M]. \u7b2c\u4e8c\u7248. \u5317\u4eac: \u673a\u68b0\u5de5\u4e1a\u51fa\u7248\u793e, 2012",
        "postTime": 1578110587,
        "uid": 165639,
        "name": "__init__",
        "ccfLevel": 0,
        "title": "P4525 \u3010\u6a21\u677f\u3011\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd51 \u9898\u89e3"
    },
    {
        "content": "## \u8868\u793a\u7528\u516c\u5f0f\u7b97\u8fd8\u4e0d\u5982\u76f4\u63a5\u63a8\u5bfc\u7b80\u4fbf\n\n>\u770b\u5230\u8bb8\u591a\u9898\u89e3\u7684\u63a8\u5bfc\u8fc7\u7a0b\u4e0d\u662f\u5f88\u8be6\u7ec6\uff0c\u6240\u4ee5\u849f\u84bb\u6839\u636e\u81ea\u5df1\u7684\u6f14\u7b97\u8fc7\u7a0b\u5199\u4e86\u4e00\u7bc7\u9898\u89e3\n\n\u9996\u5148\u6211\u4eec\u770b\u5230 $\\displaystyle{\\int_L^R\\dfrac{cx+d}{ax+b}dx}$\n\n\u5c31\u4f1a\u6709\u4e00\u79cd\u51b2\u52a8\uff1a\n\n- **\u8bbe $u=ax+b$\uff0c\u6b64\u65f6 $u^\\prime=a$**\n\n\u539f\u5f0f\u5c31\u7b49\u4e8e $\\displaystyle{\\dfrac{1}{a}\\int_L^R\\dfrac{cx+d}{u}du}$\n\n**\u4ee5\u4e0b\u5747\u4e0d\u518d\u5199\u79ef\u5206\u4e0a\u4e0b\u9650\uff01\uff01\uff01**\n\n**\u56e0\u4e3a\u6b64\u65f6\u7684\u79ef\u5206\u53d8\u91cf\u53d8\u6210\u4e86 $u$\uff0c\u6240\u4ee5\u6211\u4eec\u5c3d\u91cf\u7528\u542b $u$ \u7684\u5f0f\u5b50\u6765\u8868\u793a $cx+d$**\n\n\u5f0f\u5b50\u5c31\u53d8\u6210\u4e86\n\n$\\displaystyle{\\dfrac{1}{a}\\int\\dfrac{\\frac{c(u-b)}{a}+d}{u}du}$\n\n$\\displaystyle{\\dfrac{1}{a}\\int\\dfrac{c(u-b)+ad}{au}du}$\n\n\u5316\u7b80\u4ebf\u4e0b\u5c31\u662f\n\n$\\displaystyle{\\dfrac{1}{a}\\left(\\dfrac{c}{a}\\int du-\\dfrac{bc}{a}\\int\\dfrac{1}{u}du+d\\int\\dfrac{1}{u}du\\right)}$\n\n$=\\dfrac{1}{a}\\left(\\dfrac{c(ax+b)}{a}-(\\dfrac{bc}{a}-d)\\ln|ax+b|\\right)$\n\n\n\u597d\u4e86\u6211\u4eec\u53bb\u6109\u5feb\u7684\u5207\u6389\u8fd9\u9053\u6c34\u9898\n\n\u4e14\u6162\uff0c\u6211\u4eec\u5728\u5c0f\u5b66\u7684\u65f6\u5019\u5c31\u77e5\u9053**\u5206\u6bcd\u662f\u4e0d\u80fd\u4e3a $0$ \u7684**\uff0c\u6240\u4ee5\u8fd9\u91cc\u6211\u4eec\u8981\u8fdb\u884c\u7279\u5224\n\n\u5982\u679c $a=0$\n\n\u539f\u5f0f = $\\displaystyle{\\int_L^R\\dfrac{cx+d}{b}dx}$\n\n\u5f88\u7b80\u5355\u554a\uff0c\u90fd\u4e0d\u7528\u505a\u4ee3\u6362\u4e86\uff0c\u76f4\u63a5\u7b97\u5c31\u53ef\u4ee5\n\n$=\\displaystyle{\\int\\dfrac{cx}{b}dx+\\int\\dfrac{d}{b}dx}$\n\n$=\\dfrac{cx^2}{2b}+\\dfrac{dx}{b}$\n\n$=\\dfrac{x}{b}\\left(\\dfrac{cx}{2}+d\\right)$\n\n\u81f3\u6b64\uff0c\u672c\u9898\u7ed3\u675f\n\n\u4ee3\u7801\u5b9e\u73b0\uff1a\n```\n#include<iostream>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\ndouble a,b,c,d,L,R;\ninline double integral(double x) {return 1/a*(c*(a*x+b)/a-(b*c/a-d)*log(abs(a*x+b)));}\ninline double whenZero(double x) {return x/b*(c*x/2+d);}\nsigned main(){\n\tcin>>a>>b>>c>>d>>L>>R;\n\tif(!a) printf(\"%.6lf\",whenZero(R)-whenZero(L));\n\telse printf(\"%.6lf\",integral(R)-integral(L));\n}\n```",
        "postTime": 1602056792,
        "uid": 215573,
        "name": "zythonc",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4525 \u3010\u3010\u6a21\u677f\u3011\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd51\u3011"
    },
    {
        "content": "\u6d1b\u8c37\u7684\u6a21\u677f\u771f\u7684\u662f\u8d8a\u6765\u8d8a\u5168\u3001\u8d8a\u6765\u8d8a\u7ec6\u4e86\u3002\n\n\u81ea\u9002\u5e94Simpson\u662f\u4e00\u79cd\u5e38\u7528\u4e8e\u8ba1\u7b97\u51e0\u4f55\u6c42\u9762\u79ef\u7684\u7b97\u6cd5\u3002\n\n\u5148\u770bSimpson\u516c\u5f0f\uff1a\n\n$$\\int ^b_a f(x)dx\\approx(b-a)\\frac{f(a)+4f(\\frac{a+b}{2})+f(b)}{6}$$\n\n\u4ee3\u7801\uff1a\n```\ndouble simpson(double a, double b)\n{\n\tdouble c = a + (b - a) / 2.0;\n    return (b - a) * (F(a) + 4.0 * F(c) + F(b)) / 6.0;\n}\n```\n\n\u8fd9\u73a9\u610f\u51c6\u5417\uff1f\u5f53\u7136\u4e0d\u51c6\u3002\u6240\u4ee5\u624d\u8981\u81ea\u9002\u5e94\u4e00\u4e0b\uff0c\u4e5f\u5c31\u662f\u5206\u522b\u8ba1\u7b97\u4e24\u8fb9\u7684\u7ed3\u679c\uff0c\u518d\u548c\u4f60\u4e4b\u524d\u7b97\u7684\u6574\u4e2a\u7684\u7ed3\u679c\u6bd4\u8f83\u4e00\u4e0b\u3002\u5982\u679c\u6bd4\u8f83\u51c6\u786e\uff0c\u5c31\u53ef\u4ee5\u8fd4\u56de\uff0c\u5426\u5219\u9012\u5f52\u4e0b\u53bb\uff1a\n\n```\ndouble asr(double a, double b, double ans)\n{\n\tdouble c = a + (b - a) / 2.0;\n    double left = simpson(a, c), right = simpson(c, b);\n    if(fabs(left + right - ans) < EPS)\n    \treturn left + right;\n    else\n    \treturn asr(a, c, left) + asr(c, b, right);\n}\n```\n\n\u662f\u4e0d\u662f\u5f88**Simple**\u554a\uff1f\n\n\u51e0\u9053\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u7684\u9898\uff1a\n\n[HDU1724 Ellipse](http://acm.hdu.edu.cn/showproblem.php?pid=1724)\n\n[P4207 NOI2005 \u6708\u4e0b\u67e0\u6aac\u6811](https://www.luogu.org/problem/show?pid=4207)\uff0c\u8fd9\u9053\u7ec6\u8282\u6bd4\u8f83\u591a\n\n[BZOJ2178 \u5706\u5f62\u9762\u79ef\u5e76](https://www.luogu.org/discuss/show/41820)\n\n\u4ee5\u53ca\u4e00\u4e9b\u9762\u79ef\u5e76\uff0c\u90fd\u53ef\u4ee5\u7528\u81ea\u9002\u5e94Simpson\u9a97\u5206\u751a\u81f3AC\uff0c\u8fd9\u4e2a\u8981\u770b\u8138\u3002\n\n```\n#include<cstdio>\n#include<cmath>\n#define EPS 1e-12\n//\u8bbe\u4e2a\u5dee\u4e0d\u591a\u7684EPS\uff0c\u6d17\u628a\u8138\u5c31\u6c34\u8fc7\u4e86\n\ndouble a,b,c,d;\n\ndouble F(double x)\n{\n\treturn (c*x+d)/(a*x+b);\n}\n\ndouble simpson(double l,double r)\n{\n\tdouble mid=(l+r)/2.0;\n\treturn (r-l)*(F(l)+4.0*F(mid)+F(r))/6.0;\n}\n\ndouble ASR(double l,double r,double ans)\n{\n\tdouble mid=(l+r)/2.0;\n\tdouble left=simpson(l,mid);\n\tdouble right=simpson(mid,r);\n\tif(fabs(left+right-ans)<EPS)\n\t{\n\t\treturn left+right;\n\t}\n\telse\n\t{\n\t\treturn ASR(l,mid,left)+ASR(mid,r,right);\n\t}\n}\n\nint main()\n{\n\tdouble L,R;\n\tscanf(\"%lf %lf %lf %lf %lf %lf\",&a,&b,&c,&d,&L,&R);\n\tprintf(\"%.6lf\",ASR(L,R,simpson(L,R)));\n}\n```",
        "postTime": 1525593419,
        "uid": 53374,
        "name": "SuperJvRuo",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4525 \u3010\u3010\u6a21\u677f\u3011\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd51\u3011"
    },
    {
        "content": "### [\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4525)\n\n------------\n**\u524d\u8a00:**\n\n\u672c\u4eba\u521d\u5b66$Simpson$\u516c\u5f0f\uff0c\u7136\u540e\u505a\u8fd9\u9053\u9898\uff0c\u6069\uff0c\u521a\u5b66\u7684\u4e5f\u6ca1\u7528\u4e0a\u3002\n\n\u770b\u5230\u9898\u76ee\u4e2d\u7684\u5f0f\u5b50\uff0c\u597d\uff0c\u4ee3\u6570\u53d8\u5f62\u3002\n\n\u7ed3\u675f\u3002~~\uff08\u6c34\u8fc7\u4e86\u4e00\u9053\uff09~~\n\n------------\n**\u4e3b\u8981\u601d\u8def\uff1a**\n\n\u65e2\u7136\u662f\u4e3b\u8981\uff0c\u90a3a=0\u65f6\u7279\u5224\u7684\u7b80\u5355\u60c5\u51b5\u5c31\u4e0d\u7528\u8bb2\u4e86\u3002\n\n\u4e0b\u9762\u8fdb\u884c\u9898\u76ee\u4e2d\u5f0f\u5b50\u7684\u4ee3\u6570\u53d8\u5f62\uff1a\n\n$\\int_{L}^{R} f(x)\\, dx,$\u5176\u4e2d$f(x)=\\frac{cx+d}{ax+b}$\n\n\u5bf9$f(x)$\u8fdb\u884c\u5206\u79bb\u5e38\u6570\uff0c\u5f97\uff1a$f(x)=\\frac{c}{a}+\\frac{\\frac{ad-bc}{a}}{ax+b}$\n\n\u5c06\u4e0a\u5f0f\u5e26\u5165\u539f\u5f0f\u5f97\uff1a$\\int_{L}^{R} f(x)\\, dx=\\int \\frac{c}{a} dx+\\frac{ad-bc}{a}\\int \\frac{dx}{ax+b}$\n\n\u67e5\u79ef\u5206\u8868\uff0c\u5f97$\\int \\frac{dx}{ax+b}=\\frac{1}{a}ln|ax+b|+C$\n\n\u6545\u6709$\\int f(x)dx=\\frac{ad-bc}{a^2}ln|ax+b|+\\frac{cx}{a}+C$\n\n\u601d\u8def\uff0c\u5b8c\u3002\n\n------------\n**\u4ee3\u7801\u5c55\u793a:**\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ndouble a,b,c,d,l,r;\ndouble suan(double x){//a!=0\u65f6\n    return (a*d-b*c)*log(fabs(a*x+b))/(a*a)+c*x/a;\n}\ndouble special_suan(double x){//a=0\u65f6\u7279\u5224\n    return c*x*x/(b*2)+d*x/b;\n}\nint main(){\n    scanf(\"%lf%lf%lf%lf%lf%lf\",&a,&b,&c,&d,&l,&r);\n    if(a==0){\n        printf(\"%lf\\n\",special_suan(r)-special_suan(l));\n    }\n    else{\n        printf(\"%lf\\n\",suan(r)-suan(l));\n    }\n    return 0;\n}\n/*\na=0: f(x)=(cx+d)/b,\u222b f(x)dx=\u222b c*(x^2)/(b*2)+d*x/b\na!=0: f(x)=(cx+d)/(ax+b),\u222b f(x)dx=\u222b(ad-bc)/(a^2)*ln(fabs(ax+b))+cx/a+C\n*/\n```\n>$Thanks$ $For$ $Watching!$",
        "postTime": 1596264355,
        "uid": 115291,
        "name": "\u8fc7\u5f80\u68a6\u9b47\u4e4b\u6b87",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4525 \u3010\u3010\u6a21\u677f\u3011\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd51\u3011"
    },
    {
        "content": "## \u8f9b\u666e\u68ee\u79ef\u5206\n\u6c42\u5b9a\u79ef\u5206 \n$$\\int_a^b f(x)dx\\ (a<b)$$\n\u5c06\u95ed\u533a\u95f4\u7b49\u5206\u6210 $2n$  \u4e2a\u5c0f\u533a\u95f4 \n\n$[x_i,x_{i+1}](x_i<x_{i+1},x_0=a,x_{2n}=b,i\\in \\left\\{m\\in \\mathbf N|m<2n\\right\\}$\u3002\n\n\u5728\u6bcf\u4e2a\u5c0f\u533a\u95f4\u4e0a\uff0c\u7528\u629b\u7269\u7ebf\u8fd1\u4f3c\u51fd\u6570 $f(x)$ \u7684\u66f2\u7ebf\u3002\n\n\u8bbe $y_i=f(x_i)$\uff0c\u53ef\u5f97\u5230\u8fd1\u4f3c\u503c \n\n$$\\int_a^b f(x)dx\u2248\\dfrac{b-a}{6n} \\left (y_0+y_{2n}+4(y_1+y_3+\\cdots +y_{2n-1})+2(y_2+y_4+\\cdots +y_{2n-2}) \\right ).$$\n\n## \u8f9b\u666e\u68ee\u516c\u5f0f\n\n\u8f9b\u666e\u68ee\u79ef\u5206\u6cd5\u53ef\u4ee5\u770b\u4f5c\u68af\u5f62\u6cd5\u5219\u505a Richardson \u5916\u63a8\u52a0\u901f\u7684\u7ed3\u679c\u3002\n\u5bf9\u4e8e\u79ef\u5206 \n\n$$I=\\int_a^bf(x)dx,$$\n\n\u5982\u679c\u4ec5\u7528\u5076\u6570\u53f7\u7684\u6570\u636e\u70b9\u505a\u68af\u5f62\u6cd5\u79ef\u5206\uff0c\u5f97\u5230\u7ed3\u679c \n\n$$I_1=\\dfrac{b-a}{n}\\left(\\dfrac{y_0}{2}+y_2+y_4+\\cdots +y_{2n-2}+\\dfrac{y_{2n}}{2}\\right).$$\n\n\u800c\u5982\u679c\u7528\u5168\u90e8\u7684\u6570\u636e\u70b9\u505a\u68af\u5f62\u6cd5\u79ef\u5206\uff0c\u5219\u5f97\u5230\n\n$$I_2=\\dfrac{b-a}{2n}\\left(\\sum_{i=0}^{2n}y_i-\\dfrac{y_0}{2}-\\dfrac{y_{2n}}{2}\\right).$$\n\n\u7531\u4e8e\u68af\u5f62\u6cd5\u79ef\u5206\u7684\u8bef\u5dee\u662f $O(\\dfrac{1}{n^2})$\uff0c\u800c $I_2$ \u7684\u6570\u636e\u70b9\u6bd4 $I_1$ \u591a\u4e00\u500d\uff0c\u6545\u5176\u9886\u5934\u9636\u8bef\u5dee\u4e3a\u540e\u8005\u7684 $\\dfrac{1}4$\u3002\u4e8e\u662f\u5217\u51fa\u5916\u63a8\u65b9\u7a0b $I-I_1\u22484(I-I_2)$\u3002\u7ecf\u8ba1\u7b97\uff1a\n\n$$I\u2248\\dfrac{4I_2-I_1}{3}=\\dfrac{b-a}{6n}\\left(y_0+4y_1+2y_2+\\cdots +4y_{2n-1}+y_{2n}\\right).$$\n\n\u53ef\u89c1\u68af\u5f62\u6cd5\u5916\u63a8\u7684\u7ed3\u679c\u6070\u597d\u4e3a\u8f9b\u666e\u68ee\u516c\u5f0f\u3002\n\n\u4ee5 $f(x) = \\sin(x)$ \u4e3a\u4f8b\u5b50\uff1a\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstdlib>\nusing namespace std;\ndouble fun(double x)\n{\n    return sin(x);//\u8fd9\u91cc\u53ef\u4ee5\u6dfb\u52a0\u5176\u4ed6\u51fd\u6570\n}\ndouble Simpson(double (*f)(double),double a,double b,int n)//Simpson \u6c42\u79ef\u5206\u6cd5\n{\n    const double h = (b-a)/n;\n    double S = f(a) - f(b);\n    for(int i = 1;i < n;i += 2) S += 4*f(a+i*h);\n    for(int i = 1;i < n;i += 2) S += 2*f(a+i*h);\n    return S*h/3.0;\n}\nint main() {\n    double a,b;\n    int n;//\u8981\u5212\u5206\u7684\u4efd\u6570\n    cin >> a >> b;//\u79ef\u5206\u4e0a\u4e0b\u9650\n    cin >> n;//\u4ee5\u4e8c\u6b21\u66f2\u7ebf\u903c\u8fd1\u7684\u65b9\u5f0f\u53d6\u4ee3\u77e9\u5f62\u6216\u68af\u5f62\u7684\u79ef\u5206\u516c\u5f0f\uff0c\u6240\u4ee5\u5212\u5206\u8d8a\u591a\u8d8a\u8d8b\u4e8e\u7cbe\u786e\u503c\u3002\n    cout << Simpson(fun,a,b,n) << endl;\n    return 0;\n}\n```\n## \u5927\u4f53\u601d\u8def\n\u5bf9\u4e8e\u672c\u9898\u6765\u8bf4\uff1a\u8bbe $f(x)$ \u4e3a\u539f\u51fd\u6570\uff0c$g(x)=Ax^2+Bx+C $ \u4e3a\u62df\u5408\u540e\u7684\u51fd\u6570\uff0c\u5219\u6709:\n$$\\int_a^b f(x)dx\u2248\\int_a^b Ax^2+Bx+C$$\n$$=\\frac{A}{3}(b^3-a^3)+\\frac{B}{2}(b^2-a^2)+C(a-b)$$\n$$=\\frac{(b-a)}{6}\\left(f(a)+f(b)+4f(a+b^2)\\right)$$\n## \u5b8c\u6574\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define db double\ndb a,b,c,d;\ninline db f(db x){\n    return (c*x+d)/(a*x+b);//\u8ba1\u7b97\n}\ninline db simpson(db l,db r){\n    return (f(l)+4.*f((l+r)/2.)+f(r))*(r-l)/6.;//\u8f9b\u666e\u68ee\u79ef\u5206\n}\ninline db asr(db l,db r,db ans,db eps){\n    db mid=(l+r)/2;\n    db L=simpson(l,mid);\n    db R=simpson(mid,r);\n    if(fabs(L+R-ans)<=14*eps) return L+R+(L+R-ans)/14;\n    return asr(l,mid,L,eps/2)+asr(mid,r,R,eps/2);\n}//\u4e8c\u5206\u7b54\u6848\nint main(){\n    db L,R;\n    scanf(\"%lf%lf%lf%lf%lf%lf\",&a,&b,&c,&d,&L,&R);//\u8f93\u5165\n    printf(\"%.6lf\",asr(L,R,simpson(L,R),1e-6));//\u8c03\u7528\u51fd\u6570\u8f93\u51fa\n    return 0;\n}\n\n```",
        "postTime": 1599561990,
        "uid": 279197,
        "name": "Mars_Dingdang",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4525 \u3010\u3010\u6a21\u677f\u3011\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd51\u3011"
    },
    {
        "content": "\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd5\u7684\u6a21\u677f\u3002\n\n\u79ef\u5206\u7684\u6734\u7d20\u6c42\u6cd5\u5c31\u662f\u7528\u5f88\u591a\u4e2a\u5c0f\u77e9\u5f62\u6765\u8fd1\u4f3c\uff0c\u4f46\u8fd9\u6837\u7cbe\u5ea6\u548c\u65f6\u95f4\u90fd\u4e0d\u9ad8\uff0c\u8003\u8651\u7528\u5176\u5b83\u7684\u65b9\u6cd5\u3002\n\n\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u53d1\u5c31\u662f\u7528\u4e8c\u6b21\u51fd\u6570\u6765\u8fd1\u4f3c\u7684\u79ef\u5206\u3002\n\n\u5047\u8bbe\u7528\u6765\u8fd1\u4f3c\u7684\u4e8c\u6b21\u51fd\u6570\u4e3a$g(x)=ax^2+bx+c$\u3002\n\n\u90a3\u4e48\u51fd\u6570$f(x)=x^n$\u7684\u539f\u51fd\u6570\u5373\u4e3a\uff1a$F(x)={1\\over n+1}x^{n+1}$\uff0c\u8bc1\u660e\u5982\u4e0b\uff1a\n\n\u7531\u5b9a\u4e49\u5f97\uff0c\u53ea\u9700\u8bc1\u660e\u5982\u4e0b\u5f0f\u5b50\uff1a\n\n$$F'(x)=f(x)=x^n$$\n\n\u56e0\u4e3a\u6709\u516c\u5f0f\uff1a\n\n$$f(x)=x^n,f'(x)=nx^{n-1}$$\n\n\u6240\u4ee5:\n\n$$F'(x)=[{1\\over n+1}\\cdot (n+1)]x^{n+1-1}=x^n$$\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$f_1(x)=x^2\\rightarrow F_1(x)={1\\over 3}x^3$$\n\n$$f_2(x)=x\\rightarrow F_2(x)={1\\over 2}x^2$$\n\n$$f_3(x)=c\\rightarrow F_3(x)=x$$\n\n$$g(x)=af_1(x)+bf_2(x)+cf_3(x)$$\n\n\u6240\u4ee5\uff0c\u7531\u725b\u987f-\u83b1\u5e03\u5c3c\u8328\u516c\u5f0f\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$\\int_l^r g(x)dx=\\int_l^r [af_1(x)+bf_2(x)+cf_3(x)]dx$$\n\n$$=a\\int_l^rf_1(x)dx+b\\int_l^rf_2(x)dx+c\\int_l^rf_3(x)dx$$\n\n$$=a\\cdot F_1(r)|_l^r+b\\cdot F_2(r)|_l^r+c\\cdot F_3(r)|_l^r$$\n\n$$={a(r^3-l^3)\\over 3}+{b(r^2-l^2)\\over 2}+{c(r-l)}$$\n\n\u80e1\u4e71\u5316\u7b80\uff0c\u6700\u540e\u5f97\u5230\uff1a\n\n$$(r-l)[al^2+bl+c+ar^2+bl+c+4({al^2+2alr+ar^2\\over 4}+{bl+br\\over 2}+c)]\\over 6$$\n\n$$={(r-l)g(r)+g(l)+4g({l+r\\over 2}) \\over 6}$$\n\n$$\\approx {(r-l)f(r)+f(l)+4f({l+r\\over 2}) \\over 6}$$\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u5f97\u5230\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd5\u7684\u516c\u5f0f\u5566\uff01\n\n\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u76f4\u63a5\u5957\u516c\u5f0f\u5373\u53ef\u3002\n\n\u4f46\u662f\u8fd9\u6837\u7cbe\u5ea6\u53ef\u80fd\u4f1a\u4e0d\u591f\uff0c\u6211\u4eec\u5c31\u4e8c\u5206\u533a\u95f4\uff0c\u76f4\u5230\u8fbe\u5230\u7cbe\u5ea6\u5c31\u8fd4\u56de\uff0c\u8be6\u89c1\u4ee3\u7801\u5427\uff1a\n\n```cpp\n#include <iostream>\n#include <cstdio> \n#include <algorithm>\n#include <cstring>\n#include <cmath>\n\nusing namespace std;\n\ndouble a, b, c, d, L, R;\n\ninline double f(double x) {\n\treturn (c * x + d) / (a * x + b);\n}\n\ninline double simpson(double l, double r) {\n\treturn (f(r) + f(l) + 4 * f((l + r) / 2)) * (r - l) / 6;\n}\n\ninline double getans(double l, double r) {\n\tdouble mid = (l + r) / 2;\n\tif (fabs(r - l) <= 1e-5) return simpson(l, r);\n\treturn getans(l, mid) + getans(mid, r);\n}\n\nint main() {\n\tscanf(\"%lf%lf%lf%lf%lf%lf\", &a, &b, &c, &d, &L, &R);\n\tprintf(\"%.6lf\", getans(L, R));\n\treturn 0;\n}\n```\n",
        "postTime": 1588486938,
        "uid": 98096,
        "name": "Smallbasic",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4525 \u3010\u3010\u6a21\u677f\u3011\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd51\u3011"
    },
    {
        "content": "\u5206\u7c7b\u8ba8\u8bba $a$ \u662f\u5426\u4e3a $0$\n\n# $a=0$\n\n$$ \\begin{aligned} &\\int \\frac{cx+d}{ax+b}dx \\\\ =&\\int \\frac{cx+d}{b}dx \\\\ =&\\frac{1}{b} \\left(\\int cx \\mathop{dx} \\right) + \\frac{1}{b}\\left(\\int d \\mathop{dx}\\right) \\\\ =&\\frac{cx^2}{2b}+\\frac{dx}{b} \\end{aligned} $$\n\n# $a \\not = 0$\n\n$$ \\begin{aligned} &\\int \\frac{cx+d}{ax+b}dx \\\\ =&\\int \\frac{\\frac{c}{a}(ax+b)-\\frac{bc}{a}+d}{ax+b}dx \\\\ =&\\left( \\int \\frac{c}{a} dx \\right) + \\left((-\\frac{bc}{a}+d)\\int \\frac{1}{ax+b}dx \\right) \\\\ =& \\frac{cx}{a} + (-\\frac{bc}{a}+d) \\frac{\\ln \\mid ax+b \\mid}{a} \\\\ \\end{aligned} $$\n\n\u89e3\u91ca\u4e00\u4e0b $\\int \\frac{1}{ax+b} dx$ \u662f\u600e\u4e48\u7b97\u51fa\u6765\u7684\n\n\u6839\u636e\u7b2c\u4e00\u7c7b\u6362\u5143\u6cd5\uff0c\u6709\uff1a\n\n$$ \\begin{aligned} &\\int \\frac{1}{ax+b} dx \\\\ =&\\frac{1}{a}\\int \\frac{1}{ax+b} d(ax+b) \\\\ =&\\frac{\\ln \\mid ax+b \\mid}{a} \\\\ \\end{aligned} $$\n\n# \u4ee3\u7801\n\n``` cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nint main() {\n    long double a, b, c, d, l, r, ans = 0;\n    cin >> a >> b >> c >> d >> l >> r;\n    if(fabs(a) < 1e-6) {\n        ans += (c * r * r / 2 + d * r - c * l * l / 2 - d * l) / b;\n    } else {\n        ans += (r - l) * c / a;\n        ans += (d - b * c / a) / a * (log(abs(a * r + b)) - log(abs(a * l + b)));\n    }\n    cout << fixed << setprecision(6) << ans << endl;\n}\n```",
        "postTime": 1545566932,
        "uid": 47111,
        "name": "nekko",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4525 \u3010\u3010\u6a21\u677f\u3011\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd51\u3011"
    },
    {
        "content": "\u840c\u65b0\u8868\u793a\u65e2\u4e0d\u4f1a\u624b\u63a8\u4e0d\u5b9a\u79ef\u5206\uff0c\u53c8\u4e0d\u4f1a\u4e8c\u6b21\u51fd\u6570\u79ef\u5206\uff0c\n\n\u90a3\u4e48\u7528\u4e00\u6b21\u51fd\u6570\u62df\u5408\u6574\u4e2a\u51fd\u6570\uff0c\n\n\u7528\u68af\u5f62\u9762\u79ef\u516c\u5f0f$S=(a+b)\u00d7h/2$\uff1b\n\n\u63a8\u51fa\u79ef\u5206\uff0c\u63a7\u5236\u7cbe\u5ea6\u5373\u53efAC~~~\n\n\u7d2b\u9898\u79d2\u53d8\u666e\u53ca-......\n\n```cpp\n#include<iostream>\n#include<cmath>\n#include<cstdio>\nusing namespace std;\ndouble c,d,a,b;\ndouble f(double x)\n{\n\treturn (c*x+d)/(a*x+b);\n}\ndouble simpsongai(double l,double r)\n{\n\treturn (f(l)+f(r))*(r-l)/2;\n}\ndouble get_ans(double l,double r,double eps)\n{\n\tdouble mid=(l+r)/2,result_tot=simpsongai(l,r),result_l=simpsongai(l,mid),result_r=simpsongai(mid,r);\n\tif(fabs(result_tot-result_l-result_r)<=eps*15) return result_tot;\n\treturn get_ans(l,mid,eps/2)+get_ans(mid,r,eps/2);\t\n}\nint main()\n{\n\tdouble l,r;\n\tcin>>a>>b>>c>>d>>l>>r;\n\tprintf(\"%.6lf\",get_ans(l,r,0.000000001));\n}\n```\n",
        "postTime": 1568510901,
        "uid": 222017,
        "name": "user2004",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4525 \u3010\u3010\u6a21\u677f\u3011\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd51\u3011"
    },
    {
        "content": "A \u4e86\u8fd9\u9053\u8d85\u77ed\u7684\u7d2b\u9898\uff0c\u6765\u53d1\u8868\u4e00\u4e0b\u81ea\u5df1\u7684\u4e00\u4e9b\u60f3\u6cd5...\n\n# \u7b80\u5355\u4ecb\u7ecd\u8f9b\u666e\u68ee\u8fd9\u73a9\u610f\u513f\n\n### ~~\u4e0d\u5982\u5148\u5b66\u5b66\u6cf0\u52d2\u5c55\u5f00\uff1f~~\n\n\u9996\u5148\u6cf0\u52d2\u5c55\u5f00\u5927\u5bb6\u90fd\u542c\u8bf4\u8fc7\u5427\uff1f\u3010\u96fe\n\n\u6ca1\u542c\u8bf4\u8fc7\uff1f\u5b89\u5229\u67d0\u77e5\u4e4e\u56de\u7b54\uff1a[\u82cd\u8001\u5e08\u6559\u4f60\u5982\u4f55\u66f4\u597d\u5730\u8bb0\u5fc6\u6cf0\u52d2\u5c55\u5f00](https://www.zhihu.com/question/25627482/answer/313088784)\n\n\u7136\u540e\u4f60\u5c31\u77e5\u9053\u4e86\uff0c\u6cf0\u52d2\u5c55\u5f00\u5176\u5b9e\u662f\u5bf9\u4e8e\u67d0\u4e2a\u51fd\u6570\u5728\u4e00\u4e2a\u70b9\u4e0d\u65ad\u53bb\u9ad8\u9636\u6c42\u5bfc\uff0c\u7136\u540e\u7528\u6c42\u5bfc\u5f97\u5230\u7684\u4fe1\u606f\u6784\u9020\u4e00\u4e2a\u591a\u9879\u5f0f\uff0c\u4f7f\u5f97\u8fd9\u4e2a\u591a\u9879\u5f0f\u5728\u4e00\u5b9a\u8303\u56f4\u5185\u51e0\u4e4e\u548c\u539f\u51fd\u6570\u62df\u5408\uff08\u53ef\u4ee5\u7406\u89e3\u4e3a\u63a5\u8fd1\u91cd\u5408\u7684\u610f\u601d\u5427...\uff09 \n\n### \u7c7b\u6bd4\u5230\u8f9b\u666e\u68ee\uff1f\n\n\u90a3\u4e48\u5176\u5b9e\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u4e5f\u662f\u7c7b\u4f3c\u7684\u9053\u7406\uff0c\u53ea\u4e0d\u8fc7\u5b83\u662f\u7528\u4e86\u5206\u6cbb\u7684\u65b9\u6cd5\u53bb\u6784\u9020\u8fd9\u4e2a ~~\u5047~~ \u62df\u5408 \u591a\u9879\u5f0f\uff08\u5176\u5b9e\u5c31\u662f\u4e8c\u6b21\u51fd\u6570\uff0c\u7a76\u5176\u539f\u56e0\u5e94\u8be5\u5c31\u662f\u8fd9\u73a9\u610f\u513f\u6bd4\u8f83\u597d\u79ef\u5206\u5e76\u4e14\u5b58\u5728\u5f27\u5ea6\uff0c\u5bb9\u6613\u62df\u5408\u5427...\uff09\n\n### \u81ea\u9002\u5e94\u662f\u4e2a\u4ec0\u4e48\u9b3c\uff1f\n\n\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u524d\u9762\u52a0\u4e86\u4e2a\u81ea\u9002\u5e94\u5462\uff1f\u56e0\u4e3a\u6211\u4eec\u8003\u8651\u5206\u6cbb\u662f\u8981\u6709\u7ec8\u6b62\u6761\u4ef6\u7684\uff08\u50cf\u5bf9\u4e8e\u4e00\u4e2a\u5e8f\u5217\u5206\u6cbb\u7684\u8bdd\u5c31\u662f\u5206\u6cbb\u7684\u533a\u95f4\u957f\u5ea6\u4e3a 1 \u65f6\u505c\u6b62\uff09\uff0c\u4f46\u662f\u6211\u4eec\u8fd9\u91cc\u662f\u5728\u5b9e\u6570\u57df\u4e0a\u62df\u5408\u4e00\u4e2a\u591a\u9879\u5f0f\u554a\uff0c\u4e0d\u5b58\u5728\u4ec0\u4e48\u89c4\u5b9a\u7684\u7ec8\u6b62\u70b9...\n\n\u4e8e\u662f\u6211\u4eec\u8003\u8651\u600e\u6837\u53bb\u8bbe\u7f6e\u7ec8\u6b62\u6761\u4ef6\uff1f\u90a3\u5f53\u7136\u662f\u7ed9\u5b9a\u4e00\u4e2a\u8bef\u5dee\u8303\u56f4\uff08\u6bd4\u5982 1e-6\uff09\uff0c\u7136\u540e\u5982\u679c\u62df\u5408\u51fd\u6570\u548c\u539f\u51fd\u6570\u5927\u591a\u6570\u70b9\u7684 y \u503c\u8bef\u5dee\u4e0d\u8d85\u8fc7\u8fd9\u4e2a\u8303\u56f4\u5c31\u7ec8\u6b62\u5206\u6cbb\uff0c\u76f4\u63a5\u62ff\u5f53\u524d\u7684\u51fd\u6570\u53bb\u79ef\u5206\u5c31\u597d\u4e86\uff0c\u5f53\u7136\u5177\u4f53\u600e\u4e48\u6bd4\u8f83\u7684\u5148\u522b\u7ba1\uff08\u4f60\u770b\u5230\u4e0b\u9762\u4e4b\u540e\u4f1a\u53d1\u73b0\u6839\u672c\u4e0d\u9700\u8981\u6bd4\u8f83\u4e24\u4e2a\u51fd\u6570 2333 \uff09\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u8bef\u5dee\u8d8a\u5927\u7b54\u6848\u8d8a\u4e0d\u51c6\u786e\uff0c\u8d8a\u5c0f\u8dd1\u7684\u8d8a\u6162\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u8981\u8c03\u6574\u8fd9\u4e2a\u8bef\u5dee\u8303\u56f4\uff0c\u7136\u540e\u8fd9\u6837\u7684\u8fc7\u7a0b\u5c31\u6709\u70b9\u50cf\"\u81ea\u9002\u5e94\"\u4e86\n\n### \u62df\u5408\u51fd\u6570\u600e\u4e48\u6784\u9020\uff1f\n\n\u6211\u4eec\u5148\u5c06\u539f\u51fd\u6570\u7ea6\u7b49\u4e8e\u6210\u4e00\u4e2a\u4e8c\u6b21\u591a\u9879\u5f0f\uff1a\n\n$$f(x)\u2248Ax^2+Bx+C$$\n\n\u7136\u540e\u9898\u76ee\u8981\u6211\u4eec\u6c42\u7684\u4e1c\u897f\u4e5f\u8f6c\u5316\u4e00\u4e0b\uff1a\n\n\n$$ANS=\\int_a^b f(x)dx$$\n\n$$\u2248\\int_a^b Ax^2+Bx+C$$\n\n$$={A\\over 3}(b^3-a^3) + {B\\over 2} (b^2-a^2) +C(b-a)$$\n\n$$={(b-a)\\over 6}  [ 2A(b^2+ab+a^2) + 3B(b+a)+6C]$$\n\n\n$$={(b-a)\\over 6}  [ (Aa^2 + Ba+C) + (Ab^2+Bb+C)+4(~A~({a+b\\over 2})^2 + B ({a+b\\over2})+C)]$$\n\n\n$$\u2248{(b-a)\\over 6}  [~ f(a) + f(b) + 4~f({a+b\\over2})~]$$\n\n\u6069\uff1f\u4f60\u95ee\u6211\u63a8\u5bfc\u54ea\u91cc\u6765\u7684\uff1f [\u5927\u4f6c%%%](https://phqghume.github.io/2018/05/19/%E8%87%AA%E9%80%82%E5%BA%94%E8%BE%9B%E6%99%AE%E6%A3%AE%E6%B3%95/#simpson\u516c\u5f0f\u63a8\u5bfc)\n\n\u6211\u4eec\u53d1\u73b0\u6700\u540e\u7ea6\u56de\u53bb\u4e86\uff0cA B C \u90fd\u4e0d\u89c1\u4e86\uff0c\u800c\u4e14\u8fd9\u65f6\u5019\u5f0f\u5b50\u91cc\u9762\u5df2\u7ecf\u6ca1\u6709\u79ef\u5206\u4e86...\n\n### \u6240\u4ee5\u600e\u4e48\u6784\u9020 A\u3001B\u3001C \u8fd8\u662f\u6ca1\u8bb2\uff1f\n\n\u6ca1\u9519\uff0c\u6211\u4eec\u53d1\u73b0\u4e0a\u9762\u5176\u5b9e\u6839\u672c\u4e0d\u9700\u8981\u7528\u5230\u8fd9\u4e2a\u62df\u5408\u4e8c\u6b21\u51fd\u6570\u7684\u5177\u4f53\u7cfb\u6570 A\u3001B\u3001C \uff0c\u53ea\u9700\u8981\u5c06 f \u7684\u5f0f\u5b50\u5e26\u5165\u8ba1\u7b97\u6c42\u503c\u5c31\u597d\u4e86\n\n\u4f46\u662f\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u53d1\u73b0\u4e4b\u524d\u8bf4\u7684\u7ec8\u6b62\u6761\u4ef6\u4e0d\u89c1\u4e86\uff0c\u56e0\u4e3a\u6211\u4eec\u7684\u62df\u5408\u51fd\u6570\u5df2\u7ecf\u4e0d\u9700\u8981\u4e86\uff08\u800c\u4e14\u627e\u51fa\u6765\u4e5f\u5f88\u9ebb\u70e6...\uff09\n\n\u5176\u5b9e\u6211\u4eec\u53ea\u9700\u8981\u6bd4\u8f83\u5f53\u524d\u533a\u95f4 $[a,b]$ \u4e0d\u5206\u6cbb\u65f6\u5019\u7684\u7b54\u6848 $ans$ \u548c \u5206\u6cbb\u4e0b\u7684\u7b54\u6848 $ansL+ansR$ \u7684\u8bef\u5dee\u662f\u5426\u8d85\u8fc7\u4e86\u6211\u4eec\u8bbe\u7f6e\u7684\u7cbe\u5ea6\u8303\u56f4\u5c31\u597d\u4e86\n\n\u81f3\u4e8e\u6b63\u786e\u6027\uff1f~~\uff08\u6211\u600e\u4e48\u77e5\u9053\uff09~~\n\n\u56e0\u4e3a\u6211\u4eec\u77e5\u9053\u8fd9\u4e2a\u5206\u6cbb\u80af\u5b9a\u662f\u5c42\u6570\u8d8a\u591a\u8d8a\u7cbe\u786e\u7684\uff0c\u6240\u4ee5\u5206\u6cbb\u7684\u7ed3\u679c\u7cbe\u786e\u5ea6\u80af\u5b9a\u9ad8\u4e8e\u5f53\u524d ans \u7684\u7cbe\u786e\u5ea6\uff0c\u90a3\u4e48\u6211\u4eec\u5361\u5361\u7cbe\u5ea6\u5c31\u80fd\u8ba9\u7b54\u6848\u5728\u8bef\u5dee\u5141\u8bb8\u8303\u56f4\u5185\u4e86\n\n\n\n>FAQ: mmp \u539f\u6765\u771f\u7684\u4e0d\u7528\u6bd4\u8f83\u539f\u51fd\u6570\u548c\u62df\u5408\u51fd\u6570...\n\n>\u5982\u679c\u8981\u6bd4\u8f83\u7684\u8bdd\u53c8\u80fd\u600e\u4e48\u6bd4\u8f83\u5462\uff1f\u53cd\u6b63\u6211\u662f\u4e0d\u4f1a\u7684...\n\n\n\n# code\n\n\u4ee3\u7801\u8d85\u7ea7\u77ed\uff01\u76f8\u5e94\u7684\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u8fd9\u91cc\u6211\u4eec\u53ea\u9700\u8981\u5c06 f \u51fd\u6570\u6539\u4e00\u6539\u5c31\u80fd\u89e3\u51b3\u5176\u4ed6\u51fd\u6570\u7684\u79ef\u5206\u95ee\u9898\u4e86\uff08\u4e00\u5b9a\u7cbe\u5ea6\u4e0b\uff09\n\n```\n//by Judge\n#include<bits/stdc++.h>\n#define db double\nusing namespace std;\ndb a,b,c,d,l,r;\ninline db f(db x){return (c*x+d)/(a*x+b);}\ninline db simpson(db l,db r){ db mid=(l+r)/2;\n\treturn (f(l)+f(r)+4*f(mid))*(r-l)/6;\n}\ndb asr(db l,db r,db eps,db ans){\n\tdb mid=(l+r)/2,L=simpson(l,mid),R=simpson(mid,r);\n\tif(fabs(L+R-ans)<=eps) return L+R+(L+R-ans);\n\treturn asr(l,mid,eps/2,L)+asr(mid,r,eps/2,R);\n}\ninline db asr(db l,db r,db eps){\n\treturn asr(l,r,eps,simpson(l,r));\n}\nint main(){ scanf(\"%lf%lf%lf%lf%lf%lf\",&a,&b,&c,&d,&l,&r);\n\treturn !printf(\"%.6lf\\n\",asr(l,r,1e-8));\n}\n```\n\n\n",
        "postTime": 1554089298,
        "uid": 38576,
        "name": "J\u03bcdge",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4525 \u3010\u3010\u6a21\u677f\u3011\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd51\u3011"
    },
    {
        "content": "~~\u6211\u662f\u6765\u505a\u6570\u5b66\u7684\uff08~~\n\n\u770b\u5230\u6ca1\u6709\u8be6\u7ec6\u7684\u79ef\u5206\u63a8\u5bfc\uff08\u597d\u50cf\u6709\u4e00\u7bc7\u4f46\u6ca1\u600e\u4e48\u4ecb\u7ecd\u662f\u5982\u4f55\u63a8\u51fa\u7684\uff09\uff0c\u4e0d\u662f\u8f9b\u666e\u68ee\u5c31\u662f\u76f4\u63a5\u653e\u516c\u5f0f\uff08\n\n$\\texttt{Upd 2021/05/13:}$ \u5c06\u90e8\u5206\u516c\u5f0f\u6539\u4e3a\u5355\u884c\u516c\u5f0f\uff0c\u90e8\u5206\u5206\u6570\u7684 $\\LaTeX$ \u4f7f\u7528\u6539\u4e3a `\\dfrac{x}{y}`\uff0c\u4f7f\u9898\u89e3\u770b\u4e0a\u53bb\u66f4\u52a0\u7f8e\u89c2\uff01\uff01\n\n------------\n\n\u6c42\uff1a\n\n$$\\int^R_L\\dfrac{cx+d}{ax+b}{\\rm d}x$$\n\n\u4e0d\u96be\u53d1\u73b0\u53ef\u4ee5\u5148\u62c6\u6210\u4e24\u4e2a\u79ef\u5206\uff1a\n\n$$\\int^R_L\\dfrac{cx}{ax+b}{\\rm d}x+\\int^R_L\\dfrac{d}{ax+b}{\\rm d}x$$\n\n\u7531\u4e8e $c$ \u548c $d$ \u90fd\u662f\u5e38\u6570\uff0c\u6545\u53ef\u4ee5\u63d0\u5230\u79ef\u5206\u5916\uff1a\n\n$$c\\int^R_L\\dfrac{x}{ax+b}{\\rm d}x+d\\int^R_L\\dfrac{1}{ax+b}{\\rm d}x$$\n\n\u9047\u5230\u6b64\u7c7b $\\int\\dfrac{1}{ax+b}{\\rm d}x$ \u79ef\u5206\u65f6\uff0c\u6211\u4eec\u901a\u5e38\u91c7\u7528\u6362\u5143\u79ef\u5206\u6cd5\uff0c\u5728\u8fd9\u91cc\u8bbe $u=ax+b$\u3002\n\n\u5f97\u5230\uff1a\n\n$$c\\int^R_L\\dfrac{\\frac{u-b}{a}}{u}{\\rm d}\\dfrac{u-b}{a}+d\\int^R_L\\dfrac{1}{u}{\\rm d}\\dfrac{u-b}{a}$$\n\n\u53c8\u7531\u4e8e $\\dfrac{b}{a}$ \u662f\u4e00\u4e2a\u5e38\u6570\uff0c\u4e14\u5728\u5fae\u5206\u4e2d\uff0c\u53ef\u4ee5\u76f4\u63a5\u5ffd\u7565\uff0c\u540c\u65f6\u5fae\u5206\u4e2d\u7684 $\\dfrac{1}{a}$ \u53ef\u4ee5\u63d0\u51fa\u6765\uff0c\u6240\u4ee5\u539f\u5f0f\u53ef\u4ee5\u53d8\u4e3a\uff1a\n\n$$\\dfrac{c}{a^2}\\int^R_L\\dfrac{u-b}{u}{\\rm d}u+\\dfrac{d}{a}\\int^R_L\\dfrac{1}{u}{\\rm d}u$$\n\n\u7b2c\u4e00\u4e2a\u79ef\u5206\u4e2d\u5206\u5b50\u53ef\u4ee5\u7ee7\u7eed\u5316\uff0c\u62c6\u6210\u603b\u5171\u4e09\u4e2a\u79ef\u5206\uff1a\n\n$$\\dfrac{c}{a^2}\\int^R_L{\\rm d}u-\\dfrac{c}{a^2}\\int^R_L\\dfrac{b}{u}{\\rm d}u+\\dfrac{d}{a}\\int^R_L\\dfrac{1}{u}{\\rm d}u$$\n\n\u4ee5\u53ca $b$ \u662f\u4e2a\u5e38\u6570\uff0c\u4ece\u7b2c\u4e8c\u4e2a\u79ef\u5206\u4e2d\u63d0\u51fa\u6765\u5373\u53ef\uff1a\n\n$$\\dfrac{c}{a^2}\\int^R_L{\\rm d}u-\\dfrac{bc}{a^2}\\int^R_L\\dfrac{1}{u}{\\rm d}u+\\dfrac{d}{a}\\int^R_L\\dfrac{1}{u}{\\rm d}u$$\n\n\u81f3\u6b64\u6574\u4e2a\u79ef\u5206\u63a8\u5bfc\u5c31\u7ed3\u675f\u4e86\uff0c~~\u63a5\u4e0b\u6765\u628a\u79ef\u5206\u5316\u6210\u80fd\u770b\u61c2\u7684\u5f62\u5f0f\u3002~~\n\n$$\\dfrac{c}{a^2}[u]^R_L-\\dfrac{bc}{a^2}[\\ln\\lvert u\\rvert]^R_L+\\dfrac{d}{a}[\\ln\\lvert u\\rvert]^R_L$$\n\n\u518d\u628a $u=ax+b$ \u6362\u56de\u6765\u3002\n\n\u90a3\u4e48\u5c31\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$\\dfrac{c}{a^2}[ax+b]^R_L-\\dfrac{bc}{a^2}[\\ln \\lvert ax+b\\rvert]^R_L+\\dfrac{d}{a}[\\ln \\lvert ax+b\\rvert]^R_L$$\n\n\u6309\u7167\u5b9a\u79ef\u5206\u8ba1\u7b97\u516c\u5f0f\uff0c\u628a $L$ \u548c $R$ \u5e26\u8fdb\u53bb\uff0c\u5f97\u5230\uff1a\n\n$$ \\dfrac{c}{a^2}(aR-aL)-\\dfrac{bc}{a^2}(\\ln \\lvert aR+b\\rvert-\\ln \\lvert aL+b\\rvert)+\\dfrac{d}{a}(\\ln \\lvert aR+b\\rvert-\\ln \\lvert aL+b\\rvert) $$\n\n\u8fd9\u4e2a\u4e1c\u897f\u76f4\u63a5\u5e26\u8fdb\u4ee3\u7801\u5c31\u884c\u4e86\uff0c\u6ce8\u610f $\\ln$ \u51fd\u6570\u5728C++\u91cc\u8868\u793a\u4e3a `log(x)`\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ndouble a,b,c,d,l,r;\nint main(){\n\tscanf(\"%lf %lf %lf %lf %lf %lf\",&a,&b,&c,&d,&l,&r);\n\tprintf(\"%.6lf\",(c/a)*(r-l)-(b*c/(a*a))*(log(fabs(a*r+b))-log(fabs(a*l+b)))+d/a*(log(fabs(a*r+b))-log(fabs(a*l+b))));\n}\n```\n\n\n------------\n\n\u4ea4\u4e0a\u53bb\u4f60\u5c31\u4f1a\u53d1\u73b0\u81ea\u5df160\u5206\uff0c\u4ed4\u7ec6\u89c2\u5bdf\u4f1a\u53d1\u73b0\u6211\u4eec\u63a8\u51fa\u6765\u7684\u5f0f\u5b50\u4e2d\u5b58\u5728 $a$ \u4e3a\u5206\u6bcd\uff0c\u4f46\u662f $0$ \u505a\u5206\u6bcd\u662f\u4e0d\u53ef\u4ee5\u7684\uff08\n\n\u6240\u4ee5\u8003\u8651\u5bf9 $a=0$ \u7279\u5224\uff1a\n\n\u6c42\uff1a\n\n$$\\int^R_L\\dfrac{cx+d}{b}{\\rm d}x$$\n\n\u4e0d\u96be\u53d1\u73b0 $\\dfrac{1}{b}$ \u662f\u4e00\u4e2a\u5e38\u6570\uff0c\u628a\u4ed6\u63d0\u51fa\u6765\uff1a\n\n$$\\dfrac{1}{b}\\int^R_L(cx+d){\\rm d}x$$\n\n\u518d\u5c06\u5176\u5206\u6210\u4e24\u4e2a\u79ef\u5206\uff1a\n\n$$\\dfrac{1}{b}\\int^R_Lcx{\\rm d}x+\\dfrac{1}{b}\\int^R_Ld{\\rm d}x$$\n\n\u518d\u5f3a\u8c03\u4e00\u904d $c$ \u548c $d$ \u90fd\u662f\u5e38\u6570\uff0c\u4e5f\u540c\u6837\u63d0\u51fa\u6765\uff1a\n\n$$\\dfrac{c}{b}\\int^R_Lx{\\rm d}x+\\dfrac{d}{b}\\int^R_L{\\rm d}x$$\n\n\u7528\u666e\u901a\u7684\u79ef\u5206\u516c\u5f0f\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$\\dfrac{c}{b}\\left[\\dfrac{x^2}{2}\\right]^R_L+\\dfrac{d}{b}[x]^R_L$$\n\n\u8fd8\u662f\u540c\u6837\u7684\uff0c\u5c06 $L$ \u548c $R$ \u5e26\u8fdb\u53bb\uff0c\u8fd9\u662f\u6700\u57fa\u7840\u7684\u5b9a\u79ef\u5206\u3002\n\n$$\\dfrac{c}{b}\\cdot\\dfrac{R^2-L^2}{2}+\\dfrac{d}{b}(R-L)$$\n\n\u7528\u4ee3\u7801\u5b9e\u73b0\uff0c\u5e76\u52a0\u4e0a\u521a\u63a8\u51fa\u6765\u7684\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u603b\u4ee3\u7801\u4e86\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ndouble a,b,c,d,l,r;\nint main(){\n\tscanf(\"%lf %lf %lf %lf %lf %lf\",&a,&b,&c,&d,&l,&r);\n\tif(a==0) printf(\"%.6lf\",(c/b)*((r*r-l*l)/2)+d/b*(r-l));\n\tif(a!=0) printf(\"%.6lf\",(c/a)*(r-l)-(b*c/(a*a))*(log(fabs(a*r+b))-log(fabs(a*l+b)))+d/a*(log(fabs(a*r+b))-log(fabs(a*l+b))));\n}\n```\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(1)$ \u5427\u3002",
        "postTime": 1618552822,
        "uid": 380579,
        "name": "LRCAKIOI",
        "ccfLevel": 6,
        "title": "[P4525] \u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd51"
    },
    {
        "content": "~~\u840c\u65b0\u7684\u9996\u4e2a\u7701\u9009\u96be\u5ea6\u9898\u89e3qwq~~\n\n\u5bf9\u4e8e\u4e00\u4e2a\u7ecf\u53d7\u8fc7AP BC Calc\u6298\u78e8\u7684\u5b66\u6e23\u6765\u8bf4\uff0c\u8fd9\u9053\u9898\u53ef\u8c13\u662f\u96be\u5f97\u7684\u8f7b\u677e\uff0c\u5176\u7701\u9009/NOI-\u7684\u96be\u5ea6\u5728\u4e00\u756a\u6570\u5b66\u64cd\u4f5c\u540e\u53ef\u4ee5\u8f7b\u6613\u538b\u7f29\uff01\n\n\u4e0d\u59a8\u7814\u7a76\u4e00\u4e2a\u4e0d\u5b9a\u79ef\u5206\uff0c\n$$\\int\\limits\\dfrac{9x+2}{5x+3}dx$$\n\n\u53ef\u4ee5\u5c06\u5176\u6574\u7406\u6210\u4ee5\u4e0b\u5f62\u5f0f\uff1a\n\n$$\\int\\limits\\dfrac{9x+\\frac{27}{5}}{5x+3}-\\dfrac{\\frac{12}{5} }{5x+3}dx=\\int\\limits \\dfrac{9}{5}- \\dfrac{\\frac{12}{5} }{5x+3}dx$$\n\n\u8fd9\u6837\u4fbf\u53ef\u4ee5\u66f4\u52a0\u65b9\u4fbf\u5730\u6c42\u503c\u4e86\uff01\n\n\u5c06\u76f8\u4f3c\u7684\u64cd\u4f5c\u5e94\u7528\u5230\u4efb\u610f\u7ed9\u51fa\u7684$a,b,c,d$\u7ec4\u6210\u7684\u540c\u578b\u4e0d\u5b9a\u79ef\u5206\uff08$a\\not=0$\uff09\uff0c\u53ef\u5f97\n\n$$\\int\\limits_{L}^{R} \\dfrac{cx+d}{ax+b}dx=\\int\\limits_{L}^{R} \\dfrac{c}{a}-\\dfrac{\\frac{bc}{a}-d}{ax+b}dx$$\n\n\u5373\u53ef\u5199\u51fa$a\\not=0$\u65f6\u6240\u6c42\u503c\u7684\u8868\u8fbe\u5f0f\uff1a\n\n$$\\dfrac{c(R-L)}{a}-(\\dfrac{(\\frac{bc}{a^2}-\\frac{d}{a})\\ln{|aR+b|}}{a}-\\dfrac{(\\frac{bc}{a^2}-\\frac{d}{a})\\ln{|aL+b|}}{a})$$\n\n~~\u8bc1\u660e\u7559\u4f5c\u4f5c\u4e1a~~\n\n\u4e8e\u662f\uff0c\u672c\u840c\u65b0\u4fbf\u5174\u51b2\u51b2\u5730\u5199\u4e86\u4ee5\u4e0b\u7a0b\u5e8f\u63d0\u4ea4\uff1a\n\n```python\nimport math\n\na,b,c,d,l,r=input().split()\n\na=float(a);b=float(b);c=float(c);d=float(d);l=float(l);r=float(r);\n\nans_r=((c*r)/a)+((d/a)-((b*c)/(a*a)))*(math.log(abs(a*r+b)))\n\nans_l=((c*l)/a)+((d/a)-((b*c)/(a*a)))*(math.log(abs(a*l+b)))\n\nans=ans_r-ans_l\n\nprint(\"%.6f\" % ans)\n```\n\u7136\u540e\u5c31\u2026\u202660 RE\uff1f\n\n\u8d76\u5fd9\u4e0b\u8f7d\u6837\u4f8b#7\u672c\u673a\u8fd0\u884c\uff0c\u4e00\u770b----\u539f\u6765$a$\u53ef\u80fd\u53d6$0$\uff01\n\n\u4e8e\u662f~~\u5bb9\u6613~~\u5199\u51fa\uff1a\n$$\\int\\limits_{L}^{R} \\dfrac{cx+d}{b}dx=\\dfrac{c}{2b}R^2+\\dfrac{d}{b}R-\\dfrac{c}{2b}L^2-\\dfrac{d}{b}L$$\n\n~~\u8bc1\u660e\u7559\u4f5c\u4f5c\u4e1a~~\n\n\u8003\u8651\u5230\u201c\u6570\u636e\u4fdd\u8bc1\u8ba1\u7b97\u8fc7\u7a0b\u4e2d\u5206\u6bcd\u4e0d\u4e3a0\u4e14\u79ef\u5206\u80fd\u591f\u6536\u655b\u201d\uff0c\u56e0\u6b64$a,b$\u4e0d\u53ef\u80fd\u540c\u65f6\u4e3a0\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u653e\u5fc3\u5199\u51fa\u4ee5\u4e0b\u7a0b\u5e8f\uff1a\n\n```python\nimport math\n\na,b,c,d,l,r=input().split()\n\na=float(a);b=float(b);c=float(c);d=float(d);l=float(l);r=float(r);\n\nif a!=0:\n    ans_r=((c*r)/a)+((d/a)-((b*c)/(a*a)))*(math.log(abs(a*r+b)))\n\n    ans_l=((c*l)/a)+((d/a)-((b*c)/(a*a)))*(math.log(abs(a*l+b)))\n\n    ans=ans_r-ans_l\n\n    print(\"%.6f\" % ans)\n    \nelse:\n    ans_r=(c*r*r/(2*b))+(d*r)/b\n    \n    ans_=(c*l*l/(2*b))+(d*l)/b\n    \n    ans=ans_r-ans_l\n\n    print(\"%.6f\" % ans)\n```\n\n\u7136\u540e\u5c31AC\u8fa3\uff01\n\n\u611f\u8c22\u7ba1\u7406\u5ba1\u6838\uff01\n\n~~LaTeX\u8fd0\u7528\u7ec3\u4e60\uff08\u786e\u4fe1\uff09~~",
        "postTime": 1591043423,
        "uid": 62562,
        "name": "B_1168",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P4525 \u3010\u3010\u6a21\u677f\u3011\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd51\u3011"
    },
    {
        "content": "\u8003\u8651\u8fd9\u4e48\u4e00\u4e2a\u95ee\u9898\uff1a\u6c42\u4efb\u610f\u66f2\u7ebf\u4e0e $x$ \u8f74\uff0c\u76f4\u7ebf $x=l$\uff0c\u76f4\u7ebf $x=r$ \u5305\u56f4\u7684\u56fe\u5f62\u7684\u9762\u79ef\u3002\n\n\u66f2\u8fb9\u68af\u5f62\u7684\u9762\u79ef\u95ee\u9898\uff0c\u901a\u5e38\u7528\u5b9a\u79ef\u5206\u53ef\u4ee5\u89e3\u51b3\u3002\u4f46\u4efb\u610f\u66f2\u7ebf\u5c31\u51fa\u73b0\u4e86\u4e00\u4e2a\u95ee\u9898\uff1a\u5982\u4f55\u6c42\u89e3\u5b9a\u79ef\u5206\uff1f\n\n\u663e\u7136\u5bf9\u4e8e\u4efb\u610f\u51fd\u6570\uff0c\u6c42\u89e3\u5b9a\u79ef\u5206\u4e0d\u662f\u90a3\u4e48\u5bb9\u6613\uff0c\u6211\u4eec\u8003\u8651\u7528\u8fd1\u4f3c\u7684\u65b9\u5f0f\u89e3\u51b3\u95ee\u9898\u3002\n\n\u5047\u8bbe\u5f53\u524d\u5904\u7406 $[l,r]$ \u90e8\u5206\u7684\u66f2\u8fb9\u68af\u5f62\u9762\u79ef\u3002\u7531\u4e8e\u662f\u66f2\u8fb9\u68af\u5f62\uff0c\u8003\u8651\u7528\u4e8c\u6b21\u51fd\u6570\u8fd1\u4f3c\u3002\n\n\u8bbe\u4e8c\u6b21\u51fd\u6570\uff1a$f(x)=ax^2+bx+c(x \\in [l,r])$\u3002\n\n\u79ef\u5206\u5f97\uff1a\n$$\\begin{aligned} \\int_{l}^{r}f(x)dx\n&=\\int_{l}^{r}(ax^2+bx+c)dx\n\\\\ &=\\frac{1}{3}ax^3+\\frac{1}{2}bx^2+cx+C\\Big|_l^r\n\\\\&=(\\frac{1}{3}ar^3+\\frac{1}{2}br^2+cr+C)-(\\frac{1}{3}al^3+\\frac{1}{2}bl^2+cl+C)\n\\\\&=\\frac{1}{6}(r-l)(2a(r^2+lr+l^2)+3b(l+r)+6c)\n\\\\&=\\frac{1}{6}(r-l)(2al^2+2ar^2+2alr+3bl+3br+6c)\n\\\\&=\\frac{1}{6}(r-l)((al^2+bl+c)+(ar^2+br+c)+(al^2+2alr+ar^2+2bl+2br+4c))\n\\\\&=\\frac{1}{6}(r-l)(f(l)+f(r)+4(a(\\frac{l+r}{2})^2+b(\\frac{l+r}{2})+c))\n\\\\&=\\frac{1}{6}(r-l)(f(l)+f(r)+4f(\\frac{l+r}{2}))\n\\end{aligned}$$\n\u4e8e\u662f\u6211\u4eec\u5c31\u89e3\u51b3\u4e86 $[l,r]$ \u90e8\u5206\u7684\u66f2\u8fb9\u68af\u5f62\u9762\u79ef\u3002\n\n\u4e0b\u9762\u8003\u8651\u8fd1\u4f3c\u7684\u8fb9\u754c\u3002\u6211\u4eec\u5728\u5904\u7406 $[l,r]$ \u65f6\uff0c\u53ef\u4ee5\u5148\u7528\u4e0a\u9762\u7ed9\u51fa\u7684\u516c\u5f0f\u7b97\u51fa $[l,r],[l,\\frac{l+r}{2}],[\\frac{l+r}{2},r]$ \u4e09\u90e8\u5206\u66f2\u8fb9\u68af\u5f62\u7684\u8fd1\u4f3c\u9762\u79ef\u3002\u82e5\u5de6\u53f3\u4e24\u8fb9\u7684\u66f2\u8fb9\u68af\u5f62\u8fd1\u4f3c\u9762\u79ef\u548c\u603b\u7684\u66f2\u8fb9\u68af\u5f62\u8fd1\u4f3c\u9762\u79ef\u5dee\u503c\u5c0f\u4e8e $eps$\uff0c\u5219\u8fd4\u56de\uff0c\u5426\u5219\u4e24\u8fb9\u9012\u5f52\u6c42\u89e3\u3002\u8fd9\u5c31\u662f\u201c\u81ea\u9002\u5e94\u201d\u7684\u65b9\u6cd5\u3002\u4e00\u822c\u4ee3\u7801\u5b9e\u73b0\u4f1a\u6d89\u53ca\u5230\u4e00\u4e9b\u5e38\u6570\u4ee5\u53ca $eps$ \u7684\u7cbe\u5ea6\u5728\u4f20\u9012\u8fc7\u7a0b\u4e2d\u9700\u4e0d\u65ad\u63d0\u9ad8\u7684\u95ee\u9898\uff0c\u5177\u4f53\u53c2\u8003\u4ee3\u7801\u3002\n\n```cpp\n#include<bits/stdc++.h>\ndouble a,b,c,d;\ninline double f ( double x ) { return (c*x+d)/(a*x+b); }\ninline double simpson ( double a,double b )\n{\n\tdouble c=(a+b)*0.5;\n\treturn (f(a)+f(b)+4.0*f(c))*(b-a)/6.0;\n}\ninline double ars ( double a,double b,double eps )\n{\n\tdouble c=(a+b)*0.5,mid=simpson(a,b),l=simpson(a,c),r=simpson(c,b);\n\tif ( fabs(l+r-mid)<=15*eps ) return l+r+(l+r-mid)/15.0;\n\treturn ars(a,c,eps*0.5)+ars(c,b,eps*0.5); \n}\nint main()\n{\n\tdouble l,r;\n\tscanf(\"%lf%lf%lf%lf%lf%lf\",&a,&b,&c,&d,&l,&r);\n\tprintf(\"%.6lf\\n\",ars(l,r,1e-6));\n\treturn 0;\n}\n```",
        "postTime": 1580187578,
        "uid": 46197,
        "name": "_RSY_",
        "ccfLevel": 10,
        "title": "\u3010\u9898\u89e3\u3011P4525"
    },
    {
        "content": "# \u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd5\n\n[\u9898\u76ee\u5728\u8fd9\u91cc](https://www.luogu.org/problem/P4525)\n\n\uff08\u8bf8\u4f4d\u5e94\u8be5\u90fd\u6709\u70b9\u6c42\u5bfc\u7684\u57fa\u7840\u5427\uff0c\u4e0d\u7136\u6765\u5f00\u98de\u673a\u5417\uff08\u6ed1\u7a3d\uff09\uff09\n### \u524d\u7f6e\u4e00\u3001\u4e0d\u5b9a\u79ef\u5206\u6c42\u6cd5\n![](https://cdn.luogu.com.cn/upload/pic/67497.png)\n![](https://cdn.luogu.com.cn/upload/pic/67500.png)\n\uff08\u5fae\u5206\u5fae\u5546\u6211\u5c31\u4e0d\u8bb2\u4e86\uff0c\u53ef\u4ee5\u5148\u5ffd\u7565\uff0c\u795e\u4ed9\uff08\u6211\u5565\u90fd\u4e0d\u77e5\u9053\uff09\u53ef\u4ee5\u8fdb\u884c\u7cfb\u7edf\u5b66\u4e60\uff09\n\n\u8fd9\u91cc\u5c31\u662f\u4e0d\u5b9a\u79ef\u5206\u7684\u6c42\u6cd5\uff0c\u7b80\u5355\u7684\u8bf4\uff0c\u5c31\u662f\u5c06\u6c42\u5bfc\u7684\u8fc7\u7a0b\u53cd\u8fc7\u6765\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5982\u679c\u79ef\u5206\u79efcosx\uff0c\u5219\u539f\u51fd\u6570\u4e3asinx+C\uff0c\u56e0\u4e3asinx\u6c42\u5bfc\u5c31\u662fcosx\n### \u524d\u7f6e\u4e8c\u3001\u725b\u987f\u83b1\u5e03\u5c3c\u5179\u516c\u5f0f\n![](https://cdn.luogu.com.cn/upload/pic/67490.png)\n\n\u5b9a\u79ef\u5206\u5c31\u662f\u4f7f\u4e0d\u5b9a\u79ef\u5206\u6709\u4e86\u4e0a\u4e0b\u754c\uff0c\u4e8e\u662f\u8fd9\u91cc\u8ba1\u7b97\u7684\u4fbf\u662f\u5728\u533a\u95f4[ a , b ]\u4e2d\u7684\u66f2\u8fb9\u68af\u5f62\u9762\u79ef\u7684\u4ee3\u6570\u548c\uff08\u53ef\u4ee5\u4e3a\u8d1f\uff09,\u6bd4\u5982\u8fd9\u4e2a\n\n![](https://cdn.luogu.com.cn/upload/pic/67504.png)\n\n\u4e0a\u6587\u6709\u4e2a\u5f15\u4f8b\uff0c\u8bb2\u7684\u5c31\u662f\u53d8\u4e3a\u5b9a\u79ef\u5206\u540e\uff0c\u6309\u7167\u4ee5\u5f80\u7684\u79ef\u5206\u6c42\u6cd5\uff0c\u5957\u7528\u516c\u5f0f\u53ef\u4ee5\u89e3\u51b3\u3002\u4f46\u8fd9\u4e2a\u65b9\u6cd5\u662f\u6709\u5c40\u9650\u6027\u7684\uff0c\u89c1\u4e0b\u56fe\uff1a\n\n\n![](https://cdn.luogu.com.cn/upload/pic/67491.png)\n\n\u5f97\u5230\u7684\u725b\u987f\u83b1\u5e03\u5c3c\u5179\u516c\u5f0f\u4fbf\u662f\u6c42\u5b9a\u79ef\u5206\u7684\u5229\u5668\n\n### \u4e09\u3001Simpson\n\n\u5728\u4e86\u89e3\u4e86\u524d\u7f6e\u77e5\u8bc6\u4ee5\u540e\uff0c\u6211\u4eec\u4fbf\u53ef\u4ee5\u7814\u7a76\u8f9b\u666e\u68ee\u79ef\u5206\n\n\u8bdd\u4e0d\u591a\u8bf4\uff0c\u4e0a\u56fe\n\n![](https://cdn.luogu.com.cn/upload/pic/67480.png)\n![](https://cdn.luogu.com.cn/upload/pic/67481.png)\n\n\n\u5728\u4e0a\u8ff0\u5316\u7b80\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0\u5b83\u8fd0\u7528\u4e86\u4e00\u4e2a\u5c0f\u6280\u5de7\u2014\u2014\u7acb\u65b9\u5dee\u548c\u5e73\u65b9\u5dee\u516c\u5f0f\u3002\uff08\u5728\u8fd9\u91cc\u63d0\u4e00\u4e0b\uff0c\u4ee5\u9632\u5de8\u795e\u7a81\u7136\u8111\u62bd\uff0c\u66b4\u9a82\u9898\u89e3\uff09\n\n\u7136\u540e\u4e00\u901a\u4e71\u641e\u53ef\u4ee5\u53d8\u6210\u4e00\u4e2a\u7b80\u5355\u7684\u5f62\u5f0f\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u7684Simpson\u7684\u516c\u5f0f\n\n![](https://cdn.luogu.com.cn/upload/pic/67502.png)\n\n\u7528a \u3001b\u4ee3\u66ff\u5c31\u662f\n\n![](https://cdn.luogu.com.cn/upload/pic/67505.png)\n\n### \u56db\u3001\u4e3b\u4f53\u7b97\u6cd5\n\n\u6211\u4eec\u663e\u7136\u4e0d\u80fd\u53ea\u6c42\u4e00\u6b21\uff08\u9664\u975e\u4f60\u8138\u767d\u5230\u6211\u90fd\u770b\u4e0d\u89c1\u4f60\uff0c\u4f60\u53ef\u4ee5\u8ddfOI\u4e00\u6bd4\u9ad8\u4e0b\uff09\n\n\u4e8e\u662f\u6211\u4eec\u51b3\u5b9a\u7528\u628a L \u5230 mid  \u548c  mid \u5230 R\uff0c\u5206\u522b\u62df\u5408\uff0c\u5e76\u6c42\u5206\u522b\u7684\u79ef\u5206\uff0c\n\n\u6bd4\u8f83\u548cL\u5230R\u7684\u603b\u79ef\u5206\uff0c\u5982\u679c\u5dee\u503c\u5c0f\u5230\u53ef\u4ee5\u5ffd\u7565\uff08<eps\uff09,\u5c31\u53ef\u4ee5\u4e86\uff08\u4e0d\u7136\u4f60\n\n\u8981\u5206\u5230\u5929\u8352\u5730\u8001\u5417\uff09\n\n### \u4e94\u3001\u4ee3\u7801\n(\u56fe\u7247\u6709\u70b9\u5c0f\uff0c\u53ef\u4ee5\u65b0\u7a97\u53e3\u6253\u5f00\u770b)\uff08\u9a9a\u7ea2\u8272\u7684CPP\uff09\n![](https://cdn.luogu.com.cn/upload/pic/67503.png)\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\ndouble a,b,c,d,x,y;\n\n\ndouble eps = 1e-12; //\u6781\u5c0f\u503c \nbool dcmp(double X){\n\treturn fabs(X)<eps;\n} //\u6bd4\u8f83\u6d6e\u70b9\u6570 \n\ndouble f(double X) {return (c*X+d)/(a*X+b);} //\u539f\u51fd\u6570 \ndouble calc(double L,double R){return (R-L)*(f(L)+f(R)+4.0*f((L+R)/2.0))/6.0;} //Simpson\u79ef\u5206\u516c\u5f0f \ndouble simpson(double l,double r,double ans); //\u4e3b\u8981\u7b97\u6cd5\uff0c\u6c42\u79ef\u5206 \n\nsigned main(){\n\tcin>>a>>b>>c>>d>>x>>y;\n\tcout<<fixed<<setprecision(6)<<simpson(x,y,calc(x,y));\n\treturn 0;   \n}\n\ndouble simpson(double l,double r,double ans){ //\u4e0a\u4e0b\u754c\u548c\u603b\u5b9a\u79ef\u5206 \n\tdouble mid = (l+r) /2.0; //\u4e2d\u95f4\u9879 \n\tdouble ans1 = calc(l,mid), ans2 = calc(mid,r); //\u5206\u522b\u8ba1\u7b97\u5de6\u53f3\u4e24\u533a\u95f4\u7684\u5b9a\u79ef\u5206\u503c \n\tif(fabs(ans1+ans2-ans)<=eps) return (ans1+ans2+ans1+ans2-ans); //\u662f\u5426\u76f8\u5339\u914d \n\treturn simpson(l,mid,ans1) + simpson(mid,r,ans2); //\u5de6\u53f3\u5206\u522b\u6c42 \n}  \n\n```\n\n\n\n\n\n",
        "postTime": 1564676166,
        "uid": 43517,
        "name": "VeritasatireV",
        "ccfLevel": 0,
        "title": "\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd5"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u9053\u9ad8\u7b49\u6570\u5b66\u5b9a\u79ef\u5206\u7684\u9898\uff0c\u4e14\u88ab\u79ef\u51fd\u6570\u6709\u539f\u51fd\u6570\uff0c\u6545\u53ef\u4f7f\u7528\u725b\u987f-\u83b1\u5e03\u5c3c\u5179\u516c\u5f0f![](https://cdn.luogu.com.cn/upload/pic/46526.png)( F(x)\u4e3af(x)\u7684\u4e00\u4e2a\u539f\u51fd\u6570)\n\n\u4ee3\u7801\u4e2d\u539f\u51fd\u6570\u5747\u53d6C=0(C\u88ab\u62b5\u6d88\u4e86\uff0c\u4e0d\u5f71\u54cd\u7ed3\u679c)\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ndouble a,b,c,d,l,r;\n//a!=0 c!=0\u65f6\u88ab\u79ef\u51fd\u6570\u7684\u539f\u51fd\u6570\ndouble F(double x){\n\treturn c*x/a+(d-c*b/a)*log(abs(a*x+b))/a;\n}\n//a=0 c!=0\u65f6\u88ab\u79ef\u51fd\u6570\u7684\u539f\u51fd\u6570\ndouble F1(double x){\n\treturn c*x*x/(2*b)+d*x/b;\n}\n//a!=0 c=0\u65f6\u88ab\u79ef\u51fd\u6570\u7684\u539f\u51fd\u6570\ndouble F2(double x){\n\treturn d*log(abs(a*x+b))/a;\n}\nint main()\n{\n\tcin>>a>>b>>c>>d>>l>>r;\n    //a=0 b=0\u65f6\u88ab\u79ef\u51fd\u6570\u4e3a\u5e38\u6570\uff0c\u539f\u51fd\u6570\u4e3aF(x)=d/b*x\n\tif(a==0&&c==0) printf(\"%0.6lf\",d*(r-l)/b);\n\telse if(a==0.0) printf(\"%0.6lf\",F1(r)-F1(l));\n\telse if(c==0.0) printf(\"%0.6lf\",F2(r)-F2(l));\n\telse printf(\"%0.6lf\",F(r)-F(l));\n\treturn 0;\n}\n```",
        "postTime": 1545102950,
        "uid": 118144,
        "name": "ykkz000",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P4525 \u3010\u3010\u6a21\u677f\u3011\u81ea\u9002\u5e94\u8f9b\u666e\u68ee\u6cd51\u3011"
    }
]
[
    {
        "content": "## \u9898\u76ee\u5927\u610f\n\n\u4e8c\u7ef4\u5e73\u9762\u4e0a\u6709 $n$ \u4e2a\u6574\u70b9\uff0c\u6bcf\u4e2a\u6574\u70b9\u7684\u5750\u6807\u4e3a $(x_i,y_i)$ \uff0c\u82e5\u4e24\u4e2a\u70b9 $i,j$ \u6ee1\u8db3 $|x_i-x_j|+|y_i-y_j|\\le R$ \uff0c\u5219\u5728\u8fd9\u4e24\u4e2a\u70b9\u4e4b\u95f4\u8fde\u4e00\u6761\u8fb9\u3002\u6c42\u8054\u901a\u5757\u7684\u6570\u91cf\u3002\n\n$1\\le n\\le 100000,0\\le r,x_i,y_i\\le 10^9$\n\n## \u89e3\u9898\u601d\u8def\n\n\u5982\u679c\u66b4\u529b\u5efa\u8fb9\uff0c\u5f53\u6240\u6709\u8282\u70b9\u90fd\u6ee1\u8db3\u4e92\u76f8\u8fde\u8fb9\u7684\u6761\u4ef6\uff0c\u5373\u6240\u6709\u8282\u70b9\u6324\u5728\u4e00\u8d77\u65f6\uff0c\u8fb9\u7684\u6570\u91cf\u662f $O(n^2)$ \u7684\uff0c\u663e\u7136\u65e0\u6cd5\u5fcd\u53d7\u3002\u8fd9\u65f6\u6211\u4eec\u9700\u8981\u8003\u8651\u4e00\u4e9b\u4f18\u5316\u5efa\u56fe\u7684\u65b9\u6cd5\u3002\n\n\u6211\u4eec\u5c06\u4e00\u4e2a\u70b9\u7684\u5f71\u54cd\u8303\u56f4\u753b\u51fa\u6765\uff0c\u5982\u4e0b\u77e9\u9635\uff1a\n\n```cpp\n0001000\n0011100\n0111110\n1111111\n0111110\n0011100\n0001000\n```\n\n$R=3$ \u65f6\u7684\u60c5\u51b5\n\n\u6211\u4eec\u53d1\u73b0\u6bcf\u4e2a\u70b9\u7684\u5f71\u54cd\u8303\u56f4\u90fd\u662f\u4e00\u4e2a\u4e0e\u5750\u6807\u8f74\u5939\u89d2\u4e3a $45\\degree$ \u7684\u76f4\u7ebf\u56f4\u6210\u7684\u6b63\u65b9\u5f62\uff0c\u5373\u7531\u659c\u7387 $k=1$ \u548c $k=-1$ \u7684\u76f4\u7ebf\u56f4\u6210\u7684\u6b63\u65b9\u5f62\u3002\n\n\u5982\u679c\u6bcf\u4e2a\u70b9\u7684\u5f71\u54cd\u8303\u56f4\u662f\u4e00\u4e2a\u4e0e\u5750\u6807\u8f74\u5e73\u884c\u7684\u77e9\u5f62\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u626b\u63cf\u7ebf\u6cd5\u7ef4\u62a4\u4f18\u5316\u8fde\u8fb9\u3002\n\n\u56e0\u4e3a\u6b64\u9898\u7684\u5f71\u54cd\u8303\u56f4\u662f\u659c\u7740\u7684\u6b63\u65b9\u5f62\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u659c\u7740\u626b\u63cf\u7ebf\u3002\n\n\u6211\u4eec\u5c06\u6240\u6709\u70b9\u6309\u7167 $x_i+y_i$ \u7684\u503c\u4ece\u5c0f\u5230\u5927\u8fdb\u884c\u6392\u5e8f\uff0c\u8fdb\u884c\u626b\u63cf\u7ebf\u3002\u626b\u63cf\u7ebf\u4e3a\u4e00\u6761\u659c\u7387\u4e3a $-1$ \u7684\u76f4\u7ebf\uff0c\u5176\u7ef4\u62a4\u7684\u662f\u5bf9\u5f53\u524d\u7b54\u6848\u6709\u8d21\u732e\u7684\u70b9\u7684\u4f4d\u7f6e\u3002\u5728\u672c\u4eba\u7684\u4ee3\u7801\u5b9e\u73b0\u4e2d\uff0c\u7528 `set` \u7ef4\u62a4\u626b\u63cf\u7ebf\u3002\n\n\u4e00\u4e2a\u70b9\u7684\u5750\u6807\u4e3a $(x_i,y_i)$ \uff0c\u5176\u5bf9\u5e94\u503c $x_i-y_i$ \u4f1a\u5728\u626b\u63cf\u7ebf $x_i+y_i$ \u65f6\u52a0\u5165\u626b\u63cf\u7ebf\uff0c\u5728\u626b\u63cf\u7ebf $x_i+y_i+R$ \u65f6\u9000\u51fa\u626b\u63cf\u7ebf\u3002\n\n\u6211\u4eec\u5c06\u6bcf\u4e2a\u659c\u7387\u4e3a $1$ \u4e0a\u7684\u6574\u70b9\u8fdb\u884c\u4e00\u4e2a\u5bf9\u5e94\u5173\u7cfb\uff0c\u4ee4\u5176\u5bf9\u5e94\u503c\u4e3a $p_i=x_i-y_i$ \uff0c\u4fdd\u8bc1\u6240\u6709\u8fd9\u4e9b\u70b9\u7684\u5bf9\u5e94\u503c\u76f8\u7b49\u3002\n\n\u4e00\u4e2a\u8282\u70b9 $y$ \u80fd\u4e0e\u5f53\u524d\u8282\u70b9 $x$ \u76f8\u8fde\uff0c\u5f53\u4e14\u4ec5\u5f53\u5b83\u4eec\u7684\u5bf9\u5e94\u503c\u7684\u5dee $|p_x-p_y|\\le R$ \u3002\u8fd9\u65f6\u53ef\u4ee5\u5728\u5e76\u67e5\u96c6\u4e0a `merge` \u4e24\u4e2a\u8282\u70b9\u3002\n\n\u7136\u800c\uff0c\u8fd9\u6837\u7684\u590d\u6742\u5ea6\u662f\u548c\u8fb9\u6570\u540c\u9636\u7684\u3002\u7ed9\u51fa\u4e00\u4e2a\u7ed3\u8bba\uff1a\u76f4\u63a5\u5c06\u8282\u70b9 $x$ \u4e0e\u53ef\u8fde\u7684\u5411\u5de6\u5411\u53f3\u6700\u63a5\u8fd1\u7684\u70b9\u8fde\u8fb9\uff0c\u56e0\u4e3a $x$ \u5176\u5b83\u53ef\u8fde\u7684\u70b9\u5728\u4e4b\u524d\u80af\u5b9a\u90fd\u5728\u626b\u63cf\u7ebf\u4e0a\uff0c\u800c\u90fd\u8fde\u4e0a\u4e86\uff0c\u8fd9\u6837\u53ef\u4ee5\u63a7\u5236\u8fb9\u6570\u662f $O(n)$ \u7684\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<map>\nusing namespace std;\nconst int maxn=100010;\nint n,r,f[maxn],ans,cur;\nint findp(int x){return f[x]?f[x]=findp(f[x]):x;}\nvoid merge(int x,int y)\n{\n\tint u=findp(x),v=findp(y);\n\tif(u!=v)f[u]=v,ans--;\n}\nstruct node\n{\n\tint x,y;\n\tbool operator<(node a)const{if(x+y!=a.x+a.y)return x+y<a.x+a.y;return x<a.x;}\n}s[maxn];\nmap<int,int>st;\nint main()\n{\n\tscanf(\"%d%d\",&n,&r);ans=n;\n\tfor(int i=1;i<=n;i++)scanf(\"%d%d\",&s[i].x,&s[i].y);\n\tsort(s+1,s+n+1);\n\tcur=1;\n\tst[2e9+1]=-1;st[-(2e9+1)]=-1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(;cur<=n&&s[cur].x+s[cur].y+r<s[i].x+s[i].y;cur++)\n\t\tif(st[s[cur].x-s[cur].y]==cur)st.erase(s[cur].x-s[cur].y);\n\t\tmap<int,int>::iterator it=st.lower_bound(s[i].x-s[i].y);\n\t\tif(it->first-(s[i].x-s[i].y)<=r)if(it->second)merge(i,it->second);\n\t\tit--;\n\t\tif(s[i].x-s[i].y-it->first<=r)if(it->second)merge(i,it->second);\n\t\tst[s[i].x-s[i].y]=i;\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1553330727,
        "uid": 43486,
        "name": "hsfzLZH1",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5193 \u3010[TJOI2012]\u70b8\u5f39\u3011"
    },
    {
        "content": "\u5bf9\u4e8e\u66fc\u54c8\u987f\u8ddd\u79bb\u7684\u6bd4\u8f83\uff0c\u53ef\u4ee5\u5957\u8def\u5730\u5c06 $(x,y) \\rightarrow (x-y,x+y)$ \u8f6c\u5316\u4e3a\u5207\u6bd4\u96ea\u592b\u8ddd\u79bb\uff0c\u4e00\u4e2a\u70b8\u5f39\u7684\u653b\u51fb\u8303\u56f4\u53d8\u6210\u4e86\u77e9\u5f62\u3002\n\n\u5f53\u7136\u53ef\u4ee5\u7528 K-D Tree \u4f18\u5316\u5efa\u8fb9\u4e4b\u540e tarjan \u7f29\u70b9\u6765\u505a\uff0c\u4f46\u662f\u770b\u8d77\u6765\u7801\u91cf\u5de8\u5927\u3002\n\n\u6ce8\u610f\u5230\u6b64\u9898\u4ec5\u9700\u5173\u4e8e\u8fde\u901a\u6027\u7684\u4fe1\u606f\uff0c\u4e14\u653b\u51fb\u5173\u7cfb\u662f\u53cc\u5411\u7684\uff0c\u6240\u4ee5\u5927\u6982\u53ef\u4ee5\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u3002\u95ee\u9898\u662f\u600e\u4e48\u5efa\u8fb9\u3002\n\n\u8003\u8651\u7528\u4e00\u4e2a $R\\times R$ \u7684\u77e9\u5f62\u53bb\u6846\uff0c\u540c\u65f6\u88ab\u6846\u4e2d\u7684\u70b9\u4e00\u5b9a\u53ef\u4ee5\u4e92\u76f8\u6ce2\u53ca\u3002\u90a3\u8fd9\u4e2a\u77e9\u5f62\u5c31\u6709\u4e86\u6a2a\u5750\u6807\u548c\u7eb5\u5750\u6807\u7684\u4e24\u6761\u9650\u5236\uff08\u5747\u9700\u8981 $\\leq R$\uff09\uff1a\n\n- \u6a2a\u5750\u6807\u7684\u9650\u5236\u53ef\u4ee5\u5148\u628a\u6240\u6709\u70b9\u6309\u7167\u6a2a\u5750\u6807\u6392\u5e8f\uff0c\u626b\u63cf\u7ebf\u52a8\u6001\u5730\u7ef4\u62a4\u6a2a\u5750\u6807\u76f8\u5dee $R$ \u4ee5\u5185\u7684\u70b9\u96c6\u3002\n\n- \u5bf9\u4e8e\u7eb5\u5750\u6807\u7684\u9650\u5236\uff0c\u4e5f\u5c31\u662f\u5728\u70b9\u96c6\u4e2d\uff0c\u6bcf\u4e24\u4e2a\u7eb5\u5750\u6807\u4e4b\u5dee $\\leq R$ \u7684\u70b9\u5fc5\u987b\u8054\u901a\u3002\n\n\u7b2c\u4e00\u70b9\u5f88\u7b80\u5355\uff0c\u53cc\u6307\u9488\u5373\u53ef\uff1b\u5bf9\u4e8e\u7b2c\u4e8c\u70b9\uff0c\u8003\u8651\u8ba1\u7b97 **\u589e\u91cf** \u7684\u8d21\u732e\uff1a\n\n- \u4ece\u96c6\u5408\u5185\u5220\u9664\u4e00\u4e2a\u5143\u7d20\uff0c\u4e0d\u4f1a\u5bf9\u8fde\u901a\u6027\u4ea7\u751f\u6539\u53d8\u3002\n\n- \u4ece\u96c6\u5408\u5185\u52a0\u5165\u4e00\u4e2a\u5143\u7d20\uff0c\u53ea\u53ef\u80fd\u5c06 **\u81ea\u5df1** \u4e0e **\u67d0\u4e9b\u5b83\u80fd\u653b\u51fb\u5230\u7684\u8fde\u901a\u5757** \u8fde\u8d77\u6765\uff0c\u800c\u7531\u4e8e\u7eb5\u5750\u6807\u76f8\u5dee $\\leq R$ \u7684\u70b9\u5728\u4e4b\u524d\u5fc5\u7136\u5df2\u7ecf\u88ab\u5408\u5e76\u4e86\uff0c\u6240\u4ee5\u5728\u5b83\u7684\u653b\u51fb\u8303\u56f4\u5185\uff0c\u6700\u591a\u5b58\u5728 \u7eb5\u5750\u6807\u5927\u4e8e\u5b83\u7684 \u548c \u5c0f\u4e8e\u5b83\u7684 \u4e24\u4e2a\u8fde\u901a\u5757\u3002\u627e\u5230\u5176\u7eb5\u5750\u6807\u7684\u524d\u9a71\u540e\u7ee7\u5373\u53ef\u3002\n\n\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6a2a/\u7eb5\u5750\u6807\u5750\u6807\u6709\u76f8\u7b49\u7684\u60c5\u51b5\uff0c\u9700\u8981\u94a6\u5b9a\u7f16\u53f7\u5c0f\u7684\u70b9\u4f18\u5148\u7ea7\u8f83\u9ad8\uff08\u4e3e\u4f8b\uff09\u3002\n\n```cpp\nfor(rgi i=1;i<=n;++i){\n\twhile(!s1.empty()){\n\t\tnode k=*s1.begin();\n\t\tif(p[i].x-R>k.x)s1.erase(k),s2.erase(k);\n\t\telse break;\n\t}\n\tauto nxt=s2.lower_bound(p[i]);\n\tif(nxt!=s2.end()&&(*nxt).y-p[i].y<=R)fa[find(p[i].id)]=find((*nxt).id);\n\tif(nxt!=s2.begin()&&p[i].y-(*--nxt).y<=R)fa[find(p[i].id)]=find((*nxt).id);\n\ts1.insert(p[i]),s2.insert(p[i]);\n}\n```\n",
        "postTime": 1624608485,
        "uid": 78372,
        "name": "M4_SOPMODII_JR",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5193 [TJOI2012]\u70b8\u5f39"
    }
]
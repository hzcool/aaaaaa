[
    {
        "content": "\u9996\u5148\u5148\u8003\u8651\u6734\u7d20dp\uff0c\u8bbef[i][j]\u4e3a\u5230\u4e86\u7b2ci\u5bb6\u5e97\uff0c1~i-1\u5bb6\u5e97\u5171\u4e70\u4e86j\u5428\u9972\u6599 \n\n\u90a3\u4e48\u8f6c\u79fb\u53ef\u4ee5\u5199\u6210 \uff1a\n\nf[i][j]=min(f[i][j],f[i-1][k]+j*j*d[i]+(j-k)*a[i-1].w); \n\u5176\u4e2da[i-1].w\u4e3a\u7b2ci-1\u5bb6\u5e97\u9972\u6599\u7684\u4ef7\u683c\uff0cd[i]\u4e3a\u7b2ci\u4e0ei-1\u5bb6\u5e97\u7684\u8ddd\u79bb \n\u590d\u6742\u5ea6\u4e3aO(nk^2)\uff0c\u5f88\u660e\u663e\u70b8\u4e86 \n\n## \u600e\u4e48\u529e\uff1f\uff1f\n\u5148\u628a\u5f0f\u5b50\u62c6\u4e86\u5427 \n\nf[i][j]=min(f[i][j],f[i-1][k]+j*j*d[i]+j*a[i-1].w-k*a[i-1].w) \n\n\u63d0\u51fa\u6765f[i-1][k]+j*j*d[i]+j*a[i-1].w-k*a[i-1].w \n\n\u628a\u5c5e\u4e8ek\u7684\u63d0\u51fa\u6765\uff0c\u53d8\u4e3af[i-1][k]-k*a[i-1].w+j*j*d[i]+j*a[i-1].w \n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u540e\u534a\u90e8\u5206\u662f\u5b9a\u503c\uff0c\u6211\u4eec\u7528\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u524d\u534a\u90e8\u5206\u5c31\u597d\u4e86 \n\u4f46\u662f\u5982\u679c\u5355\u7eaf\u7684\u5355\u8c03\u961f\u5217\u4f1a\u9519\uff0c\u4e3a\u5565\uff1f\u5982\u679c\u6211\u8fd9\u5bb6\u5e97\u6240\u80fd\u63d0\u4f9b\u7684\u9972\u6599\u4e0d\u591f\u6211\u9700\u8981\u7684\u5462\uff1f \n\n\u6240\u4ee5\uff0c\u8fd8\u8981\u52a0\u4e0a\u51e0\u4e2a\u7279\u5224\u5566\n# \u4ee3\u7801\n```\n#include<cstdio>\n#include<cstring>\n#include<cstdlib>\n#include<algorithm>\n#include<cmath>\nusing namespace std;\ntypedef long long LL;\nconst LL inf=1e15;\nstruct node\n{\n    LL x,c,w;//\u8ddd\u79bb \u6570\u91cf \u4ef7\u683c \n}a[11000];\nbool cmp(node n1,node n2){return n1.x<n2.x;}\nLL f[510][11100];//\u7b2ci\u5bb6\u5e97 1~i-1\u5bb6\u5e97\u88c5\u4e86j\u5428\u9972\u6599\nint n,m,kk;//n\u5bb6\u5e97 \u8ddd\u79bbm \u5e0c\u671b\u4e70kk\nLL d[11000];\nLL list[11000],head,tail;\nint main()\n{\n    //freopen(\"feed.in\",\"r\",stdin);\n    //freopen(\"feed.out\",\"w\",stdout);\n    scanf(\"%d%d%d\",&kk,&m,&n);\n    for(int i=1;i<=n;i++)scanf(\"%lld%lld%lld\",&a[i].x,&a[i].c,&a[i].w);\n    n++;a[n].x=m;\n    sort(a+1,a+1+n,cmp);\n    for(int i=2;i<=n;i++)d[i]=a[i].x-a[i-1].x;\n    for(int i=0;i<=n;i++)for(int j=0;j<=kk;j++)f[i][j]=inf;\n    f[0][0]=0;\n    for(LL i=1;i<=n;i++)\n    {\n        head=tail=0;\n        for(LL j=0;j<=kk;j++)\n        {\n            while(head<tail && j-list[head]>a[i-1].c)head++;//\u9700\u8981\u4e70\u7684 \u672c\u5546\u5e97\u4e0d\u80fd\u6ee1\u8db3 \n            if(f[i-1][j]!=inf)\n            {\n                while(head<tail)\n                {\n                    LL k=list[tail-1];\n                    if(f[i-1][k]-k*a[i-1].w<f[i-1][j]-j*a[i-1].w)break;\n                    tail--;\n                }\n                list[tail++]=j;\n            }\n            if(head<tail)\n            {\n                LL k=list[head];\n                f[i][j]=f[i-1][k]+(j-k)*a[i-1].w+j*j*d[i];\n            }\n        }\n    }\n    printf(\"%lld\\n\",f[n][kk]);\n    return 0;\n}\n```",
        "postTime": 1525700761,
        "uid": 75446,
        "name": "Unknown_Error\u00a0",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4544 \u3010[USACO10NOV]\u8d2d\u4e70\u9972\u6599Buying Feed\u3011"
    },
    {
        "content": "**\u975e\u5355\u8c03\u961f\u5217\u5199\u6cd5\uff0c\u76f4\u63a5\u7528\u4e00\u4e2a\u53d8\u91cf\u7ef4\u62a4\u51b3\u7b56\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u548c\u5355\u8c03\u961f\u5217\u5199\u6cd5\u76f8\u540c\u3002**\r\n\r\n\r\n------------\r\n\r\n\r\n\u524d\u8a00\uff1a\u5199\u672c\u9898\u65f6\u7528\u4e86\u4e00\u4e2a\u5f88\u7b80\u6d01\u7684\u505a\u6cd5\uff0c\u4f46\u5176\u4e2d\u5229\u7528\u7684\u51fd\u6570\u51f8\u6027\u548c\u5355\u8c03\u6027\u6211\u4e0d\u4f1a\u8bc1\u660e\uff0c\u540e\u6765\u770b\u9898\u89e3\u533a\u90fd\u662f\u5355\u8c03\u961f\u5217\u5199\u6cd5\uff0c\u6bd4\u8f83\u6000\u7591\u81ea\u5df1\u7684\u505a\u6cd5\u6b63\u786e\u6027\uff0c\u5c31\u53d1\u5e16\u6c42\u52a9\uff0c\u5f97\u5230\u4e86\u70ed\u5fc3\u795e\u7287 @Alex_Wei \u7684\u5e2e\u52a9\uff0c\u57fa\u672c\u786e\u5b9a\u505a\u6cd5\u7684\u6b63\u786e\u6027\uff0c\u800c\u4e14\u611f\u89c9\u8fd9\u548c\u9898\u89e3\u533a\u5df2\u6709\u7684\u5355\u8c03\u961f\u5217\u505a\u6cd5\u672c\u8d28\u5e76\u4e0d\u76f8\u540c\uff08\u90a3\u4f4d\u795e\u7287\u4e5f\u662f\u8fd9\u4e48\u8bf4\u7684\u563f\u563f\uff09\uff0c\u4e8e\u662f\u5199\u9898\u89e3\u63d0\u4f9b\u4e00\u4e2a\u65b0\u601d\u8def\uff0c\u4f46\u9898\u89e3\u901a\u9053\u5df2\u5173\u95ed\uff0c\u4e0d\u77e5\u9053\u80fd\u5426\u4ea4\u4e0a\u53bb\u3002\r\n\r\n\r\n------------\r\n#### \u6734\u7d20 DP\uff1a\r\n\r\n\u9996\u5148\u8fd8\u662f\u6309\u7167\u5750\u6807\u7ed9\u5546\u5e97\u6392\uff0c\u7136\u540e DP:\r\n\r\n$f_{i, j}$ \u8868\u793a\u8003\u8651\u5230\u7b2c $i$ \u5bb6\u5546\u5e97 \u5df2\u7ecf\u6709 $j$ \u5428\u9972\u6599\u7684\u6700\u5c0f\u82b1\u8d39\uff0c\u6bcf\u6b21\u679a\u4e3e\u65b0\u7684\u5546\u5e97\u4e70\u591a\u5c11\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(nk^2)$ \u65e0\u6cd5\u901a\u8fc7\u3002\r\n\r\n#### \u8003\u8651\u4f18\u5316\uff0c\u9700\u8981\u4e24\u4e2a\u6027\u8d28\uff08\u653e\u5728\u6700\u540e\u8bc1\u660e\uff09\uff1a\r\n\r\n\r\n\u6027\u8d28 $1$\uff1a\u4efb\u610f\u65f6\u523b $f_{i, j}$ \u90fd\u5173\u4e8e $j$ \u4e0b\u51f8\u3002\r\n\r\n\r\n\u6027\u8d28 $2$\uff1a\u53ea\u8003\u8651\u4ece $1$ \u5230 $i$\uff0c\u6700\u4f18\u51b3\u7b56\u4e2d\u201c\u5728 $1$ \u5230 $(i-1)$ \u4e70\u7684\u91cf\u201d\u968f\u7740\u201c $1$ \u5230 $i$ \u4e70\u7684\u603b\u91cf\u201d\u589e\u52a0\u800c\u4e0d\u51cf\u3002\r\n\r\n\u6211\u4eec\u5b9a\u4e49\u53d8\u91cf $pos$ \u8868\u793a\u201c\u4e0a\u6b21\uff08$j$ \u8fd8\u662f $(j-1)$ \u7684\u65f6\u5019\uff09\u53d6\u5230\u6700\u4f18\u89e3\u7684\u65f6\u5019\u5728 $1$ \u5230 $(i-1)$ \u4e70\u7684\u6570\u91cf\u201d\uff0c\u5373\u201c\u5bf9\u4e8e $(j-1)$ \u7684\u6700\u4f18\u51b3\u7b56\u7684\u4f4d\u7f6e\u201d\u3002\r\n\r\n\r\n\u6709\u4e86\u6027\u8d28 $1$\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u4ece\u5934\u5f00\u59cb\u626b\uff0c\u5224\u65ad $pos$ \u4e0e $pos+1$ \u8c01\u66f4\u4f18\u5373\u53ef\u786e\u5b9a $pos$ \u662f\u5426\u662f\u5bf9\u4e8e\u5f53\u524d $j$ \u7684\u6700\u4f18\u51b3\u7b56\u3002\u76f4\u63a5\u901a\u8fc7`while(pos<j&&get(i,j,pos)>=get(i,j,pos+1)) pos++;` \u6c42\u51fa\u6700\u4f18\u89e3\u3002\r\n\r\n\u4f46\u5982\u679c\u6bcf\u6b21\u90fd\u4ece\u8ba9 $pos$ \u4ece $1$ \u5f00\u59cb\u626b\uff0c\u90a3\u4e48\u65f6\u95f4\u590d\u6742\u5ea6\u548c\u6734\u7d20 DP \u662f\u4e00\u6837\u7684\uff0c\u8fd8\u9700\u8981\u6027\u8d28\u4e8c\u6765\u4f18\u5316\uff1a\r\n\r\n\u6839\u636e\u6027\u8d28 $2$\uff0c\u6211\u4eec\u53d1\u73b0\u968f\u7740 $j$ \u589e\u5927\uff0c $pos$ \u53d6\u5230\u7684\u503c\u662f\u5355\u8c03\u4e0d\u51cf\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u53ef\u4ee5\u76f4\u63a5\u7ee7\u627f\u4e0a\u6b21\u7684 $pos$ \u5f80\u540e\u626b\uff0c\u90a3\u4e48 $pos$ \u6700\u591a\u53d8\u5316 $O(n)$ \u6b21\uff0c\u5185\u5c42\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u964d\u5230\u4e86 $O(n)$\uff0c\u518d\u7b97\u4e0a\u5916\u5c42\u679a\u4e3e\u6bcf\u5bb6\u5546\u5e97\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(nk)$\uff0c\u8f7b\u677e\u901a\u8fc7\u3002\r\n\r\nAC \u4ee3\u7801\uff1a(\u8fd8\u662f\u975e\u5e38\u77ed\u7684\uff0c\u6ca1\u600e\u4e48\u538b\u884c\uff09\r\n```cpp\r\n#include<bits/stdc++.h>\r\nusing namespace std;\r\nconst int N=10010;\r\nint k,e,n;\r\nlong long f[505][N];\r\nstruct node\r\n{\r\n    int x,f,c;\r\n    bool operator<(const node &t)const{return x<t.x;}\r\n}p[N];\r\ninline long long get(int t,int i,int j) \r\n{\r\n    return f[t-1][j]+1ll*p[t].c*(i-j)+1ll*j*j*(p[t].x-p[t-1].x);\r\n}\r\nint main()\r\n{\r\n    scanf(\"%d%d%d\",&k,&e,&n);\r\n    for(int i=1;i<=n;i++) \r\n        scanf(\"%d%d%d\",&p[i].x,&p[i].f,&p[i].c);\r\n    p[++n]={e,0,0};//\u76f4\u63a5\u7b97\u5230\u5230\u5bb6\r\n    sort(p+1,p+n+1);\r\n    memset(f,0x3f,sizeof f); f[0][0]=0;\r\n    for(int i=1;i<=n;i++)\r\n        for(int j=0,pos=0;j<=k;j++)\r\n        {\r\n            while(pos<j-p[i].f) pos++;//\u4fdd\u8bc1j-pos\u662f\u53ef\u4ee5\u5728\u8fd9\u5bb6\u4e70\u5230\u7684\uff08\u5373\u4e0d\u8d85\u8fc7p[i].f)\r\n            while(pos<j&&get(i,j,pos)>=get(i,j,pos+1)) pos++;\r\n            f[i][j]=get(i,j,pos);\r\n        }\r\n    printf(\"%lld\\n\",f[n][k]);\r\n    return 0;\r\n}\r\n```\r\n#### \u6027\u8d28\u7684\u8bc1\u660e\uff1a\r\n\r\n(\u7528 $D$ \u8868\u793a\u4e24\u5bb6\u5e97\u4e4b\u95f4\u7684\u8ddd\u79bb\uff0c\u5373\u4ee3\u7801\u4e2d\u7684 `(p[t].x-p[t-1].x)` )\r\n\r\n\r\n\u6027\u8d28 $1$\uff1a\u4ece $f_{i - 1}$ \u5230 $f_i$\uff0c\u9996\u5148\u7ed9 $j$ \u4f4d\u7f6e\u4e0a\u52a0\u4e0a\u4e86 $Dj ^ 2$\uff0c\u53c8\u548c $y = c_ix (0\\leq x\\leq f_i)$ \u505a\u4e86\u95f5\u53ef\u592b\u65af\u57fa\u548c\uff08\u95f5\u53ef\u592b\u65af\u57fa\u548c\u5c31\u662f\u201c\u4e24\u4e2a\u6b27\u51e0\u91cc\u5f97\u7a7a\u95f4\u7684\u70b9\u96c6\u7684\u548c\u201d\uff0c\u8be6\u7ec6\u89e3\u91ca\u53ca\u6027\u8d28\u53ef\u4ee5\u67e5\u627e\u76f8\u5173\u535a\u5ba2\u5427\uff09\uff0c $y = c_ix (0\\leq x\\leq f_i)$ \u662f\u4e00\u6b21\u51fd\u6570\uff0c$Dj^2$ \u662f\u4e8c\u6b21\u51fd\u6570\uff0c\u6240\u4ee5\u90fd\u662f\u51f8\u7684\u3002\u4e24\u4e2a\u51f8\u5305\u7684\u95f5\u53ef\u592b\u65af\u57fa\u548c\u8fd8\u662f\u51f8\u5305\uff0c\u6240\u4ee5\u8fd9\u4e2a\u51fd\u6570\u662f\u51f8\u51fd\u6570\u3002\r\n\r\n\u6027\u8d28 $2$:\u7ed3\u5408\u51f8\u6027\u548c\u53cd\u8bc1\u6cd5\u8bc1\u660e\uff0c\u5982\u679c  $f_{i, j}$ \u7684\u51b3\u7b56\u70b9\u4e3a $pos$\uff0c$f_{i, j'}$ \u7684\u51b3\u7b56\u70b9\u4e3a $pos'$\uff0c\u82e5 $j < j'$ \u4e14 $pos>pos'$\uff0c\u53d1\u73b0\u4ece $pos'$ \u8f6c\u79fb\u5230 $f_{i, j}$ \u66f4\u4f18\uff0c\u4e0e $pos$ \u662f $f_{i , j}$ \u7684\u51b3\u7b56\u70b9\u77db\u76fe\uff0c\u6545\u4e0d\u6210\u7acb\u3002\r\n\r\n\r\n------------\r\n\r\n\r\n\u5b8c\u7ed3\u6492\u82b1\uff01\u611f\u8c22\u60a8\u7684\u9605\u8bfb\uff0c\u5982\u679c\u849f\u84bb\u6709\u5199\u9519\u7684\u5730\u65b9\uff0c\u8bf7\u795e\u7287\u4eec\u4e0d\u541d\u8d50\u6559\uff01\r\n\r\n~~\u70b9\u8d5e\u518d\u6da6\uff01~~\r\n",
        "postTime": 1662773037,
        "uid": 546246,
        "name": "E_huan",
        "ccfLevel": 8,
        "title": "P4544 Buying Feed G \u9898\u89e3"
    },
    {
        "content": "\u8003\u8651$dp$\n\n- \u72b6\u6001\uff1a\u8bbe$f_{i,j}$\u8868\u793a\u5728\u7b2c$i$\u4e2a\u5546\u5e97\u4e00\u5171\u4e70\u5230\u4e86$j$\u5428\u9972\u6599\n\n- \u8f6c\u79fb\uff1a\n\n$$f_{i,j}=\\min\\{f_{i-1,k}+k^2\\times (x_i-x_{i-1})+(j-k)\\times c_i\\}$$\n\n\u5176\u4e2d$k$\u9700\u8981\u6ee1\u8db3\u80fd\u591f\u5728\u8fd9\u4e2a\u5730\u65b9\u4e70\u5230$j-k$\u4e2a\n\n\u90a3\u4e48\u8fd9\u4e2a\u590d\u6742\u5ea6\u5e94\u8be5\u662f$O(nK^2)$\u7684\uff0c\u663e\u7136\u4e0d\u662f\u5f88\u4f18\uff0c\u8003\u8651\u8fdb\u884c\u5355\u8c03\u961f\u5217\u4f18\u5316\n\n\u8bb2\u90a3\u4e2a\u5f0f\u5b50\u505a\u4e00\u4e2a\u7b80\u5355\u7684\u53d8\u5316\uff0c\u53ef\u4ee5\u5f97\u5230\n\n$$f_{i,j}=\\min\\{f_{i-1,k}+k^2\\times(x_i-x_{i-1})-k\\times c_i\\}+j\\times c_i$$\n\n\u90a3\u4e48\u6211\u4eec\u53d1\u73b0\u8f6c\u79fb\u7684\u90e8\u5206\u53ea\u6709$i$\u548c$k$\u4e86\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u53ef\u4ee5\u5229\u7528\u5355\u8c03\u961f\u5217\u4f18\u5316\u8fd9\u4e2a$dp$\u4e86,\u590d\u6742\u5ea6$O(nK)$\n\n- \u521d\u503c\uff1a$f_{i,j}=inf,f_{0,0}=0$\uff0c\u56e0\u4e3a\u6709\u4e9b\u90e8\u5206\u662f\u4e0d\u80fd\u53d6\u5230\u7684\uff0c\u6240\u4ee5\u521d\u503c\u8981\u8bbeinf\n\n- \u7b54\u6848\uff1a\u56e0\u4e3a\u6700\u540e\u7b54\u6848\u662f\u8981\u8d70\u5230$E$\u7684\uff0c\u6240\u4ee5\u6700\u540e\u7684\u7b54\u6848\u5e94\u8be5\u662f$f_{n,K}+K^2\\times(E-x_n)$\n\n\u4ee3\u7801\uff1a\u53d8\u91cf\u540d\u6709\u70b9\u6df7\u4e71...\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n# define Rep(i,a,b) for(int i=a;i<=b;i++)\n# define _Rep(i,a,b) for(int i=a;i>=b;i--)\n# define RepG(i,u) for(int i=head[u];~i;i=e[i].next)\n\ntypedef long long ll;\n\nconst int N=505;\nconst int M=10005;\n\ntemplate<typename T> void read(T &x){\n   x=0;int f=1;\n   char c=getchar();\n   for(;!isdigit(c);c=getchar())if(c=='-')f=-1;\n   for(;isdigit(c);c=getchar())x=(x<<1)+(x<<3)+c-'0';\n    x*=f;\n}\n\n# define int long long\n\nint s,n,m;\nint f[N][M];\nint q[M],head,tail;\n\nstruct node{\n    int x,f,c;\n    bool operator < (const node &cmp)const{\n        return x<cmp.x;\n    }\n}a[N];\n\nint calc(int p,int x){\n    return f[p-1][x]+x*x*(a[p].x-a[p-1].x)-a[p].c*x;\n}\n\nsigned main()\n{\n    memset(f,0x3f,sizeof(f));\n    read(s),read(n),read(m);\n    Rep(i,1,m)read(a[i].x),read(a[i].f),read(a[i].c);\n    sort(a+1,a+m+1);\n    f[0][0]=0;\n    Rep(i,1,m){\n        head=1,tail=0;\n        Rep(j,0,s){\n            while(head<=tail&&calc(i,q[tail])>calc(i,j))tail--;\n            while(head<=tail&&q[head]<j-a[i].f)head++;\n            q[++tail]=j;\n            f[i][j]=calc(i,q[head])+a[i].c*j;\n        }\n    }\n    printf(\"%lld\\n\",f[m][s]+s*s*(n-a[m].x));\n    return 0;\n}\n```\n",
        "postTime": 1590056683,
        "uid": 97344,
        "name": "devout",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4544 \u3010[USACO10NOV]Buying Feed G\u3011"
    },
    {
        "content": "\u65f6\u95f4\u590d\u6742\u5ea6\uff1aO(EKlogF)\n\n\u672c\u9898\u4e00\u770b\uff0c\u5927\u81f4\u65b9\u5411\u4fbf\u662fDP\u3002\n\n\u8003\u8651\u72b6\u6001\u5b9a\u4e49\uff1af[i][j]\u8868\u793a\u5230\u4e86\u91cc\u8d77\u70b9i\u4e2a\u5355\u4f4d\u7684\u5730\u65b9\uff0c\u5e26\u7740j\u7684\u9972\u6599\u7684\u6700\u5c0f\u82b1\u8d39\u3002\n\n\u521d\u59cb\u5316\uff1af[i][j]=INF\uff0cf[0][0]=0\n\n\u63a5\u7740\u8003\u8651\u8f6c\u79fb\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2af[i][j]\uff0c\u5b83\u53ef\u4ee5\u9009\u62e9\u4e0d\u4e70\uff0c\u4ecef[i-1][j]\u8f6c\u79fb\u8fc7\u6765\uff1b\u5982\u679c\u7b2ci\u4e2a\u70b9\u6709\u5546\u5e97\uff0c\u53ef\u4ee5\u9009\u62e9\u4e70\u3002\u4e8e\u662f\u53ef\u4ee5\u5148\u9884\u5904\u7406\u5546\u5e97\u7684\u5750\u6807\uff0c\u5c06\u5176\u6309\u7167\u79bb\u8d77\u70b9\u7684\u8ddd\u79bb\u6392\u5e8f\uff0c\u8fd9\u6837\u5c31\u80fd\u4fbf\u6377\u7684\u5224\u65ad\u5f53\u524d\u7684i\u6709\u6ca1\u6709\u5546\u5e97\u3002\n\n\u5982\u679c\u6ca1\u6709\u5546\u5e97\uff0cf[i][j]=f[i-1][j]+j\u00d7j\n\n\u5982\u679c\u6709\u5546\u5e97\uff0c\u53ef\u4ee5\u8d2d\u4e70\u4e0d\u8d85\u8fc7\u5546\u5e97\u603b\u91cf\u7684\u4efb\u610f\u8d28\u91cf\u7684\u9972\u6599\uff0c\u4e8e\u662f\u60f3\u5230\u901a\u8fc7\u591a\u91cd\u80cc\u5305\u6765\u8f6c\u79fb\u3002\u4e00\u79cd\u662f\u6734\u7d20\u7684\uff0c\u628a\u591a\u91cd\u80cc\u5305\u5f53\u4f5c01\u80cc\u5305\u505a\uff0c\u6bcf\u6b21\u653e\u51651\u4e2a\u9972\u6599\uff0c\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f500\u00d710000\u00d710000\u80af\u5b9a\u8981\u70b8\uff1b\u4e8e\u662f\u4f7f\u7528\u4e8c\u8fdb\u5236\u4f18\u5316\u3002\n\n\u6570\u5b66\u539f\u7406\uff1a\u4e00\u4e2a\u6570\u53ef\u4ee5\u901a\u8fc71+2+4+8+16+..+2^k+t\u7ec4\u6210\n\n\u4e8e\u662f\u5206\u522b\u54271/2/4/8/16...\u4e2a\u9972\u6599\u6253\u6210\u4e00\u4e2a\u7269\u54c1\uff0c\u4fbf\u53ef\u4ee5log10000\u8f6c\u79fb\u3002\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a500\u00d710000\u00d710\uff0c\u662f\u4e00\u4e2a50000000\u7684\u4f18\u79c0\u7b97\u6cd5\u3002\n\n\u4ee3\u7801\uff1a\n\n```\n#include<bits/stdc++.h>\n#define fsb(a,b,c) for (ull a=b;a<=c;a++)\n#define fbs(a,b,c) for (ull a=b;a>=c;a--)\n#define maxm 10100\n#define maxl 510\n#define maxn 510\n#define mem(a,b) memset(a,b,sizeof(a))\n#define INF 9999999999999999\n#define min(a,b) ((a)<(b)?(a):(b))\n#define ull long long\nusing namespace std;\null m,l,n,now,last,k=1;\null f[2][maxm];\nstruct shop{\n\tull d,c,m;\n}a[maxn];\null cmp(shop a,shop b){\n\treturn a.d<b.d;\n}\null check(ull i,ull j){\n\treturn j>=0&&f[i][j]<INF;\n}\nint main(){\n\t// freopen(\"feed.in\",\"r\",stdin);freopen(\"feed.out\",\"w\",stdout);\n\tcin>>m>>l>>n;//scanf(\"%d%d%d\",&m,&l,&n);\n\t// cout<<f[0][0];\n\t// fsb(i,1,n) scanf(\"%d%d%d\",&a[i].d,&a[i].m,&a[i].c);\n\tfsb(i,1,n) cin>>a[i].d>>a[i].m>>a[i].c;\n\tsort(a+1,a+1+n,cmp);\n\t// fsb(i,1,n) printf(\"%10d%10d%10d\\n\",a[i].d,a[i].m,a[i].c);\n\tfsb(i,0,m) f[0][i]=INF;\n\tf[0][0]=0;now=1;last=0;\n\tfsb(i,1,l){\n\t\t// printf(\"%10d\\n\",i);\n\t\tfsb(j,0,m) f[now][j]=INF;\n\t\tfsb(j,0,m) if (check(last,j)) f[now][j]=min(f[now][j],f[last][j]+j*j);//\u4e0d\u4e70\uff0c\u8f6c\u79fb\n\t\t// printf(\"%12d\",i);fsb(j,0,m) printf(\"%12d\",f[now][j]);printf(\"\\n\");\n\t\twhile (k<=n&&a[k].d==i){\n\t\t\tull t=1,tot=0;\n\t\t\twhile (1){//\u4e70\uff0c\u4e8c\u8fdb\u5236\u4f18\u5316\uff0c\u4ecef[i][ii-t]\u8f6c\u79fb\u5230f[i][ii]\n\t\t\t\ttot+=t;if (tot>a[k].m){\n\t\t\t\t\ttot-=t;break;\n\t\t\t\t}\n\t\t\t\tfbs(ii,m,t)\n\t\t\t\t\tif (check(now,ii-t))\n\t\t\t\t\t\tf[now][ii]=min(f[now][ii],f[now][ii-t]+t*a[k].c);\n\t\t\t\tt*=2;\n\t\t\t}\n\t\t\tt=a[k].m-tot;\n\t\t\tfbs(ii,m,t)\n\t\t\t\t\tif (check(now,ii-t))\n\t\t\t\t\t\tf[now][ii]=min(f[now][ii],f[now][ii-t]+t*a[k].c);\n\t\t\t// printf(\"%10d%10d%10d\\n\",a[k].d,a[k].m,a[k].c);\n\t\t\tk++;\n\t\t\t\n\t\t}\n\t\t\n\t\t// printf(\"%12d\",i);fsb(j,0,m) printf(\"%12d\",f[now][j]);printf(\"\\n\");\n\t\tswap(now,last);\n\t}\n\t// printf(\"%0.0lf\\n\",f[last][m]);\n\tcout<<f[last][m]<<endl;\n\tfclose(stdin);fclose(stdout);\n\treturn 0;\n}\n```\n\n\u6ce8\u610f\u70b9\uff1a\u6700\u5927\u53ef\u80fd\u6709500\u00d710000\u00d710000+\u7684\u82b1\u8d39\uff0c\u8981\u5f00long long\n\n\u4f18\u5316\uff1af[i]\u4ec5\u4e0ef[i-1]\u6709\u5173\uff0c\u679c\u65ad\u6eda\u52a8\u6570\u7ec4",
        "postTime": 1530772816,
        "uid": 17655,
        "name": "Sagittarius",
        "ccfLevel": 0,
        "title": "P4544 [USACO10NOV]\u8d2d\u4e70\u9972\u6599Buying Feed\u9898\u89e3|DP|\u591a\u91cd\u80cc\u5305"
    },
    {
        "content": "\u653e\u5728\u524d\u9762\uff1a\u672c\u65b9\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(nW)$ \uff0c\u5355\u8c03\u961f\u5217\u4f18\u5316 DP\u3002\u672c\u9898\u8fd8\u6709\u4e00\u9053[\u5f31\u5316\u7248](https://www.luogu.com.cn/problem/P2616)\uff0c\u6b22\u8fce\u5927\u4f6c\u5207\u5b8c\u8fd9\u9898\u987a\u4fbf\u628a\u90a3\u9898\u4e5f\u5207\u4e86\uff0c\u5e76\u6b22\u8fce\u5927\u5bb6\u6765\u8be5\u9898\u9898\u89e3\u770b\u6211\u7684[\u53e6\u4e00\u7bc7\u535a\u5ba2](https://rsdbk-husky.blog.luogu.org/luogo-p2616-usaco10janbuying-feed-ii-s)\u3002 \n\n## \u96f6. \u5b89\u5229\uff1a\n\n[\u5b89\u5229\u4e00\u4e0b\u6211\u7684\u535a\u5ba2\u3002](https://rsdbkhusky.github.io/)\n\n### \u4e00. \u53d8\u91cf\u58f0\u660e\uff1a\n\n- $W$\uff1a\u4ee3\u66ff\u9898\u76ee\u4e2d\u7684 $K$\uff0c\u5230\u5bb6\u65f6\u5e94\u5e26\u7684\u9972\u6599\u5428\u6570\uff0c\u76f8\u5f53\u4e8e\u80cc\u5305\u4e2d\u7684\u80cc\u5305\u6700\u5927\u627f\u91cd\uff08weight\uff09\u3002\n- $n$\uff1a\u4ee3\u66ff\u9898\u76ee\u4e2d\u7684 $N$\uff0c\u5546\u5e97\u6570\u91cf\uff0c\u76f8\u5f53\u4e8e\u80cc\u5305\u95ee\u9898\u4e2d\u7684\u7269\u54c1\u6570\u3002\n- $x_i$\uff1a\u540c\u9898\u76ee\u4e2d\u7684 $x_i$\u3002\n- $w_i$\uff1a\u4ee3\u66ff\u9898\u76ee\u4e2d\u7684 $f_i$\uff0c\u5546\u5e97 $i$ \u98df\u7269\u6570\u91cf\u3002\n- $v_i$\uff1a\u4ee3\u66ff\u9898\u76ee\u4e2d\u7684 $c_i$\uff0c\u5546\u5e97 $i$ \u98df\u7269\u5355\u4ef7\u3002\n\n## \u4e8c. \u601d\u8def\n\n##### 1. \u601d\u8003\u89e3\u6cd5\n\n- \u8def\u7ebf\u4e0a\u540e\u9762\u7684\u5546\u5e97\u4e0d\u4f1a\u5f71\u54cd\u8def\u7ebf\u524d\u534a\u90e8\u5206\u7684\u6700\u4f18\u89e3\uff0c**\u7b26\u5408\u65e0\u540e\u6548\u6027**\u3002\n- \u6709\u6700\u5927\u5bb9\u91cf $W$\uff0c\u6709\u53ef\u9009\u62e9\u7684\u7269\u54c1\uff0c\u6bcf\u4e2a\u7269\u54c1\u6709\u91cd\u91cf\u548c\u4ef7\u503c\uff0c\u660e\u663e\u662f\u80cc\u5305\u7c7b\u95ee\u9898\u3002\n\n\u6240\u4ee5\u8003\u8651\u80cc\u5305 DP\u3002\n\n##### 2. \u521d\u59cb\u72b6\u6001\n\n$d_{i,j}=\\begin{cases} 0~~~~~~~~~(i=0~\\land~j=0)\\\\ \\infty~~~~~~~(else) \\end{cases}$\n\n##### 3. \u7ed3\u675f\u72b6\u6001\n\n$d_{\\operatorname{home},W}$        \uff08$\\operatorname{home}$\uff1a\u89c1\u4ee3\u7801\u548c\u4ee3\u7801\u4e2d\u7684\u6ce8\u91ca\uff09\n\n##### 4. \u786e\u5b9a\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\n\n$d_{i,j}$\uff1a\u5df2\u7ecf\u7ecf\u8fc7\u524d $i$ \u4e2a\u5546\u5e97\uff08\u5df2\u5230 $i$ \u53f7\u5546\u5e97\u4e70\u4e86\u4e1c\u897f\u4f46\u8fd8\u6ca1\u6709\u5f80 $i+1$ \u53f7\u8d70\uff09\u4e14\u6070\u597d\u4e00\u5171\u4e70\u4e86 $j$ \u4efd\u98df\u7269\u65f6\u6700\u5c11\u82b1\u8d39\u7684\u8d39\u7528\u3002\n\n\u672c\u9898\u5c31\u662f\u4e00\u9053\u6539\u88c5\u7248\u7684[\u591a\u91cd\u80cc\u5305\u95ee\u9898](https://www.luogu.com.cn/problem/P1776)\uff0c\u5c31\u52a0\u4e86\u4e00\u4e2a\u8f6c\u79fb\u82b1\u8d39\uff0c\u8f6c\u79fb\u82b1\u8d39\u600e\u4e48\u6c42\u5462\uff1f$i$ \u5e97\u4e0e\u4e0a\u4e00\u5bb6\u5e97\u8ddd\u79bb\u5dee\u4e3a $x_i-x_{i-1}$\uff0c\u82e5\u5728 $i$ \u53f7\u5e97\u4e4b\u524d\u4e70\u7684\u98df\u7269\u4efd\u6570\u4e00\u5171\u4e3a $k$ \uff0c\u5728 $i$ \u5e97\u8d2d\u7269\u540e\u8f66\u4e0a\u7684\u98df\u7269\u4efd\u6570\u4e3a $j$\uff0c\u5219\u8fd9\u6bb5\u8def\u4e0a\u8f66\u8f86\u8fd0\u9001\u7684\u98df\u7269\u6570\u4e3a $k$\u3002\u8f6c\u79fb\u82b1\u8d39\u5c31\u662f $(x_i-x_{i-1})\\times k^2$\u3002\n\n\u7efc\u4e0a\u6240\u8ff0\uff0c\u6734\u7d20\u72b6\u8f6c\u65b9\u7a0b\uff1a$d_{i,j}=\\min_{k=0}^{k\\leqslant j}\\{{d_{i-1,k}+(x_i-x_{i-1})\\times k^2+v_i\\times (j-k)}\\}$ \n\n#### 5. \u5355\u8c03\u961f\u5217\u4f18\u5316\uff08\u91cd\u70b9\uff09\n\n\u679a\u4e3e $i$ \u590d\u6742\u5ea6\u4e3a $O(n)$\uff0c\u679a\u4e3e $j$ \u590d\u6742\u5ea6\u4e3a $O(W)$\uff0c\u679a\u4e3e $k$ \u6700\u574f\u60c5\u51b5\u4e0b\u590d\u6742\u5ea6\u4e5f\u662f $O(W)$\u3002\u603b\u590d\u6742\u5ea6 $O(nW^2)$ \u663e\u7136\u4f1a\u8d85\u3002\u90a3\u4e48\u8ba9\u6211\u4eec\u89c2\u5bdf\u4e00\u4e0b\u72b6\u8f6c\u65b9\u7a0b\uff1a\n\n$$~~~~~~~~d_{i,j}=\\min_{k=0}^{k\\leqslant j}\\{{d_{i-1,k}+(x_i-x_{i-1})\\times k^2+v_i\\times (j-k)}\\}$$ \n\n$$\\Longrightarrow d_{i,j}=\\min_{k=0}^{k\\leqslant j}\\{{d_{i-1,k}+(x_i-x_{i-1})\\times k^2-v_i\\times k+v_i\\times j}\\}$$  \n\n**\u91cd\u70b9\u4e00** \uff1a\u89c2\u5bdf\u4e0a\u9762\u8fd9\u4e2a\u62c6\u4e86\u4e2a\u62ec\u53f7\u7684\u65b9\u7a0b\uff0c\u5de6\u8fb9\u662f\u6211\u4eec\u8981\u53bb\u6c42\u7684\u72b6\u6001\uff0c\u5728\u8be5\u72b6\u6001\u4e0b\uff0c$i$ \u548c $j$ \u662f\u5df2\u77e5\u7684\uff0c\u56e0\u4e3a\u8be5\u72b6\u6001\u5c31\u662f\u7531 $i$ \u548c $j$ \u5b9a\u4e49\u7684\uff0c$i$ \u548c $j$ \u5728\u4e00\u4e2a\u5177\u4f53\u7684\u72b6\u6001\u4e0b\u4e3a\u5e38\u91cf\uff08\u6216\u8005\u6362\u4e00\u79cd\u89e3\u91ca\uff1a$i$ \u548c $j$ \u662f\u7528 ```for``` \u5faa\u73af\u679a\u4e3e\u51fa\u6765\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u5f53\u7136\u77e5\u9053\u4ed6\u7684\u503c\uff09\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5c06 $v_i\\times j$ \u63d0\u51fa\u62ec\u53f7\u3002\u53ef\u5f97\uff1a\n\n$$\\Longrightarrow d_{i,j}=\\min_{k=0}^{k\\leqslant j}\\{{d_{i-1,k}+(x_i-x_{i-1})\\times k^2-v_i\\times k}\\}+v_i\\times j$$ \n\n**\u91cd\u70b9\u4e8c**\uff1a\u8fd9\u4e2a\u65b9\u7a0b\u4e2d\u7684\u53d8\u91cf\u53ea\u6709 $k$\uff0c\u800c\u53c8\u6709 $k\\leqslant j$\uff0c\u56e0\u4e3a\u5728 $i$ \u5e97\u8d2d\u7269\u540e\u7684\u98df\u7269\u6570\u4e0d\u53ef\u80fd\u4f4e\u4e8e\u8d2d\u7269\u524d\u3002\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528[\u5355\u8c03\u961f\u5217](https://www.luogu.com.cn/problem/P1886)\u4f18\u5316\u3002\u5355\u8c03\u961f\u5217\u4e2d\u5b58\u653e\u7684\u5c31\u662f $\\min$ \u5185\u7684\u90e8\u5206 $d_{i-1,k}+(x_i-x_{i-1})\\times k^2-v_i\\times k$ \uff08\u5728\u8fd9\u91cc\u6211\u4eec\u628a\u5b83\u79f0\u4f5c $calc_{i,k}$\uff09\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i$ \uff0c\u5c06 $j$ \u4ece $0$ \u5230 $W$ \u679a\u4e3e\u4e00\u904d\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $j$ \u5148\u5c06\u5b83\u4f5c\u4e3a $k$ \u8ba1\u7b97 $calc_{i,k}$ \u5e76\u653e\u5230\u5355\u8c03\u961f\u5217\u4e2d\uff0c\u518d\u5148\u8ba1\u7b97\u72b6\u6001 $d_{i.j}$\u3002\n\n## \u4e09. \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n\nusing namespace std;\n\n#define re register\n#define int long long\n\nconst int MAXn = 500;\nconst int MAXW = 10000;\n\ntemplate <class T> \ninline void read(T &a) {\n    register char c;while (c = getchar(), c < '0' || c >'9');register T x(c - '0');while (c = getchar(), c >= '0' && c <= '9')x = (x << 1) + (x << 3) + c - '0';a = x;  \n}\n\ntemplate <class T>\ninline T min(T a, T b) {\n\treturn a < b ? a : b;\n}\n\nstruct Shop {\n\tint x;\n\tint w;\n\tint v;\n\t\n\tShop(): x(0), w(0), v(0){}\n\tShop(int x_, int w_, int v_): x(x_), w(w_), v(v_) {}\n\tinline bool operator < (Shop &a) {\n\t\treturn this->x < a.x;\n\t}\n};\n\nShop shop[MAXn + 10];\nint W, n, d[MAXn + 10][MAXW + 10];\nint head, tail, que[MAXW + 10];\n\ninline int calc(int i, int k) {\n\treturn d[i - 1][k] + (shop[i].x - shop[i - 1].x) * k * k - shop[i].v * k;\n}\n\nsigned main() {\n\tint E;\n\tread(W), read(E), read(n);\n\tshop[0] = Shop(0, 0, 0);    //\u672c\u4eba\u5c06\u8d77\u70b9\u548c\u7ec8\u70b9\uff08\u5bb6\uff09\u65f6\u5f53\u505a\u98df\u7269\u6570\u4e3a 0 \u7684\u5546\u5e97\uff0c\u8fd9\u6837\u80fd\u907f\u514d\u7279\u5224\uff0c\u6240\u4ee5\u201chome\u201d\u5c31\u662fn+1\n\tfor (re int i = 1, x, w, v; i <= n; ++i) {\n\t\tread(x), read(w), read(v);\n\t\tshop[i] = Shop(x, w, v);\n\t}\n\tshop[n + 1] = Shop(E, 0, 0);    //\u540c\u4e0a\n\tsort(shop, shop + n + 2);\n\tmemset(d, 0x3f, sizeof(d));\n\td[0][0] = 0;\n\tfor (re int i = 1; i <= n + 1; ++i) {    //i\uff1a\u5f53\u524d\u9636\u6bb5\u662f\u5728\u54ea\u4e2a\u5e97 \n\t\thead = 1; tail = 0;\n\t\tfor (re int j = 0; j <= W; ++j) {    //j\uff1a\u5f53\u524d\u72b6\u6001\u8981\u6c42\u5728\u6b64\u5904\u5546\u5e97\u8d2d\u4e70\u540e\u8f66\u4e0a\u6709\u591a\u5c11\u9972\u6599\n            while (calc(i, que[tail]) > calc(i, j) && head <= tail)\n\t\t\t\t--tail;\n            if (j - que[head] > shop[i].w && head <= tail)\n\t\t\t\t++head;\n\t\t\tque[++tail] = j;\n            d[i][j] = calc(i, que[head]) + shop[i].v * j;\t\t\t\n\t\t}\n\t}\n\tprintf(\"%lld\", d[n + 1][W]);\n}\n```\n\n",
        "postTime": 1624888472,
        "uid": 392727,
        "name": "rsdbk_husky",
        "ccfLevel": 8,
        "title": "Luogu P4544 [USACO10NOV]Buying Feed G"
    },
    {
        "content": "\u6211\u4eec\u53d1\u73b0\uff0c \u6700\u4f18\u7684\u60c5\u51b5\u80af\u5b9a\u662f\u4ece\u5bb6\u91cc\u5f80\u524d\u8d70\uff0c\u8d70\u5230\u8981\u5230\u8fbe\u60f3\u8981\u5230\u7684\u6700\u8fdc\u7684\u5546\u5e97\uff0c \u5f80\u56de\u8d70\u7684\u65f6\u5019\u518d\u4e70\u4e1c\u897f\uff1b\n\n\u8fd9\u5c31\u63d0\u793a\u6211\u4eec\uff0c \u6211\u4eec\u8981\u5148\u5bf9\u5750\u6807\u6392\u5e8f\uff0c \u7136\u540e\u8bbedp[i][j],\u8868\u793a\u5230\u4e86\u7b2ci\u4e2a\u5546\u5e97\uff0c \u5728\u7b2ci\u4e2a\u5546\u5e97\u4e4b\u524d\u4e70\u4e86j\u4e2a\u4e1c\u897f\u7684\u6700\u5c0f\u82b1\u8d39\uff1b\n\ndp[i][j]=min(dp[i-1][p]+dis[i] * j^2+w[i-1] *(j-p));\n\nupdate:\u5f0f\u5b50\u70b8\u4e86\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u6253\u4e0d\u4e0a\uff0c\u770b\u6211[\u535a\u5ba2](https://www.cnblogs.com/zZh-Brim/p/9129917.html)\u5427\n\n\u4ec0\u4e48\u610f\u601d\u5462?\n\n\u6211\u4eec\u679a\u4e3e\u4e00\u4e2ap\uff0c \u8868\u793a\u7b2ci-1\u4e2a\u5546\u5e97\u65f6\u6709p\u4e2a\u8d27\u7269\uff0c\u90a3\u4e48\u663e\u7136\u5728i-1\u4e2a\u5546\u5e97\u4e70\u4e86(j-p)\u4e2a\u8d27\u7269\uff0c\u7b97\u4e0a\u5728\u7b2ci-1\u4e2a\u5546\u5e97\u7684\u82b1\u8d39\uff0c\u52a0\u4e0a\u4ecei-1\u5230i\u7684\u8def\u8d39\uff0c\u5c31\u662fdp[i][j]\uff1b\n\n\u590d\u6742\u5ea6nk^2\uff0c \u59a5\u59a5\u7684\u70b8\uff1b\n\n\u8003\u8651\u4f18\u5316\uff1b\n\n\u53d1\u73b0\u8f6c\u79fb\u5f0f\u5b50\u91cc\u6709min\uff0c\u81ea\u89c9\u5730\u60f3\u5230\u4e86\u5355\u8c03\u961f\u5217\uff1b\n\n\u6211\u4eec\u5bf9\u5f0f\u5b50\u8fdb\u884c\u4e00\u6ce2\u53d8\u5f62\u3002\n\ndp[i-1][p] - w[i-1]*p + dis[i]*j*j + w[i-1]*j;\n\n\u6211\u4eec\u53d1\u73b0\uff0c \u5728i\u548cj\u53d8\u5316\u7684\u65f6\u5019\uff0c\u53ea\u6709p\u662f\u5728\u53d8\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u5355\u8c03\u961f\u5217\u91cc\u653ep\uff1b\n\n\u600e\u4e48\u5904\u7406\u5462\uff1f\n\n\u5982\u679c(j-q.front() > F[i-1])\u5c31pop\u6389\u961f\u9996\uff0c \u56e0\u4e3a\u6211\u4eec\u8981\u5728i-1\u5546\u5e97\u4e70\u7684\u8d27\u7269\u5927\u4e8e\u4e86\u7b2ci-1\u4e2a\u5e97\u7684\u5e93\u5b58\uff1b\n\n\u5982\u679co=q.back(), dp[i-1][o]-w[i-1]*o >= dp[i-1][j]-w[i-1]*j, \u5c31pop\u6389\u961f\u5c3e\uff1b\u663e\u7136\uff1b\n\n(\u5199\u53cd\u4e86\u8fd9\u4e2a\u2191\u8fd8\u80fdA\uff0c \u6570\u636e\u592a\u6c34\u4e86)\n\n\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8981\u628a\u81ea\u5df1\u7684\u5bb6\u4e5f\u5f53\u6210\u4e00\u4e2a\u70b9\uff0c\u8fd9\u6837dp[n][k]\u624d\u662f\u6700\u540e\u7684\u7b54\u6848\uff01\n\n\u7136\u540e\u6ce8\u610f\u5f00long long\uff1b\n\nCode:\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <queue>\nusing namespace std;\n#define int long long\n\ninline int read()\n{\n    int res=0;bool fl=0;char ch=getchar();\n    while(!isdigit(ch)){if(ch=='-')fl=1;ch=getchar();\n    }while(isdigit(ch)){res=(res<<3)+(res<<1)+(ch-'0');ch=getchar();\n    }return fl?-res:res;\n}\n\nint n, k, e;\n\nstruct date\n{\n    int pos;\n    int F;\n    int w;\n    friend bool operator <(date a, date b)\n    {\n        return a.pos < b.pos;\n    }\n}fam[1000010];\n\nint dp[510][10010];\n\nsigned main()\n{\n    k = read(), e = read(), n = read();\n    \n    for (register int i = 1 ; i <= n ; i ++)\n    {\n        fam[i].pos = read(), fam[i].F = read(), fam[i].w = read();\n    }\n    \n    fam[++n] = (date){e, 0, 0};\n    \n    sort(fam + 1, fam + 1 + n);\n    \n    memset(dp, 0x3f, sizeof dp);\n    \n    dp[0][0] = 0;\n    \n    for (register int i = 1 ; i <= n ; i ++)\n    {\n        deque <int> q; \n        for (register int j = 0 ; j <= k ; j ++) \n        {\t\t\t\n            while (!q.empty() and j - q.front() > fam[i-1].F) q.pop_front(); //\u8981\u4e70\u7684\u5927\u4e8e\u4e0a\u4e00\u4e2a\u5e97\u7684\u5b58\u50a8 \n            if (dp[i-1][j] != 0x3f3f3f3f)\n            {\n                while (!q.empty() and dp[i-1][q.back()] - fam[i-1].w * q.back() >= dp[i-1][j] - fam[i-1].w * j) q.pop_back();\n                q.push_back(j);\n            }\n            int o = q.front();\n            if (!q.empty()) dp[i][j] = dp[i-1][o] - fam[i-1].w * o + (fam[i].pos - fam[i-1].pos) * j * j + fam[i-1].w * j;\n        }\n    }\n    \n    cout << dp[n][k] << endl;\n    return 0;\n    \n}\n\n\n```",
        "postTime": 1528020156,
        "uid": 56756,
        "name": "BriMon",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4544 \u3010[USACO10NOV]\u8d2d\u4e70\u9972\u6599Buying Feed\u3011"
    },
    {
        "content": "# #1.0 \u6734\u7d20\u7b97\u6cd5\n\n\u9996\u5148\uff0c\u6211\u4eec\u4e0d\u96be\u53d1\u73b0\uff0c\u5982\u679c\u6211\u4eec\u8981\u82b1\u8d39\u6700\u5c0f\uff0c\u5fc5\u7136\u662f\u76f4\u63a5\u4ece\u6700\u8fdc\u5904\u4e00\u8def\u76f4\u884c\u56de\u5230\u5bb6\uff0c\u4e2d\u95f4\u6ca1\u6709\u6298\u8fd4\u3002\u7531\u4e8e\u8f93\u5165\u7684\u6570\u636e\u662f\u4e71\u5e8f\uff0c\u6240\u4ee5\u6211\u4eec\u9996\u5148\u9700\u8981 ```sort()``` \u5bf9\u6570\u636e\u8fdb\u884c\u6392\u5e8f\n\n\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u8bbe\u8ba1\u72b6\u6001\uff1a\n\n$f_{i,j}$ \u8868\u793a**\u7b2c $i$ \u4e2a\u5546\u5e97\u524d\u8d2d\u4e70\u4e86 $j$ \u4ef6\u5546\u54c1\u6240\u82b1\u7684\u6700\u5c0f\u4ee3\u4ef7** \n\n\u8bbe $w_i$ \u8868\u793a\u7b2c $i-1$ \u4e2a\u5546\u5e97\u5230\u7b2c $i$ \u4e2a\u5546\u5e97\u7684\u8ddd\u79bb\uff0c$sum_i$ \u8868\u793a\u524d $i$ \u5bb6\u5e97\u53ef\u63d0\u4f9b\u7684\u5546\u54c1\u603b\u6570\uff0c\u4e0d\u96be\u5199\u51fa\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$\nf_{i,j}=\\min_{j-l_i\\leq p\\leq j}\\{f_{i-1,p}+w_i\\times j^2+c_i\\times(j-p)\\}\n$$\n\u6211\u4eec\u5148\u6765\u770b $p$ \u8303\u56f4\u7684\u7ea6\u675f\u6761\u4ef6\uff0c$l_i$ \u8868\u793a\u5546\u5e97 $i$ \u7684\u5546\u54c1\u6570\u91cf\u4e0a\u9650\uff0c\u663e\u7136\u5e94\u6709 $j-p<l_i$\uff0c\u4e14\u6839\u636e\u72b6\u6001\u7684\u5047\u8bbe\uff0c\u5e94\u6709 $p\\leq sum_{i-2}$\uff0c\u6240\u4ee5\u5176\u5b9e\u8303\u56f4\u9650\u5b9a\u5e94\u8be5\u662f $j-li\\leq p\\leq \\min\\{j,sum_{i-2}\\}.$\n\n\u800c\u4e14\u8981\u6ce8\u610f\uff0c\u56e0\u4e3a\u72b6\u6001\u7684\u8bbe\u8ba1\u662f*\u7b2c $i$ \u4e2a\u5546\u5e97**\u524d***\uff0c\u6240\u4ee5\u8981\u6c42\u5230 $f_{n+1,k}$\n\n\u4e0d\u96be\u5199\u51fa\u4ee3\u7801\uff1a\n\n``` cpp\n/*80pts*/\nconst int N = 510;\nconst int INF = 0x3fffffff;\n\nstruct S{\n    int x,f,c;\n    int w,sum;\n};\nS s[N];\n\nint k,e,n;\nint f[N][10010];\n\nint cmp(const S &a,const S &b){\n    return a.x < b.x;\n}\n\nint main(){\n    scanf(\"%d%d%d\",&k,&e,&n);\n    for (int i = 1;i <= n;i ++)\n      scanf(\"%d%d%d\",&s[i].x,&s[i].f,&s[i].c);\n    sort(s + 1,s + n + 1,cmp);\n    for (int i = 1;i <= n;i ++){\n        s[i].w = s[i].x - s[i - 1].x;\n        s[i].sum = s[i - 1].sum + s[i].f;\n    }\n    s[n + 1].w = e - s[n].x;\n    mset(f,0x3f); //memset\n    for (int i = 1;i <= n;i ++)\n      f[i][0] = 0;\n    for (int i = 2;i <= n + 1;i ++)\n      for (int j = 1;j <= s[i - 1].sum && j <= k;j ++)\n        for (int p = 0;p <= s[i - 2].sum && p <= j;p ++){\n            if (j - p > s[i - 1].f) continue; //\u8fd9\u91cc\u53ef\u4ee5\u76f4\u63a5\u5199\u5728\u5faa\u73af\u91cc\n            f[i][j] = min(f[i][j],f[i - 1][p] + s[i].w * j * j + s[i - 1].c * (j - p));\n        }\n    cout << f[n + 1][k];\n    return 0;\n}\n```\n\n\u8be5\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5927\u7ea6\u4e3a $O(nk^2)$\uff0c\u4e0d\u80fd\u63a5\u53d7\n\n# #2.0 \u4f18\u5316\n\n## #2.1 \u7b80\u5355\u5206\u6790\n\n\u5148\u4ece\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e0b\u624b\uff0c\u5f53\u6211\u4eec\u7814\u7a76\u6700\u5185\u5c42\u5faa\u73af $p$ \u65f6\uff0c$i,j$ \u53ef\u4ee5\u770b\u4f5c\u4e00\u4e2a\u5b9a\u503c\uff0c\u6240\u4ee5\u6709\uff1a\n$$\n\\begin{aligned}\nf_{i,j}&=\\min_{j-l_i\\leq p\\leq j}\\{f_{i-1,p}+w_i\\times j^2+c_i\\times(j-p)\\}\\\\\n&=\\min_{j-l_i\\leq p\\leq j}\\{f_{i-1,p}+w_i\\times j^2+c_i\\times j - c_i\\times p\\}\\\\\n&=\\min_{j-l_i\\leq p\\leq j}\\{f_{i-1,p}-c_i\\times p\\}+w_i\\times j^2+c_i\\times j\\\\\n\\end{aligned}\n$$\n\u663e\u7136\uff0c\u6211\u4eec\u9700\u8981\u7684\u6700\u4f18\u51b3\u7b56\u5fc5\u7136\u662f\u5f53\u524d $p$ \u7684\u53d6\u503c\u8303\u56f4\u5185 $f_{i-1,p}-c_i\\times p$ \u6700\u5c0f\u8005\u3002\n\n\u518d\u6765\u770b $p$ \u53d6\u503c\u8303\u56f4\u7684\u53d8\u5316\uff1a\u5f53 $j$ \u589e\u52a0\u4e00\u65f6\uff0c$p$ \u8303\u56f4\u7684\u4e0a\u4e0b\u754c\u7686\u589e\u52a0\u4e00\uff0c\u6709\u5927\u91cf\u7684\u91cd\u590d\u3002\n\n\u7efc\u5408\u4ee5\u4e0a\u4e24\u70b9\uff0c\u8003\u8651\u80fd\u5426\u4f7f\u7528**\u5355\u8c03\u961f\u5217**\u4f18\u5316\n\n- \u9700\u8981 $f_{i-1,p}-c_i\\times p$ \u6700\u5c0f\u8005\uff0c\u6240\u4ee5\u5e94\u7ef4\u62a4\u5355\u8c03\u961f\u5217\u4e2d $f_{i-1,p}-c_i\\times p$ **\u5355\u8c03\u589e\u52a0**\n- \u51b3\u7b56 $p$ \u7684\u8303\u56f4\u5355\u8c03\u4e0a\u5347\uff0c\u6240\u4ee5\u4e5f\u5e94\u7ef4\u62a4\u5355\u8c03\u961f\u5217\u4e2d $p$ **\u5355\u8c03\u589e\u52a0**\n\n\u663e\u7136\u4ee5\u4e0a\u4e24\u70b9\u4e2d\u53d8\u91cf\u4ec5\u6709 $p$\uff0c\u6240\u4ee5\u961f\u5217\u4e2d\u4ec5\u9700\u5b58\u50a8 $p$ \u7684\u4fe1\u606f\u3002\n\n\u5355\u8c03\u961f\u5217\u4f18\u5316\uff0c\u65e0\u975e\u662f\u4ee5\u4e0b\u4e09\u4e2a\u6b65\u9aa4\uff1a\n\n- \u68c0\u67e5\u961f\u5934\u5143\u7d20\u662f\u5426\u8fd8\u5728\u8303\u56f4\u5185\n- \u66f4\u65b0 $f_{i,j}$\n- \u5c06\u65b0\u51b3\u7b56\u52a0\u5165\u961f\u5217\uff0c\u540c\u65f6\u7ef4\u62a4\u961f\u5217\u5355\u8c03\u6027\n  - \u56e0\u4e3a $p$ \u7684\u53d6\u503c\u8303\u56f4\u662f\u95ed\u533a\u95f4 $[j-l_i,j]$ \u6240\u4ee5\u6bcf\u6b21\u52a0\u5165\u7684\u65b0\u51b3\u7b56\u5e94\u8be5\u662f $j+1$\uff0c\u4e14\u5faa\u73af\u5e94\u4ece $0$ \u5f00\u59cb\n  - \u8fd8\u8bb0\u5f97\u6211\u4eec\u4e0a\u9762\u8bf4\u8fc7\u5e94\u6709 $p\\leq sum_{i-2}$ \u5417\uff1f\u6240\u4ee5\u5982\u679c $j+1>sum_{i-2}$\uff0c\u8be5\u51b3\u7b56\u5fc5\u7136\u4e0d\u80fd\u6210\u7acb\uff0c\u53ef\u76f4\u63a5\u653e\u5f03\n\n## #2.2 \u7801\u4ee3\u7801\n\n``` cpp\nconst int N = 510;\nconst int INF = 0x3fffffff;\n\nstruct S{\n    ll x,f,c;\n    ll w,sum;\n};\nS s[N];\n\nint k,e,n;\nll f[N][10010];\nint q[10010],frt,tal= - 1;\n\nint cmp(const S &a,const S &b){\n    return a.x < b.x;\n}\n\nint main(){\n    scanf(\"%d%d%d\",&k,&e,&n);\n    for (int i = 1;i <= n;i ++)\n      scanf(\"%lld%lld%lld\",&s[i].x,&s[i].f,&s[i].c);\n    sort(s + 1,s + n + 1,cmp);\n    for (int i = 1;i <= n;i ++){\n        s[i].w = s[i].x - s[i - 1].x;\n        s[i].sum = s[i - 1].sum + s[i].f;\n    }\n    s[n + 1].w = e - s[n].x;\n    mset(f,0x3f); //memset\n    for (int i = 1;i <= n;i ++)\n      f[i][0] = 0; //\u8bb0\u5f97\u521d\u59cb\u5316\n    for (int i = 2;i <= n + 1;i ++){\n        frt = 0,tal = -1;\n        q[++ tal] = 0; //\u7b2c\u4e00\u6b21\u9009\u62e9\u663e\u7136\u6709 p=0 \u7684\u9009\u62e9\n        for (int j = 0;j <= s[i - 1].sum && j <= k;j ++){\n            while (frt <= tal && j - q[frt] > s[i - 1].f)\n              frt ++; //\u5220\u961f\u5934\n            f[i][j] = f[i - 1][q[frt]] - s[i - 1].c * q[frt] + s[i - 1].c * j + s[i].w * j * j;\n            if (j + 1 > s[i - 2].sum) continue;\n            while (frt <= tal && f[i - 1][j + 1] - s[i - 1].c * (j + 1) <= f[i - 1][q[tal]] - s[i - 1].c * q[tal])\n              tal --; //\u53bb\u961f\u5c3e\n            q[++ tal] = j + 1; //\u65b0\u51b3\u7b56\n        }\n    }\n    cout << f[n + 1][k];\n    return 0;\n}\n```\n\n## #2.3 \u51e0\u4e2a\u6ce8\u610f\u70b9\n\n1. ``` f[i][j] = f[i - 1][q[frt]] - s[i - 1].c * q[frt] + s[i - 1].c * j + s[i].w * j * j;```\n\n\u56e0\u4e3a\u6570\u636e\u8303\u56f4\uff0c\u4e0a\u9762\u8fd9\u53e5\u4ee3\u7801\u4e2d\uff0c```c,f,w``` \u7684\u7c7b\u578b\u5fc5\u987b\u90fd\u662f ```long long```\uff0c\u4e0d\u7136\u8fd0\u7b97\u4f1a\u70b8 [\u60e8\u75db\u6559\u8bad](https://www.luogu.com.cn/record/list?pid=P4544&user=162191)\n\n2. ```cout << f[n + 1][k];```\n\n\u8981\u8f93\u51fa\u4ec0\u4e48\uff1f\n\n3. \u8bb0\u5f97\u521d\u59cb\u5316\uff0c\u4e00\u5b9a\uff01\uff01\uff01\n\n# End\n\n\u5e0c\u671b\u80fd\u7ed9\u4f60\u5e26\u6765\u6536\u83b7.",
        "postTime": 1615555701,
        "uid": 162191,
        "name": "Dfkuaid",
        "ccfLevel": 6,
        "title": "[P4544 Buying Feed G]\u9898\u89e3"
    },
    {
        "content": "~~\u4e00\u822c\u7684\u4e00\u7ef4\u80cc\u5305\u90fd\u662f\u53ef\u4ee5\u7528\u4e00\u7ef4\u6570\u7ec4\u6253\u7684~~\n\n\u9996\u5148\u5c06\u5546\u5e97\u6309\u7167\u8ddd\u79bb\u7684\u987a\u5e8f\u6392\u5e8f \u5728\u6bcf\u4e00\u4e2a\u5546\u5e97\u6211\u4eec\u90fd\u53ef\u4ee5\u9009\u62e9\u4e70\u6216\u8005\u4e0d\u4e70\uff0c\u8ba9\u6211\u4eec\u5f88\u5bb9\u6613\u60f3\u5230\u591a\u91cd\u80cc\u5305\u95ee\u9898\uff08\n\n\u8bbedp[i]\u8868\u793a\u73b0\u5728\u88c5\u4e86i\u5428\u9972\u6599\u7684\u6700\u5c0f\u82b1\u8d39\uff0c\u90a3\u6211\u4eec\u53ef\u4ee5\u7531\u80cc\u5305\u95ee\u9898\u8f7b\u677e\u7684\u5f97\u5230dp\u5f0f $dp[j]=min(dp[j]+j*j*(b[i].x-b[i-1].x),dp[j-b[i].k]+(j-b[i].k)*(j-b[i].k)*(b[i].x-b[i-1].x)+b[i].v);$\n\n\u5176\u4e2db[i].x\u8868\u793a\u5546\u5e97\u7684\u4f4d\u7f6e\uff0cv\u8868\u793a\u9972\u6599\u4ef7\u683c\uff0c\u8003\u8651\u5230n\u6bd4\u8f83\u5927\uff0c\u7528\u4e8c\u8fdb\u5236\u4f18\u5316\u5c31\u597d\u5566\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long \ninline int read()\n{\n\tchar ch=getchar();int w=1,s=0;\n\twhile(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){s=(s<<1)+(s<<3)+ch-48;ch=getchar();}\n\treturn s*w;\n}\nstruct node{\n\tll v,k,id,x;\n}a[1010],b[10010];\nll e,k,n,cnt;\nll dp[100100];\ninline bool cmp(node i,node j){\n\treturn i.x<j.x;\n}\nint main(){\n\tk=read(),e=read(),n=read();//\u6ce8\u610f\u5f00 long long\n\tfor(ll i=1;i<=n;i++){\n\t\ta[i].x=read(),a[i].k=read(),a[i].v=read();\n\t}\n\tsort(a+1,a+1+n,cmp);//\u6392\u5e8f\n\tfor(ll i=1;i<=n;i++) a[i].id=i,x[i]=a[i].x;\n\tfor(ll i=1;i<=n;i++){\n\t\tfor(ll j=1;j<=a[i].k;j<<=1){\n\t\t\ta[i].k-=j;\n\t\t\tb[++cnt].v=j*a[i].v;\n\t\t\tb[cnt].k=j;\n\t\t\tb[cnt].x=a[i].x;\n\t\t}\n\t\tif(a[i].k){\n\t\t\tb[++cnt].v=a[i].k*a[i].v;\n\t\t\tb[cnt].k=a[i].k;\n\t\t\tb[cnt].x=a[i].x;\n\t\t}\n\t}//\u901a\u4fd7\u6613\u61c2\u7684\u4e8c\u8fdb\u5236\u4f18\u5316\n\tfor(ll i=1;i<=k;i++) dp[i]=1e18;\n\tdp[0]=0;\n\tfor(ll i=1;i<=cnt;i++){\n\t\tfor(ll j=k;j>=b[i].k;j--){\n\t\t\tdp[j]=min(dp[j]+j*j*(b[i].x-b[i-1].x),dp[j-b[i].k]+(j-b[i].k)*(j-b[i].k)*(b[i].x-b[i-1].x)+b[i].v);//\u660e\u4e86\u7684dp\u5f0f\n\t\t} \n\t}\n\tcout<<dp[k]+k*k*(e-x[n]);//\u8d70\u7b2cn\u4e2a\u5546\u5e97\u5230\u7ec8\u70b9\u7684\u8ddd\u79bb\n} \n```\n",
        "postTime": 1567384770,
        "uid": 152373,
        "name": "ariyy",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4544 \u3010[USACO10NOV]\u8d2d\u4e70\u9972\u6599Buying Feed\u3011"
    },
    {
        "content": "\u770b\u5b8c\u8fd9\u5230\u9898\uff0c\u5f88\u5bb9\u6613\u60f3\u5230\u7528\u80cc\u5305\u505a\uff0c\u5373\u8bbe\u72b6\u6001$f_{i,j}$\u8868\u793a\u524d$i$\u4e2a\u5546\u5e97\u4e00\u5171\u5e26\u4e86$j$\u5428\u8d27\u7684\u6700\u5c0f\u82b1\u8d39,\u53ea\u9700\u8981\u5148\u628a\u5546\u5e97\u7684\u4f4d\u7f6e\u6392\u4e2a\u5e8f,\u5c31\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e\u4e86,\u90a3\u4e48\u5c31\u53ef\u4ee5\u5f97\u5230\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\n\n$\\begin{cases} f_{i,j}=f_{i-1,j}+j*j*(X_i-X_{i-1}),u=0\\\\ f_{i,j}= \\underset{0\\le j\\le k,1\\le u\\le F_i}{min}(f_{i,j-u}+u*C_i) \\end{cases}$\n\n\u7b2c\u4e00\u5c42\u5faa\u73af\u679a\u4e3e\u5f53\u524d\u8d70\u5230\u7b2c$i$\u5546\u5e97\uff0c\u7b2c\u4e8c\u5c42\u5faa\u73af\u679a\u4e3e\u5f53\u524d\u4e00\u5171\u8fd0\u4e86$j$\u5428\u8d27\u7269,\u7b2c\u4e09\u5c42\u5faa\u73af\u679a\u4e3e\u5728\u5f53\u524d\u5546\u5e97\u8d2d\u4e70$u\u5428\u8d27\u7269$,\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5$O(n^3)$\u5b9e\u73b0\u8fd9\u4e2a\u7b97\u6cd5,\u5f88\u660e\u663e\u662f\u4f1a\u8d85\u65f6\u7684,\u6240\u4ee5\u60f3\u529e\u6cd5\u4f18\u5316,~~(\u901a\u8fc7\u67e5\u770b\u6807\u7b7e)~~,\u5f88\u660e\u663e\u53ef\u4ee5\u770b\u5230,$f_{i,j}$\u53ea\u8ddf\u4e4b\u524d\u7684$f_{i,j-u}$\u6709\u5173,\u540c\u65f6\u6bcf\u4e2a$u$\u9700\u6ee1\u8db3$u+F_i>=j$,\u6240\u4ee5\u53ef\u4ee5\u8003\u8651\u5355\u8c03\u961f\u5217\u6765\u4f18\u5316,\u90a3\u4e48\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u4f1a\u964d\u4e3a$O(n^2)$,\u5177\u4f53\u7ec6\u8282\u770b\u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\nusing namespace std;\ntypedef long long ll;\n\nll dp[505][10005], q[10005], temp[10005];//\u6570\u636e\u8303\u56f4\u6700\u5927\u4f1a\u7206int,\u6240\u4ee5\u8981\u5f00long long\nint front, tail;//\u961f\u5934,\u961f\u5c3e\nstruct sta\n{\n    int x, f, c;\n    bool operator < (const sta a) const \n    {\n        return x < a.x;\n    }\n} shop[505];//\u5b58\u7684\u6bcf\u4e00\u4e2a\u5546\u5e97\n\nint main()\n{\n    int k, e, n;\n    scanf(\"%d%d%d\", &k, &e, &n);\n    for (int i = 1; i <= n; i++)\n        scanf(\"%d%d%d\", &shop[i].x, &shop[i].f, &shop[i].c);\n    sort(shop + 1, shop + 1 + n);//\u6309\u5750\u6807\u4f4d\u7f6e\u6392\u5e8f\n    memset(dp, 0x3f, sizeof(dp));\n    dp[0][0] = 0;//\u521d\u59cb\u72b6\u6001\n    for (int i = 1; i <= n; i++)\n    {\n        front = 0, tail = -1;\n        for (int j = 0; j <= k; j++)\n            temp[j] = dp[i][j] = dp[i - 1][j] + j * j * (shop[i].x - shop[i - 1].x);//\u6ce8\u610f\u5230\u8fd9\u91cc\u4e3a\u4ec0\u4e48\u9700\u8981\u91cd\u65b0\u5f00\u4e2a\u6570\u7ec4,\u56e0\u4e3a\u6bcf\u6b21\u7684$dp_{i,j}$\u662f\u7531\u4e4b\u524d\u66f4\u65b0\u6765\u7684,\u6240\u4ee5\u5982\u679c\u8fd9\u6b21\u66f4\u65b0\u4e86\u5c31\u4f1a\u5f71\u54cd\u540e\u9762\u7684\u72b6\u6001,\u6240\u4ee5\u5c31\u9700\u8981\u91cd\u65b0\u5f00\u4e2a\u6570\u7ec4\u5b58\u4e00\u4e0b,\u907f\u514d\u91cd\u590d\u66f4\u65b0\n        for (int j = 0; j <= k; j++)\n        {\n            if (front <= tail && q[front] + shop[i].f < j)\n                front++;\n            while(front <= tail && temp[q[tail]] - q[tail] * shop[i].c > temp[j] - j * shop[i].c)\n                tail--;\n            q[++tail] = j;\n            if (front <= tail)\n                dp[i][j] = min(dp[i][j], temp[q[front]] + (j - q[front]) * shop[i].c);\n        }//\u5355\u8c03\u961f\u5217\u4f18\u5316\n    }\n    printf(\"%lld\", dp[n][k] + k * k * (e - shop[n].x));\n    return 0;\n}\n```\n\n\n",
        "postTime": 1607863118,
        "uid": 277863,
        "name": "BzhH",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4544 \u3010[USACO10NOV]Buying Feed G\u3011"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://llf0703.com/p/luogu-4544.html)\n\n## \u9898\u610f\n\n\u6709 $N$ \u4e2a\u5546\u5e97\uff0c\u6bcf\u4e2a\u5546\u5e97\u5728 $X_i$\uff0c\u6709 $F_i$ \u4e2a\u7269\u54c1\uff0c\u4ef7\u683c\u4e3a $C_i$ \u5143\u3002\u5982\u679c\u8f66\u4e0a\u6709 $P$ \u4e2a\u7269\u54c1\uff0c\u6bcf\u5355\u4f4d\u8ddd\u79bb\u7684\u8fd0\u8f93\u8d39\u7528\u4e3a $P^2$ \u3002\u4ece $1\\rightarrow E$\uff0c\u8981\u6c42\u4e70 $M$ \u4e2a\u7269\u54c1\uff0c\u6c42\u6700\u5c0f\u82b1\u8d39\u3002\n\n$N,E\\le 500 \\ , \\ X_i\\le E$ \u3002\n\n## \u9898\u89e3\n\n\u5148\u628a $E$ \u770b\u6210\u4e00\u4e2a\u5546\u5e97\uff0c\u5404\u9879\u5c5e\u6027\u4e3a $X_i=E \\ , \\ F_i=C_i=0$ \u3002\u7136\u540e\u628a\u6240\u6709\u5546\u5e97\u6309 $X$ \u6392\u5e8f\u3002\n\n\u7528 $f[i][j]$ \u8868\u793a\u5230\u4e86\u7b2c $i$ \u4e2a\u5546\u5e97\uff0c\u4e4b\u524d\u4e70\u4e86 $j$ \u4e2a\u7269\u54c1\u7684\u6700\u5c0f\u82b1\u8d39\uff1b\u679a\u4e3e\u5230 $i-1$ \u4e2a\u5546\u5e97\u4e4b\u524d\u7684\u7269\u54c1\u4e2a\u6570 $k$ \uff0c\u65b9\u7a0b\u5f0f\u4e3a\uff1a\n\n$$f[i][j]=\\min_{p\\le j} f[i-1][k]+(X_i-X_{i-1})\\times j^2 + (j-k)\\times C_{i-1}$$\n\n\u628a\u4e0e $P$ \u6709\u5173\u7684\u9879\u653e\u5728\u4e00\u8d77\uff1a\n\n$$f[i][j]=\\min_{p\\le j} (f[i-1][k]-k\\times C_{i-1})+(X_i-X_{i-1})\\times j^2 + j\\times C_{i-1}$$\n\n\u5f88\u663e\u7136\u662f\u4e00\u4e2a\u5355\u8c03\u961f\u5217\u4f18\u5316DP\u4e86\u3002\u4f46\u6709\u4e9b\u7ec6\u8282\u9700\u8981\u6ce8\u610f\uff1a\n\n1. $f[i-1][j]=inf$ \u65e0\u6cd5\u8f6c\u79fb\n2. \u961f\u5217\u53ef\u80fd\u4e3a\u7a7a\u6240\u4ee5\u8ba1\u7b97\u7b54\u6848\u65f6\u9700\u8981\u5224\u65ad\n3. **$k$ \u53ef\u4ee5 $=j$\uff0c\u6240\u4ee5\u8981\u628a $j$ \u5165\u961f\u540e\u518d\u8ba1\u7b97\u7b54\u6848**\uff08~~\u6211\u7ea0\u7ed3\u4e86\u5f88\u4e45~~\uff09\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n\nusing namespace std;\n\ninline ll read()\n{\n    char ch=getchar(); ll f=1,x=0;\n    while (ch<'0' || ch>'9') { if (ch=='-') f=-1; ch=getchar(); }\n    while (ch>='0' && ch<='9') { x=x*10+ch-'0'; ch=getchar(); }\n    return f*x;\n}\n\nstruct node {\n    ll x,c,f;\n} s[505];\nconst ll inf=0x3f3f3f3f;\nll n,m,e,f[505][10005],q[10005];\n\nsigned main()\n{\n    m=read(); e=read(); n=read();\n    for (ll i=1;i<=n;i++) s[i].x=read(),s[i].f=read(),s[i].c=read();\n    s[++n]=(node){e,0,0};\n    sort(s+1,s+n+1,[](const node &x,const node &y){ return x.x<y.x; });\n    memset(f,0x3f,sizeof(f));\n    f[0][0]=0;\n    for (ll i=1;i<=n;i++)\n    {\n        ll l=1,r=1; q[1]=0; f[i][0]=0;\n        for (ll j=1;j<=m;j++)\n        {\n            while (l<=r && j-q[l]>s[i-1].f) l++; //\u5e93\u5b58\u4e0d\u8db3\n            if (f[i-1][j]!=inf)\n            {\n                while (l<=r && f[i-1][q[r]]-s[i-1].c*q[r]>=f[i-1][j]-s[i-1].c*j) r--;\n                q[++r]=j;\n            }\n            ll k=q[l];\n            if (l<=r) f[i][j]=f[i-1][k]+(s[i].x-s[i-1].x)*j*j+s[i-1].c*(j-k); //\u5148\u5165\u961f\u518d\u66f4\u65b0\u7b54\u6848\n        }\n    }\n    return !printf(\"%lld\",f[n][m]);\n}\n```",
        "postTime": 1567324537,
        "uid": 29696,
        "name": "Llf0703",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4544 \u3010[USACO10NOV]\u8d2d\u4e70\u9972\u6599Buying Feed\u3011"
    },
    {
        "content": "# \u6b64\u9898\u662f[\u8be5\u9898](https://www.luogu.org/problemnew/show/P2616)\u7684\u5347\u7ea7\u7248\uff0c\u5982\u679c\u6ca1\u6709\u505a\u8fc7\u90a3\u9898\u7684\u540c\u5b66\u5efa\u8bae\u5148\u53bb\u505a\u4e00\u4e0b\u90a3\u9898\n\n\u4eca\u5929\u8fd9\u9898\u4e5f\u662f\u6709\u70b9\u96be\u5ea6\uff0c\u4e3b\u8981\u662f\u5173\u4e8e\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u4e8b\u60c5\uff0c\u6211\u770b\u9898\u89e3\u91cc\u9762\u5927\u4f6c\u4eec\u90fd\u662f\u5f00\u4e8c\u7ef4\u6570\u7ec4\u505a\u7684\u8be5\u9898\uff0c\u7ecf[\u67d0\u4f4d\u5927\u4f6c](https://www.luogu.org/space/show?uid=54186)\u7684\u8bb2\u89e3\uff0c\u7a0d\u7a0d\u6709\u4e86\u4e00\u70b9\u9886\u4f1a\n\n\u53ea\u662f\u8fd9\u9898\u4e0e\u539f\u5148\u90a3\u9898\u7684\u4e00\u70b9\u4e0d\u540c\u5c31\u662f\u8fd9\u91cc\u9009\u53d6\u7684\u8d27\u7269\u91cd\u91cf\u4f1a\u5f71\u54cd\u4e4b\u540e\u7684\u9009\u62e9\uff0c\u5373DP\u7684\u540e\u6548\u6027\u53d1\u751f\u4e86\u6539\u53d8\uff08\u5e72\u6270\uff1f\uff09\uff0c\u5e76\u4e14\u6839\u636e\u5927\u4f6c\u7684\u5206\u6790\u5f00\u4e8c\u7ef4\u6570\u7ec4\u6709TLE\u7684\u98ce\u9669\uff0c\u5e76\u4e14\u5176\u4e2d\u7684DP\u6570\u7ec4\u6709\u4e00\u7ef4\u662f\u4ece\u4e4b\u524d\u7684\u8f6c\u79fb\u800c\u6765\uff0c\u90a3\u4e48\u53ef\u4ee5\u538b\u7f29\u4e00\u7ef4\uff0c\u6765\u8282\u7701\u65f6\u95f4\uff08\u987a\u4fbf\u8282\u7701\u7a7a\u95f4\uff09\u5e76\u4e14\u6839\u636e\u8d2a\u5fc3\u7684\u601d\u60f3\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u5bf9\u5750\u6807\u8fdb\u884c\u6392\u5e8f,\u7136\u540e\u8fdb\u884c\u5904\u7406\uff0c\u53c8\u56e0\u4e3a\u6211\u4eec\u7701\u7565\u4e86\u4e00\u7ef4\uff0c\u53ef\u4ee5\u7528\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u4e00\u4e0b\u4e4b\u524d\u7684\u6700\u503c\uff0c\u8fd9\u6837\u53ef\u4ee5\u538b\u7f29\u65f6\u95f4\u3002\n\n\n\u6211\u4eec\u7684\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\ndp[j]=min(dp[k]+k^2\u00d7a[i].x-k\u00d7a[i].c)+  j\u00d7a[i].c-j^2\u00d7a[i].x  \nmax(0,j-a[i].f)<=k<=j\n\u5c31\u662f\u628a\u539f\u5148\u66b4\u529b\u7684\u65b9\u7a0b\u62c6\u5206\u5f00\u6765\u6210\u4e3a\u4e24\u6bb5\uff0c\u7b2c\u4e00\u6bb5\u662f\u5728\u5230j\u8fd9\u4e2a\u5e97\u4e4b\u524d\u7684\u82b1\u8d39\uff0c\u7b2c\u4e8c\u6bb5\u662f\u8f6c\u79fb\uff0c\u4e4b\u524d\u90a3\u5bb6\u5e97\u7684\u72b6\u6001\u8f6c\u79fb\u5230\u5f53\u524d\u5546\u5e97\uff0c\u5e76\u4e14\u9650\u5236\u5faa\u73af\u4e0a\u9650\uff0c\u7b2c\u4e00\u6bb5\u53ef\u4ee5\u7528\u5355\u8c03\u961f\u5217\u8fdb\u884c\u7ef4\u62a4\uff08\u5373\u4e4b\u524d\u8d70\u8fc7\u7684\u6700\u77ed\u7684\u8def\uff09\n\n## \u4ee3\u7801\n```\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<cctype>\n#include<algorithm>\nusing namespace std;\ntypedef long long llx;\ninline llx read()\n{\n    llx x=0;\n    char c=getchar();\n    bool flag=0;\n    while(c<'0'||c>'9'){if(c=='-')flag=1;   c=getchar();}\n    while(c>='0'&&c<='9'){x=(x+(x<<2)<<1)+c-'0';c=getchar();}\n    return flag?-x:x;\n}\nstruct node\n{\n    llx x,f,c;\n    bool operator < (const node&T) const\n\t{\n        return T.x>x;\n    }//\u91cd\u5b9a\u4e49\u7b26\u53f7\u4ee5\u4fbf\u6392\u5e8f \n}a[505];\nllx K,E,n,head,tail;\nllx dp[100050];\npair<llx,llx> q[100050];\nint main()\n{\n\tK=read(),E=read(),n=read();\n\tfor(llx i=1;i<=n;++i)   \n    a[i].x=read(),a[i].f=read(),a[i].c=read();\n\tsort(a+1,a+1+n);\n\tmemset(dp,0x3f,sizeof(dp));\n\tdp[0]=0;\n\tfor(llx i=1;i<=n;++i)\n\t{\n\t\tllx tmp;\n\t\tllx head=1,tail=0;//\u636e\u8bf4\u7528\u6570\u7ec4\u624b\u52a8\u6a21\u62df\u961f\u5217\u53ef\u4ee5\u5feb\u4e00\u70b9\u54e6 \n\t\tfor(llx k=K;k>=max(0ll,K-a[i].f);k--)\n\t\t{\n\t\t\ttmp=dp[k]+k*k*a[i].x-k*a[i].c;\n\t\t\twhile (head<=tail&&q[tail].first>=tmp) tail--;\n            q[++tail]=make_pair(tmp,k);//\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u6700\u503c \n\t\t}\n\t    for(llx j=K;j>=0;--j)\n\t   {\n\t      if (j-a[i].f>=0)\n\t      {\n            int k=j-a[i].f;\n            tmp=dp[k]+k*k*a[i].x-k*a[i].c;\n            while (head<=tail&&q[tail].first>=tmp) tail--;\n            q[++tail]=make_pair(tmp,k);\n        }\n        while(head<=tail&&q[head].second>j) head++; \n        dp[j]=min(dp[j],q[head].first-j*j*a[i].x+j*a[i].c);\n\t    }\n    }\n\tllx ans=dp[K]+K*K*E;//\u5230\u5bb6 \n\tcout<<ans<<endl;\n}\n```\n\n\u4f60\u4eec\u53ef\u4ee5\u7b80\u5355\u7406\u89e3\u4e3a\u6211\u6bcf\u4e00\u6b21\u90fd\u662f\u56de\u5230\u539f\u70b9\u518d\u5230\u5f53\u524d\u8fd9\u4e2a\u70b9\uff0c\u4e5f\u8bb8\u8fd9\u6837\u53ef\u4ee5\u4fbf\u4e8e\u7406\u89e3\uff08~~\u6211\u4e0d\u6562\u4fdd\u8bc1\u8fd9\u6837\u597d\u7406\u89e3~~\u6bd5\u7adf\u5927\u4f6c\u5f53\u573a\u8bb2\u89e3\u7684\u786e\u662f\u8fd9\u6837\u6bd4\u8f83\u65b9\u4fbf\u7406\u89e3\uff09\n\n\u81f3\u4e8e\u4e3a\u4ec0\u4e48 typedef llx\uff0c\u662f\u4e3a\u4e86\u81f4\u656c[\u8fd9\u4f4d\u5927\u4f6c](https://www.luogu.org/space/show?uid=9290)\n\u4ee5\u4e0a\n\u6b22\u8fce\u6307\u6559",
        "postTime": 1534921714,
        "uid": 41887,
        "name": "Shikita",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4544 \u3010[USACO10NOV]\u8d2d\u4e70\u9972\u6599Buying Feed\u3011"
    },
    {
        "content": "\u4e0d\u9519\u7684\u4e00\u9053\u5355\u8c03\u961f\u5217\u4f18\u5316 dp \u7684\u7ec3\u4e60\u9898\u3002\n\n~~\u6700\u5f00\u59cb\u6211\u770b\u9519\u9898\u4e86\uff0c\u4ee5\u4e3a\u4ed6\u5bb6\u53ef\u4ee5\u5728\u5546\u5e97\u4e2d\u95f4\uff0c\u7136\u540e\u81ea\u95ed\u4e86\u534a\u4e2a\u5c0f\u65f6~~\u3002\n\n\u6613\u4e8e\u8bbe\u7f6e\u72b6\u6001 $f_{i,j}$ \u8868\u793a\u5f53\u524d\u5230\u4e86\u7b2c i \u4e2a\u5546\u5e97\u7684\u4f4d\u7f6e\uff0c\u4e14\u73b0\u5728\u643a\u5e26\u4e86 j \u5428\u9972\u6599\u6240\u9700\u8981\u7684\u6700\u5c0f\u4ee3\u4ef7\uff08\u6211\u4eec\u5c06\u8d77\u70b9\u548c\u7ec8\u70b9\u4e5f\u89c6\u4e3a\u5546\u5e97\uff0c\u5e93\u5b58\u4e3a 0\uff09\u3002\n\n\u6734\u7d20\u7684\u8f6c\u79fb\u65b9\u7a0b\u5f88\u597d\u60f3\uff1a\n\n$f_{i,j}=\\min \\limits_{k + F_i \\geq j}(f_{i - 1,k}+k^2 \\times (X_i - X_{i - 1}) + (j - k) \\times C_i)$\n\n\u5373\u679a\u4e3e\u5230\u5f53\u524d\u7684\u5546\u5e97\u4e3a\u6b62\u7684\u643a\u5e26\u6570\u91cf\uff0c\u548c\u5230\u4e0a\u4e2a\u5546\u5e97\u4f4d\u7f6e\u7684\u643a\u5e26\u6570\u91cf\uff0c\u4e24\u8005\u4e4b\u5dee\u5373\u4e3a\u5f53\u524d\u5546\u5e97\u7684\u8d2d\u4e70\u6570\u91cf\uff0c\u6ce8\u610f\u4e0d\u80fd\u8d85\u8fc7\u5e93\u5b58\u9650\u5236\u3002\u590d\u6742\u5ea6 $O(nK^2)$\u3002\n\n\u53d1\u73b0\u4e0a\u5f0f\u4e2d\u679a\u4e3e\u7684 j \u9012\u589e\u65f6\uff0c\u5bf9\u5e94\u7684 k \u7684\u53d6\u503c\u4e5f\u662f\u4e00\u4e2a\u533a\u95f4\uff08\u4f1a\u6bd4\u539f\u6765\u589e\u51cf\u90e8\u5206\uff09\uff0c\u53ef\u4ee5\u7528\u5355\u8c03\u961f\u5217\u6765\u7ef4\u62a4\u6240\u6709\u7b26\u5408\u6761\u4ef6\u7684 $f_{i - 1,k}+k^2 \\times (X_i - X_{i - 1}) + (j - k) \\times C_i$ \u7684\u6700\u5c0f\u503c\u3002\n\n\u8fd9\u6837\u6bcf\u6b21 j \u589e\u52a0\u7684\u65f6\u5019\uff0c\u5148\u5728\u961f\u9996\u5f39\u51fa\u2018\u8fc7\u671f\u2019\u7684\u5143\u7d20\uff08\u5f53\u524d\u7684\u5546\u5e97\u5168\u90e8\u4e70\u4e86\u8fd8\u662f\u4e0d\u591f\uff0c\u5373 $k+F_i < j$\uff09\u3002\n\n\u7136\u540e\u5c06\u5230\u4e0a\u4e00\u4e2a\u5546\u5e97\u4e3a\u6b62\u643a\u5e26 j \u4e2a\u7684\u72b6\u6001\u52a0\u5165\u961f\u5217\u4e2d\u5e76\u53bb\u9664\u961f\u5c3e\u7684\u5197\u4f59\u5143\u7d20\uff08\u6240\u6709\u8f6c\u79fb\u4ee3\u4ef7\u4e0d\u4f4e\u4e8e\u643a\u5e26 j \u4e2a\u7684\u72b6\u6001\u7684\u5143\u7d20\uff09\u3002\n\n\u5206\u6790\u4e00\u4e0b\uff0c\u6bcf\u4e2a\u5143\u7d20\u81f3\u591a\u5165\u961f\u51fa\u961f\u4e00\u6b21\uff0c\u590d\u6742\u5ea6 $O(K)$\u3002\n\n\u6240\u4ee5\u603b\u590d\u6742\u5ea6\u4f18\u5316\u5230 $O(nK)$\u3002\n\nCode\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\ninline void read(int &x)\n{\n\tx = 0;\n\tint f = 0;\n\tchar ch = getchar();\n\twhile(ch < '0' || ch > '9')\n\t{\n\t\tf |= ch == '-';\n\t\tch = getchar();\n\t}\n\twhile(ch >= '0' && ch <= '9')\n\t{\n\t\tx = x * 10 + ch - 48;\n\t\tch = getchar();\n\t}\n\tx = f ? -x : x;\n\treturn;\n}\n#define inf 0x3f3f3f3f3f3f3f3f\n#define N 505\n#define V 10005\nint K, E, n;\nstruct shop\n{\n\tint pos, res, cost;\n};\nbool cmp(const shop &aa, const shop &bb)\n{\n\treturn aa.pos < bb.pos;\n}\nshop a[N];\ndeque<int> q;\nint f[N][V];\nsigned main()\n{\n\tread(K), read(E), read(n);\n\tfor(int i = 1; i <= n; i++)\n\t{\n\t\tread(a[i].pos), read(a[i].res), read(a[i].cost);\n\t}\n\ta[++n] = (shop){E, 0, 0};\n\tsort(a + 1, a + n + 1, cmp);\n\tmemset(f, 0x3f, sizeof(f));\n\tf[0][0] = 0;\n\tfor(int i = 1; i <= n; i++)\n\t{\n\t\tq.clear();\n\t\tq.push_back(0);\n\t\tf[i][0] = 0;\n\t\tfor(int j = 1; j <= K; j++)\n\t\t{\n\t\t\twhile(!q.empty() && q.front() + a[i].res < j)\n\t\t\t{\n\t\t\t\tq.pop_front();\n\t\t\t}\n\t\t\twhile(!q.empty() && f[i - 1][q.back()] + (a[i].pos - a[i - 1].pos) * q.back() * q.back() + (j - q.back()) * a[i].cost >= f[i - 1][j] + (a[i].pos - a[i - 1].pos) * j * j)\n\t\t\t{\n\t\t\t\tq.pop_back();\n\t\t\t}\n\t\t\tq.push_back(j);\n\t\t\tf[i][j] = min(f[i][j], f[i - 1][q.front()] + (a[i].pos - a[i - 1].pos) * q.front() * q.front() + (j - q.front()) * a[i].cost);\n\t\t}\n\t}\n\tprintf(\"%lld\", f[n][K]);\n\treturn 0;\n}\n```",
        "postTime": 1636814872,
        "uid": 90027,
        "name": "GG_jok_er",
        "ccfLevel": 0,
        "title": "P4544 [USACO10NOV]Buying Feed G \u9898\u89e3"
    },
    {
        "content": "- [P4544 Buying Feed](https://www.luogu.com.cn/problem/P4544) \u8fd9\u4e00\u770b\u5c31\u77e5\u9053\u662f DP \u7684\u9898\u76ee\uff0c\u5148\u8003\u8651\u66b4\u529b DP \u7684\u505a\u6cd5\u3002\u5148\u628a\u5546\u5e97\u6309\u7167\u4f4d\u7f6e\u6392\u5e8f\uff0c\u4ee5\u4fbf\u6309\u987a\u5e8f\u8fdb\u884c\u7ebf\u6027 DP\u3002\u4ee4 $f(i,j)$ \u8868\u793a\u524d $i$ \u5bb6\u5546\u5e97\u5171\u8d2d\u4e70 $j$ \u5428\u9972\u6599\uff08\u4e0d\u8003\u8651 $i+1$ \u4e4b\u540e\u7684\u8d39\u7528\uff09\u7684\u6700\u5c11\u82b1\u8d39\u3002\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\n\n  $$f(i,j)=\\min_{0\\le k\\le \\min\\{j,F_i\\}} \\{f(i-1,j-k)+C_i\\times k+(j-k)^2\\times (X_i-X_{i-1})\\}$$\n  \n  \u5176\u4e2d $k$ \u8868\u793a\u518d\u7b2c $i$ \u5bb6\u5546\u5e97\u8d2d\u4e70\u7684\u5428\u6570\u3002\u8fd9\u6837\u505a\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(K^2\\times N)$\u3002\n\n```cpp\nmemset(f, 0x3F, sizeof(f));\nfor (int i = 0; i <= n; ++i) f[i][0] = 0;\nfor (int i = 1; i <= n; ++i)\n\tfor (int j = 1; j <= t; ++j)\n\t\tfor (int k = 0; k <= min(j, a[i].R); ++k) f[i][j] = min(f[i][j], f[i - 1][j - k] + (LL)a[i].C * k + (LL)(j - k) * (j - k) * (a[i].loc - a[i - 1].loc));\n```\n\n- \u6211\u4eec\u53d1\u73b0 $i$ \u8fd9\u4e00\u7ef4\u53ef\u4ee5\u76f4\u63a5\u6eda\u6389\uff08\u6ca1\u591a\u5927\u7528\u5904\uff09\uff1a\n\n```cpp\nmemset(f, 0x3F, sizeof(f)), f[0] = 0;\nfor (int i = 1; i <= n; ++i) {\n\tfor (int j = t; j >= 1; --j) {\n\t\tLL cnt = INF;\n\t\tfor (int k = 0; k <= min(j, a[i].R); ++k) cnt = min(cnt, f[j - k] + (LL)a[i].C * k + (LL)(j - k) * (j - k) * (a[i].loc - a[i - 1].loc));\n\t\tf[j] = cnt;\n\t}\n}\n```\n- \u7136\u540e\u8003\u8651\u4f18\u5316\u3002\u9996\u5148\u628a\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u53d8\u5f62\uff1a\n\n  $$f(i,j)=\\min_{j-\\min\\{j,F_i\\}\\le k\\le j}\\{f(i-1,k)+C_i\\times (j-k)+k^2\\times (X_i-X_{i-1})\\}$$\n  \n  \u6211\u4eec\u628a $k$ \u7684\u542b\u4e49\u53d8\u4e3a\u4e86 $1\\sim i-1$ \u8d2d\u4e70\u7684\u5428\u6570\u3002\u8fd9\u6837\uff0c\u542b\u6709\u72b6\u6001\u53d8\u91cf $j$ \u7684\u9879\u548c\u542b\u6709\u51b3\u7b56\u53d8\u91cf $k$ \u7684\u9879\u5c31\u5206\u5f00\u4e86\u3002\u7136\u540e\u628a $C_i\\times (j-k)$ \u62c6\u5f00\u5c31\u53ef\u4ee5\u4e86\u3002\u7136\u540e\u5c31\u53ef\u4ee5\u6109\u5feb\u5730\u5199\u5355\u8c03\u961f\u5217\u5566\u3002\n  \n```cpp\n#include <bits/stdc++.h>\n#define LL long long\n#define N (1 << 9)\n#define T 10005\nusing namespace std;\nstruct rec {\n\tint loc, R, C;\n\tbool operator < (const rec &b) { return loc < b.loc; }\n};\nrec a[N];\nint n, m, t, q[T], Head, Tail;\nLL f[N][T];\ninline LL min(LL a, LL b) { return a < b ? a : b; }\ninline LL calc(int i, int k) { return f[i - 1][k] - (LL)a[i].C * k + (LL)k * k * (a[i].loc - a[i - 1].loc); }\nint main() {\n\tscanf(\"%d %d %d\", &t, &m, &n);\n\tfor (int i = 1; i <= n; ++i) scanf(\"%d %d %d\", &a[i].loc, &a[i].R, &a[i].C);\n\tsort(a + 1, a + n + 1);\n\tmemset(f, 0x3F, sizeof(f));\n\tfor (int i = 0; i <= n; ++i) f[i][0] = 0;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tq[Head = Tail = 1] = 0;\n\t\tfor (int j = 1; j <= t; ++j) {\n\t\t\twhile (Head <= Tail && j - min(j, a[i].R) > q[Head]) ++Head;\n\t\t\twhile (Head <= Tail && calc(i, q[Tail]) >= calc(i, j)) --Tail;\n\t\t\tq[++Tail] = j;\t\n\t\t\tf[i][j] = calc(i, q[Head]) + (LL)a[i].C * j;\n\t\t}\n\t}\n\tprintf(\"%lld\\n\", f[n][t] + (LL)(m - a[n].loc) * t * t);\n\treturn 0;\n}\n```\n",
        "postTime": 1627286586,
        "uid": 148851,
        "name": "StevenLu1103",
        "ccfLevel": 6,
        "title": "P4544 Buying Feed"
    },
    {
        "content": "### part 1 \u66b4\u529b\n\u4e0d\u96be\u53d1\u73b0\u6709\u4e00\u4e2a $\\mathcal O(K^2n)$ \u7684\u57fa\u7840 dp\uff1a\n\n$$f_{i,j+l}=\\min(f_{i,j+l},f_{i-1,j}+(x_i-x_{i-1})*j*j+c_i*l)$$\n\n\u8fd9\u5176\u4e2d f \u4ee3\u8868\u5728\u7b2c i \u4e2a\u70b9\u5df2\u7ecf\u4e70\u4e86 j+l \u4e2a\uff0c\u5176\u4e2d\u5f53\u524d\u7b2c i \u4e2a\u70b9\u4e70\u4e86 l \u4e2a\uff0c\u524d i-1 \u4e2a\u70b9\u4e70\u4e86 j \u4e2a\u7684\u6700\u5c0f\u4ef7\u503c\u3002\n\n\u8fd9\u6837\u7684\u8bdd\u53ef\u4ee5\u6c34\u5230 $90pts$\uff0c\u4f46\u662f\u5982\u679c\u662f\u8054\u8d5b\u7684\u8bdd\u5e94\u8be5\u6ca1\u6709\u8fd9\u4e48\u9ad8\u7684\u66b4\u529b\u5206\u3002\n\ncode\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define N 10005\nusing namespace std;\nint E,K,f[N],n,c[N],x[N],dp[502][N],sum[N];\nstruct mm\n{int c,x,f;}p[N];\nnamespace AYX\n{\tinline bool cmp(mm i,mm j){return i.x<j.x;}\t\n\tinline short main()\n\t{\tscanf(\"%lld%lld%lld\",&K,&E,&n);\t\n\t\tfor(int i=1;i<=n;++i)scanf(\"%lld%lld%lld\",&p[i].x,&p[i].f,&p[i].c);\n\t\tmemset(dp,0x3f3f3f3f,sizeof(dp));\n\t\tdp[1][0]=0;\n\t\tsort(p+1,p+1+n,cmp);\n\t\tp[n+1].x=E;p[n+1].f=K;\n\t\tfor(int i=1;i<=n+1;++i)sum[i]=sum[i-1]+p[i].f;\n\t\tfor(int i=2;i<=n+1;++i)\n\t\tfor(int j=0;j<=min(K,sum[i-1]);++j)\n\t\tfor(int l=0;l<=p[i-1].f;++l)\n\t\t{\tif(l+j>K)break;\n\t\t\tdp[i][j+l]=min(dp[i][j+l],dp[i-1][j]+p[i-1].c*l+(j+l)*(j+l)*(p[i].x-p[i-1].x));\n\t\t}\n\t\tprintf(\"%lld\\n\",dp[n+1][K]);\n\t\treturn 0;\n\t}\n}\nsigned main()\n{return AYX::main();\n}\n```\n### part 2 \u5355\u8c03\u961f\u5217\u4f18\u5316 dp\n\n\u5bf9\u5f0f\u5b50\u8fdb\u884c\u8f6c\u6362\uff0c\u6211\u4eec\u80fd\u591f\u5f97\u5230\uff1a\n\t\n$$f_{i,k}=\\min(f_{i,j},f_{i-1,j}+(x_i-x_{i-1})*j*j-c_i*j)+c_i*k$$\n\n\u8fd9\u6837 $c_i\\times j$ \u4f1a\u53d8\u6210\u4e00\u4e2a\u5e38\u6570\uff0c\u5f0f\u5b50\u53ea\u548c i  \u548c  j  \u6709\u5173\u3002\n\n\u91c7\u7528\u5355\u8c03\u961f\u5217\u4f7f\u590d\u6742\u5ea6\u964d\u5230 $\\mathcal O(Kn)$ \u7a33\u7a33\u901a\u8fc7\u3002\n\n\u5f53\u7136\u8fd8\u53ef\u4ee5\u7528\u4e8c\u8fdb\u5236\u4f18\u5316\u80cc\u5305\u6765\u964d\u590d\u6742\u5ea6\uff0c\u53ea\u4e0d\u8fc7\u4e0d\u5982\u5355\u8c03\u961f\u5217\u5feb\u3002\n\ncode\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define N 10005\nusing namespace std;\nint E,K,f[N],n,c[N],x[N],dp[502][N],sum[N],dui[N],head,tail;\nstruct mm\n{int c,x,f;}p[N];\nnamespace AYX\n{\tinline bool cmp(mm i,mm j){return i.x<j.x;}\t\n\tinline int calc(int i,int j)\n\t{return dp[i-1][j]+(p[i].x-p[i-1].x)*j*j-j*p[i].c;}\n\tinline short main()\n\t{\tscanf(\"%lld%lld%lld\",&K,&E,&n);\t\n\t\tfor(int i=1;i<=n;++i)scanf(\"%lld%lld%lld\",&p[i].x,&p[i].f,&p[i].c);\n\t\tmemset(dp,0x3f3f3f3f,sizeof(dp));\n\t\tdp[0][0]=0;\n\t\tsort(p+1,p+1+n,cmp);\n\t\tfor(int i=1;i<=n;++i)\n\t\t{\thead=1;tail=0;\n\t\t\tfor(int j=0;j<=K;++j)\n\t\t\t{\tint val=calc(i,j);\n\t\t\t\twhile(head<=tail and calc(i,dui[tail])>val)tail--;\n\t\t\t\twhile(head<=tail and j-p[i].f>dui[head])++head;\n\t\t\t\tdui[++tail]=j;\n\t\t\t\tdp[i][j]=calc(i,dui[head])+p[i].c*j;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%lld\\n\",dp[n][K]+(E-p[n].x)*K*K);\n\t\treturn 0;\n\t}\n}\nsigned main()\n{return AYX::main();\n}\n```\n\n   \n   \n   \n   \n   \n   \n   \n   ",
        "postTime": 1625819625,
        "uid": 464886,
        "name": "hzoi_zxb",
        "ccfLevel": 0,
        "title": "[USACO10NOV]Buying Feed G"
    },
    {
        "content": "\u5355\u8c03\u961f\u5217\u4f18\u5316 $DP$ \u7684\u597d\u9898\u3002\n## \u9898\u610f\n\n$FJ$ \u8981\u4ece $N$ \u4e2a\u5546\u5e97\u4e2d\u8d2d\u4e70 $K$ \u5428\u9972\u6599\u3002\u8bbe\u67d0\u65f6\u523b\u5df2\u7ecf\u4e70\u4e86 $X$ \u5428\u9972\u6599\uff0c\u884c\u9a76\u4e00\u516c\u91cc\u7684\u82b1\u8d39\u4e3a $X^2$ \u3002\u73b0\u5728 $FJ$ \u4ece $0$ \u8fd9\u4e2a\u4f4d\u7f6e\u51fa\u53d1\uff0c\u6700\u7ec8\u8981\u8d70\u5230 $E$ \u8fd9\u4e2a\u4f4d\u7f6e\u3002\u7ed9\u51fa\u6bcf\u4e00\u5bb6\u5546\u5e97\u7684\u4f4d\u7f6e\u3001\u9972\u6599\u7684\u5e93\u5b58\u4ee5\u53ca\u9972\u6599\u7684\u5355\u4ef7\uff0c\u6c42\u6700\u5c11\u82b1\u8d39\u3002\n\n## \u601d\u8def\n\n\u9996\u5148\u8003\u8651\u6734\u7d20\u7684\u72b6\u6001\u3002\n\n\u8bbe $f[i][j]$ \u8868\u793a\u5230\u8fbe\u7b2c $i$ \u4e2a\u5546\u5e97\u65f6\uff08**\u8fd8\u6ca1\u6709**\u5728\u7b2c $i$ \u4e2a\u5546\u5e97\u4e70\u9972\u6599\uff09\uff0c\u5df2\u7ecf\u4e70\u4e86 $j$ \u5428\u9972\u6599\u7684\u6700\u5c0f\u82b1\u8d39\u3002\u53ef\u4ee5\u5f97\u51fa\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$f[i][j]=min(f[i-1][k]+(j-k)*c[i-1]+(x[i]-x[i-1])*j*j)$\u3002\n\n\u5176\u4e2d $c[i]$ \u8868\u793a\u7b2c $i$ \u5bb6\u5546\u5e97\u7684\u552e\u4ef7\uff0c$x[i]$ \u8868\u793a\u7b2c $i$ \u5bb6\u5546\u5e97\u7684\u4f4d\u7f6e\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(nk^2)$\u3002\u4e8e\u662f\u9700\u8981\u8003\u8651\u5355\u8c03\u961f\u5217\u4f18\u5316\u3002\n\n\u5c06\u539f\u6765\u7684\u8f6c\u79fb\u65b9\u7a0b\u62c6\u5f00\uff0c\u6ce8\u610f\u5230 $((x[i]-x[i-1])*j*j+j*c[i-1])$ \u4e3a\u5e38\u6570\uff0c\u53ef\u4ee5\u4e0d\u9700\u8981\u8003\u8651\u3002\u800c\u5bf9\u4e8e\u5269\u4f59\u7684 $(f[i-1][k]-k*c[i-1])$ \u90e8\u5206\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u5355\u8c03\u961f\u5217\u4f18\u5316\u3002\u7531\u4e8e\u672c\u9898\u9700\u8981\u6c42\u6700\u5c0f\u503c\uff0c\u6545\u9700\u8981\u7ef4\u62a4\u4e00\u4e2a**\u5355\u8c03\u9012\u589e**\u7684\u961f\u5217\uff0c\u82e5\u5bf9\u5355\u8c03\u961f\u5217\u4e0d\u6e05\u695a\u53ef\u4ee5\u770b\u4e00\u770b[\u6a21\u677f\u9898](https://www.luogu.com.cn/problem/P1886)\u3002\n\n\u4f46\u662f\u4e0d\u540c\u4e8e\u7b80\u5355\u7684\u6a21\u677f\u9898\uff0c\u672c\u9898\u8fd8\u6709\u4e00\u4e2a\u9650\u5236\uff0c\u4e5f\u5c31\u662f\u53ea\u6709\u5f53 $f[i-1][j]$ \u8fd9\u79cd\u72b6\u6001**\u5408\u6cd5**\uff0c\u4e5f\u5c31\u662f\u503c\u4e0d\u4e3a\u65e0\u7a77\u5927\u7684\u65f6\u5019\uff0c\u624d\u53ef\u4ee5\u8003\u8651\u5c06\u5b83\u52a0\u5165\u961f\u5217\u4e2d\u3002\n\n\u6700\u540e\uff0c\u672c\u9898\u7684\u6570\u636e\u8303\u56f4\u6bd4\u8f83\u5927\uff0c\u522b\u5fd8\u4e86\u5f00 **long long** \u3002\n\n## code\uff1a\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<deque>\nusing namespace std;\n#define int long long\nconst int N=521; \nconst int M=10010;\nconst int INF=1e18;\nint m,e,n,f[N][M];\nstruct nlc{\n\tint x,res,c;\n\tbool operator <(const nlc &t)const{\n\t\treturn x<t.x;\n\t}\n}a[N];\ndeque<int> q;\nint min(int a,int b){return a<b?a:b;}\nint max(int a,int b){return a>b?a:b;}\nsigned main()\n{\n\t//freopen(\"233.in\",\"r\",stdin);\n\tscanf(\"%lld%lld%lld\",&m,&e,&n);\n\tfor(int i=1;i<=n;i++) scanf(\"%lld%lld%lld\",&a[i].x,&a[i].res,&a[i].c);\n\tsort(a+1,a+n+1);\n\tfor(int i=0;i<=n+1;i++)\n\t    for(int j=1;j<=m;j++)\n\t        f[i][j]=INF;\n\ta[n+1].x=e;\n\tfor(int i=1;i<=n+1;i++)\n\t{\n\t\tq.clear();\n\t\tfor(int j=0;j<=m;j++) \n\t\t{\n\t\t\twhile(q.size()&&j-q.front()>a[i-1].res) q.pop_front();\n\t\t\tif(f[i-1][j]!=INF)\n\t\t\t{\n\t\t\t\twhile(q.size()&&f[i-1][q.back()]-q.back()*a[i-1].c>=f[i-1][j]-j*a[i-1].c) q.pop_back();\n\t\t\t\tq.push_back(j);\n\t\t\t}\n\t\t\tif(q.size()) f[i][j]=f[i-1][q.front()]+(j-q.front())*a[i-1].c+(a[i].x-a[i-1].x)*j*j;\n\t\t}  \n\t}\n\tprintf(\"%lld\\n\",f[n+1][m]);\n\treturn 0;\n} \n```\n",
        "postTime": 1622550249,
        "uid": 288192,
        "name": "ListenSnow",
        "ccfLevel": 7,
        "title": "P4544 [USACO10NOV]Buying Feed G"
    }
]
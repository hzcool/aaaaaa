[
    {
        "content": "\u6211\u662f\u771f\u7684\u7eb3\u95f7\u2026\u2026\u8fd9\u660e\u663e\u5c31\u662f\u642c\u4e86 POI2011 \u7684\u7ecf\u5178\u539f\u9898\u2026\u2026\u4e3a\u4ec0\u4e48\u8fd8\u6ca1\u4eba\u5199\u51b3\u7b56\u5355\u8c03\u6027\u2026\u2026\n\n\u5728\u6211\u7684\u535a\u5ba2\u56ed\u770b\u6548\u679c\u66f4\u4f73\uff1a[\u70b9\u8fd9\u91cc](https://www.cnblogs.com/1000Suns/p/11134432.html)\n\n\u8fd9\u9898\u5176\u5b9e\u5c31\u662f $p_i=\\lceil\\max\\limits_{j}(a_j-a_i+\\sqrt{|i-j|})\\rceil$\u3002\n\n\u62c6\u6210\u4e24\u8fb9\uff0c\u5148\u53ea\u8003\u8651 $j<i$\uff0c\u7136\u540e\u53cd\u8fc7\u6765\u518d\u505a\u4e00\u904d\u3002\n\n\u7136\u540e\uff0c\u53d1\u73b0\u6ee1\u8db3\u51b3\u7b56\u5355\u8c03\u6027\u3002\u600e\u4e48\u53d1\u73b0\u7684\u5462\uff1f\n\n\u4ee4 $f_j(i)=\\sqrt{i-j}$\u3002\u4f1a\u53d1\u73b0 $f_{j_1}(i)$ \u548c $f_{j_2}(i)$ \u81f3\u591a\u53ea\u6709\u4e00\u4e2a\u4ea4\u70b9\u3002\n\n\u7136\u540e\uff0c\u7531\u4e8e\u8fd9\u91cc\u662f\u5c0f\u53d6\u4ee3\u5927\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u5355\u8c03\u961f\u5217\u3002\u7136\u540e\u53d1\u73b0\u5f0f\u5b50\u91cc\u9762\u4e0e $p_i$ \u65e0\u5173\uff0c\u6240\u4ee5\u8f6c\u79fb\u53ef\u4ee5\u6309\u4efb\u610f\u987a\u5e8f\uff0c\u90a3\u5c31\u53ef\u4ee5\u5206\u6cbb\u3002\n\n\u8fd9\u91cc\u9009\u62e9\u5206\u6cbb\uff0c\u6bd5\u7adf\u7801\u91cf\u5c0f\uff0c\u597d\u60f3\u3002\n\n$solve(l,r,L,R)$ \u8868\u793a\u6b63\u5728\u8ba1\u7b97 $[l,r]$ \u7684 $p$\uff0c\u5df2\u77e5\u51b3\u7b56\u5728 $[L,R]$ \u91cc\u9762\u3002\n\n\u53d6 $l,r$ \u7684\u4e2d\u70b9 $mid$\uff0c\u6c42\u51fa\u5176\u7684\u51b3\u7b56\u70b9 $MID$\u3002\u90a3\u4e48 $[l,mid-1]$ \u7684\u51b3\u7b56\u70b9\u80af\u5b9a\u5728 $[L,MID]$\uff0c\u90a3\u4e48\u53ef\u4ee5\u9012\u5f52 $solve(l,mid-1,L,MID)$\u3002\u540c\u7406 $solve(mid+1,r,MID,R)$\u3002\n\n\u7531\u4e8e\u53ea\u4f1a\u9012\u5f52 $\\log n$ \u5c42\uff0c\u6bcf\u5c42\u4f1a\u5faa\u73af $[L,R]$ \u7684\u5e76\u96c6\u4e5f\u5c31\u662f $[1,n]$\uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u662f $O(n\\log n)$\u3002\n\n\u5982\u679c\u628a $p_i$ \u5b58\u6210\u5b9e\u6570\uff0c\u6700\u540e\u518d\u53d6\u6574\uff0c\u90a3\u4e48\u51b3\u7b56\u70b9\u53ef\u4ee5\u770b\u4f5c\u662f\u552f\u4e00\u7684\u3002\u5c31\u4e0d\u4f1a\u51fa\u73b0\u4e00\u4e9b\u5947\u602a\u7684\u60c5\u51b5\u2026\u2026\n\n\uff08\u522b\u95ee\u6211\u4e3a\u4ec0\u4e48\u6302\u4e86\u90a3\u4e48\u4e45\u2026\u2026\uff09\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int maxn=500050;\n#define FOR(i,a,b) for(int i=(a);i<=(b);i++)\n#define ROF(i,a,b) for(int i=(a);i>=(b);i--)\n#define MEM(x,v) memset(x,v,sizeof(x))\ninline int read(){\n    int x=0,f=0;char ch=getchar();\n    while(ch<'0' || ch>'9') f|=ch=='-',ch=getchar();\n    while(ch>='0' && ch<='9') x=x*10+ch-'0',ch=getchar();\n    return f?-x:x;\n}\nint n,a[maxn];\ndouble ans[maxn];\ninline double calc(int i,int j){\n    return sqrt(i-j)+a[j]-a[i];\n}\nvoid solve(int l,int r,int L,int R){\n    if(l>r) return;\n    int mid=(l+r)>>1,p=L;\n    FOR(i,L+1,min(mid,R)) if(calc(mid,p)<calc(mid,i)) p=i;\n    ans[mid]=max(ans[mid],calc(mid,p));\n    solve(l,mid-1,L,p);\n    solve(mid+1,r,p,R);\n}\nint main(){\n    n=read();\n    FOR(i,1,n) a[i]=read();\n    solve(1,n,1,n);\n    FOR(i,1,n/2) swap(a[i],a[n-i+1]),swap(ans[i],ans[n-i+1]);\n    solve(1,n,1,n);\n    FOR(i,1,n/2) swap(a[i],a[n-i+1]),swap(ans[i],ans[n-i+1]);\n    FOR(i,1,n) printf(\"%.0lf\\n\",ceil(ans[i]));\n}\n```",
        "postTime": 1568023459,
        "uid": 72118,
        "name": "AThousandSuns",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5503 \u3010[JSOI2016]\u706f\u5854\u3011"
    },
    {
        "content": "#### \u6765\u4e00\u7bc7\u4f18\u5148\u961f\u5217\u7684~\n\n\u89c2\u5bdf\u5230 $p \\ge h_j + \\sqrt{|i - j|} - a_i$ ,\u5bf9\u4e8e\u7b2c $i$ \u4e2a\u8be2\u95ee, $a_i$ \u662f\u4e00\u5b9a\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u7ef4\u62a4 $h_j + \\sqrt{|i - j|}$ \u6700\u5927\u5c31 OK \u4e86\u3002\u5bf9\u4e8e\u7b2c $i$ \u6b21\u8be2\u95ee\uff0c\u4e0d\u96be\u53d1\u73b0\u662f\u53ef\u4ee5\u7531\u7b2c $i - 1$ \u6b21\u8f6c\u79fb\u8fc7\u6765\u7684\uff0c**\u4e14\u6bcf\u6b21\u8f6c\u79fb\u6700\u591a\u53ea\u4f1a\u66f4\u6539 $2 \\times \\sqrt{n}$ \u4e2a\u6570\uff0c\u4e0b\u6807\u5206\u522b\u4e3a $i \u3001 i + 1 \u3001i + 4 \u2026\u2026$ \u548c $i - 1\u3001i - 2\u3001i - 5 \u2026\u2026$\u3002\u5de6\u8fb9 $ + 1$ \u53f3\u8fb9 $- 1$ \u3002**\n\n\u4f46\u662f\u5355\u7eaf\u5b58\u50a8\u6700\u5927\u503c\u53ca\u5176\u6570\u91cf\u4f1a\u6302\u6389\uff0c\u4e0d\u5bb9\u6613\u8f6c\u79fb\uff08~~\u5176\u5b9e\u662f\u7b14\u8005\u592a\u83dc\u4e86~~\uff09\u3002\u5bb9\u6613\u60f3\u5230\u76f4\u63a5\u7528\u4f18\u5148\u961f\u5217\u7ef4\u62a4\u5f53\u524d\u6700\u5927\u503c\u548c\u6700\u5927\u503c\u4ee3\u8868\u7684\u4e0b\u6807\uff0c\u5982\u679c\u4e0b\u6807\u7684\u6570\u88ab\u4fee\u6539\u5219 $pop$ \u3002\n\n~~\u4f46\u662f\u5355\u7eaf\u6709\u9650\u961f\u5217\u8fd8\u662f\u4f1a\u6302~~\uff0c\u9519\u8bef\u7ed3\u679c\u662f MLE \u3002\u5982\u679c\u6bcf\u6b21\u90fd\u538b\u5165 $\\sqrt{n}$ \uff0c\u603b\u5171\u4f1a\u6709\u8d85\u8fc7 $6\\times10^7$ \u4e2a int \u3002\u6211\u4eec\u7ee7\u7eed\u601d\u8003\uff0c**\u53d1\u73b0 $h_j + \\sqrt{|i - j|} $ \u6700\u591a\u53ea\u4f1a\u88ab\u51cf\u53bb $\\sqrt{n}$ \u6b21\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u5c06 $ max_{inqueue} - (h_j + \\sqrt{|i - j|}) \\le 2 \\times \\sqrt{n}$ \uff08\u65e2\u6709\u52a0\u53c8\u6709\u51cf\uff09\u7684\u653e\u5165\u5c31\u597d\u4e86**\uff08\u5176\u5b9e\u53ef\u4ee5\u518d\u5c0f\u4e00\u70b9\uff0c\u4f30\u8ba1\u5c0f\u4e8e 100 \u4e5f\u53ef\u4ee5\u8fc7\uff09\uff0c\u5176\u4f59\u7684\u65e0\u8bba\u518d\u600e\u4e48\u653e\u4e5f\u4e0d\u4f1a\u5927\u4e8e\u76ee\u524d\u6700\u5927\u503c\u3002\n\n\u590d\u6742\u5ea6\u4e3a $ O(n \\times \\sqrt{n} * log_?)$\uff0c\u4f46\u5176\u5b9e\u8dd1\u7684\u6bd4\u4e00\u822c\u7684 $O(n\\times\\sqrt{n})$ \u8981\u5feb\u597d\u51e0\u500d\u3002\n\n## Code\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <cctype>\n#include <queue> \n#include <algorithm>\n#define ll long long\n#define inf 0x3f3f3f3f\n\nusing namespace std;\n\ninline int read(){\n\tint x=0,w=0;char ch=getchar();\n\twhile (!isdigit(ch))w|=ch=='-',ch=getchar();\n\twhile (isdigit(ch))x=(x<<1)+(x<<3)+ch-'0',ch=getchar();\n\treturn w?-x:x;\n}\n\npriority_queue <pair<int, int>, vector<pair<int, int> >, less<pair<int, int> > > que;\nint n, a[1000006], ans[1000006], dis[1000006], calc[1000006], id[1000006], tot, sum;\n\nint main(){\n//\tfreopen(\"gemo.in\",\"r\",stdin);\n//\tfreopen(\"gemo.out\",\"w\",stdout);\n\tn = read();\n\tfor(int i = 1; i <= n; i++){\n\t\ta[i] = read();\n\t}\n\tfor(int i = 1; i <= n; i++){\n\t\tint w = sqrt(i - 1);\n\t\tif(w * w != i - 1) w++;\n\t\tdis[i] = w + a[i];\n\t\tif(que.empty() || dis[i] + 319 >= que.top().first )\n\t\tque.push(make_pair(dis[i], i));\n\t}\n\tans[1] = que.top().first;\n\tfor(int i = 2; i <= n; i++){\n\t\tfor(int j = 0; j * j + i <= n; j++){\n\t\t\tint k = j * j + i;\n\t\t\tdis[k]--;\n\t\t\tif(que.empty() || dis[k] + 319 >= que.top().first )\n\t\t\tque.push(make_pair(dis[k], k));\n\t\t}\n\t\tfor(int j = 0; i - 1 - j * j >= 1; j++){\n\t\t\tint k = i - 1 - j * j;\n\t\t\tdis[k]++;\n\t\t\tif(que.empty() || dis[k] + 319 >= que.top().first )\n\t\t\tque.push(make_pair(dis[k], k));\n\t\t}\n\t\tpair <int, int> u = que.top();\n\t\twhile(dis[u.second] != u.first){\n\t\t\tque.pop();\n\t\t\tif(que.empty() ) break;\n\t\t\tu = que.top();\n\t\t}\n//\t\tu = que.top() ;\n\t\tans[i] = u.first ;\n\t}\n\tfor(int i = 1; i <= n; i++){\n\t\tans[i] = max(0, ans[i] - a[i]);\n\t\tprintf(\"%d\\n\",ans[i]);\n\t}\n    return 0;\n}\n```\n\n\u5b8c\u7ed3\u6492\u82b1\u273f\u273f\u30fd(\u00b0\u25bd\u00b0)\u30ce\u273f",
        "postTime": 1596789349,
        "uid": 209604,
        "name": "pikabi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5503 \u3010[JSOI2016]\u706f\u5854\u3011"
    },
    {
        "content": "\u8fd9\u9898\u4e00\u4e2a\u5f88\u5173\u952e\u7684\u70b9\u662f\u5bf9\u4e8e $n \\le 100000$\uff0c$\\sqrt n \\le 317$\uff0c\u5373 $\\sqrt {\\left|{i-j}\\right|}$ \u7684\u53d6\u503c\u4e0d\u4f1a\u5f88\u5927\uff0c\u56e0\u6b64\u5728\u66f4\u65b0\u7b54\u6848\u65f6\u53ef\u4ee5\u7528\u6839\u53f7\u7b97\u6cd5\u3002\n\n\u8fd9\u91cc\u63d0\u4f9b\u4e24\u79cd\u601d\u8def\uff1a\n\n\u6211\u4eec\u5148\u8f6c\u5316\u4e0b\u8fd9\u4e2a\u5f0f\u5b50\uff1a\n\n$$h_j \\le h_i + p_i - \\sqrt{\\left|{i-j}\\right|}$$\n\n$$h_i + p_i \\ge h_j + \\sqrt{\\left|{i-j}\\right|}$$\n\n\u5219\u6700\u540e\u6211\u4eec\u7684 $p_i=\\max\\{h_j + \\sqrt{\\left|{i-j}\\right|}\\}-h_i$\n\n#### \u601d\u8def\u4e00\n\n(\u672c\u601d\u8def\u6765\u81ea\u4e8e @_wkjzyc)\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u5bf9\u4e8e $\\sqrt{\\left|{i-j}\\right|}$ \u76f8\u7b49\u7684\u533a\u95f4\uff0c\u53ea\u6709\u6700\u5927\u7684 $h_j$ \u4f1a\u8d21\u732e\u7b54\u6848\uff0c\u90a3\u6211\u4eec\u53ea\u8981\u8dd1\u4e00\u4e2a RMQ \u5373\u53ef\u3002\u7531\u4e8e\u6211\u521a\u624d\u8bf4\u7684\uff0c$\\sqrt{\\left|{i-j}\\right|}$ \u53ea\u6709 $\\sqrt n$ \u79cd\u53d6\u503c\uff0c\u5219\u6574\u4e2a\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n \\sqrt n)$\u3002\n\n#### \u601d\u8def\u4e8c\n\n\u8bbe\u8ba1\u72b6\u6001 $f_i$ \u8868\u793a\u201c\u7b2c $i$ \u4e2a\u706f\u5854\u8981\u7167\u4eae\u524d $i-1$ \u5ea7\u5c71\u7684\u6700\u5c0f\u9ad8\u5ea6\uff08\u8fd9\u91cc\u662f $h_i+p_i$ \u7684\u6700\u5c0f\u9ad8\u5ea6\uff09\u201d\uff0c\u8003\u8651 dp\u3002\n\n\u660e\u663e\uff0c$f_i= \\max\\{h_j + \\sqrt{\\left|{i-j}\\right|}\\},0 \\le j < i$\u3002\n\n\u800c\u5bf9\u4e8e $f_{i-1}= \\max\\{h_j + \\sqrt{\\left|{i-j-1}\\right|}\\}$\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u5f53\u4e14\u4ec5\u5f53 $\\left|i-j-1\\right|$ \u662f\u5b8c\u5168\u5e73\u65b9\u6570\u65f6\uff0c\u624d\u4f1a\u5bf9 $f_i$ \u4ea7\u751f\u4e0e $f_{i-1}$ \u4e0d\u540c\u7684\u8d21\u732e\u3002\n\n\u8fd9\u6837\uff0c$f_i$ \u5c31\u53ef\u4ee5\u4ec5\u7531\u662f\u5b8c\u5168\u5e73\u65b9\u6570\u7684 $\\left|i-j-1\\right|$ \u8f6c\u79fb\u800c\u6765\uff0c\u8f6c\u79fb\u65b9\u7a0b\u5927\u81f4\u5982\u4e0b\uff1a\n\n$$f_i=\\max\\{f_{i-1},h_j + \\sqrt{\\left|{i-j}\\right|}\\}$$\n\n\u6ee1\u8db3 $|i-j-1| $ \u4e3a\u5b8c\u5168\u5e73\u65b9\u6570\u3002\n\n\u540c\u6837\u7684\uff0c\u53cd\u65b9\u5411\u505a\u4e00\u904d\uff0c\u4e24\u4e2a\u7b54\u6848\u91cc\u53d6 $\\max$\uff0c\u5c31\u662f\u6700\u7ec8\u7b54\u6848\u3002\n\n\u601d\u8def\u4e8c\u7684\u5b9e\u73b0\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint h[100005],f[100005],g[100005];\nint main() {\n    int n;\n    cin>>n;\n    for(int i=1; i<=n; i++) {\n        scanf(\"%d\",h+i);\n    }\n    f[1]=h[1];\n    for(int i=2; i<=n; i++) {\n        f[i]=max(f[i-1],h[i]);//\u56e0\u4e3ap[i]\u4e0d\u80fd\u53d6\u8d1f\u6570\uff0c\u6240\u4ee5f[i]\u521d\u503c\u91cc\u6700\u5c0f\u8981\u4e3ah[i]\n        for(int j=0; j*j<=i-1; j++) {\n            f[i]=max(f[i],h[i-1-(j*j)]+j+1);\n        }\n    }\n    g[n]=h[n];\n    for(int i=n-1; i; i--) {\n        g[i]=max(g[i+1],h[i]);\n        for(int j=0; j*j<=n-i-1; j++) {\n            g[i]=max(g[i],h[i+(j*j)+1]+j+1);\n        }\n    }\n    for(int i=1; i<=n; i++) {\n        printf(\"%d\\n\",max(f[i],g[i])-h[i]);\n    }\n    return 0;\n}\n```",
        "postTime": 1605963180,
        "uid": 82124,
        "name": "sfmmdm",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5503 \u3010[JSOI2016]\u706f\u5854\u3011"
    },
    {
        "content": "\u7531\u4e8e\u6839\u53f7\u7684\u5b58\u5728\uff0c\u672c\u9898\u5e76\u6ca1\u6709\u4ec0\u4e48\u660e\u663e\u7684\u5355\u8c03\u6027\uff0c\u4e0d\u80fd\u901a\u8fc7\u4e8c\u5206\u6216\u5355\u8c03\u961f\u5217\u5b9e\u73b0\u3002\n\n\u672c\u9898\u7684\u5173\u952e\u5728\u4e8e\u95ee\u9898\u8f6c\u5316\u3002\u8bb0 $l_i$ \u8868\u793a\u5728\u5c71\u5cf0 $i$ \u4e0a\u5efa\u706f\u5854\uff0c\u5e76\u4f7f\u5f97\u5c71\u5cf0 $1...i$ \u5168\u90e8\u88ab\u7167\u4eae\u7684\u6700\u5c0f\u9ad8\u5ea6\u3002\n\n$$\nh_j\\le h_i+l_i - \\sqrt{i-j} (1\\le j\\le i)\n$$\n\n$$\nh_j+\\sqrt{i-j}-h_i\\le l_i(1\\le j\\le i)\n$$\n\n$$\nl_i= \\max \\lbrace  h_j+\\lceil  (\\sqrt{i-j})  \\rceil \\rbrace-h_i\n$$\n\n\n\u8fd9\u6837 $\\{l\\}$ \u6570\u7ec4\u7684\u6c42\u89e3\u5373\u8f6c\u5316\u4e3a\u533a\u95f4\u6c42\u89e3\u6700\u503c\u95ee\u9898\uff0c\u7136\u800c $\\max$ \u51fd\u6570\u4e2d\u7684 $\\lceil  (\\sqrt{i-j})  \\rceil$ \u4f3c\u4e4e\u6709\u4e9b\u68d8\u624b\u3002\u7136\u800c\u89c2\u5bdf\u5230\u5f53 $\\lceil  (\\sqrt{i-j})  \\rceil$ \u76f8\u7b49\u65f6\uff0c\u53ea\u6709\u8be5\u533a\u95f4\u5185\u6700\u5927\u7684 $h_j$ \u624d\u4f1a\u5bf9\u7b54\u6848\u4ea7\u751f\u8d21\u732e\u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e $\\lceil  (\\sqrt{i-j})  \\rceil$ \u7684\u503c\uff0c\u6c42\u51fa\u5bf9\u5e94\u7684 $j$ \u533a\u95f4\u5185 $h_j$ \u7684\u6700\u503c\u4f5c\u4e3a $l_i$ \u7684\u5019\u9009\u7b54\u6848\u3002\n\n$r_i$ \u7684\u5b9a\u4e49\u4e0e $l_i$ \u7c7b\u4f3c\uff0c\u6700\u7ec8\u7684 $p_i$ \u5373\u4e3a $\\max \\lbrace l_i,r_i\\rbrace$ \u3002\n\n\u6c42\u89e3\u533a\u95f4\u6700\u503c\u53ef\u4ee5\u7528 ST \u8868\u5b9e\u73b0\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nint st[100005][18];\nint lg[100005];\nint power[320];\nint p[100005];\nint N;\n\ninline int query(int l, int r) {\n    int s = lg[r - l + 1];\n    return max(st[l][s], st[r - (1 << s) + 1][s]);\n}\n\nint main() {\n    lg[1] = 0;\n    for (register int i = 2; i <= 100000; ++i)\n        lg[i] = lg[i >> 1] + 1;\n    for (register int i = 1; i <= 319; ++i) {\n        power[i] = i * i;\n    }\n    scanf(\"%d\", &N);\n    for (register int i = 1; i <= N; ++i)\n        scanf(\"%d\", &st[i][0]);\n    for (register int j = 1; j <= lg[N]; ++j)\n        for (register int i = 1; i + (1 << j) - 1 <= N; ++i)\n            st[i][j] = max(st[i][j - 1], st[i + (1 << (j - 1))][j - 1]);\n    for (register int i = 1; i <= N; ++i) {\n        int delta = 0, l = i, r = i;\n        while (l >= 1) {\n            p[i] = max(p[i], query(l, r) + delta - st[i][0]);\n            r = l - 1, l = i - power[++delta];\n        }\n        if (r >= 1) p[i] = max(p[i], query(1, r) + delta - st[i][0]);\n\n    }\n    for (register int i = N; i >= 1; --i) {\n        int delta = 0, l = i, r = i;\n        while (r <= N) {\n            p[i] = max(p[i], query(l, r) + delta - st[i][0]);\n            l = r + 1, r = i + power[++delta];\n        }\n        if (l <= N) p[i] = max(p[i], query(l, N) + delta - st[i][0]);\n    }\n    for (register int i = 1; i <= N; ++i)\n        printf(\"%d\\n\", p[i]);\n    return 0;\n}\n```",
        "postTime": 1566834958,
        "uid": 116851,
        "name": "_\u98ce\u4f11\u4f4f",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5503 \u3010[JSOI2016]\u706f\u5854\u3011"
    },
    {
        "content": "\u9996\u5148\uff0c\u6211\u4eec\u5199\u51fa $p_{min}$ \u7684\u67ff\u5b50\uff1a\n\n$p_{min}=\\max \\{ h_j+\\sqrt{|i-j|}\\}-h_i$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u91cc\uff0c\u53ea\u6709 $\\sqrt{|i-j|}$ \u7684\u503c\u4e0d\u56fa\u5b9a\uff0c\u5176\u5b83\u7684\u90fd\u662f\u53ef\u4ee5\u6c42\u7684\u3002\n\n\u53c8\u89c2\u5bdf\u5230\uff0c$|i-j|< n$ \uff0c\u6240\u4ee5 $\\sqrt{|i-j|} < \\sqrt{n}$ \uff0c\u679a\u4e3e $ \\left\\lceil \\sqrt{|i-j|}\\right\\rceil$  \u7684\u590d\u6742\u5ea6\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002\n\n\u5bb9\u6613\u77e5\u9053\uff0c\u5982\u679c $\\left\\lceil \\sqrt{|i-j|}\\right\\rceil =k$\uff0c\u90a3\u4e48 $|i-j|\\in [(k-1)^2+1,k^2]$ \uff0c\u76f8\u5f53\u4e8e\u6c42 $\\{h_n \\}$ \u7684 $\\text{RMQ}$ \uff0c\u7528 $\\text{ST}$ \u8868\u53ef\u4ee5\u505a\u5230 $O(n\\log n+n \\sqrt{n})$ \u7684\u590d\u6742\u5ea6\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int NR=1e5+10;\nint n,a[NR],f[NR][20],lg[NR];\n\nvoid init(){\n\tfor(int i=1;i<=n;i++)\n\t\tlg[i]=lg[i>>1]+1,f[i][0]=a[i];\n\tfor(int i=0;i<lg[n];i++)\n\t\tfor(int j=1;j+(1<<i)<=n;j++)\n\t\t\tf[j][i+1]=max(f[j][i],f[j+(1<<i)][i]);\n}\ninline int query(int l,int r){\n\tl=max(l,1);r=min(r,n);\n\tint k=lg[r-l+1]-1;\n\treturn max(f[l][k],f[r-(1<<k)+1][k]);\n}\ninline int sq(int x){return x*x;}\n\nint main(){\n\tcin>>n;\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",&a[i]);\n\tinit();\n\tfor(int i=1;i<=n;i++){\n\t\tint ans=0;\n\t\tfor(int j=1;sq(j-1)<=i-2;j++)ans=max(ans,query(i-sq(j),i-sq(j-1)-1)-a[i]+j);\n\t\tfor(int j=1;sq(j-1)+i<n;j++)ans=max(ans,query(i+sq(j-1)+1,i+sq(j))-a[i]+j);\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n} \n```",
        "postTime": 1653737290,
        "uid": 117771,
        "name": "intel_core",
        "ccfLevel": 7,
        "title": "P5503 \u9898\u89e3"
    },
    {
        "content": "\u6211\u4eec\u76f8\u5f53\u4e8e\u8981\u6c42\u51fa \n$$f_{i}=\\max_{j=1}^n(a_j+\\sqrt{\\left|i-j\\right|})$$\n\u8fd9\u4e2a\u7edd\u5bf9\u503c\u592a\u70e6\u4eba\u4e86\n\n\u8003\u8651\u5bf9\u4e8ei>j\u548ci<j\u5206\u5f00\u505a\u3002\n\n\u5f53i>j\u65f6\uff0c\n\n$$f_{i}=\\max_{j=1}^{i-1}(a_j+\\sqrt{\\left|i-j\\right|})$$\n\n\u6ce8\u610f\u5230\u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u7684 $f_{i}=\\max_{j=1}^{i-1}f_{j}+w_{i,j}$\u7684\u5f62\u5f0f\uff0c\u8003\u8651\u51b3\u7b56\u5355\u8c03\u6027\u3002\n\n\u4e0d\u96be\u8bc1\u660e $\\sqrt{x+1} - \\sqrt{x} < \\sqrt{x} - \\sqrt{x-1}$\uff0c\n\n\u6545\u5bf9\u4e8e\u51b3\u7b56\u70b9 $p<q$ \uff0c\u4e5f\u5c31\u662f\u8bf4 $w_{i+1,p}\u2212w_{i,p}<w_{i+1,q}\u2212w_{i,p}$ \uff0c\u6ee1\u8db3\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\u3002\n\n\u90a3\u4e48\u53ef\u4ee5\u6309\u7167\u4f20\u7edf\u7684\u65b9\u6cd5\uff0c\u5728\u961f\u5217\u4e2d\u7ef4\u62a4\u51b3\u7b56\u4e09\u5143\u7ec4 ${x,l,r}$ \u8868\u793a\u5f53 $i\\in_{l,r}$ \u65f6\uff0c $f_{i}=f_{x}+\\sqrt{i-x}$ \uff0c\n\n\u6bcf\u52a0\u5165\u4e00\u4e2a\u65b0\u7684\u51b3\u7b56\u65f6\u5728\u961f\u5c3e\u5f39\u51fa\u88ab\u5f53\u524d\u51b3\u7b56\u4ee3\u66ff\u7684\u51b3\u7b56\uff0c\u7136\u540e\u5728\u6700\u540e\u4e00\u4e2a\u6709\u6548\u51b3\u7b56\u7684\u8303\u56f4\u4e0a\u4e8c\u5206\u5f97\u5230\u5f53\u524d\u51b3\u7b56\u7684\u8303\u56f4\u3002\n\n\u5f53\u6709\u8be2\u95ee\u65f6\u76f4\u63a5\u62ff\u51fa\u961f\u5934\u7684\u7b54\u6848\u5373\u53ef\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint read() {\n\tint a = 0;\n\tchar c = getchar();\n\twhile (!isdigit(c))c = getchar();\n\twhile (isdigit(c)) {\n\t\ta = a * 10 + c - 48;\n\t\tc = getchar();\n\t}\n\treturn a;\n}\n#define PII pair < int , int >\n#define st first\n#define nd second\n#define ld long double\nconst int _ = 5e5 + 3;\nint h[_], dp[_], N;\nld calc(int i, int j) {\n\treturn h[i] + sqrt(j - i);\n}\nint main() {\n\tN = read();\n\tfor (int i = 1 ; i <= N ; ++i)h[i] = read();\n\tdeque < PII > q;\n\tq.push_back(PII(1, 2));\n\tfor (int i = 2 ; i <= N ; ++i) {\n\t\tif (q.size() > 1 && q[1].nd == i)q.pop_front();\n\t\tdp[i] = ceil(calc(q[0].st, i));\n\t\tint R = N + 1;\n\t\twhile (q.size() > 1 && calc(q.back().st, q.back().nd) <= calc(i, q.back().nd)) {\n\t\t\tR = q.back().nd;\n\t\t\tq.pop_back();\n\t\t}\n\t\tint L = max(i, q.back().nd) + 1, t = q.back().st;\n\t\twhile (L < R) {\n\t\t\tint mid = ((L + R) >> 1);\n\t\t\tcalc(t, mid) > calc(i, mid) ? L = mid + 1 : R = mid;\n\t\t}\n\t\tif (R != N + 1)q.push_back(PII(i, L));\n\t}\n\treverse(h + 1, h + N + 1);\n\tq.clear();\n\tq.push_back(PII(1, 2));\n\tfor (int i = 2 ; i <= N ; ++i) {\n\t\tif (q.size() > 1 && q[1].nd == i)q.pop_front();\n\t\tdp[N - i + 1] = max(dp[N - i + 1], (int)ceil(calc(q[0].st, i)));\n\t\tint R = N + 1;\n\t\twhile (q.size() > 1 && calc(q.back().st, q.back().nd) <= calc(i, q.back().nd)) {\n\t\t\tR = q.back().nd;\n\t\t\tq.pop_back();\n\t\t}\n\t\tint L = max(i, q.back().nd) + 1, t = q.back().st;\n\t\twhile (L < R) {\n\t\t\tint mid = ((L + R) >> 1);\n\t\t\tcalc(t, mid) > calc(i, mid) ? L = mid + 1 : R = mid;\n\t\t}\n\t\tif (R != N + 1)q.push_back(PII(i, L));\n\t}\n\treverse(h + 1, h + N + 1);\n\tfor (int i = 1 ; i <= N ; ++i)printf(\"%d\\n\", max(0, dp[i] - h[i]));\n}\n```",
        "postTime": 1611801622,
        "uid": 306255,
        "name": "\u65e5\u5fa1\u8353\u7ff3",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P5503 \u3010[JSOI2016]\u706f\u5854\u3011"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5503)\n# \u9898\u76ee\u5927\u610f\n\u7ed9\u51fa\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684 $h_{1,2,...,n}$ \uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i$ \u6c42\u51fa\u6700\u5c0f\u7684 $p_i$ \u4f7f\u5f97\u6ee1\u8db3\uff1a\n\n$$\\forall j,h_j\\le h_i+p_i-\\sqrt{|i-j|}$$\n# \u601d\u8def\n\u90fd 0202 \u5e74\u4e86\uff0c\u4e3a\u4ec0\u4e48\u9898\u89e3\u91cc\u9762\u8fd8\u662f\u6ca1\u6709\u51b3\u7b56\u5355\u8c03\u6808\u7684\u505a\u6cd5\u554a\uff1f\n\n\u9996\u5148\u6211\u4eec\u53d1\u73b0\uff0c\u6211\u4eec\u53ef\u4ee5\u628a $|i-j|$ \u62c6\u5f00\uff0c\u6211\u4eec\u53ea\u8003\u8651 $i\\ge j$ \u7684\u60c5\u51b5\u4e0b\uff0c\u81f3\u4e8e $i>j$ \u76f4\u63a5\u628a\u5e8f\u5217\u7ffb\u8f6c\u518d\u505a\u4e00\u904d\u5c31\u597d\u4e86\u3002 \n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u5176\u5b9e\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u6362\u6210\u5982\u4e0b\u5f62\u5f0f\uff1a\n\n$$p_i= \\max_{j=1}^{i}\\{h_j+\\sqrt{i-j}\\}-h_i$$\n\n\u4e8e\u662f\u95ee\u9898\u5c31\u662f\u5982\u4f55\u6c42\u5230 $\\max_{j=1}^{i}\\{h_j+\\sqrt{i-j}\\}$ \uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u4e1c\u897f\u5176\u5b9e\u5b83\u662f\u6709\u51b3\u7b56\u5355\u8c03\u6027\u7684\uff0c\u56e0\u4e3a\u5f88\u663e\u7136 $\\sqrt{i-j}$ \u6bd4 $h_j$ \u589e\u957f\u901f\u7387\u66f4\u6162\u3002\u4e8e\u662f\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u51b3\u7b56\u5355\u8c03\u6808\u505a\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n\\log n)$ \u3002\uff08\u6210\u529f\u62a2\u4e0b\u8fd9\u9053\u9898\u7684 $\\text{rank1}$\n\n\u4e0d\u8fc7\u8bdd\u8bf4\u8fd9\u9053\u9898 $p_i$ \u4e4b\u95f4\u4e92\u4e0d\u5f71\u54cd\uff0c\u6240\u4ee5\u5206\u6cbb\u4e5f\u53ef\u4ee5\u3002\n# $\\texttt{Code}$\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define Int register int\n#define MAXN 100005\n\nint n,head,tail,h[MAXN];\ndouble res1[MAXN],res2[MAXN];\nstruct node{\n\tint l,r,x;\n}sta[MAXN];\ndouble contri (int i,int j){return h[j] + sqrt (i - j);}\nint bound (int i,int j){//\u627e\u5230i\u6bd4j\u66f4\u4f18\u7684\u6700\u540e\u4e00\u4e2a\u70b9 \n\tint l = max (i,j),r = n,ans = 0;\n\twhile (l <= r){\n\t\tint mid = (l + r) >> 1;\n\t\tif (contri (mid,i) >= contri (mid,j)) ans = mid,l = mid + 1;\n\t\telse r = mid - 1;\n\t}\n\treturn ans;\n}\n\nvoid Solve (double *p1){\n\tsta[head = tail = 1] = node {1,n,1};\n\tfor (Int i = 2;i <= n;++ i){\n\t\twhile (head < tail && sta[head].r < i) ++ head;\n\t\tp1[i] = contri (i,sta[head].x);\n\t\tif (contri (n,i) <= contri (n,sta[tail].x)) continue;\n\t\twhile (head < tail && contri (sta[tail].l,sta[tail].x) <= contri (sta[tail].l,i)) -- tail;\n\t\tsta[tail].r = bound (sta[tail].x,i),sta[++ tail] = node {sta[tail - 1].r + 1,n,i};\n\t}\t\n}\n\ntemplate <typename T> inline void read (T &t){t = 0;char c = getchar();int f = 1;while (c < '0' || c > '9'){if (c == '-') f = -f;c = getchar();}while (c >= '0' && c <= '9'){t = (t << 3) + (t << 1) + c - '0';c = getchar();} t *= f;}\ntemplate <typename T,typename ... Args> inline void read (T &t,Args&... args){read (t);read (args...);}\ntemplate <typename T> inline void write (T x){if (x < 0){x = -x;putchar ('-');}if (x > 9) write (x / 10);putchar (x % 10 + '0');}\ntemplate <typename T> inline T Min (T a,T b){return a > b ? b : a;} \n\nsigned main(){\n\tread (n);\n\tfor (Int i = 1;i <= n;++ i) read (h[i]);\n\tSolve (res1);reverse (h + 1,h + n + 1);Solve (res2);reverse (h + 1,h + n + 1);\n\tfor (Int i = 1,tmp;i <= n;++ i) tmp = (int)ceil (max (res1[i],res2[n - i + 1])) - h[i],write (max (tmp,0)),putchar ('\\n');\n\treturn 0;\n}\n```",
        "postTime": 1597287643,
        "uid": 124781,
        "name": "Walking_Dead",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5503 \u3010[JSOI2016]\u706f\u5854\u3011"
    },
    {
        "content": "### \u9898\u610f\n\n\u6709$n$\u5ea7\u5c71\uff0c\u7b2c$i$\u5ea7\u5c71\u7684\u9ad8\u5ea6\u4e3a$h_i$\u3002\u5b9a\u4e49\u5728\u5c71\u5cf0$i$\u5efa\u7acb\u7684\u9ad8\u5ea6\u4e3a$h$\u7684\u706f\u5854\u80fd\u591f\u7167\u4eae\u5c71\u5cf0$j$\u5f53\u4e14\u4ec5\u5f53\n\n$$h_j\\leq h_i+p-\\sqrt{\\vert i-j\\vert}$$\n\n\u6c42\u51fa\u5bf9\u4e8e\u6bcf\u4e00\u5ea7\u5c71\u5cf0\uff0c\u5efa\u7acb\u80fd\u7167\u4eae\u5176\u4ed6\u6240\u6709\u5c71\u5cf0\u7684\u706f\u5854\u7684\u6700\u5c0f\u9ad8\u5ea6\u3002\n\n$\\texttt{Data Range:}n\\leq 10^5,1\\leq h_i\\leq 10^9$\n\n### \u9898\u89e3\n\n\u597d\u4e00\u9053\u5206\u5757\u795e\u4ed9\u9898\u3002\n\n\u4e00\u5f00\u59cb\u6ca1\u60f3\u5230\uff0c\u540e\u6765\u770b\u4e86\u4e00\u4e9b\u9898\u89e3\u624d\u77e5\u9053\u505a\u7684\u3002\n\n\u6ce8\u610f\u5230\uff0c\u5bf9\u4e8e\u56fa\u5b9a\u7684$i$\uff0c$\\sqrt{\\vert i-j\\vert}$\u53ea\u6709$\\sqrt n$\u79cd\u53d6\u503c\uff0c\u800c\u6bcf\u79cd\u53d6\u503c\u5bf9\u5e94\u7684\u533a\u95f4\u957f\u5ea6\u4e5f\u662f\u6709$\\sqrt{n}$\u4e2a\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u6bcf\u4e2a\u70b9\u5411\u540e$\\sqrt{n}$\u4e2a\u6570\u7684\u6700\u5927\u503c\uff0c\u66b4\u529b\u679a\u4e3e$\\sqrt{n}$\u7684\u53d6\u503c\u6765\u66f4\u65b0\u7b54\u6848\u5c31\u597d\u5566qwq\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\sqrt{n})$\uff0c\u8981\u7a0d\u5fae\u5361\u5361\u5e38\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef int ll;\nconst ll MAXN=1e5+51;\nll cnt,pos,nxt,res;\nll num[MAXN],maxn[MAXN][651];\ninline ll read()\n{\n    register ll num=0,neg=1;\n    register char ch=getchar();\n    while(!isdigit(ch)&&ch!='-')\n    {\n        ch=getchar();\n    }\n    if(ch=='-')\n    {\n        neg=-1;\n        ch=getchar();\n    }\n    while(isdigit(ch))\n    {\n        num=(num<<3)+(num<<1)+(ch-'0');\n        ch=getchar();\n    }\n    return num*neg;\n} \ninline ll Max(ll x,ll y)\n{\n\treturn x>y?x:y;\n}\ninline ll Min(ll x,ll y)\n{\n\treturn x<y?x:y;\n}\nint main()\n{\n\tcnt=read();\n\tfor(register int i=1;i<=cnt;i++)\n\t{\n\t\tnum[i]=read();\n\t}\n\tfor(register int i=1;i<=cnt;i++)\n\t{\n\t\tmaxn[i][1]=num[i];\n\t\tfor(register int j=2;j<=min(620,cnt-i+1);j++)\n\t\t{\n\t\t\tmaxn[i][j]=Max(maxn[i][j-1],num[i+j-1]);\n\t\t}\n\t}\n\tfor(register int i=1;i<=cnt;i++)\n\t{\n\t\tnxt=res=0,pos=i;\n\t\tfor(register int j=1;pos!=1;j++)\n\t\t{\n\t\t\tnxt=pos-1,pos=Max(pos-(j<<1)+1,1);\n\t\t\tres=Max(res,maxn[pos][nxt-pos+1]-num[i]+j);\n\t\t}\n\t\tnxt=i;\n\t\tfor(register int j=1;nxt!=cnt;j++)\n\t\t{\n\t\t\tpos=nxt+1,nxt=Min(nxt+(j<<1)-1,cnt);\n\t\t\tres=Max(res,maxn[pos][nxt-pos+1]-num[i]+j);\n\t\t}\n\t\tprintf(\"%d\\n\",res);\n\t}\n}\n```",
        "postTime": 1565617997,
        "uid": 60990,
        "name": "Karry5307",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5503 \u3010[JSOI2016]\u706f\u5854\u3011"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u9053\u5584\u826f\u7684\u7701\u9009\u9898\u3002\u53ea\u9700DP\u5373\u53ef\u3002\n\n\u7ef4\u62a4\u4e24\u4e2a\u6570\u7ec4up\u548cdown\uff0cup[i]\u8868\u793a\u4ece1\u5230i\u9700\u8981\u7684\u9ad8\u5ea6\uff0cdown[i]\u8868\u793a\u4ecen\u5230i\u9700\u8981\u7684\u9ad8\u5ea6\u3002\n\n\u4ee5up\u4e3a\u4f8b\uff0c\u9996\u5148up[i] = max(h[i], up[i-1]).\n\n\u518d\u7ef4\u62a4\u4e00\u4e2a\u6307\u9488\u4ece\u5934\u626b\u4e00\u904d\uff0c\u6839\u636e\u9898\u76ee\u5316\u6839\u53f7\u4e3a\u5e73\u65b9\u66f4\u65b0\u7b54\u6848\u3002\n\ndown\u53ea\u9700\u628a\u987a\u5e8f\u6539\u4e00\u4e0b\u5373\u53ef\u3002\n\ncode\uff1a\n\n```cpp\nenum {\n\tMaxn = 100005\n};\n\nint n, h[Maxn], up[Maxn], down[Maxn];\n\nsigned main(void) {\n\t//file(\"\");\n\tread(n);\n\tfor (int i = 1; i <= n; i++) read(h[i]);\n\tfor (int i = 1, j = 0; i <= n; i++) {\n\t\tup[i] = max(h[i], up[i - 1]); j = 0;\n\t\twhile (i > j * j + 1) {\n\t\t\tchkmax(up[i], h[i - j * j - 1] + j + 1); ++j;\n\t\t}\n\t}\n\tfor (int i = n, j = 0; i >= 1; i--) {\n\t\tdown[i] = max(h[i], down[i + 1]); j = 0;\n\t\twhile (n - i + 1 > j * j + 1) {\n\t\t\tchkmax(down[i], h[i + j * j + 1] + j + 1); ++j;\n\t\t}\n\t}\n\tfor (int i = 1; i <= n; i++) writeln(max(up[i], down[i]) - h[i]);\n\t//fwrite(pf, 1, o1 - pf, stdout);\n\treturn 0;\n}\n```\n",
        "postTime": 1565591318,
        "uid": 50925,
        "name": "EternalEpic",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5503 \u3010[JSOI2016]\u706f\u5854\u3011"
    }
]
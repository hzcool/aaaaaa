[
    {
        "content": "\u300a\u7ec4\u5408\u6570\u5b66\u300b\u539f\u9898\u6539\u7f16\u77f3\u9524\u4e86\uff08  \n\u5176\u5b9e\u6b64\u9898\u4ece\u5404\u65b9\u9762\u8bb2\u90fd\u4e0d\u96be\u3002\n****\nfibonacci \u6570\u7684\u751f\u6210\u51fd\u6570\u662f\u8fd9\u4e2a\uff08\u57fa\u7840\u77e5\u8bc6\uff09\n$$F(x)=\\frac{x}{1-x-x^2}$$  \n\u6211\u4eec\u77e5\u9053\u62c6\u5206\u4e3a\u6070\u597d $k$ \u4e2a\u6570\u65f6\uff0c\u7b54\u6848\u7684\u751f\u6210\u51fd\u6570\u4e3a $F(x)^k$  \n\u90a3\u4e48\u7b54\u6848\u7684\u751f\u6210\u51fd\u6570\u663e\u7136\u4e3a\n$$G(x)=\\sum_{i=0}^\\infty F(x)^i$$\n$$=\\frac{1}{1-F(x)}=\\frac{1-x-x^2}{1-2x-x^2}$$\n\u5206\u6bcd\u5199\u6210\u9012\u63a8\u5f0f\u5c31\u662f\n\n$$a_n=2a_{n-1}+a_{n-2}$$\n\u4e58\u4e0a\u5206\u5b50\u5f97\u5230\u7b54\u6848\n$$\\text{ans}=a_n-a_{n-1}-a_{n-2}=a_{n-1}$$\n\n\u89e3\u9012\u63a8\u5f0f\u7279\u5f81\u65b9\u7a0b\uff0c\u5f97\n$$x_1=-\\sqrt 2+1,x_2=\\sqrt 2+1$$\n\u8bbe\u901a\u9879\u516c\u5f0f\u4e3a\n$$a_n=c_1(-\\sqrt 2+1)^n+c_2(\\sqrt 2+1)^n$$\n\u5206\u522b\u4ee3\u5165 $n=0,n=1$\uff0c\u89e3\u5f97 \n$$\\left\\{\\begin{aligned}c_1=\\frac{\\sqrt 2-1}{2\\sqrt 2} \\\\ c_2=\\frac{\\sqrt 2+1}{2\\sqrt 2} \\end{aligned}\\right.$$\n\u6ce8\u610f\u5230 $\\sqrt 2$ \u5728\u6a21 $10^9+7$ \u4e0b\u5b58\u5728\uff08$59713600$\uff09\uff0c\u6700\u7ec8\u7b54\u6848\u5c31\u51fa\u6765\u4e86\n$$a_n\\equiv 485071604\\times 940286408^n+514928404\\times59713601^n\\pmod{10^9+7}$$\n\u76f4\u63a5\u8ba1\u7b97\u5373\u53ef\u3002",
        "postTime": 1576906311,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4451 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206\u3011"
    },
    {
        "content": "## \u9898\u610f\n$$\\large{\\sum_{\\small\\sum_{i=1}^ma_i=n,a_i>0}}\\small\\prod_{i=1}^m F_{a_i}$$\n## \u9898\u89e3\n\u5c0f\u6e05\u65b0\u751f\u6210\u51fd\u6570\u3002\n\n\u8bb0\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u7b2c$i$\u9879\u4e3a$fib_i$\uff0c\u90a3\u4e48\u6709\uff1a$fib_0=0,fib_1=1,fib_n=fib_{n-1}+fib_{n-2}$\n\n\u4ee4$F(x)=\\sum_{i=0}^{+\\infty}fib_ix^i$\uff0c\u5373\u6590\u6ce2\u90a3\u5951\u7684\u751f\u6210\u51fd\u6570\uff0c\u90a3\u4e48\u663e\u7136\u6709\uff1a\n\n$$\n\\begin{alignedat}{2}\nF(x)&=fib_0+&fib_1\\times x+&fib_2\\times x^2+fib_3\\times x^3+fib_4\\times x^4+\\ldots(1)\\\\\nxF(x)&=&fib_0\\times x+&fib_1\\times x^2+fib_2\\times x^3+fib_3\\times x^4+\\ldots(2)\\\\\nx^2F(x)&=&&fib_0\\times x^2+fib_1\\times x^3+fib_2\\times x^4+\\ldots(3)\\\\\n\\end{alignedat}\n$$\n\n$(2)$\u5f0f\u52a0$(3)$\u5f0f\uff0c\u7531\u4e8e$fib_i+fib_{i+1}=fib_{i+2}$\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$(x+x^2)F(x)=fib_2\\times x^2+fib_3\\times x^3+fib_4\\times x^4\\ldots$$\n\n\u4e0e$(1)$\u5f0f\u5bf9\u6bd4\u4e00\u4e0b\uff0c\u6709\uff1a\n\n$$F(x)=(x+x^2)F(x)+x$$\n\n$$F(x)=\\frac{x}{1-x-x^2}$$\n\n\u8bbe$n$\u7684\u7b54\u6848\u4e3a$g_n$\uff0c\u9012\u63a8\u5f0f\u5e94\u8be5\u6bd4\u8f83\u5bb9\u6613\u3002\u5c31\u662f\u679a\u4e3e\u6700\u540e\u7684\u4e00\u4e2a\u6570\u5b57\uff0c\u5728\u539f\u6765\u7684\u57fa\u7840\u4e0a\u4e58\u4e0a\u8fd9\u4e2a\u6570\u7684\u6590\u6ce2\u90a3\u5951\u503c\uff0c\u5728\u7d2f\u52a0\u7b54\u6848\uff0c\u6700\u540e\u7684\u5f0f\u5b50\u5e94\u8be5\u5c31\u662f\uff1a\n\n$$g_n=\\sum_{i=1}^ng_ifib_{n-i}$$\n\n\u7279\u522b\u5730\uff0c\u6211\u4eec\u4ee4$g_0=1$\n\n$$g_n=[n=0]+\\sum_{i=1}^ng_ifib_{n-i}$$\n\n\u8bbe$g$\u7684\u751f\u6210\u51fd\u6570\u4e3a$G$,\u5373$G(x)=\\sum_{i=0}^{+\\infty}g_ix^i$\uff0c\u90a3\u4e48\u5bf9\u5176\u8fdb\u884c\u5c55\u5f00\uff1a\n\n$$G(x)=\\sum_{n=0}^{+\\infty}([n=0]+\\sum_{i=1}^ng_ifib_{n-i})x^n$$\n\n$$G(x)=1+\\sum_{n=1}^{+\\infty}(\\sum_{i=1}^ng_ifib_{n-i})x^n$$\n\n\u4e0d\u96be\u53d1\u73b0\uff0c$\\sum_{n=1}^{+\\infty}(\\sum_{i=1}^ng_ifib_{n-i})x^n=F(x)\\times G(x)$\uff0c\u56e0\u6b64\uff1a\n\n$$G(x)=1+F(x)\\times G(x)$$\n\n$$G(x)=\\frac{1}{1-F(x)}=\\frac{1}{1-\\frac{1}{1-x-x^2}}$$\n\n$$=\\frac{1-x-x^2}{1-2x-x^2}=1-\\frac{x}{x^2+2x-1}$$\n\n\u6b64\u65f6\u53ea\u9700\u8981\u5c55\u5f00$-\\frac{x}{x^2+2x-1}$\u5373\u53ef\u3002\n\n\u6211\u4eec\u77e5\u9053\uff0c$\\frac{1}{1-cx^k}=\\sum_{i=0}^{+\\infty}(cx)^{ik}$\uff0c\u56e0\u6b64\u6211\u4eec\u5e0c\u671b\u4e0a\u5f0f\u53ef\u4ee5\u7528\u8fd9\u6837\u7684\u65b9\u5f0f\u5c55\u5f00\u3002\n\n\u6211\u4eec\u53ea\u9700\u8981\u89e3\u51fa$x^2+2x-1=0$\u7684\u4e24\u6839$x_1,x_2$\uff0c$x_{1,2}=-1\u00b1\\sqrt{2}$,\u90a3\u4e48\u5c31\u6709\uff1a\n\n$$-\\frac{x}{x^2+2x-1}=-\\frac{x}{(x-x_1)(x-x_2)}$$\n\n$$=\\frac{x}{x_2-x_1}(\\frac{1}{x-x_1}-\\frac{1}{x-x_2})$$\n\n\u628a\u5e38\u6570\u9879\u5316\u4e3a$1$\n\n$$=\\frac{x}{x_2-x_1}(\\frac{1}{x2}\\times\\frac{1}{1-x/x2}-\\frac{1}{x1}\\times\\frac{1}{1-x/x1})$$\n\n$$=\\frac{x}{x_2-x_1}(\\frac{1}{x2}\\times\\sum_{i=0}\\frac{x^i}{x_2^i}-\\frac{1}{x1}\\times\\sum_{i=0}\\frac{x^i}{x_1^i})$$\n\n$$=\\frac{1}{x_2-x_1}(\\sum_{i=0}\\frac{x^{i+1}}{x_2^{i+1}}-\\sum_{i=0}\\frac{x^{i+1}}{x_1^{i+1}})$$\n\n\u90a3\u4e48\u7b2c$n$\u9879\u7684\u7cfb\u6570\u4e3a$g(n)=\\dfrac{1}{x2-x1}\\times(\\dfrac{1}{x_2^n}-\\dfrac{1}{x_1^n})$\n\n\u4ee3\u5165\u5f97\u5230\uff1a$g(n)=\\dfrac{\\sqrt{2}}{4}[(1+\\sqrt{2})^n-(1-\\sqrt{2})^n]$\n\n$\\sqrt2$\u5728\u6a21$1000000007$\u65f6\u7b49\u4e8e$59713600$\u6216$940286407$\u3002\n\n\u4f46\u662f\u7531\u4e8e$n$\u7684\u503c\u5f88\u5927\uff0c\u6839\u636e\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff0c\u5bf9$mod-1$\u53d6\u6a21\u5373\u53ef\u3002\n\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntemplate<const int mod> \nstruct modint{\n    ll x;\n    modint(ll o=0){x=o;}\n    modint &operator = (ll o){return x=o,*this;}\n    modint &operator +=(modint o){return x=x+o.x>=mod?x+o.x-mod:x+o.x,*this;}\n    modint &operator -=(modint o){return x=x-o.x<0?x-o.x+mod:x-o.x,*this;}\n    modint &operator *=(modint o){return x=1ll*x*o.x%mod,*this;}\n    modint &operator ^=(ll b){\n    \tb%=(mod-1);\n        modint a=*this,c=1;\n        for(;b;b>>=1,a*=a)if(b&1)c*=a;\n        return x=c.x,*this;\n    }\n    modint &operator /=(modint o){return *this *=o^=mod-2;}\n    modint &operator +=(ll o){return x=x+o>=mod?x+o-mod:x+o,*this;}\n    modint &operator -=(ll o){return x=x-o<0?x-o+mod:x-o,*this;}\n    modint &operator *=(ll o){return x=1ll*x*o%mod,*this;}\n    modint &operator /=(ll o){return *this *= ((modint(o))^=mod-2);}\n    template<class I>friend modint operator +(modint a,I b){return a+=b;}\n    template<class I>friend modint operator -(modint a,I b){return a-=b;}\n    template<class I>friend modint operator *(modint a,I b){return a*=b;}\n    template<class I>friend modint operator /(modint a,I b){return a/=b;}\n    friend modint operator ^(modint a,ll b){return a^=b;}\n    friend bool operator ==(modint a,ll b){return a.x==b;}\n    friend bool operator !=(modint a,ll b){return a.x!=b;}\n    bool operator ! () {return !x;}\n    modint operator - () {return x?mod-x:0;}\n    void read(){\n    \tstring s;cin>>s;x=0;\n    \tfor(int i=0;i<s.length();i++)\n\t\t\t*this*=10,*this+=s[i]-'0';\n\t}void write(){\n\t\tcout<<x;\n\t}\n};\nmodint<1000000006>n;\nmodint<1000000007>ans,sqrt2=59713600;\nsigned main(){\n\tn.read();\n\tans=sqrt2/4*(((sqrt2+1)^n.x)-((-sqrt2+1)^n.x));ans.write();\n\treturn 0;\n}\n```\n",
        "postTime": 1608897306,
        "uid": 174304,
        "name": "jun\u5934\u5409\u5409",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P4451 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206\u3011"
    },
    {
        "content": "\u8fd9\u91cc\u8bb2\u4e00\u4e2a**\u4e0d\u540c\u6839\u7684\u6709\u7406\u5c55\u5f00\u5b9a\u7406**\uff08\u89e3\u9012\u5f52\u5f0f\uff0c\u628a\u51fd\u6570\u5c55\u5f00\u6210\u5e42\u7ea7\u6570\u7684\u5e38\u7528\u65b9\u6cd5\uff09\u3002\n\n\uff08\u5b66\u4e60\u81ea\u300a\u5177\u4f53\u6570\u5b66\u300b\uff09\n\n---\n\n\u7b54\u6848\u5f88\u663e\u7136\u53ef\u4ee5\u5199\u6210\u5982\u4e0b\u9012\u5f52\u5f0f\uff1a\n\n$$f_n=\n\\begin{cases}\n\\sum\\limits_{i=0}^nfib_i\\times f_{n-i} &n>0\\\\\n1 &n=0\n\\end{cases}$$\n\n\u641e\u51fa\u7b54\u6848\u6570\u5217 $f$ \u7684\u751f\u6210\u51fd\u6570 $F(x)$\uff0c\u8bbe\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u751f\u6210\u51fd\u6570\u4e3a $G(x)$ \u53ef\u4ee5\u5f97\u5230\u5982\u4e0b\u5173\u7cfb\u5f0f\uff1a\n\n$$F=F*G+1$$\n\n\u4f17\u6240\u5468\u77e5\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u751f\u6210\u51fd\u6570\u7684\u5c01\u95ed\u5f62\u5f0f\u662f $\\dfrac{x}{1-x-x^2}$ (\u7531\u4e8e\u8fd9\u9053\u9898\u76ee\u7684\u6570\u5217\u6574\u4f53\u53f3\u79fb\u4e86\u4e00\u4f4d\u6240\u4ee5\u5206\u5b50\u662f $x$ )\n\n\u90a3\u4e48\u89e3\u5f97\uff1a\n\n$$F=1+\\frac{x}{1-2x-x^2}$$\n\n\u73b0\u5728\u7684\u95ee\u9898\u5728\u4e8e\u5982\u4f55\u5c55\u5f00 $\\dfrac{x}{1-2x-x^2}$\u3002\n\n---\n\n## \u4e0d\u540c\u6839\u7684\u6709\u7406\u5c55\u5f00\u5b9a\u7406\n\n\u6709\u4e00\u4e2a\u591a\u9879\u5f0f $f(x)$\uff1a\n\n$$f(x)=\\sum\\limits_{i=0}^{m}a_ix^i$$\n\n$f(x)$ \u7684**\u53cd\u5c04\u591a\u9879\u5f0f**\uff1a\n\n$$f^R(x)=\\sum\\limits_{i=0}^{m}a_{m-i}x^i$$\n\n\n\u8bbe $z_1,z_2,\\cdots,z_m$ \u4e3a $f^R(x)$ \u7684 $m$ \u4e2a\u6839\u3002\n\n\u4e24\u8005\u5b58\u5728\u4e00\u4e2a\u91cd\u8981\u5173\u7cfb\uff1a\n\n\n$$\n\\begin{aligned}\nf^R(x)&=a_0\\prod\\limits_{i=1}^m (x-z_i) \\\\\n&\\Leftrightarrow \\\\\nf(x)&=a_0\\prod\\limits_{i=1}^m (1-a_iz_i)\n\\end{aligned}\n$$\n\n\u82e5 $g(x)=\\dfrac{p(x)}{f(x)}$ \uff08 $p(x)$ \u662f\u4e00\u4e2a\u5c0f\u4e8e $m$ \u6b21\u7684\u591a\u9879\u5f0f \uff09\n\n\u5219\u6709\uff1a\n\n$$[x^i]g(x)=\\sum\\limits_{k=1}^m \\frac{-z_kp\\left(\\frac{1}{z_k}\\right)}{f'\\left(\\frac{1}{z_k}\\right)}\\cdot z_k^i$$\n\n**\u6ce8\uff1a** $[x^i]$ \u662f $g(x)$ \u7684 $i$ \u6b21\u9879\u7cfb\u6570\u3002\n\n---\n\n\u9488\u5bf9\u8fd9\u9053\u9898\u76ee\uff1a\n\n$g(x)=\\dfrac{x}{1-2x-x^2}$\n\n$f(x)=1-2x-x^2,f'(x)=-2x-2,p(x)=x$\n\n\u5219\uff1a\n\n$$\\frac{-z\\ p\\left(\\frac{1}{z}\\right)}{f'\\left(\\frac{1}{z}\\right)}\\cdot z^i=\\frac{z}{2+2z}\\cdot z^i$$\n\n\u90a3\u4e48\u8fd9\u9053\u9898\u76ee\u7684\u7b54\u6848\u5c31\u662f\uff1a\n\n$$\\frac{z_1}{2+2z_1}\\cdot z_1^n+\\frac{z_2}{2+2z_2}\\cdot z_2^n$$\n\n\u5176\u4e2d\uff0c$f^R(x)$ \u7684\u4e24\u6839\u5206\u522b\u4e3a $z_1=1+\\sqrt{2},z_2=1-\\sqrt{2}$\u3002\n\n$2$ \u5728\u6a21 $10^9+7$ \u610f\u4e49\u4e0b\u7684\u4e8c\u6b21\u5269\u4f59\u662f $59713600$\u3002\n\n\u6839\u636e\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff0c\u8bfb\u5165 $n$ \u7684\u65f6\u5019\u6a21 $10^9+6$ \uff0c\u7136\u540e\u76f4\u63a5\u5feb\u901f\u5e42\u5373\u53ef\u6c42\u51fa\u7b54\u6848\u3002\n\n\n---\n\n\u7092\u9e21\u77ed\u7684 ***code\uff1a***\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\ntypedef long long ll;\nconst ll mod=1e9+7;\nconst ll s2=59713600;\ninline ll read(){\n    ll x=0,f=1;\n    char c=getchar();\n    while(c<'0'||c>'9'){\n        if(c=='-')f=-1;\n        c=getchar();\n    }\n    while(c>='0'&&c<='9'){\n        x=(x<<3)+(x<<1)+c-'0';\n        x%=(mod-1);\n        c=getchar();\n    }\n    return x*f;\n}\nint n,X1,X2;\nll qpow(ll a,ll b){\n\tll ans=1;\n\twhile(b){\n\t\tif(b&1)ans=ans*a%mod;\n\t\ta=a*a%mod;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\nint main(){\n\tn=read();\n\tX1=s2+1,X2=(1-s2+mod)%mod;\n\tprintf(\"%lld\\n\",(X1*qpow((2+2*X1)%mod,mod-2)%mod*qpow(X1,n)%mod+X2*qpow((2+2*X2)%mod,mod-2)%mod*qpow(X2,n)%mod)%mod);\n\treturn 0;\n}\n\n```\n\n[*Froggy's blog*](https://www.luogu.org/blog/1445353309froggy/)\n\n#### \u5471!!\n\n",
        "postTime": 1589604246,
        "uid": 100285,
        "name": "Froggy",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P4451 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206\u3011"
    },
    {
        "content": "**\u524d\u8a00**\n\n[\u539f\u9898\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4451)\n\n\u6211\u4eec\u53d1\u73b0\u6570\u636e\u8303\u56f4\u4f3c\u4e4e\u5df2\u7ecf\u505a\u4e86\u6539\u52a8\uff0c\u7531\u539f\u6765\u7684$n\u226410^6$ \u53d8\u4e3a$n\u226410^{10000}$\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u6390\u7684\u975e\u5e38\u7d27\uff0c\u539f\u6765\u7b80\u6734\u6f02\u4eae\u7684\u9012\u63a8\u65b9\u6cd5\u5c31\u884c\u4e0d\u901a\u4e86\u3002\u7531\u4e8e\u4e2a\u4eba\u5728\u751f\u6210\u51fd\u6570\u4e0a\u975e\u5e38\u7684$naive$\uff0c\u6240\u4ee5\u4f7f\u7528\u4e86\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u7136\u540e\u5bf9\u4e8e\u770b\u8d77\u6765\u641e\u4e0d\u5b9a\u7684$n$\u8fd0\u7528\u5b57\u7b26\u4e32\u9ad8\u7cbe\u8fd0\u7b97\u3002\n\n------------\n\n**\u6b63\u6587**\n\n\u9996\u5148\u662f\u89e3\u9898\u8fc7\u7a0b\u3002\n\n\u4ee4$f(x)=\\sum \\prod\\limits_{i=1}^xF_{a_i} $\n\n\u5219\u6709 $f(x)=\\sum\\limits_{i=1}^{x}f(i)F_{x-i}$\n\n$\\because F_0=0$\n\n$\\therefore f(x)= \\sum\\limits_{i=1}^{x-1}f(i)F_{x-i}$\n\n$\\begin{aligned}f(x)-f(x-1) \n& = \\sum\\limits_{i=1}^{x-1}f(i)F_{x-i}-\\sum\\limits_{i=1}^{x-2}f(i)F_{x-1-i}\n\\\\ & = \\sum\\limits_{i=1}^{x-2}f(i)F_{x-i}-\\sum\\limits_{i=1}^{x-2}f(i)F_{x-1-i}+f(x-1)F_{1}\n\\\\ & = \\sum\\limits_{i=1}^{x-2}f(i)(F_{x-i}-F_{x-1-i})+f(x-1)\n\\\\ & = \\sum\\limits_{i=1}^{x-2}f(i)F_{x-2-i}+f(x-1)\n\\\\ & = f(x-2)+f(x-1)\n\\end{aligned}$ \n\n$\\therefore f(x)=2f(x-1)+f(x-2)$\n\n\u4ee4$x=n$\uff0c\u6784\u9020\u77e9\u9635\uff0c\u5219\u6709\n\n$\\begin{bmatrix}f(n)\\\\f(n-1)\\end{bmatrix}=\\begin{bmatrix}2f(n-1)+f(n-2)\\\\f(n-1)\\end{bmatrix}=\\begin{bmatrix}f(n-1)\\\\f(n-2)\\end{bmatrix}\\begin{bmatrix}2&1\\\\1&0\\end{bmatrix}$ \n\n\u5269\u4e0b\u7684\u518d\u52a0\u4e0a\u5b57\u7b26\u4e32\u9ad8\u7cbe\u5c31\u597d\u4e86\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u53ef\u4ee5\u770b\u6210$O(\\log n)$\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#define mod 1000000007\nusing namespace std;\nlong long fp2,fp1,fn,saver;\nstruct matrix{\n\tlong long m[3][3];\n\tint l,w;\n\tvoid reset(int s,int v){\n\t\tl=s;w=v;\n\t\tfor(register int i=0;i<l;++i)\n\t\t\tfor(register int j=0;j<w;++j)\n\t\t\t\tm[i][j]=0;\n\t}\n\tmatrix operator *(matrix s){\n\t\tmatrix z;\n\t\tz.reset(l,s.w);\n\t\tfor(register int i=0;i<z.l;++i)\n\t\t\tfor(register int j=0;j<w;++j)\n\t\t\t\tfor(register int k=0;k<z.w;++k)\n\t\t\t\t\tz.m[i][k]=(z.m[i][k]+m[i][j]*s.m[j][k])%mod;\n\t\treturn z;\n\t}\n};\nint div(string &s){                                            \t\t//\u5bf9n>>=1\n\tint len=s.length(),res=0;\n\tstring ans=\"\";\n\tfor(register int i=0;i<len;++i)\n\t{\n\t\tres=(res<<3)+(res<<1)+s[i]-'0';\n\t\tif(res>=2||i!=0){\t\n  \t\t\t//\u5982\u679c\u4e0d\u5728\u9996\u4f4d\u9700\u8981\u88650\n\t\t\tans=ans+char(res/2+'0');\n\t\t\tres=res%2;\n\t\t}\n\t\telse continue;\n\t}\n\ts=ans;\n\treturn res;\n}\nvoid quickpow(string n){\n\tmatrix res,x;\n  //\u77e9\u9635\u521d\u59cb\u5316\n\tres.reset(2,1);\n\tres.m[0][0]=1;res.m[1][0]=0;\n\tx.reset(2,2);\n\tx.m[0][0]=2;x.m[0][1]=1;\n\tx.m[1][0]=1;\n  //\u77e9\u9635\u5feb\u901f\u5e42+\u5b57\u7b26\u4e32\u9ad8\u7cbe\n\twhile(n.length()>1||n[0]>'0'){\n\t\tif(div(n))res=x*res;\n\t\tx=x*x;\n\t}\n  //\u7b54\u6848\u8f93\u51fa\n\tprintf(\"%lld\",res.m[1][0]);\n}\nint main()\n{\n\tstring n;\n\tcin>>n;\n\tquickpow(n);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1578393094,
        "uid": 137422,
        "name": "JasonL",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4451 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206\u3011"
    },
    {
        "content": "[$$\\large\\color{purple}My\\;Blog$$](https://www.cnblogs.com/p-b-p-b/p/10349253.html)\n\n------\n\n\u601d\u8def\u5982\u6b64\u7cbe\u5999\uff0c\u4ee3\u7801\u5982\u6b64\u7b80\u6d01\uff0c\u5b9e\u662f\u953b\u70bc\u601d\u7ef4~~\u6c34\u7ecf\u9a8c~~\u4e4b\u597d\u9898\uff08\u5927\u96fe\n\n---------\n\n\u8fd9\u79cd\u9898\u5f53\u7136\u662f\u4e00\u773cDP\u5566\u3002\n\n\u8bbe$dp_n$\u4e3a\u628a$n$\u62c6\u5206\u540e\u7684\u7b54\u6848\u3002\u4e3a\u4e86\u65b9\u4fbf\u6211\u4eec\u8bbe$dp_0=1$\n\n\u7531\u9898\u610f\u6709\n$$dp_n=[n=0]+\\sum_{i=1}^n dp_{n-i}f_i$$\n\u6309\u7167\u5957\u8def\uff0c\u6211\u4eec\u8003\u8651\u5b83\u7684\u751f\u6210\u51fd\u6570$A(x)$\n\n\n$$A(x)=\\sum_n ([n=0]+\\sum_{i=1}^n f_i dp_{n-i})x^n$$\n$$=1+\\sum_{n=1}^{\\infty} (\\sum_{i=1}^n f_i dp_{n-i})x^n$$\n$$=1+\\sum_n (\\sum_{i=0}^n f_i dp_{n-i})x^n$$\n$$=1+A(x)F(x)$$\n\n\u6211\u4eec\u77e5\u9053$F(x)=\\frac{x}{1-x-x^2}$\uff0c\u6240\u4ee5\u6709\n\n$$A(x)=\\frac{1}{1-F(x)}=1+\\frac{x}{1-2x-x^2}=1+\\frac{1}{2\\sqrt{2}}(\\frac{1}{1-(1+\\sqrt{2})x}-\\frac{1}{1-(1-\\sqrt{2})x})=1+\\sum_n \\frac{1}{2\\sqrt{2}}[(1+\\sqrt{2})^n-(1-\\sqrt{2})^n]$$\n\n\u6240\u4ee5\n$$Ans_n=\\frac{(1+\\sqrt{2})^n-(1-\\sqrt{2})^n}{2\\sqrt{2}}$$\n\u53d1\u73b0\u9898\u76ee\u8981\u6c42$Ans_n\\pmod{1e9+7}$\uff0c\u679a\u4e3e\u53ef\u5f97$59713600^2  \\equiv 2\\pmod{1e9+7} $ \uff0c\u6240\u4ee5$\\sqrt{2}\\equiv 59713600 \\pmod{1e9+7}$\n\n\u4e8e\u662f\u6211\u4eec\u5728$O(\\log n)$\u7684\u65f6\u95f4\u5185\u6c42\u5f97\u4e86\u7b54\u6848\uff01\n\n\u95ee\u9898\u6765\u4e86\uff1a\u4e3a\u4ec0\u4e48\u6570\u636e\u8303\u56f4\u53ea\u6709$10^6$\u5462\uff1f\u6211$O(\\log n)$\u5feb\u901f\u5e42\u8fd8\u6ca1\u6709$O(n)$\u9012\u63a8\u5feb\u2026\u2026\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nnamespace my_std{\n    using namespace std;\n    #define pii pair<int,int>\n    #define fir first\n    #define sec second\n    #define MP make_pair\n    #define rep(i,x,y) for (int i=(x);i<=(y);i++)\n    #define drep(i,x,y) for (int i=(x);i>=(y);i--)\n    #define go(x) for (int i=head[x];i;i=edge[i].nxt)\n    #define sz 101010\n    #define mod (int)(1e9+7)\n    typedef long long ll;\n    template<typename T>\n    inline void read(T& t)\n    {\n        t=0;char f=0,ch=getchar();\n        double d=0.1;\n        while(ch>'9'||ch<'0') f|=(ch=='-'),ch=getchar();\n        while(ch<='9'&&ch>='0') t=t*10+ch-48,ch=getchar();\n        if(ch=='.')\n        {\n            ch=getchar();\n            while(ch<='9'&&ch>='0') t+=d*(ch^48),d*=0.1,ch=getchar();\n        }\n        t=(f?-t:t);\n    }\n    template<typename T,typename... Args>\n    inline void read(T& t,Args&... args){read(t); read(args...);}\n    void file()\n    {\n        #ifndef ONLINE_JUDGE\n        freopen(\"a.txt\",\"r\",stdin);\n        #endif\n    }\n//\tinline ll mul(ll a,ll b){ll d=(ll)(a*(double)b/mod+0.5);ll ret=a*b-d*mod;if (ret<0) ret+=mod;return ret;}\n}\nusing namespace my_std;\n\nconst ll sqrt2=59713600;\nll ksm(ll x,int y)\n{\n    ll ret=1;\n    for (;y;y>>=1,x=x*x%mod) if (y&1) ret=ret*x%mod;\n    return ret;\n}\nll inv(ll x){return ksm(x,mod-2);}\nint n;\n\nint main()\n{\n    file();\n    read(n);\n    cout<<(ksm(1+sqrt2,n)-ksm(mod+1-sqrt2,n)+mod)%mod*inv(2*sqrt2)%mod;\n}\n```\n\n",
        "postTime": 1549115498,
        "uid": 76481,
        "name": "p_b_p_b",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4451 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206\u3011"
    },
    {
        "content": "## $[\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206$\n\n$\\quad$\u9996\u5148\u6709 $Fibonacci$ \u6570\u5217\u7684\u751f\u6210\u51fd\u6570 \uff1a\n\n$$F(x)=\\sum_{i\\geqslant1}fib_i\\cdot x^i=\\frac{x}{1-x-x^2}$$\n\n$\\quad$\u8bb0 $g$ \u4e3a\u7b54\u6848\u6570\u5217\uff0c\u6709 \uff1a\n\n$$g_n=\\sum_{m>0,\\sum_{i=1}^ma_i=n}\\prod_{i=1}^mfib_{a_i}$$\n\n$\\quad$\u82e5\u5f53\u524d\u5df2\u7ecf\u6709 $\\sum_{j=1}^{m-1}a_j=i$\uff0c\u90a3\u4e48\u53ef\u4ee5\u7ed9\u6240\u6709\u65b9\u6848\u52a0\u5165\u4e00\u4e2a $a_m=n-i$\uff0c\u4f7f\u5f97 $sum_{j=1}^m=n$\uff0c\u4e14\u8d21\u732e\u4e3a $fib_{n-i}$.\n\n$\\quad$\u6545\u5f97\u5230 $g$ \u7684\u9012\u63a8\u5f0f \uff1a\n\n$$g_n=\\sum_{i=0}^{n-1}g_i\\cdot fib_{n-i}$$\n\n$\\quad$\u7279\u522b\u7684\uff0c\u5b9a\u4e49 $g_0=1$\uff0c\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u4e86\u7b54\u6848\u7684\u751f\u6210\u51fd\u6570 \uff1a\n\n$$\\begin{aligned}\n    G(x)&=\\sum_{i\\geqslant 0}g_i\\cdot x^i\\\\\n    &=\\sum_{i\\geqslant 0}\\left(\\sum_{j=0}^{i-1}g_i\\cdot fib_{n-i}+[i=0]\\right)x^i\\\\\n    &=1+\\sum_{i\\geqslant 1}\\left(\\sum_{j=0}^{i-1}g_i\\cdot fib_{n-i}\\right)x^i\n\\end{aligned}$$\n\n$\\quad$\u89c2\u5bdf\u5230\u7531\u9012\u63a8\u5f0f\u5f97\u5230\u7684 $g$ \u7684\u751f\u6210\u51fd\u6570\u662f $F$ \u548c $G$ \u7684\u5377\u79ef\u5f62\u5f0f\uff0c\u5373 \uff1a\n\n$$\\sum_{i\\geqslant 1}\\left(\\sum_{j=0}^{i-1}g_i\\cdot fib_{n-i}\\right)x^i=F(x)\\times G(x)$$\n\n$$\\therefore G(x)=1+G(x)\\times F(x)$$\n\n$$\\therefore G(x)=\\frac{1}{1-F(x)}=\\frac{1-x-x^2}{1-2x-x^2}=1+\\frac{x}{1-2x-x^2}$$\n\n$\\quad$\u53d1\u73b0\u5f0f\u5b50\u4e2d\u7684 $1$ \u662f\u4e3a\u4e86\u8ba1\u7b97\u65b9\u4fbf\u5f3a\u884c\u5b9a\u4e49\u7684\uff0c\u4e8e\u662f\u76f4\u63a5\u5c06\u5176\u53bb\u6389\uff0c$g$ \u7684\u771f\u6b63\u751f\u6210\u51fd\u6570\u4e3a \uff1a\n\n$$G(x)=\\sum_{i\\geqslant 1}g_i\\cdot x^i=\\frac{x}{1-2x-x^2}$$\n\n$\\quad$\u6839\u636e\u90e8\u5206\u5206\u5f0f\u5b9a\u7406\uff0c\u4f7f\u7528\u5f85\u5b9a\u7cfb\u6570\u6cd5\u5c06\u5176\u5c55\u5f00 \uff1a\n\n$$\\begin{aligned}\n    \\frac{x}{1-2x-x^2}&=\\frac{A}{1-ax}+\\frac{B}{1-bx}\\\\\\\\\n    &=\\frac{(A+B)+(aB-bA)x}{1-(a+b)x+abx^2}\n\\end{aligned}$$\n\n$\\quad$\u5bf9\u6bd4\u7cfb\u6570\u5f97\u5230 \uff1a\n\n$$\\frac{x}{1-2x-x^2}=\\frac{\\sqrt{2}}{4}\\left(\\frac{1}{1-(1+\\sqrt{2})x}-\\frac{1}{1-(1-\\sqrt{2})x}\\right)$$\n\n$\\quad$\u6545\u53ef\u5f97 $G(x)$ \u7684\u5f62\u5f0f\u5e42\u7ea7\u6570\u5f62\u5f0f \uff1a\n\n$$\\begin{aligned}\n    G(x)&=\\frac{x}{1-2x-x^2}\\\\\n    &=\\frac{\\sqrt{2}}{4}\\left(\\frac{1}{1-(1+\\sqrt{2})x}-\\frac{1}{1-(1-\\sqrt{2})x}\\right)\\\\\n    &=\\frac{\\sqrt{2}}{4}\\left(\\sum_{i\\geqslant 0}(1+\\sqrt{2})^i\\cdot x^i-\\sum_{i\\geqslant 0}(1-\\sqrt{2})^i\\cdot x^i\\right)\\\\\n    &=\\frac{\\sqrt{2}}{4}\\sum_{i\\geqslant 0}\\left[(1+\\sqrt{2})^i-(1-\\sqrt{2})^i\\right]x^i\n\\end{aligned}$$\n\n$$\\therefore g_n=\\frac{\\sqrt{2}}{4}\\left[(1+\\sqrt{2})^n-(1-\\sqrt{2})^n\\right]$$\n\n$\\quad$\u73b0\u5728\u8003\u8651\u5982\u4f55\u8ba1\u7b97 $g_n$\uff0c\u89c2\u5bdf\u5230\u5176\u4e2d\u6709\u65e0\u7406\u6570 $\\sqrt{2}$\uff0c\u4e8e\u662f\u8981\u5148\u6c42\u51fa $\\sqrt{2}$ \u5728\u6a21 $10^9+7$ \u610f\u4e49\u4e0b\u7684\u503c\uff0c\u5373\u4ee5\u4e0b\u540c\u4f59\u65b9\u7a0b\u7684\u89e3 \uff1a\n\n$$x^2\\equiv 2\\pmod{10^9+7}$$\n\n$\\quad$\u8003\u8651\u4e00\u4e2a\u66f4\u4e00\u822c\u7684\u95ee\u9898 \uff1a\u6c42 $\\sqrt{n}$ \u5728\u6a21 $p$ \u610f\u4e49\u4e0b\u7684\u503c\u3002\u5176\u7b49\u4ef7\u4e8e\u89e3\u4e0b\u9762\u7684\u540c\u4f59\u65b9\u7a0b \uff1a\n\n$$x^2\\equiv n\\pmod p$$\n\n$\\quad$\u5b9a\u4e49 $n$ \u662f\u6a21 $p$ \u610f\u4e49\u4e0b\u7684\u4e8c\u6b21\u5269\u4f59\uff0c\u5f53\u4e14\u4ec5\u5f53\u540c\u4f59\u65b9\u7a0b $x^2\\equiv n\\pmod p$ \u6709\u89e3\uff0c\u4e5f\u5c31\u662f\u5b58\u5728\u4e00\u4e2a\u6574\u6570\u5728\u6a21 $p$ \u610f\u4e49\u4e0b\u7b49\u4ef7\u4e8e $\\sqrt{n}$.\n\n$\\quad$\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a\u6a21 $p$ \u610f\u4e49\u4e0b\u7684\u4e8c\u6b21\u5269\u4f59 $n$\uff0c\u65b9\u7a0b $x^2\\equiv n\\pmod p$ \u6709\u591a\u5c11\u4e2a\u89e3\u5462 $\uff1f$\n\n$\\quad$\u5047\u8bbe\u6709\u591a\u4e2a\u89e3\uff0c\u53d6\u5176\u4e2d\u4efb\u610f\u4e24\u4e2a\u4e0d\u540c\u7684 $x_1,x_2$\uff0c\u6709 \uff1a\n\n$$x_1^2\\equiv x_2^2\\Longrightarrow (x_1+x_2)(x_1-x_2)\\equiv 0\\pmod p$$\n\n$\\quad$\u7531\u4e8e $x_1\\not= x_2$\uff0c\u6240\u4ee5 $x_1+x_2\\equiv 0\\pmod p$. \u6362\u800c\u8a00\u4e4b\uff0c\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u4e8c\u6b21\u5269\u4f59 $n$\uff0c\u5b58\u5728\u4e24\u4e2a\u89e3 $x_1,x_2$ \u4f7f\u5f97\u65b9\u7a0b $x^2\\equiv n\\pmod p$ \u6210\u7acb\uff0c\u4e14\u5b83\u4eec\u4e92\u4e3a\u76f8\u53cd\u6570\u3002\u53e6\u5916\uff0c\u56e0\u4e3a $p$ \u662f\u4e00\u4e2a\u5947\u8d28\u6570\uff0c\u6240\u4ee5 $x_1$ \u548c $x_2$ \u5728\u6a21 $p$ \u610f\u4e49\u4e0b\u4e0d\u76f8\u7b49\u3002\n\n$\\quad$\u7531\u4e8e\u4efb\u610f\u4e00\u4e2a\u4e8c\u6b21\u5269\u4f59\u90fd\u5bf9\u5e94\u4e00\u5bf9\u4e92\u4e3a\u76f8\u53cd\u6570\u7684\u89e3\uff0c\u4e14\u6613\u77e5\u4efb\u610f\u4e00\u5bf9\u76f8\u53cd\u6570\u4e5f\u5bf9\u5e94\u4e00\u4e2a\u4e8c\u6b21\u5269\u4f59\uff0c\u6545\u4e8c\u6b21\u5269\u4f59\u7684\u4e2a\u6570\u6070\u4e3a $\\frac{p-1}{2}$.\n\n$\\quad$\u90a3\u5982\u4f55\u5feb\u901f\u5224\u65ad\u4e00\u4e2a\u6570 $n$ \u662f\u5426\u4e3a\u6a21 $p$ \u610f\u4e49\u4e0b\u7684\u4e8c\u6b21\u5269\u4f59\u5462 $?$\n\n$\\quad$\u7531\u8d39\u9a6c\u5c0f\u5b9a\u7406\u53ef\u77e5 \uff1a\n\n$$n^{p-1}\\equiv 1\\Longrightarrow \\left(n^{\\frac{p-1}{2}}\\right)^2-1\\equiv0\\pmod p$$\n\n$\\quad$\u6240\u4ee5 $n^{\\frac{p-1}{2}}$ \u5728\u6a21 $p$ \u610f\u4e49\u4e0b\u53ef\u80fd\u6709\u4e24\u4e2a\u503c\uff0c\u5373 $1$ \u6216 $-1$.\n\n$\\quad$\u5982\u679c $n$ \u662f\u4e8c\u6b21\u5269\u4f59\uff0c\u90a3\u4e48\u6709 \uff1a\n\n$$n^{\\frac{p-1}{2}}\\equiv (x^2)^{\\frac{p-1}{2}}\\equiv x^{p-1}\\equiv 1\\pmod p$$\n\n$\\quad$\u4e8e\u662f $n$ \u4e3a\u6a21 $p$ \u610f\u4e49\u4e0b\u7684\u4e8c\u6b21\u5269\u4f59\u5f53\u4e14\u4ec5\u5f53 $n^{\\frac{p-1}{2}}\\equiv 1\\pmod p$.\n\n$\\quad$\u6709\u4e86\u4ee5\u4e0a\u4e24\u4e2a\u5f15\u7406\uff0c\u5bfb\u627e\u65b9\u7a0b $x^2\\equiv n\\pmod p$ \u7684\u89e3\u53ef\u4ee5\u4f7f\u7528 $\\rm Cipolla$ \u7b97\u6cd5\u3002\n\n$\\quad$\u9996\u5148\u627e\u5230\u4e00\u4e2a $a$\uff0c\u6ee1\u8db3 $a^2-n$ \u662f\u975e\u4e8c\u6b21\u5269\u4f59\uff0c\u6211\u4eec\u53ef\u4ee5\u968f\u673a\u627e\uff0c\u7531\u4e8e\u975e\u4e8c\u6b21\u5269\u4f59\u7684\u6570\u91cf\u5360\u603b\u6570\u7684 $\\frac{1}{2}$\uff0c\u6240\u4ee5\u671f\u671b\u968f\u673a\u4e24\u6b21\u53ef\u4ee5\u627e\u5230\u3002\n\n$\\quad$\u5b9a\u4e49 $i^2\\equiv a^2-n\\pmod p$\uff0c\u4f46 $a^2-n$ \u4e0d\u662f\u4e8c\u6b21\u5269\u4f59\uff0c\u6240\u4ee5\u5728\u6574\u6570\u57df\u5185\u627e\u4e0d\u5230\u4e00\u4e2a $i$ \u53ef\u4ee5\u6ee1\u8db3\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u4e8e\u662f\u8003\u8651\u6269\u57df\uff0c\u63a5\u4e0b\u6765\u6240\u6709\u6570\u90fd\u5728\u7c7b\u590d\u6570\u57df\u5185\u8ba8\u8bba\uff0c\u6bcf\u4e2a\u6570\u90fd\u53ef\u4ee5\u88ab\u8868\u793a\u4e3a $a+bi$ \u7684\u5f62\u5f0f\uff0c\u5176\u4e2d $a$ \u548c $b$ \u662f\u6a21 $p$ \u610f\u4e49\u4e0b\u7684\u503c\uff0c\u7c7b\u4f3c\u4e8e\u590d\u6570\u7684\u5b9e\u90e8\u548c\u865a\u90e8\u3002\n\n$\\quad$\u6709 $(a+i)^{p+1}\\equiv n\\pmod p$\uff0c\u8003\u8651\u8bc1\u660e\u3002\n\n$\\quad$\u5f15\u7406 $1$ \uff1a$(a+b)^p\\equiv a^p+b^p\\pmod p$\n\n> $Proof$.\n$$(a+b)^p\\equiv \\sum_{i=0}^p \\dbinom{p}{i}a^i\\cdot b^{p-i}\\equiv a^p+b^p+\\sum_{i=1}^{p-1}\\frac{p!}{i!(n-i)!}a^i\\cdot b^{n-i}\\equiv a^p+b^p\\pmod p$$\n\n$\\quad$\u5f15\u7406 $2$ \uff1a$i^p\\equiv -i\\pmod p$\n\n> $Proof$.\n$$i^p\\equiv i(i^2)^{\\frac{p-1}{2}}\\equiv i(a^2-n)^{\\frac{p-1}{2}}\\equiv -i\\pmod p$$\n\n$$\\begin{aligned}\n    (a+i)^{p+1}&=(a+i)^p(a+i)\\\\\n    &\\equiv (a^p+b^p)(a+i)\\\\\n    &\\equiv (a-i)(a+i)\\\\\n    &\\equiv a^2-i^2\\\\\n    &\\equiv n\\pmod p\n\\end{aligned}$$\n\n$\\quad$\u6240\u4ee5 $x_0=(a+i)^{\\frac{p+1}{2}}$ \u662f\u65b9\u7a0b $x^2\\equiv n\\pmod p$ \u7684\u4e00\u4e2a\u89e3\u3002\n\n$\\quad$\u8a00\u5f52\u6b63\u4f20\uff0c\u7528\u8fd9\u79cd\u65b9\u6cd5\u53ef\u4ee5\u6c42\u51fa $\\sqrt{2}$ \u5728\u6a21 $p$ \u610f\u4e49\u4e0b\u7684\u503c\u4e3a $59713600$ \u6216 $940286407$.\n\n$\\quad$\u53e6\u4e00\u65b9\u9762\uff0c\u7531\u4e8e $n$ \u7684\u503c\u5f88\u5927\uff0c\u6839\u636e\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff0c\u53ef\u4ee5\u76f4\u63a5\u5c06\u5176\u5bf9 $p-1$ \u53d6\u6a21\u3002\n\n$\\quad$\u7efc\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 $\\Theta(\\log p)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e0b\u6c42\u51fa\u7b54\u6848 \uff1a\n\n$$g_n=14928400\\times \\left(59713601^{n~mod~(p-1)}-940286408^{n~mod~(p-1)}\\right)$$",
        "postTime": 1624613055,
        "uid": 78645,
        "name": "C\u3000C\u3000A",
        "ccfLevel": 6,
        "title": "The Solution of [\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206"
    },
    {
        "content": "\u9700\u8981\u638c\u63e1\u7528\u751f\u6210\u51fd\u6570\u89e3\u9012\u5f52\u5f0f\u7684\u6280\u5de7\u3002\n\n\u8bb0\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u7b2c $n$ \u9879\u4e3a $f_n$\uff0c\u751f\u6210\u51fd\u6570\u4e3a $F(x)=\\sum\\limits_{i=0}^\\infty f_ix^i$\u3002\n\n\u8bb0 $n$ \u6240\u6709\u62c6\u5206\u7684\u6743\u503c\u4e4b\u548c\u4e3a $s_n$\uff0c\u751f\u6210\u51fd\u6570\u4e3a $S(x)=\\sum\\limits_{i=0}^\\infty s_ix^i$\u3002\n\n$\\operatorname{DP}$ \u53ef\u5f97 $s_n=\\sum\\limits_{i=0}^{n-1}s_if_{n-i}$\uff0c\u8fd9\u662f\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u4e8e\u662f\u8003\u8651\u628a\u4e24\u8005\u7684\u751f\u6210\u51fd\u6570\u76f8\u4e58\uff0c\u6709\n\n$\\begin{aligned}\nF(x)S(x)&=\\sum\\limits_{i=0}^\\infty(\\sum\\limits_{j=0}^is_jf_{i-j})x^i\\\\\n\\because\\sum\\limits_{j=0}^is_jf_{i-j}&=s_if_0+\\sum\\limits_{j=0}^{i-1}s_jf_{i-j}=\\sum\\limits_{j=0}^{i-1}s_jf_{i-j}\\\\\n\\therefore F(x)S(x)&=\\sum\\limits_{i=0}^\\infty(\\sum\\limits_{j=0}^{i-1}s_jf_{i-j})x^i=\\sum\\limits_{i=1}^\\infty s_ix^i\\\\\n\\because S(x)&=s_0+\\sum\\limits_{i=1}^\\infty s_ix^i=1+\\sum\\limits_{i=1}^\\infty s_ix^i\\\\\n\\therefore F(x)S(x)&=S(x)-1\\\\\n\\therefore S(x)&=\\frac 1{1-F(x)}=\\frac 1{1-\\frac x{1-x-x^2}}=\\frac{1-x-x^2}{1-2x-x^2}\n\\end{aligned}$\n\n\u8bbe $\\begin{aligned}\\frac{1-x-x^2}{1-2x-x^2}=\\frac{1+Rx}{1-rx}+\\frac{Sx}{1-sx}=\\frac{1+(R+S-s)x-(rS+sR)x^2}{1-(r+s)x+rsx^2}\\end{aligned}$\n\n\u7cfb\u6570\u5bf9\u5e94\u53ef\u5f97 $\\begin{cases}R+S-s=-1\\\\rS+sR=1\\\\r+s=2\\\\rs=-1\\end{cases}$\uff0c\u89e3\u5f97 $\\begin{cases}R=-\\frac{2+3\\sqrt2}4\\\\S=\\frac{2-\\sqrt2}4\\\\r=1+\\sqrt2\\\\s=1-\\sqrt2\\end{cases}$\n\n$\\begin{aligned}\nS(x)&=\\frac{1-\\frac{2+3\\sqrt2}4x}{1-(1+\\sqrt2)x}+\\frac{\\frac{2-\\sqrt2}4x}{1-(1-\\sqrt2)x}\\\\\n&=\\frac1{1-(1+\\sqrt2)x}-\\frac{2+3\\sqrt2}4\\cdot\\frac x{1-(1+\\sqrt2)x}+\\frac{2-\\sqrt2}4\\cdot\\frac x{1-(1-\\sqrt2)x}\\\\\n&=\\frac1{1-(1+\\sqrt2)x}-\\frac{4-\\sqrt2}4\\cdot\\frac{(1+\\sqrt2)x}{1-(1+\\sqrt2)x}-\\frac{\\sqrt2}4\\cdot\\frac{(1-\\sqrt2)x}{1-(1-\\sqrt2)x}\\\\\n&=\\sum\\limits_{i=0}^\\infty(1+\\sqrt2)^ix^i-\\frac{4-\\sqrt2}4\\sum\\limits_{i=1}^\\infty(1+\\sqrt2)^ix^i-\\frac{\\sqrt2}4\\sum\\limits_{i=1}^\\infty(1-\\sqrt2)^ix^i\\\\\n&=1+\\sum\\limits_{i=1}^\\infty\\frac{\\sqrt2}4((1+\\sqrt2)^i-(1-\\sqrt2)^i)x^i\\\\\n\\therefore s_n&=\\frac{\\sqrt2}4((1+\\sqrt2)^n-(1-\\sqrt2)^n)\n\\end{aligned}$\n\n\u6ce8\u610f\u5230\u6709\u8d39\u9a6c\u5c0f\u5b9a\u7406 $a^{p-1}\\equiv1\\pmod{p}$\uff0c\u53ef\u5f97 $a^n\\equiv a^{n\\bmod (p-1)}\\pmod{p}$\u3002\u56e0\u6b64\u65e0\u9700\u9ad8\u7cbe\u5ea6\u5feb\u901f\u5e42\uff0c\u628a $n$ \u6a21 $10^9+6$ \u518d\u4f7f\u7528\u666e\u901a\u5feb\u901f\u5e42\u5373\u53ef\u3002\n\n\u5230\u6b64\uff0c\u5f97\u51fa\u4e86\u6b64\u9898\u7684\u601d\u8def\u3002\n\n```\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#define mod 1000000007\n#define rt2 59713600//\u6a211000000007\u610f\u4e49\u4e0b\u7684\u6839\u53f72 \nusing namespace std;\ntypedef long long ll;\nint a[100001],b[100001],res[100001];\nbool cmp(string s1,string s2)\n{\n    int n=s1.size(),m=s2.size();\n    int i=0;\n    while(i<n-1&&s1[i]=='0') ++i;\n    s1=s1.substr(i);\n    i=0;\n    while(i<m-1&&s2[i]=='0') ++i;\n    s2=s2.substr(i);\n    if(s1.size()!=s2.size()) return s1.size()<s2.size();\n    return s1<s2;\n}\nstring sub(string s1,string s2)\n{\n    int n=s1.size(),m=s2.size(),len=max(n,m);\n    for(int i=0;i<n;++i) a[i]=s1[n-1-i]-'0';\n    for(int i=n;i<len;++i) a[i]=0;\n    for(int i=0;i<m;++i) b[i]=s2[m-1-i]-'0';\n    for(int i=m;i<len;++i) b[i]=0;\n    for(int i=0;i<len;++i) res[i]=0;\n    for(int i=0;i<len;++i)\n\t{\n        res[i]+=a[i]-b[i];\n        if(res[i]<0)\n\t\t{\n            --res[i+1];\n            res[i]+=10;\n        }\n    }\n    int i=len-1;\n    while(res[i]==0&&i>0) --i;\n    string s=\"\";\n    for(;i>=0;--i) s+=res[i]+'0';\n    return s;\n}\nstring rem(string s1,string s2)\n{\n    string s=\"\";\n    int n=s1.size(),m=s2.size();\n    for(int i=0;i<n;++i)\n\t{\n        s+=s1[i];\n        while(!cmp(s,s2)) s=sub(s,s2);\n    }\n    return s;\n}\nll ksm(ll x,ll y)\n{\n\tll res=1;\n\twhile(y)\n\t{\n\t\tif(y&1) res=res*x%mod;\n\t\tx=x*x%mod;\n\t\ty>>=1;\n\t}\n\treturn res;\n}\nint main()\n{\n\tstring n;\n\tcin>>n;\n\tn=rem(n,\"1000000006\");//\u628a\u6307\u6570\u5bf9mod-1\u53d6\u6a21 \n\tint len=n.size();\n\tll pw=0;\n\tfor(int i=0;i<len;++i) pw=pw*10+n[i]-'0'; \n\tprintf(\"%lld\",(rt2*ksm(4,mod-2)%mod*(ksm(1+rt2,pw)-ksm(1-rt2,pw))%mod+mod)%mod);\n\treturn 0;\n}\n```",
        "postTime": 1660115331,
        "uid": 244009,
        "name": "TianTian2008",
        "ccfLevel": 0,
        "title": "P4451 \u9898\u89e3"
    },
    {
        "content": "### \u9898\u610f\n\n- \u7ed9\u5b9a $n$\uff0c\u6c42 \n- $$\\displaystyle\\sum_{m>0,a_1,a_2,\\ldots,a_m>0,\\sum_{i=1}^ma_i=n}\\prod_{i=1}^mF_{a_i}$$\n- \u5176\u4e2d $F_0=0,F_1=1,F_n=F_{n-1}+F_{n-2}(n>1)$\u3002\u7b54\u6848\u5bf9 $10^9+7$ \u53d6\u6a21\u3002\n- $1\\le{n}\\le{10^{10000}}$\u3002\n\n### \u505a\u6cd5\n\n#### update 2022.7.4\n\n\u611f\u8c22 $\\color{balck}\\text{y}\\color{red}\\text{spm}$ \u795e\u4ed9\u6307\u51fa\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u90a3\u91cc\u7684\u9519\u8bef\u3002\n\n\n------------\n\n\n\u4e0d\u59a8\u8bbe\u6700\u540e\u7684\u7b54\u6848\u662f $g_n$\uff0c\u4ee4 $g_0=1$\u3002\u90a3\u4e48\u6709\u9012\u63a8\u5f0f\uff1a\n\n$$g_n=\\left[n=0\\right]+\\sum_{i=1}^{n}g_i\\cdot{F_{n-i}}$$\n\n\n\u6240\u4ee5\u5c31\u6709\u751f\u6210\u51fd\u6570\uff1a\n\n$$\\begin{aligned}G(x)&=\\sum_{n=0}^{+\\infty}\\left(\\left[n=0\\right]+\\sum_{i=1}^ng_i\\cdot{F_{n-i}}\\right)x^n\\\\&=1+\\sum_{n=1}^{+\\infty}\\left(\\sum_{i=1}^ng_i\\cdot{F_{n-i}}\\right)x^n\\\\&=1+\\color{yellowgreen}\\sum_{n=1}^{+\\infty}\\left(\\sum_{i=1}^ng_i\\cdot{x_i}\\cdot{F_{n-i}\\cdot{x^{n-i}}}\\right)\\end{aligned}$$\n\n\u6ce8\u610f $\\color{yellowgreen}\\text{yellowgreen}$ \u7684\u90e8\u5206\uff0c\u5982\u679c\u8bbe\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u751f\u6210\u51fd\u6570\u4e3a $F(x)=\\dfrac{x}{1-x-x^2}$\uff08\u8fd9\u603b\u7b97\u662f\u57fa\u64cd\u4e86\u5427\uff0c\u5c31\u4e0d\u8d58\u8ff0\u4e86\uff09\uff0c\u5c31\u7b49\u4e8e $G(x)\\cdot{F(x)}$\u3002\n\n\u6240\u4ee5\n\n$$\\begin{aligned}G(x)&=1+G(x)\\times{F(x)}\\\\&=\\dfrac1{1-F(x)}\\\\&=\\dfrac1{1-\\dfrac{x}{1-x-x^2}}\\\\&=\\dfrac{1-x-x^2}{1-2x-x^2}\\\\&=\\dfrac{x^2+x-1}{x^2+2x-1}\\\\&=1-\\dfrac{x}{x^2+2x-1}\\end{aligned}$$\n\n\u5728 $\\displaystyle\\dfrac{1}{1-\\left(ax\\right)^k}=\\sum_{i=0}^{+\\infty}\\left(ax\\right)^{ik}$ \u7684\u6307\u5bfc\u4e0b\uff0c\u6211\u4eec\u8bd5\u7740\u5c06 $-\\dfrac{x}{x^2+2x-1}$ \u5c55\u5f00\u3002\u5c06 $x^2+2x-1$ \u56e0\u5f0f\u5206\u89e3\u6210 $\\left(x-x_1\\right)\\left(x-x_2\\right)$\uff0c\u5176\u4e2d $x_{1,2}=-1\\pm\\sqrt{2}$\u3002\n\n$$\\begin{aligned}-\\dfrac{x}{x^2+2x-1}&=\\dfrac{x}{(x-x_1)(x-x_2)}\\\\&=\\dfrac{x}{x_2-x_1}\\left(\\dfrac1{x-x_1}-\\frac1{x-x_2}\\right)\\\\&=\\dfrac{x}{x_2-x_1}\\left(\\frac1{x_2}\\frac1{1-\\frac{x}{x_2}}-\\frac1{x_1}\\frac1{1-\\frac{x}{x_1}}\\right)\\\\&=\\dfrac{x}{x_2-x_1}\\left(\\frac1{x_2}\\sum_{i=0}^{+\\infty}\\left(\\frac{x}{x_2}\\right)^i-\\frac1{x_1}\\sum_{i=0}^{+\\infty}\\left(\\frac{x}{x_1}\\right)^i\\right)\\\\&=\\frac1{x_2-x_1}\\left(\\sum_{i=0}^{\\infty}\\left(\\frac{x}{x_2}\\right)^{i+1}-\\sum_{i=0}^{\\infty}\\left(\\frac{x}{x_1}\\right)^{i+1}\\right)\\end{aligned}$$\n\n\u90a3\u4e48 $g_n=\\left[x^n\\right]G(x)=\\frac{\\sqrt{2}}4\\left(\\left(1+\\sqrt2\\right)^n-\\left(1-\\sqrt2\\right)^n\\right)$\u3002\n\n\u7531\u4e8c\u6b21\u5269\u4f59\u53ef\u77e5\uff0c$\\sqrt{2}$ \u5728 $\\bmod{10^9+7}$ \u65f6\u7b49\u4e8e $59713600$ \u6216 $940286407$\u3002\n\n\u7531 FLT\uff0c$n$ \u53ef\u6309 $\\bmod{10^9+6}$ \u7406\u89e3\uff0c\u4e8e\u662f\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(\\log{mod})$ \u7684\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst long long tmz=1e9+7;\nconst long long z=59713600;\ninline long long read()\n{\n\tlong long x=0,f=1;char c=getchar();\n\twhile(c<'0'||c>'9'){if(c=='-')f=-f;c=getchar();}\n\twhile(c>='0'&&c<='9'){x=x*10+c-'0';x%=(tmz-1);c=getchar();}\n\treturn x*f;\n}\nint n,x1,x2;\nlong long f(long long x,long long y)\n{\n\tlong long res=1,p=x;\n\twhile(y)\n\t{\n\t\tif(y&1)\tres=res*p%tmz;\n\t\tp=p*p%tmz;y>>=1;\n\t}\n\treturn res;\n}\nint main()\n{\n\tn=read();x1=z+1,x2=(1-z+tmz)%tmz;\n\tprintf(\"%lld\\n\",(x1*f((2+2*x1)%tmz,tmz-2)%tmz*f(x1,n)%tmz+x2*f((2+2*x2)%tmz,tmz-2)%tmz*f(x2,n)%tmz)%tmz);\n\treturn 0;\n}\n\n\n```\n\n",
        "postTime": 1647690876,
        "uid": 181775,
        "name": "_Fontainebleau_",
        "ccfLevel": 0,
        "title": "\u300c\u6574\u6570\u7684lqp\u62c6\u5206\u300d"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.org/problemnew/show/P4451)\n\n\u8bbe\u6211\u4eec\u8981\u6c42\u7684\u662f$g_n$\n\n\u6211\u4eec\u5f3a\u884c\u5b9a\u4e49$g_0=1$\n\n\u4e8e\u662f\u5c31\u6709\n\n$$g_i=\\sum_{j=0}^{i-1}fib_{j}g_{i-j}$$\n\n\u5c31\u662f\u65b0\u679a\u4e3e\u4e00\u4e2a$j$\uff0c\u901a\u8fc7\u4e00\u4e2a\u5206\u914d\u7387\u548c\u5728\u539f\u6765\u7684\u7b54\u6848\u4e0a\u66f4\u8fdb\u4e00\u6b65\n\n\u4e8e\u662f\u8fd9\u4e2a\u6570\u5217\u7684\u751f\u6210\u51fd\u6570\u5c31\u662f\n\n$$\\begin{aligned} G(x)=&\\sum_{i=0}(\\sum_{j=0}^{i-1}fib_jg_{i-j}+[i=0])x^i\\\\&=1+\\sum_{i=0}(\\sum_{j=0}^{i-1}fib_jg_{i-j})x^i\\\\&=1+\\sum_{i=0}\\sum_{j=0}^{i-1}fib_{j}x_j\\times g_{i-j}x^{i-j}\\end{aligned}$$\n\n\n\u53d1\u73b0\u91cc\u9762\u662f$fib$\u7684\u751f\u6210\u51fd\u6570\u5377\u4e0a$G(x)$\n\n\u8bbe\n\n$$F(x)=\\sum_{i=0}fib_ix^i=\\frac{x}{1-x-x^2}$$\n\n\u4e8e\u662f\u5c31\u6709\n\n$$G(x)=1+G(x)F(x)$$\n\n\u89e3\u5f97\n\n$$G(x)=\\frac{1-x-x^2}{1-2x-x^2}=\\frac{1-2x-x^2+x}{1-2x-x^2}=1+\\frac{x}{1-2x-x^2}$$\n\n\u53d1\u73b0\u591a\u51fa\u6765\u7684\u90a3\u4e2a\u5e38\u6570\u9879\u662f\u6211\u4eec\u5f3a\u884c\u4f7f\u5f97$g_0=1$\u7684\u7ed3\u679c\uff0c\u4e0d\u7ba1\u5b83\u5c31\u597d\u4e86\n\n\u5f3a\u884c\u5904\u7406\u540e\u9762\u7684$\\frac{x}{1-2x-x^2}$\n\n\u6211\u4eec\u53d1\u73b0\u5206\u6bcd\u4e0a\u53ef\u4ee5\u88ab\u56e0\u5f0f\u5206\u89e3\u4e00\u4e0b\n\n$$\\frac{x}{1-2x-x^2}=\\frac{x}{(1-(1-\\sqrt{2})x)(1-(1+\\sqrt{2})x)}$$\n\n\u4f60\u8bf4\u600e\u4e48\u641e\u8fd9\u4e2a\u56e0\u5f0f\u5206\u89e3\uff0c\u4f60\u628a$1-\\sqrt{2}$\u8bbe\u6210$\\frac{a\\pm\\sqrt{b}}{c}$\u7684\u5f62\u5f0f\n\n\u5c31\u4f1a\u53d1\u73b0\n\n$$\\frac{a+\\sqrt{b}}{c}\\times \\frac{a-\\sqrt{b}}{c}=\\frac{a^b-b}{c^2}=-1$$\n\n$$-(\\frac{a+\\sqrt{b}}{c}+ \\frac{a-\\sqrt{b}}{c})=-2$$\n\n\u6839\u636e\u4e0b\u9762\u90a3\u4e2a\u5f0f\u5b50\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0$a=c$\n\n\u4e8e\u662f\u4e0a\u9762\u90a3\u4e2a\u5f0f\u5b50\u5c31\u662f$2a^2-b=0$\uff0c\u6211\u4eec\u53d1\u73b0\u53ea\u9700\u8981\u4f7f\u5f97$a=1,b=2$\u5c31\u53ef\u4ee5\u4e86\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u53c8\u9700\u8981\u6765\u62c6\u6389\u8fd9\u4e2a\u5f0f\u5b50\n\n\u81f3\u4e8e\u8fd9\u4e2a\u5982\u4f55\u53bb\u62c6\uff0c\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u5217\u65b9\u7a0b\n\n\u8bbe\u4e0a\u9762\u90a3\u4e2a\u5f0f\u5b50\u7b49\u4e8e\n\n$$\\begin{aligned}&\\frac{a}{1-(1-\\sqrt{2})x}+\\frac{b}{1-(1+\\sqrt{2})x}\\\\&=\\frac{a(1-(1+\\sqrt{2})x)+b(1-(1-\\sqrt{2})x)}{(1-(1-\\sqrt{2})x)(1-(1+\\sqrt{2})x)}\\\\&=\\frac{a-ax-a\\sqrt{2}x+b-bx+b\\sqrt{2}x}{(1-(1-\\sqrt{2})x)(1-(1+\\sqrt{2})x)}\\end{aligned}$$\n\n\u6211\u4eec\u77e5\u9053\u4e0a\u9762\u90a3\u4e00\u5927\u5768\u4e1c\u897f\u5e94\u8be5\u7b49\u4e8e$x$\n\n\u4e8e\u662f\n\n$$a-ax-a\\sqrt{2}x+b-bx+b\\sqrt{2}x=x$$\n\n\u7531\u4e8e\u6ca1\u6709\u5e38\u6570\u9879\uff0c\u4e8e\u662f$a=-b$\n\n\u4e5f\u5c31\u6709\n\n$$-a\\sqrt{2}x+b\\sqrt{2}x=x$$\n\n\u89e3\u5f97$a=-\\frac{1}{2\\sqrt{2}},b=\\frac{1}{2\\sqrt{2}}$\uff0c\u6211\u4eec$a,b$\u653e\u5230\u5916\u9762\u5c31\u597d\u4e86\n\n\u53ef\u4ee5\u62c6\u6210\n\n$$-\\frac{\\sqrt{2}}{4}\\times\\frac{1}{1-(1-\\sqrt{2})x}+\\frac{\\sqrt{2}}{4}\\times \\frac{1}{1-(1+\\sqrt{2})x}$$\n\n\u53d1\u73b0\u6709\u4e24\u4e2a\u8bf8\u5982$\\frac{1}{1-cx}$\u7684\u751f\u6210\u51fd\u6570\uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a\u516c\u6bd4\u4e3a$c$\u7684\u7b49\u6bd4\u6570\u5217\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u63a8\u51fa\u901a\u9879\n\n$$g_n=-\\frac{\\sqrt{2}}{4}\\times (1-\\sqrt{2})^n+\\frac{\\sqrt{2}}{4}\\times(1+\\sqrt{2})^n$$\n\n\u7531\u4e8e\u6211\u6bd4\u8f83\u83dc\uff0c\u4e0d\u4f1a\u4e8c\u6b21\u5269\u4f59\uff0c\u53ef\u4ee5\u5199\u4e2a\u66b4\u529b\u6c42\u4e00\u4e0b$x^2 \\equiv 2(mod\\ 1e9+7)$\uff0c\u53d1\u73b0$x=59713600$\n\n\u6839\u636e\u901a\u9879\u5c31\u53ef\u4ee5\u6c42\u4e86\uff0c\u5c31\u662f\u4e00\u4e2a\u5feb\u901f\u5e42\u7684\u4e8b\n\n```cpp\n#include<cstdio>\n#define LL long long\nconst LL mod=1e9+7;\nconst LL Sqr=59713600;\nconst LL Inv=250000002;\nLL n;\ninline LL ksm(LL a,LL b) {LL S=1;while(b) {if(b&1) S=S*a%mod;b>>=1;a=a*a%mod;}return S;}\nint main() {\n\tscanf(\"%lld\",&n);\n\tprintf(\"%lld\\n\",((ksm(1+Sqr,n)*Sqr%mod*Inv%mod-ksm(1-Sqr+mod,n)*Sqr%mod*Inv)%mod+mod)%mod);\n}\n```\n",
        "postTime": 1552611015,
        "uid": 35178,
        "name": "asuldb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4451 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206\u3011"
    },
    {
        "content": "\u9898\u610f\u660e\u786e\uff0c\u4e0d\u518d\u9610\u8ff0\uff08\n\n\u9996\u5148\uff0c\u4f17\u6240\u5468\u77e5\u7684\u662f \u6590\u6ce2\u90a3\u5951\u6570\u5217 \u7684\u751f\u6210\u51fd\u6570\u662f $ F(x)=\\frac x {1-x-x^2} $\n\n\u90a3\u4e48\u7b54\u6848\u5c31\u662f $\\sum_{i=0} F^i(x) = \\frac 1 {1-F(x)} = \\frac {1-x-x^2} {1-2x-x^2} $ \u7684\u7b2c $ n $ \u9879\u3002\n\n\u9996\u5148\u6211\u4eec\u628a\u5206\u5b50\u548c\u5206\u6bcd\u5206\u5f00\u8003\u8651\uff0c\u56e0\u4e3a\u5982\u679c\u77e5\u9053\u4e86\u5206\u6bcd\u6240\u4ee3\u8868\u7684\u751f\u6210\u51fd\u6570\u7684\u7b2c $ n $ \u9879\uff0c\u7b54\u6848\u5c31\u5f88\u660e\u663e\u4e86\u3002\u3002\u3002\n\n\u5c1d\u8bd5\u628a $ \\frac 1 {1-2x-x^2} $ \u5206\u89e3\u6210 $ \\frac A {1-ax} - \\frac B {1-bx} $ \u7684\u5f62\u5f0f\u3002\n\n\u89e3 $ -x^2 -2x +1 =0 $ \u8fd9\u4e2a\u65b9\u7a0b\uff0c\u5f97\u5230 $ x_1 = -1 + \\sqrt 2 $\uff0c$ x_2 = -1 - \\sqrt 2 $\n\n\u6839\u636e\u56e0\u5f0f\u5b9a\u7406\u53ef\u5f97\uff1a\n$$ 1 -2x -x^2 = (-1)(-1 + \\sqrt 2 -x)(-1 - \\sqrt2 -x) $$\n$$ \\frac 1 {1 -2x -x^2} = - \\frac 1 {(-1 +\\sqrt 2 -x)(-1 -\\sqrt 2 -x)} $$\n\u7136\u540e\u6211\u4eec\u53d1\u73b0 $ \\frac 1 {-1 -\\sqrt 2 -x} - \\frac 1 {-1 +\\sqrt 2 -x} = \\frac {2\\sqrt 2} {(-1 +\\sqrt 2 -x)(-1 -\\sqrt 2 -x)} $\n\u90a3\u4e48\uff1a\n$$ \\frac 1 {1 -2x -x^2} = (\\frac 1 {-1 +\\sqrt 2 -x} - \\frac 1 {-1 -\\sqrt 2 -x})\\frac 1 {2\\sqrt 2} $$\n\u770b\u4e00\u4e0b\u62ec\u53f7\u91cc\u8fb9\u7684\u4e1c\u897f\uff0c\u6211\u4eec\u77e5\u9053 $ \\frac 1 {a - x} = \\frac {\\frac 1 a} {1 - \\frac 1 a x} $\uff0c\u7136\u540e\u62ec\u53f7\u91cc\u53d8\u6210\u4e86\u8fd9\u6837\uff1a\n$$ \\frac {1 + \\sqrt 2} {1 - (1 + \\sqrt 2)x} - \\frac {1 - \\sqrt 2} {1 - (1 - \\sqrt 2)x} $$\n\u663e\u7136\uff0c\u7b2c $ n $ \u9879\u4e3a $ (1 +\\sqrt 2)^{n+1} - (1 -\\sqrt 2)^{n+1} $\n\n\u4e58\u4e0a\u53f3\u8fb9\u7684 $ \\frac 1 {2\\sqrt 2} $ \u548c $ 1 -x -x^2 $\uff0c\u7b54\u6848\u5c31\u662f\uff1a\n$$ \\frac 1 {2\\sqrt 2}((1 +\\sqrt 2)^{n+1} + (1 +\\sqrt 2)^n + (1 +\\sqrt 2)^{n-1} - ((1 -\\sqrt 2)^{n+1} + (1 -\\sqrt 2)^n + (1 -\\sqrt 2)^{n-1})) $$\n\u5316\u7b80\u53ef\u5f97\uff1a\n$$ ans = \\frac {\\sqrt 2} 4((1 +\\sqrt2)^n - (1 -\\sqrt 2)^n) $$\n\u7136\u540e\u6211\u4eec\u7528[\u4e8c\u6b21\u5269\u4f59](https://www.luogu.com.cn/paste/pzom8ca9)\u53ef\u77e5\uff1a\n$$ 59713600 \\equiv \\sqrt 2 \\pmod {10^9+7} $$\n\u90a3\u4e48\u5c31\u53ef\u4ee5 $ O(\\log mod) $ \u6109\u5feb\u5730\u505a\u6389\u4e86\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<cctype>\n#include<cstdio>\nconst int mod=1e9+7,MOD=mod-1,sqrt2=59713600ll;\ninline int Add(const int&a,const int&b){\n\treturn a+b>=mod?a+b-mod:a+b;\n}\ninline int Del(const int&a,const int&b){\n\treturn a-b<0?a-b+mod:a-b;\n}\ninline int pow(int a,int b){\n\tint ans=1;\n\tfor(;b;b>>=1,a=1ll*a*a%mod)if(b&1)ans=1ll*ans*a%mod;\n\treturn ans;\n}\nsigned main(){\n\tchar s=getchar();int n=0;\n\twhile(n=(n*10ll+(48^s))%MOD,s=getchar(),s>=48&&s<=58);\n\tprintf(\"%d\",1ll*sqrt2*pow(4,mod-2)%mod*Del(pow(Add(1,sqrt2),n),pow(Del(1,sqrt2),n))%mod);\n}\n```",
        "postTime": 1608717521,
        "uid": 160839,
        "name": "Prean",
        "ccfLevel": 7,
        "title": "\u6570\u8bba \u751f\u6210\u51fd\u6570 P4451\u9898\u89e3"
    },
    {
        "content": "\u66fe\u7ecf\u5e74\u5c11\u65e0\u77e5\u7684\u65f6\u5019\u628a\u4ed6\u6254\u8fdb\u4e86\u4efb\u52a1\u5217\u8868\uff0c\u73b0\u5728\u628a\u4ed6\u6e05\u6389\u5427\n\n\u662f\u6bd4\u8f83\u6e05\u65b0\u7684\u4e00\u9053 Generating Function \u7684\u9898\u76ee\n\n## \u5206\u6790\n\n\u9898\u610f\u662f\u663e\u7136\u7684\uff0c\u6211\u4eec\u53ea\u8981\u638c\u63e1\u4e00\u4e9b\u57fa\u7840\u77e5\u8bc6\u5c31\u884c\u3002\n\n\u7b80\u5355\u6c42\u4e00\u4e0b\u6590\u6ce2\u90a3\u5951\u6570\u5217\u751f\u6210\u51fd\u6570\u7684\u5c01\u95ed\u5f62\u5f0f\uff1a\n\n$$\\begin{aligned}F(x)=0+1x+&1x^2+2x^3+3x^4+5x^5\\cdots\\\\x\\cdot F(x)=\\quad\\ \\ \\ 0x+&1x^2+1x^3+2x^4+3x^5\\cdots\\\\x^2\\cdot F(x)=\\ \\ \\ \\quad\\quad\\quad&0x^2+1x^3+1x^4+2x^5\\cdots\\end{aligned}$$\n\n\u5bb9\u6613\u53d1\u73b0\uff0c\u5b9e\u9645\u4e0a\u5b58\u5728 $F(x)\\times(1-x-x^2)=x$\u3002\n\n\u6240\u4ee5\u5ba2\u89c2\u4e0a\u5b58\u5728 $F(x)=\\dfrac{x}{1-x-x^2}$\uff0c~~\u867d\u7136\u8fd9\u662f\u5e38\u8bc6~~\u3002\n\n\u6211\u4eec\u628a\u7b54\u6848\u7684\u7b2c $n$ \u9879\u8bbe\u4e3a $g_n$\uff0c\u4e0d\u96be\u53d1\u73b0\u6839\u636e\u9898\u610f\u6709\uff1a\n\n$$g_n=\\sum\\limits_{i=1}^{n}g_i\\times f_{n-i}$$\n\n\u7eaf\u7cb9\u4ee5\u65b9\u4fbf\u4e3a\u5686\u77e2\u8bbe $g_0=1$\uff0c\u85c9\u8c13\u8bcd\u51fd\u6570\u4e4b\u8868\u8fbe\uff0c\u5bb9\u6613\u5199\u51fa\uff1a\n\n$$g_n=[n=0]+\\sum\\limits_{i=1}^{n}g_i\\times f_{n-i}$$\n\n\u5bf9\u5176\u6c42\u751f\u6210\u51fd\u6570\u4fbf\u5f97\u4ee5\u66f4\u8fdb\u4e00\u6b65\uff1a\n\n$$\\begin{aligned}G(x)=&\\sum\\limits_{n=1}^{\\infty}\\bigg([n=0]+\\sum\\limits_{i=1}^{n}g_i\\times f_{n-i}\\bigg)x^n\\\\=&1+\\sum\\limits_{n=1}^{\\infty}\\sum\\limits_{i=1}^{n}g_i\\times f_{n-i}\\\\=&F(x)\\times G(x)+1\\end{aligned}$$\n\n\u6700\u540e\u5c06\u6590\u6ce2\u90a3\u5951\u6570\u5217\u548c\u7b54\u6848\u4e24\u8005\u751f\u6210\u51fd\u6570\u8054\u7cfb\u8d77\u6765\u7684\u5f0f\u5b50\u53ef\u8c13\u662f\u5207\u4e2d\u80af\u7d6e\uff0c\u7ecf\u8fc7\u7b80\u5355\u7684\u4ee3\u6570\u53d8\u6362\u4e0d\u96be\u5f97\u5230\uff1a\n\n$$\\dfrac{x}{1-x-x^2}\\times G(x)+1=G(x)$$\n\n$$1=G(x)\\times\\left(1-\\dfrac{x}{1-x-x^2}\\right)$$\n\n\u6240\u4ee5 $G(x)$ \u7684\u5c01\u95ed\u5f62\u5f0f\u547c\u4e4b\u6b32\u51fa\uff1a\n\n$$\\dfrac{1}{1-F(x)}=1+\\dfrac{x}{x^2+2x-1}$$\n\n\u5bf9\u4e8e\u5206\u6bcd\u6c42\u5176\u4e8c\u6839\u5f97 $x_{1,2}=-1\\pm\\sqrt{2}$\uff0c\u8fdb\u4e00\u6b65\u5c06\u539f\u5f0f\u56e0\u5f0f\u5206\u89e3\u5f97\uff1a\n\n$$1+\\dfrac{x}{x^2+2x-1}=1+\\dfrac{x}{(1-x+\\sqrt{2}x)(1-x-\\sqrt{x})}$$\n\n\u7136\u540e\u4f60\u7b80\u5355\u63a8\u4e00\u4e0b\u7279\u503c\u57fa\u672c\u4e0a\u5c31\u80fd\u53d1\u73b0\uff1a\n\n$$a_n=\\dfrac{\\sqrt 2-1}{2\\sqrt 2}(-\\sqrt 2+1)^n+\\dfrac{\\sqrt 2+1}{2\\sqrt 2}(\\sqrt 2+1)^n$$\n\n\u5bf9\u4e8e $\\sqrt{2}$ \u8fd9\u4e00\u90e8\u5206\u4f60\u53ef\u80fd\u9700\u8981\u7528\u4e8c\u6b21\u5269\u4f59\u7684\u7ed3\u8bba\u6765\u5904\u7406\uff0c\u4e5f\u5c31\u662f\u8bf4\u5728\u6a21 $10^9+7$ \u610f\u4e49\u4e0b\uff0c\u5b58\u5728\uff1a\n\n$$\\sqrt{2}\\equiv59713600\\pmod{10^9+7}$$\n\n\u6700\u540e\u4ee3\u7801\u91cc\u53ef\u4ee5\u7528\u8d39\u9a6c\u5c0f\u5b9a\u7406\u548c\u5feb\u901f\u5e42\u89e3\u51b3\u8fd9\u9898\u3002\n\n~~\u5199\u4ee3\u7801\u4e00\u5f00\u59cb\u4e0d\u77e5\u9053\u4e3a\u5565\u88ab\u5361\u5230 60 \u5206\u4e86~~\n\n\u7136\u540e\u4f60\u53ef\u4ee5\u628a\u9006\u5143\u90e8\u5206\u5148\u5904\u7406\u597d\u4e00\u4e0b\uff0c\u8981\u4e0d\u7136\u53ef\u80fd\u4f1a T\uff0c\u53e6\u5916\u7b54\u6848\u662f $a_{n-1}$ \u800c\u4e0d\u662f $a_n$\uff0c\u5e76\u4e14\u4f60\u5b9e\u9645\u4e0a\u8bfb\u5165\u7684\u65f6\u5019\u8981\u5bf9 $10^9+6$ \u53d6\u6a21\uff0c\u5426\u5219\u4f1a\u51fa\u4e8b\u3002\n\n\u7ed9\u51fa\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long \n#define mod 1000000007\n#define s2 59713600\n#define Inv 14928400\nusing namespace std;\ninline int read(){\n\tint x=0,f=1;char ch=getchar();\n\twhile (ch<'0'||ch>'9'){if (ch=='-') f=-1;ch=getchar();}\n\twhile (ch>='0'&&ch<='9'){x=x*10+ch-48;x=x%(mod-1);ch=getchar();}\n\treturn x*f%(mod-1);\n}int n,c1,c2;\nint ksm(int a,int b){\n\tint ans=1;\n\twhile(b){\n\t\tif(b&1)ans=ans*a%mod;\n\t\ta=a*a%mod;\n\t\tb>>=1;\n\t}return ans;\n}signed main(){\n\tn=read();\n\tc1=(s2-1)%mod;c2=(s2+1)%mod;\n\tcout<<((c1*ksm(1+mod-s2,n-1)%mod\n\t\t   +c2*ksm(s2+1,n-1)%mod)%mod)*Inv%mod;\n\treturn 0;\n}\n```\n\n\n",
        "postTime": 1626746458,
        "uid": 212283,
        "name": "Aw\u987f\u987f",
        "ccfLevel": 5,
        "title": "\u3010\u9898\u89e3\u3011P4451 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206"
    },
    {
        "content": "## \u9898\u610f\u7b80\u8ff0\n\n\u6c42\n\n$$\n\\sum\\prod_{i=1}^{m}F_{a_{i}},(m>0,a_{1},\\cdots a_{m}>0,\\sum a_{i}=n)\n$$\n\n## \u9898\u89e3\n\n\u8fd9\u662f\u4e00\u7bc7\u4e0d\u7528 $\\mathbf{OGF}$ \u7684\u9898\u89e3\u3002\n\n\u8bbe $f_{i}$ \u4e3a $i$ \u7684 $\\operatorname{lqp}$ \u62c6\u5206\u503c\u3002\n\n\u7136\u540e\u6709\u663e\u7136\u7684\u8fc7\u4e0d\u4e86\u9012\u63a8\u5f0f\uff1a\n\n$$\nf_{n}=\\begin{cases}\n1,n=0 \\\\\n\\displaystyle\n\\sum_{i=0}^{n-1}F_{n-i}\\times f_{i},n\\neq0\n\\end{cases}\n$$\n\n\u7136\u540e\u4f20\u7edf\u827a\u80fd\u9519\u4f4d\u76f8\u51cf\u64cd\u4f5c\u4e00\u4e0b\uff1a\n\n$$\n\\begin{aligned}\nf_{n}&=\\sum_{i=0}^{n-1}F_{n-i}\\times f_{i} \\\\\nf_{n-1}&=\\sum_{i=0}^{n-2}F_{n-i-1}\\times f_{i} \\\\\nf_{n-2}&=\\sum_{i=0}^{n-3}F_{n-i-2}\\times f_{i}\n\\end{aligned}\n\\Longrightarrow\n\\begin{aligned}\nf_{n}-f_{n-1}-f_{n-2}&=\\sum_{i=0}^{n-1}F_{n-i}\\times f_{i}-\\sum_{i=0}^{n-2}F_{n-i-1}\\times f_{i}-\\sum_{i=0}^{n-3}F_{n-i-2}\\times f_{i} \\\\\nf_{n}-f_{n-1}-f_{n-2}&=(F_{2}-F_{1})\\times f_{n-2}+F_{1}\\times f_{n-1}\n\\end{aligned}\n\\\\\n\\downarrow \\\\\nf_{n}=2f_{n-1}+f_{n-2}\n$$\n\n\u9012\u63a8\u516c\u5f0f\u6709\u4e86\uff0c\u7136\u540e\u77e9\u9635\u5feb\u901f\u5e42\uff1a\n\n$$\n\\begin{bmatrix}\nf_{n} \\\\\nf_{n-1}\n\\end{bmatrix}\n=\\begin{bmatrix}\n2f_{n-1}+f_{n-2} \\\\\nf_{n-1}\n\\end{bmatrix}\n=\\begin{bmatrix}\nf_{n-1} \\\\\nf_{n-2}\n\\end{bmatrix}\n\\times\\begin{bmatrix}\n2 & 1 \\\\\n1 & 0\n\\end{bmatrix}\n$$\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u505a\u4e86\uff08\u5417\uff1f\uff09\uff1a\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#include <queue>\n#define mod ( 1000000007 )\n\nusing namespace std;\ntypedef long long LL;\n\ntemplate<typename _T, typename _P>\n_T qkpow( _T bas, _T one, _P fur ){\n\t_T res = one;\n\twhile( fur != 0 ){\n\t\tif( fur % 2 == ( _P )1 )\tres = bas * res;\n\t\tbas = bas * bas;\n\t\tfur /= 2;\n\t}\n\treturn res;\n}\n\ntemplate<typename _T>\n_T add( _T x, _T y ){ if( y >= mod )\ty %= mod; x += y; if( x >= mod )\tx -= mod; return x; }\n\nstruct bigInt : vector<int>{\n\tbigInt &check( ){\n\t\twhile( ! empty( ) && ! back( ) ) pop_back( );\n\t\tif( empty( ) )\treturn *this;\n\t\tfor( unsigned i = 1; i < size( ); ++ i ){ ( *this )[i] += ( *this )[i - 1] / 10; ( *this )[i - 1] %= 10; }\n\t\twhile( back( ) >= 10 ){ push_back( back( ) / 10 ); ( *this )[size( ) - 2] %= 10; }\n\t\treturn *this;\n\t}\n\tbigInt( int tpN = 0 ){ push_back( tpN ); check( ); }\n};\nistream &operator >> ( istream &is, bigInt &tpN ){\n\tstring s;\n\tis >> s; tpN.clear( );\n\tfor( int i = s.size( ) - 1; i >= 0; --i ) tpN.push_back( s[i] - '0' );\n\treturn is;\n}\nostream &operator << ( ostream &os, const bigInt &tpN ){\n\tif( tpN.empty( ) )\tos << 0;\n\tfor( int i = tpN.size( ) - 1; i >= 0; --i )\tos << tpN[i];\n\treturn os;\n}\nbool operator != ( const bigInt &one, const bigInt &another ){\n\tif( one.size( ) != another.size( ) )\treturn 1;\n\tfor( int i = one.size( ) - 1; i >= 0; --i ){\n\t\tif( one[i] != another[i] )\treturn 1;\n\t}\n\treturn 0;\n}\nbool operator == ( const bigInt &one, const bigInt &another ){\n\treturn ! ( one != another );\n}\nbool operator < ( const bigInt &one, const bigInt &another ){\n\tif( one.size( ) != another.size( ) )\treturn one.size( ) < another.size( );\n\tfor( int i = one.size( ) - 1; i >= 0; --i ){\n\t\tif( one[i] != another[i] )\treturn one[i] < another[i];\n\t}\n\treturn 0;\n}\nbool operator > ( const bigInt &one, const bigInt &another ){ return another < one; }\nbool operator <= ( const bigInt &one, const bigInt &another ){ return ! (one > another ); }\nbool operator >= ( const bigInt &one, const bigInt &another ){ return ! (one < another ); }\nbigInt &operator += ( bigInt &one, const bigInt &another ){\n\tif( one.size( ) < another.size( ) )\tone.resize(another.size( ) );\n\tfor( unsigned i = 0; i != another.size( ); ++ i ) one[i] += another[i];\n\treturn one.check( );\n}\nbigInt operator + ( bigInt one, const bigInt &another ){ return one += another; }\nbigInt &operator -= ( bigInt &one, bigInt another ){\n\tif( one < another )\tswap( one, another );\n\tfor( unsigned i = 0; i != another.size( ); one[i] -= another[i], ++ i ){\n\t\tif( one[i] < another[i] ){\n\t\t\tunsigned j = i + 1;\n\t\t\twhile( ! one[j] ) ++ j;\n\t\t\twhile( j > i ){ -- one[j]; one[--j] += 10; }\n\t\t}\n\t}\n\treturn one.check( );\n}\nbigInt operator - ( bigInt one, const bigInt &another ){ return one -= another; }\nbigInt operator * ( const bigInt &one, const bigInt &another ){\n\tbigInt tpN;\n\ttpN.assign( one.size( ) + another.size( ) - 1, 0 );\n\tfor( unsigned i = 0; i != one.size( ); ++ i ){\n\t\tfor( unsigned j = 0; j != another.size( ); ++ j ) tpN[i + j] += one[i] * another[j];\n\t}\n\treturn tpN.check( );\n}\nbigInt &operator *= ( bigInt &one, const bigInt &another ){ return one = one * another; }\nbigInt divMod( bigInt &one, const bigInt &another ){\n\tbigInt ans;\n\tfor( int t = one.size( ) - another.size( ); one >= another; -- t ){\n\t\tbigInt tpS;\n\t\ttpS.assign( t + 1, 0 );\n\t\ttpS.back( ) = 1;\n\t\tbigInt tpM = another * tpS;\n\t\twhile( one >= tpM ){ one -= tpM; ans += tpS; }\n\t}\n\treturn ans;\n}\nbigInt operator / ( bigInt one, const bigInt &another ){ return divMod(one, another ); }\nbigInt &operator /= ( bigInt &one, const bigInt &another ){ return one = one / another; }\nbigInt &operator %= ( bigInt &one, const bigInt &another ){ divMod( one, another ); return one; }\nbigInt operator % ( bigInt one, const bigInt &another ){ return one %= another; }\n\nstruct matrixS{\n\tint mat[2][2];\n\tmatrixS( int x = 0 ){ memset( mat, x, sizeof( mat ) ); }\n\tmatrixS operator * ( const matrixS &another ) const{\n\t\tmatrixS res;\n\t\tfor( int i = 0; i < 2; ++ i ){\n\t\t\tfor( int j = 0; j < 2; ++ j ){\n\t\t\t\tfor( int k = 0; k < 2; ++ k )\tres.mat[i][j] = add( ( LL )res.mat[i][j], ( LL )mat[i][k] * another.mat[k][j] );\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t}\n} unit, erng;\n\nbigInt N;\n\nvoid progressBaseInformation( ){\n\tint unitS[2][2] = { { 1, 0 }, { 0, 1 } };\n\tmemcpy( unit.mat, unitS, sizeof( unitS ) );\n\tint erngS[2][2] = { { 2, 1 }, { 1, 0 } };\n\tmemcpy( erng.mat, erngS, sizeof( erngS ) );\n}\n\nsigned main( ){\n\tios::sync_with_stdio( 0 ); cin.tie( 0 ); cout.tie( 0 );\n\tprogressBaseInformation( );\n\tcin >> N; cout << qkpow( erng, unit, N ).mat[1][0] << '\\n';\n\treturn 0;\n}\n```\n\n\u4e0d\uff0c\u51c9\u5fc3\u51fa\u9898\u4eba\u53cb\u597d\u5730\u5361\u4e86\u9ad8\u7cbe\u7684\u5e38\u6570\uff0c\u4e8e\u662f\u4f60\u6253\u5f00\u9898\u89e3\uff0c\u53d1\u73b0 $f_{n}=f_{n\\bmod (10^{9}+6)}$\uff0c\u4e8e\u662f\u4f60\u53c8\u884c\u4e86\u3002\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <queue>\n#define mod ( 1000000007 )\n\nusing namespace std;\ntypedef long long LL;\n\ntemplate<typename _T>\nvoid read( _T &x ){\n\tx = 0; char c = getchar( ); _T f = 1;\n\twhile( c < '0' || c > '9' ){ if( c == '-' )\tf = -1; c = getchar( ); }\n\twhile( c >= '0' && c <= '9' ){ x = ( ( x << 3 ) + ( x << 1 ) + ( c & 15 ) ) % ( mod - 1 ); c = getchar( ); }\n\tx *= f;\n}\n\ntemplate<typename _T>\nvoid write( _T x ){\n\tif( x < 0 ){ putchar( '-' ); x = -x; }\n\tif( x > 9 )\twrite( x / 10 );\n\tputchar( x % 10 + '0' );\n}\n\ntemplate<typename _T, typename _P>\n_T qkpow( _T bas, _T one, _P fur ){\n\t_T res = one;\n\twhile( fur != 0 ){\n\t\tif( fur % 2 == ( _P )1 )\tres = bas * res;\n\t\tbas = bas * bas;\n\t\tfur /= 2;\n\t}\n\treturn res;\n}\n\ntemplate<typename _T>\n_T add( _T x, _T y ){ if( y >= mod )\ty %= mod; x += y; if( x >= mod )\tx -= mod; return x; }\n\nstruct matrixS{\n\tint mat[2][2];\n\tmatrixS( int x = 0 ){ memset( mat, x, sizeof( mat ) ); }\n\tmatrixS operator * ( const matrixS &another ) const{\n\t\tmatrixS res;\n\t\tfor( int i = 0; i < 2; ++ i ){\n\t\t\tfor( int j = 0; j < 2; ++ j ){\n\t\t\t\tfor( int k = 0; k < 2; ++ k )\tres.mat[i][j] = add( ( LL )res.mat[i][j], ( LL )mat[i][k] * another.mat[k][j] );\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t}\n} unit, erng;\n\nLL N;\n\nvoid progressBaseInformation( ){\n\tint unitS[2][2] = { { 1, 0 }, { 0, 1 } };\n\tmemcpy( unit.mat, unitS, sizeof( unitS ) );\n\tint erngS[2][2] = { { 2, 1 }, { 1, 0 } };\n\tmemcpy( erng.mat, erngS, sizeof( erngS ) );\n}\n\nsigned main( ){\n\tprogressBaseInformation( );\n\tread( N ); write( qkpow( erng, unit, N ).mat[1][0] ), putchar( '\\n' );\n\treturn 0;\n}\n```",
        "postTime": 1603777119,
        "uid": 161849,
        "name": "cirnovsky",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4451 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206\u3011"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c,~~\u5982\u679c\u4e0b\u9762LaTeX\u70b8\u4e86\u53ef\u4ee5\u770b\u8fd9\u4e2a~~](https://blog.zcmimi.top/posts/LG%204451%20[%E5%9B%BD%E5%AE%B6%E9%9B%86%E8%AE%AD%E9%98%9F]%E6%95%B4%E6%95%B0%E7%9A%84lqp%E6%8B%86%E5%88%86)\n\n\n\u62c6\u5206\u4e3a$m$\u9879\u65f6,\u751f\u6210\u51fd\u6570\u4e3a$F^m (x)$\n\n\u90a3\u4e48\u7b54\u6848\u7684\u751f\u6210\u51fd\u6570\u4e3a$\\displaystyle G(x)=\\sum_{i=0}^{\\infty} F^i(x)$\n\n$F$\u4e3a\u6590\u6ce2\u90a3\u5951\u6570\u5217\u751f\u6210\u51fd\u6570,$\\displaystyle F(x)=\\frac x{1-x-x^2}$\n\n$\n\\begin{aligned}\nG(x)\n&=\\sum_{i=0}^{\\infty} F^i(x)\\\\\n&=\\frac 1{1-F(x)}\\\\\n&=\\frac {1-x-x^2}{1-2x-x^2}\\\\\n&=1+\\frac x{1-2x-x^2}\\\\\n&=1+\\frac x{[1-(1+\\sqrt 2)x][1-(1-\\sqrt2)x]}\\\\\n&=1+\\frac 1{2\\sqrt 2}\\left( \\frac 1{1-(1+\\sqrt 2)x} - \\frac 1{1-(1-\\sqrt 2)x} \\right)\\\\\n&=1+\\sum_{i=1}^{\\infty} \\frac{(1+\\sqrt 2)^i-(1-\\sqrt 2)^i}{2\\sqrt 2} x^i\n\\end{aligned}\n$\n\n\u90a3\u4e48:\n\n$\\displaystyle\nans_n=\\frac{(1+\\sqrt 2)^n-(1-\\sqrt 2)^n}{2\\sqrt 2}\n$\n\n\u5176\u4e2d$\\sqrt 2 \\equiv 59713600 \\pmod{10^9+7}$(\u4e8c\u6b21\u5269\u4f59)\n\n\u8fd9\u6837\u7684\u8bdd:\n\n$\\displaystyle\n\\begin{aligned}\nans_n\n&=\\frac {\\sqrt 2}4\\left[(1+\\sqrt 2)^n-(1-\\sqrt 2)^n\\right]\\\\\n&\\equiv 59713600\\times 250000002\\times [(1+59713600)^n-(1-59713600)^n] \\pmod{10^9+7}\n\\end{aligned}\n$\n\n\u4f7f\u7528\u5feb\u901f\u5e42\u590d\u6742\u5ea6$O(\\log n)$\n\n\u8003\u8651\u8d39\u9a6c\u5c0f\u5b9a\u7406: $ans_n \\equiv ans_{n \\mod 10^9+6}$\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u628a$n$\u538b\u5230$10^9+6$\u4ee5\u5185\u4e86,\u518d\u5feb\u901f\u5e42\u5373\u53ef\n\n```cpp\n#include<cstdio>\nconst int P=1000000007;\nint n;\nvoid readn(){\n    char c;int p=P-1;\n    for(c=getchar();c<'0'||'9'<c;c=getchar());\n    for(n=c-48,c=getchar();'0'<=c&&c<='9';n=(10ll*n+c-48)%p,c=getchar());\n}\nint pw(int x,int b){\n    int res=1;\n    while(b){\n        if(b&1)res=1ll*res*x%P;\n        b>>=1,x=1ll*x*x%P;\n    }\n    return res;\n}\nint main(){\n    readn();\n    int t=1ll*59713600*250000002%P,\n        a=(pw(59713601,n)-pw(940286408,n)+P)%P;\n    printf(\"%d\\n\",1ll*t*a%P);\n}\n```\n\n~~luogu\u6700\u8fd1LaTeX\u6709\u70b9\u9505(\u5df2\u7ecf\u4fdd\u8bc1\u7f16\u8f91\u9875\u9762\u548c\u535a\u5ba2\u9875\u9762\u6ca1\u70b8\u4e86,\u5982\u679c\u70b8\u4e86\u5e0c\u671b\u7ba1\u7406\u80fd\u591f\u5e2e\u5fd9\u4fee\u4e00\u4e0b)~~",
        "postTime": 1594302063,
        "uid": 36532,
        "name": "localhost",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4451 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206\u3011"
    },
    {
        "content": "\u6784\u9020 $fib$ \u6570\u5217\u7684\u6bcd\u51fd\u6570 $F(x)$\n\n\u90a3\u4e48\u7b54\u6848\u5c31\u662f\n$$[x^n]\\sum_{i=1}^{\\infty}F^i(x)=[x^n]\\frac{F(x)}{1-F(x)}$$\n\n\u800c\n\n$$F(x)=xF(x)+x^2F(x)+x,F(x)=\\frac{x}{1-x-x^2}$$\n\n\u6240\u4ee5\u7b54\u6848\u5c31\u662f\n\n$$[x^n]\\frac{x}{1-2x-x^2}$$\n\n\u9012\u63a8\u5f0f\u51fa\u6765\u4e86\u76f4\u63a5 $\\Theta(n)$ \u9012\u63a8\n\n\u6216\u8005\u6c42\u51fa\u901a\u9879\n\n$$\\frac{(\\sqrt{2}+1)^n-(1-\\sqrt{2})^n}{2\\sqrt{2}}$$\n\u7136\u540e $\\Theta(logn)$ \u51fa\u89e3\n\n\u6240\u4ee5\u8fd9\u4e2a\u9898\u76ee\u7684 $n$ \u5927\u6982\u53ef\u4ee5\u51fa\u7684\u66f4\u5927\u4e00\u4e9b\u5427\n\n```cpp\n# include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nconst int mod(1e9 + 7);\n\ninline int Inc(int x, int y) {\n\treturn x + y >= mod ? x + y - mod : x + y;\n}\n\ninline int Dec(int x, int y) {\n\treturn x - y < 0 ? x - y + mod : x - y;\n}\n\ninline int Pow(ll x, int y) {\n\tregister ll ret = 1;\n\tfor (x = (x % mod + mod) % mod; y; y >>= 1, x = x * x % mod)\n\t\tif (y & 1) ret = ret * x % mod;\n\treturn ret;\n}\n\nstruct Pair {\n\tint a, b;\n\n\tinline Pair() {\n\t\ta = b = 0;\n\t}\n\n\tinline Pair(int _a, int _b) {\n\t\ta = _a, b = _b;\n\t}\n\n\tinline Pair operator +(Pair x) const {\n\t\treturn Pair(Inc(a, x.a), Inc(b, x.a));\n\t}\n\n\tinline Pair operator -(Pair x) const {\n\t\treturn Pair(Dec(a, x.a), Dec(b, x.b));\n\t}\n\n\tinline Pair operator *(Pair x) const {\n\t\treturn Pair(((ll)a * x.a + (ll)2 * b * x.b) % mod, ((ll)a * x.b + (ll)x.a * b) % mod);\n\t}\n\n\tinline Pair operator /(Pair x) const {\n\t\tregister Pair t1(a, b), t2(x.a, mod - x.b), t3(Pow((ll)x.a * x.a - (ll)2 * x.b * x.b, mod - 2), 0);\n\t\treturn t1 * t2 * t3;\n\t}\n} v1, v2, v3;\n\nint n, x;\n\nint main() {\n    scanf(\"%d\", &n), v1 = Pair(1, 1), v2 = Pair(1, mod - 1);\n\tfor (v3 = Pair(1, 0), x = n; x; x >>= 1, v1 = v1 * v1) if (x & 1) v3 = v3 * v1;\n\tfor (v1 = Pair(1, 0), x = n; x; x >>= 1, v2 = v2 * v2) if (x & 1) v1 = v1 * v2;\n\tv1 = (v3 - v1) / Pair(0, 2), printf(\"%d\\n\", v1.a);\n    return 0;\n}\n```",
        "postTime": 1545213170,
        "uid": 47640,
        "name": "Cyhlnj",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4451 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206\u3011"
    },
    {
        "content": "**P4451**\u9898\u89e3\u3002\n\n\u8003\u8651\u751f\u6210\u51fd\u6570\u3002\u6211\u4eec\u77e5\u9053\u6574\u6570\u6709\u5e8f\u62c6\u5206\u53ef\u4ee5\u8003\u8651\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u6570\u662f\u4ec0\u4e48\uff0c\u5373 $(1 + x ^ 1 + x ^ 2 + ...... + x ^ n)$\uff0c\u6700\u591a $n$ \u4e2a\u4f4d\u7f6e\u4e5f\u5c31\u662f $(1 + x^1 +  x ^ 2 + x ^ 3  + ...... + x ^ n) ^ n$\u3002\n\n\u7531\u4e8e\u6709\u6590\u6ce2\u90a3\u5951\u7684\u4e58\u79ef\u5f71\u54cd\uff0c\u6240\u4ee5\u5199\u8fdb\u7cfb\u6570\u91cc\u9762\uff0c\u62c6\u5206\u6210 $n$ \u4e2a\u6570\u5373 $(F_0 + F_1x^1 + F_2x^2 +......+F_nx^n)^n$\uff0c\u7b54\u6848\u5c31\u5e94\u8be5\u662f\u62c6\u5206\u6210 $1 \\sim n$ \u4e2a\u6570\u7684\u6240\u6709\u65b9\u6848\u4e4b\u548c\u3002\n\n\u6839\u636e~~\u5e38\u8bc6~~\u6211\u4eec\u77e5\u9053\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u751f\u6210\u51fd\u6570\u5199\u6210 $G(x) = \\frac{x}{1 - x - x ^ 2}$\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u901a\u8fc7\u6784\u9020\u7b49\u5f0f\u8bc1\u660e\uff1a\n\n- $F_x = F_{x - 1} + F_{x - 2},x > 2$\n\n- $G(x) = xG(x) + x ^ 2G(x)-xa_0+a_1x+a_0$\n\n\u4ee3\u5165\u89e3\u5f97 $G(x) = \\frac{x}{1 - x - x ^ 2}$\u3002\n\n\u8003\u8651\u901a\u8fc7\u6784\u5efa\u9012\u63a8\u5f0f\u5f97\u5230\u7b54\u6848\uff0c\u6784\u9020\u7b54\u6848\u7684\u751f\u6210\u51fd\u6570\uff1a\n\n- $H(x) = \\sum_{i = 0} ^ {+\\infty} G(x)^i$\n\n- $H(x) = \\frac{1}{1 - G(x)} = \\frac{1 - x - x ^ 2}{1 - 2x - x ^ 2}$\n\n\u8003\u8651\u5c06\u5206\u6bcd\u62c6\u5f00\uff0c\u53d8\u6210 $(1 - x - x ^ 2) \\times \\frac{1}{1 - 2x - x ^ 2}$\uff0c\u7136\u540e\u5c55\u5f00\u540e\u9762\u7684\u5206\u6bcd\u9879\uff0c\u8bbe\u5c55\u5f00\u5f62\u5f0f\u4e3a $S$\u3002\n\n- $S = \\frac{1}{1 - 2x - x ^ 2}$\n\n- $S(1 - 2x - x ^ 2)=1$\n\n- $S = 1 + 2xS + Sx^2$\n\n\u8bbe $S$ \u5bf9\u5e94\u7684\u7cfb\u6570\u9879 $a$ \u5373\u4e3a\u6211\u4eec\u7684\u7b54\u6848\uff0c\u5e38\u6570\u9879 $1$ \u662f\u65e0\u5173\u7684\uff1a\n\n- $a_n = 2a_{n - 1} + a_{n - 2}$\uff1b\n\n\u8bbe $H(x)$ \u5bf9\u5e94\u7684\u7cfb\u6570\u9879\u4e3a $b$\uff0c\u7531\u4e8e\u8fd8\u8981\u4e58\u4e0a $(1 - x - x ^ 2)$\uff0c\u6240\u4ee5\u53ef\u5f97\uff1a\n\n- $b_n = a_n - a_{n - 1} - a_{n - 2} = a_{n - 1}$\n\n\u8003\u8651\u8ba1\u7b97 $a_n$ \u7684\u901a\u9879\u5f0f\uff0c \u663e\u7136 $S$ \u5206\u6bcd\u7684\u6700\u9ad8\u6b21\u9879\u4e3a $2$ \u6b21\uff0c\u6240\u4ee5\u8bbe\u4e24\u4e2a\u5206\u5f0f\u63d0\u51fa\u6765\uff1a\n\n- $\\frac{1}{1 - 2x - x ^ 2} = \\frac{1}{(1 - ax)(1 - bx)}$\n\n\u663e\u7136\u8fd9\u53ef\u4ee5\u901a\u8fc7\u521d\u4e2d\u751f\u5c31\u4f1a\u7684\u5f85\u5b9a\u7cfb\u6570\u6cd5\u89e3\u51b3\uff1a\n\n- $a = -\\sqrt2+1,b=\\sqrt2+1$\n\n\u89c2\u5bdf\u5230\u5982\u679c\u6211\u4eec\u80fd\u5c06\u5206\u6bcd\u7684\u4e58\u79ef\u62c6\u5f00\uff0c\u5219\u4e00\u5b9a\u53ef\u4ee5\u5199\u6210\u4e24\u4e2a\u751f\u6210\u51fd\u6570\u7684\u548c\u7684\u5f62\u5f0f\uff0c\u8fd9\u6837\u6211\u4eec\u53ea\u9700\u8981\u5c06\u5b83\u4eec\u5bf9\u5e94\u7684\u7cfb\u6570\u9879\u76f8\u52a0\u5373\u53ef\uff01\n\n$S = \\frac{c}{1 - (-\\sqrt 2 + 1)x} + \\frac{d}{1 - (\\sqrt 2 + 1)x}$\n\n\u5219 $c \\times (1 - (\\sqrt 2 + 1)x) + d(1 - (-\\sqrt 2 + 1)x) = 1$\uff1b\n\n\u89e3\u5f97 $c = \\frac{1}{2} - \\frac{\\sqrt 2}{4},d = \\frac{1}{2}+\\frac{\\sqrt 2}{4}$\uff1b\n\n\u5c06\u4e24\u4e2a\u751f\u6210\u51fd\u6570\u5c55\u5f00\uff0c\u5176\u4e2d $(-\\sqrt 2 + 1)$ \u4e0e $(\\sqrt 2 + 1)$ \u4e3a\u5b83\u4eec\u7684\u516c\u5e73\uff0c\u5206\u522b\u4e58\u4e0a\u5bf9\u5e94\u7684 $c,d$ \u53ef\u4ee5\u5f97\u5230\u6700\u540e\u7684\u901a\u9879\u516c\u5f0f\uff1a\n\n- $\\frac{(1 + \\sqrt 2) ^ n - (1 - \\sqrt 2) ^ n}{2 \\sqrt 2}$\n\n\u7531\u4e8e $\\sqrt 2 \\equiv 59713600 \\pmod {1000000007}$\uff0c\u5269\u4e0b\u7684\u76f4\u63a5\u5957\u516c\u5f0f\u7b97\u5373\u53ef\u3002\n\n```cpp\n#include \"bits/stdc++.h\"\nusing namespace std;\n#define ll long long\nconst int Len = 2e5 + 5;\nconst ll sqrt2 = 59713600 , mod = 1e9 + 7;\nint n,m;\nll qpow(ll a,ll b)\n{\n\ta = (a + mod) % mod;\n\tll res = 1;\n\twhile(b)\n\t{\n\t\tif(b & 1) res = res * a % mod;\n\t\ta = a * a % mod;\n\t\tb = b >> 1;\n\t}\n\treturn res;\n}\ninline ll read() \n{\n    char ch = getchar();\n    ll x = 0 , f = 1;\n    while (ch < '0' || ch > '9') \n\t{\n        if (ch == '-') f = -1;\n        ch = getchar();\n    }\n    while ('0' <= ch && ch <= '9') \n\t{\n        x = 1ll * x * 10 % (mod - 1) + (ch - '0');\n        x %= (mod - 1);\n        ch = getchar();\n    }\n    return x * f;\n}\nint main()\n{\n\tn = read();ll A1 = qpow(1ll + sqrt2 , n) , A2 = qpow(1ll - sqrt2 , n);\n\tprintf(\"%lld\\n\",(A1 - A2 + mod) % mod * qpow(2 * sqrt2 % mod , mod - 2) % mod);\n\treturn 0;\n}\n```",
        "postTime": 1657548238,
        "uid": 132533,
        "name": "Hakuoro",
        "ccfLevel": 0,
        "title": "\u5728\u7761\u610f\u6c24\u6c32\u7684\u6e05\u6668\uff0c\u8fce\u6765\u904d\u6ee1\u975b\u84dd\u7684\u6e05\u6668"
    },
    {
        "content": "## $\\text{foreword}$\n\u7b2c\u4e00\u9053\u5b8c\u5168\u81ea\u5df1\u505a\u51fa\u6765\u7684\u751f\u6210\u51fd\u6570\uff0c\u7279\u6765\u53d1\u4e00\u7bc7\u9898\u89e3\u3002\n## $\\text{Solution}$\n\u8bbe\u7b54\u6848\u6570\u5217\u4e3a $g$\uff0c\u6590\u6ce2\u62c9\u5951\u6570\u5217\u4e3a $f$\uff0c\u53ef\u4ee5\u5f97\u5230\u9012\u63a8\u5f0f\uff1a\n$$g_n=\\sum_{i=0}^{n-1}g_if_{n-i}$$\n\u7531\u4e8e $f_0=0$ \uff0c\u4e0d\u59a8\u6539\u4e3a\uff1a\n$$g_n=\\sum_{i=0}^{n}g_if_{n-i}$$\n\u8bbe $f,g$ \u7684\u751f\u6210\u51fd\u6570\u4e3a $F,G$\uff0c\u5c31\u6709\uff1a\n$$G=F*G+1$$\n\u89e3\u5f97\uff1a\n$$G=\\frac{1}{1-F}$$\n~~\u603b\u6240\u5468\u77e5~~\u6590\u6ce2\u62c9\u5951 $F$ \u7684\u5c01\u95ed\u5f62\u5f0f\u4e3a\uff1a\n$$F=\\frac{x}{1-x-x^2}$$\n\u7136\u540e\u5e26\u5165\u5316\u7b80\u5206\u79bb\u5e38\u6570\u53ef\u5f97\uff1a\n$$G=1+\\frac{x}{1-2x-x^2}$$\n\u540e\u9762\u7684\u8fc7\u7a0b\u5c31\u548c\u6590\u6ce2\u62c9\u5951\u8bc1\u660e\u4e00\u6a21\u4e00\u6837\u4e86\u3002  \n\n\u5f85\u5b9a\u7cfb\u6570\uff0c\u8bbe\uff1a\n$$\\frac{x}{1-2x-x^2}=\\frac{A}{1-ax}+\\frac{B}{1-bx}$$\n\u89e3\u5f97\uff1a\n$$\\frac{x}{1-2x-x^2}=\\frac{\\dfrac{\\sqrt2}{4}}{1-(1+\\sqrt2)x}-\\frac{\\dfrac{\\sqrt2}{4}}{1-(1-\\sqrt2)x}$$\n\u6240\u4ee5\u901a\u9879\u516c\u5f0f\u5c31\u662f\uff1a\n$$g_n=\\frac{\\sqrt2}{4}[(1+\\sqrt2)^n-(1-\\sqrt2)^n]$$\n\u53ef\u4ee5\u627e\u5230 $\\sqrt2$ \u7684\u6a21 $10^9+7$ \u7684\u7ed3\u679c\uff0c\u4e5f\u53ef\u4ee5\u76f4\u63a5\u7528\u590d\u6570\u7c7b\u7684\u5f62\u5f0f\u8ba1\u7b97\u3002\n## $\\text{Code}$\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define ull unsigned long long\n#define debug(...) fprintf(stderr,__VA_ARGS__)\ninline ll read(int mod=0) {\n\tll x(0),f(1);char c=getchar();\n\twhile(!isdigit(c)) {if(c=='-')f=-1;c=getchar();}\n\twhile(isdigit(c)) {x=(x<<1)+(x<<3)+c-'0';if(mod) x%=mod;c=getchar();}\n\treturn x*f;\n}\nconst int mod=1e9+7;\nconst int N=4e5+100;\nint n,m,k;\ninline ll ksm(ll x,ll k){\n\tll res=1;\n\twhile(k){\n\t\tif(k&1) res=res*x%mod;\n\t\tx=x*x%mod;k>>=1;\n\t}\n\treturn res;\n}\n\nstruct node{\n\tll x,y;//a+b*sqrt(2)\n\tnode(ll a,ll b):x(a),y(b){}\n};\nnode t(int a,int b){\n\treturn (node){a,b};\n}\nnode operator + (node a,node b){\n\treturn (node){(a.x+b.x)%mod,(a.y+b.y)%mod};\n}\nnode operator - (node a,node b){\n\treturn (node){(a.x+mod-b.x)%mod,(a.y+mod-b.y)%mod};\n}\nnode operator * (node a,node b){\n\treturn (node){(a.x*b.x+2*a.y*b.y)%mod,(a.x*b.y+a.y*b.x)%mod};\n}\nnode ksm(node x,int k){\n\tnode res=t(1,0);\n\twhile(k){\n\t\tif(k&1) res=res*x;\n\t\tx=x*x;\n\t\tk>>=1;\n\t}\n\treturn res;\n}\nsigned main() {\n#ifndef ONLINE_JUDGE\n\t//freopen(\"a.in\",\"r\",stdin);\n\t//freopen(\"a.out\",\"w\",stdout);\n#endif\n\tn=read(mod-1);\n\tnode res=t(0,ksm(4,mod-2))*(ksm(t(1,1),n)-ksm(t(1,-1),n));\n\tprintf(\"%lld\",res.x);\n\treturn 0;\n}\n/*\n3 1\n2 3 3 1\n1 1\n*/\n\n```\n",
        "postTime": 1641741457,
        "uid": 449265,
        "name": "wind_whisper",
        "ccfLevel": 10,
        "title": "P4451 \u6574\u6570\u7684lqp\u62c6\u5206"
    },
    {
        "content": "### \u9898\u76ee\u63cf\u8ff0\n\u7ed9\u5b9a $n$ \uff0c\u8981\u6c42\uff0c\n\n$$m>0\\ ,a_i>0\\ ,\\sum_{i=1}^{m}a_i=n$$\n\n\u6c42\uff0c\n\n$$\\sum_{all}{\\prod_{i=1}^{m}fib_{a_i}}$$\n\n$1\\leq n\\leq 10^{10^4}$\n\n### solution\n\u4e8e\u662f\u6211\u4eec\u8bbe\u7b54\u6848\u4e3a $g(x)$ \uff0c\u5b83\u7684\u751f\u6210\u51fd\u6570\u4e3a $G(x)$ \u3002\n\n\u5982\u679c\u6682\u5b9a $g_0=1$ \uff0c\u5176\u5b9e\u5c31\u80fd\u975e\u5e38\u987a\u624b\u5730\u5199\u51fa\u4e00\u4e2a\u9012\u63a8\u5f0f\n\n$$g(x)=\\sum_{i=1}^{x}fib_i\\cdot g_{n-i}+[n=0]$$\n\n\u7136\u540e $G(x)$ \u4e5f\u5c31\u5199\u51fa\u6765\u4e86\uff0c\n\n$$G(x)=\\sum_{n=1}^{\\infty}{(\\sum_{i=1}^{n}fib_i\\cdot g_{n-i})x^n}+1$$\n\n\u5176\u5b9e\u518d\u5199\u9012\u63a8\u5f0f\u7684\u65f6\u5019\uff0c\u5c31\u662f\u5728\u505a\u7c7b\u4f3c\u5377\u79ef\u7684\u201c\u586b\u201d\u52a8\u4f5c\uff0c\u6240\u4ee5\u751f\u6210\u51fd\u6570\u5c31\u5f88\u6109\u5feb\u7684\u5316\u6210\u4e86\n\n$$G(x)=Fib(x)\\cdot G(x)+1$$\n\n\u5316\u7b80\u4e00\u4e0b\uff0c\n\n$$G(x)=\\frac{1}{1-Fib(x)}$$\n\n\u5e94\u8be5\u90fd\u77e5\u9053\u516c\u5f0f\uff0c\n\n$$Fib(x)=\\frac{x}{1-x-x^2}$$\n\n\u5e26\u5165\uff0c\u5e76\u5316\u7b80\u4e00\u4e0b\uff0c\n\n$$G(x)=\\frac{1}{1-\\Large \\frac{x}{1-x-x^2}}$$\n\n$$\\Rightarrow\\frac{1-x-x^2}{1-2\\cdot x-x^2}$$\n\n$$\\Rightarrow1-\\frac{x}{x^2+2\\cdot x-1}$$\n\n\u540e\u9762\u8fd9\u4e00\u5768\u5e76\u975e\u6211\u4eec\u60f3\u8981\u7684\uff0c\u5173\u6ce8\u5230\u6709\u4e8c\u6b21\u65b9\u7a0b\uff0c\u5c3d\u91cf\u5316\u6210\u4e58\u79ef\u6a21\u5f0f\uff0c\u90a3\u5c31\u8bbe\u65b9\u7a0b\u4e24\u6839 $x_1=-1-\\sqrt{2}$ \uff0c $x_2=-1+\\sqrt{2}$ \u5e76\u8bbe $\\varphi(x)=-\\Large\\frac{x}{x^2+2\\cdot x-1}$ \u3002\n\n$$\\varphi(x)=-\\frac{x}{(x-x_1)(x-x_2)}$$\n\n$$\\Rightarrow\\frac{1}{x_2-x_1}\\cdot (\\frac{x}{x_2-x}-\\frac{x}{x_1-x})$$\n\n\u4f3c\u4e4e\u8fd9\u4e00\u5207\u53c8\u5361\u4f4f\u4e86\uff0c\u4f46\u662f\u5982\u679c\u5c3d\u53ef\u80fd\u7684\u63d0\u7cfb\u6570\u7684\u8bdd\n\n$$\\Rightarrow\\frac{1}{x_2-x_1}\\cdot (\\frac{x}{x_2}\\cdot \\frac{1}{1-\\Large\\frac{x}{x_2}}-\\frac{x}{x_1}\\cdot \\frac{1}{1-\\Large\\frac{x}{x_1}})$$\n\n\u4f1a\u53d1\u73b0\u8fd9\u597d\u50cf\u5524\u8d77\u4e86\u4f60~~\u67d0\u6df1\u5904\u6c89\u7761~~\u7684\u8bb0\u5fc6\uff0c\u521a\u5f00\u59cb\u5b66\u751f\u6210\u51fd\u6570\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5c31\u5b66\u4e86,\n\n$$\\sum_{i=0}^{\\infty}(c\\cdot x)^{k\\cdot i}=\\frac{1}{1-c\\cdot x^k}$$\n\n\u6765\u4e00\u624b\u9006\u7528\uff0c\n\n$$\\Rightarrow\\frac{1}{x_2-x_1}\\cdot \\Big(\\frac{x}{x_2}\\cdot \\sum_{i=0}^{\\infty}(\\frac{x}{x_2})^i-\\frac{x}{x_1}\\cdot \\sum_{i=0}^{\\infty}(\\frac{x}{x_1})^i\\Big)$$\n\n$$\\Rightarrow\\frac{1}{x_2-x_1}\\cdot \\Big(\\sum_{i=1}^{\\infty}(\\frac{x}{x_2})^i-\\sum_{i=1}^{\\infty}(\\frac{x}{x_1})^i\\Big)$$\n\n$$\\Rightarrow\\frac{1}{x_2-x_1}\\cdot \\Big(\\sum_{i=1}^{\\infty}\\big((\\frac{1}{x_2})^i-(\\frac{1}{x_1})^i\\big)\\Big)\\sum_{i=1}^{\\infty}x^i$$\n\n~~\u662f\u4e0d\u662f\u5df2\u7ecf\u5feb\u5fd8\u4e86\u6211\u4eec\u4ece\u54ea\u91cc\u5f00\u59cb\u7684\u5417\uff08\u6211\u81ea\u5df1\u90fd\u5feb\u4e86~~\n\n\u6084\u6084\u5f80\u4e0a\u4e00\u770b\uff0c\u5662\u3002\u3002\u6240\u4ee5\uff0c\n\n$$G(x)=1+\\varphi(x)$$\n\n$$\\Rightarrow\\frac{1}{x_2-x_1}\\cdot \\Big(\\sum_{i=1}^{\\infty}\\big((\\frac{1}{x_2})^i-(\\frac{1}{x_1})^i\\big)\\Big)\\sum_{i=1}^{\\infty}x^i+1$$\n\n\u4e8e\u662f $i=n$ \u7684\u7cfb\u6570\u5c31\u662f\uff0c\n\n$$\\frac{1}{x_2-x_1}\\cdot \\Big((\\frac{1}{x_2})^n-(\\frac{1}{x_1})^n\\Big)$$\n\n\u5e26\u5165 $x_1=-1-\\sqrt{2}$ \uff0c $x_2=-1+\\sqrt{2}$ \uff0c\n\n$$\\frac{1}{2\\cdot \\sqrt{2}}\\cdot \\Big((1+\\sqrt{2})^n-(1-\\sqrt{2})^n\\Big)$$\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int sqrt2=59713600,mod=1e9+7;\nint n,lqp1,lqp2,ans1,ans2;\ninline int inc(int x,int y){return x+y>=mod?x+y-mod:x+y;}\ninline int mul(int x,int y){return 1ll*x*y%mod;}\ninline ll read()\n{\n\tll s=0,w=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9')s=((s<<3)+(s<<1)+ch-'0')%(mod-1),ch=getchar();\n\treturn s*w;\n}\ninline int ksm(int a,int b)\n{\n\tint tmp=1;\n\twhile(b)\n\t{\n\t\tif(b&1)tmp=mul(tmp,a);\n\t\ta=mul(a,a),b>>=1;\n\t}\n\treturn tmp;\n}\nint main()\n{\n\tn=read(),lqp1=1+sqrt2,lqp2=1-sqrt2+mod;\n\tans1=mul(lqp1,mul(ksm(inc(2+lqp1,lqp1),mod-2),ksm(lqp1,n)));\n\tans2=mul(lqp2,mul(ksm(inc(2+lqp2,lqp2),mod-2),ksm(lqp2,n)));\n\tprintf(\"%d\",inc(ans1,ans2));\n\t//\u8fd9\u662fFroggy\u7684\u516c\u5f0f\uff08\u4e3b\u8981\u597d\u770b\u3002\u3002\uff09\n\treturn 0;\n}\n```\n\u53ea\u6c42\u80fd\u5e2e\u52a9\u5230\u51e0\u4e2a\u4eba\u7f62\u3002\u3002",
        "postTime": 1621251134,
        "uid": 206024,
        "name": "Illusory_dimes",
        "ccfLevel": 7,
        "title": "[\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206 \u9898\u89e3"
    },
    {
        "content": "\n\u9996\u5148\u5b9a\u4e49$ \\{F_i\\} $\u7684\u751f\u6210\u51fd\u6570\n$$ \nG(x)=F_0+F_1 x+......=\\sum_{i=0}^\\infty F_ix^i\n$$\n\u5219\u6709\n\n$$\n\\begin{aligned}\nG(x)\\times x=\\sum_{i=0}^\\infty F_ix^{i+1}\\\\\nG(x)\\times x^2=\\sum_{i=0}^\\infty F_ix^{i+2}\n\\end{aligned}\n$$\n\n\u7531\u4e8e$ F_{n}=F_{n-1}+F_{n-2}(n\\ge2),F_0=0,F_1=1 $\n\n\u5219\u6709\n\n$$\n\\begin{aligned}\n&G(x)\\times (1-x-x^2)\\\\\n=&\\sum_{i=0}^\\infty F_ix^i -\\sum_{i=0}^\\infty F_ix^{i+1}-\\sum_{i=0}^\\infty F_ix^{i+2}\\\\\n=&x+\\sum_{i=0}^\\infty (F_{i+2}-F_{i+1}-F_n)x^i\\\\\n=&x\n\\end{aligned}\n$$\n\n\u6240\u4ee5\u6211\u4eec\u6709\u4e86$ G(x)=\\dfrac{x}{1-x-x^2} $\n\n\u6b64\u65f6\u8bbe$ b_i $\u4e3a$n=i$\u65f6\u7684\u7b54\u6848\uff0c\u6784\u9020$ B(x)=\\sum_{i=0}^\\infty b_ix^i $\n\n\u6211\u4eec\u77e5\u9053\uff0c\u53d6$ m $\u4e2a\u6570\u80fd\u4f7f\u5f97$ \\sum_{i=1}^m F_{a_i}=n $\u7684\u6743\u503c\u4e4b\u548c\u4e3a$ G(x)^m $\n\n\u4e8e\u662f\u6709\u4e86$ B(x)=\\sum_{i=0}^\\infty G(x)^i=\\dfrac{1}{1-G(x)}=\\dfrac{1-x-x^2}{1-2x-x^2} $\n\n\u8fd9\u91cc\u8fd0\u7528~~\u521d\u4e2d\u7684\u90e8\u5206\u5206\u5f0f~~\uff0c\u6211\u4eec\u6709\n$$\nB(x)=1+\\dfrac{1}{2\\sqrt2} (\\dfrac{1}{1-(1+\\sqrt2)x}-\\frac{1}{1-(1-\\sqrt2)x})=1+\\dfrac{1}{2\\sqrt2}\\sum_{i=0}^\\infty [(1+\\sqrt2)^i-(1-\\sqrt2)^i] x^i\n$$\n\u6240\u4ee5$ b_i=\\dfrac{(1+\\sqrt2)^i-(1-\\sqrt2)^i}{2\\sqrt2} $\n\n\uff08\u7279\u522b\u7684\uff0c$b_0=1$\uff09\n\n\u8fd9\u91cc$\\sqrt2\\equiv 59713600\\pmod {1000000007}$\uff0c\u4e00\u4e2a\u5feb\u901f\u5e42\u5c31\u5b8c\u4e8b\u4e86\u3002",
        "postTime": 1613737887,
        "uid": 289230,
        "name": "ricky0916",
        "ccfLevel": 7,
        "title": "P4451 \u9898\u89e3"
    },
    {
        "content": "\u6700\u8fd1\u81ea\u5b66\u4e86\u79bb\u6563\u6570\u5b66\uff0c\u6240\u4ee5\u627e\u51e0\u9053\u751f\u6210\u51fd\u6570\u7684\u9898\u505a\u4e00\u505a\u3002\n\n\u9996\u5148\uff0c\u6211\u5148\u6765\u79d1\u666e\u4e00\u4e0b\u751f\u6210\u51fd\u6570\u662f\u4ec0\u4e48\u5427\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u6570\u5217 $ \\{a_{n}\\} $,\u6709\u4e00\u4e2a\u51fd\u6570 $G$ ,\u4f7f\u5f97\n\n$ G(x)=\\sum_{i=1}^{+\\infty} a_{i}x^{i}$\n\n\u90a3\u4e48\u79f0 $G(x)$ \u662f $\\{a_{n}\\}$ \u7684\u751f\u6210\u51fd\u6570\u3002\n\n\u5982\u5bf9\u4e8e $a_{n} = 1 $ \u8fd9\u4e2a\u6570\u5217\uff0c\u4ed6\u7684\u751f\u6210\u51fd\u6570\u662f\n\n$ G(X) = \\sum_{i=1}^{+\\infty} x^{i} = \\frac{1}{1-x}$.\n\n\u5bf9\u4e8e\u6590\u6ce2\u90a3\u5951\u6570\u5217\uff0c\u6709\n\n$ F(X) $\n\n$=\\sum_{i=1}^{+\\infty} f_{i}x^{i} $\n\n$=\\sum_{i=1}^{+\\infty}(\\frac {(\\frac{1+\\sqrt{5}}{2})^i-(\\frac{1-\\sqrt{5}}{2})^i}{\\sqrt{5}})x^i $\n\n$=\\frac{1}{\\sqrt{5}}(\\sum_{i=1}^{+\\infty}(\\frac{1+\\sqrt{5}}{2})^{i}x^i-\\sum_{i=1}^{+\\infty}(\\frac{1-\\sqrt{5}}{2})^{i}x^i) $\n\n$ =\\frac{1}{\\sqrt{5}}(\\frac{1}{1-\\frac{1+\\sqrt{5}}{2}x}-\\frac{1}{1-\\frac{1-\\sqrt{5}}{2}x})$\n\n$=\\frac{1}{\\sqrt{5}}(\\frac{2}{2-x-\\sqrt{5}x}-\\frac{2}{2-x+\\sqrt{5}x})$\n\n$=\\frac{x}{1-x-x^2}$\n\n\u5bf9\u4e8e\u8fd9\u4e2a\u9898\uff0c\u6211\u4eec\u8bbe $ a_{i} $ \u8868\u793a $ i $ \u4e2a\u6570\u7684\u7ed3\u679c\u3002\n\n\u6211\u4eec\u8bbe$ a_0=1$\n\n\u90a3\u4e48\uff0c\u6211\u4eec\u5148\u6c42\u51fa\u8fd9\u4e2a\u9898\u6570\u5217\u7684\u9012\u63a8\u516c\u5f0f$ (n>0)$\uff1a\n\n$a_{n}=\\sum_{i=0}^{n-1}a_{i}f_{n-i}$\n\n\u5176\u751f\u6210\u51fd\u6570\u4e3a\n\n$G(x)$\n\n$=\\sum_{i=0}^{+\\infty}(\\sum_{j=0}^{i-1}a_{j}f_{n-j})x^i$\n\n$=1+\\sum_{i=1}^{+\\infty}(\\sum_{j=0}^{i}a_{j}f_{n-j})x^i$\n\n$=1+G(x)F(x)$\n\n\u6240\u4ee5$ G(x)(1-F(x))=1$\n\n\u90a3\u4e48 $G(x)=\\frac{1}{1-\\frac{x}{1-x-x^2}}=\\frac{1-x-x^2}{1-2x-x^2}$\n\n$ G(x)=1+\\frac{x}{1-2x-x^2} $\n\n\u6240\u4ee5$a_{n}=\\frac{(1+\\sqrt{2})^{n}-(1-\\sqrt2)^{n}}{2\\sqrt{2}}=\\sqrt{2}\\frac{(1+\\sqrt{2})^{n}-(1-\\sqrt2)^{n}}{4}$\n\n\u800c$ \\sqrt{2} $\u5728\u6a21$1e9+7$\u7684\u60c5\u51b5\u4e0b\u7684\u503c\u662f59713600\uff0c\u6240\u4ee5\u6211\u4eec\u7528\u5feb\u901f\u5e42 + \u8d39\u9a6c\u5c0f\u5b9a\u7406\u8ba1\u7b97\u5373\u53ef\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\nusing namespace std;\nlong long input(long long mod){\n\tstring a;\n\tcin>>a;\n\tlong long sum=0;\n\tfor(int i=0;i<a.size();i++){\n\t\tsum=sum*10+a[i]-'0';\n\t\tsum%=mod;\n\t}\n\treturn sum;\n}\nlong long qpmod(long long a,long long b,long long p){\n\tlong long ans=1;\n\twhile(b){\n\t\tif(b&1ll) ans=ans*a%p;\n\t\ta=a*a%p;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\nint main(){\n\tlong long sqrt2=59713600;\n\tlong long plussqrt2=1+sqrt2;\n\tlong long minussqrt2=(long long)(1e9+8-sqrt2)%1000000007;\n\tlong long inv2sqrt2=1000000008/4*sqrt2%1000000007;\n\t//(plus^n-minus^n)*inv2%(1e9+7)\n\tlong long n=input(1000000006);\n\tcout<<(qpmod(plussqrt2,n,1000000007)-qpmod(minussqrt2,n,1000000007)+1000000007)%1000000007*inv2sqrt2%1000000007;\n}\n```\n",
        "postTime": 1608683613,
        "uid": 287355,
        "name": "1lgorithm",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4451 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206\u3011"
    },
    {
        "content": "\u8bbe\u6574\u6570 $n$ \u7684 $\\text{lqp}$ \u62c6\u5206\u6743\u503c\u4e3a $g(n)$ , \u90a3\u4e48\u6709\uff1a\n\n$$\\begin{cases}\ng(n)=1 & (n=0) \\\\\n\\displaystyle g(n)=\\sum_{i=0}^{n-1} fib(i) \\times g(n-i) & (n \\not=0)\n\\end{cases}$$\n\n\u4ee4 $F(x)$ \u4e3a\u6590\u6ce2\u62c9\u5951\u6570\u5217\u7684 $\\text{OGF}$ , $G(x)$ \u4e3a $g$ \u7684 $\\text{OGF}$\u3002\n\n\u5377\u79ef\u5c31\u662f\u751f\u6210\u51fd\u6570\u7684\u4e58\u6cd5\uff0c\u5f97\u5230\uff1a\n\n$$G=F*G+1$$\n\n( \u591a\u51fa\u6765\u7684 $1$ \u662f\u8ba9 $g(0)=1$ \u7684\u539f\u56e0 )\n\n\u53c8\u6709\u6590\u6ce2\u62c9\u5951\u6570\u5217\u7684\u751f\u6210\u51fd\u6570\uff1a\n\n$$F(x)=\\frac{1}{1-x-x^2}$$\n\n\u90a3\u4e48\uff1a\n\n$$G(x)=\\frac{1-x-x^2}{1-2x-x^2}$$\n\n$$G(x)=1+\\frac{x}{1-2x-x^2}$$\n\n\u60f3\u529e\u6cd5\u5c06\u540e\u9762\u7684\u5206\u6570\u62c6\u5f00\uff0c\u4e0d\u59a8\u4ee4 $\\frac{x}{1-2x-x^2}=A(\\frac{1}{ax-1}-\\frac{1}{bx-1})$\n\n\u7136\u540e\u5bf9\u6bd4\u7cfb\u6570\u89e3\u51fa\uff1a\n\n$$\\begin{cases}\nA=\\frac{\\sqrt 2}{4} \\\\\na=1+\\sqrt{2} \\\\\nb=1-\\sqrt{2} \\\\\n\\end{cases}$$\n\n$$G(x)=1+\\frac{\\sqrt 2}{4}(\\frac{1}{1-(1+\\sqrt{2})x} - \\frac{1}{1-(1-\\sqrt{2})x})$$\n\n\u90a3\u4e48\u5f97\u5230\uff1a\n\n$$g(n)=\\frac{\\sqrt 2}{4} ((1+\\sqrt {2})^n - (1-\\sqrt {2})^n)$$\n\n\u7ecf\u8fc7\u679a\u4e3e\u4f60\u53d1\u73b0 $\\sqrt{2}\\equiv 59713600 ( \\bmod 1e9+7 )$\n\n\u90a3\u4e48\u7528\u8d39\u9a6c\u5c0f\u5b9a\u7406\u5904\u7406\u6307\u6570\u5c31\u53ef\u4ee5\u4e86\u3002\n\n```cpp\n#include <cstdio>\n\nconst int Mod = 1e9 + 7 , Sqrt2 = 59713600;\n\nint Quick_pow( int x , int po ) {\n    x = ( x % Mod + Mod ) % Mod;\n    int Ans = 1;\n    for( ; po ; po >>= 1 , x = 1ll * x * x % Mod )\n        if( po & 1 ) Ans = 1ll * Ans * x % Mod;\n    return Ans;\n}\nint Inv( int x ) {\n    return Quick_pow( x , Mod - 2 );\n}\n\nvoid Read( int &x ) {\n    x = 0; char s = getchar();\n    for( ; '0' <= s && s <= '9' ; s = getchar() ) x = ( 10ll * x + s - '0' ) % ( Mod - 1 );\n}\n\nint n;\nint main( ) {\n    Read( n );\n    printf(\"%d\\n\", ( 1ll * Sqrt2 * Inv( 4 ) % Mod * ( Quick_pow( 1 + Sqrt2 , n ) - Quick_pow( 1 - Sqrt2 , n ) + Mod ) % Mod + Mod ) % Mod );\n    return 0;\n}\n```",
        "postTime": 1597286036,
        "uid": 123802,
        "name": "chihik",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4451 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206\u3011"
    },
    {
        "content": "[\u9898\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4451)\n\n\u4e3b\u8981\u662f\u60f3\u8bb2\u4e00\u4e2a\u4e2a\u4eba\u89c9\u5f97\u6bd4\u8f83\u5bb9\u6613\u60f3\u7684\u63a8\u51fa\u7ebf\u6027\u9012\u63a8\u5f0f\u7684\u65b9\u6cd5\u3002\n\n\u663e\u7136\u7684\u6709\u975e\u7ebf\u6027\u7684\u9012\u63a8\u5f0f\u5b50: $f_n = \\sum\\limits_{i=0}^{n-1}fib_{n-i}\\ f_i$\uff0c $f_0=1$\u3002\n\n\u76f8\u5f53\u4e8e\u679a\u4e3e\u7b2c\u4e00\u4f4d\u4e4b\u540e\u7684\u548c\u3002\n\n\u8fd9\u6837\u5b50\u5199\u6709\u4e00\u4e2a\u597d\u5904\u5c31\u662f $f_i$ \u662f\u5bf9\u9f50\uff0c$fib_{n-i}$ \u5728\u53d8\u5316\uff0c\u800c\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u6709\u7b80\u5355\u7684\u9012\u63a8\u5f0f\u53ef\u4ee5\u7528\u6765\u52a0\u51cf\u6d88\u53bb\u5f0f\u5b50\u3002\n\n\u8003\u8651\u6784\u9020\u8fde\u7eed\u4e09\u9879\uff1a\n$$\n\\begin{aligned}\nf_n &= \\sum\\limits_{i=0}^{n-1}fib_{n-i}\\ f_i\\\\\nf_{n-1} &= \\sum\\limits_{i=0}^{n-2}fib_{n-i-1}\\ f_i\\\\\nf_{n-2} &= \\sum\\limits_{i=0}^{n-3}fib_{n-i-2}\\ f_i\n\\end{aligned}\n$$\n\u8fd9\u6837\u5b50\u6211\u4eec\u5c31\u6709\u4e86\u76f8\u90bb\u4e09\u9879\u7684\u6590\u6ce2\u90a3\u5951\u6570\u5217\u4e86\uff0c\u62ff\u5f0f\u5b50\u52a0\u51cf\u4e00\u4e0b\uff0c\u6bd4\u8f83\u672b\u5c3e\u7684\u4e24\u9879\uff1a\n$$\n\\begin{aligned}\nf_n - f_{n-1} - f_{n-2} &= (fib_2-fib_1)f_{n-2}+fib_1f_{n-1}\\\\\nf_n&=2f_{n-1}+f_{n-2}\n\\end{aligned}\n$$\n\n\u8fd9\u6837\uff0c\u671d\u601d\u66ae\u60f3\u7684\u9012\u63a8\u65b9\u7a0b\u5c31\u6709\u4e86\u3002\n\n\u4e0d\u8fc7\u5355\u662f\u9012\u63a8\u8fd8\u5207\u4e0d\u52a8\u8fd9\u9053\u9898\uff0c\u5341\u8fdb\u5236\u77e9\u9635\u5feb\u901f\u5e42\u7565\u663e\u9ebb\u70e6\uff0c\u8fd9\u91cc\u63a8\u4e00\u4e0b\u901a\u9879\u3002\n\n\u5217\u51fa\u7279\u5f81\u65b9\u7a0b\uff1a$x^2=2x+1$\n\n\u89e3\u5f97\uff1a$x=1\\pm\\sqrt 2$\n\n\u901a\u9879\u7684\u5f62\u5f0f\u6709\u4e86\uff1a$f_n=A(1+\\sqrt 2)^n+B(1-\\sqrt 2)^n$\n\n\u7528\u5f85\u5b9a\u7cfb\u6570\u6cd5\u89e3\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2a\u5751\u7239\u7684\u5730\u65b9\uff0c\u7531\u4e8e\u539f\u59cb\u9012\u63a8\u5f0f\u8981\u6c42 $n\\geqslant 1$ \uff0c\u800c\u6211\u4eec\u63a8\u5f0f\u5b50\u7684\u8fc7\u7a0b\u7528\u5230\u4e86 $n-2$\uff0c \u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e2a\u6c42\u51fa\u6765\u7684\u9012\u63a8\u5f0f\u53ea\u6709\u5728 $n\\geqslant 3$ \u7684\u65f6\u5019\u624d\u6210\u7acb\uff0c\u901a\u9879\u4ece $1$ \u5f00\u59cb\u6210\u7acb\uff0c\u800c\u4e0d\u4fdd\u8bc1 $0$ \u5904\u7684\u6b63\u786e\u6027\uff0c\u56e0\u6b64\u4e0d\u80fd\u4f7f\u7528 $n=0$ \u7684\u65b9\u7a0b\u6765\u89e3\u7cfb\u6570\u3002  \n\u6211\u4e00\u5f00\u59cb\u4e60\u60ef\u6027\u5730\u7528\u4e86 $0$ \u5904\u7684\u5f0f\u5b50\uff0c\u6ca1\u591a\u60f3\uff0c\u7ed3\u679c\u56e0\u4e3a\u6c42\u51fa\u6765\u7684\u5f0f\u5b50\u660e\u660e\u524d\u4e24\u9879\u5bf9\u4e86\u540e\u9762\u5374\u9519\u4e86\uff0c\u8ff7\u60d1\u4e86\u534a\u5929\u3002\n\n\u6700\u7ec8\u5f0f\u5b50\u957f\u8fd9\u6837\uff1a$f_n=\\cfrac{(1+\\sqrt 2)^n-(1-\\sqrt 2)^n}{2\\sqrt 2}$\uff0c \u662f\u4e00\u4e2a\u5e26\u6839\u53f7\u7684\u5f0f\u5b50\uff0c\u8003\u8651\u5230 $2$ \u662f $1e9+7$ \u7684\u4e8c\u6b21\u5269\u4f59\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 $59713600$ \u6765\u4ee3\u66ff $\\sqrt 2$\uff0c\u8fd9\u9053\u9898\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u54e6\u5bf9\u4e86\uff0c\u7531\u4e8e\u8fd9\u9053\u9898\u6570\u636e\u8303\u56f4\u5f88\u5927\uff0c\u800c $n$ \u5728\u6307\u6570\u4e0a\uff0c\u6240\u4ee5\u53ef\u4ee5\u4f7f\u7528\u6b27\u62c9\u5b9a\u7406\u53ef\u4ee5\u7b80\u5316\u8ba1\u7b97\uff0c\u666e\u901a\u5feb\u901f\u5e42\u5c31\u53ef\u4ee5\u641e\u5b9a\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define next nxt\n#define int long long\nusing namespace std;\ntypedef long long ll;\nconst int N =1e6, mod=1e9+7, sqrt2=59713600, phi=mod-1;\nconst int alpha=sqrt2+1, beta=mod+1-sqrt2;\nint read(){\n\tint c=0,nx,sign=1;\n\twhile(!isdigit(nx = getchar()))\n\t\tif(nx=='-')\n\t\t\tsign=-1;\n\twhile(isdigit(nx))\n\t\tc=(c*10+nx-'0')%phi,nx=getchar();//\u5728\u8fd9\u91cc\u5bf9\u8bfb\u5165\u53d6\u6a21\u4e86\n\treturn sign*c;\n}\ninline int fast(int a, int b, int ans=1){\n\tfor(;b;b>>=1,a=a*a%mod)\n\t\tif(b&1)\n\t\t\tans=ans*a%mod;\n\treturn ans; \n}\nint inv[N];\nint a = fast(2 * sqrt2 % mod, mod - 2), b = mod - a;\n\nsigned main(){\n\tint n = read() + phi;\n\tprintf(\"%lld\\n\", (fast(alpha, n, a) + fast(beta, n, b)) % mod);\n}\n```\n\n",
        "postTime": 1595810143,
        "uid": 144732,
        "name": "Alear",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P4451 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206\u3011"
    },
    {
        "content": "\u9996\u5148\uff0c\u628a\u8fd9\u4e2a$F$\u7684\u751f\u6210\u51fd\u6570\u5217\u51fa\u6765\uff0c\u539f\u672c$F$\u7684\u751f\u6210\u51fd\u6570\u662f$\\frac{1}{1-x-x^2}$\uff0c\u8fd9\u9053\u9898\u7684$F$\u662f\u5411\u53f3\u79fb\u4e86\u4e00\u4f4d\u7684\uff0c\u6240\u4ee5\u662f$F(x)=\\frac{x}{1-x-x^2}$\u3002\n\n\u6613\u77e5\u5f53\u62c6\u5206\u6210$k$\u4e2a\u6570\u65f6\uff0c\u751f\u6210\u51fd\u6570\u4e3a$F^k(x)$\u3002\u5e94\u8be5\u4e0d\u96be\u7406\u89e3\uff0c\u8fd9\u6837\u5b9e\u9645\u4e0a\u662f\u5728\u8ba8\u8bba\u6bcf\u4e00\u4e2a\u6570\u9009\u4e86\u4ec0\u4e48\uff0c\u7136\u540e\u628a\u65b9\u6848\u6570\u6700\u7ec8\u7b97\u5728\u5bf9\u5e94\u9879\u7cfb\u6570\u4e0a\u3002\n\n\u6240\u4ee5\u7b54\u6848\u7684\u751f\u6210\u51fd\u6570\u5c31\u662f$G(x)=\\sum_{i=0}^{\\infty}{F^i(x)}$\n\n\u5316\u7b80\u4e00\u4e0b\u5c31\u662f$G(x)=\\frac{1}{1-F(x)}=1+\\frac{x}{1-2x-x^2}$\n\n\u8003\u8651\u53d8\u5316\u4e00\u4e0b$G(x)$\uff1a\n\n$\\begin{aligned}\nG(x) &= \\frac{1}{1-F(x)}\\\\\n&= 1+\\frac{x}{1-2x-x^2}\\\\\n&= 1+\\frac{1}{2\\sqrt2}*(\\frac{1}{1-(1+\\sqrt2)x}-\\frac{1}{1-(1-\\sqrt2)x})\\\\\n&=1+\\sum_{i>0}{\\frac{(1+\\sqrt2)^i-(1-\\sqrt2)^i}{2\\sqrt2}*x^i}\n\\end{aligned}$\n\n\u6240\u4ee5\u7b54\u6848\u5c31\u662f$ans_n=\\frac{(1+\\sqrt2)^n-(1-\\sqrt2)^n}{2\\sqrt2}$\n\n\u6ce8\u610f\u5230$2$\u5728$1e9+7$\u610f\u4e49\u4e0b\u6709\u4e8c\u6b21\u5269\u4f59\u4e3a$59713600$\u6240\u4ee5\u76f4\u63a5\u5feb\u901f\u5e42\u5c31\u597d\u4e86\u3002",
        "postTime": 1594094818,
        "uid": 103109,
        "name": "\u4f20\u5947666666",
        "ccfLevel": 9,
        "title": "P4451\u9898\u89e3"
    },
    {
        "content": "# \u9898\u89e3\n\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u6574\u7406\u51fa\u4e00\u4e2a\u5f0f\u5b50\uff1a$dp[i]=\\sum_{j=1}^{i-1}dp[j]F[i-j]$\n\n\u5176\u4e2d\uff1aF[i]\u8868\u793a\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u7b2c$i$\u9879,\u5176\u4e2d\uff0c$F[0]=0,F[1]=1$\u3002\n\n\u7136\u540e\u5f97\u5230\n$$dp[n+1]-dp[i]=\\sum_{j=1}^ndp[j]F[i-j+1]-\\sum_{j=1}^{n-1}dp[j]F[i-j]$$\n\u7136\u540e\u5408\u5e76\u4e00\u4e0b\uff0c\u5f97\uff1a\n$$dp[n+1]-dp[n]=\\sum_{i=1}^{n-1}dp[j](F[i-j+1]-F[i-j])+dp[n]$$\n\u4e4b\u540e\u5229\u7528\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u6027\u8d28\uff0c\u5f97\uff1a\n$$dp[n+1]-dp[n]=\\sum_{i=1}^{n-1}dp[j]F[i-j-1]+dp[n]$$\n\u56e0\u4e3a$F[0]=0$\uff0c\u5f97\uff1a\n$$dp[n+1]-dp[n]=\\sum_{i=1}^{n-2}dp[j]F[i-j-1]+dp[n]$$\n$$dp[n+1]-dp[n]=dp[n-1]+dp[n]$$\n$$dp[n+1]=2\\times dp[n]+dp[n-1]$$\n\u597d\u4e86\uff0c\u5f0f\u5b50\u63a8\u51fa\u6765\u4e86\uff0c\u63a5\u4e0b\u6765\u600e\u4e48\u529e\uff1f\u66b4\u529b\uff0c\u76f4\u63a5\u9012\u63a8\uff1f\u671f\u671b\u5f97\u5206\uff1a$0pts$\u3002\n\n\u770b\u4e00\u770b\uff0c\u5bf9\u4e8e60%\u7684\u6570\u636e$n \\leq 10^9$\uff0c\u600e\u4e48\u529e\u5462\uff1f\n\n\u5e94\u8be5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u6765\u89e3\u51b3\u3002\n\n\u5efa\u8bae\u5927\u5bb6\u5148\u770b\u4e00\u770b\u8fd9\u7bc7\u9898\u89e3\uff1a[\u77e9\u9635\u52a0\u901f](https://www.luogu.com.cn/blog/LHF/solution-p1939)\uff0c\u5c24\u5176\u662f\u6ca1\u6709\u5b66\u8fc7\u8fd9\u4e00\u65b9\u9762\u95ee\u9898\u7684\u4eba\u3002\n\n\u63a5\u7740\u76f4\u63a5\u6309\u7167\u77e9\u9635\u52a0\u901f\u7684\u8001\u5957\u8def\uff0c\u5f97\u5230\uff1a\n$$\\begin{bmatrix}2&1\\\\1&0\\end{bmatrix}$$\n\u7136\u540e\u5957\u77e9\u9635\u5feb\u901f\u5e42\u5373\u53ef\u3002\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u5f97\u5230\u4e8660\u5206\u7684\u4ee3\u7801\uff1a\n```cpp\n#include<cstdio>\n#define N 110\n#define mod 1000000007\nusing namespace std;\nstruct matrix\n{\n\tlong long a[N][N];\n} s,ans;\nint n=2;\nmatrix operator *(matrix &a,matrix &b)\n{\n\tmatrix x;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tx.a[i][j]=0;\n\t\t\tfor(int k=1;k<=n;k++)\n\t\t\t{\n\t\t\t\tx.a[i][j]=(x.a[i][j]+a.a[i][k]*b.a[k][j])%mod;\n\t\t\t}\n\t\t}\n\t}\n\treturn x;\n}\nint getans(int k)\n{\n\tmatrix ans;\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++) s.a[i][j]=0,ans.a[i][j]=0;\n\ts.a[1][1]=2;\n\ts.a[1][2]=1;\n\ts.a[2][1]=1;\n\tans.a[1][1]=ans.a[2][2]=1;\n\twhile(k)\n\t{\n\t\tif(k&1) ans=ans*s;\n\t\tk=k>>1;\n\t\ts=s*s;\n\t}\n\treturn ans.a[2][1];\n}\nint T=1,a;\nint main()\n{\n\twhile(T--)\n\t{\n\t\tscanf(\"%d\",&a);\n\t\tprintf(\"%d\\n\",getans(a));\n\t}\n}\n```\n\u518d\u770b\u4e00\u770b\uff1a\u5bf9\u4e8e100%\u7684\u6570\u636e\uff0c$n\\leq10^{10000}$\uff0c\u600e\u4e48\u529e\uff1f\n\n\u51c9\u62cc\u5566\uff01\n\n\u76f4\u63a5\u7528\u9ad8\u7cbe\u5ea6\u9664\u6cd5\u5c31\u884c\u4e86\u3002\n\n\u90a3\uff0c\u7528\u4e0d\u7528\u9ad8\u7cbe\u5ea6\u53d6\u6a21\u5462\uff1f\u6839\u672c\u4e0d\u7528\uff0c\u6bd5\u7adf\u5224\u65ad\u4e00\u4e2a\u662f\u662f\u5426\u662f\u5076\u6570\u53ea\u7528\u770b\u5b83\u7684\u5404\u4f4d\u662f\u4e0d\u662f\u5076\u6570\u7f62\u4e86\u3002\n```cpp\n#include<cstdio>\n#include<cstring>\n#define N 110\n#define M 10100\n#define mod 1000000007\nusing namespace std;\nstruct matrix\n{\n\tlong long a[N][N];\n} s,ans;\nint n=2,a[M],len;\nmatrix operator *(matrix &a,matrix &b)\n{\n\tmatrix x;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tx.a[i][j]=0;\n\t\t\tfor(int k=1;k<=n;k++)\n\t\t\t{\n\t\t\t\tx.a[i][j]=(x.a[i][j]+a.a[i][k]*b.a[k][j])%mod;\n\t\t\t}\n\t\t}\n\t}\n\treturn x;\n}\nbool div()\n{\n\tif(a[len]==1) len--,a[len]+=10;\n\tfor(int i=len;i;i--)\n\t{\n\t\tif(a[i]&1) a[i-1]+=10;\n\t\ta[i]=a[i]/2;\n\t}\n\treturn len;\n}\nint getans()\n{\n\tmatrix ans;\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++) s.a[i][j]=0,ans.a[i][j]=0;\n\ts.a[1][1]=2;\n\ts.a[1][2]=1;\n\ts.a[2][1]=1;\n\tans.a[1][1]=ans.a[2][2]=1;\n\twhile(true)\n\t{\n\t\tif(a[1]&1) ans=ans*s;\n\t\tif(!div()) break;\n\t\ts=s*s;\n\t}\n\treturn ans.a[2][1];\n}\nchar str[M];\nint main()\n{\n\tscanf(\"%s\",str);\n\tlen=strlen(str);\n\tfor(int i=0;i<len;i++)\n\t{\n\t\ta[len-i]=str[i]-'0';\n\t}\n\tprintf(\"%d\",getans());\n}\n```\n",
        "postTime": 1584025897,
        "uid": 99506,
        "name": "_LHF_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4451 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206\u3011"
    },
    {
        "content": "#### \u524d\u8a00\n\n\u53d1\u8fd9\u7bc7\u9898\u89e3\u7684\u539f\u56e0\u662f\u56e0\u4e3a\u795e\u9c7c\u81ea\u5df1\u5207\u5b8c\u4e86\u8fd9\u9053\u9898\u7136\u540e\u628a\u6570\u636e\u6539\u4e86\u989d\uff08\uff0c\u7136\u540e\u73b0\u5728\u8fd9\u91cc\u51e0\u4e4e\u6240\u6709\u7684\u9898\u89e3\u90fd\u4e0d\u80fd\u8fc7\u3002\n\n[\u6233\u6211\u8fd4\u56de\u9898\u76ee](https://www.luogu.com.cn/problem/P4451)\n\u3002\n\n#### \u6b63\u6587\n\n\u601d\u8def\u4e0a\u501f\u9274\u4e86[\u8fd9\u7bc7\u9898\u89e3](https://www.luogu.com.cn/blog/asuldb/solution-p4451)\uff0c\u4e5f\u662f\u7a9d\u552f\u4e00\u4e00\u4e2a\u6bd4\u8f83\u80fd\u8d5e\u540c\u7684\u9898\u89e3\u3002\n\n\u6211\u4eec\u9996\u5148\u660e\u786e\u4e00\u4e2a\u4e8b\u5b9e\uff1a\u4e3a\u4ec0\u4e48\u73b0\u5728\u9898\u89e3\u8fc7\u4e0d\u53bb\uff1f\n\n\u4f60\u53ef\u80fd\u4f1a\u8bf4\uff1a\u590d\u6742\u5ea6\u6709\u95ee\u9898\u554a\uff0c\u4f60\u770b\u9012\u63a8\u4ea4\u4e86\u5341\u51e0\u904d\u90fd\u8fc7\u4e0d\u53bb\u3002\n\n\u606d\u559c\u4f60\uff0c\u8bf4\u5bf9\u4e86\u4e00\u534a\u3002\n\n\u539f\u6765\u8fd9\u9898\u7684\u6570\u636e\u8303\u56f4\u662f\uff1a$n\\leq 10^6$\uff0c\u7136\u540e\u6bd2\u7624\u9c7c\u5c31\u8fd9\u4e48\u628a\u5b83\u6539\u6210\u4e86\uff1a$n\\leq 10^9$\u62ff$60\\%$\uff0c\u539f\u6765\u6309\u7167$n\\leq 10^6$\u5199\u7684\u5168\u90e8\u6302\u6389\u3002$n\\leq 10^{10000}$\u62ff$100\\%$\u3002\n\n\u6240\u4ee5\u539f\u5148\u590d\u6742\u5ea6\u6ca1\u6709\u505a\u5230$log_n$\u6216\u8005$\\sqrt{n}$\u53cd\u6b63\u4e00\u5207\u5c0f\u4e8e$n$\u7684\u90fd\u6302\u6389\u4e86\u3002  \n~~\u4e8b\u5b9e\u4e0a\u6211\u4e5f\u6ca1\u6709\u89c1\u8fc7\u6839\u53f7\u7b97\u6cd5\u57fa\u672c\u4e0a\u539f\u6765\u5168\u90fd\u662flog\u7ea7\u7684\u3002~~\n\n\u6211\u4eec\u901a\u8fc7\u4e0a\u4e00\u7bc7\u9898\u89e3\u6700\u540e\u63a8\u51fa\u6765\u7684\u5f0f\u5b50\uff1a\n\n$$\\text{ans}_n\u2261(1+59713600)^n*59713600*250000002-(1-59713600)^n*597136000*250000002\\ \\ (\\text{mod} 10^9+7)$$\n\n\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u7528\u5feb\u901f\u5e42\u89e3\u51b3\uff0c\u590d\u6742\u5ea6$O(log_n)$\uff0c\u6211\u4eec\u80fd\u62ff\u5230$60\\%$\u3002\n\n\u7136\u540e\u6211\u4eec\u8003\u8651\u6ee1\u5206\u3002\u76ee\u524d\u6ca1\u6709\u5b66\u8fc7\u80fd\u628a$10^{10000}$\u6b21\u65b9\u538b\u4e0b\u6765\u901a\u8fc7\u7684\u7b97\u6cd5\uff0c\u5982\u679c\u6709\u90a3\u5c31\u5f88\u795e\u4ed9\u4e86\u3002\n\n\u6211\u4eec\u8003\u8651\u8d39\u9a6c\u5c0f\u5b9a\u7406\u3002\u7531\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff0c\u6216\u8005\u73c2\u4ee5\u5b9e\u8df5\u51fa\u771f\u77e5\uff0c\u6211\u4eec\u53d1\u73b0\uff1a\n\n$$\\text{ans}_n\u2261\\text{ans}_{n\u00b1k(10^9+6)}$$\n\n\u76f4\u63a5\u73c2\u4ee5\u628a\u6570\u636e\u8303\u56f4\u538b\u5230$n\\leq 10^9$\uff0c\u521a\u521a\u8bb2\u7684\u505a\u6cd5\u3002\n\n\u7ed9\u51fa\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nconst long long MOD=1e9+7;\nusing namespace std;\ntypedef long long ll;\nll n;\nll a;\nll read(){\n\tll ret=0; char ch=0;\n\twhile(!isdigit(ch)) ch=getchar();\n\twhile(isdigit(ch)){\n\t\tret=((ret<<1)+(ret<<3)+ch-'0')%(MOD-1);\n\t\tch=getchar();\n\t}\n\treturn ret;\n}\n\n//\u8fb9\u8bfb\u8fb9\u6a21\uff0c\u611f\u8c22@\u82e5\u5982\u521d\u89c1 \u6559\u4f1a\u6211\u8fd9\u4e2a\u5c0f\u6280\u5de7\u3002\n\nll ksm(ll a,ll b,ll m){\n\tif(b==0)\n\t\treturn 1;\n\telse if(b%2==1)\n\t\treturn a*ksm(a,b-1,m)%m;\n\telse{\n\t\tll num=ksm(a,b/2,m)%m; \n\t\treturn num*num%m;\n\t}\n}\n\n//\u5feb\u901f\u5e42\n\nint main(){\n\tn=read();\n\tcout<<(ksm(1+59713600,n,MOD)*59713600%MOD*250000002%MOD-ksm(1-59713600+MOD,n,MOD)%MOD*59713600%MOD*250000002%MOD+MOD)%MOD<<endl;//\u76f4\u63a5\u8f93\u51fa\u3002\n}\n```",
        "postTime": 1577012357,
        "uid": 143271,
        "name": "HohleFeuerwerke",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4451 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206\u3011"
    },
    {
        "content": "\u751f\u6210\u51fd\u6570\u4e00\u8840\u796d\u3002\n\n\u9996\u5148\u8bbe\u7b54\u6848\u4e3a$g(n)$\uff0c\u6709\u4e00\u4e2a\u663e\u7136\u7684\u9012\u63a8\u5f0f\uff1a$g(n)=\\sum_{i=1}^nfib_{i}\\times g_{n-i}$\uff0c\u53e6\u5916$g_0=1$\n\n\u90a3\u4e48\u4ed6\u7684\u751f\u6210\u51fd\u6570\uff1a\n$$\nG(x)=\\sum_{n=0}g_nx^n\n$$\n\n$$\n=\\sum_{n=0}(\\sum_{i=0}^{n-1}fib_ig_{n-i}+[n=0])x^n\n$$\n\n$$\n=1+\\sum_{n=0}x^n\\sum_{i=0}^{n-1}fib_ig_{n-i}\n$$\n\n$$\n=1+\\sum_{n=0}\\sum_{i=0}^{n-1}fib_ix^i\\times g_{n-i}x^{n-i}\n$$\n\n\u5c31\u53ef\u4ee5\u770b\u6210\uff1a\n$$\nG(x)=1+F(x)\\times G(x)\n$$\n$F(x)$\u662f\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u751f\u6210\u51fd\u6570\uff0c\u4f17\u6240\u5468\u77e5\uff1a\n$$\nF(x)=\\frac{x}{1-x-x^2}\n$$\n\u90a3\u4e48\uff1a\n$$\nG(x)=\\frac{1-x-x^2}{1-2x-x^2}=1+\\frac{x}{1-2x-x^2}\n$$\n$1-2x-x^2$\u53ef\u4ee5\u56e0\u5f0f\u5206\u89e3\u6210$(1-(1+\\sqrt2)x)(1-(1-\\sqrt2)x)$\n\n\u4e24\u9879\u7684\u5dee\u662f$2\\sqrt2x$\uff0c\u90a3\u4e48\u6211\u4eec\u6765\u628a\u4ed6\u88c2\u9879\uff1a\n$$\nG(x)=1+\\frac{x}{2\\sqrt2x}(\\frac{1}{1-(1+\\sqrt2)x}-\\frac{1}{1-(1-\\sqrt2)x})\n$$\n\u4e0d\u7ba1\u90a3\u4e2a\u4e00\uff0c\u6211\u4eec\u5df2\u7ecf\u5f97\u5230\u4e86\u60f3\u8981\u7684\u5f0f\u5b50\uff0c\u8fd9\u662f\u4e00\u4e2a\u7b2c$n$\u7cfb\u6570\u4e3a$\\frac{((1+\\sqrt2)x)^n-((1-\\sqrt2)x)^n}{2\\sqrt2}$\u7684\u591a\u9879\u5f0f\uff0c\u540c\u65f6\u8fd9\u4e2a\u7cfb\u6570\u4e5f\u662f\u6211\u4eec\u8981\u6c42\u7684\u7b54\u6848\u3002\n\n\u6240\u4ee5\u6211\u4eec\u6c42\u51fa\u4e86$G(x)$\u7684\u901a\u9879\n\nPS\uff1a $\\sqrt2\u226159713600(mod\\ 1e9+7)$\n\n```c++\n#include<cstdio>\n#include<iostream>\n#define re register\n#define mod 1000000007\nconst int s2=59713600;\nusing namespace std;\ninline int add(re int x,re int y){return x+y>=mod?x+y-mod:x+y;}\ninline int dec(re int x,re int y){return x-y<0?x-y+mod:x-y;}\ninline int mul(re int x,re int y){return 1ll*x*y-1ll*x*y/mod*mod;}\ninline int ksm(int a,int b){\n\tint res=1;\n\twhile (b){\n\t\tif (b&1) res=mul(res,a);\n\t\ta=mul(a,a); b>>=1;\n\t}\n\treturn res;\n}\nint main(){\n\tint n; scanf(\"%d\",&n);\n\tprintf(\"%d\\n\",mul(dec(ksm(add(1,s2),n),ksm(dec(1,s2),n)),\n\tksm(mul(2,s2),mod-2)));\n\treturn 0;\n}\n```\n\n",
        "postTime": 1561698514,
        "uid": 63661,
        "name": "Taduro",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4451 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206\u3011"
    },
    {
        "content": "## \u9898\u610f\u7b80\u8ff0\n\u8bbe$F_{x}$\u4e3a\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7b2c$x$\u9879\n\n\u5c06\u4e00\u4e2a\u6570$n$\u62c6\u5206\u4e3a$a{1}, a{2}, ..., a{m}$, \u5373$a{1} + a{2} +...+ a{m} = n$\n\n\u6c42$\\sum\\prod\\limits_{i =1}^m F_{a_i}$\n\n## \u9898\u89e3\n\u6211\u592a\u5f31\u4e86\u6240\u4ee5\u4e0d\u4f1a\u751f\u6210\u51fd\u6570\u4e71\u641e\uff0c\u53ea\u80fd\u9012\u63a8\n\n\u8fd8\u6709\u6211\u89c9\u5f97\u5176\u4ed6\u9012\u63a8\u597d\u50cf\u6709\u70b9\u5c0f\u9519\u8bef\uff0c\u5b83\u4eec\u6ca1\u6709\u8ba1\u7b97\u5f53n\u53ea\u5206\u89e3\u4e3an\u65f6\u7684\u60c5\u51b5\uff0c~~\u867d\u7136\u9012\u63a8\u5f0f\u4e00\u6837~~\n\n$F_{x}$\u4e3a\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7b2c$x$\u9879\n\n\u8bbe$g(i)$\u4e3a\u5f53n = i\u65f6\u7684\u7b54\u6848\n\n\u6240\u4ee5\n\n$g(i) = \\sum\\limits_{j = 1} ^ {i - 1} g(j) * F_{i - j} + F_i$\n\n\u52a0\u4e0a\u4e00\u4e2a$F_i$\u662f\u8ba1\u7b97\u5f53i\u62c6\u5206\u6210i\u65f6\u7684\u8d21\u732e\n\n$g(i + 1) = \\sum\\limits_{j = 1} ^ {i} g(j) * F_{i + 1 - j} + F_{i + 1}$\n\n$g(i + 1) - g(i)$\n\n$ = \\sum\\limits_{j = 1} ^ {i - 1} g(j) * (F_{i + 1 - j} - F_{i - j}) + g(i) * F_1 + F_{i + 1} - F_i$\n\n$ = \\sum\\limits_{j = 1} ^ {i - 1} g(j) * F_{i - j - 1} + g(i) + F_{i - 1}$\n\n$ = \\sum\\limits_{j = 1} ^ {i - 2} g(j) * F_{i - j - 1} + F_{i - 1} + g(i)$\n\n$ = g(i - 1) + g(i)$\n\n\u6240\u4ee5 $g(i + 1) = 2 * g(i) + g(i - 1)$ \u4e14 $g(0) = 0, g(1) = 1$\n\n\u518d\u76f4\u63a5\u9012\u63a8\u6216\u77e9\u9635\u5feb\u901f\u5e42\u6c42\u7b2c$n$\u9879\u5373\u53ef\n\u6211\u7528\u7684\u662f\u77e9\u9635\u5feb\u901f\u5e42\n\n## \u4ee3\u7801\n```cpp\n#include <cstdio>\ntypedef long long ll;\nconst int mod = 1000000007;\nint T, N;\nint n;\nstruct Matrix\n{\n    int a[4][4];\n    Matrix& operator =(const Matrix& x)\n    {\n        for (register int i = 1; i <= N; ++i)\n            for (register int j = 1; j <= N; ++j)\n                a[i][j] = x.a[i][j];\n        return *this;\n    }\n};\nMatrix a, b, c;\nMatrix Mul(const Matrix& x, const Matrix& y)\n{\n    Matrix s;\n    for (register int i = 1; i <= N; ++i)\n        for (register int j = 1; j <= N; ++j)\n            s.a[i][j] = 0;\n    for (register int k = 1; k <= N; ++k)\n    \tfor (register int i = 1; i <= N; ++i)\n        \tfor (register int j = 1; j <= N; ++j)\n                s.a[i][j] = (s.a[i][j] + (ll)x.a[i][k] * y.a[k][j] % mod) % mod;\n    return s;\n}\nMatrix _pow(Matrix x, int y)\n{\n    Matrix s;\n    for (register int i = 1; i <= N; ++i)\n        for (register int j = 1; j <= N; ++j)\n            s.a[i][j] = (i == j);\n    for (; y; y >>= 1, x = Mul(x, x)) if (y & 1) s = Mul(s, x);\n    return s;\n}\nint main()\n{\n    N = 2;\n    scanf(\"%d\", &n);\n    c.a[1][1] = 0; c.a[1][2] = 1;\n    a.a[2][1] = a.a[1][2] = 1; a.a[2][2] = 2;\n    if (n <= 1) {printf(\"%d\\n\", c.a[1][n + 1]); return 0; }\n    b = Mul(c, _pow(a, n - 1));\n    printf(\"%d\\n\", b.a[1][2]);\n}\n```",
        "postTime": 1541160169,
        "uid": 10602,
        "name": "xuyixuan",
        "ccfLevel": 0,
        "title": "P4451 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206"
    }
]
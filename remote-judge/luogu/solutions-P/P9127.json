[
    {
        "content": "# \u5199\u5728\u524d\u9762\n\n1. \u8fd9\u9898\u867d\u7136\u662f\u4e00\u9053\u9ec4\u9898\uff08\u5176\u5b9e\u5e94\u8be5\u8bc4\u7eff\u7684\uff09\uff0c\u4f46\u662f\u662f\u5bf9\u4e8e $O(n^3)$ \u7684\u505a\u6cd5\u800c\u8a00\uff1b\u8fd9\u7bc7\u535a\u5ba2\u7684\u505a\u6cd5\u662f $O(n^2\\log n)$\uff0c\u4e2a\u4eba\u89c9\u5f97\u5927\u6982\u7b97\u84dd\u3002\n\n2. **\u8fd9\u4e2a\u505a\u6cd5\u7ec6\u8282\u5f88\u591a**\uff0c\u6211\u4e03\u4e03\u516b\u516b\u7b97\u4e0b\u6765\u4ea4\u4e86\u5341\u51e0\u53d1\u624d\u8fc7\uff0c\u601d\u8def\u548c\u53e6\u4e00\u4e2a\u5927\u4f6c\u5f88\u50cf\uff0c\u4f46\u662f\u76f8\u5bf9\u4e8e\u4ed6\u7684\u535a\u5ba2\u8fdb\u884c\u4e86\u4e00\u4e9b\u4f18\u5316\uff0c\u5e76\u4e14\u66f4\u8be6\u7ec6\u5730\u89e3\u91ca\u4e86\u8fd9\u79cd $O(n^2\\log n)$ \u7684\u505a\u6cd5\u3002\n\n# \u9898\u610f\n\n[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P9127)\n\n\u7ed9\u4f60\u4e00\u4e2a\u6570\u7ec4 $a$\uff0c\u521d\u59cb\u65f6\u6570\u7ec4\u7684**\u6240\u6709**\u533a\u95f4\u7684\u533a\u95f4\u548c\u4e92\u4e0d\u76f8\u540c\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $i\\in [1,N]$\uff0c\u5c06 $a_i$ \u6539\u4e3a $a_i'$ \u4f7f\u5f97\u6570\u7ec4\u4f1a\u6709\u4e24\u4e2a\u533a\u95f4\u7684\u533a\u95f4\u548c\u76f8\u7b49\uff0c\u6c42 $\\lvert a_i-a_i'\\rvert$ \u7684\u6700\u5c0f\u503c\u3002\n\n# \u6027\u8d28\n\n1. \u6211\u4eec\u5f88\u5bb9\u6613\u60f3\u5230\u4e00\u4e2a\u6027\u8d28\uff1a\u79f0\u6211\u4eec\u4fee\u6539\u7684\u6570\u53eb $i$\uff0c\u6700\u540e\u533a\u95f4\u548c\u76f8\u7b49\u7684\u4e24\u4e2a\u533a\u95f4\u4e00\u5b9a\u662f**\u4e00\u4e2a\u533a\u95f4\u5305\u542b $i$\uff0c\u4e00\u4e2a\u4e0d\u5305\u542b**\u3002\u539f\u56e0\u5f88\u7b80\u5355\uff0c\u56e0\u4e3a\u5bf9 $i$ \u4fee\u6539\u8fc7\u540e\u5305\u542b $i$ \u7684\u6240\u6709\u533a\u95f4\u7684\u533a\u95f4\u548c\u90fd\u4f1a\u53d8\u5316 $\\Delta i$\uff0c\u5047\u8bbe\u4e24\u4e2a\u533a\u95f4\u90fd\u5305\u542b\uff0c\u90a3\u4e48\u4ed6\u4eec\u8fd9\u4e24\u4e2a\u533a\u95f4\u7684\u76f8\u5bf9\u5927\u5c0f\u548c\u4fee\u6539\u524d\u4e00\u6837\uff0c\u800c\u4fee\u6539\u524d\u9898\u76ee\u4fdd\u8bc1\u4e86\u6ca1\u6709\u4ecd\u548c\u533a\u95f4\u548c\u76f8\u7b49\uff0c\u56e0\u6b64\u540c\u65f6\u5305\u542b $i$ \u7684\u4e24\u4e2a\u533a\u95f4\u4fee\u6539\u540e\u4e0d\u53ef\u80fd\u533a\u95f4\u548c\u76f8\u7b49\u3002\n\n2. \u7531\u4e8e\u9898\u76ee\u53ea\u8ba9\u6211\u4eec\u8f93\u51fa\u4fee\u6539\u7684\u6700\u5c0f\u5dee\u503c\uff0c\u800c\u4e0d\u7528\u8f93\u51fa\u5177\u4f53\u65b9\u6848\uff0c\u6211\u4eec\u627e\u5230\u4e00\u4e2a\u6027\u8d28\uff1a**\u4e24\u4e2a\u533a\u95f4\u6709\u4ea4\u7684\u60c5\u51b5\u4e00\u5b9a\u80fd\u5f52\u7eb3\u4e3a\u65e0\u4ea4\u7684\u60c5\u51b5**\u3002\n\n   1. \u8003\u8651\u4e24\u4e2a\u533a\u95f4\u4ea4\u53c9\u7684\u60c5\u51b5\n\n      \u5982\u56fe\uff0c\u7531\u4e8e\u6211\u4eec\u4fee\u6539\u7684 $i$ \u7531\u4e8e\u4e0a\u8ff0\u6027\u8d28\u4e0d\u80fd\u540c\u65f6\u88ab\u4e24\u4e2a\u533a\u95f4\u5305\u542b\uff08\u5373\u4e24\u6761\u84dd\u8272\u865a\u7ebf\u4e2d\u95f4\uff09\uff0c\u90a3\u4e48\u5bf9\u4e8e\u533a\u95f4\u548c\u76f8\u7b49\u7684\u4e24\u4e2a\u4ea4\u53c9\u7684\u7ea2\u8272\u533a\u95f4\uff0c\u540c\u65f6\u51cf\u53bb\u84dd\u8272\u865a\u7ebf\u62ec\u8d77\u6765\u7684\u4e2d\u95f4\u90e8\u5206\uff0c\u5c31\u80fd\u5f52\u7eb3\u4e3a\u4e24\u4e2a\u65e0\u4ea4\u7684\u6a59\u8272\u533a\u95f4\u533a\u95f4\u548c\u76f8\u7b49\u3002\n\n      ![](https://i.328888.xyz/2023/05/10/iYfLaZ.png)\n\n   2. \u8003\u8651\u4e00\u4e2a\u533a\u95f4\u5305\u542b\u53e6\u4e00\u4e2a\u533a\u95f4\u7684\u60c5\u51b5\n\n      \u5982\u56fe\uff0c\u5bf9\u4e8e\u533a\u95f4\u548c\u76f8\u7b49\u7684\u4e24\u4e2a\u7ea2\u8272\u533a\u95f4\uff0c\u540c\u65f6\u51cf\u53bb\u84dd\u8272\u865a\u7ebf\u62ec\u8d77\u6765\u7684\u90e8\u5206\uff0c\u53ef\u4ee5\u5f52\u7eb3\u4e3a\u4e24\u4e2a\u6a59\u8272\u533a\u95f4\u7684\u533a\u95f4\u548c\u4e92\u4e3a\u76f8\u53cd\u6570\u3002\n\n      ![](https://i.328888.xyz/2023/05/10/iYfKe8.png)\n\n3. \u4e24\u4e2a\u533a\u95f4\u548c\u76f8\u52a0\u4e3a $0$ \u7684\u6027\u8d28\uff08\u6ce8\u610f\u8fd9\u91cc\u7684\u201c\u533a\u95f4\u201d\u6982\u5ff5\u540c\u6837\u4e5f\u6307\u4e00\u4e2a\u6570\uff0c\u5373\u533a\u95f4 $[i,i]$\uff09\uff1a\u5982\u679c\u4e24\u4e2a\u533a\u95f4\uff0c\u533a\u95f4\u548c\u4e3a $0$\uff0c\u5b83\u4eec\u8981\u5bf9\u7b54\u6848\u4ea7\u751f\u8d21\u732e\u4ec5\u5f53\u8fd9\u4e24\u4e2a\u533a\u95f4\u4e2d\u95f4\u8fd8\u6709\u5176\u4ed6\u6570\uff0c\u6216\u8005\u8fd9\u4e24\u4e2a\u533a\u95f4\u65c1\u8fb9\u8fd8\u6709\u5176\u4ed6\u6570\u3002\u4e3a\u4ec0\u4e48\uff1f\u5982\u679c\u8fd9\u4e24\u4e2a\u533a\u95f4\u4e2d\u95f4\u6709\u5176\u4ed6\u6570\u5219\u53ef\u5f52\u7eb3\u4e3a\u6027\u8d28\u4e8c\u7684\u533a\u95f4\u5305\u542b\u7684\u60c5\u51b5\uff0c\u800c\u5982\u679c\u8fd9\u4e24\u4e2a\u533a\u95f4\u662f\u6328\u5728\u4e00\u8d77\u7684\uff08\u5982\u4e0b\u56fe\uff0c\u7ea2\u8272\u548c\u7eff\u8272\u4ee3\u8868\u8fd9\u4e24\u4e2a\u533a\u95f4\uff0c\u7c89\u8272\u4ee3\u8868\u5176\u4ed6\u6570\uff09\uff0c\u90a3\u4e48\u8fd9\u4e24\u4e2a\u533a\u95f4\u53ef\u4ee5\u5408\u5e76\u4e3a\u4e00\u4e2a\u533a\u95f4\u548c\u4e3a $0$ \u7684\u533a\u95f4\uff0c\u52a0\u4e0a\u65c1\u8fb9\u7684\u6570\u5c31\u7b49\u4e8e\u65c1\u8fb9\u7684\u6570\uff0c\u7b26\u5408\u9898\u76ee\u8981\u6c42\uff1b\u800c\u5982\u679c\u6ca1\u6709\u65c1\u8fb9\u7684\u6570\uff0c\u8fd9\u4e24\u4e2a\u533a\u95f4\u548c\u7b49\u4e8e $0$ \u5c31\u6ca1\u7528\u3002\n\n   \u6700\u540e\uff0c\u8981\u6c42\u662f\u4e24\u4e2a\u533a\u95f4\u4e2d\u95f4\u6216\u8005\u4e24\u8fb9\u6709\u5176\u4ed6\u6570\uff0c\u6211\u4eec\u5408\u5e76\u4e00\u4e0b\u8fd9\u4e24\u4e2a\u8981\u6c42\uff0c\u53d8\u4e3a\uff1a\u8fd9\u4e24\u4e2a\u533a\u95f4\u7684\u5e76\u96c6\u7684\u8865\u96c6\u975e\u7a7a\u3002\n   \n   \uff08\u4e0b\u9762\u7684\u56fe\u6709\u70b9\u95ee\u9898\uff0c\u4e0d\u5e94\u8be5\u662f\u5e76\u96c6\u7b26\u53f7\uff0c\u4e3a\u52a0\u53f7\u66f4\u5408\u9002\uff09\n\n   ![](https://i.328888.xyz/2023/05/10/iYAshd.png)\n\n# \u505a\u6cd5\n\n\u638c\u63e1\u4e86\u4ee5\u4e0a\u51e0\u4e2a\u6027\u8d28\uff0c\u6211\u4eec\u603b\u7ed3\u4e00\u4e0b\u6700\u7ec8\u6211\u4eec\u9700\u8981\u5e72\u4e9b\u4ec0\u4e48\uff1a\n\n> \u627e\u51fa\u4e24\u4e2a\u4e0d\u76f8\u4ea4\u7684\u533a\u95f4\uff0c\u4e00\u4e2a\u5305\u542b $i$\uff0c\u4e00\u4e2a\u4e0d\u542b\uff0c\u7528\u5b83\u4eec\u533a\u95f4\u548c\u7684\u5dee\u503c\u66f4\u65b0\u7b54\u6848\uff0c\u6216\u8005\u7528\u533a\u95f4\u548c\u52a0\u8d77\u6765\u7b49\u4e8e $0$ \u7684\u6700\u5c0f\u4fee\u6539\u4ee3\u4ef7\u66f4\u65b0\u7b54\u6848\u3002\n\n\u6211\u4eec\u679a\u4e3e $l$ \u4f5c\u4e3a\u5206\u754c\u7ebf\uff0c\u5c06 $l$ \u4e4b\u524d\uff08\u4e0d\u5305\u62ec $l$\uff09\u7684\u6240\u6709\u533a\u95f4\u90fd\u653e\u5165\u4e00\u4e2a `set` \u91cc\u9762\uff0c\u518d\u679a\u4e3e $r\\in [l,n]$\uff0c\u5f97\u5230\u6240\u6709\u4ee5 $l$ \u5f00\u5934\u7684\u533a\u95f4\u3002\u6211\u4eec\u5206\u51fa\u4e86\u4e24\u79cd\u533a\u95f4\uff0c\u4e00\u79cd\u662f $l$ \u5de6\u8fb9\u7684\u533a\u95f4\uff0c\u4e00\u79cd\u662f\u53f3\u8fb9\u7684\u533a\u95f4 $[l,r]$\u3002\u6211\u4eec\u7528\u524d\u7f00\u548c $O(1)$ \u7b97\u51fa\u53f3\u8fb9\u533a\u95f4\u7684\u533a\u95f4\u548c\uff0c\u518d\u5728 `set` \u4e2d $O(\\log n)$ \u627e\u51fa\u4e0e\u5b83\u533a\u95f4\u548c\u6700\u63a5\u8fd1\u7684\u533a\u95f4\uff0c\u6c42\u51fa\u5b83\u4eec\u533a\u95f4\u548c\u7684\u5dee\u503c\uff0c\u8fd9\u4e2a\u5dee\u503c\u610f\u5473\u7740\uff1a**\u201c$[l,r]$ \u7684\u533a\u95f4\u548c\u8981\u7b49\u4e8e\u53e6\u4e00\u4e2a\u533a\u95f4\u7684\u533a\u95f4\u548c\u7684\u6700\u5c0f\u5dee\u503c\u201d**\uff0c\u6ce8\u610f\u8fd9\u4e2a\u201c\u5dee\u503c\u201d\u53ef\u4ee5\u5e94\u7528\u4e8e $[l,r]$ \u5f53\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u6570\uff0c\u56e0\u4e3a $[l,r]$ \u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u6570\u52a0\u4e0a\u8fd9\u4e2a\u5dee\u503c\u90fd\u53ef\u4ee5\u4f7f\u5f97 $[l,r]$ \u7684\u533a\u95f4\u548c\u7b49\u4e8e\u53e6\u4e00\u4e2a\u533a\u95f4\u7684\u533a\u95f4\u548c\uff0c\u6240\u4ee5\u6240\u6709 $ans_i\\ (i\\in [l,r])$ \u90fd\u8981\u88ab\u8fd9\u4e2a\u5dee\u503c\u66f4\u65b0\u4e00\u6b21\u3002\n\n\u4f46\u6211\u4eec\u6ca1\u6709\u5fc5\u8981\u56e0\u6b64\u5199\u6570\u636e\u7ed3\u6784\u7ef4\u62a4 $ans_i$ \u7684\u6700\u5c0f\u503c\uff0c\u5bb9\u6613\u53d1\u73b0\u5f53 $l$ \u56fa\u5b9a\u7684\u65f6\u5019\uff0c$ans_i$ \u4f1a\u88ab\u6240\u6709 $[l,r]\\ (i\\leq r\\leq n)$ \u7684\u5dee\u503c\u66f4\u65b0\u4e00\u904d\uff0c\u56e0\u6b64\u5012\u5e8f\u679a\u4e3e $r$ \u5e76\u4e14 $O(1)$ \u7ef4\u62a4\u4e00\u4e2a $\\min_{r\\leq j\\leq n}\\{ans_j\\}$ \u5373\u53ef\u3002\n\n\u540c\u7406\uff0c\u524d\u9762\u6211\u4eec\u627e\u4e86\u533a\u95f4\u548c\u5dee\u503c\u6700\u5c0f\u7684\u4e24\u4e2a\u533a\u95f4\uff0c\u6211\u4eec\u5c06 $[l,r]$ \u7684\u533a\u95f4\u548c\u53d6\u76f8\u53cd\u6570\uff0c\u5373\u53ef\u627e\u533a\u95f4\u548c\u52a0\u8d77\u6765\u7b49\u4e8e $0$ \u7684\u6700\u5c0f\u4fee\u6539\u4ee3\u4ef7\u3002\u5177\u4f53\u5b9e\u73b0\u4ee3\u7801\u4e0e\u4e0a\u6587\u76f8\u540c\uff0c\u53ea\u662f\u786e\u5b9a\u4e86\u4e24\u4e2a\u533a\u95f4\u540e\u788d\u4e8e\u6027\u8d28\u4e09\u6211\u4eec\u9700\u8981\u5224\u65ad\u4ed6\u4eec\u7684\u5e76\u96c6\u662f\u5426\u8986\u76d6\u4e86\u5168\u90e8\u533a\u95f4\u3002\n\n\u6700\u540e\uff0c\u9700\u8981\u6ce8\u610f\u4e00\u70b9\uff0c\u6700\u5f00\u59cb\u7684\u65f6\u5019 $ans_i$ \u9700\u8981\u8bbe\u4e3a $num_i$\uff0c\u8868\u793a\u5b83\u628a\u81ea\u5df1\u53d8\u4e3a $0$ \u7684\u4ee3\u4ef7\uff08$N\\geq 2$\uff0c\u4e0d\u7528\u4e0e\u62c5\u5fc3\u6027\u8d28\u4e09\u51b2\u7a81\uff09\u3002\n\n# \u4ee3\u7801\n\n\u6700\u540e\u653e\u4e0a\u4ee3\u7801\uff0c\u5c0f\u63d0\u9192\uff1a\u7531\u4e8e\u6d89\u53ca\u5927\u91cf\u533a\u95f4\u64cd\u4f5c\uff0c`for` \u7684\u65f6\u5019\u6ce8\u610f\u8303\u56f4\u3001\u5f00\u95ed\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntemplate<class T>inline void rd(T &x){\n\tT res=0,f=1;\n\tchar ch=getchar();\n\twhile(!isdigit(ch)){if(ch=='-')f=-1; ch=getchar();}\n\twhile(isdigit(ch)){res=res*10+ch-'0';ch=getchar();}\n\tx=res*f;\n}\ntemplate<class T>inline void wt(T x){\n\tif(x<0){x=-x;putchar('-');}\n\tif(x>9) wt(x/10);\n\tputchar(x%10+'0');\n}\ntypedef long long LL;\nconst LL LLINF=numeric_limits<LL>::max()-1;\nconst int MAXN=505;\nint n;\nstruct Node{\n    LL val;\n    int l,r;\n    bool operator < (const Node &y) const{\n        return val<y.val;\n    }\n};\nLL a[MAXN],pre[MAXN],ans[MAXN];\nset<Node>s;\ninline bool is_range_merge_cover_all(int l1,int r1,int l2,int r2){\n    if(l1>l2) swap(l1,l2),swap(r1,r2);\n    // cout<<l1<<' '<<r1<<' '<<l2<<' '<<r2<<endl;\n    if(r1+1<l2) return false;\n    if(l1<=1 && max(r1,r2)>=n) return true;\n    return false;\n}\nint main(){\n    rd(n);\n    if(n==2){//\u7279\u5224n==2\n        rd(a[1]);rd(a[2]);\n        cout<<min(abs(a[1]),abs(a[2]-a[1]))<<endl<<min(abs(a[2]),abs(a[2]-a[1]));\n        return 0;\n    }\n    pre[0]=0;\n    for(int i=1;i<=n;i++){\n        rd(a[i]);\n        ans[i]=abs(a[i]);//\u5c06\u81ea\u5df1\u53d8\u4e3a0\u7684\u4ee3\u4ef7\n        pre[i]=pre[i-1]+a[i];\n    }\n    LL tmp,minx;\n    set<Node>::iterator res;\n    s.insert({a[1],1,1});\n    for(int l=2;l<=n;l++){\n        minx=LLINF;\n        for(int r=n;r>=l;r--){\n            tmp=pre[r]-pre[l-1];\n            minx=min(minx,abs(tmp));//\u8fd9\u4e00\u6b65\u7684\u539f\u56e0\u662f\u5c06\u8fd9\u4e2a\u6570\u53d8\u4e3a0\u8fc7\u540e\u4efb\u610f\u76f8\u90bb\u533a\u95f4\u52a0\u5b83\u90fd\u7b49\u4e8e\u81ea\u5df1\n            res=s.lower_bound({tmp,-1,-1});//\u627e\u540e\u7ee7\n            if(res!=s.end()) minx=min(minx,abs(res->val-tmp));\n            if(res!=s.begin()){\n                res--;//\u627e\u524d\u9a71\n                minx=min(minx,abs(res->val-tmp));\n            }\n            ans[r]=min(ans[r],minx);\n\n            tmp=-tmp;//\u627e\u4e0e\u8fd9\u4e2a\u533a\u95f4\u548c\u7684\u76f8\u53cd\u6570\u6700\u63a5\u8fd1\u7684\u533a\u95f4\u548c\uff0c\u4f7f\u4ed6\u4eec\u62b5\u6d88\u6210\u4e3a0\u7684\u4ee3\u4ef7\u6700\u5c0f\n            res=s.lower_bound({tmp,-1,-1});//\u627e\u540e\u7ee7\n            if(res!=s.end())\n                if(!is_range_merge_cover_all(l,r,res->l,res->r))\n                    minx=min(minx,abs(res->val-tmp));//\u5982\u679c\u8fd9\u4e24\u4e2a\u533a\u95f4\u8986\u76d6\u4e86\u6240\u6709\u6570\u5219\u65e0\u6cd5\u6ee1\u8db3\u9898\u76ee\u6761\u4ef6\n            if(res!=s.begin()){\n                res--;//\u627e\u524d\u9a71\n                if(!is_range_merge_cover_all(l,r,res->l,res->r))\n                    minx=min(minx,abs(res->val-tmp));\n            }\n            ans[r]=min(ans[r],minx);\n        }\n        for(int i=1;i<=l;i++)\n            s.insert({pre[l]-pre[i-1],i,l});\n    }\n    \n    s.clear();\n    s.insert({a[n],n,n});\n    for(int r=n-1;r>=1;r--){\n        minx=LLINF;\n        for(int l=1;l<=r;l++){\n            tmp=pre[r]-pre[l-1];\n            minx=min(minx,abs(tmp));\n            res=s.lower_bound({tmp,-1,-1});//\u627e\u540e\u7ee7\n            if(res!=s.end()) minx=min(minx,abs(res->val-tmp));\n            if(res!=s.begin()){\n                res--;//\u627e\u524d\u9a71\n                minx=min(minx,abs(res->val-tmp));\n            }\n            ans[l]=min(ans[l],minx);\n\n            tmp=-tmp;\n            res=s.lower_bound({tmp,-1,-1});//\u627e\u540e\u7ee7\n            if(is_range_merge_cover_all(l,r,res->l,res->r)) continue;\n            if(res!=s.end())\n                if(!is_range_merge_cover_all(l,r,res->l,res->r))\n                    minx=min(minx,abs(res->val-tmp));\n            if(res!=s.begin()){\n                res--;//\u627e\u524d\u9a71\n                if(!is_range_merge_cover_all(l,r,res->l,res->r))\n                    minx=min(minx,abs(res->val-tmp));\n            }\n            ans[l]=min(ans[l],minx);\n        }\n        for(int i=n;i>=r;i--)\n            s.insert({pre[i]-pre[r-1],r,i});\n    }\n    for(int i=1;i<=n;i++) wt(ans[i]),putchar('\\n');\n    return 0;\n}\n```",
        "postTime": 1683709533,
        "uid": 77584,
        "name": "__SkyNet_PKN___",
        "ccfLevel": 0,
        "title": "P9127\u9898\u89e3"
    },
    {
        "content": "[My Blog](https://www.cnblogs.com/feyn)\n\n\u5927\u6982\u9898\u610f\u662f\u8bf4\u4f60\u6709\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217 $a$\uff0c\u663e\u7136\u5b83\u6709 $\\frac{n(n+1)}{2}$ \u4e2a\u533a\u95f4\u548c\u3002\u5bf9\u4e8e\u6bcf\u4e2a $x$\uff0c\u4f60\u53ef\u4ee5\u628a $a_x$ \u6539\u6210 $c$\uff0c\u4f7f\u5f97\u4fee\u6539\u4e4b\u540e\u8fd9\u4e2a\u5e8f\u5217\u5b58\u5728\u4e24\u4e2a\u533a\u95f4\u548c\u76f8\u540c\uff0c\u8f93\u51fa\u6700\u5c0f\u7684 $|a_x-c|$\u3002\n\n\u89c2\u5bdf\u6570\u636e\u8303\u56f4 $n\\le 500$\uff0c\u53ef\u4ee5\u91c7\u7528 $O(N^3)$ \u7684\u7b97\u6cd5\u3002\u601d\u8003\u4fee\u6539 $a_x$ \u4f1a\u53d1\u751f\u4ec0\u4e48\uff0c\u6240\u6709\u7684\u533a\u95f4\u5206\u6210\u4e24\u7c7b\uff0c\u4e00\u7c7b\u662f\u5305\u542b $a_x$ \u7684\uff0c\u4e00\u7c7b\u662f\u4e0d\u5305\u542b\u7684\uff0c\u4fee\u6539\u5e76\u4e0d\u4f1a\u6539\u53d8\u540c\u4e00\u7c7b\u533a\u95f4\u4e4b\u95f4\u7684\u5dee\u503c\uff0c\u4e8e\u662f\u95ee\u9898\u53d8\u6210\u4e86\u627e\u5230\u4e24\u7c7b\u533a\u95f4\u4e2d\u6700\u63a5\u8fd1\u7684\u4e00\u5bf9\u533a\u95f4\uff0c\u60f3\u5230\u628a\u4e24\u7c7b\u533a\u95f4\u6309\u7167\u548c\u6392\u5e8f\uff0c\u7136\u540e\u626b\u63cf\u4e00\u904d\u627e\u6700\u63a5\u8fd1\u7684\u4e00\u5bf9\u5373\u53ef\u3002\n\n\u4e8e\u662f\u95ee\u9898\u53ea\u5269\u4e0b\u4e86\u5982\u4f55\u5feb\u901f\u7ef4\u62a4\u6392\u597d\u5e8f\u7684\u4e24\u7c7b\u533a\u95f4\uff0c\u7531\u4e8e\u533a\u95f4\u7684\u503c\u5e76\u4e0d\u4f1a\u53d8\uff0c\u6240\u4ee5\u611f\u89c9\u4e0a\u53ef\u4ee5\u7528\u94fe\u8868\u6765\u7ef4\u62a4\u3002\u6bcf\u6b21 $x$ \u5411\u540e\u632a\u52a8\u4e00\u6b21\uff0c\u6709\u4e00\u4e9b\u533a\u95f4\u4f1a\u4ece\u7b2c\u4e8c\u7c7b\u53d8\u6210\u7b2c\u4e00\u7c7b\u533a\u95f4\uff0c\u6709\u4e00\u4e9b\u4f1a\u4ece\u7b2c\u4e00\u7c7b\u53d8\u6210\u7b2c\u4e8c\u7c7b\uff0c\u5bb9\u6613\u53d1\u73b0\u6bcf\u4e2a\u533a\u95f4\u53ea\u4f1a\u53d8\u5316 $O(1)$ \u6b21\uff0c\u968f\u4fbf\u7ef4\u62a4\u4e00\u4e0b\u5373\u53ef\u3002\u4e8e\u662f\u603b\u7684\u590d\u6742\u5ea6\u662f $O(N^3)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n//#define feyn\n#define int long long\nusing namespace std;\nconst int N=510;\nconst int inf=3e18;\ninline void read(int &wh){\n    wh=0;int f=1;char w=getchar();\n    while(w<'0'||w>'9'){if(w=='-')f=-1;w=getchar();}\n    while(w<='9'&&w>='0'){wh=wh*10+w-'0';w=getchar();}\n    wh*=f;return;\n}\n\nint m,a[N],s[N],n,id[N][N];\nstruct node{int l,r,data;}c[N*N];\ninline bool operator <(node s1,node s2){\n\treturn s1.data<s2.data;\n}\n\nstruct T{\n\tint nxt[N*N],pre[N*N];\n\tvoid build(bool type){\n\t\tif(type){\n\t\t\tfor(int i=1;i<=n;i++)pre[i]=i-1,nxt[i]=i+1;\n\t\t\tpre[n+1]=n;nxt[0]=1;\n\t\t}\n\t\telse nxt[0]=n+1;\n\t}\n\tinline void link(int x,int y,int z){nxt[x]=y;nxt[y]=z;pre[y]=x;pre[z]=y;}\n\tinline void unlink(int x,int y,int z){nxt[x]=z;pre[z]=x;}\n\tvoid print(){\n\t\tint x=0;\n\t\twhile(x<=n){\n\t\t\tprintf(\"%lld \",x);\n\t\t\tx=nxt[x];\n\t\t}\n\t}\n}A,B;\nset<int>sa,sb;\n\nsigned main(){\n\t\n\t#ifdef feyn\n\tfreopen(\"in.txt\",\"r\",stdin);\n\t#endif\n\t\n\tread(m);\n\tfor(int i=1;i<=m;i++){\n\t\tread(a[i]);s[i]=s[i-1]+a[i];\n\t}\n\tfor(int i=1;i<=m;i++){\n\t\tfor(int j=0;j<i;j++){\n\t\t\tc[++n]=(node){j+1,i,s[i]-s[j]};\n\t\t}\n\t}\n\tsort(c+1,c+n+1);\n\tfor(int i=1;i<=n;i++)sa.insert(i);\n\tsa.insert(0);sa.insert(n+1);\n\tsb.insert(0);sb.insert(n+1);\n\t\n\tc[n+1].data=inf;c[0].data=-inf;\n\tfor(int i=1;i<=n;i++)id[c[i].l][c[i].r]=i;\n\tA.build(true);\n\tB.build(false);\n\tfor(int x=1;x<=m;x++){\n\t\tfor(int i=1;i<x;i++){\n\t\t\tint now=id[i][x-1];\n\t\t\t\n\t\t\tauto R=sa.lower_bound(now);\n\t\t\tauto L=prev(R);\n\t\t\tsa.insert(now);\n\t\t\tA.link(*L,now,*R);\n\t\t\t\n\t\t\tR=sb.upper_bound(now);\n\t\t\tL=prev(prev(R));\n\t\t\tsb.erase(now);\n\t\t\tB.unlink(*L,now,*R);\n\t\t}\n\t\tfor(int i=x;i<=m;i++){\n\t\t\tint now=id[x][i];\n\t\t\t\n\t\t\tauto R=sb.lower_bound(now);\n\t\t\tauto L=prev(R);\n\t\t\tsb.insert(now);\n\t\t\tB.link(*L,now,*R);\n\t\t\t\n\t\t\tR=sa.upper_bound(now);\n\t\t\tL=prev(prev(R));\n\t\t\tsa.erase(now);\n\t\t\tA.unlink(*L,now,*R);\n\t\t}\n\t\t\n\t\tint ans=inf;\n\t\tfor(int p=B.nxt[0],q=0;p<=n;p=B.nxt[p]){\n\t\t\twhile(c[q].data<c[p].data)q=A.nxt[q];\n\t\t\tans=min(ans,c[q].data-c[p].data);\n\t\t\tans=min(ans,c[p].data-c[A.pre[q]].data);\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\t\n\treturn 0;\n}\n```",
        "postTime": 1678185977,
        "uid": 302383,
        "name": "Feyn",
        "ccfLevel": 0,
        "title": "P9127"
    },
    {
        "content": "\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e2a $O(N^2 \\log N)$ \u7684\u89e3\u6cd5\u3002  \n\n\u5148\u8003\u8651\u4e00\u4e2a\u66b4\u529b\u7684\u601d\u8def\u3002  \n\n\u5bf9\u4e8e\u4f4d\u7f6e $i$ \u7684\u4fee\u6539\uff0c\u6240\u6709\u5305\u542b $i$ \u4f4d\u7f6e\u7684\u5b50\u533a\u95f4\u90fd\u4f1a\u53d8\uff0c\u6240\u4ee5\u6700\u540e\u4e00\u5b9a\u662f\u4e00\u4e2a\u5305\u542b $i$ \u7684\u5b50\u533a\u95f4\u548c\u4e00\u4e2a\u4e0d\u5305\u542b $i$ \u7684\u5b50\u533a\u95f4\u76f8\u7b49\u3002  \n\u6211\u4eec\u628a\u6bcf\u4e2a\u5b50\u533a\u95f4\u7684\u548c\u90fd\u653e\u5230\u4e00\u4e2a `set` \u91cc\u9762\u3002  \n\u67e5\u8be2\u4e00\u4e2a\u70b9\u7684\u7b54\u6848\uff0c\u5c31\u628a\u8fd9\u4e2a\u70b9\u6240\u5728\u7684\u5b50\u533a\u95f4\u4ece `set` \u91cc\u9762 `erase()` \u6389\uff0c\u7136\u540e\u679a\u4e3e\u8fd9\u4e2a\u70b9\u6240\u5728\u7684\u5b50\u533a\u95f4\uff0c\u5728 `set` \u91cc\u9762\u67e5\u627e\u524d\u9a71\u540e\u7ee7\uff0c\u9009\u5dee\u503c\u7684\u6700\u5c0f\u503c\u4f5c\u4e3a\u7b54\u6848\u3002  \n\u6bcf\u4e2a\u70b9\u6240\u5728\u7684\u5b50\u533a\u95f4\u662f $O(N^2)$ \u7ea7\u522b\u7684\uff0c\u6240\u4ee5\u603b\u590d\u6742\u5ea6 $O(N^3 \\log N)$\u3002  \n\n\u6709\u70b9\u5dee\uff0c\u63a5\u7740\u4f18\u5316\u3002  \n\n\u6211\u4eec\u6309\u7167\u76f8\u7b49\u7684\u5b50\u533a\u95f4\u7684\u4f4d\u7f6e\u5173\u7cfb\u8fdb\u884c\u5206\u7c7b\u3002  \n\u9996\u5148\u8003\u8651\u6709\u4ea4\u800c\u4e0d\u5305\u542b\u7684\u60c5\u51b5\u3002  \n\u5982\u679c\u4fee\u6539\u4e4b\u540e $[a, b]$ \u548c $[c, d]$ \u7684\u548c\u76f8\u7b49\uff0c\u5e76\u4e14 $[a, b], [c, d]$ \u6709\u4ea4\uff08\u8bbe $a \\le c \\le b \\le d$ \uff09\uff0c\u90a3\u4e48\u6211\u4eec\u628a\u4e2d\u95f4\u7684\u4ea4\u96c6\u53bb\u6389\uff0c\u5269\u4e0b\u7684\u4e24\u90e8\u5206\u4f9d\u7136\u76f8\u7b49\uff08\u5373 $[a, c)$ \u548c $(b, d]$ \uff09\u3002  \n\u56e0\u6b64\uff0c\u6240\u6709\u6709\u4ea4\u800c\u4e0d\u5305\u542b\u7684\u60c5\u51b5\u90fd\u53ef\u4ee5\u5f52\u7eb3\u5230\u65e0\u4ea4\u7684\u60c5\u51b5\u3002  \n\n\u63a5\u4e0b\u6765\u8003\u8651\u5305\u542b\u7684\u60c5\u51b5\u3002  \n\u5982\u679c $[a, b]$ \u548c $[c, d]$ \u7684\u548c\u76f8\u7b49\uff0c\u4e14 $a \\le c \\le d \\le b$\uff0c\u5219\u6211\u4eec\u53d1\u73b0 $[a, c), (b, d]$ \u7684\u548c\u4e92\u4e3a\u76f8\u53cd\u6570\u3002  \n\u540c\u6837\u53ef\u4ee5\u5f52\u7eb3\u5230\u65e0\u4ea4\u7684\u60c5\u51b5\u3002  \n\n\u5269\u4e0b\u7684\u5c31\u662f\u4e00\u4e9b\u7279\u6b8a\u60c5\u51b5\uff0c\u6bd4\u5982\u5c06\u4e00\u4e2a\u6570\u4fee\u6539\u4e3a $0$\uff0c\u6216\u8005\u5c06\u4e00\u4e2a\u5b50\u533a\u95f4\u4fee\u6539\u4e3a $0$\u3002  \n\u7279\u5224\u4e00\u4e0b\u5373\u53ef\u3002  \n\n\u56e0\u6b64\u76f4\u63a5\u8fdb\u884c\u7c7b\u4f3c\u4e8e\u626b\u63cf\u7ebf\u7684\u64cd\u4f5c\u3002  \n\u987a\u5e8f\u679a\u4e3e\u7aef\u70b9 $i$\uff0c\u5c06 $i$ \u4e4b\u524d\u7684\u4e0d\u5305\u542b $i$ \u7684\u5b50\u533a\u95f4\u5168\u90fd\u6254\u5230\u4e00\u4e2a `set` \u91cc\u9762\uff0c\u7136\u540e\u679a\u4e3e\u7aef\u70b9 $j$\uff0c\u5728 `set` \u91cc\u9762\u67e5\u8be2 $[i, j]$ \u7684\u524d\u9a71\u540e\u7ee7\uff0c\u5e76\u5c06\u7b54\u6848\u66f4\u65b0\u5230 $[i, j]$ \u7684\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u4e0a\u3002  \n\u6b63\u53cd\u5404\u8dd1\u4e00\u904d\u5373\u53ef\u3002  \n\u53ef\u4ee5\u5012\u7740\u679a\u4e3e $j$ \u76f4\u63a5\u66f4\u65b0\u7b54\u6848\uff0c\u7136\u540e\u672c\u849f\u84bb\u8111\u62bd\u4e86\uff0c\u8dd1\u4e86\u4e00\u4e2a\u7ebf\u6bb5\u6811 ~~\uff08\u4e0d\u8fc7\u81f3\u5c11\u4e0d\u5f71\u54cd\u590d\u6742\u5ea6\uff09~~\u3002  \n\n\u6bcf\u4e2a\u533a\u95f4\u53ea\u4f1a\u8fdb\u5165 `set` \u4e00\u6b21\uff0c`lower_bound()` \u4e00\u6b21\uff0c\u6240\u4ee5\u603b\u590d\u6742\u5ea6\u662f $O(N^2 \\log N)$\u3002  \n\n\u8d34\u4e00\u4e2a\u5927\u5e38\u6570\u7684\u8d5b\u65f6\u4ee3\u7801~  \n\n```cpp\n//..........\n//wa da shi, ba ka\n#include <set>\n#include <stdio.h>\n#include <algorithm>\nusing namespace std;\n#define sz 505\ntypedef long long ll;\nconst ll inf = 1e18;\nint n;\nll num[sz], ans[sz << 1 | 1];\nset<ll> st;\nll read();\nvoid renew(ll, int, int);\nvoid rew(ll, ll, int, int);\nvoid build(int, int, int);\nvoid fix(int, int, int, int, int, ll);\nvoid dfs(int, int, int, ll);\nint main()\n{\n\tll y;\n\tn = read(); build(0, 1, n);\n\tfor (int i = 1; i <= n; ++i)\n\t\tnum[i] = read();\n\tfor (int i = 1; i <= n; ++i)\n\t\tans[i] = inf;\n\tfor (int i = 1; i <= n; ++i)\n\t\tfix(0, 1, n, i, i, abs(num[i]));\n\tif (n != 2)\n\t{\n\t\tfor (int i = 1; i <= n; ++i)\n\t\t\tst.insert(num[i]);\n\t\tfor (int i = 1; i <= n; ++i)\n\t\t\trenew(-num[i], i, i);\n\t\tst.clear();\n\t}\n\tst.insert(num[1]);\n\tll c = num[1];\n\tfor (int i = 2; i <= n; ++i)\n\t{\n\t\ty = 0LL;\n\t\tfor (int j = i; j <= n; ++j)\n\t\t{\n\t\t\ty += num[j];\n\t\t\trenew(y, i, j);\n\t\t\tfix(0, 1, n, i, j, abs(y));\n\t\t\tif (j == n)\n\t\t\t\trew(-y, c, i, j);\n\t\t\telse\n\t\t\t\trenew(-y, i, j);\n\t\t}\n\t\ty = 0LL;\n\t\tfor (int j = i; j; --j)\n\t\t{\n\t\t\ty += num[j];\n\t\t\tst.insert(y);\n\t\t}\n\t\tc += num[i];\n\t}\n\tst.clear();\n\tst.insert(num[n]);\n\tc = num[n];\n\tfor (int i = n - 1; i; --i)\n\t{\n\t\ty = 0LL;\n\t\tfor (int j = i; j; --j)\n\t\t{\n\t\t\ty += num[j];\n\t\t\trenew(y, j, i);\n\t\t\tfix(0, 1, n, j, i, abs(y));\n\t\t\tif (j == 1)\n\t\t\t\trew(-y, c, j, i);\n\t\t\telse\n\t\t\t\trenew(-y, j, i);\n\t\t}\n\t\ty = 0LL;\n\t\tfor (int j = i; j <= n; ++j)\n\t\t{\n\t\t\ty += num[j];\n\t\t\tst.insert(y);\n\t\t}\n\t\tc += num[i];\n\t}\n\tdfs(0, 1, n, inf);\n\treturn 0;\n}\n\nll read()\n{\n\tll x = 0LL;\n\tchar c = getchar(), f = 0;\n\twhile (c < '0')\n\t{\n\t\tf = (c == '-');\n\t\tc = getchar();\n\t}\n\tdo {\n\t\tx = x * 10LL + (c & 15);\n\t\tc = getchar();\n\t}while (c >= '0');\n\treturn f ? -x : x;\n}\n\nvoid renew(ll a, int lf, int rt)\n{\n\tauto x = st.lower_bound(a);\n\tif (x != st.end())\n\t{\n\t\tfix(0, 1, n, lf, rt, abs(a - *x));\n\t}\n\tif (x != st.begin())\n\t{\n\t\t--x;\n\t\tfix(0, 1, n, lf, rt, abs(a - *x));\n\t}\n}\n\nvoid rew(ll a, ll b, int lf, int rt)\n{\n\tauto x = st.lower_bound(a);\n\tif (x != st.end())\n\t{\n\t\tif (*x == b)\n\t\t{\n\t\t\t++x;\n\t\t\tif (x != st.end())\n\t\t\t\tfix(0, 1, n, lf, rt, abs(a - *x));\n\t\t\t--x;\n\t\t}else\n\t\t\tfix(0, 1, n, lf, rt, abs(a - *x));\n\t}\n\tif (x != st.begin())\n\t{\n\t\t--x;\n\t\tif (*x == b)\n\t\t{\n\t\t\tif (x != st.begin())\n\t\t\t{\n\t\t\t\t--x;\n\t\t\t\tfix(0, 1, n, lf, rt, abs(a - *x));\n\t\t\t}\n\t\t}else\n\t\t\tfix(0, 1, n, lf, rt, abs(a - *x));\n\t}\n}\n\nvoid build(int a, int lf, int rt)\n{\n\tans[a] = inf;\n\tif (lf == rt)\n\t\treturn;\n\tint mid = lf + rt >> 1;\n\tbuild(mid << 1, lf, mid);\n\tbuild(mid << 1 | 1, mid + 1, rt);\n}\n\nvoid fix(int a, int lf, int rt, int wa, int wb, ll b)\n{\n\tif (ans[a] <= b)\n\t\treturn;\n\tif (lf == wa && rt == wb)\n\t{\n\t\tans[a] = b;\n\t\treturn;\n\t}\n\tint mid = lf + rt >> 1;\n\tif (wb <= mid)\n\t\tfix(mid << 1, lf, mid, wa, wb, b);\n\telse if (wa > mid)\n\t\tfix(mid << 1 | 1, mid + 1, rt, wa, wb, b);\n\telse\n\t{\n\t\tfix(mid << 1, lf, mid, wa, mid, b);\n\t\tfix(mid << 1 | 1, mid + 1, rt, mid + 1, wb, b);\n\t}\n}\n\nvoid dfs(int a, int lf, int rt, ll b)\n{\n\tb = min(b, ans[a]);\n\tif (lf == rt)\n\t{\n\t\tprintf (\"%lld\\n\", b);\n\t\treturn;\n\t}\n\tint mid = lf + rt >> 1;\n\tdfs(mid << 1, lf, mid, b);\n\tdfs(mid << 1 | 1, mid + 1, rt, b);\n}\n\n```\n",
        "postTime": 1677714834,
        "uid": 663405,
        "name": "H_Kaguya",
        "ccfLevel": 0,
        "title": "USACO2023FEB G T1 \u9898\u89e3"
    },
    {
        "content": "## Solution\n\n\u770b\u4e86\u773c Luogu \u9898\u89e3\u533a\uff0c\u5927\u591a\u662f $\\Theta(n^3)$ \u7684\u505a\u6cd5\uff0c\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4e2a $\\Theta(n^2\\log{n^2})$ \u7684\u505a\u6cd5\u3002\n\n- \u7ed3\u8bba\uff1a\u5bf9\u4e8e\u4e24\u4e2a\u8fde\u7eed\u5b50\u5e8f\u5217 $a_{l_1\\cdots r_1}$ \u548c $a_{l_2\\cdots r_2}$ \u5982\u679c\u8981\u901a\u8fc7\u6539\u53d8 $a_k$ \u53ef\u4ee5\u4f7f\u4e24\u8005\u548c\u76f8\u7b49\uff0c\u90a3\u4e48\u5f53\u4e14\u4ec5\u5f53 $[k\\in[l_1,r_1]]\\neq [k\\in[l_2,r_2]]$\u3002\n- \u8bc1\u660e\uff1a\u5c06\u4e24\u8005\u4f5c\u5dee\u5f97 $d=(\\sum\\limits_{i=l_1}^{r_1} a_i)-(\\sum\\limits_{i=l_2}^{r_2} a_i)$\u3002\u7136\u540e\u5206\u7c7b\u8ba8\u8bba\uff1a\n- \u5f53 $k\\notin[l_1,r_1]$ \u4e14 $k\\notin[l_2,r_2]$\uff0c$a_k$ \u7684\u6539\u53d8\u5e76\u4e0d\u5f71\u54cd $d$ \u7684\u6539\u53d8\u3002\n- \u5f53 $k\\in[l_1,r_1]$ \u4e14 $k\\notin[l_2,r_2]$\uff0c\u4ee4 $a_k\\gets a_k-d$ \u5373\u53ef\u3002\n- \u5f53 $k\\notin[l_1,r_2]$ \u4e14 $k\\in[l_2,r_2]$\uff0c\u4ee4 $a_k\\gets a_k+d$ \u5373\u53ef\u3002\n- \u5f53 $k\\in[l_1,r_2]$ \u4e14 $k\\in[l_2,r_2]$\uff0c$a_k$ \u7684\u6539\u53d8\u4f7f\u51cf\u53f7\u4e24\u8fb9\u540c\u65f6\u4ea7\u751f\u4e86\u4e00\u4e2a\u76f8\u7b49\u504f\u79fb\u91cf\uff0c\u6240\u4ee5 $d$ \u4e0d\u53d8\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e\u6bcf\u4e2a $i$ \u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5f00\u4e24\u4e2a\u6570\u7ec4\uff0c\u4e00\u4e2a\u5b58\u542b $i$ \u7684\u533a\u95f4\u7684\u503c\uff0c\u4e00\u4e2a\u5b58\u4e0d\u542b $i$ \u7684\u533a\u95f4\u7684\u503c\uff0c\u90a3\u4e48\u4e24\u4e2a\u6570\u7ec4\u6700\u5c0f\u7684\u4e24\u4e2a\u5143\u7d20\u4e4b\u5dee\u7684\u7edd\u5bf9\u503c\u5373\u4e3a\u6240\u6c42\u3002\u8fd9\u6837\u76f4\u63a5\u66b4\u529b\u53bb\u505a\u3001\u7edf\u8ba1\u590d\u6742\u5ea6\u5e94\u4e3a $\\Theta(n\\times n^2\\times n^4)$\uff0c\u975e\u5e38\u4e4b\u5927\u3002\u8003\u8651\u4f18\u5316\uff1a\n\n- \u5bb9\u6613\u53d1\u73b0\u4ece\u8282\u70b9 $i$ \u5230\u8282\u70b9 $i+1$ \u7684\u8fc7\u7a0b\u4e2d\uff0c\u6240\u5305\u542b\u6216\u4e0d\u5305\u542b\u4ed6\u4eec\u7684\u533a\u95f4\u662f\u6709\u4e00\u90e8\u5206\u91cd\u5408\u7684\uff1b\u5177\u4f53\u800c\u8a00\uff0c\u662f $\\{[l,i]\\mid 1\\le l\\le i\\}$ \u548c $\\{[i+1,r]\\mid i+1\\le r\\le n\\}$\u3002\u5219\u6211\u4eec\u53ef\u4ee5\u5f00\u4e24\u4e2a\u96c6\u5408\uff0c\u4e00\u4e2a\u4fdd\u5b58\u5305\u542b $i$ \u7684\u533a\u95f4\uff0c\u4e00\u4e2a\u4fdd\u5b58\u4e0d\u5305\u542b\u7684\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6bcf\u4e00\u6b21\u8f6c\u79fb\u7684\u8fc7\u7a0b\u4e2d\u53ea\u9700\u5728\u539f\u6709\u7684\u4fdd\u5b58\u5305\u542b\u548c\u4e0d\u5305\u542b\u7684\u533a\u95f4\u7684\u96c6\u5408\u4e2d\u52a0\u51cf\u5373\u53ef\u3002\u8fd9\u6837\u590d\u6742\u5ea6\u4e5f\u5c31\u4f18\u5316\u5230\u4e86 $\\Theta(n\\times n\\times n^4)$\u3002\n- \u53ef\u4ee5\u53d1\u73b0\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3b\u8981\u82b1\u8d39\u5728\u4e86\u540e\u9762 $\\Theta(n^4)$ \u7684\u8ba1\u7b97\u6700\u5c0f\u503c\u5f53\u4e2d\u3002\u6211\u4eec\u5148\u8003\u8651\u8fd9\u4e48\u4e00\u4e2a\u95ee\u9898\uff1a\u5c06\u4e24\u4e2a\u96c6\u5408\u53d8\u6210\u540c\u4e00\u4e2a\u96c6\u5408\uff0c\u6c42\u8be5\u96c6\u5408\u4e24\u4e24\u5143\u7d20\u4e4b\u95f4\u7684\u6700\u5c0f\u7684\u5dee\uff1f\n- \u5bb9\u6613\u53d1\u73b0\uff0c\u5f53\u6211\u4eec\u5c06\u6240\u6709\u5143\u7d20\u6309\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u540e\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8ba1\u7b97\u4e24\u4e24\u76f8\u90bb\u5143\u7d20\u4e4b\u5dee\u5373\u53ef\uff0c\u6b63\u786e\u6027\u663e\u7136\u3002\u7136\u540e\u6211\u4eec\u628a\u4ed6\u52a0\u4e0a\u4e00\u4e2a\u5728\u7ebf\u4fee\u6539\u3001\u67e5\u8be2\u64cd\u4f5c\uff0c\u4e5f\u5c31\u662f CF1418D\uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u3002\n- \u56de\u5230\u539f\u9898\u76ee\uff0c\u548c CF1418D \u7684\u5dee\u8ddd\u4e5f\u5c31\u662f\u8981\u533a\u5206\u4e24\u4e2a\u96c6\u5408\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u518d\u52a0\u4e0a\u4e00\u4e2a\u53c2\u6570\u8868\u793a\u5c5e\u4e8e\u54ea\u4e2a\u96c6\u5408\u5373\u53ef\uff0c\u4fee\u6539\u5224\u65ad\u4e0e\u4ed6\u76f8\u90bb\u7684\u6570\u662f\u5426\u548c\u5b83\u5c5e\u4e8e\u76f8\u540c\u96c6\u5408\uff0c\u6b63\u786e\u6027\u540c\u6837\u663e\u7136\u3002\u8fd9\u6837\u590d\u6742\u5ea6\u5c31\u662f $\\Theta(n^2\\log{n^2})$\u3002\n\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\u3002\n\n## Code\n\n```cpp\n#include<bits/stdc++.h>\n#define INF 0x3f3f3f3f\n#define INFLL 0x3f3f3f3f3f3f3f3f\n#define int long long\n#define PII pair<int,int>\n#define rep(k,l,r) for(int k=l;k<=r;++k)\n#define per(k,r,l) for(int k=r;k>=l;--k)\n#define cl(f,x) memset(f,x,sizeof(f))\nusing namespace std;\nconst int N=5e2+5;\nmultiset<int> s1;\nmultiset<PII> s2;\nint sum[N],a[N];\nvoid delone(multiset<int>& s,int x) {\n\tauto it=s.find(x); s.erase(*it);\n}\nvoid del(PII x) {\n\tauto it=s2.lower_bound(x);\n\tauto a=++it; --it;\n\tif(a!=s2.end()) {\n\t\tif((*a).second!=(*it).second)\n\t\t\tdelone(s1,(*a).first-(*it).first);\n\t}\n\tif(it!=s2.begin()) {\n\t\tauto b=--it; ++it;\n\t\tif((*b).second!=(*it).second)\n\t\t\tdelone(s1,(*it).first-(*b).first);\n\t\tif(a!=s2.end()) {\n\t\t\tif((*a).second!=(*b).second)\n\t\t\t\ts1.insert((*a).first-(*b).first);\n\t\t}\n\t}\n\ts2.erase(it);\n}\nvoid ins(PII x) {\n\tauto it=s2.lower_bound(x); \n\tif(it!=s2.end()) {\n\t\tif((*it).second!=x.second)\n\t\t\ts1.insert((*it).first-x.first);\n\t}\n\tif(it!=s2.begin()) {\n\t\tauto a=--it; ++it;\n\t\tif((*a).second!=x.second)\n\t\t\ts1.insert(x.first-(*a).first);\n\t\tif(it!=s2.end()) {\n\t\t\tif((*a).second!=(*it).second)\n\t\t\t\tdelone(s1,(*it).first-(*a).first);\n\t\t}\n\t}\n\ts2.insert(x);\n}\nsigned main() {\n\tint n;\n\tscanf(\"%lld\",&n);\n\trep(i,1,n)\n\t\tscanf(\"%lld\",&a[i]),sum[i]=sum[i-1]+a[i];\n\trep(i,1,n) {\n\t\trep(j,i,n)\n\t\t\tins({sum[j]-sum[i-1],0});\n\t}\n\trep(i,1,n) {\n\t\tins({sum[i],1}); del({sum[i],0});\n\t}\n\trep(k,1,n) {\n\t\tprintf(\"%lld\\n\",*s1.begin());\n\t\trep(i,1,k) {\n\t\t\tdel({sum[k]-sum[i-1],1}); ins({sum[k]-sum[i-1],0});\n\t\t}\n\t\trep(i,k+1,n) {\n\t\t\tdel({sum[i]-sum[k],0}); ins({sum[i]-sum[k],1});\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1678965055,
        "uid": 468657,
        "name": "lsj2009",
        "ccfLevel": 6,
        "title": "P9127"
    },
    {
        "content": "[Link](https://www.luogu.com.cn/problem/P9127)\n\n## P9127 [USACO23FEB] Equal Sum Subarrays G\n\n\u7b2c\u4e00\u9053\u8d5b\u65f6 AC \u7684 Gold \u9898\u3002~~\u540c\u5b66\u4eec\uff1aGold \u4e0d\u662f\u5f88\u6c34\u5417~~\n\n### 1. \u9898\u610f\n\n\u7ed9\u4f60\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u5217 $a$\uff0c\u5e76\u4fdd\u8bc1 $a$ \u7684\u6240\u6709\u8fde\u7eed\u5b50\u5e8f\u5217\u7684\u548c\u4e0d\u540c\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a $p(1\\le p\\le n)$\uff0c\u56de\u7b54\u4e0b\u9762\u7684\u95ee\u9898\uff1a\n\n> \u6700\u5c11\u8981\u628a $a_p$ \u53d8\u5316\uff08\u589e\u52a0\u6216\u51cf\u5c11\uff09\u591a\u5c11\uff0c\u624d\u80fd\u8ba9 $a$ \u4e2d\u6709\u4e24\u4e2a\u4e0d\u76f8\u540c\u7684\u5b50\u5e8f\u5217\u7684\u548c\u76f8\u540c\u3002\n\n$n\\le500,a_i\\le10^{15}$\u3002\n\n### 2. \u9898\u89e3\n\n$n\\le500$\uff1f$O(n^3)$\uff1f\u4f46\u662f USACO \u4ece\u4e0d\u5361\u5e38\u554a\u3002\u3002\u3002\n\n---\n\n\u4ee4 $sum_{i,j}$ \u8868\u793a\u539f\u6570\u7ec4\u4e2d\u7b2c $i\\sim j$ \u4e2a\u6570\u7684\u548c\uff0c$ans_p$ \u4e3a $p$ \u7684\u7b54\u6848\u3002\n\n\u9996\u5148\uff0c\u53ef\u4ee5\u53d1\u73b0\u5bf9\u4e8e $i,j(1\\le i\\le j\\le n)$\uff0c\u5982\u679c $i\\le p\\le j$\uff0c\u5219 $sum_{i,j}$ \u4f1a\u88ab\u52a0\u4e0a $ans_p$\uff0c\u5426\u5219\u4e0d\u53d8\u3002\n\n\u53c8\u56e0\u4e3a\u521d\u59cb\u65f6\u6240\u6709\u5b50\u5e8f\u5217\u548c\u4e0d\u540c\uff0c\u6240\u4ee5\u5728\u64cd\u4f5c\u540e\u76f8\u7b49\u7684\u5b50\u5e8f\u5217\u80af\u5b9a\u4e00\u4e2a\u53d8\u4e86\uff0c\u53e6\u4e00\u4e2a\u6ca1\u53d8\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a\u4f1a\u53d8\u7684\u548c\u4e0e\u4e0d\u4f1a\u53d8\u7684\u548c\u6392\u5e8f\uff0c\u53d6\u4ed6\u4eec\u4e4b\u95f4\u5dee\u7684\u7edd\u5bf9\u503c\u6700\u5c0f\u7684\u5373\u53ef\u3002\n\n\u76f4\u63a5\u53cc\u6307\u9488\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u8c8c\u4f3c\u662f $O(n^3)$\uff1f\n\n```cpp\nconst int N=505;\nint n;\nll a[N],sum[N];\nll s[N*N],t[N*N],cnt1,cnt2;\nvoid Solve()\n{\n\tcin>>n;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tcin>>a[i];\n\t\tsum[i]=sum[i-1]+a[i];\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tcnt1=cnt2=0;\n\t\tfor(int j=1;j<i;j++)\n\t\t\tfor(int k=j;k<i;k++)\n\t\t\t\ts[++cnt1]=sum[k]-sum[j-1];\n\t\tfor(int j=i+1;j<=n;j++)\n\t\t\tfor(int k=j;k<=n;k++)\n\t\t\t\ts[++cnt1]=sum[k]-sum[j-1];\n\t\tfor(int j=1;j<=i;j++)\n\t\t\tfor(int k=i;k<=n;k++)\n\t\t\t\tt[++cnt2]=sum[k]-sum[j-1];\n\t\tsort(s+1,s+cnt1+1);\n\t\tsort(t+1,t+cnt2+1);\n\t\tt[cnt2+1]=LLONG_MAX;\n\t\tll ans=LLONG_MAX;\n\t\tfor(int j=1,k=1;j<=cnt1;j++)\n\t\t{\n\t\t\twhile(k<cnt2&&t[k+1]<=s[j])k++;\n\t\t\tans=min(ans,min(abs(t[k+1]-s[j]),abs(t[k]-s[j])));\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}\n```\n\n\u7136\u540e\u4f60\u53d1\u73b0 TLE \u4e86\u3002\n\n\u4e00\u770b\uff0c`sort(s+1,s+cnt1+1);` \u662f\u7ed9 $O(n^2)$ \u4e2a\u6570\u6392\u5e8f\u3002\n\n\u6240\u4ee5\u590d\u6742\u5ea6\u5b9e\u9645\u4e0a\u662f $O(n^3\\log(n^2))$\uff01\n\n\u6240\u4ee5\u89c9\u5f97\u6b63\u89e3\u5c31\u662f\u628a\u90a3\u4e2a $\\log$ \u53bb\u6389\u3002\n\n\u6700\u540e\u60f3\u51fa\u4e86\u4e00\u79cd\u65b9\u6cd5\uff1a\u5148\u79bb\u6563\u5316\uff0c\u8fd9\u6837\u5c31\u80fd\u6876\u6392\u5e8f\u4e86\u3002\u4e8e\u662f\u53ea\u7528\u6392\u4e00\u6b21\u5e8f\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u53d8\u6210\u4e86 $O(n^3)$\u3002\n\n\u7136\u540e\u53c8\u8c03\u4e86\u534a\u5929\uff0c\u7ec8\u4e8e AC \u4e86\u3002\n\n\u6700\u540e\u8d34\u4e2a\u4ee3\u7801\u5427\uff1a\n\n```cpp\nconst int N=505;\nint n;\nll a[N],sum[N];\nint rnk[N][N],ps[N*N],pt[N*N];\n#define dat pair<ll,pair<int,int> >\nvector<dat>v;\n#define mp make_pair\n#define F first\n#define S second\nbool cs[N*N],ct[N*N];\nvoid Solve()\n{\n\tcin>>n;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tcin>>a[i];\n\t\tsum[i]=sum[i-1]+a[i];\n\t}\n\tv.push_back(mp(LLONG_MIN,mp(0,0)));\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=i;j<=n;j++)\n\t\t{\n//\t\t\tcout<<i<<\" \"<<j<<\" \"<<sum[i]-sum[j-1]<<endl;\n\t\t\tv.push_back(mp(sum[j]-sum[i-1],mp(i,j)));\n\t\t}\n\tint len=v.size()-1;\n\tsort(v.begin(),v.end());\n\tfor(int i=1;i<=len;i++)rnk[v[i].S.F][v[i].S.S]=i;\n//\tfor(int i=1;i<=len;i++)cout<<v[i].S.F<<\" \"<<v[i].S.S<<\" \"<<v[i].F<<endl;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=len;j++)cs[j]=ct[j]=0;//\u6ca1\u5199\u4e3b\u51fd\u6570\uff0c\u522bct[j]\u554a\n\t\tfor(int j=1;j<i;j++)\n\t\t\tfor(int k=j;k<i;k++)\n\t\t\t\tcs[rnk[j][k]]=1;\n\t\tfor(int j=i+1;j<=n;j++)\n\t\t\tfor(int k=j;k<=n;k++)\n\t\t\t\tcs[rnk[j][k]]=1;\n\t\tfor(int j=1;j<=i;j++)\n\t\t\tfor(int k=i;k<=n;k++)\n\t\t\t\tct[rnk[j][k]]=1;\n\t\tint cnt1=0,cnt2=0;\n\t\tfor(int j=1;j<=len;j++)\n\t\t{\n\t\t\tif(cs[j])ps[++cnt1]=j;\n\t\t\tif(ct[j])pt[++cnt2]=j;\n\t\t}\n\t\tll ans=LLONG_MAX;\n\t\tfor(int j=1,k=1;j<=cnt1;j++)\n\t\t{\n\t\t\twhile(k+1<cnt2&&v[pt[k+1]].F<v[ps[j]].F)k++;\n\t\t\tans=min(ans,min(abs(v[pt[k+1]].F-v[ps[j]].F),abs(v[pt[k]].F-v[ps[j]].F)));\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}\n```",
        "postTime": 1678248723,
        "uid": 549499,
        "name": "Donotplaygame",
        "ccfLevel": 5,
        "title": "P9127 \u9898\u89e3"
    },
    {
        "content": "# [Equal Sum Subarrays G](https://www.luogu.com.cn/problem/P9127) \u9898\u89e3\n## \u9898\u76ee\u5927\u610f\n\u7ed9\u5b9a\u4e00\u4e2a\u5e8f\u5217 $A=(a_1,a_2,\\dots,a_n)$\uff0c\u6ee1\u8db3\u5b50\u6bb5\u548c\u4e24\u4e24\u4e0d\u76f8\u540c\u3002\u6709 $n$ \u4e2a\u95ee\u8be2\uff0c\u7b2c $i$ \u4e2a\u95ee\u8be2\u8981\u6c42\u6c42\u6700\u5c0f\u7684 $d$\uff0c\u4f7f\u5f97\u5c06 $a_i$ \u52a0 $d$ \u6216\u51cf $d$\uff0c\u5e8f\u5217 $A$ \u4e2d\u6709\u5b50\u6bb5\u548c\u76f8\u540c\u7684\u4e24\u4e2a\u4e0d\u540c\u5b50\u6bb5\uff1f\n## Solution\n\u611f\u89c9\u4e0d\u9700\u8981\u4ec0\u4e48\u90e8\u5206\u5206\u554a\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u5bf9\u4e8e**\u4efb\u610f\u4e24\u4e2a\u4e0d\u76f8\u540c\u5b50\u6bb5**\uff0c\u4f8b\u5982 $[l_1,r_1]$ \u548c $[l_2,r_2]$\uff0c\u6211\u4eec\u7528 $s_1$ \u548c $s_2$ \u8868\u793a\u8fd9\u4e24\u4e2a\u5b50\u6bb5\u7684\u603b\u548c\u3002\u5e76\u4e14\u6211\u4eec\u8ba4\u4e3a\u4e24\u4e2a\u533a\u95f4\u5e76\u96c6\u4e3a $S$\uff0c\u4ea4\u96c6\u4e3a $T$\u3002\n\n\u8fd9\u6837\u7684\u8bdd\uff0c\u6211\u4eec\u53d1\u73b0\uff1a\n\n\u5bf9\u4e8e\u6240\u6709\u6ee1\u8db3 $i \\in \\complement_{S}T$ \u7684 $i$\uff0c$a_i$ \u53ef\u4ee5\u901a\u8fc7 $\\pm \\lvert s_1-s_2\\rvert$ \u5f97\u5230\u76f8\u7b49\u7684\u4e24\u4e2a\u5b50\u6bb5\uff1a$s_1=s_2$\uff0c\u6ee1\u8db3\u6761\u4ef6\u3002\u6ce8\u610f\u5bf9\u4e8e\u6ee1\u8db3 $i\\in T$ \u7684 $i$ \u662f\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684\uff0c\u56e0\u4e3a\u5b83\u7684\u52a0\u51cf\u4f1a\u4f7f $s_1,s_2$ \u540c\u65f6\u53d8\u5316\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5f97\u51fa\u7b97\u6cd5\uff1a\n+ \u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u4efb\u610f\u4e24\u4e2a\u5b50\u6bb5\u3002\n+ \u66f4\u65b0\u7b54\u6848\u3002\u8bbe\u5b50\u6bb5\u7f16\u53f7 $a,b$\uff0c\u6267\u884c `tag(a,b)`\u3002\n\n\u5982\u4f55\u66f4\u65b0\u7b54\u6848\uff08\u6211\u628a\u5b83\u5c01\u88c5\u5728 `tag(a,b)` \u91cc\uff09\uff1a\n+ \u6211\u4eec\u7528\u4e00\u4e2a\u6570\u7ec4\uff0c\u6807\u8bb0 $C_k$ \u8868\u793a $k$ \u53f7\u88ab\u8986\u76d6\u4e86\u51e0\u6b21\u3002\u5bf9\u4e8e $C_k$ \u4e3a $1$ \u7684\u70b9\uff0c\u6211\u4eec\u7528 $s_a-s_b$ \u66f4\u65b0 $k$ \u53f7\u70b9\u7684\u7b54\u6848\u3002\n+ $s_i$ \u8868\u793a\u7b2c $i$ \u4e2a\u5b50\u6bb5\u7684\u5b50\u6bb5\u548c\u3002\n+ \u8bb0\u5f97\u6e05\u7a7a\u6570\u7ec4\u3002\n\n\u4f46\u662f\u590d\u6742\u5ea6 $O(n^5)$\uff0c\u65e0\u6cd5\u63a5\u53d7\u3002\n\n\u6ce8\u610f\u5230\u6211\u4eec\u53ef\u4ee5\u628a\u5b50\u6bb5\u548c\u6309\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\uff0c\u8fd9\u6837\u53ea\u9700\u8981\u8003\u8651\u76f8\u90bb\u7684\u5b50\u6bb5\u5373\u53ef\u3002\u8bc1\u660e\u663e\u7136\uff0c\u5176\u4ed6\u90fd\u662f\u4e0d\u5fc5\u8981\u66f4\u65b0\u3002\n\n\u8fd9\u6837\u7b97\u6cd5\u53d8\u6210\u8fd9\u6837\uff1a\n+ \u6211\u4eec\u63d0\u53d6\u6240\u6709\u5b50\u6bb5\u548c\uff0c\u653e\u5728\u6570\u7ec4\u91cc\u5e76\u6392\u5e8f\u3002\n+ \u5bf9\u4e8e\u76f8\u90bb\u5b50\u6bb5 $i,i+1$\uff0c\u6267\u884c `tag(i,i+1)`\u3002\n\n\u8fd9\u6837\u8fd9\u9898\u5c31\u505a\u5b8c\u5566\uff1f\u662f\u7684\u3002\u590d\u6742\u5ea6\uff1a$O(N^2\\log N^2+N^3)$,\u524d\u9762\u662f\u6392\u5e8f\u540e\u9762\u662f\u66f4\u65b0\u7b54\u6848\u3002\n\n## \u8d5b\u573a\u4ee3\u7801\n\u8d5b\u65f6\u8111\u6b8b\u8dd1\u4e86 `tag(i-1,i)` \u548c `tag(i,i+1)`\uff0c\u4ec5\u505a\u53c2\u8003\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define ld long double\n#define ull unsigned long long\n#define rep(i,l,r) for(register ll i=(l);i<=(r);++i)\n#define Rep(i,l,r) for(register ll i=(r);i>=(l);--i)\n#define repD(i,u,E) for(register ll i=hd[u];i;i=E[i].nxt)\n#define all(x) x.begin(),x.end()\nusing namespace std;\nvoid upd_s(ll&x,ll v){x=min(x,v);}\nvoid upd_b(ll&x,ll v){x=max(x,v);}\nconst ll N=509,INF=8e18;\nll n,a[N],ans[N],sum[N];\nstruct Node{\n\tll l,r,x;\n\tbool operator<(const Node&a)const{\n\t\treturn x<a.x;\n\t}\n}xx[N*N];\nvector<ll> ADD[N],RMV[N];\nbool bj[N];\nvoid tag(ll a,ll b,ll v){\n\tmemset(bj,0,sizeof(bj));\n\tll l=xx[a].l,r=xx[a].r;\n\trep(i,l,r)bj[i]^=1;\n\tl=xx[b].l,r=xx[b].r;\n\trep(j,l,r)bj[j]^=1;\n\trep(i,1,n)if(bj[i])ans[i]=min(ans[i],v);\n}\nint main(){\n\tcin>>n;\n\trep(i,1,n)cin>>a[i],sum[i]=sum[i-1]+a[i];\n\tll cnt=0;\n\trep(i,1,n)rep(j,i,n){\n\t\tll x=sum[j]-sum[i-1];\n\t\txx[++cnt]=(Node){i,j,x};\n\t}\n\tsort(xx+1,xx+1+cnt);\n\tfill(ans,ans+1+n,INF);\n\trep(i,1,cnt){\n\t\tll nw=INF,id=0;\n\t\tif(i!=1){\n\t\t\tll cost=xx[i].x-xx[i-1].x;\n\t\t\ttag(i-1,i,cost);\n\t\t}\n\t\tif(i!=cnt){\n\t\t\tll cost=xx[i+1].x-xx[i].x;\n\t\t\ttag(i,i+1,cost);\n\t\t}\n\t}\n\trep(i,1,n)cout<<ans[i]<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1677744198,
        "uid": 555345,
        "name": "xionglangqi",
        "ccfLevel": 0,
        "title": "USACO2023FEB Equal Sum Subarrays G\u9898\u89e3"
    },
    {
        "content": "# \u9898\u610f\uff1a\n\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $ n $ \u7684\u5e8f\u5217\uff0c\u4fdd\u8bc1\u4efb\u610f\u4e24\u4e2a\u8fde\u7eed\u5b50\u5e8f\u5217\u7684\u5143\u7d20\u548c\u4e0d\u76f8\u7b49\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5143\u7d20\uff0c\u4f60\u9700\u8981\u56de\u7b54\u8fd9\u4e2a\u95ee\u9898\uff1a\u5982\u679c\u53ea\u4fee\u6539\u8fd9\u4e2a\u5143\u7d20\uff0c\u4f7f\u5f97\u5b58\u5728\u4e24\u4e2a\u8fde\u7eed\u5b50\u5e8f\u5217\u7684\u5143\u7d20\u548c\u76f8\u7b49\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5143\u7d20\u7684\u6539\u53d8\u91cf\u6700\u5c11\u662f\u591a\u5c11\uff1f\n\n# \u601d\u8def\uff1a\n\n\u5bf9\u4e8e\u4e00\u4e2a\u5143\u7d20\uff0c\u8981\u4fee\u6539\u5b83\u7684\u503c\uff0c\u4f7f\u5f97\u5b58\u5728\u4e24\u4e2a\u8fde\u7eed\u5b50\u5e8f\u5217\u7684\u5143\u7d20\u548c\u76f8\u7b49\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u8981\u4f7f\u5f97\u67d0\u4e2a\u5305\u542b\u5b83\u7684\u5b50\u5e8f\u5217\u7684\u5143\u7d20\u548c\u7b49\u4e8e\u67d0\u4e2a\u4e0d\u5305\u542b\u5b83\u7684\u5b50\u5e8f\u5217\u7684\u5143\u7d20\u548c\u3002\u539f\u56e0\u5f88\u663e\u7136\uff1a\u5982\u679c\u4e24\u4e2a\u5b50\u5e8f\u5217\u90fd\u4e0d\u5305\u542b\u8fd9\u4e2a\u5143\u7d20\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5143\u7d20\u7684\u4fee\u6539\u548c\u4e24\u4e2a\u5b50\u5e8f\u5217\u90fd\u6ca1\u6709\u5173\u7cfb\u3002\u5982\u679c\u4e24\u4e2a\u5b50\u5e8f\u5217\u90fd\u5305\u542b\u8fd9\u4e2a\u5143\u7d20\uff0c\u90a3\u4e48\u4e0d\u7ba1\u8fd9\u4e2a\u5143\u7d20\u600e\u4e48\u4fee\u6539\uff0c\u4e24\u4e2a\u5b50\u5e8f\u5217\u7684\u5143\u7d20\u548c\u4e4b\u5dee\u90fd\u4e0d\u4f1a\u6539\u53d8\uff0c\u4e00\u5f00\u59cb\u4e0d\u76f8\u7b49\uff0c\u6539\u4e86\u4ee5\u540e\u4e5f\u4e0d\u4f1a\u76f8\u7b49\u3002\u56e0\u6b64\uff0c\u6ee1\u8db3\u6761\u4ef6\u7684\u53ea\u6709\u4e00\u4e2a\u5305\u542b\u3001\u4e00\u4e2a\u4e0d\u5305\u542b\u3002\n\n\u6211\u4eec\u4e00\u5f00\u59cb\u5148\u628a\u6240\u6709\u8fde\u7eed\u5b50\u5e8f\u5217\u6309\u7167\u5143\u7d20\u548c\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u3002\u63a5\u4e0b\u6765\u679a\u4e3e $ i $\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5305\u542b $ i $ \u7684\u5b50\u5e8f\u5217\uff0c\u6c42\u51fa\u5143\u7d20\u548c\u5c0f\u4e8e\u5b83\u5e76\u4e14\u4e0d\u5305\u542b $ i $ \u7684\u5b50\u5e8f\u5217\u4e2d\uff0c\u5143\u7d20\u548c\u6700\u5927\u662f\u591a\u5c11\uff0c\u4ee5\u53ca\u5143\u7d20\u548c\u5927\u4e8e\u5b83\u5e76\u4e14\u4e0d\u5305\u542b $ i $ \u7684\u5b50\u5e8f\u5217\u4e2d\uff0c\u5143\u7d20\u548c\u6700\u5c0f\u662f\u591a\u5c11\u3002\u7528\u6253\u64c2\u6cd5\u5373\u53ef\u6c42\u51fa\u7b54\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $ O(n ^ 3) $\n\n# \u6838\u5fc3\u4ee3\u7801\uff1a\n\n```cpp\nconst int N = 505;\nlong long n, a[N], s[N], ans[N], lft[N * N], rgh[N * N];\npair < long long, pair < int, int > > b[N * N];\n\nint main()\n{\n\tread(n);\n\tfor (int i = 1; i <= n; ++i)\n\t\tread(a[i]), s[i] = s[i - 1] + a[i];\n\tint len = 0;\n\tfor (int i = 1; i <= n; ++i)\n\t\tfor (int j = i; j <= n; ++j)\n\t\t\tb[++len] = make_pair(s[j] - s[i - 1], make_pair(i, j));\n\tsort(b + 1, b + len + 1);\n\tmemset(ans, 0x3f, sizeof(ans));\n\tfor (int i = 1; i <= n; ++i)\n\t{\n\t\tlft[1] = 0;\n\t\tfor (int j = 2; j <= len; ++j)\n\t\t\tif (b[j].second.first <= i && b[j].second.second >= i)\n\t\t\t{\n\t\t\t\tif (b[j - 1].second.first <= i && b[j - 1].second.second >= i) lft[j] = lft[j - 1];\n\t\t\t\telse lft[j] = j - 1;\n\t\t\t}\n\t\t\telse lft[j] = 0;\n\t\trgh[len] = 0;\n\t\tfor (int j = len - 1; j; --j)\n\t\t\tif (b[j].second.first <= i && b[j].second.second >= i)\n\t\t\t{\n\t\t\t\tif (b[j + 1].second.first <= i && b[j + 1].second.second >= i) rgh[j] = rgh[j + 1];\n\t\t\t\telse rgh[j] = j + 1;\n\t\t\t}\n\t\t\telse rgh[j] = 0;\n\t\tfor (int j = 1; j <= len; ++j)\n\t\t{\n\t\t\tif (lft[j]) ans[i] = min(ans[i], llabs(b[j].first - b[lft[j]].first));\n\t\t\tif (rgh[j]) ans[i] = min(ans[i], llabs(b[j].first - b[rgh[j]].first));\n\t\t}\n\t}\n\tfor (int i = 1; i <= n; ++i)\n\t\twriteln(ans[i]);\n\treturn 0;\n}\n```",
        "postTime": 1677467557,
        "uid": 187034,
        "name": "hanjinghao",
        "ccfLevel": 7,
        "title": "USACO2023FEB G T1 \u9898\u89e3"
    }
]
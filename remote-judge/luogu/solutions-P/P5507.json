[
    {
        "content": "## \u524d\u8a00\n\n[\u9898\u76ee\u4f20\u9001\u95e8\uff01](https://www.luogu.com.cn/problem/P5507)\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\uff1f](https://liangbowen.blog.luogu.org/solution-p5507)\n\n\u7206\u641c\u9898\u3002\u5927\u5bb6\u90fd\u4e0d\u7528 Astar \u7b97\u6cd5\uff0c\u90a3\u6211\u6765\u8865\u7bc7\u9898\u89e3\u3002\n\n## \u601d\u8def\n\n\u6bcf\u4e2a\u6309\u94ae\u90fd\u6709\u72b6\u6001\uff0c\u56e0\u6b64\u8003\u8651\u72b6\u538b\u7206\u641c\u3002\n\n\u6bcf\u4e00\u4e2a\u6309\u94ae\u90fd\u6709 $1, 2, 3, 4$ \u51e0\u79cd\u72b6\u6001\u3002\u56e0\u6b64\u53ef\u4ee5\u8f6c\u5316\u4e3a $0, 1, 2, 3$ \u56db\u79cd\u72b6\u6001\uff0c\u7136\u540e\u4e24\u4f4d\u4e00\u72b6\u538b\u3002\n\n\u63a5\u4e0b\u6765\u5c31\u662f A \u661f\u3002\u4f30\u503c\u51fd\u6570 $h(x)$ \u53ef\u4ee5\u8bbe\u8ba1\u4e3a\uff1a\u6bcf\u4e2a\u6309\u94ae\u5206\u522b\u65cb\u8f6c\u5230 $1$ \u7684\u503c\u3002\u7531\u4e8e\u4e00\u6b21\u64cd\u4f5c\u4f1a\u7275\u52a8\u4e24\u4e2a\u6309\u94ae\uff0c\u56e0\u6b64\u8981\u9664\u4ee5\u4e8c\u3002\n\n```cpp\n//\u4e3a\u4e86\u65b9\u4fbf\u72b6\u538b\uff0c\u6570\u7ec4\u3001\u6309\u94ae\u7f16\u53f7\uff0c\u4e0b\u6807\u90fd\u4ece1\u5f00\u59cb\nstruct node\n{\n\tint st; //\u72b6\u6001 \n\tdouble f;\n\tnode(int zltqwq)\n\t{\n\t\tdb h = 0;\n\t\tst = zltqwq;   //\u4e0b\u9762 &3 \u53ef\u4ee5\u7b80\u5355\u7406\u89e3\u4e3a mod 4\n\t\tfor (int i = 0; i < 12; i++) h += (4 - ((st >> (i * 2)) & 3)) & 3; \n\t\th /= 2;\n\t\tf = g[st] + h;\t\n\t}\n\tfriend bool operator <(node y, node x) {return x.f < y.f;}\n};\npriority_queue <node> q;\n```\n\n\u5b9a\u4e49\u597d\u540e\uff0c\u8f93\u5165\u65f6\u8bb0\u5f55\u4e00\u4e0b\u521d\u59cb\u72b6\u6001\u3002\u7136\u540e\u5f00\u59cb\u7206\u641c\u3002\n\n```cpp\nint IAKIOI; //\u60f3\u4e0d\u5230\u597d\u7684\u540d\u5b57\u4e86\u3002\u53cd\u6b63\u662f\u521d\u59cb\u72b6\u6001\nvoid input()\n{\n\tfor (int i = 0; i < 12; i++)\n\t{   //\u4e0b\u6807\u7edf\u4e00\u51cf\u4e00\n\t\tint a = read() - 1; IAKIOI |= (a << (i * 2));\n\t\tfor (int j = 0; j < 4; j++) nxt[i][j] = read() - 1; \n\t}\t\n}\n```\n\n\u6bcf\u6b21\u679a\u4e3e\u6bcf\u4e00\u4e2a\u72b6\u6001\u4e0b\uff0c\u5bf9\u5e94\u7684\u6bcf\u4e00\u4e2a\u6309\u94ae\u7684\u72b6\u6001\u3002\u540c\u65f6\u8bb0\u5f55\u6bcf\u4e00\u4e2a\u6309\u94ae\u53d7\u7275\u52a8\u7684\u6309\u94ae\u7f16\u53f7\u53ca\u5176\u5bf9\u5e94\u72b6\u6001\u3002\n\n\u7136\u540e\u901a\u8fc7\u5f02\u6216\u6027\u8d28\uff08$x \\oplus x = 0$\uff09\u5c06\u4e0b\u4e00\u4e2a\u72b6\u6001\u6c42\u51fa\u3002\u8fd9\u4e00\u90e8\u5206\u5176\u5b9e\u5f88\u5bb9\u6613\uff0c\u53ea\u662f\u4ee3\u7801\u5b9e\u73b0\u770b\u8d77\u6765\u6bd4\u8f83\u7f62\u4e86\u3002\n\n\u8fd9\u4e2a\u72b6\u6001\u6ca1\u6709\u8bbf\u95ee\u8fc7\u5c31\u66f4\u65b0\u3002\u7531\u4e8e\u6700\u540e\u8981\u8f93\u51fa\u65b9\u6848\uff0c\u6240\u4ee5\u8bb0\u5f55\u4e00\u4e0b\u72b6\u6001\u662f\u7531\u54ea\u4e00\u4e2a\u72b6\u6001\uff0c\u65cb\u8f6c\u4ec0\u4e48\u6309\u94ae\u5f97\u5230\u7684\u3002\n\n```cpp\nint IAKIOI; //\u521d\u59cb\u72b6\u6001 \nvoid Astar()\n{\n    priority_queue <node> q;\n    q.push(node(IAKIOI)), vis[IAKIOI] = true;\n    while (!q.empty())\n    {\n        int st = q.top().st;\n        //printf(\"st = %d\\n\", st);\n        q.pop();\n        if (st == 0) break; //\u7b49\u540c\u4e8e\u5168\u662f1\n        for (int i = 0; i < 12; i++)\n        {\n        \t//\u5206\u522b\u8868\u793ai\u7684\u72b6\u6001\uff0c\u53d7\u7275\u8fde\u7684\u6309\u94ae\u7f16\u53f7\uff0c\u53d7\u7275\u8fde\u7684\u6309\u94ae\u7684\u72b6\u6001\n            int sti = (st >> (i * 2)) & 3, di = nxt[i][sti], stdi = (st >> (di * 2)) & 3; \n            //\u5176\u5b9e\u5c31\u662f\u5c06\u7b2ci\u4e2a\u6309\u94ae\u66ff\u6362\u6210\u4e0b\u4e00\u4e2a\u72b6\u6001\u3002\u5f53\u524d\u72b6\u6001\u4e3a sti\uff0c\u4e0b\u4e00\u4e2a\u72b6\u6001\u663e\u7136\u662f (sti + 1) % 4\n         \tint dst = st ^ (sti << (i * 2)) ^ (((sti + 1) & 3) << (i * 2));\n         \t//\u540c\u4e0a\uff0c\u5c31\u662f\u5c06\u7b2cdi\u4e2a\u6309\u94ae\u66ff\u6362\u6210\u4e0b\u4e00\u4e2a\u72b6\u6001\u3002\u5f53\u524d\u72b6\u6001\u4e3a stdi\uff0c\u4e0b\u4e00\u4e2a\u72b6\u6001\u663e\u7136\u662f (stdi + 1) % 4\n            dst = dst ^ (stdi << (di * 2)) ^ (((stdi + 1) & 3) << (di * 2));\n            if (!vis[dst]) //\u6ca1\u6709\u5c31\u8fdb\u53bb\n            {\n\t\t\t\t//pre[] \u548c button[] \u5206\u522b\u8868\u793a\uff1a\u4ece\u54ea\u4e2a\u72b6\u6001\u8fc7\u6765\uff1b\u4ece\u90a3\u4e2a\u72b6\u6001\u8fc7\u6765\u662f\u4f7f\u7528\u4ec0\u4e48\u6309\u94ae \n                g[dst] = g[st] + 1, vis[dst] = true;\n                pre[dst] = st, button[dst] = i + 1;\n                q.push(node(dst));\n            }\n        }\n    }\n}\n```\n\n\u7136\u540e\u8f93\u51fa\u5c31\u5b8c\u4e8b\u4e86\u3002\u7528\u9012\u5f52\u7684\u5f62\u5f0f\u5012\u5e8f\u8f93\u51fa\u5373\u53ef\u3002\n\n```cpp\nvoid output(int x)\n{\n\tif (x == IAKIOI) return;\n\toutput(pre[x]), write(button[x]), space;\n}\nint main()\n{\n\tinput();\n\tAstar();\n\twrite(g[0]), endl; //0\u662f\u6700\u7ec8\u72b6\u6001\n\toutput(0);\n\treturn 0;\n}\n```\n\n\u8fd9\u9053\u9898\u5c31\u505a\u5b8c\u5566\uff01\n\n## \u5b8c\u6574\u4ee3\u7801\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <queue>\nusing namespace std;\nint read()\n{\n\tchar op = getchar(); int x = 0, f = 1;\n\twhile (op < 48 || op > 57) {if (op == '-') f = -1; op = getchar();}\n\twhile (48 <= op && op <= 57) x = (x << 1) + (x << 3) + (op ^ 48), op = getchar();\n\treturn x * f;\n}\nconst int k = 1 << 24;\nint nxt[15][10], g[k + 10];\nbool vis[k + 10];\nint pre[k + 10], button[k + 10]; //\u5206\u522b\u8868\u793a\uff1a\u4ece\u54ea\u4e2a\u72b6\u6001\u8fc7\u6765\uff1b\u4ece\u90a3\u4e2a\u72b6\u6001\u8fc7\u6765\u662f\u4f7f\u7528\u4ec0\u4e48\u6309\u94ae \nstruct node\n{\n\tint st; //\u72b6\u6001 \n\tdouble f;\n\tnode(int zltqwq) //\u53d8\u91cf\u8d77 @zltqwq \u662f\u56e0\u4e3a\u60f3\u4e0d\u5230\u597d\u540d\u5b57\u4e86\u3002\u819c\u62dc zlt\n\t{\n\t\tdouble h = 0;\n\t\tst = zltqwq;\n\t\tfor (int i = 0; i < 12; i++) h += (4 - ((st >> (i * 2)) & 3)) & 3;\n\t\th /= 2;\n\t\tf = g[st] + h;\t\n\t}\n\tfriend bool operator <(node y, node x) {return x.f < y.f;}\n};\nint IAKIOI; //\u521d\u59cb\u72b6\u6001 \nvoid Astar()\n{\n\tpriority_queue <node> q;\n\tq.push(node(IAKIOI)), vis[IAKIOI] = true;\n\twhile (!q.empty())\n\t{\n\t\tint st = q.top().st;\n\t\t//printf(\"st = %d\\n\", st);\n\t\tq.pop();\n\t\tif (st == 0) break; //\u7b49\u540c\u4e8e\u5168\u662f1\n\t\tfor (int i = 0; i < 12; i++)\n\t\t{\n\t\t\tint sti = (st >> (i * 2)) & 3, di = nxt[i][sti], stdi = (st >> (di * 2)) & 3;\n\t\t\tint dst = st ^ (sti << (i * 2)) ^ (((sti + 1) & 3) << (i * 2));\n\t\t\tdst = dst ^ (stdi << (di * 2)) ^ (((stdi + 1) & 3) << (di * 2));\n\t\t\tif (!vis[dst])\n\t\t\t{\n\t\t\t\tg[dst] = g[st] + 1, vis[dst] = true;\n\t\t\t\tpre[dst] = st, button[dst] = i + 1;\n\t\t\t\tq.push(node(dst));\n\t\t\t}\n\t\t}\n\t}\n}\nvoid input()\n{\n\tfor (int i = 0; i < 12; i++)\n\t{\n\t\tint a = read() - 1;\n        IAKIOI |= (a << (i * 2));\n\t\tfor (int j = 0; j < 4; j++) nxt[i][j] = read() - 1;\n\t}\t\n}\nvoid output(int x)\n{\n\tif (x == IAKIOI) return;\n\toutput(pre[x]), printf(\"%d \", button[x]);\n}\nint main()\n{\n\tinput();\n\tAstar();\n\tprintf(\"%d\\n\", g[0]); //0\u662f\u6700\u7ec8\u72b6\u6001\n\toutput(0);\n\treturn 0;\n}\n```\n\n\u5e0c\u671b\u80fd\u5e2e\u52a9\u5230\u5927\u5bb6\uff01",
        "postTime": 1661860335,
        "uid": 367488,
        "name": "liangbowen",
        "ccfLevel": 0,
        "title": "P5507 \u9898\u89e3"
    },
    {
        "content": "# \u524d\u8a00\n\u6b64\u9898\u662f\u4e00\u9053\u88f8\u7684\u641c\u7d22\u9898\uff0c\u6b63\u786e\u7684\u505a\u6cd5\u5f88\u591a\uff0c\u542f\u53d1\u5f0f\u641c\u7d22\uff0c\u53cc\u5411\u641c\u7d22\u90fd\u53ef\u4ee5\uff0c\u8fd9\u91cc\u60f3\u4ecb\u7ecd\u4e00\u4e0b\u53cc\u5411\u641c\u7d22\u7684\u505a\u6cd5\n# \u6700\u6700\u5dee\u7684\u65b9\u6cd5\uff08\u6b7b\u66b4\u529b\uff09\n\u4ee3\u7801\u89c120\u5206 $Code$\n\n\u66b4\u529b\u679a\u4e3e\u53d8\u5316\u7684\u65cb\u94ae\u7f16\u53f7\uff0c\u518d\u5224\u65ad\u662f\u5426\u8fbe\u5230\u76ee\u6807\n\n\u65f6\u95f4\uff1a$O(12^{step})$\n\n\u5f53step\u5c0f\u4e8e6\u65f6\u53ef\u4ee5\u901a\u8fc7\n# \u4f18\u5316\n\u53ef\u4ee5\u8003\u8651\u72b6\u6001\u4f18\u5316\uff0c\u5982\u679c\u4e00\u4e2a\u72b6\u6001\u5230\u8fbe\u8fc7\u4e86\u5c31\u4e0d\u7528\u641c\u7d22\u4e86\uff0c\u7531\u4e8e\u72b6\u6001\u6700\u591a\u53ea\u6709\n$4^{12}$=$2^{24}$\uff0c\n\u6240\u4ee5\u53ef\u4ee5\u5927\u5e45\u5ea6\u4f18\u5316\u65f6\u95f4\uff0c\u4e00\u822c\u53ef\u4ee5\u5f97\u523040\u5206\uff0c\u4f46\u5982\u679c\u641c\u7d22\u6280\u672f\u597d\u4e5f\u80fd\u591a\u62ff\u4e00\u70b9\u5206\n\n### \u6ce8\u610f\n\u6b64\u9898\u5185\u5b58\u82b1\u8d39\u8f83\u5927\uff0c\u8bf7\u5c3d\u91cf\u51cf\u5c11\u5f00\u5927\u6570\u7ec4\uff0c\u5c24\u5176\u4e0d\u8981\u968f\u4fbf\u5728\u5b50\u7a0b\u5e8f\u91cc\u5f00\u5927\u6570\u7ec4\n### \u4f46\u6211\u4eec\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff1a\u600e\u4e48\u8868\u793a\u548c\u50a8\u5b58\u72b6\u6001\n\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u91c7\u7528\u56db\u8fdb\u5236\u50a8\u5b58\uff0c\u56e0\u4e3a\u65cb\u94ae\u7684\u72b6\u6001\u53ea\u67094\u79cd\uff0c\u6240\u4ee5\u53ef\u4ee5\u628a\u5341\u4e8c\u4e2a\u65cb\u94ae\u7ec4\u5408\u8d77\u6765\u770b\u505a\u4e00\u4e2a4\u8fdb\u5236\u6570\uff0c\u518d\u628a\u5b83\u8f6c\u5316\u621010\u8fdb\u5236\u518d\u8868\u793a\u548c\u50a8\u5b58\u5c31\u597d\u4e86\uff08\u628a1\u770b\u4f5c0,2\u770b\u4f5c1,3\u770b\u4f5c2,4\u770b\u4f5c1\uff09\n# \u4e3b\u89d2\uff1a\u53cc\u5411\u641c\u7d22\n\u7531\u4e8e\u6211\u4eec\u77e5\u9053\u4e86\u6700\u5f00\u59cb\u7684\u72b6\u6001\u548c\u6700\u540e\u7684\u76ee\u6807\u72b6\u6001\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4ece\u8fd9\u4e24\u4e2a\u72b6\u6001\u5206\u522b\u5f00\u59cb\u641c\u7d22\uff0c\u5f97\u5230\u7684\u641c\u7d22\u6811\u5927\u6982\u662f\u8fd9\u6837\u7684\n![](https://cdn.luogu.com.cn/upload/pic/72817.png)\n\u800c\u4e4b\u524d\u7684\u641c\u7d22\u65b9\u6cd5\u6240\u5f62\u6210\u7684\u641c\u7d22\u6811\u5927\u6982\u662f\u8fd9\u6837\u7684\n![](https://cdn.luogu.com.cn/upload/pic/72819.png)\n......\u8868\u793a\u7701\u7565\u53f7\uff0c\u5f88\u663e\u7136\u53cc\u5411\u641c\u7d22\u7684\u641c\u7d22\u6811\u66f4\u5c0f\n~~\uff08\u867d\u7136\u4f5c\u8005\u7f8e\u672f\u4e0d\u597d\uff0c\u770b\u4e0d\u51fa\u6765\uff09~~\n\n\u6240\u4ee5\u6211\u4eec\u91c7\u7528\u53cc\u5411\u641c\u7d22\uff0c\u53ef\u4ee5\u5927\u5e45\u5ea6\u964d\u4f4e\u65f6\u95f4\uff0c\u5c06\u65f6\u95f4\u964d\u4f4e\u5230\u641c\u7d22\u4e24\u6b219\u6b65\uff08\u7531\u4e8e\u6700\u591a\u7684\u6b65\u6570\u53ea\u670917\u6b65\uff09\uff0c\u6700\u6162\u7684\u70b9\u662f650+$ms$\uff0c\u867d\u7136\u6bd4\u542f\u53d1\u5f0f\u641c\u7d22\u6162\uff0c\u4f46\u4e5f\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u505a\u6cd5\n\n\u5177\u4f53\u7684\u5b9e\u73b0\u8fc7\u7a0b\u4ee5\u53ca\u6ce8\u91ca\u53ef\u4ee5\u89c1\u4ee3\u7801\uff1a$AC$ $Code$\n\n\u5176\u5b9e\u6211\u8fd8\u6709\u4e00\u4e2a\u8111\u62bd\u63d0\u51fa\u6765\u7684\u7684\u95ee\u9898\n### \u641c\u5230\u7684\u7b2c\u4e00\u4e2a\u7b54\u6848\u6b65\u6570\u4e00\u5b9a\u6700\u5c11\u5417\n\u7531\u4e8e\u4f5c\u8005\u592a\u849f\u84bb\u4e86\uff0c\u5728\u505a\u8fd9\u9053\u9898\u4e4b\u524d\u4ece\u6765\u90fd\u6ca1\u6709\u6253\u8fc7\u53cc\u5411\u641c\u7d22\uff0c\u53ea\u662f\u6709\u6240\u8033\u95fb\uff0c\u6240\u4ee5\u505a\u7740\u505a\u7740\u5c31\u8111\u62bd\u63d0\u51fa\u6765\u8fd9\u4e2a\u8111\u62bd\u95ee\u9898\u3002\n\n\u5176\u5b9e\u53ea\u8981\u597d\u597d\u60f3\u4e00\u60f3\uff0c\u5c31\u4f1a\u53d1\u73b0\u53cc\u5411\u641c\u7d22\u7684\u672c\u8d28\u5176\u5b9e\u548c\u5355\u5411\u641c\u7d22\u662f\u4e00\u6837\u7684\uff0c\u7531\u4e8e\u5bbd\u641c\u662f\u4e00\u5c42\u4e00\u5c42\u5bbd\u641c\u7684\uff0c\u6b65\u6570\u4fdd\u8bc1\u662f\u5355\u8c03\u4e0a\u5347\u7684\uff0c\u6240\u4ee5\u641c\u5230\u7684\u63d0\u4e00\u4e2a\u7b54\u6848\u80af\u5b9a\u662f\u6b63\u89e3\u3002\n\n\u4e3e\u4e2a\u6817\u5b50\uff08\u5047\u8bbe\u641c\u7d22\u4e0a\u9650\u662f9\u6b65\uff09\n\n\u5355\u5411\u641c\u7d22:5\u6b65\n\n\u53cd\u5411\u641c\u7d22:6\u6b65 \n\n\u76f8\u9047\u4e86\n\n\u5355\u5411\u641c\u7d22:5\u6b65\n\n\u53cd\u5411\u641c\u7d22:5\u6b65 \n\n\u76f8\u9047\u4e86\n\n\u5982\u679c\u524d\u9762\u7684\u4e00\u79cd\u60c5\u51b5\u5148\u641c\u5230\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u4e0d\u662f\u6700\u4f18\u7684\u4e86\uff0c~~\u4f46\u5176\u5b9e\u4e24\u79cd\u60c5\u51b5\u90fd\u4e0d\u53ef\u80fd\u6700\u60f3\u641c\u5230~~\n\n\u56e0\u4e3a\n\n\u7b2c\u4e00\u79cd\u60c5\u51b5\u5176\u5b9e\u6700\u5148\u641c\u5230\u7684\u662f\u8fd9\u79cd\u60c5\u51b5\uff08\u56e0\u4e3a\u6b63\u5411\u53cd\u5411\u7684\u641c\u7d22\u641c\u51fa\u6765\u7684\u65b9\u6848\u662f\u4e00\u6837\u7684\uff09\n\n\u5355\u5411\u641c\u7d22:9\u6b65\n\n\u53cd\u5411\u641c\u7d22:2\u6b65 \n\n\u76f8\u9047\u4e86\n\n\u7b2c\u4e8c\u79cd\u60c5\u51b5\u5176\u5b9e\u6700\u5148\u641c\u5230\u7684\u662f\u8fd9\u79cd\u60c5\u51b5\u3001\n\n\u5355\u5411\u641c\u7d22:9\u6b65\n\n\u53cd\u5411\u641c\u7d22:1\u6b65 \n\n\u76f8\u9047\u4e86\n\n\u7531\u4e8e\u7b54\u6848\u5355\u8c03\u4e0a\u5347\uff0c\u6240\u4ee5\u7b2c\u4e8c\u79cd\u60c5\u51b5\u5fc5\u7136\u5728\u7b2c\u4e00\u79cd\u60c5\u51b5\u51fa\u73b0\u4e4b\u524d\uff0c\u4fdd\u8bc1\u7b54\u6848\u66f4\u4f18\uff0c\u8bc1\u6bd5\u3002\n\n~~\u4f5c\u8005\u7ec8\u4e8e\u6cbb\u597d\u4e86\u4ed6\u7684\u8111\u62bd~~$QAQ$\n# $Code$\n## 20\u5206 $Code$\n```pascal\nconst n=12;\ntype arr1=array[0..13] of longint;\nvar\n  s,d,c:arr1;\n  a:array[0..30,0..5] of longint;\n  i,t:longint;\nprocedure next(var x:longint);\nbegin\n  inc(x);\n  if x>4 then x:=1;\nend;//\u6c42\u4e0b\u4e00\u4e2a\u72b6\u6001\nprocedure sc(x:longint;b:arr1);\nvar\n  c:arr1;\n  i,j:longint;\nbegin\n  if x>t then//\u6bcf\u4e00\u6b65\u90fd\u679a\u4e3e\u5b8c\u4e86\uff0c\u5224\u65ad\u662f\u5426\u7b26\u5408\u8981\u6c42\n  begin\n    for i:=1 to n do\n    if b[i]<>1 then exit;//\u5982\u679c\u53c8\u4e00\u4e2a\u6ca1\u6709\u53d8\u62101\uff0c\u5c31\u4e0d\u884c\uff0c\u8fd4\u56de\n    writeln(t);\n    for i:=1 to t do\n    write(d[i],' ');\n    halt;//\u8f93\u51fa\u7b54\u6848\uff0c\u7b2c\u4e00\u4e2a\u641c\u5230\u7684\u80af\u5b9a\u662f\u6b63\u89e3\u5e76\u4e14\u6700\u5c0f\u7684\uff0c\u7ed3\u675f\u7a0b\u5e8f\n  end;\n  for i:=1 to n do\n  begin\n    for j:=1 to n do c[j]:=b[j];//copy\u539f\u5e8f\u5217\n    next(c[a[i,c[i]]]);\n    next(c[i]);//\u8fd9\u4e24\u4e2a\u7684\u987a\u5e8f\u4e0d\u80fd\u53d8\uff0c\u5426\u5219\u4f1aWA\n    d[x]:=i;//\u8bb0\u5f55\u65b9\u6848\n    sc(x+1,c);//\u4f20\u9012\u5e8f\u5217\u548c\u5f53\u524d\u6b65\u6570\n  end;\nend;//\u66b4\u529b\u641c\u7d22\nbegin\n  for i:=1 to n do\n  readln(s[i],a[i,1],a[i,2],a[i,3],a[i,4]);\n  for t:=1 to 6 do\n  sc(1,s);//\u66b4\u529b\u679a\u4e3e\u6b65\u6570\nend.\n```\n\n## $AC$ $Code$\n### $Pascal$ $AC$ $Code$\n```pascal\n{\n  \u6570\u7ec4\u8bf4\u660e\n  bfs\u6570\u7ec4\u8868\u793a\u65cb\u94ae\u72b6\u6001\u5bf9\u5e94\u768410\u8fdb\u5236\n  change\u6570\u7ec4\u8868\u793a\u53d8\u5316\u7684\u65cb\u94ae\u7f16\u53f7\n  sum\u6570\u7ec4\u8868\u793a\u662f\u7b2c\u51e0\u6b65\n  getway\u6570\u7ec4\u8868\u793a\u72b6\u6001k\u5728\u961f\u5217\u4e2d\u7684\u7f16\u53f7\n  last\u6570\u7ec4\u8868\u793a\u662f\u4ece\u90a3\u4e00\u4e2a\u72b6\u6001\u8f6c\u79fb\u8fc7\u6765\u7684\uff08\u5728\u961f\u5217\u4e2d\u7684\u6807\u53f7\uff09\n  getway1,bfs1,change1,sum1,last1\u8fd9\u4e9b\u6570\u7ec4\u7684\u4f5c\u7528\u548c\u53bb\u63891\u4e4b\u540e\u7684\u6570\u7ec4\u4f5c\u7528\u662f\u4e00\u6837\u7684\uff0c\u7528\u5728\u53cd\u5411\u641c\u7d22\u4e2d\n}\ntype arr1=array[0..13] of longint;\nconst n=12;//\u5b9a\u4e49\u4e00\u4e2a\u5e38\u91cf\u65b9\u4fbf\u4e00\u70b9\nvar\n  a:array[0..n+1,0..5]  of longint;\n  s,c,b:arr1;\n  bfs,change,sum,getway,last,getway1,bfs1,change1,sum1,last1:array[0..17000000] of longint;\n  //\u5927\u6570\u7ec4\u4e00\u5b9a\u8981\u5f00\u5728\u4e3b\u7a0b\u5e8f\u91cc\n  ans,i,k,l,r,j:longint;\nfunction get:longint;\nvar\n  anss,yu,i:longint;\nbegin\n  yu:=1; anss:=c[1]-1;//\u56e0\u4e3a\u8f93\u5165\u662f1,2,3,4\uff0c\u6240\u4ee5\u8981\u51cf\u4e00\n  for i:=2 to n do\n  begin\n    yu:=yu*4;\n    anss:=anss+yu*(c[i]-1);\n  end;\n  exit(anss);\nend;//\u5bf9\u4e8e\u6307\u5b9a\u7684c\u6570\u7ec44\u8fdb\u5236\u8f6c10\u8fdb\u5236\nprocedure chai(x:longint);\nvar\n  i,t:longint;\nbegin\n  t:=x;\n  for i:=1 to n do\n  begin\n    b[i]:=t mod 4+1;//\u52a01\u4e0e\u4e0a\u540c\u7406\n    t:=t div 4;\n  end;\nend;//\u5c06\u8f6c\u4e3a10\u8fdb\u5236\u7684\u6570\u91cd\u65b0\u62c6\u621012\u4f4d4\u8fdb\u5236\u6570\nprocedure printf(x:longint);\nbegin\n  if x<>1 then printf(last[x])//\u6b63\u5411\u641c\u7d22\u7684\u8fc7\u7a0b\u8bb0\u5f55\u662f\u53cd\u7684\u94fe\u8868\uff0c\u8981\u5148\u8f93\u51fa\u518d\u9012\u5f52\n  else exit;\n  write(change[x],' ');\nend;//\u6253\u5370\u6b63\u5411\u641c\u7d22\u7684\u8fc7\u7a0b\nprocedure printf1(x:longint);\nbegin\n  if x=1 then exit;//1\u7684\u60c5\u51b5\u5c31\u76f4\u63a5\u8fd4\u56de\uff0c\u5426\u5219\u5c31\u70b8\u4e86\n  write(change1[x],' ');//\u53cd\u5411\u641c\u7d22\u7684\u8fc7\u7a0b\u8bb0\u5f55\u662f\u6b63\u7684\u94fe\u8868\uff0c\u8981\u5148\u8f93\u51fa\u518d\u9012\u5f52\n  printf1(last1[x]);\nend;//\u6253\u5370\u53cd\u5411\u641c\u7d22\u7684\u8fc7\u7a0b\nprocedure next(var k:longint);\n//\u76f8\u5f53\u4e8ec++\u4e2d&\u4e86\u4e00\u4e0b\uff0c\u662f\u4e00\u4e2a\u53d8\u53c2\uff0c\u5728lass\u8fc7\u7a0b\u4e2d\u540c\u7406\nbegin\n  inc(k);\n  if k>4 then k:=1;\nend;//\u6c42\u65cb\u94ae\u72b6\u6001\u7684\u540e\u7ee7\nprocedure lass(var k:longint);\nbegin\n  dec(k);\n  if k<1 then k:=4;\nend;//\u6c42\u65cb\u94ae\u72b6\u6001\u7684\u524d\u7ee7\nbegin\n  for i:=1 to n do readln(c[i],a[i,1],a[i,2],a[i,3],a[i,4]);//\u8bfb\u5165\n  ans:=0;\n  k:=get;//\u50a8\u5b58\u6700\u5f00\u59cb\u7684\u72b6\u6001\n  getway[k]:=1;//\u6807\u8bb0\u8be5\u72b6\u6001\u51fa\u73b0\u5728bfs\u961f\u5217\u7684\u54ea\u4e2a\u4e0b\u6807\u4e2d\n  l:=1; r:=1; bfs[1]:=k;//bfs\u521d\u59cb\u5316,bfs\u6570\u7ec4\u4e2d\u50a8\u5b58\u7684\u662f\u8f6c\u5316\u5b8c\u768410\u8fdb\u5236\u6570\n  while l<=r do\n  begin\n    if (sum[l]=9) then break;//\u5230\u7b2c9\u6b65\u4e86\u5c31\u9000\u51fa\n    chai(bfs[l]);//\u5c0610\u8fdb\u5236\u7684\u6570\u91cd\u65b0\u62c6\u621012\u4f4d4\u8fdb\u5236\u6570\n    for j:=1 to 12 do\n      c[j]:=b[j];//\u653e\u5230c\u6570\u7ec4\u91cc\uff0c\u65b9\u4fbf\u540e\u9762\u64cd\u4f5c\n    for i:=1 to 12 do\n    begin\n      next(c[a[i,c[i]]]);//\u5148\u5904\u7406\u81ea\u5df1\u5f15\u8d77\u7684\u65cb\u8f6c\n      next(c[i]);//\u518d\u5904\u7406\u81ea\u5df1\u7684\u65cb\u8f6c\n      //\u6ce8\u610f\u987a\u5e8f\u4e0d\u80fd\u6362\n      k:=get;\n      if (getway[k]=0) and (sum[l]<9) then/\n      /\u5982\u679c\u6ca1\u6709\u5230\u8fbe\u8fc7(\u7528\u6765\u53bb\u91cd\uff0c\u4fdd\u5b58\u6700\u5148\u641c\u5230\u7684\u6700\u4f18\u89e3)\u5e76\u4e14\u6ca1\u6709\u5230\u6b65\u6570\u4e0a\u9650\n      begin\n        inc(r);//\u5c3e\u6307\u9488\u52a01\n        bfs[r]:=k;\n        change[r]:=i;\n        sum[r]:=sum[l]+1;\n        last[r]:=l;\n        getway[k]:=r;//\u65b0\u7684\u72b6\u6001\u5165\u961f\n      end;\n      if getway[ans]<>0 then\n      //ans\u5c31\u662f\u6240\u8c13\u7684\u76ee\u6807\u72b6\u6001\uff0c\u5c31\u662f\u5168\u662f1\uff0c\u5bf9\u5e94\u572810\u8fdb\u5236\u4e2d\u8868\u793a\u5c31\u662f0\uff0c\u6240\u4ee5\u628aans\u6362\u62100\u4e5f\u662f\u53ef\u4ee5\u7684\n      begin\n       writeln(sum[getway[ans]]);//\u8f93\u51fa\u6700\u5c11\u7684\u6b65\u6570\n       printf(getway[ans]);//\u6253\u5370\u65b9\u6848\n       halt;\n      end;\n      lass(c[i]);//\u9000\u56de\u5230\u521d\u59cb\u72b6\u6001\uff0c\u987a\u5e8f\u4e5f\u4e0d\u80fd\u52a8\n      lass(c[a[i,c[i]]]);\n    end;\n    inc(l);\n  end;\n  //\u4ee5\u4e0b\u4ee3\u7801\u5176\u5b9e\u548c\u4e0a\u9762\u540c\u7406\uff0c\u53ea\u662f\u6362\u4e86\u4e00\u4e0b\u521d\u59cb\u72b6\u6001\uff0c\u76f8\u4f3c\u7684\u5185\u5bb9\u5c31\u4e0d\u6ce8\u91ca\u4e86\n  l:=1; r:=1; bfs1[1]:=0;\n  while l<=r do\n  begin\n    if (sum1[l]=9) then break;\n    chai(bfs1[l]);\n    for j:=1 to 12 do\n      c[j]:=b[j];\n    for i:=1 to 12 do\n    begin\n      lass(c[i]);\n      lass(c[a[i,c[i]]]);//\u6ce8\u610f\u662f\u53cd\u5411\u641c\u7d22\uff0c\u6240\u4ee5\u4f7f\u7528\u524d\u7ee7\n      k:=get;\n      if (getway1[k]=0) and (sum1[l]<9) then\n      begin\n        inc(r);\n        bfs1[r]:=k;\n        change1[r]:=i;\n        sum1[r]:=sum1[l]+1;\n        last1[r]:=l;\n        getway1[k]:=r;\n        if (getway[k]<>0) then//\u5982\u679c\u548c\u6b63\u5411\u641c\u7d22\u641c\u5230\u4e86\u76f8\u540c\u7684\u7ed3\u679c\uff0c\u8bf4\u660e\u627e\u5230\u4e86\u65b9\u6848\n        begin\n          writeln(sum[getway[k]]+sum1[getway1[k]]);//\u6b65\u6570\u662f\u4e24\u4e2a\u65b9\u5411\u641c\u7d22\u7684\u6b65\u6570\u603b\u548c\n          printf(getway[k]);//\u6253\u5370\u6b63\u5411\u641c\u7d22\u7684\u8fc7\u7a0b\n          printf1(getway1[k]);//\u6253\u5370\u53cd\u5411\u641c\u7d22\u7684\u8fc7\u7a0b\n          halt;\n        end;\n      end;\n      next(c[a[i,c[i]]]);\n      next(c[i]);\n    end;\n    inc(l);\n  end;\nend.\n```\n### $C++$ $AC$ $Code$\n\u4f5c\u8005\u662f\u4e00\u4e2a\u6b63\u5728\u8f6c$C++$\u7684$P$\u515a\uff0c\u5c31\u4e0d\u732e\u4e11\u4e86\n~~\uff08\u5176\u5b9e\u662f\u61d2\u5f97\u6253\uff09~~\n\uff0c\u6211\u4f1a\u5728$Pascal$\u7684$AC$ $Code$\u7684\u91cc\u628a\u6ce8\u91ca\u5199\u7684\u5c3d\u53ef\u80fd\u8be6\u7ec6\uff0c\u65b9\u4fbf\u5927\u5bb6\u7406\u89e3\uff0c\u529b\u4e89\u8ba9$C/C++$\u515a\u90fd\u770b\u61c2\n~~\uff08\u5176\u5b9e\u5e94\u8be5\u4e0d\u5199\u6ce8\u91ca\u4e5f\u80fd\u770b\u61c2\u5427\uff09~~\n\n\u5982\u679c\u4e00\u5b9a\u60f3\u8981\u770b$C++$\u7684$AC$ $Code$\uff0c\u8bf7\u5230\u540e\u8bb0\u4e2d\u7814\u7a76\u4e00\u4e0b[\u6211\u7684\u5929\u7a7a](https://www.luogu.org/space/show?uid=94712)\u8fd9\u4f4d\u5de8\u4f6c\u7684\u4ee3\u7801\n\n\u6700\u540e\u63d0\u4f9b\u4e00\u4e0b$Check$\uff0c\u65b9\u4fbf\u8c03\u8bd5\n## $Check$\n$Check$\u8bf4\u660e\uff1a\n\u8bfb\u5165\u673a\u5173\u7684\u72b6\u6001\u540e\u518d\u8bfb\u5165\u53d8\u5316\u6b65\u6570\u548c\u4f9d\u6b21\u65cb\u8f6c\u7684\u65cb\u94ae\u7f16\u53f7\uff0c\u6700\u540e\u4f1a\u8f93\u51fa\u5404\u4e2a\u673a\u5173\u7684\u72b6\u6001\n\n\u6709\u4e86\u8bf4\u660e\u5c31\u4e0d\u5728\u4ee3\u7801\u91cc\u5199\u6ce8\u91ca\u4e86\uff0c\u76f8\u4fe1\u90fd\u80fd\u770b\u61c2\u7684\n### \u793a\u4f8b\u3000\n$Input$\n```\n3 3 7 2 6\n3 1 4 5 3\n3 1 2 6 4\n3 1 10 3 5\n3 2 8 3 6\n3 7 9 2 1\n1 1 2 3 4\n1 3 11 10 12\n1 8 6 7 4\n1 9 9 8 8\n1 12 10 12 12\n1 7 8 9 10\n6\n1 2 3 4 5 6\n```\n$Output$\n```\n1 1 1 1 1 1 1 1 1 1 1 1\n```\n\n### $Pascal$ $Check$\n```pascal\nconst n=12;\nvar\n  i,x,step:longint;\n  s:array[0..13] of longint;\n  a:array[0..13,0..10] of longint;\nprocedure next(var k:longint);\nbegin\n  inc(k);\n  if k>4 then k:=1;\nend;\nbegin\n  for i:=1 to n do readln(s[i],a[i,1],a[i,2],a[i,3],a[i,4]);\n  readln(step);\n  for i:=1 to step do\n  begin\n    read(x);\n    next(s[a[x,s[x]]]);\n    next(s[x]);\n  end;\n  for i:=1 to n do write(s[i],' ');\n  writeln;\nend.\n\n```\n### $C++$ $Check$\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int n=12;\nint i,x,step,s[10],a[13][10];\nvoid nxt(int &k)\n{\n\tk++;\n\tif (k>4) k=1;\n}\nint main()\n{\n\tfor (i=1;i<=n;i++) \n\tcin>>s[i]>>a[i][1]>>a[i][2]>>a[i][3]>>a[i][4];\n\tcin>>step;\n\tfor (i=1;i<=step;i++)\n\t{\n\t\tcin>>x;\n\t\tnxt(s[a[x][s[x]]]);\n\t\tnxt(s[x]);\n\t}\n\tfor (i=1;i<=n;i++) cout<<s[i]<<' ';\n\tcout<<endl;\n}\n```\n\n# \u603b\u7ed3\n\u8fd9\u9053\u9898\u6bd4\u8f83\u7ecf\u5178\uff0c\u5bf9\u641c\u7d22\u7684\u4f18\u5316\u8003\u5bdf\u6bd4\u8f83\u4e30\u5bcc\uff08\u5305\u62ec\u72b6\u6001\u8bb0\u5f55\uff0c\u542f\u53d1\u5f0f\u641c\u7d22\u6216\u53cc\u5411\u641c\u7d22\uff09\uff0c\u9700\u8981\u601d\u8def\u548c\u4e00\u5b9a\u7684\u4ee3\u7801\u5b9e\u73b0\u80fd\u529b\uff0c\u9002\u5408\u63d0\u9ad8\u9009\u624b\u7ec3\u7ec3\u624b\u3002\n\n\u601d\u7ef4\u96be\u5ea6\uff1a\u4e2d\n\n\u4ee3\u7801\u96be\u5ea6\uff1a\u4e2d\n# \u540e\u8bb0\n\u7ffb\u4e86\u4e00\u4e0b$AC$\u7684\u63d0\u4ea4\u8bb0\u5f55\uff0c\u53d1\u73b0 [\u6211\u7684\u5929\u7a7a](https://www.luogu.org/space/show?uid=94712) \u5de8\u4f6c\u548c\u6211\u7684\u601d\u8def\u76f8\u8fd1\uff0c\u4f46\u4ed6\u7684\u4ee3\u7801\u8dd1\u5f97\u6bd4\u6211\u5feb\u5f88\u591a\uff0c\u6700\u6162\u7684\u70b9\u4e5f\u53ea\u63a5\u8fd1400$ms$\uff0c\u6709\u5174\u8da3\u7684\u540c\u5b66\u53ef\u4ee5\u7814\u7a76\u4e00\u4e0b\u8fd9\u4f4d[\u5de8\u4f6c\u7684\u4ee3\u7801](https://www.luogu.org/record/22702524)\uff0c\u6216\u8005\u548c\u8fd9\u4f4d\u5de8\u4f6c\u4ea4\u6d41\u3002\n# \u9e23\u8c22\n[ i_m_a_](https://www.luogu.org/space/show?uid=86649)\n\u8fd9\u4f4d\u51fa\u9898\u4eba\u5728\u6211\u9047\u4e0a\u56f0\u96be\u65f6\u65e0\u79c1\u5730\u5e2e\u52a9\u4e86\u6211\uff08\u63d0\u4f9b\u4e86\u4e00\u4e2a\u6570\u636e\uff09\uff0c\u4f7f\u5f97\u6211\u627e\u5230\u4e86\u539f\u6765\u4ee3\u7801\u7684\u95ee\u9898\uff0c\u7279\u6b64\u611f\u8c22",
        "postTime": 1565938734,
        "uid": 136542,
        "name": "chinaxjh",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5507 \u3010\u673a\u5173\u3011"
    },
    {
        "content": "## \u9898\u610f\u7b80\u8ff0\n\n&emsp;&emsp;\u670912\u4e2a\u65cb\u94ae\uff0c\u6bcf\u4e2a\u65cb\u94ae\u5f00\u59cb\u65f6\u5904\u4e8e\u72b6\u6001 $1$ ~ $4$ \uff0c\u6bcf\u6b21\u64cd\u4f5c\u53ef\u4ee5\u5f80\u89c4\u5b9a\u65b9\u5411\u8f6c\u52a8\u4e00\u4e2a\u65cb\u94ae \uff08$1\\Rightarrow2\\Rightarrow3\\Rightarrow4\\Rightarrow1$\uff09 \uff0c\u5e76\u4e14\u4f1a\u89e6\u53d1**\u4e00\u6b21**\u8fde\u9501\u53cd\u5e94\uff1a\u5904\u4e8e\u67d0\u4e2a\u72b6\u6001\u7684\u65cb\u94ae\u5728\u65cb\u8f6c\u65f6\u4f1a\u5f15\u8d77\u53e6\u4e00\u4e2a\u65cb\u94ae\u53d1\u751f\u76f8\u540c\u65b9\u5411\u7684\u8f6c\u52a8\uff08\u53e6\u4e00\u4e2a\u65cb\u94ae\u8f6c\u52a8\u4e0d\u4f1a\u518d\u89e6\u53d1\u8fde\u9501\u53cd\u5e94\uff09\u3002\u95ee\u5c0612\u4e2a\u65cb\u94ae\u90fd\u7f6e\u4e3a $1$ \u81f3\u5c11\u9700\u8981\u51e0\u6b21\u8f6c\u52a8\uff0c\u5e76\u8f93\u51fa\u6bcf\u6b21\u8f6c\u52a8\u7684\u65cb\u94ae\u7f16\u53f7\u3002\n\n## \u5355\u5411BFS\n\n&emsp;&emsp;\u76f4\u63a5\u66b4\u529b\u5730\u8fdb\u884c\u5355\u5411 BFS \uff0c\u6bcf\u6b21\u8f6c\u52a8\u90fd\u6709 $12$ \u79cd\u9009\u62e9\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(12^{step})$ \uff0c\u770b\u6570\u636e\u8303\u56f4\uff0c\u6700\u9ad8\u7684\u6b65\u6570\u53ef\u8fbe $17$ \u6b65\uff0c\u5fc5\u5b9a TLE \u3002\u4f46\u662f\u8fd9\u6837\u7b80\u5355\u5982\u679c\u4f18\u5316\u7684\u6bd4\u8f83\u597d\u53ef\u4ee5\u5f97 $50$ ~ $60$ \u5206\uff08~~\u6ca1\u5438\u6c27\u6c14\uff0c\u5438\u4e86\u6c27\u6c14\u53cd\u800c\u66f4\u4f4e\u4e86~~\uff09\u3002\n\n&emsp;&emsp;[\u5355\u5411BFS\u8bc4\u6d4b\u8bb0\u5f55](https://www.luogu.com.cn/record/36973116)\n\n&emsp;&emsp;\u8d85\u65f6\u7684\u4e3b\u8981\u539f\u56e0\u662f\u641c\u7d22\u6811\u8fc7\u4e8e\u5e9e\u5927\uff0c\u800c\u6211\u4eec\u4f1a\u53d1\u73b0\u672c\u9898**\u8d77\u59cb\u72b6\u6001\u548c\u7ec8\u6b62\u72b6\u6001\u662f\u660e\u786e\u7684**\uff0c\u8fd9\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u795e\u5947\u7684\u53cc\u5411 BFS \u6765\u9650\u5236\u641c\u7d22\u6811\u7684\u751f\u957f\u3002\n\n## \u53cc\u5411BFS\n\n&emsp;&emsp;\u53cc\u5411 BFS \u975e\u5e38\u9002\u5408\u5728\u8d77\u59cb\u72b6\u6001\u548c\u7ec8\u6b62\u72b6\u6001\u660e\u786e\u7684\u6761\u4ef6\u4e0b\u4f7f\u7528\uff0c\u505a\u6cd5\u662f\u4ece\u8d77\u70b9\u548c\u7ec8\u70b9\u540c\u65f6\u8fdb\u884c\u5355\u5411 BFS \uff0c\u8ba9\u4e24\u8fb9 BFS \u641c\u7d22\u6811\u7684\u751f\u957f\u53d7\u5230\u5bf9\u9762\u641c\u7d22\u6811\u7684\u9650\u5236\uff0c\u4e0d\u8981\u8fc7\u4e8e\u91ce\u86ee\u751f\u957f\uff0c\u504f\u79bb\u76ee\u6807\u592a\u8fdc\u3002\u81ea\u5df1\u753b\u4e86\u4e00\u5f20~~\u5f88\u4e11\u5f88\u4e11\u7684~~\u5bf9\u6bd4\u56fe(\u5982\u679c\u56fe\u88c2\u5f00\u4e86\uff0c[\u53ef\u4ee5\u5230\u6211\u535a\u5ba2\u53bb\u770b](https://www.cnblogs.com/ailanxier/p/13501529.html))\uff0c\u5e94\u8be5\u53ef\u4ee5\u4fbf\u4e8e\u7406\u89e3\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7gjlwjuc.png)\n\n&emsp;&emsp;\u53ef\u4ee5\u770b\u5230\u53cc\u5411 BFS \u53ef\u4ee5\u5728**\u67d0\u4e00\u72b6\u6001\u53d1\u73b0\u76f8\u540c\u65f6\u5c31\u505c\u6b62**\u4e86\uff0c\u901a\u8fc7\u56de\u6eaf\u53ef\u4ee5\u627e\u5230\u6cbf\u8def\u9009\u62e9\u7684\u70b9\u3002\u518d\u770b\u770b\u672c\u9898\u7684\u6570\u636e\u8303\u56f4\uff0c\u6700\u5927\u7684\u70b9\u6b63\u5411\u548c\u53cd\u5411 BFS \u6700\u591a\u662f $9$ \u6b65, $12^9$ \u662f $5\\times10^8$ \u7684\u91cf\u7ea7,\u52c9\u5f3a\u53ef\u4ee5\u5728\u4e00\u79d2\u51b2\u8fc7\u53bb\u3002\u4e8b\u5b9e\u4e0a\u6211\u6700\u5927\u7684\u70b9\u7528\u65f6\u5728 $200ms$ ~ $300ms$ \u4e4b\u95f4\uff0c\u8fd8\u662f\u5f88\u7a33\u7684\u3002\n\n&emsp;&emsp;[\u6700\u597d\u7684\u4e00\u6b21\u53cc\u5411BFS\u8bb0\u5f55](https://www.luogu.com.cn/record/36981792)\n\n### \u72b6\u6001\u5b58\u50a8\n\n&emsp;&emsp;\u53ef\u4ee5\u628a\u4e24\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u5f53\u505a\u4e00\u4e2a\u56db\u8fdb\u5236\u4f4d,\u628a\u6bcf\u4e2a\u65cb\u94ae\u72b6\u6001\u51cf\u4e00\u540e\u5c31\u521a\u597d\u53ef\u4ee5\u5b58\u4e0b\u4e86\uff0c\u53731\u5bf9\u5e940,2\u5bf9\u5e941\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\u5148\u8bb2\u4e00\u4e0b\u8bfb\u5165\u5904\u7406\u3002\n```cpp\n    int button,Start = 0;\n    For(i,0,11){\n        button = read();                        //\u8bfb\u5165\u7b2ci+1\u4e2a\u65cb\u94ae\u72b6\u6001\n        Start |= (button - 1) << (i << 1);      //\u8bb0\u5f55\u521d\u59cb\u72b6\u6001\n        For(j,0,3) nxt[i][j] = read()-1;          \n    }\n```\n&emsp;&emsp;\u6211\u4ee3\u7801\u4e2d\u7684\u65cb\u94ae\u7f16\u53f7\u548c\u72b6\u6001\u5168\u90e8\u8fdb\u884c\u4e86\u51cf\u4e00\u5904\u7406\uff08\u540e\u9762\u63cf\u8ff0\u65f6\u6211\u90fd\u4f1a\u8bf4+1\uff09\uff0c\u65b9\u4fbf\u4f4d\u8fd0\u7b97\u64cd\u4f5c\u3002\u6ce8\u610f**\u8bb0\u5f55\u521d\u59cb\u72b6\u6001\u65f6\u8981\u5c06 $i*2$** \uff08\u5373\u5de6\u79fb\u4e00\u4f4d\uff09\uff0c\u56e0\u4e3a\u6211\u4eec\u628a\u4e24\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u5f53\u505a\u4e00\u4e2a\u56db\u8fdb\u5236\u4f4d\u4e86\uff0c\u540e\u9762\u4e5f\u6709\u8fd9\u6837\u7684\u4e582\u5904\u7406\u3002\u518d\u7528\u4e00\u4e2a\u6570\u7ec4 $nxt$ \u8bb0\u5f55\u7b2c $i+1$ \u4e2a\u65cb\u94ae\u5728 $j+1$ \u72b6\u6001\u4e0b\u8fdb\u884c\u65cb\u8f6c\u65f6\uff0c\u4f1a\u5e26\u52a8\u7b2c $nxt[i][j]+1$ \u4e2a\u65cb\u94ae\u8f6c\u52a8\u3002 \n\n### \u72b6\u6001\u8f6c\u79fb\n&emsp;&emsp;\u9996\u5148\u6b63\u5411\u548c\u53cd\u5411\u7684 BFS \u7684\u8f6c\u79fb\u65b9\u5f0f\u662f\u4e0d\u4e00\u6837\u7684\u3002\u8bbe\u5f53\u524d\u8f6c\u5230\u7684\u662f\u7b2c $i+1$ \u4e2a\u65cb\u94ae\uff0c\u5b83\u73b0\u5728\u5904\u4e8e $j+1$ \u72b6\u6001\u3002\n+ \u6b63\u5411\uff1a\u5c06\u7b2c $i+1$ \u4e2a\u65cb\u94ae\u6309\u89c4\u5b9a\u65b9\u5411\u8f6c\u52a8\u4e00\u6b21\uff0c\u540c\u65f6\u5e26\u52a8\u7b2c $nxt[i][j]+1$ \u4e2a\u65cb\u94ae\u8f6c\u52a8\u3002**\u65cb\u8f6c\u540e\u72b6\u6001\u53ef\u4ee5\u7528$(j+1)\\&3$ \u8868\u793a**\uff08\u8fd9\u6837\u53ef\u4ee5\u5b9e\u73b0\u65cb\u94ae\u4f4d\u4e8e4\u72b6\u6001\uff0c\u5373 $j=3$ \u65f6\uff0c\u65cb\u8f6c\u540e\u53d8\u62101 \uff0c\u5373 $j = 0$ \u7684\u64cd\u4f5c\uff09\u3002\n+ \u53cd\u5411\uff1a\u5c06\u7b2c $i+1$ \u4e2a\u65cb\u94ae\u6309\u89c4\u5b9a\u7684\u76f8\u53cd\u65b9\u5411\u8f6c\u52a8\u4e00\u6b21\uff0c\u5982\u679c\u5176\u8f6c\u52a8\u540e\u7684\u72b6\u6001\u4e3a $k+1$ ,\u5219\u5e26\u52a8\u7b2c $nxt[i][k]+1$ \u4e2a\u65cb\u94ae\u4e5f\u4ee5\u76f8\u53cd\u65b9\u5411\u8f6c\u52a8\u3002**\u9006\u5411\u65cb\u8f6c\u540e\u72b6\u6001\u53ef\u4ee5\u7528$(j+3)\\&3$ \u8868\u793a**\u3002\n\n&emsp;&emsp;\u6211\u4eec\u628a\u6b63\u5411\u65b9\u5411\u5b9a\u4e49\u4e3a1\uff0c\u53cd\u5411\u65b9\u5411\u5b9a\u4e49\u4e3a2\uff0c\u5f53\u524d\u65b9\u5411\u4e3a $direction$ \uff0c\u5f53\u524d\u6240\u6709\u6309\u94ae\u72b6\u6001\u4e3a $state$ ,\u6709\uff1a\n```cpp\nint si,sNext,nx,nextState;\nFor(i,0,11) {\n    if (direction == 1) {  //\u6b63\u5411\n        si = (state >> (i << 1)) & 3;   //1\u3001\u83b7\u53d6\u7b2ci+1\u4e2a\u65cb\u94ae\u72b6\u6001\uff080~3\uff09\n        nx = nxt[i][si];                       //2\u3001\u83b7\u53d6\u7275\u8fde\u65cb\u94ae\u7f16\u53f7\n        sNext = (state >> (nx << 1)) & 3;      //3\u3001\u83b7\u53d6\u7275\u8fde\u65cb\u94ae\u72b6\u6001\uff0c\u65b9\u5f0f\u540c1\n        nextState = state ^ (si << (i << 1)) ^ (((si + 1) & 3) << (i << 1)); //4\u3001\u4fee\u6539\u72b6\u6001\u4e3a\u7b2ci+1\u4e2a\u65cb\u94ae\u65cb\u8f6c\u540e\u7684\u72b6\u6001\n        nextState ^= (sNext << (nx << 1)) ^ (((sNext + 1) & 3) << (nx << 1)); //5\u3001\u4fee\u6539\u72b6\u6001\u4e3a\u7275\u8fde\u65cb\u94ae\u65cb\u8f6c\u540e\u7684\u72b6\u6001\n    } else {                      //\u53cd\u5411\n        si = (state >> (i << 1)) & 3;\n        nx = nxt[i][(si + 3) & 3];         //\u83b7\u53d6\u7b2ci+1\u4e2a\u65cb\u94ae\u9006\u5411\u65cb\u8f6c\u540e\u7684\u7275\u8fde\u65cb\u94ae\u7f16\u53f7\n        sNext = (state >> (nx << 1)) & 3;\n        nextState = state ^ (si << (i << 1)) ^ (((si + 3) & 3) << (i << 1)); //\u4fee\u6539\u72b6\u6001\u4e3a\u7b2ci+1\u4e2a\u65cb\u94ae\u9006\u5411\u65cb\u8f6c\u540e\u7684\u72b6\u6001\n        nextState ^= (sNext << (nx << 1)) ^ (((sNext + 3) & 3) << (nx << 1));//\u4fee\u6539\u72b6\u6001\u4e3a\u7275\u8fde\u65cb\u94ae\u9006\u5411\u65cb\u8f6c\u540e\u7684\u72b6\u6001\n    }\n}\n```\n### $Code:$\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define For(i,sta,en) for(int i = sta;i <= en;i++)\ninline int read(){\n    int sum = 0,fu = 1;char ch = getchar();\n    while(!isdigit(ch)) { if(ch == '-') fu = -1;ch = getchar();}\n    while(isdigit(ch)) { sum = (sum<<1)+(sum<<3)+(ch^48);ch =getchar();} return sum * fu;\n}\nconst int N = 1<<24;\nbool vis[N];\nint nxt[14][6],fa[N],choice[N],v[N],flag,m1,m2,mid,ans1[30],ans2[30];\nqueue<int>q;\nint main(){\n    int button,Start = 0;\n    For(i,0,11){\n        button = read();                             //\u8bfb\u5165\u7b2ci+1\u4e2a\u65cb\u94ae\u72b6\u6001\n        Start |= (button - 1) << (i << 1);      //\u8bb0\u5f55\u521d\u59cb\u72b6\u6001\n        For(j,0,3) nxt[i][j] = read()-1;\n    }\n    vis[Start] = vis[0] = 1; //\u662f\u5426\u8bbf\u95ee\u8fc7\n    v[Start] = 1;   v[0] = 2;     //\u533a\u5206\u65b9\u5411\n    q.push(Start);\n    q.push(0);\n    while(!q.empty() && !flag){\n        int state = q.front(),direction = v[state];\n        q.pop();\n        int si,sNext,nx,nextState;\n        For(i,0,11){\n            if(direction == 1){  //\u6b63\u5411\n                si = (state >> (i << 1))&3;   //1\u3001\u83b7\u53d6\u7b2ci+1\u4e2a\u65cb\u94ae\u72b6\u6001\uff080~3\uff09\n                nx = nxt[i][si];                       //2\u3001\u83b7\u53d6\u7275\u8fde\u65cb\u94ae\u7f16\u53f7\n                sNext = (state >> (nx << 1)) & 3;      //3\u3001\u83b7\u53d6\u7275\u8fde\u65cb\u94ae\u72b6\u6001\uff0c\u65b9\u5f0f\u540c1\n                nextState = state ^ (si << (i << 1)) ^ (((si + 1) & 3) << (i << 1)); //4\u3001\u4fee\u6539\u72b6\u6001\u4e3a\u7b2ci+1\u4e2a\u65cb\u94ae\u65cb\u8f6c\u540e\u7684\u72b6\u6001\n                nextState ^= (sNext << (nx << 1)) ^ (((sNext + 1) & 3) << (nx << 1)); //5\u3001\u4fee\u6539\u72b6\u6001\u4e3a\u7275\u8fde\u65cb\u94ae\u65cb\u8f6c\u540e\u7684\u72b6\u6001\n            } else{                      //\u53cd\u5411\n                si = (state >> (i << 1))&3;\n                nx = nxt[i][(si+3)&3];         //\u83b7\u53d6\u7b2ci+1\u4e2a\u65cb\u94ae\u9006\u5411\u65cb\u8f6c\u540e\u7684\u7275\u8fde\u65cb\u94ae\u7f16\u53f7\n                sNext = (state >> (nx << 1)) & 3;\n                nextState = state ^ (si << (i << 1)) ^ (((si + 3) & 3) << (i << 1)); //\u4fee\u6539\u72b6\u6001\u4e3a\u7b2ci+1\u4e2a\u65cb\u94ae\u9006\u5411\u65cb\u8f6c\u540e\u7684\u72b6\u6001\n                nextState ^= (sNext << (nx << 1)) ^ (((sNext + 3) & 3) << (nx << 1));//\u4fee\u6539\u72b6\u6001\u4e3a\u7275\u8fde\u65cb\u94ae\u9006\u5411\u65cb\u8f6c\u540e\u7684\u72b6\u6001\n            }\n            //\u5982\u679c\u8fd9\u4e2a\u72b6\u6001\u5728\u4e4b\u524d\u8bbf\u95ee\u8fc7\n            if(vis[nextState]){\n                if(v[nextState] == direction) continue;  //\u540c\u65b9\u5411\u7684\u76f4\u63a5\u8df3\u8fc7\uff0c\u4e4b\u524d\u5230\u8fbe\u7684\u65f6\u5019\u80af\u5b9a\u4e0d\u52a3\u4e8e\u73b0\u5728\n                /*\n                 * \u4e0d\u540c\u65b9\u5411\u8bf4\u660e\u5df2\u7ecf\u627e\u5230\u7b54\u6848\u4e86\n                 *  m1 \u8bb0\u5f55\u6b63\u5411\u4e0e\u9006\u5411\u7684\u8fde\u63a5\u70b9\n                 *  m2 \u8bb0\u5f55\u9006\u5411\u4e0e\u6b63\u5411\u7684\u8fde\u63a5\u70b9\n                 *  mid \u8bb0\u5f55\u4ecestate\u72b6\u6001\u8f6c\u79fb\u5230nextState\u72b6\u6001\u9009\u62e9\u7684\u65cb\u94ae\u7f16\u53f7\n                 */\n                m1 = direction == 1 ? state : nextState;\n                mid = i+1;\n                m2 = direction == 1 ? nextState : state;\n                flag = 1;break;\n            }\n            vis[nextState] = 1;\n            v[nextState] = direction; //\u7ee7\u627f\u65b9\u5411\n            fa[nextState] = state;          //\u7528\u4e8e\u56de\u6eaf\u64cd\u4f5c\n            choice[nextState] = i + 1;   //\u8bb0\u5f55\u672c\u6b21\u64cd\u4f5c\n            q.push(nextState);\n        }\n    }\n    int cnt1 = 0,state = m1,cnt2 = 0;\n    //\u6b63\u5411\u56de\u6eaf\n    while(state != Start){\n        ans1[++cnt1] = choice[state];\n        state = fa[state];\n    }\n    //\u9006\u5411\u56de\u6eaf\n    state = m2;\n    while(state != 0){\n        ans2[++cnt2] = choice[state];\n        state = fa[state];\n    }\n    //\u603b\u6b65\u6570\uff0c\u8fd8\u8981\u52a0\u4e0a\u4e2d\u95f4\u90a3\u4e00\u6b65mid\u64cd\u4f5c\n    printf(\"%d\\n\",cnt1+cnt2+1);\n    for(int i = cnt1; i; i--) printf(\"%d \", ans1[i]);\n    printf(\"%d \",mid);\n    For(i,1,cnt2) printf(\"%d \", ans2[i]);\n    return 0;\n}\n```\n\n## \u542f\u53d1\u5f0f\u641c\u7d22\n\n&emsp;&emsp;\u53cc\u5411 BFS \u5df2\u7ecf\u591f\u5feb\u4e86\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u66f4\u5feb\u7684\u542f\u53d1\u5f0f\u641c\u7d22\u3002\u5e38\u7528\u7684\u542f\u53d1\u5f0f\u641c\u7d22\u6709 IDA* \u548c A* \uff0c\u542c\u8bf4\u524d\u8005\u88ab\u5361\u4e86\uff0c\u6211\u4eec\u5c31\u7528 A* \u5427\u3002\u8fd9\u91cc\u5148\u4ecb\u7ecd\u8fd9\u4e2a\u7b97\u6cd5\u7684\u5b9e\u73b0\uff0c\u7136\u540e\u7ed9\u51fa\u6b63\u786e\u6027\u8bc1\u660e\u3002\n\n&emsp;&emsp;\u5728 A* \u7b97\u6cd5\u4e2d\uff0c\u6211\u4eec\u8981\u5229\u7528\u5f53\u524d\u72b6\u6001\u7684\u4fe1\u606f\u5bf9\u72b6\u6001\u8fdb\u884c\u8bc4\u4ef7\uff0c\u4ee5\u6b64\u6765\u51b3\u5b9a\u4e0b\u4e00\u6b21\u7684\u64cd\u4f5c\uff0c\u6781\u5927\u5730\u9650\u5236\u4e86\u641c\u7d22\u6811\u7684\u751f\u957f\u3002\u8fd9\u91cc\u7528\u51fd\u6570 $F^*$ \u6765\u8868\u793a $x$ \u72b6\u6001\u7684\u4ee3\u4ef7\uff1a**$F^*(x)= g(x)+h^*(x)$** \u3002\u5176\u4e2d $g (x)$ \u8868\u793a**\u4ece\u521d\u59cb\u72b6\u6001\u5230\u5f53\u524d\u72b6\u6001\u6240\u4ed8\u51fa\u7684\u6700\u5c0f\u4ee3\u4ef7**\uff08\u5728\u672c\u9898\u4e2d\u610f\u4e49\u4e3a\u64cd\u4f5c\u6b65\u6570\uff09\uff0c\u800c $h^*(x)$ **\u662f\u4ece\u5f53\u524d\u72b6\u6001\u5230\u76ee\u6807\u72b6\u6001\u8d70\u6700\u4f73\u8def\u5f84\u6240\u4ed8\u51fa\u7684\u4ee3\u4ef7**\u3002\u5728\u5b9e\u9645\u4ee3\u7801\u4e2d\u6211\u4eec\u4f7f\u7528\u7684\u5176\u5b9e\u662f $F(x)=g (x)+h(x)$ \uff0c\u56e0\u4e3a\u6211\u4eec\u5b9e\u9645\u4e0a\u662f\u4e0d\u77e5\u9053\u8fd9\u4e2a $h^*(x)$ \u7684\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u7528 $h(x)$ \u53bb\u4f30\u8ba1\u5b83\uff0c\u8981\u4fdd\u8bc1 $h(x)$ \u662f $h^*(x)$ \u7684\u4e0b\u754c\uff0c\u5373\u5bf9\u4efb\u610f\u72b6\u6001\u5747\u6709 $h(x)\u2264h^*(x)$ \uff0c\u8fd9\u4e2a\u4f30\u8ba1\u624d\u80fd\u4fdd\u8bc1\u641c\u7d22\u6b63\u786e\u6027\u3002\n\n&emsp;&emsp;\u5728\u4ee3\u7801\u4e2d\u6211\u4eec\u7528\u4ee5\u4e0b\u65b9\u5f0f\u4f30\u8ba1 $h^*(x)$ \uff1a $12$ \u4e2a\u65cb\u94ae\u5728**\u4e0d\u8003\u8651\u7275\u8fde\u65f6\u90fd\u8f6c\u5230 $1$ \u8981\u591a\u5c11\u6b65\uff0c\u518d\u9664\u4ee5 $2$** ,\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u5f97\u5230\u7684 $h(x)$ \u80af\u5b9a\u4f1a\u6bd4\u5b9e\u9645\u8981\u8f6c\u7684\u6b21\u6570 $h^*(x)$ \u8981\u5c11\uff08\u4e00\u6b21\u64cd\u4f5c\u6070\u597d\u5c31\u53ef\u4ee5\u8ba9\u4e24\u4e2a\u65cb\u94ae\u90fd\u5411\u76ee\u6807\u72b6\u6001\u8f6c\u4e00\u6b21\uff0c\u800c\u5b9e\u9645\u4e0a\u53ef\u80fd\u4f1a\u8ba9\u67d0\u4e2a\u65cb\u94ae\u8f6c\u8fc7\u76ee\u6807\u72b6\u6001\uff0c\u4ece\u800c\u8981\u8f6c\u66f4\u591a\u6b21\u6570\uff09\u3002\n\n&emsp;&emsp; $h(x)$ \u662f\u4e00\u4e2a\u6bd4\u8f83\u7384\u5b66\u7684\u4e1c\u4e1c\uff0c\u6ca1\u6709\u552f\u4e00\u7684\u5b9a\u4e49\uff0c\u4e0d\u540c\u7684\u5b9a\u4e49\u53ef\u80fd\u4f1a\u5bfc\u81f4\u7a0b\u5e8f\u6267\u884c\u6548\u7387\u548c\u7ed3\u679c\u4e0d\u540c\uff0c\u8fd9\u9898\u4e2d\u4f60\u8fd8\u53ef\u4ee5\u4e58\u4e00\u4e2a\u7cfb\u6570\u7ed9\u4ed6\uff0c\u80fd\u660e\u663e\u52a0\u5feb\u8fd0\u884c\u6548\u7387\u3002\u7ecf\u8fc7\u7b14\u8005\u591a\u6b21\u6d4b\u8bd5\uff0c\u53d1\u73b0\u7ed9 $h$ \u4e58\u4e0a\u7cfb\u6570\u4ece $1.1$ ~ $2.3$ \u90fd\u80fd AC \u8fd9\u9053\u9898\uff0c\u4f46\u662f\u4e58 $2.4$ \u65f6\u4f1a WA \u6389\u4e00\u4e2a\u70b9\u3002\u53d8\u5316\u8d8b\u52bf\u662f\u8fd9\u4e2a\u7cfb\u6570\u8d8a\u5927\uff0c\u8dd1\u5f97\u8d8a\u5feb\uff0c\u6700\u5927\u7684\u70b9\u53ef\u4ee5\u8dd1\u8fdb $100ms$ \u3002\u8fd9\u662f\u56e0\u4e3a\u7cfb\u6570\u8d8a\u5927\u8d8a\u63a5\u8fd1\u771f\u5b9e\u503c $h^*(x)$\uff0c\u4f46\u662f\u66f4\u5927\u7684\u7cfb\u6570\u4e0d\u80fd\u4fdd\u8bc1  $h(x)\u2264h^*(x)$\u3002\n\n&emsp;&emsp;\u4ee3\u7801\u5b9e\u73b0\u7c7b\u4f3c Dijkstra \u7b97\u6cd5\uff0c\u5b9a\u4e49\u4e00\u4e2a\u7ed3\u6784\u4f53\u5b58\u72b6\u6001\u548c\u8fd9\u4e2a\u72b6\u6001\u5bf9\u5e94\u7684\u4f30\u4ef7\u51fd\u6570\u503c $F$ \u3002\u6bcf\u6b21\u4ece\u5c0f\u6839\u5806\u4e2d\u53d6\u51fa $F$ \u6700\u5c0f\u7684\u72b6\u6001\u8fdb\u884c\u8f6c\u79fb\uff0c\u5b58\u72b6\u6001\u548c\u8f6c\u79fb\u72b6\u6001\u7684\u64cd\u4f5c\u548c\u4e0a\u9762\u53cc\u5411 BFS \u76f8\u540c\uff0c\u8fd9\u91cc\u76f4\u63a5\u7ed9\u51fa\u4ee3\u7801\uff0c\u8bc1\u660e\u653e\u540e\u9762\u3002\n\n$Code:$\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define For(a,sta,en) for(int a = sta;a <= en;a++)\ninline int read(){\n    int sum = 0,fu = 1;char ch = getchar();\n    while(!isdigit(ch)) { if(ch == '-') fu = -1;ch = getchar();}\n    while(isdigit(ch)) { sum = (sum<<1)+(sum<<3)+(ch^48);ch =getchar();} return sum * fu;\n}\nconst int N = 1<<24;\nint g[N],nxt[14][6],fa[N],ans[30],choice[N];\nstruct node{\n    int state;   //\u72b6\u6001\n    double F;  //\u72b6\u6001\u5bf9\u5e94\u4f30\u4ef7\u51fd\u6570\u503c\n    node(int s):state(s){  //\u6784\u9020\u51fd\u6570\uff0c\u5192\u53f7\u540e\u9762\u90e8\u5206\u76f8\u5f53\u4e8e state = s;\n        double h = 0;\n        F = 0;\n        For(i,0,11) if((s>>(i<<1))&3) h += 4 - ((s >> (i << 1)) & 3); //\u8ba1\u7b97\u4e0d\u5904\u5728\u72b6\u60011\u7684\u65cb\u94ae\u7684\u5bf9\u5e94\u7684h\u503c\n        F =  h * 1.2 + g[s];   //\u53ef\u4ee5\u5728h/2\u524d\u4e58\u4e00\u4e2a\u7384\u5b66\u7cfb\u6570\n    }\n    bool operator<(const node &y) const{\n        return F > y.F;  //\u4f30\u4ef7\u51fd\u6570\u503c\u5c0f\u7684\u653e\u524d\u9762\n    }\n};\npriority_queue<node>q;\n\nint main(){\n    int button,Start = 0;\n    For(i,0,11){\n        button = read();                             //\u8bfb\u5165\u7b2ci+1\u4e2a\u65cb\u94ae\u72b6\u6001\n        Start |= (button - 1) << (i << 1);      //\u8bb0\u5f55\u521d\u59cb\u72b6\u6001\n        For(j,0,3) nxt[i][j] = read()-1;\n    }\n    q.push(node(Start));  //\u8c03\u7528\u6784\u9020\u51fd\u6570\uff0c\u987a\u4fbf\u8ba1\u7b97\u51fa\u4f30\u4ef7\u51fd\u6570\u503c\n    g[Start] = 0;\n    while(!q.empty()){\n        int state = q.top().state;\n        q.pop();\n        if(state == 0) break;\n        int si,sNxt,nx,nextState;\n        For(i,0,11){\n            si = (state>>(i<<1))&3;\n            nx = nxt[i][si];\n            sNxt = (state>>(nx<<1))&3;\n            nextState = state ^ (si << (i << 1)) ^ (((si + 1) & 3) << (i << 1)) ^ (sNxt << (nx << 1)) ^ (((sNxt + 1) & 3) << (nx << 1));\n            //\u5982\u679c\u6ca1\u6709\u8bbf\u95ee\u8fc7\u5c31\u53ef\u4ee5\u8f6c\u79fb\u65b0\u72b6\u6001\u4e86\n            if(!g[nextState]){\n                g[nextState] = g[state] + 1;\n                fa[nextState] = state;      //\u7528\u4e8e\u56de\u6eaf\n                choice[nextState] = i + 1;\n                q.push(node(nextState));\n            }\n        }\n    }\n    int cnt = 0,state = 0;\n    while(state != Start){\n        ans[++cnt] = choice[state];\n        state = fa[state];\n    }\n    printf(\"%d\\n\",cnt);\n    for(int i = cnt;i;i--) printf(\"%d \",ans[i]);\n    return 0;\n}\n```\n\n&emsp;&emsp;\u8bc1\u660e\u6b63\u786e\u6027\uff0c\u53ea\u9700\u8bc1\u660e A* \u5728\u9009\u62e9\u5230\u76ee\u6807\u8282\u70b9 $t$ \u65f6\uff08\u5373\u5728\u4f18\u5148\u961f\u5217 $top$ \u65f6\uff09,\u76ee\u6807\u8282\u70b9\u7684\u6700\u4f18\u89e3\u5df2\u627e\u5230\u3002\n\n&emsp;&emsp;\u4ee4 $x$ \u4e3a\u4efb\u610f\u6269\u5c55\u5230\u7684\u8282\u70b9\uff08\u4f18\u5148\u961f\u5217\u4e2d\u7684\u5143\u7d20\uff09\uff0c\u6709 $F(t)\\le F(x)$ \u3002\n\n+ \u7531\u4e8e $h(x)\\le h^*(x)$ ,\u6240\u4ee5 $F(t)\\le F(x) \\le F^*(x)$ \u3002\n+ \u6839\u636e $F^*$ \u7684\u5b9a\u4e49\uff0c${F^*(x)}$ \u4e2d\u5fc5\u5b58\u5728\u4e00\u4e2a\u503c\u4e3a\u5230\u76ee\u6807\u8282\u70b9\u7684\u6700\u4f18\u89e3\uff0c\u8bb0\u4e3a $F^*(s)$ \uff0c\u4ecd\u6709 $F(t)\\le F^*(s)$\u3002 \n+ \u56e0\u4e3a $t$ \u4e3a\u76ee\u6807\u8282\u70b9\uff0c\u6240\u4ee5 $h(t) = 0 ,F(t)=g(t)+h(t)=g(t)\\le F^*(s)$\n+ $F(t)=g(t)$ \u662f\u4e00\u4e2a\u53ef\u884c\u89e3\uff0c\u5fc5\u6709 $g(t)\\ge F^*(s)$ \n+ \u6545 $F(t)=g(t)=F^*(s)$ , \u5373 $F(t)$ \u4e3a\u6700\u4f18\u89e3\uff0c\u8bc1\u6bd5\u3002\n\n\n\n&emsp;&emsp;\u505a\u5b8c\u8fd9\u9053\u9898\u5efa\u8bae\u53bb\u505a\u4e00\u4e0b [P1379 \u516b\u6570\u7801\u96be\u9898](https://www.luogu.com.cn/problem/P1379) ,\u53ef\u4ee5\u540c\u65f6\u7528\u5355\u5411 BFS \uff0c\u53cc\u5411 BFS \uff0cA* \u548c IDA* \u505a\u8fd9\u9053\u9898\uff0c\u5982\u679c\u6bcf\u4e2a\u65b9\u6cd5\u90fd\u5199\u4e00\u4e0b\u4e00\u5b9a\u53d7\u76ca\u826f\u591a\u3002",
        "postTime": 1597383262,
        "uid": 281293,
        "name": "ailanxier",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5507 \u3010\u673a\u5173\u3011"
    },
    {
        "content": "### \u542f\u53d1\u5f0f\u641c\u7d22\uff0c\u4e0d\u4e00\u6837\u7684\u542f\u53d1\u51fd\u6570\uff08\u5438\u6c27\u603b170msAC\uff09\n#### \u4e0d\u64c5\u957f\u6392\u7248\uff0c\u7ecf\u5e38\u4e0d\u8fc7\u5ba1,,\u053e\u2038\u053e,,\n\n\n### - \u5e2e\u840c\u65b0\u7406\u89e3\u542f\u53d1\u641c\u7d22\u7684\u542b\u4e49\n\u76f8\u4fe1\u6765\u5199\u8fd9\u9053\u9898\u7684dl\u4eec\u80af\u5b9a\u90fd\u5f88\u719f\u6089\u641c\u7d22\uff0cdfs\uff0cbfs\u3002\u4e00\u4e2a\u4e00\u641c\u5230\u5e95\uff0c\u4e00\u4e2a\u4e00\n\u5c42\u5c42\u641c\u8fc7\u53bb\u3002\u4f46\u65e0\u7591\u8fd9\u4e24\u79cd\u641c\u7d22\u65b9\u5f0f\u90fd\u662f\u5730\u6bef\u5f0f\u641c\u7d22\uff0c\u4e0d\u7ba1\u957f\u5565\u6837\u90fd\u641c\uff0c\u8fd9\u6837\n\u5c31\u4f1a\u5e26\u6765\u4e00\u4e9b\u95ee\u9898\uff0c\u6570\u636e\u5f88\u5927\u7684\u65f6\u5019\u8fd9\u6837\u641c\u5c31\u4f1a\u9762\u4e34\u7206\u65f6\u95f4\u548c\u5185\u5b58\u7684\u95ee\u9898\uff0c\u6240\n\u4ee5\u6211\u4eec\u641c\u7d22\u7684\u65f6\u5019\u5e94\u8be5\u6709\u4e00\u4e9b\u5224\u65ad\u6807\u51c6\uff0c\u7a0d\u5fae\u5e26\u4e00\u70b9\u667a\u529b\u5730\u641c\uff0c\u4e0d\u80fd\u4e00\u80a1\u8111\u7684\n\u968f\u610f\u641c\u3002\n\t\n\u5176\u5b9e\u8fd9\u5c31\u50cf\u6211\u4eec\u627e\u4e1c\u897f\uff0c\u5bb6\u91cc\u843d\u4e86\u4e00\u4e2a\u4e1c\u897f\uff0c\u4e0d\u77e5\u9053\u5728\u54ea\uff0c\u6211\u4eec\u53c8\u4e0d\u8bb0\u5f97\u4e0a\n\u6b21\u653e\u54ea\u4e86\u3002\u6211\u4eec\u5c31\u8981\u627e\u5b83\uff0c\u6211\u4eec\u4e00\u5b9a\u4e0d\u4f1a\u5148\u628a\u5e8a\u79fb\u5f00\uff0c\u770b\u770b\u662f\u4e0d\u662f\u5728\u5e8a\u4e0b\uff0c\n\u6216\u8005\u9996\u5148\u5230\u4f60\u5bb6\u5e03\u6ee1\u7070\u5c18\u7684\u50a8\u7269\u95f4\u53bb\u627e\u3002\u6211\u4eec\u4f1a\u5148\u627e\u90a3\u4e9b\u66f4\u53ef\u80fd\u7684\u5730\u65b9\uff0c\u6bd4\n\u5982\u684c\u5b50\u4e0a\uff1f\u4e66\u4e0b\u9762\uff1f\u7b49\u7b49\u3002\u800c\u4f60\u4e4b\u6240\u4ee5\u505a\u51fa\u8fd9\u6837\u7684\u9009\u62e9\u5c31\u662f\u57fa\u4e8e\u6211\u4eec\u81ea\u5df1\u7684\n\u5224\u65ad\u51fd\u6570\uff0c\u53ea\u4e0d\u8fc7\u8fd9\u4e2a\u5224\u65ad\u51fd\u6570\u4e0d\u5355\u5355\u548c\u53ef\u80fd\u6027\u76f8\u5173\uff0c\u4f46\u53ef\u80fd\u6027\u4e00\u5b9a\u662f\u6211\u4eec\n\u5224\u65ad\u7684\u91cd\u8981\u56e0\u7d20\u3002\n\t\n\u8bf4\u4e86\u90a3\u4e48\u591a\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u8fd9\u9053\u9898\u4e86\uff0c\u672c\u9898\u540c\u5176\u4ed6dl\u8bf4\u7684\u7528\u53cc\u5411bfs\u53ef\u4ee5\u8fc7\uff0c\u4f46\n\u662f\u8fd8\u662f\u6162\u4e86\u70b9\uff0c\u7b14\u8005\u8fd9\u91cc\u7528\u7684\u542f\u53d1\u5f0f\u641c\u7d22\u3002\u4f46\u662f\u7b14\u8005\u521d\u5b66\u542f\u53d1\u5f0f\u641c\u7d22\uff0c\u4e0d\u77e5\n\u9053\u4e3a\u4ec0\u4e48\u542f\u53d1\u51fd\u6570\u4e00\u5b9a\u8981\u5199\u6210f[n] = g[n] + d[n]\uff0cg[n] \u662f\u5b9e\u9645\u82b1\u8d39\uff0c\nd[n] \u662f\u9884\u4f30\u82b1\u8d39\uff0c\u6240\u4ee5\u7b14\u8005\u5c1d\u8bd5\u4e86\u5176\u4ed6\u5f62\u5f0f\u7684\u51fd\u6570\uff0c\u53d1\u73b0\u6548\u679c\u4e0d\u9519\uff0c\u4f46\u662f\u7531\n\u4e8e\u6d4b\u8bd5\u6570\u636e\u7684\u9650\u5236\uff0c\u6216\u8bb8\u4f1a\u6709\u67d0\u4e9b\u6570\u636e\u6c42\u4e0d\u51fa\u6700\u4f18\u89e3\uff0c\u8fd8\u671b\u6307\u6b63\u3002\u4e0b\u65b9\u5217\u51fa\n\u4e86\u7b14\u8005\u4f7f\u7528\u7684\u542f\u53d1\u51fd\u6570\u3002\n        \n```cpp\nf=length*step+length+step\n```\n\n\n### - \u542f\u53d1\u51fd\u6570\u89e3\u91ca\t\nlength\u662f\u7406\u60f3\u8ddd\u79bb\uff08\u5c31\u662f\u6bcf\u4e2a\u6309\u94ae\u8f6c\u52a8\u5230\u7406\u60f3\u72b6\u6001\u7684\u603b\u8f6c\u52a8\u6b21\u6570\u4e4b\u548c\uff0c\u6bd4\u59821 \n2 3 4\uff0c\u8f6c\u52a8\u52301 1 1 1\uff0c\u5c31\u662f0+3+2+1=6\uff0c\u7406\u8bba\u4e0a\u662f\u8981\u96642\u7684\u56e0\u4e3a\u8f6c\u52a8\u4e00\u4e2a\u6309\n\u94ae\u4f1a\u5f71\u54cd\u4e24\u4e2a\uff0c\u4f46\u8fd9\u91cc\u597d\u50cf\u4e0d\u96642\u66f4\u5feb\uff09\uff0cstep\u662f\u73b0\u5728\u5df2\u7ecf\u8d70\u7684\u6b65\u6570\u3002\u8fd9\u4e2a\u542f\n\u53d1\u51fd\u6570\u76f8\u6bd4\u4e8e\u5176\u4ed6\u9898\u89e3\u7684\u51fd\u6570\u591a\u52a0\u4e86\u4e00\u4e2a\u4e58\u79ef\u9879\uff0c\u5927\u5bb6\u53ef\u4ee5\u81ea\u884c\u8c03\u6574\u5404\u4e2a\u7cfb\n\u6570\uff0c\u4f46\u662f\u53ef\u80fd\u4f1a\u5bfc\u81f4\u4e0d\u662f\u6700\u4f18\u89e3\u6216\u8005\u8d85\u65f6\uff0clength\u7684\u7cfb\u6570\u66f4\u5927\uff0c\u66f4\u8d8b\u5411\u4e8e\u8d2a\n\u5fc3\uff0cstep\u7684\u66f4\u5927\uff0c\u66f4\u8d8b\u5411\u4e8e\u5e7f\u641c\u3002\n\n\n\n### - \u4ee3\u7801\u5982\u4e0b\n\n\n```cpp\n\n#include<bits/stdc++.h>\nusing namespace std;\nint a[12][4]; bool vis[16800000];  int be[12];\nvoid Move(int* m, int move)\n{\n    if (m[a[move][m[move]]] != 3)\n        m[a[move][m[move]]]++;\n    else m[a[move][m[move]]] = 0;\n    if (m[move] != 3)m[move]++;\n    else m[move] = 0;\n\n}\nint Count(int* m)\n{\n    int sum = 0;\n    for (int i = 0; i < 12; i++)\n    {\n        sum = (sum << 2) + m[i];\n    }\n    return sum;\n}\nstruct node\n{\n    int count;\n    int m[12];\n    int l; \n        vector<int>re;\n    node() {};\n    node(int* a, node* other, int count1, int move);\n    node(int* a, int count1);\n    bool operator<(node other)const\n    {\n        return (1 + l) * (re.size() + 1) > (1 + other.re.size())* (other.l + 1);\n    }\n}x;\nint count2(node* now)\n{\n    int t = 0;\n    for (int i = 0; i < 12; i++)\n    {\n        if (now->m[i])\n            t += 4 - now->m[i];\n    }\n    return t;\n}\nnode::node(int* a, node* other, int count1, int move)\n    {\n        memcpy(m, a, sizeof(m));\n        count = count1;\n        re = other->re;\n        re.push_back(move);\n        vis[count] = 1;\n        l = count2(this);\n    };\nnode::node(int* a, int count1)\n{\n    memcpy(m, a, sizeof(m));\n    count = count1;\n    vis[count] = 1;\n    l = count2(this);\n};\nvoid A()\n{\n    priority_queue<node>q;\n    q.push(node(be, Count(be)));\n    node temp;  int count, count1, temp1[12];\n    while (!q.empty())\n    {\n        temp = q.top();  count = temp.count;\n        q.pop();\n        for (int i = 0; i < 12; i++)\n        {\n            memcpy(temp1, temp.m, sizeof(temp1));\n            Move(temp1, i);\n            count1 = Count(temp1);\n            if (!vis[count1])\n            {\n                node temp2(temp1, &temp, count1, i); q.push(temp2);\n                if (vis[0]) { x = temp2; return; }\n\n            }\n        }\n    }\n}\nint main()\n{\n    for (int i = 0; i < 12; i++)\n    {\n        cin >> be[i]; be[i]--;\n        for (int j = 0; j < 4; j++)\n        {\n            cin >> a[i][j]; a[i][j]--;\n        }\n    }\n    A();\n    cout << x.re.size() << endl;\n    for (int i = 0; i < x.re.size(); i++)\n    {\n        cout << x.re[i] + 1 << \" \";\n    }\n    return 0;\n}\n\n```\n### - \u5177\u4f53\u4ee3\u7801\u89e3\u91ca\u53ef\u4ee5\u53bb\u4f5c\u8005\u535a\u5ba2\u770b\u770b\u3002\n\n\n\u5927\u5bb6\u53ef\u4ee5\u53bb\u505a\u4e00\u505a[\u516b\u6570\u7801\u96be\u9898](https://www.luogu.com.cn/problem/P1379)\n\n\u66f4\u53ef\u4ee5\u8fd9\u7bc7\u9898\u89e3\u70b9\u4e00\u4e2a\u8d5e\u3002\u5173\u6ce8\u4e00\u4e0b\u4f5c\u8005\u3002\n",
        "postTime": 1594261529,
        "uid": 301126,
        "name": "NKU_AI_HMX",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5507 \u3010\u673a\u5173\u3011"
    },
    {
        "content": "\u5148\u5b89\u5229\u4e00\u4e0b[\u6211\u7684\u535a\u5ba2](https://www.luogu.org/blog/I-AK-IOI/)\n\n\u4e00\u770b\u5230\u8fd9\u9898\uff0c\u5c31\u60f3\u5230\u542f\u53d1\u5f0f\u641c\u7d22\n\n\u5148\u8003\u8651IDA_star\n\n\u56e0\u4e3a\u4e00\u4e2a\u8282\u70b9\u82e5\u4e0d\u4e3a1\uff0c\u90a3\u4e48\u8981\u6539\u5bf9\u62101\u4e5f\u89815-a[i]\u6b21\n\na[i]\u4e3a\u7b2ci\u4e2a\u8282\u70b9\u7684\u6570\u5b57\n\n\u4e00\u6b21\u6700\u591a\u6539\u4e24\u4e2a\uff0c\u6240\u4ee5\u628a\u8fd9\u4e9b\u90fd\u52a0\u4e0a\u53bb\u540e\u8fd8\u8981/2\u5411\u4e0a\u53d6\u6574\n\n```cpp\n#pragma GCC optimize(3)\n#pragma GCC optimize(\"Ofast\")\n#include<bits/stdc++.h>\nusing namespace std;\ntemplate<class item>\ninline item read() {\n\titem res = 0;\n\tbool negative = 0;\n\tchar ch = getchar();\n\twhile (!isdigit(ch)) negative |= ch == '-', ch = getchar();\n\twhile (isdigit(ch)) res = (res << 3) + (res << 1) + (ch ^ 48), ch = getchar();\n\treturn negative ? -res : res;\n}\ntemplate<class item>\ninline item read(item & t) {\n\tt = read<item>();\n\treturn t;\n}\n#define max(a, b)  (!((a) < (b)) ? (a) : (b))\n#define min(a, b)  ((a) < (b) ? (a) : (b))\ntemplate <typename T, typename... Args>\ninline void read(T& t, Args&... args) {\n\tread(t), read(args...);\n}\n//\u5feb\u8bfb\uff0c\u957f\u4e86\u70b9\nstruct data {\n\tint a[20], step[20], len;\n\tint hash() {\n\t\tint res = 0;\n\t\tfor (register int i = 1; i <= 12; ++i) res = (res << 2) + a[i];//hash\n\t\treturn res;\n\t}\n\tbool check() {\n\t\tfor (register int i = 1; i <= 12; ++i) if (a[i] != 1) return 0;\n\t\treturn 1;\n\t}\n\tint hfunc() {\n\t\tint cnt = 0;\n\t\tfor (register int i = 1; i <= 12; ++i) \n\t\t    if (a[i] != 1) cnt += 5 - a[i];\n      //\u4f30\u4ef7\u51fd\u6570\n      //\u82e5\u4e0d\u4e3a1\uff0c\u8981\u5bf9\u4e0a\u4e5f\u89815-a[i]\u6b21\n\t\treturn ((cnt - 1) >> 1) + 1;\n\t}\n};\nint a[20][5], s[20], depth = 4, minn;\nint _next(int x) {\n\treturn x < 4 ? x + 1 : 1;\n}\ndata st;\nbool vis[70000000];\nconst int b[11] = {4, 6, 8, 9, 10, 11, 12, 13, 15, 17};\nvoid dfs(data now) {\n\tif (now.len + now.hfunc() > depth) {\n\t\t//minn = min(minn, now.len + now.hfunc());\n\t\treturn;\n\t}\n\tif (now.check()) {\n\t\tprintf(\"%d\\n\", now.len);\n\t\tfor (register int i = 1; i <= now.len; ++i)\n\t\t\tprintf(\"%d \", now.step[i]);\n\t\t//printf(\"%.3lf\", ss);\n\t\texit(0);\n\t}\n\tfor (register int i = 1; i <= 12; ++i) {\n\t\tdata next = now;\n\t\tnext.a[i] = _next(next.a[i]);\n\t\tnext.step[++next.len] = i;\n\t\tnext.a[a[i][now.a[i]]] = _next(next.a[a[i][now.a[i]]]);\n\t\tint val = next.hash();\n\t\tif (vis[val]) continue;\n\t\tvis[val] = 1;\n\t\t//q.push(next);\n\t\tdfs(next);\n\t\tvis[val] = 0;\n\t}\n}\nint main() {\n\tfor (register int i = 1; i <= 12; ++i) {\n\t\tread(s[i], a[i][1], a[i][2], a[i][3], a[i][4]);\n\t\tst.a[i] = s[i];\n\t}\n\tvis[st.hash()] = 1;//\u5176\u5b9e\u4e0d\u7528\u7684\n\t//q.push(st);\n\tfor (register int i = 1; i <= 10; ++i) {\n\t\tdepth = b[i];\n\t\tdfs(st);\n\t}\n}\n```\nIDA_star\u88ab\u5361\u4e86\uff0c\u600e\u4e48\u529e\uff1f\n\n\u6211\u4eec\u8fd8\u6709\n\n# A_star!\n\n```cpp\n// luogu-judger-enable-o2\n#pragma GCC optimize(3)\n#pragma GCC optimize(\"Ofast\")\n#include<bits/stdc++.h>\nusing namespace std;\ntemplate<class item>\ninline item read() {\n\titem res = 0;\n\tbool negative = 0;\n\tchar ch = getchar();\n\twhile (!isdigit(ch)) negative |= ch == '-', ch = getchar();\n\twhile (isdigit(ch)) res = (res << 3) + (res << 1) + (ch ^ 48), ch = getchar();\n\treturn negative ? -res : res;\n}\ntemplate<class item>\ninline item read(item & t) {\n\tt = read<item>();\n\treturn t;\n}\n#define max(a, b)  (!((a) < (b)) ? (a) : (b))\n#define min(a, b)  ((a) < (b) ? (a) : (b))\ntemplate <typename T, typename... Args>\ninline void read(T& t, Args&... args) {\n\tread(t), read(args...);\n}\n//\u5feb\u8bfb\uff0c\u957f\u4e86\u70b9\nstruct data {\n\tint a[20], step[20], len, y;\n\tint hash() {\n\t\tint res = 0;\n\t\tfor (register int i = 1; i <= 12; ++i) res = (res << 2) + a[i];//hash\u5224\u91cd\n\t\treturn res;\n\t}\n\tbool check() {\n\t\tfor (register int i = 1; i <= 12; ++i) if (a[i] != 1) return 0;\n\t\treturn 1;\n      //\u641c\u7d22\u662f\u5426\u6210\u529f\n\t}\n\tint hfunc() {\n\t\tint cnt = 0;\n\t\tfor (register int i = 1; i <= 12; ++i) \n\t\t    if (a[i] != 1) cnt += 5 - a[i];\n\t\treturn ((cnt - 1) >> 1) + 1;\n      //\u4f30\u4ef7\u51fd\u6570\n      //\u82e5\u4e0d\u4e3a1\uff0c\u8981\u5bf9\u4e0a\u4e5f\u89815-a[i]\u6b21\n      \n\t}\n\tbool operator < (const data &a) const {\n\t\treturn len + y > a.len + a.y;\n\t}\n    //\u91cd\u8f7d\u5c0f\u4e8e\u53f7\n};\nint a[20][5];\nstd::priority_queue<data> q;//\u4f18\u5148\u961f\u5217\nint _next(int x) {\n\treturn x < 4 ? x + 1 : 1;\n}\ndata st;\nbool vis[70000000];\nint main() {\n\tfor (register int i = 1; i <= 12; ++i) {\n\t\tread(st.a[i], a[i][1], a[i][2], a[i][3], a[i][4]);\n\t}\n\tvis[st.hash()] = 1;//\u5e7f\u641c\n\tst.y = st.hfunc();\n\tq.push(st);\n\twhile (q.size()) {\n\t\tdata now = q.top();//\u5f53\u524d\u6b65\u6570+\u4f30\u4ef7\u6700\u5c0f\u7684\n\t\tq.pop();\n\t\tif (now.y == 0) {\n\t\t\tprintf(\"%d\\n\", now.len);\n\t\t\tfor (register int i = 1; i <= now.len; ++i)\n\t\t\t\tprintf(\"%d \", now.step[i]);\n\t\t\texit(0);\n\t\t}//\u641c\u5230\u4e86\uff0c\u8f93\u51fa\u5e76\u63a8\u51fa\n\t\tfor (register int i = 1; i <= 12; ++i) {\n\t\t\tdata next = now;\n\t\t\tnext.a[i] = _next(next.a[i]);\n\t\t\tnext.step[++next.len] = i;\n\t\t\tnext.a[a[i][now.a[i]]] = _next(next.a[a[i][now.a[i]]]);\n\t\t\tint val = next.hash();\n\t\t\tif (vis[val]) continue;\n\t\t\tvis[val] = 1;\n\t\t\tnext.y = next.hfunc();\n\t\t\tq.push(next);\n\t\t}\n      //\u679a\u4e3e\n\t}\n}\n```\n\u6700\u540e\u8bf4\u4e00\u4e0b\uff0c\u542f\u53d1\u5f0f\u641c\u7d22\u771f\u7684\u5f88\u5feb\uff0c\u4e00\u5b9a\u8981\u5b66\u4f1a\u54e6\uff01\n",
        "postTime": 1566278526,
        "uid": 162196,
        "name": "\u4f1f\u5927\u7684\u738b\u592b\u5b50",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5507 \u3010\u673a\u5173\u3011"
    },
    {
        "content": "~~\u8fd9\u9898\u5c31\u662f\u4e00\u4e2a\u66b4\u529b~~\n\n\u6b63\u89e3\uff1a\u641c\u7d22\n\n\u5f97\u5206\u53d6\u51b3\u4e8e\u641c\u7d22\u7684\u6548\u7387\n\n### \u6700\u7b80\u5355\u7684\u65b9\u6cd5\uff1aBFS\n\n\u6bcf\u4e2a\u72b6\u6001\u679a\u4e3e12\u4e2a\u4f4d\u7f6e\uff0c\u7136\u540e\u6c42\u51fa\u6539\u53d8\u540e\u7684\u72b6\u6001\uff0c\u5165\u961f\n\n\u8fd9\u6837\uff0c\u53ea\u8981\u5230\u8fbe\u4e86\u6700\u7ec8\u72b6\u6001\uff0c\u5c31\u6c42\u51fa\u4e86\u6b65\u6570\n\n\u4f46\u8fd9\u6837\u6548\u7387\u5f88\u4f4e\n\n\u671f\u671b\u5f97\u5206\uff1a10\u5206\u621620\u5206\n\n### \u4f18\u5316\uff1a\u53bb\u9664\u91cd\u590d\u7684\u72b6\u6001\n\n\u53d1\u73b0\u72b6\u6001\u603b\u6570\u5e76\u4e0d\u591a\uff0c\u53ea\u6709$2^{24}$\u79cd\uff0c\u800c\u4e14\u7a7a\u95f4\u4e5f\u5f88\u5145\u8db3\n\n\u6240\u4ee5\u7528\u4e00\u4e2a\u6570\u7ec4\u8bb0\u5f55\u67d0\u4e2a\u72b6\u6001\u662f\u5426\u5df2\u7ecf\u641c\u8fc7\uff0c\u5982\u679c\u641c\u8fc7\uff0c\u5c31\u4e0d\u5165\u961f\n\n\u8fd9\u6837\u6548\u7387\u4f1a\u9ad8\u4e00\u4e9b\n\n\u800c\u4e14\uff0c\u5982\u679c\u88ab\u5361\u6ee1\uff0c\u90a3\u4e48\u7ea65s\u4e00\u5b9a\u80fd\u6c42\u51fa\u89e3\uff08\u8fd9\u5c31\u662f\u6b65\u6570\u5e76\u4e0d\u592a\u591a\u800c\u4e14\u65f6\u9650\u6bd4\u8f83\u5c0f\u7684\u539f\u56e0\uff09\n\n\u671f\u671b\u5f97\u5206\u53d6\u51b3\u4e8e\u5e38\u6570\uff0c\u5927\u6982\u572820-80\u5206\u4e4b\u95f4\uff0c\u5982\u679c\u5361\u5e38\u6280\u672f\u597d\u4e5f\u80fdAC\n\n\u8fd9\u4e2a\u4e5f\u53ef\u4ee5\u7528\u53cc\u5411BFS\u6765\u8fdb\u4e00\u6b65\u4f18\u5316\n\n### \u53e6\u4e00\u4e2a\u65b9\u6cd5\uff1a\u542f\u53d1\u5f0f\u641c\u7d22\n\n\u542f\u53d1\u5f0f\u641c\u7d22\u4f1a\u4f18\u5148\u641c\u66f4\u53ef\u80fd\u662f\u6700\u4f18\u89e3\u7684\u72b6\u6001\uff0c\u53ef\u4ee5\u66f4\u5feb\u8fbe\u5230\u6700\u4f18\u89e3\n\n\u4f30\u4ef7\u51fd\u6570\uff1a\u6bcf\u4e2a\u4f4d\u7f6e\u8ddd\u79bb\u76ee\u6807\u72b6\u6001\u7684\u5dee\u503c\u4e4b\u548c\u9664\u4ee52\n\n\u4e5f\u5c31\u662f\uff0c\u5982\u679c\u6bcf\u6b21\u53ef\u4ee5\u4efb\u610f\u9009\u62e9\u4e24\u4e2a\u65cb\u94ae\u5e76\u6539\u53d8\u72b6\u6001\uff0c\u90a3\u4e48\u6700\u5c11\u7684\u6b65\u6570\u662f\u591a\u5c11\n\n\u8fd9\u6837\uff0c\u5728\u6570\u636e\u5f3a\u5ea6\u4e2d\u7b49\u7684\u60c5\u51b5\u4e0b\uff0c\u5c31\u53ef\u4ee5\u660e\u663e\u63d0\u9ad8\u6548\u7387\n\n\u671f\u671b\u5f97\u5206\uff1a100\u5206\n\n~~\u603b\u4e4b\uff0c\u505a\u6cd5\u5f88\u591a~~\n\n\u4ee3\u7801\uff1a\n\nBFS(40\u5206)\n\n```cpp\n#include<iostream>\n#include<ctime>\nusing namespace std;\nint st,mdf[12][4];\nint que[1<<24],dp[1<<24],fr[1<<24],opt[1<<24],he,ta;\nint t,nxt;\nint p1,s;\nvoid bit(int n){\n\tfor(int i=0;i<12;i++){\n\t\tcout<<((n&(3<<(i*2)))>>(i*2));\n\t}\n}\ninline int nx(int st,int p){\n\tint t=((st&(3<<(p*2)))>>(p*2));\n\tst=(st^(t<<(p*2)));\n\tt++;\n\tt&=3;\n\tst=(st^(t<<(p*2)));\n\treturn st;\n}\nint sol[1<<24],c;\nint main(){\n\tfor(int i=0;i<12;i++){\n\t\tcin>>t;\n\t\tt--;\n\t\tst|=(t<<(i*2));\n\t\tfor(int j=0;j<4;j++){\n\t\t\tcin>>t;\n\t\t\tt--;\n\t\t\tmdf[i][j]=t;\n\t\t}\n\t}\n\ts=st;\n\tdp[st]=1;\n\tque[he++]=st;\n\twhile(he!=ta){\n\t\tst=que[ta++];\n\t\tif(st==0)break;\n\t\tfor(int i=0;i<12;i++){\n\t\t\tt=((st&(3<<(i*2)))>>(i*2));\n\t\t\tp1=nx(st,i);\n\t\t\tnxt=nx(p1,mdf[i][t]);\n\t\t\tif(!dp[nxt]){\n\t\t\t\tdp[nxt]=1;\n\t\t\t\tfr[nxt]=st;\n\t\t\t\topt[nxt]=i;\n\t\t\t\tque[he++]=nxt;\n\t\t\t}\n\t\t}\n\t}\n\tif(dp[0]){\n\t\tfor(int i=0;i!=s;i=fr[i]){\n\t\t\tsol[c++]=opt[i]+1;\n\t\t}\n\t\tcout<<c<<endl;\n\t\tfor(int i=c-1;i>=0;i--)cout<<sol[i]<<\" \";\n\t}else{\n\t\tcout<<\"0\"<<endl;\n\t}\n}\n```\n\u542f\u53d1\u5f0f\u641c\u7d22(100\u5206)\n\n\u4e3a\u4e86\u63d0\u9ad8\u6548\u7387\uff0c\u7528\u7684\u624b\u5199\u5806\n```cpp\n#include<iostream>\n#include<cstdio>\nlong long read(){\n\tlong long n=0;char c=getchar();bool f=0;\n\twhile(c!='-'&&(c<'0'||c>'9'))c=getchar();\n\tif(c=='-'){f=1;c=getchar();}\n\twhile(c>='0'&&c<='9'){n=n*10+c-'0';c=getchar();}\n\tif(f)return -n;\n\telse return n;\n}\nchar res[25];\nvoid write(long long n){\n\tif(n==0){putchar('0');return;}\n\tif(n<0){putchar('-');n=-n;}\n\tint t=0;\n\twhile(n){res[t++]=n%10+'0';n/=10;}\n\twhile(t--)putchar(res[t]);\n}\nconst int l[]={0,3,2,1};\nint dis1[1<<12];\nvoid pre(){\n    for(int i=0;i<1<<12;i++){\n        int ans=0,t;\n        for(int j=0;j<6;j++){\n            t=((i&(3<<(j*2)))>>(j*2));\n            t=-t;\n            if(t<0)t+=4;\n            ans+=t;\n        }\n        dis1[i]=ans;\n    }\n}\nstruct game{\n    int st,move;\n    int used;\n    game(int s,int u){\n        st=s;\n        used=u*2;\n        move=dis1[s>>12]+dis1[s&0xfff];\n    }\n    game(){}\n};\nvoid swap(game &a,game &b){\n\tgame t=a;a=b;b=t;\n}\nbool operator>(const game &a,const game &b){\n    if(a.move+a.used==b.move+b.used)return a.move>b.move;\n    return a.move+a.used>b.move+b.used;\n}\nbool operator<(const game &a,const game &b){\n    if(a.move+a.used==b.move+b.used)return a.move<b.move;\n    return a.move+a.used<b.move+b.used;\n}\n//\u4e5f\u53ef\u4ee5\u7528std::priority_queue\u4ee3\u66ff\uff0c\u9664\u4e86\u6162\u70b9\uff0c\u57fa\u672c\u6ca1\u533a\u522b\ngame heap[1<<24];int size;\nvoid pop(){\n\theap[1]=heap[size];\n\tsize--;\n\tint cur=1;\n\twhile(1){\n\t\tif((cur<<1)>size)break;\n\t\tif(((cur<<1)|1)>size){\n\t\t\tif(heap[cur]>heap[cur<<1])swap(heap[cur],heap[cur<<1]);\n\t\t\tbreak;\n\t\t}\n\t\tif(heap[(cur<<1)|1]>heap[cur<<1]){\n\t\t\tif(heap[cur]>heap[cur<<1]){\n\t\t\t\tswap(heap[cur],heap[cur<<1]);\n\t\t\t\tcur=(cur<<1);\n\t\t\t}else break;\n\t\t}else{\n\t\t\tif(heap[cur]>heap[(cur<<1)|1]){\n\t\t\t\tswap(heap[cur],heap[(cur<<1)|1]);\n\t\t\t\tcur=((cur<<1)|1);\n\t\t\t}else break;\n\t\t}\n\t}\n}\nvoid push(game num){\n\theap[++size]=num;\n\tint cur=size;\n\twhile(cur!=1){\n\t\tif(heap[cur]<heap[cur>>1]){\n\t\t\tswap(heap[cur],heap[cur>>1]);\n\t\t\tcur=(cur>>1);\n\t\t}else{\n\t\t\tbreak;\n\t\t}\n\t}\n}\ngame top(){return heap[1];}\n\nint dp[1<<24],fr[1<<24],opt[1<<24];\ninline int nx(int st,int p){\n    int t=((st&(3<<(p*2)))>>(p*2));\n    st=(st^(t<<(p*2)));\n    t++;\n    t&=3;\n    st=(st^(t<<(p*2)));\n    return st;\n}\nint mdf[12][4];\nint t,stage,s,nxt;\nint sol[1<<24],c;\nint main(){\n\tpre();\n    for(int i=0;i<12;i++){\n        t=read();\n        t--;\n        stage|=(t<<(i*2));\n        for(int j=0;j<4;j++){\n            t=read();\n            t--;\n            mdf[i][j]=t;\n        }\n    }\n    s=stage;\n    dp[stage]=1;\n    game p=game(stage,1);\n    if(p.move%2){\n        write(0);\n        return 0;\n    }\n    push(p);\n    while(size){\n        p=top();\n        pop();\n        if(p.st==0)break;\n        if(p.used!=dp[p.st]*2)continue;\n        for(int i=0;i<12;i++){\n            t=((p.st&(3<<(i*2)))>>(i*2));\n            nxt=nx(nx(p.st,i),mdf[i][t]);\n            if(!dp[nxt]||dp[nxt]>dp[p.st]+1){\n                dp[nxt]=dp[p.st]+1;\n                fr[nxt]=p.st;\n                opt[nxt]=i;\n                push(game(nxt,dp[nxt]));\n            }\n        }\n    }\n    if(dp[0]){\n        for(int i=0;i!=s;i=fr[i]){\n            sol[c++]=opt[i]+1;\n        }\n        write(c);putchar('\\n');\n        for(int i=c-1;i>=0;i--){write(sol[i]);putchar(' ');}\n    }else{\n        write(0);putchar('\\n');\n    }\n}\n```\n\n",
        "postTime": 1565684618,
        "uid": 86649,
        "name": "Hope2075",
        "ccfLevel": 8,
        "title": "\u673a\u5173-\u9898\u89e3"
    },
    {
        "content": "~~\u4e0d\u4f1a\u5199\u53cc\u5411BFS\u7684\uff0c\u6b7b\u4e5f\u4e0d\u4f1a\u5199\u7684~~\n\n\u8003\u8651$IDA*$\u3002\u4e00\u4e2a\u5f88naive\u7684h\u51fd\u6570\u662f\uff1a\u6bcf\u4e2a\u6309\u94ae\u5230\u76ee\u6807\u7684\u8ddd\u79bb\u7684\u6700\u5927\u503c\u3002\u4e8e\u662f\u4f60\u82b120min\u5c31\u53ef\u4ee5\u62ff\u523040\u5206\uff1a\n\n```cpp\n#include<cstdio>\nshort s[15],a[15][5],maxd=0,opt[20];\ninline bool check(){\n\tfor(short i=1;i<=12;++i)if(s[i]!=1)return 0;\n\treturn 1;\n}\ninline short h(){\n\tshort i,maxn=0;\n\tfor(i=1;i<=12;++i)if(s[i]!=1&&5-s[i]>maxn)maxn=5-s[i];\n\treturn maxn;\n}\nbool dfs(int d){\n\tif(d+h()>maxd)return 0;\n\tif(check())return 1;\n\tshort i,t1,t2,p;\n\tfor(i=1;i<=12;++i){\n\t\tt1=s[i];p=a[i][s[i]];t2=s[p];\n\t\ts[i]=(s[i]&3)+1;s[p]=(s[p]&3)+1;\n\t\topt[d]=i;\n\t\tif(dfs(d+1))return 1;\n\t\ts[p]=t2;s[i]=t1;  //\u5012\u8fc7\u6765\u4e3b\u8981\u662f\u4e3a\u4e86p==i\u7684\u60c5\u51b5\n\t}\n\treturn 0;\n}\nint main(){\n\tshort i,j;\n\tfor(i=1;i<=12;++i){\n\t\tscanf(\"%d\",s+i);\n\t\tfor(j=1;j<=4;++j)scanf(\"%d\",&a[i][j]);\n\t}\n\tfor(maxd=0;maxd<18;++maxd)if(dfs(0))break;\n\tprintf(\"%d\\n\",maxd);\n\tfor(i=0;i<maxd;++i)printf(\"%d \",opt[i]);\n\treturn 0;\n}\n```\n\n\u7136\u800c\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2ah\u51fd\u6570\u76f8\u5f53\u4e0d\u7cbe\u786e\uff0c\u56e0\u4e3a\u6bcf\u6b21\u6700\u591a\u4fee\u6539\u4e24\u4e2a\u6309\u94ae\uff0c\u7a0d\u52a0\u601d\u8003\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u66f4\u7cbe\u786e\u7684h\uff1a\u6bcf\u4e2a\u6309\u94ae\u5230\u76ee\u6807\u7684\u8ddd\u79bb\u7684\u548c\u7684\u4e00\u534a\u3002\u4e8b\u5b9e\u8bc1\u660e\u8fd9\u4e2a\u4e0b\u754c\u76f8\u5f53\u7d27\uff0c\u628a\u4e0a\u9762\u4ee3\u7801\u4e2d\u7684h()\u6362\u6210\u5982\u4e0b\u4ee3\u7801\u5373\u53ef\u83b7\u5f9780\u5206\uff1a\n\n```cpp\ninline short h(){\n\tshort i,sum=0;\n\tfor(i=1;i<=12;++i)if(s[i]!=1)sum+=5-s[i];\n\treturn sum>>1;\n}\n```\n\u90a3\u4e48\u5269\u4e0b20\u5206\u600e\u4e48\u62ff\u5462\uff1f ~~BFS\uff1a\u771f\u9999\uff01~~ \u6ca1\u5173\u7cfb\uff0c$IDA*$\u88ab\u5361\u4e86\uff0c\u6211\u4eec\u8fd8\u6709$A*$\uff01~~\u96be\u5199\u591a\u4e86~~\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<queue>\nusing namespace std;\nint pre[1<<24];\nshort a[15][5],d[1<<24],opt[1<<24],st[20],sl=-1;\nstruct node{\n\tint x;\n\tshort g;  //g\u5185\u4fdd\u5b58\u7684\u662fA*\u4e2d\u7684f()\u4e0eh()\u7684\u548c\n\tnode(){}\n\tnode(int x):x(x){\n\t\tg=0;\n\t\tfor(short i=0;i<24;i+=2)if(x&(3<<i))g+=4-((x>>i)&3);\n\t\tg=(g>>1)+d[x];\n\t}\n\tinline bool operator <(const node &b)const{return g>b.g;}\n};\npriority_queue<node> Q;\ninline short nxt(short x){return (x+1)&3;}\nint main(){\n\tshort i,j,s,t1,t2,p;\n\tint h,t=0;\n\tbool ok=0;\n\tfor(i=0;i<12;++i){\n\t\tscanf(\"%d\",&s);\n\t\tt|=s-1<<(i<<1);\n\t\tfor(j=0;j<4;++j){scanf(\"%d\",&a[i][j]);--a[i][j];}\n\t}\n\tmemset(d,0x3f,sizeof(d));d[t]=0;\n\tQ.push(node(t));\n\twhile(!Q.empty()&&!ok){\n\t\th=Q.top().x;Q.pop();\n\t\tfor(i=0;i<12;++i){\n\t\t\tt1=(h>>(i<<1))&3;p=a[i][t1];t=h^(t1<<(i<<1))^(nxt(t1)<<(i<<1));\n\t\t\tt2=(h>>(p<<1))&3;t^=(t2<<(p<<1))^(nxt(t2)<<(p<<1));\n            //\u89e3\u7801+\u4ea7\u751f\u65b0\u72b6\u6001\n\t\t\tif(d[t]==0x3f3f){  //A*\u4fdd\u8bc1\u7b2c\u4e00\u6b21\u78b0\u5230\u5c31\u662f\u6700\u4f18\u89e3\n\t\t\t\td[t]=d[h]+1;\n\t\t\t\tpre[t]=h;\n\t\t\t\topt[t]=i+1;\n\t\t\t\tif(!t){ok=1;break;}\n\t\t\t\tQ.push(node(t));\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",d[0]);\n\twhile(pre[t]){\n\t\tst[++sl]=opt[t];\n\t\tt=pre[t];\n\t}\n\twhile(sl>=0)printf(\"%d \",st[sl--]);\n\treturn 0;\n}\n```\n\n~~A*\u597d\u50cf\u540a\u6253BFS~~",
        "postTime": 1565766505,
        "uid": 57926,
        "name": "Thinking",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5507 \u3010\u673a\u5173\u3011"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8\uff1aP5507 \u673a\u5173](https://www.luogu.com.cn/problem/P5507)\n\n\u770b\u4e86\u4e00\u904d\u9898\u89e3\u4e4b\u540e\u53d1\u73b0\u5927\u5bb6\u7684\u4ee3\u7801\n\n## \u90fd\u5f88\u957f\n\n\u6211\u7684\u601d\u8def\u5462\u5176\u5b9e\u4e5f\u5c31\u662f\u53cc\u5411\u641c\u7d22\uff0c\u9898\u89e3\u91cc\u4e5f\u6709\u4e00\u4f4d dalao \u5199\u4e86\uff0c\u4f46\u662f\u4f4d\u8fd0\u7b97\u5176\u5b9e\u6ca1\u6709\u5fc5\u8981\u90a3\u4e48\u9ebb\u70e6\uff0c\u6ca1\u6709\u5fc5\u8981\u628a\u4e24\u4e2a\u8bb0\u5f55\u72b6\u6001\u7684\u6570\u7ec4\u5408\u5e76\uff0c\u4e24\u4e2a\u4e5f\u4e0d\u4f1a\u8d85\u7a7a\u95f4\uff0c\u65f6\u95f4\u8fd8\u5feb\u4e00\u70b9\uff0c\u76f8\u5f53\u4e8e\u7528\u7a7a\u95f4\u6362\u65f6\u95f4\n\n\u63a5\u4e0b\u6765\u662f\u6211\u7684\u601d\u8def\n\n## \u72b6\u6001\u538b\u7f29\n\n\u9996\u5148\u662f\u72b6\u6001\u7684\u5b58\u50a8\u95ee\u9898\uff0c\u6709 12 \u4e2a\u65cb\u94ae\uff0c\u6211\u53d1\u73b0\u57fa\u672c\u4e0a\u72b6\u6001\u538b\u7f29\u6709\u8fd9\u51e0\u79cd\uff1a\n\n1. \u5341\u8fdb\u5236\u5b58\uff0c\u4e00\u4f4d\u4e00\u4e2a\u65cb\u94ae\uff0c\u5f88\u660e\u663e 12 \u4f4d\u4e0d\u80fd\u7528\u6570\u7ec4\u53bb\u5224\u91cd\uff0c\u5f97\u7528 $map$ \uff0c\u53c8\u591a\u4e86\u4e00\u4e2a $logn$ \u7684\u590d\u6742\u5ea6\u6211\u4e5f\u4e0d\u77e5\u9053\u8fd9\u4f4d\u5144\u5f1f\u600e\u4e48\u60f3\u51fa\u6765\u7684\uff0c\u5f88\u660e\u663e\u4e0d\u884c\u554a\uff0c\u800c\u4e14\u8fd8\u9ebb\u70e6\uff0c\u4e0d\u8fc7\u5e94\u8be5\u8fd8\u662f\u80fd\u5f97 80 \u5206\n2. \u5b57\u7b26\u4e32\uff0c\u4e00\u4f4d\u4e00\u4e2a\u65cb\u94ae\uff0c\u8fd9\u4e2a\u7a0d\u5fae\u8fd8\u597d\u4e00\u70b9\uff0c\u4f46\u662f\u8fd8\u662f\u5f97\u7528 $map$ \uff0c\u6216\u8005\u5176\u5b9e\u53ef\u4ee5\u5b57\u7b26\u4e32\u54c8\u5e0c\uff0c\u4f46\u662f\u6ca1\u6709\u5fc5\u8981\uff0c\u7528 $map$ \u7684\u8bdd\uff0c\u542f\u53d1\u5f0f\u641c\u7d22\u80fd\u8fc7\uff0c\u4f46\u662f\u53cc\u5411 $bfs$ \u53ea\u80fd\u6709 80 \u5206\n3. \u56db\u8fdb\u5236\u5b58\uff0c\u4e00\u4f4d\u4e00\u4e2a\u65cb\u94ae\uff0c\u56db\u4e2a\u72b6\u6001 1234 \u5bf9\u5e94 0123 \uff0c\u8fd9\u4e5f\u662f\u5927\u5bb6\u7684\u4e3b\u6d41\u7684\u505a\u6cd5\uff0c\u6211\u4e5f\u662f\u8fd9\u4e48\u505a\u7684\n\n\u8fd9\u91cc\u5c31\u4e0d\u5199\u524d\u4e24\u79cd\u7684\u5b9e\u73b0\u4e86\uff0c\u6211\u4eec\u770b\u4e0b\u7b2c\u4e09\u79cd\u5404\u79cd\u64cd\u4f5c\u7684\u5b9e\u73b0\n\n\u8bfb\u5165\uff1a\n\n```cpp\nfor(int i=1;i<=12;i++)\n{\n    scanf(\"%d\", &t);\n    b+=(t-1)<<(tmp<<1);//\u521d\u59cb\u5316\u72b6\u6001\n    //\u56e0\u4e3a\u6211\u4eec\u662f\u5012\u7740\u5b58\u7684\uff0c\u6240\u4ee5\u5c31\u7528tmp\u6765\u8bb0\u5f55\u73b0\u5728\u662f\u7b2c\u51e0\u4f4d\n    //\u8981\u662f\u6ca1\u770b\u61c2\u53ef\u4ee5\u81ea\u5df1\u624b\u63a8\u4e00\u4e0b\n    tmp++;\n    for(int j=1;j<=4;j++)\n        scanf(\"%d\", p[i]+j);//\u5b58\u50a8\u54ea\u4e9b\u6309\u94ae\u4f1a\u8054\u52a8\n}\n```\n\n\u7ed9\u72b6\u6001 $x$ \u53d6\u51fa\u7b2c $w$ \u4f4d\uff1a\n\n```cpp\n(x>>((w-1)<<1))&3//3\u7684\u4e8c\u8fdb\u5236\n```\n\n\u628a\u4e00\u4f4d\u626d\u52a8\u4e00\u4e0b\uff08\u4e0d\u5904\u7406\u8054\u52a8\uff09\uff1a\n\n```cpp\ninline void add(int &s, int w)\n{//\u72b6\u6001s\u7684\u7b2cw\u4f4d\n\tint num=(s>>((w-1)<<1))&3;//\u53d6\u51fa\u72b6\u6001\n\ts-=num*(1<<((w-1)<<1));//\u7f6e\u62100\n\tnum++;//\u5982\u679c\u662f4\u8bf4\u660e\u5e94\u8be5\u8f6c\u4e86\u4e00\u5708\u53d8\u62100\uff0c\u4e5f\u5c31\u4e0d\u7528\u518d\u6539\u4e86\n\tif(num!=4)s+=num*(1<<((w-1)<<1));//+1\n}\n```\n\n\u5904\u7406\u8054\u52a8\uff1a\n\n```cpp\ninline int niu(int s, int w)\n{//\u5176\u5b9e\u5c31\u662f\u626d\u4e24\u4e2a\n\tadd(s, p[w][((s>>((w-1)<<1))&3)+1]);\n\tadd(s, w);\n\treturn s;\n}\n```\n\n\u53cd\u7740\u626d\uff1a\n\n```cpp\ninline int fniu(int s, int w)\n{//\u5176\u5b9e\u5c31\u662f\u4e00\u4f4d\u52a0\u4e09\u6b21\uff0c\u61d2\u5f97\u518d\u5199\u4e00\u4e2a\u4e86\n\tfor(int i=1;i<=3;i++)\n\t\tadd(s, w);\n\tfor(int i=1;i<=3;i++)\n\t\tadd(s, p[w][((s>>((w-1)<<1))&3)+1]);\n\treturn s;\n}\n```\n\n\u72b6\u6001\u538b\u7f29\u6ca1\u4ec0\u4e48\u95ee\u9898\u4e86\uff0c\u63a5\u4e0b\u6765\u662f\u641c\u7d22\n\n## \u53cc\u5411\u641c\u7d22\n\n\u5355\u9879\u7206\u641c\u80af\u5b9a\u662f\u4e0d\u884c\u7684\uff0c\u6709\u4e9b dalao \u7528\u542f\u53d1\u5f0f\u641c\u7d22\uff0c\u6211\u6ca1\u60f3\u51fa\u6765\uff0c\u5c31\u5199\u4e86\u4e00\u4e2a\u53cc\u5411\u641c\u7d22\n\n\u53cc\u5411\u641c\u7d22\u4ecb\u7ecd\u6211\u89c9\u5f97\u8fd8\u662f\u770b\u522b\u7684\u9898\u89e3\u91cc\u7684 dalao \u5427\uff0c\u6211\u5c31\u662f\u8bf4\u4e00\u4e0b\u7b80\u5355\u7684\u601d\u60f3\uff0c\u601d\u8def\u5c31\u662f\u4ece\u8d77\u59cb\u72b6\u6001\u548c\u76ee\u6807\u72b6\u6001\u540c\u65f6\u5f00\u59cb\u641c\u7d22\uff0c\u5047\u5982\u641c\u5230\u6709\u4e00\u72b6\u6001\uff08\u8bbe\u5b83\u4e3a $s$ \uff09\u4e24\u8fb9\u90fd\u641c\u8fc7\uff0c\u90a3\u4e48\u6700\u5c11\u6b65\u6570\u5c31\u662f\u8d77\u59cb\u72b6\u6001\u5230 $s$ \u7684\u6700\u5c11\u6b65\u6570 $+s$ \u5230\u76ee\u6807\u72b6\u6001\u7684\u6700\u5c11\u6b65\u6570\uff0c\u6211\u4eec\u7528\u4e24\u4e2a\u961f\u5217\u6765\u641c\u7d22\u8fd9\u4e24\u8fb9\uff08\u6211\u4e60\u60ef\u7ed9\u8ddf\u4ece\u521d\u59cb\u72b6\u6001\u5f00\u59cb\u641c\u7d22\u7684\u6709\u5173\u7684\u8d77\u540d\u90fd\u52a0\u4e0a\u540e\u7f00 $b$ \uff0c\u53e6\u4e00\u4e2a\u52a0\u4e0a\u540e\u7f00 $e$ \uff0c\u961f\u5217\u524d\u7f00\u52a0\u4e0a $q$ \uff0c\u5224\u91cd\u7684\u6570\u7ec4\u8d77\u540d $vis$\uff09\n\n\u770b\u4e86\u53cc\u5411\u641c\u7d22\u5e94\u8be5\u4e5f\u4e86\u89e3\u4e86\u5982\u4f55\u6c42\u6700\u5c11\u6b65\u6570\uff0c\u4f46\u662f\u95ee\u9898\u662f\u9898\u76ee\u8fd8\u8981\u6c42\u6211\u4eec\u8f93\u51fa\u626d\u52a8\u7684\u8def\u5f84\uff0c\u90a3\u8be5\u600e\u4e48\u529e\u5462\uff0c\u60f3\u4e86\u51e0\u5929\u60f3\u660e\u767d\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u8bb0\u5f55\u6bcf\u4e2a\u72b6\u6001\u7684\u4e0a\u4e00\u4e2a\u72b6\u6001\uff0c\u518d\u8bb0\u5f55\u6bcf\u4e2a\u72b6\u6001\u662f\u4e0a\u4e2a\u72b6\u6001\u626d\u52a8\u4e86\u54ea\u4e2a\u6309\u94ae\u5f97\u5230\u7684\uff0c\u8fd9\u6837\u6211\u4eec\u5148\u641c\u7d22\uff1a\n\n```cpp\nqb.push(b), qe.push(e);\nvisb[b]=true, vise[e]=true;\nwhile(!qb.empty() && !qe.empty())\n{\n    b=qb.front(), qb.pop();\n    e=qe.front(), qe.pop();\n    if(visb[b] && vise[b])\n    {\n        p=b;\n        break;\n    }\n    if(visb[e] && vise[e])\n    {\n        p=e;\n        break;\n    }\n    for(int i=1;i<=12;i++)\n    {//\u679a\u4e3e\u8f6c\u52a8\u54ea\u4e00\u4e2a\u6309\u94ae\n        pushb(niu(b, i), i);//\u53c2\u89c1\u540e\u9762\n        pushe(fniu(e, i), i);\n    }\n}\n```\n\n$pushb\\ pushe$\uff1a\n\n```cpp\ninline void pushb(int x, int w)\n{\n\tif(visb[x])return;\n\tqb.push(x);\n\tvisb[x]=true;//\u5224\u91cd\n\tfromb[x]=b;//\u4ece\u54ea\u6765\n\tcb[x]=w;//\u600e\u4e48\u6765\n}\ninline void pushe(int x, int w)\n{\n\tif(vise[x])return;\n\tqe.push(x);\n\tvise[x]=true;\n\tfrome[x]=e;\n\tce[x]=w;\n}\n```\n\n\u7136\u540e\u518d\u7528\u627e\u5230\u7684\u72b6\u6001 $p$ \u5bf9\u8def\u5f84\u8fdb\u884c\u904d\u5386\uff0c\u8f93\u51fa\uff1a\n\n```cpp\nint cnt1=0;\nint s=p;\nwhile(s!=xb)//xb\u662f\u521d\u59cb\u72b6\u6001\n{\n    a[++cnt1]=cb[s];\n    s=fromb[s];\n}\nint cnt2=cnt1;\ns=p;\nwhile(s!=xe)//xe\u662f\u76ee\u6807\u72b6\u6001\n{\n    a[++cnt2]=ce[s];\n    s=frome[s];\n}\nprintf(\"%d\\n\", cnt2);\nfor(int i=cnt1;i>=1;i--)//\u6ce8\u610f\u8981\u5012\u7740\n    printf(\"%d \", a[i]);\nfor(int i=cnt1+1;i<=cnt2;i++)\n    printf(\"%d \", a[i]); \n```\n\n\u4e8e\u662f\u6240\u6709\u95ee\u9898\u5c31\u90fd\u89e3\u51b3\u4e86\uff0c\u5b8c\u6574\u4ee3\u7801\uff1a\n\n```cpp\n#include<queue>\n#include<cstdio>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nconst int MXN=(1<<24)+10;\nint p[20][10];\nint b, e;\nqueue<int>qb, qe;\nbool visb[MXN], vise[MXN];\nint fromb[MXN], frome[MXN];\nint cb[MXN], ce[MXN];\nint a[int(1e6)+100];\ninline void add(int &s, int w)\n{\n\tint num=(s>>((w-1)<<1))&3;\n\ts-=num*(1<<((w-1)<<1));\n\tnum++;\n\tif(num!=4)s+=num*(1<<((w-1)<<1));\n}\ninline int niu(int s, int w)\n{\n\tadd(s, p[w][((s>>((w-1)<<1))&3)+1]);\n\tadd(s, w);\n\treturn s;\n}\ninline int fniu(int s, int w)\n{\n\tfor(int i=1;i<=3;i++)\n\t\tadd(s, w);\n\tfor(int i=1;i<=3;i++)\n\t\tadd(s, p[w][((s>>((w-1)<<1))&3)+1]);\n\treturn s;\n}\ninline void pushb(int x, int w)\n{\n\tif(visb[x])return;\n\tqb.push(x);\n\tvisb[x]=true;\n\tfromb[x]=b;\n\tcb[x]=w;\n}\ninline void pushe(int x, int w)\n{\n\tif(vise[x])return;\n\tqe.push(x);\n\tvise[x]=true;\n\tfrome[x]=e;\n\tce[x]=w;\n}\nint main()\n{\n\tint t, tmp=0;\n\tfor(int i=1;i<=12;i++)\n\t{\n\t\tscanf(\"%d\", &t);\n\t\tb+=(t-1)<<(tmp<<1);\n\t\ttmp++;\n\t\tfor(int j=1;j<=4;j++)\n\t\t\tscanf(\"%d\", p[i]+j);\n\t}\n\tint p, xb=b, xe=e;\n\tqb.push(b), qe.push(e);\n\tvisb[b]=true, vise[e]=true;\n\twhile(!qb.empty() && !qe.empty())\n\t{\n\t\tb=qb.front(), qb.pop();\n\t\te=qe.front(), qe.pop();\n\t\tif(visb[b] && vise[b])\n\t\t{\n\t\t\tp=b;\n\t\t\tbreak;\n\t\t}\n\t\tif(visb[e] && vise[e])\n\t\t{\n\t\t\tp=e;\n\t\t\tbreak;\n\t\t}\n\t\tfor(int i=1;i<=12;i++)\n\t\t{\n\t\t\tpushb(niu(b, i), i);\n\t\t\tpushe(fniu(e, i), i);\n\t\t}\n\t}\n\tint cnt1=0;\n\tint s=p;\n\twhile(s!=xb)\n\t{\n\t\ta[++cnt1]=cb[s];\n\t\ts=fromb[s];\n\t}\n\tint cnt2=cnt1;\n\ts=p;\n\twhile(s!=xe)\n\t{\n\t\ta[++cnt2]=ce[s];\n\t\ts=frome[s];\n\t}\n\tprintf(\"%d\\n\", cnt2);\n\tfor(int i=cnt1;i>=1;i--)\n\t\tprintf(\"%d \", a[i]);\n\tfor(int i=cnt1+1;i<=cnt2;i++)\n\t\tprintf(\"%d \", a[i]); \n\treturn 0;\n}\n```",
        "postTime": 1613786163,
        "uid": 389050,
        "name": "cszhpdx",
        "ccfLevel": 0,
        "title": "P5507\u673a\u5173\u9898\u89e3"
    },
    {
        "content": "\u6838\u5fc3\u5c31\u50cf\u524d\u9762\u51e0\u4f4d\u5927\u4f6c\u8bf4\u7684\uff0c\u662fA_*\uff0c\u542f\u53d1\u5f0f\u641c\u7d22\uff0c\u6211\u8fd8\u662f\u60f3\u7ed9\u5404\u4f4d\u50cf\u6211\u4e00\u6837\u7684\u83dc\u9e21\u666e\u53ca\u4e00\u4e0b\u542f\u53d1\u5f0f\u641c\u7d22\u3002\n\n\u4ec0\u4e48\u662f\u542f\u53d1\u5f0f\u641c\u7d22\uff08heuristic  search\uff09\n\n\u3000\u3000\u5229\u7528\u5f53\u524d\u4e0e\u95ee\u9898\u6709\u5173\u7684\u4fe1\u606f\u4f5c\u4e3a\u542f\u53d1\u5f0f\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u662f\u80fd\u591f\u63d0\u5347\u67e5\u627e\u6548\u7387\u4ee5\u53ca\u51cf\u5c11\u67e5\u627e\u6b21\u6570\u7684\u3002\n\n\u5982\u4f55\u4f7f\u7528\u8fd9\u4e9b\u4fe1\u606f\uff0c\u6211\u4eec\u5b9a\u4e49\u4e86\u4e00\u4e2a\u4f30\u4ef7\u51fd\u6570 h(x) \u3002h(x)\u662f\u5bf9\u5f53\u524d\u72b6\u6001x\u7684\u4e00\u4e2a\u4f30\u8ba1\uff0c\u8868\u793a x\u72b6\u6001\u5230\u76ee\u6807\u72b6\u6001\u7684\u8ddd\u79bb\u3002\n\n\u6709\uff1a1\u3001h(x) >= 0 \uff1b  2\u3001h(x)\u8d8a\u5c0f\u8868\u793a x \u8d8a\u63a5\u8fd1\u76ee\u6807\u72b6\u6001\uff1b 3\u3001\u5982\u679c h(x) ==0 \uff0c\u8bf4\u660e\u8fbe\u5230\u76ee\u6807\u72b6\u6001\u3002\n\n\u4e0e\u95ee\u9898\u76f8\u5173\u7684\u542f\u53d1\u5f0f\u4fe1\u606f\u90fd\u88ab\u8ba1\u7b97\u4e3a\u4e00\u5b9a\u7684 h(x) \u7684\u503c\uff0c\u5f15\u5165\u5230\u641c\u7d22\u8fc7\u7a0b\u4e2d\u3002\n\n\u3000\u3000\u7136\u800c\uff0c\u6709\u4e86\u542f\u53d1\u5f0f\u4fe1\u606f\u8fd8\u4e0d\u884c\uff0c\u8fd8\u9700\u8981\u8d77\u59cb\u72b6\u6001\u5230 x \u72b6\u6001\u6240\u82b1\u7684\u4ee3\u4ef7\uff0c\u6211\u4eec\u79f0\u4e3a g(x) \u3002\u6bd4\u5982\u5728\u8d70\u8ff7\u5bab\u95ee\u9898\u3001\u516b\u6570\u7801\u95ee\u9898\uff0c\u6211\u4eec\u7684 g(x) \u5c31\u662f\u4ece\u8d77\u70b9\u5230 x \u4f4d\u7f6e\u82b1\u7684\u6b65\u6570 \uff0ch(x) \u5c31\u662f\u4e0e\u76ee\u6807\u72b6\u6001\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u6216\u8005\u76f8\u5dee\u7684\u6570\u76ee\uff1b\u5728\u6700\u77ed\u8def\u5f84\u4e2d\uff0c\u6211\u4eec\u7684 g(x) \u5c31\u662f\u5230 x \u70b9\u7684\u6743\u503c\uff0ch(x)  \u5c31\u662f x \u70b9\u5230\u76ee\u6807\u7ed3\u70b9\u7684\u6700\u77ed\u8def\u6216\u76f4\u7ebf\u8ddd\u79bb\u3002\n\n\u3000\u3000\u73b0\u5728\uff0c\u4ece h(x) \u548c g(x) \u7684\u5b9a\u4e49\u4e2d\u4e0d\u80fd\u770b\u51fa\uff0c\u5047\u5982\u6211\u4eec\u641c\u7d22\u4f9d\u636e\u4e3a F(x) \u51fd\u6570\u3002\n\n\u3000\u3000\u5f53 F(x) = g(x) \u7684\u65f6\u5019\u5c31\u662f\u4e00\u4e2a\u7b49\u4ee3\u4ef7\u641c\u7d22\uff0c\u5b8c\u5168\u662f\u6309\u7167\u82b1\u4e86\u591a\u5c11\u4ee3\u4ef7\u53bb\u641c\u7d22\u3002\u6bd4\u5982 bfs\uff0c\u6211\u4eec\u6bcf\u6b21\u90fd\u662f\u4ece\u79bb\u5f97\u8fd1\u7684\u5c42\u5f00\u59cb\u641c\u7d22\uff0c\u4e00\u5c42\u4e00\u5c42\u641c \uff1b\u4ee5\u53cadijkstra\u7b97\u6cd5\uff0c\u4e5f\u662f\u4f9d\u636e\u6bcf\u6761\u8fb9\u7684\u4ee3\u4ef7\u5f00\u59cb\u9009\u62e9\u641c\u7d22\u65b9\u5411\u3002 \n\n\u3000\u3000\u5f53F(x) = h(x) \u7684\u65f6\u5019\u5c31\u76f8\u5f53\u4e8e\u4e00\u4e2a\u8d2a\u5a6a\u4f18\u5148\u641c\u7d22\u3002\u6bcf\u6b21\u90fd\u662f\u5411\u6700\u9760\u8fd1\u76ee\u6807\u7684\u72b6\u6001\u9760\u8fd1\u3002\n\n\u3000\u3000\u4eba\u4eec\u53d1\u73b0\uff0c\u7b49\u4ee3\u4ef7\u641c\u7d22\u867d\u7136\u5177\u6709\u5b8c\u5907\u6027\uff0c\u80fd\u627e\u5230\u6700\u4f18\u89e3\uff0c\u4f46\u662f\u6548\u7387\u592a\u4f4e\u3002\u8d2a\u5a6a\u4f18\u5148\u641c\u7d22\u4e0d\u5177\u6709\u5b8c\u5907\u6027\uff0c\u4e0d\u4e00\u5b9a\u80fd\u627e\u5230\u89e3\uff0c\u6700\u574f\u7684\u60c5\u51b5\u4e0b\u7c7b\u4f3c\u4e8edfs\u3002\n\n\u3000\u3000\u8fd9\u65f6\u5019\uff0c\u6709\u4eba\u63d0\u51fa\u4e86A\u7b97\u6cd5\u3002\u4ee4F(x) = g(x) + h(x) \u3002\uff08\u8fd9\u91cc\u7684 h(x) \u6ca1\u6709\u9650\u5236\uff09\u3002\u867d\u7136\u63d0\u9ad8\u4e86\u7b97\u6cd5\u6548\u7387\uff0c\u4f46\u662f\u4e0d\u80fd\u4fdd\u8bc1\u627e\u5230\u6700\u4f18\u89e3\uff0c\u4e0d\u9002\u5408\u7684 h(x)\u5b9a\u4e49\u4f1a\u5bfc\u81f4\u7b97\u6cd5\u627e\u4e0d\u5230\u89e3\u3002\u4e0d\u5177\u6709\u5b8c\u5907\u6027\u548c\u6700\u4f18\u6027\u3002\n\n\u3000\u3000\u51e0\u5e74\u540e\u6709\u4eba\u63d0\u51fa\u4e86 A*\u7b97\u6cd5\u3002\u8be5\u7b97\u6cd5\u4ec5\u4ec5\u5bf9A\u7b97\u6cd5\u8fdb\u884c\u4e86\u5c0f\u5c0f\u7684\u4fee\u6539\u3002\u5e76\u8bc1\u660e\u4e86\u5f53\u4f30\u4ef7\u51fd\u6570\u6ee1\u8db3\u4e00\u5b9a\u6761\u4ef6\uff0c\u7b97\u6cd5\u4e00\u5b9a\u80fd\u627e\u5230\u6700\u4f18\u89e3\u3002\u4f30\u4ef7\u51fd\u6570\u6ee1\u8db3\u4e00\u5b9a\u6761\u4ef6\u7684\u7b97\u6cd5\u79f0\u4e3aA*\u7b97\u6cd5\u3002\n\n\u5b83\u7684\u9650\u5236\u6761\u4ef6\u662f F(x) = g(x) + h(x) \u3002 \u4ee3\u4ef7\u51fd\u6570g(x) >0 \uff1bh(x) \u7684\u503c\u4e0d\u5927\u4e8ex\u5230\u76ee\u6807\u7684\u5b9e\u9645\u4ee3\u4ef7 h*(x) \u3002\u5373\u5b9a\u4e49\u7684 h(x) \u662f\u53ef\u7eb3\u7684\uff0c\u662f\u4e50\u89c2\u7684\u3002\n\n\u600e\u4e48\u7406\u89e3\u7b2c\u4e8c\u4e2a\u6761\u4ef6\u5462\uff1f\n\n\u3000\u3000\u6253\u4e2a\u6bd4\u65b9\uff1a\u4f60\u8981\u4ecex\u8d70\u5230\u76ee\u7684\u5730\uff0c\u90a3\u4e48 h(x) \u5c31\u662f\u4f60\u611f\u89c9\u6216\u8005\u76ee\u6d4b\u5927\u6982\u8981\u8d70\u7684\u8ddd\u79bb\uff0ch*(x) \u5219\u662f\u4f60\u5230\u8fbe\u76ee\u7684\u5730\u540e\uff0c\u53d1\u73b0\u4f60\u5b9e\u9645\u8d70\u4e86\u7684\u8ddd\u79bb\u3002\u4f60\u9884\u60f3\u7684\u8ddd\u79bb\u4e00\u5b9a\u662f\u6bd4\u5b9e\u9645\u8ddd\u79bb\u77ed\uff0c\u6216\u8005\u521a\u597d\u7b49\u4e8e\u5b9e\u9645\u8ddd\u79bb\u7684\u503c\u3002\u8fd9\u6837\u6211\u4eec\u79f0\u4f60\u7684 h(x) \u662f\u53ef\u7eb3\u7684\uff0c\u662f\u4e50\u89c2\u7684\u3002\n\n\u3000\u4e0d\u540c\u7684\u4f30\u4ef7\u51fd\u6570\u5bf9\u7b97\u6cd5\u7684\u6548\u7387\u53ef\u80fd\u4ea7\u751f\u6781\u5927\u7684\u5f71\u54cd\u3002\u5c24\u5176\u662f h(x) \u7684\u9009\u5b9a\uff0c\u6bd4\u5982\u5728\u63a5\u4e0b\u6765\u7684\u516b\u6570\u7801\u95ee\u9898\u4e2d\uff0c\u6211\u4eec\u9009\u62e9\u4e86\u66fc\u54c8\u987f\u8ddd\u79bb\u4e4b\u548c\u4f5c\u4e3a h(x) \uff0c\u4f60\u4e5f\u53ef\u4ee5\u9009\u62e9\u76f8\u5dee\u7684\u683c\u5b50\u4f5c\u4e3a h(x)\uff0c\u53ea\u4e0d\u8fc7\u641c\u7d22\u7684\u6b21\u6570\u4f1a\u4e0d\u540c\u3002\u5f53 h(x) \u8d8a\u63a5\u8fd1 h*(x) \uff0c\u90a3\u4e48\u6269\u5c55\u7684\u7ed3\u70b9\u8d8a\u5c11\uff01\n \n \u4ee5\u4e0a\u642c\u8fd0\u81eaCNblogs\u7684ISGuXing\u5927\u4f6c\uff0c\u53ef\u4ee5\u53bb\n \n [\u542f\u53d1\u5f0f\u641c\u7d22](https://www.cnblogs.com/ISGuXing/p/9800490.html)\n \n \u770b\u5b8c\u4e86\u76f8\u4fe1\u5927\u5bb6\u5c31\u80fd\u5f88\u660e\u767d\u4ec0\u4e48\u662f\u542f\u53d1\u5f0f\u641c\u7d22\u3002\n \n \u90a3\u4e48\u5bf9\u4e8e\u672c\u9898\uff0c\u5bfb\u627eh\uff08x\uff09\u65b9\u7a0b\u8fd8\u662f\u6bd4\u8f83\u5bb9\u6613\u7684\uff0c\u5c31\u662f\u6240\u6709\u70b9\u8f6c\u52301\u9700\u8981\u7684\u6700\u5c11\u6b65\u6570\u6574\u96642\uff0c\u8fd9\u4e9b\u4e0a\u9762\u7684\u5927\u4f6c\u90fd\u6709\u63d0\u5230\u3002\n \n \u6211\u8fd9\u8fb9\u4e3b\u8981\u662f\u60f3\u8bf4\u4e00\u8bf4\u8fd9\u9053\u9898\u7684\u5751\u70b9\uff1a\n \n 1.\u8fd9\u9053\u9898\u663e\u7136\u9700\u8981\u7528\u4e00\u4e2a\u96c6\u5408\u8868\u793a\u5df2\u7ecf\u8bbf\u95ee\u8fc7\u7684\u4e00\u4e2a\u72b6\u6001\uff0c\u6700\u5bb9\u6613\u60f3\u5230\u7684\u662f\u7528\u4e00\u4e2along long\u768412\u4f4d\u6574\u6570\u6765\u50a8\u5b58\u6bcf\u4e00\u4f4d\uff0c\u4f46\u662f\u8fd9\u6837\u7684\u8bdd\u65e0\u6cd5\u5f00\u6570\u7ec4\uff0c\u53ea\u80fd\u7528set\u6216\u8005map\uff0c\u5bf9\u8fd9\u9053\u9898\u6765\u8bf4\uff0c\u5f88\u53ef\u80fd\u5bfc\u81f4\u8d85\u65f6\uff08\u56e0\u4e3a\u4f1a\u591a\u4e00\u4e2alog\u7684\u5e38\u6570\uff09\uff0c\u6240\u4ee5\u8003\u8651\u4f7f\u7528\u54c8\u5e0c\uff0c\u65b9\u7a0b\u5982\u4e0b\n \n ```cpp\nll standd = 0;\nfor (int j = 1; j <= 12; j++)\n{\n\tstandd = (standd<<2) + to.fx[j];\n}\nif (vis[standd])\n\tcontinue;\nvis[standd]=true;\n```\n\u8ba1\u7b97\u4e00\u4e0b\u5c31\u77e5\u9053\uff0c\u6700\u5dee\u7684\u60c5\u51b5\uff0c\u5373\u5168\u662f4\uff0c\u6211\u4eec\u4e5f\u53ea\u9700\u898116380\u5c31\u591f\u4e86\uff0c\u663e\u7136\u662f\u53ef\u4ee5\u901a\u8fc7\u6570\u7ec4\u6765\u5b9e\u73b0O\uff081\uff09\u7684\u8bbf\u95ee\u7684\uff0c\u6240\u4ee5\u5f00\u4e00\u4e2avis\u6570\u7ec4\u5c31\u53ef\u4ee5\u4e86\u3002\n\n2.\u672c\u9898\u8981\u6c42\u8bb0\u5f55\u8def\u5f84\uff0c\u8fd9\u4e5f\u662fbfs\u7b97\u6cd5\u7684\u4e00\u4e2a\u96be\u70b9\uff0c\u4f46\u662f\u7531\u4e8e\u6bcf\u4e2a\u72b6\u6001\u53ea\u4f1a\u51fa\u73b0\u4e00\u6b21\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u628a\u6bcf\u4e2a\u70b9\u7684\u7236\u8282\u70b9\u8bb0\u5f55\u4e0b\u6765\uff0c\u5e76\u8bb0\u5f55\u7236\u8282\u70b9\u7684\u884c\u4e3a\uff08\u5373\u6539\u52a8\u4e86\u54ea\u4e2a\u6570\u5b57\uff09\uff0c\u540c\u6837\u7684\uff0c\u5229\u7528\u524d\u9762\u54c8\u5e0c\u7684\u7ed3\u679c\uff0c\u6211\u4eec\u5f00\u4e24\u4e2a\u6570\u7ec4\u5373\u53ef\uff0c\u8fd9\u6837\u5c31\u907f\u514d\u4e86map\u7684log\u5e38\u6570\u3002\n```cpp\nto.stand = standd;\nfa[standd] = from.stand;\nflag[standd] = i;\n```\n\u7c7b\u4f3c\u8fd9\u6837\uff0c\u5177\u4f53\u7684\u53ef\u4ee5\u770b\u5b8c\u6574\u4ee3\u7801\u7684\u5b9e\u73b0\u3002\n \n ```cpp\n#include<iostream>\n#include<stdio.h>\n#include<algorithm>\n#include<queue>\n#include<map>\n#include<set>\n#include<stack>\n#include<string.h>\nusing namespace std;\n#define ll long long\n#define MAX INT_MAX/2\n#define MOD 99999997\n#define eps 1e-8\n#define INF 1e9\n#define N1 105 \n#define N 55\nstruct node\n{\n\tint fx[13];\n\tint num;\n\tint h;\n\tll stand;\n\tbool operator < (const node& b) const\n\t{\n\t\treturn num + h > b.num + b.h;\n\t}\n};\npriority_queue<node>pq;\nint inp[13][5];\nstack<int>ans;\nint fa[70000000];\nint flag[70000000];\nbool vis[70000000];\ninline void con(node& a)\n{\n\tint kk = 0;\n\tfor (int i = 1; i <= 12; i++)\n\t{\n\t\tif (a.fx[i] != 1)\n\t\t\tkk += 5 - a.fx[i];\n\t}\n\ta.h = ((kk - 1) >> 1) + 1;\n}\ninline int _next(int x)\n{\n\treturn x==4?1:x+1;\n}\nint main()\n{\n\tnode now;\n\tfor (int i = 1; i <= 12; i++)\n\t\tscanf(\"%d%d%d%d%d\", &now.fx[i], &inp[i][1], &inp[i][2], &inp[i][3], &inp[i][4]);\n\t\n\tnow.num = 0;\n\tcon(now);\n\tpq.push(now);\n\twhile (!pq.empty())\n\t{\n\t\tnode from = pq.top();\n\t\tpq.pop();\n\n\n\n\t\tif (from.h == 0)\n\t\t{\n\t\t\tprintf(\"%d\\n\", from.num);\n\n\t\t\tll noww = from.stand;\n\t\t\tfor (int i = 1; i <= from.num; i++)\n\t\t\t{\n\t\t\t\tans.push(flag[noww]);\n\t\t\t\tnoww = fa[noww];\n\t\t\t}\n\t\t\tfor (int i = 1; i <= from.num; i++)\n\t\t\t{\n\t\t\t\tprintf(\"%d \", ans.top());\n\t\t\t\tans.pop();\n\t\t\t}\n\t\t\treturn 0;\n\t\t}\n\t\tfor (int i = 1; i <= 12; i++)\n\t\t{\n\t\t\tnode to = from;\n\t\t\tto.num++;\n\t\t\tto.fx[inp[i][to.fx[i]]]=_next(to.fx[inp[i][to.fx[i]]]);\n\t\t\tto.fx[i]=_next(to.fx[i]);\n\n\t\t\tll standd = 0;\n\t\t\tfor (int j = 1; j <= 12; j++)\n\t\t\t{\n\t\t\t\tstandd = (standd<<2) + to.fx[j];\n\t\t\t}\n\t\t\tif (vis[standd])\n\t\t\t\tcontinue;\n\t\t\tvis[standd]=true;\n\t\t\tto.stand = standd;\n\t\t\tfa[standd] = from.stand;\n\t\t\tflag[standd] = i;\n\t\t\tcon(to);\n\t\t\tpq.push(to);\n\t\t}\n\t}\n\treturn 0;\n}\n\n```\n\u6700\u540e\u60f3\u8bf4\u4e00\u53e5\uff0c\u624b\u5199\u5806\u7684\u8bdd\u6548\u679c\u4f1a\u66f4\u597d\uff0c\u5f53\u7136\u4e0d\u5230\u4e07\u4e0d\u5f97\u5df2\u7684\u60c5\u51b5\u8fd8\u662f\u5efa\u8bae\u4f18\u5148\u961f\u5217\u5427\uff0c\u6bd5\u7adf\u65b9\u4fbf\u3002\n ",
        "postTime": 1584340764,
        "uid": 140852,
        "name": "tyno\u590f",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5507 \u3010\u673a\u5173\u3011"
    },
    {
        "content": "\u57fa\u672c\u601d\u8def\u548c\u7b97\u6cd5\uff08A*\uff09\u5927\u4f6c\u4eec\u90fd\u8bb2\u7684\u5f88\u8be6\u7ec6\u4e86\uff0c\u4e0a\u9762\u7684\u4ee3\u7801\u5199\u7684\u4e5f\u5f88\u6e05\u695a\uff0c\u8fd9\u91cc\u5c31\u63d0\u4f9b\u4e00\u4e2a\u5c0f\u5c0f\u7684\u4f46\u5f88\u5b9e\u7528\u4f18\u5316\u3002\n\n\u79bbAC\u53ea\u5dee\u4e00\u6b65\u7684\u53ef\u4ee5\u6765\u770b\u770b\n\n\u300a\u7b97\u6cd5\u7ade\u8d5b\u8fdb\u9636\u6307\u5357\u300b\u7b2c124\u9875\u5199\u5230\u201c\u4f30\u4ef7\u51fd\u6570\u7684\u4f30\u503c\u4e0d\u80fd\u5927\u4e8e\u672a\u6765\u7684\u5b9e\u9645\u4ef7\u503c\u201d\uff0c\u4f46\u5728\u8fd9\u9898\u4e2d\uff0c\u7a0d\u7a0d\u63d0\u9ad8\u4e00\u70b9\u4f30\u503c\u53ef\u4ee5\u5927\u5927\u63d0\u9ad8\u7a0b\u5e8f\u8fd0\u884c\u6548\n\n[\u4f18\u5316\u524d](https://www.luogu.org/record/23140709)\n\n[\u4f18\u5316\u540e](https://www.luogu.org/record/23154481)\n\n\u4f18\u5316\u524d\u540e\u6548\u7387\u5feb\u4e86\u5c06\u8fd1\u4e00\u500d\uff0c\u800c\u4f18\u5316\u6240\u505a\u7684\u6240\u6709\u6539\u53d8\u5c31\u662f\u5728\u4f30\u4ef7\u51fd\u6570\u4e0a\u4e58\u4e86\u4e00\u4e2a\u7cfb\u6570\n\n\u4e00\u822c\u7684\u4f30\u4ef7\u51fd\u6570\uff1a\u6bcf\u4e2a\u65cb\u94ae\u8ddd\u79bb\u76ee\u6807\u72b6\u6001\uff081\uff09\u7684\u5dee\u503c\u4e4b\u548c\u9664\u4ee52\uff08\u53d6\u4e0a\u6574\uff09\n```cpp\nbool operator < (const e &a) const {\n      return s + (v >> 1) + (v & 1) > a.s + (a.v >> 1) + (a.v & 1);\n}\n```\n\u6ce8\uff1a\n\n1\u3001s\u6307\u5f53\u524d\u72b6\u6001\u5df2\u7ecf\u64cd\u4f5c\u7684\u6b21\u6570\uff0cv\u8868\u793a\u6bcf\u4e2a\u65cb\u94ae\u8ddd\u79bb\u76ee\u6807\u72b6\u6001\u7684\u5dee\u503c\u4e4b\u548c\uff08\u4f30\u4ef7\u51fd\u6570\uff09\n\n2\u3001\u52a0\u4e0a\uff08v&1\uff09\u662f\u4e3a\u4e86\u53d6\u4e0a\u6574\uff08\u4e5f\u8bb8\u6ca1\u4ec0\u4e48\u7528\uff09\n\n3\u3001\u8be5\u6bd4\u8f83\u51fd\u6570\u5199\u5728\u7ed3\u6784\u4f53\u4e2d,\u7ed3\u6784\u4f53\u540d\u79f0\u4e3ae\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u8fd9\u4e2a\u4f30\u4ef7\u51fd\u6570\u662f\u4e00\u4e2a\u5f88\u7f8e\u597d\u7684\u7406\u60f3\u72b6\u6001\uff08\u6bcf\u6b21\u64cd\u4f5c\u90fd\u8ba9\u4e24\u4e2a\u65cb\u94ae\u5411\u76ee\u6807\u72b6\u6001\u9760\u8fd1\uff09\uff0c\u4f46\u73b0\u5b9e\u4e2d\u5f88\u96be\u8fbe\u5230\uff0c\u53ef\u4ee5\u8ba9\u4f30\u503c\u66f4\u51c6\u786e\u4e00\u4e9b\uff0c\u4e8e\u662f\u6211\u5728 v \u4e0a\u4e58\u4e00\u4e2a\u7a0d\u5927\u4e8e1\u7684\u7cfb\u6570\uff081.1, 1.2, 1.3\uff09\u5747\u53ef\uff08\u4e0b\u9762\u4ee3\u7801\u4e2d\u5199\u76841.3\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u6bd4\u8f83\u5feb\uff09\uff0c\u53ef\u4ee5\u81ea\u5df1\u8c03\u8bd5\n\n\u53d8\u6210\u8fd9\u6837\uff1a\n```cpp\nbool operator < (const e &a) const {\n      return s + (v >> 1) * 1.3 + (v & 1) > a.s + (a.v >> 1) * 1.3 + (a.v & 1);\n}\n```\n\n\u5c0f\u5c0f\u7684\u6539\u53d8\u5c31\u4e0a\u6548\u7387\u5927\u5927\u63d0\u9ad8\uff0c\u5feb\u4e86\u5c06\u8fd1400ms\uff08\u6570\u636e\u6700\u5927\u7684\u70b9\u5feb\u4e86300ms\uff0c~~\u867d\u7136\u5de8\u4f6c\u4eec\u603b\u7528\u65f6\u90fd\u4e0d\u5230300ms~~\uff09\n\n\u5176\u4ed6\u4ee3\u7801\u5c31\u4e0d\u653e\u4e86\uff0c\u4e0a\u9762\u7684\u5199\u5f97\u597d\u770b\u591a\u4e86qwq",
        "postTime": 1566448379,
        "uid": 84619,
        "name": "\u6e05\u5c18",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5507 \u3010\u673a\u5173\u3011"
    },
    {
        "content": "# [P5507 \u673a\u5173](https://www.luogu.com.cn/problem/P5507)\n\n\u8fd9\u9053\u9898\u662f\u4e00\u9053\u6bd4\u8f83\u7ecf\u5178\u7684\u542f\u53d1\u5f0f\u641c\u7d22\uff0c\u7528\u6700\u57fa\u672c\u7684 $A*$ \u6765\u89e3\u51b3\n\n## \u524d\u7f6e\u829d\u58eb\uff1abfs\n\n\u666e\u901a bfs \u90fd\u4e0d\u4f1a\u6253\u7684\u8bdd\u5148\u53bb\u5b66 bfs \u53ed\u2026\u2026\n\n\n## - \u542f\u53d1\u5f0f\u641c\u7d22\n\n\u5728\u666e\u901a bfs \u4e2d\uff0c\u7a0b\u5e8f\u4f1a\u904d\u5386\u51e0\u4e4e\u6240\u6709\u7684\u72b6\u6001\u3002\u65e0\u8bba\u8fd9\u4e2a\u72b6\u6001\u662f\u4ec0\u4e48\uff0c\u7a0b\u5e8f\u90fd\u4e00\u89c6\u540c\u4ec1\u3002\n\n\u800c\u542f\u53d1\u5f0f\u641c\u7d22\u5462\uff0c\u5c31\u662f\u8ba9\u4f60\u7684\u7a0b\u5e8f\u4e0d\u8981\u50bb\u4e4e\u4e4e\u7684\u53bb\u641c\u90a3\u4e9b\u6839\u672c\u4e0d\u53ef\u80fd\u6216\u4e0d\u662f\u6700\u4f18\u89e3\u7684\u72b6\u6001\u3002\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5047\u8bbe\u4e00\u4e2a\u72b6\u6001\u7528\u4e00\u4e2a\u4e8c\u8fdb\u5236\u516d\u4f4d\u6570\u8868\u793a\u3002\u4f60\u7684\u7a0b\u5e8f\u8981\u627e\u7684\u662f $1110110$ ,\u73b0\u5728\u6709 $1100001$ \u548c $1110111$\u3002\u663e\u7136\u7684\uff0c\u540e\u8005\u80fd\u66f4\u5feb\u5230\u8fbe\u76ee\u6807\uff0c\u4f46\u662f\u4f60\u7684\u7a0b\u5e8f\u4f1a\u5148\u9047\u5230\u524d\u8005\uff0c\u56e0\u6b64\u4f1a\u5148\u641c\u524d\u8005\uff0c\u8fd9\u6837\u4f1a\u6d6a\u8d39\u6389\u5f88\u591a\u65e0\u7528\u7684\u65f6\u95f4\u3002\n\n\u800c\u542f\u53d1\u5f0f\u641c\u7d22\uff0c\u7ed9\u4f60\u7684\u4e00\u4e2a\u7a0b\u5e8f\u4e00\u4e2a\u4f30\u4ef7\u51fd\u6570\uff0c\u8ba9\u4f60\u7684\u7a0b\u5e8f\u80fd\u6b63\u786e\u7684\u5bf9\u6bcf\u4e2a\u72b6\u6001\u505a\u51fa\u4e00\u4e2a\u4f30\u8ba1\u503c\u3002\u5c31\u62ff\u4e0a\u8fb9\u90a3\u4e2a\u4f8b\u5b50\u6765\u8bf4\u7a0b\u5e8f\u8981\u627e\u7684\u662f $1110110$\uff0c\u90a3\u4e48\u53ef\u4ee5\u628a\u4f30\u4ef7\u51fd\u6570 $h(x)$ \u8bbe\u8ba1\u4e3a   $h(x) = $ **\u4e0e\u76ee\u6807\u4e8c\u8fdb\u5236\u72b6\u6001\u76f8\u540c\u4f4d\u6570\u7684\u4e2a\u6570**\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u5f53\u76ee\u6807\u72b6\u6001\u4e3a $1110110$ \u65f6 $h(1100001) = 3$ \u800c  $h(1110111) = 6$\uff0c \u663e\u7136\u5730\uff0c\u540e\u8005\u66f4\u4f18\uff0c\u7a0b\u5e8f\u4f1a\u5148\u641c\u540e\u8005\uff0c\u8fd9\u6837\u53ef\u4ee5\u8282\u7701\u5927\u91cf\u65f6\u95f4\u3002\n\n\u90a3\u8bf4\u4e86\u90a3\u4e48\u591a\uff0c\u8be5\u600e\u4e48\u5b9e\u73b0\u5462\uff1f\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u7528**\u4f18\u5148\u961f\u5217**\uff0c\u5c06\u72b6\u6001\u4e0e\u4f30\u4ef7\u51fd\u6570\u6253\u5305\u5728\u4e00\u8d77\u6254\u8fdb\u961f\u5217\uff0c\u7136\u540e\u50cf bfs \u4e00\u6837\u641c\u5c31\u5f73\u4e8d\u4e86\u3002\n\n\u867d\u7136\u590d\u6742\u5ea6\u770b\u8d77\u6765\u591a\u4e86\u4e00\u4e2a log \uff0c\u4f46\u6392\u9664\u4e86\u5927\u91cf\u65e0\u7528\u72b6\u6001\uff0c\u6240\u4ee5\u6bd4\u666e\u901a bfs \u5feb\u5f88\u591a\u3002\n\n## \u672c\u9898\n\n\u56de\u5230\u672c\u9898\uff0c\u5982\u679c\u7528\u666e\u901a bfs \u5b9e\u73b0\u5f88\u7b80\u5355\uff0c\u4f46\u662f\u4f1a\u8d85\u65f6\u8fd9\u91cc\u5c31\u4e0d\u7ec6\u8bf4\u4e86\u3002\u8fd9\u91cc\u4e3b\u8981\u8bf4\u4e00\u4e0b\u4f30\u4ef7\u51fd\u6570\u8bbe\u8ba1\u3002\n\n\u9898\u76ee\u4e2d\u6bcf\u4e2a\u6309\u94ae\u6309\u4e00\u4e0b\u72b6\u6001\u90fd\u53ef\u4ee5\u770b\u505a\u6a21 $4$ \u518d\u52a0\u4e00\uff0c\u800c\u72b6\u6001\u90fd\u4e3a  $1$ \u65f6\u8fbe\u5230\u76ee\u6807\u72b6\u6001\u3002\u90a3\u4e48\u4f30\u4ef7\u51fd\u6570\u53ef\u4ee5\u8bbe\u8ba1\u4e3a\uff1a**\u6240\u6709\u6309\u94ae\u8981\u53d8\u5230 $1$ \u81f3\u5c11\u65cb\u8f6c\u6b21\u6570\u603b\u548c**  \u3002\u8fd9\u6837\uff0c\u66f4\u4f18\u7684\u72b6\u6001\u5c31\u4f1a\u66f4\u65e9\u641c\u5230\u3002\n\n\u672c\u9898\u8fd8\u6709\u5f88\u591a\u7ec6\u8282\uff0c\u90a3\u5177\u4f53\u7ec6\u8282\u89c1\u4ee3\u7801\u5427 \u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <algorithm>\n#include <iostream>\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <stack>\n#include <queue>\n#include <vector>\n#include <list>\n#include <map>\nusing namespace std;\n#define ll long long\nmap<string, bool>mp ; //\u53bb\u91cd\nint nw[20][10] ; // \u4e8c\u7ef4\u6570\u7ec4\u8868\u793a\nstring zh(){\n\tstring s = \"\" ;\n\tfor(int i = 1 ; i <= 12 ; i++){\n\t\tchar nxa = nw[i][1] / 10 + '0' , nxb = nw[i][1] % 10 + '0' ;\n\t\ts += ' ' ;\n\t\ts += nxa ;\n\t\ts += nxb ;\n\t}\n\treturn s ;\n} // \u72b6\u6001\u8f6c\u5316\u5b57\u7b26\u4e32\u4fbf\u4e8e\u5224\u91cd\nstruct node{\n\tint a[20][10], num, gj;\n\tstring fa = \"\" ;\n};\nnode temp ;\nnode st ;\nint h(){ // \u4f30\u4ef7\u51fd\u6570\n\tint ret = 0 ;\n\tfor(int i = 1 ; i <= 12 ; i++)ret += (5 - nw[i][1]) % 4;\n\treturn ret ; \n}\nbool check(){\n\tfor(int i = 1 ; i <= 12 ; i++)if(nw[i][1] != 1)return 0 ;\n\treturn 1 ;\n}\nbool operator <(node a, node b){return a.gj > b.gj ;} //\u7ed3\u6784\u4f53\u6bd4\u8f83\u91cd\u8f7d\u8fd0\u7b97\u7b26\uff0c\u5c0f\u6839\u5806\npriority_queue<node>q ;\nint main(){\n\tfor (int i = 1 ; i <= 12 ; i++)\n\t   for (int j = 1 ; j <= 5 ; j++)\n\t      cin >> st.a[i][j] ;\n\tq.push(st) ;\n\tmp[zh()] = 1 ;\n\twhile(!q.empty()){ // \u57fa\u672c bfs \u641c\u7d22\n\t\tfor (int i = 1 ; i <= 12 ; i++)\n\t\t   for (int j = 1 ; j <= 5 ; j++)\n\t\t      nw[i][j] = q.top().a[i][j] ; //nw \u8868\u793a\u5f53\u524d\u72b6\u6001\n\t\tint nm = q.top().num ;\n\t\tif(check()){\n\t\t\tcout << nm << '\\n' << q.top().fa;\n\t\t\treturn 0 ;\n\t\t} //\u82e5\u5168\u662f 1 \u4e86\uff0c\u8f93\u51fa\n\t\tstring nww = q.top().fa ;\n\t\tq.pop() ;\n\t\tfor(int i = 1; i <= 12 ; i++){ // \u679a\u4e3e\u65cb\u8f6c 12 \u4e2a\u6309\u94ae\n\t\t\tint now = nw[i][1] ;\n\t\t\tint now2 = nw[nw[i][now + 1]][1] ;\n\t\t\tnw[nw[i][now + 1]][1] = nw[nw[i][now + 1]][1] % 4 + 1;\n\t\t\tnw[i][1] = nw[i][1] % 4 + 1 ;\n\t\t\tif(mp.find(zh()) == mp.end() ){//\u5c0f\u7ec6\u8282\uff0c\u5982\u679c\u76f4\u63a5\u8bbf\u95ee\u4e0b\u6807\uff0c\u4f1a\u76f4\u63a5\u628a\u5f53\u524d\u72b6\u6001\u63d2\u5165\u5230 map \u4e2d\uff0c\u7a0b\u5e8f\u5c31\u4f1a\u53d8\u6162\u3002\u6709\u7684\u9898\u4f1a\u76f4\u63a5 T \u6389\uff08CF525E\uff09\u5f53\u7136\uff0cunordered_map \u5c31\u6ca1\u5173\u7cfb\u4e86\n\t\t\t\tfor(int j = 1 ; j <= 12 ; j++)for(int k = 1 ; k <= 5 ; k++)temp.a[j][k] = nw[j][k] ;\n\t\t\t\ttemp.gj = h() + nm + 1 ; \n\t\t\t\ttemp.num = nm + 1 ;\n\t\t\t\tchar nxa = i / 10 + '0' , nxb = i % 10 + '0' ;\n\t\t\t\tif(i < 10)temp.fa = nww + nxb + ' ';\n\t\t\t\telse temp.fa = nww + nxa + nxb + ' ';\n\t\t\t\tq.push(temp) ; // \u7b97\u51fa\u4e0b\u4e00\u4e2a\u72b6\u6001\uff0c\u62d3\u5c55\n\t\t\t\tmp[zh()] = 1 ;\n\t\t\t}\n\t\t\tnw[i][1] = now ; nw[nw[i][now + 1]][1] = now2 ;\n\t\t}\n\t}\n\treturn 0 ;\n}\n```\n\n\u53e6\u5916\u95ee\u4e00\u4e0b\uff0c\u8fd9\u4e2a\u4ee3\u7801[\u5f00 O2](https://www.luogu.com.cn/record/77590756)\n\u8fd8\u4e0d\u5982[\u4e0d\u5f00 O2](https://www.luogu.com.cn/record/77590776)\u5feb\uff0c\u6709\u6ca1\u6709\u795e\u7287\u77e5\u9053\u4ec0\u4e48\u539f\u56e0",
        "postTime": 1655604250,
        "uid": 632162,
        "name": "quarmer",
        "ccfLevel": 0,
        "title": "[P5507 \u673a\u5173]\u9898\u89e3"
    },
    {
        "content": "### \u8fd9\u662f\u9053\u5f88\u597d\u7684\u641c\u7d22\u7ec3\u624b\u9898  \n\u53ef\u4ee5\u7528\u5e7f\u4e3a\u4eba\u77e5\u7684\u641c\u7d22~~\u4e09\u5de8\u5934~~\u6c42\u89e3 \u3002  \n- \u53cc\u5411\u641c\u7d22 \u3002\n- IDA* \uff08~~\u5728\u8fd9\u9898\u8c8c\u4f3c\u88ab\u7981\u4e86~~\uff09\u3002\n- A* \u3002  \n\n\u8fd9\u7bc7\u9898\u89e3\u4e3b\u8981\u4ecb\u7ecd\u7528 **A_star** \u7b97\u6cd5 AC \u8fd9\u9053\u9898 \u3002  \n## 1. \u601d\u8def  \n\u7528 **\u7ed3\u6784\u4f53** \u8bb0\u5f55 **\u8def\u5f84** **\u72b6\u6001** \u3002   \n\u4ee5\u53ca\u5b9e\u9645\u6b65\u6570 $\\textbf{g(n)}$ \u548c\u4f30\u4ef7\u6b65\u6570 $\\textbf{h(n)}$ \u3002  \n\u6211\u4eec\u90fd\u77e5\u9053 A* \u7b97\u6cd5\u7684\u6838\u5fc3\u5728\u4e8e\u5176\u4f30\u4ef7\u51fd\u6570 $\\textbf{h(n)}$ \u3002   \n\u6bcf\u6b21\u53d6\u51fa\u5bf9\u5e94 $g(n) + h(n)$ **\u6700\u5c0f\u7684** \u8fdb\u884c\u4e0b\u4e00\u6b65\u641c\u7d20 \u3002  \n\n\u5f15\u51fa\u4e00\u4e2a\u7591\u60d1 \uff1a  \n\u6bcf\u6539\u53d8\u4e00\u4e2a\u673a\u5173\u7684\u72b6\u6001\u90fd\u4f1a\u6709\u53e6\u4e00\u4e2a\u673a\u5173\u8ddf\u7740\u6539\u53d8 \u3002  \n\u90a3\u4e48\u4f30\u4ef7\u51fd\u6570\u5982\u4f55\u6c42\u89e3 \uff1f  \n\u770b\u4f5c\u662f\u4e24\u4e2a\u4e00\u8d77\u53d8\u6362 \u3002  \n\u53ef\u4ee5 **\u7528\u5f53\u524d\u72b6\u6001\u8ddd\u79bb\u76ee\u6807\u72b6\u6001\u7684\u7406\u60f3\u5dee\u503c\u9664\u53bb $2$ \u5f97\u5230** \u3002\n\n## 2.\u89e3\u6cd5  \n\u4f7f\u7528\u4f18\u5148\u961f\u5217\u5b58\u50a8\u7ed3\u6784\u4f53 \u3002  \n\u6240\u4ee5\u6211\u4eec\u9700\u8981 **\u91cd\u8f7d\u8fd0\u7b97\u7b26**  \uff1a \n```cpp\nbool operator<(const node &a,const node &b){\n\treturn a.g+a.h>b.g+b.h;\n}\n```  \n\u7ecf\u68c0\u9a8c \uff1a  \n\u7531\u4e8e\u770b\u4f5c\u4e24\u4e2a\u673a\u5173\u540c\u65f6\u5411\u7740\u76ee\u6807\u524d\u8fdb **\u8fc7\u4e8e\u7406\u60f3** \u3002  \n\u6b64\u9898\u7684\u4f30\u4ef7\u51fd\u6570\u53ef\u4ee5\u7a0d\u5fae\u8c03\u9ad8\u4e00\u4e9b\uff0c\u7528\u4e8e\u4f18\u5316\u65f6\u95f4\u590d\u6742\u5ea6 \u3002  \n\u53c2\u6570\u4e3a\u539f\u4f30\u4ef7\u51fd\u6570\u7684 $\\textbf{1.3}$ \u500d \u3002  \n\u4f46\u6b64\u65f6\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4ecd\u9ad8\u4e86\u4e9b \u3002  \n\u6240\u4ee5\u6700\u540e\u52a0\u4e0a **map \u53bb\u91cd** \u5373\u53ef \u3002\n## 3. Code\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nstruct node{\n\tstring state;//\u72b6\u6001 \n\tstring path;//\u8def\u5f84 \n\tint g;//\u5b9e\u9645\u6b65\u6570 \n\tint h;//\u4f30\u4ef7\u51fd\u6570 \n};\nmap<string,bool> mark;\n//\u91cd\u8f7d\u8fd0\u7b97\u7b26 \nbool operator<(const node &a,const node &b){\n\treturn a.g+a.h>b.g+b.h;\n}\npriority_queue<node> q;\n//\u4f30\u4ef7\u51fd\u6570 \nint eva(string s){\n    int cnt=0;\n    for(int i=1;i<=12;i++)\n        if(s[i]!='1') cnt+=5-(int)(s[i]-48);\n    return cnt/2*1.3;\n}\nvoid print(node s){\n\tprintf(\"%d\\n\",s.g);\n\tfor(int i=0;i<s.path.size();i++) cout<<(int)(s.path[i]-48)<<\" \";\n}\nint main(){ \n\tint gear[13][5];//\u673a\u5173\u89e6\u53d1\u673a\u5236 \n\tnode start;\n\tstart.state+=(char)(48);\n\tfor(int i=1;i<=12;i++)\n\t\tfor(int j=1;j<=5;j++){\n\t\t\tint x;scanf(\"%d\",&x);\n\t\t\tif(j==1) start.state+=(char)(x+48);\n\t\t\telse gear[i][j-1]=x;\n\t\t}\n\tstart.g=0;\n\tstart.h=eva(start.state);\n\tif(!start.h){printf(\"0\");return 0;}\n\tmark[start.state]=true;\n\tq.push(start);\n\twhile(!q.empty()){\n\t\tnode a=q.top();q.pop();\n\t\tfor(int i=1;i<=12;i++){\n\t\t\t//\u89e6\u53d1\u673a\u5173 \n\t\t\tint x=(int)(a.state[i]-48);//x\u4e3ai\u673a\u5173\u7684\u72b6\u6001 \n\t\t\tint j=gear[i][x];//j\u4e3ai\u673a\u5173\u7684\u8fde\u9501\u673a\u5173 \n\t\t\tint y=(int)(a.state[j]-48);//y\u4e3aj\u673a\u5173\u7684\u72b6\u6001\n\t\t\t//\u6539\u53d8\u72b6\u6001 \n\t\t\tif(x==4) x=1;\n\t\t\telse x+=1;\n\t\t\tif(y==4) y=1;\n\t\t\telse y+=1;\n\t\t\t \n\t\t\tnode s;//\u8f6c\u6362\u5165\u961f\u5217 \n\t\t\ts.state+=(char)(48);\n\t\t\tfor(int u=1;u<=12;u++){\n\t\t\t\tif(u==i){s.state+=(char)(x+48);continue;}\n\t\t\t\tif(u==j){s.state+=(char)(y+48);continue;}\n\t\t\t\ts.state+=a.state[u];\n\t\t\t}\n\t\t\t\n\t\t\tif(!mark[s.state]){//map\u53bb\u91cd \n\t\t\t\ts.g=a.g+1;\n\t\t\t\ts.h=eva(s.state);\n\t\t\t\tmark[s.state]=true;\n\t\t\t\ts.path=a.path+(char)(i+48);\n\t\t\t\tif(!s.h){print(s);return 0;}\n\t\t\t\tq.push(s);\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n} \n```\n",
        "postTime": 1648995030,
        "uid": 392796,
        "name": "Think",
        "ccfLevel": 4,
        "title": "P5507 \u673a\u5173 \u9898\u89e3"
    },
    {
        "content": "[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5507)\n\n\u6bd5\u8bbe\u8001\u5e08\u8ba9\u6211\u505a MAPF\uff0c\u7531\u4e8e\u5b66\u4e86\u597d\u591a A\\* \u7b97\u6cd5\u7684\u53d8\u5f62\uff0c\u5c31\u8fc7\u6765\u505a\u4e00\u505a\u4e86\u3002\n\n\u8fd9\u9898\u7528\u7684\u662f EPEA\\*\uff08Enhanced Partial Expansion A\\*\uff09\u7b97\u6cd5\u3002\n\n---\n\n**\u3010\u5206\u6790\u3011**\n--\n\n\u663e\u7136\u641c\u7d22\u80fd\u8fc7\uff0c\u4f46\u662f\u72b6\u6001\u7a7a\u95f4\u592a\u5927\u4e86\u3002\u4e00\u773c\u53ef A\\*\u3002\n\n\u8003\u8651\u6240\u6709\u673a\u5173\u7684\u72b6\u6001\u4e3a $s_i$ \u65f6\uff1a\n\n\u82e5\u6ca1\u6709\u8fde\u9501\u53cd\u5e94\uff0c\u6700\u5c11\u6b65\u6570\u4e3a $\\displaystyle h_1(\\boldsymbol s)=\\sum_i((5-s_i)\\bmod 4)$\u3002\n\n\u73b0\u5728\u7531\u4e8e\u6709\u8fde\u9501\u53cd\u5e94\uff0c\u6211\u4eec\u8bbe\u8ba1\u4f30\u4ef7\u51fd\u6570\u7684\u65f6\u5019\u9700\u8981\u4fdd\u8bc1\u4f30\u4ef7\u51fd\u6570\u7684\u7ed3\u679c\u4e0d\u5927\u4e8e\u771f\u5b9e\u6b65\u6570\uff1b\n\n\u4e3a\u6b64\uff0c\u6211\u4eec\u8003\u8651\u6700\u4f18\u60c5\u51b5\u4e0b\uff0c\u6bcf\u6b21\u8f6c\u52a8\u4e00\u4e2a\u673a\u5173\u4f1a\u5bfc\u81f4\u53e6\u4e00\u4e2a\u673a\u5173\u8ddf\u7740\u8f6c\u52a8\uff1b\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7b49\u4ef7\u4e8e\u6ca1\u6709\u8fde\u9501\u53cd\u5e94\u7684\u60c5\u51b5\u4e0b\u8f6c\u4e24\u6b21\u3002\n\n\u56e0\u6b64\u4f30\u4ef7\u51fd\u6570\u53ef\u4ee5\u8bbe\u8ba1\u4e3a $\\displaystyle h_2(\\boldsymbol s)={1\\over 2}h_1(\\boldsymbol s)$\u3002\n\n\u5f53\u7136\uff0c\u6211\u4eec\u77e5\u9053\uff0c\u4f30\u4ef7\u51fd\u6570\u5728\u4e0d\u8d85\u8fc7\u771f\u5b9e\u503c\u7684\u60c5\u51b5\u4e0b\uff0c\u4f30\u4ef7\u51fd\u6570\u7684\u503c\u8d8a\u5927\uff0c\u641c\u7d22\u6548\u7387\u8d8a\u9ad8\u3002\u56e0\u6b64\uff0c\u5bf9\u4e8e\u5947\u6570\u7684 $h_1(\\boldsymbol s)$\uff0c\u6211\u4eec\u76f4\u63a5\u53d6\u4e0a\u53d6\u6574\uff0c\u56e0\u6b64\u8bbe\u8ba1\u51fa\u4f30\u4ef7\u51fd\u6570\uff1a\n\n$\\displaystyle h_2(\\boldsymbol s)=\\lceil{1\\over 2}h_1(\\boldsymbol s)\\rceil$\u3002\n\n---\n\n\u6211\u4eec\u8003\u8651\u4e00\u4e0b\u4e00\u822c\u7684 A\\* \u7b97\u6cd5\uff0c\u5728\u72b6\u6001 $S$ \u4e0b\uff0c\u901a\u8fc7\u7ef4\u62a4\u5f53\u524d\u8017\u6563 $g_S$ \u548c\u5bf9\u4e8e\u540e\u7eed\u64cd\u4f5c\u7684\u4f30\u8ba1\u8017\u6563 $h_S$\uff0c\u5171\u540c\u7ec4\u5408\u6210\u603b\u671f\u671b\u8017\u6563 $f_S=g_S+h_S$\u3002\n\n\u901a\u8fc7\u5bf9\u5f85\u6269\u5c55\u72b6\u6001\u7684\u603b\u671f\u671b\u8017\u6563\u8fdb\u884c\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u4f18\u5148\u62d3\u5c55\u603b\u671f\u671b\u8017\u6563\u8f83\u5c0f\u7684\u72b6\u6001\u3002\n\nEPEA\\* \u5219\u662f\u5728\u6b64\u57fa\u7840\u4e0a\u52a8\u6001\u8c03\u6574\u81ea\u8eab\u7684\u540e\u7eed\u4f30\u4ef7\u8017\u6563\uff0c\u4ece\u800c\u8fbe\u5230\u52a8\u6001\u8c03\u6574\u603b\u671f\u671b\u8017\u6563\u7684\u7ed3\u679c\u3002\n\n\u5728\u62d3\u5c55\u4e00\u4e2a\u72b6\u6001 $S$ \u65f6\uff0cEPEA\\* \u5bf9\u4e8e\u5176\u6240\u6709\u540e\u7ee7\u72b6\u6001 $\\{T_i\\}$\uff0cEPEA\\* \u53ea\u62d3\u5c55\u6ee1\u8db3\u6761\u4ef6 $f_S=f_{T_i}$ \u7684\u540e\u7ee7\u72b6\u6001\u3002\n\n\u7531\u4e8e A\\* \u4e2d\uff0c\u4f30\u4ef7\u51fd\u6570\u7684\u7ed3\u679c\u662f\u4e0d\u8d85\u8fc7\u771f\u5b9e\u503c\u7684\uff0c\u56e0\u6b64\u4e0d\u53ef\u80fd\u5b58\u5728 $f_S>f_{T_i}$ \u7684\u60c5\u51b5\u3002\n\n\u800c\u5bf9\u4e8e\u5176\u4ed6\u603b\u671f\u671b\u8017\u6563\u66f4\u5927\u7684\u540e\u7ee7\u72b6\u6001\uff0c\u53ef\u80fd\u4e5f\u80fd\u4ea7\u751f\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u3002\u4e3a\u6b64\uff0c\u6211\u4eec\u4fee\u6b63 $h_S$ \u4f7f\u5f97 $f_S$ \u66f4\u65b0\u4e3a\u672a\u9009\u62e9\u7684\u540e\u7ee7\u72b6\u6001\u4e2d\uff0c$f_{T_i}$ \u6700\u5c0f\u7684\u7ed3\u679c\uff1b\u4e4b\u540e\uff0c\u5c06\u4fee\u6b63\u540e\u7684\u5f53\u524d\u8282\u70b9\u91cd\u65b0\u6254\u8fdb\u5f85\u62d3\u5c55\u7684\u961f\u5217\u4e2d\u3002\n\n---\n\n\u5982\u5bf9\u4e8e\u641c\u7d22\u5230\u7684\u67d0\u4e2a\u72b6\u6001 $S$\uff0c\u5176\u5f53\u524d\u8017\u6563 $g_S=5$ \u800c\u6839\u636e\u4f30\u4ef7\u51fd\u6570\u4ea7\u751f\u4e86\u521d\u59cb\u7684\u540e\u7eed\u4f30\u4ef7\u8017\u6563 $h_S=4$\uff0c\u4e8e\u662f $f_S=5+4=9$\u3002\n\n\u5047\u8bbe\u5b83\u5b58\u5728 $3$ \u4e2a\u540e\u7eed\u72b6\u6001 $T_1, T_2, T_3$\uff0c\u4ed6\u4eec\u6839\u636e\u4f30\u4ef7\u51fd\u6570\u4ea7\u751f\u540e\u7eed\u4f30\u4ef7\u8017\u6563 $h_{T_1}=3, h_{T_2}=4, h_{T_3}=5$ \uff1b\u90a3\u4e48\uff0c\u7531\u4e8e\u4ed6\u4eec\u7684\u5f53\u524d\u8017\u6563\u5747\u4e3a $6$\uff0c\u56e0\u6b64\u6709 $f_{T_1}=9, f_{T_2}=10, f_{T_3}=11$\u3002\n\n\u8fd9\u4e00\u6b21\u7684\u62d3\u5c55\u4e2d\uff0c\u6211\u4eec\u4ec5\u62d3\u5c55\u4e86 $T_1$ \u72b6\u6001\u3002\u800c\u5bf9\u4e8e\u6ca1\u62d3\u5c55\u7684\u540e\u7ee7\u72b6\u6001\u4e2d\uff0c\u6700\u5c0f\u7684\u7ed3\u679c\u4e3a $f_{T_2}=10$ \uff1b\u56e0\u6b64\u5728\u62d3\u5c55\u540e\uff0c\u6211\u4eec\u4fee\u6b63 $h_S=5$ \u4f7f\u5f97 $f_S=10$\u3002\n\n\u5f53\u7136\uff0c\u5728\u5177\u4f53\u7684\u5b9e\u73b0\u4e2d\uff0c\u6211\u4eec\u4e0d\u5fc5\u4fee\u6b63 $h_S$ \u7684\u7ed3\u679c\uff0c\u76f4\u63a5\u4fee\u6539 $f_S$ \u7684\u7ed3\u679c\u4e5f\u662f\u7b49\u4ef7\u7684\u3002\n\n---\n\n\u53ef\u4ee5\u53d1\u73b0\uff0cEPEA\\* \u9002\u7528\u4e8e\u904d\u5386\u540e\u7ee7\u72b6\u6001\u8f83\u5feb\uff0c\u4e14\u8bc4\u4f30\u540e\u7ee7\u72b6\u6001\u7684\u4f30\u4ef7\u51fd\u6570\u8f83\u5feb\u7684\u95ee\u9898\u3002\n\n\u5bf9\u4e8e\u8fd9\u9898\u800c\u8a00\uff0c\u7531\u4e8e\u6240\u6709\u72b6\u6001\u7684\u540e\u7ee7\u72b6\u6001\u90fd\u6700\u591a\u4e3a $12$ \u79cd\uff0c\u800c\u4f30\u4ef7\u51fd\u6570\u5bf9\u4e8e\u6bcf\u4e2a\u72b6\u6001\u53ef\u4ee5\u5728 $O(1)$ \u7684\u65f6\u95f4\u5185\u7b97\u51fa\u7ed3\u679c\uff1b\u6070\u597d\u9002\u7528\u4e8e\u8fd9\u9898\u3002\n\n\u6700\u540e\uff0c\u5173\u4e8e\u7b54\u6848\u7684\u7ef4\u62a4\uff0c\u6211\u4eec\u76f4\u63a5\u7ef4\u62a4 $fr_S, pace_S$ \u6570\u7ec4\u5206\u522b\u8868\u793a\u72b6\u6001 $S$ \u662f\u4ece\u72b6\u6001 $fr_S$ \u6cbf\u8fb9 $pace_S$ \u8f6c\u79fb\u800c\u6765\u7684\u3002\n\n\u5f53\u7136\uff0c\u4e3a\u4e86\u907f\u514d\u641c\u7d22\u91cd\u590d\u72b6\u6001\uff0c\u53ef\u4ee5\u518d\u7ef4\u62a4\u6570\u7ec4 $vis_S$ \u8868\u793a\u662f\u5426\u5df2\u7ecf\u8bbf\u95ee\u8fc7\u4e86\u72b6\u6001 $S$\u3002\n\n\u56e0\u4e3a EPEA\\* \u7b97\u6cd5\u4e2d\u4fdd\u8bc1\u4e86\u5bf9\u6bcf\u4e2a\u72b6\u6001\uff0c\u4f18\u5148\u62d3\u5c55\u603b\u671f\u671b\u8017\u6563\u548c\u81ea\u8eab\u4e00\u81f4\u7684\u540e\u7ee7\u3002\u6545\u5f53\u4e00\u4e2a\u540e\u7ee7\u72b6\u6001\u4e00\u65e6\u88ab\u62d3\u5c55\u5230\uff0c\u540e\u7eed\u7684\u62d3\u5c55\u65b9\u6848\u4e2d\uff0c\u5fc5\u7136\u4e0d\u5b58\u5728\u603b\u671f\u671b\u8017\u6563\u66f4\u4f18\u7684\u62d3\u5c55\u65b9\u6848\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bb0\u5f55 $fr_S,pace_S,vis_S$ \u7ed3\u679c\u3002\n\n\u8bba\u6587\u91cc\u63cf\u8ff0\u8be5\u7b97\u6cd5\u5728 MAPF \u4e2d\u5bf9\u4e8e\u72b6\u6001\u7a7a\u95f4\u7684\u6570\u91cf\u4ea7\u751f\u4e86 dramatically reduce\u3002~~\u4f46\u5728\u7b97\u6cd5\u7ade\u8d5b\u9898\u4e2d\uff0c\u5b9e\u6d4b\u597d\u50cf\u6ca1\u90a3\u4e48\u5f3a\uff0c\u751a\u81f3\u4f1a\u66f4\u6162\u3002~~\n\n\u5c31\u5f53\u4f5c\u4f5c\u4e3a\u4e00\u4e2a\u62d3\u5c55\u5427\u3002\n\n---\n\n**\u3010\u4ee3\u7801\u3011**\n--\n\n\u4e3a\u4e86\u5b9e\u73b0\u65b9\u4fbf\uff0c\u4ee3\u7801\u4e2d\u5c06\u673a\u5173\u7684\u72b6\u6001 $1,2,3,4$ \u5206\u522b\u6620\u5c04\u6210\u4e86 $0,1,2,3$\uff0c\u5c06\u673a\u5173 $1\\sim12$ \u5206\u522b\u6620\u5c04\u6210\u4e86 $0\\sim11$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint a[12][4];\ninline int h(int sta) {\n\t//Heuristic Function\n\t/*\n\t  12 * 2 = 24\n\t  24 / 4 = 6\n\t*/\n\tint s1 = (0x444444 - (sta & 0x333333)) & 0x333333;\n\tint s2 = (0x1111110 - (sta & 0xcccccc)) & 0xcccccc;\n\tint tmp = __builtin_popcount((s1 | s2) & 0x555555);\n\tint pace = __builtin_popcount(s1 | s2) * 2 - tmp;\n\treturn pace + 1 >> 1;\n}\ninline int move(int sta, int id) {\n\t//Move the id-th mechanism while the state is sta.\n\tint single_sta = ((sta >> id + id)&3);\n\tint chain = a[id][single_sta];\n\tint chain_sta = ((sta >> chain + chain)&3);\n\t\n\tsingle_sta = (single_sta + 1)&3;\n\tchain_sta = (chain_sta + 1)&3;\n\tint msk = ((3 << id + id) | (3 << chain + chain));\n\treturn sta&(~msk) | (single_sta << id + id) | (chain_sta << chain + chain);\n}\n\nstruct node {\n\tint sta;\n\tint gv, hv, fv;\n\tinline node(int sta_=0, int gv_=0): sta(sta_), gv(gv_) {\n\t\thv=h(sta_);\n\t\tfv=gv+hv;\n\t}\n\tinline friend bool operator < (const node &a, const node &b) {\n\t\treturn a.fv > b.fv;\n\t}\n};\npriority_queue<node> pq;\nint fr[1<<24], pace[1<<24];\nbool vis[1<<24];\ninline void EPEA_star(int sta) {\n\twhile(!pq.empty()) pq.pop();\n\tpq.emplace(sta, 0);\n\tfr[sta]=-1;\n\tpace[sta]=-1;\n\tvis[sta]=1;\n\t\n\twhile(!pq.empty()) {\n\t\tnode now = pq.top(); pq.pop();\n\t\tif(now.sta == 0)//target state\n\t\t\tbreak;\n\t\t\n\t\tint nxtf=-1;\n\t\tfor(int i=0; i<12; ++i) {\n\t\t\tint nxtsta = move(now.sta, i);\n\t\t\tif(vis[nxtsta])\n\t\t\t\tcontinue;\n\t\t\tint f = now.gv + 1 + h(nxtsta);\n\t\t\tif(f < now.fv)//expanded\n\t\t\t\tcontinue;\n\t\t\telse if(f == now.fv) {//expand\n\t\t\t\tpq.emplace(nxtsta, now.gv+1);\n\t\t\t\tfr[nxtsta] = now.sta;\n\t\t\t\tpace[nxtsta] = i;\n\t\t\t\tvis[nxtsta] = 1;\n\t\t\t}\n\t\t\telse if(nxtf == -1)//update the next f-value of this state\n\t\t\t\tnxtf = f;\n\t\t\telse\n\t\t\t\tnxtf = min(nxtf, f);\n\t\t}\n\t\tif(nxtf == -1)//expanded all the successors\n\t\t\tcontinue;\n\t\tnow.fv = nxtf;\n\t\tpq.push(now);\n\t}\n}\nint main() {\n\tios::sync_with_stdio(0);\n\tcin.tie(0); cout.tie(0);\n\tint ini_sta=0;\n\tfor(int i=0; i<12; ++i) {\n\t\tint s;\n\t\tcin>>s;\n\t\tini_sta |= (s-1<<i+i);\n\t\tfor(int j=0; j<4; ++j) {\n\t\t\tcin>>a[i][j];\n\t\t\t--a[i][j];\n\t\t}\n\t}\n\tEPEA_star(ini_sta);\n\t\n\tvector<int> v;\n\tfor(int sta=0; ~fr[sta]; sta=fr[sta])\n\t\tv.push_back(pace[sta]);\n\treverse(v.begin(), v.end());\n\tcout<<v.size()<<\"\\n\";\n\tfor(auto e : v) cout<<e+1<<\" \";\n\treturn 0;\n}\n```",
        "postTime": 1675227986,
        "uid": 36031,
        "name": "JustinRochester",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P5507 \u673a\u5173"
    },
    {
        "content": "\u6c42\u6b65\u6570\u8fd9\u4e00\u90e8\u5206\u53ef\u4ee5\u7528\u53cc BFS \u968f\u4fbf\u4e71\u8fc7\uff0c\u770b\u5176\u4ed6\u9898\u89e3\u8fd8\u53ef\u4ee5\u7528\u5404\u79cd\u725b\u9b3c\u795e\u86c7\u7684\u641c\u7d22\u4e71\u8fc7\uff0c\u5982\u679c\u8fd9\u9053\u9898\u6ca1\u6709\u65b9\u6848\u8f93\u51fa\u5efa\u8bae\u964d\u7eff\u3002\n\n\u968f\u4fbf\u52a0\u4e2a\u526a\u679d\u5c31\u53ef\u4ee5\u4e86\uff0c\u8fd9\u91cc\u6211\u7528\u7684\u662f\u5047\u5982\u5f53\u524d\u60c5\u51b5\u7684\u4f2a\u6700\u591a\u6b65\u6570\uff08\u5373\u6bcf\u4e2a\u673a\u5173\u4e0d\u4f1a\u5e26\u52a8\u5176\u4ed6\u673a\u5173\u8f6c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7684\u6b65\u6570\uff09\u5927\u4e8e\u521d\u59cb\u60c5\u51b5\u7684\u4f2a\u6700\u591a\u6b65\u6570\u3002\n\n~~\u8fd9\u4e2a\u526a\u679d\u5927\u6982\u7387\u662f\u9519\u7684\u4f46\u662f\u53ef\u4ee5\u8fc7\uff0c\u9762\u5411\u6570\u636e\u7f16\u7a0b\u4e86\u5c5e\u4e8e\u662f~~\n\n\u7136\u540e\u8bf4\u4e00\u4e0b\u65b9\u6848\u8f93\u51fa\u3002\n\n\u76f4\u89c2\u6765\u770b\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u662f\u5728 BFS \u65f6\u987a\u4fbf\u8bb0\u5f55\u4e00\u4e0b\u65b9\u6848\uff0c\u5f53\u7136\u4f1a MLE\u3002\n\n\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e0b BFS \u7684\u7b2c\u4e00\u6b21\u641c\u5230\u5373\u4e3a\u6700\u77ed\u7684\u6027\u8d28\u7136\u540e\u5728 map \u8bb0\u5f55\u5f53\u524d\u60c5\u51b5\u6700\u77ed\u6b65\u6570\u65f6\u8bb0\u5f55\u4e00\u4e0b\u662f\u4f7f\u7528\u54ea\u4e2a\u673a\u5173\u624d\u53d8\u5230\u8fd9\u79cd\u60c5\u51b5\u7684\u3002\n\n\u7136\u540e\u8f93\u51fa\u65b9\u6848\u662f\u53ef\u4ee5\u7528\u8fd9\u4e2a\u6765\u5411\u4e0a\u548c\u5411\u4e0b\u67e5\u627e\uff0c\u7c7b\u4f3c\u4e8e\u524d\u5411\u661f\u7684 next \u6570\u7ec4\u3002\n\n\u8fd8\u662f\u770b code \u65b9\u4fbf\u4e00\u70b9\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint change[13][5];\nint gf(int c){return c-1>0?c-1:4;}\nint gb(int c){return c+1<5?c+1:1;}\nstruct m\n{\n\tshort g[13];\n\tbool typ;\n\tvoid tf(int ch)//\u627e\u5982\u679c\u628a ch \u626d\u56de\u53bb\u4f1a\u53d1\u751f\u4ec0\u4e48\n\t{\n\t\tint c=change[ch][gf(g[ch])];\n\t\tg[ch]=gf(g[ch]);\n\t\tg[c]=gf(g[c]);\n\t}\n\tvoid tb(int ch)//\u627e\u5982\u679c\u628a ch \u626d\u8fc7\u6765\u4f1a\u53d1\u751f\u4ec0\u4e48\n\t{\n\t\tint c=change[ch][g[ch]];\n\t\tg[ch]=gb(g[ch]);\n\t\tg[c]=gb(g[c]);\n\t}\n};\nbool operator <(m a,m b)\n{\n\tfor(int i=1;i<=12;i++)\n\t\tif(a.g[i]!=b.g[i]) return a.g[i]<b.g[i];\n\treturn false;\n}\nvoid copy(m &a,m b)\n{\n\tfor(int i=1;i<=12;i++)\t\n\t\ta.g[i]=b.g[i];\n\ta.typ=b.typ;\n}\nmap<m,pair<int,int> >mmp0;\nmap<m,pair<int,int> >mmp1;//\u7b2c\u4e00\u4e2a\u8bb0\u5f55\u4e0a\u4e00\u4e2a\u4f7f\u7528\u7684\u673a\u5173\u3002\u7b2c\u4e8c\u4e2a\u8bb0\u5f55\u6b65\u6570\nqueue<pair<m,int> >que;\nm now,now_,goal={{0,1,1,1,1,1,1,1,1,1,1,1,1},0};\nint st,ss[20],sscnt,fff;\nint check(m a)\n{\n\tint cnt=0;\n\tfor(int i=1;i<=12;i++)\n\t\tcnt+=(a.g[i]-1);\n\treturn cnt;\n}\nint main()\n{\n\tfor(int i=1;i<=12;i++)\n\t{\n\t\tcin>>now.g[i];\n\t\tfor(int j=1;j<=4;j++)\n\t\t\tcin>>change[i][j];\n\t}\n\tnow.typ=1;\n\tfff=check(now)+4;\n\tque.push({now,0});\n\tque.push({goal,0});\n\tmmp0[now].first=-1,mmp0[now].second=-1;\n\tmmp1[goal].first=-1,mmp1[goal].second=-1;\n\twhile(!que.empty())\n\t{\n\t\tnow=que.front().first;\n\t\tst=que.front().second;\n\t\tque.pop();\n\t\tif(now.typ)\n\t\t{\n\t\t\tif(mmp1[now].second!=0)\n\t\t\t{\n\t\t\t\tcopy(now_,now);\n\t\t\t\tif(mmp1[now].second==-1) mmp1[now].second=0;\n\t\t\t\tcout<<mmp1[now].second+st<<endl;\n\t\t\t\twhile(mmp0[now].first!=-1)\n\t\t\t\t\tss[++sscnt]=mmp0[now].first,now.tf(ss[sscnt]);//\u5411\u524d\u627e\n\t\t\t\twhile(sscnt)\n\t\t\t\t\tcout<<ss[sscnt--]<<\" \";\n\t\t\t\twhile(mmp1[now_].first!=-1)\n\t\t\t\t\tcout<<mmp1[now_].first<<\" \",now_.tb(mmp1[now_].first);//\u5411\u540e\u627e\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(mmp0[now].second!=0)\n\t\t\t{\n\t\t\t\tcopy(now_,now);\n\t\t\t\tif(mmp0[now].second==-1) mmp0[now].second=0;\n\t\t\t\tcout<<mmp0[now].second+st<<endl;\n\t\t\t\twhile(mmp0[now].first!=-1)\n\t\t\t\t\tss[++sscnt]=mmp0[now].first,now.tf(ss[sscnt]);\n\t\t\t\twhile(sscnt)\n\t\t\t\t\tcout<<ss[sscnt--]<<\" \";\n\t\t\t\twhile(mmp1[now_].first!=-1)\n\t\t\t\t\tcout<<mmp1[now_].first<<\" \",now_.tb(mmp1[now_].first);//\u540c\u7406\n\t\t\t\treturn 0;\t\n\t\t\t}\n\t\t}\n\t\tfor(int i=1;i<=12;i++)\n\t\t{\n\t\t\tcopy(now_,now);\n\t\t\tif(now_.typ)\n\t\t\t{\n\t\t\t\tnow_.tb(i);\n\t\t\t\tif(mmp0[now_].second==0&&check(now_)<=fff)\n\t\t\t\t{\n\t\t\t\t\tmmp0[now_].first=i;\n\t\t\t\t\tmmp0[now_].second=st+1;\n\t\t\t\t\tque.push({now_,st+1});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tnow_.tf(i);\n\t\t\t\tif(mmp1[now_].second==0&&check(now_)<=fff)\n\t\t\t\t{\n\t\t\t\t\tmmp1[now_].first=i;\n\t\t\t\t\tmmp1[now_].second=st+1;\n\t\t\t\t\tque.push({now_,st+1});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n```",
        "postTime": 1651284790,
        "uid": 167279,
        "name": "Danno0v0",
        "ccfLevel": 7,
        "title": "P5507"
    }
]
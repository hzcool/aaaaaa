[
    {
        "content": "\u7ed9\u5b9a\u5e8f\u5217 $a_{1\\cdots n}$\uff0c\u751f\u6210\u4e00\u5f20 $n$ \u4e2a\u70b9\u7684\u65e0\u5411\u5b8c\u5168\u56fe\uff0c$i,j$ \u4e4b\u95f4\u7684\u8fb9\u6743\u4e3a $\\min\\{a_i\\bmod a_j,a_j\\bmod a_i\\}$\uff0c\u6c42\u6700\u5c0f\u751f\u6210\u6811\u3002\n\n$1\\leq n\\leq 10^5$\uff0c$1\\leq a_i\\leq 10^7$\u3002\n\n\u6734\u7d20\u5730\u627e\u8fb9\u663e\u7136\u6709 $O(n^2)$ \u6761\uff0c\u8003\u8651\u5b9e\u9645\u662f\u5426\u771f\u7684\u6709\u8fd9\u4e48\u591a\u6709\u6548\u8fb9\u3002\n\n\u9996\u5148\u5bf9\u4e8e\u6240\u6709\u6743\u503c\u53bb\u91cd\uff0c\u76f8\u540c\u6743\u503c\u7684\u9ed8\u8ba4\u662f\u540c\u4e00\u4e2a\u70b9\uff0c\u8bb0 $m=\\max\\{a_i\\}$\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6743\u503c $x$\uff0c\u6211\u4eec\u53ef\u4ee5\u53bb\u679a\u4e3e\u5b83\u7684\u500d\u6570 $d$\uff0c\u627e\u5230\u503c\u5728 $[dx,(d+1)x)$ \u5185\u6700\u5c0f\u7684\u6570\uff0c\u8bb0\u4e3a\u4e00\u6761\u6709\u6548\u8fb9\uff0c\u7279\u6b8a\u5730\uff0c$d=1$ \u65f6\u8303\u56f4\u4e3a $(x,2x)$\u3002\n\n\u56e0\u4e3a\u503c\u57df\u5f88\u5c0f\uff0c\u627e\u6570\u8fd9\u4e2a\u64cd\u4f5c\u53ef\u4ee5\u653e\u5230\u6876\u91cc\uff0c\u4ece\u540e\u5f80\u524d\u626b\u4e00\u904d\u5f97\u5230\u3002\n\n\u4e8e\u662f\u8fd9\u6837\u4f1a\u627e\u5230 $O(m\\ln m)$ \u6761\u8fb9\uff0c\u627e\u5230\u4e4b\u540e\u6876\u6392\u505a Kruskal\uff0c\u5c31\u53ef\u4ee5\u505a\u5230 $O(m\\ln m\u00b7\\alpha(n))$\uff0c\u5982\u679c\u53ea\u6709\u8fd9\u4e9b\u6709\u6548\u8fb9\uff0c\u590d\u6742\u5ea6\u548c\u7a7a\u95f4\u90fd\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002\n\n\u8003\u8651\u5982\u4f55\u8bc1\u660e\u8fd9\u6837\u4e00\u5b9a\u4e0d\u52a3\uff0c\u5047\u8bbe\u4e00\u4e2a\u70b9 $a$ \u8fde\u5411\u7684\u4e0d\u662f\u67d0\u4e2a\u500d\u6570\u533a\u95f4\u91cc\u7b2c\u4e00\u4e2a\u6570 $b$\uff0c\u800c\u662f\u9760\u540e\u4e00\u4e9b\u7684 $c$\uff0c\u663e\u7136\u6709 $c>b>a,b\\bmod a< c\\bmod a$\uff0c\u6211\u4eec\u8003\u8651\u628a $a-c$ \u6539\u4e3a $a-b-c$\uff0c\u65b0\u7684\u82b1\u8d39\u662f $c\\bmod b+b\\bmod a$\uff0c\u539f\u672c\u7684\u82b1\u8d39\u662f $c\\bmod a$\uff0c\u8bbe $\\lfloor \\frac ca\\rfloor =\\lfloor \\frac ba\\rfloor=d$\uff0c\u5219\u6709\u539f\u6765\u7684\u82b1\u8d39\u4e3a $c-d\u00b7a$\uff0c\u65b0\u7684\u82b1\u8d39\u4e3a $c-b\u00b7\\lfloor\\frac cb\\rfloor +b-d\u00b7a$\uff0c\u663e\u7136\u6709\u524d\u8005\u4e0d\u5c0f\u4e8e\u540e\u8005\uff0c\u4e8e\u662f\u5b8c\u6210\u4e86\u8bc1\u660e\u3002\n\n",
        "postTime": 1628581075,
        "uid": 173685,
        "name": "\u6478\u9c7c\u9171",
        "ccfLevel": 8,
        "title": "P7789."
    },
    {
        "content": "## [COCI2016-2017#6] Sirni \u89e3\u9898\u62a5\u544a\n\n\u9996\u5148\u53d1\u73b0\u76f8\u540c\u6743\u503c\u7684\u70b9\u662f\u6ca1\u7528\u7684\uff0c\u76f4\u63a5\u5220\u6389\uff08unique\uff09\u5373\u53ef\u3002\n\n\u5bf9\u4e24\u4e2a\u6570\u503c $a<b$\uff0c\n$$\n\\min(a\\bmod b,b \\bmod a)=\\min(a, b \\bmod a)=b\\bmod a\n$$\n\u4e00\u5b9a\u662f\u5927\u7684\u6a21\u5c0f\u7684\u66f4\u5c0f\uff0c\u6240\u4ee5\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u3002\n\n\u7136\u540e\u53ef\u4ee5\u8bc1(luan)\u660e(cai)\u4e00\u4e0b\uff0c\u5019\u9009\u8fb9\u96c6\u4e00\u5b9a\u662f\u7531\u8fd9\u79cd\u8fb9\u6784\u6210\uff1a\u7531\u503c $x$ \u4e0e\u7b2c\u4e00\u4e2a\u503c\u5927\u4e8e\u7b49\u4e8e $kx$ \u4e14\u5c0f\u4e8e $(k+1)x$ \u7684\u503c $y$ \u76f8\u8fde\u7684\u8fb9\uff0c\u5176\u4e2d $k \\in \\mathbb{N}^*$\u3002\u8303\u56f4\u7684\u53f3\u754c\u662f\u4e3a\u4e86\u4fdd\u8bc1\u6bcf\u6761\u8fb9\u4e0d\u4f1a\u88ab\u591a\u6b21\u8ba1\u7b97\u3002\n\n\u53ef\u4ee5\u8fd9\u6837\u8bc1\u660e\uff0c\u82e5\u6709 $kx\\le y < z < (k+1)x$\uff0c\u90a3\u4e48\u7528\u8fb9 $(x,z)$ \u4e0d\u5982\u7528\u8fb9 $(y,z)$\u3002\n\n\u4e8e\u662f\u5c31\u679a\u4e3e\u6bcf\u4e2a\u503c\u7684\u500d\u6570\uff0c`lower_bound` \u627e\u5230\u5bf9\u5e94\u7684 $y$\uff0c\u68c0\u9a8c\u662f\u5426\u5728\u53f3\u754c\u5185\uff0c\u7136\u540e\u52a0\u5165\u5f85\u9009\u8fb9\u96c6\u3002\n\n\u8fd9\u6837\u7684\u8bdd\u8fb9\u96c6\u6700\u591a\u662f $O(V\\log V)$ \u7ea7\u522b\u7684\uff0c\u56e0\u4e3a $V=10^7$\uff0c5s \u65f6\u9650\u8fd8\u597d\u3002\n\n\u6700\u540e Kruskal \u4e00\u4e0b\u3002\n\n```cpp\nint const maxn = 100003;\ninline int read() {\n\tint x = 0, c = getchar();\n\twhile (!isdigit(c))\n\t\tc = getchar();\n\twhile (isdigit(c)) {\n\t\tx = 10 * x + c - '0';\n\t\tc = getchar();\n\t}\n\treturn x;\n}\n\nint n = 0;\nint p[maxn], Mx = 0;\n\nint fa[maxn], siz[maxn];\nint find(int x) { return fa[x] == x ? x : fa[x] = find(fa[x]); }\ninline void merge(int x, int y) {\n\tx = find(x); y = find(y);\n\tif (siz[x] < siz[y]) swap(x, y);\n\tfa[y] = x;\n\tsiz[x] += siz[y];\n}\n\nstruct Edge {\n\tint x, y;\n\tint v;\n};\nbool operator<(Edge const &lhs, Edge const &rhs) { return lhs.v < rhs.v; }\nvector<Edge> q;\n\ninline void addEdges(int id) {\n\tint x = p[id];\n\tfor (int y = x; y <= Mx; y += x) {\n\t\tint k = lower_bound(p + id + 1, p + n + 1, y) - p;\n\t\tif (k <= n && p[k] / x == y / x) q.push_back(Edge{ id, k, p[k] % p[id] });\n\t}\n}\n\nint main() {\n\tn = read();\n\tfor (int i = 1; i <= n; ++i)\n\t\tp[i] = read();\n\tsort(p + 1, p + n + 1);\n\tn = unique(p + 1, p + n + 1) - p - 1;\n\tMx = p[n];\n\tfor (int i = 1; i <= n + 1; ++i) {\n\t\tfa[i] = i;\n\t\tsiz[i] = 1;\n\t}\n\tlong long ans = 0;\n\tfor (int i = 1; i <= n; ++i)\n\t\taddEdges(i);\n\tsort(q.begin(), q.end());\n\tfor (auto e : q) {\n\t\tint yy = find(e.y), xx = find(e.x);\n\t\tif (yy != xx) {\n\t\t\tans += e.v;\n\t\t\tmerge(xx, yy);\n\t\t}\n\t}\n\tprintf(\"%lld\", ans);\n\treturn 0;\n}\n```\n\n\n\u6211\u4e00\u5f00\u59cb\u7528\u7684 priority_queue\uff0c\u7136\u540e TLE \u4e86... \u6539\u6210 vector+sort+O2 \u8fc7\u4e86...\n\n\uff08\u5e76\u4e0d\u6e05\u695a\u8fd9\u662f\u4e0d\u662f\u6700\u4f18\u590d\u6742\u5ea6\uff09",
        "postTime": 1628508934,
        "uid": 128771,
        "name": "\u738b\u9cb2\u9e4f",
        "ccfLevel": 7,
        "title": "[COCI2016-2017#6] Sirni-Solution"
    },
    {
        "content": "## Solution\n\n\u9996\u5148 , $P$ \u4e00\u6837\u7684\u70b9\u662f\u53ef\u4ee5\u514d\u8d39\u8fde\u7684 , \u76f4\u63a5 unique .\n\n\u8003\u8651 $\\text{Kruskal}$ . \u6709 $n^2$ \u6761\u8fb9 . \u4f46\u771f\u7684\u90fd\u662f\u6709\u7528\u7684\u5417 ? \n\n\u9996\u5148\u660e\u786e , \u8fb9\u6743\u5176\u5b9e\u662f $\\text{max} \\{ P_a,P_b \\} \\text{ mod } \\text{min} \\{P_a,P_b\\}$ . \n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u70b9 , \u5bfb\u627e\u6bd4\u4ed6\u5927\u7684\u70b9 . \u53d6\u6a21\u60f3\u5f53\u4e00\u4e2a\u6280\u5de7 : \u679a\u4e3e\u5546 , \u590d\u6742\u5ea6 $V \\text{ ln } V$  \u7ea7\u522b\u7684 .\n\n\u5bf9\u4e8e\u4e00\u4e2a\u6570 $a$ , \u5b83\u7684\u5546\u4e3a $k$ \u7684\u65f6\u5019 , \u533a\u95f4 $[ka,(k+1)a)$ (\u5f53\u5546\u662f $1$ \u7684\u65f6\u5019\u4e0d\u5e94\u9009\u4e0a\u4ed6\u81ea\u5df1) \u6709\u591a\u4e2a\u6570 . **\u6211\u4eec\u53ea\u9700\u8981\u5411\u6700\u5c0f\u7684\u8fde\u8fb9** .\n\nWhy ? \u8bbe\u6700\u5c0f\u7684\u662f $x_1$ , \u7b2c\u4e8c\u5c0f\u65f6 $x_2$ .\n\n\u663e\u7136\u8fde $x_2$ \u7684\u8fb9\u6743\u662f $x_2 - ka$ , **\u548c\u5206\u522b\u8fde** $a$ , $x_1$ ; $x_1$ , $x_2$ \u7684\u503c\u4e00\u6837\u3002\u90a3\u4e48\u591a\u8fde\u4e00\u4e2a\u4f55\u4e50\u800c\u4e0d\u4e3a ? \u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u5411 $x_1$ \u8fde\u8fb9 .\n\n\u6ce8\u610f\u627e $x_1$ \u7684\u8fc7\u7a0b\u53ef\u4ee5\u7528\u4e8c\u5206 , \u5341\u6709\u516b\u4e5d\u4f1a $\\text{TLE}$ , \u6240\u4ee5\u7528\u6876\u8bb0\u5f55\u4e00\u4e0b . \u53c2\u89c1\u4ee3\u7801 .\n\n\u6c42 MST \u7684\u8fc7\u7a0b\u4e0d\u518d\u8d58\u8ff0 .\n\ncode :\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define Int int\n#define ffor(i,a,b) for(int i=(a);i<=(b);i++)\n#define roff(i,a,b) for(int i=(a);i>=(b);i--)\nusing namespace std;\nconst int MAXN=1e5+10,MAXM=1e7+10;\nInt n,sze[MAXN],a[MAXN],fa[MAXN];\nInt nxt[MAXM];\nvector<pair<Int,pair<Int,Int>>> E;\nInt find(Int k) {\n\tif(fa[k]==k) return fa[k];\n\treturn fa[k]=find(fa[k]);\n}\nsigned main() {\n\tscanf(\"%lld\",&n);int mx=0;\n\tffor(i,1,n) scanf(\"%lld\",&a[i]);\n\tsort(a+1,a+n+1),n=unique(a+1,a+n+1)-a-1;\n\tffor(i,1,n) mx=max(mx,a[i]);\n\tmemset(nxt,0x3f,sizeof(nxt));\n\tffor(i,1,n) nxt[a[i]]=i;\n\troff(i,mx,1) if(nxt[i]>n) nxt[i]=nxt[i+1];\n\tffor(i,1,n) { //add edges\n\t\tfor(Int l=a[i];l<=mx;l+=a[i]) {\n\t\t\tInt pos=nxt[max(l,a[i]+1)];\n\t\t\tif(pos<=n&&a[pos]<l+a[i]) E.push_back({a[pos]-l,{pos,i}});\n\t\t}\t\n\t}\n\tffor(i,1,n) sze[i]=1,fa[i]=i;\n\tInt cnt=0;ll ans=0;\n\tsort(E.begin(),E.end());\n\tfor(auto tmp:E) {\n\t\tint w=tmp.first,x=tmp.second.first,y=tmp.second.second;\n\t\tx=find(x),y=find(y);\n\t\tif(x==y) continue;\n\t\tif(sze[x]>sze[y]) swap(x,y);\n\t\tcnt++;fa[x]=y,sze[y]+=sze[x],ans+=w;\n\t\tif(cnt==n-1) break;\n\t}\n\tcout<<ans;\n\treturn 0;\n}\n```\n\nPs : \u4e8c\u5206\u5361\u4e86\u6211\u591a\u957f\u65f6\u95f4 , \u5230\u5934\u6765\u4e0d\u7528\u4e8c\u5206 /ll",
        "postTime": 1652274544,
        "uid": 120947,
        "name": "Purslane",
        "ccfLevel": 7,
        "title": "P7789"
    },
    {
        "content": "$\\text{Problem}:$[Sirni](https://www.luogu.com.cn/problem/P7789)\n\n$\\text{Solution}:$\u200b\n\n\u5f53 $P_{a}>P_{b}$ \u65f6\uff0c\u8fde\u63a5 $a,b$ \u7684\u4ee3\u4ef7\u5373\u4e3a $P_{a}\\text{ mod }P_{b}$\u3002\u8fd9\u6837\u53bb\u6389\u4e86 $\\min$\u3002\n\n\u9996\u5148\u5c06\u6743\u503c\u76f8\u540c\u7684\u70b9\u5408\u5e76\u3002\u5bf9\u4e8e\u6743\u503c\u4e3a $x$\u200b \u7684\u70b9\uff0c\u6211\u4eec\u53ea\u9700\u5bf9\u4e8e\u6bcf\u4e2a $k$\u200b\uff0c\u627e\u5230\u6ee1\u8db3 $kx\\leq w<(k+1)x$\u200b \u7684\u6700\u5c0f\u7684 $w$\u200b\uff08\u5f53 $k=1$\u200b \u65f6\u4e3a $x<w<2x$\u200b\uff09\uff0c\u6dfb\u52a0\u4e00\u6761\u8fde\u63a5 $x$\u200b \u4e0e $w$\u200b \u7684\u8fb9\u5373\u53ef\u3002\u7b80\u5355\u8bc1\u660e\uff1a\u5047\u8bbe\u5b58\u5728 $w_{2}$\u200b\uff0c\u6ee1\u8db3 $kx\\leq w<w_{2}<(k+1)x$\u200b \u4e14\u6743\u503c\u533a\u95f4 $(w,w2)$\u200b\u200b \u4e2d\u6ca1\u6709\u7ed3\u70b9\uff08\u5426\u5219\u662f\u4e00\u4e2a\u5b50\u95ee\u9898\uff09\uff0c\u90a3\u4e48\u6839\u636e\u4e0a\u9762\u7684\u8fde\u8fb9\u65b9\u5f0f\uff0c\u4e00\u5b9a\u5b58\u5728 $x\\rightarrow w$\u200b \u4e0e $w\\rightarrow w_{2}$\u200b \u8fd9\u4e24\u6761\u8fb9\uff0c\u800c\u8fd9\u4e24\u8fb9\u7684\u6743\u503c\u548c\u4e0e $x\\rightarrow w_{2}$\u200b\u200b \u8fd9\u6761\u8fb9\u7684\u6743\u503c\u76f8\u540c\u3002\u6545\u8fde $x\\rightarrow w_{2}$\u200b \u4e00\u5b9a\u4e0d\u4f1a\u66f4\u4f18\u3002\n\n\u603b\u8fb9\u6570\u4e3a $O(V\\log V)$\u200b\uff0c\u800c\u8fb9\u6743\u6700\u5927\u503c\u5c0f\u4e8e $V$\uff0c\u6545\u5229\u7528\u7528\u6876\u6392\u5e8f\u7136\u540e\u6c42\u51fa\u6700\u5c0f\u751f\u6210\u6811\u5373\u53ef\u3002\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n+V\\log V\\cdot \\alpha(V))$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n$\\text{Code}:$\n\n```cpp\n#include <bits/stdc++.h>\n//#pragma GCC optimize(3)\n//#define int long long\n#define ri register\n#define mk make_pair\n#define fi first\n#define se second\n#define pb push_back\n#define eb emplace_back\n#define is insert\n#define es erase\n#define vi vector<int>\n#define vpi vector<pair<int,int>>\nusing namespace std; const int N=10000010;\ninline int read()\n{\n\tint s=0, w=1; ri char ch=getchar();\n\twhile(ch<'0'||ch>'9') { if(ch=='-') w=-1; ch=getchar(); }\n\twhile(ch>='0'&&ch<='9') s=(s<<3)+(s<<1)+(ch^48), ch=getchar();\n\treturn s*w;\n}\nint n,a[N],up,f[N],lar[N]; long long ans;\nvpi g[N];\ninline int Find(int x) { return f[x]^x?f[x]=Find(f[x]):x; }\nsigned main()\n{\n\tn=read();\n\tfor(ri int i=1;i<=n;i++)\n\t{\n\t\tint x=read();\n\t\ta[x]++, up=max(up,x);\n\t\tlar[x]=x;\n\t}\n\tfor(ri int i=up-1;i;i--)\n\t{\n\t\tif(!lar[i]) lar[i]=lar[i+1];\n\t}\n\tfor(ri int i=1;i<=up;i++)\n\t{\n\t\tif(!a[i]) continue;\n\t\tfor(ri int j=i;j<=up;j+=i)\n\t\t{\n\t\t\tint l=(j==i)?(i+1):(j), r=min(j+i-1,up);\n\t\t\tif(lar[l]<=r) g[lar[l]%i].eb(mk(i,lar[l]));\n\t\t}\n\t}\n\tfor(ri int i=1;i<=up;i++) f[i]=i;\n\tfor(ri int i=0;i<=up;i++)\n\t{\n\t\tfor(auto j:g[i])\n\t\t{\n\t\t\tint x=Find(j.fi), y=Find(j.se);\n\t\t\tif(x==y) continue;\n\t\t\tans+=i, f[x]=y;\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1628578467,
        "uid": 98618,
        "name": "Provicy",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7789"
    },
    {
        "content": "\u672c\u9898\u7684\u4e3b\u8981\u8003\u5bdf\u70b9\uff1a\n* \u6700\u5c0f\u751f\u6210\u6811\n* \u6570\u8bba\n* \u4e8c\u5206\n\n\u9996\u5148\u770b\u5230\u672c\u9898\u4e2d\u201c\u8fde\u63a5\u6240\u6709\u5361\u7247\u201d\u53ef\u4ee5\u76f4\u63a5\u60f3\u5230\u6700\u5c0f\u751f\u6210\u6811\uff0c\u4f46\u662f\u7531\u4e8e\u4efb\u610f\u4e24\u4e2a\u70b9\u4e4b\u95f4\u5747\u6709\u4ee3\u4ef7\uff08\u5373\u4e3a\u5b8c\u5168\u56fe\uff09\u800c\u4e14 $n$ \u7684\u8303\u56f4\u5f00\u5230\u4e86 $10^5$ \u6545 $O(n^2)$ \u8fde\u8fb9\u663e\u7136\u4f1a\u8d85\u65f6\uff0c\u8003\u8651\u53ea\u8fde\u6709\u6548\u8fb9\u3002  \n\n\u9996\u5148\u505a\u4e00\u4e2a\u5c0f\u4f18\u5316\uff1a\u6240\u6709\u6743\u503c\u76f8\u540c\u7684\u70b9\u663e\u7136\u53ef\u4ee5\u90fd\u4ee5\u4ee3\u4ef7 $0$ \u4e92\u76f8\u8fde\u63a5\uff0c\u90a3\u4e48\u53ea\u4fdd\u7559\u4e00\u4e2a\u5bf9\u4ee3\u4ef7\u4e0d\u4f1a\u505a\u51fa\u4efb\u4f55\u6539\u53d8\u3002\u540e\u6587\u4e2d\u201c\u70b9 $v$\u201d\u7684\u79f0\u547c\u7686\u6307\u6743\u503c\u4e3a $v$ \u7684\u70b9\u3002\n\n\u5148\u7ed9\u51fa\u53ea\u8fde\u6709\u6548\u8fb9\u7684\u7ed3\u8bba\uff1a\u5bf9\u4e8e\u70b9 $v$\uff0c\u5148\u7ed9\u6743\u503c\u6700\u5c0f\u4e14\u5728 $(v,2v)$ \u4e2d\u7684\u70b9\uff0c\u7136\u540e\u5bf9\u4e8e\u6240\u6709 $[kv,(k+1)v)$ $(d \\geqslant 2)$ \u4e2d\u7ed9\u8303\u56f4\u4e2d\u6743\u503c\u6700\u5c0f\u7684\u4e00\u4e2a\u8fde\u8fb9\u3002 \n\n\u4f7f\u7528 ~~\u6570\u5b66\u778e\u8499\u6cd5~~ \u6570\u5b66\u5f52\u7eb3\u6cd5\u7684\u8bc1\u660e\uff1a  \n\n\u9996\u5148\u7c7b\u6bd4\u4e00\u4e0b\u672c\u9898\u66b4\u529b\u8fde\u8fb9\u53ea\u5f80\u6bd4\u81ea\u5df1\u6743\u503c\u66f4\u5927\u7684\u8fde\u53cc\u5411\u8fb9\u800c\u6bd4\u81ea\u5df1\u5c0f\u7684\u4e0d\u7ba1\uff0c\u4f46\u662f\u7531\u4e8e\u6bd4\u81ea\u5df1\u5c0f\u7684\u4e5f\u4f1a\u7ed9\u6bd4\u5b83\u6743\u503c\u5927\u7684\u70b9\uff08\u5176\u4e2d\u5305\u62ec\u8fd9\u4e2a\u70b9\uff09\u8fde\u8fb9\uff0c\u6240\u4ee5\u4e0d\u4f1a\u9519\u8bef\u3002  \n\n\u7c7b\u4f3c\u7684\uff0c\u8fd9\u79cd\u65b9\u6cd5\u53ea\u9700\u8981\u8003\u8651\u8fde\u6bd4\u81ea\u5df1\u6743\u503c\u5927\u8fde\u8fb9\u7684\u6b63\u786e\u6027\u5373\u53ef\u8bc1\u660e\u3002  \n\uff08\u8fd9\u91cc\u5b9a\u4e49\u201c\u6b63\u786e\u201d\u4e3a\u7ecf\u8fc7\u81ea\u5df1\u6240\u8fde\u7684\u8fb9\u4e2d\u8f6c\u540e\u7684\u957f\u5ea6\u7b49\u4e8e\u76f4\u63a5\u8fde\u7684\u957f\u5ea6\uff09  \n\u663e\u7136\uff0c\u5bf9\u4e8e\u6743\u503c\u6700\u5927\u7684\u70b9\u8be5\u65b9\u6cd5\u6210\u7acb\u3002\uff08\u4e0d\u9700\u8981\u8fde\u4efb\u4f55\u8fb9\uff09  \n\n\u800c\u5bf9\u4e8e\u4efb\u610f\u70b9 $v$\uff0c\u82e5\u6240\u6709\u6743\u503c $>v$ \u7684\u70b9\u5747\u6210\u7acb\u3002\u90a3\u4e48\u5bf9\u4e8e\u4efb\u610f\u4e0a\u8ff0\u8303\u56f4\uff0c\u5047\u5982\u8fde\u4e86\u70b9 $b$ \u800c\u672a\u8fde\u70b9 $c$\uff08$c$ > $b$\uff09\u3002\u6b64\u5904\u4ee4\u6743\u503c\u4e3a $i,j$ \u7684\u4e24\u70b9\u4e4b\u95f4\u7684\u4ee3\u4ef7\u4e3a $w_{i,j}$\uff0c\u5219\u663e\u7136\u6709\uff1a  \n$$w_{b,c} = c \\mod b$$\n\u4ece\u5b9a\u4e49\u53ef\u77e5 $c-b<a<b$\uff0c\u5219\uff1a\n$$w_{b,c} = c-b$$\n\u53c8\u7531\u5b9a\u4e49\u53ef\u77e5\uff1a\n$$w_{a,b} = b \\mod a = b-ka$$\n$$w_{a,c} = c \\mod a = c-ka$$\n\u6240\u4ee5\uff1a\n$$w_{a,b}+w_{b,c} = (b-ka)+(c-b) = c-ka = w_{a,c}$$\n\u6545\u8bc1\u3002\n\n\u4f46\u662f\uff0c\u5047\u5982\u5bf9\u6bcf\u4e00\u4e2a\u70b9 $v$ \u7684\u6240\u6709\u8303\u56f4\u626b\u4e00\u904d\u4ecd\u7136\u662f $O(n^2)$ \u7684\u590d\u6742\u5ea6\uff0c\u9898\u76ee\u4e2d\u7684 $n \\leqslant 10^5$ \u63d0\u793a $O(n \\log n)$ \u5de6\u53f3\u7684\u7b97\u6cd5\uff0c\u6240\u4ee5\u53ef\u4ee5\u60f3\u5230\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u533a\u95f4\u4e8c\u5206\u7b54\u6848\u3002  \n\n\u5927\u6982\u5206\u6790\u4e00\u4e0b\u590d\u6742\u5ea6\uff1a\u7531\u8c03\u548c\u7ea7\u6570\u53ef\u77e5\u533a\u95f4\u6570\u91cf\u662f\u5728 $n \\log n$ \u7ea7\u522b\u7684\uff08\u7531\u4e8e\u6743\u503c\u4e0d\u8fde\u7eed\u4e0d\u4f1a\u521a\u597d\u662f $n \\ln n$\uff09\uff0c\u800c\u6bcf\u6b21\u4e8c\u5206\u7684\u590d\u6742\u5ea6\u662f $\\log n$ \u7ea7\u522b\u7684\uff0c\u6240\u4ee5\u6700\u540e\u7b97\u6cd5\u590d\u6742\u5ea6\u662f $O(n \\log^2 n)$\uff0c\u5f00 O2 \u624d\u53ef\u4ee5\u5361\u8fc7\u53bb\u3002\n\n\u5949\u4e0a\u849f\u84bb\u7684\u4ee3\u7801\uff1a\uff08\u7531\u4e8e\u662f\u7a00\u758f\u56fe\u6240\u4ee5\u9009\u7528\u514b\u9c81\u65af\u5361\u5c14\u7b97\u6cd5\uff09\n```c++\n#include <cstdio>\n#include <algorithm>\nusing std::sort;\n#define N 100010\n#define P 10000010\nbool vis[P];\nint a[N];\nint fa[N];\nint size[N];\nint n;\nstruct edge\n{\n\tint from,to;\n\tint w;\n\tbool operator<(edge b) const\n\t{\n\t\treturn w<b.w;\n\t}\n}e[N*500];//\u5efa\u8bae\u6570\u7ec4\u5f00\u5927\u4e00\u70b9\u8981\u4e0d\u7136\u4f1a\u83ab\u540dRE\nvoid read()\n{\n\tint t;\n\tscanf(\"%d\",&t);\n\tfor(int i=0;i<t;i++)\n\t\tscanf(\"%d\",a+i);\n\tsort(a,a+t);\n\tn=std::unique(a,a+t)-a;\n}\nint find(int a)\n{\n\treturn fa[a]==a?a:fa[a]=find(fa[a]);\n}\nbool merge(int a,int b)\n{\n\t//\u6309\u79e9\u5408\u5e76+\u8def\u5f84\u538b\u7f29\u53ef\u4ee5\u505a\u5230\u51e0\u4e4e\u5747\u644aO(1)\n\ta=find(a),b=find(b);\n\tif(a!=b)\n\t{\n\t\tif(size[a]>size[b]) std::swap(a,b);\n\t\tsize[b]+=size[a];\n\t\tfa[a]=b;\n\t}\n\treturn a!=b;\n}\nvoid work()\n{\n\tint mx=-1;\n\tfor(int i=0;i<n;i++)\n\t\tif(a[i]>mx) mx=a[i];\n\tint m=0;\n\tfor(int i=0;i<n;i++)\n\t{\n    \t//\u7f13\u5b58\u5de6\u7aef\u70b9\u52a0\u901f\u4e8c\u5206\n\t\tint *bound=a+i;\n\t\tfor(int j=a[i];j<=mx;j+=a[i])\n\t\t{\n\t\t\tint l=j==a[i]?j+1:j;\n\t\t\tint r=j+a[i];\n\t\t\tint p=(bound=std::lower_bound(bound,a+n,l))-a;\n\t\t\tif(p==n) //\u6ce8\u610flower_bound\u627e\u4e0d\u5230\u4f1a\u8fd4\u56delast\uff08\u6b64\u5904\u4e3aa+n)\n\t\t\t\tbreak;\n\t\t\telse\n\t\t\t\te[m++]=edge{i,p,a[p]%a[i]};\n\t\t\tif(a[p]>r) //\u5904\u7406\u4e86\u540e\u9762\u533a\u95f4\u7684\uff0c\u8df3\u8fc7\u9632\u6b62\u91cd\u590d\u52a0\u8fb9\n\t\t\t    j=a[p]/a[i]*a[i];\n\t\t}\n\t}\n\tsort(e,e+m);\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tfa[i]=i;\n\t\tsize[i]=1;\n\t}\n\tint ans=0;\n\tint chunk=n-1;\n\tfor(int i=0;chunk&&i<m;i++)\n\t\tif(merge(e[i].from,e[i].to))\n\t\t{\n\t\t\tans+=e[i].w;\n\t\t\tchunk--;\n\t\t}\n\tprintf(\"%d\",ans);\n}\nint main()\n{\n\tread();\n\twork();\n}\n```\n[AC \u8bb0\u5f55](https://www.luogu.com.cn/record/57057156)",
        "postTime": 1630038349,
        "uid": 298051,
        "name": "xkcdjerry",
        "ccfLevel": 7,
        "title": "P7789\u9898\u89e3"
    },
    {
        "content": "[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P7789)\n\n\u9898\u610f\uff1a\u7ed9\u5b9a $n$ \u4e2a\u6574\u6570 $P_i$\uff0c\u5728\u4e00\u4e2a\u6709 $n$ \u4e2a\u70b9\u7684\u5b8c\u5168\u56fe\u4e2d\uff0c\u8fb9 $(a,b)$ \u7684\u6743\u503c\u4e3a $\\min(P_a\\bmod P_b,P_b\\bmod P_a)$\uff0c\u6c42\u51fa\u8fd9\u4e2a\u56fe\u6700\u5c0f\u751f\u6210\u6811\u7684\u8fb9\u6743\u4e4b\u548c\u3002\n\n\u9996\u5148\u662f\u4e00\u4e2a\u660e\u663e\u7684\u6027\u8d28\uff1a\u5f53 $P_a>P_b$ \u65f6\uff0c$\\min(P_a\\bmod P_b,P_b\\bmod P_a)=P_a\\bmod P_b$\u3002\u8bc1\u660e\u7565\u3002\n\n\u6ce8\u610f\u5230\u5f53 $P_a=P_b$ \u65f6\uff0c\u8fde\u63a5 $a,b$ \u4e24\u70b9\u7684\u4ee3\u4ef7\u4e3a $0$\uff0c\u56e0\u6b64\u53ef\u4ee5\u5047\u8bbe $P_i$ \u4e92\u4e0d\u76f8\u540c\u3002\n\n\u8003\u8651\u901a\u8fc7\u6bcf\u6761\u8fb9\u4e2d $P$ \u503c\u8f83\u5c0f\u7684\u70b9\u63a8\u51fa\u6700\u5c0f\u751f\u6210\u6811\u4e2d\u53ef\u80fd\u4e0e\u5176\u76f8\u8fde\u7684\u70b9\u3002\u5047\u8bbe\u5f53\u524d\u8003\u8651\u5230\u7b2c $i$ \u4e2a\u70b9\uff0c\u679a\u4e3e $k\\in[1,\\lfloor\\frac{M}{P_i}\\rfloor](M=\\max\\limits_{i=1}^nP_i)$\uff0c\u627e\u51fa $P$ \u503c\u5927\u4e8e\u7b49\u4e8e $k\\cdot P_i$ \u5e76\u4e14\u4e0e\u5176\u6700\u63a5\u8fd1\u7684\u70b9 $j$\uff0c\u5c06\u8fb9 $(i,j)$ \u52a0\u5165\u8fb9\u96c6\u5408\u4e2d\u3002\u90a3\u4e48\u6700\u5c0f\u751f\u6210\u6811\u5305\u542b\u7684\u8fb9\u4e00\u5b9a\u5728\u8fd9\u4e2a\u8fb9\u96c6\u5408\u4e2d\u3002\u8003\u8651\u8bc1\u660e\u3002\n\n\u4f7f\u7528\u53cd\u8bc1\u6cd5\uff0c\u5047\u8bbe\u5728\u6700\u5c0f\u751f\u6210\u6811\u4e2d\u5fc5\u5b9a\u6709\u4e00\u6761\u8fb9 $(a,b)$ \u4e0d\u5728\u96c6\u5408\u4e2d\u3002\u90a3\u4e48\u6839\u636e\u7b97\u6cd5\uff0c\u4e00\u5b9a\u5b58\u5728 $k\\cdot P_a\\le P_{p_1}\\le P_{p_2} \\le \\dots \\le P_{p_c} \\le P_b \\le (k+1)\\cdot P_a$\uff0c\u5e76\u4e14 $(a,p_1),(p_1,p_2),\\dotsm,(p_{c-1},p_c),(p_c,b)$ \u5747\u5728\u8fb9\u96c6\u5408\u4e2d\uff0c\u6b64\u65f6\u8fd9\u4e9b\u8fb9\u7684\u8fb9\u6743\u548c\u4e3a $P_b-k\\cdot P_a=P_b \\bmod P_a$\u3002\u56e0\u6b64 $(a,b)$ \u53ef\u4ee5\u88ab\u8fb9\u96c6\u5408\u4e2d\u7684\u8fb9\u66ff\u4ee3\uff0c\u5047\u8bbe\u4e0d\u6210\u7acb\u3002\n\n\u8fd9\u6837\u5904\u7406\u7684\u8fb9\u96c6\u5408\u6700\u591a\u6709\u7ea6 $O(n \\log n)$ \u6761\u8fb9\uff0c\u53ef\u4ee5\u7528 kruskal \u7b49\u7b97\u6cd5\u89e3\u51b3\u3002\u6ce8\u610f `sort` \u4f1a\u8d85\u65f6\uff0c\u8981\u7528\u8ba1\u6570\u6392\u5e8f\u3002\n\n\u5177\u4f53\u7ec6\u8282\u89c1\u4ee3\u7801\uff08\u4eba\u50bb\u5e38\u6570\u5927\uff0c\u8981\u5438\u6c27\uff09\u3002\n\n```cpp\n#include <cstdio>\n#include <vector>\n\nconst int maxn = 5e6 + 5,maxm = 1e7 + 5;\n\nstruct node {\n    int u,v;\n    node(int _u = 0,int _v = 0): u(_u),v(_v) {}\n};\nint n,p[maxn],map[maxm],id[maxm],fa[maxm];\n/*\n * map[i] \u4e3a\u6876\uff0c\u5b58\u50a8p\u6570\u7ec4\u4e2d\u5927\u4e8e\u7b49\u4e8ei\u7684\u6700\u5c0f\u7684\u503c\n * id[i] \u5b58\u50a8i\u503c\u5728p\u6570\u7ec4\u4e2d\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4e0b\u6807\n */\nstd::vector < node > edge[maxm]; // edge[w] \u5b58\u50a8\u8fb9\u96c6\u5408\u4e2d\u6240\u6709\u8fb9\u6743\u4e3aw\u7684\u8fb9\uff0c\u8fd9\u6837\u76f8\u5f53\u4e8e\u52a0\u8fb9\u65f6\u5c31\u80fd\u591f\u6392\u5e8f\nlong long ans;\n\ninline int read() {\n#define gc c = getchar()\n    int d = 0,f = 0,gc;\n    for(;c < 48 || c > 57;gc) f |= (c == '-');\n    for(;c > 47 && c < 58;gc) d = (d << 1) + (d << 3) + (c ^ 48);\n#undef gc\n    return f ? -d : d;\n}\n\nint find(int p) { // \u5e76\u67e5\u96c6\n    if(fa[p] == p) return p;\n    return fa[p] = find(fa[p]);\n}\n\nvoid kruskal() { // \u6700\u5c0f\u751f\u6210\u6811\n    for(int i = 1;i <= n;i ++) fa[i] = i;\n    for(int i = 0;i <= 1e7;i ++) {\n        for(int u,v,j = 0;j < edge[i].size();j ++) {\n            u = find(edge[i][j].u),v = find(edge[i][j].v);\n            if(u == v) continue;\n            fa[u] = v;\n            ans += i;\n        }\n    }\n}\n\nint main() {\n    n = read();\n    for(int i = 1;i <= n;i ++) {\n        p[i] = read();\n        map[p[i]] = p[i];\n        if(!id[p[i]]) id[p[i]] = i;\n    } // \u8bfb\u5165\n    for(int i=1e7;i >= 0;i --)\n        if(!map[i]) map[i] = map[i + 1]; // \u5904\u7406map\u6570\u7ec4\n    for(int i = 1;i <= n;i ++)\n        if(id[p[i]] == i) { // \u53bb\u91cd\uff0c\u786e\u4fdd\u6bcf\u4e2a\u6570\u53ea\u5904\u7406\u4e00\u6b21\n            if(map[p[i] + 1] && (p[i] >= 5e6 || map[p[i] * 2] != map[p[i] + 1]))\n                edge[map[p[i] + 1] - p[i]].push_back(node(i,id[map[p[i] + 1]])); // \u7279\u5224k=1\uff0cif\u5185\u7684\u5185\u5bb9\u4e5f\u662f\u4e3a\u4e86\u53bb\u91cd\n            for(int j = p[i] * 2;j <= 1e7 && map[j];j += p[i]) // \u5faa\u73af\u679a\u4e3e k*Pi\n                if(j + p[i] >= 1e7 || map[j] != map[j + p[i]])\n                edge[map[j] - j].push_back(node(i,id[map[j]])); // \u52a0\u8fb9\n        }\n    kruskal(); // \u6700\u5c0f\u751f\u6210\u6811\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1628568670,
        "uid": 114082,
        "name": "Sya_Resory",
        "ccfLevel": 5,
        "title": "P7789 \u9898\u89e3"
    }
]
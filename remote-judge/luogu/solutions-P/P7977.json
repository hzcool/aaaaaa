[
    {
        "content": "\u521d\u4e8c\u65f6\u641e\u7684\u9898\uff0c\u5f53\u65f6\u73a9\u4e86\u597d\u4e45\uff0c\u6362\u4e86\u4e00\u5806\u7248\u672c\uff08\n\n\u524d\u7f6e\u77e5\u8bc6\uff1ak-SG\u3002\n\n### Subtasks\n\n| Subtask No. | $n \\le$ | $S \\le$ | \u5206\u503c |\n| :-: | :-: | :-: | :-: |\n| $1$ | $300$ | $300$ | $7$ |\n| $2$ | $300$ | $3 \\times 10^7$ | $8$ |\n| $3$ | $300$ | $3 \\times 10^{10}$ | $16$ |\n| $4$ | $3 \\times 10^6$ | $3$ | $3$ |\n| $5$ | $3 \\times 10^6$ | $3 \\times 10^3$ | $3$ |\n| $6$ | $3 \\times 10^6$ | $3 \\times 10^7$ | $16$ |\n| $7$ | $3 \\times 10^6$ | $3 \\times 10^{10}$ | $47$ |\n\n### Solutions\n\n\u6211\u4e0d\u77e5\u9053\u6709\u6ca1\u6709\u5176\u4ed6\u7684\u505a\u6cd5\u2026\u2026\u53cd\u6b63\u6211\u4f1a\u7684\u90fd\u5728\u8fd9\u4e86\uff0c\u8fd8\u6709\u4e00\u4e2a\u6709\u70b9\u6bd2\u7624\u4e8e\u662f\u653e\u4e86\u52a0\u5f3a\u7248\u2026\u2026\n\n\u4e3a\u4e86\u7b80\u6d01\uff0c\u6211\u5728\u90e8\u5206\u5206\u5bf9\u5e94\u4ee3\u7801\u4e2d\u5747\u7701\u53bb\u5177\u4f53\u5904\u7406 k-SG \u7684\u90e8\u5206\uff0c\u5728\u6b63\u89e3\u5bf9\u5e94\u4ee3\u7801\uff08std\uff09\u91cc\u4f1a\u6709\u3002\u5904\u7406 k-SG \u53ef\u4ee5\u5728 $O(n\\log{S})$ \u65f6\u95f4\u5185\u5b8c\u6210\uff0c\u4e0d\u7b97\u5165\u5177\u4f53\u90e8\u5206\u5206\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790\u4e2d\u3002\n\n#### Sol. $\\rm{I}$\n\nSubtask $\\# 4$\uff0c$3$ pts\n\n\u53d1\u73b0 $\\le 3$ \u4e0d\u53ef\u64cd\u4f5c\u3002\u76f4\u63a5\u8f93\u51fa `NO`\u3002\n\nCode:\n```cpp\n#include<cstdio>\nint main()\n{\n\tputs(\"NO\");\n\treturn 0;\n}\n```\n\n#### Sol. $\\rm{II}$\n\nSubtask $\\# 4,1$\uff0c$10$ pts\n\n\u76f4\u63a5\u4f9d\u9898\u610f\u66b4\u529b\u8ba1\u7b97 $\\operatorname{SG}$ \u51fd\u6570\uff0c\u65f6\u95f4 $O(nS^2)$\u3002\n\nCode:\n```cpp\n#include<cstdio>\n#define rg register\nint n,k,S,s;\nint vs[307];\nint SG[307];\nint sg[3000007];\nint main()\n{\n\tscanf(\" %d %d %d\",&n,&k,&S);\n\tfor(rg int i=0;i<n;++i)\n\t{\n\t\tscanf(\" %d\",&s);\n\t\tSG[0]=0;\n\t\tfor(rg int i=1;i<=s;++i)\n\t\t{\n\t\t\tfor(rg int j=i;j*j/4>=i;--j)vs[SG[i-j]]=1;\n\t\t\twhile(vs[SG[i]])++SG[i];\n\t\t\tfor(rg int j=i;j*j/4>=i;--j)vs[SG[i-j]]=0;\n\t\t}\n\t\tsg[i]=SG[s];\n\t}\n}\n```\n\n#### Sol. $\\rm{III}$\n\nSubtask $\\# 4,1,5$\uff0c$13$ pts\n\n\u628a\u8be2\u95ee\u5185\u8ba1\u7b97\u6362\u6210\u9012\u63a8\uff0c\u65f6\u95f4 $O(S^2+n)$\u3002\n\nCode:\n```cpp\n#include<cstdio>\n#define rg register\nint n,k,S,s;\nint vs[3007];\nint SG[3007];\nint sg[3000007];\nint main()\n{\n\tscanf(\" %d %d %d\",&n,&k,&S);\n\tSG[0]=0;\n\tfor(rg int i=1;i<=S;++i)\n\t{\n\t\tfor(rg int j=i;j*j/4>=i;--j)vs[SG[i-j]]=1;\n\t\twhile(vs[SG[i]])++SG[i];\n\t\tfor(rg int j=i;j*j/4>=i;--j)vs[SG[i-j]]=0;\n\t}\n\tfor(rg int i=0;i<n;++i)\n\t{\n\t\tscanf(\" %d\",&s);\n\t\tsg[i]=SG[s];\n\t}\n}\n```\n\n#### Sol. $\\rm{IV}$\n\nSubtask $\\# 4,1,5,2,3$\uff0c$37$ pts\n\n\u53d1\u73b0\u4e00\u4e2a\u6027\u8d28\uff1a$x$ \u7684\u540e\u7ee7\u72b6\u6001\u96c6\u5408\u4e3a $[0,x-2\\sqrt{x}]\\cap\\mathbb{Z}$\u3002\n\n\u7531\u4e8e $x-2\\sqrt{x}=(\\sqrt{x}-1)^2-1$ \u9012\u589e\uff0c\u56e0\u6b64\u540e\u7ee7\u72b6\u6001\u96c6\u5408\u4e0d\u51cf\uff0c\u6240\u4ee5 $\\operatorname{SG}$ \u51fd\u6570\u503c\u4e0d\u51cf\u3002\u56e0\u6b64 $\\operatorname{SG}(x)=\\operatorname{SG}(\\lfloor x-2\\sqrt{x} \\rfloor)+1$\u3002\u76f4\u63a5\u8ba1\u7b97\uff0c\u65f6\u95f4 $O(n\\sqrt{S})$\u3002\n\nCode:\n```cpp\n#include<cmath>\n#include<cstdio>\n#define rg register\n#define ll long long\nll S,s;\nint n,k;\nint sg[3000007];\nint main()\n{\n\tscanf(\" %d %d %lld\",&n,&k,&S);\n\tfor(rg int i=0;i<n;++i)\n\t{\n\t\tscanf(\" %lld\",&s);\n\t\twhile(s>3)s=(ll)(s-sqrt(s)*2),++sg[i];\n\t}\n}\n```\n\n#### Sol. $\\rm{V}$\n\nSubtask $\\# 4,1,5,2,6$\uff0c$37$ pts\n\n\u628a\u8be2\u95ee\u5185\u8ba1\u7b97\u6362\u6210\u9012\u63a8\uff0c\u65f6\u95f4 $O(S+n)$\u3002\n\nCode:\n```cpp\n#include<cmath>\n#include<cstdio>\n#define rg register\nint n,k,S,s;\nint sg[3000007];\nint SG[30000007];\nint main()\n{\n\tscanf(\" %d %d %d\",&n,&k,&S);\n\tfor(rg int i=4;i<=S;++i)SG[i]=SG[int(i-sqrt(i)*2)]+1;\n\tfor(rg int i=0;i<n;++i)\n\t{\n\t\tscanf(\" %d\",&s);\n\t\tsg[i]=SG[s];\n\t}\n}\n```\n\n#### Sol. $\\rm{VI}$\n\nSubtask $\\# 4,1,5,2,6,3$\uff0c$53$ pts\n\n\u7ed3\u5408 Sol. $\\rm{IV \\& V}$ \u5373\u53ef\u3002\n\nCode:\n```cpp\n#include<cmath>\n#include<cstdio>\n#define rg register\n#define ll long long\nll S,s;\nint n,k;\nint sg[3000007];\nint SG[30000007];\nint main()\n{\n\tscanf(\" %d %d %lld\",&n,&k,&S);\n\tif(n<=300)\n\t{\n\t\tfor(rg int i=0;i<n;++i)\n\t\t{\n\t\t\tscanf(\" %lld\",&s);\n\t\t\twhile(s>3)s=(ll)(s-sqrt(s)*2),++sg[i];\n\t\t}\n\t}\n\telse\n\t{\n\t\tfor(rg int i=4;i<=S;++i)SG[i]=SG[int(i-sqrt(i)*2)]+1;\n\t\tfor(rg int i=0;i<n;++i)\n\t\t{\n\t\t\tscanf(\" %d\",&s);\n\t\t\tsg[i]=SG[s];\n\t\t}\n\t}\n}\n```\n\n#### Sol. $\\rm{VII}$\n\n\u8bb2\u6b63\u89e3\u3002~~\u611f\u89c9\u524d\u9762\u7684\u5206\u5e94\u8be5\u4f1a k-SG \u90fd\u80fd\u62ff\u5230\u5427\uff0c\u7b97\u662f\u9001\u4e86~~\n\n\u9996\u5148\u6211\u4eec\u8981\u5728 $\\rm{IV}$ \u91cc\u7684\u7ed3\u8bba\u57fa\u7840\u4e0a\u7ee7\u7eed\u627e\u6027\u8d28\u3002\n\n\u60f3\u5230 $\\operatorname{SG}$ \u51fd\u6570\u503c\u4e0d\u51cf\uff0c\u6240\u4ee5\u5c1d\u8bd5\u5bf9 $v$ \u627e\u6ee1\u8db3 $\\operatorname{SG}(x)=v$ \u7684\u6700\u5c0f $x$\u3002\n\n\u6211\u4eec\u53d1\u73b0\u8bbe $\\operatorname{SG}(x)=v$ \u7684\u6700\u5c0f $x$ \u4e3a $x_v$\uff0c\u5219 $\\lfloor x_v-2\\sqrt{x_v}\\rfloor=x_{v-1}$\u3002\u76f4\u63a5\u9012\u63a8\u5c31\u884c\u4e86\u3002\n\n\u8ba1\u7b97\u51fa\u6765\u540e\u76f4\u63a5\u4e8c\u5206\u627e\u51fa\u6700\u5927\u7684 $x \\le s_i$ \u5c31\u884c\u4e86\u3002\u65f6\u95f4 $O(\\sqrt{S}+n\\log{S})$\u3002\n\nCode:\n```cpp\n#include<cmath>\n#include<cstdio>\n#define rg register\n#define ll long long\ninline char gc()\n{\n\tstatic char buf[1048576],*pn=buf,*pe=buf;\n\treturn (pn==pe)&&(pe=(pn=buf)+fread(buf,1,1048576,stdin),pn==pe)?EOF:*pn++;\n}\ninline int read()\n{\n\tint x=0;\n\tchar c=gc();\n\twhile(c<'0'||c>'9')c=gc();\n\twhile(c>='0'&&c<='9')x=x*10+(c^48),c=gc();\n\treturn x;\n}\ninline ll _read()\n{\n\tll x=0;\n\tchar c=gc();\n\twhile(c<'0'||c>'9')c=gc();\n\twhile(c>='0'&&c<='9')x=x*10+(c^48),c=gc();\n\treturn x;\n}\nll s,S;\nint n,k;\nint ans[19];\nint cnt,bt,sg;\nll dsg[173273];\ninline int SG(ll x)\n{\n\tint l=0,r=cnt,m;\n\twhile(l<r)\n\t{\n\t\tm=r-((r-l)>>1);\n\t\tif(dsg[m]==x)l=r=m;\n\t\telse (dsg[m]<x)?(l=m):(r=m-1);\n\t}\n\treturn l;\n}\nint main()\n{\n\tn=read(),k=read()+1,S=_read(),dsg[0]=0;\n\tfor(rg int i=1;;++i)\n\t{\n\t\tdouble v=sqrt(dsg[i-1]+1)+1;\n\t\tdsg[i]=(ll)(v*v);\n\t\tif(dsg[i]-2*sqrt(dsg[i])<dsg[i-1])++dsg[i];\n\t\tif(dsg[i]>=S){cnt=i;break;}\n\t}\n\tfor(rg int i=0;i<n;++i)\n\t{\n\t\ts=_read();\n\t\tsg=SG(s),bt=0;\n\t\twhile(sg)\n\t\t{\n\t\t\t(sg&1)&&(++ans[bt],\\\n\t\t\t(ans[bt]==k)&&(ans[bt]=0));\n\t\t\tsg>>=1,++bt;\n\t\t}\n\t}\n\tint flag=0;\n\tfor(rg int i=0;i<18;++i)\n\t{\n\t\tif(ans[i])\n\t\t{\n\t\t\tflag=1;break;\n\t\t}\n\t}\n\tputs((flag)?\"YES\":\"NO\");\n\treturn 0;\n}\n```",
        "postTime": 1619346815,
        "uid": 59388,
        "name": "VinstaG173",
        "ccfLevel": 7,
        "title": "\u4e16\u754c\u672a\u672b\u65e5 \u9898\u89e3"
    }
]
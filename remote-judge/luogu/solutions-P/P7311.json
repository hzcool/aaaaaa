[
    {
        "content": "\u770b\u5230\u672c\u9898\u6ca1\u6709\u9898\u89e3\uff0c\u90a3\u5c31\u7531\u6211\u6765\u5199\u4e00\u7bc7\u5427\u3002\n\n\u9996\u5148\uff0c\u770b\u5230\u8fd9\u9898\uff0c\u6211\u60f3\u5230\u4e86\u4e00\u79cd\u5341\u5206\u66b4\u529b\u7684 dp \u505a\u6cd5\u3002\n\n\u4ee4 $f_{i, j, k}$ \u8868\u793a\u8d70\u4e86 $k$ \u6b65\uff0c\u6700\u540e\u5230\u8fbe $(i,j)$ \u7684\u6700\u5927\u6570\u91cf\u3002\n\u72b6\u6001\u8f6c\u79fb\u8f83\u4e3a\u7b80\u5355\uff0c\u65b9\u7a0b\u4e5f\u4e0d\u5217\u4e86\u3002\u4e0d\u8fc7\uff0c$K\\le10^9$\uff0c\u5f88\u660e\u663e\uff0c\u8fd9\u4e2a\u7b97\u6cd5\u662f\u884c\u4e0d\u901a\u7684\u3002\n\n\u8fd8\u597d $n,m$ \u7684\u6570\u636e\u8303\u56f4\u8f83\u5c0f\u3002\u56e0\u4e3a $K$ \u53ef\u4ee5\u5927\u4e8e $n\\cdot m$\uff0c\u6240\u4ee5\u8bf4\uff0cMaja \u80af\u5b9a\u8981\u5728\u51e0\u4e2a\u70b9\u4e0a\u6765\u56de\u8d70\u52a8\uff0c\u6700\u540e\u518d\u56de\u5230\u7ec8\u70b9\u3002\u4e8e\u662f\u6211\u4eec\u6765\u8003\u5bdf\u4e00\u4e0b\u8fd9\u51e0\u4e2a\u70b9\u7684\u6027\u8d28\u3002\n\n\u5f15\u7406\uff1aMaja \u4e00\u5b9a\u662f\u5728\u4e00\u4e2a\u70b9\u548c\u4e0e\u8fd9\u4e2a\u70b9\u76f8\u90bb\u7684\u6743\u503c\u6700\u5927\u7684\u70b9\u5468\u671f\u6027\u5730\u6765\u56de\u5730\u8d70\u52a8\u3002\n\n\u6211\u4eec\u7b80\u5355\u8bc1\u660e\u4e00\u4e0b\u8fd9\u4e2a\u5f15\u7406\u3002\u5047\u8bbe Maja \u662f\u5728\u4e09\u4e2a\u70b9\u4e0a\u6765\u56de\u8d70\u52a8\u3002\u8fd9\u662f\u4e0d\u53ef\u80fd\u5f97\u5230\u6700\u4f18\u89e3\u7684\u3002\u56e0\u4e3a\u6b64\u65f6\uff0c\u4ed6\u4e0d\u5982\u9009\u62e9\u5176\u4e2d\u6743\u503c\u6700\u5927\u7684\u4e24\u4e2a\u70b9\u8fdb\u884c\u8d70\u52a8\uff0c\u53cd\u800c\u66f4\u4f18\u3002\n\n\u5c31\u6bd4\u5982\u8bf4\uff0c\u8fd9\u4e09\u4e2a\u70b9\u5206\u522b\u662f1,2,3\uff0c\u6743\u503c\u4e3a$a,b,c$\u3002\u5982\u679c\u8fd9\u4e48\u6765\u56de\u8d70\uff0c\u90a3\u4e48\u5c31\u662f$1 \\to 2 \\to 3 \\to 2 \\to 1 \\to 2 \\to 3 \\to 2 \\cdots$\u3002\n\n\u660e\u663e\u53ef\u4ee5\u770b\u51fa\uff0c\u5468\u671f\u4e3a4\uff0c\u5e76\u4e14\u4e00\u4e2a\u5468\u671f\u5e73\u5747\u6743\u503c\u4e3a $\\dfrac{2b+a+c}{4}$\u3002\n\n\u5f53\u7136\uff0c\u6211\u4eec\u8fd8\u6709\u4e24\u79cd\u51b3\u7b56\uff0c\u5e73\u5747\u6743\u503c\u5206\u522b\u4e3a $\\dfrac{a+b}{2}$ \u4e0e $\\dfrac{b+c}{2}$\u3002\n\n\u56e0\u4e3a $\\dfrac{b+c}{2} + \\dfrac{a+b}{2}=2 \\cdot \\dfrac{2b+a+c}{4}$\u3002\n\n\u6240\u4ee5\u8fd9\u4e24\u8005\u5e73\u5747\u6743\u503c\u5fc5\u6709\u4e00\u4e2a\u5927\u4e8e\u540e\u8005\u3002\n\n\u7efc\u4e0a\uff0c\u6211\u4eec\u8bc1\u660e\u4e86\u5fc5\u987b\u5728\u76f8\u90bb\u4e24\u4e2a\u70b9\u6765\u56de\u8d70\u52a8\u3002\n\n\u7136\u540e\u8fd8\u662f dp\u3002\u72b6\u6001\u7c7b\u4f3c\uff0c\u5c31\u662f\u6b65\u6570\u4e0a\u9650\u53d8\u6210\u4e86 $n\\cdot m$\u3002\u4e2d\u9014\u6839\u636e\u5f15\u7406\u7edf\u8ba1\u7b54\u6848\u3002\n\n$f_{i,j,k} = \\max{f_{i-1,j,k-1},f_{i+1,j,k-1},f_{i,j-1,k-1},f_{i,j+1,k-1}} + a_{i, j}$\n\n\u5176\u4e2d $k$ \u8fd9\u4e00\u7ef4\u7528\u6eda\u52a8\u6570\u7ec4\u53ef\u4ee5\u4f18\u5316\u6389\u3002\n\n\u8ba1\u7b97\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u987a\u4fbf\u7edf\u8ba1\u4e00\u4e0b\u7b54\u6848\uff0c\u53ea\u8981\u6839\u636e\u5f15\u7406\uff0c\u53d6\u4e0e\u5f53\u524d\u8fd9\u4e2a\u70b9\u76f8\u90bb\u7684\u70b9\u4e2d\u6743\u503c\u6700\u5927\u7684\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2m^2)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $O(nm)$\uff0c\u8db3\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\u53e6\u5916\uff0c\u5f88\u660e\u663e\u8981\u5f00 long long\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint n, m, a[110][110], A, B;\ntypedef long long ll;\nll f[110][110][2], ans, K;\nconst int dx[] = {1, -1, 0, 0}, dy[] = {0, 0, -1, 1};\nbool valid(int x, int y) {\n\treturn x >= 1 && x <= n && y >= 1 && y <= m;\n}\nint main() {\n\tscanf(\"%d%d%d%d%lld\", &n, &m, &A, &B, &K);\n\tfor (register int i = 1; i <= n; ++i)\n\t\tfor (register int j = 1; j <= m; ++j) scanf(\"%d\", a[i] + j);\n\tbool tag = 1;\n\tmemset(f, 0xcf, sizeof f);\n\tf[A][B][1] = 0;\n\tfor (register int k = 1; k <= min(1ll * n * m, K >> 1); ++k) {\n\t\ttag ^= 1;\n\t\tfor (register int i = 1; i <= n; ++i)\n\t\t\tfor (register int j = 1; j <= m; ++j) {\n\t\t\t\tll maxc = 0;\n\t\t\t\tfor (register int p = 0; p < 4; ++p) {\n\t\t\t\t\tint nx = i + dx[p], ny = j + dy[p];\n\t\t\t\t\tif (!valid(nx, ny)) continue;\n\t\t\t\t\tf[i][j][tag] = max(f[i][j][tag], f[nx][ny][tag ^ 1] + a[i][j]);\n\t\t\t\t\tmaxc = max(maxc, 1ll * a[i][j] + a[nx][ny]);\n\t\t\t\t}\n\t\t\t\tans = max(ans, (f[i][j][tag]) * 2 + (K / 2 - k) * maxc - a[i][j]);\n\t\t\t}\n\t} \n\tprintf(\"%lld\", ans);\n}\n```\n",
        "postTime": 1636540883,
        "uid": 162196,
        "name": "\u4f1f\u5927\u7684\u738b\u592b\u5b50",
        "ccfLevel": 6,
        "title": "P7311 [COCI2018-2019#2] Maja \u9898\u89e3"
    }
]
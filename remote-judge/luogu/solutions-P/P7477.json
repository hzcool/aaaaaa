[
    {
        "content": "\u4e00\u4e2a\u5947\u5f02\u7684\u60f3\u6cd5\uff0c\u7ed3\u679c\u8c03\u4e86\u6211\u4e00\u5468\u591a\u3002\u3002\u3002  \n### 40pts(1)  \n\u4e8c\u5206\u5f88\u597d\u770b\u51fa\u6765\uff0c\u5173\u952e\u5728\u5224\u5b9a\u3002  \n\u5982\u679c\u5408\u6cd5\u7684\u8bdd\uff0c\u4e00\u4e2a\u6570\u8981\u4e48\u88ab\u5212\u5206\u8fdb $a$\uff0c\u8981\u4e48\u88ab\u5212\u5206\u8fdb $b$\uff0c\u7531\u6b64\u6211\u4eec\u53ef\u4ee5\u60f3\u7528 2-SAT \u53bb\u5224\u5b9a\u3002\u8fd9\u6837\uff0c\u4e5f\u80fd\u5904\u7406\u4e0b\u9762\u7684 $u$ \u548c $v$ \u4e0d\u5728\u540c\u4e00\u4e2a\u53ef\u91cd\u96c6\u7684\u95ee\u9898\u3002  \n\u5bf9\u4e8e\u90a3\u4e24\u4e2a\u57fa\u672c\u6761\u4ef6\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $j<i\\ \\text{and}\\ v_j\\le v_i-k$ \u7684 $j$ \u90fd\u8fde\u4e00\u6761 $j$ \u9009\u4e86 $a,i$ \u5c31\u4e0d\u80fd\u9009 $a$ \u7684\u8fb9\u3002\u540c\u7406\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $j<i\\ \\text{and}\\ v_j\\ge v_i+k$ \u7684 $j$ \u90fd\u8fde\u4e00\u6761 $j$ \u9009\u4e86 $b,i$ \u5c31\u4e0d\u80fd\u9009 $b$ \u7684\u8fb9\u3002  \n\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u66b4\u529b\u8fde\u8fb9\uff0c\u867d\u7136\u6700\u591a $n^2$ \u6761\u8fb9\uff0c\u4f46\u524d\u9762 40 \u5206\u7684\u6570\u636e\u8fd8\u662f\u53ef\u4ee5\u901a\u8fc7\u7684\u3002  \n### 40pts(2)  \n\u518d\u770b $m=0$ \u7684\u60c5\u51b5\uff0c$a$ \u4e2d\u7684\u6bcf\u4e2a\u6570\u4fdd\u8bc1\u4e86 $a_i<\\min {a_j}+k$\uff0c$b$ \u4e2d\u7684\u6bcf\u4e2a\u6570\u4fdd\u8bc1\u4e86 $b_i>\\max {b_j}-k$\u3002  \n\u73b0\u5728\u6211\u4eec\u8bb0\u5f55 $a$ \u4e2d\u6700\u5c0f\u503c\u548c $b$ \u4e2d\u6700\u5927\u503c\uff0c\u6bcf\u6b21\u6765\u4e00\u4e2a\u6570\u770b\u80fd\u4e0d\u80fd\u653e\u8fdb\u53bb\uff0c\u653e\u54ea\u4e00\u4e2a\u66f4\u4f18\u4e00\u4e9b\uff0c\u7136\u540e\u66f4\u65b0\u3002  \n\u5982\u679c\u6709\u4e00\u4e2a\u653e\u4e0d\u8fdb\u53bb\uff0c\u90a3\u5c31\u8bf4\u660e\u975e\u6cd5\u3002\uff08\u53e3\u80e1\u7b97\u6cd5\uff09  \n## 100pts  \n\u663e\u7136\u8fd9\u4e24\u4e2a\u7b97\u6cd5\u4e0d\u80fd\u76f4\u63a5\u7ed3\u5408\u518d\u4e00\u8d77\uff0c\u6211\u4eec\u8003\u8651\u4f18\u5316\u5176\u4e2d\u4e00\u4e2a\u7b97\u6cd5\u3002\u6211\u4eec\u53d1\u73b0\u90a3\u4e2a\u8d2a\u5fc3\u7b97\u6cd5\u6bd4\u8f83\u96be\u5904\u7406 $u$ \u548c $v$ \u4e4b\u95f4\u4e0d\u80fd\u8fde\u8fb9\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u4f18\u5316\u7b2c\u4e00\u4e2a\u7b97\u6cd5\u7684\u8fde\u8fb9\u8fc7\u7a0b\u3002  \n\u8fd9\u76f8\u5f53\u4e8e\u5b9e\u5728 2-SAT \u4e2d\u5411 $j<i\\ \\text{and}\\  v_j\\le v_i-k $ \u548c $j<i\\ \\text{and}\\ v_j\\ge v_i+k $ \u5206\u522b\u8fde\u8fb9\u3002\u8fd9\u65f6\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e3b\u5e2d\u6811\u6216\u8005\u6811\u72b6\u6570\u7ec4\uff08orz \u30fc\u5ff5\u4e4b\u95f4\u3001\u3001\uff09\u4f18\u5316\u5efa\u56fe\u3002  \n\u5047\u8bbe\u5c06\u6743\u503c\u79bb\u6563\u5316\u540e\uff0c\u6211\u4eec\u5c06\u5176\u5efa\u6210\u4e86\u4e00\u4e2a\u6811\u72b6\u6570\u7ec4\u3002  \n![](https://cdn.luogu.com.cn/upload/image_hosting/hlxof0kh.png)  \n\u6211\u4eec\u63a5\u4e0b\u6765\u5047\u8bbe\u5f80\u5165\u6811\u4e2d\u63d2\u5165\u4e86\u8282\u70b91\u548c2\u3002  \n![](https://cdn.luogu.com.cn/upload/image_hosting/ufzlkzcx.png)  \n\u901a\u8fc7\u5f53\u524d\u6811\u72b6\u6570\u7ec4\u8282\u70b9\u6307\u5411\u4e0a\u4e00\u4e2a\u7684\u65e7\u8282\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8fd9\u6837\u5f97\u5230\u4ee5\u524d\u7684\u4fe1\u606f\uff0c\u4ece\u800c\u4f18\u5316\u5efa\u56fe\u3002\u6211\u4eec\u8fdb\u884c\u8fde\u8fb9\u65f6\uff0c\u6bcf\u6b21\u8fde\u5411\u5f53\u524d\u7684\u6811\u72b6\u6570\u7ec4\u8282\u70b9\u5c31\u53ef\u4ee5\u5f97\u5230\u76f8\u5e94\u7684\u8fb9\u3002  \n\u6ce8\u610f\u7ec6\u8282\u3002  \n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nchar __buf[1<<12],*__p1,*__p2;\n//#define getchar() (__p1==__p2?(__p2=__buf+fread(__p1=__buf,1,1<<12,stdin),__p1==__p2?EOF:*__p1++):*__p1++)\ninline int read() {\n\tint __x=0,__f=1;\n\tchar __c=getchar();\n\twhile(__c<'0'||__c>'9') {\n\t\tif(__c=='-')__f=-1;\n\t\t__c=getchar();\n\t}\n\twhile(__c>='0'&&__c<='9') {\n\t\t__x=__x*10+__c-'0';\n\t\t__c=getchar();\n\t}\n\treturn __x*__f;\n}\nchar __F[200];\ninline void write(int __x) {\n\tif(__x<0) {\n\t\tputchar('-');\n\t\t__x=-__x;\n\t}\n\tif(__x>=10)write(__x/10);\n\tputchar(__x%10+'0');\n}\nconst int maxn=2e4+5,maxm=2e6+5;\nstruct edge {\n\tint next,to;\n} e[maxm*4],w[maxn*8];\nint a[maxn],g[maxn*2],book[maxn],bc,cnt,cnt2,h[maxm],dfn[maxm],low[maxm],col[maxm],color,n,m,s1[maxn][2],s2[maxn][2],tot,ans,ind,midd;\nbool inst[maxm];\nstack<int> s;\ninline void addedge(int x,int y) {\n\te[++cnt].next=h[x];\n\te[cnt].to=y;\n\th[x]=cnt;\n}\ninline void addedge2(int x,int y) {\n\tw[++cnt2].next=g[x];\n\tw[cnt2].to=y;\n\tg[x]=cnt2;\n}\ninline int lowbit(int x) {\n\treturn x&(-x);\n}\ninline void add(int x,int y,int pd) {\n//s1\u8868\u793a\u5165\u6811\uff0cs2\u8868\u793a\u51fa\u6811\u3002\u6211\u4eec\u5728\u5411\u91cc\u9762\u6dfb\u52a0\u7684\u65f6\u5019\uff0c\u5165\u6811\u5f80\u5b83\u8fde\u8fb9\uff1b\u5b83\u5f80\u51fa\u6811\u8fde\u8fb9\u3002\n\tfor(register int i=x; i<=bc; i+=lowbit(i)) {\n\t\ttot++;\n\t\tif(s1[i][pd]) {\n\t\t\taddedge(tot,s1[i][pd]);\n\t\t\taddedge(tot+1,s1[i][pd]+1);//\u5f80\u4ee5\u524d\u53d6\u5230\u8fd9\u4e2a\u503c\u7684\u70b9\u8fde\u8fb9\n\t\t}\n\t\ts1[i][pd]=tot;\n\t\taddedge(tot,y);\n\t\taddedge(tot+1,y+1);//\u628a\u8fd9\u4e2a\u70b9\u6302\u5728\u5165\u6811\u4e0b\u9762\n\t\ttot+=2;\n\t\tif(s2[i][pd]) {\n\t\t\taddedge(s2[i][pd],tot);//\u540c\u7406\n\t\t\taddedge(s2[i][pd]+1,tot+1);\n\t\t}\n\t\ts2[i][pd]=tot;\n\t\taddedge(y,tot);\n\t\taddedge(y+1,tot+1);\n\t\ttot++;\n\t}\n}\ninline void link(int x,int y,int pd) {\n\tint w=pd^1;\n\tfor(register int i=x; i; i-=lowbit(i)) {\n\t\tif(s1[i][pd])addedge(y+pd,s1[i][pd]+w);//\u5411\u5bf9\u9762\u8fde\u8fb9\n\t\tif(s2[i][pd])addedge(s2[i][pd]+pd,y+w);\n\t}\n}\ninline void tarjan(int u) {\n\ts.push(u);\n\tinst[u]=1;\n\tdfn[u]=low[u]=++ind;\n\tfor(register int i=h[u]; i; i=e[i].next) {\n\t\tint j=e[i].to;\n\t\tif(!dfn[j]) {\n\t\t\ttarjan(j);\n\t\t\tlow[u]=min(low[u],low[j]);\n\t\t} else if(inst[j]) {\n\t\t\tlow[u]=min(low[u],dfn[j]);\n\t\t}\n\t}\n\tif(u<=n*2) {//\u6ce8\u610f\u8fd9\u91cc\u53ef\u80fd\u9020\u6210\u7684\u6570\u7ec4\u8d8a\u754c\n\t\tfor(register int i=g[u]; i; i=w[i].next) {\n\t\t\tint j=w[i].to;\n\t\t\tif(!dfn[j]) {\n\t\t\t\ttarjan(j);\n\t\t\t\tlow[u]=min(low[u],low[j]);\n\t\t\t} else if(inst[j]) {\n\t\t\t\tlow[u]=min(low[u],dfn[j]);\n\t\t\t}\n\t\t}\n\t}\n\tif(dfn[u]==low[u]) {\n\t\tcolor++;\n\t\tint k;\n\t\tdo {\n\t\t\tk=s.top();\n\t\t\ts.pop();\n\t\t\tinst[k]=0;\n\t\t\tcol[k]=color;\n\t\t} while(k!=u);\n\t}\n}\ninline bool check(int mid) {\n\tmemset(h,0,sizeof(h));\n\tmemset(dfn,0,sizeof(dfn));\n\tmemset(low,0,sizeof(low));\n\tmemset(col,0,sizeof(col));\n\tmemset(s1,0,sizeof(s1));\n\tmemset(s2,0,sizeof(s2));\n\tcnt=ind=color=0;\n\twhile(!s.empty()) {\n\t\ts.pop();\n\t}\n\ttot=2*n;\n\tfor(register int i=1; i<=n; i++) {\n\t\tint p=upper_bound(book+1,book+bc+1,a[i]-mid)-book-1;//\u6ce8\u610f\u662fupper_bound\n\t\tif(p)link(p,i*2-1,0);\n\t\tp=lower_bound(book+1,book+bc+2,a[i]+mid)-book;//\u8fd9\u91cc\u53f3\u8fb9\u754c\u662fbc+1\n\t\tif(p<=bc)link(bc-p+1,i*2-1,1);\n\t\tp=lower_bound(book+1,book+bc+1,a[i])-book;\n\t\tadd(p,i*2-1,0);\n\t\tadd(bc-p+1,i*2-1,1);\n\t}\n\tfor(register int i=1; i<=2*n; i++) {\n\t\tif(!dfn[i]) {\n\t\t\ttarjan(i);\n\t\t}\n\t}\n\tfor(register int i=1; i<=n; i++) {\n\t\tif(col[i*2-1]==col[i*2]) {\n\t\t\treturn 0;\n\t\t}\n\t}\n\treturn 1;\n}\nint main() {\n\tint x,y;\n\tn=read(),m=read();\n\tfor(register int i=1; i<=n; i++) {\n\t\ta[i]=read();\n\t\tbook[++bc]=a[i];\n\t}\n\tsort(book+1,book+bc+1);\n\tbc=unique(book+1,book+bc+1)-book-1;//\u79bb\u6563\u5316\n\tbook[bc+1]=book[bc]+1;//\u6ce8\u610f\u5f80\u6bd4\u5b83\u5927\u7684\u8fde\u8fb9\u65f6\u6240\u53d6\u7684\u503c\u80fd\u4e0d\u80fd\u53d6\u5230\u6700\u540e\u4e00\u4e2a\u3002\n\tfor(register int i=1; i<=m; i++) {\n\t\tx=read(),y=read();\n\t\taddedge2(x*2-1,y*2);\n\t\taddedge2(x*2,y*2-1);\n\t\taddedge2(y*2,x*2-1);\n\t\taddedge2(y*2-1,x*2);\n\t}\n\tfor(register int i=1; i<=2*n; i++) {\n\t\tif(!dfn[i]) {\n\t\t\ttarjan(i);\n\t\t}\n\t}\n\tfor(register int i=1; i<=n; i++) {\n\t\tif(col[i*2-1]==col[i*2]) {\n\t\t\tputs(\"-1\");\n\t\t\treturn 0;\n\t\t}\n\t}\n\tint l=1,r=1e9;\n\twhile(l<=r) {\n\t\tint mid=(l+r)/2;\n\t\tif(check(mid)) {\n\t\t\tans=mid;\n\t\t\tr=mid-1;\n\t\t} else {\n\t\t\tl=mid+1;\n\t\t}\n\t}\n\twrite(ans);\n\treturn 0;\n}\n```",
        "postTime": 1609854425,
        "uid": 104324,
        "name": "abruce",
        "ccfLevel": 7,
        "title": "\u9898\u89e3--\u5212\u5206\u53ef\u91cd\u96c6"
    },
    {
        "content": "## \u4e8c\u5206 + 2-SAT + cdq\u4f18\u5316\u5efa\u56fe\n\n\u9996\u5148\u770b\u5230  $k$  \u7684\u9650\u5236\uff0c  $k$  \u8d8a\u5927\u8d8a\u4e0d\u53ef\u80fd\u5408\u6cd5\uff0c\u53ef\u4ee5\u4e8c\u5206\u3002\n\n\u7136\u540e\u8003\u8651\u4e00\u4e2a\u5212\u5206\u4e2d\u4e00\u4e2a\u6570\u975e  $a$  \u5373  $b$  \uff0c\u53ef\u4ee5\u7528  2-SAT  \u5224\u5b9a\u3002\n\n\u7136\u540e\u53d1\u73b0\u8fde\u8fb9\u7a0d\u5fae\u6709\u70b9\u591a\uff0c\u4f46\u662f\u8fde\u8fb9\u7684\u65f6\u5019\u53ef\u4ee5\u4e00\u4e0b\u5b50\u8fde\u67d0\u4e2a\u533a\u95f4\uff0c\u8003\u8651\u53ef\u4ee5\u6570\u636e\u7ed3\u6784\u4f18\u5316\u4e00\u4e0b\u3002\n\n\u518d\u7ec6\u770b\u4e00\u4e0b\uff0c\u524d\u4e24\u4e2a\u6761\u4ef6\u90fd\u662f\u504f\u5e8f\u7684\u5f62\u5f0f\uff0c\u6240\u4ee5\u60f3\u5230  cdq  \u5206\u6cbb\u3002\n\n\u7b2c\u4e00\u7ef4\u6309\u539f\u6570\u7ec4\u987a\u5e8f\u5373\u53ef\uff0c\u5206\u6cbb\u4e0b\u53bb\uff0c\u7528\u5f52\u5e76\u7684\u65b9\u5f0f\u53ef\u4ee5\u5c06\u7b2c\u4e8c\u7ef4\u6392\u5e8f\u3002\u7136\u540e\u6bcf\u6b21\u5904\u7406\u4ece\u53f3\u533a\u95f4\u8fde\u5411\u5de6\u533a\u95f4\u7684\u8fb9\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u53f3\u533a\u95f4\u5bf9\u5de6\u533a\u95f4\u7684\u9650\u5236\u6761\u4ef6\u662f\u4e00\u4e2a\u524d\u7f00\u6216\u540e\u7f00\uff0c\u53ef\u4ee5\u8003\u8651\u76f4\u63a5\u8fde\u51fa\u4e00\u6761\u94fe\u7136\u540e\u628a\u6761\u4ef6\u4ece\u94fe\u4e2d\u95f4\u63d2\u8fdb\u53bb\u3002\n\n\u5047\u8bbe\u5f53\u524d\u5206\u6cbb\u533a\u95f4  $[L,R]$    \u3002\n\n\u5bf9\u4e8e\u5de6\u533a\u95f4  $[L,mid]$  \u7684\u90a3\u6761\u94fe\u53ef\u4ee5\u8fd9\u6837\u5efa\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8w8qqft0.png)\n\n\u90a3\u4e48\u53ef\u4ee5\u53d1\u73b0\uff0c\u5bf9\u4e8e\u5f62\u5982\u201c\u82e5  $i$  \u8fdb\u4e86  $a$  (\u6216  $b$  )\uff0c\u5219\u67d0\u4e2a\u524d\u7f00\u4e2d\u7684\u70b9\u90fd\u8fdb\u4e86  $b$  (\u6216  $a$  )\u3002\u201d \u7684\u6761\u4ef6\u90fd\u6709\u552f\u4e00\u5bf9\u5e94\u7684\u70b9\u3002\u6240\u4ee5\u76f4\u63a5\u53cc\u6307\u9488\u627e\u5230\u5bf9\u5e94\u70b9\uff0c\u6a21\u62df\u6761\u4ef6\u628a\u533a\u95f4  $[mid+1,R]$  \u7684\u70b9\u5f80\u94fe\u4e0a\u9762\u8fde\u8fb9\u5c31\u53ef\u4ee5\u4e86\u3002\u5728\u4ee3\u7801\u4e2d\u6709\u8be6\u7ec6\u8bf4\u660e\u3002\n\n\u7136\u540e\u76f4\u63a5\u8dd1  tarjan  \u5224\u5b9a  2-SAT  \u5373\u53ef\u3002\n\n\u503c\u5f97\u4e00\u63d0\uff0c\u8dd1\u5b8c  tarjan  \u53ef\u4ee5\u53ea\u7528\u5224\u5b9a\u539f\u5148\u7684\u70b9\u53ca\u5bf9\u7acb\u70b9\u662f\u5426\u5728\u540c\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u4e2d\u5373\u53ef\uff0c\u56e0\u4e3a  cdq  \u5206\u6cbb\u9644\u52a0\u4e0a\u7684\u70b9\u4e0e\u539f\u5148\u7684\u70b9\u76f4\u63a5\u76f8\u5173\uff0c\u4e0d\u53ef\u80fd\u5728\u539f\u5148\u7684\u70b9\u7b26\u5408\u6761\u4ef6\u7684\u57fa\u7840\u4e0a\u8fd9\u4e9b\u70b9\u4e0a\u51fa\u73b0\u77db\u76fe\u3002\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u8fde\u51fa\u6765\u7684\u8fb9\u662f  $O(n\\log n)$  \u7684\u3002\u56e0\u6b64\u603b\u590d\u6742\u5ea6  $O(n\\log n\\log V)$   \u3002\n\n\u4ee3\u7801\uff1a\n\n```\n#include<cstdio>\n#include<cstring>\n#define rep(a,b,c) for(int c(a);c<=(b);++c)\n#define drep(a,b,c) for(int c(a);c>=(b);--c)\n#define grep(b,c) for(int c(head[b]);c;c=nxt[c])\ntypedef long long LL;\ninline int read()\n{\n\tint res=0;char ch=getchar();while(ch<'0'||ch>'9')ch=getchar();\n\twhile(ch<='9'&&ch>='0')res=res*10+(ch^48),ch=getchar();return res;\n}\ntemplate<typename T> inline T min(const T &x,const T &y){return x<y?x:y;}\nconst int N=2e4+10;int a[N],n,I[1000010]; struct Nd\n{\n\tint p,v;inline Nd(const int &x=0,const int &y=0){p=x;v=y;}\n\tinline bool operator<(const Nd&x)const{return v==x.v?p<x.p:v<x.v;}\n}w[N],t[N];\nnamespace TwoSat\n{\n\tconst int N=1e6+10,M=5e6+10;\n\tint head[N],des[M],nxt[M],cgt,S=1,low[N],dfn[N],tot,stk[N],top,cdt,h2[N],scc[N];bool iss[N];\n\tinline void ins(const int &x,const int &y){nxt[++cgt]=head[x];des[head[x]=cgt]=y;}\n\tinline void tarjan(const int &u)\n\t{\n\t\tiss[stk[++top]=u]=true;low[u]=dfn[u]=++cdt; grep(u,i)\n\t\t{\n\t\t\tint v=des[i];if(!dfn[v])tarjan(v),low[u]=min(low[u],low[v]);\n\t\t\telse if(iss[v])low[u]=min(low[u],low[v]);\n\t\t}\n\t\tif(dfn[u]==low[u]){int v;++tot;do iss[v=stk[top--]]=false,scc[v]=tot;while(u!=v);}\n\t}\n\tinline bool Judge()\n\t{\n\t\tcdt=tot=0;memset(dfn,0,(S+2)<<2);memset(scc,0,(S+2)<<2);\n\t\trep(1,S,i)if(!dfn[i])tarjan(i);\n//\t\trep(1,n,i)printf(\"(%d,%d) \",scc[i],scc[i+n]);puts(\"\");printf(\"QAQAQ :: %d\\n\",tot);\n\t\trep(1,n,i)if(scc[i]==scc[i+n])return false;\n//\t\tfor(int i=n<<1|1;i<=S;i+=2)if(scc[i]==scc[i+1])return false;\n\t\treturn true;\n\t}\n}\nusing TwoSat::head;using TwoSat::cgt;using TwoSat::Judge;using TwoSat::ins;using TwoSat::h2;using TwoSat::S;\nint idx[N][2],K;inline void cdq(const int &l,const int &r)\n{\n\t//idx[i][0]   --> [i,r] all in a\n\t//idx[i][0]+1 --> [i,r] not all in a\n\t//idx[i][1]   --> [l,i] all in b\n\t//idx[i][1]+1 --> [l,i] not all in b\n\tif(l==r)return;const int &mid=(l+r)>>1;cdq(l,mid);cdq(mid+1,r);\n\trep(l,mid,i)\n\t{\n\t\tins(idx[i][0]=++S,w[i].p);ins(w[i].p+n,++S);\n\t\tins(idx[i][1]=++S,w[i].p+n);ins(w[i].p,++S);\n\t}\n\trep(l+1,mid,i)\n\t{\n\t\tins(idx[i-1][0],idx[i][0]);ins(idx[i][0]+1,idx[i-1][0]+1);\n\t\tins(idx[i][1],idx[i-1][1]);ins(idx[i-1][1]+1,idx[i][1]+1);\n\t\t//if()\n\t}\n\tint j=l-1;rep(mid+1,r,i)\n\t{\n\t\twhile(j<mid&&w[j+1].v<=w[i].v-K)++j;\n\t\tif(j!=l-1)ins(w[i].p,idx[j][1]),ins(idx[j][1]+1,w[i].p+n);\n\t\t//if(w[i].p in a) [l,loc(w[i].v-K)] all in b\n\t\t//if([l,loc(w[i].v-K)] not all in b) w[i].p in b\n\t}\n\tj=mid+1;drep(r,mid+1,i)\n\t{\n\t\twhile(j>l &&w[j-1].v>=w[i].v+K)--j;\n\t\tif(j!=mid+1)ins(w[i].p+n,idx[j][0]),ins(idx[j][0]+1,w[i].p);\n\t\t//if(w[i].p in b) [loc(w[i].v+K),r] all in a\n\t\t//if([loc(w[i].v+K),r] not all in b) w[i].p in a\n\t}\n\tint pl=l,pr=mid+1,p=l-1;while(pl<=mid&&pr<=r)t[++p]=w[pl]<w[pr]?w[pl++]:w[pr++];\n\twhile(pl<=mid)t[++p]=w[pl++];while(pr<=r)t[++p]=w[pr++];rep(l,r,i)w[i]=t[i];\n}\ninline bool check(const int &k)\n{\n\tmemcpy(head,h2,(S+2)<<2);S=n*2;K=k;int lst=cgt;\n\trep(1,n,i)w[i]=Nd(i,a[i]);cdq(1,n);\n\tbool res=Judge();cgt=lst;return res;\n}\nint main()\n{\n\tn=read();int m=read();rep(1,n,i)a[i]=read();S=n*2;\n\trep(1,m,i){int x=read(),y=read();ins(x,y+n);ins(x+n,y);ins(y,x+n);ins(y+n,x);}\n\tif(!Judge())return puts(\"-1\"),0; memcpy(h2,head,(S+2)<<2);\n\tint l=0,r=1e9+10,res=-1,mid; while(l<=r)check(mid=(l+r)>>1)?r=mid-1,res=mid:l=mid+1;\n\tprintf(\"%d\\n\",res);return 0;\n}\n```",
        "postTime": 1655444355,
        "uid": 191281,
        "name": "Jr_Zlw",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P7477 \u5212\u5206\u53ef\u91cd\u96c6"
    },
    {
        "content": "\u8da3\u5473\u7ec3\u53cd\u5e94\u9898\n\n\u770b\u8d77\u6765 $n,m$ \u53ea\u6709 $2\\times 10^4$\uff0c\u90a3\u6211\u4eec\u6765 $\\Theta(n\\sqrt n\\log n)$ \u7684 KDT \u4f18\u5316\u5efa\u56fe\u5427\uff01\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u672c\u6587\u4e2d\u5c06\u4f7f\u7528 $x_i$ \u8868\u793a $i$ \u5728\u7b2c $1$ \u4e2a\u96c6\u5408\u4e2d\u7684\u60c5\u51b5\uff0c$x'_i$ \u8868\u793a\u5728\u7b2c\u4e8c\u4e2a\u4e2d\u7684\u60c5\u51b5\n\n\u5bf9\u4e8e\u7b54\u6848\u4e3a $-1$ \u7684\u60c5\u51b5\u662f\u7ed9\u5b9a\u7684 $m$ \u4e2a\u76f8\u5f02\u96c6\u5408\u7684\u9650\u5236\u4e2d\u4ea7\u751f\u4e86\u51b2\u7a81\uff0c\u53ea\u5efa\u51fa $2n$ \u4e2a\u70b9\u7684\u56fe\u8dd1\u4e00\u904d $\\rm 2-sat$ \u5373\u53ef\n\n\u4e0d\u96be\u53d1\u73b0\u662f\u5426\u53ef\u884c\u5177\u6709\u5355\u8c03\u6027\uff0c\u6240\u4ee5\u4e8c\u5206\u7b54\u6848 $mid$\uff0c\u5c06 $(i,v_i)$ \u89c6\u4f5c\u4e8c\u7ef4\u5e73\u9762\u4e0a\u7684\u4e00\u4e2a\u70b9\uff0c\u6240\u4ee5\u6bcf\u4e2a\u70b9\u5c06\u548c\u4e00\u4e2a\u77e9\u5f62\u4e2d\u7684\u70b9\u4ea7\u751f\u4e92\u76f8\u9650\u5236\n\n\u76f4\u63a5\u4f7f\u7528 KDT \u4f18\u5316\u5efa\u56fe\u53ef\u4ee5\u5c06\u8fb9\u6570\u964d\u81f3 $\\Theta(n\\sqrt n)$\uff0c\u800c\u540e\u7eed\u5224\u65ad\u4ecd\u7136\u4f7f\n\u7528 `tarjan` \u5373\u53ef\n\n\u5173\u4e8e KDT \u4f18\u5316\u5efa\u56fe\u8fd8\u662f\u6bd4\u8f83\u5e73\u51e1\u7684\uff0c\u6309\u7167\u4e0e\u7ebf\u6bb5\u6811\u4f18\u5316\u5efa\u56fe\u76f8\u540c\u7684\u65b9\u5f0f\u5efa\u7acb\u4e0a\u5411\u6811\u548c\u4e0b\u5411\u6811\uff0c\u8282\u70b9\u81ea\u5df1\u8fde\u5411\u4e0a\u5411\u6811\uff0c\u4e0b\u5411\u6811\u8fde\u5411\u8282\u70b9\u81ea\u5df1\uff0c\u70b9\u548c\u77e9\u5f62\u4e4b\u95f4\u7684\u8fde\u8fb9\u9010\u4e2a\u77e9\u5f62\u8fde\u5373\u53ef\n\n\u7531\u4e8e\u4e0d\u60f3\u505a\u53e3\u80e1\u8001\u9e3d\uff0c\u6240\u4ee5\u8fd8\u662f\u5199\u4e86\u4ee3\u7801\n\n```cpp\nconst int N=2e4+10,M=4e5+10;\nint scc,bel[M],nec[M],low[M],n,Q,dfn[M],tim,st[M],top,id1[M],id2[M];\nvector<int> g[M];\nbool vis[M];\ninline void tarjan(int x){\n    dfn[x]=low[x]=++tim; vis[st[++top]=x]=1;\n    for(auto t:g[x]){\n        if(!dfn[t]) tarjan(t),ckmin(low[x],low[t]);\n        else if(vis[t]) ckmin(low[x],dfn[t]);\n    }\n    if(low[x]==dfn[x]){\n        ++scc;\n        do{\n            bel[st[top]]=scc;\n            vis[st[top]]=0;\n        }while(st[top--]!=x);\n    } return ;\n}\nstruct Node{int pos[2],mx[2],mn[2],id;}t[N];\nint ls[N],rs[N],tot,rt,v[N];\ninline void push_up(int p){\n    rep(i,0,1) t[p].mx[i]=t[p].mn[i]=t[p].pos[i];\n    for(auto son:{ls[p],rs[p]}) if(son){\n        rep(i,0,1){\n            ckmin(t[p].mn[i],t[son].mn[i]);\n            ckmax(t[p].mx[i],t[son].mx[i]);\n        }\n    } return ;\n}\ninline int up(int x,int tr){return 2*n+x+tr*n;}\ninline int down(int x,int tr){return 4*n+x+tr*n;}\nint lef[2],qid,rig[2];\ninline bool in(int x){\n    rep(i,0,1) if(t[x].mn[i]<lef[i]||t[x].mx[i]>rig[i]) return 0;\n    return 1;\n}\ninline bool pin(int p){\n    rep(i,0,1) if(lef[i]>t[p].pos[i]||rig[i]<t[p].pos[i]) return 0;\n    return 1;\n}\ninline bool out(int p){\n    rep(i,0,1) if(t[p].mx[i]<lef[i]||t[p].mn[i]>rig[i]) return 1;\n    return 0;\n}\ninline void Query(int p,int cur){\n    if(in(p)){\n        g[qid+cur*n].pb(down(p,!cur));\n        g[up(p,cur)].pb(qid+(!cur)*n);\n        return ;\n    }\n    if(out(p)) return ;\n    if(pin(p)){\n        g[qid+cur*n].pb(t[p].id+(!cur)*n);\n        g[t[p].id+cur*n].pb(qid+(!cur)*n);\n    }\n    if(ls[p]) Query(ls[p],cur); if(rs[p]) Query(rs[p],cur);\n    return ;\n}\ninline bool check(int mid){\n    rep(i,1,6*n){\n        while(nec[i]<g[i].size()) g[i].pop_back();\n        low[i]=dfn[i]=st[i]=bel[i]=0;\n    } tim=top=0;\n    rep(i,2,n){\n        lef[0]=1; rig[0]=i-1; qid=i;\n        lef[1]=0; rig[1]=v[i]-mid;\n        if(lef[1]<=rig[1]) Query(rt,0);\n        lef[1]=v[i]+mid; rig[1]=1e9;\n        if(lef[1]<=rig[1]) Query(rt,1);\n    }\n    rep(i,1,6*n) if(!dfn[i]) tarjan(i);\n    for(int i=1;i<=n;++i) if(bel[i]==bel[i+n]) return 0;\n    return 1;\n}\ninline int build(int l,int r,int cur,int fat){\n    if(r<l) return 0; int mid=(l+r)>>1;\n    nth_element(t+l,t+mid,t+r+1,[&](const Node a,const Node b){\n        return a.pos[cur]<b.pos[cur];\n    });\n    g[t[mid].id].pb(up(mid,0)); g[down(mid,0)].pb(t[mid].id);\n    g[t[mid].id+n].pb(up(mid,1)); g[down(mid,1)].pb(t[mid].id+n);\n    if(fat){\n        rep(d,0,1){\n            g[up(mid,d)].pb(up(fat,d));\n            g[down(fat,d)].pb(down(mid,d));\n        }\n    }\n    ls[mid]=build(l,mid-1,cur^1,mid); rs[mid]=build(mid+1,r,cur^1,mid);\n    return push_up(mid),mid;\n}\nsigned main(){\n    tot=n=read(); Q=read(); \n    rep(i,1,n) t[i].id=t[i].pos[0]=i,t[i].pos[1]=v[i]=read();\n    while(Q--){\n        int u=read(),v=read();\n        g[u+n].pb(v); g[v].pb(u+n);\n        g[v+n].pb(u); g[u].pb(v+n);\n    }\n    rep(i,1,tot) if(!dfn[i]) tarjan(i);\n    rep(i,1,n) if(bel[i]==bel[i+n]) puts(\"-1\"),exit(0);\n    rt=build(1,n,0,0);\n    rep(i,1,6*n) nec[i]=g[i].size();\n    int ans=1e9,r=1e9-1,l=0;\n    while(l<=r){\n        int mid=(l+r)>>1;\n        if(check(mid)) ans=mid,r=mid-1;\n        else l=mid+1;\n    } print(ans);\n    return 0;\n}\n```",
        "postTime": 1639999996,
        "uid": 97448,
        "name": "yspm",
        "ccfLevel": 9,
        "title": "Luogu7477 Solution"
    }
]
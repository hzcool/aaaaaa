[
    {
        "content": "\u9996\u5148\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u6027\u8d28\uff1a\u82e5\u4e32 $a$ \u548c $b$ \u76f8\u4f3c\u4e14 $b$ \u4e0e $c$ \u76f8\u4f3c\uff0c\u4e00\u5b9a\u6709 $a$ \u4e0e $c$ \u76f8\u4f3c ~~\uff08\u663e\u7136\uff09~~ \u3002 \n\n\u4e8e\u662f\u53ef\u4ee5\u5c06\u6240\u6709\u4e32\u5206\u7ec4\uff0c\u540c\u4e00\u7ec4\u5185\u7684\u4e24\u4e24\u76f8\u4f3c\uff0c\u4e0d\u540c\u7ec4\u7684\u4e0d\u76f8\u4f3c\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u7ec4\uff0c\u4efb\u610f\u9009\u51fa $k$ \u4e2a\uff08$1\\le k\\le size$\uff09\uff0c\u90fd\u4f1a\u6709 $\\frac{k(k-1)}{2}$ \u7684\u8d21\u732e\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5 `dp` \u4e86\u3002\u8bbe $f[i][j]$ \u8868\u793a\u524d $i$ \u7ec4\u4e2d\u9009\u51fa**\u6070\u597d\u6784\u6210 $j$ \u5bf9\u76f8\u4f3c\u4e32**\u7684\u65b9\u6848\u6570\u3002\u679a\u4e3e\u7b2c $i$ \u7ec4\u4e2d**\u9009\u7684\u4e2a\u6570**\uff08$l$\uff09\u5373\u53ef\u3002\u6700\u7ec8\u7b54\u6848\u4e3a $f[tot][k]$ \uff08$tot$ \u4e3a\u7ec4\u6570\uff09\u3002\n\n\u867d\u7136 `dp` \u8fc7\u7a0b\u4e2d\u8981\u679a\u4e3e $3$ \u5c42\uff1a$i,j,l$\u3002\u4f46\u5b9e\u9645\u4e0a\u53ea\u6709 $O(k\\sum size)$ \u5373 $O(nk)$\uff0c\u901a\u8fc7\u6b64\u9898\u6ca1\u6709\u95ee\u9898\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<queue>\nusing namespace std;\n\nconst int mod=1e9+7;\nint n,m,k,a[2005],f[2005][2005],b[2005],jc[2005],inv[2005],p[2005],size[2005],c[25];\nchar s[25];\nint read()\n{\n\tint x=0,f=1;\n\tchar ch=getchar();\n\twhile(ch>'9'||ch<'0'){\n\t\tif(ch=='-')f=-1;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9'){\n\t\tx=(x<<1)+(x<<3)+ch-'0';\n\t\tch=getchar();\n\t}\n\treturn x*f;\n}\nint ksm(int a,int b){\n\tint s=1;\n\twhile(b){\n\t\tif(b&1)s=1ll*s*a%mod;\n\t\ta=1ll*a*a%mod;b>>=1;\n\t}\n\treturn s;\n}\nint getfa(int x){\n\treturn x==p[x]?x:p[x]=getfa(p[x]);\n}\nint C(int n,int m){\n\treturn 1ll*jc[n]*inv[m]%mod*inv[n-m]%mod;\n}\nint main()\n{\n\tn=read();\n\tk=read();\n\tfor(int i=1;i<=n;i++){//\u5c06\u6240\u6709\u4e32\u6392\u5e8f\uff08\u65b9\u4fbf\u5224\u65ad\u662f\u5426\u76f8\u4f3c\uff09\n\t\tcin>>s;\n\t\tint len=strlen(s);\n\t\tfor(int j=1;j<=len;j++)c[j]=s[j-1]-'a';\n\t\tsort(c+1,c+1+len);\n\t\ta[i]=0;\n\t\tfor(int j=1;j<=len;j++)a[i]=(a[i]*299ll+c[j]+1)%mod;\n\t}\n\tjc[0]=1;//\u9636\u4e58\n\tfor(int i=1;i<=n;i++)jc[i]=1ll*jc[i-1]*i%mod;\n\tinv[n]=ksm(jc[n],mod-2);//\u9006\u5143\n\tfor(int i=n-1;i>=0;i--)inv[i]=1ll*inv[i+1]*(i+1)%mod;\n\tfor(int i=1;i<=n;i++)b[i]=b[i-1]+i-1;//b\uff1a\u4e00\u7ec4\u4e2d\u9009i\u4e2a\u7684\u8d21\u732e\n\tfor(int i=1;i<=n;i++)p[i]=i;//\u5e76\u67e5\u96c6\uff0c\u5206\u7ec4\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=i+1;j<=n;j++)\n\t\t\tif(a[i]==a[j]){\n\t\t\t\tint f1=getfa(i);\n\t\t\t\tint f2=getfa(j);\n\t\t\t\tif(f1!=f2)p[f2]=f1;\n\t\t\t}\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tp[i]=getfa(i);\n\t\tsize[p[i]]++;\n\t}\n\tmemset(a,0,sizeof(a));int tot=0;\n\tfor(int i=1;i<=n;i++)if(size[i])a[++tot]=size[i];\n   //tot\uff1a\u7ec4\u6570\uff0ca:\u6bcf\u7ec4\u7684\u4e2a\u6570\n\tf[0][0]=1;//dp\u521d\u59cb\u5316\n\tfor(int i=1;i<=tot;i++){\n\t\tfor(int j=0;j<=k;j++){\n\t\t\tf[i][j]=f[i-1][j];//\u7b2ci\u7ec4\u4e2d\u4e0d\u9009\n\t\t\tfor(int k=1;k<=a[i]&&b[k]<=j;k++){\n\t\t\t\tf[i][j]=(f[i][j]+1ll*f[i-1][j-b[k]]*C(a[i],k)%mod)%mod;//\u7b2ci\u7ec4\u4e2d\u9009k\u4e2a\n\t\t\t}\n\t\t}\n\t}\n\tcout<<f[tot][k];\n\treturn 0;\n}\n```\n",
        "postTime": 1620192309,
        "uid": 36592,
        "name": "Chydz",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P7552"
    },
    {
        "content": "\u5662\uff0c\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u7070\u9898\u7684\u9898\u89e3 ~~\uff08\u518d\u4e0d\u5199\u9898\u89e3\u5c31\u51c9\u4e86\uff09~~\n\n# \u9898\u76ee\u5206\u6790\n\n\u9898\u76ee\u8981\u6c42\u627e\u6709\u591a\u5c11\u5bf9\u9664\u987a\u5e8f\u5916\u4e00\u6a21\u4e00\u6837\u7684\u5b57\u7b26\u4e32\uff0c\u90a3\u4e48\u5c06\u6bcf\u4e2a\u5b57\u7b26\u6392\u5e8f\u540e\u7528 map \u50a8\u5b58\u6216\u7edf\u8ba1\u5404\u4e2a\u5b57\u7b26\u4e2a\u6570\u540e\u5f52\u4e3a\u4e00\u7c7b\u5c31\u884c\u4e86\uff0c\u6211\u4eec\u5c06\u6bcf\u4e00\u7c7b\u5b57\u7b26\u4e32\u7684\u4e2a\u6570\u7edf\u8ba1\u4e0b\u6765\uff0c\u7528 dp \u518d\u7b97\u4e2a\u7ec4\u5408\u6570\u4fbf\u80fd\u89e3\u51b3\u8fd9\u9053\u9898\u3002\n\n\u4f46\u662f\uff0c\u56e0\u4e3a\u7ec4\u5408\u6570\u7684\u7f18\u6545\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u6c42\u9006\u5143 \uff08\u56e0\u4e3a\u7ec4\u5408\u6570\u6709\u9664\u6cd5\uff0c\u542b\u9664\u6cd5\u8fd0\u7b97\u6ca1\u529e\u6cd5\u53d6\u6a21\u51fa\u51c6\u786e\u7684\u503c\uff09\u3002\u800c dp \u4fbf\u7b80\u5355\u4e86\uff0c\u679a\u4e3e\u6bcf\u4e00\u7c7b\u5b57\u7b26\u4e32\u53d6\u51fa\u6765\u7684\u4e2a\u6570\u4fbf\u597d\u4e86\u3002\n\n# \u4ee3\u7801\u5949\u4e0a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int mod = 1000000007;\nstring a;\nint n,k,QAQ,inv[2015],sum[2005],jc[2015],abab[2005],f[2][2005];\nmap <string,int> px;\ninline int Inv(int x,int base=mod-2){\n\tint res=1;\n\twhile(base){\n\t\tif(base&1)res= (long long) res*x%mod;\n\t\tx= (long long) x*x%mod;\n\t\tbase>>=1;\n\t}return res;\n}\ninline void init(){\n\tjc[0]=1;\n\tfor(int i = 1; i <= 2009; i++)\n\t\tjc[i]= (long long) jc[i-1]*i%mod;\n\tinv[2009]=Inv(jc[2009]);\n\tfor(int i = 2008; i >= 0; i--)\n\t\tinv[i]= (long long) inv[i+1]*(i+1)%mod;\n\treturn;\n}\nint main() {\n\tscanf(\"%d%d\",&n,&k);\n\tinit();\n\tfor(int i = 1; i <= n; ++i){\n\t\tcin>>a;\n\t\tsort(a.begin(),a.end());\n\t\tif(!px[a])\n\t\t\tpx[a]=++QAQ;\n\t\t++sum[px[a]];\n\t}\n\tint op=0;\n\tf[0][0]=1;//\u6eda\u52a8\u6570\u7ec4\uff08\u6015\u70b8\uff09\n\tfor(int i = 1; i <= QAQ; ++i){\n\t\top^=1;\n\t\tmemset(f[op],0,sizeof f[op]);\n\t\tfor(int j = 0; j <= k; ++j)\n\t\t\tfor(int o = 0; o <= sum[i]; ++o){\n\t\t\t\tint now = o*(o-1)/2, qwq= (long long) jc[sum[i]]*inv[sum[i]-o]%mod*inv[o]%mod;\n\t\t\t\tif(now + j <= k)\n\t\t\t\t\tf[op][j+now] = (f[op][j+now]+( (long long) f[op^1][j]*qwq)%mod)%mod;\n\t\t\t}\n\t}\n\tcout<<f[op][k];\n\treturn 0;\n}\n```\n\n\u829c\u6e56\uff0c\u4e00\u7bc7\u9898\u89e3\u6c34\u8fc7\u3002",
        "postTime": 1633330535,
        "uid": 503670,
        "name": "Liquefyx",
        "ccfLevel": 0,
        "title": "\u829c\u6e56"
    },
    {
        "content": "### \u9898\u76ee\u5206\u6790\n\n\u8fd9\u9053\u9898\u7684\u76f8\u4f3c\u6ee1\u8db3\u4f20\u9012\u6027\u3002~~\u663e\u7136\u3002~~\n\n\u6240\u4ee5\u6211\u4eec\u5c06\u6240\u6709\u7684\u5b57\u7b26\u4e32\u5206\u7c7b\uff0c\u6bcf\u7c7b\u5b57\u7b26\u4e32\u4e92\u76f8\u4e4b\u95f4\u90fd\u662f\u76f8\u4f3c\u7684\u3002\u8fd9\u4e2a\u53ef\u4ee5\u7528\u5404\u79cd\u65b9\u6cd5\u89e3\u51b3\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u5f00\u59cb\u6109\u5feb\u5730\u8fdb\u884c\u52a8\u6001\u89c4\u5212\u3002\n\n\u8fd9\u662f\u4e00\u4e2a\u5957\u8def\uff0c$dp[i][j]$ \u8868\u793a\u524d $i$ \u7c7b\u5b57\u7b26\u4e32\uff0c\u9009\u4e86 $j$ \u4e2a\u5b57\u7b26\u4e32\u7684\u65b9\u6848\u6570\u3002\u8f6c\u79fb\u65f6\u53ef\u4ee5\u679a\u4e3e\u7b2c $i$ \u7c7b\u5b57\u7b26\u4e32\u9009\u7684\u4e2a\u6570 $k$\uff0c\u8bbe\u7b2c $i$ \u7c7b\u6709 $x$ \u4e2a\u5b57\u7b26\u4e32\uff0c\u6240\u4ee5 $dp[i][j]=(dp[i-1][j]+\\sum\\limits dp[i-1][j-\\dfrac{k(k-1)}{2}]\\times C_{x}^{k})\\bmod p$\u3002\n\n\u7ec4\u5408\u6570\u53ef\u4ee5 $O(n^2)$ \u9884\u5904\u7406\uff0c\u52a8\u6001\u89c4\u5212\u662f $O(k\\sum\\limits size)$ \u7684\uff0c\u4e5f\u5c31\u662f $O(nk)$\uff0c\u5b57\u7b26\u4e32\u5206\u7c7b\u662f $O(\\sum\\limits |S|\\log|S|)$ \u7684\uff0c\u6240\u4ee5\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n(n+k))$\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define MOD 1000000007\nusing namespace std;\nunordered_map<unsigned long long,int>m;\nint n,k,dp[2005][2005],C0[2005][2005];\nchar s[11];\nvoid init(){//\u9884\u5904\u7406\u7ec4\u5408\u6570\n\tC0[0][0]=1;\n\tfor(int i=1;i<=2000;i++)\n\t\tC0[i][0]=C0[i][i]=1;\n\tfor(int i=1;i<=2000;i++)\n\t\tfor(int j=1;j<i;j++)\n\t\t\tC0[i][j]=(C0[i-1][j]+C0[i-1][j-1])%MOD;\n}\nlong long C(long long n,long long m){\n\treturn C0[n][m];\n}\nint main(){\n\tinit();\n\tscanf(\"%d%d\",&n,&k);\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%s\",s+1);\n\t\tunsigned long long res=1;\n\t\tint len=strlen(s+1);\n\t\tsort(s+1,s+len+1);\n\t\tfor(int j=1;j<=len;j++)//\u54c8\u5e0c\u5904\u7406\u5b57\u7b26\u4e32\u5206\u7c7b\n\t\t\tres=res*1331+(s[j]-'a'+1);\n\t\tm[res]++;\n\t}\n\tint cnt=0;\n\tdp[0][0]=1;//dp\u521d\u59cb\u5316\n\tfor(auto &&it:m){//dp\n\t\tcnt++;\n\t\tfor(int j=0;j<=k;j++){\n\t\t\tdp[cnt][j]=dp[cnt-1][j];\n\t\t\tfor(int s=1;s<=it.second&&(s-1)*s/2<=j;s++){\n\t\t\t\tint num=s*(s-1)/2;\n\t\t\t\tdp[cnt][j]=(dp[cnt][j]+((long long)(dp[cnt-1][j-num]*C(it.second,s))%MOD)%MOD)%MOD;\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\",dp[cnt][k]);\n\treturn 0;\n}\n```\n",
        "postTime": 1668503685,
        "uid": 222057,
        "name": "joy2010WonderMaker",
        "ccfLevel": 5,
        "title": "P7552\u9898\u89e3"
    }
]
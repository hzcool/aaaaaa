[
    {
        "content": "## \u5e7f\u544a\n\n[\u6211\u7684\u535a\u5ba2](https://rusun.blog.luogu.org/)\n\n## \u53cc\u500d\u7ecf\u9a8c\n\n[SP4063 MPIGS - Sell Pigs](https://www.luogu.com.cn/problem/SP4063)\n\n\u6ca1\u6709 SPOJ \u7684\u8d26\u53f7\u7684\u540c\u5b66\uff0c \u4e0d\u5efa\u8bae\u98df\u7528\u3002\n\n\u8fd9\u4e2a\u9898\u6570\u636e\u8303\u56f4\u8981\u5927\u4e00\u4e9b\uff0c \u6240\u4ee5\u76f4\u63a5\u4ea4\u8fc7\u53bb\u5c31\u53ef\u4ee5\u8fc7\u4e86\u3002\n\n## \u524d\u7f6e\u77e5\u8bc6\n\n[P3376 \u3010\u6a21\u677f\u3011\u7f51\u7edc\u6700\u5927\u6d41](https://www.luogu.com.cn/problem/P3376)\n\n\u8fd9\u91cc\u9644\u8d60\u4e00\u4e2a\u6a21\u677f\u3002\n\n\u98df\u7528\u65b9\u6cd5\uff1a \u5bf9\u4e8e\u6bcf\u9053\u9898\uff0c \u5148\u5c06\u6a21\u677f\u590d\u5236\u4e0b\u6765\uff0c \u7136\u540e\u8c03\u6574\u70b9\u6570 N \u7684\u5927\u5c0f\u548c\u8fb9\u6570 M \u7684\u5927\u5c0f\uff0c \u5efa\u56fe\u5373\u53ef\u3002 \u6ce8\u610f st \u865a\u62df\u6e90\u70b9\u9ed8\u8ba4\u4e3a\u6700\u5c0f\u7684\u70b9\uff0c ed \u865a\u62df\u6c47\u70b9\u9ed8\u8ba4\u4e3a\u6700\u5927\u7684\u70b9\uff0c \u6ce8\u610f\u5c06 hd \u6570\u7ec4\u8d4b\u521d\u59cb\u503c -1\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <queue>\n#include <climits>\n#define inf INT_MAX\nusing namespace std;\nconst int N = + 10, M = + 10;\nint n, st, ed, d[N], cur[N];\nint idx = -1, hd[N], nxt[M], edg[M], wt[M];\nbool bfs()\n{\n    for (int i = st; i <= ed; i++)\n        d[i] = -1;\n    d[st] = 0;\n    cur[st] = hd[st];\n    queue <int> q;\n    q.push(st);\n    while (!q.empty())\n    {\n        int t = q.front();\n        q.pop();\n        for (int i = hd[t]; ~i; i = nxt[i])\n            if (d[edg[i]] == -1 && wt[i])\n            {\n                cur[edg[i]] = hd[edg[i]];\n                d[edg[i]] = d[t] + 1;\n                if (edg[i] == ed)\n                    return true;\n                q.push(edg[i]);\n            }\n    }\n    return false;\n}\nint exploit(int x, int limit)\n{\n    if (x == ed)\n        return limit;\n    int res = 0;\n    for (int i = cur[x]; ~i && res < limit; i = nxt[i])\n    {\n        cur[x] = i;\n        if (d[edg[i]] == d[x] + 1 && wt[i])\n        {\n            int t = exploit(edg[i], min(wt[i], limit - res));\n            if (!t)\n                d[edg[i]] = -1;\n            wt[i] -= t;\n            wt[i ^ 1] += t;\n            res += t;\n        }\n    }\n    return res;\n}\nint dinic()\n{\n    int res = 0, flow;\n    while (bfs())\n        while (flow = exploit(st, inf))\n            res += flow;\n    return res;\n}\nvoid add (int a, int b, int c)\n{\n    nxt[++idx] = hd[a];\n    hd[a] = idx;\n    edg[idx] = b;\n    wt[idx] = c;\n}\nint main ()\n{\n\n    return 0;\n}\n```\n\n## \u6b63\u6587\n\n\u9898\u76ee\u4e2d\uff0c \u91d1\u5e01\u4ece\u4fdd\u9669\u67dc\u91cc\u9762\u6d41\u51fa\uff0c \u5230\u8fbe\u6bcf\u4e2a\u4eba\u90fd\u624b\u4e2d\uff0c \u6c42\u53ef\u4ee5\u53d6\u51fa\u7684\u6700\u5927\u503c\u3002 \u8fd9\u4e0d\u7981\u8ba9\u6211\u4eec\u8054\u60f3\u5230\u4e86\u7f51\u7edc\u6700\u5927\u6d41\uff0c \u4fdd\u9669\u67dc\u6b63\u662f\u865a\u62df\u6e90\u70b9\uff0c \u53ef\u4ee5\u6d41\u51fa\u6d41\u91cf\uff0c \u800c\u91d1\u5e01\u6b63\u662f\u6d41\u91cf\u3002 \u8fd9\u9053\u9898\u76ee\u7279\u6b8a\u7684\u4e00\u70b9\u662f\u6bcf\u4e00\u4e2a\u4eba\u53d6\u51fa\u91d1\u5e01\u4e4b\u540e\uff0c \u53ef\u4ee5\u968f\u610f\u8c03\u6574\u6253\u5f00\u7684\u4fdd\u9669\u67dc\u7684\u6570\u91cf\u3002 \u90a3\u4e48\u53ef\u80fd\u56e0\u4e3a\u8fd9\u6b21\u8c03\u6574\u591a\u51fa\u6765\u7684\u6d41\u91cf\u662f\u56e0\u4e3a\u4e24\u4eba\u7528\u4e86\u540c\u4e00\u4e2a\u4fdd\u9669\u67dc\uff0c \u5373\u53ef\u80fd\u5b58\u5728\u7684\u91d1\u5e01\u7684\u6d41\u5411\u5982\u4e0b\uff1a\n\n```\n\u5ba2\u6237 1 \u6253\u5f00\u4e86\u4fdd\u9669\u67dc 1\uff0c 2\n\n\u4fdd\u9669\u67dc 1 -> \u5ba2\u6237 1\n\n\u4fdd\u9669\u67dc 2 -> \u5ba2\u6237 1\n\n\u6b64\u65f6\uff0c \u4fdd\u9669\u67dc 1 \u548c 2 \u4ee5\u53ca\u5ba2\u6237 1 \u4e4b\u95f4\u53ef\u4ee5\u968f\u4fbf\u4e71\u641e\n\n\u4fdd\u9669\u67dc 1 -> \u4fdd\u9669\u67dc 2 \uff08\u88ab \u201c \u4f60 \u201d \u62ff\u8d70\uff09\n\n\u5ba2\u6237 2 \u6253\u5f00\u4e86\u4fdd\u9669\u67dc 2\n\n\u6b64\u65f6\uff0c \u4fdd\u9669\u67dc 2 \u548c\u5ba2\u6237 2 \u4e4b\u95f4\u53ef\u4ee5\u968f\u4fbf\u4e71\u641e\n\n\u4fdd\u9669\u67dc 2 -> \u5ba2\u6237 2\n\n```\n\u4e0d\u96be\u53d1\u73b0\uff0c \u4fdd\u9669\u67dc 1 \u548c 2 \u4e0e\u5ba2\u6237 1 \u548c 2 \u4e4b\u95f4\u91d1\u5e01\u53ef\u4ee5\u6309\u987a\u5e8f\u968f\u610f\u6d41\u52a8\uff0c \u6240\u4ee5\u4e0a\u8ff0\u8fc7\u7a0b\u53ef\u4ee5\u7b49\u4ef7\u4e8e\n\n```\n\u5ba2\u6237 1 \u6253\u5f00\u4e86\u4fdd\u9669\u67dc 1\uff0c 2\n\n\u5ba2\u6237 1 \u5341\u5206\u8d2a\u5a6a\uff0c \u5377\u8d70\u6240\u6709\u7684\u4fdd\u9669\u67dc 1 \u548c 2 \u7684\u91d1\u5e01\n\n\u5ba2\u6237 2 \u4e00\u6765\uff0c \u770b\u89c1\u81ea\u5df1\u7684\u4fdd\u9669\u67dc 2 \u88ab\u5377\u8d70\u4e86\uff0c \u5341\u5206\u751f\u6c14\uff0c \u628a\u5ba2\u6237 1 \u6253\u4e86\u4e00\u987f\uff0c \u62ff\u8d70\u4e86\u4ed6\u60f3\u8981\u7684\u91d1\u5e01\n```\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u5efa\u56fe\uff1a\n\n- \u5efa\u7acb\u865a\u62df\u6e90\u70b9\u548c\u6c47\u70b9\uff1b\n\n\n- \u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u4eba\u80fd\u5f00\u7684\u4fdd\u9669\u67dc\uff0c \u5982\u679c\u5b83\u6ca1\u6709\u88ab\u6253\u5f00\u8fc7\uff0c \u5219\u4ece\u865a\u62df\u6e90\u70b9\u5230\u5f53\u524d\u7684\u4eba\u8fde\u4e00\u6761\u6d41\u91cf\u4e3a\u4fdd\u9669\u67dc\u91d1\u5e01\u6570\u91cf\u7684\u8fb9\uff0c \u8868\u793a\u8fd9\u4e2a\u4eba\u53ef\u4ee5\u4ece\u8fd9\u4e2a\u4fdd\u9669\u67dc\u4e2d\u5377\u8d70\u6240\u6709\u7684\u91d1\u5e01\uff1b\n\n- \u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u4eba\u80fd\u5f00\u7684\u4fdd\u9669\u67dc\uff0c \u5982\u679c\u5b83\u5df2\u7ecf\u88ab\u6253\u5f00\u8fc7\u4e86\uff0c \u5219\u4ece\u4e0a\u4e00\u6b21\u53ef\u4ee5\u5f00\u8fd9\u4e2a\u4fdd\u9669\u67dc\u7684\u4eba\u5230\u5f53\u524d\u7684\u4eba\u8fde\u4e00\u6761\u6d41\u91cf\u4e3a\u65e0\u9650\u5927\u7684\u8fb9\uff0c \u8868\u793a\u5f53\u524d\u7684\u4eba\u53ef\u4ee5\u65e0\u9650\u4ece\u4e0a\u4e00\u4e2a\u4eba\u7d22\u53d6\u91d1\u5e01\uff1b\n\n- \u5bf9\u4e8e\u6bcf\u4e2a\u4eba\uff0c \u5411\u6c47\u70b9\u8fde\u4e00\u6761\u6d41\u91cf\u4e3a\u5176\u60f3\u8981\u7684\u91d1\u5e01\u7684\u6570\u91cf\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c \u5bf9\u4e8e\u4e00\u4e2a\u4fdd\u9669\u67dc\uff0c \u6240\u6709\u53ef\u4ee5\u6253\u5f00\u5b83\u7684\u4eba\u6784\u6210\u4e86\u4e00\u6761\u94fe\uff0c \u53ef\u4ee5\u6309\u987a\u5e8f\u968f\u610f\u4f20\u64ad\u91d1\u5e01\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <queue>\n#include <climits>\n#define INF INT_MAX\nusing namespace std;\nconst int N = 610, M = 4e6 + 10;\nint m, n, st, ed, k[2510], d[N], cur[N], last[2510];\nint idx = -1, hd[N], nxt[M], edg[M], wt[M];\nbool bfs ()\n{\n\tfor (int i = st; i <= ed; i++)\n\t\td[i] = -1;\n\td[st] = 0;\n\tcur[st] = hd[st];\n\tqueue <int> q;\n\tq.push(st);\n\twhile (!q.empty())\n\t{\n\t\tint t = q.front();\n\t\tq.pop();\n\t\tfor (int i = hd[t]; ~i; i = nxt[i])\n\t\t\tif (d[edg[i]] == -1 && wt[i])\n\t\t\t{\n\t\t\t\td[edg[i]] = d[t] + 1;\n\t\t\t\tcur[edg[i]] = hd[edg[i]];\n\t\t\t\tif (edg[i] == ed)\n\t\t\t\t\treturn true;\n\t\t\t\tq.push(edg[i]);\n\t\t\t}\n\t}\n\treturn false;\n}\nint find (int x, int limit)\n{\n\tif (x == ed)\n\t\treturn limit;\n\tint res = 0;\n\tfor (int i = cur[x]; ~i && res < limit; i = nxt[i])\n\t{\n\t\tcur[x] = i;\n\t\tif (d[edg[i]] == d[x] + 1 && wt[i])\n\t\t{\n\t\t\tint t = find(edg[i], min(wt[i], limit - res));\n\t\t\tif (!t)\n\t\t\t\td[edg[i]] = -1;\n\t\t\twt[i] -= t;\n\t\t\twt[i ^ 1] += t;\n\t\t\tres += t;\n\t\t}\n\t}\n\treturn res;\n}\nint dinic ()\n{\n\tint res = 0, flow;\n\twhile (bfs())\n\t\twhile (flow = find(st, INF))\n\t\t\tres += flow;\n\treturn res;\n}\nvoid add (int x, int y, int z)\n{\n\tnxt[++idx] = hd[x];\n\thd[x] = idx;\n\tedg[idx] = y;\n\twt[idx] = z;\n}\nint main ()\n{\n\tcin >> m >> n;\n\tst = 0;\n\ted = n + 1;\n\tfor (int i = st; i <= ed; i++)\n\t\thd[i] = -1;\n\tfor (int i = 1; i <= m; i++)\n\t\tcin >> k[i];\n\tfor (int i = 1, a, b, id; i <= n; i++)\n\t{\n\t\tcin >> a;\n\t\twhile (a--)\n\t\t{\n\t\t\tcin >> id;\n\t\t\tif (!last[id])\n\t\t\t{\n\t\t\t\tadd(st, i, k[id]);\n\t\t\t\tadd(i, st, 0);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tadd(last[id], i, INF);\n\t\t\t\tadd(i, last[id], 0);\n\t\t\t}\n\t\t\tlast[id] = i;\n\t\t}\n\t\tcin >> b;\n\t\tadd(i, ed, b);\n\t\tadd(ed, i, 0);\n\t}\n\tcout << dinic();\n\treturn 0;\n}\n```\n\n## \u96be\u5ea6\u8bc4\u5b9a\n\n\u8be5\u9898\u76ee\u96be\u5ea6\u8fd8\u6682\u65e0\u8bc4\u5b9a\uff0c \u5efa\u8bae\u8bbe\u7f6e\u5176\u96be\u5ea6\u4e3a ``\u7701\u9009/NOI-`` \u3002",
        "postTime": 1619529834,
        "uid": 185726,
        "name": "RuSun",
        "ccfLevel": 8,
        "title": "Solution P4638"
    },
    {
        "content": "[\u94f6\u884c\u5bb6](https://www.luogu.com.cn/problem/P4638)\n\n[\u53cc\u500d\u7ecf\u9a8c](https://www.luogu.com.cn/problem/SP4063)\n\n### \u9898\u76ee\u5927\u610f\n\n\u6709 $n$ \u4e2a\u5ba2\u6237\u524d\u6765\u53d6\u91d1\u5e01\uff0c\u5171\u6709 $m$ \u4e2a\u4fdd\u9669\u7bb1\uff0c\u6bcf\u4e2a\u5ba2\u6237\u643a\u5e26\u7740\u67d0\u4e00\u4e9b\u4fdd\u9669\u7bb1\u7684\u94a5\u5319\uff0c\u9700\u8981\u53d6\u4e00\u5b9a\u6570\u91cf\u7684\u91d1\u5e01\u3002\u5728\u5ba2\u6237\u53d6\u5b8c\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6253\u5f00\u7684\u4fdd\u9669\u7bb1\u4e2d\u7684\u91d1\u5e01\u968f\u610f\u79fb\u52a8\uff0c\u79fb\u52a8\u5b8c\u6bd5\u540e\u6240\u6709\u7684\u4fdd\u9669\u7bb1\u5c06\u5173\u95ed\uff0c\u76f4\u5230\u4e0b\u4e00\u4e2a\u5ba2\u6237\u5230\u6765\u65f6\u624d\u80fd\u6253\u5f00\u5176\u62e5\u6709\u94a5\u5319\u5bf9\u5e94\u7684\u4fdd\u9669\u7bb1\u3002\u6c42\u6700\u591a\u80fd\u53d6\u8d70\u51fa\u591a\u5c11\u91d1\u5e01\u3002\n\n### \u601d\u8def\u5206\u6790\n\n\u6211\u4eec\u6ce8\u610f\u5230\u5ba2\u6237\u662f\u6709\u65f6\u95f4\u987a\u5e8f\u7684\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u9996\u5148\u60f3\u5230\u53ef\u4ee5\u5efa\u7acb\u4e00\u5f20\u5206\u5c42\u56fe\uff0c\u6bcf\u4e2a\u70b9 $(a,b)$ \u8868\u793a\u5728\u7b2c $a$ \u4e2a\u5ba2\u6237\u5230\u6765\u65f6\u7684\u7b2c $b$ \u4e2a\u4fdd\u9669\u7bb1\uff0c \u90a3\u4e48\u8fb9\u7684\u8bbe\u7f6e\u5c31\u5f88\u81ea\u7136\uff1a\n\n- \u5efa\u7acb\u865a\u62df\u6e90\u70b9\u548c\u6c47\u70b9\uff0c\u6e90\u70b9\u5411\u6bcf\u4e2a $(1,x)$ \u70b9\u8fde\u8fb9\uff0c\u8fb9\u6743\u4e3a\u521d\u59cb\u7684\u6570\u91cf\u3002\n- \u5bf9\u4e8e\u6bcf\u4e00\u5c42\u518d\u5efa\u4e00\u4e2a\u70b9\uff0c\u5c06\u8be5\u5c42\u6240\u6709\u88ab\u6253\u5f00\u7684\u70b9\u5411\u5b83\u8fde\u8fb9\uff0c\u540c\u65f6\u5b83\u5411\u4e0b\u4e00\u5c42\u5bf9\u4e8e\u7684\u70b9\u8fde\u8fb9\uff0c\u8fb9\u6743\u5747\u4e3a $+\\infty$\uff0c\u518d\u5c06\u5176\u5411\u6c47\u70b9\u8fde\u8fb9\uff0c\u8fb9\u6743\u4e3a $+\\infty$\u3002\n\n![](https://i.328888.xyz/2023/02/23/xXjzZ.md.png)\n\n\u7136\u540e\u8dd1\u6700\u5927\u6d41\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u4f46\u662f\uff0c\u8fd9\u6837\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u662f $O(nm)$ \u7684\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u66f4\u662f\u9ad8\u8fbe $O(n^3m^3)$\uff0c\u662f\u6bd4\u8f83\u52a3\u7684\uff0c\u5982\u4f55\u4f18\u5316\u5462\uff1f\n\n\u65e2\u7136\u5ba2\u6237\u6709\u65f6\u95f4\u987a\u5e8f\uff0c\u90a3\u4e48\u6211\u4eec\u4e0d\u59a8\u4ece\u5ba2\u6237\u4e0b\u624b\uff0c\u53ea\u5efa\u7acb $n$ \u4e2a\u4ee3\u8868\u5ba2\u6237\u7684\u70b9\uff0c\u90a3\u4e48\u5982\u4f55\u8fde\u8fb9\u5462\uff1f\n\n- \u5efa\u7acb\u865a\u62df\u6e90\u70b9\uff0c\u6c47\u70b9\u3002\n- \u6bcf\u4e2a\u70b9\u5411\u6c47\u70b9\u8fde\u8fb9\uff0c\u8fb9\u6743\u662f\u8fd9\u4e2a\u5ba2\u6237\u5bf9\u91d1\u5e01\u7684\u9700\u6c42\u91cf\u3002\n- \u8bb0\u5f55\u6bcf\u4e2a\u4fdd\u9669\u7bb1\u6700\u8fd1\u4e00\u6b21\u662f\u88ab\u8c01\u6253\u5f00\u7684\uff0c\u5982\u679c\u662f\u7b2c\u4e00\u6b21\u6253\u5f00\uff0c\u5c06\u4ece\u6e90\u70b9\u5411\u8fd9\u4e2a\u5ba2\u6237\u8fde\u7684\u8fb9\u7684\u8fb9\u6743\u589e\u52a0\u8fd9\u4e2a\u4fdd\u9669\u7bb1\u7684\u91d1\u5e01\u7684\u6570\u91cf\u3002\uff08\u5982\u679c\u6ca1\u6709\u8fd9\u6761\u8fb9\u5c31\u5efa\u7acb\u8fd9\u6761\u8fb9\uff09\n- \u5982\u679c\u4e0d\u662f\u7b2c\u4e00\u6b21\u6253\u5f00\uff0c\u5c06\u4e0a\u4e00\u6b21\u6253\u5f00\u8fd9\u4e2a\u4fdd\u9669\u7bb1\u7684\u5ba2\u6237\u5411\u8fd9\u4e2a\u5ba2\u6237\u8fde\u4e00\u6761\u8fb9\u6743\u662f $+\\infty$ \u7684\u8fb9\u3002\n\n![](https://i.328888.xyz/2023/02/23/xXxzc.md.png)\n\n\u7136\u540e\u8dd1\u6700\u5927\u6d41\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u7a7a\u95f4\u590d\u6742\u5ea6 $O(n)$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3)$\u3002\n\n### \u4ee3\u7801\n\n```\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N=100100;\n#define inf 0x3f3f3f3f\n\nint to[N],nxt[N],head[N],w[N];\nint idx=1,n,m,S,T,in1,in2;\nint d[N],cur[N];queue <int> q;\nint a[N],vis[N];//a \u662f\u4fdd\u9669\u7bb1\u4e2d\u91d1\u5e01\u7684\u6570\u91cf\uff0cvis \u4fdd\u5b58\u4e0a\u4e00\u6b21\u6253\u5f00\u7684\u4eba\n\nvoid add(int u,int v,int c){\n    idx++;to[idx]=v;nxt[idx]=head[u];head[u]=idx;w[idx]=c;\n    idx++;to[idx]=u;nxt[idx]=head[v];head[v]=idx;w[idx]=0;\n}\n\n//dinic\u6a21\u677f\u9ed8\u5199\n\nbool bfs(){\n    memset(d,-1,sizeof d);d[S]=0;\n    while(!q.empty()) q.pop();\n    cur[S]=head[S];q.push(S);\n    while(!q.empty()){\n        int now=q.front();q.pop();\n        for(int i=head[now];i;i=nxt[i]){\n            int v=to[i];\n            if(~d[v]||!w[i]) continue;\n            d[v]=d[now]+1;cur[v]=head[v];\n            if(v==T) return 1;q.push(v);\n        }\n    }\n    return 0;\n}\n\nint dfs(int s,int lim){\n    if(s==T) return lim;\n    int flow=0;\n    for(int i=cur[s];i&&flow<lim;i=nxt[i]){\n        int v=to[i];cur[s]=i;\n        if(d[v]!=d[s]+1||!w[i]) continue;\n        int t=dfs(v,min(w[i],lim-flow));\n        if(!t) d[v]=-1;\n        w[i]-=t;w[i^1]+=t;flow+=t;\n    }\n    return flow;\n}\n\nint dinic(){\n    int ans=0,flow=0;\n    while(bfs()) while(flow=dfs(S,inf)) ans+=flow;\n    return ans;\n}\n\n//------\n\nint main(){\n    scanf(\"%d%d\",&m,&n);\n    S=0;T=N-2;//\u865a\u62df\u6e90\u6c47\u70b9\n    for(int i=1;i<=m;i++) scanf(\"%d\",&a[i]);\n    for(int i=1;i<=n;i++){\n        scanf(\"%d\",&in1);\n        int sum1=0;\n        for(int j=1;j<=in1;j++){\n            scanf(\"%d\",&in2);\n            if(!vis[in2]){sum1+=a[in2];}//\u589e\u52a0\u8fb9\u6743\n            else add(vis[in2],i,inf);//\u4e0a\u4e00\u4e2a\u4eba\u5411\u8fd9\u4e2a\u4eba\u8fde\u8fb9\n            vis[in2]=i;//\u66f4\u65b0\u8fd9\u4e2a\u4fdd\u9669\u7bb1\n        }\n        if(sum1) add(S,i,sum1);\n        scanf(\"%d\",&in1);\n        add(i,T,in1);//\u5411\u6c47\u70b9\u8fde\u8fb9\n    }\n    cout<<dinic()<<'\\n';\n    return 0;\n}\n```",
        "postTime": 1677129808,
        "uid": 767096,
        "name": "TKXZ133",
        "ccfLevel": 4,
        "title": "\u94f6\u884c\u5bb6 \u9898\u89e3"
    },
    {
        "content": "\u9996\u5148\u60f3\u5230\u7684\u662f\u7f51\u7edc\u6d41\u6700\u5927\u6d41\u3002\u4e0b\u9762\u8ba8\u8bba\u5982\u4f55\u5efa\u56fe\uff1a\n\n1. \u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u4fdd\u9669\u67dc\uff0c\u5c06\u5b83\u7684\u7b2c\u4e00\u4e2a\u4f7f\u7528\u4eba\uff08\u5373\u7b2c\u4e00\u4e2a\u6301\u6709\u94a5\u5319\u7684\u4eba\uff09\u4e0e\u6e90\u70b9\u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a $w[i]$ \u7684\u8fb9\u3002\u8868\u793a\u4ece\u8fd9\u4e2a\u4eba\u5f00\u59cb\uff0c\u53ef\u4ee5\u2018\u4efb\u610f\u2019\u5206\u914d$w[i]$\u4e2a\u91d1\u5e01\u3002\n2. \u5c06\u6bcf\u4e2a\u4fdd\u9669\u67dc\u4e4b\u540e\u7684\u4f7f\u7528\u4eba\u4e0e\u7b2c\u4e00\u4e2a\u4f7f\u7528\u4eba\u8fde\u4e00\u6761INF\u7684\u8fb9\u3002\n3. \u4e4b\u540e\u5c06\u6bcf\u4e00\u4e2a\u4eba$i$\u4e0e\u6c47\u70b9\u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a$c[i]$\u7684\u8fb9\u3002\n\n\u8dd1dinic\u5373\u53ef\u3002\n\n\u4ee5\u4e0b\u662f\u4ee3\u7801\u5b9e\u73b0\uff1a\n```lang=cpp\n#include<bits/stdc++.h>\n#define int long long\nconst int N = 1e5 + 3;\nconst int oo = 0x7f7f7f7f;\n\nint edge[N << 1],nxt[N << 1],ver[N << 1],head[N],tot = 1,lst[N],first[N];\ninline void add(int x,int y,int z)\n{\n\tver[++tot] = y,edge[tot] = z,nxt[tot] = head[x],head[x] = tot;\n\tver[++tot] = x,edge[tot] = 0,nxt[tot] = head[y],head[y] = tot;\n}\n\ninline int read()\n{\n\tint s = 0,f = 1; char ch;\n\twhile(!isdigit(ch = getchar())) if(ch == '-') f = -1;\n\twhile(isdigit(ch)) s = s * 10 + ch - '0',ch = getchar();\n\treturn s * f;\n}\n\nint n,m,w[N],s,t,d[N],cur[N];\nstd::queue<int> q;\n\ninline bool BFS()\n{\n\tmemset(d,0,sizeof(d));\n\twhile(q.size()) q.pop();\n\tq.push(s),d[s] = 1;\n\twhile(q.size()) {\n\t\tint x = q.front(); q.pop();\n\t\tfor(int i = head[x];i;i = nxt[i]) {\n\t\t\tint to = ver[i],w = edge[i];\n\t\t\tif(w && !d[to]) {\n\t\t\t\td[to] = d[x] + 1;\n\t\t\t\tq.push(to);\n\t\t\t\tif(to == t) return 1;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n\nint dfs(int x,int flow)\n{\n\tif(x == t) return flow;\n\tint rest = flow,k;\n\tfor(int i = cur[x];i && rest;i = nxt[i]) {\n\t\tcur[x] = i;\n\t\tint to = ver[i],w = edge[i];\n\t\tif(d[to] == d[x] + 1 && w) {\n\t\t\tk = dfs(to,std::min(w,rest));\n\t\t\tif(!k) d[to] = 0;\n\t\t\trest -= k,edge[i] -= k,edge[i ^ 1] += k;\n\t\t}\n\t}\n\treturn flow - rest;\n}\n\nint dinic()\n{\n\tint ret = 0;\n\twhile(BFS()) {\n\t    memcpy(cur,head,sizeof(cur));\n\t    ret += dfs(s,oo);\n\t}\n\treturn ret;\n}\n\nsigned main()\n{\n\tstd::ios::sync_with_stdio(false);\n\tstd::cin.tie(0),std::cout.tie(0);\n\n\tstd::cin >> m >> n;\n\ts = 0,t = n + 1;\n\n\tfor(int i = 1;i <= m;i++)\n\t\tstd::cin >> w[i];\n\tfor(int i = 1,k,own,c;i <= n;i++) {\n\t\tstd::cin >> k;\n\t\tfor(int j = 1;j <= k;j++) {\n\t\t\tstd::cin >> own;\n\t\t\tif(!lst[own]) add(s,i,w[own]);\n\t\t\telse add(lst[own],i,oo);\n\t\t\tlst[own] = i;\n\t\t}\n\t\tstd::cin >> c;\n\t\tadd(i,t,c);\n\t}\n\n\tstd::cout << dinic();\n\texit(0);\n}\n```",
        "postTime": 1570281558,
        "uid": 28366,
        "name": "tomtom",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4638 \u3010[SHOI2011]\u94f6\u884c\u5bb6\u3011"
    },
    {
        "content": "\u7f51\u7edc\u6d41\n\n**\u9996\u5148\u8003\u8651 70pts \u505a\u6cd5 (\u8be5\u505a\u6cd5\u53ef\u4ee5\u901a\u8fc7 [MPIGS - Sell Pigs](https://www.luogu.com.cn/problem/SP4063))**\n\n\u5ba2\u6237\u6709\u987a\u5e8f\uff0c\u6211\u4eec\u628a\u4fdd\u9669\u7bb1\u62c6\u70b9\uff0c\u62c6\u6210 $n\\times m$ \u4e2a\u70b9\uff0c\u7b2c $i$ \u5217\u8868\u793a\u524d $i$ \u4e2a\u4eba\uff0c\u7b2c $j$ \u884c\u8868\u793a\u7b2c $j$ \u4e2a\u4fdd\u9669\u7bb1\u3002\n\n\u8fd9\u6837\u62c6\u70b9\u53ef\u4ee5\u5904\u7406\u6389\u65f6\u95f4\u95ee\u9898\u3002\n\n\u9996\u5148\u6e90\u70b9\u8fde\u5411\u7b2c\u4e00\u5217\u70b9\uff0c\u8fb9\u6743\u4e3a\u4fdd\u9669\u7bb1\u91cc\u521d\u59cb\u91d1\u5e01\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5ba2\u6237\uff0c\u7942\u4f7f\u4e00\u4e9b\u5b9d\u7bb1\u53d8\u5f97\u4e92\u76f8\u8fde\u901a\u3002\n\n\u540c\u65f6\u8fde\u51fa\u4e00\u4e9b\u6d41\u91cf\u5230\u6c47\u70b9\u3002\n\n\u4f7f\u4e00\u4e9b\u5b9d\u7bb1\u53d8\u5f97\u4e92\u76f8\u8fde\u901a\u600e\u4e48\u529e\u5462? \u80af\u5b9a\u4e0d\u80fd\u4e24\u4e24\u8fde\u8fb9\u3002\n\n\u65b0\u5efa\u4e00\u4e2a\u70b9\uff0c\u7942\u80fd\u6253\u5f00\u7684\u4fdd\u9669\u7bb1\u8fde\u5411\u65b0\u70b9\uff0c\u518d\u8fde\u5411\u4e0b\u4e00\u65f6\u523b\u7684\u8fd9\u4e9b\u70b9\uff0c\u540c\u65f6\u4ece\u65b0\u70b9\u8fde\u4e00\u6761\u8fb9\u5230\u6c47\u70b9\u3002\n\n\u70b9\u8fb9\u6570 $O(nm)$\u3002\n\n---\n\n**100pts**\n\n\u8981\u6c42 $O(n) \\ O(m) $ \u7ea7\u522b\u7684\u70b9\u6570\u3002\n\n\u600e\u4e48\u538b\u7f29\u56fe\u554a\uff0c\u9700\u8981\u628a\u90a3\u4e2a\u70b9\u9635\u53d8\u6210\u4e00\u5217\u70b9\u3002\n\n----\n\n\u5bf9\u6bcf\u4f4d\u5ba2\u6237\uff0c\u6bcf\u4e2a\u5b9d\u7bb1\u90fd\u5efa\u7acb\u4e00\u4e2a\u70b9\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u5ba2\u6237\u70b9\uff0c\u7c7b\u4f3c\u4e8e\u521a\u624d\u7684\u65b0\u70b9\uff0c\u53bb\u8fde\u4e00\u4e9b\u5b9d\u7bb1(\u7531\u5b9d\u7bb1\u8fde\u5411\u5ba2\u6237\u70b9)\uff0c\u4f46\u662f\u8981\u8868\u73b0\u65f6\u95f4\uff0c\u6240\u4ee5\u5bf9\u4e8e\u4e00\u4e2a\u5b9d\u7bb1 \uff0c\u53ea\u6709\u5f53\u524d\u5ba2\u6237\u662f\u7b2c\u4e00\u4e2a\u8bbf\u95ee\u8be5\u5b9d\u7bb1\u7684\uff0c\u624d\u4ece\u5b9d\u7bb1\u70b9\u8fde\u51fa\uff0c\u5426\u5219\u4ece\u524d\u4e00\u4e2a\u8bbf\u95ee\u8be5\u5b9d\u7bb1\u7684\u5ba2\u6237\u8fde\u5411\u8fd9\u4e2a\u5ba2\u6237\u3002\u8fd9\u6837\u5c31\u4fdd\u8bc1\u4e86\u65f6\u95f4\u3002\n\n\u70b9\u8fb9\u6570 $O(n+m)$\u3002\n\n\n\u4ee3\u7801\u4e2d $n$ \u548c $m$ \u548c\u9898\u76ee\u4e2d\u662f\u53cd\u7684\u3002\n\n\n**code(70pts)**\n\n```cpp\ns=(n+1)*(m+1)+10,t=(n+1)*(m+1)+11;\nfor(int j=1;j<=n;j++)add(s,j,val[j]);\ntot=(n+1)*(m+1)+11;//tot\u8868\u793a\u56fe\u7684\u70b9\u6570\nfor(int i=1;i<=m;i++){\n\tint a,b;\n\tscanf(\"%d\",&a);\n\tfor(int j=1;j<=a;j++){\n\t\tint x;scanf(\"%d\",&x);\n\t\tadd((i-1)*n+x,tot+1,1e9),add(tot+1,i*n+x,1e9);\n\t}\n\tscanf(\"%d\",&b);\n\tadd(tot+1,t,b);\n\ttot++;\n\tif(i<m)for(int j=1;j<=n;j++)add((i-1)*n+j,i*n+j,1e9);\n}\n```\n\n**code(100pts)**\n\n```cpp\ns=n+m+10,t=n+m+11;\nfor(int j=1;j<=n;j++)add(s,j,val[j]);\ntot=n+m+11;\nfor(int i=1;i<=m;i++){\n\tint a,b;\n\tscanf(\"%d\",&a);\n\tfor(int j=1;j<=a;j++){\n\t\tint x;scanf(\"%d\",&x);\n\t\tif(!pre[x])add(x,n+i,1e9),pre[x]=i;\n\t\telse add(n+vis[x],n+i,1e9),pre[x]=i;\n\t}\n\tscanf(\"%d\",&b);\n\tadd(n+i,t,b);\n}\n```\n",
        "postTime": 1645103049,
        "uid": 157677,
        "name": "maruize",
        "ccfLevel": 0,
        "title": "[SHOI2011]\u94f6\u884c\u5bb6"
    },
    {
        "content": "[$ \\color{orange}\\text{\u535a\u5ba2\u98df\u7528\u6548\u679c\u66f4\u4f73\u54e6} $](https://www.luogu.com.cn/blog/into-the-unknow/solution-sp4063)\n\n$ \\color{skyblue}\\text{\u9898\u76ee\u4f20\u9001\u95e8\uff1a} $ [P4638](https://www.luogu.com.cn/problem/P4638)\u3001[SP4063](https://www.luogu.com.cn/problem/SP4063)\u3001[\u539f\u9898poj1149](http://poj.org/problem?id=1149)\u3001[\u7f51\u7edc\u6700\u5927\u6d41\u6a21\u677f](https://www.luogu.com.cn/problem/P3376)\uff08~~\u4e09\u500d\u7ecf\u9a8c~~\uff09\n\n### \u9898\u76ee\u5927\u610f\uff1a\n\u6709 $ m $ \u4e2a\u4fdd\u9669\u7bb1\u548c $ n $ \u4e2a\u5ba2\u6237\uff0c\u7ed9\u5b9a\u4fdd\u9669\u7bb1\u7684\u91d1\u5e01\u6570\u91cf\u3001\u5ba2\u6237\u53ef\u4ee5\u53d6\u54ea\u4e9b\u4fdd\u9669\u7bb1\u7684\u91d1\u5e01\u4ee5\u53ca\u5ba2\u6237\u8981\u6c42\u53d6\u8d70\u591a\u5c11\u91d1\u5e01\u3002\u6c42\u6240\u6709\u5ba2\u6237\u53ef\u4ee5\u53d6\u8d70\u7684\u91d1\u5e01\u603b\u6570\u7684\u6700\u5927\u503c\u3002**\u6bcf\u6b21\u5ba2\u6237\u53d6\u5b8c\u540e\u6b64\u4fdd\u9669\u7bb1\u7684\u91d1\u5e01\u53ef\u4ee5\u79fb\u5230\u5176\u5b83\u4fdd\u9669\u7bb1\u3002**\n### \u89e3\u9898\u601d\u8def\uff1a\n\u6839\u636e\u505a\u9898\u7ecf\u9a8c\uff0c\u6211\u4eec\u4f1a\u60f3\u5230\u8fd9\u9053\u9898\u53ef\u4ee5\u7528**\u7f51\u7edc\u6700\u5927\u6d41**\u3002\u5bf9\u4e8e\u5927\u90e8\u5206\u4eba  ~~\u6bd4\u5982\u6211~~\uff0c\u4e00\u5f00\u59cb\u60f3\u5230\u7684\u662f\u5efa\u7acb\u4e00\u4e2a\u6e90\u70b9 $ s $ \u548c\u6c47\u70b9 $ t $ \uff0c\u7531 $ s $ \u5efa\u4e00\u6761\u5bb9\u91cf\u4e3a**\u91d1\u5e01\u91cf**\u7684\u8fb9\u901a\u5411\u6bcf\u4e2a\u4fdd\u9669\u7bb1\uff0c\u4fdd\u9669\u7bb1\u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a $ \\infty $ \u7684\u8fb9\u5230\u5ba2\u6237\uff0c\u5ba2\u6237\u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a**\u91d1\u5e01\u9700\u6c42\u91cf**\u7684\u8fb9\u5230\u6c47\u70b9 $ t $ \u3002\u6bcf\u4e00\u8f6e\u4ea4\u6613\u7ed3\u675f\u540e\uff0c\u5f53\u524d\u4fdd\u9669\u7bb1\u8fde\u4e00\u6761 $ \\infty $ \u8fb9\u5230\u4e0b\u4e00\u8f6e\u4fdd\u9669\u7bb1\uff0c\u540c\u65f6\u5c06\u6709\u4ea4\u6613\u8fc7\u7684\u4fdd\u9669\u7bb1\u4e92\u76f8\u8fde\u4e00\u6761 $ \\infty $ \u7684\u8fb9\uff08\u56e0\u4e3a\u91d1\u5e01\u6b64\u65f6\u53ef\u4ee5\u4e92\u8c03\uff09\u63a5\u4e0b\u6765\u8dd1\u4e00\u904d $ \\color{skyblue}\\mathcal{Dinic} $ \u6c42\u51fa\u6700\u5927\u6d41\uff0c\u6613\u5f97\u8fd9\u5c31\u662f\u672c\u9898\u7684\u7b54\u6848\u4e86\u3002\uff08\u65b9\u6846\u8868\u793a\u4fdd\u9669\u7bb1\uff0c\u5706\u8868\u793a\u5ba2\u6237\uff09\n\n![](https://z3.ax1x.com/2021/08/24/hkrigU.png)\n\n\u4f46\u662f\uff0c\u6211\u4eec\u90fd\u77e5\u9053 $ \\color{skyblue}\\mathcal{Dinic} $ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $ O(n^2m) $ \u3002\u70b9\u6570 $ n = 2 + N + M \\times N \\approx 1500000 $ \u80af\u5b9a\u8fc7\u4e0d\u4e86\uff0c\u90a3\u4e48\u600e\u4e48\u529e\u5462\uff1f\u65f6\u95f4\u4e3b\u8981\u82b1\u8d39\u5728 $ n $ \u4e5f\u5c31\u662f**\u7ed3\u70b9\u6570**\u4e0a\uff0c\u8fd9\u65f6\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u8fdb\u884c**\u7f29\u70b9**\u3002  \n\u5177\u4f53\u8981\u600e\u4e48\u505a\uff0c\u53ef\u4ee5\u53c2\u8003\u4ee5\u4e0b\u89c4\u5f8b\u3002~~\u60f3\u4e00\u60f3\u4e3a\u4ec0\u4e48~~\n\n> **\u89c4\u5f8b 1.** \u5982\u679c\u51e0\u4e2a\u7ed3\u70b9\u7684\u6d41\u91cf\u7684\u6765\u6e90\u5b8c\u5168\u76f8\u540c\uff0c\u5219\u53ef\u4ee5\u628a\u5b83\u4eec\u5408\u5e76\u6210\u4e00\u4e2a\u3002  \n**\u89c4\u5f8b 2.** \u5982\u679c\u51e0\u4e2a\u7ed3\u70b9\u7684\u6d41\u91cf\u7684\u53bb\u5411\u5b8c\u5168\u76f8\u540c\uff0c\u5219\u53ef\u4ee5\u628a\u5b83\u4eec\u5408\u5e76\u6210\u4e00\u4e2a\u3002  \n**\u89c4\u5f8b 3.** \u5982\u679c\u4ece\u70b9 u \u5230\u70b9 v \u6709\u4e00\u6761\u5bb9\u91cf\u4e3a \u221e \u7684\u8fb9\uff0c\u5e76\u4e14\u70b9 v \u9664\u4e86\u70b9 u \u4ee5\u5916\u6ca1\u6709\u522b\u7684\u6d41\u91cf\u6765\u6e90\uff0c\u5219\u53ef\u4ee5\u628a\u8fd9\u4e24\u4e2a\u7ed3\u70b9\u5408\u5e76\u6210\u4e00\u4e2a\u3002\n\n\u6839\u636e**\u89c4\u5f8b 1**\uff0c\u53ef\u4ee5\u628a\u84dd\u8272\u53f3\u8fb9\u7684 1 \u3001 2 \u53f7\u7ed3\u70b9\u5408\u5e76\uff1b\u6839\u636e**\u89c4\u5f8b 2**\uff0c\u53ef\u4ee5\u628a\u84dd\u8272\u5de6\u8fb9\u7684 1 \u3001 2 \u53f7\u7ed3\u70b9\u5408\u5e76\uff1b\u6839\u636e**\u89c4\u5f8b 3**\uff0c\u53ef\u4ee5\u628a\u84dd\u8272\u90e8\u5206\u7684\u5de6\u8fb9\u548c\u53f3\u8fb9\uff08\u5df2\u7ecf\u5206\u522b\u5408\u5e76\u6210\u4e86\u4e00\u4e2a\u7ed3\u70b9\uff09\u5408\u5e76\u6210\u4e00\u4e2a\u7ed3\u70b9 \n\u4e8e\u662f\u6211\u4eec\u7684\u56fe\u53d8\u6210\u4e86\u8fd9\u6837\uff08\u56fe\u4e11\u522b\u4ecb\u610fqwq\uff09 \uff1a\n\n![](https://z3.ax1x.com/2021/08/24/hkV1oV.png)\n\n\u63a5\u4e0b\u6765\u7684\u6b65\u9aa4\u6211\u4e5f\u4e0d\u591a\u8d58\u8ff0\u4e86\uff0c\u603b\u4e4b\u6211\u4eec\u53ef\u4ee5\u628a\u56fe\u8f6c\u6362\u8fd9\u6837\uff08\u4e24\u70b9\u4e4b\u95f4\u6709\u591a\u6761\u540c\u5411\u7684\u8fb9\uff0c\u5219\u8fd9\u4e9b\u8fb9\u53ef\u4ee5\u5408\u5e76\u6210\u4e00\u6761\uff0c\u5bb9\u91cf\u76f8\u52a0\uff09\uff1a\n\n![](https://z3.ax1x.com/2021/08/24/hkm1ot.png)\n\n\u8fd9\u4e0b\u5c31\u5bb9\u6613\u627e\u51fa\u89c4\u5f8b\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06**\u6bcf\u4e2a\u5ba2\u6237\u4f5c\u4e3a\u4e00\u4e2a\u7ed3\u70b9**\u3002\u5bf9\u4e8e\u6253\u5f00\u6bcf\u4e2a\u4fdd\u9669\u7bb1\u7684\u7b2c\u4e00\u4e2a\u5ba2\u6237\uff0c\u4ece\u6e90\u70b9\u5411\u4ed6\u8fde\u4e00\u6761\u8fb9\uff0c\u5bb9\u91cf\u5c31\u662f\u8be5\u4fdd\u9669\u7bb1\u91cc\u7684\u521d\u59cb\u91d1\u5e01\u6570\u3002\u5982\u679c\u4ece\u6e90\u70b9\u5230\u4e00\u540d\u5ba2\u6237\u6709\u591a\u6761\u8fb9\uff0c\u5219\u53ef\u4ee5\u628a\u5b83\u4eec\u5408\u5e76\u6210\u4e00\u6761\uff0c\u5bb9\u91cf\u76f8\u52a0\u3002\u540c\u4e00\u4e2a\u4fdd\u9669\u7bb1\u6709\u591a\u4e2a\u5ba2\u6237\u6253\u5f00\u7684\u8bdd\uff0c\u5c06\u5ba2\u6237\u6309\u987a\u5e8f\u7528\u5bb9\u91cf $ \\infty $ \u7684\u8fb9\u8fde\u4e0a\uff0c\u8fd9\u6837\u5c31\u4f18\u5316\u5b8c\u6210\u5566\u3002\n\n\u65b0\u7684\u7f51\u7edc\u6a21\u578b\u4e2d\u6700\u591a\u53ea\u6709 $ \\text{ 2 + N = 6002 } $ \u4e2a\u7ed3\u70b9\uff0c\u8ba1\u7b97\u901f\u5ea6\u53ef\u4ee5\u8bf4\u662f\u76f8\u5f53\u5feb\u4e86\uff0c\u5177\u4f53\u5b9e\u73b0\u770b\u4ee3\u7801\u3002\n\n $ \\mathcal{\\Large My\\;Code:} $ \n \n ```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=6005,M=1e6+5,Inf=1e8;\nint n,m,s,t,ans,pig[N],num[N],d[N],cur[N],maxflow;\nint head[N],Next[M],ver[M],edge[M],tot=1;\nvector<int> p[N];//\u7528\u4e0d\u5b9a\u957f\u6570\u7ec4\u5b58\u5ba2\u6237\u6709\u7684\u4fdd\u9669\u7bb1\u94a5\u5319\ninline void add(int x,int y,int z)//\u94fe\u5f0f\u524d\u5411\u661f(\u90bb\u63a5\u8868)\u5b58\u56fe \n{//inline\u53ef\u4ee5\u4f7f\u591a\u6b21\u8c03\u7528\u7565\u7701\u70b9\u65f6\u95f4 \n\tver[++tot]=y,edge[tot]=z;\n\tNext[tot]=head[x],head[x]=tot;\n}\ninline bool bfs()\n{\n\tmemset(d,0,sizeof(d));\n\tqueue<int> q;//q\u6570\u7ec4\u6bcf\u6b21\u91cd\u65b0\u5b9a\u4e49\uff0c\u5c31\u4e0d\u7528\u4e00\u4e00pop\u4e86 \n\td[s]=1,q.push(s);\n\twhile(!q.empty())\n\t{\n\t\tint x=q.front();q.pop();\n\t\tfor(int i=head[x];i;i=Next[i])\n\t\t{\n\t\t\tint y=ver[i];\n\t\t\tif(edge[i]==0 || d[y]!=0)\n\t\t\t\tcontinue;//\u5bb9\u91cf\u4e0d\u4e3a 0\u4e14\u6ca1\u88ab\u8bbf\u95ee\u8fc7 \n\t\t\td[y]=d[x]+1;\n\t\t\tq.push(y);\n\t\t}\n\t}\n\tif(d[t]==0) return false;\n\treturn true;\n}\nint dfs(int x,int incf)\n{\n\tif(x==t)\n\t\treturn incf;\n\tfor(int &i=cur[x];i;i=Next[i])\n\t{\n\t\tint y=ver[i],z=edge[i];\n\t\tif(z==0 || d[y]!=d[x]+1)\n\t\t\tcontinue;\n\t\tint dist=dfs(y,min(incf,z));\n\t\tif(dist>0)\n\t\t{\n\t\t\tedge[i]-=dist;\n\t\t\tedge[i^1]+=dist;\n\t\t\treturn dist;\n\t\t}\n\t}\n\treturn 0;\n}\nint main()\n{\n\tscanf(\"%d %d\",&m,&n);\n\ts=n+1,t=s+1;\n\tfor(int i=1;i<=m;i++)\n\t\tscanf(\"%d\",&pig[i]);\n\tfor(int i=1,x,y;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&x);\n\t\tfor(int j=1;j<=x;j++)\n\t\t{\n\t\t\tscanf(\"%d\",&y);\n\t\t\tp[y].push_back(i);//\u7528\u4e0d\u5b9a\u957f\u6570\u7ec4\u5b58\u987e\u5ba2\u6709\u7684\u732a\u5708\u94a5\u5319 \n\t\t}\n\t\tscanf(\"%d\",&x);//\u8fd9\u4e2a\u662f\u987e\u5ba2\u7684\u9700\u6c42\u91cf \n\t\tadd(i,t,x),add(t,i,0);//\u987e\u5ba2\u70b9\u5230\u6c47\u70b9\u5efa\u8fb9 \n\t}\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint l=p[i].size();\n\t\tfor(int j=0;j<l;j++)\n\t\t{\n\t\t\tif(j==0)//\u4e70\u7b2ci\u4e2a\u732a\u5708\u7684\u7b2c\u4e00\u4e2a\u7528\u6237 \n\t\t\t{\n\t\t\t\tnum[p[i][j]]+=pig[i];//\u5bb9\u91cf\u7d2f\u52a0 \n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tadd(p[i][j-1],p[i][j],Inf);//\u5f00\u540c\u4e00\u4e2a\u4fdd\u9669\u7bb1\u7684\u5ba2\u6237\u8fde\u8fb9 \n\t\t\tadd(p[i][j],p[i][j-1],0);\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tif(num[i]!=0)//\u4ee5\u7d2f\u52a0\u597d\u7684\u7ed3\u679c\u4e3a\u5bb9\u91cf\u7ed9\u5f00\u67d0\u4e2a\u4fdd\u9669\u7bb1\u7684\u7b2c\u4e00\u4e2a\u987e\u5ba2\u5efa\u8fb9 \n\t\t\tadd(s,i,num[i]),add(i,s,0);\n\twhile(bfs())//Dinic\u6c42\u89e3 \n\t{\n\t\tfor(int i=1;i<=t;i++)\n\t\t\tcur[i]=head[i];\n\t\twhile(int di=dfs(s,Inf))\n\t\t\tmaxflow+=di;\n\t}\n\tprintf(\"%d\",maxflow);//\u7b54\u6848\u5373\u6700\u5927\u6d41 \n\treturn 0;\n}\n```\n \n\u611f\u8c22\u89c2\u770b\uff0c\u5e0c\u671b\u53ef\u4ee5\u5e2e\u5230\u5927\u5bb6\u3002\n\n $ \\color{gray}\\scriptsize\\text{2021.8.26 \u628a\u80fd\u52a0\u7a7a\u683c\u7684\u90fd\u52a0\u4e0a\u4e86\u2026\u2026} $ ",
        "postTime": 1629797532,
        "uid": 318004,
        "name": "yezl",
        "ccfLevel": 4,
        "title": "P4638 \u9898\u89e3\u3010[SHOI2011]\u94f6\u884c\u5bb6\u3011"
    },
    {
        "content": "### Solutions\n\n\u5982\u679c\u201c\u4f60\u201d\u4e0d\u80fd\u8c03\u6574\u91d1\u5e01\u7684\u6570\u91cf\uff0c\u90a3\u8fd9\u5c31\u662f\u4e00\u9053\u6a21\u677f\u9898\uff0c\u6240\u4ee5\u6211\u4eec\u8f6c\u5316\u4e00\u4e0b\u8fd9\u8c03\u6574\u91d1\u5e01\u8fd9\u4e2a\u64cd\u4f5c\uff1a\u5982\u679c\u524d\u4e00\u4e2a\u7528\u6237\u628a\u80fd\u62ff\u8d70\u7684\u91d1\u5e01\u90fd\u62ff\u8d70\u4e86\uff0c\u7136\u540e\u5f53\u524d\u7528\u6237\u518d\u627e\u524d\u4e00\u4e2a\u7528\u6237\u62ff\u56de\u4ed6\u7684\u60f3\u5f97\u5230\u7684\u91d1\u5e01\uff0c\u90a3\u4e48\u62ff\u5b8c\u4e4b\u540e\u7684\u60c5\u51b5\u548c\u201c\u4f60\u201d\u8c03\u6574\u4e86\u91d1\u5e01\u518d\u62ff\u5b9e\u9645\u4e0a\u662f\u4e00\u6837\u7684\u3002\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u8bb0\u5f55\u4e0a\u4e00\u4e2a\u4ece\u8fd9\u4e2a\u4fdd\u9669\u67dc\u91cc\u62ff\u91d1\u5e01\u7684\u4eba\uff0c\u5982\u679c\u5728\u4e00\u4e2a\u987e\u5ba2\u4e4b\u524d\u8fd8\u6ca1\u6709\u4eba\u62ff\u8fc7\u91d1\u5e01\uff0c\u90a3\u5c31\u5c06\u8fd9\u4e2a\u987e\u5ba2\u548c\u6e90\u70b9\u8fde\u4e00\u4e2a\u5bb9\u91cf\u4e3a\u521d\u59cb\u91d1\u5e01\u6570\u91cf\u7684\u8fb9\uff0c\u5426\u5219\u5c31\u548c\u4e0a\u4e00\u4e2a\u4ece\u8fd9\u4e2a\u4fdd\u9669\u67dc\u91cc\u62ff\u91d1\u5e01\u7684\u4eba\u8fde\u4e00\u6761\u5bb9\u91cf\u65e0\u9650\u7684\u8fb9\uff0c\u7136\u540e\u518d\u548c\u6c47\u70b9\u8fde\u4e00\u6761\u5bb9\u91cf\u4e3a\u9700\u8981\u7684\u91d1\u5e01\u6570\u91cf\u7684\u8fb9\u3002\u6700\u540e\u8dd1\u4e00\u904d\u7f51\u7edc\u6d41\u5373\u53ef\u3002\n\n### Code\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define endl '\\n'\nusing namespace std;\nconst int N=2505,M=4e6+5,inf=2e9;\nstruct edge{\n\tint v,nxt,w;\n}e[M<<1];\nint head[N],cnt=1;\nint n,m,S,T,cur[N],dep[N],c[N],lst[N];\nvoid Add(int x,int y,int w){\n\te[++cnt]=((edge){y,head[x],w});\n\thead[x]=cnt;\n}\nvoid add(int x,int y,int w){\n\tAdd(x,y,w),Add(y,x,0);\n}\nbool bfs(int st,int ed){\n\tmemset(dep,0,sizeof(dep));\n\tqueue<int>q;\n\tq.push(st);\n\tcur[st]=head[st],dep[st]=1;\n\twhile(!q.empty()){\n\t\tint u=q.front();\n\t\tq.pop();\n\t\tfor(int i=head[u];i;i=e[i].nxt){\n\t\t\tint v=e[i].v;\n\t\t\tif(!dep[v] && e[i].w){\n\t\t\t\tdep[v]=dep[u]+1;\n\t\t\t\tcur[v]=head[v];\n\t\t\t\tq.push(v);\n\t\t\t}\n\t\t}\n\t}\n\treturn dep[ed];\n}\nint dfs(int u,int frm){\n\tint to=0;\n\tif(u==T) return frm;\n\tfor(int i=cur[u];i && frm;i=e[i].nxt){\n\t\tint v=e[i].v;\n\t\tcur[u]=i;\n\t\tif(e[i].w && dep[v]==dep[u]+1){\n\t\t\tint tmp=dfs(v,min(frm,e[i].w));\n\t\t\te[i].w-=tmp,e[i^1].w+=tmp;\n\t\t\tfrm-=tmp,to+=tmp;\n\t\t}\n\t}\n\tif(!to) dep[u]=0;\n\treturn to;\n}\nint Dinic(){\n\tint flw=0;\n\twhile(bfs(S,T)) flw+=dfs(S,inf);\n\treturn flw;\n}\nsigned main(){\n\tios::sync_with_stdio(false);\n\tcin.tie(nullptr),cout.tie(nullptr);\n\tcin>>m>>n;\n\tS=0,T=n+1;\n\tfor(int i=1;i<=m;++i) cin>>c[i];\n\tfor(int i=1,k,a,need;i<=n;++i){\n\t\tcin>>k;\n\t\twhile(k--){\n\t\t\tcin>>a;\n\t\t\tif(!lst[a]) add(S,i,c[a]);\n\t\t\telse add(lst[a],i,inf);\n\t\t\tlst[a]=i;\n\t\t}\n\t\tcin>>need;\n\t\tadd(i,T,need);\n\t}\n\tcout<<Dinic()<<endl;\n\treturn 0;\n}\n```\n",
        "postTime": 1683352444,
        "uid": 491321,
        "name": "Erotate",
        "ccfLevel": 0,
        "title": "[SHOI2011]\u94f6\u884c\u5bb6 \u9898\u89e3"
    },
    {
        "content": "[P4638 [SHOI2011]\u94f6\u884c\u5bb6](https://www.luogu.com.cn/problem/P4638)\n\n## \u5206\u6790\n\n\u8fd9\u9053\u9898\u9898\u76ee\u5341\u5206\u7684\u5197\u6742\uff0c\u6211\u4eec\u5148\u6765\u6574\u7406\u4e00\u4e0b\u9898\u610f\uff1a\u4e00\u4e9b\u5ba2\u6237\u8981\u6765\u94f6\u884c\u53d6\u91d1\u5e01\uff0c\u5982\u679c $i$ \u4e2a\u5ba2\u6237\u9700\u8981 $c_i$ \u4e2a\u91d1\u5e01\uff0c\u80fd\u6253\u5f00\u7684\u6240\u6709\u4fdd\u9669\u7bb1\u4e2d\u91d1\u5e01\u603b\u6570\u591a\u4e8e $c_i$ \u5c31\u4f1a\u53d6\u8d70\u5bf9\u5e94\u7684\u91d1\u5e01\u6570\uff0c\u5426\u5219\u4f1a\u5168\u90e8\u53d6\u8d70\uff0c\u800c\u4e14\u4e00\u4e2a\u5ba2\u6237\u6765\u53d6\u91d1\u5e01\u540e\u5c31\u53ef\u4ee5\u4ea4\u6362\u4ed6\u6253\u5f00\u7684\u4fdd\u9669\u7bb1\u7684\u91d1\u5e01\uff0c\u8bf7\u95ee\u6240\u6709\u5ba2\u6237\u6700\u591a\u53ef\u4ee5\u53d6\u8d70\u591a\u5c11\u91d1\u5e01\u3002\n\n&#8195; \u8fd9\u9053\u9898\u521d\u770b\u5c31\u53ef\u4ee5\u53d1\u73b0\u662f\u4e00\u9053\u7f51\u7edc\u6d41\u7684\u9898\uff0c\u91d1\u5e01\u5373\u4e3a\u6d41\u3002\u5728\u6bcf\u4e00\u4e2a\u5ba2\u6237\u6253\u5f00\u4e86\u51e0\u4e2a\u4fdd\u9669\u7bb1\u4e4b\u540e\u5c31\u628a\u8fd9\u4e9b\u4fdd\u9669\u7bb1\u5408\u5e76\u6210\u4e00\u4e2a\u4fdd\u9669\u7bb1\u5373\u53ef\u3002\u4f46\u662f\u5bf9\u4e8e\u7279\u5b9a\u7684\u5ba2\u6237\uff08\u4e5f\u5c31\u662f\u7b2c\u4e00\u4e2a\u6253\u5f00\u8fd9\u4e9b\u4fdd\u9669\u7bb1\u7684\u5ba2\u6237\u4e4b\u540e\u7684\u5ba2\u6237\uff09\u624d\u53ef\u4ee5\u5408\u5e76\u4fdd\u9669\u7bb1\uff0c\u800c\u5176\u4ed6\u7684\u5ba2\u6237\u5c31\u4e0d\u884c\u3002\u5982\u679c\u6211\u4eec\u628a\u8fd9\u4e9b\u4fdd\u9669\u7bb1\u7b80\u5355\u5730\u8fde\u5728\u4e00\u8d77\uff0c\u5c31\u53ef\u4ee5\u7ed9\u6240\u6709\u5ba2\u6237\u4ea4\u6362\u91d1\u5e01\u3002\n\n\u7531\u4e8e\u5728\u7b2c\u4e00\u4e2a\u6253\u5f00\u8fd9\u4e2a\u4fdd\u9669\u7bb1\u4e4b\u540e\u7684\u5ba2\u6237\u624d\u80fd\u5408\u5e76\u4fdd\u9669\u7bb1\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5408\u5e76\u8d77\u6765\u7684\u4fdd\u9669\u7bb1\u6307\u5411\u540e\u9762\u7684\u6240\u6709\u5ba2\u6237\uff0c\u800c\u4e0d\u6307\u5411\u4e4b\u524d\u7684\u5ba2\u6237\u5c31\u53ef\u4ee5\u4e86\u3002\u4f46\u662f\u5904\u7406\u5408\u5e76\u4fdd\u9669\u7bb1\u4e5f\u6bd4\u8f83\u9ebb\u70e6\uff0c\u6bd4\u5982\u7b2c\u4e00\u4e2a\u4eba\u6253\u5f00\u4e86\u4fdd\u9669\u7bb1 $1,2$\uff0c\u7b2c\u4e8c\u4e2a\u4eba\u6253\u5f00\u4e86 $2,3$\uff0c\u6b64\u65f6 $2,3$ \u4fdd\u9669\u7bb1\u90fd\u53ef\u4ee5\u53d6\u5230\u4fdd\u9669\u7bb1 $1$ \u7684\u91d1\u5e01\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5c06\u6bcf\u4e00\u4e2a\u4fdd\u9669\u7bb1\u5bf9\u5e94\u7684\u5408\u5e76\u4fdd\u9669\u7bb1\u518d\u5408\u5e76\u8d77\u6765\u624d\u5bf9\uff0c\u800c\u4e0d\u662f\u5355\u72ec\u7684\u539f\u59cb\u4fdd\u9669\u7bb1\u3002\u800c\u4e14\u6ce8\u610f\uff0c\u6b64\u65f6\u5bf9\u4e8e\u4fdd\u9669\u7bb1 $2,3$ \u6765\u8bf4 $1,2,3$ \u662f\u4e00\u4e2a\u4fdd\u9669\u7bb1\uff0c\u4f46\u662f\u5bf9\u4e8e\u4fdd\u9669\u7bb1 $1$ \u6765\u8bf4\u53ea\u6709 $1,2$ \u662f\u4e00\u4e2a\u4fdd\u9669\u7bb1\u3002\n\n\u7531\u4e8e\u4e00\u4e2a\u5ba2\u6237\u6253\u5f00\u7684\u6240\u6709\u4fdd\u9669\u7bb1\u90fd\u8981\u5408\u5e76\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u8fd9\u4e2a\u5408\u5e76\u4fdd\u9669\u7bb1\u4e0e\u8fd9\u4e2a\u5ba2\u6237\u6346\u7ed1\u3002\u5982\u679c\u4e00\u4e2a\u4fdd\u9669\u7bb1\u5df2\u7ecf\u4e0e\u4e00\u4e2a\u5ba2\u6237\u6346\u7ed1\u4e86\uff0c\u90a3\u4e48\u5f53\u524d\u5ba2\u6237\u5c31\u53ef\u4ee5\u628a\u8fd9\u4e2a\u4fdd\u9669\u7bb1\u91cc\u7684\u91d1\u5e01\u4ece\u4e0a\u4e00\u4e2a\u4eba\u63a5\u624b\u5168\u90e8\u6216\u90e8\u5206\u8fc7\u6765\u3002\u5982\u679c\u8fd9\u4e2a\u4fdd\u9669\u7bb1\u8fd8\u6ca1\u6709\u4eba\u5f00\u8fc7\u5c31\u76f4\u63a5\u628a\u539f\u59cb\u4fdd\u9669\u7bb1\u4e2d\u7684\u91d1\u5e01\u653e\u5728\u81ea\u5df1\u5bf9\u5e94\u7684\u4fdd\u9669\u7bb1\u4e2d\u3002\n\n\u6211\u4eec\u6765\u770b\u4e00\u773c\u6837\u4f8b\uff1a\n\n```\n3 3\n3 1 10\n2 1 2 2\n2 1 3 3\n1 2 6\n```\n\n&#8195; \u6837\u4f8b\u5efa\u51fa\u6765\u7684\u56fe\u5982\u4e0b\uff08\u6bcf\u4e00\u6761\u8fb9\u7684\u5bb9\u91cf\u90fd\u662f\u6b63\u65e0\u7a77\uff09\uff0c\u518d\u52a0\u4e0a\u6e90\u6c47\u70b9\u5373\u53ef\u3002\n\n![1](https://cdn.luogu.com.cn/upload/image_hosting/qnkaxboo.png?x-oss-process=image/resize,m_lfit,h_170,w_225)\n\n## code\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<queue>\nusing namespace std;\ntypedef long long ll;\nint N,n,m,p=1,s1,s2,t[10001],t0[10001],f[10001],g[10001],v[10001];\nbool u=true;\nstruct str\n{\n    int m,q;\n    ll r;\n}a[1000001];\nvoid road(int x,int y,ll r)\n{\n    a[++p].m=y;\n    a[p].q=t[x];\n    t[x]=p;\n    a[p].r=r;\n}\nvoid bfs()\n{\n    queue<int> Q;\n    Q.push(s2);\n    f[s2]=1;\n    g[1]=1;\n    while(!Q.empty())\n    {\n        int k=Q.front();\n        Q.pop();\n        for(int i=t[k];i!=0;i=a[i].q)\n        {\n            if(f[a[i].m]==0)\n            {\n                f[a[i].m]=f[k]+1;\n                ++g[f[a[i].m]];\n                Q.push(a[i].m);\n            }\n        }\n    }\n}\nll dfs(int x,ll r)\n{\n    if(x==s2) return r;\n    ll s=0;\n    for(int i=t0[x];i!=0;i=a[i].q)\n    {\n        t0[x]=i;\n        if(f[x]==f[a[i].m]+1&&a[i].r!=0)\n        {\n            int z=dfs(a[i].m,min(r,a[i].r));\n            if(z!=0)\n            {\n                a[i].r-=z;\n                a[i^1].r+=z;\n                r-=z;\n                s+=z;\n            }\n            if(r==0) return s;\n        }\n    }\n    --g[f[x]];\n    if(g[f[x]]==0) u=false;\n    ++f[x];\n    ++g[f[x]];\n    return s;\n}\nint main()\n{\n    scanf(\"%d%d\",&m,&n);\n    N=n+m+2;\n    s1=N-1;\n    s2=N;\n    for(int i=1;i<=m;++i)\n    {\n        ll r;\n        scanf(\"%lld\",&r);\n        road(s1,i,r);\n        road(i,s1,0);\n    }\n    for(int i=1;i<=n;++i)\n    {\n        int d;\n        scanf(\"%d\",&d);\n        for(int j=1;j<=d;++j)\n        {\n            int x;\n            scanf(\"%d\",&x);\n            if(v[x]==0)\n            {\n                road(x,m+i,1e18);\n                road(m+i,x,0);\n            }\n            else\n            {\n                road(m+v[x],m+i,1e18);\n                road(m+i,m+v[x],0);\n            }\n            v[x]=i;\n        }\n        ll r;\n        scanf(\"%lld\",&r);\n        road(m+i,s2,r);\n        road(s2,m+i,0);\n    }\n    bfs();\n    ll r=0;\n    while(u==true)\n    {\n        for(int i=1;i<=N;++i) t0[i]=t[i];\n        r+=dfs(s1,1e18);\n    }\n    printf(\"%lld\",r);\n    return 0;\n}\n```",
        "postTime": 1646890689,
        "uid": 291248,
        "name": "\u8d75\u60a6\u5c91",
        "ccfLevel": 7,
        "title": "P4638 [SHOI2011]\u94f6\u884c\u5bb6"
    },
    {
        "content": "\u9898\u76ee\uff1a[P4638](https://www.luogu.com.cn/problem/P4638)  \n\u53cc\u500d\u7ecf\u9a8c\uff1a[SP4063](https://www.luogu.com.cn/problem/SP4063)\n\n\u9996\u5148\u8f6c\u5316\u9898\u610f\uff1a\u5f53\u51fa\u73b0\u91cd\u590d\u7684\u94a5\u5319\u65f6\uff0c\u518d~~\u7a7f\u8d8a\u65f6\u7a7a~~\u8c03\u6574\u4fdd\u9669\u67dc\u2014\u2014\u8fd9\u4e0d\u662f\u7f51\u7edc\u6d41\u7684\u589e\u5e7f\u8def\u5417\uff01\n\n\u96be\u70b9\u5728\u4e8e\u5efa\u56fe\u3002\n- \u5efa\u7acb\u8d85\u7ea7\u6e90\u70b9 $s$ \u548c\u8d85\u7ea7\u6c47\u70b9 $t$\uff0c\u4ee5\u987e\u5ba2\u4e3a\u8282\u70b9\u3002\n- \u987e\u5ba2 $i$ \u662f\u7b2c\u4e00\u4e2a\u62e5\u6709\u94a5\u5319 $x$ \u7684\uff1a\u90a3\u4e48\u8ba9\u4ed6\u638c\u7ba1\u4fdd\u9669\u67dc $x$\uff0c\u5373\u5728 $s$ \u548c $i$ \u4e4b\u95f4\u5efa\u4e00\u6761\u6d41\u91cf\u4e3a \u4fdd\u9669\u67dc $x$ \u91d1\u5e01\u6570\u91cf \u7684\u8fb9\u3002\n- \u5426\u5219\uff1a\u8ba9\u4ed6\u627e\u4e0a\u4e00\u4e2a\u638c\u7ba1\u94a5\u5319\u7684\u987e\u5ba2\u8981\u91d1\u5e01\uff0c\u6ca1\u6709\u9650\u5236\uff0c\u5373\u5728 \u4e0a\u4e00\u4e2a\u638c\u7ba1\u94a5\u5319 $x$ \u7684\u987e\u5ba2 \u548c $i$ \u4e4b\u95f4\u5efa\u4e00\u6761\u6d41\u91cf\u4e3a\u65e0\u7a77\u5927\u7684\u8fb9\u3002\n- \u4f46\u662f\u6bcf\u4e2a\u987e\u5ba2\u60f3\u8981\u7684\u91d1\u5e01\u6570\u91cf\u662f\u6709\u9650\u5236\u7684\uff0c\u56e0\u6b64\u5728\u987e\u5ba2 $i$ \u548c $t$ \u4e4b\u95f4\u5efa\u4e00\u6761\u6d41\u91cf\u4e3a \u987e\u5ba2 $i$ \u60f3\u8981\u7684\u91d1\u5e01\u6570\u91cf \u7684\u8fb9\u3002\n\n\u8fd9\u6837\uff0c\u987e\u5ba2\u5c31\u53ef\u4ee5\u4e92\u76f8\u8981\u91d1\u5e01\u4e86\uff0c\u5373\u5728\u7f51\u7edc\u56fe\u4e2d\u5bfb\u627e\u589e\u5e7f\u8def\uff0c\u8dd1\u6700\u5927\u6d41\u5373\u53ef\u3002\u8fd9\u91cc\u4f7f\u7528 ISAP\u3002\u6ce8\u610f\uff1a\u5171\u6709 $n+2$ \u4e2a\u8282\u70b9\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=5005,inf=2147483647;\nint n,m,s,t;\nint tot=1,head[N],cur[N],to[N*2],dis[N*2],nxt[N*2];\nint a[N],vis[N];\nvoid add(int u,int v,int w){nxt[++tot]=head[u],to[tot]=v,dis[tot]=w,head[u]=cur[u]=tot;}\nint dep[N],gap[N];\nint ans;\nvoid bfs(){\n\tqueue<int>q;\n\tmemset(dep,-1,sizeof(dep));\n\tq.push(t),dep[t]=0;\n\twhile(!q.empty()){\n\t\tint u=q.front();q.pop(),gap[dep[u]]++;\n\t\tfor(int i=head[u];i;i=nxt[i]){\n\t\t\tint v=to[i];\n\t\t\tif(dep[v]==-1)dep[v]=dep[u]+1,q.push(v);\n\t\t}\n\t}\n}\nint dfs(int u,int in){\n\tif(u==t)return in;\n\tint out=0;\n\tfor(int i=cur[u];i;i=nxt[i]){\n\t\tcur[u]=i;\n\t\tint v=to[i],w=dis[i];\n\t\tif(dep[v]==dep[u]-1&&w){\n\t\t\tint x=dfs(v,min(in,w));\n\t\t\tdis[i]-=x,dis[i^1]+=x,in-=x,out+=x;\n\t\t\tif(!in)return out;\n\t\t}\n\t}\n\tif(!(--gap[dep[u]]))dep[s]=n+3;\n\tgap[++dep[u]]++;\n\treturn out;\n}\nsigned main(){\n\tcin>>m>>n,s=0,t=n+1;\n\tfor(int i=1;i<=m;i++)cin>>a[i];\n\tfor(int i=1;i<=n;i++){\n\t\tint k;cin>>k;\n\t\tfor(int j=1;j<=k;j++){\n\t\t\tint x;cin>>x;\n\t\t\tif(!vis[x])add(s,i,a[x]),add(i,s,0);\n\t\t\telse add(vis[x],i,inf),add(i,vis[x],0);\n\t\t\tvis[x]=i;\n\t\t}\n\t\tcin>>k,add(i,t,k),add(t,i,0);\n\t}\n\tbfs();\n\twhile(dep[s]<n+2)memcpy(cur,head,sizeof(head)),ans+=dfs(s,inf);\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1646446276,
        "uid": 437788,
        "name": "aqx_AK_xyf",
        "ccfLevel": 5,
        "title": "P4638 [SHOI2011]\u94f6\u884c\u5bb6"
    },
    {
        "content": "\n> \u7f51\u7edc\u6d41\u5efa\u6a21\u597d\u9898\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4638) & [\u53cc\u500d\u7ecf\u9a8c](https://www.luogu.com.cn/problem/SP4063)\n\n\u9996\u5148\uff0c\u987e\u5ba2\u6765\u53d6\u91d1\u5e01\u662f\u6709\u5e8f\u7684\uff0c\u524d\u9762\u7684\u987e\u5ba2\u7684\u4e3e\u52a8\u53ef\u80fd\u4f1a\u5f71\u54cd\u5230\u540e\u9762\u7684\u987e\u5ba2\uff0c\u8003\u8651\u5982\u4f55\u5c06\u8fd9\u4e2a\u5f71\u54cd\u4f53\u73b0\u5728\u5efa\u56fe\u4e0a\u3002\n\n\u7531\u4e8e\u6211\u4eec\u53ef\u4ee5\u4efb\u610f\u91cd\u6392\u5148\u6765\u7684\u5ba2\u6237\u62e5\u6709\u94a5\u5319\u53ef\u4ee5\u6253\u5f00\u7684\u4fdd\u9669\u7bb1\u91cc\u7684\u91d1\u5e01\uff0c\u6211\u4eec\u5c31\u201c\u4ee4\u201d\u4ed6\u6765\u201c\u638c\u7ba1\u201d\u8fd9\u4e9b\u4fdd\u9669\u7bb1\uff0c\u6839\u636e\u540e\u6765\u4eba\u6765\u5206\u914d\u8fd9\u4e9b\u91d1\u5e01\u3002\n\n\u5177\u4f53\u5982\u4f55\u89e3\u51b3\u5462\uff1f\n\n\u62ff\u6837\u4f8b\u4e00\u4e3e\u4f8b\n\n```\n3 3\n3 1 10\n2 1 2 2\n2 1 3 3\n1 2 6\n```\n\n\u7b2c\u4e00\u540d\u987e\u5ba2\u62e5\u6709 $1,2$ \u4fdd\u9669\u7bb1\u7684\u94a5\u5319\uff0c\u6211\u4eec\u5c31\u8ba9\u4ed6\u638c\u7ba1 $1,2$ \u4fdd\u9669\u7bb1\u3002\n\n\u5efa\u7acb\u4e00\u6761 $S \\to 1(\\text{\u4ee3\u8868\u7b2c\u4e00\u540d\u987e\u5ba2\u7684\u8282\u70b9})$ \u8fb9\u6743\u4e3a $3(\\text{\u7b2c\u4e00\u4e2a\u4fdd\u9669\u7bb1\u4e2d\u7684\u91d1\u5e01\u6570})$  \u7684\u8fb9\u3002\n\n\u518d\u5efa\u7acb\u4e00\u6761 $S \\to 2(\\text{\u4ee3\u8868\u7b2c\u4e8c\u540d\u987e\u5ba2\u7684\u8282\u70b9})$ \u8fb9\u6743\u4e3a $1(\\text{\u7b2c\u4e8c\u4e2a\u4fdd\u9669\u7bb1\u4e2d\u7684\u91d1\u5e01\u6570})$  \u7684\u8fb9\u3002\n\n\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u8ba9\u7b2c\u4e00\u540d\u987e\u5ba2\u638c\u7ba1\u4e86 $1,2$ \u4fdd\u9669\u7bb1\u3002\n\n\u7b2c\u4e00\u540d\u987e\u5ba2\u62e5\u6709 $1,3$ \u4fdd\u9669\u7bb1\u7684\u94a5\u5319\uff0c\u6211\u4eec\u5c31\u8ba9\u4ed6\u638c\u7ba1 $1,3$ \u4fdd\u9669\u7bb1\u3002\n\n\u7531\u4e8e\u7b2c\u4e00\u540d\u987e\u5ba2\u5df2\u7ecf\u638c\u7ba1\u4e86 $1,2$ \u4fdd\u9669\u7bb1\uff0c\u4ed6\u53ef\u4ee5\u5c06\u6240\u6709 $1,2$ \u4fdd\u9669\u7bb1\u91cc\u7684\u91d1\u5e01\u90fd\u8f6c\u79fb\u5230 $1$ \u4fdd\u9669\u7bb1\u91cc\uff0c\u6240\u4ee5\u7b2c\u4e8c\u540d\u987e\u5ba2\u5982\u679c\u638c\u7ba1 $1$ \u4fdd\u9669\u7bb1\u5c31\u76f8\u5f53\u4e8e\u638c\u7ba1\u4e86 $1,2$ \u4fdd\u9669\u7bb1\uff0c\u4e5f\u5c31\u662f\u638c\u7ba1\u4e86\u7b2c\u4e00\u540d\u987e\u5ba2\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u5efa\u7acb\u4e00\u6761 $1(\\text{\u4ee3\u8868\u7b2c\u4e00\u540d\u987e\u5ba2\u7684\u8282\u70b9})\\to 2(\\text{\u4ee3\u8868\u7b2c\u4e8c\u540d\u987e\u5ba2\u7684\u8282\u70b9})$ \u8fb9\u6743\u4e3a $\\inf$ \u7684\u8fb9\uff0c\u4ee3\u8868\u7740\u7b2c\u4e8c\u540d\u987e\u5ba2\u638c\u7ba1\u4e86\u7b2c\u4e00\u540d\u987e\u5ba2\u3002\n\n\u7136\u540e\u518d\u5efa\u7acb\u4e00\u6761 $S\\to 2(\\text{\u4ee3\u8868\u7b2c\u4e8c\u540d\u987e\u5ba2\u7684\u8282\u70b9})$ \u8fb9\u6743\u4e3a $10(\\text{\u7b2c\u4e09\u4e2a\u4fdd\u9669\u7bb1\u4e2d\u7684\u91d1\u5e01\u6570}) $ \u7684\u8fb9\n\n\u8fd9\u6837\u987e\u5ba2\u4e8c\u7684\u4efb\u52a1\u5b8c\u6210\u5566\uff01\uff01\uff01\n\n\u7136\u540e\u987e\u5ba2\u4e09\u4e5f\u540c\u7406\u638c\u7ba1\u4e86 $2$ \u4fdd\u9669\u7bb1\u5c31\u76f8\u5f53\u4e8e\u638c\u7ba1\u4e86\u987e\u5ba2\u4e00\u624b\u4e2d\u7684 $1,2$ \u4fdd\u9669\u7bb1\u3002\u5efa\u4e00\u6761 $1\\to3$ \u8fb9\u6743\u4e3a $\\inf$ \u7684\u8fb9\u5373\u53ef\u3002\n\n\u6700\u540e\u518d\u5c06\u4ee3\u8868\u6bcf\u4f4d\u987e\u5ba2\u7684\u8282\u70b9\u8fde\u5411 $T$ \u8fb9\u6743\u4e3a\u4ed6\u4eec\u60f3\u53d6\u7684\u91d1\u5e01\u6570\u8dd1\u4e00\u904d\u6700\u5927\u6d41\u5373\u53ef\u3002\n\n$\\texttt{AC CODE}$\n\n```cpp\n#include<bits/stdc++.h>\n#define inf 1000000000\nconst int N=1000010,M=2000010;\nint n,m,S,T;\nint num=1,fir[N],to[M],nxt[M],f[M],fa[N];\nint d[N],head,tail,que[N],cur[N],a[N];\ninline void add(int u,int v,int w)\n{\n\tto[++num]=v,nxt[num]=fir[u],fir[u]=num,f[num]=w;\n}\nbool bfs()\n{\n\tmemset(d,-1,sizeof(d));\n\thead=tail=0;\n\td[S]=0,que[++tail]=S,cur[S]=fir[S];\n\twhile(head<tail)\n\t{\n\t\tint u=que[++head];\n\t\tfor(int i=fir[u];i;i=nxt[i])\n\t\t{\n\t\t\tint v=to[i];\n\t\t\tif(d[v]==-1&&f[i])\n\t\t\t{\n\t\t\t\td[v]=d[u]+1,cur[v]=fir[v];\n\t\t\t\tif(v==T) return 1;\n\t\t\t\tque[++tail]=v;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n\nint find(int u,int lim)\n{\n\tif(u==T) return lim;\n\tint flow=0;\n\tfor(int i=cur[u];i;i=nxt[i])\n\t{\n\t\tcur[u]=i;\n\t\tint v=to[i];\n\t\tif(d[v]==d[u]+1&&f[i])\n\t\t{\n\t\t\tint t=find(v,std::min(lim-flow,f[i]));\n\t\t\tif(!t) d[v]=-1;\n\t\t\tf[i]-=t,f[i^1]+=t,flow+=t;\n\t\t}\n\t}\n\treturn flow;\n}\n\nint dinic(){\n\tint res=0;\n\twhile(bfs()) res+=find(S,inf);\n\treturn res;\n}\nint main()\n{\n\tscanf(\"%d%d\",&m,&n);S=n+1,T=n+2;\n\tfor(int i=1;i<=m;i++) scanf(\"%d\",&a[i]);\n\tfor(int A,b,i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&A);\n\t\tfor(int j=1;j<=A;j++)\n\t\t{\n\t\t\tscanf(\"%d\",&b);\n\t\t\tif(!fa[b]) add(S,i,a[b]),add(i,S,0);\n\t\t\telse add(fa[b],i,inf),add(i,fa[b],0);\n\t\t\tfa[b]=i;\n\t\t}\n\t\tscanf(\"%d\",&b);\n\t\tadd(i,T,b);\n\t\tadd(T,i,0);\n\t}\n\tprintf(\"%d\",dinic());\n\treturn 0;\n}\n\n```\n\n\u6b22\u8fce\u63d0\u95eeor\u63d0\u51fa\u6211\u7684\u95ee\u9898\uff0c\u4f1a\u6539\u7684\u3002",
        "postTime": 1644131312,
        "uid": 254305,
        "name": "Marsrayd",
        "ccfLevel": 0,
        "title": "P4638 \u9898\u89e3"
    },
    {
        "content": "## P4638 [SHOI2011]\u94f6\u884c\u5bb6\n### \u3010\u9898\u76ee\u5927\u610f\u3011\n\n\u6709 $M$ \u4e2a\u4fdd\u9669\u7bb1\uff0c\u6bcf\u4e2a\u4fdd\u9669\u7bb1\u91cc\u521d\u59cb\u65f6\u6709\u82e5\u5e72\u4e2a\u91d1\u5e01 $C_i$\u3002\u4e00\u5f00\u59cb\u6240\u6709\u4fdd\u9669\u7bb1\u90fd\u662f\u5173\u95ed\u7684\u3002\u4f9d\u6b21\u6765\u4e86 $N$ \u4e2a\u987e\u5ba2\uff0c\u6bcf\u4e2a\u987e\u5ba2\u5206\u522b\u4f1a\u6253\u5f00\u6307\u5b9a\u7684\u51e0\u4e2a\u4fdd\u9669\u7bb1\uff0c\u4ece\u4e2d\u53d6\u8d70\u82e5\u5e72\u4e2a\u91d1\u5e01\u3002\u6bcf\u4e2a\u987e\u5ba2\u5206\u522b\u90fd\u6709\u4ed6\u80fd\u591f\u53d6\u8d70\u7684\u6570\u91cf\u7684\u4e0a\u9650\u3002\u6bcf\u4e2a\u987e\u5ba2\u8d70\u540e\uff0c\u4ed6\u6253\u5f00\u7684\u90a3\u4e9b\u4fdd\u9669\u7bb1\u4e2d\u7684\u91d1\u5e01\uff0c\u90fd\u53ef\u4ee5\u88ab\u4efb\u610f\u5730\u8c03\u6362\u5230\u5176\u5b83\u5f00\u7740\u7684\u4fdd\u9669\u7bb1\u91cc\uff0c\u7136\u540e\u6240\u6709\u4fdd\u9669\u7bb1\u91cd\u65b0\u5173\u4e0a\u3002\u95ee\u603b\u5171\u6700\u591a\u80fd\u8ba9\u5ba2\u6237\u53d6\u8d70\u591a\u5c11\u4e2a\u91d1\u5e01\u3002\uff08$1 \\le N \\le 100$, $1 \\le M \\le 1000$\uff09\n\n\u6709\u4e00\u4e2a\u987e\u5ba2\u4e4b\u540e\uff0c\u5bf9\u5e94\u7684\u4fdd\u9669\u7bb1\u7684\u91d1\u5e01\u5c31\u53ef\u4ee5\u4efb\u610f\u8c03\u914d\uff0c\u5c31\u76f8\u5f53\u4e8e\u8fd9\u4e9b\u6c34\u90fd\u6d41\u5230\u8fd9\u4e2a\u7ba1\u5b50\u91cc\u5835\u7740\uff0c\u6709\u7684\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u7ba1\u5b50\u6d41\u51fa\u53bb\uff08\u88ab\u53d6\u51fa\uff09\uff0c\u6709\u7684\u53ef\u4ee5\u901a\u8fc7\u522b\u7684\u7ba1\u5b50\u6d41\u51fa\u53bb\uff0c\u522b\u7684\u7ba1\u5b50\u6307\u548c\u8fd9\u4e2a\u5bf9\u5e94\u7684\u4fdd\u9669\u7bb1\u6709\u91cd\u53e0\u7684\u7ba1\u5b50\u3002\u5047\u8bbe\u8fd9\u4e2a\u7ba1\u5b50\u662f$1$\uff0c$2$\uff0c$3$\u91cd\u53e0\u4e3a $1$ \uff0c\u4f46\u7ecf\u8fc7\u8fd9\u4e2a\u7ba1\u5b50\u4e4b\u540e1\u4e2d\u91d1\u5e01\u4e5f\u53ef\u4ee5\u7531$2$\uff0c$3$\u8c03\u914d\u8fc7\u6765\uff0c\u6240\u4ee5\u5c31\u76f8\u5f53\u4e8e\u76f4\u63a5\u5728$2$\uff0c$3$\u53d6\u8d70\u91d1\u5e01\u3002\n\n\u8bbe\u4e00\u4e2a $s$ \u70b9\u4e3a\u6e90\u70b9\uff0c\u4e00\u4e2a $t$ \u70b9\u4e3a\u6c47\u70b9\u3002\n\n\u6bcf\u6765\u4e00\u4e2a\u987e\u5ba2 $m+i$ (\u987e\u5ba2\u4ece $m+1$ \u5f00\u59cb\u7f16\u53f7)\uff0c\u5982\u679c\u4ed6\u6240\u62e5\u6709\u94a5\u5319\u7684\u4fdd\u9669\u7bb1\u8fd8\u672a\u88ab\u6253\u5f00\u8fc7\uff0c\u90a3\u8fde\u4e00\u6761\u6e90\u70b9\u548c\u4ed6 \u6d41\u91cf\u4e3a\u6b64\u4fdd\u9669\u7bb1\u7684\u91d1\u5e01\u7684\u6570\u91cf $(s,i,pig[i])$ \u7684\u8fb9\u3002\n\n\u5982\u679c\u4ed6\u6240\u62e5\u6709\u94a5\u5319\u7684\u4fdd\u9669\u7bb1 index \u88ab\u6253\u5f00\u8fc7\uff0c\u90a3\u8fde\u4e00\u6761\u524d\u4e00\u4e2a\u6253\u5f00\u7684\u4eba\u548c\u4ed6\u6d41\u91cf\u4e3a $INF$ \u7684\u8fb9 $(vis[index],i,INF)$\u3002\n\n**\u6bcf\u4e2a\u987e\u5ba2\u4e0e\u6c47\u70b9\u8fde\u4e00\u6761\u6d41\u91cf\u4e3a\u6b64\u987e\u5ba2\u8d2d\u4e70\u529b\u7684\u8fb9$(m+i,t,buy)$**\u3002\n### \u4ee3\u7801\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<queue>\n#define INF 0x3f3f3f3f\n#define N 3001\nusing namespace std;\nint n,m;\nint cap[N][N],flow[N][N];\nint EK(int s,int t) {\n    int res=0;\n    int dis[N];\n    int p[N];\n    memset(p,0,sizeof(p));\n    queue<int> Q;\n    while(true) {\n        memset(dis,0,sizeof(dis));\n        dis[s]=INF;\n        Q.push(s);\n        while(!Q.empty()) {\n            int x=Q.front();\n            Q.pop();\n            for(int y=0;y<=n+1;y++) {\n                if(!dis[y]&&flow[x][y]<cap[x][y]) {\n                    p[y]=x;\n                    Q.push(y);\n                    dis[y]=min(dis[x],cap[x][y]-flow[x][y]);\n                }\n            }\n        }\n        if(dis[t]==0) break;\n        for(int x=t; x!=s; x=p[x]) {\n            flow[p[x]][x]+=dis[t];\n            flow[x][p[x]]-=dis[t];\n        }\n        res+=dis[t];\n    }\n    return res;\n}\nint pigNum[N];\nint last[N];\nint main() {\n    scanf(\"%d%d\",&m,&n);\n    memset(last,0,sizeof(last));\n    memset(cap,0,sizeof(cap));\n    memset(flow,0,sizeof(flow));\n    int s=0,t=n+1;\n    for(int i=1; i<=m; i++)\n        scanf(\"%d\",&pigNum[i]);\n    for(int i=1; i<=n; i++) {\n        int num;\n        scanf(\"%d\",&num);\n        while(num--) {\n            int temp;\n            scanf(\"%d\",&temp);\n            if(last[temp]==0) cap[s][i]+=pigNum[temp];\n            else cap[last[temp]][i]=INF;\n            last[temp]=i;\n        } scanf(\"%d\",&cap[i][t]);\n    }\n    printf(\"%d\\n\",EK(s,t));\n    return 0;\n}\n```\n\u8fd9\u662f\u9053\u53cc\u500d\u7ecf\u9a8c\uff0c\u548c[SP4063 MPIGS - Sell Pigs](https://www.luogu.com.cn/problem/SP4063)\u662f\u4e00\u6837\u7684\n\n\u5b8c\u7ed3\u6492\u82b1",
        "postTime": 1629724135,
        "uid": 365379,
        "name": "ycyoi",
        "ccfLevel": 0,
        "title": "P4638 [SHOI2011]\u94f6\u884c\u5bb6 \u9898\u89e3"
    }
]
[
    {
        "content": "## \u9898\u610f\u5206\u6790\n\u666e\u901a01\u80cc\u5305\uff0c\u82b1\u8d39\u3001\u4ef7\u503c\u90fd\u8d3c\u5927\u3002\u4e0d\u8fc7\u82b1\u8d39\u4e00\u5b9a\u80fd\u8868\u793a\u6210 $a\\times2^b(a\\leq10,b\\leq30)$\u3002\n\n## \u601d\u8def\n\u76f4\u63a5\u752801\u80cc\u5305\u7a7a\u95f4\u65f6\u95f4\u7edd\u5bf9\u90fd\u70b8\u3002\uff08\u4e00\u9053\u7d2b\u9898\u600e\u4e48\u53ef\u80fd\u90a3\u4e48\u7b80\u5355\uff09\n\n\u4e0d\u8fc7\u50cf\u8fd9\u79cd\u6570\u636e\u5927\u5230\u8d77\u98de\u7684\u80cc\u5305\u9898\uff0c\u591a\u534a\u90fd\u4f1a\u6709\u4e00\u4e9b\u7279\u6b8a\u6761\u4ef6\uff08~~\u4e0d\u7136\u600e\u4e48\u505a~~\uff09\n\n\u6240\u4ee5\u6211\u4eec\u4e00\u5b9a\u8981\u4ece\u8fd9\u9053\u9898\u7684\u7279\u6b8a\u6761\u4ef6\u4e0a\u8003\u8651\u3002\n\n\u867d\u7136\u82b1\u8d39\u5f88\u5927\uff0c\u4f46\u662f\u82b1\u8d39\u8868\u793a\u6210\u7684 $a,b$ \u4ee5\u53ca $n$ \u90fd\u5f88\u5c0f\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5bf9   $b$ \u4e0d\u540c\u7684\u7269\u54c1\u5206\u5f00\u80cc\u5305\uff0c\u518d\u8fdb\u884c\u5408\u5e76\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u80cc\u5305\uff0c\u5176\u4ef7\u503c\u4e0d\u53d8\uff0c\u82b1\u8d39\u4e3a\u7269\u54c1\u4ef7\u503c\u5bf9\u5e94\u7684 $a$\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u76f4\u63a5\u80cc\u5305\u4e86\u3002\n\n\u6240\u4ee5\u56f0\u96be\u7684\u5728\u4e8e\u5408\u5e76\u3002\u6211\u4eec\u5148\u4ee4\u4e0a\u65b9\u6240\u6c42\u7684\u80cc\u5305\u4e3a $f[i][j]$\u3002\u8868\u793a\u5bf9\u4e8e $b$ \u4e3a $i$ \u7684\u7269\u54c1\u8fdb\u884c\u80cc\u5305\uff0c\u5f53\u5bb9\u91cf\u4e3a $j$ \u7684\u65f6\u5019\u7684\u6700\u5927\u4ef7\u503c\u3002\n\n\u7136\u540e\u6211\u4eec\u518d\u8bbe\u4e00\u4e2a\u6570\u7ec4 $g[i][j]$ \u8868\u793a\u5f53\u4f7f\u7528 $b$ \u4e3a $0\\sim i$ \u7684\u7269\u54c1\u8fdb\u884c\u80cc\u5305\uff0c$b$ \u4e3a $i$ \u7684\u7269\u54c1\u6240\u5360\u7a7a\u95f4\u4e3a $j$ \u65f6\uff0c\u5269\u4f59\u7269\u54c1\uff08\u5373 $b$ \u4e3a $1\\sim i-1$\uff09\u6240\u5360\u7a7a\u95f4\u4e3a $m\\&((1<<i)-1)$ \u7684\u6700\u5927\u4ef7\u503c\u3002\n\n\u800c\u8fd9\u4e2a $m\\&((1<<i)-1)$ \u7b80\u5355\u6765\u8bf4\u5c31\u662f $m$ \u7684 $i$ \u4f4d\u4ee5\u4e0b\u7684\u503c\u3002\n\n\u63a5\u7740\u6211\u4eec\u5c31\u53ef\u4ee5\u8003\u8651\u8f6c\u79fb\u4e86\uff0c\u8f6c\u79fb\u65b9\u7a0b\u5f0f\u5982\u4e0b\uff1a\n\n$g[i][j]=\\max(g[i][j],f[i][j-k]+g[i-1][min(10\\times n,k\\times2+(m>>(i-1))\\&1)]$\n\n\u90a3\u8fd9\u4e2a\u65b9\u7a0b\u662f\u4ec0\u4e48\u610f\u601d\u5462\uff1f\uff1f\n\n\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u60f3\uff0c\u6211\u4eec\u4ece $j$ \u4e2d\u62c6\u9664 $k$\uff0c\u62ff\u7ed9\u5269\u4e0b\u7684\u7269\u54c1\u653e\u3002\u800c\u9ad8\u4f4d\u5411\u4f4e\u4f4d\u8f6c\u79fb\u65f6\u4f1a $\\times 2$\uff0c\u7136\u540e\u518d\u52a0\u4e0a $m$ \u4e2d\u8be5\u4f4d\u4e0a\u7684\u503c\uff08$m>>(i-1))\\&1$ \u8868\u793a $m$ \u5728 $i-1$ \u4f4d\u4e0a\u7684\u503c\uff09\n\n\u6700\u540e\u6211\u4eec\u53ea\u9700\u8981\u8f93\u51fa $g[m$ \u7684\u4f4d\u6570$][1]$\u5c31\u53ef\u4ee5\u4e86\uff08\u56e0\u4e3a $m$ \u7684\u9996\u4f4d\u4e00\u5b9a\u662f $1$\uff09\n\n## Code\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ninline int read() \n{\n\tchar c=getchar();\n\tint x=0,bj=1;\n\twhile(c<'0'||c>'9') \n\t{\n\t\tif(c=='-') \n\t\t{\n\t\t\tbj=-1;\n\t\t}\n\t\tc=getchar();\n\t}\n\twhile(c>='0'&&c<='9') \n\t{\n\t\tx=x*10+(c^48);\n\t\tc=getchar();\n\t}\n\treturn x*bj;\n}\nint n,m;\nint num[31];\nint a[31][101];\nint w[31][101];\nint f[31][1001];\nint g[31][1001];\nint main()\n{\n\tn=read(),m=read();\n\twhile(n+m!=-2)\n\t{\n\t\tmemset(a,0,sizeof(a));\n\t\tmemset(num,0,sizeof(num));\n\t\tmemset(w,0,sizeof(w));\n\t\tmemset(f,0,sizeof(f));\n\t\tmemset(g,0,sizeof(g));\n\t\tfor(register int i=1;i<=n;i++)\n\t\t{\n\t\t\tregister int x=read();\n\t\t\tint cnt=31;\n\t\t\twhile(x%(1<<(--cnt)));\n\t\t\ta[cnt][++num[cnt]]=x/(1<<cnt);\n\t\t\tw[cnt][num[cnt]]=read();\n\t\t}\n\t\tregister int cnt=31;\n\t\twhile(m<=(1<<(--cnt)));\n\t\tfor(register int t=0;t<=cnt;t++)\n\t\t{\n\t\t\tfor(register int i=1;i<=num[t];i++)\n\t\t\t{\n\t\t\t\tfor(register int j=10*num[t];j>=a[t][i];j--)\n\t\t\t\t{\n\t\t\t\t\tf[t][j]=max(f[t][j],f[t][j-a[t][i]]+w[t][i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(register int j=0;j<=10*num[0];j++)\n\t\t{\n\t\t\tg[0][j]=f[0][j];\n\t\t}//\u5bf90\u8fdb\u884c\u521d\u59cb\u5316\n\t\tfor(register int i=1;i<=cnt;i++)\n\t\t{\n\t\t\tfor(register int j=0;j<=10*n;j++)//\u56e0\u4e3a\u6bcf\u4f4d\u4e0a\u6700\u591a\u5c31\u662f10*n\uff0c\u53ef\u4ee5\u8282\u7701\u65f6\u95f4\n\t\t\t{\n\t\t\t\tfor(register int k=0;k<=j;k++)\n\t\t\t\t{\n\t\t\t\t\tg[i][j]=max(g[i][j],f[i][j-k]+g[i-1][min(10*n,k*2+((m>>(i-1))&1))]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",g[cnt][1]);\n\t\tn=read(),m=read();\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1606892659,
        "uid": 73711,
        "name": "HC20050615",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3188 \u3010[HNOI2007]\u68a6\u5e7b\u5c9b\u5b9d\u73e0\u3011"
    },
    {
        "content": "# P3188 \u68a6\u5e7b\u5c9b\u5b9d\u73e0\n## [Link](https://www.luogu.com.cn/problem/P3188)\n\n## \u603b\u4f53\u8bc4\u4ef7\uff1a\n\n\u5176\u5b9e\u662f\u4e00\u4e2a\u975e\u5e38\u597d\u7684\uff08~~\u677f\u5b50\u9898~~\uff09\uff0c\u4e3b\u8981\u8003\u5bdf\u5bf9\u4e8e 01 \u80cc\u5305\u7684\u7406\u89e3\u548c\u5bf9\u4e8e\u4e8c\u8fdb\u5236\u7684\u5e94\u7528\u4ee5\u53ca\u72b6\u538b DP \u7684\u7406\u89e3\uff0c\u7efc\u5408\u6027\u975e\u5e38\u5f3a\uff0c**\u503c\u5f97\u4e00\u505a**\u3002\n\n## \u9898\u76ee\u5927\u610f\uff1a\n\n\u5c31\u662f\u88f8\u7684 01 \u80cc\u5305\uff0c\u4f46\u662f\u5b83\u7684\u4f53\u79ef\u548c\u4ef7\u503c\u90fd\u5f88\u5927\uff0c\u800c\u4e14\u6bcf\u4e00\u4e2a $w[i]$ \u90fd\u4fdd\u8bc1\u80fd\u5199\u6210 $a * 2^b (a,b \\in N)$ \u7684\u5f62\u5f0f,\u5e76\u4e14 $ a \\leq10, b \\leq 30$\u3002\n\n## \u9898\u76ee\u5206\u6790\uff1a\n\n\u8fd9\u4e0d\u662f\u677f\u5b50\u9898\u5417\uff1f\uff1f\uff1f\u7136\u540e\u6572\u4e86\u4e00\u4e2a\u677f\u5b50\u4e0a\u53bb\uff08~~\u5185\u5fc3\u5145\u6ee1\u671f\u5f85~~\uff09\uff0c\u7136\u800c\uff0c\u7d2b\u9898\u600e\u4e48\u4f1a\u8fd9\u4e48\u5bb9\u6613\u554a\u5582\uff0c\u7ed3\u679c TLE \u548c RE \u51fb\u788e\u4e86\u6211\uff08~~\u6c34~~\uff09\u597d\u597d\u6253\u9898\u7684\u6b32\u671b\u3002\n\n\u5f53\u7136\uff0c\u6bcf\u4e00\u4e2a\u9898\u90fd\u6709\u4e00\u4e2a\u7a81\u7834\u70b9\uff0c\u800c\u8fd9\u4e2a\u9898\u7684\u7a81\u7834\u70b9\u5c31\u662f\u6570\u636e\u8303\u56f4\uff0c\u770b\u5230 $w$ \u7684\u6570\u636e\u8303\u56f4\u7684\u65f6\u5019\uff0c\u5176\u5b9e\u6211\u5185\u5fc3\u662f\u6709\u4e00\u4e1d\u7a83\u559c\u7684\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u9898\u4e0d\u4f1a\u50cf\u4e4b\u524d\u4e00\u6837\u6ca1\u6709\u601d\u8def\u4e86\u3002\n\n\u5f53\u7136\uff0c\u8fd9\u4e2a $a * 2^b$ \u5176\u5b9e\u5e76\u6ca1\u6709\u4ec0\u4e48\u5927\u7684\u7528\u5904\uff0c\u56e0\u4e3a\u628a\u4e00\u4e2a\u6570\u8f6c\u6362\u6210\u4e8c\u8fdb\u5236\u4e4b\u540e\uff0c\u5b83\u4e00\u5b9a\u53ef\u4ee5\u8868\u793a\u6210\u8fd9\u6837\u7684\u5f62\u5f0f\u3002\u6240\u4ee5\u6211\u4eec\u63a5\u7740\u5206\u6790\u9898\u76ee\uff0c$a \\leq 10$ \u624d\u662f\u6700\u91cd\u8981\u7684\u6761\u4ef6\uff0c\u6211\u4eec\u770b\u5230\u8fd9\u4e48\u5c0f\u7684\u6570\u636e\uff0c\u5728\u7ed3\u5408\u4e00\u70b9\u4e8c\u8fdb\u5236\u7684\u77e5\u8bc6\uff0c\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u5c31\u662f **\u63d0\u793a\u4f60\u8981\u62c6\u4f4d\uff0c\u5e76\u4e14\u6309\u7167b\u6765\u5206\u7ec4**\uff0c$ a $ \u5c31\u662f\u76f8\u5f53\u4e8e\u662f\u4f53\u79ef\u4e86\u3002\uff08**\u91cd\u70b9**\uff09\n\n\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u8fd9\u4e48\u4e00\u4e2a\u6027\u8d28\uff0c\u63a5\u7740\u6211\u4eec\u5c31\u53ef\u4ee5\u8bbe\u72b6\u6001\u4e86\uff0c\uff08~~\u663e\u7136~~\uff09\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e00\u4f4d\u8fdb\u884c\u8003\u8651\uff0c\u8bbe  $ g[i][j]$ \u4e3a\u5728 $ b = i$ \u7684\u8fd9\u4e00\u7ec4\u4e2d\u6240\u9009\u53d6\u4f53\u79ef\u4e3a $j$ \u7684\u6700\u5927\u503c\uff0c\u6839\u636e 01 \u80cc\u5305\u7684dp\u8f6c\u79fb\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff1a\n$$\ng[i][p] = \\max(g[i][p], g[i][p - k[i][j]] + val[i][j])\n$$\n\u7b80\u5355\u89e3\u91ca\u4e00\u4e0b\u6211 ~~\u5947\u602a~~ \u7684\u53d8\u91cf\u540d\uff1a\n\n$\\bullet$ \u5176\u4e2d $g$ \u6570\u7ec4\u662f\u4e0a\u9762\u6211\u6240\u8bf4\u7684\u3002\n\n$\\bullet$ $i$ \u662f\u6211\u6240\u679a\u4e3e\u7684 $b$\u3002\uff08\u5373\u4e8c\u8fdb\u5236\u4e0b\u62c6\u4f4d\u7684\u54ea\u4e00\u4f4d\uff09\n\n$\\bullet$ $p$ \u662f\u6211\u6240\u679a\u4e3e\u7684\u5728 $i$ \u8fd9\u4e00\u4f4d\u7684\u4f53\u79ef\u3002\n\n$\\bullet$ $k$ \u662f\u6211\u6240\u9884\u5904\u7406\u540e\u7684\u5404\u4e2a\u5b9d\u73e0\uff0c$val$ \u540c\u7406\u3002\n\n\u8fd9\u65f6\u5019\u6211\u4eec\u5f88\u9ad8\u5174\uff0c\u53ef\u4ee5\u628a\u8fd9\u9898\u5207\u4e86\uff01\uff01\n\n\u4f46\u662f\uff0c\u6211\u4eec\u597d\u50cf\u5fd8\u4e86\u4ec0\u4e48\u6761\u4ef6\uff0c\u6211\u4eec\u7684 $W$ \u597d\u50cf\u5e76\u4e0d\u6ee1\u8db3\u90a3\u4e2a\uff08\u53ef\u7231\uff09\u7684\u6027\u8d28\u3002\u3002\u3002\uff08~~\u9677\u5165\u6c89\u601d~~\uff09\n\n\u65e2\u7136\u4e00\u4e2a dp \u6570\u7ec4\u4e0d\u80fd\u89e3\u51b3\u8fd9\u4e2a\u9898\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4e0d\u53ef\u4ee5\u8bbe\u4e24\u4e2a\u6570\u7ec4\u5462\uff1f\uff1f\uff1f\u662f\u53ef\u4ee5\u7684\u3002\n\n\u6211\u4eec\u8bbe $f[i][j]$ \u4e3a\u5728 $0 \\thicksim  i$  \u7ec4\u4e00\u5171\u9009\u53d6\u4e86 $j * 2^i$ \u7684\u6700\u5927\u4ef7\u503c\u3002\n\n\u7136\u540e\u6211\u4eec\u5f00\u59cb\u601d\u8003\u600e\u4e48\u8f6c\u79fb\uff0c\u6211\u4eec\u4ece $i - 1$ \u72b6\u6001\u8f6c\u79fb\u5230 $i$ \u7684\u72b6\u6001\u7684\u65f6\u5019\uff0c\u679a\u4e3e $p$ \u4e3a\u5f53\u524d $i$ \u8fd9\u4e00\u7ec4\u9009\u53d6\u7684\u4f53\u79ef\uff0c\u6211\u4eec\u5728 $i$ \u7684\u65f6\u5019\u9009\u53d6 $j - p$ \u7684\u4f53\u79ef\u7684\u8bdd\uff0c\u6839\u636e\u4e8c\u8fdb\u5236\u4e0b\u7684\u8868\u793a\uff0c\u5176\u5b9e\u76f8\u5f53\u4e8e\u5728 $i - 1$ \u7684\u8fd9\u4e00\u4f4d\u9009\u53d6 $(j - p) * 2$ \u7684\u4f53\u79ef\uff0c\u5f53\u7136\uff0c\u6211\u4eec\u8f6c\u79fb\u7684\u65f6\u5019\uff0c\u8fd8\u9700\u8981\u8003\u8651\u5bf9\u4e8e $W$ \u8fdb\u884c\u8003\u8651\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u8981\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8f6c\u79fb\u8003\u8651\u4e00\u4e0b $W$ \u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u4e8e\u662f\u4e4e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u51fa\u4e00\u4e2a\u5341\u5206\u53ef\u7231\uff08~~\u96be\u770b~~\uff09\u7684 dp \u8f6c\u79fb\u7684\u5f0f\u5b50\uff1a\n$$\nf[i][j] = \\max(f[i][j], f[i - 1][(j - p) * 2 + W_{i-1})] + g[i][p])\n$$\n$\\bullet$ \u5176\u4e2d $i$\uff0c$j$ \u662f\u6211\u6240\u679a\u4e3e\u7684\u7ec4\u6570\u548c\u603b\u7684\u4f53\u79ef\u3002\n\n$\\bullet$ $p$ \u662f\u6211\u5f53\u524d\u7684\u7ec4\u6570\u5185\u6240\u9700\u8981\u7684\u4f53\u79ef\uff0c$(j - p) * 2$ \u662f\u4e0a\u4e00\u4f4d\u7684\u72b6\u6001\u5bf9\u8fd9\u4e00\u4f4d\u9020\u6210\u7684\u5f71\u54cd\u3002\n\n$\\bullet$ $W_{i-1}$ \u662f\u6211\u5bf9\u5e94\u7684\u4e0a\u4e00\u4f4d\u7684 $W$ \u6240\u5bf9\u5e94\u7684\u4f53\u79ef\uff0c\u5373\u4e8c\u8fdb\u5236\u4e0b\u7b2c $i - 1$ \u4f4d\uff0c$g[i][p]$ \u5c31\u662f\u6211\u8fd9\u4e00\u4f4d\u9009 $p$ \u7684\u4ef7\u503c\u4e86\u3002\n\n\u547c~\uff0c\u6211\u4eec\u7ec8\u4e8e\u505a\u5b8c\u4e86\uff0c\u7b54\u6848\u5f53\u7136\u5c31\u662f $f[s - 1][1]$ \u4e86\uff0c$s$ \u662f $W$ \u6240\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u4f4d\u6570\uff0c\u5982\u679c\u9009\u4e0a $s$ \u4f4d\uff0c\u6211\u4eec\u7684\u7b54\u6848\u5f88\u660e\u663e\u5c31\u4e0d\u5bf9\u4e86\uff0c\u6839\u636e $f$ \u6570\u7ec4\u7684\u5b9a\u4e49\uff0c\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u76f8\u5f53\u4e8e\u591a\u9009\u4e86\u51e0\u4e4e\u4e00\u500d\u7684\u4f53\u79ef\uff0c\u800c $s - 1$ \u5c31\u53ef\u4ee5\u4fdd\u8bc1\u5b83\u7684\u6b63\u786e\u6027\u3002\n\n**\u8bf4\u4e00\u4e0b\u8fd9\u4e2a\u9898\u7684\u4e00\u4e9b\u5751**\n\n\u6211\u505a\u8fd9\u4e2a\u9898\u7684\u65f6\u5019\u771f\u7684\u662f\u5f88\u56f0\u96be\uff0c\uff08~~\u56e0\u4e3a\u6211\u5f88\u83dc~~\uff09\uff0c\u5176\u4e2d\u6709\u975e\u5e38\u591a\u7684\u7ec6\u8282\u9700\u8981\u5904\u7406\u3002\n\n$\\bullet$ \u9700\u8981\u5f00 **long long**\u3002 \n\n$\\bullet$ \u5176\u6b21\uff0c\u6570\u7ec4\u4e0d\u8981\u5f00\u5c0f\u4e86\uff0c\u8003\u8651\u95ee\u9898\u7684\u65f6\u5019\u8981\u8003\u8651\u5168\u9762\u3002\u6211\u5c31\u662f\u6302\u5728\u8fd9\u597d\u957f\u65f6\u95f4\uff0c\u4e00\u5f00\u59cb\u6211\u4ee5\u4e3a\u53ea\u8981\u5f00 30 \u5c31\u591f\u4e86\uff0c\u4f46\u662f\u4e8b\u5b9e\u544a\u8bc9\u6211\u4e0d\u662f\uff0c\uff08~~\u6df1\u601d\u719f\u8651\u4e4b\u540e~~\uff09\uff0c\u53d1\u73b0\u5176\u5b9e\u662f\u6211\u5728\u66f4\u65b0\u8fc7\u7a0b\u4e2d\u5f88\u53ef\u80fd\u6d89\u53ca\u5230\u6211\u8f83\u5927\u7684\u4f53\u79ef\u6765\u8f6c\u79fb\uff0c\u6240\u4ee5\u5c31\u4f1a WA \u3002\n\n\u7ec6\u8282\u6807\u6ce8\u5728\u4ee3\u7801\u91cc\uff0c\u6240\u4ee5\u8003\u8651\u95ee\u9898\u8003\u8651\u5168\u9762\uff0c\u4ee5\u9632\u51fa\u73b0\u6211\u8fd9\u53d1\u73b0\u4e0d\u4e86\u7684\u9519\u8bef\u3002\n\n```c++\n/*\n\u6240\u4ee5\uff0c\u8d70\u8fc7\u7684\u5751\u5927\u5bb6\u4e0d\u8981\u518d\u72af\n*/\n#include<bits/stdc++.h>\n#define il inline\n#define int long long //\u4e0d\u5f00ll\u89c1\u7956\u5b97 \n\nusing namespace std;\nconst int N = 1e6 + 10;\n\nvector<int> val[N], k[N];\n\nil int re()\n{\n\tint x = 0, p = 1;\n\tchar ch = getchar();\n\twhile(ch < '0' || ch > '9') {if(ch == '-') p = -1; ch = getchar();}\n\twhile(ch <= '9' && ch >= '0') {x = (x << 3) + (x << 1) + (ch ^ 48); ch = getchar();}\n\treturn x * p;\n}\n\nint n, W, s;\nint f[50][5000], g[50][5000];//\u6ce8\u610f\u8fd9\u91cc\u4e0d\u8981\u5f00\u592a\u5c0f\uff01\uff01\uff01 \n\nvoid init()//\u591a\u7ec4\u6570\u636e \n{\n\ts = 0;\n\tmemset(f, 0, sizeof(f));\n\tmemset(g, 0, sizeof(g));\n\tfor(int i = 0; i <= 50; ++i) val[i].clear(), k[i].clear();\n}\n\nsigned main()\n{\n\twhile(1)\n\t{\n\t\tn = re(), W = re();\n\t\tif(n == -1) break;\n\t\tinit();\n\t\tfor(int i = 1; i <= n; ++i)//\u8bfb\u5165\n\t\t{\n\t\t\tint x = re(), y = re(), t = 0;\n\t\t\twhile(((x >> t) & 1) == 0) t++;//\u8bb0\u5f55\u6bcf\u4e00\u4e2a\u7269\u54c1\u7684\u4e8c\u8fdb\u5236\u7684\u8868\u793a \n\t\t\tval[t].push_back(y);\n\t\t\tk[t].push_back((x >> t));\n\t\t}\n\t\twhile((W >> s)) s++;//\u603b\u7684\u4f53\u79ef\u7684\u4f4d\u6570 \n\t\tfor(int i = 0; i <= s; ++i)\n\t\t{\n\t\t\tif(k[i].size() == 0) continue;\n\t\t\tfor(int j = 0; j <= k[i].size() - 1; ++j)\n\t\t\t\tfor(int p = 500; p >= k[i][j]; --p)//\u8fd9\u91cc\u679a\u4e3e\u4e3a\u4ec0\u4e48\u8981\u4ece500\u679a\u4e3e\uff1f\uff1f\uff1f\uff1f\u4e00\u4f1a\u4f60\u5c31\u77e5\u9053\u4e86 \n\t\t\t\t\tg[i][p] = max(g[i][p], g[i][p - k[i][j]] + val[i][j]);//g\u6570\u7ec4\u66f4\u65b0\u7b54\u6848 \n\t\t}\t\n\t\tfor(int i = 0; i <= s; ++i)\n\t\t\tfor(int j = 500; j >= 0; --j)\n\t\t\t\tfor(int p = 0; p <= j; ++p)\n\t\t\t\t\tf[i][j] = max(f[i][j], f[i - 1][(j - p) * 2 + ((W >> (i - 1)) & 1)] + g[i][p]);\n                    //f\u6570\u7ec4\uff0c\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u8981\u5f00\u5927\u4e00\u70b9\u7684\u539f\u56e0\uff0c\u6211\u4eec\u8981\u7684\u6570\u7ec4\u5728\u66f4\u65b0\u8fc7\u7a0b\u4e2d\u6781\u6709\u53ef\u80fd\u51fa\u754c\uff0c\n                    //\u4f46\u662f\u6211\u4eec\u8fd8\u8981\u4fdd\u8bc1\u6b63\u786e\u6027\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u4fdd\u8bc1\u5728\u6211\u4eec\u6240\u66f4\u65b0\u7684\u8303\u56f4\u5185\u7b54\u6848\u662f\u6b63\u786e\u7684. \n\t\tprintf(\"%lld\\n\", f[s - 1][1]);\n\t}\n}\n```\n\n\u5b8c\u7ed3\u6492\u82b1\u273f\u273f\u30fd(\u00b0\u25bd\u00b0)\u30ce\u273f\n",
        "postTime": 1628482220,
        "uid": 333580,
        "name": "Zwaire",
        "ccfLevel": 6,
        "title": "P3188"
    },
    {
        "content": "\n**\u5176\u5b9e,\u8fd9\u9053\u9898\u76ee,\u8bc4\u4ef7:**\n\n1.\u96be\u5ea6: @@@@@\n\n2.\u601d\u7ef4\u96be\u5ea6: @@@\n\n3.\u7ec6\u8282\u96be\u5ea6: @@@@@\n\n\u5bf9\u4e8e\u8fd9\u9053\u9898\u76ee,\u6211\u4eec\u53d1\u73b0\u5176\u5b9e\u5c31**\u662f\u666e\u901a\u7684 01 \u80cc\u5305**,\u4f46\u662f**\u6570\u636e** \u5341\u5206\u7684\u5927!\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e8e $v$ $=$ $a$\u00d7$2^{b}$;\u7684 b \u76f8\u540c\u7684\u7269\u54c1\u505a\u4e00\u6b21 dp\n\n\u90a3\u4e48\u5c31\u662f$f[i][j]$ **\u8868\u793a\u4f53\u79ef\u4e3a ($j$\u00d7$2^{i}$) \u7684\u4f53\u79ef** **\u53ea\u6536\u7eb3 $k$\u00d7$2^{i}$ \u7684\u7269\u54c1\u7684\u6700\u5927\u503c**\n\n\u90a3\u4e48\u6700\u540e\u5c31\u662f \u600e\u4e48\u5408\u5e76\u662f\u5173\u952e\u90e8\u5206!\n\n\u5982\u679c\u6211\u4eec\u5047\u8bbe $f[i][j]$ \u73b0\u5728\u8868\u793a\n\n\u8868\u793a$2^{0}$ ~ $2^{i}$\u7ec4\u5185\uff0c \u5bb9\u91cf\u4e3a $j$\u00d7$2^{i}$+($w$&($($$1$<< $i$)$-1$)) \u65f6\u7684\u6700\u5927\u4ef7\u503c\n\n\u4e5f\u5c31\u662ff[i,j]\u8868\u793a\u4f53\u79ef\u4e3a$j$\u00d7 $2^{i}$\u518d\u52a0\u4e0aW**\u4e8c\u8fdb\u5236\u7b2ci\u4f4d\u4ee5\u4e0b\u7684\u4f53\u79ef**\u6700\u591a\u53ef\u4ee5\u83b7\u5f97\u591a\u5c11\u4ef7\u503c\n\n\u90a3\u4e48 \u6211\u4eec\u7684 \u7b54\u6848\u5176\u5b9e\u5c31\u662f dp[len][1] , len\u6307\u7684\u662f \u6700\u5927\u7684$ i$ \u662f $2^{i}$ \u5c0f\u4e8e\u7b49\u4e8e m \u7684\u503c!\n\n\u90a3\u4e48 \u6211\u4eec\u5c31\u662f\u8003\u8651\u8f6c\u79fb \u4ece $f[i-1][...]$ \u5f00\u59cb\u8f6c\u79fb!\n\n\u8f6c\u79fb\u65b9\u7a0b:\n\n$f[i,j]$=$max$($f[i,j],f[i,j-k]$+$f[i-1]$,$min(k*2+e[i-1],d[i-1])]$);\n\n\u5176\u4e2d\u597d\u591a\u662f**\u5c0f\u7ec6\u8282\u90e8\u5206**:\n\n```cpp\nfor(int j=w[i];j>=0;--j) \nfor(int k=0;k<=j;k++)   // \u8fd9\u4e0b\u9762\u7684f[i][j-k] (\u7528\"*\"\u6807\u6ce8\u7684)1\u5176\u5b9e\u5e76\u6ca1\u6709\u53d8\u52a8,\u56e0\u4e3a\u662f\u53cd\u7740\u6765\u6c42\u7684,\u6240\u4ee5\u8fd8\u662f\u8868\u793a \u5355\u5355\u662f 2^i \u7684\u7269\u54c1,\u5927\u5bb6\u53ef\u4ee5\u5199\u4e00\u4e0b\u5f0f\u5b50,\u5c31\u660e\u767d\u4e86!     \n      f[i][j] = getmax(f[i][j] , **f[i][j-k]** + f[i-1][min(w[i-1],(k<<1)|(m>>(i-1)&1))]);\n```\n\n\u8d34\u4e0a\u4ee3\u7801 , \u6709\u660e\u663e\u7684\u5c0f\u9519\u8bef\u7684\u54e6!\n\n```cpp\n#include <bits/stdc++.h>\n#define N 200005\n#define INF 0x3f3f3f3f\nusing namespace std;\nint n,m,len,x,y,f[35][1150],w[35];\ninline int read()\n{\n    int x=0;\n    char c=getchar();\n    while(c<'0'||c>'9'){c=getchar();}\n    while(c>='0'&&c<='9'){x=(x<<3)+(x<<1)+c-'0';c=getchar();}\n    return x;\n}\nvector<int> G[35],V[35];\ninline int getmax(int x,int y){return (x>y)?x:y; }\ninline void init()\n{\n    len = 0;\n    memset(G,0,sizeof G);\n    memset(V,0,sizeof V);\n    memset(w,0,sizeof w);\n    memset(f,0,sizeof f);\n}\nint main(int argc,char const* argv[])\n{\n    while(~scanf(\"%d%d\",&n,&m) && n!=-1)\n    {\n        init();\n        for(int i=1;i<=n;++i)\n        {\n            x = read(); int j = 0;\n            while(!(x&1)) { x>>=1; j++; }\n            G[j].push_back(x); w[j] += x;\n            len = getmax( len , j);\n            scanf(\"%d\",&y); V[j].push_back(y);\n        }\n        for(int i=0;i<=len;i++)\n            for(int j=0;j<(int)G[i].size();++j)\n                for(int k=w[i];k>=G[i][j];k--)\n                    f[i][k] = getmax(f[i][k],f[i][k-G[i][j]]+V[i][j]);\n        while(m>>len) len++; len--;\n        for(int i=1;i<=len;i++)            \n        {\n            w[i] += (w[i-1]+1)/2;\n            for(int j=w[i];j>=0;--j) \n                for(int k=0;k<=j;k++)         \n                    f[i][j] = getmax(f[i][j] , f[i][j-k] + f[i-1][min(w[i-1],(k<<1)|(m>>(i-1)&1))]);\n        }\n        printf(\"%d\\n\",f[len][1]); \n    }\n    return main();\n}\n```\n\n\n\n",
        "postTime": 1515930239,
        "uid": 50047,
        "name": "Bartholomew",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3188 \u3010[HNOI2007]\u68a6\u5e7b\u5c9b\u5b9d\u73e0\u3011"
    },
    {
        "content": "## [\u9898\u610f](https://www.luogu.org/problem/P3188)\n\n\u663e\u7136\u662f\u4e0d\u80fd\u76f4\u63a50-1\u80cc\u5305\u7684\uff0c\u56e0\u4e3a0-1\u80cc\u5305\u662f$O(NM)$\u7684\uff0c$M$\u6700\u5927\u4e3a$2^{30}$\uff0c\u663e\u7136\u4f1a$T$\u6389\u3002\n\n\u9898\u76ee\u4e2d\u6bcf\u4e2a\u7269\u54c1\u4f53\u79ef\u6709\u7279\u8272\u6027\u8d28\uff0c\u5373$weight_i$\u80fd\u5199\u6210$a*2^b(1<=a<=10,0<=b<=30)$\u3002\n\n\u8fd9\u542f\u793a\u6211\u4eec\u5c06\u7269\u54c1\u6309\u7167$b$\u5206\u7ec4,\u8bbe$f_{i,j}$\u8868\u793a\u7269\u54c1\u4ee3\u4ef7\u4e3a$a*2^i$\u7684\u7ec4,\u7528$j*2^i$\u7684\u7a7a\u95f4\u80fd\u83b7\u5f97\u7684\u6700\u5927\u4ef7\u503c\u3002  \n\u90a3\u4e48\u6709\uff1a$f_{i,j}=\\max(f_{i,j-cost}+val)$\n\n\u8003\u8651\u5408\u5e76\u6c42\u51fa\u7684\u72b6\u6001\uff1a  \n\u8bbe$g_{i,j}$\u8868\u793a\u7528\u7269\u54c1\u4ee3\u4ef7\u4e3a$a*2^0$\u5230$a*2^i$\u7684\u7269\u54c1,$i$\u8fd9\u4e00\u4f4d\u7528\u4e86$j*2^i$\u7684\u4f53\u79ef\uff0c$i-1$\u5582\u4ee5\u4e0b\u7528\u4e86$m\\&(2^i-1)$\u7684\u4f53\u79ef(\u5373$i$\u4f4d\u4ee5\u4e0b(\u4e0d\u5305\u542b$i$)\u7684\u4e0e$m$\u76f8\u540c)\u7684\u6700\u5927\u4ef7\u503c\u3002  \n\u90a3\u4e48\u6709\uff1a$g_{i,j}=(f_{i,j-k}+g_{i-1,k*2+(m>>(i-1)\\&1)})$  \n\u8fd9\u91cc$g$\u6570\u7ec4\u53ef\u4ee5\u7528$f$\u6570\u7ec4\u6eda\u52a8\uff0c\u6ce8\u610f\u4e0b\u679a\u4e3e\u987a\u5e8f\u5373\u53ef\u3002  \n\u5176\u542b\u4e49\u4e3a\uff1a  \n\u679a\u4e3e\u5728$i$\u8fd9\u4f4d\u7528\u4e86$(j-k)*2^i$\u7684\u4f53\u79ef,\u90a3\u4e48$i-1$\u4f4d\u4ee5\u4e0b\u5c31\u4f1a\u5206\u5230$k*2*2^{i-1}$\u7684\u4f53\u79ef\u3002\n\ncode\uff1a\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=1010;\nint n,m,len;\nint w[35];\nint f[35][maxn];\nvector<int>cost[35],val[35];\ninline void init()\n{\n\tmemset(val,0,sizeof(val));\n\tmemset(cost,0,sizeof(cost));\n\tmemset(f,0,sizeof(f));\n\tmemset(w,0,sizeof(w));\n\tlen=0;\n } \nint main()\n{\n\twhile(~scanf(\"%d%d\",&n,&m)&&~n&&~m)\n\t{\n\t\tinit();\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tint x,y;scanf(\"%d%d\",&x,&y);\n\t\t\tint j=0;\n\t\t\twhile(!(x&1))x>>=1,j++;\n\t\t\tlen=max(len,j);\n\t\t\tw[j]+=x;cost[j].push_back(x),val[j].push_back(y);\n\t\t}\n\t\tfor(int i=0;i<=len;i++)\n\t\t\tfor(unsigned int j=0;j<cost[i].size();j++)\n\t\t\t\tfor(int k=w[i];k>=cost[i][j];k--)\n\t\t\t\t\tf[i][k]=max(f[i][k],f[i][k-cost[i][j]]+val[i][j]);\n\t\twhile(m>>len)len++;\n\t\tlen--;\n\t\tfor(int i=1;i<=len;i++)\n\t\t{\n\t\t\tw[i]+=(w[i-1]+1)/2;\n\t\t\tfor(int j=w[i];j>=0;j--)\n\t\t\t\tfor(int k=0;k<=j;k++)\t\n\t\t\t\t\tf[i][j]=max(f[i][j],f[i][j-k]+f[i-1][min(w[i-1],(k<<1)|((m>>(i-1))&1))]);\n\t\t}\t\n\t\tprintf(\"%d\\n\",f[len][1]);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1569419939,
        "uid": 145441,
        "name": "nofind",
        "ccfLevel": 6,
        "title": "P3188 [HNOI2007]\u68a6\u5e7b\u5c9b\u5b9d\u73e0(\u80cc\u5305)"
    },
    {
        "content": "[\u6d1b\u8c37\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3188)\n\n### Solution\n\n\u8fd9\u9898\u663e\u7136\u662f $\\operatorname{01}$ \u80cc\u5305\uff0c\u4f46\u662f\u8fd9\u4e2a\u9898\u7684\u6570\u636e\u8303\u56f4\u662f $1\\leq W,w_i,v_i\\leq 2^{30}$ \u3002\n\n\uff1f\uff1f\uff1f\u8fd9\u590d\u6742\u5ea6\u4e0d\u5f97\u4e0a\u5929\uff1f\uff1f\uff1f\n\n\u597d\u5427\uff0c\u6211\u4eec\u53c8\u53ef\u4ee5\u6ce8\u610f\u5230`\u4fdd\u8bc1\u6bcf\u4e2a wi\u90fd\u53ef\u4ee5\u5199\u6210a*2^b\u7684`\uff0c\u90a3\u4e48\u5c31\u5f97\u6765\u70b9\u548c\u4e8c\u8fdb\u5236\u6709\u5173\u7684\u4f18\u5316\u4e86\u3002\n\n\u8bf4\u7684\u5177\u4f53\u70b9\uff0c\u8003\u8651\u5bf9 $2^b$ \u7684\u90a3\u4e2a $b$ \u76f8\u540c\u7684\u7269\u54c1\u8fdb\u884c\u5206\u5c42DP\u3002\n\n\u8bbe $f_{i,j}$ \u8868\u793a\u5269\u4e0b $j\\times 2^i$ \u7684\u4f53\u79ef\u65f6\u80fd\u53d6\u5f97\u7684\u6700\u5927\u4ef7\u503c\uff0c\u90a3\u5bf9\u4e8e\u76f8\u540c\u7684 $i$ \uff0c\u8f6c\u79fb\u548c $01$ \u80cc\u5305\u4e00\u6837\u3002\n\n\u91cd\u70b9\u5728\u4e8e\u600e\u4e48\u8f6c\u79fb $i$ \u5c42\u5230 $i-1$ \u5c42\uff1a\n$$\nf_{i-1,j\\times 2+s_{i-1}}=\\max\\{f_{i-1,j\\times 2+s_{i-1}},f_{i,j}\\}\n$$\n\u5176\u4e2d $s_i$ \u4ee3\u8868 $W$ \u7684\u7b2c $i$ \u4f4d\u662f $0$ \u8fd8\u662f $1$ \u3002\u90a3\u4e48 $f_{i-1,j\\times 2+s_{i-1}}$ \u5c31\u8868\u793a\uff1a\u5f53 $i$ \u5c42\u5269\u4e0b $j\\times 2^i$ \uff0c\u7559\u5230 $i-1$ \u5c42\u5c31\u53d8\u6210\u4e86 $2\\times j\\times 2^{i-1}$ \uff0c\u518d\u52a0\u4e0a\u672c\u6765 $i-1$ \u5c42\u7684 $s_{i-1}$ \u3002\n\n\u6ce8\u610f\uff1a\u56e0\u4e3a $a\\leq 10,n\\leq 100$ \uff0c\u5373 $a\\cdot n\\leq1000$ \uff0c\u6240\u4ee5\u7b2c\u4e8c\u7ef4\u5373 $j$ \u53ef\u4ee5\u5b9a\u4e00\u4e2a\u4e0a\u754c $1000$ \uff08\u597d\u50cf\u80fd\u53d8\u5feb\uff09\n\n### Code\n\n```c++\n#include<cmath>\n#include<cstdio>\n#include<vector>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\n\nusing namespace std;\nconst int N=110;\nint n,m,t,ans,w[N],v[N],f[33][1001],s[35];\nvector<int> vec[35];\n\ninline int read(){\n    int x=0,f=1;\n    char ch=getchar();\n    while(!isdigit(ch)){if(ch=='-') f=-1;ch=getchar();}\n    while(isdigit(ch)){x=x*10+(ch^48);ch=getchar();}\n    return x*f;\n}\n\nint main(){\n\twhile(~scanf(\"%d%d\",&n,&m)&&n!=-1){\n\t\tmemset(f,-0x3f,sizeof(f));\n\t\tmemset(s,0,sizeof(s));\n\t\tmemset(vec,0,sizeof(vec));\n\t\tans=0;\n\t\tfor(int j=0;j<=30;j++)\n\t\t\tif((1<<j)&m) s[j]=1,t=j;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tw[i]=read(); v[i]=read();\n\t\t\tint b=0;\n\t\t\twhile(w[i]%2==0) w[i]/=2,b++;\n\t\t\tvec[b].push_back(i);\n\t\t}\n\t\tfor(int i=t;~i;i--){\n\t\t\tf[i][s[i]]=max(f[i][s[i]],0);\n\t\t\tfor(int k=0;k<vec[i].size();k++){\n\t\t\t\tint x=vec[i][k];\n\t\t\t\tfor(int j=w[x];j<=1000;j++)\n\t\t\t\t\tf[i][j-w[x]]=max(f[i][j-w[x]],f[i][j]+v[x]);\n\t\t\t}\n\t\t\tif(i)\n\t\t\t\tfor(int j=0;j<=1000;j++)\n\t\t\t\t\tf[i-1][min(j*2+s[i-1],1000)]=max(f[i-1][min(1000,j*2+s[i-1])],f[i][j]);\n\t\t\telse\n\t\t\t\tfor(int j=0;j<=1000;j++) ans=max(ans,f[i][j]);\n\t\t}\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1604283553,
        "uid": 272143,
        "name": "\u662f\u4e2a\u6c49\u5b50",
        "ccfLevel": 4,
        "title": "P3188 [HNOI2007]\u68a6\u5e7b\u5c9b\u5b9d\u73e0"
    },
    {
        "content": "- \u9898\u610f: \u4e00\u4e2a\u6700\u5927\u91cd\u91cf\u4e3a$2^{30}$\u7684 01\u80cc\u5305\uff0c\u7269\u54c1\u91cd\u91cf\u53ef\u4ee5\u5206\u89e3\u4e3a$a*2^{b}$\u3002\n\n- \u663e\u7136\uff0c\u66b4\u529b 01\u80cc\u5305 \u662f\u4e0d\u53ef\u884c\u7684\uff0c\u53ea\u670910\u5206\u3002\n\n- \u5c31\u53ea\u80fd\u5229\u7528\u7269\u54c1\u91cd\u91cf\u6027\u8d28\uff1a\n\t1. \u8bbe $f_{i,j}$ \u4e3a \u9009\u4e86$j*2^i$ \u91cd\u91cf\u7684\u6700\u5927\u4ef7\u503c\uff0c\n    \u5b9e\u9645\u4e0a $2^i$ \u4ee5\u4e0b\u7684\u91cd\u91cf\u88ab\u5ffd\u7565\u4e86\u3002\n\t2. \u8003\u8651\u8f6c\u79fb\uff0c\u540c\u4e3a $2^i$ \u91cd\u91cf\u7684\u7269\u54c1\u95f4\u53ef\u4ee5\u76f8\u4e92\u8f6c\u79fb:\n   \u5f53\u524d\u662f\u7b2c$x$\u4e2a\u6570\uff1a\n   $$f_{i,j} = \\max \\{f_{i,j-w_x} + val_x\\}$$\n   \t\n   \u5c31\u662f\u4e00\u822c\u768401\u80cc\u5305\u3002\n   \n   3. \u4e0d\u540c $2^i$ \u91cd\u91cf\u7684\u7269\u54c1\u7684\u8f6c\u79fb\uff1a\n   \n   \u8003\u8651\u4ece $2^{i-1}$ \u548c $2^i$ \u91cd\u91cf\u8f6c\u79fb\uff1a\n   \n   $$f_{i,j} = \\max\\limits_{k=0}^{j} \\{ f_{i-1,k\\ast2 + [m \\& (1 << b - 1)]} +f_{i,j-k}\\}$$\n    \n   - $f_{i-1,k\\ast2 + [m \\& (1 << b - 1)]}$\n   \n   a. \u4ece $j$ \u62ff\u51fa $k \\ast 2^i$ \u7684\u91cd\u91cf\u4e2a\u7ed9 $2^{i-1}$ \u7684\uff0c\n     \n   \u5373 $2\\ast k \\ast 2^{i-1}$ \uff0c\n   \u5f97\u5230\uff1a\n   $$f_{i-1, 2\\ast k}$$\n   \n   b. \u6700\u5927\u4ef7\u503c $W$ \u4e2d\uff0c\u53ef\u80fd\u4f1a\u591a\u51fa\u4e00\u4e2a $2^{i-1}$ \uff0c\n   \n   \u4f8b\u5982: $W = 2^{10} + 2^{9}$ \uff0c \u4ece $2^9$ \u8f6c\u79fb\u5230 $2^{10}$ \u8fd8\u80fd\u591a\u9009\u4e00\u4e2a $2^9$ \n   \u5373 $[W \\& 2^9] = 1 $\n   \n   \u4e5f\u5c31\u662f\uff1a\n   \t$$f_{i - 1, 2 \\ast k + [m \\& (1 << b - 1) ]}$$\n  - $f_{i, j - k}$\n  \n  \u62ff\u51fa $k$ \u540e\u5269\u4e0b $j - k$ \u3002\n  \n \t4. \u6700\u540e\u7b54\u6848\u4e3a $f_{len,1}$ \uff0c $2^{len}$ \u662f\u6700\u5927\u5c0f\u4e8e$W$ \u7684\u3002\n    \n    $f_{len, 1}$ \u5728\u8f6c\u79fb\u4e2d\u4e5f\u7b97\u5165$2^{len}$\u4ee5\u4e0b\u91cd\u91cf\u7684\u7269\u54c1\u7684\u4ef7\u503c\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(T \\ast len \\ast 1000 \\ast 1000)$ \uff0c \u5e38\u6570\u7565\u5927\u3002\n\n\u52a0O2\u624d\u8fc7\u7684\u5783\u573e\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\nconst int MAXN = 2010;\n\nint n, m;\nlong long w;\nlong long ai[MAXN], bi[MAXN], val[MAXN], f[32][1010];\n\nint main(){\n\twhile(cin >> n >> w){\n\t\tif (n == -1 && w == -1) break;\n\t\tmemset(f, 0, sizeof(f));\n\t\tfor(int i = 1; i <= n; i++){\n\t\t\tlong long c;\n\t\t\tcin >> c >> val[i];\n\t\t\tai[i] = (c / (c & (-c)));\n\t\t\tbi[i] = 0;\n\t\t\tfor(c = (c & (-c)) >> 1; c; c >>= 1) bi[i]++;\n\t\t}\n\t\t\n\t\tfor(int i = 1; i <= n; i++)\n\t\t\tfor(int a = 1000; a >= ai[i]; a--)\n\t\t\t\tf[bi[i]][a] = max(f[bi[i]][a], f[bi[i]][a - ai[i]] + val[i]);\t\n\t \n\t\tint len = 0;\n\t\tfor(long long s = w>>1; s; s >>= 1) len++;\n\t\t\n\t\tlong long  ans = 0;\n\t\tfor(int b = 1; b <= len; b++){\n\t\t\tfor(int a = 1000; a >= 0; a--)\n\t\t\t\tfor(int k = 0; k <= a; k++){\n\t\t\t\t\tf[b][a] = max(f[b][a], f[b][a - k] + f[b - 1][min(1000, (k << 1) | ( (w & (1 << (b - 1))) != 0))]);\n\t\t\t\t}\n\t\t}\n\t\t\n\t\tcout << f[len][1] << endl;\n\t\t\n\t}\n\t\n\n\treturn 0;\n}\n```",
        "postTime": 1604063910,
        "uid": 52170,
        "name": "\u9759\u9759\u662f\u4ed6\u7684\uff0c",
        "ccfLevel": 7,
        "title": "[HNOI2007]\u68a6\u5e7b\u5c9b\u5b9d\u73e0"
    },
    {
        "content": "\uff08~~\u611f\u89c9\u8fd9\u79cd\u65b9\u6cd5\u867d\u7136\u53ef\u4ee5\u4f46\u662f\u6bd4\u53e6\u4e00\u7bc7\u9898\u89e3\u7684\u65b9\u6cd5\u8981\u6162\u4e0d\u5c11\u2026\u2026~~\uff09\n\n\u9996\u5148\u6211\u4eec\u8981\u5206\u6790\u7684\u662f\u90a3\u4e2a\u9898\u76ee\u91cc\u4ec5\u6709\u7684\u7279\u6b8a\u6027\u8d28\u2014\u2014$weight_i=a2^b(a<=10)$\uff0c\u5176\u5173\u952e\u5c31\u662f$a<=10$\uff08\u6bd5\u7adf\u662f\u4e2a\u6570\u90fd\u80fd\u5316\u6210$a2^b$\u2026\u2026\uff09\uff0c\u6211\u4eec\u5c1d\u8bd5\u628a\u8fd9\u4e2a\u5d4c\u5165\u80cc\u5305\u72b6\u6001\u91cc\uff0c\u4f46\u662f\u53d1\u73b0\u5e76\u4e0d\u662f\u7279\u522b\u597d\u5904\u7406\u3002\n\n\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u60f3\uff0c\u5982\u679c\u628a\u4e00\u5806\u8fd9\u6837\u7684\u6570\u6c42\u4e2a\u548c\uff0c\u7b54\u6848\u80af\u5b9a\u4e5f\u662f$a'2^{b'}$\u7684\u5f62\u5f0f\uff0c\u5e76\u4e14$b'>=min\\{b_i\\}$\u3002\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u628a\u4e00\u90e8\u5206$b_i$\u6bd4\u8f83\u5927\u7684\u7269\u54c1\u62ff\u51fa\u6765\uff0c\u8ba9\u4ed6\u4eec\u53f3\u79fb\u4e00\u4e9b\u4f4d\uff0c\u6700\u540e\u628a\u603b\u91cd\u91cf\u518d\u5de6\u79fb\u56de\u6765\u3002\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u6211\u73b0\u5728\u67093\u4e2a\u91cd\u91cf\uff0c$5*2^{27}$\uff0c$3*2^{15}$\uff0c$7*2^{20}$\uff0c\u5982\u679c\u76f4\u63a5\u505a\u80cc\u5305\u7684\u8bdd\u6211\u4eec\u9700\u8981\u628a$dp$\u6570\u7ec4\u5f00\u5230\u4ed6\u4eec\u7684\u548c\u4e5f\u5c31\u662f\u5dee\u4e0d\u591a$6e8$\u7684\u7ea7\u522b\u3002\u4f46\u662f\u6211\u4eec\u628a\u4ed6\u4eec\u5de6\u79fb15\u4f4d\u518d\u505a\u80cc\u5305\u7684\u8bdd\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5f00$2e4$\u5c31\u884c\u4e86\uff0c\u663e\u7136\u4ed6\u4eec\u7684\u5b50\u96c6\u548c\u4e00\u5b9a\u662f$2^{15}$\u7684\u500d\u6570\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53d1\u73b0\u8fd9\u662f\u6298\u534a\u641c\u7d22\uff08\u6216\u8005\u5e94\u8be5\u53eb\u6298\u534a\uff1f\uff09\u7684\u5957\u8def\uff0c\u6211\u4eec\u628a\u7269\u54c1\u5206\u4e3a\u4e24\u7c7b\uff0c\u4e00\u7c7b\u662f$b<B$\uff08\u8fd9\u4e2a$B$\u662f\u6211\u4eec\u8bbe\u5b9a\u7684\u4e00\u4e2a\u503c\uff09\u7684\uff0c\u4e00\u7c7b\u662f$b>=B$\u7684\uff0c\u5bf9\u4e8e\u540e\u4e00\u7c7b\u628a\u91cd\u91cf\u53f3\u79fb$B$\u4f4d\u518d\u505a\u80cc\u5305\uff0c\u4e8e\u662f\u8fd9\u4e2a\u590d\u6742\u5ea6\u5c31\u4e0d\u90a3\u4e48\u5927\u4e86\uff0c\u7136\u540e\u6211\u4eec\u679a\u4e3e\u5927\u80cc\u5305\uff08\u5c31\u662f\u8fdb\u884c\u53f3\u79fb\u7684\u90a3\u4e2a\uff09\u7684\u6240\u6709\u91cd\u91cf\uff0c\u7528$w$\u51cf\u53bb\u90a3\u4e2a\u518d\u4ece\u5c0f\u80cc\u5305\u91cc\u627e\u5c31\u884c\u4e86\u3002\u6ce8\u610f\u5982\u679c\u8981\u8fd9\u6837\u505a\u7684\u8bdd\u6211\u4eec\u9700\u8981\u5728\u505a\u5b8c\u80cc\u5305\u4e4b\u540e\u5bf9$dp$\u6570\u7ec4\u53d6\u4e00\u4e2a\u524d\u7f00$max$\uff0c\u8fd9\u6837\u5c31\u8868\u793a\u201c\u91cd\u91cf\u81f3\u591a\u6709\u8fd9\u4e48\u591a\u6700\u591a\u4ef7\u503c\u591a\u5c11\u201d\uff0c\u6bd5\u7adf\u6211\u4eec\u662f\u5bf9\u4e24\u4e2a\u80cc\u5305\u8fdb\u884c\u76f8\u5f53\u4e8e\u5408\u5e76\u7b54\u6848\u4e00\u6837\u7684\u64cd\u4f5c\uff0c\u603b\u82b1\u8d39\u4e0d\u4e00\u5b9a\u8981\u7b49\u4e8e$w$\u3002\n\n\u7136\u540e\u5173\u4e8e\u90a3\u4e2a$B$\u7684\u53d6\u503c\uff0c\u4e00\u822c\u6298\u534a\u7684\u9898\u4f1a\u53d6\u5230$\\frac {30} 2=15$\uff08$2^{30}$\u7684\u6570\u636e\u8303\u56f4\u662f\u6298\u534a\u9898\u91cc\u4e00\u4e2a\u6bd4\u8f83\u5957\u8def\u7684\u6570\u636e\u8303\u56f4\u2026\u2026\u6211\u4e5f\u662f\u56e0\u4e3a\u8fd9\u4e2a\u60f3\u5230\u4e86\u6298\u534a\u2026\u2026\uff09\uff0c\u4f46\u662f\u6211\u4eec\u53d1\u73b0$a<=10$\uff0c$B=15$\u7684\u65f6\u5019\u5c0f\u80cc\u5305\u7684\u6700\u5927\u91cd\u91cf\u548c\u53ef\u80fd\u4f1a\u6bd4\u8f83\u5927\uff0c\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u5927\u80cc\u5305\u7684\u6700\u5927\u91cd\u91cf\u548c\u4e0d\u80fd\u8d85\u8fc7$2^{30-B}$\uff08\u6bd5\u7adf\u6700\u540e\u8fd8\u8981\u4e58\u4e2a$2^B$\uff09\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a$B$\u9002\u5f53\u7684\u8c03\u5c0f\u4e00\u70b9\uff0c\u6211\u53d6\u7684\u662f12\uff0c\u800c\u4e14\u4e5f\u56e0\u4e3a\u8fd9\u4e2a\u539f\u56e0\u5927\u80cc\u5305\u7684\u6700\u5927\u91cd\u91cf\u548c\u5e94\u8be5\u548c$2^{30-B}$\u53d6$min$\u3002\n\n\u4e0a\u4ee3\u7801~\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#define ll long long\nusing namespace std;\nint bw[101],sw[101],bval[101],sval[101];//\u6211\u7684\u4ee3\u7801\u91cc\u52a0b\u7684\u90fd\u662f\u5927\u80cc\u5305\u91cc\u88c5\u7684\uff0cs\u662f\u5c0f\u80cc\u5305\u7684 \nint w[101],val[101];//w\u662f\u91cd\u91cf\uff0cval\u662f\u4ef7\u503c \nunsigned char can1[2000001],can2[2000001];\n//\u6211\u7684\u80cc\u5305\u5199\u7684\u6709\u70b9\u8be1\u5f02\u2026\u2026\u6211\u4e13\u95e8\u52a0\u4e86\u4e2a\u53ef\u884c\u6027dp\u6570\u7ec4\u8868\u793a\u53d6\u8fd9\u4e2a\u91cd\u91cf\u662f\u5426\u53ef\u884c\u2026\u2026\u6b63\u5e38\u4eba\u4e00\u822c\u4e0d\u4f1a\u8fd9\u4e48\u5199\u7684\u2026\u2026 \nll dp1[2000001],dp2[2000001];//dp1\u662f\u5927\u80cc\u5305\uff0cdp2\u662f\u5c0f\u80cc\u5305 \nint main() {\n\twhile(1) {\n\t\tint n,W;\n\t\tcin>>n>>W;\n\t\tif(n==-1)break;\n\t\tmemset(can1,0,sizeof(can1));\n\t\tmemset(can2,0,sizeof(can2));\n\t\tmemset(dp1,0,sizeof(dp1));\n\t\tmemset(dp2,0,sizeof(dp2));//\u8bb0\u5f97\u6e05\u7a7a\u6570\u7ec4\u54e6~ \n\t\tint bsum=0,ssum=0;//\u6700\u5927\u91cd\u91cf\u548c \n\t\tint bptr=1,sptr=1;\n\t\tfor(register int i=1; i<=n; i++) {\n\t\t\tint zl,jz;\n\t\t\tcin>>zl>>jz;\n\t\t\tint tmp=zl,cnt=0;\n\t\t\twhile(!(tmp&1))tmp>>=1,cnt++;//\u8ba1\u7b97\u91cd\u91cf\u7684b \n\t\t\tif(cnt>=12) {//\u88c5\u5165\u5927\u80cc\u5305 \n\t\t\t\tzl>>=12;\n\t\t\t\tbw[bptr]=zl;\n\t\t\t\tbval[bptr]=jz;\n\t\t\t\tbptr++\uff1b \n\t\t\t\tbsum+=zl;\n\t\t\t} else {\n\t\t\t\tssum+=zl;\n\t\t\t\tsw[sptr]=zl;\n\t\t\t\tsval[sptr]=jz;\n\t\t\t\tsptr++;\n\t\t\t}\n\t\t}\n\t\tcan1[0]=can2[0]=1;\n\t\tbsum=min(bsum,262144);\n\t\tfor(register int i=1; i<bptr; i++) {//\u76f4\u63a5\u505a\u80cc\u5305 \n\t\t\tfor(register int j=bsum; j>=bw[i]; j--) {\n\t\t\t\tif(can1[j-bw[i]]) {\n\t\t\t\t\tcan1[j]=1;\n\t\t\t\t\tdp1[j]=max(dp1[j],dp1[j-bw[i]]+bval[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(register int i=1; i<sptr; i++) {\n\t\t\tfor(register int j=ssum; j>=sw[i]; j--) {\n\t\t\t\tif(can2[j-sw[i]]) {\n\t\t\t\t\tcan2[j]=1;\n\t\t\t\t\tdp2[j]=max(dp2[j],dp2[j-sw[i]]+sval[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tll maxn=0;\n\t\tfor(register int i=1; i<=bsum; i++)dp1[i]=max(dp1[i-1],dp1[i]);\n\t\tfor(register int i=1; i<=ssum; i++)dp2[i]=max(dp2[i-1],dp2[i]);//\u53d6\u524d\u7f00max\u4f7f\u5f97\u53ef\u4ee5\u5408\u5e76\u7b54\u6848 \n\t\tfor(register int i=0; i<=bsum; i++) {\n\t\t\tif((i<<12)>W)break;\n\t\t\tmaxn=max(maxn,dp1[i]+dp2[min(ssum,W-(i<<12))]);//\u5bf9\u4e24\u4e2a\u80cc\u5305\u5408\u5e76\u7b54\u6848 \n\t\t}\n\t\tcout<<maxn<<endl;\n\t}\n\treturn(0);\n}\n```",
        "postTime": 1540086584,
        "uid": 125124,
        "name": "ywy_c_asm",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3188 \u3010[HNOI2007]\u68a6\u5e7b\u5c9b\u5b9d\u73e0\u3011"
    },
    {
        "content": "## \u5206\u7ec4\u5904\u7406\u51fa\u6cdb\u5316\u7269\u54c1\n\n\u56e0\u4e3a\u6240\u6709\u7269\u54c1\u7684\u4f53\u79ef\u90fd\u53ef\u4ee5\u8868\u793a\u6210 $a\\times 2^b$ \uff0c\u6240\u6709\u8003\u8651\u6309 $2^b$ \u5c06\u7269\u54c1\u5206\u7ec4\uff0c\u6bcf\u7ec4\u7ec4\u5185\u505a\u4e00\u4e2a $01$ \u80cc\u5305\u4e4b\u540e\u5408\u5e76\u6cdb\u5316\u7269\u54c1\u3002\n\n\u5177\u4f53\u5730\uff1a\u4ee4 $f[i][j]$ \u4e3a\u6240\u6709\u4f53\u79ef\u4e3a $a\\times 2^i$ \u7684\u7269\u54c1\u4e2d\u9009\u51fa**\u4f53\u79ef\u5c0f\u4e8e\u7b49\u4e8e** $j\\times 2^i$ \u7684\u7269\u54c1\u7684\u6700\u5927\u4ef7\u503c\u3002\n\n## \u5229\u7528\u4e8c\u8fdb\u5236\u7684\u6027\u8d28\u5408\u5e76\u6cdb\u5316\u7269\u54c1\n\n\u4e00\u4e2a\u91cd\u8981\u7684\u6027\u8d28\uff1a$\\sum_{j=0}^{i-1}2^j=2^{i}-1$ \uff0c\u5373 $\\sum_{j=0}^{i-1}2^j < 2^i$ \u3002\n\n\u56e0\u6b64\u6211\u4eec\u8003\u8651\u8fd9\u4e48\u8bbe\u8ba1\u72b6\u6001\uff1a \n\n$g[i][j]$ \u4e3a\u8003\u8651\u524d $i$ \u7ec4\u7269\u54c1\uff0c\u4e14\u9009\u51fa\u7684\u7269\u54c1**\u4f53\u79ef\u5c0f\u4e8e\u7b49\u4e8e** $j\\times 2^i+ m \\text{\\&} (1<<(i-1))$ \u7684\u6700\u5927\u4ef7\u503c\u3002\n\n\u8f6c\u79fb\u65f6\u8003\u8651\u7b2c $i$ \u7ec4\u7269\u54c1\u9009\u591a\u5c11\uff1a\n\n$$\ng[i][j]=\\min_k(f[i][j-k]+g[i-1][2\\times k+[m >> (i-1)\\text{\\&}1]])\n$$\n\n\u82e5 $W$ \u7684\u6700\u9ad8\u4f4d\u4e3a $m$ \uff0c\u90a3\u4e48\u7b54\u6848\u5373 $g[m][1]$ \u3002 \n\n\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u8bbe\u8ba1\u72b6\u6001\uff1f\u8fd9\u4e48\u8bbe\u8ba1\u72b6\u6001\u7684\u597d\u5904\u662f\u4ec0\u4e48\uff1f\n\n\u56e0\u4e3a $\\sum_{j=0}^{i-1}2^j < 2^i$ \uff0c\u4e14\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $2^k$ \u5176\u80fd\u8868\u793a\u7684\u4f53\u79ef\u7684\u4e0a\u9650\u4e3a $10n$ \uff0c\u90a3\u4e48\u5bf9\u4e8e $0...i-1$ \u7ec4\u80fd\u8868\u793a\u7684\u4f53\u79ef\u7684\u4e0a\u9650\u4e3a $10n\\sum_{j=0}^{i-1}2^j$ \u5c0f\u4e8e\u7b2c $i$ \u7ec4\u80fd\u8868\u793a\u7684\u7269\u54c1\u7684\u4f53\u79ef\u4e0a\u9650 $10n\\times 2^i$ \u3002\n\n\u5373\uff1a\u524d $i-1$ \u7ec4\u80fd\u8868\u793a\u51fa\u7684\u7269\u54c1\u4f53\u79ef\u4e0a\u9650\u4e0e\u7b2c $i$ \u7ec4\u80fd\u8868\u793a\u51fa\u7684\u4f53\u79ef\u4e0a\u9650\u5728\u6e10\u8fdb\u610f\u4e49\u4e0b\u4e00\u81f4\uff08\u5747\u4e3a $O(an)$ \u7ea7\u522b\uff09\u3002\n\n\u8bbe $W$ \u7684\u4e8c\u8fdb\u5236\u4e00\u5171\u6709 $m$ \u4f4d\uff0c\u90a3\u4e48\u8fd9\u4e48\u53bb $\\text{DP}$ \u5b9e\u9645\u7684\u72b6\u6001\u6570\u4e3a $O(man)$ \u7ea7\u522b\u3002",
        "postTime": 1626318911,
        "uid": 317459,
        "name": "RyexAwl",
        "ccfLevel": 6,
        "title": "P3188 \u6cdb\u5316\u7269\u54c1\u5408\u5e76\u80cc\u5305 \u4e8c\u8fdb\u5236\u8fdb\u4f4d\u5408\u5e76"
    },
    {
        "content": "\u9898\u76ee\u94fe\u63a5\uff1ahttps://www.luogu.com.cn/problem/P3188\r\n\r\n \r\n \r\n\u89e3\u9898\u601d\u8def\uff1a\u8fd9\u9053\u9898\u662f\u4e00\u4e2a\u666e\u901a\u7684 $0/1$ \u80cc\u5305\u6a21\u578b\uff0c\u4f46\u662f\u4f53\u79ef\u548c\u4ef7\u503c\u90fd\u975e\u5e38\u5927\uff0c\u65e0\u6cd5\u7528\u5e38\u89c4\u65b9\u6cd5\u5904\u7406\uff0c\u600e\u4e48\u529e\u5462\uff1f\r\n\r\n\u6ce8\u610f\u5230\u6570\u636e\u8303\u56f4\u4fdd\u8bc1\u4e86\u6bcf\u4e2a\u7269\u54c1\u7684\u4f53\u79ef\u90fd\u53ef\u4ee5\u8868\u793a\u4e3a $w=a*2^b$ \u7684\u5f62\u5f0f\uff0c\u4e14 $a$ \u4e0d\u5927\u4e8e $10$ \uff0c\u8fd9\u63d0\u793a\u6211\u4eec\u53ef\u4ee5\u5148\u4e0d\u8981\u8003\u8651\u8fdb\u4f4d\u95ee\u9898\uff0c\u5728\u6bcf\u4e00\u4f4d\u4e0a\u8fd0\u884c $0/1$ \u80cc\u5305\u6a21\u677f\uff0c\u518d\u5bf9\u7ed3\u679c\u8fdb\u884c\u5408\u5e76\u3002\uff08\u4ee5\u4e0b\u53ef\u8868\u793a\u4e3a $a*2^b$ \u7684\u7269\u54c1\u7b80\u79f0\u4e3a $b$ \u7c7b\u7269\u54c1\uff09\r\n\r\n\u5177\u4f53\u6765\u8bf4\uff0c\u5f00\u4e00\u4e2a\u6570\u7ec4 $g_{i,j}$ \u8868\u793a\u5bf9\u4e8e\u7b2ci\u7c7b\u7269\u54c1\uff0c\u7ed9\u5b83 $j*2^i$ \u7684\u4f53\u79ef\uff0c\u8fd9\u7c7b\u7269\u54c1\u4e2d\u80fd\u9009\u5230\u7684\u6700\u5927\u4ef7\u503c\uff0c\u8fd9\u6837\u7684\u8bdd\u7c7b\u4e0e\u7c7b\u4e4b\u95f4\u662f\u5b8c\u5168\u6ca1\u6709\u5173\u7cfb\u7684\uff0c\u5728 $a$ \u4e0d\u5927\u4e8e $10$ \u7684\u9650\u5236\u4e0b\uff0c\u6bcf\u4e00\u7c7b\u7269\u54c1\u7684\u6700\u5927\u80cc\u5305\u4f53\u79ef\u81f3\u591a\u679a\u4e3e\u5230 $10*n$ \u5373\u53ef\u3002\u6709\u4eba\u53ef\u80fd\u4f1a\u8bf4\uff0c\u5e94\u8be5\u662f $10*cnt_i$ \uff0c\u4f46\u6211\u4eec\u4e3a\u4e86\u5408\u5e76\u8d77\u6765\u65b9\u4fbf\uff0c\u5c31\u76f4\u63a5\u505a\u5230 $10*n$ \uff0c\u8fd9\u6837\u6b63\u786e\u6027\u662f\u4e0d\u4f1a\u6709\u95ee\u9898\u7684\uff0c\u800c\u65f6\u9650\u53c8\u5bbd\u677e\uff0c\u6211\u4eec\u80af\u5b9a\u8981\u9009\u62e9\u4fdd\u9669\uff0c\u65b9\u4fbf\u7684dp\u65b9\u5f0f\u3002\r\n\r\n\u63a5\u4e0b\u6765\u7684\u96be\u70b9\u5c31\u5728\u4e8e\u5408\u5e76\u7684\u95ee\u9898\u3002\u6211\u89c9\u5f97\u8fd9\u9053\u9898\u80fd\u8bc4\u7d2b\u8272\u7684\u539f\u56e0\u5c31\u5728\u8fd9\u91cc\uff0c\u72b6\u6001\u5e76\u4e0d\u597d\u60f3\uff01\u5728 $NOIP$ $2021$ \u6570\u5217 \u7684\u542f\u53d1\u4e0b\uff08~~\u65f6\u95f4\u8f74\u9519\u4e71~~\uff09\uff0c\u6211\u4eec\u53d1\u73b0\u5bf9\u4e8e\u4f4d\u6743\uff08\u5373 $2^x$ \u4e2d\u7684\u90a3\u4e2a $x$ \uff0c\u6216\u8005\u5c31\u662f\u67d0\u4e2a\u7269\u54c1\u7684\u7c7b\uff09\u8f83\u5927\u7684\u7269\u54c1\u6765\u8bf4\uff0c\u5982\u679c\u6211\u4eec\u5df2\u7ecf\u8003\u8651\u597d\u4e86\u4f4d\u6743\u5c0f\u7684\u7269\u54c1\u7684\u9009\u53d6\u65b9\u5f0f\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8f83\u5927\u7684\u7269\u54c1\uff0c\u4e0d\u7ba1\u662f\u5426\u9009\u53d6\uff0c\u662f\u4e0d\u4f1a\u5f71\u54cd\u5230\u5df2\u9009\u4f53\u79ef\u5728\u8f83\u4f4e\u4f4d\u7684\u6570\u503c\u7684\u3002\u4e8e\u662f\uff0c\u6211\u4eec\u4ece\u5c0f\u5230\u5927\u8003\u8651\uff0c\u8fd9\u6837\u7684\u8bdd\u4e00\u822c\u7b2c\u4e00\u65f6\u95f4\u60f3\u5230\u7684\u601d\u8def\u662f\uff1a\u8bbe $f_{i,j}$ \u8868\u793a\u5bf9\u4e8e\u524d $i$ \u7c7b\u7269\u54c1\uff0c\u7ed9\u5b83\u4eec $j*2^i$ \u7684\u4f53\u79ef\uff0c\u8fd9\u4e9b\u7c7b\u7269\u54c1\u4e2d\u80fd\u9009\u5230\u7684\u6700\u5927\u4ef7\u503c\u3002\u770b\u4e0a\u53bb\u968f\u4fbf\u8f6c\u79fb\u4e00\u4e0b\u5c31\u505a\u5b8c\u4e86\u662f\u4e0d\u662f\uff1f\r\n\r\n\u4f60\u597d\uff0c\u5047\u4e86\uff01\u539f\u56e0\u5728\u4e8e\uff0c\u867d\u7136\u7269\u54c1\u7684\u4ef7\u503c\u6709 $a$ \u4e0d\u5927\u4e8e $10$ \u7684\u4fdd\u8bc1\uff0c\u4f46\u662f\u80cc\u5305\u5927\u5c0f $W$ \u53ef\u6ca1\u6709\uff01\u7136\u540e\uff0c\u4f60\u5c31\u4f1a\u60ca\u559c\u5730\u53d1\u73b0\uff0c\u524d\u529f\u5c3d\u5f03\u5566\uff01\u53ea\u6709\u66b4\u529b\u5206\uff01\u600e\u4e48\u89e3\u51b3\uff1f\r\n\r\n\u4e00\u4e2a\u5173\u952e\u7684\u8d2a\u5fc3\u601d\u60f3\u5c31\u662f\uff1a\u5f53\u53ef\u9009\u7269\u54c1\u96c6\u5408\u4e00\u5b9a\u65f6\uff0c\u80cc\u5305\u4f53\u79ef\u53d8\u5927\u4e00\u5b9a\u4e0d\u4f1a\u4f7f\u7ed3\u679c\u66f4\u52a3\u3002\u5176\u5b9e\u5982\u679c $0/1$ \u80cc\u5305\u5b66\u7684\u597d\u7684\u8bdd\uff0c\u5c3d\u7ba1\u6ca1\u6709\u76f4\u63a5\u4f53\u73b0\uff0c\u4f46\u5728\u8f6c\u79fb\u7684\u8fc7\u7a0b\u4e2d\u4e5f\u9690\u542b\u4e86\u8fd9\u4e00\u601d\u60f3\uff08\u5efa\u8bae\u8bfb\u5230\u8fd9\u91cc\u4ed4\u7ec6\u60f3\u4e00\u60f3\uff09\u3002\u800c\u6211\u4eec\u4e4b\u524d\u7684\u201c\u5982\u679c\u6211\u4eec\u5df2\u7ecf\u8003\u8651\u597d\u4e86\u4f4d\u6743\u5c0f\u7684\u7269\u54c1\u7684\u9009\u53d6\u65b9\u5f0f\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8f83\u5927\u7684\u7269\u54c1\uff0c\u4e0d\u7ba1\u662f\u5426\u9009\u53d6\uff0c\u662f\u4e0d\u4f1a\u5f71\u54cd\u5230\u5df2\u9009\u4f53\u79ef\u5728\u8f83\u4f4e\u4f4d\u7684\u6570\u503c\u7684\u201d\u8fd9\u4e2a\u601d\u8def\u662f\u5b8c\u5168\u6b63\u786e\u7684\uff0c\u66f4\u8fdb\u4e00\u6b65\u5730\uff0c\u65e2\u7136\u8f83\u4f4e\u4f4d\u4f53\u79ef\u4e0d\u518d\u4f1a\u53d7\u5230\u4ee5\u540e\u7684\u7269\u54c1\u7684\u9009\u53d6\u7684\u5f71\u54cd\uff0c\u90a3\u4e48\u6211\u4eec\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u628a\u8fd9\u4e00\u90e8\u5206\u4f53\u79ef\u5f00\u5230\u6700\u5927\u5462\uff1f\uff01\u8fd9\u6837\u7684\u8bdd\uff0c\u5bf9\u4e8e\u7b2c $i$ \u4f4d\u4f53\u79ef\u7684\u8003\u8651\uff0c\u5373\u7b2c $i$ \u7c7b\u7269\u54c1\u7684\u9009\u53d6\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8bb0\u5f55\u5b83\u5f80\u524d\u8fdb\u4f4d\u7684\u8d21\u732e\uff0c\u800c\u5728\u5b83\u540e\u9762\u7684\u90a3 $i-1$ \u4f4d\uff0c\u76f4\u63a5\u5047\u5b9a\u548c $W$ \u7684\u6700\u540e $i-1$ \u4f4d\u76f8\u540c\u5c31\u53ef\u4ee5\u4e86\u3002\r\n\r\n\u8bbe $f_{i,j}$ \u8868\u793a\u5bf9\u4e8e\u524d $i$ \u7c7b\u7269\u54c1\uff0c\u7ed9 \u5b83\u4eec $j*2^i+(W\\operatorname{and}((1<<j)-1))$  \u7684\u4f53\u79ef\uff0c\u8fd9\u4e9b\u7c7b\u7269\u54c1\u4e2d\u80fd\u9009\u5230\u7684\u6700\u5927\u4ef7\u503c\u3002\u521d\u59cb\u5316  $f_{0,0}=g_{0,0},f_{0,i}=max(f_{0,i-1},g_{0,i}),i \\in N^*$ \uff1b\r\n\r\n\u5bf9\u4e8e\u4efb\u610f\u6b63\u6574\u6570 $i$ \u548c\u975e\u8d1f\u6574\u6570 $j$ \uff0c\u679a\u4e3e\u4e0d\u5927\u4e8e $j$ \u7684\u975e\u8d1f\u6574\u6570 $k$ \uff0c\u8868\u793a\u5728\u7b2c $i$ \u4f4d\u4f53\u79ef\u4e0a\uff0c\u5f80\u4f4e\u4f4d\u7269\u54c1\u8ba9\u4e86 $k*2^i$ \u7684\u4f53\u79ef\u3002\u5219\u6709\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\r\n $f_{i,j}=max(f_{i,j},f_{i-1,min(10*n,2*k+(W>>(i-1))\\operatorname{and} 1)}+g_{i,j-k})$  \r\n\r\n $AC$ \u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a\r\n\r\n```cpp\r\n#include <bits/stdc++.h>\r\nusing namespace std;\r\nlong long n,W,w[105],v[105];\r\nlong long g[55][1005],f[55][1005];\r\nlong long th[35][105],cnt[35];\r\nlong long dp[35][1005];\r\nint main(){\r\n\twhile(scanf(\"%lld%lld\",&n,&W)!=EOF){\r\n\t\tif(n==-1&&W==-1) break;\r\n\t\tmemset(cnt,0,sizeof cnt);\r\n\t\tmemset(g,0,sizeof g),memset(f,0,sizeof f);\r\n\t\tfor(long long i=1;i<=n;++i) scanf(\"%lld%lld\",&w[i],&v[i]);\r\n\t\tfor(long long i=1;i<=n;++i){\r\n\t\t\tlong long nw=0;\r\n\t\t\twhile((!(w[i]&1))&&nw<30) ++nw,w[i]>>=1;\r\n\t\t\tth[nw][++cnt[nw]]=i;\r\n\t\t}\r\n\t\tfor(long long i=0;i<=31;++i){\r\n\t\t\tmemset(dp,0,sizeof dp);\r\n\t\t\tfor(long long j=1;j<=cnt[i];++j)\r\n\t\t\t\tfor(long long k=1;k<=n*10;++k)\r\n\t\t\t\t\tif(k>=w[th[i][j]]) \r\n\t\t\t\t\t\tdp[j][k]=max(dp[j-1][k],\r\n\t\t\t\t\t\tdp[j-1][k-w[th[i][j]]]+v[th[i][j]]);\r\n\t\t\t\t\telse dp[j][k]=dp[j-1][k];\r\n\t\t\tfor(long long j=0;j<=n*10;++j)\r\n\t\t\t\tg[i][j]=dp[cnt[i]][j];\r\n\t\t}\r\n\t\tf[0][0]=g[0][0];\r\n\t\tfor(long long j=1;j<=1000;++j) f[0][j]=max(f[0][j-1],g[0][j]);\r\n\t\tfor(long long i=1;i<=31;++i)\r\n\t\t\tfor(long long j=0;j<=10*n;++j)\r\n\t\t\t\tfor(long long k=0;k<=j;++k)\r\n\t\t\t\t\tf[i][j]=max(f[i][j],g[i][j-k]+f[i-1][min(10*n,2*k+((W>>(i-1))&1))]);\r\n\t\tlong long now=0;\r\n\t\twhile((1<<now)<=W) ++now;--now;\r\n\t\tcout<<f[now][1]<<endl;\r\n\t} \r\n\treturn 0;\r\n}\r\n```\r\n\r\n ",
        "postTime": 1646822529,
        "uid": 131591,
        "name": "\u849f\u84bb\u541bHJT",
        "ccfLevel": 7,
        "title": "P3188 [HNOI2007]\u68a6\u5e7b\u5c9b\u5b9d\u73e0 \u9898\u89e3"
    },
    {
        "content": "\u89c2\u5bdf\u9898\u610f\uff0c\u6709\u4e00\u4e2a\u5f88\u7279\u6b8a\u7684\u5730\u65b9\uff0c\u5373\u4fdd\u8bc1\u6bcf\u4e2a $w_i$ \u80fd\u5199\u6210 $a\\times 2^b \\space (a,b \\in \\mathbb N)$ \u7684\u5f62\u5f0f\u3002\u6240\u4ee5\u6211\u4eec\u8003\u8651\u4ece\u9ad8\u5230\u4f4e\u679a\u4e3e $b$\uff0c\u5bf9\u76f8\u540c\u7684 $b$ \u505a\u4e00\u6b21\u666e\u901a\u80cc\u5305\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u5982\u4f55\u5408\u5e76\u3002\n\n\u8bbe $f[i][j]$ \u8868\u793a\u5f53\u524d\u5904\u7406\u5230\u7b2c $i$ \u4f4d\uff0c\u5728 **\u6a21 $2^i$** \u610f\u4e49\u4e0b **\u7a7a\u4f59**\u7a7a\u95f4\u4e3a $j$ \u7684\u6700\u5927\u4ef7\u503c\u3002\n\n\u5f53\u524d\u4f4d\u7684\u8f6c\u79fb\u4e3a $f[i][j] = \\max(f[i][j], f[i][j + w[k]] + v[k])$\u3002\n\n\u4ece\u9ad8\u4f4d\u8f6c\u79fb\u5230\u4f4e\u4f4d\u4e3a $f[i][j] = \\max(f[i][j], f[i + 1][\\min(j \\times 2 + ((W >> i) \\& 1, 10 \\times n)]$\u3002\n\n\u8003\u8651\u6700\u540e\u4e3a\u4ec0\u4e48\u8981\u4e0e $10 \\times n$ \u53d6 min\u3002\u539f\u56e0\u662f\u6211\u4eec\u53d1\u73b0\u5f53\u524d\u4f4d\u7684 $a \\leq 10$\uff0c\u6240\u4ee5\u5f53\u524d\u4f4d\u6240\u5360\u7a7a\u95f4\u6700\u5927\u4e3a $10 \\times n$\u3002\u8fd9\u6837\u5c31\u80fd\u8fbe\u5230\u51cf\u5c0f\u590d\u6742\u5ea6\u7684\u76ee\u7684\u3002\n\n\u7531\u4e8e\u4e60\u60ef\u95ee\u9898\uff0c\u4ee3\u7801\u4e2d $v_i$ \u8868\u793a\u4f53\u79ef\uff0c$w_i$ \u8868\u793a\u4ef7\u503c\uff0c$m$ \u8868\u793a\u80cc\u5305\u7a7a\u95f4\u3002\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\nusing namespace std;\n\nint n, m;\nint f[31][2005];\n\nstruct date {\n\tint w, v;\n}a[105];\n\ninline int lowbit(int x) { return x & -x; }\n\ninline bool cmp(date x, date y) { return lowbit(x.v) > lowbit(y.v); }\n\ninline void getmax(int &x, int y) { if(y > x) x = y; }\n\nint main() {\n\twhile(1) {\n\t\tscanf(\"%d%d\",&n, &m);\n\t\tif(n == -1 && m == -1) break;\n\t\tfor(int i = 1; i <= n; i++) scanf(\"%d%d\",&a[i].v, &a[i].w);\n\t\tsort(a + 1, a + n + 1, cmp);\n\t\tmemset(f, 0, sizeof(f));\n\t\tint cnt = 1, lim = 0;\n\t\t// lim \u4e3a m \u5728\u5f53\u524d\u4f4d\u6240\u80fd\u53d6\u5230\u7684\u6700\u5927\u7a7a\u95f4 \n\t\tfor(int pos = 30; pos >= 0; pos--) {\n\t\t\tif((1 << pos) > m) continue;\n\t\t\tlim = min(10 * n, 2 * lim + ((m >> pos) & 1));\n\t\t\twhile(cnt <= n && lowbit(a[cnt].v) == (1 << pos)) {\n\t\t\t\tfor(int i = 0; i + a[cnt].v / (1 << pos) <= lim; i++)\n\t\t\t\t f[pos][i] = max(f[pos][i], f[pos][i + a[cnt].v / (1 << pos)] + a[cnt].w);\n\t\t\t\t++cnt;\n\t\t\t}\n\t\t\tif(pos == 0) continue;\n\t\t\tfor(int i = 0; i <= lim; i++)\n\t\t\t getmax(f[pos - 1][min(2 * i + ((m >> (pos - 1)) & 1), 10 * n)], f[pos][i]);\n\t\t}\n\t\tint res = 0;\n\t\tfor(int i = 0; i <= lim; i++) getmax(res, f[0][i]);\n\t\tprintf(\"%d\\n\",res);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1629377844,
        "uid": 304556,
        "name": "zym417",
        "ccfLevel": 7,
        "title": "P3188"
    },
    {
        "content": "## \u9898\u610f\n\n\u7ed9\u5b9a $n$ \u9897\u5b9d\u77f3\uff0c\u6bcf\u9897\u5b9d\u77f3\u90fd\u6709\u91cd\u91cf\u548c\u4ef7\u503c\u3002\u8981\u4f60\u4ece\u8fd9\u4e9b\u5b9d\u77f3\u4e2d\u9009\u53d6\u4e00\u4e9b\u5b9d\u77f3\uff0c\u4fdd\u8bc1\u603b\u91cd\u91cf\u4e0d\u8d85\u8fc7 $W$\uff0c\u4e14\u603b\u4ef7\u503c\u6700\u5927\uff0c\u5e76\u8f93\u51fa\u6700\u5927\u7684\u603b\u4ef7\u503c\u3002\n\n#### \u6570\u636e\u8303\u56f4\n\n$1 \\leq n \\leq 100,1 \\leq W,w_i,v_i,\\leq 2^{30}$\u3002\n\n**\u4fdd\u8bc1\u6bcf\u4e2a $w_i$ \u80fd\u5199\u6210 $a \\times 2^b\\space (a,b \\in \\mathbb N)$\n \u7684\u5f62\u5f0f\uff0c$a \\leq 10$\uff0c$b \\leq 30$**\n \n### \u601d\u8def\n\n\u521d\u770b\u672c\u9898\u5c31\u662f\u4e00\u4e2a 01 \u80cc\u5305\u7684\u6a21\u677f\u9898\uff0c\u4f46\u662f $W \\leq 2^{30}$ \u51b3\u5b9a\u4e86\u4e0d\u80fd\u76f4\u63a5\u7528\u6734\u7d20\u7684 $O(nW)$ \u65b9\u6cd5\u505a\u3002\n\n\u6ce8\u610f\u5230 $w_i$ \u6ee1\u8db3\u4e00\u4e2a\u6027\u8d28\uff1a$a \\times 2^b\\space (a,b \\in \\mathbb N),a \\leq 10,b \\leq 30$\u3002\u5176\u5b9e\u6bcf\u4e2a\u5341\u8fdb\u5236\u6570\u90fd\u53ef\u4ee5\u8868\u793a\u6210 $a \\times 2^b$ \u7684\u5f62\u5f0f\uff08~~\u4f8b\u5982 $114514=114514 \\times 2^0$~~\uff09\u3002\u56e0\u4e3a\u5341\u8fdb\u5236\u6570\u548c\u4e8c\u8fdb\u5236\u6570\u4e00\u4e00\u5bf9\u5e94\u3002\u6240\u4ee5\u672c\u9898\u7684\u5173\u952e\u70b9\u5728\u4e8e $a \\leq 10$\u3002\u8fd9\u51b3\u5b9a\u4e86\u53ef\u4ee5\u8003\u8651\u5c06\u6240\u6709\u7684\u7269\u54c1\u6309\u7167 $b$ \u7684\u5927\u5c0f\u5206\u7ec4\u3002\u6bcf\u4e2a\u7269\u54c1\u7684\u4f53\u79ef\u5c31\u53ef\u4ee5\u8f6c\u5316\u4e3a $a$\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u8282\u7701\u5927\u91cf\u7684\u7a7a\u95f4\u548c\u65f6\u95f4\u3002\n\n\u8bbe $g[i][j]$ \u8868\u793a\u5728 $b=i$ \u8fd9\u4e00\u7ec4\u4e2d\u9009\u53d6 $j$ \u4f53\u79ef\u7269\u54c1\u7684\u6700\u5927\u4ef7\u503c\u3002\u663e\u7136\uff0c\u53ea\u9700\u8981\u5728\u6bcf\u4e00\u7ec4\u5185\u90e8\u505a\u4e00\u6b21 01 \u80cc\u5305\u5373\u53ef\u3002\n\n\u7136\u800c\uff0c$W$ **\u5e76\u4e0d\u6ee1\u8db3** $w_i$ \u7684\u6027\u8d28\uff0c\u8fd9\u5c31\u51b3\u5b9a\u4e86\u53ea\u6709 $g$ \u6570\u7ec4\u5e76\u4e0d\u80fd\u5f97\u5230\u7b54\u6848\u3002\n\n\u9700\u8981\u53e6\u5916\u518d\u5f00\u4e00\u4e2a $f$ \u6570\u7ec4\u8f6c\u79fb\u7b54\u6848\u3002\n\n\u8003\u8651 $f$ \u7684\u72b6\u6001\u5982\u4f55\u8bbe\u8ba1\u3002\u663e\u7136\u6839\u636e $w_i$ \u7684\u6027\u8d28\uff0c\u9700\u8981\u6709\u4e00\u4e2a\u7ef4\u5ea6 $i$ \u6765\u8868\u793a\u76ee\u524d\u679a\u4e3e\u5230 $b=i$ \u8fd9\u4e00\u7ec4 $w$\uff0c\u8fd8\u9700\u8981\u53e6\u5916\u4e00\u4e2a\u7ef4\u5ea6 $j$ \u8868\u793a\u5728\u8fd9\u4e00\u7ec4\u4e2d\u9009\u53d6\u4e86\u4f53\u79ef\u4e3a $j$ \u7684\u7269\u54c1\u3002\u540c\u65f6\u8981\u4fdd\u8bc1\u4f53\u79ef\u4e0d\u80fd\u8d85\u8fc7 $W$\u3002\u600e\u4e48\u5b9e\u73b0\u5462\uff1f\u5047\u8bbe\u5f53\u524d\u5df2\u7ecf\u586b\u5230\u4e86 $W$ \u5728\u4e8c\u8fdb\u5236\u8868\u793a\u4e0b\u7684\u6700\u9ad8\u4f4d $k$ \u90a3\u4e00\u7ec4\uff0c\u663e\u7136\u8f93\u51fa\u7b54\u6848\u65f6\uff0c$i=1$\u3002\u90a3\u4e48\u5c31\u8981\u4fdd\u8bc1\u540e\u9762\u4f4d\u6570\u4e0a\u586b\u7684\u6570\u4e0d\u8d85\u8fc7  $W$ \u4e8c\u8fdb\u5236\u7b2c $k$ \u4f4d\u4ee5\u4e0b\u7684\u4f53\u79ef\u3002\u5206\u6790\u5230\u8fd9\u91cc\uff0c\u72b6\u6001\u5c31\u5f88\u5f88\u6e05\u695a\u4e86\u3002\n\n\u8bbe $f[i][j]$ \u8868\u793a\u5728 $0 \\sim i$ \u7ec4\u4e00\u5171\u9009\u53d6\u4e86 $2^j$  \u52a0\u4e0a $W$ \u4e8c\u8fdb\u5236\u7b2c $i$ \u4f4d\u4ee5\u4e0b\u7684\u4f53\u79ef\u7684**\u539f\u59cb\u4f53\u79ef**\u7684\u6700\u5c0f\u82b1\u8d39\u3002\n\n\u663e\u7136\uff0c\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e0d\u53ef\u80fd\u53ea\u662f\u7b80\u5355\u7684 \n\n$f[i][j]=\\max(f[i-1][j-k]+g[i][k])$\u3002\n\n$k$ \u8868\u793a\u5728\u7b2c $i$ \u7ec4\u9009\u53d6\u4f53\u79ef\u4e3a $w$ \u7684\u7269\u54c1\uff08\u8fd9\u4e00\u53e5\u7684\u4f53\u79ef\u90fd\u6307\u5206\u7ec4\u540e\u7684\u4f53\u79ef\uff09\uff0c\u6ce8\u610f\u5230\u5728\u7b2c $i$ \u7ec4\u9009\u53d6\u4f53\u79ef\u4e3a $j-k$ \u7684\u7269\u54c1\uff0c\u5c31\u7b49\u4ef7\u4e8e\u5728\u7b2c $i-1$ \u7ec4\u9009\u53d6\u4f53\u79ef\u4e3a $(j-k)*2$ \u7684\u7269\u54c1\u3002\u6839\u636e\u8bbe\u8ba1\u7684\u72b6\u6001\uff0c$j*2^i$ \u7684\u539f\u59cb\u4f53\u79ef(\u4e0b\u9762\u90fd\u6307\u539f\u59cb\u4f53\u79ef)\u5c31\u7531 $k*2^i$ \u548c $2*(j-k)*2^{i-1}$ \u8d21\u732e\u3002\u800c $W$ \u4e8c\u8fdb\u5236\u7b2c $i$ \u4f4d\u4ee5\u4e0b\u7684\u4f53\u79ef\u5c31\u8981\u7531\u539f\u6765\u7684\u72b6\u6001\u8d21\u732e\u3002\u4e8e\u662f\u5c31\u53ef\u4ee5\u5f97\u5230\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$f[i][j]=\\max(f[i-1][(j-k)*2+(W>>(i-1) \\And 1)]+g[i][k])$\u3002\n\n\u6700\u540e\uff0c\u672c\u9898\u8981\u591a\u6d4b\uff0c\u522b\u5fd8\u4e86\u6e05\u7a7a\u6570\u7ec4\u3002\n\n## code\uff1a\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<vector>\nusing namespace std;\nconst int N=50;\nconst int M=5020;\n#define int long long\nint g[N][M],S,f[N][M],n,W;\nvector<int>v[N],w[N];\nint max(int a,int b){return a>b?a:b;}\nvoid init()\n{\n\tS=0;\n\tfor(int i=0;i<N;i++) v[i].clear(),w[i].clear();\n\tmemset(f,0,sizeof(f));\n\tmemset(g,0,sizeof(g));\n}\nsigned main()\n{\n//\tfreopen(\"233.in\",\"r\",stdin);\n\twhile(scanf(\"%lld%lld\",&n,&W))\n\t{\n\t\tif(n==-1&&W==-1) break;\n\t\tinit();\n\t\tfor(int tw,tv,i=1;i<=n;i++)\n\t\t{\n\t\t\tscanf(\"%lld%lld\",&tw,&tv);\n\t\t\tint ws=0;\n\t\t\twhile(((tw>>ws)&1)==0) ws++;\n//\t\t\tprintf(\"%lld %lld\\n\",ws,tw>>ws);\n\t\t\tv[ws].push_back(tv);\n\t\t\tw[ws].push_back(tw>>ws);\n\t\t}\n\t\twhile((W>>S)) S++;\n\t\tfor(int i=0;i<S;i++)\n\t\t{\n\t\t\tif(w[i].size()==0) continue;\n\t\t\tfor(int j=0;j<w[i].size();j++)\n\t\t\t\tfor(int k=520;k>=w[i][j];k--)\n\t\t\t\t\tg[i][k]=max(g[i][k],g[i][k-w[i][j]]+v[i][j]);\n\t\t} \n\t\tfor(int i=0;i<S;i++)\n\t\t    for(int j=520;j>=0;j--)\n\t\t        for(int k=0;k<=j;k++)\n\t\t            f[i][j]=max(f[i][j],g[i][k]+f[i-1][(j-k)*2+((W>>(i-1))&1)]);\n\t\tprintf(\"%lld\\n\",f[S-1][1]);\n\t}\n\treturn 0;\n}\n/*\n4 10\n8 9\n5 8\n4 6\n2 5\n*/\n```\n",
        "postTime": 1627645874,
        "uid": 288192,
        "name": "ListenSnow",
        "ccfLevel": 7,
        "title": "P3188 [HNOI2007]\u68a6\u5e7b\u5c9b\u5b9d\u73e0"
    },
    {
        "content": "[\u5706\u9898\u94fe\u63a5](https://www.luogu.com.cn/problem/P3188)\n### 01\u80cc\u5305\u51b2\u9e2d\uff01\uff01\uff01\n\u597d\u5427\u4ed6\u6b7b\u4e86\uff0c\u8003\u8651\u6bcf\u4e00\u4e2a\u7269\u54c1\u4f53\u79ef\u90fd\u4e3a$b*2^a$\u5c1d\u8bd5\u8fdb\u5236\u4f18\u5316\\\n\u9996\u5148\u8bbe\u80cc\u5305\u5927\u5c0f\u4e3a$m$\\\n\u8bbe$f_{i,j}$\u4e3a\u80cc\u5305\u5927\u5c0f\u6700\u9ad8\u4f4d\u4e3a$j*2^i$\u65f6\u6700\u5927\u4ef7\u503c\\\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u8bbe\u73b0\u5728\u8003\u8651\u7684\u7269\u54c1\u7f16\u53f7\u4e3a$k$\uff0c\u5219\u80cc\u5305\u5927\u5c0f\u4e3a$j*2^i$+$($$w_k$&$((1<<i)-1)))$\\\n\u539f\u6765\u6211\u4eec\u662f\u679a\u4e3e\u6574\u4e2a\u80cc\u5305\u5927\u5c0f\uff0c\u800c\u73b0\u5728\u6211\u4eec\u4e0d\u518d\u8003\u8651\u4f4e\u4e8e\u7b2c$i$\u4f4d\u7684\u786e\u5207\u6570\u503c\\\n\u6bd4\u5982\u5f53$w_k=1001$\uff0c$i=5,j=1$\uff0c\u80cc\u5305\u5927\u5c0f\u4e3a$11001$\uff08\u4ee5\u4e0a\u5747\u4e3a\u4e8c\u8fdb\u5236\uff09\\\n\u8f6c\u79fb\u5219\u4e3a$f_{i,j}=max(f_{i,j},f_{i,j-d}+f{i-1,2*d|((m>>(i-1))-1)})$\\\n\u5c31\u662f\u8bf4\u8003\u8651\u4ece$i-1$\u5904\u8f6c\u79fb\u8fc7\u6765$2^i*d$\u5927\u5c0f\u7684\u4f53\u79ef\uff0c\u7531\u4e8e$i$\u51cf\u4e86$1$\uff0c$d$\u76f8\u5e94\u8981\u4e58$2$\\\n\u5c31\u662f$f_{i-1,2*d}$\uff0c\u8003\u8651\u80cc\u5305\u81ea\u8eab\u4e0a\u9650\uff0c\u8fd8\u53ef\u4ee5\u52a0\u4e0a\u4e00\u4e2a$2*d+((m>>(i-1))-1$\n```\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#define ll long long\nusing namespace std;\nconst ll N=1005;\nll n,m,f[35][N],a[N],b[N],top;\n\nint main(){\n\tscanf(\"%lld%lld\",&n,&m);\n\twhile(n!=-1&&m!=-1){\n\t\ttop=0;\n\t\tmemset(f,0,sizeof f);\n\t\tfor(ll i=1;i<=n;i++){\n\t\t\tll cnt=0,x;\n\t\t\tscanf(\"%lld%lld\",&a[i],&b[i]),x=a[i];\n\t\t\twhile(x%2==0){x/=2,cnt++;}\n\t\t\tfor(ll j=1000;j>=x;j--){\n\t\t\t\tf[cnt][j]=max(f[cnt][j],f[cnt][j-x]+b[i]);\n\t\t\t}\n\t\t}\n\t\tfor(ll i=m;i>0;i/=2)top++;\n\t\ttop--;\n\t\tfor(ll i=1;i<=top;i++){\n\t\t\tfor(ll j=1000;j>=0;j--){\n\t\t\t\tfor(ll k=0;k<=j;k++){\n\t\t\t\t\tf[i][j]=max(f[i][j],f[i][j-k]+f[i-1][min(1000*1ll,(k*2)|((m>>(i-1))&1))]);\n\t\t\t\t}\n\t\t\t}\n\t\t} \n\t\tprintf(\"%lld\\n\",f[top][1]);\n\t\tscanf(\"%lld%lld\",&n,&m); \n\t}\n}\n```\n\u4ee3\u7801\u6bd4\u8f83\u61a8\uff0c\u8bf7\u89c1\u8c05",
        "postTime": 1602948757,
        "uid": 251882,
        "name": "\u849f\u84bb\u4e01",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3188 \u3010[HNOI2007]\u68a6\u5e7b\u5c9b\u5b9d\u73e0\u3011"
    },
    {
        "content": "\u7531\u4e8e $w_i=a\\times 2^b$\uff0c\u6240\u4ee5\u6309 $b$ \u5206\u7ec4\uff0c\u7b2c $k$ \u7ec4\u4e3a\u6ee1\u8db3 $w_i=a\\times 2^k,a\\leq 10$ \u7684 $(w_i,v_i)$\u3002\n\n\u53d1\u73b0\u7ec4\u5185\u53bb\u6389 $2^k$ \u505a 01 \u80cc\u5305\u662f\u4e00\u4ef6\u5f88\u5bb9\u6613\u7684\u4e8b\uff0c\u8bb0 $f_{i,j}$ \u8868\u793a\u7b2c $i$ \u7ec4\u5728\u5bb9\u91cf\u4e3a $j$ \u7684\u60c5\u51b5\u4e0b\u7684\u6700\u5927\u4ef7\u503c\u3002\u8f6c\u79fb\u548c 01 \u80cc\u5305\u4e00\u6837\u3002\n\n\u8003\u8651\u4e0d\u540c\u7ec4\u4e4b\u95f4\u5173\u4e8e $W$ \u7684\u5408\u5e76\u3002\u53d1\u73b0\u7ec4\u4e4b\u95f4 $w_i$ \u662f\u4e8c\u500d\u5173\u7cfb\uff0c\u6240\u4ee5\u82e5\u5728\u7b2c $i$ \u7ec4\u53bb\u6389 $2^i$ \u4f7f\u7528\u4e86 $j$ \u7684\u5bb9\u91cf\uff0c\u5219\u53ef\u4ee5\u770b\u6210\u5728\u7b2c $i-1$ \u7ec4\u53bb\u6389 $2^{i-1}$ \u4f7f\u7528\u4e86 $2j$ \u7684\u5bb9\u91cf\u3002\u6240\u4ee5\u4ece\u9ad8\u4f4d\u5230\u4f4e\u4f4d\u8fdb\u884c dp\u3002\n\n\u82e5\u8bb0 $g_{i,j}$ \u4e3a\u4ece\u9ad8\u5f80\u4f4e\u7684 $i$ \u4f4d\u4f7f\u7528\u4e86 $j$ \u7684\u5bb9\u91cf\uff0c\u8fd9\u4e0e\u76f4\u63a5\u505a\u6b64\u9898\u65e0\u5f02\uff0c$j$ \u7684\u8303\u56f4\u8fc7\u5927\u3002\u4f46\u662f\u6bcf\u7ec4\u7684\u6700\u5927\u5bb9\u91cf\u5e76\u4e0d\u50cf $W$ \u90a3\u4e48\u5927\uff0c\u53ea\u6709 $an$ \u4ee5\u5185\uff0c\u90a3\u4e48\u8003\u8651\u4e0d\u8bb0\u5f55\u4e00\u5171\u6709\u591a\u5c11\uff0c\u800c\u662f\u8bb0\u5f55\u5269\u591a\u5c11\u5bb9\u91cf\u3002\n\n\u8bb0 $g_{i,j}$ \u4e3a\u4ece\u9ad8\u5f80\u4f4e\u7684 $i$ \u4f4d\u5269\u4f59 $j$ \u7684\u5bb9\u91cf\uff0c\u8003\u8651\u6b63\u5411\u8f6c\u79fb\uff0c\u7b2c $i-1$ \u4f4d\u5269\u4f59\u7684\u5bb9\u91cf\u4fbf\u662f $2j+W_{(i-1)}-k$\uff0c\u5176\u4e2d $W_{(i-1)}$ \u662f $W$ \u5728\u4e8c\u8fdb\u5236\u4e0b\u7b2c $i-1$ \u4f4d\u7684\u5927\u5c0f\uff0c$k$ \u4e3a\u679a\u4e3e\u7b2c $i-1$ \u7ec4\u4f7f\u7528\u591a\u5c11\u5bb9\u91cf\u3002\n\n$$\ng_{i,j}+f_{i-1,k}\\to g_{i-1,\\min(10n,2j+W_{(i-1)}-k)}\n$$\n\n\u6ce8\u610f $k$ \u7684\u8303\u56f4\uff0c$0\\leq k\\leq\\min(10n,2j+W_{(i-1)})$\uff0c\u5e76\u4e14\u6ce8\u610f $g$ \u7684\u521d\u59cb\u5316\uff0c\u8981\u521d\u59cb\u5316\u4e3a\u8d1f\u65e0\u7a77\u3002\u56e0\u4e3a $f_{i-1,k}$ \u53ef\u80fd\u4f7f\u4e0d\u80fd\u88ab\u53d6\u5230\u7684 $g_{i,j}$ \u8f6c\u79fb\u5230\u4e0b\u4e00\u9879\u3002\n\n\u8bb0 $a$ \u4e3a $10$\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(a^2n^2\\log W)$\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n#define C(x,y) memset(x,y,sizeof(x))\n\ninline int read(){\n\tint x=0,f=1;\n\tchar c=getchar();\n\twhile(c<'0'||c>'9'){\n\t\tif(c=='-')f=-1;\n\t\tc=getchar();\n\t}\n\twhile(c<='9'&&c>='0'){\n\t\tx=(x<<1)+(x<<3)+(c^48);\n\t\tc=getchar();\n\t}\n\treturn x*f;\n}\n\nvoid print(int x){\n\tif(x<0)putchar('-'),x=-x;\n\tif(x>9)print(x/10);\n\tputchar(x%10^48);\n}\n\nconst int N=1e2+5;\nint n,W,w[35][N],v[35][N],num[35],f[35][10*N],g[35][10*N];\n\nvoid h(int&x,int y){x=max(x,y);}\n\nvoid solve(){\n\tfor(int i=1;i<=n;++i){\n\t\tint ww=read(),vv=read(),b=0;\n\t\twhile(!(ww&1))b++,ww>>=1;\n\t\tw[b][++num[b]]=ww,v[b][num[b]]=vv;\n\t}\n\tfor(int i=0;i<=30;++i){\n\t\tfor(int j=1;j<=num[i];++j){\n\t\t\tfor(int k=10*n;k>=w[i][j];--k){\n\t\t\t\th(f[i][k],f[i][k-w[i][j]]+v[i][j]);\n\t\t\t}\n\t\t}\n\t}\n\tg[30][0]=0;\n\tfor(int i=30;i>=1;--i){\n\t\tg[i-1][0]=g[i-1][W>>(i-1)&1]=0;\n\t\tfor(int j=0;j<=10*n;++j){\n\t\t\tfor(int k=0;k<=min(10*n,2*j+(W>>(i-1)&1));++k){\n\t\t\t\th(g[i-1][min(10*n,2*j+(W>>(i-1)&1)-k)],g[i][j]+f[i-1][k]);\n\t\t\t}\n\t\t}\n\t}\n\tfor(int j=1;j<=10*n;++j)h(g[0][0],g[0][j]);\n\tprint(g[0][0]),putchar('\\n');\n}\n\nvoid clear(){\n\tC(f,0),C(g,0xcf),C(num,0);\n}\n\nsigned main(){\n\twhile(cin>>n>>W){\n\t\tif(n==-1&&W==-1)break;\n\t\tclear(),solve();\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1673338262,
        "uid": 271736,
        "name": "Daidly",
        "ccfLevel": 6,
        "title": "P3188 [HNOI2007]\u68a6\u5e7b\u5c9b\u5b9d\u73e0 \u9898\u89e3"
    },
    {
        "content": "\u53ef\u4ee5\u8bbe $f(i,j)$ \u8868\u793a\uff1a\u53ea\u8003\u8651 $b\\le i$ \u7684\u7269\u54c1\uff0c\u5176\u91cd\u91cf\u548c $\\le 2^i\\times j$ \u7684\u6700\u5927\u4ef7\u503c\u548c\u3002\n\n\u6ce8\u610f\u5230 $j$ \u4e0d\u4f1a\u8d85\u8fc7 $n\\times 30$\uff0c\u56e0\u6b64\u590d\u6742\u5ea6\u4e0d\u4f1a\u7206\u70b8\u3002\n\n\u8f6c\u79fb\u65f6\u53ea\u9700\u8981\u5bf9\u6bcf\u7ec4\u5206\u522b\u80cc\u5305\uff0c\u6c42\u51fa $g(i,j)$ \u8868\u793a\u4ece $b=i$ \u7684\u7269\u54c1\u4e2d\u9009\u51fa $\\sum a\\le j$ \u7684\u67d0\u4e9b\u7269\u54c1\u7684\u6700\u5927\u4ef7\u503c\u548c\uff0c\u90a3\u4e48\u5c31\u6709\u8f6c\u79fb $f(i,j)+g(i+1,x)\\to f(i+1,\\lfloor j/2\\rfloor +x)$\u3002\n\n\u6211\u4eec\u53d1\u73b0\u8fd8\u6709\u4e2a $W$ \u7684\u9650\u5236\u4e0d\u597d\u6ee1\u8db3\u3002\u8003\u8651\u4ece\u9ad8\u4f4d\u5411\u4f4e\u4f4d DP\uff0c\u91cd\u65b0\u8bbe $f(i,j)$ \u8868\u793a\u8003\u8651 $W$ \u7684\u6700\u9ad8 $i$ \u4f4d\u4e0e $b\\ge i$ \u7684\u7269\u54c1\uff0c\u5176\u91cd\u91cf\u548c\u4e0e $W$ \u62b5\u6d88\u4e4b\u540e\uff0c$W$ \u8fd8\u5269\u4e0b\u4e86 $2^i\\times j$ \u7684\u6700\u5927\u4ef7\u503c\u548c\u3002\u8f6c\u79fb\u65f6\uff0c\u8bbe $c$ \u4e3a $W$ \u5728\u7b2c $i+1$ \u4f4d\u4e0a\u7684\u503c\uff0c\u6709\n$$\nf(i,j)+g(i+1,x)\\to f(i+1,2j+c-x)\\\\\nf(i+1,0)=0,f(i+1,c)=0\n$$\n\u4e8e\u662f\u5c31\u505a\u5b8c\u4e86\uff0c\u603b\u7684\u590d\u6742\u5ea6\u5927\u6982\u662f $O(a^2n^2\\log W)$ \n\n```cpp\n#define C(arr,x) memset(arr,x,sizeof(arr))\nvoid chkmax(int &x,int v){x=max(x,v);}\n\nvoid solve(){\n\tC(f,0xcf),C(g,0xcf),C(v,0),C(a,0),C(b,0);\n\tfor(int i=0;i<=30;i++)vec[i].clear();\n\tfor(int i=1;i<=n;i++){\n\t\tint w=read();v[i]=read();\n\t\twhile(w%2==0)w>>=1,b[i]++;a[i]=w;\n\t\tvec[b[i]].emplace_back(i);\n\t}\n\tint m=n*10;\n\tfor(int i=0;i<=30;i++){\n\t\tg[i][0]=0;for(auto t:vec[i]){\n\t\t\tfor(int j=m;j>=a[t];j--)chkmax(g[i][j],g[i][j-a[t]]+v[t]);\n\t\t}\n\t}\n\tf[31][0]=0;\n\tfor(int i=31;i>=1;i--){\n\t\tint c=((W>>(i-1))&1);\n\t\tf[i-1][0]=f[i-1][c]=0;\n\t\tfor(int j=0;j<=m;j++){\n\t\t\tfor(int k=0;k<=m;k++)if(j*2+c-k>=0)chkmax(f[i-1][min(j*2+c-k,m)],f[i][j]+g[i-1][k]);\n\t\t}\n\t}\n\tint ans=0;\n\tfor(int i=0;i<=m;i++)ans=max(ans,f[0][i]);\n\tcout<<ans<<endl;\n}\n```",
        "postTime": 1673285570,
        "uid": 307453,
        "name": "\u4e91\u6d45\u77e5\u5904",
        "ccfLevel": 6,
        "title": "P3188"
    },
    {
        "content": "[\u539f\u9898\u94fe\u63a5](https://www.luogu.com.cn/problem/P3188)\n\n\u3010\u9898\u76ee\u63cf\u8ff0\u3011\n\n\u7ed9\u4f60 $n$ \u4e2a\u7269\u54c1\u5206\u522b\u7ed9\u51fa\u4ed6\u4eec\u7684\u4f53\u79ef $v_i$ \u548c\u4ef7\u503c $w_i$ \uff0c\u95ee\u4f60\u5bb9\u91cf\u4e3a $m$ \u7684\u80cc\u5305\u6700\u591a\u88c5\u591a\u5c11\u4ef7\u503c\u3002\n\n\u3010\u9898\u89e3\u3011\n\n- \u9996\u5148\u6ce8\u610f\u5230\u8fd9\u9898\u672c\u8d28\u5c31\u662f\u4e2a $01$ \u80cc\u5305\uff0c\u4f46\u662f\u7531\u4e8e\u6570\u636e\u8303\u56f4\u8f83\u5927\u65e0\u6cd5\u901a\u8fc7\uff0c\u9700\u8981\u6ce8\u610f\u5230\u7684\u662f $v_i=a\\times 2^b,a\\le 10,b\\le 30$\n\n> \u8fd9\u5176\u5b9e\u5728\u8bf1\u5bfc\u4f60\u6309\u7167\u4e8c\u8fdb\u5236\u4f4d\u6570\u8fdb\u884c\u5206\u7ec4 $01$ \u80cc\u5305\uff0c\u518d\u8fdb\u884c\u5408\u5e76\n\n- \u9996\u5148\u8003\u8651\u5148\u5c06\u6bcf\u4e00\u7ec4\u7684 $01$ \u80cc\u5305\u6c42\u51fa\uff0c\u5c06 $f_{i,j}$ \u8868\u793a\u4e3a\u5f53\u524d\u7b2c $i$ \u7ec4\u4f7f\u7528 $j\\times 2^i$ \u7684\u5bb9\u91cf\u62ff\u7684\u6700\u5927\u4ef7\u503c\n\n- - \u5c06\u6bcf\u4e00\u4e2a\u7269\u54c1\u6309\u7167 $a\\times 2^b$ \u62c6\u5f00\u8868\u793a\u4e3a\u5728 $b$ \u8fd9\u4e00\u7ec4\u5185\u6709\u4e2a\u4f53\u79ef\u4e3a $a$ \u7684\u7269\u54c1\n\n- - \u8fdb\u884c\u666e\u901a\u7684 $01$ \u80cc\u5305 $f_{i,j}=\\max(f_{i,j},f_{i,j-v_k}+w_k)$\n\n\n\n\n- \u73b0\u5728\u6211\u4eec\u91cd\u65b0\u5b9a\u4e49\u4e00\u4e2a\u6570\u7ec4 $g_{i,j}$ \u8868\u793a\u524d $i$ \u7ec4\u5f53\u524d\u7b2c $i$ \u7ec4\u7528\u4e86 $j\\times 2^i$ \u5e76\u4e14\u5168\u90e8\u7684\u5bb9\u91cf\u5c0f\u4e8e\u7b49\u4e8e $m$ \u83b7\u5f97\u7684\u6700\u5927\u4ef7\u503c\uff0c\u5e76\u5b9a\u4e49 $bit_i$ \u8868\u793a $w$ \u4e8c\u8fdb\u5236\u7b2c $i$ \u662f\u5426\u4e3a $1$\n\n- - \u5f53\u524d $1\\sim i$ \u7528\u4e86 $j$ \u5bb9\u91cf\u83b7\u5f97\u7684\u4ef7\u503c\u7b49\u4e8e\u8fd9\u4e00\u7ec4\u80cc\u5305\u7528\u4e86 $k$ \u5bb9\u91cf\u7684\u4ef7\u503c\u52a0\u4e0a $1\\sim (i-1)$ \u7528\u4e86 $2\\times (j-k)+bit_{i-1}$ \u7684\u4ef7\u503c\n$$\ng_{i,j}=\\max(g_{i,j},f_{i,k}+g_{i-1,2\\times(j-k)+bit_{i-1}})\n$$\n\u4f9d\u6b21\u8fdb\u884c\u5408\u5e76\u5373\u53ef\n\n```cpp\n\t\tvector v(31,vector<pair<int,int> >());\n\t\tvector f(lim+2,vector<ll>(2005)),g(lim+2,vector<ll>(2005));\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tint v1,w;\n\t\t\tscanf(\"%d%d\",&v1,&w);\n\t\t\tint lp=__builtin_ffs(v1)-1;\n\t\t\tv[lp].push_back({v1>>lp,w});\n\t\t}\n\t\tfor(int i=0;i<=lim;i++){\n\t\t\tfor(auto [vv,ww]:v[i]){\n\t\t\t\tfor(int j=1000;j>=vv;j--){\n\t\t\t\t\tf[i][j]=max(f[i][j],f[i][j-vv]+ww);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<=1000;i++) g[0][i]=f[0][i];\n\t\tfor(int i=1;i<=lim;i++){\n\t\t\tfor(int j=0;j<=1000;j++){\n\t\t\t\tfor(int k=0;k<=j;k++){\n\t\t\t\t\tg[i][j]=max(g[i][j],f[i][k]+g[i-1][2*(j-k)+(w>>(i-1)&1)]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n```\n***\n\n**\u6709\u4ec0\u4e48\u4e0d\u61c2\u7684\u53ef\u4ee5\u8bc4\u8bba\u533a\u95ee\uff0c\u770b\u5230\u4e86\u4f1a\u56de\u590d**",
        "postTime": 1659531002,
        "uid": 419749,
        "name": "lrb666",
        "ccfLevel": 0,
        "title": "[HNOI2007]\u68a6\u5e7b\u5c9b\u5b9d\u73e0"
    },
    {
        "content": "### P3188 [HNOI2007]\u68a6\u5e7b\u5c9b\u5b9d\u73e0\n\n ~~2021\u7b2c\u4e00\u9053\u9898~~\n\n\u8d85\u5927\u80cc\u5305+\u7269\u54c1\u95ee\u9898\u3002\n\n\u7269\u54c1\u6570\u91cf\u5f88\u5c11\uff0c\u5e76\u4e14 $w_i,v_i$ \u53ef\u4ee5\u62c6\u5206\u6210 $a\\times 2^b$ \u7684\u5f62\u5f0f\u3002\n\n\u8003\u8651\u4e8c\u8fdb\u5236\u5206\u7ec4\n\n\u6211\u4eec\u53ef\u4ee5**\u6309\u7167 $b$ \u7684\u5927\u5c0f\u5bf9\u7269\u4f53\u8fdb\u884c\u5206\u7ec4\uff0c\u7136\u540e\u5728\u6bcf\u4e2a\u7ec4\u518501\u80cc\u5305\uff0c\u5c31\u80fd\u5f97\u5230\u4e00\u4e9b\u6cdb\u5316\u7269\u54c1** ([$link:\u6cdb\u5316\u7269\u54c1\u7684\u5b9a\u4e49$](https://www.kancloud.cn/kancloud/pack/70132))\n\n---\n- **\u6cdb\u5316\u7269\u54c1\u5b9a\u4e49\uff1a** \u8003\u8651\u4e00\u79cd\u7269\u54c1\uff0c\u5b83**\u6ca1\u6709\u56fa\u5b9a\u7684\u8d39\u7528\u548c\u4ef7\u503c**\uff0c\u800c\u662f\u5176\u4ef7\u503c**\u968f\u7740\u5206\u914d\u7ed9\u5b83\u7684\u8d39\u7528\u53d8\u5316\u800c\u53d8\u5316**\u3002\n\n  \u5bf9\u4e8e\u4e00\u4e2a\u6cdb\u5316\u7269\u54c1\uff0c\u53ef\u4ee5\u7528\u4e00\u4e2a\u4e00\u7ef4\u6570\u7ec4$G_i$\u8868\u793a\u5176\u8d39\u7528\u4e0e\u4ef7\u503c\u7684\u5173\u7cfb\uff1a\u5f53\u8d39\u7528\u4e3a$i$\u65f6\uff0c\u76f8\u5bf9\u5e94\u7684\u4ef7\u503c\u4e3a$G_i$\u3002\n\n- **\u6cdb\u5316\u7269\u54c1\u7684\u548c**\uff1a\u628a\u4e24\u4e2a\u7269\u54c1\u5408\u5728\u4e00\u8d77\u7684\u8fd0\u7b97\uff0c\u5c31\u662f\u679a\u4e3e\u8d39\u7528\u5206\u914d\u7ed9\u4e24\u4e2a\u7269\u54c1\uff0c\n\n  $G_j=max(G1_{j-k},G2_{k})(0 \\leq k \\leq j \\leq C)$\n\n  \u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(C^2)$\u3002\n\n---\n\n$g(i\\,,\\,j)$ \u8868\u793a **$2^i$ \u7ec4\u5206\u914d\u7ed9 $j$ \u7684\u8d39\u7528\u65f6\u80fd\u83b7\u5f97\u7684\u6700\u5927\u4ef7\u503c\u3002**\n\n\u6cdb\u5316\u7269\u54c1\u7684\u4e2a\u6570\u6700\u591a\u53ea\u6709 $31$ \u4e2a\uff0c\u56e0\u4e3a $0\\le b \\le 30$\n\n\u7136\u540e\u6211\u4eec\u8003\u8651\u5c06\u6cdb\u5316\u7269\u54c1\u5408\u5e76\u5f97\u5230\u7b54\u6848\u3002\n\n\u6839\u636e\u9898\u76ee\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u72b6\u6001\u503c $f(i\\,,\\,j)$ \u4e3a\uff1a**\u7528\u4e86 $j\\times 2^i + W \\& (2^i-1)$ \u7684\u5bb9\u79ef**\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u679a\u4e3e\u8d39\u7528\u4e8c\u8fdb\u5236\u4e0b\u7684\u6700\u9ad8\u4f4d\uff0c\u5269\u4e0b\u7684\u4f4d\u4e0e\u9898\u4e2d\u7684 $W$ \u76f8\u540c\u3002\n\n\u8bbe $W$ \u7684\u6700\u9ad8\u4f4d\u4ee3\u8868 $2^I$ \uff0c\u7b54\u6848\u5c31\u662f $f(I\\,,\\,1)$\u3002\n\n\u679a\u4e3e $i,j$ \u4e3a **\u5206\u7ec4\u5230\u8fbe\u7684\u4f4d\u7f6e** \u548c **\u4f7f\u7528\u7684\u603b\u8d39\u7528**\uff0c\u679a\u4e3e $k$ \u4e3a **\u5f53\u524d\u7ec4\u6240\u4f7f\u7528\u7684\u8d39\u7528**\u3002\n\n\u5219\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$f(i\\,,\\,j)=max\\{\\ g(i\\,,\\,k)+f(i-1\\,,\\,(j-k)\\times 2+(W>>(i-1)\\&1))\\ \\}$\n\n\u6ce8\u610f $i$ \u4e0e $i-1$ \u8054\u7cfb\u7684\u65f6\u5019\u8981\u5c06\u5f53\u524d $j$ \u4e2d\u5206\u914d\u7ed9\u4e0a\u4e00\u7ec4\u7684\u8d39\u7528 $\\times 2+\\,$ $W$\u4e0a\u4e00\u4e8c\u8fdb\u5236\u4f4d\u4e0a\u7684\u6570\u3002\n\n$f,g$\u8bb0\u5f97\u5f00`long long`\n\n\u4e8e\u662f\u6253\u51fa\u5982\u4e0b\u4ee3\u7801(C++11 O2 1.68s)\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nconst int N=5020;\nconst int L=210;\n\nint n,W;\nint maxn=0;\nvector<ll> w[N],v[N];\nll f[L][N],g[L][N];\n\ninline ll max_(ll a,ll b)\n{\n\treturn (a>b?a:b);\n}\n\nint main()\n{\n\twhile(scanf(\"%d%d\",&n,&W)!=EOF && ~n && ~W)\n\t{\n\t\tfor(int i=0;i<=100;i++)\n\t\t\tw[i].clear(),v[i].clear();\n\t\tmemset(f,0,sizeof f);\n\t\tmemset(g,0,sizeof g);\n\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tint x,y;\n\t\t\tscanf(\"%d%d\",&x,&y);\n\t\t\tint j=0;\n\t\t\twhile(!(x&1)) x>>=1,++j;\n\t\t\tmaxn=max_(x,j);\n\t\t\tw[j].push_back(x),v[j].push_back(y);//\u5206\u7ec4\n\t\t}\n\t\tint I=0;\n\t\twhile((1<<I)<W) I++;//\u6c42 W \u6700\u9ad8\u4f4d\u6570\n\t\tI--;\n\n\t\tfor(int i=0;i<=I;i++)//\u904d\u5386\u6bcf\u4e2a\u7ec4\n\t\t{\n\t\t\tif(!w[i].size()) continue;\n\t\t\tfor(unsigned long long j=0;j<w[i].size();j++)\n\t\t\t{\n\t\t\t\tfor(int k=1000;k>=w[i][j];k--)\n\t\t\t\t{\n\t\t\t\t\tg[i][k]=max_(g[i][k],g[i][k-w[i][j]]+v[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor(int i=0;i<=I;i++)\n\t\t{\n\t\t\tfor(int j=1000;j>=0;j--)\n\t\t\t{\n\t\t\t\tfor(int k=0;k<=j;k++)//\u679a\u4e3e\u5f53\u524d\u7ec4\u4f7f\u7528\u7684\u8d39\u7528\n\t\t\t\t\tf[i][j]=max_(f[i][j],(ll)g[i][k]+f[i-1][(j-k)*2+(W>>(i-1)&1)]);\n\t\t\t}\n\t\t}\n\n\t\tprintf(\"%lld\\n\",f[I][1]);\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1609637328,
        "uid": 278259,
        "name": "RemiliaScarlet\u25ce",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3188 \u3010[HNOI2007]\u68a6\u5e7b\u5c9b\u5b9d\u73e0\u3011"
    },
    {
        "content": "## \u9898\u76ee\u63cf\u8ff0\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3188)\n\n## \u601d\u8def\u7b80\u8ff0\n\n\u4e00\u770b\u9898\u76ee\uff1a01\u80cc\u5305\u3002\n\n\u8054\u7cfb\u672c\u9898\u7684\u7279\u6b8a\u6570\u636e\u8303\u56f4\uff1a\n\n> \u4fdd\u8bc1\u6bcf\u4e2a $w_i$ \u80fd\u5199\u6210 $a \\times 2^b$ $(a,b\\in N)$ \u7684\u5f62\u5f0f\uff0c$a \\leq 10$\uff0c$b \\leq 30$\u3002\n\n> $n\\leq 100$\u3002\n\n---\n\n\u5f88\u5bb9\u6613\u7684\u60f3\u5230\u53ef\u4ee5\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u8fdb\u884c dp\u3002\n\n\u8bbe\u8ba1\u72b6\u6001\uff1a$dp[i][j]$ \u8868\u793a\u5230\u7b2c $i$ \u4e2a\u4e8c\u8fdb\u5236\u4f4d\uff0c\u73b0\u5728\u5269\u4f59\u7684\u80cc\u5305\u6070\u597d\u8fd8\u6709 $j$ \u4e2a $2^i$ \u7684\u5927\u5c0f\u7684\u6700\u5927\u4ef7\u503c\u3002\n\n---\n\n\u90a3\u4e48\u7528\u6240\u6709 $w$ \u80fd\u591f\u8868\u793a\u4e3a $a\\times 2^i$ \u7684\u7269\u4f53\u53bb\u66f4\u65b0 $dp[i][j]$,\u6bcf\u6b21\u8f6c\u79fb\u7684\u65b9\u7a0b\u662f ```dp[i][j]=max(dp[i][j],dp[i][j+a]+v)```\uff08$v$ \u4e3a\u5f53\u524d\u7269\u4f53\u7684\u4ef7\u503c\uff09\u3002\n\n\u7531\u4e8e\u6eda\u52a8\u6570\u7ec4\uff0c\u4ece $j$ \u4ece\u5c0f\u5230\u5927\u8f6c\u79fb\u3002\n\n$i$ \u4ece\u5927\u5230\u5c0f\u66f4\u65b0\u8003\u8651 $dp[i+1][]$ \u5bf9\u4e8e $dp[i][]$ \u7684\u8d21\u732e\u3002\n\n\u4ee4 $tag$ \u8868\u793a $W$ \u5728\u4e8c\u8fdb\u5236\u8868\u793a\u4e0b\u7b2c $i$ \u4f4d\u662f\u5426\u662f $1$\u3002\n\n\u90a3\u4e48\u5c31\u6709 ```dp[i][j*2+tag]=dp[i+1][j]```\u3002\n\n---\n\n\u521d\u59cb\u5316 ```dp[31][0]=0```\uff0c\u5176\u4f59\u7686\u8d4b\u503c\u4e3a\u65e0\u7a77\u5c0f\u3002\n\n---\n\n\u90a3\u4e48\u73b0\u5728\u95ee\u9898\u6765\u4e86\uff0c\u7b2c\u4e8c\u7ef4\u7684\u679a\u4e3e\u8303\u56f4\u662f\u591a\u5c11\u5462\uff1f\u7531\u4e8e $n\\leq 100$\uff0c\u6240\u4ee5\u5f53 $j\\ge 1000$ \u65f6\uff0c\u540e\u9762\u7684\u6240\u6709\u7269\u4f53\u90fd\u53ef\u4ee5\u9009\uff0c\u76f4\u63a5\u7279\u5224\u5373\u53ef\u3002\n\n---\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(3000Tn)$\n\n~~\u7801\u91cf\u5f88\u5c0f\uff08\u81f3\u591a20min\u5199+\u8c03\u8fd9\u6837\u5b50\uff1f\uff09~~\n\n## \u4e11\u964b\u306e\u4ee3\u7801\n[click here](https://www.luogu.com.cn/paste/y8yaku82)",
        "postTime": 1654528495,
        "uid": 312306,
        "name": "LJ07",
        "ccfLevel": 0,
        "title": "[Solution]P3188 [HNOI2007]\u68a6\u5e7b\u5c9b\u5b9d\u73e0"
    },
    {
        "content": "\u8fd9\u91cc\u5199\u4e00\u79cd\u548c\u5176\u4ed6\u9898\u89e3\u4e0d\u592a\u4e00\u6837\u7684\u505a\u6cd5\uff1a\u8fb9 dp \u8fb9\u5408\u5e76\u3002\n\n\u4e0d\u59a8\u8bbe $M(x)=2^{x+1}-1$\uff0c\u5373\u4e00\u4e2a $x$ \u4f4d\u7684\u5168 $1$ \u6570\u3002\n\n\u5229\u7528\u8d2a\u5fc3\u7684\u601d\u60f3\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe $f[j][k]$ \u4e3a\u5f53\u524d\u80cc\u5305\u5bb9\u79ef\u4e3a $j \\times 2^k + M(k-1) \\& W$ \u65f6\u7684\u6700\u5927\u4ef7\u503c\uff0c\u5373**\u524d $k-1$ \u4f4d\u7684\u5bb9\u91cf\u90fd\u6309\u7167 $W$ \u7684\u9650\u5236\u8fbe\u5230\u6700\u5927\u503c**\u3002\u6211\u4eec\u53ef\u4ee5\u628a $i$ \u201c\u5806\u201d\u5728\u7b2c $k$ \u4f4d\uff0c\u8f6c\u79fb\u65f6\u518d\u5411\u524d\u8fdb\u4f4d\u3002\u8fdb\u4f4d\u65f6\uff0c\u679a\u4e3e\u5bb9\u91cf $j$\uff0c\u5219\u5f53\u4e14\u4ec5\u5f53 $j \\& 1=0$ \u6216 $m \\& (1<<k)=1$ \u65f6\u53ef\u4ee5\u8fdb\u4f4d\uff08\u9700\u8981\u5728\u5f53\u524d\u4f4d\u4e0a\u7559\u4e0b\u4e00\u4e2a 1 \u6216\u65e0\u9700\u7559\u4e0b 1)\u3002\n\n\u4f46\u662f\u8fd9\u6837\u8fd8\u4e0d\u591f\uff1a\u8003\u8651\u53cd\u4f8b $m=(1000)_2$\uff0c\u6309\u7167\u8fd9\u79cd\u65b9\u5f0f dp \u5219\u65e0\u6cd5\u653e\u5165 $w=(0111)_2$ \u7684\u7269\u54c1\u3002\u53d1\u73b0\u6709\u65f6\u4e0d\u80fd\u4e00\u76f4\u6ee1\u8db3**\u6309\u7167 $W$ \u7684\u9650\u5236\u8fbe\u5230\u6700\u5927\u503c**\uff0c\u4e8e\u662f\u8003\u8651\u518d\u8bbe\u4e00\u4e2a $g[j][k]$ \u8868\u793a\u5f53\u524d\u80cc\u5305\u5bb9\u79ef\u4e3a $j \\times 2^k + M(k-1)$ \u65f6\u7684\u6700\u5927\u4ef7\u503c\u3002$g$ \u7684\u8f6c\u79fb\u6bd4\u8f83\u968f\u4fbf\uff0c\u4f46\u662f\u8981\u6ce8\u610f $g$ \u9700\u8981\u8f6c\u79fb\u5230 $f$\u3002\u600e\u6837\u8f6c\u79fb\uff1f\u53ea\u6709 $m$ \u5728\u7b2c $k$ \u4f4d\u662f $1$\uff0c\u4f46\u662f $j \\& 1=0$\uff08\u5373\u5728\u5f53\u524d\u4f4d\u586b $0$\uff09\u7684\u65f6\u5019\uff0c\u5bb9\u91cf\u624d\u4f1a\u5c0f\u4e8e $M(k) \\& W$\u3002\n\n\u6838\u5fc3\u4ee3\u7801\uff1a\n\n```cpp\nvoid dp() {\n    int i = 1;\n    U (k, 0, 30) {\n        for (; gem[i].b == k && i <= n; ++i) { // \u8bb0\u5f97\u5224\u65ad\u8fb9\u754c\uff01\n            for (int j = 2000; j >= gem[i].a; --j) {\n                f[j][k] = max(f[j][k], f[j - gem[i].a][k] + gem[i].v);\n                g[j][k] = max(g[j][k], g[j - gem[i].a][k] + gem[i].v); // \u80cc\u5305 dp \u8f6c\u79fb\n            }\n        }\n        U (j, 0, 2000) {\n            if ((m & (1 << k)) || !(j & 1))  // \u5141\u8bb8\u5728\u8fd9\u4e00\u4f4d\u7559\u4e0b\u4e00\u4e2a 1, \u6216\u4e0d\u4ea7\u751f 1\n                f[j >> 1][k + 1] = max(f[j >> 1][k + 1], f[j][k]);\n\n            g[j >> 1][k + 1] = max(g[j >> 1][k + 1], g[j][k]);\n            if ((m & (1 << k)) && !(j & 1))\n                f[j >> 1][k + 1] = max(f[j >> 1][k + 1], g[j][k]); // g \u5411 f \u8f6c\u79fb\n        }\n    }\n}\n```\n\n[\u5b8c\u6574\u4ee3\u7801](https://www.luogu.com.cn/paste/tmsz3y18)",
        "postTime": 1645007097,
        "uid": 120324,
        "name": "Yansuan_HCl",
        "ccfLevel": 7,
        "title": "[\u9898\u89e3] P3188 [HNOI2007]\u68a6\u5e7b\u5c9b\u5b9d\u73e0"
    },
    {
        "content": "## \u524d\u8a00\n\u5927\u5bb6\u8c8c\u4f3c\u90fd\u7528\u7684\u7eaf\u5206\u7ec4\u80cc\u5305\u7684\u60f3\u6cd5  \n\u800c\u6211\u505a\u80cc\u5305\u7684\u65f6\u5019**\u6bd4\u8f83\u5f53\u524d\u603b\u4ee3\u4ef7\u548c\u6700\u5927\u4ee3\u4ef7\u7684\u65b9\u6cd5**\u4e0d\u592a\u539f\u6559\u65e8\u3002\n\n## \u7b80\u8981\u9898\u610f\n\n01 \u80cc\u5305\uff0c\u4f46\u662f\u4ee3\u4ef7\u53ef\u4ee5\u8868\u793a\u6210 $ a\\times 2^b (a\\le10,b\\le30) $ \u7684\u5f62\u5f0f\n\n## \u601d\u8def\n~~\u7531\u4e8e\u672c\u849f\u84bb\u521a A \u6389 NOIP2021 T2~~    \n\u5341\u5206\u81ea\u7136\u7684\u60f3\u5230\u4e86\u4e00\u79cd**\u6309\u4e8c\u8fdb\u5236\u4f4d\u5224\u65ad\u4ee3\u4ef7**\u7684 DP \u5f62\u5f0f\n\n\u6211\u4eec\u9996\u5148\u5904\u7406\u51fa\u6bcf\u4e2a\u7269\u54c1\u7684 $a,b$\uff0c\u6309\u6bcf\u4e2a\u7269\u54c1\u7684 $b$ \u5bf9\u5b83\u4eec\u5206\u4e2a\u7c7b\uff0c$b$ \u76f8\u7b49\u5c31\u6254\u5728\u4e00\u5806\u3002\n\n\u8bb0 DP \u6570\u7ec4 $ dp[i][j][0/1] $\uff0c$i$ \u4ee3\u8868\u5f53\u524d\u5904\u7406\u7684\u662f $b=i$ \u7684\u5806\u3002\n\n### \u91cd\u70b9 ~~\u6211\u8bb2\u4e0d\u592a\u597d\u7684\u70b9~~\uff1a  \n\uff08$W$ \u4ee3\u8868\u6700\u5927\u4ee3\u4ef7\uff0c$w$ \u4ee3\u8868\u5f53\u524d\u603b\u4ee3\u4ef7)\uff09 \n$j$ \u4ee3\u8868\u5728\u4e8c\u8fdb\u5236\u8868\u793a\u4e0b\uff0c\u5f53\u524d\u603b\u4ee3\u4ef7 $w$ **\u7b2c $i$ \u4f4d**\u53ca**\u4ee5\u4e0a**\u7684\u5341\u8fdb\u5236\u8868\u793a  \n\n\u6bd4\u5982\u8bf4 $w=11=(2)1011$ \uff0c\u5f53 $i=2$ \u65f6\uff0c$j=5=(2)101$\n($(2)$\u6307 $101$ \u662f\u4e8c\u8fdb\u5236\u6570)\n\n$0/1$ \u4ee3\u8868\u5728\u4e8c\u8fdb\u5236\u8868\u793a\u4e0b\uff0c\u53ea\u770b\u5f53\u524d\u603b\u4ee3\u4ef7  $w$ **\u7b2c $i-1$ \u4f4d**\u53ca**\u4ee5\u4e0b**\u662f\u5426\u5927\u4e8e\u6700\u5927\u4ee3\u4ef7  $W$\u3002  \n\n\u6211\u4eec\u5728\u5b66\u9ad8\u7cbe\u5ea6\u7684\u65f6\u5019\u4e5f\u8bb8\u5c31\u77e5\u9053\u4e86\u2014\u2014\u6bd4\u8f83\u4e24\u6570\u6700\u9ad8\u4f4d\u53ef\u51b3\u5b9a\u4e24\u6570\u76f8\u5bf9\u5927\u5c0f\uff0c\u82e5\u4e24\u6570\u6700\u9ad8\u4f4d\u76f8\u7b49\uff0c\u5219\u6bd4\u8f83\u6b64\u9ad8\u4f4d\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\n\n\u6240\u4ee5\u8fd9\u9898\u4e5f\u53ef\u4ee5\u901a\u8fc7\u8fdb\u884c\u4ece\u4f4e\u4f4d\u5230\u9ad8\u4f4d\u7684\u4e0d\u65ad\u6bd4\u8f83\u5224\u65ad $w$ \u4e0e $W$ \u7684\u5927\u5c0f\u5173\u7cfb\u3002\n\n\u5176\u5b9e\u8bb2\u5230\u8fd9\u91cc\u4e86\u5927\u5bb6\u5927\u6982\u90fd\u53ef\u4ee5\u81ea\u5df1\u63a8\u5f0f\u5b50\u4e86\uff0c\u60f3\u770b\u7684\u5c31\u7ee7\u7eed\u3002\n## \u8f6c\u79fb\u5f0f\n\n### \u5728\u6bcf\u5806\u4e4b\u95f4\u7684\u8f6c\u79fb:\n\uff08$W_i$ \u4ee3\u8868\u7b2c $i$ \u4f4d\u4e0a\u6700\u5927\u4ee3\u4ef7\u7684\u503c\uff0c$w_i$  \u4ee3\u8868\u7b2c $i$ \u4f4d\u4e0a\u5f53\u524d\u603b\u4ee3\u4ef7\u7684\u503c\uff0c\uff08\u5747\u4e3a\u4e8c\u8fdb\u5236\uff09\uff09\n\n\n- $ (W_i>w_i) dp[i+1][j\\div2][0]=\\max(dp[i+1][j\\div2][0],\\max(dp[i][j][0],dp[i][j][1])) $ \n- $ (W_i<w_i) dp[i+1][j\\div2][1]=\\max(dp[i+1][j\\div2][1],\\max(dp[i][j][0],dp[i][j][1])) $ \n- $ (W_i=w_i) dp[i+1][j\\div2][0]=\\max(dp[i+1][j\\div2][0],dp[i][j][0]),\t\t\t\t   dp[i+1][j\\div2][1]=\\max(dp[i+1][j\\div2][1],dp[i][j][1]) $   \n\n\u90a3\u4e9b\u4e71\u7cdf\u7cdf\u7684 $0/1$ \u53d8\u5316\u5176\u5b9e\u5c31\u662f\u9ad8\u4f4d\u5f71\u54cd\u4f4e\u4f4d\u7684\u7ed3\u679c\uff1a  \n\u5982\u679c\u7b2c $i$ \u4f4d\u4e0a $W_i>w_i$\uff0c\u90a3\u65e0\u8bba\u7b2c $i-1$ \u4f4d\u53ca\u4e4b\u524d $W$ \u4e0e $w$ \u7684\u5173\u7cfb\u5982\u4f55\uff0c\u8003\u8651\u7b2c $i$ \u4f4d\u540e\u4e00\u5b9a\u90fd\u662f $W>w$\uff0c$W_i<w_i$\u540c\u3002  \n\u800c $W_i=w_i$\uff0c\u7b2c $i$ \u4f4d\u7684\u6bd4\u8f83\u4e0d\u4ea7\u751f\u5f71\u54cd\uff0c\u5c31\u4ee5\u7b2c $i-1$ \u4f4d\u53ca\u4e4b\u524d\u7684\u6bd4\u8f83\u4e3a\u51c6\u4e86\u3002\n\n\u5173\u4e8e $j$ \u7684\u9012\u63a8\uff1a  \n\u6211\u4eec\u4ece\u8003\u8651\u7b2c $i$ \u4f4d\u53ca\u4ee5\u540e\u5230\u7b2c $i+1$ \u4f4d\u53ca\u4ee5\u540e\uff0c\u4e0d\u5c31\u662f\u628a\u7b2c $i$ \u4f4d\u6254\u6389\u561b\uff0c\u53f3\u79fb\u4e00\u4f4d\uff0c\u5373 $j\\div2$\u3002\n\n### \u5728\u5806\u5185\u7684\u8f6c\u79fb\n\n\u6211\u4eec\u5df2\u7ecf\u628a\u7b2c $i$ \u4f4d\u5bf9 $W$ \u548c $w$ \u7684\u5927\u5c0f\u5173\u7cfb\u7684\u5f71\u54cd\u6254\u5728\u6700\u540e\uff08\u4e24\u5806\u4e4b\u95f4\u7684\u8f6c\u79fb\uff09\u8003\u8651\uff0c\u786c\u505a\u4e00\u904d\u80cc\u5305,\u800c\u4e14\u4e0d\u5927\u4e8e\u548c\u5927\u4e8e ($0/1$) \u4e24\u8fb9\u5206\u5f00\u8f6c\u79fb\u5c31\u597d\u4e86\u3002\n## done\uff01\n\n```cpp\n// By Hasinon,the juruo who's waiting for AFO life.\n#include<bits/stdc++.h>\n#define ll long long\n#define FOR(i,a,b) for(int i=(a); i<=(b); ++i)\n#define ROF(i,a,b) for(int i=(a); i>=(b); --i)\nusing namespace std;\nbool hasinon;\nll time1=clock();\n//\nstruct node{\n\tll v,a,b;\n};\nconst ll N=100;\nnode trea[N+10];\nll dp[31][1010][2],wdig[50]; // \u4f4d\u6570 \u4e0a\u4f20\u6570 \u662f\u5426\u8d85 \nll dto;\n//\nll dig(ll a){\n\tll t=0;\n\twhile(!(a%(1ll<<t))&&t<=30) ++t; --t;\n\treturn t;\n}\nvoid chan(ll a){\n\tdto=0;\n\twhile(a){\n\t\twdig[++dto]=(a&1); a>>=1;\n\t}\n}\n//\nbool cmp(node a,node b){\n\treturn a.b<b.b;\n}\ninline ll gt(){\n\tll t=0,f=0;char v=getchar();\n\twhile(!isdigit(v))f|=(v=='-'),v=getchar();\n\twhile(isdigit(v))t=(t<<3)+(t<<1)+v-48,v=getchar();\n\treturn f?-t:t;\n}\nbool Hasinon;\n//void usage() {\n//\tll time2=clock();\n//\tcout<<(&Hasinon-&hasinon)/1024/1024<<\" Mb, \"<<time2-time1<<\" Ms\\n\";\n//}\nint main() {\n//\tfreopen(\"P3188.in\",\"r\",stdin);\n//\tfreopen(\"P3188.out\",\"w\",stdout);\n\twhile(1){\n\t\tll inn=gt(),inw=gt();\n\t\tif(inn==-1&&inw==-1) return 0;\n\t\tFOR(i,1,inn){\n\t\t\tll t1=gt(),t2=gt(),tb=dig(t1); trea[i]={t2,t1/(1ll<<tb),tb};\n\t\t}  \n\t\tsort(trea+1,trea+inn+1,cmp);\n\t\tchan(inw); \n\t\tll tto=1;\n\t\tmemset(dp,-0x3f,sizeof(dp));\n\t\tdp[0][0][0]=0;\n\t\tFOR(i,1,dto){\n\t\t\tfor(int j=0; j<10*inn; j++){\n\t\t\t\tif(wdig[i-1]==1&&!(j&1)) \n\t\t\t\t\tdp[i][j/2][0]=max(dp[i][j/2][0],max(dp[i-1][j][0],dp[i-1][j][1]));\n\t\t\t\telse if(wdig[i-1]==0&&(j&1))\n\t\t\t\t\tdp[i][j/2][1]=max(dp[i][j/2][1],max(dp[i-1][j][0],dp[i-1][j][1]));\n\t\t\t\telse{\n\t\t\t\t\tdp[i][j/2][0]=max(dp[i][j/2][0],dp[i-1][j][0]);\n\t\t\t\t\tdp[i][j/2][1]=max(dp[i][j/2][1],dp[i-1][j][1]); \n\t\t\t\t}\n\t\t\t}\n\t\t\twhile(trea[tto].b==i-1&&tto<=inn){\n\t\t\t\tROF(j,10*inn-trea[tto].a,0){\n\t\t\t\t\tdp[i][j+trea[tto].a][0]=max(dp[i][j+trea[tto].a][0],dp[i][j][0]+trea[tto].v);\t\n\t\t\t\t\tdp[i][j+trea[tto].a][1]=max(dp[i][j+trea[tto].a][1],dp[i][j][1]+trea[tto].v);\t\n\t\t\t\t}\n\t\t\t\t++tto;\n\t\t\t}\n\t\t\tFOR(j,0,10*inn){\n\t\t\t\tif(wdig[i]==1&&!(j&1)){\n\t\t\t\t\tdp[i][j][0]=max(dp[i][j][0],dp[i][j][1]);\t\n\t\t\t\t\tmemset(&dp[i][j][1],-0x3f,sizeof(dp[i][j][1]));\n\t\t\t\t}\n\t\t\t\telse if(wdig[i]==0&&(j&1)){\n\t\t\t\t\tdp[i][j][1]=max(dp[i][j][0],dp[i][j][1]);\t\n\t\t\t\t\tmemset(&dp[i][j][0],-0x3f,sizeof(dp[i][j][1]));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tll ans=0;\n\t\tFOR(j,0,1){\n\t\t\tans=max(ans,dp[dto][j][0]);\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t} \n}\n\n```\n\n\n",
        "postTime": 1643169022,
        "uid": 208967,
        "name": "Hasinon",
        "ccfLevel": 9,
        "title": "P3188 [HNOI2007]\u68a6\u5e7b\u5c9b\u5b9d\u73e0 \u840c\u65b0\u9898\u89e3 7th"
    }
]
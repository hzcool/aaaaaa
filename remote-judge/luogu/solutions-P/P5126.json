[
    {
        "content": "update\uff1a\u7531\u4e8e\u8fd9\u9898\u6807\u7b97\u88ab\u7206\u4e86\u591a\u6b21\uff0c\u5c31\u8be6\u7ec6\u8be6\u7ec6\u8bb2\u4e00\u4e0b\u5404\u505a\u6cd5\u5427\uff08\u5408\u8ba2\u672c\u65e2\u89c6\u611f\uff09\u3002\n\n****\n#### \u51fa\u9898\u4eba\u505a\u6cd5\uff1a\n\n\u6784\u9020\u4e00\u4e2a\u77e9\u9635\u6765\u505a\u5feb\u901f\u5e42\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(k^3 \\log n)$\u3002\n\n****\n#### \u672c\u4eba\u7b2c\u4e00\u6b21\u505a\u6cd5\uff1a\n\n\u65e2\u7136\u8fd9\u662f\u7ebf\u6027\u9012\u63a8\uff0c\u90a3\u6211\u4eec\u53ef\u4ee5\u7528 [BM \u7b97\u6cd5](https://www.luogu.com.cn/problem/P5487) \u627e\u51fa\u8fd9\u4e2a\u9012\u63a8\u5f0f\uff0c\u5229\u7528\u4f18\u5316\u7684\u7ebf\u6027\u9012\u63a8\u7b97\u6cd5\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\Theta(k^2 \\log n)$ \u6216 $\\Theta(k \\log k \\log n)$\u3002\n\n[\u63d0\u4ea4\u8bb0\u5f55](https://www.luogu.com.cn/record/22823640)\n****\n#### \u80fd\u4e0d\u80fd\u7ed9\u529b\u4e00\u70b9\u554a\uff1f\n\n\u7b2c\u4e8c\u6b21\u770b\u8fd9\u9898\u7684\u65f6\u5019\uff0c\u5df2\u7ecf\u5b66\u4e60\u4e86 [\u8fd9\u9898](https://www.luogu.com.cn/problem/P5320)  EI \u7684\u7279\u5f81\u6839\u6027\u8d28\u4f18\u5316\u505a\u6cd5\uff08orz EI\uff01\uff09\uff0c\u4e0b\u9762\u505a\u8be6\u7ec6\u8bb2\u89e3\u3002\n\n\u8bbe\n$$A=\\frac{1}{\\sqrt 5} \\ , \\ \\alpha=\\frac{1+\\sqrt 5}{2}$$\n\u5219\n$$\\prod_{i=n}^{n+k-1}f_i=\\prod_{i=0}^{k-1}(A\\alpha^{n+i}-A(-\\alpha)^{-n-i})$$\n$$=A^k\\prod_{i=0}^{k-1}(\\alpha^n\\alpha^i-(-\\alpha)^{-n}(-\\alpha)^{-i})$$\n$$=A^k \\alpha^{k(k-1)/2} \\prod_{i=0}^{k-1}(\\alpha^n-(-\\alpha)^{-n}(-\\alpha^{-2})^i)$$\n\u5206\u7c7b\u8ba8\u8bba\u4e00\u4e0b $n$ \u7684\u5947\u5076\u6027\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u80fd\u770b\u6210\u662f**\u5173\u4e8e $\\alpha^n$ \u7684**\u4e00\u4e2a $k$ \u6b21\u591a\u9879\u5f0f\u3002  \n\n\u518d\u7528 $x$ \u6765\u4ee3\u6362\u5c31\u6709\u4e24\u4e2a\u591a\u9879\u5f0f\uff1a\n$$\\frac{A^k\\alpha^{k(k-1)/2}}{x^k}\\prod_{i=0}^{k-1}(x^2-(-\\alpha^{-2})^i) \\ \\ (n \\bmod 2 = 0)$$\n$$\\frac{A^k\\alpha^{k(k-1)/2}}{x^k}\\prod_{i=0}^{k-1}(x^2+(-\\alpha^{-2})^i) \\ \\ (n \\bmod 2 = 1)$$\n\u8bbe\u8fd9\u4e24\u4e2a\u591a\u9879\u5f0f\u7684 $n$ \u6b21\u9879\u7cfb\u6570\u5206\u522b\u4e3a $p_n,q_n$\uff0c\u7b54\u6848\u5c31\u662f\uff1a\n$$\\left(\\sum_{i=m}^n[2|i]\\sum_{j=-k}^kp_j \\alpha^{ij}\\right)+\\left(\\sum_{i=m}^n[2|(i-1)]\\sum_{j=-k}^kq_j\\alpha^{ij} \\right)$$\n$$=\\frac 12\\sum_{j=-k}^k\\left((p_j+q_j)\\sum_{i=m}^n\\alpha^{ji}\\right)+\\left( (p_j-q_j)\\sum_{i=m}^n(-\\alpha^j)^i\\right)$$\n\u8fd8\u6709\u4e00\u70b9\u5e38\u6570\u4f18\u5316\uff0c\u5c31\u662f $p_n=(-1)^{k-n}q_n$\uff0c\u6c42\u51fa $q$ \u540e\u5c31\u53ef\u4ee5\u76f4\u63a5\u6c42\u51fa $p$\u3002\n\n\u73b0\u5728\u8003\u8651\u5982\u4f55\u6c42\u51fa\u90a3\u4e24\u4e2a\u591a\u9879\u5f0f\u7684\u7cfb\u6570\uff0c\u53ea\u8003\u8651\u540e\u9762\u90a3\u4e2a\u4e58\u79ef\uff0c\u662f\u8fd9\u6837\u4e00\u4e2a\u5f62\u5f0f\uff1a\n$$f(x)=\\prod_{i=0}^{k-1}(x+\\beta^i)$$\n\uff08\u867d\u7136\u539f\u5f0f\u4e2d\u662f $x^2$\uff0c\u4f46\u662f\u6ca1\u6709\u5173\u7cfb\uff0c\u7b97\u51fa\u8fd9\u4e2a\u540e\u7b2c $n$ \u9879\u5bf9\u5e94\u539f\u5f0f $2n$ \u9879\u3002\uff09 \n\n\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u500d\u589e\u5904\u7406\uff0c\u4ee5 $\\Theta(k \\log k)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u6c42\u51fa\u7cfb\u6570 \u2014\u2014 \u4e0d\u8fc7\u8fd9\u662f\u4e0d\u5fc5\u8981\u7684\uff0c\u5b83\u6ee1\u8db3\u5178\u578b\u7684 **q-\u6574\u5f0f\u9012\u63a8**\uff0c\u6211\u4eec\u8fd9\u6837\u64cd\u4f5c\uff1a\n\n$$f(\\beta x)= \\beta^k \\prod_{i=0}^{k-1}(x+\\beta^{i-1})=\\beta^k \\frac{x+\\beta^{-1}}{x+\\beta^{k-1}}f(x)$$\n$$(x+\\beta^{k-1})f(\\beta x)=\\beta^k(x+\\beta^{-1})f(x)$$\n\u63d0\u53d6\u7cfb\u6570\u5373\u5f97\n$$\\beta^{i-1}f_{i-1}+\\beta^{k+i-1}f_i=\\beta^kf_{i-1}+\\beta^{k-1}f_i$$\n$$f_{i-1}= \\frac{\\beta^{k-1}-\\beta^{k+i-1}}{\\beta^{i-1}-\\beta^k}f_i$$\n\u4ece\u4e0a\u8fb9\u754c $f_k=1$ \u5f80\u4e0b\u9012\u63a8\u5373\u53ef\uff0c\u7ebf\u6027\u5904\u7406\u9006\u5143\u5373\u53ef $\\Theta(k)$ \u6c42\u51fa $f(x)$ \u7684\u7cfb\u6570\u3002\u7edf\u8ba1\u7b54\u6848\u7684\u90e8\u5206\u6d89\u53ca\u7b49\u6bd4\u6570\u5217\u6c42\u548c\uff0c\u53ef\u4ee5\u53ea\u8ba1\u7b97\u5e38\u6570\u6b21\u5feb\u901f\u5e42\uff0c\u5176\u4f59\u90fd\u80fd\u7ebf\u6027\u5904\u7406\u3002\n\n\u5f53\u7136\uff0c\u4f60\u4f1a\u53d1\u73b0\u8ba1\u7b97\u5feb\u901f\u5e42\u65f6\u53ea\u6709\u4e24\u6b21\u6307\u6570\u7279\u522b\u5927\uff0c\u800c\n$$a_n =\\alpha^n \\bmod p$$\n\u663e\u7136\u662f\u6709\u5faa\u73af\u8282\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u628a\u6307\u6570\u5bf9 $4p(p+1)$ \u53d6\u6a21\u518d\u8ba1\u7b97\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\Theta(k +\\log n)$\u3002\n\n****\n\n\u53c2\u8003\u4ee3\u7801\uff08\u7a0d\u5fae\u6539\u6539\u53c2\u6570\u5c31\u80fd\u76f4\u63a5\u901a\u8fc7\u52a0\u5f3a\u7248\uff09\uff1a  \n\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#define N 20003\n#define ll long long\n#define p 1000000007\nusing namespace std;\n\ninline int add(const int& x,const int& y){ return x+y>=p?x+y-p:x+y; }\ninline int dec(const int& x,const int& y){ return x<y?x-y+p:x-y; }\n\ninline int intpow(int a,int t){\n    int res = 1;\n    while(t){\n        if(t&1) res = (ll)res*a%p;\n        a = (ll)a*a%p;\n        t >>= 1;\n    }\n    return res;\n}\n\nstruct complex{\n    int r,i;\n    inline complex(int _r=0,int _i=0):r(_r),i(_i){}\n};\n\ninline complex operator + (const complex& lhs,const complex& rhs){ return complex(add(lhs.r,rhs.r),add(lhs.i,rhs.i)); }\ninline complex operator - (const complex& lhs,const complex& rhs){ return complex(dec(lhs.r,rhs.r),dec(lhs.i,rhs.i)); }\ninline complex operator * (const complex& lhs,const complex& rhs){ return complex(((ll)lhs.r*rhs.r+5ll*lhs.i*rhs.i)%p,((ll)lhs.r*rhs.i+(ll)lhs.i*rhs.r)%p); }\ninline complex operator - (const complex& x){ return complex(dec(0,x.r),dec(0,x.i)); }\ninline complex operator * (const complex& lhs,const int& rhs){ return complex((ll)lhs.r*rhs%p,(ll)lhs.i*rhs%p); } \nconst complex one = complex(1,0);\n\ninline complex power(complex a,ll t){\n    complex res = complex(1,0);\n    while(t){\n        if(t&1) res = res*a;\n        a = a*a;\n        t >>= 1;\n    }\n    return res;\n}\n\ninline complex inverse(complex x){\n    int d = ((ll)x.r*x.r-5ll*x.i*x.i%p+p)%p;\n    return complex(x.r,p-x.i)*intpow(d,p-2);\n}\n\ncomplex pre[N>>1];\n\nvoid product(int k,complex q,complex *t){\n    t[k] = 1;\n    static complex pw[N];\n    pw[0] = pre[0] = one;\n    for(int i=1;i<=k;++i) pw[i] = pw[i-1]*q;\n    for(int i=1;i<=k;++i) pre[i] = pre[i-1]*(pw[k]-pw[i-1]);\n    complex Inv = inverse(pre[k]),suf = one;\n    for(int i=k;i;--i){\n        t[i-1] = pw[k-1]*(pw[i]-one)*(Inv*pre[i-1]*suf)*t[i];\n        suf = suf*(pw[k]-pw[i-1]);\n    }\n}\n\nchar L[N],R[N];\nint k;\ncomplex f[N],g[N],inv1[N>>1],inv2[N>>1],suf[N>>1];\nconst int ninv2 = p-(p-1)/2;\nconst ll md = 4ll*p*(p+1);\nconst __int128_t ten = 10;\n\nint main(){\n    scanf(\"%d\",&k);\n    scanf(\"%s%s\",L,R);\n    int lenl = strlen(L),lenr = strlen(R),lmdp = 0,rmdp = 0;\n    ll pwl = 0,pwr = 0;\n    for(int i=0;i<lenl;++i) lmdp = (lmdp*10ll+L[i]-'0')%p,pwl = (pwl*ten+L[i]-'0')%md;\n    for(int i=0;i<lenr;++i) rmdp = (rmdp*10ll+R[i]-'0')%p,pwr = (pwr*ten+R[i]-'0')%md;\n    reverse(L,L+lenl),reverse(R,R+lenr);\n    int inv5 = intpow(5,p-2);\n    complex alpha = complex(ninv2,ninv2),A = complex(0,inv5);\n    complex iva = inverse(alpha),q,beta,ans = 0,a2 = alpha*alpha;\n    q = power(iva,k),beta = -iva*iva;\n    product(k,beta,g);\n    for(int i=0;i<=k;++i) f[i] = (k-i)&1?-g[i]:g[i];\n    complex pal = power(alpha,pwl),par = power(alpha,pwr+1);\n    complex pa2l = pal*pal,pa2r = par*par,pql = power(inverse(pal),k),pqr = power(inverse(par),k);\n    complex pali = one,pari = one,qs,nqs,npql = (L[0]&1)?-pql:pql,npqr = (R[0]&1)?pqr:-pqr;\n    inv1[0] = q,inv2[0] = q+one;\n    for(int i=1;i<=k;++i){\n        inv1[i] = inv1[i-1]*a2;\n        inv2[i] = inv1[i]+one;\n    }\n    for(int i=0;i<=k;++i) inv1[i] = inv1[i]-one;\n    if(!(k&1)) inv1[k>>1] = one;\n    pre[0] = suf[k+1] = one;\n    inv1[0] = inverse(inv1[0]);\n    for(int i=1;i<=k;++i) pre[i] = pre[i-1]*inv1[i];\n    for(int i=k;i;--i) suf[i] = suf[i+1]*inv1[i];\n    complex mul = inverse(pre[k]);\n    for(int i=1;i<=k;++i) inv1[i] = pre[i-1]*suf[i+1]*mul;\n    inv2[0] = inverse(inv2[0]);\n    for(int i=1;i<=k;++i) pre[i] = pre[i-1]*inv2[i];\n    for(int i=k;i;--i) suf[i] = suf[i+1]*inv2[i];\n    mul = inverse(pre[k]);\n    for(int i=1;i<=k;++i) inv2[i] = pre[i-1]*suf[i+1]*mul;\n    for(int i=0;i<=k;++i){\n        if(q.r==1&&q.i==0) qs = dec(rmdp+1,lmdp);\n        else qs = (pqr*pari - pql*pali)*inv1[i];\n        nqs = (npqr*pari - npql*pali)*inv2[i];\n        ans = ans + (f[i]+g[i])*qs - (f[i]-g[i])*nqs;\n        pali = pali*pa2l,pari = pari*pa2r;\n        q = q*a2;\n    }\n    ans = ans*power(A,k)*power(alpha,k*(k-1)>>1)*ninv2;\n    printf(\"%d\",ans.r);\n    return 0;   \n}\n```\n\n****\n\n\u5173\u4e8e\u300c\u80fd\u4e0d\u80fd\u518d\u7ed9\u529b\u4e00\u70b9\u554a\uff1f\u300d\u8fd9\u4e2a\u95ee\u9898\uff0c\u6211\u5bf9 q-\u6574\u5f0f\u9012\u63a8 \u8fd8\u4e0d\u751a\u4e86\u89e3\uff0c\u5c31\u4e0d\u5984\u8bae\u4e86\u3002\u5982\u679c\u54ea\u5929\u590d\u6742\u5ea6\u518d\u6709\u4f18\u5316\uff0c\u8fd8\u4f1a\u56de\u6765\u8865\u7684\uff08",
        "postTime": 1565781795,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5126 \u3010\u9b3c\u6545\u4e8b\u3011"
    },
    {
        "content": "\u597d\u50cf\u6709\u4eba\u6ca1\u6709\u7528\u77e9\u9635\u5feb\u901f\u5e42AC\u4e86\u2026\u2026\u8fd9\u91cc\u53ea\u662f\u53c2\u8003\u89e3\u7b54\uff0c\u975e\u6700\u4f18\u89e3\u3002\n\n**\u9898\u610f\uff1a\u5b9a\u4e49\u4e00\u4e2a\u65b0\u6570\u5217$b$\uff0c$b_i=a_ia_{i+1}...a_{i+K-1}$\uff0c\u4e5f\u5c31\u662f\u4ece\u7b2c$i$\u9879\u5f00\u59cb\u8fde\u7eed$K$\u4e2a\u6590\u6ce2\u62c9\u5951\u6570\u5217\u9879\u4e4b\u79ef\uff0c\u6c42\u7b2c$M$\u4e2a\u5230\u7b2c$N$\u4e2a$b_i$\u7684\u548c\u3002**\n\n## \u5bf9\u4e8e$5\\%$\u6570\u636e\uff08$data\\space1$\uff09\uff1a\n\n\u66b4\u529b\u679a\u4e3e\uff0c\u4e0d\u7528\u591a\u8bf4\n\n## \u5bf9\u4e8e$10\\%$\u6570\u636e\uff08$data\\space1,2$\uff09\uff1a\n\n\u6ce8\u610f\u5230\u8fd9\u4e00\u90e8\u5206\u6570\u636e\u4e2d\uff0c$N-M<=10^6$\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5148\u7528\u77e9\u9635\u5feb\u901f\u5e42\u5f97\u5230\u6590\u6ce2\u62c9\u5951\u6570\u5217\u7684\u7b2c$M$\u9879\uff0c\u7136\u540e\u518d\u4ece$M$\u5230$N$\u679a\u4e3e\u5f97\u5230\u7b54\u6848\u3002\n\n## \u5bf9\u4e8e$20\\%$\u6570\u636e\uff08$data\\space1,2,5,6$\uff09\uff1a\n\n$N-M<=10^6$\u4ecd\u7136\u4fdd\u7559\uff0c\u53ea\u4e0d\u8fc7$N,M$\u8d85\u51fa\u4e86$long long$\u8868\u793a\u7684\u8303\u56f4\uff0c\u6240\u4ee5\u6211\u4eec\u7528\u9ad8\u7cbe\u5ea6\u8868\u793a$N,M$,\u505a\u6cd5\u540c$data\\space1,2$\u3002\n\n## \u5bf9\u4e8e\u53e6\u5916\u4e00\u79cd$20\\%$\u6570\u636e\uff08$data\\space1,2,3,4$\uff09\uff1a\n\n\u6613\u77e5\u6b64\u9898\u9700\u8981\u7528\u77e9\u9635\u5feb\u901f\u5e42\u505a\uff0c\u95ee\u9898\u5c31\u5728\u4e8e\u5982\u4f55\u6784\u9020\u77e9\u9635\u3002\n\n\u9898\u76ee\u8981\u6c42\u7684\u5373$s_N-s_{M-1}$\uff0c\u5176\u4e2d$s_n=\\sum_{i=1}^{n}b_i$\u3002\u95ee\u9898\u8f6c\u5316\u4e3a\u5982\u4f55\u6c42$s_n$\u3002\n\n\u56e0\u4e3a$K=4$,\u6240\u4ee5$s_n=s_{n-1}+a_na_{n+1}a_{n+2}a_{n+3}$\u3002\u7531\u4e8e\u51fa\u9898\u4eba\u6700\u5f00\u59cb\u7684\u8bbe\u5b9a\u662f$S_n=S_{n-1}+a_na_{n-1}a_{n-2}a_{n-3}$\uff0c\u4e3a\u4e86\u65b9\u4fbf\u51fa\u9898\u4eba\u5199\u9898\u89e3\uff0c\u6211\u4eec\u5728\u8fd9\u91cc\u6c42$S_n$\uff08$s_n=S_{n+3}$\uff0c\u5f88\u5bb9\u6613\u8f6c\u6362\uff09\u3002\n\n\u6709$S_n=S_{n-1}+a_na_{n-1}a_{n-2}a_{n-3}$\uff0c\u800c\u5b66\u8fc7\u77e9\u9635\u5feb\u901f\u5e42\u7684\u540c\u5b66\u80af\u5b9a\u77e5\u9053$S_{n-1}$\u5f88\u5bb9\u6613\u5904\u7406\uff0c\u5173\u952e\u95ee\u9898\u5c31\u5728\u4e8e\u5982\u4f55\u5904\u7406$a_na_{n-1}a_{n-2}a_{n-3}$\u3002\n\n\u56e0\u4e3a\u77e9\u9635\u5feb\u901f\u5e42\u4e2d\u7684\u5355\u4f4d\u77e9\u9635\u53ea\u5305\u542b\u5e38\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u60f3\u529e\u6cd5\u628a$a_na_{n-1}a_{n-2}a_{n-3}$\u8868\u793a\u6210\u82e5\u5e72\u4e2a**\u591a\u9879\u5f0f$\\times$\u5e38\u6570**\u4e4b\u548c\u7684\u5f62\u5f0f\u3002\n\n\u5c06$a_na_{n-1}a_{n-2}a_{n-3}$\u62c6\u5206\u3002$a_na_{n-1}a_{n-2}a_{n-3}=(a_{n-1}+a_{n-2})a_{n-1}a_{n-2}a_{n-3}=a_{n-1}^2a_{n-2}a_{n-3}+a_{n-1}a_{n-2}^2a_{n-3}$\u3002\u540c\u7406\uff0c\u5c06$a_{n-1}$\u62c6\u6210$a_{n-2}+a_{n-3}$\uff1a$a_{n-1}^2a_{n-2}a_{n-3}+a_{n-1}a_{n-2}^2a_{n-3}=2a_{n-2}a_{n-3}^3+3a_{n-2}^2a_{n-3}^2+a_{n-2}a_{n-3}^3$\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u8bbe$b_n=a_n^3a_{n-1},c_n=a_n^2a_{n-1}^2,d_n=a_na_{n-1}^3$\uff0c\u5219$a_na_{n-1}a_{n-2}a_{n-3}=2b_{n-2}+3c_{n-2}+d_{n-2}$\u3002\n\n\u65e2\u7136\u6709\u4e86\u4e0a\u9762\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u6211\u4eec\u5c31\u8981\u60f3\u529e\u6cd5\u628a$b_{n-2},c_{n-2},d_{n-2}$\u8868\u793a\u51fa\u6765\u3002\u9996\u5148\u662f$b_{n-2}$\uff1a\n\n$$b_{n-2}=a_{n-2}^3a_{n-3}=(a_{n-3}+a_{n-4})^3a_{n-3}$$\n\n$$=a_{n-3}^4+3a_{n-3}^3a_{n-4}+3a_{n-3}^2a_{n-4}^2+a_{n-3}a_{n-4}^3$$\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u8bbe$e_n=a_n^4$\uff0c\u5219$b_{n-2}=e_{n-3}+3b_{n-3}+3c_{n-3}+d_{n-3}$\u3002\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u662f\u53ef\u4ee5\u7528\u77e9\u9635\u4e58\u6cd5\u5b9e\u73b0\u7684\uff01\n\n\u540c\u7406\u6709\uff1a\n\n$$c_{n-2}=e_{n-3}+2b_{n-3}+c_{n-3}$$\n\n$$d_{n-2}=e_{n-2}+b_{n-3}$$\n\n$$e_{n-2}=e_{n-3}+4b_{n-3}+6c_{n-3}+4d_{n-3}+e_{n-4}$$\n\n\u81f3\u6b64\uff0c$b_{n-2},c_{n-2},d_{n-2},e_{n-2}$\u5c31\u5168\u90e8\u88ab\u6211\u4eec\u8868\u793a\u51fa\u6765\u4e86\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u53d1\u73b0\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u8fd9\u6837\u7684\u4e00\u4e2a\u77e9\u9635\uff1a\n\n$$\\begin{pmatrix}1&?&?&?&?&0\\\\0&3&3&1&1&0\\\\0&2&1&0&1&0\\\\0&1&0&0&1&0\\\\0&4&6&4&1&1\\\\0&0&0&0&1&0\\end{pmatrix}\\times \\begin{pmatrix}S_{n-1}\\\\b_{n-3}\\\\c_{n-3}\\\\d_{n-3}\\\\e_{n-3}\\\\e_{n-4}\\end{pmatrix}=\\begin{pmatrix}S_{n}\\\\b_{n-2}\\\\c_{n-2}\\\\d_{n-2}\\\\e_{n-2}\\\\e_{n-3}\\end{pmatrix}$$\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8fbe\u5230\u77e9\u9635\u5feb\u901f\u5e42\u53ef\u4ee5\u8fdb\u884c\u7684\u8981\u6c42\u4e86\u3002\n\n\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u5c31\u662f\u90a3\u51e0\u4e2a$?$\u586b\u4ec0\u4e48\u3002\u56e0\u4e3a$S_n=S_{n-1}+a_na_{n-1}a_{n-2}a_{n-3}=S_{n-1}+2b_{n-2}+3c_{n-2}+d_{n-2}$\uff0c\u4f46\u6211\u4eec\u6ca1\u6709\u76f4\u63a5\u7684$b_{n-2},c_{n-2},d_{n-2}$\uff0c\u53ea\u6709$b_{n-3},c_{n-3},d_{n-3},e_{n-3}$\uff0c\u4f46\u662f\u6211\u4eec\u6709\u4e4b\u524d\u63a8\u51fa\u7684\u5f0f\u5b50\u53ef\u4ee5\u8868\u793a$b_{n-2},c_{n-2},d_{n-2}$\u4e0e$b_{n-3},c_{n-3},d_{n-3},e_{n-3}$\u7684\u5173\u7cfb\uff0c\u6240\u4ee5\u6211\u4eec\u5c06\u8fd9\u51e0\u4e2a\u5f0f\u5b50\u4ee3\u5165\u56de$S_n=S_{n-1}+2b_{n-2}+3c_{n-2}+d_{n-2}$\uff0c\u5f97\u5230$S_n=S_{n-1}+13b_{n-3}+9c_{n-3}+2d_{n-3}+6e_{n-3}$\u3002\u6240\u4ee5\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a\u5b8c\u6574\u7684\u5f0f\u5b50\uff1a\n\n$$\\begin{pmatrix}1&13&9&2&6&0\\\\0&3&3&1&1&0\\\\0&2&1&0&1&0\\\\0&1&0&0&1&0\\\\0&4&6&4&1&1\\\\0&0&0&0&1&0\\end{pmatrix}\\times \\begin{pmatrix}S_{n-1}\\\\b_{n-3}\\\\c_{n-3}\\\\d_{n-3}\\\\e_{n-3}\\\\e_{n-4}\\end{pmatrix}=\\begin{pmatrix}S_{n}\\\\b_{n-2}\\\\c_{n-2}\\\\d_{n-2}\\\\e_{n-2}\\\\e_{n-3}\\end{pmatrix}$$\n\n\u6240\u4ee5\n\n$$\\begin{pmatrix}1&13&9&2&6&0\\\\0&3&3&1&1&0\\\\0&2&1&0&1&0\\\\0&1&0&0&1&0\\\\0&4&6&4&1&1\\\\0&0&0&0&1&0\\end{pmatrix}^{n-4}\\times \\begin{pmatrix}S_{4}\\\\b_{2}\\\\c_{2}\\\\d_{2}\\\\e_{2}\\\\e_{1}\\end{pmatrix}=\\begin{pmatrix}S_{n}\\\\...\\\\...\\\\...\\\\...\\\\...\\end{pmatrix}$$\n\n\u56de\u5230\u4e00\u5f00\u59cb\uff0c$s_n=S_{n+3}$\uff0c\u6240\u4ee5\uff1a\n\n$$\\begin{pmatrix}1&13&9&2&6&0\\\\0&3&3&1&1&0\\\\0&2&1&0&1&0\\\\0&1&0&0&1&0\\\\0&4&6&4&1&1\\\\0&0&0&0&1&0\\end{pmatrix}^{n-1}\\times \\begin{pmatrix}s_{1}\\\\b_{2}\\\\c_{2}\\\\d_{2}\\\\e_{2}\\\\e_{1}\\end{pmatrix}=\\begin{pmatrix}s_{n}\\\\...\\\\...\\\\...\\\\...\\\\...\\end{pmatrix}$$\n\n\u5373\uff1a\n\n$$\\begin{pmatrix}1&13&9&2&6&0\\\\0&3&3&1&1&0\\\\0&2&1&0&1&0\\\\0&1&0&0&1&0\\\\0&4&6&4&1&1\\\\0&0&0&0&1&0\\end{pmatrix}^{n-1}\\times \\begin{pmatrix}6\\\\1\\\\1\\\\1\\\\1\\\\1\\end{pmatrix}=\\begin{pmatrix}s_{n}\\\\...\\\\...\\\\...\\\\...\\\\...\\end{pmatrix}$$\n\n## \u5bf9\u4e8e$30\\%$\u6570\u636e\uff08$data\\space1,2,3,4,5,6$\uff09\uff1a\n\n\u52a0\u4e00\u4e2a\u9ad8\u7cbe\u5ea6\u5c31\u53ef\u4ee5\u4e86\u3002\n\n## \u5bf9\u4e8e$50\\%$\u6570\u636e\uff08$data\\space1,2,3,4,5,6,7,8,9,10$\uff09\uff1a\n\n\u538b\u4f4d\u9ad8\u7cbe\u3002\u538b$17$\u4f4d\u53ef\u4ee5\u901a\u8fc7\u6b64\u90e8\u5206\u6570\u636e\u3002\n\n## \u5bf9\u4e8e$40\\%$\u6570\u636e\uff08$data\\space1,2,3,4,5,6,13,14$\uff09\uff1a\n\n\u5206$9$\u79cd\u60c5\u51b5\u8ba8\u8bba\u2026\u2026\n\n\u5bf9\u4e8e\u6bcf\u4e00\u79cd\u60c5\u51b5\uff0c\u6c42\u51fa\u5bf9\u5e94\u7684\u77e9\u9635\u3002\n\n**\u4ece\u51fa\u9898\u4eba\u5fc3\u7406\u89d2\u5ea6\u5165\u624b\uff1a**\n\n$K$\u80af\u5b9a\u8d8a\u5927\u8d8a\u597d\uff0c\u6240\u4ee5\u53ea\u7528\u8ba1\u7b97$K=8,9,10$\u7684\u60c5\u51b5\u5373\u53ef\u3002\n\n\u7528\u666e\u901a\u9ad8\u7cbe\u5ea6\u5373\u53ef\uff08\u5176\u5b9e$data\\space11,12$\uff09\u7528\u5e38\u6570\u5c0f\u4e00\u70b9\u7684\u4e0d\u538b\u4f4d\u9ad8\u7cbe\u5ea6\u4e5f\u53ef\u4ee5\u901a\u8fc7\u3002\n\n## \u5bf9\u4e8e$70\\%$\u6570\u636e\uff08$data\\space1\\sim14$\uff09\uff1a\n\n\u7528\u538b\u4f4d\u9ad8\u7cbe\u5206$9$\u79cd\u60c5\u51b5\u8ba8\u8bba\u3002\n\n# \u5bf9\u4e8e$100\\%$\u6570\u636e\uff1a\n\n~~\u520649\u7c7b\u8ba8\u8bba~~\n\n\u56e0\u4e3a\u5206\u7c7b\u8ba8\u8bba\u8fc7\u4e8e\u590d\u6742\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u627e\u5230\u4e00\u4e2a\u4e00\u822c\u7684\u6c42\u5355\u4f4d\u77e9\u9635\u7b97\u6cd5\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u53ea\u6709$a_n^m,a_n^{m-1}a_{n-1}^1,a_n^{m-2}a_{n-1}^2,...,a_n^1a_{n-1}^{m-1}$\u4e0e\u5b83\u4eec\u7684\u4e0a\u4e00\u9879\u6709\u4e92\u63a8\u5173\u7cfb\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u7528\u8fd9\u4e9b\u9879\u6765\u8868\u793a$s_n$\uff0c\u5c31\u5982\u4e4b\u524d\u6211\u4eec\u6c42$K=4$\u65f6\u95ee\u53f7\u586b\u4ec0\u4e48\u4e00\u6837\u3002\n\n## _\u5982\u679c\u8fd9\u4e00\u90e8\u5206\u7406\u89e3\u6709\u56f0\u96be\uff0c\u53ef\u4ee5\u7ed3\u5408$K=4$\u7684\u90e8\u5206\u4e00\u8d77\u770b_\n\n**\u7b2c\u4e00\u6b65**\uff1a\u6c42$a_n^m,a_n^{m-1}a_{n-1}^1,a_n^{m-2}a_{n-1}^2,...,a_n^1a_{n-1}^{m-1}$\u4e0e\u5b83\u4eec\u7684\u4e0a\u4e00\u9879\u7684\u9012\u63a8\u5f0f\n\n\u4f8b\u5982\uff0c\u6211\u4eec\u8981\u6c42$a_n^{k}a_{n-1}^{m-k}$\u7684\u9012\u63a8\u5f0f\u3002\u6309\u7167\u5957\u8def\uff0c\u6709$a_n^{k}a_{n-1}^{m-k}=(a_{n-1}+a_{n-2})^ka_{n-1}^{m-k}$\u3002\u7531\u4e8c\u9879\u5f0f\u5b9a\u7406\uff0c\u4e0a\u5f0f\u7b49\u4e8e$C_k^0a_{n-1}^m+C_k^1a^{m-1}_{n-1}a_{n-2}+...+c_k^ka_{n-1}^{m-k}a_{n-2}^k$\u3002\n\u4e8e\u662f\uff0c\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u6768\u8f89\u4e09\u89d2\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$a_n^{k}a_{n-1}^{m-k}$\u5355\u72ec\u8ba1\u7b97\u5373\u53ef\u3002\u6211\u4eec\u79f0\u8fd9\u4e9b\u6c42\u51fa\u6765\u7684\u9012\u63a8\u5f0f\u4e3a**\u90a3\u4e00\u5806\u5f0f\u5b50**\u2026\u2026\uff08\u5982$K=4$\u4e2d\u7684$b_{n-2}=e_{n-3}+3b_{n-3}+3c_{n-3}+d_{n-3},c_{n-2}=e_{n-3}+2b_{n-3}+c_{n-3},d_{n-2}=e_{n-2}+b_{n-3},e_{n-2}=e_{n-3}+4b_{n-3}+6c_{n-3}+4d_{n-3}+e_{n-4}$\uff09\n\n**\u7b2c\u4e8c\u6b65**\uff1a\u6c42$a_na_{n-1}...a_{n-k+1}$\u4e0e$a_n^m,a_n^{m-1}a_{n-1}^1,a_n^{m-2}a_{n-1}^2,...,a_n^1a_{n-1}^{m-1}$\u7684\u5173\u7cfb\u5f0f\u3002\n\n\u540c\u6837\u6211\u4eec\u62c6\u5206$a_na_{n-1}...a_{n-k+1}$\u3002\u5728\u6b64\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u8bc1\u660e\u4e00\u4e2a\u4e1c\u897f\u3002\n\n\u6c42\u8bc1\uff1a$a_n=a_{k+1}a_{n-k}+a_{k}a_{n-(k+1)}$\n\n\u8bc1\u660e\uff1a\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bc1\u660e\n\n1. \u5f53$k=1$\u65f6\uff0c\u5373\u8bc1$a_n=1a_{n-1}+1a_{n-2}$\uff0c\u663e\u7136\u6210\u7acb\n\n2. \u5047\u8bbe$k=s(s>=1)$\u65f6\uff0c$a_n=a_ka_{n-k}+a_{k+1}a_{n-(k+1)}$\u6210\u7acb\uff0c\u5219$$a_{s+1}a_{n-s}+a_{s}a_{n-(s+1)}=a_{s+1}(a_{n-(s+1)}+a_{n-(s+2)})+a_{s}a_{n-(s+1)}$$$$=a_{n-(s+1)}(a_{s+1}+a_s)+a_{n-(s+2)}a_{s+1}=a_{s+2}a_{n-(s+1)}+a_{s+1}a_{n-(s+2)}$$\uff0c\u5373$k=s+1$\u65f6\u547d\u9898\u6210\u7acb\n\n3. \u7efc\u4e0a\uff1a\u547d\u9898\u6210\u7acb\n\n\u65e2\u7136\u6709\u8fd9\u4e2a\u7ed3\u8bba\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230$a_na_{n-1}...a_{n-k+1}=(a_{k-1}a_{n-k+2}+a_{k-2}a_{n-k+1})(a_{k-2}a_{n-k+2}+a_{k-3}a_{n-k+1})...(a_2a_{n-k+2}+a_1a_{n-k+1})a_{n-k+2}a_{n-k+1})$\u3002\u89c2\u5bdf\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u53d1\u73b0\u5b83\u662f\u7531\u5f88\u591a\u4e2a\u7c7b\u4f3c\u4e8e$(a_{k-1}a_{n-k+2}+a_{k-2}a_{n-k+1})$\u7684\u591a\u9879\u5f0f\u7ec4\u6210\u7684\uff0c\u6211\u4eec\u79f0\u8fd9\u6837\u7684\u62ec\u53f7\u4e3a\u4e00\u4e2a\u5355\u4f4d\u591a\u9879\u5f0f\uff0c$a_{k-1},a_{k-2}$\u4e3a\u4e00\u4e2a\u5355\u4f4d\u591a\u9879\u5f0f\u7684\u4e24\u4e2a\u7cfb\u6570\u3002\n\n\u73b0\u5728\uff0c\u6211\u4eec\u7684\u76ee\u6807\u5c31\u662f\u6c42\u51fa\u8fd9\u4e2a\u5f0f\u5b50\u5c55\u5f00\u540e\u6bcf\u4e00\u9879\u7684\u7cfb\u6570\u662f\u591a\u5c11\u3002\u6211\u4eec\u8003\u8651\u7528\u7c7b\u4f3c\u4e8e\u6c42\u6768\u8f89\u4e09\u89d2\u7684\u65b9\u6cd5\u6c42\u6bcf\u4e00\u9879\u7684\u7cfb\u6570\u3002\n\n\u82e5$K=3$\uff0c\u5219\u539f\u5f0f$=(a_{n-1}+a_{n-2})a_{n-1}a_{n-2}$\uff0c\u5373$a_{n-1}^2a_{n-2}+a_{n-1}a_{n-2}^2$\uff0c\u5373\u524d\u9762\u7684\u7cfb\u6570\u4e3a$1,1$\u3002$K=4$\u7684\u6211\u4eec\u4e4b\u524d\u5df2\u7ecf\u63a8\u5bfc\u8fc7\u4e86\uff0c\u7cfb\u6570\u4e3a$2,3,1$\u3002$K=5$\u7684\u4e3a$6,13,9,2$\u3002\u6211\u4eec\u628a\u8fd9\u4e2a\u4e09\u89d2\u5217\u51fa\u6765\uff1a\n\n$0,1,1(1,1)$\n\n$0,2,3,1(2,1)$\n\n$0,6,13,9,2(3,2)$\n\n\u6211\u4eec\u5728\u6bcf\u884c\u524d\u9762\u8865\u4e86\u4e00\u4e2a$0$\uff0c\u540e\u9762\u62ec\u53f7\u4e2d\u7684\u6570\u8868\u793a\u8fd9\u4e00\u5c42\u6240\u5bf9\u5e94\u7684\u90a3\u4e00\u4e2a\u5355\u4f4d\u591a\u9879\u5f0f\u7684\u4e24\u4e2a\u7cfb\u6570\uff0c\u6211\u4eec\u8bbe\u7b2c$i$\u5c42\u7684\u4e24\u4e2a\u7cfb\u6570\u5206\u522b\u4e3a$p1_i,p2_i$\u3002\u6211\u4eec\u53d1\u73b0$k_{i,j}$\uff0c\u5373\u7b2c$i$\u5c42\u7b2c$j$\u4e2a\u6570\u7b49\u4e8e$k_{i-1,j}p1_i+k_{i-1,j-1}p2_i$\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u7c7b\u4f3c\u4e8e\u6c42\u6768\u8f89\u4e09\u89d2\u7684\u65b9\u5f0f\u6765\u6c42\u51fa\u6bcf\u4e00\u9879\u7684\u7cfb\u6570\u4e86\u3002\n\n\u5177\u4f53\u6765\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u4ece$a_{n-1}...a_{n-k+1}=(a_{k-2}a_{n-k+2}+a_{k-3}a_{n-k+1})...(a_2a_{n-k+2}+a_1a_{n-k+1})a_{n-k+2}a_{n-k+1})$\u7684\u7cfb\u6570\u63a8\u5230$a_na_{n-1}...a_{n-k+1}=(a_{k-1}a_{n-k+2}+a_{k-2}a_{n-k+1})(a_{k-2}a_{n-k+2}+a_{k-3}a_{n-k+1})...(a_2a_{n-k+2}+a_1a_{n-k+1})a_{n-k+2}a_{n-k+1})$\u7684\u7cfb\u6570\u3002\u540e\u8005\u6bd4\u524d\u8005\u591a\u4e86\u4e00\u4e2a$(a_{k-1}a_{n-k+2}+a_{k-2}a_{n-k+1})$\uff0c\u800c$a_{k-1},a_{k-2}$\u6070\u597d\u5c31\u662f\u4e09\u89d2\u91cc\u7684$p1_i,p2_i$\u3002\u4e8e\u662f\uff0c\u7c7b\u4f3c\u4e8e\u6768\u8f89\u4e09\u89d2\u7684\u601d\u8def\uff0c\u6bcf\u4e00\u4e2a\u7cfb\u6570\u53ea\u4e0e\u5176\u4e0a\u4e00\u5c42\u540c\u6837\u4f4d\u7f6e\u7684\u6570\u4e0e\u4e0a\u4e00\u5c42\u524d\u4e00\u4f4d\u7684\u6570\u6709\u5173\u7cfb\uff1b\u800c\u7531\u4e8e\u65b0\u4e58\u4e0a\u4e86$p1_i,p2_i$\uff0c\u6bcf\u4e00\u4e2a\u7cfb\u6570\u5c31\u7b49\u4e8e\u4e0a\u4e00\u5c42\u540c\u6837\u4f4d\u7f6e\u7684\u6570\u7684$p2_i$\u500d\u4e0e\u4e0a\u4e00\u5c42\u524d\u4e00\u4f4d\u7684\u6570\u7684$p1_i$\u500d\u4e4b\u548c\uff08\u7ed3\u5408\u4e0a\u9762\u5217\u51fa\u7684\u4e09\u89d2\u5f62\u4e0e$K=4$\u7684\u60c5\u51b5\u6765\u7406\u89e3\uff09\u3002\n\n\u5f3a\u8c03\u4e00\u4e0b\uff0c\u73b0\u5728\u6c42\u51fa\u6765\u7684\u7cfb\u6570\u90fd\u662f\u5e26\u5728$a_n^m,a_n^{m-1}a_{n-1}^1,a_n^{m-2}a_{n-1}^2,...,a_n^1a_{n-1}^{m-1}$\u4e4b\u524d\u7684\u3002\n\n\u7cfb\u6570\u6c42\u51fa\u6765\u4e86\uff0c\u4f46\u8fd8\u6ca1\u6709\u5b8c\u3002\u662f\u5426\u8bb0\u5f97$K=4$\u65f6\uff0c\u5c06$2,3,1$\u6c42\u51fa\u6765\u4e4b\u540e\uff0c\u8fd8\u8981\u5206\u522b\u628a\u90a3\u4e00\u5806\u5f0f\u5b50\u4ee3\u5165\u56de\u539f\u5f0f\uff1f\u6ca1\u9519\uff0c\u6c42\u51fa\u6765\u7684\u7cfb\u6570\u8fd8\u8981\u5206\u522b\u4e58\u4e0a**\u90a3\u4e00\u5806\u5f0f\u5b50**\u7684\u7cfb\u6570\uff0c\u800c\u90a3\u4e00\u5806\u5f0f\u5b50\u6211\u4eec\u5df2\u7ecf\u6c42\u51fa\u6765\u4e86\u3002\u6240\u4ee5$a_na_{n-1}...a_{n-k+1}$\u4e0e$a_n^m,a_n^{m-1}a_{n-1}^1,a_n^{m-2}a_{n-1}^2,...,a_n^1a_{n-1}^{m-1}$\u7684\u5173\u7cfb\u6211\u4eec\u5c31\u6c42\u51fa\u6765\u4e86\u3002\u4e8e\u662f$s_n$\u4e0e$a_n^m,a_n^{m-1}a_{n-1}^1,a_n^{m-2}a_{n-1}^2,...,a_n^1a_{n-1}^{m-1}$\u7684\u5173\u7cfb\u6211\u4eec\u4e5f\u6c42\u51fa\u6765\u4e86\u3002**\u6ce8\u610f\uff0c\u8fd9\u91cc\u5199\u7684$a_n^m,a_n^{m-1}a_{n-1}^1,a_n^{m-2}a_{n-1}^2,...,a_n^1a_{n-1}^{m-1}$\u90fd\u6709\u53ef\u80fd\u8868\u793a\u7684\u662f\u6240\u6709\u5355\u9879\u5f0f\u4e0b\u89d2\u6807\u6574\u4f53\u51cf$1$\u6216$2$\u5bf9\u5e94\u7684\u4e00\u4e32\u53e6\u5916\u7684\u5355\u9879\u5f0f\uff0c\u5c31\u6bd4\u5982\u628a$a_{n-2}a_{n-3}$\u5199\u6210$a_{n}a_{n-1}$\uff0c\u56e0\u4e3a\u51fa\u9898\u4eba\u592a\u61d2\u5566\uff0c\u53ea\u4f1a\u590d\u5236\u9ecf\u8d34\uff01**\n\n\u7136\u540e\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u52a0\u4e00\u4e2a\u538b$17$\u4f4d\u7684\u9ad8\u7cbe\u5ea6\uff0c\u8fd9\u4e00\u9898\u5c31\u505a\u5b8c\u4e86\u3002\u662f\u4e0d\u662f\u5f88\u7b80\u5355\u554a\uff01\n\n\u5982\u679c\u4ecd\u6709\u4e0d\u7406\u89e3\u7684\u5730\u65b9\uff0c\u53ef\u4ee5\u7ed3\u5408\u4ee3\u7801\u7406\u89e3\u3002\n\n\u5f53\u7136\u8fd8\u53ef\u4ee5\u7528\u4e00\u4e9b\u6bd2\u7624\u7684\u65b9\u6cd5\u6765\u4f18\u5316\u9ad8\u7cbe\u5ea6\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u6bd4\u5982\u4ec0\u4e48$10$\u8fdb\u5236\u7684\u77e9\u9635\u5feb\u901f\u5e42\u4e4b\u7c7b\u7684\uff08\u4f46\u662f\u5e38\u6570\u50cf$\\pi$\u7684\u4f4d\u6570\u4e00\u6837\u5927\u7684\u51fa\u9898\u4eba\u6253\u7684$10$\u8fdb\u5236\u7684\u77e9\u9635\u5feb\u901f\u5e42TLE\u4e86\u54e6~\uff09\u3002\n\n**\u8bf7\u5927\u5bb6\u6ce8\u610f\u5e38\u6570\u4f18\u5316\uff01**\n\n\u6807\u7a0b\uff08\u8fd9\u662f\u4e00\u4efd\u52a0\u4e86\u4e00\u4e9b\u5e38\u6570\u4f18\u5316\u7684\u4ee3\u7801\uff0c\u4f46\u4ecd\u7136\u8dd1\u7684\u975e\u5e38\u6162\uff09\uff1a\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<string>\n#include<cmath>\n#include<iostream>\nusing namespace std;\nconst long long mod=1000000007,gjm=1e18;\nint k;\nstruct GJD\n{\n    long long shu[585];\n    int len;\n    GJD(){len=0;memset(shu,0,sizeof(shu));}\n}m,n,lcgjd;\nstruct JZ\n{\n    long long shu[53][53];\n    JZ(){memset(shu,0,sizeof(shu));}\n}dw,lcjz,s,lcjzjz;\nvoid mem1()\n{\n    memset(s.shu,0,sizeof(s.shu));\n    for(register int i=1;i<=110;i++)s.shu[i][i]=1;\n}\nvoid times(JZ *a,JZ *b)\n{\n    for(register int i=1;i<=k+2;i++)\n    {\n        for(register int j=1;j<=k+2;j++)\n        {\n            lcjzjz.shu[i][j]=0;\n            for(register int s=1;s<=k+2;s++)\n            {\n                lcjzjz.shu[i][j]=(lcjzjz.shu[i][j]+(*a).shu[i][s]*(*b).shu[s][j])%mod;\n            }\n        }\n    }\n    for(register int i=1;i<=k+2;i++)for(register int j=1;j<=k+2;j++)(*a).shu[i][j]=lcjzjz.shu[i][j];\n}\nlong long x;\nGJD d2(GJD &a)\n{\n    memset(lcgjd.shu,0,sizeof(lcgjd));\n    lcgjd.len=a.len;x=0;\n    for(register int i=a.len-1;i>=0;i--)\n    {\n        x=x*gjm+a.shu[i];\n        lcgjd.shu[i]=x/2;\n        x&=1;\n    }\n    while(lcgjd.len&&lcgjd.shu[lcgjd.len-1]==0)lcgjd.len--;\n    return lcgjd;\n}\nvoid j1(GJD &a)\n{\n    for(register int i=0;i<a.len;i++)\n    {\n        a.shu[i]--;\n        if(a.shu[i]>=0)break;\n        a.shu[i]+=gjm;\n    }\n    while(a.len&&a.shu[a.len-1]==0)a.len--;\n}\nchar lcm[10000],lcn[10000];\nlong long lcshu,lcshushu;\nlong long cmul[200]={0},fb[200]={0},exs[200][200]={0};\nlong long cal(GJD &a)\n{\n    if(!a.len)return 0;\n    j1(a);\n    lcjz=dw;mem1();\n    for(;a.len;a=d2(a))\n    {\n        if(a.shu[0]&1)times(&s,&lcjz);\n        times(&lcjz,&lcjz);\n    }\n    long long ans=0,b=1;\n    for(register int i=1;i<=k;i++)b=b*fb[i]%mod;\n    for(register int i=1;i<=k+1;i++)ans=(ans+s.shu[k+2][i])%mod;\n    ans=(ans+s.shu[k+2][k+2]*b)%mod;\n    return ans;\n}\nint main()\n{\n    scanf(\"%d%s%s\",&k,lcm,lcn);\n    int lclen=strlen(lcm);lcshu=0;lcshushu=1;\n    for(register int i=lclen-1;i>=0;i--)\n    {\n        lcshu=lcshu+((long long)(lcm[i]-'0'))*lcshushu;\n        lcshushu*=10;\n        if((lclen-i)%18==0)\n        {\n            m.shu[m.len]=lcshu;\n            lcshu=0;lcshushu=1;\n            m.len++;\n        }\n    }\n    if(lcshu){m.shu[m.len]=lcshu;m.len++;}\n    lclen=strlen(lcn);lcshu=0;lcshushu=1;\n    for(register int i=lclen-1;i>=0;i--)\n    {\n        lcshu=lcshu+((long long)(lcn[i]-'0'))*lcshushu;\n        lcshushu*=10;\n        if((lclen-i)%18==0)\n        {\n            n.shu[n.len]=lcshu;\n            lcshu=0;lcshushu=1;\n            n.len++;\n        }\n    }\n    if(lcshu){n.shu[n.len]=lcshu;n.len++;}\n    j1(m);\n    cmul[1]=1;fb[1]=1;\n    for(register int i=2;i<=k-1;i++)\n    {\n        fb[i]=(fb[i-1]+fb[i-2])%mod;\n        for(register int j=i;j>=1;j--)\n        {\n            cmul[j]=(cmul[j]*fb[i]+cmul[j-1]*fb[i-1])%mod;\n        }\n    }\n    fb[k]=(fb[k-1]+fb[k-2])%mod;\n    exs[1][1]=1;\n    for(register int i=2;i<=53;i++)\n    {\n        for(register int j=1;j<=i;j++)\n        {\n            exs[i][j]=(exs[i-1][j]+exs[i-1][j-1])%mod;\n        }\n    }\n    for(register int i=1;i<=k;i++)\n    {\n        for(register int j=1;j<=k+1;j++)\n        {\n            dw.shu[i][j]=exs[k-i+2][j];\n        }\n        if(i==1)continue;\n        for(register int j=1;j<=k+1;j++)\n        {\n            dw.shu[k+2][j]=(dw.shu[k+2][j]+dw.shu[i][j]*cmul[i-1])%mod;\n        }\n    }\n    dw.shu[k+1][1]=1;dw.shu[k+2][k+2]=1;\n    printf(\"%lld\\n\",((cal(n)-cal(m))%mod+mod)%mod);\n    return 0;\n}\n```\n\n\uff08\u636e\u8bf4\u539f\u6765\u7684\u6807\u7a0b\u88ab\u5361\u5e38\u4e86\u2026\u2026\uff09\n\n## PS:\n\n\u5e94\u8be5\u4e5f\u53ef\u4ee5\u7528\u6590\u6ce2\u62c9\u5951\u6570\u5217\u6a21$1000000007$\u7684\u5faa\u73af\u8282\uff08\u957f\u5ea6\u4e3a$2000000016$\uff09\u6765\u505a\u3002\u600e\u4e48\u7b97\u51fa\u6765\u7684\uff1f\u6162\u6162\u679a\u4e3e\u5c31\u53ef\u4ee5\u4e86\uff0c\u6700\u591a$20s$\u3002\u8bb0\u5f97\u4e0d\u662f\u76f4\u63a5\u53d6\u6a21\u5c31\u53ef\u4ee5\u4e86\uff0c\u8fd8\u8981\u4e58\u4e0a\u4e2d\u95f4\u88ab\u5ffd\u7565\u7684\u51e0\u5927\u5757\u3002\u8fd9\u6837\u53ef\u4ee5\u76f4\u63a5\u5ffd\u7565\u9ad8\u7cbe\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u5f71\u54cd\uff0c\u5e94\u8be5\u4f1a\u8dd1\u7684\u98de\u5feb\uff0c\u5927\u5bb6\u53ef\u4ee5\u8bd5\u4e00\u8bd5\u3002",
        "postTime": 1565148852,
        "uid": 32275,
        "name": "KesdiaelKen",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5126 \u3010\u9b3c\u6545\u4e8b\u3011"
    }
]
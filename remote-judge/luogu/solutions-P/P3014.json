[
    {
        "content": "\u4e0a\u4e00\u4e0b\u539f\u94fe\u63a5 [YoungNeal](http://www.cnblogs.com/YoungNeal/p/8504123.html)\n\n\u6211\u4eec\u5148\u6765\u79d1\u666e\u4e00\u4e0b\u5eb7\u6258\u5c55\u5f00\n## \u5b9a\u4e49\uff1a\n\n$X=an*(n-1)!+an-1*(n-2)!+...+ai*(i-1)!+...+a2*1!+a1*0!$\n\n$ai$\u4e3a\u6574\u6570\uff0c\u5e76\u4e14 $0<=ai<i$ $(1<=i<=n)$\n\n\u7b80\u5355\u70b9\u8bf4\u5c31\u662f\uff0c\u5224\u65ad\u8fd9\u4e2a\u6570\u5728\u5176\u5404\u4e2a\u6570\u5b57\u5168\u6392\u5217\u4e2d\u4ece\u5c0f\u5230\u5927\u6392\u7b2c\u51e0\u4f4d\u3002\n\n\u6bd4\u5982 $ 1 3 2 $\uff0c\u57281\u30012\u30013\u7684\u5168\u6392\u5217\u4e2d\u6392\u7b2c2\u4f4d\u3002\n## \u5eb7\u6258\u5c55\u5f00\u6709\u5565\u7528\u5462\uff1f\n\n\u7ef4\u57fa\uff1a $n$ \u4f4d\uff080~n-1\uff09\u5168\u6392\u5217\u540e\uff0c\u5176\u5eb7\u6258\u5c55\u5f00\u552f\u4e00\u4e14\u6700\u5927\u7ea6\u4e3a $n!$ \uff0c\u56e0\u6b64\u53ef\u4ee5\u7531\u66f4\u5c0f\u7684\u7a7a\u95f4\u6765\u50a8\u5b58\u8fd9\u4e9b\u6392\u5217\u3002\u7531\u516c\u5f0f\u53ef\u5c06 $X$ \u9006\u63a8\u51fa\u5bf9\u5e94\u7684\u5168\u6392\u5217\u3002\n\n\u5b83\u53ef\u4ee5\u5e94\u7528\u4e8e\u54c8\u5e0c\u8868\u4e2d\u7a7a\u95f4\u538b\u7f29\uff0c\n\n\u800c\u4e14\u5728\u641c\u7d22\u67d0\u4e9b\u7c7b\u578b\u9898\u65f6\uff0c\u5c06VIS\u6570\u7ec4\u91cf\u538b\u7f29\u3002\u6bd4\u5982\uff1a\u516b\u6570\u7801\uff0c\u9b54\u677f\u7b49\u9898\n\u5eb7\u6258\u5c55\u5f00\u6c42\u6cd5\uff1a\n\n\u6bd4\u5982 $2 1 4 3$ \u8fd9\u4e2a\u6570\uff0c\u6c42\u5176\u5c55\u5f00\uff1a\n\n\u4ece\u5934\u5224\u65ad\uff0c\u81f3\u5c3e\u7ed3\u675f,\n\n\u2460 \u6bd4 $2$\uff08\u7b2c\u4e00\u4f4d\u6570\uff09\u5c0f\u7684\u6570\u6709\u591a\u5c11\u4e2a->$1$\u4e2a \u5c31\u662f $1$ \uff0c$1*3!$\n\n\u2461 \u6bd4 $1$\uff08\u7b2c\u4e8c\u4f4d\u6570\uff09\u5c0f\u7684\u6570\u6709\u591a\u5c11\u4e2a->$0$\u4e2a $0*2!$\n\n\u2462 \u6bd4 $4$\uff08\u7b2c\u4e09\u4f4d\u6570\uff09\u5c0f\u7684\u6570\u6709\u591a\u5c11\u4e2a->$3$\u4e2a \u5c31\u662f $1,2,3$ \uff0c\u4f46\u662f $1,2$ \u4e4b\u524d\u5df2\u7ecf\u51fa\u73b0\uff0c\u6240\u4ee5\u662f $1*1!$\n\n\u5c06\u6240\u6709\u4e58\u79ef\u76f8\u52a0=7\n\n\u6bd4\u8be5\u6570\u5c0f\u7684\u6570\u67097\u4e2a\uff0c\u6240\u4ee5\u8be5\u6570\u6392\u7b2c8\u7684\u4f4d\u7f6e\u3002\n\n$1234$  $1243$  $1324$  $1342$  $1423$  $1432$   \n$2134$  $2143$  $2314$  $2341$  $2413$  $2431$  \n$3124$  $3142$  $3214$  $3241$  $3412$  $3421$  \n$4123$  $4132$  $4213$  $4231$  $4312$  $4321$  \n\n\u653e\u4e00\u4e0b\u7a0b\u5e8f\u7684\u5b9e\u73b0\n```\nint contor(int x[]){\n    int p=0;\n    for(int i=1;i<=n;i++){\n        int t=0;\n        for(int j=i+1;j<=n;j++){\n            if(x[i]>x[j]) t++;\n        }\n        p+=t*fac[n-i];\n    }\n    return p+1;\n}\n```\n## \u5eb7\u6258\u5c55\u5f00\u7684\u9006\uff1a\n\n\u5eb7\u6258\u5c55\u5f00\u662f\u4e00\u4e2a\u5168\u6392\u5217\u5230\u81ea\u7136\u6570\u7684\u53cc\u5c04\uff0c\u53ef\u4ee5\u4f5c\u4e3a\u54c8\u5e0c\u51fd\u6570\u3002\n\n\u6240\u4ee5\u5f53\u7136\u4e5f\u53ef\u4ee5\u6c42\u9006\u8fd0\u7b97\u4e86\u3002\n\n\u9006\u8fd0\u7b97\u7684\u65b9\u6cd5\uff1a\n\n\u5047\u8bbe\u6c42 $4$ \u4f4d\u6570\u4e2d\u7b2c $19$ \u4e2a\u4f4d\u7f6e\u7684\u6570\u5b57\u3002\n\n\u2460 19\u51cf\u53bb1  \u2192 18\n\n\u2461 18 \u5bf9 $3!$ \u4f5c\u9664\u6cd5 \u2192 \u5f973\u4f590\n\n\u2462  0\u5bf9 $2!$ \u4f5c\u9664\u6cd5 \u2192 \u5f970\u4f590\n\n\u2463  0\u5bf9 $1!$ \u4f5c\u9664\u6cd5 \u2192 \u5f970\u4f590\n\n\u636e\u4e0a\u9762\u7684\u53ef\u77e5\uff1a\n\n\u6211\u4eec\u7b2c\u4e00\u4f4d\u6570\uff08\u6700\u5de6\u9762\u7684\u6570\uff09\uff0c\u6bd4\u7b2c\u4e00\u4f4d\u6570\u5c0f\u7684\u6570\u67093\u4e2a\uff0c\u663e\u7136 \u7b2c\u4e00\u4f4d\u6570\u4e3a\u2192 4\n\n\u6bd4\u7b2c\u4e8c\u4f4d\u6570\u5c0f\u7684\u6570\u5b57\u67090\u4e2a\uff0c\u6240\u4ee5 \u7b2c\u4e8c\u4f4d\u6570\u4e3a\u21921\n\n\u6bd4\u7b2c\u4e09\u4f4d\u6570\u5c0f\u7684\u6570\u5b57\u67090\u4e2a\uff0c\u56e0\u4e3a1\u5df2\u7ecf\u7528\u8fc7\uff0c\u6240\u4ee5\u7b2c\u4e09\u4f4d\u6570\u4e3a\u21922\n\n\u7b2c\u56db\u4f4d\u6570\u5269\u4e0b 3\n\n\u8be5\u6570\u5b57\u4e3a  $4 1 2 3$  (\u6b63\u89e3)\n\n \n\n\u518d\u4e0a\u4ee3\u7801\n```\nvoid reverse_contor(int x){\n    memset(vis,0,sizeof vis);\n    x--;\n    int j;\n    for(int i=1;i<=n;i++){\n        int t=x/fac[n-i];\n        for(j=1;j<=n;j++){\n            if(!vis[j]){\n                if(!t) break;\n                t--;\n            }\n        }\n        printf(\"%d \",j);\n        vis[j]=1;\n        x%=fac[n-i];\n    }\n    puts(\"\");\n}\n```\n\n## \u6700\u540e\u4e0a\u4e00\u4e0b\u672c\u9898\u7684\u4ee3\u7801\n```\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#define int long long\nusing namespace std;\n\nint fac[25]={1};\n\nint n,k,x;\nint val[25];\nbool vis[25];\n\nvoid reverse_contor(int x){\n\tmemset(vis,0,sizeof vis);\n\tx--;\n\tint j;\n\tfor(int i=1;i<=n;i++){\n\t\tint t=x/fac[n-i];\n\t\tfor(j=1;j<=n;j++){\n\t\t\tif(!vis[j]){\n\t\t\t\tif(!t) break;\n\t\t\t\tt--;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d \",j);\n\t\tvis[j]=1;\n\t\tx%=fac[n-i];\n\t}\n\tputs(\"\");\n}\n\nint contor(int x[]){\n\tint p=0;\n\tfor(int i=1;i<=n;i++){\n\t\tint t=0;\n\t\tfor(int j=i+1;j<=n;j++){\n\t\t\tif(x[i]>x[j]) t++;\n\t\t}\n\t\tp+=t*fac[n-i];\n\t}\n\treturn p+1;\n}\n\nsigned main(){\n\tscanf(\"%lld%lld\",&n,&k);\n\tfor(int i=1;i<=n;i++) fac[i]=fac[i-1]*i;\n\twhile(k--){\n\t\tchar ch;cin>>ch;\n\t\tif(ch=='P') scanf(\"%lld\",&x),reverse_contor(x);\n\t\telse{\n\t\t\tfor(int i=1;i<=n;i++) scanf(\"%lld\",&val[i]);\n\t\t\tprintf(\"%lld\\n\",contor(val));\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1520133404,
        "uid": 56778,
        "name": "YoungNeal",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3014 \u3010[USACO11FEB]\u725b\u7ebfCow Line\u3011"
    },
    {
        "content": "\u672c\u9898\u662f\u4e00\u9053**Cantor\u5c55\u5f00**\u7684\u6a21\u677f~~\u6c34~~\u9898, \u4e0d\u8fc7\u7f51\u4e0a\u597d\u50cf\u5e76\u6ca1\u6709\u5bf9\u5eb7\u62d3\u5c55\u5f00\u7684\u8be6\u7ec6\u8bc1\u660e, \u90a3\u4e48\u6211\u5c31\u66ff\u5404\u4f4ddalao\u7801\u4e00\u7801\u8bc1\u660e\u5427!  \n\u4ee5\u4e0b\u662f\u6211\u4e00\u4e2a\u5348\u81ea\u4e60\u7684\u667a\u6167\u7ed3\u6676x.\n# Cantor\u5c55\u5f00\n\u5148\u7529\u4e00\u4e0b\u539f\u5b9a\u7406:  \n**\u7ed9\u5b9a\u4e00\u957f\u5ea6\u4e3a$n$\u4e25\u683c\u4e0a\u5347\u6570\u5217$a$, \u4ee4\u521d\u59cb\u72b6\u6001$a_0=a$, \u5bf9a\u8fdb\u884c\u5168\u6392\u5217, \u7b2ck\u6b21\u751f\u6210\u7684\u6570\u5217\u4e3a$a_k$, \u5219\u6709Cantor\u5c55\u5f00\u5f0f:**  \n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$k=Hash(a_k)=\\sum_{i=1}^n(n-i)!\\sum_{j=i+1}^n(a_{k,i}>a_{k,j})$\n## \u8bc1\u660e\n\u6784\u9020\u5982\u4e0bHash\u64cd\u4f5c:  \n&nbsp;&nbsp;&nbsp;&nbsp;**1)\u6309\u987a\u5e8f\u53d6\u51fa$a_{k,i}$**  \n&nbsp;&nbsp;&nbsp;&nbsp;**2)\u53d6\u6240\u6709$a_{k,j}<a_{k,i},i<j$\u4e0e$a_{k,i}$\u4ea4\u6362\u4f4d\u7f6e, \u5e76\u5bf9$a_{k,i+1}$\u81f3$a_{k,n}$\u7684\u5143\u7d20\u8fdb\u884c\u5168\u6392**  \n\u73b0\u53ea\u9700\u8bc1, **\u8be5\u64cd\u4f5c(1)\u4ec5\u9650\u4e8e, (2)\u4e0d\u91cd\u590d, (3)\u4e0d\u9057\u6f0f\u5730\u751f\u6210\u6240\u6709\u4e8e$a_k$\u4e4b\u524d\u751f\u6210\u7684\u6570\u5217, \u5373$a_1,a_2,...,a_{k-1}$.** \u4e0d\u59a8\u8bbe$a_k=S$, \u64cd\u4f5c\u540e$a_k'=T$. \n\n------------\n \n### \u4e0b\u8bc1\u6027\u8d28(1)\n\u4e0d\u59a8\u8bbe\u53d6\u51fa$S_m$\u4e0e\u540e\u4ea4\u6362,  \n$\\because$\u5bf9\u4e8e$\\forall i<m,S_i=T_i$  \n\u53c8$\\because S_m>T_m$  \n$\\therefore T$\u4e00\u5b9a\u5168\u6392\u751f\u6210\u4e8e$S$\u4e4b\u524d, \u5df2\u8bc1.  \n\n------------\n  \n### \u4e0b\u8bc1\u6027\u8d28(2)\n(\u4e00) \u82e5\u53d6$S_m$\u4e8e\u540e\u4ea4\u6362, \u8bbe\u591a\u79cd\u4e0d\u540c\u4ea4\u6362\u7ed3\u679c$T_1,T_2,...$  \n\u663e\u7136\uff0c$T_{1,m}\\neq T_{2,m}\\neq ...$.  \n\u53c8\u5728$\\forall T_i$\u4e2d\uff0c$T_{m+1}$\u81f3$T_n$\u53c8\u5168\u6392\u751f\u6210, \u5fc5\u4e0d\u5168\u7b49, \u5df2\u8bc1.  \n  \n(\u4e8c) \u82e5\u53d6$S_n,S_m$\u5206\u522b\u4ea4\u6362, \u4e0d\u59a8\u8bbe$n<m$,  \n\u5219\u53d6$S_m$\u6240\u751f\u6210\u7684\u7ed3\u679c$T,T_n=S_n$,  \n\u53c8\u53d6$S_n$\u6240\u751f\u6210\u7684\u7ed3\u679c$T',T'\\neq S_n$.  \n$\\therefore T\\neq T'$, \u5df2\u8bc1.  \n  \n\u7efc\u4e0a,\u6027\u8d28(2)\u5df2\u8bc1.  \n\n------------\n\n### \u4e0b\u8bc1\u6027\u8d28(3)\n\u4e0d\u59a8\u4efb\u53d6\u5168\u6392\u6570\u5217$a_i, i\\in[0,k-1]$  \n$\\because S$\u751f\u6210\u4e8e$a_i$\u4e4b\u540e  \n$\\therefore$\u5fc5\u5148\u51fa\u73b0\u6700\u5c0f\u7684$m$, s.t.(such that, \u4f7f\u5f97)$S_m>a_{i,m}$, \u4e14\u5bf9\u4e8e$j<m,S_j=a_{i,j}$.  \n$\\because a_i$\u65e0\u91cd\u590d\u5143\u7d20  \n$\\therefore a_{i,m}\\in\\{S_n|n>m\\}$  \n\u53c8$\\because S_m>a_{i,m}$  \n$\\therefore$\u5f53\u53d6$S_m$\u4ea4\u6362\u65f6, \u5fc5\u4f1as.t.\u4e00\u7ec4\u7ed3\u679c$T$, $T_m=a_{i,m}$  \n\u6b64\u65f6, $a_i$\u5fc5\u7531$T_{m+1}$\u81f3$T_n$\u7684\u5168\u6392\u5217\u751f\u6210, \u5df2\u8bc1.  \n\n------------\n\n\u6545, \u8be5\u64cd\u4f5c\u6027\u8d28\u5df2\u8bc1\u660e, \u5176\u751f\u6210\u7684\u6570\u5217\u603b\u6570\u5c31\u662f$k$.  \n\u4e0d\u59a8\u8bbe\u53d6\u51fa$S_i$\u4e0e\u540e\u4ea4\u6362, \u5176\u751f\u6210\u7684\u6570\u5217\u603b\u6570\u663e\u7136\u4e3a:  \n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$Total_i=(n-i)!\\sum_{j=i+1}^n(S_i>S_j)$  \n\n\u90a3\u4e48\u6240\u6709\u7684\u6570\u5217\u603b\u6570\u5373\u4e3a:  \n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$k=\\sum_{i=1}^nTotal_i=\\sum_{i=1}^n(n-i)!\\sum_{j=i+1}^n(S_i>S_j)$  \n\n\u5219\u5bf9\u4e8e$\\forall a_k$, \u8be5\u64cd\u4f5c\u751f\u6210\u7684\u6570\u5217\u603b\u6570\u4e3a:  \n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$k=\\sum_{i=1}^n(n-i)!\\sum_{j=i+1}^n(a_{k,i}>a_{k,j})$  \n\n\u6545, \u539f\u547d\u9898\u6210\u7acb, \u8bc1\u6bd5!  \n\n\n------------\n\u662f\u4e0d\u662f\u975e\u5e38\u7b80\u5355\u5462? ~~\u6ed1\u7a3d~~  \n\u6bd5\u7adf\u662f\u677f\u9898\uff0c\u76f4\u63a5\u4e0a\u4ee3\u7801\u5427.  \n\n```cpp\n#include <cstdio>\n#include <vector>\n#include <algorithm>\n\nnamespace Optimize { // \u4f18\u5316\u6a21\u677f \n\t#define Eps 1e-8\n\t#define Inf 0x3f3f3f3f\n\t#define Int register int\n\t#define LL long long int\n\t#define Type template<typename _T>\n\t#define FileClose() fclose ( stdin ), fclose ( stdout )\n\t#define FileOpen( fname ) freopen ( fname\".in\", \"r\", stdin ), freopen ( fname\".out\", \"w\", stdout )\n\tType inline _T Max ( const _T a, const _T b ) { return a > b ? a : b; }\n\tType inline _T Min ( const _T a, const _T b ) { return a < b ? a : b; }\n\tType inline _T Abs ( const _T x ) { return x < 0 ? -x : x; }\n\tType inline _T rint () {\n\t\t_T x = 0; int f = 1; char s = getchar ();\n\t\twhile ( s < '0' || '9' < s ) f = s == '-' ? -1 : 1, s = getchar ();\n\t\twhile ( '0' <= s && s <= '9' ) x = ( x << 3 ) + ( x << 1 ) + ( s - '0' ), s = getchar ();\n\t\treturn x * f;\n\t}\n\tType inline void wint ( _T x ) {\n\t\tif ( x < 0 ) putchar ( '-' ), x = ( ~ x ) + 1;\n\t\tif ( 9 < x ) wint ( x / 10 );\n\t\tputchar ( x % 10 + '0' );\n\t}\n}\n\nusing namespace std;\nusing namespace Optimize;\n\nint n, q, a[25] = {};\nLL FAC[25] = { 1 }; // \u9636\u4e58\u7b54\u6848 \n\ninline LL Cantor ( const int* Seq ) { // Cantor\u5c55\u5f00\u6c42k \n\tLL ret = 0;\n\tfor ( Int i = 1; i <= n; ++ i ) {\n\t\tint Total = 0;\n\t\tfor ( Int j = i + 1; j <= n; ++ j ) {\n\t\t\tTotal += Seq[i] > Seq[j];\n\t\t}\n\t\tret += Total * FAC[n - i];\n\t}\n\treturn ret;\n}\n\ninline vector<int> ReCantor ( LL k ) { // \u9006\u5eb7\u62d3\u5c55\u5f00\u6c42\u6570\u5217 \n\tvector<int> v, ret;\n\tfor ( Int i = 1; i <= n; ++ i ) {\n\t\tv.push_back ( i );\n\t}\n\tfor ( Int i = n; i; -- i ) {\n\t\tLL r = k % FAC[i - 1], t = k / FAC[i - 1];\n\t\tk = r;\n\t\tsort ( v.begin (), v.end () );\n\t\tret.push_back ( v[t] );\n\t\tv.erase ( v.begin () + t );\n\t}\n\treturn ret;\n}\n\ninline void Init () { // \u9636\u4e58\u9884\u5904\u7406 \n\tfor ( Int i = 1; i <= 20; ++ i ) {\n\t\tFAC[i] = FAC[i - 1] * i;\n\t}\n}\n\ninline void Work () {\n\t#define rint rint<LL>() // \u58f0\u660e\u8bfb\u5165LL, \u6ce8\u610f\u8f93\u5165\u7684num\u53ef\u80fd\u975e\u5e38\u5927, \u5fc5\u987b\u7528LL \n\t#define veciter vector<int> :: iterator // \u8fed\u4ee3\u5668 \n\tInit ();\n\tn = rint, q = rint;\n\twhile ( q -- ) {\n\t\tchar Cmd = getchar ();\n\t\tif ( Cmd == 'P' ) {\n\t\t\tLL num = rint;\n\t\t\tvector<int> Ans = ReCantor ( num - 1 );\n\t\t\tfor ( veciter it = Ans.begin (); it != Ans.end (); ++ it ) {\n\t\t\t\twint ( *it ), putchar ( ' ' );\n\t\t\t}\n\t\t\tputchar ( '\\n' );\n\t\t} else if ( Cmd == 'Q' ) {\n\t\t\tfor ( Int i = 1; i <= n; ++ i ) {\n\t\t\t\ta[i] = rint;\n\t\t\t}\n\t\t\tLL Ans = Cantor ( a );\n\t\t\twint ( Ans + 1 ), putchar ( '\\n' );\n\t\t}\n\t\telse ++ q; // \u8bfb\u5230\u5f02\u5e38\u5b57\u7b26, \u4e0d\u8ba1\u5165\u603b\u6570 \n\t}\n}\n\nint main () {\n\tWork ();\n\treturn 0;\n}\n```",
        "postTime": 1556255904,
        "uid": 123807,
        "name": "Rainybunny",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3014 \u3010[USACO11FEB]\u725b\u7ebfCow Line\u3011"
    },
    {
        "content": "[\u70b9\u51fb\u535a\u5ba2\uff0c\u6551\u6551\u8bbf\u95ee\u91cf](https://blog.csdn.net/qq_43804974/article/details/103864337)\n\u5355\u7eaf\u8bb2\u8bb2\u600e\u4e48\u7528\u600e\u4e48\u7b97\uff0c\u8bf4\u4e9b\u4eba\u8bdd\u3002\n\n\u9884\u5907\u6982\u5ff5\uff1a\n\u6392\u5217\uff1a\u5bf9\u4e8e\u4e00\u4e2a\u6570\u5b57n\u7684\u6392\u5217\u5c31\u662f\u542b\u6709[1,n]\u6240\u6709\u6570\u5b57\u7684\u5e8f\u5217\u3002\u4e5f\u5c31\u662fn\u53d63\uff0c\u90a3\u4e48123,132,213\u5c31\u53eb\u505an\u7684\u6392\u5217\uff0c\u4f46\u662f112,12,13\u7b49\u7b49\u8fd9\u79cd\u5c31\u4e0d\u662f\u6392\u5217\u3002\n\n\u4ec0\u4e48\u662f\u5eb7\u6258\u5c55\u5f00\u5462\uff1f\u5c31\u662f\u628a\u4e00\u4e2an\u7684\u5168\u6392\u5217\u8868\u793a\u51fa\u6765\u5e76\u4e14\u6309\u7167\u5b57\u5178\u5e8f\u6392\u51fa\u6765\u3002n\u53d6\u4e09\u7684\u5168\u6392\u5217\u67096\u79cd\uff0c\u90a3\u4e48\u5c31\u5bf9\u77406\u79cd\u6309\u5b57\u5178\u5e8f\u5c0f\u7684\u987a\u5e8f\u53bb\u6392\u6bd4\u5982123\u7684\u5e8f\u53f7\u5c31\u662f1,132\u7684\u5e8f\u53f7\u5c31\u662f2.\n\n\u9996\u5148\u6211\u4eec\u6765\u8bb2\u600e\u4e48\u6839\u636e\u7ed9\u51fa\u7684\u4e00\u4e2a\u6392\u5217\u53bb\u6c42\u51fa\u4ed6\u6240\u4ee3\u8868\u7684\u5e8f\u53f7\u662f\u591a\u5c11\uff0c\u6bd4\u5982\u5e8f\u5217\n2 1 4 3\u7684\u5e8f\u53f7\u3002\u4ed6\u7684\u6c42\u6cd5\u662f\u8fd9\u6837\u7684\uff0c\u770b\u7b2c\u4e00\u4e2a\u6570\u5b57\u662f2\uff0c\u6211\u4eec\u53bb\u9700\u8981\u77e5\u9053**\u76ee\u524d\u8fd8\u6ca1\u7528\u8fc7\u7684\u6570\u5b57\u4e2d2\u6240\u5728\u7684\u4f4d\u7f6e-1**\u7684\u8fd9\u4e2a\u6570\u5b57\u4f5c\u4e3atemp1\u597d\u4e86\uff0c \u76ee\u524d\u6ca1\u4f7f\u7528\u8fc7\u7684\u6570\u5b57\u662f1234\uff08\u4ece\u5c0f\u5230\u5927\uff09\uff0c2\u662f\u7b2c\u4e8c\u5927\u7684\u6570\u5b57\uff0c**\u5728\u51cf\u53bb\u4e00**\uff0c\u51cf\u4e00\u540e\u5c31\u662ftemp1 = 1\uff1b\u7136\u540e\u6211\u4eec\u9700\u8981\u53e6\u4e00\u4e2a\u6570\u5b57temp2\uff0c\u8fd9\u4e2a\u6570\u5b57\u662f\u4ec0\u4e48\u5462\u5c31\u662fn\u51cf\u53bb\u5f53\u524d\u5728**\u5e8f\u5217\u4e2d**\u8fd9\u4e2a**\u6570\u5b57\u7684\u4f4d\u7f6e**\uff0c\u5c31\u662ftemp2 = 4 - 1 = 3\uff0c\u5728\u5bf9temp2\u6c42\u9636\u4e58\u4e5f\u5c31\u662ftemp2 = 3! = 6;\u628atemp1 \uff0c temp2\u4e58\u8d77\u6765\uff0c\u5728\u7528\u8fd9\u4e2a\u4e58\u5b8c\u7684\u6570\u5b57**\u52a0\u4e0a**\u540e\u9762\u4f4d\u6570\u7684temp1*temp2\n\uff08\u8fc7\u7a0b\u7b97\u51fa\u6765\u7684\u6570\u5b57\u5c31\u662f\u8fd9\u6837\u7684\uff09\n2\uff1atemp1 = 1\uff0c temp2 = 3\uff01 = 6\uff0ctemp1 * temp2 = 6\uff1b\n1\uff1atemp1 = 0(\u73b0\u5728\u6ca1\u4f7f\u7528\u8fc7\u7684\u6570\u5b57\u662f1,3,4)\uff0c\n      temp2 = 2\uff01 = 2\uff0ctemp1 * temp2 = 0\uff1b\n4  :temp1 = 1,(1,2\u90fd\u4f7f\u7528\u8fc7\uff0c\u73b0\u5728\u5269\u4e0b3,4\uff09\uff0c    \n    temp2 = 1\uff01 = 1\uff0ctemp1*temp2 = 1\uff1b\n3: temp = 0(\u53ea\u5269\u4e0b3),temp2 = 0! = 1;temp1*temp2 = 0;\n\n\u90a3\u4e48\u5bf9\u4e8e2143\u8fd9\u4e2a\u5e8f\u5217\u7684\u5e8f\u53f7\u5c31\u662f6+0+1+0 = 7\uff0c\u4f46\u662f\u5728\u6700\u540e\u7684\u6700\u540e\u8fd8\u8981\u5728\u52a0\u4e0a1\uff0c\u8ba9\u4ed6\u53d8\u62107+1 = 8\u8fd9\u624d\u662f\u6b63\u786e\u7b54\u6848\uff0c\u56e0\u4e3a\u4ed6\u7684\u5e8f\u53f7\u539f\u672c\u662f\u4ece0\u5f00\u59cb\u7b97\u7684\uff0c\u4f60\u7b971234\u7b97\u51fa\u6765\u5c31\u662f0\uff0c\u6211\u4eec\u8ba9\u4ed6\u4ece1\u5f00\u59cb\u7b97\uff1b\n\n\u5173\u4e8e\u4ee3\u7801\u5b9e\u73b0\u65b9\u9762\u65b9\u9762\u7528\u6811\u72b6\u6570\u7ec4\u53bb\u7ef4\u62a4\u524d\u7f00\u548c\u5c31\u53ef\u4ee5\u77e5\u9053\u67d0\u4e2a\u6570\u5b57\u5230\u5e95\u73b0\u5728\u6392\u5728\u7b2c\u51e0\u4f4d\uff08\u6ca1\u7528\u8fc7\u7684\u65f6\u5019\u5c31\u662f1\uff0c\u7528\u5b8c\u5c31\u628a\u4ed6\u51cf\u62100\uff09\uff0c\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u5355\u70b9\u4fee\u6539\u533a\u95f4\u67e5\u8be2\u7684\u95ee\u9898\u3002\n\n\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u518d\u6765\u95ee\u4e00\u4e2a\u95ee\u9898\uff0c \u77e5\u9053\u4e00\u4e2a\u5e8f\u53f7\u548cn\uff0c\u6211\u4eec\u600e\u4e48\u6c42\u4ed6\u6240\u4ee3\u8868\u7684\u5e8f\u5217\u662f\u54ea\u4e00\u79cd\u5e8f\u5217\uff1f\u6211\u4eec\u5c31\u5047\u8bben\u662f4\uff0c\u5e8f\u53f7\u662f8\uff0c\u7528\u521a\u624d\u7684\u4f8b\u5b50.\u7528t\u8868\u793a8\n   \u662f\u8fd9\u4e48\u6c42\u7684\u5148\u628a\u5e8f\u53f7-1\uff0c\uff08\u6211\u4eec\u4e0a\u9762\u662f\u5728\u6700\u540e\u52a01\u7684\u8bb0\u5f97\u5417\uff09\u3002  t = 8 - 1 = 7\uff1b\n   \u6709n\u4e2a\u6570\uff0c\u6211\u4eec\u4ece\u7b2c\u4e00\u4e2a\u6570\u5f00\u59cb\u7b97\u8d77\uff0c\u7528i\u8868\u793a\u73b0\u5728\u5728\u7b97\u7b2c\u51e0\u4e2a\u6570,\n    \u7528t\u53bb\u9664\u4ee5\uff08n - i\uff09\u7684\u9636\u4e58\u5f97\u5230\u4e00\u4e2a\u6570\u5b57\uff0c\u8fd9\u4e2a\u6570\u5b57\u662f\u4ec0\u4e48\uff1f\u8fd9\u4e2a\u6570\u5b57\u8868\u793a\u7684\u662f**\u5728\u672a\u4f7f\u7528\u7684\u6570\u5b57\u91cc\u9762**\u6392\u5728\u7b2c\u51e0\u4e2a\uff0c\u4f46\u662f\u6211\u4eec\u8fd8\u9700\u8981\u518d\u52a0\u4e0a\u4e00\uff08\u8bb0\u5f97\u6211\u4eec\u4e0a\u9762\u7b97\u5e8f\u53f7\u662f-1\u7684\uff0c\u8fd9\u91cc\u5c31\u662f\u53cd\u8fc7\u6765\u6c42\u4e5f\u5c31\u662f+1\uff09,\u800c\u73b0\u5728\u8fd9\u4e2a\u6392\u540d\u6240\u4ee3\u8868\u7684\u6570\u5b57\u5c31\u662f\u5f53\u524d\u4f4d\u7f6e\u7684\u6570\u5b57\uff0c\u591a\u770b\u4e24\u904d\uff0c\u518d\u770b\u4e0d\u61c2\u6211\u63a8\u7ed9\u4f60\u770b;\n    \n    \n   i = 1\n   \n   int node = t / (4-i)! = 7 / 3 ! = 1;node + 1 = 2;\n   \n   \u7b97\u51fanode = 2\u5c31\u662f\u8981\u672a\u4f7f\u7528\u7684\u6570\u5b57\u91cc\u9762\u6392\u7b2c2\u7684\u5c31\u662f\uff081234\u91cc\u9762\u6392\u7b2c\u4e8c\u7684\u5c31\u662f2\uff09,\u90a3\u4e48\u7b2c1\u4e2a\u6570\u5b57\u5c31\u662f2\uff0c\uff08\u73b0\u5728\u672a\u4f7f\u7528\u7684\u6570\u5b57\u5c31\u662f134\uff09,**\u7b97\u5b8c\u540et\u53d6t\u9664\uff084-i\uff09!\u7684\u6a21\u6570\uff0c\u5373t\u53d8\u6210 t = t % (4 - i)! =1\uff1b**\n   \n   i = 2\n   \n   int node = t / (4 - i)! = 1 / 2 ! = 0, node + 1 = 1;\n   \u8981\u6c42\u672a\u4f7f\u7528\u7684\u6570\u5b57\u91cc\u9762\u6392\u7b2c\u4e00\u7684\uff08\u73b0\u5728\u672a\u4f7f\u7528\u7684\u6570\u5b57\u662f134,\u6392\u7b2c\u4e00\u4e2a\u7684\u5c31\u662f1\uff09\uff0c \u5728\u66f4\u65b0t\uff0ct = t % (4 - i)! = 1, \u73b0\u5728\u672a\u4f7f\u7528\u7684\u6570\u5b57\u662f\uff083,4\uff09;\n   \n   i = 3\n   \n   int node =  t / (4 - i)! = 1 / 1! = 1,node + 1 = 2;\n   \n    \u8981\u6c42\u672a\u4f7f\u7528\u7684\u6570\u5b57\u91cc\u9762\u6392\u7b2c\u4e8c\u7684\uff08\u73b0\u5728\u672a\u4f7f\u7528\u7684\u6570\u5b57\u662f34,\u6392\u7b2c\u4e8c\u4e2a\u7684\u5c31\u662f4\uff09\uff0c\n    \n    \u66f4\u65b0t ,t = t % (4 - i)! = 0;(\u73b0\u5728\u672a\u4f7f\u7528\u7684\u6570\u5b57\u662f3)\n    \n    i = 4\n    int node =  t / (4 - i)! = 0 / 0! = 1,node + 1 = 1;\n    \u53d6\u672a\u4f7f\u7528\u7684\u6570\u5b57\u91cc\u9762\u6392\u7b2c\u4e00\u4f4d\uff0c\u5c31\u662f3.\u7b97\u6cd5\u7ed3\u675f\n\u8fd9\u4e2a\u5c31\u662f\u6c42\u7684\u8fc7\u7a0b\uff0c\u5e0c\u671b\u5404\u4f4d\u770b\u61c2\u4e86\u5eb7\u6258\u5c55\u5f00\u548c\u9006\u5c55\u5f00\u662f\u600e\u4e48\u7b97\u51fa\u6765\u7684\u3002\u5728\u5b9e\u73b0\u9006\u5c55\u5f00\u65b9\u9762\u6211\u662f\u9009\u62e9\u6811\u72b6\u6570\u7ec4+\u4e8c\u5206\u53bb\u627e\u51fa\u73b0\u5728\u672a\u4f7f\u7528\u7684\u6570\u5b57\u7684\u7b2ck\u5927\uff0c\u5f53\u7136\u7ebf\u6bb5\u6811\u4e5f\u53ef\u4ee5\uff0c\u590d\u6742\u5ea6\u751a\u81f3\u66f4\u4f4e\uff08\u6811\u72b6\u6570\u7ec4\u662f\u4e24\u4e2alog\uff0c\u7ebf\u6bb5\u6811\u4e00\u4e2alog\uff09\u3002\n\u6211\u6ca1\u600e\u4e48\u8bb2\u5177\u4f53\u6811\u72b6\u6570\u7ec4\u600e\u4e48\u5b9e\u73b0\u56e0\u4e3a\u8fd9\u7bc7\u4e3b\u8981\u662f\u6765\u7528\u8bf4\u4e00\u8bf4\u5eb7\u6258\u5c55\u5f00\u7684\u3002\u5982\u679c\u5bf9\u4e8e\u6211\u4ee3\u7801\u91cc\u9762\u6811\u72b6\u6570\u7ec4\u90e8\u5206\u6709\u4f55\u4e0d\u61c2\u53ef\u4ee5\u7559\u8a00\u3002\n   ```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#define int long long\n#define RE register\nusing namespace std;\nconst long long max_ = 1530000 + 7;\nconst int mod = 998244353;\nconst int inf = 1e9;\nconst long long INF = 1e18;\nint read() {\n\tint s = 0, f = 1;\n\tchar ch = getchar();\n\twhile (ch<'0' || ch>'9') {\n\t\tif (ch == '-')\n\t\t\tf = -1;\n\t\tch = getchar();\n\t}\n\twhile (ch >= '0'&&ch <= '9') {\n\t\ts = s * 10 + ch - '0';\n\t\tch = getchar();\n\t}\n\treturn s * f;\n}\nint n,value[max_];\n\nint c[100];\nint low_bit(int x) {\n\treturn (x&(-x));\n}\n\nvoid change(int x, int value) {\n\twhile (x <= n) {\n\t\tc[x] += value;\n\t\tc[x] %= mod;\n\t\tx = x + low_bit(x);\n\t}\n}\n\nint sum_(int x) {\n\t//\u7b971\u5230x\u7684\u603b\u548c\n\tint ans = 0;\n\twhile (x != 0) {\n\t\tans += c[x];\n\t\tans %= mod;\n\t\tx = x - low_bit(x);\n\t}\n\treturn ans%mod;\n}\nint erfen(int L, int R, int aim) {\n\tif (L == R)return L;\n\tint mid = L + (R - L) / 2;\n\tif (sum_(mid) >= aim) {\n\t\treturn erfen(L, mid, aim);\n\t}\n\telse\n\treturn erfen(mid + 1, R, aim);\n}\nsigned main() {\n\tint T;\n\tn = read(), T = read();\n\tvalue[0] = 1;\n\tfor (int i = 1; i <= 20; i++) {\n\t\tvalue[i] = value[i - 1]  * i;\n\t}\n\twhile (T--){\n\t\tchar ch;\n\t\tcin >> ch;\n\t\tif (ch == 'P') {\n\t\t\t//\u5eb7\u6258\u9006\u5c55\u5f00\n\t\t\tmemset(c, 0, sizeof(c));\n\t\t\tfor (int i = 1; i <= n; i++)\n\t\t\t\tchange(i, 1);\n\t\t\tint temp = read(); temp--;\n\t\t\tfor (int i = 1,num = n - 1; i <= n;num--, i++) {\n\t\t\t\tint aim = temp / value[num] + 1; temp %= value[num];\n\t\t\t\tint t = erfen(1, n, aim);\n\t\t\t\tcout << t << \" \";\n\t\t\t\tchange(t, -1);\n\t\t\t}\n\t\t\tcout << \"\\n\";\n\t\t}\n\t\telse {//\u5eb7\u6258\u5c55\u5f00\n\t\t\tmemset(c, 0, sizeof(c));\n\t\t\tfor(int i =1; i <= n ; i++)\n\t\t\t\tchange(i, 1);\n\t\t\tint ans = 1;//\u8981\u4ece1\u5f00\u59cb\n\t\t\tfor (int i = 1, jiecheng = n - 1; i <= n; jiecheng--, i++) {\n\t\t\t\tint temp = read();\n\t\t\t\tans += value[jiecheng] * sum_(temp - 1);\n\t\t\t\tchange(temp, -1);\n\t\t\t}\n\t\t\tcout << ans << \"\\n\";\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n   \n   \n",
        "postTime": 1578316622,
        "uid": 156874,
        "name": "Boxxxxxx",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3014 \u3010[USACO11FEB]\u725b\u7ebfCow Line\u3011"
    },
    {
        "content": "\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e00\u79cd\u65b9\u6cd5[\u6df1\u5165\u4e86\u89e3](https://baike.baidu.com/item/%E5%BA%B7%E6%89%98%E5%B1%95%E5%BC%80/7968428)\n\nai\u7684\u503c\u5e94\u662fi\u7684\u4f4d\u503c\u00d7ai\u7684\u503c\n\ni\u7684\u4f4d\u503c\u7c7b\u4f3c\u4e8e\u9636\u4e58\n\nai\u7684\u503c\u5e94\u662fai-ai\u524d\u9762\u6bd4i\u5c0f\u7684\u6570\u5b57\u603b\u548c\uff08\u81ea\u5df1\u60f3\u4e00\u60f3\uff09\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u53bb\u505a\u4e86\n\n\u5148\u9884\u5904\u7406\u9636\u4e58\n\n\u5176\u4ed6\u8fd8\u6709\u5f88\u591a\u7ec6\u8282\n\n\u6bd4\u5982\u5f00long long(int64)\n\n\u4e0b\u9762\u9644\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<iostream>\nbool vis[55];\nlong long a[55],b[55];\nlong long co,n,k;\nchar ch;\nint main()\n{\n\tscanf(\"%d%d\",&n,&k);\n\ta[n]=0;\n\ta[n-1]=1;\n\tfor (int i=n-2;i>=1;i--)\n\t    a[i]=a[i+1]*(n-i);\n\tfor (int nn=1;nn<=k;nn++)\n\t{\n\t\tch=' ';\n\t\twhile (ch!='P'&&ch!='Q') scanf(\"%c\",&ch);  \n\t\tif (ch=='P')\n\t\t{\n\t        scanf(\"%lld\",&co);\n\t        for (int i=1;i<=n;i++)\n\t        {\n\t\t        vis[i]=true;\n\t\t        b[i]=0;\n\t        }\n\t        for (int i=1;i<=n-1;i++)\n\t        {\n\t\t        long long q=co/a[i],s=0;\n\t\t        co=co%a[i];\n\t\t        if (co==0)\n\t\t        {\n\t\t        \tq=q-1;\n\t\t        \tco=co+a[i];\n\t\t\t\t}\n\t\t\t\tint j=0;\n\t\t        while(s<=q)\n\t\t\t\t{\n\t\t\t\t\tj++;\n\t\t\t\t\tif (vis[j]) s++;\n\t\t\t\t}\n\t            vis[j]=false;\n\t\t        b[i]=j;\n\t        }\n\t        int p=0;\n\t        for (b[n]=1;b[n]<=n;b[n]++)\n\t            if (vis[b[n]]) break;\n\t        for (int i=1;i<=n;i++)\n\t            printf(\"%d \",b[i]);\n\t        printf(\"\\n\"); \n\t\t}\n\t\telse \n\t\t{\n\t        long long s=0;\n\t        int x;\n        \tfor (int i=1;i<=n;i++)\n\t            vis[i]=true;\n        \tfor (int i=1;i<=n;i++)\n        \t{\n\t        \tint p=0;\n\t\t\t\tscanf(\"%d\",&x);\n\t        \tfor (int j=1;j<=x-1;j++)\n\t\t            if (vis[j]) p++;\n\t\t        vis[x]=false;\n\t\t        s=s+p*a[i];\n\t        }\n\t        printf(\"%lld\\n\",s+1);\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n\u65f6\u95f479ms,\u5185\u5b58816KB,\u4ee3\u7801\u957f\u5ea61.33KB\n\n\u8c22\u8c22\u5de8\u4f6c\uff0c\u5927\u4f6c\u7684\u89c2\u8d4f\n\n",
        "postTime": 1549108306,
        "uid": 36957,
        "name": "RainFestival",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3014 \u3010[USACO11FEB]\u725b\u7ebfCow Line\u3011"
    },
    {
        "content": "\u6ca1\u6709\u9898\u89e3\uff0c\u5199\u4e00\u6ce2\n\n\n\u8fd9\u9898\u96be\u9053\u4e0d\u662f\u6570\u8bba\u4e48\uff1f\u4e3a\u4ec0\u4e48\u4f1a\u6709\u52a8\u5f52\u7684\u6807\u7b7e\u3002\u3002\u3002\n\n\u8fdb\u5165\u6b63\u9898\uff1a\n\n\n**\u5eb7\u6258\u5c55\u5f00&\u5eb7\u6258\u9006\u5c55\u5f00**\n\n\n\u7ed9\u5b9a\u4e00\u4e2a\u6570\u5217\uff0c\u6c42\u51fa\u5176\u5728\u5168\u6392\u5217\u4e2d\u7684\u4f4d\u7f6e\uff0c\u8fd9\u5c31\u662f\u5eb7\u6258\u5c55\u5f00\u8981\u89e3\u51b3\u7684\u95ee\u9898\n\n\u8fd9\u662f\u5ea6\u5a18\u8bf4\u7684\uff1a\n\n<http://baike.baidu.com/link?url=InqGcS2WgtO1yVeqhxtn7KaCswerXIRvfvZ4bff3OpEVp-Rya5BG0bo8JzkcVg7gRKvagrEOl2G-Rzsa09ze3ekhWFJPA2MqPjJn8FohC2Qgy7UgfFWXBa2GkESgK6xr>\n\n\n**\u5eb7\u62d3\u5c55\u5f00**\n\n\u65b9\u6cd5\uff1a\n\n\u5c06\u6bcf\u4e2a\u6570\u4ece\u5934\u5f00\u59cb\u4ee5N\uff0cN-1\uff0cN-2......\u4f5c\u4e3a\u7f16\u53f7\n\n\u5bf9\u4e8e\u7f16\u53f7i\u7684\u6570\uff0c\u7ed9\u7b54\u6848\u52a0\u4e0aa[i]\\*(i-1)!\n\n\u5176\u4e2da[i]\u8868\u793a\u6bd4i\u5c0f\u7684\u6570\u4e14\u5728\u4e4b\u524d\u6ca1\u51fa\u73b0\u8fc7\u7684\u6570\u4e2a\u6570\uff0c\u4e58\u4ee5i-1\u7684\u9636\u4e58\n\n\n\nans=a[N]\\*(N-1)!+a[N-1]\\*(N-2)!+a[N-2]\\*(N-3)!+......+a[1]\\*0!\n\n**\u5eb7\u6258\u9006\u5c55\u5f00**\n\n\u7ed9\u5b9a\u4e00\u4e2a\u6570\u5217\u5728\u5168\u6392\u5217\u4e2d\u7684\u4f4d\u7f6ex\uff0c\u6c42\u8be5\u6570\u5217\n\n\u65b9\u6cd5:\n\n\u5148\u5c06x=x-1\\\n\n\n\u540c\u6837\u4ece\u5de6\u5230\u53f3\u7f16\u53f7N,N-1,N-2......\n\n\n\u7136\u540e\u4ece\u5de6\u5f00\u59cb i=N   -> 1\n\nt=x/(i-1)!\n\nt\u8868\u793a\u6bd4\u8be5\u4f4d\u5c0f\u7684\u6ca1\u51fa\u73b0\u8fc7\u7684\u6570\u7684\u4e2a\u6570\n\n\u7531\u6b64\u53ef\u4ee5\u63a8\u51fa\u8be5\u4f4d\u4e0a\u7684\u6570\n\nx=x%(i-1)!\n\n\u4e00\u76f4\u5faa\u73af\n\n\n\u5177\u4f53\u8fd8\u662f\u770b\u770b\u5ea6\u5a18\u4e0a\u6709\u8be6\u7ec6\u7684\u4f8b\u5b50\n\n\n\u732e\u4e0a\u4e11\u964b\u7684\u4ee3\u7801\uff1a\n\n\n\n\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<queue>\n#include<cmath>\n#include<cstring>\n#include<algorithm>\n#define LL long long int\nusing namespace std;\nconst int maxn=25;\nLL f[maxn];\nbool vis[maxn];\nLL read()                             //\u5feb\u901f\u8bfb\u5165\n{\n    LL out=0;\n    char c=getchar();\n    while(c<48||c>57) c=getchar();\n    while(c>=48&&c<=57)\n    {\n        out=out*10+c-48;\n        c=getchar();\n    }\n    return out;\n}\nvoid cal(int N)                           //\u9884\u5904\u7406\u9636\u4e58\u7684\u503c\n{\n    f[0]=1;\n    f[1]=1;\n    for(int i=2;i<N;i++)\n        f[i]=f[i-1]*i;\n}\nint getpre(int N,int x)             //\u6c42\u51fa\u6709\u591a\u5c11\u672a\u51fa\u73b0\u7684\u6570\u6bd4x\u5c0f\n{\n    int ans=0;\n    for(int i=1;i<x;i++)\n        if(!vis[i]) ans++;\n    vis[x]=true;\n    return ans;\n}\nvoid getprint(int N,LL x)        //\u6c42\u51fa\u6709x\u4e2a\u6bd4\u5b83\u5c0f\u7684\u672a\u51fa\u73b0\u7684\u6570\n{\n    LL cnt=-1,i=0;\n    while(cnt<x&&i<N)\n    {\n        i++;\n        if(!vis[i])\n            cnt++;\n    }\n    vis[i]=true;\n    cout<<i;\n}\nint main()\n{\n    int N=read(),K=read();\n    LL ans,x;\n    cal(N);\n    char cmd;\n    while(K--)\n    {\n        cmd=getchar();\n        while(cmd!='P'&&cmd!='Q') cmd=getchar();\n        if(cmd=='Q')                       //\u5eb7\u6258\u5c55\u5f00\n        {\n            fill(vis,vis+maxn,false);\n            ans=0;\n            for(int i=N;i>0;i--)\n            {\n                x=read();\n                ans+=getpre(N,x)*f[i-1];\n            }\n            cout<<ans+1<<endl;\n        }\n        else                                         //\u9006\u5c55\u5f00\n        {\n            fill(vis,vis+maxn,false);\n            bool first=true;\n            x=read()-1;\n            for(int i=N;i>0;i--)\n            {\n                if(first) first=false;\n                else printf(\" \");\n                getprint(N,x/f[i-1]);\n                x%=f[i-1];\n            }\n            cout<<endl;\n        }\n    }\n    return 0;\n}\n\n```",
        "postTime": 1496295880,
        "uid": 32842,
        "name": "Mychael",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3014 \u3010[USACO11FEB]\u725b\u7ebfCow Line\u3011"
    },
    {
        "content": "## LUOGU P3014 SOLUTION\n### \u601d\u8def\u70b9\u62e8\n\u5eb7\u6258\u5c55\u5f00\uff08**\u4f7f\u7528\u6811\u72b6\u6570\u7ec4\u4f18\u5316**\uff09\u4e0e\u9006\u5eb7\u6258\u5c55\u5f00\u3002\n### \u524d\u7f6e\u77e5\u8bc6\n1. [\u5eb7\u6258\u5c55\u5f00\u4e0e\u9006\u5eb7\u6258\u5c55\u5f00](https://blog.csdn.net/ajaxlt/article/details/86544074)    \n\n2. [\u6811\u72b6\u6570\u7ec4](https://blog.csdn.net/Small_Orange_glory/article/details/81290634)\n### \u505a\u6cd5\u8be6\u89e3\n\u4e0a\u9762\u63d0\u5230\u7684\u4e24\u4e2a\u524d\u7f6e\u77e5\u8bc6\uff0c\u8fd8\u4e0d\u4f1a\u7684\u8bf7\u81ea\u884c\u5b66\u4e60\u3002\u6211\u5728\u8fd9\u91cc\u4e3b\u8981\u8bb2\u4e00\u4e0b\u4e8c\u8005\u662f\u5982\u4f55\u8054\u7cfb\u5230\u4e00\u8d77\u7684\u3002  \n\n\u5728\u5eb7\u6258\u5c55\u5f00\u65f6\uff0c\u9700\u8981\u8ba1\u7b97\u6bcf\u4e00\u4f4d\u6570\u5b57\u5728\u5b83\u548c\u5b83\u4ee5\u540e\u7684\u6240\u6709\u6570\u5b57\u4e2d\u662f\u7b2c\u51e0\u5927\u7684\u6570\uff0c\u5728\u8fd9\u91cc\u6211\u4f7f\u7528\u4e86\u6811\u72b6\u6570\u7ec4\u5bf9\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u8fdb\u884c\u4e86\u4f18\u5316\u3002  \n  \n\u6211\u4eec\u8bbeadd(x,y)\u662f\u5c06x\u52a0\u4e0ay\uff0cask(x)\u662f\u67e5\u8be2x\u7684\u524d\u7f00\u548c\u3002\u5728\u9884\u5904\u7406\u65f6\uff0c\u6211\u4eec\u5bf9\u4ece1\u5230n\u7684\u6bcf\u4e00\u4e2ai\u90fd\u5206\u522badd(i,1),\u5047\u8bbe\u6211\u4eec\u5f53\u524d\u7b97\u5230\u4e86\u7b2ci\u4f4d\u6570a[i]\uff0c\u9996\u5148\u6211\u4eecadd(a[i],-1),\u8fd9\u4e2a\u64cd\u4f5c\u5c31\u76f8\u5f53\u4e8e\u628aa[i]\u5212\u6389\uff0c\u800c\u5728\u7b2ci\u4f4d\u4e4b\u524d\u51fa\u73b0\u8fc7\u7684\u6570\u90fd\u5df2\u7ecf\u88ab\u6211\u4eec\u63d0\u524d\u5212\u6389\u4e86\u3002\u90a3\u4e48ask(a[i])\u5373\u4e3a\u5728\u7b2ci\u4f4d\u4e4b\u540e\u51fa\u73b0\u7684\u6bd4a[i]\u5c0f\u7684\u6570\u7684\u603b\u4e2a\u6570\uff08\u5373\uff1a\u8fd8\u672a\u88ab\u5212\u6389\u7684\u6bd4a[i]\u5c0f\u7684\u6570\u7684\u603b\u4e2a\u6570\uff09\u3002\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u5de7\u5999\u5730\u5229\u7528\u4e86\u6811\u72b6\u6570\u7ec4\u7684\u6027\u8d28\u5bf9\u5eb7\u6258\u5c55\u5f00\u8fdb\u884c\u4e86\u4f18\u5316\u3002\u5728\u6570\u636e\u8f83\u5927\u65f6\uff0c\u8fd9\u79cd\u4f18\u5316\u4f5c\u7528\u662f\u6781\u4e3a\u660e\u663e\u7684\u3002  \n  \n\u6700\u540e\u63d0\u9192\u4e00\u4e0b\uff1a\u4e00\u5b9a\u8981\u5f00long long\uff01\n### AC\u4ee3\u7801\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#define ll long long\nusing namespace std;\nll n,k,t2,ans,fact[21],tree[21];\nbool vis[21];\nchar t1;\nvoid add(ll x,ll y)\n{\n  for(;x<=n;x+=x&-x)tree[x]+=y;\n}\nll ask(ll x)\n{\n  ll res=0;\n  for(;x;x-=x&-x)res+=tree[x];\n  return res;\n}\nint main()\n{\n  scanf(\"%lld%lld\",&n,&k);\n  fact[0]=1;\n  for(ll i=1;i<n;i++)fact[i]=fact[i-1]*i;//\u9012\u63a8\u6c42\u9636\u4e58\n  while(k--)\n    {\n      cin>>t1;\n      memset(tree,0,sizeof(tree));\n      memset(vis,0,sizeof(vis));\n      for(ll i=1;i<=n;i++)add(i,1);//\u9884\u5904\u7406\u6811\u72b6\u6570\u7ec4\n      switch(t1)\n\t{\n\tcase 'Q'://\u5eb7\u6258\u5c55\u5f00\uff08\u6811\u72b6\u6570\u7ec4\u4f18\u5316\uff09\n\t  ans=0;\n\t  for(ll i=1;i<=n;i++)\n\t    {\n\t      scanf(\"%lld\",&t2);\n\t      add(t2,-1);//\u5212\u6389\u8fd9\u4e2a\u6570\n\t      ans+=ask(t2)*fact[n-i];//\u8fd0\u7528\u6811\u72b6\u6570\u7ec4\u6c42\u8fd9\u4f4d\u6570\u5b57\u5728\u5b83\u548c\u5b83\u4ee5\u540e\u7684\u6240\u6709\u6570\u5b57\u4e2d\u662f\u7b2c\u51e0\u5927\u7684\u6570\n\t    }\n\t  printf(\"%lld\\n\",ans+1);//\u8bb0\u5f97\u6c42\u51fa\u6765\u7684\u7ed3\u679c\u8981\u52a01\n\t  break;\n\tcase 'P'://\u9006\u5eb7\u6258\u5c55\u5f00\n\t  scanf(\"%lld\",&t2);\n\t  t2--;\n\t  for(ll i=1;i<=n;i++)\n\t    {\n\t      ll temp=t2/fact[n-i];\n\t      for(ll j=1;j<=n;j++)\n\t\t{\n\t\t  if(vis[j])continue;\n\t\t  if(!temp)\n\t\t    {\n\t\t      printf(\"%lld \",j);\n\t\t      vis[j]=1;\n\t\t      break;\n\t\t    }\n\t\t  temp--;\n\t\t}\n\t      t2%=fact[n-i];\n\t    }\n\t  printf(\"\\n\");\n\t}\n    }\n  return 0;\n}\n```\n",
        "postTime": 1570582476,
        "uid": 118377,
        "name": "Honeta",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3014 \u3010\u725b\u7ebfCow Line\u3011"
    },
    {
        "content": " ```\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nlong long n,m,fac[28],vst[30],a[30],x;\nchar op;\nvoid init()  //\u521d\u59cb\u5316 \n{\n    for(int i=0;i<=20;i++)  // \u8fd9\u91cc\u5230\u4e8620\u5c31\u5df2\u7ecf\u5341\u5206\u5927\u4e86\uff0c\u6240\u4ee5\u65e0\u9700\u518d\u5f80\u540e\u8fd0\u7b97 \n    fac[i]=1;\n}\nll contor(ll x[])  //Cantor\u7684\u8fd0\u7b97 \n{\n    long long ans=0;\n    for(int i=1;i<=n;i++)\n    {\n        int tag=0;  //\u6807\u8bb0\u4e3a0 \n        for(int j=i+1;j<=n;j++)\n        {\n            if(x[i]>x[j])\n            tag++;  //\u66f4\u65b0\u6807\u8bb0 \n        }\n        ans+=tag*fac[n-i];\n    }\n    return ans+1;\n}\nvoid recontor(ll x)  //Cantor\u7684\u9006\u8fd0\u7b97 \n{\n    memset(vst,0,sizeof(vst));\n    x--;\n    ll k;\n    for(int i=1;i<=n;i++)\n    {\n        ll ans=x/fac[n-i];  //Cantor\u7684\u5b9e\u9645\u64cd\u4f5c1 \n        for(int j=1;j<=n;j++)\n        {\n            if(!vst[j])\n            {\n                if(!ans)  //\u52a0\u5165ans\u4e3a0\u7684\u8bdd\u5c31\u8d4b\u503c \n                {\n                    k=j;\n                    break;  //\u65f6\u95f4\u4e0a\u7684\u4f18\u5316 \n                }\n                ans--;\n            }\n        }\n        printf(\"%d \",k);\n        vst[k]=1; //\u56de\u6eaf \n        x%=fac[n-i];  //Cantor\u7684\u5b9e\u9645\u64cd\u4f5c2 \n    }\n    printf(\"\\n\");\n}\nint main()\n{\n    scanf(\"%lld%lld\",&n,&m);\n    init();\n    for(int i=1;i<=n;i++)\n    fac[i]=i*fac[i-1];  //\u5eb7\u6258\u5c55\u5f00\u7684\u9884\u5904\u7406 \n    for(int i=1;i<=m;i++)\n    {\n        cin>>op;  //\u5224\u65ad\u9898\u76ee\u6240\u7ed9\u7684\u6807\u8bb0\n        if(op=='P')\n        {\n            scanf(\"%lld\",&x);\n            recontor(x);  //\u5eb7\u6258\u5c55\u5f00\u9006\u8fd0\u7b97\uff0c\u8fdb\u884c\u52a0\u8fdb\u53bb \n        }\n        if(op=='Q')\n        {\n            for(int i=1;i<=n;i++)\n            scanf(\"%lld\",&a[i]);  //\u5eb7\u6258\u5c55\u5f00\u8fd0\u7b97\uff0c\u8fd0\u7b97 \n            printf(\"%lld\\n\",contor(a));\n        }\n    }\n    return 0;\n}\n```\n",
        "postTime": 1566811492,
        "uid": 231018,
        "name": "tjq0630",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3014 \u3010[USACO11FEB]\u725b\u7ebfCow Line\u3011"
    },
    {
        "content": "\u5229\u7528\u5eb7\u62d3\u5c55\u5f00\u4e0e\u9006\u5eb7\u62d3\u5c55\u5f00\uff0c\u5927\u4f6c\u4eec\u5df2\u7ecf\u8bb2\u7684\u542c\u6e05\u695a\u7684\u4e86\uff0c\u76f8\u5f53\u4e8e\u662f\u5bf9\u4e00\u4e2a\u5e8f\u5217\u52a0\u5bc6\u4e0e\u89e3\u5bc6\u7684\u8fc7\u7a0b\uff0c\u6211\u8fd9\u91cc\u8bb2\u4e00\u4e0b\u600e\u4e48\u5b9e\u73b0\uff0c\u6ce8\u91ca\u5728\u4ee3\u7801\u4e2d\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\nusing namespace std;\nconst int maxn=50;\nlong long  n,k,a[maxn],ans,sum[maxn],b[maxn],y;\nvoid get(){//\u6b63\u5411\u5c55\u5f00\n\tlong long fj=1;//fj\u662f\u9636\u4e58\u4e4b\u79ef\n\tlong long ki=0;\n\tfor(long long i=1;i<=n;i++){\n\t\tfor(long long j=i+1;j<=n;j++){\n\t\t\tfj*=(n-j+1);\n\t\t\tif(a[i]>a[j]) ki++;//\u6c42a[i]\u540e\u9762\u6709\u591a\u5c11\u4e2a\u6bd4a[i]\u5927\u5f97\u6570\n\t\t}\n\t\tans+=(ki*fj);//\u52a0\u4e0a\u6bcf\u4e00\u4f4d\u7684\u503c\n\t\tki=0;//\u6e05\u695a\u4e3a\u521d\u59cb\u503c\n\t\tfj=1;//\u540c\u4e0a\n\t}\n}\nvoid get2(){//\u53cd\u5411\u6c42\n\tlong long ct=0;//ct\u8868\u793a\u5f53\u524d\u4ee5\u6c42\u5f97\u4e2a\u6570\n\tlong long m=0;//m\u4e3a\u6240\u5f97\u7684\u5546\n\tlong long p=0;//p\u4e3a\u4f59\u6570\n\tm=(y/sum[1]);\n\tp=(y%sum[1]);\n\tfor(long long i=1;i<=n;i++){//\u5982\u679c\u6709\u4e0e\u8fd9\u4e2a\u5546\u76f8\u540c\u7684\u5c31\u662f\u8fd9\u4e00\u4f4d\uff0c\u5982\u679c\u4e0d\u6e05\u695a\u4e3a\u4ec0\u4e48\uff0c\u770b\u4e00\u4e0b\u5927\u4f6c\u4eec\u8bb2\u89e3\u7684\u9006\u5c55\u5f00\n\t\tif(b[i]==m){\n\t\t\ta[++ct]=i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor(long long i=1;i<=n;i++){//\u6bd4\u8fd9\u4e2a\u6570\u5927\u7684\u6240\u6709\u6570\u90fd\u5c11\u4e86\u4e00\u4e2a\u6bd4\u672c\u8eab\u5c0f\u7684\u6570\n\t\tif(i>=a[ct]) b[i]--;\n\t}\n\twhile(ct<n-1){//\u5f00\u59cb\u6bcf\u4e00\u4f4d\u6c42\u6570\uff0c\u6c42\u4e0d\u5230\u6700\u540e\u4e00\u4f4d\n\t\tct++;\n\t\tm=p/sum[ct];\n\t\tp=p%sum[ct];\n\t\tfor(long long i=1;i<=n;i++){\n\t\t\tif(b[i]==m){\n\t\t\t\ta[ct]=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tfor(long long i=1;i<=n;i++){\n\t\t\tif(i>=a[ct]) b[i]--;\n\t\t}\n\t}\n}\nint main(){\n\t//freopen(\"1.in\",\"r\",stdin);\n//\tfreopen(\"1.out\",\"w\",stdout);\n\tscanf(\"%d%d\",&n,&k);\n\tfor(long long i=1;i<=n;i++){\n\t\tsum[i]=1;\n\t\tb[i]=i-1;\n\t\tfor(long long j=i+1;j<=n;j++){\n\t\t\tsum[i]*=(j-i);//sum\u76f8\u5f53\u662f\u6bcf\u4e00\u4f4d\u7684\u9636\u5c42\uff0c\u6211\u8fd9\u91cc\u6ca1\u6709\u7528\n\t\t}\n\t}\n\tsum[n]=0;\n\tfor(long long i=1;i<=k;i++){\n\t\tchar opt;\n\t\tscanf(\"%c\",&opt);\n\t\twhile(opt==' '||opt=='\\n') scanf(\"%c\",&opt);\n\t\tif(opt=='P'){\n\t\t\tscanf(\"%lld\",&y);\n\t\t\ty-=1;\n\t\t\tfor(long long i=1;i<=n;i++){\n\t\t\t\tb[i]=i-1;\n\t\t\t}\n\t\t\tget2();\n\t\t\tfor(long long i=1;i<=n-1;i++){\n\t\t\t\tprintf(\"%lld \",a[i]);\n\t\t\t}\n\t\t\tfor(long long i=1;i<=n;i++){//\u7279\u522b\u8f93\u51fa\u6700\u540e\u4e00\u4f4d\uff0c\u56e0\u4e3a\u4e4b\u524d\u6240\u6709\u7684\u6570\uff0c\u5728b\u7684\u53d8\u5316\u4e2d\uff0c\u6700\u7ec8\u7684\u503c\u90fd\u4f1a\u4e3a-1\uff0c\u53ea\u6709\u6700\u597d\u7528\u4e00\u4e2a\u6570\u7684b\u503c\u4e3a0\uff0c\u56e0\u6b64\uff0c\u627e\u5230\u8fd9\u4e2a\u6570\u8f93\u51fa\u6765\u3002\n\t\t\t\tif(b[i]==0){\n\t\t\t\t\tprintf(\"%lld\",i);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tcout<<endl;\n\t\t}\n\t\telse if(opt=='Q'){\n\t\t\tfor(long long i=1;i<=n;i++){\n\t\t\t\tscanf(\"%lld\",&a[i]);\n\t\t\t}\n\t\t\tans=1;\n\t\t\tget();\n\t\t\tprintf(\"%lld\\n\",ans);\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1538105718,
        "uid": 46743,
        "name": "loaky",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3014 \u3010[USACO11FEB]\u725b\u7ebfCow Line\u3011"
    }
]
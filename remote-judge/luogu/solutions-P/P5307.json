[
    {
        "content": "### \u9898\u610f\n\n\u6709\u4e00\u4e2a $r\\times c$ \u7684\u77e9\u9635 $a$\uff0c\u77e9\u9635\u7684\u6bcf\u4e2a\u4f4d\u7f6e\u90fd\u6709\u4e00\u4e2a\u6b63\u6574\u6570\uff0c\u6c42\u4ece\u5de6\u4e0a\u89d2\u8d70\u5230\u53f3\u4e0b\u89d2\u5e76\u4e14\u6ee1\u8db3\u8def\u5f84\u4e0a\u6570\u5b57\u4e58\u79ef\u4e4b\u548c\u5927\u4e8e $n$ \u7684\u65b9\u6848\u6570\u3002\n\n$\\texttt{Data Range:}1\\leq r,c\\leq 300,1\\leq n\\leq 10^6$\n\n### \u9898\u89e3\n\n[\u4e0d\u4e00\u5b9a\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/Karry5307/p/13887837.html)\n\n\u672c\u4eba\u7684\u672c\u547d\u9898\u5c45\u7136\u662f\u4e2a DP + \u6574\u9664\u5206\u5757\u5462\u3002\n\n~~\u8349\u54e6\u4e3a\u4ec0\u4e48\u8fd9\u4e2a\u9898\u76ee\u540d\u5b57\u53eb\u624b\u673a\u554a\u6211\u600e\u4e48\u770b\u4e86\u534a\u5929\u6ca1\u6709\u770b\u51fa\u4e0e\u624b\u673a\u7684\u4efb\u4f55\u5173\u8054\u5462~~\n\n\u9996\u5148\u8003\u8651\u4e00\u4e2a\u975e\u5e38 naive \u7684 DP\uff0c\u8bbe $f_{i,j,k}$ \u8868\u793a\u5728 $(i,j)$ \u4f4d\u7f6e\uff0c\u5df2\u7ecf\u8d70\u8fc7\u7684\u8def\u5f84\u4e58\u79ef\u4e4b\u548c\u4e3a $k$ \u7684\u65b9\u6848\u6570\uff0c\u90a3\u8fd9\u4e2a\u4e1c\u897f\u5f88\u660e\u663e\u7531\u4e8e\u590d\u6742\u5ea6\u4e0a\u5929\u663e\u5f97\u975e\u5e38\u4e0d\u53ef\u505a\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u6362\u4e2a\u65b9\u5411\u53bb\u601d\u8003\u8fd9\u4e2a\u95ee\u9898\uff0c\u8bbe $f_{i,j,k}$ \u8868\u793a\u5728 $(i,j)$ \u4f4d\u7f6e**\u8fd8\u9700\u8981\u4e58\u4e0a $k$\uff0c\u8def\u5f84\u7684\u4e58\u79ef\u624d\u80fd\u8d85\u8fc7 $n$**\uff0c\u8fd9\u6837\u5b50\u7684\u8bdd\u8f6c\u79fb\u5176\u5b9e\u4e5f\u5f88\u597d\u5199\uff0c\u4f46\u662f\u6bd5\u7adf\u72b6\u6001\u7684\u6570\u91cf\u8fd8\u662f\u592a\u5e9e\u5927\u4e86\uff0c\u590d\u6742\u5ea6\u4f9d\u65e7\u4e0a\u5929\u3002\n\n\u8fd9\u4e2a\u65f6\u5019\u6ce8\u610f\u5230 $k$ \u8fd9\u4e2a\u7ef4\u5ea6\u4e0a\u7684\u53d6\u503c\u5f88\u5c11\uff0c\u6839\u636e\u6574\u9664\u5206\u5757\u7684\u7406\u8bba\u53ea\u4f1a\u6709 $O(\\sqrt{n})$ \u79cd\uff0c\u6240\u4ee5\u53ef\u4ee5\u8003\u8651\u5bf9\u6240\u6709\u771f\u6b63\u6709\u7528\u7684\u503c\u6765 DP\uff0c\u8fd9\u4e2a\u65f6\u5019\u53ea\u9700\u8981\u9884\u5904\u7406\u51fa\u6bcf\u4e00\u4e2a\u53ef\u80fd\u7684\u53d6\u503c\u5bf9\u5e94\u54ea\u4e2a\u5757\u5373\u53ef\u505a\u5230 $O(rc\\sqrt{n})$\u3002\n\n\u6ce8\u610f\u5230\u8fd9\u4e1c\u897f\u7a7a\u95f4\u4f1a\u8d85\uff0c\u6240\u4ee5\u8003\u8651\u5bf9 $i$ \u8fd9\u4e00\u4f4d\u6eda\u4e00\u4e0b\u5c31\u597d\u4e86\u3002\u540c\u65f6\uff0c\u4ee3\u7801\u7ec6\u8282\u8d3c\u591a\uff0c\u7a0d\u4e0d\u6ce8\u610f\u5c31\u4f1a\u6302\u6210\u72d7\u3002\u8fd9\u4e2a\u7248\u672c\u7684\u4ee3\u7801\u8dd1\u7684\u8d3c\u6162\uff0c\u770b\u770b\u5230\u65f6\u5019\u6765\u5361\u5361\u5e38\u4ec0\u4e48\u7684\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define dv(x,y) ((x)/(y)+!!((x)%(y)))\nusing namespace std;\ntypedef int ll;\ntypedef long long int li;\nconst ll MAXN=1e6+51,MOD=1e9+7;\nll r,c,n,blkc;\nll x[351][351],d[MAXN],rv[MAXN],f[2][351][2051],blk[2051];\ninline ll read()\n{\n    register ll num=0,neg=1;\n    register char ch=getchar();\n    while(!isdigit(ch)&&ch!='-')\n    {\n        ch=getchar();\n    }\n    if(ch=='-')\n    {\n    \tneg=-1;\n    \tch=getchar();\n\t}\n    while(isdigit(ch))\n    {\n        num=(num<<3)+(num<<1)+(ch-'0');\n        ch=getchar();\n    }\n    return num*neg;\n}\nint main()\n{\n\tr=read(),c=read(),n=read();\n\tfor(register int i=1;i<=r;i++)\n\t{\n\t\tfor(register int j=1;j<=c;j++)\n\t\t{\n\t\t\tx[i][j]=read();\n\t\t}\n\t}\n\tfor(register int i=1;i<=n;i++)\n\t{\n\t\t(d[i]=dv(n,i))!=d[i-1]?blk[++blkc]=d[i],rv[d[i]]=blkc:1;\n\t}\n\tf[1][1][rv[dv(n,x[1][1])]]=1;\n\tfor(register int i=1;i<=r;i++)\n\t{\n\t\tfor(register int j=1;j<=c;j++)\n\t\t{\n\t\t\tfor(register int k=1;k<=blkc;k++)\n\t\t\t{\n\t\t\t\tif(i!=r)\n\t\t\t\t{\n\t\t\t\t\tll &s=f[(i&1)^1][j][rv[dv(blk[k],x[i+1][j])]];\n\t\t\t\t\ts=(s+f[i&1][j][k])%MOD;\n\t\t\t\t}\n\t\t\t\tif(j!=c)\n\t\t\t\t{\n\t\t\t\t\tll &s=f[i&1][j+1][rv[dv(blk[k],x[i][j+1])]];\n\t\t\t\t\ts=(s+f[i&1][j][k])%MOD;\n\t\t\t\t}\n\t\t\t\t(i!=r||j!=c||k!=blkc)?f[i&1][j][k]=0:1;\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",f[r&1][c][blkc]);\n}\n```",
        "postTime": 1603805327,
        "uid": 60990,
        "name": "Karry5307",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5307 \u3010[COCI2019] Mobitel\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u770b\u5230\u662f\u8981\u5bf9\u5411\u53f3\uff0f\u5411\u4e0b\u7684\u8def\u5f84\u8fdb\u884c\u7edf\u8ba1\uff0c\u81ea\u7136\u80fd\u591f\u60f3\u5230\u52a8\u6001\u89c4\u5212\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u5148\u5c1d\u8bd5\u5b9a\u4e49$ f[i][j][k] $\u4e3a\u4ece$ (1, 1) $\u8d70\u5230$ (i, j) $\u5e76\u4e14\u8def\u5f84\u4e0a\u7684\u6570\u5b57\u4e58\u79ef\u6070\u597d\u4e3a$k$\u7684\u8def\u5f84\u6570\u91cf\u3002\n\n\u7279\u522b\u7684\uff0c\u4e3a\u4e86\u9632\u6b62$ k $\u7684\u6570\u503c\u592a\u5927\uff0c\u8fd8\u8981\u52a0\u5165\u4e00\u4e2a\u7279\u6b8a\u60c5\u51b5\uff1a\u5f53$k = n$\u65f6\uff0c$ f[i][j][n] $\u4ee3\u8868\u8def\u5f84\u4e58\u79ef**\u81f3\u5c11**\u4e3a$n$\u7684\u8def\u5f84\u6570\u91cf\uff08\u800c\u4e0d\u662f\u6070\u597d\u4e3a$n$\uff09\u3002\n\n\u52a8\u6001\u89c4\u5212\u8f6c\u79fb\u7684\u65b9\u5f0f\u662f\uff1a\u6700\u521d$f[1][1][grid[1][1]]$\u4e3a1\uff0c\u5176\u4e2d$grid$\u5c31\u662f\u6211\u4eec\u6700\u521d\u8f93\u5165\u7684\u77e9\u9635\u3002\n\n\u7136\u540e\uff0c\u6211\u4eec\u6309\u7167\u4ece\u4e0a\u5f80\u4e0b\uff0c\u4ece\u5de6\u5f80\u53f3\u7684\u987a\u5e8f\uff0c\u5bf9\u6bcf\u4e00\u4e2a$(i, j, k)$\u505a\uff1a\n\n```cpp\nf[i+1][j][max(k * grid[i+1][j], n)] += f[i][j][k]\n\nf[i][j+1][max(k * grid[i][j+1], n)] += f[i][j][k]\n```\n\u6700\u540e\u7684\u7b54\u6848\u5c31\u662f$f[r][s][n]$\u3002\u5b9e\u73b0\u65f6\u9700\u8981\u6ce8\u610f\u8fb9\u754c\u7684\u7279\u6b8a\u60c5\u51b5\u3002\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u5df2\u7ecf\u5f97\u5230\u4e86\u4e00\u4e2a\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$ O(nrs) $\u7684\u505a\u6cd5\uff0c\u4f46\u662f\u4f9d\u7136\u4e0d\u80fd\u901a\u8fc7\u6b64\u9898\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff1a$i$\u548c$j$\u8fd9\u4e24\u7ef4\u5fc5\u987b\u4fdd\u7559\u3002\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u628a$k$\u8fd9\u4e00\u7ef4\u6539\u4e00\u4e0b\u3002\n\n\u6211\u4eec\u91cd\u65b0\u5b9a\u4e49$f[i][j][k]$\u4e3a\u4ece$ (1, 1) $\u8d70\u5230$ (i, j) $\u5e76\u4e14\u8def\u5f84\u4e0a\u7684\u6570\u5b57\u4e58\u79ef\uff0c\u8fd8\u8981**\u81f3\u5c11\u518d\u4e58$k$\u624d\u80fd\u8fbe\u5230$n$\u8fd9\u4e2a\u503c**\u3002\uff08\u8bf7\u4ed4\u7ec6\u9605\u8bfb\u8fd9\u4e2a\u5b9a\u4e49\uff0c\u5b83\u975e\u5e38\u91cd\u8981\u3002\uff09\u518d\u628a\u4e0a\u9762\u7684\u72b6\u6001\u8f6c\u79fb\u7b80\u5355\u4fee\u6539\u4e00\u4e0b\u5373\u53ef\u3002\n\n\u5982\u679c\u76f4\u63a5\u505a\u7684\u8bdd\uff0c\u590d\u6742\u5ea6\u4f9d\u7136\u662f$O(nrs)$\u7684\u3002\n\n\u4f46\u662f\u6211\u4eec\u53d1\u73b0\uff1a\u6211\u4eec\u6539\u53d8$f[i][j][k]$\u7684\u5b9a\u4e49\u540e\uff0c\u6709\u610f\u4e49\u7684$k$\u7684\u503c\u5176\u5b9e\u76f8\u5bf9\u6765\u8bf4\u5f88\u5c11\u3002\u8fd9\u4e9b\u503c\uff0c\u5c31\u662f$n$\u9664\u4ee5$1$\u81f3$n$\uff08\u5411\u4e0a\u53d6\u6574\uff09\u53ef\u4ee5\u5f97\u5230\u7684\u503c\u3002\n\n\u6bd4\u5982\uff0c\u5f53$n = 1000$\u65f6\uff1a\n| \u8def\u5f84\u4e0a\u6570\u7684\u4e58\u79ef | \u76f8\u5bf9\u5e94\u7684$k$\u7684\u503c |\n| -----------: | -----------: |\n| 1 | 1000 |\n| 2 | 500 |\n| 3 | 334 |\n| 4 | 250 |\n| 5 | 200 |\n| ... | ...|\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5bf9\u8fd9\u4e9b\u6709\u610f\u4e49\u7684$k$\u7684\u503c\u8fdb\u884c\u8ba1\u7b97\u5373\u53ef\u3002\n\n\u8fd9\u4e2a\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u73b0\u5728\u662f$O(rs\\sqrt{n})$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\u6ce8\u610f\u6b64\u9898\u9700\u8981\u4f7f\u7528\u6eda\u52a8\u6570\u7ec4\u964d\u4f4e\u7a7a\u95f4\u590d\u6742\u5ea6\u3002\n\n```cpp\n// luogu-judger-enable-o2\n#include <cstdio>\n\nusing namespace std;\n\n#define MOD 1000000007\n\nint f[2][305][2005];\nint grid[305][305];\nint divval[1000005];\nint block[2005];\nint rev[1000005];\n  \n//\u9898\u76ee\u4e2d\u7684s\u5728\u4ee3\u7801\u4e2d\u7528c\u8868\u793a\n\nint r, c, n;\n\n//ud(a, b)\u4ee3\u8868a\u9664\u4ee5b\uff0c\u5411\u4e0a\u53d6\u6574\u7684\u7ed3\u679c\u3002\n#define ud(a, b) ((a) % (b) == 0 ? (a) / (b) : (a) / (b) + 1)\n\nint main()\n{\n    scanf(\"%d%d%d\", &r, &c, &n);\n    for (int i = 1; i <= r; i++) {\n        for (int j = 1; j <= c; j++) {\n            scanf(\"%d\", &(grid[i][j]));\n        }\n    }\n    for (int i = 1; i <= n; i++) {\n        divval[i] = ud(n, i);\n    }\n    int next = 1;\n    for (int i = 1; i <= n; i++) {\n        if (divval[i] != divval[i-1]) {\n            block[next++] = divval[i];\n            rev[divval[i]] = next - 1;\n        }\n    }\n    f[1][1][rev[ud(n, grid[1][1])]] = 1;\n    for (int i = 1; i <= r; i++) {\n        for (int j = 1; j <= c; j++) {\n            for (int k = 1; k < next; k++) {\n                if (i != r) {\n                    int& down = f[(i&1)^1][j][rev[ud(block[k], grid[i+1][j])]];\n                    down += f[i&1][j][k];\n                    if (down >= MOD) down -= MOD;\n                }\n                if (j != c) {\n                    int& right = f[i&1][j+1][rev[ud(block[k], grid[i][j+1])]];\n                    right += f[i&1][j][k];\n                    if (right >= MOD) right -= MOD;\n                }\n                if (i != r || j != c || k != next - 1) f[i&1][j][k] = 0;\n            }\n        }\n    }\n    printf(\"%d\", f[r&1][c][next - 1]);\n    return 0;\n}\n\n\n\n```\n\n",
        "postTime": 1555575106,
        "uid": 148038,
        "name": "SHZhang",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5307 \u3010[COCI2019] Mobitel\u3011"
    },
    {
        "content": "\u4e00\u4e2a\u5f88\u666e\u901a\u7684dp\n\n$dp_{i,j,k}$\u8868\u793a\u7b2ci\u884c\u7b2cj\u5217\u4e58\u79ef\u4e3ak\u7684\u8def\u5f84\u6761\u6570\n\n\u72b6\u6001\u5197\u4f59\u592a\u591a\uff0c\u5e76\u4e14\u4e0d\u4f18\uff0c\u9700\u8981\u4f18\u5316\u4e00\u4e0b\n\n\n\u9996\u5148\u53ef\u4ee5\u6eda\u6389$i$\u8fd9\u4e00\u7ef4\uff0c\u63a5\u4e0b\u6765\u8003\u8651\u628a$k$\u8fd9\u4e00\u7ef4\u4f18\u5316\u6389\n\n\u4e00\u4e2a\u5b9a\u7406$[\\frac{[\\frac{n}{x}]}{y}]=[\\frac{n}{xy}]$\n\ndp\u72b6\u6001\u4fee\u6539\u4e3a$dp_{i,j,k}$\u8868\u793a\u7b2ci\u884c\u7b2cj\u5217\uff0c\u8fd8\u9700\u8981\u4e58\u4e0ak\u624d\u80fd>=n\n\n\u8fd9\u4e2ak\u7684\u503c\u57df\u662f**n\u9664\u4ee5\u6240\u6709\u6570\u4e0a\u53d6\u6574**\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u6109\u5feb\u5730dp\u4e86\n\nCode\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define maxn 310\n#define maxm 2010\n#define qy 1000000007\nusing namespace std;\nint r, s, n, a[maxn][maxn], b[1000010], tot, val[maxm], pos[1000010], dp[2][maxn][maxm];\n\ninline int read(){\n\tint s = 0, w = 1;\n\tchar c = getchar();\n\tfor (; !isdigit(c); c = getchar()) if (c == '-') w = -1;\n\tfor (; isdigit(c); c = getchar()) s = (s << 1) + (s << 3) + (c ^ 48);\n\treturn s * w;\n}\n\nint calc(int x, int y){ return x % y == 0 ? x / y : x / y + 1; }\nvoid upd(int &x, int y){ if ((x += y) >= qy) x -= qy; }\n\nint main(){\n\tr = read(), s = read(), n = read();\n\tfor (int i = 1; i <= r; ++i)\n\t\tfor (int j = 1; j <= s; ++j) a[i][j] = read();\n\tfor (int i = 1; i <= n; ++i) b[i] = calc(n, i);\n\tfor (int i = 1; i <= n; ++i)\n\t\tif (b[i] != b[i - 1]) pos[val[++tot] = b[i]] = tot;\n\tdp[1][1][pos[calc(n, a[1][1])]] = 1; \n\tfor (int i = 1; i <= r; ++i){\n\t\tint now = i & 1, nxt = now ^ 1;\n\t\tfor (int j = 1; j <= s; ++j)\n\t\t\tfor (int k = 1; k <= tot; ++k){ //printf(\"%d\\n\", dp[now][j][k]);\n\t\t\t\tif (i != r) upd(dp[nxt][j][pos[calc(val[k], a[i + 1][j])]], dp[now][j][k]);\n\t\t\t\tif (j != s) upd(dp[now][j + 1][pos[calc(val[k], a[i][j + 1])]], dp[now][j][k]);\n\t\t\t\tif (i != r || j != s || k != tot) dp[now][j][k] = 0;\n\t\t\t}\n\t}\n\tprintf(\"%d\\n\", dp[r & 1][s][tot]);\n\treturn 0;\n}\n```\n",
        "postTime": 1566351814,
        "uid": 51719,
        "name": "ModestCoder_",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5307 \u3010[COCI2019] Mobitel\u3011"
    },
    {
        "content": "\u8003\u8651\u4e00\u4e2a\u66b4\u529b dp\uff0c\u8bbe $f_{i,j,k}$ \u8868\u793a\u5f53\u524d\u5728 $(i,j)$\uff0c\u4e58\u79ef\u4e3a $k$ \u7684\u8def\u5f84\u6761\u6570\u3002\n\n\u53d1\u73b0\u6700\u540e\u4e00\u7ef4\u5176\u5b9e\u6709\u5f88\u591a\u6ca1\u7528\u7684\uff08\u6839\u672c\u4e58\u4e0d\u51fa\u6765\uff09\uff0c\u6240\u4ee5\u8003\u8651\u628a dp \u72b6\u6001\u6362\u4e3a $f_{i,j,k}$ \u8868\u793a\u5f53\u524d\u5728 $(i,j)$\uff0c\u518d\u81f3\u5c11\u4e58\u4e0a $k$ \u4e58\u79ef\u624d\u80fd\u5927\u4e8e\u7b49\u4e8e $n$ \u7684\u8def\u5f84\u6761\u6570\u3002\u8f6c\u79fb\u65f6\uff0c\u6700\u540e\u4e00\u7ef4\u7531\u539f\u672c\u7684\u4e58\u53d8\u4e3a\u9664\u5373\u53ef\uff08\u9700\u8981\u4e0a\u53d6\u6574\uff09\u3002\n\n\u53d1\u73b0\u6700\u540e\u4e00\u7ef4\u53ea\u80fd\u4e3a $\\forall i \\in [1,n],\\lceil \\dfrac{n}{i} \\rceil$ \u4e2d\u4e0d\u91cd\u590d\u7684\u6570\u3002\u4e0e\u6570\u8bba\u5206\u5757\u7c7b\u4f3c\uff0c\u8fd9\u6837\u7684\u6570\u662f $O(\\sqrt{n})$ \u7ea7\u522b\u7684\u3002\n\n\u7528 $O(\\sqrt{n})$ \u4e2a\u6570\u6765\u6620\u5c04\u8fd9\u4e9b\u6570\uff0c\u518d\u628a\u7b2c\u4e00\u7ef4\u6eda\u6389\u5373\u53ef\u3002\u590d\u6742\u5ea6 $O(rs\\sqrt{n})$\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\nusing namespace std;\nconst int p=1e9+7;\nconst int N=1e6+10;\nconst int M=310;\nint n,m,K;\nint a[M][M];\nint f[2][M][2010];\nint mp[N],cnt,id[N];\nvoid upd(int &x,int y)\n{\n\tx+=y,x%=p;\n}\nint LLL(int x,int y)//\u4e0a\u53d6\u6574\u9664\u6cd5\n{\n\tif(x%y==0) return x/y;\n\treturn x/y+1;\n}\nint main()\n{\n\tscanf(\"%d%d%d\",&n,&m,&K);\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++) scanf(\"%d\",&a[i][j]);\n\tfor(int i=1;i<=K;i++)\n\t\tif(LLL(K,i)!=mp[cnt]) mp[++cnt]=LLL(K,i),id[LLL(K,i)]=cnt;\n\tf[1][1][id[LLL(K,a[1][1])]]=1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint t=(i%2);\n\t\tif(i!=1) for(int j=1;j<=m;j++)\n\t\t\tfor(int k=0;k<=cnt;k++) f[t][j][k]=0;\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tfor(int k=0;k<=cnt;k++)\n\t\t\t{\n\t\t\t\tupd(f[t][j][id[LLL(mp[k],a[i][j])]],f[t][j-1][k]);\n\t\t\t\tupd(f[t][j][id[LLL(mp[k],a[i][j])]],f[1-t][j][k]);\n\t\t\t}\n\t}\n\tprintf(\"%d\",f[n%2][m][cnt]);\n\treturn 0;\n}\n```",
        "postTime": 1630984701,
        "uid": 186587,
        "name": "BBD186587",
        "ccfLevel": 0,
        "title": "P5307"
    },
    {
        "content": "**P5307 sol**\n\n\u8003\u8651\u4e00\u4e2a\u6700\u66b4\u529b\u7684 dp\uff0c\u8bbe $dp_{i,j,k}$ \u8868\u793a\u8d70\u5230 $(i,j)$ \u4e58\u79ef\u4e3a $k$ \u7684\u8def\u5f84\u6570\uff0c\u76f4\u63a5\u679a\u4e3e\u4e09\u4e2a\u7ef4\u5ea6\u5e76\u5bf9\u7b2c\u4e09\u7ef4\u63a7\u5236\u5927\u5c0f\uff0c\u5411\u540e\u9762\u8f6c\u79fb\u5373\u53ef\u3002\n\n\u89c2\u5bdf\u5230\u65e0\u6cd5\u901a\u8fc7\u6b64\u9898\uff0c\u5e76\u4e14\u4e0d\u592a\u53ef\u80fd\u5b58\u5728\u66f4\u4f18\u7684\u672c\u8d28\u4e0d\u540c\u9014\u5f84\u8ba1\u6570\u3002\u5c1d\u8bd5\u4f18\u5316\u672c\u8eab\u7684 dp \u72b6\u6001\u3002\n\n\u8bbe $dp_{i,j,k}$ \u8868\u793a\u8fd8\u8981\u4e58\u4e0a $k$ \u624d\u80fd\u8f6c\u79fb\u7684\u8def\u5f84\u603b\u6570\uff0c\u663e\u7136 $k$  \u5f62\u5982 $\\lceil \\frac{n}{i} \\rceil$ \u8fd9\u79cd\u5f62\u5f0f\uff0c\u6570\u91cf\u7ea7\u4e3a $\\sqrt n$\uff0c\u9884\u5904\u7406\u51fa\u6765\u79bb\u6563\u5316\u540e\u518d\u8f6c\u79fb\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(rs\\sqrt n)$\u3002\n\n```cpp\n#include \"bits/stdc++.h\"\nusing namespace std;\nconst int Len = 3e2 + 5 , mod = 1e9 + 7 , M = 1e6 + 5;\nint ans,n,m,dp[2][Len][2005],rec[M],k,v[Len][Len],ct,cer[M];\ninline int flr(int N,int x)\n{\n\tif(N % x == 0) return N / x;\n\treturn N / x + 1;\n}\ninline void Mod(int &x){if(x >= mod) x -= mod;}\nint main()\n{\n\tscanf(\"%d %d %d\",&n,&m,&k);\n\tfor(int i = 1 ; i <= n ; i ++)\n\t\tfor(int j = 1 ; j <= m ; j ++) scanf(\"%d\",&v[i][j]);\n\tfor(int i = 1 ; i <= k ; i ++) \n\t{\n\t\tif(rec[flr(k , i)]) continue;\n\t\trec[flr(k , i)] = ++ ct;\n\t\tcer[ct] = flr(k , i);\n\t}\n\tdp[1][1][rec[flr(k , v[1][1])]] = 1;\n\tfor(int i = 1 ; i <= n ; i ++)\n\t{\n\t\tfor(int j = 1 ; j <= m ; j ++)\n\t\t\tfor(int p = 1 ; p <= ct ; p ++) dp[(i + 1) & 1][j][p] = 0;\n\t\tfor(int j = 1 ; j <= m ; j ++)\n\t\t{\n\t\t\tint dx = i + 1 , dy = j;\n\t\t\tif(dx > n || dy > m);\n\t\t\telse for(int p = 1 ; p <= ct ; p ++) Mod(dp[dx & 1][dy][rec[flr(cer[p] , v[dx][dy])]] += dp[i & 1][j][p]);\n\t\t\tdx = i , dy = j + 1;\n\t\t\tif(dx > n || dy > m);\n\t\t\telse for(int p = 1 ; p <= ct ; p ++) Mod(dp[dx & 1][dy][rec[flr(cer[p] , v[dx][dy])]] += dp[i & 1][j][p]);\n\t\t}\n\t}\n\tprintf(\"%d\\n\",dp[n & 1][m][rec[1]]);\n\treturn 0;\n}\n```",
        "postTime": 1665620816,
        "uid": 782894,
        "name": "Kuon",
        "ccfLevel": 0,
        "title": "\u5373\u4f7f\u8bde\u751f\u4e8e\u6df1\u9083\u9ed1\u6697\uff0c\u5fae\u5fae\u95ea\u70c1\uff0c\u6447\u6447\u6b32\u706d"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5307)\n\n## \u6574\u9664\u5206\u5757 + dp\n\n\u56e0\u4e3a\u6709\u65e0\u540e\u6548\u6027\uff0c\n\n\u6240\u4ee5\u6211\u4eec\u4e00\u770b\u5c31\u53ef\u4ee5\u60f3\u5230\u4e8c\u7ef4 dp\u3002\n\n- \u8bbe $f_{i,j,k}$ \u8868\u793a\u8d70\u5230\u70b9 $(i,j)$ \u540e\u4e58\u79ef\u4e3a $k$ \u7684\u8def\u5f84\u6570\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u6253\u51fa\u4e00\u4e2a $O(rsn)$ \u7684\u505a\u6cd5\u3002\n\n\u663e\u7136\u4f1a\u70b8\uff0c\u5197\u4f59\u72b6\u6001\u8fc7\u591a\u3002\n\n\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53d1\u73b0\uff1a\n\n\u5047\u8bbe $n=7$\uff0c\u90a3\u4e48 $k=4,5,6$ \u5176\u5b9e\u662f\u7b49\u4ef7\u7684\u3002\n\n\u56e0\u4e3a\u8fd9\u4e9b\u6570\u672c\u8eab\u4e0d\u6ee1\u8db3\u6761\u4ef6\uff0c\u53ea\u8981\u4e58\u4ee5\u4e00\u4e2a $2$ \u5c31\u53ef\u4ee5\u6ee1\u8db3\u6761\u4ef6\u3002\n\n\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u53ef\u4ee5\u4f18\u5316\u4e86\uff1a\n\n- \u8bbe $f_{i,j,k}$ \u8868\u793a\u8d70\u5230\u70b9 $(i,j)$ \u540e\uff0c**\u8fd8\u9700\u8981\u518d\u81f3\u5c11\u4e58\u4ee5** $k$ \u624d\u80fd\u4e0d\u5c0f\u4e8e $n$ \u7684\u8def\u5f84\u6570\u3002\n\n\u4f46\u662f\uff0c\u6211\u4eec\u53d1\u73b0\u4e00\u4e2a\u5f88\u4e25\u91cd\u7684\u95ee\u9898\uff1a\n\n\u72b6\u6001\u6570\u8fd8\u662f\u6ca1\u6709\u51cf\u5c11\uff01\uff01\uff01\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u60f3\u5230**\u6574\u9664\u5206\u5757**\u5e38\u89c1\u7ed3\u8bba\uff1a\u5bf9\u4e8e\u6b63\u6574\u6570 $n$\uff0c$\\lfloor\\frac ni\\rfloor$ \u7684\u4e0d\u540c\u503c\u4e2a\u6570\u662f $O(\\sqrt n)$ \u7684\u3002\n\n\u90a3\u6211\u4eec\u662f\u4e0d\u662f\u53ef\u4ee5\u7c7b\u6bd4\uff1a$\\lceil\\frac ni\\rceil$ \u7684\u4e0d\u540c\u503c\u4e2a\u6570\u4e5f\u662f $O(\\sqrt n)$ \u7684\u3002\n\n\u8fd9\u4e2a\u662f\u53ef\u4ee5\u8bc1\u660e\u7684\uff0c\u8fd9\u91cc\u4e0d\u7ec6\u8bb2\u3002\n\n\u90a3\u4e48\uff0c\u6211\u4eec\u5148\u9884\u5904\u7406\u51fa\u8fd9\u6839\u53f7\u4e2a\u503c\uff0c\u8fd9\u6837 $k$ \u7684\u72b6\u6001\u6570\u5c31\u538b\u5230\u4e86\u6839\u53f7\u3002\n\n\u4e8e\u662f\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u538b\u5230\u4e86 $O(rs\\sqrt n)$\uff0c\u53ef\u8fc7\u6b64\u9898\u3002\n\n\u6ce8\uff1a\u672c\u9898\u7a7a\u95f4\u597d\u50cf\u4f1a\u70b8\uff0c\u6240\u4ee5\u5efa\u8bae\u538b\u4e00\u4e0b\u7ef4\n\n## code\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define dv(x,y) (((x)+(y)-1)/(y))//\u5411\u4e0a\u53d6\u6574\nusing namespace std;\nconst int N=310,M=2010,p=1e9+7;\nint r,c,n,a[N][N],f[2][N][M],bl[M],rv[M*M],tot;\n#define add(x,y) (x=((x)+(y))%p)\nsigned main(){\n\tscanf(\"%lld%lld%lld\",&r,&c,&n);\n\tfor(int i=1;i<=r;i++){\n\t\tfor(int j=1;j<=c;j++)scanf(\"%lld\",&a[i][j]);\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tif(dv(n,i)!=(i==1?0:dv(n,i-1)))bl[rv[dv(n,i)]=++tot]=dv(n,i);\n\t}\n\tf[1][1][rv[dv(n,a[1][1])]]=1;\n\tfor(int i=1;i<=r;i++){\n\t\tfor(int j=1;j<=c;j++){\n\t\t\tfor(int k=1;k<=tot;k++){//\u4ecefi,j\u5411fi+1,j\u548cfi,j+1\u8f6c\u79fb \n\t\t\t\tif(i^r)add(f[i+1&1][j][rv[dv(bl[k],a[i+1][j])]],f[i&1][j][k]);\n\t\t\t\tif(j^c)add(f[i&1][j+1][rv[dv(bl[k],a[i][j+1])]],f[i&1][j][k]);\n\t\t\t\tif(i!=r||j!=c||k!=tot)f[i&1][j][k]=0;\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",f[r&1][c][tot]);\n}\n```",
        "postTime": 1642333499,
        "uid": 310802,
        "name": "_Diu_",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5307 [COCI2019] Mobitel"
    },
    {
        "content": "\u849f\u84bb\u8fd9\u9053\u9898\u5b66\u4e86\u4e09\u5929\u624d\u5b66\u61c2\uff0c\u8fd9\u91cc\u6765\u5206\u4eab\u4e00\u4e0b\u5b66\u4e60\u7ecf\u9a8cqwq\n\n~~\u5148\u611f\u8c22\u67d0\u4f4d\u91d1\u94a9\u7237\u7684\u5168\u7a0b\u5e2e\u52a9~~\n\n### \u5207\u5165\u6b63\u9898\n\n\u4ece\u77e9\u9635\u7684\u5de6\u4e0a\u89d2\u8d70\u5230\u53f3\u4e0b\u89d2\uff0c\u6ee1\u8db3\u4e00\u5b9a\u6761\u4ef6\uff0c\u65b9\u6848\u6570\u6709\u591a\u5c11\u79cd\uff0c\u5f88\u660e\u663e\u7684\u8ba1\u6570\u7c7bdp\uff0c\u6211\u4eec\u5148\u8fdb\u884c\u8bbe\u8ba1\u72b6\u6001\u3002\n\n#### \u521d\u59cb\u60f3\u6cd5\n\n\u6211\u4eec\u8bbe `f[i][j][k]` \u8868\u793a\u6211\u4eec\u7684\u4f4d\u7f6e\u5904\u5728 $(i,j)$ \u65f6\uff0c\u83b7\u5f97\u7684\u4e58\u79ef\u4e3a $k$ \u7684\u65b9\u6848\u6570\u6709\u591a\u5c11\u79cd\u3002\n\n\u6211\u4eec\u8003\u8651\u590d\u6742\u5ea6\u95ee\u9898\uff0c\u9996\u5148\uff0c $k$ \u7684\u503c\u57df\u5728 $10^6$ \u4e0a\uff0c$i$ \u548c $j$ \u90fd\u5728 $10^3$ \u4e0a\uff0c\u5f88\u663e\u7136\u6570\u7ec4\u5f00\u4e0d\u4e0b\uff0c\u65f6\u95f4\u4e5f\u8fc7\u4e0d\u53bb\uff0c\u8003\u8651\u4f18\u5316\u3002\n\n### \u4f18\u53161\n\n\u9898\u76ee\u4e2d\u8bf4\u9053\uff1a\u53ea\u80fd\u5411\u53f3\u65b9\u548c\u4e0b\u65b9\u8d70\uff0c\u90a3\u4e48\u7b54\u6848\u80af\u5b9a\u7531\u4e0a\u4e00\u884c\u6216\u8005\u5de6\u8fb9\u8f6c\u79fb\u6765\uff0c\u56e0\u6b64\uff0c $i$ \u90a3\u4e00\u4f4d\uff0c\u5b8c\u5168\u53ef\u4ee5\u6eda\u6389\uff0c\u53ea\u7528\u6839\u636e\u5947\u5076\u6027\u4fdd\u5b58 $2$ \u884c\u7684\u7b54\u6848\u3002\n\n\u4f46\u662f\u6211\u4eec\u4ecd\u65e7\u53d1\u73b0\uff0c $k$ \u7684\u503c\u57df\u5728 $10^6$ \u4e0a\uff0c\u4ecd\u7136\u4f1a\u4ee4\u7a7a\u95f4\u548c\u65f6\u95f4\u8d85\u9650\uff0c\u5fc5\u987b\u5bf9 $k$ \u8fd9\u4e00\u7ef4\u8fdb\u884c\u4f18\u5316\u3002\n\n### \u4f18\u53162\n\n\u6211\u4eec\u6539\u53d8\u4e00\u4e0b\u72b6\u6001\uff0c\u8c03\u6574\u4e3a\uff1a\u5728\u4f4d\u7f6e $(i,j)$ \u7684\u65f6\u5019\uff0c\u8fd8\u9700\u8981\u518d\u4e58\u4e0a $k$ \uff0c\u624d\u80fd\u6ee1\u8db3\u8def\u5f84\u4e58\u79ef\u5927\u4e8e\u7b49\u4e8e $n$ \u8fd9\u6837\u7684\u6761\u4ef6\u7684\u65b9\u6848\u6570\u3002\u90a3\u4e48\u663e\u7136\uff0c\u8fd9\u91cc\u7684 $k$ \u7684\u503c\u5b9e\u9645\u4e0a\u662f $n$ \u9664\u4ee5 $sum$ \u518d\u5411\u4e0a\u53d6\u6574\uff0c $sum$ \u4e3a\u73b0\u5728\u7684\u7d2f\u8ba1\u503c\u3002\u90a3\u4e48\u8fd9\u6837\u7684 $k$ \u6709\u591a\u5c11\u4e2a\u5462\uff1f\n\n\u6839\u636e\u6570\u8bba\u5206\u5757\u7406\u8bba\uff0c $\\lceil \\frac{n}{i} \\rceil$ \u548c $\\lfloor \\frac{n}{i} \\rfloor$ \u7684\u4e2a\u6570\u503c\u57df\u5728 $\\sqrt{n}$ \u4e0a\u3002\n\n+ \u7b80\u6613\u8bc1\u660e\uff1a\u6211\u4eec\u4ece $\\frac{n}{1}$ \u4e00\u76f4\u7b97\u5230 $\\frac{n}{ \\lceil \\sqrt{n} \\rceil}$ \uff0c\u6700\u591a\u6709 $\\sqrt{n}$ \u79cd\uff0c\u6bcf\u79cd\u5728\u5927\u4e8e $\\sqrt{n} $ \u7684\u90e8\u5206\u4e5f\u5bf9\u5e94\u4e00\u4e2a\uff0c\u6240\u4ee5\u503c\u57df\u5728 $\\sqrt{n}$ \u4e0a\u3002\n\n+ \u5bf9\u4e8e\u8fd9\u9053\u9898\u7684\u5177\u4f53\u5b9e\u73b0\uff1a\n\n\u6211\u4eec\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u6240\u6709\u7684 $\\lceil \\frac{n}{i}\\rceil (i\\in[1,n])$ \u7684\u503c\uff0c\u5c06\u4ed6\u4eec\u79bb\u6563\u5316\uff0c\u8fd9\u6837\u6700\u591a\u6709 $2\\times \\sqrt{n}$ \u4e2a\u6570\u3002\u8f6c\u79fb\u7684\u65f6\u5019\uff0c\u904d\u5386\u6bcf\u4e2a $k$ \uff0c\u6211\u4eec\u4ece\u4e0a\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u5c06\u79ef\u4e58\u4e0a\u4e00\u4e2a $a_{i,j}$ \uff0c\u76f8\u5f53\u4e8e\u628a\u72b6\u6001\u91cc\u7684 $k$ \u53d8\u6210 $\\lceil \\frac{k}{a_{i,j}}\\rceil$ \uff08\u8fd8\u9700\u8981\u4e58 $k$ \u624d\u80fd\u5927\u4e8e\u7b49\u4e8e $n$\uff0c\u8f6c\u79fb\u540e\uff0c\u4e58\u4e0a\u4e86\u4e00\u4e2a $a_{i,j}$ \uff0c\u5c31\u9664\u56de\u53bb\u5c31\u884c\u4e86\uff09\u3002\n\n### Code\n\n+ \u5728\u849f\u84bb\u7684\u4ee3\u7801\u4e2d\uff0c\u9898\u9762\u4e2d\u7684 $n$ \u662f `K`\uff0c`f` \u6570\u7ec4\u662f\u4fdd\u5b58\u72b6\u6001\u7684\uff0c `where` \u662f\u79bb\u6563\u5316\u540e\u7684\u503c\uff0c`mp` \u662f\u79bb\u6563\u5316\u56de\u53bb\u7684\u6620\u5c04\u6570\u7ec4\u3002\n\n+ \u8f93\u51fa\u7b54\u6848\u7684\u65f6\u5019\uff0c\u80af\u5b9a\u662f\u5728\u53f3\u4e0b\u89d2\u7684\u4f4d\u7f6e\uff0c\u8fd8\u9700\u8981\u4e58 $1$ \u5c31\u53ef\u4ee5\u6ee1\u8db3\u6761\u4ef6\u5566\u3002\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<queue>\n#include<iostream>\n#include<cstring>\n#include<ctime>\n#include<cmath>\nusing namespace std;\ninline int calc(int x,int y) {\n    if(x%y==0) return x/y;\n    return x/y+1;\n}\nint n,m,N;\n#define maxn 305\nint cnt,mp[3000];\nconst int p=1e9+7;\nint f[2][maxn][3000],a[maxn][maxn],where[1000005];\nvoid getans(int &x,int y) {\n    x+=y;\n    x%=p;\n}\nint main() {\n    int c1=clock();\n#ifdef LOCAL\n    freopen(\"in.in\",\"r\",stdin);\n    freopen(\"out.out\",\"w\",stdout);\n#endif\n    //=========================================\n     scanf(\"%d%d%d\",&n,&m,&N);\n     for(int i=1;i<=n;i++) {\n         for(int j=1;j<=m;j++) {\n             scanf(\"%d\",&a[i][j]);\n         }\n     }\n     for(int i=1;i<=N;i++) {\n         if(calc(N,i)!=mp[cnt]) {\n             mp[++cnt]=calc(N,i);\n             where[calc(N,i)]=cnt;\n         }\n     }\n     f[1][1][where[calc(N,a[1][1])]]=1;\n     for(int i=1;i<=n;i++) {\n         int hang=i&1;\n         if(i!=1) for(int j=1;j<=m;j++) {\n             for(int N=0;N<=cnt;N++) f[hang][j][N]=0;\n         }\n         for(int j=1;j<=m;j++) {\n             for(int N=0;N<=cnt;N++) {\n                 getans(f[hang][j][where[calc(mp[N],a[i][j])]],f[hang][j-1][N]);\n                 getans(f[hang][j][where[calc(mp[N],a[i][j])]],f[hang^1][j][N]);\n             }\n         }\n     }\n     printf(\"%d\\n\",f[n&1][m][where[1]]);\n    //=========================================\n    cerr<<\"Tmie Used:\"<<clock()-c1<<\"ms\"<<endl;\n    return 0;\n}\n```",
        "postTime": 1634101442,
        "uid": 229919,
        "name": "\u4e00E\u5b64\u884c",
        "ccfLevel": 6,
        "title": "P5307 \u9898\u89e3"
    }
]
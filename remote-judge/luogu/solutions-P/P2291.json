[
    {
        "content": "\u6c42\u7b2c $k$ \u5c0f\u7684 $a^b>n$\uff0c$a,b\\in Prime$\u3002\n\n\u8fd9\u79cd\u4e1c\u897f\u4e00\u770b\u5c31\u4e0d\u662f\u5f88\u597d\u505a\uff0c\u4f46\u662f\u6211\u4eec\u8003\u8651 $2^{67}$ \u8fdc\u8fdc\u5927\u4e8e $10^{18}$\uff0c\u6240\u4ee5\u53ef\u4ee5\u786e\u8ba4 $b$ \u6700\u5927\u4e0d\u4f1a\u8d85\u8fc7 $67$\uff0c\u4e14 $b$ \u662f\u8d28\u6570\uff0c\u90a3\u4e48 $b\\in\\{2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61\\}$\u3002\n\n\u5e42\u6b21\u8fd9\u4e48\u5c11\uff0c\u662f\u4e0d\u662f\u76f4\u63a5\u679a\u4e3e\u5c31\u53ef\u4ee5\u5462\uff1f\u4f46\u6211\u4eec\u53d1\u73b0 $b=2$ \u65f6\u6bd4\u8f83\u7279\u6b8a\uff0c$a\\leq 10^9$\uff0c\u800c $b\\geq 3$ \u65f6 $a\\leq 10^6$\uff0c\u5bf9\u4e8e $a\\leq 10^9$ \u8fd9\u4e2a\u8303\u56f4\u6211\u4eec\u662f\u4e0d\u80fd\u627f\u53d7\u7684\u3002\u6240\u4ee5\u8003\u8651\u6839\u636e $n$ \u7684\u8303\u56f4\u5f97\u51fa $b=2$ \u65f6\u7684\u4e00\u4e2a\u7d27\u786e\u4e0a\u4e0b\u754c\u3002\u7531 $n>a^2$ \u5f97\u5230 $\\sqrt n> a$\uff0c\u5e76\u4e14\u6839\u636e $k\\leq 100000$\uff0c\u6211\u4eec\u5927\u6982\u63a8\u7b97\u51fa $a\\in(\\sqrt n,\\sqrt n+3\\times 10^6]\\bigcap \\mathrm{Prime}$\u3002\u8fd9\u6837\u6211\u4eec\u7b5b\u51fa $a\\in(\\sqrt n,\\sqrt n+3\\times 10^6]$ \u5185\u7684\u8d28\u6570\uff0c\u5e76\u7edf\u8ba1\u8d21\u732e\u5c31\u89e3\u51b3\u4e86 $b=2$ \u65f6\u7684\u60c5\u51b5\u3002\n\n\u5bf9\u4e8e $b\\geq 3$ \u7684\u60c5\u51b5\uff0c\u8bbe\u6bcf\u4e2a $b$ \u5bf9\u5e94\u7684 $a$ \u7684\u4e0a\u754c\u90fd\u4e3a $10^6$\uff0c\u5219\u6700\u591a\u679a\u4e3e\u4e86 $\\frac{10^6}{\\ln 10^6}\\times 17\\approx 1214185$ \u4e2a\u6570\u3002\u4e8b\u5b9e\u4e0a\u8fdc\u8fdc\u8fbe\u4e0d\u5230\u8be5\u4e0a\u754c\uff0c\u56e0\u4e3a $a^b$ \u4f1a\u5feb\u901f\u589e\u957f\u76f4\u5230\u8fdc\u8fdc\u5927\u4e8e $10^{18}$\u3002\n\n\u5728\u5b9e\u9645\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u4e0a\u8ff0\u7406\u8bba\u4f30\u7b97\u5b58\u5728\u8bef\u5dee\uff0c\u5bf9\u4e8e $b\\geq 3$ \u7684\u60c5\u51b5 $a$ \u7684\u4e0a\u754c\u5927\u6982\u5728 $2\\times 10^6$ \u5904\u624d\u80fd\u53d6\u5230\u6240\u6709\u7b54\u6848\uff0c\u9700\u8981\u5fae\u8c03\u3002\n\n\u672c\u4ee3\u7801\u53ef\u4ee5\u901a\u8fc7 $\\text{darkbzoj}$ \u6240\u6709\u6570\u636e\uff0c$\\text{Luogu}$ \u6570\u636e\u592a\u6c34\u4e86/fad\n\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<climits>\n#include<algorithm>\n//18*78498=1412964\ntypedef unsigned long long ll;\nint num=0,tot=0;\nconst int sp[]={3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61};\nint p[4000005],v[4000005];\nll n,ans[10000005];\ninline ll read() {\n\tll x=0,f=1;register char s=getchar();\n\twhile(s>'9'||s<'0') {if(s=='-') f=-1;s=getchar();}\n\twhile(s>='0'&&s<='9') {x=x*10+s-'0';s=getchar();}\n\treturn x*f;\n}\ninline void write(ll x) {\n\tif(x==0) {return;}\n\twrite(x/10);\n\tputchar((char)('0'+x%10));\n}\ninline ll pow(ll x,ll p) {ll res=1;for(;p;p>>=1) {if(p&1) res=res*x; x=x*x;} return res;}\ninline void makePrime(int n) {\n\tfor(register int i=2;i<=n;++i) {\n\t\tif(!v[i]) p[++num]=i;\n\t\tfor(register int j=1;j<=num&&i*(ll)p[j]<=n;++j) {\n\t\t\tv[i*p[j]]=1;\n\t\t\tif(i%p[j]==0) break;\n\t\t}\t\n\t}\n} \ninline void makePrime(int l,int r) {\n\tfor(register int i=0;i<=r-l;++i) v[i]=0;\n\tif(l==1) v[0]=1;\n\tfor(register int i=1;i<=num;++i) {\n\t\tint x=p[i];\n\t\tfor(register int j=r/x*x;j>=l&&j>x;j-=x) {v[j-l]=1;}\n\t}\n\tfor(register int i=l;i<=r;++i) {\n\t\tif(!v[i-l]&&i*(ll)i!=n) ans[++tot]=i*(ll)i;\n\t}\n}\ninline void divide(ll n) {\n\tfor(ll i=2;i<=n;++i) {\n\t\tif(n%i) continue;\n\t\tint cnt=0;\n\t\twhile(n%i==0) {n/=i; ++cnt;}\n\t\tprintf(\"%lld %d\\n\",i,cnt);\n\t}\n}\nsigned main() {\n\tn=read(); int k=read();\n\tmakePrime(4e6);\n\tmakePrime((int)ceil(sqrt(n)),(int)ceil(sqrt(n))+(int)3e6);\n\tfor(register int i=1;i<=num&&p[i]<=2e6;++i) {\n\t\tfor(register int j=0;j<17;++j) {\n\t\t\tll tmp=0;\n\t\t\tif((sp[j]*log(p[i]))>=log((double)ULLONG_MAX)) break;\n\t\t\tif((tmp=pow((ll)p[i],(ll)sp[j]))>n) ans[++tot]=tmp;\n\t\t}\n\t}\n\tstd::sort(ans+1,ans+1+tot);\n\tprintf(\"%llu\\n\",ans[k]);\n\treturn 0;\n}\n```",
        "postTime": 1606572609,
        "uid": 95244,
        "name": "tommymio",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2291 \u3010[PA2011]Prime prime power \u8d28\u6570\u7684\u8d28\u6570\u6b21\u65b9\u3011"
    },
    {
        "content": "\u770b\u4e86\u4e0b\u9898\u89e3\u533a\uff0c\u611f\u89c9\u6700\u540e\u6709\u4eba\u662f\u4e71\u5224\u7684\u7d20\u6570\uff0c\u6709\u4eba\u751a\u81f3\u7528\u4e0a\u4e86 Miller-Rabin\u3001Min_25 \u7b5b\uff1f\u5efa\u8bae\u505a\u4e00\u4e0b [\u8fd9\u9898](https://www.luogu.com.cn/problem/P1835)\u3002\n\n\u5176\u5b9e\u4e71\u505a\u4e00\u4e0b\u5c31\u597d\u4e86\u3002$b\\ge 3$ \u7684\u60c5\u5f62\u6ca1\u5565\u53ef\u8bb2\uff0c\u76f4\u63a5\u5207\u5165\u6b63\u9898 $b=2$\uff0c\u53d1\u73b0\u53ea\u9700\u7b97\u67d0\u4e2a\u533a\u95f4\u7684\u7d20\u6570\u4e2a\u6570\u3002\u867d\u7136\u5de6\u53f3\u7aef\u70b9\u90fd\u662f $10^9$ \u7ea7\u522b\uff0c\u4f46\u76ee\u6d4b\u4e00\u4e0b\u5c31\u6709 $[10^9,10^9+2.1\\times 10^6]$ \u4e2d\u6709\u8d85\u8fc7 $10^5$ \u4e2a\u7d20\u6570\u3002\u4e8e\u662f\u533a\u95f4\u957f\u5ea6\u5c31\u88ab\u53d8\u6210\u4e86 $10^6$\u3002\n\n\u8003\u8651\u8fd9\u65f6\u548b\u505a\u3002\u7531\u4e8e\u5408\u6570 $n$ \u5fc5\u6709\u4e00\u5c0f\u4e8e $\\sqrt n$ \u7684\u7d20\u56e0\u5b50\uff0c\u56e0\u6b64\u53ea\u7528\u5148\u7b5b\u51fa\u6765 $[1,4\\times 10^4]$ \u4e2d\u7684\u6240\u6709\u7d20\u6570\uff0c\u518d\u7528\u7c7b\u4f3c\u57c3\u7b5b\u7684\u601d\u60f3\u7b5b\u51fa\u5927\u533a\u95f4\u91cc\u7684\u6240\u6709\u7d20\u6570\u3002\u7531\u4e8e\u5927\u533a\u95f4\u7684\u957f\u5ea6\u4e0d\u5927\uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u53ea\u6709 $O(k\\ln k\\ln n)$\u3002\u518d\u52a0\u4e0a $b\\ge 3$ \u90e8\u5206\u7684\u590d\u6742\u5ea6\uff0c\u8dd1\u8d77\u6765\u5e94\u8be5\u8fd8\u662f\u5f88\u5feb\u7684\u3002",
        "postTime": 1660228259,
        "uid": 733594,
        "name": "Karry235",
        "ccfLevel": 0,
        "title": "\u7b80\u5355\u65b9\u6cd5"
    },
    {
        "content": "\u3002\u3002\u3002\u53bb darkbzoj \u4e0a\u9762\u8bc4\u6d4b\uff0c\u8bc4\u6d4b\u673a\u8001\u662f\u62bd\u98ce\u7ed9\u6211 TLE\u3002\u3002\u3002\n\n\u597d\u5728\u5982\u679c\u5bc4\u4e86\u4f1a\u8bfb\u53d6\u4e0a\u4e00\u6b21\u7684\u7ed3\u679c\uff0c\u4f46\u662f\u5982\u679c\u6709\u4eba\u53c8\u4ea4\u4e86\u4e00\u53d1\u5c31\u5168\u90e8\u6728\u5927\u4e86/fn\n\n~~\u5c1d\u8bd5\u7528\u4e00\u4e2a\u6781\u5176\u5947\u602a\u7684\u7b97\u6cd5\u8349\u8fc7\u53bb~~\n\n\u9996\u5148\u77e5\u9053\u7b54\u6848\u662f $p^q$ \u7684\u5f62\u5f0f\uff0c\u6211\u4eec\u679a\u4e3e\u8fd9\u4e2a $q$\u3002\u5f53 $q=2$ \u65f6\u4e00\u5b9a\u80fd\u5728 ll \u8303\u56f4\u5185\u641c\u51fa\u89e3\uff0c\u6240\u4ee5\u53ef\u4ee5\u77e5\u9053 $q\\leq 64$\uff0c\u800c\u4e14\u5f53 $q$ \u8fc7\u5927\u65f6\u53ef\u9009\u7684\u503c\u4e5f\u5f88\u5c11\u3002\n\n\u8003\u8651 $q=2$\uff0c\u662f\u6700\u9ebb\u70e6\u7684\u4e00\u90e8\u5206\u3002\u8003\u8651\u5728 $\\sqrt{n}$ \u9644\u8fd1\u786e\u5b9a\u4e00\u6bb5\u533a\u95f4\uff0c\u8fd9\u6bb5\u533a\u95f4\u4e2d\u6709\u6070\u597d $k$ \u4e2a\u8d28\u6570\u3002\n\n\u6211\u4eec\u77e5\u9053\u7d20\u6570\u5bc6\u5ea6\u662f $O(\\ln n)$\uff0c\u6240\u4ee5\u8fd9\u4e2a\u533a\u95f4\u7684\u957f\u5ea6\u4e00\u5b9a\u662f $O(k\\ln n)$ \u7ea7\u522b\u7684\u3002\u957f\u5ea6\u53ef\u4ee5\u7528 min25 \u7b5b+\u4e8c\u5206\u627e\u51fa\u6765\u3002\u5927\u6982\u5728 2e6 \u7ea7\u522b\u3002\n\n\u73b0\u5728\u7684\u95ee\u9898\u5c31\u662f\u6c42\u51fa\u4e00\u4e2a 2e6 \u7684\u533a\u95f4\u4e2d\u6709\u54ea\u4e9b\u6570\u662f\u8d28\u6570\u3002\u533a\u95f4\u7b5b\u76f4\u63a5\u83bd\u5373\u53ef\u3002\n\n$q=3$ \u65f6\uff0c\u503c\u57df\u7f29\u5c0f\u5230\u4e86 $10^6$\uff0c\u53ef\u4ee5\u76f4\u63a5\u66b4\u529b\u7b5b\u51fa $2\\times 10^6$ \u4e2d\u7684\u7d20\u6570\u7136\u540e\u66b4\u529b\u5224\u65ad\u3002\n\n\u590d\u6742\u5ea6\uff1f$18$ \u4ee5\u5185\u9664\u53bb $2,3$ \u53ea\u6709 $5$ \u4e2a\u7d20\u6570\uff0c\u5b9e\u9645\u4e0a\u5f53 $q=5$ \u65f6\uff0c\u65f6\u95f4\u7684\u5f71\u54cd\u5c31\u5df2\u7ecf\u8fdc\u4e0d\u5982 $q=2$ \u4e86\u3002\n\n\u590d\u6742\u5ea6\u662f $O(k\\log n\\log\\log n+\\sqrt[4]{n}+\\sqrt[3]{n})$\u3002\n\n\u6700\u540e\u6211\u4eec\u4f1a\u5f97\u5230 $O(k)$ \u4e2a\u6570\uff0c\u8981\u5728\u8fd9\u91cc\u9762\u5bfb\u627e\u7b2c $k$ \u5927\u7684\u6570\u5f88\u5bb9\u6613\u3002\n\n\u770b\u4e0a\u53bb\u5f88\u602a\uff1f\u5b9e\u9645\u4e0a\u5e94\u8be5\u662f\u6bd4\u8f83\u7a33\u7684\u3002\n\n\u5982\u679c\u8fd8\u89c9\u5f97\u4e0d\u7a33\u7684\u8bdd\uff0c\u53ef\u4ee5\u5c06 $q\\geq 5$ \u65f6\u7684\u6570\u6253\u8868\u51fa\u6765\u3002\n\nfun fact\uff1a$q=2$ \u65f6\u9700\u8981\u6700\u591a\u9700\u8981\u505a $[10^9,1002075103]$\uff0c\u800c $1002075101$ \u548c $1002075103$ \u6070\u597d\u662f\u4e00\u5bf9\u5b6a\u751f\u7d20\u6570\u3002\n\n~~\u522b\u95ee\u600e\u4e48\u627e\u51fa\u6765\u7684\uff0c\u5bf9\u7740 LOJ6235 \u4ee3\u7801\u624b\u52a8\u4e8c\u5206\u7684~~\n\n\u6253\u8868\u4ee3\u7801\uff1a\n```cpp\n#include<algorithm>\n#include<cstdio>\ntypedef __int128 LL;\ntypedef long long ll;\nint top,pri[10005],pos[10005];ll len,p[1000005];\ninline LL pow(int a,int b){\n\tLL ans(1);while(b--)ans*=a;return ans;\n}\nsigned main(){\n\tfreopen(\"ans.out\",\"w\",stdout);\n\tpos[1]=114514;\n\tfor(int i=2;i<=10000;++i){\n\t\tif(!pos[i])pri[pos[i]=++top]=i;\n\t\tfor(int x,j=1;j<=pos[i]&&(x=i*pri[j])<=10000;++j)pos[x]=j;\n\t}\n\tfor(int i=1;i<=top;++i)pos[pri[i]]=0;\n\tfor(int i=5;i<64;++i)if(!pos[i]){\n\t\tint lim=1;while(pow(lim,i)<=1002075103ll*1002075103ll)++lim;--lim;\n//\t\tprintf(\"{%d,%d}\\n\",i,lim);\n\t\tfor(int j=1;j<=lim;++j)if(!pos[j])p[++len]=pow(j,i);\n\t}\n\tstd::sort(p+1,p+len+1);\n\tprintf(\"%d\\n\",len);\n\tfor(int i=1;i<=len;++i)printf(\"%lld,\",p[i]);\n}\n```\n\u4ee3\u7801\uff08\u8868\u592a\u957f\u4e86\uff09\uff1a\n```cpp\n#include<cstdio>\ntypedef unsigned ui;\ntypedef unsigned long long ull;\nconst ull p3[669]={};\nconst ui M=2157415+5,N=2100000;//1002075103\nui top,pri[M],pos[M];bool zhi[N+5];\null n;ui k;ull p1[M],p2[M];\ninline void sieve(const ui&M){\n\tpos[1]=114514;\n\tfor(ui i=2;i<=M;++i){\n\t\tif(!pos[i])pri[pos[i]=++top]=i;\n\t\tfor(ui x,j=1;j<=pos[i]&&(x=i*pri[j])<=M;++j)pos[x]=j;\n\t}\n\tfor(int i=1;i<=top;++i)pos[pri[i]]=0;\n}\ninline ui Sieve(const ui&L,const ui&R){\n\tui len(0);if(L==1)zhi[0]=true;\n\tfor(ui i=1;pri[i]*pri[i]<=R;++i){\n\t\tconst ui&s=(L-1)/pri[i]+1,&t=R/pri[i];\n\t\tfor(ui j=s;j<=t;++j)zhi[j*pri[i]-L]=true;\n\t}\n\tfor(ui i=0;i<=R-L+1;++i){\n\t\tif(!zhi[i]||(L+i<=2000000&&!pos[L+i]))p1[++len]=1ll*(L+i)*(L+i);if(len==k)return len;\n\t}\n\treturn len;\n}\ninline ui sqr(ull n){\n\tui L(1),R(1000000000),mid,ans(1);\n\twhile(L<=R)mid=L+R>>1,1ll*mid*mid<=n?ans=mid,L=mid+1:R=mid-1;\n\treturn 1ll*ans*ans==n?ans:ans+1;\n}\nsigned main(){\n\tui l1(0),l2(0),l3(0),t1(1),t2(1),t3(1);scanf(\"%llu%u\",&n,&k);++n;\n\tsieve(2157415);l1=Sieve(sqr(n),sqr(n)+21*(k>=10?k:10));l3=668;\n\tfor(int i=1;i<=top;++i)if(1ull*pri[i]*pri[i]*pri[i]>=n&&l2<k&&1ull*pri[i]*pri[i]*pri[i]<=p1[l1])p2[++l2]=1ull*pri[i]*pri[i]*pri[i];\n\twhile(t3!=l3+1&&p3[t3]<n)++t3;\n\tfor(ui i=1;i<=k;++i){\n\t\tui id(0);ull V(0);\n\t\tif(!id||(t1!=l1+1&&p1[t1]<V))id=1,V=p1[t1];\n\t\tif(!id||(t2!=l2+1&&p2[t2]<V))id=2,V=p2[t2];\n\t\tif(!id||(t3!=l3+1&&p3[t3]<V))id=3,V=p3[t3];\n\t\tif(i==k)return printf(\"%llu\",V),0;if(id==1)++t1;if(id==2)++t2;if(id==3)++t3;\n\t}\n}\n```",
        "postTime": 1648781203,
        "uid": 160839,
        "name": "Prean",
        "ccfLevel": 7,
        "title": "\u6570\u8bba P2291\u9898\u89e3"
    },
    {
        "content": "\u5bb9\u6613\u53d1\u73b0\uff0c$2^{67}=147573952589676412928$ \u8fdc\u8fdc\u5927\u4e8e $10^{18}$ \uff0c\u4e0d\u53ef\u80fd\u662f\u7b54\u6848\u3002\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651 $2$ \u5230 $61$ \u6b21\u65b9\u4ea7\u751f\u7684\u8d21\u732e\u3002\n\n\u53c8\u5bb9\u6613\u53d1\u73b0\uff0c $\\sqrt[3]{10^{18}}=10^6$ \u3002 \u5728 $10^{6}$ \u5230 $2\\times10^{6}$ \u4e2d\u95f4\u5927\u7ea6\u6709\u8d28\u6570 $1.37\\times 10^5$ \u4e2a\uff0c\u56e0\u6b64\u5bf9\u4e8e\u6307\u6570\u5927\u4e8e\u7b49\u4e8e $3$ \u7684\u90e8\u5206\u5e95\u6570\u4e0d\u4f1a\u8d85\u8fc7 $2\\times 10^6$ \u3002 \u8fd9\u90e8\u5206\u5229\u7528\u7ebf\u6027\u7b5b\u5373\u53ef\u5904\u7406\u5b8c\u6bd5\u3002\n\n\u9ebb\u70e6\u7684\u662f\u6307\u6570\u4e3a $2$ \u7684\u90e8\u5206\uff0c \u56e0\u4e3a\u8fd9\u90e8\u5206\u5e95\u6570\u90fd\u662f $10^9$ \u7ea7\u7684\u3002 \u4e0d\u8fc7\uff0c\u901a\u8fc7\u4f30\u7b97\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5728 $10^9$ \u5230 $10^9+10^6$ \u4e4b\u95f4\u4e00\u5171\u6709\u8d28\u6570 $4.7\\times 10^5$ \u4e2a\uff0c\u56e0\u6b64\u6211\u4eec\u7684\u5e95\u6570\u4e0d\u4f1a\u8d85\u8fc7 $10^9+10^6$ \u3002\u8fd9\u6837\u7684\u8bdd\u5e95\u6570\u7684\u8de8\u5ea6\u4e0d\u4f1a\u8d85\u8fc7 $10^6$\uff0c \u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u4e00\u4e2a\u4e2a\u679a\u4e3e\u89c2\u5bdf\u662f\u5426\u662f\u8d28\u6570\u3002\n\n\u81f3\u4e8e\u5feb\u901f\u5224\u65ad\u4e00\u4e2a\u6570\u662f\u4e0d\u662f\u8d28\u6570\uff0c\u90a3\u5f53\u7136\u662f $millerrabin$ \u7b97\u6cd5\u4e86\u3002\u5355\u6b21\u8ba1\u7b97\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\log w)$ \u3002\n\n\u6211\u4eec\u628a\u6bcf\u4e2a\u4e0d\u540c\u6307\u6570\u5f53\u524d\u5927\u4e8e $n$ \u7684\u6700\u5c0f\u6570\u5b57\u653e\u5230\u5806\u91cc\u9762\uff0c\u6bcf\u6b21\u53d6\u51fa\u6700\u5c0f\u7684\u540e\u66f4\u65b0\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(10^6\\log 10^9+k\\log 18)$ \u3002\n\n\u4ee3\u7801:\n```cpp\n#include<bits/stdc++.h>\n#include<cctype>\n#define For(i,a,b) for(i=(a),i##end=(b);i<=i##end;++i)\n#define Forward(i,a,b) for(i=(a),i##end=(b);i>=i##end;--i)\n#define Rep(i,a,b) for(register uint32 i=(a),i##end=(b);i<=i##end;++i)\n#define Repe(i,a,b) for(register uint32 i=(a),i##end=(b);i>=i##end;--i)\n#define Chkmax(a,b) a=a>b?a:b\nusing namespace std;\ntemplate<typename T>inline void read(T &x){\n    T s=0,f=1;char k=getchar();\n    while(!isdigit(k)&&k^'-')k=getchar();\n    if(!isdigit(k)){f=-1;k=getchar();}\n    while(isdigit(k)){s=s*10+(k^48);k=getchar();}\n    x=s*f;\n}\nvoid file(void){\n    #ifndef ONLINE_JUDGE\n    freopen(\"a.in\",\"r\",stdin);\n    freopen(\"a.out\",\"w\",stdout);\n    #endif\n}\nusing uint64=unsigned long long;\nusing uint128=__uint128_t;\nusing uint32=unsigned int;\n\nconst uint32 bace[5]={2,3,7,61,24251};\n\ninline uint32 pow(uint32 x,uint32 y,uint32 mod)\n{\n    static uint32 sm;\n    for(sm=1;y;y>>=1,x=(uint64)x*x%mod)if(y&1)sm=(uint64)sm*x%mod;\n    return sm;\n}\ninline bool millerrabin(uint32 x)\n{\n    if(x<2)return false;\n    if(x==2||x==3||x==7||x==61||x==24251)return true;\n    static uint32 ba,r;ba=x-1;\n    static uint32 ti,j;ti=0;\n    while(!(ba&1))ba>>=1,++ti;\n    Rep(i,0,4)\n    {\n        r=pow(bace[i],ba,x);\n        if(r==1||r==x-1)continue;\n        for(j=1;j<=ti;++j)\n        {\n            r=(uint64)r*r%x;\n            if(r==x-1)break;\n        }\n        if(j>ti)return false;\n    }\n    return true;\n}\n\nstatic uint64 n;\n\nstatic uint32 k;\n\nstatic struct nd\n{\n\tuint32 nm, pw;\n\tuint64 w;\n\tfriend bool operator < (nd a, nd b) {return a.w > b.w;}\n}z;\n\npriority_queue <nd> Q;\n\nconst int MAXN = 2e5 + 7;\n\nstatic uint32 pri[MAXN], e;\n\nbitset <2000001> is;\n\ninline void getpri()\n{\n\tconst int lm = 2e6;\n\tRep(i, 2, lm)\n\t{\n\t\tif(!is.test(i)) pri[++ e] = i;\n\t\tfor(register int j = 1; j <= e && i <= lm / pri[j]; ++ j)\n\t\t{\n\t\t\tis.set(i * pri[j]);\n\t\t\tif(i % pri[j] == 0) break;\n\t\t}\n\t}\n}\n\ninline uint64 power(uint32 u, uint32 v)\n{\n\tuint64 d = 1;\n\twhile(v --)\n\t{\n\t\tif(d > LLONG_MAX / u) return LLONG_MAX;\n\t\td *= u;\n\t}\n\treturn d;\n}\n\nint main()\n{\n    file();\n\tread(n);\n\tgetpri();\n\tRep(i, 2, 18)\n\t{\n\t\tz = (nd){1, pri[i], 1llu << pri[i]};\n\t\twhile(z.w <= n)\n\t\t{\n\t\t\t++ z.nm;\n\t\t\tz.w = power(pri[z.nm], z.pw);\n\t\t}\n\t\tQ.push(z);\n\t}\n\tuint32 r = sqrt(n);\n\twhile((uint64) r * r <= n) ++ r;\n\tif(r % 2 == 0) ++ r;\n\twhile(! millerrabin(r)) r += 2;\n\tQ.push((nd){r, 2, (uint64) r * r});\n\tread(k);\n\twhile(-- k)\n\t{\n\t\tz = Q.top(), Q.pop();\n\t\tif(z.pw == 2)\n\t\t{\n\t\t\tz.nm += 2;\n\t\t\twhile(! millerrabin(z.nm)) z.nm += 2;\n\t\t\tQ.push((nd){z.nm, 2, (uint64) z.nm * z.nm});\n\t\t}\n\t\telse Q.push((nd){z.nm + 1, z.pw, power(pri[z.nm + 1], z.pw)});\n\t}\n\tprintf(\"%llu\\n\", Q.top().w);\n\tcerr<<1.0*clock()/CLOCKS_PER_SEC<<endl;\n    return 0;\n}\n```",
        "postTime": 1580796158,
        "uid": 7035,
        "name": "Great_Influence",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6064 \u3010[PA2011]Prime prime power \u8d28\u6570\u7684\u8d28\u6570\u6b21\u65b9\u3011"
    }
]
[
    {
        "content": "\u8003\u8651\u5728\u7b2c $i$ \u6b65\u9009\u62e9\u7684\u65f6\u5019\u4f1a\u5bf9\u540e\u7f00\u90fd\u4ea7\u751f\u5f71\u54cd\uff0c\u6240\u4ee5\u4e0d\u59a8\u5c06 $w_i$ \u6c42\u540e\u7f00\u548c\u3002\n\n\u4ee4 $S_i = \\sum_{j=i}^{n} w_i$\uff0c\u90a3\u4e48\u5982\u679c\u7b2c $i$ \u6b21 $x$ \u6539\u53d8\u4e86 $l_i$\uff0c\u7b54\u6848\u5c31\u662f $\\sum_{i=1}^{n}S_i \\times l_i$\n\n\u8003\u8651\u6ca1\u6709 $a_i$ \u7684\u9650\u5236\u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u6839\u636e $S_i$ \u662f\u5426\u5927\u4e8e $0$ \u9009\u62e9 $+k$ \u6216\u8005 $-k$\n\n\u5982\u679c\u6709\u4e86 $a_i$ \u7684\u9650\u5236\uff0c\u90a3\u4e48\u5c31\u76f8\u5f53\u4e8e\u9650\u5236\u4e86\u4e00\u4e2a $l_i$ \u7684\u524d\u7f00\u548c\u3002\n\n\u8003\u8651\u5230\u9650\u5236\u90fd\u662f $\\leq a_i$ \u7684\u5f62\u5f0f\uff0c\u6240\u4ee5\u53ef\u4ee5\u8003\u8651\u6bcf\u6b21\u524a\u51cf\u524d\u9762\u9009\u62e9 $+k$ \u7684\u5730\u65b9\u3002\n\n\u663e\u7136\u6bcf\u6b21\u9009\u62e9\u6700\u5c0f\u7684 $S_i$ \u7684\u4f4d\u7f6e\u524a\u51cf\u662f\u6700\u4f18\u7684\u3002\n\n\u90a3\u4e48\u62ff\u4e00\u4e2a\u5806\u7ef4\u62a4 $S_i$ \u4ee5\u53ca\u53ef\u4ee5\u524a\u51cf\u7684\u6b21\u6570 $l_i$ \u5c31\u597d\u4e86\u3002\n\n$Code$ :\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst int __SIZE = 1 << 18;\nchar ibuf[__SIZE], *iS, *iT;\n\n#define ge (iS == iT ? (iT = (iS = ibuf) + fread(ibuf, 1, __SIZE, stdin), (iS == iT ? EOF : *iS++)) : *iS++)\n#define ri read_int()\n#define rl read_ll()\n#define FILE(s) freopen(s\".in\", \"r\", stdin), freopen(s\".out\", \"w\", stdout)\n\ntemplate<typename T>\ninline void read(T &x) {\n\tchar ch, t = 0; x = 0;\n\twhile(!isdigit(ch = ge)) t |= ch == '-';\n\twhile(isdigit(ch)) x = x * 10 + (ch ^ 48), ch = ge;\n\tx = t ? -x : x;\n}\ninline int read_int() { int x; return read(x), x; }\ninline ll read_ll() { ll x; return read(x), x; }\n\nconst int MAXN = 1000010;\n\nll w[MAXN];\nint a[MAXN];\n\nstruct Node {\n\tll w;\n\tint k;\n\n\tNode() {}\n\tNode(ll w, int k):w(w), k(k) {}\n\n\tfriend bool operator < (Node a, Node b) { return a.w < b.w; }\n\tfriend bool operator > (Node a, Node b) { return a.w > b.w; }\n};\n\npriority_queue<Node, vector<Node>, greater<Node> >q;\n\nint main() {\n#ifndef ONLINE_JUDGE\n\tFILE(\"d\");\n#endif\n\tint n = ri, k = ri;\n\tfor(int i = 1; i <= n; i++) a[i] = ri;\n\tfor(int i = 1; i <= n; i++) w[i] = ri;\n\tfor(int i = n; i >= 1; i--) w[i] += w[i + 1];\n\tint x = 0; ll res = 0;\n\tfor(int i = 1; i <= n; i++) {\n\t\tif(w[i] > 0) res += k * w[i], q.push(Node(w[i], k << 1)), x += k;\n\t\telse res -= k * w[i], x -= k;\n\t\tint c = x - a[i]; x = min(x, a[i]);\n\t\twhile(c > 0 && !q.empty()) {\n\t\t\tNode x = q.top(); q.pop();\n\t\t\tint t = min(c, x.k);\n\t\t\tres -= t * x.w;\n\t\t\tc -= t, x.k -= t;\n\t\t\tif(x.k) q.push(x);\n\t\t}\n\t} cout << res << endl;\n\treturn 0;\n}\n```",
        "postTime": 1573646166,
        "uid": 20782,
        "name": "CYJian",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5653 \u3010\u57fa\u7840\u6700\u4f18\u5316\u7ec3\u4e60\u9898\u3011"
    },
    {
        "content": "\u9996\u5148\u4e0d\u8003\u8651 $a$ \u7684\u9650\u5236\uff0c\u90a3\u4e48\u4e00\u4e2a\u4f4d\u7f6e\u662f\u52a0\u662f\u51cf\u53d6\u51b3\u4e8e\u8fd9\u4e2a\u4f4d\u7f6e\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u662f\u6b63\u662f\u8d1f\uff0c\u800c\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u663e\u7136\u4e3a $w$ \u7684\u540e\u7f00\u548c\u3002\n\n\u518d\u8003\u8651 $a$ \u7684\u9650\u5236\uff0c\u5982\u679c\u4e00\u4e2a\u4f4d\u7f6e\u8d85\u51fa\u4e86\u9650\u5236\uff0c\u5219\u5e94\u8be5\u4e0d\u65ad\u5730\u4ece\u4e4b\u524d\u8d21\u732e\u6700\u5c0f\u7684\u4f4d\u7f6e\u51cf\u6389\u8d21\u732e\uff0c\u76f4\u5230\u4e0d\u8d85\u51fa\uff0c\u7528\u4e00\u4e2a\u5806\u7ef4\u62a4\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n \\log n)$\u3002\n\n```cpp\nconst int N = 1e6 + 7;\nint n, k, a[N], now;\nll b[N], ans;\npq< pi > q;\n\nint main() {\n\trd(n), rd(k);\n\tfor (int i = 1; i <= n; i++) rd(a[i]);\n\tfor (int i = 1; i <= n; i++) rd(b[i]);\n\tfor (int i = n; i; i--) b[i] += b[i+1];\n\tfor (int i = 1; i <= n; i++) {\n\t\tif (b[i] >= 0) now += k, ans += k * b[i], q.push(mp(-b[i], k << 1));\n\t\telse now -= k, ans -= k * b[i];\n\t\twhile (now > a[i]) {\n\t\t\tpi o = q.top();\n\t\t\tq.pop();\n\t\t\tint w = Min(o.se, now - a[i]);\n\t\t\tnow -= w, ans += w * o.fi;\n\t\t\tif ((o.se -= w)) q.push(o);\n\t\t}\n\t}\n\tprint(ans);\n\treturn 0;\n}\n```",
        "postTime": 1575126599,
        "uid": 100544,
        "name": "xht",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5653 \u3010\u57fa\u7840\u6700\u4f18\u5316\u7ec3\u4e60\u9898\u3011"
    },
    {
        "content": "\u6bcf\u6b21\u53ef\u4ee5\u52a0\u4e0a\u4e00\u4e2a\u8d1f\u6570\u770b\u4e0a\u53bb\u4e0d\u662f\u5f88\u597d\u505a\uff0c\u6211\u4eec\u8f6c\u5316\u4e00\u4e0b\u4f7f\u5f97\u6bcf\u6b21\u52a0\u7684\u6570\u4e3a\u975e\u8d1f\u6570\uff0c\u8fd9\u4e2a\u53ea\u8981\u628a\u6bcf\u6b21\u64cd\u4f5c\u6539\u6210\u5148\u52a0\u4e0a$-k$\uff0c\u518d\u52a0\u4e00\u4e2a\u4e00\u4e2a$[0,2k]$\u7684\u6570\u5c31\u884c\uff0c\u6bcf\u4e2a$a_i$\u4e5f\u5e94\u8be5\u52a0\u4e0a$i*k$\uff0c\u63a5\u4e0b\u6765\u8bf4\u7684\u90fd\u662f\u5df2\u7ecf\u8f6c\u5316\u540e\u7684\u95ee\u9898\u3002\n\n\u7136\u540e\u53ef\u4ee5\u518d\u7528\u5355\u8c03\u6808\u5904\u7406\u51fa\u6bcf\u4e2a\u70b9\u7684\u771f\u5b9e\u7684$a_i$\uff0c\u56e0\u4e3a\u73b0\u5728\u53ea\u80fd\u52a0\u4e00\u4e2a\u975e\u8d1f\u6570\uff0c\u6240\u4ee5\u5982\u679c$i$\u540e\u9762\u6709\u4e00\u4e2a$a_j$\u5c0f\u4e8e$a_i$\uff0c\u663e\u7136$b_i$\u5e94\u8be5\u4e5f\u8981\u6ee1\u8db3\u5c0f\u4e8e\u7b49\u4e8e$a_j$\u3002\n\n\u7136\u540e\u6211\u4eec\u518d\u6765\u770b\u7b54\u6848\u7684\u67ff\u5b50\uff1a\n$$\n\\sum_{i=1}^{n}b_iw_i\n$$\n\u5dee\u5206\u4e00\u4e0b:\n$$\n\\sum_{i=1}^{n}b_iw_i\n=\\sum_{i=1}^{n}(\\sum_{j=1}^{i}b_j-b_{j-1})w_i\n=\\sum_{i=1}^{n}(b_i-b_{i-1})\\sum_{j=i}^{n}w_j\n$$\n\u8bbe$c_i=b_i-b_{i-1} ,suf_i=\\sum_{j=i}^{n}w_j$\n$$\n\\sum_{i=1}^{n}b_i\\sum_{j=i}^{n}w_j\n=\\sum_{i=1}^{n}c_isuf_i\n$$\n\u5f53\u7136\u5bf9\u4e8e\u6bcf\u4e2a$i\\in[1,n]$\u90fd\u8fd8\u5e94\u8be5\u6ee1\u8db3$\\sum_{j=1}^{i}c_j<=a_i,c_i\\in[0,2k]$\n\n\u63a5\u4e0b\u6765\u8003\u8651\u8d2a\u5fc3\u4e00\u6ce2\uff0c$suf_i$\u5927\u7684\u5bf9\u5e94\u7684$c_i$\u80af\u5b9a\u4e5f\u8981\u5c3d\u53ef\u80fd\u5927\u561b\uff0c$suf_i$\u662f\u8d1f\u6570\u7684\u8bdd\u5bf9\u5e94\u7684$c_i$\u5c31\u5e94\u8be5\u4e3a$0$\uff0c\u4e8e\u662f\u6211\u4eec\u6309$suf_i$\u4ece\u5927\u5230\u5c0f$sort$\uff0c\u6bcf\u6b21\u7b97\u51fa$c_i$\u80fd\u53d6\u5230\u7684\u6700\u5927\u503c\uff0c\u5177\u4f53\u53ef\u4ee5\u901a\u8fc7\u7ebf\u6bb5\u6811\u7ef4\u62a4\u540e\u7f00$min$\u5b9e\u73b0\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$O(nlogn)$\uff0c\u7136\u540e\u8fd9\u4e2a\u9898\u5c31\u505a\u5b8c\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define For(i,x,y) for (register int i=(x);i<=(y);i++)\n#define FOR(i,x,y) for (register int i=(x);i<(y);i++)\n#define Dow(i,x,y) for (register int i=(x);i>=(y);i--)\n#define mp make_pair\n#define fi first\n#define se second\n#define pb push_back\n#define siz(x) ((int)(x).size())\n#define all(x) (x).begin(),(x).end()\n#define fil(a,b) memset((a),(b),sizeof(a))\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> pa;\ninline ll read(){\n    ll x=0,f=1;char c=getchar();\n    while ((c<'0'||c>'9')&&(c!='-')) c=getchar();\n    if (c=='-') f=-1,c=getchar();\n    while (c>='0'&&c<='9') x=x*10+c-'0',c=getchar();\n    return x*f;\n}\n\nconst int N = 1e6+10;\nint n,m,top,stk[N],pos[N];\nll ans,suf[N],a[N],w[N],lim[N];\n\nstruct SegmentTree{\n\tll t[N<<2],lazy[N<<2];\n\tinline void push_up(int u){t[u]=min(t[u<<1],t[u<<1^1]);}\n\tinline void upd(int u,double x){t[u]+=x,lazy[u]+=x;}\n\tinline void push_down(int u){if (lazy[u]!=0) upd(u<<1,lazy[u]),upd(u<<1^1,lazy[u]),lazy[u]=0;}\n\tinline void Build(int u,int l,int r){\n\t\tif (l==r) return t[u]=lim[l],void(0);\n\t\tint mid=l+r>>1;Build(u<<1,l,mid),Build(u<<1^1,mid+1,r);\n\t\tpush_up(u);\n\t}\n\tinline void update(int u,int l,int r,int ql,int qr,int x){\n\t\tif (l>=ql&&r<=qr) return upd(u,x),void(0);\n\t\tint mid=l+r>>1;push_down(u);\n\t\tif (ql<=mid) update(u<<1,l,mid,ql,qr,x);\n\t\tif (qr>mid) update(u<<1^1,mid+1,r,ql,qr,x);\n\t\tpush_up(u);\n\t}\n\tinline ll Query(int u,int l,int r,int ql,int qr){\n\t\tif (l>=ql&&r<=qr) return t[u];\n\t\tint mid=l+r>>1;push_down(u);\n\t\tif (qr<=mid) return Query(u<<1,l,mid,ql,qr);\n\t\tif (ql>mid) return Query(u<<1^1,mid+1,r,ql,qr);\n\t\treturn min(Query(u<<1,l,mid,ql,qr),Query(u<<1^1,mid+1,r,ql,qr));\n\t}\n}seg;\n\nint main(){\n\tn=read(),m=read();\n\tFor(i,1,n) a[i]=read()+1ll*i*m;\n\tFor(i,1,n) w[i]=read(),ans+=(-1ll*i*m)*w[i];\n\tFor(i,1,n){\n\t\twhile (top&&a[stk[top]]>=a[i]) --top;\n\t\tstk[++top]=i;\n\t}\n\tFor(i,1,top)\n\t\tFor(j,stk[i-1]+1,stk[i]) lim[j]=a[stk[i]];\n\tDow(i,n,1) suf[i]=suf[i+1]+w[i],pos[i]=i;\n\tsort(pos+1,pos+1+n,[](int a,int b){\n\t\treturn suf[a]>suf[b];\n\t});\n\tseg.Build(1,1,n);\n\tFor(i,1,n){\n\t\tif (suf[pos[i]]<=0) break;\n\t\tint x=min(seg.Query(1,1,n,pos[i],n),2ll*m);\n\t\tans+=suf[pos[i]]*x,seg.update(1,1,n,pos[i],n,-x);\n\t}\n\tprintf(\"%lld\\n\",ans);\n}\n```",
        "postTime": 1573647015,
        "uid": 43123,
        "name": "\u52a0\u85e4\u60e0",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5653 \u3010\u57fa\u7840\u6700\u4f18\u5316\u7ec3\u4e60\u9898\u3011"
    },
    {
        "content": "\u672c\u9898\u5927\u610f\uff1a\u6784\u9020\u4e00\u4e2a\u6570\u7ec4$bi$\uff0c\u5176\u4e24\u4e24\u5dee\u503c\u4e0d\u8d85\u8fc7$k$\uff0c\u5e76\u6ee1\u8db3\u4efb\u610f$bi<ai$\n\n\u7531\u6b64\uff0c\u6211\u4eec\u8bbe\u7b2ci\u5206\u949f\u6211\u4eec\u52a0\u4e0a\u7684\u503c\u4e3a$ci\u2208[-k,k]$\n\n\u90a3\u4e48\u7b54\u6848$Ans=\u2211ci\u2211wj |i\u2208[1,n],j\u2208[i,n]$\n\n\u8bb0\u5f53\u524di~n $wj$\u7684\u548c\u4e3a$Si$\n\n\u5f53$Si$\u5c0f\u4e8e0\u7684\u65f6\u5019\uff0c\u7531\u4e8e\u4ed6\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e3a\u8d1f\uff0c\u6211\u4eec\u76f4\u63a5\u628a\u8fd9\u91cc\u7684$ci$\u7f6e\u4e3a$-k$\uff0c\u8fd9\u6837\u663e\u7136\u662f\u6700\u4f18\u7684\uff0c\u4e14\u4e0d\u4f1a\u8ba9\u5f53\u524d$bi$\u589e\u52a0\n\n\u5f53$Si$\u5927\u4e8e0\u7684\u65f6\u5019\uff0c\u7531\u4e8e\u4ed6\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e3a\u6b63\uff0c\u6211\u4eec\u5148\u628a\u8fd9\u91cc\u7684$ci$\u7f6e\u4e3a$k$\n\n\u7ecf\u8fc7\u4e0a\u9762\u4e24\u7c7b\u64cd\u4f5c\u540e\uff0c\u6b64\u65f6\u7684$b=\u2211ci$\uff0c\u6709\u53ef\u80fd\u5c0f\u4e8e\u9898\u76ee\u6240\u7ed9\u5b9a\u7684$a$,\u663e\u7136\u524d\u9762\u67d0\u6b65\u7684$ci$\u591a\u4e86\uff0c\u9700\u8981\u6263\u6389\uff0c\u6263\u90a3\u4e9b$ci$\u5462\uff1f\u663e\u7136\u662f\u6263$Si$\u5c0f\u7684$ci$(\u6ce8\u610f\u6b64\u65f6\u6263\u7684$Si$\u4e3a\u6b63\uff0c\u56e0\u4e3a\u8d1f\u7684\u6211\u4eec\u5df2\u7ecf\u4e0d\u80fd\u518d\u6263\u4e86)\uff0c\u90a3\u4e48\u7ef4\u62a4\u4e00\u4e2a\u5c0f\u6839\u5806\uff0c\u6bcf\u6b21\u9700\u8981\u6263\u7684\u65f6\u5019\u53bb\u6263\n\n\u8fd8\u6709\u4e2a\u5c0f\u7ec6\u8282\uff0c\u6bcf\u4e2a$ci$\u6700\u5c0f\u503c\u4e3a$-k$\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u6700\u591a\u628a\u4e00\u4e2a$ci=k$\u6263\u6389$2k$\uff0c\u4e5f\u5c31\u662f\u4e3a\u4ec0\u4e48\u6211put((Node){S[i],k+k})\n\n\u81f3\u4e8e\u590d\u6742\u5ea6\uff0c\u6bcf\u4e00\u6b21\u653e\u5165\u4e00\u4e2a\u70b9\uff0cget\u64cd\u4f5c\u6700\u591a\u505a2N\u6b21\uff0c\u4e3a$nlogn$\n\n\u9644\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=1e6+5;\ntypedef long long LL;\nstruct IO{\n\tstatic const int S=1<<21;\n\tchar buf[S],*p1,*p2;int st[105],Top;\n\t~IO(){clear();}\n\tinline void clear(){fwrite(buf,1,Top,stdout);Top=0;}\n\tinline void pc(const char c){Top==S&&(clear(),0);buf[Top++]=c;}\n\tinline char gc(){return p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++;}\n\tIO&operator >> (char&x){while(x=gc(),x==' '||x=='\\n');return *this;}\n\ttemplate<typename T> IO&operator >> (T&x){\n\t\tx=0;bool f=0;char ch=gc();\n\t\twhile(ch<'0'||ch>'9'){if(ch=='-') f^=1;ch=gc();}\n\t\twhile(ch>='0'&&ch<='9') x=(x<<3)+(x<<1)+ch-'0',ch=gc();\n\t\tf?x=-x:0;return *this;\n\t}\n\tIO&operator << (const char c){pc(c);return *this;}\n\ttemplate<typename T> IO&operator << (T x){\n\t\tif(x<0) pc('-'),x=-x;\n\t\tdo{st[++st[0]]=x%10,x/=10;}while(x);\n\t\twhile(st[0]) pc('0'+st[st[0]--]);return *this;\n\t}\n}fin,fout;\nint n,k,now,a[maxn],w[maxn],len;\nLL S[maxn],Ans;\nstruct Node{\n\tLL x,y;\n\tbool operator <(const Node b)const{return x<b.x;}\n}hep[maxn];\ninline void put(Node x){\n\thep[++len]=x;int son=len;\n\twhile(son>1&&hep[son]<hep[son>>1]) swap(hep[son],hep[son>>1]),son>>=1;\n}\ninline Node get(){\n\tNode res=hep[1];hep[1]=hep[len--];int fa=1,son;\n\twhile((fa<<1)<=len){\n\t\tif((fa<<1|1)>len||hep[fa<<1]<hep[fa<<1|1]) son=fa<<1;else son=fa<<1|1;\n\t\tif(hep[son]<hep[fa]) swap(hep[fa],hep[son]),fa=son;else break;\n\t}\n\treturn res;\n}\nint main(){\n\tfin>>n>>k;\n\tfor(int i=1;i<=n;i++) fin>>a[i];\n\tfor(int i=1;i<=n;i++) fin>>w[i];\n\tfor(int i=n;i;i--) S[i]=S[i+1]+w[i];\n\tfor(int i=1;i<=n;i++){\n\t\tif(S[i]>0) now+=k,Ans+=k*S[i],put((Node){S[i],k+k});\n\t\telse now-=k,Ans-=k*S[i];\n\t\twhile(now>a[i]){\n\t\t\tNode x=get();\n\t\t\tif(x.y>(now-a[i])) x.y-=(now-a[i]),Ans-=x.x*(now-a[i]),now=a[i],put(x);\n\t\t\telse now-=x.y,Ans-=x.x*x.y;\n\t\t}\n\t}\n\tfout<<Ans;\n\treturn 0;\n}\n```\n",
        "postTime": 1573652851,
        "uid": 125322,
        "name": "bessie_goes_moo",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5653 \u3010\u57fa\u7840\u6700\u4f18\u5316\u7ec3\u4e60\u9898\u3011"
    },
    {
        "content": "\u4e5f\u7b97\u662f\u4e00\u4e2a\u5957\u8def\u4e86\u3002\n\n\u6211\u4eec\u5bf9\u4e8e\u9650\u5236\u7c7b\u95ee\u9898\uff0c\u8003\u8651\u53bb\u9664\u9650\u5236\u4e4b\u540e\u662f\u4e0d\u662f\u5177\u6709\u663e\u7136\u7684\u6700\u4f18\u89e3\u3002\u7136\u540e\u8003\u8651\u8c03\u6574\u8fd9\u4e2a\u89e3\u53bb\u6ee1\u8db3\u9650\u5236\u3002\n\n\u800c\u5173\u4e8e\u8c03\u6574\uff0c\u8003\u8651\u82e5\u6bcf\u6b21\u8c03\u6574\u90fd\u5177\u6709\u5fc5\u8981\u6027\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u6b63\u786e\u3002\u8fdb\u800c\u6bcf\u6b21\u8c03\u6574\u518d\u8fdb\u884c\u8d2a\u5fc3\uff0c\u5c31\u5f97\u5230\u6700\u4f18\u89e3\u3002\n\n\u5177\u4f53\u5230\u672c\u9898\uff0c\u663e\u7136 $b_i=\\sum^i_{j=1} a_j$\uff0c\u628a $a_i$ \u4ece\u524d\u7f00\u548c\u4e2d\u62c6\u51fa\u5bb9\u6613\u5f97\u5230\u65e0\u9650\u5236\u60c5\u5f62\u4e0b $a_i$ \u6839\u636e\u5176\u540e\u7f00\u548c\uff0c\u4ec5\u6709 $k,-k$ \u4e24\u79cd\u53d6\u503c\u3002\n\n\u7136\u540e\u8003\u8651\u8fd9\u4e9b\u9650\u5236\uff0c\u56e0\u4e3a\u662f\u524d\u7f00\u548c\u7684\u4e0a\u754c\u9650\u5236\uff0c\u6240\u4ee5\u4ece\u524d\u5f80\u540e\u6ee1\u8db3\u5c31\u5177\u6709\u5fc5\u8981\u6027\u3002\u5bf9\u4e8e\u6ee1\u8db3\u9650\u5236\uff0c\u53ef\u4ee5\u53d1\u73b0\u5c31\u662f\u8981\u4f7f\u5f97\u4e4b\u524d\u7684\u6570\u589e\u52a0\u4e0a\u4e00\u4e2a\u6574\u6570\uff0c\u8fd9\u4e00\u589e\u52a0\u65e0\u8bba\u5982\u4f55\u90fd\u5177\u6709\u8d1f\u7684\u8d21\u732e\uff1b\u5728\u4e00\u4e2a\u4f4d\u7f6e\u52a0\u4e0a $-1$ \u7684\u8d21\u732e\u90fd\u53ea\u662f\u4e58\u4e0a\u5176\u540e\u7f00\u548c\u3002\n\n\u6545\u7ef4\u62a4\u6700\u5c0f\u540e\u7f00\u548c\u7684\u4f4d\u7f6e\uff0c\u4f7f\u5176 $a$ \u51cf\u5c0f\u3002\u82e5\u51cf\u5c0f\u5230\u4e0b\u754c\uff0c\u5c31\u9700\u8981\u652f\u6301 `extract`\uff0c\u53ef\u7528\u5806\u7ef4\u62a4\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int maxn = 1000005;\nint n, a[maxn], v[maxn];\nlong long k, sum, w[maxn], ans;\npriority_queue<pair<long long, int> > q;\nsigned main() {\n\tscanf(\"%d%lld\", &n, &k);\n\tfor (int i = 1; i <= n; ++i) scanf(\"%d\", a + i);\n\tfor (int i = 1; i <= n; ++i) scanf(\"%lld\", w + i);\n\tfor (int i = n; i >= 1; --i) w[i] += w[i + 1], v[i] = (w[i] >= 0 ? k : -k), ans += v[i] * 1ll * w[i];\n\tfor (int i = 1; i <= n; ++i) {\n\t\tlong long val = sum + v[i];\n\t\tif (w[i] > 0) q.emplace(-w[i], i);\n\t\twhile (val > a[i] && !q.empty()) {\n\t\t\tint j = q.top().second;\n\t\t\tlong long t = v[j] - (-k);\n\t\t\tq.pop();\n\t\t\tlong long tmp = min(t, val - a[i]);\n\t\t\tval -= tmp, v[j] -= tmp, ans -= tmp * w[j];\n\t\t\tif (v[j] > -k) q.emplace(-w[j], j);\n\t\t}\n\t\tsum = min(val, a[i] * 1ll);\n\t}\n\tprintf(\"%lld\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1682603121,
        "uid": 62440,
        "name": "MuelsyseU",
        "ccfLevel": 0,
        "title": "P5653 \u57fa\u7840\u6700\u4f18\u5316\u7ec3\u4e60\u9898 \u9898\u89e3"
    }
]
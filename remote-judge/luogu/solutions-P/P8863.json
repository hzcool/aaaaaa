[
    {
        "content": "## \u6d4b\u8bd5\u70b9 1~3\n\n\u8f93\u51fa~~\u4e0d\u53ef\u4ee5\uff0c\u603b\u53f8\u4ee4~~ $0$ \u5373\u53ef\u3002\n\n## \u6d4b\u8bd5\u70b9 4~5\n\n\u8f93\u51fa $[b_1=b_2]$\u3002\u5176\u5b9e\u8f93\u51fa $1$ \u5373\u53ef\uff0c\u6211\u6ca1\u7ed9 $0$ \u7684\u70b9\u3002\n\n## \u6d4b\u8bd5\u70b9 6~8\n\n\u66b4\u529b\uff0c\u548b\u66b4\u529b\u90fd\u884c\uff0c\u6570\u636e\u592a\u5c0f\u4e86\u3002\n\n## \u6d4b\u8bd5\u70b9 9~11\n\n\u8fd9\u4e2a\u53ef\u4ee5\u7528\u72b6\u538b $dp$\uff0c\u6bd5\u7adf $b_i=1$\u3002\n\n## \u6d4b\u8bd5\u70b9 12~14\n\n\u7a0d\u5fae\u8f6c\u5316\u4e00\u4e0b\uff0c\u8f6c\u5316\u4e3a\uff1a\n\n\u6709 $n$ \u4e2a\u4eba\u8981\u5b8c\u6210 $\\frac{n}{2}$ \u4efd\u5927\u4f5c\u4e1a\uff0c\u4e24\u4e2a\u4eba\u4e00\u7ec4\u5b8c\u6210\u5927\u4f5c\u4e1a\uff0c\u9700\u8981\u6309\u987a\u5e8f\u63d0\u4ea4\u4f5c\u4e1a\uff0c\u6c42\u65b9\u6848\u6570\u3002\n\n\u8003\u8651\u5bf9\u4e8e\u6bcf\u4e2a\u4eba\u9009\u642d\u6863\uff0c\u7b2c $1$ \u4e2a\u4eba\u6709 $n-1$ \u79cd\u9009\u62e9\uff0c\u7b2c $2$ \u4e2a\u4eba $n-3$ \u79cd\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff0c\u6700\u540e\u4e58 $\\frac{n}{2}!$ \u5373\u53ef\u3002\n\n## \u6d4b\u8bd5\u70b9 15~18\n\n\u72b6\u538b dp\uff0c\u8003\u8651\u6bcf\u6b21\u64cd\u4f5c\u5df2\u7ecf\u9009\u4e2a $0/1/2$ \u4e2a\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\u7684\u65b9\u6848\u6570\uff0c\u53ef\u4ee5\u538b\u4f4d\u5b58\u4e0b\u6765\uff0c\u8f6c\u79fb\u53ea\u9700\u8981\u679a\u4e3e\u6570\u7ec4\u8fd9\u4e2a\u4f4d\u7f6e\u8981\u5728\u54ea\u4e9b\u64cd\u4f5c\u4e2d\u88ab\u64cd\u4f5c\u5373\u53ef\u3002\u590d\u6742\u5ea6\u8fd8\u662f\u8981\u770b\u5b9e\u73b0\uff0c\u6700\u5feb\u53ef\u4ee5\u8fbe\u5230 $O(3^{\\frac{\\sum b_i}{2}}\\times n)$\uff0c\u6162\u4e00\u70b9\u7684\u4e5f\u80fd\u8fc7\u3002\n\n## \u6d4b\u8bd5\u70b9 19~25\n\n\u53d1\u73b0\u4e0d\u540c\u64cd\u4f5c\u4f4d\u7f6e\u672c\u8d28\u76f8\u540c\uff0c\u9996\u5148\u8003\u8651 $dp_{i,j,k}$ \u8868\u793a\u770b\u5230\u7b2c $i$ \u4e2a\u6570\u7ec4\u4f4d\u7f6e\uff0c\u6709 $j$ \u4e2a\u64cd\u4f5c\u4f4d\u7f6e\u76ee\u524d\u4e3a $1$\uff0c$k$ \u4e2a\u4e3a $2$\u3002\u8f6c\u79fb\u9700\u8981\u679a\u4e3e\u5f80\u76ee\u524d $0/1$ \u4e2a\u7684\u4f4d\u7f6e\u5206\u522b\u8f6c\u79fb\u591a\u5c11\u4e2a\uff0c\u590d\u6742\u5ea6 $O((\\sum b_i)^2(n+\\sum b_i))$\uff0c\u53ef\u4ee5\u901a\u8fc7 $19\\sim 20$ \u70b9\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u53ea\u9700\u8981\u8bb0\u5f55 $2$ \u64cd\u4f5c\u4e2a\u6570\uff0c$0/1$ \u64cd\u4f5c\u4e2a\u6570\u90fd\u53ef\u4ee5\u901a\u8fc7\u67d0\u4e9b\u65b9\u5f0f\u8ba1\u7b97\uff0c\u65f6\u95f4\u4e0e\u7a7a\u95f4\u590d\u6742\u5ea6\u53d8\u4e3a $O((\\sum b_i)(n+\\sum b_i))$\uff0c\u53ef\u4ee5\u901a\u8fc7 $21\\sim 22$ \u70b9\u3002\n\n\u7136\u540e\u5206\u6790\u4e00\u4e0b\uff0c\u5b9e\u9645\u4e0a\u64cd\u4f5c\u4f4d\u7f6e\u53ea\u6709 $\\frac{\\sum b_i}{2}$ \u4e2a\uff0c\u540c\u65f6\u7a7a\u95f4\u53ef\u4ee5\u6eda\u52a8\u6570\u7ec4\u4f18\u5316\uff0c\u6700\u7ec8\u590d\u6742\u5ea6\u4e3a $O((\\sum b_i)^2)$\uff0c$\\frac{1}{4}$ \u500d\u5e38\u6570\uff0c\u5b9e\u9645\u5faa\u73af\u6b21\u6570\u7ea6\u4e3a $2.25\\times 10^8$\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int mod=998244353;\nint qp(int a,int b){\n\tint ans=1;\n\twhile(b){\n\t\tif(b&1) ans=((long long)ans*a)%mod;\n\t\ta=((long long)a*a)%mod;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\nint fac[100005],inv[100005];\nvoid init(){\n\tfac[0]=1;\n\tfor(int i=1;i<=100000;i++) fac[i]=(long long)fac[i-1]*i%mod;\n\tinv[100000]=qp(fac[100000],mod-2);\n\tfor(int i=99999;i>=0;i--) inv[i]=(long long)inv[i+1]*(i+1)%mod;\n}\nint C(int i,int j){\n\tif(i<0||j<0||i<j) return 0;\n\treturn (long long)fac[i]*inv[i-j]%mod*inv[j]%mod;\n}\nint b[50005],n,pre[50005],dp[2][50005];\nsigned main(){\n\tinit();\n\tcin>>n;\n\tfor(int i=1;i<=n;i++) cin>>b[i],pre[i]=pre[i-1]+b[i];\n\tif(pre[n]%2==1) return cout<<0,0;\n\tint sum=pre[n]/2;\n\tdp[0][0]=1;\n\tfor(int i=1;i<=n;i++){\n\t    for(int j=0;j<=sum;j++){\n\t\t\tint tp2=j,tp1=pre[i-2]-j*2,tp0=sum-tp2-tp1;\n\t\t\tif(tp0<0) continue;\n\t\t\tdp[i&1][j]=0;\n\t    }\n\t\tfor(int j=0;j<=sum;j++){\n\t\t\tint tp2=j,tp1=pre[i-1]-j*2,tp0=sum-tp2-tp1;\n\t\t\tif(tp0<0) continue;\n\t\t\tfor(int k=0;k<=b[i];k++){\n\t\t\t\tif(tp1<k||tp0<b[i]-k) continue;\n\t\t\t\tif(dp[(i&1)^1][tp2]) (dp[i&1][tp2+k]+=(long long)dp[(i&1)^1][tp2]*C(tp1,k)%mod*C(tp0,b[i]-k)%mod)%=mod;\n\t\t\t}\n\t\t}\n\t}\n\tcout<<dp[n&1][sum];\n\treturn 0;\n}\n```",
        "postTime": 1667449825,
        "uid": 116664,
        "name": "Daniel_lele",
        "ccfLevel": 8,
        "title": "\u300cKDOI-03\u300d\u6784\u9020\u6570\u7ec4 \u9898\u89e3"
    },
    {
        "content": "\u8bb0 $a_i$ \u4e3a\u9898\u76ee\u4e2d\u7684 $b_i$\u3002\n\n\u9996\u5148\u5224\u6389 $2 \\nmid \\sum a_i$\u3002\u8bb0 $t=\\frac{\\sum a_i}2$\uff0c\u5219\u64cd\u4f5c\u6b21\u6570\u6070\u4e3a $t$ \u6b21\u3002\n\n\u4e0d\u59a8\u770b\u6210\u4e00\u4e2a\u957f\u4e3a $2t$ \u7684\u64cd\u4f5c\u5e8f\u5217 $p_1, p_2, \\dots, p_{2t}$\uff0c\u8981\u6c42\u5bf9\u4e8e\u6240\u6709 $1 \\le k \\le t$ \u6ee1\u8db3 $p_{2k-1} < p_{2k}$\u3002  \n\u66f4\u81ea\u7136\u5730\uff0c\u4e0d\u59a8\u6539\u4e3a $p_{2k-1} \\ne p_{2k}$\uff0c\u518d\u9664\u4ee5 $2^t$\u3002\n\n\u4e8e\u662f\u663e\u7136\u53ef\u4ee5\u5bb9\u65a5\uff0c\u679a\u4e3e $c_i = |\\{k \\mid 1 \\le k \\le t \\land p_{2k-1} = p_{2k} = i\\}|$\uff0c\u5219\u8d21\u732e\u4e3a\n$$\n(-1)^{\\sum c_i} \\binom t{c_1, c_2, \\dots, c_n, t-\\sum c_i} \\binom{2\\left(t-\\sum c_i\\right)}{a_1-2c_1, a_2-2c_2, \\dots, a_n-2c_n}\n$$\n\n\u90a3\u4e48\u4f5c\u4e3a\u4e00\u4e2a\u719f\u7ec3\u7684\u8ba1\u6570\u9009\u624b\uff0c\u60f3\u5fc5\u89e3\u6cd5\u5c31\u663e\u800c\u6613\u89c1\u4e86\u3002\u6784\u9020\n$$\nF_i(x) = \\sum_{j\\ge 0} \\frac{(-x)^j}{j!(a_i-2j)!}\n$$\n\n\u5219\u7b54\u6848\u5373\n$$\n2^{-t} t! \\sum_{s \\ge 0} \\frac{[2(t-s)]!}{(t-s)!} [x^s] \\prod_{i=1}^n F_i(x)\n$$\n\n\u5982\u66b4\u529b\u5377\u79ef\uff0c\u590d\u6742\u5ea6\u4e3a $O((\\sum a_i)^2)$\u3002\u5982\u4f7f\u7528\u5206\u6cbb NTT\uff0c\u590d\u6742\u5ea6\u4e3a $O((\\sum a_i) \\log (\\sum a_i) \\log n)$\u3002",
        "postTime": 1668949286,
        "uid": 75840,
        "name": "deserter",
        "ccfLevel": 0,
        "title": "P8863"
    },
    {
        "content": "\u9996\u5148\u8003\u8651\u5c06\u9898\u76ee\u8f6c\u5316\u4e00\u4e0b\uff0c\u4e5f\u5c31\u662f\u4ee4 $m=\\dfrac{\\sum_{i=1}^nb_i}2$ \uff08\u82e5\u65e0\u6cd5\u6574\u9664\u5219\u663e\u7136\u65e0\u89e3\uff09\uff0c\u5373\u5bf9\u4e8e $i\\in [1,n]\\cap \\mathbb Z$\uff0c\u5c06 $b_i$ \u4e2a $i$ \u586b\u5165 $m$ \u4e2a**\u6709\u6807\u53f7\u4e8c\u5143\u7ec4**\u4e2d\uff0c\u4e14\u6bcf\u4e2a\u4e8c\u5143\u7ec4\u5185\u90e8\u4e0d\u8003\u8651\u987a\u5e8f\uff0c\u4e5f\u4e0d\u80fd\u586b\u5165\u76f8\u540c\u7684\u6570\u3002\u8981\u6c42\u8ba1\u6570\u586b\u5165\u6240\u6709\u6570\u7684\u65b9\u6848\uff0c\u4e00\u4e2a\u65b9\u6848\u88ab\u5f62\u5f0f\u5316\u5730\u5b9a\u4e49\u4e3a\u5982\u4e0b\u96c6\u5408\n$$\nA=\\{\\left(i,\\ P\\right)\\ |\\  P=\\{p_1,p_2,\\cdots,p_{b_i}\\}\\}\n$$\n\u5bf9\u4e8e\u67d0\u4e2a $i$ \uff0c\u5176\u5bf9\u5e94\u7684 $\\{p_1,p_2,\\cdots,p_{b_i}\\}$ \u8868\u793a $i$ \u88ab\u586b\u5165\u54ea\u4e9b\u4e8c\u5143\u7ec4\u4e2d\u3002\n\n\u8003\u8651\u5982\u4f55\u5c06\u8f6c\u5316\u540e\u7684\u4e00\u4e2a\u65b9\u6848\u8f6c\u5316\u4e3a\u9898\u76ee\u6240\u5b9a\u4e49\u7684\u539f\u65b9\u6848\uff0c\u663e\u7136\uff0c\u5bf9\u4e8e\u539f\u65b9\u6848\u7684\u7b2c $x$ \u6b21\u64cd\u4f5c\uff0c\u4e5f\u5373\u6807\u53f7\u4e3a $x$ \u7684\u4e8c\u5143\u7ec4\uff0c\u53ea\u9700\u627e\u5230 $2$ \u4e2a\uff08\u4e5f\u4ec5\u6709 $2$ \u4e2a\uff09$i$ \u4f7f\u5f97 $x\\in P$ \uff0c\u5c06\u8fd9 $2$ \u4e2a $i$ \u6309\u5927\u5c0f\u586b\u5165\u7b2c $x$ \u4e2a\u4e8c\u5143\u7ec4\u5373\u53ef\u3002\u5bb9\u6613\u8bc1\u660e\u5176\u4e3a\u53cc\u5c04\u3002\n\n\u8003\u8651 DP\u3002\u901a\u8fc7\u5bf9 $A$ \u4e2d $i$ \u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u4ee5\u6807\u53f7 $i$ \u4e3a\u9636\u6bb5\u3002\u800c\u5728 $b_i$ \u4e2a $i$ \u586b\u5165\u54ea\u4e9b\u4e8c\u5143\u7ec4\u7684\u51b3\u7b56\u4e2d\uff0c\u4f9d\u7167\u65b0\u65b9\u6848\u7684\u5f62\u5f0f\u5316\u5b9a\u4e49\uff0c\u51b3\u7b56\u987a\u5e8f\u5b9e\u9645\u4e0a\u5e76\u4e0d\u91cd\u8981\u3002\u56e0\u6b64\uff0c\u53ea\u9700\u5c06 $m$ \u4e2a\u4e8c\u5143\u7ec4\u5206\u7c7b\u4e3a\u5df2\u7ecf\u586b\u5165 $2$ \u4e2a\u6570\u7684\u3001\u4ec5\u586b\u5165 $1$ \u4e2a\u6570\u7684\u548c\u672a\u586b\u7684\uff0c\u5373\u53ef\u5b8c\u6574\u5b9a\u4e49\u4e00\u4e2a\u72b6\u6001\u3002\n\n\u8003\u8651\u8bbe $f(i,m_1,m_2)$ \u8868\u793a\u4ec5\u586b\u5b8c $1\\sim i$\uff0c\u4e14\u6ee1\u8db3\u5f53\u524d $m$ \u4e2a\u4e8c\u5143\u7ec4\u6709 $m_2$ \u4e2a\u586b\u5165 $2$ \u4e2a\u6570\u7684\u3001$m_1$ \u4e2a\u586b\u5165 $1$ \u4e2a\u6570\u7684\u548c $m-m_1-m_2$ \u4e2a\u672a\u586b\u7684\u6240\u6709\u586b\u5165\u65b9\u6848\u7684\u6570\u91cf\u3002\u5bb9\u6613\u5f97\u5230\u72b6\u6001\u8f6c\u79fb\n$$\nf(i,m_1,m_2)=\\sum_{0\\le k\\le\\min(b_i,m_2)}f(i-1,m_1+k,m_2-k)\\binom{m_1}{k}\\binom{m_0}{b_i-k}\\quad(m_0=m-m_1+m_2\\ge 0)\n$$\n\u4f46\u662f\uff0c\u8fd9\u6837\u7684\u8f6c\u79fb\u662f $\\mathrm O((n+m)m^2)$ \u7684\u3002\n\n\u6ce8\u610f\u5230\uff0c\u4ec5\u8003\u8651\u586b\u5b8c $1\\sim i$ \u65f6\uff0c$m_1=\\sum_{j=1}^ib_j-2m_2$ \uff0c\u56e0\u6b64\u6211\u4eec\u76f4\u63a5\u5220\u9664 $m_1$ \u8fd9\u4e00\u7ef4\uff0c\u5373\n$$\nf(i,m_2)=\\sum_{0\\le k\\le\\min(b_i,m_2)}f(i-1,m_2-k)\\binom{m_1}{k}\\binom{m_0}{b_i-k}\\quad (m_1,m_0\\ge 0)\n$$\n\u56e0\u6b64\uff0c\u4f7f\u7528\u6eda\u52a8\u6570\u7ec4\uff0c\u5373\u53ef\u5728\u7a7a\u95f4\u5141\u8bb8\u7684\u60c5\u51b5\u4e0b\u505a\u5230 $\\mathrm O(m^2)$ \uff0c\u5b9e\u9645\u4e0a\u7531\u4e8e\u5927\u91cf\u4e0d\u5408\u6cd5\u72b6\u6001\uff0c\u5e38\u6570\u8fdb\u4e00\u6b65\u7f29\u5c0f\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\nusing LL = long long;\n\nconst int N = 5010, S = 30005, P = 998244353;\n\nint n;\nint b[N], s[N];\nint f[2][S];\nint inv[S], fac[S], ifac[S];\n\nvoid build(int n) {\n    inv[1] = 1;\n    for (int i = 2; i <= n; i++) \n        inv[i] = (LL)(P - P / i) * inv[P % i] % P;\n    fac[0] = ifac[0] = 1;\n    for (int i = 1; i <= n; i++) {\n        fac[i] = (LL)fac[i - 1] * i % P;\n        ifac[i] = (LL)ifac[i - 1] * inv[i] % P;\n    }\n}\n\nint binom(int n, int m) {\n    if (m < 0 || n < m) return 0;\n    return (LL)fac[n] * ifac[m] % P * ifac[n - m] % P;\n}\n\nint main() {  \n    ios::sync_with_stdio(false);\n    cin.tie(nullptr), cout.tie(nullptr);\n\n    cin >> n;\n    for (int i = 1; i <= n; i++) {\n        cin >> b[i];\n        s[i] = s[i - 1] + b[i];\n    }\n    if (s[n] & 1) {\n        cout << '0';\n        return 0;\n    }\n    int m = s[n] >> 1;\n    build(m);\n    f[0][0] = 1;\n    for (int i = 1; i <= n; i++) {\n        memset(f[i & 1], 0, (m + 1) << 2);\n        for (int j = 0; j <= m; j++) {\n            int m2 = j, m1 = s[i - 1] - 2 * j, m0 = m - m1 - m2;\n            if (m1 < 0 || m2 < 0) continue;\n            for (int k = 0; k <= b[i]; k++)\n                if (m1 - k >= 0 && m0 - (b[i] - k) >= 0)\n                    f[i & 1][m2 + k] = (f[i & 1][m2 + k] + (LL)f[i - 1 & 1][m2] * binom(m1, k) % P * binom(m0, b[i] - k) % P) % P;\n        }\n    }\n    cout << f[n & 1][m];\n    return 0;\n}\n```\n\n",
        "postTime": 1669049388,
        "uid": 86409,
        "name": "Night_star",
        "ccfLevel": 5,
        "title": "P8863 \u300cKDOI-03\u300d\u6784\u9020\u6570\u7ec4 \u9898\u89e3"
    },
    {
        "content": "\u88ab\u51ef\u6587\u52a0 $0$ \u4e86\u3002\n\n\u9996\u5148\uff0c\u82e5 $\\sum b_i$ \u662f\u5947\u6570\uff0c\u5219\u65b9\u6848\u6570\u4e3a $0$\uff0c\u4e0b\u9762\u53ea\u8003\u8651 $\\sum b_i$ \u4e3a\u5076\u6570\u7684\u60c5\u51b5\u3002\n\n\u8bbe $m=\\sum b_i$\u3002\n\n\u6ce8\u610f\u5230\u9700\u8981\u6c42\u7684\u65b9\u6848\u6570\u5b9e\u9645\u4e0a\u5bf9\u5e94\u4e00\u4e2a\u957f\u5ea6\u4e3a $m$ \u7684\u4e0d\u540c\u5e8f\u5217 $a$ \u7684\u4e2a\u6570\uff0c\u8fd9\u4e2a\u5e8f\u5217\u6ee1\u8db3\u4ee5\u4e0b\u4e24\u4e2a\u6761\u4ef6\uff1a\n\n1. \u5bf9\u4e8e $i\\in [1,n]$\uff0c\u6570 $i$ \u5728\u5e8f\u5217\u4e2d\u51fa\u73b0\u4e86 $b_i$ \u6b21\u3002\n2. \u5bf9\u4e8e $k\\in[1,\\frac{m}{2}]$\uff0c\u6ee1\u8db3 $a_{2k-1}<a_{2k}$\u3002\n\n\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u53ea\u9700\u8981\u6c42\u51fa\u6ee1\u8db3\u6761\u4ef6 $1$ \u4e14\u5bf9\u4e8e\u4efb\u610f $k\\in[1,\\frac{m}{2}]$\uff0c\u90fd\u6709 $a_{2k-1}\\neq a_{2k}$ \u7684\u5e8f\u5217\u6570\uff0c\u518d\u9664\u4ee5 $2^\\frac{m}{2}$ \u5373\u53ef\u3002\n\n\u6211\u4eec\u8003\u8651\u5bb9\u65a5\uff1a\u8bbe $dp[i][j]$ \u4e3a\u8003\u8651\u4e86 $[1,i]$ \u8fd9\u4e9b\u6570\uff0c\u6709\u81f3\u5c11 $j$ \u4e2a $k$ \u6ee1\u8db3 $a_{2k-1}=a_{2k}$ \u7684\u5e8f\u5217\u6570\u3002\n\n\u6211\u4eec\u8bbe\u6709 $c_i$ \u4e2a $k$ \u6ee1\u8db3 $a_{2k-1}=a_{2k}=i$\uff0c$d_i$ \u4e2a $i$ \u6ee1\u8db3\u4e0d\u5728\u8fd9 $c_i$ \u4e2a\u76f8\u7b49\u5bf9\u91cc\uff0c\u5219\u603b\u65b9\u6848\u6570\u4e3a $\\frac{(\\sum d_i)!}{\\prod(d_i!)}\\frac{(\\sum c_i)!}{\\prod(c_i!)}C(\\frac{\\sum d_i}{2}+\\sum c_i,\\sum c_i)$\uff0c\u5176\u4e2d $C$ \u662f\u7ec4\u5408\u6570\u3002\u8fd9\u4e09\u4e2a\u5206\u5f0f\u4e2d\u7b2c\u4e00\u4e2a\u8868\u793a $d_i$ \u5185\u90e8\u6392\u5e8f\u65b9\u6848\u6570\uff0c\u7b2c\u4e8c\u4e2a\u8868\u793a $c_i$ \u5185\u90e8\u6392\u5e8f\u65b9\u6848\u6570\uff0c\u7b2c\u4e09\u4e2a\u8868\u793a\u5c06 $c_i$ \u63d2\u5165 $d_i$ \u4e2d\u7684\u65b9\u6848\u6570\u3002\n\n\u800c $(\\sum d_i)!,(\\sum c_i)!,C(\\frac{\\sum d_i}{2}+\\sum c_i,\\sum c_i)$ \u90fd\u662f\u53ef\u4ee5\u6700\u540e\u518d\u8ba1\u7b97\u7684\uff0c\u6240\u4ee5\u6211\u4eec $dp$ \u503c\u4e2d\u53ea\u8bb0\u5f55 $\\frac{1}{\\prod(d_i!)\\prod(c_i!)}$ \u7684\u90e8\u5206\u3002\n\n\u8f6c\u79fb\u4e3a $dp[i][j]=\\sum dp[i-1][j-k]\\times\\frac{1}{k!(b_i-2k)!}$\u3002\n\n\u6ce8\u610f\u5230\u8f6c\u79fb\u662f\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u505a\u7684\u5c31\u662f\u628a $n$ \u4e2a $b_i$ \u6b21\u591a\u9879\u5f0f\u76f8\u4e58\uff0c\u8fd9\u4e00\u90e8\u5206\u53ef\u4ee5\u4f7f\u7528\u5206\u6cbb NTT \u505a\u5230 $O((\\sum b_i)\\log^2n)$\u3002\n\n\u6700\u540e\u7b54\u6848\u53ea\u9700\u8981\u5bb9\u65a5\u4e00\u4e0b\u5373\u53ef\u3002\n\n```cpp\n//Author: Kevin5307\n#include<bits/stdc++.h>\n//#pragma GCC optimize(\"O2\")\nusing namespace std;\n#define ll long long\n#define pb push_back\n#define mp make_pair\n#define ALL(x) (x).begin(),(x).end()\n#define rALL(x) (x).rbegin(),(x).rend()\n#define srt(x) sort(ALL(x))\n#define rev(x) reverse(ALL(x))\n#define rsrt(x) sort(rALL(x))\n#define sz(x) (int)(x.size())\n#define inf 0x3f3f3f3f\n#define pii pair<int,int>\n#define lb(v,x) (int)(lower_bound(ALL(v),x)-v.begin())\n#define ub(v,x) (int)(upper_bound(ALL(v),x)-v.begin())\n#define uni(v) v.resize(unique(ALL(v))-v.begin())\n#define longer __int128_t\nvoid die(string S){puts(S.c_str());exit(0);}\nconst ll mod=998244353;\nll ksm(ll a,ll b)\n{\n\tll res=1;\n\twhile(b)\n\t{\n\t\tif(b&1) res=res*a%mod;\n\t\ta=a*a%mod;\n\t\tb>>=1;\n\t}\n\treturn res;\n}\nnamespace convolution\n{\n\tconst ll gr=3;\n\tvector<ll> cvl(vector<ll> f,vector<ll> g)\n\t{\n\t\tint n=sz(f),m=sz(g);\n\t\tint len=1,b=0;\n\t\twhile(len<=n+m+2)\n\t\t{\n\t\t\tlen<<=1;\n\t\t\tb++;\n\t\t}\n\t\tint rev[len];\n\t\tmemset(rev,0,sizeof(rev));\n\t\tfor(int i=0;i<len;i++)\n\t\t\trev[i]=(rev[i>>1]>>1)|((i&1)<<(b-1));\n\t\tf.resize(len);\n\t\tg.resize(len);\n\t\tfor(int i=0;i<len;i++)\n\t\t\tif(i<rev[i])\n\t\t\t{\n\t\t\t\tswap(f[i],f[rev[i]]);\n\t\t\t\tswap(g[i],g[rev[i]]);\n\t\t\t}\n\t\tfor(int i=1;i<len;i<<=1)\n\t\t{\n\t\t\tll gn=ksm(gr,(mod-1)/(i+i));\n\t\t\tfor(int j=0;j<len;j+=(i+i))\n\t\t\t{\n\t\t\t\tll g0=1;\n\t\t\t\tfor(int k=0;k<i;k++,g0=g0*gn%mod)\n\t\t\t\t{\n\t\t\t\t\tll x=f[j+k],y=f[i+j+k]*g0%mod;\n\t\t\t\t\tf[j+k]=(x+y)%mod;\n\t\t\t\t\tf[i+j+k]=(x-y+mod)%mod;\n\t\t\t\t\tx=g[j+k];y=g[i+j+k]*g0%mod;\n\t\t\t\t\tg[j+k]=(x+y)%mod;\n\t\t\t\t\tg[i+j+k]=(x-y+mod)%mod;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<len;i++)\n\t\t\tf[i]=f[i]*g[i]%mod;\n\t\tfor(int i=0;i<len;i++)\n\t\t\tif(i<rev[i])\n\t\t\t\tswap(f[i],f[rev[i]]);\n\t\tfor(int i=1;i<len;i<<=1)\n\t\t{\n\t\t\tll gn=ksm(ksm(gr,mod-2),(mod-1)/(i+i));\n\t\t\tfor(int j=0;j<len;j+=(i+i))\n\t\t\t{\n\t\t\t\tll g0=1;\n\t\t\t\tfor(int k=0;k<i;k++,g0=g0*gn%mod)\n\t\t\t\t{\n\t\t\t\t\tll x=f[j+k],y=f[i+j+k]*g0%mod;\n\t\t\t\t\tf[j+k]=(x+y)%mod;\n\t\t\t\t\tf[i+j+k]=(x-y+mod)%mod;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<len;i++)\n\t\t\tf[i]=f[i]*ksm(len,mod-2)%mod;\n\t\twhile(sz(f)&&!f.back()) f.pop_back();\n\t\treturn f;\n\t}\n}\nll fact[60030],rfact[60030];\nvector<ll> v[5050];\nint main()\n{\n\tfact[0]=rfact[0]=1;\n\tfor(int i=1;i<60030;i++)\n\t{\n\t\tfact[i]=fact[i-1]*i%mod;\n\t\trfact[i]=ksm(fact[i],mod-2);\n\t}\n\tint n;\n\tscanf(\"%d\",&n);\n\tint tot=0;\n\tpriority_queue<pii,vector<pii>,greater<pii>> pq;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint x;\n\t\tscanf(\"%d\",&x);\n\t\ttot+=x;\n\t\tvector<ll> vect;\n\t\tfor(int i=0;i<=x;i+=2)\n\t\t\tvect.pb(rfact[i/2]*rfact[x-i]%mod);\n\t\tv[i]=vect;\n\t\tpq.push(mp(sz(v[i]),i));\n\t}\n\twhile(sz(pq)>1)\n\t{\n\t\tpii a=pq.top();pq.pop();\n\t\tpii b=pq.top();pq.pop();\n\t\tv[a.second]=convolution::cvl(v[a.second],v[b.second]);\n\t\tpq.push(mp(sz(v[a.second]),a.second));\n\t}\n\tint x=pq.top().second;\n\tll ans=0;\n\tfor(int i=0;i<sz(v[x]);i++)\n\t{\n\t\tll ways=v[x][i]*fact[i]%mod*fact[tot-i-i]%mod*fact[(tot-i-i)/2+i]%mod*rfact[i]%mod*rfact[(tot-i-i)/2]%mod;\n\t\tif(i%2)\n\t\t\tans=(ans-ways+mod)%mod;\n\t\telse\tans=(ans+ways)%mod;\n\t}\n\tif(tot%2)\n\t\tdie(\"0\");\n\tprintf(\"%lld\\n\",ans*ksm(ksm(2,mod-2),tot/2)%mod);\n\treturn 0;\n}\n```",
        "postTime": 1668950735,
        "uid": 172020,
        "name": "Kevin090228",
        "ccfLevel": 8,
        "title": "\u300cKDOI-03\u300d\u6784\u9020\u6570\u7ec4 \u9898\u89e3"
    },
    {
        "content": "\u4ecb\u7ecd\u4e00\u4e2a\u7528**\u5bb9\u65a5\u539f\u7406**\u7684\u505a\u6cd5\u3002\n\n\u663e\u7136\uff0c\u82e5 $\\sum b_i$ \u662f\u5947\u6570\uff0c\u7b54\u6848\u662f $0$\u3002\u4ee5\u4e0b\u5047\u8bbe $\\sum b_i$ \u662f\u5076\u6570\uff0c\u4ee4 $m = (\\sum b_i) / 2$\u3002\n\n\u8003\u8651\u4e0b\u8ff0\u95ee\u9898\uff1a\n\n\u6709 $2m$ \u4e2a\u4e24\u4e24\u4e0d\u540c\u7684\u4e1c\u897f\uff0c\u8fd9\u4e9b\u4e1c\u897f\u5c5e\u4e8e $n$ \u4e2a\u7c7b\u522b\uff0c\u5176\u4e2d\u7b2c $i$ \u7c7b\u4e1c\u897f\u6709 $b_i$ \u4e2a\u3002\u8fd9 $2m$ \u4e2a\u4e1c\u897f\u6709\u591a\u5c11\u4e2a\u6392\u5217 $p$ \u6ee1\u8db3\n\n- \u5bf9\u4e8e\u6bcf\u4e2a $i = 1, \\dots, m$ \u90fd\u6709 $p_{2i-1}$ \u548c $ p_{2i}$ \u4e0d\u662f\u540c\u4e00\u7c7b\u3002\n\n\uff08\u6b64\u95ee\u9898\u7684\u7b54\u6848\u9664\u4ee5 $2^{m} \\prod (b_i!)$ \u5c31\u662f\u539f\u95ee\u9898\u7684\u7b54\u6848\u3002\uff09\n\n\u6211\u4eec\u628a\u8fd9 $2m$ \u4e2a\u4e1c\u897f\u7684**\u4e0d**\u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\u7684\u6392\u5217 $p$ \u5206\u6210 $m$ \u7c7b\uff0c\u7b2c $i$ \u7c7b\u662f\u6ee1\u8db3 $p_{2i - 1} = p_{2i}$ \u7684\u6392\u5217\u3002\u540c\u65f6\u5c5e\u4e8e\u67d0\u7279\u5b9a\u7684 $k$ \u4e2a\u7c7b\u522b\u7684\u300c\u4e0d\u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\u7684\u6392\u5217\u300d\u6709\n\n$$\nS_k =  (2(m - k))! k! 2^k f_k\n$$\n\n\u4e2a\u3002\u5176\u4e2d $f_k$ \u8868\u793a\n\n- \u4ece\u8fd9 $2m$ \u4e2a\u4e1c\u897f\u4e2d\u9009\u51fa $k$ \u5bf9\u4e1c\u897f\uff0c\u6bcf\u4e00\u5bf9\u90fd\u662f\u540c\u4e00\u79cd\u7c7b\uff0c\u6709\u591a\u5c11\u79cd\u65b9\u6cd5\u3002\n\n\n$f_k$ \u662f\u591a\u9879\u5f0f\n\n$$\nP(x) := \\prod_{i=1}^{n} \\left( \\sum_{j = 0}^{\\lfloor b_i/2\\rfloor} {b_i \\choose 2j} (2j - 1)!! x^j \\right)\n$$\n\n\u7684 $x^k$ \u9879\u7684\u7cfb\u6570\u3002\n\n\n\u5e94\u7528\u5bb9\u65a5\u539f\u7406\uff0c\u4e0a\u8ff0\u95ee\u9898\u7684\u7b54\u6848\u53ef\u8868\u4e3a\n\n$$\n\\sum_{k = 0}^{m}(-1)^{k} {m \\choose k} S_k\n$$\n\n\n\u7528 NTT \u7b97\u51fa $P(x)$\uff0c\u518d\u5957\u5bb9\u65a5\u539f\u7406\u5373\u53ef\u3002\n\n\u7528\u66b4\u529b\u65b9\u6cd5\u628a\u8fd9 $n$ \u4e2a\u591a\u9879\u5f0f\u76f8\u4e58\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(m^2)$\u3002\u4e0b\u9762\u4ecb\u7ecd\u4e00\u4e2a\u66f4\u597d\u7684\u65b9\u6cd5\uff1a\n\n- \u628a\u8fd9 $n$ \u4e2a\u591a\u9879\u5f0f\u653e\u5230\u4e00\u4e2a\u961f\u5217\u91cc\u3002\n- \u53d6\u51fa\u961f\u9996\u7684\u4e24\u4e2a\u591a\u9879\u5f0f\u76f8\u4e58\uff0c\u628a\u4e58\u79ef\u653e\u5230\u961f\u5c3e\u3002\u91cd\u590d\u6b64\u64cd\u4f5c\u76f4\u5230\u961f\u5217\u91cc\u53ea\u5269\u4e00\u4e2a\u591a\u9879\u5f0f\u3002\n- \u6700\u540e\u961f\u5217\u91cc\u7684\u90a3\u4e2a\u591a\u9879\u5f0f\u5c31\u662f\u7b54\u6848\u3002\n\n\u6b64\u65b9\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(m \\log m \\log n)$\u3002\n\n\n",
        "postTime": 1669126177,
        "uid": 28900,
        "name": "zjsdut",
        "ccfLevel": 0,
        "title": "P8863\u5bb9\u65a5\u539f\u7406\u505a\u6cd5"
    },
    {
        "content": "\u4ee4 $sum=\\sum b_i$\u3002\n\n\u8003\u8651\u770b\u6210\u6709 $\\frac{sum}{2}$ \u4e2a\u76d2\u5b50\uff0c\u6bcf\u4e2a\u76d2\u5b50\u53ef\u4ee5\u653e\u4e24\u4e2a\u7403\uff0c\u8fd9\u4e24\u4e2a\u7403\u4e0d\u80fd\u76f8\u540c\uff0c\u7b2c $i$ \u79cd\u7403\u6709 $b_i$ \u4e2a\u3002\n\n\u7136\u540e\u8003\u8651\u4e00\u4e2a\u4e00\u4e2a $b_i$ \u7684\u52a0\u3002\n\n\u6211\u4eec\u9700\u8981\u77e5\u9053\u7684\u662f\u6709\u591a\u5c11\u4e2a\u76d2\u5b50\u80fd\u653e\u4e24\u4e2a\u7403\uff0c\u591a\u5c11\u4e2a\u80fd\u653e\u4e00\u4e2a\uff0c\u591a\u5c11\u4e2a\u653e\u4e0d\u4e86\u4e86\u3002\n\n\u8bbe $dp_{i,j}$ \u8868\u793a\u52a0\u4e86\u524d $i$ \u4e2a\u5143\u7d20\uff0c\u8fd8\u6709 $j$ \u4e2a\u76d2\u5b50\u80fd\u653e\u4e00\u4e2a\u3002\u90a3\u4e48\u6211\u4eec\u77e5\u9053\u76ee\u524d\u6211\u4eec\u4e00\u5171\u52a0\u4e86 $S=\\sum_{k=1}^{i}b_k$ \u4e2a\u7403\uff0c\u6709 $j$ \u4e2a\u653e\u4e86\u4e00\u4e2a\uff0c\u5c31\u6709 $\\frac{S-j}{2}$ \u4e2a\u76d2\u5b50\u653e\u4e86\u4e24\u4e2a\uff08\u4e0d\u6574\u9664\u5c31\u4e0d\u5408\u6cd5\uff09\uff0c\u53c8\u56e0\u4e3a\u6211\u4eec\u77e5\u9053\u4e00\u5171\u6709\u591a\u5c11\u76d2\u5b50\uff0c\u4e5f\u5c31\u77e5\u9053\u4e86\u8fd8\u6709\u591a\u5c11\u4e2a\u76d2\u5b50\u6ca1\u6709\u653e\u7403\u3002\n\n\u8bb0 $dp_{i,j}$ \u5bf9\u5e94\u7684\u4e09\u79cd\u5143\u7d20\u6570\u91cf\u4e3a $(a,b,c)$\uff0c$a=\\frac{S-j}{2},b=j,c=\\frac{sum}{2}-a-b$\u3002\n\n\u8003\u8651\u4ece $i-1$ \u8f6c\u79fb\uff0c\u66b4\u529b\u7684\u8f6c\u79fb\u662f\u679a\u4e3e\u4e00\u4e2a $k$ \uff0c\u4ece $dp_{i-1,k}$ \u8f6c\u79fb\u5230 $dp_{i,j}$ \uff0c\u8bb0 $dp_{i-1,k}$ \u5bf9\u5e94 $(a',b',c')$\u3002\u8003\u8651\u8f6c\u79fb\u7684\u7cfb\u6570\uff0c\u539f\u6765\u6709 $c'$ \u4e2a\u6ca1\u6709\u7403\u7684\u76d2\u5b50\uff0c\u73b0\u5728\u53ea\u6709 $c$ \u4e2a\uff0c\u90a3\u4e48\u6709 $c'-c$ \u4e2a\u7a7a\u7684\u53d8\u6210\u88c5\u4e86\u4e00\u4e2a\u7403\u7684\u76d2\u5b50\uff08\u663e\u7136\u4e0d\u80fd\u53d8\u6210\u88c5\u4e24\u4e2a\uff09\uff0c\u6240\u4ee5\u8fd9\u91cc\u8981\u4e58 $C^{c'-c}_{c}$\uff0c\u7136\u540e\u539f\u6765\u6709 $a'$ \u4e2a\u88c5\u4e86\u4e24\u4e2a\u7684\u76d2\u5b50\uff0c\u73b0\u5728\u53d8\u6210\u4e86 $a$ \u4e2a\uff0c\u90a3\u4e48\u6709 $a-a'$ \u4e2a\u88c5\u4e86\u4e00\u4e2a\u7684\u76d2\u5b50\u53c8\u88c5\u4e86\u4e00\u4e2a\u3002\u518d\u4e58\u4e00\u4e2a $C^{a'-a}_{b'}$\u3002\u5373 $dp_{i,j}=\\sum dp_{i-1,k}\\times C^{c'-c}_{c} \\times C^{a'-a}_{b'}$\u3002\n\n\u8fd9\u6837\u505a\u7684\u590d\u6742\u5ea6\u662f $O(n w^2)$ \u7684\uff0c\u5176\u4e2d $w=\\sum b_i$\u3002\n\n\u6ce8\u610f\u5230\u4e00\u4e2a $(a,b,c)$ \u5bf9\u4e8e\u6bcf\u4e2a $i$ \u552f\u4e00\u786e\u5b9a\u4e86\u4e00\u4e2a $dp_{i,k}$ \uff0c\u8003\u8651\u679a\u4e3e $a'$ \uff0c\u6839\u636e\u521a\u624d\u7684\u5f0f\u5b50\u53ef\u4ee5\u53cd\u63a8\u51fa $b',c'$\uff0c\u4e5f\u5c31\u77e5\u9053\u6240\u5bf9\u5e94\u54ea\u4e2a $dp_{i-1,k}$ \uff0c\u6211\u4eec\u53d1\u73b0 $|a-a'|\\le b_i$\uff08\u8fd9\u91cc\u53d8\u91cf\u540d\u91cd\u4e86\uff0c\u95ee\u9898\u4e0d\u5927\uff09\uff0c\u6240\u4ee5\u603b\u590d\u6742\u5ea6\u53d8\u6210\u4e86 $O(w^2)$ \uff0c\u5e38\u6570\u8f83\u5c0f\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002",
        "postTime": 1668940539,
        "uid": 282751,
        "name": "cryozwq",
        "ccfLevel": 7,
        "title": "P8863 \u300cKDOI-03\u300d\u6784\u9020\u6570\u7ec4 \u9898\u89e3"
    }
]
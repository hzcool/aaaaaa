[
    {
        "content": "\u672c\u849f\u84bb\u7b2c\u4e00\u6b21\u5199\u9898\u89e3,\u6709\u4e0d\u5f53\u4e4b\u5904,\u591a\u591a\u4f53\u8c05\n\n\u6211\u4eec\u5148\u8003\u8651\u5927\u6a21\u62df,\u76f4\u63a5\u8fdb\u884c\u6a21\u62df\u5b9e\u9a8c\u6b65\u9aa4\u6709,\u540c\u65f6\u5728\u6bcf\u4e00\u6b65\u53cd\u5e94\u4e2d\u68c0\u6d4b\u6240\u6709\u53ef\u751f\u6210\u7684\u6c89\u6dc0$O(mk)$,\u7136\u540e\u770b\u6570\u636e\u8303\u56f4,\u663e\u7136\u6ca1\u6709\u90a3\u4e48\u7b80\u5355.\n\n\u540c\u6837\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6570\u636e\u8303\u56f4\u53ef\u4ee5\u731c\u5230\u8fd9\u5927\u6982\u662f$O(n log n)$,\u91cd\u65b0\u8bfb\u9898\n\n \u7b2c$i$\u4e2a\u6b65\u9aa4\u662f\u5c06\u7b2c$a_i$\u4e2a\u74f6\u5b50\u5185\u7684\u6240\u6709\u6db2\u4f53\u5012\u5165\u7b2c$b_i$\u4e2a\u74f6\u5b50\uff0c\u6b64\u540e\u7b2c$a_i$\u4e2a\u74f6\u5b50**\u4e0d\u4f1a\u518d\u88ab**\u7528\u5230\u3002\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u753b\u4e00\u5f20\u56fe\u6765\u6e05\u6670\u7684\u8868\u793a\u8fd9\u4e2a\u8fc7\u7a0b\n\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/k1pm4ivs.png)\n\n\n\n\n\n\n\n\u8fd9\u5f20\u56fe\u76f4\u63a5\u8ba9\u6211\u60f3\u8d77\u4e86\u653f\u6cbb\u8001\u5e08\u5728\u7f51\u8bfe\u4e2d\u8bf4\u7684: \u7a97\u5916\u90a3\u7eff\u6cb9\u6cb9\u7684\u662f\u4ec0\u4e48,\u90a3\u4e0d\u662f\u6811\u5417.\n\n\u6211\u4eec\u4e0d\u96be\u53d1\u73b0\n\n1.\u8fd9\u662f\u4e8c\u53c9\u6811\u6784\u6210\u7684\u68ee\u6797\n\n2.\u6240\u6709\u53f6\u5b50\u8282\u70b9\u5c31\u662f\u6211\u4eec\u7684\u5316\u5b66\u8bd5\u5242\n\n3.\u6c89\u6dc0\u5c31\u662f\u4e24\u4e2a\u8bd5\u5242\u7684**LCA**\n\n\u540c\u6837,\u4e0d\u96be\u60f3\u5230\u6df1\u5ea6\u5927,\u8bf4\u660e\u53cd\u5e94\u5148\u53d1\u751f,\u8fd9\u6837\u6211\u4eec\u5c31\u53ea\u7528\u6309\u7167\u53cd\u5e94\u987a\u5e8f\u6a21\u62df\u5c31\u884c\u4e86\n\n\u53cd\u5e94\u4ea7\u751f\u7684\u6c89\u6dc0\u662f\u4e24\u4e2a\u8bd5\u5242\u4e2d\u91cf\u8f83\u5c0f\u7684\u4e24\u500d\n\n\u7b54\u6848\u662f\u4e0d\u662f\u5df2\u7ecf\u547c\u4e4b\u6b32\u51fa,\u770b\u4e0a\u53bb\u8fc7\u7a0b\u5f88~~\u7b80\u5355~~,\u5b9e\u9645\u4e0a\u5b9e\u73b0\u6709\u5f88\u591a\u7ec6\u8282\n\n\u90a3\u5c31\u653eCODE\u4e86\n```cpp\n/*\n * @Author: Huanyue \n * @Date: 2020-02-13 07:45:25 \n * @Last Modified by: Huanyue\n * @Last Modified time: 2020-02-13 08:41:08\n */\n\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n#include <queue>\n#include <utility>\n#include <vector>\n#define rgi register\ntypedef long long ll;\nusing namespace std;\n\ninline void write(rgi int x)\n{\n    if (x < 0)\n    {\n        putchar('-'), x = -x;\n    }\n    if (x >= 10)\n    {\n        write(x / 10);\n    }\n    putchar('0' + x % 10);\n}\n\ninline int read()\n{\n    int x = 0, f = 1;\n    char ch = getchar();\n    while (ch < '0' || ch > '9')\n    {\n        if (ch == '-')\n            f = -1;\n        ch = getchar();\n    }\n    while (ch >= '0' && ch <= '9')\n    {\n        x = ((x << 3) + (x << 1) + (ch ^ 48));\n        ch = getchar();\n    }\n    return x * f;\n}\n\nconst int N = 2e5 + 10;\nconst int M = 2e5 + 10;\nll ans;\nint n, m, k, head[N + M], cnt, pos[N];\nint g[N], dep[N + M], f[N + M][20], tot;\n\nstruct Edge\n{\n    int next, to;\n} e[(N + M) << 1]; //\u4e24\u500d\u5f00\u8fb9\nstruct Q\n{\n    int x, y, sc, dep, id;\n} q[500010];\n\nbool cmp(const Q &a, const Q &b)\n{\n    return a.dep == b.dep ? a.id < b.id : a.dep > b.dep;//\u6df1\u5ea6\u4f18\u5148\n}\nvoid add_edge(int x, int y)\n{\n    e[++cnt] = (Edge){head[x], y};\n    head[x] = cnt;\n    e[++cnt] = (Edge){head[y], x};\n    head[y] = cnt;\n}\nvoid dfs(int x)\n{\n    for (int i = 1; i <= 19; i++)\n        f[x][i] = f[f[x][i - 1]][i - 1];\n    for (int i = head[x]; i; i = e[i].next)\n        if (e[i].to != f[x][0])\n        {\n            f[e[i].to][0] = x;\n            dep[e[i].to] = dep[x] + 1;\n            dfs(e[i].to);\n        }\n}\nint lca(int x, int y)\n{\n    if (dep[x] < dep[y])\n        swap(x, y);\n    int d = dep[x] - dep[y];\n    for (int i = 19; i >= 0; --i)\n        if ((d >> i) & 1)\n            x = f[x][i];\n    if (x == y)\n        return x;\n    for (int i = 19; i >= 0; --i)\n        if (f[x][i] != f[y][i])\n            x = f[x][i], y = f[y][i];\n    return f[x][0];\n}\nint main()\n{\n    n = read(), m = read(), k = read();\n\n    for (rgi int i = 1; i <= n; i++)\n    {\n        pos[i] = i;\n        g[i] = read();\n    }\n\n    for (rgi int i = 1; i <= m; i++)\n    {\n        int u = read(), v = read(), sc = n + i;\n        add_edge(pos[u], sc); //\u90fd\u5411\u751f\u6210\u7269\u52a0\u8fb9\n        add_edge(pos[v], sc);\n        pos[v] = sc;\n    }\n    for (rgi int i = n + m; i >= 1; --i) //\u6ce8\u610f\u662fn+m,\u56e0\u4e3a\u6709m\u4e2a\u53cd\u5e94\u7269\n        if (!f[i][0])\n            dfs(i); //\u500d\u589eLCA\u7684\u9884\u5904\u7406\n    for (rgi int i = 1; i <= k; i++)\n    {\n        int c = read(), d = read(), sc;\n        sc = lca(c, d);\n        if (!sc)\n            continue;                           //\u65e0\u6cd5\u751f\u6210\u5c31\u8fc7\n        q[tot++] = (Q){c, d, sc, dep[sc], tot}; //\u52a0\u5165\u6a21\u62df\u5217\u8868\n    }\n    sort(q, q + tot, cmp); //\u6309\u7167\u987a\u5e8f\u53cd\u5e94\n    for (int i = 0; i < tot; i++)\n    {\n        int x = q[i].x, y = q[i].y;\n        int use = min(g[x], g[y]);\n        g[x] -= use, g[y] -= use;\n        ans += (use << 1);\n    }\n    printf(\"%lld\\n\", ans);\n    return 0;\n}\n```",
        "postTime": 1581556284,
        "uid": 225849,
        "name": "huanyue",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5578 \u3010[PA2014]Fiolki\u3011"
    },
    {
        "content": "[My Blog](https://www.cnblogs.com/lyttt/p/14044526.html)\n\n[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/P5578)\n\n### \u9898\u76ee\u89e3\u6790\n\n~~\u795e\u5947\u9898\u76ee\uff0c\u6d1b\u8c37\u8bc4\u5206\u5c45\u7136\u662f\u666e\u53ca+\uff0c\u679c\u7136\u8fd8\u662f\u6211\u592a\u83dc\u4e86\u5417$qwq$~~\n\n\u9898\u610f\u6211\u4e5f\u770b\u4e86\u597d\u4e00\u4f1a\u513f\uff0c\u6211\u4ee5\u4e3a\u5b83\u662f\u4e00\u4e2a\u7c7b\u4f3c\u4e8e\u5316\u5408\u53cd\u5e94\u7684\u4e1c\u897f\uff0c\u628a\u8bd5\u5242$a$\u5012\u5165\u8bd5\u5242$b$\u4e4b\u540e\uff0c\u836f\u6c34\u5c31\u5168\u90e8\u53d8\u6210\u8bd5\u5242$b$\u4e86\uff0c\u800c\u8d28\u91cf\u4e3a\u4e24\u8005\u7684\u548c\uff08\u8d28\u91cf\u5b88\u6052\u5b9a\u5f8b\uff09\u3002\n\n\u4f46\u5b9e\u9645\u4e0a\u9898\u76ee\u7684\u610f\u601d\u53ea\u662f\u628a\u8fd9\u4e24\u79cd\u836f\u6c34\u6df7\u5408\u5728\u4e00\u8d77\uff0c\u662f\u7269\u7406\u53d8\u5316\uff0c\u53ea\u6709\u751f\u6210\u7684\u90a3\u4e2a\u6c89\u6dc0\u662f\u5316\u5b66\u53d8\u5316\u3002\n\n\u9996\u5148\u53ef\u4ee5\u60f3\u5230\u4e00\u4e2a$O(mk)$\u7684\u5927\u66b4\u529b\uff0c\u4f46\u662f\u6570\u636e\u8303\u56f4\u663e\u7136\u8fc7\u4e0d\u53bb\u3002\n\n\u8003\u8651\u5230\u91cd\u8981\u7684\u662f\u8fd9\u4e9b\u6c89\u6dc0\u4eec\u5404\u81ea\u7684\u987a\u5e8f\uff0c\u56e0\u4e3a\u987a\u5e8f\u4e0d\u540c\uff0c\u53d1\u751f\u53cd\u5e94\u65f6\u53cd\u5e94\u7269\u7684\u5df2\u6d88\u8017\u91cf\u53ef\u80fd\u4e0d\u540c\uff0c\u4e5f\u5c31\u662f\u53cd\u5e94\u7269\u7684\u91cf\u53ef\u80fd\u4e0d\u540c\uff0c\u4ea7\u7269\u7684\u91cf\u53ef\u80fd\u4e0d\u540c\u3002\n\n\u6240\u4ee5\u91cd\u70b9\u5728\u4e8e\u5224\u65ad\u5404\u4e2a\u6c89\u6dc0\u7684\u987a\u5e8f\u3002\n\n\u795e\u5947\u7684\u505a\u6cd5\u6765\u558f\uff0c\u5c31\u662f\u5176\u5b9e\u628a\u4e24\u4e2a\u53cd\u5e94\u7269\u5411\u751f\u6210\u7269\u8fde\u4e00\u6761\u8fb9\uff08\u6211\u521a\u5f00\u59cb\u60f3\u7684\u662f\u76f4\u63a5$a->b$\u8fde\u8fb9\u4e86\uff0c\u6ca1\u6709\u60f3\u5230\u628a$b$\u81ea\u5df1\u62c6\u6210\u53cd\u5e94\u7269\u548c\u751f\u6210\u7269\uff0c\u7136\u540e\u6ca1\u6709\u505a\u51fa\u6765\uff09\uff0c\u90a3\u4e48\u5c31\u5f62\u6210\u4e86\u4e00\u4e2a\u4e8c\u53c9\u6811\u68ee\u6797\uff08\u4e0d\u4e00\u5b9a\u8054\u901a\uff09\uff0c\u53f6\u5b50\u7ed3\u70b9\u90fd\u662f\u539f\u6765\u7684\u8bd5\u5242\uff0c\u5982\u679c\u4e24\u79cd\u8bd5\u5242\u4f1a\u53cd\u5e94\uff0c\u90a3\u4e48\u5b83\u4eec\u4f1a\u5728$lca$\u7684\u4f4d\u7f6e\u76f8\u9047\uff0c\u7136\u540e\u53cd\u5e94\u751f\u6210\u6c89\u6dc0\uff0c\u751f\u6210\u7684\u6c89\u6dc0\u8d28\u91cf\u4e3a$2$\u500d\u8f83\u5c0f\u8d28\u91cf\u6570\uff0c\u7136\u540e\u5404\u81ea\u51cf\u53bb\u8fd9\u4e2a\u8f6c\u5316\u91cf\u3002\n\n\u663e\u7136$lca$\u6df1\u5ea6\u6bd4\u8f83\u5927\u6c89\u6dc0\u5148\u53d1\u751f\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u627e\u51fa\u4e86\u8fd9\u4e9b\u6c89\u6dc0\u7684\u987a\u5e8f\u3002\u6ce8\u610f$lca$\u6df1\u5ea6\u76f8\u540c\u65f6\uff0c\u8981\u6309\u7167\u7ed9\u51fa\u987a\u5e8f\u6392\uff0c\u9898\u76ee\u8bf4\u4e86\u6309\u7167\u53cd\u5e94\u4f18\u5148\u987a\u5e8f\u7ed9\u51fa\u8fd9$k$\u5bf9\u53ef\u4ee5\u53cd\u5e94\u7684\u7269\u8d28\u3002\n\n\u7528\u500d\u589e\u6c42$lcs$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5e94\u8be5\u4e3a$O(k\\times log(n+m))$\n\n------\n\n### \u25baCode View\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<vector>\n#include<queue>\n#include<cstring>\nusing namespace std;\n#define N 200005\n#define M 200005\n#define K 500005\n#define INF 0x3f3f3f3f\n#define LL long long\nint rd()\n{\n\tint x=0,f=1;char c=getchar();\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1; c=getchar();}\n\twhile(c>='0'&&c<='9'){x=(x<<1)+(x<<3)+(c^48);c=getchar();}\n\treturn f*x;\n}\nint n,m,k;\nint g[N];\nvector<int>G[N+M];\nint pos[N];//\u5f53\u524d\u8bd5\u5242i\u7684\u7ed3\u70b9\u7f16\u53f7 \nint f[N+M][25],dep[N+M];\nstruct node{\n\tint a,b,cd,id;\n}q[K];\nint cnt;//\u6709\u6548\u6c89\u6dc0\u53cd\u5e94\u4e2a\u6570 \nLL ans;\nvoid add(int u,int v)\n{\n\tG[v].push_back(u);\n}\nbool cmp(node p,node q)\n{\n\tif(p.cd==q.cd) return p.id<q.id;//\u6ce8\u610fk\u5bf9\u8bd5\u5242\u6309\u7167\u53cd\u5e94\u4f18\u5148\u987a\u5e8f\u7ed9\u51fa\n\t//\u6211\u521a\u5f00\u59cb\u4ee5\u4e3a\u540c\u4e00\u5c42\u7684\u987a\u5e8f\u53ef\u4ee5\u968f\u4fbf \u5b9e\u9645\u4e0a\u4e0d\u884c \u56e0\u4e3a\u8bd5\u5242\u6709\u91cf\u7684\u591a\u5c11 \n\treturn p.cd>q.cd;\n}\nvoid dfs(int u)\n{\n\tfor(int i=1;i<=20;i++)\n\t\tf[u][i]=f[f[u][i-1]][i-1];\n\tfor(int i=0;i<G[u].size();i++)\n\t{\n\t\tint v=G[u][i];\n\t\tif(v==f[u][0]) continue;\n\t\tf[v][0]=u;\n\t\tdep[v]=dep[u]+1;\n\t\tdfs(v);\n\t}\n}\nint LCA(int u,int v)\n{\n\tint tmp;\n\tif(dep[u]<dep[v]) tmp=u,u=v,v=tmp;\n\tfor(int j=20;j>=0;j--)\n\t\tif(dep[f[u][j]]>=dep[v])\n\t\t\tu=f[u][j];\n\tif(u==v) return u;\n\tfor(int j=20;j>=0;j--)\n\t\tif(f[u][j]!=f[v][j])\n\t\t\tu=f[u][j],v=f[v][j];\n\treturn f[u][0];\n}\nint main()\n{\n\tn=rd(),m=rd(),k=rd();\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tpos[i]=i;\n\t\tg[i]=rd();\n\t}\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint a=rd(),b=rd();\n\t\tadd(pos[a],n+i);\n\t\tadd(pos[b],n+i);\n\t\tpos[b]=n+i;\n\t}\n\tfor(int i=n+m;i>=1;i--)\n\t\tif(f[i][0]==0)//\u53ef\u80fd\u4e0d\u8fde\u901a \u5373\u4e8c\u53c9\u6811\u68ee\u6797 \n\t\t\tdfs(i);\n\tfor(int i=1;i<=k;i++)\n\t{\n\t\tint a=rd(),b=rd(),lca=LCA(a,b);\n\t\tif(!lca) continue;//\u8fd9\u5bf9\u6c89\u6dc0\u4e0d\u4f1a\u51fa\u73b0\n\t\tnode tmp; tmp.a=a,tmp.b=b,tmp.cd=dep[lca],tmp.id=i;\n\t\tq[++cnt]=tmp;\n\t}\n\tsort(q+1,q+cnt+1,cmp);\n\tfor(int i=1;i<=cnt;i++)\n\t{\n\t\tint del=min(g[q[i].a],g[q[i].b]);\n\t\tg[q[i].a]-=del,g[q[i].b]-=del;\n\t\tans=ans+2ll*del;\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1606395883,
        "uid": 41165,
        "name": "Starlight_Glimmer",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5578 \u3010[PA2014]Fiolki\u3011"
    }
]
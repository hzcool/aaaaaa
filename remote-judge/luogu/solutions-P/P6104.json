[
    {
        "content": "\u6700\u540e\u90a3\u4e2a\u76f8\u540c\u7684\u6570\u53ea\u53ef\u80fd\u662f $m = \\max_{i=1}^{n} a_i$ \u6216\u8005 $\\ge m$ \u7684\u6700\u5c0f\u8d28\u6570\uff0c\u6bcf\u6b21\u7b97\u4e24\u79cd\u7684\u7b54\u6848\u7136\u540e\u53d6 $\\min$ \u5373\u53ef\u3002\r\n\r\n\u7b97\u7b54\u6848\u7684\u65f6\u5019\uff0c\u5c06\u6bcf\u4e2a\u6570\u52a0\u5230\u76ee\u6807\u503c\u7684\u8fc7\u7a0b\u6309\u7167\u8d28\u6570\u5212\u5206\u6210\u82e5\u5e72\u6bb5\uff0c\u53ef\u4ee5\u5dee\u5206\u5b9e\u73b0\u3002\u5bf9\u4e8e\u957f\u5ea6\u4e3a $k$ \u7684\u4e00\u6bb5\uff0c\u9009\u62e9\u7528 $c_1$ \u8fd8\u662f $c_2$ \u53d6\u51b3\u4e8e $kc_1$ \u548c $c_2$ \u54ea\u4e2a\u5927\uff0c\u663e\u7136\u8fd9\u73a9\u610f\u513f\u662f\u5355\u8c03\u7684\uff0c\u90a3\u4e48\u524d\u7f00\u548c\u4e00\u4e0b\u5373\u53ef\u3002\r\n\r\n\u6ce8\u610f\u5982\u679c\u76ee\u6807\u503c\u662f $m$ \u4e14 $m$ \u4e0d\u4e3a\u8d28\u6570\uff0c\u6bcf\u4e2a\u6570\u52a0\u5230 $m$ \u7684\u6700\u540e\u4e00\u6bb5\u53ef\u80fd\u53ea\u80fd\u4f7f\u7528 $c_1$\u3002\r\n\r\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n + m + q)$\u3002\r\n\r\n```cpp\r\nconst int N = 1e5 + 7, M = 1 << 17 | 1, P = 1e7 + 20;\r\nint n, m, q, o, a[N], v[P], f[P], c1, c2;\r\nvi p;\r\nvector<ll> c[2], e[2];\r\nll g[2], ans;\r\n\r\ninline void add(int o, int x, int k) {\r\n\tif (!x) return;\r\n\tif ((int)c[o].size() < x + 1) c[o].resize(x + 1);\r\n\tc[o][x] += k;\r\n}\r\n\r\ninline void prework(int o, int m) {\r\n\tvi d(p.size());\r\n\tfor (int i = 1; i <= n; i++) {\r\n\t\tint x = a[i];\r\n\t\tif (v[x] == v[m]) add(o, m - x, 1);\r\n\t\telse {\r\n\t\t\tadd(o, v[x] - x, 1);\r\n\t\t\tif (m == v[m]) add(o, m - p[f[v[m]]-1], 1);\r\n\t\t\telse g[o] += m - p[f[v[m]]-1];\r\n\t\t\t++d[f[v[x]]];\r\n\t\t}\r\n\t}\r\n\tfor (ui i = 0; p[i+1] < v[m]; i++) {\r\n\t\tif (i) d[i] += d[i-1];\r\n\t\tadd(o, p[i+1] - p[i], d[i]);\r\n\t}\r\n\te[o].resize(c[o].size());\r\n\tfor (ui i = 0; i < c[o].size(); i++) {\r\n\t\te[o][i] = c[o][i] * i;\r\n\t\tif (i) e[o][i] += e[o][i-1], c[o][i] += c[o][i-1];\r\n\t}\r\n}\r\n\r\ninline ll solve(int o) {\r\n\tint k = min((int)1.0 * c2 / c1, (int)c[o].size() - 1);\r\n\treturn (e[o][k] + g[o]) * c1 + (c[o].back() - c[o][k]) * c2;\r\n}\r\n\r\nint main() {\r\n\tfor (int i = 2; i < P; i++) {\r\n\t\tif (!v[i]) p.pb(v[i] = i), f[i] = p.size() - 1;\r\n\t\tfor (ui j = 0; j < p.size() && i * p[j] < P && p[j] <= v[i]; j++)\r\n\t\t\tv[i*p[j]] = p[j];\r\n\t}\r\n\tfor (int i = P - 1; i; i--) if (v[i] != i) v[i] = v[i+1];\r\n\trd(n), rd(q), rd(o);\r\n\tfor (int i = 1; i <= n; i++) rd(a[i]), m = max(m, a[i]);\r\n\tprework(0, m), prework(1, v[m]);\r\n\tfor (int i = 1; i <= q; i++) {\r\n\t\trd(c1), rd(c2), c1 ^= o * ans, c2 ^= o * ans;\r\n\t\tprint(ans = min(solve(0), solve(1)));\r\n\t\tans &= M - 2;\r\n\t}\r\n\treturn 0;\r\n}\r\n```",
        "postTime": 1582006724,
        "uid": 100544,
        "name": "xht",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P6104 \u3010[EER2]\u76f8\u540c\u7684\u6570\u5b57\u3011"
    },
    {
        "content": "- **\u95f2\u8bdd**\n\n\t\u5148\u653e\u4e00\u5f20\u6211\u5728\u6bd4\u8d5b\u4e2d\u6210\u7ee9\u7684\u56fe\uff1a\n\n\t![](https://cdn.luogu.com.cn/upload/image_hosting/bp9esjm2.png?x-oss-process=image/resize,m_lfit,h_510,w_775)\n\n\t\u6ca1\u9519\uff0c\u6211\u7adf\u7136\u8fc7\u4e86\u6700\u6bd2\u7624\u7684\u5361\u5e38\u70b9\uff0c\u7136\u540e\u522b\u7684\u6d4b\u8bd5\u70b9\u6ca1\u8fc7\u2026\u2026\n\n- **\u9898\u610f**\n\n  \u7ed9\u4f60 $n$ \u4e2a\u6570 $a_i$ \uff0c\u6bcf\u6b21\u53ef\u4ee5\u7ed9\u4e00\u4e2a\u6570 $+1$ \u6216\u8005\u53d8\u4e3a\u5b83\u7684\u4e0b\u4e00\u4e2a\u8d28\u6570\uff0c\u6700\u540e\u8ba9\u6240\u6709\u6570\u4e00\u6837\n  \n  \u4e24\u79cd\u64cd\u4f5c\u5404\u6709\u82b1\u8d39\uff0c\u9700\u8981\u6c42\u5728 $q$ \u79cd\u82b1\u8d39\u60c5\u51b5\u4e0b\uff0c\u5206\u522b\u7684\u6700\u5c0f\u603b\u82b1\u8d39\n  \n  $n \\le 10 ^ 5$\uff0c$a_i \\le 10 ^ 7$\uff0c$q \\le 10 ^ 6$\uff0c\u5f3a\u5236\u5728\u7ebf\n  \n- **\u89e3\u6790**  \n  \n  \u4e4d\u4e00\u770b\u8fd9\u4e2a\u4e1c\u897f\u4f3c\u4e4e\u5341\u5206\u4e0d\u53ef\u505a\uff0c\u6211\u4e00\u5f00\u59cb\u4ee5\u4e3a\u662f\u4ec0\u4e48\u52a8\u6001dp\u2026\u2026\n  \n  \u4f46\u662f\u4ed4\u7ec6\u601d\u8003\u4e00\u4e0b\uff0c\u5c31\u4f1a\u53d1\u73b0\uff0c\u5f53\u6700\u540e\u90a3\u4e2a\u4e00\u6837\u7684\u6570\u786e\u5b9a\u65f6\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6570\u7684\u6700\u5c0f\u82b1\u8d39\u633a\u597d\u6c42\u7684\n  \n  \u4e3a\u4e86\u65b9\u4fbf\u8868\u793a\uff0c\u8bbe\u8fd9\u4e2a\u6700\u540e\u7684\u6570\u4e3a$x$\n  \n  \u5c31\u662f\u6bcf\u6b21\u8003\u8651\u4e00\u4e0b\u76f4\u63a5\u8df3\u5230\u4e0b\u4e00\u4e2a\u8d28\u6570\u597d\uff0c\u8fd8\u662f\u4e00\u76f4$+1$\u52a0\u5230\u4e0b\u4e00\u4e2a\u8d28\u6570\u597d\uff08\u5f53\u7136\uff0c\u662f\u5728\u4e0b\u4e00\u4e2a\u8d28\u6570\u4e0d\u8d85\u8fc7$x$\u7684\u60c5\u51b5\u4e0b\uff09\n  \n  \u7136\u540e\u8003\u8651\u679a\u4e3e\u6700\u540e\u7684\u6570\uff0c\u518d\u679a\u4e3e\u6bcf\u4e2a\u6570\u8fdb\u884c\u6a21\u62df\u8ba1\u7b97\u51fa\u6700\u5c0f\u82b1\u8d39\n  \n  \u606d\u559c\u4f60\uff0c\u83b7\u5f97\u4e8610pts\u7684\u9ad8\u5206\uff01\uff08\u8fd9\u9898\u90e8\u5206\u5206\u7740\u5b9e\u6bd2\u7624\u2026\u2026\uff09\n  \n - **\u4f18\u53161**\n \n   \u663e\u7136\uff0c$x$\u7684\u503c\u8fd8\u662f\u6bd4\u8f83\u597d\u786e\u5b9a\u7684\uff0c$x \\ge a_i$ \uff0c\u800c $x$ \u5982\u679c\u592a\u5927\u80af\u5b9a\u6bd4\u8f83\u4e8f\n   \n   \u6240\u4ee5\u4f60\u53ef\u80fd\u89c9\u5f97 $x$ \u5c31\u662f $max(a_i)$ \uff0c\u7136\u540e\u4f60\u5c31WA\u98de\u4e86\n   \n   \u8003\u8651\u4e0b\u9762\u4e00\u7ec4\u6570\u636e\uff1a\n   \n\t~~~cpp\n    3 1 0\n\t3 3 4\n\t3 1\n   ~~~\n   \n   \u5728\u8fd9\u7ec4\u6570\u636e\u4e2d\uff0c\u5168\u90e8\u8df3\u5230 $5$ \u624d\u662f\u6700\u4f18\u89e3\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u65f6\u5019   $+1$ \u7684\u8d39\u7528\u5f88\u8d35\uff0c\u751a\u81f3\u6bd4\u8df3\u4e0b\u4e00\u4e2a\u8d28\u6570\u8fd8\u8981\u8d35\uff0c\u8fd9\u6837\u8fd8\u4e0d\u5982\u5168\u90e8\u8df3\u5230 $x$ \u7684\u4e0b\u4e00\u4e2a\u8d28\u6570\u6bd4\u8f83\u597d\n   \n   \u6240\u4ee5\uff0c\u4e00\u5171\u8981\u5206\u7c7b\u8ba8\u8bba\u4e24\u79cd\u60c5\u51b5\uff1a\n   \n   - $x$ \u4e3a $max(a_i)$\n   \n   - $x$ \u4e3a $max(a_i)$ \u7684\u4e0b\u4e00\u4e2a\u8d28\u6570\n   \n- **\u4f18\u53162**\n\n  \u5982\u679c\u4f60\u4ed4\u7ec6\u60f3\u4e00\u60f3\uff0c\u4f60\u5c31\u4f1a\u53d1\u73b0\uff0c\u8fd9\u6837\u4e00\u6b21\u4e00\u6b21\u6a21\u62df\u8df3\u8dc3\u5b9e\u5728\u662f\u6ca1\u6709\u5fc5\u8981\uff0c\u56e0\u4e3a $x$ \u662f\u56fa\u5b9a\u7684\uff0c$a_i$ \u4e5f\u662f\u56fa\u5b9a\u7684\uff0c\u6bcf\u6b21\u53ea\u8981\u66f4\u6539\u51b3\u7b56\u5c31\u884c\u4e86\n  \n  \u901a\u8fc7\u5c0f\u5b66\u77e5\u8bc6\u77e5\u9053\uff0c$len\\le c_2 /c_1$ \u7684\u6bb5 $+1$ \u6bd4\u8f83\u597d\uff0c$> c_2 / c_1$\u7684\u6bb5\u8df3\u8d28\u6570\n  \n  \u6240\u4ee5\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7edf\u8ba1\u6bcf\u6b21\u5728\u8df3\u8dc3\u8fc7\u7a0b\u4e2d\uff0c\u591a\u5c11\u4e2a $ len \\le p$ \uff08$p = c_2 / c_1$\uff09\u5c31\u884c\uff0c\u8bbe\u8fd9\u4e2a\u4e3a $total_{len}$\n  \n  \u5f53\u7136\uff0c\u5982\u679c\u4f60\u66b4\u529b\u6a21\u62df\u8df3\u8dc3\u7684\u8bdd\uff0c\u8fd8\u662f10pts\uff08\u8349\uff0c\u8fd9\u4ec0\u4e48\u6bd2\u7624\u9898\uff09\n  \n- **\u4f18\u53163**\n\n  \u73b0\u5728\uff0c\u6211\u4eec\u9700\u8981\u89e3\u51b3\u8fd9\u6837\u4e00\u4e2a\u95ee\u9898\uff1a\n  \n  - \u4ece $a_i$ \u8df3\u5230 $x$ \uff0c\u8ba1\u7b97\u51fa\u7ecf\u8fc7\u7684\u6bcf\u4e2a\u6bb5\u7684\u6bb5\u957f $len$\uff0c\u7136\u540e $total_{len} + 1$\uff08\u6bcf\u5230\u4e00\u4e2a\u8d28\u6570\u6216\u5230 $x$ \u7b97\u4e3a\u4e00\u6bb5\uff09\n  \n  \u8fd9\u4e2a\u6709\u4e24\u4e2a\u89e3\u51b3\u65b9\u6cd5\uff1a\n  \n  - \u5b98\u65b9\u9898\u89e3\u7684\u89e3\u6cd5\uff0c\u8003\u8651\u6bcf\u4e2a\u6570\u4f1a\u7ecf\u8fc7\u54ea\u4e9b\u6bb5\uff0c\u7136\u540e\u7ed9\u5bf9\u5e94\u6bb5\u6253\u4e0a $ + 1$ \u7684\u6807\u8bb0\uff08\u8fb9\u89d2\u7684 $total$ \u76f4\u63a5\u52a0\uff09\uff0c\u6700\u540e\u626b\u4e00\u904d\u6240\u6709\u6bb5\uff0c\u7b97\u51fa $total$ \u6570\u7ec4\n  \n  - \u53cd\u5411\u8003\u8651\uff0c\u8003\u8651\u6bcf\u4e2a\u6bb5\u4f1a\u88ab\u591a\u5c11\u4e2a\u6570\u7ecf\u8fc7\uff0c $a_i$ \u6392\u5e8f\u540e\uff0c\u4f7f\u7528\u53cc\u6307\u9488\u8ba1\u7b97\uff08\u8fb9\u89d2\u7684 $total$ \u4e5f\u8981\u8ba8\u8bba\uff09\n  \n  \u4ee3\u7801\u5e94\u8be5\u90fd\u4e0d\u597d\u5199\uff0c\u6bd5\u7adf\u8fd8\u6709\u4e00\u4e2a\u4f18\u53161\u7684\u5206\u7c7b\u8ba8\u8bba\n  \n- **tips**\n\n  1. \u5982\u679c\u4f7f\u7528\u5b98\u65b9\u9898\u89e3\u7684\u505a\u6cd5\uff0c\u6253\u6807\u8bb0\u7684\u65f6\u5019\u8981\u4f7f\u7528\u5dee\u5206\n  \n  2. \u7b97\u51fa $total$ \u540e\u66b4\u529b\u8ba1\u7b97\u7684\u8bdd\uff0c\u53ef\u80fd\u4f1a\u88ab\u5361\uff0c\u5efa\u8bae\u524d\u7f00\u548c + \u540e\u7f00\u548c\u5feb\u901f\u7edf\u8ba1\n  \n  3. \u6700\u540e\u4e00\u6bb5\u662f\u8981\u5206\u7c7b\u8ba8\u8bba\u7684\uff0c\u6240\u4ee5\u4e0d\u80fd\u76f4\u63a5\u52a0\u5230 $total$\uff0c\u5f97\u53e6\u5f00\u4e00\u4e2a\uff0c\u6700\u540e\u548c\u8df3\u5230\u6700\u5927\u503c\u53d6$min$\n  \n  4. \u7b5b\u8d28\u6570\u7684\u65f6\u5019\u8981\u7b5b\u5230 $10 ^ 7 + 50$ \u7684\u6837\u5b50\uff0c\u56e0\u4e3a\u53ef\u80fd\u4f1a\u8df3\u5230 $\\ge 10 ^ 7$ \u7684\u7b2c\u4e00\u4e2a\u8d28\u6570\uff08\u6211\u56e0\u4e3a\u8fd9\u4e2a\u88ab\u641e\u523023\u5206\u2026\u2026\u9519\u5931AK\uff09\n  \n  5. \u8fd9\u9898\u8981\u5361\u5e38\uff0c\u5426\u5219\u53ea\u80fd 97pts \n  \n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(a_i\\ log\\ log\\ a_i + n\\ log\\ n + q)$\n\n\u7a7a\u95f4\u590d\u6742\u5ea6\uff1a$O(a_i + n)$\n\n\u5176\u5b9e\u65f6\u95f4\u590d\u6742\u5ea6\u53ef\u4ee5\u505a\u5230 $O(a_i + n + q)$\uff0c\u5c31\u662f\u7528\u6b27\u62c9\u7b5b\u3001\u5b98\u65b9\u9898\u89e3\u7684 $total$ \u8ba1\u7b97\u6cd5\uff0c\u4f46\u662f\u610f\u4e49\u4e0d\u5927\n\n```cpp\n#include <cstdio>\n#include <algorithm>\n#define max(a,b) ((a) > (b) ? (a) : (b))\n#define min(a,b) ((a) < (b) ? (a) : (b))\n#define ll long long\nint n,q,T;\nint a[100005],mx;\nint b[100005];\n\nnamespace IO{\n\tinline void read(int &x){\n\t\tx = 0;char ch = getchar();\n\t\twhile(ch < '0' || ch > '9') ch = getchar();\n\t\twhile(ch >= '0' && ch <= '9') {x = x * 10 + ch - '0';ch = getchar();}\n\t}\n\tvoid W(ll x){\n\t\tif(x > 9) W(x / 10);\n\t\tputchar(x % 10 + '0');\n\t}\n\tinline void write(ll x){\n\t\tif(x < 0){ putchar('-');x = -x;}\n\t\tW(x);putchar('\\n');\n\t}\n};using namespace IO;\n\nint s[10000055];\nint p[1000005],cnt; \n\nvoid init(){\n\tregister int i,j;\n\tfor(i = 2;i <= 10000050;++i){\n\t\tif(s[i]) continue;\n\t\telse p[++cnt] = i;\n\t\tfor(j = 2 * i;j <= 10000050;j += i) s[j] = 1;\n\t}\n}\n\nll total[205],ex_total[205],extra;//total[i]\u5982\u9898\u89e3\u5185\u610f\u601d,ex_total[i]\u662f\u6700\u540e\u4e00\u6bb5\u7684total,extra\u662f\u8df3\u5230mx\u6240\u9700\u7684\u6b65\u6570 \nll pre[205],ex_pre[205],suf[205],ex_suf[205];//pre[i]\u662ftotal[i]\u7684\u524d\u7f00\u548c(\u5e26\u6743,\u56e0\u4e3a\u8981\u8ba1\u7b97\u8df3\u7684\u6b65\u6570),suf[i]\u662ftotal[i]\u7684\u540e\u7f00\u548c(\u4e0d\u5e26\u6743),ex_pre[i]\u610f\u601d\u5982ex_total \n\nvoid calc(){\n\tint i,j;\n\tstd::sort(b + 1,b + n + 1);\n\tj = 0;\n\tfor(i = 1;i <= cnt && p[i] <= mx;i++){//p[i] <= mx\u662f\u4e3a\u4e86\u540e\u9762\u5199\u7740\u65b9\u4fbf \n\t\twhile(b[j + 1] <= p[i - 1] && j < n){//b[j + 1] <= p[i - 1]\u8868\u793aj + 1\u5b8c\u5168\u7ecf\u8fc7p[i - 1] ~ p[i] \u8fd9\u4e00\u6bb5 \n\t\t\ttotal[p[i - 1] - b[j + 1]]++;//\u628ab[j + 1]\u8df3\u5230p[i - 1]\u7684\u4e00\u6bb5\u52a0\u5165 \n\t\t\tj++;\n\t\t}\n\t\ttotal[p[i] - p[i - 1]] += j; \n\t}\n\twhile(b[j + 1] <= p[i - 1] && j < n){//\u6ce8\u610f\uff1a\u8fd9\u91cc\u53ef\u80fd\u4f1a\u8fd8\u6709\u6570 \n\t\ttotal[p[i - 1] - b[j + 1]]++;\n\t\tj++;\n\t}\n\ti--;//\u73b0\u5728\u4fdd\u8bc1p[i] <= mx,\u4e14\u6700\u5927\u4e86,\u672c\u6765\u88ab++\u4e86\u4e00\u6b21 \n\tfor(j = 1;j <= n;j++){\n\t\textra += mx - max(p[i],a[j]);//\u6ce8\u610fp[i]\u548ca[j]\u8981\u53d6max \n\t}\n\tfor(i = 1;i <= 200;i++){//\u8ba1\u7b97\u524d\u7f00\u548c \n\t\tpre[i] = pre[i - 1] + i * total[i];\n\t\tex_pre[i] = ex_pre[i - 1] + i * ex_total[i];\n\t}\n\tfor(int i = 200;i >= 1;i--){//\u540e\u7f00\u548c \n\t\tsuf[i] = suf[i + 1] + total[i];\n\t\tex_suf[i] = ex_suf[i + 1] + ex_total[i];\n\t}\n}\n\nll solve(ll c1,ll c2){\n\tll cut = min(c2 / c1,200);//\u6ce8\u610f\u53d6\u4e2amin,\u5426\u5219\u4f1aRE \n\treturn pre[cut] * c1 + c2 * suf[cut + 1] + min(extra * c1,ex_pre[cut] * c1 + ex_suf[cut + 1] * c2);//\u81ea\u5df1\u770b\u4e00\u4e0b,\u5e94\u8be5\u4e0d\u96be\u7406\u89e3 \n}\n\nint main(){\n\tread(n),read(q),read(T);\n\tfor(int i = 1;i <= n;i++){\n\t\tread(a[i]);\n\t\tmx = max(mx,a[i]);\n\t\tb[i] = a[i];\n\t}\n\tinit();\n\tcalc();\n\tint c1,c2;\n\tll lastans = 0;\n\tfor(int i = 1;i <= q;i++){\n\t\tread(c1),read(c2);\n\t\tc1 = c1 ^ (T * (lastans % 131072));\n\t\tc2 = c2 ^ (T * (lastans % 131072));\n\t\tlastans = solve(c1,c2);\n\t\twrite(lastans);\n\t}\n\treturn 0;\n}\n```\n\n\u4f46\u6211\u8fd8\u662f\u89c9\u5f97\uff0c\u5982\u679c\u8fd9\u9898\u5199\u6b63\u89e3\u53bb\u4e16\u7684\u8bdd\uff0c\u597d\u6b79\u7ed9\u70b9\u90e8\u5206\u5206\u5427\u2026\u2026\n\n\u73b0\u5728\u662f\u4e00\u4e2a\u70b9\u60f3\u4e0d\u51fa\u6765\u76f4\u63a5\u70b8\u523010pts",
        "postTime": 1582111556,
        "uid": 49776,
        "name": "chenxinyang2006",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6104 \u3010[EER2]\u76f8\u540c\u7684\u6570\u5b57\u3011"
    },
    {
        "content": "# P6104\n\u7531\u4e8e\u672c\u9898\u4e2d\u7684 $a$ \u5e8f\u5217\u7684\u987a\u5e8f\u5bf9\u9898\u76ee\u6ca1\u6709\u4efb\u4f55\u5f71\u54cd\uff0c\u6211\u4eec\u4e0d\u59a8\u8bbe $a$ \u5e8f\u5217\u9012\u589e\u3002\n\n\u7136\u540e\u6211\u4eec\u4ee4 $p$ \u5e8f\u5217\u662f\u4ece $2$ \u5f00\u59cb\u7684\u8fde\u7eed\u8d28\u6570\u5e8f\u5217\uff0c\u5176\u4e2d $p_m$ \u4e3a\u5927\u4e8e\u7b49\u4e8e $a_n$ \u7684\u6700\u5c0f\u8d28\u6570\u3002\n\n\u90a3\u4e48\u4e00\u4e2a\u663e\u7136\u7684\u8d2a\u5fc3\u662f\uff1a\u6700\u7ec8\u7684\u7b54\u6848\u4e0d\u662f $a_n$ \u5c31\u662f $p_m$\u3002\n\n\u7531\u4e8e\u6211\u4eec\u53d1\u73b0\u76f8\u90bb\u7684\u4e24\u4e2a\u7d20\u6570\u4e4b\u95f4\u7684\u5dee\u6700\u5927\u4e0d\u8d85\u8fc7 $160$\uff0c\u6211\u4eec\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u5230 $a_n$ \u548c\u5230 $p_m$\uff0c\u6bcf\u4e00\u6bb5\u4e0d\u540c\u957f\u5ea6\u7684\u8de8\u5ea6\u5206\u522b\u51fa\u73b0\u4e86\u51e0\u6b21\uff0c\u7136\u540e\u6309\u7167 $c_1,c_2$ \u7684\u503c\u66b4\u529b\u8ba1\u7b97\u3002\n\n\u9884\u5904\u7406\u7684\u5730\u65b9\u53ef\u4ee5\u7528 $lower\\_bound$ \u51fd\u6570\u5148\u627e\u5230\u91cc\u6bcf\u4e2a\u6570\u6700\u8fd1\u7684\u8d28\u6570\uff0c\u7136\u540e\u524d\u7f00\u548c\u5904\u7406\u3002\n\n\u590d\u6742\u5ea6 $\\operatorname{O}(n\\log n+160\\times q)$\u3002\n\n\uff08\u5176\u5b9e\u8fd9\u79cd\u505a\u6cd5\u7684\u590d\u6742\u5ea6\u6bd4\u6b63\u89e3\u9ad8\u4e86\u597d\u591a\uff0c\u4f46\u662f\u5373\u4f7f\u5361\u5e38\u8fd8\u662f\u80fd\u8fc7\uff09\n\n```cpp\n#include <bits/stdc++.h>\n#define rg register\n#define il inline\n#define ll long long\nusing namespace std; \ninline int read(){\n\tregister int x=0;\n\tregister bool f=0;\n\tregister char c=getchar();\n\twhile(c<'0'||c>'9'){\n\t\tif(c=='-') f=1;\n\t\tc=getchar();\n\t}\n\twhile(c>='0'&&c<='9'){\n\t\tx=(x<<3)+(x<<1)+c-48;\n\t\tc=getchar();\n\t}\n\treturn f?-x:x;\n}\nil void write(rg ll x){\n    if(x<0) putchar('-'), x=-x;\n    if(x>=10) write(x/10);\n    putchar('0'+x%10);\n}\nint n,q,T;\nconst int maxn=10000020;\nll ans;\nint a[100010];\nint pri[1000000];\nbool vis[maxn];\nll cst[200];\nll nxt[200];\nll tomx[200];\nll tomxp[200];\nint cnt[1000000];\nint mx_p,mx;\nil void prime(){\n    for(rg int i=2;i<=maxn;i++) {\n        if(!vis[i]){\n            pri[++pri[0]]=i;\n        }\n        for(rg int j=1;j<=pri[0] && i*pri[j]<=maxn;j++) {\n            vis[i*pri[j]]=1;\n            if (i%pri[j]==0) {\n                break;\n            }\n        }\n    }\n}\nsigned main(){\n\tprime();\n\tn=read();q=read();T=read();\n\tfor(rg int i=1;i<=n;i++){\n\t\ta[i]=read();\n\t\tmx=max(a[i],mx);\n\t}\n\tmx_p=lower_bound(pri+1,pri+pri[0]+1,mx)-pri;\n\tfor(rg int i=1;i<=n;i++){\n\t\tint now=lower_bound(pri+1,pri+pri[0]+1,a[i])-pri;\n\t\tif(now<mx_p){\n\t\t\tnxt[pri[now]-a[i]]++;\n\t\t\tcnt[now]++;\n\t\t\ttomx[mx-pri[mx_p-1]]++;\n\t\t\ttomxp[pri[mx_p]-pri[mx_p-1]]++;\n\t\t}\n\t\telse{\n\t\t\ttomx[mx-a[i]]++;\n\t\t\ttomxp[pri[mx_p]-a[i]]++;\n\t\t}\n\t}\n\t\n\tfor(rg int i=1;i<mx_p-1;i++){\n\t\tnxt[pri[i+1]-pri[i]]+=cnt[i];\n\t\tcnt[i+1]+=cnt[i];\n\t}\n//\tfor(int i=1;i<=10;i++){\n//\t\tcerr<<nxt[i]<<\" \"<<cnt[i]<<\" \"<<tomx[i]<<\" \"<<tomxp[i]<<endl;\n//\t}\n\tfor(rg int _=1;_<=q;_++){\n\t\tll c1=read(),c2=read();\n\t\tif(T) c1^=ans,c2^=ans;\n\t\tfor(int i=1;i<=160;i++){\n\t\t\tcst[i]=min(i*c1,c2);\n\t\t}\n\t\tans=0;\n\t\tfor(int i=1;i<=160;i++){\n\t\t\tans+=nxt[i]*cst[i];\n\t\t}\n\t\tll mx1=0,mx2=0;\n\t\tfor(int i=1;i<=160;i++){\n\t\t\tmx1+=tomx[i]*c1*i;\n\t\t\tmx2+=tomxp[i]*cst[i];\n\t\t}\n\t\tans+=min(mx1,mx2);\n\t\twrite(ans);\n\t\tans%=(1<<17);puts(\"\");\n\t}\n\treturn 0;\n}\n```\n\u8868\u793a\u6ca1\u770b\u61c2stdqaq",
        "postTime": 1582016059,
        "uid": 120074,
        "name": "BFqwq",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P6104 \u3010[EER2]\u76f8\u540c\u7684\u6570\u5b57\u3011"
    },
    {
        "content": "\u7adf\u7136\u88ab T3 \u7684\u8d85\u77edDP\u540a\u8d77\u6765\u6253\uff0c\u8c03\u4e86\u90a3\u4e48\u4e45 qwq\uff0c\u76f8\u6bd4\u4e4b\u4e0b\uff0cT4 \u8fd8\u662f\u7b80\u5355\u5f88\u591a\u7684\n\n~~\u7136\u800c\u6211\u8fd8\u662f\u9519\u4e86\u90a3\u4e48\u591a\u6b21~~\n\n\u601d\u8def\u5e94\u8be5\u5f88\u5bb9\u6613\u60f3\u5230\uff0c\u5c31\u662f\u8ba9 $a_i$ \u90fd\u5f80\u4e0b\u4e00\u4e2a\u8d28\u6570\u8df3\n\n\u5f88\u663e\u7136\uff0c\u4ece\u4e00\u4e2a\u8d28\u6570\uff08\u4e5f\u6709\u53ef\u80fd $a_i$ \u5927\u4e8e\u8fd9\u4e2a\u8d28\u6570\uff0c\u4f46\u90fd\u662f\u76f8\u540c\u7684\uff09\u8df3\u5230\u4e0b\u4e00\u4e2a\u8981\u4e48\u4e00\u4e2a\u4e00\u4e2a\u52a0\uff0c\u8981\u4e48\u76f4\u63a5\u8df3\u4e0a\u53bb\u3002\n\n\u5047\u5982\u8df3\u4e00\u4f1a\u513f\u518d\u5f80\u4e0a\u76f4\u63a5\u8df3\u663e\u7136\u6ca1\u6709\u76f4\u63a5\u8df3\u82b1\u8d39\u5c11\n\n\u4f46\u6ce8\u610f\uff0c\u6700\u540e\u8981\u8003\u8651\u662f\u90fd\u8df3\u5230\u6700\u5927\u7684\u6570\u8fd8\u662f\u4e0b\u4e00\u4e2a\u8d28\u6570\uff0c\u5728\u8fd9\u91cc\u8981\u5206\u7c7b\u8ba8\u8bba\n\n\u5f88\u663e\u7136\uff0c\u76f4\u63a5\u8df3\u660e\u663e\u4f1a\u8d85\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u8be2\u95ee\u524d\u5904\u7406\u4ece\u8fd9\u4e2a\u8d28\u6570\u4e0e\u4e0b\u4e00\u4e2a\u8d28\u6570\u7684\u5dee\uff0c\u7136\u540e\u770b\u6709\u591a\u5c11\u4e2a\uff0c\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u5373\u53ef\uff08\u61d2\u5f97\u60f3\u5f00\u4e86 4 \u4e2a\uff09\n\n\u5177\u4f53\u5b9e\u73b0\u770b\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<cctype>\n\n// \u2193 \u8bb0\u5f97\u5f00 long long\n#define int long long\n#define mod 131072\n#define maxn 111111\n#define maxp 1011101\n#define maxc 1111111\n#define maxN 10001111\n#define lowbit(k) (k&(-k))\n//MaxN \u4e5f\u8981\u7a0d\u5fae\u5927\u4e8e 1e7\uff0cmaxc \u6253\u8868\u5427\uff0c\u770b\u770b\u8d28\u6570\u95f4\u8ddd\u6700\u5927\u591a\u5c11\uff0c\u8fd9\u91cc\u61d2\u5f97\u7b97\n\ninline int read(){\n\tint r=0,f=0;\n\tchar c;\n\twhile(!isdigit(c=getchar()))f|=(c=='-');\n\twhile(isdigit(c))r=(r<<1)+(r<<3)+(c^48),c=getchar();\n\treturn f?-r:r;\n}\n\ninline int max(int a,int b){\n\treturn a>b?a:b;\n}\n\ninline int min(int a,int b){\n\treturn a<b?a:b;\n}\n\nint n,q,t,sum,Max,Maxp,s_p,app[maxp],p[maxp],a[maxn],b[maxn];\n\nbool n_p[maxN];\n\nstruct C{\n\t\n\tint c[maxc+1000];\n\t\n\tinline void add(int x,int k){\n\t\twhile(x<=maxc){\n\t\t\tc[x]+=k;\n\t\t\tx+=lowbit(x);\n\t\t}\n\t}\n\t\n\tinline int sum(int x){\n\t\tint s=0;\n\t\twhile(x){\n\t\t\ts+=c[x];\n\t\t\tx-=lowbit(x);\n\t\t}\n\t\treturn s;\n\t}\n\t\n}c,cc,ccc,cccc;//\u5177\u4f53\u770bmain\u51fd\u6570\n//P.S. ccc \u548c cccc \u90fd\u662f\u5904\u7406\u7684\u6700\u540e\uff0c\u4e0d\u8df3\u6700\u5927\u6570\uff0c\u800c\u662f\u8df3\u5411\u4e0b\u4e00\u4e2a\u8d28\u6570\nlong long ans,c1,c2;\n\ninline void init(){//\u7ebf\u6027\u7b5b\n\tn=maxN-11;//\u4e00\u5b9a\u8981\u6709\u4e00\u4e2a\u5927\u4e8e\u7b49\u4e8e 1e7 \u7684\u8d28\u6570\uff0c\u56e0\u4e3a\u6700\u5927\u7684\u6570\u4e5f\u53ef\u80fd\u5f80\u4e0a\u8df3\n\tfor(int i=2;i<=n;i++){\n\t\tif(!n_p[i])p[++s_p]=i;\n\t\tfor(int j=1;j<=s_p&&p[j]<=n/i;j++){\n\t\t\tn_p[i*p[j]]=1;\n\t\t\tif(!(i%p[j]))break;\n\t\t}\n\t}\n}\n\ninline int find(int x){\n\tint l=0,r=s_p+1;\n\twhile(l+1<r){\n\t\tint mid=(l+r)>>1;\n\t\tif(p[mid]<=x)l=mid;\n\t\telse r=mid;\n\t}\n\treturn l;\n}\n\ninline void work(){//\u6bd4 c2/c1 \u5927\u7684\u8ddd\u79bb\u90fd\u4e0d\u5982\u4e00\u6b21\u8df3\uff0c\u5e94\u8be5\u5f88\u597d\u7b97\u51fa\u6765\u5427\n\tc1=read()^(t*(ans%mod)),c2=read()^(t*(ans%mod));\n\tint s=c.sum(c2/c1),ss=cc.sum(c2/c1),sss=ccc.sum(c2/c1),ssss=cccc.sum(c2/c1);\n\tans=1ll*s*c1+1ll*(cc.sum(maxc)-ss)*c2;\n    // \u2191 \u80af\u5b9a\u90fd\u8981\u8df3\u5230 p[Maxp]\uff0c\u4e0d\u7528\u5206\u7c7b\u8ba8\u8bba\n\tans+=min(1ll*sum*c1,1ll*sss*c1+1ll*(cccc.sum(maxc)-ssss)*c2);\n   \t// \u2191 \u5206\u7c7b\u8ba8\u8bba\u662f\u90fd\u8df3\u5230\u6700\u5927\u7684\u6570\u8fd8\u662f\u90fd\u8df3\u5230 p[Maxp+1]\n\tprintf(\"%lld\\n\",ans);\n}\n\nsigned main(){\n\tinit();\n\tn=read(),q=read(),t=read();\n\tfor(int i=1;i<=n;i++){\n\t\ta[i]=read();\n\t\tb[i]=find(a[i]);//\u5c0f\u4e8e\u7b49\u4e8e a[i] \u7684\u6700\u5927\u8d28\u6570\n\t\tMax=max(Max,a[i]);\n\t\tMaxp=max(Maxp,b[i]);\n\t\tapp[b[i]]++;//\u5927\u4e8e\u7b49\u4e8e p[b[i]] \u5c0f\u4e8e p[b[i]+1] \u7684\u6570\u591a\u4e86\u4e00\u4e2a\n\t}\n\tfor(int i=1;i<=n;i++){//\u4e3a\u4e86\u9632\u6b62 a[i] \u4e0d\u662f\u8d28\u6570\uff0c\u7b2c\u4e00\u6b21\u5f80\u4e0a\u8df3\u8981\u6ce8\u610f\n\t\tif(b[i]<Maxp){//\u5c0f\u4e8ep[Maxp]\u624d\u7b97\uff0c\u56e0\u4e3a\u7b49\u4e0b\u8981\u5bf9\u6700\u540e\u7684\u4e24\u79cd\u8df3\u6cd5\u53d6\u5c0f\n\t\t\tc.add(p[b[i]+1]-a[i],p[b[i]+1]-a[i]);//\u8fd9\u662f\u7528\u6765\u8ba1\u7b97\u4e00\u6b21\u4e00\u6b21\u8df3\u7684\n\t\t\tcc.add(p[b[i]+1]-a[i],1);//\u8fd9\u662f\u7528\u6765\u8ba1\u7b97\u76f4\u63a5\u8df3\u7684\n\t\t}\n\t\tccc.add(p[Maxp+1]-max(a[i],p[Maxp]),p[Maxp+1]-max(a[i],p[Maxp]));//\u4e00\u6b21\u4e00\u6b21\u8df3\n\t\tcccc.add(p[Maxp+1]-max(a[i],p[Maxp]),1);//\u76f4\u63a5\u8df3\n\t\tsum+=Max-max(a[i],p[Maxp]);//sum\u5904\u7406\u8df3\u6700\u5927\u6570\uff08\u80af\u5b9a\u5c31\u53ea\u80fd\u4e00\u6b21\u6b21\u8df3\u4e86\uff09\n\t}// \u2193 \u4e00\u6b21\u6027\u5904\u7406\u4ece p[i] \u5f80 p[i+1] \u8df3\uff08\u8bb0\u5f97\u4e58\u4e0a\u6709\u591a\u5c11\u4e2a\u9700\u8981\u8df3\uff09\n\tfor(int i=Maxp,gs=app[Maxp];i>=1;i--){\n\t\tgs+=app[i-1];//\u5927\u4e8e\u7b49\u4e8e p[i-1] \u5c0f\u4e8e p[i] \u7684\u4e0a\u4e00\u4e2a\u5faa\u73af\u5df2\u7ecf\u5904\u7406\u4e86\n\t\tc.add(p[i]-p[i-1],(p[i]-p[i-1])*(n-gs));\n\t\tcc.add(p[i]-p[i-1],n-gs);\n\t}\n\twhile(q--)work();\n\treturn 0;\n}\n```\n\n\n\u573a\u540eAK\u53ef\u8fd8\u884c QAQ\n\nP.S. \u597d\u5427\uff0c\u6211\u592a naive \u4e86\uff0c\u6ca1\u6709\u4fee\u6539\uff0c\u4e3a\u4ec0\u4e48\u8981\u7528\u6811\u72b6\u6570\u7ec4\uff0c\u666e\u901a\u524d\u7f00\u548c\u5c31\u53ef\u4ee5\u4e86\u554a QAQ\n\n\u7136\u800c\u6811\u72b6\u6570\u7ec4\u5e38\u6570\u7adf\u7136\u8fd9\u4e48\u5c0f ",
        "postTime": 1582021276,
        "uid": 71403,
        "name": "\u4e00\u53f6\u77e5\u79cb\u3002",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P6104 \u3010[EER2]\u76f8\u540c\u7684\u6570\u5b57\u3011"
    },
    {
        "content": "\u5148\u5c06\u5e8f\u5217 $a$ \u6392\u5e8f\uff0c\u90a3\u4e48\u6700\u540e\u53d8\u6210\u7684\u6570\u5b57\u53ea\u53ef\u80fd\u662f $a_n$ \u6216\u8005\u662f\u5927\u4e8e $a_n$ \u7684\u7b2c\u4e00\u4e2a\u8d28\u6570\u3002\n\n\u8bbe\u8df3\u5230\u5927\u4e8e\u8fd9\u4e2a\u6570\u7684\u7b2c\u4e00\u4e2a\u8d28\u6570\u662f\u4e00\u6b65\uff0c\u90a3\u4e48\u8003\u8651\u5f00\u4e00\u4e2a\u6876\u7ef4\u62a4\u6bcf\u79cd\u957f\u5ea6\u6240\u5bf9\u5e94\u7684\u6b65\u6570\uff0c\u8fd9\u4e2a\u6876\u5f88\u5c0f\u3002\n\n\u8be2\u95ee\u65f6\u5224\u65ad $c_2 / c_1$ \u7684\u5927\u5c0f\uff0c\u5c0f\u4e8e\u8fd9\u4e2a\u503c\u7684\u5c31\u66b4\u8df3\uff0c\u5927\u4e8e\u8fd9\u4e2a\u503c\u7684\u5c31\u7528 $c_2$ \u7684\u4ee3\u4ef7\u8df3\u3002\n\n\u7528\u524d\u7f00\u548c\u7ef4\u62a4\u5373\u53ef\u3002\u5f53\u7136\u5982\u679c\u6700\u540e\u4e00\u6b65\u662f\u8df3\u5230 $a_n$ \u7684\u8bdd\u5c31\u53ea\u80fd\u4e00\u6b65\u4e00\u6b65\u8df3\u3002\n\n\u5177\u4f53\u7684\u5b9e\u73b0\u7ec6\u8282\u89c1[\u4ee3\u7801](https://paste.ubuntu.com/p/qCHqW44SsB/)\u3002",
        "postTime": 1582208873,
        "uid": 46800,
        "name": "xgzc",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P6104 \u3010[EER2]\u76f8\u540c\u7684\u6570\u5b57\u3011"
    },
    {
        "content": "[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P6104)\n\n---\n# \u9898\u76ee\u5927\u610f\n\u6709$n$\u4e2a\u6570\uff0c\u53ef\u4ee5\u5728\u4e00\u4e2a\u5355\u4f4d\u65f6\u95f4\u5185\u7528$c1$\u7684\u82b1\u8d39\n\n\u4f7f$x$\u53d8\u4e3a$x+1$\uff0c\u7528$c2$\u7684\u82b1\u8d39\u4f7f$y$\u53d8\u4e3a$\\min_{y'\\in prime,y'>y}y'$\n\n\u6bcf\u6b21\u8be2\u95ee$c1,c2$\u90fd\u4f1a\u6539\u53d8\uff0c\u4f46\u662f\u539f\u6765\u7684$n$\u4e2a\u6570\u5728\u8be2\u95ee\u540e\u6062\u590d\u539f\u72b6\uff0c\n\n\u95ee\u4f7f$n$\u4e2a\u6570\u76f8\u540c\u7684\u6700\u5c0f\u82b1\u8d39\uff08\u5f3a\u5236\u5728\u7ebf\uff09\n\n---\n# \u5206\u6790\n\u8003\u573a\u7684\u65f6\u5019\u60f3\u5230\u4f2a50\u5206\u7684\u505a\u6cd5\uff0c\u4f46\u662f\u88ab\u6211\u5f04\u6210\u4e8610\u5206\u7684\u66b4\u529b\n\n\uff08\u7136\u800c\u5c31\u662f\u66b4\u529b\uff09\uff0c\u53ea\u8981\u8bb0\u5fc6\u5316\u7b54\u6848\u5e94\u8be5\u80fd\u591f\u5361\u5e38\u5361\u5230\u4e94\u5341\u5206\n\n\u9996\u5148\u8003\u573a\u7684\u65f6\u5019\u60f3\u5230\u7b2c\u4e00\u6761\u6027\u8d28\uff1a\u8fd9$n$\u4e2a\u6570\u8981\u4e48\u53d8\u6210$\\max_{1\\leq i\\leq m}a_i$\uff0c\n\n\u8981\u4e48\u53d8\u6210$\\max_{1\\leq i\\leq m}a_i'$(\u6ce8\u610f\u90a3\u4e2a'\u548c\u4e4b\u524d\u7684\u5b9a\u4e49\u76f8\u540c)\n\n\u9996\u5148\u7ebf\u6027\u7b5b\u6240\u6709\u8303\u56f4\u91cc\u7684\u8d28\u6570\uff08$\\approx 6.6\\times 10^4$\u4e2a\uff09\u3002\n\n\u7136\u540e\u9884\u5904\u7406\u6bcf\u4e2a\u6570$x$\u7684$x'$\uff0c\u8be2\u95ee\u65f6\u8df3\u5230\u4e0b\u4e00\u4e2a\u8d28\u6570\n\n\uff08\u56e0\u4e3a\u4e00\u4e2a\u4e00\u4e2a\u8df3\u603b\u4f1a\u8df3\u5230\u4e0b\u4e00\u4e2a\u8d28\u6570\uff09\n\n~~\u66b4\u529b\u8df3\uff0c\u7ec8\u4e8e\u62ff\u5230\u4e8610\u5206\uff0c\u8fd8\u8dd1\u5f97\u5f88\u6162~~\n\n\u8003\u540e\u8be2\u95eejulao\u89e3\u6cd5\uff0c\u9884\u5904\u7406\u51fa\u8df3\u5230$\\max$\u6216$\\max'$\u7684\u6bcf\u79cd\u957f\u5ea6\u9700\u8981\u8df3\u7684\u6b21\u6570\uff0c\n\n\u7136\u540e\u89e3\u4e0d\u7b49\u5f0f$len\\times c1<c2$\n\u90a3\u4e48\u5f53$len<\\lfloor\\frac{c2}{c1}\\rfloor$\u65f6\u9009\u62e9\u8df3\u4e00\u6b65(\u82b1$c1$)\uff0c\u5426\u5219\u8df3\u5230\u8d28\u6570\uff08\u82b1$c2$\uff09\uff0c\n\n\u8fd9\u4e2a\u53ef\u4ee5\u7528\u524d\u7f00\u548c$O(1)$\u5b9e\u73b0\uff0c\u6240\u4ee5\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u5e94\u8be5\u662f\n\n$$O(\\max_{1\\leq i\\leq n}a_i+n+q)$$\n\n\u74f6\u9888\u4e3b\u8981\u662f\u8be2\u95ee\u548c\u9884\u5904\u7406\n\n\u7b49\u7b49\uff0c\u9884\u5904\u7406\u600e\u4e48\u5f04\uff1f~~\u4ee3\u7801\u53c8\u957f\u53c8\u4e11~~\n\n\u5206\u6210\u4e24\u79cd\u60c5\u51b5\uff0c\u8fd9\u91cc\u4ee5\u9884\u5904\u7406$a_j$\u5230$\\max$\u4e3a\u4f8b\uff0c\n\n\u9996\u5148\u628a\u5934\u5c3e\u957f\u5ea6\u5355\u72ec\u52a0\u5165\u7b54\u6848\uff0c\u7136\u540e\u4e2d\u95f4\u90e8\u5206\u8003\u8651\u5dee\u5206\uff0c\u5c31\u662f\u5728\u5f00\u5934\u52a01\uff0c\u7ed3\u5c3e\u7684\u4e0b\u4e00\u4e2a\u51cf1\uff0c\u7136\u540e\u5dee\u5206\u6570\u7ec4\u6700\u540e\u8dd1\u524d\u7f00\u548c\n\n\u662f\u4e0d\u662f\u542c\u8d77\u6765\u5f88\u7b80\u5355\uff0c\u6309\u7167julao\u7684\u89e3\u6cd5\uff0c\u6211\u6210\u529f\u5730WA\u4e86\n\n\u4e3b\u8981\u6709\u4e24\u4e2a\u7ec6\u8282\u95ee\u9898\n\n1. \u8df3\u4e00\u6b65\u9700\u8981\u8bb0\u5f55\u957f\u5ea6\uff0c\u6240\u4ee5\u4e0d\u4ec5\u8981\u8bb0\u5f55\u6b21\u6570\uff0c\u800c\u4e14\u8981\u8bb0\u5f55\u957f\u5ea6$\\times$\u6b21\u6570\n\n2. \u5bf9\u4e8e\u8df3\u5230$\\max$\u7684\u60c5\u51b5\u6709\u4e00\u6bb5\u662f\u4e0d\u80fd\u8ba1\u5165\u8df3\u5230\u8d28\u6570\u7684\uff08\u56e0\u4e3a\u8df3\u5230$\\max$\u4e0d\u4e00\u5b9a\u5230\u7684\u662f\u8d28\u6570\uff09\n\n\u6539\u5b8c\u4e4b\u540e\uff0c\u6210\u529f\u83b7\u5f97\u4e86\u4e00\u4efd\u5e38\u6570\u5de8\u5927\u7684\u6b63\u89e3\uff08\u8bb0\u5f97\u5f00$\\text {long long}$\uff09\n\n![AC\u63d0\u4ea4\u8bb0\u5f55](https://cdn.luogu.com.cn/upload/image_hosting/8gytq1f2.png)\n\n---\n# \u4ee3\u7801\n```cpp\n#include <cstdio>\n#include <cctype>\n#define rr register\nusing namespace std;\nconst int N=10001001,M=666666; int cnt,n,Q,Is_Last,mx,mx1,mx2;\nlong long sL1[201],sL2[201],xz1,sN1[201],sN2[201];\nint prime[M],v[N],nx[N],cf1[M],cf2[M],a[M/6];\ninline signed iut(){\n\trr int ans=0; rr char c=getchar();\n\twhile (!isdigit(c)) c=getchar();\n\twhile (isdigit(c)) ans=(ans<<3)+(ans<<1)+(c^48),c=getchar();\n\treturn ans;\n}\ninline void print(long long ans){\n\tif (ans>9) print(ans/10);\n\tputchar(ans%10+48);\n}\ninline signed max(int a,int b){return a>b?a:b;}\ninline void pro(int N){//\u7ebf\u6027\u7b5b\n\tfor (rr int i=2;i<=N;++i){\n\t\tif (!v[i]) prime[++cnt]=i,v[i]=cnt;\n\t\trr int t=N/i;\n\t\tfor (rr int j=1;prime[j]<=t;++j){\n\t\t\tv[i*prime[j]]=j;\n\t\t\tif (i%prime[j]==0) break;\n\t    }\n\t}\n\tfor (rr int i=N-1,j=cnt;i;--i){\n\t\tnx[i]=prime[j];\n\t\tif (i==prime[j-1]) --j;\n\t}\t\n}\nsigned main(){\n\tn=iut(),Q=iut(),Is_Last=iut();\n\tfor (rr int i=1;i<=n;++i) mx=max(mx,a[i]=iut());\n\tpro(mx+500),mx1=prime[v[nx[mx]]-1],mx2=nx[mx];\n   //1.x->mx1->mx 2.x->mx2\n\tfor (rr int i=1;i<=n;++i){\n     //\u4e0a\u9762\u4e00\u5768\u662f\u7b2c\u4e00\u79cd\u60c5\u51b5\n\t\tif (nx[a[i]]>mx&&mx!=a[i]){\n\t\t\tif (prime[v[mx]]==mx) sL1[mx-a[i]]+=mx-a[i],++sN1[mx-a[i]];\n\t\t\t    else xz1+=mx-a[i];//\u8fd9\u4e00\u6bb5\u4e0d\u80fd\u52a0\n\t\t}\n\t\telse if (mx!=a[i]){\n\t\t\t++sN1[nx[a[i]]-a[i]],sL1[nx[a[i]]-a[i]]+=nx[a[i]]-a[i];\n\t\t\tif (prime[v[mx]]==mx) sL1[mx-mx1]+=mx-mx1,++sN1[mx-mx1];\n\t\t\t    else xz1+=mx-mx1;\n\t\t\t++cf1[v[nx[a[i]]]],--cf1[v[mx1]];\n\t\t}\n    //----------------------\n\t\tsL2[nx[a[i]]-a[i]]+=nx[a[i]]-a[i],++sN2[nx[a[i]]-a[i]];\n\t\t++cf2[v[nx[a[i]]]],--cf2[v[mx2]];\n    //\u5dee\u5206\n\t}\n\tfor (rr int i=1;i<=cnt;++i) cf1[i]+=cf1[i-1],cf2[i]+=cf2[i-1];//\u524d\u7f00\u548c\n  //sL\u957f\u5ea6\u4e58\u6b21\u6570\u524d\u7f00\u548c\uff0csN\u6b21\u6570\u524d\u7f00\u548c\n\tfor (rr int i=1;i<cnt;++i)\n\t    sN1[prime[i+1]-prime[i]]+=cf1[i],sN2[prime[i+1]-prime[i]]+=cf2[i],\n\t    sL1[prime[i+1]-prime[i]]+=cf1[i]*(prime[i+1]-prime[i]),\n\t    sL2[prime[i+1]-prime[i]]+=cf2[i]*(prime[i+1]-prime[i]);\n\tfor (rr int i=1;i<=170;++i)\n\t    sL1[i]+=sL1[i-1],sL2[i]+=sL2[i-1],\n\t    sN1[i]+=sN1[i-1],sN2[i]+=sN2[i-1];\n\tfor (rr long long lans=0,c1,c2,c3;Q;--Q){\n\t\tlans%=131072,c1=iut(),c2=iut();\n\t\tif (Is_Last) c1^=lans,c2^=lans;\n\t\tlans=0,c3=c2/c1>160?160:c2/c1;//\u89e3\u4e0d\u7b49\u5f0f\n\t\trr long long s1=(sL1[c3]+xz1)*c1+(sN1[170]-sN1[c3])*c2,\n\t\t             s2=sL2[c3]*c1+(sN2[170]-sN2[c3])*c2;\n\t\tprint(lans=s1<s2?s1:s2),putchar(10);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1582094223,
        "uid": 37782,
        "name": "lemondinosaur",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6104 \u3010[EER2]\u76f8\u540c\u7684\u6570\u5b57\u3011"
    }
]
[
    {
        "content": "# P2973 [USACO10HOL]Driving Out the Piggies G\n## \u9898\u610f\n\u7ed9\u51fa\u4e00\u5f20$n$\u4e2a\u70b9\uff0c$m$\u6761\u8fb9\u7684\u65e0\u5411\u56fe\uff0c\u8282\u70b9$1$\u6709\u4e00\u4e2a\u70b8\u5f39\uff0c\u5728\u6bcf\u4e2a\u5355\u4f4d\u65f6\u95f4\u5185\uff0c\u6709$\\dfrac {p}{ q}$\u7684\u6982\u7387\u5728\u8fd9\u4e2a\u8282\u70b9\u70b8\u6389\uff0c\u6709$1-\\dfrac{p}q$\u7684\u6982\u7387\u968f\u673a\u9009\u62e9\u4e00\u6761\u51fa\u53bb\u7684\u8def\u5230\u5176\u4ed6\u7684\u8282\u70b9\u4e0a\uff0c\u53bb\u6bcf\u4e2a\u8282\u70b9\u7684\u6982\u7387\u76f8\u7b49\u3002\u95ee\u6700\u7ec8\u70b8\u5f39\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u7206\u70b8\u7684\u6982\u7387\u3002\n## \u9898\u89e3\n~~\u8003\u573a\u4e0a\u505a\u5230\u8fd9\u9053\u9898\uff0c\u4e00\u8138\u8499\u853d~~\n\n\u6211\u4eec\u770b\u4e00\u4e0b\u4e0b\u9762\u8fd9\u4e2a~~\u4e0e\u672c\u9898\u65e0\u5173~~\u4f8b\u5b50\uff1a\n\n> \u5c0f\u660e\u3001\u5c0f\u7ea2\u3001\u5c0f\u82b3\u5728\u901a\u8fc7\u624b\u5fc3\u624b\u80cc\u7684\u6e38\u620f\u6765\u51b3\u5b9a\u54ea\u4e24\u4e2a\u4eba\u5148\u51fa\u573a\uff0c\u82e5\u6709\u4e24\u4e2a\u4eba\u540c\u65f6\u51fa\u624b\u5fc3\u6216\u624b\u80cc\u90a3\u5c31\u8ba9\u90a3\u4e24\u4e2a\u4eba\u51fa\u573a\uff0c\u5426\u5219\u91cd\u590d\u6e38\u620f\u3002**\u95ee\uff1a\u5c0f\u660e\u4e0e\u5c0f\u7ea2\u5148\u51fa\u573a\u7684\u6982\u7387\u662f\u591a\u5c11\uff1f**\n\n>\u5f88\u5bb9\u6613\u5730\u6211\u4eec\u77e5\u9053\uff0c\u7b2c\u4e00\u5c40\u6709$\\dfrac 1 4$\u7684\u53ef\u80fd\u662f\u5c0f\u660e\u4e0e\u5c0f\u7ea2\u5148\u51fa\u573a\uff0c\u4e5f\u6709\u53ef\u80fd\u662f$\\dfrac14$\u7684\u6982\u7387\u91cd\u5f00\u4e00\u5c40\uff0c\u518d\u4e0b\u4e00\u5c40\u4e5f\u662f\u5982\u6b64\u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u8bbe\u5c0f\u660e\u4e0e\u5c0f\u7ea2\u5148\u51fa\u573a\u7684\u6982\u7387\u4e3a$x$\uff0c\u663e\u7136\uff1a\n$$x=\\frac14+\\frac14x$$\n\n\n\u90a3\u4e48\u8fd9\u4e24\u9898\u6709\u4ec0\u4e48\u76f8\u540c\u70b9\u5462\uff1f\u7531\u4e8e\u4e24\u9898\u90fd\u6ca1\u6709\u9650\u5236\u6b21\u6570\uff0c\u56e0\u6b64\u6211\u4eec\u65e0\u6cd5\u901a\u8fc7\u6709\u9650\u6b21\u4fbf\u5229\u5f97\u5230\u7b54\u6848\u3002\u90a3\u6211\u4eec\u5c31\u6839\u636e\u4e0a\u4e00\u9898\u7684\u65b9\u6cd5\uff1a\u8bbe\u672a\u77e5\u6570\n\n\u6211\u4eec\u5047\u8bbe\u5230\u7b2c$i$\u4e2a\u70b9\u7684\u6982\u7387\u4e3a$x_i$\uff0c\u5165\u5ea6\u4e3a$d_i$\uff0c\u90a3\u4e48\u8003\u8651\u5176\u662f\u70b8\u5f39\u53ef\u4ee5\u4ece\u54ea\u91cc\u6765\uff1a\n\n- \u5982\u679c\u8fd9\u4e2a\u70b9\u662f$1$\u53f7\u70b9\uff0c\u90a3\u4e48\u5176\u6982\u7387\u662f\u4e00\u5f00\u59cb\u7684\u70b8\u5f39\u7206\u70b8\u6216\u8005\u662f\u4e0e\u5b83\u76f8\u8fde\u7684\u70b9\u7684\u5982\u679c\u4e0d\u7206\u70b8\u5c31\u4f1a\u70b8\u5f39\u5c31\u6709\u53ef\u80fd\u8f6c\u4e00\u5230\u8fd9\u4e2a\u70b9\uff0c\u5373\uff1a\n$$x_1=\\dfrac pq+\\sum_{(1,j)\\in E}x_j \\times (1-\\dfrac p q)\\times\\dfrac 1 d_j$$\n\n- \u5982\u679c\u8fd9\u4e2a\u70b9\u662f\u5176\u4ed6\u70b9\uff0c\u90a3\u5c31\u53ea\u80fd\u4ece\u76f8\u90bb\u7684\u70b9\u8f6c\u79fb\u8fc7\u6765\n$$x_i=\\sum_{(i,j)\\in E}x_j \\times (1-\\dfrac p q)\\times\\dfrac 1 d_j$$\n\n\u5f0f\u4e2d$p$\u3001$q$\u3001$d$\u5747\u4e3a\u5e38\u6570\uff0c\u56e0\u6b64\u6240\u6709\u7684\u67ff\u5b50\u53ef\u4ee5\u7ec4\u6210\u4e00\u4e2a$n$\u5143\u4e00\u6b21\u65b9\u7a0b\u7ec4\u7136\u540e\u5c31\u5230\u4e86\u6211\u4eec\u559c\u95fb\u4e50\u89c1\u7684~~\u624b\u89e3300\u5143\u65b9\u7a0b~~\u9ad8\u65af\u6d88\u5143\u7684\u8fc7\u7a0b\u4e86\n\n```cpp\n#include<bits/stdc++.h> \n#define maxn 310\n#define eps (1e-6)\nusing namespace std;\nint n,m,p,q,x,y;\nint f[310][310];\nint in[310];\ndouble a[maxn][maxn];\nvoid gauss_jordan(){\n\tfor(int i=1;i<=n;++i){\n\t\tint r=i;\n\t\tfor(int j=i+1;j<=n;++j)\n\t\t\tif(fabs(a[r][i])<fabs(a[j][i]))\n\t\t\t\tr=j;\n\t\tif(r!=i)\n\t\t\tfor(int j=1;j<=n+1;++j)\n\t\t\tswap(a[i][j],a[r][j]);\n\t\t\tfor(int j=1;j<=n;++j)if(j!=i){\n\t\t \t\tdouble tmp=a[j][i]/a[i][i];\n\t\t \t\tfor(int k=i+1;k<=n+1;++k)\n\t   \t\t   \t\ta[j][k]-=a[i][k]*tmp;\n\t\t\t}\n   \t}\n\tfor(int i=1;i<=n;++i)\n\t\ta[i][n+1]/=a[i][i];\n}\nint main(){\n\t//freopen(\"dotp.in\",\"r\",stdin);\n\t//freopen(\"dotp.out\",\"w\",stdout);\n\tscanf(\"%d%d%d%d\",&n,&m,&p,&q);\n\tfor(int i=1;i<=m;i++){\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tf[x][y]=f[y][x]=true;\n\t\tin[x]++;in[y]++;\n\t}\n\ta[1][n+1]=1.0*p/q;\n\tfor(int i=1;i<=n;i++){\n\t\ta[i][i]=1;\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tif(f[i][j])\n\t\t\t\ta[i][j]=-(1-(double)p/q)/in[j];\n\t}\n\tgauss_jordan();\n\tfor(int i=1;i<=n;i++)\n\t\tprintf(\"%.9lf\\n\",a[i][n+1]);\n\treturn 0;\n}\n```",
        "postTime": 1595915669,
        "uid": 174304,
        "name": "jun\u5934\u5409\u5409",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P2973 \u3010[USACO10HOL]Driving Out the Piggies G\u3011"
    },
    {
        "content": "[$$\\Large\\texttt{My Blog}$$](https://hydingsy.github.io/articles/problem-Luogu-2973-Dotp/)\n\n---\n\n## Description\n\n> \u9898\u76ee\u94fe\u63a5\uff1a[Luogu 2973](https://www.luogu.org/problemnew/show/P2973)\n\n\u6709\u4e00\u4e2a $n$ \u4e2a\u70b9 $m$ \u6761\u8fb9\u7684\u65e0\u5411\u56fe\uff0c\u8282\u70b9 $1$ \u6709\u4e00\u4e2a\u70b8\u5f39\uff0c\u5728\u6bcf\u4e2a\u5355\u4f4d\u65f6\u95f4\u5185\uff0c\u8fd9\u4e2a\u70b8\u5f39\u6709 $\\frac{P}{Q}$ \u7684\u6982\u7387\u5728\u8fd9\u4e2a\u8282\u70b9\u70b8\u6389\uff0c\u6709 $1-\\frac{P}{Q}$ \u7684\u6982\u7387\u7b49\u6982\u7387\u9009\u62e9\u4e00\u6761\u4e0e\u5f53\u524d\u8282\u70b9\u76f8\u8fde\u7684\u8fb9\u5230\u5176\u4ed6\u7684\u8282\u70b9\u4e0a\u3002\u6c42\u70b8\u5f39\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u7206\u70b8\u7684\u6982\u7387\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$2\\le n\\le 300$\uff0c$1\\le m\\le 44850$\uff0c$1\\le P,Q\\le 10^6$\n\n------\n\n## Solution\n\n\u5f88\u663e\u7136\uff0c\u5982\u679c\u6211\u4eec\u8bbe\u7b2c $i$ \u4e2a\u70b9\u7684\u671f\u671b\u7ecf\u8fc7\u6b21\u6570\u4e3a $f_i$\uff0c\u90a3\u4e48\u7b2c $i$ \u4e2a\u70b9\u7684\u7206\u70b8\u6982\u7387\u4e3a $f_i\\times\\frac{P}{Q}$\u3002\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa\u8fd9\u4e2a $f_i$ \u5373\u53ef\u3002\n\n\u5bf9\u4e8e $f_i$ \u6211\u4eec\u6709\u5982\u4e0b\u5173\u7cfb\u5f0f\uff1a\n$$f_u=\\begin{cases}1& i=1 \\\\\\sum_{(u,v)\\in E} (1-\\frac{P}{Q})\\times \\frac{f_v}{deg_v} & \\text{otherwise}\\end{cases}$$\n\u5176\u4e2d $deg_i$ \u8868\u793a\u7b2c $i$ \u4e2a\u70b9\u7684\u5ea6\u6570\u3002\u8fd9\u4e2a\u5f0f\u5b50\u7684\u542b\u4e49\u4e3a\uff1a\u5f53\u5230\u8fbe $u$ \u65f6\uff0c\u5f53\u4e14\u4ec5\u5f53\u5728 $v$ \u7684\u4f4d\u7f6e\u4e0d\u7206\u70b8\u5e76\u4e14\u6709 $\\frac{1}{deg_v}$ \u7684\u6982\u7387\u4ece $v$ \u8d70\u5230 $u$ \u7684\u4f4d\u7f6e\u3002\n\n\u6211\u4eec\u76f4\u63a5\u9ad8\u65af\u6c42\u548c\u4e00\u6ce2\u5c31\u597d\u4e86\u3002\n\n**\u65f6\u95f4\u590d\u6742\u5ea6**\uff1a$O(n^3)$\n\n------\n\n## Code\n\n```cpp\n#include <cstdio>\n#include <cmath>\n#include <algorithm>\n\nconst int N=305;\nint n,m,p,q,e[N][N],deg[N];\ndouble a[N][N],b[N],x[N];\n\nvoid Gauss(int n) {\n\tfor(int i=1;i<=n;++i) {\n\t\tint p=i;\n\t\tfor(int k=i+1;k<=n;++k) if(fabs(a[k][i])>fabs(a[p][i])) p=k;\n\t\tif(i!=p) std::swap(a[i],a[p]),std::swap(b[i],b[p]);\n\t\tfor(int k=i+1;k<=n;++k) {\n\t\t\tdouble d=a[k][i]/a[i][i];\n\t\t\tb[k]-=d*b[i];\n\t\t\tfor(int j=i;j<=n;++j) a[k][j]-=d*a[i][j];\n\t\t}\n\t}\n\tfor(int i=n;i>=1;--i) {\n\t\tfor(int j=i+1;j<=n;++j) b[i]-=x[j]*a[i][j];\n\t\tx[i]=b[i]/a[i][i];\n\t}\n}\nint main() {\n\tscanf(\"%d%d%d%d\",&n,&m,&p,&q);\n\tdouble P=1.0*p/q;\n\twhile(m--) {\n\t\tint u,v;\n\t\tscanf(\"%d%d\",&u,&v);\n\t\te[u][v]=e[v][u]=1,++deg[u],++deg[v];\n\t}\n\tfor(int i=1;i<=n;++i) {\n\t\ta[i][i]=1.0;\n\t\tfor(int j=1;j<=n;++j) {\n\t\t\tif(e[i][j]) a[i][j]-=(1.0-P)/deg[j];\n\t\t}\n\t}\n\tb[1]=1.0;\n\tGauss(n);\n\tfor(int i=1;i<=n;++i) printf(\"%.9lf\\n\",x[i]*P);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1549595323,
        "uid": 49725,
        "name": "Siyuan",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2973 \u3010[USACO10HOL]\u8d76\u5c0f\u732aDriving Out the Piggi\u2026\u3011"
    },
    {
        "content": "## [\u9898\u610f](https://blog.csdn.net/BeNoble_/article/details/79761509)\n\n\u4e00\u5f00\u59cb\u5728$1$\u6709\u4e2a\u70b8\u5f39,\u5728\u6bcf\u4e2a\u70b9\u6709$\\frac pq$\u7684\u6982\u7387\u7684\u7206\u70b8,\u5982\u679c\u4e0d\u7206\u70b8\u5219\u7b49\u6982\u7387\u5730\u8d70\u5411\u76f8\u90bb\u7684\u70b9\n\n---\n\n## \u9898\u89e3\n\n\u8bbe$f[u]$\u8868\u793a\u8d70\u5230$u$\u7684\u671f\u671b\u6b21\u6570,$d_u$\u8868\u793a\u70b9\u5ea6,\u521d\u59cb$f_1=1$\n\n\u56e0\u4e3a\u8981\u4e0d\u7206\u70b8\u624d\u80fd\u5f80\u4e0b\u8d70,\u90a3\u4e48\u6709\n\n$$f[u]=\\sum_{(u,v)\\in E}\\frac1{d_v}(1-\\frac pq)f[v]$$\n\n\u5728\u6bcf\u4e2a\u70b9\u7206\u70b8\u7684\u6982\u7387\u5c31\u662f\u671f\u671b\u8d70\u5230\u6bcf\u4e2a\u70b9\u7684\u6b21\u6570$\\times$\u7206\u70b8\u7684\u6982\u7387\n\n\u56e0\u4e3a\u72b6\u6001\u8f6c\u79fb\u6709\u73af,\u6240\u4ee5~~\u6309\u7167\u5957\u8def~~\u9ad8\u65af\u6d88\u5143\u5c31\u597d\u4e86\n\n\u6ce8\u610f\u8fd9\u9898\u5361\u7cbe\u5ea6,$\\epsilon\\lt10^{-13}$\u624d\u884c\n\n```\n#include<bits/stdc++.h>\n#define fp(i,a,b) for(register int i=a,I=b+1;i<I;++i)\n#define fd(i,a,b) for(register int i=a,I=b-1;i>I;--i)\n#define go(u) for(register int i=fi[u],v=e[i].to;i;v=e[i=e[i].nx].to)\n#define file(s) freopen(s\".in\",\"r\",stdin),freopen(s\".out\",\"w\",stdout)\ntemplate<class T>inline bool cmax(T&a,const T&b){return a<b?a=b,1:0;}\ntemplate<class T>inline bool cmin(T&a,const T&b){return a>b?a=b,1:0;}\nusing namespace std;\nconst int N=305;\nconst double eps=1e-15;\ntypedef int arr[N];\ntypedef double d;\nint n,m,p,q;arr dg,mp[N];d pr,ans[N],G[N][N];\ninline int cmp(const d&x){return fabs(x)<eps?0:(x<0?-1:1);}\ninline void Gauss(int n){\n    int mx;d t;\n    fp(i,1,n){mx=i;\n        fp(j,i,n)if(cmp(G[mx][i]-G[j][i]))mx=i;\n        if(mx^i)fp(j,i,n+1)swap(G[i][j],G[mx][j]);\n        fp(j,i+1,n)if(cmp(G[j][i])){\n            t=G[j][i]/G[i][i];\n            fp(k,i,n+1)G[j][k]-=t*G[i][k];\n        }\n    }\n    fd(i,n,1){\n        fp(j,i+1,n)G[i][n+1]-=ans[j]*G[i][j];\n        ans[i]=G[i][n+1]/G[i][i];\n    }\n}\nint main(){\n    #ifndef ONLINE_JUDGE\n        file(\"s\");\n    #endif\n    scanf(\"%d%d%d%d\",&n,&m,&p,&q);pr=1.0*p/q;\n    while(m--){\n        int u,v;scanf(\"%d%d\",&u,&v);\n        mp[u][v]=mp[v][u]=1;++dg[u],++dg[v];\n    }\n    fp(i,1,n)G[i][i]=1;\n    fp(i,1,n)fp(j,1,n)if(mp[i][j])\n        G[i][j]+=-(1.0-pr)/dg[j];\n    G[1][n+1]=1;Gauss(n);\n    fp(i,1,n)printf(\"%.9lf\\n\",ans[i]*pr);\nreturn 0;\n}\n```",
        "postTime": 1522405117,
        "uid": 20156,
        "name": "Kelin",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P2973 \u3010[USACO10HOL]\u8d76\u5c0f\u732aDriving Out the Piggi\u2026\u3011"
    },
    {
        "content": "### \u9898\u76ee\u94fe\u63a5\n\n[**P2973 Driving Out the Piggies G**](/problem/P2973)\n\n&nbsp;\n\n### \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u5f20\u65e0\u5411\u56fe\uff0c\u4fdd\u8bc1 $1$ \u53f7\u7ed3\u70b9\u4e00\u5b9a\u8fde\u63a5\u4e86\u81f3\u5c11 $1$ \u4e2a\u7ed3\u70b9\u3002\u73b0\u5728\u5728 $1$ \u53f7\u7ed3\u70b9\u653e\u4e00\u4e2a\u70b8\u5f39\uff0c\u6bcf\u4e2a\u5355\u4f4d\u65f6\u95f4\u5185\uff0c\u5b83\u6709 $\\frac pq$ \u7684\u6982\u7387\u5728\u5f53\u524d\u7ed3\u70b9\u7206\u70b8\uff0c\u6709 $1 - \\frac pq$ \u7684\u6982\u7387\u7b49\u6982\u7387\u968f\u673a\u9009\u62e9\u4e00\u6761\u51fa\u53bb\u7684\u8fb9\u8f6c\u79fb\u5230\u5176\u5b83\u7ed3\u70b9\u3002\u95ee\u70b8\u5f39\u6700\u7ec8\u5728\u6bcf\u4e2a\u7ed3\u70b9\u4e0a\u7206\u70b8\u7684\u6982\u7387\u3002\n\n&nbsp;\n\n### \u89e3\n\n\u5176\u5b83\u9898\u89e3\u63d0\u5230\uff0c**\u5728\u4e00\u4e2a\u70b9\u7206\u70b8\u7684\u6982\u7387 $=$ \u8fd9\u4e2a\u70b9\u7684\u671f\u671b\u7ecf\u8fc7\u6b21\u6570 $\\times$ \u6bcf\u6b21\u70b8\u5f39\u7206\u70b8\u7684\u6982\u7387\uff08\u5373 $\\frac pq$\uff09**\u3002\n\n\u8fd9\u6837\u611f\u6027\u7406\u89e3\u4e00\u4e0b\u53ef\u80fd\u80fd\u89c9\u5f97\u662f\u5bf9\u7684\u3002\u8fd9\u91cc\u5199\u4e00\u4e0b\u4e00\u4e2a\u7b80\u5355\u7684\uff0c\u4e0d\u90a3\u4e48\u504f\u611f\u6027\u7684\u89e3\u91ca\uff1a\n\n\u663e\u7136\u70b8\u5f39\u7206\u70b8\u7684\u6b21\u6570\u7684\u53d6\u503c\u53ea\u6709 $\\{0,1\\}$\u3002\u8fd9\u6837\u6211\u4eec\u53d1\u73b0\uff0c\u70b8\u5f39\u7684\u671f\u671b\u7206\u70b8\u6b21\u6570\u4e0e\u7206\u70b8\u6982\u7387 **\u5728\u6570\u503c\u4e0a\u76f8\u7b49**\u3002\u4ece\u800c\n\n\u5728\u4e00\u4e2a\u70b9\u7206\u70b8\u7684\u6982\u7387 $=$ \u671f\u671b\u5728\u8fd9\u4e2a\u70b9\u7206\u70b8\u7684\u6b21\u6570 $=$ \u671f\u671b\u7ecf\u8fc7\u8fd9\u4e2a\u70b9\u4e14\u5728\u8fd9\u4e2a\u70b9\u7206\u70b8\u7684\u6b21\u6570\n\n\u5f53\u968f\u673a\u53d8\u91cf $X$ \u548c $Y$ \u4e92\u76f8\u72ec\u7acb\u65f6\uff0c$E(XY) = EX \\cdot EY$\u3002\u5b9a\u4e49 $X$ \u4e3a\u7ecf\u8fc7\u8fd9\u4e2a\u70b9\u7684\u6b21\u6570\uff0c$Y$ \u4e3a\u6bcf\u6b21\u7206\u70b8\u6b21\u6570\uff08\u663e\u7136\u540c\u6837\u53d6\u503c $\\{0,1\\}$\uff09\uff0c\u5219\u6240\u6c42\u5373\n\n$$E(XY) = EX \\cdot EY$$\n\n\u540c\u6837\uff0c\u7531 $Y$ \u53d6\u503c $\\{0,1\\}$ \u77e5\uff0c$EY$ \u6570\u503c\u4e0a\u7b49\u4e8e\u6bcf\u6b21\u7206\u70b8\u6982\u7387\uff0c\u5373 $\\frac pq$\u3002\n\n\u6240\u4ee5\uff0c\u5728\u4e00\u4e2a\u70b9\u7206\u70b8\u7684\u6982\u7387\uff0c\u6570\u503c\u4e0a\u7b49\u4e8e\u5728\u8fd9\u4e2a\u70b9\u7684\u671f\u671b\u7206\u70b8\u6b21\u6570 $E(XY)$\uff0c\u6570\u503c\u4e0a\u7b49\u4e8e\u8fd9\u4e2a\u70b9\u7684\u671f\u671b\u7ecf\u8fc7\u6b21\u6570 $EX$ \u4e58\u6bcf\u6b21\u7206\u70b8\u6982\u7387 $\\frac pq$\u3002\n\n&nbsp;\n\n\u5982\u6709\u9519\u8bef\u6073\u8bf7\u6307\u6b63\uff0c\u5982\u6709\u5176\u5b83\u89c1\u89e3\u656c\u8bf7\u63d0\u51fa\u3002",
        "postTime": 1650336474,
        "uid": 118109,
        "name": "whhsteven",
        "ccfLevel": 7,
        "title": "P2973 Driving Out the Piggies G"
    },
    {
        "content": "\u6709\u5173\u6b64\u9898\u7684\u6570\u636e\u8303\u56f4\u53ea\u6709 $100$\uff0c\n\n\u800c\u4e14\u70b8\u5f39\u4f1a\u4ece\u9053\u8def\u4e0a\u79fb\u6765\u79fb\u53bb\uff0c\u53ef\u80fd\u4f1a\u53cd\u590d\u5f98\u5f8a\u5728\u4e00\u6761\u9053\u8def\u4e0a\uff0c\n\n\u8bbe $dp_i$ \u4ee3\u8868\u70b8\u5f39\u671f\u671b\u7ecf\u8fc7 $i$ \u53f7\u7ed3\u70b9\u7684\u6b21\u6570\uff0c\u90a3\u4e48\u5b83\u7684\u6765\u6e90\u6709\u4ee5\u4e0b\u4e24\u79cd\uff1a\n\n- \u9996\u4e00\u6b21\u88ab\u5b89\u88c5\u5728 $1$ \u53f7\u7ed3\u70b9\uff0c\u7ecf\u8fc7\u6b21\u6570\u52a0\u4e00\u3002\n\n- \u4ee5\u4e0d\u7206\u70b8\u6982\u7387\u9664\u4ee5\u51fa\u8fb9\u6570\u91cf\u7684\u6982\u7387\uff0c\u4ece\u4e0e\u5176\u76f8\u90bb\u7684\u4e00\u4e2a\u7ed3\u70b9\u4e0a\u79fb\u5230\u8fd9\u4e2a\u7ed3\u70b9\u3002\n\n\u8bbe $k_i$ \u4e3a $i$ \u53f7\u7ed3\u70b9\u7684\u51fa\u5ea6\uff0c\u90a3\u4e48\uff1a\n$$\ndp_i=[i=1]+\\sum\\limits_\\text{s\u4e0ei\u76f8\u8fde} (1-\\frac{p}{q})\\frac{1}{k_s}dp_s\n$$\n\n\u7531\u4e8e $dp$ \u65b9\u7a0b\u5177\u6709\u540e\u6548\u6027\uff0c\u518d\u52a0\u4e0a\u56fe\u5e76\u975e\u6811\u5f62\uff0c\u65e0\u6cd5\u4f7f\u7528\u6362\u6839\u6cd5\uff0c\u4e8e\u662f\u8003\u8651\u4f7f\u7528\u9ad8\u65af\u6d88\u5143\u6cd5\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3)$\u3002\n\n\u65b9\u7a0b\uff1a$dp_i-\\sum\\limits_\\text{s\u4e0ei\u76f8\u8fde} (1-\\frac{p}{q})\\frac{1}{k_s}dp_s=[i=1]$",
        "postTime": 1649036107,
        "uid": 472950,
        "name": "Mr_Terminator",
        "ccfLevel": 4,
        "title": "\u5976\u725b\u4e0e\u81ed\u86cb"
    },
    {
        "content": "# \u9898\u610f\n\u6709 N \u4e2a\u57ce\u5e02\uff0cM \u6761\u53cc\u5411\u9053\u8def\u7ec4\u6210\u7684\u5730\u56fe\uff0c\u57ce\u5e02\u6807\u53f7\u4e3a 1 \u5230 N\u3002\u201c\u897f\u74dc\u70b8\u5f39\u201d\u653e\u5728 1\n\u53f7\u57ce\u5e02\uff0c\u4fdd\u8bc1\u57ce\u5e02 1 \u81f3\u5c11\u8fde\u63a5\u7740\u4e00\u4e2a\u5176\u4ed6\u57ce\u5e02\u3002\u201c\u897f\u74dc\u70b8\u5f39\u201d\u6709 P/Q \u7684\u6982\u7387\u4f1a\u7206\u70b8\uff0c\u6bcf\n\u6b21\u8fdb\u5165\u5176\u5b83\u57ce\u5e02\u65f6\uff0c\u7206\u70b8\u7684\u6982\u7387\u76f8\u540c\u3002\u5982\u679c\u5b83\u6ca1\u6709\u7206\u70b8\uff0c\u5b83\u4f1a\u968f\u673a\u7684\u9009\u62e9\u4e00\u6761\u9053\u8def\u5230\u53e6\n\u4e00\u4e2a\u57ce\u5e02\u53bb\uff0c\u5bf9\u4e8e\u5f53\u524d\u57ce\u5e02\u6240\u8fde\u63a5\u7684\u6bcf\u4e00\u6761\u9053\u8def\u90fd\u6709\u76f8\u540c\u7684\u53ef\u80fd\u6027\u88ab\u9009\u4e2d\u3002\u5bf9\u4e8e\u7ed9\u5b9a\u7684\n\u5730\u56fe\uff0c\u6c42\u6bcf\u4e2a\u57ce\u5e02\u201c\u897f\u74dc\u70b8\u5f39\u201d\u7206\u70b8\u7684\u6982\u7387\u3002\n\n\n------------\n\n\n## \u6837\u4f8b\u89e3\u91ca\n\u6211\u4eec\u5c31\u6709\u4ee5\u4e0b\u53ef\u80fd\u7684\u8def\u5f84\uff08\u5176\u4e2d\u6700\u540e\u4e00\u9879\u662f\u7ed3\u675f\u57ce\u5e02\uff0c\u5373\u201c\u897f\u74dc\u70b8\u5f39\u201d\u7206\u70b8\u5e76\u6c61\u67d3\u8be5\u57ce\u5e02\uff09\n\n$1: 1$\n\n$2: 1-2$\n\n$3: 1-2-1$\n\n$4: 1-2-1-2$\n\n$5: 1-2-1-2-1$\n\n$......$\n\n\n\n------------\n\n\n\u4e3a\u4e86\u627e\u51fa\u201c\u897f\u74dc\u70b8\u5f39\u201d\u5728\u57ce\u5e02 1 \u7206\u70b8\u7684\u53ef\u80fd\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u7b2c $1\u30013\u30015......$\u79cd\u8def\u5f84\u51fa\u73b0\u7684\n\u6982\u7387\u52a0\u8d77\u6765\uff08\u5728\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\u5373\u628a\u6240\u6709\u5947\u6570\u8def\u5f84\u51fa\u73b0\u7684\u53ef\u80fd\u6027\u52a0\u8d77\u6765\uff09\u3002\n\n\u5bf9\u4e8e\u7b2c $k$ \u79cd\u8def\u5f84\u51fa\u73b0\u7684\u53ef\u80fd\u6027\u4e3a$(\\frac 1 2)^k$\uff1a\n\n\u5728\u7ecf\u8fc7\u524d $k-1 $\u6b21\u65f6\uff0c\u70b8\u5f39\u7edd\u5bf9\u4e0d\u4f1a\u5728\u57ce\u5e02 1\n\u7206\u70b8\uff08\u6bcf\u4e00\u6b21\u7684\u6982\u7387\u4e3a $1 \u2013 $ $\\frac 1 2 = \\frac 1 2$\uff09\uff0c\u7136\u540e\u6700\u540e\u5728\u57ce\u5e02 1 \u7206\u70b8\uff08\u6982\u7387\u4e3a $\\frac 1 2 $\uff09\u3002\n\n\u56e0\u6b64\uff0c\u5728\u57ce\u5e02 1 \u7206\u70b8\u7684\u53ef\u80fd\u6027\u5c31\u662f $\\frac 1 2 $ +  $(\\frac 1 2 )^3 $ + \n$($ $\\frac 1 2 )^5$+ ...... \uff0c\u628a\u8fd9\u4e9b\u6570\u90fd\u52a0\u8d77\u6765\u5c31\u7b49\u4e8e $\\frac 2 3$ \u7ea6\u4e3a $0.666666667$\n\n\u6240\u4ee5\u5728\u57ce\u5e02 2 \u7206\u70b8\u7684\u53ef\u80fd\u6027\u5c31\u662f $\\frac 1 3$ \u4e3a $0.333333333$\u3002\n\n\n\n------------\n\n\n# \u601d\u8def\u5206\u6790\n\n\n\u770b\u7740\u6837\u4f8b\u6211\u4eec\u53d1\u73b0\u6bcf\u4e2a\u70b9\u7684\u6982\u7387\u597d\u50cf\u4e0e\u5b83\u8fde\u51fa\u53bb\u7684\u70b9\u6709\u5173\u3002\n\n\u6211\u4eec\u8bbe$x_i$\u4e3a\u57ce\u5e02$i$\u7684\u6982\u7387\uff0c\u5219\u53ef\u4ee5\u5217\u51fa\u4e00\u7cfb\u5217\u7684\u65b9\u7a0b\n\n\u4ee5\u6837\u5386\u4e3a\u4f8b\n```cpp\n2 1 1 2 \n1 2 \n```\n$x_1$ $=$ $\\frac 1 2$ $+$ $\\frac 1 2$ $x_2$\n\n$x_2$ $=$ $\\frac 1 2$ $x_1$\n\n\u89e3\u5f97\n\n$x_1$ $=$ $\\frac 2 3$,\n$x_2$ $=$ $\\frac 1 3$\n\n\u4e0e\u7b54\u6848\u4e00\u6837\n\n\n------------\n\n\n\n\u518d\u4ee5\u4e0b\u9762\u6570\u636e\u4e3a\u4f8b\n```cpp\n3 2 1 3\n1 2\n3 2\n```\n\u56fe\u5f62\u5982\u4e0b\n\n$1-2-3$\n\n\u6211\u4eec\u5217\u51fa\u65b9\u7a0b\n\n$x_1$ $=$ $\\frac 1 3$ $+$ $\\frac 1 3$ $x_2$\n\n$x_2$ $=$ $\\frac 2 3$ $x_1$ $+$ $\\frac 2 3$ $x_3$\n\n$x_3$ $=$ $\\frac 1 3 $ $x_2$\n\n\n\u89e3\u5f97\n\n$x_1$ $=$ $\\frac 7 {15}$,\n$x_2$ $=$ $\\frac 2 5$,\n$x_3$ $=$ $\\frac 2 {15}$\n\n\n\u6211\u4eec\u53d1\u73b0\u6bcf\u4e2a\u70b9\u7684\u65b9\u7a0b$=$(1$-$\u6982\u7387\uff09$*$\u8fde\u51fa\u53bb\u7684\u70b9$/$\u5176\u5ea6\u6570\n\n\u7b2c\u4e00\u4e2a\u70b9\u518d\u52a0\u4e0a\u6982\u7387\n\n\n------------\n\n\n\u95ee\u9898\u5c31\u8f6c\u6362\u4e3a\u4e86\u89e3\u65b9\u7a0b\u7684\u95ee\u9898\n\n\u6211\u4eec\u5f88\u5feb\u5c31\u60f3\u5230\u4e86\u9ad8\u65af\u6d88\u5143\n\n\u89e3\u51fa\u7b54\u6848\u95ee\u9898\u5c31\u89e3\u51b3\u4e86\n\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ninline int read()\n{\n\tchar ch=getchar();int x=0;bool f=0;\n\tfor(;!isdigit(ch);ch=getchar())if(ch=='-')f=1;\n\tfor(;isdigit(ch);ch=getchar())x=(x<<1)+(x<<3)+(ch^48);\n\tif(f==1)x=-x;return x;\n}\nconst int maxn=200005;\nstruct edge\n{\n\tint v,w,nex;\n}e[maxn];\nint n,x,y,head[maxn],cnt=0,s[505],m;\ndouble ans[505],a[505][505],p,q;\nvoid add(int u,int v)\n{\n\te[++cnt].v=v;e[cnt].nex=head[u],head[u]=cnt;\n}\nint main()\n{\n//\tfreopen(\"dotp.in\",\"r\",stdin);\n//\tfreopen(\"dotp.out\",\"w\",stdout);\n\tn=read(),m=read();cin>>p>>q;\n\tfor(int i=1;i<=m;i++)\n\t\tx=read(),y=read(),add(x,y),add(y,x),s[x]++,s[y]++;\n\ta[1][n+1]=-p/q;\n\tfor(int i=1;i<=n;i++)//\u8f6c\u5316\u65b9\u7a0b\n\t{\n\t\ta[i][i]=-1;\n\t\tfor(int j=head[i];j;j=e[j].nex)\n\t\t{\n\t\t\tint v=e[j].v;\n\t\t\ta[i][v]=1.0*1/s[v]*(q-p)/q;\n\t\t}\n\t}\n\tfor(int i=1;i<=n;++i)//\u9ad8\u65af\u6d88\u5143\n\t{\n\t\tint max=i;\n\t\tfor(int j=i+1;j<=n;++j)\n\t\t{\n\t\t\tif(fabs(a[j][i])>fabs(a[max][i]))\n\t\t\t{\n\t\t\t\tmax=j;\n\t\t\t}\n\t\t}\n\t\tfor(int j=1;j<=n+1;++j)\n\t\t{\n\t\t\tswap(a[i][j],a[max][j]);\n\t\t}\n\t\tfor(int j=1;j<=n;++j)\n\t\t{\n\t\t\tif(j!=i)\n\t\t\t{\n\t\t\t\tdouble temp=a[j][i]/a[i][i];\n\t\t\t\tfor(int k=i+1;k<=n+1;++k)\n\t\t\t\t{\n\t\t\t\t\ta[j][k]-=a[i][k]*temp;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tprintf(\"%.9lf\\n\",a[i][n+1]/a[i][i]);\n\t}\n\treturn 0;\n}\n```\n\n\n\n\n\n\n\n",
        "postTime": 1595916224,
        "uid": 343748,
        "name": "louhao088",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2973 \u3010[USACO10HOL]Driving Out the Piggies G\u3011"
    },
    {
        "content": "\u672c\u6587\u540c\u6b65\u53d1\u8868\u5728\u6211\u7684[WordPress\u535a\u5ba2](https://www.encounter.cool/index.php/2021/03/19/luogu2973%ef%bc%88%e9%ab%98%e6%96%af%e6%b6%88%e5%85%83%ef%bc%89%e9%a2%98%e8%a7%a3/)\u3002\n### \u9898\u76ee\u5927\u610f\uff1a\n> \u4e00\u4e2a $n$ \u4e2a\u70b9 $m$ \u6761\u8fb9\u7684\u65e0\u5411\u56fe\uff0c\u8282\u70b9 $1$ \u6709\u4e00\u4e2a\u70b8\u5f39\uff0c\u5728\u6bcf\u4e2a\u5355\u4f4d\u65f6\u95f4\u5185\uff0c\u6709 $p/q$ \u7684\u6982\u7387\u5728\u8fd9\u4e2a\u8282\u70b9\u70b8\u6389\uff0c\u6709 $1-\\frac p q$ \u7684\u6982\u7387\u968f\u673a\u9009\u62e9\u4e00\u6761\u51fa\u53bb\u7684\u8def\u5230\u5176\u4ed6\u7684\u8282\u70b9\u4e0a\u3002\u95ee\u6700\u7ec8\u70b8\u5f39\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u7206\u70b8\u7684\u6982\u7387\u3002\n$ 1 \\le  n \\le 300$ \uff0c$1\\le m \\le 50000$ \u3002\n\n### \u6837\u4f8b\u5206\u6790\uff1a\n\n\u5bf9\u4e8e\u6837\u4f8b\uff1a\n> 2 1 1 2 \n\n> 1 2 \n\n\u5728 $1$ \u7684\u6982\u7387\uff1a $(1/2)^1+(1/2)^3+(1/2)^5......(1/2)^{2n+1}=2/3$\n\uff08\u5373\uff1a\u4e00\u5f00\u59cb\u5c31\u7206\u70b8\u6216\u8005 \"1->2->1\" \u7136\u540e\u7206\u70b8......\u4ee5\u6b64\u7c7b\u63a8\uff0c\u4e0b\u9762\u540c\u7406\uff09\n\u7ed3\u675f\u5728 $2$ \u7684\u6982\u7387\u540c\u7406\uff0c\u4e3a $(1/2)^2+(1/2)^4+......+(1/2)^{2n}=1/3$\n\n### \u601d\u8def\uff1a\n~~\u6258~~\u7fa4\u4f17\uff1a\u5206\u6790\u4e00\u5806\u770b\u8d77\u6765\u5f88\u6709\u9053\u7406\uff0c\u4f46\u662f\u6ca1\u6709\u7528\u554a\uff1f\uff01\n\n\u54b3\u54b3\uff0c\u81f3\u5c11\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u8def\u5f84\u7684\u53ef\u80fd\u6761\u6570\u662f\u65e0\u7a77\u7684\uff08\u53ea\u8981\u70b8\u5f39\u4e00\u76f4\u4e0d\u7206\u70b8\uff0c\u4eba\u5c31\u53ef\u4ee5\u5728\u4e24\u5ea7\u57ce\u5e02\u4e4b\u95f4\u53cd\u590d\u6a2a\u8df3\uff09\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e\u8fd9\u79cd~~\u5947\u602a\u7684~~\u9898\u76ee\uff0c\u6211\u4eec\u4e00\u822c\u8003\u8651 **\u4f7f\u7528\u65b9\u7a0b\u6765\u63a8\u51fa\u76f8\u90bb\u4e24\u4e2a\u72b6\u6001\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u4ece\u800c\u89e3\u51b3\u65e0\u7a77\u65e0\u5c3d\u7684\u8def\u5f84** \u3002\n\n\u6211\u4eec\u8bbe $f_i$ \u4e3a\u70b8\u5f39\u5728\u7b2c $i$ \u5ea7\u57ce\u5e02\u7206\u70b8\u7684\u6982\u7387\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e\u4e00\u5ea7\u57ce\u5e02 $x$ \uff0c\u6211\u4eec\u8003\u8651\u600e\u4e48\u5217\u51fa\u5f0f\u5b50\uff1a\n\u8003\u8651\u5f53\u524d\u57ce\u5e02\u7684\u70b8\u5f39\u662f\u4ece\u5176\u4ed6\u57ce\u5e02\u4f20\u8fc7\u6765\u5e76\u4e14\u5728\u5f53\u524d\u57ce\u5e02\u7206\u70b8\uff1a\n$ f_x=\\sum_{ \u6240\u6709\u6ee1\u8db3 x,v\u6709\u8fb9\u76f8\u8fde\u7684 v } \\frac {(1-\\frac p q)} {deg[v]}*f_v $\n\n\u79fb\u9879\u540e\u53d8\u4e3a\uff1a\n\n$ -f_x+\\sum_{ \u6240\u6709\u6ee1\u8db3 x,v\u6709\u8fb9\u76f8\u8fde\u7684 v } \\frac {(1-\\frac p q)} {deg[v]}*f_v=0 $\n\n\u4e5f\u5c31\u53ef\u4ee5\u5bf9\u5e94\u8fdb\u4ee3\u7801\u91cc\u7684\u7cfb\u6570\u4e86\u3002\n\n\u5bf9\u4e86\uff0c\u6700\u540e\u8fd8\u8981\u7b97\u4e0a\u70b8\u5f39\u5728\u7b2c\u4e00\u5ea7\u57ce\u5e02\u7206\u70b8\u7684\u6982\u7387\u55f7\uff0c\u4e0d\u660e\u767d\u53ef\u4ee5\u770b\u4ee3\u7801\u3002\n\n\u8bf6\uff0c\u90a3\u6211\u4eec\u6bcf\u4e2a\u57ce\u5e02\u4e00\u4e2a\u65b9\u7a0b\uff0c\u603b\u5171\u5c31\u662f $n$ \u5143 $n$ \u4e2a\u65b9\u7a0b\uff0c\u7528\u9ad8\u65af\u6d88\u5143\u89e3\u5c31\u597d\u4e86\uff08\u522b\u8ddf\u6211\u8bf4\u4f60\u4e0d\u4f1a\u9ad8\u65af\u6d88\u5143\uff09\u3002\n\n### \u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=305,M=50005;\n\nstruct Edge{\n\tint vet,nxt;\n}e[M<<1];\n\nint n,m,edge=0,head[N],deg[N];\ndouble p,q,a[N][N];\nbool Free[N];\n\ninline int read(){\n\tint x=0,f=1; char ch=getchar();\n\twhile (!isdigit(ch)) { if (ch=='-') f=-1; ch=getchar(); }\n\twhile (isdigit(ch)) { x=x*10+ch-'0'; ch=getchar(); }\n\treturn x*f;\n}\n\ninline void addedge(int x,int y){\n\te[++edge].vet=y;\n\te[edge].nxt=head[x];\n\thead[x]=edge;\n}\n\nnamespace Gauss{\n\n\tbool Inf_solution=false,No_Solution=false;\n\n\tinline void SwapLine(int x,int y){\t\t//\u4ea4\u6362\u7b2c x \u884c\u548c\u7b2c y \u884c\n\t\tfor (int i=1;i<=n+1;++i)\n\t\t\tswap(a[x][i],a[y][i]);\n\t}\n\n\tinline void Mul(int x,double k){\t\t//\u628a\u7b2c x \u884c\u7684\u503c\u4e58\u4e0a k\n\t\tfor (int i=1;i<=n+1;++i)\n\t\t\ta[x][i]*=k;\n\t}\n\n\tinline void Add(int x,double k,int y){\t\t//\u628a\u7b2c x \u884c\u4e58\u4e0a k \u52a0\u5230\u7b2c y \u884c\u4e0a\n\t\tfor (int i=1;i<=n+1;++i)\n\t\t\ta[y][i]+=(a[x][i]*k);\n\t}\n\n\tinline void Main(){\n\t\tfor (int i=1;i<=n;++i){\n\t\t\tif (a[i][i]==0){\t\t//\u5982\u679c\u7b2c i \u884c\u7b2c i \u9879\u7cfb\u6570\u4e3a 0 \u5219\u4e0e\u4e4b\u540e\u4e0e\u4e0d\u4e3a 0 \u7684\u884c\u4ea4\u6362\n\t\t\t\tbool flag_free=true;\n\t\t\t\tfor (int j=i+1;j<=n;++j)\n\t\t\t\t\tif (a[j][i]){\n\t\t\t\t\t\tSwapLine(i,j);\n\t\t\t\t\t\tflag_free=false;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\tif (flag_free) Free[i]=true;\n\t\t\t}\n\t\t\tif (Free[i]) { Inf_solution=true; continue; }\n\t\t\tMul(i,1.0/a[i][i]);\t\t//\u628a\u7b2c i \u884c\u7b2c i \u9879\u7cfb\u6570\u53d8\u6210 1 \n\t\t\tfor (int j=1;j<=n;++j)\t\t//\u6d88\u53bb\u5176\u4ed6\u884c\u7b2c i \u9879\u7684\u7cfb\u6570\n\t\t\t\tif (i^j) Add(i,-a[j][i],j);\n\t\t}\n\t\tfor (int i=1;i<=n;++i){\n\t\t\tbool flag_zero=true;\n\t\t\tfor (int j=1;j<=n;++j)\n\t\t\t\tif (a[i][j]){\n\t\t\t\t\tflag_zero=false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tif ((flag_zero) && (a[i][n+1])){\n\t\t\t\tNo_Solution=true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n}\n\nint main(){\n\t//freopen(\"Luogu2973.in\",\"r\",stdin);\n\t//freopen(\"Luogu2973.out\",\"w\",stdout);\n\tscanf(\"%d%d%lf%lf\",&n,&m,&p,&q);\n\tfor (int i=1;i<=m;++i){\n\t\tint x=read(),y=read();\n\t\taddedge(x,y);\n\t\taddedge(y,x);\n\t\t++deg[x],++deg[y];\n\t}\n\tfor (register int x=1;x<=n;++x){\n\t\ta[x][x]=-1;\t\t//\u628a\u65b9\u7a0b\u79fb\u9879\uff0c\u8ba9\u53f3\u8fb9\u4e3a 0 \u540e\u7b2c x \u4e2a\u5143\u7684\u7cfb\u6570\u4e3a -1 \n\t\tfor (int i=head[x];i;i=e[i].nxt){\n\t\t\tint v=e[i].vet;\n\t\t\ta[x][v]=1.0*(q-p)/q/deg[v];\t\t//\u628a\u65b9\u7a0b\u4ee3\u8fdb\u53bb\u5c31\u53ef\u4ee5\u4e86\n\t\t}\n\t}\n\ta[1][n+1]=-p/q;\t\t//\u7b97\u4e0a\u4e00\u5f00\u59cb\u5c31\u7206\u70b8\u7684\u60c5\u51b5\n\tGauss::Main();\n\tfor (int i=1;i<=n;++i)\n\t\tprintf(\"%.9lf\\n\",a[i][n+1]);\n\treturn 0;\n}\n```\n\u90fd\u770b\u5230\u8fd9\u91cc\u4e86\uff0c\u5404\u4f4d\u770b\u5b98\u662f\u4e0d\u662f\u53ef\u4ee5~~\u4e09\u8fde~~\u70b9\u4e2a\u8d5e\u5462\uff1f",
        "postTime": 1616145924,
        "uid": 119264,
        "name": "Alkaid_Star",
        "ccfLevel": 0,
        "title": "Luogu2973\uff08\u9ad8\u65af\u6d88\u5143\uff09\u9898\u89e3"
    },
    {
        "content": "[\u5927\u5bb6\u53ef\u4ee5\u6765\u770b\u770b\u5440](https://www.cnblogs.com/dzice/)\n\n[\u9898\u76ee\u94fe\u63a5](https://www.luogu.org/problem/P2973)\n\n\u8c8c\u4f3c\u6ca1\u6709\u5361\u6211\u7cbe\u5ea6\uff1f\n\n\u8fd9\u9053\u9898\u8ddf[\u8fd9\u9053](https://www.luogu.org/problem/P3232)\u7684\u601d\u8def\u548c\u505a\u6cd5\u90fd\u633a\u50cf\u7684\uff0c\u4e5f\u662f\u671f\u671b+\u9ad8\u65af\u6d88\u5143\n\n\u8bbe$f_u$\u4e3a\u4e00\u4e2a\u70b9\u671f\u671b\u7684\u7ecf\u8fc7\u6b21\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u70b8\u5f39\u5728\u6bcf\u4e2a\u70b9\u7206\u70b8\u7684\u6982\u7387\u5176\u5b9e\u5c31\u662f$f_u*p/q$\uff0c\u6c42\u51fa\u6bcf\u4e2a\u70b9\u7684$f_i$\u5373\u53ef\u5f97\u5230\u6700\u7ec8\u7684\u7b54\u6848\uff0c\u663e\u7136,\u6bcf\u4e2a\u70b9\u7684\u671f\u671b\u662f\u7531\u76f8\u8fde\u7684\u70b9\u7684\u671f\u671b\u51b3\u5b9a\u7684\uff0c$du_x$\u4e3a\u70b9$x$\u7684\u5ea6\u6570,\u70b9$x_1,x_2,x_3....x_k$\u4e0e\u70b9$x$\u76f8\u90bb\uff0c\u5219$f[x]=\\sum_{i=1}^k\\frac{fx_i}{dux_i}$\n\n\u6700\u540e\u7528\u9ad8\u65af\u6d88\u5143\u89e3\u4e00\u4e0b\u6bcf\u4e2a\u70b9\u7684\u671f\u671b\u5373\u53ef\uff0c\u4e0a\u4ee3\u7801\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nint n,m,t,x,y;\ndouble p,q,gai,chu,du[303],a[303][303],b[303],ans[303];\nvector<int>l[303];\nint main()\n{\n\tscanf(\"%d%d%lf%lf\",&n,&m,&p,&q);\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tl[x].push_back(y),l[y].push_back(x),du[x]++,du[y]++;\n\t}\n\tgai=p/q,b[1]=-1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\ta[i][i]=-1;\n\t\tfor(int j=0;j<l[i].size();j++)\n\t\t\ta[i][l[i][j]]=(1-gai)*(1/du[l[i][j]]);\t\t\t\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tt=i;\n\t\tfor(int j=i+1;j<=n;j++)\n\t\t\tif(a[j][i]>a[j][t])\n\t\t\t\tt=j;\n\t\tif(t!=i)\n\t\t{\n\t\t\tfor(int j=i;j<=n;j++)\n\t\t\t\tswap(a[i][j],a[t][j]);\n\t\t\tswap(b[i],b[t]);\n\t\t}\n\t\tif(a[i][i]!=0)\n\t\t\tfor(int j=i+1;j<=n;j++)\n\t\t\t{\n\t\t\t\tchu=a[j][i]/a[i][i];\n\t\t\t\tfor(int k=i;k<=n;k++)\n\t\t\t\t\ta[j][k]-=a[i][k]*chu;\n\t\t\t\tb[j]-=b[i]*chu;\n\t\t\t}\n\t}\n\tfor(int i=n;i>=1;i--)\n\t{\n\t\tans[i]=b[i]/a[i][i];\n\t\tfor(int j=1;j<i;j++)\n\t\t\tb[j]-=a[j][i]*ans[i];\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tprintf(\"%.9lf\\n\",fabs(ans[i]*gai));\n\treturn 0;\n}\n\n```\n",
        "postTime": 1574557295,
        "uid": 78001,
        "name": "dz_ice",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2973 \u3010[USACO10HOL]\u8d76\u5c0f\u732aDriving Out the Piggi\u2026\u3011"
    },
    {
        "content": "\u76f4\u63a5\u8bbe\u5728\u6bcf\u4e2a\u70b9\u7206\u70b8\u7684\u6982\u7387\u662f\u4e0d\u597d\u8f6c\u79fb\u7684\u3002\u4e0d\u59a8\u8bbe\u5f53\u524d\u5728\u70b9 $i$ \u6ca1\u6709\u7206\u70b8\uff0c\u671f\u671b\u7ecf\u8fc7\u70b9 $i$ \u7684\u6b21\u6570 $f_i$\u3002\n\n\u90a3\u4e48\u6709\uff1a\n\n$$\n\\begin{cases}\nf_1=1+(1-\\frac{P}{Q})\\sum_{(1,v)\\in E} \\frac{1}{du_v}f_v\n\\\\\nf_i=(1-\\frac{P}{Q})\\sum_{(i,v)\\in E} \\frac{1}{du_v}f_v\n\\end{cases}\n$$\n\n\u77e5\u9053\u4e86\u7ecf\u8fc7\u6bcf\u4e2a\u70b9 $i$ \u7684\u671f\u671b\u6b21\u6570\u540e\uff0c\u5728\u70b9 $i$ \u7206\u70b8\u7684\u6982\u7387\u5373\u8f6c\u5316\u4e3a\u671f\u671b\u6b21\u6570 $\\times$ \u7206\u70b8\u6982\u7387\u3002\u5373\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u70b9 $i$\uff0c\u7b54\u6848\u4e3a $f_i\\times \\frac{P}{Q}$\u3002\n\n\u8fd9\u4e2a $\\text{DP}$ \u65b9\u7a0b\u5177\u6709\u540e\u6548\u6027\uff0c\u9ad8\u65af\u6d88\u5143\u4e00\u6ce2\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^3)$\u3002\n\n\u8fd9\u9053\u9898\u5145\u5206\u8bf4\u660e\u4e86\uff0c\u4e0d\u4ec5\u671f\u671b\u53ef\u4ee5\u8f6c\u5316\u4e3a\u6982\u7387 $\\times$ \u6743\u503c\uff0c\u6982\u7387\u4e5f\u53ef\u4ee5\u8f6c\u5316\u4e3a\u671f\u671b $\\times$ \u6982\u7387\uff08\u5df2\u77e5\uff09\u3002\n\n\u4ee3\u7801\u592a $\\text{Naive}$ \u4e86\u5c31\u4e0d\u653e\u4e86\u3002",
        "postTime": 1603935757,
        "uid": 95244,
        "name": "tommymio",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2973 \u3010[USACO10HOL]Driving Out the Piggies G\u3011"
    },
    {
        "content": "## Solution\n\n\u8ba8\u8bba\u533a\u91cc\u6709\u4eba\u6000\u7591\u76f4\u63a5\u6c42\u6982\u7387\u7684\u6b63\u786e\u6027\u6211\u6765\u8bf4\u4e24\u53e5\u3002\n\n\u8fd9\u91cc\u7684\u6982\u7387\u600e\u4e48\u5b9a\u4e49?\u663e\u7136\u4e0d\u662f\u53e4\u5178\u6982\u578b\u3002\u6bcf\u4e00\u6761\u6709\u5411\u8fb9\u90fd\u6709\u8fb9\u6743 $w=\\frac{1}{deg_u}$\uff0c\u8868\u793a\u9009\u62e9\u8fd9\u4e00\u6761\u8def\u7684\u6982\u7387\u3002\u540c\u65f6\uff0c\u6bcf\u4e2a\u70b9\u8fd8\u6709\u70b9\u6743\u4e3a $1-\\frac{p}{q}$\uff0c\u8868\u793a\u5b89\u7136\u65e0\u6059\u79bb\u5f00\u8fd9\u4e2a\u70b9\u7684\u6982\u7387\u3002\u6240\u4ee5\u4e00\u4e2a\u70b9\u7206\u70b8\u7684\u6982\u7387\u5c31\u662f\u6240\u6709\u4ece\u8d77\u70b9\u5230\u8fd9\u4e2a\u70b9\u7684\u8def\u5f84\u8fb9\u6743\u548c\u975e\u7ec8\u70b9\u70b9\u6743\u79ef\u7684\u548c\u518d\u4e58\u4e0a $\\frac{p}{q}$\uff0c\u4e0d\u77e5\u8bf4\u7684\u662f\u5426\u6e05\u695a\u3002\n\n\u8fd9\u4e2a\u662f\u4e0d\u80fd\u76f4\u63a5\u6c42\u7684\uff0c\u56e0\u4e3a\u65b9\u6848\u662f\u65e0\u9650\u4e2a\u3002\u6240\u4ee5\u6211\u4eec\u5148\u8bbe $dp_u$ \u8868\u793a\u5728 $u$ \u7206\u70b8\u7684\u6982\u7387\u3002\u5f53 $u\\neq 1$ \u7684\u65f6\u5019\uff0c\u65e2\u7136 $u$ \u4e0d\u662f\u8d77\u70b9\uff0c\u90a3\u4e48\u5b83\u524d\u9762\u5fc5\u5b9a\u8fd8\u6709\u4e00\u4e2a\u70b9\uff0c\u8bbe\u4e3a $v$\u3002\u90a3\u4e48\u6240\u6709\u4ee5 $v$ \u7ed3\u5c3e\u7684\u8def\u5f84\u7684\u8fb9\u6743\u79ef\u4e0e\u975e\u7ec8\u70b9\u70b9\u6743\u7684\u548c\u662f $\\frac{q}{p} \\times dp_v$\u3002\u518d\u4e58\u4e0a\u8fd9\u4e2a $v$ \u7684\u70b9\u6743\u548c $(u,v)$ \u7684\u8fb9\u6743\uff0c\u5c31\u662f $\\frac{q}{p} \\times dp_v \\times \\frac{1}{deg_v} \\times (1-\\frac{p}{q})$\u3002\u6240\u4ee5 $dp_u = \\frac{p}{q} \\sum_{(v,u) \\in E} \\frac{q}{p} \\times dp_v \\times \\frac{1}{deg_v} \\times (1-\\frac{p}{q}) = \\sum_{(v,u)\\in E} dp_v \\times \\frac{1}{deg_v} \\times (1-\\frac{p}{q})$ \u3002 \u552f\u4e00\u7684\u95ee\u9898\u53ea\u6709 $u=1$ \u7684\u65f6\u5019\uff0c\u5b83\u53ef\u4ee5\u4e0d\u9700\u8981\u7ecf\u8fc7\u4efb\u4f55\u70b9\u5e76\u7206\u70b8\uff0c\u6982\u7387\u662f $\\frac{p}{q}$ \u3002\u6700\u540e\u52a0\u4e0a\u5373\u53ef\u3002\n\n\u6c42\u51fa\u6240\u6709\u7684 $dp$ \u6570\u7ec4\u7684\u5173\u7cfb\u5f0f\uff0c\u5c31\u53ef\u4ee5\u9ad8\u65af\u6d88\u5143\u6c42\u89e3\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ffor(i,a,b) for(int i=(a);i<=(b);i++)\n#define roff(i,a,b) for(int i=(a);i>=(b);i--)\nusing namespace std;\nconst int MAXN=300+10;\nint n,m,p,q,deg[MAXN]; vector<int> G[MAXN];\ndouble x[MAXN],f[MAXN][MAXN];\nvoid gauss(void) {\n\tffor(j,1,n) {\n\t\tif(abs(f[j][j])<=1e-6) ffor(i,j+1,n) if(abs(f[i][j])>1e-6) {swap(f[i],f[j]);break;}\n\t\tffor(i,j+1,n) {\n\t\t\tdouble mul=f[i][j]/f[j][j];\n\t\t\tffor(k,1,n+1) f[i][k]-=f[j][k]*mul;\t\n\t\t}\n\t}\n\treturn;\n}\nint main() {\n\tios::sync_with_stdio(false),cin.tie(0),cout.tie(0);\n\tcin>>n>>m>>p>>q;\n\tffor(i,1,m) {\n\t\tint u,v; cin>>u>>v;\n\t\tG[u].push_back(v),G[v].push_back(u);\t\n\t\tdeg[u]++,deg[v]++;\n\t}\n\tffor(i,1,n) {\n\t\tif(i==1) f[1][n+1]=p*1.0/q;\n\t\tf[i][i]=1.0;\n\t\tfor(auto v:G[i]) f[i][v]=-(1-p*1.0/q)*1.0/deg[v]; \t\n\t}\n\tgauss();\n\troff(i,n,1) {\n\t\tffor(j,i+1,n) f[i][n+1]-=f[i][j]*x[j];\n\t\tx[i]=f[i][n+1]/f[i][i];\t\n\t}\n\tffor(i,1,n) cout<<fixed<<setprecision(8)<<x[i]<<'\\n';\n\treturn 0;\n}\n```",
        "postTime": 1673752212,
        "uid": 120947,
        "name": "Purslane",
        "ccfLevel": 7,
        "title": "P2973"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u9053\u975e\u5e38\u4f20\u7edf\u7684\u9ad8\u65af\u6d88\u5143\u7684\u9898\u76ee\uff0c\u9700\u8981\u7b80\u5355\u7684\u671f\u671b\u63a8\u5bfc\u3002\n\n--------\n\n## \u671f\u671b\u63a8\u5bfc\n\n\u65e0\u5411\u56fe\uff0c\u8282\u70b9 $1$ \u662f\u70b8\u5f39\uff0c\u6bcf\u79d2\u90fd\u6709 $p/q$ \u7684\u6982\u7387\u7206\u70b8\uff0c\u5426\u5219\u968f\u673a\u9009\u62e9\u4e00\u6761\u51fa\u8fb9\u5230\u76f8\u90bb\u8282\u70b9\uff0c\u95ee\u6bcf\u4e2a\u8282\u70b9\u7531\u70b8\u5f39\u7206\u70b8\u7684\u6982\u7387\u3002\n\n\u8fd9\u4e2a\u6982\u7387\uff0c\u4f60\u4f1a\u53d1\u73b0\u5199\u6210\u5206\u6570\u7684\u5f62\u5f0f\u6beb\u65e0\u7528\u5904\uff0c\u4e8e\u662f\u76f4\u63a5\u8bb0 $p/q$ \u4e3a\u5b9e\u6570 $P$\u3002\u663e\u7136\u6bcf\u4e2a\u8282\u70b9\u7206\u70b8\u6216\u8005\u4e0d\u7206\u70b8\u7684\u6982\u7387\uff0c\u662f\u53d7\u5230\u5468\u56f4\u8282\u70b9\u5f71\u54cd\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u8003\u8651\u4e00\u4e0b\u8f6c\u79fb\u7684\u65b9\u7a0b\u3002\n\n\u8bbe $x_i$ \u4e3a\u671f\u671b\u7ecf\u8fc7\u70b9 $i$ \u6b21\u6570\uff0c\u663e\u7136\u7b54\u6848\u4e3a $P\\times x_i$ \uff08\u56e0\u4e3a\u6bcf\u6b21\u7ecf\u8fc7\u70b9 $i$ \u7684\u6982\u7387\u90fd\u4e0d\u540c\uff0c\u56e0\u6b64\u80fd\u628a\u671f\u671b\u6c42\u51fa\u6765\u5c31\u597d\u4e86\uff0c\u7ed3\u5408\u4e24\u4e2a\u70b9\u7684\u6837\u4f8b\u7406\u89e3\uff09\uff0c\u90a3\u4e48\u5e94\u8be5\u600e\u4e48\u5229\u7528\u5468\u56f4\u8282\u70b9\u7684\u6570\u636e\uff0c\u6765\u6c42\u5f53\u524d\u8282\u70b9\u7684\u503c\u5462\uff1f\n\n\u9996\u5148\u5c31\u662f\u4e0d\u5f97\u4e0d\u63d0\u7684\uff0c\u7b2c\u4e00\u4e2a\u70b9\u7684\u7ecf\u8fc7\u671f\u671b\u6b21\u6570\u8981\u52a0\u4e00\uff0c\u56e0\u4e3a\u4e00\u5f00\u59cb\u5c31\u5728\u8fd9\u91cc\u3002\u90a3\u4e48\u518d\u8003\u8651\u7ecf\u8fc7\u6b21\u6570\u671f\u671b\uff1a\u4ece\u522b\u7684\u5730\u65b9\u6765\uff0c\u6ca1\u70b8\uff0c\u90a3\u4e48\u8fd9\u5c31\u7275\u626f\u5230\u5ea6\u6570\u95ee\u9898\uff0c\u4e0d\u96be\u5199\u51fa\u4ee5\u4e0b\u65b9\u7a0b\uff1a\n\n$$x_u=\\sum\\limits_{(u,v)}(1-P)\\times \\dfrac{1}{d_v}\\times x_v+[u=1]$$\n\n\u8fd9\u610f\u5473\u7740\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u80fd\u591f\u5230\u8fbe\u5f53\u524d\u8282\u70b9\u7684\u8282\u70b9\uff0c\u5982\u679c\u6ca1\u6709\u7206\u70b8\uff08\u4e5f\u5c31\u662f\u5f0f\u5b50\u4e2d $1-P$ \u7684\u610f\u4e49\uff09\uff0c\u90a3\u4e48\u5c31\u4e00\u5b9a\u80fd\u5b89\u7a33\u7684\u5230\u8fbe\u8be5\u8282\u70b9\uff0c\u6c42\u4e00\u4e0b\u548c\u5c31\u597d\u4e86\u3002\u800c\u540e\u9762\u7684 $[u=1]$ \u662f\u4e00\u4e2a[\u827e\u5f17\u68ee\u62ec\u53f7](https://baike.baidu.com/item/\u827e\u4f5b\u68ee\u62ec\u53f7/22361197)\uff0c\u662f\u4e00\u4e2a\u8c13\u8bcd\u51fd\u6570\u3002\n\n\u4f46\u662f\u8fd9\u80fd\u591f\u7b80\u5355\u5730\u9012\u63a8\u5417\uff1f\u663e\u7136\u662f\u4e0d\u884c\u7684\uff0c\u56e0\u4e3a\u8fd9\u662f\u4e00\u4e2a\u65e0\u5411\u8fde\u901a\u56fe\uff0c\u56e0\u6b64\u5fc5\u7136\u5b58\u5728\u73af\u3002\u800c\u5173\u4e8e\u8fd9\u4e2a\u52a0\u4e00\uff0c\u8981\u610f\u8bc6\u5230\uff0cLHS \u662f $x_u$ \u800c\u65e0\u8bba\u662f $+1$ \u8fd8\u662f\u4e0a\u9762\u7684\u9012\u63a8\u5f0f\uff0c\u90fd\u662f RHS \u56e0\u6b64\u662f\u540c\u53f7\u3002\u6839\u636e\u6700\u540e\u4f60\u51b3\u5b9a\u628a\u672a\u77e5\u6570\u653e\u5728 $x_u$ \u8fd9\u8fb9\u8fd8\u662f $x_v$ \u8fd9\u8fb9\uff0c\u4e24\u8005\u7b26\u53f7\u6709\u6240\u4e0d\u540c\u3002\n\n\u56e0\u4e3a\u80fd\u591f\u5217\u51fa $n$ \u4e2a\u672a\u77e5\u6570\u7684 $n$ \u4e2a\u9012\u63a8\u5f0f\uff0c\u56e0\u6b64\u53ef\u4ee5\u5217\u51fa\u6765\u7684\u662f\u4e00\u4e2a\u65b9\u7a0b\u7ec4\u7528\u9ad8\u65af\u6d88\u5143\uff0c$O(n^3)$\uff0c\u6240\u4ee5\u53ef\u4ee5\u505a\u3002\n\n\u6211\u4eec\u63a5\u4e0b\u6765\u7b80\u5355\u4ecb\u7ecd\u4e00\u4e0b\u9ad8\u65af\u6d88\u5143\u3002\n\n## \u9ad8\u65af\u6d88\u5143\n\n\u7ebf\u6027\u65b9\u7a0b\u7ec4\u5199\u6210\u589e\u5e7f\u77e9\u9635\u7684\u5f62\u5f0f\uff08$n$ \u4e2a\u7cfb\u6570\u4e00\u4e2a $1$ \u4e2a\u5e38\u6570\uff09$\\to n\\times (n+1)$ \u7684\u77e9\u9635\n\n\u76ee\u6807\uff1a\u628a\u4e00\u822c\u65b9\u7a0b\u7528\u9ad8\u65af\u6d88\u5143\u6cd5\u6d88\u6210\u4e0a\u4e09\u89d2\u77e9\u9635\n\n$\\begin{cases}x+y-4z=-9&\\boxed{\\text{I.}}\\\\x+4y+z=6&\\boxed{\\text{II.}}\\\\4x-5y+z=-3&\\boxed{\\text{III.}}\\end{cases}$\n\n\u6d88\u53bb $x$ \u7684\u7cfb\u6570\uff1a$\\text{II}-\\text{I}$ \u548c $\\text{III}-4\\times\\text{I}$ \u5f97\u5230\u4e00\u4e2a\u65b0\u77e9\u9635\n\n\u7136\u540e\u5bf9\u4e8e\u6d88\u53bb $x$ \u7684\u4e24\u4e2a\u4e8c\u5143\u65b9\u7a0b\u7ec4\uff0c\u518d\u6d88\u4e00\u6b21\u5143\uff0c\u6c42\u51fa $z$\u3002\n\n\u7136\u540e\u4e00\u5c42\u4e00\u5c42\u4ee3\u5165\u56de\u53bb\u3002\n\n\u53ea\u8981\u6b21\u5e8f\u6d88\u5143\u7ed3\u675f\u7136\u540e\u56de\u4ee3\u5c31\u80fd\u5f97\u5230\u7ed3\u679c\uff0c\u9274\u4e8e\u7bc7\u5e45\u95ee\u9898\uff0c\u6b64\u5904\u4e0d\u518d\u4ecb\u7ecd\u66f4\u7b80\u5355\u7684\u9ad8\u65af-\u7ea6\u5f53\u6d88\u5143\u6cd5\u3002\n\n## \u4ee3\u7801\u601d\u8def\n\n\u9ad8\u65af\u6d88\u5143\u7684\u5927\u81f4\u6b65\u9aa4\uff1a\n\n\u8bfb\u5165\u77e9\u9635 $\\to$ \u5faa\u73af $n$ \u6761\uff08\u4ece $1\\sim n-1$ \u56e0\u4e3a\u6700\u540e\u4e00\u4e2a\u672a\u77e5\u91cf\u4e0d\u9700\u8981\u6d88\u6389\uff09\u3002\u5185\u5c42\u5faa\u73af\u4ece $i+1$ \u5230 $n$\uff08\u524d\u9762\u7684\u6d88\u8fc7\u4e86\u4e0d\u7528\u6d88\uff0c\u8981\u4ece\u8fd9\u91cc\u5904\u7406\u5230\u6700\u540e\u4e00\u884c\uff09\n\n\u82e5\u5f53\u524d\u6570 $a(i,i)$ \u662f $0$ \u4e14\u5e38\u6570 $c=a(i,n+1)\\neq 0$ \u5c31\u662f\u65e0\u89e3\u7684\uff0c\u56e0\u4e3a $0\\cdot x_i=c$ \u662f\u4e0d\u5b58\u5728\u7684\uff0c\u5982\u679c $c=0$ \u90a3\u5c31\u662f\u591a\u89e3\u3002\u7136\u540e $a(i,n+1)$ \u5373\u5e38\u6570\u9879\u5199\u51fa\u6765\uff0c\u7136\u540e\u79fb\u9879\u6c42\u89e3\u3002\n\n\u7136\u540e\u7cfb\u6570\u5316\u4e3a\u4e00\u5c31\u89e3\u51b3\u4e86\uff08\u66f4\u65b0\u5230 $ans$ \u6570\u7ec4\u91cc\u9762\uff09\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define N 305\nusing namespace std;\nint n,m,p,q,h[N],cnt,d[N];\nstruct edge{int v,nxt;}e[N*N*2]; \nvoid add(int u,int v){\n\te[++cnt].v=v;e[cnt].nxt=h[u];\n\th[u]=cnt;d[v]++;\n}long double X,a[N][N],ans[N];//ans \u662f\u671f\u671b\u7ecf\u8fc7\u6b21\u6570 \nint main(){\n\tscanf(\"%d%d%d%d\",&n,&m,&p,&q);\n\tX=(p*1.0)/(q*1.0);\n\tfor(int i=1;i<=m;i++){\n\t\tint u,v;scanf(\"%d%d\",&u,&v);\n\t\tadd(u,v);add(v,u);\n\t}for(int i=1;i<=n;i++){\n\t\tfor(int j=h[i];j;j=e[j].nxt)\n\t\t\ta[i][e[j].v]=(1.0-X)/(long double)d[e[j].v];//\u7cbe\u9ad3 \n\t\ta[i][i]=-1;\n\t\tif(i==1)a[i][n+1]=-1;\n\t}for(int i=1;i<n;i++){//\u4ece\u8fd9\u5f00\u59cb\u9ad8\u6d88\u4e86 \n\t\tfor(int j=i+1;j<=n;j++){\n\t\t\tlong double sum=a[j][i]/a[i][i];\n\t\t\tfor(int k=i;k<=n+1;k++)a[j][k]-=sum*a[i][k];\n\t\t}\n\t}for(int i=n;i>0;i--){\n\t\tlong double sum=a[i][n+1];\n\t\tfor(int j=i+1;j<=n;j++)sum-=ans[j]*a[i][j];\n\t\tans[i]=sum/a[i][i];\n\t}for(int i=1;i<=n;i++)\n\t\tprintf(\"%.9Lf\\n\",X*ans[i]);\n\treturn 0;\n}\n```",
        "postTime": 1644802370,
        "uid": 212283,
        "name": "Aw\u987f\u987f",
        "ccfLevel": 5,
        "title": "\u3010\u9898\u89e3\u3011P2973 [USACO10HOL]Driving Out the Piggies G"
    },
    {
        "content": "## \u9898\u610f\u7b80\u8ff0\n\n\u4e00\u4e2a\u65e0\u5411\u56fe\uff0c\u8282\u70b9 $1$ \u6709\u4e00\u4e2a\u70b8\u5f39\uff0c\u5728\u6bcf\u4e2a\u5355\u4f4d\u65f6\u95f4\u5185\uff0c\u6709 $\\frac{p}{q}$ \u7684\u6982\u7387\u5728\u8fd9\u4e2a\u8282\u70b9\u70b8\u6389\uff0c\u6709 $1-\\frac{p}{q}$ \u7684\u6982\u7387\u968f\u673a\u9009\u62e9\u4e00\u6761\u51fa\u53bb\u7684\u8def\u5230\u5176\u4ed6\u7684\u8282\u70b9\u4e0a\u3002\n\n\u95ee\u6700\u7ec8\u70b8\u5f39\u5728\u6bcf\u4e2a\u8282\u70b9\u4e0a\u7206\u70b8\u7684\u6982\u7387\u3002\n\n## \u9898\u89e3\n\n\u76f4\u63a5\u8bbe\u6982\u7387\u505a\u4e0d\u6765\u7684\u6837\u5b50\u3002\u3002\u3002\n\n\u95ee\u4e86\u4e00\u4e0b\u61c2\u884c\u7684\u4eba\u53d1\u73b0\u9700\u8981\u8bbe\u671f\u671b\u3002\n\n\u8bbe $f_{u}$ \u4e3a\u8282\u70b9\u7ecf\u8fc7 $u$ \u7684\u671f\u671b\u6b21\u6570\uff0c\u8bbe $E$ \u4e3a\u8fb9\u96c6\uff0c$d_{u}$ \u8868\u793a\u8282\u70b9 $u$ \u7684\u5ea6\u3002\n$$\nf_{u}=(1-\\frac{p}{q})\\sum_{(u,v)\\in E}\\frac{1}{d_{v}}f_{v}\n$$\n\u56e0\u4e3a\u6709\u73af\uff0c\u6240\u4ee5\u9700\u8981\u9ad8\u65af\u6d88\u5143\u4e00\u4e0b\u3002\n\n\u90a3\u4e48\u5728\u6bcf\u4e2a\u8282\u70b9\u7206\u70b8\u7684\u6982\u7387\u5373\u4e3a $f_{u}\\times\\frac{p}{q}$\u3002\n\n\u603b\u7ed3\u4e00\u4e0b\uff0c\u8fd9\u9053\u9898\u544a\u8bc9\u4e86\u6211\u4e0d\u4ec5\u662f\u671f\u671b\u53ef\u4ee5\u56de\u5f52\u672c\u8d28\u7528\u6982\u7387\u641e\uff0c\u6982\u7387\u4e5f\u53ef\u4ee5\u7528\u671f\u671b\u6765\u6574\u3002\n\n```cpp\n#include <cstdio>\n\nconst int MAXN = 300 + 5, MAXM = MAXN * MAXN;\n\ntemplate<typename _T> _T ABS ( const _T x ) { return x > 0 ? x : -x; }\ntemplate<typename _T> void swapp ( _T &x, _T &y ) { _T w = x; x = y; y = x; }\n\nstruct GraphSet {\n\tint to, nx;\n\tGraphSet ( int T = 0, int N = 0 ) { to = T, nx = N; }\n} as[MAXM];\n\nint n, m, p, q, cnt, d[MAXN], begin[MAXN];\ndouble mat[MAXN][MAXN], sol[MAXN], boomed, transed;\n\nvoid makeEdge ( const int u, const int v ) { as[++ cnt] = GraphSet ( v, begin[u] ), begin[u] = cnt; }\n\nvoid Eradicate () {\n\tfor ( int i = 1; i <= n; ++ i ) {\n\t\tint p = i;\n\t\tfor ( int j = i + 1; j <= n; ++ j ) {\n\t\t\tif ( ABS ( mat[p][i] ) < ABS ( mat[j][i] ) )\tp = j;\n\t\t}\n\t\tfor ( int j = 1; j <= n + 1; ++ j )\tswapp ( mat[p][j], mat[i][j] );\n\t\tfor ( int j = 1; j <= n; ++ j ) {\n\t\t\tif ( i == j )\tcontinue;\n\t\t\tdouble d = mat[j][i] / mat[i][i];\n\t\t\tfor ( int k = 1; k <= n + 1; ++ k )\tmat[j][k] -= mat[i][k] * d;\n\t\t}\n\t}\n\tfor ( int i = 1; i <= n; ++ i )\tsol[i] = mat[i][n + 1] / mat[i][i];\n}\n\nint main () {\n\tscanf ( \"%d%d%d%d\", &n, &m, &p, &q );\n\tfor ( int i = 1, u, v; i <= m; ++ i ) {\n\t\tscanf ( \"%d%d\", &u, &v );\n\t\tmakeEdge ( u, v ), makeEdge( v, u );\n\t\td[u] ++, d[v] ++;\n\t}\n\tboomed = ( double )p / ( double )q;\n\ttransed = 1 - boomed;\n\tfor ( int _ = 1; _ <= n; ++ _ ) {\n\t\tint u = _;\n\t\tmat[u][u] = 1;\n\t\tfor ( int i = begin[u]; i; i = as[i].nx ) {\n\t\t\tint v = as[i].to;\n\t\t\tmat[u][v] -= transed / d[v];\n\t\t}\n\t}\n\tmat[1][n + 1] = 1;\n\tEradicate ();\n\tfor ( int i = 1; i <= n; ++ i )\tprintf ( \"%.9lf\\n\", sol[i] * boomed );\n\treturn 0;\n}\n```",
        "postTime": 1606395344,
        "uid": 161849,
        "name": "cirnovsky",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2973 \u3010[USACO10HOL]Driving Out the Piggies G\u3011"
    }
]
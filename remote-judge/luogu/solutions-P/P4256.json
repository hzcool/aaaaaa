[
    {
        "content": "\u5361\u5e38\u5927\u8d5b......\n\u6700\u540e\u6ca1\u5f00O2\u6bd4\u5f00\u4e86O2\u8fd8\u5feb\uff1f\uff01\n\n\u9996\u5148\u770b\u9898\uff0c\u6c42\u533a\u95f4gcd\u548clcm\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u533a\u95f4\u5185\u7684\u6bcf\u4e2a\u6570\u5206\u89e3\u8d28\u56e0\u6570\uff0cgcd\u7684\u8bdd\u5bf9\u6bcf\u4e2a\u8d28\u6570\u4e2a\u6570\u53d6min\uff0clcm\u7684\u8bdd\u53d6max\uff0c\u7136\u800c\u76f4\u63a5\u7ebf\u6bb5\u6811\u4e0a\u6bcf\u4e2a\u8282\u70b9\u5b58\u8be5\u8d28\u6570\u51fa\u73b0\u591a\u5c11\u6b21\u7684\u8bdd\u94c1\u5b9aMLE\u3002\n\n\u8fd9\u9898\u7684\u6570\u636e\u8303\u56f4\u5f88\u795e\u5947\uff1a\u6bcf\u4e2a\u503c\u5728[1,100]\u4ee5\u5185\uff0c\u800c\u4e14\u9898\u76ee\u53ea\u8ba9\u6c42gcd\u548clcm\uff08S\u64cd\u4f5c\u53ef\u4ee5\u901a\u8fc7\u6c42gcd\u6c42\u5f97\uff09\uff0c\u6240\u4ee5\u8fd9\u5c31\u542f\u53d1\u6211\u4eec\uff1a\u5c06\u8d28\u6570\u538b\u8d77\u6765\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff1a2^6=64, 2^7=128>100\uff0c\u6240\u4ee5\u4e00\u4e2a\u533a\u95f4\u51852\u7684\u4e2a\u6570\u4e0d\u8d85\u8fc76\uff0c\u800c6\u53ef\u4ee5\u7528\u4e09\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u8868\u793a\uff086=4+2+0\uff0c\u5373110\uff09\uff1b\u540c\u7406\uff0c3^4=81, 3^5>100\uff0c\u6240\u4ee5\u4e00\u4e2a\u533a\u95f4\u51853\u7684\u4e2a\u6570\u4e0d\u8d85\u8fc74\uff0c\u4e5f\u7528\u4e09\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u8868\u793a\uff084=4+0+0\uff0c\u5373100\uff09\uff1b\u8fd9\u6837\u4ee5\u6b64\u7c7b\u63a8\uff0c\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u533a\u95f4\u5185\u6240\u6709\u8d28\u6570\u53ca\u5176\u4e2a\u6570\u53ef\u4ee5\u752831\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u8868\u793a\u3002\n\n\u800c\u8fd931\u4e2a\u4e8c\u8fdb\u5236\u4f4d\uff0c\u6b63\u597d\u5bf9\u5e94\u4e00\u4e2aint\u7684\u8303\u56f4\u3002\u6240\u4ee5\u6bcf\u4e2a\u8282\u70b9\u5b58\u4e24\u4e2aint\uff1alcm\u548cgcd\uff0c\u8868\u793a\u5f53\u524d\u533a\u95f4\u53d6gcd\u65f6\u7684\u8d28\u6570\u53ca\u5176\u4e2a\u6570\uff0c\u53d6lcm\u65f6\u7684\u8d28\u6570\u53ca\u5176\u4e2a\u6570\u3002\n\n\u7136\u540e\u5c31\u662f\u666e\u901a\u7684\u533a\u95f4\u4fee\u6539\u3001\u533a\u95f4\u67e5\u8be2\u4e86\u3002\u4e0d\u8fc7\u8fd8\u662f\u6709\u4e00\u4e9b\u7ec6\u8282\u8981\u6ce8\u610f\u3002\n\n...\u800c\u4e14\u6211\u88ab\u6211\u4e00\u5f00\u59cb\u7684\u5927\u5e38\u6570\u5413\u7740\u4e86QAQ\n\n\u4e0b\u9762\u662f\u4ee3\u7801\uff08\u8fd9\u9053\u9898\u76ee\u524d\u6700\u957f\u4ee3\u7801QAQ\uff09\n\n```cpp\n#include <stdio.h>\n#include <string.h>\n#include <cctype>\nusing namespace std;\ntypedef long long ll;\ntemplate <class _E> inline void read(_E &e){\n    e=0;int ck=1;char ch=getchar();\n    while(ch>'9'||ch<'0'){if(ch=='-')ck=-1;ch=getchar();}\n    while(ch>='0'&&ch<='9'){e=(e<<1)+(e<<3)+(ch^48);ch=getchar();}\n    e*=ck;\n}\ninline int max(int a,int b){if(a>b)return a;else return b;}\ninline int min(int a,int b){if(a>b)return b;else return a;}\nconst int N=300050;int p;\ninline int mi(int a,int b){ //\u5feb\u901f\u5e42 \n    int ret=1;\n    while(b){\n        if(b&1)ret=(ret*a)%p;\n        a=(a*a)%p;\n        b>>=1;\n    }\n    return ret;\n}\nint n,Q,a[N],b[25],c1[25],c2[25],cnt[25];\n//cnt,c1,c2\u90fd\u662f\u7528\u4e8e\u4fdd\u5b58\u5f53\u524d\u503c\u5206\u89e3\u8d28\u56e0\u6570\u540e\u6bcf\u4e2a\u8d28\u6570\u51fa\u73b0\u6b21\u6570\uff0c\n//\u4e0d\u540c\u5730\u65b9\u7528\u7684\u6570\u7ec4\u4e0d\u540c \n//a\u6570\u7ec4\u4e3a\u539f\u6570\u7ec4\uff0cb\u6570\u7ec4\u542b\u4e49\u89c1main\u51fd\u6570 \nint pri[]={2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97};//\u7d20\u6570\u6253\u8868 \n\n#define ls id<<1\n#define rs id<<1|1\ninline int cal(int tmp){ //\u5bf9\u5f53\u524d\u6570\u5206\u89e3\u8d28\u56e0\u6570 \n    int i=0;memset(cnt,0,sizeof cnt);\n    while(tmp>1){\n        if(tmp%pri[i]==0){\n            tmp/=pri[i];\n            cnt[i]++;\n            continue;\n        }\n        i++;\n    }\n    int v=0;\n    for(register int i=0;i<=24;++i)v|=(cnt[i]<<b[i]);\n    return v;\n}\n\n/*\u7ebf\u6bb5\u6811\u5f00\u59cb*/ \nstruct seg{\n    int l,r;\n    int gcd,lcm,lazy;\n}t[N<<2];\ninline int callcm(int v1,int v2){ //\u5bf9v1\u548cv2\u6c42lcm \n    int ret=0,p1,p2;memset(c1,0,sizeof c1);memset(c2,0,sizeof c2);memset(cnt,0,sizeof cnt);\n    c1[0]+=(1&v1)+(2&v1)+(4&v1);v1>>=3;\n    c1[1]+=(1&v1)+(2&v1)+(4&v1);v1>>=3;\n    c1[2]+=(1&v1)+(2&v1);v1>>=2;\n    c1[3]+=(1&v1)+(2&v1);v1>>=2;\n    for(register int i=p1=4;i<=24;++i,++p1){c1[i]+=(v1&1);v1>>=1;if(!v1)break;}if(p1==25)--p1;\n    c2[0]+=(1&v2)+(2&v2)+(4&v2);v2>>=3;\n    c2[1]+=(1&v2)+(2&v2)+(4&v2);v2>>=3;\n    c2[2]+=(1&v2)+(2&v2);v2>>=2;\n    c2[3]+=(1&v2)+(2&v2);v2>>=2;\n    for(register int i=p2=4;i<=24;++i,++p2){c2[i]+=(v2&1);v2>>=1;if(!v2)break;}if(p2==25)--p2;\n    int mx=max(p1,p2);\n    for(register int i=0;i<=mx;++i)cnt[i]=max(c1[i],c2[i]);\n    for(register int i=0;i<=mx;++i)ret|=(cnt[i]<<b[i]);\n    return ret;\n}\ninline int calgcd(int v1,int v2){ //\u5bf9v1\u548cv2\u6c42gcd \n    int ret=0,p1,p2;memset(c1,0,sizeof c1);memset(c2,0,sizeof c2);memset(cnt,0,sizeof cnt);\n    c1[0]+=(1&v1)+(2&v1)+(4&v1);v1>>=3;//\u8d28\u65702\u5360\u7684\u4f4d \n    c1[1]+=(1&v1)+(2&v1)+(4&v1);v1>>=3;//\u8d28\u65703\u5360\u7684\u4f4d \n    c1[2]+=(1&v1)+(2&v1);v1>>=2;//\u8d28\u65705\u5360\u7684\u4f4d \n    c1[3]+=(1&v1)+(2&v1);v1>>=2;//\u8d28\u65707\u5360\u7684\u4f4d \n    for(register int i=p1=4;i<=24;++i,++p1){c1[i]+=(v1&1);v1>>=1;if(!v1)break;}if(p1==25)--p1;\n    c2[0]+=(1&v2)+(2&v2)+(4&v2);v2>>=3;//\u8d28\u65702\u5360\u7684\u4f4d \n    c2[1]+=(1&v2)+(2&v2)+(4&v2);v2>>=3;//\u8d28\u65703\u5360\u7684\u4f4d \n    c2[2]+=(1&v2)+(2&v2);v2>>=2;//\u8d28\u65705\u5360\u7684\u4f4d \n    c2[3]+=(1&v2)+(2&v2);v2>>=2;//\u8d28\u65707\u5360\u7684\u4f4d \n    for(register int i=p2=4;i<=24;++i,++p2){c2[i]+=(v2&1);v2>>=1;if(!v2)break;}if(p2==25)--p2;\n    int mn=min(p1,p2);\n    for(register int i=0;i<=mn;++i)cnt[i]=min(c1[i],c2[i]);\n    for(register int i=0;i<=mn;++i)ret|=(cnt[i]<<b[i]);\n    return ret;\n}\ninline void pushup(int id){\n    t[id].gcd=calgcd(t[ls].gcd,t[rs].gcd);\n    t[id].lcm=callcm(t[ls].lcm,t[rs].lcm);\n}\ninline void pushdown(int id){\n    if(t[id].lazy){\n        t[ls].lazy=t[rs].lazy=t[id].lazy;\n        if(t[id].lazy==1)t[ls].gcd=t[ls].lcm=t[rs].gcd=t[rs].lcm=0;\n\t\t//\u82e5\u5f53\u524d\u503c\u4e3a1\uff0c\u5219gcd\u548clcm\u90fd\u4e3a1\uff0c\u4f46\u7ebf\u6bb5\u6811\u4e2d\u7684gcd\u548clcm\u4e2d\u5b58\u7684\u90fd\u662f\u8d28\u6570\uff0c\n\t\t//\u6240\u4ee5\u5c06\u503c\u8bbe\u4e3a0 \n        else t[ls].gcd=t[ls].lcm=t[rs].gcd=t[rs].lcm=cal(t[id].lazy);\n        t[id].lazy=0;\n    }\n}\nvoid build(int l,int r,int id){ //\u7ebf\u6bb5\u6811\u5efa\u6811 \n    t[id].l=l,t[id].r=r;t[id].lazy=0;\n    if(l==r){\n        if(a[l]==1){t[id].gcd=t[id].lcm=0;return;}\n        t[id].gcd=t[id].lcm=cal(a[l]);\n        return;\n    }\n    int mid=(l+r)>>1;\n    build(l,mid,ls);build(mid+1,r,rs);\n    pushup(id);\n}\nvoid change(int L,int R,int v,int vv,int id){ //v\u4e3a\u8981\u6539\u53d8\u7684\u503c\uff0cvv\u4e3av\u5206\u89e3\u8d28\u56e0\u6570\u540e\u7684\u503c \n    int l=t[id].l,r=t[id].r;\n    if(l>=L&&r<=R){\n        t[id].lazy=v;\n        if(v==1){t[id].gcd=t[id].lcm=0;return;}\n        t[id].gcd=t[id].lcm=vv;\n        return;\n    }\n    pushdown(id);\n    int mid=(l+r)>>1;\n    if(R<=mid)change(L,R,v,vv,ls);\n    else if(L>mid)change(L,R,v,vv,rs);\n    else{\n        change(L,mid,v,vv,ls);\n        change(mid+1,R,v,vv,rs);\n    }\n    pushup(id);\n}\nint qgcd(int L,int R,int id){ //\u67e5\u8be2gcd \n    int l=t[id].l,r=t[id].r;\n    if(l>=L&&r<=R)return t[id].gcd;\n    pushdown(id);\n    int mid=(l+r)>>1;\n    if(R<=mid)return qgcd(L,R,ls);\n    else if(L>mid)return qgcd(L,R,rs);\n    else return calgcd(qgcd(L,mid,ls),qgcd(mid+1,R,rs));\n}\nint qlcm(int L,int R,int id){ //\u67e5\u8be2lcm \n    int l=t[id].l,r=t[id].r;\n    if(l>=L&&r<=R)return t[id].lcm;\n    pushdown(id);\n    int mid=(l+r)>>1;\n    if(R<=mid)return qlcm(L,R,ls);\n    else if(L>mid)return qlcm(L,R,rs);\n    else return callcm(qlcm(L,mid,ls),qlcm(mid+1,R,rs));\n}\n/*\u7ebf\u6bb5\u6811\u7ed3\u675f*/ \n\nint main(){\n    b[0]=0,b[1]=3;b[2]=6,b[3]=8;int bit=10;\n    for(register int i=4;i<=24;++i)b[i]=bit++; //\u8ba1\u7b97\u5f53\u524d\u8d28\u6570\u5728\u4e8c\u8fdb\u5236\u4f4d\u4e0a\u7684\u4f4d\u7f6e \n    read(n),read(Q);\n    for(register int i=1;i<=n;++i)read(a[i]);\n    build(1,n,1); //\u5efa\u6811 \n    \n    while(Q--){\n        char opt[2];int x,y;\n        scanf(\"%s\",opt);read(x),read(y),read(p);\n        switch(opt[0]){\n            case 'L':{\n                int tmp=qlcm(x,y,1),ans=1,pos;memset(cnt,0,sizeof cnt);\n                //pos\u4e3a\u5e38\u6570\u4f18\u5316\u7528\u7684\u53d8\u91cf \n                cnt[0]+=(1&tmp)+(2&tmp)+(4&tmp);tmp>>=3;//\u8d28\u65702\u5360\u7684\u4f4d \n                cnt[1]+=(1&tmp)+(2&tmp)+(4&tmp);tmp>>=3;//\u8d28\u65703\u5360\u7684\u4f4d \n                cnt[2]+=(1&tmp)+(2&tmp);tmp>>=2;//\u8d28\u65705\u5360\u7684\u4f4d \n                cnt[3]+=(1&tmp)+(2&tmp);tmp>>=2;//\u8d28\u65707\u5360\u7684\u4f4d \n                for(register int i=pos=4;i<=24;++i,++pos){\n                    cnt[i]+=(tmp&1);tmp>>=1;if(!tmp)break;\n                }\n                if(pos==25)--pos;\n                /*\u8fd9\u4e00\u90e8\u5206\u4e3a\u795e\u5947\u7684\u5e38\u6570\u4f18\u5316\uff0c\u56e0\u4e3a\u4ece\u7b2c5\u4e2a\u8d28\u6570\u5f00\u59cb\uff0c\u4e00\u4e2a\u533a\u95f4\u5185\u4ec5\u4f1a\u51fa\u73b01\u4e2a\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u5feb\u901f\u5e42\u8ba1\u7b97*/ \n                ans*=mi(pri[0],cnt[0]);\n                ans*=mi(pri[1],cnt[1]);\n                ans*=mi(pri[2],cnt[2]);\n                ans*=mi(pri[3],cnt[3]);\n                ans%=p;\n                for(register int i=4;i<=pos;++i){\n                \tif(cnt[i])ans*=pri[i],ans%=p;\n\t\t\t\t}\n\t\t\t\t/*\u5e38\u6570\u4f18\u5316\u7ed3\u675f*/ \n                printf(\"%d\\n\",ans);\n                break;\n            }\n            case 'G':{\n                int tmp=qgcd(x,y,1),ans=1,pos;memset(cnt,0,sizeof cnt);\n                //pos\u4e3a\u5e38\u6570\u4f18\u5316\u7528\u7684\u53d8\u91cf \n                cnt[0]+=(1&tmp)+(2&tmp)+(4&tmp);tmp>>=3;//\u8d28\u65702\u5360\u7684\u4f4d \n                cnt[1]+=(1&tmp)+(2&tmp)+(4&tmp);tmp>>=3;//\u8d28\u65703\u5360\u7684\u4f4d \n                cnt[2]+=(1&tmp)+(2&tmp);tmp>>=2;//\u8d28\u65705\u5360\u7684\u4f4d \n                cnt[3]+=(1&tmp)+(2&tmp);tmp>>=2;//\u8d28\u65707\u5360\u7684\u4f4d \n                for(register int i=pos=4;i<=24;++i,++pos){\n                    cnt[i]+=(tmp&1);tmp>>=1;if(!tmp)break;\n                }\n                if(pos==25)--pos;\n                /*\u8fd9\u4e00\u90e8\u5206\u4e3a\u795e\u5947\u7684\u5e38\u6570\u4f18\u5316\uff0c\u56e0\u4e3a\u4ece\u7b2c5\u4e2a\u8d28\u6570\u5f00\u59cb\uff0c\u4e00\u4e2a\u533a\u95f4\u5185\u4ec5\u4f1a\u51fa\u73b01\u4e2a\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u5feb\u901f\u5e42\u8ba1\u7b97*/ \n                ans*=mi(pri[0],cnt[0]);\n                ans*=mi(pri[1],cnt[1]);\n                ans*=mi(pri[2],cnt[2]);\n                ans*=mi(pri[3],cnt[3]);\n                ans%=p;\n                for(register int i=4;i<=pos;++i){\n                \tif(cnt[i])ans*=pri[i],ans%=p;\n\t\t\t\t}\n\t\t\t\t/*\u5e38\u6570\u4f18\u5316\u7ed3\u675f*/ \n                printf(\"%d\\n\",ans);\n                break;\n            }\n            case 'C':{\n            \tint vv=cal(p);//\u5148\u8ba1\u7b97\u4e00\u6b65\uff0c\u4f18\u5316\u65f6\u95f4 \n                change(x,y,p,vv,1);\n                break;\n            }\n            case 'S':{\n                int tmp=qgcd(x,y,1),ans=1,pos;memset(cnt,0,sizeof cnt);\n                //pos\u4e3a\u5e38\u6570\u4f18\u5316\u7528\u7684\u53d8\u91cf \n                cnt[0]+=(1&tmp)+(2&tmp)+(4&tmp);tmp>>=3;//\u8d28\u65702\u5360\u7684\u4f4d \n                cnt[1]+=(1&tmp)+(2&tmp)+(4&tmp);tmp>>=3;//\u8d28\u65703\u5360\u7684\u4f4d \n                cnt[2]+=(1&tmp)+(2&tmp);tmp>>=2;//\u8d28\u65705\u5360\u7684\u4f4d \n                cnt[3]+=(1&tmp)+(2&tmp);tmp>>=2;//\u8d28\u65707\u5360\u7684\u4f4d \n                for(register int i=pos=4;i<=24;++i,++pos){\n                    cnt[i]+=(tmp&1);tmp>>=1;if(!tmp)break;\n                }\n                for(register int i=0;i<=pos;++i){\n                    if(cnt[i])ans=ans%p*(cnt[i]+1)%p;\n                    //\u8ba1\u7b97\u7b54\u6848\uff0c\u7b54\u6848\u4e3a\u6bcf\u4e2a\u8d28\u6570\u51fa\u73b0\u6b21\u6570+1\u4e4b\u79ef \n                }\n                printf(\"%d\\n\",ans%p);//\u56e0\u4e3a\u5199\u6cd5\u95ee\u9898\uff0c\u6700\u540e\u4e00\u5b9a\u8981mod p\uff0c\u5426\u5219p=1\u65f6GG \n                break;\n            }\n            default:{\n                break;\n            }\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1520078645,
        "uid": 37661,
        "name": "Vingying",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4256 \u3010\u516c\u4e3b\u306e#19\u51c6\u5907\u6708\u8003\u3011"
    },
    {
        "content": "## \u5b98\u65b9\u9898\u89e3\n\n\u9996\u5148\u6700\u540e\u4e00\u4e2a\u64cd\u4f5c\u53ef\u4ee5\u6c42\u4e2agcd\u76f4\u63a5\u6c42\u4e2a\u7ea6\u6570\u4e2a\u6570\n\n\u7136\u540e\u5c31\u662f\u600e\u4e48\u7ef4\u62a4lcm\u548cgcd\n\n\u6211\u4eec\u53ef\u4ee5\u7ebf\u6bb5\u6811\u7ef4\u62a4\n\n\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u6570\u8bb0\u5f55\u5b83\u7684\u8d28\u56e0\u6570\u7684\u6b21\u6570\n\n\u7136\u540e\u5408\u5e76\u5c31lcm\u53d6max\uff0cgcd\u53d6min\uff0c\u5c31\u597d\u4e86\n\n\u8fd9\u6837\u53ef\u4ee5\u89e3\u51b3\u6bcf\u6b21\u6a21\u6570\u4e0d\u540c\u7684\u95ee\u9898\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(nlog^2n)$\n\n\u4ee5\u4e0a\u7b97\u6cd5\u65e0\u6cd5\u901a\u8fc7\u672c\u9898\uff0c\u9664\u975e\u4f60\u590d\u6742\u5ea6~~O(wys)~~\n\n\u6211\u4eec\u6ce8\u610f\u4e00\u4e2a\u5f88\u6709\u8da3\u7684\u5730\u65b9\uff0c\u6240\u6709\u6570\u5b57\u90fd\u5728[1,100]\u4e4b\u95f4\n\n\u6211\u4eec\u53d1\u73b0100\u4ee5\u5185\u8d28\u6570\u53ea\u670925\u4e2a\uff0c\u5e76\u4e14\uff1a\n\n$2^7=128>100$\n\n$3^5=243>100$\n\n$5^3=125>100$\n\n$7^3=343>100$\n\n$11^2=121>100$\n\n......\n\n2,3\u9700\u8981\u4e09\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u8bb0\u5f55\n\n5,7\u9700\u8981\u4e24\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u8bb0\u5f55\n\n\u5176\u4ed6\u8d28\u6570\u90fd\u53ea\u7528\u4e00\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u8bb0\u5f55\n\n3*2+2*2+1*21=31\n\n\u8bb0\u5f55\u6240\u6709\u8d28\u6570\u7684\u6b21\u6570\u53ea\u9700\u898131\u4f4d\uff0c\u521a\u597d1\u4e2aint\u5c31\u591f\n\n\u7136\u540e\u53d6min\u548cmax\u90fd\u53ef\u4ee5\u7528\u4f4d\u8fd0\u7b97\u4f18\u5316\n\n\u4ee5\u4e0a\u6b65\u9aa4\u53ef\u4ee5\u5c06\u5408\u5e76\u7684\u590d\u6742\u5ea6\u4f18\u5316\u81f3O(1)\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(nlogn)$\n\n\u8fd9\u6837\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\n\n\u5176\u5b9e\u8fd8\u6709\u4e00\u79cd\u7b97\u6cd5\u53ef\u4ee5\u8fc7\uff0c\u7531\u4e8e\u6211\u6570\u636e\u7684\u7279\u6b8a\u6027qwq\n\n\u8fd9\u4e2a\u9898\u662f\u4e0d\u662f\u4e5f\u5f88\u826f\u5fc3\u5440qwq\n\n@ _rqy \u8fd9\u4f4ddalao\u6709\u53e6\u4e00\u79cd\u505a\u6cd5\u53ef\u4ee5\u8fc7",
        "postTime": 1519901897,
        "uid": 39505,
        "name": "\u73ab\u8475\u4e4b\u8776",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4256 \u3010\u516c\u4e3b\u306e#19\u51c6\u5907\u6708\u8003\u3011"
    },
    {
        "content": "\u5728\u8fd9\u91cc\u771f\u7684\u60f3\u8bf4\u8bf4\u8fd9\u6b21\u5bf9\u51fa\u9898\u4eba\u6709\u70b9\u610f\u89c1\u7684\u5730\u65b9.....\n\n~~1) \u6bd4\u8d5b\u65f6\u95f4\u795e\u8e0f\u9a6c10:00\u523015:00\uff0c \u4f60\u8ba9\u6211\u4eec\u65e9\u4e0a\u8981\u8bad\u7ec3\u4e2d\u5348\u5403\u8fc7\u996d\u9700\u8981\u5348\u4f11\u7684\u4eba\u600e\u4e48\u6d3b\uff1f~~\n\n2\uff09\u5173\u4e8e\u8fd9\u4e2a\u9898\n\n\u2460 \u8fd9\u4e2a\u9898\u89e3\u662f\u4e0d\u5b8c\u7f8e\u7684\uff0c$6 + 4 + 2 + 2 + 1 \\times 21 = 35$\u4e2a\u8d28\u56e0\u5b50\u660e\u660e\u53ef\u4ee5\u7528long long\uff0c\u7a7a\u95f4\u4e5f\u6ca1\u88ab\u5361\uff0c\u4e3a\u4ec0\u4e48\u8981\u7528int\u5462\uff1f \u5982\u679c\u4f60\u7528\u4e8c\u8fdb\u5236\u5b58\u50a82\u548c3\u7684\u6570\u76ee\u663e\u7136\u662f\u4e0d\u80fd\u76f4\u63a5\u7528\u4e00\u6b21\u4e0e\u8fd0\u7b97\u6216\u8005\u6216\u8fd0\u7b97\u6765\u505a\u7684\uff0c\u5fc5\u987b\u8981\u8001\u8001\u5b9e\u5b9e\u75286\u4f4d\u548c4\u4f4d\u6765\u505a\u8fd9\u4e2a\u624d\u80fd\u5b9e\u73b0\u4e00\u6b21\u4e0e\u548c\u4e00\u6b21\u6216\u89e3\u51b3\u95ee\u9898.... \n\n\u2461 \u9898\u76ee\u91cc\u9762\u6a21\u6570\u6ca1\u8bf4\uff0c\u4f46\u4e25\u91cd\u6000\u7591\u662f\u5077\u61d2\u968f\u673a\u5f04\u4e86\u4e00\u4e9b\u5c0f\u6a21\u6570\uff0c\u4e0d\u4ec5\u7528p = 1\u8fd9\u79cd\u6781\u7aef\u60c5\u51b5\u628a\u6211\u4ece100\u5206\u5361\u523010\u5206\u8fd8\u6d6a\u8d39\u62112h+\u6765\u8c03\u8bd5\uff08\u4e5f\u7b97\u662f\u957f\u8bb0\u6027\u4e86\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u8f93\u51fa\u7b54\u6848\u7684\u65f6\u5019\u4e00\u5b9a\u8981\u53d6\u6a21\u4e0d\u7136\u4f1a\u8f93\u51fa1\uff09\uff0c\u800c\u4e14\u8fd8\u653e\u4e86\u4e00\u4e2a\u6a21\u6570\u7a0d\u5fae\u5927\u70b9\u5c31RE\u7684\u8001\u54e5\uff08\u6ca1\u9519\uff0c\u8bf4\u7684\u5c31\u662f\u7b2c\u4e8c\u7bc7\uff09 \u901a\u8fc7\u4e86\u3002\n\n\u8a00\u5f52\u6b63\u4f20\uff0c\u5176\u5b9e\u6211\u7684\u601d\u8def\u548c\u51fa\u9898\u4eba\u662f\u4e00\u81f4\u7684\uff0c\u53ea\u662f\u6211\u9009\u62e9\u8001\u8001\u5b9e\u5b9e\u7528LL \u6765\u8bb0\u5f55\u72b6\u6001\uff0c\u4f7f\u7528\u4e8635\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u6765\u8868\u793a\u8d28\u56e0\u5b50\u5e76\u4e14\u5728\u5408\u5e76\u7684\u65f6\u5019\u76f4\u63a5\u4e00\u6b21and\u548cor\u641e\u5b9a\uff0c\u867d\u7136\u8bf4\u56e0\u4e3a\u6211\u662fLL\u7684\u4f4d\u8fd0\u7b97\uff0c\u53ef\u80fd\u65f6\u95f4\u4e0a\u6ca1\u6709\u663e\u8457\u4f18\u4e8e\u6807\u7b97\uff08\u540cO2\u603b\u65f6\u95f4\u5feb\u4e86100ms\uff09\uff0c\u4f46\u662f\u6211\u60f3\u5199\u8d77\u6765\u8fd8\u662f\u6bd4\u8f83\u65b9\u4fbf\u7684\u5427\n\n\u4ee3\u7801\u4e0a\u9762... \u7528\u4e86long long\u4ee5\u540e\uff0c\u6211\u4e00\u4e2a\u7a7a\u683c\u515a\u53ea\u5199\u4e864.05k...\n\n\n```\n#include <bits/stdc++.h>\n#define MP make_pair\n#define FI first\n#define SE second\n#define LL long long\nusing namespace std;\nconst int maxn = 300010;\nconst int ss[25] = {2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97};\nconst int cal[35] = {2,2,2,2,2,2,3,3,3,3,5,5,7,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97};\ninline LL num(LL q,LL mo)\n{\n    int res = 1;\n    for (int i = 0; i < 35 && q; ++i, q >>= 1) if (q&1) res = 1LL * res * cal[i] %mo;\n    return res;\n}\ninline LL fchange(int p)\n{\n    LL res = 0;\n    for (int i = 0; i < 25; ++i)\n    {\n        int num = 0;\n        while (p % ss[i] == 0) num ++, p /= ss[i];\n        if (i == 0) for (int j = 0; j < num; ++j) res |= 1LL<<j;\n        else if (i == 1) for (int j = 0; j < num; ++j) res |= 1LL<<(j + 6);\n        else if (i == 2) for (int j = 0; j < num; ++j) res |= 1LL<<(j + 10);\n        else if (i == 3) for (int j = 0; j < num; ++j) res |= 1LL<<(j + 12);\n        else if (num) res |= 1LL <<(i + 10);\n        if (p == 1) break;\n    }\n    return res;\n\n}\nstruct node\n{\n    LL g[maxn <<2]={0}, lc[maxn <<2]={0},lz[maxn << 2]={0};\n    inline void init(){memset(lz,0,sizeof(lz));}\n    inline void update(int x)\n    {\n        if (lz[x] == -1) return;\n        lc[x<<1] = lc[x<<1|1] = g[x<<1] = g[x<<1|1] = lz[x];\n        lz[x <<1] = lz[x << 1|1] = lz[x];\n        lz[x] = -1;\n    }\n    inline void change(int now,int L,int R,int l,int r,LL c)\n    {\n        if (L == l && R == r) {lz[now] = c ;g[now] = lc[now] = c;return;}\n        int mid = L + R >> 1;\n        update(now);\n        if (r <= mid) change(now << 1,L, mid,l,r,c);\n        else if (l > mid) change(now << 1|1,mid+1,R,l,r,c);\n        else change(now<<1,L,mid,l,mid,c),change(now<<1|1,mid+1,R,mid+1,r,c);\t\n        int x = now;\n        lc[x] = lc[x<<1] | lc[x<< 1|1];\n        g[x] = g[x<<1] & g[x<< 1|1];\n    }\n    inline LL queryg(int now,int L,int R,int l,int r)\n    {\n        if (L == l && R == r) return g[now];\n        update(now);\n        int mid = L + R >>1;\n        if (r <= mid) return queryg(now<<1,L,mid,l,r);\n        else if (l > mid) return queryg(now<<1|1,mid+1,R,l,r);\n        else return queryg(now<<1,L,mid,l,mid)&queryg(now<<1|1,mid+1,R,mid+1,r);\n    }\n    inline LL queryl(int now,int L,int R,int l,int r)\n    {\n        if (L == l && R == r) return lc[now];\n        update(now);\n        int mid = L + R >> 1;\n        if (r <= mid) return queryl(now<<1,L,mid,l,r);\n        else if (l > mid) return queryl(now<<1|1,mid+1,R,l,r);\n        else return queryl(now<<1,L,mid,l,mid)|queryl(now<<1|1,mid+1,R,mid+1,r);\n        \n    }\n}nut;\ninline int read()\n{\n    int x = 0, f = 1;\n    char ch = 0;\n    for (;!isdigit(ch); ch = getchar()) if (ch == '-') f = -1;\n    for (;isdigit(ch); ch = getchar()) x = x * 10 +ch - 48;\n    return x * f;\n}\nint n,q;\nint main()\n{\n    nut.init();\n    n = read(); q = read();\n    for (int i = 1; i <= n; ++i) \n    {\n        int u = read();\n        nut.change(1,1,n,i,i,fchange(u));\n    }\n    while (q--)\n    {\n        char ch = 0;\n        while (!isalpha(ch)) ch = getchar();\n        int x = read(), y = read(),c = read();\n        if (ch != 'C' && c == 1) {puts(\"0\"); continue;}\n        if (ch == 'L') printf(\"%lld\\n\",num(nut.queryl(1,1,n,x,y),c));\n        else if (ch == 'G') printf(\"%lld\\n\",num(nut.queryg(1,1,n,x,y),c));\n        else if (ch == 'C') nut.change(1,1,n,x,y,fchange(c));\n        else\n        {\n            LL k = nut.queryg(1,1,n,x,y);\n            int res = 1,pre = 0;\n            for (int i = 0; i < 6; ++i) pre += (1<<i)&k?1:0;\n            res *= (1 +pre);pre = 0;\n            for (int i = 6; i < 10; ++i) pre += (1<<i)&k?1:0;\n            res *= (1+pre);pre = 0;\n            for (int i = 10; i < 12; ++i) pre += (1<<i)&k?1:0;\n            res *= (1+pre); pre = 0;\n            for (int i = 12; i < 14; ++i) pre += (1<<i)&k?1:0;\n            res *= (1+pre);  res %= c;\n            for (int i = 14; i < 35; ++i) if (k>>i&1) res = 1LL * 2 * res % c;\n            printf(\"%d\\n\",res);\n        }\n     } \n}\n\n```\n\n\n\n",
        "postTime": 1520093607,
        "uid": 47764,
        "name": "Maniac\u4e36\u575a\u679c",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4256 \u3010\u516c\u4e3b\u306e#19\u51c6\u5907\u6708\u8003\u3011"
    },
    {
        "content": "\u7ebf\u6bb5\u6811+\u72b6\u6001\u538b\u7f29\n\n\u6bd4\u6807\u7a0b\u77ed+\u597d\u5199\n\n\u7f16\u7a0b\u96be\u5ea6\uff1aNOIP\u63d0\u9ad8\n\n~~\u6bd4\u6807\u7a0b\u6162~~\uff08\u53ef\u80fd\u662f\u56e0\u4e3a\u61d2\u5f97\u52a0\u4f18\u5316\uff09\n\n\u5bf9\u4e8e\u4e00\u4e2a[1,100]\u7684\u5b50\u96c6\uff0c\u6c42lcm\u3001gcd\u548c\u516c\u56e0\u6570\u4e2a\u6570\u5e94\u8be5\u662f\u4e00\u4e2a\u5f88\u5bb9\u6613\u7684\u4e8b\u60c5\n\n\u56e0\u6b64\u672c\u9898\u7684\u5173\u952e\u5728\u6570\u5217\u52a8\u6001\u4fee\u6539\u7684\u60c5\u51b5\u4e0b\u6c42\u5b50\u4e32\u7684\u96c6\u5408\n\n\u533a\u95f4\u4fee\u6539+\u533a\u95f4\u67e5\u8be2\uff0c\u79d2\u60f3\u5230\u7ebf\u6bb5\u6811\uff0c\u7ed3\u70b9\u8868\u793a\u8be5\u533a\u95f4\u5185\u662f\u5426\u5b58\u5728\u8fd9\u4e2a\u6570\n\n\u4f46\u7a7a\u95f4\u590d\u6742\u5ea6\u662fO\uff08100*4n\uff09\uff0c\u7a7a\u95f4\u4e0d\u591f\uff08\u53ef\u4ee5\u7528bool\u6570\u7ec4\uff0c\u4f46\u65f6\u95f4\u4f1a\u8d85\uff09\n\n\u56e0\u4e3a\u53ea\u9700\u8981\u5b58\u50a8\u662f\u5426\u5b58\u5728\uff0c\u76f4\u63a5\u72b6\u6001\u538b\u7f29\uff0c\u6bcf\u4e2a\u7ed3\u70b9\u8868\u793a\u4e0d\u5927\u4e8e32\u4e2a\u6570\uff08\u6211\u9009\u62e9\u7684\u662f20\u4e2a\uff09\n\n\u8fd8\u6709\u4e00\u4e2a\u4f18\u5316\uff0c\u56e0\u4e3a\u6bcf\u6b21\u4fee\u6539\u90fd\u662f\u76f8\u540c\u7684\u6570\uff0c~~\u800c\u4e14\u6570\u636e\u662f\u968f\u673a\u751f\u6210\u7684\uff0c~~\u53ef\u4ee5\u52a0\u4e00\u4e2a\u6807\u8bb0\n\n\u7a7a\u95f4\u590d\u6742\u5ea6O\uff0820n\uff09\uff0c\u65f6\u95f4\u590d\u6742\u5ea6O\uff08qlogn\uff09\n\n\n**\u4e0b\u9762\u662f\u4ee3\u7801\uff0c\u770b\u4e0d\u61c2\u53ef\u4ee5\u79c1\u4fe1\u6211\u3002**\n\n```cpp\n#include<cstdio>\n#include<cstring>\nint a,b,c,d,e,f,g,h,x[1100000][10]={0},w[200]={0},u[200]={0},v[200]={0},oa[200]={0},ob[200]={0},oc[200]={0};\nchar z;\nvoid sc(int j,int k,int l)\n{\nint p,i;\nif(k==l)\n{\n    scanf(\"%d\",&c);\n    x[j][u[c]]=v[c];\n}\nelse\n{\n    p=(k+l)/2;\n    sc(2*j,k,p);\n    sc(2*j+1,p+1,l);\n    for(i=1;i<=5;i++)\n    {\n        x[j][i]=x[2*j][i]|x[2*j+1][i];\n    }\n}\n}\nvoid xf(int j,int k,int l)\n{\nint p,i;\np=x[k][0]=x[l][0]=x[j][0];\nfor(i=1;i<=5;i++)\n{\n    x[k][i]=x[l][i]=0;\n}\nx[k][u[p]]=x[l][u[p]]=v[p];\nx[j][0]=0;\n}\nvoid xg(int j,int k,int l,int r,int s)\n{\nint p,i;\nif((r<=k)&&(l<=s))\n{\n    for(i=1;i<=5;i++)\n    {\n        x[j][i]=0;\n    }\n    x[j][u[e]]=v[e];\n    x[j][0]=e;\n}\nelse\n{\n    p=(k+l)/2;\n    if(x[j][0]!=0) xf(j,2*j,2*j+1);\n    if(r<=p) xg(2*j,k,p,r,s);\n    if(p<s) xg(2*j+1,p+1,l,r,s);\n    for(i=1;i<=5;i++)\n    {\n        x[j][i]=x[2*j][i]|x[2*j+1][i];\n    }\n}\n}\nvoid tj(int j,int k,int l,int r,int s)\n{\nint p,i;\nif((r<=k)&&(l<=s))\n{\n    for(i=1;i<=5;i++)\n    {\n        oa[i]|=x[j][i];\n    }\n}\nelse\n{\n    p=(k+l)/2;\n    if(x[j][0]!=0) oa[u[x[j][0]]]|=v[x[j][0]];\n    else\n    {\n        if(r<=p) tj(2*j,k,p,r,s);\n        if(p<s) tj(2*j+1,p+1,l,r,s);\n        for(i=1;i<=5;i++)\n        {\n            x[j][i]=x[2*j][i]|x[2*j+1][i];\n        }\n    }  \n}\n}\nint main()\n{\nint i,m,n;\nfor(i=1;i<=5;i++)\n{\n    a=1;\n    for(m=1;m<=20;m++)\n    {\n        u[i*20-20+m]=i;\n        v[i*20-20+m]=a;\n        a*=2;\n    }\n}\nscanf(\"%d%d\",&a,&b);\nsc(1,1,a);\nfor(i=1;i<=b;i++)\n{\n    scanf(\" %c%d%d%d\",&z,&c,&d,&e);\n    if(z=='C') xg(1,1,a,c,d);\n    else\n    {\n        f=0;\n        for(m=1;m<=5;m++)\n        {\n            oa[m]=0;\n        }\n        tj(1,1,a,c,d);\n        for(m=1;m<=100;m++)\n        {\n            if((oa[u[m]]&v[m])>0)\n            {\n                f++;\n                ob[f]=m;\n            }\n        }\n        if(z=='L')\n        {\n            for(m=2;m<=100;m++)\n            {\n                oc[m]=0;\n            }\n            for(m=1;m<=f;m++)\n            {\n                for(n=2;n<=ob[m];n++)\n                {\n                    g=0;\n                    while(ob[m]%n==0)\n                    {\n                        ob[m]/=n;\n                        g++;\n                    }\n                    if(oc[n]<g) oc[n]=g;\n                }\n            }\n            h=1;\n            for(m=2;m<=100;m++)\n            {\n                for(n=1;n<=oc[m];n++)\n                {\n                    h=h*m%e;\n                } \n            }\n            printf(\"%d\\n\",h%e);\n        }\n        else\n        {\n            g=0;\n            for(m=2;m<=ob[1];m++)\n            {\n                while(ob[1]%m==0)\n                {\n                    ob[1]/=m;\n                    g++;\n                    oc[g]=m;\n                }\n            }\n            for(m=2;m<=f;m++)\n            {\n                for(n=1;n<=g;n++)\n                {\n                    if(oc[n]!=0)\n                    {\n                        if(ob[m]%oc[n]==0) ob[m]/=oc[n];\n                        else oc[n]=0; \n                    }\n                }\n            }\n            if(z=='G')\n            {\n                h=1;\n                for(m=1;m<=g;m++)\n                {\n                    if(oc[m]!=0) h=h*oc[m]%e;\n                }\n                printf(\"%d\\n\",h%e);\n            }\n            if(z=='S')\n            {\n                h=1;\n                f=0;\n                n=0;\n                for(m=1;m<=g;m++)\n                {\n                    if(oc[m]!=0)\n                    {\n                        if(f==oc[m]) n++;\n                        else\n                        {\n                            h=h*(n+1)%e;\n                            f=oc[m];\n                            n=1;\n                        }\n                    }\n                }\n                h=h*(n+1)%e;\n                printf(\"%d\\n\",h%e);\n            }\n        }\n        \n    }\n}\n}\n```",
        "postTime": 1519959230,
        "uid": 20909,
        "name": "\u9a6c\u5fc5\u8fb0",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4256 \u3010\u516c\u4e3b\u306e#19\u51c6\u5907\u6708\u8003\u3011"
    },
    {
        "content": "\u89c2\u5bdf\u9898\u9762$,$\u9700\u8981\u7ef4\u62a4\u533a\u95f4$gcd$\u548c$lcm.$\n\n\u503c\u57df\u662f$[1,100],$ $[1,100]$\u8303\u56f4\u5185\u7684$gcd$\u53ef\u4ee5\u4e8b\u5148\u9884\u5904\u7406\u51fa\u6765\u7136\u540e\u53ef\u4ee5$O(1)$\u67e5\u8be2$.$\n\n$lcm$\u7684\u8bdd$,$\u5c31\u5fc5\u987b\u8bb0\u5f55\u6bcf\u4e2a\u8d28\u56e0\u5b50\u7684\u6b21\u6570$.$\n\n\u4e0d\u96be\u53d1\u73b0$2^7=128>100,3^5=243>100,5^3=125>100,7^3=343>100,11^2=121>100$\n\n\u6240\u4ee5$,$ $2$ \u548c $3$ \u5404\u81ea\u7528 $3$ \u4e2a\u4e8c\u8fdb\u5236\u4f4d $,$ $5$ \u548c $7$ \u5404\u7528 $2$ \u4e2a\u4e8c\u8fdb\u5236\u4f4d $,$ \u5269\u4e0b\u7684 $21$ \u4e2a\u8d28\u6570\u5404\u7528 $1$ \u4e2a\u4e8c\u8fdb\u5236\u4f4d $,$ \u4e00\u5171\u7528 $31$ \u4e2a\u4e8c\u8fdb\u5236\u4f4d $,$ \u7528\u4e00\u4e2a $int$ \u5b58\u6b63\u597d\u80fd\u5b58\u4e0b$.$\n\n\u5e76\u4e14\u901a\u8fc7$O(1024^2)$\u9884\u5904\u7406\u53ef\u4ee5\u505a\u5230$O(1)$\u5408\u5e76\u8fd9\u4e2a\u4fe1\u606f$.$\n\n\u5904\u7406\u5b8c\u8fd9\u4e9b\u4fe1\u606f\u4e4b\u540e$,$\u76f4\u63a5\u4e0a\u7ebf\u6bb5\u6811\u5c31\u597d\u4e86$.$ $O(1024^2+nlogn)$\n\n-------\n\n\u53c8\u53ca$:$\u5361\u5230$545ms$\u4e4b\u540e\u6240\u6709\u7684\u4f18\u5316\u90fd\u53d8\u6210\u4e86\u8d1f\u4f18\u5316$...$\u90a3\u4f4d$500ms$\u7684\u795e\u4ed9\u662f\u600e\u4e48\u5361\u5230\u7684$?$\u80fd\u5426\u8d50\u6559$,$\u5728\u4e0b\u611f\u6fc0\u4e0d\u5c3d$!$\n\n-----\n\n\u4ee3\u7801$:$\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ninline void read(int &x){\n\tstatic char ch; x = 0,ch = getchar(); while (!isdigit(ch)) ch = getchar();\n\twhile (isdigit(ch)) x = x * 10 + ch - '0',ch = getchar();\n}\ninline int Getop(){\n\tstatic char ch; ch = getchar(); while (!isalpha(ch)) ch = getchar();\n\treturn ((ch == 'L' || ch == 'G')) ? (ch == 'L' ? 1 : 2) : (ch == 'C' ? 3 : 4);\n}\ninline void write(int x){ if (x > 9) write(x/10); putchar(x%10+'0'); }\nconst int N = 300001,p[] = {11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97};\nint d[101],Gcd[101][101],v[101],FF[1024][1024],num[1024];\ninline int Get(int t,int p){ static int c; c = 0; while (!(t%p)) t/=p,++c; return c; }\ninline int power(int x,int y){ static int r; r = 1; while (y){ if (y&1) r*=x; x*=x,y>>=1; } return r; }\ninline void init(){\n\tregister int i,j;\n\tfor (i = 1; i <= 100; ++i) for (j = 1; j <= i; ++j) if (!(i%j)) ++d[i];\n\tfor (i = 0; i <= 100; ++i) for (j = 0; j <= 100; ++j) Gcd[i][j] = __gcd(i,j);\n\tfor (i = 1; i <= 100; ++i){\n\t\tv[i] = Get(i,2) | (Get(i,3)<<3) | (Get(i,5)<<6) | (Get(i,7)<<8);\n\t\tfor (j = 0; j < 21; ++j) if (!(i%p[j])){ v[i] |= 1<<10+j; break; }\n\t}\n\tfor (i = 0; i < 1024; ++i) for (j = 0; j < 1024; ++j)\n\tFF[i][j] = max(i&7,j&7) | ((max(i&63,j&63)>>3)<<3) | ((max(i&255,j&255)>>6)<<6) | ((max(i,j)>>8)<<8);\n\tfor (i = 0; i < 1024; ++i)\n\tnum[i] = power(2,i&7) * power(3,(i&63)>>3) * power(5,(i&255)>>6) * power(7,i>>8);\n}\ninline int F(int x,int y){ return FF[x&1023][y&1023] + ((x|y)&2147482624); }\ninline int calc(int x,int mod){\n\tstatic int r,i;\n\t//\u8fd9\u4e2a\u5730\u65b9r\u5e94\u8be5\u5f00long long,\u4f46\u662f\u4e3a\u4e86\u5361\u5e38\u6211\u6682\u65f6\u6539\u6210\u4e86int \n\tfor (r = num[x&1023] % mod,x >>= 10,i = 0; i < 21 && x; ++i,x>>=1) if (x&1) r = r * p[i] % mod;\n\treturn r;\n}\nint a[N],Gc[N<<2],Lc[N<<2],tag[N<<2];\n#define up(o) Gc[o] = Gcd[Gc[o<<1]][Gc[o<<1|1]],Lc[o] = F(Lc[o<<1],Lc[o<<1|1])\n#define Tag(o,x) tag[o] = Gc[o] = x,Lc[o] = v[x]\n#define down(o) if (tag[o]) Tag(o<<1,tag[o]),Tag(o<<1|1,tag[o]),tag[o] = 0\ninline void Build(int o,int l,int r){\n\tif (l == r){ Gc[o] = a[l],Lc[o] = v[a[l]]; return; }\n\tint mid = l+r>>1; Build(o<<1,l,mid); Build(o<<1|1,mid+1,r); up(o); \n}\nint ll,rr,vv;\ninline void Add(int o,int l,int r){\n\tif (ll <= l && rr >= r){ Tag(o,vv); return; }\n\tdown(o); int mid = l+r>>1; if (ll <= mid) Add(o<<1,l,mid); if (rr > mid) Add(o<<1|1,mid+1,r); up(o);\n}\nint qlcm;\ninline void Ask1(int o,int l,int r){\n\tif (tag[o] || (ll <= l && rr >= r)){ qlcm = F(qlcm,Lc[o]); return; }\n\tint mid = l+r>>1; if (ll <= mid) Ask1(o<<1,l,mid); if (rr > mid) Ask1(o<<1|1,mid+1,r);\n}\nint qgcd;\ninline void Ask2(int o,int l,int r){\n\tif (tag[o] || (ll <= l && rr >= r)){ qgcd = Gcd[qgcd][Gc[o]]; return; }\n\tint mid = l+r>>1; if (ll <= mid) Ask2(o<<1,l,mid); if (rr > mid) Ask2(o<<1|1,mid+1,r);\n}\nint n,q;\nint main(){\n\tint i,op,mod,ans;\n\tinit(),read(n),read(q);\n\tfor (i = 1; i <= n; ++i) read(a[i]); Build(1,1,n);\n\twhile (q--){\n\t\top = Getop(),read(ll),read(rr);\n\t\tif (op == 3){ read(vv),Add(1,1,n); continue; }\n\t\tread(mod);\n\t\tif (op == 1) qlcm = 0,Ask1(1,1,n),ans = calc(qlcm,mod);\n\t\telse qgcd = 0,Ask2(1,1,n),ans = (op == 2 ? qgcd : d[qgcd]) % mod;\n\t\twrite(ans),putchar('\\n');\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1589118511,
        "uid": 52518,
        "name": "s_r_f",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P4256 \u3010\u516c\u4e3b\u306e#19\u51c6\u5907\u6708\u8003\u3011"
    }
]
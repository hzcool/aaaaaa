[
    {
        "content": "## \u524d\u7f6e\u77e5\u8bc6\uff1a\n\n~~\u6811\u5f62DP~~\n\n\u5176\u5b9e\u65e0\u6240\u8c13\uff0c\u548c\u666e\u901aDP\u5dee\u4e0d\u591a\n\n------------\n\n## \u5927\u81f4\u601d\u8def\uff1a\n\n\n------------\n\n\n\u770b\u5230**\u4ef7\u503c\u548c\u91cd\u91cf**\uff0c~~\u4e0d\u7ba1\u4e09\u4e03\u4e8c\u5341\u4e00~~\uff0c\u76f4\u63a5\u8003\u8651\u80cc\u5305\n\n\u7136\u540e\u518d\u770b\u4e00\u4e0b\u6570\u636e\u8303\u56f4\uff0cvalue\u548cweight\u7684\u8303\u56f4\u6781\u5927\uff0c\u4e0d\u80fd\u7528\u4f20\u7edf\u7684\u4ee5\u4ef7\u503c\u4f5c\u4e3a\u4e0b\u6807\u7684\u80cc\u5305\n\n\u4f46\u662fn\u5f88\u5c0f\uff0c\u4ec5\u5230100\uff0c\u6240\u4ee5\u8003\u8651\u4ee5\u4ef6\u6570\u4f5c\u4e3a\u4e0b\u6807\n\n------------\n\n## \u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n------------\n```cpp\n\u8bbef[u][i]\u8868\u793a:\n\u5728\u4ee5u\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\uff0c\u9009\u62e9i\u4e2a\u8282\u70b9\uff0c\u6240\u80fd\u5f97\u5230\u7684\u6700\u5927\u5e73\u5747\u503c\n```\n\n\u5f53\u7136\uff0c\u8bb0\u5f55\u6700\u5927\u5e73\u5747\u503c\u7684\u540c\u65f6\uff0c\u4e5f\u8981\u8bb0\u5f55\u6743\u503c\u548c\u4e0e\u91cd\u91cf\u548c\uff0c\u65b9\u4fbf\u8f6c\u79fb\n\n\u90a3\u4e48\u81ea\u7136\u6709\uff1a\n\n```cpp\n\u5bf9\u4e8eu\u7684\u6bcf\u68f5\u5b50\u6811v:\nf[u][j]=f[v][k]+f[u][j-k];\n\u5176\u4e2d\uff0cj-k>=1\uff0c\u56e0\u4e3a\u8981\u4fdd\u8bc1\u8054\u901a\uff0c\u6240\u4ee5u\u8fd9\u4e2a\u8282\u70b9\u662f\u5fc5\u9009\u7684\n\n```\n------------\n\n## \u5177\u4f53\u505a\u6cd5\uff1a\n\n------------\n\u9996\u5148\uff0c\u6211\u5f00\u4e86\u4e00\u4e2a\u7ed3\u6784\u4f53\uff0c\u7528\u4e8e\u5b58\u50a8\u72b6\u6001\n\n```cpp\n\nstruct node{\n\tint v,w;double ave;//\u8f6c\u79fb\u72b6\u6001\u7684\u6743\u503c\u548c\uff0c\u91cd\u91cf\u548c\uff0c\u5e73\u5747\u503c\n\tnode(){}\n\tnode(int a,int b,double p):v(a),w(b),ave(p){}\n}f[E][E];\n```\n\n\u7136\u540edfs\n\n```\nvoid dfs(int u,int fa){\n\tf[u][1]=node(val[u],wei[u],(double)val[u]/wei[u]);//\u521d\u59cb\u5316\n\tfor(int i=head[u];i;i=nex[i])\n\t\tif(to[i]!=fa){//\u4e0d\u80fd\u8d70\u56de\u7236\u4eb2\n\t\t\tdfs(to[i],u);//\u5148\u904d\u5386\u5b50\u6811\n\t\t\tfor(int j=n;j>1;j--){//\u6ce8\u610f\uff0c\u8fd9\u91cc\u4e00\u5b9a\u8981\u9006\u5e8f\uff0c\u5426\u5219\u91cd\u590d\u9009\u62e9\u8be5\u68f5\u5b50\u6811\u7684\u70b9\n\t\t\t\tfor(int k=1;k<=j;k++){\n\t\t\t\t\tnode p=f[to[i]][j-k];\n\t\t\t\t\tnode q=f[u][k];\n\t\t\t\t\tdouble ave=(double)(p.v+q.v)/(p.w+q.w);\n\t\t\t\t\tif(ave>=f[u][j].ave){\n\t\t\t\t\t\tf[u][j]=node(p.v+q.v,p.w+q.w,ave);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n}\n```\n\n\u597d\u4e86\uff0c\u5b8c\u4e86\n\n------------\n\n## \u6700\u7ec8\u7684\u4ee3\u7801\n\u590d\u6742\u5ea6O(n^3)\n```cpp\n#include<bits/stdc++.h>\n#define E 209\n#define inf 1e8\nusing namespace std;\ninline int read(){\n\tint x=0;char c=getchar();\n\twhile(!isdigit(c)) c=getchar();\n\twhile(isdigit(c)) x=x*10+c-48,c=getchar();\n\treturn x;\n}\nint n,kk,m,wei[E],val[E];\nint head[E],nex[E],to[E],cnt;\ninline void add(int u,int v){\n\tnex[++cnt]=head[u];\n\thead[u]=cnt;to[cnt]=v;\n}\nstruct node{\n\tint v,w;double ave;\n\tnode(){}\n\tnode(int a,int b,double p):v(a),w(b),ave(p){}\n}f[E][E];\nvoid dfs(int u,int fa){\n\tf[u][1]=node(val[u],wei[u],(double)val[u]/wei[u]);\n\tfor(int i=head[u];i;i=nex[i])\n\t\tif(to[i]!=fa){\n\t\t\tdfs(to[i],u);\n\t\t\tfor(int j=n;j>1;j--){\n\t\t\t\tfor(int k=1;k<=j;k++){\n\t\t\t\t\tnode p=f[to[i]][j-k];\n\t\t\t\t\tnode q=f[u][k];\n\t\t\t\t\tdouble ave=(double)(p.v+q.v)/(p.w+q.w);\n\t\t\t\t\tif(ave>=f[u][j].ave){\n\t\t\t\t\t\tf[u][j]=node(p.v+q.v,p.w+q.w,ave);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n}\nint main(){\n\tn=read(),kk=read();\n\tfor(int i=1;i<=n;i++) val[i]=read();\n\tfor(int i=1;i<=n;i++) wei[i]=read();\n\tfor(int i=1,v,u;i<n;i++){\n\t\tu=read(),v=read();\n\t\tadd(u,v);add(v,u);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tf[i][j]=node(-inf,inf,-inf);\n\tdfs(1,0);double ans=0.0;\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=kk;j<=n;j++){\n//\t\t\tcout<<i<<\" \"<<j<<\" \"<<f[i][j].v<<\" \"<<f[i][j].w<<endl;\n\t\t\tans=max(ans,f[i][j].ave);\n\t\t}\n\tprintf(\"%.2f\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1562156151,
        "uid": 139717,
        "name": "\u9752\u8471",
        "ccfLevel": 9,
        "title": "P3874 [TJOI2010]\u780d\u6811"
    },
    {
        "content": "## \u524d\u7f6e\n\n\u6811\u5f62 dp\uff0c\u4e8c\u5206\u3002\n\n## \u9898\u610f\n\n\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u6811\u4e0a\u80cc\u5305\uff0c\u9700\u8981\u9009\u4e0d\u5c11\u4e8e $k$ \u4e2a\u7269\u54c1\uff0c\u6bcf\u4e2a\u7269\u54c1\u6709\u4e00\u4e2a\u91cd\u91cf $w$ \u548c\u4ef7\u503c $v$\uff0c\u6c42\u6027\u4ef7\u6bd4\u6700\u5927\u503c\u3002\n\n## \u5206\u6790\n\n\u65e2\u7136\u662f\u6027\u4ef7\u6bd4\uff0c\u663e\u7136\u662f\u5206\u6570\u89c4\u5212\u3002\n\n\u5148\u4ecb\u7ecd\u4e00\u4e0b\u5206\u6570\u89c4\u5212\u662f\u4ec0\u4e48\uff1a\n\n\u6211\u4eec\u4e8c\u5206\u8fd9\u4e2a\u6700\u5927\u6027\u4ef7\u6bd4\u3002\n\n\u5047\u8bbe\u5f53\u524d\u679a\u4e3e\u5230 $mid$\uff0c\u5219\u6211\u4eec\u5c06\u6bcf\u4e2a\u70b9\u7684\u4ef7\u503c\u4fee\u6539\u4e3a \n\n$$v-mid \\times w$$\n\n\u7136\u540e\u6211\u4eec\u6b63\u5e38\u505a\u6811\u5f62 dp\uff0c\u7136\u540e\u7edf\u8ba1\u4e00\u4e0b\u662f\u5426\u6709\u4ef7\u503c\u5927\u4e8e\u7b49\u4e8e $0$ \u7684\u5373\u53ef\u3002\n\n\u90a3\u4e48\u4e3a\u4ec0\u4e48\u8fd9\u6837\u5462\uff1f\n\n\u5047\u8bbe\u6027\u4ef7\u6bd4\u4e3a $g$\uff0c\u6211\u4eec\u9009\u7684\u662f \n\n$$p_1,p_2,...p_s( k\\le s \\le n)$$\n\n\u5219\u6211\u4eec\u6709\n\n$$\\frac {\\sum_{i=1}^s{v_{p_i}}}{\\sum_{i=1}^s{w_{p_i}}}=g$$\n\n\u8fdb\u800c\u53ef\u4ee5\u63a8\u51fa\n\n$$\\sum_{i=1}^s{w_{p_i} \\times g}=\\sum_{i=1}^s{v_{p_i}}$$\n\n\u90a3\u4e48\uff0c\u5f53\u6211\u4eec\u5b9a\u4e49\u4ef7\u503c $val_i=v_i-w_i \\times g$ \u65f6\uff0c\u6709\n\n$$\\sum_{i=1}^s{val_{p_i}}=0\\ge0$$ \n\n\u6210\u7acb\uff0c\u6545\u4ee5\u4e0a\u7b97\u6cd5\u6b63\u786e\u3002\n\n## \u5b9e\u73b0\n\n\u6bd4\u8f83\u597d\u8bf4\uff0c\u5148\u4e8c\u5206\u51fa\u6765 $g$\uff0c\u7136\u540e\u8dd1\u6811\u5f62\u80cc\u5305\u5373\u53ef\uff0c\u6ce8\u610f\u8981\u4e00\u8fb9\u8ba1\u7b97\u5927\u5c0f $size_p$ \u4e00\u8fb9\u8dd1\u80cc\u5305\uff0c\u4e0d\u7136\u590d\u6742\u5ea6 $O(n^3)$\uff0c\u52a0\u4e0a\u4e8c\u5206\u53ef\u80fd TLE\u3002\uff08\u867d\u7136\u6211\u6ca1\u8bd5\u8fc7\uff09\n\n\u7136\u540e\u5c31\u662f\u6ce8\u610f\u628a\u7cbe\u5ea6\u5361\u5230 $0.0001$\uff0c\u4e0d\u7136\u4f1a WA\u3002\n\n## Code\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int N = 110;\ntypedef double db;\n\nint ver[N * 2], nxt[N * 2], hd[N], idx;\n\ninline void add (int x, int y) {\n\tver[++idx] = y;\n\tnxt[idx] = hd[x];\n\thd[x] = idx;\n}\n\nint n, w[N], v[N], k, s[N];\nbool mk[N];\ndb dp[N][N], g[N];\n\nvoid dfs (int u, int fa) {\n\tdp[u][0] = 0; dp[u][1] = g[u]; s[u] = 1;\n\tfor (int i = hd[u]; i ;i = nxt[i]) {\n\t\tint y = ver[i];\n\t\tif (y == fa) continue;\n\t\tdfs(y, u);\n\t\ts[u] += s[y];   \t\t\t\t\t\t\t\t\t\t  //\u6ce8\u610fsize\u548cdp\u8981\u4e00\u8d77\u7b97 \n\t\tfor (int j = min(n, s[u]);j >= 1;j--) {                   //\u5904\u7406\u80cc\u5305 \n\t\t\tfor (int z = 0;z <= min(j - 1, s[y]);z++) {\n\t\t\t\tdp[u][j] = max(dp[u][j], dp[u][j - z] + dp[y][z]);\n\t\t\t}\n\t\t}\n\t}\n}\n\nbool check (db x) {\n\tfor (int i = 1;i <= n;i++) g[i] = v[i] - x * w[i];                        //\u5904\u7406val \n\tfor (int i = 1;i <= n;i++) for (int j = 0;j <= n;j++) dp[i][j] = -200000;\n\tdfs(1, 0); \n\tdb res = -1;\n\tfor (int i = 1;i <= n;i++) for (int j = k;j <= n;j++) {\n\t\tres = max(res, dp[i][j]);\n\t}\n\tif (res >= 0) return 1;\n\treturn 0;\n}\n\nint main () {\n\tcin >> n >> k;\n\tfor (int i = 1;i <= n;i++) cin >> v[i];\n\tfor (int i = 1;i <= n;i++) cin >> w[i];\n\tfor (int i = 1;i < n;i++) {\n\t\tint x, y;\n\t\tcin >> x >> y;\n\t\tadd(x, y); add(y, x);\n\t}\n\tdb l = 0, r = 200000;           //\u4e8c\u5206 \n\twhile (r - l > 0.0001) {        //\u6ce8\u610f\u7cbe\u5ea6 \n\t\tdb mid = (l + r) / 2;\n\t\tif (check(mid)) l = mid;\n\t\telse r = mid - 0.0001;\n\t}\n\tprintf(\"%.2lf\", l);\n\treturn 0;\n} \n```\n",
        "postTime": 1668162127,
        "uid": 757990,
        "name": "zxh_mc",
        "ccfLevel": 0,
        "title": "P3874 \u780d\u6811 \u9898\u89e3"
    }
]
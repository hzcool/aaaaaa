[
    {
        "content": "## Solution\n\n\u8bbe $g_i$ \u8868\u793a\u7b2c $i$ \u8f86\u6c7d\u8f66\u5f00\u59cb\u5de5\u4f5c\u7684\u65f6\u95f4\uff0c$s_i$ \u8868\u793a $t_i$ \u7684\u524d\u7f00\u548c\u3002\n\n\u6709\u8f6c\u79fb\u65b9\u7a0b $g_i=g_{i-1}+\\max\\{s_jf_{i-1}-s_{j-1}f_i\\}$\u3002\n\n\u53ef\u4ee5\u66b4\u529b\u679a\u4e3e $j$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n^2)$\uff0c\u671f\u671b\u5f97\u5206 $40\\text{pts}$\u3002\n\n\u8003\u8651\u659c\u7387\u4f18\u5316\uff0c\u82e5 $j$ \u6ca1\u6709 $k$ \u4f18\uff0c\u5219\u6709 $s_jf_{i-1}-s_{j-1}f_i<s_kf_{i-1}-s_{k-1}f_i$\uff0c\u79fb\u9879\u53d8\u5f62\u53ef\u5f97 $\\frac{f_i}{f_{i-1}}<\\frac{s_k-s_j}{s_{k-1}-s_{j-1}}$\u3002\n\n$\\frac{f_i}{f_{i-1}}$ \u4e0d\u5355\u8c03\uff0c\u5219\u7ef4\u62a4\u659c\u7387\u5355\u8c03\u9012\u51cf\u7684\u4e0a\u51f8\u58f3\uff0c\u7136\u540e\u4e8c\u5206\u3002\n\n## Code\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#define N 100005\n#define ll long long\n#define db double\nusing namespace std;\nint n,m,t,l,r,mid,res,q[N];\nll a[N],b[N],f[N];\nint read()\n{\n    int res=0;char ch=getchar();\n    while (ch<'0'||ch>'9') ch=getchar();\n    while (ch>='0'&&ch<='9') res=(res<<1)+(res<<3)+(ch-'0'),ch=getchar();\n    return res;\n}\nll llread()\n{\n    ll res=0;char ch=getchar();\n    while (ch<'0'||ch>'9') ch=getchar();\n    while (ch>='0'&&ch<='9') res=(res<<1)+(res<<3)+(ch-'0'),ch=getchar();\n    return res;\n}\ndb xl(int x,int y) {return (a[x]-a[y])/(db)(a[x-1]-a[y-1]);}\nint main()\n{\n    n=read();m=read();\n    for (int i=1;i<=n;++i)\n        a[i]=llread(),a[i]+=a[i-1];\n    for (int i=1;i<=m;++i)\n        b[i]=llread();\n    for (int i=1;i<=n;++i)\n    {\n        while (t>1&&xl(i,q[t])>xl(q[t],q[t-1])) --t;\n        q[++t]=i;\n    }\n    f[1]=0;\n    for (int i=2;i<=m;++i)\n    {\n        l=0;r=t;res=0;\n        db x=b[i]/(db)b[i-1];\n        while (l<r)\n        {\n            mid=(l+r)>>1;\n            if (xl(q[mid+1],q[mid])>x) l=mid+1;\n            else r=mid;\n        }\n        f[i]=f[i-1]+a[q[l]]*b[i-1]-a[q[l]-1]*b[i];\n    }\n    printf(\"%lld\\n\",f[m]+a[n]*b[m]);\n    return 0;\n}\n```\n\n## Thank\n\n\u611f\u8c22 [\u5927\u4f6c\u7684\u535a\u5ba2](https://www.cnblogs.com/Extended-Ash/p/9477158.html)\u3002",
        "postTime": 1638003555,
        "uid": 166078,
        "name": "Thunder_S",
        "ccfLevel": 6,
        "title": "P7747 [COCI2011-2012#3] TRAKA"
    }
]
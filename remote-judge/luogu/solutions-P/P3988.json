[
    {
        "content": "[Youngsc](https://youngscc.github.io/)\n\n** \u4e00\u6ce2\u9898\u89e3 **  \n** \u5148\u5f00\u4e00\u4e2a\u6811\u72b6\u6570\u7ec4\u8bb0\u5f55\u6bcf\u4e00\u79cd\u724c\u7684\u6570\u91cf\uff080\u62161\uff09 **  \n** \u5bf9\u4e8e\u8be2\u95ee\u7684\u6d88$k$\u6b21\u4e4b\u540e\u724c\u5806\u9876\u7684\u724c\u6211\u4eec\u53ef\u4ee5\u8f6c\u5316\u4e3a\u8be2\u95ee\u4ece\u5f53\u524d\u724c\u5806\u9876\u7684\u724c\u8d77\u7b2c$k\\ mod\\ sum+1$\u5f20\u724c\u662f\u8c01\u5e76\u5220\u9664\u6389\u5b83\u540e\u5c06\u5176\u4e0b\u4e00\u5f20\u89c6\u4f5c\u724c\u5806\u9876 **  \n** \u90a3\u4e48\u6211\u4eec\u5206\u4e24\u7c7b\u8ba8\u8bba**  \n** \u5982\u679c\u5f53\u524d\u724c\u5806\u9876\u5230\u724c$n$\u7684\u724c\u603b\u6570\u5927\u4e8e$k\\ mod\\ sum+1$\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u5728\u724c\u9876\u5230$n$\u4e4b\u95f4\u4e8c\u5206\u7b2c$k\\ mod\\ sum+1$\u5f20\u724c**  \n** \u5426\u5219\u4e8c\u5206$1$\u5230\u724c\u5806\u9876$-1$\u4e4b\u95f4\u7684\u7b2c\uff08$k\\ mod\\ sum+1$-\u540e\u8fb9\u591a\u7684\u90a3\u4e9b\u724c\uff09\u5f20**  \n\n** \u5341\u5206\u62d7\u53e3\uff0c\u5c31\u4e0a\u4ee3\u7801\u5427 **  \n\n```cpp\n# include <bits/stdc++.h>\n# define R register\n# define N 700010\n# define inf 2000101900\n# define LL long long\n\nusing namespace std;\n\nint n,t[N],nxt[N],pre[N],p,tot,now=1;\n\ntemplate <typename T> inline void in(R T &a){\n    R char c = getchar();R T x=0,f=1;\n    while(!isdigit(c)) {if(c == '-') f=-1; c=getchar();}\n    while(isdigit(c)) x=(x<<1)+(x<<3)+c-'0',c = getchar();\n    a=x*f;\n}\n\ntemplate <typename T> inline void maxx(R T& a,const T b){a<b? a=b:0;}\n\ninline void add(R int x,R int sum){\n    while (x <= n) t[x] += sum,x += x&-x;\n}\n\ninline int qury(R int x){\n    R int ret = 0;\n    while (x) ret += t[x],x -= x&-x;\n    return ret;\n}\n\ninline int search(R int l,R int r,R int sum){\n    R int ret = 0;\n    while (l <= r)\n    {\n        // printf(\"%d %d \\n\",l,r);\n        R int mid = l+r>>1;\n        if (qury(mid) >= sum) ret = mid,r = mid-1;\n        else l = mid+1;\n    }\n    // printf(\">>>>>>%d\\n\",ret);\n    return ret;\n}\n\ninline int yg(){\n    // freopen(\"worma.in\",\"r\",stdin);\n    // freopen(\"worma.out\",\"w\",stdout);\n    in(n);\n    for (R int i=1; i<=n; ++i) t[i] = i&-i,pre[i] = i-1,nxt[i] = i+1; \\\\\u94fe\u8868\u65b9\u4fbf\u5bfb\u627e\u4e0b\u4e00\u5f20\u724c\n    pre[1] = n,nxt[n] = 1;\n    R int now = 1; \\\\\u5f53\u524d\u724c\u5806\u9876\n    tot = n;\n    for (R int i=1; i<=n; ++i)\n    {\n        in(p);\n        // printf(\"%d>>>\\n\",now);\n        p %= tot; \\\\tot\u8868\u793a\u724c\u5806\u91cc\u5269\u4e0b\u7684\u724c\u6570\n        p++;\n        R int sum = qury(n)-qury(now-1); \\\\\n        if (p > sum) printf(\"%d\\n\",now = search(1,now-1,p-sum))\\\\\u67e5\u8be2\u524d\u8fb9\uff0c\u51cf\u53bb\u540e\u8fb9\u591a\u51fa\u6765\u7684sum;\n        else printf(\"%d\\n\",now = search(now,n,p+qury(now-1))) \\\\\u7531\u4e8e\u662f\u5728\u6811\u72b6\u6570\u7ec4\u91cc\u4e8c\u5206\uff0c\u6240\u4ee5\u5c06\u724c\u5806\u9876\u524d\u8fb9\u7684\u6570\u91cf\u90fd\u52a0\u4e0a;\n        pre[nxt[now]] = pre[now];\n        nxt[pre[now]] = nxt[now];\n        add(now,-1);\\\\\u5220\u6389\u8fd9\u5f20\u724c\n        now = nxt[now];\\\\\u724c\u5806\u9876\u662f\u4e0b\u4e00\u5f20\n        tot--;\n    }\n    return 0;\n}\n\nint youngsc = yg();\n\nint main(){;}\n\n```\n",
        "postTime": 1519372178,
        "uid": 36282,
        "name": "Youngsc",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3988 \u3010[SHOI2013]\u53d1\u724c\u3011"
    },
    {
        "content": "[\u4f20\u9001\u95e8 qwq](https://www.luogu.com.cn/problem/P3988)\n\n\u672c\u9898\u89e3\u4f7f\u7528 FHQ-Treap\u3002\n\n\u663e\u7136\u6211\u4eec\u8981\u628a\u95ee\u9898\u8f6c\u5316\u4e3a\u5e73\u8861\u6811\u64c5\u957f\u7684\u5e8f\u5217\u95ee\u9898\u3002\n\n\u9996\u5148\u4f60\u9700\u8981\u638c\u63e1\u201c\u6309\u7167\u5927\u5c0f\u5bf9\u5e73\u8861\u6811\u8fdb\u884c\u5206\u88c2\u201d\uff0c\u6a21\u677f\uff1a[P3391 \u3010\u6a21\u677f\u3011\u6587\u827a\u5e73\u8861\u6811](https://www.luogu.com.cn/problem/P3391)\u3002\u8fd9\u6837\u5206\u88c2\u4e0b\u6765\u4e00\u68f5\u6811\uff0c\u5176\u4e2d\u5e8f\u904d\u5386\u5c31\u662f\u5176\u4ee3\u8868\u7684\u5e8f\u5217\u3002\n\n\u521d\u59cb\u5e8f\u5217\u4e3a $1,2,3,\u2026,n$\u3002\u806a\u660e\u7684\u4f60\u4e00\u5b9a\u53ef\u4ee5\u901a\u8fc7\u4e3e\u4f8b\u6216\u662f\u753b\u56fe\u7b49\u65b9\u6cd5\u53d1\u73b0\uff0c\u5bf9\u4e8e\u4e00\u6b21\u64cd\u4f5c\uff0c\u7ed9\u51fa $R$\uff0c\u5176\u5b9e\u5c31\u662f\u628a\u5e8f\u5217\u7684\u524d $R$ \u4e2a\u6570\u622a\u4e0b\u6765\u642c\u5230\u5e8f\u5217\u672b\u5c3e\u3002$R$ \u5982\u679c\u5927\u4e8e\u7b49\u4e8e\u5269\u4f59\u724c\u7684\u6570\u91cf\uff0c\u8981\u5bf9\u8fd9\u4e2a\u6570\u91cf\u53d6\u819c\u3002\u663e\u7136\u6b63\u786e\u6027\u6ca1\u6709\u95ee\u9898\u3002\n\n\u90a3\u4e48\u6bcf\u6b21\u64cd\u4f5c\uff0c\u6211\u4eec\u6309\u5927\u5c0f\u5206\u88c2\u51fa\u524d $R$ \u4e2a\u70b9\uff0c\u4e5f\u5c31\u662f\u5e73\u8861\u6811\u4e2d\u5e8f\u904d\u5386\u7684\u524d $R$ \u4e2a\u70b9\uff0c\u4e5f\u5c31\u662f\u5f53\u524d\u5e8f\u5217\u4e2d\u524d $R$ \u5f20\u724c\u7684\u7f16\u53f7\uff0c\u7136\u540e\u5c06\u5206\u88c2\u7684\u4e24\u9897\u6811\u5408\u5e76\uff0c\u6ce8\u610f\u7531\u4e8e\u662f\u628a\u8fd9\u4e00\u6bb5\u653e\u5230\u672b\u5c3e\uff0c\u6240\u4ee5 merge \u4f20\u53c2\u6570\u7684\u65f6\u5019\u5343\u4e07\u522b\u5199\u53cd\u3002~~\u5199\u53cd\u7684\u8bdd\u88c2\u5b8c\u539f\u6837\u5408\u5e76\u4f60\u5199\u4e2a\u5bc2\u5bde~~\u3002\u8fd9\u65f6\u5019\u53d1\u4e00\u5f20\u724c\uff0c\u4e5f\u5c31\u662f\u5e8f\u5217\u7684\u7b2c\u4e00\u4e2a\u6570\uff0c\u4e5f\u5c31\u662f\u5e73\u8861\u6811\u4e2d\u5e8f\u904d\u5386\u7684\u7b2c\u4e00\u4e2a\u6570\uff0c\u6240\u4ee5\u76f4\u63a5\u6309\u5927\u5c0f\u5206\u88c2\u51fa\u5927\u5c0f\u4e3a $1$ \u7684\u4e00\u68f5\u6811\uff0c\u7f16\u53f7\u5373\u8fd9\u5f20\u724c\u3002\u7136\u540e\u6839\u8282\u70b9\u76f4\u63a5\u8d4b\u503c\u4e3a\u5206\u51fa\u6765\u7684\u53e6\u4e00\u68f5\u6811\u7684\u6839\uff0c\u56e0\u4e3a\u53d1\u5b8c\u724c\u8fd9\u4e2a\u6570\u6211\u4eec\u5c31\u4e0d\u8981\u4e86\u3002\n\n$700000$ \u7684\u6570\u636e\u8303\u56f4\uff0c\u6570\u7ec4\u522b\u5f00\u5c0f\uff0c~~\u51fa\u9898\u4eba\u7d2f\u6b7b\u8377\u5b98\u3002~~\n\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nint read(){\n\tint ss=0,ww=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9'){\n\t\tif(ch=='-')\n\t\t\tww=-1;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9'){\n\t\tss=ss*10+ch-'0';\n\t\tch=getchar();\n\t}\n\treturn ss*ww;\n}\nint n,m;\nconst int N=700100;\nint root,cnt,ls[N],rs[N],sz[N],c[N];\nint newnode(){\n\tcnt++;\n\tc[cnt]=rand();\n\tsz[cnt]=1;\n\treturn cnt;\n}\nint x,y,z;\nvoid upd(int r){\n\tsz[r]=sz[ls[r]]+sz[rs[r]]+1;\n}\nvoid split(int r,int k,int &x,int &y){\n\tif(!r){\n\t\tx=0;\n\t\ty=0;\n\t\treturn;\n\t}\n\tif(sz[ls[r]]>=k){\n\t\ty=r;\n\t\tsplit(ls[r],k,x,ls[r]);\n\t}\n\telse{\n\t\tx=r;\n\t\tsplit(rs[r],k-sz[ls[r]]-1,rs[r],y);\n\t}\n\tupd(r);\n}\nint merge(int r1,int r2){\n\tif(!r1||!r2)\n\t\treturn r1+r2;\n\tif(c[r1]<=c[r2]){\n\t\trs[r1]=merge(rs[r1],r2);\n\t\tupd(r1);\n\t\treturn r1;\n\t}\n\telse{\n\t\tls[r2]=merge(r1,ls[r2]);\n\t\tupd(r2);\n\t\treturn r2;\n\t}\n}\nint main(){\n\tn=read();\n\tfor(int i=1;i<=n;i++)\n\t\troot=merge(root,newnode());\n\tint rest=n;\n\tfor(int i=1;i<=n;i++){\n\t\tint a;\n\t\ta=read();\n\t\ta%=rest;\n\t\trest--;\n\t\tif(a){\n\t\t\tsplit(root,a,x,y);\n\t\t\troot=merge(y,x);\n\t\t}\n\t\tsplit(root,1,x,y);\n\t\tprintf(\"%d\\n\",x);\n\t\troot=y;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1645348360,
        "uid": 140360,
        "name": "LKawaii",
        "ccfLevel": 0,
        "title": "P3988 \u9898\u89e3"
    },
    {
        "content": "\u9898\u76ee[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3988)\n\n\u6811\u72b6\u6570\u7ec4+\u4e8c\u5206+\u5438\u6c27\u8fc7\u4e86\u3002\n\n## \u6811\u72b6\u6570\u7ec4\n\n\u770b\u5230\u8fd9\u4e00\u9053\u9898\u6709\u5f39\u51fa\u64cd\u4f5c\uff08\u53d1\u724c\uff09\u548c\u5faa\u73af\u64cd\u4f5c\uff08\u6d17\u724c\uff09\uff0c\n\n\u7b2c\u4e00\u53cd\u5e94\u5c31\u662f\u6811\u72b6\u6570\u7ec4\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u7ef4\u62a4\u5f20\u724c\u662f\u5426\u88ab\u53d1\u51fa\uff0c\n\n\u90a3\u7ef4\u62a4\u8fd9\u4e2a\u6709\u4ec0\u4e48\u7528\u5462\u3002\n\n\u5047\u8bbe\u5f53\u524d\u7b2c\u4e00\u5f20\u724c\u662f $L$\uff0c\n\n\u5219\u6211\u4eec\u8981\u7684\u662f\u7b2c $L+R$ \u5f20\u724c\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u4e8c\u5206\u6c42\u51fa\u548c\u5c0f\u4e8e\u7b49\u4e8e $R$ \u7684\u6700\u5c0f\u7684\u90a3\u5f20\u724c\u5e76\u5f39\u51fa\u3002\n\n\u4f46\u662f $R\\le n$\uff0c\u5c31\u662f\u8bf4\u6709\u53ef\u80fd\u8fd9\u4e2a\u8377\u5b98~~\u7eb1~~\u65e0\u804a\u5faa\u73af\u6d17\u724c\u3002\n\n\u90a3\u4e48\u4f5c\u4e3a~~\u4e2d\u56fd\u7279\u8272\u793e\u4f1a\u4e3b\u4e49\u7684\u63a5\u73ed\u4eba~~\u4e00\u540d\u5408\u683c\u7684 OIer\uff0c\n\n\u6211\u4eec\u5e94\u8be5\u5e2e\u52a9\u8377\u5b98\u51cf\u5c11\u5de5\u4f5c\u91cf\uff0c\n\n\u8bbe\u5f53\u524d\u724c\u5806\u5269\u4f59\u6392\u6570\u4e3a $sum$\uff0c\n\n\u5219\u8ba9 $R\\%=sum$\uff0c\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u4e8c\u5206\u4e0d\u4f1a\u51fa\u95ee\u9898\u3002\n\n```cpp\nbool check(int x,int y,int a){\n\tif(x<=y)return (query(y)-query(x-1))<=a;\n\treturn (query(n)-query(x-1)+query(y))<=a;\n}\n\nfor(int i=1;i<=n;i++){\n\tscanf(\"%lld\",&a);\n\ta%=(n-i+1);\n\tint l=L,r=l+n;\n\twhile(l+1<r){\n\t\tint mid=(l+r)/2;\n\t\tif(check(L,(mid-1)%n+1,a))l=mid;\n\t\telse r=mid;\n\t}\n\tL=l%n+1;\n\tadd(L,1);\n\tprintf(\"%lld\\n\",L);\n}\n```\n\n## code\n\n\u4e0a\u5b8c\u6574\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int N=7e5+10;\nint n,a,c[N],L=1;\nint lowbit(int x){\n\treturn x&-x;\n}\nvoid add(int i,int s){\n\twhile(i<=n)c[i]+=s,i+=lowbit(i);\n}\nint query(int i){\n\tint s=i;\n\twhile(i)s-=c[i],i-=lowbit(i);\n\treturn s;\n}\nbool check(int x,int y,int a){\n\tif(x<=y)return (query(y)-query(x-1))<=a;\n\treturn (query(n)-query(x-1)+query(y))<=a;\n}\nsigned main(){\n\tscanf(\"%lld\",&n);\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%lld\",&a);\n\t\ta%=(n-i+1);\n\t\tint l=L,r=l+n;\n\t\twhile(l+1<r){\n\t\t\tint mid=(l+r)/2;\n\t\t\tif(check(L,(mid-1)%n+1,a))l=mid;\n\t\t\telse r=mid;\n\t\t}\n\t\tL=l%n+1;\n\t\tadd(L,1);\n\t\tprintf(\"%lld\\n\",L);\n\t}\n}\n```\n\n\u8bb0\u5f97\u5f00\u5438\u6c27\uff01",
        "postTime": 1621048830,
        "uid": 310802,
        "name": "_Diu_",
        "ccfLevel": 7,
        "title": "P3988 [SHOI2013]\u53d1\u724c"
    },
    {
        "content": "## [Description](https://www.luogu.com.cn/problem/P3988)\n\n\u6709 $n$ \u5f20\u724c\uff0c\u4e00\u5f00\u59cb\u4ece $1\\sim n$ \u6392\u5217\uff0c\u6709 $n$ \u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u628a $R$ \u5f20\u724c\u79fb\u5230\u6700\u5c3e\uff0c\u6c42\u6bcf\u6b21\u53d1\u724c\u8fc7\u540e\u961f\u9996\u7684\u724c\uff0c\u5e76\u4e14\u5220\u6389\u8fd9\u5f20\u724c\n\n## Solution\n\n\u8003\u8651\u7528 fhq-treap \u6c42\u89e3\uff0c\u56e0\u4e3a fhq-treap \u6709\u7740\u5f3a\u5927\u7684\u5904\u7406\u533a\u95f4\u7684\u80fd\u529b\uff0c\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u6a21\u62df\u9898\u9762\u7684\u8981\u6c42\u5373\u53ef\uff1a\n\n\u5bf9\u4e8e\u79fb\u5230\u6700\u5c3e\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u8003\u8651\u7528\u6309 siz \u5206\u88c2\u7684 fhq-treap\uff0c\u6570\u91cc\u7684\u6743\u503c\u5c31\u662f\u724c\u7684\u7f16\u53f7\uff0c\u961f\u9996\u5373\u5bf9 rnk=1\u5206\u88c2\u5373\u53ef\uff0c\u5e76\u4e14\u987a\u4fbf\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u8f6c\u79fb\u6839\u8282\u70b9\u6765\u5b9e\u73b0\u5220\u724c\u7684\u64cd\u4f5c\uff0c\u53ef\u8c13\u662f\u4e00\u4e3e\u4e24\u5f97\u3002\n\n\u7f8e\u4e2d\u4e0d\u8db3\u7684\u5c31\u662f\u5e38\u6570\u7565\u5927\uff0c\u9700\u5438\u6c27\n\n## Code\n\n\u5df2\u52a0\u5165\u9632\u6284\u88ad\u7247\u6bb5\uff0c\u8bf7\u81ea\u91cd\n\n```cpp\n/*If you are full of hope,you will be invincible*/\n#include <ctime>\n#include <cstdio>\n#include <random>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\n#include<ext/pb_ds/assoc_container.hpp>\n#include<ext/pb_ds/hash_policy.hpp>\n#include<ext/pb_ds/priority_queue.hpp>\n#define ri register int\ntypedef long long ll;\nstd::mt19937 hpy(time(nullptr)+(unsigned long long)(new char));\nnamespace IO{\n\tconstexpr int HL=1<<20;\n\tchar buf[HL],*t1=buf,*t2=buf;\n\t#ifndef ONLINE_JUDGE\n\t#define getc() getchar()\n\t#else\n\t#define getc() t1==t2&&(t2=(t1=buf)+fread(buf,1,HL,stdin),t1==t2)?EOF:*t1++\n\t#endif\n\ttemplate <typename Tp>\n\tinline void read(Tp &x) {\n\t\tx = 0;int f = 1;char ch = getc();\n\t\tfor(;!isdigit(ch);ch=getc()) if(ch=='-') f = 0;\n\t\tfor(;isdigit(ch);ch=getc()) x=(x<<3)+(x<<1)+(ch^48);\n\t\tx=f?x:-x;\n\t}\n\ttemplate <typename Tp,typename ...Rp>\n\tinline void read(Tp &x,Rp&... rst) {\n\t\tread(x),read(rst...);\n\t}\n\tchar buff[HL],*T=buff;\n\tvoid flush(){fwrite(buff,1,T-buff,stdout);T=buff;}\n\tinline void putc(char ch){if(T==buff+HL)flush();*T++=ch;}\n\ttemplate<typename Tp>\n\tinline void print(Tp x){if(x<0)putc('-'),x=-x;if(!x)return putc('0')void();\n\tstatic int st[20],tp;while(x)st[++tp]=x%10,x/=10;while(tp)putc(st[tp]^48),--tp;}\n\ttemplate<typename T,typename ...Args> inline void print(const char ch,T x,Args ...args) {\n        print(x,ch);print(args...,ch);\n    }\n}\nusing IO::read;\nusing IO::print;\nusing IO::putc;\nconstexpr int inf = 0x3f3f3f3f,N = 7e5 + 10;\nstruct node{int l,r,siz,key,val;}t[N];\nint n,m,cnt,root,R;\ninline int newnode(const int x) {return t[++cnt].val = x,t[cnt].key=hpy(),t[cnt].siz=1,cnt;}\ninline void update(const int x){t[x].siz = t[t[x].l].siz + t[t[x].r].siz + 1;}\nvoid Split(const int now,const int rnk,int &x,int &y) {\n\tif(!now) return x=y=0,void();\n\tif(t[t[now].l].siz < rnk) {\n\t\tx = now;\n\t\tSplit(t[now].r,rnk-t[t[now].l].siz-1,t[now].r,y);\n\t} else{ \n\t\ty = now;\n\t\tSplit(t[now].l,rnk,x,t[now].l);\n\t}\n\tupdate(now);\n}\nint Merge(const int x,const int y) {\n\tif(!x || !y) return x + y;\n\tif(t[x].key < t[y].key) {\n\t\tt[x].r = Merge(t[x].r,y);\n\t\treturn update(x),x;\n\t} else {\n\t\tt[y].l = Merge(x,t[y].l);\n\t\treturn update(y),y;\n\t}\n}\n\nint main() {\n   \tread(n);\n   \tfor(ri i = 1;i <= n;++i ) root = Merge(root,newnode(i));\n   \twhile(n--) {\n   \t\tint rnk,x,y;read(rnk);\n   \t\trnk %= t[root].siz;//\u524dR\u5f20\u724c\u81f3\u5c11\u8981\u6bd4\u603b\u724c\u6570\u8981\u5c11\uff08\u5982\u679c\u591a\u7684\u8bdd\u76f8\u5f53\u4e8e\u662f\u8f6e\u56de\uff09\n   \t\tif(rnk) Split(root,rnk,x,y)\uff0croot = Merge(y,x);\n   \t\tSplit(root,1,x,y);\n   \t\tprint(t[x].val,'\\n')\uff0croot = y;//\u8f6c\u79fb\u6839\u8282\u70b9\n   \t}\n    return IO::flush(),0;\n}\n```\n\n",
        "postTime": 1615025665,
        "uid": 413147,
        "name": "_Alejandro_",
        "ccfLevel": 0,
        "title": "P3988\u9898\u89e3"
    },
    {
        "content": "\u548c\u697c\u4e0b\u4e00\u6837\uff0c\u67e5\u8be2\u533a\u95f4\u6ef4 $k$ \u5927\u503c\u3002\n\n\u6211\u7528\u7684\u662f\u7ebf\u6bb5\u6811\u3002\n\n\u6bcf\u6b21\u53d1\u7684\u724c = (\u724c\u5e93\u9876\u7684\u6570 + $R_i$) % \u5f53\u524d\u7684\u724c\u6570\n\n\u7136\u540e\u518d\u628a\u53d1\u8fc7\u7684\u724c\u5220\u6389\u3002\n\n\u8fd9\u9898\u662f\u6743\u503c\u7ebf\u6bb5\u6811\u7684\u6a21\u677f\u5417\uff1f\n\n### \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntemplate <typename T>\nvoid read(T &x)\n{\n    x = 0;\n    char ch = getchar();\n    int f = 1;\n    while (!isdigit(ch))\n    {\n        if (ch == '-')\n            f = -1;\n        ch=getchar();\n    }\n    while (isdigit(ch))\n    {\n        x = x * 10 + ch - '0';\n        ch = getchar();\n    }\n    x = x * f;\n}\nint n;\nint sum[3000006];\nvoid build(int k, int l, int r) // \u5efa\u6811\n{\n    if (l == r)\n    {\n        sum[k] = 1;\n        return;\n    }\n    int mid = (l + r) >> 1;\n    build(k << 1, l, mid);\n    build(k << 1 | 1, mid + 1, r);\n    sum[k] = sum[k << 1] + sum[k << 1 | 1];\n}\nint query(int p, int l, int r, int x)\n{\n    sum[p]--;\n    if (l == r)\n    {\n        return l;\n    }\n    int mid = (l + r) >> 1;\n    if (x <= sum[p << 1])\n        return query(p << 1, l, mid, x);\n    else\n        return query(p << 1 | 1, mid + 1, r, x - sum[p << 1]);\n}\nint main()\n{\n    register int i;\n    read(n);// \u6570\u636e\u6bd4\u8f83\u591a\uff0c\u8981\u7528\u5feb\u8bfb\n    build(1, 1, n);\n    int x, y = 0;\n    for (i = n; i >= 1; --i)\n    {\n        read(x);\n        y = (y + x) % i;\n        printf(\"%d\\n\", query(1, 1, n, y + 1));\n    }\n    return 0;\n}\n```\n",
        "postTime": 1571916086,
        "uid": 182365,
        "name": "\u865a\u5fc3\u7af9gulu",
        "ccfLevel": 3,
        "title": "\u9898\u89e3 P3988 \u3010[SHOI2013]\u53d1\u724c\u3011"
    },
    {
        "content": "Splay  (+O2...)\n\n\u5e38\u6570\u5de8\u5927\n\n\u7528Splay\u627e\u52301-x\u7684\u533a\u95f4\n\n\u628a\u5b83\u63a5\u5230\u6700\u540e\u9762\n\n\u7136\u540e\u627e\u5230\u6392\u540d\u7b2c\u4e00\u7684\u6570\n\n\u8f93\u51fa\u540e\u5220\u9664\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nconst int N=700001;\nstruct tree\n{\n    int value,size,fa,son[2];\n    inline tree(){size=value=fa=son[0]=son[1]=0;}\n    inline void create(int key){size=1;value=key;}\n}t[N];\nint root,size;\ninline void pushup(tree &p)\n{\n\tp.size=1;\n\tif (p.son[0])p.size+=t[p.son[0]].size;\n\tif (p.son[1])p.size+=t[p.son[1]].size;\n}\ninline bool relation(int p)\n{\n    return t[t[p].fa].son[1]==p;\n}\ninline void connect(int p,int fa,bool which)\n{\n    if (p)t[p].fa=fa;\n    if (fa)t[fa].son[which]=p,pushup(t[fa]);\n}\ninline void rotate(int p)\n{\n    int fa=t[p].fa;\n    bool dir=relation(p);\n    connect(p,t[fa].fa,relation(fa));\n    connect(t[p].son[dir^1],fa,dir);\n    connect(fa,p,dir^1);\n    pushup(t[fa]);pushup(t[p]);\n}\ninline void splay(int p)\n{\n    for (int fa;fa=t[p].fa;rotate(p))\n        if (t[fa].fa)\n            rotate(relation(p)==relation(fa)?fa:p);\n    root=p;\n}\ninline int find_rank(int ranking)\n{\n    int p=root;\n    while (1)\n        if (ranking<=t[t[p].son[0]].size)p=t[p].son[0];\n        else\n        {\n            ranking-=t[t[p].son[0]].size+1;\n            if (!ranking)return p;\n            p=t[p].son[1];\n        }\n}\nint build(int fa,int l,int r)\n{\n\tint mid=l+r>>1,p=++size;\n\tt[p].create(mid);t[p].fa=fa;\n\tif (l<mid)t[p].son[0]=build(p,l,mid-1);\n\tif (r>mid)t[p].son[1]=build(p,mid+1,r);\n\treturn pushup(t[p]),p;\n}\ninline int reverse(int pos)\n{\n\tif (pos) //\u4e0d\u4e3a0\u624d\u9500\u724c\n\t{\n\t\tsplay(find_rank(pos)); //\u627e\u5230\u7b2cpos\u5f20\u724c\u5e76\u9009\u5230\u6839 \u8fd9\u6837\u5b83\u7684\u5de6\u5b50\u6811\u4fbf\u662f[1,pos)\uff0c\u53f3\u5b50\u6811\u662f(pos,t[root].size]\n\t\tint rt=root;\n\t\troot=t[rt].son[1];t[root].fa=0;//\u5b83\u7684\u53f3\u513f\u5b50\u4f5c\u4e3a\u65b0\u6839\n\t\tt[rt].son[1]=0;pushup(t[rt]);\n\t\tsplay(find_rank(t[root].size)); //\u628a\u6700\u540e\u4e00\u5f20\u724c\u65cb\u8f6c\u81f3\u6839\n\t\tconnect(rt,root,1); //\u628a[1,pos]\u63a5\u5230\u6700\u540e\u53bb\n\t}\n\tint first=find_rank(1),ans=t[first].value;\n\tsplay(first); //\u627e\u5230\u724c\u9876\u7684\u724c\u5e76\u65cb\u5230\u6839\n\tif (t[first].son[1])t[root=t[first].son[1]].fa=0; //\u8bbe\u7f6e\u65b0\u6839\n\treturn ans;\n}\nint n;\nint main()\n{\n\tscanf(\"%d\",&n);\n\troot=build(0,1,n);\n\twhile (n--)\n\t{\n\t\tint r;\n\t\tscanf(\"%d\",&r);\n\t\tprintf(\"%d\\n\",reverse(r%t[root].size)); //\u6a21\u4e0a\u603b\u724c\u6570\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1535523960,
        "uid": 14374,
        "name": "zhengrunzhe",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3988 \u3010[SHOI2013]\u53d1\u724c\u3011"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3988)\n\n---\n\n$\\text{fhq-treap}$ \u6ca1\u6709\u5f00 O2 \u6216\u5feb\u8bfb\u3002\n\n\u53ef\u80fd\u662f\u6d4b\u8bc4\u59ec\u6ce2\u52a8\u3002\n\n\u6ce8\u610f\u5230\u524a\u724c\u64cd\u4f5c\u5c31\u662f\u5c06\u4e00\u4e2a\u533a\u95f4\u63a5\u5230\u4e00\u4e2a\u533a\u95f4\u540e\uff0c\u4e0d\u5c31\u662f\u88f8\u7684 $\\text{fhq-treap}$ \u5417\uff1f\n\n\u6ce8\u610f\u524a\u724c\u6b21\u6570\u53ef\u80fd\u5927\u4e8e\u5f53\u524d\u724c\u6570\uff0c\u6ce8\u610f\u53d6\u6a21\u3002\n\n```cpp\n#include <ctime>\n#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\ntemplate<typename T>T Max(T x,T y) {return x > y ? x : y;}\n\nconst int N = 7e5 + 5;\n\nstruct node {\n\tint l,r,sz,key,val;\n}fhq[N];\n\nint n,m;\nint cnt,root,root1,root2,root3;\n\nint newnode(int val) {\n\tfhq[++ cnt].key = rand();\n\tfhq[cnt].val = val;\n\tfhq[cnt].sz = 1;\n\treturn cnt;\n}\n\nvoid update(int now) {\n\tfhq[now].sz = fhq[fhq[now].l].sz + fhq[fhq[now].r].sz + 1;\n}\n\nvoid split(int now,int sz,int &x,int &y) {\n\tif (!now)\n\t\tx = y = 0;\n\telse {\n\t\tif (fhq[fhq[now].l].sz < sz) {\n\t\t\tx = now;\n\t\t\tsplit(fhq[now].r,sz - fhq[fhq[now].l].sz - 1,fhq[now].r,y);\n\t\t}\n\t\telse {\n\t\t\ty = now;\n\t\t\tsplit(fhq[now].l,sz,x,fhq[now].l);\n\t\t}\n\t\tupdate(now);\n\t}\n}\n\nint merge(int x,int y) {\n\tif (!x || !y)\n\t\treturn x | y;\n\tif (fhq[x].key < fhq[y].key) {\n\t\tfhq[x].r = merge(fhq[x].r,y);\n\t\tupdate(x);\n\t\treturn x;\n\t}\n\telse {\n\t\tfhq[y].l = merge(x,fhq[y].l);\n\t\tupdate(y);\n\t\treturn y;\n\t}\n}\n\nint main () {\n\tscanf(\"%d\",&n);\n\tint x;\n\tfor (int i = 1 ; i <= n ; ++ i)\n\t\troot = merge(root,newnode(i));\n\tfor (int i = 1 ; i <= n ; ++ i) {\n\t\tscanf(\"%d\",&x);\n\t\tx %= (n - i + 1);\n\t\tif (x == 0) {\n\t\t\tsplit(root,1,root1,root2);\n\t\t\tprintf(\"%d\\n\",fhq[root1].val);\n\t\t\troot = root2;\n\t\t}\n\t\telse {\n\t\t\tsplit(root,x,root1,root2);\n\t\t\tsplit(root2,1,root2,root3);\n\t\t\tprintf(\"%d\\n\",fhq[root2].val);\n\t\t\troot = merge(root3,root1);\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1611752872,
        "uid": 163516,
        "name": "Strelitzia",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3988 \u3010[SHOI2013]\u53d1\u724c\u3011"
    },
    {
        "content": "\u5e73\u8861\u6811\u66b4\u529b\u6a21\u62df\u3002\n\n\u76f8\u5f53\u4e8e\u628a\u4e00\u4e2a\u533a\u95f4\u4ece\u524d\u9762\u79fb\u52a8\u5230\u540e\u9762\u3002\n\u8fd9\u91cc\u4f7f\u7528\u4e86\u975e\u65cbTreap\u3002\n\n\u4ee3\u7801\uff08-O2\uff09\n\n```cpp\n// luogu-judger-enable-o2\n#include<bits/stdc++.h>\n#define N 700005\nusing namespace std;\nint read()  //\u8bfb\u5165\u4f18\u5316\n{\n    int out=0,flag=1;\n    char c=getchar();\n    while(c<48||c>57) {if(c=='-') flag=-1;c=getchar();}\n    while(c>=48&&c<=57)\n    {\n        out=out*10+c-48;\n        c=getchar();\n    }\n    return out*flag;\n}\nstruct node\n{\n    int key,fhq;\n    int l,r,siz;\n    node()\n    {\n        l=r=siz=0;\n        key=fhq=0;\n    }\n    void Ned(int i)\n    {\n        key=i;fhq=rand();siz=1;\n    }\n}tre[N];\nint n,rot;\nvoid update(int now)\n{\n    tre[now].siz=tre[tre[now].l].siz+1+tre[tre[now].r].siz;\n}\nvoid split(int now,int k,int &x,int &y)\n{\n    if(!now)\n    {\n        x=y=0;return;\n    }\n    if(tre[tre[now].l].siz>=k)\n        y=now,split(tre[now].l,k,x,tre[now].l);\n    else\n        x=now,split(tre[now].r,k-tre[tre[now].l].siz-1,tre[now].r,y);\n    update(now);\n}\nint merage(int x,int y)\n{\n    if(x*y==0) return x+y;\n    if(tre[x].fhq<tre[y].fhq)\n    {\n        tre[x].r=merage(tre[x].r,y);\n        update(x);return x;\n    }\n    else\n    {\n        tre[y].l=merage(x,tre[y].l);\n        update(y);return y;\n    }\n}\n\nint main()\n{\n    n=read();\n    srand(n*n*233+666);\n\tfor(int i=1;i<=n;++i)\n    {\n        tre[i].Ned(i);rot=merage(rot,i);\n    }\n    for(int i=1;i<=n;++i)\n    {\n        int it=read()%tre[rot].siz;\n        int x,y;\n        if(it)\n        {\n            split(rot,it,x,y);\n            merage(y,x);\n        }\n        split(rot,1,x,y);\n        printf(\"%d\\n\",tre[x].key);\n        rot=y;\n    }\n    return 0;\n}\n```",
        "postTime": 1519373021,
        "uid": 35718,
        "name": "MloVtry",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3988 \u3010[SHOI2013]\u53d1\u724c\u3011"
    },
    {
        "content": "~~\u9996\u5148\u8fd9\u9053\u9898\u6211\u4eec\u5148\u624b\u73a9\u4e00\u4e0b\u6570\u636e\u627e\u627e\u7075\u611f~~\u3002\n\n\u8fd9\u9053\u9898\u7ffb\u8bd1\u6210\u4eba\u8bdd\u5c31\u662f:\n\n\u6bcf\u6b21\u53d6\u51fa\u5f53\u524d\u5e8f\u5217 $p$ \u5c0f\u503c\u5e76\u8f93\u51fa\uff0c\u518d\u4ece\u5269\u4e0b\u7684\u6570\u4e2d\u5220\u9664\u8fd9\u4e2a\u6570\u3002\n\n\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u6211\u4eec\u5148\u8bbe $res$ \u4e3a\u5f53\u524d\u724c\u5806\u7684\u724c\u7684\u6570\u76ee\u3002\n\n$p$ \u4e3a\u5f53\u524d\u724c\u9876\u8981\u6c42\u5e8f\u5217\u7b2c $p$ \u5c0f\u503c, $lp$ \u4e3a\u4e0a\u4e00\u6b21\u7684 $p$(\u521d\u59cb\u4e3a1)\u3002\n\n$p$ = $(lp+Ri)$ $mod$ $res$\u3002\n\n\u4f46\u662f\u5f53 $p=0$ \u65f6\uff0c\u6211\u4eec\u8981\u628a $p$ \u7684\u503c\u6539\u4e3a $res$\u3002\n\n\u63a5\u4e0b\u6765\u6811\u72b6\u6570\u7ec4+\u4e8c\u5206\u5c31\u53ef\u4ee5\u4e86\u3002\n\n## CODE:\n\n```cpp\n#include<cstdio>\n#define lowbit(x) (x&(-x))\nusing namespace std;\nconst int N=1e6+10;\nint n,c[N];\nint ri,res,p,l,r,mid,ans;\nvoid add(int i,int k){\n\tfor(;i<=n;i+=lowbit(i))c[i]+=k;\n\treturn;\n}\nint query(int i){\n\tint s=0;\n\tfor(;i>0;i-=lowbit(i))s+=c[i];\n\treturn s;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tp=1,res=n;\n\tfor(int i=1;i<=n;++i)add(i,1);\n\tfor(int i=1;i<=n;++i){\n\t\tscanf(\"%d\",&ri);\n\t\tp=(p+ri)%res;\n\t\tif(!p)p=res;\n\t\t--res;\n\t\tl=1,r=n;\n\t\tfor(;l<=r;){\n\t\t\tmid=((l+r)>>1);\n\t\t\tif(query(mid)>=p)ans=mid,r=mid-1;\n\t\t\telse l=mid+1;\n\t\t}\n\t\tprintf(\"%d\\n\",ans);\n\t\tadd(ans,-1);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1621416311,
        "uid": 374929,
        "name": "SpeMars",
        "ccfLevel": 7,
        "title": "\u8150\u724c\u306e\u9898\u89e3"
    },
    {
        "content": "\u770b\u5230\u597d\u50cf\u6ca1\u6709splay\u7684\u9898\u89e3\uff0c\u6765\u8865\u4e00\u6ce2~~\n\n\u627e\u52301-x\u7684\u533a\u95f4\uff0c\u7136\u540e\u8f6c\u5230\u540e\u9762\uff0c\u5728\u5220\u9664\u7b2c\u4e00\u4e2a\u5c31\u597d\u4e86\n\n~~\u9700\u5438\u6c27~~\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <algorithm>\n#include <cstring>\n#include <queue>\n#include <utility>\n#include <cctype>\n#define mid (l + r >> 1)\n\nusing namespace std;\n\nconst int SIZE = 7e5 + 5;\nstruct SPLAY {\n\tint siz;\n\tint val;\n\tint ch[2];\n\tint fa;\n} T[SIZE];\nint root, n, R[SIZE], tot;\n\ninline void update(int u) {\n\tT[u].siz = T[T[u].ch[0]].siz + T[T[u].ch[1]].siz + 1;\n}\n\ninline int make(int l, int r, int fa) {\n\tint u = ++tot;\n\tT[u].siz = 1;\n\tT[u].val = mid;\n\tT[u].ch[0] = T[u].ch[1] = 0;\n\tT[u].fa = fa;\n\tif (mid > l) T[u].ch[0] = make(l, mid - 1, u);\n\tif (mid < r) T[u].ch[1] = make(mid + 1, r, u);\n\tupdate(u);\n\treturn u;\n}\n\ninline void rotate(int x) {\n\tint y = T[x].fa;\n\tint z = T[y].fa;\n\tint w = T[y].ch[1] == x;\n\tT[z].ch[T[z].ch[1] == y] = x;\n\tT[x].fa = z;\n\tT[y].ch[w] = T[x].ch[w ^ 1];\n\tT[T[x].ch[w ^ 1]].fa = y;\n\tT[x].ch[w ^ 1] = y;\n\tT[y].fa = x;\n\tupdate(y), update(x);\n}\n\ninline void splay(int x, int goal) {\n\tfor (; T[x].fa ^ goal; rotate(x)) {\n\t\tint y = T[x].fa;\n\t\tint z = T[y].fa;\n\t\tif (z ^ goal)\n\t\t\tT[y].ch[1] ^ x ^ T[z].ch[1] ^ y ? rotate(x) : rotate(y);\n\t}\n\tif (!goal) root = x;\n}\n\ninline int getRank(int x) {\n\tint u = root;\n\twhile (233) {\n\t\tif (x <= T[T[u].ch[0]].siz) u = T[u].ch[0];\n\t\telse {\n\t\t\tx -= T[T[u].ch[0]].siz + 1;\n\t\t\tif (!x) return u;\n\t\t\tu = T[u].ch[1];\n\t\t}\n\t}\n}\n\ninline int getcard(int x) {\n\tif (x) {\n\t\tsplay(getRank(x), 0);\n\t\tint u = root;\n\t\troot = T[u].ch[1];\n\t\tT[root].fa = 0;\n\t\tT[u].ch[1] = 0;\n\t\tupdate(u);\n\t\tsplay(getRank(T[root].siz), 0);\n\t\tif (u) T[u].fa = root;\n\t\tif (root) T[root].ch[1] = u, update(root);\n\t}\n\tint ranker = getRank(1);\n\tint res = T[ranker].val;\n\tsplay(ranker, 0);\n\tif (T[ranker].ch[1])\n\t\tT[root = T[ranker].ch[1]].fa = 0;\n\treturn res;\n}\n\nsigned main() {\n\tscanf(\"%d\", &n);\n\troot = make(1, n, 0);\n\tfor (int i = 1; i <= n; ++i) {\n\t\tscanf(\"%d\", &R[i]);\n\t\tprintf(\"%d\\n\", getcard(R[i] % T[root].siz));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1576475738,
        "uid": 161849,
        "name": "cirnovsky",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3988 \u3010[SHOI2013]\u53d1\u724c\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u53bb\u5e74\u8054\u8d5b\u5c31\u5728\u5199\u6b64\u9898\uff0c\u7701\u9009\u524d\u5c1d\u8bd5\u7528\u5e73\u8861\u6811\uff0c\u90fd\u65e0\u679c\uff0c\u73b0\u5728\u91cd\u62fe\u6b64\u9898\n\n\u4e0d\u96be\u53d1\u73b0\u6392\u7684\u76f8\u5bf9\u987a\u5e8f\u4e0d\u4f1a\u53d1\u751f\u6539\u53d8\uff0c\u800c\u4e14\u6bcf\u4e00\u4e2a$R$\u7684\u5b9e\u9645\u610f\u4e49\u5176\u5b9e\u662f\u67e5\u8be2\u5f53\u524d\u6392\u540d\u4e3a\u7b2c$R$\u7684\u6570\n\n\u6211\u4eec\u5b9a\u4e49\u5f53\u524d\u724c\u9876\u4e3a$x$\uff0c\u6bcf\u4e00\u6b21\u64cd\u4f5c\u5176\u5b9e\u662f\u67e5\u8be2\u5f80x\u540e\u7684$R$\u4e2a\u6570\n\n\u6211\u4eec\u53ef\u4ee5\u5148\u67e5\u8be2x\u662f\u73b0\u5728\u7b2c\u51e0\u5927\uff08\u4ee4\u6b64\u4e3ap\uff09\uff0c\u7136\u540e\u5c31\u610f\u5473\u7740\u6c42\u51fa$p+R$\u5927\u7684\u6570\uff0c\u6ce8\u610f\u9700\u8981\u5bf9\u5f53\u524d\u6570\u53d6\u6a21\n\n\u67e5\u51fa\u540e\u66f4\u65b0$x$\uff0c\u5e76\u4e14\u628a\u8fd9\u4e2a\u6570\u5220\u6389\u5373\u53ef\n\n\u53d1\u73b0\u4ee5\u4e0a\u6240\u6709\u64cd\u4f5c\u90fd\u53ef\u4ee5\u7528\u6743\u503c\u7ebf\u6bb5\u6811/\u5e73\u8861\u6811\u5b9e\u73b0\uff0c\u590d\u6742\u5ea6\u4e3a$O(NlogN)$\n\n## $Code:$\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define il inline\n#define re register\nil int read() {\n    re int x = 0, f = 1; re char c = getchar();\n    while(c < '0' || c > '9') { if(c == '-') f = -1; c = getchar();}\n    while(c >= '0' && c <= '9') x = x * 10 + c - 48, c = getchar();\n    return x * f;\n}\n#define rep(i , a , b) for(int i = (a) , i##Limit = (b) ; i <= i##Limit ; ++ i)\n#define ls k * 2\n#define rs k * 2 + 1\n#define maxn 700007\nint n, sum[maxn << 2], now;\nil void build(int k, int l, int r) {\n\tif(l == r) return (void)(sum[k] = 1);\n\tint mid = (l + r) >> 1;\n\tbuild(ls, l, mid), build(rs, mid + 1, r), sum[k] = sum[ls] + sum[rs];\n}\nil void modify(int k, int l, int r, int ll, int v) {\n\tif(l == r) return (void)(sum[k] += v);\n\tint mid = (l + r) >> 1;\n\tif(ll <= mid) modify(ls, l, mid, ll, v);\n\telse modify(rs, mid + 1, r, ll, v);\n\tsum[k] = sum[ls] + sum[rs];\n}\nil int query(int k, int l, int r, int ll) {\n\tif(ll == 0) return 0;\n\tif(l == r) return 1;\n\tint mid = (l + r) >> 1;\n\tif(ll > mid) return query(rs, mid + 1, r, ll) + sum[ls];\n\treturn query(ls, l, mid, ll);\n}\nil int K_th(int k, int l, int r, int b) {\n\tif(l == r) return l;\n\tint mid = (l + r) >> 1, pax = sum[ls];\n\tif(pax >= b) return K_th(ls, l, mid, b);\n\treturn K_th(rs, mid + 1, r, b - pax);\n}\nsigned main() {\n\tn = read(), now = 1, build(1, 1, n);\n\trep(i, 1, n) {\n\t\tint r = (read() + now) % (n - i + 1), t;\n\t\tif(r == 0) r = n - i + 1;\n\t\tprintf(\"%d\\n\", t = K_th(1, 1, n, now = r)), modify(1, 1, n, t, -1);\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1573204225,
        "uid": 57014,
        "name": "Nemlit",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3988 \u3010[SHOI2013]\u53d1\u724c\u3011"
    },
    {
        "content": "[P3988 [SHOI2013]\u53d1\u724c](https://www.luogu.org/problemnew/show/P3988)\n\n## \u5148\u8bf4\u4e00\u70b9\u9898\u5916\u8bdd\uff1a\n\n\u8fd9\u79cd\u9898\u76ee\uff0c\u600e\u4e48\u80fd\u6ca1\u6709\u7ebf\u6bb5\u6811\u7684\u9898\u89e3\u5462\uff1f\n\n\u5f04\u5f97\u6211\u597d\u65b9\u554a\u3002\u3002\u3002\n\n\u7136\u800c\u6211\u5199\u4e86\u4e2a\u7ebf\u6bb5\u6811\uff0c\u8c03\u4e86$2h$\uff0c\u53d1\u73b0\u6211\u5c31\u662f\u4e2a\u6c99\u8336\uff0c\u7adf\u7136\u628a$s$\u6572\u6210\u4e86$k$\u3002\u3002\u3002\n\n\u8fd9\u6837\u4e0b\u53bb\u5403\u8349\u836f\u4e38\u3002\u3002\u3002\n\n## \u6b65\u5165\u6b63\u9898\uff1a\n\n\u9996\u5148\u5e94\u8be5\u770b\u51fa\u8fd9\u662f\u4e2a\u6c42\u6574\u4e2a\u533a\u95f4\u7684\u7b2c$k$\u5927\u503c\u3002\n\n\u8fd9\u79cd\u9898\u76ee$Splay,Treap$\u4e71\u641e\u554a\u3002\u3002\u3002\n\n\u4f46\u662f$n<=7\\times 10^5$\uff0c\u8fd9\u3002\u3002\u3002\u94c1\u5b9a$TLE$\u554a\u3002\u3002\u3002\n\n\u7136\u540e\u6211\u4eec\u60f3\uff0c\u8fd8\u6709\u4ec0\u4e48\u53ef\u4ee5\u6c42\u7b2c$k$\u5927\u503c\u5462\uff1f\n\n\u6ca1\u9519\uff01**\u4e3b\u5e2d\u6811**\uff01\n\n\u4f46\u662f\u8fd9\u9898\u4e0d\u7528\u4e3b\u5e2d\u6811\uff0c\u56e0\u4e3a\u53ea\u8981\u6c42\u6574\u4e2a\u533a\u95f4\u7684\u7b2c$k$\u5927\u503c\uff0c\u6240\u4ee5\u7528\u4e2a**\u6743\u503c\u7ebf\u6bb5\u6811**\u5c31\u597d\u8fa3\uff01\n\n\u5047\u8bbe\u5f53\u524d\u7684\u724c\u5806\u9876\u4e3a$k$\uff0c\u73b0\u5728\u8981\u9500\u724c$x$\u6b21\uff0c\u4e00\u5171\u6709$sum$\u5f20\u724c\u3002\n\n\u90a3\u4e48\u6211\u4eec\u8981\u53d1\u7684\u90a3\u5f20\u724c\u5c31\u662f\u7b2c$(k+x)\\mod sum$\u5f20\u724c\u3002\n\n\u6ce8\u610f\uff1a\u5982\u679c$(k+x)\\mod sum==0$\uff0c\u90a3\u4e48\u8981\u53d1\u7684\u5c31\u662f\u7b2c$sum$\u5f20\u724c\u3002\n\n\u7136\u540e\u5728\u6743\u503c\u7ebf\u6bb5\u6811\u4e2d\u628a\u53d1\u8fc7\u7684\u90a3\u5f20\u724c\u5220\u6389\u5c31\u597d\u3002\n\n\u8bb0\u5f97\u7528\u4e00\u70b9\u5e38\u6570\u4f18\u5316\u4e4b\u7c7b\u7684\u4e1c\u897f\u3002\u3002\u3002\n\n\u8fd8\u6709\uff0c\u6211\u7684\u6743\u503c\u7ebf\u6bb5\u6811\u6781\u5ea6\u538b\u884c\uff0c\u8fd8\u6709\u4e00\u5927\u5806\u5b8f\u5b9a\u4e49\uff0c\u8981\u4ed4\u7ec6\u770b\u54e6\uff01\n\n[\u6709\u7a7a\u5230\u672c\u849f\u84bb\u7684\u535a\u5ba2\u91cc\u5750\u5750\u54e6\uff01](https://www.cnblogs.com/Yangrui-Blog/p/9526427.html)\n\n\u9644\u4ee3\u7801\uff1a\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#define LSON rt<<1\n#define RSON rt<<1|1\n#define DATA(x) a[x].data\n#define LSIDE(x) a[x].l\n#define RSIDE(x) a[x].r\n#define WIDTH(x) (RSIDE(x)-LSIDE(x)+1)\n#define MAXN 1000010\nusing namespace std;\nint n,m;\nstruct Segment_Tree{\n\tint data,l,r;\n}a[MAXN<<2];\ninline int read(){\n\tint date=0,w=1;char c=0;\n\twhile(c<'0'||c>'9'){if(c=='-')w=-1;c=getchar();}\n\twhile(c>='0'&&c<='9'){date=date*10+c-'0';c=getchar();}\n\treturn date*w;\n}\nvoid buildtree(int l,int r,int rt){//\u5efa\u6811\n\tLSIDE(rt)=l;RSIDE(rt)=r;DATA(rt)=WIDTH(rt);\n\tif(l==r)return;\n\tint mid=l+r>>1;\n\tbuildtree(l,mid,LSON);\n\tbuildtree(mid+1,r,RSON);\n}\nvoid update(int k,int rt){//\u5220\u9664\n\tDATA(rt)--;\n\tif(LSIDE(rt)==RSIDE(rt))return;\n\tint mid=LSIDE(rt)+RSIDE(rt)>>1;\n\tif(k<=mid)update(k,LSON);\n\telse update(k,RSON);\n}\nint query(int k,int rt){//\u7b2ck\u5927\n\tif(LSIDE(rt)==RSIDE(rt))return LSIDE(rt);\n\tif(k<=DATA(LSON))return query(k,LSON);\n\telse return query(k-DATA(LSON),RSON);\n}\nvoid work(){\n\tint x,s,k=1;\n\twhile(n--){\n\t\tx=read();\n\t\tk=(k+x)%DATA(1);\n\t\tif(!k)k=DATA(1);//\u8bb0\u5f97\u8981\u7279\u5224\n\t\ts=query(k,1);//\u6c42\u7684\u662f\u7b2ck\u5927\n\t\tprintf(\"%d\\n\",s);\n\t\tupdate(s,1);//\u5220\u9664\u7684\u662f\u7b2ck\u5927\u7684\u503c\uff01\n\t}\n}\nvoid init(){\n\tn=read();\n\tbuildtree(1,n,1);\n}\nint main(){\n\tinit();\n\twork();\n    return 0;\n}\n\n```",
        "postTime": 1535030295,
        "uid": 49998,
        "name": "\u65af\u5fb7\u54e5\u5c14\u6469",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3988 \u3010[SHOI2013]\u53d1\u724c\u3011"
    },
    {
        "content": "[\u9898\u9762](https://www.luogu.com.cn/problem/P3988)\n\n\u9996\u5148\u770b\u9898\u53d1\u73b0\u66b4\u529b\u53ef\u62ff\u90e8\u5206\u5206\u2026\u2026\n\n\u4e8e\u662f\u5148\u6253\u4e86\u66b4\u529b\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ninline int read(){\n\tint num=0,ch=0;\n\tchar c=getchar();\n\twhile(!isdigit(c))ch|=(c=='-'),c=getchar();\n\twhile(isdigit(c))num=(num<<1)+(num<<3)+(c^48),c=getchar();\n\treturn ch?-num:num;\n}\ninline void write(int x){\n\tif(x<0)putchar('-'),x=-x;\n\tif(x>=10)write(x/10);\n\tputchar(x%10+'0');\n}\nint n;\nqueue<int>C;\nsigned main(){\n//\tfreopen(\"card.in\",\"r\",stdin);\n//\tfreopen(\"card.out\",\"w\",stdout);\n\tn=read();\n\tfor(int i=1;i<=n;++i)C.push(i);\n\tfor(int i=1;i<=n;++i){\n\t\tint x=read();x%=n-i+1;\n\t\twhile(x--){C.push(C.front());C.pop();}\n\t\twrite(C.front()),puts(\"\");C.pop();\n\t}\n\treturn 0;\n}\n\n```\n\n---\n\n\u7136\u540e\u518d\u770b\u9898\u76ee\uff0c\u53d1\u73b0\u6700\u5f00\u59cb\u724c\u662f\u6b63\u5e8f\uff0c\u518d\u52a0\u4e0a\u66b4\u529b\u65f6\u7684\u53d6\u6a21\u64cd\u4f5c\uff0c\u8054\u60f3\u5230**\u6743\u503c\u7ebf\u6bb5\u6811\u6c42\u7b2c $k$ \u5927**\u3002\n\n\u4e8e\u662f\u7ef4\u62a4\u4e86\u4e00\u4e2a\u6743\u503c\u7ebf\u6bb5\u6811\uff0c\u6bcf\u6b21\u8f93\u5165\u66f4\u65b0 $k$ \u7684\u503c\u3002\n\n\u6ce8\u610f\u8981\u4fee\u6539\u6743\u503c\u7ebf\u6bb5\u6811\u7684\u503c\u57df\uff0c\u56e0\u4e3a\u6bcf\u6b21\u8981\u5f39\u51fa\u4e00\u4e2a\u6570\uff0c\u5269\u4e0b\u7684\u5c31\u662f\u5904\u7406\u7ec6\u8282\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,sum[3000005],k;\ninline int read(){\n\tint num=0,ch=0;\n\tchar c=getchar();\n\twhile(!isdigit(c))ch|=(c=='-'),c=getchar();\n\twhile(isdigit(c))num=(num<<1)+(num<<3)+(c^48),c=getchar();\n\treturn ch?-num:num;\n}\ninline void write(int x){\n\tif(x<0)putchar('-'),x=-x;\n\tif(x>=10)write(x/10);\n\tputchar(x%10+'0');\n}\ninline void build(int p,int l,int r){\n    if(l==r){sum[p]=1;return;}\n    int mid=l+r>>1;\n    build(p<<1,l,mid);\n    build(p<<1|1,mid+1,r);\n    sum[p]=sum[p<<1]+sum[p<<1|1];\n}\ninline int query(int p,int l,int r,int x){\n    --sum[p];\n    if(l==r)return l;\n    int mid=l+r>>1;\n    if(x<=sum[p<<1])return query(p<<1,l,mid,x);\n    else return query(p<<1|1,mid+1,r,x-sum[p<<1]);\n}\nsigned main(){\n\tn=read(),build(1,1,n);\n    for(int i=n;i;--i)k=(k+read())%i,write(query(1,1,n,k+1)),puts(\"\");\n    return 0;\n}\n\n```",
        "postTime": 1648253789,
        "uid": 482869,
        "name": "cqbzhyf",
        "ccfLevel": 5,
        "title": "P3988 [SHOI2013]\u53d1\u724c\u9898\u89e3"
    },
    {
        "content": "## \u524d\u8a00\n\uff08\u8df3\u8fc7\u8fd9\u4e00\u73af\u8282\uff09\n## \u9898\u610f\u7b80\u8ff0\n\u591a\u6b21\u8be2\u95ee\uff0c\u5bf9\u4e8e\u6bcf\u6b21\u8be2\u95ee\uff0c\u5728\u524d\u4e00\u6b21\u8be2\u95ee\u7684\u57fa\u7840\u4e0a\uff0c\u5c06\u524d $r_i-1$ \u4e2a\u5143\u7d20\u7f6e\u4e8e\u5e8f\u5217\u672b\uff0c\u5e76\u56de\u7b54\u6b64\u65f6\u5e8f\u5217\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u3002\n## \u9898\u76ee\u5206\u6790\n\u5f88\u663e\u7136\uff0c\u5982\u679c\u771f\u7684\u6309\u7167\u9898\u76ee\u7684\u8981\u6c42\u79fb\u52a8\u5143\u7d20\uff0c\u94c1\u5b9a\u4f1a\u8d85\u65f6\u2026\u2026\u90a3\u4e48\u6211\u4eec\u5c1d\u8bd5\u4e0d\u79fb\u52a8\u5143\u7d20\uff0c\u800c\u662f\u8ba1\u7b97\u51fa\u8981\u67e5\u8be2\u7684\u5143\u7d20\u5728\u539f\u59cb\u6570\u5217\u4e2d\u7684\u4f4d\u7f6e\u3002\u7ecf\u8fc7\u5c1d\u8bd5\uff0c\u53ef\u4ee5\u53d1\u73b0\u53ea\u9700\u8981\u5728\u539f\u59cb\u6570\u5217\u4e2d\u5c06\u4e0a\u4e00\u6b21\u7b54\u6848\u4f4d\u7f6e\u5411\u540e\u79fb\u52a8 $r_i$ \u4e2a\u4f4d\u7f6e\uff0c\u82e5\u8d85\u51fa\u5f53\u524d\u5e8f\u5217\u5c3e\u7aef\u5219\u8fd4\u56de\u9996\u7aef\uff0c\u4fbf\u53ef\u4ee5\u5f97\u5230\u6b64\u6b21\u7b54\u6848\u6240\u5728\u7684\u4f4d\u7f6e\u3002\u5373 $location=(last\\_location+r_i-1) \\mod size+1$\uff0c$location$ \u521d\u59cb\u503c\u4e3a $1$\u3002  \n\n\u90a3\u4e48\u8fd9\u65f6\u53ea\u9700\u8981\u67e5\u8be2\u5bf9\u5e94\u4f4d\u7f6e\u7684\u5143\u7d20\u5373\u53ef\u3002\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\uff0c\u7ef4\u62a4\u63d2\u5165\u5143\u7d20\u3001\u5220\u9664\u5143\u7d20\u4ee5\u53ca\u67e5\u8be2\u7b2c $k$ \u5927\u7684\u6570\u3002\u5f88\u663e\u7136\uff0c\u4e8c\u53c9\u67e5\u627e\u6811\u548c\u6743\u503c\u7ebf\u6bb5\u6811\uff08\u6811\u72b6\u6570\u7ec4\uff09\u6ee1\u8db3\u8981\u6c42\u3002\u6b64\u9898\u7531\u4e8e\u6ca1\u6709\u5220\u9664\u540e\u7684\u63d2\u5165\uff0c\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u539f\u59cb\u6570\u636e\u6784\u9020\u63a5\u8fd1\u5b8c\u7f8e\u5e73\u8861\u7684\u6811\uff0c\u6545\u4e0d\u9700\u8981\u5199\u5e73\u8861\u6811\u3002\u7531\u4e8e~~\u5199\u8fd9\u7bc7\u9898\u89e3\u7684\u4eba\u6bd4\u8f83\u61d2~~\u6811\u72b6\u6570\u7ec4\u597d\u5199\uff0c\u4ed6\u4f7f\u7528\u4e86\u6811\u72b6\u6570\u7ec4\u5b9e\u73b0\u3002  \n\n\u5bb9\u6613\u60f3\u5230\u628a\u6811\u72b6\u6570\u7ec4\u5f53\u4f5c\u6876\u6765\u7528\uff0c\u5efa\u7acb\u6743\u503c\u610f\u4e49\u4e0a\u7684\u6811\u72b6\u6570\u7ec4\u3002\u63d2\u5165\u548c\u5220\u9664\u90fd\u5f88\u597d\u529e\u3002\u5bf9\u4e8e\u67e5\u8be2\uff0c\u7531\u4e8e\u6ee1\u8db3\u5355\u8c03\u6027\uff0c\u53ef\u4ee5\u4f7f\u7528\u500d\u589e\u3002\u56e0\u4e3a\u6811\u72b6\u6570\u7ec4\u7684\u6bcf\u4e2a\u7ed3\u70b9\u7ef4\u62a4\u7684\u533a\u95f4\u662f $[x-lowbit(x)+1,x]$\uff0c\u500d\u589e\u6070\u597d\u7b26\u5408\u6811\u72b6\u6570\u7ec4\u7684\u5b58\u50a8\u89c4\u5f8b\u3002\u5728\u500d\u589e\u7684\u65f6\u5019\uff0c\u6ce8\u610f\u9700\u8981\u7d2f\u8ba1\u7ecf\u8fc7\u7684\u7ed3\u70b9\u7684 $sum$ \u503c\uff08\u6839\u636e\u6bcf\u4e2a\u7ed3\u70b9\u7ef4\u62a4\u7684\u4fe1\u606f\u53ef\u4ee5\u5f97\u51fa\uff09\u3002\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\operatorname{O}(n\\log n)$\u3002\n## \u4ee3\u7801\n\u5b8c\u5168\u6ca1\u538b\u884c\uff0c\u4f46\u8d85\u77ed\u7684\uff01\n```cpp\n#include<cmath>\n#include<cstdio>\nusing namespace std;\nint n,target=1,r[700001],sum[700001];\ninline int lowbit(int x)\n{\n\treturn x&(-x);\n}\nvoid add(int x,int value)\n{\n\twhile(x<=n)\n\t{\n\t\tsum[x]+=value;\n\t\tx+=lowbit(x);\n\t}\n\treturn;\n}\nint at(int x)\n{\n\tint now=0,rank=0;\n\tfor(int i=log2(n);i>=0;--i)\n\t\tif(now+(1<<i)<=n&&rank+sum[now+(1<<i)]<x)\n\t\t{\n\t\t\tnow+=(1<<i);\n\t\t\trank+=sum[now]; \n\t\t} \n\treturn now+1;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;++i)\n\t\tadd(i,1);\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tscanf(\"%d\",&r[i]);\n\t\ttarget=(target+r[i]-1)%(n-i+1)+1;\n\t\tint t=at(target);\n\t\tprintf(\"%d\\n\",t);\n\t\tadd(t,-1);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1590669090,
        "uid": 67952,
        "name": "\u767d\u9c9f",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3988 \u3010[SHOI2013]\u53d1\u724c\u3011"
    },
    {
        "content": "\u5e9f\u8bdd\uff1a\u849f\u84bb\u597d\u4e45\u6ca1\u6709\u53d1\u8fc7\u9898\u89e3\u4e86\uff0c\uff0c\uff0c\n# \u6b63\u6587\n\u770b\u5230\u8fd9\u9053\u9898\u9996\u5148\u60f3\u5230\u7684~~\u4e00\u5b9a\u662f\u66b4\u529b\u7684\u89e3\u6cd5\uff1a\u6a21\u62df~~\uff0c\u4f46\u662f\u663e\u7136\u662f\u8fc7\u4e0d\u4e86n=700000\u8fd9\u4e48\u5927\u7684\u6570\u636e\u7684\u3002\u7528\u6570\u5b66\u601d\u7ef4\u7a0d\u52a0\u601d\u8003\uff0c\u5c31\u53ef\u4ee5\u53d1\u73b0\u8fd9\u9053\u9898\u7684\u5927\u610f\u662f\uff1a\n```cpp\n\u6c42\u6570\u5217\u4e2d\u7b2c\uff08cnt=(cnt+r)%i\uff09\u5c0f\u7684\u6570\uff0c\u5176\u4e2dcnt\u521d\u503c\u4e3a1\uff0ci\u4e3a\u5f53\u524d\u724c\u5e93\u4e2d\u5269\u4f59\u7684\u724c\u6570\u91cf\n\u6c42\u51fa\u7b54\u6848\u540e\u5c06\u7b54\u6848\u4ece\u6570\u5217\u4e2d\u53bb\u9664\n```\n\u7b80\u5355\u5730\u62ff\u6837\u4f8b\u4e3e\u4e2a\u6817\u5b50\uff1a\n\n\u7b2c\u4e00\u6b21\uff1acnt=1\uff0cr=2\uff0ci=4\uff0c\u6c42\u51fa\u7b2c3\u5c0f\u7684\u6570\u53733\uff0c\u5c063\u4ece\u6570\u5217\u4e2d\u5220\u9664\n\n\u7b2c\u4e8c\u6b21\uff1acnt=3\uff0cr=0\uff0ci=3\uff0c\u6b64\u65f6\u8ba1\u7b97\u51fa\u8981\u6c42\u7b2c0\u5c0f\u7684\u6570\uff0c\u7279\u6b8a\u5904\u7406\u5c06cnt\u8d4b\u503c\u4e3ai\uff0c\u76f8\u5f53\u4e8e\u6c42\u7b2c3\u5c0f\u7684\u6570\u53734\uff0c\u5c064\u4ece\u6570\u5217\u4e2d\u5220\u9664\n\n\u7b2c\u4e09\u6b21\uff1acnt=3\uff0cr=3\uff0ci=2\uff0c\u6b64\u65f6\u8ba1\u7b97\u51fa\u8981\u6c42\u7b2c0\u5c0f\u7684\u6570\uff0c\u540c\u4e0a\uff0c\u7b54\u6848\u4e3a2\uff0c\u5220\u96642\n\n\u7b2c\u56db\u6b21\uff1acnt=2\uff0cr=2\uff0ci=1\uff0c\u867d\u7136\u6b64\u65f6\u663e\u7136\u53ea\u52691\uff0c\u4f46\u4ecd\u6309\u4e0a\u8ff0\u65b9\u6cd5\u6267\u884c\uff0c\u7b54\u6848\u4e3a1\uff0c\u5220\u96641\n\n\u90a3\u4e48\u6211\u4eec\u9700\u8981\u600e\u6837\u7684\u6570\u636e\u7ed3\u6784\u5462\uff1f\u6ca1\u9519\uff0c\u6700~~\u7b80\u5355\u6613\u61c2\u7684~~\u6743\u503c\u7ebf\u6bb5\u6811\uff0c\u6c42\u6574\u4f53\u7b2ck\u5927\uff0c\u5219\u53ef\u4ee5\u5f97\u5230\u4e0b\u9762\u8fd9\u6bb5\u6838\u5fc3\u4ee3\u7801\uff1a\n```cpp\nfor(int i=n;i>0;--i)//i\u8868\u793a\u724c\u5e93\u4e2d\u724c\u7684\u6570\u91cf\n{\n\tscanf(\"%d\",&r);//\u9898\u76ee\u63cf\u8ff0\u4e2d\u7684ri\n\tcnt=(cnt+r)%i;\n\tif(cnt==0) cnt=i;\n\tint pos=query(1,1,n,cnt);//\u67e5\u8be2\u7b2ccnt\u5927\u7684\u6570\n\tupdate(1,1,n,pos);//\u5c06pos\u4ece\u6570\u5217\u4e2d\u5220\u9664\uff0c\u76f8\u5f53\u4e8e\u5c06\u8be5\u4f4d\u7f6e\u7684\u6743\u503c-1\n\tprintf(\"%d\\n\",pos);\n}\n```\n\u4ec0\u4e48\uff1f\u4f60\u8fd8\u4e0d\u77e5\u9053\u6743\u503c\u7ebf\u6bb5\u6811\u600e\u4e48\u7528\uff0c\u4e0b\u9762\u7b80\u5355\u7684\u4ecb\u7ecd\u4e00\u4e0b\uff1a\n\n\u987e\u540d\u601d\u4e49\uff0c\u6743\u503c\u7ebf\u6bb5\u6811\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u7ebf\u6bb5\u6811\uff0c\u552f\u4e00\u4e0d\u540c\u7684\u662f\u5b83\u7684\u8282\u70b9\u8868\u793a\u4e00\u4e2a\u533a\u95f4\u7684\u6570\u51fa\u73b0\u7684\u6b21\u6570\u3002\u5c31\u6bd4\u5982\u8fd9\u9053\u9898\u5b83\u7684\u53f6\u8282\u70b9\u7684\u521d\u59cb\u503c\u90fd\u4e3a\u4e00\uff0c\u64cd\u4f5c\u4fbf\u548c\u666e\u901a\u7ebf\u6bb5\u6811\u4e00\u6837\u5566\uff0c\u7236\u8282\u70b9\u7684\u503c\u662f\u5de6\u513f\u5b50\u548c\u53f3\u513f\u5b50\u503c\u4e4b\u548c\u3002\n\n\u4e8e\u662f\u6211\u4eec\u6109\u5feb\u5730\u6572\u51fa\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define lc (k<<1)\n#define rc ((k<<1)|1)\n#define mid ((l+r)>>1)\nusing namespace std;\nint n,r,cnt=1,sum[3000005];//sum\u8981\u5f004\u500d\u5927\nvoid build(int k,int l,int r)//\u5efa\u6811\n{\n\tif(l==r)//\u5230\u8fbe\u53f6\u8282\u70b9\n\t{\n\t\tsum[k]=1;\n\t\treturn;\n\t}\n\tbuild(lc,l,mid);//\u5efa\u5de6\u5b50\u6811\n\tbuild(rc,mid+1,r);//\u5efa\u53f3\u5b50\u6811\n\tsum[k]=sum[lc]+sum[rc];//\u66f4\u65b0\u503c\n}\nvoid update(int k,int l,int r,int pos)\n{\n\tif(l>pos||r<pos)//\u8303\u56f4\u5185\u6ca1\u6709pos\uff0c\u76f4\u63a5\u8df3\u51fa\n\t    return;\n\tif(l==r&&l==pos)//\u5230\u8fbepos\u53f6\u8282\u70b9\n\t{\n\t\t--sum[k];//\u6743\u503c-1\uff0c\u5373\u5220\u9664\n\t\treturn;\n\t}\n\tupdate(lc,l,mid,pos);\n\tupdate(rc,mid+1,r,pos);\n\tsum[k]=sum[lc]+sum[rc];//\u66f4\u65b0\n}\nint query(int k,int l,int r,int v)\n{\n\tif(l==r)\n\t    return l;//\u5230\u8fbe\u53f6\u8282\u70b9\uff0c\u6b64\u65f6\u627e\u5230\u7684\u5c31\u662f\u7b54\u6848\n\tif(sum[lc]>=v)//\u5de6\u5b50\u6811\u4e2d\u6570\u51fa\u73b0\u7684\u6b21\u6570\u5927\u4e8e\u7b49\u4e8ev\u4e2a\uff0c\u90a3\u7b2cv\u5927\u4e00\u5b9a\u5728\u5de6\u5b50\u6811\u4e2d\n\t    return query(lc,l,mid,v);\n\telse//\u5426\u5219\u4e00\u5b9a\u5728\u53f3\u5b50\u6811\u4e2d\n\t    return query(rc,mid+1,r,v-sum[lc]);//\u6ce8\u610f\u8981\u51cf\u6389\u5de6\u5b50\u6811\u7684sum\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tbuild(1,1,n);//\u5efa\u6811\n\tfor(int i=n;i>0;--i)//i\u8868\u793a\u724c\u5e93\u4e2d\u724c\u7684\u6570\u91cf\n\t{\n\t\tscanf(\"%d\",&r);//\u9898\u76ee\u63cf\u8ff0\u4e2d\u7684ri\n\t\tcnt=(cnt+r)%i;\n\t\tif(cnt==0) cnt=i;\n\t\tint pos=query(1,1,n,cnt);//\u67e5\u8be2\u7b2ccnt\u5927\u7684\u6570\n\t\tupdate(1,1,n,pos);//\u5c06pos\u4ece\u6570\u5217\u4e2d\u5220\u9664\uff0c\u76f8\u5f53\u4e8e\u5c06\u8be5\u4f4d\u7f6e\u7684\u6743\u503c-1\n\t\tprintf(\"%d\\n\",pos);\n\t}\n\treturn 0;\n}\n```\n~~\u849f\u84bb\u5199\u9898\u89e3\u4e0d\u6613\uff0c\u6c42\u7ba1\u7406\u901a\u8fc7~~",
        "postTime": 1590480043,
        "uid": 68011,
        "name": "\u53e4\u660e\u5730_ypc",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3988 \u3010[SHOI2013]\u53d1\u724c\u3011"
    },
    {
        "content": "\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u662f\u73af\u72b6\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7834\u73af\u4e3a\u94fe\u3002\n\n\u7136\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff1a\u5728\u64cd\u4f5c\u5f53\u524d\u5143\u7d20 $s$ \u6b21\u540e\uff0c\u8be5\u5e8f\u5217\u5c31\u4f1a\u56de\u5230\u539f\u6837\uff0c\u6240\u4ee5\u7b2c $k$ \u6b21\u64cd\u4f5c\u7684\u7b54\u6848\u5c31\u662f\u7b2c $\\sum\\limits_{i=1}^kr_i$\u3002\n\n\u53c8\u56e0\u4e3a\u62bd\u8d70\u4e4b\u540e\u8981\u5220\u9664\uff0c\u6240\u4ee5\u8bf4\u5c31\u662f\u8981\u5b9e\u73b0\u4e00\u4e2a\u652f\u6301\u5220\u9664\u3001\u67e5\u8be2\u6392\u540d\u7684\u6570\u636e\u7ed3\u6784\uff0c\u8fd9\u91cc\u91c7\u7528\u7684\u662f Treap\u3002\n```cpp\n#include<bits/stdc++.h>\n#define inf 0x3f3f3f3f\nusing namespace std;\nconst int maxn=7e5+5;\nint tot,root;\nstruct Treap{\n\tint l,r,val,dat,cnt,size;\n}a[maxn];\ninline int read(){\n\tint res=0;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9')\n\t\tch=getchar();\n\twhile(ch>='0'&&ch<='9'){\n\t\tres=(res<<1)+(res<<3)+(ch^'0');\n\t\tch=getchar();\n\t}\n\treturn res;\n}\ninline int New(int val){\n\ta[++tot].val=val;\n\ta[tot].dat=rand();\n\ta[tot].cnt=a[tot].size=1;\n\treturn tot;\n}\ninline void Update(int p){\n\ta[p].size=a[a[p].l].size+a[a[p].r].size+a[p].cnt;\n}\ninline void Build(){\n\tNew(-inf),New(inf);\n\troot=1,a[1].r=2;\n\tUpdate(root);\n}\nint GetVal(int p,int rank){\n\tif(p==0)\n\t\treturn inf;\n\tif(a[a[p].l].size>=rank)\n\t\treturn GetVal(a[p].l,rank);\n\tif(a[a[p].l].size+a[p].cnt>=rank)\n\t\treturn a[p].val;\n\treturn GetVal(a[p].r,rank-a[a[p].l].size-a[p].cnt);\n}\ninline void Zig(int &p){\n\tint q=a[p].l;\n\ta[p].l=a[q].r,a[q].r=p,p=q;\n\tUpdate(a[p].r),Update(p);\n}\ninline void Zag(int &p){\n\tint q=a[p].r;\n\ta[p].r=a[q].l,a[q].l=p,p=q;\n\tUpdate(a[p].l),Update(p);\n}\nvoid Insert(int &p,int val){\n\tif(!p){\n\t\tp=New(val);\n\t\treturn;\n\t}\n\tif(val==a[p].val){\n\t\t++a[p].cnt,Update(p);\n\t\treturn;\n\t}\n\tif(val<a[p].val){\n\t\tInsert(a[p].l,val);\n\t\tif(a[p].dat<a[a[p].l].dat)\n\t\t\tZig(p);\n\t} else{\n\t\tInsert(a[p].r,val);\n\t\tif(a[p].dat<a[a[p].r].dat)\n\t\t\tZag(p);\n\t}\n\tUpdate(p);\n}\nvoid Remove(int &p,int val){\n\tif(p==0)\n\t\treturn;\n\tif(val==a[p].val){\n\t\tif(a[p].cnt>1){\n\t\t\ta[p].cnt--,Update(p);\n\t\t\treturn;\n\t\t}\n\t\tif(a[p].l||a[p].r){\n\t\t\tif(a[p].r==0||a[a[p].l].dat>a[a[p].r].dat)\n\t\t\t\tZig(p),Remove(a[p].r,val);\n\t\t\telse\n\t\t\t\tZag(p),Remove(a[p].l,val);\n\t\t\tUpdate(p);\n\t\t} else\n\t\t\tp=0;\n\t\treturn;\n\t}\n\tval<a[p].val?Remove(a[p].l,val):Remove(a[p].r,val);\n\tUpdate(p);\n}\nint n=read(),s=1;\nint main(){\n\tBuild();\n\tfor(int i=1;i<=n;++i)\n\t\tInsert(root,i);\n\tfor(int i=n,a;i;--i){\n\t\ts=(s+read())%i;\n\t\tif(!s)\n\t\t    s=i;//\u56e0\u4e3a\u5e73\u8861\u6811\u662f\u4ece 1 \u5f00\u59cb\u6807\u53f7\u7684\n\t\tprintf(\"%d\\n\",GetVal(root,s+1));\n\t\tRemove(root,GetVal(root,s+1));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1648271134,
        "uid": 556362,
        "name": "UnnamedOrNamed",
        "ccfLevel": 5,
        "title": "P3988 [SHOI2013]\u53d1\u724c \u9898\u89e3"
    },
    {
        "content": "\u8fd9\u9898\u771f\u7684\u751f\u8279\u3002\n\n# Solution\n\n\u7ea6\u745f\u592b\u52a0\u5f3a\u7248\uff0c\u9996\u5148\u53ef\u4ee5\u60f3\u5230\u7528\u94fe\u8868\uff0c\u7136\u540e\u4e00\u4e2a\u4e00\u4e2a\u8df3\uff0c\u8fd9\u662f $O(n^2)$ \u7684\u3002\n\n\u7136\u540e\u7528\u4e00\u70b9\u6570\u636e\u7ed3\u6784\u5feb\u901f\u8df3\uff0c\u8fd9\u4e1c\u897f\u6295\u5c04\u5230\u5e8f\u5217\u4e0a\u5c31\u662f\u4e00\u4e2a $01$ \u5e8f\u5217\uff0c\u7136\u540e\u4ece\u5f53\u524d\u7684\u4f4d\u7f6e\u5f80\u540e\u8df3 $R\\mod n$ \u4e2a\u6570\uff0c\u5982\u679c\u53ef\u4ee5\u5feb\u901f\u7684\u627e\u5230\u7b2c $R\\mod n$ \u4e2a\u6570\u5c31\u884c\u4e86\uff0c\u60f3\u5230\u6743\u503c\u7ebf\u6bb5\u6811\u7684\u7b2c $kth$\uff0c\u8fd9\u9898\u5c31\u662f\u628a\u677f\u677f\u4e86\uff0c\u5c0f\u5fc3\u4f1a\u8df3\u5230\u524d\u9762\uff0c\u6240\u4ee5\u590d\u5236\u4e00\u904d\u6570\u7ec4\u5c31\u884c\u4e86\u3002\n\n\u8fd8\u6709\u4e00\u79cd\u65b9\u6cd5\uff0c\u5361\u5361\u5e38\u5e94\u8be5\u80fd\u8fc7\uff08\u7406\u8bba\u7b97\u662f $O(2\\times10^8)$\uff09\uff0c\u5c31\u662f\u4e8c\u5206\u4e0b\u4e00\u4e2a\u53d1\u7684\u724c\uff0c\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u4e2d\u95f4\u6709\u591a\u5c11\u4e2a\u6570\uff0c$O(n\\log^2n)$ \u7684\u590d\u6742\u5ea6\uff0c\u8fd9\u79cd\u505a\u6cd5\u7531\u4e8e\u6211\u591a\u590d\u5236\u4e86\u51e0\u904d\u66b4\u529b\u4ee3\u7801\u5bf9\u62cd\u88ab\u8986\u76d6\u6389\u4e86......\u8fd8\u6709\uff0c\u4e8c\u5206\u53ef\u4ee5\u7528\u500d\u589e\u4ee3\u66ff\uff0c\u590d\u6742\u5ea6\u4e00\u6837\uff0c\u5e38\u6570\u5c0f\u4e9b\u3002\n\n\u55b7\u4e00\u4e0b\u6570\u636e\uff0c\u6211\u968f\u673a\u7684\u6570\u636e\u7528\u6743\u503c\u7ebf\u6bb5\u6811\u8dd1\u51fa\u6765 $3s$\uff0c\u4e0a\u9762\u5c45\u7136\u8fc7\u4e86\u3002\n\n\u4e0a\u4e00\u4efd $25min$ \u8279\u51fa\u6765\u7684\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define il inline\n#define lowbit(x) (x&-x)\nusing namespace std;\nil int qr() {\n\tint x=0;\n\tbool f=0;\n\tchar c=getchar();\n\twhile(!isdigit(c)) f|=c=='-',c=getchar();\n\twhile(isdigit(c)) x=(x<<3)+(x<<1)+(c^48),c=getchar();\n\treturn f?~(x-1):x;\n}\nconst int N=700005;\nint nxt[N],lst[N],n,k,mid,tmp;\nstruct node {\n\tint l,r,sum;\n}tr[N<<2];\nil void Del(int x) {\n\tlst[nxt[x]]=lst[x],nxt[lst[x]]=nxt[x];\n}\nvoid build(int l,int r,int p) {\n\ttr[p].l=l,tr[p].r=r,tr[p].sum=r-l+1;\n\tif(l==r) return ;\n\tint mid=l+r>>1;\n\tbuild(l,mid,p<<1),build(mid+1,r,p<<1|1);\n}\nvoid del(int x,int p) {\n\tif(tr[p].l==tr[p].r) {\n\t\ttr[p].sum--;\n\t\treturn ;\n\t}\n\tint mid=tr[p].l+tr[p].r>>1;\n\tif(x<=mid) del(x,p<<1);\n\telse del(x,p<<1|1);\n\ttr[p].sum--; \n}\nint ask(int l,int r,int p) {\n\tif(l<=tr[p].l&&tr[p].r<=r) return tr[p].sum;\n\tint mid=tr[p].l+tr[p].r>>1,tot=0;\n\tif(l<=mid) tot+=ask(l,r,p<<1);\n\tif(r>mid) tot+=ask(l,r,p<<1|1);\n\treturn tot;\n}\nint getk1(int k,int lim,int p) {\n\tif(tr[p].l==tr[p].r) return tr[p].l;\n\tint mid=tr[p].l+tr[p].r>>1;\n\tif(mid>=lim) return getk1(k,lim,p<<1);\n\tif(tr[p<<1].sum<k) {\n\t\tk-=tr[p<<1].sum;\n\t\treturn getk1(k,lim,p<<1|1);\n\t}\n\treturn getk1(k,lim,p<<1);\n}\nint getk2(int k,int lim,int p) {\n//\tprintf(\"%d %d %d %d %d\\n\",k,lim,p,tr[p].l,tr[p].r);\n\tif(tr[p].l==tr[p].r) return tr[p].l;\n\tint mid=tr[p].l+tr[p].r>>1;\n\tif(mid<lim) return getk2(k,lim,p<<1|1);\n\tif(tr[p<<1|1].sum<k) {\n\t\tk-=tr[p<<1|1].sum;\n\t\treturn getk2(k,lim,p<<1);\n\t}\n\treturn getk2(k,lim,p<<1|1);\n}\nint main() {\n\tfreopen(\"card.in\",\"r\",stdin);\n\tfreopen(\"card.out\",\"w\",stdout);\n\tn=qr(),lst[1]=n,nxt[1]=2,lst[n]=n-1,nxt[n]=1;\n\tfor(int i=2;i<n;i++) lst[i]=i-1,nxt[i]=i+1;\n\tbuild(1,n,1);\n\tfor(int i=n,now=1,tmp;i;i--) {\n\t\tk=qr()%i+1,tmp=ask(now,n,1);\n\t\tif(tmp<k) k-=tmp,now=getk1(k,now-1,1);\n\t\telse now=getk2(tmp-k+1,now,1);\n\t\tprintf(\"%d\\n\",now);\n\t\tdel(now,1),Del(now),now=nxt[now];\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1648215417,
        "uid": 383791,
        "name": "Others",
        "ccfLevel": 7,
        "title": "P3988 \u9898\u89e3"
    },
    {
        "content": "\u5bf9\u4e8e\u8fd9\u4e2a\u9898\uff0c\u6211\u4eec\u7684\u6d41\u7a0b\u662f\u6bcf\u4e00\u6b21\u5411\u540e\u627e $r_i$ \u4e2a\u3002\u6211\u4eec\u53c8\u53d1\u73b0\u8fd9\u4e2a\u724c\u76f8\u5f53\u4e8e\u662f\u4e2a\u73af\u72b6\u7684\u7ed3\u6784\uff0c\u6240\u4ee5\u7834\u73af\u4e3a\u94fe\uff0c\u5728\u94fe\u4e0a\u7ef4\u62a4\u4e00\u68f5\u7ebf\u6bb5\u6811\uff0c\u6bcf\u4e00\u6b21\u5411\u540e\u627e $r_i$ \u4e2a\uff0c\u627e\u5230\u7684\u5373\u4e3a\u7b54\u6848\uff0c\u662f\u7ebf\u6bb5\u6811\u57fa\u672c\u64cd\u4f5c\u3002\u518d\u5220\u9664\u5bf9\u5e94\u5143\u7d20\uff0c\u4e5f\u662f\u7ebf\u6bb5\u6811\u57fa\u672c\u64cd\u4f5c\u3002\u8be6\u89c1\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1400005;\ninline int read() {\n\tint res=0;\n\tchar c=getchar();\n\twhile (c<'0'||c>'9') c=getchar();\n\twhile (c>='0'&&c<='9') res=(res<<3)+(res<<1)+(c^48),c=getchar();\n\treturn res;\n}\nvoid write(int x) {\n\tif (!x) return;\n\twrite(x/10);\n\tputchar(x%10+48);\n\treturn;\n}\nint n,now,val[N<<2];\ninline void pushup(int p) {\n\tval[p]=val[p<<1]+val[p<<1|1];\n\treturn;\n}\nvoid build(int p,int l,int r) {\n\tif (l==r) {\n\t\tval[p]=1;\n\t\treturn;\n\t}\n\tint mid=l+r>>1;\n\tbuild(p<<1,l,mid);\n\tbuild(p<<1|1,mid+1,r);\n\tpushup(p);\n\treturn;\n}\nvoid upd(int p,int l,int r,int x) {\n\tif (l==r) {\n\t\tval[p]--;\n\t\treturn;\n\t}\n\tint mid=l+r>>1;\n\tif (x<=mid) upd(p<<1,l,mid,x);\n\telse upd(p<<1|1,mid+1,r,x);\n\tpushup(p);\n\treturn;\n}\nint sum(int p,int l,int r,int L,int R) {\n\tif (L<=l&&r<=R) return val[p];\n\tint mid=l+r>>1,res=0;\n\tif (L<=mid) res+=sum(p<<1,l,mid,L,R);\n\tif (R>mid) res+=sum(p<<1|1,mid+1,r,L,R);\n\treturn res;\n}\nint get(int p,int l,int r,int k) {\n\tif (l==r) return l;\n\tint mid=l+r>>1;\n\tif (val[p<<1]>=k) return get(p<<1,l,mid,k);\n\treturn get(p<<1|1,mid+1,r,k-val[p<<1]);\n}\nint main() {\n\tn=read();\n\tbuild(1,1,n<<1);\n\tnow=1;\n\tfor (int i=1;i<=n;i++) {\n\t\tint x;\n\t\tx=read();\n\t\tx%=(n-i+1);//\u73af\u72b6\u7ed3\u6784\uff0c\u6a21\u4e00\u4e0b\uff0c\u4e0d\u77e5\u9053\u9700\u4e0d\u9700\u8981\n\t\tif (i!=1) x++;//\u7ec6\u8282\uff0c\u81ea\u5df1\u753b\u7740\u63a8\u4e00\u4e0b\n\t\tint res=sum(1,1,n<<1,1,now);\n\t\tnow=get(1,1,n<<1,res+x);//\u5f80\u540e\u627e\uff0cres\u662f\u8865\u5168\u7528\u7684\n\t\tif (now>n) now-=n;//\u4fdd\u8bc1\u4e0b\u6b21\u5bfb\u627e\u4e0d\u4f1a\u8d8a\u754c\n\t\twrite(now);\n\t\tputchar('\\n');\n\t\tupd(1,1,n<<1,now),upd(1,1,n<<1,now+n);//\u5220\u9664\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1648215149,
        "uid": 407223,
        "name": "TulipeNoire",
        "ccfLevel": 7,
        "title": "\u56db\u5206\u949f\u9898\u89e3"
    },
    {
        "content": "[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3988)\n\n---\n# \u5206\u6790\n~~fake\uff1a\u6b64\u9898\u4e0d\u5c31\u662f\u94fe\u8868\u6a21\u62df\u9898\u5417\uff0c\u6211\u4e00\u5f00\u59cb\u8fd8\u771f\u8fd9\u4e48\u60f3~~\n\n\u8c8c\u4f3c\u94fe\u8868\u4ec0\u4e48\u7528\u90fd\u6ca1\u6709\uff0c\u6839\u636e\u9898\u610f\u5f88\u6e05\u695a\uff0c\u8981\u627e\u4e00\u4e2a\u652f\u6301\u5220\u9664\u548c\u67e5\u8be2\u533a\u95f4\u7b2c$k$\u5927\u7684\u6570\u636e\u7ed3\u6784\n\n\u89e3\u91ca\u4e00\u4e0b\u4e3a\u4ec0\u4e48\u9898\u76ee\u53ef\u4ee5\u8f6c\u6362\u4e3a\u67e5\u8be2\u533a\u95f4\u7b2c$k$\u5927\uff0c\n\n\u5982\u679c\u8bb0\u5f55\u4e00\u4e0b\u4e0a\u4e00\u6b21\u5220\u9664\u7684\u4f4d\u7f6e\uff08\u8fd9\u91cc\u6307\u7684\u662f\u6392\u540d\uff09\u548c\u603b\u724c\u6570\uff0c\u662f\u4e0d\u662f\u53ef\u4ee5\u4ece$\u4e0a\u4e00\u6b21\u5220\u9664\u4f4d\u7f6e+kth$\u5bf9\u603b\u724c\u6570\u53d6\u6a21\u4ee5\u91cd\u65b0\u627e\u5230\u4e0b\u4e00\u6b21\u67e5\u8be2\u7684\u6392\u540d\uff0c\u8fd9\u6837\u5468\u800c\u590d\u59cb\n\n\u90a3\u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u8981\u627e\u4ec0\u4e48\u5462~~\u5e73\u8861\u6811~~\n\n\u5e73\u8861\u6811\u5f53\u7136\u53ef\u4ee5\uff0c\u4f46\u662f\u6211\u76ee\u524d\u53ea\u6572\u8fc7\u6a21\u677f\uff0c\u6240\u4ee5\u8fd8\u662f\u7b97\u4e86\n\n\u4e5f\u53ef\u4ee5\u7528\u7ebf\u6bb5\u6811\uff0c\u7ef4\u62a4\u533a\u95f4\u672a\u88ab\u5220\u9664\u7684\u6570\u7684\u4e2a\u6570\uff0c\u67e5\u8be2\u7b2c$k$\u5927\u65f6\uff0c\u5982\u679c\u5de6\u533a\u95f4\u672a\u88ab\u5220\u9664\u7684\u6570\u7684\u4e2a\u6570\u4e0d\u5c0f\u4e8e\u5728\u5f53\u524d\u533a\u95f4\u7684\u6392\u540d\uff0c\u90a3\u4e48\u5f80\u5de6\u8fb9\u8d70\uff0c\u5426\u5219\u5f80\u53f3\u8fb9\u8d70\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u662f$O(n \\log n)$\u3002\uff08\u5f53\u7136\u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4+\u500d\u589e\u89e3\u51b3\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u76f8\u540c\uff09\n\n~~\u7136\u800c\u8dd1\u5f97\u6bd4\u591a\u5e26\u4e00\u4e2alog\u7684\u6811\u72b6\u6570\u7ec4+\u4e8c\u5206\u8fd8\u8981\u6162~~\n\n---\n# \u4ee3\u7801\n\n```cpp\n#include <cstdio>\n#include <cctype>\n#define rr register\nusing namespace std;\nint w[2800011],n;\ninline signed iut(){\n\trr int ans=0; rr char c=getchar();\n\twhile (!isdigit(c)) c=getchar();\n\twhile (isdigit(c)) ans=(ans<<3)+(ans<<1)+(c^48),c=getchar();\n\treturn ans;\n}\nvoid print(int ans){\n    if (ans>9) print(ans/10);\n    putchar(ans%10+48);\n}\ninline void build(int k,int l,int r){\n    if (l==r) {w[k]=1; return;}\n    rr int mid=(l+r)>>1;\n    build(k<<1,l,mid),build(k<<1|1,mid+1,r);\n    w[k]=w[k<<1]+w[k<<1|1];\n}\ninline void update(int k,int l,int r,int x){\n    if (l==r) {w[k]=0; return;}\n    rr int mid=(l+r)>>1;\n    if (x<=mid) update(k<<1,l,mid,x);\n        else update(k<<1|1,mid+1,r,x);\n    w[k]=w[k<<1]+w[k<<1|1];\n}\ninline signed kth(int k,int l,int r,int x){\n    if (l==r) return l;\n    rr int mid=(l+r)>>1;\n    if (w[k<<1]>=x) return kth(k<<1,l,mid,x);\n        else return kth(k<<1|1,mid+1,r,x-w[k<<1]);\n}\nsigned main(){\n    n=iut(),build(1,1,n);\n    for (rr int i=1,now=1;i<=n;++i,putchar(10)){\n        rr int t=(iut()+now)%w[1],del; if (!t) t=w[1];\n        print(del=kth(1,1,n,now=t)),update(1,1,n,del);\n    }\n    return 0;\n}\n```",
        "postTime": 1582099204,
        "uid": 37782,
        "name": "lemondinosaur",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3988 \u3010[SHOI2013]\u53d1\u724c\u3011"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u4e2a\u7b80\u6d01\u7684fhq-treap\u505a\u6cd5(\u5f53\u7136\u53ef\u4ee5\u6362\u6210\u5176\u4ed6\u66f4\u5feb\u7684\u5e73\u8861\u6811)\n\n\u76f4\u63a5\u6a21\u62df\uff0c\u628a\u5e73\u8861\u6811\u5f53\u505a\u53ef\u4ee5$\\Theta(\\log n)$\u8bbf\u95ee\u5e76\u5220\u9664\u4efb\u610f\u4f4d\u7f6e\u7684\u94fe\u8868\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\nconst int N=700011;\n#define ls c[rt][0]\n#define rs c[rt][1]\nint n,q,sz[N],c[N][2],val[N],rnd[N],rev[N],RT=0,cnt=0;\nint gi(){char c;int x=0;while((c=getchar_unlocked())<'0'||'9'<c);while('0'<=c&&c<='9')x=x*10+c-48,c=getchar_unlocked();return x;}\nint ne(int v){\n    val[++cnt]=v;\n    sz[cnt]=1;\n    rnd[cnt]=rand()<<15|rand();\n    return cnt;\n}\nvoid pu(int rt){sz[rt]=sz[ls]+sz[rs]+1;}\nvoid sl(int rt,int k,int &x,int &y){\n    if(!rt)return (void)(x=y=0);\n    if(sz[ls]>=k)y=rt,sl(ls,k,x,ls);\n    else x=rt,sl(rs,k-sz[ls]-1,rs,y);\n    pu(rt);\n}\nint mg(int x,int y){\n    if(!x||!y)return x+y;\n    if(rnd[x]<rnd[y]){\n        c[x][1]=mg(c[x][1],y);\n        pu(x);return x;\n    }\n    else{\n        c[y][0]=mg(x,c[y][0]);\n        pu(y);return y;\n    }\n}\nint get(int p){\n    int x,y,z,t;\n    sl(RT,p,x,z);\n    sl(x,p-1,x,y);\n    t=val[y];\n    RT=mg(mg(x,mg(c[y][0],c[y][1])),z);\n    return t;\n}\nint main(){\n    srand(time(0));\n    int n=gi(),cur=1;\n    for(int i=1;i<=n;++i)RT=mg(RT,ne(i));\n    for(int i=1;i<=n;++i){\n        cur=(cur+gi()-1)%(n-i+1)+1;//\u9876\u90e8\u724c\u6240\u5728\u4f4d\u7f6e\n        printf(\"%d\\n\",get(cur));\n    }\n}\n```",
        "postTime": 1579658454,
        "uid": 36532,
        "name": "localhost",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3988 \u3010[SHOI2013]\u53d1\u724c\u3011"
    },
    {
        "content": "\u601d\u8def\u6bd4\u8f83\u597d\u60f3\uff0c\u5c31\u662f\u628a\u4e00\u4e2a\u533a\u95f4\u7684\u724c\u79fb\u5230\u6700\u540e\uff0c\u7136\u540e\u5220\u6389\u724c\u9996\uff0c\u7136\u540e\u6211\u4eec\u6a21\u62df\u4e00\u4e0b\u53d1\u73b0\u76f4\u63a5\u6bcf\u6b21\u7ef4\u62a4\u5220\u9664\u7684\u4f4d\u7f6e\u53d6\u4e2a%\u5c31\u53ef\u4ee5\u4e86\uff0c\u7ebf\u6bb5\u6811\u7ef4\u62a4\u513f\u5b50\u6570\u91cf\uff0c\u6570\u5b66\u96be\u5ea6\u4e0d\u5230\u9ad8\u4e2d\u6c34\u5e73\uff0c\u6ca1\u5565\u597d\u8bf4\u660e\u7684\uff0c\u7ba1\u7406\u5458\u975e\u8981\u6211\u518d\u8bb2\u70b9\u5e9f\u8bdd\u624d\u8ba9\u901a\u8fc7\uff0c\u8fd9\u4ee3\u7801\u90fd\u770b\u4e0d\u61c2\u5565\u610f\u601d\u5efa\u8bae\u4e0d\u8981\u6253\u7701\u9009\u4e86\u3002\n```\n#include<iostream>\n#include<iomanip>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#define lson o<<1\n#define rson (o<<1)|1\nusing namespace std;\nconst int maxn=7e5+7;\nint n,now=1,son[maxn*8];\nvoid build_tree(int o,int l,int r)\n{\n\tson[o]=r-l+1;if(l==r) return ;int mid=(l+r)/2;\n\tbuild_tree(lson,l,mid);build_tree(rson,mid+1,r);\n}\nint find_it_del(int o,int l,int r,int rank)\n{\n\tint sum=son[lson],mid=(l+r)/2;son[o]--;if(l==r) return l; \n\tif(rank<=sum)  return find_it_del(lson,l,mid,rank);\n\telse return find_it_del(rson,mid+1,r,rank-sum);\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tbuild_tree(1,1,n);\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tint x;scanf(\"%d\",&x);now=(now+x-1)%(n-i+1)+1;\n\t\tint p1=find_it_del(1,1,n,now);\n\t\tprintf(\"%d\\n\",p1);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1569221844,
        "uid": 216395,
        "name": "Tekim",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3988 \u3010[SHOI2013]\u53d1\u724c\u3011"
    },
    {
        "content": "\u770b\u4e86\u6c99\u8336\u6570\u636e\u8303\u56f4\uff0c\u6211\u5c31\u653e\u5f03\u4e86\u5e73\u8861\u6811\uff0c\u6bd5\u7adf\u6211\u8fd9\u79cd\u4eba\u4e11\u5e38\u6570\u5927\u7684\u9009\u624b\uff1f\n\n\u7136\u540e\u5f00\u59cb\u601d\u8003\u7ebf\u6bb5\u6811\u6216\u8005\u6811\u72b6\u6570\u7ec4\uff0cyy\u4e86\u597d\u4e00\u4f1a\u513f\u624d\u60f3\u51fa\u4e00\u4e2a\u6c99\u8336\u7684\u505a\u6cd5\uff0c\u5199\u4e86\u4ee5\u540e\u53d1\u73b0\u9898\u89e3\u597d\u50cf\u6ca1\u6709\u6211\u8fd9\u4e48\u5199\u7684\uff0c\u5c31\u6765\u53e3\u80e1\u4e00\u4e0b\u3002\n\n\u5728\u7ebf\u6bb5\u6811\u4e0a\u7ef4\u62a4\u6bcf\u4e2a\u70b9\u5de6\u8fb9\u8fd8\u6709\u591a\u5c11\u4e2a\u5143\u7d20\u5b58\u5728\u3002\n\n\u6bcf\u6b21\u8be2\u95ee\u7684\u65f6\u5019\uff0c\u6709\u4e00\u4e2a\u4e0a\u6b21\u5f00\u59cb\u7684\u5220\u53bb\u7684\u4f4d\u7f6e$s$(\u521d\u59cb\u4e3a$0$)\uff0c\u7136\u540e\u7edf\u8ba1\u4e00\u4e0b$s$\u524d\u9762\u6709\u591a\u5c11\u4e2a\u5143\u7d20\uff0c\u5224\u65ad\u8fd9\u6b21\u5220\u6389\u7684\u662f\u5728$s$\u5de6\u8fb9\u8fd8\u662f\u53f3\u8fb9\u3002\n\n\u5047\u8bbe\u6bcf\u6b21\u8f93\u5165\u7684\u662f$d$\uff0c\u5982\u679c\u5728$s$\u5de6\u8fb9\uff0c\u5c31$d-$\u53f3\u8fb9\u5143\u7d20\u4e2a\u6570\uff0c\u5728\u53f3\u8fb9\u5c31$d+$\u5de6\u8fb9\u5143\u7d20\u4e2a\u6570\uff0c\u7136\u540e\u76f4\u63a5\u5728\u7ebf\u6bb5\u6811\u4e0a\u4e8c\u5206\u627e\u5c31\u53ef\u4ee5\u4e86\u3002\n\n------\n\n**Code:**\n\n```cpp\n#include <cstdio>\n#include <cctype>\n#include <algorithm>\nusing std::max;\nconst int N=7e5+10;\nint read()\n{\n\tint x=0;char c=getchar();\n\twhile(!isdigit(c)) c=getchar();\n\twhile(isdigit(c)) x=x*10+c-'0',c=getchar();\n\treturn x;\n}\nint sum[N],n,s;\nvoid add(int x){while(x<=n)++sum[x],x+=x&-x;}\nint ask(int x){int ret=0;while(x)ret+=sum[x],x-=x&-x;return ret;}\nint mx[N<<2],tag[N<<2];\n#define ls id<<1\n#define rs id<<1|1\nvoid build(int id,int l,int r)\n{\n\tmx[id]=r;\n\tif(l==r)return;\n\tint mid=l+r>>1;\n\tbuild(ls,l,mid),build(rs,mid+1,r);\n}\nvoid pushdown(int id)\n{\n\tif(tag[id])\n\t{\n\t\tmx[ls]+=tag[id],mx[rs]+=tag[id];\n\t\ttag[ls]+=tag[id],tag[rs]+=tag[id];\n\t\ttag[id]=0;\n\t}\n}\nvoid query(int id,int l,int r,int k)\n{\n\tif(l==r) {printf(\"%d\\n\",s=l),mx[id]=0,add(l);return;}\n\tpushdown(id);\n\tint mid=l+r>>1;\n\tif(mx[ls]>=k) query(ls,l,mid,k);\n\telse query(rs,mid+1,r,k);\n}\nvoid change(int id,int l,int r,int p)\n{\n\tif(l>=p){--mx[id],--tag[id];return;}\n\tpushdown(id);\n\tint mid=l+r>>1;\n\tif(p<=mid) change(ls,l,mid,p);\n\tchange(rs,mid+1,r,p);\n\tmx[id]=max(mx[ls],mx[rs]);\n}\nint main()\n{\n\tn=read();\n\tbuild(1,1,n);\n\tfor(int rig,lef,r,i=n;i;i--)\n\t{\n\t\tr=read()%i;\n\t\tlef=s-ask(s);//\u5de6\u8fb9\u4e2a\u6570\n\t\trig=i-lef;//\u53f3\u8fb9\u4e2a\u6570\n\t\tif(rig<=r) r-=rig;//\u5de6\u8fb9\n\t\telse r+=lef;\n\t\tquery(1,1,n,r+1);\n\t\tchange(1,1,n,s);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1549967210,
        "uid": 63727,
        "name": "ButterflyDew",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3988 \u3010[SHOI2013]\u53d1\u724c\u3011"
    }
]
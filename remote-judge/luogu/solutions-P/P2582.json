[
    {
        "content": "\u8fd9\u9898\u8bc4\u84dd\u662f\u4e0d\u662f\u8bc4\u4f4e\u4e86\u554a\u3002\n\n\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0 $g(f(x))=f(g(x))$\uff0c\u5373\u5982\u679c\u77e5\u9053 $g(x)$ \u7684\u8bdd\uff0c $g(f(x))$ \u5c31\u53ef\u4ee5\u7b80\u5355\u7b97\u51fa\u3002\n\n\u5c06\u6bcf\u4e00\u4e2a $g(x)$ \u5177\u8c61\u6210\u4e00\u4e2a\u70b9\uff0c\u53ef\u4ee5\u770b\u505a $g(x)$ \u4e0e $g(f(x))$ \u4e4b\u95f4\u8fde\u4e86\u4e00\u6761\u8fb9\u3002\u6839\u636e\u5e8f\u5217\u7684\u6027\u8d28\uff0c\u8fd9\u91cc\u7684\u6bcf\u4e2a\u70b9\u5165\u5ea6\u548c\u51fa\u5ea6\u5747\u4e3a\u4e00\uff0c\u6700\u7ec8\u5f62\u6210\u7684\u56fe\u662f\u4e00\u4e2a\u73af\u7684\u68ee\u6797\uff08\u8fd9\u91cc\u7528\u68ee\u6797\u8fd9\u4e2a\u8bcd\u662f\u56e0\u4e3a\u73af\u53ef\u4ee5\u770b\u6210\u9000\u5316\u7684\u57fa\u73af\u6811\uff09\u3002\n\n\u7136\u540e\u6211\u7684\u7b2c\u4e00\u4e2a\u60f3\u6cd5\u5c31\u662f\u5c06\u6bcf\u4e2a\u73af\u91cc\u9762\u6700\u5c0f\u7684\u90a3\u4e2a\u8bbe\u6210 $1$\uff0c\u7136\u540e\u66b4\u529b\u63a8\u51fa\u5176\u4ed6\u5df2\u77e5\u503c\u3002\u6700\u7ec8\u5f97\u5230\u4e86 10pts \u7684\u597d\u6210\u7ee9\u3002\n\n\u539f\u56e0\u662f\u8fd9\u91cc\u7684\u73af\u5fc5\u987b\u6ee1\u8db3\u73af\u5c3e\u548c\u73af\u5934\u662f\u76f8\u63a5\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5047\u8bbe\u7528 $f(x)$ \u8fed\u4ee3 $g(x)$ \u6240\u5f97\u73af\u7684\u957f\u5ea6\u4e3a $l$\uff0c\u90a3\u4e48 $f(x)$ \u8fed\u4ee3 $x$ \u6240\u5f97\u73af\u957f\u5ea6\u4e5f\u5f97\u662f $l$\u3002\n\n\u4e8e\u662f\u6211\u5c31 $\\Theta(n)$ \u627e\u73af+\u7edf\u8ba1\u73af\u6700\u5c0f\u73af\u9996\u9879\u503c\uff0c\u8d2a\u5fc3\u586b\u5165\uff0c\u6700\u7ec8\u83b7\u5f97\u4e86 20pts \u7684\u597d\u6210\u7ee9\u3002\n\n```cpp\nfor(int i=1; i<=n; ++i)\n{\n\tif(!li[i])\n\t{\n\t\tint ln = 1;\n\t\tfor(int j=fi[i]; j!=i; j=fi[j]) ++ln;\n\t\tli[i] = ln;\n\t\tfor(int j=fi[i]; j!=i; j=fi[j]) li[j] = ln;\n\t\tchkmin(ni[ln],i);\n\t}\n}\n\nfor(int i=1; i<=n; ++i)\n{\n\tif(!vi[i])\n\t{\n\t\tvi[i] = ni[li[i]];\n\t\tint curx = vi[i];\n\t\tfor(int j=fi[i]; j!=i; j=fi[j])\n\t\t{\n\t\t\tcurx = fi[curx];\n\t\t\tvi[j] = curx;\n\t\t}\n\t}\n}\n```\n\n\u539f\u56e0\u662f\uff0c\u5982\u679c $f(x)$ \u8fed\u4ee3 $x$ \u6240\u5f97\u73af\u957f\u5ea6\u4e3a $l$\uff0c\u53ea\u8981 $f(x)$ \u8fed\u4ee3 $g(x)$ \u6240\u5f97\u73af\u957f\u5ea6\u4e3a $l$ \u7684\u56e0\u6570\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u7136\u540e\u5c31\u662f\u73af\u957f\u56fa\u5b9a\u65f6\u6700\u5c0f\u9996\u9879\u7684\u95ee\u9898\u4e86\u3002\u9898\u89e3\u533a\u5927\u4f6c\u7528\u7684\u662f\u76f4\u63a5\u66b4\u529b $\\Theta(\\sqrt{l})$ \u679a\u4e3e\u56e0\u6570\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u975e\u5e38\u7684\u4f18\u826f\uff0c\u4e3a $\\Theta(n)$\u3002\u8bc1\u660e\u5f88\u7b80\u5355\u5c31\u4e0d\u8d34\u4e86\u3002\n\n\u6211\u6bd4\u8f83\u83dc\uff0c\u6211\u4ee5\u4e3a\u679a\u4e3e\u56e0\u6570\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4f1a\u98d9\u5230 $\\Theta(n\\sqrt{n})$\uff0c\u6240\u4ee5\u6211\u7528\u7684\u662f\u679a\u4e3e\u500d\u6570\u7684\u65b9\u6cd5\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u8c03\u548c\u7ea7\u6570 $\\Theta(n\\log n)$\u3002\n\n\u9644 AC \u4ee3\u7801\uff1a\n\n```cpp\n#include <cstdio>\nusing namespace std;\n\nvoid chkmin(int& a,int b) { if(a>b) a=b; }\n\nint fi[800005];\nint li[800005];\nint ni[800005];\nint vi[800005];\n\nint main()\n{\n\tint n;\n\tscanf(\"%d\",&n);\n\tfor(int i=1; i<=n; ++i) scanf(\"%d\",fi+i);\n\n\tfor(int i=1; i<=n; ++i) ni[i] = n;\n\n\tfor(int i=1; i<=n; ++i)\n\t{\n\t\tif(!li[i])\n\t\t{\n\t\t\tint ln = 1;\n\t\t\tfor(int j=fi[i]; j!=i; j=fi[j]) ++ln;\n\t\t\tli[i] = ln;\n\t\t\tfor(int j=fi[i]; j!=i; j=fi[j]) li[j] = ln;\n\t\t\tchkmin(ni[ln],i);\n\t\t}\n\t}\n\n\tfor(int i=1; i<=n; ++i)\n\t{\n\t\tfor(int j=2; j*i<=n; ++j)\n\t\t{\n\t\t\tchkmin(ni[j*i],ni[i]);\n\t\t}\n\t}\n\n\tfor(int i=1; i<=n; ++i)\n\t{\n\t\tif(!vi[i])\n\t\t{\n\t\t\tvi[i] = ni[li[i]];\n\t\t\tint curx = vi[i];\n\t\t\tfor(int j=fi[i]; j!=i; j=fi[j])\n\t\t\t{\n\t\t\t\tcurx = fi[curx];\n\t\t\t\tvi[j] = curx;\n\t\t\t}\n\t\t}\n\t}\n\n\tfor(int i=1; i<=n; ++i)\n\t{\n\t\tprintf(\"%d \",vi[i]);\n\t}\n}\n```",
        "postTime": 1586020691,
        "uid": 49458,
        "name": "\u6728\u6728\uff01",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2582 \u3010\u51fd\u6570\u3011"
    },
    {
        "content": "\u5f88\u597d\u7684\u4e00\u9053\u9898\u3002\u611f\u89c9\u8bc4\u84dd\u6709\u70b9\u4f4e\u4e86\u3002\n\n\u9996\u5148\u6ce8\u610f\u5230\u4e00\u4e2a\u6027\u8d28\uff1a\u5982\u679c $g(x)=k$\uff0c\u90a3\u4e48\u5c31\u6709\uff1a\n\n$$\ng(f(x))=f(g(x))=f(k)\n$$\n\n\u4ee5\u6b64\u7c7b\u63a8\uff0c\u6211\u4eec\u53ef\u4ee5\u63a8\u51fa\uff1a\u5bf9\u4efb\u610f\u7684 $m$\uff0c\u5747\u6709\uff1a\n\n$$\ng(f^{(m)}(x))=f^{(m)}(k)\n$$\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u6211\u4eec\u5c06\u6bcf\u4e2a $i$ \u548c $f(i)$ \u770b\u505a\u4e00\u6761\u6709\u5411\u8fb9 $i\\to f(i)$\uff0c\u90a3\u4e48\uff1a**\u5de6\u8fb9\u76f8\u5f53\u4e8e\u5728 $x$ \u6240\u5728\u7684\u73af\u4e0a\u8d70 $m$ \u6b65\uff0c\u53f3\u8fb9\u76f8\u5f53\u4e8e\u5728 $k$ \u6240\u5728\u7684\u73af\u4e0a\u8d70 $m$ \u6b65**\u3002\n\n\u65b9\u4fbf\u8d77\u89c1\uff0c\u6211\u4eec\u8bbe\u5efa\u56fe\u4e4b\u540e\u70b9 $i$ \u6240\u5728\u73af\u7684\u5927\u5c0f\u4e3a $\\text{Size}(i)$\u3002\n\n\u8fd9\u6837\u4e00\u6765\uff0c\u5982\u679c $g(x)=k$\uff0c\u90a3\u4e48\uff0c\u7531\u4e8e\u5bf9\u4efb\u610f\u7684 $m$\uff0c\u4e24\u8fb9\u5728\u5404\u81ea\u7684\u73af\u4e0a\u8d70 $m$ \u6b65\u540e\u7684\u503c\u90fd\u8981\u76f8\u7b49\uff0c\u5c31\u5fc5\u987b\u6709\uff1a\n\n$$\n\\text{Size}(k)\\mid\\text{Size}(x)\n$$\n\n\u5373 $\\text{Size}(k)$ \u4e3a $\\text{Size}(x)$ \u7684\u7ea6\u6570\u3002\u5426\u5219\uff0c\u5f53 $m=\\text{Size}(x)$ \u65f6\uff0c\u5df2\u7ecf\u51fa\u73b0\u4e86\u77db\u76fe\u3002\n\n\u90a3\u4e48\uff0c\u6211\u4eec\u9996\u5148\u5efa\u56fe\uff0c\u5bf9\u6bcf\u4e2a\u70b9\u6c42\u51fa\u5b83\u7684 $\\text{Size}(x)$\uff0c\u7136\u540e\u679a\u4e3e\u7ea6\u6570\u8ba1\u7b97\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n+\\sum\\sqrt{\\text{Size}(i)})=O(n)$\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n\nconst int MN=8e5+5;\n\nusing namespace std;\n\nint n,f[MN],g[MN];\nbool vis[MN];\nint mn[MN],s[MN];\n\nint dfs(int x){\n    if(vis[x])return 0;\n    vis[x]=1;\n    return dfs(f[x])+1;\n}\n\nvoid dfs2(int x,int sz){\n    if(vis[x])return ;\n    vis[x]=1,s[x]=sz;\n    dfs2(f[x],sz);\n}\n\nvoid dfs3(int x,int y){\n    if(vis[x])return ;\n    vis[x]=1,g[x]=y;\n    dfs3(f[x],f[y]);\n}\n\nint main(){\n    cin>>n;\n    for(int i=1;i<=n;i++)cin>>f[i];\n\n    for(int i=1;i<=n;i++){\n        if(!vis[i]){\n            s[i]=dfs(i);\n            if(!mn[s[i]])mn[s[i]]=i;\n        }\n    }\n\n    memset(vis,0,sizeof(vis));\n    for(int i=1;i<=n;i++)if(!vis[i])dfs2(i,s[i]);\n    \n    memset(vis,0,sizeof(vis));\n    for(int i=1;i<=n;i++){\n        if(!vis[i]){\n            int Mn=1000000;\n            for(int j=1;j*j<=s[i];j++){\n                if(s[i]%j==0){\n                    if(mn[j]>0)Mn=min(Mn,mn[j]);\n                    if(mn[s[i]/j]>0)Mn=min(Mn,mn[s[i]/j]);\n                }\n            }\n            dfs3(i,Mn);\n        }\n    }\n\n    for(int i=1;i<=n;i++)cout<<g[i]<<\" \";puts(\"\");\n    return 0;\n}\n```",
        "postTime": 1629769232,
        "uid": 307453,
        "name": "\u4e91\u6d45\u77e5\u5904",
        "ccfLevel": 6,
        "title": "P2582"
    },
    {
        "content": "\u8fd9\u662f1\u9053\u66fe\u7ecf\u662f \u666e\u53ca- \u7684\u9898\u76ee..\n\n\u5149\u770b\u6837\u4f8b\u6ca1\u4ec0\u4e48\u611f\u89c9..\u5148\u66b4\u529b\u627e\u627e\u89c4\u5f8b..\n\n\u4e8e\u662f\u53d1\u73b0.\n\n....\u5f53$f(i) = i$\u65f6,$g(j) = i(i < j <= n)$.\n\n....\u5f53$g(j) = j$\u65f6,\u5fc5\u5b9a\u6ee1\u8db3\u6761\u4ef6.\n\n\u5f88\u597d\u8bc1\u660e.\u56e0\u4e3a$f(g(i)) = g(f(i))$.\n\n\u5f53$f(i) = i$\u65f6,$f(g(i)) = g(i)$.\u76f8\u5f53\u4e8e$f(x) = x(x = g(i))$.\u6240\u4ee5$g(i)$\u53d6\u6ee1\u8db3\u6761\u4ef6$f(i) = i$\u6700\u5c0f\u7684i.\n\n\u5f53$g(j) = j$\u65f6,$f(j) = g(f(j))$.\u76f8\u5f53\u4e8e$g(x) = x(x = f(j))$.(\u5c31\u662f\u524d\u9762\u90a3\u4e2a$g(j) = j$...)\u6210\u7acb.\n\n\u8fd9\u65f6\u5019,$g(j)$\u786e\u5b9a,$f(j)$\u5df2\u77e5,\u90a3\u4e48\u5c31\u80fd\u77e5\u9053$g(f(j))$,\u8fdb\u800c\u77e5\u9053$f(g(j)),g(f(g(j)))$..\u8fd9\u6837\u80fd\u63a8\u51fa\u5168\u90e8\u7684$g(j)$.\n\n\u5177\u4f53\u7684.\u82e5$g(j)$\u5df2\u88ab\u786e\u5b9a.\u5219\u8df3\u8fc7.\u5426\u5219\u82e5\u6ee1\u8db3\u7b2c1\u6761.\u5219$g(j) = i$,\u5426\u5219$g(j) = j$.\n\n\u4e3b\u8981\u4ee3\u7801..\n```\ni = 1;\nwhile (i <= n)\n    if (g[i]){\n        gsum = f[g[i]];\n        fsum = f[i];\n        while (!g[fsum]){\n            g[fsum] = gsum;\n            gsum = f[g[fsum]];\n            fsum = f[fsum];\n        }\n        while (g[++i]);\n```\n\u5176\u5b9e\u5c31\u662f1\u4e2a\u627e\u73af\u7684\u8fc7\u7a0b........\n```\nf(i) -> g(f(i)) -> f(g(f(i))) ->.....\n```\n\u53ef\u4ee5\u770b\u51fa.\u5bf9\u4e8e\n```\nf = (2, 3, 4, 5, 1)\nf(1) -> f(f(1)) -> f(f(f(1))) ->.....\n2    -> 3       -> 4          ->.....\n```\n\u662f1\u4e2a\u957f\u5ea6\u4e3a5\u7684\u73af.\n\n\u53ef\u662f..\u53ea\u7528\u8fd92\u4e2a\u6027\u8d28.50..\n\n\u4f3c\u4e4e\u8fd8\u6709\u66f4\u4f18\u7684\u65b9\u6cd5.?\n\n\u5f3a\u884c\u628a$g(j) = j$\u6539\u6210$g(j) = 1$.30..\n\n\u53d6\u6700\u5c0f\u7684\u6ca1\u9009\u8fc7\u7684.?50..\u6ca1\u6709\u533a\u522b..\n\n\u6c89\u5bc22\u5929..\n\n\u81ea\u5df1\u9020\u6570\u636e\u5bf9\u62cd.\u56fa\u5b9a$n = 10,f(2) = 2$.\n\n\u771f\u7684\u53d1\u73b01\u7ec4\u4e0d\u5bf9\u7684\u6570\u636e..~~(\u60f3\u4e0d\u8d77\u6765.).~~\n\n\u7b80\u5355\u6817\u5b50.\n```\nf = (4, 3, 2, 1);\ng = (1, 2, 3, 4);//\u9519\u8bef.\ng = (1, 1, 4, 4);//\u6b63\u786e.\n```\n**\u539f\u67652\u4e2a\u540c\u957f\u5ea6\u7684\u73af\u53ef\u4ee5\u4e92\u6362.**.\n\n\u8fd9\u6837.\u53ea\u8981\u53d6\u5b57\u5178\u5e8f\u6700\u5c0f\u7684.\u5c31\u662f\u6700\u4f18\u7684\u4e86..\n\n\u7136\u800c....**\u957f\u5ea6\u80fd\u6574\u9664\u7684\u6362\u90fd\u80fd\u88ab\u66f4\u6362..**.\n\n\u6817\u5b50.\n```\nf = (6, 3, 4, 5, 2, 1, 8, 9, 10,7);\ng = (1, 1, 6, 1, 6, 6, 1, 6, 1, 6);\n```\n\u9700\u8981\u6240\u6709\u80fd\u88ab\u6574\u9664\u7684\u957f\u5ea6\u4e2d\u53d6\u5b57\u5178\u5e8f\u6700\u5c0f..\n\n\u8fd9\u6837.\u5f00\u5934\u8bf4\u7684\u7b2c1\u6761.$f(i) = i$\u8bf4\u660e\u662f\u4e2a\u957f\u5ea6\u4e3a1\u7684\u73af..\u6240\u4ee5\u53ef\u4ee5\u66ff\u6362\u6240\u6709\u7684\u73af..\n\n\u8fd8\u67091\u4e2a\u91cd\u8981\u7684\u6761\u4ef6.\u9898\u76ee\u5df2\u7ecf\u8bf4\u660e\u7ed9\u51fa\u7684$f(i)$\u662f\u5168\u6392\u5217..\n\n\u90a3\u5c31\u6ca1\u6709\u4ea4\u53c9\u73af\u7684\u73b0\u8c61\u4e86..\u4e5f\u80fd\u89e3\u91ca\u5f00\u5934\u7684\u5f1f2\u6761..\u6709\u6ca1\u6709\u89e3\u5012\u662f\u6ca1\u7814\u7a76\u8fc7..\n\n\u7528$sum[i]$\u8bb0\u5f55\u7b2ci\u4f4d\u7684\u73af\u7684\u957f\u5ea6.$f[i]$\u8bb0\u5f55\u957f\u5ea6\u4e3ai\u7684\u73af\u5b57\u5178\u5e8f\u6700\u5c0f\u7684\u5f00\u5934.\n\n~~(sum[i]\u5199\u6210[i]..)..~~\n\n\u5148\u8bbe$k = i$.\u679a\u4e3e$sum[i]$\u6240\u6709\u7684\u7ea6\u6570.\u7528\u6700\u5c0f\u7684$f[x]$\u66ff\u6362$k$.\n\n80W\u6709\u70b9\u5927...\u53ea\u8981\u679a\u4e3e$\\sqrt{sum[i]}$.\u5c31\u53ef\u4ee5\u8fc7\u4e86....\n\n($n*\\sqrt{\\sqrt{80W}}???$)....\n\n\u53e6\u5916,\u7531\u4e8e\u4e0d\u540c\u957f\u5ea6\u7684\u73af\u6700\u591a\u4e0d\u8d85\u8fc71500\u79cd.\u4e5f\u53ef\u4ee5\u5bf9\u73af\u957f\u5ea6\u79bb\u6563\u540e\u66b4\u529b\u5224\u65ad..\n\nDiu\u4ee3\u7801..\n```\n//\u7b2c2\u79cd.\nprogram P2582;\n var\n  a,b,sum,f,s,fst:array[0..800001] of longint;\n  i,ij,j,k,p,n,nf:longint;\n begin\n  readln(n);\n  for i:=1 to n do\n   read(a[i]);             //f\u6570\u7ec4.\n  readln;\n  fillchar(b,sizeof(b),0); //g\u6570\u7ec4.\n  for i:=1 to n do\n   sum[i]:=1;              //\u7edf\u8ba1\u73af\u957f\u5ea6.\n  fillchar(f,sizeof(f),0); //\u7edf\u8ba1\u73af\u957f\u5ea6\u4e3ai\u7684\u5b57\u5178\u5e8f\u6700\u5c0f\u7684\u5f00\u5934..\n  for i:=1 to n do         //\u5148\u627e\u73af\u957f\u5ea6..\n   if b[i]=0 then\n    begin\n     p:=i;\n     while a[p]<>i do\n      begin\n       inc(sum[i]);\n       b[p]:=1;\n       p:=a[p];\n      end;\n     if f[sum[i]]=0 then f[sum[i]]:=i;\n    end;\n  fillchar(b,sizeof(b),0);\n  nf:=0;                   //\u73af\u957f\u5ea6\u4e0d\u540c\u7684\u4e2a\u6570..\n  for i:=1 to n do\n   if f[i]<>0 then\n    begin\n     inc(nf);\n     f[nf]:=f[i];\n     s[nf]:=i;             //\u8bb0\u5f55\u957f\u5ea6.\n    end;\n  for i:=1 to nf do\n   for j:=1 to nf do\n    if (s[i] mod s[j]=0) and (f[j]<f[i]) then f[i]:=f[j];                //\u5b57\u5178\u5e8f\u4fee\u6539.\n  for i:=1 to nf do\n   fst[s[i]]:=f[i];        //\u8fd8\u539f.\n  for i:=1 to n do\n   if b[i]=0 then          //\u91cd\u65b0\u518d\u8dd11\u904d\u73af..\u6c42\u51fag\u6570\u7ec4.\n    begin\n     k:=fst[sum[i]];\n     p:=i;\n     while b[p]=0 do\n      begin\n       b[p]:=k;\n       k:=a[b[p]];\n       p:=a[p];\n      end;\n    end;\n  for i:=1 to n-1 do\n   write(b[i],' ');\n  writeln(b[n]);\n end.\n```\n```\n//\u7b2c1\u79cd..\nprogram P2582;\n var\n  a,b,sum,f:array[0..800001] of longint;\n  i,ij,j,k,p,n:longint;\n begin\n  readln(n);\n  for i:=1 to n do\n   read(a[i]);\n  readln;\n  fillchar(b,sizeof(b),0);\n  for i:=1 to n do\n   sum[i]:=1;\n  filldword(f,sizeof(f)>>2,1008208820);\n  for i:=1 to n do\n   if b[i]=0 then\n    begin\n     p:=i;\n     while a[p]<>i do //\u5148\u627e\u957f\u5ea6..\n      begin\n       inc(sum[i]);\n       p:=a[p];\n      end;\n     k:=i;\n     for j:=1 to n do\n      if j*j<=sum[i] then //\u679a\u4e3e\u957f\u5ea6..\n       begin\n        if (sum[i] mod j=0) then\n         begin\n          p:=sum[i] div j;\n          if f[j]<k then k:=f[j];\n          if f[p]<k then k:=f[p];//\u5bf92\u4e2a\u7ea6\u6570\u5224\u65ad\u5b57\u5178\u5e8f.\n         end;\n       end\n                     else break;\n     if f[sum[i]]>=k then f[sum[i]]:=k;//\u4fee\u6539\u5b57\u5178\u5e8f\u6700\u5c0f..\n     p:=i;    //\u91cd\u65b0\u590d\u539fg\u6570\u7ec4..\n     while b[p]=0 do\n      begin\n       b[p]:=k;\n       k:=a[b[p]];\n       p:=a[p];\n      end;\n    end;\n  for i:=1 to n-1 do\n   write(b[i],' ');\n  writeln(b[n]);\n end.\n```\n(\u0ca1\u03c9\u0ca1).\n",
        "postTime": 1519027051,
        "uid": 20454,
        "name": "BFSBFSBFSBFS",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2582 \u3010\u51fd\u6570\u3011"
    },
    {
        "content": "\u9996\u5148\u6c42\u51fa\u5168\u6392\u5217\u4e2d\u6bcf\u4e2a\u6570\u6240\u5728\u73af\u7684\u5927\u5c0f\uff0c\n\n\u4f8b\u5982f(a)=b,f(b)=c,f(c)=a\u5c31\u662f\u5927\u5c0f\u4e3a3\u7684\u73af\n\n\u7136\u540e\u6c42\u51fa\u6bcf\u4e2a\u5927\u5c0f\u7684\u73af\u4e2d\u5b57\u5178\u5e8f\u6700\u5c0f\u7684\u73af\uff08\u8bb0\u5f55\u5f00\u5934\u6700\u5c0f\u7684\u6570\u5373\u53ef\uff09 \n\n\u7136\u540e\u5bf9\u4e8e\u5168\u6392\u5217\u4e2d\u6bcf\u4e2a\u73af\uff0c\u62ff\u5b57\u5178\u5e8f\u6700\u5c0f\u7684\u66ff\u6362\u5373\u53ef\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\nusing namespace std;\n#define maxn 800005\nint a[maxn],b[maxn],c[maxn],d[maxn];\nint main(){\n    int n,x,si,y;scanf(\"%d\",&n);\n    for(int i=1;i<=n;i++)scanf(\"%d\",a+i);\n     for(int i=1;i<=n;i++){//\u6c42\u73af\n     \tif(c[i])continue;\n     \tx=i,si=0;\n        do{\n        \tsi++;\n        \tx=a[x];\n        }while(x!=i);\n        do{\n        \tc[x]=si;\n            x=a[x];\n        }while(x!=i);\n        if(!d[si]){\n        \td[si]=i;\n        \tfor(int j=sqrt(si);j>0;j--){\n        \t\tif(si%j==0){\n        \t\t\tif(d[si/j])d[si]=min(d[si],d[si/j]);\n        \t\t\tif(d[j])d[si]=min(d[si],d[j]);\n                }\n            }\n        }\n    }\n    for(int i=1;i<=n;i++){\n    \tif(d[i]){\n    \t\tfor(int j=sqrt(i+1);j>0;j--){\n        \t\tif(i%j==0){\n        \t\t\tif(d[i/j])d[i]=min(d[i],d[i/j]);\n        \t\t\tif(d[j])d[i]=min(d[i],d[j]);\n                }\n            }\n        }\n    }\n    for(int i=1;i<=n;i++){//\u66ff\u6362\n        if(b[i])continue;\n        x=i,y=d[c[i]];\n        do{\n            b[x]=y;\n            x=a[x],y=a[y];\n        }while(x!=i);\n    }\n    for(int i=1;i<=n;i++)printf(\"%d \",b[i]);\n    return 0;\n} \n```",
        "postTime": 1518594279,
        "uid": 25218,
        "name": "\u6731\u6c5f\u9ec4\u6cb3",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2582 \u3010\u51fd\u6570\u3011"
    }
]
[
    {
        "content": "\u9996\u5148\uff0c\u5c1d\u8bd5\u5229\u7528 OEIS \u5f97\u5230\u7ed3\u8bba\u3002\n\n\u5f53 $m = 2$ \u65f6\uff0c\u6570\u5217 $J_2(n) =$ [A006257](https://oeis.org/A006257)\u3002\n\n\u5f53 $m = 3$ \u65f6\uff0c\u6570\u5217 $J_3(n) =$ [A337191](https://oeis.org/A337191)\u3002\n\n\u5728 [A337191](https://oeis.org/A337191) \u4e2d\u63d0\u5230\uff1a\u5bf9\u4e8e $J_3(n)$\uff0c\n\n- \u6bcf\u4e2a\u6b63\u6574\u6570 $n$ \u90fd\u80fd\u88ab\u8868\u8fbe\u4e3a $2 \\cdot 3^k + 2m$\uff08$0 \\leq m < 2 \\cdot 3^k$\uff09\u6216 $3^k + 2m$\uff08$0 \\leq m < 3^k$\uff09\u7684\u5f62\u5f0f\uff0c\u5176\u4e2d $k$ \u4e3a\u975e\u8d1f\u6574\u6570\u3002\n\n- \u5728\u4efb\u4e00\u60c5\u51b5\u4e0b\uff0c$J_3(n) = 3m + 1$\u3002\n\n\u5728\u8fd9\u91cc\uff0c\n\n- ${\\it{m}} = \\dfrac{J_3(n) - 1}{3}$ \u662f\u6574\u6570\u3002\n\n- $n = c \\cdot 3^k + 2m$\uff0c\u5176\u4e2d $1 \\leq c < 3, 0 \\leq m < c \\cdot 3^k$\u3002\n\n- \u5f53 $n$ \u662f\u5947\u6570\u65f6\uff0c$c = 1$\uff1b\u5f53 $n$ \u662f\u5076\u6570\u65f6\uff0c$c = 2$\u3002\n\n\u6240\u4ee5\u731c\u6d4b\u6570\u5217\u7684\u4e00\u822c\u5f62\u5f0f\uff1a\u5bf9\u4e8e $J_m(n)$\uff0c\n\n- $t = \\dfrac{J_m(n) - 1}{m}$ \u662f\u6574\u6570\u3002\n\n- $n = c \\cdot m^k + (m - 1) \\cdot t$\uff0c\u5176\u4e2d $1 \\leq c < m, 0 \\leq t < c \\cdot m^k$\u3002\n\n- $c = (n - 1) \\bmod (m - 1) + 1$\u3002\n\n\u5e76\u4e14 $k$ \u662f\u4f7f $c \\cdot m^k \\leq n$ \u7684\u6700\u5927\u7684\u975e\u8d1f\u6574\u6570 $k$\u3002\n\n\u6ce8\uff1a\u53e6\u4e00\u79cd\u5f97\u5230\u7ed3\u8bba\u7684\u65b9\u5f0f\u662f\u9605\u8bfb [\u8bba\u6587](https://arxiv.org/pdf/1803.11340.pdf) \u4e2d\u7684 Theorem 1\u3002\n\n---\n\n\u4e8e\u662f\u5c31\u6709\u4e86\u4ee5\u4e0b\u7684\u90e8\u5206\u5206\u4ee3\u7801\uff1a\u5176\u4e2d\uff0c\n\n- \u5148\u8ba1\u7b97 $c = (n - 1) \\bmod (m - 1) + 1$\uff0c\n- \u7136\u540e\u8ba1\u7b97\u6700\u5927\u7684 $c \\cdot m^k \\leq n$\uff0c\n- \u6700\u540e\u8fd4\u56de $J_m(n) = t \\cdot m + 1$\uff0c\u5176\u4e2d $t = \\dfrac{n - c \\cdot m^k}{n - 1}$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$\\mathcal{O}((r - l + 1) \\cdot \\log_m r)$\uff0c\u53ef\u4ee5\u5f97 $20$ \u5206\u3002\n\n```cpp\nLL f(LL n) {\n\tLL c = (n - 1) % (m - 1) + 1;\n\twhile (c <= n / m) c *= m;\n\treturn (n - c) / (m - 1) * m + 1;\n}\n\nvoid solve() {\n\tread(m); read(l); read(r);\n\tLL ans = 0;\n\tfor (LL i = l; i <= r; i++) {\n\t\tans = (ans + f(i)) % p;\n\t}\n\tprint(ans);\n}\n```\n\n---\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u9700\u8981\u4f18\u5316\u6c42\u548c\u7684\u90e8\u5206\u3002\n\n\u8981\u6c42\u7b54\u6848 ${\\large \\sum \\limits _{n \\leq N}} \\left ( \\dfrac{n - c \\cdot m^k}{m - 1} \\cdot m + 1 \\right )$\uff0c\u9700\u8981\u5feb\u901f\u5730\u6c42 $c \\cdot m^k$ \u7684\u524d\u7f00\u548c\u3002\n\n\u8bbe $x = c \\cdot m^k$\uff0c$x$ \u51fa\u73b0\u5728\u7b54\u6848\u4e2d\u5f53\u4e14\u4ec5\u5f53 $x$ \u9664\u53bb\u6240\u6709 $m$ \u7684\u56e0\u5b50\u540e\uff0c\u5f97\u5230\u7684\u6570 $c$ \u6ee1\u8db3 $1 \\leq c < m$\u3002\n\n$x$ \u5728\u7b54\u6848\u4e2d\u7684\u51fa\u73b0\u6b21\u6570\u662f\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u7684 $n$ \u7684\u4e2a\u6570\uff1a\n\n- $n \\leq N$\uff1b\n- $n \\equiv c \\pmod {m-1}$\uff1b\n- $x \\leq n < m \\cdot x$\u3002\n\n\u56e0\u4e3a $c \\cdot m^k \\equiv c \\pmod {m - 1}$\uff0c\u6240\u4ee5\u6761\u4ef6\u4e8c\u53d8\u4e3a $n \\equiv x \\pmod {m-1}$\u3002\u5e76\u5c06 $n - x$ \u66ff\u6362\u4e3a $n$ \u5f97\u5230\uff1a\n\n- $n \\leq N - x$\uff1b\n- $n \\equiv 0 \\pmod {m-1}$\uff1b\n- $0 \\leq n < (m - 1) \\cdot x$\u3002\n\n\u6240\u4ee5\u5171\u6709 $\\min \\left( x, \\left \\lfloor \\dfrac{N - x}{m - 1} \\right \\rfloor + 1 \\right)$ \u4e2a $n$\u3002\n\n\u5230\u6b64\uff0c\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e\u6240\u6709 $c, k$\uff0c\u8ba1\u7b97\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u3002\n\n\u4e8e\u662f\u6709\u4e86\u4ee5\u4e0b\u7684\u4ee3\u7801\uff0c\u5176\u4e2d\u53d8\u91cf $L$ \u4ee3\u8868\u7684\u662f $x = c \\cdot m^k$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(m \\log_m N)$\uff0c\u53ef\u4ee5\u5f97 $47$ \u5206\u3002\n\n```cpp\nLL solve(LL N) {\n\tLL ans = 0;\n\tfor (LL c = 1; c <= m - 1; c++) {\n\t\tfor (LL L = c; L <= N; L = L * m) {\n\t\t\tans += L * min(L, (N - L) / (m - 1) + 1);\n\t\t}\n\t}\n\tans = N * (N + 1) / 2 - ans;\n\tans = ans / (m - 1) * m;\n\tans = ans + N;\n\treturn ans;\n}\n\nvoid solve() {\n\tread(m); read(l); read(r);\n\tLL ans = solve(r) - solve(l - 1);\n\tprint(ans % p);\n}\n```\n\n---\n\n\u4e3a\u4e86\u4e0d\u679a\u4e3e $c$\uff0c\u8003\u8651\u8c03\u6362\u4e24\u5c42\u5faa\u73af\u7684\u987a\u5e8f\uff1a\n\n```cpp\nfor (LL w = 1; w <= N; w = w * m) {\n\tLL lim = min(m - 1, N / w);\n\tfor (LL c = 1; c <= lim; c++) {\n\t\tans += c * w * min(c * w, (N - c * w) / (m - 1) + 1);\n\t}\n}\n```\n\n\u5bf9\u4e8e\u56fa\u5b9a\u7684 $w = m^k$\uff0c$c$ \u7684\u4e0a\u754c\u662f $\\min \\left (m - 1, \\dfrac{N}{w} \\right )$\uff0c\u56e0\u4e3a $1 \\leq c < m$\uff0c\u5e76\u4e14 $x = c \\cdot m^k = c \\cdot w \\leq N$\u3002\n\n\u5982\u4f55\u66f4\u5feb\u5730\u5bf9\u4e8e\u6240\u6709 $1 \\leq c \\leq \\text{lim}$ \u6c42 $c \\cdot w \\cdot \\min \\left ( c \\cdot w , \\left \\lfloor \\dfrac{N - c \\cdot w}{m - 1} \\right \\rfloor + 1 \\right )$ \u7684\u548c\uff1f\n\n\u4e3a\u4e86\u6446\u8131 $\\min$ \u51fd\u6570\uff0c\u89c2\u5bdf\u5230\u968f\u7740 $c$ \u7684\u589e\u52a0\uff0c$c \\cdot w$ \u5355\u8c03\u589e\uff0c$\\left \\lfloor \\dfrac{N - c \\cdot w}{m - 1} \\right \\rfloor + 1$ \u5355\u8c03\u4e0d\u589e\u3002\n\n\u4e8c\u5206\u51fa\u4ea4\u754c\u70b9\u540e\uff0c\u5206\u522b\u6c42 $c \\cdot w \\cdot c \\cdot w$ \u548c $c \\cdot w \\cdot \\left ( \\left \\lfloor \\dfrac{N - c \\cdot w}{m - 1} \\right \\rfloor + 1 \\right )$ \u7684\u524d\u7f00\u548c\u3002\n\n\u524d\u8005\u53ef\u4ee5\u7528\u5e73\u65b9\u548c\u516c\u5f0f\u8ba1\u7b97\uff0c\u540e\u8005\u9700\u8981\u7c7b\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\uff0c\u53ef\u4ee5\u53c2\u89c1 P5170 \u7684\u9898\u89e3\u5b66\u4e60\u7c7b\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(\\log_m N \\cdot \\log_{\\varphi} m) = \\mathcal{O}(\\log N)$\uff0c\u53ef\u4ee5\u5f97 $100$ \u5206\u3002\n\n\u5230\u6b64\u6211\u4eec\u5c31\u505a\u5b8c\u4e86\u8fd9\u9898\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef __int128 LL;\n\nvoid read(LL &x) {\n\tlong long y;\n\tscanf(\"%lld\", &y);\n\tx = y;\n}\n\nvoid print(LL x) {\n\tx = x % 998244353;\n\tlong long y;\n\ty = x;\n\tprintf(\"%lld\\n\", y);\n}\n\nstruct node {LL f, g, h;};\nLL sum0(LL N) {return N + 1;}\nLL sum1(LL N) {return N * (N + 1) / 2;}\nLL sum2(LL N) {return N * (N + 1) * (2 * N + 1) / 6;}\nLL sqr(LL N) {return N * N;}\n\nnode euclid(LL N, LL A, LL B, LL C) {\n\tnode ans;\n\tif (A == 0) {\n\t\tans.f = sum0(N) * (B / C);\n\t\tans.g = sum0(N) * sqr(B / C);\n\t\tans.h = sum1(N) * (B / C);\n\t} else if (A >= C || B >= C) {\n\t\tnode t = euclid(N, A % C, B % C, C);\n\t\tans.f = t.f + sum1(N) * (A / C) + sum0(N) * (B / C);\n\t\tans.g = t.g + 2 * t.h * (A / C) + 2 * t.f * (B / C) +\n\t\t\tsum2(N) * sqr(A / C) + \n\t\t\tN * (N + 1) * (A / C) * (B / C) +\n\t\t\tsum0(N) * sqr(B / C);\n\t\tans.h = t.h + sum2(N) * (A / C) + sum1(N) * (B / C);\n\t} else {\n\t\tLL M = (A * N + B) / C;\n\t\tnode t = euclid(M - 1, C, C - B - 1, A);\n\t\tans.f = N * M - t.f;\n\t\tans.g = N * M * (M + 1) - ans.f - (t.f + t.h) * 2;\n\t\tans.h = N * M * (N + 1) / 2 - (t.f + t.g) / 2;\n\t}\n\treturn ans;\n}\n\nLL F(LL N, LL A, LL B, LL C) {\n\tA = A - N * B;\n\tnode t = euclid(N, B, A, C);\n\tLL ans = N * t.f - t.h;\n\treturn ans;\n}\n\nLL m, l, r;\n\nLL solve(LL N) {\n\tLL ans = 0;\n\t\n\tfor (LL w = 1; w <= N; w = w * m) {\n\t\tLL lim = min(m - 1, N / w);\n\t\t\n\t\tLL L = 1, R = lim, Ans = 0;\n\t\twhile (L <= R) {\n\t\t\tLL Mid = (L + R) / 2;\n\t\t\tif (Mid * w <= (N - Mid * w) / (m - 1) + 1) {\n\t\t\t\tAns = Mid;\n\t\t\t\tL = Mid + 1;\n\t\t\t} else {\n\t\t\t\tR = Mid - 1;\n\t\t\t}\n\t\t}\n\t\t\n\t\t// 0 ... Ans\n\t\tans += Ans * (Ans + 1) * (2 * Ans + 1) / 6 * w * w;\n\t\t// Ans + 1 ... lim\n\t\tans += w * (F(lim, N, w, m - 1) - F(Ans, N, w, m - 1));\n\t\tans += (lim * (lim + 1) / 2 - Ans * (Ans + 1) / 2) * w;\n\t}\n\t\n\tans = N * (N + 1) / 2 - ans;\n\tans = ans / (m - 1) * m;\n\tans = ans + N;\n\treturn ans;\n}\n\nvoid solve() {\n\tread(m); read(l); read(r);\n\tprint(solve(r) - solve(l - 1));\n}\n\nint main() {\n\tint t;\n\tscanf(\"%d\", &t);\n\twhile (t--) {\n\t\tsolve();\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1646224492,
        "uid": 42299,
        "name": "zengminghao",
        "ccfLevel": 0,
        "title": "P8181\u300cEZEC-11\u300dCircle \u9898\u89e3"
    },
    {
        "content": "\u8003\u8651\u5982\u4f55\u6c42\u51fa $J_m(n)$\u3002\n\n\u9012\u5f52\uff0c\u5982\u679c $n < m$\uff0c$J_m(n)=1$\uff1b\n\n\u5982\u679c $n \\geq m$\uff0c\u8003\u8651\u62a5\u4e00\u904d $1-m$\uff1a\n\n![TK7ZSe.png](https://s4.ax1x.com/2021/12/21/TK7ZSe.png)\n\n\u6240\u4ee5\u6709\uff1a\n\n$$J_m(n)=\\begin{cases}1 & J_m(n-m+1)=n-m+1\\\\J_m(n-m+1)+m &  \\text{else}\\end{cases}$$\n\n\u4e8e\u662f\u53ef\u4ee5\u5c06 $n$ \u6309\u6a21 $m-1$ \u5206\u7c7b\uff0c\u8fd9\u6837\u5728\u6bcf\u4e00\u7c7b\u4e2d\uff0c\u9664\u4e86\u82e5\u5e72\u4e2a $J_m(n)=n$ \u7684\u4f4d\u7f6e\u5916\uff0c\u90fd\u662f\u516c\u5dee\u4e3a $m$ \u7684\u7b49\u5dee\u6570\u5217\u3002\n\n--------\n\n\u8003\u8651\u6bcf\u4e00\u7c7b\u4e2d\u6709\u54ea\u4e9b\u4e0d\u6ee1\u8db3\u7b49\u5dee\u7684\u4f4d\u7f6e\uff08\u4e0b\u79f0\u65ad\u70b9\uff09\u3002\n\n\u7531\u4e8e $J_m(n)=n$ \u7684\u4e0b\u4e00\u9879\u5fc5\u7136\u662f $1$\uff0c\u6240\u4ee5\u4e00\u4e2a $1$ \u5bf9\u5e94\u4e00\u4e2a\u65ad\u70b9\u3002\n\n\u601d\u8003 $J_m(n)$ \u4ec0\u4e48\u60c5\u51b5\u4e0b\u4e3a $1$\uff1a\n\n\u4e0a\u9762\u63d0\u8fc7 $1 \\leq n < m$ \u7684\u65f6\u5019\u662f $1$\uff1b\n\n\u5f53 $n \\geq m$ \u65f6\uff0c\u6613\u5f97 $n$ \u5fc5\u7136\u662f $m$ \u7684\u500d\u6570\uff0c\u5426\u5219\u62a5\u5b8c\u4e00\u5708\u540e $1$ \u4e00\u5b9a\u5f53\u573a\u51fa\u5c40\uff0c\u4e8e\u662f\u9664 $m$ \u540e\u5f52\u7eb3\u3002\n\n\u53ef\u5f97\u65ad\u70b9\u53ea\u6709 $k \\times m^a$ \u7684\u5f62\u5f0f\uff0c\u5176\u4e2d $1 \\leq k \\leq m-1$\u3002\n\n\u90a3\u4e48\u6bcf\u4e2a\u540c\u4f59\u7c7b\u4e2d\u5c31\u53ea\u6709 $\\log$ \u4e2a\u65ad\u70b9\uff08$k \\times m^a$ \u6b63\u597d\u5728 $k$ \u8fd9\u4e2a\u540c\u4f59\u7c7b\u4e2d\uff09\uff0c\u62c6\u6210 $\\log$ \u4e2a\u7b49\u5dee\u6570\u5217\u5206\u522b\u6c42\u548c\u5373\u53ef\u3002\n\n\u8fd9\u6837\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a $\\Theta(m\\log_m a)$ \u7684\u7b97\u6cd5\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i$ \u66b4\u529b\u627e\u51fa\u5176\u524d\u9762\u6700\u540e\u4e00\u4e2a\u65ad\u70b9\uff0c\u5c31\u80fd\u5f97\u5230\u4e00\u4e2a $\\Theta(\\log_m a)$ \u7684\u5355\u70b9\u6c42\u503c\u7b97\u6cd5\u3002\n\n\u4e24\u8005\u7ed3\u5408\u8d77\u6765\u53ef\u4ee5\u5f97\u5230 $55$ \u5206\u7684\u597d\u6210\u7ee9\u3002\n\n--------\n\n\u7ee7\u7eed\u89c2\u5bdf\u7b2c $k$ \u7ec4\u7684\u7b54\u6848\u3002\n\n\u4e8b\u5b9e\u4e0a\u65ad\u70b9\u662f $k \\times m^a$ \u7684\u5f62\u5f0f\uff0c\u800c\u70b9\u7684\u4e2a\u6570\u662f $\\lfloor \\frac{n-k}{m-1}+1 \\rfloor$\u3002\n\n\u53ea\u8981\u65ad\u70b9\u7684\u4e2a\u6570\u76f8\u540c\uff0c\u5e76\u4e14\u70b9\u7684\u4e2a\u6570\u76f8\u540c\uff0c\u90a3\u4e48\u53ef\u4ee5\u53d1\u73b0\u7b54\u6848\u5c31\u662f\u5173\u4e8e $k$ \u7684\u4e0d\u8d85\u8fc7 $2$ \u6b21\u7684\u591a\u9879\u5f0f\u3002\u800c\u65ad\u70b9\u4e2a\u6570\u548c\u70b9\u7684\u4e2a\u6570\u90fd\u53ea\u6709\u4e24\u79cd\uff0c\u6240\u4ee5\u6309\u8fd9\u4e2a\u628a\u8981\u7b97\u7684\u4e1c\u897f\u5206\u6210\u4e09\u6bb5\uff0c\u5bf9\u6bcf\u4e00\u6bb5\u63d2\u503c\u7b97\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(\\log_m a)$\u3002",
        "postTime": 1645886283,
        "uid": 197493,
        "name": "unputdownable",
        "ccfLevel": 7,
        "title": "P8181 Circle \u9898\u89e3"
    }
]
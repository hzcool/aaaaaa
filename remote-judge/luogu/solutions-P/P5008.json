[
    {
        "content": "## [yLOI2018] \u9526\u9ca4\u6284\n\n\u6211\u6c38\u8fdc\u559c\u6b22\u94f6\u4e34\u5973\u795e\uff01  \n\u8fd9\u662f\u4e00\u7bc7\u5b8c\u5168\u91cd\u6784\u540e\u7684\u9898\u89e3\u3002\n\n### Description\n\n\u7ed9\u4f60\u4e00\u5f20\u6709\u5411\u56fe\uff0c\u6bcf\u4e2a\u70b9\u6709\u4e00\u4e2a\u70b9\u6743\u3002\u4efb\u610f\u65f6\u523b\u4f60\u53ef\u4ee5\u4efb\u610f\u9009\u62e9\u4e00\u4e2a**\u6709\u5165\u5ea6**\u7684\u70b9\uff0c\u83b7\u5f97\u5b83\u7684\u70b9\u6743\u5e76\u628a\u5b83\u548c\u5b83\u7684\u51fa\u8fb9\u4ece\u56fe\u4e0a\u5220\u53bb\u3002\u6700\u591a\u80fd\u9009\u62e9 $k$ \u4e2a\u70b9\uff0c\u6c42\u6700\u591a\u80fd\u83b7\u5f97\u591a\u5c11\u70b9\u6743\u3002\n\n$1 \\leq n \\leq 5 \\times 10^5 + 4$\uff0c$1 \\leq m \\leq 2 \\times 10^6 + 4$\uff0c$0 \\leq w_i \\leq 10^3$\uff0c$0 \\leq k \\leq n$\u3002\n\n### Analysis\n\n#### Algorithm 1\n\n\u7206\u641c\uff0c\u641c\u51fa\u6240\u6709\u5220\u70b9\u7684\u987a\u5e8f\uff0c\u590d\u6742\u5ea6 $O(A_n^k)$\uff0c\u671f\u671b\u5f97\u5206 $30$ \u5206\u3002\n\n#### Algorithm 2\n\n\u8003\u8651\u4e00\u4e2a DAG\uff0c\u6211\u4eec\u6309\u62d3\u6251\u5e8f\u4ece\u540e\u5411\u524d\uff08\u82e5 $u$ \u6307\u5411 $v$\uff0c\u5219 $u$ \u5728 $v$ \u4e4b\u524d\uff09\u5220\u70b9\uff0c\u5219\u5220\u9664\u540e\u9762\u7684\u70b9\u4e0d\u4f1a\u5bf9\u524d\u9762\u7684\u5165\u5ea6\u7684\u70b9\u4ea7\u751f\u4efb\u4f55\u5f71\u54cd\u3002\u4e8e\u662f\u6309\u7167\u62d3\u6251\u5e8f\u7684\u5012\u5e8f\u5220\u70b9\uff0c\u53ef\u4ee5\u5220\u9664\u6240\u6709\u5165\u5ea6\u4e0d\u4e3a $0$ \u7684\u70b9\u3002\u53ea\u9700\u8981\u628a\u8fd9\u4e9b\u70b9\u7684\u6743\u503c\u53d6\u524d $k$ \u5927\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n + m)$ \u6216 $O(n \\log n + m)$\uff0c\u671f\u671b\u5f97\u5206 $30$ \u5206\uff0c\u7ed3\u5408\u7b97\u6cd5 1 \u53ef\u4ee5\u5f97\u5230 $60$ \u5206\u3002\n\n#### Algorithm 3\n\n\u5b50\u4efb\u52a1 2 \u660e\u793a\u628a\u4e00\u4e2a\u666e\u901a\u56fe\u7f29\u6210\u4e00\u4e2a DAG\u3002\u5bf9\u4e8e\u7f29\u5b8c\u540e\u7684\u56fe\uff0c\u540c\u6837\u6309\u7167\u62d3\u6251\u5e8f\u7684\u5012\u53d9\u8003\u8651\u6bcf\u4e2a SCC \u7684\u5220\u70b9\u65b9\u6848\uff0c\u5219\u540e\u9762\u7684 SCC \u4e0d\u5f71\u54cd\u524d\u9762\u7684 SCC\u3002\u4e8e\u662f\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651\u4e00\u4e2a SCC \u5185\u90e8\u7684\u60c5\u51b5\u3002\n\n\u8003\u8651\u5bf9\u4e8e\u4e00\u4e2a SCC \u5185\u7684\u4efb\u4f55\u4e00\u4e2a\u70b9 $u$\uff0c$u$ \u5230\u8be5 SCC \u5185\u5176\u4ed6\u8282\u70b9\u7684\u6700\u77ed\u8def\u6811\u6784\u6210\u4e00\u68f5\u5916\u5411\u6811\uff08\u6216\u8005\u8bf4\uff0c\u4ece $u$ \u5f00\u59cb bfs\uff0c\u53ea\u8bbf\u95ee\u8be5 SCC \u5185\u7684\u8282\u70b9\u4e14\u4e0d\u91cd\u590d\u8bbf\u95ee\u8282\u70b9\uff0c\u6700\u540e\u4f1a\u5f97\u5230\u4e00\u68f5 bfs \u6811\uff0c\u8fd9\u68f5\u6811\u4e0a\u6240\u6709\u7684\u8fb9\u90fd\u7531\u7236\u4eb2\u6307\u5411\u5b69\u5b50\u4e14\u5728\u539f\u56fe\u4e0a\u5b58\u5728\uff09\u3002\u8fd9\u68f5\u6811\u5177\u6709\u826f\u597d\u7684\u62d3\u6251\u7ed3\u6784\uff1a\u53ea\u6709\u7236\u4eb2\u6307\u5411\u5b69\u5b50\u7684\u8fb9\uff0c\u663e\u7136\u662f\u4e2a DAG\u3002\u4e14\u8fd9\u68f5\u6811\u4e0a\u53ea\u6709 $u$ \u4e00\u4e2a\uff08\u5728\u6811\u4e0a\uff09\u5165\u5ea6\u4e3a $0$ \u7684\u8282\u70b9\u3002\u6240\u4ee5\u6309\u7167\u7b97\u6cd5 2 \u7684\u8003\u8651\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u9664\u4e86 $u$ \u4ee5\u5916\u7684\u8282\u70b9\u90fd\u6309\u7167\u67d0\u4e2a\u987a\u5e8f\u5220\u6389\u3002\u6ce8\u610f\u8fd9\u4e2a\u6027\u8d28\u5bf9\u4efb\u4f55\u7684 $u$ \u90fd\u6210\u7acb\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u603b\u53ef\u4ee5\u5220\u9664\u67d0\u4e2a SCC \u5185\u9664\u4e86\u67d0\u4e2a\u70b9\u4ee5\u5916\u7684\u6240\u6709\u70b9\u3002\n\n- \u8003\u8651\u4e00\u4e2a SCC\uff0c\u5982\u679c\u5b83\u5728\u7f29\u70b9\u540e\u7684\u56fe\u4e0a\u5b58\u5728\u5165\u5ea6\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6709\u53e6\u4e00\u4e2a SCC \u5185\u7684\u67d0\u70b9 $s$ \u6307\u5411\u8be5 SCC \u5185\u7684\u70b9 $t$\uff0c\u5219\u6211\u4eec\u4ee4 $t$ \u4e3a\u4e0a\u4e00\u6bb5\u4e2d\u5916\u5411\u6811\u7684\u6839\uff0c\u5219\u5220\u9664\u5b8c\u8be5 SCC \u5185\u9664 $t$ \u5916\u7684\u6240\u6709\u8282\u70b9\u540e\uff0c$t$ \u4ecd\u6709\u5165\u5ea6\uff0c\u53ef\u4ee5\u5220\u9664\u3002\u6b64\u65f6\u8be5 SCC \u53ef\u4ee5\u88ab\u5168\u90e8\u5220\u9664\u3002\n- \u5982\u679c\u4e00\u4e2a SCC \u5728\u7f29\u70b9\u540e\u7684\u56fe\u4e0a\u6ca1\u6709\u5165\u5ea6\uff0c\u4e5f\u5c31\u662f\u4e0d\u5b58\u5728\u53e6\u4e00\u4e2a SCC \u5185\u7684\u67d0\u70b9\u6307\u5411\u8be5 SCC \u5185\u7684\u70b9\uff0c\u4f46\u8be5 SCC \u5185\u5b58\u5728\u4e00\u4e2a\u81ea\u73af\uff0c\u5219\u6211\u4eec\u8ba9\u6709\u81ea\u73af\u7684\u70b9\u505a\u5916\u5411\u6811\u7684\u6839\uff0c\u5220\u9664\u8be5 SCC \u5185\u5176\u4f59\u70b9\u540e\uff0c\u8be5\u70b9\u4ecd\u6709\u5165\u5ea6\uff0c\u53ef\u4ee5\u5220\u9664\u3002\u6b64\u65f6\u8be5 SCC \u53ef\u4ee5\u88ab\u5168\u90e8\u5220\u9664\u3002\n- \u5982\u679c\u4e00\u4e2a SCC \u5728\u7f29\u70b9\u540e\u7684\u56fe\u4e0a\u6ca1\u6709\u5165\u5ea6\uff0c\u4e5f\u6ca1\u6709\u81ea\u73af\uff0c\u5219\u6211\u4eec\u53d6\u6743\u503c\u6700\u5c0f\u7684\u70b9\u505a\u5916\u5411\u6811\u7684\u6839\u3002\u6b64\u65f6\u53ea\u6709\u6743\u503c\u6700\u5c0f\u7684\u70b9\u4e0d\u80fd\u88ab\u5220\u9664\u3002\n\n\u4e8e\u662f\u6211\u4eec\u628a\u9664\u4e86\u4e0a\u8ff0\u7b2c\u4e09\u79cd\u60c5\u51b5\u4e2d SCC \u5185\u70b9\u6743\u6700\u5c0f\u7684\u70b9\u4ee5\u5916\u7684\u6240\u6709\u70b9\u7684\u70b9\u6743\u6392\u5e8f\uff0c\u53d6\u524d $k$ \u5927\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(m + n \\log n)$\uff0c\u671f\u671b\u5f97\u5206 $100$ \u5206\u3002\n\n#### Algorithm 4\n\n\u53d6\u524d $k$ \u5927\u65e0\u9700\u6392\u5e8f\uff0c\u53ea\u9700\u8981\u8c03\u7528 `std::nth_element`\u3002\u5b83\u53ef\u4ee5\u628a\u7b2c $k$ \u5c0f\u7684\u6570\u653e\u5728\u5bb9\u5668\u7b2c $k$ \u4e2a\u4f4d\u7f6e\u4e0a\uff0c\u4e14\u5c0f\u4e8e\u7b2c $k$ \u5c0f\u7684\u6570\u5728\u7b2c $k$ \u4e2a\u4f4d\u7f6e\u5de6\u8fb9\uff0c\u5927\u4e8e\u7b2c $k$ \u5c0f\u7684\u6570\u5728\u7b2c $k$ \u4e2a\u6570\u53f3\u8fb9\uff08\u53ea\u80fd\u4fdd\u8bc1\u5de6\u53f3\uff0c\u4e0d\u80fd\u4fdd\u8bc1\u6bd4\u7b2c $k$ \u5c0f\u7684\u6570\u5927/\u5c0f\u7684\u6570\u7684\u76f8\u5bf9\u5927\u5c0f\u987a\u5e8f\uff09\u3002\u8fd9\u4e00\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u4e3a $O(n)$\u3002\u800c\u7f29\u70b9\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n + m)$\uff0c\u6240\u4ee5\u603b\u590d\u6742\u5ea6\u4e3a $O(n + m)$\uff0c\u671f\u671b\u5f97\u5206 100 \u5206\u3002\u5b9e\u9645\u6548\u7387\u8dd1\u7684\u597d\u50cf\u8fd8\u662f\u4e0d\u5982 std::sort \u5feb\u3002\n\n### Code\n\n```cpp\n#include <climits>\n#include <array>\n#include <bitset>\n#include <vector>\n#include <iostream>\n#include <algorithm>\n#include <functional>\n\nconst int maxn = 500005;\nconst int maxm = 2000006;\n\nint n, m, k, vistime, top, scnt, ans;\nstd::array<int, maxn> w, ind, minw, dfn, low, stk, bel;\nstd::vector<int> ww;\nstd::bitset<maxn> slfLoop, instk;\nstd::array<std::vector<int>, maxn> e;\n\nvoid dfs(const int u);\n\nint main() {\n  std::ios::sync_with_stdio(false);\n  std::cin.tie(0);\n  std::cin >> n >> m >> k;\n  for (int i = 1; i <= n; ++i) std::cin >> w[i];\n  for (int u, v; m; --m) {\n    std::cin >> u >> v;\n    e[u].push_back(v);\n  }\n  for (int i = 1; i <= n; ++i) if (dfn[i] == 0) dfs(i);\n  for (int u = 1; u <= n; ++u) {\n    for (auto v : e[u]) if (bel[u] != bel[v]) {\n      ++ind[bel[v]];\n    } else if (u == v) {\n      slfLoop.set(bel[u]);\n    }\n  }\n  for (int u = 1; u <= n; ++u) if (ind[bel[u]] || (minw[bel[u]] != u) || slfLoop[bel[u]]) {\n    ww.push_back(w[u]);\n  }\n  while (ww.size() < k) ww.push_back(0);\n  std::nth_element(ww.begin(), ww.begin() + k, ww.end(), std::greater<int>());\n  for (auto u = ww.begin(), v = ww.begin() + k; u != v; ++u) {\n    ans += *u;\n  }\n  std::cout << ans << std::endl;\n  return 0;\n}\n\nvoid dfs(const int u) {\n  dfn[u] = low[u] = ++vistime;\n  instk[stk[++top] = u] = true;\n  for (auto v : e[u]) if (dfn[v] == 0) {\n    dfs(v);\n    low[u] = std::min(low[u], low[v]);\n  } else if (instk[v]) {\n    low[u] = std::min(low[u], dfn[v]);\n  }\n  if (low[u] == dfn[u]) {\n    instk[minw[bel[u] = ++scnt] = u] = false;\n    for (int v = stk[top--]; v != u; v = stk[top--]) {\n      bel[v] = scnt;\n      if (w[v] < w[minw[scnt]]) minw[scnt] = v;\n      instk[v] = false;\n    }\n  }\n}\n```\n\n",
        "postTime": 1541412835,
        "uid": 65363,
        "name": "\u4e00\u6276\u82cf\u4e00",
        "ccfLevel": 7,
        "title": "IBvl\u6218\u961f\u7684\u819c\u4f60\u8d5b-\u9898\u89e3-C"
    },
    {
        "content": "\u600e\u4e48\u611f\u89c9\u6211\u6700\u8fd1\u5199\u7684\u7d2b\u9898\u8d8a\u6765\u8d8a\u6c34\u4e86\uff1f\uff1f\uff1f\n\n\u8fd9\u9898\u548c[P3472](https://www.luogu.com.cn/problem/P3472)\u5f88\u50cf\uff0c\u5199\u5b8c\u8fd9\u9898\u53ef\u4ee5\u5c1d\u8bd5\u4e00\u4e0b\u3002\n\n## \u5206\u6790\n\n\u8003\u8651 DAG \u7684\u60c5\u51b5\uff0c\u663e\u7136\u53ef\u4ee5\u6309\u7167\u62d3\u6251\u5e8f\u7684\u9006\u5e8f\u5220\u70b9\uff0c\u90a3\u4e48\u9664\u4e86\u5165\u5ea6\u4e3a 0 \u7684\u70b9\u4ee5\u5916\uff0c\u5176\u5b83\u70b9\u90fd\u53ef\u4ee5\u5220\u6389\u3002\u6211\u4eec\u9009\u62e9\u5176\u4e2d\u70b9\u6743\u6700\u5927\u7684 $k$ \u4e2a\u5373\u53ef\u3002\n\n\u5bf9\u4e8e\u4e00\u822c\u60c5\u51b5\uff0c\u6211\u4eec\u5c1d\u8bd5\u5c06\u5176\u8f6c\u5316\u4e3a DAG\u3002\n\n\u5bf9\u4e8e\u6709\u5411\u56fe\u4e2d\u7684\u4e00\u4e2a SCC\uff0c\u6211\u4eec\u5bf9\u5176\u8fdb\u884c\u7f29\u70b9\u3002\u7f29\u70b9\u5b8c\u6210\u540e\uff0c\u82e5\u8fd9\u4e2a SCC \u7684\u5165\u5ea6\u4e3a 0\uff0c\u663e\u7136\u6211\u4eec\u4e00\u5b9a\u6709\u4e00\u4e2a\u70b9\u5220\u4e0d\u6389\uff0c\u6240\u4ee5\u6211\u4eec\u8d2a\u5fc3\u5730\uff0c\u4e0d\u5220\u70b9\u6743\u6700\u5c0f\u7684\u90a3\u4e2a\u70b9\u3002\u82e5\u8be5 SCC \u5165\u5ea6\u4e0d\u4e3a 0\uff0c\u90a3\u4e48\u5176\u4e2d\u7684\u70b9\u5c31\u90fd\u662f\u53ef\u4ee5\u5220\u7684\u3002\u7279\u522b\u5730\uff0c\u5982\u679c\u4e00\u4e2a SCC \u4e2d\u6709\u81ea\u73af\uff0c\u90a3\u4e48\u6211\u4eec\u4e5f\u53ef\u4ee5\u5220\u6389\u5176\u4e2d\u6240\u6709\u7684\u70b9\u3002\n\n\u8003\u8651\u8bc1\u660e\u3002\u56e0\u4e3a\u662f\u4e2a SCC\uff0c\u4efb\u610f\u70b9\u5747\u53ef\u8fbe\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u94a6\u5b9a\u4efb\u610f\u4e00\u4e2a\u8282\u70b9\u4f5c\u4e3a\u6839\u8282\u70b9\uff0c\u7136\u540e\u83b7\u5f97\u4e00\u4e2a\u751f\u6210\u6811\u3002\u6211\u4eec\u4ece\u751f\u6210\u6811\u7684\u53f6\u5b50\u5411\u6839\u4f9d\u6b21\u5220\u70b9\uff0c\u663e\u7136\u6700\u540e\u53ea\u4f1a\u5269\u4e0b\u6839\u3002\u5982\u679c\u6709 SCC \u5916\u7684\u70b9\u8fde\u8fb9\u5411\u6839\u8282\u70b9\u6216\u8005\u6839\u8282\u70b9\u6709\u81ea\u73af\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u6839\u4e5f\u5220\u6389\u3002\n\n\u6240\u4ee5\u8fd9\u9898\u5c31\u505a\u5b8c\u4e86\u3002\n\nCode:\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nint n, m, k;\nstruct Node {\n    int w, ava;\n\tbool operator<(const Node &o) const {\n\t\treturn w > o.w;\n\t}\n} a[500005];\nstruct Edge {\n\tint to, next;\n} e[2000005];\nint head[500005], len;\nvoid Insert(int u, int v) {\n\te[++len].to = v;\n\te[len].next = head[u];\n\thead[u] = len;\n}\nint dfn[500005], low[500005], ts, st[500005], top;\nbool ind[500005];\nbool vis[500005];\nint bel[500005];\nint scc[500005];\nint cnt;\nvoid Tarjan(int u) {\n\tdfn[u] = low[u] = ++ts;\n\tst[++top] = u;\n\tvis[u] = true;\n\tfor (int i = head[u]; i; i = e[i].next) {\n\t\tint v = e[i].to;\n\t\tif (!dfn[v]) {\n\t\t\tTarjan(v);\n\t\t\tlow[u] = min(low[u], low[v]);\n\t\t}\n\t\telse if (vis[v]) {\n\t\t\tlow[u] = min(low[u], dfn[v]);\n\t\t}\n\t}\n\tif (low[u] == dfn[u]) {\n\t\tint mn = 0x3f3f3f3f, pos = -1;\n\t\tcnt++;\n\t\tint siz = 0;\n\t\twhile (st[top + 1] != u) {\n\t\t\tint v = st[top--];\n\t\t\tsiz++;\n\t\t\tbel[v] = cnt;\n\t\t\tvis[v] = false;\n\t\t\tif (a[v].w < mn) {\n\t\t\t\tmn = a[v].w;\n\t\t\t\tpos = v;\n\t\t\t}\n\t\t}\n\t\tif (siz > 1) {\n\t\t\tscc[cnt] = pos;\n\t\t}\n\t}\n}\nint ans;\nint main() {\n\tscanf(\"%d%d%d\", &n, &m, &k);\n\tfor (int i = 1; i <= n; i++) {\n\t\tscanf(\"%d\", &a[i].w);\n\t\ta[i].ava = false;\n\t}\n\tfor (int i = 1; i <= m; i++) {\n\t\tint u, v;\n\t\tscanf(\"%d%d\", &u, &v);\n\t\tInsert(u, v);\n\t\ta[v].ava = true;\n\t}\n\tfor (int i = 1; i <= n; i++) if (!dfn[i]) Tarjan(i);\n\tfor (int i = 1; i <= n; i++) {\n\t\tfor (int j = head[i]; j; j = e[j].next) {\n\t\t\tint u = bel[i], v = bel[e[j].to];\n\t\t\tif (u != v) {\n\t\t\t\tind[v] = true;\n\t\t\t}\n\t\t\tif (i == e[j].to) {\n\t\t\t\tind[v] = true;\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i = 1; i <= cnt; i++) {\n\t\tif (!ind[i]) a[scc[i]].ava = false;\n\t}\n\tsort(a + 1, a + n + 1);\n\tfor (int i = 1; i <= n; i++) {\n\t\tif (a[i].ava) {\n\t\t\tans += a[i].w;\n\t\t\tk--;\n\t\t\tif (!k) break;\n\t\t}\n\t}\n\tprintf(\"%d\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1671000331,
        "uid": 363415,
        "name": "251Sec",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5008 [yLOI2018] \u9526\u9ca4\u6284"
    },
    {
        "content": "\u5148\u8003\u8651\u4e00\u4e2a DAG \u7684\u60c5\u51b5\u3002\u6211\u4eec\u53ea\u8981\u5148\u627e\u5230\u9700\u8981\u5220\u9664\u7684\u70b9\uff08\u80fd\u591f\u88ab\u5220\u9664\u4e14\u662f\u524d $k$ \u5927\uff09\uff0c\u7136\u540e\u6309\u7167\u8fd9\u4e9b\u70b9\u7684\u62d3\u6251\u5e8f\u7684\u5012\u5e8f\u5220\u70b9\uff0c\u90a3\u4e48\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e9b\u70b9\u90fd\u53ef\u4ee5\u88ab\u5220\u53bb\uff0c\u5e76\u4e0d\u4f1a\u5f71\u54cd\u540e\u9762\u7684\u70b9\u7684\u5165\u5ea6\u3002\n\n\u56e0\u6b64\u5bf9\u539f\u56fe\u8fdb\u884c SCC \u7f29\u70b9\uff0c\u8fd9\u6837\u6574\u4f53\u4e0a\u7684\u903b\u8f91\u662f\u4e0d\u53d8\u7684\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5355\u72ec\u8003\u8651\u4e00\u4e0b SCC \u5185\u90e8\u600e\u4e48\u5220\u3002\u770b\u4e00\u4e2a\u7b80\u5355\u7684\uff1a\n\n![](https://pic.imgdb.cn/item/639150e2b1fccdcd36618c48.png)\n\n\u73b0\u5728 $2,3,4$ \u5728\u4e00\u4e2a SCC \u5185\uff0c\u7531\u4e8e\u8fd9\u4e2a SCC \u662f\u6709\u4e00\u4e2a\u5165\u5ea6\u7684 $1\\rightarrow 2$\uff0c\u56e0\u6b64\u53ea\u8981\u4e0d\u5148\u5220 $2$\uff0c\u90a3\u4e48\u8fd9\u4e2a SCC \u5c31\u53ef\u4ee5\u5220\u5e72\u51c0\u3002\u4f46\u662f\u5982\u679c\u6ca1\u6709 $1\\rightarrow 2$ \u8fd9\u6761\u8fb9\u5462\uff1f\u90a3\u4e48 SCC \u5220\u5b8c\u5fc5\u987b\u7559\u4e00\u4e2a\u70b9\uff08\u53ea\u9700\u8981\u4ece\u4efb\u610f\u4e00\u4e2a\u4f4d\u7f6e\u5f00\u59cb\u987a\u7740\u73af\u5220\uff0c\u6700\u540e\u5c31\u4f1a\u5269\u4e00\u4e2a\u70b9\uff09\uff0c\u4f46\u662f\uff01\u5982\u679c\u8fd9\u4e2a SCC \u5185\u5b58\u5728\u81ea\u73af\uff0c\u90a3\u4e48\u5b83\u8fd8\u662f\u53ef\u4ee5\u88ab\u5220\u5e72\u51c0\u7684\u3002\n\n\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u6392\u9664\u6389\u672c\u6765\u5c31\u5165\u5ea6\u4e3a $0$ \u7684\u70b9\u548c\u4e00\u4e2a\u6ca1\u6709\u5165\u5ea6\u6ca1\u6709\u81ea\u73af\u7684 SCC \u5185\u7684\u70b9\u6743\u6700\u5c0f\u7684\u70b9\uff0c\u5269\u4e0b\u7684\u70b9\u53d6\u524d $k$ \u5927\u5373\u53ef\u3002\n\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <vector>\n#include <algorithm>\n\nusing namespace std;\n\nint n, m, k;\nint w[500010];\nint dfn[500010], low[500010], num = 0;\nint st[500010], tot = 0; \nint cnt = 0, c[500010];\nbool ins[500010];\nvector<int> G[500010];\nvector<int> scc[500010];\nbool self[500010];\nbool selfscc[500010];\n\nvoid tarjan(int x) {\n    dfn[x] = low[x] = ++num;\n    ins[st[++tot] = x] = true;\n    for (int y : G[x])\n        if (!dfn[y]) {\n            tarjan(y);\n            low[x] = min(low[x], low[y]);\n        } else if (ins[y]) low[x] = min(low[x], dfn[y]);\n    if (low[x] == dfn[x]) {\n        int y; ++cnt;\n        do {\n            y = st[tot--]; ins[y] = false;\n            c[y] = cnt; scc[cnt].push_back(y);\n            selfscc[cnt] |= self[y];\n        } while (x != y);\n    }\n}\n\nint in[500010];\nint val[500010], tot2 = 0;\n\nint main(void) {\n    scanf(\"%d%d%d\", &n, &m, &k);\n    for (int i = 1; i <= n; ++i) scanf(\"%d\", w + i);\n    while (m--) {\n        int u, v; scanf(\"%d%d\", &u, &v);\n        if (u != v) G[u].push_back(v);\n        else self[u] = true;\n    }\n    for (int i = 1; i <= n; ++i) if (!dfn[i]) tarjan(i);\n    for (int i = 1; i <= n; ++i)\n        for (int j : G[i]) if (c[i] != c[j]) ++in[c[j]];\n    for (int i = 1; i <= cnt; ++i) {\n        int minn = 1e9, flag = false;\n        for (int j : scc[i]) minn = min(minn, w[j]);\n        for (int j : scc[i])\n            if (in[i] || selfscc[i]) val[++tot2] = w[j];\n            else if (w[j] > minn || flag) val[++tot2] = w[j];\n            else flag = true;\n    }\n    sort(val + 1, val + tot2 + 1, greater<int>());\n    int ans = 0;\n    for (int i = 1; i <= k; ++i) ans += val[i];\n    printf(\"%d\\n\", ans);\n    return 0;\n}\n```",
        "postTime": 1670470333,
        "uid": 187051,
        "name": "james1BadCreeper",
        "ccfLevel": 6,
        "title": "P5008"
    },
    {
        "content": "\u6709\u8da3\u7684\u9898\u76ee\uff0c\u672c\u8eab\u5e76\u4e0d\u56f0\u96be\u3002\n\n\u9996\u5148\u8003\u8651 DAG \u600e\u4e48\u505a\uff0c\u663e\u800c\u6613\u89c1\u7684\u662f DAG \u7ed9\u51fa\u4e86\u4e00\u4e2a\u5b8c\u7f8e\u7684\u987a\u5e8f\u4f7f\u5f97\u6309\u8fd9\u4e2a\u987a\u5e8f\u603b\u80fd\u6d88\u6389\u9009\u51fa\u6765\u7684\u70b9\u96c6\uff0c\u9664\u975e\u8fd9\u4e2a\u70b9\u96c6\u91cc\u5305\u542b\u4e86\u672c\u8eab\u5c31\u6ca1\u6709\u5165\u5ea6\u7684\u70b9\u3002\n\n\u6cbf\u7528\u8fd9\u4e2a\u601d\u8def\uff0c\u5bf9\u4e8e\u4e00\u822c\u56fe\u4e0d\u96be\u60f3\u5230\u7f29\u70b9\u3002\u7f29\u70b9\u4e4b\u540e\uff0c\u70b9\u4e0e\u70b9\u4e4b\u95f4\u4ecd\u7136\u6309\u7167 DAG \u7684\u987a\u5e8f\u505a\uff0c\u73b0\u5728\u53ea\u9700\u8981\u8003\u8651\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u5185\u90e8\u600e\u4e48\u505a\u3002\u9996\u5148\u6211\u4eec\u6700\u591a\u53ea\u9700\u8981\u727a\u7272\u4e00\u4e2a\u70b9\u5c31\u53ef\u4ee5\u6d88\u53bb\u5176\u4f59\u7684\u6240\u6709\u70b9\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u5927\u6982\u7c7b\u4f3c\u4e8e\u6b27\u62c9\u56de\u8def\u91cc\u90a3\u4e2a\u5927\u73af\u5957\u5c0f\u73af+\u56de\u6eaf\u7684\u7ed3\u6784\uff0c\u624b\u73a9\u4e00\u4e0b\u5c31\u5f88\u660e\u4e86\u3002\u770b\u4e86\u9898\u89e3\u53d1\u73b0\u8fd8\u6709\u66f4\u9ad8\u7684\u89d2\u5ea6\u662f bfs \u751f\u6210\u6811\uff0c\u56e0\u4e3a bfs \u751f\u6210\u6811\u53ea\u6709\u6a2a\u53c9\u8fb9\u6ca1\u6709\u8fd4\u7956\u8fb9\uff0c\u6240\u4ee5\u9009\u5b9a\u4e00\u4e2a\u70b9\u5f53 bfs \u751f\u6210\u6811\u7684\u6839\uff0c\u4ece\u53f6\u5b50\u8d77\u81ea\u5e95\u5411\u4e0a\u6d88\uff0c\u6bcf\u4e2a\u70b9\u5728\u88ab\u6d88\u4e4b\u524d\u5b83\u7684\u7236\u4eb2\u5230\u5b83\u7684\u8fb9\u4e00\u5b9a\u662f\u5b58\u5728\u7684\u3002\n\n\u7531\u4e8e\u662f\u5f3a\u8fde\u901a\u5206\u91cf\uff0c\u6240\u4ee5\u6bcf\u4e2a\u70b9\u90fd\u53ef\u4ee5\u5f53\u6839\uff0c\u90a3\u5982\u679c\u5b58\u5728\u4e00\u4e2a\u70b9\u6ee1\u8db3\u5176\u5b83\u5f3a\u8fde\u901a\u5206\u91cf\u91cc\u7684\u70b9\u5230\u5b83\u6709\u4e00\u6761\u8fb9\uff0c\u6216\u8005\u5b83\u81ea\u5df1\u5230\u81ea\u5df1\u6709\u4e00\u6761\u8fb9\uff0c\u6211\u4eec\u628a\u5b83\u5f53\u505a\u6839\u5c31\u53ef\u4ee5\u6d88\u6389\u5b83\u6240\u5728\u8fde\u901a\u5206\u91cf\u91cc\u7684\u6240\u6709\u70b9\u3002\u5982\u679c\u4e0d\u5b58\u5728\u8fd9\u6837\u7684\u70b9\uff0c\u9996\u5148\u6211\u4eec\u4e00\u5b9a\u4f1a\u727a\u7272\u4e00\u4e2a\u70b9\uff0c\u56e0\u4e3a\u6d88\u5230\u53ea\u5269\u4e00\u4e2a\u70b9\u7684\u65f6\u5019\u8fd9\u4e2a\u70b9\u663e\u7136\u4e0d\u80fd\u518d\u52a8\u4e86\uff0c\u800c\u7531\u521a\u624d\u7684\u8bba\u8ff0\u53ef\u5f97\u6211\u4eec\u4e5f\u53ea\u9700\u8981\u727a\u7272\u4e00\u4e2a\u70b9\uff0c\u6240\u4ee5\u5c31\u8d2a\u5fc3\uff0c\u628a\u70b9\u6743\u6700\u5c0f\u7684\u90a3\u4e2a\u70b9\u4f5c\u4e3a\u6839\u727a\u7272\u6389\u3002\u5728\u6ca1\u6709\u88ab\u727a\u7272\u7684\u6240\u6709\u70b9\u4e2d\u6c42\u524d $k$ \u5927\u4e4b\u548c\uff0c\u505a\u5b8c\u4e86\u3002\n\n```cpp\n//author:\u671b\u8fdc\u661f\n#include<bits/stdc++.h>\n#define pii pair<int,int>\n#define fi first\n#define se second\n#define pb push_back\n#define eb emplace_back\n#define mk make_pair\n#define sml(x,y) (x=min(x,y))\n#define big(x,y) (x=max(x,y))\n#define ll long long\n#define uint unsigned int\n#define ull unsigned long long\n#define umap unordered_map\n#define db double\n#define fo(i,x,y) for(int i=x;i<=y;++i)\n#define go(i,x,y) for(int i=x;i>=y;--i)\n#define ptc putchar\n#define emp emplace\nusing namespace std;\nll seed=chrono::system_clock::now().time_since_epoch().count();\nmt19937 rnd(seed);\ninline int rm(int x,int y){return (int)(rnd()%(y-x+1ll)+x);}\ninline int read(){int ch=getchar(),x=0,f=1;while(!isdigit(ch)){if(ch==(int)('-'))f=-1;ch=getchar();}while(isdigit(ch)){x=(x<<1)+(x<<3)+(ch^48);ch=getchar();}return x*f;}\ninline void out(int *a,int l,int r){fo(i,l,r) cout<<*(a+i)<<' ';puts(\"\");}\n\nconst int N=5e5+10,M=3e6;\nstruct Edge{\n\tint to,next,val;\n}e[M];\nint head[N],tot,n,m,a[N],dfn[N],ti,low[N],stk[N],top,ins[N],deg[N],bel[N];\nint b[N],n_;\nvector<int> g[N];\n\nvoid connect(int x,int y,int v){\n\te[++tot]=(Edge){y,head[x],v};\n\thead[x]=tot;\n}\n\nvoid dfs(int x){\n\tstk[++top]=x;ins[x]=1;\n\tdfn[x]=low[x]=++ti;\n\tfor(int i=head[x];i;i=e[i].next){\n\t\tint p=e[i].to;\n\t\tif(!dfn[p]) dfs(p),sml(low[x],low[p]);\n\t\telse if(ins[p]) sml(low[x],dfn[p]);\n\t}\n\tif(dfn[x]==low[x]){\n\t\t//printf(\"%d:\",x);\n\t\tint p;\n\t\tdo{\n\t\t\tp=stk[top--];\n\t\t\tins[p]=0;\n\t\t\tbel[p]=x;\n\t\t\tg[x].pb(p);\n\t\t\t//printf(\"%d \",p);\n\t\t}while(p!=x);//puts(\"\");\n\t}\n}\n\nsigned main(){\n\tcin>>n>>m;int k=read();\n\tfo(i,1,n) a[i]=read();\n\tfo(i,1,m){\n\t\tint x=read(),y=read(),v=0;\n\t\tconnect(x,y,v);\n\t}\n\tfo(i,1,n) if(!dfn[i]) dfs(i);\n\tfo(i,1,n) \n\t\tfor(int j=head[i];j;j=e[j].next){\n\t\t\tint p=e[j].to;\n\t\t\tif(p==i||bel[p]!=bel[i]) deg[bel[p]]++;\n\t\t}\n\t//cout<<\"deg:\";out(deg,1,n);\n\tfo(i,1,n) if(bel[i]==i){\n\t\tif(deg[i]){\n\t\t\tfor(int j:g[i]) b[++n_]=a[j];\n\t\t\tcontinue;\n\t\t}\n\t\tauto cmp=[](int x,int y){return a[x]>a[y];};\n\t\tsort(g[i].begin(),g[i].end(),cmp);\n\t\tfor(int j:g[i]) b[++n_]=a[j];\n\t\t--n_;\n\t}\n\tsort(b+1,b+1+n_);\n\t//cout<<n_<<\":\";out(b,1,n_);\n\tint ans=0;\n\tgo(i,n_,1){\n\t\tans+=b[i];\n\t\tk--;\n\t\tif(!k) break;\n\t}\n\tcout<<ans;\n\treturn 0;\n}\n\n```\n",
        "postTime": 1663807249,
        "uid": 238408,
        "name": "vectorwyx",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P5008 [yLOI2018] \u9526\u9ca4\u6284"
    },
    {
        "content": "\u5c0f\u6e05\u65b0\u9898 suki\n\n- \u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u56fe\u662f\u6709\u5411\u65e0\u73af\u56fe\uff0c\u90a3\u4e48\u9664\u4e86\u90a3\u4e9b\u4e00\u5f00\u59cb\u5c31\u6ca1\u6709\u5165\u5ea6\u7684\u70b9\uff0c\u522b\u7684\u70b9\u90fd\u662f\u53ef\u4ee5\u88ab\u9009\u4e2d\u7684\u3002\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ea\u9700\u8981\u5728\u4e00\u5f00\u59cb\u6709\u5165\u5ea6\u7684\u70b9\u4e2d\u9009\u51fa\u524d $k$ \u5927\u5373\u53ef\u3002\n- \u5bf9\u4e8e\u4e00\u4e2a\u5355\u72ec\u7684\u5927\u5c0f\u4e3a $n$ \u7684\u73af\uff0c\u53ef\u4ee5\u53d1\u73b0\u6211\u4eec\u603b\u53ef\u4ee5\u786e\u5b9a\u4e00\u4e2a\u65b9\u6848\u6765\u9009\u51fa\u73af\u4e0a\u7684\u4efb\u610f $n-1$ \u4e2a\u70b9\u3002\u7c7b\u4f3c\u5730\u53ef\u4ee5\u5f97\u5230\u5bf9\u4e8e\u4e00\u4e2a $\\text{SCC}$ \u4e5f\u6709\u8fd9\u6837\u7684\u7ed3\u8bba\u3002\n- \u73b0\u5728\u6211\u4eec\u56de\u5230\u539f\u56fe\u4e0a\u8003\u8651\u3002\u5c06\u539f\u56fe\u7f29\u70b9\uff0c\u5bf9\u4e8e\u6b64\u65f6\u7684\u4e00\u4e2a $\\text{SCC}$\uff0c\u82e5\u5176\u5728\u7f29\u70b9\u540e\u7684\u56fe\u4e2d\u5165\u5ea6\u4e0d\u4e3a $0$\uff0c\u90a3\u4e48\u6211\u4eec\u603b\u53ef\u4ee5\u5c06\u5b83\u5220\u5b8c\u3002\u5426\u5219\uff0c\u6211\u4eec\u81f3\u5c11\u8981\u4fdd\u7559\u8fd9\u4e2a $\\text{SCC}$ \u4e2d\u7684\u4e00\u4e2a\u70b9\u3002\n- \u6211\u4eec\u8003\u8651\u4ece\u5927\u5230\u5c0f\u4f9d\u6b21\u8d2a\u5fc3\u5730\u9009\uff0c\u540c\u65f6\u8bb0\u5f55\u6bcf\u4e2a $\\text{SCC}$ \u76ee\u524d\u5df2\u7ecf\u9009\u4e86\u591a\u5c11\u4e2a\u70b9\uff0c\u5bf9\u4e8e\u73b0\u5728\u7684\u6570\u80fd\u9009\u5c31\u5c3d\u53ef\u80fd\u5730\u9009\u4e0a\u3002\u4e0d\u96be\u53d1\u73b0\u8fd9\u4e2a\u8d2a\u5fc3\u662f\u5bf9\u7684\u3002\n- \u4f46\u8fd9\u4e2a\u7b97\u6cd5\u6709\u4e00\u4e9b\u7f3a\u9677\uff1a\u5982\u679c\u4e00\u4e2a $\\text{SCC}$ \u4e2d\u67d0\u4e2a\u70b9\u5b58\u5728\u81ea\u73af\uff0c\u90a3\u4e48\u5c31\u7b97\u8fd9\u4e2a $\\text{SCC}$ \u6ca1\u6709\u5165\u5ea6\uff0c\u5b83\u4e5f\u53ef\u4ee5\u88ab\u5220\u5b8c\u3002\u90a3\u4e48\u6211\u4eec\u53ea\u8981\u7279\u5224\u4e00\u4e0b\u662f\u5426\u5b58\u5728\u81ea\u73af\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(n\\log n+m)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n\n#define int long long\n\nusing namespace std;\n\ninline int read(){\n\tint x=0,f=1;char c=getchar();\n\tfor(;(c<'0'||c>'9');c=getchar()){if(c=='-')f=-1;}\n\tfor(;(c>='0'&&c<='9');c=getchar())x=x*10+(c&15);\n\treturn x*f;\n}\n\nconst int N=5e5+15;\nconst int M=2e6+15;\n\nvector<int>G[N];\n\nint dfn[N],low[N],w[N],cnt[N],scc[N],sc,fr[M],to[M];\nint top=0,stk[N],n,m,tot=0;\nbool ins[N];\nbool cyc[N],zyz[N];\n\nvoid tarjan(int u){\n\tstk[++top]=u,ins[u]=1,dfn[u]=++tot,low[u]=dfn[u];\n\tfor(int v:G[u]){\n\t\tif(!dfn[v])tarjan(v),low[u]=min(low[u],low[v]);\n\t\telse if(ins[v])low[u]=min(low[u],dfn[v]);\n\t}\n\tif(low[u]!=dfn[u])return ;\n\tscc[u]=++sc,cnt[sc]++,ins[u]=0,zyz[sc]|=cyc[u];\n\twhile(top>0&&stk[top]!=u){\n\t\tint v=stk[top];top--,ins[v]=0;\n\t\tscc[v]=sc,cnt[sc]++,zyz[sc]|=cyc[v];\n\t}\n\ttop--;\n}\n\npriority_queue<pair<int,int> >q;\n\n#define fi first\n#define se second\n#define mk make_pair\n\nint ind[N];\n\nsigned main(void){\n\n#ifndef ONLINE_JUDGE\n\tfreopen(\"in.in\",\"r\",stdin);\n#endif\n\n\tn=read(),m=read();int k=read();\n\tfor(int i=1;i<=n;i++)w[i]=read();\n\tfor(int i=1;i<=m;i++){\n\t\tint u=read(),v=read();\n\t\tfr[i]=u,to[i]=v;\n\t\tif(u==v){cyc[u]=1;continue;}\n\t\tG[u].push_back(v);\n\t}\n\tfor(int i=1;i<=n;i++)if(!dfn[i])tarjan(i);\n\tfor(int i=1;i<=m;i++){\n\t\tint u=fr[i],v=to[i];\n\t\tif(scc[u]!=scc[v])ind[scc[v]]++;\n\t}\n\t\n//\tfor(int i=1;i<=n;i++)cout<<scc[i]<<' ';puts(\"\");\n//\tfor(int i=1;i<=n;i++)cout<<ind[i]<<\" \"<<cnt[i]<<endl;\n\t\n\tint ans=0;\n\tfor(int i=1;i<=n;i++)q.push(mk(w[i],scc[i]));\n\twhile(k&&q.size()){\n\t\tauto t=q.top();q.pop();\n//\t\tcout<<t.fi<<\" \"<<t.se<<endl;\n\t\tif((!ind[t.se])&&(cnt[t.se]==1)&&(!zyz[t.se]))continue;\n\t\tcnt[t.se]--,ans+=t.fi;k--;\n\t}\n\tcout<<ans<<endl;\n\n\treturn 0;\n}\n\n```",
        "postTime": 1660978968,
        "uid": 307453,
        "name": "\u4e91\u6d45\u77e5\u5904",
        "ccfLevel": 6,
        "title": "Luogu5008 yLOI2018 \u9526\u9ca4\u6284"
    }
]
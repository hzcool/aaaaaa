[
    {
        "content": "\u6b64\u9898\u6570\u636e\u8303\u56f4\u4e0e\u9898\u9762\u4e0d\u7b26\uff0c[\u539f\u9898\u4f20\u9001\u95e8](http://ybt.ssoier.cn:8088/problem_show.php?pid=1791)\u3002\n\n# Description\n\n\u5c06\u4e00\u4e2a\u73af\u5206\u4e3a $t$ \u90e8\u5206\uff0c\u7b2c $i$ \u4e2a\u90e8\u5206\u957f\u5ea6\u4e3a $s_i$\uff0c\u6240\u6709\u90e8\u5206\u7684\u5e73\u5747\u957f\u5ea6\u4e3a $s_{avg}$ \uff0c\u6c42 $\\min\\{t^2\\sum (s_i - s_{avg})^2\\}$.\n\n# Solution\n\n\u8bbe $t$ \u4e2a\u90e8\u5206\u603b\u957f\u5ea6\u4e3a $sum_n$\uff0c\u6709 $s_{avg} = \\frac{sum_n}{t}$\n\n\u90a3\u4e48\u7b54\u6848\u5373\u4e3a\n\n$$\nt^2\\sum (s_i - s_{avg})^2 = t^2\\sum s_i^2 - t \\times sum_n^2.\n$$\n\n## k = 2\n\n\u6b64\u65f6\u5c31\u662f\u5c06\u73af\u5206\u6210\u4e24\u90e8\u5206\uff0c\u4f7f\u5f97\u524d\u4e00\u90e8\u5206\u521a\u597d\u5c0f\u4e8e $s_{avg}$\u5373\u53ef\u3002\n\n## k = 3\n\n\u548c $k = 2$ \u7684\u60c5\u51b5\u4e00\u6837\uff0c\u6362\u6210\u4e09\u90e8\u5206\u5373\u53ef\u3002\u4f46\u662f\u7531\u4e8e\u4e0d\u4e00\u5b9a\u5206\u51fa\u7684\u7ed3\u679c\u662f\u6700\u597d\u7684\uff0c\u6240\u4ee5\u8981\u5904\u7406\u8fb9\u754c\uff0c\u5c1d\u8bd5\u5c06\u5206\u5272\u70b9\u5de6\u53f3\u79fb\u52a8\uff0c\u627e\u6700\u5c0f\u503c\u3002\n\n## k > 3\n\n\u7531\u4e8e $t,sum_n$ \u4e3a\u5e38\u6570\uff0c\u6240\u4ee5\u7b54\u6848\u53ea\u4e0e**\u6bcf\u90e8\u5206\u957f\u5ea6\u7684\u5e73\u65b9\u548c**\u6709\u5173\u3002\n\n\u4e8e\u662f\u95ee\u9898\u8f6c\u5316\u4e3a\uff1a\u5c06\u4e00\u4e2a\u6570\u5217\u5206\u4e3a $t$ \u90e8\u5206\uff0c\u6700\u5c0f\u5316\u6bcf\u90e8\u5206\u7684\u5e73\u65b9\u548c\u3002\n\n\u4ee4 $dp_{i,j}$ \u8868\u793a\u524d $i$ \u4e2a\u6570\uff0c\u5206\u4e3a $j$ \u90e8\u5206\uff0c\u7528 $sum_i$ \u8868\u793a\u524d $i$ \u90e8\u5206\u7684\u524d\u7f00\u548c\uff0c\u5f97\u51fa\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$\ndp_{i,j} = \\min\\limits_{0<k<i}\\{ dp_{k,j-1} +  (sum_i - sum_k)^2\\}\n$$\n\n$dp_{i,j}$ \u53ea\u4e0e $dp_{k,j-1}$ \u6709\u5173\uff0c\u53ef\u4ee5\u7528\u6eda\u52a8\u6570\u7ec4\u4f18\u5316\u7a7a\u95f4\u3002\u5c06\u4e8c\u6b21\u9879\u62c6\u5f00\u540e\uff0c\u53d1\u73b0\u51fa\u73b0 $sum_i \\times sum_j$ \uff0c\u8003\u8651\u7528\u659c\u7387\u4f18\u5316\u3002\n\n\u8bbe $i_1 < i_2 $ \u4e14 $dp_{i_1,j} < dp_{i_2,j}$\uff0c\u6240\u4ee5\uff1a\n\n$$\ndp_{i_1,j-1} + (sum_i-sum_{i_1})^2 < dp_{i_2,j-1} + (sum_i-sum_{i_2})^2\n$$\n\n\u5373\uff1a\n\n$$\n2 \\times sum_i < \\frac{dp_{i_2,j-1}+sum_{j_2}-(dp_{i_1,j-1}+sum_{j_1})}{sum_{j_2}-sum_{j_2}}\n$$\n\n\u4ee4 $Y(x) = dp_{x,j-1}+sum_x,X(x)=sum_x,$\u5219\uff1a\n\n$$\n\\frac{Y(i_2)-Y(i_1)}{X(i_2)-X(i_1)} > 2 \\times sum_i\n$$\n\n\u6700\u540e\u76f4\u63a5\u659c\u7387\u4f18\u5316\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2k)$\u3002\n\n# Code\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\n\nconst int N = 3e5 + 10;\nint n,t,ans = 0x3f3f3f3f3f3f3f3f;;\nint l[N],a[N],s[N];\nint x[N],y[N],Fun[N],head,tail;\nint f[N][2];\n\ndouble slope(int j1,int j2)\n{\n\treturn 1.0 * (y[j2] - y[j1]) / (x[j2] - x[j1]);\n}\n\nvoid solve2()\n{\n\tfor(int i = 1;i <= n;++ i)\n\t\ts[i] = s[i-1] + l[i];\n\tint tmp = s[n] >> 1,pos = 0;\n\tint sum = 0;\n\tfor(int i = 1;i <= n;++ i)\n\t{\n\t\twhile(sum < tmp)\n\t\t{\n\t\t\tpos = pos + 1 > n ? 1 : pos + 1;\n\t\t\tsum += l[pos];\n\t\t}\n\t\tans = min(ans,sum * sum + (s[n] - sum) * (s[n] - sum));\n\t\tsum -= l[i];\n\t}\n\tprintf(\"%lld\\n\",t * t * ans - t * s[n] * s[n]);\n}\n\nvoid solve3()\n{\n\tfor(int i = 1;i <= n;++ i)\n\t\ts[i] = s[i-1] + l[i];\n\tint tmp = s[n] / 3;\n\tint pos1 = 1,pos2 = 1,sum1 = 0,sum2 = 0;\n\tfor(int i = 1;i <= n;++ i)\n\t{\n\t\twhile(sum1 < tmp)\n\t\t{\n\t\t\tif(pos1 < pos2) sum2 -= l[(pos1 - 1) % n + 1];\n\t\t\t//\u7531\u4e8e\u6d89\u53ca\u7b2c\u4e8c\u6bb5\u51cf\u53bb\u7b2c\u4e00\u6bb5\u9009\u62e9\u7684\u957f\u5ea6\uff0c\u7528\u53d6\u6a21\u4ee3\u66ff\u6eda\u52a8 \n\t\t\tsum1 += l[(pos1 - 1) % n + 1];\n\t\t\t++ pos1;\n\t\t}\n\t\tpos2 = max(pos2,pos1);\n//\t\tprintf(\"sum2 after pos1:%lld ,pos2:%lld\\n\",sum2,pos2);\n\t\twhile(sum2 + l[(pos2 - 1) % n + 1] <= s[n] - sum1 - sum2 - l[(pos2 - 1) % n + 1])//\u4f7f\u4e24\u8fb9\u5c3d\u91cf\u5747\u8861 \n\t\t{\n\t\t\tsum2 += l[(pos2 - 1) % n + 1];\n\t\t\t++ pos2;\n\t\t}\n\t\t\n\t\tint sum3 = s[n] - sum1 - sum2,sum4;\n\t\tans = min(ans,sum1 * sum1 + sum2 * sum2 + sum3 * sum3);\n\t\t\n\t\tsum3 = sum2 + l[(pos2 - 1) % n + 1],sum4 = s[n] - sum1 - sum3;\n\t\tans = min(ans,sum1 * sum1 + sum3 * sum3 + sum4 * sum4);\n//\t\tprintf(\"%lld pos:%lld %lld len:%lld %lld %lld or %lld %lld %lld\\n\",i,pos1,pos2,sum1,sum2,s[n] - sum1 - sum2,sum1,sum3,sum4);\n\t\tsum1 -= l[i];\n\t}\n\tprintf(\"%lld\\n\",t * t * ans - t * s[n] * s[n]);\n}\n\nsigned main()\n{\n\tscanf(\"%lld%lld\",&n,&t);\n\tfor(int i = 1;i <= n;++ i)\n\t\tscanf(\"%lld\",&l[i]);\n\t\t\n\tif(t == 2)\n\t{\n\t\tsolve2();\n\t\treturn 0;\n\t}\n\tif(t == 3)\n\t{\n\t\tsolve3();\n\t\treturn 0;\n\t}\n\t\n\tfor(int pos = 1;pos <= n;++ pos)\n\t{\n\t\tint cnt = 0,p = 0;\n\t\tfor(int i = pos;i <= n;++ i)\n\t\t\ta[++cnt] = l[i];\n\t\tfor(int i = 1;i < pos;++ i)\n\t\t\ta[++cnt] = l[i];\n\t\ts[0] = 0;\n\t\tfor(int i = 1;i <= n;++ i)\n\t\t{\n\t\t\ts[i] = s[i-1] + a[i];\n\t\t\tf[i][p^1] = s[i] * s[i];\n\t\t}\n\t\t\n\t\tfor(int j = 2;j <= t;++ j)\n\t\t{\n\t\t\thead = 1,tail = 1;\n\t\t\tfor(int i = 1;i <= n;++ i)\n\t\t\t{\n\t\t\t\twhile(head < tail && slope(Fun[head],Fun[head+1]) <= 2 * s[i])\n\t\t\t\t\t++ head;\n\t\t\t\t\n\t\t\t\tint k = Fun[head];\n\t\t\t\tf[i][p] = f[k][p^1] + (s[i] - s[k]) * (s[i] - s[k]);\n\t\t\t\tx[i] = s[i];\n\t\t\t\ty[i] = f[i][p^1] + s[i] * s[i];\n\t\t\t\t\n\t\t\t\twhile(head < tail && slope(Fun[tail-1],Fun[tail]) >= slope(Fun[tail],i))\n\t\t\t\t\t-- tail;\n\t\t\t\t//\u7ef4\u62a4\u4e00\u4e2a\u4e0b\u51f8\u5305 \n\t\t\t\t\n\t\t\t\tFun[++tail] = i;\n\t\t\t}\n\t\t\tp ^= 1;\n\t\t}\n\t\tans = min(ans,f[n][p^1]);\n\t}\n\tprintf(\"%lld\\n\",t * t * ans - t * s[n] * s[n]);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1635495615,
        "uid": 452541,
        "name": "Dengxy",
        "ccfLevel": 0,
        "title": "[BJWC2017] \u592a\u7a7a\u98de\u8239-\u9898\u89e3"
    }
]
[
    {
        "content": "\u4e3a\u4ec0\u4e48\u8fd9\u9898\u8fd8\u4e0d\u9519\u5374\u6ca1\u4eba\u5199\u9898\u89e3\u554a\u3002\n\n\u8003\u8651\u5e8f\u5217\u4e0d\u964d\u65f6\u6709\u4ec0\u4e48\u6027\u8d28\uff1a$a_i-a_{i-1}\\ge0,i\\in(1,n]$\n\n\u8003\u8651\u64cd\u4f5c\u662f\u533a\u95f4\u540c\u65f6\u52a0\u51cf\uff0c\u60f3\u5230\u5dee\u5206\u3002\n\n\u8bb0 $d_1=a_1,d_i=a_i-a_{i-1},i\\in(1,n]$\uff0c\u90a3\u4e48\u6211\u4eec\u8981\u8ba9 $d_i\\ge0,i\\in[1,n]$\n\n\u6bcf\u6b21\u64cd\u4f5c\u5373 \n\n```cpp\ndi--,dj++\ndi++,dj--\n```\n\n\u90a3\u4e48\u5bf9\u4e8e $d_i>0$ \u7684\uff0c\u53ef\u4ee5\u6700\u591a\u51cf $d_i$ \u6b21\uff0c\u63d0\u4f9b $d_i$ \u6b21\u52a0\u7684\u673a\u4f1a\uff0c\u5bf9\u4e8e $d_i<0$ \u7684\uff0c\u81f3\u5c11\u88ab\u52a0 $|d_i|$ \u6b21\uff0c\u9700\u8981 $d_i$ \u6b21\u88ab\u52a0\u3002\u663e\u7136\u8f6c\u5316\u4e3a\u4e8c\u5206\u56fe\u4e4b\u540e\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\u3002\n\n\u4f46\u662f\u5047\u5982\u53ea\u89c4\u5b9a\u6b63\u6743\u70b9\u5411\u8d1f\u6743\u70b9\u63d0\u4f9b\u6d41\u91cf\u662f\u4e0d\u591f\u7684\uff0c\u56e0\u4e3a\u53ef\u80fd\u957f\u5ea6\u65e0\u6cd5\u5339\u914d\u5bfc\u81f4\u6211\u4eec\u5bf9\u4e8e $i,j,d_i>0,d_j<0$ \u9700\u8981 $k$ \u6765\u5148\u8ba9 $i,k$ \u64cd\u4f5c\uff0c\u518d\u8ba9 $k,j$ \u64cd\u4f5c\u6765\u5b9e\u73b0\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8981\u5bf9\u4e8e\u6bcf\u4e2a\u533a\u95f4\uff0c\u65e0\u8bba\u5de6\u53f3\u662f\u4ec0\u4e48\u70b9\uff0c\u90fd\u8fde\u3002\n\n\u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint rd() {\n    int f=1,sum=0; char ch=getchar();\n    while(!isdigit(ch)) {if(ch=='-') f=-1; ch=getchar();}\n    while(isdigit(ch)) {sum=(sum<<3)+(sum<<1)+ch-'0';ch=getchar();}\n    return sum*f;\n}\n\n#define N (int)(5e4+5)\n#define inf (int)(2e9)\nstruct edge {\n\tint nex,to,w,c;\n}e[N<<1];\nint hea[N],cnt=1;\nint mic[2][N],bian[N];\nint n,m,S,T,tot,a[N],b[N],ans;\n\nvoid add_edge(int x,int y,int z,int c) {\n\te[++cnt].nex=hea[x]; e[cnt].to=y; e[cnt].w=z; e[cnt].c=c; hea[x]=cnt;\n}\n\nvoid add(int x,int y,int z,int c) {\n\tadd_edge(x,y,z,c); add_edge(y,x,0,-c);\n}\n\ndeque<int>q;\nbool vis[N];\nint dis[N];\nbool spfa() {\n\tfor(int i=0;i<N;i++) dis[i]=inf,vis[i]=0;\n\tq.push_back(S); dis[S]=0;\n\twhile(!q.empty()) {\n\t\tint x=q.front(); q.pop_front();\n\t\tvis[x]=0;\n\t\tfor(int i=hea[x];i;i=e[i].nex) {\n\t\t\tint y=e[i].to;\n\t\t\tif(e[i].w&&dis[y]>dis[x]+e[i].c) {\n\t\t\t\tdis[y]=dis[x]+e[i].c;\n\t\t\t\tif(!vis[y]) {\n\t\t\t\t\tvis[y]=1;\n\t\t\t\t\tif(!q.empty()&&dis[y]<dis[q.front()]) q.push_front(y);\n\t\t\t\t\telse q.push_back(y);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn dis[T]<inf;\n}\n\nint dfs(int x,int lim) {\n\tif(x==T||!lim) return lim;\n\tint flow=0,fl;\n\tvis[x]=1;\n\tfor(int i=hea[x];i&&lim;i=e[i].nex) {\n\t\tint y=e[i].to;\n\t\tif(e[i].w&&!vis[y]&&dis[y]==dis[x]+e[i].c) {\n\t\t\tfl=dfs(y,min(lim,e[i].w));\n\t\t\tif(!fl) continue;\n\t\t\tflow+=fl; lim-=fl; e[i].w-=fl; e[i^1].w+=fl;\n\t\t//\tcout<<e[i].c<<\" \"<<fl<<endl;\n\t\t\tans+=e[i].c*fl;\n\t\t}\n\t}\n\tif(!flow) dis[x]=inf;\n\tvis[x]=0;\n\treturn flow;\n}\n\nvoid dinic() {\n\twhile(spfa()) {\n\t\tmemset(vis,0,sizeof(vis));\n\t\tdfs(S,inf);\n\t}\n}\n\nint main() {\n\tn=rd(); m=rd(); S=0; T=n+2;\n\tfor(int i=1;i<=n;i++) b[i]=rd();\n\tfor(int i=1;i<=n;i++) a[i]=b[i]-b[i-1];\n\tfor(int i=0;i<=n+1;i++) mic[0][i]=mic[1][i]=inf;\n\tchar op; int x,y;\n\tfor(int i=1;i<=m;i++) {\n\t\tcin>>op; x=rd(); y=rd();\n\t\tif(op=='+') op=0; else op=1;\n\t\tmic[op][x]=min(mic[op][x],y);\n\t}\n\tadd(S,n+1,inf,0);\n\tfor(int i=1;i<=n;i++) {\n\t\tif(a[i]>0) {\n\t\t\tadd(S,i,a[i],0);\n\t\t} else {\n\t\t\tadd(i,T,-a[i],0); bian[++tot]=cnt-1;\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++) {\n\t\tfor(int l=1,r=l+i;r<=n+1;l++,r=l+i) {\n\t\t\tif(mic[0][i]<inf) add(r,l,inf,mic[0][i]);\n\t\t\tif(mic[1][i]<inf) add(l,r,inf,mic[1][i]);\n\t\t}\n\t}\n\tdinic();\n\tfor(int i=1;i<=tot;i++) {\n\t\tif(e[bian[i]].w) {\n\t\t\tprintf(\"-1\"); return 0;\n\t\t}\n\t}\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1639142345,
        "uid": 125901,
        "name": "FxorG",
        "ccfLevel": 7,
        "title": "P7730 [JDWOI-1] \u8700\u9053\u96be"
    },
    {
        "content": "\u6709 $n$ \u5ea7\u5c71\uff0c\u6bcf\u5ea7\u5c71\u9ad8\u5ea6\u4e3a $h_i$\u3002\n\n\u6709 $m$ \u79cd\u64cd\u4f5c\uff0c\u6bcf\u4e00\u6b21\u64cd\u4f5c\u53ef\u4ee5\u628a\u8fde\u7eed $l_i$ \u5ea7\u5c71\u7684\u9ad8\u5ea6\u62ac\u9ad8\u6216\u538b\u4f4e $1$\uff0c\u8d39\u7528\u4e3a $c_i$\u3002\n\n\u95ee\uff0c\u8ba9 $n$ \u5ea7\u5c71\u7684\u9ad8\u5ea6\u4e0d\u4e0b\u964d\uff0c\u6700\u5c11\u9700\u591a\u5c11\u8d39\u7528\uff1f\n\n\u5982\u679c\u65e0\u89e3\uff0c\u8f93\u51fa `-1`\u3002\n\n$1 \\leq n,m\\leq 200,1 \\leq l_i\\leq n,1 \\leq h_i,c_i \\leq 10^3$\uff0c\u65f6\u9650 $1\\text{s}$\uff0c\u7a7a\u9650 $128\\text{MB}$\u3002\n\n#### std\n\n\u300c\u8700\u9053\u96be\uff0c\u96be\u4e8e\u4e0a\u9752\u5929\u300d\u3002\n\n\u8003\u8651\u5230\uff0c\u5f53 $n$ \u5ea7\u5c71\u7684\u9ad8\u5ea6\u4e0d\u4e0b\u964d\u65f6\uff0c\u6709\uff1a$\\forall i \\in(1,n],a_i \\geq a_{i-1}$\uff0c\u5373 $\\forall i \\in(1,n],a_i-a_{i-1} \\geq 0$\u3002\n\n\u4f46\u662f\u8fd9\u91cc\u4fee\u6539\u4e00\u4e2a\u6570\u7684\u8bdd\uff0c\u5bf9\u5b83\u540e\u9762\u7684\u6570\u90fd\u6709\u5f71\u54cd\uff0c\u4e0d\u592a\u597d\u5f04\u3002\n\n\u8003\u8651\u5dee\u5206\u7ef4\u62a4\uff0c\u8bb0 $d_i=a_i-a_{i-1}$\uff0c\uff08\u8fd9\u65f6\u70b9\u4e4b\u95f4\u5c31\u4e92\u4e0d\u5f71\u54cd\u4e86\uff09\u3002\n\n\u6bcf\u6b21\u5bf9\u533a\u95f4 $[l,r]$ \u7684\u64cd\u4f5c\u5373 $d_l+1,d_{r+1}-1$\uff08\u52a0\uff09 \u6216 $d_l-1,d_{r+1}+1$\uff08\u51cf\uff09\u3002\n\n\u90a3\u4e48\u6211\u4eec\u8981\u8ba9 $\\forall i \\in[1,n],d_i \\geq 0$\u3002\n\n\u8003\u8651\u5230\uff0c\u6211\u4eec\u4e0d\u4f1a\u8ba9\u67d0\u4e00\u5ea7\u5c71\u5148\u62ac\u9ad8\u518d\u538b\u4f4e\u6216\u5148\u538b\u4f4e\u62ac\u9ad8\u518d\u62ac\u9ad8\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e $d_i > 0$\uff0c\u6700\u591a\u88ab\u51cf $d_i$ \u6b21\uff0c\u5373\u6700\u591a\u4e3a\u5176\u4ed6\u70b9\u63d0\u4f9b $d_i$ \u6b21\u52a0\uff1b$d_i <0$\uff0c\u81f3\u5c11\u9700\u8981\u88ab\u52a0 $d_i$ \u6b21\u3002\n\n\u603b\u7ed3\u4e00\u4e0b\uff0c\u6a21\u578b\u5982\u4e0b\uff1a\n\n* \u5982\u679c $d_i >0$\uff0c\u8fde\u4e00\u6761\u4ece $s$ \u5230 $i$\uff0c\u5bb9\u91cf\u4e3a $d_i$\uff0c\u8d39\u7528\u4e3a $0$ \u7684\u8fb9\uff08\u8868\u793a\u8fd9\u4e2a\u70b9\u6709 $d_i$ \u6b21\u7ed9\u5176\u4ed6\u70b9\u52a0\u7684\u673a\u4f1a\uff09\u3002\n* \u5982\u679c $d_i \\leq 0$\uff0c\u8fde\u4e00\u6761\u4ece $i$ \u5230 $t$\uff0c\u5bb9\u91cf\u4e3a $-d_i$\uff0c\u8d39\u7528\u4e3a $0$ \u7684\u8fb9\uff08\u8868\u793a\u8fd9\u4e2a\u70b9\u9700\u8981\u88ab\u52a0 $d_i$ \u6b21\uff09\u3002\n* \u5bf9\u4e8e\u533a\u95f4 $[l,r]$ \u7684\u52a0\u6cd5\u64cd\u4f5c\uff0c\u8fde\u4e00\u6761\u4ece $r+1$ \u5230 $l$\uff0c\u5bb9\u91cf\u4e3a $inf$\uff0c\u8d39\u7528\u4e3a $c_i$ \u7684\u8fb9\uff08\u8868\u793a\u52a0\u673a\u4f1a\u7684\u8f6c\u79fb\uff09\u3002\n* \u5bf9\u4e8e\u533a\u95f4 $[l,r]$ \u7684\u51cf\u6cd5\u64cd\u4f5c\uff0c\u8fde\u4e00\u6761\u4ece $l$ \u5230 $r+1$\uff0c\u5bb9\u91cf\u4e3a $inf$\uff0c\u8d39\u7528\u4e3a $c_i$ \u7684\u8fb9\uff08\u8868\u793a\u52a0\u673a\u4f1a\u7684\u8f6c\u79fb\uff09\u3002\n\n\u6700\u540e\u5c31\u662f\u8dd1\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\u4e86\u3002\n\n\u8bb0\u6700\u5927\u6d41\u4e3a $g$\uff0c\u5219\u65e0\u89e3\u7684\u60c5\u51b5\u5373\u4e3a $g < \\sum\\limits_{i=1}^{n}[d_i<0]-d_i$\u3002\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ninline int read()\n{\n\tint x = 0, f = 1;\n\tchar c = getchar();\n\twhile (c < '0' || c > '9')\n\t{\n\t\tif (c == '-')\n\t\t\tf = -1;\n\t\tc = getchar();\n\t}\n\twhile (c >= '0' && c <= '9')\n\t{\n\t\tx = x * 10 + c - '0';\n\t\tc = getchar();\n\t}\n\treturn x * f;\n}\n\ninline void write(int x)\n{\n\tif (x < 0)\n\t{\n\t\tputchar('-');\n\t\tx = -x;\n\t}\n\tif (x > 9)\n\t\twrite(x / 10);\n\tputchar(x % 10 + '0');\n}\n\ntypedef int tp;\n\nconst int _ = 6e5 + 10, inf = 947483647;\n\nint n, m, a[_], b[_], s, t, lv[_], cur[_];\n\ntp maxflow, mincost;\n\nint tot = 1, head[_], to[_ << 1], nxt[_ << 1];\n\ntp dis[_], w[_ << 1], fl[_ << 1];\n\nint mc[2][_];\n\ninline void add(int u, int v, tp dis, tp c)\n{\n\tto[++tot] = v;\n\tnxt[tot] = head[u];\n\tfl[tot] = dis;\n\tw[tot] = c;\n\thead[u] = tot;\n}\n\ninline void Add(int u, int v, tp dis, tp c)\n{\n\tadd(u, v, dis, c);\n\tadd(v, u, 0, -c);\n}\n\ninline bool bfs()\n{\n\tmemset(lv, 0, sizeof(lv));\n\tfor (int i = 0; i < _; ++i)\n\t\tdis[i] = inf;\n\tlv[s] = 1;\n\tdis[s] = 0;\n\tmemcpy(cur, head, sizeof(head));\n\tqueue<int> q;\n\tq.push(s);\n\twhile (!q.empty())\n\t{\n\t\tint p = q.front();\n\t\tq.pop();\n\t\tlv[p] = 0;\n\t\tfor (int eg = head[p]; eg; eg = nxt[eg])\n\t\t{\n\t\t\tint v = to[eg];\n\t\t\ttp vol = fl[eg];\n\t\t\tif (vol > 0 && dis[v] > dis[p] + w[eg])\n\t\t\t{\n\t\t\t\tdis[v] = dis[p] + w[eg];\n\t\t\t\tif (!lv[v])\n\t\t\t\t{\n\t\t\t\t\tq.push(v);\n\t\t\t\t\tlv[v] = 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn dis[t] != inf;\n}\n\ntp dfs(int p = s, tp flow = inf)\n{\n\tif (p == t)\n\t\treturn flow;\n\tlv[p] = 1;\n\ttp rmn = flow;\n\tfor (int eg = cur[p]; eg && rmn; eg = nxt[eg])\n\t{\n\t\tcur[p] = eg;\n\t\tint v = to[eg];\n\t\ttp vol = fl[eg];\n\t\tif (vol > 0 && !lv[v] && dis[v] == dis[p] + w[eg])\n\t\t{\n\t\t\ttp c = dfs(v, min(vol, rmn));\n\t\t\trmn -= c;\n\t\t\tfl[eg] -= c;\n\t\t\tfl[eg ^ 1] += c;\n\t\t}\n\t}\n\tlv[p] = 0;\n\treturn flow - rmn;\n}\n\ninline void dinic()\n{\n\twhile (bfs())\n\t{\n\t\ttp flow = dfs();\n\t\tmaxflow += flow;\n\t\tmincost += dis[t] * flow;\n\t}\n}\n\nint d1[_], d2[_];\n\nsigned main()\n{\n\tchar op;\n\tint x, y, sum = 0;\n\tn = read(), m = read();\n\ts = 0, t = _ - 1;\n\tfor (int i = 1; i <= n; ++i)\n\t{\n\t\tb[i] = read();\n\t\ta[i] = b[i] - b[i - 1];\n\t}\n\tfor (int i = 0; i <= n + 1; ++i)\n\t\td1[i] = d2[i] = inf;\n\tfor (int i = 1; i <= m; ++i)\n\t{\n\t\tcin >> op;\n\t\tx = read(), y = read();\n\t\tif (op == '+')\n\t\t\td1[x] = min(d1[x], y);\n\t\telse\n\t\t\td2[x] = min(d2[x], y);\n\t}\n\tAdd(s, n + 1, inf, 0);\n\tfor (int i = 1; i <= n; ++i)\n\t\tif (a[i] > 0)\n\t\t\tAdd(s, i, a[i], 0);\n\t\telse\n\t\t{\n\t\t\tAdd(i, t, -a[i], 0);\n\t\t\tsum -= a[i];\n\t\t}\n\tfor (int i = 1; i <= n; ++i)\n\t\tfor (int l = 1, r = l + i; r <= n + 1; ++l, r = l + i)\n\t\t{\n\t\t\tif (d1[i] < inf)\n\t\t\t\tAdd(r, l, inf, d1[i]);\n\t\t\tif (d2[i] < inf)\n\t\t\t\tAdd(l, r, inf, d2[i]);\n\t\t}\n\tdinic();\n\tif(maxflow < sum)\n\t{\n\t\tputs(\"-1\");\n\t\treturn 0;\n\t}\n\twrite(mincost), putchar('\\n');\n\treturn 0;\n}\n```\n\n",
        "postTime": 1645794178,
        "uid": 257146,
        "name": "orz_z",
        "ccfLevel": 0,
        "title": "P7730 [JDWOI-1] \u8700\u9053\u96be"
    }
]
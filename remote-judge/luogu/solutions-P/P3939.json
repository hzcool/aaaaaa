[
    {
        "content": "\u80af\u5b9a\u6709\u4eba\u5b66\u6570\u636e\u7ed3\u6784\u5b66\u50bb\u4e86\u3002\u76f4\u63a5\u7528 vector\u8bb0\u5f55\u6bcf\u4e2a\u989c\u8272\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u4e8c\u5206\u4e00\u4e0b\u5c31\u597d\u3002\n\n\u56e0\u4e3a\u989c\u8272\u7684\u8303\u56f4\u5f88\u5c0f\uff0c\u90fd\u4e0d\u7528\u79bb\u6563\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint read()\n{\n    char s;\n    int k=0,base=1;\n    while((s=getchar())!='-'&&s!=EOF&&!(s>='0'&&s<='9'));\n    if(s==EOF)exit(0);\n    if(s=='-')base=-1,s=getchar();\n    while(s>='0'&&s<='9')\n    {\n        k=k*10+(s-'0');\n        s=getchar();\n    }\n    return k*base;\n}\nvoid write(int x)\n{\n    if(x<0)\n    {\n        putchar('-');\n        write(-x);\n    }\n    else\n    {\n        if(x/10)write(x/10);\n        putchar(x%10+'0');\n    }\n}\nconst int maxn=3e5+100;\nconst int maxm=6e5+100;\nint n,m,bj,X,Y,Z,p1,p2;\nint a[maxn],ans;\nint tong[maxn];\nint t1[maxn],Max;\nint    t[11][maxn*2];\nvector<int> g[maxn];\nbool f1,f2,f3,f4;\nvoid xg(int i,int x,int d)//t[i][x]+=d;\n{\n    int s=x;\n    while (s<=n)\n    {\n        t[i][s]+=d;\n        s+=(s&(-s));\n    }\n    return;\n}\nint qh(int i,int x)\n{\n    int s=x,sum=0;\n    while (s)\n    {\n        sum+=t[i][s];\n        s-=(s&(-s));\n    }\n    return sum;\n}\nint main()\n{\n    n=read();m=read();\n    f4=true;\n    for (int i=1;i<=n;i++) \n    {\n        a[i]=read();\n        Max=max(a[i],Max);\n        if (tong[a[i]]!=0) f4=false;\n        if (f4) tong[a[i]]=i;\n        t1[a[i]]++;//cnt\n    }\n    if (Max<=10) f2=true; else f2=false;\n/*    if (n<=1000)//\u4e00\u5343\u4ee5\u5185\u7684 \n    {\n        while (m--)\n        {\n            bj=read();\n            if (bj==1)\n            {\n                ans=0;\n                X=read();Y=read();Z=read();\n                for (int i=X;i<=Y;i++)\n                    if (a[i]==Z) ans++;\n                printf(\"%d\\n\",ans);\n            } else\n            {\n                X=read();\n                swap(a[X],a[X+1]);\n            }\n        }\n        return 0;\n    }\n    if (f4)//\u6bcf\u4e2a\u989c\u8272\u53ea\u51fa\u73b0\u4e86\u4e00\u6b21 \n    {\n        while (m--)\n        {\n            bj=read();\n            if (bj==1)\n            {\n                X=read();Y=read();Z=read();\n                if (X<=tong[Z]&&tong[Z]<=Y) printf(\"1\\n\"); else printf(\"0\\n\");\n            } else\n            { \n                X=read();\n                //a[X],a[X+1];\n                tong[a[X]]++;\n                tong[a[X+1]]--;\n                swap(a[X],a[X+1]);\n            }\n        }\n        return 0;\n    }\n    if (f2)//\u989c\u8272\u5c0f\u4e8e10\u79cd\uff0c\u987a\u4fbf\u8bf4\u4e00\u4e0b\uff0c\u4e0d\u8981\u7528\u4ec0\u4e48\u6811\u72b6\u6570\u7ec4\uff0c\u524d\u7f00\u548c\u7ef4\u62a4\u4e00\u4e0b\u5c31\u597d \n    {\n        for (int i=1;i<=n;i++) xg(a[i],i,1);\n        while (m--)\n        {\n            bj=read();\n            if (bj==1)\n            {\n                X=read();Y=read();Z=read();\n                ans=qh(Z,Y)-qh(Z,X-1);\n                printf(\"%d\\n\",ans);\n            } else\n            {\n                X=read();\n                xg(a[X],X,-1);\n                xg(a[X],X+1,1);\n                xg(a[X+1],X+1,-1);\n                xg(a[X+1],X,1);\n                swap(a[X+1],a[X]);\n            }\n        }\n        return 0;\n    }*/\n    //\u7136\u540e\u8fd8\u6709\u4e00\u4e2a\u90e8\u5206\u5206\uff1a\u7279\u6b8a\u6027\u8d281\n    //\u8fd9\u4e2a\u5982\u679cr-l<=20\uff0c\u66b4\u529b\u8fd9\u4e00\u90e8\u5206\uff0c\u5426\u5219\u66b4\u529bl~l-1\u548cr+1~n\uff0c\u7136\u540e\u7528\u6574\u4e2a\u7684\u51fa\u73b0\u6b21\u6570\u51cf\u4e00\u4e0b\u5c31\u597d \n    for (int i=1;i<=n;i++) g[a[i]].push_back(i);\n    while (m--)\n    {\n        bj=read();\n        if (bj==1)\n        {\n            X=read();Y=read();Z=read();\n            p1=lower_bound(g[Z].begin(),g[Z].end(),X)-g[Z].begin();//\u627e\u7b2c\u4e00\u4e2a>=X\u7684 \n            p2=upper_bound(g[Z].begin(),g[Z].end(),Y)-g[Z].begin()-1;//\u627e\u7b2c\u4e00\u4e2a<=Y\u7684 \n            if (p2<p1) printf(\"0\\n\"); //\u8fd9\u4e2a\u6ce8\u610f\u8981\u5224\u6389 \n            else\n            printf(\"%d\\n\",p2-p1+1);\n        } else\n        {\n            X=read();\n            if (a[X]==a[X+1]) continue;//\u4fee\u6539\uff0c\u5982\u679c\u989c\u8272\u76f8\u540c\u4e0d\u7528\u6539\u4e86 \n            p1=lower_bound(g[a[X]].begin(),g[a[X]].end(),X)-g[a[X]].begin();\n            g[a[X]][p1]++;\n            p2=lower_bound(g[a[X+1]].begin(),g[a[X+1]].end(),X+1)-g[a[X+1]].begin();\n            g[a[X+1]][p2]--;\n            swap(a[X],a[X+1]);//\u8bb0\u5f97\u6362\u6389 \n        }\n    }\n    return 0;\n}\n\n```",
        "postTime": 1509550072,
        "uid": 2674,
        "name": "\u300cQQ\u7ea2\u5305\u300d",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "# P3939 \u6570\u989c\u8272\n\n\u8bf4\u5b9e\u8bdd\uff0c\u8fd9\u9898\u5148\u4e00\u770b\u662f\u4e2a\u4e3b\u5e2d\u6811\u9898\uff0c\u5b9e\u9645 ***\u6ca1\u9519\u6211\u6570\u636e\u7ed3\u6784\u5b66\u75af\u4e86\u6ca1\u6551\u4e86***\n\n## \u5148\u8bf4\u4e3b\u5e2d\u6811 ***~~\u6dae\u6cd5~~*** \n\n**\u9996\u5148\u6211\u4eec\u770b\u8be2\u95ee**\uff0c\u76f4\u63a5\u7528\u7248\u672c\u76f8\u51cf\uff0c\u5355\u70b9\u8be2\u95ee\u5c31\u884c\u4e86\u3002\n\n**\u4fee\u6539\u64cd\u4f5c\u4ea4\u6362\u76f8\u90bb\u7684\u4e24\u4e2a\u6570**\uff0c\u6211\u4eec\u53ea\u9700\u628a$x$\u7684\u7248\u672c\u4e0a\u526a\u6389$a_{i}$\n\u5e76\u4e14\u52a0\u4e0a$a_{i+1}$\u5373\u53ef\uff0c$i+1$\u7248\u672c\u662f\u4e0d\u7528\u52a8\u7684\u3002\n\n\u5982\u679c\u662f\u8fd9\u6837\u5176\u5b9e\u6211\u4eec\u4eec\u79bb\u6563\u5316\u662f\u5b8c\u5168\u53ef\u4ee5\u8fc7\u7684\u3002**\u4f46\u662f**\uff0c\u51fa\u9898\u7684\u8fd9\u4e2a\u6bd4\u67e5\u8be2\u7684\u65f6\u5019\u4e0d\u4fdd\u8bc1\u8fa3\u4e2a\u6570\u662f\u5b58\u5728\u7684\uff0c\u4e5f\u5c31\u662f\u79bb\u6563\u5316\u4e4b\u540e\uff0c\u76f4\u63a5\u4e8c\u5206\u67e5\u627e\u5bfb\u627e\u4f1a$Wa$\u7684\u59a5\u59a5\u7684\u3002\u5176\u5b9e\u53ea\u8981\u5728\u8be2\u95ee\u65f6\u5224\u65ad\u8fd9\u4e2a\u65f6\u662f\u5426\u51fa\u73b0\u8fc7\u5373\u53ef ***Ps\uff1a\u79bb\u6563\u5316\u522b\u5199\u9519\u4e86\uff0c\u522b\u95ee\u6211\u95ee\u4ec0\u4e48***\u3002\n\n### \u4f46\u662f\u6211\u7528\u8840\u8bc1\u660e\u4e86\u5b83\u5361\u4e3b\u5e2d\u6811\u7684\u5e38\uff0c\u800c\u4e14\u5361\u4e0d\u8fc7\u53bb\uff0c\u771f\u7684\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <cmath>\nusing namespace std;\nint read(){\n\tint w=1,x=0,ch=getchar();\n\tfor(;ch<'0'||ch>'9';ch=getchar())if(ch=='-')w=-1;\n\tfor(;ch>='0'&&ch<='9';ch=getchar())x=x*10+ch-'0';\n\treturn x*w;\n}\nconst int MAXN = (int)5e5+10; \nint n,m,cnt,t[MAXN<<6],L[MAXN<<6],R[MAXN<<6];\nvoid insert(int rt,int &newrt,int l,int r,int pos,int val){\n\tnewrt = ++cnt;\n\tL[newrt] = L[rt],R[newrt] = R[rt];\n\tt[newrt] = t[rt] + val;\n\tif(l==r)return;\n\tint mid = l+r >> 1;\n\tif(pos<=mid)insert(L[rt],L[newrt],l,mid,pos,val);\n\telse insert(R[rt],R[newrt],mid+1,r,pos,val);\n}\nint query(int u,int v,int l,int r,int pos){\n\tif(l==r)return t[v] - t[u];\n\tint mid = l+r >> 1;\n\tif(pos<=mid)return query(L[u],L[v],l,mid,pos);\n\telse return query(R[u],R[v],mid+1,r,pos);\n}\nint a[MAXN],b[MAXN],version[MAXN],ar[(int)1e6+10];\nint opt,l,r,k;\nint main(){\n//\tfreopen(\"testdata.in\",\"r\",stdin);\n//\tfreopen(\"testdata.out\",\"w\",stdout);\n\tn = read(),m = read();\n\tfor(int i=1;i<=n;i++)a[i] = read(),b[i] = a[i];\n\tsort(b+1,b+1+n);\n\tint len = unique(b+1,b+1+n) - b - 1;\n\tfor(int i=1;i<=n;i++){\n\t\tint t = a[i];\n\t\ta[i] = lower_bound(b+1,b+1+len,a[i]) - b;\n\t\tinsert(version[i-1],version[i],1,len,a[i],1);\n\t\tar[t] = a[i];\n\t}\n\tfor(int i=1;i<=m;i++){\n\t\topt = read();\n\t\tif(opt==1){\n\t\t\tl = read(),r = read(),k = read();\n\t\t\tif(!ar[k]){\n\t\t\t\tprintf(\"0\\n\");\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tprintf(\"%d\\n\",query(version[l-1],version[r],1,len,ar[k]));\n\t\t}\n\t\telse {\n\t\t\tk = read();\n\t\t\tif(a[k]==a[k+1])continue;\n\t\t\tinsert(version[k],version[k],1,len,a[k],-1);\n\t\t\tinsert(version[k],version[k],1,len,a[k+1],1);\n\t\t\tswap(a[k],a[k+1]);\n\t\t}\n\t}\n\treturn 0;\n} \n```\n## \u6d41\u6c13\u6570\u636e\u7ed3\u6784 -> vector\n\n\u4f46\u662fvector\u662f\u4e00\u4e2a\u5de8\u6d41\u6279\u7684\u4e1c\u897f\uff0c\u8fd9\u9053\u9898\u7528vector\u5373\u597d\u4f7f\uff0c\u6b63\u786e\u6027\u4e5f\u53ef\u4ee5\u4fdd\u969c\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5bf9\u503c\u57df\u5f00\u4e2avector\uff0c\u4e4b\u540e\u6302\u8868\uff0c\u6bcf\u4e2avector\u4e0a\u8868\u793a\u7684\u662f\uff0c\u503c\u4e3a$x$\u7684\u6570\u7684\u4f4d\u7f6e\u7684\u5347\u5e8f\u6392\u5217\u3002\n\n**\u5bf9\u4e8e\u8be2\u95ee\u64cd\u4f5c**\u56e0\u6211\u4eec\u4ece\u5c0f\u5230\u5927\u904d\u5386\u7684\u5e8f\u5217\uff0c\u6240\u4ee5\u6bcf\u4e2avector\u4e2d\u7684\u4f4d\u7f6e\u81ea\u7136\u6709\u5e8f\uff0c\u90a3\u4e48\u53ea\u7528\u5728\u8be2\u95ee\u6743\u503c\u5bf9\u5e94\u7684vector\u4e2d\u53bb\u4e8c\u5206\u67e5\u627e\u8be2\u95ee\u533a\u95f4\u7684\u5de6\u53f3\u7aef\u70b9\u5373\u53ef\u3002 $ptr_r-ptr_l+1$\u5c31\u662f\u7b54\u6848\u3002\n\n***ps\uff1a\u8fd9\u91cc\u8981\u6ce8\u610f\uff0c\u4e8c\u5206\u7684\u5de6\u7aef\u70b9\u662flower_bound\uff0c\u4f46\u4e8c\u5206\u53f3\u7aef\u70b9\u662f\u8981\u7528upper_bound - 1\uff0c\u53ea\u662f\u56e0\u4e3a\uff0c\u5982\u679c\u5728\u8be5\u503c\u57df\u4e0a\u6302\u7684vector\u8868\u4e2d\u6ca1\u6709$ptr_l$,lower_bound\u4f1a\u627e\u5230\u6bd4\u5b83\u5927\u7684\u6570\uff0c\u8fd9\u6ee1\u8db3\u8981\u6c42\uff0c\u4f46\u5728\u627e\u53f3\u7aef\u70b9\u65f6\uff0c\u5982\u679c\u51fa\u73b0\u4e86\u4ee5\u4e0a\u60c5\u51b5\uff0clower_bound \u4f1a\u5e2e\u4f60\u627e\u5230\u5927\u4e8e$ptr_r$\u7684\u6570\uff08\u4e5f\u5c31\u662f\u4e0d\u518d\u8be2\u95ee\u533a\u95f4\u7684\u6570\u88ab\u7b97\u8fdb\u4e86\u7b54\u6848\u4e2d\u5c31\u4f1aGG\uff09\uff0c\u4f60\u5982\u679c\u76f4\u63a5\u5bf9lower_bound - 1,\u53c8\u4f1a\u5728vector\u4e2d\u5b58\u5728$ptr_r$\u65f6\u518d\u6b21\u51fa\u73b0\u95ee\u9898\uff0c\u6240\u4ee5\u6211\u4eec\u7528upper_bound - 1\u5b9e\u73b0\u53f3\u7aef\u70b9\u7684\u67e5\u627e***\n\n***\u5bf9\u4e8e\u4fee\u6539\u64cd\u4f5c***\uff0c\u56e0\u4e3a\u6211\u4eecvector\u4e2d\u5b58\u7684\u65f6\u4f4d\u7f6e\uff0c\u6211\u4eec\u76f4\u63a5\u628a$x$\u7684\u4f4d\u7f6e++\uff0c\u628a$x+1$ - -\u5c31\u597d\u4e86\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <vector>\n#include <algorithm>\nusing namespace std;\nint read(){\n\tint w=1,x=0,ch=getchar();\n\tfor(;ch<'0'||ch>'9';ch=getchar())if(ch=='-')w=-1;\n\tfor(;ch>='0'&&ch<='9';ch=getchar())x=x*10+ch-'0';\n\treturn x*w;\n}\nconst int MAXN = (int)3e5+100;\nint n,m,a[MAXN];\nvector<int>q[MAXN];\nint opt,l,r,x;\nint main(){\n\tn = read(),m = read();\n\tfor(int i=1;i<=n;i++){\n\t\ta[i] = read();\n\t\tq[a[i]].push_back(i);\n\t}\n\twhile(m--){\n\t\topt = read();\n\t\tif(opt==1){\n\t\t\tl = read(),r = read(),x = read();\n\t\t\tint ptr_l = lower_bound(q[x].begin(),q[x].end(),l) - q[x].begin();\n\t\t\tint ptr_r = upper_bound(q[x].begin(),q[x].end(),r) - q[x].begin() - 1;\n\t\t\tif(ptr_l>ptr_r){\t\n\t\t\t\tprintf(\"0\\n\");\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tprintf(\"%d\\n\",ptr_r-ptr_l+1);\n\t\t}\n\t\telse {\n\t\t\tx = read();\n\t\t\tif(a[x]==a[x+1])continue;\n\t\t\tint ptr_l = lower_bound(q[a[x]].begin(),q[a[x]].end(),x) - q[a[x]].begin();\n\t\t\tq[a[x]][ptr_l]++;\n\t\t\tint ptr_r = lower_bound(q[a[x+1]].begin(),q[a[x+1]].end(),x+1) - q[a[x+1]].begin();\n\t\t\tq[a[x+1]][ptr_r]--;\n\t\t\tswap(a[x],a[x+1]);\n\t\t}\n\t}\n\treturn 0;\n}\n \n```\n",
        "postTime": 1567298024,
        "uid": 165030,
        "name": "Sweetie_Liu",
        "ccfLevel": 6,
        "title": "P3939 \u6570\u989c\u8272"
    },
    {
        "content": "\u8fd9\u5c31\u662f\u4e00\u4e2a\u88f8\u7684\u4e3b\u5e2d\u6811\u3002\n\n\u5bf9\u6bcf\u4e2a\u989c\u8272\u5efa\u4e00\u68f5\u7ebf\u6bb5\u6811\uff0c \u7136\u540e\u5c31\u6ca1\u4e86\u3002\u3002\n\n```cpp\n#include <cstdio>\n#define lson l, m, lch[now]\n#define rson m+1, r, rch[now]\n#define swap(a, b) (a ^= b, b ^= a, a ^= b)\n#define N 300005\nint lch[N * 30], rch[N * 30], sum[N * 30], rt[N * 30], cnt;\nint col[N];\nvoid update(int l, int r, int &now, int p, int c){\n    if(!p) return;\n    if(!now) now = ++cnt;\n    sum[now] += c;\n    if(l == r) return;\n    int m = l+r>>1;\n    if(p <= m) update(lson, p, c);\n    else update(rson, p, c);\n}\nint query(int l, int r, int now, int a, int b){\n    if(!now) return 0;\n    if(l >= a && r <= b) return sum[now];\n    int m = l+r>>1, ans = 0;\n    if(a <= m) ans = query(lson, a, b);\n    if(b > m) ans += query(rson, a, b);\n    return ans;\n}\nint main(){\n    int i, j, n, m, c, o, a, b;\n    scanf(\"%d%d\", &n, &m);\n    for(i = 1; i <= n; i++){\n        scanf(\"%d\", &c);\n        col[i] = c;\n        update(1, n, rt[c], i, 1);\n    }\n    for(i = 1; i <= m; i++){\n        scanf(\"%d%d\", &o, &a);\n        if(o == 1) scanf(\"%d%d\", &b, &c), printf(\"%d\\n\", query(1,n,rt[c],a,b));\n        else{\n            update(1, n, rt[col[a]], a, -1);\n            update(1, n, rt[col[a+1]], a+1, -1);\n            update(1, n, rt[col[a]], a+1, 1);\n            update(1, n, rt[col[a+1]], a, 1);\n            swap(col[a], col[a+1]);\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1510111297,
        "uid": 31619,
        "name": "Hzxleo4",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u7528\u4e00\u4e0b$vector$\u5c31\u597d\uff0c\u7b80\u5355\u7ffb\u4e86\u4e00\u4e0b\u9898\u89e3\uff0c\u53d1\u73b0\u53ea\u6709\u7b2c\u4e00\u7bc7\u548c\u6211\u65b9\u6cd5\u4e00\u6837\uff0c\u4ee3\u7801\u5374\u8fd8\u6709\u5f88\u5927\u4e0d\u540c\uff0c\u6240\u4ee5\u53d1\u4e00\u7bc7\u9898\u89e3\u7eaa\u5ff5\u4e00\u4e0b\u3002\n\n\u7528$vector[a[i]]$\u8bb0\u5f55\u989c\u8272\u4e3aa[i]\u7684\u6240\u6709\u4e0b\u6807\uff0c\u56e0\u4e3a\u662f$vector$\uff0c\u6bd4\u4e8c\u7ef4\u6570\u7ec4\u8282\u7701\u5f88\u5927\u7684\u7a7a\u95f4\u3002\u7136\u540e\u6bcf\u6b21\u64cd\u4f5c\u7528\u5230$lowerbound$\u548c$upperbound$\u4e8c\u5206\u4e00\u4e0b\uff0c\u67e5\u8be2\u533a\u95f4\u5185\u7684\u5934\u548c\u5c3e\u5c31\u597d\u4e86\u3002\n\n\u8fd9\u9898\u6709\u51e0\u4e2a\u5751\u70b9\uff0c\u4e0b\u9762\u4ee3\u7801\u91cc\u8bb2\u3002\n\n```cpp\n#include <cstdio>\n#include <vector>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nconst int N=50005;\nint n,m,l,r,c,a[N];\nint flag,p,q;\nvector <int> v[N];\n\nint main () {\n//    freopen (\".in\",\"r\",stdin);\n//    freopen (\".out\",\"w\",stdout);\n\tscanf (\"%d%d\",&n,&m);\n\tfor (int i=1;i<=n;i++) {\n\t\tscanf (\"%d\",&a[i]);\n\t\tv[a[i]].push_back(i);//\u628a\u4e0b\u6807\u538b\u5165\u8be5\u989c\u8272\n\t}\n\twhile (m--) {\n\t\tscanf (\"%d\",&flag);\n\t\tif (flag==1) {\n\t\t\tscanf (\"%d%d%d\",&l,&r,&c);//\u8be2\u95ee\n\t\t\tp=lower_bound(v[c].begin(),v[c].end(),l)-v[c].begin();\n\t\t\tq=upper_bound(v[c].begin(),v[c].end(),r)-v[c].begin()-1;//\u5751\u70b91\uff1a\u8fd9\u91cc\u4e0d\u662flower\n            //\u5206\u522b\u627e\u5934\u548c\u5c3e\n\t\t\tif (q<p) puts(\"0\");//\u5751\u70b92\uff1a\u4e0d\u7279\u5224\u4f1a\u8f93\u8d1f\u6570\n\t\t\telse printf (\"%d\\n\",q-p+1);\n\t\t}\n\t\telse {\n\t\t\tscanf (\"%d\",&c);\n\t\t\tif (a[c]==a[c+1]) continue;//\u5751\u70b93\uff1a\u5982\u679c\u8fd9\u4e24\u4e2a\u672c\u6765\u5c31\u4e00\u6837\uff0c\u6839\u672c\u4e0d\u9700\u64cd\u4f5c\uff0c\u8df3\u8fc7\u5c31\u597d\n\t\t\tp=lower_bound(v[a[c]].begin(),v[a[c]].end(),c)-v[a[c]].begin();\n\t\t\tv[a[c]][p]++;//\u76f8\u5f53\u4e8e\u628a\u6539\u989c\u8272\u5185\u7684c\u53d8\u6210c+1\n\t\t\tq=lower_bound(v[a[c+1]].begin(),v[a[c+1]].end(),c+1)-v[a[c+1]].begin();\n\t\t\tv[a[c+1]][q]--;//c+1\u53d8\u6210c\n\t\t\tswap(a[c],a[c+1]);//\u64cd\u4f5c\u5b8c\u522b\u5fd8\u4ea4\u6362\n\t\t}\n\t}\n    return 0;\n    //\u5b8c\u7ed3\u6492\u82b1\n}\n```\n",
        "postTime": 1573048267,
        "uid": 109640,
        "name": "\u5fae\u9999\u7389\u70db\u6697",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "\u8fd9\u91cc\u63d0\u4f9b\u7684\u662f std\u3002\n\n\u5982\u679c\u9700\u8981\u9898\u89e3\uff0c\u8bf7\u53c2\u8003 [ppt](https://www.luogu.org/discuss/show?postid=26414)\uff0c\u6216\u8005\u5176\u4ed6\u540c\u5b66\u7684\u9898\u89e3\u3002\n\n\n\u5173\u4e8e STL\uff1a\u672c\u6765\u90fd\u662f\u53ef\u4ee5\u5f88\u7b80\u5355\u624b\u5199\u7684\uff0c\u6211\u61d2\u764c\u665a\u671f QAQ\n\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nint ch;\ninline void read(int &a) {\n    a = 0;\n    while (ch < '0' || ch > '9') ch = getchar();\n    while (ch >= '0' && ch <= '9') a = a * 10 + ch - '0', ch = getchar();\n}\n\n#define MAXN 300005\n\nint n, m;\nint a[MAXN];\nvector <int> b[MAXN];\n\nint main() {\n    read(n); read(m);\n    for (int i = 1; i <= n; i++) {\n        read(a[i]);\n        b[a[i]].push_back(i);\n    }\n    for (int i = 1; i <= n; i++) sort(b[i].begin(), b[i].end());\n    for (int i = 1, x, l, r, c; i <= m; i++) {\n        read(x);\n        if (x == 1) {\n            read(l); read(r); read(c);\n            printf(\"%d\\n\", (int)(upper_bound(b[c].begin(), b[c].end(), r) - lower_bound(b[c].begin(), b[c].end(), l)));\n        }\n        else {\n            read(x);\n            if (a[x] != a[x + 1]) {\n                (*lower_bound(b[a[x]].begin(), b[a[x]].end(), x))++;\n                (*lower_bound(b[a[x + 1]].begin(), b[a[x + 1]].end(), x + 1))--;\n                swap(a[x], a[x + 1]);\n            }\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1509731236,
        "uid": 12621,
        "name": "fstqwq",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "[\u94fe\u63a5](https://www.luogu.org/problemnew/show/3939)\n\n\u5982\u4f55\u5728\u4e00\u4e2a\u533a\u95f4\u5185\u67e5\u4e00\u4e2a\u6570\u5b57\u51fa\u73b0\u7684\u6b21\u6570\uff1f\n\n\u75af\u72c2\u8111\u8865~~\u641e\u57fa\u6570\u636e\u7ed3\u6784~~\uff08\u8fd9\u4e2a\u53eb\u505a\u6570\u636e\u7ed3\u6784\u75c5\uff09\n\n\u597d\u50cf\u6ca1\u6709\u5408\u9002\u7684QuQ\n\n\u4e8e\u662f\u5f00\u59cb\u60f3\u6b63\u5e38\u89e3\u6cd5\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u60f3\u4e00\u4e0b\u6b63\u5e38\u89e3\u6cd5\u3002\n\nc[i][j]\u8868\u793a\u7684\u662fi\u989c\u8272\u7b2cj\u4e2a\u5154\u5b50\u51fa\u73b0\u7684\u4f4d\u7f6e\u3002\n\n\u4e0d\u662f~~DP~~\n\n\u5f88\u660e\u663ec[i]\u91cc\u9762\u5b58\u7684\u5154\u5b50\u51fa\u73b0\u7684\u4f4d\u7f6e\u662f\u9012\u589e\u7684\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u4e8c\u5206\u67e5\u627e\u4e86\u3002\n\n\u67e5\u8fd9\u4e2a\u989c\u8272\u91cc\u5c0f\u4e8el\u4f4d\u7f6e\u7684\u5154\u5b50\u6709\u51e0\u53ea\u3002\n\n\u989c\u8272\u91cc\u5c0f\u4e8e\u7b49\u4e8e\u4f4d\u7f6e\u7684\u5154\u5b50\u6709\u51e0\u53ea\u3002\n\n\u7136\u540e\u4e00\u51cf\u5c31\u662f\u7b54\u6848\u4e86\u3002\n\n\u7b49\u4e00\u4e0b\uff0c\u4e8c\u7ef4\u6570\u7ec4\u5f00\u591a\u5927\uff1f\n\n\u5f00vector\u554a\uff08\u9003~\n\n\u81f3\u4e8e\u4fee\u6539\uff0c\u8bb0\u5f55\u4e0b\u6765\u7136\u540e\u4ea4\u6362\u5c31\u884c\u4e86\u3002\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <vector>\n#include <algorithm>\nusing namespace std;\nstruct node{\n    int col,w;\n}a[3*110000];\nvector <int> c[3*110000];\nint find(int id,int x)\n{\n    int l=1,r=c[id].size()-1;\n    int ans=0;\n    while(l<=r)\n    {\n        int mid=(l+r)/2;\n        if(c[id][mid]>=x) ans=mid,r=mid-1;\n        else l=mid+1;\n    }\n    return ans;\n}\nint main()\n{\n    int n,q;\n    scanf(\"%d%d\",&n,&q);\n    /*for(int i=1;i<=3*1e5;i++)\n     c[i].push_back(0);*/\n    for(int i=1;i<=n;i++)\n    {\n        int x;\n        scanf(\"%d\",&x);\n        c[x].push_back(i);\n        a[i].col=x,a[i].w=c[x].size()-1;\n    }\n    for(int i=1;i<=q;i++)\n    {\n        int opt;\n        scanf(\"%d\",&opt);\n        if(opt==1)\n        {\n            int l,r,cr;\n            scanf(\"%d%d%d\",&l,&r,&cr);\n            if(c[cr].size()==0)\n            {\n                printf(\"0\\n\");\n                continue;\n            } \n            int pos1=lower_bound(c[cr].begin(),c[cr].end(),l)-c[cr].begin();\n            int pos2=upper_bound(c[cr].begin(),c[cr].end(),r)-c[cr].begin();\n            printf(\"%d\\n\",pos2-pos1);\n        }\n        if(opt==2)\n        {\n            int x;\n            scanf(\"%d\",&x);\n            if(a[x].col==a[x+1].col) continue;\n            int w1=a[x].w,w2=a[x+1].w;\n            int c1=a[x].col,c2=a[x+1].col;\n            a[x].col=c2,a[x+1].col=c1;\n            a[x].w=w2,a[x+1].w=w1;\n            c[c1][w1]=x+1;\n            c[c2][w2]=x;\n        }\n    }\n    \n    return 0;\n}\n```",
        "postTime": 1514883150,
        "uid": 19842,
        "name": "\u534a\u4ed9\u80e1\u5c0f\u6843",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "## \u5206\u6790\u9898\u76ee\n\u6b64\u9898\u5927\u81f4\u89e3\u6cd5\u662f\u7528 `vector` \u5b58\u989c\u8272\u5728\u5e8f\u5217\u4e2d\u7684\u4f4d\u7f6e\uff0c\u67e5\u8be2\u64cd\u4f5c\u53ef\u7528\u4e8c\u5206\u5728\u5bf9\u5e94\u989c\u8272\u7684 `vector` \u4e2d\u6c42\u533a\u95f4\u957f\u5ea6\u5f97\u5230\u7b54\u6848\uff0c\u4fee\u6539\u64cd\u4f5c\u5c31\u662f\u5728\u5bf9\u5e94\u7684 `vector` \u4e2d\u627e\u51fa\u8be5\u5154\u5b50\uff0c\u8fdb\u884c\u989c\u8272\u4fee\u6539\u3002\n\n## \u4ee3\u7801\u5b9e\u73b0\n\u8bb2\u4e00\u4e9b\u7ec6\u8282\u3002\n\n### 1.\n\u6211\u770b\u5230 [redbag \u7684\u9898\u89e3](https://www.luogu.com.cn/blog/ylx/solution-p3939) \u4e2d\u8be2\u95ee\u90e8\u5206\u6709\u4e00\u4e2a\u6bd4\u8f83\u9ebb\u70e6\u7684\u5199\u6cd5 \n```cpp\np1=lower_bound(g[Z].begin(),g[Z].end(),X)-g[Z].begin();\np2=upper_bound(g[Z].begin(),g[Z].end(),Y)-g[Z].begin()-1; \nif(p2<p1) \n\tputs(\"0\");  \nelse\n\tprintf(\"%d\\n\",p2-p1+1);\n```\n\uff08\u4ee3\u7801\u7565\u6709\u6539\u52a8\uff09\n\n\u5176\u5b9e\u53ef\u4ee5\u7cbe\u7b80\u6210\u8fd9\u6837\n\n```cpp\nprintf(\"%d\\n\",upper_bound(col[c].begin(),col[c].end(),r)-lower_bound(col[c].begin(),col[c].end(),l));\n```\n\u4e24\u4e2a `vector<int>` \u7684\u8fed\u4ee3\u5668\u662f\u76f4\u63a5\u53ef\u4ee5\u505a\u52a0\u51cf\u7684\uff0c\u6240\u4ee5\u6ca1\u5fc5\u8981\u518d\u6539\u6210\u4e0b\u6807\uff0c\u518d\u5728\u6574\u6570\u610f\u4e49\u4e0b\u505a\u51cf\u6cd5\u3002\n\n\u90a3 $p2<p1$ \u8fd9\u79cd\u60c5\u51b5\u600e\u4e48\u529e\uff1f\u4f1a\u6f0f\u6389\u5417\uff1f\n\n\u4e0d\u4f1a\u3002`upper_bound` \u627e\u5230\u7684\u4f4d\u7f6e\u4e00\u5b9a $\\ge$ `lower_bound` \u627e\u5230\u7684\u4f4d\u7f6e\uff0c\u5c31\u7b97\u843d\u5728\u540c\u4e00\u4e2a\u70b9\u4e0a\uff0c$p2$ \u4e5f\u53ea\u4f1a\u6bd4 $p1$ \u5c0f $1$ \uff0c\u6240\u4ee5\u4e0d\u7ba1\u600e\u6837\uff0c\u8fd9\u4e2a\u5224\u65ad\u90fd\u662f\u5197\u4f59\u7684\u3002\n\n### 2.\n\u4fee\u6539\u64cd\u4f5c\u5751\u6bd4\u8f83\u591a\u3002\n\n\u5982\u679c\u8981\u4ea4\u6362\u7684\u5154\u5b50\u989c\u8272\u4e0d\u540c\uff0c\u90a3\u4e48\u4ea4\u6362\u5c31\u662f\u65e0\u610f\u4e49\u7684\uff0c\u628a\u8fd9\u4e2a\u5224\u65ad\u6389\u53ef\u4ee5\u8282\u7701\u4e00\u4e9b\u65f6\u95f4\u3002\n\n\u4ea4\u6362\u5154\u5b50\u7684\u8fc7\u7a0b\u522b\u60f3\u590d\u6742\u4e86\uff0c\u5c31\u662f\u5728 `vector` \u4e2d\u627e\u5230\u8981\u6362\u8fc7\u6765\u7684\u4e24\u53ea\u5154\u5b50\uff0c\u7136\u540e\u628a\u524d\u9762\u90a3\u53ea\u7684\u4f4d\u7f6e\u52a0\u4e00\uff0c\u540e\u9762\u90a3\u53ea\u7684\u4f4d\u7f6e\u51cf\u4e00\u3002\n\n\u4fee\u6539\u5b8c\u4e4b\u540e\u8981 **\u4ea4\u6362\u539f\u6570\u7ec4\u4e2d\u7684\u989c\u8272**\n### 3.\n\u6b64\u9898\u8f93\u51fa\u91cf\u53ef\u80fd\u8f83\u5927\uff0c\u4e8e\u662f\u6211\u52a0\u4e86\u8f93\u51fa\u4f18\u5316\u3002\n\n\u5feb\u5199\u53ea\u662f\u6700\u57fa\u672c\u7684\uff0c\u8fd8\u53ef\u4ee5\u7528 `char` \u6570\u7ec4\u50a8\u5b58\u7ed3\u679c\uff0c\u7528 `fwrite` \u52a0\u901f\u8f93\u51fa\u3002\n\n\u50a8\u5b58\u7ed3\u679c\n```cpp\nvoid save(const int x){\n\tif(x>9)\n\t\tsave(x/10);\n\tres[++cnt]=x%10+48;\n}\n```\n\n\u6700\u540e\u4e00\u8d77\u8f93\u51fa\n```cpp\nfwrite(res+1,1,cnt,stdout);\n```\n\n`res` \u6570\u7ec4\u6211\u4e00\u822c\u5f00\u5230\u7b54\u6848\u89c4\u6a21\u7684 $10$ \u500d\uff0c\u4f46\u5177\u4f53\u8fd8\u662f\u8981\u770b\u9898\uff0c\u5361\u7a7a\u95f4\u7684\u9898\u76ee\u614e\u7528\u3002\n\n### \u5b8c\u6574\u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=300004;\nchar res[maxn*10];\nint n,m,op,cnt,a[maxn];\nvector < int > col[maxn];\n\ninline void read(int &x){\n\tchar c=getchar();x=0;\n\tfor(;c<'0'||c>'9';c=getchar());\n\tfor(;c>='0'&&c<='9';c=getchar())\n\t\tx=(x<<1)+(x<<3)+(c^48);\n}\n\nvoid print(const int x){\n\tif(x>9)\n\t\tprint(x/10);\n\tres[++cnt]=x%10+48;\n}\n\nint main(){\n\tread(n),read(m);\n\tfor(int i=1;i<=n;i++){\n\t\tread(a[i]);\n\t\tcol[a[i]].push_back(i);\n\t}\n\twhile(m--){\n\t\tread(op);\n\t\tint l,r,c,x;\n\t\tif(op==1){\n\t\t\tread(l),read(r),read(c);\n\t\t\tprint(upper_bound(col[c].begin(),col[c].end(),r)-\n\t\t\tlower_bound(col[c].begin(),col[c].end(),l));\n\t\t\tres[++cnt]='\\n';\n\t\t}\n\t\telse{\n\t\t\tread(x);\n\t\t\tint c1=a[x],c2=a[x+1];\n\t\t\tif(c1==c2)\n\t\t\t\tcontinue;\n\t\t\tint p1=lower_bound(col[c1].begin(),col[c1].end(),x)\n\t\t\t-col[c1].begin();\n\t\t\tint p2=lower_bound(col[c2].begin(),col[c2].end(),x+1)\n\t\t\t-col[c2].begin();\n\t\t\t++col[c1][p1];\n\t\t\t--col[c2][p2];\n\t\t\tswap(a[x],a[x+1]);\n\t\t}\n\t}\n\tfwrite(res+1,1,cnt,stdout);\n\treturn 0;\n}\n```\n\u76ee\u524d\u662f\u6700\u4f18\u89e3\u3002",
        "postTime": 1601708649,
        "uid": 289944,
        "name": "Na2PtCl6",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "\u4e00\u4e2a\u771f\u6b63\u7684\u5b66\u6570\u636e\u7ed3\u6784\u5b66\u50bb\u7684\u4eba\u6765\u63d0\u4f9b\u4e00\u79cd\u7b80\u5355\u6613\u60f3\u7684\u601d\u8def\n\n~~\u4ee3\u7801\u4e5f\u4e0d\u957f\u5bf9\u5427~~\n\n\u7b2c\u4e00\u773c\uff1asb\u9898\uff01\u5bf9\u4e8e\u6bcf\u79cd\u989c\u8272\u7684\u5154\u5b50\u5efa\u4e00\u4e2a\u6743\u503c\u6811\u72b6\u6570\u7ec4\u5c31\u53ef\u4ee5\u4e86\n\n\u7b2c\u4e8c\u773c\uff1a\u7b49\u7b49\u8fd9\u6570\u636e\u8303\u56f4\u597d\u50cf\u6709\u4e9b\u4e0d\u5bf9\uff0c\u5f00\u4e0d\u4e0b\n\n\u7b2c\u4e09\u773c\uff1a\u54c8\uff0ccdq\u4ee3\u66ff\u6811\u72b6\u6570\u7ec4\u5c31\u53ef\u4ee5\u4e86\u554a\n\n\n~~\u5c31\u6211\u7528cdq???~~\n\n\u4ee5\u4e0a\n\nps: cdq\u5de6\u95ed\u53f3\u5f00\n\nps2:\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\uff0c\u4f30\u8ba1\u662f\u4ec0\u4e48\u8fb9\u754c\u60c5\u51b5\u6ca1\u8003\u8651\uff0c\u7b2c\u4e8c\u4e2a\u70b9\u6302\u4e86\uff0c\u6ca1\u6709\u6570\u636e\uff0c\u5bf9\u62cd\u4e5f\u6ca1\u5f04\u51fa\u6765\uff0c\u5c31\u5199\u4e2a\u66b4\u529b\u7279\u5224\u4e00\u4e0bQwQ\u3002\n\nps3:\u5982\u679c\u6709\u4eba\u80fd\u770b\u51fa\u6211\u4e3a\u4ec0\u4e48Test2\u6302\u70c2\uff0c\u8bf7\u5728\u8bc4\u8bba\u533a\u6307\u51fa\uff0c\u8c22\u8c22\u5927\u4f6c\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,m;\nconst int N=3e5+7;\nconst int M=3e5+7;\nstruct Query{\n    int type,id,val;\n    bool operator < (const Query &p){\n        if(id==p.id)return type<p.type;\n        return id<p.id;\n    }\n};\nvector<Query>qry[M];\nint acnt;\nint col[N];\nint ans[M];\nQuery tmp[M*8];\nvoid cdq(int l,int r,vector<Query>&query)\n{\n    if(r-l<=1)return;\n    int mid=(l+r)>>1;\n    cdq(l,mid,query),cdq(mid,r,query);\n    int sum=0;\n    int p=l,q=mid,cnt=0;\n    while(p<mid&&q<r)\n        if(query[p]<query[q])\n        { \n            if(query[p].type==1)sum+=query[p].val;\n            tmp[cnt++]=query[p++];\n        }\n        else\n        { \n            if(query[q].type==2)ans[query[q].val]-=sum;\n            else if(query[q].type==3)ans[query[q].val]+=sum;\n            tmp[cnt++]=query[q++];\n        }\n    while(p<mid)tmp[cnt++]=query[p++];\n    while(q<r)\n    {\n        if(query[q].type==2)ans[query[q].val]-=sum;\n        else if(query[q].type==3)ans[query[q].val]+=sum;\n        tmp[cnt++]=query[q++];\n    }\n    for(int i=0;i<cnt;++i)query[i+l]=tmp[i];\n}\nint a[10001];\nint main(void)\n{\n    scanf(\"%d%d\",&n,&m);\n    if(n<=10000)\n    {\n        for(int i=1;i<=n;++i)scanf(\"%d\",a+i);\n        for(int i=1;i<=m;++i)\n        {\n            int t;\n            scanf(\"%d\",&t);\n            if(t==1)\n            {\n                int l,r,c;\n                scanf(\"%d%d%d\",&l,&r,&c);\n                int ans=0;\n                for(int i=l;i<=r;++i)if(a[i]==c)ans++;\n                printf(\"%d\\n\",ans);\n            }\n            else\n            {\n                int x;\n                scanf(\"%d\",&x);\n                swap(a[x],a[x+1]);\n            }\n        }\n        return 0;\n    }\n    for(int i=1;i<=n;++i)\n    {\n        int a;\n        scanf(\"%d\",&a);\n        col[i]=a;\n        qry[a].push_back((Query){1,i,1});\n    }\n    for(int i=1;i<=m;++i)\n    {\n        int t;\n        scanf(\"%d\",&t);\n        if(t==1)\n        {\n            int l,r,c;\n            scanf(\"%d%d%d\",&l,&r,&c);\n            qry[c].push_back((Query){2,l-1,acnt});\n            qry[c].push_back((Query){3,r,acnt++});\n        }\n        else\n        {\n            int x;\n            scanf(\"%d\",&x);\n            int cx=col[x],cx1=col[x+1];\n            if(cx==cx1)continue;\n            swap(col[x],col[x+1]);\n            qry[cx].push_back((Query){1,x,-1});\n            qry[cx].push_back((Query){1,x+1,1});\n            qry[cx1].push_back((Query){1,x+1,-1});\n            qry[cx1].push_back((Query){1,x,1});\n        }\n    }\n    for(int i=1;i<=n;++i)\n        if(!qry[i].empty())\n            cdq(0,qry[i].size(),qry[i]);\n    for(int i=0;i<acnt;++i)printf(\"%d\\n\",ans[i]);\n    return 0;\n}\n\n```",
        "postTime": 1548385735,
        "uid": 19607,
        "name": "ACA\u306d",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "\u6570\u636e\u7ed3\u6784\u662f\u4f18\u96c5\u7684\u66b4\u529b\t\u2014\u2014ybh\n\n\u9898\u76ee\u4f20\u9001\u95e8\uff1a[\u6570\u989c\u8272](https://www.luogu.org/problemnew/show/P3939)\n\n\u52a8\u6001\u5f00\u70b9\u7ebf\u6bb5\u6811\uff08[\u8dd1\u5f97\u662f\u771f\u7684\u6162](https://www.luogu.org/recordnew/show/20388284)\uff09\n\n\u5bf9\u6bcf\u4e00\u79cd\u989c\u8272\u90fd\u5f00\u4e00\u68f5\u7ebf\u6bb5\u6811\n\n\u6ce8\u610f\u5e38\u6570\u4f18\u5316\uff08\u5426\u5219\u540e\u4e09\u4e2a\u70b9\u4f1aT\uff09\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<ctime>\nusing namespace std;\nconst int MAXN=3e5 + 5;\n\ninline int read()\n{\n    int x=0,w=1;\n    char ch=getchar();\n    while(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n    while(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+ch-48;ch=getchar();}\n    return x*w;\n}\n\nstruct Segment_Tree\n{\n    int lp,rp,sum;\n}t[MAXN*80];\nint rt[MAXN]={0},cnt=0,a[MAXN];\nvoid Upd(int &p,int k,int l,int r,int tag)//\u5355\u70b9\u4fee\u6539 \n{\n    if(!p) p=++cnt;\n    if(l==r)\n    {\n        t[p].sum+=tag;\n        return ;\n    }\n    int mid=(l+r)>>1;\n    if(k<=mid) Upd(t[p].lp,k,l,mid,tag);\n    else Upd(t[p].rp,k,mid+1,r,tag);\n    t[p].sum=t[t[p].lp].sum+t[t[p].rp].sum;\n}\n\nint Query(int p,int l,int r,int x,int y)\n{\n    if(!p) return 0;\n    if(x<=l&&r<=y)\n        return t[p].sum;\n    int mid=(l+r)>>1,ans=0;\n    if(x<=mid) ans+=Query(t[p].lp,l,mid,x,y);\n    if(mid<y) ans+=Query(t[p].rp,mid+1,r,x,y);\n    return ans;\n}\nint main()\n{\n\t/*freopen(\"r\",\"in.in\",stdin);\n\tfreopen(\"w\",\"out.out\",stdout);\n\tdouble s=clock(),e;*/\n    int n=read(),m=read();\n    for(register int i=1;i<=n;i++)\n    {\n        a[i]=read();\n        Upd(rt[a[i]],i,1,n,1);\n    }\n    while(m--)\n    {\n        int op=read(),l,r,x;\n        if(op==1)\n        {\n            l=read(),r=read(),x=read();\n            int ans=Query(rt[x],1,n,l,r);\n            printf(\"%d\\n\",ans);\n        }\n        else\n        {\n            x=read();\n            Upd(rt[a[x]],x,1,n,-1);\n            Upd(rt[a[x+1]],x+1,1,n,-1);\n            Upd(rt[a[x]],x+1,1,n,1);\n            Upd(rt[a[x+1]],x,1,n,1);\n        \tint t=a[x];a[x]=a[x+1];a[x+1]=t;\n\t\t}\n    }\n    //e=clock();\n    //printf(\"%.2lf ms\\n\",e-s);\n    return 0;\n}\n```\n",
        "postTime": 1562467481,
        "uid": 88736,
        "name": "Sober_Clever",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "#\u4e0d\u7528\u4e8c\u5206\u548cvector\u7684\u7b80\u5355\u505a\u6cd5\n\n\n    \n\n            \n\n\n\n\n\n\n```cpp\n//\u8fd9\u5e94\u8be5\u7b97\u4e00\u4e2asao\u64cd\u4f5c\u5427 \n//\u65e2\u6ca1\u6709\u7528vector\uff0c\u4e5f\u6ca1\u6709\u7528\u4e8c\u5206 \n//\u601d\u8def\u975e\u5e38\u6df3\u6734\uff0c\u4ee3\u7801\u975e\u5e38\u76f4\u767d \n//\u5982\u679c\u4e0d\u662f\u7b2c15\u4e2a\u70b9\u8981\u7279\u5224\uff0c\u5c31\u66f4\u7b80\u5355\u4e86 \n//\u601d\u8def\u662f\u628a\u8f93\u5165\u6570\u636e\u4f18\u5148\u6309\u989c\u8272\u518d\u6309\u4f4d\u7f6e\u6392\u4e2a\u5e8f \n//\u8bb0\u5f55\u6bcf\u79cd\u989c\u8272\u5728\u6392\u597d\u5e8f\u7684\u6570\u7ec4\u91cc\u7684\u521d\u672b\u4f4d\u7f6e \n//\u8bb0\u5f97\u627e\u5b8c\u4e4b\u540ebreak\u5c31\u884c\u4e86 \n//\u4ea4\u6362\u64cd\u4f5c\u4e5f\u662f\u4e00\u6837\u679a\u4e3e\u6240\u5728\u4f4d\u7f6e\n//\u7136\u540e\u6539\u53d8\u6392\u597d\u5e8f\u7684\u6570\u7ec4\u91cc\u5b83\u7684\u539f\u4f4d\u7f6e \n//\u8bb0\u4f4f\u4e00\u5b9a\u8981\u4ea4\u6362\u521d\u59cb\u6570\u7ec4\uff08\u4e0d\u8981\u95ee\u6211\u600e\u4e48\u77e5\u9053\u7684\uff09 \n//\u8fd9\u6837\u5c31\u80fd\u5f9795\u5206\u4e86 \n//\u4f46\u7b2c15\u4e2a\u70b9\u4e0d\u4e00\u6837\n//\u56e0\u4e3a\u5b83\u989c\u8272\u592a\u5c11\u4e86\u53ea\u670910 \n//\u6240\u4ee5for\u5faa\u73af\u679a\u4e3e\u989c\u8272\u4f1aT \n//\u56e0\u6b64\u8981\u7279\u5224\n//\u4f46\u5b83\u989c\u8272\u53ea\u670910 \n//\u6240\u4ee5\u4e5f\u5f88\u7b80\u5355 \n//\u628a\u6bcf\u79cd\u989c\u8272\u5728\u5230i\u7684\u603b\u6570\u8bb0\u5f55\u4e0b\u6765 \n//\u7136\u540e \u540e\u51cf\u524d\u5f97\u5230\u7ed3\u679c \n//\u4ea4\u6362\u56e0\u4e3a\u662f\u90bb\u7740\u6362\u6240\u4ee5\u4e0d\u4f1a\u5f71\u54cd\u540e\u9762\u7684 \n//\u8bb0\u5f97\u6362\u539f\u6570\u7ec4\u5c31\u884c\u4e86 \n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\nusing namespace std; \n#define ll long long\nconst int maxn=300005;\nint a[maxn],shi[maxn],mo[maxn];\ninline int read()\n{\n    char ch;int x=0;int f=1;ch=getchar();\n    while (ch!='-'&&(ch<'0'||ch>'9'))\n        ch=getchar();\n    ch=='-'?f=-1:x=ch-'0',ch=getchar();\n     while(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n     return x*f;\n}\nstruct rrr\n{\n    int se,wei;\n}r[maxn];\nint pai(const rrr &a,const rrr &b)\n{\n    if(a.se<b.se)return 1;\n    else if(a.se>b.se)return 0;\n    if(a.se==b.se)\n    {\n        if(a.wei<b.wei)return 1;\n        else return 0;\n    }\n}\nint te[10][300005],b[11];\nint main() \n{\n    int da=0;\n    int n,p,m,x,ans,y,z,w;\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n;i++)\n    {\n        a[i]=read();\n        r[i].se=a[i];\n        r[i].wei=i;\n        da=max(a[i],da);     //\u7279\u5224\u51c6\u5907 \n    }\nif(da>10)                    \n{    sort(r+1,r+n+1,pai);\n    shi[r[1].se]=1;\n    for(int i=2;i<=n;i++)\n    {\n        if(r[i].se>r[i-1].se)\n        {\n            shi[r[i].se]=i;\n            mo[r[i-1].se]=i-1;\n        }\n    }\n    mo[r[n].se]=n;\n    for(int i=1;i<=m;i++)\n    {\n        scanf(\"%d\",&w);\n        if(w==1)\n        {\n            scanf(\"%d%d%d\",&x,&y,&z);\n            ans=0;\n            for(int j=shi[z];j<=mo[z];j++)\n            {\n                if(r[j].wei>=x&&r[j].wei<=y)\n                {\n                    ans++;\n                }\n                if(r[j].wei>y+100)  //\u52a0\u4e0d\u52a0\u65e0\u6240\u8c13 \n                break;\n            }\n            printf(\"%d\\n\",ans);\n        }\n        else if(w==2)\n        {\n            scanf(\"%d\",&x);\n            int a1=a[x],b1=a[x+1];\n            swap(a[x],a[x+1]);  // \u5f88\u91cd\u8981\u4e0d\u80fd\u5fd8 \n            for(int j=shi[a1];j<=mo[a1];j++)\n            {\n                if(r[j].wei==x)\n                {\n                    r[j].wei=x+1;\n                    break;\n                }\n            }\n            for(int j=shi[b1];j<=mo[b1];j++)\n            {\n                if(r[j].wei==(x+1))\n                {\n                    r[j].wei=x;\n                    break;\n                }\n            }\n        }\n    }\n}\nelse                         //\u7279\u5224 \n{\n    for(int i=1;i<=n;i++)\n    {\n        b[a[i]]++;\n        for(int j=1;j<=10;j++)\n        {\n            te[j][i]=b[j];    \n        }\n    }    \n    for(int i=1;i<=m;i++)\n    {\n        w=read();\n        if(w==1)\n        {\n            scanf(\"%d%d%d\",&x,&y,&z);\n            printf(\"%d\\n\",te[z][y]-te[z][x-1]);\n        }\n        else if(w==2)\n        {\n            scanf(\"%d\",&x);\n            te[a[x]][x]--;\n            te[a[x+1]][x]++;\n            swap(a[x],a[x+1]);\n        }\n    }\n}\n    return 0;\n}\n\n```",
        "postTime": 1509711365,
        "uid": 34547,
        "name": "heyy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "# \u8fd9\u91cc\u63d0\u4f9b\u4e00\u79cd\u6a21\u62df\u6570\u7ec4\u7684\u5199\u6cd5\n###### \u9996\u5148\uff0c\u601d\u8def\u5c31\u662f\u50cfvector\u90a3\u6837\uff0c\u6211\u4eec\u7528\u4e00\u4e2acnt[i]\u6570\u7ec4\u8868\u793ai\u8fd9\u79cd\u989c\u8272\u51fa\u73b0\u4e86\u591a\u5c11\u6b21\uff0cd[i]\u8868\u793a\u8f93\u5165\u7684\u7b2ci\u4e2a\u5143\u7d20\u7684\u989c\u8272\u5728\u5f53\u65f6\u662f\u7b2c\u51e0\u6b21\u51fa\u73b0\uff0cc[i]\u5c31\u662f\u8f93\u5165\u7684\u7b2ci\u4e2a\u5143\u7d20\uff0ca[i].val\u5c31\u662fc[i],a[i].low\u5c31\u662fi\uff0cid[i]\u8868\u793ai\u8fd9\u4e2a\u989c\u8272\u7b2c\u4e00\u6b21\u51fa\u73b0\u5728a[i]\u4e2d\u7684\u6570\u7ec4\u4e0b\u6807\n##### \u53d8\u91cf\u540d\u9610\u8ff0\u5b8c\u4e86\uff0c\u63a5\u4e0b\u6765\u5c31\u662f\u9a9a\u64cd\u4f5c\n#### \u6211\u4eec\u60f3\u60f3\u770b\uff0c\u5f53\u6211\u4eec\u5b58\u597da[i]\u540e\uff0c\u5bf9\u4ed6\u8fdb\u884cval\uff08val\u8981\u79bb\u6563\u5316\uff0c\u8fd9\u6837\u66f4\u65b9\u4fbf\u6211\u4eec\u521d\u59cb\u5316id[i]\uff09\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u8fd9\u6837\u6211\u4eec\u7684\u6570\u7ec4\u5c31\u53d8\u6210\u4e86\u7c7b\u4f3c\u5206\u5757\u7684\u4e00\u4e2a\u6570\u7ec4\uff08\u4e5f\u5c31\u662f\u5c06\u4e8c\u7ef4\u6570\u7ec4\u6d3b\u751f\u751f\u7684\u538b\u6210\u4e86\u4e00\u7ef4\uff09\uff0c\u5f53\u6211\u4eec\u67e5\u8be2\u7684\u65f6\u5019\u76f4\u63a5\u4eceid[x]->id[x+1]-1\u8fd9\u4e00\u6bb5\u533a\u95f4\u8fdb\u884c\u641c\u7d22\uff08\u5176\u4e2d\u4f60\u9700\u8981\u624b\u5199\u4e8c\u5206\uff0c\u67e5\u5f97\u66f4\u5feb\uff08\u6211\u4eec\u6392\u5e8f\u7684\u65f6\u5019\u5728val\u76f8\u7b49\u7684\u65f6\u5019\u5c06low\u4ece\u5c0f\u5230\u5927\u6392\uff08\u65b9\u4fbfd[k]\u4fee\u6539\uff09\uff09\uff09\uff0c\u800c\u6211\u4eec\u5728\u4fee\u6539\u7684\u65f6\u5019\uff0c\u5c31\u901a\u8fc7id,c,d\u4e09\u4e2a\u6570\u7ec4\u627e\u5230a\u7684\u6570\u7ec4\u4e0b\u6807\u8fdb\u884c0\uff081\uff09\u4fee\u6539\uff0c\u540c\u65f6\u6211\u4eec\u9700\u8981\u66f4\u6539c,d\u6570\u7ec4\uff1b\n#### \u5927\u4f53\u4e0a\u601d\u8def\u5c31\u8fd9\u6837\uff0c\u76f4\u63a5\u5982\u679c\u8fd8\u6709\u5565\u64cd\u4f5c\u4e0d\u6e05\u695a\u7684\uff0c\u76f4\u63a5\u770b\u4ee3\u7801\n###\n###\n#### \u6211\u5148\u53d1\u4e00\u4e2a\u6ca1\u6709\u79bb\u6563\u5316\u548c\u4e8c\u5206\u67e5\u627e\u7684\u7801\u5b50\uff0890\uff09\n```\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\nusing namespace std;\nconst int maxn=300000+40;\nint id[maxn],cnt[maxn],c[maxn],d[maxn];\nint n,m;\nstruct node\n{\n\tint val,low;\n}a[maxn];\nint cmp(node x,node y)\n{\n\tif(x.val==y.val) return x.low<y.low;\n\treturn x.val<y.val;\n}\nint main()\n{\n//\tfreopen(\"flower.in\",\"r\",stdin);\n//\tfreopen(\"flower.out\",\"w\",stdout);\n\tint x,opt,l,r,k;\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&x);\n\t\tc[i]=x;\n\t\tcnt[x]++;\n\t\td[i]=cnt[x];\n\t\ta[i].val=x;\n\t\ta[i].low=i;\n\t}\n\tsort(a+1,a+n+1,cmp);\n\t//for(int i=1;i<=n;i++) printf(\"%d %d\\n\",a[i].val,a[i].low);\n\tid[0]=1;\n\tfor(int i=1;i<=n+1;i++) id[i]=id[i-1]+cnt[i-1];\n\t//for(int i=1;i<=n;i++) printf(\"%d \",id[i]);printf(\"\\n\");\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tscanf(\"%d\",&opt);\n\t\tif(opt==1)\n\t\t{\n\t\t\tscanf(\"%d%d%d\",&l,&r,&x);\n\t\t\tint ans=0;\n\t\t\tfor(int j=id[x];j<id[x+1];j++)\n\t\t\t{\n\t\t\t\tif(a[j].low>=l&&a[j].low<=r)\n\t\t\t\t{\n\t\t\t\t\tans++;\n\t\t\t\t}\n\t\t\t}\n\t\t\tprintf(\"%d\\n\",ans);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tscanf(\"%d\",&k);\n\t\t\tint tmp1=id[c[k]]+d[k]-1;\n\t\t\tint tmp2=id[c[k+1]]+d[k+1]-1;\n\t\t\tif(a[tmp1].val!=a[tmp2].val)\n\t\t\t{\n\t\t\t\ta[tmp1].low=k+1;\n\t\t\t\ta[tmp2].low=k;\n\t\t\t\tint sum1,sum2;\n\t\t\t\tsum1=c[k];c[k]=c[k+1];c[k+1]=sum1;\n\t\t\t\tsum2=d[k];d[k]=d[k+1];d[k+1]=sum2;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n```\n#### \u52a0\u70b9\u5c0f\u4f18\u5316\uff08\u5c31\u7279\u957f\uff0cac\uff09\n```\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\nusing namespace std;\nconst int maxn=300000+40;\nint id[maxn],cnt[maxn],c[maxn],d[maxn],e[maxn];\nint ys[maxn];\nint n,m;\nstruct node\n{\n\tint val,low;\n\tbool friend operator <(node x,node y)\n\t{\n\t\treturn x.low>y.low;\n\t}\n}a[maxn];\nstruct no\n{\n\tint id,x;\n}b[maxn];\nint cmp(node x,node y)\n{\n\tif(x.val==y.val) return x.low<y.low;\n\treturn x.val<y.val;\n}\nint ef(int l,int r,int x)\n{\n\tint ans=0;\n\twhile(l<=r)\n\t{\n\t\tint mid=(l+r)/2;\n\t\tif(a[mid].low>x)\n\t\t{\n\t\t\tr=mid-1;\n\t\t}\n\t\telse l=mid+1;\n\t}\n\treturn l;\n}\nint main()\n{\n\tint x,opt,l,r,k;\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&x);\n\t\tc[i]=x;\n\t\te[i]=x;\n\t\tcnt[x]++;\n\t\td[i]=cnt[x];\n\t\ta[i].val=x;\n\t\ta[i].low=i;\n\t}\n\tsort(e+1,e+n+1);\n\tint pos=0;\n\tb[++pos].x=e[1];\n\tys[e[1]]=pos;\n\tb[pos].id=pos;\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tif(e[i]!=e[i-1])\n\t\t{\n\t\t\tb[++pos].x=e[i];\n\t\t\tys[e[i]]=pos;\n\t\t\tb[pos].id=pos;\n\t\t}\n\t}\n\tsort(a+1,a+n+1,cmp);\n\t//for(int i=1;i<=n;i++) printf(\"%d %d\\n\",a[i].val,a[i].low);\n\tid[0]=1;\n\tfor(int i=1;i<=pos+1;i++) id[i]=id[i-1]+cnt[b[i-1].x];\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tscanf(\"%d\",&opt);\n\t\tif(opt==1)\n\t\t{\n\t\t\tscanf(\"%d%d%d\",&l,&r,&x);\n\t\t\tif(!cnt[x])\n\t\t\t{\n\t\t\t\tprintf(\"0\\n\");\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tint ans=0;\n\t\t\tint t1=ef(id[ys[x]],id[ys[x]+1]-1,l-1);\n\t\t\tint t2=ef(id[ys[x]],id[ys[x]+1]-1,r);\n\t\t\tprintf(\"%d\\n\",t2-t1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tscanf(\"%d\",&k);\n\t\t\tint tmp1=id[ys[c[k]]]+d[k]-1;\n\t\t\tint tmp2=id[ys[c[k+1]]]+d[k+1]-1;\n\t\t\tif(a[tmp1].val!=a[tmp2].val)\n\t\t\t{\n\t\t\t\ta[tmp1].low=k+1;\n\t\t\t\ta[tmp2].low=k;\n\t\t\t\tint sum1,sum2;\n\t\t\t\tsum1=c[k];c[k]=c[k+1];c[k+1]=sum1;\n\t\t\t\tsum2=d[k];d[k]=d[k+1];d[k+1]=sum2;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n\u597d\u4e86\uff0c\u6211\u8bb2\u5b8c\u4e86\uff0c\u662f\u4e0d\u662f\u5f88\u4f18\u79c0\n",
        "postTime": 1568431726,
        "uid": 111956,
        "name": "king_storm",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "emm...\u8fd9\u9898\u5206\u5757\u6709\u70b9\u5361\u7a7a\u95f4\n\n\u673a\u623fdalao\u76f4\u63a5\u6309\u9898\u610f\u5206\u5757\u88ab\u5361\u65f6\u95f4+\u5361\u7a7a\u95f4\u4e86\u3002\u3002\u3002 \u6240\u4ee5\u8003\u8651\u4e00\u4e0b\u600e\u6837\u4f18\u5316\uff0c \u4e00\u770b\u8fd9\u79cd\u6c42\u4e2a\u6570\u7684\u9898\u76ee\uff0c \u989c\u8272\u79cd\u7c7b\u4e00\u822c\u90fd\u4e0d\u4f1a\u5f88\u591a\uff0c \u6240\u4ee5\u5c1d\u8bd5\u79bb\u6563\u5316\u3002 \u79bb\u6563\u5316\u4e4b\u540e\u7528\u4e00\u4e2acnt\u6570\u7ec4\u6765\u5904\u7406\u4e00\u4e0b\u6bcf\u79cd\u79bb\u6563\u5316\u540e\u989c\u8272\u4e2a\u6570\u7684\u524d\u7f00\u548c\uff0c \u4ea4\u6362\u4e24\u4e2a\u70b9\u7684\u65f6\u5019\u5982\u679c\u8fd9\u4e24\u4e2a\u70b9\u518d\u540c\u4e00\u4e2a\u5757\u91cc\u81ea\u7136\u76f4\u63a5\u6539\uff0c \u4e0d\u5728\u7684\u8bdd\u4fee\u6539\u4e00\u4e0b\u672c\u5757\u7684cnt\u4e5f\u5c31\u662f\u4e86\u3002\u67e5\u8be2\u7684\u65f6\u5019\u6563\u5757\u76f4\u63a5\u66b4\u529b\uff0c \u6574\u5757\u524d\u7f00\u548c\u76f8\u51cf\uff0c\u8fd9\u6837\u4fee\u6539\u7684\u590d\u6742\u5ea6\u662fO1\uff0c \u67e5\u8be2\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f \u4e24\u4e2a\u5757\u7684\u957f\u5ea6\uff08\u6563\u5757\u7684\u67e5\u8be2\uff09 \u3002\u8db3\u4ee5\u901a\u8fc7\u6b64\u9898\n\n\u4e8e\u662f\u6109\u5feb\u7684MLE\u523095\u5206\uff0c \u5c1d\u8bd5\u7528unsinged short\u6765\u5b58cnt\u6570\u636e\uff0c \u4f46\u662f\u8fd9\u6837\u53c8\u4f1aWA\u4e00\u4e2a\u70b9\uff0c \u628a\u5757\u8c03\u5927\u4e86\u4e00\u4e9b\u5c31\u8fc7\u4e86\u3002\n\n\u53e6\u5916\u6ce8\u610f\uff1a \u67e5\u8be2\u7684\u989c\u8272\u672a\u5fc5\u5728\u521d\u59cb\u5e8f\u5217\u4e2d\u51fa\u73b0\uff0c \u6240\u4ee5\u8981\u5f00\u4e2a\u6570\u7ec4\u7279\u5224\u4e00\u4e0b\u3002\n\n```\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <cmath>\n#define maxn 300010 \n#define re register\n#define FOR(i, l, r) for(re int i = l; i <= r; ++i)\nusing namespace std;\n\nint n, m, c, r, t, x, y, s;\nint sq;\nint a[maxn], b[maxn], z[maxn];\nbool bl[maxn];\nint cnt[550][maxn];\ninline void in(re int &x){\n    x=0;re int bl = 1;char c=getchar();\n    while(c<'0'||c>'9'){\n    \tif(c == '-')\n    \t  bl = -1;\n        c=getchar();\n    }\n    while(c<='9'&&c>='0'){\n        x=(x<<1)+(x<<3)+(c^'0');\n        c=getchar();\n    }\n    x *= bl;\n}\n\nvoid out(re int a){\n    if(a < 0) {\n        putchar('-');\n        a = -a;\n    }\n    if(a>=10)out(a/10);\n    putchar(a%10+'0');\n}\n\ninline int query(int x, int y, int k) {\n    int res = 0;\n    FOR(i, x, min(y, b[x]*sq))\n      if(a[i] == k)\n        ++res;\n    if(b[x] != b[y])\n      FOR(i, (b[y]-1)*sq+1, y)\n        if(a[i] == k)\n          ++res;\n    if(b[x] < b[y]) {\n        res += (cnt[b[y]-1][k]-cnt[b[x]][k]);\t\n    }\n    return res;\n}\n\nvoid change(int x) {\n    if(b[x] == b[x+1]) {\n        swap(a[x], a[x+1]);\n    }\n    else {\n        --cnt[b[x]][a[x]];\n        ++cnt[b[x]][a[x+1]];\n        swap(a[x], a[x+1]);\n    }\n}\n\nint main() {\n    in(n), in(m);\n    sq = min(n, 1528); \n    FOR(i, 1, n)\n      in(a[i]), b[i] = (i-1)/sq+1, z[i] = a[i], bl[a[i]] = 1;\n    z[0] = n;\n    sort(z+1, z+z[0]+1);\n    z[0] = unique(z+1, z+z[0]+1)-z-1;\n    FOR(i, 1, n) {\n        a[i] = lower_bound(z+1, z+z[0]+1, a[i])-z;\n        ++cnt[b[i]][a[i]];\n    }\n    FOR(i, 2, b[n]) {\n        FOR(j, 1, z[0])\n          cnt[i][j] += cnt[i-1][j];\n    }\n    FOR(i, 1, m) {\n        in(t);\n        if(t == 1) {\n            in(x), in(y), in(s);\n            if(!bl[s]) {\n            \tputs(\"0\");\n            \tcontinue;\n\t\t\t} \n            s = lower_bound(z+1, z+z[0]+1, s)-z;\n            out(query(x, y, s)),\n            putchar(10);\n        }\n        else {\n            in(x);\n            change(x);\n        }\n    }\n}\n```",
        "postTime": 1546005747,
        "uid": 66965,
        "name": "Juan_feng",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "\u8d81\u7740\u6bd4\u8d5b\u521a\u7ed3\u675f\u8d76\u7d27\u4ea4\u4e00\u7bc7\u9898\u89e3\u3002\n\n\u5176\u5b9e\u5c31\u7ef4\u62a4\u6bcf\u4e2a\u6570\u5b57\u51fa\u73b0\u7684\u4f4d\u7f6e\u5c31\u53ef\u4ee5\u4e86\uff0c\u7528vector\u5b58\uff0c1\u64cd\u4f5c\u5c31\u8f93\u51fa\u5c3e\u4f4d\u7f6e\u5728\u6570\u5b57\u51fa\u73b0\u4f4d\u7f6e\u7684\u4f4d\u7f6e\u51cf\u53bb\u9996\u4f4d\u7f6e\u7684\u5c31\u53ef\u4ee5\u4e86\u3002\u81f3\u4e8e2\u64cd\u4f5c\uff0c\u5148\u5224\u65ad2\u4e2a\u4f4d\u7f6e\u4e0a\u7684\u6570\u5b57\u662f\u5426\u76f8\u7b49\uff0c\u76f8\u7b49\u5c31\u8df3\u8fc7\uff0c\u4e0d\u7136\u5c31\u76f4\u63a5swap\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define For(i,a,b) for(i=(a);i<=(b);++i)\n#define Forward(i,a,b) for(i=(a);i>=(b);--i)\nusing namespace std;\ntemplate<typename T>inline void read(T &x)//\u5feb\u8bfb\n{\n    T s=0,f=1;char k=getchar();\n    while(!isdigit(k)&&(k^'-'))k=getchar();\n    if(!isdigit(k)){f=-1;k=getchar();}\n    while(isdigit(k)){s=s*10+(k^48);k=getchar();}\n    x=s*f;\n}\nchar r[20];\nvoid write(int z)//\u5feb\u8f93\n{\n    int len=0;\n    if(!z)\n    {\n        putchar(48);\n        putchar('\\n');\n        return;\n    }\n    for(;z;z/=10)r[++len]=z%10;\n    while(len)putchar(r[len--]+48);\n    putchar('\\n');\n}\nvoid file()\n{\n    #ifndef ONLINE_JUDGE\n    freopen(\"color.in\",\"r\",stdin);\n    freopen(\"color.out\",\"w\",stdout);\n    #endif\n}\nconst int MAXN=300010;\nconst int inf=0xFFFFFFF;\nvector<int>R[MAXN];\nint a[MAXN],e,n,m;\nvoid init()\n{\n    int i;\n    read(n);read(m);\n    For(i,1,n)\n    {\n        read(a[i]);\n        R[a[i]].push_back(i);//vector\u5b58\u51fa\u73b0\u4f4d\u7f6e\n    }\n    For(i,1,300000)R[i].push_back(inf);\n}\nvoid solve()\n{\n    int opt,l,r,x;\n    while(m--)\n    {\n        read(opt);\n        if(opt==1)\n        {\n            read(l);read(r);read(x);\n            write(distance(lower_bound(R[x].begin(),R[x].end(),l)//\u6c42\u4f4d\u7f6e\uff0cl\u3001r\u7528\u4e8c\u5206\u6c42\n            ,upper_bound(R[x].begin(),R[x].end(),r)));\n        }\n        else\n        {\n            read(x);\n            if(a[x]==a[x+1])continue;//\u76f8\u7b49\u5c31\u4e0d\u6362\n            int u=distance(R[a[x]].begin()\n                ,lower_bound(R[a[x]].begin(),R[a[x]].end(),x)),\n                v=distance(R[a[x+1]].begin()\n                ,lower_bound(R[a[x+1]].begin(),R[a[x+1]].end(),x+1));//\u5426\u5219\u5c31\u76f4\u63a5\u6362\n            R[a[x]][u]=x+1;\n            R[a[x+1]][v]=x;\n            swap(a[x],a[x+1]);\n        }\n    }\n}\nint main()\n{\n    file();\n    init();\n    solve();\n    return 0;\n}\n\n```",
        "postTime": 1509546259,
        "uid": 7035,
        "name": "Great_Influence",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u770b\u4f3c\u5f88\u96be~~\u7ebf\u6bb5\u6811\u548c\u4e3b\u5e2d\u6811\u7684\u6807\u7b7e\u8ba9\u5305\u62ec\u6211\u5728\u5185\u7684\u849f\u84bb\u745f\u745f\u53d1\u6296~~\uff0c\u5176\u5b9e\u5f88\u7b80\u5355  \n\u9898\u76ee\u5927\u610f\u5c31\u662f\u7ed9\u4f60\u4e00\u4e2a\u6570\u5217\uff0c\u6709\u4e24\u79cd\u64cd\u4f5c\uff0c\u4e00\u4e2a\u662f\u7edf\u8ba1\u4e00\u4e2a\u533a\u95f4\u5185\u67d0\u6570\u51fa\u73b0\u7684\u6b21\u6570\uff0c\u53e6\u4e00\u4e2a\u662f\u4ea4\u6362\u76f8\u90bb\u4e24\u6570\u7684\u4f4d\u7f6e  \n\u7528vector\u5b58\u989c\u8272\u51fa\u73b0\u7684\u4f4d\u7f6e  \n\u4f7f\u7528lower_bound\u548cupper_bound~~\u6bd4\u7ebf\u6027\u8fd8\u597d\u5199\u7684~~\u4e8c\u5206\u67e5\u627e\u533a\u95f4\u5185\u76ee\u6807\u989c\u8272\u7b2c\u4e00\u6b21\u548c\u6700\u540e\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u5e76\u5c06\u5b83\u4eec\u5728vector\u4e2d\u7684\u4f4d\u7f6e\u76f8\u51cf\u5f97\u5230\u7684\u7ed3\u679c\u52a01\u5c31\u662f\u7b54\u6848  \n\u4ea4\u6362\u66f4\u7b80\u5355\uff0c\u4ea4\u6362\u524d\u540e\u5176\u5b9e\u4f4d\u7f6e\u53ea+1\u6216-1\uff0c\u627e\u5230\u5728vector\u4e2d\u7684\u4f4d\u7f6e\u64cd\u4f5c\u5373\u53ef  \nlower_bound(\u8d77\u59cb\u4f4d\u7f6e\u5730\u5740\uff0c\u7ec8\u6b62\u4f4d\u7f6e\u5730\u5740\uff08\u4e0d\u5305\u62ec\uff09\uff0c\u57fa\u51c6\u503c\uff09\u53ef\u4ee5\u627e\u8303\u56f4\u5185\u7b2c\u4e00\u4e2a\u57fa\u51c6\u503c  \nupper_bound\u683c\u5f0f\u76f8\u540c\uff0c\u627e\u6700\u540e\u4e00\u4e2a\u57fa\u51c6\u503c  \n\u539f\u8c05\u6211\u4ee3\u7801\u6bd4\u8f83\u5bbd~~\u53ef\u6211\u771f\u7684\u4e0d\u60f3\u5f00\u65b0\u53d8\u91cf\u4e86QwQ~~  \n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nvector<int> rab[300005];\nint main()\n{\n\tint n,m,cz;\n\tscanf(\"%d%d\",&n,&m);\n\tint color[n+1];\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&color[i]);\n\t\trab[color[i]].push_back(i);\n\t}\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tscanf(\"%d\",&cz);\n\t\tif(cz==1)\n\t\t{\n\t\t\tint a,b,c;\n\t\t\tscanf(\"%d%d%d\",&a,&b,&c);\n\t\t\tprintf(\"%d\\n\",max(0,int(upper_bound(rab[c].begin(),rab[c].end(),b)-lower_bound(rab[c].begin(),rab[c].end(),a))));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint x;\n\t\t\tscanf(\"%d\",&x);\n\t\t\tif(color[x]==color[x+1])\n\t\t\t\tcontinue;\n\t\t\trab[color[x]][lower_bound(rab[color[x]].begin(),rab[color[x]].end(),x)-rab[color[x]].begin()]++;\n\t\t\trab[color[x+1]][lower_bound(rab[color[x+1]].begin(),rab[color[x+1]].end(),x+1)-rab[color[x+1]].begin()]--;\n\t\t\tswap(color[x],color[x+1]);\n\t\t}\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1570022487,
        "uid": 182525,
        "name": "yangyujia18",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "\u8fd9\u9898\u53ef\u4ee5\u8bf4\u662f\u975e\u5e38\u6709\u610f\u601d\u4e86\uff0c\u4e00\u770b\u7b2c\u4e00\u4e2a\u64cd\u4f5c\u662f\u533a\u95f4\u6c42\u6743\u503c\u51fa\u73b0\u6b21\u6570\uff0c\u5f88\u81ea\u7136\u7684\u60f3\u5230\u4e86\u4e3b\u5e2d\u6811\uff0c\u7136\u540e\u53d1\u73b0\u7b2c\u4e8c\u6b21\u64cd\u4f5c\uff08\u4ea4\u6362\u4e24\u4e2a\u6570\uff09\u6bcf\u6b21\u53ea\u4f1a\u5f71\u54cd\u4e00\u4e2a\u524d\u7f00\u7684\u503c\uff0c\u7136\u540e\u5c31\u53ea\u9700\u8981\u4e00\u4e2a\u4e3b\u5e2d\u6811\u5355\u70b9\u4fee\u6539\u4e86\uff0c\u7136\u540e\u81ea\u5df1YY\u4e86\u4e00\u4e2a\u4e3b\u5e2d\u6811\u5355\u70b9\u4fee\u6539\uff08\u7c7b\u4f3c\u4e8e\u4e00\u5f00\u59cb\u5efa\u6811\uff0c\u6bcf\u4e00\u6b21\u4fee\u6539\u4e00\u4e2a\u70b9\u7684\u503c\u5c31\u65b0\u5efalogn\u4e2a\u8282\u70b9\uff0c\u7136\u540e\u4ece\u539f\u6765\u7684\u70b9\u7ee7\u627f\uff09\u65f6\u95f4\u590d\u6742\u5ea6O(nlogn)\uff0c\u7136\u540e\u7a7a\u95f4\u590d\u6742\u5ea6\u6bcf\u4e00\u6b21 2\u64cd\u4f5c\u5c31\u52a0logn\u4e2a\u8282\u70b9\u3002\n\n\u7136\u540e\u5199\u5b8c\u4ea4\u4e86\u51e0\u53d1\u53d1\u73b0\u88ab\u5361\u5e38\u4e86\u6570\u7ec4\u8fd8\u5f00\u5c0f\u4e86\n\n\u5ba1\u6838\u7684\u7ba1\u7406\u5458\u8bf4\u6211\u4e0d\u591f\u8be6\u7ec6\uff0c\u73b0\u5728\u591f\u8be6\u7ec6\u4e86\u5427\uff01\uff01\n\nnoip rp++\n\n\n----------------------------------------------------------------------\u5206\u5272\u7ebf----------------------------------------------------------------------\n\n\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<math.h>\n#include<string.h>\n#include<fstream>\nusing namespace std;\n//ifstream fin(\"color2.in\");\n//ofstream fout(\"color2.out\");\ninline int read(){\n    int X=0,w=1;char ch=0;\n    while(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n    while(ch>='0'&&ch<='9')X=(X<<3)+(X<<1)+ch-'0',ch=getchar();\n    return X*w;\n}\ninline void write(int x){\n    if(x<0) putchar('-'),x=-x;\n    if(x>9) write(x/10);\n    putchar(x%10+'0');\n}\nint n,m,tot;\nint rt[20000000],ls[20000000],rs[20000000],sum[20000000];\nint rk[500003];\nvoid update(int x,int &y,int l,int r,int val,int xx){\n    y=++tot;\n    ls[y]=ls[x],rs[y]=rs[x];\n    sum[y]=sum[x]+xx;\n    if(l==r) return;\n    int mid=(l+r)>>1;\n    if(val<=mid)update(ls[x],ls[y],l,mid,val,xx);\n    else update(rs[x],rs[y],mid+1,r,val,xx);\n}\nint query(int x,int y,int l,int r,int val){\n    if(l==r) return sum[y]-sum[x];\n    int mid=(l+r)>>1;\n    if(val<=mid) return query(ls[x],ls[y],l,mid,val);\n    else return query(rs[x],rs[y],mid+1,r,val);\n}\nint main(){\n    n=read(),m=read();\n    for(int i=1;i<=n;i++){\n        update(rt[i-1],rt[i],1,300000,rk[i]=read(),1);\n    }\n    int opt,l,r,k;\n    for(int i=1;i<=m;i++){\n        if(read()==1){\n            l=read(),r=read(),k=read();\n            write(query(rt[l-1],rt[r],1,300000,k));\n            puts(\"\");\n        }else{\n            k=read();\n            update(rt[k],rt[k],1,300000,rk[k],-1);\n            update(rt[k],rt[k],1,300000,rk[k+1],1);\n            swap(rk[k],rk[k+1]);\n        }\n    }\n    return 0;\n}\n```\n/\\*\n\nin: 6 5 1 2 3 2 3 3\n\n\n1 1 3 2\n\n\n1 4 6 3\n\n\n2 3 1 1 3 2\n\n\n1 4 6 3\n\n\nout: 1 2 2 3\n\n\n\\*/",
        "postTime": 1509665307,
        "uid": 33738,
        "name": "mengdai",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "\u9996\u5148\u8981\u5938\u8d5e\u4e00\u6ce2\u51fa\u9898\u4eba\uff0c\u8fd9\u6b21\u7684NOIP\u6a21\u62df\u8d5b\u662f\u6211\u5230\u8fc7\u7684\u6700\u597d\u7684\u6a21\u62df\u8d5b\u4e86\uff0c\u51fa\u9898\u975e\u5e38\u8ba4\u771f\uff0c\u9898\u76ee\u6784\u9020\u5341\u5206\u7cbe\u5999\uff0c \u6570\u636e\u70b9\u7684\u8bbe\u8ba1\u5f88\u6709\u8054\u8d5b\u7684\u7cbe\u795e\uff0c\u7ed9\u51fa\u9898\u4eba\u70b9\u8d5e\u3002\n\n\nD1T2 \u662f\u4e00\u9053\u770b\u4f3c\u50cf\u6781\u4e86\u6570\u636e\u7ed3\u6784\uff0c\u7136\u800c\u662f\u4e00\u9053\u7528\u4e8c\u5206\u67e5\u627e\u548c\u9898\u76ee\u6027\u8d28\u6765\u89e3\u51b3\u7684\u9898\u76ee\uff0c\u601d\u7ef4\u542b\u91cf\u6bd4\u8f83\u9ad8\u3002\n\n\u9898\u76ee\u8981\u6c42\u6211\u4eec\u652f\u6301\u4e24\u79cd\u64cd\u4f5c\uff0c\u67e5\u8be2\u533a\u95f4\u5185\u67d0\u4e00\u5143\u7d20\u7684\u6570\u76ee\uff0c\u4ee5\u53ca\u4ea4\u6362\u67d0\u4e24\u4e2a\u76f8\u90bb\u7684\u5143\u7d20\u3002\n\n\n\u8fd9\u9053\u9898\u76ee\u548c\u4f20\u7edf\u7ebf\u6bb5\u6811\u9898\u7684\u6700\u5927\u533a\u522b\u5c31\u5728\u4e8e\u9898\u76ee\u8981\u6c42\u7684\u4fee\u6539\u64cd\u4f5c\uff0c\u4ec5\u4ec5\u6d89\u53ca\u76f8\u90bb\u5143\u7d20\uff0c\u8fd9\u4f7f\u5f97\u4efb\u610f\u7684\u4fee\u6539\uff0c\u90fd\u4e0d\u4f1a\u6539\u53d8\u540c\u4e00\u4e2a\u989c\u8272\u7684\u5143\u7d20\u4e4b\u95f4\u7684\u76f8\u5bf9\u4f4d\u7f6e\uff0c\u6211\u4eec\u8003\u8651\u7528 vector \u6765**\u6309\u987a\u5e8f**\uff08\u4e8b\u5b9e\u4e0a\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u523b\u610f\u5730\u7ef4\u62a4\u6bcf\u4e2a\u5411\u91cf\u5185\u7684\u6709\u5e8f\u6027\uff0c\u8fd9\u91cc\u7528\u5230\u4e86\u521a\u521a\u7684\u6027\u8d28\uff09\u5b58\u4e0b\u6bcf\u4e2a\u989c\u8272\u7684\u6bcf\u4e2a\u4f4d\u7f6e\u3002\n\n\n\u5bf9\u4e8e\u67e5\u8be2\u64cd\u4f5c\uff0c\u6211\u4eec\u5728\u88ab\u67e5\u8be2\u989c\u8272\u7684 vector \u5185\u6839\u636e\u8981\u6c42\u533a\u95f4\u7684 l, r \u8fdb\u884c\u4e8c\u5206\u67e5\u627e\uff0c log \u590d\u6742\u5ea6\u5f97\u5230\u5143\u7d20\u4e2a\u6570\u3002\n\n\u5bf9\u4e8e\u4fee\u6539\u64cd\u4f5c\uff0c\u5982\u679c\u8fd9\u4e24\u4e2a\u76f8\u90bb\u5143\u7d20\u989c\u8272\u76f8\u540c\uff0c\u5219\u4e0d\u5fc5\u64cd\u4f5c\uff0c\u5426\u5219\u6211\u4eec\u53ef\u4ee5\u5206\u522b\u5728\u5bf9\u5e94\u989c\u8272\u7684 vector \u91cc\u9762\u627e\u5230\u5b83\u7684\u4f4d\u7f6e\uff0c\u76f4\u63a5\u4ea4\u6362\u5c31\u53ef\u4ee5\u4e86\u3002\uff08\u8fd8\u662f\u521a\u521a\u7684\u6027\u8d28\uff09 \u590d\u6742\u5ea6\u4f9d\u7136\u662f log \u7684\n\n\n\u5bf9\u4e8e\u5b9e\u9645\u6570\u636e\u60c5\u51b5\uff0c\u6709\u4e00\u4e2a\u989c\u8272\u7684\u5154\u5b50\u53ef\u80fd\u4e0d\u4f1a\u5f88\u591a\uff0c\u6211\u4eec\u91c7\u7528 stl \u4e3a\u6211\u4eec\u63d0\u4f9b\u7684\u4e8c\u5206\u67e5\u627e\u51fd\u6570\u5c31\u53ef\u4ee5\u5f88\u4f18\u96c5\u7684\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6 m\\*logn \uff08\u6700\u574f\uff09\n\n\n**Code**\n\n\n\n\n\n        \n        \n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<vector>\n#include<cstring>\nusing namespace std;\n#define REP(i,a,b) for (int i = (a), i##_end = (b); i < i##_end; ++i)\n#define pb push_back\n#define ALL(x) (x.begin(), x.end())\nconst int N = 300000 + 5;\nint n, m, c[N];\nvector< vector<int> > v(N);\nint main() {\n    scanf(\"%d%d\",&n,&m);\n    REP(i,1,n+1) {\n        scanf(\"%d\",&c[i]);\n        v[c[i]].pb(i);\n    }\n    REP(i,0,m) {\n        int command, l, r, q;\n        scanf(\"%d\", &command);\n        if (command == 1) {\n            scanf(\"%d%d%d\",&l,&r,&q);\n            vector<int>::iterator low,up; // \u6ce8\u610f STL \u51fd\u6570\u4e2d lower & upper \u7684\u8fd4\u56de\u503c\u662f\u4e00\u4e2a\u8fed\u4ee3\u5668\n            low = lower_bound(v[q].begin(), v[q].end(), l);\n            up  = upper_bound(v[q].begin(), v[q].end(), r);\n            printf(\"%d\\n\", up - low);  \n        }\n        if (command == 2) {\n           scanf(\"%d\",&l);\n           if (c[l] != c[l + 1]) {\n               int c1 = c[l], c2 = c[l + 1];     \n               vector<int>::iterator lpos, rpos;  \n               lpos = lower_bound(v[c[l]].begin(), v[c[l]].end(), l);\n               rpos = lower_bound(v[c[l + 1]].begin(), v[c[l + 1]].end(), l + 1); \n               swap(v[c[l]][lpos - v[c[l]].begin()], v[c[l + 1]][rpos - v[c[l + 1]].begin()]);\n               c[l] = c2;\n               c[l + 1] = c1; // \u518d\u7ef4\u62a4\u4e00\u4e0b\u989c\u8272\u6570\u7ec4\n           }\n        }\n    }\n    return 0;\n}\n\n```",
        "postTime": 1509614630,
        "uid": 35575,
        "name": "\u4f55\u5353\u7136",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "STL\u5927\u6cd5\u597d\n\n\u5f00\u59cb\u624b\u5199\u4e8c\u5206\u67e5\u627eRE\u4e00\u4e2a\u70b9\uff0c\u6362STL\u5c31\u8fc7\u4e86...\n\n\u9996\u5148\u5c06\u6bcf\u79cd\u989c\u8272\u7684\u5154\u5b50\u7684\u4e0b\u6807\u5b58\u5230\u5404\u79cd\u989c\u8272\u7684\u6570\u7ec4\u4e2d\n\n\u6570\u7ec4\u4e2d\u4e0b\u6807\u4e00\u5b9a\u662f\u5355\u8c03\u9012\u589e\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u4e8c\u5206\u67e5\u627e\u4e0b\u6807\u6240\u5728\u4f4d\u7f6e\n\n\u4ea4\u6362\u53ea\u6709x\u548cx + 1\u4ea4\u6362\uff0c\u6613\u8bc1\u4ea4\u6362\u5b8c\u540e\u5404\u6570\u7ec4\u4e2d\u4e0b\u6807\u4ecd\u7136\u5355\u8c03\n\n\u5b58\u50a8\u7528vector\u5b58\uff0c\u4e0d\u7136\u4f1a\u7206\n\n\u4e3e\u4e2a\u6817\u5b50\uff08\u5982\u6837\u4f8b\uff09\uff1a\n\nb[1] = {1}                //\u7b2c\u4e00\u4e2a\u989c\u8272\u7684\u4e0b\u6807\uff08\u4eec\uff09\n\nb[2] = {2, 4}            //\u7b2c\u4e8c\u4e2a\u989c\u8272\u7684\u4e0b\u6807\u4eec\n\nb[3] = {3, 5, 6}        //\u7b2c\u4e09\u4e2a\u989c\u8272\u7684\u4e0b\u6807\u4eec\n\n\u7b2c\u4e00\u7ec4\u8be2\u95ee\uff1a1 1 3 2\n\n\u4e8c\u5206\u627e\u5230b[2]\u4e2d\u7b2c\u4e00\u4e2a\u5927\u4e8e\u7b49\u4e8e\u533a\u95f4\u5de6\u7aef\u70b9(1)\u7684\u4e0b\u6807\u5728\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e \uff1a 1\n\n\u4e8c\u5206\u627e\u5230b[2]\u4e2d\u7b2c\u4e00\u4e2a\u5c0f\u4e8e\u7b49\u4e8e\u533a\u95f4\u53f3\u7aef\u70b9(3)\u7684\u4e0b\u6807\u5728\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e \uff1a 1\n\n\u6240\u4ee5\u5728\u533a\u95f4[1, 1]\u4e2d\u6240\u6709\u503c\u90fd\u7b26\u5408\uff0c \u4e2a\u6570\u5373\u4e3a\u533a\u95f4\u957f\u5ea6\uff1a1 - 1 + 1 = 1\n\n...\n\u7b2c\u4e09\u7ec4\uff1a2 3\n\n\u8bbe\u7b2ci\u53ea\u5154\u5b50\u989c\u8272\u4e3aa[i]\n\n\u627e\u52303\u5728b[a[3]]\u4e2d\u7684\u4f4d\u7f6e\uff1a1\n\n\u627e\u52304\u5728b[a[4]]\u4e2d\u7684\u4f4d\u7f6e\uff1a2\n\nswap(b[a[3]][1], b[a[4]][2]);\n\nswap(a[3], a[4])\n\n...\n\u5c31\u597d\u5566\n\n\u9644\u4ee3\u7801\uff1a\n\n\n```cpp\n#include<cstdio>\n#include<vector>\n#include<algorithm>\nusing namespace std;\nconst int maxn = 300000 + 10;\nint a[maxn], c[maxn];\nvector<int> b[maxn];\nint rd()            //\u5feb\u8bfb; \n{\n    int num = 0;\n    char cc;\n    do\n    {\n        cc = getchar();\n    }while(cc > '9' || cc < '0');\n    while(cc <= '9' && cc >= '0')\n    {\n        num *= 10;\n        num += cc - '0';\n        cc = getchar();\n    }\n    return num;\n}\nint main()\n{\n    int n, m;\n    scanf(\"%d%d\", &n, &m);\n    for(int i = 1; i <= n; i ++)\n    {\n        b[i].push_back(0);            //\u4e8c\u5206\u67e5\u627e\u4e0b\u754c; \n    }\n    for(int i = 1; i <= n; i ++)\n    {\n        a[i] = rd();\n        c[a[i]] ++;\n        b[a[i]].push_back(i);        //\u4fdd\u5b58\u6bcf\u4e00\u79cd\u989c\u8272\u7684\u5154\u5b50\u5bf9\u5e94\u7684\u4e0b\u6807\u4eec; \n    }\n    for(int i = 1; i <= n; i ++)\n    {\n        c[i] ++;\n        b[i].push_back(n + 1);        //\u4e8c\u5206\u67e5\u627e\u4e0a\u754c; \n    }\n    for(int i = 1, cz, l, r, tmp1, tmp2, tmp3, tmp4, clr; i <= m; i ++)\n    {\n        cz = rd();\n        if(cz == 1)\n        {\n            l = rd(), r = rd(), clr = rd();\n            tmp1 = lower_bound(b[clr].begin(), b[clr].end(), l) - b[clr].begin();\n                //\u627e\u5230\u7b2c\u4e00\u4e2a\u5927\u4e8e\u7b49\u4e8e\u533a\u95f4\u5de6\u7aef\u70b9\u7684\u4e0b\u6807\u5728\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\n                //(\u5373\u5728\u533a\u95f4\u5185\u989c\u8272\u4e3aclr\u7684\u4e0b\u6807\u6700\u5c0f\u7684\u5154\u5b50); \n            tmp2 = upper_bound(b[clr].begin(), b[clr].end(), r) - b[clr].begin() - 1;\n                //\u627e\u5230\u7b2c\u4e00\u4e2a\u5c0f\u4e8e\u7b49\u4e8e\u533a\u95f4\u53f3\u7aef\u70b9\u7684\u4e0b\u6807\u5728\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e \n                //(\u5373\u5728\u533a\u95f4\u5185\u989c\u8272\u4e3aclr\u7684\u4e0b\u6807\u6700\u5927\u7684\u5154\u5b50); \n            printf(\"%d\\n\", tmp2 - tmp1 + 1);    //\u663e\u7136; \n        }\n        else\n        {\n            cz = rd();    //\u61d2\u7684\u5b9a\u4e49\u65b0\u53d8\u91cf\u4e86...\u5373\u9898\u4e2d\u6240\u7ed9x; \n            tmp1 = a[cz];\n            tmp2 = a[cz + 1];\n            if(tmp1 == tmp2) continue;\n            tmp3 = lower_bound(b[tmp1].begin(), b[tmp1].end(), cz) - b[tmp1].begin();\n                //\u627e\u5230\u7b2c\u4e00\u4e2a\u5927\u4e8e\u7b49\u4e8ex\u7684\u4e0b\u6807\u5728\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e,\u56e0\u4e3a\u6570\u7ec4\u4e2d\u4e00\u5b9a\u6709x,\n                //\u6240\u4ee5tmp3\u5373\u4e3ax\u6240\u5728\u4f4d\u7f6e;\n            tmp4 = lower_bound(b[tmp2].begin(), b[tmp2].end(), cz + 1) - b[tmp2].begin();    \n                //tmp4\u4e3ax\u6240\u5728\u4f4d\u7f6e(\u540c\u4e0a);\n            swap(b[tmp1][tmp3], b[tmp2][tmp4]);        //\u4ea4\u6362\u4f4d\u7f6e; \n            swap(a[cz], a[cz + 1]);\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1509607087,
        "uid": 31083,
        "name": "kevintek",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "**\u4e8c\u5206\u4e0a\u4e0b\u754c**\n\n**\u76f8\u51cf\u5c31\u662f\u4e2a\u6570**\n\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<vector>\n#include<cstdlib>\n#define maxn 500003\nusing namespace std;\nint n,m;\nvector<int>G[maxn];\nint a[maxn];\nint query(int l,int r,int z)\n{\n    int t1=lower_bound(G[z].begin(),G[z].end(),l)-G[z].begin();  //\u4e8c\u5206\u627e\u5230\u5f53\u524d\u989c\u8272<=l\u7684\u6700\u53f3\u7684\u4f4d\u7f6e \n    int t2=upper_bound(G[z].begin(),G[z].end(),r)-G[z].begin();  //\u4e8c\u5206\u627e\u5230\u5f53\u524d\u989c\u8272>r\u7684\u6700\u5de6\u7684\u4f4d\u7f6e \uff08\u7531\u4e8e\u662f\u6307\u9488\uff0c\u6240\u4ee5\u51cfG[z].begin()\u8fd4\u56de\u4e0b\u6807\uff09 \n    return t2-t1;   //\u4e0b\u6807\u76f8\u51cf\u5c31\u662f\u4e2a\u6570 \n}\nint change(int x)\n{\n    int t1=lower_bound(G[a[x]].begin(),G[a[x]].end(),x)-G[a[x]].begin();  //\u627e\u5230\u5f53\u524d\u989c\u8272\u7684\u4e0b\u6807 \n    int t2=lower_bound(G[a[x+1]].begin(),G[a[x+1]].end(),x+1)-G[a[x+1]].begin();  //\u627e\u5230\u76f8\u90bb\u989c\u8272\u7684\u4e0b\u6807 \n    G[a[x]][t1]++; //\u4ea4\u6362\u4e0b\u6807 \n    G[a[x+1]][t2]--;\n    swap(a[x],a[x+1]);//\u4ea4\u6362\u989c\u8272 \n}\nint main()\n{\n    cin>>n>>m;\n    for(int i=1;i<=n;i++)scanf(\"%d\",&a[i]),G[a[i]].push_back(i);\n    for(int i=1;i<=m;i++)\n    {\n        int k;\n        scanf(\"%d\",&k);\n        if(k==1)\n        {\n            int x,y,z;\n            scanf(\"%d%d%d\",&x,&y,&z);\n            int k=query(x,y,z);\n            printf(\"%d\\n\",k);\n        }\n        if(k==2)\n        {\n            int z;\n            scanf(\"%d\",&z); \n            if(a[z]!=a[z+1]) change(z);  //\u989c\u8272\u76f8\u540c\u4ea4\u6362\u548c\u4e0d\u4ea4\u6362\u4e00\u6837\uff0c\u6240\u4ee5\u5c31\u4e0d\u4ea4\u6362\u4e86 \n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1509594531,
        "uid": 18441,
        "name": "Drug__Lover",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "\u8fd9\u9898\u6709\u70b9\u65e5\u672c\u9898\uff08\u8111\u888b\u8981\u8f6c\u7684\u8fc7\u5f2f\uff0c\u4ee3\u7801\u5e76\u4e0d\u590d\u6742\uff09\u7684\u5473\u9053\uff0c\u975e\u5e38\u9002\u5408\u5b66\u6570\u636e\u7ed3\u6784\u5b66\u50bb\u6389\u7684\u4eba\u3002\n\n\u6309\u989c\u8272\u6392\u5e8f\u540e\uff0c\u5bf9\u4e8e\u6bcf\u6b21\u67e5\u8be2$l_j, r_j, c_j$\uff0c\u5728\u989c\u8272$c_j$\u6bb5\uff08\u5df2\u7ecf\u6309\u989c\u8272\u6392\u5e8f\u4e86\u5594\uff09\u91cc\u4e8c\u5206\u67e5\u627e\u5c31\u597d\u4e86\u3002\n\n**\u5341\u4e2a\uff08\u624b\u6253\uff09\u4e8c\u5206\u4e5d\u4e2a\u9519**\uff0c\u6bd4\u8f83\u901a\u7528\u7684\u5199\u6cd5\u662f\u6c42$\\max$\u65f6\uff0c$mid$\u5411\u4e0a\u53d6\u6574\uff0c\u6c42$\\min$\u65f6\uff0c$mid$\u5411\u4e0b\u53d6\u6574\u3002\uff08\u5982\u679c\u4f60\u7528```lower\\_bound```\u548c```upper\\_bound```\u5f53\u6211\u6ca1\u8bf4\uff09\n\u624b\u6253\u4e8c\u5206\u7684\u5065\u58ee\u6027\u5f88\u7cdf\u7cd5\uff08```lower\\_bound```\u548c```upper\\_bound```\u600e\u4e48\u6837\u6211\u4e0d\u6e05\u695a\uff09\u3002\u56e0\u6b64\uff0c\u53e6\u5916\u9700\u8981\u7279\u5224\u7684\u60c5\u51b5\u5305\u62ec\uff1a\u539f\u5e8f\u5217\u4e2d\u4e0d\u5305\u542b\u67e5\u8be2\u7684\u989c\u8272\uff08\u8fd9\u4e2a\u4f3c\u4e4e\u4f1a\u536150\u5206\uff1f\uff09\uff1b\u4ea4\u6362\u7684\u5154\u5b50\u989c\u8272\u76f8\u540c\uff08\u8fd9\u4e2a\u4f3c\u4e4e\u4f1a\u536120\u5206\uff1f\uff09\u3002\n\n```cpp\n#include <cstdio>\n#include <algorithm>\nusing std::sort;\nusing std::swap;\nconst int MAXN = 3e5 + 1;\nint readint() {\n  char ch;\n  while ( (ch = getchar()) < 48 || ch > 57 );\n  int x = 0;\n  do {\n    x = (x << 3) + (x << 1) + ch - 48;\n  } while ( (ch = getchar()) >= 48 || ch >= 57 );\n  return x;\n}\nstruct rabbit {\n  int id, color;\n  rabbit(){}\n  rabbit(int init\\_id, int init\\_color):\n    id(init\\_id), color(init\\_color) {}\n  friend bool operator < (const rabbit &r1, const rabbit &r2) {\n    return r1.color == r2.color ? r1.id < r2.id : r1.color < r2.color;\n  }\n}a[MAXN]; \nstruct block {\n  int begin, end;\n  block(): begin(-1), end(-1) {}\n}b[MAXN]; //b[i]: \u989c\u8272i\u7684\u5154\u5b50\u5728\u6392\u5e8f\u540e\u7684\u6570\u7ec4\u4e2d\u7684\u4e0b\u6807\u6bb5 \n\n//\u6c42    M I N    x\n//  key<=a[x].id\nint BS1(int lb, int rb, int key) {\n  int m, l = lb, r = rb;\n  while (l < r) {\n    m = (l + r) >> 1;\n    if (a[m].id < key)\n      l = m + 1;\n    else\n      r = m;\n  }\n  return l;\n}\n//\u6c42    M A X    x\n//  a[x].id<=key\nint BS2(int lb, int rb, int key) {\n  int m, l = lb, r = rb;\n  while (l < r) {\n    m = (l + r + 1) >> 1;\n    if (a[m].id <= key)\n      l = m;\n    else\n      r = m - 1;\n  }\n  return l;\n}\nint rank[MAXN]; //\u6392\u5e8f\u540e\u539f\u672c\u7684\u7b2ci\u53ea\u5154\u5b50\u73b0\u5728\u7684\u4e0b\u6807 \nint main() {\n  int n = readint(), m = readint();\n  for (int i = 0; i < n; i++)\n    a[i] = rabbit(i, readint());\n  sort(a, a + n);\n  for (int i = 0, cur\\_color; i < n; ) {\n    cur\\_color = a[i].color;\n    b[cur\\_color].begin = i;\n    for (; i < n && a[i].color == cur\\_color; i++);\n    b[cur\\_color].end = i - 1;\n  }\n  for (int i = 0; i < n; i++)\n    rank[a[i].id] = i;\n  for (int i = 0, lb, rb, key; i < m; i++) {\n    if (readint() == 1) {\n      lb = readint() - 1; rb = readint() - 1; key = readint();\n      if (b[key].begin == -1 || lb > a[b[key].end].id || rb < a[b[key].begin].id) {\n        printf(\"0\\n\");\n        continue;\n      }\n      printf(\"%d\\n\", BS2(b[key].begin, b[key].end, rb) -\n                     BS1(b[key].begin, b[key].end, lb) + 1);\n    } else {\n      key = readint() - 1;\n      if (a[rank[key]].color == a[rank[key + 1]].color)\n        continue;\n      swap(a[rank[key]].id, a[rank[key + 1]].id);\n      swap(rank[key], rank[key + 1]);\n    }\n  }\n  return 0;\n}\n```",
        "postTime": 1509585879,
        "uid": 30361,
        "name": "liangjialin",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "/\\*\n\u597d\u96be\u53d7...\u6bd4\u8d5b\u65f6\u628aputchar(10);\u6253\u6210putchar(32);\n\n\u6211WA\u5f97\u4e00\u58f0\u5c31\u54ed\u4e86\u51fa\u6765\n\n\u8fd9\u9053\u9898\u8fd8\u662f\u5f88\u6c34\u7684\n\n\u7528vector\u52a0\u4e8c\u5206\u67e5\u627e\u66b4\u529b\u5b58\u53d6\u5c31\u597d\n\n\u4e0d\u8981\u7528\u7ebf\u6bb5\u6811\n\n\u4e0d\u7136\u4f60\u5f97\u5f00\u4e09\u5341\u4e07\u68f5\u7ebf\u6bb5\u6811\n\n\\*/\n```cpp\n#include<iomanip>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<cstdlib>\n#include<ctime>\n#include<algorithm>\n#include<bitset>\n#include<vector>\nusing namespace std;\ninline int intin(){register char c=getchar();while(c<48||c>57)c=getchar();register int a=0;while(c>47&&c<58){a=(a<<1)+(a<<3)+c-48;c=getchar();}return a;}\ninline void intot(int a){if(a<0){putchar(45);a*=(-1);}if(a>9)intot(a/10);putchar(a%10+48);}\ninline void cmm(int &a,int &b){a^=b;b^=a;a^=b;}//\u4ea4\u6362 \nvector <int> rbq[321000];//rbq[i]\u8bb0\u5f55\u7684\u662fi\u7684\u5404\u4f4d\u7f6e \nint gc[321000];//\u539f\u6570\u7ec4 \nint main()\n{\n//    freopen(\"cpp.in\",\"r\",stdin);freopen(\"cpp.out\",\"w\",stdout);\n    int n=intin(),q=intin();\n    for(int i=1;i<=n;i++)\n    {\n        gc[i]=intin();\n        rbq[gc[i]].push_back(i);\n    }\n    while(q--)\n    {\n        if(intin()&1)//\u67e5\u8be2\u64cd\u4f5c \n        {\n            int l=intin(),r=intin(),wyf=intin();\n            int a=0,b=rbq[wyf].size();\n            int d=b;\n            while(b-a)//\u4e8c\u5206\u67e5\u627eL \n            {\n                int mmp=(b+a)/2;\n                if(rbq[wyf][mmp]>=l)\n                {\n                    b=mmp;\n                }\n                else\n                {\n                    a=mmp+1;\n                }\n            }\n            int c=a;\n            while(d-c)//\u4e8c\u5206\u67e5\u627eR \n            {\n                int mmp=(c+d)/2;\n                if(rbq[wyf][mmp]<=r)\n                {\n                    c=mmp+1;\n                }\n                else\n                {\n                    d=mmp;\n                }\n            }\n            intot(c-a);putchar(10);//LR\u4e0b\u6807\u5dee\u5373\u4e3a\u8be5\u533a\u95f4\u5185\u51fa\u73b0\u6b21\u6570 \n        }\n        else\n        {\n            int wyf=intin();\n            int a=0,d=gc[wyf];\n            int b=rbq[d].size();\n            while(b-a)//\u4e8c\u5206\u67e5\u627e\u9700\u4fee\u6539\u7684\u6570 \n            {\n                int mmp=(b+a)/2;\n                if(rbq[d][mmp]>=wyf)\n                {\n                    b=mmp;\n                }\n                else\n                {\n                    a=mmp+1;\n                }\n            }\n            rbq[d][a]++;\n            a=0;\n            wyf++;\n            d=gc[wyf];\n            b=rbq[d].size();\n            while(b-a)//\u4e8c\u5206\u67e5\u627e\u9700\u4fee\u6539\u7684\u6570 \n            {\n                int mmp=(b+a)/2;\n                if(rbq[d][mmp]>=wyf)\n                {\n                    b=mmp;\n                }\n                else\n                {\n                    a=mmp+1;\n                }\n            }\n            rbq[d][a]--;\n            cmm(gc[wyf],gc[wyf-1]);//\u6700\u540e\u522b\u5fd8\u4e86\u5728\u539f\u6570\u7ec4\u4ea4\u6362\u4e24\u6570 \n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1509583682,
        "uid": 31890,
        "name": "\u516b\u91cd\u6a31",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "##\u672c\u4ee5\u4e3a\u8fd9\u9053\u9898\u4f1a\u662f\u9897\u6811~~\u4e3b\u5e2d\u6811~~\n\n\n#\u7136\u800c\u4ed4\u7ec6\u4e00\u60f3\u662f\u79bb\u6563\u5316+\u4e8c\u5206\n\n\n\u6211\u7684\u601d\u8def\u662f\u5148\u628a\u989c\u8272\u5f04\u5230\u4e00\u5757\u4f46\u539f\u672c\u7684\u987a\u5e8f\u8fd8\u8981\u7559\u7740\uff0c\u67e5\u8be2\u7684\u65f6\u5019\u5c31\u4e8c\u5206\u5de6\u53f3\u533a\u95f4\uff0c\u518d\u4e0b\u6807\u52a0\u52a0\u51cf\u51cf\u5f97\u5230\u8fd9\u4e2a\u8303\u56f4\u5185\u7684\u4e2a\u6570\u3002\u4fee\u6539\u7684\u8bdd\u5c06\u4e0b\u6807\u4e3ax\u7684\u53d8\u4e3ax+1\uff0cx+1\u7684\u53d8\u4e3ax\u5c31\u884c\u4e86\uff0c\u4e8c\u5206\u4f18\u5316\u4e00\u4e0b\u5c31ok\u4e86\u3002\n\nps\uff1a\u5343\u4e07\u522b\u5fd8\u8bb0\u6362\u989c\u8272\uff01\uff01\u867d\u7136\u53ea\u4fee\u6539\u4e00\u6b21\u7684\u8bdd\u6ca1\u5565\u5f71\u54cd\uff0c\u4f46\u8981\u662f\u4fee\u6539\u591a\u6b21\u8fd8\u6709\u4ea4\u96c6\u5c31GG\u4e86\u3002\n\n~~\uff08\u4e00\u5f00\u59cb\u60f3\u591a\u4e86\u7528\u7684\u4e8c\u5206+\u524d\u7f00\u548c\uff0c\u4fee\u6539\u7684\u65f6\u5019\u7528\u7684\u4e8c\u5206+\u524d\u7f00\u548c+\u67e5\u5206\uff09~~\n\n\n###\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=300001;\nint read(){//\u8bfb\u5165\u4f18\u5316  \u65e0\u8111\u5199\u7684 \n    int res=0;char ch=getchar();\n    while(!isdigit(ch)) ch=getchar();\n    while(isdigit(ch)) res=res*10+ch-'0',ch=getchar();\n    return res;\n}\nint n,m,temp[N];//temp\u662f\u5b58\u6700\u4e00\u5f00\u59cb\u7684\u987a\u5e8f \nstruct node{\n    int c,id;\n}a[N]; //\u5b58\u7684\u662f\u8fd9\u4e2a\u70b9\u7684\u989c\u8272\u548c\u7f16\u53f7 \u4e3a\u79bb\u6563\u5316\u505a\u51c6\u5907 \nstruct node2{//\u5176\u5b9e\u7528\u4e0a\u9762\u90a3\u4e2a\u5c31\u884c \u4e3a\u4e86\u5199\u9898\u89e3\u597d\u7406\u89e3\u4e9b\u6211\u5c31\u5206\u5f00\u4e86 \n    int l,r;\n}b[N];//\u5b58\u7684\u662f\u6bcf\u4e2a\u989c\u8272\u7684\u6700\u5de6\u548c\u6700\u53f3\u7684\u70b9\u5728\u7684a\u6570\u5b57\u4e2d\u7684\u4f4d\u7f6e \nbool cmp(node x,node y){\n    if(x.c==y.c) return x.id<y.id;\n    else return x.c<y.c;\n```\n}//\u7528\u5728\u6392\u5e8f\u548cSTL\u7684\u4e8c\u5206\u91cc\n```cpp\nint main(){\n    n=read();m=read();\n    for(int i=1;i<=n;i++){ //a\u5b58\u7684\u662f \n        a[i].c=read();\n        temp[i]=a[i].c;\n        a[i].id=i;\n    }\n    sort(a+1,a+1+n,cmp); //\u79bb\u6563\u5316 \u4e0e\u697c\u4e0bvector\u540c\u7406 \u628a\u989c\u8272\u5206\u51fa\u6765 \n    b[a[1].c].l=1;            //\u521d\u59cbb\u6570\u7ec4 \n    for(int i=2;i<=n;i++){\n        if(a[i].c!=a[i-1].c){\n            b[a[i-1].c].r=i-1;\n            b[a[i].c].l=i;\n        }\n    }\n    b[a[n].c].r=n;\n    int t1,t2,t3,t4;\n    while(m--){\n        t1=read();\n        if(t1==1){ //\u67e5\u8be2\u5c31\u662f\u5728\u8be5\u989c\u8272\u4e2d\u4e8c\u5206\u5de6\u53f3\u533a\u95f4 \n            t2=read();t3=read();t4=read();\n            int ll=b[t4].l,rr=b[t4].r;//\u9009\u53d6\u9700\u8981\u4e8c\u5206\u7684\u533a\u95f4 \n            int kl=lower_bound(a+ll,a+1+rr,node{t4,t2},cmp)-a; //\u627e\u5230\u7b2c\u4e00\u4e2a\u5927\u4e8e\u7b49\u4e8e\u7684 \n            int kr=upper_bound(a+ll,a+1+rr,node{t4,t3},cmp)-a; //\u627e\u5230\u7b2c\u4e00\u4e2a\u4e25\u683c\u5927\u4e8e\u7684 \n            kr--;    //\u518d\u51cf\u4e00\uff08\u8bd5\u51fa\u6765\u7684 \n            printf(\"%d\\n\",kr-kl+1); //\u8f93\u51fa\u4ed6\u4eec\u4e0b\u6807\u4e4b\u95f4\u7684\u957f\u5ea6\u5373\u4e3a\u6570\u91cf \n        }\n        if(t1==2){//\u4fee\u6539\u5c31\u662f\u5c06\u4e0b\u6807\u4e3ax\u7684++ x+1\u7684-- \n            t2=read();\n            t3=temp[t2];t4=temp[t2+1];\n            if(t3==t4) continue; //    \u7279\u5224\u4e00\u4e0b\u8fd9\u6837\u5c31\u4e0d\u7528\u6362\u4e86        \n            swap(temp[t2],temp[t2+1]);  //\uff01\uff01\uff01\u8003\u8bd5\u7684\u65f6\u5019\u5fd8\u6362\u989c\u8272\u4e8623333 \n            int k1=lower_bound(a+b[t3].l,a+1+b[t3].r,node{t3,t2},cmp)-a;//\u5bfb\u627ex\u7684\u5750\u6807 \n            int kr=lower_bound(a+b[t4].l,a+1+b[t4].r,node{t4,t2+1},cmp)-a;//\u5bfb\u627ex+1\u7684\u5750\u6807 \n            a[k1].id++;a[kr].id--;//\u5750\u6807\u66f4\u6539 \n        }\n    }\n    return 0; \n}\n\n```",
        "postTime": 1509579861,
        "uid": 27495,
        "name": "bymlg001",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    },
    {
        "content": "\\* \u7ef4\u62a4\u4e00\u4e2a b \u6570\u7ec4\uff0c\u91cc\u9762\u5b58\u7740\u6bcf\u4e2a\u70b9\u7684\u989c\u8272\uff08b[].c\uff09\u548c\u4f4d\u7f6e(b[].id)\uff0c\u7136\u540e\u6392\u597d\u5e8f\uff0c\n\n\\* \u4fee\u6539\u7684\u8bdd\u627e\u5230 X \u548c X+1 \u518d b \u4e2d\u7684\u4f4d\u7f6e\uff0c\u53ea\u9700\u4ea4\u6362\u5b83\u4fe9\u7684 id \u5373\u53ef\uff08\u56e0\u4e3a\u80af\u5b9a\u4e0d\u4f1a\u5f71\u54cd\u5230\u76f8\u540c\u989c\u8272\u95f4\u7684\u76f8\u5bf9\u5148\u540e\u987a\u5e8f\uff09\u3002\n\n\\* \u67e5\u8be2\u7684\u8bdd\u627e\u5230\u989c\u8272 C \u5728 b \u4e2d\u7684\u90a3\u6bb5\u8fde\u7eed\u533a\u95f4\uff0c\u518d\u4e8c\u5206 L,R \u80fd\u5728\u5176\u4e2d\u5305\u542b\u591a\u5c11\u5373\u53ef\u3002\n\n\\* \u6709\u4e9b\u5c0f\u7ec6\u8282\u53ef\u4ee5\u770b\u770b\u6ce8\u91ca\u3002\n\n```cpp\n#include <cstdio>\n#include <algorithm>\n#define N 400005\nusing namespace std;\nstruct zzk{int c,id;} b[N];\nbool cmp(zzk x,zzk y){        //\u628a\u76f8\u540c\u989c\u8272\u7684\u5806\u5728\u4e00\u8d77\uff08\u989c\u8272\u4e5f\u9012\u589e\uff09\uff0c\u7136\u540e\u76f8\u540c\u989c\u8272\u7684\u4e00\u5806\u4e2d\u7f16\u53f7\u9012\u589e\u4ee5\u4fbf\u4e8c\u5206 \n    if (x.c==y.c) return x.id<y.id;\n    return x.c<y.c;\n}\nint n,m,a[N];\n\nint ef_c(int c){    //\u4e8c\u5206 \u4e3a\u989c\u8272 c \u6700\u540e\u4e00\u4e2a\u4f4d\u7f6e \n    if (!c) return 0;\n    int l,r,mid,ret=0;\n    for (l=1,r=n; l<=r; ){\n        mid=l+r>>1;\n        if (b[mid].c<=c && b[mid-1].c<=c){ret=mid,l=mid+1; continue;}\n        r=mid-1;\n    }\n    return ret;\n}\n\nint ef_I(int l,int r,int I){    //id I \u5728\u533a\u95f4 [l,r] \u5728\u54ea\u91cc(\u5de6\u504f) \n    int mid,ret=l;\n    for (; l<=r; ){\n        mid=l+r>>1;\n        if (b[mid].id<=I){ret=mid,l=mid+1; continue;}\n        r=mid-1;\n    }\n    return ret;\n}\n\nvoid option_1(int L,int R,int C){    //\u8be2\u95ee [L,R] \u4e2d\u7684 C \n    int lc,rc,st,ed;\n    lc=ef_c(C-1)+1,rc=ef_c(C);        //\u989c\u8272C\u5728 b \u4e2d\u7684\u533a\u95f4 \n    st=ef_I(lc,rc,L),ed=ef_I(lc,rc,R);    //\u627e\u5230 L,R \u5728\u533a\u95f4\u5305\u4e86\u54ea\u4e9b\u6570 \n    if (b[st].id>=L && b[st].id<=R && b[st].c==C) st--;        //\u5904\u7406\u4e00\u4e0b\u7ec6\u8282 \n    printf(\"%d\\n\",ed-st);\n}\n\nvoid option_2(int X){    //\u4fee\u6539 X \n    int C1=a[X],C2=a[X+1],lc,rc,kk1,kk2;\n    lc=ef_c(C1-1)+1,rc=ef_c(C1),kk1=ef_I(lc,rc,X);        //\u627e\u5230 a[X] \u5728 b \u4e2d\u5bf9\u5e94\u4f4d\u7f6e \n    lc=ef_c(C2-1)+1,rc=ef_c(C2),kk2=ef_I(lc,rc,X+1);    //\u627e\u5230 a[X+1] \u5728 b \u4e2d\u5bf9\u5e94\u4f4d\u7f6e \n    swap(b[kk1].id,b[kk2].id);                            //\u4f4d\u7f6e\u4ea4\u6362 \n    swap(a[X],a[X+1]);\n}\n\nint main(){\n    //freopen(\"3.txt\",\"r\",stdin);\n    //freopen(\"2.txt\",\"w\",stdout);\n    scanf(\"%d%d\",&n,&m);\n    for (int i=1; i<=n; i++) scanf(\"%d\",&a[i]),b[i].id=i,b[i].c=a[i];\n    sort(b+1,b+n+1,cmp);\n    for (int k1,k2,k3,k; m--; ){\n        scanf(\"%d\",&k);\n        if (k==1 && scanf(\"%d%d%d\",&k1,&k2,&k3)){\n            option_1(k1,k2,k3);\n        }\n        if (k==2 && scanf(\"%d\",&k1)){\n            if (a[k1]==a[k1+1]) continue;\n            option_2(k1);\n        }\n    }\n}\n```",
        "postTime": 1509578471,
        "uid": 13284,
        "name": "piggy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3939 \u3010\u6570\u989c\u8272\u3011"
    }
]
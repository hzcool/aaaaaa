[
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a[Min_25 \u7b5b](https://oi-wiki.org/math/number-theory/min-25/)\n\n~~\u672c\u6765\u51c6\u5907\u628a\u5b83\u6254\u5230\u4e92\u6d4b\u8d5b T3 \u7684\u4f4d\u7f6e\uff0c\u4f46\u56e0\u4e3a\u6559\u7ec3\u8ba4\u4e3a\u96be\u5ea6\u8fc7\u5927\uff08\uff1f\uff1f\uff1f\uff09\u6ca1\u8fc7\u5ba1\u3002~~\n\n\u4e0d\u7ba1\u662f\u6570\u636e\u8303\u56f4\u8fd8\u662f\u6240\u6c42\u7684\u70b9\u503c\u5747\u4e3a\u6570\u8bba\u5206\u5757\u5904\u7684\u70b9\u503c\u90fd\u53ef\u4ee5\u63d0\u9192\u6211\u4eec\u53ef\u4ee5\u8003\u8651 Min_25 \u7b5b\u3002\u4f46\u6240\u6c42\u4e3a\u4e00\u4e2a\u548c\u6027\u51fd\u6570\uff0c\u4e0d\u65b9\u4fbf\u76f4\u63a5\u64cd\u4f5c\u3002\n\n\u4e0d\u7ba1\u600e\u4e48\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u50cf Min_25 \u7b5b Part 1 \u4e00\u6837\u9000\u800c\u6c42\u5176\u6b21\uff1a\u5148\u5bf9\u4e8e $0 \\leq r \\leq 3$ \u6c42\u51fa $n$ \u4ee5\u5185 $\\bmod 4 = r$ \u7684\u6570\u7684 $k$ \u6b21\u65b9\u548c\u3002\n\n\u5f53 $r = 0$\uff0c\u7b54\u6848\u4e3a $0$\uff1b\u5f53 $r = 2$\uff0c\u7b54\u6848\u4e3a $[n \\geq 2] 2^k$\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651 $r = 1, 3$ \u7684\u60c5\u51b5\u3002\n\n\u8fd9\u90e8\u5206\u4e0d\u59a8\u6cbf\u7528 Min_25 \u7b5b\u7684\u9012\u63a8\uff0c\u4f46\u56e0\u4e3a\u6211\u4eec\u8981\u5bf9 $r = 1, 3$ \u5206\u522b\u6c42\u503c\uff0c\u8003\u8651\u5c06 Min_25 \u7b5b\u7684\u9012\u63a8\u6539\u4e3a\u4e09\u7ef4\uff1a$g_{i, j, x}$ \u8868\u793a $j$ \u4ee5\u5185 $\\operatorname{lpf} > i$ \u4e14 $\\bmod 4 = x$ \u7684\u6570\u7684 $k$ \u6b21\u65b9\u548c\uff0c\u6b64\u5904 $x = 1, 3$\u3002\n\n\u8003\u8651\u5373\u5c06\u7b5b\u6389\u7684\u67d0\u4e2a\u8d28\u6570 $p$\u3002\n\n1. $p \\equiv 1 \\pmod 4$\n\n\u6b64\u65f6\u6211\u4eec\u4ece $x = 1$ \u7b5b\u8d70 $x = 1$\uff0c\u4ece $x = 3$ \u7b5b\u8d70 $x = 3$\u3002\n\n2. $p \\equiv 3 \\pmod 4$\n\n\u6b64\u65f6\u6211\u4eec\u4ece $x = 1$ \u7b5b\u8d70 $x = 3$\uff0c\u4ece $x = 3$ \u7b5b\u8d70 $x = 1$\u3002\n\n\u7528 $> 2$ \u7684\u6240\u6709\u8d28\u6570\u7b5b\u6389\u540e\u7279\u5224 $2$ \u7684\u8d21\u732e\u5373\u53ef\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u600e\u6837\u628a\u8d28\u6570\u5904\u7684\u7b54\u6848\u8fd8\u539f\u5230\u6574\u4f53\u3002\u7531\u4e8e\u6211\u4eec\u6240\u6c42\u4e0d\u662f\u5355\u70b9\uff0c\u4e0d\u65b9\u4fbf\u91c7\u7528\u5e38\u89c1\u7684 $O(n^{1 - \\epsilon})$ \u7684 dfs \u5199\u6cd5\u3002\n\n\u4e0d\u59a8\u7528\u7c7b\u4f3c\u4e0a\u8ff0\u9012\u63a8\u7684\u65b9\u6cd5\u5c06\u8d28\u6570\u5904\u7684\u503c\u8fd8\u539f\u5230\u6574\u4f53\u3002\n\n\u8bbe $h_{i, j, x}$ \u8868\u793a $j$ \u4ee5\u5185 $\\operatorname{lpf} \\geq i$ \u4e14 $\\bmod 4 = x$ \u7684\u6570\u7684 $k$ \u6b21\u65b9\u548c\u3002\n\n\u521d\u503c\uff1a$h_{\\pi(\\lfloor \\sqrt{n} \\rfloor) + 1, i, j} = g_{\\pi(\\lfloor \\sqrt{n} \\rfloor), i, j}$\u3002\n\n\u8f6c\u79fb\uff1a$h_{i, j, x} = h_{i + 1, j, x} + \\displaystyle\\sum_{y = 1}^{\\lfloor \\log_{p_i} j \\rfloor - 1} (h_{i + 1, \\lfloor \\frac{j}{p_i^y} \\rfloor, x - yp_i} - \\sum_{z = 1}^i [p_z \\equiv x \\pmod 4] + [p_i^{y + 1} \\equiv x \\pmod 4])$\u3002\n\n\u7b54\u6848\uff1a$h_{1, i, j} + [j = 0]$\u3002\n\n\u5b9e\u73b0\u65f6\u5f00\u4e00\u4e2a\u7ed3\u6784\u4f53\u505a $\\bmod x^4 - 1$ \u7684\u5faa\u73af\u5377\u79ef\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\frac{n^{\\frac{3}{4}}}{\\ln n})$\u3002\n\n\u6ce8\u610f\u9700\u8981\u5f00 __int128\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <stdio.h>\n#include <string.h>\n#include <math.h>\n\ntypedef long long ll;\ntypedef __int128 lll;\n\ntypedef struct Polynomial_tag {\n\tlll a[7];\n\tPolynomial_tag(){\n\t\tmemset(a, 0, sizeof(a));\n\t}\n} Polynomial;\n\nconst int N = 1e5 + 7, M = 2e5 + 7;\nll sqrt_n;\nint id1[N], id2[N];\nll prime[N], number[M];\nbool p[N];\nPolynomial g[M], prime_cnt[N], h[M], prime_sum[N];\n\nPolynomial operator -(Polynomial &a, Polynomial &b){\n\tPolynomial ans;\n\tfor (register int i = 0; i <= 3; i++){\n\t\tans.a[i] = a.a[i] - b.a[i];\n\t}\n\treturn ans;\n}\n\nPolynomial operator -=(Polynomial &a, Polynomial b){\n\treturn a = a - b;\n}\n\nPolynomial operator *(Polynomial &a, Polynomial b){\n\tPolynomial ans;\n\tfor (register int i = 0; i <= 3; i++){\n\t\tfor (register int j = 0; j <= 3; j++){\n\t\t\tans.a[(i + j) % 4] += a.a[i] * b.a[j];\n\t\t}\n\t}\n\treturn ans;\n}\n\nPolynomial operator +(Polynomial &a, Polynomial &b){\n\tPolynomial ans;\n\tfor (register int i = 0; i <= 3; i++){\n\t\tans.a[i] = a.a[i] + b.a[i];\n\t}\n\treturn ans;\n}\n\nPolynomial operator +=(Polynomial &a, Polynomial b){\n\treturn a = a + b;\n}\n\ninline ll sqrt(ll n){\n\tll ans = sqrt((double)n);\n\twhile (ans * ans <= n) ans++;\n\treturn ans - 1;\n}\n\ninline lll sum1(ll n){\n\treturn (lll)n * (n + 1) / 2;\n}\n\ninline int get_id(ll n, ll m){\n\treturn n <= sqrt_n ? id1[n] : id2[m / n];\n}\n\ninline int init(ll n, int m){\n\tint cnt = 0, id = 0;\n\tsqrt_n = sqrt(n);\n\tp[0] = p[1] = true;\n\tfor (register ll i = 2; i <= sqrt_n; i++){\n\t\tif (!p[i]) prime[++cnt] = i;\n\t\tfor (register int j = 1; j <= cnt && i * prime[j] <= sqrt_n; j++){\n\t\t\tp[i * prime[j]] = true;\n\t\t\tif (i % prime[j] == 0) break;\n\t\t}\n\t}\n\tfor (register ll i = 1, j; i <= n; i = j + 1){\n\t\tll tn = n / i;\n\t\tj = n / tn;\n\t\tid++;\n\t\tnumber[id] = tn;\n\t\tif (m == 0){\n\t\t\tfor (register int k = 1; k <= 3; k += 2){\n\t\t\t\tg[id].a[k] = tn >= k ? (tn - k) / 4 + (k == 1 ? 0 : 1) : 0;\n\t\t\t}\n\t\t} else {\n\t\t\tfor (register int k = 1; k <= 3; k += 2){\n\t\t\t\tif (tn < k){\n\t\t\t\t\tg[id].a[k] = 0;\n\t\t\t\t} else {\n\t\t\t\t\tll t = (tn - k) / 4;\n\t\t\t\t\tg[id].a[k] = sum1(t) * 4 + k * (t + (k == 1 ? 0 : 1));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (tn <= sqrt_n){\n\t\t\tid1[tn] = id;\n\t\t} else {\n\t\t\tid2[j] = id;\n\t\t}\n\t}\n\tif (m == 0){\n\t\tfor (register int i = 1; i <= cnt; i++){\n\t\t\tprime_cnt[i] = prime_cnt[i - 1];\n\t\t\tprime_cnt[i].a[prime[i] % 4]++;\n\t\t}\n\t\tfor (register int i = 2; i <= cnt; i++){\n\t\t\tll r = prime[i] % 4, t = prime[i] * prime[i];\n\t\t\tfor (register int j = 1; j <= id && number[j] >= t; j++){\n\t\t\t\tint cur_id = get_id(number[j] / prime[i], n);\n\t\t\t\tif (r == 1){\n\t\t\t\t\tg[j].a[1] -= g[cur_id].a[1] - prime_cnt[i - 1].a[1];\n\t\t\t\t\tg[j].a[3] -= g[cur_id].a[3] - prime_cnt[i - 1].a[3];\n\t\t\t\t} else {\n\t\t\t\t\tg[j].a[1] -= g[cur_id].a[3] - prime_cnt[i - 1].a[3];\n\t\t\t\t\tg[j].a[3] -= g[cur_id].a[1] - prime_cnt[i - 1].a[1];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (register int i = 1; i <= id; i++){\n\t\t\tif (i < id) g[i].a[2]++;\n\t\t\th[i] = g[i];\n\t\t}\n\t\tfor (register int i = cnt; i >= 1; i--){\n\t\t\tll t = prime[i] * prime[i];\n\t\t\tfor (register int j = 1; j <= id && number[j] >= t; j++){\n\t\t\t\tint x = 1;\n\t\t\t\tfor (register ll y = prime[i]; y * prime[i] <= number[j]; x++, y *= prime[i]){\n\t\t\t\t\tPolynomial poly;\n\t\t\t\t\tpoly.a[x * prime[i] % 4] = 1;\n\t\t\t\t\th[j] += poly * (h[get_id(number[j] / y, n)] - prime_cnt[i]);\n\t\t\t\t\th[j].a[prime[i] * (x + 1) % 4]++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\t\tfor (register int i = 1; i <= cnt; i++){\n\t\t\tprime_sum[i] = prime_sum[i - 1];\n\t\t\tprime_sum[i].a[prime[i] % 4] += prime[i];\n\t\t}\n\t\tfor (register int i = 2; i <= cnt; i++){\n\t\t\tll r = prime[i] % 4, t = prime[i] * prime[i];\n\t\t\tfor (register int j = 1; j <= id && number[j] >= t; j++){\n\t\t\t\tint cur_id = get_id(number[j] / prime[i], n);\n\t\t\t\tif (r == 1){\n\t\t\t\t\tg[j].a[1] -= prime[i] * (g[cur_id].a[1] - prime_sum[i - 1].a[1]);\n\t\t\t\t\tg[j].a[3] -= prime[i] * (g[cur_id].a[3] - prime_sum[i - 1].a[3]);\n\t\t\t\t} else {\n\t\t\t\t\tg[j].a[1] -= prime[i] * (g[cur_id].a[3] - prime_sum[i - 1].a[3]);\n\t\t\t\t\tg[j].a[3] -= prime[i] * (g[cur_id].a[1] - prime_sum[i - 1].a[1]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (register int i = 1; i <= id; i++){\n\t\t\tif (i < id) g[i].a[2] += 2;\n\t\t\th[i] = g[i];\n\t\t}\n\t\tfor (register int i = cnt; i >= 1; i--){\n\t\t\tll t = prime[i] * prime[i];\n\t\t\tfor (register int j = 1; j <= id && number[j] >= t; j++){\n\t\t\t\tint x = 1;\n\t\t\t\tfor (register ll y = prime[i]; y * prime[i] <= number[j]; x++, y *= prime[i]){\n\t\t\t\t\tPolynomial poly;\n\t\t\t\t\tpoly.a[x * prime[i] % 4] = y;\n\t\t\t\t\th[j] += poly * (h[get_id(number[j] / y, n)] - prime_sum[i]);\n\t\t\t\t\th[j].a[prime[i] * (x + 1) % 4] += y * prime[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn cnt;\n}\n\nvoid write(lll n){\n\tif (n >= 10) write(n / 10);\n\tputchar(n % 10 + '0');\n}\n\nint main(){\n\tint k;\n\tll m;\n\tscanf(\"%lld %d\", &m, &k);\n\tinit(m, k);\n\tfor (register ll i = 1; i <= sqrt_n; i++){\n\t\tfor (register int j = 0; j <= 3; j++){\n\t\t\twrite(h[i].a[j] + (j == 0 ? 1 : 0));\n\t\t\tputchar(' ');\n\t\t}\n\t\tprintf(\"\\n\");\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1649947749,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P7571 \u3010\u300cMCOI-05\u300d\u5e42\u79ef\u3011"
    },
    {
        "content": "\u53e3\u80e1\u4e00\u6ce2\u3002\n\n\u4ece\u81ea\u7531\u5ea6\u7684\u89d2\u5ea6\u6211\u4eec\u8003\u8651 DFT\uff0c\u4e5f\u5c31\u662f\u53ea\u7528\u7b97\u51fa\u6240\u6709\u7684 $g(n,k,0)+wg(n,k,1)+w^2g(n,k,2)+w^3g(n,k,3)$\uff0c\u5176\u4e2d $w$ \u53d6\u904d\u56db\u6b21\u5355\u4f4d\u6839 $1,i,-1,-i$\u3002\n\n\u6b64\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u8fd9\u4e9b $g$ \u7684\u548c\u62c6\u6210\u4e00\u4e2a\u4e86\uff0c\u62c6\u51fa\u6765\u7684\u7ed3\u679c\u662f\n\n$\\sum_{t=1}^n w^{f(t)}t^k$\uff0c\u56e0\u4e3a $w^{f(t)} $ \u548c $t^k$ \u90fd\u662f\u79ef\u6027\u7684\uff0c\u6240\u4ee5\u95ee\u9898\u53d8\u6210\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\u524d\u7f00\u548c\uff0c\u800c\u8fd9\u4e2a\u79ef\u6027\u51fd\u6570\u548c $1$ \u7684\u72c4\u5229\u514b\u96f7\u5377\u79ef\u5bb9\u6613\u8ba1\u7b97\uff08\u4ecd\u7136\u662f\u79ef\u6027\u7684\uff0c\u7ebf\u6027\u7b5b\u9884\u5904\u7406\u51fa\u5c0f\u7684\uff0c\u5927\u7684\u7528 pollard \u5206\u89e3\u4e4b\u540e\u76f4\u63a5\u7528\u79ef\u6027\u8fdb\u884c\u8ba1\u7b97\uff09\uff0c\u675c\u6559\u7b5b\u51fa\u5373\u53ef\uff0c\u6b63\u597d\u628a\u8981\u6c42\u7684\u90fd\u6c42\u4e86\u51fa\u6765\u3002\n\n\u5b9e\u73b0\u7684\u65f6\u5019\u76f4\u63a5\u7ef4\u62a4\u590d\u6570\u7c7b\u5373\u53ef\u3002\n\n~~\u9000\u5f79\u4eba\u6ca1\u6709\u4ee3\u7801\u3002~~",
        "postTime": 1620132759,
        "uid": 254752,
        "name": "JohnVictor",
        "ccfLevel": 6,
        "title": "P7571 \u9898\u89e3"
    },
    {
        "content": "\n\n\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4e2a $\\mathcal O(\\frac{n^{3/4}}{\\log n})$ \u89e3\u6cd5\u3002\n\n\u7531\u6574\u9664\u5206\u5757\u7ed3\u8bba\uff0c\u5bf9\u6b63\u6574\u6570 $n$\uff0c\u6709 $|\\{\\lfloor\\frac ni\\rfloor:i\\in\\mathbb Z^+\\}|\\in O(\\sqrt n)$\u3002\u5b9a\u4e49\u51fd\u6570 $r:\\mathbb Z^+\\rightarrow\\text{\\#}$ \u5173\u4e8e $n$ \u7684 **\u5757\u7b5b** \u4e3a $r$ \u5728 $\\{\\lfloor\\frac ni\\rfloor:i\\in\\mathbb Z^+\\}$ \u5904\u7684\u503c\u3002\n\n\u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570 $r(n)$ \u7684\u524d\u7f00\u548c\u51fd\u6570\u4e3a $r^S(n)$\uff0c\u5176\u4e2d\n\n$$r^S(n)=\\sum_{i=1}^nr(i)$$\n\n#### \u51fd\u6570\u5efa\u7acb\n\n\u5efa\u7acb\u51fd\u6570 $g:\\mathbb Z^+\\rightarrow\\mathbb Z/p\\mathbb Z[x]$\uff0c\u5b9a\u4e49 $g(n)=n^kx^{f(n)\\bmod4}$\u3002\u6211\u4eec\u672c\u8d28\u60f3\u6c42 $g$ \u5173\u4e8e $n$ \u7684\u5757\u7b5b\u3002\u7531\u4e8e $f(n)$ \u4e3a\u52a0\u6027\u51fd\u6570\uff0c$n^k$ \u4e3a\u5b8c\u5168\u79ef\u6027\u51fd\u6570\uff0c$n^kx^{f(n)}$ \u4e3a\u79ef\u6027\u51fd\u6570\u3002\u4e8e\u662f\uff0c\u5728 $\\mathbb Z/p\\mathbb Z[x]/(x^4-1)$ \u73af\u4e0b\uff0c$g(n)$ \u4e3a\u79ef\u6027\u51fd\u6570\uff1b\u8fd9\u91cc\u4e58\u6cd5\u4e3a\u957f\u5ea6\u4e3a $4$ \u5faa\u73af\u5377\u79ef\uff0c\u7b49\u4ef7\u4e8e\u6a21 $x^4-1$ \u7684\u591a\u9879\u5f0f\u4e58\u6cd5\u3002\n\n\u7531\u4e00\u4e9b\u7406\u8bba\uff0c\u5f97\u5230 $g(n)\\mathbb P(n)$ \u7684\u5757\u7b5b\u5373\u53ef $O(\\frac{n^{3/4}}{\\log n})$ \u5f97\u5230 $g(n)$ \u5757\u7b5b\uff0c\u5176\u4e2d $\\mathbb P(n)$ \u4e3a\u8d28\u6570\u6307\u793a\u51fd\u6570\u3002\u6ce8\u610f\u6211\u4eec\u5728\u8fd9\u91cc\\textbf{\u65e0\u6cd5\u76f4\u63a5\u7b5b}\uff08\u6307 min25 \u7b5b\uff09\u56e0\u4e3a\u4e0d\u5b58\u5728\u5b8c\u5168\u79ef\u6027\u51fd\u6570\u53ef\u4ee5\u8d2f\u7a7f $g(n)$ \u5728\u8d28\u6570\u5904\uff1b$n^kx^n$ \u548c $n^kx^{n\\bmod 4}$ \u5747\u4e0d\u4e3a\u5b8c\u5168\u79ef\u6027\u51fd\u6570\u3002\n\n#### \u6c42 $g(n)\\mathbb P(n)$ \u5757\u7b5b\n\n\u5b9a $g_{\\mathbb P}(n)=g(n)\\mathbb P(n)$\uff0c\u5219\u5982\u679c\u6211\u4eec\u5c55\u5f00 $[x^m]g_{\\mathbb P}^S(n)$\uff0c\u5176\u4e2d $0\\le m<4$\uff0c\u53d1\u73b0\u7b49\u4ef7\u4e8e\uff1a\n\n$$\\sum_{i=1}^ni^k\\mathbb P(i)[i\\equiv m\\pmod 4]$$\n\n\u8fd9\u548c min25 step1 \u6240\u6c42\u7684\u4e1c\u897f\u57fa\u672c\u4e00\u81f4\uff0c\u53ea\u591a\u4e86 $[i\\equiv m\\pmod 4]$\u3002\u5bf9 $m=0$\uff0c\u4e0a\u8ff0\u503c\u4e3a $0$\uff1b\u5bf9 $m=2$\uff0c\u4e0a\u8ff0\u503c\u4e3a $[2\\le n]2^k$\u3002\u6240\u4ee5\u5b9e\u9645\u6709 $[x^1]g_{\\mathbb P}^S(n)$ \u548c $[x^3]g_{\\mathbb P}^S(n)$ \u7684\u5757\u7b5b\u5c31\u53ef\u4ee5\u6062\u590d $g_\\mathbb P(n)$ \u7684\u5757\u7b5b\u3002\n\n\u8003\u8651\u5e7f\u4e49\u4e00\u4e0b min25 step1 \u8fc7\u7a0b\u3002\u4ecd\u7136\u9010\u4e2a\u8d28\u6570\u7b5b\u3002\u5b9a\u4e00\u4e2a\u9012\u589e\u53d8\u91cf $p$\uff0c$\\mathsf{lpf}(i)$ \u4e3a $i$ \u7684\u6700\u5c0f\u8d28\u56e0\u5b50\uff1b\u7ef4\u62a4\uff1a\n\n$$[x^{m|m\\in\\{1,3\\}}]h_p^S(n)=\\sum_{i=1}^ni^k[\\mathbb P(i)\\lor\\mathsf{lpf}(i)>p][i\\equiv m\\pmod 4]$$\n\n\u521d\u59cb\uff0c$p=0$\uff0c\u9700\u8981\u521d\u59cb\u5316\u8fd9\u4e1c\u897f\uff1a\n\n$$\\sum_{i=2}^ni^k[i\\equiv m\\pmod 4]$$\n\n\u7684\u5757\u7b5b\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u901a\u8fc7\u7b49\u5dee\u6570\u5217\u6c42\u548c\u516c\u5f0f\u627e\u5230\u3002\u6211\u4eec\u5148\u770b\u4e0a\u4e00\u4e2a\u8d28\u6570 $p'$ \u600e\u4e48\u66f4\u65b0\u5230\u4e0b\u4e00\u4e2a\u8d28\u6570 $p$\uff0c\u4e5f\u5c31\u662f\u600e\u4e48\u7b5b\u8d70\u6700\u5c0f\u8d28\u56e0\u5b50\u7b49\u4e8e $p$ \u7684\u5408\u6570\u3002\u6ce8\u610f\u5f53 $p>\\sqrt n$ \u5df2\u7ecf\u7b5b\u8d70\u6240\u6709\u5408\u6570\uff1a\u6700\u5c0f\u672a\u7b5b\u8d70\u5408\u6570\u4e3a $p^2$\uff0c\u53ef\u4ee5\u505c\u6b62\u4e86\u3002\n\n\u7b5b\u8d70\u7684\u5408\u6570\u53ef\u4ee5\u8868\u793a\u4e3a $px$\uff0c\u5176\u4e2d $\\mathsf{lpf}(x)\\ge p\\iff\\mathsf{lpf}(x)>p'$\u3002$x$ \u53ef\u4ee5\u4e3a\u5408\u6570\uff0c\u4e5f\u53ef\u4ee5\u4e3a\u5927\u4e8e $p'$ \u7684\u8d28\u6570\u3002\u4ee5\u4e0b\u5f00\u59cb\u5927\u529b\u5206\u7c7b\u8ba8\u8bba\u3002$p$\uff0c$px$\uff0c\u4e0e $x$ \u5747\u5728\u6a21 $4$ \u610f\u4e49\u8868\u793a\u3002\n\n1. \u82e5 $p\\equiv 1$\uff0c$px\\equiv 1$\uff0c\u5219 $x\\equiv 1$\u3002\u4ece $[x^1]h_p^S(n)$ \u7b5b\u8d70 $p^k([x^1]h_{p'}^S(\\lfloor\\frac np\\rfloor)-[x^1]h_{p'}^S(p'))$\u3002\n2. \u82e5 $p\\equiv 1$\uff0c$px\\equiv 3$\uff0c\u5219 $x\\equiv 3$\u3002\u4ece $[x^3]h_p^S(n)$ \u7b5b\u8d70 $p^k([x^3]h_{p'}^S(\\lfloor\\frac np\\rfloor)-[x^3]h_{p'}^S(p'))$\u3002\n3. \u82e5 $p\\equiv 3$\uff0c$px\\equiv 1$\uff0c\u5219 $x\\equiv 3$\u3002\u4ece $[x^1]h_p^S(n)$ \u7b5b\u8d70 $p^k([x^3]h_{p'}^S(\\lfloor\\frac np\\rfloor)-[x^3]h_{p'}^S(p'))$\u3002\n4. \u82e5 $p\\equiv 3$\uff0c$px\\equiv 3$\uff0c\u5219 $x\\equiv 1$\u3002\u4ece $[x^3]h_p^S(n)$ \u7b5b\u8d70 $p^k([x^1]h_{p'}^S(\\lfloor\\frac np\\rfloor)-[x^1]h_{p'}^S(p'))$\u3002\n\n\u5176\u4e2d\u6240\u6709\u540e\u8005\u4e3a\u4e0d\u8be5\u7b5b\u8d70\u7684\u5c0f\u4e8e\u7b49\u4e8e $p'$ \u8d28\u6570\uff0c\u53ef\u4ee5\u9884\u5904\u7406\u3002\n\n#### \u4ece $g(n)\\mathbb P(n)$ \u5757\u7b5b\u5f97 $g(n)$ \u5757\u7b5b\n\n\u901a\u5e38 min25 \u95ee\u9898\u53ea\u9700\u8981\u6211\u4eec\u5bf9\u79ef\u6027\u51fd\u6570\u524d\u7f00\u548c\u5355\u70b9\u6c42\u503c\uff0c\u8fd9\u65f6\u5019\u53ef\u4ee5\u7528\u4e00\u4e2a\u66f4\u7b80\u6d01\u7684 $\\mathcal O(n^{1-\\varepsilon})$ \u9012\u5f52\u505a\u6cd5\u3002\u8fd9\u91cc\u5148\u4ecb\u7ecd\u5982\u4f55\u5c06 min25 step2 \u6269\u5c55\u5230\u8ba1\u7b97\u524d\u7f00\u548c\u51fd\u6570\u5757\u7b5b\u3002\u611f\u8c22 @GuidingStar \u63d0\u4f9b\u8fd9\u4e00\u90e8\u5206\u8be6\u7ec6\u8bb2\u89e3\u3002\n\n\u8003\u8651\u5c06\u5408\u6570\u9010\u4e2a\u7b5b\u56de\u7b54\u6848\uff0c\u4ecd\u7136\u679a\u4e3e\u5408\u6570\u6700\u5c0f\u8d28\u56e0\u5b50 $p=p_m$\u3002\u5148\u4e22\u8d70 $g(n)$ \u4e3a\u591a\u9879\u5f0f\u8fd9\u6027\u8d28\uff0c\u5b9a\u4e49\u51fd\u6570\n\n$$F_m(n)=\\sum_{i=2}^ng(n)[\\textsf{lpf}(i)\\ge p_m\\lor i\\in\\mathbb P]$$\n\n\u5219\u6709\u8fb9\u754c\u6761\u4ef6\n\n$$F_{\\pi(\\sqrt n)+1}(n)=g_{\\mathbb P}^S(n)$$\n\n\u8003\u8651\u5982\u4f55\u7b5b\u8fdb\u6700\u5c0f\u8d28\u56e0\u5b50\u4e3a $p_m$ \u7684\u5408\u6570 $C$\u3002\u6709\u4e24\u4e2a\u60c5\u51b5\uff1a\u7b2c\u4e00 $C$ \u5305\u542b\u4e0d\u4e3a $C$ \u7684\u8d28\u56e0\u5b50\uff0c\u4e5f\u5c31\u662f $C=p_m^xC'$ \u5176\u4e2d $\\textsf{lpf}(C')>p_m$\uff1b\u6216\u8005 $C$ \u4e3a $p_m$ \u7684\u5e42\uff0c\u4e5f\u5c31\u662f $C=p_m^x$ \u5176\u4e2d $x>1$\uff08\u6ce8\u610f $x=1$ \u60c5\u51b5\u5df2\u7ecf\u5728\u8d28\u6570\u91cc\u5305\u542b\u4e86\uff01\uff09\n\n\u679a\u4e3e $x$\uff1b\u4e0e\u4e0a\u4e00\u90e8\u5206\u7c7b\u4f3c\u63a8\u5230\uff0c\u7b2c\u4e00\u60c5\u51b5\u7684 $C'$ \u4ece $1\\le x\\le\\frac{n}{p_m^x}$ \u7684 $\\textsf{lpf}(C')>p_m$ \u9009\uff0c\u7b2c\u4e8c\u60c5\u51b5\u76f4\u63a5\u7b97\u3002\u7531 $g(n)$ \u7684\u79ef\u6027\u6027\uff0c\u7b2c\u4e00\u60c5\u51b5\u53ef\u4ee5\u76f4\u63a5\u4e58 $g(p_m^x)$ \u8ba1\u7b97\u8d21\u732e\u3002\u5f62\u5f0f\u5316\uff1a\n\n$$F_m(n)=F_{m+1}(n)+\\sum_{x=1,p_m^x\\le n}g(p_m^x)\\max(0,F_{m+1}(\\lfloor\\frac n{p_m^x}\\rfloor)-g_{\\mathbb P}^S(p_m))+\\sum_{x=2,p_m^x\\le n}g(p_m^x)$$\n\n\u6574\u7406\u4e00\u4e0b\u7b2c\u4e00\u90e8\u5206\u53d1\u73b0\u5982\u679c\u6709 $\\frac{n}{p_m^x}\\ge p_m$\uff0c\u7b49\u4ef7\u4e8e $p_m^{x+1}\\le n$\uff0c\u4e8e\u662f\u76f4\u63a5\u679a\u4e3e $x+1$ \u4e5f\u6ca1\u4e8b\u3002\n\n$$F_m(n)=F_{m+1}(n)+\\sum_{x=1,p_m^{x+1}\\le n}g_m(p_m^x)(F_{m+1}(\\lfloor\\frac n{p_m^x}\\rfloor)-g_{\\mathbb P}^S(p_m))+g(p_m^{x+1})$$\n\n\u9010 $m$ \u5730\u63a8\uff0c\u4ece $\\pi(\\sqrt n)+1$ \u5f80 $1$\uff0c\u5373\u53ef\u3002\n\n\u8fd9\u91cc $F_m(n)$ \u503c\u5747\u5728\u73af $\\mathbb Z/p\\mathbb Z[x]/(x^4-1)$ \u64cd\u4f5c\uff0c\u4e58\u6cd5\u4e3a\u5faa\u73af\u5377\u79ef\u3002\u603b\u5171\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(\\frac{n^{3/4}}{\\log n})$\u3002",
        "postTime": 1620118363,
        "uid": 220037,
        "name": "w33z8kqrqk8zzzx33",
        "ccfLevel": 7,
        "title": "MCOI R5 F"
    }
]
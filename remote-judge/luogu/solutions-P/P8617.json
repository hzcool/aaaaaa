[
    {
        "content": "\u9898\u76ee\u63cf\u8ff0\u4e0d\u662f\u5f88\u6e05\u6670\uff0c\u5b9e\u9645\u4e0a $S$ \u53ea\u7531\u5c0f\u5199\u5b57\u6bcd\u6784\u6210\u3002\n\n\u5148\u8bf4\u4e00\u4e0b\u90e8\u5206\u5206\u505a\u6cd5\uff0c\u8003\u8651\u4e8c\u5206\uff0c\u4e8c\u5206\u957f\u5ea6\uff0c\u5229\u7528 hash \u548c map \u6765\u8fdb\u884c\u590d\u6742\u5ea6\u4e3a $O(n \\log n)$ \u7684\u6bd4\u8f83\u5224\u65ad\uff0c\u603b\u590d\u6742\u5ea6 $O(n \\log ^ 2n)$\u3002\u7531\u4e8e\u5355 hash \u7684 hash \u51b2\u7a81\u6bd4\u8f83\u4e25\u91cd\uff0c\u800c\u53cc hash \u6548\u7387\u53c8\u592a\u6162\uff0c\u6545\u4f7f\u7528\u8fd9\u4e2a\u529e\u6cd5\u672c\u4eba\u53ea\u83b7\u5f97\u4e86 $60$\u3002\n\n\u8003\u8651\u4f7f\u7528 SAM \u6c42\u51fa\u6765\u6240\u6709\u5b50\u4e32\u7684\u51fa\u73b0\u6b21\u6570\u548c\u957f\u5ea6\uff0c\u5982\u679c\u4e00\u4e2a\u5b50\u4e32\u51fa\u73b0\u4e86 $2$ \u6b21\u4ee5\u4e0a\uff0c\u5219\u5bf9\u7b54\u6848\u8fdb\u884c\u4e00\u6b21\u8d21\u732e\uff0c\u590d\u6742\u5ea6 $O(n \\log n)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define N 500005\n#define For(i, j, n) for(register int i = j ; i <= n ; ++i)\nint ans, cnt, len, last;\nint a[N], l[N], fa[N], go[N][26], siz[N];\nstring s;\n\ninline void insert(int x){\n\tint p = last, np = ++cnt;\n\tlast = np, siz[np] = 1, l[np] = l[p] + 1; \n\tfor( ; !go[p][x] && p ; p = fa[p]) go[p][x] = np;\n\tif(!p) return fa[np] = 1, void();\n\tint nq = go[p][x];\n\tif(l[nq] == l[p] + 1) fa[np] = nq;\n\telse{\n\t\tint q = ++cnt;\n\t\tfa[q] = fa[nq], fa[nq] = fa[np] = q;\n\t\tl[q] = l[p] + 1;\n\t\tmemcpy(go[q], go[nq], sizeof(go[nq]));\n\t\tfor( ; go[p][x] == nq ; p = fa[p]) go[p][x] = q;\n\t}\n}\n\ninline bool cmp(int x, int y){ return l[x] > l[y]; }\nint main(){\n    cin >> s, cnt = last = 1;\n    for(auto i : s) insert(i - 'a');\n    For(i, 1, cnt) a[i] = i;\n\tsort(a + 1, a + cnt + 1, cmp);\n\tFor(i, 1, cnt){\n\t\tsiz[fa[a[i]]] += siz[a[i]];\n\t\tif(siz[a[i]] > 1) ans = max(ans, l[a[i]]); \n\t}\n\tprintf(\"%d\", ans);\n\treturn 0;\n}",
        "postTime": 1670508407,
        "uid": 163980,
        "name": "\u884c\u541f\u5578\u4e5d\u5dde",
        "ccfLevel": 7,
        "title": "P8617 [\u84dd\u6865\u676f 2014 \u56fd AC] \u91cd\u590d\u6a21\u5f0f \u9898\u89e3"
    }
]
[
    {
        "content": "## \u7b80\u4ecb\r\n\r\n>\u5728\u6570\u503c\u5206\u6790\u4e2d\uff0c\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u662f\u4ee5\u6cd5\u56fd18\u4e16\u7eaa\u6570\u5b66\u5bb6\u7ea6\u745f\u592b\u00b7\u62c9\u683c\u6717\u65e5\u547d\u540d\u7684\u4e00\u79cd\u591a\u9879\u5f0f\u63d2\u503c\u65b9\u6cd5\u3002\u5982\u679c\u5bf9\u5b9e\u8df5\u4e2d\u7684\u67d0\u4e2a\u7269\u7406\u91cf\u8fdb\u884c\u89c2\u6d4b\uff0c\u5728\u82e5\u5e72\u4e2a\u4e0d\u540c\u7684\u5730\u65b9\u5f97\u5230\u76f8\u5e94\u7684\u89c2\u6d4b\u503c\uff0c\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a\u591a\u9879\u5f0f\uff0c\u5176\u6070\u597d\u5728\u5404\u4e2a\u89c2\u6d4b\u7684\u70b9\u53d6\u5230\u89c2\u6d4b\u5230\u7684\u503c\u3002\u4e0a\u9762\u8fd9\u6837\u7684\u591a\u9879\u5f0f\u5c31\u79f0\u4e3a\u62c9\u683c\u6717\u65e5\uff08\u63d2\u503c\uff09\u591a\u9879\u5f0f\u3002\r\n\r\n## \u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\r\n\r\n\u4f17\u6240\u5468\u77e5\uff0c$n + 1$\u4e2a$x$\u5750\u6807\u4e0d\u540c\u7684\u70b9\u53ef\u4ee5\u786e\u5b9a\u552f\u4e00\u7684\u6700\u9ad8\u4e3a$n$\u6b21\u7684\u591a\u9879\u5f0f\u3002\u5728\u7b97\u6cd5\u7ade\u8d5b\u4e2d\uff0c\u6211\u4eec\u5e38\u5e38\u4f1a\u78b0\u5230\u4e00\u7c7b\u9898\u76ee\uff0c\u9898\u76ee\u4e2d\u76f4\u63a5\u6216\u95f4\u63a5\u7684\u7ed9\u51fa\u4e86$n+1$\u4e2a\u70b9\uff0c\u8ba9\u6211\u4eec\u6c42\u7531\u8fd9\u4e9b\u70b9\u6784\u6210\u7684\u591a\u9879\u5f0f\u5728\u67d0\u4e00\u4f4d\u7f6e\u7684\u53d6\u503c\r\n\r\n\u4e00\u4e2a\u6700\u663e\u7136\u7684\u601d\u8def\u5c31\u662f\u76f4\u63a5\u9ad8\u65af\u6d88\u5143\u6c42\u51fa\u591a\u9879\u5f0f\u7684\u7cfb\u6570\uff0c\u4f46\u662f\u8fd9\u6837\u505a\u590d\u6742\u5ea6\u5de8\u5927$(n^3)$\u4e14\u6839\u636e\u7b97\u6cd5\u5b9e\u73b0\u4e0d\u540c\u5f80\u5f80\u4f1a\u5b58\u5728\u7cbe\u5ea6\u95ee\u9898\r\n\r\n\u800c\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u53ef\u4ee5\u5728$n^2$\u7684\u590d\u6742\u5ea6\u5185\u5b8c\u7f8e\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\r\n\r\n\u5047\u8bbe\u8be5\u591a\u9879\u5f0f\u4e3a$f(x)$, \u7b2c$i$\u4e2a\u70b9\u7684\u5750\u6807\u4e3a$(x_i, y_i)$\uff0c\u6211\u4eec\u9700\u8981\u627e\u5230\u8be5\u591a\u9879\u5f0f\u5728$k$\u70b9\u7684\u53d6\u503c\r\n\r\n\u6839\u636e\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\r\n\r\n$$f(k) = \\sum_{i = 0}^{n} y_i \\prod_{i \\not = j} \\frac{k - x[j]}{x[i] - x[j]}$$\r\n\r\n\u4e4d\u4e00\u770b\u53ef\u80fd\u4e0d\u662f\u5f88\u597d\u7406\u89e3\uff0c\u6211\u4eec\u6765\u4e3e\u4e2a\u4f8b\u5b50\u7406\u89e3\u4e00\u4e0b\r\n\r\n\u5047\u8bbe\u7ed9\u51fa\u7684\u4e09\u4e2a\u70b9\u4e3a$(1, 3)(2, 7)(3, 13)$\r\n\r\n\u76f4\u63a5\u628a$f(k)\u5c55\u5f00$\r\n\r\n$f(k) = 3 \\frac{(k - 2)(k - 3)}{(1 - 2)(1 - 3)} + 7\\frac{(k-1)(k-2)}{(2 - 1)(2-3)} + 13\\frac{(k-1)(k-2)}{(3 -1)(3-2)}$\r\n\r\n\u89c2\u5bdf\u4e0d\u96be\u5f97\u5230\uff0c\u5982\u679c\u6211\u4eec\u628a$x_i$\u5e26\u5165\u7684\u8bdd\uff0c\u9664\u7b2c$i$\u9879\u5916\u7684\u6bcf\u4e00\u9879\u7684\u5206\u5b50\u4e2d\u90fd\u4f1a\u6709$x_i - x_i$\uff0c\u8fd9\u6837\u5176\u4ed6\u7684\u6240\u6709\u9879\u5c31\u90fd\u88ab\u6d88\u53bb\u4e86\r\n\r\n\u56e0\u6b64\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u7684\u6b63\u786e\u6027\u662f\u53ef\u4ee5\u4fdd\u8bc1\u7684\r\n\r\n\u4e0b\u9762\u8bf4\u4e00\u4e0b\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u7684\u62d3\u5c55\r\n\r\n### \u5728$x$\u53d6\u503c\u8fde\u7eed\u65f6\u7684\u505a\u6cd5\r\n\r\n\u5728\u7edd\u5927\u591a\u6570\u9898\u76ee\u4e2d\u6211\u4eec\u9700\u8981\u7528\u5230\u7684$x_i$\u7684\u53d6\u503c\u90fd\u662f\u8fde\u7eed\u7684\uff0c\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u53ef\u4ee5\u628a\u4e0a\u9762\u7684\u7b97\u6cd5\u4f18\u5316\u5230$O(n)$\u590d\u6742\u5ea6\r\n\r\n\u9996\u5148\u628a$x_i$\u6362\u6210$i$\uff0c\u65b0\u7684\u5f0f\u5b50\u4e3a\r\n\r\n$f(k) = \\sum_{i=0}^n y_i \\prod_{i \\not = j} \\frac{k - j}{i - j}$\r\n\r\n\u8003\u8651\u5982\u4f55\u5feb\u901f\u8ba1\u7b97$\\prod_{i \\not = j} \\frac{k - j}{i - j}$\r\n\r\n\u5bf9\u4e8e\u5206\u5b50\u6765\u8bf4\uff0c\u6211\u4eec\u7ef4\u62a4\u51fa\u5173\u4e8e$k$\u7684\u524d\u7f00\u79ef\u548c\u540e\u7f00\u79ef\uff0c\u4e5f\u5c31\u662f\r\n\r\n$$pre_i = \\prod_{j = 0}^{i} k - j$$\r\n\r\n$$suf_i = \\prod_{j = i}^n k - j$$\r\n\r\n\u5bf9\u4e8e\u5206\u6bcd\u6765\u8bf4\uff0c\u89c2\u5bdf\u53d1\u73b0\u8fd9\u5176\u5b9e\u5c31\u662f\u9636\u4e58\u7684\u5f62\u5f0f\uff0c\u6211\u4eec\u7528$fac[i]$\u6765\u8868\u793a$i!$\r\n\r\n\u90a3\u4e48\u5f0f\u5b50\u5c31\u53d8\u6210\u4e86\r\n\r\n$$f(k) = \\sum_{i=0}^n y_i \\frac{pre_{i-1} * suf_{i+1}}{fac[i - 1] * fac[N - i]}$$\r\n\r\n**\u6ce8\u610f**:\u5206\u6bcd\u53ef\u80fd\u4f1a\u51fa\u73b0\u7b26\u53f7\u95ee\u9898\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53$N - i$\u4e3a\u5947\u6570\u65f6\uff0c\u5206\u6bcd\u5e94\u8be5\u53d6\u8d1f\u53f7\r\n\r\n### \u91cd\u5fc3\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\r\n\r\n\u518d\u6765\u770b\u4e00\u4e0b\u524d\u9762\u7684\u5f0f\u5b50\r\n\r\n$$f(k) = \\sum_{i = 0}^{n} y_i \\prod_{i \\not = j} \\frac{k - x[j]}{x[i] - x[j]}$$\r\n\r\n\u8bbe$g = \\prod_{i=0}^n k - x[i]$\r\n\r\n\r\n\r\n$$f(k) = g\\sum_{i = 0}^{n} \\prod_{i \\not = j} \\frac{y_i}{(k - x[i])(x[i] - x[j])}$$\r\n\r\n\u8bbe$t_i = \\frac{y_i}{\\prod_{j \\not =i} x_i - x_j}$\r\n\r\n$$f(k) = g\\sum_{i = 0}^{n}  \\frac{t_i}{(k - x[i])}$$\r\n\r\n\u8fd9\u6837\u6bcf\u6b21\u65b0\u52a0\u5165\u4e00\u4e2a\u70b9\u7684\u65f6\u5019\u53ea\u9700\u8981\u8ba1\u7b97\u5b83\u7684$t_i$\u5373\u53ef\r\n\r\n## \u5e94\u7528\r\n\r\n### \u7ecf\u5178\u5e94\u7528\r\n\r\n\u9996\u5148\u8bb2\u4e00\u4e2a\u7ecf\u5178\u5e94\u7528\uff1a\u8ba1\u7b97$\\sum_{i=1}^n i^k (n \\leqslant 10^{15}, k \\leqslant 10^6)$\r\n\r\n\u8001\u7956\u5b97\u544a\u8bc9\u6211\u4eec\uff0c\u8fd9\u4e2a\u4e1c\u897f\u662f\u4e2a\u4ee5$n$\u4e3a\u81ea\u53d8\u91cf\u7684$k + 1$\u6b21\u591a\u9879\u5f0f\uff0c\u5177\u4f53\u8bc1\u660e\u53ef\u4ee5\u770b\u7b2c\u4e8c\u4efd\u53c2\u8003\u8d44\u6599\r\n\r\n\u7136\u540e\u76f4\u63a5\u5e26\u5165$k+1$\u4e2a\u70b9\u540e\u7528\u62c9\u683c\u6717\u65e5\u63d2\u503c\u7b97\u5373\u53ef\uff0c\u590d\u6742\u5ea6$O(k)$\r\n\r\n\u90a3\u5177\u4f53\u5728\u9898\u76ee\u4e2d\u600e\u4e48\u4f7f\u7528\u62c9\u683c\u6717\u65e5\u63d2\u503c\u5462\uff1f\r\n\r\n\u9996\u5148\u4f60\u8981\u8bc1\u660e\u6c42\u7684\u4e1c\u897f\u662f\u67d0\u4e2a\u591a\u9879\u5f0f\uff0c\u5224\u65ad\u7684\u4f9d\u636e\u662f\uff1a\r\n\r\n![](https://ws1.sinaimg.cn/large/005S5cb6ly1fxujkvfyosj30ax01qgll.jpg)\r\n\r\n\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u5f52\u7eb3\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\r\n\r\n### \u9898\u76ee\r\n\r\n\u7531\u6613\u5230\u96be\u6392\u5217\r\n\r\n[\u6d1b\u8c37P4593 [TJOI2018]\u6559\u79d1\u4e66\u822c\u7684\u4eb5\u6e0e](https://www.cnblogs.com/zwfymqz/p/10056635.html)\r\n\r\n\r\n[BZOJ3453: tyvj 1858 XLkxc](https://www.cnblogs.com/zwfymqz/p/10060254.html)\r\n\r\n[BZOJ4559: [JLoi2016]\u6210\u7ee9\u6bd4\u8f83](https://www.cnblogs.com/zwfymqz/p/10051210.html)\r\n\r\n[BZOJ2655: calc](https://www.cnblogs.com/zwfymqz/p/10062445.html)\r\n\r\n\r\n\r\n\r\n## \u53c2\u8003\u8d44\u6599\r\n\r\n[\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5](https://zh.wikipedia.org/wiki/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E6%8F%92%E5%80%BC%E6%B3%95)\r\n\r\n[\u5dee\u5206\u7684\u5e94\u7528\u53ca\u6b63\u6574\u6570\u7684k\u6b21\u65b9\u5e42\u6c42\u548c](https://pan.baidu.com/s/1SqZMrZLuOqIp1HQVQejK7g)\r\n\r\n[\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u53ca\u5e94\u7528](https://blog.csdn.net/qq_35649707/article/details/78018944)\r\n\r\n[\u62c9\u683c\u6717\u65e5\u63d2\u503c \u5b66\u4e60\u7b14\u8bb0](http://www.ebola.pro/article/notes/Lagrange)",
        "postTime": 1543894480,
        "uid": 36984,
        "name": "attack",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4781 \u3010\u3010\u6a21\u677f\u3011\u62c9\u683c\u6717\u65e5\u63d2\u503c\u3011"
    },
    {
        "content": "# \u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\n\n## \u7b80\u4ecb\n\n\u7ed9\u5b9a $n + 1$ \u4e2a**\u6a2a\u5750\u6807\u4e0d\u76f8\u540c**\u7684\u70b9\uff0c\u53ef\u4ee5\u552f\u4e00\u786e\u5b9a\u4e00\u4e2a $n$ \u6b21\u7684\u591a\u9879\u5f0f\u3002\u6700\u76f4\u89c2\u7684\u6c42\u591a\u9879\u5f0f\u7684\u505a\u6cd5\u5c31\u662f\u5217\u65b9\u7a0b\u6c42\u89e3\u3002\u4f46\u662f\u8fd9\u6837\u9700\u8981 $O(n^3)$ \u7684\u65f6\u95f4\u6765\u8ba1\u7b97\u3002\u800c\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u5219\u901a\u8fc7\u6784\u9020\u7684\u65b9\u6cd5\uff0c\u5f97\u5230\u4e86\u4e00\u4e2a\u7ecf\u8fc7 $n + 1$ \u4e2a\u70b9\u7684 $n$ \u6b21\u591a\u9879\u5f0f\u3002 \u5177\u4f53\u7684\u8fc7\u7a0b\u662f\u8fd9\u6837\u7684\uff0c\u5047\u8bbe\u73b0\u5728\u6211\u4eec\u5f97\u5230\u4e86 $n + 1$ \u4e2a\u70b9\uff1a\n\n$$ (x_0, y_0), \\;(x_1, y_1),\\; \\dots,\\;(x_n, y_n) $$\n\n\u8bbe**\u62c9\u683c\u6717\u65e5\u57fa\u672c\u591a\u9879\u5f0f**\u4e3a\n\n$$ \\ell_j(x) = \\prod_{i = 0, i \\neq j}^n {x - x_i \\over x_j - x_i} $$\n\n\u8fd9\u4e2a\u57fa\u672c\u591a\u9879\u5f0f\u6784\u9020\u5341\u5206\u5de7\u5999\uff0c\u56e0\u4e3a\u6ce8\u610f\u5230 $\\ell_j(x_j) = 1$ \uff0c\u5e76\u4e14 $\\ell_j(x_i) = 0, \\;\\forall i \\neq j$ \u3002\u90a3\u4e48\uff0c\u63a5\u7740\u6784\u9020\u51fa\u8fd9\u4e2a $n$ \u6b21\u591a\u9879\u5f0f\n\n$$ P(x) = \\sum_{i = 0}^n y_i\\ell_i(x) $$\n\n\u6839\u636e\u57fa\u672c\u591a\u9879\u5f0f\u7684\u6027\u8d28\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053 $P(x_i) = y_i$ \uff0c\u4e5f\u5c31\u662f\u7ecf\u8fc7\u4e86\u8fd9 $n + 1$ \u4e2a\u70b9\u3002 \u901a\u8fc7\u7b80\u5355\u7684\u591a\u9879\u5f0f\u4e58\u6cd5\u548c\u591a\u9879\u5f0f\u9664\u6cd5\u5c31\u53ef\u4ee5\u5728 $O(n^2)$ \u7684\u65f6\u95f4\u6c42\u51fa\u8fd9\u4e2a\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u8868\u8fbe\u3002\n\n## \u6c42\u89e3\n\n\u5df2\u77e5 $n$ \u6b21\u591a\u9879\u5f0f $f(n)$ \u4e0a\u7684 $n+1$ \u4e2a\u70b9 $(x_i,y_i),i\\in[0,n]$ \uff0c\u6c42 $f(xi)$\n\n```cpp\nint lagrange(int n, int *x, int *y, int xi) {\n    int ans = 0;\n    for (int i = 0; i <= n; i++) {\n        int s1 = 1, s2 = 1;\n        for (int j = 0; j <= n; j++)\n            if (i != j) {\n                s1 = 1ll*s1*(xi-x[j])%mod;\n                s2 = 1ll*s2*(x[i]-x[j])%mod;\n            }\n        ans = (1ll*ans+1ll*y[i]*s1%mod*quick_pow(s2, mod-2)%mod)%mod;\n    }\n    return (ans+mod)%mod;\n}\n```\n\n\u5982\u679c $x$ \u7684\u53d6\u503c\u662f\u8fde\u7eed\u4e00\u6bb5\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u505a\u5230 $O(n)$ \u6c42\u89e3\u3002\u5047\u8bbe $\\forall i<j,x_i<x_j$ \uff08\u5177\u4f53\u516c\u5f0f\u63a8\u5bfc\u7684\u8bdd\uff0c\u5982\u679c\u4f60\u6709\u5174\u8da3\u53ef\u4ee5\u53c2\u770b\u4e4b\u540e\u7684\u5185\u5bb9\u3002\u56e0\u4e3a\u6bd4\u8f83\u663e\u7136\uff0c\u8fd9\u91cc\u4e0d\u518d\u8bb2\u89e3\u3002\uff09\n\n```cpp\nint lagrange(int n, int *x, int *y, int xi) {\n\tint ans = 0;\n\ts1[0] = (xi-x[0])%mod, s2[n+1] = 1;\n\tfor (int i = 1; i <= n; i++) s1[i] = 1ll*s1[i-1]*(xi-x[i])%mod;\n\tfor (int i = n; i >= 0; i--) s2[i] = 1ll*s2[i+1]*(xi-x[i])%mod;\n\tifac[0] = ifac[1] = 1;\n\tfor (int i = 2; i <= n; i++) ifac[i] = -1ll*mod/i*ifac[mod%i]%mod;\n\tfor (int i = 2; i <= n; i++) ifac[i] = 1ll*ifac[i]*ifac[i-1]%mod;\n\tfor (int i = 0; i <= n; i++)\n\t\t(ans += 1ll*y[i]*(i == 0 ? 1 : s1[i-1])%mod*s2[i+1]%mod\n\t\t\t*ifac[i]%mod*(((n-i)&1) ? -1 : 1)*ifac[n-i]%mod) %= mod;\n\treturn (ans+mod)%mod;\n}\n```",
        "postTime": 1532530532,
        "uid": 11773,
        "name": "NaVi_Awson",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4781 \u3010\u3010\u6a21\u677f\u3011\u62c9\u683c\u6717\u65e5\u63d2\u503c\u3011"
    },
    {
        "content": "### \u9898\u76ee\u5927\u610f\n\n\u7ed9\u51fa $n$ \u4e2a\u70b9 $P_i(x_i,y_i)$ \uff0c\u5c06\u8fc7\u8fd9 $n$ \u4e2a\u70b9\u7684\u6700\u591a $n-1$ \u6b21\u7684\u591a\u9879\u5f0f\u8bb0\u4e3a $f(x)$ \uff0c\u6c42 $f(k)$ \u7684\u503c\u3002\n\n### \u65b9\u6cd51\uff1a\u5dee\u5206\u6cd5\n\n\u5dee\u5206\u6cd5\u9002\u7528\u4e8e $x_i=i$ \u7684\u60c5\u51b5\u3002\n\n\u5982\uff0c\u7528\u5dee\u5206\u6cd5\u6c42 $f(x)=\\sum_{i=1}^{x} i^2$ \u7684\u591a\u9879\u5f0f\u5f62\u5f0f\u3002\n\n```\n1   5   14   30   55   91\n  4   9    16   25   36\n    5   7     9   11\n      2    2    2\n```\n\n\u7b2c\u4e00\u884c\u4e3a $f(x)$ \u7684\u8fde\u7eed\u7684\u524d\u51e0\u9879\uff1b\u82e5\u4e0a\u9762\u4e00\u884c\u6709 $n$ \u4e2a\u503c\uff0c\u4e0b\u9762\u4e00\u884c\u6709 $n-1$ \u4e2a\u503c\uff0c\u6bcf\u4e2a\u503c\u4e3a\u4e0a\u9762\u5bf9\u5e94\u7684\u76f8\u90bb\u4e24\u9879\u7684\u5dee\u3002\u89c2\u5bdf\u5230\uff0c\u5982\u679c\u8fd9\u6837\u64cd\u4f5c\u7684\u6b21\u6570\u8db3\u591f\u591a\uff08\u524d\u63d0\u662f $f(x)$ \u4e3a\u591a\u9879\u5f0f\uff09\uff0c\u6bcf\u6b21\u603b\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5b9a\u503c\uff0c\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u5b9a\u503c\u6c42\u51fa $f(x)$ \u7684\u6bcf\u4e00\u9879\u7684\u7cfb\u6570\uff0c\u7136\u540e\u5373\u53ef\u5c06 $k$ \u4ee3\u5165\u591a\u9879\u5f0f\u4e2d\u6c42\u89e3\u3002\u5982\u4e0a\u4f8b\u4e2d\u53ef\u6c42\u51fa $f(x)=\\frac 1 3 n^3+\\frac 1 2 n^2+\\frac 1 6 n$ \u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^2)$ \uff0c\u5bf9\u7ed9\u51fa\u7684\u70b9\u7684\u9650\u5236\u6027\u8f83\u5f3a\u3002\n\n### \u65b9\u6cd52\uff1a\u9ad8\u65af\u6d88\u5143\n\n\u4f7f\u7528 **\u5f85\u5b9a\u7cfb\u6570\u6cd5** \u3002\u8bbe $f(x)=\\sum_{i=0}^{n-1} a_ix^i$\u5c06\u6bcf\u4e2a $x_i$ \u4ee3\u5165 $f(x)$ \uff0c\u6709 $f(x_i)=y_i$ \uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7531 $n$ \u6761 $n$ \u5143 $1$ \u6b21\u65b9\u7a0b\u6240\u7ec4\u6210\u7684\u65b9\u7a0b\u7ec4\uff0c\u7136\u540e\u4f7f\u7528 **\u9ad8\u65af\u6d88\u5143** \u6c42\u51fa\u6bcf\u4e00\u9879 $a_i$ \uff0c\u7136\u540e\u5c06 $k$ \u4ee3\u5165\u6c42\u503c\u3002\n\n\u5982\u679c\u60a8\u4e0d\u77e5\u9053\u4ec0\u4e48\u662f\u9ad8\u65af\u6d88\u5143\uff0c\u8bf7\u770b [luogu P3389 \u9ad8\u65af\u6d88\u5143\u6cd5](https://www.luogu.org/problemnew/show/P3389) \u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3)$ \uff0c\u5bf9\u7ed9\u51fa\u70b9\u7684\u5750\u6807\u65e0\u8981\u6c42\u3002\n\n### \u65b9\u6cd53\uff1a \u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\n\n\u8003\u8651\u5c06\u6bcf\u4e2a\u70b9\u505a\u4e00\u4e2a\u5bf9\u4e8e $x$ \u8f74\u7684\u5782\u7ebf\uff0c\u8bbe\u5782\u8db3\u4e3a $H_i(x_i,0)$ \u3002\n\n![](https://cdn.luogu.com.cn/upload/pic/39927.png )\n\n\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u9ed1\u7ebf\u7b49\u4e8e\u84dd\u7ebf\u52a0\u7eff\u7ebf\u52a0\u7ea2\u7ebf\u3002\u6bcf\u6b21\u6211\u4eec\u9009\u62e9 $1$ \u4e2a $P_i$ \uff0c\u5e76\u9009\u62e9\u5176\u4ed6\u7684 $H_j[j\\neq i]$ \uff0c\u505a\u4e00\u6761\u8fc7\u8fd9\u4e9b\u70b9\u7684\u4e00\u6761\u81f3\u591a $n-1$ \u6b21\u7684\u7ebf\u3002\u7531\u4e8e\u6709 $n-2$ \u4e2a\u70b9\u90fd\u5728 $x$ \u8f74\u4e0a\uff0c\u6211\u4eec\u77e5\u9053\u8fd9\u6761\u7ebf\u7684\u89e3\u6790\u5f0f\u4e00\u5b9a\u662f\u5f62\u5982 $g_i(x)=y_i\\times (\\prod_{i=1}^{n} (x-x_i)[i\\neq x])$ \u7684\u5f62\u5f0f\u3002\n\n\u6700\u540e\u5c06\u6240\u6709\u7684 $g(x)$ \u76f8\u52a0\uff0c\u5373 $f(x)=sum_{i=1}^{n}g_i(x)$ \u3002\u56e0\u4e3a\u5bf9\u4e8e\u6bcf\u4e2a\u70b9 $P_i$ \uff0c\u90fd\u53ea\u6709\u4e00\u6761\u51fd\u6570\u7ecf\u8fc7 $P_i$ \uff0c\u5176\u4f59\u90fd\u7ecf\u8fc7 $H_i$ \uff0c\u8fd9\u4e00\u9879\u7684\u7cfb\u6570\u662f $0$ \uff0c\u6240\u4ee5\u6700\u540e\u7684\u548c\u51fd\u6570\u603b\u662f\u8fc7\u6240\u6709 $n$ \u4e2a\u70b9\u7684\u3002\n\n\u516c\u5f0f\u6574\u7406\u5f97\uff1a\n\n$f(x)=\\sum_{i=1}^{n} y_i\\times(\\prod_{j\\neq i }\\frac{x-x_j}{x_i-x_j})$\n\n\u5982\u679c\u8981\u5c06\u6bcf\u4e00\u9879\u90fd\u7b97\u51fa\u6765\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4ecd\u662f $O(n^2)$ \u7684\uff0c\u4f46\u662f\u672c\u9898\u4e2d\u53ea\u7528\u6c42\u51fa $f(k)$ \u7684\u503c\uff0c\u6240\u4ee5\u53ea\u9700\u5c06 $k$ \u4ee3\u5165\u8fdb\u5f0f\u5b50\u91cc\u5f97\uff1a\n\n$Ans=\\sum_{i=1}^{n} y_i\\times(\\prod_{j\\neq i }\\frac{k-x_j}{x_i-x_j})$\n\n\u672c\u9898\u4e2d\uff0c\u8fd8\u9700\u8981\u6c42\u89e3\u9006\u5143\u3002\u5982\u679c\u5148\u5206\u522b\u8ba1\u7b97\u51fa\u5206\u5b50\u548c\u5206\u6bcd\uff0c\u5728\u8ba1\u7b97\u5206\u6bcd\u7684\u9006\u5143\uff0c\u4e58\u4e0a\u5206\u5b50\uff0c\u7d2f\u52a0\u8fdb\u6700\u540e\u7684\u7b54\u6848\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u74f6\u9888\u5c31\u4e0d\u4f1a\u5728\u6c42\u9006\u5143\u4e0a\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^2)$ \u3002\n\n### \u4ee3\u7801\u5b9e\u73b0\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nconst int maxn=2010;\ntypedef long long ll;\nll mod=998244353;\nll n,k,x[maxn],y[maxn],ans,s1,s2;\nll powmod(ll a,ll x)\n{\n    ll ret=1ll,nww=a;\n    while(x)\n    {\n        if(x&1)ret=ret*nww%mod;\n        nww=nww*nww%mod;x>>=1;\n    }\n    return ret;\n}\nll inv(ll x){return powmod(x,mod-2);}\nint main()\n{\n    scanf(\"%lld%lld\",&n,&k);\n    for(int i=1;i<=n;i++)scanf(\"%lld%lld\",x+i,y+i);\n    for(int i=1;i<=n;i++)\n    {\n        s1=y[i]%mod;s2=1ll;\n        for(int j=1;j<=n;j++)if(i!=j)s1=s1*(k-x[j])%mod,s2=s2*((x[i]-x[j]%mod)%mod)%mod;\n        ans+=s1*inv(s2)%mod;ans=(ans+mod)%mod;\n    }\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1540557826,
        "uid": 43486,
        "name": "hsfzLZH1",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4781 \u3010\u3010\u6a21\u677f\u3011\u62c9\u683c\u6717\u65e5\u63d2\u503c\u3011"
    },
    {
        "content": "\u597d\u50cf\u9898\u89e3\u91cc\u90fd\u662f\u76f4\u63a5\u5e26\u8fdb\u53bb\u6c42\u503c\u4e86\uff0c\u6ca1\u6709\u628a\u7cfb\u6570\u63d2\u51fa\u6765\u7684\uff0c\u90a3\u849f\u84bb\u5c31\u653e\u4e00\u4e2a~~\u4e0d\u5f00O2\u8dd1\u4e0d\u8fc7\u7684~~\u63d2\u7cfb\u6570\u7684\u62c9\u683c\u6717\u65e5\u63d2\u503c\u5427\n\n\u4ecd\u7136\u662f\u62c9\u683c\u6717\u65e5\u57fa\u672c\u591a\u9879\u5f0f\u4e58\u4e0a\u6bcf\u4e2a$y$\u4e4b\u540e\u6c42\u548c\n\n$F(x)=\\sum\\limits_{i=1}^n(y_i\\prod_{i!=j} \\frac{x-x_j}{x_i-x_j})$\n\n\u89c2\u5bdf\u4e00\u4e0b\uff0c\u5bf9\u4e8e\u6bcf\u4e2a$i$\uff0c\u6211\u4eec\u628a\u5f0f\u5b50\u62c6\u6210\u4e24\u90e8\u5206\uff0c\u7b2c\u4e00\u90e8\u5206\u662f\n\n$y_i\\prod_{i!=j}\\frac{1}{x_i-x_j}$\n\n\u8fd9\u4e2a\u4e1c\u897f\u5bf9\u4e8e\u6bcf\u4e2a$i$\u90fd\u53ef\u4ee5\u73b0\u573a$O(n)$\u6c42\u51fa\u6765\n\n\u7b2c\u4e8c\u90e8\u5206\u662f\u6bd4\u8f83\u68d8\u624b\u7684\n\n$\\prod_{i!=j}(x-x_j)$\n\n\u5982\u679c\u6211\u4eec\u5bf9\u6bcf\u4e2a$i$\u90fd\u76f4\u63a5\u66b4\u529b\u6c42\u7684\u8bdd\u6c42\u4e00\u6b21\u5c31\u8981$O(n^2)$\uff0c\u603b\u590d\u6742\u5ea6$O(n^3)$ ~~(\u4e0d\u5982\u9ad8\u65af\u6d88\u5143)~~ \n\n\u8fd9\u91cc\u9700\u8981\u6211\u4eec\u9884\u5904\u7406\uff0c\u5373\u5148$O(n^2)$\u9884\u5904\u7406\u51fa\n\n$\\prod\\limits_{i=1}^n(x-x_i)$\n\n\u7136\u540e\u8003\u8651\u80cc\u5305\u7684\u601d\u60f3\uff0c\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e2a$i$\u5355\u72ec\u6263\u6389\u90a3\u4e2a$x-x_i$\u5373\u53ef\u3002\u73b0\u5728\u6211\u4eec\u5df2\u77e5$F'(x)=F(x)(x-x_i)$\uff0c\u8981\u6c42\u51fa$F(x)$\u3002\u505a\u6cd5\u662f\u4ece\u4f4e\u6b21\u5411\u9ad8\u6b21\u4f9d\u6b21\u8fd8\u539f\uff0c\u811a\u52a8\u6a21\u62df\u591a\u9879\u5f0f\u9664\u6cd5\u3002\u5c31\u662f\u8bf4(\u4e0b\u9762\u7528$F(x)_j$\u8868\u793a$F(x)$\u7684$j$\u6b21\u9879\u7684\u7cfb\u6570)\n\n$F(x)_j=-(F'(x)_j-F(x)_{j-1})/x_i,F(x)_0=-F'(x)_0/x_i$\n\n\u6700\u540e\u628a\u5bf9\u4e8e\u6bcf\u4e2a$i$\u6c42\u51fa\u6765\u7684\u591a\u9879\u5f0f\u6c42\u4e2a\u548c\u5c31\u53ef\u4ee5\u4e86\uff0c~~\u56e0\u4e3a\u53d6\u6a21\u8fc7\u591a\u7b49\u539f\u56e0\u8dd1\u7684\u975e\u5e38\u6162\uff0c\u4e0d\u5f00O2\u53ea\u5f9780pts\uff0c\u867d\u7136\u7406\u8bba\u590d\u6742\u5ea6\u662f\u548c\u76f4\u63a5\u63d2\u51fa\u503c\u6765\u7684\u505a\u6cd5\u4e00\u6837\u7684=\u3002=~~\n\nUpd on 2019.3.27\uff1a\n\n\u7701\u9009\u524d\u590d\u4e60\u7684\u65f6\u5019\u770b\u5230\u4e86\u81ea\u5df1\u5199\u7684\u9898\u89e3\uff0c\u53d1\u73b0\u81ea\u5df1\u539f\u6765\u5199\u7684\u65f6\u5019\u6c99\u8336\u4e86\uff0c\u5c45\u7136\u6bcf\u6b21\u90fd\u73b0\u573a\u6c42\u9006\u5143\u3002\u3002\u3002\u3002\u3002\u3002\u5148\u9884\u5904\u7406\u9006\u5143\u5c31\u6ca1\u4e8b\u4e86\n\n\u611f\u8c22@xzy_test\u7684\u63d0\u9192\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define O 1ll\nusing namespace std;\nconst int N=2005,mod=998244353;\nint n,k,x[N],y[N],num[N],tmp[N],res[N],inv[N];\nvoid Add(int &x,int y)\n{\n    x+=y;\n    if(x>=mod) x-=mod;\n}\nvoid exGCD(int a,int b,int &x,int &y)\n{\n    if(!b) x=1,y=0;\n    else exGCD(b,a%b,y,x),y-=a/b*x;\n}\nint Inv(int x)\n{\n    int xx,yy;\n    exGCD(x,mod,xx,yy);\n    Add(xx,mod); return xx;\n}\nvoid Lagrange()\n{\n    for(int i=1;i<=n;i++)\n    {\n        int den=1,lst=0;\n        for(int j=1;j<=n;j++)\n            if(i!=j) den=O*den*(x[i]-x[j]+mod)%mod;\n        den=O*y[i]*Inv(den)%mod;\n        for(int j=0;j<n;j++)\n        {\n            tmp[j]=O*(num[j]-lst+mod)*inv[i]%mod;\n            Add(res[j],O*den*tmp[j]%mod),lst=tmp[j];\n        }\n    }\n}\nvoid Pre()\n{\n    num[0]=1;\n    for(int i=1;i<=n;swap(num,tmp),i++)\n    {\n        tmp[0]=0; inv[i]=Inv(mod-x[i]);\n        for(int j=1;j<=i;j++) tmp[j]=num[j-1];\n        for(int j=0;j<=i;j++) Add(tmp[j],O*num[j]*(mod-x[i])%mod);\n    }\n}\nint Calc(int x)\n{\n    int ret=0,var=1;\n    for(int i=0;i<n;var=O*var*x%mod,i++)\n        Add(ret,O*var*res[i]%mod);\n    return ret;\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&k);\n    for(int i=1;i<=n;i++)\n        scanf(\"%d%d\",&x[i],&y[i]);\n    Pre(),Lagrange(),printf(\"%d\",Calc(k));\n    return 0;\n}\n```",
        "postTime": 1550662999,
        "uid": 56967,
        "name": "ydnhaha",
        "ccfLevel": 0,
        "title": "\u62c9\u683c\u6717\u65e5\u63d2\u503c\u53ea\u63d2\u51fa\u591a\u9879\u5f0f"
    },
    {
        "content": "$(n+1)$ \u4e2a\u6a2a\u5750\u6807\u4e0d\u540c\u7684\u70b9\u53ef\u4ee5\u552f\u4e00\u786e\u5b9a\u4e00\u4e2a $n$ \u6b21\u591a\u9879\u5f0f\uff0c\u5047\u5982\u77e5\u9053\u7b54\u6848\u662f\u4e2a\u5173\u4e8e\u67d0\u4e2a\u503c\u7684\u591a\u9879\u5f0f\u4ee5\u53ca\u5176\u9879\u6570\u548c\u82e5\u5e72\u4e2a\u70b9\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u62c9\u683c\u6717\u65e5\u63d2\u503c\u51fa\u591a\u9879\u5f0f\uff0c\u7b97\u51fa\u7b54\u6848\u3002\n\n\u7b80\u5355\u6765\u8bb2\uff0c\u6211\u4eec\u9700\u8981\u6784\u9020\u4e00\u4e2a $n$ \u6b21\u591a\u9879\u5f0f\uff0c\u4f7f\u5f97\u5b83\u6ee1\u8db3\u5728\u5df2\u77e5\u7684\u70b9 $x_i$ \u5904\u53d6\u503c\u4e3a $y_i$\u3002\n\n\u6784\u9020 $f_i(x)$\uff0c\u4f7f\u5f97\u5176\u4ec5\u5728 $x_i$ \u5904\u53d6\u503c\u4e3a $1$\uff0c\u5176\u4ed6 $x_j,j\\neq i$ \u5904\u53d6\u503c\u4e3a $0$\u3002\n\n\u90a3\u4e48 $y_if_i(x)$ \u4ec5\u5728 $x_i$ \u5904\u53d6\u503c\u4e3a $y_i$\uff0c\u5176\u4ed6 $x_j,j\\neq i$ \u5904\u53d6\u503c\u4e3a $0$\u3002\n\n\u5bf9 $y_if_i(x)$ \u6c42\u548c\u5373\u5f97\u5230\u4e86\u6211\u4eec\u8981\u6c42\u7684\u591a\u9879\u5f0f\uff1a\u5728 $x_i$ \u5904\u53d6\u503c\u4e3a $y_i$ \u7684 $n$ \u6b21\u591a\u9879\u5f0f\u3002\n\n\u5982\u4f55\u6784\u9020 $f_i(x)$\uff1f\n\n- \u5982\u679c\u8981\u5728 $x_j,j\\neq i$ \u5904\u53d6\u503c\u4e3a $0$\uff0c\u53ef\u4ee5\u8ba9 $(x-x_j),j\\neq i$ \u4e58\u8d77\u6765\uff0c\u5373\u4e3a $\\prod_{j\\neq i}(x-x_j)$\uff0c\u4e3a\u63cf\u8ff0\u65b9\u4fbf\u8bb0\u4f5c $g(x)$\uff0c\u57fa\u4e8e\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u4e0d\u7ba1\u600e\u4e48\u5bf9\u5176\u4e58\u9664\uff0c\u5728 $x_j,j\\neq i$ \u5904\u53d6\u503c\u90fd\u4e3a $0$\u3002\n\n- \u5982\u679c\u8981\u5728 $x_i$ \u5904\u53d6\u503c\u4e3a $1$\uff0c\u5219\u8ba9 $f_i(x)=\\frac{g(x)}{g(x_i)}$\uff0c\u8fd9\u6837\u5f53 $x=x_i$ \u65f6\uff0c$f_i(x_i)=\\frac{g_{x_i}}{g_{x_i}}=1$\uff0c\u6ce8\u610f\u5230 $x_i\\neq j,i\\neq j$\uff0c\u6240\u4ee5\u4e0d\u4f1a\u51fa\u73b0\u9664 $0$ \u7684\u60c5\u51b5\u3002\n\n\u7efc\u4e0a\u6240\u8ff0\uff0c\u6211\u4eec\u6784\u9020\u51fa\u4e86 $f_i(x)=\\prod_{j\\neq i}\\frac{x-x_j}{x_i-x_j}$\uff0c\u9898\u76ee\u4e2d\u6240\u6c42\u7684 $n$ \u6b21\u591a\u9879\u5f0f\u5373\u4e3a\uff1a\n\n$$\n\\begin{aligned}\n&\\sum _{i=1}^{n}y_if_i(x)\n\\\\\n&\\sum_{i=1}^ny_i\\prod_{j\\neq i}\\frac{x-x_j}{x_i-x_j}\n\\end{aligned}\n$$\n\n\u4ee3\u5165\u503c\u5230 $x$ \u4e2d\u76f4\u63a5\u5bf9\u8fd9\u4e2a\u5f0f\u5b50\u8ba1\u7b97\uff0c\u6bcf\u4e00\u6b21\u679a\u4e3e $i$ \u540e\uff0c\u6700\u540e\u4e00\u5757\u7b97\u5206\u6bcd\u7684\u9006\u5143\uff0c\u53ea\u4f1a\u7b97 $n$ \u6b21\u9006\u5143\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}(n^2)$\u3002",
        "postTime": 1625451135,
        "uid": 223298,
        "name": "do_while_true",
        "ccfLevel": 8,
        "title": "\u300c\u9898\u89e3\u300dP4781\u3010\u6a21\u677f\u3011\u62c9\u683c\u6717\u65e5\u63d2\u503c"
    },
    {
        "content": "\u770b\u90a3\u4e48\u591a\u62c9\u683c\u6717\u65e5\u63d2\u503c\u7684\u505a\u6cd5,\u6211\u6765\u4e00\u4e2a\u725b\u987f\u63d2\u503c\u7684\u505a\u6cd5\u5566w  \n\n1. \u5dee\u5546\u7684\u5b9a\u4e49\uff1a  \n   \u51fd\u6570$f(x)$\u5728\u4e24\u4e2a\u4e92\u5f02\u70b9$x_i,x_j$\u5904\u7684\u4e00\u9636\u5dee\u5546\u5b9a\u4e49\u4e3a\uff1a\n   $$\n   f\\left[x_{i}, x_{j}\\right]=\\frac{f\\left(x_{i}\\right)-f\\left(x_{j}\\right)}{x_{i}-x_{j}}\\left(i \\neq j, x_{i} \\neq x_{j}\\right)\n   $$  \n\n   \u4e8c\u9636\u5dee\u5546:  \n   $$\n   f\\left[x_{i}, x_{j}, x_{k}\\right]=\\frac{f\\left[x_{i}, x_{j}\\right]-f\\left[x_{j}, x_{k}\\right]}{x_{i}-x_{k}}(i \\neq k)\n   $$  \n\n\n\n   $k+1$\u9636\u5dee\u5546:  \n   $$\n   \\begin{aligned}\n   f\\left[x_{0}, \\ldots, x_{k+1}\\right]=\\frac{f\\left[x_{0}, x_{1}, \\ldots x_{k}\\right]-f\\left[x_{1}, \\ldots, x_{k}, x_{k+1}\\right]}{x_{0}-x_{k+1}}=\\frac{f\\left[x_{0}, \\ldots, x_{k-1}, x_{k}\\right]-f\\left[x_{0}, \\ldots, x_{k-1}, x_{k+1}\\right]}{x_{k}-x_{k+1}}\n   \\end{aligned}\n   $$  \n\n2. \u5dee\u5546\u7684\u6027\u8d28  \n   \n   ([\u53c2\u8003\u8fde\u63a5](https://blog.csdn.net/littlely_ll/article/details/71107092))  \n\n   1. $k$\u9636\u5dee\u5546\u53ef\u4ee5\u8868\u793a\u4e3a\u51fd\u6570\u503c$f(x_0),f(x_1),\\dots,f(x_k)$\u7684\u7ebf\u6027\u7ec4\u5408,\u5373  \n      $$\n      f[x_0,x_1,\\dots,x_k]=\\sum_{j=0}^{k} \\frac{f\\left(x_{j}\\right)}{\\prod_{i=0,i\\not ={j}}^{k}\\left(x_{j}-x_{i}\\right)}\n      $$  \n      \u5dee\u5546\u5177\u6709\u5bf9\u79f0\u6027,\u5373\u5dee\u5546\u4e0e\u8282\u70b9\u7684\u6392\u5217\u987a\u5e8f\u65e0\u5173.  \n   2. \u82e5\u51fd\u6570$f(x)$\u5728\u5305\u542b\u8282\u70b9\u533a\u95f4$[a,b]$\u4e0a\u5b58\u5728$k$ \u9636\u5bfc\u6570,\u5219$k$\u9636\u5dee\u5546\u4e0e\u5bfc\u6570\u7684\u5173\u7cfb\u4e3a  \n      $$  \n      f[x_0,x_1,\\dots,x_k]=\\frac{f^{(k)}(\\xi)}{k!},\\xi \\in [a,b]  \n      $$  \n\n      \u5373$k$\u6b21\u591a\u9879\u5f0f\u7684$k$\u9636\u5dee\u5546\u4e3a\u5e38\u6570,\u4f4e\u4e8e$k$\u6b21\u591a\u9879\u5f0f\u7684\u5dee\u5546\u4e3a$0$(\u63a8\u4e86\u4e00\u4f1a\u67ff\u5b50\u4e4b\u540e\u53d1\u73b0\u5bf9\u4e8e\u591a\u9879\u5f0f$A(x)=a_0+a_1x^1+\\dots+a_kx^k$,\u4ed6\u7684$k$\u9636\u5dee\u5546\u5c31\u662f$a_k$)  \n\n3. \u725b\u987f\u63d2\u503c\u591a\u9879\u5f0f  \n   1. \u725b\u987f\u63d2\u503c\u591a\u9879\u5f0f\u7684\u63a8\u5bfc  \n      $$f[x,x_0]=\\frac{f(x)-f(x_0)}{x-x_0}\\Rightarrow f(x)=f\\left(x_{0}\\right)+f\\left[x, x_{0}\\right]\\left(x-x_{0}\\right) \\ (a)$$  \n      $$f[x,x_0,x_1]=\\frac{f[x,x_0]-f[x_0,x_1]}{x-x_1}\\Rightarrow f[x,x_0]=f[x_0,x_1]+f[x,x_0,x_1](x-x_1) \\ (b)$$  \n      $$f[x,x_0,x_1,x_2] = \\frac{f[x,x_0,x_1]-f[x_0,x_1,x_2]}{x-x_2}\\Rightarrow f[x,x_0,x_1]=f[x_0,x_1,x_2]+f[x,x_0,x_1,x_2](x-x_2) \\ (c)$$  \n      $$\\dots$$  \n      $$f[x,x_0,\\dots,x_n]=\\frac{f[x,x_0,\\dots,x_{n-1}]-f[x_0,x_1,\\dots,x_n]}{x-x_n}\\Rightarrow f[x,x_0,\\dots,x_{n-1}]=f[x_0,x_1,\\dots,x_n]+f[x,x_0,x_1,\\dots,x_n](x-x_n) \\ (d)$$  \n      \u7136\u540e\u6211\u4eec\u7531$a,b,c,d$\u67ff\u5b50\u53ef\u4ee5\u5f97\u5230  \n      $$f(x)=f\\left(x_{0}\\right)+f\\left[x, x_{0}\\right]\\left(x-x_{0}\\right)$$  \n      $$f[x,x_0]=f[x_0,x_1]+f[x,x_0,x_1](x-x_1)$$  \n      $$f[x,x_0,x_1]=f[x_0,x_1,x_2]+f[x,x_0,x_1,x_2](x-x_2)$$  \n      $$\\dots$$  \n      $$f[x,x_0,\\dots,x_{n-1}]=f[x_0,x_1,\\dots,x_n]+f[x,x_0,x_1,\\dots,x_n](x-x_n)$$  \n      \u6211\u4eec\u4ece\u4e0a\u5230\u4e0b\u628a\u67ff\u5b50\u5206\u522b\u6807\u4e3a$(1),(2),\\dots,(n)$\u67ff,\u7136\u540e\u6211\u4eec\u53d1\u73b0  \n      $$(1)+(x-x_0) \\times (2) +(x-x_0) \\times (x-x_1) \\times ( 3 ) + \\dots + (x-x_0)\\times \\dots \\times (x-x_{n-1}) \\times (n + 1)$$  \n      $$\\Rightarrow f(x)=f(x_0)+f[x_0,x_1](x-x_0)+f[x_0,x_1,x_2](x-x_0)(x-x_1)+\\dots+f[x_0,\\dots,x_n](x-x_0)\\dots(x-x_{n-1})$$  \n      $$+f\\left[x, x_{0}, \\ldots, x_{n}\\right]\\left(x-x_{0}\\right) \\ldots\\left(x-x_{n-1}\\right)\\left(x-x_{n}\\right)$$\n      \u7136\u540e\u6211\u4eec\u628a\u8fd9\u4e2a\u5927\u67ff\u5b50\u7684\u4e0a\u8fb9\u7684\u90e8\u5206\u79f0\u4e3a\u725b\u987f\u63d2\u503c\u516c\u5f0f$N_n(x)$,\u4e0b\u8fb9\u7684\u90e8\u5206\u79f0\u4e3a\u63d2\u503c\u4f59\u9879$R_n(x)$(\u61d2\u5f97\u5199latex\u4e86\u76f4\u63a5\u6254\u56fe\u4e86)    \n      ![1e37ef766fec2a86f6d42d8cffd06ff4](https://picbeddd.oss-cn-qingdao.aliyuncs.com/img/1e37ef766fec2a86f6d42d8cffd06ff4.png)   \n   2. \u6c42\u503c  \n      \u8bf4\u4e86\u8fd9\u4e48\u591a,\u6211\u4eec\u6765\u8003\u8651\u600e\u4e48\u4f7f\u7528\u8fd9\u4e2a\u73a9\u610f\u6c42\u591a\u9879\u5f0f\u7684\u63d2\u503c.\u6211\u4eec\u53d1\u73b0,\u5bf9\u4e8e\u7ed9\u5b9a\u7684$n$\u4e2a\u70b9,\u6211\u4eec\u53ef\u4ee5\u5728$O(n^2)$\u7684\u590d\u6742\u5ea6\u5185\u9012\u63a8\u51fa\u4ed6\u4eec\u7684\u5dee\u5546.\u800c\u5bf9\u4e8e\u6c42\u503c\u6765\u8bf4,\u6211\u4eec\u53d1\u73b0\u4e5f\u53ef\u4ee5\u5728$O(n^2)$\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u6c42\u51fa.\u5373\u9996\u5148\u8981\u9012\u63a8\u51fa$(x-x_0)\\times(x-x_1)\\times \\dots \\times (x-x_n)$\u7136\u540e\u518d\u7528\u6211\u4eec\u4e4b\u524d\u9884\u5904\u7406\u7684\u5dee\u5546\u76f8\u4e58\u518d\u6c42\u548c\u5373\u53ef.  \n   3. \u4ee3\u7801  \n      ```cpp\n      #include <iostream>\n      #include <cstdlib>\n      #define int long long\n      #define HA 998244353\n \n      using namespace std;\n\n      int count , num;\n      int dataX[2005];\n      int lovivd[2005][2005];\n\n      int ksm ( int x , int y ) {\n\t      long long tmp = 1;\n\t      while ( y ) {\n\t\t      if ( y & 1 ) \n\t\t\t      tmp = 1ll * tmp * x % HA;\n\t\t         x = 1ll * x * x % HA;\n\t\t         y >>= 1;\n\t         }\n\t         return tmp % HA;\t\n      } \n      void init(){\n         double x , y;\n         cin >> count >> num;\n         for ( int i = 0 ; i < count ; i++ ) {\n            cin >> x >> y;\n            dataX[i] = x;\n            lovivd[i][0] = y;\n         }\n         return;\n      }\n      void pre () {\n         int dis = 1;\n         for ( int i = 0 ; i < count ; i++ ) {\n            for ( int j = i ; j < count ; j++ ) {\n               int tmp = ( ( lovivd[j + 1][i] - lovivd[j][i]  )  * ksm ( dataX[j+1] - dataX[j + 1 - dis] , HA - 2 ) )%HA;\n               lovivd[j + 1][i + 1] = tmp;\n            }\n            dis += 1;\n         }\n         return;\n      }\n\n      int work() {\n         long long calcValue = 0,temp = 1;\n         for ( int i = 0 ; i < count ; i++ ) {\n            temp = 1;\n            for ( int j = 0 ; j < i ; j++ )\n               temp = 1ll * temp * ( num - dataX[j] + HA ) % HA;\n            temp = 1ll * temp % HA * lovivd[i][i] % HA;\n            calcValue = ( calcValue + temp + HA ) % HA;\n         }\n         return calcValue;\n      }\n \n      signed main(){\n         init();\n         pre();\n         cout << work () <<endl;\n         return 0;\n      }\n      ```",
        "postTime": 1604823877,
        "uid": 54047,
        "name": "\u516e\u6c34XiShui\u4e36",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4781 \u3010\u3010\u6a21\u677f\u3011\u62c9\u683c\u6717\u65e5\u63d2\u503c\u3011"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/e-e-thinker/p/13394015.html)\n\n# \u7b80\u4ecb\n\n\u5728\u6570\u503c\u5206\u6790\u4e2d\uff0c\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u662f\u4ee5\u6cd5\u56fd18\u4e16\u7eaa\u6570\u5b66\u5bb6\u7ea6\u745f\u592b\u00b7\u62c9\u683c\u6717\u65e5\u547d\u540d\u7684\u4e00\u79cd\u591a\u9879\u5f0f\u63d2\u503c\u65b9\u6cd5\u3002\u5982\u679c\u5bf9\u5b9e\u8df5\u4e2d\u7684\u67d0\u4e2a\u7269\u7406\u91cf\u8fdb\u884c\u89c2\u6d4b\uff0c\u5728\u82e5\u5e72\u4e2a\u4e0d\u540c\u7684\u5730\u65b9\u5f97\u5230\u76f8\u5e94\u7684\u89c2\u6d4b\u503c\uff0c\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a\u591a\u9879\u5f0f\uff0c\u5176\u6070\u597d\u5728\u5404\u4e2a\u89c2\u6d4b\u7684\u70b9\u53d6\u5230\u89c2\u6d4b\u5230\u7684\u503c\u3002\u4e0a\u9762\u8fd9\u6837\u7684\u591a\u9879\u5f0f\u5c31\u79f0\u4e3a\u62c9\u683c\u6717\u65e5\uff08\u63d2\u503c\uff09\u591a\u9879\u5f0f\u3002\n\n# \u9898\u76ee\u5927\u610f\n\n\u7ed9\u51fa$n$\u4e2a\u70b9\uff0c\u5c06\u8fc7\u8fd9$n$\u4e2a\u70b9\u7684\u6700\u591a$n-1$\u6b21\u7684\u591a\u9879\u5f0f\u8bb0\u4e3a$f$$\\left(x\\right)$\uff0c\u6c42$f$$\\left(k\\right)$\u7684\u503c\u3002\n\n# \u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\n\n\u4e00\u4e2a\u6700\u663e\u7136\u7684\u601d\u8def\u5c31\u662f\u76f4\u63a5\u9ad8\u65af\u6d88\u5143\u6c42\u51fa\u591a\u9879\u5f0f\u7684\u7cfb\u6570\uff0c\u4f46\u662f\u8fd9\u6837\u505a\u590d\u6742\u5ea6\u5de8\u5927$O\\left(n^3\\right)$\u4e14\u6839\u636e\u7b97\u6cd5\u5b9e\u73b0\u4e0d\u540c\u5f80\u5f80\u4f1a\u5b58\u5728\u7cbe\u5ea6\u95ee\u9898\u3002\n\n\u800c\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u53ef\u4ee5\u5728$O\\left(n^2\\right)$\u7684\u590d\u6742\u5ea6\u5185\u5b8c\u7f8e\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\u3002\n\n\u5982\u56fe\u6240\u793a\uff0c\u5c06\u6bcf\u4e00\u4e2a\u70b9$\\left(x_i,y_i\\right)$\u5728$x$\u8f74\u4e0a\u7684\u6295\u5f71$\\left(x_i,0\\right)$\u8bb0\u4e3a$H_i$\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$i$\uff0c\u6211\u4eec\u9009\u62e9\u4e00\u4e2a\u70b9\u96c6$\\{P_i\\}\\cup\\{H_j|1\\le i\\le n,j\\ne i\\}$\uff0c\u4f5c\u8fc7\u8fd9$n$\u4e2a\u70b9\u7684\u81f3\u591a$n-1$\u6b21\u7684\u7ebf$g_i\\left(x\\right)$\u3002\u56fe\u4e2d$f\\left(x\\right)$\u7528\u9ed1\u7ebf\u8868\u793a\uff0c$g_i\\left(x\\right)$\u7528\u5f69\u8272\u7ebf\u8868\u793a\u3002\n\n![](https://img2020.cnblogs.com/blog/1777194/202007/1777194-20200728220100599-312404923.png)\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u5f97\u5230\u4e86$n$\u4e2a$g_i\\left(x\\right)\\left(1\\le i\\le n\\right)$\uff0c**\u5b83\u4eec\u90fd\u5728\u5404\u81ea\u5bf9\u5e94\u7684$x_i$\u5904\u7684\u503c$y_i$\u4e3a\uff0c\u5e76\u4e14\u5728\u5176\u5b83$x_j\\left(j\\ne i\\right)$\u5904\u503c\u4e3a$0$**\u3002\u6240\u4ee5\u5f88\u5bb9\u6613\u6784\u9020\u51fa$g_i\\left(x\\right)$\u7684\u8868\u8fbe\u5f0f\uff1a\n\n$$g_i\\left(x\\right)=y_i\\prod\\limits_{j\\ne i}\\frac{x-x_j}{x_i-x_j}$$\n\n\u4ee4\n$$\\ell_i\\left(x\\right)=\\prod\\limits_{j\\ne i}\\frac{x-x_j}{x_i-x_j}$$\n\n\u6bcf\u4e2a$\\ell_i\\left(x\\right)$\u5c31\u662f\u62c9\u683c\u6717\u65e5\u57fa\u672c\u591a\u9879\u5f0f\uff08\u6216\u79f0\u63d2\u503c\u57fa\u51fd\u6570\uff09\n\n**\u62c9\u683c\u6717\u65e5\u57fa\u672c\u591a\u9879\u5f0f$\\ell_i\\left(x\\right)$\u7684\u7279\u70b9\u662f\u5728$x_i$\u4e0a\u53d6\u503c\u4e3a$1$\uff0c\u5728\u5176\u4ed6\u7684\u70b9$x_j,j\\ne i$\u4e0a\u53d6\u503c\u4e3a$0$\u3002**\n\n\u6700\u540e\uff0c\u6211\u4eec\u6240\u6c42\u7684$f\\left(x\\right)=\\sum\\limits_{i=1}^ng_i\\left(x\\right)$\uff0c\u5373\u5404$g\\left(x\\right)$\u4e4b\u548c\u3002\u56e0**\u4e3a\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$i$\uff0c\u90fd\u53ea\u6709\u4e00\u6761$g_i$\u7ecf\u8fc7$P_i$\uff0c\u5176\u4f59$g_j$\u90fd\u7ecf\u8fc7$H_i$\uff0c\u6545\u5b83\u4eec\u76f8\u52a0\u540e\u5728$x_i$\u7684\u53d6\u503c\u4ecd\u4e3a$y_i$\uff0c\u5373\u6700\u540e\u7684\u548c\u51fd\u6570\u603b\u662f\u8fc7\u6240\u6709$P_i$\u7684\u3002**\n\n\u516c\u5f0f\u6574\u7406\u5373\u5f97\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\uff1a\n\n$$f\\left(x\\right)=\\sum\\limits_{i=1}^ny_i\\prod\\limits_{j\\ne i}\\frac{x-x_j}{x_i-x_j}$$\n\n\u5bf9\u4e8e\u672c\u9898\u6765\u8bf4\uff0c\u53ea\u7528\u6c42\u51fa$f\\left(k\\right)$\u7684\u503c\uff0c\u76f4\u63a5\u5e26\u5165\u516c\u5f0f\u6c42\u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6\uff1a$O\\left(n^2\\right)$\n\n Talk is cheap,show you code.\n \n```\n 1 int n, k;\n 2 int a, b, ans;\n 3 int x[N ], y[N ];\n 4 inline int ksm (int a, int b)\n 5 {\n 6     int res = 1;\n 7     while(b)\n 8     {\n 9         if(b & 1) res = res * a % P ;\n10         a = a * a % P ;\n11         b >>= 1;\n12     }\n13     return res;\n14 }\n15 inline int inv(int x)\n16 {\n17     return ksm (x, P - 2);\n18 }\n19 signed main()\n20 {\n21     read(n); read(k);\n22     for(R int i = 1; i <= n; i++) read(x[i]), read(y[i]);\n23     for(R int i = 1; i <= n; i++)\n24     {\n25         a = y[i] % P ;\n26         b = 1;\n27         for(R int j = 1; j <= n; j++)\n28         {\n29             if(i == j) continue;\n30             a = a * (k - x[j]) % P ;\n31             b = b * (x[i] - x[j]) % P ;\n32         }\n33         ans = (ans + a * inv(b) % P ) % P ;\n34     }\n35     writeln((ans + P ) % P );\n36     return 0;\n37 }\n```\n\n\n\u4f18\u70b9\u4e0e\u7f3a\u70b9\n\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u7684\u516c\u5f0f\u7ed3\u6784\u6574\u9f50\u7d27\u51d1\uff0c\u5728\u7406\u8bba\u5206\u6790\u4e2d\u5341\u5206\u65b9\u4fbf\uff0c\u7136\u800c\u5728\u8ba1\u7b97\u4e2d\uff0c\u5f53\u63d2\u503c\u70b9\u589e\u52a0\u6216\u51cf\u5c11\u4e00\u4e2a\u65f6\uff0c\u6240\u5bf9\u5e94\u7684\u57fa\u672c\u591a\u9879\u5f0f\u5c31\u9700\u8981\u5168\u90e8\u91cd\u65b0\u8ba1\u7b97\uff0c\u4e8e\u662f\u6574\u4e2a\u516c\u5f0f\u90fd\u4f1a\u53d8\u5316\uff0c\u975e\u5e38\u7e41\u7410\u3002\u8fd9\u65f6\u53ef\u4ee5\u7528\u91cd\u5fc3\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u6216\u725b\u987f\u63d2\u503c\u6cd5\u6765\u4ee3\u66ff\u3002\u6b64\u5916\uff0c\u5f53\u63d2\u503c\u70b9\u6bd4\u8f83\u591a\u7684\u65f6\u5019\uff0c\u62c9\u683c\u6717\u65e5\u63d2\u503c\u591a\u9879\u5f0f\u7684\u6b21\u6570\u53ef\u80fd\u4f1a\u5f88\u9ad8\uff0c\u56e0\u6b64\u5177\u6709\u6570\u503c\u4e0d\u7a33\u5b9a\u7684\u7279\u70b9\uff0c\u4e5f\u5c31\u662f\u8bf4\u5c3d\u7ba1\u5728\u5df2\u77e5\u7684\u51e0\u4e2a\u70b9\u53d6\u5230\u7ed9\u5b9a\u7684\u6570\u503c\uff0c\u4f46\u5728\u9644\u8fd1\u5374\u4f1a\u548c\u201c\u5b9e\u9645\u4e0a\u201d\u7684\u503c\u4e4b\u95f4\u6709\u5f88\u5927\u7684\u504f\u5dee\uff08\u5982\u4e0b\u56fe\uff09\u3002\u8fd9\u7c7b\u73b0\u8c61\u4e5f\u88ab\u79f0\u4e3a\u9f99\u683c\u73b0\u8c61\uff0c\u89e3\u51b3\u7684\u529e\u6cd5\u662f\u5206\u6bb5\u7528\u8f83\u4f4e\u6b21\u6570\u7684\u63d2\u503c\u591a\u9879\u5f0f\u3002\n\n\n\n\u91cd\u5fc3\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\n \n\n$$f\\left(x\\right)=\\sum\\limits_{i=1}^n y_i \\prod\\limits_{j\\ne i}\\frac{x-x_j}{x_i-x_j}$$\n\n$$=\\sum\\limits_{i=1}^n y_i \\frac{\\prod\\limits_{j\\ne i}\\left(x-x_j\\right)}{\\prod\\limits_{j\\ne i}\\left(x_i-x_j\\right)}$$\n\n$$=\\sum\\limits_{i=1}^n y_i \\frac{\\prod\\limits_{i=1}^n \\left(x-x_i\\right)}{\\prod\\limits_{j\\ne i}\\left(x_i-x_j\\right)*\\left(x-x_i\\right)}$$\n\n$$=\\prod\\limits_{i=1}^n \\left(x-x_i\\right)\\sum\\limits_{i=1}^n \\frac{y_i}{\\prod\\limits_{j\\ne i}\\left(x_i-x_j\\right)*\\left(x-x_i\\right)}$$\n\n\u4ee4$g=\\prod\\limits_{i=1}^n \\left(x-x_i\\right)$\n\n\u4ee4$w\\left(i\\right)=\\prod\\limits_{j\\ne i} x_i-x_j$\n\n\u90a3\u4e48\u67ff\u5b50\u53d8\u6210\n$$f\\left(x\\right)=g\\sum\\limits_{i=1}^n \\frac{y_i}{\\left(x-x_i\\right)w\\left(i\\right)}$$\n\n\u5bf9\u4e8e\u589e\u52a0\u7684\u63d2\u503c\u70b9\uff0c\u6211\u4eec\u53ea\u7528$O\\left(n\\right)$\u66f4\u65b0\u6240\u6709\u7684$w\\left(i\\right)$\u3002\n\n\u5bf9\u4e8e\u8be2\u95ee\u6c42\u503c\uff0c\u6211\u4eec\u5148$O\\left(n\\right)$\u6c42\u51fa$g$\uff0c\u7136\u540e\u518d$O\\left(n\\right)$\u5957\u516c\u5f0f\u5373\u53ef\u3002\n\n\u8bb0\u5f97\u5148\u9884\u5904\u7406\u9006\u5143\u3002\u4e0d\u7136\u767d\u9001\u4e00\u4e2a$log_2 n$\n\nTalk is cheap,show you code.\n~~~\n 1 int n, opt, x0, y0;\n 2 int x[N ], y[N ], w [N ], num ;\n 3 inline int ksm (int a, int b)\n 4 {\n 5     int res = 1;\n 6     while(b)\n 7     {\n 8         if(b & 1) res = res * a % P ;\n 9         a = a * a % P ;\n10         b >>= 1;\n11     }\n12     return res;\n13 }\n14 inline int inv(int x)\n15 {\n16     return ksm (x, P - 2); \n17 }\n18 inline void insert(int x0, int y0)\n19 {\n20     num ++;\n21     x[num ] = x0;\n22     y[num ] = y0;\n23     w [num] = 1;\n24     for(R int i = 1; i <= num - 1; i++)\n25     {\n26         w [i] = w [i] * (x[i] - x0) % P ;\n27         w [num ] = w [num ] * (x0 - x[i]) % P ;\n28     }\n29 }\n30 inline int work(int x0)\n31 {\n32     int g = 1, ans = 0;\n33     for(R int i = 1; i <= num ; i++)\n34     {\n35         if(x[i] == x0) return y[i];\n36         g = g * (x0 - x[i]) % P ;\n37     }\n38     for(R int i = 1; i <= num ; i++)\n39         ans = (ans + y[i] * inv((x0 - x[i]) * w [i])) % P ;//\u6211\u6765\u767d\u9001\n40     return (g * ans % P + P ) % P ;    \n41 }\n42 signed main()\n43 {\n44     read(n);\n45     for(R int i = 1; i <= n; i++)\n46     {\n47         read(opt);\n48         if(opt == 1)\n49         {\n50             read(x0); read(y0);\n51             x0 %= P ; y0 %= P ;\n52             insert(x0, y0);\n53         }\n54         else\n55         {\n56             read(x0);\n57             writeln(work(x0));\n58         }\n59     }\n60     return 0;\n61 }\n ~~~\n\n\u53c2\u8003\u8d44\u6599\n\n[\u62c9\u683c\u6717\u65e5\u63d2\u503c](https://oi-wiki.org/math/poly/lagrange/)\n\n[\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5](https://baike.hk.xileso.top/baike-%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E6%8F%92%E5%80%BC%E6%B3%95)",
        "postTime": 1596325487,
        "uid": 103023,
        "name": "AvA_sleeper",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4781 \u3010\u3010\u6a21\u677f\u3011\u62c9\u683c\u6717\u65e5\u63d2\u503c\u3011"
    },
    {
        "content": "### \u9898\u76ee\u7684\u610f\u601d\n\u5c31\u662f\u6709$n$\u4e2a\u70b9$P_i(x_i,y_i)$\uff0c\u8bb0\u7ecf\u8fc7\u8fd9$n$\u4e2a\u70b9\u7684\u6700\u591a$n-1$\u6b21\u591a\u9879\u5f0f\u8bb0\u4f5c$f(x)$\uff0c\u6c42$f(k)$\u7684\u503c\n\n---\n### \u5206\u6790\n\u8fd9\u4e2a\u591a\u9879\u5f0f\u51fd\u6570\u4f60\u8981\u600e\u4e48\u6765\u6784\u9020\u51fa\u6765\u5462\uff1f\n\n$Part1:$\n\n\u5f88\u663e\u7136\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u591a\u9879\u5f0f\u51fd\u6570\u4e00\u5b9a\u6709\uff1a\n\n\n\n$$ f(x)=\\sum_{i=0}^{n-1} a_ix^i$$\n\u4e0a\u9762\u7684$a_i$\u4e3a\u7cfb\u6570\uff0c$a_i$\u53ef\u4ee5\u4e3a$0$\uff0c\u6beb\u65e0\u7591\u95ee\uff0c\u5982\u679c\u5b58\u5728\u4e00\u4e2a\u51fd\u6570\u4f7f\u5f97\u6ee1\u8db3\u9898\u610f\u8981\u6c42\uff0c\u90a3\u4e48\u8fd9\u4e2a\u591a\u9879\u5f0f\u4e00\u5b9a\u53ef\u4ee5\u5199\u6210\u8fd9\u79cd\u5f62\u5f0f\u3002\u4e14**\u6ee1\u8db3\u5c06\u4efb\u610f$x_i$\u5e26\u5165\u591a\u9879\u5f0f\u5f97\u5230\u7684\u4e00\u5b9a\u4e3a$y_i$** \uff0c\u90a3\u4e48\u5f88\u7b80\u5355\u7684\u4e00\u4e2a\u66b4\u529b\u5c31\u662f\u4f60\u76f4\u63a5\u628a\u8fd9\u4e2a\u6bcf\u4e2a$x_i$\u4e0e$y_i$\u5f80\u91cc\u9762\u5e26\uff0c\u6700\u540e\u8fdb\u884c\u9ad8\u65af\u6d88\u5143\uff0c\u7136\u540e\u6c42\u51fa\u4e86\u6bcf\u4e00\u9879\u7684\u7cfb\u6570\uff0c\u7136\u540e\u8981\u6c42\u89e3$f(k)$\u7684\u65f6\u5019\u7b97\u4e00\u904d\u5c31\u5b8c\u4e8b\u4e86\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u662f$O(n^3)$\u7684,\u5bf9\u70b9\u5bf9\u7684\u9650\u5236\u5e76\u6ca1\u6709\u4efb\u4f55\u8981\u6c42\u3002\n\n$Part2:$\n\n\u8fd9\u6837\u6211\u4eec\u753b\u4e00\u4e2a\u56fe\uff0c\u628a\u6bcf\u4e00\u4e2a\u70b9$(x_i,y_i)$\u5728$x$\u8f74\u4e0a\u7684\u6295\u5f71\u70b9\uff0c\u5373\u6a2a\u5750\u6807$(x_i,0)$\u7ed9\u4fdd\u5b58\u4e0b\u6765\uff0c\u8bb0\u4f5c$H_i$\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$i$\u6211\u4eec\u9009\u62e9\u51fa\u5bf9\u5e94\u70b9$P_i$\uff0c\u5728\u8fd9\u4e0a\u9762\u753b\u4e00\u4e2a\u7ecf\u8fc7\u5b83\u7684\u66f2\u7ebf\u4e14\u8ba9\u66f2\u7ebf\u5728\u5176\u4ed6$x_i$\u4f4d\u7f6e\uff0c\u503c\u53d6\u4e3a$0$\uff0c\u7136\u540e\u7531\u5f00\u59cb\u5230\u540e\u9762\u66f2\u7ebf\u6162\u6162\u53d8\u5316,\u7136\u540e\u4f7f\u5f97\u6784\u9020\u51fa\u8fd9\u4e2a\u591a\u9879\u5f0f\u51fd\u6570$f(x)$\u3002\n\n\u662f\u4e0d\u662f\u5f88\u62bd\u8c61\uff0c\u6446\u4e00\u5f20\u793a\u4f8b\u56fe\u5982\u4e0b\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xjxcwk97.png?x-oss-pbrocess=image/resize,m_lfit,h_170,w_225)\n\n\u5982\u56fe\u6240\u793a\u9ed1\u7ebf\u7b49\u4e8e\u7684\u662f\u7ea2\u7ebf\uff0c\u7eff\u7ebf\uff0c\u84dd\u7ebf\u4e09\u7ebf\u52a0\u8d77\u6765\u3002\n\n\n~~\u4f46\u5176\u5b9e\u4f60\u73b0\u5728\u4e5f\u4e0d\u4f1a\u5f88\u660e\u767d\u6211\u5728\u8bf4\u4ec0\u4e48\uff0c\u4f46\u5176\u5b9e\u5e76\u4e0d\u91cd\u8981\uff0c\u56e0\u4e3a\u6211\u4e5f\u5f88\u4e71~~\n\n\u5c31\u4f60\u4f1a\u5f97\u5230$n$\u4e2a$g_i(x)$\u6ee1\u8db3$(1 \\leq i \\leq n)$\u4f7f\u5f97\u5728\u5bf9\u5e94\u7684$x_i$\u7684\u53d6\u503c\u4e3a$y_i$\uff0c\u90a3\u4e48\u4f60\u6784\u9020\u51fa\u6765\u7684$g_i(x)$\u8868\u8fbe\u5f0f\u5e94\u8be5\u5c31\u662f\u50cf\u4e0b\u9762\u8fd9\u6837\u7684:\n\n\n\n $$g_i(x)=y_i \\prod_{j!=i} \\frac{(x-x_j)}{(x_i-x_j)}  $$\n \n \n\u8fd9\u4e2a\u662f\u6b63\u786e\u7684\uff0c\u9996\u5148\u4f60\u53ef\u4ee5\u77e5\u9053$f(x)=\\sum_{i=1}^{n}gi(x)$\uff0c\u4f60\u628a\u6bcf\u4e00\u4e2a$x_i$\u5e26\u5165\u90fd\u53ef\u4ee5\u53d1\u73b0\uff0c\u5728\u5176\u4ed6\u5730\u65b9\uff0c\u5b83\u7684\u53d6\u503c\u90fd\u4e3a0,\u800c\u5f53\u5b83\u5728$x_i$\u4f4d\u7f6e\u65f6\u53ef\u4ee5\u53d6\u5230$y_i$ ,\u6240\u4ee5\u76f8\u52a0\u540e$x_i$\u7684\u53d6\u503c\u4e3a$y_i$\uff0c\u6240\u4ee5\u6700\u540e\u6ee1\u8db3\u7ecf\u8fc7\u70b9\u96c6$P$,\u6240\u4ee5\u516c\u5f0f\u5c31\u4e3a:\n\n$$ f(x)=\\sum_{i=1}^{n}y_i\\prod_{j!=i}    \\frac{(x-x_j)}{(x_i-x_j)}$$\n$$f(x)=\\sum_{i=1}^ny_ig_i(x)$$\n\n\u7136\u540e\uff0c\u5c31\u53ef\u4ee5\u7528\u66b4\u529b\u8fdb\u884c\u626b\uff0c\u5728$O(n^2)$\u7684\u65f6\u95f4\u6c42\u51fa\u6240\u6709\u7cfb\u6570\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u8fdb\u884c\u8ba1\u7b97\u4e86\uff0c\u4e0d\u8fc7\u6211\u662f\u6309\u7167$OI-Wiki$\u4e0a\u6ca1\u7b97\u7cfb\u6570\uff0c\u76f4\u63a5\u5c06$k$\u5e26\u8fdb\u53bb\u7b97\u7684\u3002\n\n\u7136\u540e\u8fd9\u9053\u9898\u662f\u9700\u8981\u8fdb\u884c\u9006\u5143\u7684\u6c42\u89e3\u7684\uff0c\u76f8\u4fe1\u8fd9\u4e2a\u5e94\u8be5\u90fd\u4f1a\uff0c\u4e0d\u4f1a\u7684\u53ef\u4ee5\u6eda\u7c97\u4e86\uff0c\u7528\u5feb\u901f\u5e42\u6c42\u89e3\uff0c\u5148\u540c\u65f6\u5206\u522b\u8ba1\u7b97\u5206\u5b50$s1$\uff0c\u5206\u6bcd$s2$\uff0c\u6700\u540e\u8ba9$ s1=s1*power(s2,p-2) $\u8fd9\u91cc\u7684$power$\u4e3a\u5feb\u901f\u5e42\uff0c$p$\u4e3a\u6a21\u6570\u3002\u7136\u540e\u5728$log$\u7684\u65f6\u95f4\u5b8c\u6210\uff0c\u8fd9\u4e00\u6b65\u590d\u6742\u5ea6\u603b\u4f53\u4e3a$O(nlog(p-2))$\uff0c\u6240\u4ee5\u603b\u4f53\u590d\u6742\u5ea6\u4e3a$O(n^2)$,\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u7528\u7ebf\u6027\u6c42\u9006\u5143\uff0c\u505a\u5f97\u66f4\u4e25\u683c\u3002\n\n\u793a\u4f8b\u4ee3\u7801\uff1a\n```cpp\n    for(int i=1;i<=n;i++){\n\tint a=y[i]%p;\n\tint b=1;\n\tfor(int j=1;j<=n;j++){\n\t\tif(i==j) continue;\n\t\ta=a*(k-x[j])%p;\n\t\tb=b*(x[i]-x[j])%p;\n\t}\n\tans=(ans+a*power(b,p-2)%p+p)%p;\n     }\n```\n\n$Part 3:$\n\n\u8fd9\u662f\u4e00\u79cd\u5bf9\u70b9\u5bf9\u6709\u7279\u6b8a\u8981\u6c42\u7684\u65b9\u6cd5\uff0c**\u5f53\u4e14\u4ec5\u5f53$x_i=i$\u65f6\u9002\u7528**\uff0c\u8fd9\u53eb\u5dee\u5206\u6cd5\u3002\u9996\u5148\u4f60\u53ef\u4ee5\u628a$x_i=i$\u5e26\u5165\u4e4b\u524d\u7684\u516c\u5f0f\u4e2d\u53bb\u5219\u6709\u4e86\uff1a\n$$f(x)=\\sum_{i=1}^ny_i\\prod_{j!=i}\\frac{(x-j)}{(j-i)}$$\n$$f(x)=\\sum_{i=1}^ny_i\\frac{\\prod_{j!=i}(x -j)}{\\prod_{j!=i}(i -j)}$$\n\u5bf9\u4e8e\u5206\u5b50\uff0c\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u5904\u7406\u51fa\u5982\u4e0b\u4e24\u4e2a\u4e1c\u897f:\n$$pre_i=\\prod_{j=1}^{i} (x-j)$$\n$$suf_i=\\prod_{j=i}^{n} (x-j)$$\n\u4e0d\u96be\u53d1\u73b0\u5206\u5b50\u5373\u4e3a:\n$$pre_{i-1}*suf_{i+1}$$\n\u5bf9\u4e8e\u5206\u6bcd\uff0c\u81ea\u5df1\u5c55\u5f00\u4e00\u4e0b\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u662f\u4e00\u4e2a\u65ad\u5f00\u4e86\u7684\u9636\u4e58\u5f62\u52bf\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u7528$fac_i$\u8868\u8fbe$i!$,\u4f46\u8fd9\u91cc\u6211\u4eec\u53d1\u73b0\u4e00\u4ef6\u4e8b\uff0c\u8fd9\u4e2a\u6700\u540e\u4e58\u51fa\u6765\uff0c**\u5f53\u4e14\u4ec5\u5f53$n-i$\u4e3a\u5947\u6570\u65f6**\uff0c\u8fd9\u4e2a\u7b26\u53f7\u8981\u7ed9\u5b83**\u52a0\u4e2a\u8d1f\u53f7**\uff0c\u90a3\u4e48\u5206\u6bcd\u7684\u8868\u8fbe\u5f0f\u5373\u4e3a\uff1a\n$$fac_i*fac_{n-i}$$\n\n\u6700\u540e\u5f97\u51fa\u7ed3\u8bba\uff1a\n$$f(x)=\\sum_{i=1}^ny_i\\frac{pre_{i-1}\\times suf_{i+1}}{fac_{i} \\times fac_{n-i}}$$\n\u6ce8\u610f\u6b63\u8d1f\u7684\u7279\u5224\uff0c\u590d\u6742\u5ea6\u662f\u7ebf\u6027\u7684\n\n\u4ee3\u7801\u5148\u5495\u4e00\u6ce2\uff0c\u5e74\u524d\u8865\u4e0a\u3002\n\n$Part 4:$\n\n\u5173\u4e8e\u62c9\u683c\u6717\u65e5\u63d2\u503c\u516c\u5f0f\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u70b9\u88ab\u6211\u52a0\u5165\u8fdb\u6765\uff0c\u90a3\u4e48\u6211\u5c31\u9700\u8981\u91cd\u65b0\u8ba1\u7b97\u4e00\u904d\u7cfb\u6570\uff0c\u5982\u679c\u6709$n$\u4e2a\u70b9\u5f85\u52a0\u5165\uff0c\u90a3\u4e48\u590d\u6742\u5ea6\u5c31\u662f$O(n^3)$\u7684\u3002\u4e8e\u662f\uff0c\u6709\u8fd9\u4e48\u4e00\u4e2a\u4e1c\u897f\uff0c\u53eb\u505a\u91cd\u5fc3\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u3002\n\u9996\u5148\u6211\u4eec\u5f00\u59cb\u5bf9\u5f0f\u5b50\u8fdb\u884c\u7b80\u5316:\n$$f(x)=\\sum_{i=1}^ny_i\\frac{\\prod_{j!=i}(x -x_j)}{\\prod_{j!=i}(x_i -x_j)}$$\n\n$$f(x)=\\sum_{i=1}^ny_i\\frac{\\prod_{j=1}^n (x -x_j)}{\\prod_{j!=i}(x_i -x_j)*(x-x_i)}$$\n\u4ee4$\\omega(i)=\\prod_{j!=i}(x_i -x_j)$\n$$f(x)=\\prod_{i=1}^n(x-x_i)\\sum_{i=1}^n\\frac{y_i}{(x-x_i)\\omega(i)}$$\n\u90a3\u4e48\u6bcf\u6b21\u66f4\u65b0\u65f6\uff0c\u4f60\u53ea\u9700\u8981\u66f4\u65b0\u6240\u6709\u7684$\\omega(i)$\u5c31\u5b8c\u4e8b\u4e86\uff0c\u590d\u6742\u5ea6\u4e3a\u7ebf\u6027\u7684\u3002\n\n\u4ee3\u7801\u5148\u5495\u4e00\u6ce2\uff0c\u5e74\u524d\u8865\u4e0a\u3002\n\n\u5f15\u7528\u8d44\u6599\uff1a\n\n[OI-wiki](https://oi-wiki.org/math/poly/lagrange/)\n\n[\u5927\u4f6c\u535a\u5ba2](https://www.luogu.com.cn/blog/attack/solution-p4781)\n\n[\u5927\u4f6c\u535a\u5ba2](https://www.luogu.com.cn/blog/e-e-thinker/solution-p4781)",
        "postTime": 1611936747,
        "uid": 206021,
        "name": "Pitiless0514",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4781 \u3010\u3010\u6a21\u677f\u3011\u62c9\u683c\u6717\u65e5\u63d2\u503c\u3011"
    },
    {
        "content": "### Description\n\n\u7ed9\u5b9a\u591a\u9879\u5f0f $f(x)$ \u4e0a\u7684 $k$ \u4e2a\u70b9 $(x_i,y_i)$\uff0c\u8bd5\u786e\u5b9a\u8fd9\u4e2a\u591a\u9879\u5f0f\u3002\n\n------------\n\n### \u591a\u9879\u5f0f\u7684\u7cfb\u6570\u8868\u793a\u6cd5\n\n\u4f17\u6240\u5468\u77e5\u4e00\u4e2a $k$ \u6b21\u591a\u9879\u5f0f\u53ef\u4ee5\u88ab\u5b83\u7684 $k+1$ \u4e2a\u7cfb\u6570\u552f\u4e00\u5730\u786e\u5b9a\uff0c\u5373\uff1a\n\n$$\nf(x)=\\sum_{i=0}^ka_ix^i\n$$\n\n\u8fd9\u79cd\u786e\u5b9a\u591a\u9879\u5f0f\u7684\u65b9\u6cd5\u53eb\u505a\u591a\u9879\u5f0f\u7684**\u7cfb\u6570\u8868\u793a\u6cd5**\u3002\n\n------------\n\n### \u591a\u9879\u5f0f\u7684\u70b9\u503c\u8868\u793a\u6cd5\n\n\u8fd8\u662f\u4f17\u6240\u5468\u77e5\uff0c\u4e00\u4e2a $k$ \u6b21\u591a\u9879\u5f0f\u540c\u6837\u53ef\u4ee5\u88ab\u5176\u56fe\u50cf\u4e0a\u7684 $k+1$ \u4e2a\u70b9\u6240\u552f\u4e00\u5730\u786e\u5b9a\u3002\n\n\u5176\u4e2d\u7684\u9053\u7406\u4e0d\u96be\u8bb2\uff1a\u8bbe\u8fd9\u4e2a\u591a\u9879\u5f0f\u4e3a\n\n$$\nf(x)=\\sum_{i=0}^{k}a_ix^i\n$$\n\n\u90a3\u4e48\uff0c\u5982\u679c\u6211\u4eec\u6709\u4e86\u8fd9\u4e2a\u591a\u9879\u5f0f\u4e0a\u7684 $k+1$ \u4e2a\u70b9 $(x_1,y_1),(x_2,y_2),\\cdots,(x_{k+1},y_{k+1})$\uff0c\u5c31\u76f8\u5f53\u4e8e\u6709\u4e86\u4e00\u4e2a $k+1$ \u6b21\u65b9\u7a0b\u7ec4\uff1a\n\n$$\n\\begin{cases}\na_0+a_1x_1+a_2x_1^2+\\cdots+a_kx_1^k&=&y_1\\\\\na_0+a_1x_2+a_2x_2^2+\\cdots+a_kx_2^k&=&y_2\\\\\n\\cdots&\\cdots&\\cdots\\\\\na_0+a_1x_{k+1}+a_2x_{k+1}^2+\\cdots+a_kx_{k+1}^{k}&=&y_{k+1}\n\\end{cases}\n$$\n\n\u8fd9\u662f\u4e00\u4e2a\u7531 $k+1$ \u6761 $k+1$ \u5143\u4e00\u6b21\u65b9\u7a0b\u7ec4\u6210\u7684\u4e00\u4e2a\u65b9\u7a0b\u7ec4\uff0c\u5e76\u4e14\u4e0d\u96be\u8bc1\u660e\u5728\u8fd9 $k+1$ \u6761\u65b9\u7a0b\u4e2d\uff0c\u4e0d\u5b58\u5728\u4e24\u4e2a\u7b49\u4ef7\u7684\u65b9\u7a0b\u3002\n\n\u56e0\u6b64 $a_0,a_1,a_2,\\cdots,a_{k}$ \u8fd9 $k+1$ \u4e2a\u672a\u77e5\u6570\u53ef\u4ee5\u88ab\u552f\u4e00\u5730\u89e3\u51fa\u6765\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9 $k+1$ \u4e2a\u70b9\u540c\u6837\u552f\u4e00\u5730\u786e\u5b9a\u4e86\u591a\u9879\u5f0f\n\n$$\nf(x)=\\sum_{i=0}^{k}a_ix^i\n$$\n\n\u8fd9\u79cd\u786e\u5b9a\u591a\u9879\u5f0f\u7684\u65b9\u6cd5\u53eb\u505a**\u70b9\u503c\u8868\u793a\u6cd5**\u3002\n\n------------\n\n### \u7cfb\u6570\u8868\u793a\u6cd5\u8f6c\u70b9\u503c\u8868\u793a\u6cd5\n\n\u76f4\u63a5\u7b97\u3002\u7565\u3002\n\n------------\n\n### \u70b9\u503c\u8868\u793a\u6cd5\u8f6c\u7cfb\u6570\u8868\u793a\u6cd5\n\n\u9996\u5148\u7531\u4e4b\u524d\u7684\u63a8\u5bfc\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u53d1\u5148\u8f6c\u6362\u7684\u8fc7\u7a0b\u5b9e\u9645\u4e0a\u5c31\u662f\u89e3\u4e00\u4e2a $k+1$ \u5143\u4e00\u6b21\u65b9\u7a0b\u7ec4\u3002\n\n\u56e0\u6b64\u53ef\u4ee5\u5229\u7528[\u9ad8\u65af\u6d88\u5143](https://www.luogu.com.cn/problem/P3389)\u5728 $O(k^3)$ \u7684\u65f6\u95f4\u5185\u6c42\u89e3\u65b9\u7a0b\uff0c\u786e\u5b9a\u5176\u7cfb\u6570\u3002\n\n\u6211\u4eec\u518d\u6765\u770b $O(k^2)$ \u7684\u62c9\u683c\u6717\u65e5\u63d2\u503c\u3002\n\n\u9996\u5148\u6709\u4e00\u4e2a\u7ed3\u8bba\uff1a\n\n$$\nf(x)\\equiv f(a)\\quad(\\bmod(x-a))\n$$ \n\n\u8fd9\u662f\u56e0\u4e3a\u5f53 $x=a$ \u65f6\uff0c\u6709 $f(x)-f(a)=0$\u3002\n\n\u90a3\u4e48\u7531\u6211\u4eec\u521d\u4e2d\u5c31\u5b66\u8fc7\u7684\u56e0\u5f0f\u5b9a\u7406\uff0c\u5c31\u6709 $f(x)-f(a)\\equiv0(\\bmod(x-a))$\uff0c\u5373 $f(x)\\equiv f(a)\\quad(\\bmod(x-a))$\u3002\n\n\u5206\u522b\u5c06 $a$ \u53d6 $x_1,x_2,\\cdots,x_{k+1}$ \uff0c\u90a3\u4e48 $f(a)$ \u5c31\u53d6\u904d\u4e86 $y_1,y_2,\\cdots,y_{k+1}$\u3002\n\n\u56e0\u6b64\u5c31\u5f97\u5230\u4e00\u4e2a\u5173\u4e8e $f(x)$ \u7684\u65b9\u7a0b\u7ec4\uff1a\n\n$$\n\\begin{cases}\nf(x)\\equiv y_1(\\bmod\\ (x-x_1))\\\\\nf(x)\\equiv y_2(\\bmod\\ (x-x_2))\\\\\n\\cdots\\\\\nf(x)\\equiv y_{k+1}(\\bmod\\ (x-x_{k+1}))\n\\end{cases}\n$$\n\n\u53d1\u73b0\u8fd9\u4e2a\u5f62\u5f0f\u5f88\u50cf \u4e2d\u56fd\u5269\u4f59\u5b9a\u7406 \u5bf9\u4e0d\u5bf9qwq\n\n\u56de\u5fc6\u4e00\u4e0b\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u7684\u8fc7\u7a0b\uff1a\n\n1. \u8ba1\u7b97\u6240\u6709\u6a21\u6570\u7684\u79ef $\\text{Mul}=\\prod\\limits_{i=1}^{k+1}(x-x_i)$\u3002\n\n2. \u5bf9\u6bcf\u4e2a\u6a21\u6570\uff0c\u8ba1\u7b97 $m_i=\\dfrac{\\text{Mul}}{(x-x_i)}=\\prod\\limits_{i\\neq j}(x-x_j)$\u3002\n\n3. \u8ba1\u7b97 $m_i$ \u5728\u6a21\u7b2c $i$ \u4e2a\u6a21\u6570 $(x-x_i)$ \u610f\u4e49\u4e0b\u7684\u9006\u5143\uff1a$m_i^{-1}=\\prod\\limits_{i\\neq j}\\dfrac{1}{x_i-x_j}$\n\n4. \u8ba1\u7b97 $c_i=m_im_i^{-1}=\\prod\\limits_{i\\neq j}\\dfrac{x-x_j}{x_i-x_j}$\n\n5. \u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u7ec4\u7684\u89e3\u5373\u4e3a\uff1a$\\sum\\limits_{i=1}^{k+1}y_ic_i$\uff0c\u5373\uff1a\n\n$$\nf(x)=\\sum_{i=1}^{k+1}y_i\\prod\\limits_{i\\neq j}\\dfrac{x-x_j}{x_i-x_j}\n$$\n\n\u8fd9\u5c31\u662f $f(x)$ \u7684\u8868\u8fbe\u5f0f\u4e86qwq\u3002\n\n\u4e0d\u96be\u53d1\u73b0\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u7684\u8ba1\u7b97\u590d\u6742\u5ea6\u662f $O(k^2)$ \u7684\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u5728 $O(k^2)$ \u7684\u65f6\u95f4\u5185\u7b97\u51fa\u4e86 $f(x)$\u3002\n\n\u7531\u4e8e\u8fd9\u4e2a\u677f\u5b50\u9898\u53ea\u9700\u8981\u6c42\u51fa $f(t)$ \u7684\u503c\uff0c\u6240\u4ee5\u8bf4\u53ea\u9700\u8981\u8ba1\u7b97\uff1a\n\n$$\nf(t)=\\sum_{i=1}^{k+1}y_i\\prod\\limits_{i\\neq j}\\dfrac{t-x_j}{x_i-x_j}\n$$\n\n\u5199\u8d77\u6765\u5176\u5b9e\u4f1a\u7b80\u5355\u5f97\u591a\uff08\n\n------------\n\n\u4ee3\u7801\u5b9e\u73b0\uff1a\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<iostream>\n\n#define LL long long\nconst LL mod=998244353;\n\nusing namespace std;\n\nLL n,k;\nLL x[2005],y[2005];\n\nLL ksm(LL a,LL b){\n    LL ans=1ll,y=a;\n    while(b){\n        if(b&1)ans*=y,ans%=mod;\n        y*=y;y%=mod;\n        b>>=1;\n    }\n    return ans%mod;\n}//\u5feb\u901f\u5e42\uff0c\u7528\u4e8e\u6c42\u9006\u5143 \n\nLL inv(LL x){\n\treturn ksm(x,mod-2);\n}//\u9006\u5143qwq \n\nLL calc(LL t){\n\tLL ans=0;\n\tfor(int i=1;i<=n;i++){\n\t\tLL p=y[i]%mod,q=1ll;\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tif(i==j)continue;\n\t\t\tp=p*(t-x[j])%mod;\n\t\t\tq=q*(x[i]-x[j])%mod;//\u76f4\u63a5\u7167\u7740\u516c\u5f0f\u7b97qwq\n\t\t}\n\t\tans+=p*inv(q)%mod;\n\t\tans%=mod;\n\t}\n\treturn (ans%mod+mod)%mod;\n}\n\nint main(void){\n\t\n\tcin>>n>>k;\n\tfor(int i=1;i<=n;i++)cin>>x[i]>>y[i];\n\tcout<<calc(k)<<endl;\n\t\n\treturn 0;\n}\n```",
        "postTime": 1617355687,
        "uid": 307453,
        "name": "\u4e91\u6d45\u77e5\u5904",
        "ccfLevel": 6,
        "title": "\u53ef\u7231\u306e\u62c9\u683c\u6717\u65e5\u63d2\u503c"
    },
    {
        "content": "\u4e4b\u524d\u90a3\u4e2aLaTex\u597d\u50cf\u6709\u9505\uff0c\u5982\u679c\u8fd8\u662f\u4e0d\u884c\u7684\u8bdd\u5c31\u53bb\u6211[**\u535a\u5ba2**](https://www.luogu.com.cn/blog/Lskkkno1/solution-p4781)\u770b\u5427\n## \u62c9\u683c\u6717\u65e5\u63d2\u503c\n\n### \u5f15\u5165\n\n$~n + 1~$\u4e2a\u70b9$~(x_i, y_i)~$\u53ef\u4ee5\u552f\u4e00\u5730\u786e\u5b9a\u4e00\u4e2a\u4e0d\u8d85\u8fc7$~n~$\u6b21\u7684\u591a\u9879\u5f0f\n\n\u6bd4\u8f83\u76f4\u89c2\u7684\u505a\u6cd5\u662f\u5f85\u5b9a\u7cfb\u6570\u6cd5\u7136\u540e**\u9ad8\u65af\u6d88\u5143**\u89e3\u65b9\u7a0b\n\n\u4e0d\u8fc7\u590d\u6742\u5ea6\u662f$~O(n^3)~$\u7684\uff0c\u4e0d\u662f\u7279\u522b\u4f18\u79c0\n\n\u90a3\u6709\u6ca1\u6709\u66f4\u5feb\u7684\u505a\u6cd5\u5462\uff1f\n\n### \u62c9\u683c\u6717\u65e5\u63d2\u503c\n\n\u8003\u8651\u6784\u9020\u51fd\u6570$~L(x)~$\uff0c\u4f7f\u5f97$~L(x)~$\u968f\u7740\u81ea\u53d8\u91cf$~x_i~$\u7684\u53d8\u5316\uff0c\u5bf9\u5e94\u7684\u5c31\u662f$~y_i~$\u8fd9\u4e2a\u503c\n$$\nL(x) ~=~ \\sum_{i = 0}^{n}y_i \u2113_i(x)\n$$\n\u5176\u4e2d$~\u2113_i(x)~$\u4e3a**\u62c9\u683c\u6717\u65e5\u57fa\u672c\u591a\u9879\u5f0f**\uff0c\u5176\u8868\u8fbe\u5f0f\u4e3a:\n$$\n\u2113_i(x) ~=~ \\prod_{j \\ne i} \\frac {x - x_j} {x_i - x_j}\n$$\n\u53d1\u73b0\u5bf9\u4e8e\u7ed9\u5b9a\u7684$~n + 1~$\u4e2a$~x~$\uff0c\u4ec5\u5f53$~x = x_i~$\u65f6$~\u2113_i(x) = 1~$\uff0c\u5426\u5219$~\u2113_i(x) = 0~$\uff0c\u8fd9\u8868\u660e\u4e86\u6784\u9020\u6210\u7acb\n\n\u5f53\u9700\u8981\u6c42$~x=k~$\u65f6\u7684\u51fd\u6570\u503c\u65f6\uff0c\u53ef\u4ee5\u76f4\u63a5\u5c06$~k~$\u5e26\u5165$~L(x)~$\u5373\u53ef\uff0c\u590d\u6742\u5ea6$~O(n^2)~$\n\n\u82e5\u7ed9\u5b9a\u70b9\u503c\u7684$~x~$\u662f\u8fde\u7eed\u7684\u6574\u6570\u65f6\uff0c\u53ef\u4ee5\u9884\u5904\u7406\u9636\u4e58\u505a\u5230$~O(n)~$\u6c42\u70b9\u503c\n\n### \u91cd\u5fc3\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\n\n\u62c9\u683c\u6717\u65e5\u91cd\u5fc3\u63d2\u503c\u6cd5\u662f\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u7684\u4e00\u79cd\u6539\u8fdb\n\n\u4e0d\u96be\u53d1\u73b0\u6bcf\u6b21\u8ba1\u7b97$~\u2113_i~$\u65f6\u5176\u5b9e\u662f\u7b97\u4e86\u5f88\u591a\u91cd\u590d\u7684\u4e1c\u897f\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u7b80\u5316\u4e00\u4e0b\n\n\u8bbe\n$$\n\u2113(x) ~=~ \\prod_{i = 0}^{n} (x - x_i)\n$$\n\u5b9a\u4e49**\u91cd\u5fc3\u6743**\n$$\n\u03c9_i ~=~ \\frac 1 {\\prod_{i = 0,i \\ne j}^{n}~(x_i - x_j)}\n$$\n\u53ef\u4ee5\u5c06\u62c9\u683c\u6717\u65e5\u57fa\u672c\u591a\u9879\u5f0f\u91cd\u65b0\u5199\u4e3a\uff1a\n$$\n\u2113_i(x) ~=~ \u2113(x)\\frac {\u03c9_i} {x - x_i}\n$$\n\u5219\n$$\nL(x) ~=~ \u2113(x)\\sum_{i = 0}^n \\frac {\u03c9_i} {x - x_i}\n$$\n\u4f18\u52bf:\n\n\u6bcf\u6b21\u65b0\u589e\u52a0\u4e00\u4e2a\u70b9\uff0c\u4e00\u822c\u62c9\u683c\u6717\u65e5\u63d2\u503c\u4f1a\u91cd\u65b0\u8ba1\u7b97\u4e00\u6b21\u8fbe\u5230$~O(n^2)~$\u7684\u590d\u6742\u5ea6\uff0c\u800c\u91cd\u5fc3\u62c9\u683c\u6717\u65e5\u63d2\u503c\u53ea\u9700\u8981$~O(n)~$\u8ba1\u7b97$~\u03c9_i~$\u5373\u53ef\n\n[$\\color {DeepSkyBlue} {Code}$](https://www.luogu.com.cn/paste/ux769vk8)\n\n```cpp\n#include <cstdio>\n#define N 2005\n\nusing namespace std;\n\nconst int mod = 998244353;\n\nint n, k;\nint x[N], y[N];\n\ninline int fpm(int bs, int mi) {\n\tint res = 1;\n\twhile(mi) {\n\t\tif(mi & 1) res = 1LL * res * bs % mod;\n\t\tbs = 1LL * bs * bs % mod, mi >>= 1;\n\t}\n\treturn res;\n}\ninline int Sub(int x, int y) { return (x -= y) < 0 ? x + mod : x; }\ninline int inv(int x) { return fpm(x, mod - 2); }\n\nint lagrange() {\n\tint res = 0, l;\n\tfor(int i = 0; i < n; ++i) {\n\t\tl = 1;\n\t\tfor(int j = 0; j < n; ++j) {\n\t\t\tif(i == j) continue;\n\t\t\tl = 1LL * l * Sub(k, x[j]) % mod *\n\t\t\t\tinv(Sub(x[i], x[j])) % mod;\n\t\t}\n\t\tres = (res + 1LL * l * y[i]) % mod;\n\t}\n\treturn res;\n}\n\nint main() {\n\tscanf(\"%d%d\", &n, &k);\n\tfor(int i = 0; i < n; ++i)\n\t\tscanf(\"%d%d\", &x[i], &y[i]);\n\tprintf(\"%d\\n\", lagrange());\n\treturn 0;\n}\n```\n\n",
        "postTime": 1577368532,
        "uid": 88471,
        "name": "Lskkkno1",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4781 \u3010\u3010\u6a21\u677f\u3011\u62c9\u683c\u6717\u65e5\u63d2\u503c\u3011"
    },
    {
        "content": "### \u62c9\u683c\u6717\u65e5\u63d2\u503c\n\n\u5f88\u5de7\u5999\uff0c\u65e2\u7136n\u4e2a\u70b9\u80fd\u786e\u5b9a\u4e00\u4e2a\u591a\u9879\u5f0f\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u627e\u5230\u8fd9$n$\u4e2a\u591a\u9879\u5f0f\uff0c\u8ba9\u6bcf\u4e2a$g(x_i)$\u7684\u503c\u4e2d\u53ea\u6709$g_i(x_i)$\u6709\u503c\uff0c\u8fd9\u6837\u51e0\u4e2a\u591a\u9879\u5f0f\u52a0\u8d77\u6765\u4e00\u5b9a\u8fc7\u8fd9n\u4e2a\u70b9\uff0c\u6b63\u786e\u6027\u663e\u7136\u3002\n\n\u600e\u4e48\u6765\u6784\u9020\u8fd9\u4e2a\u591a\u9879\u5f0f\u5462\uff1f\u53ea\u9700\u8981\u7528\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u53ef\u4ee5\u4e86\n\n$g_i(x)=y_i \\Pi_{i\\neq j}\\frac{x-x_j}{x_i-x_j}$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u6ee1\u8db3\u5728$i$\u7684\u65f6\u5019\u53ea\u6709$g(i)\\neq 0$\n\n\u7136\u540e\u628a\u8fd9\u4e00\u4e9b\u5f0f\u5b50\u52a0\u8d77\u6765\uff0c\u76f8\u5f53\u4e8e\u6c42m\u70b9\u7684\u70b9\u503c\u8868\u793a\uff0c\u5bf9\u6bcf\u4e2a$g_i$\u90fd\u6c42\u4e00\u4e0b\u503c\u7136\u540e\u52a0\u8d77\u6765\u5373\u53ef\n\n```cpp\n#include<touwenjian.h>\n\n#define int long long \nusing namespace std;\n\nconst int maxn=5050;\nconst int modp=998244353;\n\nint h[maxn],y[maxn]; \nint n,m,ans;\n\ninline int ksm(int x,int y)\n{\n\tint ans=1;\n\twhile(y)\n\t{\n\t\tif(y&1) ans=(ans*x)%modp;\n\t\tx=(x*x)%modp;\n\t\ty>>=1;\n\t}\n\treturn ans;\n}\n\nint getg(int i)\n{\n\tint ans=y[i];\n\tint s1=1,s2=1;\n\tfor(int j=1;j<=n;j++)\n\t{\n\t\tif(j==i) continue;\n\t\ts1=s1*(m-h[j])%modp;\n\t\ts2=s2*(h[i]-h[j])%modp;\n\t}\n\tans=ans*(s1*ksm(s2,modp-2)%modp)%modp;\n\treturn ans;\n}\n\nsigned  main()\n{\n\tios::sync_with_stdio(false);\n\tregister int i,j;\n\tcin>>n>>m;\n\tfor(i=1;i<=n;i++)\n\t{\n\t\tcin>>h[i]>>y[i];\n\t}\n\tfor(i=1;i<=n;i++)\n\t{\n\t\tans+=getg(i);\n\t\tans%=modp;\n\t}\n\tans=(ans+modp)%modp;\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```\n\n",
        "postTime": 1596028087,
        "uid": 38636,
        "name": "\u5bd2\u51b0\u5927\u5927",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4781 \u3010\u3010\u6a21\u677f\u3011\u62c9\u683c\u6717\u65e5\u63d2\u503c\u3011"
    },
    {
        "content": "### \u62c9\u683c\u6717\u65e5\u63d2\u503c\n\n\u62c9\u683c\u6717\u65e5\u63d2\u503c\u662f\u6839\u636e$n+1$\u4e2a\u70b9\u786e\u5b9a \u4e00\u4e2a$n$\u6b21\u591a\u9879\u5f0f\u7684\u7b97\u6cd5\u3002\n\n\u5047\u8bbe$n+1$\u4e2a\u70b9\u5206\u522b\u662f $(x_0,y_0),(x_1,y_1),\\dots,(x_n,y_n)$\n\n\u6211\u4eec\u6765\u6784\u9020\u4e00\u4e2a $n$ \u6b21\u591a\u9879\u5f0f\u6ee1\u8db3 $f(x_i)=y_i$\u3002\n\n\u7531\u4e8e\u6709 $y_i$ \u6240\u4ee5 \u6211\u4eec\u53ef\u4ee5\u8003\u8651\u8fd9\u6837\u4e00\u4e2a\u591a\u9879\u5f0f\n$f(x)=\\sum\\limits_{i=0}^{n}y_i\\times g_i(x)$\n\n\u5176\u4e2d $g_i(x)$ \u4e3a\u4e00\u4e2a $n$ \u6b21\u591a\u9879\u5f0f\uff0c\u4e14\u6ee1\u8db3\n$$ \ng_i(x)=\\begin{cases}\n1 & x=x_i \\\\\n0  & x=x_j(j\u2260i)\n\\end{cases} \n\\quad\\quad\n$$\n\n\u73b0\u5728\u95ee\u9898\u5c31\u8f6c\u5316\u6210\u4e86 $g_i(x)$ \u5982\u4f55\u6784\u9020\u3002\n\n\u6ce8\u610f\u5230 $g_i(x)$ \u662f $n$ \u6b21\u7684\u3002\n\n\u6240\u4ee5 $g_i(x)$ \u5e94\u8be5\u662f $n$ \u4e2a\u4e00\u6b21\u5f0f\u76f8\u4e58\u7684\u5f62\u5f0f\u3002\n\n\u56e0\u4e3a\u5f53 $x=x_i$ \u65f6 $n$ \u4e2a\u4e00\u6b21\u5f0f\u76f8\u4e58\u4e3a $1$ \uff0c\u5176\u4ed6\u60c5\u51b5\u4e3a\u96f6\uff0c\u6240\u4ee5\u6211\u4eec\u8ba9\u8fd9\u4e2a\u4e00\u6b21\u5f0f\u662f $x-x_j(j\u2260i)$ \u7684\u5f62\u5f0f\uff0c\u5982\u679c $x=x_j(j\u2260i)$ \u7684\u8bdd\u7684\u8bdd\u4e00\u5b9a\u6709\u4e00\u4e2a\u56e0\u5f0f\u4e3a $0$ \u3002\n\n\u518d\u8003\u8651 $x=x_i$ \uff0c\u6700\u7b80\u5355\u7684\u6784\u9020\u5c31\u662f\u6bcf\u4e2a\u56e0\u5f0f\u90fd\u662f $1$ \u3002\u56e0\u4e3a\u5206\u5b50\u662f$(x-x_j)$\u6240\u4ee5\u8ba9\u5206\u6bcd\u662f$(x_i-x_j)$\u3002\n\n\u4e8e\u662f\u6211\u4eec\u6784\u9020\u9664\u4e86\u7b26\u5408\u9898\u610f\u7684 $g_i(x)=\\prod\\limits_{j\u2260i} \\frac{x-x_j}{x_i-x_j}$ \u3002\n\n\u5e26\u5165  $f(x)$ \u5f97\u5230 $f(x)=\\sum\\limits_{i=0}^{n}y_i\\times \\prod\\limits_{j\u2260i} \\frac{x-x_j}{x_i-x_j}$ \u3002\n\n\u8fd9\u6837\u6211\u4eec\u5f97\u5230\u4e86\u6240\u6c42\u7684\u591a\u9879\u5f0f\u3002\n\n\u5bf9\u4e8e\u8fd9\u9053\u6a21\u677f\u9898\uff0c\u76f4\u63a5\u8f93\u51fa$f(k)$\u5373\u53ef\uff0c\u5177\u4f53\u7ec6\u8282\u89c1\u4ee3\u7801\u3002~~\u5c31\u4e24\u5c42\u5faa\u73af\u80fd\u6c34\u4e00\u9053\u84dd\u9898~~\u3002\n\n```cpp\n#pragma GCC optimize(2)\n#pragma GCC optimize(3)\n#include<bits/stdc++.h>\n#define N 2001001\n#define MAX 2001\n#define re register\nusing namespace std;\ntypedef long long ll;\ntypedef double db;\nconst ll mod=998244353;\ninline void read(re ll &ret)\n{\n    ret=0;re char c=getchar();re bool pd=false;\n    while(!isdigit(c)){pd|=c=='-';c=getchar();}\n    while(isdigit(c)){ret=(ret<<1)+(ret<<3)+(c&15);c=getchar();}\n    ret=pd?-ret:ret;\n    return;\n}\nll n,k,ans;\nstruct node\n{\n    ll x,y;\n}a[N];\ninline ll qpow(re ll a,re ll b)\n{\n    re ll ret=1;\n    while(b)\n    {\n        if(b&1)\n            ret*=a,ret%=mod;\n        b>>=1;\n        a*=a;\n        a%=mod;\n    }\n    return ret%mod;\n}\ninline ll inv(re ll a)\n{\n    return qpow(a,mod-2);\n}\nsigned main()\n{\n    read(n);\n    read(k);\n    for(re int i=1;i<=n;i++)\n    {\n        read(a[i].x);\n        read(a[i].y);\n    }\n    for(re int i=1;i<=n;i++)\n    {\n        re ll ret=a[i].y;\n        for(re int j=1;j<=n;j++)\n        {\n            if(i==j)\n                continue;\n            ret=ret*(k-a[j].x)%mod*((inv(((a[i].x-a[j].x)%mod+mod)%mod)%mod)+mod%mod)%mod;\n        }\n        ans=(ans+ret)%mod;\n        ans=(ans%mod+mod)%mod;\n    }\n    printf(\"%lld\\n\",ans);\n    #ifdef WIN32\n    system(\"pause\");\n    #endif\n\texit(0);\n} \n```\n",
        "postTime": 1598533094,
        "uid": 176990,
        "name": "Celtic",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4781 \u3010\u3010\u6a21\u677f\u3011\u62c9\u683c\u6717\u65e5\u63d2\u503c\u3011"
    },
    {
        "content": "**$\\textbf{Lagrange}$ \u63d2\u503c\u6cd5**\u3002  \n\u5173\u4e8e **$\\textbf{Lagrange}$ \u63d2\u503c\u6cd5** \u7684\u5185\u5bb9\uff0c\u6211\u5728\u53e6\u5916\u4e24\u7bc7\u535a\u5ba2\uff1a[$\\textbf{\u6d45\u8c08\u62c9\u683c\u6717\u65e5\u4e2d\u503c\u5b9a\u7406 / \u63d2\u503c\u6cd5}$](https://www.luogu.org/blog/Venus/lagrange) \u548c[$\\textbf{\u9898\u89e3 P5437 \u3010\u3010XR-2\u3011\u7ea6\u5b9a\u3011/ \u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u5b66\u4e60\u7b14\u8bb0}$](https://www.luogu.org/blog/Venus/solution-p5437) \u4e2d\u5df2\u7ecf\u8bb2\u4e86\u975e\u5e38\u591a\u4e86\uff0c\u5728\u8fd9\u91cc\u4ec5\u4ec5\u7b80\u5355\u9610\u8ff0\u4e00\u4e0b\u5173\u4e8e **$\\textbf{Lagrange}$ \u63d2\u503c\u6cd5** \u7684\u5185\u5bb9\u4ee5\u53ca\u8fd9\u9053\u9898\u7684\u6ce8\u610f\u70b9\u3002  \n\u5173\u4e8e **$\\textbf{Lagrange}$ \u63d2\u503c\u6cd5**\uff0c\u662f\u4e00\u79cd\u5728 $\\text{O}(n^2)$ \u590d\u6742\u5ea6\u5185\u6784\u9020\u51fa\u7ecf\u8fc7 $n$ \u4e2a\u70b9 $(x_i,y_i)$ \u7684\u66f2\u7ebf\u7684\u65b9\u6cd5\uff0c\u81f3\u4e8e\u5177\u4f53\u5b9e\u73b0\u5728\u4e0a\u8ff0\u4e24\u7bc7\u535a\u5ba2\u4e2d\u90fd\u6709\u8c08\u53ca\uff0c\u5728\u8fd9\u91cc\u4ec5\u4ec5\u7ed9\u51fa\u5176\u7ed3\u8bba\uff0c\u5373\uff1a\n$$f_i(x)=\\prod_{j=1\\&j\\ne i}^n\\frac{x-x_j}{x_i-x_j}$$\n$$f(x)=\\sum_{i=1}^ny_if_i(x)$$\n\u672c\u9898\u5373\u4f7f\u7528\u8fd9\u4e24\u4e2a\u516c\u5f0f\u6c42\u89e3\uff0c\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u6211\u4eec\u76f4\u63a5\u5c06 $x$ \u7684\u4f4d\u7f6e\u6362\u4e3a $k$\uff0c\u5206\u522b\u8bb0\u5f55\u5206\u5b50 $\\text{Up}$ \u548c\u5206\u6bcd $\\text{Dn}$\uff0c\u7136\u540e\u5bf9\u7b54\u6848\u7d2f\u52a0\u4e0a $y_i\\times\\frac{\\text{Up}}{\\text{Dn}}$\uff0c\u5373 $y_i\\times\\text{Up}\\times\\text{Dn}^{-1}$ \u5373\u53ef\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\u5728\u8ba1\u7b97 $\\text{Up}$ \u548c $\\text{Dn}$ \u65f6\u9700\u8981\u4fdd\u8bc1\u4e58\u4e0a\u7684 $x-x_j$ \u548c $x_i-x_j$ \u4e0d\u4e3a\u8d1f\u6570\uff0c\u5373\u53ef\u901a\u8fc7\u6b64\u9898\u3002  \n\u9898\u5916\u8bdd\uff1a\u5173\u4e8e\u4fdd\u8bc1\u4e0d\u4e3a\u8d1f\u6570\u7684\u65b9\u6cd5\uff0c\u5982\u679c\u7528\u76f4\u89c2\u7684\u65b9\u6cd5\u53ef\u4ee5\u8fd9\u6837\u5199\uff1a\n```cpp\n    Up=Up*((k-x[j]+Mod)%Mod)%Mod;\n    Dn=Dn*((x[i]-x[j]+Mod)%Mod)%Mod;\n    \n    ans=(ans+Up*Pow(Dn,Mod-2)%Mod*y[i]%Mod)%Mod;\n```\n\u5982\u679c\u7528\u7f8e\u89c2\u7684\u65b9\u6cd5\u53ef\u4ee5\u8fd9\u6837\u5199\uff1a\n```cpp\ninl int Add(reg int x,reg int y)\n{\n\treturn x+y>Mod?x+y-Mod:x+y;\n}\ninl int Del(reg int x,reg int y)\n{\n\treturn x-y<0?x-y+Mod:x-y;\n}\ninl int Mul(reg int x,reg int y)\n{\n\treturn x*y-x*y/Mod*Mod;\n}\n\n\tUp=Mul(Up,Del(k,x[j]));\n\tDn=Mul(Dn,Del(x[i],x[j]));\n    \n\tans=Add(ans,Mul(y[i],Mul(Up,Pow(Dn,Mod-2))));\n```",
        "postTime": 1572352768,
        "uid": 23243,
        "name": "VenusM1nT",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4781 \u3010\u3010\u6a21\u677f\u3011\u62c9\u683c\u6717\u65e5\u63d2\u503c\u3011"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.org/problemnew/show/P4781)\n\n\u672c\u849f\u84bb\u770b\u5230\u4e00\u9053\u6570\u5b66\u9898\uff0c\u5c31\u987a\u624b\u5207\u4e86\u3002\u611f\u89c9\u5355\u5355\u5bf9\u8fd9\u4e00\u9898\u800c\u8a00\uff0c\u90e8\u5206\u8bc4\u8bba\u533a\u7684\u5927\u4f6c\u8fc7\u4e8e\u590d\u6742\u4e86\n\n**\u3010\u5206\u6790\u3011**\n---\n\n\u5148\u8bb2\u8bb2\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\uff1a\n\n\u5bf9\u4e8e\u7ed9\u5b9a\u7684 $(n+1)$ \u4e2a\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u786e\u5b9a\u552f\u4e00\u7684\u4e00\u4e2a  **\u81f3\u591a$n$\u6b21**  \u51fd\u6570 $f(x)$\n\n\u8fd9\u91cc\u7b80\u5355\u89e3\u91ca\u4e00\u4e0b\u4e3a\u4ec0\u4e48\u662f\u552f\u4e00\u7684\u81f3\u591a $n$ \u6b21\uff1a\n\n\u82e5\u7ed9\u5b9a $(n+1)$ \u4e2a\u70b9\uff0c\u7406\u8bba\u4e0a\u53ef\u4ee5\u786e\u5b9a\u4e00\u4e2a $n$ \u6b21\u51fd\u6570 $f(x)$ \u3002\u4f46 $f(x)$ \u53ef\u4ee5\u524d\u51e0\u9879\u7cfb\u6570\u4e3a $0$ \u3002\u56e0\u6b64\uff0c\u672c\u849f\u84bb\u6309\u7167\u6570\u5b66\u4e0a\u7684\u5b9a\u4e49\uff0c\u8ba4\u4e3a\u5b83\u662f\u81f3\u591a $n$ \u6b21\u7684\u3002\n\n\u82e5\u7ed9\u5b9a $(n+1)$ \u4e2a\u70b9\uff0c\u80af\u5b9a\u8fd8\u80fd\u7ed9\u51fa\u5176\u4ed6\u7684 $k$ \u4e2a\u70b9\u4f7f\u5f97\u51fd\u6570 $f(x)$ \u53d8\u4e3a\u81f3\u591a $(n+k)$ \u6b21\u3002\u7531\u4e8e\u5176\u4ed6 $k$ \u4e2a\u70b9\u672a\u77e5\uff0c\u6545\u539f\u672c\u7684\u8fd9\u4e9b\u70b9\u80fd\u786e\u5b9a\u65e0\u6570\u4e2a\u66f4\u9ad8\u6b21\u6570\u7684\u51fd\u6570\u3002\n\n---\n\n\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u7684\u4f18\u79c0\u5c31\u5728\u4e8e\uff0c\u5b83\u80fd\u4e0d\u9700\u8981\u7528\u9ad8\u65af\u6d88\u5143\u6cd5\uff0c\u5c31\u80fd\u6c42\u51fa\u8fd9\u4e2a\u81f3\u591a $n$ \u6b21\u51fd\u6570\n\n\u6309\u7167\u6734\u7d20\u601d\u8def\uff0c\u6211\u4eec\u662f\u6784\u9020\u4e00\u4e2a\u77e9\u9635\uff0c\u7136\u540e\u9ad8\u65af\u6d88\u5143\u6cd5 $O(n^3)$ \uff0c\u80af\u5b9a\u662f\u4e0d\u591f\u7684 \uff08P.S.\u56e0\u4e3a\u672c\u849f\u84bb\u5b9e\u5728\u592a\u83dc\uff0c\u4e0d\u61c2\u6709\u6ca1\u6709\u66f4\u4f18\u7684\u7b97\u6cd5\u4f18\u5316\u9ad8\u65af\u6d88\u5143\u6cd5\uff09\u3002\n\n---\n\n\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u7684\u601d\u8def\u5f88\u7b80\u5355\uff0c\u6309\u7167\u9898\u76ee\u6837\u4f8b\u4e00\u7ed9\u7684\u4e09\u4e2a\u70b9\uff1a\n\n```\n1 4\n2 9\n3 16\n```\n\n\u6211\u4eec\u5047\u8bbe\u6709\u4ee5\u4e0b $3$ \u4e2a\u51fd\u6570\uff1a\n\n$G_1(x)=(x-2)(x-3)$\n\n$G_2(x)=(x-1)(x-3)$\n\n$G_3(x)=(x-1)(x-2)$\n\n\u56e0\u6b64\uff0c\u663e\u7136\u6709\n\n$G_1(2)=G_1(3)=0\\ ,\\ G_2(1)=G_2(3)=0\\ ,\\ G_3(1)=G_3(2)=0$\n\n\u6240\u4ee5\u6211\u4eec\u9700\u8981\u7684\u539f\u51fd\u6570\u53ef\u4ee5\u5199\u4e3a\uff1a\n\n$f(x)=A_1G_1(x)+A_2G_2(x)+A_3G_3(x)$\n\n\u90a3\u5c31\u5f88\u663e\u7136\u6709\n\n$\\begin{cases}f(1)=A_1G_1(1)+A_2\\times0+A_3\\times 0=A_1G_1(1)\\\\f(2)=A_1\\times 0+A_2G_2(2)+A_3\\times 0=A_2G_2(2)\\\\f(3)=A_1\\times 0+A_2\\times 0+A_3G_3(3)=A_3G_3(3)\\end{cases}$\n\n\u518d\u6839\u636e\u9898\u610f\u548c\u8ba1\u7b97\uff1a\n\n$\\begin{cases}f(1)=4,G_1(1)=2\\\\f(2)=9,G_2(2)=-1\\\\f(3)=16,G_3(3)=2\\end{cases}$\n\n\u5012\u4ee3\u56de\u53bb\u53ef\u4ee5\u89e3\u5f97\uff1a\n\n$f(x)=2(x-2)(x-3)-9(x-1)(x-3)+8(x-1)(x-2)=(x+1)^2$\n\n---\n\n\u5f53\u7136\uff0c\u4f60\u4f1a\u53d1\u73b0\uff0c\u8fd9\u6837\u662f\u5728\u4ee3\u5165 $k$ \u53ea\u9700\u8981 $O(n)$ \uff0c\u4f46\u8fd9\u4e48\u505a\u5e76\u6ca1\u6709\u66f4\u7b80\u5355\u3002\n\n~~\u5f53\u7136\u5566~~ \uff0c\u4f46\u662f\u6211\u4eec\u6c42\u7684\u4e0d\u662f $f(x)$ \uff0c\u53ea\u662f $f(k)$ \u554a\uff01\n\n\u6240\u4ee5\u6211\u4eec\u5148\u63d0\u53d6\u4e00\u4e0b\u4e0a\u9762\u7684\u601d\u8def\uff1a\n\n\u7ed9\u5b9a $n$ \u4e2a\u70b9 $(x_1,y_1),(x_2,y_2),(x_3,y_3)\\dots(x_n,y_n)$\n\n\u6211\u4eec\u5148\u8bbe\u5b9a\u4e00\u4e2a $\\displaystyle G_i(x)=\\prod_{j=1}^{i-1}(x-x_j)\\cdot\\prod_{j=i+1}^n(x-x_j)$\n\n\u5373 $\\displaystyle G_i(x)=\\prod_{j=1\\&j\\neq i}^n(x-x_j)$\n\n\u518d\u53e6 $\\displaystyle g(x)=\\prod_{i=1}^n(x-x_i)$\n\n\u56e0\u6b64 $\\forall i\\in[1,n]\\bigcap Z,g(x_i)=0$\n\n\u6240\u4ee5\u6709 $G_i(k)(k-x_i)=g(k)$\n\n\u4e14 $\\forall j\\neq i,G_i(x_j)=0$\n\n\u7531\u4e0a\u8ff0\u5f0f\u5b50\u8bbe $\\displaystyle f(x)=\\sum_{i=1}^nA_iG_i(x)$\n\n\u5012\u4ee3\u5165\u70b9\u7684\u5750\u6807\u5f97\uff1a\n\n$\\displaystyle y_i=f(x_i)=\\sum_{i=1}^nA_iG_i(x_i)=A_iG_i(x_i)$\n\n\u56e0\u6b64 $A_i=y_i[G_i(x_i)]^{-1}$\n\n\u6240\u4ee5\u4ee3\u5165\u539f\u5f0f\u5f97\uff1a\n\n$\\displaystyle f(x)=\\sum_{i=1}^ny_i[G_i(x_i)]^{-1}G_i(x)$\n\n\u6211\u4eec\u5206\u7c7b\u8ba8\u8bba\u4e00\u4e0b\uff1a\n\n1. \u82e5 $\\exists i\\in [1,n]\\bigcap Z,k=x_i$ \uff0c $f(k)=f(x_i)=y_i$ \uff0c\u7b97\u90fd\u4e0d\u7528\u7b97\n\n2. \u82e5 $\\forall i\\in[1,n]\\bigcap Z,k\\neq x_i$ \n\n$g(k)\\neq0$\n\n\u7531 $G_i(k)(k-x_i)=g(k)$ \u5f97\n\n$G_i(k)=g(k)(k-x_i)^{-1}$\n\n\u4ee3\u5165\u539f\u5f0f\uff1a\n\n$\\displaystyle f(k)=\\sum_{i=1}^ny_i[G_i(x_i)]^{-1}G_i(k)=\\sum_{i=1}^ny_i[G_i(x_i)]^{-1}g(k)(k-x_i)^{-1}$\n\n~~\u770b\u8d77\u6765\u66f4\u590d\u6742\u4e86~~\n\n\u4f46\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u6ce8\u610f\u5230\uff0c$g(k)$ \u5bf9\u4e8e $i$ \u800c\u8a00\uff0c\u662f\u5b9a\u503c\n\n\u8fd8\u6709 $[G_i(x_i)]^{-1}$ \u4e0e $(k-x_i)^{-1}$ \u80af\u5b9a\u662f\u53ef\u4ee5\u5408\u5e76\u7684\n\n\u6240\u4ee5\u6211\u4eec\u6309\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u6574\u7406\u539f\u5f0f\u5f97\uff1a\n\n$\\displaystyle f(k)=g(k)\\cdot\\sum_{i=1}^ny_i[G_i(x_i)(k-x_i)]^{-1}$\n\n\u53e6 $Inv(x)$ \u8868\u793a\u6570 $x$ \u5728\u6a21 $998244353$ \u4e0b\u7684\u9006\u5143\n\n\u5c31\u6709\uff1a $\\displaystyle f(k)=g(k)\\cdot\\sum_{i=1}^ny_i\\cdot Inv[G_i(x_i)(k-x_i)]$\n\n\u81f3\u4e8e $g(k)$ \u662f\u4e00\u4e2a $O(n)$ \u626b\u8fc7\u53bb\u7684\u4e8b\n\n$G_i(x_i)$ \u4e5f\u662f\u4e00\u4e2a $O(n)$ \u626b\u8fc7\u53bb\u7684\u4e8b\n\n\u4e58\u4e00\u4e0b\uff0c\u7528 **exgcd** \u6216\u8005  **\u6b27\u62c9\u5b9a\u7406\u52a0\u5feb\u901f\u5e42** \u53ef\u4ee5\u4e00\u4e2a $O(\\log n)$ \u6c42\u51fa\u9006\u5143\n\n\u6240\u4ee5\u6c42\u548c\u7b26\u53f7\u5185\u7684\u590d\u6742\u5ea6\u4e3a $O(n)+O(\\log n)=O(n)$\n\n\u5957\u4e2a\u6c42\u548c\u7b26\u53f7\u5c31\u662f $O(n\\times n)=O(n^2)$\n\n\u590d\u6742\u5ea6\u4e0a\u80af\u5b9a\u662f\u8fc7\u5f97\u4e86\u4e86\n\n---\n\n\u603b\u7ed3\u4e00\u4e0b\uff0c\u5c31\u662f\uff1a\n\n$f(k)=\\begin{cases}y_i,k=x_i\\\\g(k)\\sum_{i=1}^ny_iInv[G_i(x_i)(k-x_i)]\\end{cases}$\n\n\u90a3\u6c42\u9006\u5143\u672c\u849f\u84bb\u662f\u7528\u4e86\u975e\u9012\u5f52\u7684 exgcd \uff0c\u4f17\u4f4d\u5927\u7287\u53ef\u4ee5\u76f4\u63a5\u770b\u672c\u849f\u84bb\u7684\u4ee3\u7801\n\n---\n\n**\u3010\u4ee3\u7801\u3011**\n---\n\n\u90a3\u672c\u849f\u84bb\u5c31\u653e ~~\u6211\u7801\u98ce\u6781\u4e11\u7684~~ \u4ee3\u7801\u4e86\n\n```cpp\n#include<cstdio>\nusing namespace std;\n#define f(a,b,c,d) for(register int a=b,c=d;a<=c;a++)\n#define g(a,b,c,d) for(register int a=b,c=d;a>=c;a--)\ntypedef int i32;\ntypedef long long i64;\nconst i64 Mod=998244353;\ninline char gc(){\n  static char s[1<<20|1],*p1=s,*p2=s;\n  return (p1==p2)&&(p2=(p1=s)+fread(s,1,1<<20,stdin),p1==p2)?EOF:*(p1++);\n}\ninline i64 read(){\n  register i64 ans=0;register bool neg=0;register char c=gc();\n  while(c<48||c>57) neg^=!(c^'-'),c=gc();\n  while(c>=48&&c<=57) ans=(ans<<3)+(ans<<1)+(c^48),c=gc();\n  return neg?-ans:ans;\n}\ninline void input(i64 &lld_X,i64 &lld_Y,i64 &lld_Bas,i64 lld_K){\n  lld_X=read();\n  lld_Y=read();\n  lld_K-=lld_X;\n  if(lld_K<0) lld_K+=Mod;\n  if(lld_K<0) lld_K+=Mod;\n  lld_Bas*=lld_K;\n  lld_Bas%=Mod;\n}\ninline i64 Inv(i64 lld_A){\n  register i64 lld_Tmp[10000]={0},lld_Cur=1;\n  register i64 lld_X=1,lld_Y=0,lld_B=Mod;\n  lld_Tmp[0]=lld_A/lld_B;\n  while(lld_B^=lld_A^=lld_B^=lld_A%=lld_B)\n    lld_Tmp[lld_Cur++]=lld_A/lld_B;\n  while(lld_Cur--)\n    lld_Y^=lld_X^=lld_Y^=lld_X-=lld_Tmp[lld_Cur]*lld_Y;\n  lld_X%=Mod;\n  if(lld_X<0) lld_X+=Mod;\n  return lld_X;\n}\ninline i64 calc(i64 lld_X[],i64 lld_Y,i32 d_Pos,i32 d_N,i64 lld_K){\n  i64 lld_Ans=1;\n  f(i,1,I,d_Pos-1)\n    lld_Ans=lld_Ans*(lld_X[d_Pos]-lld_X[i])%Mod;\n  f(i,d_Pos+1,I,d_N)\n    lld_Ans=lld_Ans*(lld_X[d_Pos]-lld_X[i])%Mod;\n  lld_Ans=lld_Ans*(lld_K-lld_X[d_Pos])%Mod;\n  if(lld_Ans<0) lld_Ans+=Mod;\n  return Inv(lld_Ans)*lld_Y%Mod;\n}\ninline void print(i64 lld_Ans){\n  char s[20]={0};\n  fwrite(s,1,sprintf(s,\"%lld\",lld_Ans),stdout);\n}\ni32 main(){\n  i32 d_N=read();\n  i64 lld_K=read(),lld_X[2048]={0},lld_Y[2048]={0},lld_Bas=1,lld_Ans=0;\n  f(i,1,I,d_N){\n  \tinput(lld_X[i],lld_Y[i],lld_Bas,lld_K);\n  \tif(lld_X[i]==lld_K){\n  \t  print(lld_Y[i]);\n      return 0;\n    }\n  }\n  f(i,1,I,d_N){\n    lld_Ans+=calc(lld_X,lld_Y[i],i,d_N,lld_K);\n    if(lld_Ans>=Mod) lld_Ans-=Mod;\n  }\n  lld_Ans=lld_Ans*lld_Bas%Mod;\n  print(lld_Ans);\n  return 0;\n}\n```\n\n\u6700\u540e\u5b89\u5229\u4e00\u4e0b [\u672c\u849f\u84bb\u7684\u535a\u5ba2](https://www.luogu.org/blog/JustinRochester/)",
        "postTime": 1556084650,
        "uid": 36031,
        "name": "JustinRochester",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P4781 \u3010\u3010\u6a21\u677f\u3011\u62c9\u683c\u6717\u65e5\u63d2\u503c\u3011"
    },
    {
        "content": "\n## \u7b80\u4ecb\n\n\u5728[\u6570\u503c\u5206\u6790](https://baike.baidu.com/item/\u6570\u503c\u5206\u6790/3781)\u4e2d\uff0c\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u662f\u4ee5\u6cd5\u56fd\u5341\u516b\u4e16\u7eaa\u6570\u5b66\u5bb6[\u7ea6\u745f\u592b\u00b7\u62c9\u683c\u6717\u65e5](https://baike.baidu.com/item/\u7ea6\u745f\u592b\u00b7\u62c9\u683c\u6717\u65e5/3224655)\u547d\u540d\u7684\u4e00\u79cd[\u591a\u9879\u5f0f\u63d2\u503c](https://baike.baidu.com/item/\u591a\u9879\u5f0f\u63d2\u503c/20996132)\u65b9\u6cd5\u3002\u8bb8\u591a\u5b9e\u9645\u95ee\u9898\u4e2d\u90fd\u7528\u51fd\u6570\u6765\u8868\u793a\u67d0\u79cd\u5185\u5728\u8054\u7cfb\u6216\u89c4\u5f8b\uff0c\u800c\u4e0d\u5c11\u51fd\u6570\u90fd\u53ea\u80fd\u901a\u8fc7\u5b9e\u9a8c\u548c\u89c2\u6d4b\u6765\u4e86\u89e3\u3002\u5982\u5bf9\u5b9e\u8df5\u4e2d\u7684\u67d0\u4e2a\u7269\u7406\u91cf\u8fdb\u884c\u89c2\u6d4b\uff0c\u5728\u82e5\u5e72\u4e2a\u4e0d\u540c\u7684\u5730\u65b9\u5f97\u5230\u76f8\u5e94\u7684\u89c2\u6d4b\u503c\uff0c\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a[\u591a\u9879\u5f0f](https://baike.baidu.com/item/\u591a\u9879\u5f0f/10660961)\uff0c\u5176\u6070\u597d\u5728\u5404\u4e2a\u89c2\u6d4b\u7684\u70b9\u53d6\u5230\u89c2\u6d4b\u5230\u7684\u503c\u3002\u8fd9\u6837\u7684\u591a\u9879\u5f0f\u79f0\u4e3a\u62c9\u683c\u6717\u65e5\uff08\u63d2\u503c\uff09\u591a\u9879\u5f0f\u3002\u6570\u5b66\u4e0a\u6765\u8bf4\uff0c\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u53ef\u4ee5\u7ed9\u51fa\u4e00\u4e2a\u6070\u597d\u7a7f\u8fc7\u4e8c\u7ef4\u5e73\u9762\u4e0a\u82e5\u5e72\u4e2a\u5df2\u77e5\u70b9\u7684\u591a\u9879\u5f0f\u51fd\u6570\u3002\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u6700\u65e9\u88ab\u82f1\u56fd\u6570\u5b66\u5bb6[\u7231\u5fb7\u534e\u00b7\u534e\u6797](https://baike.baidu.com/item/\u7231\u5fb7\u534e\u00b7\u534e\u6797)\u4e8e1779\u5e74\u53d1\u73b0\uff0c\u4e0d\u4e45\u540e\uff081783\u5e74\uff09\u7531[\u83b1\u6602\u54c8\u5fb7\u00b7\u6b27\u62c9](https://baike.baidu.com/item/\u83b1\u6602\u54c8\u5fb7\u00b7\u6b27\u62c9/2148998)\u518d\u6b21\u53d1\u73b0\u30021795\u5e74\uff0c\u62c9\u683c\u6717\u65e5\u5728\u5176\u8457\u4f5c\u300a\u5e08\u8303\u5b66\u6821\u6570\u5b66\u57fa\u7840\u6559\u7a0b\u300b\u4e2d\u53d1\u8868\u4e86\u8fd9\u4e2a\u63d2\u503c\u65b9\u6cd5\uff0c\u4ece\u6b64\u4ed6\u7684\u540d\u5b57\u5c31\u548c\u8fd9\u4e2a\u65b9\u6cd5\u8054\u7cfb\u5728\u4e00\u8d77\u3002\n\n## \u63d2\u503c\n\n\u5bf9\u4e8e\u5b66\u4e60\u62c9\u683c\u6717\u65e5\u63d2\u503c\u4e4b\u524d\uff0c\u6211\u4eec\u9996\u5148\u8981\u5f04\u61c2\uff0c\u4ec0\u4e48\u53eb\u63d2\u503c\uff1f\n\n> **\u63d2\u503c**  \u6570\u5b66\u9886\u57df\u6570\u503c\u5206\u6790\u4e2d\u7684\u901a\u8fc7\u5df2\u77e5\u7684\u79bb\u6563\u6570\u636e\u6c42\u672a\u77e5\u6570\u636e\u7684\u8fc7\u7a0b\u6216\u65b9\u6cd5\u3002\n\n\u6982\u5ff5\u53ef\u80fd\u4e0d\u597d\u7406\u89e3\uff0c\u4e3e\u4e2a\u6817\u5b50\uff1a\n\n\u6211\u4eec\u7ed9\u51fa\uff1a\n\n>$x_0=1,y_0=3$\n>\n>$x_1=2,y_0=5$\n>\n>$x_2=4,y_0=8$\n>\n>$x_3=5,y_0=4$\n>\n>\u6c42\u5f53 $x=3$ \u65f6\uff0c$y$ \u7684\u503c\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5217\u65b9\u7a0b\u7684\u529e\u6cd5\uff0c\u6c42\u51fa\u51fd\u6570\uff0c\u5c06 $x$ \u5e26\u5165\u6c42\u89e3\u3002\n\n\u5982\uff0c\u6211\u4eec\u8bbe $y=ax^3+bx^2+cx+d$\n\n$\\begin{cases}  a+b+c+d=3 \\\\8a+4b+2c+d=5 \\\\ 64a+16b+4c+d=8 \\\\125a+25b+5c+d=4   \\end{cases}$\n\n\u7136\u540e\u8054\u7acb\u6c42\u89e3\uff0c\u8fd9\u91cc\u5c31\u4e0d\u7ed9\u51fa\u6c42\u89e3\u8fc7\u7a0b\u4e86\uff0c\u9700\u8981\u7528\u5230\u9ad8\u65af\u6d88\u5143\u3002\n\n\u8fd9\u6837\u505a\u7684\u590d\u6742\u5ea6\u662f $O(n^3)$ \u7684\uff0c\u6709\u70b9\u6162\uff0c\u6211\u4eec\u8003\u8651\u7528\u62c9\u683c\u6717\u65e5\u5dee\u503c\u4f18\u5316\u8fd9\u4e00\u95ee\u9898\u3002\n\n## \u62c9\u683c\u6717\u65e5\u63d2\u503c\n\n\u6211\u4eec\u9996\u5148\u8003\u8651 $x_0$ ,\u5efa\u7acb\u4e00\u4e2a\u51fd\u6570\uff0c\u4f7f\u5176\u7ecf\u8fc7 $(x_0,1),(x_1,0),(x_2,0),(x_3,0)$\u3002\n\n\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u6784\u9020\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u6784\u9020\u4e00\u4e2a\u7ecf\u8fc7 $(x_0,2),(x_1,1),(x_2,1),(x_3,1)$ \u7684\u51fd\u6570\u6216\u8005\u5176\u4ed6\u7684\u5462\uff0c\u8fd9\u4e2a\u6211\u4eec\u4e00\u4f1a\u518d\u8bf4\u3002\n\n\u6211\u4eec\u5148\u8003\u8651\u4e00\u4e0b\uff0c\u5982\u4f55\u624d\u80fd\u6784\u9020\u8fd9\u6837\u4e00\u4e2a\u51fd\u6570\u5462\uff1f\n\n\u8bbe\n\n$y=\\frac{(X-x_1)\\times(X-x_2)\\times(X-x_3)}{(x_0-x_1)\\times(x_0-x_2)\\times(x_0-x_3)}$\n\n\u6211\u4eec\u4e0d\u96be\u53d1\u73b0\uff0c\u5f53 $X=x_0$ \u65f6\uff0c\u5206\u5b50\u53d8\u6210\u4e86 $(x_0-x_1)\\times(x_0-x_2)\\times(x_0-x_3)$\uff0c\u8fd9\u4e0e\u5206\u6bcd\u76f8\u540c\uff0c\u4e8e\u662f\u5f0f\u5b50\u53ef\u5316\u4e3a $1$\u3002\u518d\u770b\uff0c\u5f53 $X=x_1,X=x_2,X=x_3$ \u65f6\uff0c\u5206\u5b50\u4f1a\u53d8\u4e3a $0$,\u4e8e\u662f\uff0c\u6211\u4eec\u5b8c\u6210\u4e86\u6784\u9020\u7684\u4e00\u5927\u534a\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u5f53\u524d\u7684\u51fd\u6570\u53ea\u662f\u7ecf\u8fc7\u4e86 $(x_0,1)$\uff0c\u6211\u4eec\u60f3\u8981\u7684\u662f\u5b83\u7ecf\u8fc7 $(x_0,y_0)$\uff0c\u600e\u4e48\u529e\u5462\u3002\n\n\u5f88\u7b80\u5355\uff0c\u6211\u4eec\u76f4\u63a5\u5728\u539f\u59cb\u7684\u57fa\u7840\u4e0a\u4e58\u4e0a\u4e00\u4e2a $y_0$\u3002\n\n$y=\\frac{(X-x_1)\\times(X-x_2)\\times(X-x_3)}{(x_0-x_1)\\times(x_0-x_2)\\times(x_0-x_3)}\\times y_0$\n\n\u6b64\u65f6\uff0c\u7531\u4e8e\u5f53 $X=x_1,X=x_2,X=x_3$ \u65f6\uff0c\u51fd\u6570\u503c\u4e3a $0$\uff0c\u6211\u4eec\u4e58\u4e0a\u4e00\u4e2a $y_0$ \u4e0d\u4f1a\u5bf9\u5176\u6709\u5f71\u54cd\uff0c\u4e8e\u662f\uff0c\u6211\u4eec\u5c31\u6784\u9020\u51fa\u4e00\u4e2a\u7ecf\u8fc7 $(x_0,y_0)$ \u7684\u51fd\u6570\u3002\n\n\u5982\u56fe\uff1a\n\n![\u62c9\u683c\u6717\u65e5\u63d2\u503c](https://cdn.luogu.com.cn/upload/image_hosting/asuaehx4.png)\n\n\n\u6b64\u65f6\uff0c\u6211\u4eec\u518d\u56de\u7b54\u4e4b\u524d\u7684\u95ee\u9898\uff1a\u4e3a\u4ec0\u4e48\u8981\u4f7f\u51fd\u6570\u7ecf\u8fc7 $(x_0,1),(x_1,0),(x_2,0),(x_3,0)$\uff1f\n\n\u6309\u7167\u6211\u81ea\u5df1\u7684\u7406\u89e3\uff0c\u8fd9\u5176\u5b9e\u662f\u4e3a\u4e86\u4e4b\u540e\u4e58 $y_0$ \u505a\u94fa\u57ab\uff0c\u56e0\u4e3a\u8fd9\u6837\u6211\u4eec\u7684 $x_0$ \u5c31\u5bf9\u5e94\u4e86 $y_0$ ,\u800c\u5176\u4ed6\u503c\u4f9d\u65e7\u4e3a $0$ ,\u6ee1\u8db3\u4e86\u6211\u4eec\u7684\u6784\u9020\u8981\u6c42\uff1a**\u53ea**\u7ecf\u8fc7 $(x_0,y_0)$ \u3002\u800c\u5982\u679c\u662f\u6784\u9020\u4e00\u4e2a\u7ecf\u8fc7 $(x_0,2),(x_1,1),(x_2,1),(x_3,1)$ \u7684\u51fd\u6570\uff0c\u8fd8\u662f\u5e94\u8be5\u6709\u529e\u6cd5\u8ba9\u5b83\u7ecf\u8fc7 $y_0$ \u7684\uff0c\u6211\u6ca1\u6709\u5c1d\u8bd5\u8fc7\uff0c\u4f46\u662f\u5e94\u8be5\u4f1a\u975e\u5e38\u9ebb\u70e6\uff0c\u6240\u4ee5\u6211\u89c9\u5f97\u8fd9\u4e2a\u6784\u9020\u7684\u65b9\u5f0f\u4e5f\u662f\u62c9\u683c\u6717\u65e5\u63d2\u503c\u7684\u4e00\u4e2a\u7cbe\u5999\u4e4b\u5904\u3002 \n\n\u8fd4\u56de\u9898\u76ee\uff0c\u8fd9\u6837\u505a\u8fd8\u662f\u4e0d\u591f\u7684\uff0c\u6211\u4eec\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u6784\u9020\u7ecf\u8fc7\u8fd9\u56db\u4e2a\u70b9\u7684\u51fd\u6570\uff0c\u8fd9\u624d\u7ecf\u8fc7\u4e86\u4e00\u4e2a\u5462\u3002\n\n\u6211\u4eec\u6839\u636e\u4e0a\u9762\u7684\u65b9\u6cd5\uff0c\u4f9d\u6b21\u6784\u9020\u51fa\u53ea\u7ecf\u8fc7 $(x_1,y_1)$ \u7684\u51fd\u6570\uff0c\u53ea\u7ecf\u8fc7 $(x_2,y_2)$ \u7684\u51fd\u6570\uff0c\u53ea\u7ecf\u8fc7 $(x_3,y_3)$ \u7684\u51fd\u6570\uff0c\n\n$y0=\\frac{(X-x_1)\\times(X-x_2)\\times(X-x_3)}{(x_0-x_1)\\times(x_0-x_2)\\times(x_0-x_3)}\\times y_0$\t\n\n$y1=\\frac{(X-x_0)\\times(X-x_2)\\times(X-x_3)}{(x_1-x_0)\\times(x_1-x_2)\\times(x_1-x_3)}\\times y_1$\n\n$y2=\\frac{(X-x_0)\\times(X-x_1)\\times(X-x_3)}{(x_2-x_0)\\times(x_2-x_1)\\times(x_2-x_3)}\\times y_2$\n\n$y3=\\frac{(X-x_0)\\times(X-x_1)\\times(X-x_2)}{(x_3-x_0)\\times(x_3-x_1)\\times(x_3-x_2)}\\times y_3$\n\n\u7136\u540e\uff0c\u6211\u4eec\u628a\u5b83\u4eec\u52a0\u8d77\u6765\u3002\n\n$f(x)=y0+y1+y2+y3$\n\n\u56fe\u50cf\u5982\u4e0b\uff1a\n\n![\u62c9\u683c\u6717\u65e5\u63d2\u503c](https://cdn.luogu.com.cn/upload/image_hosting/jvtzmmry.png)\n\n\n\u7531\u4e8e\u8fd9\u56db\u4e2a\u51fd\u6570\u90fd\u53ea\u7ecf\u8fc7\u4e86\u5404\u4e0d\u76f8\u540c\u7684\u56db\u4e2a\u70b9\uff0c\u5176\u4f59\u70b9\u7684\u503c\u90fd\u4e3a $0$\uff0c\u56e0\u6b64\uff0c\u8fd9\u4e2a\u89e3\u6790\u5f0f\u5c31\u6ee1\u8db3\u4e86\u6211\u4eec\u7684\u8981\u6c42\uff0c\u6211\u4eec\u6b64\u65f6\u53ea\u8981\u5c06\u5f85\u6c42\u7684 $x$ \u5e26\u5165\u5f0f\u5b50\uff0c\u5c31\u53ef\u4ee5\u6c42\u51fa\u5bf9\u5e94\u7684\u503c\u3002\n\n\u5982\u6211\u4eec\u7684\u6817\u5b50\uff1a\n\n![\u62c9\u683c\u6717\u65e5\u63d2\u503c](https://cdn.luogu.com.cn/upload/image_hosting/n9e49n6c.png)\n\n\u6211\u4eec\u518d\u56de\u5934\u770b\u6211\u4eec\u7684\u51fd\u6570\n\n$f(x)=y0+y1+y2+y3 $\n\n$=\\frac{(X-x_1)\\times(X-x_2)\\times(X-x_3)}{(x_0-x_1)\\times(x_0-x_2)\\times(x_0-x_3)}\\times y_0+\\frac{(X-x_0)\\times(X-x_2)\\times(X-x_3)}{(x_1-x_0)\\times(x_1-x_2)\\times(x_1-x_3)}\\times y_1+\\frac{(X-x_0)\\times(X-x_1)\\times(X-x_3)}{(x_2-x_0)\\times(x_2-x_1)\\times(x_2-x_3)}\\times y_2+\\frac{(X-x_0)\\times(X-x_1)\\times(X-x_2)}{(x_3-x_0)\\times(x_3-x_1)\\times(x_3-x_2)}\\times y_3$\n\n$=y_0\\times\\prod\\limits_{j=1}^{3}\\frac{x-x_j}{x_0-x_j}+y_1\\times \\prod\\limits_{j=0,j\\not=1}^{3}\\frac{x-x_j}{x_1-x_j}+y_2\\times\\prod\\limits_{j=0,j\\not=2}^{3}\\frac{x-x_j}{x_2-x_j}+y_3\\times\\prod\\limits_{j=0,j\\not=3}^{3}\\frac{x-x_j}{x_3-x_j}$\n\n$=\\sum\\limits_{i=0}^{3}y_i\\prod\\limits_{i\\not=j}\\frac{x-x_j}{x_i-x_j}$\n\n\u6211\u4eec\u628a\u754c\u9650\u8bbe\u5b9a\u4e3a $n$\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u5e38\u89c1\u7684\u62c9\u683c\u6717\u65e5\u63d2\u503c\u7684\u5f0f\u5b50\uff1a\n\n$f(x)=\\sum\\limits_{i=0}^{n}y_i\\prod\\limits_{j\\not=i}\\frac{x-x_j}{x_i-x_j}$\n\n\u6b64\u65f6\uff0c\u8fd9\u9053[\u6a21\u677f\u9898](https://www.luogu.com.cn/problem/P4781)\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u5229\u7528\u8fd9\u4e2a\u516c\u5f0f\u5b8c\u6210\u4e86\u3002\n\n\u9644\u4e0a\u4ee3\u7801\uff1a\n\n```c\n/*\nwork by smyslenny\n2021.06.27\nP4781 \u3010\u6a21\u677f\u3011\u62c9\u683c\u6717\u65e5\u63d2\u503c\n*/\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cmath>\n#include <iomanip>\n#include <cstring>\n#include <cstdlib>\n#include <queue>\n#include <vector>\n\n#define int long long\n#define INF 0x3f3f3f3f\n\nusing namespace std;\nconst int mod=998244353;\nconst int M=2e3+5;\nint x[M],y[M];\nint n,k,Ans;\nint read()\n{\n\tregister int x=0,y=1;\n\tregister char c=getchar();\n\twhile(c<'0'||c>'9') {if(c=='-') y=0;c=getchar();}\n\twhile(c>='0'&&c<='9') { x=x*10+(c^48),c=getchar();}\n\treturn y?x:-x;\n}\nint ksm(int a,int b)\n{\n\tint res=1;\n\twhile(b)\n\t{\n\t\tif(b&1) res=res*a%mod;\n\t\ta=a*a%mod;\n\t\tb>>=1;\n\t}\n\treturn res;\n}\nint ny(int a)\n{\n\treturn ksm(a,mod-2);\n}\nsigned main()\n{\n\tn=read(),k=read();\n\tfor(int i=1;i<=n;i++) x[i]=read(),y[i]=read();\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint fz=y[i]%mod,fm=1;\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tif(i==j) continue;\n\t\t\tfz=fz*(k-x[j])%mod;\n\t\t\tfm=fm*(x[i]-x[j])%mod;\n\t\t}\n\t\tAns=((Ans+fz*ny(fm)%mod)+mod)%mod;\n\t}\n\tprintf(\"%lld\\n\",(Ans+mod)%mod);\n\treturn 0;\n} \n\n\n```\n\n\n\n\n\u4e0a\u9762\u7684\u65b9\u5f0f\u7684\u590d\u6742\u5ea6\u662f $O(n^2)$ \u7684\uff0c\u5bf9\u4e8e\u4e00\u4e9b\u9898\u76ee\u4e2d\uff0c\u7ed9\u51fa\u7684 $x$ \u7684\u53d6\u503c\u662f\u8fde\u7eed\u7684\uff0c\u90a3\u4e48\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u5c06\u590d\u6742\u5ea6\u4f18\u5316\u5230 $O(n)$\u3002\n\n\n## $x$\u53d6\u503c\u8fde\u7eed\u65f6\u7684\u4f18\u5316\n\n\u5bf9\u4e8e\u6211\u4eec\u7684\u5f0f\u5b50\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u5de6\u8fb9\u7684\u6c42\u548c $O(n)$ \u662f\u4e0d\u80fd\u52a8\u7684\uff0c\u6211\u4eec\u8003\u8651\u4f7f\u53f3\u8fb9\u7684\u6c42\u79ef\u4f18\u5316\u6210 $O(1)$ \u7684\u3002\n\n\u7531\u4e8e $x$ \u662f\u8fde\u7eed\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u5f0f\u5b50\u8f6c\u5316\u6210 $f(x)=\\sum\\limits_{i=0}^ n y_i\\prod\\limits_{j\\not=i}\\frac{x-j}{i-j}$\u3002\n\n\u5bf9\u4e8e\u5206\u5b50\uff0c\u6211\u4eec\u5c06\u5176\u5c55\u5f00 $(x-1)\\times(x-2)\\times(x-3)\\times\\dots\\times(x-(i-1))\\times(x-(i+1))\\times\\dots\\times(x-(j-1))\\times(x-j)$\n\n\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u5173\u4e8e $x$ \u7684\u524d\u7f00\u79ef\u548c\u540e\u7f00\u79ef\uff08\u7c7b\u6bd4\u524d\u7f00\u548c\uff09$pre[i]=\\prod\\limits_{j=0}^i(x-j),suc[i]=\\prod\\limits_{j=i}^n(x-j)$\n\n\u5206\u5b50\u5c31\u53ef\u4ee5\u5199\u6210 $pre[i-1]\\times suc[i+1]$\u3002\n\n\u518d\u770b\u5206\u6bcd\uff0c\u62c6\u5f00\n\n$i\\times(i-1)\\times(i-2)\\times(i-3)\\times\\dots\\times (i-(i-1))\\times(i-(i+1))\\times\\dots\\times(i-n)$\n\n\u89c2\u5bdf\u4e00\u4e0b\uff0c$(i-(i-1))=1$ \uff0c\u5728\u8fd9\u4e00\u5757\u4e4b\u524d\u7684\u53ef\u4ee5\u770b\u505a\u662f $1$ ~ $i$ \u7684\u4e58\u79ef\uff0c\u4e5f\u5c31\u662f $i!$ \uff0c\u540e\u9762 $(i-(i+1))=-1$ \u540e\u9762\u6211\u4eec\u53ef\u4ee5\u770b\u505a\u662f $-1\\backsim(i-n)$ \u7684\u9636\u4e58\uff0c\u4e3a\u4e86\u597d\u8ba1\u7b97\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u4f5c\u662f $1\\backsim(n-i)$ \u7684\u9636\u4e58\u3002\n\n**PS**\uff1a \u8fd9\u91cc\u6211\u4eec\u8981\u6ce8\u610f\u6b63\u8d1f\u53f7\uff0c\u5f53\u6240\u4e58\u7684\u603b\u6570\u4e3a\u5947\u6570\u4e2a\u65f6\uff0c\u9700\u8981\u5e26\u4e0a\u8d1f\u53f7\uff0c\u7531\u4e8e\u516c\u5f0f\u4e2d\u4e0d\u77e5\u9053\u4e2a\u6570\uff0c\u4e0b\u9762\u9ed8\u8ba4\u4e3a\u662f\u6b63\u6570\uff0c\u8bf7\u4e0d\u8981\u8ba4\u4e3a\u5c31\u662f\u6b63\u7684\u3002\n\n\u6240\u4ee5\u5206\u6bcd\u53ef\u4ee5\u5316\u6210 $i!\\times(n-i)!$ \n\n\u53f3\u8fb9\u4e5f\u5c31\u53ef\u4ee5\u5316\u6210 $\\frac{pre[i-1]\\times suc[i+1]}{i!\\times(n-i)!}$ ,\u5206\u5b50\u548c\u5206\u6bcd\u90fd\u53ef\u4ee5 $O(n)$ \u9884\u5904\u7406\uff0c\u67e5\u8be2\u662f $O(1)$ \u7684\uff0c\u590d\u6742\u5ea6\u5c31\u53ef\u4ee5\u4f18\u5316\u6210 $O(n)$\u3002\n\n\n## \u91cd\u5fc3\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u5f53\u6211\u4eec\u6bcf\u63d2\u5165\u4e00\u4e2a\u503c\u7684\u65f6\u5019\uff0c\u90fd\u9700\u8981\u63a8\u5012\u91cd\u7b97\uff0c\u8fd9\u91cc\u53ef\u4ee5\u7528\u91cd\u5fc3\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u6765\u89e3\u51b3\u3002\n\n$f(x)=\\sum\\limits_{i=1}^{n}y_i\\prod\\limits_{j\\not=i}\\frac{x-x_j}{x_i-x_j}$\n\n$=\\sum\\limits_{i=1}^n  y_i\\frac{\\prod\\limits_{i\\not=j}x-x_j}{\\prod\\limits_{i\\not=j}x_i-x_j}$\n\n\u4e0a\u4e0b\u4e58 $x-x_i$\n\n$=\\sum\\limits_{i=1}^{n}y_i\\frac{\\prod\\limits_{i=1}^n x-x_j}{\\prod\\limits_{i\\not=j}(x_i-x_j)\\times(x-x_i)}$\n\n$=\\prod\\limits_{i=1}^n (x-x_j)\\sum\\limits_{i=1}^{n}\\frac{y_i}{\\prod\\limits_{i\\not=j}(x_i-x_j)\\times(x-x_i)}$\n\n\u8bbe $\\lambda=\\prod\\limits_{i=1}^n (x-x_j)\\mu(x)=\\prod\\limits_{i\\not=j}(x_i-x_j)$ \n\n$f(x)=\\lambda\\sum\\limits_{i=1}^n\\frac{y_i}{\\mu(x)\\times(x-x_i)}$\n\n\u63d2\u5165\u4e00\u4e2a\u503c\uff0c\u53ea\u7528 $O(n)$ \u66f4\u65b0 $\\mu(x)$ \uff0c\u56e0\u4e3a\u5206\u5b50\u6211\u4eec\u5df2\u7ecf\u4e58\u4e0a $(x-x_i)$ \u4e86\n\n\u8be2\u95ee\u4e00\u4e2a\u503c\uff0c$O(n)$ \u66f4\u65b0 $\\lambda$ \uff0c\u518d\u5957\u516c\u5f0f\u5373\u53ef\u3002\n\n\n\n\n\n\n\n\u53c2\u8003\u8d44\u6599\uff1a\n\n[\u725b\u987f\u63d2\u503c\u7684\u51e0\u4f55\u89e3\u91ca\u662f\u600e\u4e48\u6837\u7684\uff1f](https://www.zhihu.com/question/22320408/answer/141973314)\n\n[\u5982\u4f55\u76f4\u89c2\u5730\u7406\u89e3\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\uff1f](https://www.zhihu.com/question/58333118/answer/262507694)\n\n[\u62c9\u683c\u6717\u65e5\u63d2\u503c\u5b66\u4e60\u5c0f\u7ed3](https://www.cnblogs.com/zwfymqz/p/10063039.html)\n\n[\u62c9\u683c\u6717\u65e5\u63d2\u503c\u5b66\u4e60\u603b\u7ed3](https://www.cnblogs.com/e-e-thinker/p/13394015.html)\n\n",
        "postTime": 1624792927,
        "uid": 231190,
        "name": "smyslenny",
        "ccfLevel": 0,
        "title": "\u62c9\u683c\u6717\u65e5\u63d2\u503c"
    },
    {
        "content": "## \u62c9\u683c\u6717\u65e5\u63d2\u503c\n\n### \u9898\u76ee\uff1a\n\n\u7ed9\u5b9a $n$ \u4e2a\u70b9\uff0c\u53ef\u4ee5\u786e\u5b9a\u552f\u4e00\u7684\u591a\u9879\u5f0f\uff0c\u53d6\u51fa\u7b2c $k$ \u9879\u7684\u503c\u3002\n\n### \u62c9\u683c\u6717\u65e5\u63d2\u503c\n\n$n + 1$ \u4e2a\u70b9\u53ef\u4ee5\u786e\u5b9a\u4e00\u4e2a $n$ \u9636\u7684\u591a\u9879\u5f0f\uff0c\u53ef\u4ee5\u7528\u9ad8\u65af\u6d88\u5143\u6c42\u51fa\u591a\u9879\u5f0f\u7684\u7cfb\u6570\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3)$\u3002\n\n\u62c9\u683c\u6717\u65e5\u5dee\u503c\u53ef\u4ee5 $O(n^2)$  \u7684\u6c42\u51fa\u7b2c $k$ \u9879\u7684\u503c\u3002\n\n**\u5b83\u7684\u601d\u60f3\u662f\u8fd9\u6837\u7684\uff1a**\n\n\u8bbe\u8fd9\u4e2a\u591a\u9879\u5f0f\u4e3a $f(x)$\u3002\n\n\u9996\u5148\u8981\u6784\u9020\u4e00\u4e2a\u8fd9\u6837\u7684\u5f0f\u5b50\uff0c\n\n\u5f53 $x = x_i$ \u65f6, $g_i = 1$, \u5f53 $x = x_j \\ (j \\not= i)$ \u65f6\uff0c$g_i = 0$\u3002 \n\n$g(x) =  \\prod_{j \\not = i}  \\frac {x - x_j }{x_i - x_j}$, \u5f53 $x = x_i$ \u65f6, \u6b63\u597d\u4e0a\u4e0b\u76f8\u7b49\u53ef\u4ee5\u7ea6\u6389\uff0c\u5f53 $x = x_j \\ (j \\not= i)$ \u65f6\uff0c\u4e00\u5b9a\u6709\u4e00\u9879\uff0c\u76f8\u51cf\u7b49\u4e8e0\uff0c\u6574\u4e2a\u5f0f\u5b50\u5c31\u7b49\u4e8e0\u3002\n\n\u5e26\u5165\u5230 $f(x)$ \u4e2d\u53ef\u4ee5\u5f97\u5230 $f(x) = \\sum y_i \\times \\prod ^{x-x_j} _{x_i - x_j}$\u3002\n\n\u56e0\u4e3a\u8981\u53d6\u6a21\uff0c\u6240\u4ee5\u8981\u6c42\u9006\u5143\u3002\n\n[\u6a21\u677f\u9898](https://www.luogu.com.cn/problem/P4781)\n\n```c++\n#include <cstdio>\n#include <iostream>\n#define orz cout << \"AK IOI\" <<\"\\n\"\n#define int long long\n\nusing namespace std;\nconst int mod = 998244353;\nconst int maxn = 2e3 + 10;\n\ninline int read()\n{\n\tint x = 0, f = 1;\n\tchar ch = getchar();\n\twhile (ch < '0' || ch > '9') {if(ch == '-') f = -1; ch = getchar();}\n\twhile (ch >= '0' && ch <= '9') {x = (x << 3) + (x << 1) + (ch ^ 48);ch = getchar();}\n\treturn x * f;\n}\nint n, k, x[maxn], y[maxn], a, b, ans;\nint inv(int x)\n{\n\tint res = 1, b = mod - 2;\n\twhile(b)\n\t{\n\t\tif(b & 1) res = res * x % mod;\n\t\tx = x * x % mod;\n\t\tb >>= 1; \n\t}\n\treturn res;\n}\nsigned main()\n{\n    //freopen(\".in\",\"r\",stdin);\n    //freopen(\".out\",\"w\",stdout); \n    n = read(), k = read();\n    for(int i = 1; i <= n; i++) x[i] = read(), y[i] = read();\n    for(int i = 1; i <= n; i++)\n    {\n    \ta = y[i] % mod;\n    \tb = 1;\n    \tfor(int j = 1; j <= n; j++)\n    \t{\n    \t\tif(j == i) continue;\n    \t\ta = a * (k - x[j])  % mod;\n    \t\tb = b * (x[i] - x[j]) % mod;\n\t\t}\n\t\tans = (ans + a * inv(b) % mod) % mod;\n\t}\n    printf(\"%lld\", (ans + mod)% mod);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1624774439,
        "uid": 174685,
        "name": "\u7a0b\u95e8\u7acb\u96ea",
        "ccfLevel": 4,
        "title": "\u62c9\u683c\u6717\u65e5\u63d2\u503c \u9898\u89e3"
    },
    {
        "content": "~~\u6c34\u9898\u89e3\u6c34\u9898\u89e3~~\r\n\r\n\u53d1\u73b0\u5728\u8bb8\u591a\u9898\u91cc\u9762\u7684\u62c9\u63d2\u9700\u8981\u6c42\u7cfb\u6570\uff0c\u4f46\u8fd9\u4e2a\u9898\u53ea\u6c42\u7b2c $k$ \u9879\uff0c\u5c31\u6bd4\u8f83\u65e0\u80fd\u3002\u4e8e\u662f\u6765\u5199\u4e00\u4e2a\u6c42\u7cfb\u6570\u7684\u9898\u89e3\u3002\r\n\r\n~~\u597d\u4e86\u522b\u55b7\u4e86\u6211\u77e5\u9053\u6211\u628a\u8fd9\u9898\u505a\u6210\u4e86\u4e00\u9053\u6a21\u62df\u9898~~\r\n\r\n\u5927\u6982\u5c31\u662f\u8003\u8651\u62c9\u683c\u6717\u65e5\u63d2\u503c\u7684formula\uff1a\r\n\r\n$$f=\\sum y_i\\prod_{i\\not=j}\\frac{x-x_j}{x_i-x_j}$$\r\n\r\n\u7136\u540e\u6839\u636e\u8fd9\u4e2a\u6a21\u62df\u591a\u9879\u5f0f\u8fd0\u7b97\u5373\u53ef\u3002\u5176\u4e2d\u9700\u8981\u6ce8\u610f\u7684\u662f\u591a\u9879\u5f0f\u9664\u6cd5\uff0c\u5728\u9664\u4e00\u4e2a\u7c7b\u4f3c $(x+t)$ \u7684\u5f0f\u5b50\u7684\u65f6\u5019\uff0c\u7528\u5230\u7684\u662f\u5927\u9664\u6cd5(\u5373\u624b\u7b97\u591a\u9879\u5f0f\u9664\u6cd5)\u7684\u65b9\u5f0f\u8fdb\u884c\uff0c\u4e5f\u4e0d\u662f\u5f88\u96be\u63a8\uff0c\u6a21\u62df\u4e00\u4e0b\u5c31\u597d\u4e86\u3002\r\n\r\n```cpp\r\n#include <bits/stdc++.h>\r\n\r\nusing namespace std ;\r\n\r\ntypedef long long ll ;\r\n\r\nconst int N = 1000010 ;\r\nconst int P = 998244353 ;\r\n\r\nint n, k ;\r\n\r\nvoid debug(int *tp, int minn, int maxn, char c){\r\n    for (int i = minn ; i <= maxn ; ++ i)\r\n        cout << tp[i] << \" \" ;  cout << c ;\r\n}\r\n\r\nnamespace Interpolation{\r\n\tint ans ;\r\n\tint now ;\r\n\tint x[N] ;\r\n\tint y[N] ;\r\n\tint fac[N] ;\r\n\tint inv[N] ;\r\n\tint pres[N] ;\r\n\tint sufs[N] ;\r\n\tint expow(int a, int b){\r\n\t\tint res = 1 ;\r\n\t\ta = (a % P + P) % P ;\r\n\t\twhile (b){\r\n\t\t\tif (b & 1)\r\n\t\t\t\tres = (ll)res * a % P ;\r\n\t\t\ta = (ll)a * a % P ; b >>= 1 ;\r\n\t\t}\r\n\t\treturn res ;\r\n\t}\r\n\tint fz[N] ;\r\n\tint fm[N] ;\r\n\tint tmp[N] ;\r\n\tint res[N] ;\r\n\tvoid add(int &a, int b){\r\n\t\ta += b ;\r\n\t\tif (a > P) a -= P ;\r\n\t}\r\n\tvoid dec(int &a, int b){\r\n\t\t(a -= b) %= P ;\r\n\t\tif (a < 0) a += P ;\r\n\t}\r\n\tvoid fmul(int *t, int deg, int opt){\r\n    //\u6b21\u6570\u4e3adeg\u7684\u591a\u9879\u5f0ft\u4e58\u4e0a\u4e00\u4e2a\u5f62\u5982(x+opt)\u7684\u591a\u9879\u5f0f\r\n\t\tfor (int i = deg + 1 ; i >= 1 ; -- i)\r\n\t\t\ttmp[i] = t[i], t[i] = t[i - 1] ;\r\n\t\tfor (int i = 1 ; i <= deg + 1 ; ++ i)\r\n\t\t\tadd(t[i], (ll)opt * tmp[i] % P) ;\r\n\t}\r\n\tvoid fdiv(int *t, int *ret, int deg, int opt){\r\n    //\u6b21\u6570\u4e3adeg\u7684\u591a\u9879\u5f0f\u9664\u4ee5\u4e00\u4e2a\u5f62\u5982(x+opt)\u7684\u591a\u9879\u5f0f(\u6574\u9664)\r\n\t\tfor (int i = 1 ; i <= deg ; ++ i) tmp[i] = t[i] ;\r\n\t\tfor (int i = deg - 1 ; i >= 1 ; -- i)\r\n\t\t\tret[i] = tmp[i + 1], dec(tmp[i], (ll)tmp[i + 1] * opt % P) ;\r\n\t}\r\n\tvoid get_xs(int n){//\u6c42\u7cfb\u6570\r\n\t\tfz[1] = 1 ;\r\n\t\tfor (int i = 1 ; i <= n ; ++ i)\r\n\t\t\tfmul(fz, i, (-x[i] + P) % P) ;\r\n\t\t//debug(fz, 1, n + 1, '\\n') ;\r\n\t\tfor (int i = 1 ; i <= n ; ++ i){\r\n\t\t\tint fenmu = 1 ;\r\n\t\t\tfor (int j = 1 ; j <= n ; ++ j)\r\n\t\t\t\tif (i != j) fenmu = (ll)fenmu * (x[i] - x[j] + P) % P ;\r\n\t\t\tfdiv(fz, fm, n + 1, -x[i]) ;\r\n\t\t\tfenmu = (ll)y[i] * expow(fenmu, P - 2) % P ;\r\n\t\t//\tcout << fenmu << endl ;\r\n\t\t\tfor (int j = 1 ; j <= n ; ++ j)\r\n\t\t\t\tadd(res[j], (ll)fenmu * fm[j] % P) ;\r\n\t\t//\tdebug(res, 1, n, '\\n') ;\r\n\t\t}\r\n\t}\r\n\tvoid pre_do(int U){\r\n\t\tfac[0] = 1 ;\r\n\t\tfor (int i = 1 ; i <= U ; ++ i)\r\n\t\t\tfac[i] = (ll)fac[i - 1] * i % P ;\r\n\t\tinv[U] = expow(fac[U], P - 2) ;\r\n\t\tfor (int i = U ; i >= 1 ; -- i)\r\n\t\t\tinv[i - 1] = (ll)inv[i] * i % P ;\r\n\t\t//debug(fac, 1, U, '\\n') ;\r\n\t\t//debug(inv, 1, U, '\\n') ;\r\n\t}\r\n\tint evenmark(int x){\r\n\t\treturn (x & 1) ? -1 : 1 ;\r\n\t}\r\n\tvoid get_dnx(int n, int k, bool m){\r\n\t\tif (m){//\u6c42\u5355\u72ec\u7684\u4e00\u9879\uff0c\u7ed9\u51fa\u7684x\u8fde\u7eed\r\n\t\t\tpre_do(n) ;\r\n\t\t\tpres[0] = 1, sufs[n + 1] = 1 ;\r\n\t\t\tfor (int i = 1 ; i <= n ; ++ i)\r\n\t\t\t\tpres[i] = ((ll)pres[i - 1] * (k - x[i]) % P + P) % P ;\r\n\t\t\tfor (int i = n ; i >= 1 ; -- i)\r\n\t\t\t\tsufs[i] = ((ll)sufs[i + 1] * (k - x[i]) % P + P) % P ;\r\n\t\t\tfor (int i = 1 ; i <= n ; ++ i){\r\n\t\t\t\tnow = (ll)pres[i - 1] * sufs[i + 1] % P ;\r\n\t\t\t\tnow = (ll)now * expow((ll)fac[i - 1] * fac[n - i] % P, P - 2) % P ;\r\n\t\t\t\tnow = (ll)evenmark(n - i) * y[i] % P * now % P ; ans = (ll)(ans + now) % P ;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {//\u6c42\u5355\u72ec\u7684\u4e00\u9879\uff0c\u7ed9\u51fa\u7684x\u4e0d\u8fde\u7eed\r\n\t\t\tint inow = 1 ;\r\n\t\t\tpres[0] = 1, sufs[n + 1] = 1 ;\r\n\t\t\tfor (int i = 1 ; i <= n ; ++ i)\r\n\t\t\t\tpres[i] = ((ll)pres[i - 1] * (k - x[i]) % P + P) % P ;\r\n\t\t\tfor (int i = n ; i >= 1 ; -- i)\r\n\t\t\t\tsufs[i] = ((ll)sufs[i + 1] * (k - x[i]) % P + P) % P ;\r\n\t\t\tfor (int i = 1 ; i <= n ; ++ i){\r\n\t\t\t\tinow = 1, now = (ll)pres[i - 1] * sufs[i + 1] % P ;\r\n\t\t\t\tfor (int j = 1 ; j <= n ; ++ j)\r\n\t\t\t\t\tif (i != j) inow = (ll)inow * ((x[i] - x[j]) % P + P) % P ;\r\n\t\t\t\tans = (ans + (ll)now * expow(inow, P - 2) % P * y[i] % P) % P ;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nint main(){\r\n\tcin >> n >> k ;\r\n\tusing namespace Interpolation ;\r\n\tfor (int i = 1 ; i <= n ; ++ i){\r\n\t\tcin >> x[i] >> y[i] ;\r\n\t\tif (x[i] == k) return cout << y[i], 0 ;\r\n\t}\r\n\tget_xs(n) ; //debug(res, 1, n + 1, '\\n') ;\r\n\tfor (int i = n + 1 ; i >= 1 ; -- i)\r\n\t\tans = ((ll)ans * k % P + res[i]) % P ;\r\n\tcout << ans << '\\n' ; return 0 ;\r\n}\r\n\r\n\r\n```",
        "postTime": 1585737601,
        "uid": 28313,
        "name": "\u768e\u6708\u534a\u6d12\u82b1",
        "ccfLevel": 7,
        "title": "\u62c9\u683c\u6717\u65e5\u63d2\u503c(\u6c42\u7cfb\u6570\u7248)"
    }
]
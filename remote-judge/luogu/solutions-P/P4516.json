[
    {
        "content": "\u4e00\u9053\u6811\u4e0a\u80cc\u5305\u7b80\u5355\u9898\n\n\u72b6\u6001\u5f88\u597d\u63a8\u3002\u8bbe$dp[x][i][0/1][0/1]$\u8868\u793a\u4ee5$x$\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u5171\u653e\u4e86$i$\u4e2a\u76d1\u542c\u88c5\u7f6e\uff0c\u5176\u4e2d$x$\u70b9\u653e\u6ca1\u653e\u88c5\u7f6e\uff0c$x$\u70b9\u6709\u6ca1\u6709\u88ab\u76d1\u542c\u5230\u7684\u65b9\u6848\u6570\uff08\u5728\u4ee5$x$\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u9664$x$\u5916\u7684\u5176\u5b83\u7ed3\u70b9\u90fd\u88ab\u76d1\u542c\u5230\u4e86\uff09\n\n\u4e0d\u96be\u770b\u51fa\u8fd9\u662f\u4e00\u4e2a\u6811\u4e0a\u80cc\u5305\uff0c\u6811\u4e0a\u80cc\u5305\u7684\u8f6c\u79fb\u5957\u8def\u662f\n\n$dp[x][i+j]=combine(dp[x][i],dp[v][j])$\uff0c\u5176\u4e2d$v$\u662f$x$\u7684\u5b50\u8282\u70b9\n\n\u6240\u4ee5\u672c\u9898\u7684\u8f6c\u79fb\u4e5f\u5c31\u8fd9\u6837\u6765\u8003\u8651\u3002\u628a\u6811\u753b\u6210\u8fd9\u6837\uff0c\u5206\u4e3a$x$\u4fa7\u548c$v$\u4fa7\n![xysILoveYou](https://cdn.luogu.com.cn/upload/pic/41854.png)\n\n\u5982\u679c\u60a8\u6709\u80fd\u529b\u8bf7\u81ea\u884c\u63a8\u51fa\u65b9\u7a0b\uff0c\u8df3\u8fc7\u8fd9\u4e00\u6bb5\n\n - \u5982\u679c$x$\u6ca1\u88ab\u76d1\u542c\uff0c\u90a3\u4e48$v$\u4e00\u5b9a\u4e0d\u80fd\u653e\u88c5\u7f6e\uff0c\u56e0\u6b64\n$dp[x][i+j][0][0]=\\sum dp[x][i][0][0]*dp[v][j][0][1]$\n\n - \u5982\u679c$x$\u6ca1\u88ab\u76d1\u542c\u4f46\u662f\u653e\u4e86\u88c5\u7f6e\uff0c$x$\u4fa7\u7684\u72b6\u6001\u4e00\u5b9a\u662f$dp[x][i][1][0]$\uff0c$v$\u662f\u5426\u88ab\u76d1\u542c\u65e0\u6240\u8c13\u4f46\u662f\u4e00\u5b9a\u4e0d\u80fd\u653e\u88c5\u7f6e\uff0c\u56e0\u6b64\n$dp[x][i+j][1][0]=\\sum dp[x][i][1][0]*(dp[v][j][0][0]+dp[v][j][0][1])$\n\n - \u5982\u679c$x$\u6ca1\u653e\u88c5\u7f6e\u4f46\u662f\u88ab\u76d1\u542c\u4e86\uff0c\u8fd9\u65f6\u5019\u8981\u5206\u60c5\u51b5\uff1a\n\n\t$x$\u4fa7\u7684\u72b6\u6001\u662f$dp[x][i][0][1]$\uff0c\u8fd9\u65f6\u5019\u53cd\u6b63$x$\u5df2\u7ecf\u88ab\u76d1\u542c\u4e86\uff0c$v$\u653e\u4e0d\u653e\u88c5\u7f6e\u90fd\u65e0\u6240\u8c13\uff0c\u4f46\u662f\u5fc5\u987b\u4fdd\u8bc1$v$\u662f\u88ab\u76d1\u542c\u7684\uff0c\u6240\u4ee5\u8d21\u732e\u662f$dp[x][i][0][1]*(dp[v][j][0][1]+dp[v][j][1][1])$\n    \n    $x$\u4fa7\u7684\u72b6\u6001\u662f$dp[x][i][0][0]$\uff0c\u8fd9\u65f6\u5019\u76d1\u542c$x$\u7684\u91cd\u4efb\u5c31\u8981\u4ea4\u7ed9$v$\u4e86\uff0c\u540c\u65f6$v$\u81ea\u5df1\u5fc5\u987b\u662f\u88ab\u76d1\u542c\u7684\uff0c\u6240\u4ee5\u8d21\u732e\u662f$dp[x][i][0][0]*dp[v][j][1][1]$\n\n\t\u56e0\u6b64$dp[x][i+j][0][1]=\\sum (dp[x][i][0][1]*(dp[v][j][0][1]+dp[v][j][1][1])+dp[x][i][0][0]*dp[v][j][1][1])$\n\n- \u5982\u679c$x$\u65e2\u653e\u4e86\u88c5\u7f6e\u53c8\u88ab\u76d1\u542c\uff0c\u540c\u6837\u8981\u5206\u4e24\u79cd\u60c5\u51b5\uff1a\n\n\t$x$\u4fa7\u7684\u72b6\u6001\u662f$dp[x][i][1][0]$\uff0c\u9700\u8981\u8ba9$v$\u6765\u76d1\u542c$x$\uff0c\u4f46\u662f$v$\u662f\u5426\u88ab\u76d1\u542c\u65e0\u6240\u8c13\uff0c\u56e0\u4e3a$x$\u4e0a\u653e\u4e86\u88c5\u7f6e\u53ef\u4ee5\u4fdd\u8bc1$v$\u88ab\u76d1\u542c\uff0c\u6240\u4ee5\u8d21\u732e\u662f$dp[x][i][1][0]*(dp[v][j][1][0]+dp[v][j][1][1])$\n\n\t$x$\u4fa7\u7684\u72b6\u6001\u662f$dp[x][i][1][1]$\uff0c\u8fd9\u65f6\u5019$x$\u7684\u6240\u6709\u8981\u6c42\u90fd\u6ee1\u8db3\u4e86\uff0c$v$\u600e\u4e48\u6837\u90fd\u884c\uff0c\u8d21\u732e\u662f$dp[x][i][1][1]*(dp[v][j][0][0]+dp[v][j][0][1]+dp[v][j][1][0]+dp[v][j][1][1])$\n\n\t\u56e0\u6b64$dp[x][i+j][1][1]=\\sum (dp[x][i][1][0]*(dp[v][j][1][0]+dp[v][j][1][1])+dp[x][i][1][1]*(dp[v][j][0][0]+dp[v][j][0][1]+dp[v][j][1][0]+dp[v][j][1][1]))$\n\n\u6574\u7406\u4e00\u4e0b\uff1a\n\n$dp[x][i+j][0][0]=\\sum dp[x][i][0][0]*dp[v][j][0][1]$\n\n$dp[x][i+j][1][0]=\\sum dp[x][i][1][0]*(dp[v][j][0][0]+dp[v][j][0][1])$\n\n$dp[x][i+j][0][1]=\\sum (dp[x][i][0][1]*(dp[v][j][0][1]+dp[v][j][1][1])+dp[x][i][0][0]*dp[v][j][1][1])$\n\n$dp[x][i+j][1][1]=\\sum (dp[x][i][1][0]*(dp[v][j][1][0]+dp[v][j][1][1])+dp[x][i][1][1]*(dp[v][j][0][0]+dp[v][j][0][1]+dp[v][j][1][0]+dp[v][j][1][1]))$\n\n~~\u4e0d\u662f\u5f88\u957f\u5bf9\u5427~~\n\n\u5c0f\u5fc3\uff1a\u8fd9\u9898dp\u6570\u7ec4\u5f00long long\u662f\u4f1aMLE\u7684\uff0c\u8981\u4e2d\u95f4\u8fd0\u7b97\u8fc7\u7a0b\u4e2d\u8f6clong long\u7136\u540e\u518d\u8f6c\u56deint\n\n\u5c31\u5dee\u4e0d\u591a\u4e86\n\n```cpp\n#include <cctype>\n#include <cstdio>\n#include <climits>\n#include <algorithm>\n#include <vector>\n\ntemplate <typename T> inline void read(T& t) {\n    int f = 0, c = getchar(); t = 0;\n    while (!isdigit(c)) f |= c == '-', c = getchar();\n    while (isdigit(c)) t = t * 10 + c - 48, c = getchar();\n    if (f) t = -t;\n}\ntemplate <typename T> inline bool chkMin(T& x, const T& y) { return y < x ? (x = y, true) : false; }\ntemplate <typename T> inline bool chkMax(T& x, const T& y) { return x < y ? (x = y, true) : false; }\n#ifdef WIN32\n#define LLIO \"%I64d\"\n#else\n#define LLIO \"%lld\"\n#endif\t// WIN32 long long\n#define rep(I, A, B) for (int I = (A); I <= (B); ++I)\n#define dwn(I, A, B) for (int I = (A); I >= (B); --I)\n#define erp(I, X) for (int I = head[X]; I; I = next[I])\n\nconst int maxn = 1e5 + 7;\nconst long long mod = 1e9 + 7;\nstd::vector<int> G[maxn];\nint dp[maxn][107][2][2], tmp[107][2][2];\nint size[maxn];\nint n, K;\n\ninline int add(int x, long long y) {\n    if (y >= mod) y %= mod;\n    for (x += y; x >= mod; x -= mod);\n    return x;\n}\ninline void ae(int x, int y) {\n    G[x].push_back(y);\n    G[y].push_back(x);\n}\nvoid dfs(int x, int fa) {\n    size[x] = dp[x][0][0][0] = dp[x][1][1][0] = 1;\n    for (unsigned e = 0; e < G[x].size(); ++e) {\n        int v = G[x][e];\n        if (v != fa) {\n            dfs(v, x);\n            rep(i, 0, std::min(size[x], K)) {\n                tmp[i][0][0] = dp[x][i][0][0]; dp[x][i][0][0] = 0;\n                tmp[i][0][1] = dp[x][i][0][1]; dp[x][i][0][1] = 0;\n                tmp[i][1][0] = dp[x][i][1][0]; dp[x][i][1][0] = 0;\n                tmp[i][1][1] = dp[x][i][1][1]; dp[x][i][1][1] = 0;\n            }\n            rep(i, 0, std::min(size[x], K))\n                rep(j, 0, std::min(size[v], K - i)) {\n                    dp[x][i + j][0][0] = add(dp[x][i + j][0][0], 1ll * tmp[i][0][0] * dp[v][j][0][1]);\n\n                    dp[x][i + j][0][1] = add(dp[x][i + j][0][1], 1ll * tmp[i][0][1] * (dp[v][j][0][1] + dp[v][j][1][1]));\n                    dp[x][i + j][0][1] = add(dp[x][i + j][0][1], 1ll * tmp[i][0][0] * dp[v][j][1][1]);\n\n                    dp[x][i + j][1][0] = add(dp[x][i + j][1][0], 1ll * tmp[i][1][0] * (dp[v][j][0][0] + dp[v][j][0][1]));\n\n                    dp[x][i + j][1][1] = add(dp[x][i + j][1][1], 1ll * tmp[i][1][0] * (dp[v][j][1][0] + dp[v][j][1][1]));\n                    dp[x][i + j][1][1] = add(dp[x][i + j][1][1], 1ll * tmp[i][1][1] * (1ll * dp[v][j][0][0] + dp[v][j][0][1] + 1ll * dp[v][j][1][0] + dp[v][j][1][1]));\n                }\n                size[x] += size[v];\n        }\n    }\n}\n\nint main() {\n    read(n); read(K);\n    rep(i, 1, n - 1) {\n        int x, y;\n        read(x); read(y); ae(x, y);\n    }\n    dfs(1, 0);\n    printf(\"%d\\n\", (int)((dp[1][K][0][1] + dp[1][K][1][1]) % mod));\n    return 0;\n}\n```",
        "postTime": 1541262719,
        "uid": 72071,
        "name": "GKxx",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011"
    },
    {
        "content": "\u4e0d\u96be\u60f3\u5230\u4e00\u4e2a\u6c99\u96d5$dp$\uff0c\u8bbe$f[i][j][0/1][0/1]$\u8868\u793a\u5f53\u524d\u70b9$i$\uff0c\u5b50\u6811\u4e2d\u4e00\u5171\u653e\u4e86$j$\u4e2a\uff0c\u8fd9\u4e2a\u70b9\u662f\u5426\u653e\u4e86\uff0c\u8fd9\u4e2a\u662f\u5426\u88ab\u8986\u76d6\u4e86\u3002  \n\u770b\u8d77\u6765\u76f4\u63a5\u5408\u5e76\u662f$O(nk^2)$\u7684QwQ\u3002\u3002\u3002\u3002\u3002  \n\u7136\u540e\u6211\u4ee5\u4e3a\u662f$O(nk^2)$\u7684\u5c31\u4e0d\u4f1a\u505a\u4e86\u5624\u5624\u5624\u3002  \n\u5b9e\u9645\u4e0a\u662f$O(nk)$\u7684\u3002\u3002\u3002  \n\u8bc1\u660e\u5927\u6982\u662f\u8fd9\u6837\u7684\uff08\u4e3a\u5565\u6ce5\u840c\u90fd\u4e0d\u8bc1\u660e\u4e00\u4e0b\u590d\u6742\u5ea6\u7684\u554a\uff09\uff1a  \n\u8003\u8651\u4ec0\u4e48\u65f6\u5019\u4f1a\u4ea7\u751f$O(k^2)$\u7684\u8d21\u732e\uff0c\u5373\u4e00\u4e2a\u70b9\u6709\u4e24\u68f5\u5b50\u6811\u7684\u5927\u5c0f\u5927\u4e8e$k$\uff0c\u800c\u8fd9\u6837\u5b50\u5408\u5e76\u6b21\u6570\u4e0d\u4f1a\u8d85\u8fc7$O(\\frac{n}{k})$\uff0c\u6240\u4ee5\u8fd9\u90e8\u5206\u7684\u590d\u6742\u5ea6\u662f$O(nk)$\u7684\u3002  \n\u53e6\u5916\u4e00\u79cd\u60c5\u51b5\u662f\u4e00\u4e2a\u5b50\u6811\u5c0f\u4e8e$k$\uff0c\u7ecf\u8fc7\u5408\u5e76\u4e4b\u540e\u53d8\u6210\u5927\u4e8e$k$\u7684\u5b50\u6811\u4e86\uff0c\u663e\u7136\u5bf9\u4e8e\u4e00\u4e2a\u70b9\uff0c\u5982\u679c\u5b83\u7684\u5b50\u6811\u5c0f\u4e8e$k$\uff0c\u5728\u67d0\u6b21\u5408\u5e76\u4e4b\u540e\u5b83\u7684\u5b50\u6811\u5c31\u4f1a\u5927\u4e8e$k$\uff0c\u5e76\u4e14\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\u800c\u8a00\uff0c\u53ea\u4f1a\u5728\u4ed6\u7684\u67d0\u4e2a\u7956\u5148\u7684\u5730\u65b9\u7ecf\u5386\u4e00\u6b21\u8fd9\u6837\u5b50\u7684\u5408\u5e76\uff0c\u6240\u4ee5\u8fd9\u6837\u5b50\u5747\u644a\u6bcf\u4e2a\u70b9\u4f1a\u4ea7\u751f$O(k)$\u7684\u8d21\u732e\u3002  \n\u7b2c\u4e09\u79cd\u60c5\u51b5\u662f\u4e24\u4e2a\u70b9\u7684\u5b50\u6811\u5927\u5c0f\u90fd\u5c0f\u4e8e$k$\uff0c\u5408\u5e76\u5b8c\u4e4b\u540e\u4e24\u8005\u8fd8\u662f\u5c0f\u4e8e$k$\u3002\u8fd9\u4e2a\u64cd\u4f5c\u7406\u89e3\u4e3a\u6bcf\u4e2a\u4e24\u4e2a\u96c6\u5408\u4e2d\u7684\u70b9\u4e00\u4e00\u5bf9\u5e94\u7684\u4ea7\u751f\u4e00\u6b21\u8d21\u732e\uff0c\u90a3\u4e48\u76ef\u7740\u67d0\u4e00\u4e2a\u7279\u5b9a\u70b9\u8003\u8651\uff0c\u5b83\u6bcf\u6b21\u4ea7\u751f\u7684\u8d21\u732e\u662f\u5408\u5e76\u8fdb\u6765\u7684\u5b50\u6811\u5927\u5c0f\u7684\uff0c\u56e0\u4e3a\u5728\u8fd9\u4e00\u90e8\u5206\u7684\u8fc7\u7a0b\u4e2d\u5b50\u6811\u5927\u5c0f\u603b\u662f\u5c0f\u4e8e$k$\uff0c\u56e0\u6b64\u6bcf\u4e2a\u70b9\u4ea7\u751f\u7684\u8d21\u732e\u4e5f\u6700\u591a\u662f$O(k)$\u7684\u3002  \n\u7efc\u4e0a\uff0c\u5728\u4e09\u79cd\u5408\u5e76\u60c5\u51b5\u4e2d\uff0c\u6bcf\u79cd\u60c5\u51b5\u4ea7\u751f\u7684\u8d21\u732e\u90fd\u6700\u591a\u662f$O(nk)$\u7684\uff0c\u6240\u4ee5\u5168\u5c40\u7684\u590d\u6742\u5ea6\u5c31\u662f$O(nk)$\u3002  \n\n```cpp\n#include<iostream>\n#include<cstdio>\nusing namespace std;\n#define MAX 100100\n#define MOD 1000000007\nvoid add(int &x,int y){x+=y;if(x>=MOD)x-=MOD;}\ninline int read()\n{\n\tint x=0;bool t=false;char ch=getchar();\n\twhile((ch<'0'||ch>'9')&&ch!='-')ch=getchar();\n\tif(ch=='-')t=true,ch=getchar();\n\twhile(ch<='9'&&ch>='0')x=x*10+ch-48,ch=getchar();\n\treturn t?-x:x;\n}\nstruct Line{int v,next;}e[MAX<<1];\nint h[MAX],cnt=1;\ninline void Add(int u,int v){e[cnt]=(Line){v,h[u]};h[u]=cnt++;}\nint n,K,f[MAX][101][2][2],size[MAX];\nint tmp[101][2][2];\nvoid dfs(int u,int ff)\n{\n\tsize[u]=1;f[u][0][0][0]=1;f[u][1][1][0]=1;\n\tfor(int i=h[u];i;i=e[i].next)\n\t{\n\t\tint v=e[i].v;if(v==ff)continue;dfs(v,u);\n\t\tfor(int j=0;j<=size[u]&&j<=K;++j)\n\t\t\tfor(int k=0;k<=size[v]&&j+k<=K;++k)\n\t\t\t{\n\t\t\t\tif(f[u][j][0][0])\n\t\t\t\t{\n\t\t\t\t\tadd(tmp[j+k][0][0],1ll*f[u][j][0][0]*f[v][k][0][1]%MOD);\n\t\t\t\t\tadd(tmp[j+k][0][1],1ll*f[u][j][0][0]*f[v][k][1][1]%MOD);\n\t\t\t\t}\n\t\t\t\tif(f[u][j][0][1])\n\t\t\t\t{\n\t\t\t\t\tadd(tmp[j+k][0][1],1ll*f[u][j][0][1]*(f[v][k][0][1]+f[v][k][1][1])%MOD);\n\t\t\t\t}\n\t\t\t\tif(f[u][j][1][0])\n\t\t\t\t{\n\t\t\t\t\tadd(tmp[j+k][1][0],1ll*f[u][j][1][0]*(f[v][k][0][0]+f[v][k][0][1])%MOD);\n\t\t\t\t\tadd(tmp[j+k][1][1],1ll*f[u][j][1][0]*(f[v][k][1][0]+f[v][k][1][1])%MOD);\n\t\t\t\t}\n\t\t\t\tif(f[u][j][1][1])\n\t\t\t\t{\n\t\t\t\t\tint s=0;\n\t\t\t\t\tadd(s,f[v][k][0][0]);add(s,f[v][k][0][1]);\n\t\t\t\t\tadd(s,f[v][k][1][0]);add(s,f[v][k][1][1]);\n\t\t\t\t\tadd(tmp[j+k][1][1],1ll*f[u][j][1][1]*s%MOD);\n\t\t\t\t}\n\t\t\t}\n\t\tsize[u]+=size[v];\n\t\tfor(int j=0;j<=size[u]&&j<=K;++j)\n\t\t{\n\t\t\tf[u][j][0][0]=tmp[j][0][0];tmp[j][0][0]=0;\n\t\t\tf[u][j][0][1]=tmp[j][0][1];tmp[j][0][1]=0;\n\t\t\tf[u][j][1][0]=tmp[j][1][0];tmp[j][1][0]=0;\n\t\t\tf[u][j][1][1]=tmp[j][1][1];tmp[j][1][1]=0;\n\t\t}\n\t}\n}\nint main()\n{\n\tn=read();K=read();\n\tfor(int i=1,u,v;i<n;++i)u=read(),v=read(),Add(u,v),Add(v,u);\n\tdfs(1,0);\n\tint ans=(f[1][K][0][1]+f[1][K][1][1])%MOD;\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1550752756,
        "uid": 21283,
        "name": "yybyyb",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011"
    },
    {
        "content": "\u5927\u5bb6\u90fd\u662f\u56db\u7ef4 DP $f[u][k][0/1][0/1]$ \uff0c\u8fd9\u9898\u96be\u5c31\u96be\u5728\u4e0a\u4e0b\u754c\u4f18\u5316\u7684\u590d\u6742\u5ea6\u5206\u6790\u548c\u8f6c\u79fb\u3002 \n\u4e0a\u4e0b\u754c\u4f18\u5316\u7684\u590d\u6742\u5ea6\u5206\u6790\u5c31\u4e0d\u7ec6\u8bb2\u4e86\uff0c\u5173\u952e\u70b9\u5728\u4e8e\u8fdb\u884c $O(k^2)$ \u7684\u80cc\u5305\u8f6c\u79fb\u7684\u6b21\u6570\u7684\u662f $O(\\frac{n}{k})$ \u7684\u3002\n\n\u800c\u8f6c\u79fb\u6211\u60f3\u8bf4\u8fd9\u4e48\u591a `01` \u5199\u8d77\u6765\u4e0d\u7d2f\u561b\u3002\u3002\u3002\n\n\u4e8b\u5b9e\u4e0a\u5bf9\u4e8e\u8fd9\u4e2a `01` \u53ef\u4ee5\u7528\u53d8\u91cf\u8868\u793a\uff0c\u5047\u8bbe\u5f53\u524d\u5408\u5e76\u4e24\u4e2a\u80cc\u5305 $f[u][a][p1][q1]$ \u548c $f[v][b][p2][q2]$ \uff0c  \n\u5176\u4e2d $v$ \u662f $u$ \u7684\u513f\u5b50\u3002\n\n\u8003\u8651\u5408\u5e76\u540e\u7684 $f[u][a+b][p3][q3]$ \uff0c$p3$ \u548c $q3$ \u5206\u522b\u4f1a\u662f\u4ec0\u4e48\uff0c\u4ee5\u53ca\u8fd9\u4e2a\u5408\u5e76\u4ec0\u4e48\u65f6\u5019\u5408\u6cd5\u3002\n\n$p3$ \u662f\u5408\u5e76\u540e\u70b9 $u$ \u662f\u5426\u5b89\u88c5\u76d1\u542c\u5668\uff0c\u8fd9\u663e\u7136\u4e0d\u53d7 $v$ \u5f71\u54cd\uff0c\u4e5f\u5c31\u662f\u8bf4 $p3=p1$ \u3002\n\n$q3$ \u662f\u5408\u5e76\u540e\u70b9 $u$ \u662f\u5426\u88ab\u76d1\u542c\uff0c\u6709\u4e24\u79cd\u60c5\u51b5\uff1a$u$ \u4e4b\u524d\u5df2\u7ecf\u88ab\u76d1\u542c\uff0c$u$ \u73b0\u5728\u88ab $v$ \u76d1\u542c\u3002\u5373\uff1a$q3=q1|p2$ \u3002\n\n\u4f46\u662f\u4e0d\u662f\u6240\u6709\u72b6\u6001\u90fd\u80fd\u5408\u5e76\u7684\uff0c\u53ef\u4ee5\u5408\u5e76\u5f53\u4e14\u4ec5\u5f53 $v$ \u88ab\u76d1\u542c\uff0c  \n$v$ \u88ab\u76d1\u542c\u540c\u6837\u6709\u4e24\u79cd\u60c5\u51b5\uff1a$v$ \u4e4b\u524d\u88ab\u76d1\u542c\uff0c$v$ \u73b0\u5728\u88ab $u$ \u76d1\u542c\u3002  \n\u4e5f\u5c31\u662f\u8bf4\u5f53\u4e14\u4ec5\u5f53 $q2|p1=1$ \u65f6\u8fd9\u4e24\u4e2a\u72b6\u6001\u53ef\u4ee5\u5408\u5e76\u3002\n\n\u4e8e\u662f\u5f97\u5230\u4e00\u4e2a\u6e05\u723d\u7684 4 \u4e2a for \u8f6c\u79fb\uff1a\n\n```cpp\nfor(int p1 = 0; p1 < 2; p1 ++)\n\tfor(int q1 = 0; q1 < 2; q1 ++)\n\t\tfor(int p2 = 0; p2 < 2; p2 ++)\n\t\t\tfor(int q2 = 0; q2 < 2; q2 ++)\n\t\t\t\tif(q2 | p1)\n\t\t\t\t\t(newf_u[a + b][p1][q1 | p2] +=\n\t\t\t\t\t\t\tf[u][a][p1][q1] * f[v][b][p2][q2]) %= mod;\n```\n\n\u8fd9\u6837\u4e0d\u5bb9\u6613\u5199\u9519\uff0c\u5982\u679c\u5168\u5199 `01` \u624b\u52a8\u679a\u4e3e\u6240\u6709\u60c5\u51b5\uff0c\u5f88\u5bb9\u6613\u6f0f\u7b97\u6216\u8005\u5199\u9519\u4e00\u4e2a `01` \u4e4b\u7c7b\u7684\uff0c  \n\u800c\u4e14\u5f88\u96be\u8c03\u8bd5\u3002\n\n\u5b8c\u6574\u5b9e\u73b0\uff1a\n```cpp\n#include <cstdio>\n#include <vector>\n\ntypedef long long ll;\n\nconst int maxn = 100005, maxk = 104, mod = 1000000007;\nint f[maxn][maxk][2][2];\nint g[maxk][2][2];\nint lim[maxn];\nstd::vector<int> G[maxn];\n\ninline void __a(int &x) { if(x >= mod) x -= mod; }\n\nint N, K;\nvoid dp(int u, int fa) {\n\tf[u][0][0][0] = 1;\n\tf[u][1][1][0] = 1;\n\tlim[u] = 1;\n\n\tfor(int v : G[u])\n\t\tif(v != fa) {\n\t\t\tdp(v, u);\n\n\t\t\tint nlim = std::min(lim[u] + lim[v], K);\n\t\t\tfor(int a = 0; a <= lim[u]; a ++)\n\t\t\t\tfor(int b = 0; b <= lim[v] and a + b <= nlim; b ++) {\n\t\t\t\t\tfor(int p1 = 0; p1 < 2; p1 ++)\n\t\t\t\t\t\tfor(int q1 = 0; q1 < 2; q1 ++)\n\t\t\t\t\t\t\tfor(int p2 = 0; p2 < 2; p2 ++)\n\t\t\t\t\t\t\t\tfor(int q2 = 0; q2 < 2; q2 ++)\n\t\t\t\t\t\t\t\t\tif(q2 | p1)\n\t\t\t\t\t\t\t\t\t\t__a(g[a + b][p1][q1 | p2] +=\n\t\t\t\t\t\t\t\t\t\t 1ll * f[u][a][p1][q1] * f[v][b][p2][q2] % mod);\n\t\t\t\t}\n\n\t\t\tfor(int k = 0; k <= nlim; k ++)\n\t\t\t\tfor(int p = 0; p < 2; p ++)\n\t\t\t\t\tfor(int q = 0; q < 2; q ++)\n\t\t\t\t\t\tf[u][k][p][q] = g[k][p][q];\n\t\t\tfor(int k = 0; k <= nlim; k ++)\n\t\t\t\tg[k][0][0] = g[k][0][1] = g[k][1][0] = g[k][1][1] = 0;\n\t\t\tlim[u] = nlim;\n\t\t}\n}\n\nint main() {\n\tscanf(\"%d %d\", &N, &K);\n\tfor(int i = 1; i < N; i ++) {\n\t\tint u, v;\n\t\tscanf(\"%d %d\", &u, &v);\n\t\tG[u].push_back(v);\n\t\tG[v].push_back(u);\n\t}\n\tdp(1, 0);\n\tprintf(\"%d\\n\", (f[1][K][0][1] + f[1][K][1][1]) % mod);\n}\n```\n",
        "postTime": 1577712350,
        "uid": 52232,
        "name": "Kewth",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u4e2a\u5e76\u4e0d\u7b80\u5355\u7684\u80cc\u5305\u7c7b\u6811\u5f62dp\u2026\u2026\n\n~~\u5f88\u81ea\u7136\u5730~~\u60f3\u5230\u72b6\u6001\u5b9a\u4e49\uff1a$f[u][k][0/1][0/1]$\u8868\u793a\u4ee5$u$\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\uff0c\u603b\u5171\u9009\u62e9$k$\u4e2a\u7ed3\u70b9\uff0c\u5176\u4e2d\u9664\u4e86$u$\u4ee5\u5916\u7684\u6240\u6709\u7ed3\u70b9\u5747\u88ab\u76d1\u542c\u5230\uff0c$u$\u7ed3\u70b9\u9009\u6216\u4e0d\u9009\uff0c$u$\u7ed3\u70b9\u662f\u5426\u88ab\u8986\u76d6\u7684\u60c5\u51b5\u4e0b\uff0c\u4e00\u5171\u6709\u591a\u5c11\u79cd\u65b9\u6848\u3002\n\n\u72b6\u6001\u8f6c\u79fb\u770b\u4f3c\u5341\u5206\u9ebb\u70e6\u3002\u6bcf\u4e2a\u7ed3\u70b9$u$\u90fd\u6709\u8bb8\u591a\u5b50\u7ed3\u70b9\uff0c\u5f88\u96be\u7edf\u8ba1\u51fa\u6bcf\u4e2a\u5b50\u7ed3\u70b9\u7684\u6240\u6709\u60c5\u51b5\uff08\u4f3c\u4e4e\u5728\u7ec4\u5408\u6570\u5b66\u7684\u8303\u7574\uff09\u3002\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u7528\u5341\u5206\u5de7\u5999\u7684\u6811\u5f62\u80cc\u5305\u6765\u8fdb\u884c\u72b6\u6001\u8f6c\u79fb\u3002\u6811\u4e0a\u80cc\u5305\u7684\u8f6c\u79fb\u5957\u8def\u662f\uff1a\n\n$$\nf[u][i+j]=combine(f[u][i],f[v][j])\n$$\n\n\u76f8\u5f53\u4e8e\u6bcf\u9012\u5f52\u8bbf\u95ee\u5b8c\u4e00\u4e2a\u5b50\u7ed3\u70b9\uff0c\u5c31\u628a\u5b50\u8282\u70b9\u4e0a\u7684\u72b6\u6001\u4e0e\u5f53\u524d\u5df2\u7ecf\u5904\u7406\u7684\u72b6\u6001\u4e00\u4e00\u914d\u5bf9\uff0c\u4fdd\u8bc1\u4e0d\u91cd\u4e0d\u6f0f\u4e14\u517c\u987e\u6548\u7387\u3002\u5177\u4f53\u7684\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\n\n$$\nf[u][i+j][0][0]=\\sum f[u][i][0][0]*f[v][j][0][1]\n$$\n\n$$\nf[u][i+j][1][0]=\\sum f[u][i][1][0]*(f[v][j][0][0]+f[v][j][0][1])\n$$\n\n$$\nf[u][i+j][0][1]=\\sum (f[u][i][0][1]\\*(f[v][j][0][1]+f[v][j][1][1])+f[u][i][0][0]\\*f[v][j][1][1]\n$$\n\n$$\nf[u][i+j][1][1]=\\sum (f[u][i][1][0]\\*(f[v][j][1][0]+f[v][j][1][1])+f[u][i][1][1]\\*(f[v][j][0][0]+f[v][j][0][1]+f[v][j][1][0]+f[v][j][1][1]))\n$$\n\n\u5177\u4f53\u5b9e\u73b0\u65f6\u8fd8\u5e94\u6ce8\u610f\uff1a\u56e0\u4e3a\u9636\u6bb5\uff08\u5373\u626b\u63cf\u5b50\u7ed3\u70b9\u4e2a\u6570\uff09\u7684\u5212\u5206\uff0c\u5728\u6bcf\u6b21\u8f6c\u79fb\u524d\u90fd\u8981\u5148\u8bb0\u5f55\u539f\u59cb\u7684$u$\u7ed3\u70b9\u4e0a\u7684\u6570\u636e\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4\u6df7\u4e71\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n\nconst int MAXN=100005;\nconst int mod=1000000007;\n\nint N,K;\nint f[MAXN][105][2][2];\nint g[105][2][2];\nint size[MAXN];\n\nvector<int> G[MAXN];\n\ninline int Mod(ll x,ll y){\n    x%=mod,y%=mod;\n    return (int)(x+y)%mod;\n}\n\nvoid dp(int u,int fa){\n    size[u]=1;\n    f[u][0][0][0]=f[u][1][1][0]=1;\n    for(vector<int>::iterator it=G[u].begin();it!=G[u].end();it++){\n        int v=*it;\n        if(v==fa) continue;\n        dp(v,u);\n        for(register int i=0;i<=min(size[u],K);++i){\n            g[i][0][0]=f[u][i][0][0],f[u][i][0][0]=0;\n            g[i][0][1]=f[u][i][0][1],f[u][i][0][1]=0;\n            g[i][1][0]=f[u][i][1][0],f[u][i][1][0]=0;\n            g[i][1][1]=f[u][i][1][1],f[u][i][1][1]=0;\n        }\n        for(register int i=0;i<=min(size[u],K);++i){\n            for(register int j=0;j<=min(size[v],K-i);++j){\n                f[u][i+j][0][0]=Mod((ll)f[u][i+j][0][0],(ll)g[i][0][0]*(ll)f[v][j][0][1]);\n                f[u][i+j][0][1]=Mod((ll)f[u][i+j][0][1],(ll)g[i][0][0]*(ll)f[v][j][1][1]+(ll)g[i][0][1]*((ll)f[v][j][1][1]+(ll)f[v][j][0][1]));\n                f[u][i+j][1][0]=Mod((ll)f[u][i+j][1][0],(ll)g[i][1][0]*((ll)f[v][j][0][0]+(ll)f[v][j][0][1]));\n                f[u][i+j][1][1]=Mod((ll)f[u][i+j][1][1],(ll)g[i][1][0]*((ll)f[v][j][1][0]+(ll)f[v][j][1][1])+(ll)g[i][1][1]*((ll)f[v][j][0][0]+(ll)f[v][j][0][1]+(ll)f[v][j][1][0]+(ll)f[v][j][1][1]));\n            }\n        }\n        size[u]+=size[v];\n    }\n}\n\nint main(){\n    scanf(\"%d%d\",&N,&K);\n    for(register int i=1;i<N;++i){\n        int u,v;\n        scanf(\"%d%d\",&u,&v);\n        G[u].push_back(v);\n        G[v].push_back(u);\n    }\n    dp(1,0);\n    printf(\"%d\",(int)(f[1][K][0][1]+f[1][K][1][1])%mod);\n    return 0;\n}\n```",
        "postTime": 1553858544,
        "uid": 116851,
        "name": "_\u98ce\u4f11\u4f4f",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011"
    },
    {
        "content": "[P4516 [JSOI2018]\u6f5c\u5165\u884c\u52a8](https://www.luogu.com.cn/problem/P4516)\n\n\u8fd9\u662f\u4e00\u9053\u6811\u4e0a\u80cc\u5305\u7684\u9898\u76ee\uff0c\u5f88\u79bb\u8c31\uff08\u6628\u5929\u4eba\u8ba9\u4e00\u4e2a\u5927\u4f6c\u6559\u6211\uff0c\u624d\u52c9\u5f3a\u770b\u61c2\uff09\n\n\u9996\u5148\u5b9a\u4e49\u4e00\u4e2a\u6570\u7ec4\n\n$ dp [u] [i] [0/1] [0/1] \\implies $ \u4ee5 $u$ \u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\uff0c\u5728\u653e\u4e86 $i$ \u4e2a\u76d1\u89c6\u5668,\u4fdd\u8bc1\u5168\u90e8\u7684\u5b50\u6811\u4e0a\u70b9\u90fd\u88ab\u76d1\u89c6\u5230\u7684\u60c5\u51b5\u4e0b\uff0c\u5e26\u70b9 $u$ \u4e0a\u653e\u4e0e\u4e0d\u653e\u76d1\u89c6\u5668\uff0c\u4e14\u662f\u5426\u88ab\u76d1\u89c6\u5230\u3002\n\n\u5728\u770b\u51fa\u80cc\u5305\u540e\uff0c\u6211\u4eec\u53bb\u5bfb\u627e\u8f6c\u79fb\u65b9\u7a0b\uff0c\n\n\u73b0\u5728\u5047\u8bbe\uff0c\u6211\u4eec\u5df2\u5c06\u67e5\u8be2\u5230\u4e86\u4ee5 $u$ \u4e3a\u6839\u8282\u70b9\u7684\u6811 $k$ \uff0c\u6b64\u65f6\u53d1\u73b0\u4e86\u8fd9\u4e2a\u6811\u7684\u4e0b\u65b9\u8fd8\u6709\u4e00\u4e2a\u8fd8\u6709\u4ee5 $v$ \u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811 $f$\uff0c\u4e8e\u662f\u628a\u8fd9\u4e2a\u5b50\u6811\u5c31\u5e76\u5217\u8fc7\u6765\u3002\u5982\u56fe\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4y91ygow.png)\n\n\n------------\n\n$$\n\\forall dp[u][i][0][0]\n$$\n\n$u$\u70b9\u6ca1\u6709\u88ab\u653e\u7f6e\uff0c\u4e14\u6ca1\u6709\u88ab\u76d1\u89c6\u5230\n\n\u6240\u4ee5 $v$ \u70b9\u5904\u5fc5\u7136\u4e0d\u80fd\u653e\u76d1\u89c6\u5668\uff0c\u4f46\u4e0d\u5f71\u54cd $v$ \u70b9\u88ab\u76d1\u542c\n\n$$\n\\therefore dp[u][i+j][0][0] = \\sum dp[u][i][0][0] \\times dp[v][j][0][1]\n$$\n\n------------\n\n$$\n\\forall dp[u][i][0][1]\n$$\n\n\u8fd9\u79cd\u60c5\u51b5\u8981\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n- $u$ \u4e00\u4fa7\u5b50\u6811\u7684\u72b6\u6001\u4e3a $dp[u][i][0][1]$\n\n\u8fd9\u65f6\u5019 $u$ \u5df2\u7ecf\u88ab\u76d1\u89c6\u4e86\uff0c\u6240\u4ee5\u5728\u4e0d\u5728 $v$ \u5904\u653e\u76d1\u89c6\u5668\uff0c\u5df2\u7ecf\u65e0\u4f24\u5927\u96c5\u4e86\uff0c\u4f46\u662f\u8981\u4fdd\u8bc1\u6bcf\u4e2a\u70b9\u90fd\u88ab\u76d1\u89c6\u5230\u6240\u4ee5 $v$ \u70b9\u5fc5\u987b\u88ab\u76d1\u89c6\n\n\n- $u$ \u4e00\u4fa7\u5b50\u6811\u7684\u72b6\u6001\u4e3a $dp[u][i][0][0]$\n\n\u8fd9\u65f6\u5019 $u$ \u8fd8\u6ca1\u88ab\u76d1\u89c6\uff0c\u6240\u4ee5\u4e00\u5b9a\u8981\u5728 $v$ \u5904\u653e\u76d1\u89c6\u5668\uff0c\u540c\u65f6\u8981\u4fdd\u8bc1\u6bcf\u4e2a\u70b9\u90fd\u88ab\u76d1\u89c6\u5230\u6240\u4ee5 $v$ \u70b9\u4e5f\u5fc5\u987b\u88ab\u76d1\u89c6\n\n$$\n\\therefore dp[u][i+j][0][1] = \\sum (dp[u][i][0][1] \\times (dp[v][j][0][1] + dp[v][j][1][1]) + dp[u][i][0][0] \\times dp[v][j][1][1])\n$$\n\n------------\n\n$$\n\\forall dp[u][i][1][0]\n$$\n\n $u$ \u6ca1\u88ab\u76d1\u89c6\u4f46\u662f\u653e\u4e86\u76d1\u89c6\u5668\uff0c\u6240\u4ee5 $u$ \u4e00\u4fa7\u5b50\u6811\u7684\u72b6\u6001\u4e00\u5b9a\u662f $dp[u][i][1][0]$\uff0c $v$ \u662f\u5426\u88ab\u76d1\u89c6\u65e0\u6240\u8c13\uff0c\u4f46\u662f\u4e00\u5b9a\u4e0d\u80fd\u653e\u88c5\u7f6e\n\n$$\n\\therefore dp[u][i+j][1][0] = \\sum dp[u][i][1][0] \\times (dp[v][j][0][0] + dp[v][j][0][1])\n$$\n\n------------\n\n$$\n\\forall dp[u][i][1][1]\n$$\n\n\u8fd9\u79cd\u60c5\u51b5\u4e5f\u8981\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n\n- $u$ \u4e00\u4fa7\u5b50\u6811\u7684\u72b6\u6001\u4e3a $dp[u][i][1][0]$\n\n\u6240\u4ee5\u8981\u8ba9 $v$ \u70b9\u4e0a\u653e\u76d1\u89c6\u5668\u6765\u76d1\u89c6 $u$ \u4f46\u662f $v$ \u70b9\u6ca1\u6709\u5fc5\u8981\u88ab\u76d1\u542c\n\n- $u$ \u4e00\u4fa7\u5b50\u6811\u7684\u72b6\u6001\u4e3a $dp[u][i][1][1]$\n\n$u$ \u5df2\u7ecf\u88ab $k$ \u4fa7\u5b50\u6811\u6ee1\u8db3\u4e86\uff0c\u6240\u4ee5\u5bf9\u4e8e $v$ \u6765\u8bf4\u53ef\u4ee5\u968f\u4fbf\u9009\n\n$$\n\\therefore dp[u][i+j][1][1] = \\sum (dp[u][i][1][0] \\times (dp[v][j][1][0] + dp[v][j][1][1]) + dp[u][i][1][1] * (dp[v][j][0][0] + dp[v][j][0][1] + dp[v][j][1][0] + dp[v][j][1][1]))\n$$\n\n------------\n\n\u7efc\u4e0a\u6240\u8ff0\n\n$dp[u][i+j][0][0] = \\sum dp[u][i][0][0] \\times dp[v][j][0][1]$\n\n$dp[u][i+j][0][1] = \\sum (dp[u][i][0][1] \\times (dp[v][j][0][1] + dp[v][j][1][1]) + dp[u][i][0][0] \\times dp[v][j][1][1])$\n\n$dp[u][i+j][1][0] = \\sum dp[u][i][1][0] \\times (dp[v][j][0][0] + dp[v][j][0][1])$\n\n$dp[u][i+j][1][1] = \\sum (dp[u][i][1][0] \\times (dp[v][j][1][0] + dp[v][j][1][1]) + dp[u][i][1][1] * (dp[v][j][0][0] + dp[v][j][0][1] + dp[v][j][1][0] + dp[v][j][1][1]))$\n\n\n------------\n\n# code\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int SIZE = 1e5 + 7;\nconst int NUM = 107;\nconst int mod = 1e9 + 7;\n\ninline int read()\n{\n\tint x = 0;\n\tchar ch = getchar();\n\twhile (ch < '0' || ch > '9')\n\t\tch = getchar();\n\twhile (ch >= '0' && ch <= '9')\n\t{\n\t\tx = (x << 1) + (x << 3) + (ch ^ 48);\n\t\tch = getchar();\n\t}\n\treturn x;\n}\n\nint n,k,num_edge;\nint head[SIZE],siz[SIZE];\nint dp[SIZE][NUM][2][2],tmp[NUM][2][2];\nstruct node\n{\n\tint to,nxt;\n};\nnode edge[SIZE << 1];\n\ninline void add(int u,int v)\n{\n\tedge[++num_edge].to = v;\n\tedge[num_edge].nxt = head[u];\n\thead[u] = num_edge;\n}\n\ninline int solve(int u,long long v)\n{\n\tif (v >= mod) v = v % mod;\n\tfor (u += v; u >= mod; u -= mod);\n\treturn u;\n}\n\nvoid dfs(int u,int fa)\n{\n\tsiz[u] = dp[u][0][0][0] = dp[u][1][1][0] = 1;\n\tfor (int t = head[u]; t ; t = edge[t].nxt)\n\t{\n\t\tint v = edge[t].to;\n\t\tif (v == fa) continue;\n\t\tdfs(v,u);\n\t\tint side = min(siz[u],k);\n\t\tfor (int i = 0; i <= side; ++i)\n\t\t{\n\t\t\ttmp[i][0][0] = dp[u][i][0][0];\n\t\t\tdp[u][i][0][0] = 0;\n\t\t\ttmp[i][0][1] = dp[u][i][0][1];\n\t\t\tdp[u][i][0][1] = 0;\n\t\t\ttmp[i][1][0] = dp[u][i][1][0];\n\t\t\tdp[u][i][1][0] = 0;\n\t\t\ttmp[i][1][1] = dp[u][i][1][1];\n\t\t\tdp[u][i][1][1] = 0;\n\t\t}\n\t\tfor (int i = 0; i <= side; ++i)\n\t\t{\n\t\t\tint limit = min(siz[v],k-i);\n\t\t\tfor (int j = 0; j <= limit; ++j)\n\t\t\t{\n\t\t\t\tdp[u][i+j][0][0] = solve(dp[u][i+j][0][0],1ll * tmp[i][0][0] * dp[v][j][0][1]);\n\t\t\t\tdp[u][i+j][0][1] = solve(dp[u][i+j][0][1],1ll * tmp[i][0][1] * (dp[v][j][0][1] + dp[v][j][1][1]));\n\t\t\t\tdp[u][i+j][0][1] = solve(dp[u][i+j][0][1],1ll * tmp[i][0][0] * dp[v][j][1][1]);\n\t\t\t\tdp[u][i+j][1][0] = solve(dp[u][i+j][1][0],1ll * tmp[i][1][0] * (dp[v][j][0][0] + dp[v][j][0][1]));\n\t\t\t\tdp[u][i+j][1][1] = solve(dp[u][i+j][1][1],1ll * tmp[i][1][0] * (dp[v][j][1][0] + dp[v][j][1][1]));\n\t\t\t\tdp[u][i+j][1][1] = solve(dp[u][i+j][1][1],1ll * tmp[i][1][1] * (1ll * dp[v][j][0][0] + 1ll * dp[v][j][0][1] + 1ll * dp[v][j][1][0] + 1ll * dp[v][j][1][1]));\n\t\t\t}\n\t\t}\n\t\tsiz[u] += siz[v];\n\t}\n}\nint main()\n{\n\tn = read();k = read();\n\tfor (int i = 1; i < n; ++i)\n\t{\n\t\tint u = read(),v = read();\n\t\tadd(u,v);\n\t\tadd(v,u);\n\t}\n\tdfs(1,0);\n\tprintf(\"%d\\n\",(dp[1][k][0][1] + dp[1][k][1][1]) % mod);\n\treturn 0;\n}\n```\n\n\u6ce8\u610f\u8fd9\u9053\u9898\u5361\u7a7a\u95f4,\u8fd0\u7b97\u65f6\u5148\u8f6c\u6210 $long $ $long$ \u4e4b\u540e\u518d\u8f6c\u56de\u6765\u3002",
        "postTime": 1603412119,
        "uid": 129390,
        "name": "yangwenbin",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011"
    },
    {
        "content": "\u8fd9\u91cc\u7740\u91cd\u5206\u6790\u4e0b\u6ca1\u4ec0\u4e48\u4eba\u8bb2\u7684\u590d\u6742\u5ea6\uff08\u4e5f\u662f\u672c\u9898\u7684\u91cd\u70b9\uff09\n\n## \u89e3\u6790\n\n\u72b6\u6001\u8bbe\u8ba1\u548c\u80cc\u5305\u90e8\u5206\u5df2\u7ecf\u5f88\u591a\u4eba\u8bb2\u4e86\uff0c\u5e76\u4e14\u90fd\u5f88\u5e73\u51e1\n\n\u8fd9\u91cc\u5c31\u7740\u91cd\u5206\u6790\u4e0b\u7a0b\u5e8f\u7684\u590d\u6742\u5ea6\n\n\u9996\u5148\u80cc\u5305\u90e8\u5206\u4ee3\u7801\u5dee\u4e0d\u591a\u8fd9\u6837\uff1a\n\n```cpp\nvoid dfs(int u, int fa){\n\tsiz[u] =1;\n\tdp[u][0][0][0] =1;\n\tif(k > 0)\n\t\tdp[u][1][1][0] =1;\n\tfor(int l =first[u]; l; l =e[l].net)\n\t\tif(e[l].to != fa){\n\t\t\tdfs(e[l].to, u);\n\t\t\tfor(int i =0; i <= min(siz[u], k); ++i){/*\u4fdd\u5b58\u4e0a\u4e00\u6b21 dp \u503c*/\n\t\t\t\t/*...*/\n\t\t\t}\n\t\t\tfor(int i =0; i <= min(siz[u], k); ++i)\n\t\t\t\tfor(int j =0; j <= min(siz[e[l].to], k) && i+j <= k; ++j){\n\t\t\t\t\t/*...*/\n\t\t\t\t}\n\t\t\tsiz[u] +=siz[e[l].to];\n\t\t}\n}\n```\n\n\u6211\u4eec\u5148\u505a\u51fa\u6811\u7684 dfs \u5e8f\n\n\u8003\u8651\u5408\u5e76\u4e24\u6bb5\u5e8f\u5217 $A,B$\uff08$A$ \u5728\u5de6\uff0c$B$ \u5728\u540e\uff09\uff0c\u5176\u590d\u6742\u5ea6\u4e3a $O(\\min(|A|,k)\\cdot \\min(|B|,k))$\uff1b\u53ef\u4ee5\u7406\u89e3\u4e3a\u4ece\u5e8f\u5217 $A$ \u9009\u51fa\u540e\uff08\u81f3\u591a\uff09 $k$ \u4e2a\uff0c\u4ece $B $ \u9009\u51fa\u524d $k$ \u4e2a\uff0c\u7136\u540e\u5b83\u4eec\u4e24\u4e24\u914d\u5bf9\u8d77\u6765\u7684\u65b9\u6848\u6570\n\n\u8003\u8651\u4e00\u4e2a\u70b9\u7684\u8d21\u732e\uff0c\u663e\u7136\u5b83\u53ea\u4f1a\u548c dfs \u5e8f\u76f8\u90bb\u7684\u5de6\u53f3 $2k$ \u4e2a\uff08\u5171 $4k$\uff09\u4e2a\u70b9\u5339\u914d\n\n\u63a5\u7740\u6211\u4eec\u8003\u8651\u4e00\u5bf9\u70b9\u4f1a\u4e0d\u4f1a\u88ab\u591a\u6b21\u5339\u914d\u3002\u5f53\u4e00\u5bf9\u70b9\u88ab\u5339\u914d\u65f6\uff0c\u5b83\u4eec\u5728\u5e8f\u5217\u4e2d\u5dee\u4e0d\u591a\u662f\u8fd9\u6837\u7684\uff1a\n\n![mark](https://cdn.luogu.com.cn/upload/image_hosting/ckz0kktk.png)\n\n\u5982\u679c\u8fd9\u5bf9\u70b9\u88ab\u591a\u6b21\u5339\u914d\uff0c\u5c31\u76f8\u5f53\u4e8e\u5de6\u53f3\u79fb\u52a8\u8c03\u6574\u5e8f\u5217\u7684\u65b9\u6846\uff08\u53ca\u65ad\u70b9\uff09\uff0c\u5e76\u4f7f\u8fd9\u4e24\u4e2a\u70b9\u4ecd\u65e7\u5728\u4e2d\u95f4 $2k$ \u65b9\u6846\u5185\n\n\u6211\u4eec\u53ef\u80fd\u4ea7\u751f\u7684\u65b9\u6846\u4e0e\u914d\u5bf9\u70b9\u5728\u56fe\u4e2d\u7684\u8868\u73b0\u603b\u662f\u8fd9\u4e09\u79cd\u4e4b\u4e00\uff1a\n\n![inmap](https://cdn.luogu.com.cn/upload/image_hosting/1yq9j4an.png)\n\n\u800c\u65e0\u8bba\u65b9\u6846\u5982\u4f55\u8c03\u6574\uff0c\u663e\u7136\u90fd\u4e0d\u53ef\u80fd\u6ee1\u8db3\u4e0a\u9762\u7684\u4e09\u79cd\u60c5\u51b5\n\n\u975e\u5f62\u5f0f\u5316\u7684\u8bb2\uff0c\u9996\u5148\u7531\u4e8e dfs \u5e8f\uff0c\u6211\u4eec\u5728 dfs \u4e2d\u5b50\u6811\u7684\u5408\u5e76\u987a\u5e8f\u662f\u552f\u4e00\u7684\uff0c\u56e0\u6b64\u60c5\u51b5\u4e09\u5de6\u4fa7\u7684 \u201c\u5b50\u6811\u96c6\u5408\u201d \u7684\u72b6\u6001\u4e5f\u662f\u552f\u4e00\u7684\uff1b\u540c\u65f6\u8fd9\u4e5f\u786e\u5b9a\u4e86\u5b50\u6811\u7684\u5148\u540e\u987a\u5e8f\n\n\u5bf9\u4e8e\u60c5\u51b5\u4e8c\u3001\u4e09\u53ea\u6709\u4e24\u4e2a\u914d\u5bf9\u70b9\u7684 lca \u4f5c\u4e3a\u84dd\u8272\u7ed3\u70b9\u624d\u80fd\u6ee1\u8db3\u8981\u6c42\uff1b\u5bf9\u4e8e\u60c5\u51b5\u4e00\u4e5f\u540c\u7406\n\n\u7531\u6b64\u53ef\u5f97\u4e00\u5bf9\u70b9\u4e0d\u4f1a\u88ab\u91cd\u590d\u7edf\u8ba1\u8d21\u732e\n\n\u603b\u7684\u590d\u6742\u5ea6\u5c31\u662f $O(nk)$\n\n&nbsp;\n\n_[\u53c2\u8003](https://www.luogu.com.cn/blog/i207M/shu-xing-bei-bao-di-fu-za-du-cf1097g-vladislav-and-a-great-legend-xi)_ \uff0c\u8fd9\u8c8c\u4f3c\u8fd8\u662f\u4e2a\u633a\u5b9e\u7528\u7684 trick\uff0c\u9700\u8981\u6ee1\u8db3\u80cc\u5305\u5bb9\u91cf\u53d7\u5b50\u6811\u5927\u5c0f\u9650\u5236\uff08\u4f8b\u5982\u4e00\u4e9b\u67d3\u8272\u9009\u53d6\u653e\u7f6e\u95ee\u9898\u7b49\uff09\n\n## CODE\n\n\u6ce8\u610f\u7528 vector \u53ef\u4ee5\u5927\u5927\u52a0\u5feb\u7a0b\u5e8f\u5728\u672c\u9898\u7684\u901f\u5ea6\n\n\u5927\u81f4\u539f\u56e0\uff1a\n\n> \u201c\u7136\u540e\u89c2\u5bdf\u6570\u636e\uff0c$n$ \u8fdc\u5927\u4e8e $k$\uff0c\u5982\u679c\u6811\u592a\u6df1\u7b54\u6848\u4e00\u5b9a\u662f $0$\uff0c\u51fa\u9898\u4eba\u53ef\u80fd\u4e0d\u60f3\u8ba9\u8f93\u51fa $0$ \u7684\u4eba\u62ff\u9ad8\u5206\uff0c\u90a3\u4e48\u8fd9\u9897\u6811\u8282\u70b9\u7684\u5ea6\u6570\u5927\u6982\u7387\u975e\u5e38\u5927\uff0c\u8fd1\u4f3c\u4e00\u4e2a\u83ca\u82b1\u56fe\u3002\n\u8fd9\u65f6\u518d\u5199\u94fe\u8868\u663e\u7136\u662f\u4e0d\u660e\u667a\u7684\u505a\u6cd5\uff0c\u5229\u7528 vector \u5185\u5b58\u8fde\u7eed\u7684\u7279\u6027\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u6bd4\u94fe\u8868\u8981\u5feb\u4e86\u3002\u5c31\u4e0d\u4f1a\u51fa\u73b0\u63d0\u4ea4\u8bb0\u5f55\u91cc\u9762\u7684\u4e00\u7247 $80$ \u5206\uff0c\u5f00 O2 \u540e $100$ \u5206\u7684\u5c34\u5c2c\u60c5\u51b5\u3002\u201d\n\n[\u8be6\u89c1](https://www.luogu.com.cn/blog/user37070/solution-p4516)\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#pragma GCC optimize(\"O3\")\n#pragma GCC optimize(\"Ofast\",\"-funroll-loops\",\"-fdelete-null-pointer-checks\")\n#pragma GCC target(\"ssse3\",\"sse3\",\"sse2\",\"sse\",\"avx2\",\"avx\")\n/*\u7528 vector \u5c31\u4e0d\u9700\u8981\u4f18\u5316\u4e86*/\nusing std::min;\n\nconst int MAXN =1e5+50;\nconst int M =1e9+7;\n\n/*------------------------------Map------------------------------*/\n\nint first[MAXN], tote;\nstruct edge{\n\tint net, to;\n}e[MAXN<<1];\n\ninline void addedge(int u, int v){\n\t++tote;\n\te[tote].to =v, e[tote].net =first[u];\n\tfirst[u] =tote;\n\t++tote;\n\te[tote].to =u, e[tote].net =first[v];\n\tfirst[v] =tote;\n}\n\n/*------------------------------Dfs------------------------------*/\n\nint n, k;\nint dp[MAXN][110][2][2]/*\u5df2\u7ecf\u653e\u51e0\u4e2a\uff0c\u8be5\u70b9\u653e\u4e86\u6ca1\uff0c\u8be5\u70b9\u662f\u5426\u88ab\u76d1\u6d4b*/, dppre[110][2][2];\nint siz[MAXN];\n\ninline int plus(int a, int b){ return (a+b >= M) ? a-M+b : a+b; }\n\nvoid dfs(int u, int fa){\n\tsiz[u] =1;\n\tdp[u][0][0][0] =1;\n\tif(k > 0)\n\t\tdp[u][1][1][0] =1;\n\tfor(int l =first[u]; l; l =e[l].net)\n\t\tif(e[l].to != fa){\n\t\t\tdfs(e[l].to, u);\n\t\t\tfor(int i =0; i <= min(siz[u], k); ++i){\n\t\t\t\tdppre[i][0][0] =dp[u][i][0][0], dp[u][i][0][0] =0;\n\t\t\t\tdppre[i][0][1] =dp[u][i][0][1], dp[u][i][0][1] =0;\n\t\t\t\tdppre[i][1][0] =dp[u][i][1][0], dp[u][i][1][0] =0;\n\t\t\t\tdppre[i][1][1] =dp[u][i][1][1], dp[u][i][1][1] =0;\n\t\t\t}\n\t\t\tfor(int i =0; i <= min(siz[u], k); ++i)\n\t\t\t\tfor(int j =0; j <= min(siz[e[l].to], k) && i+j <= k; ++j){\n\t\t\t\t\tdp[u][i+j][0][0] =plus(dp[u][i+j][0][0], 1ll*dppre[i][0][0]*dp[e[l].to][j][0][1]%M);\n\t\t\t\t\tdp[u][i+j][0][1] =plus(dp[u][i+j][0][1], 1ll*dppre[i][0][0]*dp[e[l].to][j][1][1]%M);\n\t\t\t\t\tdp[u][i+j][0][1] =plus(dp[u][i+j][0][1], 1ll*dppre[i][0][1]*dp[e[l].to][j][0][1]%M);\n\t\t\t\t\tdp[u][i+j][0][1] =plus(dp[u][i+j][0][1], 1ll*dppre[i][0][1]*dp[e[l].to][j][1][1]%M);\n\t\t\t\t\tdp[u][i+j][1][0] =plus(dp[u][i+j][1][0], 1ll*dppre[i][1][0]*dp[e[l].to][j][0][0]%M);\n\t\t\t\t\tdp[u][i+j][1][0] =plus(dp[u][i+j][1][0], 1ll*dppre[i][1][0]*dp[e[l].to][j][0][1]%M);\n\t\t\t\t\tdp[u][i+j][1][1] =plus(dp[u][i+j][1][1], 1ll*dppre[i][1][0]*dp[e[l].to][j][1][0]%M);\n\t\t\t\t\tdp[u][i+j][1][1] =plus(dp[u][i+j][1][1], 1ll*dppre[i][1][0]*dp[e[l].to][j][1][1]%M);\n\t\t\t\t\tdp[u][i+j][1][1] =plus(dp[u][i+j][1][1], 1ll*dppre[i][1][1]*dp[e[l].to][j][0][0]%M);\n\t\t\t\t\tdp[u][i+j][1][1] =plus(dp[u][i+j][1][1], 1ll*dppre[i][1][1]*dp[e[l].to][j][0][1]%M);\n\t\t\t\t\tdp[u][i+j][1][1] =plus(dp[u][i+j][1][1], 1ll*dppre[i][1][1]*dp[e[l].to][j][1][0]%M);\n\t\t\t\t\tdp[u][i+j][1][1] =plus(dp[u][i+j][1][1], 1ll*dppre[i][1][1]*dp[e[l].to][j][1][1]%M);\n\t\t\t\t}\n\t\t\tsiz[u] +=siz[e[l].to];/*\u6ce8\u610f\u8fd9\u884c\u4ee3\u7801 ( \u5728\u672c\u7a0b\u5e8f\u4e2d ) \u5fc5\u987b\u653e\u5728\u8f6c\u79fb\u540e\u9762\uff0c\u4e0d\u7136\u590d\u6742\u5ea6\u5c31\u9519\u4e86*/\n\t\t}\n}\n\n/*------------------------------Main------------------------------*/\n\ninline int read(){\n\tint x =0; char c =getchar();\n\twhile(c < '0' || c > '9') c =getchar();\n\twhile(c >= '0' && c <= '9') x = (x<<3) + (x<<1) + (48^c), c =getchar();\n\treturn x;\n}\n\nint main(){\n\tn =read(), k =read();\n\tfor(int i =0; i < n-1; ++i){\n\t\tint u =read(), v =read();\n\t\taddedge(u, v);\n\t}\n\tdfs(1, 0);\n\tprintf(\"%d\", plus(dp[1][k][0][1], dp[1][k][1][1]));\n}\n```",
        "postTime": 1598856955,
        "uid": 105254,
        "name": "Piwry",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011"
    },
    {
        "content": "## \u9898\u610f\n\n\u7565\u3002\n\n## \u9898\u89e3\n\n\u6211\u4eec\u5957\u8def\u5730\u8bbe $f_{i,j,0/1,0/1}$ \u8868\u793a $i$ \u7684\u5b50\u6811\u4e2d\u653e\u7f6e\u4e86 $j$ \u4e2a\u88c5\u7f6e\uff0c\u5176\u4e2d $i$ \u6709\u65e0\u653e\u7f6e\uff0c$i$ \u6709\u65e0\u88ab\u8986\u76d6 \u7684\u65b9\u6848\u6570\uff0c\u505a\u6811\u4e0a\u80cc\u5305\u3002\n\n\u90a3\u4e48\uff0c\u4ee4 $y$ \u4e3a\u5f53\u524d\u70b9\uff0c$s$ \u4e3a\u5176\u513f\u5b50\uff0c$h$ \u4e3a\u8f6c\u79fb\u51fa\u7684\u70b9\uff0c\u6211\u4eec\u5217\u51fa $16$ \u79cd\u8f6c\u79fb\u65b9\u7a0b\uff08\u6682\u4e14\u5ffd\u7565 $j$\uff09\uff1a\n\n```txt\ny,0,0 + s,0,0 -> x\ny,0,0 + s,0,1 -> h,0,0\ny,0,0 + s,1,0 -> x\ny,0,0 + s,1,1 -> h,0,1\n\ny,0,1 + s,0,0 -> x\ny,0,1 + s,0,1 -> h,0,1\ny,0,1 + s,1,0 -> x\ny,0,1 + s,1,1 -> h,0,1\n\ny,1,0 + s,0,0 -> h,1,0\ny,1,0 + s,0,1 -> h,1,0\ny,1,0 + s,1,0 -> h,1,1\ny,1,0 + s,1,1 -> h,1,1\n\ny,1,1 + s,0,0 -> h,1,1\ny,1,1 + s,0,1 -> h,1,1\ny,1,1 + s,1,0 -> h,1,1\ny,1,1 + s,1,1 -> h,1,1\n```\n\n\u7565\u52a0\u601d\u8003\uff0c\u6211\u4eec\u603b\u7ed3\u51fa\u8fd9\u4e9b\u8f6c\u79fb\u5f0f\u7684\u89c4\u5f8b\uff1a\n\n$y,a,b ~+~ s,c,d \\rightarrow h,a,b~or~c$\uff0c\u8981\u6c42 $a ~or~ d=1$\u3002\n\n\u90a3\u4e48\u505a\u80cc\u5305\u5373\u53ef\u3002\u6ce8\u610f\u8fd9\u6837\u5199\u5e38\u6570\u62c9\u6ee1\uff0c\u8981\u5f00\u4e00\u4e0b $O2$\u3002\n\n\u70b9\u4e2a\u8d5e\u5427\u3002\n\n\u53c2\u8003\u4ee3\u7801\uff1a\n\n```cpp\n//\u4f1f\u5927\u7684\u5bfc\u5e08\uff0c\u4f1f\u5927\u7684\u9886\u8896\uff0c\u4f1f\u5927\u7684\u7edf\u5e05\uff0c\u4f1f\u5927\u7684\u8235\u624b\n#include<bits/stdc++.h>\nusing namespace std;\nint read() {\n\tint s=0,w=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9') {if(ch=='-') w=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9') s=(s<<3)+(s<<1)+(ch^48),ch=getchar();\n\treturn s*w;\n}\nconst int maxn = 1e5+10, mod = 1e9+7;\nint f[maxn][110][2][2],t[110][2][2],sz[maxn],n,K;vector<int>G[maxn];\nvoid Add(int&x,int y) {(x+=y)>=mod?x-=mod:x;}\nvoid dfs(int x,int pa) {\n\tsz[x]=1;f[x][0][0][0]=f[x][1][1][0]=1;\n\tfor(auto y:G[x]) if(y^pa) {\n\t\tdfs(y,x);\n\t\tfor(int i=0;i<=min(K,sz[x]);i++)\n\t\t\tfor(int j=0;j<=min(K-i,sz[y]);j++)\n\t\t\t\tfor(int a=0;a<2;a++)\n\t\t\t\t\tfor(int b=0;b<2;b++)\n\t\t\t\t\t\tfor(int c=0;c<2;c++)\n\t\t\t\t\t\t\tfor(int d=0;d<2;d++) if((a|d)==1) Add(t[i+j][a][b|c],1ll*f[x][i][a][b]*f[y][j][c][d]%mod);\n\t\tfor(int i=0;i<=min(K,sz[x]+sz[y]);i++)\n\t\t\tfor(int a=0;a<2;a++)\n\t\t\t\tfor(int b=0;b<2;b++) f[x][i][a][b]=t[i][a][b],t[i][a][b]=0;\n\t\tsz[x]+=sz[y];\n\t}\n}\nvoid add(int x,int y) {G[x].push_back(y),G[y].push_back(x);}\nsigned main() {\n\tn=read(),K=read();\n\tfor(int i=1;i<n;i++) add(read(),read());\n\tdfs(1,0),cout<<(f[1][K][0][1]+f[1][K][1][1])%mod;\n\treturn 0;\n}\n```",
        "postTime": 1623840341,
        "uid": 106182,
        "name": "KaisuoShutong",
        "ccfLevel": 0,
        "title": "P4516 [JSOI2018]\u6f5c\u5165\u884c\u52a8 \u9898\u89e3"
    },
    {
        "content": "~~\u6811\u5f62DP~~\n\n~~\u6811\u4e0a\u80cc\u5305~~\n\n\u9996\u5148\uff0c\u786e\u5b9a\u4e00\u4e0b\u72b6\u6001\uff1a$dp[i][k][0/1][0/1]$ \u4ee3\u8868\u662f\u4ee5\u7b2c $i$ \u4e2a\u8282\u70b9\u4e3a\u6811\u6839\uff0c\u5176\u4e2d\u653e\u4e86 $k$ \u4e2a\u7279\u5de5\uff0c\u8be5\u8282\u70b9\u88ab\u7236\u4eb2 / \u513f\u5b50\u89c2\u5bdf\uff0c\u8be5\u8282\u70b9\u653e / \u4e0d\u653e\u7279\u5de5\u3002\\\n\u5176\u4e2d\uff0c\u4e3a\u786e\u4fdd\u72b6\u6001\u4e0d\u91cd\uff0c\u72b6\u6001 $(i,k,0,0/1)$ \u7684\u6240\u6709\u513f\u5b50\u5747\u4e0d\u53ef\u653e\u7279\u5de5\u3002\\\n\u786e\u5b9a\u72b6\u6001\u4e4b\u540e\uff0c\u6211\u4eec\u6765\u770b\u8f6c\u79fb\u3002\n\n\n------------\n\n## \u3010\u8f6c\u79fb\u3011\n#### \u5148\u8bf4 $dp[i][k][0][0]$\u3002\n\u5bf9\u4e8e\u513f\u5b50 $v$,\u5e94\u8be5\u6709\u524d\u9762\u653e $k-j$ \u4e2a\u6210\u7acb\u7684\u65b9\u6848\u6570 $\\times $ $v$ \u8282\u70b9\u653e $j$ \u4e2a\u3001\u88ab\u513f\u5b50\u770b\u3001\u81ea\u8eab\u4e0d\u653e\u7684\u65b9\u6848\u6570\uff0c\u5373 $dp[i][k][0][0]=\\sum dp[i][k-j][0][0]\\ \\times \\ dp[v][j][1][0]$\u3002\n\n#### \u4e8c\u8bf4 $dp[i][k][0][1]$\u3002\n\u5bf9\u4e8e\u513f\u5b50 $v$,\u5e94\u8be5\u6709\u524d\u9762\u653e $k-j$ \u4e2a\u6210\u7acb\u7684\u65b9\u6848\u6570 $\\times $ $v$ \u8282\u70b9\u653e $j$ \u4e2a\u3001\u88ab\u7236\u4eb2 / \u513f\u5b50\u770b\u3001\u81ea\u8eab\u4e0d\u653e\u7684\u65b9\u6848\u6570\uff0c\u5373 $dp[i][k][0][1]=\\sum dp[i][k-j][0][1] \\times (dp[v][j][1][0]+dp[v][j][0][0])$\u3002\n\n#### \u4e09\u8bf4 $dp[i][k][1][0]$\u3002\n\u5bf9\u4e8e\u513f\u5b50 $v$,\u5e94\u8be5\u6709\uff1a\\\n1.\u524d\u9762\u653e $k-j$ \u4e2a\u6210\u7acb\u7684\u65b9\u6848\u6570 $\\times $ $v$ \u8282\u70b9\u653e $j$ \u4e2a\u3001\u88ab\u513f\u5b50\u770b\u3001\u81ea\u8eab\u653e / \u4e0d\u653e\u7684\u65b9\u6848\u6570\uff1b\\\n2.\u524d\u9762\u653e $k-j$ \u4e2a\uff0c\u4f46 $i$ \u53f7\u8282\u70b9\u4ecd\u672a\u88ab\u89c2\u5bdf\u7684\u65b9\u6848\u6570 $* $ $v$ \u8282\u70b9\u653e $j$ \u4e2a\u3001\u88ab\u513f\u5b50\u770b\u3001\u81ea\u8eab\u653e\u7684\u65b9\u6848\u6570\uff1b\\\n\u5373\uff1a$dp[i][k][1][0]=\\sum (dp[i][k-j][1][0] \\times (dp[v][j][1][0]+dp[v][j][1][1]) + dp[i][k-j][0][0] \\times dp[v][j][1][1])$\n\n#### \u6700\u540e\u8bf4 $dp[i][k][1][1]$\u3002\n\u5bf9\u4e8e\u513f\u5b50 $v$,\u5e94\u8be5\u6709\uff1a\\\n1.\u524d\u9762\u653e $k-j$ \u4e2a\u6210\u7acb\u7684\u65b9\u6848\u6570 $\\times $ $v$ \u8282\u70b9\u653e $j$ \u4e2a\u3001\u88ab\u7236\u4eb2 / \u513f\u5b50\u770b\u3001\u81ea\u8eab\u653e / \u4e0d\u653e\u7684\u65b9\u6848\u6570\uff1b\\\n2.\u524d\u9762\u653e $k-j$ \u4e2a\uff0c\u4f46 $i$ \u53f7\u8282\u70b9\u4ecd\u672a\u88ab\u89c2\u5bdf\u7684\u65b9\u6848\u6570 $* $ $v$ \u8282\u70b9\u653e $j$ \u4e2a\u3001\u88ab\u7236\u4eb2 / \u513f\u5b50\u770b\u3001\u81ea\u8eab\u653e\u7684\u65b9\u6848\u6570\uff1b\\\n\u5373\uff1a$dp[i][k][1][1]=\\sum (dp[i][k-j][1][1] \\times (dp[v][j][1][0]+dp[v][j][1][1]+dp[v][j][0][0]+dp[v][j][0][1]) + dp[i][k-j][0][1]* (dp[v][j][1][1]+dp[v][j][0][1])$\n\n\u6700\u6700\u540e\uff0c\u6ce8\u610f $k$ \u5012\u7740\u679a\u4e3e,$j$ \u4ece $0$ \u5f00\u59cb\u679a\u4e3e\uff0c\u7b54\u6848\u662f $dp[root][k][1][0]+dp[root][k][1][1]$ \uff08 $root$ \u4e3a\u5c06\u65e0\u6839\u6811\u8f6c\u6210\u6709\u6839\u6811\u65f6\u7684\u6811\u6839\uff09\uff0c\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\n------------\n\n\n\u8d34\u51fa\u4ee3\u7801\uff1a\uff08\u56e0\u5e38\u6570\u8fc7\u5927\u5bfc\u81f4TLE\uff0cO2\u8fc7\u4e86\uff09\n\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint w;//\u9898\u76ee\u4e2d\u7684k\nconst int mod = 1e9 + 7;\nvector<int>e[100001];//\u5efa\u6811\nint size[100001];//\u5b50\u6811\u5927\u5c0f\nunsigned int dp[100001][101][2][2];//long long \u4f1aMLE\n\nvoid dfs1(int i, int fa) {\n\tsize[i] = 1;\n\tfor (int j = 0; j < e[i].size(); j++)\n\t\tif (e[i][j] != fa) {\n\t\t\tdfs1(e[i][j], i);\n\t\t\tsize[i] += size[e[i][j]];\n\t\t}\n}\n\nvoid dfs2(int i, int fa) {\n\tfor (int j = 0; j < e[i].size(); j++)\n\t\tif (e[i][j] != fa)\n\t\t\tdfs2(e[i][j], i);\n\tdp[i][0][0][0] = dp[i][1][0][1] = 1;\n\tint qwq = 1;\n\tfor (int j = 1; j <= e[i].size(); j++)//\u8f6c\u79fb\n\t\tif (e[i][j - 1] != fa) {\n\t\t\tqwq += size[e[i][j - 1]];\n\t\t\tfor (int k = min(w, qwq); k >= 0; k--) {\n\t\t\t\tunsigned long long int ans1 = 0, ans2 = 0, ans3 = 0, ans4 = 0;\n\t\t\t\tfor (int x = 0; x <= min(k, size[e[i][j - 1]]); x++) {\n\t\t\t\t\tint v = e[i][j - 1];\n\t\t\t\t\tif (k - x > qwq - size[v])\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t(ans1 += ((unsigned long long )dp[i][k - x][0][0] *\n\t\t\t\t\t          (dp[v][x][1][0]))) %= mod;\n\n\t\t\t\t\t(ans2 += ((unsigned long long )dp[i][k - x][0][1] *\n\t\t\t\t\t          (dp[v][x][1][0]\n\t\t\t\t\t           + dp[v][x][0][0]))) %= mod;\n\n\t\t\t\t\t(ans3 += ((unsigned long long )dp[i][k - x][1][0] * (dp[v][x][1][0] + dp[v][x][1][1])\n\t\t\t\t\t          + (unsigned long long )dp[i][k - x][0][0] * dp[v][x][1][1])) %= mod;\n\n\t\t\t\t\t(ans4 += ((unsigned long long )dp[i][k - x][1][1] * (dp[v][x][1][0] + dp[v][x][0][0]\n\t\t\t\t\t                                + dp[v][x][1][1] + dp[v][x][0][1])\n\t\t\t\t\t          + (unsigned long long )dp[i][k - x][0][1] * (dp[v][x][1][1] + dp[v][x][0][1]))) %= mod;\n\t\t\t\t}\n\t\t\t\tdp[i][k][0][0] = ans1;\n\t\t\t\tdp[i][k][0][1] = ans2;\n\t\t\t\tdp[i][k][1][0] = ans3;\n\t\t\t\tdp[i][k][1][1] = ans4;\n\t\t\t}\n\n\t\t}\n}\n\nint main() {\n\tint n;\n\tcin >> n >> w;\n\tfor (int i = 1; i < n; i++) {\n\t\tint a, b;\n\t\tscanf(\"%d%d\", &a, &b);\n\t\te[a].push_back(b);\n\t\te[b].push_back(a);\n\t}\n\tdfs1(1, 0);\n\tdfs2(1, 0);\n\tcout << (dp[1][w][1][0] + dp[1][w][1][1]) % mod;\n\treturn 0;\n}\n```\n",
        "postTime": 1622282150,
        "uid": 400195,
        "name": "momoli",
        "ccfLevel": 7,
        "title": "P4516 \u9898\u89e3"
    },
    {
        "content": "## \u9898\u76ee\u63cf\u8ff0\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4516)\n## \u601d\u8def\u7b80\u8ff0\n\n~~\u9898\u89e3\u533a\u611f\u89c9\u597d\u50cf\u6ca1\u6709\u6211\u8fd9\u4e48\u590d\u6742\u800c\u5783\u573e\u7684\u505a\u6cd5\u3002~~\n\n\u663e\u7136\u662f\u6811\u5f62 dp\u3002\n\n\u4e0d\u59a8\u8bbe $f[i][j][z][0-3]$ \u5206\u522b\u8868\u793a\u7ed3\u70b9 $i$ \u8bbf\u95ee\u5230\u7b2c $j$ \u4e2a\u5b69\u5b50\uff0c\u653e\u7f6e\u4e86 $z$ \u4e2a\u76d1\u542c\u8bbe\u5907\uff0c\u72b6\u6001\u4e3a $0$ \u5230 $3$ \u7684\u65b9\u6848\u6570\u3002\n\n\u8fd9\u91cc\u6211\u4eec\u89c4\u5b9a\uff1a\n+ $0$ \u8868\u793a\u6ca1\u88ab\u4e0a\u9762\u7684\u70b9\u76d1\u89c6\u4e14\u4e0d\u653e\u7f6e\u76d1\u542c\u8bbe\u5907\u3002\n+ $1$ \u8868\u793a\u6ca1\u88ab\u4e0a\u9762\u7684\u70b9\u76d1\u89c6\u4e14\u653e\u7f6e\u76d1\u542c\u8bbe\u5907\u3002\n+ $2$ \u8868\u793a\u88ab\u4e0a\u9762\u7684\u70b9\u76d1\u89c6\u4e14\u4e0d\u653e\u7f6e\u76d1\u542c\u8bbe\u5907\u3002\n+ $3$ \u8868\u793a\u88ab\u4e0a\u9762\u7684\u70b9\u76d1\u89c6\u4e14\u653e\u7f6e\u76d1\u542c\u8bbe\u5907\u3002\n+ \u5f53\u7136\u53ef\u4ee5\u7b80\u5355\u7406\u89e3\u4e3a**\u5f53\u524d\u72b6\u6001\u53ef\u4ee5\u4f7f\u7528 $2\\times [\\texttt{\u4e0a\u9762\u7684\u70b9\u662f\u5426\u653e\u4e86\u76d1\u542c\u8bbe\u5907}]+[\\texttt{\u5f53\u524d\u70b9\u662f\u5426\u653e\u4e86\u76d1\u542c\u8bbe\u5907}]$ \u8868\u793a\u3002**\uff08\u8fd9\u91cc\u53ef\u80fd\u6587\u5b57\u8868\u8ff0\u66f4\u4e3a\u6e05\u695a\uff09\n\n### \u60c5\u51b51\n\n\u5982\u679c\u4e00\u4e2a\u70b9\u6ca1\u88ab\u4e0a\u9762\u7684\u70b9\u76d1\u89c6\uff0c\u4e14\u5f53\u524d\u8fd9\u4e2a\u70b9\u6ca1\u6709/\u6709\u653e\u7f6e\u76d1\u542c\u8bbe\u5907\n\n\u90a3\u4e48\u53ef\u4ee5\u8fd9\u4e48\u601d\u8003\uff0c\u4e00\u4e2a\u70b9\u53ef\u4ee5\u653e\u7f6e\u6216\u4e0d\u653e\u7f6e\u76d1\u542c\u8bbe\u5907\uff0c\u4f46\u4ed6\u4e00\u5b9a\u5f97\u6709\u4e00\u4e2a\u513f\u5b50\u653e\u7f6e\u76d1\u542c\u8bbe\u5907\u3002\n\n\u5bf9\u4e8e\u5b83\u7684\u4e00\u4e2a\u5b69\u5b50 $v$ \uff0c \u5c31\u6709 $2$ \u79cd\u53ef\u80fd\uff1a\n\n1. \u4e4b\u524d\u7684\u6240\u6709\u5b69\u5b50\u90fd\u6ca1\u6709\u653e\u7f6e\u76d1\u89c6\u70b9\uff0c\u90a3\u4e48\u5b83\u53ef\u4ee5\u9009\u62e9\u653e\u7f6e\u76d1\u542c\u8bbe\u5907\u3002\n1. \u4e4b\u524d\u7684\u5b69\u5b50\u4e2d\u6709\u653e\u7f6e\u76d1\u89c6\u70b9\uff0c\u90a3\u4e48\u5b83\u653e\u7f6e\u6216\u4e0d\u653e\u7f6e\u76d1\u542c\u8bbe\u5907\u90fd\u53ef\u3002\n\n\u5bb9\u6613\u60f3\u5230\u8fd8\u9700\u8981\u7ef4\u62a4\u4e00\u4e2a $g[i][0-1][j]$ \u8868\u793a\u8bbf\u95ee\u5230\u7b2c $i$ \u4e2a\u5b69\u5b50\uff0c\u6b64\u65f6\u7236\u7ed3\u70b9\u4e0d\u653e\u7f6e/\u653e\u7f6e\u76d1\u542c\u8bbe\u5907\uff0c\u4e14\u4e00\u5171\u653e\u7f6e\u4e86 $j$ \u4e2a\u76d1\u542c\u8bbe\u5907\uff0c\u540c\u65f6\u5b69\u5b50\u90fd\u6ca1\u6709\u653e\u7f6e\u76d1\u542c\u8bbe\u5907\u7684\u65b9\u6848\u6570\u3002\n\n### \u60c5\u51b52\n\n\u5982\u679c\u4e00\u4e2a\u70b9\u88ab\u4e0a\u9762\u7684\u70b9\u76d1\u89c6\uff0c\u4e14\u5f53\u524d\u8fd9\u4e2a\u70b9\u6ca1\u6709/\u6709\u653e\u7f6e\u76d1\u542c\u8bbe\u5907\u3002\n\n\u76f4\u63a5\u66f4\u65b0\u5373\u53ef\u3002\n\n---\n\n\u7efc\u4e0a\uff0c\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u6613\u5f97\uff1a\n+ $t \\in [0,1]$\uff0c$v$ \u8868\u793a $i$ \u7684\u7b2c $j$ \u4e2a\u5b69\u5b50\n+ $sz[i][j]$ \u8868\u793a\u8282\u70b9 $i$ \u904d\u5386\u5230\u7b2c $j$ \u4e2a\u513f\u5b50\u6240\u7edf\u8ba1\u7684\u5b50\u6811\u5927\u5c0f\u3002\n+ $cnt[i]$ \u8868\u793a\u8282\u70b9 $i$ \u7684\u513f\u5b50\u4e2a\u6570\u3002\n+ \u94a6\u5b9a\u5f53\u524d\u5b50\u6811\u6839\u8282\u70b9\u662f $u$\u3002\n+ $f[u][j][z][t]=\\sum_{l=\\max(0,z-sz[u][j]+sz[v][cnt[v]])}^{\\min(z-t,sz[v][cnt[v]])} f[u][j-1][z-l][t+2]\n\\times (f[v][cnt[v]][j][1|(t\\times 2)]\n+f[v][cnt[v]][l][t\\times 2]) $ \u3002\n+ $f[u][j][z][t]=\\sum_{l=\\min(i-t,sz[v][cnt[v])}^{\\max(0,i-sz[u][j]+sz[v][cnt[v]])}\nf[u][j-1][z-l][t]\n\\times (f[v][cnt[v]][l][1+t\\times 2]+f[v][cnt[v]][l][t\\times 2])+g[t][i-j] \\times f[v][cnt[v]][j][1+t\\times 2]$\u3002\n+ $g[i][t][j]=\\sum_{l=\\min(i-t,sz[v][cnt[v]])}^{\\max(0,j-sz[u][i]+sz[v][cnt[v]])}g[i-1][t][j-l]\\times f[v][cnt[v]][l][t\\times 2]$\u3002\n\n\u521d\u59cb\u5316\uff1a\n\n$f[u][0][1][3]=f[u][0][0][2]=1$\uff0c$g[0][1][1]=g[0][1][1]=1$\uff0c\u5176\u4f59\u7686\u4e3a $0$ \u3002\n\n\u60f3\u5fc5\u4e0a\u9762\u7684\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u6709\u70b9\u6076\u5fc3\uff0c\u7136\u800c\u679a\u4e3e\u662f\u7b2c\u51e0\u4e2a\u513f\u5b50\u7684\u8fd9\u4e00\u7ef4\u662f\u53ef\u4ee5\u7528\u6eda\u52a8\u6570\u7ec4\u4f18\u5316\u6389\u7684\u3002\n\n## \u4e11\u964b\u306e\u4ee3\u7801\n[click here](https://www.luogu.com.cn/paste/n0iu2bqe)",
        "postTime": 1653812059,
        "uid": 312306,
        "name": "LJ07",
        "ccfLevel": 0,
        "title": "[Solution]P4516 [JSOI2018] \u6f5c\u5165\u884c\u52a8"
    },
    {
        "content": "\u6211\u770b\u89c1\u6709\u5e05\u54e5\u8bf4\u8fd9\u9053\u9898\u662f\u7b80\u5355\u7684\u6811\u5f62dp\n\u3002\u3002\u3002\u6709\u70b9\u6c89\u9ed8\n\n\u8bbe $f[i][j][0/1][0/1] $\u8868\u793ai\u7684\u5b50\u6811\u4e2d\u5df2\u5b89\u88c5j\u4e2a\u88c5\u7f6e\uff0c i\u662f/\u5426\u5b89\u88c5\uff0c\u662f/\u5426\u88ab\u63a7\u5236\u7684\u65b9\u6848\u6570\uff0c\n\u65b9\u7a0b\u8fc7\u957f\u61d2\u5f97\u89e3\u91ca\uff0c\u8fd9\u9053\u9898\u96be\u5c31\u96be\u5728\u8981\u6253\u7684\u4e1c\u897f\u592a\u591a\u5f88\u5bb9\u6613\u51fa\u9519\n\n\u7136\u540e\u8981\u6ce8\u610f\uff0c\u5f88\u5bb9\u6613\u7206\u7a7a\u95f4\u548c\u65f6\u95f4\uff0c\u6570\u7ec4\u5f00int\uff0c\u867d\u7136dp\u8fc7\u7a0b\u4e2d\u4f1a\u7206int\uff0c\u4f46\u662f\u6570\u7ec4\u8981\u5f00int\u4e0d\u7136\u4f1a\u7206\uff0c\u7136\u540e\u5728dp\u7684\u65f6\u5019\u5f3a\u5236\u8f6clong long\u3002\n\u8fd9\u4e2a\u5730\u65b9\u6211\u8c03\u8bd5\u4e86\u597d\u4e45\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n//#define int long long\ntypedef long long ll;\nconst int mod=1e9+7;\nint N,K,f[100010][105][2][2],size[100010],front[100010];long long g[105][2][2];\nstruct tEdge{\n    int v,next;\n    tEdge(int v=0,int next=0) : v(v) , next(next) {}\n}e[200020];\nvoid add(int u,int v)\n{\n    static int tcnt=0;\n    e[++tcnt]=tEdge(v,front[u]);front[u]=tcnt;\n}\nint mo(int &a,ll b){\n    return (a+((int)(b%mod)))%mod;\n}\nvoid dfs(int u,int fa){\n    size[u]=1;\n    f[u][0][0][0]=f[u][1][1][0]=1;\n    for(int i=front[u];i;i=e[i].next){\n        int v=e[i].v;\n        if(v==fa)continue;\n        dfs(v,u);\n        for(int i=0;i<=min(size[u],K);++i){\n          g[i][0][0]=f[u][i][0][0],f[u][i][0][0]=0;\n          g[i][0][1]=f[u][i][0][1],f[u][i][0][1]=0;\n          g[i][1][0]=f[u][i][1][0],f[u][i][1][0]=0;\n          g[i][1][1]=f[u][i][1][1],f[u][i][1][1]=0;\n        }\n        for(int i=0;i<=min(size[u],K);++i)\n            for(int j=0;j<=min(size[v],K-i);++j){\n                f[u][i+j][0][0]=mo(f[u][i+j][0][0],(ll)g[i][0][0]*(ll)f[v][j][0][1]);\n                f[u][i+j][1][0]=mo(f[u][i+j][1][0],(ll)g[i][1][0]*(ll)(f[v][j][0][0]+f[v][j][0][1]));\n                f[u][i+j][0][1]=mo(f[u][i+j][0][1],(ll)g[i][0][0]*(ll)f[v][j][1][1]+(ll)g[i][0][1]*(ll)(f[v][j][0][1]+f[v][j][1][1]));\n                f[u][i+j][1][1]=mo(f[u][i+j][1][1],(ll)g[i][1][0]*(ll)(f[v][j][1][1]+f[v][j][1][0])+(ll)g[i][1][1]*(ll)((ll)(f[v][j][0][0]+f[v][j][0][1])+(ll)(f[v][j][1][1]+f[v][j][1][0])));\n\n            }\n        size[u]+=size[v];\n    }\n}\nmain(){\n    scanf(\"%d%d\",&N,&K);\n    for(int i=1;i<N;i++){\n        int u,v;\n        scanf(\"%d%d\",&u,&v);\n        add(u,v);add(v,u);\n    }\n    dfs(1,0);\n    printf(\"%d\\n\",(f[1][K][1][1]+f[1][K][0][1])%mod);\n    return 0;\n}\n```",
        "postTime": 1534158378,
        "uid": 6160,
        "name": "\u9648\u5b66\u5a01",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011"
    },
    {
        "content": "## $\\texttt{Content}$\n\n\u7ed9\u4e00\u68f5 $n$ \u4e2a\u70b9\u7684\u6811\uff0c\u8bd5\u9009\u53d6 $k$ \u4e2a\u70b9\uff0c\u4f7f\u5f97\u6811\u4e2d\u7684\u6bcf\u4e00\u4e2a\u70b9\u90fd\u81f3\u5c11\u4e0e\u8be5 $k$ \u4e2a\u70b9\u4e2d\u7684\u4e00\u4e2a\u70b9\u76f4\u63a5\u76f8\u8fde\u3002( $k$ \u4e2a\u70b9\u4e2d\u7684\u70b9\u4e0d\u4e0e\u81ea\u8eab\u76f8\u8fde \uff09\n\n$n \\le 10^5,k\\le 100$\n\n## $\\texttt{Solution}$\n\n\u53ef\u4ee5\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u6811\u5f62 dp\u3002\n\n**\u8bbe\u8ba1\u72b6\u6001**\uff1a\n\n\u6211\u4e00\u5f00\u59cb\u60f3\u7684\u662f\u8bbe $f_{0/1,u,i}$ \u8868\u793a\u4ee5 $u$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u6709 $i$ \u4e2a\u88ab\u9009\u53d6\u7684\u70b9\uff0c$0/1$ \u8868\u793a $u$ \u662f\u5426\u9009\u53d6\u3002\n\n\u4f46\u662f\u540e\u6765\u53d1\u73b0\u8fd9\u6837\u8bbe\u8ba1\u662f\u4e0d\u5bf9\u7684\u3002\u56e0\u4e3a\u8fd9\u6837\u5728\u8f6c\u79fb\u7684\u8fc7\u7a0b\u4e2d\u4f1a\u51fa\u73b0\u540e\u6548\u6027\u3002\n\n\u5373\u6211\u5728\u4ee5 $u$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u9009\u53d6\u7684\u70b9\u4f1a\u5bf9\u6211\u63a5\u4e0b\u6765\u7684\u9012\u63a8\u4ea7\u751f\u5f71\u54cd\u3002\n\n\u6240\u4ee5\u8bf4\u8003\u8651\u8fdb\u4e00\u6b65\u8bbe\u8ba1\u72b6\u6001\u3002\u4e00\u822c\u6765\u8bf4\uff0c\u5bf9\u4e8e\u6709\u540e\u6548\u6027\u7684\u4e00\u4e9b dp\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u589e\u52a0\u72b6\u6001\u7684\u65b9\u5f0f\u6765\u628a\u540e\u6548\u6027\u5e72\u6389\u3002\n\n\u4e8e\u662f\u8003\u8651\u589e\u8bbe\u4e00\u7ef4 $0/1$ \u8868\u793a\u70b9 $u$ \u662f\u5426\u88ab\u8986\u76d6\u5230\u3002\n\n\u4e8e\u662f\u72b6\u6001 $f_{0/1,0/1,u,i}$ \u8868\u793a\u4ee5 $u$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u6709 $i$ \u4e2a\u88ab\u9009\u53d6\u7684\u70b9\uff0c\u7b2c\u4e00\u4e2a$0/1$ \u8868\u793a $u$ \u662f\u5426\u9009\u53d6\uff0c\u7b2c\u4e8c\u4e2a $0/1$ \u8868\u793a $u$ \u662f\u5426\u88ab\u8986\u76d6\u3002\n\n**\u72b6\u6001\u8f6c\u79fb**\uff1a\n\n\u5728\u8bbe\u8ba1\u51fa\u72b6\u6001\u4ee5\u540e\uff0c\u8f6c\u79fb\u65b9\u7a0b\u5c31\u5f88\u597d\u63a8\u4e86\u3002\n\n\u53ea\u9700\u5206\u7c7b\u8ba8\u8bba\u5373\u53ef\u3002\n\n- \u5f53 $u$ \u6ca1\u6709\u88ab\u9009\u53d6\uff0c\u4e14\u6ca1\u6709\u88ab\u8986\u76d6\u3002\n\n\u5219\n\n$f_{0,0,u,i+j} =  \\sum \\limits_{i=0}^k(f_{0,0,u,i} \\times f_{0,1,v,j})$\n\n- \u5f53 $u$ \u6ca1\u6709\u88ab\u9009\u53d6\uff0c\u4f46\u88ab\u8986\u76d6\u4e86\u3002\n\n\u5219\n\n$f_{0,1,u,i+j} = \\sum \\limits_{i=0}^k(f_{0,1,u,i } \\times(f_{1,1,v,j} + f_{0,1,v,j}) + f_{0,0,u,i} \\times f_{1,1,v,j}) $\n\n- \u5f53 $u$ \u88ab\u9009\u53d6\uff0c\u4f46\u6ca1\u6709\u88ab\u8986\u76d6\u3002\n\n\u5219\n\n$f_{1,0,u,i+j} = \\sum\\limits_{i=0}^k(f_{1,0,u,i} \\times (f_{0,1,v,j} + f_{0,0,v,j}))$\n\n- \u5f53 $u$ \u88ab\u9009\u53d6\uff0c\u4e14\u88ab\u8986\u76d6\u3002\n\n\u5219\n\n$f_{1,1,u,i+j} =  \\sum\\limits_{i=0}^k(f_{1,1,u,i} \\times (f_{1,1,v,j} + f_{0,1,v,j} + f_{1,0,v,j} + f_{0,0,v,j}) + f_{1,0,u,i}\\times (f_{1,1,v,j} + f_{1,0,v,j}))$\n\n## $\\texttt{Code}$\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int N = 1e5+5, P = 1e9+7;\nint n, k;\nvector<int> g[N];\nint f[2][2][N][101], siz[N], cmp[101][2][2];\n\n//\u4f5c\u6811\u4e0a dp\nvoid dfs(int u, int fa) {\n\tsiz[u] = f[0][0][u][0] = f[1][0][u][1] = 1;\n\tfor(int i = 0;i < g[u].size();i ++) {\n\t\tint j = g[u][i];\n\t\tif(j == fa) continue;\n\t\tdfs(j, u);\n\t\tfor(int k1 = 0;k1 <= min(k, siz[u]);k1 ++) {\n        \t\t//\u9632\u6b62\u5728\u66f4\u65b0\u8fc7\u7a0b\u4e2d\u591a\u6b21\u66f4\u65b0(01\u80cc\u5305)\n\t\t\tcmp[k1][0][0] = f[0][0][u][k1];\n\t\t\tf[0][0][u][k1] = 0;\n           \t\tcmp[k1][0][1] = f[0][1][u][k1]; \n\t\t\tf[0][1][u][k1] = 0;\n            \t\tcmp[k1][1][0] = f[1][0][u][k1]; \n\t\t\tf[1][0][u][k1] = 0;\n            \t\tcmp[k1][1][1] = f[1][1][u][k1]; \n\t\t\tf[1][1][u][k1] = 0;\n\t\t}\n        \t//dp\u8fc7\u7a0b\n\t\tfor(int k1 = 0;k1 <= k && k1 <= siz[u];k1 ++) {\n\t\t\tfor(int k2 = 0;k2 + k1 <= k && k2 <= siz[j];k2 ++) {\n\t\t\t\tf[0][0][u][k1+k2] = (1ll * f[0][0][u][k1+k2] + 1ll * cmp[k1][0][0] * f[0][1][j][k2]) % P;\n\t\t\t\tf[1][0][u][k1+k2] = ((1ll * f[0][1][j][k2] + 1ll * f[0][0][j][k2]) % P * 1ll * cmp[k1][1][0] % P + 1ll * f[1][0][u][k1+k2]) % P;\n\t\t\t\tf[0][1][u][k1+k2] = (((1ll * f[1][1][j][k2] + f[0][1][j][k2]) % P * 1ll * cmp[k1][0][1]) % P  + 1ll * f[0][1][u][k1+k2] + 1ll * cmp[k1][0][0] * f[1][1][j][k2] % P) % P;\n\t\t\t\tf[1][1][u][k1+k2] = (1ll * f[1][1][u][k1+k2] + (1ll * f[1][1][j][k2] + f[0][1][j][k2] + f[1][0][j][k2] + f[0][0][j][k2]) % P * 1ll * cmp[k1][1][1] % P + cmp[k1][1][0] * (1ll * f[1][1][j][k2] + f[1][0][j][k2]) % P) % P;\n\t\t\t}\n\t\t}\n\t\tsiz[u] += siz[j];\n\t}\n}\n\nint main() {\n\tcin >> n >> k;\n\tfor(int i = 1, a, b;i < n;i ++) {\n\t\tcin >> a >> b;\n\t\tg[a].push_back(b), g[b].push_back(a);\n\t}\n\tdfs(1, 0);\n\t//\u8f93\u51fa\u65f6,\u6709\u4e24\u79cd\u53ef\u80fd\u7684\u65b9\u6848\n\tcout << (1ll * f[1][1][1][k] + f[0][1][1][k]) % P;\n\treturn 0;\n} \n```\n",
        "postTime": 1635605311,
        "uid": 195388,
        "name": "alvis",
        "ccfLevel": 5,
        "title": "P4516 [JSOI2018]\u6f5c\u5165\u884c\u52a8"
    },
    {
        "content": "\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5176\u5b83\u9898\u89e3\u5df2\u7ecf\u5199\u5f97\u5f88\u660e\u767d\u4e86\uff0c\u8fd9\u91cc\u5199\u4e00\u4e9b\u6742\u4e03\u6742\u516b\u7684\u4e1c\u897f\n\n## \u65f6\u95f4\u590d\u6742\u5ea6\u7684\u8bc1\u660e\n\u4ee4 $T_i$ \u4e3a\u5bf9 $\\text{subtree}(i)$ \u8fdb\u884c\u52a8\u6001\u89c4\u5212\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c$t_i$ \u4e3a\u5c06 $\\text{son}(i)$ \u7684\u72b6\u6001\u8f6c\u79fb\u81f3 $i$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u5219\n$$\n\\begin{aligned}\nt_i&=\\sum_{j\\in \\text{son}(i)}\\sum_{l=1}^{\\min(k,\\text{size}(i))}(\\min(l,\\text{size}(j))-\\max(1,l+\\text{size}(j)-\\text{size}(i))) \\\\\n&\\geq \\sum_{j\\in \\text{son}(i)}\\sum_{l=1}^{k}\\text{size}(j) \\\\\n&=O(k\\cdot \\text{size}(i))\n\\end{aligned}\n$$\n\u5bf9 $T_i$ \u91c7\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\n- \u82e5 $i \\in \\text{leaf}$\uff0c$T_i=1$\n- \u53cd\u4e4b\uff0c\u5047\u8bbe\u5bf9\u4e8e\u4efb\u610f $s \\in \\text{son}(i)$\uff0c\u5747\u6709 $T_s=O(k\\cdot \\text{size}(s))$\uff0c\u5219\n$$\n\\begin{aligned}\nT_i &= t_i+\\sum_{j \\in \\text{son}(i)}T_j \\\\\n&=O(k\\cdot\\text{size}(i))+\\sum_{j \\in \\text{son}(i)}O(k \\cdot \\text{size}(j)) \\\\\n&= O(k \\cdot \\text{size}(i))\n\\end{aligned}\n$$\n\u6545\u65f6\u95f4\u590d\u6742\u5ea6\u4e0a\u754c\u4e3a $O(nk)$\n\n## \u6eda\u52a8\u6570\u7ec4\u4f18\u5316\n\u8bb8\u591a\u4eba\u90fd\u662f\u7528 $a,b$ \u8f6c\u79fb\u5230 $a+b$\uff0c\u4f46\u8fd9\u6837\u9700\u8981\u4e00\u4e2a\u989d\u5916\u7684\u6570\u7ec4\uff0c\u7136\u800c\u5982\u679c\u6211\u4eec\u7528 $t-l,l$ \u8f6c\u79fb\u5230 $t$\uff0c\u5012\u5e8f\u679a\u4e3e $t$\uff0c\u5c31\u4e0d\u7528\u989d\u5916\u5f00\u6570\u7ec4\u4e86\n\n## $l$ \u7684\u8303\u56f4\n$\\max(1,t+\\text{size}(i)-\\text{size}(s))\\leq l \\leq \\min(t,\\text{size}(s))$\uff0c\u5176\u4e2d $s$ \u8868\u793a\u5f53\u524d\u679a\u4e3e\u7684\u5b69\u5b50\n\n## \u4ee3\u7801\n```cpp\n#include <cstdio>\n#include <vector>\nconst int MAXN = 100005, MAXK = 105, MOD = 1000000007;\nstd::vector<int> G[MAXN];\nint f[MAXN][MAXK][2][2], size[MAXN];\n// \u7b2c\u4e09\u7ef4\u8868\u793ai\u662f\u5426\u88c5\u76d1\u542c\u5668\uff0c\u7b2c\u56db\u7ef4\u8868\u793ai\u662f\u5426\u88ab\u76d1\u542c\nint n, k, a, b;\n\nvoid dp(int i, int father) {\n\tf[i][0][0][0] = 1;\n\tf[i][1][1][0] = 1;\n\tsize[i] = 1;\n\tfor(int j = 0; j < G[i].size(); ++j) {\n\t\tint s = G[i][j];\n\t\tif(s != father) {\n\t\t\tdp(s, i);\n\t\t\tsize[i] += size[s];\n\t\t\tfor(int t = std::min(k, size[i]); t > 0; --t) {\n\t\t\t\tint lim = std::min(t, size[s]);\n\t\t\t\tf[i][t][0][1] = 0;\n\t\t\t\tf[i][t][0][0] = 0;\n\t\t\t\tf[i][t][1][1] = f[i][t][1][1]*f[s][0][0][0];\n\t\t\t\tf[i][t][1][0] = f[i][t][1][0]*f[s][0][0][0];\n\t\t\t\tfor(int l = std::max(1, t + size[s] - size[i]); l <= lim; ++l) {\n\t\t\t\t\tf[i][t][0][0] = (1ULL*f[i][t - l][0][0]*f[s][l][0][1] + f[i][t][0][0])%MOD;\n\t\t\t\t\tf[i][t][0][1] = (1ULL*f[i][t - l][0][1]*(f[s][l][0][1] + f[s][l][1][1]) + 1ULL*f[i][t - l][0][0]*f[s][l][1][1] + f[i][t][0][1])%MOD;\t\t\t\n\t\t\t\t\tf[i][t][1][0] = (1ULL*f[i][t - l][1][0]*(f[s][l][0][0] + f[s][l][0][1]) + f[i][t][1][0])%MOD;\n\t\t\t\t\tf[i][t][1][1] = (1ULL*f[i][t - l][1][1]*(1ULL*f[s][l][0][0] + f[s][l][0][1] + f[s][l][1][0] + f[s][l][1][1]) + 1ULL*f[i][t - l][1][0]*(f[s][l][1][0] + f[s][l][1][1]) + f[i][t][1][1])%MOD;\n//\t\t\t\t\tprintf(\"f[%d][%d][0][0]:%d, f[%d][%d][0][1]:%d, f[%d][%d][1][0]:%d, f[%d][%d][1][1]:%d\\n\", i, t, f[i][t][0][0], i, t, f[i][t][0][1], i, t, f[i][t][1][0], i, t, f[i][t][1][1]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tf[i][0][0][0] = 0;\n\t\t}\n\t}\n}\n\nint main() {\n\tscanf(\"%d%d\", &n, &k);\n\tfor(int i = 1; i < n; ++i) {\n\t\tscanf(\"%d%d\", &a, &b);\n\t\tG[a].push_back(b), G[b].push_back(a);\n\t}\n\tdp(1, -1);\n\tint ans = (f[1][k][0][1] + f[1][k][1][1])%MOD;\n\tprintf(\"%d\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1616766666,
        "uid": 225734,
        "name": "derta",
        "ccfLevel": 6,
        "title": "P4516 [JSOI2018]\u6f5c\u5165\u884c\u52a8"
    },
    {
        "content": "UPD\uff1a\u5341\u5206\u62b1\u6b49\u521a\u8fc7\u5ba1\u5c31\u8ba9\u7ba1\u7406\u91cd\u65b0\u5ba1\u6838\uff0c\u53ea\u662f\u4fee\u4e86\u4e2a\u7b14\u8bef\uff0c\u8fd9\u4e0b\u518d\u6709\u9519\u6211\u5934\u63d2\u5730\u91cc\uff08\n\n\u5927\u6982\u662f\u6811\u5f62\u80cc\u5305\u7684\u677f\u9898\uff0c\u4f46\u662f\u8fd9\u9898\u7684\u5f0f\u5b50\u63a8\u8d77\u6765\u975e\u5e38\u957f\u2026\u2026\n\n[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4516)\n\n# $\\texttt{Description}$\n\n> \u7ed9\u4f60\u4e00\u9897 $n$ \u4e2a\u8282\u70b9\u7684\u6811\uff0c$k$ \u4e2a\u76d1\u542c\u8bbe\u5907\u3002\u76d1\u542c\u8bbe\u5907\u53ef\u4ee5\u76d1\u542c\u4e0e\u5b83\u76f8\u90bb\u7684\u4efb\u4f55\u8282\u70b9\uff0c**\u4f46\u4e0d\u80fd\u76d1\u542c\u5b83\u6240\u5728\u7684\u8282\u70b9**\uff0c\u6bcf\u4e2a\u8282\u70b9\u53ea\u5141\u8bb8\u653e\u7f6e\u4e00\u4e2a\u76d1\u542c\u8bbe\u5907\uff0c\u6c42\u51fa\u5c06 $k$ \u4e2a\u8bbe\u5907\u7528\u5b8c\u4e14\u6bcf\u4e2a\u8282\u70b9\u90fd\u88ab\u76d1\u542c\u5230\u7684\u65b9\u6848\u6570\u3002\n>\n> $\\texttt{Data Range:} 1\\le n\\le 10^5,1\\le k\\le min(100,n)$\n\n# $\\texttt{Solution}$\n\n\u8fd9\u9898\u9762\u548c\u6570\u636e\u89c4\u6a21\u5927\u5bb6\u4e5f\u80fd\u731c\u5230\uff0c\u662f $O(nk)$ \u7684\u6811\u5f62 dp\u3002\n\n\u5b9a\u4e49\u72b6\u6001\uff1a$dp_{u,k,p}$ \u8868\u793a\u5728\u4ee5 $u$ \u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\u4e2d\uff0c\u653e\u7f6e $k$ \u4e2a\u76d1\u542c\u8bbe\u5907\uff0c$u$ \u81ea\u8eab\u662f\u5426\u88ab $u$ \u7684\u5b50\u8282\u70b9\u76d1\u542c\uff08$p$ \u4e3a $0$ \u8868\u793a\u6ca1\u6709\uff0c\u5426\u5219\u8868\u793a\u6709\uff09\u3002\n\n\u4f46\u662f\uff0c\u8fd9\u6837\u5b9a\u4e49\u72b6\u6001\u4f1a\u5bfc\u81f4\u65e0\u6cd5\u8f6c\u79fb\u3002\u56e0\u4e3a\u6211\u4eec\u4e0d\u77e5\u9053 $u$ \u662f\u5426\u653e\u7f6e\u4e86\u76d1\u542c\u8bbe\u5907\uff0c\u8f6c\u79fb\u65f6\u4e5f\u5c31\u4e0d\u77e5\u9053 $u$ \u662f\u5426\u88ab\u5b50\u8282\u70b9\u76d1\u542c\u3002~~\u5176\u5b9e\u662f\u4e2a\u4eba\u90fd\u77e5\u9053\u4e00\u6765\u5c31\u56db\u7ef4\u72b6\u6001\u5427\uff0c\u5c31\u6211\u4e0d\u4f1a~~\u6240\u4ee5\u5b9a\u4e49 $dp_{u,k,p,q}$ \u8868\u793a\u5728\u4ee5 $u$ \u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\u4e2d\uff0c\u653e\u7f6e $k$ \u4e2a\u76d1\u542c\u8bbe\u5907\uff0c$q$ \u8868\u793a $u$ \u81ea\u8eab\u662f\u5426\u88ab $u$ \u7684\u5b50\u8282\u70b9\u76d1\u542c\uff0c$p$ \u8868\u793a $u$ \u8282\u70b9\u662f\u5426\u653e\u7f6e\u4e86\u8282\u70b9\u3002\n\n\u4ee5\u4e0b\u662f\u6076\u5fc3\u7684\u6811\u5f62 dp \u8f6c\u79fb\u65b9\u7a0b\uff08\u7ea6\u5b9a $v$ \u8868\u793a $u$ \u7684\u5b50\u8282\u70b9\uff09\uff1a\n\n$$dp_{u,i+j,0,0}=dp_{u,i,0,0}\\times dp_{v,j,0,1}$$\n$$dp_{u,i+j,0,1}=dp_{u,i,0,0}\\times dp_{v,j,1,1}+dp_{u,i,0,1}\\times(dp_{v,j,0,1}+dp_{v,j,1,1})$$\n$$dp_{u,i+j,1,0}=dp_{u,i,1,0}\\times (dp_{v,j,0,0}+dp_{v,j,0,1})$$\n$$dp_{u,i+j,1,1}=dp_{u,i,1,0}\\times (dp_{v,j,1,0}+dp_{v,j,1,1})+dp_{u,i,1,1}\\times (dp_{v,j,0,0}+dp_{v,j,0,1}+dp_{v,j,1,0}+dp_{v,j,1,1})$$\n\n~~\u4f60\u8c37\u535a\u5ba2feature\u5de8\u591a\uff0c\u4e0d\u80fd\u6362\u884c\u5fc5\u987b\u6253\u591a\u4e2a\u516c\u5f0f\uff0c\u8fd9 $\\LaTeX$ \u771f\u7684\u628a\u6211\u6253\u75af\u4e86~~\n\n~~\u6211\u4eec\u65e0\u8bba\u9047\u5230\u591a\u957f\u7684\u65b9\u7a0b\uff0c\u4e5f\u4e0d\u8981\u6015\uff0c\u5fae\u7b11\u7740\u5199\u4e0b\u5b83\uff0c\u6d88\u9664\u65b9\u7a0b\u7684\u6700\u597d\u65b9\u5f0f\u5c31\u662fA\u4e86\u8fd9\u9053\u9898\uff0c\u795d\u4f60\u4eec\u6210\u529f\uff08\u6ed1\u7a3d~~\n\n~~\u8349\u6211\u600e\u4e48\u628a\u4e24\u4e2a\u6897\u5408\u5728\u4e86\u4e00\u8d77~~\n\n\u89e3\u91ca\u4e00\u4e0b\u65b9\u7a0b\uff1a\n\n\u7b2c\u4e00\u4e2a\u65b9\u7a0b\u4e0d\u5fc5\u591a\u8bf4\uff0c$u$ \u672c\u8eab\u6ca1\u6709\u653e\uff0c\u5b83\u7684\u513f\u5b50\u6ca1\u6709\u6536\u5230\u7236\u4eb2\u76d1\u542c\uff0c\u6240\u4ee5\u513f\u5b50\u5fc5\u987b\u88ab\u5b83\u7684\u8fd9\u4e2a\u513f\u5b50\u7684\u513f\u5b50\u76d1\u542c\u5230\uff08\u5927\u5bb6\u597d\u6211\u8bed\u6587\u6ca1\u6551\u3002\n\n\u7b2c\u4e8c\u4e2a\u65b9\u7a0b\uff0c\u9996\u5148\u8003\u8651 $dp_{u,i+j,0,1}=dp_{u,i,0,0}\\times dp_{v,j,1,1}$ \u8fd9\u4e00\u90e8\u5206\u3002\u7531\u4e8e\u521a\u624d $u$ \u8fd8\u6ca1\u6709\u88ab\u513f\u5b50\u76d1\u542c\uff0c\u4f46\u73b0\u5728\u88ab\u513f\u5b50\u76d1\u542c\u4e86\uff0c\u4e5f\u5c31\u662f\u8bf4\u5fc5\u987b\u88ab $v$ \u513f\u5b50\u76d1\u542c\u3002$dp_{u,i,0,1}\\times(dp_{v,j,0,1}+dp_{v,j,1,1})$ \u8868\u793a\u53cd\u6b63 $u$ \u5df2\u7ecf\u88ab\u76d1\u542c\u4e86\uff0c$v$ \u653e\u4e0d\u653e\u76d1\u542c\u88c5\u7f6e\u90fd\u884c\u3002\n\n\u7b2c\u4e09\u4e2a\u65b9\u7a0b\uff0c$u$ \u653e\u4e86\u76d1\u542c\u88c5\u7f6e\uff0c\u6240\u4ee5 $v$ \u88ab\u6ca1\u88ab\u513f\u5b50\u76d1\u542c\u90fd\u53ef\u4ee5\u3002\n\n\u7b2c\u56db\u4e2a\u65b9\u7a0b~~\u6700\u957f\u7684~~\uff0c$dp_{u,i,1,0}\\times (dp_{v,j,1,0}+dp_{v,j,1,1})$  \u548c\u7b2c\u4e8c\u4e2a\u65b9\u7a0b\u540c\u7406\uff0c$u$ \u5fc5\u987b\u88ab $v$ \u76d1\u542c\uff0c\u800c $u$ \u653e\u4e86\u88c5\u7f6e\uff0c$v$ \u653e\u4e0d\u653e\u90fd\u65e0\u6240\u8c13\u3002\u540e\u9762\u90a3\u4e00\u5768\u5219\u662f $u$ \u5df2\u7ecf\u88ab\u76d1\u542c\u4e86\uff0c\u800c $u$ \u53c8\u653e\u4e86\u88c5\u7f6e\uff0c\u6240\u4ee5\u5b83\u7684\u513f\u5b50\u600e\u4e48\u641e\u90fd\u884c\u3002\n\n\u590d\u6742\u5ea6\u8bc1\u660e\u6211\u4e0d\u4f1a\uff08\u6ed1\u7a3d\n\n\u53cd\u6b63\u662f $O(nk)$ \u7684\u3002\u4f1a\u7528\u5c31\u884c\uff0c\u590d\u6742\u5ea6\u8fd9\u79cd\u7384\u5b66\u4e0d\u5fc5\u53bb\u6df1\u7a76\uff0c\u53c8\u4e0d\u4f1a\u7ed9\u4f60\u8003\u573a\u4e0a\u52a0\u5206\uff08\n\n# $\\texttt{Code}$\n\n\u4ee3\u7801\u5b9e\u73b0\u7ec6\u8282\uff1a\n\ndp \u6570\u7ec4\u4e0d\u80fd\u5f00`long long`\u3002\u4f1a\u88ab\u5361\u7a7a\u95f4\uff0c\u5fc5\u987b\u4e2d\u9014\u8ba1\u7b97\u65f6\u8f6c\u4e3a`long long`\u518d\u8f6c\u56de`int`\u3002\n\n\u5185\u542b\u6ce8\u91ca\u3002\n\n```cpp\n#include <cstdio>\n\nconst int MOD = 1e9 + 7;\ninline int min(const int x, const int y) {return x < y ? x : y;}\nstruct Edge {\n\tint to, nxt;\n} e[200005];\nint head[100005], cnt[100005], dp[100005][105][2][2], tmp[105][2][2], tot, n, k;\ninline void AddEdge(const int u, const int v) {\n\te[++ tot].to = v, e[tot].nxt = head[u], head[u] = tot;\n}\nvoid dfs(const int u, const int fa) {\n\tdp[u][0][0][0] = dp[u][1][1][0] = cnt[u] = 1LL;//\u521d\u59cb\u5316\n\tint lim(1);\n\tfor (int I(head[u]); I; I = e[I].nxt) if (e[I].to != fa) {\n\t\tconst int v(e[I].to);\n\t\tdfs(v, u);\n\t\tfor (int i(0); i <= k; ++ i)\n\t\t\ttmp[i][0][0] = tmp[i][0][1] = tmp[i][1][0] = tmp[i][1][1] = 0LL;//tmp\u6570\u7ec4\u8bb0\u5f55\u5f53\u524d\u9636\u6bb5\u7684dp\u6570\u7ec4\uff0c\u65b9\u4fbf\u8f6c\u79fb\u3002\u76f4\u63a5\u5728\u539f\u6765\u7684dp\u6570\u7ec4\u4e0a\u8f6c\u79fb\u4e0d\u884c\n\t\tfor (int i(0); i <= cnt[u] && i <= k; ++ i)//\u5957\u4e00\u4e0b\u80cc\u5305\u677f\u5b50\uff0ccnt[u]\u4e3au\u7684\u8282\u70b9\u4e2a\u6570\n\t\tfor (int j(0); j <= cnt[v] && j <= k - i; ++ j) {\n\t\t\tif (i + j > lim) lim = i + j;///\u7b97\u8fc7\u7684\u6700\u5927\u7684tmp\u6570\u7ec4\u4e0b\u6807\uff0c\u56e0\u4e3a\u7b97\u5b8c\u4e86\u8981\u628atmp\u8d4b\u503c\u7ed9dp\u6570\u7ec4\u3002\n\t\t\ttmp[i + j][0][0] = (1LL * tmp[i + j][0][0] + 1LL * dp[u][i][0][0] * dp[v][j][0][1] % MOD) % MOD;\n\t\t\ttmp[i + j][0][1] = (1LL * tmp[i + j][0][1] + 1LL * dp[u][i][0][0] * dp[v][j][1][1] % MOD + 1LL * dp[u][i][0][1] * (dp[v][j][0][1] + dp[v][j][1][1]) % MOD) % MOD;\n\t\t\ttmp[i + j][1][0] = (1LL * tmp[i + j][1][0] + 1LL * dp[u][i][1][0] * (dp[v][j][0][0] + dp[v][j][0][1]) % MOD) % MOD;\n\t\t\ttmp[i + j][1][1] = (1LL * tmp[i + j][1][1] + 1LL * dp[u][i][1][0] * (dp[v][j][1][0] + dp[v][j][1][1]) % MOD + 1LL * dp[u][i][1][1] * (1LL * dp[v][j][0][0] + dp[v][j][0][1] + 1LL * dp[v][j][1][0] + dp[v][j][1][1]) % MOD) % MOD;\n\t\t}\n\t\tfor (int i(0); i <= lim; ++ i)\n\t\t\tdp[u][i][0][0] = tmp[i][0][0], dp[u][i][0][1] = tmp[i][0][1], dp[u][i][1][0] = tmp[i][1][0], dp[u][i][1][1] = tmp[i][1][1];//\u7b97\u5b8c\u4e86\u8bb0\u5f97\u628atmp\u8d4b\u503c\u7ed9dp\u6570\u7ec4\n\t\tcnt[u] += cnt[v];\n\t}\n}\nsigned main() {\n\tscanf(\"%d%d\", &n, &k);\n\tfor (int i(1); i < n; ++ i) {\n\t\tint u, v;\n\t\tscanf(\"%d%d\", &u, &v);\n\t\tAddEdge(u, v), AddEdge(v, u);\n\t}\n\tdfs(1, -1);\n\tprintf(\"%d\\n\", (dp[1][k][0][1] + dp[1][k][1][1]) % MOD);\n\treturn 0;\n}\n```",
        "postTime": 1616125289,
        "uid": 361308,
        "name": "Stinger",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011"
    },
    {
        "content": "# \u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011\n\n[P4516 [JSOI2018]\u6f5c\u5165\u884c\u52a8](https://www.luogu.com.cn/problem/P4516)\n\n\n\u8fd9\u662f\u4e00\u9053\u6811\u4e0a\u80cc\u5305\u7684\u9898\u76ee\uff0c\u786e\u5b9e\u5f88\u96be\u60f3\u5230\u601d\u8def\n\n\u9996\u5148\u5b9a\u4e49\u4e00\u4e2a\u6570\u7ec4\uff0c\u7528\u6765\u5b58\u50a8\u72b6\u6001\n\n\u5373\uff1a$dp[u][i][0/1][0/1] \\implies $ \u8868\u793a\u4ee5 $u$ \u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\uff0c\u5728\u653e\u4e86 $i$ \u4e2a\u76d1\u89c6\u5668,\u4fdd\u8bc1\u5168\u90e8\u7684\u5b50\u6811\u4e0a\u70b9\u90fd\u88ab\u76d1\u89c6\u5230\u7684\u60c5\u51b5\u4e0b\uff0c\u5e26\u70b9 $u$ \u4e0a\u653e\u4e0e\u4e0d\u653e\u76d1\u89c6\u5668\uff0c\u4e14\u662f\u5426\u88ab\u76d1\u89c6\u5230\u3002\n\n\u5728\u770b\u51fa\u80cc\u5305\u540e\uff0c\u6211\u4eec\u53bb\u5bfb\u627e\u8f6c\u79fb\u65b9\u7a0b\uff08\u8fd9\u5c31\u662f\u91cd\u96be\u70b9\uff09\uff0c\n\n\u73b0\u5728\u5047\u8bbe\uff0c\u6211\u4eec\u5df2\u5c06\u67e5\u8be2\u5230\u4e86\u4ee5 $u$ \u4e3a\u6839\u8282\u70b9\u7684\u6811 $k_1$ \uff0c\u6b64\u65f6\u53d1\u73b0\u4e86\u8fd9\u4e2a\u6811\u7684\u4e0b\u65b9\u8fd8\u6709\u4e00\u4e2a\u8fd8\u6709\u4ee5 $v$ \u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811 $k_2$\uff0c\u4e8e\u662f\u628a\u8fd9\u4e2a\u5b50\u6811\u5c31\u5e76\u5728\u4e00\u8d77\u5f62\u6210\u4e00\u4e2a\u5927\u7684\u56fe\u4ee5\u6ee1\u8db3\u8981\u6c42\uff1a\n\n------\n\n$$\n\\forall dp[u][i][0][0]\n$$\n\n$u$ \u70b9\u6ca1\u6709\u88ab\u653e\u7f6e\uff0c\u4e14\u6ca1\u6709\u88ab\u76d1\u89c6\u5230\n\n\u6240\u4ee5 $v$ \u70b9\u5904\u4e0d\u80fd\u653e\u76d1\u89c6\u5668\uff0c\u8fd9\u662f\u80af\u5b9a\u7684\uff0c\u4f46\u662f\u8fd9\u5e76\u4e0d\u5f71\u54cd $v$ \u70b9\u88ab\u76d1\u89c6\u5230\n\n$$\n\\therefore dp[u][i+j][0][0] = \\sum dp[u][i][0][0] \\times dp[v][j][0][1] \n$$\n\n------\n\n$$\n\\forall dp[u][i][0][1]\n$$\n\n\u8fd9\u79cd\u60c5\u51b5\u8981\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n- $u$ \u4e00\u4fa7\u5b50\u6811\u7684\u72b6\u6001\u4e3a $dp[u][i][0][1]$\n\n\u8fd9\u65f6\u5019 $u$ \u5df2\u7ecf\u88ab\u76d1\u89c6\u4e86\uff0c\u6240\u4ee5\u5728\u4e0d\u5728 $v$ \u5904\u653e\u76d1\u89c6\u5668\uff0c\u5bf9\u4e8e\u5f53\u524d\u7684\u7ed3\u679c\u6ca1\u6709\u4efb\u4f55\u5f71\u54cd\uff0c\u4f46\u662f\u8981\u4fdd\u8bc1\u6bcf\u4e2a\u70b9\u90fd\u88ab\u76d1\u89c6\u5230\uff0c\u6240\u4ee5 $v$ \u70b9\u88ab\u76d1\u89c6\u5230\n\n\uff0d\u3000$u$ \u4e00\u4fa7\u5b50\u6811\u7684\u72b6\u6001\u4e3a $dp[u][i][0][0]$\n\n\u8fd9\u65f6\u5019 $u$ \u8fd8\u6ca1\u88ab\u76d1\u89c6\uff0c\u6240\u4ee5\u5728 $v$ \u5904\u653e\u76d1\u89c6\u5668\u662f\u4e0d\u4e89\u7684\u4e8b\u5b9e\uff0c\u540c\u65f6\u8981\u4fdd\u8bc1\u6bcf\u4e2a\u70b9\u90fd\u88ab\u76d1\u89c6\u5230\u6240\u4ee5 $v$ \u70b9\u4e5f\u5fc5\u987b\u88ab\u76d1\u89c6\n\n$$\n\\therefore dp[u][i+j][0][1] = \\sum (dp[u][i][0][1] \\times (dp[v][j][0][1] + dp[v][j][1][1]) + dp[u][i][0][0] \\times dp[v][j][1][1])\n$$\n\n------\n\n$$\n\\forall dp[u][i][1][0]\n$$\n\n$u$ \u6ca1\u88ab\u76d1\u89c6\u4f46\u662f\u653e\u4e86\u76d1\u89c6\u5668\uff0c\u6240\u4ee5 $u$ \u4e00\u4fa7\u5b50\u6811\u7684\u72b6\u6001\u4e00\u5b9a\u662f $dp[u][i][1][0]$\uff0c$v$ \u662f\u5426\u88ab\u76d1\u89c6\u65e0\u6240\u8c13\uff0c\u4f46\u662f\u4e00\u5b9a\u4e0d\u80fd\u653e\u88c5\u7f6e\n\n$$\n\\therefore dp[u][i+j][1][0] = \\sum dp[u][i][1][0] \\times (dp[v][j][0][0] + dp[v][j][0][1])\n$$\n\n------\n\n$$\n\\forall dp[u][i][1][1]\n$$\n\n\u8fd9\u79cd\u60c5\u51b5\u4e5f\u8981\u5206\u7c7b\u8ba8\u8bba(\u76f4\u63a5\u3000$wuhu$\u3000\u8d77\u98de)\uff1a\n\n- $u$ \u4e00\u4fa7\u5b50\u6811\u7684\u72b6\u6001\u4e3a $dp[u][i][1][0]$\n\n\u6240\u4ee5\u6211\u4eec\u9700\u8981 $v$ \u70b9\u4e0a\u653e\u76d1\u89c6\u5668\u6765\u76d1\u89c6 $u$ \uff0c\u540c\u65f6 $v$ \u70b9\u6ca1\u6709\u5fc5\u8981\u88ab\u76d1\u89c6\n\n- $u$ \u4e00\u4fa7\u5b50\u6811\u7684\u72b6\u6001\u4e3a $dp[u][i][1][\uff11]$\n\n$u$ \u5df2\u7ecf\u88ab $k_1$ \u4fa7\u5b50\u6811\u6ee1\u8db3\u4e86\uff0c\u6240\u4ee5 $v$ \u6765\u8bf4\u53ef\u4ee5\u968f\u4fbf\u7684\u5b89\u6392\uff08$Everything is OK.$\uff09\n\n$$\n\\therefore dp[u][i+j][1][1] = \\sum (dp[u][i][1][0] \\times (dp[v][j][1][0] + dp[v][j][1][1]) + dp[u][i][1][1] * (dp[v][j][0][0] + dp[v][j][0][1] + dp[v][j][1][0] + dp[v][j][1][1]))\n$$\n\n------\n\n\u7efc\u4e0a\u6240\u8ff0:\n\n$$\ndp[u][i+j][0][0] = \\sum dp[u][i][0][0] \\times dp[v][j][0][1]\n$$\n\n$$\ndp[u][i+j][0][1] = \\sum (dp[u][i][0][1] \\times (dp[v][j][0][1] + dp[v][j][1][1]) + dp[u][i][0][0] \\times dp[v][j][1][1])\n$$\n\n$$\ndp[u][i+j][1][0] = \\sum dp[u][i][1][0] \\times (dp[v][j][0][0] + dp[v][j][0][1])\n$$\n\n$$\ndp[u][i+j][1][1] = \\sum (dp[u][i][1][0] \\times (dp[v][j][1][0] + dp[v][j][1][1]) + dp[u][i][1][1] * (dp[v][j][0][0] + dp[v][j][0][1] + dp[v][j][1][0] + dp[v][j][1][1]))\n$$\n\n# code\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int SIZE = 1e5 + 50;\nconst int NUM = 110;\nconst int mod = 1e9 + 7;\n\ninline int read()\n{\n\tint x = 0, f = 1;\n\tchar ch = getchar();\n\twhile (ch < '0' || ch > '9')\n\t{\n\t\tf = (ch == '-' ? -1 : 1);\n\t\tch = getchar();\n\t}\n\twhile (ch >= '0' && ch <= '9')\n\t{\n\t\tx = (x << 1) + (x << 3) + (ch ^ 48);\n\t\tch = getchar();\n\t}\n\treturn f * x;\n}\n\n\nint n,k,num_edge;\nint head[SIZE],siz[SIZE];\nint dp[SIZE][NUM][2][2],tmp[NUM][2][2];\nstruct node\n{\n\tint to,nxt;\n};\nnode edge[SIZE << 1];\n\ninline void add(int u,int v)\n{\n\tedge[++num_edge].to = v;\n\tedge[num_edge].nxt = head[u];\n\thead[u] = num_edge;\n}\n\ninline int solve(int u,long long v)\n{\n\tif (v >= mod) v = v % mod;\n\tfor (u += v; u >= mod; u -= mod);\n\treturn u;\n}\n\nvoid dfs(int u,int fa)\n{\n\tsiz[u] = dp[u][0][0][0] = dp[u][1][1][0] = 1;\n\tfor (register int t = head[u]; t; t = edge[t].nxt)\n\t{\n\t\tregister int v = edge[t].to;\n\t\tif (v == fa) continue;\n\t\tdfs(v,u);\n\t\tregister int side = min(siz[u],k);\n\t\tfor (register int i = 0; i <= side; ++i)\n\t\t{\n\t\t\ttmp[i][0][0] = dp[u][i][0][0];\n\t\t\tdp[u][i][0][0] = 0;\n\t\t\ttmp[i][0][1] = dp[u][i][0][1];\n\t\t\tdp[u][i][0][1] = 0;\n\t\t\ttmp[i][1][0] = dp[u][i][1][0];\n\t\t\tdp[u][i][1][0] = 0;\n\t\t\ttmp[i][1][1] = dp[u][i][1][1];\n\t\t\tdp[u][i][1][1] = 0;\n\t\t}\n\t\tfor (register int i = 0; i <= side; ++i)\n\t\t{\n\t\t\tregister int limit = min(siz[v],k-i);\n\t\t\tfor (register int j = 0; j <= limit; ++j)\n\t\t\t{\n\t\t\t\tdp[u][i+j][0][0] = solve(dp[u][i+j][0][0],1ll * tmp[i][0][0] * dp[v][j][0][1]);\n\t\t\t\tdp[u][i+j][0][1] = solve(dp[u][i+j][0][1],1ll * tmp[i][0][1] * (dp[v][j][0][1] + dp[v][j][1][1]));\n\t\t\t\tdp[u][i+j][0][1] = solve(dp[u][i+j][0][1],1ll * tmp[i][0][0] * dp[v][j][1][1]);\n\t\t\t\tdp[u][i+j][1][0] = solve(dp[u][i+j][1][0],1ll * tmp[i][1][0] * (dp[v][j][0][0] + dp[v][j][0][1]));\n\t\t\t\tdp[u][i+j][1][1] = solve(dp[u][i+j][1][1],1ll * tmp[i][1][0] * (dp[v][j][1][0] + dp[v][j][1][1]));\n\t\t\t\tdp[u][i+j][1][1] = solve(dp[u][i+j][1][1],1ll * tmp[i][1][1] * (1ll * dp[v][j][0][0] + 1ll * dp[v][j][0][1] + 1ll * dp[v][j][1][0] + 1ll * dp[v][j][1][1]));\n\t\t\t}\n\t\t}\n\t\tsiz[u] += siz[v];\n\t}\n}\nint main()\n{\n\tn = read();k = read();\n\tfor (register int i = 1; i < n; ++i)\n\t{\n\t\tregister int u = read(),v = read();\n\t\tadd(u,v);\n\t\tadd(v,u);\n\t}\n\tdfs(1,0);\n\tprintf(\"%d\\n\",(dp[1][k][0][1] + dp[1][k][1][1]) % mod);\n\treturn 0;\n}\n\n```",
        "postTime": 1606309107,
        "uid": 415231,
        "name": "nomonick",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011"
    },
    {
        "content": "~~Orz\u5c45\u7136\u662f\u7d2b\u9898~~\n\n\u9996\u5148\u72b6\u6001\u5b9a\u4e49\u662f\u663e\u7136\u7684\uff1a\n\n$ dp(u,i,0/1,0/1)$ \u8868\u793a $u$ \u7684\u5b50\u6811\u9664\u81ea\u5df1\u90fd\u5df2\u7ecf\u4fdd\u8bc1\u88ab\u76d1\u542c\uff0c\u7528\u4e86 $i$ \u4e2a\u76d1\u542c\u5668\uff0c\u5f53\u524d\u8282\u70b9\u662f\u5426\u5b89\u88c5\u76d1\u542c\u5668\uff0c\u662f\u5426\u88ab\u76d1\u542c\n\n~~\u5f88\u663e\u7136~~\u7684\u6709\u8fd9\u4e48\u51e0\u4e2a\u72b6\u6001\u8f6c\u79fb\n\n$dp(u,i,0,0)=\\sum dp(v,j,0,1) \\times dp(u,i-j,0,0)$\n\n$dp(u,i,0,1)=\\sum (dp(v,j,1,1)+dp(v,j,0,1)) \\times (dp(u,i-j,0,1)+dp(u,i-j,0,0))-dp(u,i,0,0)$\n\n$dp(u,i,1,0)=\\sum (dp(v,j,0,0)+dp(v,j,0,1)) \\times dp(u,i-j,1,0)$\n\n$dp(u,i,1,1)=\\sum (dp(v,j,1,1)+dp(v,j,1,0)+dp(v,j,0,0)+dp(v,j,0,1)) \\times (dp(u,i-j,1,0)+dp(u,i-j,1,1))-dp(u,i,1,0)$\n\n\u4f46\u662f\u66f4\u65b0\u7684\u987a\u5e8f\u6709\u70b9\u5c0f\u70e6\n\n\u9996\u5148\uff0c\u56e0\u4e3a\u662f\u6811\u5f62\u8ba1\u6570\u95ee\u9898\uff0c\u6240\u4ee5DP\u7684\u65f6\u5019\u524d\u9762\u7684\u72b6\u6001\u4e0d\u80fd\u4fdd\u7559\uff0c\u8981\u5f00\u4e00\u4e2a\u4e34\u65f6\u6570\u7ec4g\u66f4\u65b0\uff08\u5f53\u7136\u53ef\u4ee5\u4e0d\u7528\uff0c\u7279\u5224\u4e00\u4e0b $j=0$ \u7684\u60c5\u51b5\u4f18\u5148\u66f4\u65b0\uff0c\u518d\u5012\u5e8f\u66f4\u65b0\u5373\u53ef\uff09\n\n\u5176\u6b21\uff0c\u6211\u4eec\u9700\u8981\u8003\u8651\u6bcf\u6b21\u8f6c\u79fb\u65f6\u7684\u679a\u4e3e\u8fb9\u754c\uff0c\u5426\u5219\u590d\u6742\u5ea6\u4f1a\u5047\uff1a(\u4e0b\u6587 $siz[u]$ \u5747\u4e3a\u53ea\u7b97\u5165\u5f53\u524d\u5b50\u6811\u548c\u4e4b\u524d\u5df2\u66f4\u65b0\u5b50\u6811\u7684\u503c\uff0c\u8be6\u89c1\u4ee3\u7801)\n\n$i$ \u80af\u5b9a\u4e0d\u80fd\u8d85\u8fc7\u5176\u5b50\u6811\u5927\u5c0f\n\n$0\\le i\\le \\min (siz[u],k)$\n\n$j$ \u8981\u6ee1\u8db3 $i-j\\le siz[u]-siz[v]$ \u4e14\u4e0d\u8d85\u8fc7 $v$ \u7684\u5b50\u6811\u5927\u5c0f\uff1a\n\n$\\max(0,siz[v]-siz[u]+i)\\le j\\le \\min(i,siz[v])$\n\n\u6b64\u5916\uff0cDP\u65f6\u90a3\u4e2a\u51cf\u6cd5\u64cd\u4f5c\u6700\u540e\u518d\u505a\uff0c\u4ee5\u514d\u51cf\u51fa\u8d1f\u6570\uff0c\u4e5f\u65b9\u4fbf\u7ef4\u62a4\u8f6c\u79fb\u7684\u6b63\u786e\u6027\n\n\u8fd9\u6837\u5c31\u80fd\u4fdd\u8bc1\u6b63\u786e\u6027\u4e86\n\n\u81f3\u4e8e\u590d\u6742\u5ea6\u2026\u2026\n\n\u7531\u4e8e\u6211\u4eec\u7684\u66f4\u65b0\u662f\u6b63\u786e\u7684\u4e14\u6ca1\u6709\u5197\u4f59\u7684\uff08\u4e5f\u8bb8\uff09\uff0c\u6240\u4ee5\u8f6c\u79fb\u590d\u6742\u5ea6\u80fd\u591f\u8fbe\u5230 $O(K^2)$ \u7684\u70b9\u6700\u591a $n/k$ \u4e2a\uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u4e3a $O(nk)$\n\n**\u4ee3\u7801\uff1a**\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define re register\n#define ll long long\ninline int rd(){\n\tint re data=0;static char ch=0;ch=getchar();\n\twhile(!isdigit(ch))ch=getchar();\n\twhile(isdigit(ch))data=(data<<3)+(data<<1)+(ch^48),ch=getchar();\n\treturn data;\n}\nconst int N=1e5+5,K=105,mod=1e9+7;\nint n,k,first[N],siz[N],cnt,dp[N][K][2][2],g[K][2][2];\nstruct edges{int v,nxt;}e[N<<1];\ninline void add(int u,int v){e[++cnt]=(edges){v,first[u]},first[u]=cnt;}\ninline void dfs(int u,int fa){\n\tsiz[u]=1,dp[u][0][0][0]=dp[u][1][1][0]=1;\n\tfor(int re v,i=first[u];i;i=e[i].nxt){\n\t\tv=e[i].v;if(v==fa)continue;\n\t\tdfs(v,u),siz[u]+=siz[v],memcpy(g,dp[u],sizeof g);\n\t\tfor(int re i=min(k,siz[u]);~i;--i)dp[u][i][0][0]=dp[u][i][0][1]=dp[u][i][1][0]=dp[u][i][1][1]=0;\n\t\tfor(int re i=min(k,siz[u]);~i;--i){\n\t\t\tint re maxl=min(i,siz[v]);\n\t\t\tfor(int re j=max(0,i+siz[v]-siz[u]);j<=maxl;++j){\n\t\t\t\t(dp[u][i][0][0]+=(ll)dp[v][j][0][1]*g[i-j][0][0]%mod)%=mod,\n\t\t\t\t(dp[u][i][0][1]+=((ll)dp[v][j][1][1]+dp[v][j][0][1])%mod*(g[i-j][0][1]+g[i-j][0][0])%mod)%=mod,\n\t\t\t\t(dp[u][i][1][0]+=((ll)dp[v][j][0][0]+dp[v][j][0][1])%mod*g[i-j][1][0]%mod)%=mod,\n\t\t\t\t(dp[u][i][1][1]+=((ll)dp[v][j][1][1]+dp[v][j][1][0]+dp[v][j][0][0]+dp[v][j][0][1])%mod*(g[i-j][1][0]+g[i-j][1][1])%mod)%=mod;\t\t\t\t\n\t\t\t}((dp[u][i][0][1]-=dp[u][i][0][0])+=mod)%=mod,((dp[u][i][1][1]-=dp[u][i][1][0])+=mod)%=mod;\n\t\t}\t\t\n\t}\n}\nsigned main(){\n\tn=rd(),k=rd();\n\tfor(int re u,v,i=1;i^n;++i)u=rd(),v=rd(),add(u,v),add(v,u);\n\tdfs(1,0),cout<<(dp[1][k][0][1]+dp[1][k][1][1])%mod,exit(0);\n}\n```",
        "postTime": 1573090940,
        "uid": 117629,
        "name": "VulcanStig",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011"
    },
    {
        "content": "\u7b80\u5355\u7684\u6811\u5f62dp\u3002\n\n\u8bbe$f[i][j][0/1][0/1]$\u8868\u793a$i$\u7684\u5b50\u6811\u4e2d\u5df2\u5b89\u88c5$j$\u4e2a\u88c5\u7f6e\uff0c$i$\u662f/\u5426\u5b89\u88c5\uff0c\u662f/\u5426\u88ab\u63a7\u5236\u7684\u65b9\u6848\u6570\uff0cdp\u65b9\u7a0b\u968f\u4fbf\u63a8\u63a8\u6ce8\u610f\u4e0b\u7ec6\u8282\u5c31\u884c\u3002\n\n\u590d\u6742\u5ea6$O(nk)$\n\n\u7136\u540e\u89c2\u5bdf\u6570\u636e\uff0c$n$\u8fdc\u5927\u4e8e$k$\uff0c\u5982\u679c\u6811\u592a\u6df1\u7b54\u6848\u4e00\u5b9a\u662f$0$\uff0c\u51fa\u9898\u4eba\u53ef\u80fd\u4e0d\u60f3\u8ba9\u8f93\u51fa$0$\u7684\u4eba\u62ff\u9ad8\u5206\uff0c\u90a3\u4e48\u8fd9\u9897\u6811\u8282\u70b9\u7684\u5ea6\u6570\u5927\u6982\u7387\u975e\u5e38\u5927\uff0c\u8fd1\u4f3c\u4e00\u4e2a\u83ca\u82b1\u56fe\u3002\n\n\u8fd9\u65f6\u518d\u5199\u94fe\u8868\u663e\u7136\u662f\u4e0d\u660e\u667a\u7684\u505a\u6cd5\uff0c\u5229\u7528vector\u5185\u5b58\u8fde\u7eed\u7684\u7279\u6027\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u6bd4\u94fe\u8868\u8981\u5feb\u4e86\u3002\u5c31\u4e0d\u4f1a\u51fa\u73b0\u63d0\u4ea4\u8bb0\u5f55\u91cc\u9762\u7684\u4e00\u7247$80$\u5206\uff0c\u5f00O2\u540e$100$\u5206\u7684\u5c34\u5c2c\u60c5\u51b5\u3002\n\n\u73b0\u5728\u5404\u5927\u6bd4\u8d5b\u7eb7\u7eb7\u652f\u6301C++11\uff0c\u8fd8\u5f00O2\uff0c\u4ee5\u540e\u5b58\u56fe\u662f\u4e0d\u662f\u90fd\u4e0d\u7528\u5199\u94fe\u8868\u4e86\uff08\u96fe\n\n[\u867d\u7136\u8fd9\u91cc\u9762\u6ca1\u6709\u8fd9\u7bc7\u9898\u89e3\u4f46\u6211\u8fd8\u662f\u8981\u653e\u51fa\u6765\uff01](http://blog-wayne.com/)\n\n```cpp\nvoid dfs(int u, int fa) {\n    siz[u] = 1;\n    f[u][0][0][0] = f[u][1][1][0] = 1;\n    for (auto v : E[u])\n        if (v != fa) {\n            dfs(v, u);\n            for (int i = 0, lim = min(siz[u], k); i <= lim; i++) {\n                g[i][0][0] = f[u][i][0][0], f[u][i][0][0] = 0;\n                g[i][0][1] = f[u][i][0][1], f[u][i][0][1] = 0;\n                g[i][1][0] = f[u][i][1][0], f[u][i][1][0] = 0;\n                g[i][1][1] = f[u][i][1][1], f[u][i][1][1] = 0;\n            }\n            //\u8fd9\u6837\u5927\u6982\uff0c\u53ef\u80fd\uff0c\u4e5f\u8bb8\u6bd4\u4e24\u4e2a\u5faa\u73af\u8981\u5feb\u90a3\u4e48\u4e00\u70b9\u70b9\u5427\u3002\n            for (int i = 0, lim = min(siz[u], k); i <= lim; i++)\n                for (int j = 0, lim2 = min(siz[v], k); j <= lim2 && i + j <= k; j++) {\n                    add(f[u][i + j][0][0], g[i][0][0] * f[v][j][0][1]);\n                    add(f[u][i + j][0][1], g[i][0][1] * (f[v][j][0][1] + f[v][j][1][1]) + g[i][0][0] * f[v][j][1][1]);\n                    add(f[u][i + j][1][0], g[i][1][0] * (f[v][j][0][0] + f[v][j][0][1]));\n                    add(f[u][i + j][1][1], g[i][1][0] * (f[v][j][1][0] + f[v][j][1][1]) + g[i][1][1] * ((ll)f[v][j][0][0] + f[v][j][0][1] + f[v][j][1][0] + f[v][j][1][1]));\n                }\n            siz[u] += siz[v];\n        }\n}\n```",
        "postTime": 1526476343,
        "uid": 37070,
        "name": "Ameyax",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011"
    },
    {
        "content": "\u4e00\u9053\u4e0d\u9519\u7684\u6811\u5f62 dp \u9898\u3002\n\n\u5f88\u5bb9\u6613\u60f3\u5230 dp \u72b6\u6001\uff0c$f[i][j][0/1][0/1]$ \u8868\u793a $i$ \u7684\u5b50\u6811\u653e\u4e86 $j$ \u4e2a\u76d1\u542c\u5668\uff0c\u5e76\u4e14 $i$ \u6709/\u6ca1\u6709 \u653e\u76d1\u542c\u5668\uff0c$i$ \u6709/\u6ca1\u6709 \u88ab\u8986\u76d6\u5230\u3002\n\n\u63a5\u4e0b\u6765\u662f\u8f6c\u79fb\u65b9\u7a0b\uff08$x \\to t$\uff09\uff1a\n\n\u5982\u679c $x$ \u6ca1\u6709\u653e\u76d1\u542c\u5668\uff0c\u4e5f\u6ca1\u6709\u88ab\u8986\u76d6\u5230\uff0c\u90a3\u4e48 $t$ \u663e\u7136\u4e0d\u80fd\u653e\u76d1\u542c\u5668\uff08\u653e\u4e86\u5c31\u8986\u76d6\u5230 $i$ \u4e86\uff09\u3002\n\n\u53c8\u56e0\u4e3a\u73b0\u5728 $x$ \u4e0d\u653e\uff0c\u800c\u4e14\u9664\u4e86 $i$ \u4ee5\u5916\u6240\u6709\u8fde\u63a5 $t$ \u7684\u8282\u70b9\u90fd\u5df2\u7ecf\u904d\u5386\u8fc7\u4e86\uff0c\u6240\u4ee5\u5982\u679c $t$ \u8fd8\u6ca1\u88ab\u76d1\u542c\uff0c\u5c31\u6ca1\u6709\u673a\u4f1a\u518d\u88ab\u76d1\u542c\u4e86\uff0c\u6240\u4ee5 $t$ \u5fc5\u987b\u88ab\u76d1\u542c\u8fc7\u3002\n\n\u5373 $f[x][i+j][0][0]=f[x][i][0][0]\\times f[t][j][0][1]$\u3002\n\n\u5982\u679c $x$ \u6ca1\u6709\u653e\u76d1\u542c\u5668\uff0c\u88ab\u8986\u76d6\u5230\u4e86\uff08\u5373 $f[x][i+j][0][1]$\uff09\uff0c\u90a3\u4e48\u8981\u4e0d\u662f $x$ \u7684\u5b50\u6811\u8986\u76d6\u7684\uff0c\u8981\u4e0d\u662f $t$ \u8986\u76d6\u7684\u3002\n\n\u5982\u679c\u662f $x$ \u7684\u5b50\u6811\u8986\u76d6\u7684\uff0c\u90a3\u4e48 $t$ \u653e\u4e0d\u653e\u90fd\u65e0\u6240\u8c13\uff0c\u4f46\u662f $t$ \u5fc5\u987b\u88ab\u76d1\u542c\u8fc7\uff08\u9053\u7406\u540c\u4e0a\uff09\u3002\n\n\u5982\u679c\u662f $t$ \u8986\u76d6\u7684\uff0c\u90a3\u4e48 $t$ \u5fc5\u987b\u653e\uff0c\u5e76\u4e14\u5fc5\u987b\u88ab\u76d1\u542c\u8fc7\uff08\u540c\u4e0a\uff09\u3002\n\n\u5373 $f[x][i+j][0][1]=f[x][i][0][1]\\times(f[t][j][0][1]+f[t][j][1][1])+f[x][i][0][0]\\times f[t][j][1][1]$\u3002\n\n\u5982\u679c $x$ \u653e\u4e86\u76d1\u542c\u5668\uff0c\u6ca1\u6709\u88ab\u8986\u76d6\u5230\uff08\u5373 $f[x][i+j][1][0]$\uff09\uff0c\u90a3\u4e48 $t$ \u548c $x$ \u7684\u5b50\u6811\u80af\u5b9a\u90fd\u4e0d\u80fd\u8986\u76d6\u5230 $x$\uff0c\u4e14 $t$ \u6709\u6ca1\u6709\u88ab\u8986\u76d6\u5230\u65e0\u6240\u8c13\uff08\u56e0\u4e3a\u63a5\u4e0b\u6765 $x$ \u4e00\u5b9a\u80fd\u8986\u76d6 $t$\uff09\u3002\u5373 $f[x][i+j][1][0]=f[x][i][1][0]\\times(f[t][j][0][0]+f[t][j][0][1])$\u3002\n\n\u5982\u679c $x$ \u653e\u4e86\u76d1\u542c\u5668\uff0c\u4e5f\u88ab\u8986\u76d6\u5230\u4e86\uff0c\u90a3\u4e48\u8fd8\u662f\u4e24\u79cd\u53ef\u80fd\uff0c\u8981\u4e0d\u662f $x$ \u7684\u5b50\u6811\u8986\u76d6\u7684\uff0c\u8981\u4e0d\u662f $t$ \u8986\u76d6\u7684\u3002\n\n\u5982\u679c\u662f $x$ \u7684\u5b50\u6811\u8986\u76d6\u7684\uff0c\u90a3\u4e48 $t$ \u653e\u4e0d\u653e\u90fd\u65e0\u6240\u8c13\u3002\u5e76\u4e14\u6b64\u65f6 $x$ \u4e00\u5b9a\u80fd\u76d1\u542c $t$\uff0c\u6240\u4ee5 $t$ \u662f\u5426\u88ab\u76d1\u542c\u4e5f\u65e0\u6240\u8c13\u3002\n\n\u5982\u679c $x$ \u7684\u5b50\u6811\u6ca1\u6709\u8986\u76d6\u5230\uff0c\u90a3\u4e48 $t$ \u4e00\u5b9a\u8981\u8986\u76d6\u5230 $x$\u3002\u662f\u5426\u88ab\u76d1\u542c\u4f9d\u65e7\u65e0\u6240\u8c13\uff08\u540c\u4e0a\uff09\u3002\n\n\u5373 $f[x][i+j][1][1]=f[x][i][1][1]\\times(f[t][j][0][0]+f[t][j][0][1]+f[t][j][1][0]+f[t][j][1][1])+f[x][i][1][0]\\times(f[t][j][1][0]+f[t][j][1][1])$\u3002\n\n\u6ce8\u610f\u51e0\u70b9\uff1a\n\n1. \u4e0d\u7528\u6eda\u52a8\u6570\u7ec4\uff0c\u7528\u4e00\u4e2a $tmp$ \u6570\u7ec4\u5b58\u50a8\u4e4b\u524d\u7684\u72b6\u6001\u5373\u53ef\u3002\n2. \u5f00 long long \u4f1a\u7206\u4e24\u4e2a\u70b9\u2026\u2026\u6240\u4ee5\u9700\u8981\u7528 int \u5b58\u50a8\uff0c\u4e2d\u9014\u8f6c long long\u3002\n3. \u53d6\u6a21\u540e\uff0c\u4efb\u4f55\u4e58\u6cd5\u90fd\u4f1a\u7206 int\uff0c\u4e14\u8fde\u52a0\u4e09\u6b21\u53ca\u4ee5\u4e0a\u4e5f\u4f1a\u7206 int\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N = 1e5 + 5;\nconst int mod = 1e9 + 7;\nint n, m, head[N], to[N << 1], nxt[N << 1], etot;\nint f[N][105][2][2], tmp[105][2][2];\nint sz[N];\ninline void link(int u, int v)\n{\n    to[etot] = v;\n    nxt[etot] = head[u];\n    head[u] = etot++;\n}\ninline void dfs(int x, int fa)\n{\n    f[x][0][0][0] = f[x][1][1][0] = 1;\n    sz[x] = 1;\n    for (int i = head[x]; ~i; i = nxt[i])\n        if (to[i] != fa)\n        {\n            dfs(to[i], x);\n            memcpy(tmp, f[x], sizeof(f[x]));\n            memset(f[x], 0, sizeof(f[x]));\n            for (int j = 0; j <= min(m, sz[x]); j++)\n                for (int k = 0; k <= min(m - j, sz[to[i]]); k++)\n                {\n                    (f[x][j + k][0][0] += 1ll * tmp[j][0][0] * f[to[i]][k][0][1] % mod) %= mod;\n                    (f[x][j + k][0][1] += (tmp[j][0][1] * (1ll * f[to[i]][k][1][1] + f[to[i]][k][0][1]) % mod +\n                                           1ll * tmp[j][0][0] * f[to[i]][k][1][1] % mod) %\n                                          mod) %= mod;\n                    (f[x][j + k][1][0] += tmp[j][1][0] * (1ll * f[to[i]][k][0][0] + f[to[i]][k][0][1]) % mod) %= mod;\n                    (f[x][j + k][1][1] += (tmp[j][1][0] * (1ll * f[to[i]][k][1][0] + f[to[i]][k][1][1]) % mod +\n                                           tmp[j][1][1] * (1ll * f[to[i]][k][0][0] + f[to[i]][k][0][1] + f[to[i]][k][1][0] + f[to[i]][k][1][1]) % mod) %\n                                          mod) %= mod;\n                }\n            sz[x] += sz[to[i]];\n        }\n}\nint main()\n{\n    ios::sync_with_stdio(false);\n    cin.tie(nullptr);\n    memset(head, -1, sizeof(head));\n    cin >> n >> m;\n    for (int i = 1, u, v; i < n; i++)\n    {\n        cin >> u >> v;\n        link(u, v);\n        link(v, u);\n    }\n    dfs(1, 0);\n    cout << (f[1][m][0][1] + f[1][m][1][1]) % mod;\n    return 0;\n}\n```",
        "postTime": 1670655313,
        "uid": 576378,
        "name": "creation_hy",
        "ccfLevel": 5,
        "title": "P4516\u9898\u89e3"
    },
    {
        "content": "# \u3010\u9898\u89e3\u3011P4516 [JSOI2018] \u6f5c\u5165\u884c\u52a8\n\n[\u535a\u5ba2\u56ed\u98df\u7528\u6548\u679c\u66f4\u4f73](https://www.cnblogs.com/xrkforces/p/luogu-P4516.html)\n\n\u6bd4\u8f83\u5e38\u89c4\u4f46\u662f\u6709\u70b9\u601d\u7ef4\u542b\u91cf\u7684\u4e00\u9053\u6811\u5f62 DP\u3002\n\n---\n\n## \u9898\u76ee\u94fe\u63a5\n\n[P4516 [JSOI2018] \u6f5c\u5165\u884c\u52a8](https://www.luogu.com.cn/problem/P4516)\n\n## \u9898\u610f\u6982\u8ff0\n\n\u7ed9\u5b9a\u4e00\u68f5\u6709 $n$ \u4e2a\u70b9\u7684\u6811\uff0c\u73b0\u5728\u8981\u5728\u4e00\u4e9b\u70b9\u4e0a\u5b89\u88c5\u6700\u591a $k$ \u4e2a\u76d1\u542c\u8bbe\u5907\uff0c\u6bcf\u4e2a\u76d1\u542c\u8bbe\u5907\u53ef\u4ee5\u76d1\u542c\u5230\u4e0e\u8fd9\u4e2a\u70b9\u76f4\u63a5\u8fde\u8fb9\u7684\u6240\u6709\u70b9\uff0c**\u4f46\u4e0d\u53ef\u4ee5\u76d1\u542c\u5230\u5b83\u672c\u8eab**\uff0c\u73b0\u5728\u8981\u6c42\u6bcf\u4e2a\u70b9\u90fd\u88ab\u76d1\u542c\u5230\uff0c\u4e14\u6bcf\u4e2a\u70b9\u6700\u591a\u53ea\u80fd\u6709\u4e00\u4e2a\u76d1\u542c\u8bbe\u5907\uff0c\u6c42\u6709\u591a\u5c11\u79cd\u5408\u6cd5\u7684\u65b9\u6848\uff0c\u7b54\u6848\u5bf9 $1e9+7$ \u53d6\u6a21\u3002\n\n## \u9898\u76ee\u5206\u6790\n\n\u9996\u5148\u6bd4\u8f83\u663e\u7136\u7684\u662f\u4e2a\u6811\u4e0a\u80cc\u5305\u3002\n\n\u90a3\u4e48\u6309\u7167\u6811\u4e0a\u80cc\u5305\u7684\u5957\u8def\uff0c\u6211\u4eec\u5b9a\u4e49 $dp_{x,i}$ \u8868\u793a\u7684\u662f\u4ee5 $x$ \u4e3a\u6839\u7684\u5b50\u6811\uff0c\u5b89\u88c5\u4e86 $i$ \u4e2a\u76d1\u542c\u8bbe\u5907\u6709\u591a\u5c11\u79cd\u5408\u6cd5\u7684\u65b9\u6848\u3002\n\n\u4f46\u662f\u53d1\u73b0\u76f4\u63a5\u8fd9\u6837\u5b9a\u4e49\u5e76\u4e0d\u597d\u8f6c\u79fb\uff0c\u5fc5\u987b\u8981\u8003\u8651 $x$ \u672c\u8eab\u662f\u5426\u653e\u4e86\u76d1\u542c\u8bbe\u5907\u4ee5\u53ca\u6709\u6ca1\u6709\u88ab\u76d1\u542c\u3002\n\n\u6240\u4ee5\u6211\u4eec\u66f4\u6539\u4e00\u4e0b $dp$ \u72b6\u6001\uff1a\u5b9a\u4e49 $dp_{x,i,0/1,0/1}$ \u8868\u793a\u7684\u662f\u4ee5 $x$ \u4e3a\u6839\u7684\u5b50\u6811\uff0c\u5b89\u88c5\u4e86 $i$ \u4e2a\u76d1\u542c\u8bbe\u5907\uff0c$x$ \u662f\u5426\u5b89\u88c5\u4e86\u76d1\u542c\u8bbe\u5907\uff0c$x$ \u662f\u5426\u88ab\u76d1\u542c\u7684\u65b9\u6848\u6570\u3002\n\n\u90a3\u4e48\u6700\u540e\u7684\u7b54\u6848\u5c31\u662f $dp_{1,k,0,1}+dp_{1,k,1,1}$\u3002\n\n\u6811\u4e0a\u80cc\u5305\u7684\u8f6c\u79fb\u5957\u8def\u662f\u8003\u8651\u5408\u5e76\u5b50\u6811\uff0c\u5373\u8003\u8651 $dp_{x,i+j}$ \u600e\u4e48\u6837\u7531 $dp_{x,i}$ \u548c $dp_{y,j}$ \u8f6c\u79fb\u800c\u6765\uff0c\u5176\u4e2d $y$ \u662f $x$ \u7684\u513f\u5b50\u3002\n\n\u5bf9\u4e8e\u8fd9\u6837\u6bd4\u8f83\u590d\u6742\u7684\u72b6\u6001\uff0c\u6211\u4eec\u5206\u522b\u8003\u8651\u4ee5 $x$ \u4e3a\u6839\u7684\u6bcf\u4e2a\u72b6\u6001\u5e94\u8be5\u600e\u4e48\u8f6c\u79fb\u3002\n\n- \u5bf9\u4e8e $dp_{x,i+j,0,0}$\uff1a\n\n\t$x$ \u6ca1\u6709\u88ab\u76d1\u542c\uff0c\u8bf4\u660e $y$ \u4e00\u5b9a\u6ca1\u6709\u5b89\u88c5\u76d1\u542c\u8bbe\u5907\uff1b$x$ \u6ca1\u6709\u5b89\u88c5\u8bbe\u5907\uff0c\u8bf4\u660e $y$ \u4e00\u5b9a\u9700\u8981\u88ab\u9664 $x$ \u4e4b\u5916\u7684\u5176\u5b83\u70b9\u76d1\u542c\u3002\n\n\t\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\t$$\n\t dp_{x,i+j,0,0}=\\sum dp_{x,i,0,0}\\times dp_{y,j,0,1}\n\t$$\n\n- \u5bf9\u4e8e $dp_{x,i+j,0,1}$\uff1a\n\n\t$x$ \u6ca1\u6709\u5b89\u88c5\u8bbe\u5907\uff0c\u8bf4\u660e $y$ \u4e00\u5b9a\u88ab\u5176\u5b83\u70b9\u76d1\u542c\uff1b$x$ \u88ab\u76d1\u542c\u4e86\uff0c\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\n\n\t1. $x$ \u5728\u8003\u8651 $y$ \u4e4b\u524d\u5c31\u5df2\u7ecf\u88ab\u5176\u5b83\u513f\u5b50\u76d1\u542c\uff0c\u6b64\u65f6 $y$ \u4e4b\u524d\u5b89\u88c5\u4e0d\u5b89\u88c5\u8bbe\u5907\u65e0\u6240\u8c13\uff1b\n\t2. $x$ \u5728\u8003\u8651 $y$ \u4e4b\u524d\u8fd8\u672a\u88ab\u5176\u5b83\u513f\u5b50\u76d1\u542c\uff0c\u6240\u4ee5\u5b83\u53ea\u80fd\u88ab $y$ \u76d1\u542c\uff0c\u5373 $y$ \u5fc5\u987b\u5b89\u88c5\u8bbe\u5907\u3002\n\n\t\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\t$$\n\t dp_{x,i+j,0,1}=\\sum dp_{x,i,0,1} \\times (dp_{y,i,0,1}+dp_{y,j,1,1})+dp_{x,i,0,0}\\times dp_{y,j,1,1}\n\t$$\n\n- \u5bf9\u4e8e $dp_{x,i+j,1,0}$\uff1a\n\n\t$x$ \u5b89\u88c5\u8bbe\u5907\u4e86\uff0c\u90a3\u4e48 $y$ \u4e4b\u524d\u662f\u5426\u88ab\u76d1\u542c\u65e0\u6240\u8c13\uff0c\u56e0\u4e3a\u53cd\u6b63\u5b83\u81f3\u5c11\u4f1a\u88ab $x$ \u76d1\u542c\uff1b$x$ \u6ca1\u6709\u88ab\u76d1\u542c\uff0c\u90a3\u4e48 $y$ \u4e00\u5b9a\u4e0d\u80fd\u5b89\u88c5\u8bbe\u5907\u3002\n\n\t\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\t$$\n\t dp_{x,i+j,1,0}=\\sum dp_{x,i,1,0} \\times (dp_{y,j,0,1}+dp_{y,j,0,0})\n\t$$\n\n- \u5bf9\u4e8e $dp_{x,i+j,1,1}$\uff1a\n\n\t$x$ \u5b89\u88c5\u8bbe\u5907\u4e86\uff0c\u90a3\u4e48 $y$ \u4e4b\u524d\u662f\u5426\u88ab\u76d1\u542c\u65e0\u6240\u8c13\uff0c\u56e0\u4e3a\u53cd\u6b63\u5b83\u81f3\u5c11\u4f1a\u88ab $x$ \u76d1\u542c\uff1b$x$ \u88ab\u76d1\u542c\u4e86\uff0c\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\n\n\t1. $x$ \u5728\u8003\u8651 $y$ \u4e4b\u524d\u5c31\u5df2\u7ecf\u88ab\u5176\u5b83\u513f\u5b50\u76d1\u542c\uff0c\u6b64\u65f6 $y$ \u4e4b\u524d\u5b89\u88c5\u4e0d\u5b89\u88c5\u8bbe\u5907\u65e0\u6240\u8c13\uff1b\n\t2. $x$ \u5728\u8003\u8651 $y$ \u4e4b\u524d\u8fd8\u672a\u88ab\u5176\u5b83\u513f\u5b50\u76d1\u542c\uff0c\u6240\u4ee5\u5979\u53ea\u80fd\u88ab $y$ \u76d1\u542c\uff0c\u5373 $y$ \u5fc5\u987b\u5b89\u88c5\u8bbe\u5907\u3002\n\n\t\u8003\u8651 $x$ \u5728 $y$ \u4e4b\u524d\u662f\u5426\u88ab\u76d1\u542c\u65f6\uff0c\u540c\u65f6\u8003\u8651 $y$ \u4e4b\u524d\u662f\u5426\u88ab\u76d1\u542c\uff0c\u603b\u8f6c\u79fb\u65b9\u7a0b\u5982\u4e0b\uff1a\n\t$$\n\t dp_{x,i+j,1,1}=\\sum dp_{x,i,1,1}\\times (dp_{y,i,1,1}+dp_{y,i,1,0}+dp_{y,i,0,1}+dp_{y,i,1,1}) \n   +dp_{x,i,1,0}\\times(dp_{y,i,1,1}+dp_{y,i,1,0})\n\t$$\n\n\u8fd9\u5c31\u662f\u5168\u90e8\u7684\u8f6c\u79fb\u3002\n\n## \u6613\u9519\u70b9\n\n- \u5f00 long long \u4f1a MLE\uff0c\u8bf7\u4f7f\u7528 unsigned int\uff1b\n- \u8be5\u53d6\u6a21\u7684\u5730\u65b9\u8981\u53d6\u6a21\uff1b\n- \u6811\u4e0a\u80cc\u5305\u6bcf\u6b21\u8f6c\u79fb\u524d\uff0c\u5148\u5c06 $dp_{x,i,0/1,0/1}$ \u4e0b\u7684\u6bcf\u4e00\u4e2a\u72b6\u6001\u90fd\u5b58\u4e00\u4e2a\u4e34\u65f6\u6570\u7ec4\u4e0b\u9762\u53ea\u7528\u4e34\u65f6\u6570\u7ec4\u8f6c\u79fb\uff0c\u5e76\u5c06\u6240\u6709\u539f $dp_{x,i,0/1,0/1} $ \u5f52\u96f6\uff0c\u9632\u6b62\u4e4b\u540e\u7684\u8f6c\u79fb\u51fa\u73b0\u9519\u4e71\u3002\n\n## \u4ee3\u7801\u5b9e\u73b0\n\n```cpp\n//luoguP4516\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#define int unsigned int\nusing namespace std;\nconst int maxn=1e5+10;\nconst int maxk=105;\nconst int mod=1e9+7;\nint dp[maxn][maxk][2][2],tp[maxk][2][2];\nint sz[maxn];\nint n,k;\n\nbasic_string<int>edge[maxn];\n\ninline int read()\n{\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=x*10+ch-48;ch=getchar();}\n\treturn x*f;\n}\n\nvoid dfs(int x,int fa)\n{\n\tsz[x]=dp[x][0][0][0]=dp[x][1][1][0]=1;\n\tfor(int y:edge[x])\n\t{\n\t\tif(y==fa)continue;\n\t\tdfs(y,x);\n\t\tfor(int i=0;i<=min(sz[x],k);i++)\n\t\t{\n\t\t\ttp[i][0][0]=dp[x][i][0][0];\n\t\t\ttp[i][0][1]=dp[x][i][0][1];\n\t\t\ttp[i][1][0]=dp[x][i][1][0];\n\t\t\ttp[i][1][1]=dp[x][i][1][1];\n\t\t\tdp[x][i][0][0]=0;\n\t\t\tdp[x][i][0][1]=0;\n\t\t\tdp[x][i][1][0]=0;\n\t\t\tdp[x][i][1][1]=0;\n\t\t}\n\t\tfor(int i=0;i<=min(sz[x],k);i++)\n\t\t{\n\t\t\tfor(int j=0;j<=min(sz[y],k-i);j++)\n\t\t\t{\n\t\t\t\t(dp[x][i+j][0][0]+=1ll*tp[i][0][0]*dp[y][j][0][1]%mod)%=mod;\n\t\t\t\t(dp[x][i+j][0][1]+=1ll*tp[i][0][0]*dp[y][j][1][1]%mod+1ll*tp[i][0][1]*(dp[y][j][0][1]+dp[y][j][1][1])%mod)%=mod;\n\t\t\t\t(dp[x][i+j][1][0]+=1ll*tp[i][1][0]*(dp[y][j][0][0]+dp[y][j][0][1])%mod)%=mod;\n\t\t\t\t(dp[x][i+j][1][1]+=1ll*tp[i][1][0]*(dp[y][j][1][0]+dp[y][j][1][1])%mod+1ll*tp[i][1][1]*(dp[y][j][0][0]+dp[y][j][0][1]+dp[y][j][1][0]+dp[y][j][1][1])%mod)%=mod;\n\t\t\t}\n\t\t}\n\t\tsz[x]+=sz[y];\n\t}\n}\n\nsigned main()\n{\n\tn=read();k=read();\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tint u,v;\n\t\tu=read();v=read();\n\t\tedge[u]+=v;\n\t\tedge[v]+=u;\n\t}\n\tdfs(1,0);\n\tcout<<1ll*(dp[1][k][0][1]+dp[1][k][1][1])%mod<<\"\\n\";\n\treturn 0;\n}\n```\n\n",
        "postTime": 1667814364,
        "uid": 341245,
        "name": "xrk2006",
        "ccfLevel": 4,
        "title": "\u3010\u9898\u89e3\u3011P4516 [JSOI2018] \u6f5c\u5165\u884c\u52a8"
    },
    {
        "content": "[\u540c\u6b65\u53d1\u8868\u4e8e\u6211\u7684 $\\text{cnblogs}$](https://www.cnblogs.com/UperFicial/p/16657044.html)\u3002\n\n[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4516)\u3002\n\n\u8003\u8651\u8fd9\u4e2a\u6811\u5f62 DP \u72b6\u6001\u7684\u8bbe\u8ba1\uff0c\u9898\u76ee\u6d89\u53ca\u7684\u6240\u6709\u91cf\u90fd\u653e\u8fdb\u72b6\u6001\u4e2d\u3002\n\n\u8bbe $f_{i,j,0/1,0/1}$ \u8868\u793a\uff0c\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\uff0c\u9664 $i$ \u8282\u70b9\u90fd\u88ab\u76d1\u542c\u4e86\uff0c\u4e00\u5171\u653e\u7f6e\u4e86 $j$ \u4e2a\u76d1\u542c\u8bbe\u5907\uff0c$i$ \u70b9\u662f\u5426\u653e\u7f6e\u4e86\u76d1\u542c\u8bbe\u5907\uff0c$i$ \u662f\u5426\u88ab\u76d1\u542c\uff08`0` \u8868\u793a\u6ca1\u6709\uff0c`1` \u8868\u793a\u6709\uff09\u7684\u65b9\u6848\u6570\u3002\n\n\u8003\u8651\u8f6c\u79fb\uff0c\u8bbe $v$ \u7684\u7236\u8282\u70b9\u4e3a $u$\uff1a\n\n- $f_{u,i+j,0,0}$ \u7684\u8f6c\u79fb\uff1a\n- \n  - $u$ \u6ca1\u6709\u88ab\u76d1\u542c\uff0c\u8bf4\u660e $u$ \u7684\u513f\u5b50\u90fd\u6ca1\u6709\u653e\u7f6e\u76d1\u542c\u8bbe\u5907\u3002\n   \n  - \u7528\u6811\u5f62\u80cc\u5305\u6765\u8f6c\u79fb\uff0c\u5373\u6bcf\u8bbf\u95ee\u5b8c\u4e00\u4e2a\u8282\u70b9\uff0c\u5c31\u7528\u5f53\u524d\u72b6\u6001\u4e0e\u5f53\u524d\u5b50\u6811\u4e00\u4e00\u914d\u5bf9\u3002\n   \n  - \u679a\u4e3e $v$ \u7528\u7684\u76d1\u542c\u5668\u6570\u91cf $j$\uff0c\u5219 $f_{i,i+j,0,0}\\leftarrow f_{u,i+j,0,0}+f_{u,i,0,0}\\times f_{v,j,0,1}$\u3002\n   \n  - \u6ce8\u610f\uff0c\u8fd9\u91cc\u7684 $f_{u,i,0,0}$ \u8868\u793a\u7684\u662f\uff0c$v$ \u5b50\u6811\u4e4b\u524d\u7684\u90a3\u4e9b\u5b50\u6811\u5bf9 $u$ \u9020\u6210\u7684\u8d21\u732e\uff0c\u5b9e\u9645\u64cd\u4f5c\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u53e6\u7528\u4e00\u4e2a\u6570\u7ec4\u8868\u793a\u3002\n   \n- $f_{u,i+j,0,1}$ \u7684\u8f6c\u79fb\uff1a\n \n  - $u$ \u6ca1\u653e\u7f6e\u8bbe\u5907\uff0c\u4f46\u662f\u88ab\u76d1\u542c\u4e86\u3002\u6211\u4eec\u4e0d\u77e5\u9053\u5b83\u88ab\u7236\u4eb2\u76d1\u542c\uff0c\u8fd8\u662f\u88ab\u5b69\u5b50\u76d1\u542c\uff0c\u6240\u4ee5\u5206\u4e24\u79cd\u60c5\u51b5\u8ba8\u8bba\u3002\n  \n    - \u5982\u679c $u$ \u88ab\u9664 $v$ \u4ee5\u5916\u7684\u8282\u70b9\u76d1\u542c\uff0c$v$ \u653e\u4e0d\u653e\u7f6e\u76d1\u542c\u5668\u5c31\u4e0d\u91cd\u8981\u4e86\u3002\u6240\u4ee5\u6211\u4eec\u5f97\u5230 $f_{u,i+j,0,1}\\leftarrow f_{u,i+j,0,1}+f_{u,i,0,1}\\times \\left(f_{v,j,0,1}+f_{v,j,1,1}\\right)$\u3002\n     \n    - \u5982\u679c $u$ \u53ea\u88ab $v$ \u76d1\u542c\uff0c\u90a3\u4e48 $v$ \u53ea\u80fd\u653e\u7f6e\u76d1\u542c\u5668\uff0c$f_{u,i+j,0,1}\\leftarrow f_{u,i+j,0,1}+f_{u,i,0,0}\\times f_{v,j,1,1}$\u3002\u6ce8\u610f\uff0c\u662f\u4ece $f_{u,i,0,0}$ \u8f6c\u79fb\u800c\u6765\uff0c\u56e0\u4e3a\u6211\u4eec\u521a\u521a\u63d0\u5230\u8fc7\uff0c$u$ \u5355\u72ec\u88ab $v$ \u76d1\u542c\uff0c\u82e5\u8fd8\u6709\u5176\u4f59\u7684\uff0c\u4f1a\u4e0e\u7b2c\u4e00\u79cd\u60c5\u51b5\u7b97\u91cd\u3002\n     \n- $f_{u,i+j,1,0}$ \u7684\u8f6c\u79fb\uff1a\n \n    - $u$ \u653e\u7f6e\u4e86\u76d1\u542c\u5668\uff0c\u4f46\u662f\u6ca1\u6709\u88ab\u76d1\u542c\u3002\u8fd9\u4e2a\u6761\u4ef6\u4e5f\u662f\u5341\u5206\u597d\u505a\u7684\uff1b\n     \n    - $u$ \u6ca1\u6709\u88ab\u76d1\u542c\uff0c\u8bf4\u660e $v$ \u6ca1\u6709\u653e\u7f6e\u76d1\u542c\u8bbe\u5907\u3002\n\n    - $u$ \u653e\u7f6e\u4e86\u76d1\u542c\u5668\uff0c\u8bf4\u660e\u5728 $v$ \u8fd9\u4e2a\u5b50\u6811\u4e2d\uff0c$v$ \u662f\u5426\u88ab\u76d1\u542c\u5230\u662f\u65e0\u6240\u8c13\u7684\uff0c\u56e0\u4e3a\u603b\u4f1a\u6709 $u$ \u76d1\u542c $v$\u3002\n     \n    - \u8f6c\u79fb\u5f88\u660e\u4e86\uff1a$f_{u,i+j,1,0}\\leftarrow f_{u,i+j,1,0}+f_{u,i,1,0}\\times \\left(f_{v,j,0,0}+f_{v,j,0,1}\\right)$\u3002\n\n- $f_{u,i+j,1,1}$ \u7684\u8f6c\u79fb\uff1a\n\n    - $u$ \u88ab\u76d1\u542c\uff0c\u6839\u7b2c\u4e8c\u79cd\u60c5\u51b5\u4e00\u6837\uff0c\u6211\u4eec\u5206\u4e24\u79cd\u60c5\u51b5\u8ba8\u8bba\uff0c\u662f\u88ab\u513f\u5b50\u76d1\u542c\uff0c\u8fd8\u662f\u88ab\u7236\u4eb2\u76d1\u542c\u3002\n\n      - \u5982\u679c $u$ \u662f\u88ab $v$ \u76d1\u542c\uff0c$v$ \u662f\u5426\u88ab\u76d1\u542c\u662f\u65e0\u6240\u8c13\u7684\uff0c\u56e0\u4e3a $u$ \u70b9\u653e\u7f6e\u4e86\u76d1\u542c\u5668\uff0c\u540c\u65f6 $v$ \u5fc5\u987b\u653e\u7f6e\u76d1\u542c\u5668\u3002$f_{u,i+j,1,1}\\leftarrow f_{u,i+j,1,1}+f_{u,i,1,0}\\times \\left(f_{v,j,1,0}+f_{v,j,1,1}\\right)$\u3002\n      \n      - \u5982\u679c $u$ \u662f\u88ab\u7236\u4eb2\u76d1\u542c\uff0c\u90a3\u4e48 $v$ \u662f\u5426\u88ab\u76d1\u542c\u662f\u65e0\u6240\u8c13\u7684\uff0c\u662f\u5426\u653e\u7f6e\u76d1\u542c\u5668\u4e5f\u662f\u65e0\u6240\u8c13\u7684\uff0c\u5f00\u6446\u5373\u53ef\u3002$f_{u,i+j,1,1}\\leftarrow f_{u,i+j,1,1}+f_{u,i,1,1}\\times f_{v,j,0/1,0/1}$\u3002\n\n\u7ec6\u8282\u4e3b\u8981\u5c31\u662f\u7528\u4e00\u4e2a\u6570\u7ec4\u4fdd\u5b58\u9664\u4e86 $v$ \u5b50\u6811\u7684\u524d\u9762\u7684\u5b50\u6811\u7684 DP \u503c\u3002\n\n\u8003\u8651\u5b83\u7684\u590d\u6742\u5ea6\uff0c\u6027\u611f\u8bc1\u660e\u5373\u4e3a\u8003\u8651 $\\text{siz}>k$ \u7684\u70b9\u4e0d\u4f1a\u8d85\u8fc7 $\\dfrac{n}{k}$ \u4e2a\uff0c\u603b\u590d\u6742\u5ea6\u7ea6\u4e3a $\\Theta(nk)$\u3002\n\n[\u4ee3\u7801](https://www.luogu.com.cn/paste/r2du3bte)\u3002",
        "postTime": 1662342694,
        "uid": 360511,
        "name": "UperFicial",
        "ccfLevel": 0,
        "title": "\u9898\u89e3\u3010P4516 [JSOI2018] \u6f5c\u5165\u884c\u52a8\u3011"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/Coros-Trusds/p/16138220.html)\n\n\u6bd2\u7624\u6811\u5f62 $dp$ \u554a\u3002\u3002\n\n# \u9898\u76ee\u5927\u610f\n\n\u7ed9\u5b9a\u4e00\u68f5\u6811\uff0c\u5982\u679c\u5728\u4e00\u4e2a\u8282\u70b9 $u$ \u653e\u4e00\u4e2a\u76d1\u542c\u8bbe\u5907\uff0c\u90a3\u4e48\u4e0e $u$ \u76f8\u90bb\u7684\u8282\u70b9 $v$ \u90fd\u80fd\u88ab\u76d1\u542c\uff0c\u4f46\u662f $u$ \u4e0d\u4f1a\u88ab\u76d1\u542c\u3002\u73b0\u5728\u6709 $m$ \u4e2a\u76d1\u542c\u8bbe\u5907\uff0c\u95ee\u80fd\u591f\u76d1\u542c\u6574\u68f5\u6811\u4e14\u6070\u597d\u4f7f\u7528\u4e86 $m$ \u4e2a\u76d1\u542c\u8bbe\u5907\u7684\u65b9\u6848\u6570\u3002\n\n\u4e00\u4e2a\u8282\u70b9\u81f3\u591a\u653e\u4e00\u4e2a\u76d1\u542c\u8bbe\u5907\u3002\n\n# \u9898\u76ee\u5206\u6790\n\n\u501f\u7528\u5927\u4f6c @GKxx \u7684\u56fe\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/41854.png)\n\n$$\\tiny{\\texttt{\u56fe 1,\u4e0a\u56fe x \u5373 i}}$$\n\n\u4ee4 $dp[i,j,0/1,0/1]$ \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u4e00\u5171\u653e\u4e86 $j$ \u88c5\u7f6e\uff0c$i$ \u70b9\u662f\u5426\u653e\u4e86\u88c5\u7f6e\uff0c$i$ \u70b9\u6709\u6ca1\u6709\u88ab\u8986\u76d6\u5230\u7684\u65b9\u6848\u6570\u3002\n\n\u6765\u63a8\u4e00\u63a8\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n+ \u5f53 $i$ \u6ca1\u88ab\u76d1\u542c\u4e14\u6ca1\u653e\u76d1\u542c\u88c5\u7f6e\u65f6\uff0c$v(v\\in son\\{i\\})$ \u4e00\u5b9a\u6ca1\u6709\u88c5\u76d1\u542c\u8bbe\u5907\uff0c\u6709 $dp[i,j+k,0,0]=\\sum (dp[i,j,0,0]\\times dp[v,k,0,1])$\u3002\n\n+ \u5f53 $i$ \u6ca1\u88ab\u76d1\u542c\u4f46\u653e\u4e86\u76d1\u542c\u88c5\u7f6e\u65f6\uff0c$v$\uff08$v$ \u7684\u5b9a\u4e49\u5982\u4e0a\uff09\u662f\u5426\u88ab\u76d1\u542c\u4e0d\u91cd\u8981\u4f46\u662f\u4e00\u5b9a\u6ca1\u6709\u653e\u88c5\u7f6e\uff0c\u5426\u5219\u8fd9\u91cc\u5c31\u53ef\u4ee5\u88ab\u76d1\u542c\u4e86\uff0c\u6709 $dp[i,j+k,1,0]=\\sum(dp[i,j,1,0]\\times(dp[v,k,0,0]+dp[v,k,0,1]))$\u3002\n\n+ \u5f53 $i$ \u6ca1\u653e\u88c5\u7f6e\u4f46\u88ab\u76d1\u542c\u4e86\u65f6\uff0c\u5206\u4e24\u79cd\u60c5\u51b5\uff1a\n\n$i$ \u4fa7\u7684\u72b6\u6001\u4e3a $dp[i,j,0,1]$\uff1a$dp[i,j+k,0,1]=\\sum(dp[i,j,0,1]\\times(dp[v,k,0,1]+dp[v,k,1,1]))$\u3002\n\n$i$ \u4fa7\u7684\u72b6\u6001\u4e3a $dp[i,j,0,0]$\uff1a$dp[i,j+k,0,1]=\\sum(dp[i,j,0,0]\\times dp[v,k,1,1])$\u3002\u6ce8\u610f\u8fd9\u91cc\u6ca1\u6709 $dp[v,k,1,0]$\uff0c\u56e0\u4e3a\u4e00\u5b9a\u8981\u8ba9 $v$ \u88ab\u8986\u76d6\uff0c\u4f46\u662f $i$ \u6ca1\u653e\u88c5\u7f6e\u3002\n\n+ \u5f53 $i$ \u6ca1\u653e\u653e\u4e86\u88c5\u7f6e\u4e5f\u88ab\u7a83\u542c\u4e86\u65f6\uff1a\n\n$i$ \u4fa7\u662f\u72b6\u6001 $dp[i,j,1,0]$\uff1a$dp[i,j+k,1,1]=\\sum(dp[i,j,1,0]\\times(dp[v,k,1,0]+dp[v,k,1,1]))$\u3002\n\n$i$ \u4fa7\u662f\u72b6\u6001 $dp[i,j,1,1]$\uff1a$dp[i,j+k,1,1]=\\sum(dp[i,j,1,1]\\times(dp[v,k,0,0]+dp[v,k,0,1]+dp[v,k,1,0]+dp[v,k,1,1]))$\u3002\n\n# \u4ee3\u7801\n\n\u4ee3\u7801\u592a\u96be\u8c03\u4e86\uff0c\u8c03\u4ee3\u7801\u65f6\u95f4\u6bd4\u601d\u8003\u65f6\u95f4\u8fd8\u957f\u3002\u3002\n\n\u6765\u5f20\u56fe\u4e86\u89e3\u4e0b\uff1a\n\n![\u5c4f\u5e55\u622a\u56fe 2022-04-12 231645.png](https://s2.loli.net/2022/04/12/sZyDM9kmXc3eHF2.png)\n\n**\u4e0a\u9762\u8fd9\u5f20\u56fe\u7684\u5199\u6cd5\u592a\u96be\u8c03\u4e86\uff0c\u6240\u4ee5\u6362\u4e86\u4e00\u79cd\u5199\u6cd5\u8fc7\u4e86\u3002**\n\n\u6ce8\u610f\u5168\u5f00 `long long` \u4f1a $\\verb!MLE!$\uff0c\u53ea\u80fd\u5728\u8fc7\u7a0b\u4e2d\u7528 `long long`\u3002\n\n\u6d1b\u8c37\u7684\u8822\u5173\u952e\u5b57\u5236\u5ea6\u4f7f\u5f97\u4ee3\u7801\u4f20\u4e0d\u4e0a\u6765\uff0c\u8bf7\u5230\u9876\u4e0a\u94fe\u63a5\u5185\u67e5\u770b~",
        "postTime": 1649773323,
        "uid": 430409,
        "name": "Coros_Trusds",
        "ccfLevel": 6,
        "title": "P4516 [JSOI2018] \u6f5c\u5165\u884c\u52a8"
    },
    {
        "content": "\u5ba3\u4f20\u535a\u5ba2->[link](https://blog.csdn.net/BWzhuzehao/article/details/114187950)\n\n**\u7279\u522b\u63d0\u9192\uff1a\u672c\u9898\u5361\u7a7a\u95f4\u3002\u5982\u679c\u60a8\u7684\u4ee3\u7801 `MLE` \u4e86\u800c\u4e14\u601d\u8def\u6ca1\u6709\u95ee\u9898\uff0c\u8bf7\u76f4\u63a5\u524d\u5f80\u300e\u5173\u4e8e\u5361\u7a7a\u95f4\u300f\u8fd9\u4e00\u90e8\u5206\u3002**\n\nP.S. `WA+MLE` \u4e0d\u8ba1\u5165\u4e0a\u8ff0\u8303\u56f4\u5185\u3002\n\n\u8bf4\u53e5\u95f2\u8bdd\uff1a\u4e3a\u4ec0\u4e48 csdn \u4e0b\u6e32\u67d3\u6b63\u5e38\u7684 Latex \u516c\u5f0f\u5230\u4f60\u53e4\u5c31\u51fa\u95ee\u9898\u4e86\u5440\u2026\u2026\n\n# \u601d\u8def\u8bb2\u89e3\uff1a\n\n\u672c\u9898\u662f\u4e00\u9053\u6811\u4e0a\u7edf\u8ba1\u7c7b DP\u3002\n\n\u524d\u7f6e\u77e5\u8bc6\uff1a\u6811\u5f62 DP\u3002\n\n\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u9996\u5148\u8bbe\u4e0b\u4e24\u7ef4\u72b6\u6001 $f[u][i]$\uff0c$u$ \u4e3a\u8282\u70b9\u7f16\u53f7\uff0c$i$ \u8868\u793a\u7528\u4e86\u51e0\u4e2a\u76d1\u542c\u8bbe\u5907\u3002\n\n\u4f46\u662f\u72b6\u6001\u4e0d\u591f\u554a\uff0c\u6211\u4eec\u4e0d\u77e5\u9053\u662f\u5426\u88ab\u76d1\u542c\uff0c\u513f\u5b50\u8282\u70b9\u662f\u5426\u88ab\u76d1\u542c\u7b49\u7b49\u3002\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u65b0\u589e\u4e24\u7ef4 $0/1$ \u72b6\u6001\u6765\u8868\u793a\u3002\n\n\u90a3\u4e48\u8fd9\u9053\u9898\u7684\u72b6\u6001\u5982\u4e0b\uff1a\n\n\u8bbe $f[u][i][0/1][0/1]$ \u8868\u793a\u5f53\u524d\u8282\u70b9\u4e3a $u$ \uff0c**\u5b50\u6811\u4e2d\u5df2\u7ecf\u904d\u5386\u7684\u6240\u6709\u8282\u70b9** \u4e0a\u653e\u7f6e $i$ \u4e2a\u76d1\u542c\u88c5\u5907\u7684\u65b9\u6848\u6570\uff0c**\u800c\u4e14\u6240\u6709\u513f\u5b50\u8282\u70b9\u5747\u88ab\u76d1\u542c**\uff0c\u5176\u4e2d\u7b2c\u4e09\u7ef4\u72b6\u6001\u8868\u793a $u$ \u8282\u70b9\u662f\u5426\u653e\u4e0b\u76d1\u542c\u8bbe\u5907\uff0c\u7b2c\u56db\u7ef4\u72b6\u6001\u8868\u793a $u$ \u8282\u70b9\u662f\u5426\u88ab **\u513f\u5b50\u8282\u70b9** \u76d1\u542c\u3002\n\n\u5206\u60c5\u51b5\u8ba8\u8bba\u3002\u4ee5\u4e0b\u5747\u8bbe 1 \u53f7\u8282\u70b9\u4e3a\u6839\u8282\u70b9\uff0c $now$ \u4e3a\u5f53\u524d\u8282\u70b9\uff0c$u$ \u4e3a\u513f\u5b50\u8282\u70b9\uff0c$i$ \u662f $now$ \u5b50\u6811\u4e2d\u5df2\u7ecf\u904d\u5386\u7684\u6240\u6709\u8282\u70b9\u4e0a\u653e\u7f6e\u7684\u76d1\u542c\u88c5\u5907\u6570\uff0c$j$ \u662f $u$ \u5b50\u6811\u4e0a\u653e\u7f6e\u7684\u76d1\u542c\u88c5\u5907\u6570\uff0c$V$ \u4e3a\u6240\u6709 $u$ \u6784\u6210\u7684\u96c6\u5408\u3002\u8fd9\u91cc\u91c7\u7528\u5237\u8868\u6cd5\u8f6c\u79fb\uff0c\u76ee\u6807\u4e3a $f[now][i+j][0/1][0/1]$\u3002\n\n1. $f[now][i+j][0][0]$\n\n\u8fd9\u4e2a\u65f6\u5019\u9700\u8981\u4fdd\u8bc1 $u$ \u88ab\u76d1\u542c\uff0c\u4f46\u662f $u$ \u4e0a\u9762\u4e0d\u80fd\u653e\u76d1\u542c\u88c5\u5907\uff0c\u6709\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$f[now][i+j][0][0]=f[now][i][0][0] \\times \\sum_{u \\in V}f[u][j][0][1]$$\n\n2. $f[now][i+j][0][1]$\n\n\u6b64\u65f6 $now$ \u88ab\u76d1\u542c\u4e86\uff0c\u4f46\u662f\u9700\u8981\u8003\u8651\u662f\u8c01\u76d1\u542c\u7684\uff1a\n\n2. 1. \u53ef\u4ee5\u662f $u$ \u6765\u76d1\u542c\uff0c\u6b64\u65f6 $now$ \u4e4b\u524d\u4e0d\u80fd\u88ab\u76d1\u542c\uff0c\u7136\u800c $u$ \u8981\u88ab\u76d1\u542c\uff0c\u4e8e\u662f\u8fd9\u4e00\u90e8\u5206\u8d21\u732e\uff1a\n\n$$f[now][i][0][0] \\times \\sum_{u \\in V}f[u][j][1][1]$$\n\n---\n\n2. 2. \u53ef\u4ee5\u662f\u522b\u7684\u8282\u70b9\u6765\u76d1\u542c\uff0c\u6b64\u65f6 $u$ \u653e\u4e0d\u653e\u65e0\u6240\u8c13\uff0c\u7136\u800c $u$ \u8981\u88ab\u76d1\u542c\uff0c\u4e8e\u662f\u8fd9\u4e00\u90e8\u5206\u8d21\u732e\uff1a\n\n$$f[now][i][0][1] \\times \\sum_{u \\in V}(f[u][j][0][1]+f[u][j][1][1])$$\n\n\u7efc\u4e0a\uff0c\u6709\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$f[now][i+j][0][1] = f[now][i][0][0] \\times \\sum_{u \\in V}f[u][j][1][1] + f[now][i][0][1] \\times \\sum_{u \\in V}(f[u][j][0][1]+f[u][j][1][1])$$\n\n3. $f[now][i+j][1][0]$\n\n\u6b64\u65f6 $u$ \u662f\u5426\u88ab\u76d1\u542c\u65e0\u6240\u8c13\uff0c\u4f46\u662f\u4e0d\u80fd\u653e\u88c5\u7f6e\uff0c\u6709\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$f[now][i+j][1][0]=f[now][i][1][0] \\times \\sum_{u \\in V}(f[u][j][0][0] + f[u][j][0][1])$$\n\n4. $f[now][i+j][1][1]$\n\n\u6b64\u65f6\u4ecd\u7136\u8981\u6839\u636e $now$ \u662f\u5426\u88ab\u76d1\u542c\u6765\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n4. 1. \u7531 $u$  \u6765\u76d1\u542c\uff0c\u4f46\u662f\u56e0\u4e3a $now$ \u653e\u4e86\u88c5\u7f6e\uff0c\u6240\u4ee5 $u$ \u662f\u5426\u88ab\u76d1\u542c\u65e0\u6240\u8c13\uff0c\u8fd9\u4e00\u90e8\u5206\u8d21\u732e\u4e3a\uff1a\n\n$$f[now][i][1][0] \\times \\sum_{u \\in V}(f[u][j][1][0] + f[u][j][1][1])$$\n\n---\n\n4. 2. \u4e0d\u7531 $u$ \u6765\u76d1\u542c\uff0c\u6b64\u65f6 $u$ \u653e\u4e0d\u653e\u65e0\u6240\u8c13\uff0c\u662f\u5426\u88ab\u76d1\u542c\u4e5f\u65e0\u6240\u8c13\uff0c\u8fd9\u4e00\u90e8\u5206\u8d21\u732e\u4e3a\uff1a\n\n$$f[now][i][1][1] \\times \\sum_{u \\in V}(f[u][j][0][0] + f[u][j][0][1] + f[u][j][1][0] + f[u][j][1][1])$$\n\n\u7efc\u4e0a\uff0c\u6709\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$f[now][i+j][1][1]=f[now][i][1][0] \\times \\sum_{u \\in V}(f[u][j][1][0] + f[u][j][1][1])+f[now][i][1][1] \\times \\sum_{u \\in V}(f[u][j][0][0] + f[u][j][0][1] + f[u][j][1][0] + f[u][j][1][1])$$\n\n~~\u5f0f\u5b50\u4e0d\u662f\u5f88\u957f\uff08\u786e\u4fe1~~\n\n\u90a3\u4e48\u7efc\u5408\u4e00\u4e0b\u4e0a\u9762\u7684\u56db\u4e2a\u65b9\u7a0b\uff1a\n\n$$f[now][i+j][0][0]=f[now][i][0][0] \\times \\sum_{u \\in V}f[u][j][0][1]$$\n\n$$f[now][i+j][0][1] = f[now][i][0][0] \\times \\sum_{u \\in V}f[u][j][1][1] + f[now][i][0][1] \\times \\sum_{u \\in V}(f[u][j][0][1]+f[u][j][1][1])$$\n\n$$f[now][i+j][1][0]=f[now][i][1][0] \\times \\sum_{u \\in V}(f[u][j][0][0] + f[u][j][0][1])$$\n\n$$f[now][i+j][1][1]=f[now][i][1][0] \\times \\sum_{u \\in V}(f[u][j][1][0] + f[u][j][1][1])+f[now][i][1][1] \\times \\sum_{u \\in V}(f[u][j][0][0] + f[u][j][0][1] + f[u][j][1][0] + f[u][j][1][1])$$\n\n\u521d\u59cb\u72b6\u6001\u4e3a\u5bf9\u4e8e\u4efb\u610f\u70b9 $now$\uff0c$f[now][0][0][0]=f[now][1][1][0]$\u3002\n\n\u6700\u540e\u7b54\u6848\u662f $f[1][k][0][1]+f[1][k][1][1]$\u3002\n\n\u6240\u6709\u8fc7\u7a0b\u6ce8\u610f\u968f\u65f6\u53d6\u6a21\u3002\n\n# \u4e00\u4e9b\u6ce8\u610f\u70b9\uff1a\n\n1. \u968f\u65f6\u53d6\u6a21\u3002\n2. \u8f6c\u79fb\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\u5bf9\u4e8e\u5f53\u524d\u8282\u70b9 $now$\uff0c\u6211\u4eec\u9700\u8981\u4e34\u65f6\u6570\u7ec4 $tmp[i][0/1][0/1]$ \u6765\u5b58\u4e0b\u5f53\u524d\u8282\u70b9\u7684\u72b6\u6001\uff0c\u9632\u6b62\u56e0\u4e3a\u4fee\u6539\u800c\u5bfc\u81f4\u7684 `WA`\u3002\u5177\u4f53\u53ef\u4ee5\u53c2\u8003\u6211\u7684\u4ee3\u7801\u3002\n3. \u8bb0\u5f97\u8bb0\u5f55\u5b50\u6811\u7684\u5927\u5c0f\uff0c\u56e0\u4e3a\u53ef\u80fd\u5b58\u5728 $size_{now}<k$ \u7684\u60c5\u51b5\uff0c\u6b64\u65f6\u6211\u4eec\u81f3\u591a\u53ea\u80fd\u653e $size_{now}$ \u4e2a\u3002\n\n# \u5173\u4e8e\u5361\u7a7a\u95f4\n\n\u8fd9\u9053\u9898\u5f88\u6bd2\u7624\uff0c\u6211\u4e00\u5f00\u59cb\u5f00 `long long` \u88ab\u5361\u7a7a\u95f4\u4e86\uff0c\u6700\u540e\u770b\u7684\u9898\u89e3\u624d\u77e5\u9053\u4e3a\u4ec0\u4e48\u4f1a `MLE`\u3002\n\n\u8fd9\u9053\u9898\u9700\u8981\u6ce8\u610f\uff1a\n\n1. \u6240\u6709\u53d8\u91cf\u5168\u90e8\u5f00 `int` \u7c7b\u578b\uff0c\u5c24\u5176\u662f `f` \u548c `tmp` \u6570\u7ec4\u3002\n2. \u8fd0\u7b97\u7684\u65f6\u5019\u9700\u8981\u5f3a\u5236\u8f6c\u6362\u7c7b\u578b\uff0c\u540c\u65f6\u53d6\u6a21\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define Min(a, b) ((a < b) ? a : b)\nusing namespace std;\n\ntypedef long long LL;\nconst int MAXN = 1e5 + 10, P = 1e9 + 7, MAXK = 100 + 10;\nint n, k, f[MAXN][MAXK][2][2], tmp[MAXK][2][2], size[MAXN];\nvector <int> Next[MAXN];\n\nint read()\n{\n\tint sum = 0, fh = 1; char ch = getchar();\n\tfor (; ch < '0' || ch > '9'; ch = getchar()) fh -= (ch == '-') << 1;\n\tfor (; ch >= '0' && ch <= '9'; ch = getchar()) sum = (sum << 3) + (sum << 1) + (ch ^ 48);\n\treturn (fh == 1) ? sum : -sum;\n}\n\nvoid dfs(int now, int fa)\n{\n\tsize[now] = f[now][0][0][0] = f[now][1][1][0] = 1;\n\tfor (int v = 0; v < Next[now].size(); ++v)\n\t{\n\t\tint u = Next[now][v];\n\t\tif (u == fa) continue;\n\t\tdfs(u, now);\n\t\tfor (int i = 0; i <= k; ++i)\n\t\t{\n\t\t\ttmp[i][0][0] = f[now][i][0][0]; f[now][i][0][0] = 0;\n\t\t\ttmp[i][0][1] = f[now][i][0][1]; f[now][i][0][1] = 0;\n\t\t\ttmp[i][1][0] = f[now][i][1][0]; f[now][i][1][0] = 0;\n\t\t\ttmp[i][1][1] = f[now][i][1][1]; f[now][i][1][1] = 0;\n\t\t}\n\t\tfor (int i = 0; i <= Min(size[now], k); ++i)\n\t\t\tfor (int j = 0; j <= Min(size[u], k - i); ++j)\n\t\t\t{\n\t\t\t\tf[now][i + j][0][0] = ((LL)f[now][i + j][0][0] + (LL)tmp[i][0][0] * f[u][j][0][1]) % P;\n\t\t\t\tf[now][i + j][0][1] = ((LL)f[now][i + j][0][1] + (LL)tmp[i][0][0] * f[u][j][1][1] % P + (LL)tmp[i][0][1] * ((LL)f[u][j][0][1] + f[u][j][1][1]) % P) % P;\n\t\t\t\tf[now][i + j][1][0] = ((LL)f[now][i + j][1][0] + (LL)tmp[i][1][0] * ((LL)f[u][j][0][1] + f[u][j][0][0]) % P) % P;\n\t\t\t\tf[now][i + j][1][1] = ((LL)f[now][i + j][1][1] + (LL)tmp[i][1][0] * ((LL)f[u][j][1][0] + f[u][j][1][1]) % P + (LL)tmp[i][1][1] * ((LL)f[u][j][0][0] + f[u][j][0][1] + f[u][j][1][0] + f[u][j][1][1]) % P) % P;\n\t\t\t}\n\t\tsize[now] += size[u];\n\t}\n}\n\nint main()\n{\n\tn = read(), k = read();\n\tfor (int i = 1; i < n; ++i)\n\t{\n\t\tint x = read(), y = read();\n\t\tNext[x].push_back(y); Next[y].push_back(x);\n\t}\n\tdfs(1, 1);\n\tprintf(\"%d\\n\", ((LL)f[1][k][0][1] + f[1][k][1][1]) % P);\n\treturn 0;\n}\n```",
        "postTime": 1614431140,
        "uid": 134000,
        "name": "Plozia",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011"
    },
    {
        "content": "## \u5206\u6790\n\u8bbe$f[u][j][0/1][0/1]$\u4e3a\u5728\u4ee5$u$\u4e3a\u6839\u7684\u5b50\u6811\u653e\u7f6e\u6070\u597d$j$\u4e2a\u76d1\u542c\u5668\uff0c\u4e14\u9664\u4e86\u70b9$u$\u5176\u4ed6\u70b9\u5747\u88ab\u8986\u76d6\uff0c\u70b9$u$\u662f\u5426\u88ab\u8986\u76d6\uff0c\u70b9$u$\u662f\u5426\u653e\u76d1\u542c\u5668\u7684\u65b9\u6848\u6570\u3002\n\n\u9996\u5148\u8003\u8651\u70b9$u$\u672a\u88ab\u8986\u76d6\n\n\u5982\u679c\u70b9$u$\u672a\u88ab\u8986\u76d6\uff0c\u90a3\u4e48\u5176\u5b50\u8282\u70b9\u4e0a\u4e00\u5b9a\u662f\u4e0d\u80fd\u653e\u76d1\u542c\u5668\u7684\u3002\n\n\u63a5\u4e0b\u6765\u6309\u70b9$u$\u662f\u5426\u653e\u76d1\u542c\u5668\u505a\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n\u5982\u679c\u8282\u70b9$u$\u4e0d\u653e\u76d1\u542c\u5668\uff0c\u90a3\u4e48\u5b50\u8282\u70b9\u5728\u4ee5\u5176\u4e3a\u6839\u7684\u5b50\u6811\u5185\u662f\u4e00\u5b9a\u88ab\u8986\u76d6\u7684\u3002\n\n\u90a3\u4e48\u6709\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$\nf[u][j][0][0]=\\sum_{P,\\forall P_i,\\sum_{P_{i,k}}=j}\\ \\prod_{p\\in son(u),a_k=P_{i,k}}f[p][a_k][1][0]\n$$\n\n\u5982\u679c\u70b9$u$\u653e\u76d1\u542c\u5668\uff0c\u90a3\u4e48\u5b50\u8282\u70b9\u5728\u4ee5\u5176\u4e3a\u6839\u70b9\u5b50\u6811\u5185\u65e2\u53ef\u4ee5\u88ab\u8986\u76d6\uff0c\u4e5f\u53ef\u4ee5\u672a\u88ab\u8986\u76d6\u3002\n\n\u90a3\u4e48\u6709\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$\nf[u][j][0][1]=\\sum_{P,\\forall P_i,\\sum_{P_{i,k}}=j-1}\\ \\prod_{p\\in son(u),a_k=P_{i,k}}f[p][a_k][1][0]+f[p][a_k][0][0]\n$$\n\n\u5982\u679c\u70b9$u$\u88ab\u8986\u76d6\u7684\u8bdd\uff0c\u90a3\u4e48\u5bf9\u4e8e$u$\u7684\u5b50\u8282\u70b9\u800c\u8a00\u5219\u9700\u8981\u81f3\u5c11\u6709\u4e00\u4e2a\u5b50\u8282\u70b9\u653e\u7f6e\u76d1\u542c\u5668\u3002\n\n\u5982\u679c\u70b9$u$\u4e0d\u653e\u7f6e\u76d1\u542c\u5668\uff0c\u90a3\u4e48\u5b50\u8282\u70b9\u5728\u4ee5\u5176\u4e3a\u6839\u7684\u5b50\u6811\u5185\u4e00\u5b9a\u88ab\u8986\u76d6\u8fc7\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u5b50\u8282\u70b9\u800c\u8a00\uff0c\u90fd\u6709\u653e\u76d1\u542c\u5668\u4e0e\u4e0d\u653e\u76d1\u542c\u5668\u4e24\u79cd\u51b3\u7b56\uff0c\u5728\u7edf\u8ba1\u5b8c\u4e4b\u540e\u51cf\u6389\u6240\u6709\u5b50\u8282\u70b9\u4e0d\u653e\u76d1\u542c\u5668\u7684\u65b9\u6848\u5373\u6211\u4eec\u8981\u7edf\u8ba1\u7684\u65b9\u6848\u3002\n\n\n\u90a3\u4e48\u6709\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$\n\\begin{aligned}\nf[u][j][1][0]&=\\sum_{P,\\forall P_i,\\sum_{P_{i,k}}=j}\\ \\prod_{p\\in son(u),a_k=P_{i,k}}f[p][a_k][1][0]+f[p][a_k][1][1]-\\sum_{P,\\forall P_i,\\sum_{P_{i,k}}=j}\\ \\prod_{p\\in son(u),a_k=P_{i,k}}f[p][a_k][1][0]\\\\\n&\n\\end{aligned}\n$$\n\u5373\n$$\nf[u][j][1][0]=\\sum_{P,\\forall P_i,\\sum_{P_{i,k}}=j}\\ \\prod_{p\\in son(u),a_k=P_{i,k}}(f[p][a_k][1][0]+f[p][a_k][1][1])-f[u][j][0][0]\n$$\n\u63a5\u4e0b\u6765\u8003\u8651\u70b9$u$\u653e\u76d1\u542c\u5668\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u53d1\u73b0\u5176\u5b50\u8282\u70b9\u7684\u4efb\u4e00\u4e00\u79cd\u72b6\u6001\u90fd\u53ef\u4ee5\u6ee1\u8db3\u4e0e\u6211\u4eec\u7684\u9700\u6c42\uff0c\u540c\u7406\u5728\u6700\u540e\u51cf\u53bb\u6240\u6709\u5b50\u8282\u70b9\u4e0d\u653e\u76d1\u542c\u5668\u70b9\u72b6\u6001\u5373\u53ef\u3002\n\n\u90a3\u4e48\u6709\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$\nf[u][j][1][1]=\\sum_{P,\\forall P_i,\\sum_{P_{i,k}}=j-1}\\ \\prod_{p\\in son(u),a_k=P_{i,k}}(f[p][a_k][1][0]+f[p][a_k][1][1]+f[p][a_k][0][0]+f[p][a_k][0][1])-f[u][j][0][1]\n$$\n\u6574\u7406\u5f97\uff1a\n$$\n\\begin{aligned}\n&f[u][j][0][0]=\\sum_{P,\\forall P_i,\\sum_{P_{i,k}}=j}\\ \\prod_{p\\in son(u),a_k=P_{i,k}}f[p][a_k][1][0]\\\\\n&f[u][j][0][1]=\\sum_{P,\\forall P_i,\\sum_{P_{i,k}}=j-1}\\ \\prod_{p\\in son(u),a_k=P_{i,k}}f[p][a_k][1][0]+f[p][a_k][0][0]\\\\\n&f[u][j][1][0]=\\sum_{P,\\forall P_i,\\sum_{P_{i,k}}=j}\\ \\prod_{p\\in son(u),a_k=P_{i,k}}(f[p][a_k][1][0]+f[p][a_k][1][1])-f[u][j][0][0]\\\\\n&f[u][j][1][1]=\\sum_{P,\\forall P_i,\\sum_{P_{i,k}}=j-1}\\ \\prod_{p\\in son(u),a_k=P_{i,k}}(f[p][a_k][1][0]+f[p][a_k][1][1]+f[p][a_k][0][0]+f[p][a_k][0][1])-f[u][j][0][1]\n\\end{aligned}\n$$\n## \u4ee3\u7801\u5b9e\u73b0\n\u4f46\u662f\u6709\u4e86\u4e0a\u9762\u56db\u4e2a\u8f6c\u79fb\u65b9\u7a0b\uff0c\u6211\u4eec\u76ee\u524d\u5e76\u4e0d\u80fd\u5728\u7a0b\u5e8f\u4e2d\u5b9e\u73b0\uff0c\u8003\u8651\u5bf9\u4e0a\u8ff0\u8f6c\u79fb\u65b9\u7a0b\u505a\u4e00\u4e9b\u53d8\u578b\u3002\n\n\u6211\u4eec\u8003\u8651\u4e00\u4e2a\u66f4\u4e00\u822c\u6027\u7684\u5f0f\u5b50\n$$\nf[t]=\\sum_{\\sum c_i=t}\\{\\prod_{p\\in S}w[p,c_i]\\}\n$$\n\u5176\u552f\u4e00\u7684\u7ea6\u675f\u4e3a$\\sum c_i = t$\n\n\u7c7b\u4f3c\u4e8e\u5206\u7ec4\u80cc\u5305\uff0c\u6bcf\u6b21\u53ea\u8003\u8651\u524d$i$\u7ec4\uff1a\n$$\nf[i][j]=\\sum_k f[i-1][j-k]\\times w[i][k]\n$$\n\n\n\n\n\u90a3\u4e48\u8fd9\u6837\u505a\u7684\u590d\u6742\u5ea6\u662f\u591a\u5c11\u5462\uff1f\n\n\u663e\u7136\uff0c\u5176\u590d\u6742\u5ea6\u662f$O(nm^2)$\u7684\uff0c\u8fd9\u6837\u662f\u4e0d\u8db3\u4ee5\u8fc7\u6389\u6b64\u9898\u7684\u3002\n\n\u800c\u5bf9\u4e8e\u6811\u4e0a\u80cc\u5305\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4f18\u5316\u4e0a\u4e0b\u9650\u6392\u9664\u65e0\u7528\u72b6\u6001\u7684\u65b9\u5f0f\u4f18\u5316\u5230$O(nm)$\u3002([\u5177\u4f53\u8bc1\u660e](https://www.cnblogs.com/ouuan/p/BackpackOnTree.html))\n\n\u4ee4$cntsize$\u4e3a\u5f53\u904d\u5386\u5230\u7684\u5b50\u6811\u5927\u5c0f\u7684\u548c\uff08\u4e0d\u5305\u62ec\u5b50\u6811$v$\uff09\uff0c$size[v]$\u4e3a\u5b50\u6811$v$\u7684\u5927\u5c0f\uff0c$size[u]$\u4e3a\u5b50\u6811$u$\u7684\u5927\u5c0f\u3002\n\n\u90a3\u4e48$j$\u7684\u53d6\u503c\u8303\u56f4\u663e\u7136\u4e3a$0\\le j\\le \\min(cntsize+size[v])$\n\n$k$\u7684\u53d6\u503c\u8303\u56f4\u4e3a$\\max(j-cntsize,0)\\le k\\le \\min(j,size[v])$\n\n\u4f18\u5316\u540e\u7684\u4ee3\u7801\u5b9e\u73b0\uff08\u5168\uff09\uff1a\n```cpp\n#include <iostream>\n\nnamespace wxy{\n    typedef long long ll;\n    const int N = 1e5 + 5,mod = 1e9 + 7;\n    int head[N],fail[N << 1],edge[N << 1],tot;\n    unsigned int f[N][105][2][2];\n    bool vis[N];\n    int n,m,size[N];\n    inline void add(int x,int y){\n        edge[++tot] = y;\n        fail[tot] = head[x];\n        head[x] = tot;\n    }\n    void dfs(int x){\n        vis[x] = true;\n        size[x] = 1;\n        f[x][0][0][0] = f[x][0][0][1] = f[x][0][1][0] = f[x][0][1][1] = 1;\n        for (int i = head[x];i;i = fail[i]){\n            int v = edge[i];\n            if (vis[v]) continue;\n            dfs(v);\n            int presize = size[x];\n            size[x] += size[v];\n            for (int j = std::min(size[x],m); j >= 0; j--){\n                int p = std::max(0,j - presize - 1);\n                if (p == 0){\n                    f[x][j][0][0] = (1ll * f[x][j][0][0] * f[v][0][1][0]) % mod;\n                    f[x][j][0][1] = (1ll * f[x][j][0][1] * (f[v][0][0][0] + f[v][0][1][0]) % mod) % mod;\n                    f[x][j][1][0] = (1ll * f[x][j][1][0] * (f[v][0][1][0] + f[v][0][1][1]) % mod) % mod;\n                    f[x][j][1][1] = (1ll * f[x][j][1][1] * (f[v][0][0][0] + f[v][0][0][1] + f[v][0][1][0] + f[v][0][1][1]) % mod) % mod;\n                    p++;\n                }else{\n                    f[x][j][0][0] = f[x][j][0][1] = f[x][j][1][0] = f[x][j][1][1] = 0;\n                }\n                for (int k = p; k <= std::min(size[v],j); k++){\n                    f[x][j][0][0] = (f[x][j][0][0] + (1ll * f[x][j - k][0][0] * (f[v][k][1][0])) % mod) % mod;\n                    f[x][j][0][1] = (f[x][j][0][1] + (1ll * f[x][j - k][0][1] * (f[v][k][0][0] + f[v][k][1][0]) % mod) % mod) % mod;\n                    f[x][j][1][0] = (f[x][j][1][0] + (1ll * f[x][j - k][1][0] * (f[v][k][1][0] + f[v][k][1][1]) % mod) % mod) % mod;\n                    f[x][j][1][1] = (f[x][j][1][1] + (1ll * f[x][j - k][1][1] * (f[v][k][0][0] + f[v][k][0][1] + f[v][k][1][0] + f[v][k][1][1]) % mod) % mod) % mod;\n                }\n            }\n        }\n        for (int t = std::min(size[x],m); t > 0; t--){\n            f[x][t][0][1] = f[x][t - 1][0][1];\n            f[x][t][1][1] = f[x][t - 1][1][1];\n        }\n        f[x][0][0][1] = f[x][0][1][1] = 0;\n        for (int t = 0; t <= std::min(size[x],m); t++){\n            f[x][t][1][0] = (f[x][t][1][0] - f[x][t][0][0] + mod) % mod;\n            f[x][t][1][1] = (f[x][t][1][1] - f[x][t][0][1] + mod) % mod;\n        }\n    }\n    void main(){\n        tot = 0;\n        std::cin >> n >> m;\n        for (int i = 1; i < n; i++){\n            int a,b;\n            std::cin >> a >> b;\n            add(a,b);\n            add(b,a);\n        }\n        dfs(1);\n        std::cout << (f[1][m][1][0] + f[1][m][1][1]) % mod;\n    }\n}signed main(){wxy::main();return 0;}\n```\n\n\n\n\n",
        "postTime": 1605437003,
        "uid": 317459,
        "name": "RyexAwl",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011\u6811\u4e0a\u5b8c\u5168\u8986\u76d6+\u5206\u7ec4\u80cc\u5305 \u6811\u4e0a\u5206\u7ec4\u80cc\u5305\u590d\u6742\u5ea6\u5206\u6790"
    },
    {
        "content": "## \u90e8\u5206\u5206\uff1a\n\n$\\texttt{Subtask1 10pts  }n\\le 20$\n\n\u679a\u4e3e\u6bcf\u4e2a\u70b9\u88c5\u4e0d\u88c5\u76d1\u542c\u5668\uff0c\u7136\u540e\u5224\u65ad\u662f\u5426\u53ef\u884c\n\n$\\texttt{Subtask2 10pts  }k\\le 10$\n\n$k$ \u5f88\u5c0f\uff0c\u5728\u968f\u673a\u60c5\u51b5\u4e0b\uff08\u4e5f\u540c\u6837\u662f\u6570\u636e\uff09\u65e0\u6cd5\u8986\u76d6\u6574\u4e2a\u6811\uff0c\u76f4\u63a5\u8f93\u51fa $0$\u3002\n\n$\\texttt{Subtask3 10pts  }$ \u6574\u4e2a\u6811\u662f\u94fe\n\n\u5982\u679c $k$ \u5c0f\u4e8e $n-2$\uff0c\u90a3\u4e48\u65e0\u6cd5\u8986\u76d6\u4f4f\u8fd9\u4e2a\u6811\uff0c\u8f93\u51fa $0$\n\n\u6240\u4ee5\u5982\u679c\u6211\u5728\u8003\u573a\u4e0a\u53ef\u4ee5\u62ff $30$ \u5206\u2026\u2026\n\n---\n\n## \u6b63\u89e3\uff1a\n\n\u663e\u7136\u8fd9\u662f\u4e2a\u6811\u5f62\u80cc\u5305\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u6811\u5f62\u80cc\u5305\u7684\u5e38\u89c1\u5957\u8def\u505a\u3002$f(u,x,0/1,0/1)$ \u4ee3\u8868\u7b2c $u$ \u4e2a\u8282\u70b9\u5b50\u6811\u7528 $x$ \u4e2a\u76d1\u542c\u5668\uff0c$u$ \u88c5/\u4e0d\u88c5\u76d1\u542c\u5668\uff0c$u$\u6709/\u6ca1\u6709\u88ab\u8986\u76d6\u3002\n\n\uff08\u4ee5\u4e0b $v$ \u4ee3\u8868 $u$ \u7684\u513f\u5b50\uff09\n\n---\n\n\u5bf9\u4e8e $f(u,x,0,0)$\uff0c\u7531\u4e8e\u81ea\u5df1\u4e0d\u80fd\u88ab\u8986\u76d6\uff0c\u6240\u4ee5 $v$ \u5c31\u4e0d\u80fd\u5b89\u88c5\u3002\u7531\u4e8e\u81ea\u5df1\u4e0d\u80fd\u5b89\u88c5\uff0c\u6240\u4ee5 $v$ \u4e00\u5b9a\u9700\u8981\u5b89\u88c5\uff08\u5426\u5219\u5c31\u6ca1\u6709\u5176\u4ed6\u4eba\u53bb\u8986\u76d6\u8fd9\u4e2a\u8282\u70b9\u4e86\uff09\u3002\n\n\u7531\u4e8e\u8fd9\u4e2a\u662f\u4e58\u6cd5\u539f\u7406\u7b97\u79cd\u7c7b\u6570\uff0c\u6240\u4ee5\u5e94\u8be5\u662f\u4e58\u8d77\u6765\u3002\n\n$$\nf(u,i+j,0,0)=f(u,i,0,0)\\times f(v,j,0,1)\n$$\n\n\u5bf9\u4e8e $f(u,x,0,1)$\uff0c\u7531\u4e8e\u81ea\u5df1\u88ab\u8986\u76d6\uff0c\u6240\u4ee5 $v$ \u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u5fc5\u987b\u5b89\u88c5\u3002\n\n\u90a3\u4e48\u53ef\u4ee5\u8f6c\u79fb\u5230\u8fd9\u4e2a\u72b6\u6001\u7684 $f(u)$ \u5e94\u8be5\u6709 $f(u,x,0,0)$ \u548c $f(u,x,0,1)$\uff0c\u53ef\u4ee5\u663e\u7136\u63a8\u5f97\uff1a  \n\n$$\nf(u,i+j,0,1)=f(u,i,0,0)\\times f(v,j,1,1)+f(u,i,0,1)\\times f(v,j,0/1,1)\n$$\n\n\u5bf9\u4e8e $f(u,x,1,0)$\uff0c\u7531\u4e8e\u81ea\u5df1\u6ca1\u6709\u88ab\u8986\u76d6\uff0c\u6240\u4ee5 $v$ \u5c31\u4e0d\u80fd\u5b89\u88c5\u3002\u7531\u4e8e\u81ea\u5df1\u5b89\u88c5\u4e86\uff0c\u6240\u4ee5 $v$ \u53ef\u4ee5\u8986\u76d6\u6216\u8005\u4e0d\u8986\u76d6\u3002\n\n$$\nf(u,i+j,1,0)=f(u,i,1,0)\\times f(v,j,0,0/1)\n$$\n\n\u5bf9\u4e8e $f(u,x,1,1)$\uff0c\u7531\u4e8e\u81ea\u5df1\u88ab\u8986\u76d6\u4e86\uff0c\u6240\u4ee5 $v$ \u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u5b89\u88c5\u3002\u53ef\u4ee5\u8f6c\u79fb\u5230\u8fd9\u4e2a\u72b6\u6001\u7684 $f(u)$ \u6709 $f(u,x,1,0)$ \u548c $f(u,x,1,1)$\u3002\n\n\u7531\u4e8e\u81ea\u5df1\u5b89\u88c5\u4e86\uff0c\u6240 $v$ \u53ef\u4ee5\u8986\u76d6\u6216\u8005\u4e0d\u8986\u76d6\u3002\n\n$$\nf(u,i+j,1,1)=f(u,i,1,0)\\times f(v,j,1,0/1)+f(u,i,1,1)\\times f(v,j,0/1,0/1)\n$$\n\n\u521d\u59cb\u5316\uff1a $f(u,0,0,0)=f(u,1,1,0)=1$\n\n---\n\n## \u4ee3\u7801&\u7ec6\u8282\n\n\u63a8\u5b8c\u5f0f\u5b50\u5c31\u53ef\u4ee5\u5199\u4ee3\u7801\u4e86\uff08\u8f6c\u79fb\u65b9\u7a0b\u957f\u5f97\u6709\u70b9\u96be\u53d7\uff09\u3002\n\n\u7136\u540e\u8fd9\u9898\u5f3a\u5236\u7528 int \u7136\u540e\u64cd\u4f5c\u8f6c longlong \u5f88\u6740\u4eba\u3002\n\n\u6211\u5bf9\u51fa\u9898\u4eba\u5361\u7a7a\u95f4\u7684\u884c\u4e3a\u611f\u5230**\u975e\u5e38\u4e0d\u6ee1**\uff08\n\n```foin(x,y)``` \u51fd\u6570\u4ee3\u8868\u4e24\u6570\u76f8\u52a0\u5e76\u53d6\u6a21\uff08\u5728 int \u8f6c longlong \u64cd\u4f5c\u4e2d\u5f88\u5b9e\u7528\uff09\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N=1e5+3; const ll mod=1000000007;\nstruct edge{int to,nxt;}e[N*2]; int hd[N],tot;\nvoid add(int u,int v){e[++tot]=(edge){v,hd[u]},hd[u]=tot;}\nint n,k;\nint foin(ll q,ll p){return (q+p)>mod?1ll*q+p-mod:q+p;}\n\nint sz[N],f[N][103][2][2],t[103][2][2]; //\u6811\u5f62\u80cc\u5305\u5e38\u7528\u76843\u4e2a\u6570\u7ec4\nvoid dfs(int u,int fa){\n\tf[u][0][0][0]=f[u][1][1][0]=sz[u]=1;\n\tfor(register int p=hd[u],v;p;p=e[p].nxt)\n\t\tif((v=e[p].to)!=fa){\n\t\t\tdfs(v,u);\n\t\t\tfor(register int i=0;i<=min(sz[u],k);i++)\n\t\t\t\tfor(register int j=0;j<2;j++)\n\t\t\t\t\tfor(register int k=0;k<2;k++)\n\t\t\t\t\t\tt[i][j][k]=f[u][i][j][k], f[u][i][j][k]=0;\n\t\t\tfor(register int i=0;i<=min(sz[u],k);i++){\n\t\t\t\tfor(register int j=0;j<=min(sz[v],k-i);j++){\n\t\t\t\t\tf[u][i+j][0][0]=foin(f[u][i+j][0][0],1ll*t[i][0][0]*f[v][j][0][1]%mod);\n\t\t\t\t\tf[u][i+j][0][1]=foin(f[u][i+j][0][1],(1ll*t[i][0][0]*f[v][j][1][1]+1ll*t[i][0][1]*(1ll*f[v][j][0][1]+f[v][j][1][1]))%mod);\n\t\t\t\t\tf[u][i+j][1][0]=foin(f[u][i+j][1][0],1ll*t[i][1][0]*(1ll*f[v][j][0][0]+f[v][j][0][1])%mod);\n\t\t\t\t\tf[u][i+j][1][1]=foin(f[u][i+j][1][1],foin((1ll*t[i][1][0]*(1ll*f[v][j][1][0]+f[v][j][1][1])%mod)\n\t\t\t\t\t\t,1ll*t[i][1][1]*(1ll*f[v][j][0][0]+f[v][j][0][1]+f[v][j][1][0]+f[v][j][1][1])%mod));\n\t\t\t\t}\n\t\t\t}\n\t\t\tsz[u]+=sz[v];\n\t\t}\n}\n\nint main(){\n\tscanf(\"%d%d\",&n,&k);\n\tfor(int i=1,u,v;i<n;i++)\n\t\tscanf(\"%d%d\",&u,&v),add(u,v),add(v,u);\n\tdfs(1,0);\n\tprintf(\"%lld\",1ll*(f[1][k][0][1]+f[1][k][1][1])%mod);\n\treturn 0;\n}\n```",
        "postTime": 1589186488,
        "uid": 180652,
        "name": "_lgswdn",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011"
    },
    {
        "content": "$\\ \\ \\ \\ \\ \\ \\ $[luogu](https://www.luogu.com.cn/problem/P4516)\n\n$\\ \\ \\ \\ \\ \\ \\ $\u521d\u770b\u9898\u9762\uff1a\u54e6\uff0c\u8fd9\u96be\u9053\u4e0d\u662f\u4e00\u9053\u6c34\u9898\u4e48\uff1f\u76f4\u63a5\u5207\u561b\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u7c7b\u4f3c\u4e8e\u5206\u7c7b\u8ba8\u8bba\u88ab\u81ea\u63a7\uff0c\u88ab\u7238\u7238\u63a7\u5236\uff0c\u88ab\u513f\u5b50\u63a7\u5236\u561b\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u518d\u770b\u9898\u9762\uff0c\u53d1\u73b0\uff1a\u5982\u679c\u5728\u81ea\u5df1\u8fd9\u91cc\u653e\u4e0a\u76d1\u63a7\uff0c\u662f\u65e0\u6cd5\u88ab\u63a7\u5236\u7684\u3002\u4e8e\u662f\u6211\u4eec\u7684\u6811\u5f62 dp \u5c31\u5ba3\u544a\u7206\u70b8\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u56e0\u4e3a~~\u6839\u636e\u8ba8\u8bba~~\u7406\u6027\u5206\u6790\u4e4b\u540e\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u5176\u5b9e\u88ab\u63a7\u5236\u662f\u6839\u672c\u4e00\u6837\u7684\u3002\u53ea\u6709\u81ea\u5df1\u653e\u6216\u8005\u4e0d\u653e\u7684\u533a\u522b\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u8003\u8651\u4ee5\u4e0a\u5f71\u54cd\u56e0\u7d20\u4ee5\u53ca\u6211\u4eec\u7684\u7ecf\u9a8c\uff0c\u5b9a\u4e49 $dp_{i,j,0\\ or\\ 1,0\\ or\\ 1}$ \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u7528 $j$ \u4e2a\u76d1\u63a7\u5668\uff0c\uff08\u6839\u53ef\u4ee5\u4e0d\u88ab\u76d1\u542c\uff0c\u4f46\u662f\u5176\u5b83\u8282\u70b9\u5fc5\u987b\u88ab\u76d1\u542c\uff09\u5f53\u524d\u8282\u70b9\u653e\u4e0d\u653e\u76d1\u63a7\u5668\uff0c\u6839\u662f\u5426\u88ab\u76d1\u542c\uff0c\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u5f88\u957f\u7684 dp \u65b9\u7a0b\uff0c\u592a\u957f\u61d2\u5f97\u6253\uff0c\u5c31\u653e\u5728\u4ee3\u7801\u91cc\u9762\u5427\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u4f46\u662f\u8fd9\u6837\u5c31\u5b8c\u4e86\u5417\uff1f\u8fd9\u9053\u9898\u7684\u96be\u70b9\u5c31\u5728\u4e8e\uff0c\u6211\u4eec\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(nk^2)$ \u7684\uff01\uff01\u90a3\u4e48\u653e\u4e0a\u6734\u7d20\u4ee3\u7801\u3002\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<queue>\n#include<cstring>\n//1\n#define MOD 1000000007ll\nusing namespace std;\ntypedef long long LL;\n/*\ndp[i][j][0/1][0/1]:\n\u4ee5i\u4e3a\u6839\uff0c\u653ej\u4e2a\u76d1\u542c\u5668\uff0c\u6839\u653e\u4e86\u6ca1\u6709\uff0c\u88ab\u76d1\u542c\u6ca1\u6709\u3002\n*/\nvector<int> G[100005];\nlong long read()\n{\n\tlong long x=0,f=1;\n\tchar c=getchar();\n\twhile(c<'0' || c>'9')\n\t{\n\t\tif(c=='-')\tf=-1;\n\t\tc=getchar();\n\t}\n\twhile(c>='0' && c<='9')\tx=(x<<1)+(x<<3)+(c^'0'),c=getchar();\n\treturn x*f;\n}//2\nint dp[100005][105][2][2],tmpdp[105][2][2],sizen[100005],n,k;\nvoid DP(long long now,long long pre)\n{\n\tdp[now][0][0][0]=dp[now][1][1][0]=sizen[now]=1;\n\tfor(unsigned int i=0;i<G[now].size();++i)\n\t{\n\t\tint to=G[now][i];\n\t\tif(to==pre)\tcontinue;\n\t\tDP(to,now);\n\t\tmemset(tmpdp,0,sizeof tmpdp);\n\t\tfor(int j=0;j<=k;++j)\n\t\t{\n\t\t\tfor(int l=0;l<=k-j;++l)//3\n\t\t\t{\n\t\t\t\ttmpdp[j+l][0][0]+=(\n\t\t\t\t(LL)dp[now][j][0][0]*dp[to][l][0][1])%MOD,\n\t\t\t\ttmpdp[j+l][0][0]%=MOD;\n\t\t\t\ttmpdp[j+l][0][1]+=(((\n\t\t\t\t(LL)dp[now][j][0][1]*dp[to][l][0][1])%MOD+\n\t\t\t\t(LL)dp[now][j][0][1]*dp[to][l][1][1])+\n\t\t\t\t(LL)dp[now][j][0][0]*dp[to][l][1][1])%MOD,\n\t\t\t\ttmpdp[j+l][0][1]%=MOD;\n\t\t\t\ttmpdp[j+l][1][0]+=((\n\t\t\t\t(LL)dp[now][j][1][0]*dp[to][l][0][1])+\n\t\t\t\t(LL)dp[now][j][1][0]*dp[to][l][0][0])%MOD,\n\t\t\t\ttmpdp[j+l][1][0]%=MOD;\n\t\t\t\ttmpdp[j+l][1][1]+=((((((\n\t\t\t\t(LL)dp[now][j][1][1]*dp[to][l][0][0])%MOD+\n\t\t\t\t(LL)dp[now][j][1][1]*dp[to][l][0][1])+\n\t\t\t\t(LL)dp[now][j][1][1]*dp[to][l][1][0])%MOD+\n\t\t\t\t(LL)dp[now][j][1][1]*dp[to][l][1][1])+\n\t\t\t\t(LL)dp[now][j][1][0]*dp[to][l][1][0])+\n\t\t\t\t(LL)dp[now][j][1][0]*dp[to][l][1][1])%MOD,\n\t\t\t\ttmpdp[j+l][1][1]%=MOD;//dp\u65b9\u7a0b\n\t\t\t}\n\t\t}\n\t\tsizen[now]+=sizen[to];\n\t\tmemcpy(dp[now],tmpdp,sizeof tmpdp);\n\t}\n}\nint main(){\n// \tfreopen(\"sneak.in\",\"r\",stdin);\n// \tfreopen(\"sneak.out\",\"w\",stdout);\n\tn=read(),k=read();\n\tfor(int i=1;i<n;++i)\n\t{\n\t\tint u=read(),v=read();\n\t\tG[u].push_back(v);\n\t\tG[v].push_back(u);\n\t}\n\tDP(1,0);\n\tprintf(\"%lld\",(dp[1][k][0][1]+dp[1][k][1][1])%MOD);\n\twhile(1)\treturn 0;\n}\n```\n\n$\\ \\ \\ \\ \\ \\ \\ $\u4e8e\u662f\u6211\u4eec\u53ea\u80fd\u8003\u8651\u4f18\u5316\u3002\u9996\u5148\u6765\u8bd5\u4e00\u4e0b\u4f18\u5316\u5e38\u6570\u5427\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u4f18\u5316 1\uff08\u5bf9\u5e94\u6ce8\u91ca1\uff09\uff1a\u4f60\u7684\u516b\u805a\u6c27\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u4f18\u5316 2\uff08\u5bf9\u5e94\u6ce8\u91ca2\uff09\uff1a\u4f60\u7684 `fread()`\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u4f18\u5316 3\uff08\u5bf9\u5e94\u6ce8\u91ca3\uff09\uff1a\u653e\u4e0d\u4e86\u8fd9\u4e48\u591a\u653e\u4ec0\u4e48\u653e\uff0c\u628a `j<=k` \u6539\u6210 `min(k,sizen[now])`\uff0c`l<=k-j` \u6539\u6210 `min(k-j,sizen[to])`\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u4ea4\u4e00\u53d1\uff0c\u4e3a\u4ec0\u4e48 A \u4e86\uff1f\uff1f\n\n$\\ \\ \\ \\ \\ \\ \\ $\u5220\u53bb\u4f18\u5316 1 \u548c 2\uff0c\u53d1\u73b0\u5176\u5b9e 1 \u548c 2 \u5e76\u6ca1\u6709\u8d77\u5f88\u5927\u4f5c\u7528\uff0c\u5220\u6389 3 \u5c31\u53ea\u6709 30 \u5206\u4e86\u3002\u8fd9\u662f\u4e3a\u4ec0\u4e48\u5462\uff1f\n\n$\\ \\ \\ \\ \\ \\ \\ $\u9996\u5148\u5206\u6790\u4e00\u4e0b\u590d\u6742\u5ea6\uff0c\u8fd9\u4e2a\u4f18\u5316\u770b\u4f3c\u662f\u4e00\u4e2a\u5e38\u6570\u4f18\u5316\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u8d77\u5230\u4e86\u81f3\u5173\u91cd\u8981\u7684\u4f5c\u7528\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u8003\u8651\u8bc1\u660e\uff0c\u601d\u6765\u60f3\u53bb\u4e5f\u4e0d\u8fc7\u4e09\u79cd\u60c5\u51b5\uff1a\n\n1. \u4e00\u4e2a\u8282\u70b9\u6709\u4e24\u4e2a\u513f\u5b50\u5f62\u6210\u7684\u5b50\u6811\u5927\u5c0f\u5927\u4e8e $k$\uff1a\u5b9e\u9645\u4e0a\u5408\u5e76\u6b21\u6570\u5c31\u4e0d\u4f1a\u8d85\u8fc7 $O(\\frac{n}{k})$ \u4e86\u3002\u8fd9\u6837\u4e4b\u540e\u5c31\u4f1a\u53d8\u6210 $O(k)$\u3002\u5b9e\u9645\u4e0a\u8fd9\u5e94\u8be5\u662f\u6700\u5feb\u7684\u4e00\u79cd\u60c5\u51b5\u3002\n\n2. \u4e00\u4e2a\u8282\u70b9\u6709\u4e00\u4e2a\u513f\u5b50\u5f62\u6210\u7684\u5b50\u6811\u5927\u5c0f\u5c0f\u4e8e $k$\uff0c\u5408\u5e76\u4e86\u5c31\u6210\u4e86\u5927\u4e8e $k$ \u4e86\uff1a\u56e0\u4e3a\u5b50\u6811\u7684\u6240\u6709\u8282\u70b9\u90fd\u7ecf\u8fc7\u4e00\u6b21\u80cc\u5305\u5408\u5e76\uff0c\u5b9e\u9645\u4e0a\u5747\u644a\u4e4b\u540e\u4e5f\u53ea\u6709 $O(k)$ \u4e86\u3002\n\n3. otherwise\uff1a\u663e\u7136\u8fd9\u4e2a\u4e1c\u897f\u662f\u4e0d\u8db3 $O(k)$ \u7684\u3002\u6bcf\u6b21\u52a0\u5165\u4e00\u4e2a\u70b9\uff0c\u4e0d\u8db3 $k$ \u4e2a\u8282\u70b9\uff0c\u90a3\u4e48\u5bf9\u4e8e\u67d0\u4e00\u4e2a\u7279\u5b9a\u7684\u70b9\uff0c\u5b83\u7684\u8d21\u732e\u5b9e\u9645\u4e0a\u662f\u6bcf\u6b21\u52a0\u5165\u7684\u5b50\u6811\u5927\u5c0f\uff0c\u8fd8\u6ca1\u6709 $O(k)$ \u4e86\u3002\n\n$\\ \\ \\ \\ \\ \\ \\ $\u7efc\u4e0a\u6240\u8ff0\uff1a\u6211\u4eec\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(nk)$\u3002\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<queue>\n#include<cstring>\n#define MOD 1000000007ll\nusing namespace std;\ntypedef long long LL;\n/*\ndp[i][j][0/1][0/1]:\n\u4ee5i\u4e3a\u6839\uff0c\u653ej\u4e2a\u76d1\u542c\u5668\uff0c\u6839\u653e\u4e86\u6ca1\u6709\uff0c\u88ab\u76d1\u542c\u6ca1\u6709\u3002\n*/\nvector<int> G[100005];\nlong long read()\n{\n\tlong long x=0,f=1;\n\tchar c=getchar();\n\twhile(c<'0' || c>'9')\n\t{\n\t\tif(c=='-')\tf=-1;\n\t\tc=getchar();\n\t}\n\twhile(c>='0' && c<='9')\tx=(x<<1)+(x<<3)+(c^'0'),c=getchar();\n\treturn x*f;\n}\nint dp[100005][105][2][2],tmpdp[105][2][2],sizen[100005],n,k;\nvoid DP(long long now,long long pre)\n{\n\tdp[now][0][0][0]=dp[now][1][1][0]=sizen[now]=1;\n\tfor(unsigned int i=0;i<G[now].size();++i)\n\t{\n\t\tint to=G[now][i];\n\t\tif(to==pre)\tcontinue;\n\t\tDP(to,now);\n\t\tmemset(tmpdp,0,sizeof tmpdp);\n\t\tfor(int j=0;j<=min(k,sizen[now]);++j)\n\t\t{\n\t\t\tfor(int l=0;l<=min(k-j,sizen[to]);++l)\n\t\t\t{\n\t\t\t\ttmpdp[j+l][0][0]+=(\n\t\t\t\t(LL)dp[now][j][0][0]*dp[to][l][0][1])%MOD,\n\t\t\t\ttmpdp[j+l][0][0]%=MOD;\n\t\t\t\ttmpdp[j+l][0][1]+=(((\n\t\t\t\t(LL)dp[now][j][0][1]*dp[to][l][0][1])%MOD+\n\t\t\t\t(LL)dp[now][j][0][1]*dp[to][l][1][1])+\n\t\t\t\t(LL)dp[now][j][0][0]*dp[to][l][1][1])%MOD,\n\t\t\t\ttmpdp[j+l][0][1]%=MOD;\n\t\t\t\ttmpdp[j+l][1][0]+=((\n\t\t\t\t(LL)dp[now][j][1][0]*dp[to][l][0][1])+\n\t\t\t\t(LL)dp[now][j][1][0]*dp[to][l][0][0])%MOD,\n\t\t\t\ttmpdp[j+l][1][0]%=MOD;\n\t\t\t\ttmpdp[j+l][1][1]+=((((((\n\t\t\t\t(LL)dp[now][j][1][1]*dp[to][l][0][0])%MOD+\n\t\t\t\t(LL)dp[now][j][1][1]*dp[to][l][0][1])+\n\t\t\t\t(LL)dp[now][j][1][1]*dp[to][l][1][0])%MOD+\n\t\t\t\t(LL)dp[now][j][1][1]*dp[to][l][1][1])+\n\t\t\t\t(LL)dp[now][j][1][0]*dp[to][l][1][0])+\n\t\t\t\t(LL)dp[now][j][1][0]*dp[to][l][1][1])%MOD,\n\t\t\t\ttmpdp[j+l][1][1]%=MOD;\n\t\t\t}\n\t\t}\n\t\tsizen[now]+=sizen[to];\n\t\tmemcpy(dp[now],tmpdp,sizeof tmpdp);\n\t}\n}\nint main(){\n// \tfreopen(\"sneak.in\",\"r\",stdin);\n// \tfreopen(\"sneak.out\",\"w\",stdout);\n\tn=read(),k=read();\n\tfor(int i=1;i<n;++i)\n\t{\n\t\tint u=read(),v=read();\n\t\tG[u].push_back(v);\n\t\tG[v].push_back(u);\n\t}\n\tDP(1,0);\n\tprintf(\"%lld\",(dp[1][k][0][1]+dp[1][k][1][1])%MOD);\n\twhile(1)\treturn 0;\n}\n```",
        "postTime": 1579936363,
        "uid": 184977,
        "name": "pomelo_nene",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011"
    },
    {
        "content": "\u9898\u610f:https://www.luogu.org/problem/P4516\n\n\u4e00\u9053\u633a\u9ebb\u70e6\u7684\u6811\u5f62\u80cc\u5305\n\n\u663e\u7136\u6709\u4e24\u7ef4\u662f$f[x][i]$\u8868\u793ax\u7684\u5b50\u6811\u9009\u4e86i\u4e2a\u5b8c\u5168\u8986\u76d6\u7684\u65b9\u6848\u6570\n\n\u4e4b\u540e\u4e3a\u4e86\u8f6c\u79fb\u9700\u8981\u518d\u52a0\u51e0\u7ef4\n\n\u7531\u4e8e\u6839\u8282\u70b9\u653e\u4e86\u5e76\u4e0d\u8986\u76d6\u6839\u8282\u70b9\u672c\u8eab,\u9700\u8981\u6dfb\u52a0\u4e24\u7ef4:\n\n$f[x][i][0/1][0/1]$\u8868\u793ax\u7684\u5b50\u6811,\u9009\u4e86i\u4e2a,x\u662f\u5426\u9009\u4e86,x\u662f\u5426\u88ab\u8986\u76d6,\u5b50\u6811\u5185(\u9664\u4e86x)\u5168\u90fd\u88ab\u8986\u76d6\u7684\u65b9\u6848\u6570\n\n\u7b54\u6848:$f[1][m][1][1]+f[1][m][0][1]$\n\n\u8f6c\u79fb:\n\n\u679a\u4e3ex\u4e4b\u524d\u7684\u5b50\u6811\u7528\u4e86\u591a\u5c11\u4e3ai,\u5f53\u524d\u5b50\u6811y\u7528\u591a\u5c11\u4e3aj\n\n$f[x][i+j][0][0]+=f[x][i][0][0]*f[y][j][0][1]$\n\n\u7531\u4e8ex\u6ca1\u6709\u653e,\u56e0\u6b64y\u5fc5\u987b\u88ab\u8986\u76d6,\u53c8\u56e0\u4e3ax\u6ca1\u6709\u88ab\u8986\u76d6,y\u662f\u4e0d\u80fd\u653e\u7684\n\n$f[x][i+j][0][1]+=f[x][i][0][1]*f[y][j][1/0][1]+f[x][i][0][0]*f[y][j][1][1]$\n\n\u7531\u4e8ex\u4e0d\u653e,\u6240\u4ee5y\u5fc5\u987b\u88ab\u8986\u76d6,\u63a5\u4e0b\u6765\u5206\u4e24\u79cd\u60c5\u51b5\u8ba8\u8bba:\n\n1.x\u4e4b\u524d\u88ab\u8986\u76d6\u4e86:y\u653e\u4e0d\u653e\u90fd\u884c\n\n2.x\u4e4b\u524d\u6ca1\u6709\u88ab\u8986\u76d6:y\u5fc5\u987b\u653e\u4e0a\n\n$f[x][i+j][1][0]+=f[x][i][1][0]*f[y][j][0][0/1]$\n\n\u7531\u4e8ex\u5df2\u7ecf\u653e\u4e0a\u4e86,y\u4e4b\u524d\u662f\u5426\u88ab\u8986\u76d6\u65e0\u6240\u8c13,\u4f46y\u662f\u4e0d\u80fd\u653e\u7684,\u56e0\u4e3ax\u672a\u88ab\u8986\u76d6\n\n$f[x][i+j][1][1]+=f[x][i][1][1]*f[y][j][0/1][0/1]+f[i][1][0]*f[y][j][1][0/1]$\n\n\u7531\u4e8ex\u5df2\u7ecf\u653e\u4e0a\u4e86,y\u662f\u5426\u88ab\u8986\u76d6\u65e0\u6240\u8c13,\u63a5\u4e0b\u6765\u5206\u4e24\u79cd\u60c5\u51b5\u8ba8\u8bba\n\n1.x\u4e4b\u524d\u88ab\u8986\u76d6\u4e86:y\u4ec0\u4e48\u72b6\u6001\u90fd\u65e0\u6240\u8c13,\u5168\u52a0\u8d77\u6765\u5c31\u884c\u4e86\n\n2.x\u4e4b\u524d\u672a\u88ab\u8986\u76d6:y\u5fc5\u987b\u653e\u4e0a\n\n\u8fd9\u9898f\u6570\u7ec4\u4e0d\u80fd\u5f00long long,\u8f6c\u79fb\u65f6\u4e58$1ll$\u5373\u53ef\n\ncode:\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define re register\nconst int maxn=1e5+10;\nconst int maxk=110;\nconst int mod=1000000007;\nint n,m,cnt;\nint head[maxn],size[maxn];\nint g[maxk][2][2];\nint f[maxn][maxk][2][2];\nstruct edge\n{\n\tint to,nxt;\n}e[maxn<<1];\ninline void add(int u,int v)\n{\n\te[++cnt].nxt=head[u];\n\thead[u]=cnt;\n\te[cnt].to=v;\n}\nvoid dfs(int x,int fa)\n{\n\tsize[x]=1;\n\tf[x][0][0][0]=f[x][1][1][0]=1;\n\tfor(re int i=head[x];i;i=e[i].nxt)\n\t{\n\t\tint y=e[i].to;\n\t\tif(y==fa)continue;\n\t\tdfs(y,x);\n\t\tfor(re int j=0;j<=min(size[x],m);j++)\n\t\t{\n\t\t\tg[j][0][0]=f[x][j][0][0],f[x][j][0][0]=0;\n\t\t\tg[j][1][0]=f[x][j][1][0],f[x][j][1][0]=0;\n\t\t\tg[j][0][1]=f[x][j][0][1],f[x][j][0][1]=0;\n\t\t\tg[j][1][1]=f[x][j][1][1],f[x][j][1][1]=0;\n\t\t}\n\t\tfor(re int j=0;j<=min(size[x],m);j++)\n\t\t\tfor(re int k=0;k<=min(size[y],m-j);k++)\n\t\t\t{\n\t\t\t\tf[x][j+k][0][0]=(f[x][j+k][0][0]+1ll*g[j][0][0]*f[y][k][0][1])%mod;\n\t\t\t\tf[x][j+k][0][1]=(f[x][j+k][0][1]+1ll*g[j][0][1]*(f[y][k][0][1]+f[y][k][1][1])%mod)%mod;\t\n\t\t\t\tf[x][j+k][0][1]=(f[x][j+k][0][1]+1ll*g[j][0][0]*f[y][k][1][1]%mod)%mod;\n\t\t\t\tf[x][j+k][1][0]=(f[x][j+k][1][0]+1ll*g[j][1][0]*(f[y][k][0][0]+f[y][k][0][1])%mod)%mod;\n\t\t\t\tf[x][j+k][1][1]=(f[x][j+k][1][1]+1ll*g[j][1][0]*(f[y][k][1][0]+f[y][k][1][1])%mod)%mod;\n\t\t\t\tf[x][j+k][1][1]=(f[x][j+k][1][1]+1ll*g[j][1][1]*(f[y][k][0][0]+f[y][k][0][1])%mod)%mod;\n\t\t\t\tf[x][j+k][1][1]=(f[x][j+k][1][1]+1ll*g[j][1][1]*(f[y][k][1][0]+f[y][k][1][1])%mod)%mod;\n\t\t\t}\n\t\tsize[x]+=size[y];\t\n\t}\n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\tfor(re int i=1;i<n;i++)\n\t{\n\t\tint u,v;scanf(\"%d%d\",&u,&v);\n\t\tadd(u,v);add(v,u);\n\t}\n\tdfs(1,0);\n\tprintf(\"%d\",(f[1][m][0][1]+f[1][m][1][1])%mod);\n\treturn 0;\n}\n```\n",
        "postTime": 1569310933,
        "uid": 145441,
        "name": "nofind",
        "ccfLevel": 6,
        "title": "P4516 [JSOI2018]\u6f5c\u5165\u884c\u52a8(\u6811\u5f62\u80cc\u5305)"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.org/problemnew/show/P4516)\n\n\u6211\u597d\u83dc\u554a\uff0c\u5624\u5624\u5624\n\n\u539f\u6765\u672c\u5730\u8bbf\u95ee\u6570\u7ec4\u8d1f\u4e0b\u6807\u4e0d\u4f1a\u62a5$RE$\u6216\u8005$WA$\uff0c\u751a\u81f3\u80fd\u8dd1\u51fa\u6b63\u89e3\u554a\n\n\u8fd9\u9053\u9898\u8fd8\u662f\u975e\u5e38\u5446\u7684\n\n\u6211\u4eec\u53d1\u73b0$k$\u5f88\u5c0f\uff0c\u4e8e\u662f\u65ad\u5b9a\u8fd9\u662f\u4e00\u4e2a\u6811\u4e0a\u80cc\u5305\n\n\u53d1\u73b0\u5728\u4e00\u4e2a\u70b9\u4e0a\u5b89\u88c5\u63a7\u5236\u5668\u5e76\u4e0d\u80fd\u63a7\u5236\u8fd9\u4e2a\u70b9\uff0c\u53ef\u80fd\u9700\u8981\u5230\u7236\u4eb2\u90a3\u8fb9\u624d\u80fd\u63a7\u5236\u8fd9\u4e2a\u70b9\uff0c\u4e8e\u662f\u6211\u4eec\u8bbe$dp[i][j][0/1][0/1]$\u8868\u793a\u5728\u4ee5$i$\u4e3a\u6839\u7684\u5b50\u6811\u91cc\u653e\u7f6e\u4e86$j$\u4e2a\u76d1\u89c6\u5668\uff0c\u63a7\u5236\u4e86\u9664\u4e86\u70b9$i$\u4ee5\u5916\u7684\u70b9\uff0c\u5728$i$\u70b9\u88c5\u6ca1\u88c5\u63a7\u5236\u5668\uff0c$i$\u70b9\u6709\u6ca1\u6709\u88ab\u63a7\u5236\n\n\u5927\u529b\u5206\u7c7b\u5957\u8bba\u51e0\u4e2a\u8f6c\u79fb\n\n$dp[i][j][0][0]$\u56e0\u4e3a\u6ca1\u6709\u653e\u76d1\u89c6\u5668\uff0c\u5fc5\u987b\u8981\u6c42\u5176\u513f\u5b50\u4eec\u5728\u4ed6\u4eec\u7684\u5b50\u6811\u5185\u90e8\u5c31\u88ab\u76d1\u89c6\u4e86\uff0c\u540c\u65f6\u56e0\u4e3a$i$\u8fd8\u6ca1\u6709\u88ab\u76d1\u89c6\uff0c\u4e8e\u662f\u513f\u5b50\u4e0d\u80fd\u653e\u76d1\u89c6\u5668\uff0c\u4e8e\u662f\u4ece$[0][1]$\u8f6c\u79fb\n\n$dp[i][j][1][0]$\u56e0\u4e3a\u653e\u4e86\u76d1\u89c6\u5668\uff0c\u80fd\u76d1\u89c6\u513f\u5b50\uff0c\u4e8e\u662f\u513f\u5b50\u4eec\u6709\u6ca1\u6709\u88ab\u76d1\u89c6\u90fd\u53ef\u4ee5\uff0c\u4f46\u662f\u90fd\u4e0d\u80fd\u653e\u76d1\u89c6\u5668\uff0c\u4e8e\u662f\u4ece$[0][1]$\u548c$[0][0]$\u8f6c\u79fb\n\n$dp[i][j][0][1]$\u56e0\u4e3a\u6ca1\u6709\u653e\u76d1\u89c6\u5668\uff0c\u513f\u5b50\u4eec\u5fc5\u987b\u5168\u90e8\u88ab\u76d1\u89c6\u5230\u4ece$[0][1]$\u8f6c\u79fb\uff0c\u56e0\u4e3a$i$\u88ab\u76d1\u89c6\uff0c\u6240\u4ee5\u81f3\u5c11\u5f97\u6709\u4e00\u4e2a\u513f\u5b50\u653e\u76d1\u89c6\u5668\uff0c\u6240\u4ee5\u81f3\u5c11\u4e00\u4e2a\u4ece$[1][1]$\u8f6c\u79fb\n\n$dp[i][j][1][1]$\u653e\u4e86\u76d1\u89c6\u5668\uff0c\u800c\u8981\u6c42\u88ab\u76d1\u89c6\uff0c\u4ece\u56db\u79cd\u72b6\u6001\u90fd\u80fd\u8f6c\u79fb\uff0c\u4f46\u662f\u8981\u6c42\u81f3\u5c11\u6709\u4e00\u4e2a\u8f6c\u79fb\u662f$[1][0]$\u6216$[1][1]$\uff08\u653e\u4e86\u76d1\u89c6\u5668\uff09\n\n\u76f4\u63a5\u6811\u5f62\u80cc\u5305\u8f6c\u79fb\uff0c\u4e4b\u540e\u5927\u529b\u5bb9\u65a5\u6389\u6ca1\u6709\u9009\u62e9\u90a3\u4e2a\u81f3\u5c11\u8981\u9009\u62e9\u7684\u60c5\u51b5\u5c31\u597d\u4e86\n\n\u53d1\u73b0$dp[i][j][0][1]$\u8981\u51cf\u6389\u7684\u6b63\u597d\u662f$dp[i][j][0][0]$\uff0c$dp[i][j][1][1]$\u8981\u51cf\u6389\u7684\u6b63\u597d\u662f$dp[i][j][1][0]$\n\n\u4ee3\u7801\n\n```cpp\n#include<algorithm>\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#define re register\n#define LL long long\n#define max(a,b) ((a)>(b)?(a):(b))\n#define min(a,b) ((a)<(b)?(a):(b))\nconst int maxn=1e5+5;\nconst int mod=1e9+7;\ninline int read() {\n\tchar c=getchar();int x=0;while(c<'0'||c>'9') c=getchar();\n\twhile(c>='0'&&c<='9') x=(x<<3)+(x<<1)+c-48,c=getchar();return x;\n}\nstruct E{int v,nxt;}e[maxn<<1];\nint head[maxn],sum[maxn];\nint dp[maxn][105][2][2];\nint f[105][2][2];\nint n,m,num;\ninline void add(int x,int y) {e[++num].v=y;e[num].nxt=head[x];head[x]=num;}\ninline int qm(int a) {return a>mod?a-mod:a;}\nvoid dfs(int x,int fa) {\n\tint cur=0;\n\tsum[x]=1;\n\tfor(re int i=head[x];i;i=e[i].nxt) {\n\t\tif(e[i].v==fa) continue;\n\t\tint v=e[i].v;\n\t\tdfs(v,x);cur++;\n\t\tsum[x]+=sum[v];\n\t\tint U=min(sum[x],m);\n\t\tif(cur==1) {\n\t\t\tfor(re int k=0;k<=min(sum[v],m);k++) {\n\t\t\t\tdp[x][k][0][0]=dp[v][k][0][1];\n\t\t\t\tdp[x][k+1][1][0]=qm(dp[v][k][0][1]+dp[v][k][0][0]);\n\t\t\t\tdp[x][k+1][1][1]=(dp[v][k][1][1]+dp[v][k][1][0])%mod+(dp[v][k][0][0]+dp[v][k][0][1])%mod;\n\t\t\t\tdp[x][k+1][1][1]%=mod;\n\t\t\t\tdp[x][k][0][1]=qm(dp[v][k][1][1]+dp[v][k][0][1]);\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tfor(re int j=U;j>=0;--j) {\n\t\t\tf[j][0][0]=dp[x][j][0][0],dp[x][j][0][0]=0;\n\t\t\tf[j][0][1]=dp[x][j][0][1],dp[x][j][0][1]=0;\n\t\t\tf[j][1][0]=dp[x][j][1][0],dp[x][j][1][0]=0;\n\t\t\tf[j][1][1]=dp[x][j][1][1],dp[x][j][1][1]=0;\n\t\t}\n\t\tfor(re int j=U;j>=0;--j) \t\n\t\t\tfor(re int k=0;k<=min(sum[v],m);k++) {\n\t\t\t\tint t=j-k;\n\t\t\t\tif(t<0) continue;\n\t\t\t\tdp[x][j][0][0]=(dp[x][j][0][0]+1ll*f[t][0][0]*dp[v][k][0][1]%mod)%mod;\n\t\t\t\tdp[x][j][1][0]=(dp[x][j][1][0]+1ll*f[t][1][0]*qm(dp[v][k][0][1]+dp[v][k][0][0])%mod)%mod;\n\t\t\t\tdp[x][j][0][1]=(dp[x][j][0][1]+1ll*f[t][0][1]*qm(dp[v][k][1][1]+dp[v][k][0][1])%mod)%mod;\n\t\t\t\tdp[x][j][1][1]=(dp[x][j][1][1]+1ll*f[t][1][1]*qm(qm(dp[v][k][1][1]+dp[v][k][1][0])+qm(dp[v][k][0][0]+dp[v][k][0][1]))%mod)%mod;\n\t\t\t}\n\t}\n\tif(!cur) {dp[x][0][0][0]=dp[x][1][1][0]=1;return;}\n\tfor(re int j=0;j<=min(sum[x],m);j++)\n\t\tdp[x][j][0][1]=(dp[x][j][0][1]-dp[x][j][0][0]+mod)%mod,\n\t\tdp[x][j][1][1]=(dp[x][j][1][1]-dp[x][j][1][0]+mod)%mod;\n}\nint main() {\n\tn=read();m=read();\n\tfor(re int x,y,i=1;i<n;i++)\n\t\tx=read(),y=read(),add(x,y),add(y,x);\n\tdfs(1,0);\n\tprintf(\"%d\\n\",(dp[1][m][0][1]+dp[1][m][1][1])%mod);\n\treturn 0;\n}\n```\n",
        "postTime": 1554198365,
        "uid": 35178,
        "name": "asuldb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011"
    },
    {
        "content": "\u8bb2\u771f\uff0c\u66b4\u529b\u7684\u505a\u6cd5\u60f3\u4e5f\u60f3\u5230\u4e86\uff0c\u5c31\u662f\u6ca1\u6562\u6253...\uff08\u56e0\u4e3a\u6211\u770b\u5230\u4e86\u6807\u7b7e\u662f\u9ed1\u8272\u7684\u554a\uff01\uff09\n\n\n\u590d\u6742\u5ea6 $n\u00b7k^2$ \uff1f \u7136\u540e\u7384\u5b66 AC \uff1f \u6211\u662f\u6709\u70b9\u61f5\u7684\uff08\u5176\u5b9e\u72b6\u6001\u4e5f\u8bbe\u8ba1\u597d\u4e86\u5c31\u662f\u6ca1\u6709\u60f3\u8f6c\u79fb\uff09\n\n\u7136\u9e45\u672c\u6765\u6211\u662f\u8981\u6253\u94fe\u8868\u7684\uff0c\u8c8c\u4f3c\u4e5f\u662f\u65f6\u95f4\u4e0d\u5982 vector \u8fc7\u4e0d\u4e86...\u603b\u4e4b\u5c31\u662f\u6ca1 A \n\n\n-----\n\n\u8fd9\u9053\uff08\u5047\uff09\u9898\u5176\u5b9e\u5c31\u662f\u4e2a\u6811\u5f62dp \uff0c\u8f6c\u79fb\u6bd4\u8f83\u9ebb\u70e6\uff0c\u72b6\u6001\u4e5f\u4e0d\u96be\u8bbe\u8ba1\uff08\u5c31\u662f\u5f00\u6570\u7ec4\u7684\u65f6\u5019\u5c0f\u5fc3\u70b9\uff0c\u5bb9\u6613\u7206...\uff09\n\n\n\u72b6\u6001\u7684\u8bdd\u5c31\u662f\u7528 f[i][j][0/1][0/1] \u8868\u793a i \u53f7\u70b9\u7684\u5b50\u6811\u5185\uff0c\u7528\u4e86 j \u4e2a\u88c5\u7f6e\uff0c i \u53f7\u70b9\u672c\u8eab\u662f\u5426\u5b89\u88c5 0/1 \uff0c\u4e0e\u5b83\u76f4\u63a5\u76f8\u8fde\u7684\u5b69\u5b50\u6709\u6ca1\u6709\u5b89\u88c5 0/1\uff08\u4e5f\u5c31\u662f\u6709\u6ca1\u6709\u88ab\u7a83\u542c\uff09\n\n\n\u7136\u540e\u601d\u8003\u4e00\u5806\u8f6c\u79fb\u5c31\u597d\u4e86\uff08\u8f6c\u79fb\u8fd8\u662f\u770b\u4ee3\u7801\u5427\uff0c\u4e5f\u4e0d\u96be\u61c2\uff0c\u6253\u7740\u592a\u7d2f...\uff09\n\n\u7136\u540e\u636e\u697c\u4e0a\u6240\u8a00\u4e0d\u8981\u5f00 long long \u4e2d\u95f4\u8fc7\u7a0b\u8f6c\u4e00\u4e0b\u5c31\u597d\u4e86\uff0c\u4e0d\u7136\u4f1a\u70b8\uff08\u6216\u8005\u7528\u9f9f\u901f\u4e58 \uff1f\uff09\n\n\n```\n//by Judge\n#include<vector>\n#include<cstdio>\n#include<iostream>\nusing namespace std;\nconst int mod=1e9+7;\nconst int M=1e5+3;\ntypedef int arr[M];\n#ifndef Judge\n#define getchar() (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\n#endif\nchar buf[1<<21],*p1=buf,*p2=buf;\ninline int Min(int a,int b){return a<b?a:b;}\ninline int Mul(int x,int y){return 1ll*x*y%mod;}\ninline void ADD(int& a,int b){a+=a+b>=mod?b-mod:b;}\ninline int Inc(int x,int y){return x+y>=mod?x+y-mod:x+y;}\ninline int read(){ int x=0,f=1; char c=getchar();\n\tfor(;!isdigit(c);c=getchar()) if(c=='-') f=-1;\n\tfor(;isdigit(c);c=getchar()) x=x*10+c-'0'; return x*f;\n} int n,K; vector<int> G[M];\nint siz[M],f[M][101][2][2],g[101][2][2]; // \u9009 / , \u8986\u76d6/ \ninline void add(int x,int y){G[x].push_back(y),G[y].push_back(x);}\n#define v G[u][i]\nvoid dfs(int u,int fa){ siz[u]=f[u][0][0][0]=f[u][1][1][0]=1;\n\tfor(int i=G[u].size()-1;i>=0;--i){\n\t\tif(v==fa) continue; dfs(v,u);\n\t\tfor(int j=0,jj=Min(siz[u],K);j<=jj;++j)\n\t\t\tg[j][0][0]=f[u][j][0][0],f[u][j][0][0]=0,\n\t\t\tg[j][0][1]=f[u][j][0][1],f[u][j][0][1]=0,\n\t\t\tg[j][1][0]=f[u][j][1][0],f[u][j][1][0]=0,\n\t\t\tg[j][1][1]=f[u][j][1][1],f[u][j][1][1]=0;\n\t\tfor(int j=0,jj=Min(siz[u],K);j<=jj;++j)\n\t\t\tfor(int k=0,kk=Min(siz[v],K-j);k<=kk;++k)\n\t\t\t\tADD(f[u][j+k][0][0],Mul(g[j][0][0],f[v][k][0][1])),\n\t\t\t\t\n\t\t\t\tADD(f[u][j+k][0][1],Mul(g[j][0][0],f[v][k][1][1])),\n\t\t\t\tADD(f[u][j+k][0][1],Mul(g[j][0][1],Inc(f[v][k][0][1],f[v][k][1][1]))),\n\t\t\t\t\n\t\t\t\tADD(f[u][j+k][1][0],Mul(g[j][1][0],Inc(f[v][k][0][0],f[v][k][0][1]))),\n\t\t\t\t\n\t\t\t\tADD(f[u][j+k][1][1],Mul(g[j][1][0],Inc(f[v][k][1][0],f[v][k][1][1]))),\n\t\t\t\tADD(f[u][j+k][1][1],Mul(g[j][1][1],Inc(f[v][k][0][0],Inc(f[v][k][0][1],Inc(f[v][k][1][0],f[v][k][1][1])))));\n\t\tsiz[u]+=siz[v];\n\t}\n}\n\nint main(){ n=read(),K=read(); for(int i=1,x,y;i<n;++i) x=read(),y=read(),add(x,y);\n\treturn dfs(1,0),!printf(\"%d\\n\",Inc(f[1][K][0][1],f[1][K][1][1]));\n}\n```\n\n\n\n\n",
        "postTime": 1552369901,
        "uid": 38576,
        "name": "J\u03bcdge",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011"
    },
    {
        "content": "[\u6211\u7684\u535a\u5ba2](https://blog.csdn.net/qq_35019468/article/details/102864520)\n\n## \u663e\u7136\u662f\u6811\u5f62DP\n\n#### \u4f46\u662f\u63a8\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5f88\u60f3\u6b7b\u554a\uff01\n\n$\u9996\u5148\u8bf4\u4e00\u4e0bDP[i][j][0/1][0/1]\u8868\u793a\u5728\u6811\u4e0a\u7684i\u70b9\uff0c\u4e00\u5171\u653e\u4e86j\u4e2a\u76d1\u542c\u8bbe\u5907\uff0c\u70b9i\u662f\u5426\u88ab\u8986\u76d6\uff0c\u70b9i\u4e0a\u662f\u5426\u6709\u76d1\u542c\u8bbe\u5907\u65f6\uff0c\u76d1\u542c\u8986\u76d6\u5b8c\u70b9i\u7684\u5b50\u6811\uff08\u4e0d\u5305\u62eci\uff09\u6709\u591a\u5c11\u79cd\u65b9\u6848$\u3002\n\n$\u663e\u7136\u6211\u4eec\u5728dfs\u4e2d\u66f4\u65b0\u65f6\uff0c\u662f\u4ece\u513f\u5b50\u66f4\u65b0\u7236\u4eb2\uff0c\u6240\u4ee5\u4e0a\u9762\u6307\u7684\u8986\u76d6\u662f\u6307\u513f\u5b50\u5bf9\u7236\u4eb2\u7684\u8986\u76d6\u3002\u8fd8\u6709\u6211\u4eec\u9700\u8981\u8bbe\u53e6\u4e00\u4e2a\u6570\u7ec4\u6765DP\uff0c\u8bbe\u90a3\u4e2a\u6570\u7ec4\u4e3adp1$\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u6076\u5fc3\u7684\u56db\u79cd\u60c5\u51b5\u8ba8\u8bba\u4e86\u3002\n\n## \u9996\u5148\uff0c\u5982\u679c\u8fd9\u4e2a\u70b9\u66f4\u65b0\u540e\u662fDP[u][j][0][0]\u3002\n\n\u56e0\u4e3au\u6ca1\u6709\u88ab\u8986\u76d6\uff0c\u6240\u4ee5son\u4e0a\u4e00\u5b9a\u6ca1\u6709\u76d1\u542c\u8bbe\u5907\uff0c\u53c8\u56e0\u4e3a\u9700\u8981\u5b8c\u5168\u8986\u76d6\uff0cu\u4e0d\u53ef\u80fd\u5bf9son\u8fdb\u884c\u8986\u76d6\uff0c\u6240\u4ee5son\u4e00\u5b9a\u8981\u88ab\u8986\u76d6\u3002\n\n```cpp\ndp[u][i+j][0][0]=(dp[u][i+j][0][0]+(dp1[i][0][0]*1ll*dp[v][j][1][0])%mod)%mod;\n```\n\n## \u5982\u679c\u662fDP[u][j][0][1]\u3002\n \n\u56e0\u4e3au\u6ca1\u6709\u88ab\u8986\u76d6\uff0c\u6240\u4ee5son\u4e0a\u4e00\u5b9a\u6ca1\u6709\u76d1\u542c\u8bbe\u5907\uff0c\u53c8\u56e0\u4e3au\u4e0a\u6709\u76d1\u542c\u8bbe\u5907\uff0c\u6240\u4ee5son\u6709\u6ca1\u6709\u88ab\u8986\u76d6\u90fd\u884c\u3002\n\n```cpp\ndp[u][i+j][0][1]=(dp[u][i+j][0][1]+(dp1[i][0][1]*1ll*(dp[v][j][1][0]+dp[v][j][0][0])%mod)%mod)%mod;\n```\n\n## \u5982\u679c\u662fDP[u][j][1][0]\u3002\n\n\u56e0\u4e3au\u88ab\u8986\u76d6\u4e86\uff0c\u6240\u4ee5u\u7684\u66f4\u65b0\u4e4b\u524d\u7684\u72b6\u6001\u6709\u53ef\u80fd\u6ca1\u6709\u88ab\u8986\u76d6\uff0c\u6216\u8005\u88ab\u8986\u76d6\u4e86\uff0c\u6240\u4ee5dp\u53ef\u4ee5\u7531\u4e24\u79cd\u66f4\u65b0\u524d\u7684\u72b6\u6001\uff080,0\uff09\u6216\uff081,0\uff09\u66f4\u65b0\u3002\n\n1.\u7531\uff080,0\uff09\u66f4\u65b0\u8fc7\u6765\n\n\u8fd9\u6837\u7684\u8bdd\uff0c\u56e0\u4e3a\u6700\u7ec8\u72b6\u6001\u8981\u6c42\u88ab\u8986\u76d6\uff0c\u6240\u4ee5son\u4e0a\u5fc5\u987b\u8981\u6709\u76d1\u542c\u8bbe\u5907\uff0c\u53c8\u56e0\u4e3au\u4e0d\u80fd\u5bf9son\u8fdb\u884c\u8986\u76d6\uff0c\u6240\u4ee5son\u4e00\u5b9a\u8981\u88ab\u8986\u76d6\u3002\n\n2.\u7531\uff081,0\uff09\u66f4\u65b0\u8fc7\u6765\n\n\u540c\u7406\uff0c\u56e0\u4e3au\u4e4b\u524d\u5df2\u7ecf\u88ab\u8986\u76d6\u4e86\uff0c\u6240\u4ee5son\u4e0a\u6709\u6ca1\u6709\u76d1\u542c\u8bbe\u5907\u90fd\u53ef\u4ee5\uff0c\u53c8\u56e0\u4e3au\u4e0d\u80fd\u5bf9son\u8fdb\u884c\u8986\u76d6\uff0c\u6240\u4ee5son\u4e00\u5b9a\u8981\u88ab\u8986\u76d6\u3002\n\n```cpp\ndp[u][i+j][1][0]=(dp[u][i+j][1][0]+((dp1[i][0][0]*1ll*dp[v][j][1][1])%mod+0ll+(dp1[i][1][0]*1ll*(dp[v][j][1][0]+dp[v][j][1][1])%mod)%mod)%mod)%mod;\n```\n\n## \u5982\u679c\u662fDP[u][j][1][1]\u3002\n\n\u50cf\u4e0a\u79cd\u60c5\u51b5\u4e00\u6837\uff0c\u8fd9\u79cd\u7684dp\u4e5f\u53ef\u4ee5\u53c8\u4e24\u79cd\u66f4\u65b0\u524d\u7684\u72b6\u6001\uff080,1\uff09\u6216\uff081,1\uff09\n\n1.\u7531\uff080,1\uff09\u66f4\u65b0\u8fc7\u6765\n\n\u56e0\u4e3au\u4e0a\u6709\u76d1\u542c\u8bbe\u5907\uff0c\u6240\u4ee5son\u4e0a\u6709\u6ca1\u6709\u88ab\u8986\u76d6\u90fd\u53ef\u4ee5\uff0c\u53c8\u56e0\u4e3au\u6ca1\u6709\u88ab\u8986\u76d6\uff08\u72b6\u6001\u4e0a\u8981\u6c42\u88ab\u8986\u76d6\uff09\uff0c\u6240\u4ee5son\u4e0a\u6709\u76d1\u542c\u8bbe\u5907\u3002\n\n2.\u7531\uff081,1\uff09\u66f4\u65b0\u8fc7\u6765\n\n\u540c\u7406\uff0c\u4e0d\u8fc7\u8fd9\u6b21u\u5df2\u7ecf\u88ab\u8986\u76d6\u4e86\uff0c\u6240\u4ee5son\u4e0a\u6709\u6ca1\u6709\u76d1\u542c\u8bbe\u5907\u90fd\u53ef\u4ee5\u3002\n\n```cpp\ndp[u][i+j][1][1]=(dp[u][i+j][1][1]+(dp1[i][0][1]*1ll*(dp[v][j][1][1]+dp[v][j][0][1])%mod)%mod+0ll+(dp1[i][1][1]*1ll*((((dp[v][j][1][0]+dp[v][j][1][1])%mod+dp[v][j][0][0])%mod+dp[v][j][0][1])%mod)%mod)%mod)%mod;\n```\n\n\u7efc\u4e0a\uff0c\u56db\u79cd\u60c5\u51b5\u7684\u5206\u7c7b\u8ba8\u8bba\u5df2\u7ecf\u5b8c\u6bd5\uff0c\u7a0b\u5e8f\u4e3b\u4f53\u4e5f\u5199\u51fa\u6765\u4e86\u3002\n\n\u4e24\u4e2a\u521d\u59cb\u5316\uff1a\n\n```cpp\ndp[u][0][0][0]=dp[u][1][0][1]=1;\n```\n\n```cpp\n#include<bits/stdc++.h>\n#define mod 1000000007\n#define N 100010\n#define M 110\nusing namespace std;\nint n,m,to[N<<1],nxt[N<<1],head[N],cnt,size[N],x,y,dp[N][M][2][2],dp1[M][2][2];//\u54ea\u4e00\u4e2a\u70b9\uff0c\u5b50\u6811\u653e\u4e86\u51e0\u4e2a\uff0cu\u662f\u5426\u8986\u76d6\uff0cu\u662f\u5426\u653e\nvoid adde(int x,int y)\n{\n\tto[++cnt]=y;\n\tnxt[cnt]=head[x];\n\thead[x]=cnt;\n}\nvoid dfs(int u,int fa)\n{\n\tsize[u]=1;\n\tdp[u][0][0][0]=dp[u][1][0][1]=1;\n\tfor(int k=head[u];k;k=nxt[k])\n\t{\n\t\tint v=to[k];\n\t\tif(v!=fa)\n\t\t{\n\t\t\tdfs(v,u);\n\t\t\tfor(int i=0;i<=m;i++)\n\t\t\t{\n\t\t\t\tdp1[i][0][0]=dp[u][i][0][0];\n\t\t\t\tdp[u][i][0][0]=0;\n\t\t\t\tdp1[i][1][0]=dp[u][i][1][0];\n\t\t\t\tdp[u][i][1][0]=0;\n\t\t\t\tdp1[i][0][1]=dp[u][i][0][1];\n\t\t\t\tdp[u][i][0][1]=0;\n\t\t\t\tdp1[i][1][1]=dp[u][i][1][1];\n\t\t\t\tdp[u][i][1][1]=0;\n\t\t\t}\n\t\t\tfor(int i=0;i<=min(size[u],m);i++)\n\t\t\t{\n\t\t\t\tfor(int j=0;j<=min(size[v],m-i);j++)\n\t\t\t\t{\n\t\t\t\t\tdp[u][i+j][0][0]=(dp[u][i+j][0][0]+(dp1[i][0][0]*1ll*dp[v][j][1][0])%mod)%mod;\n\t\t\t\t\tdp[u][i+j][0][1]=(dp[u][i+j][0][1]+(dp1[i][0][1]*1ll*(dp[v][j][1][0]+dp[v][j][0][0])%mod)%mod)%mod;\n\t\t\t\t\tdp[u][i+j][1][0]=(dp[u][i+j][1][0]+((dp1[i][0][0]*1ll*dp[v][j][1][1])%mod+0ll+(dp1[i][1][0]*1ll*(dp[v][j][1][0]+dp[v][j][1][1])%mod)%mod)%mod)%mod;\n\t\t\t\t\tdp[u][i+j][1][1]=(dp[u][i+j][1][1]+(dp1[i][0][1]*1ll*(dp[v][j][1][1]+dp[v][j][0][1])%mod)%mod+0ll+(dp1[i][1][1]*1ll*((((dp[v][j][1][0]+dp[v][j][1][1])%mod+dp[v][j][0][0])%mod+dp[v][j][0][1])%mod)%mod)%mod)%mod;\n\t\t\t\t}\n\t\t\t}\n\t\t\tsize[u]+=size[v];\n\t\t}\n\t}\n}\nint main()\n{\n//\tfreopen(\"1.txt\",\"r\",stdin);\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tadde(x,y);\n\t\tadde(y,x);\n\t}\n\tdfs(1,-1);\n\tprintf(\"%d\\n\",(dp[1][m][1][0]+dp[1][m][1][1])%mod);\n\treturn 0;\n}\n```\n\n## \u9644\uff1a\u597d\u50cfDP\u5f00long long\u5c31\u4f1a\u7206\u7a7a\u95f4\uff0c\u6240\u4ee5\u597d\u597d\u5199mod\u5427\uff01\uff01\uff01",
        "postTime": 1572614669,
        "uid": 103334,
        "name": "Honor\u8a89",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4516 \u3010[JSOI2018]\u6f5c\u5165\u884c\u52a8\u3011"
    }
]
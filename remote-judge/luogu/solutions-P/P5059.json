[
    {
        "content": "\u672c\u9898\u6570\u636e\u89c4\u6a21\u8f83\u5927\uff0c\u5bb9\u6613\u770b\u51fa\u8fd9\u662f\u4e00\u9053\u6570\u5b66\u9898\uff0c\u6709\u4e00\u4e2a\u5751\u70b9\uff0c\u5c31\u662f\u683c\u70b9\u4e0e\u683c\u5b50\u5e76\u4e0d\u662f\u4e00\u4e2a\u4e1c\u897f\uff0c\u6709\u6ca1\u6709\u6389\u5751\u5462 $QwQ$\n\n\u7136\u540e\u5c31\u662f\u5bf9\u672c\u9898\u7684\u89e3\u51b3\u4e86\n\n\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u6bcf\u4e00\u884c\u662f\u72ec\u7acb\u7684\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u5904\u7406\u4e00\u884c\u7684\u7b54\u6848\u5373\u53ef\n\n\u8bbe $F[i][0]$ \u8868\u793a\u4e00\u884c\u4e2d\u6446\u4e86 $i$ \u4e2a\u4f4d\u7f6e\u4e14\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u4e0d\u6446\u653e\u68cb\u5b50\u7684\u65b9\u6848\u6570\n\n\u8bbe $F[i][1]$ \u8868\u793a\u4e00\u884c\u4e2d\u6446\u4e86 $i$ \u4e2a\u4f4d\u7f6e\u4e14\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u6446\u653e\u68cb\u5b50\u7684\u65b9\u6848\u6570\n\n\u8bbe $Ans[i]$ \u8868\u793a $F[i][0]+F[i][1]$ \n\n\u90a3\u4e48\u5ffd\u7565\u7b2c\u4e8c\u4e2a\u9650\u5236\u53ef\u4ee5\u53d1\u73b0\u6709:\n\n$F[i][0]=F[i-1][0]+F[i-1][1]$  \n\n$F[i][1]=F[i-1][0]$\n\n\u6240\u4ee5\u6709 \n\n$Ans[i]$\n\n$=F[i][0]+F[i][1]$\n\n$=2F[i-1][0]+F[i-1][1]$\n\n$=(F[i-1][0]+F[i-1][1])+(F[i-2][0]+F[i-2][1])$\n\t\t\n$=Ans[i-1]+Ans[i-2]$\n\n\u521d\u59cb\u6761\u4ef6\uff1a$Ans[1]=2,Ans[2]=3$\n\n\u53ef\u4ee5\u53d1\u73b0\u8fd9\u5c31\u662f $Fibonacci$ \u6570\u5217\uff1a$Ans[i]=Fib[i+2]$\n\n\u63a5\u7740\u8fdb\u884c\u62d3\u5c55\uff0c\u7531\u4e8e\u5b58\u5728\u7b2c\u4e8c\u4e2a\u9650\u5236\uff0c\u4ec5\u4ec5\u6446\u4e86\u4e00\u4e2a\u68cb\u5b50\u7684\u65b9\u6848\u4ee5\u53ca\u6ca1\u6709\u68cb\u5b50\u7684\u65b9\u6848\u4e0d\u5408\u6cd5\uff0c\u9700\u8981\u51cf\u53bb $(i+1)$\n\n\u6240\u4ee5\u6700\u7ec8\u7b54\u6848\u662f $Fib[N+3]-N-2$ $(N$\u5373\u662f\u9898\u76ee\u4e2d\u7684\u542b\u4e49$)$\n\n\u63a5\u7740\u4fbf\u53ef\u4ee5\u4f7f\u7528\u77e9\u9635\u5feb\u901f\u5e42\u5728 $O(log_2N)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u6c42\u51fa\u7b54\u6848\n\n\u6700\u540e\u518d\u4f7f\u7528\u5feb\u901f\u5e42\u7b97\u51fa\u6574\u4e2a\u68cb\u76d8\u7684\u65b9\u6848\u6570\u5c31\u597d\u5566\n\n$Code:$\n```\n#include<iostream>\n#include<cstdio>\n#include<cstring> \nusing namespace std;\nstruct Martrix\n{\n\tlong long f[2][2];\n}ans,mat;\nlong long n,p,temp[2][2];\ninline long long multiply(long long a,long long b)\n{\n\tlong long x=a,y=b,tmp=0;\n\twhile(y)\n\t{\n\t\tif(y&1)\n\t\t\ttmp=(tmp+x)%p;\n\t\tx=(x*2)%p;\n\t\ty>>=1;\n\t}\n\treturn tmp;\n}\n\nlong long qpow(long long a,long long b)\n{\n\tlong long tmp=1;\n\twhile(b)\n\t{\n        if(b&1)\n\t\t\ttmp=multiply(tmp,a);\n        a=multiply(a,a);\n\t\tb>>=1;\n    }\n    return tmp;\n}\n\nvoid mat_mul(Martrix &q,Martrix &w)\n{\n\tmemset(temp,0,sizeof(temp));\n\tfor(int i=0;i<=1;i++)\n\t\tfor(int j=0;j<=1;j++)\n\t\t\tfor(int k=0;k<=1;k++)\n\t\t\t\ttemp[i][j]=(temp[i][j]+multiply(q.f[i][k],w.f[k][j]))%p;\n\tmemcpy(q.f,temp,sizeof(temp));\n}\n\nlong long fib(long long a)\n{\n\twhile(a)\n\t{\n\t\tif(a&1)\n\t\t\tmat_mul(ans,mat);\n\t\ta>>=1;\n\t\tmat_mul(mat,mat);\n\t}\n\treturn ans.f[0][0];\n}\n\n\nint main()\n{\n\tans.f[0][0]=ans.f[1][1]=mat.f[0][1]=mat.f[1][0]=mat.f[0][0]=1;\n\tscanf(\"%lld%lld\",&n,&p);\n\tprintf(\"%lld\",qpow(((fib(n+2)-n-2)%p+p)%p,n+1));\n\treturn 0;\n} \n```\n\n\n",
        "postTime": 1543676284,
        "uid": 68975,
        "name": "\u5b66\u65e0\u6b62\u5883",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P5059 \u3010\u4e2d\u56fd\u8c61\u68cb\u3011"
    },
    {
        "content": "\u9996\u5148\u4e2d\u56fd\u8c61\u68cb\u662f\u653e\u5728\u683c\u70b9\u4e0a\u7684\uff0c\u6240\u4ee5\u5148 $n \\gets n+1$ \u8f6c\u5316\u4e3a\u653e\u5728\u65b9\u683c\u4e0a\u3002~~\u6837\u4f8b\u56e0\u4e3a\u8fd9\u4e2a\u770b\u4e86\u597d\u4e45\u6ca1\u770b\u61c2~~\n\n\u53c8\u7531\u4e8e\u6bcf\u4e2a\u5352\u53ea\u80fd\u653b\u51fb\u4e0e\u5176\u76f8\u90bb\u7684\u4e24\u4e2a\u5352\uff0c\u6240\u4ee5\u5bb9\u6613\u53d1\u73b0\u884c\u4e0e\u884c\u4e4b\u95f4\u662f\u72ec\u7acb\u7684\uff0c\u6240\u4ee5\u53ea\u8003\u8651\u4e00\u884c\u4e2d\u7684\u60c5\u51b5\u3002\n\n\u5bf9\u4e8e\u6bcf\u884c\u81f3\u5c11\u653e\u4e24\u4e2a\u68cb\u5b50\u7684\u9650\u5236\uff0c\u53ef\u4ee5\u5148\u629b\u5f00\u4e0d\u7ba1\uff0c\u6700\u540e\u51cf\u53bb\u53ea\u653e\u4e00\u4e2a\u6216\u4e0d\u653e\u7684 $n+1$ \u79cd\u60c5\u51b5\u3002\n\n\u8bbe $dp_{i,1/0}$ \u8868\u793a\u5728\u5f53\u524d\u884c\u4e2d\u8003\u8651\u5230\u7b2c $i$ \u4f4d\uff0c\u7b2c $i$ \u4f4d\u653e\u6216\u4e0d\u653e\u7684\u65b9\u6848\u6570\uff0c\u7531\u4e8e\u4e0d\u80fd\u6709\u76f8\u90bb\u7684\u4e24\u4e2a\u5352\uff0c\u4e8e\u662f\u53ef\u4ee5\u5f97\u5230\u5982\u4e0b\u8f6c\u79fb\uff1a\n\n$$\n\\begin{aligned}\n&dp_{i,1}=dp_{i-1,0}\\\\\n&dp_{i,0}=dp_{i-1,1}+dp_{i-1,0}\\\\\n\\end{aligned}\n$$\n\n\u56e0\u4e3a $N \\leq 10^{18}$\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u77e9\u9635\u52a0\u901f $\\text{dp}$\u3002\n\n$$\\begin{vmatrix}dp_{i-1,0}&dp_{i-1,1}\\end{vmatrix}\\begin{vmatrix}1&1\\\\1&0\\end{vmatrix}=\\begin{vmatrix}dp_{i,0}&dp_{i,1}\\end{vmatrix}$$\n\n\u6c42\u51fa\u6bcf\u4e00\u884c\u7684\u65b9\u6848\u4ee5\u540e\uff0c\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\u603b\u65b9\u6848\u6570\u4e3a\u6bcf\u884c\u7684\u65b9\u6848\u6570\u4e4b\u79ef\u3002\n\n\u8ba1\u7b97\u8fc7\u7a0b\u53ef\u80fd\u7206 $\\text{long long}$\uff0c\u8981\u5f00 $\\text{int128}$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(8 \\log n)$\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define ll long long\nconst ll SIZE = 200005;\nll n, mod;\n\ninline ll rd(){\n\tll f = 1, x = 0;\n\tchar ch = getchar();\n\twhile(ch < '0' || ch > '9'){\n\t\tif(ch == '-') f = -1;\n\t\tch = getchar();\n\t}\n\twhile(ch >= '0' && ch <= '9'){\n\t\tx = (x << 1) + (x << 3) + (ch ^ 48);\n\t\tch = getchar();\n\t}\n\treturn f*x;\n}\n\ninline void wt(ll x) {\n\tif(x<0) {\n\t\tputchar('-');\n\t\tx=-x;\n\t}\n\tif(x>9)\n\t\twt(x/10);\n\tputchar(x%10+'0');\n}\n\nstruct node{\n\tll o[2][2];\n\tnode(){\n\t\tfor(ll i = 0; i < 2; i++)\n\t\t\tfor(ll j = 0; j < 2; j++)\n\t\t\t\to[i][j] = 0;\n\t}\n};\n\nnode mul(node A, node B){\n\tnode jl;\n\tfor(ll i = 0; i < 2; i++)\n\t\tfor(ll j = 0; j < 2; j++)\n\t\t\tfor(ll k = 0; k < 2; k++)\n\t\t\t\tjl.o[i][j] = (jl.o[i][j] + ((__int128)A.o[i][k] * B.o[k][j] % mod)) % mod;\t\n\treturn jl;\n}\n\nnode power(node x, ll y){\n\tnode jl;\n\tfor(ll i = 0; i < 2; i++) jl.o[i][i] = 1;\n\twhile(y){\n\t\tif(y&1) jl = mul(jl, x);\n\t\tx = mul(x, x);\n\t\ty >>= 1;\n\t}\n\treturn jl;\n}\n\nll power(ll x, ll y){\n\tll jl = 1;\n\twhile(y){\n\t\tif(y&1) jl = ((__int128)jl *  x) % mod;\n\t\tx = ((__int128)x * x) % mod;\n\t\ty >>= 1;\n\t}\t\n\treturn jl;\n}\n\nint main(){\n\tn = rd()+1, mod = rd();\n\tif(n <= 2){\n\t\tprintf(\"0\");\n\t\treturn 0;\n\t}\n\tnode ans;\n\tans.o[0][0] = ans.o[0][1] = ans.o[1][0] = 1; ans.o[1][1] = 0;\n\tans = power(ans, n-1);\n\tll jl = ((ans.o[0][0] + ans.o[0][1])%mod + (ans.o[1][0] + ans.o[1][1])%mod)%mod;\n\tjl = ((jl - n - 1) % mod + mod) % mod;\n\twt(power(jl, n));\n\treturn 0;\n}\n```\n",
        "postTime": 1668737022,
        "uid": 271096,
        "name": "Semorius",
        "ccfLevel": 7,
        "title": "P5059 \u4e2d\u56fd\u8c61\u68cb"
    },
    {
        "content": "\u8fd9\u7bc7\u9898\u89e3\u4fa7\u91cd\u4ecb\u7ecd\u4e0d\u8003\u8651\u6446\u653e\u6570\u91cf\u7684\u9650\u5236\u65f6\uff0c\u7b54\u6848\u4e3a\u4f55\u4e3a\u6590\u6ce2\u90a3\u5951\u5e8f\u5217\u3002\u5f53\u7136\uff0c\u89e3\u9898\u7684\u5176\u4ed6\u6b65\u9aa4\u4e5f\u4e0d\u4f1a\u5ffd\u7565\u3002\n\n------------\n\n\u9996\u5148\u663e\u7136\u6bcf\u4e00\u884c\u76f8\u4e92\u72ec\u7acb\uff0c\u8bbe\u4e00\u884c\u7684\u65b9\u6848\u4e3a $x$\uff0c\u5219\u7b54\u6848\u663e\u7136\u4e3a $x^n$\u3002\n\n\u5148\u4e0d\u8003\u8651\u6446\u653e\u6570\u91cf\u7684\u9650\u5236\u3002\u4e0d\u59a8\u5c06\u603b\u6446\u653e\u7684\u65b9\u6848\u6309\u6700\u540e\u4e00\u4e2a\u6446\u653e\u4f4d\u7f6e\u8fdb\u884c\u5206\u7c7b\u3002\u8bbe\u6700\u540e\u4e00\u4e2a\u68cb\u5b50\u5728\u4f4d\u7f6e $i$ \u7684\u65b9\u6848\u6570\u4e3a $g_i$\uff0c\u6709\uff1a\n\n$$\ng_i=1+\\sum_{k=0}^{i-2}g_k\n$$\n\n\u8868\u793a\u679a\u4e3e\u9664\u53bb $i$ \u7684\u6700\u540e\u4e00\u4e2a\u68cb\u5b50\u7684\u4f4d\u7f6e $k$\uff0c\u5e76\u6700\u540e\u52a0\u4e0a\u53ea\u6709\u5355\u72ec $i$ \u4e00\u4e2a\u68cb\u5b50\u7684\u65b9\u6848\u3002\n\n\u8bbe $g$ \u7684\u524d\u7f00\u548c\u4e3a $S$\uff0c\u5373 $S_i=\\sum_{k\\leqslant i}a_i$\u3002\u56e0 $S_{i-2}=S_{i-3}+g_{i-2}$\uff0c\u6545\u6709\uff1a\n\n$$\ng_{i}=1+S_{i-2}=(S_{i-3}+1)+g_{i-2}=g_{i-1}+g_{i-2}\n$$\n\n\u8fb9\u754c\u663e\u7136\u4e3a $g_0=0,g_1=1$\u3002\u4e8e\u662f\u8fd9\u5c31\u662f\u4e00\u4e2a\u6807\u51c6\u7684 $\\rm Fibonacci$ \u5e8f\u5217\u3002\n\n\u5728\u4e0d\u8003\u8651\u6446\u653e\u68cb\u5b50\u6570\u91cf\u7684\u9650\u5236\u65f6\uff0c\u6700\u7ec8\u7b54\u6848\u663e\u7136\u4e3a $S_{n}+1$\uff0c\u5373\u5bf9\u4ee5\u4e0d\u540c\u4f4d\u7f6e\u7ed3\u5c3e\u7684\u6446\u653e\u65b9\u6848\u8fdb\u884c\u6c42\u548c\uff0c\u5e76\u52a0\u4e0a\u4e00\u4e2a\u68cb\u5b50\u4e5f\u4e0d\u653e\u7684\u60c5\u51b5\u3002\u8bbe $f_n=S_{n}+1$\uff0c\u4e0d\u59a8\u5148\u628a $g$ \u548c $S$ \u7684\u8868\u6253\u51fa\u6765\u3002\n\n$$\n\\begin{matrix}\n\\,\\,n=&1&2&3&4&5&6&7\\\\\ng_n=&1&1&2&3&5&8&13\\\\\nf_n=&2&3&5&8&13&21&34\n\\end{matrix}\n$$\n\n\u771f\u662f\u592a\u795e\u5947\u4e86\uff0c$f$ \u5c45\u7136\u4e5f\u662f\u4e00\u4e2a\u780d\u6389\u4e86\u524d\u4e24\u4f4d\u7684 $\\rm Fibonacci$ \u5e8f\u5217\u3002\u600e\u4e48\u56de\u4e8b\u5462\uff1f\u4e0b\u9762\u5c31\u6765\u89e3\u91ca\u8fd9\u4e2a\u7ed3\u679c\u3002\n\n\u8003\u8651\u8bbe $G(z)=\\sum\\limits_{k=0}^{\\infty}g_kz^k$ \u4e3a\u5e8f\u5217 $f$ \u7684\u751f\u6210\u51fd\u6570\uff0c\u5176\u4e2d\u4ee4 $g<0$ \u7684 $f_{k}$ \u5747\u4e3a $0$\u3002\u6839\u636e $g$ \u7684\u9012\u5f52\u5173\u7cfb $g_n=g_{n-1}+g_{n-2}+[n=1]$\uff0c\u663e\u7136\u6709\uff1a\n\n$$\nG(z)=\\sum\\limits_{k=0}^{\\infty}g_kz^k=\\sum_{k=0}^{\\infty}g_{k-1}z^{k}+\\sum_{k=0}^{\\infty}g_{k-2}z^{k}+\\sum_{k=0}^{\\infty}[n=1]z^k\n$$\n\n$$\n=\\sum_{k=0}^{\\infty}g_{k}z^{k+1}+\\sum_{k=0}^{\\infty}g_{k}z^{k+2}+z\n$$\n\n$$\n=zG(z)+z^2G(z)+z\n$$\n\n\u89e3\u5f97\uff1a\n\n$$\nG(z)=\\frac{z}{1-z-z^2}\n$$\n\n\u6211\u4eec\u8bbe $F_1(z)$ \u4e3a $S_{n}+1$ \u7684\u751f\u6210\u51fd\u6570\uff0c$F_2(z)$ \u4e3a $g_{n+2}$ \u7684\u751f\u6210\u51fd\u6570\u3002\u6839\u636e\u524d\u9762\u6253\u51fa\u7684\u90a3\u5f20\u8868\uff0c\u8fd9\u4e24\u4e2a\u4e1c\u897f\u5e94\u8be5\u662f\u76f8\u7b49\u7684\u3002\n\n$F_2(z)$ \u662f\u5f88\u5bb9\u6613\u6c42\u51fa\u7684\u3002\u56e0 $g_{n+2}=g_n+g_{n+1}$\uff0c\u6545\uff1a\n\n$$\nF_2(z)=G(z)+\\sum_{k=0}^{\\infty}g_{k+1}z^{k}=G(z)+\\frac{1}{z}\\sum_{k=0}^{\\infty}g_kz^{k}\n$$\n\n$$\n=G(z)+\\frac{1}{z}G(z)\n$$\n\n\u73b0\u5728\u8003\u8651\u6c42 $F_1(z)$\u3002\u5148\u6c42 $S_n$ \u7684\u751f\u6210\u51fd\u6570\uff0c\u6709\u4e2a\u7ecf\u5178\u7ed3\u8bba\u662f $k$ \u7ef4\u524d\u7f00\u548c\u7684\u751f\u6210\u51fd\u6570\u5e94\u5f53\u4e58\u4e0a $\\frac{1}{(1-z)^k}$\uff0c\u5177\u4f53\u6765\u8bf4\uff1a\n\n$$\nS(z)=G(z)\\left(1+z+z^2+z^3+\\cdots\\right)=\\frac{G(z)}{1-z}\n$$\n\n$F_1(z)$ \u5373\u4e3a $G(z)+\\sum\\limits_{k=0}^{\\infty}z^k=G(z)+\\frac{1}{1-z}$\u3002\u5c06 $G(z)$ \u4ee3\u5165\u53ef\u5f97\uff1a\n\n$$\nF_1(z)=\\frac{1}{1-z}\\left(1+\\frac{z}{1-z-z^2}\\right)\n$$\n\n$$\n=\\frac{1}{1-z}\\frac{1-z^2}{1-z-z^2}=\\frac{1+z}{1-z-z^2}\n$$\n\n$$\n=G(z)+\\frac{1}{z}G(z)\n$$\n\n\u5373\u5f97 $F_1(z)=F_2(z)$\u3002\u4ece\u800c\u6211\u4eec\u5c31\u8bc1\u660e\u4e86 $f_n=g_{n+2}$\u3002\n\n\u8fd9\u6837\u5c31\u89e3\u91ca\u4e86 $f$ \u4f5c\u4e3a\u4e00\u4e2a\u780d\u6389\u524d\u4e24\u4f4d\u7684 $\\rm Fibonacci$ \u5e8f\u5217\u7684\u539f\u56e0\u3002\u73b0\u5728\u6211\u4eec\u52a0\u4e0a\u4e86\u9650\u5236\uff0c\u90a3\u4e48\u4e0d\u653e\u68cb\u5b50\u7684\u90a3\u79cd\u60c5\u51b5\u80af\u5b9a\u4e0d\u5408\u6cd5\u4e86\uff0c\u5e76\u4e14\u53ea\u653e\u4e00\u4e2a\u7684\u60c5\u51b5\u4e5f\u4e0d\u5408\u6cd5\u4e86\uff0c\u8fd9\u4e9b\u7684\u6570\u91cf\u4e3a $n+1$\u3002\u5bf9\u4e8e\u6bcf\u4e00\u884c\u6211\u4eec\u53ea\u9700\u5148\u6c42\u51fa $f_n$\uff0c\u7136\u540e\u518d\u51cf\u53bb $n+1$ \u5373\u53ef\u3002\n\n\u6c42 $\\mathit{fib}_n$ \u662f\u4e00\u4e2a\u975e\u5e38\u5178\u7684\u77e9\u9635\u52a0\u901f\uff1a\n\n$$\n(\\mathit{fib}_n,\\mathit{fib}_{n-1})\\begin{pmatrix}1&1\\\\1&0\\end{pmatrix}=(\\mathit{fib}_{n+1},\\mathit{fib}_{n})\n$$\n\n\u76f4\u63a5\u4e0a\u77e9\u9635\u5feb\u901f\u5e42\u5373\u53ef\u3002\u6ce8\u610f\u6a21\u6570\u6700\u5927\u53ef\u4ee5\u5230 $10^{18}$\uff0c\u8981\u7528\u5feb\u901f\u4e58\u3002",
        "postTime": 1667637028,
        "uid": 246979,
        "name": "SalomeJLQ",
        "ccfLevel": 5,
        "title": "P5059 Fib \u524d\u7f00\u548c +1 \u4e3a\u5176\u9519\u4f4d\u7684\u8bc1\u660e"
    },
    {
        "content": "\u4e0d\u5f97\u4e0d\u8bf4\u8fd9\u9898\u7a0d\u6709\u4e9b\u6076\u5fc3\uff0c\n\n\u5148\u662f\u683c\u70b9\uff0c\u63a8\u4e0d\u51fa\u6837\u4f8b\u5361\u4e86\u534a\u5929\n\n\u518d\u662f\u53d6\u6a21\uff0c\u6ca1\u7528\u5feb\u901f\u4e58\u53c8\u7206longlong\n\n\u5feb\u901f\u4e58\u4e4b\u540e\uff0cT\u4e86\u516d\u4e2a\u70b9\uff0c\u8c03\u4e86\u8c03\u4e00\u770b\u5e42\u662f\u8d1f\u7684\n\n\u6c14\u70b8..\n\n---\n\n\u54b3\u54b3\n### \u6b63\u9898\uff1a\n\n\u5982\u679c\u4f60\u505a\u8fc7[P5004 \u4e13\u5fc3OI - \u8df3\u623f\u5b50](https://www.luogu.org/problemnew/show/P5004)\uff0c\u90a3\u662f\u6781\u597d\u7684\n\n$5004$\u8fd9\u9053\u9898$m$=$1$\u7684\u65f6\u5019\uff0c\u8ddf\u8fd9\u9053\u9898\u51e0\u4e4e\u4e00\u6837\uff0c\n\n\u6709\u5174\u8da3\u53ef\u4ee5\u8bd5\u4e00\u8bd5\n\n\u5148\u4e0d\u8bf4\u5b83\n\n\u770b\u8fd9\u9053\u9898\uff0c\u5bb9\u6613\u53d1\u73b0\u884c\u4e0e\u884c\u662f\u72ec\u7acb\u7684\uff0c\u5c31\u662f\u8bf4\u53ea\u8981\u6c42\u51fa\u4e00\u884c\u7684\u65b9\u6848\u6570\uff0c\u7b54\u6848\u5c31\u662f\u5b83\u7684$n$\u6b21\u65b9\u3002\n\n\uff08\u6ce8\uff1a\u672c\u6587\u6240\u6307\u7684\u7684$n$\u90fd\u662f\u4e00\u884c\u6709\u591a\u5c11\u4e2a\u4f4d\u7f6e\uff09\n\n\u6211\u4eec\u4ece\u7b80\u5355\u7684\u8003\u8651,\u5148\u53bb\u6389\"\u6bcf\u884c\u81f3\u5c11\u6709\u4e24\u4e2a\u5352\"\u8fd9\u4e2a\u6761\u4ef6\n\n\u90a3\u4e48\u7b80\u5355\u63a8\u4e00\u63a8\u5c31\u53ef\u4ee5\u53d1\u73b0\uff1a\u8fd9\u662f\u4e2a\u6590\u6ce2\u90a3\u5951\u6570\u5217\uff01\n\n\n\n$n=3: 1+3+1=5$\n\n$n=4: 1+4+2=8$\n\n$n=5: 1+5+(3+2+1)+1=13$\n\n$n=6: 1+6+(4+3+2+1)+(2+1+1)=21$\n\n$n=7: 1+6+(5+4+3+2+1)+((3+2+1)+(2+1)+(1)+(1))+1=34$\n\n.\n\n.\n\n\n\u90a3\u4e48\uff0c\u52a0\u4e0a\u201c\u81f3\u5c11\u6709\u4e24\u4e2a\u5352\u201d\u7684\u6761\u4ef6\u5c31\u662f\u628a\u524d\u9762\u4e24\u9879\u53bb\u6389\u5c31\u597d\u4e86\n\n\u601d\u8def\u5c31\u5f88\u660e\u4e86\u4e86\uff1a\u7b97\u51fa\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7b2cn+1\u9879\uff0c\u51cf\u53bb\u524d\u9762\u4e24\u9879\uff0c\u5373-n-1\uff0c\u7b97\u51fa\u5b83\u7684n\u6b21\u65b9\u8f93\u51fa\n\n\u5662\u5bf9\uff01\n\n\u5173\u4e8e\u6a21\u6570\u6700\u5927\u4e3a1e18\uff0c\u82e5\u76f4\u63a5\u76f8\u4e58\u4f1a\u7206longlong\uff0c\u8fd9\u91cc\u7528\u4e86\u5feb\u901f\u4e58\uff0c\u5f53\u7136\uff0cint28\u4e5f\u53ef\u4ee5\uff0c\u800c\u4e14\u4f1a\u5feb\u3002\n\n\n#### \u5b8c\u6574\u4ee3\u7801\u5949\u4e0a\uff01\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<ctype.h>\nusing namespace std;\ntypedef long long ll;\nll mod;\ninline ll read(){\n\tll x=0,f=0;char ch=getchar();\n\twhile(!isdigit(ch))f|=ch=='-',ch=getchar();\n\twhile(isdigit(ch))x=x*10+(ch^48),ch=getchar();\n\treturn f?-x:x;\n}\ninline ll Slow_Mul(ll b,ll p){//\u5feb\u901f\u4e58\n\tll ans=0;\n\twhile(p){\n\t\tif(p&1)ans=(ans+b)%mod;\n\t\tb=(b+b)%mod;p>>=1;\n\t}\n\treturn ans;\n}\ninline void Mati_Mul(ll a[][2],ll b[][2]){//\u77e9\u9635\u4e58\n\tll c[2][2]={0};\n\tfor(int i=0;i<=1;++i)\n\t\tfor(int j=0;j<=1;++j)\n\t\t\tfor(int k=0;k<=1;++k)\n\t\t\t\tc[i][j]=(c[i][j]+Slow_Mul(a[i][k],b[k][j]))%mod;\n\tfor(int i=0;i<=1;++i)for(int j=0;j<=1;++j)a[i][j]=c[i][j];\n}\ninline ll Mati_Fast_pow(ll p){//\u77e9\u9635\u5feb\u901f\u5e42\n\tll ans[2][2]={1,0,0,1};//\u7b54\u6848\u77e9\u9635\n\tll b[2][2]={0,1,1,1};//\u5e38\u7528\u6590\u6ce2\u90a3\u5951\u7684\u77e9\u9635\n\tll f[2][2]={1,1,0,0};//\u521d\u59cb\u77e9\u9635\n\twhile(p){\n\t\tif(p&1)Mati_Mul(ans,b);\n\t\tMati_Mul(b,b);p>>=1;\n\t}\n\tMati_Mul(f,ans);\n\treturn f[0][1];\n}\ninline ll Fast_pow(ll b,ll p){//\u5feb\u901f\u5e42\n\tll ans=1;if(b<0)cout<<b;\n\twhile(p){\n\t\tif(p&1)ans=Slow_Mul(ans,b)%mod;\n\t\tb=Slow_Mul(b,b)%mod;p>>=1;//\u6ce8\u610f\u628a\u6240\u6709\u4e58\u6cd5\u90fd\u6362\u6210\u5feb\u901f\u4e58\n\t}\n\treturn ans;\n}\nint main(){\n\tll n=read()+1;mod=read();\n\tcout<<Fast_pow(((Mati_Fast_pow(n)-n-1)%mod+mod)%mod,n);//\u7b2cn+1\u9879\u53ea\u9700\u505an\u6b21\u4e58\u6cd5\n\treturn 0;//\u597d\u4e60\u60ef\n}\n\n```\n",
        "postTime": 1552569281,
        "uid": 56653,
        "name": "\u73c5\u8090",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5059 \u3010\u4e2d\u56fd\u8c61\u68cb\u3011"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5059)\n\n\u8fd9\u9053\u9898\u603b\u4f53\u6765\u8bf4\u4ee3\u7801\u5b9e\u73b0\u5e76\u4e0d\u96be\uff0c\u4e3b\u8981\u662f\u601d\u8def\u8f83\u4e3a\u96be\uff0c\u4e14\u4ee3\u7801\u7ec6\u8282\u8f83\u591a\u3002\n# \u601d\u8def\n\u9996\u5148\u770b\u9898\u76ee\uff0c\u6ce8\u610f\u662f\u8981\u653e\u5728\u683c\u70b9\u4e0a\uff0c\u6240\u4ee5\u8f93\u5165 $n$ \u65f6\u53ef\u4ee5\u5c06 $n+1$\uff0c\u66f4\u4fbf\u4e8e\u7406\u89e3\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u7531\u4e8e\u201c\u5352\u201d\u53ea\u80fd\u5411\u5de6\u6216\u5411\u53f3\u8d70\uff0c\u6240\u4ee5\u53ea\u7528\u5355\u72ec\u8003\u8651\u6bcf\u884c\u7684\u60c5\u51b5\uff0c\u7136\u540e\u6839\u636e\u4e58\u6cd5\u539f\u7406\u7528\u5feb\u901f\u5e42\u89e3\u51b3\u3002\n\n\u4e0b\u9762\u5c06\u8bf4\u660e\u5982\u4f55\u6c42\u6bcf\u884c\u7684\u60c5\u51b5\u6570\uff1a\n\n\u9898\u76ee\u4e2d\u6709\u9650\u5236\uff0c\u8bf4\u6bcf\u884c\u81f3\u5c11\u6709\u4e24\u679a\u68cb\u5b50\uff0c\u4e3a\u4e86\u65b9\u4fbf\u8d77\u89c1\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u7528\u603b\u60c5\u51b5\u6570\u51cf\u53bb\u4e0d\u7b26\u5408\u6761\u4ef6\u7684\u60c5\u51b5\u6570\u3002\n## 1.\u603b\u60c5\u51b5\u6570\uff1a\n\u8bbe $dp[i]$ \u4e3a\u5df2\u7ecf\u8003\u8651\u8fc7 $i$ \u683c\u540e\u7684\u603b\u60c5\u51b5\u6570\u3002\n\n\u5bf9\u4e8e\u7b2c $i$ \u683c\uff0c\u6709\u4e24\u79cd\u60c5\u51b5\uff0c\u653e\u548c\u4e0d\u653e\u3002\n\n\u5bf9\u4e8e\u653e\u7684\u60c5\u51b5\uff0c\u6839\u636e\u9898\u610f\u53ef\u4ee5\u77e5\u9053\uff0c\u7b2c $i-1$ \u683c\u4e00\u5b9a\u4e0d\u80fd\u653e\uff0c\u6545\u6b64\u65f6\u5e94\u5c06 $dp[i]$ \u52a0\u4e0a $dp[i-2]$\u3002\n\n\u5bf9\u4e8e\u4e0d\u653e\u7684\u60c5\u51b5\uff0c\u6b64\u65f6\u5c31\u76f8\u5f53\u4e8e\u662f\u7b2c $i-1$ \u683c\u7684\u60c5\u51b5\uff0c\u6545 $dp[i]$ \u6b64\u65f6\u5e94\u52a0\u4e0a $dp[i-1]$\u3002\n\n\u7efc\u4e0a\uff0c\u53ef\u5f97\u52a8\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\n$$dp[i]=dp[i-1]+dp[i-2]$$\n\u8fd9\u4e2a\u660e\u663e\u662f\u6590\u6ce2\u90a3\u5951\u6570\u5217\u554a\uff0c\u518d\u52a0\u4e0a\u9898\u76ee\u4e2d\u8bf4\u7684 $N\\le 10^{18}$\uff0c\u60f3\u5230\u7528\u77e9\u9635\u5feb\u901f\u5e42\u6c42\u89e3\u3002\n### code:\n```cpp\nint Fibonacci(int x){\n\t//\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u5176\u5b9e\u5c31\u662f\u6c42\u6590\u6ce2\u90a3\u5951\u6570\u5217\n\tnode res,cnt;\n\tcnt.a[1][0]=cnt.a[0][1]=cnt.a[1][1]=res.a[0][0]=res.a[0][1]=1;\n\tcnt.a[0][0]=res.a[1][0]=res.a[1][1]=0;\n\twhile(x){\n\t\tif(x&1) res=mul(res,cnt);\n\t\tcnt=mul(cnt,cnt),x>>=1;\n\t}return res.a[0][0]%mod;\n}\n```\n## 2.\u4e0d\u7b26\u5408\u6761\u4ef6\u7684\u60c5\u51b5\u6570\uff1a\n\u5171\u5206\u4e3a\u4e24\u79cd\uff0c\u4e5f\u5f88\u597d\u60f3\uff0c\u4e00\u79cd\u662f\u653e\u4e86\u96f6\u4e2a\uff0c\u663e\u7136\u53ea\u6709\u4e00\u79cd\uff0c\u5176\u6b21\u662f\u653e\u4e86\u4e00\u4e2a\uff0c\u53ea\u6709 $n$ \u79cd\uff0c\u5728\u6700\u540e\u6c42\u89e3\u603b\u60c5\u51b5\u6570\u65f6\u51cf\u6389\u5c31\u597d\u4e86\u3002\n# \u4ee3\u7801\n\u8fd9\u9053\u9898\u4ee3\u7801\u5b9e\u73b0\u8f83\u4e3a\u7b80\u5355\uff0c\u4f46\u6ce8\u610f\u5230\u6570\u636e\u8303\u56f4\u5f88\u5927\uff0c\u9700\u8981\u7528\u5230~~\u5feb\u901f\u4e58~~\u9f9f\u901f\u4e58\u4ee5\u907f\u514d\u7206 ```long long```\uff0c\u8fd8\u6709\u51cf\u6389\u4e0d\u7b26\u5408\u7684\u60c5\u51b5\u65f6\u8981\u8003\u8651\u7ed3\u679c\u4e3a\u8d1f\u6570\u7684\u60c5\u51b5\uff0c\u53d6\u6a21\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\uff0c\u8981\u4e0d\u7136\u4f1a\u88ab\u5361\u6389\u3002\n## AC Code:\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint n,mod;\nstruct node{\n\tint a[2][2];\n};\nint multi(int a,int b){//\u9f9f\u901f\u4e58\n\tint res=0;\n\twhile(a){\n\t\tif(a&1) res=(res+b)%mod;\n\t\tb=(b*2)%mod,a>>=1;\n\t}return res%mod;\n}\nnode mul(node a,node b){//\u77e9\u9635\u4e58\n\tnode c;\n\tmemset(c.a,0,sizeof(c.a));\n\tfor(int i=0;i<2;i++)\n\t\tfor(int j=0;j<2;j++)\n\t\t\tfor(int k=0;k<2;k++)\n\t\t\t\tc.a[i][j]=(multi(a.a[i][k],b.a[k][j])+c.a[i][j])%mod;\n\treturn c;\n}\nint Fibonacci(int x){\n\t//\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u5176\u5b9e\u5c31\u662f\u6c42\u6590\u6ce2\u90a3\u5951\u6570\u5217\n\tnode res,cnt;\n\tcnt.a[1][0]=cnt.a[0][1]=cnt.a[1][1]=res.a[0][0]=res.a[0][1]=1;\n\tcnt.a[0][0]=res.a[1][0]=res.a[1][1]=0;\n\twhile(x){\n\t\tif(x&1) res=mul(res,cnt);\n\t\tcnt=mul(cnt,cnt),x>>=1;\n\t}return res.a[0][0]%mod;\n}\nint qpow(int d,int x){//\u5feb\u901f\u5e42\n\tint res=1;\n\twhile(x){\n\t\tif(x&1) res=multi(res,d);\n\t\td=multi(d,d),x>>=1;\n\t}return res%mod;\n}\nsigned main(){\n\tscanf(\"%lld%lld\",&n,&mod),n++;\n\tif(n<=2) printf(\"0\");//\u5c0f\u4e8e\u4e8c\u65f6\u663e\u7136\u65e0\u89e3\n\telse printf(\"%lld\",qpow(((Fibonacci(n+1)-n-1)%mod+mod)%mod,n));//\u4e00\u5b9a\u8981\u518d\u53d6\u6a21\u4e00\u6b21\uff01\n\treturn 0;\n}\n```\n\u5b8c\u7ed3\u6492\u82b1\uff01",
        "postTime": 1671335053,
        "uid": 696106,
        "name": "Leowang2009",
        "ccfLevel": 0,
        "title": "P5059 \u4e2d\u56fd\u8c61\u68cb \u9898\u89e3"
    },
    {
        "content": "> [P5059 \u4e2d\u56fd\u8c61\u68cb \u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5059)\u3002\n\n\u6ce8\u610f\u5230\u6bcf\u4e00\u5217\u662f\u72ec\u7acb\u7684\uff0c\u4e14\u65b9\u6848\u6570\u4e3a $fib_{n+3}-(n+2)$\uff1a\u8bbe $f_i$ \u8868\u793a\u7b2c $i$ \u5217\uff08\u4ece $1$ \u4e0b\u6807\u5f00\u59cb\uff0c\u5171\u6709 $n+1$ \u5217\uff09\u4e0d\u653e\u68cb\u5b50\u4e14\u4efb\u610f\u4e24\u4e2a\u4e0d\u653e\u68cb\u5b50\u7684\u683c\u5b50\u95f4\u9694\u4e0d\u8d85\u8fc7 $2$ \u7684\u65b9\u6848\u6570\uff0c\u5219\u6709 $f_0=f_1=1$\uff0c$f_i=f_{i-1}+f_{i-2}$\uff0c \u5219 $f_i=fib_{i+1}$\u3002\u603b\u65b9\u6848\u6570\u4e3a $f_{n+1}+f_n=f_{n+2}=fib_{n+3}$\uff0c\u518d\u51cf\u53bb\u5168\u90e8\u4e0d\u653e\u7684 $1$ \u79cd\u548c\u53ea\u6709\u4e00\u4e2a\u653e\u7684 $n+1$ \u79cd\u5373\u53ef\u3002\u6545\u7b54\u6848\u4e3a $(fib_{n+3}-n-2)^{n+1}$\u3002\u8ba1\u7b97 $fib$ \u7528\u77e9\u9635\u5feb\u901f\u5e42\u5373\u53ef\u3002\u6ce8\u610f\u8981\u7528\u6162\u901f\u4e58\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(\\log^2 n)$\u3002\n\n```cpp\nll n, p;\nvoid add(ll &x, ll y) {\n\tx = (x + y) % p;\n}\nll mul(ll x, ll y) {\n\tll s = 0;\n\twhile(y) {\n\t\tif(y & 1) add(s, x);\n\t\tx = (x << 1) % p, y >>= 1;\n\t}\n\treturn s;\n}\nll ksm(ll a, ll b) {\n\tll s = 1;\n\twhile(b) {\n\t\tif(b & 1) s = mul(s, a);\n\t\ta = mul(a, a), b >>= 1;\n\t}\n\treturn s;\n}\n\nstruct Matrix {\n\tll a[2][2];\n\tMatrix() {mem(a, 0, 2);}\n\tfriend Matrix operator * (Matrix x, Matrix y) {\n\t\tMatrix z;\n\t\tfor(int i = 0; i < 2; i++)\n\t\t\tfor(int j = 0; j < 2; j++)\n\t\t\t\tfor(int k = 0; k < 2; k++)\n\t\t\t\t\tadd(z.a[i][j], mul(x.a[i][k], y.a[k][j]));\n\t\treturn z;\n\t}\n} base, c, I;\n\nMatrix ksm(Matrix a, ll b) {\n\tMatrix ans = I;\n\twhile(b) {\n\t\tif(b & 1) ans = ans * a;\n\t\ta = a * a, b >>= 1;\n\t}\n\treturn ans;\n}\n\nint main() {\n\tcin >> n >> p;\n\tI.a[0][0] = I.a[1][1] = 1;\n\tbase.a[0][0] = base.a[1][0] = base.a[0][1] = 1;\n\tc.a[0][0] = 2, c.a[0][1] = 1;\n\tll res = (c * ksm(base, n)).a[0][0] - n - 2;\n\tres = (res % p + p) % p;\n\tcout << ksm(res, n + 1) << endl;\n\treturn 0;\n}\n```\n\n\u54e6\uff0c\u4e0a\u5e1d\uff0c\u8bf7\u539f\u8c05\u6211\u5199\u6c34\u9898\u9898\u89e3\u3002",
        "postTime": 1631446802,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "P5059 \u4e2d\u56fd\u8c61\u68cb"
    },
    {
        "content": "\u8fd9\u4e2a\u9898\u6211\u7684\u505a\u6cd5\u4e0d\u592a\u4e00\u6837\n\n~~\uff08\u867d\u7136\u4f1a\u8dd1\u5f97\u66f4\u6162\u4f46\u662f\u8fd8\u662f\u53d1\u4e00\u4e0b\uff09~~\n\n\u5148\u4ece\u67d0\u4e00\u884c\u7684\u60c5\u51b5\u5165\u624b\u3002\n\n\u6211\u4eec\u8bbe $f(i,0)$ \u8868\u793a\u653e\u5230\u4e86\u7b2c $i$ \u4e2a\u4f4d\u7f6e\uff0c\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u4e0d\u653e\u68cb\u5b50\u7684\u65b9\u6848\u6570\n\n$f(i,1)$ \u8868\u793a\u653e\u5230\u4e86\u7b2c $i$ \u4e2a\u4f4d\u7f6e\uff0c\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u653e\u68cb\u5b50\u7684\u65b9\u6848\u6570\n\n\u8fd9\u91cc\u6709\u4e00\u4e2a\u9650\u5236\uff0c\u5c31\u662f\u6bcf\u884c\u653e\u7f6e\u7684\u68cb\u5b50\u6570\u5fc5\u987b\u5927\u4e8e\u7b49\u4e8e $2$\n\n\u5bf9\u4e8e\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u4e0d\u653e\u7684\u60c5\u51b5\uff0c\u524d\u9762\u53ef\u4ee5\u968f\u4fbf\u653e\n\n\u5f97\u5230 $f(i,0) = f(i-1,0) + f(i-1,1)$\n\n\u5bf9\u4e8e\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u653e\u7684\u60c5\u51b5\uff0c\u5728\u7b2c $i-1$ \u4e2a\u4f4d\u7f6e\u4e00\u5b9a\u4e0d\u80fd\u653e\n\n\u6240\u4ee5\u6240\u6709\u5728\u7b2c $i-1$ \u4e2a\u4f4d\u7f6e\u4e0d\u653e\u7684\u65b9\u6848\u90fd\u6210\u7acb\n\n\u4f46\u662f\u8fd8\u6709\u4e00\u70b9\uff1a\u524d\u9762\u53ea\u653e\u4e86\u4e00\u4e2a\u68cb\u5b50\u7684\u65b9\u6848\u4e5f\u53ef\u4ee5\u6210\u7acb\n\n\u56e0\u4e3a\u7b2c $i-1$ \u4e2a\u4f4d\u7f6e\u4e0d\u80fd\u653e\u68cb\u5b50\uff0c\u6240\u4ee5\u524d\u9762\u53ea\u653e\u4e00\u4e2a\u68cb\u5b50\u7684\u65b9\u6848\u6570\u4e3a $i-2$\n\n\u5f97\u5230 $f(i,1) = f(i-1,0) + i-2$\n\n\u4e00\u884c\u7684\u603b\u65b9\u6848\u6570\u4e3a $f(i,0) + f(i,1)$\n\n\u56e0\u4e3a\u5352\u53ea\u4f1a\u653b\u51fb\u540c\u4e00\u884c\u7684\u68cb\u5b50\uff0c\u6240\u4ee5\u6bcf\u884c\u7684\u72b6\u6001\u662f\u4e92\u4e0d\u5f71\u54cd\u7684\n\n\u6240\u4ee5\u6700\u7ec8\u65b9\u6848\u6570\u4e3a $[f(i,0) + f(i,1) ] ^ N $\n\n\u7531\u4e8e $N$ \u8fc7\u5927\u6211\u4eec\u7528\u77e9\u9635\u52a0\u901f\u9012\u63a8\n\n\u8bbe\u77e9\u9635\n\n$\\begin{vmatrix}f(i,0)&f(i,1)&i-1&1\\end{vmatrix}$ \n\n\u4ee4 $i=3$ \u65f6\u7684\u77e9\u9635\u4e3a\u521d\u59cb\u77e9\u9635\n\n\u5219\u521d\u59cb\u77e9\u9635\u4e3a\n\n$\\begin{vmatrix}0&1&2&1\\end{vmatrix}$ \n\n\u53ef\u4ee5\u5f97\u5230\u8f6c\u79fb\u77e9\u9635\n\n$\\begin{vmatrix}1&1&0&0\\\\1&0&0&0\\\\0&1&1&0\\\\0&0&1&1\\end{vmatrix}$\n\n\u8dd1\u5b8c\u77e9\u4e58\u8dd1\u5feb\u901f\u5e42\u5c31\u53ef\u4ee5\u4e86\n\n\u6b64\u9898\u7684\u5751\u70b9\uff1a\n\n\u76f8\u4e58\u4f1a\u7206$long\\ long$\uff0c\u9700\u8981\u4f7f\u7528\u9f9f\u901f\u4e58\n\n$N$ \u662f\u683c\u5b50\u6570\u4e0d\u662f\u683c\u70b9\u6570\uff0c$N+1$ \u624d\u662f\u683c\u70b9\u6570\uff0c\u5b9e\u9645\u4e0a\u6709$(N+1)$\u884c$(N+1)$\u5217 ~~\uff08\u6211\u8fd8\u56e0\u4e3a\u8fd9\u4e2a\u53d1\u4e86\u8ba8\u8bba\uff09~~\n\n\u6ce8\u610f\u7279\u5224$N$\u8f83\u5c0f\u7684\u60c5\u51b5\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<cstring>\n#include<algorithm>\n#define ll long long\nusing namespace std;\nstruct Mat\n{\n    ll a[5][5];\n    Mat(){memset(a,0,sizeof(a));}\n}base,st;\nll n,mod;\nll add(ll a,ll b)\n{\n    ll res=a+b;\n    if(res>=mod) res-=mod;\n    return res;\n};\nll mul(ll x,ll b)\n{\n    ll res=0;\n    while(b)\n    {\n        if(b&1) res=add(res,x);\n        x=add(x,x);\n        b>>=1;\n    }\n    return res;\n}\nll fpowll(ll x,ll b)\n{\n    ll res=1;\n    while(b)\n    {\n        if(b&1) res=mul(res,x);\n        x=mul(x,x);\n        b>>=1;\n    }\n    return res;\n}\nMat operator * (const Mat &a,const Mat &b)\n{\n    Mat c;\n    for(int i=1;i<=4;i++)\n        for(int j=1;j<=4;j++)\n            for(int k=1;k<=4;k++)\n                c.a[i][j]=add(c.a[i][j],mul(a.a[i][k],b.a[k][j]));\n    return c;\t\t\t\n}\nMat fpow(Mat x,ll b)\n{\n    Mat res;\n    for(int i=1;i<=4;i++)\n        res.a[i][i]=1;\n    while(b)\n    {\n        if(b&1) res=res*x;\n        x=x*x;\n        b>>=1;\n    }\n    return res;\n}\nint main()\n{\n    cin>>n>>mod;\n    n++;\n    if(n<3)\n    {\n        putchar('0');\n        return 0;\n    }\n    st.a[1][2]=st.a[1][4]=1;\n    st.a[1][3]=2;\n    base.a[1][1]=base.a[1][2]=base.a[2][1]=base.a[3][2]=base.a[3][3]=base.a[4][3]=base.a[4][4]=1;\n    st=st*fpow(base,n-3);\n    cout<<fpowll(add(st.a[1][1],st.a[1][2]),n);\n    return 0;\n}\n```\n\n\u5982\u679c\u6709\u7591\u95ee\u6b22\u8fce\u63d0\u51fa~",
        "postTime": 1562118627,
        "uid": 91889,
        "name": "Dirt\u3001",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5059 \u3010\u4e2d\u56fd\u8c61\u68cb\u3011"
    },
    {
        "content": "\u6ce8\u610f\u5230\u6bcf\u4e00\u884c\u90fd\u7b54\u6848\u5176\u5b9e\u662f\u76f8\u5bf9\u72ec\u7acb\u4e14\u76f8\u540c\u7684\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u7b97\u51fa\u4e00\u884c\u7684\u7b54\u6848\uff0c\u5373\u53ef\u5f97\u5230\u6574\u4e2a\u68cb\u76d8\u7684\u7b54\u6848\u3002\n\n\u6211\u4eec\u90fd\u5173\u6ce8\u54ea\u4e9b\u4fe1\u606f\u5462\uff1f\u9636\u6bb5\u663e\u7136\u662f\u8bbe\u7f6e\u6210\u5f53\u524d\u5904\u7406\u5230\u4e86\u524d $i$ \u4e2a\u683c\u70b9\uff0c\u9664\u6b64\u4e4b\u5916\uff0c\u6211\u4eec\u663e\u7136\u8fd8\u5173\u5fc3\u5f53\u524d\u683c\u70b9\u6709\u6ca1\u6709\u653e\u7f6e\u5352\u4e14\u5f53\u524d\u884c\u4e00\u5171\u6709\u51e0\u4e2a\u5352\uff0c\u8fd9\u6837\u624d\u80fd\u4f7f\u6211\u4eec\u8f6c\u79fb\u51fa\u7684\u65b9\u6848\u6ee1\u8db3\u9898\u76ee\u4e2d\u7ed9\u5b9a\u7684\u4e24\u4e2a\u6761\u4ef6\u3002\n\n\u90a3\u4e48\u73b0\u5728\u5176\u5b9e\u5c31\u6709\u4e24\u79cd\u8bbe\u7f6e\u72b6\u6001\u7684\u9009\u62e9\uff1a\n\n- \u8bbe $dp_i$ \u8868\u793a\u5904\u7406\u5b8c\u524d $i$ \u4e2a\u683c\u70b9\u7684\u65b9\u6848\u6570\uff0c\u4e14\u7b2c $i$ \u4e2a\u683c\u70b9\u5f3a\u5236\u653e\u7f6e\u65f6\u7684\u65b9\u6848\u6570\uff0c\u6b64\u65f6\u6211\u4eec\u53ea\u9700\u8981\u679a\u4e3e\u4e0a\u4e00\u6b21\u653e\u7f6e\u7684\u683c\u70b9\uff0c\u6ce8\u610f\u4e00\u4e9b\u7ec6\u8282\u5373\u53ef\u540c\u65f6\u6ee1\u8db3\u4e24\u4e2a\u6761\u4ef6\u3002 \n- \u8bbe $dp_{i,0/1,0/1/2}$ \u8868\u793a\u5904\u7406\u5b8c\u4e86\u524d $i$ \u4e2a\u683c\u70b9\uff0c\u4e14\u7b2c $i$ \u4e2a\u683c\u70b9 \u6ca1\u6709\u653e\u7f6e/\u653e\u7f6e\u68cb\u5b50\uff0c\u672c\u884c\u76ee\u524d \u6ca1\u6709\u68cb\u5b50/\u6709\u4e00\u4e2a\u68cb\u5b50/\u68cb\u5b50\u4e2a\u6570\u8fbe\u5230\u8981\u6c42 \u65f6\u7684\u65b9\u6848\u6570\u3002\u5219\u8f6c\u79fb\u65f6\u8003\u8651\u4e0a\u4e00\u4e2a\u683c\u5b50\u7684\u72b6\u6001\u5373\u53ef\u3002\n\n\u4e24\u4e2a dp \u72b6\u6001\u8bbe\u7f6e\u7684\u533a\u522b\u5728\u4e8e\u4e00\u4e2a\u5f3a\u5236\u9009\u62e9\u800c\u53e6\u4e00\u4e2a\u4e0d\u5f3a\u5236\u9009\u62e9\uff0c\u6b63\u5e38\u6765\u8bf4\u5e94\u8be5\u662f\u7b2c\u4e00\u4e2a dp \u66f4\u65b9\u4fbf\u4e00\u4e9b\u7684\uff0c\u4f46\u662f\u89c2\u5bdf\u5230\u6b64\u9898\u7684\u6570\u636e\u8303\u56f4\uff0c$N\\le 10^{18}$\uff0c\u679c\u65ad\u8003\u8651\u77e9\u9635\u52a0\u901f\u4f18\u5316\uff0c\u90a3\u4e48\u7531\u4e8e\u77e9\u9635\u8f6c\u79fb\u7684\u7279\u6b8a\u6027\uff0c\u8f6c\u79fb\u65f6\u51b3\u7b56\u663e\u7136\u662f\u8d8a\u5c11\u8d8a\u597d\u7684\uff0c\u7b2c\u4e00\u79cd\u7684\u51b3\u7b56\u6d89\u53ca\u5230\u4e86\u524d\u9762\u7684\u6240\u6709\u72b6\u6001\uff0c\u663e\u7136\u65e0\u6cd5\u5199\u6210\u77e9\u9635\uff0c\u4e8e\u662f\u6211\u4eec\u4fbf\u91c7\u53d6\u4e86\u7b2c\u4e8c\u79cd\u72b6\u6001\u8bbe\u8ba1\u65b9\u5f0f\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u9636\u6bb5\uff0c\u4e00\u5171\u6709\u516d\u79cd\u4e0d\u540c\u7684\u72b6\u6001\uff0c\u6240\u4ee5\u6211\u4eec\u8bbe\u8ba1\u4e00\u4e2a $6\\times 6$ \u7684\u77e9\u9635\u5373\u53ef\u4f18\u5316\u8f6c\u79fb\u3002\u6700\u540e\u5c06\u7b54\u6848 $s$ \u4f5c\u4e00\u4e2a $n$ \u6b21\u5e42\u5373\u53ef\u3002\n\n\u6ce8\u610f\u5230\u6a21\u6570\u7684\u53d6\u503c\u8303\u56f4\uff0c\u8bb0\u5f97\u4f7f\u7528\u9f9f\u901f\u4e58\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(6^3\\log N\\log P)$.\n\n```cpp\n#include <bits/stdc++.h> \nusing namespace std;\ntypedef long long ll;\nconst int N=6;\nll n,p;\nstruct node{\n\tll a[N][N];\n\tnode(){\n\t\tmemset(a,0,sizeof(a));\n\t}\n\tvoid init(){\n\t\tfor (int i=0;i<N;i++) a[i][i]=1;\n\t}\n\tvoid init1(){\n\t\ta[0][0]=1;\n\t}\n\tvoid init2(){\n\t\ta[0][0]=a[0][4]=1;\n\t\ta[1][1]=a[1][5]=1;\n\t\ta[2][2]=a[2][5]=1;\n\t\ta[4][1]=1;\n\t\ta[5][2]=1;\n\t}\n};\nll ksc(ll x,ll y){\n\tll ans=0;\n\twhile (y){\n\t\tif (y&1) ans=(ans+x)%p;\n\t\tx=(x+x)%p;\n\t\ty>>=1;\n\t}\n\treturn ans;\n}\nnode operator *(const node&x,const node&y){\n\tnode z;\n\tfor (int k=0;k<N;k++)\n\t\tfor (int i=0;i<N;i++)\n\t\t\tfor (int j=0;j<N;j++)\n\t\t\t\tz.a[i][j]=(z.a[i][j]+ksc(x.a[i][k],y.a[k][j]))%p;\n\treturn z;\n}\nnode ksm(node S,ll y){\n\tnode H;\n\tH.init();\n\twhile (y){\n\t\tif (y&1) H=H*S;\n\t\tS=S*S;\n\t\ty>>=1;\n\t}\n\treturn H;\n}\nll read(){\n\tll w=0,f=1;\n\tchar c=getchar();\n\twhile (c>'9'||c<'0'){\n\t\tif (c=='-') f=-1;\n\t\tc=getchar();\n\t}\n\twhile (c>='0'&&c<='9'){\n\t\tw=(w<<3)+(w<<1)+(c^48);\n\t\tc=getchar();\n\t}\n\treturn w*f;\n}\nll ksm2(ll x,ll y){\n\tll ans=1;\n\twhile (y){\n\t\tif (y&1) ans=ksc(ans,x);\n\t\tx=ksc(x,x);\n\t\ty>>=1;\n\t}\n\treturn ans;\n}\nint main(){\n\tn=read()+1,p=read();\n\tnode S,P;\n\tS.init1(),P.init2();\n\tS=S*ksm(P,n);\n\tll ans=ksm2((S.a[0][2]+S.a[0][5])%p,n);\n\tcout<<ans<<'\\n';\n\treturn 0;\n}\n```",
        "postTime": 1665063745,
        "uid": 257621,
        "name": "\u7ffc\u5fb7\u5929\u5c0a",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P5059 \u4e2d\u56fd\u8c61\u68cb"
    },
    {
        "content": "\u65b0\u624b\u7b2c\u4e00\u7bc7\u9898\u89e3\uff0c\u671b\u5305\u6db5\u3002\n\n\u9898\u610f\uff1a\u5728 $n\\times n$ \u7684\u68cb\u76d8**\u683c\u70b9**\u4e0a\u653e\u7f6e\u82e5\u5e72\u68cb\u5b50\uff0c\u4f7f\u6bcf\u884c\u6709\u81f3\u5c11\u4e24\u679a\u68cb\u5b50\u4e14\u68cb\u5b50\u4e24\u4e24\u4e0d\u80fd\u6a2a\u5411\u76f8\u90bb\uff0c\u6c42\u653e\u7f6e\u65b9\u6cd5\u6570\u3002\n\n\u6838\u5fc3\u601d\u60f3\uff1a\u6570\u5217\u4ee3\u6362\n\n\u89e3\uff1a\n\n\u5bb9\u6613\u53d1\u73b0\uff0c\u6bcf\u884c\u4e4b\u95f4\u4e0d\u4f1a\u76f8\u4e92\u5f71\u54cd\u3002\n\n\u8bbe\u5728\u957f\u5ea6\u4e3a $a$ \u7684\u4e00\u884c\u4e2d\u653e\u7f6e $b$ \u4e2a\u5b50\u7684\u65b9\u6cd5\u6570\u4e3a $A(a, b)\\:(a, b\\in\\mathbb{N})$\uff0c\u5219\u6709:\n\n$A(a, b)=A(a-1, b)+A(a-2, b-1)\\:(b>1)$\n\n\u5176\u4e2d\u7b2c\u4e00\u9879\u5bf9\u5e94\u6700\u540e\u4e00\u683c\u4e0d\u653e\u68cb\u5b50\u7684\u65b9\u6cd5\u6570\uff0c\u7b2c\u4e8c\u9879\u5bf9\u5e94\u6700\u540e\u4e00\u683c\u653e\u68cb\u5b50\u7684\u65b9\u6cd5\u6570\u3002\n\n\u4ee4 $f(x)=\\sum_{i=2}^{x}A(x, i)$\uff0c\u5219\u6709\n\n$f(x)=f(x-1)+f(x-2)+A(x-2, 1)$\uff0c\n\n\u5373 $f(x)=f(x-1)+f(x-2)+x-2$.\n\n\u89c2\u5bdf\u5230\u8be5\u6570\u5217\u7684\u76f8\u90bb\u9879\u4e4b\u6bd4\u4e0e $\\frac{\\sqrt{5}+1}{2}$ \u63a5\u8fd1\uff0c\u8003\u8651\u5176\u4e0e\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u5173\u7cfb\u3002\n\n~~\u76f4\u63a5\u4e0aOEIS\uff0c\u6b64\u9898\u89e3\u51b3~~\n\n\u7ecf\u8fc7~~Excel\u4e71\u7b97~~\u89c2\u5bdf\uff0c\u53d1\u73b0 $f(x)-f(x-1)=F(x)-1$\uff0c\u6545\u6240\u6c42\u5373 $\\Sigma F(i)-x$.\n\n\u7531\u6590\u6ce2\u90a3\u5951\u6570\u5217\u5b9a\u4e49 $F(x)=F(x-1)+F(x-2)\\:(x\\ge3)$\uff0c\u6709\n\n$\\sum F(x)=(F(2)+...+F(x-1))+(F(1)+...+F(x-2))+F(1)+F(2)$\n\n\u5373 $\\sum F(x)=\\sum F(x-1)+\\sum F(x-2)+1$.\n\n$\\sum F(i)$ \u7684\u5f62\u5f0f\u5c31\u7c7b\u4f3c\u4e8e $F(i+1)$. \n\n\u7531\u5b9a\u4e49\uff0c\u6709 $\\sum F(x)=\\sum F(x-1)+F(x)$\uff1a\n\n\u82e5 $\\sum F(x)=F(x+2)-1$\uff0c\u6709\n\n$\\sum F(x+1)=F(x)+F(x-1)-1=F(x+3)-1$.\n\n\u89c2\u5bdf\u6709 $\\sum F(1)=F(3)-1$.\n\n\u7531\u6570\u5b66\u5f52\u7eb3\u6cd5\uff0c$\\forall x\\ge1$\uff0c$\\sum F(x)=F(x+1)-1+F(x)=F(x+2)-1$.\n\n\u4ee3\u5165\u53ef\u5f97 $f(x)=F(x+2)-x-1$\uff0c\u800c\u9898\u76ee\u6240\u6c42\u7ed3\u679c\u4e3a $f(n+1)^{n+1}\\bmod p$\uff0c\u6c42\u7b97\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\log^2n)$\uff0c\u4e0d\u4f1a T\u3002\u5feb\u901f\u5e42 + \u5feb\u901f\u500d\u589e\uff0c\u9042 A\u3002\n\n\n------------\n\n\n\u4ee3\u7801\u592a\u70c2\uff0c\u6055\u4e0d\u9644\u3002\n\n\n\n\n",
        "postTime": 1663772107,
        "uid": 191387,
        "name": "\u03a6\u03c1\u03b1\u03bd\u03ba",
        "ccfLevel": 0,
        "title": "P5059 \u4e2d\u56fd\u8c61\u68cb \u9898\u89e3"
    },
    {
        "content": "\u8be5\u9898\u662f\u672c\u849f\u84bb\u7684\u7b2c\u4e00\u9053\u7d2b\u9898\uff0c\u53d1\u4e0b\u81ea\u5df1\u7684\u601d\u8def\u7eaa\u5ff5\u4e00\u4e0b\u3002\n\n\u9996\u5148\uff0c\u683c\u70b9\u4e0e\u683c\u5b50\u662f\u4e24\u7801\u4e8b\u3002\u6bcf\u884c\u6bcf\u5217\uff0c\u683c\u70b9\u6570=\u683c\u5b50\u6570+1\uff0c\u5343\u4e07\u522b\u70b9\u8fdb\u5751\u91cc\u554a\u3002\n\n\u5176\u6b21\uff0c\u5bf9\u4e8e\u6b64\u9898\uff0c\u56e0\u4e3a\u5352\u53ea\u80fd\u5403\u5230\u5de6\u53f3\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8003\u8651\u4e00\u884c\u91cc\u65b9\u6848\u7684\u603b\u6570\uff0c\u4e4b\u540e\u518d\u4e58\u65b9\u5373\u53ef\u3002\n\n\u51fa\u4e8e\u6b64\u9898\u6570\u636e\u8303\u56f4\u8fc7\u5927\uff0c\u6240\u4ee5\u6211\u7684\u7b2c\u4e00\u60f3\u6cd5\u662f\uff0c\u77e9\u9635\u5feb\u901f\u5e42\u3002\n\n\u7531\u4e8e\u6211\u592a\u83dc\u4e86\uff0c\u6240\u4ee5\u6211\u5148\u6253\u4e86\u4e00\u4e2a\u6df1\u641c\uff0c\u6c42\u4e00\u4e0b\u5c0f\u6570\u636e\u7684\u7ed3\u679c\u3002\n\n\u6df1\u641c\u4ee3\u7801\u592a\u8fc7\u4e11\u964b\uff0c\u8fde\u526a\u679d\u90fd\u6ca1\u6709\uff0c\u5c31\u4e0d\u62ff\u51fa\u6765\u4e22\u4eba\u5566\u3002\n\n\u7ed3\u679c\u5982\u4e0b\uff1a\u4e00\u884c\u53ef\u4ee5\u6709\u7684\u60c5\u51b5\u6570\uff1a\n\n n  2 \uff0c3 \uff0c4 \uff0c5 \uff0c6 \uff0c7 \uff0c8 \uff0c9\n\nres  0 \uff0c1 \uff0c3 \uff0c7 \uff0c14 \uff0c26 \uff0c46 \uff0c79 \uff0c133\n\n\u4e4b\u540e\uff0c\u6211\u773c\u7741\u7741\u770b\u4e86\u56db\u4e2a\u70b9\uff0c\u5199\u4e86\u4e09\u5f20\u8349\u7eb8\uff0c\u624d\u53d1\u73b0\uff1a\n\n\u8bbe f[i] \u8868\u793a\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7b2ci\u9879\uff1b\n\ns[i]\u8868\u793a\u524di\u9879\u7684\u548c;\n\nt[i]=1\u4e58\u4ee5f[1] + 2\u4e58\u4ee5f[2] + 3\u4e58\u4ee5f[3]\u2026\u2026 + i\u4e58\u4ee5f[i];\n\n\u5219res[i]=n*s[i]-t[i]=(n-1)f[1]+(n-2)f[2]+(n-3)f[3]\u2026\u2026+(n-(n-1))f[n-1];\n\n\u7531\u6b64\u53ef\u5f97\uff0cres[i]=res[i-1]+s[i-1];\n\n\u6240\u4ee5\uff0c\u77e9\u9635\u4e58\u6cd5\u7684\u5e95\u77e9\u9635base\u4e3a\n\nbase[1][1]=base[1][2]=base[2][1]=base[3][1]=base[3][3]=base[4][3]=base[4][4]=0;\n\n\u63a5\u4e0b\u6765\u5229\u7528\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u5373\u53ef\u6c42\u89e3\u3002\n\n//\u4f46\u662f\u6211\u592a\u4f4e\u4f30\u51fa\u9898\u8005\u7684\u795e\u5a01\u4e86//\n\n\u8fd9\u9053\u9898\u7684\u6570\u636e\u7528long long\u88c5\u4e0d\u4e0b\uff1b\n\n\u6240\u4ee5\u6211\u7528\u4e86\u9ad8\u7cbe\u5ea6\u3002\u53ef\u80fd\u4ee3\u7801\u6709\u70b9\u6666\u6da9\uff0c\u7528\u4e86\u4e00\u4e9b\u521d\u5b66\u8005\u7406\u89e3\u4e0d\u4e86\u7684\u4e1c\u897f\uff0c\u4f46\u662f\u9ad8\u7cbe\u53ef\u4ee5\u6162\u6162\u6253\uff0c\u601d\u8def\u6700\u91cd\u8981\u3002\n\nAC\u4ee3\u7801\uff1a\n```cpp\n#include<cstring>\n#include<iostream>\n#include<vector>\nusing namespace std;\nstruct int_X:vector<int>\n{\n    int_X(int n=0)\n    {\n        push_back(n);\n        check();\n    }\n    int_X& check()\n    {\n        while(!empty()&&!back())pop_back();\n        if(empty())return *this;\n        for(int i=1;i<size();++i)\n        {\n            (*this)[i]+=(*this)[i-1]/10;\n            (*this)[i-1]%=10;\n        }\n        while(back()>=10)\n        {\n            push_back(back()/10);\n            (*this)[size()-2]%=10;\n        }\n        return *this;\n    }\n};\nistream& operator>>(istream &is,int_X &n)\n{\n    string s;\n    is>>s;\n    n.clear();\n    for(int i=s.size()-1;i>=0;--i)n.push_back(s[i]-'0');\n    return is;\n}\nostream& operator<<(ostream &os,const int_X &n)\n{\n    if(n.empty())os<<0;\n    for(int i=n.size()-1;i>=0;--i)os<<n[i];\n    return os;\n}\nbool operator!=(const int_X &a,const int_X &b)\n{\n    if(a.size()!=b.size())return 1;\n    for(int i=a.size()-1;i>=0;--i)\n        if(a[i]!=b[i])return 1;\n    return 0;\n}\nbool operator==(const int_X &a,const int_X &b)\n{\n    return !(a!=b);\n}\nbool operator<(const int_X &a,const int_X &b)\n{\n    if(a.size()!=b.size())return a.size()<b.size();\n    for(int i=a.size()-1;i>=0;--i)\n        if(a[i]!=b[i])return a[i]<b[i];\n    return 0;\n}\nbool operator>(const int_X &a,const int_X &b)\n{\n    return b<a;\n}\nbool operator<=(const int_X &a,const int_X &b)\n{\n    return !(a>b);\n}\nbool operator>=(const int_X &a,const int_X &b)\n{\n    return !(a<b);\n}\nint_X& operator+=(int_X &a,const int_X &b)\n{\n    if(a.size()<b.size())a.resize(b.size());\n    for(int i=0;i!=b.size();++i)a[i]+=b[i];\n    return a.check();\n}\nint_X operator+(int_X a,const int_X &b)\n{\n    return a+=b;\n}\nint_X& operator-=(int_X &a,int_X b)\n{\n    if(a<b)swap(a,b);\n    for(int i=0;i!=b.size();a[i]-=b[i],++i)\n        if(a[i]<b[i])\n        {\n            int j=i+1;\n            while(!a[j])++j;\n            while(j>i)\n            {\n                --a[j];\n                a[--j]+=10;\n            }\n        }\n    return a.check();\n}\nint_X operator-(int_X a,const int_X &b)\n{\n    return a-=b;\n}\nint_X operator*(const int_X &a,const int_X &b)\n{\n    int_X n;\n    n.assign(a.size()+b.size()-1,0);\n    for(int i=0;i!=a.size();++i)\n        for(int j=0;j!=b.size();++j)\n            n[i+j]+=a[i]*b[j];\n    return n.check();\n}\nint_X& operator*=(int_X &a,const int_X &b)\n{\n    return a=a*b;\n}\nint_X divmod(int_X &a,const int_X &b)\n{\n    int_X ans;\n    for(int t=a.size()-b.size();a>=b;--t)\n    {\n        int_X d;\n        d.assign(t+1,0);\n        d.back()=1;\n        int_X c=b*d;\n        while(a>=c)\n        {\n            a-=c;\n            ans+=d;\n        }\n    }\n    return ans;\n}\nint_X operator/(int_X a,const int_X &b)\n{\n    return divmod(a,b);\n}\nint_X& operator/=(int_X &a,const int_X &b)\n{\n    return a=a/b;\n}\nint_X& operator%=(int_X &a,const int_X &b)\n{\n    divmod(a,b);\n    return a;\n}\nint_X operator%(int_X a,const int_X &b)\n{\n    return a%=b;\n}\nint_X pow(const int_X &n,const int_X &k)\n{\n    if(k.empty())return 1;\n    if(k==2)return n*n;\n    if(k.back()%2)return n*pow(n,k-1);\n    return pow(pow(n,k/2),2);\n}\nstruct M\n{\n\tint_X a[5][5];\n\tM(){\n\t\tmemset(a,0,sizeof(a));\n\t}\n}ans,base;\nint_X mod;\nM mul(M m,M n)\n{\n\tM c;\n\tfor(int i=1;i<=4;i++){\n\t\tfor(int k=1;k<=4;k++){\n\t\t\tif(m.a[i][k]!=0){\n\t\t\t\tfor(int j=1;j<=4;j++)c.a[i][j]=(c.a[i][j]+m.a[i][k]*n.a[k][j]%mod)%mod;\n\t\t\t}\n\t\t}\n\t}\n    return c;\n}\nvoid pre()\n{\n\tans.a[1][1]=ans.a[1][2]=0;\n\tans.a[1][3]=ans.a[1][4]=1;\n\tbase.a[1][1]=base.a[1][2]=base.a[2][1]=base.a[3][1]=base.a[3][3]=base.a[4][3]=base.a[4][4]=1;\n}\nint_X caculate(int_X x)\n{\n\tpre();\n\tx-=1;\n\twhile(x>0)\n\t{\n\t\tif(x%2==1)ans=mul(ans,base);\n\t\tbase=mul(base,base);\n\t\tx/=2;\n\t}\n\treturn ans.a[1][1];\n}\nint_X fast(int_X a,int_X b)\n{\n\tint_X e=1;\n\twhile(b>0){\n\t\tif(b%2==1){\n\t\t\te=(e%mod)*(a%mod)%mod;\n\t\t}\n\t\ta=(a%mod)*(a%mod)%mod;\n\t\tb/=2;\n\t}\n\treturn e%mod;\n}\nint main()\n{\n\tint_X n;\n\tcin>>n>>mod;\n\tif(n<3)cout<<\"0\";\n\telse if(mod==1)cout<<\"0\";\n\telse cout<<fast(caculate(n),n+1);\n\treturn 0;\n}\n```",
        "postTime": 1544711445,
        "uid": 145240,
        "name": "wasked",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P5059 \u3010\u4e2d\u56fd\u8c61\u68cb\u3011"
    }
]
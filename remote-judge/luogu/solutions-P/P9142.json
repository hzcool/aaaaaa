[
    {
        "content": "\u505a\u51fa\u672c\u9898\u4e0d\u9700\u8981\u989d\u5916\u7684\u535a\u5f08\u8bba\u77e5\u8bc6\uff0c\u6240\u6709\u9700\u8981\u7528\u5230\u7684\u5df2\u7ecf\u5199\u5728\u9898\u9762\u91cc\u4e86\u3002\r\n\r\n\u6839\u636e\u8f93\u51fa\u683c\u5f0f\uff0c\u4e24\u4eba\u7684\u7b56\u7565\u90fd\u5f62\u5982\u4ee5\u6982\u7387 $p_i$ \u6216 $q_i$ \u9009\u53d6 $i$\u3002\r\n\r\n\u53e6\u5916\uff0c\u8f93\u51fa\u683c\u5f0f\u4e2d\u8fd8\u63d0\u5230\uff1a\r\n\r\n> \u5728\u4e00\u65b9\u7684\u7b56\u7565\u4e0d\u53d8\u7684\u60c5\u51b5\u4e0b\uff0c\u53e6\u4e00\u65b9\u65e0\u8bba\u5982\u4f55\u6539\u53d8\u81ea\u5df1\u7684\u7b56\u7565\uff0c\u90fd\u4e0d\u80fd\u4f7f\u81ea\u5df1\u7684\u671f\u671b\u6536\u76ca\u6bd4\u539f\u6765\u591a\u3002\r\n\r\n\u8fd9\u6837\u76f8\u5f53\u4e8e\u662f\u5728\u63d0\u793a\uff0c\u4e24\u4eba\u7684\u7b56\u7565\u90fd\u9700\u8981\u6ee1\u8db3\uff0c\u65e0\u8bba\u5bf9\u65b9\u9009\u53d6\u54ea\u4e2a\u6570\uff0c\u5728\u81ea\u5df1\u7684\u7b56\u7565\u4e0b\u671f\u671b\u6536\u76ca\u90fd\u4e00\u81f4\u3002\uff08\u65e0\u6cd5\u76f4\u63a5\u63a8\u51fa\u7684\u539f\u56e0\uff0c\u53ca\u5982\u4f55\u6b63\u786e\u63a8\u51fa\u89c1\u6587\u672b\uff09\r\n\r\n\u65e2\u7136\u6240\u6709\u9009\u62e9\u7684\u671f\u671b\u6536\u76ca\u4e00\u81f4\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u6839\u636e\u6bcf\u79cd\u60c5\u51b5\u7684\u671f\u671b\u6536\u76ca\u5217\u65b9\u7a0b\u3002\r\n\r\n\u5bf9\u4e8e\u8d70\u79c1\u8005\uff0c\u679a\u4e3e\u68c0\u5bdf\u5b98\u7684\u6bcf\u4e2a\u7b56\u7565\u53ef\u5f97\uff1a\r\n\r\n$$\\begin{aligned}&p_1+2p_2+3p_3+4p_4+\\cdots\\\\=&\\dfrac12p_0+2p_2+3p_3+4p_4+\\cdots\\\\=&\\dfrac22p_0+\\dfrac22p_1+3p_3+4p_4+\\cdots\\\\=&\\dfrac32p_0+\\dfrac32p_1+\\dfrac32p_2+4p_4+\\cdots\\\\=&\\cdots\\end{aligned}$$\r\n\r\n\u76f8\u90bb\u76f8\u51cf\uff0c\u53ef\u4ee5\u5f97\u5230 $p_1=\\dfrac12p_0$\uff0c$2p_2=\\dfrac12p_0+p_1$\uff0c$3p_3=\\dfrac12p_0+\\dfrac12p_1+\\dfrac32p_2$\uff0c\u7b49\u7b49\u3002\u7528 $p_0$ \u8868\u793a\u5176\u5b83\u9879\uff0c\u5bb9\u6613\u7b97\u51fa $p_k=\\dfrac12p_0(k\\ge 1)$\u3002\r\n\r\n\u5bf9\u4e8e\u68c0\u5bdf\u5b98\uff0c\u679a\u4e3e\u8d70\u79c1\u8005\u7684\u6bcf\u4e2a\u7b56\u7565\u53ef\u5f97\uff1a\r\n\r\n$$\\begin{aligned}&\\dfrac12q_1+\\dfrac22q_2+\\dfrac32q_3+\\dfrac42q_4+\\cdots\\\\=&q_0+\\dfrac22q_2+\\dfrac32q_3+\\dfrac42q_4+\\cdots\\\\=&2q_0+2q_1+\\dfrac32q_3+\\dfrac42q_4+\\cdots\\\\=&3q_0+3q_1+3q_2+\\dfrac42q_4+\\cdots\\end{aligned}$$\r\n\r\n\u76f8\u90bb\u76f8\u51cf\uff0c\u53ef\u4ee5\u5f97\u5230 $\\dfrac12q_1=q_0$\uff0c$\\dfrac22q_2=q_0+2q_1$\uff0c$\\dfrac32q_3=q_0+q_1+3q_2$\uff0c\u7b49\u7b49\u3002\u7528 $q_0$ \u8868\u793a\u5176\u5b83\u9879\uff0c\u7528\u4ee5\u4e0a\u5f0f\u5b50\u7684\u89c4\u5f8b\uff0c\u8bb0\u5f55\u4e00\u4e2a\u524d\u7f00\u548c\u5373\u5bb9\u6613\u8fdb\u884c\u9012\u63a8\u3002\r\n\r\n\u6700\u540e\uff0c\u5404\u4e2a $p_i,q_i$ \u662f\u6982\u7387\uff0c\u56e0\u6b64\u8981\u6ee1\u8db3 $\\sum p_i=\\sum q_i=1$\u3002\u7ed3\u5408\u524d\u9762\u7b97\u51fa\u7684\u6bd4\u4f8b\u4fe1\u606f\uff0c\u5373\u53ef\u56de\u5e26\u7b97\u51fa\u5404\u4e2a $p_i,q_i$\u3002\r\n\r\n\u6838\u5fc3\u90e8\u5206\u7684\u4ee3\u7801\uff0c\u4ec5\u4f9b\u53c2\u8003\uff1a\r\n\r\n```cpp\r\n//F(i,a,b) = for(int i=a;i<=b;i++)\r\n//ni(i) \u8868\u793a\u6c42 i \u5728\u6a21\u610f\u4e49\u4e0b\u7684\u4e58\u6cd5\u9006\r\np[0]=2;F(i,1,n) p[i]=1;\r\nq[0]=1;q[1]=2;ll sum=0;\r\nF(i,2,n)\r\n{\r\n\tsum=(sum+q[i-2])%mod;\r\n\tq[i]=(q[i-1]*2+sum*2*ni(i))%mod;\r\n}\r\nsum=0;F(i,0,n) sum+=p[i];sum%=mod;sum=ni(sum);F(i,0,n) p[i]=p[i]*sum%mod;\r\nsum=0;F(i,0,n) sum+=q[i];sum%=mod;sum=ni(sum);F(i,0,n) q[i]=q[i]*sum%mod;\r\n```\r\n\r\n----\r\n\r\n\u9898\u9762\u7ed9\u51fa\u7684\u6700\u91cd\u8981\u7684\u4fe1\u606f\u662f\uff0c\u4e24\u4eba\u7684\u6700\u4f18\u7b56\u7565\u90fd\u662f\u7eaf\u6982\u7387\u7b56\u7565\u3002\r\n\r\n\u8fd9\u4e2a\u6761\u4ef6\u8c8c\u4f3c\u7275\u626f\u5230\u4e00\u4e9b\u7c7b\u4f3c\u4e8e\u7eb3\u4ec0\u5747\u8861\u7684\u4e1c\u897f\uff0c\u4f46\u662f\u6211\u53c8\u4e0d\u5b66\u6982\u7387\u8bba\u6211\u600e\u4e48\u77e5\u9053.jpg\r\n\r\n----\r\n\r\n\u4e3a\u4ec0\u4e48\u5f15\u7528\u7684\u6761\u4ef6\u65e0\u6cd5\u76f4\u63a5\u63a8\u51fa\u6bcf\u79cd\u7b56\u7565\u7684\u671f\u671b\u5168\u90e8\u76f8\u7b49\uff1f\r\n\r\n\u56e0\u4e3a\u53cc\u65b9\u6709\u53ef\u80fd\u201c\u653e\u5f03\u201d\u5bf9\u624b\u7684\u4e00\u90e8\u5206\u9009\u9879\uff0c\u53ea\u4fdd\u8bc1\u5bf9\u624b\u9009\u5269\u4f59\u7684\u9009\u9879\u65f6\u671f\u671b\u5168\u90e8\u76f8\u7b49\uff08\u4e14\u4f4e\u4e8e\u5bf9\u624b\u9009\u5176\u5b83\u9009\u9879\u7684\u671f\u671b\uff09\u3002\r\n\r\n\u4e3a\u4e86\u6392\u9664\u8fd9\u79cd\u60c5\u51b5\uff0c\u53ea\u9700\u8981\u8bc1\u660e\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\u6700\u7ec8\u4f1a\u5f97\u5230\u4e00\u4e2a\u6bd4\u4e0a\u9762\u7684\u7b56\u7565\u4f4e\u7684\u671f\u671b\u5373\u53ef\u3002\r\n\r\n\u4e00\u4e2a\u7b80\u5355\u7684\u60f3\u6cd5\u662f\uff0c\u5c06\u5bf9\u624b\u6bcf\u79cd\u9009\u9879\u7684\u671f\u671b\u7684\u5f0f\u5b50\u8fdb\u884c\u52a0\u6743\u5e73\u5747\uff0c\u5e76\u8ba9\u5f97\u5230\u7684\u7ed3\u679c\u5404\u9879\u7cfb\u6570\u76f8\u7b49\uff0c\u5c31\u53ef\u4ee5\u5229\u7528\u5404\u60c5\u51b5\u6982\u7387\u548c\u4e3a $1$\uff0c\u5f97\u5230\u6700\u5927\u503c\u4e0d\u5c0f\u4e8e/\u6700\u5c0f\u503c\u4e0d\u8d85\u8fc7\u6b64\u5e73\u5747\uff0c\u4e14\u5f53\u4e14\u4ec5\u5f53\u5404\u4e2a\u671f\u671b\u5168\u90e8\u76f8\u7b49\u65f6\u53d6\u5230\u7b49\u53f7\u3002\r\n\r\n\u4e3a\u4e86\u4fdd\u8bc1\u4e0a\u8ff0\u8bba\u65ad\u6210\u7acb\uff0c\u5404\u4e2a\u5f0f\u5b50\u7684\u6743\u5fc5\u987b\u90fd\u662f\u6b63\u6570\u3002\r\n\r\n\u5b9e\u9645\u4e0a\uff0c\u6c42\u89e3\u8fd9\u4e2a\u7cfb\u6570\u7684\u65b9\u7a0b\u7ec4\uff0c\u4e0e\u6c42\u89e3\u5bf9\u624b\u7684\u5404\u64cd\u4f5c\u6982\u7387\u7684\u65b9\u7a0b\u7ec4\uff0c\u662f\u5b8c\u5168\u4e00\u6837\u7684\uff1b\u800c\u540e\u8005\u6709\u4e00\u4e2a\u5168\u6b63\u6570\u89e3\uff0c\u56e0\u6b64\u524d\u8005\u4e5f\u6709\u3002\r\n\r\n\u8bfb\u8005\u53ef\u4ee5\u5c1d\u8bd5\u81ea\u884c\u5e26\u5165\u540e\u8005\u6c42\u51fa\u7684\u89e3\u8ba1\u7b97\u524d\u8005\u3002",
        "postTime": 1678172134,
        "uid": 130151,
        "name": "WYXkk",
        "ccfLevel": 9,
        "title": "P9142 [THUPC 2023 \u521d\u8d5b] \u6b3a\u8bc8\u6e38\u620f \u9898\u89e3"
    },
    {
        "content": "\u5199\u70b9\u65e0\u8111\u505a\u6cd5\u3002\n\n\u8bbe\u8d70\u79c1\u8005\u7684\u7b56\u7565\u662f $p_i$ \u6982\u7387\u9009 $i$\uff0c\u68c0\u67e5\u5b98\u7684\u7b56\u7565\u662f $q_i$ \u6982\u7387\u9009 $i$\u3002\n\n\u56e0\u4e3a\u4e24\u8005\u7b56\u7565\u5747\u6700\u4f18\uff0c\u6240\u4ee5\u8d70\u79c1\u8005\u9009\u4efb\u610f\u4e00\u4e2a\u6570\u5f97\u5230\u7684\u671f\u671b\u6536\u76ca\u76f8\u540c\uff0c\u68c0\u67e5\u5b98\u9009\u4efb\u610f\u4e00\u4e2a\u6570\u5f97\u5230\u7684\u671f\u671b\u6536\u76ca\u4e5f\u76f8\u540c\uff0c\u4e0b\u9762\u53ea\u8ba8\u8bba\u68c0\u5bdf\u5b98\u65b9\u9762\u7684\u6982\u7387\u786e\u5b9a\u3002\n\n\u82e5\u8d70\u79c1\u8005\u9009 $i$\uff0c\u90a3\u4e48\u8d70\u79c1\u8005\u7684\u671f\u671b\u6536\u76ca\u4e3a\uff1a\n\n$$\nw_i=i\\sum_{j<i} q_j+\\sum_{j>i} q_j\\frac j 2\n$$\n\n\u56e0\u4e3a\u6536\u76ca\u76f8\u540c\uff0c\u6240\u4ee5 $w_{i+1}-w_i=0$\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$\n\\sum_{j<i}q_j+(i+1)q_i-q_{i+1}\\frac {i+1}{2}=0\n$$\n\n\u8bb0 $q_i$ \u7684\u524d\u7f00\u548c\u4e3a $s_i$\uff0c\u6709\uff1a\n\n$$\ns_{i-1}+(i+1)(s_i-s_{i-1})-\\frac {i+1}{2}(s_{i+1}-s_i)=0\n$$\n\n\u6ce8\u610f\u5230 $s_n=1$\uff0c\u8fd9\u4e9b\u65b9\u7a0b\u5199\u6210\u77e9\u9635\u662f\u4e00\u4e2a\u5f62\u5982\u4e0b\u56fe\u7684\u5e26\u72b6\u77e9\u9635\uff1a\n\n```\n1100\n1110\n0111\n0011\n```\n\n\u4f7f\u7528[\u5e26\u72b6\u77e9\u9635\u9ad8\u65af\u6d88\u5143](https://www.luogu.com.cn/blog/froggy/qian-tan-gao-si-xiao-yuan-ta-zhan-zhi-band-matrix)\u5373\u53ef\u5728 $O(d^2n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u5f97\u5230\u7b54\u6848\uff0c\u672c\u9898\u4e2d $d=2$\uff0c\u6c42 $p$ \u7684\u65b9\u6cd5\u7c7b\u4f3c\u3002\n\n```cpp\nint ans[N],a[N],b[N];\nsigned main() {\n   \tint n=read();\n   \tFOR(i,1,n) {\n   \t\tif(i-1>0) g[i][i-1]=mod-i+1;\n   \t\tg[i][i]=3ll*i%mod*inv2%mod;\n   \t\tif(i+1<=n) g[i][i+1]=(mod-1ll*i*inv2%mod)%mod;\n   \t\telse g[i][n+1]=1ll*i*inv2%mod;\n   \t}\n   \tGuass(n,2,ans);\n   \tans[n+1]=1;\n   \tFOR(i,1,n+1) b[i]=(ans[i]-ans[i-1]+mod)%mod;\n   \tFOR(i,1,n) {\n   \t\tif(i-1>0) g[i][i-1]=(mod-1ll*(i-1)*inv2%mod)%mod;\n   \t\tg[i][i]=3ll*i%mod*inv2%mod;\n   \t\tif(i+1<=n) g[i][i+1]=(mod-i)%mod;\n   \t\telse g[i][n+1]=i;\n   \t}\n   \tFOR(i,1,n+1) ans[i]=0;\n   \tGuass(n,2,ans);\n   \tans[n+1]=1;\n   \tFOR(i,1,n+1) a[i]=(ans[i]-ans[i-1]+mod)%mod;\n   \tFOR(i,1,n+1) printf(\"%d \",a[i]); puts(\"\");\n   \tFOR(i,1,n+1) printf(\"%d \",b[i]); puts(\"\");\n}\n```",
        "postTime": 1678238425,
        "uid": 175829,
        "name": "cnyzz",
        "ccfLevel": 0,
        "title": "P9142 \u65e0\u8111\u505a\u6cd5"
    },
    {
        "content": "\u8bbe\u8d70\u79c1\u8005\u653e $i$ \u5143\u7684\u6982\u7387\u4e3a $f(i)$\uff0c\u68c0\u5bdf\u5b98\u731c $i$ \u5143\u7684\u6982\u7387\u4e3a $g(i)$\uff0c\u5219\uff1a\n\n- \u8d70\u79c1\u8005\u653e $i$ \u5143\u65f6\uff0c\u8d70\u79c1\u8005\u7684\u671f\u671b\u6536\u76ca\u4e3a $E_1(i) = i \\displaystyle\\sum_{j = 0}^{i - 1} g(j) + \\frac{1}{2} \\sum_{j = i + 1}^n j g(j)$\u3002\n- \u68c0\u5bdf\u5b98\u731c $i$ \u5143\u65f6\uff0c\u8d70\u79c1\u8005\u7684\u671f\u671b\u6536\u76ca\u4e3a $E_2(i) = \\frac{i}{2} \\displaystyle\\sum_{j = 0}^{i - 1} f(j) + \\sum_{j = i + 1}^n j f(j)$\u3002\n\n\u8fd9\u91cc\u6211\u4eec\u4ee5\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u4e3a\u4f8b\uff08\u7b2c\u4e8c\u4e2a\u5f0f\u5b50\u7684\u540e\u7eed\u63a8\u5bfc\u4e0e\u4e4b\u76f8\u4f3c\uff09\u3002\n\n\u4e0b\u9762\u662f\u4e00\u4e2a\u5c0f~~\u4f46\u6211\u4e4b\u524d\u4e0d\u4f1a\u7684~~\u5957\u8def\u3002\n\n\u6ce8\u610f\u5230\u201c**\u4f60\u9700\u8981\u4fdd\u8bc1\uff0c\u5728\u4e00\u65b9\u7684\u7b56\u7565\u4e0d\u53d8\u7684\u60c5\u51b5\u4e0b\uff0c\u53e6\u4e00\u65b9\u65e0\u8bba\u5982\u4f55\u6539\u53d8\u81ea\u5df1\u7684\u7b56\u7565\uff0c\u90fd\u4e0d\u80fd\u4f7f\u81ea\u5df1\u7684\u671f\u671b\u6536\u76ca\u6bd4\u539f\u6765\u591a\u3002**\u201d\uff0c\u8003\u8651\u8c03\u6574\u6cd5\uff0c\u8bbe $\\Delta g(i) = g'(i) - g(i)$ \u8868\u793a\u5bf9\u8d70\u79c1\u8005\u7b56\u7565\u8fdb\u884c\u8c03\u6574\u7684\u5e45\u5ea6\u2014\u2014\u663e\u7136\u6709 $\\displaystyle\\sum_{i = 0}^n \\Delta g(i) = 0$\u3002\n\n\u7136\u540e\u6709 $\\displaystyle\\sum_{i = 0}^n \\Delta g(i) E_1(i) \\leq 0$ \u6052\u6210\u7acb\u3002\u5047\u5982\u6211\u4eec\u6293\u51fa $E_1(i)$ \u4e2d\u6700\u5927\u8005\u5e76\u7ed9\u5b83\u6574\u4e00\u4e2a\u5f88\u5927\u7684 $\\Delta g(i)$\uff0c\u82e5\u6b64\u65f6 $E_1(i)$ \u4e0d\u4e24\u4e24\u76f8\u7b49\uff0c\u5219\u4e00\u5b9a\u5b58\u5728\u4e00\u79cd $\\Delta g(i)$ \u4f7f\u4e4b\u4e0d\u5408\u6cd5\uff0c\u4e8e\u662f\u6211\u4eec\u5f97\u51fa\u4e86\u672c\u9898\u6700\u5173\u952e\u7684\u7ed3\u8bba\uff1a\n\n- $E_1(i)$ \u4e24\u4e24\u76f8\u7b49\u3002\n\n\u8003\u8651\u6293\u51fa\u6bd4\u8f83\u50cf\u7684\u76f8\u90bb\u4e24\u9879\u6765\u8ba8\u8bba\uff0c\u4e0b\u9762\u5047\u5b9a\u6211\u4eec\u8ba8\u8bba $E_1(i) = E_1(i + 1)$\uff1a\n\n- $i \\displaystyle\\sum_{j = 0}^{i - 1} g(j) + \\frac{1}{2} \\sum_{j = i + 1}^n j g(j) = (i + 1) \\sum_{j = 0}^i g(j) + \\frac{1}{2} \\sum_{j = i + 2}^n j g(j)$\u3002\n\n\u8fdb\u884c\u5316\u7b80\u540e\u53ef\u5f97\uff1a\n\n- $g(i) = \\dfrac{2((i - 1) g(i - 1) + \\displaystyle\\sum_{j = 0}^{i - 1} g(j))}{i}$\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5c06\u6240\u6709 $g(i)$ \u8868\u793a\u4e3a $g(0)$ \u7684\u500d\u6570\uff0c\u53c8\u56e0\u4e3a $\\displaystyle\\sum_{i = 0}^n g(i) = 1$\uff0c\u6211\u4eec\u5c06\u7cfb\u6570\u4ee3\u5165\u6c42\u51fa $g(0)$ \u5373\u53ef\u5f97\u51fa\u6240\u6709 $g(i)$\u3002\n\n\u540c\u7406\u53ef\u5f97\uff1a$f(i) = \\dfrac{(i - 1) f(i - 1) + \\displaystyle\\sum_{j = 0}^{i - 1} f(j)}{2i}$\u3002\n\n\u7ebf\u6027\u6c42\u9006\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n)$\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <stdio.h>\n\ntypedef long long ll;\n\nconst int mod = 998244353;\nll inv[800007], f[400007], g[400007];\n\ninline void init(int n){\n\tinv[0] = inv[1] = 1;\n\tfor (register int i = 2; i <= n; i++){\n\t\tinv[i] = mod - (mod / i) * inv[mod % i] % mod;\n\t}\n}\n\ninline ll quick_pow(ll x, ll p, ll mod){\n\tll ans = 1;\n\twhile (p){\n\t\tif (p & 1) ans = ans * x % mod;\n\t\tx = x * x % mod;\n\t\tp >>= 1;\n\t}\n\treturn ans;\n}\n\nint main(){\n\tint n;\n\tll pre = 0, sumf = 0, sumg = 0;\n\tscanf(\"%d\", &n);\n\tinit(n * 2);\n\tf[0] = 1;\n\tfor (register int i = 1; i <= n; i++){\n\t\tpre = (pre + f[i - 1]) % mod;\n\t\tf[i] = (f[i - 1] * (i - 1) % mod + pre) % mod * inv[i * 2] % mod;\n\t}\n\tfor (register int i = 0; i <= n; i++){\n\t\tsumf = (sumf + f[i]) % mod;\n\t}\n\tsumf = quick_pow(sumf, mod - 2, mod);\n\tfor (register int i = 0; i <= n; i++){\n\t\tprintf(\"%lld \", f[i] * sumf % mod); \n\t}\n\tprintf(\"\\n\");\n\tpre = 0;\n\tg[0] = 1;\n\tfor (register int i = 1; i <= n; i++){\n\t\tpre = (pre + g[i - 1]) % mod;\n\t\tg[i] = (g[i - 1] * (i - 1) % mod + pre) % mod * 2 % mod * inv[i] % mod;\n\t}\n\tfor (register int i = 0; i <= n; i++){\n\t\tsumg = (sumg + g[i]) % mod;\n\t}\n\tsumg = quick_pow(sumg, mod - 2, mod);\n\tfor (register int i = 0; i <= n; i++){\n\t\tprintf(\"%lld \", g[i] * sumg % mod); \n\t}\n\treturn 0;\n}\n```",
        "postTime": 1679301193,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P9142 \u3010[THUPC 2023 \u521d\u8d5b] \u6b3a\u8bc8\u6e38\u620f\u3011"
    },
    {
        "content": "## Analysis\n\n\u7b80\u5355\u63a8\u67ff\u5b50\u3002\n\n\u5047\u8bbe\u8d70\u79c1\u8005\u9009 $x$ \u7684\u6982\u7387\u662f $F(x)$\uff0c\u68c0\u5bdf\u5b98\u9009 $x$ \u7684\u6982\u7387\u662f $G(x)$\u3002\n\n\u90a3\u4e48\u671f\u671b\u8d70\u79c1\u7684\u91d1\u989d\u662f\uff1a\n\n$$\n\\sum_{i=0}^n\\sum_{j=0}^{i-1}F(i)G(j)\\cdot i+\\sum_{i=0}^n\\sum_{j=i+1}^nF(i)G(j)\\cdot\\frac{j}{2}\n$$\n\n\u5148\u8003\u8651\u6c42\u51fa $F$ \u7684\u9012\u63a8\u5f0f\u3002\u8003\u8651\u6539\u53d8 $G$ \u53d8\u4e3a $G'$\uff0c\u5b9a\u4e49 $H(i)=G'(i)-G(i)$\uff0c\u663e\u7136 $\\sum H=0$\u3002\u6839\u636e\u9898\u610f\uff0c\u9700\u8981\u4fdd\u8bc1\u5bf9\u4e8e\u4efb\u610f $H$\uff0c\u6ee1\u8db3\uff1a\n\n$$\n\\sum_{i=0}^n\\sum_{j=0}^{i-1}F(i)H(j)\\cdot i+\\sum_{i=0}^n\\sum_{j=i+1}^nF(i)H(j)\\cdot\\frac{j}{2}\\ge 0\n$$\n\n\u5982\u679c\u5bf9\u6240\u6709\u7684 $H(i)$ \u5747\u53d6\u53cd\uff0c\u90a3\u4e48\u8be5\u67ff\u5b50\u7684\u503c\u4e5f\u4f1a\u53d6\u53cd\u3002\u56e0\u6b64\u9700\u8981\u6ee1\u8db3\uff1a\n\n$$\n\\sum_{i=0}^n\\sum_{j=0}^{i-1}F(i)H(j)\\cdot i+\\sum_{i=0}^n\\sum_{j=i+1}^nF(i)H(j)\\cdot\\frac{j}{2}= 0\n$$\n\n\u5316\u7b80\u4e00\u4e0b\u67ff\u5b50\uff0c\u5f97\uff1a\n\n$$\n\\sum_{i=0}^nH(i)\\cdot\\left(\\sum_{j=0}^{i-1}F(j)\\cdot \\frac{i}{2}+\\sum_{j=i+1}^nF(j)\\cdot j\\right)\n$$\n\n\u7531\u4e8e $\\sum H=0$\uff0c\u56e0\u6b64\u53ea\u9700\u8981\u4fdd\u8bc1\u5bf9\u4e8e\u6240\u6709\u7684 $i$\uff0c\u6ee1\u8db3\n\n$$\n\\sum_{j=0}^{i-1}F(j)\\cdot \\frac{i}{2}+\\sum_{j=i+1}^nF(j)\\cdot j\n$$\n\n\u7684\u503c\u90fd\u76f8\u7b49\uff0c\u505a\u5dee\u5206\u5373\u53ef\u6c42\u51fa\u9012\u63a8\u5f0f\u3002\n\n$G$ \u7684\u9012\u63a8\u5f0f\u6c42\u6cd5\u4e0e $F$ \u7c7b\u4f3c\uff0c\u4e0d\u518d\u8d58\u8ff0\u3002\n\n## Code\n\n```cpp\nconst Z iv2 = (P + 1) / 2;\n\nconst int N = 800010;\n\nint n;\nZ a[N], b[N], fac[N], ivf[N];\n\nvoid trans(Z *c) {\n  Z sum = 0;\n  rep (i, 0, n) sum += c[i];\n  Z iv = sum.inv();\n  rep (i, 0, n) c[i] *= iv;\n}\n\nint main() {\n  fac[0] = 1;\n  rep (i, 1, N - 1) fac[i] = fac[i - 1] * i;\n  ivf[N - 1] = fac[N - 1].inv();\n  per (i, N - 1, 1) ivf[i - 1] = ivf[i] * i;\n  n = read();\n  trans(a), trans(b);\n  a[0] = 1, b[0] = 1;\n  Z suma = 0, sumb = 0;\n  rep (i, 0, n) {\n    a[i + 1] = (Z(i + 1) * iv2 * a[i] + iv2 * suma) / Z(i + 1);\n    suma += a[i];\n    b[i + 1] = Z(2) * (sumb + Z(i + 1) * b[i]) / Z(i + 1);\n    sumb += b[i];\n  }\n  trans(a);\n  rep (i, 0, n) write(a[i].val()), pc(32);\n  pc(10);\n  trans(b);\n  rep (i, 0, n) write(b[i].val()), pc(32);\n  pc(10);\n}\n```",
        "postTime": 1678194749,
        "uid": 169574,
        "name": "Enucai",
        "ccfLevel": 7,
        "title": "P9142 [THUPC 2023 \u521d\u8d5b] \u6b3a\u8bc8\u6e38\u620f"
    },
    {
        "content": "## \u7eb3\u4ec0\u5747\u8861\u4e0e\u6c42\u89e3\u65b9\u6cd5\n\n\u8003\u8651\u4e00\u4e2a\u4e24\u540d\u73a9\u5bb6 $A$ \u548c $B$ \u53c2\u4e0e\u7684\u6e38\u620f\uff0c\u5148\u624b\u6709 $n$ \u79cd\u7b56\u7565\uff0c\u8bb0\u4f5c $\\mathcal F_{1, 2, \\cdots, n}$\uff0c\u540e\u624b\u6709 $m$ \u79cd\u7b56\u7565\uff0c\u8bb0\u4f5c $\\mathcal G_{1, 2, \\cdots, n}$\u3002\u5bf9\u4e8e\u4efb\u610f $x\\in [1, n]$ \u548c $y\\in [1, m]$\uff0c\u53ef\u4ee5\u5b9a\u4e49\u4e00\u4e2a\u5206\u6570 $P_{x, y}$ \u4e3a\u5b9e\u6570\uff0c\u4ee3\u8868\u82e5\u5148\u624b\u91c7\u53d6 $\\mathcal F_x$ \u800c\u540e\u624b\u91c7\u53d6 $\\mathcal G_y$\uff0c\u5219\u5148\u624b\u5f97\u5230 $P_{x, y}$ \u5206\u3002\n\n\u6211\u4eec\u79f0 A \u7684\u4e00\u79cd\u7b56\u7565\u4e3a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5b9e\u6570\u6570\u5217 $p$\uff0c\u4e14\u8bf8\u9879\u4e4b\u548c\u4e3a $1$\uff0c$p_i$ \u4ee3\u8868\u4ee5 $p_i$ \u7684\u6982\u7387\u9009\u53d6 $\\mathcal F_i$\u3002\u5b9a\u4e49\u4e00\u4e2a\u64cd\u4f5c\u7684\u5206\u6570\u4e3a $\\min\\limits_{q_1+q_2+\\cdots+q_m = 1, \\forall i , q_i\\in[0, 1]} \\{\\sum\\limits_{i, j} p_i q_j P_{i, j}\\}$\u3002\n\n\u5148\u624b\u5fc5\u7136\u6709\u4e00\u4e2a\u7b56\u7565\u6700\u5927\u5316\u5176\u5206\u6570\uff0c\u540e\u624b\u5fc5\u7136\u4e5f\u6709\u4e00\u4e2a\u7b56\u7565\u6700\u5c0f\u5316\u5148\u624b\u7684\u5206\u6570\uff0c\u8fd9\u4e24\u4e2a\u503c\u5fc5\u7136\u662f\u76f8\u7b49\u7684\uff0c\u8fd9\u4e24\u4e2a\u7b56\u7565\u79f0\u4f5c\u7eb3\u4ec0\u5747\u8861\u3002\n\n\u82e5\u6b32\u6c42\u7eb3\u4ec0\u5747\u8861\uff0c\u4e0d\u59a8\u5047\u8bbe\u6700\u5927\u5206\u6570\u4e3a $E$\uff0c\u53ef\u4ee5\u5217\u51fa\u6761\u4ef6\uff1a\n\n$$\\exists \\{p_i\\}, p_i\\in[0, 1], \\sum p_i=1, \\forall \\{q_i\\},q_i\\in[0, 1], \\sum q_i = 1, \\sum\\limits_{i, j} p_i q_j P_{i, j}\\leq E$$\n\n\u663e\u7136\u6211\u4eec\u4e0d\u9700\u8981\u8fd9\u4e48\u591a\u6761\u4ef6\uff1a\u53ea\u9700\u8981 $m$ \u4e2a\u5c31\u591f\u4e86\u3002\n\n$$\\exists \\{p_i\\}, p_i\\in[0, 1], \\sum p_i=1, \\forall j\\in[1, m], \\sum\\limits_{i} p_i P_{i, j}\\leq E$$\n\n\u82e5\u80fd\u6ee1\u8db3\u8fd9 $m$ \u4e2a\u6761\u4ef6\uff0c\u5219\u5fc5\u7136\u53ef\u4ee5\u6ee1\u8db3\u4efb\u610f\u9009\u53d6 $q_j$ \u7684\u4e0d\u7b49\u5f0f\uff0c\u53ea\u9700\u8981\u5c06\u6240\u6709 $j$\uff0c\u7b2c $j$ \u4e2a\u6761\u4ef6\u7684\u4e0d\u7b49\u5f0f\u4e58\u4e0a $q_j$\uff0c\u7136\u540e\u6c42\u548c\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u5bf9\u5e94\u7684 $q_j$ \u7684\u4e0d\u7b49\u5f0f\u3002\n\n\u91cd\u5199\u6210\u53e6\u4e00\u79cd\u5f62\u5f0f\uff1a\n\n$$\n\\max E. \\text{ subject to} \\\\\n\n\\left\\{\n\\begin{aligned}\n&p_1, p_2, \\cdots , p_n \\in [0, 1] \\\\\n&\\sum p_i = 1\\\\\n&\\sum\\limits p_i P_{i, 1}\\leq E \\\\\n&\\sum\\limits p_i P_{i, 2}\\leq E \\\\\n&\\cdots \\\\\n&\\sum\\limits p_i P_{i, m}\\leq E\n\\end{aligned}\n\\right.\n$$\n\n\u4ee4 $x_i$ \u4e3a\u82e5\u5e72\u672a\u77e5\u6570\uff0c\u6ee1\u8db3 $x_i = \\frac{p_i}{E}$\uff0c\u53ef\u4ee5\u91cd\u5199\u4e3a\n\n$$\n\\min \\sum x_i. \\text{ subject to} \\\\\n\n\\left\\{\n\\begin{aligned}\n&\\sum\\limits x_i P_{i, 1}\\leq 1 \\\\\n&\\sum\\limits x_i P_{i, 2}\\leq 1 \\\\\n&\\cdots \\\\\n&\\sum\\limits x_i P_{i, m}\\leq 1\n\\end{aligned}\n\\right.\n$$\n\n\u53ef\u4ee5\u76f4\u63a5\u5229\u7528\u7ebf\u6027\u89c4\u5212\u6c42\u89e3\u3002\n\n\u4f46\u662f\u7ebf\u6027\u89c4\u5212\u592a\u9ebb\u70e6\u4e86\uff0c\u80fd\u4e0d\u80fd\u518d\u7ed9\u529b\u4e00\u70b9\uff1f\n\n\u6211\u4eec\u76f4\u63a5\u8003\u8651\u65b9\u7a0b\u7ec4\n\n$$\n\\left\\{\n\\begin{aligned}\n&\\sum p_i = 1\\\\\n&\\sum\\limits p_i P_{i, 1} = \\sum\\limits p_i P_{i, m}\\\\\n&\\sum\\limits p_i P_{i, 2} = \\sum\\limits p_i P_{i, m}\\\\\n&\\cdots \\\\\n&\\sum\\limits p_i P_{i, m-1} = \\sum\\limits p_i P_{i, m}\n\\end{aligned}\n\\right.\n$$\n\n\u82e5\u65b9\u7a0b\u7ec4\u7684\u89e3\u6ee1\u8db3\u6240\u6709 $p_i$ \u5747\u4e3a\u6b63\u6570\uff0c\u90a3\u4e48\u65b9\u7a0b\u7ec4\u7684\u89e3 $p_i$ \u5c31\u662f\u5148\u624b\u7684\u6700\u4f18\u7b56\u7565\u3002\n\n\u8bc1\u660e\u7559\u7ed9\u8bfb\u8005\u505a\u4f5c\u4e1a\u3002\n\n## P9142 \u9898\u89e3\n\n\u5217\u51fa\u7eb3\u4ec0\u5747\u8861\u540e\u76f4\u63a5\u6c42\u89e3\u65b9\u7a0b\u7ec4\u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define f(i,x,y) for(int i=x, i##end=y; i<=i##end; ++i)\n#define d(i,x,y) for(int i=y, i##end=x; i>=i##end; --i)\n#define uf(i,x,y) for(int i=x, i##end=y; i<i##end; ++i)\n#define ll long long\n#define pir pair<int, int>\n#define fir first\n#define sec second\n#define mp make_pair\n#define pb push_back \n#define int long long\nchar ch;\nint rd() {\n  int f=1, x=0; ch=getchar();\n  while(!isdigit(ch)) { f=((ch=='-')?-1:f); ch=getchar(); }\n  while(isdigit(ch)) { x=x*10+ch-'0'; ch=getchar(); }\n  return x*f;\n}\nvoid rd(int& x) { x=rd(); }\nusing namespace std;\nconst int _ = 1e6 + 5, mod = 998244353;\nint qpow(int a, int b) {\n  int res=1; for(; b; b>>=1, a=a*a%mod) if(b&1) res=res*a%mod; return res;\n}\nint v[_], s[_];\n// n/2 v_n = \\sum i=0 .. n-1 vi + (n-1)v{n-1}\n// q1 = 2q0\n// q2 = 5q0\nint n;\nsigned main() {\n  rd(n);\n  v[0] = 1; v[1] = 2; s[0] = 1; s[1] = 3;\n  f(i,2,n) {\n    v[i] = (s[i-1] + (i-1) * v[i-1] % mod) % mod;\n    v[i] = v[i] * 2 * qpow(i, mod-2) % mod;\n    s[i] = s[i-1] + v[i];\n    // cerr << i << ' ' << v[i] << endl;\n  }\n  // cerr << v[2] << endl;\n  int ans = 2 * qpow(n+2, mod-2) % mod;\n  cout << ans << ' ';\n  f(i,1,n) {\n    ans = qpow(n+2, mod-2);\n    cout << ans << ' ';\n  }\n  cout << endl;\n  ll s = 0;\n  f(i,0,n) { s += v[i]; s %= mod; }\n  s = qpow(s, mod-2);\n  // cerr << \"s = \" << s << endl;\n  f(i,0,n) {\n    ans = v[i] * s % mod;\n    cout << ans << ' ';\n  }\n  cout << endl;\n  return 0;\n}\n```",
        "postTime": 1678175050,
        "uid": 133345,
        "name": "lightup37",
        "ccfLevel": 6,
        "title": "P9142 [THUPC 2023 \u521d\u8d5b] LIAR GAME! \u9898\u89e3 & \u7eb3\u4ec0\u5747\u8861\u6d45\u63a2"
    },
    {
        "content": "## \u524d\u8a00\n\n\u554a\u5bf9\u5bf9\u5bf9\u53ea\u6709\u6211\u4eec\u961f\u5728\u63a8\u5f0f\u5b50\u522b\u4eba\u5168\u5728\u6253\u8868\u6211\u4eec\u8fd8\u662f\u4e00\u904d\u8fc7\u4f46\u662f\u665a\u5f00\uff0c\u5c31\u79bb\u8c31\u3002\n\n## \u9898\u76ee\u7b80\u8ff0\n\n\u6709\u4e24\u4e2a\u6570\u7ec4 $P_1[n+1]$ \u548c $P_2[n+1]$\uff0c\u6211\u4eec\u8981\u5bf9\u8fd9\u4e24\u4e2a\u6570\u7ec4\u8fdb\u884c\u8c03\u6574\uff0c\u8981\u6c42\u6ee1\u8db3\uff1a\n\n1. $\\sum\\limits_{i=0}^nP_1[i]=\\sum\\limits_{i=0}^nP_2[i]=1$\n2. \u8bbe\u6709\u4e8b\u4ef6 $A$\uff1a\u6709\u4e24\u4e2a\u6570 $a,b$\uff0c\u6bcf\u6b21\u4ee5 $P_1[i]$ \u4e3a\u968f\u673a\u51fa $a=i$ \u7684\u6982\u7387\uff0c\u4ee5 $P_2[i]$ \u4e3a\u968f\u673a\u51fa $b=i$ \u7684\u6982\u7387\uff0c\u5982\u679c $a>b$\uff0c\u90a3\u4e48 $A$ \u4e8b\u4ef6\u8d21\u732e\u4e3a $a$\uff1b\u82e5 $b>a$\uff0c\u90a3\u4e48 $A$ \u4e8b\u4ef6\u7684\u8d21\u732e\u4e3a $\\dfrac b2$\u3002\n\n\t\u8c03\u6574 $P_1[n+1]$ \u4f7f\u5f97A\u4e8b\u4ef6\u8d21\u732e\u7684\u671f\u671b\u503c\u5c3d\u91cf\u5927\uff0c\u8c03\u6574 $P_2[n+1]$ \u4f7f\u5f97A\u4e8b\u4ef6\u8d21\u732e\u7684\u671f\u671b\u503c\u5c3d\u91cf\u5c0f\u3002\n    \n## \u89e3\u9898\u601d\u8def\n\n\u770b\u5230\u8fd9\u9898\u76ee\u6211\u4eec\u4f1a\u53d1\u73b0\u8fd9\u73a9\u610f\u5728\u767e\u5ea6\u767e\u79d1\u4e0a\u53cc\u65b9\u6267\u884c\u7684\u90fd\u662f[\u6df7\u5408\u6218\u7565](https://baike.baidu.com/item/%E6%B7%B7%E5%90%88%E6%88%98%E7%95%A5/6748998?fr=aladdin)\u3002\n\n\u7136\u540e\u6211\u4eec\u641c\u7d22[\u6df7\u5408\u6218\u7565\u535a\u5f08\u8bba](https://www.baidu.com/s?ie=utf-8&f=8&rsv_bp=1&rsv_idx=1&tn=baidu&wd=%E6%B7%B7%E5%90%88%E6%88%98%E7%95%A5%E5%8D%9A%E5%BC%88%E8%AE%BA&fenlei=256&oq=%25E5%258D%259A%25E5%25BC%2588%25E8%25AE%25BA%25E6%25B7%25B7%25E5%2590%2588%25E6%2588%2598%25E7%2595%25A5&rsv_pq=ff4f20f500060398&rsv_t=d7bbEKNOYNnDLcfltK4Y1EiyG2%2F3zecM3SMabyORJAdn5nfyC%2B7IDlaTBoc&rqlang=cn&rsv_enter=1&rsv_dl=tb&rsv_btype=t&rsv_sug3=19&rsv_sug1=11&rsv_sug7=100&bs=%E5%8D%9A%E5%BC%88%E8%AE%BA%E6%B7%B7%E5%90%88%E6%88%98%E7%95%A5)\u5c31\u4f1a\u53d1\u73b0\u6709\u4e00\u4e2a\u4e1c\u897f\u53eb\u505a[\u7eb3\u4ec0\u5e73\u8861](https://zhuanlan.zhihu.com/p/148772400?ivk_sa=1024320u)\u3002\n\n\u7136\u540e\u4f60\u53ef\u4ee5\u518d\u53bb\u767e\u5ea6\u767e\u79d1\u4e0a\u641c\u7d22[\u7eb3\u4ec0\u5e73\u8861](https://baike.baidu.com/item/%E7%BA%B3%E4%BB%80%E5%9D%87%E8%A1%A1/534868?fromtitle=%E7%BA%B3%E4%BB%80%E5%B9%B3%E8%A1%A1&fromid=1325910&fr=aladdin)\n\n\u5bf9\u6211\u53ef\u4ee5\u544a\u8bc9\u4f60\u8d5b\u65f6**\u4e0d\u4f7f\u7528oeis**\u505a\u8fd9\u9053\u9898\u7684\u524d\u63d0\u6761\u4ef6\u662f\u4f1a\u8fd9\u4e2a\u4e1c\u897f\u3002~~\uff08\u81ea\u7136\u6392\u9664\u4e86\u4f60\u662f\u627e\u89c4\u5f8b\u505a\u548c\u6253\u8868\u505a\u7684\u60c5\u51b5\uff09~~\u3002\n\n\u5176\u4ed6\u4e1c\u897f\u54b1\u53ef\u4ee5\u4e0d\u770b\u61c2\uff0c\u6211\u4eec\u53ea\u9700\u6ce8\u610f\u4e00\u4e2a\u8981\u70b9\uff0c\u5c31\u662f\uff1a\n\n**\u4efb\u4f55\u4e00\u4f4d\u73a9\u5bb6\u5728\u6b64\u7b56\u7565\u7ec4\u5408\u4e0b\u5355\u65b9\u9762\u6539\u53d8\u81ea\u5df1\u7684\u7b56\u7565\uff08\u5176\u4ed6\u73a9\u5bb6\u7b56\u7565\u4e0d\u53d8\uff09\u90fd\u4e0d\u4f1a\u63d0\u9ad8\u81ea\u8eab\u7684\u6536\u76ca\u3002**\n\n\u5728\u8fd9\u9898\u91cc\uff0c\u5c31\u76f8\u5f53\u4e8e\u4e00\u65b9\u4e0d\u53d8\u65f6\u53e6\u4e00\u65b9\u600e\u4e48\u53d8\u671f\u671b\u90fd\u4e0d\u4f1a\u53d8\uff0c\u90fd\u8bf4\u5230\u597d\u50cf\u8fd9\u91cc\u4e86\u4e0d\u628a\u671f\u671b\u7684\u5f0f\u5b50\u5199\u51fa\u6765\u90fd\u4e0d\u597d\u610f\u601d\u3002\n\n\u6309\u7167\u76f4\u89c2\u7406\u89e3\u5217\u51fa\u9898\u76ee\u7684\u671f\u671b\uff1a\n\n$$\\sum_{i=0}^n\\sum_{j=0}^{i-1}P_1[i]P_2[j]i+\\sum_{i=0}^n\\sum_{j=i+1}^{n}P_1[i]P_2[j]\\frac j2$$\n\n\u6211\u4eec\u5148\u5047\u8bbe\u6570\u7ec4 $P_2$ \u4e0d\u53d8\uff0c\u90a3\u5c31\u81ea\u7136\u63d0\u51fa\u4e00\u4e2a $\\sum_{i=0}^nP_1[i]$\u3002\n\n$$\\sum_{i=0}^nP_1[i]\\left(\\sum_{j=0}^{i-1}P_2[j]i+\\sum_{j=i+1}^{n}P_2[j]\\frac j2\\right)$$\n\n\u597d\u7684\uff0c\u6211\u4eec\u53d1\u73b0\u4e0d\u8bba $P_1$ \u600e\u4e48\u53d8\u5bf9\u6b64\u5f0f\u65e0\u5f71\u54cd\u3002\u56e0\u4e3a $\\sum P_1[]=1$ \u662f\u5e38\u6570\uff0c\u9664\u4e86\u540e\u9762\u8fd9\u4e2a\u5f0f\u5b50\u4e3a $0$ \u7684\u60c5\u51b5\u5916\u8fd8\u6709\u4e00\u4e2a\u60c5\u51b5\uff0c\u5c31\u662f**\u6b64\u5f0f\u4e0d\u968f** $i$ **\u7684\u53d8\u5316\u800c\u53d8\u5316**\u3002\n\n\u90a3\u4e48\u4e3a\u4e86\u65b9\u4fbf\u8868\u793a\uff0c\u6211\u8bbe $f(i)=\\sum\\limits_{j=0}^{i-1}P_2[j]i+\\sum\\limits_{j=i+1}^{n}P_2[j]\\frac j2$\n\n$\\begin{aligned}\n\\because &\\forall i,j\\in [0,n], &f(i)&=f(j)\\\\\n\\therefore &\\forall i\\in [0,n+1],&f(i)&=f(i+1)\\iff f(i+1)-f(i)=0\\\\\n\\end{aligned}$\n\n\u6240\u4ee5\u6709:\n\n$\\sum\\limits_{j=0}^{i}P_2[j](i+1)+\\sum\\limits_{j=i+2}^{n}P_2[j]\\frac j2-\\sum\\limits_{j=0}^{i-1}P_2[j]i-\\sum\\limits_{j=i+1}^{n}P_2[j]\\frac j2=0$\n\n\u6211\u4eec\u5f00\u59cb\u81ea\u4fe1\u63a8\u5f0f\u5b50\uff1a\n\n$\\begin{aligned}\n&\\text{\u539f\u5f0f}\\\\\n\\iff&\\sum\\limits_{j=0}^{i}P_2[j]i+\\sum\\limits_{j=0}^{i}P_2[j]+\\sum\\limits_{j=i+2}^{n}P_2[j]\\frac j2-\\sum\\limits_{j=0}^{i-1}P_2[j]i-\\sum\\limits_{j=i+1}^{n}P_2[j]\\frac j2=0\\\\\n\\iff&P_2[i]i+\\sum\\limits_{j=0}^{i}P_2[j]-P_2[i+1]\\frac {i+1}2=0\\\\\n\\iff&P_2[i+1]\\frac {i+1}2=P_2[i]i+\\sum\\limits_{j=0}^{i}P_2[j]\\\\\n\\iff&P_2[i+1]=\\dfrac2{i+1}\\left(P_2[i]i+\\sum\\limits_{j=0}^{i}P_2[j]\\right)\n\\end{aligned}$\n\n\u975e\u5e38\u597d\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u9012\u63a8\u5f0f\uff0c$\\forall i\\in[0,n-1]$\uff0c\u6b64\u5f0f\u90fd\u6210\u7acb\u3002\n\n\u5bf9\u554a\u6709\u4e86 $n$ \u4e2a $n+1$ \u5143\u4e00\u6b21\u65b9\u7a0b\u3002\n\n\u54e6\u6211\u4eec\u8fd8\u6709\u4e00\u4e2a $\\sum\\limits_{i=0}^n P_2[i]=1$\n\n\u90a3\u8fd9\u4e0d\u5c31\u662f $n+1$ \u4e2a $n+1$ \u5143\u4e00\u6b21\u65b9\u7a0b\u6784\u6210\u7684\u65b9\u7a0b\u7ec4\u5417\u3002\n\n\u540c\u6837\u7684\uff0c\u8bbe $P_1$ \u4e0d\u53d8\u53ef\u4ee5\u5f97\u5230 $P_1$ \u7684\u9012\u63a8\u5f0f\uff1a\n\n$P_1[i+1]=\\dfrac1{2(i+1)}\\left(P_1[i]i+\\sum\\limits_{j=0}^{i}P_1[j]\\right)$\n\n\u54e6\u6709\u4eba\u89e3\u8fd9\u79cd\u65b9\u7a0b\u7ec4\u7528\u9ad8\u65af\u6d88\u5143\u554a\uff0c\u5176\u5b9e\u4e0d\u7528\u3002\n\n\u8bb0\u5f55\u4e00\u4e0b\u4e24\u4e2a\u6570\u7ec4\u524d\u7f00\u548c\u7528\u6765\u9012\u63a8\u6211\u4eec\u5c31\u53ef\u4ee5\u5b66\u4e60[\u67d0\u9053CF](https://www.luogu.com.cn/problem/CF1778D)\u6253\u51fa\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n)$ \u7684\u4ee3\u7801\u4e86\u3002\n\n## \u9012\u63a8\u505a\u6cd5\u8be6\u89e3\n\n\u5982\u679c\u4f60\u6ca1\u6709\u505a\u8fc7\u8fd9\u4e2aCF\u9898\u53ef\u4ee5\u770b\u8fd9\u4e00\u90e8\u5206\u3002\n\n\u8fd9\u91cc\u4ee5 $P_1$ \u4e3a\u4f8b\u3002\n\n\u7531\u4e8e\u6211\u4eec\u662f\u4ece $P_1[0]$ \u5f00\u59cb\u9012\u63a8\u7684\uff0c\u5047\u8bbe $P_1[0]=x$\u3002\n\n\u7531\u4e8e\u8fd9\u91cc\u6ca1\u6709\u4e24\u9879\u7684\u4e58\u79ef\uff0c\u53ea\u6709\u5e38\u6570\u6216\u662f\u4e00\u6b21\u9879\uff0c\u76f4\u63a5\u5199\u4e00\u4e2a\u7ef4\u62a4\u5f62\u4e3a $ax+b$ \u7684\u7ed3\u6784\u4f53\u5373\u53ef\u3002\n\n\u6700\u540e\u628a\u6240\u6709\u9879\u76f8\u52a0\u4e3a $1$\uff0c\u4e5f\u5c31\u662f $\\sum_{i=0}^n a_ix +b_i=x\\sum_{i=0}^na_i+\\sum_{i=0}^nb_i=1$\uff0c\u89e3\u4e00\u4e2a\u4e00\u5143\u4e00\u6b21\u65b9\u7a0b\u628a $x$ \u7b97\u51fa\u6765\u3002\n\n\uff08\u4e0a\u9762\u7684\u5f0f\u5b50\u4e2d\uff0c$a_i,b_i$ \u7684\u610f\u4e49\u4e3a\uff1a$P_1[i]=a_ix+b_i$\uff09\n\n\u7136\u540e\u6bcf\u4e00\u4e2a $P_1[i]$ \u91cd\u65b0\u7528 $x$ \u4ee3\u5165\u4e00\u904d\u5373\u53ef\u3002\n\n~~\u73b0\u5728\u4f60\u8fd8\u53ef\u4ee5\u628a\u90a3\u9053CF\u8fc7\u4e86~~\n\n## Codes\n\n\u540c\u961f\u7684\u540c\u5b66\u5177\u4f53\u5b9e\u73b0\u7684\uff0c\u5f81\u6c42\u4e86\u4ed6\u7684\u540c\u610f\u642c\u8fc7\u6765\u4e86\u3002\n\n\u8fd9\u79cd\u9898\u8fd8\u662f\u8bf4\u4e00\u58f0\u53d6\u6a21\uff08\u867d\u7136\u5e94\u8be5\u6ca1\u4ec0\u4e48\u5927\u95ee\u9898\uff09\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll mod = 998244353;\nll n;\nll ksm( ll a , unsigned long long p ) {\n    ll ans = 1;\n    while ( p ) {\n        if ( p & 1 ) {\n            ans = ans * a % mod;\n        }\n        p >>= 1;\n        a = a * a % mod;\n    }\n    return ans;\n}\nstruct lin {// ax+b\u7684\u7ed3\u6784\u4f53\n    ll k, b;\n    lin() = default;\n    lin( ll k_, ll b_ ) {\n        k = k_, b = b_;\n    }\n    const lin operator + ( const lin rhs ) const {\n        return lin((k+rhs.k)%mod,(b+rhs.b)%mod);\n    }\n    const lin operator - ( const lin rhs ) const {\n        return lin((k-rhs.k+mod)%mod,(b-rhs.b+mod)%mod);\n    }\n    const lin operator * ( const ll rhs ) const {\n        return lin(k*rhs%mod,b*rhs%mod);\n    }\n    const ll operator == ( const lin rhs ) const {\n        ll _b = ( rhs.b - b + mod ) % mod;\n        ll _k = ( k - rhs.k + mod ) % mod;\n        return _b * ksm(_k,mod-2);\n    }\n    const ll operator () ( const ll rhs ) const {\n        return (rhs*k+b) % mod;\n    }\n};\nlin p1[400005], s1[400005];\nlin p2[400005], s2[400005];//s1,s2\u5206\u522b\u4e3ap1,p2\u7684\u524d\u7f00\u548c\nint main() {\n    scanf(\"%lld\",&n);\n    p1[0] = lin{1,0};\n    s1[0] = lin{1,0};\n    for ( ll i = 1; i <= n; ++i ) {//p1\u9012\u63a8\u90e8\u5206\n        p1[i] = p1[i-1] * ( i - 1 ) + s1[i-1];\n        p1[i] = p1[i] * ksm(i, mod-2) * ksm(2,mod-2);\n        s1[i] = s1[i-1] + p1[i];\n    }\n    ll a = ( s1[n] == lin{0,1} );\n    for ( ll i = 0; i <= n; ++i ) {\n        printf(\"%lld \",p1[i](a));\n    }\n    puts(\"\");\n    p2[0] = lin{1,0};\n    s2[0] = lin{1,0};\n    for ( ll i = 1; i <= n; ++i ) {//p2\u9012\u63a8\u90e8\u5206\n        p2[i] = p2[i-1] * (i-1) + s2[i-1];\n        p2[i] = p2[i] * 2 * ksm(i, mod-2);\n        s2[i] = s2[i-1] + p2[i];\n    }\n    a = ( s2[n] == lin{0,1} );\n    for ( ll i = 0; i <= n; ++i ) {\n        printf(\"%lld \",p2[i](a));\n    }\n}\n```",
        "postTime": 1678099593,
        "uid": 185048,
        "name": "SmallBlack",
        "ccfLevel": 0,
        "title": "THUPC \u6b3a\u8bc8\u6e38\u620f"
    },
    {
        "content": "### \u601d\u8def\n\n\u4ee5\u4e0d\u540c\u89d2\u8272\u7684\u89c6\u89d2\uff0c\u5408\u5e76\u540c\u7c7b\u9879\u3002\n\n\u628a\u4e00\u65b9\u770b\u505a\u662f\u53d8\u91cf\u65f6\uff0c\u5176\u4f59\u6240\u6709\u770b\u4f5c\u662f\u5e38\u91cf\u3002\n\n\u5bf9\u4e8e\u8d70\u79c1\u8005\u6765\u8bf4\uff0c\u6536\u76ca\u5f62\u5982 $ {\\textstyle \\sum_{}p_{i} } \\times {\\textstyle \\sum_{}x_{(i,j)}w_{(j)} }$\u3002\n\n\u6b64\u65f6\uff0c\u5bf9\u4e8e\u68c0\u5bdf\u5b98\u6765\u8bf4\uff0c\u4ee4 $n$ \u4e2a\u7cfb\u6570 ${\\textstyle \\sum_{}x_{(i,j)}w_{(j)} }$ \u90fd\u76f8\u540c\u3002\n\n\u5373\u8d70\u79c1\u8005\u4e0d\u7ba1\u600e\u4e48\u9009\u62e9\uff0c\u8d70\u79c1\u8005\u90fd\u53ea\u80fd\u83b7\u5f97\u56fa\u5b9a\u6536\u76ca\u3002\n\n\u5bdf\u5b98\u8fbe\u5230\u4e86\u4f7f\u5bf9\u65b9\u5229\u76ca\u6700\u5c0f\u5316\u7684\u76ee\u7684\uff08\u4e0d\u5b58\u5728\u6bd4\u8fd9\u5927\u7684\u53ef\u80fd\u6027\uff09\u3002\n\n\u5bf9\u4e8e\u68c0\u5bdf\u5b98\u6765\u8bf4\uff0c\u6536\u76ca\u5f62\u5982 ${\\textstyle \\sum_{}w_{i} } \\times {\\textstyle \\sum_{}x_{(i,j)}p_{(j)} }$\u3002\n\n\u6b64\u65f6\uff0c\u5bf9\u4e8e\u8d70\u79c1\u8005\u6765\u8bf4\uff0c\u4ee4 $n$ \u4e2a\u7cfb\u6570 ${\\textstyle \\sum_{}x_{(i,j)}p_{(j)} }$ \u90fd\u76f8\u540c\u3002\n\n\u5373\u68c0\u5bdf\u5b98\u4e0d\u7ba1\u600e\u4e48\u9009\u62e9\uff0c\u8d70\u79c1\u8005\u90fd\u53ea\u80fd\u83b7\u5f97\u56fa\u5b9a\u6536\u76ca\u3002\n\n\u8d70\u79c1\u8005\u8fbe\u5230\u4e86\u81ea\u5df1\u5229\u76ca\u6700\u5927\u5316\u7684\u76ee\u7684\uff08\u4e0d\u5b58\u5728\u6bd4\u8fd9\u5c0f\u7684\u53ef\u80fd\u6027\uff09\u3002\n\n### CODE\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N=1e6+10,mod=998244353;\nint n,p[N],w[N],sump,sumw,is,ip,inv[N];\nint modpow(int x,int n,int mod){\n    int res=1;\n    for(;n;n>>=1,x=1ll*x*x%mod){\n        if(n&1)res=1ll*res*x%mod;\n    }\n    return res;\n}\nvoid init(){\n    inv[1]=1;\n    for(int i=2;i<N;i++){\n        inv[i]=1ll*inv[mod%i]*(mod-mod/i)%mod;\n    }\n}\nint main(){\n    scanf(\"%d\",&n);\n    //assert(1<=n && n<=400000);\n    init();\n    w[0]=1;\n    for(int i=0;i<=n;++i){\n        w[i+1]=(sumw+1ll*(i+1)*w[i]%mod)%mod;\n        w[i+1]=2ll*w[i+1]%mod;\n        w[i+1]=1ll*w[i+1]*inv[i+1]%mod;\n        sumw=(sumw+w[i])%mod;\n    }\n    /*\n    p[0]=1;p[1]=modpow(2,mod-2,mod);\n    sump=p[0];\n    for(int i=1;i<=n;++i){\n        p[i+1]=1ll*inv[2]*sump%mod;\n        p[i+1]=(p[i+1]+1ll*(i+1)*inv[2]%mod*p[i]%mod)%mod;\n        p[i+1]=1ll*inv[i]*p[i+1]%mod;\n        sump=(sump+p[i])%mod;\n    }*/\n    //ip=modpow(sump,mod-2,mod);\n    is=modpow(sumw,mod-2,mod);\n    //printf(\"1/8:%d 2/8:%d\\n\",modpow(8,mod-2,mod),modpow(4,mod-2,mod));\n    //assert(sum!=0);\n    //printf(\"sum:%d is:%d\\n\",sum,is);\n    ip=inv[n+2];\n    for(int i=0;i<=n;++i){\n        if(i==0)p[i]=2ll*ip%mod;\n        else p[i]=ip;\n        printf(\"%d%c\",p[i],\" \\n\"[i==n]);\n    }\n    for(int i=0;i<=n;++i){\n        w[i]=1ll*w[i]*is%mod;\n        printf(\"%d%c\",w[i],\" \\n\"[i==n]);\n    }\n    return 0;\n}\n```\n",
        "postTime": 1679827934,
        "uid": 925577,
        "name": "ULSG_XBaiC",
        "ccfLevel": 0,
        "title": "P9142 [THUPC 2023 \u521d\u8d5b] \u6b3a\u8bc8\u6e38\u620f \u9898\u89e3"
    },
    {
        "content": "\u6ce8\u610f\u5230\u8f93\u51fa\u683c\u5f0f\u4e2d\u6709\u4e00\u53e5\u975e\u5e38\u91cd\u8981\u7684\u8bdd\uff1a**\u53e6\u4e00\u65b9\u65e0\u8bba\u5982\u4f55\u6539\u53d8\u81ea\u5df1\u7684\u7b56\u7565\uff0c\u90fd\u4e0d\u80fd\u4f7f\u81ea\u5df1\u7684\u671f\u671b\u6536\u76ca\u6bd4\u539f\u6765\u591a\u3002**\n\n\u6211\u4eec\u8bbe\u5355\u8f6e\u535a\u5f08\u4e2d\u8d70\u79c1\u8005\u51fa\u94b1\u7684\u6982\u7387\u4e3a $a_{0\\cdots n}$\uff0c\u68c0\u5bdf\u5b98\u731c\u94b1\u7684\u6982\u7387\u4e3a $b_{0\\cdots n}$\uff0c\u90a3\u4e48\u671f\u671b\u5c31\u4e3a\n\n$$\n\\sum_{i=0}^na_i(i\\sum_{j=0}^{i-1}b_j+\\sum_{j=i+1}^nb_j\\frac{j}{2})\n$$\n\n\u8bbe $f_i=i\\sum_{j=0}^{i-1}b_j+\\sum_{j=i+1}^nb_j\\dfrac{j}{2}$\uff0c\u6839\u636e\u9898\u610f\u6240\u6709\u7684 $f_i$ \u90fd\u76f8\u540c\uff0c\u4e5f\u5c31\u662f $f_i-f_{i+1}=0$\u3002\n\n$$\n\\begin{aligned}\nf_{i}-f_{i+1} &=i\\sum_{j=0}^{i-1}b_j-(i+1)\\sum_{j=0}^ib_j+\\sum_{j=i+1}^nb_j\\frac{j}{2}-\\sum_{j=i+2}^nb_j\\frac{j}{2}\\\\\n&=-(\\sum_{j=0}^{i-1}b_j+(i+1)b_i)+b_{i+1}\\frac{i+1}{2}\\\\\nb_{i+1}\\frac{i+1}{2} &=\\sum_{j=0}^{i-1}b_j+(i+1)b_i\n\\end{aligned}\n$$\n\n\u8bbe $b_0=x$\uff0c\u90a3\u4e48 $b_i$ \u4e00\u5b9a\u80fd\u591f\u8868\u793a\u6210 $k_ix$ \u7684\u5f62\u5f0f\u3002\u6700\u540e\u6839\u636e $\\sum_{i=0}^nb_i=1$ \u6c42\u51fa $x$ \u7684\u503c\uff0c\u7136\u540e\u56de\u5e26\u5373\u53ef\u3002\n\n$a$ \u6570\u7ec4\u540c\u7406\uff0c\u6839\u636e\u4e00\u6837\u7684\u65b9\u5f0f\u53ef\u4ee5\u63a8\u5f97\u5b83\u7684\u503c\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define For(i,a,b) for(int i=(a);i<=(b);++i)\n#define Rof(i,a,b) for(int i=(a);i>=(b);--i)\nusing namespace std;\nconst int Maxn=4e5,Mod=998244353,i2=(Mod+1)/2;\n\ninline int Pow(int x,int y)\n{\n    int res=1;\n    while(y)\n    {\n        if(y&1) res=1ll*res*x%Mod;\n        x=1ll*x*x%Mod,y>>=1;\n    }\n    return res;\n}\n\nint n,A[Maxn+5],B[Maxn+5];\nstruct Num\n{\n    int k,b;\n    inline Num() {}\n    inline Num(int _k,int _b): k(_k),b(_b) {}\n} t[Maxn+5],sum;\ninline Num operator+(Num x,Num y) {return Num((x.k+y.k)%Mod,(x.b+y.b)%Mod);}\ninline Num operator-(Num x,Num y) {return Num((x.k-y.k+Mod)%Mod,(x.b-y.b+Mod)%Mod);}\ninline Num operator*(Num x,Num y) {return Num(1ll*x.k*y.k%Mod,1ll*x.b*y.b%Mod);}\ninline Num operator*(Num x,int y) {return Num(1ll*x.k*y%Mod,1ll*x.b*y%Mod);}\n\nsigned main()\n{\n    cin>>n; t[0].k=1;\n    For(i,0,n-1)\n    {\n        t[i+1]=(sum+t[i]*(i+1))*Pow(1ll*(i+1)*i2%Mod,Mod-2);\n        sum=sum+t[i];\n    } sum=sum+t[n];\n    int x=1ll*(1-sum.b+Mod)*Pow(sum.k,Mod-2)%Mod;\n    B[0]=x;\n    For(i,1,n) B[i]=(1ll*x*t[i].k+t[i].b)%Mod;\n    For(i,0,n) t[i].k=t[i].b=0; sum.k=sum.b=0;\n\n    t[0].k=1;\n    For(i,0,n-1)\n    {\n        t[i+1]=(sum*i2+t[i]*(1ll*(i+1)*i2%Mod))*Pow(i+1,Mod-2);\n        sum=sum+t[i];\n    } sum=sum+t[n];\n    x=1ll*(1-sum.b+Mod)*Pow(sum.k,Mod-2)%Mod;\n    A[0]=x;\n    For(i,1,n) A[i]=(1ll*x*t[i].k+t[i].b)%Mod;\n\n    For(i,0,n) printf(\"%lld \",A[i]);\n    printf(\"\\n\");\n    For(i,0,n) printf(\"%lld \",B[i]);\n    printf(\"\\n\");\n    return 0;\n}\n```",
        "postTime": 1678195009,
        "uid": 148913,
        "name": "Graphcity",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P9142\u3010[THUPC 2023 \u521d\u8d5b] \u6b3a\u8bc8\u6e38\u620f\u3011"
    }
]
[
    {
        "content": "\u4e0d\u59a8\u8bbe $F$ \u4e3a\u65b9\u6848\u6570\u7684 GF\uff0c\u7528 $x$ \u8ba1\u91cf\u70b9\u6570\uff0c\u7528 $y$ \u8ba1\u91cf $k_1$ \u53c9\u7684\u70b9\u6570\uff0c\u90a3\u4e48\u663e\u7136\n$$\nG = x(yG^{k_1} + G^{k_2} + 1)\n$$\n\n\u6839\u636e\u62c9\u683c\u6717\u65e5\u53cd\u6f14\n$$\n[x^n] G = \\frac1n [x^{n-1}] (1+yx^{k_1}+x^{k_2})^n\n$$\n\n\u63d0\u53d6\u7cfb\u6570\n$$\n\\begin{aligned}\n[x^{n-1} y^k] (1+yx^{k_1}+x^{k_2})^n\n&= [x^{n-1} y^k] \\sum\\limits_{i=0}^n \\binom ni (yx^{k_1}+x^{k_2})^i \\\\\n&= \\sum\\limits_{i=0}^n \\binom ni \\binom ik [kk_1 + (i-k)k_2 = n-1]\n\\end{aligned}\n$$\n\n\u5bb9\u6613\u53d1\u73b0\u4f7f\u827e\u4f5b\u68ee\u62ec\u53f7\u53d6\u5230 $1$ \u7684 $i$ \u552f\u4e00\uff0c\u76f4\u63a5\u63d0\u53d6\u5373\u53ef\u3002  \n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$\u3002",
        "postTime": 1620196121,
        "uid": 75840,
        "name": "deserter",
        "ccfLevel": 0,
        "title": "P7592"
    },
    {
        "content": "\u867d\u7136\u5f62\u5f0f\u5316\u9898\u610f\u5f88\u795e\u5947\u4f46\u662f\u6211\u4eec\u8fd8\u662f\u53ef\u4ee5\u76f4\u63a5\u8bbe\u51fa\u4e8c\u5143\u751f\u6210\u51fd\u6570 $\\mathcal F(u,t)=\\sum_{i}\\sum_{j}f_{i,j}x^{i}x^{j}$ \u5176\u4e2d $f_{i,j}$ \u8868\u793a $i$ \u4e2a\u70b9\u6743\u503c\u4e3a $j$ \u7684\u6811\u5bf9\u5e94\u7684\u672c\u8d28\u4e0d\u540c\u62ec\u53f7\u5e8f\u5217\u6570\u91cf \u4e0d\u96be\u5f97\u5230:\n\n$$\n\\mathcal F(u,t)=u(1+t^a\\mathcal F^{k_1}(u,t)+t^b\\mathcal F^{k_2}(u,t))\n$$\n\n\u8fd9\u4e2a $u$ \u663e\u7136\u662f\u653e\u7740\u7ed9\u6211\u4eec\u62c9\u53cd\u73a9\u7684:\n$$\n[u^n]\\mathcal F(u,t)=\\frac{1}{n}[u^{n-1}](1+t^au^{k_1}+t^{b}u^{k_2})^n\n$$\n\u6211\u4eec\u8981\u7684\u7b54\u6848\u5b9e\u9645\u662f:\n$$\n\\frac{[u^n]\\left.\\frac{\\operatorname{\\partial}\\mathcal F(u,t)}{\\operatorname{\\partial} t}\\right |_{t=1}}{[u^n]\\mathcal F(u,1)}\n$$\n\u5bf9\u4e8e\u5206\u6bcd\u76f4\u63a5\u628a $t=1$ \u5e26\u8fdb\u53bb\u7b97\u5c31\u597d\u4e86\n\n\u5206\u5b50\u7684\u8bdd\u5bf9\u62c9\u53cd\u7684\u5f0f\u5b50\u5de6\u53f3\u540c\u65f6\u7528 $\\frac{\\operatorname{\\partial}}{\\operatorname{\\partial} t}$ \u53ef\u4ee5\u5f97\u5230:\n$$\n\\begin{aligned}\n[u^n]\\left.\\frac{\\operatorname{\\partial}\\mathcal F(u,t)}{\\operatorname{\\partial} t}\\right |_{t=1}&=\\frac{1}{n}[u^{n-1}]\\left.\\frac{\\operatorname{\\partial}(1+t^au^{k_1}+t^{b}u^{k_2})^n}{\\operatorname{\\partial} t}\\right |_{t=1}\\\\\n&=\\frac{1}{n}[u^{n-1}]n(1+u^{k_1}+u^{k_2})^{n-1}(au^{k_1}+bu^{k_2})\n\\end{aligned}\n$$\n\u540c\u6837\u4e5f\u53ef\u4ee5\u76f4\u63a5\u7b97\u4e86",
        "postTime": 1620211201,
        "uid": 68030,
        "name": "serverkiller",
        "ccfLevel": 0,
        "title": "P7592 \u6570\u6811"
    },
    {
        "content": "[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/T170223?contestId=41599)\n\n**\u524d\u7f6e\u77e5\u8bc6**\n\n\uff081\uff09\u751f\u6210\u51fd\u6570\uff08\u89e3\u51b3\u7ec4\u5408\u6216\u6392\u5217\u95ee\u9898\u7684\u4e00\u79cd\u6709\u529b\u5de5\u5177\uff09\uff1a\n- [\u6d45\u8c08\u751f\u6210\u51fd\u6570\u4e4bOGF](https://zhuanlan.zhihu.com/p/52817010)\n- [Ordinary Generating Function](http://math.ucsd.edu/~ebender/CombText/ch-10.pdf)\n\n\n\uff082\uff09\u62c9\u683c\u6717\u65e5\u53cd\u6f14\uff08\u6839\u636e\u590d\u5408\u9006\u5f97\u5230\u51fd\u6570\u7684\u67d0\u9879\u7cfb\u6570\uff09\uff1a\n- [\u62c9\u683c\u6717\u65e5\u53cd\u6f14](https://blog.csdn.net/qq_33229466/article/details/96037367)\n- [Lagrange Inversion Formula](https://users.math.msu.edu/users/magyarp/Math880/Lagrange.pdf)\n\n**\u6b63\u6587**\n\n\u6d4f\u89c8\u4e00\u904d\u9898\u76ee\uff0c\u53ef\u77e5\u7b49\u6982\u7387\u751f\u6210\u4e00\u68f5\u7b26\u5408\u9898\u76ee\u7ea6\u675f\u7684\u6811\uff0c\u5176 $v(\\mathcal T)$ \u7684\u671f\u671b\u503c\u7b49\u4e8e\u6240\u6709\u6811\u7684\u6743\u503c $v$ \u4e4b\u548c\u9664\u4ee5\u4e0d\u540c\u6784\u6811\u7684\u603b\u6570 $c$\u3002\u7531\u4e8e $a$\uff0c$b$ \u5747\u4e3a\u6574\u6570\uff0c\u53ef\u77e5 $v$ \u5fc5\u5b9a\u662f\u6574\u6570\uff0c\u800c $c$ \u663e\u7136\u662f\u6574\u6570\uff0c\u5f53 $n$ \u8f83\u5c0f\u65f6\uff0c\u53ef\u4ee5\u66b4\u529b\u751f\u6210\u6240\u6709\u53ef\u80fd\u7684\u6811\uff0c\u5206\u522b\u7edf\u8ba1\u6743\u503c\u548c\u5f97\u5230\u7b54\u6848\u3002\u5f53 $n$ \u8f83\u5927\u65f6\uff0c\u9700\u8981\u5bfb\u627e\u9ad8\u6548\u7684\u65b9\u6cd5\uff08\u9644\u6ce8\uff1a\u6d4b\u8bd5\u70b9 $1$ \u662f\u7ed9\u66b4\u529b\u751f\u6210\u6811\u7684\u89e3\u9898\u8005\u8bbe\u7f6e\uff0c\u6d4b\u8bd5\u70b9 $2$ \u662f\u7ed9\u66b4\u529b\u751f\u6210\u6811\u5e76\u52a0\u4ee5\u9002\u5f53\u526a\u679d\u7684\u89e3\u9898\u8005\u8bbe\u7f6e\uff0c\u6d4b\u8bd5\u70b9 $3$ \u548c $4$ \u662f\u4e3a\u6f5c\u5728\u7684 $\\mathcal O(n^2)$\u52a8\u6001\u89c4\u5212\u8bbe\u7f6e\uff1b\u6d4b\u8bd5\u70b9 $5$ \u548c $6$ \u7559\u7ed9\u613f\u610f\u5199\u591a\u9879\u5f0f\u7b97\u6cd5\u7684\u89e3\u9898\u8005\uff0c\u65f6\u95f4 $\\mathcal O(n\\log n)$\uff0c\u8981\u6ce8\u610f\u5e38\u6570\uff09\u3002\n\n\u9996\u5148\u7ed9\u51fa\u7ed3\u8bba\uff1a\n\n$$\\large \\mathbb{E}(v(\\mathcal T)) = \\frac{[x^{n-1}]\\left(\\left(1+x^{k_1}+x^{k_2}\\right)^{n-1}\\left(ax^{k_1}+bx^{k_2}\\right)\\right)}{\\dfrac{1}{n}[x^{n-1}]\\left(1+x^{k_1}+x^{k_2}\\right)^n}$$\n\n\u5148\u786e\u5b9a\u5206\u6bcd\u3002\u4ee4\u7b26\u5408\u9898\u610f\u8981\u6c42\u7684\u7531 $n$ \u4e2a\u70b9\u7ec4\u6210\u7684\u4e0d\u540c\u6784\u7684\u6811\u7684\u6570\u91cf\u6240\u6784\u6210\u5e8f\u5217\u7684\u666e\u901a\u751f\u6210\u51fd\u6570\u4e3a $\\mathbf F(x)$\uff0c\u7531\u9898\u610f\uff0c\u53ea\u6709 $1$ \u4e2a\u7ed3\u70b9\u7684\u4efb\u610f $k_1-k_2~\\mathrm{Tree}$ \u7684\u6570\u91cf\u4e3a $1$\uff0c\u56e0\u6b64 $\\mathbf F(x)$ \u7684\u4e00\u6b21\u5e42 $x$ \u7684\u7cfb\u6570\u4e3a $1$\uff0c\u6839\u7ed3\u70b9\u6709 $k_1$ \u68f5\u5b50\u6811\uff08\u6216\u8005 $k_2$ \u68f5\u5b50\u6811\uff09\uff0c\u8fd9 $k_1$ \u68f5\u5b50\u6811\uff08\u6216\u8005 $k_2$ \u68f5\u5b50\u6811\uff09\u603b\u7684\u7ed3\u70b9\u6570\u4e3a $n - 1$\uff0c\u4e14\u5b50\u6811\u4e5f\u662f $k_1-k_2~\\mathrm{Tree}$\uff0c\u7ed3\u5408\u5224\u5b9a\u540c\u6784\u7684\u89c4\u5219\uff0c\n\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$\\mathbf F(x)=x\\left(1+\\mathbf F^{k_1}(x)+\\mathbf F^{k_2}(x)\\right)$$\n\n\u89c2\u5bdf\u53ef\u77e5 $\\mathbf F(x)$ \u7684\u96f6\u6b21\u9879\u7cfb\u6570\u4e3a $0$\uff0c\u4e00\u6b21\u9879\u7cfb\u6570\u4e3a $1$\uff0c\u4e14\uff1a\n\n$$x=\\dfrac{x\\left(1+\\mathbf F^{k_1}(x)+\\mathbf F^{k_2}(x)\\right)}{1+\\mathbf F^{k_1}(x)+\\mathbf F^{k_2}(x)}=\\dfrac{\\mathbf F(x)}{1+\\mathbf F^{k_1}(x)+\\mathbf F^{k_2}(x)}$$\n\n\u56e0\u6b64\u5176\u590d\u5408\u9006\u4e3a\uff1a\n\n$$\\mathbf{F}^{\\langle-1\\rangle}(x)=\\dfrac{x}{1+x^{k_1}+x^{k_2}}$$\n\n\u6839\u636e\u62c9\u683c\u6717\u65e5\u53cd\u6f14\uff0c\u6709\uff1a\n\n$$[x^n]\\mathbf F(x)=\\dfrac{1}{n}[x^{n-1}]\\left(1+x^{k_1}+x^{k_2}\\right)^n$$\n\n\u6b63\u662f\u5206\u6bcd\u3002\n\n\u73b0\u5728\u8981\u8003\u8651\u6c42\u6240\u6709\u6811\u7684\u6743\u503c\u548c\uff0c\u4e00\u4e2a\u5e38\u89c1\u7684\u601d\u8def\u662f\u4f7f\u7528\u591a\u5143\u751f\u6210\u51fd\u6570\uff0c\u7136\u540e\u6c42\u5bfc\u3002\n\n\u4ee4\n\n$$\\mathbf F(x,\\ z)=\\displaystyle \\sum f_{n,m}x^nz^m$$\n\n\u5176\u4e2d $f_{n,m}$ \u8868\u793a $n$ \u4e2a\u7ed3\u70b9\u7684 $k_1-k_2~\\mathrm{Tree}$ \u6743\u503c\u548c\u4e3a $m$ \u7684\u65b9\u6848\u6570\uff0c\u7531\u4e8e\u6839\u7ed3\u70b9\u8981\u4e48\u6709 $k_1$ \u68f5\u5b50\u6811\uff0c\u8981\u4e48\u6709 $k_2$ \u68f5\u5b50\u6811\uff0c\u8981\u4e48\u6ca1\u6709\u5b50\u6811\u3002\u5982\u679c\u6709 $k_1$ \u68f5\u5b50\u6811\uff0c\u52a0\u4e0a\u6839\u7ed3\u70b9\u540e\uff0c\u53c8\u6784\u6210\u4e86\u4e00\u4e2a $k_1$ \u53c9\u7ed3\u70b9\uff0c\u6bcf\u79cd\u65b9\u6848\u589e\u52a0\u4e86 $a$ \u5206\u3002\u5982\u679c\u6709 $k_2$ \u68f5\u5b50\u6811\uff0c\u52a0\u4e0a\u6839\u7ed3\u70b9\u540e\uff0c\u53c8\u6784\u6210\u4e86\u4e00\u4e2a $k_2$ \u53c9\u7ed3\u70b9\uff0c\u6bcf\u79cd\u65b9\u6848\u589e\u52a0\u4e86 $b$ \u5206\u3002\u5982\u679c\u6811\u4e2d\u53ea\u5305\u542b\u6839\u7ed3\u70b9\uff0c\u5219\u7531\u4e8e $1$ \u4e2a\u7ed3\u70b9\u7684 $k_1-k_2~\\mathrm{Tree}$ \u6743\u503c\u548c\u4e3a $0$ \u7684\u65b9\u6848\u6570\u4e3a $1$\uff0c\u6545\u6709\uff1a\n\n$$\\mathbf F(x,\\ z)=x\\left( 1 + z^{a}\\mathbf F^{k_1}(x,z) + z^b\\mathbf F^{k_2}(x,z) \\right)$$\n\n\u7c7b\u4f3c\u5730\uff0c\u5bb9\u6613\u53d1\u73b0 $x$ \u8fd9\u4e00\u7ef4\u7684\u590d\u5408\u9006\u662f:\n\n$$\\mathbf F_x^{\\langle -1\\rangle}(x,\\ z)=\\dfrac{x}{1+z^{a}x^{k_1}+z^bx^{k_2}}$$\n\n\u663e\u7136\u591a\u5143\u751f\u6210\u51fd\u6570\u4e5f\u53ef\u4ee5\u8fdb\u884c\u62c9\u683c\u6717\u65e5\u53cd\u6f14\uff1a\n\n$$[x^n]\\mathbf F(x,\\ z)=\\frac{1}{n}[x^{n-1}]\\left( 1+z^ax^{k_1}+z^{b}x^{k_2} \\right)^n$$\n\n\u4ee4\uff1a\n\n$$\\zeta (x,\\ z)=\\left(1+z^ax^{k_1}+z^bx^{k_2}\\right)^n$$\n\n\u73b0\u5728\u8981\u6c42\u6743\u503c\u548c\uff0c\u5bf9 $z$ \u8fd9\u4e00\u7ef4\u6c42\u5bfc\uff1a\n\n$$\\frac{\\partial\\zeta(x,\\ z)}{\\partial z}=n\\left( 1+z^ax^{k_1}+z^bx^{k_2} \\right)^{n-1}\\left(az^{a-1}x^{k_1}+ bz^{b-1}x^{k_2} \\right)$$\n\n\u663e\u7136\u6743\u503c\u548c\u5c31\u662f\uff1a\n\n$$[x^n]\\frac{\\partial \\mathbf F(x,\\ z)}{\\partial  z}\\biggr\\vert_{z=1}=\\frac{1}{n}[x^{n-1}]\\frac{\\partial\\zeta(x,\\ z)}{\\partial z}\\biggr\\vert_{z=1}=[x^{n-1}]\\left ( \\left( 1 +x^{k_1}+x^{k_2} \\right)^{n-1}\\left( ax^{k_1}+bx^{k_2} \\right) \\right)$$\n\n\u53ef\u4ee5 $\\mathcal O(n)$ \u679a\u4e3e $x^{k_1}$ \u9009\u4e86\u51e0\u6b21\uff0c\u7528\u591a\u9879\u5f0f\u7cfb\u6570\u8ba1\u7b97\u7b54\u6848\u5373\u53ef\u3002\u7531\u4e8e\u9700\u8981\u6c42\u540c\u4f59\u65b9\u7a0b\u7684\u89e3\uff0c\u53ef\u4ee5\u5c06\u6c42\u9006\u5143\u4e0e\u89e3\u9898\u4ee3\u7801\u6709\u673a\u7ed3\u5408\u3002\n\n\n\u51fa\u9898\u4eba\u7ed9\u51fa\u7684\u6807\u7a0b\uff1a\n```cpp\n\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int N = 1e7 + 5, mod = 998244353;\n\ninline int inc(int a, int b) { return (a += b - mod) + (a >> 31 & mod); }\ninline int dec(int a, int b) { return (a -= b) + (a >> 31 & mod); }\ninline int mul(int a, int b) { return 1ll * a * b % mod; }\ninline void Inc(int &a, int b) { return void(a = inc(a, b)); }\ninline void Dec(int &a, int b) { return void(a = dec(a, b)); }\ninline void Mul(int &a, int b) { return void(a = mul(a, b)); }\ninline int Pow(int a, int b) {\n    int c = 1;\n    for (; b; Mul(a, a), b >>= 1)\n        if (1 & b)\n            Mul(c, a);\n    return c;\n}\ninline int Inv(int x) { return Pow(x, mod - 2); }\n\nint fac[N], inv[N], n, k1, k2, a, b, tot, Sum;\n\ninline int Polycoef(int n, int m, int k) { return mul(fac[n + m + k], mul(mul(inv[n], inv[m]), inv[k])); }\n\nint main(void) {\n    scanf(\"%d%d%d%d%d\", &k1, &k2, &n, &a, &b);\n    fac[0] = 1;\n    for (int i = 1; i <= n; i++) fac[i] = mul(fac[i - 1], i);\n    inv[1] = 1;\n    for (int i = 2; i <= n; i++) inv[i] = mul(mod - mod / i, inv[mod % i]);\n    inv[0] = 1;\n    for (int i = 1; i <= n; i++) Mul(inv[i], inv[i - 1]);\n    for (int i = 0; i <= n; i++)\n        if (i * k1 <= n - 1) {\n            int res = n - 1 - i * k1;\n            if (res % k2)\n                continue;\n            int j = res / k2;\n            if (j > n)\n                continue;\n            Inc(tot, Polycoef(i, j, n - i - j));\n        }\n    for (int i = 0; i <= n - 1; i++)\n        if (i * k1 <= n - 1 - k1) {\n            int res = n - 1 - k1 - i * k1;\n            if (res % k2)\n                continue;\n            int j = res / k2;\n            if (j > n - 1)\n                continue;\n            Inc(Sum, mul(Polycoef(i, j, n - 1 - i - j), a));\n        }\n    for (int i = 0; i <= n - 1; i++)\n        if (i * k1 <= n - 1 - k2) {\n            int res = n - 1 - k2 - i * k1;\n            if (res % k2)\n                continue;\n            int j = res / k2;\n            if (j > n - 1)\n                continue;\n            Inc(Sum, mul(Polycoef(i, j, n - 1 - i - j), b));\n        }\n    Mul(tot, Inv(n));\n    return printf(\"%d\\n\", mul(Sum, Inv(tot))) * 0;\n}\n```\n\n",
        "postTime": 1614691622,
        "uid": 333388,
        "name": "metaphysis",
        "ccfLevel": 0,
        "title": "\u6570\u6811\uff082021 CoE-II E\uff09"
    }
]
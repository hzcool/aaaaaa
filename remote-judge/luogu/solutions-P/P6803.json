[
    {
        "content": "## Des\n\n[P6803 [CEOI2020]\u661f\u9645\u8ff7\u822a](https://www.luogu.com.cn/problem/P6803)\n\n## Sol\n\n\u9996\u5148\u8bbe\u8d25\u70b9\u4e3a\u5148\u624b\u5fc5\u8d25\u7684\u70b9\uff0c\u80dc\u70b9\u4e3a\u5148\u624b\u5fc5\u80dc\u7684\u70b9\u3002\u8bb0\u80dc\u70b9 $dp_u=1$\uff0c\u8d25\u70b9 $dp_u=0$\u3002\n\n\u5728\u4e0d\u540c\u6811\u4e4b\u95f4\u8fde\u8fb9\u76f8\u5f53\u4e8e\u7ed9\u88ab\u8fde\u4e0a\u7684\u6811\u6362\u4e00\u4e2a\u6839\u3002\n\n\u5982\u679c\u4e00\u4e2a\u70b9\u63a5\u4e0a\u4e00\u4e2a\u8d25\u70b9\uff0c\u90a3\u4e48\u81ea\u5df1\u6709\u53ef\u80fd\u53d8\u6210\u80dc\u70b9\uff0c\u4ece\u800c\u5bfc\u81f4\u6839\u7684\u80dc\u8d1f\u60c5\u51b5\u53d1\u751f\u9006\u8f6c\uff08\u53d8\u6210\u80dc\u70b9\u6216\u8d25\u70b9\u90fd\u6709\u53ef\u80fd\uff09\u3002\u5982\u679c\u4e00\u4e2a\u70b9\u63a5\u4e0a\u4e00\u4e2a\u80dc\u70b9\u90a3\u4e48\u6ca1\u6709\u5f71\u54cd\u3002\n\n\u4e8e\u662f\u6362\u6839 DP \u6c42\u51fa\u6709\u591a\u5c11\u4e2a\u70b9\u8fde\u63a5\u8d25\u70b9\u540e\u4f1a\u4f7f\u6839\u7684\u80dc\u8d1f\u60c5\u51b5\u53d1\u751f\u9006\u8f6c\uff0c\u8bb0\u4e3a $R_u$\u3002\n\n\u8bb0\u6574\u68f5\u6811\u8d25\u70b9\u6570\u76ee\u4e3a $c$\uff0c\u8003\u8651 $D=1$ \u7684\u60c5\u51b5\u3002\u5982\u679c $1$ \u53f7\u70b9\u662f\u80dc\u70b9\uff0c\u90a3\u4e48\u7b54\u6848\u4e3a $(n-R_1)\\times c+(n-c)\\times n$\uff1b\u5982\u679c $1$ \u53f7\u70b9\u662f\u8d25\u70b9\uff0c\u90a3\u4e48\u7b54\u6848\u4e3a $R_1\\times c$\u3002\n\n\u7136\u540e\u8003\u8651 $D=2$ \u7684\u60c5\u51b5\u3002\u8bbe\u4ee5\u7b2c\u4e8c\u68f5\u6811\u8d25\u70b9\u7684\u7b54\u6848\u603b\u548c\u4e3a $f0$\uff0c\u80dc\u70b9\u7b54\u6848\u603b\u548c\u4e3a $f1$\u3002\u90a3\u4e48\u5bf9\u4e8e\u7b2c 0 \u9897\u6811\u7684\u6839\uff0c\u5982\u679c\u6839\u662f\u80dc\u70b9\uff0c\u90a3\u4e48\u7b54\u6848\u4e3a $(n-R_1)f0+nf1$\u3002\u5982\u679c\u6839\u662f\u8d25\u70b9\uff0c\u90a3\u4e48\u7b54\u6848\u4e3a $R_1f0$\u3002\n\n\u8003\u8651 $f0,f1$ \u600e\u4e48\u6c42\u3002$f0$ \u53ef\u80fd\u7531\u80dc\u70b9\u8f6c\u8d25\u70b9\u6216\u8d25\u70b9\u4e0d\u53d8\u7ec4\u6210\uff0c$f1$ \u540c\u7406\u3002\u4e8e\u662f\u6709\n\n$$\nf0=\\sum_u[dp_u=0](n-R_u)c+\\sum_u[dp_u=1]R_uc+\\sum_u[dp_u=0]n(n-c)\n$$\n\n$$\nf1=\\sum_u[dp_u=1](n-R_u)c+\\sum_u[dp_u=0]R_uc+\\sum_u[dp_u=1]n(n-c)\n$$\n\n\u5bf9\u4e8e $D=3$ \u7684\u60c5\u51b5\uff0c\u7b2c\u4e00\u68f5\u6811\u7684 $f0',f1'$ \u53ef\u4ee5\u7528\u7b2c\u4e8c\u68f5\u6811\u7684 $f0,f1$ \u8fed\u4ee3\u5f97\u5230\uff0c\u53ea\u9700\u628a\u4e0a\u9762\u516c\u5f0f\u4e2d\u7684 $c$ \u66ff\u6362\u4e3a $f0$\uff0c$n-c$ \u66ff\u6362\u4e3a $f1$\u3002$D$ \u66f4\u5927\u7684\u60c5\u51b5\u53ef\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\u3002\n\n\u6211\u4eec\u8bbe\u8f6c\u79fb\u77e9\u9635\u4e3a $T$\uff0c\u7b97\u51fa $T^{D-1}\\times \\begin{matrix}[c&n-c]\\end{matrix}$ \u5f97\u5230 $\\begin{matrix}[f0&f1]\\end{matrix}$\u3002\u518d\u6839\u636e\u4e00\u53f7\u70b9\u662f\u80dc\u70b9\u8fd8\u662f\u8d25\u70b9\u8f93\u51fa\u7b54\u6848\u4e3a $(n-R_1)\\times f0+n\\times f1$ \u6216 $R_1\\times f0$ \u5373\u53ef\u3002\n\n\u7136\u540e\u8bb2\u4e00\u4e0b\u6362\u6839 DP\u3002$R_u$ \u7684\u503c\u5728\u4e24\u79cd \u60c5\u51b5\u4e0b\u4e0d\u4e3a $0$\u3002\u4e00\u662f\u8282\u70b9\u5168\u90fd\u662f\u8d25\u70b9\uff0c\u8fd9\u6837 $R_u$ \u5c31\u7b49\u4e8e\u6240\u6709\u513f\u5b50 $R_v$ \u4e4b\u548c\u3002\u4e8c\u662f\u8282\u70b9\u6070\u6709\u4e00\u4e2a\u4e3a\u8d25\u70b9\uff0c\u8fd9\u6837 $R_u$ \u5c31\u7b49\u4e8e\u8be5\u70b9 $R_v$\u3002\u4e8e\u662f\u53ea\u9700\u8981\u7ef4\u62a4\u513f\u5b50\u8d25\u70b9\u7684\u6570\u91cf\u5373\u53ef\u6362\u6839 DP\u3002\n\n\u6700\u540e\u590d\u6742\u5ea6 $O(n+\\log D)$\u3002\n\n\u8fd9\u9053\u9898\u6bd4\u8f83\u9ebb\u70e6\u5730\u65b9\u5728\u4e8e $R_u$ \u7684\u8bbe\u7f6e\u3002\u5982\u679c\u5206\u6839\u4ece\u80dc\u70b9\u53d8\u8d25\u70b9\u548c\u4ece\u8d25\u70b9\u53d8\u80dc\u70b9\u5904\u7406\uff0c\u90a3\u4f60\u5927\u6982\u5c31\u8981\u5199\u4e24\u4e2a \u6362\u6839 DP\uff0c\u6bd4\u8f83\u9ebb\u70e6\u3002\u4f46\u7528 $R_u$ \u8868\u793a $u$ \u7684\u80dc\u8d1f\u9006\u8f6c\u540e\u5c31\u53d8\u5f97\u7b80\u5355\u4e86\u3002\n\n## My Code\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\ntypedef long long ll;\nconst int N = 1e5 + 5, D = 1e9 + 7;\ninline void Add(int &a, ll b) { a = (a + b) % D; }\nint n, c;\nll K;\nstruct mat {\n\tint a[2][2];\n\tmat(bool e = false) {\n\t\tmemset(a, 0, sizeof a);\n\t\tif(e) a[0][0] = a[1][1] = 1;\n\t}\n\tmat operator*(const mat &x) {\n\t\tmat y;\n\t\tfor(int i = 0; i < 2; i++)\n\t\t\tfor(int j = 0; j < 2; j++)\n\t\t\t\ty.a[i][j] = ((ll)a[i][0] * x.a[0][j] + (ll)a[i][1] * x.a[1][j]) % D;\n\t\treturn y;\n\t}\n};\nmat fpm(mat a, ll b) {\n\tmat res(true);\n\twhile(b) {\n\t\tif(b & 1) res = res * a;\n\t\tb >>= 1, a = a * a;\n\t}\n\treturn res;\n}\nvector<int> g[N];\nint dp[N], s0[N], R[N], SR[N][2];\n// SR[i][0] \u8868\u793a i \u53f7\u70b9\u6240\u6709 dp \u503c\u4e3a 0 \u7684\u513f\u5b50\u7684 R \u7684\u548c\uff0cSR[i][1] \u540c\u7406 \nvoid dfs1(int u, int f) {\n\tfor(int v : g[u]) {\n\t\tif(v == f) continue;\n\t\tdfs1(v, u);\n\t\ts0[u] += !dp[v];\n\t\tSR[u][dp[v]] += R[v];\n\t}\n\tdp[u] = (s0[u] > 0);\n\tif(s0[u] == 1) R[u] = SR[u][0];\n\telse if(s0[u] == 0) R[u] = SR[u][1] + 1;\n}\nint dp2[N], R2[N];\n// \u6362\u6839 DP \nvoid dfs2(int u, int f) {\n\tif(!dp[u]) ++c;\n\tR2[u] = R[u], dp2[u] = dp[u];\n\tfor(int v : g[u]) {\n\t\tif(v == f) continue;\n\t\tint s0u = s0[u], dpu = dp[u], Ru = R[u], SRu0 = SR[u][0], SRu1 = SR[u][1];\n\t\tint s0v = s0[v], dpv = dp[v], Rv = R[v], SRv0 = SR[v][0], SRv1 = SR[v][1];\n\n\t\ts0[u] -= !dp[v];\n\t\tdp[u] = (s0[u] > 0);\n\t\tSR[u][dp[v]] -= R[v];\n\t\tif(s0[u] == 1) R[u] = SR[u][0];\n\t\telse if(s0[u] == 0) R[u] = SR[u][1] + 1;\n\t\telse R[u] = 0;\n\t\tdp[v] |= !dp[u];\n\t\ts0[v] += !dp[u];\n\t\tSR[v][dp[u]] += R[u];\n\t\tif(s0[v] == 1) R[v] = SR[v][0];\n\t\telse if(s0[v] == 0) R[v] = SR[v][1] + 1;\n\t\telse R[v] = 0;\n\t\tdfs2(v, u);\n\n\t\ts0[u] = s0u, dp[u] = dpu, R[u] = Ru, SR[u][0] = SRu0, SR[u][1] = SRu1;\n\t\ts0[v] = s0v, dp[v] = dpv, R[v] = Rv, SR[v][0] = SRv0, SR[v][1] = SRv1;\n\t}\n}\n\nint main() {\n\tios::sync_with_stdio(false); cin.tie(nullptr);\n\tcin >> n >> K;\n\tfor(int i = 1, u, v; i < n; i++) {\n\t\tcin >> u >> v;\n\t\tg[u].emplace_back(v), g[v].emplace_back(u);\n\t}\n\tdfs1(1, 0);\n\tdfs2(1, 0);\n\t\n\tmat p, T;\n\t// \u5904\u7406\u8f6c\u79fb\u77e9\u9635 \n\tfor(int i = 1; i <= n; i++) {\n\t\tif(dp2[i] == 0) {\n\t\t\tAdd(T.a[0][0], n - R2[i]);\n\t\t\tAdd(T.a[1][0], n);\n\t\t\tAdd(T.a[0][1], R2[i]);\n\t\t} else if (dp2[i] == 1) {\n\t\t\tAdd(T.a[0][0], R2[i]);\n\t\t\tAdd(T.a[0][1], n - R2[i]);\n\t\t\tAdd(T.a[1][1], n);\n\t\t}\n\t}\n\tp.a[0][0] = c, p.a[0][1] = n - c;\n\tp = p * fpm(T, K - 1);\n\n\tint f0 = p.a[0][0], f1 = p.a[0][1];\n\tif(dp[1]) cout << ((ll)(n - R2[1]) * f0 + (ll)n * f1) % D << '\\n';\n\telse cout << (ll)R2[1] * f0 % D << '\\n';\n\n\treturn 0;\n}\n```",
        "postTime": 1646706274,
        "uid": 113181,
        "name": "\u6ed1\u84bb\u7a3d",
        "ccfLevel": 0,
        "title": "P6803 [CEOI2020]\u661f\u9645\u8ff7\u822a"
    },
    {
        "content": "[\u6211\u7684CEOI\u4f5c\u6218\u8bb0\u5f55&\u9898\u89e3-\u6d1b\u8c37\u535a\u5ba2](https://www.luogu.com.cn/blog/s-r-f/ceoi2020-zuo-zhan-ji-lu-ti-xie-shi-gong-zhong-post)\n\n[\u6211\u7684CEOI\u4f5c\u6218\u8bb0\u5f55&\u9898\u89e3-cnblogs](https://www.cnblogs.com/s-r-f/p/13581895.html)\n\n\u9996\u5148\u601d\u8003 $D=1$ \u600e\u4e48\u505a.\n\n\u4e0d\u96be\u53d1\u73b0,\u5982\u679c\u4e00\u4e2a\u65f6\u7a7a\u96a7\u9053\u6307\u5411\u4e86\u4e00\u4e2a\u5fc5\u80dc\u70b9,\u90a3\u4e48\u8fd9\u4e2a\u65f6\u7a7a\u96a7\u9053\u76f8\u5f53\u4e8e\u4e0d\u5b58\u5728;\u5426\u5219\u76f8\u5f53\u4e8e**\u5f3a\u5236\u628a\u8fd9\u4e00\u5c42\u7684\u67d0\u4e2a\u70b9 $x$ \u53d8\u4e3a\u4e86\u5fc5\u80dc\u70b9.**\n\n\u6362\u6839 DP \u6c42\u51fa $cnt_x$ \u8868\u793a\u80fd\u4f7f $x$ \u80dc\u8d1f\u72b6\u6001\u6539\u53d8\u7684**\u5f3a\u5236\u628a\u8fd9\u4e00\u5c42\u7684\u67d0\u4e2a\u70b9 $y$ \u53d8\u4e3a\u4e86\u5fc5\u80dc\u70b9\u7684\u64cd\u4f5c\u79cd\u6570.**\n\n\u8bb0**\u539f\u6811**\u4e0a\u7684\u5fc5\u80dc\u70b9\u6570\u76ee\u4e3a $cntw$ ,\u5fc5\u8d25\u70b9\u6570\u76ee\u4e3a $cntl$ ,\u8bb0 $win_x$ \u8868\u793a**\u539f\u6811\u4e0a** $x$ \u662f\u5426\u5fc5\u80dc,\u662f\u5219\u4e3a $1$ ,\u5426\u5219\u4e3a $0$ .\n\n\u90a3\u4e48\u5bf9\u4e8e $D=1$ ,\u7b54\u6848\u5c31\u662f $cnt_1 \\times cntl + win_1 \\times n \\times cntw$ . \n\n\u8bb0 $fw_i$ \u4e3a \u628a $i$ \u5f3a\u5236\u53d8\u4e3a\u5fc5\u80dc\u70b9\u4e4b\u540e\u7684\u5fc5\u80dc\u70b9\u6570\u76ee,\u7279\u522b\u7684,\u4ee4 $fw_0=cntw$ .  \u8bb0 $sumcntw$ \u4e3a $\\sum\\limits_{i=1}^n fw_i$   \n\n\u8bb0 $fl_i$ \u4e3a \u628a$i$\u5f3a\u5236\u53d8\u4e3a\u5fc5\u80dc\u70b9\u4e4b\u540e\u7684\u5fc5\u8d25\u70b9\u6570\u76ee$,$\u7279\u522b\u7684$,$\u4ee4 $fl_0=cntl$ . \u8bb0 $sumcntl$ \u4e3a $\\sum\\limits_{i=1}^n fl_i$  \n\n\n\u5bf9\u4e8e $D>1$ \u7684\u60c5\u51b5$,$\u9996\u5148\u6211\u4eec\u8003\u8651 $dp_{i,x(1\\leq x\\leq n)}$ \u8868\u793a\u7b2c$i$\u5c42\u7684\u65f6\u7a7a\u96a7\u9053\u8fde\u63a5\u4e86\u4e0b\u4e00\u5c42\u7684\u5fc5\u8d25\u70b9$,$\u5e76\u4f7f\u5f97$x$\u5f3a\u5236\u53d8\u4e3a\u5fc5\u80dc\u70b9\u7684\u65b9\u6848\u6570.\n\n\u518d\u8bb0\u4e00\u4e2a $dp_{i,0}$ \u8868\u793a\u793a\u7b2c $i$ \u5c42\u7684\u65f6\u7a7a\u96a7\u9053\u8fde\u63a5\u4e86\u4e0b\u4e00\u5c42\u7684\u5fc5\u80dc\u70b9\u7684\u65b9\u6848\u6570.\n\n\u5982\u679c\u6211\u4eec\u80fd\u8ba1\u7b97\u51fa\u8fd9\u4e9b\u4e1c\u897f$,$\u90a3\u4e48\u7b54\u6848\u5c31\u662f $\\sum\\limits_{i=0}^n dp_{1,i} \\times (cnt_1 \\times fl_i+win_1\\times n \\times fw_i)$\n\n\u90a3\u4e48\u600e\u4e48 DP \u5462?\n\n$dp_{i,x(x>0)} = \\sum\\limits_{y=0}^n dp_{i+1,y} \\times fl_y$\n\n$dp_{i,0}=\\sum\\limits_{y=0}^n dp_{i+1,y} \\times fw_y$\n\n\u4e0d\u96be\u53d1\u73b0\u6240\u6709\u7684 $dp_{i,1},dp_{i,2},...,dp_{i,n}$ \u90fd\u76f8\u7b49,\u6240\u4ee5\u5bf9\u4e8e\u6bcf\u4e2a $i$ \u6211\u4eec\u53ea\u9700\u8981\u8bb0\u4e24\u4e2a DP \u503c.\n\n\u5e76\u4e14\u8f6c\u79fb\u53ef\u4ee5\u5199\u6210\u77e9\u9635\u5f62\u5f0f,\u800c\u4e14**\u65e0\u8bba\u662f\u8f6c\u79fb\u8fd8\u662f\u8ba1\u7b97\u7b54\u6848\u6211\u4eec\u90fd\u4e0d\u9700\u8981\u6c42\u51fa $fl_i$ \u548c $fw_i$ ,\u53ea\u9700\u8981\u6c42\u51fa\u5b83\u4eec\u7684\u548c** $sumcntw$ , $sumcntl$ . \u8fd9\u4e24\u4e2a\u6570\u53ef\u4ee5\u901a\u8fc7\u4e0a\u8ff0\u7684\u6362\u6839 DP \u7ed3\u679c\u6c42\u51fa.\n\n\u590d\u6742\u5ea6 $O(n+\\log D)$ \u6216 $O(n\\log n+\\log D)$ \u7ec6\u8282\u975e\u5e38\u591a.\n\n$O(n + \\log D)$ \u4ee3\u7801 \uff1a[\u89c1\u4e91\u526a\u8d34\u677f](https://www.luogu.com.cn/paste/g4l76gys)\n\n**\u6ce8\u610f\u5b9e\u73b0\u65f6\u7684\u7a7a\u95f4\uff01\uff01\uff01\u6ce8\u610f\u5b9e\u73b0\u65f6\u7684\u7a7a\u95f4\uff01\uff01\uff01\u6ce8\u610f\u5b9e\u73b0\u65f6\u7684\u7a7a\u95f4\uff01\uff01\uff01**\n\n**\u4e0d\u5efa\u8bae\u4f7f\u7528vector\u5b58\u56fe/map\u5b58DP\u7ed3\u679c.**",
        "postTime": 1598771770,
        "uid": 52518,
        "name": "s_r_f",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P6803 \u3010[CEOI2020]\u661f\u9645\u8ff7\u822a\u3011"
    },
    {
        "content": "# CF1402C Star Trek\n\n\u6d1b\u8c37\u7684Markdown\u7f29\u8fdb\u6709\u4e00\u4e9b\u95ee\u9898\uff0c\u8bf7\u52a1\u5fc5\u8fdb\u5165\u4e0b\u9762\u7684\u94fe\u63a5\u9605\u8bfb\uff1a\n\n[\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u723d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/dysyn1314/p/13581665.html)\n\n[\u9898\u76ee\u94fe\u63a5](https://codeforces.com/contest/1402/problem/C)\n\n\u7ea6\u5b9a\uff1a\u5047\u8bbe\u4ece\u7b2c$i$\u68f5\u6811\u7684\u8282\u70b9$a$\uff0c\u8fde\u5411\u4e86\u7b2c$i+1$\u68f5\u6811\u7684\u8282\u70b9$b$\uff0c\u5219\u6211\u4eec\u8ba4\u4e3a\u7b2c$i+1$\u68f5\u6811\u662f\u4ee5$b$\u4e3a\u6839\u7684\u3002\n\n\u8003\u8651\u4e00\u4e2aDP\u3002\u8bbe$dp[i]$\u8868\u793a\u4f9d\u6b21\u8fde\u63a5\u4e86$i$\u68f5\u6811\uff0c\u3010\u4ece\u7b2c\u4e00\u68f5\u6811\u7684\u6839\u8282\u70b9\u51fa\u53d1\uff0c\u5148\u624b\u5fc5\u80dc\u3011\u7684\u65b9\u6848\u6570\u3002\u6ce8\u610f\uff0c\u7b2c\u4e00\u68f5\u6811\u7684\u6839\u8282\u70b9\u53ef\u4ee5\u662f**\u4efb\u610f\u4e00\u4e2a\u8282\u70b9**\uff08\u53ea\u6709\u5728\u6c42\u7b54\u6848\u65f6\uff0c\u624d\u5f3a\u5236\u8981\u6c42\u7b2c\u4e00\u68f5\u6811\u7684\u6839\u8282\u70b9\u662f$1$\uff0c\u6211\u4eec\u5728\u5b9a\u4e49\u72b6\u6001\u65f6\u4e0d\u8003\u8651\u8fd9\u4e2a\uff09\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c$dp[i]$\uff0c\u662f\u628a\u7b2c\u4e00\u68f5\u6811\u6839\u8282\u70b9\u4e3a$1\\dots n$\u7684\u65b9\u6848\u6570\u52a0\u8d77\u6765\u3002\n\n\u8f6c\u79fb\u65f6\u8003\u8651\u5728**\u524d\u9762**\u6dfb\u52a0\u4e00\u68f5\u6811\u3002\n\n\u6734\u7d20\u7684\u8f6c\u79fb\uff0c\u6211\u4eec\u679a\u4e3e\u6dfb\u52a0\u7684\u8fd9\u68f5\u6811\u7684\u6839$\\text{root}$\u3002\u6b64\u65f6\u9700\u8981\u505a\u4e00\u4e9b\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n- \u5355\u72ec\u8003\u8651\u4e00\u68f5\u6811\uff0c\u4ee5$\\text{root}$\u4e3a\u6839\u65f6\uff0c\u662f\u5426\u662f\u5148\u624b\u5fc5\u80dc\u7684\u3002\u5982\u679c\u662f**\u5148\u624b\u5fc5\u80dc**\u7684\uff0c\u6b64\u65f6\u6211\u4eec\u8981\u6c42\u8fde\u51fa\u53bb\u7684\u8fb9**\u4e0d\u80fd\u6539\u53d8**\u6839\u8282\u70b9$\\text{root}$\u7684\u80dc\u8d1f\u72b6\u6001\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u679a\u4e3e\u6811\u91cc\u6bcf\u4e00\u4e2a\u8282\u70b9$u$\uff0c\u8003\u8651\u4ece$u$\u8fde\u51fa\u53bb\uff1a\n  - \u5982\u679c\u6539\u53d8$u$\u7684\u80dc\u8d1f\u6027\u540e\uff0c**\u4e0d\u4f1a\u5f71\u54cd**\u5230\u6839\u8282\u70b9$\\text{root}$\u7684\u80dc\u8d1f\u6027\u3002\u90a3\u4e48\u540e\u9762$i-1$\u68f5\u6811\u7684\u8fde\u8fb9\u65b9\u6848\u53ef\u4ee5\u4efb\u610f\u3002\u65b9\u6848\u6570\u662f$n\\times n^{2(i-1)}$\u3002\u5176\u4e2d$n$\u8868\u793a\u7ed9\u540e\u9762\u7684\u7b2c\u4e00\u68f5\u6811\u5b9a\u4e00\u4e2a\u6839\u8282\u70b9\uff0c$n^{2(i-1)}$\u8868\u793a\u5176\u4ed6\u6811\u4e4b\u95f4\u4efb\u610f\u8fde\u8fb9\u3002\n  - \u5982\u679c\u6539\u53d8$u$\u7684\u80dc\u8d1f\u6027\u540e\uff0c**\u4f1a\u5f71\u54cd**\u5230\u6839\u8282\u70b9$\\text{root}$\u7684\u80dc\u8d1f\u6027\uff1a\n    - \u5982\u679c$u$\u7684\u5b50\u6811\u662f\u5148\u624b**\u5fc5\u80dc**\u7684\u3002\u90a3\u4e48\u968f\u4fbf\u8fde\u4e00\u6761\u8fb9\uff0c\u5f53\u8d70\u5230$u$\u65f6\uff0c\u5148\u624b\u65e0\u8bba\u5982\u4f55\u4e0d\u4f1a\u8d70\u5411\u8fd9\u6761\u8fb9\u3002\u6240\u4ee5\u4e5f\u53ef\u4ee5\u4efb\u610f\u8fde\u8fb9\uff0c\u65b9\u6848\u6570\u662f$n\\times n^{2(i-1)}$\u3002\n    - \u5982\u679c$u$\u7684\u5b50\u6811\u662f\u5148\u624b**\u5fc5\u8d25**\u7684\u3002\u5219\u6211\u4eec\u8fde\u51fa\u53bb\u7684\u8fb9\u5fc5\u987b\u5fc5\u80dc\u3002\u56e0\u4e3a\u5982\u679c\u8fde\u5411\u4e86\u4e00\u4e2a\u5fc5\u8d25\u72b6\u6001\uff0c\u5219\u8d70\u5230$u$\u65f6\uff0c\u5148\u624b\u5c31\u4e00\u5b9a\u5c31\u4f1a\u8d70\u6211\u4eec\u65b0\u8fde\u7684\u8fd9\u6761\u8fb9\uff0c\u4e8e\u662f\u5c31\u6539\u53d8\u4e86$u$\u7684\u80dc\u8d1f\u6027\uff0c\u8fdb\u800c\u6539\u53d8\u4e86\u6839\u7684\u80dc\u8d1f\u6027\u3002\u56e0\u6b64\uff0c\u8fde\u8fb9\u53ea\u80fd\u8fde\u5411\u5fc5\u80dc\uff0c\u65b9\u6848\u6570\u662f$dp[i-1]$\u3002\n- \u5355\u72ec\u8003\u8651\u4e00\u68f5\u6811\uff0c\u4ee5$\\text{root}$\u4e3a\u6839\u65f6\uff0c\u5982\u679c\u4e0d\u662f\u5148\u624b\u5fc5\u80dc\uff08\u4e5f\u5c31\u662f**\u540e\u624b\u5fc5\u80dc**\uff09\uff0c\u6b64\u65f6\u6211\u4eec\u8981\u6c42\u8fde\u51fa\u53bb\u7684\u8fb9**\u5fc5\u987b\u6539\u53d8**\u6839\u8282\u70b9\u7684\u80dc\u8d1f\u72b6\u6001\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u679a\u4e3e\u6811\u91cc\u6bcf\u4e00\u4e2a\u8282\u70b9$u$\uff0c\u8003\u8651\u4ece$u$\u8fde\u51fa\u53bb\uff1a\n  - \u5982\u679c\u6539\u53d8$u$\u7684\u80dc\u8d1f\u6027\u540e\uff0c**\u4e0d\u4f1a\u5f71\u54cd**\u5230\u6839\u8282\u70b9$\\text{root}$\u7684\u80dc\u8d1f\u6027\u3002\u90a3\u4e00\u5b9a\u4e0d\u7b26\u5408\u6211\u4eec\u7684\u8981\u6c42\u3002\u6240\u4ee5\u4ece$u$\u8282\u70b9\u8fde\u51fa\u53bb\u7684\u65b9\u6848\u6570\u662f$0$\u3002\n  - \u5982\u679c\u6539\u53d8$u$\u7684\u80dc\u8d1f\u6027\u540e\uff0c**\u4f1a\u5f71\u54cd**\u5230\u6839\u8282\u70b9$\\text{root}$\u7684\u80dc\u8d1f\u6027\uff1a\n    - \u5982\u679c$u$\u7684\u5b50\u6811\u662f\u5148\u624b**\u5fc5\u80dc**\u7684\u3002\u90a3\u4e48\u6211\u4eec\u65e0\u8bba\u600e\u4e48\u8fde\u8fb9\uff0c\u8d70\u5230$u$\u65f6\u5148\u624b\u90fd\u4e0d\u4f1a\u8d70\u6211\u4eec\u8fde\u51fa\u53bb\u7684\u8fb9\u3002\u6240\u4ee5\u4e0d\u53ef\u80fd\u6539\u53d8$u$\u7684\u80dc\u8d1f\u6027\uff0c\u8fdb\u800c\u4e0d\u53ef\u80fd\u6539\u53d8\u6839\u7684\u80dc\u8d1f\u6027\u3002\u6240\u4ee5\u65b9\u6848\u6570\u8fd8\u662f$0$\u3002\n    - \u5982\u679c$u$\u7684\u5b50\u6811\u662f\u5148\u624b**\u5fc5\u8d25**\u7684\u3002\u90a3\u4e48\u6211\u4eec\u8fde\u5411\u4e00\u4e2a\u5fc5\u8d25\u70b9\uff0c\u5c31\u80fd\u6539\u53d8$u$\u7684\u80dc\u8d1f\u6027\u3002\u6240\u4ee5\u8fde\u8fb9\u65b9\u6848\u6570\u662f$n\\times n^{2(i-1)}-dp[i-1]$\u3002\n\n\u901a\u8fc7\u4e0a\u8ff0\u7684\u5206\u7c7b\u8ba8\u8bba\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u786e\u5b9a\u6839\u540e\uff0c\u53ea\u9700\u8981\u77e5\u9053\u6bcf\u4e2a\u8282\u70b9$u$\u7684\u4e24\u4e2a\u4fe1\u606f\uff1a\n\n- \u70b9$u$\u7684\u5b50\u6811\uff0c\u662f\u5426\u662f\u5148\u624b\u5fc5\u80dc\u7684\u3002\n- \u70b9$u$\u80dc\u8d1f\u6027\u6539\u53d8\uff0c\u662f\u5426\u4f1a\u5f71\u54cd\u6839\u7684\u80dc\u8d1f\u6027\u3002\n\n\u5177\u4f53\u6765\u8bf4\uff0c\u53ea\u9700\u8981\u77e5\u9053\uff0c\u5bf9\u6bcf\u4e2a\u6839\u6765\u8bf4\uff0c\u4e24\u79cd\u4fe1\u606f$2\\times2$\u5171$4$\u7c7b\u70b9\u7684\u6570\u91cf\u5206\u522b\u662f\u591a\u5c11\uff0c\u5c31\u80fd\u8ba1\u7b97\u51faDP\u7684\u8f6c\u79fb\u7cfb\u6570\u3002\u7136\u540e\u7528\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316DP\u3002\n\n\u9996\u5148\uff0c\u53ef\u4ee5\u679a\u4e3e\u6839\uff0c\u5404\u505a\u4e00\u6b21\u6811\u5f62DP\uff0c\u6c42\u51fa\u8fd9\u4e24\u4e2a\u4fe1\u606f\u3002\u65f6\u95f4\u590d\u6742\u5ea6$O(n^2)$\u3002\u5177\u4f53\u6765\u8bf4\uff1a\n\n- \u70b9$u$\u7684\u5b50\u6811\u662f\u5426\u5148\u624b\u5fc5\u80dc\u3002\u8fd9\u4e2a\u53ea\u9700\u8981\u770b\u513f\u5b50\u91cc\uff0c\u6709\u6ca1\u6709\u5148\u624b\u5fc5\u8d25\u7684\u70b9\u5373\u53ef\u3002\u53ea\u8981\u5b58\u5728\u5148\u624b\u5fc5\u8d25\u7684\u513f\u5b50\uff0c\u5219\u70b9$u$\u5c31\u662f\u5148\u624b\u5fc5\u80dc\u7684\uff0c\u5426\u5219\u662f\u5148\u624b\u5fc5\u8d25\u7684\u3002\n- \u70b9$u$\u7684\u80dc\u8d1f\u6027\u6539\u53d8\uff0c\u80fd\u5426\u5f71\u54cd\u5230\u6839\u3002\u8fd9\u4e2a\u8981\u6ee1\u8db3\u4e24\u4e2a\u6761\u4ef6\uff1a\n  - \u9996\u5148\uff0c\u70b9$u$\u7684\u7236\u4eb2\uff0c\u5fc5\u987b\u80fd\u5f71\u54cd\u6839\u3002\n  - \u5176\u6b21\uff0c\u70b9$u$\u7684\u6240\u6709\u5144\u5f1f\u91cc\uff08\u5b83\u7236\u4eb2\u9664\u4e86$u$\u4ee5\u5916\u7684\u513f\u5b50\uff09\uff0c\u5fc5\u987b\u6ca1\u6709\u5fc5\u8d25\u70b9\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u8981\u4e48\u70b9$u$\u7236\u4eb2\u7684\u513f\u5b50\u91cc\u538b\u6839\u6ca1\u6709\u5fc5\u8d25\u70b9\uff1b\u8981\u4e48\u6070\u597d\u6709\u4e00\u4e2a\u5fc5\u8d25\u70b9\u4e14\u8fd9\u4e2a\u70b9\u5c31\u662f$u$\u3002\n\n\u8fd9\u4e24\u4e2aDP\u90fd\u6bd4\u8f83\u7b80\u5355\u3002\u5047\u8bbe\u6c42\u51fa\u7684\u4e24\u4e2a\u4fe1\u606f\uff0c\u5206\u522b\u4e3a$f_{\\text{root}}(u),g_{\\text{root}}(u)$\uff08$f_{\\text{root}}(u),g_{\\text{root}}(u)\\in\\{0,1\\}$\uff09\u3002\u90a3\u76f8\u5f53\u4e8e\u5bf9\u6bcf\u4e2a$\\text{root}$\uff0c\u6c42\u51fa\u4e00\u4e2a\uff1a\n$$\n\\text{cnt}[\\text{root}][x\\in\\{0,1\\}][y\\in\\{0,1\\}]=\\sum_{i=1}^{n}[f_{\\text{root}}(i)=x]\\times[g_{\\text{root}}(i)=y]\n$$\n\u5047\u8bbe\u6709\u4e86\u8fd9\u4e2a$\\text{cnt}$\u6570\u7ec4\uff0c\u6211\u4eec\u5c31\u5f88\u5bb9\u6613\u6c42\u51fa\u7cfb\u6570\uff0c\u7136\u540e\u8fdb\u884c\u4e0a\u8ff0\u7684DP\u5e76\u7528\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\u4e86\u3002\n\n\u5148\u5bf9$1$\uff0c\u6c42\u51fa$\\text{cnt}[1][x][y]$\uff0c\u7136\u540e\u6362\u6839\u3002\u6362\u6839\u7684\u65f6\u5019\u975e\u5e38\u590d\u6742\uff0c\u9700\u8981\u8fdb\u884c\u5927\u91cf\u7684\u8ba8\u8bba\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u8981\u9884\u5904\u7406\u51fa\u4e00\u4e2a$s(u)$\u8868\u793a\u53ea\u8003\u8651\uff08\u4ee5$1$\u4e3a\u6839\u65f6\uff09\u70b9$u$\u7684\u5b50\u6811\uff0c\u5b50\u6811\u91cc\u6709\u591a\u5c11$g_{1}(i)=1$\u7684\u70b9\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5c31\u662f\u4e0d\u8003\u8651$u$\u7684\u7236\u4eb2\u4e86\uff0c\u5f3a\u5236\u70b9$g(u)=1$\u3002\u8fd9\u4e2a$s$\u5728\u6362\u6839\u65f6\uff0c\u6709\u5f88\u5927\u7684\u7528\u5904\u3002\n\n\u5176\u4ed6\u7ec6\u8282\uff0c\u7559\u7ed9\u8bfb\u8005\u81ea\u884c\u8ba8\u8bba\u3002\u5b9e\u5728\u8ba8\u8bba\u4e0d\u51fa\u6765\u53ef\u4ee5\u770b\u770b\u53c2\u8003\u4ee3\u7801\u3002~~\u4e0d\u8fc7\u770b\u5230\u8fd9\u4e48\u957f\u7684\u4ee3\u7801\uff0c\u4f60\u4f30\u8ba1\u5b81\u613f\u81ea\u5df1\u8ba8\u8bba......~~\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n+\\log d)$\u3002\n\n\n[\u53bb\u770b\u4ee3\u7801~](https://www.cnblogs.com/dysyn1314/p/13581665.html)\n",
        "postTime": 1599101894,
        "uid": 100674,
        "name": "duyi",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P6803 \u3010[CEOI2020]\u661f\u9645\u8ff7\u822a\u3011"
    }
]
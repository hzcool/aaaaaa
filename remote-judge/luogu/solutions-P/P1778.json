[
    {
        "content": "### \u7b80\u5355\u601d\u8def\uff1a\n1. \u5148\u4e00\u4e00\u8bfb\u5165\uff08\u7528getchar()\uff09\n2. \u9010\u4e00\u5224\u65ad\u7b26\u53f7\u5e76\u5b58\u50a8\n3. \u7528\u5e7f\u5ea6\u641c\u7d22\uff08\u5373\u51fd\u6570bfs\uff09\n4. \u8f93\u51fa\u7b54\u6848\n-------\n\n\n\n## \u6284\u88ad\u53ef\u803b\u54e6~\n### \u4ee3\u7801\uff1a\n\n\n------------\n\n    #include <bits/stdc++.h>\n\tusing namespace std;\n\n\tconst int MAXN = 16;\n\tconst int MAXM = 192;\n\tint getnum(int a, int b, int c)\n\t{\n  \t  return (a << 16) | (b << 8) | c;\n\t}\n\tint ok(int a, int b, int a1, int b1)\n\t{\n    \treturn ((a1 == b1) || (a1 == b && b1 == a));\n\t}\n\tint cx[] = { -1, 1, 0, 0, 0 };\n\tint cy[] = { 0, 0, -1, 1, 0 };\n\tint id[MAXN + 10][MAXN + 10];\n\tint G[MAXM + 10][5];\n\tint st[3], ed[3];\n\tint edge[MAXM + 10], d[MAXM + 10][MAXM + 10]\t[MAXM + 10];\n\tint w, h, n, cnt;\n\tchar M[MAXN + 10][MAXN + 10];\n\tvoid bfs()\n\t{\n   \t queue <int> q;\n  \t  memset(d, -1, sizeof(d));\n   \t q.push(getnum(st[0], st[1], st[2]));\n    \td[st[0]][st[1]][st[2]] = 0;\n    \twhile (!q.empty())\n    {\n        int u = q.front(); q.pop();\n        int a = (u >> 16) & 255, b = (u >> 8) & 255, c = u & 255;\n        if (a == ed[0] && b == ed[1] && c == ed[2])\n            return;\n        for (int i = 1; i <= edge[a]; i++)\n        {\n            int a1 = G[a][i];\n            for (int j = 1; j <= edge[b]; j++)\n            {\n                int b1 = G[b][j];\n                if (ok(a, b, a1, b1))\n                    continue;\n                for (int k = 1; k <= edge[c]; k++)\n                {\n                    int c1 = G[c][k];\n                    if (ok(a, c, a1, c1))\n                    continue;\n                    if (ok(b, c, b1, c1))\n                    continue;\n                    if (d[a1][b1][c1] == -1)\n                    {\n                        d[a1][b1][c1] = d[a][b][c] + 1;\n                        q.push(getnum(a1, b1, c1));\n                    }\n                }\n            }\n        }\n    }\n\t}\n\tint main()\n\t{\n    while (cin >> w >> h >> n && n)\n    {\n        char c = getchar();\n        while (c != '\\n')\n            c = getchar();\n        for (int i = 1; i <= h; i++)\n            fgets(M[i] + 1, 20, stdin);\n        cnt = 0;\n        int x[MAXM + 10], y[MAXM + 10];\n        for (int i = 1; i <= h; i++)\n        for (int j = 1; j <= w; j++)\n        if (M[i][j] != '#')\n        {\n            id[i][j] = ++cnt;\n            x[cnt] = i;\n            y[cnt] = j;\n            if ('a' <= M[i][j] && M[i][j] <= 'c')\n                st[M[i][j] - 'a'] = cnt;\n            if ('A' <= M[i][j] && M[i][j] <= 'C')\n                ed[M[i][j] - 'A'] = cnt;\n        }\n        for (int i = 1; i <= cnt; i++)\n        {\n            edge[i] = 0;\n            for (int j = 0; j < 5; j++)\n            {\n                int xx = x[i] + cx[j];\n                int yy = y[i] + cy[j];\n                if (M[xx][yy] != '#')\n                    G[i][++edge[i]] = id[xx][yy];\n            }\n        }\n        if (n <= 2)\n        {\n            edge[++cnt] = 1;\n            G[cnt][1] = cnt;\n            st[2] = ed[2] = cnt;\n        }\n        if (n <= 1)\n        {\n            edge[++cnt] = 1;\n            G[cnt][1] = cnt;\n            st[1] = ed[1] = cnt;\n        }\n        bfs();\n        cout << d[ed[0]][ed[1]][ed[2]] << endl ;\n    }\n        return 0;\n }",
        "postTime": 1517737519,
        "uid": 32783,
        "name": "Zhou_Liya",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1778 \u3010\u4e07\u5723\u8282\u540e\u7684\u65e9\u6668_NOI\u5bfc\u520a2010\u63d0\u9ad8\uff0803\uff09\u3011"
    },
    {
        "content": "\u9898\u9762\u53ef\u4ee5\u770b[\u8fd9\u91cc](https://onlinejudge.org/external/16/p1601.pdf)\n## \u601d\u8def\uff1a\n- \u7531\u9898\u610f\u53ef\u77e5\u6211\u4eec\u4e0d\u7528\u5224\u65ad\u8ff7\u5bab\u7684\u8fb9\u754c\uff0c\u56e0\u4e3a\u5916\u56f4\u90fd\u662f\u969c\u788d\u7269\u3002\n\n- \u201cAny 2 \u00d7 2 area on any map has at least one sharp.\u201d\u5c31\u662f\u8bf4\u6709\u8bb8\u591a\u683c\u5b50\u90fd\u662f\u969c\u788d\u7269\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a\u6240\u6709\u7684\u7a7a\u683c\u63d0\u51fa\u6765\u5efa\u4e00\u5f20\u56fe\uff0c\u80fd\u5927\u5927\u8282\u7ea6\u65f6\u95f4\u3002\n\n- \u5efa\u56fe\u65f6\u53ef\u4ee5\u8ba9\u989d\u5916\u7684\u7ed3\u70b9\u5f62\u6210\u81ea\u73af\uff0c\u8ba9\u6211\u4eec\u6bcf\u6b21\u90fd\u6709\u4e09\u4e2a\u9b3c\uff0c\u65b9\u4fbf\u5904\u7406\u3002\n\n- \u73b0\u5728\u666e\u901a BFS \u5df2\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\uff0c\u4f46\u8fd8\u53ef\u4ee5\u7ee7\u7eed\u4f18\u5316\uff0c\u5982\u7528\u53cc\u5411 BFS\u3001A\\* \u7b49\u7b97\u6cd5\u3002\n\n***\n### \u4ee3\u7801\uff1a\n\u666e\u901a BFS:\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint G[150][5], deg[150], st[3], ed[3], d[150][150][150];\n//deg: \u6bcf\u4e2a\u7ed3\u70b9\u7684\u51fa\u5ea6\uff08\u6700\u5927\u4e3a 5\uff0c\u56db\u4e2a\u65b9\u5411\u548c\u539f\u5730\u4e0d\u52a8\uff09\n//d: \u6bcf\u4e2a\u72b6\u6001\u5230\u8d77\u70b9\u72b6\u6001\u7684\u8ddd\u79bb\nint mm(int a, int b, int c) {return (a<<16) | (b<<8) | c;}// \u4e8c\u8fdb\u5236\u72b6\u6001\u538b\u7f29\nbool ct(int a, int b, int x, int y){return b == y || (a == y && b == x);}\n// \u8fd4\u56de a -> b \u7684\u9b3c\u548c x -> y \u7684\u9b3c\u8def\u7ebf\u662f\u5426\u51b2\u7a81\nint bfs()\n{\n    memset(&d[0][0][0], -1, sizeof d);\n    queue <int> q;\n    q.push(mm(st[0], st[1], st[2]));\n    d[st[0]][st[1]][st[2]] = 0;\n    while(!q.empty())\n    {\n        int x = q.front(), a = x >> 16, b = (x >> 8) & 0xff, c = x & 0xff;\n        q.pop();\n        if(a == ed[0] && b == ed[1] && c == ed[2]) return d[a][b][c];\n        for(int i = 0; i < deg[a]; ++i)\n            for(int j = 0; j < deg[b]; ++j)\n            {\n                if(ct(a, G[a][i], b, G[b][j])) continue;\n                for(int k = 0; k < deg[c]; ++k)\n                {\n                    if(ct(a, G[a][i], c, G[c][k]) || ct(b, G[b][j], c, G[c][k]) || d[G[a][i]][G[b][j]][G[c][k]] != -1) continue;\n                    d[G[a][i]][G[b][j]][G[c][k]] = d[a][b][c]+1;\n                    q.push(mm(G[a][i], G[b][j], G[c][k]));\n                }\n            }\n    }\n    return -1;\n}\nint main()\n{\n    int w, h, n;\n    char s[20][20];\n    while(scanf(\"%d%d%d\", &w, &h, &n), w || h || n)\n    {\n        int cnt = 0, id[20][20]; // id: \u7a7a\u683c\u5728\u56fe\u4e2d\u7ed3\u70b9\u7f16\u53f7\n        memset(deg, 0, sizeof deg);\n        for(int i = 0; i < h; ++i)\n        { // \u5904\u7406\u597d\u8f93\u5165\uff0c\u987a\u4fbf\u5efa\u56fe\n            scanf(\" \");\n            for(int j = 0; j < w; ++j)\n            {\n                s[i][j] = getchar();\n                if(s[i][j] != '#')\n                {\n                    id[i][j] = ++cnt;\n                    G[cnt][deg[cnt]++] = cnt;\n                    if(s[i-1][j] != '#'){G[cnt][deg[cnt]++] = id[i-1][j]; G[id[i-1][j]][deg[id[i-1][j]]++] = cnt;}\n                    if(s[i][j-1] != '#'){G[cnt][deg[cnt]++] = id[i][j-1]; G[id[i][j-1]][deg[id[i][j-1]]++] = cnt;}\n                    if(islower(s[i][j])) st[s[i][j]-'a'] = cnt;\n                    else if(isupper(s[i][j])) ed[s[i][j]-'A'] = cnt;\n                }\n            }\n        }\n        /* \u865a\u62df\u7ed3\u70b9 */\n        if(n <= 2) {deg[++cnt] = 1; G[cnt][0] = cnt; st[2] = ed[2] = cnt;}\n        if(n == 1) {deg[++cnt] = 1; G[cnt][0] = cnt; st[1] = ed[1] = cnt;} \n        printf(\"%d\\n\", bfs());\n    }\n    return 0;\n}\n```\n\u53cc\u5411 BFS:\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint G[150][5], deg[150], st[3], ed[3], d1[150][150][150], d2[150][150][150];\nint mm(int a, int b, int c) {return (a<<16) | (b<<8) | c;}\nbool ct(int a, int b, int x, int y){return b == y || (a == y && b == x);}\nint bfs()\n{\n    memset(&d1[0][0][0], -1, sizeof d1);\n    memset(&d2[0][0][0], -1, sizeof d2);\n    queue <int> q1, q2;\n    q1.push(mm(st[0], st[1], st[2]));\n    d1[st[0]][st[1]][st[2]] = 0;\n    q2.push(mm(ed[0], ed[1], ed[2]));\n    int n1, n2, x1, x2;\n    n2 = n1 = 1;\n    x1 = x2 = 0;\n    do {\n        if(!n2 || x1 < x2)\n        {\n            int x = q1.front(), a = x >> 16, b = (x >> 8) & 0xff, c = x & 0xff;\n            q1.pop(); --n1;\n            if(d2[a][b][c] != -1) return d1[a][b][c] + d2[a][b][c];\n            if(d1[a][b][c] > x1){++x1; q1.push(x); ++n1; continue;}\n            for(int i = 0; i < deg[a]; ++i)\n                for(int j = 0; j < deg[b]; ++j)\n                {\n                    if(ct(a, G[a][i], b, G[b][j])) continue;\n                    for(int k = 0; k < deg[c]; ++k)\n                    {\n                        if(ct(a, G[a][i], c, G[c][k]) || ct(b, G[b][j], c, G[c][k]) || d1[G[a][i]][G[b][j]][G[c][k]] != -1) continue;\n                        d1[G[a][i]][G[b][j]][G[c][k]] = d1[a][b][c]+1;\n                        q1.push(mm(G[a][i], G[b][j], G[c][k]));\n                        ++n1;\n                    }\n                }\n        }\n        else\n        {\n            int x = q2.front(), a = x >> 16, b = (x >> 8) & 0xff, c = x & 0xff;\n            q2.pop(); --n2;\n            if(d1[a][b][c] != -1) return d1[a][b][c] + d2[a][b][c];\n            if(d2[a][b][c] > x2){++x2; q2.push(x); ++n2; continue;}\n            for(int i = 0; i < deg[a]; ++i)\n                for(int j = 0; j < deg[b]; ++j)\n                {\n                    if(ct(a, G[a][i], b, G[b][j])) continue;\n                    for(int k = 0; k < deg[c]; ++k)\n                    {\n                        if(ct(a, G[a][i], c, G[c][k]) || ct(b, G[b][j], c, G[c][k]) || d2[G[a][i]][G[b][j]][G[c][k]] != -1) continue;\n                        d2[G[a][i]][G[b][j]][G[c][k]] = d2[a][b][c]+1;\n                        q2.push(mm(G[a][i], G[b][j], G[c][k]));\n                        ++n2;\n                    }\n                }\n        }\n    } while(n1 || n2);\n    return -1;\n}\nint main()\n{\n    int w, h, n;\n    char s[20][20];\n    while(scanf(\"%d%d%d\", &w, &h, &n), w || h || n)\n    {\n        int cnt = 0, id[20][20];\n        memset(deg, 0, sizeof deg);\n        for(int i = 0; i < h; ++i)\n        {\n            scanf(\" \");\n            for(int j = 0; j < w; ++j)\n            {\n                s[i][j] = getchar();\n                if(s[i][j] != '#')\n                {\n                    id[i][j] = ++cnt;\n                    G[cnt][deg[cnt]++] = cnt;\n                    if(s[i-1][j] != '#'){G[cnt][deg[cnt]++] = id[i-1][j]; G[id[i-1][j]][deg[id[i-1][j]]++] = cnt;}\n                    if(s[i][j-1] != '#'){G[cnt][deg[cnt]++] = id[i][j-1]; G[id[i][j-1]][deg[id[i][j-1]]++] = cnt;}\n                    if(islower(s[i][j])) st[s[i][j]-'a'] = cnt;\n                    else if(isupper(s[i][j])) ed[s[i][j]-'A'] = cnt;\n                }\n            }\n        }\n        if(n <= 2) {deg[++cnt] = 1; G[cnt][0] = cnt; st[2] = ed[2] = cnt;}\n        if(n == 1) {deg[++cnt] = 1; G[cnt][0] = cnt; st[1] = ed[1] = cnt;}\n        printf(\"%d\\n\", bfs());\n    }\n    return 0;\n}\n```\n---\n\u53cc\u500d\u7ecf\u9a8c\uff1a[UVA1601](https://www.luogu.com.cn/problem/UVA1601)\u3002",
        "postTime": 1621644547,
        "uid": 404961,
        "name": "baiABC",
        "ccfLevel": 6,
        "title": "\u9898\u89e3\u3010P1778 \u4e07\u5723\u8282\u540e\u7684\u65e9\u6668\u3011"
    },
    {
        "content": "\u672c\u9898\u53ef\u4ee5\u62bd\u8c61\u6210\u4e00\u4e2a\u56fe\u8bba\u95ee\u9898\u3002\n\u6211\u4eec\u5047\u8bbe\u5730\u56fe\u4e0a\u67093\u4e2a\u9b3c\uff0c\u90a3\u4e48\u4e09\u4e2a\u9b3c\u5206\u522b\u6240\u5728\u7684\u884c\u6570nowx1,nowx2,nowx3\u4ee5\u53ca\u5206\u522b\u6240\u5728\u7684\u5217\u6570 nowy1,nowy2,nowy3\u8fd9\u516d\u4e2a\u503c\u53ef\u4ee5\u4f5c\u4e3a\u9690\u5f0f\u56fe\u4e0a\u7684\u8282\u70b9\u5b58\u50a8\u3002\n\u9898\u4e2d\u5df2\u7ed9\u51fa\u521d\u59cb\u7684\u72b6\u6001\uff0c\u90a3\u4e48\u6211\u4eec\u4ece\u521d\u59cb\u72b6\u6001\u5bf9\u5e94\u7684\u8282\u70b9\u51fa\u53d1\uff0c\u5bfb\u627e\u5230\u8fbe\u6700\u7ec8\u72b6\u6001\uff08\u4e09\u4e2a\u9b3c\u90fd\u5230\u8fbe\u6700\u7ec8\u4f4d\u7f6e\uff09\u6240\u5bf9\u5e94\u7684\u8282\u70b9\u7684\u6700\u77ed\u8def\u5f84\u3002\n\u6ce8\u610f\u5230\u8282\u70b9\u4e4b\u95f4\u7684\u8fb9\u6743\u76f8\u540c\uff08\u90fd\u662f\u4e00\u6b65\uff09\uff0c\u4f7f\u7528\u5bbd\u5ea6\u4f18\u5148\u641c\u7d22\u5bfb\u627e\u8def\u5f84\u3002\n\n\u9700\u6ce8\u610f\u7684\u51e0\u4e2a\u7ec6\u8282\uff1a\n1.\u6076\u5fc3\u7684\u5e26\u7a7a\u683c\u8bfb\u5165\n2.\u591a\u7ec4\u6570\u636e\n3.bfs\u961f\u5217\u7a7a\u95f4\u9700\u6c42\u8f83\u5927\uff0c\u8003\u8651\u4f7f\u7528\u5faa\u73af\u961f\u5217\n\n\n\u8d34\u4ee3\u7801\uff1a\n```cpp\n#include <iostream>\n#include <algorithm>\n#include <cmath>\n#include <cstring>\n#include <cstdio>\n#include <vector>\n#include <queue>\n#include <map>\nusing namespace std;\nint num;\nint n,m;\nint stx[4],sty[4],edx[4],edy[4];\nint a[21][21];\nshort vis[17][17][17][17][17][17];\nstruct qu\n{\n    int sx1,sx2,sx3,sy1,sy2,sy3;\n    int step;\n} q[1000001];\nint head,tail;\nint dx[5]= {1,-1,0,0,0};\nint dy[5]= {0,0,1,-1,0};\nchar tmp;\nint max(int p,int q){return p>q?p:q;}\nint min(int p,int q){return p<q?p:q;}\nint check(int nowx1,int nowy1,int nowx2,int nowy2,int nowx3,int nowy3)\n{\n    if(nowx1==edx[1]&&nowy1==edy[1]&&nowx2==edx[2]&&nowy2==edy[2]&&nowx3==edx[3]&&nowy3==edy[3]) return 1;\n    return 0;\n}\nint ans;\nvoid bfs()\n{\n    memset(vis,0,sizeof vis);\n    int i,j,k;\n    int nex1,ney1,nex2,ney2,nex3,ney3;\n    int nowx1,nowx2,nowx3,nowy1,nowy2,nowy3;\n    head=tail=0;\n    q[++tail].sx1=stx[1];q[tail].sx2=stx[2];q[tail].sx3=stx[3];\n    q[tail].sy1=sty[1];q[tail].sy2=sty[2];q[tail].sy3=sty[3];\n    vis[stx[1]][sty[1]][stx[2]][sty[2]][stx[3]][sty[3]]=1;\n    q[tail].step=0;\n    while(head!=tail)\n    {\n        head++;\n        head%=1000000;\n        nowx1=q[head].sx1;nowx2=q[head].sx2;nowx3=q[head].sx3;\n        nowy1=q[head].sy1;nowy2=q[head].sy2;nowy3=q[head].sy3;\n        //if(head>900000) cout<<head<<endl;\n        if(check(nowx1,nowy1,nowx2,nowy2,nowx3,nowy3))\n        {\n            ans=q[head].step;\n            return;\n        }\n        for(i=0; i<=4; i++)\n        {\n            nex1=nowx1+dx[i];\n            ney1=nowy1+dy[i];\n            if(nex1<0||nex1>n||ney1<1||ney1>m) continue;\n            if(a[nex1][ney1]) continue;\n            for(j=0; j<=4; j++)\n            {\n                nex2=nowx2+dx[j];\n                ney2=nowy2+dy[j];\n                if(nex2<0||nex2>n||ney2<1||ney2>m) continue;\n                if(a[nex2][ney2]) continue;\n                if(nex1==nowx2&&ney1==nowy2&&nex2==nowx1&&ney2==nowy1) continue;\n                if(nex1==nex2&&ney1==ney2) continue;\n                for(k=0; k<=4; k++)\n                {\n                    nex3=nowx3+dx[k];\n                    ney3=nowy3+dy[k];\n                    if(nex3<0||nex3>n||ney3<1||ney3>m) continue;\n                    if(a[nex3][ney3]) continue;\n                    if(nex1==nowx3&&ney1==nowy3&&nex3==nowx1&&ney3==nowy1) continue;\n                    if(nex2==nowx3&&ney2==nowy3&&nex3==nowx2&&ney3==nowy2) continue;\n                    if(nex1==nex2&&ney1==ney2||nex1==nex3&&ney1==ney3||nex2==nex3&&ney2==ney3) continue;\n                    if(vis[nex1][ney1][nex2][ney2][nex3][ney3]) continue;\n                    vis[nex1][ney1][nex2][ney2][nex3][ney3]=1;\n                    tail=(tail+1)%1000000;\n                    q[tail].sx1=nex1;q[tail].sx2=nex2;q[tail].sx3=nex3;\n                    q[tail].sy1=ney1;q[tail].sy2=ney2;q[tail].sy3=ney3;\n                    q[tail].step=q[head].step+1;\n                    if(check(nex1,ney1,nex2,ney2,nex3,ney3))\n                    {\n                        ans=q[tail].step;\n                        return;\n                    }\n                }\n            }\n        }\n    }\n\n}\nint main()\n{\n    int i,j;\n    while(scanf(\"%d%d%d\",&m,&n,&num)!=EOF)\n    {\n        if(n+m+num==0) break;\n        ans=1e9;\n        memset(stx,0,sizeof stx);\n        memset(edx,0,sizeof edx);\n        memset(a,0,sizeof a);\n        sty[1]=edy[1]=1;\n        sty[2]=edy[2]=2;\n        sty[3]=edy[3]=3;\n        for(i=1; i<=n; i++)\n        {\n            for(j=1; j<=m; j++)\n            {\n                tmp=getchar();\n                while(tmp=='\\r'||tmp=='\\n') tmp=getchar();\n                if(tmp=='#')a[i][j]=1;\n                else a[i][j]=0;\n                if(tmp=='a') stx[1]=i,sty[1]=j;\n                if(tmp=='b') stx[2]=i,sty[2]=j;\n                if(tmp=='c') stx[3]=i,sty[3]=j;\n                if(tmp=='A') edx[1]=i,edy[1]=j;\n                if(tmp=='B') edx[2]=i,edy[2]=j;\n                if(tmp=='C') edx[3]=i,edy[3]=j;\n            }\n        }\n        bfs();\n        printf(\"%d\\n\",ans);\n    }\n    return 0;\n}\n\n```\n",
        "postTime": 1532492280,
        "uid": 35234,
        "name": "ANJHZ",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1778 \u3010\u4e07\u5723\u8282\u540e\u7684\u65e9\u6668_NOI\u5bfc\u520a2010\u63d0\u9ad8\uff0803\uff09\u3011"
    },
    {
        "content": "## \u9898\u610f\uff1a\n\n\u7ed9\u4f60 $n$ \u4e2a\u5c0f\u9b3c\uff0c\u4e0d\u8d85\u8fc7 $3$ \u4e2a\u8fd8\u6709\u4e00\u4e2a $h \\times w$ \u7684\u5730\u56fe\uff0c\u7ed9\u5b9a\u8d77\u70b9\u7ec8\u70b9\u4ee5\u53ca\u4e0d\u80fd\u8d70\u7684\u70b9\uff0c\u6bcf\u4e00\u6b65\u53ef\u4ee5\u79fb\u52a8\u4efb\u610f\u4e2a\u5c0f\u9b3c\uff0c\u4f46\u4e0d\u80fd\u91cd\u5408\uff0c\u6c42\u6700\u5c11\u6b65\u6570\u3002\n\n## \u5206\u6790\uff1a\n\u66f4\u597d\u7684 [\u9898\u9762](https://onlinejudge.org/external/16/p1601.pdf) \u9605\u8bfb\u4f53\u9a8c\n\n\u8fd9\u9898\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 BFS \uff0c\u4f46\u662f\u4f1a\u8d85\u65f6\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u4f7f\u7528\u53cc\u7aef BFS \u56e0\u4e3a\u9898\u4e2d\u7ed9\u51fa\u4e86\u660e\u786e\u8d77\u6b62\u4f4d\u7f6e\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u4e24\u7aef\u4e00\u8d77\u6269\u5c55\u7684\u65b9\u5f0f\u6765\u8fbe\u5230\u5927\u5927\u51cf\u5c0f\u641c\u7d22\u6811\u7684\u76ee\u7684\uff0c\u5f53\u51fa\u73b0\u91cd\u5408\u7684\u60c5\u51b5\u65f6\u5c31\u662f\u6211\u4eec\u8981\u6c42\u7684\u7b54\u6848\u3002\u5bf9\u4e8e\u672c\u9898\u8fd8\u53ef\u4ee5\u6709\u4e00\u4e2a\u4f18\u5316\uff0c\u56e0\u4e3a\u9898\u4e2d\u7ed9\u51fa\u4e86\u6bcf\u4e00\u4e2a $2\\times 2 $ \u7684\u8303\u56f4\u5185\u81f3\u5c11\u6709\u4e00\u4e2a\u969c\u788d\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5c06\u53ef\u4ee5\u8d70\u7684\u90e8\u5206\u8fde\u6210\u56fe\uff0c\u5927\u5927\u51cf\u5c11\u4e0d\u5fc5\u8981\u7684\u6269\u5c55\uff0c\u522b\u5fd8\u4e86\u53ef\u4ee5\u4e0d\u52a8\uff0c\u6240\u4ee5\u8981\u6dfb\u52a0\u81ea\u73af\u3002\u5c0f\u9b3c\u53ef\u80fd\u4e0d\u8db3\u4e09\u4e2a\uff0c\u6240\u4ee5\u4e0d\u8db3\u7684\u8981\u8865\u4e0a\uff0c BFS \u7684\u8fc7\u7a0b\u4e2d\u4e0d\u52a8\u4ed6\u5373\u53ef\u3002\n\n\u8be6\u89c1\u4ee3\u7801\u5427\u3002\n\n```cpp\n#include<cstdio>\n#include<queue>\n#include<iostream>\n#include<cstring>\n#include<algorithm>\n#include<cmath>\n#include<cctype>\n#include<vector>\n#include<string>\nusing namespace std;\nint w,h,n;\nchar s[25][25];\nconst int N = 155;\nint dis[N][N][N],vis[N][N][N],id[N][N];//\u8ddd\u79bb \u662f\u5426\u8bbf\u95ee \u70b9\u7684\u7f16\u53f7 \nconst int dx[] = {0,1,0,-1,0};//\u6dfb\u52a0\u4e86\u81ea\u73af \nconst int dy[] = {1,0,-1,0,0};\nint cnt,st[5],ed[5];\nvector<int>e[155];\ninline void init(){\n\tcnt = 0;\n\tmemset(vis,0,sizeof(vis));\n\tmemset(dis,0,sizeof(dis));\n}\ninline int check(int a,int b,int x,int y){\n\treturn (b == y) || (a == y && b == x);//\u4e24\u4e2a\u5c0f\u9b3c\u76ee\u6807\u7ed3\u70b9\u76f8\u540c\u6216\u8005\u662f \u4e00\u4e2a\u662f\uff08i,j) \u4e00\u4e2a\u662f(j,i) \u4e5f\u5c31\u662f\u8bf4\u4ed6\u4eec\u7684\u76ee\u6807\u70b9\u662f\u5bf9\u65b9\u7684\u8d77\u70b9\uff0c\u8fd9\u4e5f\u662f\u4e0d\u884c\u7684 \n}\nstruct qwq{//\u8fd9\u662f\u5230\u65f6\u5019bfs\u7528\u7684\uff0c\u5b58\u50a8\u4e09\u4e2a\u5c0f\u9b3c\u7684\u4f4d\u7f6e \n\tint a,b,c;\n\tqwq(int x,int y,int z) : a(x),b(y),c(z) {} \n};\nstruct point{//\u5b58\u56fe\u7684\u70b9 \n\tint x,y;\n\t//point(int a,int b) : x(a),y(b) {}\t\n}node[N];\ninline void read(){\n\tchar ch = getchar();\n\twhile(ch != '\\n')ch = getchar();\n\tfor(register int i=1;i<=h;++i){\n\t\tfgets(s[i]+1,20,stdin);//\u9634\u95f4\u8bfb\u5165\u3002\u3002\u3002\n\t\tfor(register int j=1;j<=w;++j){\n\t\t\tif(s[i][j] != '#'){\n\t\t\t\tid[i][j] = ++cnt;\n\t\t\t\tnode[cnt] = (point){i,j};//\u8be5\u70b9\u53ef\u8d70\uff0c\u5b58\u8fdb\u6765 \n\t\t\t\tif(s[i][j] >= 'a' && s[i][j] <= 'z')\n\t\t\t\t\tst[s[i][j] - 'a'] = id[i][j];//\u8d77\u70b9 \n\t\t\t\telse if(s[i][j] >= 'A' && s[i][j] <= 'Z')\n\t\t\t\t\ted[s[i][j] - 'A'] = id[i][j];//\u7ec8\u70b9 \n\t\t\t}\n\t\t}\n\t\t\n\t}\n}\ninline void build(){\n\tfor(register int i=1;i<=cnt;++i){\n\t\te[i].clear();\n\t\tfor(int j=0;j<5;++j)\n\t\t\tif(s[node[i].x + dx[j]][node[i].y + dy[j]] != '#')\n\t\t\t\te[i].push_back(id[node[i].x + dx[j]][node[i].y + dy[j]]);//\u8fde\u63a5\u51fa\u8fb9 \n\t}\n\tif(n <= 2){\n\t\t++cnt;\n\t\te[cnt].push_back(cnt);\n\t\tst[2] = ed[2] = cnt;\t\n\t}//\u8fd9\u4e24\u4e2a\u7279\u5224\u662f\u7279\u5224\u5c0f\u9b3c\u4e0d\u591f3\u4e2a \u4e0d\u591f\u5c31\u8865\u4e0a\uff0c\u56e0\u4e3a\u4ed6\u6ca1\u6709\u8fb9\uff0c\u6240\u4ee5\u4e0d\u7528\u62c5\u5fc3\u4ec0\u4e48 \n\tif(n <= 1){\n\t\t++cnt;\n\t\te[cnt].push_back(cnt);\n\t\tst[1] = ed[1] = cnt;\t\n\t}\n}\ninline int bfs(){\n\tqueue<qwq>q[2];\n\tdis[st[0]][st[1]][st[2]] = 0;\n\tdis[ed[0]][ed[1]][ed[2]] = 0;\n\tvis[st[0]][st[1]][st[2]] = 1;//1\u4ee3\u8868\u6b63\u5411\u641c\u7d22\u7684\u8bbf\u95ee\u6807\u8bb0 \n\tvis[ed[0]][ed[1]][ed[2]] = 2;//2\u4ee3\u8868\u53cd\u5411\u641c\u7d22\u7684\u8bbf\u95ee\u6807\u8bb0 \n\tq[0].push(qwq(st[0],st[1],st[2]));//q[0]\u662f\u6b63\u5411\u641c \n\tq[1].push(qwq(ed[0],ed[1],ed[2]));//q[1]\u662f\u53cd\u5411\u641c \u4ece\u7ec8\u70b9\u5f00\u59cb \n\twhile(!q[0].empty() || !q[1].empty()){\n\t\tint l[2],pos;\n\t\tl[0] = q[0].size(),l[1] = q[1].size();//\u6bcf\u6b21\u53d6\u51fa\u5f53\u524d\u7684\u8fd9\u4e00\"\u5c42\"\u4e14\u53d6\u5b8c\u3002 \n\t\tfor(pos = 0;pos < 2;++pos)//\u6b63\u53cd\u90fd\u6765 \n\t\t\twhile(l[pos]--){//\u8fd9\u4e00\u5c42 \n\t\t\t\tqwq now = q[pos].front();\t\n\t\t\t\tq[pos].pop();\n\t\t\t\tint a = now.a,b = now.b,c = now.c;\n\t\t\t\tfor(int a1 : e[a])//\u4e09\u4e2a\u5c0f\u9b3c\u4ece\u5f53\u524d\u4f4d\u7f6e\u53ef\u4ee5\u8d70\u5230\u7684\u7ed3\u70b9 \n\t\t\t\t\tfor(int b1 : e[b]){\n\t\t\t\t\t\tif(check(a,a1,b,b1))continue;//\u77db\u76fe \n\t\t\t\t\t\tfor(int c1 : e[c]){\n\t\t\t\t\t\t\tif(check(a,a1,c,c1) || check(b,b1,c,c1))continue;//\u77db\u76fe \n\t\t\t\t\t\t\tif(!vis[a1][b1][c1]){//\u6ca1\u8bbf\u95ee\u8fc7 \n\t\t\t\t\t\t\t\tdis[a1][b1][c1] = dis[a][b][c] + 1;\n\t\t\t\t\t\t\t\tvis[a1][b1][c1] = pos + 1;\n\t\t\t\t\t\t\t\tq[pos].push(qwq(a1,b1,c1));\t\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if(vis[a1][b1][c1] == 2 - pos)//\u6709\u53e6\u4e00\u4e2a\u975e\u96f6\u6807\u8bb0\u51fa\u73b0\u8fc7\uff0c\u8bc1\u660e\u641c\u7d22\u6811\u76f8\u4ea4\uff0c\u7ed3\u675fbfs \n\t\t\t\t\t\t\t\treturn dis[a][b][c] + 1 + dis[a1][b1][c1];//\u6b65\u6570\u5c31\u662f\u6b63\u5411\u7684\u6b65\u6570\u52a0\u4e0a\u53cd\u5411\u7684\uff0c\u7531\u4e8e\u80af\u5b9a\u6709\u4e00\u4e2a\u8fd8\u6ca1\u52a0\u4e00\uff0c\u6240\u4ee5\u52a0\u4e0a \n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t}\n\t}\n}\nint main(){\n\twhile(scanf(\"%d%d%d\",&w,&h,&n) && (w || h || n)){\n\t\tread();\n\t\tbuild();//\u5efa\u56fe \n\t\tprintf(\"%d\\n\",bfs());\n\t\tinit();//\u521d\u59cb\u5316 \n\t}\n}\n```\n",
        "postTime": 1648049981,
        "uid": 141058,
        "name": "Xu_brezza",
        "ccfLevel": 0,
        "title": "P1778 \u9898\u89e3"
    }
]
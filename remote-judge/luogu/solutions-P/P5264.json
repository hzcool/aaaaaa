[
    {
        "content": "# \u60f3\u8981\u5199\u4ee3\u7801\u8bf7\u5148\u5b66\u4f1a[\u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570](https://www.luogu.org/problemnew/show/P4726)(\u5fc5\u5907\u524d\u7f6e\u6761\u4ef6)\n\n### \u7b97\u6cd5\u539f\u7406:\u6b27\u62c9\u516c\u5f0f(\u975e\u5fc5\u5907)\n\n\u60f3\u8981\u5f04\u6e05\u695a\u539f\u7406\u8bf7\u5148\u4e86\u89e3\u5bfc\u6570(\u4e8b\u5b9e\u4e0a\u53ea\u9700\u8981\u770b\u5f97\u61c2\u600e\u4e48**\u8868\u793a**\u5bfc\u6570\u5c31\u53ef\u4ee5\u4e86\uff0c\u6211\u628a\u8981\u7528\u5230\u7684\u5bfc\u6570\u516c\u5f0f\u90fd\u5199\u5b8c\u4e86)\n\n\u4e0d\u60f3\u5f04\u6e05\u695a\u539f\u7406\u6216\u5df2\u77e5\u9053\u6b27\u62c9\u516c\u5f0f\u4f46\u4e0d\u77e5\u9053\u600e\u4e48\u5199\u4ee3\u7801\u7684\uff08\u6211\u89c9\u5f97\u77e5\u9053\u6b27\u62c9\u516c\u5f0f\u7684\u5e94\u8be5\u90fd\u662f\u590d\u5236\u7c98\u8d34\u4ee5\u524d\u7684\u4ee3\u7801\uff0c\u7136\u540e\u6539\u4e00\u6539\u5c31\u79d2\u8fc7\u4e86\uff0c\u6240\u4ee5\u5e94\u8be5\u4e0d\u4f1a\u6709\u8fd9\u79cd\u4eba\u6765\u770b\u9898\u89e3\uff09\uff0c\u53ef\u4ee5\u76f4\u63a5\u8df3\u5230\u7ed3\u8bba\u90e8\u5206\u3002\u6838\u5fc3\u4ee3\u7801\u6781\u5176\u7b80\u5355\uff0c\u6709\u4e86\u5fc5\u5907\u524d\u7f6e\u6761\u4ef6\u540e\u79d2\u51fa\u4ee3\u7801\u3002\n\n**\u6cf0\u52d2\u516c\u5f0f(\u6839\u636e\u51fd\u6570$f:\\mathbb{R^n} \\to \\mathbb{R^m}$\u5728$x$\u5904\u7684\u53d8\u5316\u60c5\u51b5\u8fd1\u4f3c\u786e\u5b9a\u51fa$f(x+h)$\u7684\u53d6\u503c)**\n\n\u4ee5\u4e0b\u5185\u5bb9\u4e0d\u533a\u5206**\u6cf0\u52d2\u516c\u5f0f\uff0c\u6cf0\u52d2\u591a\u9879\u5f0f\uff0c\u6cf0\u52d2\u7ea7\u6570**\n\n$f:\\mathbb{R^n} \\to \\mathbb{R^m}$\u7684\u6cf0\u52d2\u516c\u5f0f(\u7528\u4e0d\u7740\uff0c\u6446\u51fa\u6765\u597d\u770b\u7684)\n\n$f(x+h)-f(x)=\\sum_{k=1}\\dfrac{1}{k!}(h^1\\partial_1+h^2\\partial_2+...+h^m\\partial_m)^kf(x)+R(x)$\n\n**$f:\\mathbb{R} \\to \\mathbb{R}$\u7684\u6cf0\u52d2\u516c\u5f0f**(\u8fd9\u91cc\u7684$x$\u53d6\u4e0a\u65b9\u7684$x+h$\uff0c$x_0$\u53d6\u4e0a\u65b9\u7684$x$,\u518d\u628a$f(x_0)$\u79fb\u8fc7\u53bb)\n\n$f(x)=\\sum_{k=0}^{n}{\\dfrac{f^{(k)}(x_0)}{k!}(x-x_0)^k}+R(x)$\n\n\u5176\u4e2d$f^{(k)}(x)=\\dfrac{d^kf}{dx^k}(x)$\u8868\u793a$f(x)$\u7684$k$\u9636\u5bfc\u51fd\u6570\n\n\u5373\n\n$f^{(0)}(x)=f(x)$\n\n$f^{(k+1)}(x)=\\dfrac{df^{(k)}}{dx}(x)$\n\n\u8fd9\u5c31\u662f\u6211\u4eec\u9700\u8981\u7684\uff0c\u4f60\u53ef\u4ee5\u628a\u5b83\u770b\u505a\u4e00\u4e2a\u51ed\u7a7a\u634f\u51fa\u6765\u7684\u516c\u5f0f\uff0c\u7136\u540e**\u5f3a\u884c\u7528$R(x)$\u8865\u4e0a\u5dee\u8ddd**\n\n\u5b83\u6709\u4e00\u4e2a\u663e\u7136\u800c\u7f8e\u5999\u7684\u6027\u8d28\uff1a\u82e5$\\lim_{n \\to +\\infty} R(x)=0$\uff0c\u5219$f(x)=\\sum_{k=0}^{+\\infty}{\\dfrac{f^{(k)}(x_0)}{k!}(x-x_0)^k}$\n\n\n**$R(x)$\u4e3a\u4e00\u4e0e$f$\u548c$n$\u76f8\u5173\u7684\u51fd\u6570\uff0c\u79f0\u4e3a\u4f59\u9879\u3002** \u53ef\u8bc1$n \\to +\\infty$\u65f6$e^x,sin(x),cos(x)$\u7684\u4f59\u9879$R(x) \\to 0$(\u6ce8\u610f\u5e76\u4e0d\u662f\u6240\u6709\u51fd\u6570\u7684\u90fd\u6ee1\u8db3$\\lim_{n \\to +\\infty} R(x)=0$\uff0c\u4f46\u5f88\u5de7\u5408\u7684\u662f\u521d\u7b49\u51fd\u6570\u7c7b\u4e2d\u7684\u51fd\u6570\u5927\u591a\u90fd\u6709\u8fd9\u4e2a\u6027\u8d28),\u5173\u4e8e\u6b64\u90e8\u5206\u7684\u8bc1\u660e\u6d89\u53ca**\u4e2d\u503c\u5b9a\u7406**\u548c**\u6781\u9650\u6536\u655b\u7684\u5224\u5b9a\u65b9\u6cd5**,\u8f83\u4e3a\u590d\u6742,\u6545**\u7565\u8fc7**\uff0c\u8be6\u7ec6\u8bc1\u660e\u53ef\u53c2\u89c1\u5404\u4e2a\u7248\u672c\u7684\u300a\u6570\u5b66\u5206\u6790\u300b\u6216\u300a\u9ad8\u7b49\u6570\u5b66\u300b\u7b49**\u6709\u5173\u5fae\u79ef\u5206\u7684\u4e66\u7c4d**\u3002\u6b64\u516c\u5f0f\u975e\u5e38\u7ecf\u5178\uff0c\u53ea\u8981\u662f\u6d89\u53ca\u5fae\u79ef\u5206\u7684\u4e66\u5e94\u8be5\u90fd\u4f1a\u6709\u3002\u9ad8\u4e2d\u6570\u5b66\u6559\u6750\u300a\u9009\u4fee2-2\u300b\u4e0d\u7b97\u5173\u4e8e\u5fae\u79ef\u5206\u7684\u4e66\u7c4d\uff0c\u53ea\u80fd\u53eb\u5fae\u79ef\u5206\u7684\u79d1\u666e(\u867d\u7136\u6211\u4e0d\u4f1a\u505a\u9898\uff0c\u4f46\u6211\u8fd8\u662f\u7406\u4e0d\u76f4\uff0c\u6c14\u4e5f\u58ee\u5730\u6b67\u89c6\u5b83)\u3002\n\n**\u53c8\u56e0\u4e3a\u4e09\u89d2\u51fd\u6570\u548c\u6307\u6570\u51fd\u6570\u7684\u5bfc\u6570**\n\n$\\dfrac{dsin(x)}{dx}=cos(x)$\n\n$\\dfrac{dcos(x)}{dx}=-sin(x)$\n\n$\\dfrac{de^x}{dx}=e^x$\n\n\u51fa\u73b0\u5468\u671f\u6027\uff0c\u4e14\u90fd\u5728$x_0=0$\u5904\u6709\u5b9a\u4e49\uff0c\u4fbf\u4e8e\u8ba1\u7b97\uff08$e^0=1,sin(0)=0,cos(0)=1$\uff09\n\n**\u4e8e\u662f\u987a\u7406\u6210\u7ae0\u5730\u53d6$x_0=0$\uff0c\u53ef\u5f97\u4e09\u89d2\u51fd\u6570\u548c\u6307\u6570\u51fd\u6570\u7684\u6cf0\u52d2\u5c55\u5f00:**\n\n$e^x=\\sum_{k=0}^{+\\infty}{\\dfrac{x^k}{k!}}=1+x+\\dfrac{x^2}{2!}+\\dfrac{x^3}{3!}+...$(\u5982\u679c\u8981\u7ec3\u4e60\u4f7f\u7528\u6cf0\u52d2\u516c\u5f0f\uff0c\u90a3\u8fd9\u662f\u6700\u7b80\u5355\u7684\u4e00\u4e2a)\n\n$sin(x)=\\sum_{k=0}^{+\\infty}{(-1)^{k}\\dfrac{x^{2k+1}}{(2k+1)!}}=x-\\dfrac{x^3}{3!}+\\dfrac{x^5}{5!}-...$(\u6ce8\u610f\u5468\u671f$sin(0)=0,cos(0)=1,-sin(0)=0,-cos(0)=-1$)\n\n$cos(x)=\\sum_{k=0}^{+\\infty}{(-1)^{k}\\dfrac{x^{2k}}{2k!}}=1-\\dfrac{x^2}{2!}+\\dfrac{x^4}{4!}-...$(\u6ce8\u610f\u5468\u671f$cos(0)=1,-sin(0)=0,-cos(0)=-1,sin(0)=0$)\n\n\u8fd9\u4e09\u4e2a\u5f0f\u5b50\u957f\u5f97\u7279\u522b\u50cf\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u778e\u641e\u4e00\u901a\n\n(\u4f60\u95ee\u6211\u4ec0\u4e48\u53eb\u4e0d\u50cf\uff1f $(1+x)^{\\alpha}=\\sum_{k=0}^{+\\infty}{\\dfrac{{\\alpha}({\\alpha}-1)...({\\alpha}-(k-1))}{k!}x^k}\n=1+{\\alpha}x+\\dfrac{{\\alpha}({\\alpha}-1)}{2}x^{2}+\\dfrac{{\\alpha}({\\alpha}-1)({\\alpha}-2)}{6}x^3+...$\uff0c\u660e\u767d\u4e86\u5427)\n\n**\u5982\u679c\u5b58\u5728\u4e00\u4e2a\u6570i\u6ee1\u8db3\u4ee5\u4e0b\u5173\u7cfb\u5f0f**\n\n$i^2=-1$\n\n$i^3=-i$\n\n$i^4=1$\n\n**\u90a3\u4e48**\n\n$e^{ix}=1+ix+\\dfrac{i^2x^2}{2!}+\\dfrac{i^3x^3}{3!}+\\dfrac{i^4x^4}{4!}+\\dfrac{i^5x^5}{5!}+...$\n\n$e^{ix}=1+ix-\\dfrac{x^2}{2!}-i\\dfrac{x^3}{3!}+\\dfrac{x^4}{4!}+i\\dfrac{x^5}{5!}-...$\n\n$e^{ix}=(1-\\dfrac{x^2}{2!}+\\dfrac{x^4}{4!}-...)+i(x-\\dfrac{x^3}{3!}+\\dfrac{x^5}{5!}-...)$\n\n\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u4e86\u6b27\u62c9\u516c\u5f0f\n\n# $e^{ix}=cos(x)+isin(x)$\n\n\u5c06$-x$\u4ee3\u5165\u53ef\u5f97\n\n$e^{-ix}=cos(-x)+isin(-x)=cos(x)-isin(x)$\n\n**\u89c6$e^{ix},e^{-ix},i$\u4e3a\u5df2\u77e5\u91cf\uff0c\u89e3\u51fa$sin(x),cos(x)\u5373\u53ef$**\n\n# \u7ed3\u8bba:\n\n### $sin(x)=\\dfrac{e^{ix}-e^{-ix}}{2i}$\n\n### $cos(x)=\\dfrac{e^{ix}+e^{-ix}}{2}$\n\n**\u5728\u6a21\u610f\u4e49\u4e0b\u53d6$i=g^{\\frac{p-1}{4}}$,$g$\u4e3a$P$\u7684\u539f\u6839**\n\n\u5728$x \\in \\mathbb{C}$\u65f6\u6211\u4eec\u7684\u4ee3\u7801\u5b9e\u9645\u4e0a\u6c42\u5f97\u4e86$sin(A(x)),cos(A(x))$\u7684\u6cf0\u52d2\u591a\u9879\u5f0f\u7684\u524d$n$\u9879(\u6211\u6ca1\u6709\u53bb\u9a8c\u8bc1$x_0$\u7684\u53d6\u503c,$x_0$\u4e0d\u540c\u5f80\u5f80\u4f1a\u5f97\u5230\u4e0d\u540c\u7684\u6cf0\u52d2\u591a\u9879\u5f0f)\uff0c\u6240\u4ee5\u591a\u9879\u5f0f\u4e09\u89d2\u51fd\u6570\u5e76\u4e0d\u662f\u610f\u4e49\u4e0d\u660e\u7684\u3002\u800c\u4e14\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u6cf0\u52d2\u591a\u9879\u5f0f\u6709\u7740\u6781\u9ad8\u7684\u6536\u655b\u901f\u5ea6\u548c\u7cbe\u5ea6\u3002(\u4e22\u4eba\u7684\u53cd\u4f8b$\\dfrac{\\pi}{4}=1-\\dfrac{1}{3}+\\dfrac{1}{5}-...$\u6536\u655b\u901f\u5ea6\u6781\u6162,\u53d6\u4e2a1000\u9879\u7cbe\u5ea6\u4e0d\u59823.14159)\n\n**\u4ee5\u4e0b\u4e3a\u6838\u5fc3\u4ee3\u7801**\n\n```\nconst int G=3;\nconst int P=998244353;\npolymerization sin(const polymerization &a){\n\tll i=pow(G,(P-1)/4);\n\tpolymerization x(a*i);\n\treturn (exp(x)-exp(-x))*pow(2*i%P,P-2);\n}\npolymerization cos(const polymerization &a){\n\tll i=pow(G,(P-1)/4);\n\tpolymerization x(a*i);\n\treturn (exp(x)+exp(-x))*pow(2,P-2);\n}\n```\n\n**\u6362\u4e3a\u4ee5\u4e0b\u4ee3\u7801\u5219\u53d6\u6a21\u6216\u590d\u6570\u901a\u5403**\n```\ntemplate < typename T >\npolymerization sin(const polymerization &a,T i){\n\tpolymerization x(a*i);\n\treturn (exp(x)-exp(-x))*inverse(2*i);\n}\ntemplate < typename T >\npolymerization cos(const polymerization &a,T i){\n\tpolymerization x(a*i);\n\treturn (exp(x)+exp(-x))*inverse(2);\n}\n```\n\n[\u5b8c\u6574\u4ee3\u7801(\u6d1b\u8c37\u4e91\u526a\u8d34\u677f)](https://www.luogu.org/paste/0pa5bfhz)",
        "postTime": 1552877954,
        "uid": 81705,
        "name": "\u5bc6\u671f\u671b",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5264 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e09\u89d2\u51fd\u6570\u3011"
    },
    {
        "content": "\n\u5927\u540d\u9f0e\u9f0e\u7684\u6b27\u62c9\u516c\u5f0f  \n$$\\text e^{\\text ix}=\\cos x+ \\text i\\sin x$$  \n\u628a\u8fd9\u4e2a\u5f0f\u5b50\u7a0d\u5fae\u53d8\u5f62\u4e00\u4e0b   \n$$\\text e^{-\\text ix}=\\cos x-\\text i\\sin x$$   \n\u5c06\u8fd9\u4e24\u4e2a\u5f0f\u5b50\u76f8\u52a0\u6216\u76f8\u51cf\u4e00\u4e0b\uff0c\u5f97\u5230\n$$2\\cos x= \\text e^{\\text ix}+ \\text e^{-\\text ix}$$  \n$$2\\text i\\sin x=\\text e^{ix}-\\text e^{-\\text ix}$$  \n\u7136\u540e\u6211\u4eec\u79fb\u4e2a\u9879\uff0c\u5e76\u7528 $F(x)$ \u4ee3\u6362 $x$\uff0c\u5c31\u5f97\u51fa\u4e86\u7ed3\u679c  \n$$\\cos F(x)=\\frac{\\text e^{\\text iF(x)}+\\text e^{-\\text iF(x)}}{2}$$  \n$$\\sin F(x)=\\frac{\\text e^{\\text iF(x)}-\\text e^{-\\text iF(x)}}{2\\text i}$$  \n\u53ef\u662f\u8fd9\u91cc\u8fd8\u6709\u4e2a\u865a\u6570\u5355\u4f4d $\\text i$ \u5462\u3002\u3002\u8fd9\u600e\u4e48\u53d6\u6a21\u554a QAQ  \n\u522b\u614c\uff0c\u6211\u4eec\u51b7\u9759\u5206\u6790\u4e00\u4e0b   \n![](https://ss0.bdstatic.com/70cFuHSh_Q1YnxGkpoWK1HF6hhy/it/u=305794224,558519052&fm=26&gp=0.jpg)  \n\u865a\u6570\u5355\u4f4d $\\text i$ \u5b9e\u9645\u4e0a\u5c31\u662f $\\omega_4$\uff0c\u4e5f\u5c31\u662f $g^{(p-1)/4}$\uff0c\u5728\u6a21 $p$ \u4e0b\u5c31\u7b49\u4e8e $86583718$\u3002\n\n\u5269\u4e0b\u7684\uff0c\u5c31\u662f\u5957\u4e0a\u4e00\u4e2a[\u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570](https://www.luogu.org/problemnew/show/P4726)\u7684\u677f\u5b50\u4e86\u3002  \nCode\uff1a  \n```cpp\n#pragma GCC optimize (\"unroll-loops\")\n#pragma GCC optimize (2)\n#include<cstdio>\n#include<iostream>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#define N 262147\n#define ll long long\n#define reg register\n#define p 998244353\n#define add(x,y) (x+y>=p?x+y-p:x+y)\n#define dec(x,y) (x<y?x-y+p:x-y)\nusing namespace std;\n\ninline int power(int a,int t){\n\tint res = 1;\n\twhile(t){\n\t\tif(t&1) res = (ll)res*a%p;\n\t\ta = (ll)a*a%p;\n\t\tt >>= 1; \n\t}\n\treturn res;\n}\n\ninline void read(int &x){\n    x = 0;\n    char c = getchar();\n    while(c<'0'||c>'9') c = getchar();\n    while(c>='0'&&c<='9'){\n        x = (x<<3)+(x<<1)+(c^48);\n        c = getchar();\n    }\n}\n\nvoid print(int x){\n    if(x>9) print(x/10);\n    putchar(x%10+'0');\n}\n\nint rev[N],rt[N],inv[N],inv2[N];\nint siz;\n\nvoid init(int n){\n    int w,lim = 1;\n    while(lim<=n) lim <<= 1,++siz;\n    for(reg int i=1;i!=lim;++i) rev[i] = (rev[i>>1]>>1)|((i&1)<<(siz-1));\n    inv2[1] = inv[1] = rt[lim>>1] = 1;\n    w = power(114514,(p-1)>>siz); //114514 \u4e5f\u662f 998244353 \u7684\u539f\u6839\n    for(reg int i=(lim>>1)+1;i!=lim;++i) rt[i] = (ll)rt[i-1]*w%p;\n    for(reg int i=(lim>>1)-1;i;--i) rt[i] = rt[i<<1];\n    for(reg int i=2;i<=n;++i) inv[i] = (ll)(p-p/i)*inv[p%i]%p;\n    for(reg int i=1;i<=siz;++i) inv2[1<<i] = p-((p-1)>>i);\n}\n\ninline int getlen(int n){\n    return 1<<(32-__builtin_clz(n));\n}\n\ninline void NTT(int *f,int type,int lim){\n    if(type==-1) reverse(f+1,f+lim);\n    static unsigned long long a[N];\n    reg int x,shift = siz-__builtin_ctz(lim);\n    for(reg int i=0;i!=lim;++i) a[rev[i]>>shift] = f[i];\n    for(reg int mid=1;mid!=lim;mid<<=1)\n    for(reg int j=0;j!=lim;j+=(mid<<1))\n    for(reg int k=0;k!=mid;++k){\n        x = a[j|k|mid]*rt[mid|k]%p;\n        a[j|k|mid] = a[j|k]-x+p;\n        a[j|k] += x;\n    } \n    for(reg int i=0;i!=lim;++i) f[i] = a[i]%p;\n    if(type==1) return;\n    x = inv2[lim];\n    for(reg int i=0;i!=lim;++i) f[i] = (ll)f[i]*x%p;\n}\n\ninline void inverse(const int *f,int n,int *R){\n    static int g[N],h[N],s[30];\n    memset(g,0,getlen(n<<1)<<2);\n    int lim = 1,top = 0;\n    while(n){\n        s[++top] = n;\n        n >>= 1;\n    }\n    g[0] = power(f[0],p-2);\n    while(top--){\n        n = s[top+1];\n        while(lim<=(n<<1)) lim <<= 1;\n        memcpy(h,f,(n+1)<<2);\n        memset(h+n+1,0,(lim-n)<<2);\n        NTT(g,1,lim),NTT(h,1,lim);\n        for(reg int i=0;i!=lim;++i) g[i] = g[i]*(2-(ll)g[i]*h[i]%p+p)%p;\n        NTT(g,-1,lim);\n        memset(g+n+1,0,(lim-n)<<2);\n    }\n    memcpy(R,g,(n+1)<<2);\n}\n\ninline void log(int *f,int n){\n    static int g[N];\n    int lim = getlen(n<<1);\n    inverse(f,n,g);\n    memset(g+n+1,0,(lim-n)<<2);\n    for(reg int i=0;i!=n;++i) f[i] = (ll)f[i+1]*(i+1)%p;\n    f[n] = 0;\n    NTT(f,1,lim),NTT(g,1,lim);\n    for(reg int i=0;i!=lim;++i) f[i] = (ll)f[i]*g[i]%p;\n    NTT(f,-1,lim);\n    for(reg int i=n;i;--i) f[i] = (ll)f[i-1]*inv[i]%p;\n    f[0] = 0;\n    memset(f+n+1,0,(lim-n)<<2);\n}\n\ninline void exp(const int *f,int n,int *R){\n    static int g[N],h[N],s[30];\n    int lim = 1,top = 0;\n    memset(g,0,getlen(n<<1)<<2);\n    while(n){\n        s[++top] = n;\n        n >>= 1;\n    }\n    g[0] = 1;\n    while(top--){\n        n = s[top+1];\n        while(lim<=(n<<1)) lim <<= 1;\n        memcpy(h,g,(n+1)<<2);\n        memset(h+n+1,0,(lim-n)<<2);\n        log(g,n);\n        for(reg int i=0;i<=n;++i) g[i] = dec(f[i],g[i]);\n        g[0] = add(g[0],1);\n        NTT(g,1,lim),NTT(h,1,lim);\n        for(reg int i=0;i!=lim;++i) g[i] = (ll)g[i]*h[i]%p;\n        NTT(g,-1,lim);\n        memset(g+n+1,0,(lim-n)<<2);\n    }\n    memcpy(R,g,(n+1)<<2);\n}\n\n#define img 86583718\n\ninline void cos(const int *f,int n,int *R){\n    static int g[N],h[N];\n    for(reg int i=0;i<=n;++i) g[i] = (ll)f[i]*img%p;\n    exp(g,n,g);\n    inverse(g,n,h);\n    for(reg int i=0;i<=n;++i) R[i] = 499122177ll*(g[i]+h[i])%p;\n    \n}\n\ninline void sin(const int *f,int n,int *R){\n    static int g[N],h[N];\n    for(reg int i=0;i<=n;++i) g[i] = (ll)f[i]*img%p;\n    exp(g,n,g);\n    inverse(g,n,h);\n    int x = power(img<<1,p-2);\n    for(reg int i=0;i<=n;++i) R[i] = (ll)x*(g[i]-h[i]+p)%p;\n}\n\n#undef img;\n\nint F[N];\nint n,tp;\n\nint main(){\n    read(n),read(tp);\n    init(n<<1|1);\n    for(reg int i=0;i!=n;++i) read(F[i]);\n    if(tp==0) sin(F,n-1,F);\n    else cos(F,n-1,F);\n    for(reg int i=0;i!=n;++i) print(F[i]),putchar(' ');\n\treturn 0;\t\n}\n```\n",
        "postTime": 1552753229,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "\u3010\u9898\u89e3\u3011\u591a\u9879\u5f0f\u4e09\u89d2\u51fd\u6570"
    },
    {
        "content": "\u9996\u5148\u8bc1\u660e\u4e00\u4e0b\u6b27\u62c9\u516c\u5f0f\n$$e^{i\\theta}=\\cos\\theta+i\\sin\\theta$$\n\u7531\u9ea6\u514b\u52b3\u6797\u5c55\u5f00\u5f0f\uff0c\u6211\u4eec\u6709\n$$e^{x}=\\sum_{n=0}^{\\infty}\\frac{x^n}{n!}$$\n\u6307\u6570\u4e58\u4e0a\u865a\u6570\u5355\u4f4d$i$\n$$e^{ix}=\\sum_{n=0}^{\\infty}\\frac{(ix)^n}{n!}=\\sum_{n=0}^{\\infty}(i)^n\\frac{x^n}{n!}$$\n\u6211\u4eec\u628a\u4e0e$i$\u6709\u5173\u7684\u653e\u4e00\u8fb9\uff0c\u4e0e$i$\u65e0\u5173\u7684\u653e\u4e00\u8fb9\n$$e^{ix}=\\sum_{n=0}^{\\infty}\\frac{(-1)^nx^{2n}}{(2n)!}+i\\sum_{n=0}^{\\infty}\\frac{(-1)^nx^{2n+1}}{(2n+1)!}$$\n\u53d1\u73b0\u4e24\u8fb9\u548c\u5f0f\u6b63\u662f$\\cos$\u4e0e$\\sin$\u7684\u5c55\u5f00\u5f62\u5f0f\uff0c\u4e8e\u662f\u6709\n$$e^{ix}=\\cos x+i\\sin x\\ \\ \\ \\ (1)$$\n\u5f00\u59cb\u6211\u4eec\u7684\u63a8\u5bfc\n$$e^{i(-x)}=\\cos (-x)+i\\sin(-x)=\\cos x-i\\sin\\ \\ \\ (2)$$\n$(1)+(2)$\uff0c\u6211\u4eec\u6709\n$$e^{ix}+e^{-ix}=2\\cos x$$\n$$\\cos x=\\frac{e^{ix}+e^{-ix}}{2}$$\n\u540c\u7406\u53ef\u5f97\n$$\\sin x=\\frac{e^{ix}-e^{-ix}}{2i}$$\n\u5c06\u6211\u4eec\u7684\u591a\u9879\u5f0f\u5e26\u5165\uff0c\u53ef\u5f97\n$$\\cos A(x)=\\frac{\\exp(iA(x))+\\exp(-iA(x))}{2}$$\n$$\\sin A(x)=\\frac{\\exp(iA(x))-\\exp(-iA(x))}{2i}$$\n\u8003\u8651\u5230\n$$i^2\\equiv -1\\pmod{998244353}$$\n\u4e8e\u662f\n$$i^2\\equiv 998244352\\pmod{998244353}$$\n\u505a\u4e00\u904d\u4e8c\u6b21\u5269\u4f59\uff0c\u5c31\u53ef\u4ee5\u5c06\u865a\u6570\u5355\u4f4d\u53bb\u6389\u4e86\n\n\u4ee3\u7801\u5982\u4e0b\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#include <algorithm>\ntypedef long long ll;\nconst int P = 998244353, N = 262145, g3 = (P + 1) / 3;\nconst int img = 86583718;\nusing namespace std;\nint n, type, a[N], b[N];\n\nint pow(int a,int b)\n{\n\tint r = 1;\n\twhile(b)\n\t{\n\t\tif(b & 1) r = (ll)r * a % P;\n\t\ta = (ll)a * a % P;\n\t\tb >>= 1;\n\t}\n\treturn r;\n}\nnamespace poly\n{\n    int rev[N];\n\tvoid NTT(int *A, int n, int inv) \n\t{\n\t\tfor(int i = 0; i < n; ++i)\n\t\t\tif(i < rev[i]) swap(A[i], A[rev[i]]);\n\t\tfor(int mid = 1; mid < n; mid <<= 1) \n\t\t{\n\t\t\tint tmp = pow(inv == 1 ? 3 : g3, (P - 1) / (mid << 1));\n\t\t\tfor(int j = 0; j < n; j += (mid << 1)) \n\t\t\t{\n\t\t\t\tint omega = 1;\n\t\t\t\tfor(int k = 0; k < mid; ++k, omega = (ll)omega * tmp % P) \n\t\t\t\t{\n\t\t\t\t\tint x = A[j + k], y = (ll)omega * A[j + k + mid] % P;\n\t\t\t\t\tA[j + k] = (x + y) % P;\n\t\t\t\t\tA[j + k + mid] = (ll)(x - y + P) % P;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(inv == 1) return;\n\t\tint invn = pow(n, P - 2);\n\t\tfor(int i = 0; i < n; ++i)\n\t\t\tA[i] = (ll)A[i] * invn % P;\n\t}\n    void Inv(int *a, int *b, int n) \n\t{\n\t\tstatic int B[N], A[N];\n\t\tb[0] = pow(a[0], P - 2);\n\t\tint len, lim;\n\t\tfor(len = 1; len < (n << 1); len <<= 1)\n\t\t{\n\t\t\tlim = len << 1;\n\t\t\tfor(int i = 0; i < len; i++)\n\t\t\t\tA[i] = a[i], B[i] = b[i];\n\t\t\tfor(int i = 0; i < lim; i++)\n\t\t\t\trev[i] = (rev[i >> 1] >> 1) | ((i & 1) ? len : 0);\n\t\t\tNTT(A, lim, 1), NTT(B, lim, 1);\n\t\t\tfor(int i = 0; i < lim; i++)\n\t\t\t\tb[i] = ((2LL - 1LL * A[i] * B[i] % P) * B[i] % P + P) % P;\n\t\t\tNTT(b, lim, -1);\n\t\t\tfor(int i = len; i < lim; i++)\n\t\t\t\tb[i] = 0;\n\t\t}\n\t\tfor(int i = 0; i < len; i++) \n\t\t\tA[i] = B[i] = 0;\n\t\tfor(int i = n; i < len; i++)\n\t\t\tb[i] = 0;\n\t}\n    void derivative(int *a, int *b, int n)\n\t{\n        b[n - 1] = 0;\n        for(int i = 1; i < n; ++i)\n        \tb[i - 1] = (ll)a[i] * i % P;\n    }\n    void inter(int *a, int *b, int n)\n\t{\n        *b = 0;\n        for(int i = n - 1; i >= 0; --i)\n\t\t\tb[i + 1] = a[i] * (ll)pow(i + 1, P - 2) % P;\n    }\n    void ln(int *a, int *b, int n)\n\t{\n        static int F[N];\n        derivative(a, F, n);\n\t\tInv(a, b, n);\n        int lim = 1;\n        while(lim < (n << 1)) lim <<= 1;\n        for(int i = 1; i < lim; i++)\n        \trev[i] = (rev[i >> 1] >> 1) | ((i & 1) ? (lim >> 1) : 0);\n        for(int i = n; i < lim; ++i)\n\t\t\tb[i] = F[i] = 0;\n        NTT(F, lim, 1), NTT(b, lim, 1);\n        for(int i = 0; i < lim; ++i)\n\t\t\tF[i] = (ll)b[i] * F[i] % P;\n        NTT(F, lim, 0);\n        inter(F, b, n);\n        for(int i = n; i < lim; ++i)\n\t\t\tb[i] = 0;\n    }\n    void exp(int *a, int *F, int n)\n\t{\n        if(n == 1)\n\t\t\t*F = 1;\n\t\telse\n\t\t{\n            exp(a, F, n + 1 >> 1);\n            static int F0[N], A[N];\n            for(int i = 0; i <= (n << 1); ++i)\n\t\t\t\tF0[i] = 0, A[i] = a[i];\n            ln(F, F0, n);\n            int lim = 1;\n            while(lim < (n << 1)) lim <<= 1;\n            for(int i = 1; i < lim; i++)\n            \trev[i] = (rev[i >> 1] >> 1) | ((i & 1) ? (lim >> 1) : 0);\n            for(int i = n; i < lim; ++i)\n\t\t\t\tA[i] = 0;\n            NTT(A, lim, 1), NTT(F0, lim, 1), NTT(F, lim, 1);\n            for(int i = 0; i < lim; ++i)\n\t\t\t\tF[i] = F[i] * (A[i] + 1LL - F0[i] + P) % P;\n            NTT(F, lim, 0);\n            for(int i = n; i < lim; ++i)\n\t\t\t\tF[i] = 0;\n        }\n    }\n    void cos(int *a, int *b, int n)\n    {\n    \tstatic int K[N], A[N], B[N];\n    \tfor(int i = 0; i < n; i++)\n    \t\tK[i] = (ll)a[i] * img % P;\n    \texp(K, A, n);\n    \tInv(A, B, n);\n    \tfor(int i = 0; i < n; i++)\n    \t\tA[i] = (ll)(A[i] + B[i]) % P;\n    \tint inv = pow(2, P - 2);\n    \tfor(int i = 0; i < n; i++)\n    \t\tb[i] = (ll)A[i] * inv % P;\n\t}\n\tvoid sin(int *a, int *b, int n)\n\t{\n\t\tstatic int K[N], A[N], B[N];\n\t\tfor(int i = 0; i < n; i++)\n\t\t\tK[i] = (ll)a[i] * img % P;\n\t\texp(K, A, n);\n\t\tInv(A, B, n);\n\t\tfor(int i = 0; i < n; i++)\n\t\t\tA[i] = (ll)(A[i] - B[i] + P) % P;\n\t\tint inv = pow(img << 1, P - 2);\n\t\tfor(int i = 0; i < n; i++)\n\t\t\tb[i] = (ll)A[i] * inv % P;\n\t}\n}\nusing namespace poly;\nint main()\n{\n\tscanf(\"%d %d\", &n, &type);\n\tfor(int i = 0; i < n; i++)\n\t\tscanf(\"%d\", a + i);\n\tif(type == 0) sin(a, b, n);\n\telse cos(a, b, n);\n\tfor(int i = 0; i < n; i++)\n\t\tprintf(\"%d \", b[i]);\n    return 0;\n}\n```\n",
        "postTime": 1559209261,
        "uid": 139340,
        "name": "Gauss0320",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5264\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e09\u89d2\u51fd\u6570"
    },
    {
        "content": "## Tag\n\n\u751f\u6210\u51fd\u6570\uff1f\u591a\u9879\u5f0f\u3002\n\n## Description\n\n\u7ed9\u51fa $F(x)$\uff0c\u6c42\u51fa $G(x)\\equiv \\cos F(x)\\pmod{x^n}$ \u6216\u8005 $G(x)\\equiv \\sin F(x)\\pmod{x^n}$.\n\n$\\texttt{data range:} 1\\leq n \\leq 10^5$.\n\n## Solution\n\n\u7531\u4e8e\u6211\u4eec\u77e5\u9053\u6b27\u62c9\u516c\u5f0f\u6709\u5f88\u597d\u7684\u5b9a\u4e49\uff0c\u8fd9\u4e2a\u5b9a\u4e49\u5728\u751f\u6210\u51fd\u6570\u4e0a\u540c\u6837\u6210\u7acb\uff0c\u90a3\u4e48\u5957\u5165\u6b27\u62c9\u516c\u5f0f\u5c31\u5f88\u597d\u89e3\u51b3\u8fd9\u4e00\u4e2a\u95ee\u9898\u4e86\uff0c\u6211\u4eec\u77e5\u9053\uff1a\n\n$$\ne^{ix}=\\cos x + i\\sin x\n$$\n\n\u6839\u636e\u6211\u4eec~~\u5c0f\u5b66\u4e8c\u5e74\u7ea7~~\u5b66\u4e60\u7684\u4e09\u89d2\u51fd\u6570\u8bf1\u5bfc\u516c\u5f0f\u53ef\u4ee5\u5f97\u51fa\uff1a\n\n$$\ne^{-ix}=\\cos x - i\\sin x\n$$\n\n\u90a3\u4e48\u76f4\u63a5\u52a0\u51cf\u6d88\u5143\u5c31\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$\n\\begin{aligned}\n\\cos x&=\\dfrac{e^{ix}+e^{-ix}}{2}\\\\\n\\sin x&=\\dfrac{e^{ix}-e^{-ix}}{2i}\n\\end{aligned}\n$$\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u4e86\u3002$i$ \u7684\u503c\u5728 $\\bmod 998244353$ \u4e0b\u53ef\u4ee5\u7b49\u4e8e $86583718$ \u6216\u8005 $911660635$\uff0c\u7136\u540e\u5c31\u505a\u5b8c\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\lg n)$\u3002\n\n## Code\n\n\u8fd9\u91cc\u53ea\u7ed9\u51fa\u5173\u952e\u4ee3\u7801\u7684\u5b9e\u73b0\u65b9\u5f0f\u3002\n\n```cpp\nconst int I = 911660635;//\u6216\u8005 86583718 \u4e5f\u53ef\u4ee5\n\npoly COS(poly F) {//\u8fd9\u91cc poly \u662f\u4e00\u4e2a vector<int>\n    int n = F.size();\n    FOR(i, 0, n - 1) F[i] = F[i] * I % mod;\n    poly G = EXP(F), H = INV(G); int inv = (mod + 1) >> 1;\n    FOR(i, 0, n - 1) F[i] = inv * (G[i] + H[i]) % mod;\n    return F;\n}\n\npoly SIN(poly F) {\n    int n = F.size();\n    FOR(i, 0, n - 1) F[i] = F[i] * I % mod;\n    poly G = EXP(F), H = INV(G); int inv = ksm(2 * I % mod, mod - 2);\n    FOR(i, 0, n - 1) F[i] = inv * (G[i] - H[i] + mod) % mod;\n    return F;\n}\n```\n\n\n\n## \u53c2\u8003\u8d44\u6599\n\n[\u6211\u7684\u535a\u5ba2](https://www.luogu.com.cn/blog/juruo-4721/yi-suo-bei-wang).\n\n",
        "postTime": 1633174472,
        "uid": 366935,
        "name": "KAMIYA_KINA",
        "ccfLevel": 7,
        "title": "P5264 \u591a\u9879\u5f0f\u4e09\u89d2\u51fd\u6570 \u9898\u89e3"
    },
    {
        "content": "## $\\mathtt{Description}$\n\n\u7ed9\u5b9a $\\deg = n$ \u7684\u591a\u9879\u5f0f $f$ \u548c $\\text{type}$\uff0c\u6c42\u4e00\u4e2a\u591a\u9879\u5f0f $g$ \u4f7f\u5f97\n\n$$\ng\\equiv \\sin f \\pmod {998244353}\\quad(\\text{type}=0)\n$$\n$$\ng\\equiv \\cos f \\pmod {998244353}\\quad(\\text{type}=1)\n$$\n\n$\\mathtt{restrictions:}1\\leq n \\le10^5,a_i\\in[0,998244353)\\cap \\mathbb{N}$\n\n## $\\mathtt{Solution}$\n\n\u5947\u602a\u7684\u591a\u9879\u5f0f\u6a21\u677f\u589e\u52a0\u4e86\uff01\n\n### $\\mathtt{Pre\\;Knowledge}$\n\n- \u591a\u9879\u5f0f $\\exp$\n- \u6b27\u62c9\u516c\u5f0f\n\n### $\\mathtt{Main\\;Body}$\n\n\u6211\u4eec\u77e5\u9053\u6b27\u62c9\u516c\u5f0f \n$$\ne^{ix} = \\cos x+ i\\sin x\n$$\n\n\u6709\n$$\ne^{-ix} = \\cos x -i\\sin x\n$$\n\n\u6545\n$$\n\\cos x=\\dfrac {e^{ix}+e^{-ix}} {2}\n$$\n$$\n\\sin x = \\dfrac{e^{ix}-e^{-ix}}{2i}\n$$\n\u53c8\u6709\n\n$$i\\equiv86583718\\pmod{998244353}$$\n\u6240\u4ee5\u53ea\u9700\u8981\u4e00\u4e2a\u591a\u9879\u5f0f $\\exp$ \u5c31\u53ef\u4ee5\u4e86\u3002\n## $\\mathtt{Code}$\n\n```cpp\n  inline auto Cos(vector <int> f) {\n    const int len = f.size() ;\n    for (int i = 0; i < len; ++i) f[i] = 1ll * f[i] * I % mod ;\n    auto g = Exp(f),h = Inv(g) ;\n    for (int i = 0; i < len; ++i) g[i] = 1ll * I2 * (g[i] + h[i]) % mod ;\n    return g ;  \n  }\n\n  inline auto Sin(vector <int> f) {\n    const int len = f.size() ;\n    for (int i = 0; i < len; ++i) f[i] = 1ll * f[i] * I % mod ;\n    auto g = Exp(f),h = Inv(g) ;\n    const int x = ksm(I << 1) ;\n    for (int i = 0; i < len; ++i) g[i] = 1ll * x * (g[i] - h[i] + mod) % mod ;\n    return g ;\n  }\n```",
        "postTime": 1624788229,
        "uid": 413147,
        "name": "_Alejandro_",
        "ccfLevel": 0,
        "title": "P5264 \u9898\u89e3"
    },
    {
        "content": "[\u53ef\u80fd\u66f4\u597d\u7684\u4f53\u9a8c](https://www.luogu.com.cn/blog/happydef-blog/duo-xiang-shi-quan-jia-tong-xue-xi-bi-ji)\n\n~~\u8fd9\u9898\u548b\u4e0d\u662f\u6a21\u677f\u3002~~\n\n\u524d\u7f6e\u829d\u58eb\uff1a\u591a\u9879\u5f0f$\\exp$\uff0c\u591a\u9879\u5f0f\u6c42\u9006\u3002\n\n\u6211\u4eec\u6709\n\n$$\\begin{cases}e^{ix}=\\cos x+i\\sin x\\\\e^{-ix}=\\cos x-i\\sin x \\end{cases}$$\n\n\u89e3\u5f97\n$$\\begin{cases}\\cos x=\\frac{e^{ix}+e^{-ix}}{2}\\\\\\sin x=\\frac{e^{ix}-e^{-ix}}{2i} \\end{cases}$$\n\u4f46\u662f\u6709\u4e2a$i$\uff0c\u600e\u4e48\u529e\uff1f\n\n\u6ca1\u5173\u7cfb\uff0c\u6ce8\u610f\u5230\n$$\\left(\\frac{-1}{P}\\right)=(-1)^\\frac{P-1}{2}=1$$\n\u6240\u4ee5\u5b58\u5728$i_0\\in \\mathbb Z_P$\uff0c\u4f7f\u5f97$i_0^2\\equiv -1\\pmod P$\uff0c\u7528\u8fd9\u4e2a\u66ff\u4ee3$i$\u3002\n\n\u6bd4\u5982\u5bf9\u4e8e\u672c\u9898\u6765\u8bf4\uff0c\u53ef\u4ee5\u53d6$i_0=86583718$\n\n\u4e8e\u662f\n$$\\begin{cases}\\cos F=\\frac{e^{i_0F}+e^{-i_0F}}{2}\\\\\\sin F=\\frac{e^{i_0F}-e^{-i_0F}}{2i_0} \\end{cases}$$\n\nover\u3002\n\n\u603b\u590d\u6742\u5ea6$O(n\\log n)$\u3002\n\nQ\uff1a\u5982\u679c $P$ \u4e0d\u662f\u56fa\u5b9a\u7684\u600e\u4e48\u505a\uff1f\n\nA\uff1a\u66b4\u529b\u679a\u4e3e $i$ \u5373\u53ef\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u7528Cipolla\u7b97\u6cd5\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\nvoid sin(ll*f,ll*g,ll len){\n   for(ll i=0;i<len;i++)x[i]=img*f[i]%P;\n   getexp(x,X,len),getinv(X,Y,len);\n   for(ll i=0;i<len;i++)g[i]=(X[i]-Y[i]+P)%P*qpow(img<<1,P-2)%P;\n   clear(x),clear(X),clear(Y);\n}\nvoid cos(ll*f,ll*g,ll len){\n   for(ll i=0;i<len;i++)x[i]=img*f[i]%P;\n   getexp(x,X,len),getinv(X,Y,len);\n   for(ll i=0;i<len;i++)g[i]=(X[i]+Y[i])%P*inv[2]%P;\n   clear(x),clear(X),clear(Y);\n} \n```\n\u5b8c\u6574\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll; \nconst ll N=100005*3;\nll n,tp,f[N],g[N];\nnamespace Poly{\n\tconst ll P=998244353,G=3,img=86583718;\n\tll lmt,rev[N],a[N],b[N],c[N],d[N],e[N],x[N],y[N],X[N],Y[N];\n\tinline ll qpow(ll a,ll k){\n\t\tll ret=1;\n\t\twhile(k){\n\t\t\tif(k&1)ret=ret*a%P;\n\t\t\ta=(a*a)%P;\n\t\t\tk>>=1;\n\t\t}\n\t\treturn ret%P;\n\t}\n\tinline void init(ll n){\n\t\tlmt=1;ll t=0;\n\t\twhile(lmt<n)lmt<<=1,t++;\n\t\tfor(ll i=1;i<lmt;i++)rev[i]=(rev[i>>1]>>1)|(i&1)<<(t-1);\n\t}\n\tinline void NTT(ll *A,ll lmt,ll tp){\n\t\tfor(ll i=0;i<lmt;i++)if(i<rev[i])swap(A[i],A[rev[i]]);\n\t\tfor(ll m=1;m<lmt;m<<=1)\n\t\t\tfor(ll j=0,Wn=qpow(G,(P-1)/(m<<1));j<lmt;j+=m<<1)\n\t\t\t\tfor(ll k=0,w=1,x,y;k<m;k++,w=w*Wn%P)\n\t\t\t\t\tx=A[j+k],y=w*A[j+k+m]%P,A[j+k]=(x+y)%P,A[j+k+m]=(x-y+P)%P;\n\t\tif(tp==1)return;\n\t\treverse(A+1,A+lmt);\n\t\tfor(ll i=0,inv=qpow(lmt,P-2);i<=lmt;i++)A[i]=A[i]*inv%P;\n\t} \n\tvoid getinv(ll*f,ll*g,ll len){\n\t\tif(len==1){g[0]=qpow(f[0],P-2);return;}\n\t\tgetinv(f,g,len+1>>1);\n\t\tinit(len<<1);\n\t\tfor(ll i=0;i<len;i++)c[i]=f[i];\n\t\tfor(ll i=len;i<lmt;i++)c[i]=0;\n\t\tNTT(c,lmt,1),NTT(g,lmt,1);\n\t\tfor(ll i=0;i<lmt;i++)g[i]=(2LL-g[i]*c[i]%P+P)%P*g[i]%P;\n\t\tNTT(g,lmt,-1);\n\t\tfor(ll i=len;i<lmt;i++)g[i]=0; \n\t}\n\tvoid getdev(ll*f,ll*g,ll len){\n\t\tfor(ll i=1;i<len;i++)g[i-1]=i*f[i]%P;\n\t\tg[len-1]=0;\n\t}\n\tvoid getinvdev(ll*f,ll*g,ll len){\n\t\tfor(ll i=1;i<len;i++)g[i]=f[i-1]*qpow(i,P-2)%P;\n\t\tg[0]=0;\n\t}\n\tvoid getln(ll*f,ll*g,ll len){\n\t\tmemset(a,0,sizeof(a));\n\t\tmemset(b,0,sizeof(b));\n\t\tgetdev(f,a,len);\n\t\tgetinv(f,b,len);\n\t\tinit(len<<1);\n\t\tNTT(a,lmt,1),NTT(b,lmt,1);\n\t\tfor(ll i=0;i<lmt;i++)a[i]=a[i]*b[i]%P;\n\t\tNTT(a,lmt,-1);\n\t\tgetinvdev(a,g,len);\n\t}\n\tvoid getexp(ll*f,ll*g,ll len){\n\t\tif(len==1){g[0]=1;return;}\n\t\tgetexp(f,g,len+1>>1);\n\t\tinit(len<<1);\n\t\tfor(ll i=0;i<(len<<1);i++)d[i]=e[i]=0;\n\t\tgetln(g,d,len);\n\t\tfor(ll i=0;i<len;i++)e[i]=f[i];\n\t    NTT(g,lmt,1),NTT(d,lmt,1),NTT(e,lmt,1);\n    \tfor(ll i=0;i<lmt;i++)g[i]=(1-d[i]+e[i]+P)*g[i]%P;\n    \tNTT(g,lmt,-1);\n    \tfor(ll i=len;i<lmt;i++)g[i]=0; \n\t}\n\tvoid sin(ll*f,ll*g,ll len){\n\t\tfor(ll i=0;i<len;i++)x[i]=img*f[i]%P;\n\t\tgetexp(x,X,len),getinv(X,Y,len);\n\t\tfor(ll i=0,inv=qpow(img<<1,P-2);i<len;i++)g[i]=(X[i]-Y[i]+P)%P*inv%P;\n\t}\n\tvoid cos(ll*f,ll*g,ll len){\n\t\tfor(ll i=0;i<len;i++)x[i]=img*f[i]%P;\n\t\tgetexp(x,X,len),getinv(X,Y,len);\n\t\tfor(ll i=0,inv=qpow(2,P-2);i<n;i++)g[i]=(X[i]+Y[i])%P*inv%P;\n\t} \n}\nusing Poly::sin;\nusing Poly::cos;\nint main(){\n\tscanf(\"%lld%lld\",&n,&tp);\n\tfor(ll i=0;i<n;i++)scanf(\"%lld\",&f[i]);\n\tif(tp==0)sin(f,g,n);\n\telse cos(f,g,n);\n\tfor(ll i=0;i<n;i++)printf(\"%lld \",g[i]);\n\treturn 0;\n}\n```",
        "postTime": 1595173124,
        "uid": 121027,
        "name": "Spasmodic",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5264 \u3010\u591a\u9879\u5f0f\u4e09\u89d2\u51fd\u6570\u3011"
    },
    {
        "content": "~~\u8fd9\u53ef\u80fd\u662f\u6211\u89c1\u8fc7\u6700\u6c34\u7684\u591a\u9879\u5f0f\u9898\u4e86QAQ~~\n\n\u9996\u5148\u6211\u4eec\u6709\u6b27\u62c9\u516c\u5f0f\uff1a\n$$ e^{ix} = \\cos(x) + i\\sin(x) $$\n\u53d8\u4e00\u4e0b\uff0c\u628a$ i $\u53d8\u6210$ -i $\uff1a\n$$ e^{-ix} = \\cos(x) - i\\sin(x) $$\n\u76f8\u52a0&\u76f8\u51cf\u5f97\uff1a\n$$ e^{ix} + e^{-ix} = 2\\cos(x) $$\n$$ e^{ix} - e^{-ix} = 2i\\sin(x) $$\n\u79fb\u9879\uff1a\n$$ \\sin(x) = \\frac {e^{ix} - e^{-ix}} {2i} $$\n$$ \\cos(x) = \\frac {e^{ix} + e^{-ix}} {2} $$\n\u6069\u7136\u540e\u6211\u4eec\u5c31\u80fd\u5199\u51fa\u4ee3\u7801\u4e86QAQ\uff1a\n```cpp\n#include<cstring>\n#include<cstdio>\n#define clr(f,len) memset(f,0,(len)<<3)\n#define cpy(f,g,len) memcpy(f,g,(len)<<3)\ntypedef long long ll;\nconst ll mod=998244353ll,M=5e5+5;\nll n,m,flag,G=3,invG=332748118ll,f[M],inv[M];\nvoid swap(ll&a,ll&b){\n\ta^=b^=a^=b;\n}\nll pow(ll a,ll b=mod-2){\n\tll ans=1;for(;b;b>>=1,a=a*a%mod)if(b&1)ans=ans*a%mod;\n\treturn ans;\n}\nvoid px(ll*f,ll*g,int len){\n\tfor(int i=0;i<len;++i)f[i]=f[i]*g[i]%mod;\n}\nvoid dao(ll*f,int n){\n\tfor(int i=1;i<n;++i)f[i-1]=f[i]*i%mod;\n\tf[n-1]=0;\n}\nvoid jifen(ll*f,int n){\n\tfor(int i=n;i;--i)f[i]=f[i-1]*inv[i]%mod;\n\tf[0]=0;\n}\nvoid NTT(ll*f,bool flag,int n){\n\tstatic int fl,t[M];\n\tint i,k,p,len;ll w,w1;\n\tif(n!=fl){\n\t\tfor(i=0;i<n;++i)t[i]=t[i>>1]>>1|(i&1?n>>1:0);\n\t\tfl=n;\n\t}\n\tfor(i=0;i<n;++i)if(i<t[i])swap(f[i],f[t[i]]);\n\tfor(p=2;p<=n;p<<=1){\n\t\tlen=p>>1;w1=pow(flag?G:invG,(mod-1)/p);\n\t\tfor(k=0;k<n;k+=p){\n\t\t\tw=1;\n\t\t\tfor(i=k;i<k+len;++i){\n\t\t\t\tll t=f[i+len]*w%mod;\n\t\t\t\tif((f[i+len]=f[i]-t)<0)f[i+len]+=mod;\n\t\t\t\tif((f[i]=f[i]+t)>mod)f[i]-=mod;\n\t\t\t\tw=w*w1%mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(flag)return;\n\tll invn=pow(n);\n\tfor(i=0;i<n;++i)f[i]=f[i]*invn%mod;\n}\nvoid times(ll* f, ll* g, int l1, int l2) {\n    static ll sav[M];\n    int n;\n    for(n=1;n<=(l1+l2);n<<=1);\n    cpy(sav,g, l2);clr(f+l1,n-l1);clr(sav+l2,n-l2);\n    NTT(f,1,n);NTT(sav,1,n);\n    px(f,sav,n);NTT(f,0,n);\n\tclr(sav,n);\n}\nvoid invp(ll*f,int m){\n\tstatic ll b1[M],b2[M],b3[M];\n\tint i,n,len;\n\tfor(n=1;n<m;n<<=1);b1[0]=pow(f[0]);\n\tfor(len=2;len<=n;len<<=1){\n\t\tfor(i=0;i<(len>>1);++i)b3[i]=(b1[i]<<1)%mod;\n\t\tcpy(b2,f,len);\n\t\tNTT(b1,1,len<<1);px(b1,b1,len<<1);\n\t\tNTT(b2,1,len<<1);px(b1,b2,len<<1);\n\t\tNTT(b1,0,len<<1);clr(b1+len,len);\n\t\tfor(i=0;i<len;++i)b1[i]=(b3[i]-b1[i]+mod)%mod;\n\t}\n\tcpy(f,b1,m);clr(b1,n+n);clr(b2,n+n);clr(b3,n+n);\n}\nvoid lnp(ll*f,int m){\n\tstatic ll g[M];int n;\n\tfor(n=1;n<m;n<<=1);\n\tcpy(g,f,m);\n\tinvp(g,m);dao(f,m);\n\tNTT(f,1,n<<1);NTT(g,1,n<<1);\n\tpx(f,g,n<<1);NTT(f,0,n<<1);\n\tjifen(f,m-1);\n\tclr(g,n+n);\n}\nvoid exp(ll*f,int m){\n\tstatic ll b1[M],b2[M];int n,i,len;\n\tfor(n=1;n<m;n<<=1);b1[0]=1;\n\tfor(len=2;len<=n;len<<=1){\n\t\tcpy(b2,b1,len>>1);clr(b2+len/2,len/2);lnp(b2,len);\n\t\tfor(i=0;i<len;++i)b2[i]=(f[i]-b2[i]+mod)%mod;\n\t\tb2[0]=(b2[0]+1)%mod;\n\t\ttimes(b1,b2,len/2,len);\n\t}\n\tcpy(f,b1,m);clr(b1,n+n);clr(b2,n+n);\n}\nvoid sinp(ll*f,int m){\n    static ll buf[M];\n    int i;\n    ll I=pow(G,mod-1>>2),inv2I=pow(I*2);\n    for(i=0;i<m;++i){\n        f[i]=f[i]*I%mod;\n        buf[i]=mod-f[i];\n    }\n    exp(f,m);exp(buf,m);\n    for(i=0;i<m;++i)f[i]=(f[i]-buf[i]+mod)%mod*inv2I%mod;\n    clr(buf,m);\n}\nvoid cosp(ll*f,int m){\n    static ll buf[M];\n    int i;\n    ll I=pow(G,mod-1>>2),inv2=pow(2);\n    for(i=0;i<m;++i){\n        f[i]=f[i]*I%mod;\n        buf[i]=mod-f[i];\n    }\n    exp(f,m);exp(buf,m);\n    for(i=0;i<m;++i)f[i]=(f[i]+buf[i])%mod*inv2%mod;\n    clr(buf,m);\n}\nsigned main(){\n    int i;inv[1]=1;\n    scanf(\"%d%d\",&n,&flag);\n    for(i=2;i<=n;++i)inv[i]=(mod-mod/i)*inv[mod%i]%mod;\n    for(i=0;i<n;++i)scanf(\"%lld\",f+i);\n    if(flag==0)sinp(f,n);\n    if(flag==1)cosp(f,n);\n    for(i=0;i<n;++i)printf(\"%lld \",f[i]);\n}\n```",
        "postTime": 1595766121,
        "uid": 160839,
        "name": "Prean",
        "ccfLevel": 7,
        "title": "\u6570\u8bba \u591a\u9879\u5f0f P5264\u9898\u89e3"
    }
]
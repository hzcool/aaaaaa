[
    {
        "content": "\u7ed9\u6811\u5f62DP\u306e\u521d\u5b66\u8005(\u5176\u5b9e\u5c31\u662f\u6211\u54c8\u54c8(\u0e51\u2022\u0300\u3142\u2022\u0301)\u0648\u2727)\n\n\n\u5176\u5b9e\u8fd9\u4e2a\u9898\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u662f\u63d0\u9ad8+/\u7701\u9009-\n\n\u8fd8\u662f\u6bd4\u8f83\u7b80\u5355\u7684\n\n\u7784\u4e00\u773c\u4e0b\u53bb\u5c31\u662fDP\n\n\u4f46\u662f\u600e\u4e48DP\u5462?\n\n\u53ef\u4ee5\u53d1\u73b0\u5b66\u4e60\u8bfe\u7a0b\u662f\u6709\u987a\u5e8f\u7684\n\n\u6211\u9a6c\u4e0a\u60f3\u5230\u4e86DAG\n\n\u7136\u540e\u53c8\u53d1\u73b0\u6bcf\u95e8\u8bfe\u6709\u6700\u591a\u6709\u4e00\u4e2a\u5148\u4fee\u8bfe\n\n\u6240\u4ee5\u8fd9\u4e00\u5b9a\u662f\u4e00\u4e2a\u68ee\u6797\n\n\u4e3a\u4e86\u65b9\u4fbf\u5904\u7406\u4e5f\u662f\u4e3a\u4e86\u8fce\u5408\u8f93\u5165\u6570\u636e\n\n\u5c31\u628a0\u53f7\u8282\u70b9\u770b\u505a\u6839\u8282\u70b9\u5373\u53ef\n\n\u8fd9\u6837\u5b9e\u8d28\u4e0a\u5c31\u4ec0\u4e48\u4e5f\u4e0d\u7528\u5904\u7406\n\n\u53ea\u9700\u8981\u5728\u8003\u8651\u7684\u65f6\u5019\n\n\u628a0\u53f7\u8282\u70b9\u5217\u5165\u5fc5\u9009\u7684\u8303\u56f4\u5373\u53ef\n\n\u5373\u8981\u9009m+1\u95e8\u8bfe\n\n\n(\u6211\u770b\u697c\u4e0b\u8fd9\u4e9b\u95ee\u9898\u90fd\u6709\u8bb2,\u4f46\u662f\u552f\u72ec\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u662f\u600e\u4e48\u63a8\u51fa\u6765\u7684\u6ca1\u6709\u8bb2,\u53ef\u80fd\u662f\u89c9\u5f97\u592a\u7b80\u5355\u4e86\u5427.\u4f46\u662fDP\u6700\u6838\u5fc3\u7684\u90e8\u5206\u5c31\u662f\u63a8\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u554a,\u800c\u4e14\u8fd9\u6070\u6070\u662f\u65b0\u624b\u6700\u6b20\u7f3a\u7684\u5730\u65b9,\u6211\u89c9\u5f97\u6765\u770b\u9898\u89e3\u7684\u4eba\u90fd\u662f\u6765\u770b\u8fd9\u4e2a\u7684\u5427(\u5212\u6389))\n\n\n\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\u4e4b\u540e\n\n\u6211\u4eec\u5c31\u8003\u8651\u600e\u4e48\u5728\u6811\u4e0aDP\u5c31\u884c\u4e86\n\nDP\u7684\u6838\u5fc3\u662f\u72b6\u6001\u7684\u8bbe\u8ba1\u548c\u91cd\u53e0\u7684\u5b50\u95ee\u9898\u7ed3\u6784\n\n\u6211\u4eec\u53d1\u73b0\n\n\u6811\u672c\u8eab\u5c31\u662f\u4e00\u4e2a\u9012\u5f52\u7684\u7ed3\u6784\n\n\u6240\u4ee5\u8003\u8651\u5728\u6bcf\u68f5\u5b50\u6811\u4e0aDP\n\n\u7136\u540e\u5408\u5e76\u5c31\u884c\u4e86\n\n\n\u600e\u4e48\u5728\u5b50\u6811\u4e0aDP\u5450(\u3180\u02d8\uff65\u0437\uff65\u02d8)?\n\n\u56e0\u4e3aDP\u7684\u4e00\u4e2a\u6838\u5fc3\u601d\u60f3\u662f**\u4ece\u6700\u7b80\u5355\u7684\u5b50\u95ee\u9898\u5f00\u59cb,\u9010\u6b65\u6269\u5927\u5b50\u95ee\u9898\u89c4\u6a21**\n\n\u6240\u4ee5\u6211\u4eec\u5f53\u7136\u8981\u4ece\u6700\u7b80\u5355\u7684\u72b6\u6001\u8bb2\u8d77\n\n\u4e00\u68f5\u5b50\u6811\u6700\u7b80\u5355\u7684\u72b6\u6001\u662f\u5565?\n\n\u5bf9\u4e00\u68f5\u5b50\u6811,\u8981\u60f3\u9009\u5176\u4e2d\u7684\u70b9,\u6839\u8282\u70b9\u662f\u5fc5\u987b\u9009\u7684\n\n\u6240\u4ee5\u4e0d\u59a8\u8bbe\u6839\u8282\u70b9\u4e3a1\u53f7\u8282\u70b9\n\n\u7136\u540e\u6309\u6211\u4eec\u5b58\u56fe\u7684\u987a\u5e8f\u4f9d\u6b21\u7ed9\u6bcf\u4e2a\u513f\u5b50\u7f16\u53f7(\u4ece2(\u5230\u513f\u5b50\u7684\u4e2a\u6570+1))\n\n\u8fd9\u6837\u72b6\u6001\u5c31\u597d\u8bbe\u8ba1\u4e86\n\n\u4e0d\u59a8\u8bbef[now][j][k]\u8868\u793a\u4ee5now\u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\n\n\u8003\u8651**\u524dj\u4e2a\u8282\u70b9**\u9009k\u95e8\u8bfe\u7684\u65b9\u6848\u6570\n\n\u56e0\u4e3a1\u53f7\u8282\u70b9\u662f\u6839\u8282\u70b9,\u663e\u7136\u9012\u63a8\u8d77\u70b9f[now][1][1]=val[now]\n\n\u8fd9\u6837\u5f88\u5bb9\u6613\u5f97\u5230\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\n\nf[now][j][k]=max(f[now][j-1][k],f[son][\u6240\u6709\u8282\u70b9\u6570][l]+f[now][j-1][k-l]);\n\n\n\u7136\u540e\u6211\u4eec\u89c2\u5bdf\u7b49\u5f0f\u4e24\u8fb9\u7684\u7279\u70b9\n\n**\u54ea\u4e9b\u662f\u6211\u4eec\u5df2\u77e5\u7684?**\n\n\u5728\u5bf9now\u6c42\u89e3\u524d\n\n\u6211\u4eec\u81f3\u5c11\u5df2\u7ecf\u5904\u7406\u5b8c\u4e86\u524d\u9762\u7684\u5b50\u6811\n\n\u6240\u4ee5f[son][\u6240\u6709\u8282\u70b9\u6570][l]\n\n\u662f\u53ef\u4ee5\u76f4\u63a5\u7528\u7684\n\n\u7136\u540e\n\u5728\u5904\u7406\u7b2cj\u4e2a\u8282\u70b9\u524d\n\n\u524dj-1\u4e2a\u8282\u70b9\u662f\u6211\u4eec\u5df2\u7ecf\u5904\u7406\u8fc7\u7684\n\n\u6240\u4ee5f[now][j-1][k]\u548cf[now][j-1][k-l]\u4e5f\u4e0d\u7528\u8003\u8651\u5faa\u73af\u987a\u5e8f\u95ee\u9898\n\n\n\u4f46\u662f\u95ee\u9898\u6765\u4e86\n\n\u8fd9\u6837\u5f00\u4e09\u7ef4\u6570\u7ec4\u4e0d\u4f1a\u70b8\u7a7a\u95f4\u5417\n\n\u4e5f\u8bb8\u672c\u9898\u4e0d\u4f1a\n\n\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u5f88\u663e\u7136\u7684\u53d1\u73b0\n\n**\u7a7a\u95f4\u662f\u53ef\u4ee5\u4f18\u5316\u7684**\n\n\u53ea\u8981\u7a0d\u7a0d\u6539\u53d8\u5faa\u73af\u987a\u5e8f\u5373\u53ef\n\n\u6211\u8981\u7528\u5230j-1\u7684\u5185\u5bb9\n\n\u90fd\u662f\u6ee1\u8db3l<k\u7684\n\n\u6240\u4ee5\u5012\u7740\u5faa\u73afk\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u4f7f\u6211\u4eec\u5728\u4e00\u4e2a\u6570\u7ec4\u4e2d\u5f53\u524d\u503c\u548c\u4e0a\u9762\u6211\u4eec\u7528\u5230\u7684\u503c\u5b8c\u5168\u4e0d\u5f71\u54cd\n\n\u5c31\u9171~\n\n\u6700\u540e\u7684\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5728\u4ee3\u7801\u91cc\n\n\n\n\u4ee3\u7801:\n\n\n\n\n\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#define maxn 1000\nusing namespace std;\nint n,m,f[maxn][maxn],head[maxn],cnt;\nstruct edge\n{\n    int to,pre; \n}e[maxn];\ninline int in()\n{\n    char a=getchar();\n    while(a<'0'||a>'9')\n    {\n        a=getchar();\n    }\n    int t=0;\n    while(a>='0'&&a<='9')\n    {\n        t=(t<<1)+(t<<3)+a-'0';\n        a=getchar();\n    }\n    return t;\n}\nvoid add(int from,int to)\n{\n    e[++cnt].pre=head[from];\n    e[cnt].to=to;\n    head[from]=cnt;\n}\nvoid dp(int now)\n{\n//    f[now][0]=0;\n    for(int i=head[now];i;i=e[i].pre)\n    {\n        int go=e[i].to;\n        dp(go);\n        for(int j=m+1;j>=1;j--)\n        {\n            for(int k=0;k<j;k++)\n            {\n                f[now][j]=max(f[now][j],f[go][k]+f[now][j-k]);\n            }\n        }\n    }\n}\nint main()\n{\n    n=in(),m=in();\n    for(int i=1;i<=n;i++)\n    {\n        int fa=in();\n        f[i][1]=in();\n        add(fa,i);\n    }\n    dp(0);\n    printf(\"%d\\n\",f[0][m+1]);\n    return 0;\n}\n```",
        "postTime": 1506255163,
        "uid": 38269,
        "name": "HullEssien",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.org/problemnew/show/P2014)\n\n\u9996\u884c\u6c42\u8d5e\uff0c\u53cd\u6b63\u4e0dFA\u94b1$\\ \\text{qwq}$\n\n## 0. \u524d\u7f6e\n\n- \u52a8\u6001\u89c4\u5212\u57fa\u7840\n- \u77e5\u9053\u6811\u662f\u4ec0\u4e48\uff0c\u4ee5\u53ca\u5b58\u56fe\u65b9\u5f0f\n\n## 1. \u9898\u610f\u7b80\u8ff0\n\n- \u4e00\u5806\u6811\u6784\u6210\u7684\u68ee\u6797\uff0c\u5171$N$\u4e2a\u70b9\u3002\n- \u6bcf\u4e2a\u70b9\u6709\u4e00\u4e2a\u6743\u503c$s_i$\n- \u4e00\u4e2a\u70b9\u53ef\u4ee5\u88ab\u9009\u62e9\uff0c\u5f53\u4e14\u4ec5\u5f53\u5b83\u5230\u6839\u8282\u70b9\u7684\u8def\u5f84\u4e0a\u7684**\u6240\u6709\u70b9**\u90fd\u88ab\u9009\u62e9\u3002\n\n\u5171\u9009\u62e9$M$\u4e2a\u70b9\uff0c\u6c42\u88ab\u9009\u62e9\u7684\u70b9\u7684\u6743\u503c\u548c\u7684\u6700\u5927\u503c\n\n## 2. \u4e00\u4e2a\u5c0f\u6280\u5de7\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c0\u7b97\u4e00\u4e2a\u8282\u70b9\u7684\u8bdd\uff0c\u6574\u5f20\u56fe\u5c31\u662f\u4e00\u68f5\u6811\u4e86\n\n\u8fd9\u6837\u7684\u597d\u5904\uff1a\n\n1. \u4e00\u68f5\u6811\u5c31\u4e0d\u7528\u5206\u522b\u8003\u8651\u5404\u68f5\u6811\u7136\u540e\u5408\u5e76\u4e86\n2. \u8f93\u5165\u65b9\u4fbf\u5f88\u591a\uff0c\u4e0d\u7528\u7279\u522b\u5904\u7406$0$\u7684\u60c5\u51b5\n\n\n\u4f46\u662f$M$\u5c31\u4f1a\u53d7\u5f71\u54cd\n\n\u56e0\u4e3a\u6839\u8282\u70b9$0$\u662f\u5fc5\u9009\u7684\uff0c\u6240\u4ee5\u53ea\u8981\u8ba9$M$\u589e\u52a0$1$\u5c31\u597d\u4e86\n\n---\n\n**\u786e\u4fdd\u60a8\u7406\u89e3\u4e86\u4ee5\u4e0a\u5185\u5bb9\u518d\u770b\u4e0b\u9762\u7684\u90e8\u5206\uff0c\u5982\u679c\u4e0d\u7406\u89e3\u53ef\u4ee5\u81ea\u5df1\u753b\u56fe\u4f53\u4f1a**\n\n---\n\n\n## 3. dp\u53ca\u521d\u6b65\u8bbe\u8ba1\u72b6\u6001\n\n\u9996\u5148\uff0c\u4e0d\u96be\u770b\u51fa\uff0c\u7236\u8282\u70b9\u7684\u4fe1\u606f\u53ef\u4ee5\u7531\u5b50\u8282\u70b9\u5408\u5e76\u5f97\u5230\u5e76\u4e14\u4e0d\u4f1a\u5f71\u54cd\u5b50\u8282\u70b9\n\n\u6240\u4ee5\u4f7f\u7528 dp/\u8bb0\u5fc6\u5316\u641c\u7d22 \u5c31\u597d\u4e86$\\ \\text{qwq}$\n\n\u4e0d\u96be\u60f3\u5230\uff0c\u7528$\\text{dp[u][i]}$\u8868\u793a\u4ee5\u8282\u70b9$u$\u4e3a\u6839\u7684\u5b50\u6811 \uff0c\u9009\u62e9$i$\u4e2a\u70b9\u53ef\u4ee5\u83b7\u5f97\u7684\u6700\u5927\u6743\u503c\u548c\n\n\u7136\u540e\u60f3\u5982\u4f55\u8f6c\u79fb\n\n\u3002\u3002\u3002\u597d\u50cf\u9047\u5230\u9ebb\u70e6\u4e86\n\n\u663e\u7136\u5408\u5e76\u5b50\u8282\u70b9\u7684\u4fe1\u606f\u4e00\u5b9a\u80fd\u5f97\u5230\u7236\u8282\u70b9\u7684\u4fe1\u606f\uff0c\u4f46\u4f7f\u7528\u7b80\u5355\u7684\u7b97\u6cd5\u597d\u50cf\u4e0d\u884c\u4e86\n\n~~\u6ca1\u4e8b\u53cd\u6b63\u6570\u636e\u8303\u56f4\u5c0f~~\n\n\u53ef\u4ee5\u8003\u8651dp\u5957dp\uff08\u5f53\u7136\u8fd9\u4e2a\u9898\u7b97\u6bd4\u8f83\u7b80\u5355\u7684\uff09\n\n## 4. \u80cc\u5305\n\n\u7ee7\u7eed\u89c2\u5bdf\uff0c\u53d1\u73b0\u6bcf\u4e2a\u5b50\u8282\u70b9\u90fd\u4f1a\u5360\u7528\u7236\u8282\u70b9$i$\u7684\u4e00\u90e8\u5206\uff0c\u53c8\u6709\u4e00\u4e2a\u8d21\u732e\uff0c\u53ef\u4ee5\u9009\u62e9\u6216\u4e0d\u9009\u62e9\n\n\u91cd\u91cf\u3002\u3002\u3002\u4ef7\u503c\u3002\u3002\u3002\u603b\u91cd\u3002\u3002\u3002\n\n\u8fd9\u4e0d\u662f01\u80cc\u5305\u5417\uff1f\n\n\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\uff0c\u6bcf\u4e2a\u5b50\u8282\u70b9\u7684\u91cd\u91cf\u90fd\u662f\u53d8\u91cf\n\n### \u91cd\u65b0\u8bbe\u8ba1\u72b6\u6001\n\n\u7528$dp[u][i][j]$\u8868\u793a\u8282\u70b9$u$\u7684\u524d$i$\u4e2a\u5b50\u8282\u70b9\uff0c\u9650\u91cd\u4e3a$j$\u80fd\u5f97\u5230\u7684\u6700\u5927\u6743\u503c\u548c\uff08\u4ef7\u503c\u548c\uff09\n\n\u50cf01\u80cc\u5305\u4e00\u6837\u538b\u7f29\u7a7a\u95f4\uff0c\u5f97\u5230\uff1a\n\n```dp[u][j]\u8868\u793a\u8282\u70b9u\uff0c\u9650\u91cdj\u7684\u6700\u5927\u6743\u503c\u548c\uff08\u4ef7\u503c\u548c\uff09```\n\n\u4ee3\u7801\uff1a\n\n```cpp\nfor(int i=head[u]; i; i=e[i].next)//\u904d\u5386\u6240\u6709\u5b50\u8282\u70b9\n\tfor(int j=m, v=e[i].to; j>0; --j)//\u8fd9\u91cc\u548c01\u80cc\u5305\u4e00\u6837\uff0c\u603b\u91cd\u4ece\u5927\u5230\u5c0f\u5faa\u73af\n\t\tfor(int k=0; k<j; ++k)//\u8fd9\u91cc\u662f\u4e0d\u540c\u4e4b\u5904\uff0c\u5b50\u8282\u70b9\u7684\u91cd\u91cf\u9700\u8981\u89c4\u5b9a\n\t\t\tchk_max(dp[u][j], dp[u][j-k]+dp[v][k]);//\u6b64\u51fd\u6570\u662f\u5c06\u524d\u4e00\u4e2a\u53c2\u6570\u8bbe\u4e3a\u4e8c\u8005\u7684\u6700\u5927\u503c\uff08\u60a8\u4e0d\u4f1a\u4e0d\u77e5\u9053\u5427\uff09\uff0c\u4e0d\u660e\u767d\u4e0b\u9762\u6709\u4ee3\u7801\n```\n\n5. code\n\n```cpp\n#include<cstdio>\nconst int MAXN = 300 + 5;\nconst int MAXM = 300 + 5;\n\ninline void chk_max(int &a,int b){ if(a<b) a=b;}\n\n//\u524d\u5411\u661f\u5b58\u56fe\nstruct Edge\n{\n\tint next,to;\n}e[MAXN];\nint head[MAXN],ecnt=0;\ninline void add(int u,int v)\n{\n\t++ecnt;\n\te[ecnt].next=head[u];\n\te[ecnt].to=v;\n\thead[u]=ecnt;\n}\n\nint m;\nint dp[MAXN][MAXM];\n\nvoid solve(int u)\n{\n\tfor(int i=head[u]; i; i=e[i].next)\n\t\tsolve(e[i].to);//\u5148\u5904\u7406\u5b50\u8282\u70b9\n\t\n    //\u80cc\u5305\u90e8\u5206\n\tfor(int i=head[u]; i; i=e[i].next)\n\t\tfor(int j=m, v=e[i].to; j>0; --j)\n\t\t\tfor(int k=0; k<j; ++k)\n\t\t\t\tchk_max(dp[u][j], dp[u][j-k]+dp[v][k]);\n}\n\nint main(void)\n{\n\t\n\tint n;\n\tscanf(\"%d%d\",&n,&m);\n\t++m;//\u4e0a\u6587\u63d0\u5230\u4e86\n\tfor(int i=1; i<=n; ++i)\n\t{\n\t\tint fa;\n\t\tscanf(\"%d%d\",&fa,&dp[i][1]);//\u601d\u8003\uff1a\u4e3a\u4ec0\u4e48\u76f4\u63a5\u7528dp[i][1]\uff1f\n\t\tadd(fa,i);\n\t}\n\t\n\tsolve(0);\n\tprintf(\"%d\",dp[0][m]);\n\treturn 0;\n}\n```\n\n\u672c\u9898\u89e3\u4e3b\u8981\u7528\u4e8e\u7406\u6e05\u81ea\u5df1\u601d\u8def\uff0c\u5982\u679c\u6709\u4e0e\u4ed6\u4eba\u65b9\u6cd5\u91cd\u590d\u4e5f\u4e0d\u8981\u55b7qaq\n\n\u5b9e\u9645\u8fd8\u5199\u4e86\u86ee\u957f\u65f6\u95f4\u7684\u3002\u3002\u3002\u7801\u5b57\u624b\u9178\uff0c\u89c1\u8c05qwq\n\n\u5982\u679c\u60a8\u89c9\u5f97\u9898\u89e3\u6709\u9519\u8bef\uff0c\u53ef\u4ee5\u79c1\u4fe1\u6216\u8005\u8bc4\u8bba\n\n\u5f53\u7136\u522b\u5fd8\u4e86\u70b9\u8d5eqwq",
        "postTime": 1562231500,
        "uid": 73687,
        "name": "He_Ren",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u521d\u5b66\u6811\u5f62$dp$\u7684\u53ef\u4ee5\u6765\u8fd9\u91cc\u7684\u535a\u5ba2\u89c2\u6469\u4e00\u4e0b\n[\u6811\u5f62dp\u5b66\u4e60\u7b14\u8bb0](https://www.cnblogs.com/ifmyt/p/9588872.html)\n\n>\u4eca\u5929\u5b66\u4e60\u4e86\u6811\u5f62$dp$\uff0c\u4e00\u5f00\u59cb\u6d4f\u89c8\u5404\u5927$blog$\uff0c\u53d1\u73b0\u90fd$TM$\u662f\u9898\uff0c\u8fde\u4e2a\u5165\u95e8\u7684$blog$\u90fd\u6ca1\u6709\uff0c\u4f53\u9a8c\u6781\u5dee\u3002\u6240\u4ee5\u6211\u7acb\u5fd7\u8981\u5199\u4e00\u7bc7\u53ef\u4ee5\u8ba9\u521d\u5b66\u6811\u5f62$dp$\u7684\u7ae5\u978b\u5feb\u901f\u5165\u95e8\u3002\n\n# \u6811\u5f62$dp$\n\n## \u6982\u5ff5\u7c7b\n\n\u6811\u5f62$dp$\u662f\u4e00\u79cd\u5f88\u4f18\u7f8e\u7684\u52a8\u6001\u89c4\u5212\uff0c\u771f\u7684\u5f88\u4f18\u7f8e\u771f\u7684\uff0c\u524d\u63d0\u662f\u5728\u4f60\u5b66\u4f1a\u5b83\u4e4b\u540e\u3002\n\n## \u5b9e\u73b0\u5f62\u5f0f\n\n\u6811\u5f62$dp$\u7684\u4e3b\u8981\u5b9e\u73b0\u5f62\u5f0f\u662f$dfs$\uff0c\u5728$dfs$\u4e2d$dp$\uff0c\u4e3b\u8981\u7684\u5b9e\u73b0\u5f62\u5f0f\u662f$dp[i][j][0/1]$\uff0c$i$\u662f\u4ee5$i$\u4e3a\u6839\u7684\u5b50\u6811\uff0c$j$\u662f\u8868\u793a\u5728\u4ee5$i$\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u9009\u62e9$j$\u4e2a\u5b50\u8282\u70b9\uff0c$0$\u8868\u793a\u8fd9\u4e2a\u8282\u70b9\u4e0d\u9009\uff0c$1$\u8868\u793a\u9009\u62e9\u8fd9\u4e2a\u8282\u70b9\u3002\u6709\u7684\u65f6\u5019$j$\u6216$0/1$\u8fd9\u4e00\u7ef4\u53ef\u4ee5\u538b\u6389\n\n## \u57fa\u672c\u7684$dp$\u65b9\u7a0b\n\n### \u9009\u62e9\u8282\u70b9\u7c7b\n$$\\begin{cases}dp[i][0]=dp[j][1]\\\\dp[i][1]=\\max/\\min(dp[j][0],dp[j][1])\\\\\\end{cases}$$\n\n### \u6811\u5f62\u80cc\u5305\u7c7b\n$$\\begin{cases}dp[v][k]=dp[u][k]+val\\\\dp[u][k]=max(dp[u][k],dp[v][k-1])\\\\\\end{cases}$$\n## \u4f8b\u9898\u7c7b\n\n\u4ee5\u4e0a\u5c31\u662f\u5bf9\u6811\u5f62$dp$\u7684\u57fa\u672c\u4ecb\u7ecd\uff0c\u56e0\u4e3a\u6811\u5f62$dp$\u6ca1\u6709\u57fa\u672c\u7684\u5f62\u5f0f\uff0c\u7136\u540e\u5176\u4e5f\u6ca1\u6709\u56fa\u5b9a\u7684\u505a\u6cd5\uff0c\u4e00\u822c\u4e00\u79cd\u9898\u76ee\u6709\u4e00\u79cd\u505a\u6cd5\u3002\n\n### [\u6ca1\u6709\u4e0a\u53f8\u7684\u821e\u4f1a](https://www.luogu.org/problemnew/show/P1352)\n\n\u8fd9\u9053\u9898\u662f\u4e00\u6811\u5f62$dp$\u5165\u95e8\u7ea7\u522b\u7684\u9898\u76ee\uff0c\u5177\u4f53\u65b9\u7a0b\u5c31\u7528\u5230\u4e86\u4e0a\u8ff0\u7684\u9009\u62e9\u65b9\u7a0b\u3002\n```cpp\n#include<cmath>\n#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#define N 6001\nusing namespace std;\nint ind[N],n,hap[N],dp[N][2],fa[N],root,vis[N],ne[N],po[N];\nvoid work(int x)\n{\n    for(int i = po[x]; i; i = ne[i])\n    {\n        work(i);\n        dp[x][1]=max(max(dp[x][1],dp[x][1]+dp[i][0]),dp[i][0]);\n        dp[x][0]=max(max(dp[x][0],dp[i][1]+dp[x][0]),max(dp[i][1],dp [i][0]));\n    }\n}\nint main()\n{\n    cin >> n;\n    for(int i=1; i<=n; i++)\n        cin >> dp[i][1];\n    for(int i=1; i<=n; i++)\n    {\n        int a,b;\n        cin >> b >> a;\n        ind[b]++;\n        ne[b] = po[a];\n        po[a] = b;\n    }\n    for(int i=1; i<=n; i++)\n        if(!ind[i])\n        {\n            root=i;\n            break;\n        }\n    work(root);\n    cout << max(dp[root][0],dp[root][1]);\n}\n```\n### [\u6700\u5927\u5b50\u6811\u548c](https://www.luogu.org/problemnew/show/P1122)\n\n\u8fd9\u9053\u9898\u7684$dp$\u65b9\u7a0b\u6709\u53d8\uff0c\u56e0\u4e3a\u4f60\u7684\u64cd\u4f5c\u662f\u5207\u6389\u8fd9\u4e2a\u70b9\uff0c\u6240\u4ee5\u4f60\u7684\u5b50\u6811\u8981\u4e48\u52a0\u4e0a\u4ef7\u503c\uff0c\u8981\u4e48\u4ef7\u503c\u4e3a$0$\uff0c\u6240\u4ee5$dp$\u65b9\u7a0b\u662f\n$$dp[u]+=max(dp[v],0)$$\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cstring>\n#include<queue>\n\nusing namespace std;\nstruct edge\n{\n    int next,to;\n} e[40000];\nint head[40000],tot,rt,maxn;\nvoid add(int x,int y)\n{\n    e[++tot].next=head[x];\n    head[x]=tot;\n    e[tot].to=y;\n}\nint n,dp[20000],ind[20000];\nint val[20000],f[20000];\nvoid dfs_f__k(int x,int fa)\n{\n    f[x]=fa;\n    for(int i=head[x]; i; i=e[i].next)\n    {\n        int v=e[i].to;\n        if(v!=fa)\n            dfs_f__k(v,x);\n    }\n}\nvoid dfs(int x)\n{\n    dp[x]=val[x];\n    for(int i=head[x]; i; i=e[i].next)\n    {\n        int v=e[i].to;\n        if(v!=f[x])\n        {\n            dfs(v);\n            dp[x]+=max(0,dp[v]);\n        }\n    }\n    maxn=max(maxn,dp[x]);\n}\nint main()\n{\n    scanf(\"%d\",&n);\n    for(int i=1; i<=n; i++)scanf(\"%d\",&val[i]);\n    for(int i=1; i<=n-1; i++)\n    {\n        int a,b;\n        scanf(\"%d%d\",&a,&b);\n        add(a,b);\n        add(b,a);\n    }\n    rt=1;\n    dfs_f__k(rt,0);\n    dfs(rt);\n    printf(\"%d\",maxn);\n}\n```\n### [\u9009\u8bfe](https://www.luogu.org/problemnew/show/P2014)\n\u8fd9\u9053\u9898\u7684\u610f\u601d\u662f\u6bcf\u672c\u4e66\u8981\u60f3\u9009\u62e9\u4e00\u95e8\u8bfe\uff0c\u5fc5\u987b\u8981\u5148\u5b66\u4f1a\u5b83\u7684\u5fc5\u4fee\u8bfe\uff0c\u6240\u4ee5\u8fd9\u5c31\u5f62\u6210\u4e86\u4e00\u79cd\u4f9d\u8d56\u884c\u4e3a\uff0c\u5373\u9009\u62e9\u4e00\u95e8\u8bfe\u5fc5\u987b\u8981\u9009\u62e9\u5fc5\u4fee\u8bfe\u3002\u90a3\u4e48\u4ed6\u53c8\u8bf4\u8981\u9009\u62e9\u7684\u4ef7\u503c\u6700\u5927\uff0c\u8fd9\u5c31\u8981\u7528\u5230\u6811\u5f62\u80cc\u5305\u7684\u77e5\u8bc6\u4e86\u3002\n\u6811\u5f62\u80cc\u5305\u7684\u57fa\u672c\u4ee3\u7801\u5f62\u5f0f\uff08\u5373\u4e0a\u9762\u7684\u6811\u5f62\u80cc\u5305\u7c7b\uff09\n```cpp\n/*\n\u8bbedp[i][j]\u8868\u793a\u9009\u62e9\u4ee5i\u4e3a\u6839\u7684\u5b50\u6811\u4e2dj\u4e2a\u8282\u70b9\u3002\nu\u4ee3\u8868\u5f53\u524d\u6839\u8282\u70b9\uff0ctot\u4ee3\u8868\u5176\u9009\u62e9\u7684\u8282\u70b9\u7684\u603b\u989d\u3002\n*/\nvoid dfs(int u,int tot)\n{\n\tfor(int i=head[x];i;i=e[i].next)\n\t{\n\t\tint v=e[i].to;\n\t\tfor(int k=0;k<tot;k++)//\u8fd9\u91cck\u4eceo\u5f00\u59cb\u5230tot-1\uff0c\u56e0\u4e3av\u7684\u5b50\u6811\u53ef\u4ee5\u9009\u62e9\u7684\u8282\u70b9\u662fu\u7684\u5b50\u6811\u7684\u8282\u70b9\u6570\u51cf\u4e00\n\t\t\tdp[v][k]=dp[u][k]+val[u];\n\t\tdfs(v,tot-1)\n\t\tfor(int k=1;k<=tot;k++)\n\t\t\tdp[u][k]=max(dp[u][k],dp[v][k-1]);//\u8fd9\u91cc\u662f\u628a\u5b50\u6811\u7684\u503c\u8d4b\u7ed9\u4e86\u6839\u8282\u70b9\uff0c\u56e0\u4e3au\u9009\u62e9k\u4e2a\u70b9v\u53ea\u80fd\u9009\u62e9k-1\u4e2a\u70b9\u3002\n\t}\n}\n```\n\u7136\u540e\u8fd9\u5c31\u662f\u6811\u5f62\u80cc\u5305\u7684\u57fa\u672c\u5f62\u5f0f\uff0c\u57fa\u672c\u5c31\u662f\u8fd9\u6837\u505a\n\u4ee3\u7801\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<queue>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\n\nint n,m;\nstruct edge\n{\n    int next,to;\n}e[1000];\nint rt,head[1000],tot,val[1000],dp[1000][1000];\nvoid add(int x,int y)\n{\n    e[++tot].next=head[x];\n    head[x]=tot;\n    e[tot].to=y;\n}\nvoid dfs(int u,int t)\n{\n    if (t<=0) return ;\n    for (int i=head[u]; i; i=e[i].next)\n    {\n        int v = e[i].to;\n        for (int k=0; k<t; ++k) \n            dp[v][k] = dp[u][k]+val[v];\n        dfs(v,t-1);\n        for (int k=1; k<=t; ++k) \n            dp[u][k] = max(dp[u][k],dp[v][k-1]);\n    }\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n;i++)\n    {\n        int a;\n        scanf(\"%d%d\",&a,&val[i]);\n        if(a)\n          add(a,i);\n        if(!a)add(0,i);\n    }\n    dfs(0,m);\n    printf(\"%d\",dp[0][m]);\n}\n```\n### [Strategic game](https://www.luogu.org/problemnew/show/UVA1292)\n\n\u8fd9\u9053\u9898\u7684\u610f\u601d\u662f\u9009\u62e9\u6700\u5c11\u7684\u70b9\u6765\u8986\u76d6\u4e00\u68f5\u6811\uff0c\u53ef\u4ee5\u7528\u6700\u5c0f\u70b9\u8986\u76d6\uff08\u4e5f\u5c31\u662f\u4e8c\u5206\u56fe\u6700\u5927\u5339\u914d\uff09\u6216\u8005\u6811\u5f62$dp$\u6765\u505a\uff0c\u56e0\u4e3a\u8fd9\u91cc\u6211\u4eec\u7684\u4e13\u9898\u662f\u6811\u5f62$dp$\uff0c\u6240\u4ee5\u6211\u4eec\u73b0\u5728\u5c31\u8bb2\u6811\u5f62$dp$\u7684\u505a\u6cd5\u3002\n\u6211\u4eec\u505a\u8fd9\u9053\u9898\u7684\u65b9\u6cd5\u662f\u7528\u9009\u62e9\u65b9\u7a0b\u6765\u505a\uff0c\u56e0\u4e3a\u4f60\u8981\u505a\u6700\u5c0f\u70b9\u8986\u76d6\uff0c\u8981\u4e48\u9009\u8fd9\u4e2a\u70b9\u8981\u4e48\u4e0d\u9009\u5bf9\u5427\u3002\n\u4e8e\u662f$dp$\u7684\u8f6c\u79fb\u65b9\u7a0b\u5c31\u662f\u4e0a\u8ff0\u4e00\u65b9\u7a0b\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<cstring>\n#include<cstdio>\n#include<queue>\nusing namespace std;\nint n;\nstruct edge\n{\n    int next,to;\n} e[4000];\nint head[4000],tot,dp[4000][2],ind[4000];\nvoid add(int x,int y)\n{\n    e[++tot].next=head[x];\n    head[x]=tot;\n    e[tot].to=y;\n}\nvoid dfs(int x)\n{\n    dp[x][1]=1;\n    for(int i=head[x]; i; i=e[i].next)\n    {\n        int v=e[i].to;\n        dfs(v);\n        dp[x][0]+=dp[v][1];\n        dp[x][1]+=min(dp[v][0],dp[v][1]);\n    }\n}\nint main()\n{\n    while(scanf(\"%d\",&n)!=EOF)\n    {\n        memset(dp,0,sizeof(dp));\n        memset(head,0,sizeof(head));\n        memset(ind,0,sizeof(ind));\n        tot=0;\n        for(int j=1; j<=n; j++)\n        {\n            int a,b;\n            scanf(\"%d:(%d)\",&a,&b);\n            for(int i=1; i<=b; i++)\n            {\n                int c;\n                scanf(\"%d\",&c);\n                ind[c]++;\n                add(a,c);\n            }\n        }\n        int rt;\n        for(int i=0; i<=n; i++)\n            if(!ind[i])\n            {\n                rt=i;\n                break;\n            }\n        dfs(rt);\n        printf(\"%d\\n\",min(dp[rt][1],dp[rt][0]));\n    }\n}\n```",
        "postTime": 1536107893,
        "uid": 78228,
        "name": "\u6211\u6ca1\u6709\u5c0f\u767d",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u3010\u9009\u8bfe\u3011\u8fd9\u9053\u9898\u770b\u4e0a\u53bb\u662f\u4e00\u9053\u8fdb\u9636\u7248\u7684\u6811\u5f62DP\uff0c\u56e0\u4e3a\u5176\u4e2d\u5d4c\u5957\u4e86\u4e00\u5b9a\u7684\u80cc\u5305\u7684\u601d\u60f3\n\n\u4ee3\u7801\u6d41\u7a0b\uff1a\u9996\u5148\u5efa\u6811\u5b58\u56fe\uff0c\u8fd9\u91cc\u7684\u5904\u7406\u6709\u4e00\u4e2a\u5c0f\u6280\u5de7\uff0c\u5c31\u662f\u5982\u679c\u6709\u591a\u4e2a\u6839\u7ed3\u70b9\uff0c\u90a3\u4e48\u4e0d\u5bb9\u6613\u8fdb\u884cDFS\uff0c\u6240\u4ee5\u6211\u4eec\u6784\u9020\u51fa\u4e00\u4e2a$0$\u7ed3\u70b9\uff0c\u521a\u597d\uff0c\u8f93\u5165\u65f6\u4e5f\u662f\u7528$0$\u6765\u4ee3\u66ff\u7684\uff0c\u8fd9\u6837\u53ea\u7528\u5728\u6700\u540e\u8f93\u51fa\u65f6\u8c03\u7528$\\mathrm{[m+1]}$\u5373\u53ef\u3002s\u6570\u7ec4\u4ee3\u8868\u8be5\u7ed3\u70b9\u6709\u51e0\u4e2a\u513f\u5b50\uff0c\u4e4b\u540e\u5728DFS\u4e2d\u66f4\u65b0\u4e3a\u540e\u4ee3\u4e2a\u6570\uff0cp\u6570\u7ec4\u4ee3\u8868\u7ed3\u70b9\u7684\u6743\u503c\uff0c\uff08\u56fe\u4e2d\u9ed1\u8272\u6570\u5b57\uff09![\u6837\u4f8b](https://cdn.luogu.com.cn/upload/pic/15192.png)\n\u7136\u540e\u5f00\u59cbDFS\uff0cDFS\u7684\u56de\u6eaf\u662f\u6811\u5f62DP\u7684\u91cd\u70b9\u4ee5\u53ca\u6838\u5fc3\u3002\n\n\u6211\u4eecDFS\u7684\u641c\u7d22\u8fb9\u754c\u662f\u94fe\u8868\u7684\u5c3e\u7aef\uff0c**\u5f53\u56de\u6eaf\u7ed3\u675f\u540e\uff0c$root$\u7684\u5b50\u6811\u5df2\u7ecf\u88ab\u904d\u5386\u5b8c\u5e76\u5904\u7406\u5b8c\u4e86\u3002**\u8fd9\u4fbf\u662f\u6811\u5f62DP\u7684\u6700\u91cd\u8981\u7684\u7279\u70b9\u3002\n\n**\u80cc\u5305**\u8fc7\u7a0b\u4e2d\u5d4c\u5957\u4e86\u4e09\u91cd\u5faa\u73af\uff08\u5b9e\u9645\u52a0\u4e0aDFS\u7684\u662f\u56db\u91cd\uff09\uff0c\n\u9996\u5148$\\mathrm {r=root->next}$\u679a\u4e3e\u4e86$\\mathrm {root}$\u7684\u5b50\u6811 _\u5b50\u6811\u95f4\u4e0d\u4f1a\u4e92\u76f8\u5f71\u54cd\uff0c\u6240\u4ee5\u8fd9\u4e9b\u53ef\u4ee5\u5206\u5f00\u505a\u3002_ \u4f46\u662f$j$\u548c$k$\u7684\u987a\u5e8f\u4e00\u5b9a\u8981\u5206\u597d\uff0c\u56e0\u4e3a\u662f\u76f8\u5f53\u4e8e$01$\u80cc\u5305\uff0c\u6240\u4ee5$k$\u8981\u5012\u5e8f\uff0c$j$\u662f\u7528\u6765\u679a\u4e3e$\\mathrm {r->data}$\u5373\u6b63\u5728\u904d\u5386\u7684\u70b9\u7684\u513f\u5b50\u4e2a\u6570\uff0c\u56e0\u4e3a\u73b0\u5728\u6b63\u5728\u904d\u5386\u7684\u70b9\u5df2\u7ecf\u88abDFS\u8fc7\u4e86\uff08\u8981\u4e0d\u7136\u4e0d\u4f1a\u9000\u5230\u8fd9\u4e2a$x$\u7ed3\u70b9\u7684\uff09\uff0c\u5219\u5b83\u662f\u5f53\u524d\u72b6\u51b5\u7684\u6700\u4f18\u89e3\uff0c\u53ef\u4ee5\u4ece\u90a3\u8fb9\u8f6c\u79fb\u8fc7\u6765\u3002**\u4f46\u662f$k$\u4e00\u5b9a\u8981\u5728$j$\u524d\u9762\uff0c\u56e0\u4e3a\u5f53$k$\u76f8\u540c\u65f6\uff0c\u4e0d\u540c\u7684$j$\u53ef\u80fd\u5b58\u5728\u5305\u542b\u76f8\u540c\u70b9\u7684\u60c5\u51b5\uff0c\u4e3a\u4e86\u907f\u514d\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u9009\u62e9\u628ak\u653e\u5728\u5916\u9762\u3002\u8fd9\u6837$f[x][k]$\u5c31\u4e0d\u4f1a\u91cd\u590d\u66f4\u65b0\u6d89\u53ca\u76f8\u540c\u7684\u70b9\u4e86\u2014\u2014\u4e3e\u4e2a\u6817\u5b50** ![\u6817\u5b50](https://cdn.luogu.com.cn/upload/pic/15194.png)\n\n```cpp\n\u5982\u679ck\u5faa\u73af\u5728j\u91cc\u9762\u7684\u8bdd\uff0c\u5f53\u6211\u4eec\u66f4\u65b0\u5230\u56fe\u4e2d2\u53f7\u7ed3\u70b9\u540e\uff0c1\u53f7\u7ed3\u70b9\u7684f[x][k]\u4f1a\u88ab\u66f4\u65b0\uff0c\n\u5728k++;\u540e\uff0cf[x][k]\u5728\u7b26\u5408\u60c5\u51b5\u65f6\u4f1a\u7ee7\u7eed\u66f4\u65b0\uff0c\u8fd9\u6837\u5c31\u4f1a\u5bfc\u81f4\u7ed3\u679c\u51fa\u9519\uff08\u504f\u5927\uff09\u7684\u60c5\u51b5\u51fa\u73b0\n```\n**\u80cc\u5305\u6838\u5fc3\uff1a**\n\n```cpp\n    while(r!=0)\n    {\n        for(int k=s[x];k>=1;k--)\n            for(int j=1;j<=k;j++)//j\u662f\u679a\u4e3er->data\u7684\u9009\u79d1\u4e2a\u6570\n            //\u5176\u4e2dj<=k\u9632\u6b62\u6570\u7ec4\u8d8a\u754c\n                    f[x][k]=max(f[x][k],f[x][k-j]+f[r->data][j]);\n        r=r->next;//\u94fe\u8868\u7ee7\u7eed\u904d\u5386\n    }\n    for(int i=s[x];i>=0;i--)\n        f[x][i+1]=f[x][i]+p[x];\n```\n\u4e3a\u4ec0\u4e48\u6700\u540e\u4e24\u884c\u8981\u5355\u72ec\u62ff\u51fa\u6765\u505a\u5462\uff1f\n```\nfor(int i=s[x];i>=0;i--)\n        f[x][i+1]=f[x][i]+p[x];\n```\n\u6211\u4eec\u56de\u5230\u9898\u9762\u4e0a\uff0c\u7236\u4eb2\u662f\u513f\u5b50\u7684\u5148\u4fee\u8bfe\uff0c\u6240\u4ee5\u6ca1\u6709\u7236\u4eb2\u65f6\uff0c\u513f\u5b50\u518d\u591a\u4e5f\u6ca1\u6709\u7528\uff0c\u80cc\u5305\u4e2d\u5904\u7406\u7684\u5b50\u6811\u662f\u4e0d\u5e26\u6839\u7ed3\u70b9\u7684\uff0c\u6211\u4eec\u8981\u52a0\u4e0a\uff0c\u5426\u5219\u4f1a\u51fa\u73b0\u4e0b\u9762\u8fd9\u79cd\u72b6\u51b5\uff1a![\u5426\u5219](https://cdn.luogu.com.cn/upload/pic/15195.png)\n\n\u5982\u679c\u5728\u505a\u7684\u8fc7\u7a0b\u4e2d\u5c06\u6839\u7ed3\u70b9\u7b97\u5165\u5b50\u6811\uff0c\u90a3\u4e48$\\mathrm f[1][2]$\u6700\u7ec8\u503c\u5c06\u4f1a\u662f$11$\uff08\u5728\u6b63\u786e\u7684\u8fc7\u7a0b\u4e2d\u4e5f\u662f$11$\uff0c\u4f46\u662f\u4f1a\u88ab\u66f4\u65b0\u5230$f[1][3]$\uff09\uff0c\u4e0d\u505a\u66f4\u65b0\u6216\u518d\u53bb\u505a\u4e00\u904d\u66f4\u65b0\u5c31\u4e0d\u5bf9\u4e86\uff0c\u6838\u5fc3\u601d\u60f3\u7ed3\u675f\u3002\n\n\u6700\u540e\u8f93\u51fa\u7684\u662f$f[0][m+1]$\uff0c\u6240\u4ee5$0$\u8fd9\u4e2a\u201c\u6839\u7ed3\u70b9\u201c\u201d\u662f\u975e\u5e38\u65b9\u4fbf\u7684\u3002\n\n\u603b\u7ed3\uff1a\n1. \u6811\u5f62DP\u8981\u6839\u636e\u5b9e\u9645\u60c5\u51b5\uff0c\u6539\u53d8\u5faa\u73af\u987a\u5e8f\u548c\u65b9\u5411\uff1b\n1. \u8981\u5224\u65ad\u6839\u7ed3\u70b9\u662f\u5426\u5305\u542b\u5728\u5b50\u6811\uff0c\u5e76\u5728\u8fd9\u4e2a\u5224\u65ad\u6700\u7ec8\u7a0d\u52a0\u5904\u7406\n1. \u72b6\u6001\u8981\u4fdd\u5b58\u51c6\u786e\uff0c\u4e0d\u80fd\u4e22\u5931\u8981\u7528\u5230\u7684\u72b6\u6001\n\n------------\n## Code:\n\n```cpp\n#include<cstdio>\n#include<cstring>\nint max(int x,int y){return x>y?x:y;}\nstruct node\n{\n    int data;\n    node *next;\n    node()\n    {\n        next=NULL;\n    }\n};\nnode head[301],*tail[301];//\u7528\u4e8e\u94fe\u8868\nint f[301][301],s[301],n,m,p[301];\nvoid dfs(int x)\n{\n    node *root;\n    root=&head[x];\n    node *r=root->next;\n    while(root->next!=0)\n    {\n        root=root->next;\n        dfs(root->data);\n        s[x]+=s[root->data];\n    }\n    //\u5f00\u59cb\u80cc\u5305\n    while(r!=0)\n    {\n        for(int k=s[x];k>=1;k--)\n            for(int j=1;j<=k;j++)//j\u662f\u679a\u4e3er->data\u7684\u9009\u79d1\u4e2a\u6570\n                    f[x][k]=max(f[x][k],f[x][k-j]+f[r->data][j]);\n        r=r->next;\n    }\n    for(int i=s[x];i>=0;i--)\n        f[x][i+1]=f[x][i]+p[x];\n    return ;\n}\nint main()\n{\n    memset(s,0,sizeof(s));\n    memset(f,0,sizeof(f));\n    int a,b;\n    scanf(\"%d%d\",&n,&m);\n    for(int i=0;i<=n;i++)\n        tail[i]=&head[i];\n    for(int i=1;i<=n;i++)//\u5efa\u6811\u5b58\u56fe\n    {\n        scanf(\"%d%d\",&a,&b);\n        s[a]++;\n        node *t=new node();\n        t->data=i;\n        p[i]=b;\n        tail[a]->next=t;\n        tail[a]=t;\n    }\n    dfs(0);\n    printf(\"%d\\n\",f[0][m+1]);//m+1\u662f\u56e0\u4e3a\u628a0\u5f53\u505a\u4e00\u4e2a\u7ed3\u70b9\uff08\u8bfe\u7a0b\uff09\n    return 0;\n}\n\n```",
        "postTime": 1520163564,
        "uid": 63539,
        "name": "wjyyy",
        "ccfLevel": 9,
        "title": "\u6811\u5f62DP\u4e4b\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u9898\u76ee\u4e2d\u63d0\u5230\u6bcf\u95e8\u8bfe\u7684\u76f4\u63a5\u5148\u4fee\u8bfe\u6700\u591a\u53ea\u6709\u4e00\u95e8\uff0c\u5c06\u6bcf\u95e8\u8bfe\u7684\u5148\u4fee\u8bfe\u4e0e\u5176\u76f8\u8fde\uff0c\u5c06\u4f1a\u6784\u6210\u4e00\u9897\u6216\u8005\u591a\u9897\u6811\u3002\u4e3a\u6b64\u6211\u4eec\u53ef\u4ee5\u5efa\u7acb\u4e00\u4e2a 0 \u53f7\u8282\u70b9\uff0c\u5c06\u6240\u6709\u6811\u7684\u6839\u8282\u70b9\u90fd\u8fde\u5411 0 \u53f7\u8282\u70b9\u30020 \u53f7\u8282\u70b9\u7684\u5b66\u5206\u4e3a 0\uff0c\u5e76\u4e14\u5141\u8bb8\u9009\u4fee\u7684\u8bfe\u6570\u91cf\u8981\u81ea\u52a0\u4e00\u3002\n\n\n\u5c06\u68ee\u6797\u62fc\u63a5\u6210\u4e00\u68f5\u6811\u4e4b\u540e\u6211\u4eec\u5c31\u9700\u8981\u5bf9\u8fd9\u4e00\u9897\u6811\u8fdb\u884c\u6811\u4e0a\u7684\u52a8\u6001\u89c4\u5212\u4e86\u3002\n\n\n\u8003\u8651\u6811\u4e0a\u7684\u6bcf\u4e00\u4e2a\u8282\u70b9\uff1a\u8fd9\u4e2a\u8282\u70b9\u53ef\u80fd\u662f\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u8282\u70b9\u7684\u7236\u8282\u70b9(\u5148\u4fee\u8bfe)\uff0c\u4e5f\u6709\u53ef\u80fd\u6ca1\u6709\u3002\u7528 f[i][j] \u8868\u793a\u5bf9\u4e8e\u8282\u70b9 i \uff0c \u4e00\u5171\u9009\u62e9 j \u95e8\u8bfe\u6240\u80fd\u5f97\u5230\u7684\u6700\u5927\u5b66\u5206(j \u95e8\u79d1\u76ee\u4e2d\u5305\u62ec\u4ed6\u672c\u8eab)\u3002\u9009\u62e9\u4ed6\u7684\u6240\u6709\u5b50\u8282\u70b9\u7684\u524d\u63d0\u662f\u4e00\u5b9a\u8981\u9009\u62e9\u8fd9\u4e2a\u8282\u70b9\uff0c\u6240 f[i][1] \u4e00\u5b9a\u7b49\u4e8e i \u8282\u70b9\u7684\u6743\u503c(\u5b66\u5206)\n\n\n\u6309\u7167\u4e00\u5b9a\u7684\u987a\u5e8f\u904d\u5386 i \u8282\u70b9\u7684\u6240\u6709\u5b50\u8282\u70b9\u3002\u5f53\u904d\u5386\u5230 x \u8282\u70b9\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5047\u8bbe\u5df2\u7ecf\u5f97\u5230\u4e86\u6240\u6709 f[x][k] \u7684\u503c\u3002\u7531\u4e8e f[i][k] \u4e2d\u662f\u6ca1\u6709 x \u8282\u70b9\u53ca\u5176\u5b50\u6811\u7684\u6743\u503c\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u901a\u8fc7 x \u8282\u70b9\u6765\u66f4\u65b0 i \u8282\u70b9\u7684 f \u6570\u7ec4\u3002\u5373 f[i][k] = max(f[i][k], f[i][k - p] + f[x][p]) (1 \u2264 k \u2264 m \uff0c 0 \u2264 p < k)\n\n\np < k \u7684\u539f\u56e0\u662f\u5f53 p = k \u7684\u65f6\u5019 f[i][k - p] \u4e2d k - p \u7684\u503c\u7b49\u4e8e 0\uff0c\u8fd9\u8bf4\u660e i \u8fd9\u4e2a\u8282\u70b9\u65e0\u6cd5\u88ab\u9009\u62e9\u5230\uff0c\u7531\u4e8e i \u662f x \u8282\u70b9\u7684\u5148\u4fee\u8bfe\uff0c\u4e0d\u9009\u62e9 i \u8282\u70b9\u4fbf\u65e0\u6cd5\u9009\u62e9 x \u8282\u70b9\uff0c\u6240\u4ee5\u5e94\u6ee1\u8db3 p < k\n\n\n\u5728\u679a\u4e3e k \u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\uff1a\u7531\u4e8e f[i][k] \u7531 f[i][k - p] \u66f4\u65b0\u5f97\u5230\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u4fdd\u8bc1\u66f4\u65b0 f[i][k] \u7684\u65f6\u5019 f[i][k - p] \u6ca1\u6709\u88ab\u66f4\u65b0\uff0c\u7531\u4e8e p \u662f\u4e00\u4e2a\u6b63\u6574\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u5012\u5e8f\u679a\u4e3e k \u5373\u53ef\n\n\n\u6e90\u4ee3\u7801\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\nusing namespace std;\nint n, m;\nint score[305], fa[305];\nbool vis[305];\nint f[305][305];\nint head[305], edge_len;\nstruct Edge {\n    int to;\n    int next;\n} edges[605];\nvoid add(int from, int to) {//\u52a0\u8fb9\n    edges[++edge_len].to = to;\n    edges[edge_len].next = head[from];\n    head[from] = edge_len;\n}\nvoid dfs(int x) {\n    f[x][1] = score[x];\n    int to;\n    for (int i = head[x]; ~i; i = edges[i].next) { // \u904d\u5386 x \u7684\u6240\u6709\u5b50\u8282\u70b9\n        to = edges[i].to; // to \u662f x \u7684\u4e00\u4e2a\u5b50\u8282\u70b9\n        dfs(to); // \u8ba1\u7b97 to \u8282\u70b9\u7684 f \u6570\u7ec4\n        for (int j = m; j >= 1; j--)//\u5012\u5e8f\u679a\u4e3e\uff0c\u4f7f\u7528 to \u8282\u70b9\u7684 f \u6570\u7ec4\u66f4\u65b0 x \u8282\u70b9\u7684 f \u6570\u7ec4\n            for (int i = j - 1; i >= 1; i--)\n                f[x][j] = max(f[x][j], f[x][j - i] + f[to][i]);\n    }\n}\nint main() {\n    freopen(\"in.txt\", \"r\", stdin);\n    scanf(\"%d%d\", &n, &m);\n    memset(head, -1, sizeof(head));\n    for (int i = 1; i <= n; i++) {\n        scanf(\"%d%d\", &fa[i], &score[i]);\n        add(fa[i], i);//\u7531\u7236\u8282\u70b9\u6307\u5411\u5b50\u8282\u70b9\u7684\u5355\u5411\u8fb9\n    }\n    m++; // \u7531\u4e8e 0 \u53f7\u8282\u70b9\u7684\u53c2\u4e0e\uff0cm \u9700\u8981\u81ea\u52a01\n    dfs(0);//\u641c\u7d22 0 \u53f7\u8282\u70b9\n    cout << f[0][m];\n    return 0;\n}\n```",
        "postTime": 1506342251,
        "uid": 25845,
        "name": "Snitro",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u6211\u8fc7\u6765\u53e3\u80e1\u4e00\u4e0b DFS \u5e8f\u7684\u5947\u5999\u505a\u6cd5\u3002\n\n\u6211\u4eec\u628a\u539f\u6811\u53eb\u505a A\u3002\n\n\u5b9a\u4e49\u3000 \u591a\u53c9\u6811\u7684**\u540e\u5e8f\u904d\u5386**\u6307\u7684\u662f\uff1a\u5728\u641c\u7d22\u67d0\u4e2a\u7ed3\u70b9\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5148\u8bb0\u5f55\u5b83\u7684\u6240\u6709\u5b50\u6811\uff0c\u518d\u8bb0\u5f55\u5b83\u672c\u8eab\u3002\u6ce8\u610f\uff0c\u5982\u679c\u6709\u591a\u4e2a\u5b50\u6811\uff0c\u5219\u540e\u5e8f\u904d\u5386\u7684\u987a\u5e8f\u4e0d\u9650\u3002\n\n\u5b9a\u4e49\u3000 \u591a\u53c9\u6811\u7684**\u540e\u5e8f\u904d\u5386\u5e8f\u5217**\u6307\u7684\u662f\u5728\u4e0a\u8ff0\u8fc7\u7a0b\u4e2d\u6240\u8bb0\u5f55\u4e0b\u6765\u7684\u5e8f\u5217\u3002\n\n\u6211\u4eec\u4e0d\u59a8\u5728 DFS \u540e\u628a\u7ed3\u70b9\u6309\u7167\u540e\u5e8f\u904d\u5386\u5e8f\u5217**\u91cd\u65b0\u7f16\u53f7**\u3002\u4e0b\u56fe\u5c31\u662f\u4e00\u4e2a\u4f8b\u5b50\uff0c\u5de6\u56fe\u4e3a\u539f\u6811 A\uff0c\u53f3\u56fe\u4e3a\u91cd\u65b0\u7f16\u53f7\u7684\u6811 B\u3002\n\n![](https://i.loli.net/2019/02/19/5c6bd9547ffd1.png)\n\n\u73b0\u5728\uff0c\u5982\u679c\u6211\u4eec\u8981\u590d\u5236\u4e00\u68f5\u6811 B\uff08\u4e0d\u59a8\u79f0\u590d\u5236\u54c1\u4e3a C\uff09\uff0c\u5c06\u65b0\u6811 B \u91cc\u9762\u7684\u7ed3\u70b9**\u6309\u7f16\u53f7**\uff08\u4e5f\u5c31\u662f\u6309\u7167 A \u6811\u7684\u540e\u5e8f\u904d\u5386\u5e8f\u5217\uff09**\u4f9d\u6b21**\u52a0\u5165 C \u4e2d\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c**\u6bcf\u6b21\u52a0\u5165\u7684\u7ed3\u70b9\u5728\u5f53\u524d\u60c5\u51b5\u4e0b\u90fd\u662f\u6839\u7ed3\u70b9**\u3002\u4e0b\u56fe\u5c55\u793a\u4e86\u653e\u5165 4, 7, 8, 9 \u53f7\u7ed3\u70b9\u65f6\uff0c\u65b0\u56fe\u7684\u60c5\u51b5\u3002\n\n![](https://i.loli.net/2019/02/19/5c6bd9f4ca063.png)\n\n\n\u56e0\u6b64\uff0c\u8bbe $\\mathrm{dp}(i,j)$ \u8868\u793a\u5c06\u6811 B \u7684\u7ed3\u70b9 $1\\ldots i$ \u653e\u5165\u65b0\u56fe\uff0c\u80cc\u5305\u5bb9\u91cf\u4e3a $j$ \u65f6\uff0c\u6240\u80fd\u53d6\u5f97\u7684\u6700\u5927\u4ef7\u503c\u3002\u8bbe $\\mathrm{size}_i$ \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u7684\u5927\u5c0f\u3002\n\n- \u82e5\u53d6\u7269\u54c1 $i$\uff08\u524d\u63d0\u662f\u6b64\u65f6\u7684\u80cc\u5305\u5bb9\u91cf\u653e\u5f97\u4e0b\u7269\u54c1 $i$\uff09\uff0c\u5219\u53ef\u4ee5\u53d6\u5b83\u7684\u5b50\u6811\uff0c\u5219\n  * \u95ee\u9898\u8f6c\u5316\u4e3a\u300c\u5c06\u7ed3\u70b9 $1\\ldots i-1$ \u52a0\u5165 C\uff0c\u4e14\u80cc\u5305\u5bb9\u91cf\u4e3a $j-1$ \u65f6\uff0c\u6240\u80fd\u53d6\u5230\u7684\u6700\u5927\u4ef7\u503c\u300d\u52a0\u4e0a\u7269\u54c1 $i$ \u7684\u4ef7\u503c\uff0c\n  * \u6240\u4ee5\u7b54\u6848\u4e3a $\\mathrm{dp}(i-1,j-1)+v_i$\uff1b\n- \u82e5\u4e0d\u53d6\u7269\u54c1 $i$\uff0c\u5219\u4e0d\u53ef\u4ee5\u53d6\u5b83\u7684\u5b50\u6811\uff0c\u5219\n  * \u95ee\u9898\u8f6c\u5316\u4e3a\u300c\u5c06\u300e\u7ed3\u70b9 $1\\ldots i-1$ \u4e2d\u4e0d\u5c5e\u4e8e $i$ \u7684\u5b50\u6811\u7684\u7ed3\u70b9\u300f\u52a0\u5165 C\uff0c\u80cc\u5305\u5bb9\u91cf\u4e0d\u53d8\u65f6\uff0c\u6240\u80fd\u53d6\u5230\u7684\u6700\u5927\u4ef7\u503c\u300d\n  * \u7b54\u6848\u4e3a $\\mathrm{dp}(i-\\mathrm{size}_i,j)$\uff1b\n\n\u7efc\u4e0a\u53ef\u5f97 $\\mathrm{dp}(i,j)=\\begin{cases}\\max(\\mathrm{dp}(i-1,j-1)+v_i,\\;\\mathrm{dp}(i-\\mathrm{size}_i,j)) & j\\ge w_i \\\\ \\mathrm{dp}(i-\\mathrm{size}_i,j) & j<w_i \\end{cases}$ \u3002\n\n\u6613\u8bc1\u5176\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(NM)$\u3002\n\n\u6700\u540e\u6253\u4e2a\u5e7f\u544a\uff0cLOJ \u5df2\u4e0a\u7ebf\u6811\u5f62\u80cc\u5305\u6a21\u677f\u9898 https://loj.ac/p/160 \uff0c\u6b22\u8fce\u5927\u5bb6\u6765\u73a9~",
        "postTime": 1551176586,
        "uid": 29762,
        "name": "Planet6174",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "/\\*\n\\* P2014\n\n\\* Au:Small\\_Ash\n\n\\* \u597d\u591a\u4eba\u8fd9\u9898\u7528\u591a\u53c9\u8f6c\u4e8c\u53c9\u554a\uff0c\u5c31\u6211\u7528\u6811\u5f62DP\u5f3a\u884c\u4e48\u3002\u3002\u3002\n\n\\* \u6709\u6811\u5f62\u7684\uff0c\u4f46\u662f\u6ca1\u6709\u8bb2\u8be6\u7ec6\u554a\u3002\n\n\\* \u5927\u5bb6\u53ef\u4ee5\u53c2\u8003\u9898\u76eeP1273 \u6709\u7ebf\u7535\u89c6\u7f51\u6765\u505a\u505a\u770b\n\n\\* \u4e24\u9898\u90fd\u662f\u6811\u5f62DP\n\n\\* \u7136\u800c\u6211\u524d\u51e0\u5929\u624d\u77e5\u9053\u6811\u5f62DP\u7684\u5b9e\u73b0\u8981\u7528\u5230DFS\u3002\u3002\u3002\u602a\u4e0d\u5f97\u6211\u4e0a\u4e2a\u6708\u505a\u8fd9\u9898\u53ea\u670960\u3002\u3002\u3002\n\n\\* \u4e0b\u9762\u6765\u8bb2\u6811\u5f62DP\u4e86\n\n\\* F[i][j]\u8868\u793a\u7b2ci\u4e2a\u8282\u70b9\u53d6j\u4e2a\u5b50\u8282\u70b9\uff08\u4e0d\u5305\u62ec\u81ea\u5df1\uff09\u6240\u53d6\u5f97\u7684\u6700\u5927\uff08\u6700\u5c0f\uff09\u6536\u76ca\u3002\n\n\\* \u5f53\u7136F[i][j]\u7684\u7b2c\u4e8c\u7ef4j\u8981\u6839\u636e\u9898\u76ee\u6765\u5b9a\uff0c\u50cf1273\u7684\u7b2c\u4e8c\u7ef4\u7528\u6765\u5b58\u63a5\u53d7\u7aef\u7684\u6570\u91cf\u6bd4\u8f83\u597d\u3002\n\n\\* \u4f46\u662f\u5927\u90e8\u5206\u7684\u7b2c\u4e00\u7ef4\u90fd\u662f\u6307\u7b2ci\u4e2a\u8282\u70b9\uff08\u6bd5\u7adf\u5b83\u8fd8\u662f\u4e00\u4e2aDP\u554a\uff09\u3002\n\n\\* \u6811\u5f62DP\u548c\u7ebf\u6027\u7684\u6700\u5927\u533a\u522b\u5c31\u662f\u2014\u2014DP\u7684\u987a\u5e8f\u6709\u8bb2\u7a76\u3002\u6ca1\u9519\uff0c\u5c31\u662f\u5148DP\u513f\u5b50\u3002\n\n\\* \u7136\u540e\u5c31\u6709\u4e86\u8f6c\u79fb\u65b9\u7a0bF[i][j]=max/min(f[i][j],f[i][j-k]+f[\u513f\u5b50\u8282\u70b9\u7f16\u53f7][k]=....)\u3010\u6839\u636e\u9898\u76ee\u7701\u7565\u53f7\u53ef\u80fd\u4f1a\u6709\u4e1c\u897f\u3011\n\n\\* \u53ef\u662f\u95ee\u9898\u5c31\u6765\u4e86\uff0c\u600e\u4e48\u77e5\u9053\u81ea\u5df1\u7a76\u7adf\u6709\u591a\u5c11\u4e2a\u5b50\u8282\u70b9\uff0c\u5e76\u4e14\u4fdd\u8bc1DP\u8be5\u70b9\u4e4b\u524d\u5b50\u8282\u70b9\u5df2\u7ecf\u88abDP\u8fc7\u4e86\u5462\uff08\u6211\u4e0a\u4e2a\u6708\u5c31\u56e0\u4e3a\u8fd9\u4e2a\u95ee\u9898\u624d60 QAQ\uff09\n\n\\* \u6ca1\u9519\uff0c\u5c31\u662f\u641c\u7d22\u6811\u7684\u795e\u5668\u2014\u2014DFS\n\n\\* \u4e3a\u4e86\u65b9\u4fbf\u7f16\u5199\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5728DFS\u7684\u8fc7\u7a0b\u4e2dDP\uff0cDP\u65f6\u7528\u5230\u4e86\u5b50\u8282\u70b9\u7684\u8bdd\u5c31DFS\u5b50\u8282\u70b9\u3002\n\n\\* \u8fd9\u6837\u5c31\u4e0d\u4f1a\u51fa\u73b0DP\u987a\u5e8f\u7684\u9519\u8bef\u5566\uff01\n\n\\* \u4e0b\u9762\u662f\u4ee3\u7801\u3002\n\n\\*/\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\nint n,m,f[2005][2005];\nint head[2005],next[2005],w[2005];\nint dfs(int x){\n    if (head[x]==-1) return 0;\n    int sum=0;\n    for (int i=head[x];i!=-1;i=next[i]){\n        int t=dfs(i);\n        sum+=t+1;\n        for (int j=sum;j>=0;j--){//\u6ce8\u610f\uff0c\u4e00\u5b9a\u8981\u662f\u964d\u5e8f\uff0c\u6211\u5fd8\u4e86\u964d\u5e8f\u4e8e\u662f\u5c310\u5206\u4e86\u4e00\u6b21 QAQ \n            for (int k=0;k<=t;k++)\n                if (j-k-1>=0) f[x][j]=max(f[x][j],f[x][j-k-1]+f[i][k]);\n        }\n    }\n    return sum;\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    memset(f,0,sizeof(f));\n    memset(head,-1,sizeof(head));\n    for (int i=1;i<=n;i++){\n        int a;\n        scanf(\"%d%d\",&a,&w[i]);\n        next[i]=head[a];\n        head[a]=i;\n    }\n    for (int i=1;i<=n;i++) f[i][0]=w[i];\n    f[0][0]=0;\n    dfs(0);\n    printf(\"%d\",f[0][m]);\n    return 0;\n```\n}//\u662f\u7684\uff0c\u4ee3\u7801\u5c31\u662f\u90a3\u4e48\u77ed\u3002\u3002\u3002\u5c3135\u884c\u3002\u3002\u3002",
        "postTime": 1474947807,
        "uid": 745,
        "name": "dph754132771",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u4e00\u9053\u6811\u5f62dp\u9898\uff0c\u4e24\u79cd\u89e3\u6cd5\u3002      \n\u8fd9\u9053\u9898\u662f\u4e00\u9053\u591a\u53c9\u6811\u8d44\u6e90\u5206\u914d\u95ee\u9898(\u8bf4\u7684\u901a\u4fd7\u4e00\u4e9b\u5c31\u662f\u4e66\u4e0a\u80cc\u5305)\u3002     \n\u6211\u4eec\u6765\u8fc7\u4e00\u904d\u7b97\u6cd5\u6d41\u7a0b:      \n\u89e3\u6cd5\u4e00(\u6839\u636edfs\u65f6\u7684\u987a\u5e8f\u6c42\u89e3):       \n\u6211\u4eec\u7684dfs\u8fc7\u7a0b\u662f\u8fd9\u6837\u7684:     \n\u5b9a\u4e49```dfs(int u,int d)```\u8868\u793a\u73b0\u5728\u7684\u8282\u70b9\u662fu\uff0c\u6df1\u5ea6\u662fd\u3002   \n1.\u904d\u5386\u6bcf\u4e00\u6761\u8fb9     \n```cpp\nvoid dfs(int u,int d)\n{\n    for(int i=head[u];i!=-1;i=a[i].next)\n    {\n        int v=a[i].to;\n```\n2.\u5bf9\u4e8e\u5176\u80fd\u5230\u8fbe\u7684\u6bcf\u4e00\u6761\u70b9\u7684\u503c\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u5e76\u7ee7\u7eeddfs\u8fc7\u7a0b\u3002\n```cpp\n        for(int j=d+1;j<=m+1;j++)f[v][j]=f[u][j-1]+w[v];\n        dfs(v,d+1);\n```\n3.\u6839\u636e\u8f6c\u79fb\u65b9\u7a0b\u5b8c\u6210\u4e00\u4e2adfs\u8fc7\u7a0b\u3002\n```\n        for(int j=d+1;j<=m+1;j++)f[u][j]=max(f[u][j],f[v][j]);\n    }\n}\n```\n\u849f\u84bb\u7684\u8f6c\u79fb\u65b9\u7a0b\u63a8\u5bfc:      \n```\n\u5bf9\u4e8e\u4e00\u4e2a\u70b9u\uff0c\u6211\u4eec\u53ef\u4ee5\u9009\u5b83\u6216\u4e0d\u9009\u5b83\u3002\n\u82e5\u8981\u9009\u7684\u8bdd\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u9009\u62e9\u5b83\u7684\u5b69\u5b50dp[u][j]=max{dp[v][j]}+w[u];\n\u82e5\u4e0d\u9009\u7684\u8bdd\uff0c\u5b83\u7684\u5b69\u5b50\u4e5f\u4e0d\u80fd\u9009\u62e9\u4e86\u3002\n\u6240\u4ee5\u6709\nfor(int j=d+1;j<=m+1;j++)f[v][j]=f[u][j-1]+w[v];\nfor(int j=d+1;j<=m+1;j++)f[u][j]=max(f[u][j],f[v][j]);\n```\n\u5b8c\u6574\u4ee3\u7801:\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<cstdlib>\n#include<climits>\n#include<ctime>\n#include<algorithm>\n#include<complex>\n#include<iostream>\n#include<map>\n#include<queue>\n#include<vector>\n#define INF 0x3f3f3f3f\n#define ll long long\nusing namespace std;\nstruct edge\n{\n    int to,next;\n}a[1100];\nint head[550];\nint f[550][550];\nint w[550];\nint cnt(0);\nint n,m;\nvoid addedge(int xi,int yi)\n{\n    a[cnt].to=yi;\n    a[cnt].next=head[xi];\n    head[xi]=cnt++;\n}\nvoid dfs(int u,int d)\n{\n    for(int i=head[u];i!=-1;i=a[i].next)\n    {\n        int v=a[i].to;\n        for(int j=d+1;j<=m+1;j++)f[v][j]=f[u][j-1]+w[v];\n        dfs(v,d+1);\n        for(int j=d+1;j<=m+1;j++)f[u][j]=max(f[u][j],f[v][j]);\n    }\n}\nint main()\n{\n    memset(head,-1,sizeof(head));\n    scanf(\"%d%d\",&n,&m);\n    for (int i=1;i<=n;++i)\n    {\n        int x;\n        scanf(\"%d%d\",&x,w+i);\n        addedge(x,i);\n    }\n    for(int i=0;i<=m+2;i++)f[0][i]=0;\n    dfs(0,1);\n    printf(\"%d\",f[0][m+1]);\n}\n\n```\n\u89e3\u6cd5\u4e8c(\u591a\u53c9\u6811\u8f6c\u4e8c\u53c9\u6811\u6c42\u89e3):\n\u6211\u4eec\u53d1\u73b0\u591a\u53c9\u6811\u4e0a\u8fd0\u7528\u6811\u5f62dp\u592a\u7384\u5b66\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u628a\u5176\u8f6c\u6362\u4e3a\u4e8c\u53c9\u6811\u6c42\u89e3\u3002       \n\u6211\u4eec\u8bfb\u5165\u65f6\u4e0d\u7528\u524d\u5411\u661f\u5b58\u56fe\uff0c\u800c\u662f\u7528\u53e6\u5916\u4e00\u79cd\u65b9\u6cd5\uff1a    \n```cpp\n    for(int i=1;i<=n;i++)\n    {\n        int x,y;\n        scanf(\"%d%d\",&x,&y);\n        a[i]=y;\n        if(x==0)x=n+1;\n        rs[i]=ls[x];\n        ls[x]=i;\n    }\n```\n\u6211\u4eec\u7528\u8282\u70b9\u5728\u4e8c\u53c9\u6811\u4e0a\u7684x\u7684\u5de6\u5b69\u5b50(\u5373```ls[x]```\n)\u6765\u5b58\u50a8\u8282\u70b9x\u5b9e\u9645\u7ed3\u6784\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b69\u5b50\uff0c\u7528\u5176\u5728\u4e8c\u53c9\u6811\u4e0a\u7684\u53f3\u5b69\u5b50(\u5373```rs[x]```)\u6765\u5b58\u50a8\u5176\u5728\u5b9e\u9645\u6811\u4e0a\u7684\u53f3\u8fb9\u7b2c\u4e00\u4e2a\u5144\u5f1f\u3002     \n\u7136\u540e\u6211\u4eec\u8bb0\u5fc6\u5316\u641c\u7d22\u4e00\u904d\u6765\u5b8c\u6210\u8fd9\u4e2a\u8fc7\u7a0b\u3002     \n\u7b97\u6cd5\u6d41\u7a0b\uff1a  \n\u6211\u4eec\u89c4\u5b9adfs(i,j)\u8868\u793a\u5f53\u524d\u8282\u70b9\u662fi\uff0c\u53ef\u4ee5\u66f4\u65b0j\u6b21\u3002\n1.\u521d\u59cb\u5316(\u5982\u679c\u6211\u4eec\u5df2\u7ecf\u66f4\u65b0\u8fc7\u4e86\uff0c\u5c31\u4e0d\u518d\u66f4\u65b0):\n```cpp\nvoid dfs(int i,int j)\n{\n    if(f[i][j]>0||!j||!i)return;\n```\n2.\u540c\u6837\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u9009i\u6216\u4e0d\u9009i\uff1a     \n\u2460.\u82e5\u4e0d\u9009\uff0c\u6211\u4eec\u5c31\u641c\u5b83\u7684\u53f3\u5b69\u5b50\uff1a\n```cpp\n    dfs(rs[i],j);\n    f[i][j]=max(f[i][j],f[rs[i]][j]);\n```\n\u2461.\u82e5\u9009\uff0c\u6211\u4eec\u5c31\u641c\u5b83\u7684\u5de6\u5b69\u5b50\uff1a\n```\n    for(int k=0;k<=j-1;k++)\n\t{\n        dfs(ls[i],j-k-1);\n        dfs(rs[i],k);\n        f[i][j]=max(f[i][j],f[rs[i]][k]+f[ls[i]][j-k-1]+a[i]);\n    }\n}\n```\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n```\nf[i][j]=max(f[rs[i]][j],f[ls[i]][k]+f[i][j-k-1]+a[i]);\n```\n\u5b8c\u6574\u4ee3\u7801\uff1b\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<cstdlib>\n#include<climits>\n#include<ctime>\n#include<algorithm>\n#include<complex>\n#include<iostream>\n#include<map>\n#include<queue>\n#include<vector>\n#define INF 0x3f3f3f3f\n#define ll long long\nusing namespace std;\nint f[550][550];\nint ls[550];\nint rs[550];\nint a[550];\nint n,m;\nvoid dfs(int i,int j)\n{\n    if(f[i][j]>0||!j||!i)return;\n    dfs(rs[i],j);\n    f[i][j]=max(f[i][j],f[rs[i]][j]);\n    for(int k=0;k<=j-1;k++)\n\t{\n        dfs(ls[i],j-k-1);\n        dfs(rs[i],k);\n        f[i][j]=max(f[i][j],f[rs[i]][k]+f[ls[i]][j-k-1]+a[i]);\n    }\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n;i++)\n    {\n        int x,y;\n        scanf(\"%d%d\",&x,&y);\n        a[i]=y;\n        if(x==0)x=n+1;\n        rs[i]=ls[x];\n        ls[x]=i;\n    }\n    dfs(ls[n+1],m);\n    printf(\"%d\",f[ls[n+1]][m]);\n}\n\n```\n",
        "postTime": 1543312274,
        "uid": 105496,
        "name": "KevinYu",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u4e0d\u7528\u591a\u53c9\u8f6c\u4e8c\u53c9\u7684\u9898\u89e3\n\n\u9898\u610f\u5f88\u597d\u7406\u89e3\uff1a\u5982\u679c\u6211\u4eec\u8981\u9009\u62e9\u4e00\u4e2a\u8282\u70b9\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8282\u70b9\u4e00\u76f4\u5230\u6839\u8282\u70b9\u7684\u8def\u5f84\u6211\u4eec\u5fc5\u987b\u9009\u4e2d\u3002\u7136\u540e\u6211\u4eec\u5c31\u53d1\u73b0\u4e86\u51e0\u4e2a\u95ee\u9898\uff1a\n\n1.\u8f6c\u79fb\u65b9\u7a0b\uff1a\u8bbedp[i][j]\u662f\u5728\u5b8c\u6210\u7b2ci\u4e2a\u7ed3\u70b9\u7684\u51b3\u7b56\u65f6\uff0c\u5df2\u7ecf\u53d6\u5230\u4e86\u7b2cj\u4e2a\u7269\u54c1\u3002\n\ndp[i][j]=max(dp[i][j],dp[v][j-1]+val[v])(v=sons of i)\n\n2.\u6ce8\u610f\u5230\u8fd9\u662f\u4e00\u4e2a\u68ee\u6797\u3002\u65b9\u6cd5\uff1a\u501f\u9274\u7f51\u7edc\u6d41\u7684\u601d\u60f3\uff0c\u5efa\u7acb\u8d85\u7ea7\u6839\u8282\u70b9\uff0c\u5e76\u4e14\u8ba9\u4ed6\u7684\u6743\u503c=0\uff0c\u8bb0\u5f55\u4e0b\u6240\u6709\u5355\u72ec\u6811\u7684\u6839\u8282\u70b9\uff0c\u8ddf\u8d85\u7ea7\u6839\u8282\u70b9\u76f8\u8fde\u3002\u540c\u65f6\u6ce8\u610f\u53ef\u9009\u62e9\u7684\u8282\u70b9\u6570+1\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u8d85\u7ea7\u6839\u8282\u70b9\u4f60\u662f\u80af\u5b9a\u8981\u9009\u4e2d\u7684\u3002\n\n3.\u6ce8\u610f\u5230\u8fd9\u662f\u4e00\u68f5\u591a\u53c9\u6811\u3002\u65b9\u6cd5\uff1a\u4e0d\u8f6c\u5316\u6210\u4e8c\u53c9\u6811\uff0c\u5728dfs\u540c\u65f6\uff0c\u8ba1\u7b97\u51fa\u5b50\u8282\u70b9\u7684\u6743\u503c\uff0c\u7136\u540e\u5f53\u505a\u4e00\u4e2a\u5355\u72ec\u7269\u54c1\uff0c\u53c2\u4e0e\u7236\u8282\u70b9\u7684\u51b3\u7b56\u3002\n\n4.\u53ef\u80fd\u6709\u7c7b\u4f3c\u9898\u51fa\u73b0\u8d1f\u6570\uff0c\u4e00\u4e2a\u70b9\u90fd\u4e0d\u9009\u53ef\u80fd\u66f4\u4f18\u3002\u65b9\u6cd5\uff1a\u6700\u540e\u8ddf0\u6bd4\u8f83\u3002\n\n\u8d2f\u5f7b\u4e0a\u8ff0\u601d\u60f3\u7684\u7b80\u5355\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define N 10010\nusing namespace std;\nstruct Edge{\n    int u,v,next;\n}G[4*N];\nint tot=0,head[4*N],dp[301][301],n,m;\nint a[N],f[N];\nvector<int>g;\nint read(){\n    int x=0,f=1;char ch;\n    do{ch=getchar();if(ch=='-')f=-1;}while(ch<'0'||ch>'9');\n    do{x=x*10+ch-'0';ch=getchar();}while(ch>='0'&&ch<='9');\n    return f*x;\n}\nvoid addedge(int u,int v){\n    G[++tot].u=u;G[tot].v=v;G[tot].next=head[u];head[u]=tot;\n    G[++tot].u=v;G[tot].v=u;G[tot].next=head[v];head[v]=tot;\n}\nvoid dfs(int u){\n    for (register int i=head[u];i;i=G[i].next){\n        int v=G[i].v;\n        if (v!=f[u]){f[v]=u;\n            for (int j=m;j>=0;j--)dp[v][j]=dp[u][j]+a[v];\n            dfs(v);\n            for (int j=m;j>=0;j--){\n            dp[u][j]=max(dp[u][j],dp[v][j-1]);\n            //printf(\"dp[%d][%d]=%d\\n\",u,j,dp[u][j]);\n            } \n        }\n    }\n}\nint main(){\n    n=read(),m=read();\n    for(int i=1;i<=n;i++){\n        int f=read(),v=read();\n        if(f)addedge(i,f);else g.push_back(i);\n        a[i]=v;\n    }int s=0;a[s]=0;m++;\n    for(int i=0;i<g.size();i++)addedge(s,g[i]);\n    dfs(s);\n    printf(\"%d\",max(0,dp[0][m-1]+a[0]));\n    return 0;\n}\n```",
        "postTime": 1485436870,
        "uid": 2978,
        "name": "zcysky",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u770b\u4e0d\u61c2\u4e0b\u9762\u7684\u9898\u89e3\uff0c\u81ea\u5df1\u5199\u4e86\u4e00\u4e2a\u8bb0\u5fc6\u5316\u3002\n\n\u5148\u5c06\u6811\u8f6c\u6362\u6210\u5de6\u513f\u5b50\u53f3\u5144\u5f1f\u6811\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a i \u8282\u70b9\uff0c\u5b9a\u4e49dp( i , j ) \u4e3a i \u7684\u6240\u6709\u5144\u5f1f\u548c i \u7684\u6240\u6709\u513f\u5b50\uff0c \u548c i \u81ea\u5df1\uff0c\u5b66 j \u95e8\u8bfe\u7684\u6700\u5927\u5b66\u5206\u603b\u548c\u3002\n\n\u90a3\u4e48\uff0c\u53ef\u4ee5\u5206\u6210\u4e24\u79cd\u60c5\u51b5\uff1a\n\n1. \u4e0d\u5b66 i \u8fd9\u95e8\u8bfe\uff0c\u5168\u90e8\u5b66\u5144\u5f1f\u7684\u8bfe\u7a0b\uff0cdp( i , j ) = dp( bro[ i ] , j)\n\n2. \u5b66 i \u4ee5\u53ca\u4ee5 i \u4e3a\u5148\u4fee\u8bfe\u7684\u8bfe\u7a0b\uff0c dp( i , j ) = dp( bro[ i ] ,  j - 1 - k ) + dp( son[ i ] , k ) + v[ i ]\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn = 320;\nint f[maxn][maxn] , bro[maxn] , son[maxn], v[maxn];\nvoid add(int fa, int s)\n{\n    bro[s] = son[fa];\n    son[fa] = s;\n}\n\nint dp(int i, int j)\n{\n    if (i == -1) return 0;\n    if (j == 0) return 0;\n    if (f[i][j] != -1) return f[i][j];\n    int m = -1<<30; //\u6700\u5c0f\u503c \n    \n    // \u5168\u5206\u5144\u5f1f\n    m = max( m, dp(bro[i] , j));\n    \n    for (int k = 0; k <= j-1; k++)\n    {\n        m = max( m , dp(son[i] , k) + dp(bro[i] , j-1-k) + v[i]);\n    }\n    f[i][j] = m;\n    return m;\n}\nint main()\n{\n    memset(son , -1, sizeof(son));\n    memset(bro , -1, sizeof(bro));\n    memset(f   , -1, sizeof(f  ));\n    int n, m;\n    cin>>n>>m;\n    for(int i=1;i<=n;i++){\n        int fa,vx;\n        cin>>fa>>vx;\n        add(fa,i);\n        v[i] = vx;\n    }\n    cout<<dp(0, m+1);\n    return 0;\n}\n```",
        "postTime": 1509428322,
        "uid": 15011,
        "name": "caoyihong",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u8001\u5b9e\u8bf4\uff0c\u5404\u4e2a\u9898\u89e3\u90fd\u628a\u8fd9\u9898\u5199\u7684\u592a\u9ebb\u70e6\u4e86\u3002\u3002\n\n\u7531\u4e8e\u6811\u5f62\u80cc\u5305=\u6811\u5f62DP+\u80cc\u5305DP\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u628a\u6811\u5f62\u7684\u677f\u5b50\u62ce\u51fa\u6765\uff0c\u5355\u72ec\u5206\u6790\u80cc\u5305\u95ee\u9898\u5373\u53ef\u3002\n\n----\n\n1. ### \u9996\u5148\u5957\u4e0a\u6811\u5f62DP\u677f\u5b50\uff1a\n```cpp\nvoid dfs(int v)\n{\n\tfor (int i=fir[v];i;i=e[i].next)\n\t{\n\t\tint u=e[i].u; dfs(u); \n\t\t//~~\u679a\u4e3e\u5b50\u72b6\u6001\uff0c\u9009\u53d6\u6700\u503c\u7684\u8fc7\u7a0b~~\n\t}\n}\n```\n\n\u597d\u591a\u9898\u89e3\u90fd\u8ba4\u4e3a\u8fd9\u662f\u6811\u5f62DP\u5165\u95e8\uff0c\u4e2a\u4eba\u8ba4\u4e3a[\u6ca1\u6709\u4e0a\u53f8\u7684\u821e\u4f1a](https://www.luogu.org/problemnew/show/P1352)\u66f4\u53ef\u4ee5\u80dc\u4efb\u8fd9\u4e2a\u8eab\u4efd\uff0c~~NOIP2018\u7684D2T3\u90e8\u5206\u5206\u5c31\u662f\u8fd9\u9053\u9898\u9b54\u6539\u3002~~\n\n\n\u7279\u6b8a\u5730\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u9898\u76ee\u7ed9\u5b9a\u7684\u662f\u4e00\u4e2a\u68ee\u6797\uff0c\u4f60\u8981\u8dd1\u6811\u5f62DP\u5fc5\u987b\u8981**\u5efa\u4e00\u4e2a\u865a\u8282\u70b9O\uff0c\u8fde\u63a5\u6240\u6709\u6709\u5411\u6811\u7684\u6839**\uff0c\u8fd9\u6b65\u9aa4\u662f\u6240\u6709\u9898\u89e3\u516c\u8ba4\u7684\uff0c\u4e5f\u5f88\u76f4\u89c2\u3002\n\n2. ### \u518d\u8003\u8651\u80cc\u5305DP\u7684\u90e8\u5206\u3002\n\n**\u6811\u5f62DP\u7684\u901a\u6027\u5c31\u662f\u4ed6\u7ef4\u62a4\u7684\u5b50\u7ed3\u6784\u4e00\u5b9a\u662f\u4e00\u4e2a\u5b50\u6811**\uff0c\u8fd9\u6837\u5c31\u5f88\u597d\u5b9a\u4e49\u8f6c\u79fb\u65b9\u7a0b\u3002\u6211\u4eec\u8bbe$f[i][j]$\u4e3a\u4ee5i\u4e3a\u6839\u7684\u5b50\u6811\uff0c\u9009\u4e86j\u8282\u8bfe\u4e14\u5fc5\u9009\u81ea\u5df1\u7684\u6700\u5927\u5229\u76ca\u3002\n\n\u90a3\u4e48\u663e\u7136\u7684\uff0c\u521d\u59cb\u72b6\u6001\u5373\u4e3a$f[i][1]=s[i]$\u3002\u4e14\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5b50\u6811\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528**\u6cdb\u5316\u7269\u54c1**\u7684\u6982\u5ff5\u53bb\u6784\u9020\u4e00\u4e2a\u6cdb\u5316\u7269\u54c1\u4ee3\u66ff\u4e00\u68f5\u5b50\u6811\u3002\n\n_\u5bf9\u4e8e\u6bcf\u4e2a\u5b50\u6811$u$\u6240\u63a7\u5236\u7684\u6cdb\u5316\u7269\u54c1$A$,\u7ed9\u4ed6\u5206\u914d\u7684\u5bb9\u91cf$k$\u5f53\u7136\u6307\u9009j\u8282\u8bfe\uff0c\u9020\u6210\u4e86\u6536\u76ca$w[k]=f[u][k]$\uff0c\u7531\u4e8e\u6211\u4eec\u6267\u884c$DFS$\u4e4b\u540e\u5df2\u7ecf\u641e\u51fa\u6bcf\u4e2a\u5b50\u6811\u7684\u4fe1\u606f\uff0c\u6240\u4ee5\u76f4\u63a5\u8c03\u7528\u5373\u53ef\u3002_\n\n_\u5f88\u663e\u7136\uff0c\u6bcf\u4e2a\u5b50\u6811\u7684\u6cdb\u5316\u7269\u54c1\u5728$~0 ~to ~(m+1)$\u4e2d\u679a\u4e3e\u4e0e\u7236\u4eb2\u53d6\u6781\u503c\u540e\u4e0d\u65ad\u5411\u4e0a\u5408\u5e76\uff0c\u6700\u540e\u53ef\u4ee5\u6c47\u805a\u6210\u4e00\u4e2a\u4ee5\u865a\u8282\u70b9O\u4e3a\u6839\u7684\u603b\u6cdb\u5316\u7269\u54c1\u3002\u8fd9\u5e94\u8be5\u5c31\u662fDD\u5927\u4f6c\u5728\u80cc\u5305\u4e5d\u8bb2\u7684\u672c\u610f\u3002_\n\n~~\u4ee5\u4e0a\u5185\u5bb9\u5747\u4e3a\u4e2a\u4eba\u7406\u89e3\uff0c\u4e0d\u4ee3\u8868\u80cc\u5305\u4e5d\u8bb2\u7684\u4f5c\u8005\uff0c\u82e5\u6709\u9519\u8bef\u8bf7\u52a1\u5fc5\u5728\u8bc4\u8bba\u533a\u6307\u51fa\u3002~~\n\n\u5f53\u7136\u6211\u4eec\u89e3\u9898\u65f6\u4e0d\u9700\u8981\u8fd9\u79cd\u4e71\u4e03\u516b\u7cdf\u7684\u6982\u5ff5\uff0c\u6211\u4eec\u53ea\u7528\u628a\u4e00\u4e2a\u5b50\u6811\u4e0e\u7236\u4eb2\u7684\u5173\u7cfb\u770b\u4f5c\u4e00\u4e2a**\u5206\u7ec4\u80cc\u5305**\uff0c\u5bf9\u4e8e\u4e0d\u540c\u7684\u5bb9\u91cf$j$\uff0c\u4ef7\u503c\u5e94\u8be5\u662f**\u5728\u5b50\u6811\u91cc\u9009$k$\u4e2a\u4e0e\u975e\u8be5\u5b50\u6811\u4e2d\u9009$j-k$\u4e2a\u7684\u4ef7\u503c**\u3002\u5199\u4f5c\u8f6c\u79fb\u65b9\u7a0b\u5373\u4e3a\uff1a\n$$f[v][j]=max\\begin{Bmatrix}f[v_{son}][j]+f[v][j-k]\\end{Bmatrix} $$\n\n\u8fd9\u6837\u7684\u8bdd\uff0c\u5bf9\u4e8e\u6bcf\u68f5\u5b50\u6811\u7684\u7ec4\u5408\uff0c\u53ef\u4ee5\u4fdd\u8bc1\u53ea\u80fd\u81f3\u591a\u9009\u4e00\u4e2a\u7269\u54c1\uff0c\u4e14\u6bcf\u68f5\u5b50\u6811\u53ea\u641c\u4e00\u6b21\uff0c\u4e8e\u662f\u5c31\u662f\u88f8\u7684\u5206\u7ec4\u80cc\u5305\u4e86\u3002\n```cpp\nvoid dfs(int v)\n{\n\tfor (int i=fir[v];i;i=e[i].next)\n\t{\n\t\tint u=e[i].u; dfs(u); \n\t\tfor (int j=m+1;j>=1;j--)  //\u5bb9\u91cf \n\t\t\tfor (int k=0;k<j;k++)  //\u9009\u8fd9\u4e2a\u5b50\u6811\u7684k\u8282\u8bfe \n\t\t\t\tf[v][j]=max(f[v][j],f[u][k]+f[v][j-k]);\n\t}\n}\n```\n\n## \u4ee5\u4e0a\uff0c\u90e8\u5206\u5185\u5bb9\u501f\u9274\u4e8e\u674e\u715c\u4e1c\u300a\u7b97\u6cd5\u7ade\u8d5b\u300b\u3002\n",
        "postTime": 1560245601,
        "uid": 15984,
        "name": "\u5929\u6cfd\u9f9f",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "#### \u9898\u76ee\n\u5728\u5927\u5b66\u91cc\u6bcf\u4e2a\u5b66\u751f\uff0c\u4e3a\u4e86\u8fbe\u5230\u4e00\u5b9a\u7684\u5b66\u5206\uff0c\u5fc5\u987b\u4ece\u5f88\u591a\u8bfe\u7a0b\u91cc\u9009\u62e9\u4e00\u4e9b\u8bfe\u7a0b\u6765\u5b66\u4e60\uff0c\u5728\u8bfe\u7a0b\u91cc\u6709\u4e9b\u8bfe\u7a0b\u5fc5\u987b\u5728\u67d0\u4e9b\u8bfe\u7a0b\u4e4b\u524d\u5b66\u4e60\uff0c\u5982\u9ad8\u7b49\u6570\u5b66\u603b\u662f\u5728\u5176\u5b83\u8bfe\u7a0b\u4e4b\u524d\u5b66\u4e60\u3002\u73b0\u5728\u6709N\u95e8\u529f\u8bfe\uff0c\u6bcf\u95e8\u8bfe\u6709\u4e2a\u5b66\u5206\uff0c\u6bcf\u95e8\u8bfe\u6709\u4e00\u95e8\u6216\u6ca1\u6709\u76f4\u63a5\u5148\u4fee\u8bfe\uff08\u82e5\u8bfe\u7a0ba\u662f\u8bfe\u7a0bb\u7684\u5148\u4fee\u8bfe\u5373\u53ea\u6709\u5b66\u5b8c\u4e86\u8bfe\u7a0ba\uff0c\u624d\u80fd\u5b66\u4e60\u8bfe\u7a0bb\uff09\u3002\u4e00\u4e2a\u5b66\u751f\u8981\u4ece\u8fd9\u4e9b\u8bfe\u7a0b\u91cc\u9009\u62e9M\u95e8\u8bfe\u7a0b\u5b66\u4e60\uff0c\u95ee\u4ed6\u80fd\u83b7\u5f97\u7684\u6700\u5927\u5b66\u5206\u662f\u591a\u5c11\uff1f\n\n#### \u601d\u8def\n\u5404\u79cd\u8bfe\u7a0b\u4e4b\u95f4\u7684\u5173\u7cfb\u663e\u7136\u662f\u6811\u5f62\u7ed3\u6784\uff0c\u663e\u7136\u53ef\u4ee5\u7528\u80cc\u5305\u6c42\u89e3\u3002\n\n\u6211\u4eec\u7528$dp[x][j]$\u8868\u793a\u5728\u5f53\u524d\u5b50\u6811\u4e2d\u9009\u62e9\u4e86j\u95e8\u8bfe\u6240\u80fd\u83b7\u5f97\u7684\u6700\u5927\u5b66\u5206\uff0c\u4e4b\u540e\u6bcf\u4e2a\u70b9\u5c31\u90fd\u53ef\u4ee5\u7531\u5b83\u7684\u5b50\u8282\u70b9\u8f6c\u79fb\u4e86\u3002\n\n```c++\n#include<bits/stdc++.h>\n#define M 305\nusing namespace std;\nint n,m;\nvector<int>G[M];\nint A[M],sz[M];\nint dp[M][M];\nvoid dfs(int x,int f){\n    int k=G[x].size();\n    dp[x][1]=A[x];sz[x]=1;\n    for(int i=0;i<k;i++){\n        int u=G[x][i];\n        if(u==f)continue;\n        dfs(u,x);\n        sz[x]+=sz[u];\n        for(int j=min(m+1,sz[x]);j>=2;j--)\n            for(int k=1;k<j;k++)\n                dp[x][j]=max(dp[x][j],dp[x][k]+dp[u][j-k]);\n    }\n}\nint main(){\n    cin>>n>>m;\n    for(int i=1,a;i<=n;i++){\n        scanf(\"%d%d\",&a,&A[i]);\n        G[a].push_back(i);\n    }\n    dfs(0,-1);\n    cout<<dp[0][m+1]<<endl;\n    return 0;\n}\n```\n\n#### **\u7136\u800c,\u8fd9\u4e0d\u662f\u91cd\u70b9**\n\n\u6211\u4eec\u4f1a\u53d1\u73b0\u4ee5\u4e0a\u7684\u601d\u8def\u7684\u590d\u6742\u5ea6\u662f$O(n*m^2)$\uff0c\u90a3\u6211\u4eec\u80fd\u4e0d\u80fd\u5bfb\u6c42\u66f4\u4f18\u7684\u590d\u6742\u5ea6\u5462\uff1f\n\n\u5bf9\u4e8e\u4e00\u68f5\u5b50\u6811\u800c\u8a00\uff0c\u5bf9\u4e8e\u5b83\u6211\u4eec\u53ea\u6709\u4e24\u79cd\u72b6\u6001\uff0c\u8981\u4e48\u5c06\u5176\u9009\u4e2d\uff0c\u540c\u65f6\u9009\u5b83\u5b50\u6811\u4e2d\u7684\u70b9\uff0c\u8981\u4e48\u76f4\u63a5\u8df3\u8fc7\u8fd9\u4e00\u68f5\u5b50\u6811\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u59a8\u8fd9\u6837\u5b9a\u4e49dp\u6570\u7ec4\uff1a\n\n$dp[x][j]$\u8868\u793a\u5f53\u524d\u8282\u70b9\u548c\u5b83\u7684\u5144\u5f1f\u8282\u70b9\u4e2d\u9009j\u95e8\u8bfe\u7684\u6700\u5c0f\u503c\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\uff0c\u6211\u4eec\u8981\u8bb0\u5f55\u5b50\u6811\u7684\u5927\u5c0f\uff0c\u548cdfs\u5e8f\u3002\n\n\u4e0d\u96be\u53d1\u73b0\u4ee5\u4e0b\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$dp[i][j]=max(dp[i+sz[ln[i]]][j],dp[i+1][j-1]+A[ln[i]]);$\n\n\u5373\u5bf9\u4e8e\u5f53\u524d\u70b9\u800c\u8a00\uff0c\u76f4\u63a5\u8df3\u8fc7\u8fd9\u68f5\u5b50\u6811\u7684\u60c5\u51b5\uff0c\u548c\u641c\u96c6\u5b83\u5b50\u6811\u5185\u7684\u4fe1\u606f\u3002\n\n\u56e0\u4e3a\u6811\u4e0a\u7684\u95ee\u9898\u6709\u7740\u5929\u7136\u7684\u987a\u5e8f\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u6309dfs\u5e8f\u5012\u7740\u5faa\u73af\u4e00\u904d\u5c31\u884c\u4e86\u3002\n\n```c++\n#include<bits/stdc++.h>\n#define M 505\nusing namespace std;\nint n,m,dp[M][M],A[M],sz[M];\nvector<int>G[M];\nint ln[M],tt;\nvoid dfs(int x){\n    ln[++tt]=x;sz[x]=1;\n    for(int i=0;i<G[x].size();i++){\n        int u=G[x][i];\n        dfs(u);\n        sz[x]+=sz[u];\n    }\n}\nint main(){\n    cin>>n>>m;\n    for(int i=1,a,b;i<=n;i++)\n        scanf(\"%d%d\",&a,&A[i]),G[a].push_back(i);\n    dfs(0);\n    for(int i=n+1;i>=1;i--)\n        for(int j=1;j<=m+1;j++)\n            dp[i][j]=max(dp[i+sz[ln[i]]][j],dp[i+1][j-1]+A[ln[i]]);\n    cout<<dp[1][m+1]<<endl;\n    return 0;\n}\n```\n\n\u5bf9\u5148\u5e8f\u904d\u5386\u4f18\u5316\u6811\u5f62\u80cc\u5305\u4e0d\u662f\u5f88\u719f\u6089\u7684\u540c\u5b66\u53ef\u4ee5\u53bb\u770b\u770b\u8fd9\u4e2a\uff1a[\u7f51\u9875\u94fe\u63a5](http://note.youdao.com/noteshare?id=07619acf27a64381650dbb9dc2000f68&sub=4FCC06D686104EA19BFFBF85E614343D)",
        "postTime": 1534991269,
        "uid": 46787,
        "name": "zeroy0410",
        "ccfLevel": 0,
        "title": "\u6d1b\u8c37P2014 \u9009\u8bfe\uff08\u5148\u5e8f\u904d\u5386\u4f18\u5316\u6811\u5f62\u80cc\u5305\uff09"
    },
    {
        "content": "\u8fd9\u9898\u662f\u4e2a\u88f8\u7684\u53ef\u884c\u602701\u4f9d\u8d56\u80cc\u5305\n\n\u7136\u800c\u6211\u7ffb\u4e86\u7ffb\u9898\u89e3\uff0c\u53d1\u73b0\u90fd\u6ca1\u8bf4\u5230\u70b9\u4e0a\uff0c\u6240\u4ee5\u6211\u51b3\u5b9a\u8003\u524d\u53d1\u4e00\u6ce2\u798f\u5229\n\n\u8fd9\u9053\u9898\u5b9e\u9645\u4e0a\u5c31\u662f\u6709\u4f9d\u8d56\u6027\u8d28\u7684\u673a\u5668\u5206\u914d\uff08P2066\uff09\uff0c\u56e0\u6b64\uff0c\u4f9d\u8d56\u80cc\u5305\u5b9e\u8d28\u4e0a\u5c31\u662f\u4e00\u4e2a**\u6811\u5f62\u5206\u7ec4\u80cc\u5305**\uff0c\u4ed6\u4e0e\u5206\u7ec4\u80cc\u5305\u552f\u4e00\u7684\u5dee\u522b\u5728\u4e8e**\u4ed6\u7684\u8f6c\u79fb\u662f\u6811\u4e0a\u76f8\u90bb\u70b9\u7684\u8f6c\u79fb**\n\n\u7ed3\u5408\u4ee3\u7801\u89e3\u91ca\u4e00\u4e0b\u4e3a\u4ec0\u4e48\u53eb\u4ed6\u5206\u7ec4\u80cc\u5305\n\n```\nvoid dfs(int u)\n{\n//\u6bcf\u4e2a\u70b9\u90fd\u662f\u4e00\u4e2a\u7ec4\uff0c\u4ee3\u8868\u4ee5u\u4e3a\u6839\u7684\u5b50\u6811\u7684\u6700\u4f18\u89e3\n    for(int i=head[u];i;i=e[i].next)\n    {\n        int v=e[i].to;\n        //\u6bcf\u6b21\u5411\u4e0e\u4ed6\u76f8\u8fde\u7684v\u8f6c\u79fb\n        dfs(v);\n        for(int j=V+1;j>=1;j--)\n        //\u7b2c\u4e8c\u91cd\u5faa\u73af\u679a\u4e3e\u4f53\u79ef\uff08\u7b2c\u4e00\u91cd\u5faa\u73af\u5b9e\u8d28\u4e0a\u5c31\u662fdfs\u641c\u7d22\u70b9u\uff09\n            for(int k=0;k<j;k++)\n            //\u7b2c\u4e09\u91cd\u5faa\u73af\u679a\u4e3e\u7ec4\u5185\u7269\u54c1\n            //\u6211\u4eec\u628a\u4e0a\u591a\u5c11v\u5185\u7684\u8bfe\u4f5c\u4e3a\u7269\u54c1k\n            //\u7b2cu\u7ec4\u7b2ck\u4e2a\u7269\u54c1\u7684\u4f53\u79ef\u662fk\uff0c\u51c6\u786e\u7684\u8bf4\uff0c\u662fnum[u][k]=k\n            //\u4ef7\u503c\u5c31\u662ff[v][k]\n                f[u][j]=std::max(f[u][j],f[u][j-k]+f[v][k]);\n    }\n}\n```\n\n\u518d\u8bf4\u51e0\u70b9\u7ec6\u8282\n+ Q\uff1a\u4e3a\u4ec0\u4e48\u6211\u7684\u7b2c\u4e8c\u91cd\u5faa\u73af\u4e0a\u9650\u662fV+1\uff1f\n\n+ A\uff1a\u56e0\u4e3a\u6211\u628a0\u70b9\u5f53\u505a\u4e86\u4e00\u4e2a\u5fc5\u9009\u7684\u70b9\uff0c\u8fd9\u6837\u53ef\u4ee5\u76f4\u63a5\u4ece0\u8bbf\u95ee\u5230\u5404\u68ee\u6797\u7684\u6839\n\n\n+ Q\uff1a\u697c\u4e0a\u9898\u89e3\u7684\u538b\u7ef4\u662f\u4ec0\u4e48\u610f\u601d\uff1f\u6ca1\u770b\u61c2...\n\n+ A\uff1a\u56e0\u4e3a\u662f\u5206\u7ec4\u80cc\u5305\u554a\uff0c\u6700\u4f18\u89e3\u5206\u7ec4\u80cc\u5305\u53ef\u4ee5\u538b\u7ef4\uff0c\u65b9\u6848\u6570\u5206\u7ec4\u80cc\u5305\u4e0d\u80fd\u538b\u7ef4\uff0c\u81ea\u5df1\u8bd5\u8bd5\u5c31\u660e\u767d\u4e86\uff0c~~\u6211\u6d4b\u8bd5\u4e86\u4e00\u4e0b\u5348~~\uff0c\u8bdd\u8bf4\u5982\u679c\u6709\u4eba\u4f1a\u65b9\u6848\u6570\u5206\u7ec4\u80cc\u5305\u7684\u538b\u7ef4\uff0c\u8bf7\u52a1\u5fc5@\u6211\u4e00\u4e0b\n\n\u60f3\u60f3\u8fd8\u662f\u653e\u4e00\u4e0bAC\u4ee3\u7801\u5427\n\n[~~\u987a\u4fbf\u5ba3\u4f20\u4e00\u6ce2\u6211\u7684\u535a\u5ba2~~](https://blog.csdn.net/qq_40828060/article/details/83064425#P2409_Y_300)\n```\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nint const maxn=324,maxm=324;\nstruct E\n{\n    int to,next;\n    E(int to=0,int next=0):\n        to(to),next(next){}\n}e[maxn];\nint head[maxn],cnt;\ninline void add(int u,int v)\n{\n    e[++cnt]=(E){v,head[u]};\n    head[u]=cnt;\n}\nint n,V;\nint f[maxn][maxm];\nvoid dfs(int u)\n{\n    for(int i=head[u];i;i=e[i].next)\n    //\u6bcf\u4e00\u7ec4\n    {\n        int v=e[i].to;\n        dfs(v);\n        for(int j=V+1;j>=1;j--)\n        //\u5f53\u524d\u603b\u4f53\u79ef:V+1!!!\n            for(int k=0;k<j;k++)\n            //\u7ec4\u5185\u7269\u54c1\n                f[u][j]=std::max(f[u][j],f[u][j-k]+f[v][k]);\n    }\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&V);\n    memset(f,0xcf,sizeof(f));\n    for(int i=1;i<=V+1;i++)\n        f[0][i]=0;\n    //\u8fd9\u9898\u4f3c\u4e4e\u6ca1\u6709\u7528\uff0c\u4f46\u6bd5\u7adf\u662f\u4e2a\u53ef\u884c\u6027\u80cc\u5305\u95ee\u9898\uff0c\u52a0\u4e0a\u5427 \n    for(int u,i=1;i<=n;i++)\n        scanf(\"%d%d\",&u,&f[i][1]),add(u,i);\n    dfs(0);\n    printf(\"%d\",f[0][V+1]);\n    return 0;\n}\n```",
        "postTime": 1541572660,
        "uid": 55868,
        "name": "Panthera_AFO",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u849f\u84bb\u535a\u5ba2\u4f20\u9001\u95e8\uff1a[QAQ](https://www.cnblogs.com/GoldenPotato/p/9440154.html)\n\n\n------------\n\n\n### Solution\n\n\u8fd9\u662f\u4e00\u9053\u5341\u5206\u7ecf\u5178\u7684\u6811\u5f62DP\u9898\uff0c\u8fd9\u79cd\u7c7b\u578b\u7684\u6811\u5f62DP\u6709\u4e00\u79cd\u5f88\u666e\u904d\u7684\u89e3\u6cd5\u3002\n\n.\n\n\n \n\n\u9996\u5148\uff0c\u89c2\u5bdf\u9898\u76ee\uff0c\u6211\u4eec\u628a\u8fd9\u9053\u9898\u8f6c\u6362\u4e00\u4e0b\uff1a**\u7ed9\u5b9a\u4e00\u9897\u6811\uff0c\u9009\u51fa\u5305\u542b1\u53f7\u8282\u70b9\uff08\u6839)\u7684\u4e00\u9897\u5b50\u6811\uff0c\u4f7f\u5f97\u70b9\u6743\u548c\u6700\u5927**\u3002\n\n.\n\n\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u5b50\u5b9a\u4e49\u72b6\u6001\uff1a\n\n\u8bbe**f[i][j] \u8868\u793a\u4ee5i\u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\uff0c\u9009\u51faj\u4e2a\u8282\u70b9\uff0c\u6240\u80fd\u8fbe\u5230\u7684\u6700\u5927\u70b9\u6743\u503c\u3002**\n\n.\n\n\u5bf9\u4e8e\u4e8c\u53c9\u6811\u6765\u8bf4\uff0c\u8f6c\u79fb\u5f88\u663e\u7136\uff0c\u5c31\u662f\u679a\u4e3e\u5de6\u5b50\u6811\u5206\u914d\u591a\u5c11\u4e2a\u8282\u70b9\uff0c\u5c31\u53ef\u4ee5\u5bf9\u5e94\u7684\u5f97\u51fa\u53f3\u5b50\u6811\u80fd\u5206\u914d\u5230\u591a\u5c11\u4e2a\u8282\u70b9\uff0c\u5bf9\u6240\u6709\u60c5\u51b5\u53d6\u6700\u5927\u503c\u5c31\u597d\u3002\n\n\u5bf9\u4e8e\u591a\u53c9\u6811\u6765\u8bf4\uff0c\u95ee\u9898\u5c31\u6ca1\u6709\u90a3\u4e48\u7b80\u5355\u4e86\uff0c\u8fd9\u91cc\uff0c\u6211\u4eec\u6709\u4e24\u4e2a\u65b9\u6848\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a\n\n1. **\u591a\u53c9\u6811\u8f6c\u4e8c\u53c9\u6811**\uff0c\n\n2. **\u6811\u4e0a\u80cc\u5305**\u3002\n\n \n\n~~\u56e0\u4e3a\u6211\u4e0d\u4f1a\u591a\u53c9\u6811\u8f6c\u4e8c\u53c9\u6811~~\uff0c\u6240\u4ee5\u5728\u8fd9\u91cc\u6211\u4e3b\u8981\u8bb2\u4e00\u8bb2\u7b2c\u4e8c\u79cd\u65b9\u6cd5\u3002\n\n.\n\n\n\u6211\u4eec\u5728\u6811\u4e0a\u505a\u80cc\u5305**\u672c\u8d28\u4e0a\u4e00\u822c\u662f\u591a\u91cd\u80cc\u5305\u95ee\u9898**\u3002\n\n\u6211\u4ee5\u672c\u9898\u4e3a\u4f8b\u5b50\uff0c\u8bb2\u4e00\u4e0b\u6811\u4e0a\u5982\u4f55\u505a\u591a\u91cd\u80cc\u5305\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u80af\u5b9a\u8981**\u4e00\u5c42\u5faa\u73af\u679a\u4e3e\u5b50\u6811(\u53ef\u4ee5\u7c7b\u4f3c\u4e3a\u80cc\u5305\u95ee\u9898\u4e2d\u679a\u4e3e\u7b2c\u51e0\u4ef6\u7269\u54c1)\u3002**\n\n**\u7b2c\u4e8c\u5c42\u5faa\u73af\u6211\u4eec\u5f97\u679a\u4e3e\u5f53\u524d\u4ee5\u8282\u70b9\u7684\u5b50\u6811\u80fd\u5206\u914d\u7684\u8282\u70b9\u6570\uff08\u53ef\u4ee5\u7c7b\u4f3c\u4e3a\u80cc\u5305\u95ee\u9898\u4e2d\u679a\u4e3e\u80cc\u5305\u5bb9\u91cf\uff09**\n\n **\u8fd9\u4e00\u5c42\u5faa\u73af\u4e00\u5b9a\u8981\u4ece\u540e\u5f80\u524d\u679a\u4e3e\uff0c\u7c7b\u4f3c\u4e0e\u80cc\u5305\u538b\u5728\u4e00\u7ef4\u505a\u7684\u505a\u6cd5** \n\n**\u7b2c\u4e09\u5c42\u5faa\u73af\u6211\u4eec\u5c31\u53ef\u4ee5\u679a\u4e3e\u5f53\u524d\u5b50\u6811\u5206\u914d\u591a\u5c11\u4e2a\u8282\u70b9\u4e86\uff08\u53ef\u4ee5\u7c7b\u4f3c\u591a\u91cd\u80cc\u5305\u4e2d\u679a\u4e3e\u7b2ci\u4ef6\u7269\u54c1\u8981\u51e0\u4ef6\uff09**\n\n\u4e0b\u9762\u662f\u8fd9\u79cd\u679a\u4e3e\u5728\u8fd9\u9053\u9898\u5e94\u7528\u7684\u4ee3\u7801\uff1a\n```cpp\n\n     for(int i=0;i<int(e[x].size());i++)//\u679a\u4e3e\u5b50\u6811\n     {\n         int temp=dfs(e[x][i]);//\u5148\u628a\u5b50\u6811\u7684f\u9012\u5f52\u4e0b\u53bb\u7b97\u51fa\u6765\n         tot+=temp;//tot\u8bb0\u5f55\u5230\u5f53\u524d\u5b50\u6811\u4e3a\u6b62\u603b\u8282\u70b9\u6570\n         for(int j=tot;j>=1;j--)//\u679a\u4e3e\u81ea\u5df1\u8fd9\u9897\u6811\u7684\u603b\u5206\u914d\u6570\n            for(int k=0;k<=temp;k++)//\u679a\u4e3e\u5b50\u6811\u5206\u914d\u591a\u5c11\u4e2a\u8282\u70b9\n                if(j-k>=1)\n                     f[x][j]=max(f[x][j],f[x][j-k]+f[e[x][i]][k]);\n     }\n\n```\n\n .\n\n\u6811\u4e0a\u80cc\u5305\u4e00\u822c\u770b\u4e0a\u53bb\u662f\u4e09\u91cd\u5faa\u73af\uff0c\u975e\u5e38\u6050\u6016\u3002\n\n\u4f46\u4e8b\u5b9e\u4e0a\uff0c\u6839\u636e\u4e00\u5806\u8bc1\u660e~~\uff08\u4e0d\u4f1a\u8bc1\uff09~~\uff0c\u5176\u590d\u6742\u5ea6\u4e3a\u4e24\u91cd\u5faa\u73af\u3002\n\n~~\u6240\u4ee5\u590d\u6742\u5ea6\u5e94\u8be5\u662fO\uff08\u80fd\u8fc7\uff09~~\n\n**\u590d\u6742\u5ea6\u662fO(N^2xM)**\n\n\n\n------------\n\n### Code\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<vector>\nusing namespace std;\nlong long read()\n{\n    long long x=0,f=1;char c=getchar();\n    while(!isdigit(c)){if(c=='-') f=-1;c=getchar();}\n    while(isdigit(c)){x=x*10+c-'0';c=getchar();}\n    return x*f;\n}\nconst int N=300+10;\nvector <int> e[N];\nlong long n,m,f[N][N],v[N];\nint dfs(int x)\n{\n    int tot=1;\n    f[x][1]=v[x];\n    for(int i=0;i<int(e[x].size());i++)\n    {\n        int temp=dfs(e[x][i]);\n        tot+=temp;\n        for(int j=tot;j>=1;j--)\n            for(int k=0;k<=temp;k++)\n                if(j-k>=1)\n                    f[x][j]=max(f[x][j],f[x][j-k]+f[e[x][i]][k]);\n    }\n    return tot;\n}\nint main()\n{\n    n=read(),m=read();\n    for(int i=0;i<=n;i++)\n        e[i].reserve(4);\n    for(int i=1;i<=n;i++)\n    {\n        e[read()].push_back(i);\n        v[i]=read();\n    }\n    \n    dfs(0);\n    \n    printf(\"%lld\",f[0][m+1]);\n    return 0;\n}\n\n```\n",
        "postTime": 1533655222,
        "uid": 52563,
        "name": "GoldenPotato137",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u770b\u4e86\u697c\u4e0b\u5927\u795e\u7684\u9898\u89e3\u611f\u89c9\u4f1a\u4e86\u597d\u591a\uff0c\u4e5f\u6765\u53d1\u4e00\u4e2a\u3002\n\n\u6211\u4eec\u77e5\u9053\u505a\u6811\u578b\u52a8\u89c4\u65f6\uff0c\u4e8c\u53c9\u6811\u8981\u6bd4\u591a\u53c9\u6811\u8981\u597d\u5199\u65b9\u7a0b\uff0c\u6240\u4ee5\u6211\u5c31\u7528\u4e8c\u53c9\u6811\u505a\u4e86\u3002\n\n\u8f6c\u6362\u6210\u4e8c\u53c9\u6811\u540e\uff0c\u601d\u8def\u5176\u5b9e\u548c\u4e8c\u53c9\u82f9\u679c\u6811\u5c31\u6709\u70b9\u7c7b\u4f3c\u4e86\u3002\u5206\u4e09\u79cd\u60c5\u51b5\n\n1.\u53ea\u6709\u513f\u5b50\u90092.\u53ea\u6709\u5144\u5f1f\u90093.\u65e2\u6709\u513f\u5b50\u9009\u4e5f\u6709\u5144\u5f1f\u9009\n\n\u5bf9\u4e8e\u7b2c\u4e09\u79cd\u60c5\u51b5\u76f4\u63a5\u679a\u4e3e\u9009\u591a\u5c11\u5c31\u884c\u4e86\u3002\n\n\u8fd8\u6709\uff0c\u7531\u4e8e\u672c\u9898\u7684\u56fe\u5f62\u662f\u4e00\u4e2a\u68ee\u6797\uff08\u597d\u591a\u6811\u7684\u96c6\u5408\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u865a\u62df\u7684\u6839\u8282\u70b9\uff0c\u628a\u5b83\u8f6c\u5316\u4e3a\u4e00\u68f5\u6811\u5c31OK\u4e86\u3002f[i][j]\u8868\u793a\u4ee5i\u4e3a\u6839\u7684\u5b50\u6811\u9009j\u4e2a\u7684\u6700\u4f18\u503c\u3002\n\n```cpp\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<algorithm>\n#include<cctype>\nusing namespace std;\ninline void read(int &x){\n    int f=1; x=0; char ch=getchar();\n    while(!isdigit(ch)){if(ch=='-') f=-1; ch=getchar();}\n    while(isdigit(ch)){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n    x= f<0? ~x+1:x;\n}\nint n,m;\nint w[305],b[305],c[305],f[305][305];\nvoid dfs(int x,int v){\n    if(f[x][v]>=0) return;//\u8bb0\u5fc6\u5316\u641c\u7d22\n    if(x==0||v==0) {f[x][v]=0; return;}\n    dfs(b[x],v); f[x][v]=max(f[x][v],f[b[x]][v]);//\u53ea\u6709\u5144\u5f1f\u9009\u7684\u60c5\u51b5\n    for(int i=0;i<v;++i){//\u5f53i==0\u65f6\u662f\u53ea\u6709\u513f\u5b50\u9009\u7684\u60c5\u51b5\n        dfs(c[x],v-i-1);//\u65e2\u6709\u5144\u5f1f\u53c8\u6709\u513f\u5b50\u9009\n        dfs(b[x],i);\n        f[x][v]=max(f[x][v],f[b[x]][i]+f[c[x]][v-i-1]+w[x]);\n    }\n}        \nint main(){\n    read(n);read(m);\n    int fa;\n    for(int i=1;i<=n;++i){\n        read(fa); read(w[i]);\n        if(fa==0) fa=n+1;\n        b[i]=c[fa];//\u7528\u7c7b\u4f3c\u50a8\u5b58\u94fe\u5f0f\u524d\u5411\u661f\u7684\u65b9\u6cd5\n        c[fa]=i;//\u5c06\u591a\u53c9\u6811\u8f6c\u6362\u4e3a\u4e8c\u53c9\u6811\n    }\n    memset(f,-1,sizeof(f));\n    dfs(c[n+1],m);\n    printf(\"%d\\n\",f[c[n+1]][m]);\n    return 0;\n}\n```",
        "postTime": 1508330208,
        "uid": 35647,
        "name": "huihao",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u662f\u4e00\u4e2a\u975e\u5e38\u660e\u663e\u7684\u6811\u5f62dp\uff0c\u5efa\u8bae\u548c\u52a0\u5206\u4e8c\u53c9\u6811\uff0c\u6709\u7ebf\u7535\u89c6\u7f51\u4e00\u8d77\u5199\u4e00\u4e0b\uff1b\n\n\u8fd9\u9053\u9898\u6709\u4e00\u4e2a\u7ec6\u8282\u9700\u8981\u6ce8\u610f\u4e00\u4e0b\uff0c\u6211\u662f\u8bbe\u4e00\u4e2a\u865a\u68390\uff0c\u6240\u6709\u7684\u4e3b\u8bfe\uff08\u7236\u4eb2\u8282\u70b9\u662f\u865a\u6839\u7684\u8282\u70b9\uff09\u90fd\u4e0e\u865a\u6839\u76f8\u8fde\uff0c\u4f7fm+1\uff1b\n\n\u5927\u6982\u601d\u8def\u662f\u5efa\u6811\uff08dfs\uff09\u7684\u65f6\u5019\u5904\u7406\u597df[i][j]\u6570\u7ec4\uff08\u9009i\u548c\u5176\u513f\u5b50\u5171j\u8282\uff09\n\n\u6700\u540e\u6c42\u51faf\u30100\u3011\u3010m\u3011\uff1b\n\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5982\u4e0b\n\n for(int j=m;j>=1;j--)\n\n  for(int k=0;k<j;k++)\n\n  f[u][j]=max(f[u][j],f[u][j-k]+f[v][k]);//f\u3010u\u3011\u3010j\u3011\u4e3a\u5b83\u513f\u5b50v\u9009k\u8282\u518d\u52a0\u4e0au\u7684\u5176\u4ed6\u513f\u5b50\u9009j-k\u8282\u7684\u6700\u5927\u503c\n\n\u9644\u4e0a\u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<vector>\nusing namespace std;\nconst int maxn=300+10;\nint f[maxn][maxn],s[maxn]={0};//s\u6570\u7ec4\u5b58\u7684\u662f\u9009\u67d0\u8282\u8bfe\u53ef\u4ee5\u7ed9\u7684\u503c\uff1b\nint n,m;\nvector<int>g[maxn];//\u5b58\u6811\u7528\u7684g\u6570\u7ec4\nvoid dfs(int u){\n    int x=g[u].size();\n    f[u][0]=0;//\u4ec0\u4e48\u8bfe\u90fd\u4e0d\u9009\u5373\u4e3a0\n    for(int i=0;i<x;i++)\n    {\n        int v=g[u][i];\n        dfs(v);\n        for(int j=m;j>=1;j--)\n        for(int k=0;k<j;k++)\n        f[u][j]=max(f[u][j],f[u][j-k]+f[v][k]);//\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\n    }\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n;i++)\n    for(int j=1;j<=m;j++)\n    {\n    f[i][j]=-10086;//\u521d\u59cb\u5316\n    }\n    for(int i=1;i<=n;i++)\n    {\n        int a;\n        scanf(\"%d%d\",&a,&s[i]);\n        g[a].push_back(i); //\u5b58\u56fe\n        f[i][1]=s[i]; //F[I][1]\u5373\u4e3a\u53ea\u9009i\u4e0d\u9009\u5176\u5b50\u8282\u70b9\uff0c\u7b49\u4e8eS[I]\uff1b\n    }\n    //f[0][1]=0;\n    m++;//\u865a\u6839\u64cd\u4f5c=v=\uff0c\u597d\u50cf\u5f88\u9ad8\u5927\u4e0a\uff0c\u5176\u5b9e\u5c31\u4e00\u53e5\u8bdd\n    dfs(0);//dfs\u7684\u540c\u65f6\u5904\u7406\u597df\u6570\u7ec4\n    printf(\"%d\",f[0][m]);\n}\n//\u849f\u84bb\u5199\u7684\u9898\u89e3\uff0c\u5e0c\u671b\u5bf9\u4f60\u4eec\u6709\u5e2e\u52a9\n```",
        "postTime": 1506084847,
        "uid": 43601,
        "name": "\u56e7\u4eba232",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "## \u80cc\u666f\n\n\u5728\u6d4f\u89c8\u9898\u89e3\u7684\u65f6\u5019\u770b\u5230\u8fd9\u4e48\u4e00\u53e5\u8bdd:\u201c\u597d\u591a\u4eba\u8fd9\u9898\u7528\u591a\u53c9\u8f6c\u4e8c\u53c9\u554a\uff0c\u5c31\u6211\u7528\u6811\u5f62DP\u5f3a\u884c\u4e48\u3002\u3002\u3002\u201d \uff08\u9ed1\u4eba\u95ee\u53f7\uff1f\uff1f\uff09 \u6211\u600e\u4e48\u6ca1\u770b\u51fa\u6709\u4eba\u7528\u4e86\u591a\u53c9\u8f6c\u4e8c\u53c9\uff08\u8fd8\u6709\u542c\u8bf4\u90a3\u4e2a\u4eba\u672c\u8d28\u4e0a\u5176\u5b9e\u7528\u7684\u4e5f\u662f\u5de6\u513f\u5b50\u53f3\u5144\u5f1f\u8868\u793a\u6cd5\uff09\uff1f \u7136\u540e\u8001\u5e08\u7ed9\u7684\u9898\u6211\u53c8\u505a\u4e0d\u51fa\u6765\uff0c\u5c31\u53ea\u80fd\u4e3a\u4e86\u8017\u65f6\u95f4\u6765\u53d1\u9898\u89e3\u4e86 qwq \uff08\u6342\u8138\u54ed\uff09\u3002\n\n# \u6b63\u6587\uff1a\n\n## \u5206\u6790\uff1a\n\u540c\u6837\uff0c\u8fd9\u9053\u9898\u76ee\u7ed9\u51fa\u7684\u6570\u636e\u662f\u4ee5\u6811\u5f62\u7ed3\u6784\u8fde\u63a5\u7684\u3002\n\n\u8fd9\u9898\u6bd4[\u82f9\u679c\u6811](https://www.luogu.org/problemnew/show/P2015)\uff08\u9898\u76ee\u4f20\u9001\u95e8\uff09\u591a\u4e86\u4e00\u4e2a\u6b65\u9aa4\u5c31\u662f**\u628a\u4e00\u68f5\u591a\u53c9\u6811\u8f6c\u5316\u4e3a\u4e8c\u53c9\u6811**\u3002\n\n\u8bfb\u5165\u6570\u636e\u65f6\u628a\u4e8c\u53c9\u6811\u5efa\u597d\uff1a\u628a\u4e00\u95e8\u8bfe\u7684\u5148\u4fee\u8bfe\u4f5c\u4e3a\u5b83\u7684\u7236\u4eb2\u3002**\u4e00\u4e2a\u7ed3\u70b9\u7684\u7b2c\u4e00\u4e2a\u5b69\u5b50\u4f5c\u4e3a\u81ea\u5df1\u7684\u5de6\u5b50\u6811\uff0c\u5176\u5b83\u5b69\u5b50\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u5b69\u5b50\u7684\u6700\u53f3\u6811\u679d\u94fe\uff0c\u5373\u5206\u522b\u505a\u7b2c\u4e00\u4e2a\u5b69\u5b50\u7684\u53f3\u513f\u5b50\u3001\u53f3\u513f\u5b50\u7684\u53f3\u513f\u5b50\u2026\u2026\uff08\u5de6\u513f\u5b50\u53f3\u5144\u5f1f\u8868\u793a\u6cd5\uff09\u3002** \u5982\u4e0b\u56fe\uff08\u56fe\u6e90\uff1a\u221e\u2211\u7684CSDN\u535a\u5ba2\uff09\uff1a\n![1](https://i.loli.net/2019/07/24/5d3855359740521231.png)\n\n# **-->**\n![2](https://i.loli.net/2019/07/24/5d38556b5165196910.png)\n\n# **-->**\n![3](https://i.loli.net/2019/07/24/5d38558e4080912136.png)\n\n# **-->**\n![4](https://i.loli.net/2019/07/24/5d385612be86b73758.png)\n\n\u56e0\u4e3a\u8fd9\u9053\u9898\u8fd8\u6709\u53ef\u80fd\u51fa\u73b0\u68ee\u6797\uff0c\u6240\u4ee5\u9700\u8981\u8bbe\u4e00\u4e2a\u865a\u68390\u7136\u540e\u7528m+1\u6765dp\n\n\u6b63\u597d\u8fd9\u9053\u9898\u8f93\u5165\u67090\uff0c\u53ef\u4ee5\u5c06\u9898\u5c31\u9898\u3002\n\n# **-->**\n![5](https://i.loli.net/2019/07/24/5d3856da7d77342715.png)\n\n\uff08\u5410\u69fd\u4e00\u4e0b\uff0c\u5b9e\u9645\u64cd\u4f5c\u7684\u65f6\u5019\u8fd8\u8981\u628a\u7b2c\u4e00\u4e2a\u56fe\u4e2d\u56fe\u4e2d\u7b2c\u4e00\u4e2a\u6839\u8282\u70b9\u8fde\u5230\u865a\u68390\u4f5c\u4e3a\u5176\u5de6\u513f\u5b50\uff09\n## \u72b6\u6001\u7684\u786e\u5b9a\uff1a\ndp[x][y]\uff1a\u8868\u793a\u8282\u70b9x\u53d6y\u95e8\u8bfe\u5f97\u6700\u9ad8\u5b66\u5206\uff0c\u5219\n\ndp[x][y]=max{dp[x.r][y], dp[x.l][k-1]+x.v+dp[x.r,y-k]|k=1,2,..y}\n\ndp[x.r][y]\uff1a\u8868\u793a\u4e0d\u9009\u8bfe\u7a0bx\uff0c\u53f3\u5b69\u5b50\u9009k\u95e8\u8bfe\u3002\n\ndp[x.l][k-1]+x.v(\u8bfe\u7a0bx\u7684\u5b66\u5206) \uff1a\u8868\u793a\u9009\u4e86\u8bfe\u7a0bx,\u5de6\u5b69\u5b50\u9009k-1\u95e8\u8bfe,\u5171k\u95e8\u8bfe\u3002\n\ndp[x.r,y-k]\u8868\u793a\u53f3\u5b69\u5b50\u53ea\u80fd\u9009y-k\u95e8\u8bfe\u3002\n\n\u6807\u7a0b\u4e2d\u8282\u70b9-1\u8868\u793a\u7a7a\u8282\u70b9\uff0c0\u662f\u6839\u8282\u70b9\uff0c1-n\u662fn\u95e8\u53ef\u9009\u8bfe\u7a0b\u7684\u8282\u70b9\u3002\n\n## \u4ee3\u7801\n\u8fd9\u4e9b\u90fd\u5e72\u5b8c\u4e86\u5f53\u7136\u662f\u8981\u5199\u4ee3\u7801\u554a ~~\uff08\u5174\u594b\uff09~~ \uff01\uff01\uff01\n\n\u65b0\u4ebaOIer\u602f\u602f\u5730\u653e\u4e0a\u4e86\u81ea\u5df1\u7684\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\nusing namespace std;\nint n,m;\nstruct node{\n\tint lson,rson;\n}a[305];\nbool gotson[305];\nint dp[305][305],s[305];\nvoid DP(int rc,int rm)\n{//if\u4e00\u5b9a\u8981\u6253\uff0c\u8981\u4e0d\u7136\u4f1a\u56de\u5230\u865a\u6839\u5bfc\u81f4dp\u9519\u8bef\n\tif(dp[rc][rm]) return;\n\tif(a[rc].rson)\n\tDP(a[rc].rson,rm);\n\tdp[rc][rm]=dp[a[rc].rson][rm];\n\tfor(int k=1;k<=rm;k++){\n\t\tif(a[rc].lson)\n\t\tDP(a[rc].lson,k-1);\n\t\tif(a[rc].rson)\n\t\tDP(a[rc].rson,rm-k);\n\t\tdp[rc][rm]=max(dp[rc][rm],dp[a[rc].lson][k-1]+dp[a[rc].rson][rm-k]+s[rc]);\n\t}\n\t\n}\nint main(void)\n{\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1,k;i<=n;++i)\n\t{\n\t\tscanf(\"%d%d\",&k,s+i);\n\t\tif(gotson[k])\n\t\t{\n\t\t\tk=a[k].lson;\n\t\t\twhile(a[k].rson) k=a[k].rson;//\u627e\u6700\u6df1\u7684\u53f3\u513f\u5b50\n\t\t\ta[k].rson=i;\n\t\t}\n\t\telse {\n\t\t\tgotson[k]=1;a[k].lson=i;\n\t\t}//\u591a\u53c9\u8f6c\u4e8c\u53c9\u6811\n\t}\n\tDP(0,m+1);\n\tprintf(\"%d\",dp[0][m+1]);\n}\n```\n~~\u770b\u6765\u849f\u84bb\u65e0\u8bba\u5982\u4f55\u4e5f\u4e0d\u80fd\u9003\u907f\u8001\u5e08\u7684\u9898\u76ee\u4e86 qwq~~\n\n\u5168\u6587\u7ec8\u3002",
        "postTime": 1563972544,
        "uid": 131735,
        "name": "Jade_Lover",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "- \u524d\u8a00\n\n\t\u8fd9\u9898\u662f\u4e00\u9053\u80cc\u5305\u7c7b\u6811\u5f62DP\n\n\t\n------------\n\n - \u601d\u8def\n\t\n\n    \u4f9d\u9898\u610f\uff1a\n    \n    \u6bcf\u95e8\u8bfe\u7684\u5148\u4fee\u8bfe\u6700\u591a\u53ea\u6709\u4e00\u95e8\u3002\u4f46\u6709\u53ef\u80fd\u6709\u591a\u95e8\u8bfe\u6709\u76f8\u540c\u7684\u4e00\u95e8\u5148\u4fee\u8bfe\u3002\u6240\u4ee5\u6211\u4eec\u9700\u5efa\u4e00\u4e2a\u201c\u4f2a\u8282\u70b9\u201d\u2014\u20140\u8282\u70b9\u4f5c\u4e3a\u6839\u8282\u70b9\uff0c\u8fde\u63a5\u6ca1\u6709\u5148\u4fee\u8bfe\u7684\u8bfe\u7a0b\uff0c\u4f5c\u4e3a\u5b83\u4eec\u7684\u5148\u4fee\u8bfe\u3002\n    \n    \u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n    \n    \u8bbef[i][j] \u4e3a\u4ee5i\u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\u4e2d\u9009j\u95e8\u8bfe\u80fd\u83b7\u5f97\u7684\u6700\u591a\u5b66\u5206\u3002\n    \n\n- Code\uff1a\n------------\n```cpp#include<cstdio>\n    #include<iostream>\n    #include<cstring>\n    #include<vector>\n    using namespace std;\n    int n,m,x,s[350];\n    int f[350][350];\n    int son[350][350],cnt[350];\n    void DP(int x){\n        f[x][0]=0;\n        int p=cnt[x];\n        for(int i=0;i<p;i++){//\u5148\u7b97\u51fa\u4e0d\u52a0\u4e0a\u7b2cx\u95e8\u8bfe\u7684\u5b66\u5206\n            int k=son[x][i];\n            DP(k);\n            for(int t=m;t>=0;t--)//\u80cc\u5305\u5012\u5e8f\u5faa\u73af\n                for(int l=t;l>=0;l--)\n                    f[x][t]=max(f[x][t],f[x][t-l]+f[k][l]);\n        }\n        if(x!=0)//\u5982\u679c\u4e0d\u4e3a0\u8282\u70b9\uff0c\u4e5f\u5c31\u662f\u865a\u62df\u6839\u8282\u70b9\u65f6\n            for(int i=m;i>0;i--)//\u8fd8\u8981\u52a0\u4e0a\u8fd9\u95e8\u8bfe\u7684\u5b66\u5206\n                f[x][i]=f[x][i-1]+s[x];\n    }\n    int main(){\n        memset(f,0xcf,sizeof(f));//\u628af\u6570\u7ec4\u521d\u59cb\u6210\u4e00\u4e2a\u5f88\u5c0f\u7684\u6570\n        scanf(\"%d %d\",&n,&m);\n        for(int i=1;i<=n;i++){\n            scanf(\"%d %d\",&x,&s[i]);\n            son[x][cnt[x]++]=i;//\u5b58x\u7684\u513f\u5b50\u8282\u70b9\n        }\n        DP(0);\n        printf(\"%d \",f[0][m]);\n        return 0;\n    }\n```\n\n    \n------------\n- \u540e\u8bb0\n\n\t\u672c\u6587\u90e8\u5206\u6458\u81ea\u84dd\u4e66\uff0c\u4e14\u672c\u4eba\u601d\u8def\u81ea\u84dd\u4e66\u3002\n    \n   [\u65e0\u803b\u5730\u5b89\u5229blog](https://www.luogu.org/blog/2713840045cheng/)\n  \t",
        "postTime": 1562730628,
        "uid": 114791,
        "name": "D\u611a\u8005",
        "ccfLevel": 0,
        "title": "P2014 \u9009\u8bfe"
    },
    {
        "content": "\u6bcf\u4e00\u95e8\u8bfe\u90fd\u53ea\u6709\u4e00\u4e2a\u5148\u4fee\u8bfe\uff0c\u6240\u4ee5\u8fd9\u5176\u5b9e\u662f\u4e00\u4e2a\u65e0\u5411\u65e0\u73af\u56fe\uff08\u4e5f\u5c31\u662f\u68ee\u6797\u5566\uff09\uff1b\u6240\u4ee5\uff0c\u6574\u4e2a\u95ee\u9898\u5c31\u53d8\u6210\u4e86\uff1a\u5df2\u77e5\u4e00\u4e2a\u68ee\u6797\uff0c\u6bcf\u4e2a\u8282\u70b9\u90fd\u6709\u4e00\u4e2a\u6743\uff0c\u9009\u62e9\u4e00\u4e2a\u8282\u70b9\u5fc5\u987b\u9009\u62e9\u5b83\u7684\u6839\u8282\u70b9\uff0c\u6c42\u9009\u62e9m\u4e2a\u8282\u70b9\u7684\u6700\u4f18\u89e3\u3002\n\n\u6811\u72b6DP\uff1f\u662f\u7684\uff01\u90a3\u4e48\uff0c\u552f\u4e00\u7684\u95ee\u9898\u5c31\u662f\u5982\u4f55\u628a\u4e00\u4e2a\u68ee\u6797\u8f6c\u5316\u6210\u4e00\u4e2a\u4e8c\u53c9\u6811\u3002\n\n\u9996\u5148\uff0c\u589e\u52a0\u4e00\u4e2a\u603b\u6839\uff080\u8282\u70b9\uff09\uff0c\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9\uff0c\u8bb0\u5f55\u4e24\u4e2a\u6307\u9488\uff0cson\u548cbrother\uff08\u5f53\u7136\u4e5f\u53ef\u4ee5\u7528left\u548cright\uff09\uff1b\u5b83\u7684\u6700\u5de6\u513f\u5b50\u548c\u53f3\u5144\u5f1f\u3002\u7136\u540e\u505a\u6811\u72b6DP\u5373\u53ef\u3002\u4f46\u662f\u8981\u6ce8\u610f\u4e00\u4e2a\u7279\u6b8a\u60c5\u51b5\uff1a\u56e0\u4e3abrother\u662f\u5b83\u7684\u5144\u5f1f\uff0c\u6240\u4ee5\u53ef\u4ee5\u4e0d\u9009\u5b83\u672c\u8eab\uff0c\u53ea\u9009brother\u3002\n\n\u63a5\u4e0b\u6765\u5c31\u5f88\u7b80\u5355\u5566~~~\n\npascal\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```pascal\ntype\n  node=record\n    s,b,x:integer\n  end;\nvar\n  tree:array[0..300] of node;  //\u8bb0\u5f55\u6574\u68f5\u6811\n  f:array[0..300,0..301] of integer;  //\u8bb0\u5f55\u7ed3\u679c\n  n,m,i,a,b:integer;\nfunction max(a,b:integer):integer;\n  begin\n    if a>b then exit(a)\n    else exit(b)\n  end;\nfunction dp(root,q:integer):integer;  //root\u662f\u5f53\u524d\u8282\u70b9\uff0cq\u662f\u9009\u7684\u8282\u70b9\u6570\n  var\n    i,s:integer;\n  begin\n    if f[root,q]>0 then exit(f[root,q]);\n    if q=0 then exit(0);\n    if tree[root].s=0 then if tree[root].b=0 then f[root,q]:=tree[root].x\n    else f[root,q]:=max(dp(tree[root].b,q-1)+tree[root].x,dp(tree[root].b,q))\n    else if tree[root].b=0 then f[root,q]:=dp(tree[root].s,q-1)+tree[root].x  //\u7279\u5224\n    else begin\n      s:=0;\n      for i:=0 to q-1 do s:=max(s,dp(tree[root].s,i)+dp(tree[root].b,q-i-1));\n      inc(s,tree[root].x);\n      s:=max(s,dp(tree[root].b,q));  //\u7279\u6b8a\u60c5\u51b5\n      f[root,q]:=s\n    end;\n    exit(f[root,q])\n  end;\n//\u6811\u72b6DP\uff08\u5176\u5b9e\u662f\u8bb0\u5fc6\u5316\u641c\u7d22\u5b9e\u73b0\uff09\nbegin\n  readln(n,m);\n  fillchar(tree,sizeof(tree),0);\n  for i:=1 to n do begin\n    readln(a,b);\n    if tree[a].s=0 then tree[a].s:=i\n    else begin\n      tree[i].b:=tree[a].s;\n      tree[a].s:=i\n    end;  //\u8fd9\u91cc\u5e76\u6ca1\u6709\u8bb0\u5f55\u6700\u5de6\u513f\u5b50\uff0c\u4e0d\u8fc7\u8282\u7ea6\u4e86\u6548\u7387\uff0c\u800c\u4e14\u6811\u7684\u5f62\u6001\u65e0\u5173\u7d27\u8981\n    tree[i].x:=b\n  end;  //\u521d\u59cb\u5316\n  fillchar(f,sizeof(f),0);\n  write(dp(0,m+1))\nend.\n```",
        "postTime": 1506821517,
        "uid": 57926,
        "name": "Thinking",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "[\u9898\u9762](https://www.luogu.com.cn/problem/P2014)\n\n\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u6211\u4eec\u8003\u8651\u5728\u6811\u5f62dp\u4e0a\u5957\u80cc\u5305\u3002\u6211\u4eec\u4f1a\u975e\u5e38\u81ea\u7136\u7684\u91c7\u7528dfs\u626b\u63cf\u6574\u68f5\u6811\uff0c\u7136\u540e\u5bf9\u6811\u4e0a\u7684\u6bcf\u4e2a\u8282\u70b9\u90fd\u8fdb\u884c\u4e00\u6b21\u80cc\u5305\u3002\n\n\u8ba1$dp[i][j]$\u4e3a\u5728\u4ee5\u7b2c$i$\u53f7\u8282\u70b9\u4e3a\u6839\u7ed3\u70b9\u7684\u5b50\u6811\u4e2d\uff0c\u7528\u9898\u76ee\u4e2d\u9009\u6cd5\u9009\u53d6$j$\u9879\u7684\u6700\u5927\u503c\u3002\n\n\u6211\u4eec\u5728dfs\u7684\u8fc7\u7a0b\u4e2d\uff0c\u91c7\u7528\u9012\u5f52\u7684\u65b9\u5f0f\uff0c\u5728\u5b50\u8282\u70b9\u90fd\u5904\u7406\u5b8c\u4e4b\u540e\uff0c\u4fbf\u8003\u8651\u5c06\u6240\u6709\u5b50\u8282\u70b9\u7684\u7b54\u6848\u7efc\u5408\uff0c\u5f97\u5230\u5f53\u524d\u8282\u70b9\u7684\u7b54\u6848\u3002\n\n\u5f88\u663e\u7136\uff0c\u5c31\u662f\u5728\u5bb9\u91cf\u4e3a$j$\u768401\u80cc\u5305\u4e2d\u653e\u4e0b$i$\u8282\u70b9\u7684\u6240\u6709\u5b50\u8282\u70b9\u80cc\u5305\u4e2d\u7684\u7b54\u6848\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u60f3\u5230\u4e0b\u9762\u7684DP\u65b9\u7a0b\n$$f[x][j]=max(f[to][k]+f[x][j-k])$$\n$x$\u4e3a\u5f53\u524d\u8282\u70b9\uff0c$to$\u4e3a\u5b83\u7684\u67d0\u4e2a\u5b69\u5b50\u8282\u70b9\uff0c$j$\u548c$k$\u662f\u679a\u4e3e\u7684\u4e24\u4e2a\u53d8\u91cf\u3002\n\n\u5c31\u5f97\u5230\u4e86\n```cpp\nfor(int i=0;j<G[x].size();i++){\n\tint to=G[x][i];\n    dfs(to,x);\n    for(int j=m+1;j>=1;j--){\n    \tfor(int k=m;k>=0;k--){\n        \tif(j-k<1) continue;\n            f[x][j]=max(f[x][j],f[to][k]+f[x][j-k]);\n\t\t}\n\t}\n}\n```\n\u6700\u7ec8\u7684\u7b54\u6848\u5c31\u662f$f[0][m+1]$\u4e86\uff0c\u56e0\u4e3a\u6240\u6709\u6ca1\u6709\u524d\u63d0\u6761\u4ef6\u7684\u8bfe\u7a0b\u90fd\u53ef\u4ee5\u6307\u5411$0$\uff0c\u5373\u8ba9\u7b2c$0$\u53f7\u8bfe\u7a0b\u6210\u4e3a\u4ed6\u4eec\u7684\u5148\u51b3\u6761\u4ef6\uff0c\u56e0\u4e3a$0$\u53f7\u8bfe\u7a0b\u81ea\u8eab\u4e5f\u7b97\u4e00\u4e2a\u8bfe\u7a0b\uff0c\u6240\u4ee5\u7b2c\u4e8c\u9879\u5c31\u662f$m+1$\u4e86\n\n## \u4f18\u5316\n\n\u663e\u7136\uff0c\u4e0a\u8ff0\u7b97\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(N*M^2)$,~~\u867d\u7136\u5728\u672c\u9898\u5df2\u7ecf\u53ef\u4ee5\u901a\u8fc7~~\uff0c\u4f46\u662f\u5982\u679c\u6570\u636e\u91cf\u589e\u52a0\u5230$n<=2000$\u65f6\uff0c\u5e94\u8be5\u5982\u4f55\u5e94\u5bf9\n\n\u7531\u4e8e\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8282\u70b9\u4e0a\u7684\u80cc\u5305\uff0c\u6211\u4eec\u6bcf\u4e00\u6b21\u90fd\u679a\u4e3e\u5230\u4e86$m+1$\uff0c\u4f46\u662f\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u5b9e\u9645\u80cc\u5305\u4e00\u822c\u4e0d\u4f1a\u90a3\u4e48\u5927\uff0c\u6240\u4ee5\u5728\u65f6\u95f4\u4e0a\u4f1a\u4ea7\u751f\u5f88\u5927\u7684\u5f00\u9500\u3002\n\n\u8003\u8651\u4e0b\u9762\u7684\u8fd9\u4efd\u4ee3\u7801\n```cpp\nint dfs(int node)\n{\n\tint sum=0;\n\tf[node][1]=cost[node];\n\tfor(int i=0;j<G[x].size();i++){\n\t\tint to=G[node][i];\n        int cnt=dfs(to);\n\t\tsum+=cnt;\n\t\tfor(int j=m+1;j>=1;j--)\n\t\t\tfor(int k=min(cnt,j);k>=0;k--){\n\t\t\t\tif(j<k+1) continue;\n\t\t\t\tf[node][j]=max(f[node][j],f[to][k]+f[node][j-k]);\n\t\t\t}\n\t}\n\tsum++;\n\treturn sum;\n}\n```\n\u7528$sum$\u5b58\u653e\u5f53\u524d\u8282\u70b9\u4e3a\u6839\u7684\u5b50\u6811\u7684\u5927\u5c0f\uff0c\u540c\u65f6dfs\u503c\u4e3a\u5b50\u6811\u5927\u5c0f\u76f4\u63a5\u8fdb\u884c\u4f20\u503c\u3002\n\n\u663e\u7136\u80cc\u5305\u7684\u7b2c\u4e8c\u91cd\u5faa\u73af\u662f\u53ef\u4ee5\u50cf\u8fd9\u6837\u4f18\u5316\u7684\uff0c\u6bd5\u7adf\u5b50\u8282\u70b9\u4ea7\u751f\u7684\u5e8f\u5217\u5927\u5c0f\u4e5f\u624d\u90a3\u4e48\u70b9\uff0c\u8fd9\u6837\u7684\u8bdd\u6574\u4e2a\u5b50\u6811\u4e0a\u7684\u6240\u6709\u60c5\u51b5\u90fd\u53ea\u4f1a\u5728\u8fd9\u4e2a\u8282\u70b9\u4e0a\u4f53\u73b0\u4e00\u6b21\uff08\u663e\u7136\u4e4b\u524d\u7684\u65b9\u6cd5\u5927\u91cf\u5197\u4f59\u7684\u8ba1\u7b97\u4f1a\u4f7f\u5f97\u5b83\u5236\u9020\u7684\u65e0\u7528\u60c5\u51b5\u4f1a\u5927\u5927\u591a\u4e8e\u73b0\u5728\uff09\uff0c\u6240\u4ee5\u6574\u68f5\u6811\u4e00\u5171\u662f$n$\u4e2a\u8282\u70b9\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9\u5b83\u7684\u5b69\u5b50\u7684\u82e5\u5e72\u4e2a$m$\u60c5\u51b5\u53ea\u4f1a\u7ecf\u8fc7\u4e00\u6b21\uff0c\u5e76\u4e14\u5728$O(1)$\u65f6\u95f4\u5185\u76f4\u63a5\u53d6\u51fa\u6bcf\u7ec4\u60c5\u51b5\u6700\u4f18\u503c\uff0c\u6240\u4ee5\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\u7684\u590d\u6742\u5ea6\u662f$O(m)$\u7684\uff0c\u6240\u4ee5\u603b\u7684\u7b97\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u4e3a$O(N*M)$\u4e86\uff0c\u5c31\u53ef\u4ee5\u5bf9\u4ed8\u589e\u5f3a\u540e\u7684\u6570\u636e\u4e86\u3002\n\n[\u5b8c\u6574\u4ee3\u7801](https://www.luogu.com.cn/blog/Kysic-Studio/code-P2014)",
        "postTime": 1579336929,
        "uid": 98482,
        "name": "Macesuted",
        "ccfLevel": 0,
        "title": "P2014"
    },
    {
        "content": "/\\*\u6211\u662f\u5229\u7528\u6811\u5f62dp\u6765\u505a\u7684\u8fd9\u9053\u9898\uff0c\u731b\u7136\u53d1\u73b0\u8fd9\u6bd4\u90a3\u4e2a\u4e8c\u53c9\u6811\u82f9\u679c\u66f4\u52a0\u5bb9\u6613\uff0c\u518d\u5916\u52a0\u4e00\u4e0b\u94fe\u5f0f\u524d\u5411\u661f\u6765\u4f18\u5316\u4e86\u4e00\u4e0b\u7b97\u6cd5\uff08\u6ca1\u6709\u4f7f\u7528\u6307\u9488\uff09\uff0cvoid add\u5176\u5b9e\u5c31\u662f\u6784\u6811\u7684\u8fc7\u7a0b\uff0cu\u4ee3\u8868\u8d77\u70b9\uff0cv\u4ee3\u8868\u7ec8\u70b9\uff0cw\u4ee3\u8868\u8fde\u63a5\u8d77\u70b9\u4e0e\u7ec8\u70b9\u4e4b\u95f4\u8fb9\u7684\u6743\u503c\uff08\u6b64\u9898\u4e3a\u5b66\u5206\uff09\uff0c\u7136\u540e\u5728\u7528dp\u6765\u505a\uff0c\u8fd9\u662f\u8fd9\u4e2a\u9898\u76ee\u6784\u9020\u6811\u7684\u601d\u60f3\uff0c\u987a\u4fbf\u63d0\u4e00\u4e0b\uff0c\u8fd9\u4e2a\u94fe\u5f0f\u524d\u5411\u661f\u662f\u6211\u8ba4\u4e3a\u5f88\u597d\u7684\u65b9\u6cd5\u6765\u6784\u9020\u6811\uff0c\u636e\u8bf4\u4ee5\u540e\u56fe\u4e5f\u4f1a\u7528\u5230\\*/\n\n/\\*\u8fd9\u91cc\u662f\u8bb2\u89e3\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u7684\u7248\u5757\uff0cf[u][j]\u8868\u793a\u6b64\u65f6\u8d70\u5230\u6811\u7684\u7b2cu\u4e2a\u70b9\u5728\u4fdd\u5b58j\u95e8\u8bfe\u4e0b\u7684\u6700\u5927\u5b66\u5206\uff0c\u5176\u4e00\u5b9a\u7b49\u4e8ef[v][k]\uff08\u5b83\u7684\u5b50\u8282\u70b9\u5728k\u95e8\u8bfe\u4e0b\u7684\u6700\u5927\u5b66\u5206\uff09+f[u][j-k-1]\uff08\u5b83\u672c\u8eab\u9664\u53bb\u8fd9\u4e00\u4e2a\u5b50\u8282\u70b9\u5916\u80fd\u591f\u4e0a\u7684\u8bfe\u7684\u95e8\u6811\uff0c\u4e0d\u8981\u5fd8\u8bb0\u5728j-k\u540e\u8fd8\u6709-1\uff0c\u56e0\u4e3a\u5b50\u8282\u70b9\u548c\u7236\u8282\u70b9\u4e4b\u95f4\u4e5f\u6709\u4e00\u6761\u8fb9\uff01)+a[i].w\uff08\u662f\u5b58v\u4e0eu\u4e4b\u95f4\u8fb9\u7684\u6743\u503c\uff08\u5b66\u5206\uff09\uff09\uff0c\u53d6\u4e2amax\u5c31\u53ef\u4ee5\u4e86\uff0c\u5176\u5b9e\u4e3b\u8981\u662f\u7b2c\u4e00\u5c42\u5faa\u73af\u5f88\u96be\u60f3\u5230\uff0c\u5c31\u662f\u4f60\u8d70\u7684\u8fd9\u4e2a\u70b9\uff0c\u4f60\u8981\u53bb\u641c\u7d22\u5230\u5b83\u7684\u6240\u6709\u5b50\u8282\u70b9\u6240\u6709\u60c5\u51b5\uff0c\u4f60\u624d\u80fd\u4fdd\u8bc1\u5f53\u524d\u8fd9\u70b9\u53d6\u5f97\u662f\u6700\u5927\u5b66\u5206\uff09\\*/\n\n/\\*\u8bba\u4e00\u4e0b\u4f18\u5316\uff0c\u6709\u4e9b\u540c\u5b66\u53ef\u80fd\u8fd8\u4f1a\u505a\u7279\u5224\u6765\u6392\u9664\u90a3\u4e9b\u6ca1\u6709\u9009\u4fee\u8bfe\u7684\u76f4\u4fee\u8bfe\uff0c\u4f46\u5176\u5b9e\u4e0d\u5fc5\u8981\uff0c\u6211\u53ef\u4ee5\u81ea\u5df1\u6dfb\u52a0\u4e00\u4e2a\uff080,0\uff09\u7684\u7ed3\u70b9\u6765\u4f5c\u4e3a\u8fd9\u4e9b\u76f4\u4fee\u8bfe\u7684\u7236\u8282\u70b9\uff0c\u8fd9\u6837\u5e76\u4e0d\u8fdd\u80cc\u9898\u610f\uff0c\u8fd8\u80fd\u5927\u5927\u51cf\u5c11\u6211\u4eec\u5bf9\u4e8e\u7279\u5224\u7684\u601d\u8003\uff0c\u53ea\u4e0d\u8fc7\u8fd9\u4e2a\u7236\u8282\u70b9\u6ca1\u6709\u5b66\u5206\u7f62\u4e86\u3002\u8bdd\u4e0d\u591a\u8bf4\uff0c\u4ee3\u7801\u91cc\u6709\u6ce8\u91ca\\*/\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<iostream>\nusing namespace std;\nstruct bian\n{\n    int to;\n    int next;\n    int w;\n}a[601];\nint head[301];\nint F[301][301];\nint cnt,n,m,x,y;\nvoid Add(int u,int v,int w)\n{\n    cnt++;\n    a[cnt].to=v;\n    a[cnt].next=head[u];\n    a[cnt].w=w;\n    head[u]=cnt;\n}\nint dfs(int u,int fa)\n{\n    int num=0;\n    for (int i=head[u];i!=-1;i=a[i].next)\n    {\n        int v=a[i].to;\n        if (v==fa) continue;\n        num+=dfs(v,u)+1;\n        for (int j=min(num,m);j>=1;j--)\n          for (int k=j-1;k>=0;k--)\n            F[u][j]=max(F[u][j],F[u][j-k-1]+F[v][k]+a[i].w);\n    }\n    return num;\n}\nint main()\n{\n    cin>>n>>m;\n    memset(head,-1,sizeof(head));\n    for (int i=1;i<=n;i++)\n    {\n        cin>>x>>y;\n        Add(x,i,y);\n    }\n    dfs(0,0);//\u8981\u4ece0\u5f00\u59cb\u8ba1\u7b97\u66f4\u65b9\u4fbf\uff0c\u56e0\u4e3a0,0\u8868\u793a\u6ca1\u8bfe\u5b66\u5206\u662f0\uff0c\u800c\u4e14\u5bf9\u4e8e\u90a3\u4e9b\u76f4\u4fee\u8bfe\u6765\u8bf4\u4ed6\u4eec\u7684\u7236\u8282\u70b9\u5c31\u662f0\uff0c\u53ea\u4e0d\u8fc7\u6ca1\u5b66\u5206\u7f62\u4e86 \n    printf(\"%d\",F[0][m]);//\u6240\u4ee5\u5b66\u5206\u4e5f\u5b58\u5230\u4e86\u90a3\u4e2a\u6211\u6dfb\u52a0\u7684\u7236\u8282\u70b9\u4e0a\u4e86 \n    return 0;\n}\n//\u63a8\u8350\u540c\u5b66\u4eec\u53ef\u4ee5\u53bb\u505a\u4e0b\u4e8c\u53c9\u6811\u82f9\u679c\uff0c\u8ddf\u8fd9\u4e2a\u9898\u76ee\u7c7b\u4f3c\uff0c\u8981\u5b66\u4f1a\u4e3e\u4e00\u53cd\u4e09\n```",
        "postTime": 1500436698,
        "uid": 47901,
        "name": "\u9f99\u795e\u54c8\u8fea\u65af",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u4e3a\u4ec0\u4e48\u90fd\u7528dfs \u62d3\u6251\u5e8f\u591a\u597d\u75282333\n\n```cpp\n\u9996\u5148\u6211\u4eec\u628ak==0\u7684\u8bfe\u7a0b \u7684\u5148\u4fee\u8bfe \u5f53\u4f5c\u8bfe\u7a0b0\n\n\u7136\u540e\u5bf9\u6bcf\u4e2a\u70b9\u5f80\u5b83\u7684\u5148\u4fee\u8bfe\u8fde\u4e00\u6761\u8fb9 \u4f1a\u5f62\u6210\u4e00\u68f5\u4ee50\u4e3a\u6839\u7684\u6811\u5f62\u7ed3\u6784\n\n\u5bf9\u6bcf\u4e2a\u70b9\u8bb0\u5f55\u5b83\u8fde\u51fa\u8fb9\u7684\u7ec8\u70b9\u7f16\u53f7\uff08to[x]\uff09\u548c\u5b83\u7684\u5165\u5ea6(rd[x])\n```\n```\n\u7136\u540e\u5c31\u53ef\u4ee5\u6309\u62d3\u6251\u5e8fdp\u4e86\n\n\u8bb0f[i][j]\u4e3a \u5728i\u53f7\u70b9 \u9009\u4e86i\u7684\u5b50\u6811\u4e0a\uff08\u4e00\u5b9a\u5305\u62eci \u5171j\u4e2a\u70b9 \u6700\u591a\u80fd\u62ff\u5230\u7684\u5b66\u5206\n\n\u6bcf\u6b21\u7528\u5f53\u524d\u8282\u70b9\u66f4\u65b0\u5b83\u7684\u7236\u4eb2\u8282\u70b9 \u8dd101\u80cc\u5305\n\n\u8f6c\u79fb\u65b9\u7a0b\uff1af[to[x]][i]=max(f[to[x]][i],f[to[x]][i-j]+f[x][j]);\n\n\u6700\u540e\u7ed3\u679c\u5728f[0][m+1]\u4e0a\n```\n```cpp\n 1 #include<iostream>\n 2 #include<cstdio>\n 3 #include<queue>\n 4 #include<cmath>\n 5 using namespace std;\n 6 #define R register\n 7 int f[307][307];\n 8 int to[307];\n 9 int rd[307];\n10 queue<int>q;\n11 int main()\n12 {\n13     int n,m;\n14     scanf(\"%d%d\",&n,&m);\n15     for(R int i=1;i<=n;++i)\n16     {\n17         scanf(\"%d%d\",&to[i],&f[i][1]);\n18         rd[to[i]]++;//\u7ec8\u70b9\u5165\u5ea6++\n19     }\n20     for(R int i=1;i<=n;++i)\n21     if(!rd[i])q.push(i);\n22     while(!q.empty())\n23     {\n24         int x=q.front();q.pop();\n25         for(R int i=m+1;i>=1;--i)\n26         for(R int j=i-1;j>=1;--j)\n27         f[to[x]][i]=max(f[to[x]][i],f[to[x]][i-j]+f[x][j]);//01\u80cc\u5305\n28         //\n29         rd[to[x]]--;\n30         if(!rd[to[x]])q.push(to[x]);\n31     }\n32     cout<<f[0][m+1];\n33     return 0;\n34 }\n```\n[~~\u5939\u5e26\u79c1\u8d27\u5b89\u5229\u535a\u5ba2~~](https://www.cnblogs.com/qwerta/p/9389955.html)",
        "postTime": 1532924291,
        "uid": 48681,
        "name": "qwerta",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "1.\u770b\u4e86\u697c\u4e0b\u8bb8\u591a\u7bc7\u9898\u89e3\uff0c\u5927\u540c\u5c0f\u5f02\uff0c\u4f46\u4ee4\u6211\u4e0d\u89e3\u7684\u662f\uff0c\u8bb8\u591a\u7bc7\u9898\u89e3\u90fd\u7528\u4e86\u5f88\u591a\u5197\u4f59\u7684\u53d8\u91cf\uff0c\u8fd9\u5f88\u4ee4\u6211\u4e0d\u89e3\uff0c\u65b9\u6cd5\u56fa\u5b9a\u7684\u8bdd\uff0c\u4ee3\u7801\u5c31\u5e94\u8be5\u5199\u5f97\u7b80\u6d01\uff0c\u51b5\u4e14\u4ed6\u4eec\u53d8\u91cf\u540d\u7684\u610f\u4e49\u4e5f\u6ca1\u6709\u6e05\u6670\u5730\u6807\u6ce8\uff0c\u6240\u4ee5\u6211\u5199\u4e86\u8fd9\u7bc7\u9898\u89e3\n\n2.add\u51fd\u6570\u4e2dhead[u]\u6307\u7684\u662f\u6700\u540e\u4e00\u4e2a\u4e0e\u8282\u70b9u\u8fde\u63a5\u7684\u8282\u70b9\uff0cpre[i]\u5219\u662f\u5c06\u4e0a\u4e00\u4e2a\u4e0eu\u8fde\u63a5\u7684\u8282\u70b9\u8f6c\u79fb\u8fc7\u53bb\uff0c\u4e0d\u7406\u89e3\u7684\u53ef\u4ee5\u5c06\u6837\u4f8b\u753b\u51fa\uff0c\u518d\u6a21\u62df\u4e0b\n\n3.f[i][j]\u7528\u6765\u5b58\u50a8\u7b2ci\u4e2a\u8282\u70b9\u9009j\u8282\u8bfe\u7684\u6700\u5927\u4ef7\u503c\uff0c\u52a8\u6001\u8f6c\u79fb\u65b9\u7a0b\u7684\u610f\u4e49\u53ef\u4ee5\u8be6\u7ec6\u53c2\u8003\u4e0b\u9762\u7684\u9898\u89e3\uff0c\u8fd9\u91cc\u4e0d\u591a\u8d58\u8ff0\n\n4.\u539f\u672c\u7684\u56fe\u662f\u68ee\u6797\uff0c\u4e3a\u4e86\u8f6c\u5316\uff0c\u6211\u4eec\u8bbe\u7acb\u4e00\u4e2a0\u8282\u70b9\uff0c\u8fd9\u6837\u5c31\u6210\u4e00\u68f5\u6811\u4e86\uff0c\u76f8\u5e94\u7684\uff0cm\u4e5f\u5e94\u8be5+1\uff0c\u56e0\u4e3a\u4ece0\u5f00\u59cb\u7b97\uff0c\u76f8\u5f53\u4e8e\u591a\u9009\u4e00\u8282\u6ca1\u6709\u4efb\u4f55\u4ef7\u503c\u7684\u8bfe\n\n5.\u4e0b\u9762\u662f\u4ee3\u7801\n\n```cpp\n#include<iostream>\nusing namespace std;\nconst int MAXN=300+2;\nint f[MAXN][MAXN],head[MAXN],pre[MAXN];\nint n,m;\nvoid add(int u,int i){\n    pre[i]=head[u];\n    head[u]=i;\n}\nvoid dp(int x){\n    for(int i=head[x];i;i=pre[i]){\n        dp(i);\n        for(int j=m+1;j>1;j--)\n            for(int k=j-1;k>=1;k--)\n                f[x][j]=max(f[x][j],f[x][j-k]+f[i][k]);\n    }\n}\nint main(){\n    cin>>n>>m;\n    for(int i=1;i<=n;i++){\n        int fa,v;\n        cin>>fa>>v;\n        f[i][1]=v;\n        add(fa,i);\n    }\n    dp(0);\n    cout<<f[0][m+1]<<endl;\n    return 0;\n}\n```",
        "postTime": 1507866102,
        "uid": 28270,
        "name": "wwq123",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u563b\u563b\uff0c\u7b2c\u4e00\u6b21\u5199\u9898\u89e3\uff0c\u4e0d\u559c\u52ff\u55b7\u2026\u2026\n\n\u4e0b\u8fb9\u7684\u5927\u795e\u4e0d\u662f\u8f6c\u4e8c\u53c9\u6811\uff0c\u5c31\u662fdfs+dp\u2026\u2026\u7531\u4e8e\u79cd\u79cd\u539f\uff08bu\uff09\u56e0\uff08hui\uff09\uff0c\u6211\u5199\u4e86\u4e00\u4e2a\u6bd4\u8f83\u57fa\u7840\u7684\u8bb0\u5fc6\u5316\u641c\u7d22+\u526a\u679d+\u67d0\u79cd\u80cc\u5305\u3002\n\n\u4e00\u770b\u5230\u8fd9\u4e2a\u9898\uff0c\u7b2c\u4e00\u611f\u89c9 \u8fd9\u662f\u4e2atreedp\uff0c\u7b2c\u4e8c\u611f\u89c9 \u8fd9\u4e0d\u662f\u4e8c\u53c9\u6811\uff0c\u7136\u540e\u5c31\u61f5\u903c\u4e86\u2026\u2026\n\n\u4e8e\u662f\u6211\u5c31\u81ea\u5df1\u7422\u78e8\u51fa\u4e00\u4e2a\u795e\u5947\u7684\u8bb0\u5fc6\u5316\u641c\u7d22\u3002\n\n\u9996\u5148\uff0c\u8fd9\u4e2a\u89e3\u6cd5\u662f\u4ee5\u6811\u5f62dp\u4e3a\u6a21\u7248\u7684\u641c\u7d22\uff1b\n\n\u7136\u540e\uff0c\u7531\u4e8e\u8fd9\u4e0d\u662f\u4e8c\u53c9\u6811\uff0c\u4e0d\u80fd\u76f4\u63a5\u5957\u6a21\u677f\uff0c\u56e0\u6b64\u5bf9\u6bcf\u4e00\u5c42\u505a\u4e00\u4e2a\u80cc\u5305\u95ee\u9898\u7684\u89e3\u6cd5\uff08\u5177\u4f53\u662f\u90a3\u79cd\uff0c\u4e0d\u8981\u95ee\u6211\uff0c\u81ea\u5df1\u609f\u5427\uff0c\u53cd\u6b63\u6211\u662f\u6ca1\u609f\u51fa\u6765\uff09\uff1b\n\n\u5176\u6b21\uff0c\u6b64\u79cd\u89e3\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6\u8f83\u9ad8\uff0c\u7b2c\u56db\u4e94\u4e2a\u70b9TLE\u4e86\uff0c\u6240\u4ee5\u9700\u8981\u526a\u679d\uff08\u8be6\u89c1\u4ee3\u7801\u53ca\u6ce8\u91ca\uff09\u3002\n\n\u6700\u540e\uff0c\u8c8c\u4f3c\u6ca1\u6cd5\u8bf4\u8fd9\u5230\u5e95\u662f\u4e2a\u4ec0\u4e48\u7b97\u6cd5\uff0c\u4e5f\u6ca1\u6709\u53ef\u7b97\u672f\u5f0f\u5316\u7684\u8f6c\u79fb\u65b9\u7a0b  \u2190.\u2190\n\n\u9644c++\u4ee3\u7801\uff1a\n\n\u00b7\u00b7\u00b7\n\n\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#define Max(a,b) (a>b?a:b)\n#define N 310\nusing namespace std;\nstruct point            //\u6bcf\u4e00\u4e2a\u70b9\u7684\u4fe1\u606f \n{ \n    int sn,sum,s[N];    //\u513f\u5b50\u4e2a\u6570\uff0c\u5b50\u5b59\u4e2a\u6570\uff08\u526a\u679d\u7528\u7684\uff09\uff0c\u6bcf\u4e2a\u513f\u5b50\u7684\u7f16\u53f7 \n    point(){sn=0;sum=1;}//\u521d\u59cb\u5316 \n}p[N];\nint n,m,f[N][N],v[N][N],w[N];\nint dp(int x,int l)//\u7b2cx\u4e2a\u8bfe\u53ca\u5176\u9644\u5e26\u8bfe\u7a0b\u4e2d\u9009l\u95e8\u7684\u6700\u5927\u5b66\u5206 \n{\n    if(l<=0)return 0;//\u4e3b\u8981\u662fl==0\u8d77\u4f5c\u7528 \n    if(l>p[x].sum)return 0;//\u526a\u679d\uff0c\u5f53l\u591a\u4e8ex\u8bfe\u7684\u5b50\u5b59\u65f6\uff0c\n                          //\u5fc5\u7136\u4e0d\u7b26\u5408\u9898\u610f\uff08\u8fd9\u4e00\u5904\u526a\u679d\u5bf9\u8fd9\u79cd\u89e3\u6cd5\u5f88\u6709\u5fc5\u8981\uff09 \n    if(v[x][l])return f[x][l];//\u8bb0\u5fc6\u5316 \n    v[x][l]=1;\n    int sn=p[x].sn;\n    int ff[l+2];//\u7528\u4e8e\u8dd1\u67d0\u79cd\u80cc\u5305\uff08\u771f\u7684\u4e0d\u8981\u95ee\u6211\u662f\u4ec0\u4e48\u80cc\u5305\uff09 \n```\n.//\u5bf9\u4e8ex\u7684\u53f6\u5b50\u5c42\uff0c\u9009l-1\u95e8\u8bfe\u65f6\u7684\u6700\u5927\u5b66\u5206\n    \n            \n\n```cpp\n    for(int i=1;i<=l+2;i++)\n    ff[i]=-100000;//\u8981\u6c42\u6070\u597d\u9009\u6ee1l-1\u95e8\u8bfe \u7684\u521d\u59cb\u5316 \n    ff[0]=0;\n    for(int i=1;i<=sn;i++)//\u8dd1\u80cc\u5305 \n    {\n        int son=p[x].s[i],sonw=0//\u679a\u4e3e\u513f\u5b50\u53ca\u5176\u5b66\u5206 \n        for(int j=l-1;j>0;j--)\n        {\n            for(int k=j;k>0;k--)//\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u513f\u5b50\uff0c\u90fd\u6709\u591a\u79cd\u9009\u8bfe\u6570\uff0c\u4e0d\u662f\u786e\u5b9a\u7684\uff0c\u56e0\u6b64\u90fd\u6709\u5fc5\u8981\u641c\u4e00\u904d \n            {\n                sonw=dp(son,k);\n                ff[j]=Max(ff[j],ff[j-k]+sonw);\n            }\n        }\n    }\n    f[x][l]=ff[l-1]+w[x];\n    return f[x][l];\n}\nint si(int x)//\u628a\u513f\u5b50\uff0c\u5b59\u5b50\uff0c\u66fe\u5b59\uff0c\u91cd\u5b59\uff0c\u7384\u5b59\u2026\u2026\u7684\u6570\u8bb0\u4e0b \n{\n    for(int i=1;i<=p[x].sn;i++)\n    p[x].sum+=si(p[x].s[i]);\n    return     p[x].sum;\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n;i++)\n    {\n        int a,b;scanf(\"%d%d\",&a,&b);\n        p[a].sn++;\n        p[a].s[p[a].sn]=i;\n        w[i]=b;\n    }\n    si(0);//\u51c6\u5907\u526a\u679d \n    for(int i=1;i<=n;i++)//\u521d\u59cb\u5316\u8fb9\u754c \n    {\n        v[i][1]=1;\n        f[i][1]=w[i];\n    }\n    printf(\"%d\",dp(0,m+1));//\u628a\u96f6\u5f53\u505a\u6ca1\u6709\u5148\u4fee\u8bfe\u7684\u8bfe\u7684\u5148\u4fee\u8bfe\uff0c\n                          //\u7531\u4e8e\u72b6\u6001\u8bbe\u7684\u7279\u522b\uff0c\u56e0\u6b64\u9700\u8981m+1 \n    return 0;\n}\n\u00b7\u00b7\u00b7\n```",
        "postTime": 1479293976,
        "uid": 23421,
        "name": "pisceskkk",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u88f8\u7684\u6811\u5f62DP+\u8bb0\u5fc6\u5316,dp[i,j]\u8868\u793a\u7b2ci\u95e8\u8bfe,\u5b83\u4ee5\u53ca\u5b83\u7684\u540e\u4ee3\u53ef\u4ee5\u9009j\u95e8\u8bfe\u7684\u6700\u5927\u5f97\u5206\n\n\u6ce8\u610f\u8981\u591a\u53c9\u8f6c\u4e8c\u53c9\n\n```delphi\n\n\nprogram Project1;\ntype node=record\n            l,r,fen:longint;\n          end;\nvar a:array[-1..410]of node;\n    jyh:array[-1..410,-1..310]of longint;\n    f:array[-1..410]of longint;\n    i,j,n,m,k,s:longint;\n\nfunction treedp(x,y:longint):longint;\nvar i,t,max:longint;\nbegin\n  if jyh[x,y]>=0 then exit(jyh[x,y]);\n  max:=treedp(a[x].r,y);\n  for i:=1 to y do\n    begin\n      t:=a[x].fen+treedp(a[x].l,i-1)+treedp(a[x].r,y-i);\n      if t>max then max:=t;\n    end;\n  jyh[x,y]:=max;\n  exit(max);\nend;\n\nbegin\n  readln(n,m);\n  for i:=-1 to n do\n    begin\n      f[i]:=0;\n      a[i].l:=-1;\n      a[i].r:=-1;\n      for j:=0 to m do\n        if (i=-1)or(j=0)then jyh[i,j]:=0\n                        else jyh[i,j]:=-1;\n    end;\n  for i:=1 to n do\n    begin\n      readln(k,s);\n      a[i].fen:=s;\n      if f[k]=0 then a[k].l:=i\n                else a[f[k]].r:=i;\n      f[k]:=i;\n    end;\n  writeln(treedp(a[0].l,m));\nend.  \n\n\n```",
        "postTime": 1459332140,
        "uid": 11874,
        "name": "lqylqylqy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u849f\u84bb\u7684\u7b2c\u4e00\u9053\u6811\u5f62\u80cc\u5305\u9898\uff0c\u5728\u770b\u4e86Lancy\u5927\u4f6c\u7684\u6811\u5f62\u52a8\u89c4\u5b66\u4e60\u7b14\u8bb0\u540e\u5b8c\u6210\u4e86\u8fd9\u9053\u9898\uff0c\u505a\u6cd5\u6bd4\u8f83\u50cf\uff0c\u4f46\u505a\u4e86\u4e00\u5b9a\u7684\u4f18\u5316\uff0c\u4ee3\u7801\u6bd4\u8f83\u7b80\u6d01\u6613\u61c2\n\n\u795d\u5927\u5bb6ac\n\ncode:\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define fread ios::sync_with_stdio\n#define fint register int\n#define p 37324\n#define h 2001\n//\u5934\u6587\u4ef6\u4e0e\u5b8f\u5b9a\u4e49 \nusing namespace std;\nstruct node\n{\n\tint to;\n\tint next;\n}\ne[p];\nint head[p];\nint cnt;\n//\u94fe\u5f0f\u524d\u5411\u661f\u5b58\u56fe \nint f[h][h];\nint a,b[p];\nint n,m;\ninline void adds(int u,int v);\nvoid dp(int x,int y);\nsigned main()\n{\n    fread(false);\n    //\u6d41\u8f93\u5165\u4f18\u5316 \n\tcin>>n>>m;\n\tfor(fint i=1;i<=n;i++)\n\t{\n\tcin>>a>>b[i];\n\tadds(a,i);\n}\n//\u50a8\u5b58\u8fb9\u548c\u6743 \n    dp(0,m);\n    //\u4ee50\u4e3a\u6839\u5f00\u59cb\u641c \n   /* for(fint i=0;i<=n;i++)\n    {\n    for(fint j=0;j<=n;j++)\n    {\n    cout<<f[i][j]<<\" \";\n}\ncout<<endl;\n}*/\n    cout<<f[0][m];\n    exit(0);\n    //\u5feb\u901f\u9000\u51fa \n} \ninline void adds(int u,int v)\n{\n\te[++cnt].to=v;\n\te[cnt].next=head[u];\n\thead[u]=cnt;\n}\n//\u94fe\u5f0f\u524d\u5411\u661f\u5b58\u56fe \nvoid dp(int x,int y)//\u7528x\u50a8\u5b58\u70b9\uff0cy\u50a8\u5b58\u6b21\u6570 \n{\n\tif(y==0)\n\treturn ;\n\t//\u5982\u679c\u5df2\u7ecf\u9009\u4e86m\u4e2a\uff0c\u5c31\u9000\u51fa \n\tfor(fint i=head[x];i;i=e[i].next)\n\t{\n\tint tt=e[i].to;\n\tf[tt][0]=f[x][0]+b[tt]; \n\tfor(fint j=1;j<=y;j++)\n\tf[tt][j]=f[x][j]+b[tt];\n\t//\u50a8\u5b58\u8fd9\u4e2a\u70b9\u6743\u503c\u52a0\u4e0a\u4e4b\u524d\u6743\u503c\u548c \n\tdp(tt,y-1);\n\t//\u8fdb\u884c\u4e0b\u4e00\u6b21\u641c\u7d22 \n\tfor(fint k=1;k<=y;k++)\n\tf[x][k]=max(f[x][k],f[tt][k-1]);\n\t//\u5bf9\u6bd4\u6c42\u51fa\u6700\u5927\u5f97\u5206\n}\n}",
        "postTime": 1577412323,
        "uid": 244059,
        "name": "king_xbz",
        "ccfLevel": 0,
        "title": "\u6811\u5f62\u80cc\u5305\u7684\u7ec3\u624b\u9898"
    },
    {
        "content": "```\n//\u6765\u4e00\u624b\u641c\u7d22\u89e3\u6cd5\uff0c\u7528\u8bb0\u5fc6\u5316\u63d0\u9ad8\u6548\u7387\n#include<iostream>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nconst int maxn=800;\nint n,q,id=0;\nint head[maxn],nxt[maxn],lt[maxn],rt[maxn],W[maxn];\nint f[maxn][maxn],e[maxn];\nvoid add(int x,int y)\n{\n     e[++id]=y;\n     nxt[id]=head[x];\n     head[x]=id;\n}\nvoid create(int x)\n{\n     //\u4ee5x\u4e3a\u6839\u5efa\u6811 \n     if(!head[x])\n       return;\n     //\u5982\u679c\u5b83\u6ca1\u6709\u90bb\u63a5\u70b9\uff0c\u8bf4\u660e\u5b83\u5c31\u662f\u53f6\u8282\u70b9 \n     int p=e[head[x]];\n     //p\u4e3ax\u7684\u7b2c\u4e00\u4e2a\u5b50\u8282\u70b9 \n     lt[x]=p;\n     create(p);\n     for(int i=nxt[head[x]];i;i=nxt[i])\n     {\n       int y=e[i];\n       rt[p]=y;\n       //\u957f\u5b50\u7684rt\u6307\u5411\u5b83\u7684\u5144\u5f1f \n       create(y);\n       p=y;\n       //\u76ee\u6807\u662f\u628a\u5144\u5f1f\u7684rt\u7ee7\u7eed\u6307\u5411\u5144\u5f1f\u7684\u5144\u5f1f\n       //\u6700\u540e\u5c31\u662f\u4ee5\u957f\u5b50\u4e3a\u5934\u7684\u4e00\u4e32\u513f \n     }\n     /*\n         \u5229\u7528\u957f\u5b50\u5144\u5f1f\u6cd5\u628a\u591a\u53c9\u6811\u8f6c\u5316\u4e3a\u4e8c\u53c9\u6811\uff1a\n             \u5373lt[x]\u5b58x\u7684\u7b2c\u4e00\u4e2a\u5b50\u8282\u70b9\uff0c\u800crt[x]\u5b58x\u70b9\u7684\u5144\u5f1f\u8282\u70b9 \n     */\n}\nint dfs(int x,int k)\n{\n     //\u8868\u793a\u5728\u4ee5x\u4e3a\u6839\u7684\u6811\u4e2d\u6311\u9009k\u4e2a\u70b9 \n     if(!k)\n       return 0;\n     //\u5982\u679ck==0\uff0c\u5c31\u8bf4\u660e\u4e0d\u80fd\u7ee7\u7eed\u9009\u62e9\u4e86\uff0c\u56e0\u4e3a\u540d\u989d\u5df2\u7ecf\u7528\u5149\u4e86\uff0c\u8fd4\u56de0 \n     if(!lt[x] && !rt[x])\n       return W[x];\n     //\u5982\u679cx\u70b9\u65e2\u6ca1\u6709\u5b50\u6811\uff0c\u4e5f\u6ca1\u6709\u5144\u5f1f\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u662f\u4e00\u4e2a\u5b64\u5355\u7684\u53f6\u8282\u70b9\n     //\u5c31\u8fd4\u56de\u81ea\u5df1\u7684\u70b9\u6743\uff0c\u56e0\u4e3a\u6700\u591a\u53ea\u80fd\u9009\u4e2a\u81ea\u5df1 \n     if(f[x][k]<0)\n     {\n       //\u8fd9\u91cc\u7528\u8bb0\u5fc6\u5316\u641c\u7d22\u63d0\u9ad8\u6548\u7387\n       //f\u6570\u7ec4\u521d\u503c\u8bbe\u4e3a-1\uff0c\u6240\u4ee5\u5982\u679c\u6ca1\u5904\u7406\u8fc7\u5c31\u5904\u7406 \n       for(int i=k-1;i>=0;i--)\n         f[x][k]=max(f[x][k],dfs(lt[x],i)+dfs(rt[x],k-1-i)+W[x]);\n       //i\u679a\u4e3e\u7ed9x\u70b9\u7684\u5b50\u6811\u5206\u591a\u5c11\u4e2a\u70b9  \u5269\u4f59\u6570\u91cf\u7559\u7ed9x\u7684\u6240\u6709\u5144\u5f1f\u4eec \n       if(rt[x])\n         f[x][k]=max(f[x][k],dfs(rt[x],k));\n       //\u5982\u679cx\u70b9\u6709\u5144\u5f1f\u7684\u8bdd\uff0c\u4e5f\u53ef\u4ee5\u5168\u90e8\u5206\u7ed9\u5144\u5f1f\u4eec \n     }\n     return f[x][k];\n}\nvoid init()\n{\n     memset(W,0,sizeof(W));\n \t memset(f,-1,sizeof(f));\n\t memset(lt,0,sizeof(lt));\n\t memset(rt,0,sizeof(rt));\n\t memset(nxt,0,sizeof(nxt));\n\t memset(head,0,sizeof(head));\n}\nint main()\n{\n\tinit();//\u53cd\u6b63f\u6570\u7ec4\u8981\u521d\u59cb\u5316\u4e3a-1\uff0c\u522b\u7684\u505a\u4e0d\u505a\u90fd\u884c \n    cin>>n>>q;\n    for(int i=1;i<=n;i++)\n    {\n      int x,y;\n      cin>>x>>y;\n      W[i]=y;\n      //\u8fd9\u91cc\u9009\u62e9\u4ee5n+1\u4e3a\u539f\u70b9\uff0c\u6240\u4ee5\u5982\u679c\u5fc5\u4fee\u79d1\u76ee\u662f0\uff0c\u5c31\u6539\u4e3an+1; \n      if(!x)\n        x=n+1;\n      add(x,i);\n    }\n    create(n+1);\n    cout<<dfs(n+1,q+1)<<endl;\n    system(\"pause\");\n    return 0;\n}\n     \n\n```\n",
        "postTime": 1573270057,
        "uid": 148757,
        "name": "wanxiang_zx",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u4ec0\u4e48\u6811\u5f62dp\u603b\u7ed3\u6211\u5c31\u4e0d\u8bb2\u4e86\uff08\u592a\u591a\u4e86\uff09\uff0c\u8fd9\u91cc\u53ea\u8bb2\u4e0b**\u8fd9\u9053\u9898**\uff08~~\u4e3b\u8981\u662f\u7b2c\u4e00\u6b21\u63a5\u89e6\u9898\u89e3\u6211\u6ca1\u4e00\u4e2a\u770b\u61c2\u7684~~\uff09\uff0c\n### \u4f46\u662f\n\u6ce8\u610f\u5bf9\u4e8e**\u6811\u5f62dp\u7684dfs**\uff0c\u5176\u56de\u6eaf\u65f6**\u5df2\u8bbf\u95ee\u7684\u8282\u70b9**\uff08**\u4e5f\u5c31\u662f\u5b50\u8282\u70b9**\uff09\u7684dp\u503c**\u603b\u662f\u5904\u7406\u597d\u7684**\n\n---\n### \u5b9a\u4e49\n\n\n| f[ ][ ] |\n| :----------: |\n\n\n\n\u8868\u793a\u72b6\u6001\u3001\n\n\n\n| w[ ]  |\n| :----------: |\n\n\n\n\n\u8868\u793a\u6743\u503c\uff1b\n\n**f[i][j]** \u4ee3\u8868**\u4ee5i\u4e3a\u6839**\u7684\u6811\u9009\u5b83\u7684**j\u4e2a\u5b50\u8282\u70b9**\u548c**\u81ea\u5df1**\u7684**\u6700\u5927\u6743\u503c**\n\n---\n# 1. \n\u9996\u5148\u521d\u59cb\u5316\u65f6\u53ef\u4ee5**\u53d1\u73b0**\u5bf9\u4e8e\u4efb\u610f\n\n\n| f[i][k] _{k\u5c5e\u4e8e\u6b63\u6574\u6570}_  |\n| :----------: |\n\n\n\n\u603b\u6709\u6700\u5c0f\u503c\n\n\n\n| w[i] |\n| :----------: |\n\n\n\n\uff08\u5176\u5b9e\u5c31\u662f\u5f53f\u72b6\u6001\u6709\u610f\u4e49\u65f6\u603b\u662f\u9009**i**\uff09\n\n---\n### \u4e8e\u662f\n\n\n```cpp\nfor(int tmp =m/*\u53ef\u80fd\u53d6\u5230\u7684\u6700\u5927\u503c*/; tmp >= 0; tmp--) f[i][tmp] =w[nw];\n```\n\n\n---\n# 2.\n\n\u63a5\u7740\u5217\u51fa\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\n\n\n| f[i][j] =max(f[i][j], f[i][j-k-1]+f[son][k]) _{k\u5c5e\u4e8e\u6b63\u6574\u6570\uff0c son\u662fi\u7684\u5b50\u8282\u70b9}_  |\n| :----------: |\n\n\n\u53ef\u4ee5\u5c06\u5b50\u8282\u70b9\u60f3\u8c61\u4e3a**\u7269\u54c1**\uff0c\u5176\u9009\u4e86\u591a\u5c11\u70b9\u60f3\u8c61\u4e3a**\u82b1\u8d39** \n\n\uff08\u540c\u65f6\u53ef\u80fd\u53d6\u5230\u7684k**\u603b\u4e0d\u8d85\u8fc7m**\uff0c\u6240\u4ee5\u7a0b\u5e8f\u4e2d\u5c31\u5c06k\u4e0a\u9650**\u8bbe\u4e3am**\uff09\n\n---\n### \u6ce8\u610f\n\n\n\n| j-k-1 |\n| :----------: |\n\n\n\n**\"-1\"** \u662f\u56e0\u4e3a\u8fd9\u91ccf\u72b6\u6001\u7684\u7b2c\u4e8c\u4e2a\u4e0b\u6807\u4ee3\u8868\u7684\u662f**\u9009\u5b83\u67d0\u6570\u91cf\u7684\u5b50\u8282\u70b9**\u800c\u4e0d\u5305\u62ec\u81ea\u5df1\uff0c\u540c\u65f6\u9898\u76ee\u7684\u4ece\u5c5e\u5173\u7cfb\u4ee4f\u72b6\u6001\u6709\u610f\u4e49\u65f6**i**\uff08**\u5176\u5b9e\u5c31\u662f\u8fd9\u9897\u6811\u7684\u7236\u4eb2**\uff09\u5fc5\u987b\u9009\n\n-----\n# 3.\n\u5230\u8fd9\u91cc\u5176\u5b9e\u5c31\u5dee\u4e0d\u591a\u4e86\uff0c\u5269\u4e0b\u8fd8\u6709\u5c31\u662f\u7a0b\u5e8f\u4e2d\u7528\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u8282\u70b9\"0\"\u4f5c\u4e3a\u68ee\u6797**\u6240\u6709\u6811\u7684\u7236\u8282\u70b9**\uff0c\u65b9\u4fbf\u6df1\u641c\u5904\u7406\n\n```cpp\n#include <cstdio>\n#include <string.h>\n#include <algorithm>\nusing namespace std;\n\nint first[301], w[301], n, m;\nint next[300], to[300];\n//\u6211\u4e5f\u4e0d\u80fd\u786e\u5b9a<\u8fd9\u79cd>\u901a\u8fc7\u5b58\u8fb9\u7684\u65b9\u5f0f\u6765\u5b58\u56fe\u7684\u65b9\u6cd5\u5177\u4f53\u53eb\u4ec0\u4e48...\u603b\u4e4b\u7a00\u758f\u56fe\u8fd9\u4e48\u505a\u5c31\u5bf9\u4e86\n\ninline void init(){\n\tint x;\n\t//first\u50a8\u5b58\u6bcf\u4e2a\u70b9\u7684\u7b2c\u4e00\u6761\u8fb9\u7684\"ID\"\uff0cnext\u5b58\u8fd9\u6761\u8fb9\u7684\u201c\u4e0b\u4e00\u6761\u8fb9\u201d\u7f16\u53f7...\u7406\u89e3\u4e0b\n\tmemset(first, -1, sizeof(first));\n\tfor(int i =1; i <= n; i++){\n\t\tscanf(\"%d%d\", &x, &w[i]);\n\t\tto[i-1] =i;\n\t\tnext[i-1] =first[x];\n\t\tfirst[x] =i-1;\n\t}\n}\n\nint tp[301][301];//tp[i][j]i\u70b9\u9009j\u4e2a\u5b50\u8282\u70b9\u8fd9\u68f5\u4ee5i\u4e3a\u6839\u7684\u6811\u7684\u6700\u5927\u503c \n\nvoid dfs(int nw){\n\tint l =first[nw];\n\tfor(int k =m; k >= 0; k--) tp[nw][k] =w[nw];//k\u987a\u5e8f\u65e0\u6240\u8c13\uff0c\u603b\u4e4b\u628a\u81ea\u5df1\u7684\u503c\u5148\u585e\u8fdb\u53bb \n\twhile(l != -1){\n\t\tdfs(to[l]);\n\t\tfor(int j =m; j >= 0; j--)\n\t\t\tfor(int k =0; k < j; k++)\n\t\t\t\t//\u5982\u679c\u96be\u4ee5\u7406\u89e3\u7684\u8bdd\u8bd5\u7740\u5c06\u5b50\u8282\u70b9\u60f3\u8c61\u4e3a\u7269\u54c1\uff0c\u5176\u9009\u4e86\u591a\u5c11\u70b9\u60f3\u8c61\u4e3a\u82b1\u8d39 \n\t\t\t\ttp[nw][j] =max(tp[nw][j], tp[nw][j-k-1]+tp[to[l]][k]);\n    \t//\u8fd9\u8fb9\u7684\u6280\u5de7\u662f\u5206\u7ec4\u80cc\u5305\u7684\uff0c\u4e0d\u77e5\u9053\u7684\u5f97\u6076\u8865\u4e0b\u80cc\u5305\u57fa\u7840\u77e5\u8bc6\n\t\tl =next[l];\n\t}\n}\n\nint main(){\n\tscanf(\"%d%d\", &n, &m);\n\tinit();\n\t\n\tdfs(0);\n\tprintf(\"%d\", tp[0][m]);\n   //\u7b2c\u4e8c\u4e2a\u4e0b\u6807\u662fm\u662f\u56e0\u4e3a\"0\"\u8fd9\u4e2a\u8282\u70b9\u4e0d\u9700\u8981\u53bb\"\u5b66\"\n}\n```",
        "postTime": 1572869371,
        "uid": 105254,
        "name": "Piwry",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u6bd4\u8f83\u57fa\u7840\u7684\u6811\u5f62dp\u6211\u7adf\u7136\u641e\u4e86\u4e09\u5929\uff0c\u4e0d\u8bf4\u4e86\uff0c\u8fc7\u4e8e\u849f\u84bb\u3002\n\n\u9996\u5148\u6211\u4eec\u77e5\u9053\u6240\u6709dp\u5176\u5b9e\u90fd\u662f\u7206\u641c\u7684\u4f18\u5316\uff0c\u90a3\u4e48\u4f18\u5148\u60f3\u7206\u641c\u600e\u4e48\u529e\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u8282\u70b9\uff0c\u5047\u5982\u5fc5\u987b\u9009\u5b83\uff0c\u4f60\u8981\u5728\u8fd9\u4e2a\u8282\u70b9\u7684\u5b50\u6811\u4e0a\u9009\u4e00\u4e9b\u70b9\uff0c \u7136\u540e\u8ba9\u7ed3\u679c\u6700\u5927\u3002\u90a3\u663e\u7136\u8981\u679a\u4e3e\u8fd9\u4e2a\u8282\u70b9\u7684\u6bcf\u4e00\u4e2a\u5b50\u6811\u4e0a\u8981\u9009\u51e0\u4e2a\u8282\u70b9\uff0c\u7136\u540e\u9012\u5f52\u89e3\u51b3\u3002\n\n\u5c31\u6bd4\u5982\u67d0\u8282\u70b9node\u6709\u4e24\u4e2a\u5b50\u8282\u70b9\uff0c\u7136\u540e\u4f60\u53ef\u4ee5\u90095\u4e2a\u8282\u70b9\uff0c\u9664\u53bbnode\u8282\u70b9\u81ea\u5df1\u7b97\u4e00\u4e2a\uff0c\u90a3\u4e48\u5c31\u8981\u5206\u914d\u540d\u989d\u4e86\uff0c\u65b9\u6848\u5982\u4e0b\uff1a\n\n\u5de60\uff0c\u53f34\n\n\u5de61\uff0c\u53f33\n\n\u5de62\uff0c\u53f32\n\n\u5de63\uff0c\u53f31\n\n\u5de64\uff0c\u53f30\n\n\u4f46\u82e5\u679c\u8282\u70b9\u6570\u4e0d\u6b62\u4e24\u4e2a\uff0c\u90a3\u4e48\u679a\u4e3e\u8d77\u6765\u590d\u6742\u5ea6\u76f8\u5f53\u9ad8\uff0c\u4f46\u662f\u4f60\u89c2\u5bdf\u53d1\u73b0\u5de6\u8fb9\u90093\u4e2a\u597d\u50cf\u4e0d\u4f1a\u5f71\u54cd\u53f3\u8fb9\u90091\u4e2a\u7684\u7ed3\u679c\uff0c\u800c\u4e14\u6bcf\u4e2a\u5b50\u8282\u70b9\u7684\u5b50\u6811\u6700\u591a\u5c31\u90094\u4e2a\uff0c\u90a3\u5c31\u597d\u529e\u4e86\uff0c\u679a\u4e3e\u6bcf\u4e00\u4e2a\u5b50\u8282\u70b9\u6240\u5206\u914d\u5230\u7684\u7ed3\u679c0\u5230m-1\u4e0d\u5c31\u597d\u4e86\u3002\u8fd9\u6837\u5c31\u628a\u6307\u6570\u7ea7\u7684\u679a\u4e3e\u964d\u5230\u4e86\u5e73\u65b9\u7ea7\u3002\n\n\u4f46\u6bcf\u4e2a\u8282\u70b9\u90fd\u6709\u5e73\u65b9\u7ea7\u522b\u7684\u5206\u652f\uff0c\u8fd8\u662f\u5403\u4e0d\u6d88\u554a\u3002\n\u4f46\u662f\u5982\u679c\u4f60\u5199\u51fa\u6240\u6709\u5206\u652f\u7684\u8bdd\uff0c\u5c31\u4f1a\u53d1\u73b0\u597d\u50cf\u5f88\u591a\u5206\u652f\u662f\u91cd\u7684\uff0c\u5c31\u6bd4\u5982\u5de64\u4f1a\u679a\u4e3e\u81ea\u5df1\u7684\u5b50\u8282\u70b90-3\uff0c\u4f46\u662f\u5de63\u4e5f\u4f1a\u679a\u4e3e0-2\uff0c\u540c\u7406\u5de62\u4e5f\u8ba1\u7b97\u4e860-1\n\u8fd9\u6837\u5c31\u505a\u4e86\u5927\u91cf\u91cd\u590d\u8fd0\u7b97\uff0c\u5341\u5206\u6d6a\u8d39\u3002\u56e0\u6b64\u8003\u8651dp\n\n\u8fd9\u65f6\u5019\u4f60\u53d1\u73b0\u6bcf\u4e00\u4e2a\u8282\u70b9\u7684\u9009\u62e9\u53ea\u6709\u4e00\u4e2a\uff0c\u4e14\u5fc5\u987b\u9009\u4e00\u4e2a\u4f5c\u4e3a\u6700\u7ec8\u7ed3\u679c\uff0c\u90a3\u4e48\u662f\u4e0d\u662f\u5f88\u60f3\u5206\u7ec4\u80cc\u5305\uff1f\u6bcf\u4e00\u4e2a\u8282\u70b9\u6240\u6709\u7684\u9009\u62e9\u4f5c\u4e3a\u4e00\u7ec4\uff0c\u6bcf\u4e00\u4e2a\u9009\u62e9\u662f\u4e2a\u7269\u54c1\u3002\n\n\u90a3\u597d\uff0c\u4e0d\u9700\u8981\u6bcf\u4e2a\u8282\u70b9\u90fd\u5f00\u4e00\u5927\u5806\u5206\u5206\u652f\u679a\u4e3e\u4e86\uff0c\u6bcf\u4e2a\u8282\u70b9\u90fd\u505a\u4e00\u6b21\u5206\u7ec4\u80cc\u5305\uff0c\u590d\u6742\u5ea6n^3\uff0c\u4e00\u770b\u6570\u636e\u91cf\uff1a300\uff0c\u59a5\u4e86\uff01\n\n\u5f53\u7136\u5206\u7ec4\u80cc\u5305\u600e\u4e48\u505a\u5462\uff1f\n\n\u5bf9\u4e8e\u53f6\u8282\u70b9\u76f4\u63a5\u628a\u5b83\u81ea\u5df1\u7b97\u4e0a\u5c31\u5b8c\u4e8b\u4e86\u3002\n\u5bf9\u4e8e\u5176\u4ed6\u8282\u70b9\u5148\u8ba1\u7b97\u6bcf\u7ec4\u5e26\u6765\u7684\u6536\u76ca\uff0c\u6700\u540e\u52a0\u4e0a\u81ea\u5df1\u5e26\u6765\u7684\u6536\u76ca\u3002\n\u5bf9\u4e8e\u8d85\u7ea7\u6839\u8282\u70b90\u8282\u70b9\uff0c\u6ca1\u6709\u81ea\u5df1\uff0c\u6240\u4ee5\u4e0d\u505a\u52a0\u81ea\u5df1\u7684\u64cd\u4f5c\u3002\n\n\u4e0d\u4f1a\u5206\u7ec4\u80cc\u5305\u90a3\u5c31\u771f\u6ca1\u6551\u4e86\uff08\u5c31\u662f\u6211\uff09\n\n\u5b8c\u4e8b\u3002",
        "postTime": 1571480149,
        "uid": 184681,
        "name": "cscy",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u5927\u4f6c\u4eec\u90fd\u7528\u7684\u6811\u5f62DP\u5199\u7684.....\n\n## ~~\u90a3\u5c31\u8ba9\u6211\u6765\u4ecb\u7ecd\u4e00\u4e0b\u7384\u5b66\u7684DFS\u5e8f\u5199\u6cd5\u5427~~\n\n(\u6781\u6613\u53d1\u73b0\u8fd9\u79cd\u5199\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(NM),\u800cdalao\u4eec\u7684\u6811\u5f62DP\u5199\u6cd5\u4e00\u822c\u662fN\u4e09\u65b9\u7684.....\n\n\u5177\u4f53\u601d\u8def\u5c31\u662f\uff1a\u5148\u6309\u7167\u8bfe\u4e0e\u8bfe\u4e4b\u95f4\u7684\u5173\u7cfb\u5efa\u4e00\u68f5\u6811\uff0c\u5982\u679c\u6ca1\u6709\u5148\u884c\u8bfe\u5c31\u8fde\u5728\u865a\u62df\u8282\u70b9\u4e0a(\u4fdd\u8bc1\u5efa\u51fa\u7684\u662f\u4e00\u68f5\u6811)\uff0c\u4e4b\u540e\u6c42\u51fa\u8fd9\u68f5\u6811\u7684DFS\u5e8f\uff0cDP\u5728DFS\u5e8f\u4e0a\u64cd\u4f5c\uff0cDP\u90e8\u5206\u7684\u5177\u4f53\u6ce8\u91ca\u5728\u4ee3\u7801\u91cc\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,m,DFS[100000],len,size[100000],ans,dp[1000][1000];\nstruct leason{\n\tint k,s;\n}l[100000];\nstruct edge{\n\tint v,next;\n}e[100000];\nint cnt,head[10000];\nvoid add(int u,int v){\n\te[++cnt].v=v;\n\te[cnt].next=head[u];\n\thead[u]=cnt;\n}\nvoid dfs(int u,int fa){\n\tsize[u]=1;\n\tDFS[++len]=u;\n\tfor(int i=head[u];i;i=e[i].next){\n\t\tint v=e[i].v;\n\t\tif(v==fa) continue;\n\t\tdfs(v,u);\n\t\tsize[u]+=size[v];\n\t}\n}\nint main(){\n\tscanf(\"%d %d\",&n,&m);\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%d %d\",&l[i].k,&l[i].s);\n\t\tadd(i,l[i].k);\n\t\tadd(l[i].k,i);\n\t}\n\tdfs(0,-1);\n\tdp[n+1+1][0]=0;\n\tfor(int i=len;i>=1;i--)\n\t\tfor(int j=1;j<=m+1;j++)\n\t\t\tdp[i][j]=max(dp[i+size[DFS[i]]][j],dp[i+1][j-1]+l[DFS[i]].s);\n\t//\u8fd9\u91cc\u5206\u4e24\u79cd\u60c5\u51b5:\u82e5i\u4e0d\u9009,\u5219i\u7684\u5b50\u6811\u90fd\u4e0d\u80fd\u9009,\u4e8e\u662f\u8df3\u8fc7i\u53cai\u7684\u5b50\u6811\n\t//\u82e5i\u8981\u9009,\u5219\u8fdb\u5165i\u7684\u5b50\u6811\u4e2d\u63a5\u7740\u9009; \n\tcout<<dp[1][m+1]<<endl;\n\treturn 0;\n}\n\n```\n\n",
        "postTime": 1568511014,
        "uid": 203825,
        "name": "\u5207\u683c\u74e6\u00b7\u661f",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u8fd9\u9898\u5176\u5b9e\u5b8c\u5168\u6ca1\u6709\u63d0\u9ad8+/\u7701\u9009-\u7684\u96be\u5ea6\uff0c\u4f46\u5bf9\u4e8e\u6211\u8fd9\u79cddp\u849f\u84bb\u6765\u8bf4\u8fd8\u662f\u9700\u8981\u601d\u8003\u4e00\u6bb5\u65f6\u95f4\u7684\uff0c\u8bf4\u6b63\u4e8b\uff0c\u5206\u6790\u9898\u76ee\u3002\n\n\u9996\u5148\u6211\u4eec\u53d1\u73b0\u6570\u636e\u8303\u56f4\u5f88\u5c0f\u53ea\u6709300\uff0c\u54ea\u6015\u662f\u7206\u641c\u53ef\u80fd\u4e5f\u4f1a\u6709\u5927\u4f6c\u80fd\u8fc7\uff0c\u4f46\u6211\u8fd9\u91cc\u6ca1\u6709\u8fd9\u6837\u5199\uff0c\u8fd9\u9898\u601d\u8def\u6bd4\u8f83\u5bb9\u6613\u60f3\u5230\uff0c\u4e00\u5171\u6709n\u4e2a\u8bfe\u7a0b\uff0c\u4f46\u540c\u6837\u6709n\u6761\u8fb9\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u8bbe0\u8282\u70b9\u4e3a\u6839\u8282\u70b9\uff0c\u5c31\u6709n+1\u4e2a\u70b9\uff0cn\u6761\u8fb9,\u521a\u597d\u6784\u6210\u6811\u5f62\u7ed3\u6784\uff0c\u7136\u540e\u8fd9\u9053\u9898\u662f\u6c42\u6700\u591am\u4e2a\u8bfe\u7a0b\u6240\u80fd\u83b7\u5f97\u7684\u6700\u5927\u5b66\u5206\uff0c\u5f88\u663e\u7136\u662f\u4e00\u9053dp\u9898\uff0c\u800c\u4e14\u662f\u80cc\u5305\u3002\n\n\u6211\u4eec\u8bbef[x][t]\u4e3a\u4ee5x\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u9009t\u95e8\u8bfe\u6240\u80fd\u5f97\u5230\u7684\u6700\u9ad8\u5b66\u5206\uff0c\u8bbex\u7684\u5b50\u8282\u70b9\u96c6\u5408\u4e3ason(x)\uff0c\u6211\u4eec\u53ef\u4ee5\u5efa\u4e00\u4e2avector\u6570\u7ec4\u4fdd\u5b58\uff0c\u5b50\u8282\u70b9\u4e2a\u6570\u5c31\u4e3ason[x].size(),\u7136\u540e\u6211\u4eec\u5faa\u73af\u5b50\u8282\u70b9\uff0c\u518d\u5012\u5e8f\u5faa\u73af\u5f53\u524d\u9009\u8bfe\u95e8\u6570\uff0c\u7ee7\u7eed\u5faa\u73af\u66f4\u6df1\u5b50\u6811\u4e0a\u7684\u9009\u8bfe\u95e8\u6570\u5c31\u53ef\u4ee5\u4e86\u3002\n\u76f4\u63a5\u4e0a\u4ee3\u7801\uff0c35\u884c\u7b80\u6d01\u660e\u4e86\u3002\n\n```\n#include<iostream>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#include<vector>\n#include<cstdio>\nusing namespace std;\n#define N 305\nint f[N][N],s[N],n,m;\nvector<int>son[N];\ninline void dp(int x)\n{\n\tf[x][0]=0;\n\tfor(int i=0;i<son[x].size();i++)\n\t{\n\t\tint y=son[x][i];dp(y);for(int t=m;t>=0;t--)for(int j=t;j>=0;j--)\n\t\tif(t-j>=0)f[x][t]=max(f[x][t],f[x][t-j]+f[y][j]);\n\t}\n\tif(x!=0)\n\tfor(int t=m;t>=0;t--)f[x][t]=f[x][t-1]+s[x];\n} \n int main()\n {\n \tscanf(\"%d%d\",&n,&m);\n \tfor(int i=1;i<=n;i++)\n \t{\n \t\tint x;\n \t\tscanf(\"%d%d\",&x,&s[i]);\n \t\tson[x].push_back(i);\n\t }\n\t memset(f,-1*0x3f,sizeof(f));\n\t dp(0);\n\t printf(\"%d\",f[0][m]);\n\t return 0;\n }\n```\n",
        "postTime": 1565398977,
        "uid": 111294,
        "name": "xcyy",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "## [\u9898\u76ee\u63cf\u8ff0](https://www.luogu.org/problemnew/show/P2014)\n\n\u70b9\u5f00\u65c1\u8fb9\u7684\u7b97\u6cd5\u6807\u7b7e\uff0c\u53d1\u73b0\u662f\u6811\u5f62dp;\n\u597d\u7684\uff0c\u5f00\u59cb\u627e\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n\u5b9e\u9645\u4e0a\u8fd9\u9053\u9898\u4e0e\u4e8c\u53c9\u82f9\u679c\u6811\u5f88\u50cf\uff1b\n\n\u4e00\u4e2a\u662f\u526a\u4e0d\u526a\u5f53\u524d\u8fd9\u4e2a\u6811\u679d\u4ee5\u53ca\u5b83\u513f\u5b50\u526a\u591a\u5c11\u679d\u8c0b\u6c42\u6700\u5927\u503c\uff1b\n\n\u800c\u8fd9\u9053\u662f\u4fee\u5230i\u79d1\u76ee\u540e\uff0c\u5728\u5b83\u513f\u5b50\u4e0a\u518d\u4feek\u95e8\u8bfe\uff0c\u518d\u5728\u4e0d\u662f\u4ed6\u513f\u5b50\u7684\u79d1\u76ee\u4e0a\u9009m-k-1\u95e8\uff1b\n\n\uff08\u8fd9\u8bf4\u7684\u6709\u70b9\u7ed5\uff0c\u5f85\u4f1a\u5c31\u6e05\u6670\u4e86\uff09\n\n### \u4f46\u662f\n\n\u4e8c\u53c9\u82f9\u679c\u6811\u5df2\u7ecf\u662f\u4e00\u9897\u597d\u7684\u4e8c\u53c9\u6811\u4e86~~\u5e9f\u8bdd~~\n\n\u800c\u9009\u8bfe\u7ed9\u7684\u662f\u4e00\u4e2a\u591a\u53c9\u6811\uff0c\u6240\u4ee5\u8981\u5c06\u5176\u8f6c\u5316\u4e3a\u4e8c\u53c9\n\n\u6b64\u9898\u76ee\u82e5\u4e0d\u8f6c\u6362\u4e3a\u4e8c\u53c9\u6811\uff0c\u5219\u72b6\u6001\u9700\u5b9a\u4e49\u4e3adp[i][j][k](k=1\u62160,0\u4ee3\u8868\u4e0d\u9009i\uff0c1\u4ee3\u8868\u9009i\uff08\u6709\u70b9\u9ebb\u70e6\uff09\n\n\n## \u591a\u53c9\u6811\u8f6c\u6362\u4e8c\u53c9\u6811\uff1a\n\n\u65b9\u6cd5\u975e\u5e38\u7b80\u5355,\u201c\u5de6\u513f\u5b50,\u53f3\u5144\u5f1f\u201d \u3002\n\n\u5c31\u662f\u5c06\u4e00\u4e2a\u8282\u70b9\u7684\u7b2c\u4e00\u4e2a\u513f\u5b50\u653e\u5728\u5de6\u513f\u5b50\u7684\u4f4d\u7f6e\n\n\u4e0b\u4e00\u4e2a\u513f\u5b50\uff0c\u5373\u5de6\u513f\u5b50\u7684\u7b2c\u4e00\u4e2a\u5144\u5f1f,\u653e\u5728\u5de6\u513f\u5b50\u7684\u53f3\u513f\u5b50\u4f4d\u7f6e\u4e0a\n\n\u518d\u4e0b\u4e00\u4e2a\u5144\u5f1f\u63a5\u7740\u653e\u5728\u53f3\u513f\u5b50\u7684\u53f3\u513f\u5b50\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\n\n\u4ee3\u7801\uff1a\n```\nscanf(\u201c%d%d\u201d,&u,&v)  //v\u7684\u7236\u4eb2\u662fu\nif(last[u]==0)l[u]=v;    //\u5c06v\u4f5c\u4e3au\u7684\u5de6\u513f\u5b50\nelse r[last[u]]=v;   //\u5c06v\u4f5c\u4e3au\u7684\u6700\u540e\u4e00\u4e2a\u5b50\u5b59\u7684\u53f3\u513f\u5b50\nlast[u]=v;   //last\u6570\u7ec4\u8bb0\u5f55u\u7684\u6700\u540e\u4e00\u4e2a\u5b50\u5b59\n```\n(\u53ef\u4ee5\u7528\u6837\u4f8b\u81ea\u884c\u6a21\u62df\u4e00\u4e0b)\n\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n\n\u5728\u8f6c\u5316\u540e\u7684\u4e8c\u53c9\u6811\u4e0a\uff0c\u6211\u4eec\u5982\u679c\u9009\u7b2c1\uff0c\u5c31\u5fc5\u987b\u5148\u90092\uff0c\u5982\u679c\u90093\uff0c\u4e0d\u4e00\u5b9a\u8981\u90092\u3002\n\n\u8bbedp[i][j]\u8868\u793a\u9009\u5230\u7b2ci\u95e8\u8bfe\uff0c\n\u8fd8\u8981\u9009j\u95e8\u8bfe\u7684\u6700\u5927\u5b66\u5206\uff0c\n\n\u90a3\u4e48\u5206\u4e24\u79cd\u60c5\u51b5\u8ba8\u8bba\uff1a\n\u5982\u679c\u9009i\uff0c\u5219\u8fd8\u8981\u5728l[i]\u4e0a\u9009k\u95e8\uff0c\u5e76\u4e14\u5728r[i]\u4e0a\u9009\u5c31j-k-1\u95e8\n\n\u5982\u679c\u4e0d\u9009i\uff0c\u5219\u53ea\u80fd\u5728r[i]\u4e0a\u9009j\u95e8\uff0c0<=k<j\u3002\n\n![\u8f6c\u5316\u540e\u7684\u6837\u4f8b](https://cdn.luogu.com.cn/upload/pic/58803.png)\n\n\n\u56e0\u4e3a\u662f\u6811\u5f62\uff0c\u6240\u4ee5\u6211\u4eec\u7684\u641c\u7d22\u987a\u5e8f\u5f53\u7136\u662fdfs\uff0c\u4ece\u6839\u7ed3\u70b9\u5411\u53f6\u5b50\u7ed3\u70b9\u641c\u7d22\uff0c\u8fd9\u6837\u5c31\u5b9e\u73b0\u53f6\u5b50\u5411\u6839\u4f20\u503c\uff0c\u8bb0\u5f97\u8bb0\u5fc6\u5316\u54e6\u3002\n\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint read() \n{\n\tint x=0,f=1;char c=getchar();\n\twhile(!isdigit(c)){if(c=='-') f=-1;c=getchar();}\n\twhile(isdigit(c)){x=x*10+c-'0';c=getchar();}\n\treturn x*f;\n}\n\nint last[1010],l[1010],r[1010];//l\u4ee3\u8868\u5de6\u513f\u5b50\uff08\u5373\u8981\u6709\u5148\u4fee\uff09\uff0cr\u4ee3\u8868\u53f3\u513f\u5b50\uff08\u5373\u65e0\u5148\u9700\u4fee\uff09 \nint dp[1010][1010],s[1010];\nint n,m;\n\nint work(int k,int t)//k\u8868\u793a\u6b64\u8bfe\u7a0b\uff0ct\u8868\u793a\u8fd8\u9700\u4feet\u95e8\u8bfe \n{\n\tif(dp[k][t]>=0) return dp[k][t];//\u8bb0\u5fc6\u5316 \n\tif(k==0) return 0;//\u53f6\u5b50\u8282\u70b9\uff0c\u5373\u63a5\u4e0b\u6765\u6ca1\u6709\u8bfe\u53ef\u4fee \n\tdp[k][t]=work(r[k],t); //\u5982\u679c\u4e0d\u9009k\uff0c\u5219\u53ea\u80fd\u5728r[k]\u4e0a\u9009t\u95e8 \n\tfor(int i=0;i<t;++i)\n\t{\n\t\tdp[k][t]=max(dp[k][t],(work(l[k],i)+work(r[k],t-i-1)+s[k]));//\u5982\u679c\u9009k\uff0c\u5219\u8fd8\u8981\u5728l[k]\u4e0a\u9009i\u95e8\uff0c\u5e76\u4e14\u5728r[k]\u4e0a\u9009\u5c31t-i-1\u95e8\n\t}\n\treturn dp[k][t];\n}\n\nint readdate()\n{\n\tn=read(),m=read();\n    //\u8f6c\u4e8c\u53c9 \n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tint v=i,u=read();\n\t\ts[i]=read();\n\t\tif(last[u]==0) l[u]=v;\n\t\telse r[last[u]]=v;\n\t\tlast[u]=v;\n\t}\n\tmemset(dp,-1,sizeof(dp));\n\tprintf(\"%d\",work(1,m));\n}\n\nint main()\n{\n\treaddate();\n\treturn 0;\n} \n```\n\n\u5b9e\u9645\u4e0a\u8fd8\u662f\u6709\u70b9\u5c0f\u95ee\u9898\u7684\uff08~~\u56e0\u4e3a\u6ca1\u8fc7\u6837\u4f8b~~\uff09\uff0c\u4f46\u8fd8\u662fac\u4e86;\n\n\u6240\u4ee5\u540c\u5b66\u4eec\u53ef\u4ee5\u81ea\u884c\u4fee\u6b63\n\n\n\n\n\n\n\n",
        "postTime": 1557984563,
        "uid": 78706,
        "name": "Max__HE",
        "ccfLevel": 0,
        "title": "P2014  \u9009\u8bfe"
    },
    {
        "content": "\u4ecb\u7ecd\u4e00\u79cd\u4f18\u5316\uff01\uff08\u6811\u5f62dp\u601d\u8def\u53ef\u4ee5\u81ea\u884c\u770b\u4e0a\u4e00\u7bc7\u9898\u89e3orz\uff09\n\n\u5728\u5904\u7406\u6bcf\u4e2a\u8282\u70b9\u7684\u65f6\u5019\uff0c\u6211\u4eec\u4e0d\u7528\u5904\u7406\u5230m+1\u7684\u8303\u56f4\uff0c\u56e0\u4e3a\u4ed6\u672c\u8eab\u5c31\u6ca1\u6709\u90a3\u4e48\u591a\u513f\u5b50\uff0c\u4e0a\u9762\u7684\u7ed3\u679c\u548cF[u][\u6700\u5927\u513f\u5b50\u6570]\u7684\u7ed3\u679c\u5176\u5b9e\u662f\u4e00\u6837\u7684QwQ\n\n\u4f8b\u5982\uff1a\u5bf9\u4e8e\u53ea\u67092\u4e2a\u513f\u5b50\u7684\u8282\u70b9\uff0c\u6211\u4eec\u5c31\u53ea\u7528\u7b97\u5230F[i][3]\u5c31\u884c\u4e86\n\n\u4e8e\u662f\u5c31\u53ef\u4ee5\u5904\u7406\u51fa\u6bcf\u4e2a\u8282\u70b9\u7684\u513f\u5b50\u6570\u518ddp\uff01\n\n\u672c\u4eba\u81ea\u5e26\u5de8\u5927\u5e38\u657015msQAQ\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\nusing namespace std;\nint read(){\n    int x=0;char ch=getchar();bool pos=1;\n    for(;!isdigit(ch);ch=getchar()) if(ch=='-') pos=0;\n    for(;isdigit(ch);ch=getchar()) x=x*10+ch-'0';\n    return pos?x:-x; \n}\nint n,m,t,top=0,c[30001],f[305][305],sum[30001],head[30001];\nstruct node{\n    int v,next;\n}edge[30001];\ninline void add(int u,int v){\n    edge[++top].v=v;\n    edge[top].next=head[u];\n    head[u]=top;\n}\ninline void count(int now){\n\tsum[now]++;\n\tfor(int i=head[now];i;i=edge[i].next){\n\t\tint v=edge[i].v;\n\t\tcount(v);\n\t\tsum[now]+=sum[v];\n\t}\n\treturn;\n}\ninline void dp(int now){\n\t//f[now][0]=0;\n\tfor(int i=1;i<=sum[now];i++) f[now][i]=c[now];\n\tif(head[now]){\n\t\tfor(int i=head[now];i;i=edge[i].next){\n\t\t\tint v=edge[i].v;\n\t\t\tdp(v);\n\t\t\tfor(int w=sum[now];w>=1;w--){\n\t\t\t\tint p=min(w-1,sum[v]);//\u4f18\u5316\u8fc7\u7a0b\n\t\t\t\tfor(int k=0;k<=p;k++){\n\t\t\t\t\tf[now][w]=max(f[now][w],f[now][w-k]+f[v][k]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn;\n}\nint main(){\n\tn=read();m=read();\n\tfor(int i=1;i<=n;i++){\n\t\tint k=read();c[i]=read();\n\t\tadd(k,i);\n\t}\n\tcount(0);\n\tdp(0);\n\tcout<<f[0][m+1];\n\treturn 0;\n}\n```",
        "postTime": 1545112525,
        "uid": 48744,
        "name": "TLE\u81ea\u52a8\u673a",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "```cpp\n//\u770b\u4e86\u597d\u51e0\u7bc7\u9898\u89e3\u5927\u591a\u90fd\u662fdp\n//\u50cf\u6211\u8fd9\u770b\u89c1dp\u5c31\u98a4\u6296\u7684\u5c0f\u849f\u84bb\u611f\u5230\u5341\u5206\u5bb3\u6015\n//\u4e8e\u662f\u7ed9\u5927\u5bb6\u6765\u4e00\u4efd\u4e8c\u53c9\u6811\u7684\u9898\u89e3\n//\u7b2c\u4e00\u6b21\u5199\u9898\u89e3\uff0c\u6709\u4ec0\u4e48\u5199\u5f97\u4e0d\u597d\u7684\u8bf7\u5927\u5bb6\u89c1\u8c05 \n//\u89e3\u91ca\u90fd\u5728\u6ce8\u91ca\u91cc \n#include<cstdio>\n#include<algorithm>\n#include<cstring>\nusing namespace std;\nconst int N=300+400;\nint n,m;\nint vis[N],val[N],dp[N][N];\nstruct node\n{\n    int lef,rig;\n}tree[N*4];\nvoid dfs(int x,int y)//x\u662f\u5230\u4e86\u54ea\u8282\u8bfe \uff0cy\u662f\u8fd8\u5269\u591a\u5c11\u8282\u8bfe\u53ef\u4ee5\u9009 \n{\n    int maxval=0;\n    if(x==0)return;//\u5f53\u524d\u5206\u652f\u6ca1\u6709\u8bfe\u53ef\u4ee5\u9009\u4e86\u5c31\u8fd4\u56de \n    if(y==0)return;//\u9009\u8bfe\u7684\u6b21\u6570\u5df2\u7ecf\u7528\u5b8c\u5c31\u8fd4\u56de \n    if(dp[x][y]> 0)return;//\u5982\u679c\u5df2\u7ecf\u641c\u8fc7\u8fd9\u4e00 \u60c5\u51b5\u5c31\u8fd4\u56de \n    dfs(tree[x].rig,y);//\u5148\u4ece\u5b83\u7684\u5144\u5f1f\u641c\u8d77 \n    maxval=max(maxval,dp[tree[x].rig][y]);//\u53d6\u6700\u5927\u503c \n    dp[x][y]=0;\n    for(int i=1;i<=y;i++)//\u5728\u641c\u5b83\u7684\u513f\u5b50\uff0c\u8fd9\u91cc\u662f\u5728\u679a\u4e3e\u5206\u522b\u7ed9\u513f\u5b50\u548c\u5144\u5f1f\u5206\u591a\u5c11\u8282\u8bfe \n    {\n        dfs(tree[x].lef,i-1);\n        dfs(tree[x].rig,y-i);\n        if(maxval<dp[tree[x].lef][i-1]+dp[tree[x].rig][y-i]+val[x]){\n            maxval=max(maxval,dp[tree[x].lef][i-1]+dp[tree[x].rig][y-i]+val[x]);//\u53d6\u6700\u5927\u503c \n        }\n    }\n    dp[x][y]=maxval;//\u8d4b\u503c \n}\nint main()\n{\n    int root=0;\n    memset(dp,0,sizeof(dp));\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n;i++)\n    {\n        int x,w;\n        scanf(\"%d%d\",&x,&w);\n        val[i]=w;\n        if(x==0&&root==0)root=i;//\u9996\u5148\u786e\u5b9a\u6839\u8282\u70b9 \n        if(!vis[x])tree[x].lef=i;//\u5982\u679cx\u7684\u7236\u4eb2\u8fd8\u6ca1\u6709\u513f\u5b50\uff0c\u5c31\u628a\u5b83\u4f5c\u4e3a\u5b83\u7236\u4eb2\u7684\u5de6\u513f\u5b50 \n        else tree[vis[x]].rig=i;//\u5426\u5219\u5c31\u662f\u4ed6\u7236\u4eb2\u5de6\u513f\u5b50\u7684\u5144\u5f1f \n        vis[x]=i;//\u66f4\u65b0\u4ed6\u7236\u4eb2\u7684\u513f\u5b50\u60c5\u51b5 \n    }\n    dfs(root,m);//\u5f00\u59cb\u6df1\u641c \n    printf(\"%d\",dp[root][m]);\n    return 0;\n}\n```",
        "postTime": 1541725212,
        "uid": 111991,
        "name": "\u53d6\u540d\u597d\u70e6\u4eba",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "## P2014 \u9009\u8bfe ------>[P2014 \u9009\u8bfe](https://www.luogu.org/problemnew/show/P2014)\n\n# \u9898\u76ee\u63cf\u8ff0\n#### \u5728\u5927\u5b66\u91cc\u6bcf\u4e2a\u5b66\u751f\uff0c\u4e3a\u4e86\u8fbe\u5230\u4e00\u5b9a\u7684\u5b66\u5206\uff0c\u5fc5\u987b\u4ece\u5f88\u591a\u8bfe\u7a0b\u91cc\u9009\u62e9\u4e00\u4e9b\u8bfe\u7a0b\u6765\u5b66\u4e60\uff0c\u5728\u8bfe\u7a0b\u91cc\u6709\u4e9b\u8bfe\u7a0b\u5fc5\u987b\u5728\u67d0\u4e9b\u8bfe\u7a0b\u4e4b\u524d\u5b66\u4e60\uff0c\u5982\u9ad8\u7b49\u6570\u5b66\u603b\u662f\u5728\u5176\u5b83\u8bfe\u7a0b\u4e4b\u524d\u5b66\u4e60\u3002\u73b0\u5728\u6709N\u95e8\u529f\u8bfe\uff0c\u6bcf\u95e8\u8bfe\u6709\u4e2a\u5b66\u5206\uff0c\u6bcf\u95e8\u8bfe\u6709\u4e00\u95e8\u6216\u6ca1\u6709\u76f4\u63a5\u5148\u4fee\u8bfe\uff08\u82e5\u8bfe\u7a0ba\u662f\u8bfe\u7a0bb\u7684\u5148\u4fee\u8bfe\u5373\u53ea\u6709\u5b66\u5b8c\u4e86\u8bfe\u7a0ba\uff0c\u624d\u80fd\u5b66\u4e60\u8bfe\u7a0bb\uff09\u3002\u4e00\u4e2a\u5b66\u751f\u8981\u4ece\u8fd9\u4e9b\u8bfe\u7a0b\u91cc\u9009\u62e9M\u95e8\u8bfe\u7a0b\u5b66\u4e60\uff0c\u95ee\u4ed6\u80fd\u83b7\u5f97\u7684\u6700\u5927\u5b66\u5206\u662f\u591a\u5c11\uff1f\n\n# \u8f93\u5165\u8f93\u51fa\u683c\u5f0f\n### \u8f93\u5165\u683c\u5f0f\uff1a\n####  \u7b2c\u4e00\u884c\u6709\u4e24\u4e2a\u6574\u6570N,M\u7528\u7a7a\u683c\u9694\u5f00\u3002(1<=N<=300,1<=M<=300)\u63a5\u4e0b\u6765\u7684N\u884c,\u7b2cI+1\u884c\u5305\u542b\u4e24\u4e2a\u6574\u6570ki\u548csi, ki\u8868\u793a\u7b2cI\u95e8\u8bfe\u7684\u76f4\u63a5\u5148\u4fee\u8bfe\uff0csi\u8868\u793a\u7b2cI\u95e8\u8bfe\u7684\u5b66\u5206\u3002\u82e5ki=0\u8868\u793a\u6ca1\u6709\u76f4\u63a5\u5148\u4fee\u8bfe\uff081<=ki<=N, 1<=si<=20\uff09\u3002\n\n### \u8f93\u51fa\u683c\u5f0f\uff1a\n#### \u53ea\u6709\u4e00\u884c\uff0c\u9009M\u95e8\u8bfe\u7a0b\u7684\u6700\u5927\u5f97\u5206\u3002\n\n\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a \u591a\u53c9\u6811 \u8f6c \u4e8c\u53c9\u6811\uff01\uff01\n\u53d8\u5f62\u5f88\u91cd\u8981\uff01\uff01\n\u5148\u9644\u4e0a\u53d8\u5f62\u4ee3\u7801\n```c\nfor(rg int i=1;i<=n;i++){\n//\u4e0d\u5fc5\u7ea0\u7ed3rg\u662f\u5565\uff0c\u540e\u9762\u4ee3\u7801\u6709\n        int a,b;\n        read(a),read(b);//i\u7684\u5148\u9009\u8bfe\u4e3aa\uff0c\u5b66\u5206\u4e3ab \n        shu[i]=b;\n        if(last[a]==0) l[a]=i;\n        else r[last[a]]=i;\n        last[a]=i;\n    }\n//l[]\u6570\u7ec4\u4e3a\u8be5\u70b9\u7684\u513f\u5b50\n//r[]\u6570\u7ec4\u4e3a\u8be5\u70b9\u7684\u5144\u5f1f\n//\u5982\u679c\u67d0x\u6709\u591a\u4e2a\u5144\u5f1f\uff0c\u5c31\u5c06\u53f3\u5b50\u6811\u4e0d\u505c\u5ef6\u957f\n//\u76f4\u5230\u6ca1\u5f97\n//\u5de6\u5b50\u6811\u540c\u7406\n//last\u6570\u7ec4\u4e3ax\u7684\u70b9\u7684\u6700\u540e\u4e00\u4e2a\u513f\u5b50\n```\ndp\u7684\u52a8\u6001\u8f6c\u79fb\u65b9\u7a0b\u5f88\u91cd\u8981\n\ncode--->\n```c\nfor(rg int k=0;k<dep;k++){\n\n  dp[x][dep]=max(max(dp[x][dep],dfs(l[x],k)+dfs(r[x],dep-k-1)+shu[x]),dfs(r[x],dep));\n  \n}\n```\n\u8fd9\u4e2a\u8f6c\u79fb\u5f88\u5371\u9669\uff01\uff01\n\u4e00\u662fl[x]=0 \u5c31\u662f\u53f6\u5b50\u7ed3\u70b9\u7684\u513f\u5b50\u6ca1\u5f97\uff0c\u4f46\u5728\u6570\u7ec4\u91cc\u6211\u4eec\u8ba4\u4e3a0\u662f\u6574\u4e2a\u68ee\u6797\u7684\u7ec8\u7ed3\u70b9\uff0c\u6240\u4ee5\u8981\u7279\u5224\n---->\n```c\nif (x<1||dep<1||x>n||dep>m) return 0;\n```\n\n\u4e8c\u662f\u5df2\u7ecfdp\u6570\u7ec4 \u8981\u526a\u679d\uff0c\u5f88\u70e6\uff01\uff01\n\n\u5c31\u662f\u5df2\u7ecf\u6709\u503c\u7684\u4e0d\u6539\u4e86\u5c31\u662f\u8fd9\u6837\u7684\n```c\n\nif(dp[x][dep]!=0)return dp[x][dep];\n\n```\n\u597d\u4e86\u63a5\u4e0b\u6765\u5c31\u662f\u5168\u90e8\u4ee3\u7801\n\n```c\n#include<cstdio>\n#include<string>\n#define il inline\n#define rg register\n#define maxn 305\nusing namespace std;\n\nil void read(int & x){\n   \tx=0;int f=1;char chr=getchar();\n\twhile(chr<'0'||chr>'9'){if(chr=='-')f=-1;chr=getchar();}\n\twhile(chr>='0'&&chr<='9'){x=x*10+(chr-'0');chr=getchar();}x=x*f;return ;\n}\n\nil void print(int x){if(x<0)putchar('-'),x=-x;if(x>9)print(x/10);putchar(x%10+'0');return ;}\n\nil void clear(int a[],int n,int x){for(rg int i=1;i<=n;i++) a[i]=x;}\n\n/*-----------------------------------------------------------------------------------------------*/ \nint n,m,dp[maxn][maxn];\nint l[maxn],r[maxn],last[maxn],shu[maxn];//\u5de6\u513f\u5b50\u53f3\u5144\u5f1f \n\n/*-----------------------------------------------------------------------------------------------*/ \n\nil int dfs(int x,int dep){\n//\tprint(233333333),\n//\tputs(\"\");\n//\tprint(x),putchar(' '),print(dep),puts(\"\");\n\tif (x<1||dep<1||x>n||dep>m) return 0;\n\tif(dp[x][dep]!=0)return dp[x][dep];\n\tfor(rg int k=0;k<dep;k++){\n\t\tdp[x][dep]=max( max( dp[x][dep] , dfs(l[x],k)+dfs(r[x],dep-k-1)+shu[x] )  ,  dfs(r[x],dep) );\n\t}\n\treturn dp[x][dep];\n}\n\n/*-----------------------------------------------------------------------------------------------*/ \n\nint main(){\n\tread(n),read(m);\n\tfor(rg int i=1;i<=n;i++){\n\t\tint a,b;\n\t\tread(a),read(b);//i\u7684\u5148\u9009\u8bfe\u4e3aa\uff0c\u5b66\u5206\u4e3ab \n\t\tshu[i]=b;\n\t\tif(last[a]==0) l[a]=i;\n\t\telse r[last[a]]=i;\n\t\tlast[a]=i;\n\t}\n\tint root=l[0];\n\tdfs(root,m);\n\tprint(dp[l[0]][m]);\n\treturn 0;\n}\n\n```\n\u723d\uff01\uff01----->END<-----",
        "postTime": 1540301662,
        "uid": 114405,
        "name": "Dennis_MacAlistair",
        "ccfLevel": 0,
        "title": "P2014 \u9009\u8bfe"
    },
    {
        "content": "//\u8fd1\u51e0\u5929\u6211\u5b66\u4e60\u4e86\u6811\u72b6\u80cc\u5305\uff0c\u5bf9\u4e8e\u4e00\u540d\u4ece7\u6708\u4efd\u624d\u5f00\u59cb\u5b66\u7684\u849f\u84bb\uff0c\u8fd8\u662f\u6709\u4e9b\u96be\u4ee5\u7406\u89e3\n\n//\u5728\u6b64\u6211\u6765\u4ee5\u4e00\u540d\u849f\u84bb\u7684\u89d2\u5ea6\u6765\u89e3\u6790\u4e00\u4e0b\u9898\u76ee\n\n//\u770b\u5230\u9898\u76ee\uff0c\u6211\u7684\u7b2c\u4e00\u60f3\u6cd5\u5c31\u662f\u753b\u56fe\uff08\u597d\u7406\u89e3\uff09 \u7136\u800c\u6211\u53d1\u73b0\uff0c\u7ec4\u6210\u7684\u8c8c\u4f3c\u4e0d\u662f\u4e00\u68f5\u6811\n\n//\u6211\u4eec\u5f88\u8f7b\u677e\u53ef\u4ee5\u60f3\u5230\u8981\u5c062,3\u627e\u4e00\u4e2afa\uff0c\u6ca1\u6709\u5c31\u9020\u4e00\u4e2a\uff080\uff09\uff1b\n\n//\u8fd9\u6837\u6211\u4eec\u5c31\u628an\u4e2a\u8282\u70b9\u7684\u68ee\u6797\u8f6c\u5316\u6210n+1\u4e2a\u8282\u70b9\u7684\u6811\uff0c\u5176\u4e2d\u8282\u70b90\u4e3a\u6839\u8282\u70b9\n```cpp\n#include<bits/stdc++.h>\n#define maxn 200000\nusing namespace std;\nstruct Edge\n{\n\tint v,next;\n} e[maxn*2];\nint n,m;\nint f[2000][2000];\nint head[maxn*2],cnt=0;\nvoid add(int u,int v)\n{\n\te[++cnt].v=v;\n\te[cnt].next=head[u];\n\thead[u]=cnt;\n}\nvoid dp(int now)\n{\n\tfor(int i=head[now]; i!=-1; i=e[i].next)\n\t{\n\t\tint go=e[i].v;\n\t\tdp(go);\n\t\tfor(int j=m+1; j>=1; j--)\n\t\t\tfor(int k=0; k<j; k++)\n\t\t\t{\n\t\t\tf[now][j]=max(f[now][j],f[go][k]+f[now][j-k]);\n\t\t\t}//\u849f\u84bb\u53ef\u4ee5\u5148\u80cc\u4e00\u4e0b\uff0c\u4e4b\u540e\u518d\u7406\u89e3\n\t}\n}\nint main()\n{\tmemset(head,-1,sizeof(head));//\u4e00\u5b9a\u8981\u5199memset\n\tcin>>n>>m;\n\tfor(int i=1;i<=n;i++)\n\t{\n\tint fa;\n\tcin>>fa;\n\tcin>>f[i][1];\n\tadd(fa,i);\n\t}\n\tdp(0);\n\tcout<<f[0][m+1];//\u56e0\u4e3a\u5efa\u4e86\u4e00\u4e2a\u8282\u70b9\n}\n```",
        "postTime": 1540113662,
        "uid": 116132,
        "name": "\u7ba1\u4ef2",
        "ccfLevel": 0,
        "title": "P2014    \u5bf9\u4e8e\u6811\u72b6\u80cc\u5305\u7684\u4e00\u4e9b\u611f\u609f\u548c\u7406\u89e3"
    },
    {
        "content": "```cpp\n#include<cstdio>\n#include<cstring>\n#include<iostream>\nusing namespace std;\nstruct node\n{\n\tint lc,rc,c,v;//c\u8868\u793a\u503c\n\t//v\u8868\u793a\u4ed6\u6700\u540e\u4e00\u4e2a\u5b69\u5b50 \n\tnode()\n\t{\n\t\tlc=rc=-1;//\u521d\u59cb \n\t\tv=0;\n\t}\n}tr[110000];\nint f[1100][1100];//f[x][y]\u8868\u793a\u4ee5x\u4e3a\u6839\u8282\u70b9\uff0c\u4fdd\u7559y\u4e2a\u70b9\u7684\u6700\u5927\u503c \nint treedp(int x,int y)\n{\n\tif(x<0 || y<0) return 0;//\u600e\u4e48\u53ef\u80fd\u5c0f\u4e8e0\u5462 \n\tif(f[x][y]!=-1) return f[x][y];//\u8bb0\u5fc6\u5316\u641c\u7d22 \n\tint  maxx=0;//\u8bb0\u5f55\u6700\u5927\u503c \n\tfor(int i=0;i<=y;i++)\n\t{\n\t\tint ls=y-1-i,rs=i;//\u5de6\u8fb9\u7559y-1-i,\u53f3\u8fb9\u7559i\u4e2a\u70b9,\u6ce8\uff1ax\u81ea\u5df1\u4e5f\u8981\u4fdd\u7559\u6240\u4ee5\u8981-1 \n\t\tint lss=0,rss=0;\n\t\tif(tr[x].lc!=-1) lss=f[tr[x].lc][ls]=treedp(tr[x].lc,ls);//\u5982\u679c\u5de6\u5b50\u6811\u5b58\u5728 \n\t\tif(tr[x].rc!=-1) rss=f[tr[x].rc][rs]=treedp(tr[x].rc,rs);//\u5982\u679c\u53f3\u5b50\u6811\u5b58\u5728 \n\t\tif(ls<0) maxx=max(maxx,rss);\n\t\telse\t maxx=max(maxx,lss+rss+tr[x].c);\n\t}\n\treturn maxx;\n}\nint main()\n{\n\tint i,n,m,xx;\n\tscanf(\"%d%d\",&n,&m);\n\tfor(i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d%d\",&xx,&tr[i].c);\n\t\tif(tr[xx].v==0) tr[xx].lc=i;\n\t\telse\t\t\ttr[tr[xx].v].rc=i;\n\t\ttr[xx].v=i;\n\t}\n\tmemset(f,-1,sizeof(f));\n\tfor(i=0;i<=n;i++) f[i][0]=0;\n\tprintf(\"%d\\n\",treedp(0,m+1));\n\treturn 0;\n}\n```",
        "postTime": 1522480148,
        "uid": 66181,
        "name": "Celebrate",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u9009\u8bfe\u8fd9\u9898\uff0c\u6446\u660e\u4e86\u662f\u4e00\u4e2a\u6811\u5f62\u7684DP\uff08\u56e0\u4e3a\u8bfe\u7a0b\u4e4b\u524d\u5b58\u5728\u4ece\u5c5e\u5173\u7cfb\uff09\uff0c\u6709\u540c\u5b66\u5c31\u4f1a\u8d28\u7591\uff0c\u8fd9\u8fb9\u6570\u6446\u660e\u4e0d\u662f\u6811\u7ed3\u6784\u554a\uff0c\u4f46\u4e2a\u4eba\u8ba4\u4e3a\u4e0d\u4f1a\u6709\u73af\u7684\u5b58\u5728\uff0c\u56e0\u6b64\u4e0b\u9762\u6211\u4eec\u91c7\u7528\u4e00\u79cd\u5e38\u7528\u65b9\u6cd5\u6784\u5efa\u6811\u3002\n\n\u6784\u5efa\u4e00\u4e2a\u865a\u7684\u6839\u8282\u70b90\uff0c\u628a\u6ca1\u6709\u76f4\u63a5\u5148\u4fee\u8bfe\u7684\u8282\u70b9\u8fde\u4e0a\uff0c\u6211\u4eec\u6700\u540e\u7684\u7b54\u6848\u5c31\u662ff[0][m+1]\uff0c\u6307\u5728\u8282\u70b90\u4e2d\u9009m+1\u4e2a\u7ed3\u70b9\u7684\u6700\u5927\u5b66\u5206\u3002\n\nf[i][j]\u8868\u793a\u5728\u5b50\u6811i\u4e2d\u9009\u4e86j\u95e8\u8bfe\u7684\u6700\u5927\u5b66\u5206\uff08\u5305\u62ec\u672c\u8eab\uff09\n\n\u6211\u4eec\u5728\u8bb0\u5f55\u4e0b\u6bcf\u4e2a\u70b9\u4e4b\u524d\u7684\u8054\u7cfb\u5173\u7cfb\u4e4b\u540e\uff0c\u6211\u4eec\u8981\u5f00\u59cb\u4e0d\u53ef\u7f3a\u5c11\u7684\u4e00\u6b65\u2014\u2014\u2014dfs\uff0c\u5f53\u7136\u662f\u4ece\u6839\u8282\u70b9\u5f00\u59cb\uff0cdfs\uff080\uff09\n\n\u5728\u5bf9\u6bcf\u4e2a\u513f\u5b50\u5f00\u59cbDP\u524d\uff0c\u6211\u4eec\u9996\u5148\u8981\u5904\u7406\u5b8c\u8fd9\u4e2a\u513f\u5b50\uff0c\u56e0\u6b64dfs(\u513f\u5b50)\u5e94\u8be5\u653e\u5728DP\u4e4b\u524d\n\n    for (int i=head[x];i;i=next[i])\n\t{\n\t\tdfs(i);\n\t\tfor (int j=m+1;j>=0;j--)\n\t\tfor (int z=j-1;z>=0;z--)//\u4e4b\u6240\u4ee5\u51cf\u4e00\u662f\u56e0\u4e3a\u5fc5\u987b\u8981\u9009\u4e86\u7b2cx\u95e8\u8bfe\u624d\u80fd\u7ee7\u7eed\u9009\n\t\tf[x][j]=max(f[x][j],f[x][j-z]+f[i][z]);\n\t}\n\u600e\u4e48\u6837\uff1f\u8fd9\u6bb5\u4ee3\u7801\u662f\u4e0d\u662f\u5f88\u50cf\u80cc\u5305\u95ee\u9898\uff0c\u90a3\u4e48\u6211\u6765\u89e3\u91ca\u4e00\u4e0b\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\n\n\u5728\u7b2cx\u8282\u70b9\u4e2d\u9009j\u4e2a\u70b9\u7684\u6700\u5927\u5b66\u5206\u7b49\u4e8e\u5728i\u8282\u70b9\uff08i\u662f\u4ed6\u7684\u5b69\u5b50\uff09\u9009z\u4e2a\u70b9\u52a0\u4e0a\u5728x\u4e0a\u9009\u5269\u4e0b\u7684\u70b9\u7684\u6700\u5927\u5b66\u5206\uff08\u8bf4\u5b9e\u8bdd\u6211\u81ea\u5df1\u4e5f\u6709\u4e9b\u65e0\u6cd5\u7406\u89e3\uff0c\u4f46\u6839\u636e\u672c\u849f\u84bb\u7684\u7ecf\u9a8c\u6709\u7684\u6811\u5f62DP\u5c31\u662f\u8fd9\u6837\uff0c\u5177\u4f53\u539f\u56e0\u6211\u8fd8\u6ca1\u6709\u7ec6\u60f3\uff09\n\n\u90a3\u4e48\u5176\u5b9e\u5c31\u662f\u8fd9\u6837\u4e86",
        "postTime": 1519098102,
        "uid": 63019,
        "name": "\u661f\u661f\u4e4b\u706b",
        "ccfLevel": 0,
        "title": "P2014\u9009\u8bfe\u9898\u89e3"
    },
    {
        "content": "\u6211\u7528\u7684\u662f\u591a\u53c9\u6811\u8f6c\u4e8c\u53c9\u6811\uff1b\n\n\u7528f[root][k]\u8868\u793a\u7b2croot\u8282\u8bfe\u4e3a\u6839\u4e14\u8fd8\u5269k\u4e2a\u81ea\u7531\u9009\u8bfe\u6570\u65f6\uff0c\u5b66\u5206\u7684\u6700\u5927\u503c\uff1b\n\n\u5982\u679c\u4e0d\u9009\u6b64\u8bfe\uff0c\u5b83\u4e0e\u5b83\u7684\u540e\u7eed\u503c\u7686\u4e3a\u96f6\uff1b\n\n\u6216\u8005\u9009\uff0c\n\n\u6700\u7ec8\u6c42max\uff08\u5b83\u7684\u503c+\u5144\u5f1f\u4e0e\u5de6\u5b69\u5b50\u74dc\u5206\u5269\u4f59\u9009\u8bfe\u6570\u65f6\u6700\u4f18\u89e3\uff0c\u539f\u72b6\u6001\uff0c\u4e0d\u9009\u5b83\uff08\u4f46\u5b83\u5144\u5f1f\u7684\u72b6\u6001\u8981\u4e0e\u5b83\u5408\u5e76\uff0c\u56e0\u4e3a\u5de6\u5b69\u5b50\u53ea\u6709\u4e00\u4e2a\uff09\uff09\uff1b\n\n\u4e0d\u591a\u8bf4\uff0c\u4e0a\u4ee3\u7801\uff1b\n\n\n    \n     \n    \n    \n```cpp\n#include<bits/stdc++.h> \nusing namespace std;\nconst int N=320;\nint n,m;\nint f[N][N],b[N],c[N],s[N];\nvoid dp(int root,int k)\n{\n    if(f[root][k]>=0)return ;\n    if(root==0||k==0){f[root][k]=0;return ;    }\n    dp(b[root],k);//\u5144\u5f1f\u4e0e\u5de6\u5b69\u5b50\u4eab\u6709\u540c\u7b49\u6743\u5229\uff1b\n    for(int i=0;i<k;i++)\n    {\n        dp(c[root],k-i-1);//\u9009\u7b2croot\u95e8\u8bfe\uff1b \n        dp(b[root],i);// \u56e0\u4e3a\u6839\u8282\u70b9\u7ed9\u4e0b\u4e00\u4ee3\u6307\u6807\u65f6\uff0c\u53ea\u4f1a\u7ed9\u5de6\u5b69\u5b50\uff0c\u6240\u4ee5\u4e0b\u4e00\u4ee3\u7684\u5de6\u5b69\u5b50\u8981\u5206\u7ed9\u5144\u5f1f\u6307\u6807\uff1b \n        f[root][k]=max(f[root][k],max(f[b[root]][k],f[b[root]][i]+f[c[root]][k-i-1]+s[root]));\n        //\u6c42\u4e09\u4e2a\u72b6\u6001\u6700\u5927\u503c\uff1a\u9009\u6b64\u72b6\u6001\uff08\u539f\u5c01\u4e0d\u52a8\uff09\uff0c\u4e0d\u9009\uff0c\u9009\u6b64\u72b6\u6001\uff08\u66f4\u65b0\uff0c\u6b64\u8282\u70b9+\u74dc\u5206\u6307\u6807\u540e\u7684\u5144\u5f1f\u4e0e\u5de6\u5b69\u5b50\u7684\u6700\u4f18\u89e3\uff09 \n    }\n}\nint main()\n{\n    cin>>n>>m;\n    int fa;\n    for(int i=1;i<=n;i++)\n    {\n        cin>>fa>>s[i];\n        if(fa==0)fa=n+1; \n        b[i]=c[fa];//c\u3010i\u3011\u8bb0\u5f55\u7684\u662f\u957f\u5b50\uff0c\u957f\u5b50\u628a\u2018\u957f\u5b50\u2019\u7684\u4f4d\u5b50\u8ba9\u7ed9i,\u539f\u957f\u5b50\u6210\u4e3a\u4e86\u65b0\u957f\u5b50\u5144\u5f1f\uff0c \n        c[fa]=i;//\u7236\u4eb2\u76f4\u8f96\u539f\u957f\u5b50\uff1b \n    }\n    memset(f,-1,sizeof(f));\n    dp(c[n+1],m);\n    cout<<f[c[n+1]][m];//\u65e0\u5148\u4fee\u8bfe\u7684\u7684\u6700\u4f18\u503c\u4f1a\u96c6\u4e2d\u4e8ec\u3010n+1\u3011\uff1b \n    return 0;\n}\n```",
        "postTime": 1508147143,
        "uid": 38539,
        "name": "lvjiyuan",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u4e00\u9053\u663e\u7136\u7684\u6811\u5f62dp\u3002\n\n\u4f46\u662f\u6bd4\u8d77\u4e8c\u53c9\u82f9\u679c\u6811\uff0c\u672c\u9898\u591a\u4e86\u4e00\u4e2a\u64cd\u4f5c\u5728\u4e8e\u591a\u53c9\u6811\u8f6c\u4e8c\u53c9\u6811\uff1a\u5de6\u513f\u5b50\u53f3\u5144\u5f1f\u6811\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u4e5f\u6bd4\u8f83\u5bb9\u6613\uff1a\u5f00\u4e00\u4e2ar[a ]\u6570\u7ec4\uff0c\u7eaa\u5f55a\u8282\u70b9\u7684\u53f3\u513f\u5b50\u7684\u53f3\u513f\u5b50\u3001\u3001\u3001\uff08\u77e5\u9053\u6700\u4e0b\u8fb9\u6ca1\u6709\u53f3\u513f\u5b50\u7684\u8282\u70b9\uff09\uff0c\u7136\u540e\u628aa\u8282\u70b9\u7684\u5144\u5f1f\u8282\u70b9\u63a5\u5230r\u3010a\u3011\u7684\u53f3\u513f\u5b50\u4e0a\u5373\u53ef\u3002\n\n\u4e8c\u53c9\u6811\u5efa\u597d\u540e\uff0cdp\u65b9\u7a0b\u7c7b\u4f3c\u4e8e\u4e8c\u53c9\u82f9\u679c\u6811\uff08\u4e2a\u4eba\u8ba4\u4e3a\u5982\u679c\u6ca1\u505a\u8fc7\u4e8c\u53c9\u82f9\u679c\u6811\uff0c\u5148\u53bb\u505a\u90a3\u9898\u6bd4\u8f83\u597d\uff09\u3002\n\n\u4e0b\u9762\u662fAC\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint son[305],bro[305],n,m,v[305],r[305],f[305][305],bj[305][305];\nint dp(int x,int y)\n{\n    int k;\n    if(bj[x][y]!=0)return f[x][y];\n    if(x==0||x==-1||y==0)return 0;\n    int s=0;\n    s=max(dp(bro[x],y),s);\n    for(k=0;k<y;k++){\n        //if(son[x]==-1&&bro[x]==0&&y>1)return 0;\n        s=max(dp(son[x],k)+dp(bro[x],y-1-k)+v[x],s);\n    }\n    bj[x][y]=1;\n    return f[x][y]=s;\n}\nint main()\n{\n    cin>>n>>m;\n    int i,j,k,x,w;\n    memset(son,-1,sizeof(son));\n    for(i=1;i<=n;i++)\n    {\n        cin>>x>>w;\n        v[i]=w;\n```\n/\\*7  4\n2  2\n0  1\n0  4\n2  1\n7  1\n7  6\n2  2\\*/\n```cpp\n        if(son[x]==-1){\n            r[x]=son[x]=i;\n        }\n        else {\n            bro[r[x]]=i;\n            r[x]=i;\n        }\n    }\n        cout<<dp(son[0],m);\n}\n```",
        "postTime": 1501201410,
        "uid": 28653,
        "name": "\u5a03\u54c8\u54c8",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "/\\*\n\u6811\u5f62dp:f[i][j]\u8868\u793a\u4ee5i\u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\u4e0d\u5305\u62eci\u9009\u4e86j\u95e8\u8bfe\u7684\u6700\u5927\u6536\u76ca\n\n\u8f6c\u79fb\u7684\u65f6\u5019\u679a\u4e3ei\u7684\u5b50\u8282\u70b9\u9009\u591a\u5c11\u95e8\u8bfe\n\nf[i][j]=max(f[i][j],f[i][j-k]+f[to][k]); \n\n\\*/\n\n\n\n\n\n\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#define N 307\n#define M 2007\nusing namespace std;\nint f[N][N],size,cnt,n,m;\nint head[M];\nstruct edge\n{\n    int u,to,pre;\n}e[M<<1];\ninline int init()\n{\n    int x=0,f=1;char c=getchar();\n    while(c>'9'||c<'0'){if(c=='-')f=-1;c=getchar();}\n    while(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n    return x*f;\n}\ninline void add(int u,int to)\n{\n    e[++cnt].to=to;e[cnt].pre=head[u];head[u]=cnt;\n}\nvoid dp(int x)\n{\n    for (int i=head[x];i;i=e[i].pre)\n    {\n        int y=e[i].to;dp(y);\n        for(int i=m+1;i>1;i--)\n          for(int j=i-1;j>0;j--)\n            f[x][i]=max(f[x][i],f[x][i-j]+f[y][j]);\n    } \n}\nint main() \n{\n    int x,y;\n    n=init();m=init();\n    for(int i=1;i<=n;i++)\n    {\n        x=init();y=init();\n        f[i][1]=y;\n        add(x,i);\n    }\n    dp(0);//\n    printf(\"%d\",f[0][m+1]);\n    return 0;\n}\n```",
        "postTime": 1500259088,
        "uid": 20833,
        "name": "\u5b89\u597d",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u7ed9\u4e00\u697c\u4f5c\u4e00\u4e2a\u8865\u5145:\n\n\u591a\u53c9\u6811\u8f6c\u6362\u4e3a\u4e8c\u53c9\u6811\uff0c\u5de6\u513f\u5b50\u5b58\u539f\u513f\u5b50\uff0c\u53f3\u513f\u5b50\u5b58\u539f\u5144\u5f1f\u3002\n\n\u52a0x->y\uff0c\u5219:\n\n        if last[x]=0 then l[x]:=y \n\n             else r[last[x]]:=y;\n\n        last[x]:=y;\n\n\u8fd9\u662f\u6211\u5411\u4ed6\u5b66\u7684\uff0c\u5199\u7684\u6f02\u4eae\u3002\n\n\u4f46\u4ed6\u7684\u8f6c\u79fb\u662fO(M)\u7684\uff0c\u800c\u5b9e\u9645\u4e0a\u53ef\u4ee5O(1)\u3002\n\nf[x][m]\u8868\u793a\u5230\u4e86\u70b9x\u6709m\u95e8\u8bfe\u53ef\u4ee5\u9009\u7684max\u503c\u3002\n\n\u8003\u8651\u4e00\u4e2a\u70b9\u53ea\u6709\u9009\u4e0d\u9009\u4e24\u79cd\u60c5\u51b5\uff0c\u6240\u4ee5f[x][m]=max(f[r[x]][m],f[l[x]][m-1]+v[x])\n\n\u8003\u8651\u513f\u5b50\u8dd1\u5b8c\u4e86\u8fd8\u8981\u8dd1\u5144\u5f1f\u7684\uff0c\u6240\u4ee5\u7ed9\u6700\u540e\u4e00\u4e2a\u513f\u5b50\u8fde\u4e2a\u5411\u5144\u5f1f\u7684\u8fb9,\u5373:r[last[x]]=r[x]\u3002(\u8fd9\u662f\u6211\u5904\u7406\u8fd9\u79cd\u95ee\u9898\u7684\u901a\u7528\u65b9\u5f0f\u3002)\n\n```pascal\nconst mn=505;mm=355;\nvar\n n,m,i:longint;\n fa:longint;\n v,last,l,r:array[0..mn] of longint;\n f:array[0..mn,0..mm] of longint;\n\nfunction max(x,y:longint):longint;\nbegin\n if x>y then exit(x);\n exit(y);\nend;\nfunction dfs(x,m:longint):longint;\nbegin\n if f[x,m]=0 then\n begin\n  if (m=0)or(x=0) then exit(0);\n\n  f[x,m]:=max(dfs(r[x],m),dfs(l[x],m-1)+v[x]);\n end;\n\n exit(f[x,m]);\nend;\n\nvar vis:array[0..mn] of boolean;\nprocedure go(x:longint);\nbegin\n if vis[x] then exit;vis[x]:=true;\n r[last[x]]:=r[x];\n if l[x]=0 then l[x]:=r[x]\n else go(l[x]);\n go(r[x]);\nend;\n\nbegin\n assign(input,'1.in');reset(input);\n readln(n,m);\n for i:=1 to n do\n begin\n  read(fa,v[i]);\n  if last[fa]=0 then l[fa]:=i\n  else r[last[fa]]:=i;\n  last[fa]:=i;\n end;\n\n go(l[0]);\n writeln(dfs(l[0],m));\nend.\n```",
        "postTime": 1479353582,
        "uid": 9168,
        "name": "kczno1",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u8865\u4e00\u53d1\u2026\u2026\n\n\u8fd9\u9053\u9898\u6211\u662f\u76f4\u63a5dp\u7684\uff08\u4e2a\u4eba\u611f\u89c9\u8f6c\u4e8c\u53c9\u6ca1\u4ec0\u4e48\u7528\uff1f\uff09\n\n\u5c06\u6240\u6709\u6ca1\u6709\u5148\u4fee\u7684\u8282\u70b9\u4f5c\u4e3a0\u53f7\u8282\u70b9\u7684\u5b50\u8282\u70b9\n\nf[i][j]\u8868\u793a\u4ee5i\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\uff0c**\u4e0d\u9009\u6839i**\uff0c\u9009j\u95e8\u8bfe\u7684\u6700\u5927\u4ef7\u503c\n\n\u8f6c\u79fb\u65f6\u6211\u4eec\u679a\u4e3e\u5f53\u524d\u4ee5x\u4e3a\u6839\u7684\u5b50\u6811\u9009\u8bfe\u7684\u6570\u91cf\uff08i\uff09\uff0c\u4ee5\u53ca\u5206\u914d\u7ed9x\u7684\u5b50\u8282\u70b9\u591a\u5c11\u8282\u8bfe\uff08j\uff09\n\n\u4e0d\u96be\u5199\u51fa\u65b9\u7a0b\uff1af[x][i]=max(f[x][i],f[x][i-j]+f[y][j]);\n\n\u00b7\u00b7\u00b7cpp\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nconst int N=305,M=2001;\nint f[N][N],size=0,n,m;\nint head[M],nxt[M],son[M];\nvoid uni(int x,int y){\n    size++;\n    nxt[size]=head[x];\n    head[x]=size;\n    son[size]=y;\n}\nvoid dp(int x){\n    for (int e=head[x];e;e=nxt[e]){\n        int y=son[e];\n        dp(y);\n        for (int i=m+1;i>1;i--)//totle tree x\n            for (int j=i-1;j>0;j--)//totle:sons of x\n                f[x][i]=max(f[x][i],f[x][i-j]+f[y][j]);\n    }\n}\nint main(){\n    scanf(\"%d %d\",&n,&m);\n    for (int i=1;i<=n;i++){\n        int a,tmp;\n        scanf(\"%d %d\",&a,&tmp);\n        f[i][1]=tmp;\n        uni(a,i);\n    }\n    dp(0);\n    printf(\"%d\",f[0][m+1]);\n    return 0;\n}\n\u00b7\u00b7\u00b7\n```",
        "postTime": 1479218273,
        "uid": 18170,
        "name": "dolphin",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u4e00\u62ff\u5230\u8fd9\u4e2a\u9898\u65f6\uff0c\u770b\u7740\u8ddf\u201c\u91d1\u660e\u7684\u9884\u7b97\u65b9\u6848\u201d\u6709\u70b9\u50cf\uff0c\u7ed3\u679c\u4e00\u770b\u5b8c\u5168\u4e0d\u50cf\u3002\u3002\uff08\u597d\u5427\u662f\u4eca\u660e\u7684\u9884\u7b97\u65b9\u6848\u50cf\u8fd9\u9053\u9898\uff0c\u6211\u4e5f\u832b\u7136\u4e86\uff09\n\n\u6b63\u5982\u697c\u4e0b\u8bf4\u7684\uff0c\u8981\u628a\u591a\u53c9\u6811\u53d8\u6210\u4e8c\u53c9\u6811\u3002\u90a3\u4e48\u8fd9\u9897\u4e8c\u53c9\u6811\u957f\u5565\u6837\u5462\uff1f\u770b\u4e0b\u9762\u4e00\u53e5\u8bdd\n\n\u4e00\u4e2a\u8282\u70b9\u7684\u5de6\u5b69\u5b50\u662f\u8fd9\u4e2a\u8282\u70b9\u7684\u7b2c\u4e00\u4e2a\u5b69\u5b50\uff0c\u4e00\u4e2a\u8282\u70b9\u7684\u53f3\u5b69\u5b50\u662f\u8fd9\u4e2a\u8282\u70b9\u7684\u7b2c\u4e00\u4e2a\u5144\u5f1f\u3002\n\n//\u6709\u4eba\u95ee\uff1a\u90a3\u4e48\u8fd9\u4e2a\u8282\u70b9\u7684\u522b\u7684\u5b69\u5b50\u5462\uff1f\u7b54\uff1a\u5c31\u662f\u4ed6\u7b2c\u4e00\u4e2a\u5b69\u5b50\u7684\u5144\u5f1f\u554a\uff01\n\n\n\u7136\u540edp[i][j]\u662f\u4ee5\u7b2ci\u4e2a\u8282\u70b9\u4e3a\u6839\u7684\u4e8c\u53c9\u6811\uff08\u6ce8\u610f\u662f\u4e8c\u53c9\u6811\uff09\uff0c\u80fd\u9009\u62e9j\u95e8\u8bfe\u7a0b\u65f6\u5019\u7684\u6700\u5927\u5b66\u5206\u3002\n\nconvert\u662f\u591a\u53c9\u6811\u8f6c\u4e8c\u53c9\u6811\u7684\u4ee3\u7801\uff08\u5de7\u5999\u5730\u628a\u68ee\u6797\u53d8\u6210\u4e86\u6811\uff0c\u6839\u8282\u70b9\u4e3a0\uff09\n\ndfs\u662f\u8bb0\u5fc6\u5316\u641c\u7d22\uff0c\u76f8\u4fe1\u5927\u5bb6\u80fd\u770b\u61c2\u6ef4\uff08\u53cd\u6b63\u6709\u6ce8\u91ca\uff09\n\nmain\u51fd\u6570\uff0c\u4e00\u5982\u65e2\u5f80\u7684 \u8bfb\u5165->\u8ba1\u7b97->\u8f93\u51fa\n\nPS.\u6570\u7ec4\u4e00\u5f00\u59cb\u6211\u5f00\u7684201\uff0c\u7136\u540e\u524d\u4e09\u4e2a\u70b9AC\uff0c\u7b2c\u56db\u4e2aRE\uff0c\u7b2c\u4e94\u4e2aTLE\u3002\u3002\u4e8e\u662f\u542c\u4e86\u65c1\u4eba\u7684\u5efa\u8bae\uff0c\u5f00\u5927\u4e86\u70b9\uff0c\u610f\u60f3\u4e0d\u5230\u7684\u4e8b\u60c5\u53d1\u751f\u4e86\u3002\u3002AC\u4e86\u3002\u3002\n\n/*********************************/\n\n```cpp\n#include <iostream>\nusing namespace std;\nint n,m;\nint a[2001],f[2001];//a[i]\u662f\u67d0\u4e00\u95e8\u8bfe\u7a0b\u7684\u5b66\u5206 f[i]\u662f\u67d0\u4e00\u95e8\u8bfe\u7a0b\u5728\u591a\u53c9\u6811\u4e2d\u7684\u7239\nint lChild[2001],rChild[2001];//\u4e8c\u53c9\u6811\u7684\u5de6\u5b50\u6811\u548c\u67da\u5b50\u6811\nint dp[2001][2001];//dp[i][j]\u662f\u4ee5\u7b2ci\u4e2a\u8282\u70b9\u4e3a\u6839\u7684\u4e8c\u53c9\u6811\uff08\u6ce8\u610f\u662f\u4e8c\u53c9\u6811\uff09\uff0c\u80fd\u9009\u62e9j\u95e8\u8bfe\u7a0b\u65f6\u5019\u7684\u6700\u5927\u5b66\u5206\u3002\nvoid convert()//\u591a\u53c9\u6811 -> \u4e8c\u53c9\u6811 \n{\n        for(int i=1;i<=n;i++)\n        {\n                int fa=f[i];\n                if(lChild[fa]==0)lChild[fa]=i;//\u7239\u6ca1\u6709\u513f\u5b50 \n                else//\u7239\u6709\u513f\u5b50 \n                {\n                        fa=lChild[fa];\n                        while(rChild[fa])fa=rChild[fa];\n                            rChild[fa]=i;\n                }\n        }\n}\nint dfs(int i,int j)//i\u662f\u5f53\u524d\u8282\u70b9\uff0cj\u662f\u5269\u4f59\u7684\u8bfe\u7a0b\u6570\u76ee \n{\n        if(i<1||j<1||i>n||j>m)return 0;//\u8fb9\u754c\u5224\u65ad\uff0c\u4f60\u61c2\u5f97\n        if(dp[i][j]!=0)return dp[i][j];//\u67e5\u5907\u5fd8\u5f55\uff0c\u4f60\u4e5f\u61c2\u5f97\n        for(int k=0;k<j;k++)//\u9009\u7ed9\u5de6\u5b50\u6811k\u4e2a\uff0c\u81ea\u5df1\u7559\u4e00\u4e2a\uff08\u5f97\u9009\u81ea\u5df1\uff09\uff0c\u5269\u4e0b\u7684\u7ed9\u53f3\n                dp[i][j]=max(dp[i][j],a[i]+dfs(lChild[i],k)+dfs(rChild[i],j-k-1));//\u66f4\u65b0dp[i][j] \u540e\u9762\u5f97\u5c31\u662f\u81ea\u5df1\u7684\u5b66\u5206+\u5de6\u5b50\u6811k\u4e2a\u5269\u4f59\u8bfe\u7a0b\u7684\u5b66\u5206\n        dp[i][j]=max(dp[i][j],dfs(rChild[i],j));//\u4e0d\u9009\u62e9\u81ea\u5df1\uff0c\u90fd\u7ed9\u81ea\u5df1\u7684\u5144\u5f1f\uff08\u53f3\u5b50\u6811\uff09\n        return dp[i][j];//\u6700\u540e\u8fd4\u56de\u7b54\u6848\n}\nint main()\n{\n        cin >> n >> m;\n        for(int i=1;i<=n;i++)\n                cin >> f[i] >> a[i];\n        convert();\n        cout << dfs(lChild[0],m) << endl;\n        return 0;\n}\n\n```",
        "postTime": 1471925594,
        "uid": 13091,
        "name": "ghj1222",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u4e4d\u4e00\u770b\u5c31\u662f\u6811\u7ed3\u6784\u3002\u5565\uff1f\u6307\u9488\uff1f\u8fd8\u662f\u7528\u6a21\u62df\u6307\u9488\u5427\uff08\u795e\u7287\u8bf7\u65e0\u89c6\u672c\u6587\uff09\u2026\u2026\u6811\u7ed3\u6784\u561b\uff0c\u7ec4\u7ec7\u81ea\u7136\u8d39\u529b\u6211\u8bf4\u4e86\u591a\u5c11\u904d\u8fd9\u662f\u5751 \uff0c\u5565\uff1f\u4f60\u8bf4\u8fd9\u662f\u68ee\u6797\uff1f\u8001\u529e\u6cd5\uff0c\u8fd8\u5f97\u53d8\u4e8c\u53c9\u6811\u3002\n\n\u68ee\u6797\u561b\uff0c\u81ea\u7136\u662f\u8fd9\u4e48\u7ec4\u7ec7\u7684\uff1a\u4e00\u4e2a\u8282\u70b9\u7684\u7236\u8f88\u4ee3\u8868\u5b83\u7684\u5148\u4fee\u8bfe\uff0c\u56e0\u4e3a\u4e00\u95e8\u8bfe\u53ea\u6709\u4e00\u4e2a\u5148\u4fee\u8bfe\uff0c\u6b63\u597d\u7b26\u5408\u6811\u7684\u8981\u6c42\uff08\u5426\u5219\u8fd8\u662f\u6709\u5411\u56fe\u2026\u2026\uff09\u3002\n\n\u53d8\u4e8c\u53c9\u6811\uff0c\u8fd8\u662f\u5b69\u5b50-\u5144\u5f1f\u8868\u793a\u6cd5\uff1a\u4e00\u4e2a\u8282\u70b9\u7684\u5de6\u5b69\u5b50\u4ee3\u8868\u5b83\u7684\u7b2c\u4e00\u4e2a\u5b69\u5b50\uff08\u6216\u79f0\u5927\u5b69\u5b50\uff09\uff0c\u53f3\u5b69\u5b50\u4ee3\u8868\u5b83\u7684\u7b2c\u4e00\u4e2a\u5144\u5f1f\uff0c\u53f3\u5b69\u5b50\u7684\u53f3\u5b69\u5b50\uff0c\u53f3\u5b69\u5b50\u7684\u53f3\u5b69\u5b50\u7684\u53f3\u5b69\u5b50\u2026\u2026\u7ec4\u6210\u5b83\u7684\u6240\u6709\u5144\u5f1f\u4eec\u3002\u5565\uff1f\u4f60\u8bf4\u5b83\u7684\u5176\u4ed6\u5b69\u5b50\uff1f\u4e0d\u5c31\u662f\u5b83\u5de6\u5b69\u5b50\u7684\u5144\u5f1f\uff08\u53f3\u5b69\u5b50\uff09\u4eec\u561b\uff01\n\n\u73b0\u5728\u8981\u8bf4\u6a21\u62df\u6307\u9488\u4e86\u3002\u8fd9\u4e2a\u597d\u7406\u89e3\uff0ca[i]\u4ee3\u8868\u7b2ci\u8bfe\u7684\u5b66\u5206\uff0cl[i]\u4ee3\u8868i\u7684\u5de6\u5b69\u5b50\uff0cr[i]\u4ee3\u8868i\u7684\u53f3\u5b69\u5b50\u3002\n\n\u8a00\u5f52\u6b63\u4f20\uff0c\u56de\u5230\u96be\u70b9\u4e0a\u6765\uff08\u521a\u521a\u90fd\u662f\u6d6e\u4e91\u2026\u2026\uff09\u52a8\u89c4\u9898\u7684\u6838\u5fc3\uff1a\u52a8\u89c4\u65b9\u7a0b\u3002\n\n\u5047\u8bbe\u5728\u4ee5i\u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\u4e0a\u9009j\u4e2a\u8282\u70b9\u7684\u6700\u5927\u4ef7\u503c\u4e3af[i,j],\u90a3\u4e48\u8003\u8651\u4e24\u79cd\u60c5\u51b5\uff1a\u2160\u5982\u679c\u9009\u6839\u8282\u70b9\uff0c\u90a3\u5c31\u5de6\u53f3\u5b50\u6811\u4e2d\u7684\u8282\u70b9\u90fd\u53ef\u4ee5\u9009,\u5373f[i,j]=max(f[l[i],k]+f[r[i],j-1-k]+a[i]|0<=k<=j\uff1b\u2161\u5982\u679c\u4e0d\u9009\u6839\u8282\u70b9\uff0c\u90a3\u4e48\u53ea\u80fd\u9009\u53f3\u5b50\u6811\u4e0a\u7684\u8282\u70b9\uff08\u4e3a\u4ec0\u4e48\uff1f\u6839\u8282\u70b9\u662f\u5de6\u5b69\u5b50\u7684\u5148\u4fee\u8bfe\u554a\uff01\uff09\u5373f[i,j]=f[r[i],j]\u3002\u603b\u800c\u8a00\u4e4b\uff0c\u52a8\u89c4\u65b9\u7a0b\u4e3a\uff1a\n\nf[i,j]=max(max(f[l[i],k]+f[r[i],j-1-k]+a[i]|0<=k<=j\uff0cf[r[i],j])\n\n\u81f3\u6b64\uff0c\u5373\u6709\u4e24\u79cd\u89e3\u6cd5\u3002\n\n\u2460\u6811\u72b6\u52a8\u89c4\n\n\u65b9\u7a0b\u5df2\u51fa\uff0c\u591a\u8bf4\u65e0\u76ca\u7136\u800c\u6211\u5c31\u559c\u6b22\u5e9f\u8bdd\uff0c\u4f46\u8fd9\u91cc\u7684\u91cd\u70b9\u662f\u52a8\u89c4\u7684\u6b21\u5e8f\u3002\n\n\u4e0d\u96be\u770b\u51fa\uff0c\u8981\u4ece\u53f6\u8282\u70b9\u5411\u4e0a\u52a8\u89c4\uff0c\u6240\u4ee5\u5c31\u5f97\u4ee5\u8be5\u8282\u70b9\u4e3a\u6839\u7684\u5b50\u6811\u7684\u8282\u70b9\u4e2a\u6570\u4e3a\u6807\u51c6\u6392\u5e8f\uff0c\u4f46\u4e07\u4e07\u4e0d\u53ef\u76f4\u63a5\u8c03a\u6570\u7ec4\uff0c\u5426\u5219\u6811\u5c31\u5012\u4e86\u2026\u2026\u6240\u4ee5\u8981\u518d\u7528\u4e00\u4e2a\u6570\u7ec4\u4f5c\u4e3a\u6307\u9488\uff08\u5f53\u7136\u662f\u6a21\u62df\u6307\u9488\uff09\uff0c\u5b58\u50a8\u6392\u5e8f\u7ed3\u679c\u3002\u6807\u7a0b\u7565\u3002\n\n\n\u2461\u8bb0\u5fc6\u5316\u641c\u7d22\n\n\u8ddf\u52a8\u89c4\u4e00\u6bd4\uff0c\u6beb\u65e0\u6280\u672f\u542b\u91cf\u53ef\u8a00\u2026\u2026\u9012\u5f52+\u5b58\u50a8\uff0cOK\u3002\u6807\u79f0\u9644\u4e0a\uff1a\n\n```cpp\nconst maxn=500;\ntype arr1=array[1..maxn] of longint;\n     arr2=array[-1..maxn,0..maxn] of longint;\nvar a,l,r:arr1;\n    f:arr2;\n    n,m,i,j,k,root:longint;\nfunction max(x,y:longint):longint;\nbegin\n   if x>y then exit(x);\n   exit(y);\nend;\nfunction work(i,j:longint):longint;\nvar tmp,k:longint;\nbegin\n  if (i=-1)or(j=0) then f[i,j]:=0;\n  if f[i,j]>=0 then exit(f[i,j]);\n  tmp:=work(r[i],j);\n  for k:=0 to j-1 do\n    tmp:=max(tmp,work(l[i],k)+work(r[i],j-1-k)+a[i]);\n  f[i,j]:=tmp; \n  exit(f[i,j]);\nend;\nbegin\n  readln(n,m);\n  for i:=1 to n do begin l[i]:=-1; r[i]:=-1;end;\n  root:=-1;\n  for i:=1 to n do \n    begin\n      readln(j,a[i]);\n      if j=0 then begin\n                    if root=-1 then root:=i\n                               else begin\n                                      k:=root;\n                                      while r[k]<>-1 do k:=r[k];\n                                      r[k]:=i;\n                                    end\n                  end\n             else if l[j]=-1 then l[j]:=i\n                             else begin\n                                    k:=l[j];\n                                    while r[k]<>-1 do k:=r[k];\n                                    r[k]:=i;\n                                  end; \n    end;\n  fillchar(f,sizeof(f),255);\n  f[root,m]:=work(root,m);\n  writeln(f[root,m]);\nend.\n\n```",
        "postTime": 1465572241,
        "uid": 10291,
        "name": "fighter_OI",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "\u5c0f\u7530\u53c8\u6765\u53d1\u9898\u89e3\u5566~~~\n\n\n\u5176\u5b9e\u4e25\u683c\u6765\u8bf4\u8fd9\u4e0d\u662f\u6211\u7684\u9898\u89e3\uff0c\u8fd9\u662f\u6211&\u6211\u7684\u8001\u5e08\uff08xiao233\uff09\u7684\u9898\u89e3\u3002\u611f\u8c22~\n\n\n\u6811\u5f62DP\uff0c\u975e\u5e38\u7b80\u5355\uff0c\u5c31\u662f\u4e4b\u524d\u65f6\u95f4\u70b8\u4e86\uff0c\u6709\u4e2a\u6570\u636e\u662f300 160\uff0c\u5f00\u5c0f\u4e86\u6570\u7ec4\u3002\n\n\u964420\u5206\u4ee3\u7801\uff08\u540e\u56db\u4e2a\uff34\uff2c\uff25\uff09\n\n\n\n\n\n\n\n    \n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#define Size 305\nusing namespace std;\nstruct _node{\n    int l,r,x;\n}a[Size];\nint f[Size][Size],b[Size],i,j,k,m,n,x,y,z;\nint dp(int x,int y){\n    int i,j,k,p,q;\n    if(f[x][y] >= 0) return f[x][y];\n    p = dp(a[x].r,y);\n    for(i = 1; i <= y; i++){\n        j = dp(a[x].l,i-1);\n        k = dp(a[x].r,y-i);\n        k += (j+a[x].x);\n        if(k > p) p = k;\n    }\n    return p;\n}\nint main(){\n    scanf(\"%d %d\",&n,&m);\n    memset(f,0,sizeof(f));\n    for(i = 1; i <= n; i++) a[i].l = 205,a[i].r = 205,a[i].x = 0;\n    memset(b,0,sizeof(b));\n    for(i = 1; i <= n; i++){\n        scanf(\"%d %d\",&x,&y);\n        a[i].x = y;\n        if(!b[x]) a[x].l = i;\n        else a[b[x]].r = i;\n        b[x] = i;\n    }\n    for(i = 0; i <= 200; i++) for(j = 0; j <= 150; j++) if(i == 205||j == 0) f[i][j] = 0;else f[i][j] = -1;\n    f[0][m] = dp(a[0].l,m);\n    printf(\"%d\\n\",f[0][m]);\n    return 0;\n}\n```\n\u6700\u540e\u6211\u7684\u8001\u5e08\u53d1\u73b0\u4e86\u9519\u8bef\uff0c\u7ed9\u6211\u6307\u6b63\uff1a\n\n\n\n\n\n\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#define Size 306\nusing namespace std;\nstruct _node\n{\n    int l,r,x;\n} a[Size];\nint f[Size][Size],b[Size],i,j,k,m,n,x,y,z;\nint dp(int x,int y)\n{\n    int i,j,k,p,q;\n    if(f[x][y] >= 0) return f[x][y];\n    p = dp(a[x].r,y);\n    for(i = 1; i <= y; i++)\n    {\n        j = dp(a[x].l,i-1);\n        k = dp(a[x].r,y-i);\n        k += (j+a[x].x);\n        if(k > p) p = k;\n    }\n    f[x][y]=p;\n    return p;\n}\nint main()\n{\n    scanf(\"%d %d\",&n,&m);\n    memset(f,0,sizeof(f));\n    for(i = 1; i <= n; i++) a[i].l = 305,a[i].r = 305,a[i].x = 0;\n    memset(b,0,sizeof(b));\n    for(i = 1; i <= n; i++)\n    {\n        scanf(\"%d %d\",&x,&y);\n        a[i].x = y;\n        if(!b[x]) a[x].l = i;\n        else a[b[x]].r = i;\n        b[x] = i;\n    }\n    for(i = 0; i <= 305; i++) for(j = 0; j <= 200; j++) if(i == 305||j == 0) f[i][j] = 0;\n            else f[i][j] = -1;\n    f[0][m] = dp(a[0].l,m);\n    printf(\"%d\\n\",f[0][m]);\n    return 0;\n}\nso and so \uff0c\u6ca1\u6709\u4e86\uff0c\u8c22\u8c22\u9605\u8bfb~~~\n```",
        "postTime": 1465113483,
        "uid": 17170,
        "name": "Deny_\u5c0f\u7530",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    },
    {
        "content": "# \u4e00\u4e2a17ms\u7684\u4f18\u5316\u7248\u672c\n#### \u9996\u8a00\n\u5bf9\u300a\u7ade\u8d5b\u4e00\u672c\u901a\u300b\u7684\u505a\u6cd5\u8fdb\u884c\u4e86\u5c0f\u5c0f\u4f18\u5316\uff0c\u5e0c\u671b\u540c\u65f6\u4e5f\u53ef\u4ee5\u5e2e\u52a9\u6ca1\u6709\u770b\u61c2\u7684\u540c\u5b66\u66f4\u6e05\u6670\u5730\u7406\u89e3\u6811\u5f62\u80cc\u5305\u7684\u672c\u8d28\n***\n#### \u8fd9\u9053\u9898\u662f\u6a21\u677f\u7684\u6811\u5f62\u80cc\u5305\uff1a\n\n```cpp\n\u7ed9\u5b9an\u4e2a\u7269\u4f53\n\u6709\u4e00\u4e9b\u7269\u4f53\u9700\u8981\u4e8b\u5148\u8d2d\u4e70\u5176\u4ed6\u7269\u4f53\u624d\u80fd\u8d2d\u4e70\n\u95ee\u8d2d\u4e70m\u4e2a\u7269\u4f53\u6240\u53ef\u4ee5\u83b7\u5f97\u7684\u6700\u5927\u4ef7\u503c\n```\n***\n\n#### \u8fd9\u79cd\u201c\u4f9d\u8d56\u5173\u7cfb\u201d\u6211\u4eec\u53ef\u4ee5\u8f6c\u5316\u6210\u201c\u6811\u201d\u91cc\u9762\u7684\u201c\u7236\u5b50\u5173\u7cfb\u201d\n```cpp\n\u7528\u4e00\u6761\u8fb9\u628a\u6709\u8981\u6c42\u7684\u7269\u4f53\u8fde\u63a5\u4e0a\u5b83\u6240\u9700\u8981\u4e8b\u5148\u8d2d\u4e70\u7684\u7269\u4f53\n\n\u8fd9\u6837\u5b50\u6211\u4eec\u5c31\u5f97\u5230\u4e00\u68f5\u6811\uff01\uff08\u6ca1\u6709\u8981\u6c42\u7684\u8282\u70b9\u8fde\u63a50\uff09\n\n\u73b0\u5728\u6211\u4eec\u7684\u95ee\u9898\u5c31\u8f6c\u6210\u4e86\u5728\u4e00\u9897\u6811\u5b50\u4e0a\u9762\u5bfb\u627e\u4ee50\u8282\u70b9\u4e3a\u6839\u8282\u70b9\uff0csize\u4e3am+1\uff080\u53f7\u8282\u70b9\u4e0d\u7b97\u5927\u5c0f\uff0c\u6240\u4ee5+1\uff09\u7684\u6240\u6709\u5b50\u6811\u4e2dtotal_value\u6700\u5927\u7684\u90a3\u4e00\u68f5\u7684value\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u901a\u8fc7\u4e00\u79cdDP\u7684\u601d\u60f3\u6765\u5b9e\u73b0\u8fd9\u4e2a\u76ee\u7684\uff0c\u4e5f\u5c31\u662f\u901a\u8fc7\u67d0\u79cd\u65b9\u5f0f\u901a\u8fc7\u4e00\u4e2a\u8282\u70b9\u7684\u5b50\u8282\u70b9\u6765\u66f4\u65b0\u8fd9\u4e2a\u8282\u70b9\u7684max_value\u3002\n```\n\n***\n#### \u72b6\u6001\n```cpp\n\u6211\u4eec\u7528f[u][i]\u8868\u793a\u4ee5u\u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\u4e2d\u9009\u62e9i\u4e2a\u7269\u4f53\u6240\u53ef\u4ee5\u83b7\u5f97\u7684\u6700\u5927\u4ef7\u503c\n\n\u5bf9\u4e8ef[u][i]\u6765\u8bf4\uff0c\u6211\u4eec\u8003\u8651\u5b83\u7684\u6700\u5927DP\u6240\u9700\u8981\u7684\u4f53\u79ef\uff0c\u662fmin(m,leaf[u].size)\u3010\u8fd9\u662f\u4e00\u4e2a\u4f18\u5316\u3011\u3002\n\n\u800c\u7269\u4f53\u53ef\u4ee5\u4ece\u6bcf\u4e2a\u513f\u5b50\u4e2d\u9009\u62e9\u4e00\u4e2a\uff08\u6216\u8005\u4e0d\u9009\uff09\uff0c\u6bd4\u5982y\u662fu\u7684\u4e00\u4e2a\u513f\u5b50\u8282\u70b9\uff0c\u90a3\u4e48f[y][j]\u53ef\u4ee5\u8868\u793a\u4e00\u4e2a\u4f53\u79ef\u4e3aj\uff0c\u4ef7\u503c\u4e3af[y][j]\u7684\u7269\u54c1\u3002\n\n\u4f46\u662f\u6bcf\u4e2a\u513f\u5b50\u91cc\u9762\u53ea\u80fd\u6700\u591a\u9009\u62e9\u4e00\u4e2a\uff0c\u6240\u4ee5\u5bf9\u4e8e\u6bcf\u4e2a\u513f\u5b50\u90fd\u8981\u904d\u5386\u4e00\u904d\u5b83\u7684\u6240\u6709\u7684f[y][j]\u3002\n\n\u7531\u4e8e\u53ea\u6709\u5f53j<=min(m,leaf[y].size)\u7684\u65f6\u5019\u624d\u6709\u610f\u4e49\uff0c\u6240\u4ee5j\u53ea\u9700\u8981\u4ecemin(m,leaf[y].size)\u904d\u5386\u52301\u5c31\u884c\u4e86\u3010\u8fd9\u662f\u53e6\u4e00\u4e2a\u4f18\u5316\u3011\u3002\n```\n***\n#### \u6574\u4f53\u5e03\u5c40\n```cpp\n\u90a3\u4e48\u8fd9\u9053\u9898\u5c31\u8f6c\u5316\u6210\u4e3a\u4e86\u4e00\u9053\u5206\u7ec4\u80cc\u5305\u95ee\u9898\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9\u6765\u8bf4\uff0c\u6709\u591a\u5c11\u4e2a\u513f\u5b50\u5c31\u6709\u591a\u5c11\u7ec4\u7269\u54c1\u53ef\u4ee5\u9009\u62e9\uff0c\u5bf9\u4e8e\u6bcf\u79cd\u7269\u54c1\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u5176\u4e2d\u7684\u4e00\u4e2a\u3002\n\u6240\u4ee5\u5728\u6bcf\u4e2adfs\u4e2d\u6211\u4eec\u6709\u4e09\u91cd\u5faa\u73af\uff1a\n\u7b2c\u4e00\u91cd\u5faa\u73af\u513f\u5b50\uff08\u7ec4\u522b\uff09\u3002\n\u7b2c\u4e8c\u91cd\u5faa\u73af\u4f53\u79ef\uff08min(m,leaf[u].size)\uff09\u3002\n\u7b2c\u4e09\u91cd\u5faa\u73af\u6bcf\u4e2a\u513f\u5b50\u7684\u53ef\u9009\u7269\u54c1\uff08min(m,leaf[y].size)\uff09\u3002\n\u81f3\u4e8e\u6bcf\u4e2a\u8282\u70b9\u7684size\u9700\u8981\u4e8b\u5148\u8dd1\u4e00\u904ddfs\u5904\u7406\u51fa\u6765\u3002\n\u8fd9\u6837\u5b50\u505a\u7684\u590d\u6742\u5ea6\u5f88\u8ff7\uff0c\u4f46\u662f\u8fdc\u8fdc\u5c0f\u4e8e\u300a\u7ade\u8d5b\u4e00\u672c\u901a\u300b\u4e0a\u9762\u7684\u590d\u6742\u5ea6\uff0c\u56e0\u4e3a\u53bb\u9664\u4e86\u8bb8\u591a\u6ca1\u6709\u610f\u4e49\u7684\u72b6\u6001\uff08\u5f53m>leaf[u].size\u7684\u65f6\u5019\uff0c\u5927\u4e8e\u7684\u90a3\u4e00\u90e8\u5206\uff09\uff0c\u8dd1\u51fa\u6765\u7684\u65f6\u95f4\u662f\u4e66\u4e0a\u7684\u7a0b\u5e8f\u7684\u65f6\u95f4\u76841/4.\uff0817ms\uff09\n```\n***\n#### \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n#define maxn 800\nusing namespace std;\nint n,m,cal;\nstruct lines{\n\tint nex,to;\n}line[maxn];\nstruct leaves{\n\tint head,size,value,f[maxn];\n}leaf[maxn];\ninline int qr()\n{\n\tint sum=0;\n\tchar j=0;\n\tbool flag=0;\n\twhile(!isdigit(j))\n\t{\n\t\tflag|=j=='-';\n\t\tj=getchar();\n\t} \n\twhile(isdigit(j))\n\t{\n\t\tsum=(sum<<1)+(sum<<3)+(j^48);\n\t\tj=getchar();\n\t}\n\treturn flag? -sum:sum; \n}\ninline void add(int u,int v)\n{\n\tline[++cal].nex=leaf[u].head;\n\tline[cal].to=v;\n\tleaf[u].head=cal;\n\tline[++cal].nex=leaf[v].head;\n\tline[cal].to=u;\n\tleaf[v].head=cal;\n\treturn;\n}\ninline void readin()\n{\n\tn=qr();\n\tm=qr();\n\tint a,b;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\ta=qr();\n\t\tb=qr();\n\t\tadd(i,a);\n\t\tleaf[i].value=b;\n\t}\n\treturn;\n} \nvoid dfs1(int u,int fa)\n{\n\tleaf[u].size=1;\n\tfor(int i=leaf[u].head;i;i=line[i].nex)\n\t{\n\t\tint y=line[i].to;\n\t\tif(y!=fa)\n\t\t{\n\t\t\tdfs1(y,u);\n\t\t\tleaf[u].size+=leaf[y].size;\n\t\t}\n\t}\n\treturn;\n}\nvoid dfs2(int u,int fa)\n{\n\tfor(int i=leaf[u].head;i;i=line[i].nex)\n\t{\n\t\tint y=line[i].to;\n\t\tif(y!=fa)\n\t\t{\n\t\t\tdfs2(y,u);\n\t\t\tfor(int v=min(leaf[u].size,m);v;v--)\n\t\t\tfor(int vo=min(v,leaf[y].size);vo;vo--)\n\t\t\tleaf[u].f[v]=max(leaf[u].f[v],leaf[u].f[v-vo]+leaf[y].f[vo]);\n\t\t}\n\t}\n\tif(u)\n\tfor(int v=min(leaf[u].size,m);v;v--)\n\tleaf[u].f[v]=leaf[u].f[v-1]+leaf[u].value;\n\treturn;\n}\ninline void Solve()\n{\n\tdfs1(0,-1);\n\tdfs2(0,-1);\n\treturn;\n}\ninline void print()\n{\n\tprintf(\"%d\",leaf[0].f[m]);\n\treturn;\n}\nint main()\n{\n\treadin();\n\tSolve();\n\tprint();\n\treturn 0;\n}\n```\n",
        "postTime": 1570936721,
        "uid": 117111,
        "name": "BrandonSoong",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2014 \u3010\u9009\u8bfe\u3011"
    }
]
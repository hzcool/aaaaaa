[
    {
        "content": "[\u9898\u9762\u5728\u6b64](https://www.luogu.org/problem/P5634)\n\n$\\Large\\text{\u5927\u6ce2\u516c\u5f0f\u8b66\u544a}$\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u4ee5\u4e0b\u6211\u7528$\\lg$\u6765\u4ee3\u66ff$\\log_2$\n\n\u6211\u4eec\u5bb9\u6613\u5f97\u51fa$ans=F(n)=F(\\lfloor n/2\\rfloor )+F(\\lceil n/2\\rceil )+n-1(n>1)$\uff0c\u6211\u4eec\u4ee4$g(n)=g(\\lfloor n/2\\rfloor )+g(\\lceil n/2\\rceil )+a(n)(n>1)$\uff0c\u5219\u6709$\\Delta g(n)=\\Delta a(n)+\\Delta g(\\lfloor n/2\\rfloor)$\n\n\u6211\u4eec\u6709\u6052\u7b49\u5f0f$\\lceil \\lg2j\\rceil=\\lceil \\lg j\\rceil+1$\u548c$\\lceil \\lg(2j-1)\\rceil=\\lceil \\lg j\\rceil+[j>1](j\\geq1)$\uff0c\u6240\u4ee5\u5f53$a(n)=n-1$\u65f6\uff0c$\\lceil \\lg(n+1)\\rceil$\u6ee1\u8db3$\\Delta f(n)=1+\\Delta f(\\lfloor n/2\\rfloor)$\n\n\u6240\u4ee5\u6709\u7ed3\u8bba\u82e5$F(1)=0,F(n)=F(\\lfloor n/2\\rfloor )+F(\\lceil n/2\\rceil )+n-1(n>1)$\uff0c$F(n)=\\sum\\limits_{k=1}^{n}\\lceil \\lg k\\rceil$\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u66b4\u529b\u6c42$F(n)$\uff0c\u4f46\u6b64\u65f6\u66b4\u529b\u4ecd\u7136\u662f$O(n)$\u7684\uff0c\u56e0\u4e3a\u5176\u4e2d\u6709\u4e00\u4e9b\u8fde\u7eed\u76f8\u7b49\u7684\u6570\uff0c\u53ef\u4ee5\u8003\u8651\u6570\u8bba\u5206\u5757\uff0c\u590d\u6742\u5ea6\u5927\u6982\u662f$O(\\lg n)$\u7684\uff0c\u9884\u8ba1\u5f97\u5206$10\\sim20pts$\n\n\u4ee4$m=\\lceil \\lg n\\rceil$\uff0c\u6211\u4eec\u8003\u8651\u589e\u52a0$2^m-n$\u9879\u4ee5\u7b80\u5316\u8fd0\u7b97\uff1a\n\n$F(n)+(2^m-n)m=\\sum\\limits_{k=1}^{2^m}\\lceil \\lg k\\rceil=\\sum\\limits_{j,k}j[j=\\lceil \\lg k\\rceil][1\\leq k\\leq 2^m]=\\sum\\limits_{j,k}j[2^{j-1}\\lt k\\leq 2^j][1\\leq j\\leq m]=\\sum\\limits_{j=1}^{m}j2^{j-1}=2^m(m-1)+1$\n\n\u6240\u4ee5\u6211\u4eec\u5f97\u5230$F(n)=nm-2^m+1$\n\n\u4f46\u662f\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff1a\u5982\u4f55\u6c42$\\lceil \\lg n\\rceil$\uff0c\u7531\u4e8e$n$\u592a\u5927\uff0c\u53ea\u80fd\u4f7f\u7528\u9ad8\u7cbe\u5ea6\uff0c\u8003\u8651\u66b4\u529b\u6c42$2^k$\uff0c\u66b4\u529b\u627e\u5230$m$\uff0c\u66b4\u529b\u53d6\u6a21\uff0c\u590d\u6742\u5ea6\u4ecd\u4e3a$O(\\lg n)$\uff0c\u9884\u8ba1\u5f97\u5206\u4ecd\u7136\u4e3a$10\\sim20pts$\n\n\u6211\u4eec\u6709\u6362\u5e95\u516c\u5f0f$\\lg n=\\log_{10}n/\\log_{10}2=\\log_{10}n*(1/\\log_{10}2),\\log_{10}n$\u53ef\u4ee5\u7528\u6570\u4f4d\u4e2a\u6570\u4f30\u7b97\uff08\u504f\u5c0f\uff09\uff0c$1/\\log_{10}2$\u53d6\u4f30\u7b97\u503c$3.32192809488736218170856773213$\uff0c\u6b64\u65f6\u5c31\u53ef\u4ee5\u6c42\u5f97\u4f30\u7b97\u503c$l$\uff0c\u8003\u8651\u9884\u5904\u7406\u51fa$2^{2^l}$\uff0c\u518d\u628a$l$\u7528\u4e8c\u8fdb\u5236\u6cd5\u8868\u793a\u5373\u53ef\u5feb\u901f\u6c42\u51fa$2^l$\uff0c\u518d\u7528\u66b4\u529b\u5373\u53ef\uff08\u6b64\u65f6\u66b4\u529b\u6700\u591a\u7b97$4$\u6b21\uff0c\u56e0\u4e3a$2^4\\gt10$\uff09\uff0c\u590d\u6742\u5ea6$O(\\lg \\lg n)$\uff0c\u9884\u8ba1\u5f97\u5206$100pts$\uff0c\u4f46\u662f\u6b64\u9898\u6570\u636e\u8303\u56f4\u8fbe\u5230$10^{100000}$\uff0c\u5fc5\u987b\u7528$FFT$\u4f18\u5316\uff0c\u5426\u5219\u5f97\u5206\u53ea\u80fd\u662f$50\\sim80pts$\n\n\uff08\u5f53\u7136\u9ad8\u7cbe\u5ea6\u5feb\u901f\u5e42\u662f\u4e00\u6837\u7684\uff09\n\n\u4f46\u5176\u5b9e\u8fd9\u9053\u9898\u8fd8\u6709\u4e2a\u6bd4\u8f83\u5de7\u5999\u7684\u7406\u89e3\u65b9\u6cd5\uff1a\n\n\u5148\u6c42\u5f0f\u5b50:$f(n)=f(\\lfloor n/2\\rfloor )+f(\\lceil n/2\\rceil )+n(n>1)$\uff0c$\\lfloor n/2\\rfloor,\\lceil n/2\\rceil$\u53d6\u904d\u4e86$n$\uff0c\u5982\u679c\u6bcf\u6b21\u52a0$n$\uff0c\u5c31\u76f8\u5f53\u4e8e**\u6bcf\u5c42**\u9012\u5f52\u90fd\u662f\u52a0$n$\uff0c\u4e00\u5171\u9012\u5f52\u4e86$\\lceil \\lg n\\rceil$**\u5c42**\uff0c\u4e14\u4e00\u5171\u9012\u5f52\u4e86$n-1$**\u6b21**\uff0c\u7b54\u6848\u5c31\u662f$f(n)-(n-1)$\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u662f\u5f97\u5230$F(n)=nm-2^m+1$\n\n$Code:(part)$\n```cpp\nint main()\n{\n    scanf(\"%s\",ch);n=ch;\n    int l=db*(strlen(ch)-1),ll=l;//db=3.32192809488736218170856773213\n    for(register int i=1;i<=l;i<<=1,++tot)\n        b[tot+1]=b[tot]*b[tot];//\u9884\u5904\u7406\n    while(l){\n        if(l&1) s=s*b[t];//\u4e8c\u8fdb\u5236\u5206\u89e3\u7b97\n        ++t,l>>=1;\n    }\n    while(1){//\u66b4\u529b\u7b97\n        s+=s,++ll;\n        if(s>=n) break;\n    }\n    T=(n%mod*ll+mod-qpow(2,ll)+1)%mod;\n    T.print();\n    return 0;\n}\n```",
        "postTime": 1573288048,
        "uid": 48057,
        "name": "Pisces",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5634 \u3010\u6570\u7801\u6392\u5e8f\u3010\u52a0\u5f3a\u7248\u3011\u3011"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P5634)\u3002\n\n\u9996\u5148\u4f60\u9700\u8981\u77e5\u9053\u9012\u63a8\u5f0f\uff0c\u8be6\u89c1\u8fd9\u4e00\u7bc7\u9898\u89e3 [this](https://www.luogu.com.cn/blog/zqh158233/solution-p5626)\u3002\n\n\u7531\u6b64\u5f97\u77e5\n\n$$S_n=np-2^p+1$$\n\n$p=\\log_2n$\u3002\n\n\u56e0\u4e3a\u8981\u5bf9 `100000007` \u53d6\u6a21\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u53ea\u7b97 $p$\uff0c\u6709\u6362\u5e95\u516c\u5f0f\uff0c\u4ece\u800c\u7b97\u5230\u5b83\u7684\u4f30\u503c $p=\\log_{10}(n)\\times \\log_2(10)$\uff0c\u7ee7\u7eed\u66b4\u529b\u7b97\u8bef\u5dee\u90e8\u5206\u5373\u53ef\u3002\n\n\u63a5\u4e0b\u6765\u6309\u5f0f\u5b50\u53d6\u6a21\u5373\u53ef\u3002\n\n\u5f53\u7136\uff0c\u5982\u679c\u6ca1\u6709\u53d6\u6a21\u5462\uff0c\u6570\u5b57\u53ef\u80fd\u5f88\u5927\uff0c\u9700\u8981 FFT \u4f18\u5316\u5230 $O(n\\log n)$\uff0c[\u5982\u679c\u60a8\u4e0d\u77e5\u9053\u4ec0\u4e48\u662f FFT](https://www.luogu.com.cn/problem/P1919)\u3002\n\n\u4e0b\u9762\u7ed9\u51fa\u4e0d\u53d6\u6a21\u7684\u4ee3\u7801\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst double PI=acos(-1),dbos=3.32192809488736218170856773213;\nstring S;\nconst ll Maxn=2e5+7,Mod=100000007;\nll len,Lim=1,Alen,Blen,rev[Maxn],ans[Maxn];\nstruct Complex{\n\tdouble r,i;\n\tComplex(){r=0,i=0;}\n\tComplex(double real,double imag):r(real),i(imag){}\n}A[Maxn],B[Maxn];\ninline Complex operator +(Complex A,Complex B){return Complex(A.r+B.r,A.i+B.i);}\ninline Complex operator -(Complex A,Complex B){return Complex(A.r-B.r,A.i-B.i);}\ninline Complex operator *(Complex A,Complex B){return Complex(A.r*B.r-A.i*B.i,A.r*B.i+A.i*B.r);}\ninline void FFT(Complex *a,double flag){\n\tfor(ll i=0;i<Lim;++i) if(i<rev[i]) swap(a[i],a[rev[i]]);\n\tfor(ll dep=1;dep<=log2(Lim);++dep){\n\t\tll m=1<<dep;\n\t\tComplex wn=Complex(cos(2.0*PI/m),flag*sin(2.0*PI/m));\n\t\tfor(ll i=0;i<Lim;i+=m){\n\t\t\tComplex w=Complex(1,0);\n\t\t\tfor(ll j=0;j<m/2;j++){\n\t\t\t\tComplex t=w*a[i+j+m/2];\n\t\t\t\tComplex u=a[i+j];\n\t\t\t\ta[i+j]=u+t;\n\t\t\t\ta[i+j+m/2]=u-t;\n\t\t\t\tw=w*wn;\n\t\t\t}\n\t\t}\n\t}\n\tif(flag==-1) for(ll i=0;i<Lim;++i) a[i].r/=Lim;\n}\ninline void write(string S){\n\tll Len=S.size();\n\tfor(ll i=0;i<=Len;i++) putchar(S[i]);\n\tputchar('\\n');\n}\ninline string toString(ll p){\n\tstring P;\n\twhile(p){P+=(p%10+'0'),p/=10;}\n\treverse(P.begin(),P.end());\n\treturn P;\n}\ninline string times(string S1,string S2){\n\tAlen=0,Blen=0,Lim=1,len=0;\n\tmemset(rev,0,sizeof rev);\n\tmemset(A,0,sizeof A);memset(B,0,sizeof B);memset(ans,0,sizeof ans);\n\tfor(ll i=S1.size()-1;i>=0;i--) A[Alen++].r=S1[i]^48;\n\tfor(ll i=S2.size()-1;i>=0;i--) B[Blen++].r=S2[i]^48;\n\twhile(Lim<=Alen+Blen) Lim<<=1,++len;\n\tfor(ll i=0;i<Lim;++i) rev[i]=(rev[i>>1]>>1)|((i&1)<<(len-1));\n\tFFT(A,1),FFT(B,1);\n\tfor(ll i=0;i<Lim;++i) A[i]=A[i]*B[i];\n\tFFT(A,-1);\n\tfor(ll i=0;i<Lim;++i){\n\t\tans[i]+=(ll)(A[i].r+0.5);\n\t\tif(ans[i]>9) ans[i+1]+=ans[i]/10,ans[i]%=10,Lim+=(i==Lim);\n\t}\n\twhile(!ans[Lim]&&Lim>=1) --Lim;++Lim;\n\tstring P;\n\twhile(--Lim>=0) P+=('0'+ans[Lim]);\n\treturn P;\n}\ninline string ksm(string S1,ll p){\n\tstring S2=\"1\";\n\twhile(p){\n\t\tif(p&1) S2=times(S2,S1);\n\t\tS1=times(S1,S1);\n\t\tp>>=1;\n\t}\n\treturn S2;\n}\nll na[Maxn],nb[Maxn];\ninline string sub(string a, string b){\n    memset(na,0,sizeof na);\n    memset(nb,0,sizeof nb);\n    memset(ans,0,sizeof ans);\n    string P;\n    if((a<b&&a.size()<=b.size())||b.size()>a.size()) return \"-\"+sub(b,a);\n    for(ll i=a.size();i>0;i--)na[i]=a[a.size()-i]-'0';\n    for(ll i=b.size();i>0;i--)nb[i]=b[b.size()-i]-'0';\n    ll len2=max(a.size(),b.size());\n    for(ll i=1;i<=len2;i++){\n        if(na[i]<nb[i]) na[i+1]--,na[i]+=10;\n        ans[i]=na[i]-nb[i];\n    }\n    while(ans[len2]==0) len2--;\n    if(len2<1)return \"0\";\n    for(ll i=len2;i>0;i--) P+=ans[i]+'0';\n    return P;\n}\ninline string add(string a, string b){\n    memset(na,0,sizeof na);\n    memset(nb,0,sizeof nb);\n    memset(ans,0,sizeof ans);\n    string P;\n    for(ll i=a.size();i>0;i--)na[i]=a[a.size()-i]-'0';\n    for(ll i=b.size();i>0;i--)nb[i]=b[b.size()-i]-'0';\n    ll len2=max(a.size(),b.size());\n    for(ll i=1;i<=len2;i++){\n        ans[i]+=na[i]+nb[i];\n        if(ans[i]>9) ans[i+1]+=ans[i]/10,ans[i]%=10;\n    }\n    while(ans[len2]==0) len2--;\n    if(len2<1)return \"0\";\n    for(ll i=len2;i>0;i--) P+=ans[i]+'0';\n    return P;\n}\ninline bool check(string a,string b){\n\tll sizea=a.size(),bsize=b.size();\n\tif(sizea!=bsize) return sizea<bsize;\n\tfor(ll i=0;i<sizea;i++){\n\t\tif(a[i]==b[i]) continue;\n\t\treturn a[i]<b[i];\n\t}\n\treturn 0;\n}\ninline ll Log2(string S){\n\tll lens=S.size()-1;lens=lens*log2(10);ll k=0;\n\tstring g=ksm(\"2\",lens);\n\twhile(check(g,S)) g=times(g,\"2\"),++lens,++k;\n\treturn lens;\n}\nint main(){\n\tcin>>S;\n\tll len=Log2(S);\n\tstring P=add(sub(times(S,toString(len)),ksm(\"2\",len)),\"1\");ll an=0;\n\twrite(P);\n\treturn 0;\n}\n```\n",
        "postTime": 1674537747,
        "uid": 590600,
        "name": "MoriyaSuwako",
        "ccfLevel": 0,
        "title": "P5634\u9898\u89e3"
    }
]
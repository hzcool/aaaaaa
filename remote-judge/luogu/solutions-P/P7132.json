[
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P7132)\u3002\n\n> \u9898\u610f\u7b80\u8ff0\uff1a\u7ed9\u5b9a $n,m,d_{1,2,\\cdots,n}$\uff0c\u6c42\u6709\u591a\u5c11\u79cd\u5e8f\u5217 $h_{1,2,\\cdots,n}$ \u6ee1\u8db3 $0\\leq h_i\\leq m$ \u4e14\u5bf9\u4e8e\u6240\u6709 $i\\in[2,n-1]$ \u6709 $\\max(h_{i-1},h_{i+1})+d_i\\ge h_i$\u3002\n\n---\n\n\u9996\u5148\uff0c\u770b\u5230 $n,m\\leq 7\\times 10^3$ \u8003\u8651\u80fd\u5426 $\\mathcal{O}(nm)$ DP\u3002\n\n\u8003\u8651\u7b2c $i$ \u5806\u96f6\u98df\u65f6\uff0c\u7b2c $i+1$ \u5806\u96f6\u98df\u7684\u9ad8\u5ea6\u4f1a\u5f71\u54cd\u65b9\u6848\u7684\u53ef\u884c\u6027\uff08\u5373\u6709\u540e\u6548\u6027\uff09\uff0c\u6240\u4ee5\u4e0d\u80fd\u5355\u7eaf\u8bbe $f_{i,j}$ \u8868\u793a $h_i=j$ \u7684\u5408\u6cd5\u65b9\u6848\u6570\u3002\n\n\u4e0d\u96be\u60f3\u5230\u6309\u7167 **\u7b2c $i$ \u5806\u96f6\u98df\u662f\u5426\u9760\u5230\u4e86\u7b2c $i-1$ \u5806\u96f6\u98df\u4e0a\uff08\u5373 $h_{i-1}+d_i$ \u4e0e $h_i$ \u7684\u5173\u7cfb\uff09** \u5c06 $h_i=j$ \u65f6\u7684\u5408\u6cd5\u65b9\u6848\u6570\u5206\u6210\u4e24\u7c7b\u60c5\u51b5\u8ba8\u8bba\uff1a\u8bbe $f_{i,j}$ \u8868\u793a $h_i=j$ \u4e14 $h_{i-1}+d_i\\geq h_i$\uff08\u5373\u7b2c $i$ \u5806\u96f6\u98df\u9760\u5230\u4e86\u7b2c $i-1$ \u5806\u96f6\u98df\u4e0a\uff0c\u6b64\u65f6\u4e0d\u5173\u5fc3 $h_{i+1}$ \u7684\u5927\u5c0f\uff09\u7684\u5408\u6cd5\u65b9\u6848\u6570\uff0c$g_{i,j}$ \u8868\u793a $h_i=j$ \u4e14 $h_{i-1}+d_i<h_i$ \u7684\u5408\u6cd5\u65b9\u6848\u6570\u3002\n\n\u63a5\u4e0b\u6765\u63a8\u8f6c\u79fb\u65b9\u7a0b\uff1a**\u8bb0 $l=\\max(0,j-d_i),r=\\min(m,j+d_{i-1})$**\n\u3002\n\n$f_{i-1,k}\\to f_{i,j}$\uff1a\u6b64\u65f6\u5e94\u6ee1\u8db3 $k+d_{i}\\geq j$\uff0c\u4f46\u56e0\u4e3a $f$ \u7684\u5b9a\u4e49\uff0c**\u4e0d\u9700\u8981\u6ee1\u8db3** $j+d_{i-1}\\geq k$\uff0c\u6240\u4ee5\u6b64\u65f6 $k$ \u7684\u9650\u5236\u4e3a $\\max(0,j-d_i)\\leq k\\leq m$\uff0c\u5373\n\n$$f_{i,j}\\gets f_{i,j}+\\sum_{k=l}^m f_{i-1,k}$$\n\n\u3002$g_{i-1,k}\\to f_{i,j}$\uff1a\u6b64\u65f6\u5e94\u6ee1\u8db3 $k+d_i\\geq j$ \u4e14 $j+d_{i-1}\\geq k$\uff0c\u5373 $l\\leq k\\leq r$\uff0c\u5373\n\n$$f_{i,j}\\gets f_{i,j}+\\sum_{k=l}^r g_{i-1,k}$$\n\n\u3002\u7efc\u4e0a\uff0c$f_{i,j}$ \u7684\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\n\n$$f_{i,j}=\\sum_{k=l}^m f_{i-1,k}+\\sum_{k=l}^r g_{i-1,k}$$\n\n\u3002\u6839\u636e\u4e0a\u9762\u7684\u601d\u8def\uff0c\u4e0d\u96be\u63a8\u51fa $g_{i,j}$ \u7684\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$g_{i,j}=\\sum_{k=0}^{l-1}f_{i-1,k}+g_{i-1,k}$$\n\n\u3002\u8865\u5145\u8bf4\u660e\uff1a\u5f53 $g_{i-1,k}\\to g_{i,j}$ \u65f6\uff0c$k$ \u5e94\u540c\u65f6\u6ee1\u8db3 $k\\leq r$ \u4e14 $k<l$\uff0c\u53c8\u56e0\u4e3a $d_i$ \u7684\u975e\u8d1f\u6027\u6709 $l\\leq r$\uff0c\u6240\u4ee5\u6b64\u65f6 $k\\leq l$\u3002\n\n\u7531\u4e8e\u6700\u540e\u4e00\u5806\u96f6\u98df\u6ca1\u6709\u9ad8\u5ea6\u9650\u5236\uff0c\u6240\u4ee5\u6700\u7ec8\u7b54\u6848\u4e3a $\\sum f_{n,i}+g_{n,i}$\u3002\n\n\u6700\u540e\u524d\u7f00\u548c\u4f18\u5316 + \u6eda\u52a8\u6570\u7ec4\u4f18\u5316\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(nm)$\u3002\u53c2\u8003\u4ee3\u7801\uff1a\n\n```cpp\nconst int N=7e3+5;\n\nll n,m,d[N],f[2][N],g[2][N];\n\nint main(){\n\tcin>>n>>m; for(int i=1;i<=n;i++)cin>>d[i];\n\tfor(int i=0;i<=m;i++)f[1][i]=i+1;\n\tfor(int i=2;i<=n;i++){\n\t\tint p=i&1,q=p^1;\n\t\tfor(int j=0;j<=m;j++){\n\t\t\tint l=max(0ll,j-d[i]),r=min(m,j+d[i-1]);\n\t\t\tf[p][j]=(f[q][m]+g[q][r]-(l?f[q][l-1]+g[q][l-1]:0)+(j?f[p][j-1]:0)+mod)%mod;\n\t\t\tg[p][j]=((l?f[q][l-1]+g[q][l-1]:0)+(j?g[p][j-1]:0))%mod;\n\t\t}\n\t} cout<<(f[n&1][m]+g[n&1][m])%mod<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1608437916,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P7132 \u3010\u5c0f L \u7684\u96f6\u98df\u3011"
    },
    {
        "content": "## \u524d\u8a00\n\u633a\u597d\u7684\u9898\u3002\n## \u601d\u8def\n\u4e0b\u6587\u4e2d $x$ \u9760\u4f4f $y$ \u6307 $h_y\\geq h_x-d_x$\n\n\u770b\u5230\u8fd9\u4e2a\u4e1c\u897f\u7b2c\u4e00\u4e2a\u60f3\u5230\u7684\u5c31\u662f dp\u3002\n\n\u53d1\u73b0\u8fd9\u4e2a\u4e1c\u897f\u72b6\u6001\u5176\u5b9e\u633a\u597d\u8bbe\u7684\uff0c\u6211\u4eec\u76f4\u63a5\u8bbe $dp_{i,j,0}$ \u4e3a\u5df2\u7ecf\u653e\u597d\u524d $i$ \u4e2a\uff0c\u524d $i-1$ \u4e2a\u5df2\u7ecf\u6ee1\u8db3\u8981\u6c42\uff0c\u7b2c $i$ \u4e2a\u4e0d\u6ee1\u8db3\u8981\u6c42\u7684\u60c5\u51b5\u6570\uff0c$dp_{i,j,1}$ \u4e3a\u5df2\u7ecf\u653e\u597d\u524d $i$ \u4e2a\uff0c\u5747\u6ee1\u8db3\u8981\u6c42\u7684\u60c5\u51b5\u6570\u3002\n\n\u7136\u540e\u8003\u8651\u8f6c\u79fb\u3002\u8f6c\u79fb\u663e\u7136\u5206\u56db\u79cd\uff1a$0\\to 0,0\\to1,1\\to0,1\\to1$\uff08\u5510\u7a81\u5f00\u8f66\uff09\uff0c\u6211\u4eec\u4e00\u79cd\u4e00\u79cd\u6765\u3002\n\n\u6211\u4eec\u6765\u62ff\u7b2c\u4e00\u79cd\u60c5\u51b5\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u7b2c $i-1$ \u4e2a\u9760\u4f4f\u53f3\u8fb9\u3002\u7b2c $i$ \u4e2a\u4e0d\u80fd\u9760\u4f4f\u5de6\u8fb9\u3002\n\n\u5217\u51fa\u4e0d\u7b49\u5f0f\uff1a\n\n$$\\left\\{\\begin{array}{l}\nh_{i}\\geq h_{i-1}-d_{i-1}\\\\h_{i-1}<h_{i}-d_i\n\\end{array}\\right.$$\n\n\u5316\u7b80\u5f97\n\n$$\\left\\{\\begin{array}{l}\nh_{i}\\geq h_{i-1}-d_{i-1}\\\\h_i> h_{i-1}+d_i\\end{array}\\right.$$\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u77e5\u9053\u54ea\u4e9b $h_{i-1}$ \u53ef\u4ee5\u8f6c\u79fb\u5230 $h_i$ \u4e86\u3002\u5176\u4f59\u4e09\u7c7b\u8f6c\u79fb\u601d\u8def\u7c7b\u4f3c\uff0c\u8fd9\u91cc\u5c31\u4e0d\u5199\u4e86\u3002\u4e0d\u96be\u53d1\u73b0\u80fd\u8f6c\u79fb\u7684\u90e8\u5206\u90fd\u662f**\u8fde\u7eed\u7684\u4e00\u6bb5**\uff0c\u6240\u4ee5\u6bcf\u6b21 dp \u5b8c\u8981\u505a\u4e00\u6b21\u524d\u7f00\u548c\u3002\u8fd9\u6837\u5199\u7a7a\u95f4\u53ef\u80fd\u5403\u4e0d\u6d88\uff0c\u6240\u4ee5\u8bf7\u4f7f\u7528\u6eda\u52a8\u6570\u7ec4\u3002\n## \u4ee3\u7801\n```\n#include<bits/stdc++.h>\nusing namespace std;\ninline int read(){\n   int s=0,w=1;\n   char ch=getchar();\n   while(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n   while(ch>='0'&&ch<='9') s=s*10+ch-'0',ch=getchar();\n   return s*w;\n}\nint d[7003];\nlong long ans[7003][2],pre[7003][2]; \nconst long long p=998244353;\nsigned main()\n{\n\tint n=read(),m=read();\n\tfor(int i=1; i<=n; ++i) d[i]=read();\n\tfor(int i=0; i<=m; ++i) pre[i][1]=i+1;\n\tfor(int i=2; i<=n; ++i) \n\t{\n\t\tfor(int j=0; j<=m; j++)\n\t\tans[j][1]=(pre[min(j+d[i-1],m)][0]+(j-d[i]<=0?0:p-pre[j-d[i]-1][0])+pre[m][1]+(j-d[i]<=0?0:p-pre[j-d[i]-1][1]))%p,\n\t\tans[j][0]=(j-d[i]-1<0?0:(pre[j-d[i]-1][1]+pre[j-d[i]-1][0])%p);\n\t\tpre[0][1]=ans[0][1],pre[0][0]=ans[0][0];\n\t\tfor(int j=1; j<=m; j++) pre[j][1]=(pre[j-1][1]+ans[j][1])%p,pre[j][0]=(pre[j-1][0]+ans[j][0])%p;\n\t}\n\tprintf(\"%lld\\n\",(pre[m][0]+pre[m][1])%p);\n\treturn 0;\n}\n```\n",
        "postTime": 1608432587,
        "uid": 111055,
        "name": "dead_X",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P7132 \u3010\u5c0f L \u7684\u96f6\u98df\u3011"
    }
]
[
    {
        "content": "\u4f5c\u4e3a\u4e00\u9053\u7acb\u5fd7\u4e8e\u6253\u7834\u5957\u8def\u7684\u5957\u8def\u6570\u8bba\u9898\uff0c\u8fd9\u9898\u5176\u5b9e\u4e0d\u662f\u5f88\u96be\u3002\n\n\u8fd9\u9053\u9898\u6709\u4e24\u79cd\u601d\u8def\uff0c\u4e00\u79cd\u5f88\u66b4\u529b\uff0c\u9700\u8981\u5f88\u624e\u5b9e\u7684\u57fa\u672c\u529f\u3002\u4e00\u79cd\u5f88\u5de7\u5999\uff0c\u9700\u8981\u5f88\u5f3a\u7684\u601d\u7ef4\u80fd\u529b\u3002\n\n\u73b0\u5728\uff0c\u6211\u4eec\u4ee5\u63a8\u51fa\u6b63\u89e3\u5f0f\u5b50\u7684\u8fc7\u7a0b\uff0c\u6765\u8bb2\u89e3\u4e00\u4e0b\u8fd9\u9053\u9898\u76ee\u3002\n\n\u6cd5\u4e00\uff1a\u66b4\u529b\n$$\n\\sum_{i=1}^N\\sum_{j=1}^N\\sum_{p=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\sum_{q=1}^{\\lfloor\\frac{N}{j}\\rfloor}[\\gcd(i,j)==1][\\gcd(p,q)==1]\n$$\n\u62ff\u5230\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u6211\u4eec\u5148\u8fdb\u884c\u6700\u6700\u57fa\u672c\u7684\u53d8\u5f62\uff1a\n$$\n=\\sum_{i=1}^N\\sum_{j=1}^N[\\gcd(i,j)==1]\\sum_{p=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\sum_{q=1}^{\\lfloor\\frac{N}{j}\\rfloor}[\\gcd(p,q)==1]\n$$\n\n\u5047\u5982\u5728\u8fd9\u65f6\u5019\u505c\u7b14\u679a\u4e3e\uff0c\u5c31\u53ef\u4ee5\u8fc7\u7b2c\u4e00\u4e2a\u6d4b\u8bd5\u70b9\u300210 pts get\uff01\uff08\u7136\u800c\u590d\u6742\u5ea6\u6211\u4e0d\u4f1a\u7b97233\uff09\n\n\u5c06\u540e\u9762\u62ce\u51fa\u6765\u770b\uff1a\n$$\n\\sum_{p=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\sum_{q=1}^{\\lfloor\\frac{N}{j}\\rfloor}[\\gcd(p,q)==1]\n$$\n\u8fd9\u4e0d\u6b63\u662f\u6211\u4eec\u6700\u6700\u719f\u6089\u7684\u5417\uff1f\n\n\u63a5\u4e0b\u6765\u6709\u4e24\u79cd\u505a\u6cd5\uff1a\n\n1. \u6211\u4f1a\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff01\n\n   \u5957\u8def\u7684\u5316\u7b80\u540e\u534a\u90e8\u5206\uff1a\n$$\n=\\sum_{p=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\sum_{q=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\sum_{d\\mid\\gcd(j,k)}\\mu(d)\n$$\n$$\n=\\sum_{d=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\lfloor\\frac{\\lfloor\\frac{N}{j}\\rfloor}{d}\\rfloor\\lfloor\\frac{\\lfloor\\frac{N}{j}\\rfloor}{d}\\rfloor\\mu(d)\n$$\n   \u4ee3\u56de\u539f\u5f0f\uff0c\u5f97\uff1a\n$$\n=\\sum_{i=1}^N\\sum_{j=1}^N[\\gcd(i,j)==1]\\sum_{d=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\lfloor\\frac{\\lfloor\\frac{N}{j}\\rfloor}{d}\\rfloor\\lfloor\\frac{\\lfloor\\frac{N}{j}\\rfloor}{d}\\rfloor\\mu(d)\n$$\n   \u76f4\u63a5\u6570\u8bba\u5206\u5757\u540e\u6309\u516c\u5f0f\u8ba1\u7b97\uff0c\u590d\u6742\u5ea6$O(n^2\\sqrt{n})$\uff0c20 pts get\uff01\n\n2. \u6211\u7cbe\u901a\u6570\u8bba\u51fd\u6570\uff01\n\n   \u5047\u5982\u4f60\u505a\u8fc7[SDOI2008\u4eea\u4ed7\u961f](https://www.luogu.com.cn/problem/P2158)\uff0c\u5c31\u5e94\u8be5\u4f1a\u8fd9\u79cd\u505a\u6cd5\uff0c\u5316\u7b80\u540e\u534a\u90e8\u5206\uff1a\n$$\n=2\\sum_{p=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\sum_{q=1}^p[\\gcd(p,q)==1]-1\n$$\n   \u6211\u4eec\u770b\u8fd9\u4e00\u90e8\u5206\n$$\n\\sum_{q=1}^p[\\gcd(p,q)==1]\n$$\n   \u8fd9\u6070\u597d\u662f$\\varphi$\u51fd\u6570\u7684\u5b9a\u4e49\u5f0f\u3002\n\n   \u56e0\u6b64\uff1a\n$$\n=2\\sum_{p=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\varphi(p)-1\n$$\n   \u8bb0$\\varphi^s(n)=\\sum_{i=1}^n\\varphi(i)$\uff0c\u5f97\uff1a\n$$\n=2\\varphi^s(\\lfloor\\frac{N}{j}\\rfloor)-1\n$$\n   \u56de\u4ee3\u5165\u539f\u5f0f\uff1a\n$$\n=\\sum_{i=1}^N\\sum_{j=1}^N[\\gcd(i,j)==1](2\\varphi^s(\\lfloor\\frac{N}{j}\\rfloor)-1)\n$$\n   \u7528\u7ebf\u6027\u7b5b\u9884\u5904\u7406\u51fa$\\varphi$\u53ca\u5176\u524d\u7f00\u548c\uff0c\u518d\u6309\u516c\u5f0f\u8ba1\u7b97\u5373\u53ef\u3002\n\n   \u590d\u6742\u5ea6$O(n^2)$\u300220 pts get\uff01\n\n\u663e\u7136\uff0c\u6211\u4eec\u7edd\u4e0d\u80fd\u6ee1\u8db3\u4e8e\u8fd9\u6837\u7684\u590d\u6742\u5ea6\uff0c\u6240\u4ee5\u7ee7\u7eed\u524d\u8fdb\u3002\n\n\u6ce8\u610f\u5230\u540e\u8fb9\u7684\u90e8\u5206\u5df2\u7ecf\u505a\u7684\u5f88\u597d\u4e86\uff0c\u5f88\u96be\u6709\u7ee7\u7eed\u4f18\u5316\u7684\u53ef\u80fd\uff0c\u5728\u8fd9\u6837\u7684\u60c5\u51b5\u4e0b\uff0c\u524d\u9762\u7684$[\\gcd(i,d)==1]$\u5c31\u6210\u4e86\u6211\u4eec\u7684\u773c\u4e2d\u9489\uff0c\u8089\u4e2d\u523a\u3002\n\n\u4f46\u8fd9\u4e00\u90e8\u5206\u5374\u4e0d\u80fd\u50cf\u4e4b\u524d\u4e00\u6837\u4f18\u5316\uff0c\u56e0\u4e3a\u540e\u9762\u7684\u90e8\u5206\u4f9d\u8d56\u4e8e\u6b64\u5904\u679a\u4e3e\u7684$j$\u3002\n\n\u90a3\u6ca1\u529e\u6cd5\uff0c\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u603b\u884c\u5427\uff0c\u5927\u4e0d\u4e86\u628a$d$\u7559\u7740\u5457\u3002\n$$\n=\\sum_{g=1}^N\\sum_{i=1}^{\\lfloor\\frac{N}{g}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{N}{g}\\rfloor}\\mu(g)(2\\varphi^s(\\lfloor\\frac{N}{jg}\\rfloor)-1)\n$$\n$$\n=\\sum_{g=1}^N\\lfloor\\frac{N}{g}\\rfloor\\mu(g)\\sum_{j=1}^{\\lfloor\\frac{N}{g}\\rfloor}(2\\varphi^s(\\lfloor\\frac{N}{jg}\\rfloor)-1)\n$$\n\u63a5\u4e0b\u6765\uff0c\u53c8\u6709\u4e24\u79cd\u65b9\u6cd5\u4e86\uff1a\n\n1. \u6211\u7cbe\u901a\u5957\u8def\uff01\n\n   \u53d1\u73b0\u539f\u5f0f\u5173\u4e8e$g$\u548c$j$\u7684\u679a\u4e3e\u5176\u5b9e\u5c31\u662f\u5728\u679a\u4e3e\u4e58\u79ef\u4e0d\u5927\u4e8e$n$\u7684\u4e8c\u5143\u7ec4\uff0c\u4e8e\u662f\u4ee4$T=gj$\uff0c\u5f97\uff1a\n$$\n=\\sum_{T=1}^N(2\\varphi^s(\\lfloor\\frac{N}{T}\\rfloor)-1)\\sum_{g\\mid T}\\lfloor\\frac{N}{g}\\rfloor\\mu(g)\n$$\n   \u5047\u5982\u6211\u4eec\u4ee4$f(T)=\\sum_{d\\mid T}\\lfloor\\frac{N}{d}\\rfloor\\mu(d)$\uff0c$h(T)=2\\varphi^s(T)-1$\uff0c\u539f\u5f0f\u5c31\u5316\u4e3a\uff1a\n$$\n=\\sum_{T=1}^Nh(\\lfloor\\frac{N}{T}\\rfloor)f(T)\n$$\n   \u8fd9\u662f\u4e00\u4e2a\u9664\u6cd5\u5206\u5757\u7684\u5f62\u5f0f\uff0c\u53ef\u4ee5\u5728\u9884\u5904\u7406\u540e$O(\\sqrt{n})$\u7684\u65f6\u95f4\u5185\u6c42\u51fa\u3002\n\n   \u95ee\u9898\u5c31\u5728\u4e8e\u5982\u4f55\u9884\u5904\u7406\u3002\n\n   $g$\u662f\u5f88\u597d\u6c42\u7684\uff0c\u800c$f$\u5f88\u68d8\u624b\uff0c$f$\u751a\u81f3\u4e0d\u662f\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\u3002\n\n   \u90a3\uff0c\u65e2\u7136\u65e0\u6cd5\u7ebf\u6027\u7b5b\uff0c\u6211\u4eec\u5c31\u679a\u4e3e\u6bcf\u4e00\u4e2a\u6570$p$\u53ca\u5176\u500d\u6570\uff0c\u66b4\u7b5b\u5427\u3002\n\n   \u590d\u6742\u5ea6\u662f\u8c03\u548c\u7ea7\u6570$O(n\\log n)$\uff0c60 pts get\uff01\n\n2. \u6211\u7cbe\u901a\u6570\u8bba\u5206\u5757\uff01\n\n   \u6211\u4eec\u89c2\u5bdf\u539f\u5f0f\uff0c\u5c06\u5176\u76f4\u63a5\u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff1a\n$$\n=\\sum_{g=1}^N\\mu(g)\\times\\lfloor\\frac{N}{g}\\rfloor\\sum_{j=1}^{\\lfloor\\frac{N}{g}\\rfloor}(2\\varphi^s(\\lfloor\\frac{N}{jg}\\rfloor)-1)\n$$\n   \u6211\u4eec\u91cd\u65b0\u5b9a\u4e49\u51fd\u6570$f$\uff1a\n$$\n   f(T)=T\\sum_{i=1}^T(2\\varphi^s(\\lfloor\\frac{T}{i}\\rfloor)-1)\n$$\n   \u663e\u7136\uff0c\u8fd9\u4e2a\u51fd\u6570\u53ef\u4ee5\u6570\u8bba\u5206\u5757$O(\\sqrt{n})$\u6c42\u3002\n\n   \u4ee3\u56de\u539f\u5f0f\uff1a\n$$\n\\sum_{g=1}^N\\mu(g)f(\\lfloor\\frac{N}{g}\\rfloor)\n$$\n   \u8fd9\u4e2a\u5f0f\u5b50\u4e5f\u662f\u53ef\u4ee5\u6570\u8bba\u5206\u5757$O(\\sqrt{n})$\u6c42\u7684\u3002\n\n   \u4f46\u6211\u4eec\u518d\u4e00\u6b21\u9047\u5230\u4e86\u9884\u5904\u7406\u7684\u96be\u9898\uff0c\u8fd9\u6b21\u5982\u679c\u518d\u66b4\u529b\uff0c\u590d\u6742\u5ea6\u5c31\u662f$O(n\\sqrt{n})$\u7684\uff0c\u8fd8\u4e0d\u5982\u4e0a\u4e00\u79cd\u65b9\u6cd5\u3002\n\n   \u7b54\u6848\u662f\uff1a\u6211\u4eec\u6839\u672c\u4e0d\u9700\u8981\u9884\u5904\u7406\uff01\n\n   \u518d\u5bf9\u7b2c\u4e8c\u4e2a\u5f0f\u5b50\u6570\u8bba\u5206\u5757\u65f6\uff0c\u6211\u4eec\u6c42\u51fa\u6240\u9700\u7684$f$\u503c\u5373\u53ef\u3002\n\n   \u8fd9\u6837\u505a\uff0c\u590d\u6742\u5ea6\u662f$O(n^\\frac{3}{4})$\u7684\uff0c\u8003\u8651\u5230\u9884\u5904\u7406\u7684$O(n)$\u590d\u6742\u5ea6\uff0c\u603b\u590d\u6742\u5ea6\u4f9d\u7136\u662f$O(n)$\u7684\u300280 pts get\uff01\n\n   \u5982\u4f55\u6539\u8fdb\u590d\u6742\u5ea6\u5462\uff1f\n\n   \u9884\u5904\u7406\u4f7f\u7528\u675c\u6559\u7b5b\uff0c\u5373\u53ef\u4f7f\u590d\u6742\u5ea6\u74f6\u9888\u53d8\u4e3a\u8ba1\u7b97\u7684\u8fc7\u7a0b\u3002\u65b0\u590d\u6742\u5ea6\u662f$O(n^\\frac{3}{4})$\u7684\u300290 pts get\uff01\n\n   \u6587\u672b\u4f1a\u6709\u8be5\u6863\u90e8\u5206\u5206\u7684\u4ee3\u7801\u3002\n\n\u6cd5\u4e8c\uff1a\u601d\u7ef4\n\n\u4e0d\u8fdb\u884c\u4efb\u4f55\u53d8\u5f62\uff1a\n$$\n\\sum_{i=1}^N\\sum_{j=1}^N\\sum_{p=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\sum_{q=1}^{\\lfloor\\frac{N}{j}\\rfloor}[\\gcd(i,j)==1][\\gcd(p,q)==1]\n$$\n\u4ed4\u7ec6\u89c2\u5bdf\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u4f60\u4f1a\u53d1\u73b0\uff0c\u5173\u4e8e$j$\u7684\u679a\u4e3e\uff0c\u5f88\u50cf\u662f\u5728\u679a\u4e3e$p$\uff0c$q$\u7684$\\gcd$\u3002\n\n\u6211\u4eec\u6765\u8bd5\u4e00\u8bd5\u3002\n$$\n=\\sum_{i=1}^N\\sum_{p=1}^N\\sum_{q=1}^N[\\gcd(i,\\gcd(p,q))==1]\n$$\n\n$$\n=\\sum_{i=1}^N\\sum_{p=1}^N\\sum_{q=1}^N[\\gcd(i,p,q)==1]\n$$\n\n\u5199\u5230\u8fd9\u91cc\uff0c\u4f60\u53ef\u4ee5\u505c\u7b14$O(n^3)$\u7684\u53bb\u679a\u4e3e\uff08~~10 pts get~~\uff09\uff0c\u4f46\u5176\u5b9e\u4f60\u79bb\u53e6\u4e00\u79cd\u6b63\u89e3\u53ea\u6709\u4e24\u6b65\u4e4b\u9065\u3002\n$$\n=\\sum_{d=1}^N\\sum_{i=1}^{\\lfloor\\frac{N}{d}\\rfloor}\\sum_{p=1}^{\\lfloor\\frac{N}{d}\\rfloor}\\sum_{q=1}^{\\lfloor\\frac{N}{d}\\rfloor}\\mu(d)\n$$\n\n$$\n=\\sum_{d=1}^N\\mu(d)\\lfloor\\frac{N}{d}\\rfloor\\lfloor\\frac{N}{d}\\rfloor\\lfloor\\frac{N}{d}\\rfloor\n$$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u5728$O(n)$\u7684\u9884\u5904\u7406\u540e\uff0c$O(\\sqrt{n})$\u7684\u6c42\u5f97\uff0c\u603b\u590d\u6742\u5ea6$O(n)$\u300280 pts get\uff01\n\n\u548c\u4e0a\u4e00\u79cd\u65b9\u6cd5\u4e00\u6837\uff0c\u6211\u4eec\u4f7f\u7528\u675c\u6559\u7b5b\u4f18\u5316\u3002\u74f6\u9888\u4f9d\u65e7\u662f\u9884\u5904\u7406\uff0c\u4f46\u590d\u6742\u5ea6\u964d\u81f3$O(n^\\frac{2}{3})$\uff0c100 pts get\uff01\n\n\u6587\u672b\u4f1a\u6709\u8be5\u6807\u7a0b\u7684\u4ee3\u7801\u3002\n\n\u63a5\u4e0b\u6765\u662f\u4ee3\u7801\u65f6\u95f4\uff1a\n\n90 pts\u7684\u4ee3\u7801\uff1a\n\n```cpp\n#define _CRT_SECURE_NO_WARNINGS\n\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<map>\n\nusing namespace std;\n\n#define _N 1000001\n#define _P 998244353\n#define _INV 499122177\n\nint n;\n\nint pricnt = 0;\nbool visited[_N];\nint prime[_N];\nint mu[_N];\nint phi[_N];\n\nmap<int, int> ansmu, ansphi;\n\nlong long ans = 0;\n\nvoid sieve()\n{\n\tint range = n + 1 < _N ? n + 1 : _N;\n\tvisited[1] = true;\n\tmu[1] = phi[1] = 1;\n\tfor (int i = 1; i < range; i++)\n\t{\n\t\tif (!visited[i])\n\t\t{\n\t\t\tprime[++pricnt] = i;\n\t\t\tmu[i] = _P - 1;\n\t\t\tphi[i] = i - 1;\n\t\t}\n\t\tfor (int j = 1; j <= pricnt; j++)\n\t\t{\n\t\t\tif (i * prime[j] >= range)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvisited[i * prime[j]] = true;\n\t\t\tif (i % prime[j])\n\t\t\t{\n\t\t\t\tmu[i * prime[j]] = (_P - mu[i]) % _P;\n\t\t\t\tphi[i * prime[j]] = phi[i] * phi[prime[j]] % _P;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tphi[i * prime[j]] = phi[i] * prime[j] % _P;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i = 1; i < range; i++)\n\t{\n\t\tmu[i] = (mu[i - 1] + mu[i]) % _P;\n\t\tphi[i] = (phi[i - 1] + phi[i]) % _P;\n\t}\n}\n\nint getmu(int x)\n{\n\tif (x < _N)\n\t{\n\t\treturn mu[x];\n\t}\n\tif (ansmu[x])\n\t{\n\t\treturn ansmu[x];\n\t}\n\tlong long res = 1;\n\tfor (int l = 2, r; l <= x; l = r + 1)\n\t{\n\t\tr = x / (x / l);\n\t\tres = (res - ((long long)r - l + 1) * getmu(x / l) % _P + _P) % _P;\n\t}\n\treturn ansmu[x] = res;\n}\n\nint getphi(int x)\n{\n\tif (x < _N)\n\t{\n\t\treturn phi[x];\n\t}\n\tif (ansphi[x])\n\t{\n\t\treturn ansphi[x];\n\t}\n\tlong long res = (long long)x * ((long long)x + 1) % _P * _INV % _P;\n\tfor (int l = 2, r; l <= x; l = r + 1)\n\t{\n\t\tr = x / (x / l);\n\t\tres = (res - ((long long)r - l + 1) * getphi(x / l) % _P + _P) % _P;\n\t}\n\treturn ansphi[x] = res;\n}\n\nlong long f(int n)\n{\n\tlong long res = 0;\n\tfor (int l = 1, r = 0; l <= n; l = r + 1)\n\t{\n\t\tr = n / (n / l);\n\t\tres = (res + (r - l + 1) * (2 * getphi(n / l) % _P - 1) % _P) % _P;\n\t}\n\tres = res * n % _P;\n\treturn res;\n}\n\nint main()\n{\n\tscanf(\"%d\", &n);\n\tsieve();\n\tfor (int l = 1, r = 0; l <= n; l = r + 1)\n\t{\n\t\tr = n / (n / l);\n\t\tans = (ans + ((long long)getmu(r) - getmu(l - 1) + _P) % _P * f(n / l) % _P) % _P;\n\t}\n\tprintf(\"%lld\\n\", ans);\n\treturn 0;\n}\n```\n\n100 pts\u7684\u4ee3\u7801\uff1a\n\n```cpp\n#define _CRT_SECURE_NO_WARNINGS\n\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<map>\n\nusing namespace std;\n\n#define _N 1000001\n#define _P 998244353\n\nint n;\n\nint pricnt = 0;\nbool visited[_N];\nint prime[_N];\nint mu[_N];\n\nmap<int, int> ansmu;\n\nlong long ans = 0;\n\nvoid sieve()\n{\n\tint range = n + 1 < _N ? n + 1 : _N;\n\tvisited[1] = true;\n\tmu[1] = 1;\n\tfor (int i = 1; i < range; i++)\n\t{\n\t\tif (!visited[i])\n\t\t{\n\t\t\tprime[++pricnt] = i;\n\t\t\tmu[i] = _P - 1;\n\t\t}\n\t\tfor (int j = 1; j <= pricnt; j++)\n\t\t{\n\t\t\tif (i * prime[j] >= range)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tvisited[i * prime[j]] = true;\n\t\t\tif (i % prime[j])\n\t\t\t{\n\t\t\t\tmu[i * prime[j]] = (_P - mu[i]) % _P;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i = 1; i < range; i++)\n\t{\n\t\tmu[i] = (mu[i - 1] + mu[i]) % _P;\n\t}\n}\n\nint getmu(int x)\n{\n\tif (x < _N)\n\t{\n\t\treturn mu[x];\n\t}\n\tif (ansmu[x])\n\t{\n\t\treturn ansmu[x];\n\t}\n\tlong long res = 1;\n\tfor (int l = 2, r; l <= x; l = r + 1)\n\t{\n\t\tr = x / (x / l);\n\t\tres = (res - ((long long)r - l + 1) * getmu(x / l) % _P + _P) % _P;\n\t}\n\treturn ansmu[x] = res;\n}\n\nint main()\n{\n\tscanf(\"%d\", &n);\n\tsieve();\n\tfor (int l = 1, r = 0; l <= n; l = r + 1)\n\t{\n\t\tr = n / (n / l);\n\t\tans = (ans + ((long long)getmu(r) - getmu(l - 1) + _P) % _P * ((long long)n / l) % _P * ((long long)n / l) % _P * ((long long)n / l) % _P) % _P;\n\t}\n\tprintf(\"%lld\\n\", ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1580636461,
        "uid": 244096,
        "name": "FangZeLi",
        "ccfLevel": 7,
        "title": "GCD \u9898\u89e3"
    },
    {
        "content": "\u6ca1\u5565\u597d\u8bf4\u7684\uff0c\u675c\u6559\u7b5b\u677f\u5b50\u9898\u3002\n\n\n$$\\sum_{i=1}^{N} \\sum_{j=1}^{N}\\sum_{p=1}^{\\lfloor \\frac{N}{j} \\rfloor}\\sum_{q=1}^{\\lfloor \\frac{N}{j} \\rfloor} [\\gcd(i,j)==1][\\gcd(p,q)==1]$$\n\n\n\u5bb9\u6613\u53d1\u73b0\uff0c\u6211\u4eec\u679a\u4e3e $j$ \u5176\u5b9e\u662f\u76f8\u5f53\u4e8e\u679a\u4e3e $\\gcd$\n~~\u624d\u4e0d\u662f\u679a\u4e3e\u9898\u76ee~~\n\n\u7136\u540e\u5f0f\u5b50\u53ef\u4ee5\u53d8\u6210\n\n$$\\sum_{i=1}^{N}\\sum_{p=1}^{N}\\sum_{q=1}^{N} [\\gcd(i,p,q)==1]$$\n\n\u7136\u540e\u5957\u8def\u5f0f\u7684\u679a\u4e3e $gcd$ ~~\u4f9d\u65e7\u4e0d\u662f\u679a\u4e3e\u9898\u76ee~~\n\n$$\\sum_{d=1}^{N}\\sum_{i=1}^{N}\\sum_{p=1}^{N}\\sum_{q=1}^{N}[\\gcd(i,p,q)==d]$$\n\n\u719f\u6089\u7684\u5f62\u5f0f\uff0c\u5176\u5b9e\u5c31\u7b49\u4e8e\n\n$$\\sum_{d=1}^{N}\\sum_{i=1}^{\\lfloor \\frac{N}{d} \\rfloor} \\sum_{p=1}^{\\lfloor \\frac{N}{d} \\rfloor} \\sum_{q=1}^{\\lfloor \\frac{N}{d} \\rfloor} \\mu(d)$$\n\n$$\\sum_{d=1}^{N} \\mu(d) \\lfloor \\frac{N}{d}\\rfloor^3$$\n\n\u7136\u540e\u6574\u9664\u5206\u5757\u5c31\u5b8c\u4e86\uff0c\u7531\u4e8e $N$ \u6bd4\u8f83\u5927\uff0c\u5927\u529b\u675c\u6559\u7b5b\u5c31\u5b8c\u4e8b\u4e86\uff0c~~\u8bdd\u8bf4\u6211\u597d\u50cf\u662f\u8fd9\u9898\u9664\u6389\u51fa\u9898\u4eba\u7684\u6700\u4f18\u89e3~~\n\n```cpp\n// powered by c++11\n// by Isaunoya\n#include<bits/stdc++.h>\n#define rep(i , x , y) for(register int i = (x) ; i <= (y) ; ++ i)\n#define Rep(i , x , y) for(register int i = (x) ; i >= (y) ; -- i)\nusing namespace std ;\nusing db = double ;\nusing ll = long long ;\nusing uint = unsigned int ;\n#define int long long\nusing pii = pair < int , int > ;\n#define ve vector\n#define Tp template\n#define all(v) v.begin() , v.end()\n#define sz(v) ((int)v.size())\n#define pb emplace_back\n#define fir first\n#define sec second\n// the cmin && cmax\nTp < class T > void cmax(T & x , const T & y) { if(x < y) x = y ; }\nTp < class T > void cmin(T & x , const T & y) { if(x > y) x = y ; }\n// sort , unique , reverse\nTp < class T > void sort(ve < T > & v) { sort(all(v)) ; }\nTp < class T > void unique(ve < T > & v) { sort(all(v)) ; v.erase(unique(all(v)) , v.end()) ; }\nTp < class T > void reverse(ve < T > & v) { reverse(all(v)) ; }\nconst int SZ = 0x191981 ;\nstruct FILEIN {\n\t~ FILEIN () {} char qwq[SZ] , * S = qwq , * T = qwq , ch ;\n\tchar GETC() { return (S == T) && (T = (S = qwq) + fread(qwq , 1 , SZ , stdin) , S == T) ? EOF : * S ++ ; }\n\tFILEIN & operator >> (char & c) { while(isspace(c = GETC())) ; return * this ; }\n\tFILEIN & operator >> (string & s) {\n\t\twhile(isspace(ch = GETC())) ; s = ch ;\n\t\twhile(! isspace(ch = GETC())) s += ch ; return * this ;\n\t}\n\tTp < class T > void read(T & x) {\n\t\tbool sign = 1 ; while((ch = GETC()) < 0x30) if(ch == 0x2d) sign = 0 ;\n\t\tx = (ch ^ 0x30) ; while((ch = GETC()) > 0x2f) x = x * 0xa + (ch ^ 0x30) ;\n\t\tx = sign ? x : -x ;\n\t}\n\tFILEIN & operator >> (int & x) { return read(x) , * this ; }\n\tFILEIN & operator >> (signed & x) { return read(x) , * this ; }\n\tFILEIN & operator >> (unsigned & x) { return read(x) , * this ; }\n} in ;\nstruct FILEOUT { const static int LIMIT = 0x114514 ;\n\tchar quq[SZ] , ST[0x114] ; signed sz , O ;\n\t~ FILEOUT () { sz = O = 0 ; }\n\tvoid flush() { fwrite(quq , 1 , O , stdout) ; fflush(stdout) ; O = 0 ; }\n\tFILEOUT & operator << (char c) { return quq[O ++] = c , * this ; }\n\tFILEOUT & operator << (string str) {\n\t\tif(O > LIMIT) flush() ; for(char c : str) quq[O ++] = c ; return * this ;\n\t}\n\tTp < class T > void write(T x) {\n\t\tif(O > LIMIT) flush() ; if(x < 0) { quq[O ++] = 0x2d ; x = -x ; }\n\t\tdo { ST[++ sz] = x % 0xa ^ 0x30 ; x /= 0xa ; } while(x) ;\n\t\twhile(sz) quq[O ++] = ST[sz --] ; return ;\n\t}\n\tFILEOUT & operator << (int x) { return write(x) , * this ; }\n\tFILEOUT & operator << (signed x) { return write(x) , * this ; }\n\tFILEOUT & operator << (unsigned x) { return write(x) , * this ; }\n} out ;\n\nconst int maxn = 5e5 ;\nint mu[maxn + 10] ;\nconst int mod = 998244353 ;\nmap < int , int > _mu ;\nint getmu(int x) {\n\tif(x <= maxn) return mu[x] ;\n\tif(_mu[x]) return _mu[x] ;\n\tint ans = 1 ;\n\tint l = 2 , r = 0 ;\n\tfor( ; l <= x ; l = r + 1) {\n\t\tr = x / (x / l) ;\n\t\tans -= getmu(x / l) * (r - l + 1) ;\n\t\tans = (ans + mod) % mod ;\n\t}\n\treturn _mu[x] = ans ;\n}\nsigned main() {\n#ifdef _WIN64\n\tfreopen(\"testdata.in\" , \"r\" , stdin) ;\n#else\n\tios_base :: sync_with_stdio(false) ;\n\tcin.tie(nullptr) , cout.tie(nullptr) ;\n#endif\n// code begin.\n\tmu[1] = 1 ;\n\tfor(int i = 1 ; i <= maxn ; i ++)\n\t\tfor(int j = i + i ; j <= maxn ; j += i) \n\t\t\tmu[j] -= mu[i] ;\n\tfor(int i = 2 ; i <= maxn ; i ++)\n\t\tmu[i] = (mu[i] + mu[i - 1]) % mod ;\n\tint n ;\n\tin >> n ;\n\tint l = 1 , r = 0 ;\n\tint ans = 0 ;\n\tfor( ; l <= n ; l = r + 1) {\n\t\tr = n / (n / l) ;\n\t\tint qwq = (n / l) * (n / l) % mod * (n / l) % mod ;\n\t\tans = (ans + (getmu(r) - getmu(l - 1) + mod) % mod * qwq % mod) % mod ;\n\t}\n\tout << ans << '\\n' ;\n\treturn out.flush() , 0 ;\n// code end.\n}\n```",
        "postTime": 1580918991,
        "uid": 96580,
        "name": "SXNhdW5veWE",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6070 \u3010[RC-02] GCD\u3011"
    },
    {
        "content": "## \u3010\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u3011P6055 [RC-02] GCD\n\n### Analysis\n\n\u8fd9\u91cc\u6709\u4e00\u4e2a\u53c8\u5f31\u667a\u53c8\u9ebb\u70e6\u7684\u63a8\u5f0f\u5b50\u7684\u8fc7\u7a0b\u3002\n\n\u6c42\n\n$$A(n) = \\sum_{i=1}^N\\sum_{j=1}^N\\sum_{p=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\sum_{q=1}^{\\lfloor\\frac{N}{j}\\rfloor}[\\gcd(i,j)=1][\\gcd(p,q)=1]$$\n\n\u53d1\u73b0\u7b2c\u4e00\u4e2a\u65b9\u62ec\u53f7\u548c $p,q$ \u65e0\u5173\uff0c\u63d0\u5230\u524d\u9762\u6765\n\n$$\\begin{aligned}\nA(N) &=  \\sum_{i=1}^N\\sum_{j=1}^N[\\gcd(i,j)=1]\\sum_{p=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\sum_{q=1}^{\\lfloor\\frac{N}{j}\\rfloor}[\\gcd(p,q)=1]\\\\\n &= \\sum_{i=1}^N\\sum_{j=1}^N \\epsilon(\\gcd(i, j))\\sum_{p=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\sum_{q=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\epsilon(\\gcd(p,q))\n\\end{aligned}$$\n\n\u5176\u4e2d $\\epsilon(x) = [x = 1]$ \u4e3a\u5e7a\u5143\u51fd\u6570\u3002\n\n\u7136\u540e\u628a\u524d\u534a\u90e8\u5206\u6309\u7167\u5957\u8def\u53cd\u6f14\u4e00\u4e0b\uff0c\u4f17\u6240\u5468\u77e5 $\\mu \\circ 1 = \\epsilon$\uff0c\u56e0\u6b64\n\n$$\\begin{aligned}\nA(N) &= \\sum_{i=1}^N\\sum_{j=1}^N \\sum_{d \\mid i \\land d \\mid j} \\mu(d)\\sum_{p=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\sum_{q=1}^{\\lfloor\\frac{N}{j}\\rfloor}\\epsilon(\\gcd(p,q)) \\\\\n&= \\sum_{d = 1}^N \\mu(d) \\lfloor\\frac{N}{d}\\rfloor \\sum_{k = 1}^{\\lfloor\\frac{N}{d}\\rfloor}\\sum_{p=1}^{\\lfloor\\frac{N}{kd}\\rfloor}\\sum_{q=1}^{\\lfloor\\frac{N}{kd}\\rfloor}\\epsilon(\\gcd(p,q)) \n\\end{aligned}$$\n\n\u8bbe \n\n$$\\begin{aligned}\nF(x) \n&= \\sum_{k = 1}^{x}\\sum_{i = 1}^{\\lfloor\\frac{x}{k}\\rfloor} \\sum_{j = 1}^{\\lfloor\\frac{x}{k}\\rfloor} \\epsilon(\\gcd(i, j))\n\\end{aligned}$$\n\n\u5219\n\n$$\\begin{aligned}\nA(N) \n&=\\sum_{d = 1}^N \\mu(d) \\lfloor\\frac{N}{d}\\rfloor \\times F(\\lfloor\\frac{N}{d}\\rfloor)\n\\end{aligned}$$\n\n\u5f0f\u5b50\u957f\u5f97\u5f88\u597d\u770b\uff0c\u770b\u8d77\u6765\u53ea\u8981\u89e3\u51b3\u4e86 $F$ \u5c31\u4e07\u4e8b\u5927\u5409\u4e86\u3002\n\n\u8bbe \n\n$$G(x) = \\sum_{i = 1}^{x} \\sum_{j = 1}^{x}\\epsilon(\\gcd(i, j))$$\n\n\u540c\u6837\u53cd\u6f14\u4e00\u4e0b\uff0c\u5957\u8def\u7684\u5f97\u5230\n\n$$G(x) = \\sum_{d = 1}^x \\mu(d) \\lfloor\\frac{x}{d}\\rfloor^2$$\n\n\u5219 \n\n$$\\begin{aligned}\nF(x) \n&= \\sum_{k = 1}^{x} G(\\lfloor\\frac{x}{k}\\rfloor) \\\\\n&= \\sum_{k = 1}^{x} \\sum_{d = 1}^{\\lfloor\\frac{x}{k}\\rfloor} \\mu(d) \\lfloor\\frac{x}{kd}\\rfloor^2\n\\end{aligned}$$\n\n\u8bbe $T = kd$\uff0c\u628a $T$ \u63d0\u51fa\u6765\u679a\u4e3e\uff0c\u90a3\u4e48 $d$ \u5e94\u8be5\u4f5c\u4e3a $T$ \u7684\u56e0\u6570\u8fdb\u884c\u679a\u4e3e\u3002\n\n$$\\begin{aligned}\nF(x) \n&= \\sum_{T = 1}^{x} \\sum_{t \\mid T} \\mu(t) \\times \\lfloor\\frac{x}{T}\\rfloor^2\\\\\n&= \\sum_{T = 1}^{x}\\lfloor\\frac{x}{T}\\rfloor^2 \\times \\sum_{t \\mid T} \\mu(t) \\\\\n\\end{aligned}$$\n\n\u6211\u4eec\u53d1\u73b0 $\\sum_{t \\mid T} \\mu(t)$ \u5c31\u662f $\\mu \\circ 1$ \u7684\u7b2c $T$ \u9879\u3002\u800c\u4f17\u6240\u5468\u77e5 $\\mu \\circ 1 = \\epsilon$\uff0c\u56e0\u6b64\u5f53\u4e14\u4ec5\u5f53 $T = 1$ \u65f6\uff0c$\\lfloor\\frac{x}{T}\\rfloor^2$ \u5bf9\u7b54\u6848\u6709\u8d21\u732e\uff0c\u4e3a $x^2$\u3002\u56e0\u6b64\n\n$$F(x) = x^2$$\n\n\uff08\u4e5f\u7b97\u662f\u4e3a\u697c\u4e0b\u67d0\u4e2a\u6253\u8868\u627e\u89c4\u5f8b\u9898\u89e3\u8865\u4e86\u4e2a\u8bc1\u660e\u5427 233\uff09\n\n\u5e26\u56de $A(N)$\uff0c\u5f97\u5230\n\n$$\\begin{aligned}\nA(N) \n&=\\sum_{d = 1}^N \\mu(d) \\lfloor\\frac{N}{d}\\rfloor \\times F(\\lfloor\\frac{N}{d}\\rfloor)  \\\\\n&=\\sum_{d = 1}^N \\mu(d) \\lfloor\\frac{N}{d}\\rfloor \\times \\lfloor\\frac{N}{d}\\rfloor^2 \\\\\n&=\\sum_{d = 1}^N \\mu(d) \\lfloor\\frac{N}{d}\\rfloor^3\\end{aligned}$$\n\n\u6574\u9664\u5206\u5757+\u675c\u6559\u7b5b\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^{\\frac{2}{3}})$\u3002\n\n### Code\n\n```cpp\n#include <iostream>\n#include <unordered_map>\n\nconst int maxn = 10000007;\nconst int p = 998244353;\n\nint n, pcnt;\nint prm[maxn], mu[maxn];\nbool np[maxn];\n\nvoid Sieve();\nlong long S(const int x);\nlong long p3(const int x);\n\nint main() {\n  std::cin >> n;\n  Sieve();\n  long long ans = 0;\n  for (int i = 1, x, y; i <= n; i = y + 1) {\n    x = n / i; y = n / x;\n    (ans += (S(y) - S(i - 1)) * p3(x)) %= p;\n  }\n  std::cout << (ans + p) % p<< std::endl;\n}\n\nlong long p3(const int x) {\n  return 1ll * x * x % p * x % p;\n}\n\nlong long S(const int x) {\n  static std::unordered_map<int, int> rec;\n  if (x < maxn) return mu[x];\n  if (rec.count(x) != false) return rec[x];\n  long long ans = 1;\n  for (int i = 2, a, b; i <= x; i = b + 1) {\n    a = x / i; b = x / a;\n    ans -= (b - i + 1) * S(a);\n  }\n  return rec[x] = ans % p;\n}\n\nvoid Sieve() {\n  mu[1] = 1;\n  for (int i = 2; i < maxn; ++i) {\n    if (np[i] == false) {\n      mu[i] = -1;\n      prm[++pcnt] = i;\n    }\n    for (int j = 1, u = prm[j], v = i * u; j <= pcnt; v = i * (u = prm[++j])) if (v < maxn) {\n      np[v] = true;\n      if ((i % u) == 0) break;\n      mu[v] = -mu[i];\n    } else {\n      break;\n    }\n    mu[i] += mu[i - 1];\n  }\n}\n```\n\n",
        "postTime": 1589472712,
        "uid": 65363,
        "name": "\u4e00\u6276\u82cf\u4e00",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6055 \u3010[RC-02] GCD\u3011"
    },
    {
        "content": "\u6ca1\u5565\u597d\u8bf4\u7684\uff0c\u5c31\u662f\u975e\u5e38\u5957\u8def\u7684\u6839\u636e\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u63a8\u5f0f\u5b50\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/837s7veq.png)\n\n\u6700\u540e\u8fd9\u4e2a\u662f\u4e2a\u5957\u8def\u7684\u6574\u9664\u5206\u5757+\u675c\u6559\u7b5b\u7ef4\u62a4 $\\mu$ \u7684\u524d\u7f00\u548c\uff0c\u7136\u540e\u7ed3\u675f\u4e86\u3002\n\n\u6574\u4e2a\u9898\u5c31\u5f88\u5957\u8def\uff0c\u636e\u8bf4\u8fd8\u6709 OEIS \u505a\u6cd5\uff0c\u6ca1\u4e86\u89e3\u8fc7\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long \nusing namespace std;\nconst int MAXN=5000010,DSQRT=50010,P=998244353;\nint n,tot,ans,mu[MAXN],q[MAXN],smu[MAXN],p[MAXN];\nmap <int,int> u;\nvoid init () {\n    mu[1]=smu[1]=1;\n    for (int i=2;i<=MAXN-10;i++) {\n        if (!q[i]) {p[++tot]=i,mu[i]=-1;}\n        for (int j=1;j<=tot&&i*p[j]<=MAXN-10;j++) {\n            if (i%p[j]==0) {\n                q[i*p[j]]=1,mu[i*p[j]]=0;\n                break;\n            }\n            q[i*p[j]]=1,mu[i*p[j]]=-mu[i];\n        }\n        smu[i]=smu[i-1]+mu[i];\n    }\n    return;\n}\nint sm (int x) {\n    if (x<=MAXN-10) {return smu[x];}\n    if (u[x]) {return u[x];}\n    int ans=1;\n    for (int l=2,r;l<=x;l=r+1) {\n        r=x/(x/l);\n        ans-=sm(x/l)*(r-l+1);\n    }\n    return u[x]=ans;\n}\nint main () {\n    init();\n    scanf(\"%d\",&n);\n    for (int l=1,r;l<=n;l=r+1) {\n    \tr=n/(n/l);\n    \tint tmp=(1ll*(n/l)*((1ll*(n/l)*(n/l))%P))%P;\n    \tans=(ans+(1ll*tmp*(sm(r)-sm(l-1)+P))%P)%P;\n\t}\n\tprintf(\"%d\\n\",ans);\n    return 0;\n}\n```\n",
        "postTime": 1580905479,
        "uid": 113546,
        "name": "ix35",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P6070 \u3010[RC-02] GCD\u3011"
    },
    {
        "content": " \n~~\u5f0f\u5b50\u662f\u5728\u6570\u5b66\u8bfe\u4e0a\u63a8\u7684\uff0c\u5e78\u597d\u6ca1\u88ab\u8001\u5e08\u53d1\u73b0\u3002~~\n\n### \u9898\u610f\n\n- \u6c42 $ \\sum\\limits_{i=1}^{N}\\sum\\limits_{j=1}^{N}\\sum\\limits_{p=1}^{\\lfloor \\frac{N}{j} \\rfloor} \\sum\\limits_{q=1}^{\\lfloor \\frac{N}{j} \\rfloor} [\\gcd(i,j)=1][\\gcd(p,q)=1]$\n\n- \u7b54\u6848\u5bf9 $998\\ 244\\ 353$ \u53d6\u6a21\n\n-  $1 \\le N \\le 2 \\times10^9$\n\n\n### ~~\u6109\u5feb\u5730~~\u63a8\u5f0f\u5b50\u73af\u8282\n\n\u9996\u5148\u89c2\u5bdf\u539f\u5f0f\u7684\u8fd9\u4e00\u90e8\u5206\uff1a\n$$\\sum\\limits_{j=1}^{N}\\sum\\limits_{p=1}^{\\lfloor \\frac{N}{j} \\rfloor} \\sum\\limits_{q=1}^{\\lfloor \\frac{N}{j} \\rfloor} [\\gcd(p,q)=1]$$\n\n\u4e0d\u96be\u53d1\u73b0\u4e0a\u5f0f\u7b49\u4ef7\u4e8e\uff1a\n$$\\sum\\limits_{j=1}^{N}\\sum\\limits_{p=1}^{N} \\sum\\limits_{q=1}^{N} [\\gcd(p,q)=j]$$\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u53ea\u6709\u5f53 $\\gcd(p,q)=j$ \u65f6\uff0c\u624d\u5bf9\u7b54\u6848\u6709\u8d21\u732e\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u7701\u53bb\u679a\u4e3e $j$ \uff0c\u5e76\u4e14\u628a $j$ \u7528 $ \\gcd(p,q) $ \u66ff\u6362\u6389\uff0c\u5f97\u5230\uff1a\n$$\\sum\\limits_{i=1}^{N}\\sum\\limits_{p=1}^{N} \\sum\\limits_{q=1}^{N} [\\gcd(i,\\gcd(p,q))=1]$$\n\n\u6839\u636e $\\gcd$ \u7684\u6027\u8d28\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n$$\\sum\\limits_{i=1}^{N}\\sum\\limits_{p=1}^{N} \\sum\\limits_{q=1}^{N} [\\gcd(i,p,q)=1]$$\n\n\u63a5\u4e0b\u6765\u5c31\u90fd\u662f\u5957\u8def\u4e86\u3002\u6839\u636e $\\mu$ \u7684\u57fa\u672c\u6027\u8d28\uff0c\u53ef\u4ee5\u5c06\u539f\u5f0f\u5316\u4e3a\uff1a\n\n$$ \\sum\\limits_{i=1}^{N}\\sum\\limits_{p=1}^{N} \\sum\\limits_{q=1}^{N} \\sum\\limits_{d|gcd(i,p,q)} \\mu(d)$$\n\n\u679a\u4e3e $d$ \uff0c\u5219\u6709\uff1a\n\n$$ \\sum\\limits_{d=1}^{N}\\sum\\limits_{i=1}^{\\lfloor \\frac{N}{d} \\rfloor}\\sum\\limits_{p=1}^{\\lfloor \\frac{N}{d} \\rfloor} \\sum\\limits_{q=1}^{\\lfloor \\frac{N}{d} \\rfloor}  \\mu(d)$$\n\n\u5373\uff1a\n\n$$ \\sum\\limits_{d=1}^{N}\\mu(d) \\lfloor {\\dfrac{N}{d}  \\rfloor}^{3}$$\n\n\u7136\u540e\u53d1\u73b0\u6570\u636e\u8303\u56f4\u4e0d\u5141\u8bb8\u7ebf\u7b5b\uff0c\u6839\u636e $\\mu*I=\\epsilon$ \uff08 $*$ \u662f\u72c4\u5229\u514b\u96f7\u5377\u79ef\uff09\uff0c\u675c\u6559\u7b5b\u6c42 $\\mu$ \u7684\u524d\u7f00\u548c\u5c31\u597d\u4e86\u3002\n\n\u6ce8\u610f\u53d6\u6a21\u3002\n\n\n### Code\n\n``` cpp\n#include <cstdio>\n#include <iostream>\n#include <cmath>\n#include <tr1/unordered_map>\n\nusing namespace std;\n\ntypedef long long ll;\nconst int MAXN = 6000010;\nconst int MOD = 998244353;\n\ninline int add(int x, int y){return (x+=y)>=MOD?x-MOD:x;}\ninline int sub(int x, int y){return (x-=y)<0?x+MOD:x;}\ninline int mul(int x, int y){return 1ll*x*y%MOD;}\n\nint pr[MAXN], mu[MAXN], cnt = 0;\nbool vis[MAXN];\n\ninline void muda(int n)\n{\n\tmu[1] = 1;\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tif(!vis[i])\n\t\t{\n\t\t\tpr[++cnt] = i;\n\t\t\tmu[i] = -1;\n\t\t}\n\t\tfor(int j=1;j<=cnt&&i*pr[j]<=n;j++)\n\t\t{\n\t\t\tvis[i*pr[j]] = 1;\n\t\t\tif(i%pr[j] == 0) \n\t\t\t{\n\t\t\t\tmu[i*pr[j]] = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmu[i*pr[j]] = -mu[i];\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tmu[i] = add(mu[i], mu[i-1]);\n}\n\ntr1::unordered_map<int,int> summu;\n\ninline int sumMu(int n)\n{\n\tif(n <= 6000000) return mu[n];\n\tif(summu[n]) return summu[n];\n\tint res = 1;\n\tfor(int l=2,r;l<=n;l=r+1)\n\t{\n\t\tr = n/(n/l);\n\t\tres = sub(res, mul(sub(r%MOD, l%MOD)+1, sumMu(n/l)));\n\t}\n\treturn summu[n] = res;\n}\n\ninline int calc(int n)\n{\n\tint res = 0;\n\tfor(int l=1,r;l<=n;l=r+1)\n\t{\n\t\tr = n/(n/l);\n\t\tres = add(res, mul(mul(n/l, n/l), mul(n/l, sub(sumMu(r), sumMu(l-1)))));\n\t}\n\treturn res;\n}\n\nint main()\n{\n\tmuda(6000000); \n\tint n;\n\tscanf(\"%d\",&n);\n\tprintf(\"%d\\n\",calc(n));\n\treturn 0;\n}\n```\n",
        "postTime": 1589296883,
        "uid": 151601,
        "name": "Aphros",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6055 \u3010[RC-02] GCD\u3011"
    },
    {
        "content": "**Weblink**\n\n[https://www.luogu.com.cn/problem/P6055](https://www.luogu.com.cn/problem/P6055)\n\n\n\n**Problem**\n\n\n\n\u7ed9\u51fa $N$\uff0c\u6c42\uff1a\n\n$$\n\\sum_{i=1}^{N} \\sum_{j=1}^{N} \\sum_{p=1}^{\\left\\lfloor\\frac{N}{\\jmath}\\right\\rfloor} \\sum_{q=1}^{\\left\\lfloor\\frac{N}{j}\\right\\rfloor}[\\operatorname{gcd}(i, j)=1][\\operatorname{gcd}(p, q)=1]\n$$\n\n\u7b54\u6848\u6a21 $998244353$\u3002\n\n\n**Solution**\n\n\n\n\u8fd9\u9898\u771f\u662f\u4e50\u6b7b\u6211\u4e86\uff0c\u771f\u5c31\u56fe\u4e00\u4e50\u5457\n\n\u4e0a\u6765\u600e\u4e48\u770b\u8fd9\u4e2a $j$ \u600e\u4e48\u4e0d\u987a\u773c\uff0c\u8fd9\u4e0d\u5148\u628a $j$ \u76f4\u63a5\u4e22\u56de\u53bb \uff1f\uff1f\uff1f\n\n\u7136\u540e\u8fd9\u9898\u5c31\u6ca1\u4e86...\n\n\u968f\u4fbf\u53cd\u6f14\u4e00\u4e0b\uff0c\u675c\u6559\u7b5b\u968f\u4fbf\u641e\u641e\u5c31\u5b8c\u4e8b\u4e86\n\n$$\n\\begin{aligned}\n&\\ \\ \\ \\ \\ \\sum_{i=1}^N\\sum_{j=1}^N\\sum_{p=1}^{\\left\\lfloor\\frac N j\\right\\rfloor}\\sum_{q=1}^{\\left\\lfloor\\frac N j\\right\\rfloor}[\\gcd(i, j)=1][\\gcd(p, q)=1]&\\\\&\n=\\sum_{i=1}^N\\sum_{j=1}^N\\sum_{p=1}^{N}\\sum_{q=1}^{N}[\\gcd(i, j)=1][\\gcd(p, q)=j]&\\\\&\n=\\sum_{i=1}^N\\sum_{p=1}^{N}\\sum_{q=1}^{N}[\\gcd(i, p,q)=1]&\\\\&\n=\\sum_{i=1}^N\\sum_{p=1}^{N}\\sum_{q=1}^{N}\\sum_{d\\mid \\gcd(i,p,q)}\\mu(d)&\\\\&\n=\\sum_{d=1}^N\\sum_{i=1}^N\\sum_{p=1}^{N}\\sum_{q=1}^{N}[d\\mid i][d\\mid p][d\\mid q]\\mu(d)&\\\\&\n=\\sum_{d=1}^N\\sum_{i=1}^{\\left\\lfloor\\frac N d\\right\\rfloor }\\sum_{p=1}^{\\left\\lfloor\\frac N d\\right\\rfloor }\\sum_{q=1}^{\\left\\lfloor\\frac N d\\right\\rfloor}\\mu(d)&\\\\&\n=\\sum_{d=1}^N\\mu(d)\\left\\lfloor\\frac N d\\right\\rfloor^3\n\\end{aligned}\n$$\n\n\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^{\\frac 2 3})$\u3002\n\n20\u5206\u949f\u6c34\u4e00\u9053\u7d2b\u9898 \\^q\\^ \n\n\n\n**Code**\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nconst int maxn = 2e6 + 7, mod = 998244353;\n\nll n, m, s, t;\nll ans;\nint primes[maxn], cnt;\nbool vis[maxn];\nll mu[maxn];\nunordered_map <ll, ll> sum_mu;\n\nvoid prework(int n)\n{\n\tmu[1] = 1;\n\tfor (int i = 2; i <= n; ++ i) {\n\t\tif(vis[i] == 0) {\n\t\t\tprimes[ ++ cnt] = i;\n\t\t\tmu[i] = -1;\n\t\t}\n\t\tfor (int j = 1; j <= cnt && i * primes[j] <= n; ++ j) {\n\t\t\tvis[i * primes[j]] = 1;\n\t\t\tif(i % primes[j] == 0) \n\t\t\t\tbreak;\n\t\t\tmu[i * primes[j]] -= mu[i];\n\t\t}\n\t}\n\tfor (int i = 1; i <= n; ++ i) {\n\t\tmu[i] += mu[i - 1];\n\t}\n}\n\nint g_sum(int x)\n{\n\treturn x;\n}\n\ninline int get_sum_mu(int x)\n{\n\tif(x <= maxn - 10) return mu[x];\n\tif(sum_mu.find(x) != sum_mu.end()) return sum_mu[x];\n\tll ans = 1;\n\tfor (ll l = 2, r; l <= x; l = r + 1) {\n\t\tr = x / (x / l);\n\t\tans -= (g_sum(r) - g_sum(l - 1)) * get_sum_mu(x / l);\n\t}\n\treturn sum_mu[x] = ans / g_sum(1);\n}\n\nint main()\n{\n//\tint ^q^; \n\tprework(maxn - 7);\n\tt = 1;\n\twhile(t -- ) {\n\t\tans = 0;\n\t\tscanf(\"%lld\", &n);\n\t\tfor (ll l = 1, r = 0; l <= n; l = r + 1) {\n\t\t\tr = n / (n / l);\n\t\t\tll _ = (n / l) * (n / l) % mod * (n / l) % mod; \n\t\t\tans = (ans + (get_sum_mu(r) - get_sum_mu(l - 1) + mod) % mod * _ % mod) % mod;\n\t\t}\n\t\tprintf(\"%lld\\n\", ans);\n\t}\n\treturn 0;\n}\n```\n\n\n ",
        "postTime": 1631887567,
        "uid": 262605,
        "name": "fanfansann",
        "ccfLevel": 0,
        "title": "Luogu P6055 [RC-02] GCD\uff08\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff09\uff08\u8fd9\u9898\u4e50\u6b7b\u6211\u4e86\uff0c\u771f\u5c31\u56fe\u4e00\u4e50\u5457\uff09"
    },
    {
        "content": "\u8fd9\u9053\u9898\u7684\u53cd\u63a8\u8fd8\u662f\u633a\u6709\u610f\u601d\u7684\u3002\n\n$$\\sum_{i=1}^n\\sum_{j=1}^n\\sum_{p=1}^{\\lfloor \\frac{n}{j} \\rfloor}\\sum_{q=1}^{\\lfloor \\frac{n}{j} \\rfloor}[(i,j)=1][(p,q)=1]$$\n\n$$\\sum_{i=1}^n\\sum_{j=1}^n\\sum_{p=1}^{n}\\sum_{q=1}^{n}[(i,j)=1][(p,q)=j]$$\n\n\n$$\\sum_{i=1}^n\\sum_{p=1}^{n}\\sum_{q=1}^{n}[(i,p,q)=1]$$\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u6b63\u5e38\u5316\u7b80\u4e86\u3002\n\n$$\\sum_{i=1}^n\\sum_{p=1}^{n}\\sum_{q=1}^{n}[(i,p,q)=1]$$\n\n$$\\sum_{d=1}^n \\mu(d) \\lfloor \\frac{n}{d} \\rfloor ^3$$\n\n\u6574\u9664\u5206\u5757+\u675c\u6559\u7b5b\u5373\u53ef\u3002\n\n```cpp\n#include <map>\n#include <cstdio>\nusing namespace std;\n\nconst int MAXN = 2e6 , Mod = 998244353;\n\nint prn , prime[ MAXN + 5 ] , mu[ MAXN + 5 ] , f[ MAXN + 5 ]; \nbool vis[ MAXN + 5 ];\nvoid sieve( ) {\n\tmu[ 1 ] = 1;\n\tfor( int i = 2 ; i <= MAXN ; i ++ ) {\n\t\tif( !vis[ i ] ) prime[ ++ prn ] = i , mu[ i ] = -1;\n\t\tfor( int j = 1 ; j <= prn && 1ll * i * prime[ j ] <= MAXN ; j ++ ) {\n\t\t\tvis[ i * prime[ j ] ] = 1;\n\t\t\tif( i % prime[ j ] == 0 ) break;\n\t\t\tmu[ i * prime[ j ] ] = -mu[ i ];\n\t\t}\n\t}\n\tfor( int i = 1 ; i <= MAXN ; i ++ ) f[ i ] = f[ i - 1 ] + mu[ i ];\n}\n\nmap< int , int > Smu;\nint Summu( int n ) {\n    if( n <= MAXN ) return f[ n ];\n    if( Smu[ n ] ) return Smu[ n ];\n\n    int Ans = 1;\n    for( int l = 2 , r ; l <= n ; l = r + 1 ) {\n        r = n / ( n / l );\n        Ans -= ( r - l + 1 ) * Summu( n / l );\n    }\n    return Smu[ n ] = Ans;\n}\n\nint Solve( int n ) {\n    int Ans = 0;\n    for( int l = 1 , r ; l <= n ; l = r + 1 ) {\n        r = n / ( n / l );\n        Ans = ( Ans + 1ll * ( ( Summu( r ) - Summu( l - 1 ) ) % Mod + Mod ) % Mod * ( n / l ) % Mod * ( n / l ) % Mod * ( n / l ) % Mod ) % Mod;\n    }\n    return Ans;\n}\n\nint n;\nint main( ) {\n\tsieve( );\n    scanf(\"%d\",&n);\n    printf(\"%d\\n\", Solve( n ) );\n\treturn 0;\n}\n```\n",
        "postTime": 1595936031,
        "uid": 123802,
        "name": "chihik",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6055 \u3010[RC-02] GCD\u3011"
    },
    {
        "content": "\u9996\u5148\u8003\u8651$p,q$\u7684\u90a3\u90e8\u5206$\\sum_p\\sum_q[(p,q)=1]$\n\n$$F(n)=\\sum_{i=1}^n\\sum_{j=1}^n[(i,j)=1]$$\n$$\\sum_{d=1}^n\\mu(d)(\\lfloor\\frac{n}{d}\\rfloor)^2$$\n$$-1+2\\sum_{i=1}^n \\varphi(i)$$\n\n\n\u7b2c\u4e8c\u4e2a\u7684\u8bdd,\u8003\u8651$(i,j)=(j,i)$,\u5176\u4e2d$(i,i)$\u53ea\u6709$i=1$\u65f6\u6709\u8d21\u732e,\u591a\u7b97\u4e86\u4e00\u6b21$-1$\u53bb\u6389\u5b83,btw,\u8fd9\u4e2a\u4e1c\u897f\u66fe\u7ecf\u51fa\u73b0\u5728SDOI\u7684\u4e00\u4e2a\u7ecf\u5178\u6570\u8bba\u9898\u91cc\u9762.\n\n-------\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0$i,j$\u662f\u5bf9\u7b49\u7684,\u4e2a\u4eba\u4e60\u60ef\u628a$F(\\lfloor\\frac{n}{j}\\rfloor)$\u6362\u6210$i$.\u7136\u540e\u5e26\u7740\u5b83\u505a\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14(\u5c31\u662f\u7528$\\sum_{d\\mid n}\\mu(d)=[n=1]$\u76f4\u63a5\u5e26\u5165,\u7136\u540e\u6362\u6c42\u548c\u987a\u5e8fqwq).\n\n$$\\sum_{i=1}^n\\sum_{j=1}^n[(i,j)=1]F(\\lfloor\\frac{n}{i}\\rfloor)$$\n$$\\sum_{d=1}^n\\mu(d)\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}F(\\lfloor\\frac{n}{id}\\rfloor)\\lfloor\\frac{n}{d}\\rfloor$$\n$$\\sum_{d=1}^n\\mu(d)\\lfloor\\frac{n}{d}\\rfloor\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}F(\\lfloor\\frac{n}{id}\\rfloor)$$\n\n\u6211\u4eec\u53d1\u73b0\u4e00\u4e2a\u53ef\u4ee5\u5206\u5757\u5957\u5206\u5757\u7684\u7f8e\u597d\u7ed3\u6784,\u8003\u8651\u4e00\u4e0b\u7528\u90a3\u79cd\u65b9\u5f0f\u6765\u7b97$F$.  \n\u7528$\\varphi$\u524d\u7f00\u548c\u7684\u8bdd,\u663e\u7136\u7528\u5230\u7684\u503c\u90fd\u662f$\\lfloor\\frac{n}{d}\\rfloor$\u7684\u5f62\u5f0f,\u7528\u5377\u79ef\u6784\u9020\u9012\u63a8\u5f0f,\u8bb0\u5fc6\u5316\u641c\u7d22\u53ef\u4ee5$O(n^\\frac34)$\u628a\u5b83\u4eec\u90fd\u6c42\u51fa\u6765(\u8fd9\u4e2a\u6280\u5de7\u4e5f\u53eb\u675c\u6559\u7b5b).\u5177\u4f53\u800c\u8a00\u662f$\\varphi *1=id$\u8fd9\u6837\u505a\u5206\u5f00\u8003\u8651\u590d\u6742\u5ea6\u8d21\u732e,\u662f$O(n^\\frac34)$\u7684,\u8bb0\u5fc6\u5316\u7684\u8bdd\u6709\u5c0f\u6280\u5de7$sum(x)$\u653e\u5728$\\begin{cases}A(x)&(x\\lt \\sqrt n)\\\\B(n/x)&(x\\geq \\sqrt n)\\end{cases}$\u4e0d\u4f1a\u4ea7\u751f\u51b2\u7a81,\u6216\u8005\u4f7f\u7528std::unordered_map\u8fd9\u4e2ahash\u8868\u4e0d\u5f00c++11\u7684\u8bdd\u5b83\u5728header:tr1/unordered_map\u4e2d,std::tr1 namespace\u4e4b\u4e0b.  \n\n\u7528\u66f4\u52a0\u901a\u7528\u7684\u53cd\u6f14\u6c42$F$\u7684\u8bdd,\u9700\u8981\u518d\u5957\u4e00\u5c42\u5206\u5757.\u590d\u6742\u5ea6\u53ef\u4ee5\u8fd9\u4e48\u4f30\u8ba1$\\int_1^{\\sqrt n}(x^{\\frac34}+(\\frac{n}{x})^\\frac34)dx$\u663e\u7136\u662f\u6bd4\u524d\u4e00\u79cd\u505a\u6cd5\u66f4\u6162\u7684...\u5982\u679c\u6015\u5e38\u6570\u95ee\u9898\u7684\u8bdd,\u4e24\u79cd\u90fd\u5199\u51fa\u6765\u672c\u673a\u6d4b\u901f\u4e00\u4e0b\u4e5f\u53ef\u4ee5.  \n\n\n-----\n\n\n$n\\leq 2e9$\u7684\u8bdd$O(n^\\frac34)$\u5e94\u8be5\u662f\u79bb\u6b63\u89e3\u4e0d\u8fdc\u4e86,\u53ea\u5dee\u6700\u540e\u4e00\u6b65\u4f18\u5316\u4e86qwq.  \u5f53\u7136\u4e5f\u53ef\u80fd\u662f\u51fa\u9898\u4eba\u826f\u5fc3\u7ed9\u4e86\u4f20\u7edf\u5957\u8def90pts\u800cstd\u548c\u8fd9\u4e2a\u505a\u6cd5\u6ca1\u5173\u7cfb23333.  \n\n\u91cd\u65b0\u5ba1\u89c6\u5206\u5757\u5957\u5206\u5757\u7684\u5f0f\u5b50\n$$\\sum_{d=1}^n\\mu(d)\\lfloor\\frac{n}{d}\\rfloor\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}F(\\lfloor\\frac{n}{id}\\rfloor)$$\n\n\u5c31\u662f\u540e\u9762\u90a3\u4e2a$\\sum F(n/id)$,\u8fd9\u4e1c\u897f\u5e94\u8be5\u662f\u552f\u4e00\u80fd\u4f18\u5316\u7684\u4e86\u5427?\u5c55\u5f00\u5b83?\u4e0d\u5b58\u5728\u7684.  \n\n\n\u6211\u4eec\u6b64\u65f6\u5e94\u8be5\u6c42\u52a9\u4e8eOI\u5e38\u89c1\u6280\u5de7:\u6253\u8868\u627e\u89c4\u5f8b!.\u8fd9\u91cc\u628a\u53d6\u6a21\u5220\u6389,\u88f8\u8dd1$n\\leq 100$\u7684\u60c5\u51b5,\u6253\u51fa$g(n)=\\sum F(n/i)$.\u7136\u540e\u60ca\u5947\u7684\u53d1\u73b0,$g(n)=n^2$.  \n\n$$\\sum_{d=1}^n\\mu(d)(\\lfloor\\frac{n}{d}\\rfloor)^3$$  \n\n\u7136\u540e\u53d1\u73b0\u5b83\u4ecd\u7136$O(n^\\frac34)$\u6211\u4eec1pts\u90fd\u8eb2\u4e0d\u4e86.\n\n----\n\n\u8fd9\u6837\u590d\u6742\u5ea6\u74f6\u9888\u5728\u4e8e\u6c42$\\mu$\u7684\u524d\u7f00\u548c\u4e86,\u7ed9\u675c\u6559\u7b5b\u4e5f\u52a0\u4e0a\u6253\u8868~~\u627e\u89c4\u5f8b~~,\u9884\u5904\u7406\u524d$S$\u9879(\u7ebf\u6027\u7b5b\u6cd5)\u663e\u7136$S\\gt \\sqrt n$\u624d\u4f1a\u6709\u7528,\u675c\u6559\u7b5b\u7684\u590d\u6742\u5ea6\u662f\n\n$$\n\\int_1^{\\sqrt n} (\\sqrt x+\\sqrt{\\frac{n}{x}})dx\n$$\n\u8fd9\u91cc\u540e\u4e00\u90e8\u5206\u662f\u5927\u4e8e\u524d\u4e00\u90e8\u5206\u7684,\u5982\u679c$S\\lt \\sqrt n$\u7684\u8bdd,\u540e\u4e00\u90e8\u5206\u662f\u4e0d\u53d8\u7684,\u590d\u6742\u5ea6\u6ca1\u6cd5\u4f18\u5316.  \n\n$$\nS+\\int_1^{n/S} (\\sqrt{\\frac{n}{x}})dx\n$$\n\u628a\u540e\u9762\u7684\u79ef\u5206\u51fa\u6765,\u5747\u503c\u4e0d\u7b49\u5f0f\u4e00\u4e0b,\u53d1\u73b0$S=n^\\frac23$\u662f\u6700\u4f18\u7684$O(n^\\frac23)$,\u5f53\u7136\u5b9e\u9645\u4e0a\u7531\u4e8e\u7ebf\u6027\u7b5b\u548c\u9012\u5f52\u8bb0\u5fc6\u5316\u641c\u7d22\u7684\u5e38\u6570\u4e0d\u4e00\u6837\u5927,\u6211\u4eec\u9700\u8981\u672c\u673a\u5b9e\u5730\u6d4b\u8bd5\u4e00\u4e0b$S$\u591a\u5927\u6700\u4f18\u79c0.  \n\n\n-----\n\n\u73b0\u5728\u6c42$\\sum \\mu$\u5728$n/1,n/2,n/3\\dots n/n$\u5904\u53d6\u503c\u53d8\u6210$O(n^\\frac23)$\u4e86,\u5206\u5757\u90e8\u5206\u6bcf\u6b21\u662f$O(1)$\u7684,\u603b\u590d\u6742\u5ea6\u662f$O(n^\\frac23)$\u5c31\u53ef\u4ee5\u8fc7\u4e86qwq.  \n\n\n\n\n\n\n-----\n\nupd\u4e00\u4e0b,\u6ca1\u653e\u4ee3\u7801qwq...\u5bf9\u4e8e\u6c42$F$\u7684\u4e24\u79cd\u5b9e\u73b0\u90fd\u6ca1\u6709\u5220\u6389,\u5206\u522b\u662fInt F1(int n)\u548cInt F2(int n);\n```cpp\n#include <bits/stdc++.h>\ntypedef long long Int;\ntypedef std::unordered_map<int,Int> Map;\nconst Int mod=998244353LL;\nconst int N=2000000+10;\ninline Int fix(Int x){ return (x%mod+mod)%mod; }\nint vis[N],prime[N],cnt,phi[N],mu[N];\nvoid init(){\n\tvis[1]=1; mu[1]=phi[1]=1;\n\tfor(int i=2;i<N;i++){\n\t\tif(!vis[i]){\n\t\t\tprime[cnt++]=i;\n\t\t\tphi[i]=i-1; mu[i]=-1;\n\t\t}\n\t\tfor(int j=0;j<cnt&&i*prime[j]<N;j++){\n\t\t\tint v=i*prime[j]; vis[v]=1;\n\t\t\tif(i%prime[j]==0){\n\t\t\t\tphi[v]=phi[i]*prime[j];\n\t\t\t\tmu[v]=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tphi[v]=phi[i]*(prime[j]-1);\n\t\t\tmu[v]=mu[i]*(-1);\n\t\t}\n\t}\n\tfor(int i=2;i<N;i++){\n\t\tphi[i]=(phi[i-1]+phi[i])%mod;\n\t\tmu[i]=(mu[i-1]+mu[i]+mod)%mod;\n\t}\n}\n\nMap tmu;\nInt smu(int n){\n\tif(n<N) return mu[n];\n\tif(tmu.count(n)) return tmu[n];\n\tInt s=1; int l=2,r,q;\n\twhile(l<=n){\n\t\tq=n/l; r=n/q;\n\t\ts=fix(s-(r-l+1)*smu(q)%mod);\n\t\tl=r+1;\n\t}\n\treturn tmu[n]=s;\n}\nMap tphi;\nInt sphi(int n){\n\tif(n<N) return phi[n];\n\tif(tphi.count(n)) return tphi[n];\n\tInt s=(1LL*n*(n+1)/2)%mod; int l=2,r,q;\n\twhile(l<=n){\n\t\tq=n/l; r=n/q;\n\t\ts=fix(s-(r-l+1)*sphi(q)%mod);\n\t\tl=r+1;\n\t}\n\treturn tphi[n]=s;\n}\n\nMap tf1;\nInt F1(int n){\n\tif(tf1.count(n)) return tf1[n];\n\treturn tf1[n]=(2*sphi(n)-1+mod)%mod;\n}\nMap tf2;\nInt F2(int n){\n\tif(tf2.count(n)) return tf2[n];\n\tInt s=0; int l=1,r,q;\n\twhile(l<=n){\n\t\tq=n/l; r=n/q;\n\t\ts=(s+1LL*q*q%mod*fix(smu(r)-smu(l-1))%mod)%mod;\n\t\tl=r+1;\n\t}\n\treturn tf2[n]=s;\n}\nInt sf(int n){\n\treturn 1LL*n*n%mod;\n\tInt s=0; int l=1,r,q;\n\twhile(l<=n){\n\t\tq=n/l; r=n/q;\n\t\ts=(s+1LL*(r-l+1)*F1(q)%mod)%mod;\n\t\tl=r+1;\n\t}\n\treturn s;\n}\n\nint main(){\n\tinit();\n\tint n;std::cin>>n;\n\tInt s=0; int l=1,r,q;\n\twhile(l<=n){\n\t\tq=n/l; r=n/q;\n\t\ts=(s+fix(smu(r)-smu(l-1))*q%mod*sf(q)%mod)%mod;\n\t\tl=r+1;\n\t}\n\tstd::cout<<s<<std::endl;\n\treturn 0;\n}\n```\n",
        "postTime": 1580905831,
        "uid": 15295,
        "name": "hehelego",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6070 \u3010[RC-02] GCD\u3011"
    },
    {
        "content": "\u5c06\u540e\u4e24\u4e2a $\\sum$ \u4e58 $j$\uff0c\u5f97\n$$\\sum_{i=1}^{N}\\sum_{j=1}^{N}\\sum_{p=1}^{N}\\sum_{q=1}^{N}[\\gcd(i,j)=1][\\gcd(p,q)=j]$$\n\n\u53d1\u73b0 $j$ \u76f8\u5f53\u4e8e\u5728\u679a\u4e3e $\\gcd(p,q)$\uff0c\u90a3\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u5b83\u641e\u6389\n$$\\sum_{i=1}^{N}\\sum_{p=1}^{N}\\sum_{q=1}^{N}[\\gcd(i,\\gcd(p,q))=1]$$\n\n\uff08\u5176\u5b9e\u8fd9\u4e24\u6b65\u76f8\u5f53\u4e8e\u628a\u83ab\u53cd\u5957\u8def\u53cd\u8fc7\u6765\u4e86\uff09\n\n\u4e4b\u540e\u5c31\u5f88\u7b80\u5355\u4e86\uff0c\u90fd\u662f\u5957\u8def\uff0c\u7b80\u5355\u5199\u4e86\n\n$$\\sum_{i=1}^{N}\\sum_{p=1}^{N}\\sum_{q=1}^{N}[\\gcd(i,p,q)=1]$$\n$$\\sum_{i=1}^{N}\\sum_{p=1}^{N}\\sum_{q=1}^{N}\\sum_{d|i,d|p,d|q}\\mu(d)$$\n$$\\sum_{d=1}^{N}\\mu(d)\\lfloor\\frac{N}{d}\\rfloor^{3}$$\n\n\u76f4\u63a5\u6574\u9664\u5206\u5757+\u675c\u6559\u7b5b\u5373\u53ef\n\n$\\rm{Code}:$\n\n```cpp\n#include <iostream>\n#include <tr1/unordered_map>\ntypedef std::tr1::unordered_map<int, int>::iterator Iter;\nconst int MAXN = 1587401, lnMAXN = 10, MOD = 998244353;\n//MAXN\u4e3a\u7ebf\u7b5b\u7684\u8303\u56f4\uff0c\u4e5f\u5c31\u662fn^{2/3}\uff0c\u8003\u8651\u7ebf\u7b5b\u4e0e\u675c\u6559\u7b5b\u7684\u5e38\u6570\u5dee\u5f02\u4e5f\u53ef\u4ee5\u7a0d\u7a0d\u52a0\u5927 \nint Prime[MAXN/lnMAXN], size; \nint mu[MAXN + 5];\nbool not_prime[MAXN + 5];\nstd::tr1::unordered_map<int, int> ans_mu; // \u675c\u6559\u7b5b\u7684mu \n\nvoid sieve(int n) {\n\tnot_prime[1] = true;\n\tmu[1] = 1;\n\t// \u8fb9\u754c \n\tfor(int i = 2; i <= n; ++i) {\n\t\tif(not_prime[i] == false) {\n\t\t\tPrime[size++] = i; // \u52a0\u5165\u8d28\u6570\u8868 \n\t\t\tmu[i] = MOD - 1; //-1\u5728mod MOD\u610f\u4e49\u4e0b\u4e3aMOD-1 \n\t\t}\n\t\tfor(int j = 0; j < size && i*Prime[j] <= n; ++j) {\n\t\t\tnot_prime[i*Prime[j]] = true;\n\t\t\tif(i%Prime[j] == 0)\n\t\t\t\tbreak;\n\t\t\tmu[i*Prime[j]] = MOD - mu[i];\n\t\t}\n\t}\n\tfor(int i = 2; i <= n; ++i)\n\t\tmu[i] = (mu[i] + mu[i - 1])%MOD; //\u641e\u524d\u7f00\u548c \n}\n\nint get_mu(int n) {\n\tif(n <= MAXN) // \u7ebf\u6027\u7b5b\u7b5b\u8fc7 \n\t\treturn mu[n];\n\tIter it = ans_mu.find(n);\n\tif(it != ans_mu.end()) // \u675c\u6559\u7b5b\u7b5b\u8fc7 \n\t\treturn it->second;\n\tint res = 1;\n\tfor(int i = 2, ni; i <= n; i = ni + 1) {\n\t\tni = n/(n/i);\n\t\tres = (res - 1LL*(ni - i + 1)*get_mu(n/i)%MOD)%MOD;\n\t\t//\u6ce8\u610f\u4f55\u65f6\u4e581LL \n\t}\n\treturn ans_mu[n] = (res < 0 ? res + MOD : res); // \u5224\u65ad\u662f\u5426\u4e3a\u8d1f\u6570 \n}\n\ninline int cube(int x)\n{ return 1LL*x*x%MOD*x%MOD; } // \u8ba1\u7b97x^3 \n\nint solve(int n) {\n\tint res = 0;\n\tfor(int i = 1, ni; i <= n; i = ni + 1) {\n\t\tni = n/(n/i);\n\t\tres = (1LL*res + 1LL*(get_mu(ni) - get_mu(i - 1))%MOD*cube(n/i%MOD)%MOD)%MOD;\n\t\t//\u6ce8\u610f\u4f55\u65f6\u4e581LL \n\t}\n\treturn res < 0 ? res + MOD : res; // \u5224\u65ad\u662f\u5426\u4e3a\u8d1f\u6570 \n}\n\nint main() {\n\tsieve(MAXN);\n\tint n;\n\tstd::cin >> n;\n\tstd::cout << solve(n);\n\treturn 0;\n}\n```",
        "postTime": 1591614092,
        "uid": 225734,
        "name": "derta",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P6055 \u3010[RC-02] GCD\u3011"
    }
]
[
    {
        "content": "\u8003\u8651\u8d21\u732e$x^ay^b=(n-y)^ay^b=\\sum_{i=0}^{a}C(a,i)n^i(-y)^{a-i}y^b$\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97\u6240\u6709\u5e8f\u5217\u4e2d1\u7684\u4e2a\u6570\u7684$a+b-i$\u6b21\u65b9\u548c\uff0c\u7136\u540e\u679a\u4e3e\u4e0a\u5f0f\u7684$i$\u8ba1\u7b97\u5bf9\u5e94\u6743\u503c\u7edf\u8ba1\u5165\u7b54\u6848\u5373\u53ef\u3002\n\n\u8bbe$F[i][j][0/1]$\u4e3a\u524d$i$\u4f4d\uff0c\u6700\u540e\u4e00\u4f4d\u4e3a$0/1$\uff0c\u6ee1\u8db3\u6761\u4ef6\u7684\u5e8f\u5217\u76841\u7684\u4e2a\u6570\u7684j\u6b21\u65b9\u548c\uff0c\u6709\u8f6c\u79fb\u65b9\u7a0b:\n\n0/1->0:\u8d21\u732e\u4fdd\u6301\u4e0d\u53d8\uff0c$F[i][j][0]+=F[i-1][j][0/1]$\n\n(\u5728\u6b64\u611f\u8c22 @Joky_02 \u540c\u5b66\u6307\u51fa\u9519\u8bef)\n\n0->1:\u5c06$(y+1)^j$\u5c55\u5f00\uff0c\u6709\n\n$F[i][j][1]+=\\sum_{k=0}^{j}C(j,k)F[i-1][k][0]$\n\n\u586b\u4e0a\u8f6c\u79fb\u77e9\u9635\u540e\u5feb\u901f\u5e42\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6O($lgn(a+b)^3$)\n\n\u6700\u540e\u9644\u4e0a\u4ee3\u7801\uff1a\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\nconst int size=185;\ntypedef long long Int64;\nconst Int64 maxv=1LL<<62;\n#define asInt64(x) static_cast<long long>(x)\nint mod;\nstruct Mat{\n\tint n,m,v[size][size];\n\tMat(int n,int m):n(n),m(m){\n\t\tmemset(v,0,sizeof(v));\n\t}\n\tint* operator[](int i){\n\t\treturn v[i];\n\t}\n\tconst int* operator[](int i) const{\n\t\treturn v[i];\n\t}\n\tMat operator*(const Mat& rhs) const{\n\t\tMat res(n,rhs.m);\n\t\tfor(int i=0;i<n;++i)\n\t\t\tfor(int j=0;j<rhs.m;++j){\n\t\t\t\tInt64 sum=0;\n\t\t\t\tfor(int k=0;k<m;++k){\n\t\t\t\t\tsum+=asInt64(v[i][k])*rhs[k][j];\n\t\t\t\t\tif(sum>=maxv)sum%=mod;\n\t\t\t\t}\n\t\t\t\tres[i][j]=sum%mod;\n\t\t\t}\n\t\treturn res;\n\t}\n};\nint C[size][size]={};\nInt64 powv[size];\nint main(){\n\tint n,a,b;\n\tscanf(\"%d%d%d%d\",&n,&a,&b,&mod);\n\tint c=a+b+1,d=2*c;\n\t\n\tC[0][0]=1;\n\tfor(int i=1;i<c;++i){\n\t\tC[i][0]=1;\n\t\tfor(int j=1;j<=i;++j)\n\t\t\tC[i][j]=(C[i-1][j-1]+C[i-1][j])%mod;\n\t}\n\tpowv[0]=1;\n\tfor(int i=1;i<=a;++i)\n\t\tpowv[i]=powv[i-1]*n%mod;\n\t\t\n\tMat mul(d,d);\n\tfor(int i=0;i<c;++i){\n\t\t//0->0\n\t\tmul[i][i]=1;\n\t\t//1->0\n\t\tmul[i+c][i]=1;\n\t\t//0->1\n\t\tfor(int j=i;j<c;++j)\n\t\t\tmul[i][j+c]=C[j][i];\n\t}\n\t\n\tMat ans(1,d);\n\tans[0][0]=1;\n\twhile(n){\n\t\tif(n&1)ans=ans*mul;\n\t\tn>>=1,mul=mul*mul;\n\t}\n\t\n\tint res=0;\n\tfor(int i=0;i<=a;++i){\n\t\tint p=a+b-i;\n\t\tInt64 fac=C[a][i]*((a-i)&1?-1:1)*powv[i]%mod;\n\t\tInt64 cnt=(ans[0][p]+ans[0][p+c])%mod;\n\t\tres=(res+cnt*fac)%mod;\n\t}\n\tprintf(\"%d\\n\",(res+mod)%mod);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1524059067,
        "uid": 25170,
        "name": "dtcxzyw",
        "ccfLevel": 0,
        "title": "P4456 [CQOI2018]\u4ea4\u9519\u5e8f\u5217 \u9898\u89e3"
    },
    {
        "content": "\u672c\u9898\u89e3\u540c\u6b65\u53d1\u5e03\u4e8e[\u80e1\u5c0f\u5154\u7684\u535a\u5ba2](http://www.cnblogs.com/RabbitHu/p/BZOJ5298.html)\uff0c\u6b22\u8fce\u7559\u8a00\u4ea4\u6d41 >v<\n\n## \u9898\u9762\n\n> \u6c42\u6240\u6709\u957f\u5ea6\u4e3a$n$\u7684\u3001\u6ca1\u6709\u76f8\u90bb\u76841\u768401\u5e8f\u5217\u4e2d\uff0c\u82e50\u6709$x$\u4e2a\u30011\u6709$y$\u4e2a\uff0c$x^ay^b$\u4e4b\u548c\uff08\u5bf9$m$\u53d6\u6a21\uff09\u3002\n> $n \\le 10^7, m \\le 10^8, 0 \\le a, b \\le 45$\n\n## \u9898\u89e3\n\n\u672c\u9898\u9ebb\u70e6\u7684\u5730\u65b9\u5728\u4e8e\u8fd9\u4e2a$x^ay^b$\u600e\u4e48\u5904\u7406\u3002\n\n$$x^ay^b = (n - y)^ay^b = \\sum_{i = 0}^{a}C_a^in^i(-y)^{a - i}y^b = \\sum_{i = 0}^{a}(-1)^{a - i}C_a^in^iy^{a+b-i}$$ \n\n\u6240\u4ee5\u53ef\u4ee5\u6c42\u51fa\u5bf9\u4e8e\u6240\u6709$i \\in [0, a]$\u7684$y^i$\u4e4b\u548c\uff0c\u7136\u540e\u679a\u4e3e$i$\u4e58\u4e0a\u5bf9\u5e94\u7684\u7cfb\u6570\uff0c\u52a0\u8d77\u6765\u5373\u53ef\u3002\n\n\u90a3\u4e48\u5982\u4f55\u6c42\u51fa$y^i$\u4e4b\u548c\u5462\uff1f\n\n\u8bbe$f[k][i][0/1]$\u8868\u793a\u957f\u5ea6\u4e3a$k$\u3001\u7ed3\u5c3e\u662f0/1\u7684\u5e8f\u5217\u4e2d\u201c1\u7684\u4e2a\u6570\u201d\uff08\u5373$y$\uff09\u7684$i$\u6b21\u65b9\u4e4b\u548c\u3002\n\n0\u7ed3\u5c3e\u7684\u5e8f\u5217\u53ef\u4ee5\u4ece0/1\u5e8f\u5217\u8f6c\u79fb\u8fc7\u6765\uff0c\u800c1\u7684\u51fa\u73b0\u6b21\u6570\u4e0d\u4f1a\u53d8\u3002\n$$f[k][i][0] = f[k - 1][i][0] + f[k - 1][i][1]$$\n\n1\u7ed3\u5c3e\u7684\u5e8f\u5217\u53ea\u80fd\u4ece0\u7ed3\u5c3e\u7684\u8f6c\u79fb\u8fc7\u6765\uff0c1\u7684\u51fa\u73b0\u6b21\u6570\u4f1a+1\uff0c\u4e5f\u5c31\u662f\u65b0\u7684$y' = (y + 1)^i = \\sum_{j = 0}^{i}C_i^j y$\u3002\n$$f[k][i][1] = \\sum_{j = 0}^{i}C_i^jf[k - 1][j][0]$$\n\n\u7136\u540e\u6784\u5efa\u77e9\u9635\u5c31\u53ef\u4ee5\u505a\u4e86\uff01\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <algorithm>\n#include <iostream>\n#include <set>\n#define enter putchar('\\n')\n#define space putchar(' ')\nusing namespace std;\ntypedef long long ll;\ntemplate <class T>\nvoid read(T &x){\n    char c;\n    bool op = 0;\n    while(c = getchar(), c < '0' || c > '9')\n    if(c == '-') op = 1;\n    x = c - '0';\n    while(c = getchar(), c >= '0' && c <= '9')\n    x = x * 10 + c - '0';\n    if(op == 1) x = -x;\n}\ntemplate <class T>\nvoid write(T x){\n    if(x < 0) putchar('-'), x = -x;\n    if(x >= 10) write(x / 10);\n    putchar('0' + x % 10);\n}\n\nconst int N = 185;\nint n, a, b, P, sze1, sze2;\nll c[N][N], ans;\nstruct matrix {\n    ll g[N][N];\n    matrix(){\n\tmemset(g, 0, sizeof(g));\n    }\n    matrix operator * (const matrix &b) const {\n\tmatrix c;\n\tfor(int i = 0; i < sze2; i++)\n\t    for(int j = 0; j < sze2; j++){\n\t\tfor(int k = 0; k < sze2; k++)\n\t\t    c.g[i][j] += g[i][k] * b.g[k][j];\n\t\tc.g[i][j] %= P;\n\t    }\n\treturn c;\n    }\n    friend matrix qpow(matrix a, int x){\n\tmatrix ret;\n\tfor(int i = 0; i < sze2; i++)\n\t    ret.g[i][i] = 1;\n\twhile(x){\n\t    if(x & 1) ret = ret * a;\n\t    a = a * a;\n\t    x >>= 1;\n\t}\n\treturn ret;\n    }\n} op;\n\nint main(){\n    read(n), read(a), read(b), read(P);\n    sze1 = a + b + 1, sze2 = 2 * sze1;\n    c[0][0] = 1;\n    for(int i = 1; i <= a + b; i++){\n\tc[i][0] = 1;\n\tfor(int j = 1; j <= i; j++)\n\t    c[i][j] = (c[i - 1][j - 1] + c[i - 1][j]) % P;\n    }\n    for(int i = 0; i < sze1; i++){\n\top.g[i][i] = op.g[i][sze1 + i] = 1;\n\tfor(int j = 0; j <= i; j++)\n\t    op.g[sze1 + i][j] = c[i][j];\n    }\n    op = qpow(op, n);\n    ll pw = 1;\n    for(int i = 0; i <= a; i++){\n\tans += (((a - i) & 1) ? -1 : 1) * c[a][i] * pw % P * (op.g[a + b - i][0] + op.g[sze1 + a + b - i][0]) % P;\n\tpw = pw * n % P;\n    }\n    write((ans % P + P) % P), enter;\n    return 0;\n}\n```\n",
        "postTime": 1524225910,
        "uid": 8947,
        "name": "RabbitHu",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P4456 \u3010[CQOI2018]\u4ea4\u9519\u5e8f\u5217\u3011"
    },
    {
        "content": "\u975e\u5e38\u4f20\u7edf\u7684\u53cc\u77e9\u9635\u5feb\u901f\u5e42\u9898\u76ee\uff0c\u4f46\u662f\u8fd9\u9053\u9898\u7684\u4eae\u70b9\u662f\u5361\u5e38\u6570\u5427\u2026\u2026\n\n\u5728\u6211AC\u8fd9\u9053\u9898\u7684\u65f6\u5019\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u8bfb\u4f5cTLE\u5199\u505aRE\u7684\u60c5\u51b5\u53d1\u751f\uff0c\u5982\u679c\u53d1\u751f\u4e86\u8fd9\u79cd\u60c5\u51b5(\u901a\u5e38\u662f40pts)\uff0c\u8bf7\u5f00\u59cb\u5361\u5e38\u5427\u2026\u2026\n\n# \u53cc\u77e9\u9635\u5feb\u901f\u5e42\n\n\u5982\u679c\u5bf9\u77e9\u9635\u5feb\u901f\u5e42\u4e00\u70b9\u90fd\u4e0d\u4e86\u89e3\u7684\u8bdd\uff0c\u8bf7\u81ea\u884c\u767e\u5ea6\u81ea\u5b66\u5427\u2026\u2026\uff0c\u8fd9\u91cc\u9ed8\u8ba4\u4f60\u81f3\u5c11\u4f1a\u4e00\u822c\u7684\u77e9\u9635\u5feb\u901f\u5e42\u3002\n\n\u6240\u8c13\u53cc\u77e9\u9635\u5feb\u901f\u5e42\u5462\uff0c\u5c31\u662f\u5728\u540c\u4e00\u5f20\u77e9\u9635\u4e2d\u653e\u7f6e\u4e24\u4e2a(\u751a\u81f3\u66f4\u591a\u7684)dp\u6570\u7ec4\uff0c\u8fd9\u6837\u53ef\u4ee5\u5b9e\u73b0\u5904\u7406\u4e24\u4e2a\u4e0d\u540cdp\u6570\u7ec4\u7684\u76f8\u4e92\u8f6c\u79fb\u884c\u4e3a\uff0c\u6216\u8005\u51fa\u73b0\u4e86$dp_{i,j}$\u9700\u8981\u7531$dp_{i-1,k},dp_{i-2,k'}$\u8f6c\u79fb\u8fc7\u6765\u7684\u5c34\u5c2c\u60c5\u51b5\uff0c\u6b64\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u4e00\u5f20\u77e9\u9635\u4e0a\u653e\u7f6e\u4e24\u4e2adp\u6570\u7ec4\u7684\u65b9\u5f0f\u6765\u8f6c\u79fb(\u4ee3\u4ef7\u662f8\u500d\u7684\u5e38\u6570)\uff0c\u6700\u7b80\u5355\u7684\u53cc\u77e9\u9635\u5feb\u901f\u5e42\u5c31\u662f\u6c42fibonacci\u6570\u5217\u7b2cn\u9879\u4e86\uff0c\u56e0\u4e3a\u4f60\u7684\u77e9\u9635\u91cc\u540c\u65f6\u4fdd\u5b58\u4e86$f_{i},f_{i-1}$\u4e24\u4e2a\u9879\n\n\u90a3\u4e48\u76f4\u63a5\u4ee5\u8fd9\u9053\u9898\u6765\u8bb2\u89e3\u4e00\u4e0b\u5982\u4f55\u4f7f\u7528\u53cc\u77e9\u9635\u5feb\u901f\u5e42\u4ee5\u53ca\u5982\u4f55\u5361\u5e38\u6570\u597d\u4e86\n\n\n\u7b54\u6848\u8ba9\u6211\u4eec\u6c42,\u6709\u4e24\u4e2a\u5143\u4e0d\u662f\u5341\u5206\u7f8e\u89c2\uff0c\u6240\u4ee5\u6211\u4eec\u5462\u524a\u53bb\u4e00\u4e2a\u5143\n\n## $x^{a}y^{b}$\n\n## $=(n-y)^ay^b$\n\n\u4f7f\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\u66b4\u529b\u5c55\u5f00\n\n## $=\\sum_{i=0}^{a}C_{a}^{i}(-1)^{a-i}n^{i}y^{a-i}y^b$\n\n## $=\\sum_{i=0}^{a}C_{a}^{i}(-1)^{a-i}n^{i}y^{a+b-i}$\n\n\u7136\u540e\u6211\u4eec\u73b0\u5728\u8981\u6c42\u7684\u662f\n\n\u6240\u6709\u4ea4\u9519\u5e8f\u5217\u7684\u4e0a\u8fb9\u5f0f\u5b50\u7684\u503c\uff0c\u6211\u4eec\u53d1\u73b0\u53ef\u4ee5\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u4ea4\u9519\u5e8f\u5217\u6765\u8bb2\n\n## $C_{a}^{i}(-1)^{a-i}n^{i}$\n\n\u90fd\u662f\u5e38\u91cf\uff0c\u6240\u4ee5\u53ef\u4ee5\u63d0\u51fa\u6765\uff0c\u6700\u540e\u5bf9\u6240\u6709\u5f0f\u5b50\u7684\u7279\u5f81\u503c\u7edf\u4e00\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\n\n\u73b0\u5728\u95ee\u9898\u53d8\u6210\u4e86\uff0c\u6c42\u6240\u6709\u4ea4\u9519\u5e8f\u5217\u7684$y^{a+b-i}$\u7684\u548c\uff0c\u7136\u540e\u8fd9\u6837\u6211\u4eec\u624d\u53ef\u4ee5\u4ec5\u5728\u6700\u540e\u4f7f\u7528\u4e00\u6b21\u4e8c\u9879\u5f0f\u5b9a\u7406\n\n\u5bf9\u4e8e\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u4f7f\u7528dp\u89e3\u51b3\u5b83\uff0c\u4ee4$Dp_{i,j,k}(k\u2208(0,1))$\u8868\u793a\u51b3\u7b56\u5230\u4e86\u7b2ci\u4f4d\u7ed3\u5c3e\u4e3a0/1\uff0c\u6240\u6709\u65b9\u68481\u7684\u4e2a\u6570\u7684j\u6b21\u65b9\u4e4b\u548c\n\n\u90a3\u4e48\u8f6c\u79fb\u65b9\u7a0b\u67092\u4e2a\uff0c\u5206\u522b\u662f(0->0)\u6216\u8005(0->1)\u6216\u8005(1->0)\n\n\u7136\u540e\u8f6c\u79fb\u65b9\u7a0b\u5206\u522b\u662f\u8fd92\u4e2a\n\n\u8f6c\u79fb\u52300\u7684\u65f6\u5019\u56e0\u4e3a\u6ca1\u6709\u589e\u52a01\u7684\u4e2a\u6570\u53ef\u4ee5\u76f4\u63a5\u76f8\u52a0\n\n## $Dp_{i,j,0}=Dp_{i-1,j,0}+Dp_{i-1,j,1}$\n\n\u8f6c\u79fb\u52301\u7684\u65f6\u5019\u589e\u52a0\u4e861\u7684\u4e2a\u6570\u6240\u4ee5\u53ef\u4ee5\u66b4\u529b\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c55\u5f00\uff0c\u7531\u4e8e\u4e0d\u80fd\u653e\u4e24\u4e2a\u8fde\u7eed\u76841\uff0c\u6240\u4ee5\u53ea\u53ef\u4ee5\u75310\u8f6c\u79fb\u8fc7\u6765\n\n## $Dp_{i,j,1}=\\sum_{k=0}^{j}C_{j}^{k}Dp_{i-1,k,0}$\n\n\u56e0\u6b64\u6211\u4eec\u5728\u6784\u9020\u8f6c\u79fb\u77e9\u9635\u7684\u65f6\u5019\u53ef\u4ee5\u4e00\u5f20\u77e9\u9635\u4e0a\u653e\u4e24\u4e2adp\u6570\u7ec4\uff0c\u524d\u534a\u90e8\u5206\u653e$Dp_{0}$\uff0c\u540e\u534a\u90e8\u5206\u653e$Dp_{1}$\u7136\u540e\u5c31\u53ef\u4ee5\u8f6c\u79fb\u5566~\n\n\u5f53\u7136\u6784\u9020\u8f6c\u79fb\u77e9\u9635\u65f6\u52a1\u5fc5\u6ce8\u610f\u4e24\u70b9\uff0c\u8f6c\u79fb\u7684\u65b9\u5411\u4e00\u5b9a\u662f\u4ece\u884c\u5230\u5217\u7684\uff0c\u8f6c\u79fb\u4ece\u6765\u90fd\u662f\u5355\u5411\u8f6c\u79fb\u3002\n\n\u8f6c\u79fb\u77e9\u9635\u7684\u8bdd\uff0c\u957f\u76f8\u5927\u6982\u662f\u5de6\u4e0a\u89d2\u662f\u5355\u4f4d\u77e9\u9635(0->0)\uff0c\u5de6\u4e0b\u89d2\u4e5f\u662f\u5355\u4f4d\u77e9\u9635(1->0)\uff0c\u53f3\u4e0a\u89d2\u662f\u4e00\u4e2a\u65cb\u8f6c90\u5ea6\u7684\u6768\u8f89\u4e09\u89d2(0->1)\uff0c\u53f3\u4e0b\u89d2\u5168\u90e8\u662f0(1->1)\n\n\u7136\u540e\u77e9\u9635\u5feb\u901f\u5e42\u5c31\u597d\u4e86~\n\n\u505a\u5b8c\u4e86\uff1f\n\n\u4f60\u5174\u594b\u7684\u5199\u5b8c\u4e86\u4ee3\u7801\uff0c\u52a0\u4e0a\u53bb\u4e00\u770b\uff0c40pts\uff0c\u53ea\u6bd4$2^n$\u66b4\u529b\u9ad810\u5206\uff0c\u624b\u6d4b\u4e00\u7ec4\u6570\u636e\uff0c2.0s\u8d85\u4e86\u65f6\u9650\u4e00\u500d\u2026\u2026\uff0c\u6211\u4e0d\u670d\u554a\u2026\u2026\n\n## \u6211\u8981\u5361\u5e38\u6570\uff01\n\n\u4f60\u4ed4\u7ec6\u4e00\u770b\u6570\u636e\u8303\u56f4\uff0c\u53d1\u73b0m<=1e8\u800c\u4e0d\u662f1e9\n\n\u8fd9\u610f\u5473\u7740\u4f60\u53ef\u4ee5\u5728\u77e9\u9635\u5feb\u901f\u5e42\u7684\u65f6\u5019\u5728c\\[i]\\[j]\u901a\u8fc7$O(a+b)$\u6b21\u52a0\u6cd5\u6c42\u51fa\u503c\u4e4b\u540e\u518d\u53bb\u819c\uff0c\u4e00\u6b21\u77e9\u9635\u5feb\u901f\u5e42\u4ec5\u505a\u4e86$O((a+b)^2)$\u6b21\u7684\u53d6\u819c\u8fd0\u7b97\uff0c\u5361\u5e38\u5b8c\u6bd5\u2026\u2026\n\n\u4f60\u8bf4\uff0c\u6211\u4e0d\u670d\u554a\u2026\u2026\u6211\u8981m\u5f00\u52301e9\uff01\n\n\u4e8e\u662f\u4f60\u5c1d\u8bd5\u628along long\u6362\u6210\u4e86unsigned long long\u5f88\u597d\uff0c\u4f60\u7684\u7a0b\u5e8f\u53d8\u6210\u4e861.8s\n\n\u7136\u540e\u4f60\u628a\u5faa\u73af\u7684\u987a\u5e8f\u7531i,j,k\u6362\u6210\u4e86i,k,j\uff0c\u8fd9\u4f1a\u4f7f\u4f60\u8fde\u7eed\u8bbf\u95ee\u4e00\u6bb5\u5185\u5b58\uff0c\u5927\u5e45\u5ea6\u51cf\u5c11cache miss\uff0c\u5f88\u597d\uff0c\u73b0\u5728\u4f60\u7684\u7a0b\u5e8f\u53ef\u4ee5\u57281.2s\u5b8c\u6210\u4efb\u52a1\u4e86\u2026\u2026\n\n\u7136\u540e\u4f60\u5750\u5728\u7535\u8111\u524d\u5361\u4e86\u534a\u5e74\u5e38\u6570\u2026\u2026\u5374\u53d1\u73b0\u600e\u4e48\u4e5f\u5361\u4e0d\u8fdb1s\u2026\u2026\u6b63\u5f53\u4f60\u5c06\u8981\u5f03\u7597\u7684\u65f6\u5019\uff0c\u4f60\u628a\u8f6c\u79fb\u77e9\u9635\u7684n\u6b21\u5e42\u6253\u4e86\u51fa\u6765\uff01\n\n\u4f60\u60ca\u5947\u7684\u53d1\u73b0\uff0c\u8fd9\u4e2a\u8f6c\u79fb\u77e9\u9635\u7684n\u6b21\u5e42\u662f\u75314\u4e2a\u4e0a\u4e09\u89d2\u77e9\u9635\u6784\u6210\u7684\uff01\n\n\u8fd9\u610f\u5473\u8fd9\u6574\u4e2a\u77e9\u9635\u67091/2\u7684\u5143\u7d20\u662f0\uff01\uff0c\u65e2\u7136\u662f0\u6211\u4eec\u4e3a\u4ec0\u4e48\u8981\u7b97\u5b83\u5462\uff1f\n\n\u6240\u4ee5\u6211\u4eec\u6bcf\u6b21\u77e9\u9635\u5feb\u901f\u5e42\u7684\u65f6\u5019\u53ea\u8ba1\u7b97\u56db\u4e2a\u4e0a\u4e09\u89d2\u77e9\u9635\u7684\u4e58\u6cd5\uff0c\u56e0\u4e3a\u90a3\u4e9b\u4e00\u5b9a\u662f0\u7684\u90e8\u5206\u6211\u4eec\u6ca1\u5fc5\u8981\u7b97\u2026\u2026\u4e8e\u662f\u6211\u4eec\u76f4\u63a5\u628a\u5e38\u6570\u9664\u4e86\u4e00\u4e2a2\uff0c\u7136\u540e\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u57280.6s\u5185\u901a\u8fc7\u8fd9\u9053\u9898\u4e86\u2026\u2026\n\n\u4e0a\u4ee3\u7801~\n\n```C\n#include<cstdio>\n#include<algorithm>\n#include<ctime>\nusing namespace std;const int M=190;typedef long long ll;int stat;int end;\nint n;int m;ll mod;ll c[M][M];ll res;ll ans[M];ll siz;ll hsz;int a;int b;ll mi[M];\nstruct mar\n{\n \tll mp[M][M];\n \tmar(){for(int i=0;i<siz;i++)for(int j=0;j<siz;j++)mp[i][j]=0;}\n \tfriend mar operator *(const mar& a,const mar& b)//\u8fd9\u91cc\u53ea\u505a\u4e864\u4e2a\u4e0a\u4e09\u89d2\u77e9\u9635\u4e58\u6cd5\uff0c\u5e38\u6570/2 \n \t{\n \t\tmar c;\n \t\tfor(int i=0;i<hsz;i++)//\u5de6\u4e0a\u89d2 \n         \tfor(int k=0;k<siz;k++)\n \t\t\t\tfor(int j=i;j<hsz;j++) \n \t\t\t\t\t(c.mp[i][j]+=a.mp[i][k]*b.mp[k][j])%=mod;\n \t\tfor(int i=0;i<hsz;i++)//\u53f3\u4e0a\u89d2 \n         \tfor(int k=0;k<siz;k++)\n \t\t\t\tfor(int j=hsz+i;j<siz;j++) \n \t\t\t\t\t(c.mp[i][j]+=a.mp[i][k]*b.mp[k][j])%=mod;\n \t\tfor(int i=hsz;i<siz;i++)//\u5de6\u4e0b\u89d2 \n         \tfor(int k=0;k<siz;k++)\n \t\t\t\tfor(int j=i-hsz;j<hsz;j++) \n \t\t\t\t\t(c.mp[i][j]+=a.mp[i][k]*b.mp[k][j])%=mod;\n \t\tfor(int i=hsz;i<siz;i++)//\u5de6\u4e0b\u89d2 \n         \tfor(int k=0;k<siz;k++)\n \t\t\t\tfor(int j=i;j<siz;j++) \n \t\t\t\t\t(c.mp[i][j]+=a.mp[i][k]*b.mp[k][j])%=mod;\n \t\treturn c;\n \t}\n}tr,ret,st;\nint main()\n{\n    scanf(\"%d%d%d%lld\",&n,&a,&b,&mod);hsz=a+b+1;siz=2*hsz;mi[0]=1;//\u56e0\u4e3a\u653e\u4e86\u4e24\u4e2adp\u6570\u7ec4 \n    for(int i=0;i<hsz;i++)c[0][i]=c[i][i]=1;//\u5148\u6253\u8868\u7ec4\u5408\u6570 \n    for(int i=0;i<hsz;i++)\n        for(int j=1;j<i;j++)\n            c[j][i]=(c[j-1][i-1]+c[j][i-1])%mod;\n    for(int i=0;i<hsz;i++)tr.mp[i][i]=1;for(int i=0;i<hsz;i++)tr.mp[hsz+i][i]=1;//\u5355\u4f4d\u77e9\u9635\u90e8\u5206 \n    for(int i=0;i<hsz;i++)for(int j=i;j<hsz;j++)tr.mp[i][hsz+j]=c[i][j];//\u6768\u8f89\u4e09\u89d2\u90e8\u5206 \n    for(int i=0;i<siz;i++)ret.mp[i][i]=1;\n    for(int p=n;p;p>>=1,tr=tr*tr)if(p&1)ret=ret*tr;//\u77e9\u9635\u5feb\u901f\u5e42 \n    for(int i=0;i<hsz;i++)ans[i]=(ret.mp[0][i]+ret.mp[0][hsz+i])%mod;//\u8ba1\u7b97y^(a+b-i)\u548c \n    for(int i=1;i<hsz;i++){mi[i]=mi[i-1]*n%mod;}//\u8ba1\u7b97\u5e42\u6b21 \n    for(int i=0;i<=a;i++)//\u7edf\u4e00\u4f7f\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406 \n    {\n        ll del=c[i][a]*mi[i]%mod*ans[a+b-i]%mod;\n        if((a-i)%2){res=(res+mod-del)%mod;}else {res=(res+del)%mod;}\n    }printf(\"%lld\",res);return 0;//\u62dc\u62dc\u7a0b\u5e8f~ \n}\n\n```\n\n",
        "postTime": 1524659131,
        "uid": 56384,
        "name": "shadowice1984",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4456 \u3010[CQOI2018]\u4ea4\u9519\u5e8f\u5217\u3011"
    },
    {
        "content": "\u4e00\u4e2a\u5f88\u81ea\u7136\u7684\u60f3\u6cd5\u662f\u679a\u4e3e\u5e8f\u5217\u4e2d $1$ \u7684\u4e2a\u6570 $i$\uff0c\u63d2\u677f\u6cd5\u5373\u5f97\u7b54\u6848\u4e3a\n$$\\sum_{i=0}^n\\binom{n-i+1}{i}  i ^b(n-i)^a$$\n\u8fd9\u4e2a\u770b\u8d77\u6765\u5c31\u5f88\u50cf EI \u63d0\u51fa\u7684\u90a3\u4e00\u5957\u901a\u6cd5\uff08\u8d5e\u7f8e EI\uff01\uff09\u80fd\u89e3\u51b3\u7684\u3002\u5927\u90e8\u5206\u9898\u90fd\u662f\u63d0\u53d6 $F(G(x))$ \u7684\u4e00\u9879\u7cfb\u6570\uff0c\u4f46\u4e0d\u8981\u5fd8\u4e86\u5176\u6807\u51c6\u5f62\u5f0f\uff0c\u5373\u5728\u5bf9 $i\\in[0,m]$ \u5df2\u77e5\n$$\\sum_{j=0}^mA_j[x^j]G(x)^i$$\n\u7684\u65f6\u5019\u53ef\u4ee5 $\\Theta(m)$ \u6c42\u51fa\n$$\\sum_{j=0}^m A_j[x^j]F(G(x))=\\sum_{i=0}^n f_i \\sum_{j=0}^mA_j[x^j]G(x)^i$$\n\u8fd9\u91cc\u628a\u6c42\u548c\u4e0a\u754c\u6682\u8bb0\u4e3a $m$\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u5bf9\u5e94\u5230\u6211\u4eec\u8fd9\u9898\u4e0a\u6709\n$$f_i = \\binom{n-i+1}{i} \\ , \\ i^b(n-i)^a=\\sum_{j=0}^mA_j[x^j]G(x)^i $$\n\u7528\u4e8c\u9879\u5f0f\u5c55\u5f00\u53ef\u4ee5\u53d1\u73b0\uff0c\u53f3\u5f0f\u4e2d\u5bf9\u5e94 $i$ \u7684\u5e42\u6b21\u6700\u9ad8\u5230 $a+b$\uff0c\u6240\u4ee5\u5e94\u53d6 $m=a+b$\u3002\n\n\u73b0\u5728\u5c31\u80fd\u76f4\u63a5\u5957\u677f\u5b50\u4e86\uff0c$F(x)$ \u663e\u7136\u662f\u5fae\u5206\u6709\u9650\u7684\uff0c\u6c42\u51fa $\\mathcal F(x)=F(x+1) \\bmod x^{m+1}$ \u5bf9\u5e94\u7684 ODE \u540e\uff0c\u9012\u63a8\u6c42\u51fa $\\mathcal H(x) = \\mathcal F(x-1)$ \u7684\u7cfb\u6570\uff0c\u6700\u540e\u6240\u6c42\u5373\n$$\\sum_{j=0}^m A_j[x^j] \\mathcal H(G(x))=\\sum_{i=0}^m h_i i^b(n-i)^a$$\n\u4f46\u662f\u8981\u5bf9 $i\\in [0,m]$ \u6c42\u51fa $i^b(n-i)^a$ \u4f3c\u4e4e\u5e76\u4e0d\u5bb9\u6613\u5904\u7406\uff0c\u5982\u679c\u54ea\u4f4d\u8001\u54e5\u4f1a $\\Theta(m)$ \u6c42\u7684\u8bdd\u8fd8\u8bf7\u6765\u6559\u80b2\u4e00\u4e0b\uff08\n\n\u611f\u89c9\u8fd8\u9700\u8981\u8865\u5145\u4e00\u4e0b\uff08\u624d\u4e0d\u662f\u56e0\u4e3a\u758f\u5ffd\u5fd8\u4e86\u8bf4\uff09\uff0c\u5728\u6c42 $\\mathcal F(x)$ \u7684\u7cfb\u6570\u65f6\u9700\u8981\u5148\u7b97\u51fa\u524d\u4e24\u9879\u3002\u4e4d\u4e00\u770b\u9700\u8981\u6574\u5f0f\u9012\u63a8\uff0c\u4e0d\u8fc7\u5c06 $f_i$ \u4e2d\u7684\u7ec4\u5408\u6570\u62c6\u5f00\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$F(x)=[z^n] \\frac{1+xz}{1-z-xz^2}$$\n\u4e8e\u662f\u6709\n$$\\mathcal F(0)=[z^n] \\frac{1+z}{1-z-z^2}$$\n$$[x^1]\\mathcal F(x) = \\mathcal F'(0)=[z^n]\\frac{z}{(1-z-z^2)^2}$$\n\u95ee\u9898\u4ece\u6574\u5f0f\u9012\u63a8\u8f6c\u5316\u4e3a\u4e86\u7ebf\u6027\u5e38\u7cfb\u6570\u9012\u63a8\uff0c\u76f4\u63a5 $\\Theta(\\log n)$ \u6c42\u51fa\u5373\u53ef\u3002\n\n\n\u5047\u8bbe $a,b$ \u540c\u9636\uff0c\u5219\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\Theta(\\log n +m \\log m)$\u3002",
        "postTime": 1639395395,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "P4456 Solution"
    },
    {
        "content": "**\u524d\u8a00**\n\n------------\n\n\u975e\u5e38\u53cb\u597d\u7684\u7701\u9009\u9898\uff0c\u7528\u5230\u7684\u77e5\u8bc6\u4e0d\u662f\u5f88\u96be\u3002\u559c\u63d0\u8f83\u52a3 $O(n)$ \u89e3\u3002\n\n**\u601d\u8def**\n\n------------\n\n\u5355\u72ec\u5217\u51e0\u9879\uff0c\u53d1\u73b0\u7b54\u6848\u957f\u8fd9\u6837\uff1a\n\n$\\Sigma^{(n+1)/2}_{i=0} C^{i}_{n-i+1} \\times (n-i)^{a} \\times i^{b}$\n\n\u96be\u70b9\u5728\u5982\u4f55\u6c42 $(n-i)^{a} \\times i^{b}$\u3002\n\n\u8bbe\u51fd\u6570 $f(x)=x^a$\uff0c\u5176\u4e2d $a$ \u4e3a\u5e38\u6570\uff0c\u4e14 $x=bc$\uff0c\u5219 $f(x)=f(b)f(c)$\u3002\n\n\u56e0\u6b64\u53ea\u9700\u8981\u7b97\u8d28\u6570\u7684\u51fd\u6570\u503c\u5373\u53ef\u7528\u6b27\u62c9\u7b5b\u505a\u4e86\u3002\u53ef\u4ee5\u8bc1\u660e\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n)$\u3002\n\n**\u4ee3\u7801**\n\n------------\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\ntemplate<typename G> inline void read(G &x) {x=0;G f=1;char ch=getchar();while((ch<'0'||ch>'9')&&ch!='-') ch=getchar();if(ch=='-') f=-1,ch=getchar();while(ch>='0'&&ch<='9') {x=x*10+(ch^48);ch=getchar();}x*=f;}\nconst int MAXN=1e7+5,MAXM=1e6+5;\nint n,inv[MAXN],fac[MAXN],ans;\nint f1[MAXN],f2[MAXN],pri[MAXM],cnt;\nbool f[MAXN];\nint qpow(int a,int b,const int p) {\n    int res=1;\n    while(b) {\n        if(b&1) res=(res*a)%p;\n        b>>=1;\n        a=(a*a)%p;\n    }\n    return res;\n}\nint a,b;\nvoid euler(const int p) {\n\tif(a==0) f1[0]=1;\n\tif(b==0) f2[0]=1;\n\tf1[1]=f2[1]=1;\n\tfor(int i=2;i<=n;++i) {\n\t\tif(!f[i]) {\n\t\t\tf1[i]=qpow(i,a,p),f2[i]=qpow(i,b,p);\n\t\t\tpri[++cnt]=i;\n\t\t}\n\t\tfor(int j=1;j<=cnt;++j) {\n\t\t\tif(i*pri[j]>n) break;\n\t\t\tf[i*pri[j]]=1;\n\t\t\tf1[i*pri[j]]=(f1[i]*f1[pri[j]])%p;\n\t\t\tf2[i*pri[j]]=(f2[i]*f2[pri[j]])%p;\n\t\t\tif(i%pri[j]==0) break; \n\t\t}\n\t}\n}\nint m,lim;\nint C(int x,int y,const int p) {\n    return ((fac[x]*inv[y])%p*inv[x-y])%p;\n}\nsigned main() {\n\tread(n),read(a),read(b),read(m),fac[0]=1;const int p=m;\n\teuler(p);\n    for(int i=1;i<=n+1;++i) fac[i]=(fac[i-1]*i)%p;\n\tinv[n+1]=qpow(fac[n+1],p-2,p);\n    for(int i=n;i>=0;--i) inv[i]=(inv[i+1]*(i+1))%p;\n    for(int i=0;i<=(n+1)/2;++i) {\n    \tans=(ans+((C(n-i+1,i,p)*f1[n-i])%p*f2[i]))%p;\n\t}\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n/*\n(n-x)^a*(x)^b\n=x^b(n-x)(n-x)\n*/  \n```",
        "postTime": 1658279283,
        "uid": 271260,
        "name": "PosVII",
        "ccfLevel": 7,
        "title": "P4456 [CQOI2018]\u4ea4\u9519\u5e8f\u5217 \u9898\u89e3"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4456)\n# \u601d\u8def\n\u770b\u5230\u81ea\u5df1\u7684\u505a\u6cd5\u4f3c\u4e4e\u8ddf\u5176\u4ed6\u505a\u6cd5\u90fd\u4e0d\u662f\u5f88\u4e00\u6837\uff0c\u6240\u4ee5\u8fd8\u662f\u6765\u4e00\u53d1\u5427\u3002\uff08\u867d\u7136\u81ea\u5df1\u597d\u50cf\u8dd1\u5f97\u5f88\u6162\u3002\u3002\u3002\uff09\n\n\u4e0d\u96be\u770b\u51fa\u5982\u679c\u6709 $x$ \u4e2a $1$ \u7684\u65f6\u5019\u4e00\u4e2a\u6570\u7684\u8d21\u732e\u5c31\u662f $x^b(n-x)^a$\uff0c\u5176\u5b83\u9898\u89e3\u5230\u8fd9\u4e00\u6b65\u7684\u65f6\u5019\u90fd\u5f00\u59cb\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\uff0c\u4f46\u662f\u5176\u5b9e\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u4e0d\u62c6\u3002\n\n\u6211\u4eec\u8003\u8651\u6709 $x$ \u4e2a $1$ \u7684\u4e14\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u6709\u591a\u5c11\u4e2a\uff0c\u4e0d\u96be\u770b\u51fa\u7b54\u6848\u5c31\u662f:\n\n$$\\sum_{i=0}^{n-x}\\binom{n-x-i-1}{x-1}$$\n\n\u5176\u610f\u4e49\u5c31\u662f\u8bf4\u6211\u4eec\u679a\u4e3e\u6709 $i$ \u4e2a $0$ \u5728\u7b2c\u4e00\u4e2a $1$ \u524d\u9762\uff0c\u7136\u540e\u628a\u5269\u4e0b $n-x-i$ \u4e2a\u5206\u6210 $x$ \u4efd\u5206\u5728\u6bcf\u4e00\u4e2a $1$ \u540e\u9762\u3002\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u5316\u6210 $\\binom{n-x+1}{x}$\u3002\n\n\u4e8e\u662f\u7b54\u6848\u5c31\u662f\uff1a\n\n$$\\sum_{x=0}^{\\lfloor\\frac{n+1}{2}\\rfloor} \\binom{n-x+1}{x}x^b(n-x)^a$$\n\n\u6211\u4eec\u5982\u679c\u8981\u505a\u5230 $\\Theta(n)$ \u7684\u8bdd $x^b$ \u548c $(n-x)^a$ \u76f4\u63a5\u7ebf\u6027\u7b5b\u5c31\u597d\u4e86\u3002\n\n\u65f6\u7a7a\u590d\u6742\u5ea6 $\\Theta(n)$\u3002\n# $\\texttt{Code}$\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define Int register int\n#define MAXN 10000005\n\ntemplate <typename T> inline void read (T &t){t = 0;char c = getchar();int f = 1;while (c < '0' || c > '9'){if (c == '-') f = -f;c = getchar();}while (c >= '0' && c <= '9'){t = (t << 3) + (t << 1) + c - '0';c = getchar();} t *= f;}\ntemplate <typename T,typename ... Args> inline void read (T &t,Args&... args){read (t);read (args...);}\ntemplate <typename T> inline void write (T x){if (x < 0){x = -x;putchar ('-');}if (x > 9) write (x / 10);putchar (x % 10 + '0');}\n\nint n,a,b,mod,tot,pw1[MAXN],pw2[MAXN],fac[MAXN],ifac[MAXN];\nint mul (int a,int b){return 1ll * a * b % mod;}\nint dec (int a,int b){return a >= b ? a - b : a + mod - b;}\nint add (int a,int b){return a + b >= mod ? a + b - mod : a + b;}\nint qkpow (int a,int b){int res = 1;for (;b;b >>= 1,a = mul (a,a)) if (b & 1) res = mul (res,a);return res;}\nint binom (int a,int b){return a >= b ? mul (fac[a],mul (ifac[a - b],ifac[b])) : 0;}\nint inv (int x){return qkpow (x,mod - 2);}\n\nbool vis[MAXN];\nvoid Euler (int up){\n\tpw1[0] = a == 0,pw2[0] = b == 0,pw1[1] = pw2[1] = 1;\n\tfor (Int i = 2;i <= up;++ i){\n\t\tif (!vis[i]) fac[++ tot] = i,pw1[i] = qkpow (i,a),pw2[i] = qkpow (i,b);\n\t\tfor (Int j = 1;j <= tot && i * fac[j] <= up;++ j){\n\t\t\tvis[i * fac[j]] = 1,pw1[i * fac[j]] = mul (pw1[i],pw1[fac[j]]),pw2[i * fac[j]] = mul (pw2[i],pw2[fac[j]]);\n\t\t\tif (i % fac[j] == 0) break;\n\t\t}\n\t}\n}\n\nsigned main(){\n\tread (n,a,b,mod);Euler (n);\n\tfac[0] = 1;for (Int i = 1;i <= n + 1;++ i) fac[i] = mul (fac[i - 1],i);\n\tifac[n + 1] = inv (fac[n + 1]);for (Int i = n + 1;i;-- i) ifac[i - 1] = mul (ifac[i],i);\n\tint ans = 0;for (Int x = 0;x <= (n + 1) / 2;++ x) ans = add (ans,mul (binom (n - x + 1,x),mul (pw1[n - x],pw2[x])));\n\twrite (ans),putchar ('\\n');\n\treturn 0;\n}\n```",
        "postTime": 1605271968,
        "uid": 124781,
        "name": "Walking_Dead",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4456 \u3010[CQOI2018]\u4ea4\u9519\u5e8f\u5217\u3011"
    },
    {
        "content": "# [CQOI2018]\u4ea4\u9519\u5e8f\u5217\n\n## \u8349\u7a3f\n\n\u8bbe\u6709$a$\u4e2a$0$\uff0c$b$\u4e2a$1$\u7684\u4ea4\u9519\u6570\u5217\u6709$f(a,b)$\u4e2a\u3002\u7740\u5c31\u76f8\u5f53\u4e8e\u6709$b$\u4e2a\u677f\u5b50\uff0c\u73b0\u5728\u8981\u5728\u8fd9$b$\u4e2a\u677f\u5b50\u4e2d\u63d2\u5165$a$\u4e2a\u7403\uff0c\u800c\u4e14\u6bcf\u4e24\u4e2a\u677f\u5b50\u95f4\u7a7a\u5185\u81f3\u5c11\u6709$1$\u4e2a\u7403\uff0c\u4e24\u7aef\u4e0d\u505a\u8981\u6c42\u3002\u90a3\u4e48$f(a,b)=C_{a+1}^{b}$\u79cd\u63d2\u5165\u65b9\u6cd5\u3002\n\n\u4e8e\u662f\u7b54\u6848\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a\n\n$$\n\\sum_{i=0}^{\\lfloor \\frac{n+1}{2}\\rfloor}f(n-i,i)\\cdot (n-i)^a\\cdot i^b=\\sum_{i=0}^{\\lfloor \\frac{n+1}{2}\\rfloor}C_{n-i+1}^{i}\\cdot(n-i)^a\\cdot i^b\n$$\n\u5c1d\u8bd5\u5c55\u5f00$(n-i)^ai^b$\uff1f\n\n$$\n\\begin{aligned}\n(n-i)^ai^b\n&= \\sum_{j=0}^{a} C_{a}^{j}\\cdot i^{j+b}\\cdot n^{a-j}\\cdot (-1)^j\n\\end{aligned}\n$$\n\n\u6ca1\u4ec0\u4e48\u7528\u5904\u3002\n\n## \u5927\u6982\u505a\u6cd5\n\n\u9996\u5148\u5c55\u5f00$(n-i)^ai^b$\u3002\u53d1\u73b0\u6709\u4e00\u4e9b\u662f\u5e38\u6570\uff0c\u6700\u7ec8\u8981\u6c42\u7684\uff08\u5bf9\u4e8e\u6bcf\u4e2a\u5e8f\u5217\u4e0d\u4e00\u6837\u7684\uff09\uff0c\u5176\u5b9e\u5c31\u662f\u6240\u6709\u5e8f\u5217\u76841\u7684\u4e2a\u6570\u7684$a+b-i$\u6b21\u65b9\u3002\u5176\u4e2d$i\\in [1,a]$\u3002\u7136\u540e\u53ef\u4ee5\u9012\u63a8\u3002\u9012\u63a8\u8bbe$f_{i,j,k}$\u8868\u793a\u524d$i$\u4f4d\uff0c\u6240\u6709\u5e8f\u5217\u6ee1\u8db3\u6700\u540e\u4e00\u4f4d\u4e3a$k$\u7684$1$\u7684\u4e2a\u6570\u7684$j$\u6b21\u65b9\u548c\u3002\u7136\u540e\u7528\u77e9\u9635\u4f18\u5316\uff0c\u77e9\u9635\u4e2d\u641e\u4e00\u4e2a\u6768\u8f89\u4e09\u89d2\u5373\u53ef\u3002\n\u5177\u4f53\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$\nf_{i,j,0}=f_{i,j,0}+f_{i,j,1}\n$$\n$$\nf_{i,j,1}=\\sum_{k=0}^{j}C_{j}^{k}f_{i-1,k,0}\n$$\n\n## \u77e5\u8bc6\u70b9\n\n+ \u5e76\u4e0d\u662f\u6240\u6709\u4e1c\u897f\u90fd\u5316\u6210\u6570\u5b66\u5f62\u5f0f\u5c31\u597d\u7684\uff08\u5316\u4e3a\u6570\u5b66\u5f0f\u5b50\u5c31\u6709\u53ef\u80fd\u53d1\u73b0\u4e0d\u4e86\u67d0\u4e9b\u4f18\u5316\u65b9\u6848\uff09\n+ \u6c42\u4e00\u4e2a\u4e0e\u6b21\u65b9\u76f8\u5173\u7684\u5f0f\u5b50\u7684\u503c\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u8003\u8651\u52a8\u6001\u89c4\u5212\u4e0e\u6768\u8f89\u4e09\u89d2\u7ed3\u5408\u3002\n\n+ \u6ce8\u610f\u5728\u7cfb\u6570\u4e3a\u8d1f\u6570\u7684\u6570\u8fd0\u7b97\u65f6\u5148\u628a\u8fd9\u4e2a\u6570\u52a0$mod$\u5728\u6a21$mod$\u5728\u8fdb\u884c\u8fd0\u7b97\u3002\u5426\u5219\u4f1a\u51fa\u4e8b\uff0c\u6709\u53ef\u80fd\u51cf\u6210\u8d1f\u6570\uff08\u8fd9\u6837\u7b54\u6848\u5c31\u6210\u4e86\u8d1f\u6570\uff0c\u867d\u7136\u5728\u6a21$mod$\u7684\u610f\u4e49\u4e0b\u4e0e\u7b54\u6848\u7b49\u4ef7\uff09\u3002\n\n## \u4ee3\u7801\n```cpp\n#include <cstdio>\n#include <cstring>\n\ntypedef long long ll;\nconst int SIZE = 45 * 4 + 5;\nint seqLen = 0, aExp = 0, bExp = 0, mod = 0;\nint matSiz = 0;\nll C[95][95] = {};\nstruct MATRIX\n{\n\tint row, col;\n\tll num[SIZE][SIZE];\n\tMATRIX(int needRow, int needCol)\n\t{\n\t\trow = needRow;\n\t\tcol = needCol;\n\t\tmemset(num, 0, sizeof(num));\n\t\treturn ;\n\t}\n\t\n\tMATRIX operator * (const MATRIX &d) const\n\t{\n\t\tMATRIX ret(row, d.col);\n\t\tfor (int mid = 1; mid <= col; ++mid)\n\t\t\tfor (int rI = 1; rI <= row; ++rI)\n\t\t\t\tfor (int cJ = 1; cJ <= d.col; ++cJ)\n\t\t\t\t{\n\t\t\t\t\tret.num[rI][cJ] += num[rI][mid] * d.num[mid][cJ] % mod;\n\t\t\t\t\tret.num[rI][cJ] %= mod;\n\t\t\t\t}\n\t\t//\u8bbf\u95ee\u4e00\u6bb5\u8fde\u7eed\u7a7a\u95f4\n\t\treturn ret;\n\t}\n} yuan(0, 0), zhuan(0, 0), res(0, 0);\nvoid matPow(int ci)\n{\n\tres = yuan;\n\tfor (; ci; ci >>= 1, zhuan = zhuan * zhuan)\n\t\tif (ci & 1)\n\t\t\tres = res * zhuan;\n\treturn ;\n}\nvoid initC()\n{\n\tC[0][0] = 1;\n\tfor (int down = 1; down <= 90; ++down)\n\t{\n\t\tC[down][0] = 1;\n\t\tfor (int up = 1; up <= down; ++up)\n\t\t{\n\t\t\tC[down][up] = C[down - 1][up] + C[down - 1][up - 1];\n\t\t\tC[down][up] %= mod;\n\t\t}\n\t}\n\treturn ;\n}\n\nint main()\n{\n\tfreopen(\"sequence.in\", \"r\", stdin);\n\tfreopen(\"sequence.out\", \"w\", stdout);\n\tscanf(\"%d%d%d%d\", &seqLen, &aExp, &bExp, &mod);\n\tmatSiz = 2 * (aExp + bExp + 1);\n\tyuan.row = 1;\n\tyuan.col = matSiz;\n\tyuan.num[1][1] = 1;\n\tzhuan.row = matSiz;\n\tzhuan.col = matSiz;\n\tfor (int rI = 1; rI <= matSiz / 2; ++rI)\n\t{\n\t\tzhuan.num[rI][rI] = 1;\n\t}\n\tfor (int rI = 1; rI <= matSiz / 2; ++rI)\n\t{\n\t\tzhuan.num[rI + matSiz / 2][rI] = 1;\n\t}\n\tinitC();\n\tfor (int rI = 1; rI <= matSiz / 2; ++rI)\n\t{\n\t\tfor (int cJ = matSiz / 2 + 1; cJ <= matSiz; ++cJ)\n\t\t{\n\t\t\tzhuan.num[rI][cJ] = C[cJ - matSiz / 2 - 1][rI - 1];\n\t\t}\n\t}\n\tmatPow(seqLen);\n//\tres = res * yuan;\u8fd9\u53e5\u8bdd\u5df2\u7ecf\u5728 matPow \u91cc\u9762\u52a0\u8fc7\u4e86\n\tll nPow = 1, ans = 0;\n\tfor (int ci = 0; ci <= aExp; ++ci)\n\t{\n\t\tll pro = nPow * C[aExp][ci] % mod * ((aExp - ci) & 1 ? -1 : 1);\n\t\tpro = (pro + mod) % mod;\n\t\t//\u8fd9\u91cc\u5e94\u8be5\u6a21\u4e00\u4e0b\n\t\tans += (res.num[1][matSiz / 2 - ci] % mod + res.num[1][matSiz - ci]) * pro % mod;\n\t\tans %= mod;\n\t\tnPow = nPow * seqLen % mod;\n\t}\n\tprintf(\"%lld\\n\", ans);\n\tfclose(stdin);\n\tfclose(stdout);\n\treturn 0;\n}\n```",
        "postTime": 1575170882,
        "uid": 75715,
        "name": "KokiNiwa",
        "ccfLevel": 0,
        "title": "[CQOI2018]\u4ea4\u9519\u5e8f\u5217"
    },
    {
        "content": "\u6211\u5c31\u662f\u4e0d\u7528\u77e9\u9635\u5feb\u901f\u5e42\uff01\n\n\u9898\u610f\uff1a\u4e00\u4e2a $ \\rm 01 $ \u5e8f\u5217\u4e3a\u5408\u6cd5\u7684\u5f53\u4e14\u4ec5\u5f53\u6ca1\u6709\u4e24\u4e2a\u76f8\u90bb\u7684 $ 1 $\uff0c\u82e5 $ 1 $ \u7684\u4e2a\u6570\u4e3a $ x $\uff0c$ 0 $ \u7684\u4e2a\u6570\u4e3a $ y $\uff0c\u8fd9\u4e2a $ \\rm 01 $ \u7684\u4ef7\u503c\u4e3a $ x^a \\times y^b $\u3002\n\n\u8bf7\u6c42\u51fa\u6240\u6709\u957f\u5ea6\u4e3a $ n $ \u7684 $ \\rm 01 $ \u5e8f\u5217\u7684\u4ef7\u503c\u4e4b\u548c\uff0c\u5bf9 $ m $ \u53d6\u6a21\u3002\n\n\u8fd9\u9053\u9898\u7684\u9634\u95f4\u4e4b\u5904\u5c31\u5728\u4e8e $ m $ \u4e0d\u4e00\u5b9a\u662f\u8d28\u6570\u3002\u3002\u3002\n\n\u9996\u5148\u6211\u4eec\u679a\u4e3e $ 1 $ \u7684\u4e2a\u6570\uff0c\u53ef\u4ee5\u5f97\u5230\u7b54\u6848\u4e3a\uff1a\n$$ \\sum_{i=0}^n\\binom {n-i+1} ii^b(n-i)^a $$\n\u5982\u679c $ m $ \u662f\u8d28\u6570\u7684\u8bdd\uff0c\u8fd9\u91cc\u5c31\u53ef\u4ee5\u76f4\u63a5 $ O(n) $ \u8ba1\u7b97\u4e86\uff0c\u53ef\u60dc\u5e76\u4e0d\u662f\u3002\n\n\u8003\u8651\u4f7f\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c55\u5f00\u540e\u8005\uff1a\n$$ \\sum_{i=0}^{\\infty}\\binom {n-i+1}ii^b\\sum_{j=0 }^a\\binom a jn^{a-j}(-i)^j $$\n$$ \\sum_{j=0}^a\\binom a jn^{a-j}(-1)^j\\sum_{i=0}^{\\infty}\\binom {n-i+1} ii^{b+j} $$\n\u73b0\u5728\u7684\u95ee\u9898\u5c31\u662f\u5982\u4f55\u5904\u7406 $ \\sum_{i=0}^{\\infty}\\binom {n-i+1}ii^k $\u3002\n\n\u4f7f\u7528 $ \\binom n m=\\binom {n-1} m+\\binom {n-1}{m-1} $ \u5c55\u5f00\u7ec4\u5408\u6570\uff1a\n$$ f_{n,k}=\\sum_{i=0}^{\\infty}\\binom {n-i} i i^k $$\n$$ f_{n,k}=\\sum_{i=0}^{\\infty}(\\binom {n-i-1} i+\\binom {n-i-1}{i-1})i^k $$\n$$ f_{n,k}=\\sum_{i=0}^{\\infty}\\binom {n-i-1}i i^k+\\sum_{i=1}^{\\infty}\\binom {n-i-1}{i-1} i^k $$\n$$ f_{n,k}=f_{n-1,k}+\\sum_{i=0}^{\\infty}\\binom {n-i-2} i(i+1)^k $$\n\u628a\u540e\u9762\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c55\u5f00\uff1a\n$$ \\sum_{i=0}^{\\infty}\\binom {n-i-2} i\\sum_{j=0}^k \\binom k ji^j $$\n$$ \\sum_{j=0}^k\\binom k j\\sum_{i=0}^{\\infty}\\binom {n-i-2} ii^j $$\n\u6240\u4ee5\uff1a\n$$ f_{n,k}=f_{n-1,k}+\\sum_{j=0}^k\\binom k jf_{n-2,j} $$\n\u5982\u679c\u4ed4\u7ec6\u70b9\u513f\u53ef\u4ee5\u53d1\u73b0\u8fd9\u91cc\u5b9e\u9645\u4e0a\u662f\u5728\u8bf4\uff1a\n$$ f_{n,k}=f_{n-1,k}+f_{n-2,k}+\\sum_{j=0}^{k-1}\\binom k jf_{n-2,j} $$\n\u4e5f\u5c31\u662f\u8bf4 $ f_{i,j} $ \u5bf9 $ f_{n,k} $ \u7684\u8d21\u732e\u4e0e\u6590\u6ce2\u90a3\u5951\u6570\u5217\u6709\u5173\uff0c\u4e3a $ \\binom k jfib_{n-i-2} $\u3002\n\n\u63a5\u4e0b\u6765\u5c31\u5f88\u597d\u529e\u4e86\u3002\n\n\u8bbe $ F_k(x)=\\sum_{i=0}^{\\infty}f_{i,k}x^i $\n\n\u9996\u5148\u5f88\u660e\u663e\uff0c\u6839\u636e\u5b9a\u4e49\u6709 $ F_0(x)=\\frac 1 {1-x-x^2} $\u3002\uff08\u4e5f\u5c31\u662f\u6590\u6ce2\u90a3\u5951\u6570\u5217\uff09\n\n\u4e8e\u662f\u6709\uff1a\n$$ F_k(x)=\\frac {x^2} {1-x-x^2}\\sum_{i=0}^{k-1}\\binom k iF_i(x) $$\n\n\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u8fd9\u4e2a\u76f4\u63a5\u77e5\u9053 $ F_1(x)=\\frac 1 {(1-x-x^2)^2} $\u3002\n\n\u90a3\u4e48 $ F_2(x) $ \u5462\uff1f\n$$ \\frac {\\binom 2 1}{(1-x-x^2)^3}+\\frac {\\binom 2 0}{(1-x-x^2)^2}=\\frac {\\binom 2 1+\\binom 2 0(1-x-x^2)^1}{(1-x-x^2)^3} $$\n\u5408\u7406\u731c\u6d4b $ F_k(x) $ \u7684\u5206\u6bcd\u4e3a $ (1-x-x^2)^{k+1} $\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ea\u7ef4\u62a4\u5206\u5b50\uff0c\u4e0d\u7ef4\u62a4\u5206\u6bcd\u3002\n\n\u90a3\u4e48\u5206\u5b50\u6240\u5bf9\u5e94\u7684\u9012\u63a8\u5f0f\u5c31\u5e94\u8be5\u662f $ H_k(x)=\\frac {x^2}{1-x-x^2}\\sum_{i=0}^{k-1}\\binom k iH_i(x)(1-x-x^2)^{k-i} $\u3002\n\n\u4e8e\u662f\u6211\u4eec\u4f7f\u7528\u7c7b\u4f3c\u79e6\u4e5d\u97f6\u6c42\u591a\u9879\u5f0f\u7684\u503c\u7684\u65b9\u6cd5\u53ef\u4ee5\u505a\u5230 $ O(k^3) $ \u5904\u7406\u51fa $ H_0(x) \\sim H_k(x) $\uff0c\u7136\u540e\u518d\u4f7f\u7528\u5e38\u7cfb\u6570\u9f50\u6b21\u7ebf\u6027\u9012\u63a8\u7b97\u4e00\u4e0b\u5c31\u662f~~\u548c\u6bd4\u66b4\u529b\u77e9\u5feb\u8fd8\u6162\u7684~~$ O((a+b)^3+a(a+b)^2\\log n) $ \u4e86\u3002\n\n~~\u7b2c\u4e8c\u79cd\u505a\u6cd5\uff1a\u6211\u4eec\u53ef\u4ee5\u5217\u4e00\u4e2a DP \u65b9\u7a0b\uff0c\u7136\u540e\u7528 BM \u5927\u529b\u731c\u51fa\u9012\u63a8\u5f0f\uff0c\u5c31\u53ef\u4ee5\u505a\u5230 $ O((a+b)^2\\log n) $ \u4e86\uff0c\u597d\u8036\uff01\uff08\u8fd9\u91cc\u6839\u636e\u76f4\u89c9\u731c\u6d4b\u9012\u63a8\u5f0f\u7684\u957f\u5ea6\u5c31\u662f a+b\uff09~~",
        "postTime": 1640755076,
        "uid": 160839,
        "name": "Prean",
        "ccfLevel": 7,
        "title": "\u751f\u6210\u51fd\u6570 \u5e38\u7cfb\u6570\u9f50\u6b21\u7ebf\u6027\u9012\u63a8 P4456\u9898\u89e3"
    }
]
[
    {
        "content": "## \u9898\u76ee\u5206\u6790\n\n\u4e00\u4e2a\u6e10\u8fdb\u66f4\u4f18\u4f46\u662f\u5728\u8fd9\u9898\u6570\u636e\u8303\u56f4\u4e0b\u8ddf $O({knm\\over \\omega})$ \u66b4\u529b\u5dee\u4e0d\u591a\u7684\u505a\u6cd5\u3002\n\n\u9996\u5148\u6211\u4eec\u89c2\u5bdf $\\text{C-Algae}$ \u7684\u6027\u8d28\uff0c\u53d1\u73b0\u8fd9\u4e24\u79cd\u64cd\u4f5c\u662f\u5bf9\u79f0\u7684\uff0c\u6240\u4ee5\u6709\uff1a**\u82e5 $G$ \u4e3a $\\text{C-Algae}$\uff0c\u5219 $G$ \u7684\u8865\u56fe\u4e5f\u4e3a $\\text{C-Algae}$\uff08\u53cd\u4e4b\u540c\u7406\uff09**\uff0c\u539f\u56e0\u662f\u8865\u56fe\u53ef\u4ee5\u6bcf\u6b21\u7528\u4e0e\u539f\u56fe\u76f8\u53cd\u7684\u5408\u5e76\u65b9\u5f0f\u9020\u51fa\u6765\u3002\u4e8e\u662f\u6211\u4eec\u4f1a\u4e86\u4e00\u4e2a\u66b4\u529b\u505a\u6cd5\uff0c\u5373\u8003\u8651\u5012\u63a8\u64cd\u4f5c\uff0c\u4ea4\u66ff\u8fdb\u884c\u4ee5\u4e0b\u4e24\u4e2a\u62c6\u5206\u6b65\u9aa4\uff0c\u82e5\u6700\u7ec8\u80fd\u628a\u56fe\u5168\u90fd\u62c6\u6210\u5355\u70b9\u5219\u8bf4\u660e\u8be5\u56fe\u4e3a $\\text{C-Algae}$\u3002\n\n1. \u628a\u539f\u56fe\u5206\u6210\u591a\u4e2a\u4e0d\u8fde\u901a\u7684\u5b50\u56fe\uff08\u6c42\u8fde\u901a\u5757\uff09\uff0c\u7136\u540e\u5206\u522b\u68c0\u67e5\u5404\u4e2a\u5b50\u56fe\u3002\n\n2. \u8981\u4e48\u628a\u53cd\u56fe\u5206\u6210\u591a\u4e2a\u4e0d\u8fde\u901a\u7684\u5b50\u56fe\uff08\u6c42\u53cd\u56fe\u8fde\u901a\u5757\uff09\uff0c\u7136\u540e\u5206\u522b\u68c0\u67e5\u5404\u4e2a\u5b50\u56fe\u7684\u53cd\u56fe\u3002\n\n\u5206\u6790\u65f6\u95f4\u590d\u6742\u5ea6\u3002\u5355\u6b21\u64cd\u4f5c $1,2$ \u5206\u522b\u662f $O(m)$ \u548c $O(n^2-m)$ \u7684\uff0c\u800c\u64cd\u4f5c $2$ \u82e5\u80fd\u6709\u6548\u4f1a\u6d88\u8017\u6389\u81f3\u5c11 $O(n)$ \u6761\u8fb9\uff0c\u6545\u81f3\u591a\u8fdb\u884c $O({m\\over n})$ \u8f6e\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(knm)$\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u4f18\u5316\u62c6\u5206\u7684\u6b65\u9aa4\u3002\u53d1\u73b0\u6211\u4eec\u5e94\u8be5\u4e0d\u540c\u60c5\u51b5\u5dee\u522b\u5bf9\u5f85\u5730\u5bf9\u64cd\u4f5c $1,2$ \u91c7\u53d6\u4e0d\u4e00\u6837\u7684\u65b9\u5f0f\u6c42\u8fde\u901a\u5757\u3002\u64cd\u4f5c $1$ \u5728\u7a00\u758f\u56fe\u4e0a\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e\u8fb9\uff0c\u5355\u6b21\u65f6\u95f4\u590d\u6742\u5ea6 $O(n+m)$\u3002\u800c\u64cd\u4f5c $2$ \u7684\u56fe\u8fc7\u4e8e\u7a20\u5bc6\uff0c\u53ef\u4ee5\u679a\u4e3e\u70b9\u7136\u540e\u68c0\u67e5\u4e0d\u5b58\u5728\u7684\u8fb9\uff0c\u56e0\u4e3a\u81f3\u591a\u4f1a\u67e5\u5230 $m$ \u6761\u4e0d\u5b58\u5728\u7684\u8fb9\uff0c\u6545\u5355\u6b21\u65f6\u95f4\u590d\u6742\u5ea6\u540c\u6837\u4e3a $O(n+m)$\u3002\u7531\u4e8e $m\\leq n^2$\uff0c\u6545\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(k(n+m)\\times{\\min(m,n^2)\\over n})=O(k(n+m)\\sqrt m)$\uff0c\u5e38\u6570\u4e0d\u5927\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n## \u4ee3\u7801\n\n\u5b9e\u73b0\u53ef\u89c1\u4e0b\u9762\u4ee3\u7801\uff0c\u611f\u89c9\u8fd8\u7b97\u7b80\u6d01\u3002\n\n```cpp\n/*\n  author: PEKKA_l  \n */\n#include <iostream>\n#include <cstring>\n#include <algorithm>\n#include <queue>\n#include <unordered_map>\n#include <vector>\nusing namespace std;\n#define pb push_back\n\nint T,n,m,u,v;\nvector <int> e[10005];\nunordered_map <int,int> s;\nbool isb(int x,int y) {if(x>y) swap(x,y); return s.count(x*20000+y);}\n\nint zta[10005],ztb[10005],ztc[10005],cntb,cntc,sza[10005],szc[10005];\nint nowb[10005],nxt[20005],frm[20005];\n\nqueue <int> Q;\nvoid ins(int k,int x) {nxt[nowb[k]]=x; frm[x]=nowb[k]; nowb[k]=x;}\nvoid del(int x) {nxt[frm[x]]=nxt[x]; frm[nxt[x]]=frm[x]; }\nvoid bfs(int x,int k)\n{\n\tQ.push(x); ztb[x]=cntb; ins(ztb[x],x);\n\twhile(!Q.empty())\n\t{\n\t\tint nr=Q.front(); Q.pop();\n\t\tfor(auto i:e[nr]) {if(!ztb[i]&&zta[i]==k) {ztb[i]=cntb; Q.push(i); ins(ztb[i],i);}}\n\t}\n}\nvoid bfs2(int x,int k)\n{\n\tQ.push(x); ztc[x]=cntc; szc[cntc]++; del(x);\n\twhile(!Q.empty())\n\t{\n\t\tint nr=Q.front(); Q.pop();\n\t\tfor(int i=nxt[k+10000];i;i=nxt[i])\n\t\t{\n\t\t\tif(!isb(nr,i)) {ztc[i]=cntc; szc[cntc]++; del(i); Q.push(i);}\n\t\t}\n\t}\n}\nvoid czc(int k) {while(nxt[k+10000]) {int nr=nxt[k+10000]; cntc++; bfs2(nr,k);}}\n\nsigned main()\n{\n\tcin>>T;\n\twhile(T--)\n\t{\n\t\tcin>>n>>m; s.clear(); for(int i=1;i<=n;i++) e[i].clear();\n\t\tfor(int i=1;i<=m;i++) {cin>>u>>v; if(u>v) swap(u,v); e[u].pb(v); e[v].pb(u); s[u*20000+v]=1;}\n\t\tfor(int i=1;i<=n;i++) zta[i]=1; sza[1]=n;\n\t\twhile(1)\n\t\t{\n\t\t\tmemset(ztb,0,sizeof(ztb)); cntb=0; for(int i=1;i<=n;i++) nowb[i]=i+10000;\n\t\t\tmemset(nxt,0,sizeof(nxt)); memset(frm,0,sizeof(frm));\n\t\t\tfor(int i=1;i<=n;i++) if(!ztb[i]) {cntb++; bfs(i,zta[i]);}\n\t\t\tmemset(ztc,0,sizeof(ztc)); cntc=0; memset(szc,0,sizeof(szc));\n\t\t\tfor(int i=1;i<=cntb;i++) czc(i);\n\t\t\tbool yes=1,no=0;\n\t\t\tfor(int i=1;i<=n;i++)\n\t\t\t{\n\t\t\t\tif(sza[zta[i]]==szc[ztc[i]]) no=1;\n\t\t\t\tif(szc[ztc[i]]>2) yes=0;\n\t\t\t}\n\t\t\tif(no) {cout<<\"NIE\"<<endl; break;}\n\t\t\tif(yes) {cout<<\"TAK\"<<endl; break;}\n\t\t\tmemcpy(zta,ztc,sizeof(ztc)); memcpy(sza,szc,sizeof(szc));\n\t\t}\n\t}\n}\n```\n",
        "postTime": 1684035815,
        "uid": 529697,
        "name": "PEKKA_l",
        "ccfLevel": 6,
        "title": "P5913 \u9898\u89e3"
    }
]
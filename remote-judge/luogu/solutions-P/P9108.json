[
    {
        "content": "\u8003\u8651 dp\uff0c\u8bbe $f_{i,j}$ \u8868\u793a\u524d $i$ \u5217\uff0c\u5f3a\u5236\u7b2c $i$ \u5217\u7b2c $j$ \u884c\u88ab\u6d82\u4e0a\uff0c\u4ee5\u53ca\u7b2c $i$ \u5217\u7b2c $j+1\\sim m$ \u884c\u6ca1\u6709\u88ab\u6d82\u4e0a\u7684\u65b9\u6848\u6570\u3002\uff08\u5373\u5f3a\u5236\u6d82\u4e0a\u7684\u533a\u95f4\u7684\u4e0b\u7aef\u70b9\u662f $j$\uff09\n\n\u6ce8\u610f\u5230\u8fd9\u7b49\u4e8e\u524d $i$ \u5217\uff0c\u5f3a\u5236\u7b2c $i$ \u5217\u7b2c $m-j+1$ \u884c\u88ab\u6d82\u4e0a\uff0c\u4ee5\u53ca\u7b2c $i$ \u5217\u7b2c $1\\sim m-j$ \u884c\u6ca1\u6709\u88ab\u6d82\u4e0a\u7684\u65b9\u6848\u6570\u3002\uff08\u5373\u5f3a\u5236\u6d82\u4e0a\u7684\u533a\u95f4\u7684\u4e0a\u7aef\u70b9\u662f $m-j+1$\uff09\n\n\u5219\u4ece\u7b2c $i-1$ \u5217\u5411\u7b2c $i$ \u5217\u8f6c\u79fb\u65f6\uff0c\u8003\u8651\u5f3a\u5236\u7b2c $i-1$ \u5217\u6d82\u4e0a\u7684\u533a\u95f4\u7684\u4e0a\u7aef\u70b9\u662f $k$\u3002\u6211\u4eec\u8981\u6c42 $k\\leq j$\u3002\n\n\u540c\u65f6\uff0c\u7b2c $i$ \u5217\u7684\u533a\u95f4\u4e0a\u7aef\u70b9\u53ef\u4ee5\u5728 $1\\sim j$ \u91cc\u9762\u4efb\u610f\u9009\u62e9\uff0c\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u8f6c\u79fb\u5f0f\uff1a\n\n$$f_{i,j}=j\\cdot\\sum_{k=m-j+1}^mf_{i-1,k}$$\n\n\u7136\u800c\u8fd9\u662f\u9519\u7684\uff0c\u56e0\u4e3a\u8fd9\u6837\u53ef\u80fd\u7edf\u8ba1\u5230 $i-1$ \u5217\u7684\u533a\u95f4\u4e0b\u7aef\u70b9\u5728 $i$ \u5217\u7684\u533a\u95f4\u4e0a\u7aef\u70b9\u4e0a\u9762\u7684\u60c5\u51b5\u3002\n\n\u8003\u8651\u76f4\u63a5\u628a\u8fd9\u79cd\u60c5\u51b5\u5bb9\u65a5\u6389\u3002\u4e3a\u4e86\u7edf\u8ba1\u8fd9\u79cd\u60c5\u51b5\u7684\u6570\u91cf\uff0c\u6211\u4eec\u518d\u4ece $i-1$ \u5217\u7684\u4e0b\u7aef\u70b9\u8003\u8651\uff0c\u5f97\u5230\u6700\u7ec8\u7684\u8f6c\u79fb\u5f0f\uff1a\n\n$$f_{i,j}=j\\cdot\\sum_{k=m-j+1}^mf_{i-1,k}-\\sum_{k=1}^{j-1}(j-k)f_{i-1,k}$$\n\n\u4f7f\u7528\u4e00\u4e9b\u524d\u7f00\u548c\u4f18\u5316\uff0c\u590d\u6742\u5ea6 $O(nm)$\u3002\n\n```cpp\nlong long mod, f[2][10000005];\n\nint main() {\n    cin >> n >> m >> mod;\n    for (int i = 1;i <= m;i++) f[1][i] = i;\n    for (int i = 2;i <= n;i++) {\n        long long sum1 = 0, sum2 = 0, sum3 = 0;\n        for (int j = 1;j <= m;j++) {\n            sum1 = (sum1 + f[i - 1 & 1][m - j + 1]) % mod;\n            f[i & 1][j] = (sum1 * j - sum3 + mod) % mod;\n            sum2 = (sum2 + f[i - 1 & 1][j]) % mod;\n            sum3 = (sum3 + sum2) % mod;\n        }\n    }\n    long long ans = 0;\n    for (int i = 1;i <= m;i++) ans = (ans + f[n & 1][i]) % mod;\n    cout << ans << endl;\n    return 0;\n}\n```",
        "postTime": 1684488430,
        "uid": 61088,
        "name": "Solystic",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P9108 [PA2020] Malowanie p\u0142otu"
    }
]
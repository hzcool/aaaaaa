[
    {
        "content": "\u6765\u4ecb\u7ecd\u4e00\u4e0b\u5dee\u5206\n\n\n\u8bbe\u6570\u7ec4a[]={1,6,8,5,10}\uff0c\u90a3\u4e48\u5dee\u5206\u6570\u7ec4b[]={1,5,2,-3,5}\n\n\n\u4e5f\u5c31\u662f\u8bf4b[i]=a[i]-a[i-1];(a[0]=0;)\uff0c\u90a3\u4e48a[i]=b[1]+....+b[i];(\u8fd9\u4e2a\u5f88\u597d\u8bc1\u7684)\u3002\n\n\n\u5047\u5982\u533a\u95f4[2,4]\u90fd\u52a0\u4e0a2\u7684\u8bdd\n\n\na\u6570\u7ec4\u53d8\u4e3aa[]={1,8,10,7,10}\uff0cb\u6570\u7ec4\u53d8\u4e3ab={1,7,2,-3,3};\n\n\n\u53d1\u73b0\u4e86\u6ca1\u6709\uff0cb\u6570\u7ec4\u53ea\u6709b[2]\u548cb[5]\u53d8\u4e86\uff0c\u56e0\u4e3a\u533a\u95f4[2,4]\u662f\u540c\u65f6\u52a0\u4e0a2\u7684,\u6240\u4ee5\u5728\u533a\u95f4\u5185b[i]-b[i-1]\u662f\u4e0d\u53d8\u7684.\n\n\n\u6240\u4ee5\u5bf9\u533a\u95f4[x,y]\u8fdb\u884c\u4fee\u6539,\u53ea\u7528\u4fee\u6539b[x]\u4e0eb[y+1]:\n\n\nb[x]=b[x]+k;b[y+1]=b[y+1]-k;\n",
        "postTime": 1510235758,
        "uid": 33857,
        "name": "Lyp10000",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "\u8fd9\u4e2a\u9898\u76ee\u662f\u6811\u72b6\u6570\u7ec4\u7684\u4e00\u4e2a\u62d3\u5c55,\u5728\u6811\u72b6\u6570\u7ec4\u4e2d\u53ef\u4ee5\u7528\u524d i \u9879\u7684\u548c\u6765\u8868\u793a\u7b2c i \u4e2a\u6570.\n\n\u90a3\u4e48\u5f53\u5bf9 x ~ y \u7684\u533a\u95f4\u8fdb\u884c\u4fee\u6539\u7684\u65f6\u5019\u9700\u8981\u5728\u6811\u72b6\u6570\u7ec4\u4e2d\u7684\u7b2c x \u4e2a\u4f4d\u7f6e + k, \u7b2c y + 1 \u4e2a\u4f4d\u7f6e -k\n\n\u8fd9\u6837\u4fbf\u7ef4\u62a4\u4e86\u8fd9\u4e2a\u6811\u72b6\u6570\u7ec4\n\n\u8f93\u51fa\u65f6\u5019\u76f4\u63a5\u8f93\u51fa\u67e5\u8be2\u5373\u53ef\n\n\n\n\n\n\n\n\n\n    \n    \n\n    \n    \n\n    \n    \n        \n            \n            \n            \n    \n```cpp\n#include <iostream>\n#include <cstdio>\n#define lowbit(x) x & -x\nusing namespace std;\nlong long tree[500005];\nint n, m;\nvoid add(int x, long long num) {\n    while (x <= n) {\n        tree[x] += num;\n        x += lowbit(x);\n    }\n}\nlong long query(int x) {\n    long long ans = 0;\n    while (x) {\n        ans += tree[x];\n        x -= lowbit(x);\n    }\n    return ans;\n}\nint main() {\n    freopen(\"in.txt\", \"r\", stdin);\n    scanf(\"%d%d\", &n, &m);\n    long long last = 0, now;\n    for (int i = 1; i <= n; i++) {\n        scanf(\"%lld\", &now);\n        add(i, now - last);\n        last = now;\n    }\n    int flg;\n    while (m--) {\n        scanf(\"%d\", &flg);\n        if (flg == 1) {\n            int x, y;\n            long long k;\n            scanf(\"%d%d%lld\", &x, &y, &k);\n            add(x, k);\n            add(y + 1, -k);\n        } else if (flg == 2) {\n            int x;\n            scanf(\"%d\", &x);\n            printf(\"%lld\\n\", query(x));\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1504854729,
        "uid": 25845,
        "name": "Snitro",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "## \u6982\u62ec\n\u6811\u72b6\u6570\u7ec4\u662f\u4e2a\u597d\u4e1c\u897f\u554a~\uff08\u4ee3\u7801\u91cf\u5c11orz\uff09\n## \u7b80\u4ecb\n\u6811\u72b6\u6570\u7ec4\u662f\u7528\u6570\u636e\u538b\u7f29\u7684\u601d\u60f3\u7531\u4e8c\u8fdb\u5236\u5b9e\u73b0\u7684\u6570\u636e\u7ed3\u6784\u3002\u6709\u5355\u70b9\u4fee\u6539+\u533a\u95f4\u67e5\u8be2\u6216\u533a\u95f4\u4fee\u6539+\u5355\u70b9\u67e5\u8be2\u7684\u4f5c\u7528\u3002\n## \u5b9e\u73b0\u5355\u70b9\u4fee\u6539&\u533a\u95f4\u67e5\u8be2\n\u9996\u5148\u6211\u4eec\u6765\u770b\u770b\u66b4\u529b\u7684\u6548\u7387\u3002q\u7ec4\u8be2\u95ee\uff0c\u6781\u7aef\u60c5\u51b5\u4e0bn\u4e2a\u6570\u7684\u4fee\u6539\uff0c\u6548\u7387\u4e3a _O(n q)_ \u3002n\uff0cq\u4e3a500000\u65f6\u4e00\u5b9a\u4f1a\u70b8\u3002\n### \u5207\u5165\u70b9\uff1alowbit\u51fd\u6570\n\u7531\u4e8e\u7535\u8111\u4e00\u79cd\u53eb\u505a\u8865\u7801\u7684\u64cd\u4f5c\uff08\u7531\u4e8e\u7535\u8111\u662f\u4e8c\u8fdb\u5236\uff0c\u5b83\u4eec\u5b58\u7684\u76f8\u53cd\u6570\u662f\u5b83\u7684\u53d6\u53cd+1\uff09\uff0c\u4e00\u4e2a\u6570\u4e0e\u5b83\u7684\u76f8\u53cd\u6570\u505a\u4e0e\u64cd\u4f5c\u65f6\u4f1a\u8fd4\u56de\u4e8c\u8fdb\u5236\u4e0b\u6700\u53f3\u8fb9\u76841\u7684\u4f4d\u7f6e\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff1a\n6&-6=2\n\u5c066\u53d8\u6210\u4e8c\u8fdb\u5236\uff1a110\u3002\u5176\u4e2d\u6700\u53f3\u4fa7\u76841\u52a0\u7c97\u5b57\u4f53\uff1a1**1**0\u5219\u8fd4\u56de\u7684\u662f\u4e8c\u8fdb\u5236\u4e0b10\u7684\u503c\uff1a2\u3002\u5f97\u5230\u4ee3\u7801\uff1a\n```\n//ll\u5c31\u662flong long\nll lowbit(ll num){\n\treturn num&-num;\n}\n```\n### \u5229\u7528\u8fd9\u4e2a\u6027\u8d28\u5efa\u7acb\u6811\u72b6\u6570\u7ec4\uff1a\n\u4e3a\u4e86\u7b80\u5316\u533a\u95f4\u4fee\u6539\u7684\u6548\u7387\uff0c\u6211\u4eec\u9700\u8981\u5efa\u7acb\u8fd9\u6837\u7684\u4e00\u4e2a\u6570\u7ec4\uff1a\u6570\u7ec4\u4e2d\u7b2ck\u4f4d\u7684\u503c\u4e3a\u539f\u6570\u7ec4\u4e2d\u7684\u4e00\u6bb5\u533a\u95f4\u548c\uff0c\u8fd9\u4e2a\u533a\u95f4\u7684\u957f\u5ea6\u662flowbit(k),\u7ec8\u70b9\u662fk\u3002\n\u6bd4\u5982\uff1a\u8f93\u5165\u4e00\u4e2a\u6570\u7ec4\uff0c\u90a3\u4e48\u6211\u4eec\u6240\u5efa\u7acb\u7684\u6570\u7ec4\uff1a\n- \u7b2c\u4e00\u4f4d\uff081\u5728\u4e8c\u8fdb\u5236\u4e0b=**1** \u4e8c\u8fdb\u5236\u4e0b\u76841=1\uff09\u7684\u503c\u4e3a\u8f93\u5165\u7684\u6570\u7ec4\u7684\u7b2c\u4e00\u4f4d\u5f80\u524d\u7684\u4e00\u4f4d\u7684\u548c\uff0c\u4e5f\u5c31\u662f\u7b2c\u4e00\u4f4d\u3002\n- \u7b2c\u4e8c\u4f4d\uff082\u5728\u4e8c\u8fdb\u5236\u4e0b=**1**0 \u4e8c\u8fdb\u5236\u4e0b\u768410=2\uff09\u7684\u503c\u4e3a\u8f93\u5165\u7684\u6570\u7ec4\u7684\u7b2c\u4e8c\u4f4d\u5f80\u524d\u4e24\u4f4d\u7684\u548c\uff0c\u7b2c\u4e00\u4f4d\u548c\u7b2c\u4e8c\u4f4d\u3002\n- \u7b2c\u4e09\u4f4d\uff083\u5728\u4e8c\u8fdb\u5236\u4e0b=1**1** \u4e8c\u8fdb\u5236\u4e0b\u76841=1\uff09\u7684\u503c\u4e3a\u8f93\u5165\u7684\u6570\u7ec4\u7684\u7b2c\u4e09\u4f4d\u5f80\u524d\u4e00\u4f4d\u7684\u548c\uff0c\u4e5f\u5c31\u662f\u7b2c\u4e09\u4f4d\u3002\n- \u7b2c\u56db\u4f4d\u7684\u503c\uff084\u5728\u4e8c\u8fdb\u5236\u4e0b=**1**00 \u4e8c\u8fdb\u5236\u4e0b\u7684100=4\uff09\u7684\u503c\u4e3a\u8f93\u5165\u7684\u6570\u7ec4\u7684\u7b2c\u56db\u4f4d\u5f80\u524d\u56db\u4f4d\u7684\u548c\uff0c\u4e5f\u5c31\u662f\u7b2c\u4e00\u4f4d\uff0c\u7b2c\u4e8c\u4f4d\uff0c\u7b2c\u4e09\u4f4d\u4ee5\u53ca\u7b2c\u56db\u4f4d\u3002\n\n\u6211\u4eec\u5c31\u79f0\u8fd9\u79cd\u6570\u7ec4\u4e3a\u6811\u72b6\u6570\u7ec4\n#### \u4ee3\u7801\n```\nvoid build(ll s,ll num){\n\tfor(ll i=s;i<=n;i+=lowbit(i)) tree[i]+=num;//\u5f53s\u5728i\u7684\u8303\u56f4\u5185 \u7b2cnum\u4f4d\u6570\u7ec4\u52a0\u4e0anum \n}\n```\n\u8ddf\u7740\u4ee3\u7801\u8d70\u4e00\u904d\uff1a\n- \u5047\u8bbe\u8f93\u5165\u7684n=5\uff0c\u8f93\u5165\u7684\u6570\u4e3a1 5 4 2 3\uff08\u6837\u4f8b\uff09\n- \u8f93\u5165\u7b2c\u4e00\u4e2a\u6570\u65f6s=1\uff0cnum=1\u3002\u52a0\u4e0a\u7684\u6811\u72b6\u6570\u7ec4\u6570\u7ec4\u4f4d\u6570\u4e3a\u7b2c\u4e00\u4f4d\uff0c\u7b2c\u4e8c\u4f4d\uff0c\u7b2c\u56db\u4f4d\u3002\u6811\u72b6\u6570\u7ec4\u4e3a\uff1a1 1 0 1 0\n- \u8f93\u5165\u7b2c\u4e8c\u4e2a\u6570\u65f6s=2\uff0cnum=5\uff0c\u52a0\u4e0a\u7684\u4f4d\u7f6e\u4e3a\u7b2c\u4e8c\u4f4d\uff0c\u7b2c\u56db\u4f4d\u3002\u6570\u7ec4\u4e3a1 6 0 6 0\n- \u8f93\u5165\u7b2c\u4e09\u4e2a\u6570\u65f6s=3\uff0cnum=4\uff0c\u52a0\u4e0a\u7684\u4f4d\u7f6e\u4e3a\u7b2c\u4e09\u4f4d\u3002\u6570\u7ec4\u4e3a1 6 4 10 0\n- \u8f93\u5165\u7b2c\u56db\u4e2a\u6570\u65f6s=4\uff0cnum=2\uff0c\u52a0\u4e0a\u7684\u4f4d\u7f6e\u4e3a\u7b2c\u56db\u4f4d\u3002\u6570\u7ec4\u4e3a1 6 4 12 0\n- \u8f93\u5165\u7b2c\u4e94\u4e2a\u6570\u65f6s=5\uff0cnum=3\uff0c\u52a0\u4e0a\u7684\u4f4d\u7f6e\u4e3a\u7b2c\u4e94\u4f4d\u3002\u6570\u7ec4\u4e3a1 6 4 12 3\n\n\u81f3\u6b64\uff0c\u5efa\u6811\u64cd\u4f5c\u5df2\u7ecf\u5b8c\u6210\u4e86\u3002\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2a\u64cd\u4f5c\u7684\u672c\u8d28\u5c31\u662f\u4fee\u6539\u6811\u72b6\u6570\u7ec4\u7684\u503c\uff0c\u6240\u4ee5\u5b83**\u4e5f\u662f\u5355\u70b9\u4fee\u6539\u7684\u51fd\u6570**\u3002\n### \u67e5\u8be2\u4e5f\u662f\u4e00\u6837\u7684\u3002\u6ce8\u610f\u6211\u4eec\u7684\u64cd\u4f5c\u4e0d\u662f\u533a\u95f4\u6c42\u548c\uff0c\u800c\u662f\u6c42\u4e24\u4e2a\u524d\u7f00\u548c\u7684\u5dee\uff01\n```\n//\u53cd\u7740\u7684\u5efa\u6811\u3002\u6b64\u64cd\u4f5c\u662f\u6c42\u8f93\u5165\u7684\u6570\u636e\u7b2c1\u5230\u7b2cs\u4f4d\u7684\u548c\u3002\nll ask(ll s){\n\tll ans=0;\n\tfor(ll i=s;i>=1;i-=lowbit(i)) ans+=tree[i];//\u5efa\u6811\u7684\u53cd\u64cd\u4f5c \n\treturn ans;\n}\n```\n\u4e3e\u4e00\u4e2asample\uff08example\uff09\n\u6c42\u7b2c\u4e09\u9879\u548c\u7b2c\u4e94\u9879\u4e4b\u95f4\u7684\u548c\u3002 \u672c\u8d28\u4e0a\u5c31\u662f\u6c425\u7684\u524d\u7f00\u548c\u4e0e2\u7684\u524d\u7f00\u548c\u7684\u5dee\u3002\uff081 2 3 4 5\uff09-\uff081 2\uff09=\uff083 4 5\uff09\n\n- \u5148\u6c425\u7684\u524d\u7f00\u548c\u3002\u6240\u6c42\u7684\u5c31\u662f\u7b2c5\uff0810**1**\uff09\u9879+\u7b2c4\uff08**1**00\uff09\u9879\u5c31\u662f12+3=15\u3002\n- \u518d\u6c422\u7684\u524d\u7f00\u548c\u3002\u6240\u6c42\u7684\u5c31\u662f\u7b2c2\uff08**1**0\uff09\u9879\u5c31\u662f6\u3002\n- \u6700\u540e\u4f5c\u5dee\u5c31\u662f15-6=9\u3002\n\n\u68c0\u9a8c\u4e00\u4e0b\uff0c3\u52305\u4f4d\u7684\u6c42\u548c\u5c31\u662f4+2+3=9\u3002\u6ca1\u6709\u95ee\u9898\uff01\n### \u628a\u6240\u6709\u7684\u7ed3\u5408\u8d77\u6765\u5c31\u662f\u6811\u72b6\u6570\u7ec4\u5566~\n## \u4ee3\u7801\n```\n//\u6811\u72b6\u6570\u7ec4\u4ee3\u7801 \n#include<iostream>\n#include<cstdio>\n#define ll long long\nusing namespace std;\nll n,q,m,mod,x,y,tree[500001];\nll lowbit(ll num){\n\treturn num&-num;//\u8fd4\u56de\u503c\u4e3a\u4e8c\u8fdb\u5236\u4e0bnum\u4ece\u5de6\u5f80\u53f3\u7b2c\u4e00\u4e2a1\u7684\u4f4d\u7f6e \n}\nvoid build(ll s,ll num){\n\tfor(ll i=s;i<=n;i+=lowbit(i)) tree[i]+=num;//\u5f53s\u5728i\u7684\u8303\u56f4\u5185 \u7b2cnum\u4f4d\u6570\u7ec4\u52a0\u4e0anum \n}\nll ask(ll s){\n\tll ans=0;\n\tfor(ll i=s;i>=1;i-=lowbit(i)) ans+=tree[i];//\u5efa\u6811\u7684\u53cd\u64cd\u4f5c \n\treturn ans;\n}\nint main(){\n\tscanf(\"%lld%lld\",&n,&q);\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%lld\",&m);\n\t\tbuild(i,m);//\u5efa\u7acb\u6811\u72b6\u6570\u7ec4 \n\t}\n\tfor(int i=1;i<=q;i++){\n\t\tscanf(\"%lld%lld%lld\",&mod,&x,&y);//\u8f93\u51651\u62162 \n\t\tif(mod==1) build(x,y);//\u4fee\u6539\u4e0e\u5efa\u6811\u53ef\u4ee5\u5171\u7528\u4e00\u4e2a\u51fd\u6570 \n\t\tif(mod==2) printf(\"%lld\\n\",ask(y)-ask(x-1)/*\u601d\u8003\u4e3a\u4ec0\u4e48\u662fx-1*/);//\u533a\u95f4\u67e5\u8be2\u5219\u4e3a\u53f3\u8fb9\u754c\u524d\u7f00\u548c\u51cf\u53bb\u5de6\u8fb9\u754c\u524d\u7f00\u548c \n\t}\n}\n//copy\u4e0d\u662f\u597d\u4e60\u60ef \n```\n\u5176\u4e2d\u7684\u6548\u7387\u4e3a _O\uff08q logn\uff09_ \u3002\u4e0e _O\uff08nq\uff09_ \u6709\u7740\u8d28\u7684\u5dee\u522b\u3002\n## \u5b9e\u73b0\u533a\u95f4\u4fee\u6539&\u5355\u70b9\u67e5\u8be2\n\u8fd9\u770b\u8d77\u6765\u4e0e\u5355\u70b9\u4fee\u6539&\u533a\u95f4\u67e5\u8be2\u5dee\u4e0d\u591a\uff0c\u4f46\u5b9e\u9645\u4e0a\u6709\u5f88\u5927\u7684\u533a\u522b\u3002\u5982\u679c\u6211\u4eec\u6309\u7167\u539f\u6765\u7684\u6548\u7387\uff0c\u5f97\u5230\u7684\u5c31\u662f _O(n q)_ \uff0c\u7a33\u70b8\u3002\n### \u7a81\u7834\u53e3\uff1a\u5dee\u5206\n\u601d\u8003\u4e00\u4e0b\uff0c\u5982\u679c\u533a\u95f4\u4fee\u65392\u52304\u4f4d\u4e4b\u540e\u6c42\u7b2c3\u4f4d\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u52a0\u4e0a\u4fee\u6539\u7684\u6570\u3002\u800c\u5982\u679c\u6c42\u7b2c5\u4f4d\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728\u7b2c3\u4f4d\u7684\u57fa\u7840\u4e0a\u51cf\u53bb\u4fee\u6539\u7684\u6570\u5c31\u53ef\u4ee5\u4e86\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u5728\u6570\u7ec4\u7b2c2\u4f4d\u548c\u7b2c4\u4f4d\u4e4b\u95f4\u52a0\u4e0a2\uff0c\u53ea\u9700\u8981\u5c06\u6570\u7ec4\u4ece0 0 0 0 0\u53d8\u62100 2 0 0 -2\u5373\u53ef\u3002\u5f53\u8be2\u95ee\u7b2c3\u4f4d\u65f6\uff0c\u7b54\u6848\u5c31\u662f\u8f93\u5165\u76843\u7684\u503c+0+2+0\u5373\u53ef\u3002\u5f53\u8be2\u95ee5\u65f6\uff0c\u7b54\u6848\u5c31\u662f\u8f93\u5165\u76845\u7684\u503c+0+2+0+0+-2=\u8f93\u5165\u76845\u7684\u503c+0\u3002\u8fd9\u5c31\u662f\u89e3\u6cd5\u4e86\uff01\n### \u4ee3\u7801\n```\nvoid add(ll s,ll num){\n\tchafen[s]+=num;//\u4fee\u6539\u5f97\u5230x,y,s\u65f6,\u53ea\u9700\u8981\u6c42add(x,s)\u548cadd(y,-s) \n}\n```\n\u5982\u4f55\u8ba9\u5b83\u518d\u5feb\u4e00\u4e9b\u5462\uff1f\u5982\u679c\u6211\u4eec\u5c06\u6211\u4eec\u521a\u521a\u6253\u51fa\u6765\u7684\u6811\u72b6\u6570\u7ec4\u6765\u7ef4\u62a4\u5dee\u5206\u7684\u8fd9\u4e2a\u6570\u7ec4\uff0c\u6548\u7387\u5c31\u8fbe\u5230\u6700\u9ad8\u5566~\n```\nvoid add(ll s,ll num){\n\tfor(ll i=s;i<=n;i+=lowbit(i)) tree[i]+=num;//\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u5dee\u5206\u4fee\u6539\n}\n```\n## \u67e5\u8be2\n\u4e0a\u6587\u5df2\u7ecf\u63d0\u8fc7\u4e86\uff0c\u76f4\u63a5\u4e0a\u4ee3\u7801~\n```\nll ask(ll s){\n\tll ans=0;\n\tfor(ll i=s;i>=1;i-=lowbit(i)) ans+=tree[i];//\u5bfb\u627e\u5dee\u5206\u7684\u6807\u8bb0 \n\treturn ans;\n}\n```\n## \u6700\u540e\u7684\u6700\u540e\u2014\u4ee3\u7801\n```\n//\u6811\u72b6\u6570\u7ec4\u4ee3\u7801 \n#include<iostream>\n#include<cstdio>\n#define ll long long\nusing namespace std;\nll n,q,mod,x,y,s,inn[500001],tree[500001];\nll lowbit(ll num){\n\treturn num&-num;//\u8fd4\u56de\u503c\u4e3a\u4e8c\u8fdb\u5236\u4e0bnum\u4ece\u5de6\u5f80\u53f3\u7b2c\u4e00\u4e2a1\u7684\u4f4d\u7f6e \n}\nvoid add(ll s,ll num){\n\tfor(ll i=s;i<=n;i+=lowbit(i)) tree[i]+=num;//\u5dee\u5206\u7684\u601d\u60f3 \n}\nll ask(ll s){\n\tll ans=0;\n\tfor(ll i=s;i>=1;i-=lowbit(i)) ans+=tree[i];//\u5bfb\u627e\u5dee\u5206\u7684\u6807\u8bb0 \n\treturn ans;\n}\nint main(){\n\tscanf(\"%lld%lld\",&n,&q);\n\tfor(int i=1;i<=n;i++) scanf(\"%lld\",&inn[i]);\n\tfor(int i=1;i<=q;i++){\n\t\tscanf(\"%lld\",&mod);//\u8f93\u51651\u62162 \n\t\tif(mod==1){\n\t\t\tscanf(\"%lld%lld%lld\",&x,&y,&s);\n\t\t\tadd(x,s);\n\t\t\tadd(y+1,-s);\n\t\t}\n\t\tif(mod==2){\n\t\t\tscanf(\"%lld\",&x);\n\t\t\tprintf(\"%lld\\n\",inn[x]+ask(x));//\u533a\u95f4\u67e5\u8be2\u5219\u4e3a\u53f3\u8fb9\u754c\u524d\u7f00\u548c\u51cf\u53bb\u5de6\u8fb9\u754c\u524d\u7f00\u548c \n\t\t}\n\t}\n}\n//copy\u4e0d\u662f\u597d\u4e60\u60ef \n```\n\u81f3\u6b64\uff0c\u6811\u72b6\u6570\u7ec4\u7b97\u662f\u5b8c\u7ed3\u5566~",
        "postTime": 1545803550,
        "uid": 64882,
        "name": "Banjamin",
        "ccfLevel": 0,
        "title": "\u6811\u72b6\u6570\u7ec4"
    },
    {
        "content": "##\u5c31\u662f\u5e38\u89c4\u5199\u6cd5\n\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u4e00\u4e2a\u5dee\u5206\u6570\u7ec4\u7684\u524d\u7f00\u548c\uff0c\u56e0\u4e3a\u53ef\u63a8\u5f97\u82e5b[i]=a[i]-a[i-1]\uff0c\u5219a[i]=b[1]+...+b[i] *(b[1]=a[1]-a[0],a[0]=0)* \u3002\n\u53ef\u53d1\u73b0a[i]\u53ea\u4e0eb[j] (j<=i)\u6709\u5173\uff0c\u82e5\u5c06b[j]\u52a0\u4e0adelta\uff0c\u5176\u540e\u6240\u6709\u503c\u90fd\u5c06\u52a0dlt\uff0c\u56e0\u6b64\u53ea\u9700\u6539\u53d8b[i]\u5c31\u53ef\u5b9e\u73b0b[i]\u5230b[n]\u7684\u533a\u95f4\u4fee\u6539\u3002\u800c\u5c06b[j+1]\u51cf\u53bbdlt\uff0c\u5bf9a[j]\u65e0\u5f71\u54cd\uff0c\u5176\u540e\u6240\u6709\u503c\u4e5f\u51cf\u53bbdlt\uff0c\u6062\u590d\u539f\u503c\uff0c\u5373\u5b9e\u73b0\u4e86\u533a\u95f4\u4fee\u6539\u64cd\u4f5c\u3002\n\u56e0\u4e3a\u6c42\u53d6a\u503c\u7528\u5230\u7684\u662f\u524d\u7f00\u548c\uff0c\u56e0\u6b64\u8bbet[i]\u4e3ab[1]\u5230b[i]\u7684\u524d\u7f00\u548c\uff0ca[i]=t[i]=b[1]+...b[i]\uff0c\u5373\u53ef\u5927\u5927\u964d\u4f4e\u65f6\u95f4\u590d\u6742\u5ea6\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\nusing namespace std;\n#define N 530000\nlong int t[N<<2],n,op,l,r,type,x,k,a[N];\ninline long int lowbit(long int &x){return x&(-x);}\nlong int getsum(long int x)\n{\n    long int sum=0;\n    while(x>0)\n    {\n        sum+=t[x];\n        x-=lowbit(x);\n    }\n    return sum;\n}\nvoid update(long int x,long int dlt)\n{\n    while(x<=n)\n    {\n        t[x]+=dlt;\n        x+=lowbit(x);\n    }\n}\nint main()\n{\n    //ios::sync_with_stdio(false);\n    cin>>n>>op;\n    for(int i=1;i<=n;i++)\n        {scanf(\"%ld\",&a[i]);update(i,a[i]-a[i-1]);}\n    while(op--)\n    {\n        scanf(\"%d\",&type);\n        if(type==2){scanf(\"%d\",&l);printf(\"%ld\\n\",getsum(l));}\n        else\n        {\n            scanf(\"%ld%ld%ld\",&l,&r,&k);\n            update(r+1,-k);\n            //\u533a\u95f4\u64cd\u4f5c\u5c31\u76f4\u63a5\u628a1\u5230\u53f3\u7aef\u70b9r+1\u7684\u5dee\u5206\u6570\u7ec4\u524d\u7f00\u548c\u51cf\u53bbk\uff0c1\u5230l\u7684\u5dee\u5206\u524d\u7f00\u548c\u52a0\u4e0ak\n            update(l,k);\n        }\n    }\n    return 0;\n}\n\n```\n#####\u6811\u72b6\u6570\u7ec4\u89e3\u91ca\u5982\u4e0b\uff1a\n\n![\u6765\u6e90\uff1a\u767e\u5ea6\u56fe\u7247\u641c\u7d22](https://ss1.bdstatic.com/70cFuXSh\\_Q1YnxGkpoWK1HF6hhy/it/u=2531321565,556560620&fm=27&gp=0.jpg)\n\n\u6811\u72b6\u6570\u7ec4\u6bcf\u4e2a\u8282\u70b9\u6240\u5b58\u7684\u503c\u90fd\u6709\u4e0d\u540c\u542b\u4e49\uff0c\u5177\u4f53\u610f\u4e49\u5219\u4e3aC[i]=A[i]+A[i-1]+....+A[i-2^k+1]\uff08k\u8868\u793ai\u7684\u4e8c\u8fdb\u5236\u672b\u5c3e\u8fde\u7eed0\u7684\u4e2a\u6570\uff09;\n\n** \u4e3e\u4e2a\u7c9f\u5b50 **\n\n```cpp\nC[1]=a[1];\nC[2]=a[2]+a[1];\nC[3]=a[3];(3='11'[2]\uff0c\u6240\u4ee5k=0\uff0ci-2^k+1=3-1+1=3)\nC[4]=a[4]+a[3]+a[2]+a[1];(4='100'\uff0ck=2\uff0ci-2^k+1=4-2^2+1=1)\n```\n\u4f9d\u6b64\u7c7b\u63a8\u3002\n\u800c\u5982\u4f55\u5f97\u5230\u4e00\u4e2a\u6570\u4e8c\u8fdb\u5236\u672b\u5c3e0\u7684\u4e2a\u6570\u5462\uff1f\u8fd9\u5c31\u9700\u8981\u7528\u5230[\u8865\u7801\uff08\u6233\u8fd9\u91cc\uff09](http://blog.csdn.net/chen\\_lady/article/details/51105535 )\u4e86\uff0c\u5177\u4f53\u89e3\u91ca\u89c1\u6b64[\u5b8c\u5168\u8ba4\u8bc6\u6811\u72b6\u6570\u7ec4](https://www.cnblogs.com/GeniusYang/p/5756975.html)\u3002\n\n\u6613\u77e5\uff08\u5047\u7684\uff0c\u4e8c\u8fdb\u5236\u6570A\u5728\u7b2ck\u4f4d\u6709\u4e2a1\u4e14\u6700\u4f4e\u4f4d\u4e0d\u4e3a1\uff0c\u5219\u8868\u793a\u7684\u662f\u7b2c1\uff5ek\u4f4d\u67091\uff0c\u4e14\u5c0f\u4e8eA\u7684C[ ]\u7684\u548c\u3002\n\n\u5982\uff1a3=11\uff0cC3=C'11';4=100\uff0cC4=C'001'+C'010'+C'011'+C'100'\uff1b\n\n**\u6700\u540e\uff0c\u4e00\u5b9a\u8981\u8bb0\u4f4f\uff1a**\u770b\u4e0d\u61c2\u4e5f\u4e0d\u8981\u7d27\uff0c\u4f1a\u7528\u5c31\u53ef\u4ee5\u3002\n\n",
        "postTime": 1514016802,
        "uid": 55459,
        "name": "ZhYic",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "### \u8bf4\u660e\uff1a\n\n>\u9898\u89e3\u5b58\u5728\u4e86\u61d2\u6807\u8bb0\u4f20\u9012\u65f6\u4f1a\u591a\u4f20\u4e00\u5c42\u5bfc\u81f4\u6b63\u5e38\u76844\u500dn\u7a7a\u95f4\u65e0\u6cd5\u901a\u8fc7\uff0c\u73b0\u5df2\u4fee\u6539\u5b8c\u6bd5\uff0c\u671b\u901a\u8fc7\uff01\n\n------------\n\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u7528\u7ebf\u6bb5\u6811\u6765\u505a\u8fd9\u9053\u9898\u3002~~\u4e0d\u4f1a\u544a\u8bc9\u4f60\u5176\u5b9e\u6211\u4e0d\u4f1a\u6811\u72b6\u6570\u7ec4~~\n\n\u6570\u636e\u592a\u5927\u5c31\u4f1a\u8d85\u65f6\uff0c\u600e\u4e48\u529e\uff1f\u8fd9\u6837\u5c31\u8981\u5f15\u51fa\u6211\u4eec\u7684\u597d\u5e2e\u624b\u61d2\u6807\u8bb0\u4e86\uff01\n\n\u4e00\u4e2a\u652f\u6301\u533a\u95f4\u4fee\u6539\u7684\u7ebf\u6bb5\u6811, \u5c31\u8981\u7528\u5230lazy\u6807\u8bb0. \u7528\u5230\u54ea\u4e00\u4e2a\u7ed3\u70b9, \u6709\u6548\u6570\u636e\u5c31\u66f4\u65b0\u5230\u54ea\u4e00\u4e2a\u7ed3\u70b9, \u907f\u514d\u6d6a\u8d39\u66f4\u65b0\u90a3\u4e9b\u4e0d\u5fc5\u8981\u7684\u7ed3\u70b9\u7684\u65f6\u95f4. \u4ece\u6839\u90e8\u5411\u4e0b\u627e\u4e00\u4e2a\u7ed3\u70b9, \u4e00\u8def\u4e0b\u6765\u6839\u636elazy\u7684\u8bbe\u5b9a\u8fdb\u884c\u76f8\u5173\u7684\u66f4\u65b0\u64cd\u4f5c, \u5c31\u80fd\u5feb\u901f\u5b8c\u6210\u4efb\u52a1.\n\n\u4e0b\u9762\u5c31\u793a\u8303\u4e00\u7ec4\u6837\u4f8b\uff1a\n\n8 2\n\n3 3 3 3 3 3 3 3\n\n1 2 7 1\n\n2 3\n\n\u76f8\u4fe1\u5927\u5bb6\u5bf9\u7ebf\u6bb5\u6811\u5df2\u7ecf\u6709\u4e86\u4e00\u5b9a\u7684\u4e86\u89e3\uff08\u6ca1\u4e86\u89e3\u8fc7\u7684\u770b\u8fd9\u91cc[\u6d1b\u8c37\u65e5\u62a54](https://baijiahao.baidu.com/s?id=1605870136961096251&wfr=spider&for=pc)\uff09\u90a3\u6211\u4eec\u5c31\u5f00\u59cb\u6784\u9020\u7ebf\u6bb5\u6811\uff0c\u5982\u56fe\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/bfin1kn3.png)\n\n\u8fd9\u5c31\u662f\u57fa\u672c\u7684\u7ebf\u6bb5\u6811\u4e86\uff0c\u7136\u540e\u5f00\u59cb\u8fdb\u884c\u7b2c\u4e00\u6b65\uff0c\u4ece2\u52307\uff0c\u4e00\u6b21\u7ed9\u533a\u95f4\u52a0\u4e0a1\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/o2b3xfnp.png)\n\n\u6765\u89e3\u91ca\u8fd9\u4e00\u5e45\u56fe\uff0c\u9996\u5148\u770b\u6211\u4eec\u5b58\u7ebf\u6bb5\u6811\u7684\u4e0b\u68071\uff0cL\uff08\u5de6\u8282\u70b9\uff09=1\uff0cR\uff08\u53f3\u8282\u70b9\uff09=8\uff0c\u6ca1\u6709\u88ab\u5305\u542b\u4e14\u61d2\u6807\u8bb0=0\uff0c\u6240\u4ee5\u53d6\u4e2d\u70b9mid=(1+8)/2=4,\u67e5\u627e\u5de6\u53f3\u5b50\u6811\u3002\n\n\u6765\u5230\u5de6\u5b50\u68112\uff0cL=L(father's)\uff0cR=mid(father's)\uff0c\u6ca1\u6709\u88ab\u5b8c\u5168\u5305\u542b\u4e14\u61d2\u6807\u8bb0=0\uff0c\u6240\u4ee5\u7ee7\u7eed\u67e5\u627e\u5de6\u53f3\u5b50\u6811\u3002\n\n\u6765\u52302\u7684\u5de6\u5b50\u68114\uff0c\u6ca1\u6709\u88ab\u5305\u542b\u4e14\u61d2\u6807\u8bb0=0\uff0c\u6240\u4ee5\u67e5\u627e\u5de6\u53f3\u5b50\u6811\uff0c\u56e0\u4e3a\u5de6\u5b50\u6811\u7684\u53f3\u8282\u70b9\u5927\u4e8e2\uff0c\u6240\u4ee5\u4e0d\u8fdb\u5165\u3002\u6765\u5230\u53f3\u5b50\u68119\uff0c\u88ab\u5305\u542b\uff0c\u6240\u4ee5dis[9]+=1\uff0c\u61d2\u6807\u8bb0+=1\uff0c\u8fd4\u56de\u3002\n\n\u8fd4\u56de\u52302\uff0c\u67e5\u627e\u53f3\u5b50\u68115\uff0c\u88ab\u5305\u542b\uff0c\u6240\u4ee5dis[5]+=(4-3+1)* 1\uff0c\u61d2\u6807\u8bb0+=1\uff0c\u8fd4\u56de\u3002\n\n\u56de\u52301\uff0c\u67e5\u627e\u53f3\u8282\u70b93\u2026\u2026\u4ee5\u6b64\u7c7b\u63a8\uff0cdis[6]+=(6-5+1)* 1,\u61d2\u6807\u8bb0+=1;dis[14]+=1,\u61d2\u6807\u8bb0+=1;\n\n\u8fd9\u6837\uff0c\u533a\u95f4\u4fee\u6539\u5c31\u5b8c\u6210\u4e86\u3002\n\n\u6765\u5230\u7b2c\u4e8c\u6b65\uff0c\u67e5\u627e3\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fgku6jbj.png)\n\n\u4ece1\u5f00\u59cb\u627e\u52302\uff0c\u5728\u627e\u52305\uff0c\u53d1\u73b0\u6709\u61d2\u6807\u8bb0\uff0c\u6240\u4ee5\u628a\u61d2\u6807\u8bb0\u4e0b\u4f20\u523010\u548c11,\ndis[10]+=1;\u61d2\u6807\u8bb0[10]+=1;dis[11]+=1,\u61d2\u6807\u8bb0[11]+=1,\u61d2\u6807\u8bb0[5]=0;\n\u523010\uff0cL=R=3\uff0creturn dis[10];\u67e5\u8be2\u5c31\u5b8c\u6210\u4e86\u3002\n\n\u53ef\u80fd\u6709\u4eba\u4f1a\u8bf4\u61d2\u6807\u8bb0\u770b\u8d77\u6765\u6ca1\u6709\u4ec0\u4e48\u7528\uff0c\u4f46\u6570\u636e\u4e00\u65e6\u5f88\u5927\uff0c\u9012\u5f52\u4f20\u9012\u5c31\u663e\u5f97\u5c24\u4e3a\u65b9\u4fbf\uff0c\u53ef\u4ee5\u4e3a\u6211\u4eec\u8282\u7701\u5f88\u591a\u65f6\u95f4\u3002\n\n\u63a5\u4e0b\u6765\u662f\u5bf9\u4ee3\u7801\u7684\u8be6\u7ec6\u8bb2\u89e3\uff1a\n\n\u521d\u59cb\u5316\uff1a\n\n\n```cpp\n\nstruct Tree{\n\tlong long l,r;//l:\u5de6\u8282\u70b9 r:\u53f3\u8282\u70b9 \n\tlong long dat,laze_tag;//dat:\u5f53\u524d\u8282\u70b9\u7684\u503c laze_tag:\u61d2\u6807\u8bb0\uff0c\u8bb0\u5f55\u6539\u53d8\u7684\u503c\uff0c\u9012\u5f52\u4f20\u503c \n}t[2000001];//\u56db\u500dn \n```\n\u7136\u540e\u662f\u6211\u4eec\u7684\u61d2\u6807\u8bb0\u4f20\u9012\uff1a\n\n```cpp\ninline void f(long long p,long long k){\n\tt[p].laze_tag+=k;//\u61d2\u6807\u8bb0\u4f20\u9012 \n\tt[p].dat+=k*(t[p].r-t[p].l+1);//\u5f53\u524d\u503c\u52a0\u4e0a\u6240\u6709\u8282\u70b9\u603b\u6570*\u503c \n} \ninline void pushdown(long long p){\n\tf(p*2,t[p].laze_tag);\n\tf(p*2+1,t[p].laze_tag);\n\t//\u5c06\u61d2\u6807\u8bb0\u7684\u503c\u4f20\u7ed9\u4e0b\u9762\u7684\u5de6\u53f3\u513f\u5b50\u8282\u70b9\n\tt[p].laze_tag=0;//\u590d\u539f\u61d2\u6807\u8bb0 \n}\n```\n\uff08\u4e0b\u9762\u4f1a\u6709\u518d\u67e5\u627e\u548c\u4fee\u6539\u65f6\u7684\u61d2\u6807\u8bb0\u5904\u7406\uff09\n\n\u5f00\u59cb\u5148\u8981\u6784\u9020\u6211\u4eec\u7684\u7ebf\u6bb5\u6811\n\n\n```cpp\nvoid js(int p,int l,int r){//\u5efa\u6811 \n\tt[p].l=l;t[p].r=r;//\u8bb0\u5f55\u5de6\u53f3\u8282\u70b9 \n\tif(l==r){//\u5230\u8fbe\u5e95\u90e8\u8fd4\u56de\u503c \n\t\tt[p].dat=a[l];return;\n\t}\n\tlong long mid=(l+r)/2;//\u4e2d\u70b9 \n\tjs(p*2,l,mid);\n\tjs(p*2+1,mid+1,r);\n\t//\u9012\u5f52\u521d\u59cb\u5316 \n\tt[p].dat=t[p*2].dat+t[p*2+1].dat;\n\t//\u52a0\u4e0a\u5de6\u53f3\u513f\u5b50\u8282\u70b9 \n}\n```\n\u7b2c\u4e8c\u6b65\uff0c\u5c31\u8981\u5199\u6211\u4eec\u7684\u533a\u95f4\u52a0\u51cf\u4e86\n\n```cpp\nvoid pushs(long long p,long long l,long long r,long long v){//\u533a\u95f4\u52a0\u51cf \n\tif(t[p].l>=l&&t[p].r<=r){//\u5982\u679c\u533a\u95f4\u88ab\u5305\u542b\u5c31\u4fee\u6539\u5e76\u6253\u4e0a\u61d2\u6807\u8bb0 \n\t\tt[p].dat+=v*(t[p].r-t[p].l+1);//\u52a0\u4e0a\u6240\u6709\u503c \n\t\tt[p].laze_tag+=v;//\u61d2\u6807\u8bb0\u4fee\u6539 \n\t\treturn;\n\t}\n\tpushdown(p);//\u67e5\u8be2\u61d2\u6807\u8bb0\uff0c\u56e0\u4e3a\u4e0b\u9762\u8981\u9012\u5f52 \n\tlong long mid=(t[p].r+t[p].l)/2;//\u53d6\u4e2d\u70b9 \n\tif(l<=mid)pushs(p*2,l,r,v);//\u4fee\u6539\u5de6\u8fb9 \n\tif(r>mid) pushs(p*2+1,l,r,v);//\u4fee\u6539\u53f3\u8fb9 \n\tt[p].dat=t[p*2].dat+t[p*2+1].dat;//\u56de\u6eaf\u65f6\u52a0\u4e0a\u5de6\u53f3\u513f\u5b50\u8282\u70b9\u7684\u503c \n}\n```\n\u6700\u540e\u662f\u6700\u5bb9\u6613\u7684\u5355\u70b9\u67e5\u8be2\n```cpp\nlong long outt(long long p,long long l){//\u5355\u70b9\u67e5\u8be2 \n\t \n\tif(t[p].l==l&&t[p].r==l)return t[p].dat;//\u627e\u5230\u76ee\u6807\u70b9\u5c31\u8fd4\u56de \n    pushdown(p);//\u5148\u56de\u590d\u61d2\u6807\u8bb0\u7684\u503c\u518d\u4f20\u9012\uff0c\u56e0\u4e3a\u4e0b\u9762\u53ef\u80fd\u9012\u5f52\uff08\u8981\u5224\u65ad\u662f\u5426\u5230\u4e86\u5e95\u90e8\uff0c\u5c31\u662f\u8fd9\u91cc\u51fa\u4e86\u95ee\u9898QwQ\uff09\n\tlong long mid=(t[p].l+t[p].r)/2;//\u8bb0\u5f55\u4e2d\u70b9 \n\tif(l<=mid)return outt(p*2,l);//\u627e\u5de6\u8fb9 \n\tif(l>mid)return outt(p*2+1,l);//\u627e\u53f3\u8fb9 \n}\n```\n\u770b\u5b8c\u4e86\uff0c\u90a3\u5c31\u8d34\u4e0a\u5b8c\u6574\u7684\u4ee3\u7801\u5566\uff01\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nlong long n,m;//n:\u957f\u5ea6 m: \u8be2\u95ee \nlong long a[500001];\nstruct Tree{\n\tlong long l,r;//l:\u5de6\u8282\u70b9 r:\u53f3\u8282\u70b9 \n\tlong long dat,laze_tag;\n}t[2000001];\ninline long long read(){\n\tlong long f=1,outt=0;char a=getchar();\n\twhile(a>'9'||a<'0'){if(a=='-')f=-1;a=getchar();}\n\twhile(a<='9'&&a>='0'){outt*=10;outt+=a-'0';a=getchar();}\n\treturn f*outt;\n}//\u8bfb\u5165\u4f18\u5316 \ninline void f(long long p,long long k){\n\tt[p].laze_tag+=k;\n\tt[p].dat+=k*(t[p].r-t[p].l+1);\n} \ninline void pushdown(long long p){\n\tf(p*2,t[p].laze_tag);\n\tf(p*2+1,t[p].laze_tag);\n\tt[p].laze_tag=0;\n}\nvoid js(int p,int l,int r){\n\tt[p].l=l;t[p].r=r;\n\tif(l==r){\n\t\tt[p].dat=a[l];return;\n\t}\n\tlong long mid=(l+r)/2;//\u4e2d\u70b9 \n\tjs(p*2,l,mid);\n\tjs(p*2+1,mid+1,r);\n\tt[p].dat=t[p*2].dat+t[p*2+1].dat;\n}\nlong long outt(long long p,long long l){\n\tif(t[p].l==l&&t[p].r==l)return t[p].dat;\n    pushdown(p);\n\tlong long mid=(t[p].l+t[p].r)/2;\n\tif(l<=mid)return outt(p*2,l);\n\tif(l>mid)return outt(p*2+1,l);\n}\nvoid pushs(long long p,long long l,long long r,long long v){\n\tif(t[p].l>=l&&t[p].r<=r){\n\t\tt[p].dat+=v*(t[p].r-t[p].l+1);\n\t\tt[p].laze_tag+=v;\n\t\treturn;\n\t}\n\tpushdown(p);\n\tlong long mid=(t[p].r+t[p].l)/2;\n\tif(l<=mid)pushs(p*2,l,r,v); \n\tif(r>mid) pushs(p*2+1,l,r,v);\n\tt[p].dat=t[p*2].dat+t[p*2+1].dat;\n}\nvoid change(long long p,int x,int v){//\u5355\u70b9\u4fee\u6539\uff0c\u4e0d\u5fc5\u5728\u610f\uff0c\u662f\u533a\u95f4\u4fee\u6539\u7684\u5b50\u95ee\u9898\uff0c\u8fde\u6807\u8bb0\u90fd\u4e0d\u7528(\u800c\u4e14\u672c\u9898\u4e0d\u9700\u8981)\n\tif(t[p].l==t[p].r){\n\t\tt[p].dat+=v;return;\n\t}\n\tint mid=(t[p].r+t[p].l)/2;\n\tif(x<=mid)change(p*2,x,v);\n\telse change(p*2+1,x,v);\n\tt[p].dat=t[p*2].dat+t[p*2+1].dat;\n}\nint main(){\n\tn=read();m=read();//\u8bfb\u5165 \n\tfor(int i=1;i<=n;i++)\n\t\ta[i]=read();\n\tjs(1,1,n);//\u5efa\u6811 \n\tfor(int i=1;i<=m;i++){\n\t\tlong long pd=read();\n\t\tif(pd==2){\n\t\t\tlong long ll=read();\n\t\t\tprintf(\"%lld\\n\",outt(1,ll));//\u67e5\u8be2ll\u7684\u503c \n\t\t}\n\t\telse \n\t\tif(pd==1){\n\t\t\tlong long ll=read(),rr=read(),x=read();\n\t\t\tpushs(1,ll,rr,x);//\u4fee\u6539\u4ecell\u5230rr\u7684\u503c\u52a0\u4e0ax \n\t\t}\n\t\telse\n\t\tif(pd==3){\n\t\t\tint k=read(),y=read();\n\t\t\tchange(1,k,y);\n\t\t}\n\t}\n\treturn 0;//\u534e\u4e3d\u4e3d\u7684\u7ed3\u675f\uff0c\u53ef\u4ee5A\u6389\u6811\u72b6\u6570\u7ec42\u4e86\uff01\uff01\uff01 \n}\n```\n\u7b2c\u4e00\u6b21\u5199\u6b63\u7ecf\u7684\u9898\u89e3\uff0c\u6709\u9519\u8bef\u8bf7\u6307\u51fa\uff0c\u7801\u98ce\u4ec0\u4e48\u7684\u8fd8\u8bf7\u591a\u591a\u5305\u6db5\u5566\uff01",
        "postTime": 1570611897,
        "uid": 138650,
        "name": "\u964c\u5c0f\u90fd\u6070\u8089\u8089",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "\u5176\u5b9e\u8fd9\u9053\u9898\u8bf4\u662f\u201c\u6811\u72b6\u6570\u7ec4\u6a21\u677f\u201d\uff0c\u4f46\u662f\u8981\u7528\u5230\u5dee\u5206\u7684\u601d\u60f3\n\n\u4e5f\u8bb8\u662f\u5dee\u5206\u7ecf\u5e38\u548c\u6811\u72b6\u6570\u7ec4\u4e00\u8d77\u7528\u5427\u3002\u3002\n\n\u5dee\u5206\u601d\u60f3\uff1a\n\n\u8bbeb[i]\u4e3aa[i]-a[i-1],\u5219a[i]\u5c31\u53ef\u4ee5\u8868\u793a\u4e3ab[i]+b[i-1]+..+b[1]\u3002\n\n\u4e00\u64cd\u4f5c\uff1a\n\n\u53ef\u4ee5\u7528\u5dee\u5206\u6765\u5feb\u901f\u89e3\u51b3\uff0c\u5c06b[l]\u548cb[r+1]\u52a0\u4e0ax\uff0c\u5c31\u53ef\u4ee5\u5c06\u6574\u4e2a\u533a\u95f4\u52a0x\uff08\u8bc1\u660e\u597d\u8bc1\uff09\n\n\u4e8c\u64cd\u4f5c\uff1a\n\n\u5149\u679a\u4e3e1~n\u6c42\u548c\u592a\u6162\u4e86\uff0c\u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4\u6765\u4f18\u5316\u3002\u8fd9\u65f6\u7684c\u6570\u7ec4\u4fbf\u662f\u5dee\u5206\u548c\n\ncode:\n\n\n```cpp\n    #include<bits/stdc++.h>\n    using namespace std;\n    int n,m,l,r,x;\n    long long c[500010],k,a;\n    int lowbit(int x){\n        return x&(-x);\n    }\n    void change(int x,long long y){\n        while(x<=n){\n            c[x]+=y;\n            x+=lowbit(x);\n        }\n    }\n    long long solve(int x){\n        long long cnt=0;\n        while(x){\n            cnt+=c[x];\n            x-=lowbit(x);\n        }\n        return cnt; \n    }\n    int main(){\n        scanf(\"%d%d\",&n,&m);\n        long long now=0;\n        for(int i=1;i<=n;i++){\n            scanf(\"%lld\",&a);//\u8fd9\u91cc\u7684now\u76f8\u5f53\u4e8e\u4e0a\u4e00\u4e2aa[i-1]\n            change(i,a-now);\n            now=a;//\u66f4\u65b0\n        }\n        while(m--){\n            scanf(\"%d\",&x);\n            if(x==1){\n                scanf(\"%d%d%lld\",&l,&r,&k);\n                change(l,k);//\u5dee\u5206\n                change(r+1,-k);//\u5dee\u5206\n            }\n            else{\n                int s;\n                scanf(\"%d\",&s);\n                printf(\"%lld\\n\",solve(s));//\u6c42\u548c\n            }\n        }\n        return 0;\n}\n```",
        "postTime": 1513677510,
        "uid": 26139,
        "name": "AcceleratorX",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011by bjmhqy"
    },
    {
        "content": "**\u697c\u4e0b\u4f17\u795e\u7287\u597d\u50cf\u90fd\u7528\u4e86\u4e00\u4e2a\u8fd9\u4e2a\u4e1c\u897f**\n\n```cpp\nchange(i,a1[i]-a1[i-1]); \n```\n**\u5bf9\u4e8e\u849f\u84bb\u7684\u6211\u5f53\u65f6\u5e76\u4e0d\u7406\u89e3**\n\n**\u53ea\u597d\u534a\u61f5\u903c\u534a\u6e05\u9192\u7684\u6284\u4e0aAC\u4e86**\n\n**\u5f88\u4e45\u4e4b\u540e\u7684\u73b0\u5728\u53c8\u6765\u505a\u4e86\u4e00\u4e0b\u8fd9\u9053\u9898**\n\n**\u53d1\u73b0\u4e86\u4e00\u4e2a\u597d\u7406\u89e3\u7684\uff1f\uff08\u9898\u89e3\u5e76\u6ca1\u6709\u770b\u5230\u5e95\uff0c\u4e0d\u77e5\u9053\u6709\u6ca1\u6709\u91cd\u590d\u7684\uff09**\n\n**\u5bf9\u4e8e\u4fee\u6539\u6211\u4eec\u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u5dee\u5206\u6570\u7ec4**\n\n**\u4f46\u662f\u7528\u6811\u72b6\u6570\u7ec4\u6211\u4eec\u4ec5\u7ef4\u62a4\u4fee\u6539\u7684\u503c\uff08\u4e5f\u5c31\u662f\u6539\u53d8\u7684\u503c\uff09**\n\n**\u6700\u540e\u67e5\u8be2\u7684\u65f6\u5019\u52a0\u4e0a\u521d\u59cb\u503c\u5c31\u597d\u4e86**\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#define maxn 500100\nusing namespace std;\nint n,m;\nint c[maxn];\nint a[maxn];\nint add(int x,int k)\n{\n    for(int i=x;i<=n;i+=i&(-i)) c[i]+=k;\n}\nint query(int x)\n{\n    int sum=0;\n    for(int i=x;i>0;i-=i&(-i)) sum+=c[i];\n    return sum;\n}\nint main()\n{\n    cin>>n>>m;\n    for(int i=1;i<=n;i++)  scanf(\"%d\",&a[i]);\n    while(m--)\n    {\n        int k;\n        scanf(\"%d\",&k);\n        if(k==1)\n        {\n            int x,y,z;\n            scanf(\"%d%d%d\",&x,&y,&z);\n            add(x,z);           //\u7ef4\u62a4\u67e5\u5206\u6570\u7ec4\n            add(y+1,-z);\n        }\n        else\n        {\n            int x;\n                        scanf(\"%d\",&x);\n            printf(\"%d\\n\",a[x]+query(x));   //query()\u6c42\u7684\u662f\u6539\u53d8\u7684\u503c\uff0c\u518d\u52a0\u4e0a\u539f\u6765\u7684\u503c\u5c31\u53ef\u4ee5\u4e86\n        }\n    }\n    return 0;\n}\n\n```",
        "postTime": 1508761484,
        "uid": 18441,
        "name": "Drug__Lover",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "\u770b\u5230\u9898\u89e3\u91cc\uff0c\u6ca1\u6709\u7528\u7ebf\u6bb5\u6811\u7684~~\uff08\u6211\u7ebf\u6bb5\u6811\u8fd9\u4e48\u4e0d\u53d7\u4eba\u5f85\u89c1\u5417\uff1f\uff01\uff09~~\n\u4e8e\u662f\uff0c\u6211\u6765\u5199\u4e00\u53d1\u7ebf\u6bb5\u6811\u7684\u9898\u89e3\uff0c~~\u5f88\u7b80\u5355\u5c31\u662f\u5728\u7ebf\u6bb5\u68111\u90a3\u4e2a\u677f\u5b50\u7684\u57fa\u7840\u4e0a\u4fee\u6539\u4e86\u4e00\u70b9\u70b9~~\n\n\u540c\u6837\u662f\u7528\u4e00\u68f5\u7ebf\u6bb5\u6811\u6765\u7ef4\u62a4\u6574\u4e2a\u6570\u5217\uff0c\u6211\u4eec\u53ea\u9700\u8981\u505a\u5230\u533a\u95f4\u4fee\u6539\u548c\u5355\u70b9\u67e5\u8be2\u4e24\u4e2a\u64cd\u4f5c\u3002\n\u533a\u95f4\u4fee\u6539\uff1f\u600e\u4e48\u6539\u5462\uff1f\n\n```cpp\ninline void addval(int rt){\n\tint l=t[rt].left,r=t[rt].right;\n\tif(a<=l&&r<=b){//\u5224\u65ad\u6211\u4eec\u5f53\u524d\u662f\u5426\u5e94\u8be5\u8fdb\u884c\u4fee\u6539\n\t\tt[rt].tag+=x;//\u5148\u6253\u4e0a\u61d2\u6807\u8bb0\n\t\tt[rt].data+=(t[rt].right-t[rt].left+1)*x;\n        //\u7531\u4e8e\u7ebf\u6bb5\u6811\u7684\u8282\u70b9\u662f\u7ba1\u7406\u4e00\u4e2a\u533a\u95f4\n        //\u6240\u4ee5\u6211\u4eec\u5728\u4fee\u6539\u8282\u70b9\u503c\u7684\u65f6\u5019\uff0c\u5e94\u8be5\u7528\u533a\u95f4\u53bb\u4e58\u9700\u8981\u52a0\u5165\u7684\u503cx\n\t\treturn ;\n\t}\n\tif(t[rt].tag) pushdown(rt);//\u6709\u6807\u8bb0\u8981\u5148\u4e0b\u4f20\u6807\u8bb0\n\tif(a<=mid) addval(ls);\n    //\u5982\u679c\u8981\u67e5\u8be2\u7684\u533a\u95f4\u6709\u90e8\u5206\u5728\u5de6\u5b50\u6811\uff0c\u90a3\u4e48\u5411\u5de6\u5b50\u6811\u4fee\u6539\n\tif(b>mid) addval(rs);\n    //\u540c\u4e0a\uff0c\u5411\u53f3\u5b50\u6811\u4fee\u6539\n\tupdate(rt);//\u540cpushup\n\treturn ;\n}\n```\n\u597d\u4e86\uff0c\u89e3\u51b3\u4e86\u533a\u95f4\u4fee\u6539\uff0c\u6211\u4eec\u8981\u8003\u8651\u5355\u70b9\u67e5\u8be2\u4e86\uff01\n\u7ebf\u6bb5\u6811\u662f\u4ee5\u533a\u95f4\u67e5\u8be2\u8457\u79f0\uff0c\u90a3\u4e48\u600e\u4e48\u624d\u80fd\u505a\u5230\u5355\u70b9\u4fee\u6539\u5462\uff1f\n```cpp\ninline void query(int rt){\n\ta=pos,b=pos;//\u8fd9\u91cc\u662f\u6211\u4fee\u6539\u7684\u5730\u65b9\n    //\u6211\u4eec\u7528\u7ebf\u6bb5\u6811\u4fee\u6539\u65f6\uff0c\u662f\u4fee\u6539\u4e00\u4e2a\u533a\u95f4\uff0c\u5b83\u7684\u5de6\u53f3\u7aef\u70b9\u5206\u522b\u662fa\uff0cb\n    //\u5355\u70b9\u67e5\u8be2\uff0c\u6211\u4eec\u628a\u5b83\u770b\u4f5c\u662f\u4e00\u4e2a\u957f\u5ea6\u4e3a1\u7684\u533a\u95f4\uff0c\u5de6\u53f3\u7aef\u70b9\u76f8\u540c\n    //\u6240\u4ee5\u6211\u4eec\u628a\u8981\u67e5\u8be2\u7684\u4f4d\u7f6e\u90fd\u8d4b\u503c\u7ed9a\u548cb\uff0c\u8fd9\u6837\u5c31\u8fbe\u5230\u4e86\u5355\u70b9\u67e5\u8be2\u7684\u76ee\u7684\n\tint l=t[rt].left,r=t[rt].right;\n\tif(a<=l&&r<=b){//\u540c\u4e0a\u4e00\u6bb5\u4ee3\u7801\n\t\tans+=t[rt].data;\n\t\treturn ;\n\t}\n\tif(t[rt].tag) pushdown(rt);\n\tif(a<=mid) query(ls);\n\tif(b>mid) query(rs);\n\treturn ;\n}\n```\n\n\u63a5\u4e0b\u6765\u9644\u4e0a\u5b8c\u6574\u4ee3\u7801\uff1a\n```cpp\n#include<iostream>\n#include<cstdio>\n#define ll long long\n#define ls (rt<<1)\n#define rs (rt<<1|1)\n#define mid ((l+r)>>1)\n#define update(rt) t[rt].data=t[ls].data+t[rs].data\n#define N 500005\n//\u5b8f\u5b9a\u4e49\u5927\u6cd5\u597d\n\nusing namespace std;\n\nstruct tree{\n\tll tag,data;\n\tint left,right;\n}t[(N<<4)+5];//\u4e4b\u524d\u56e0\u4e3a\u6570\u7ec4\u5f00\u5c0f\u4e86\uff0cRE\u4e863\u4e2a\u70b9\n\nint n,m,pos;\nll s[N],ans;\nint a,b,x,k;\n\ninline void build(int rt,int l,int r){\n//\u9012\u5f52\u5efa\u6811\n\tt[rt].left=l;t[rt].right=r;t[rt].tag=0;\n\tif(l==r){\n\t\tt[rt].data=s[l];\n\t\treturn ;\n\t}\n\tbuild(ls,l,mid);\n\tbuild(rs,mid+1,r);\n\tupdate(rt);\n\treturn ;\n}\n\ninline void pushdown(int rt){//\u6807\u8bb0\u4e0b\u4f20\n\tt[ls].tag+=t[rt].tag;\n\tt[rs].tag+=t[rt].tag;\n\tt[ls].data+=t[rt].tag*(t[ls].right-t[ls].left+1);\n\tt[rs].data+=t[rt].tag*(t[rs].right-t[rs].left+1);\n\tt[rt].tag=0;\n\treturn ;\n}\n\ninline void addval(int rt){\n//\u533a\u95f4\u4fee\u6539\n\tint l=t[rt].left,r=t[rt].right;\n\tif(a<=l&&r<=b){\n\t\tt[rt].tag+=x;\n\t\tt[rt].data+=(t[rt].right-t[rt].left+1)*x;\n\t\treturn ;\n\t}\n\tif(t[rt].tag) pushdown(rt);\n\tif(a<=mid) addval(ls);\n\tif(b>mid) addval(rs);\n\tupdate(rt);\n\treturn ;\n}\n\ninline void query(int rt){\n//\u5355\u70b9\u67e5\u8be2\n\ta=pos,b=pos;\n\tint l=t[rt].left,r=t[rt].right;\n\tif(a<=l&&r<=b){\n\t\tans+=t[rt].data;\n\t\treturn ;\n\t}\n\tif(t[rt].tag) pushdown(rt);\n\tif(a<=mid) query(ls);\n\tif(b>mid) query(rs);\n\treturn ;\n}\n\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n;++i) scanf(\"%lld\",&s[i]);\n\tbuild(1,1,n);\n\tfor(int i=1;i<=m;++i){\n\t\tscanf(\"%d\",&k);\n\t\tif(k==1){\n\t\t\tscanf(\"%d%d%d\",&a,&b,&x);\n\t\t\taddval(1);//\u533a\u95f4\u4fee\u6539\n\t\t}\n\t\telse{\n\t\t\tscanf(\"%d\",&pos);//\u8981\u67e5\u8be2\u7684\u4f4d\u7f6e\n\t\t\tquery(1);\n\t\t\tprintf(\"%lld\\n\",ans);\n\t\t\tans=0;\n\t\t}\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1526341677,
        "uid": 54227,
        "name": "Phecda",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "\u901b\u4e86\u4e00\u5708\u9898\u89e3\uff0c\u53d1\u73b0\u5927\u90fd\u6ca1\u6709\u5408\u683c\u7684\u601d\u8def\u8bb2\u89e3\u548c $\\LaTeX$ \u7684\u5e94\u7528\u3002\n\n\u8fd9\u91cc\u6765\u8865\u53d1\u4e00\u7bc7\uff0c\u987a\u4fbf\u6da8\u5495\u503c\u3002\n\n\u672c\u7bc7\u9898\u89e3\u5c06\u628a**\u91cd\u5fc3**\u504f\u5411\u4e3a\u4ec0\u4e48\u4e14\u5982\u4f55\u901a\u8fc7\u5dee\u5206\u6765\u5b9e\u73b0\u672c\u9898\u8981\u6c42\uff0c\u56e0\u800c\u5c06\u6de1\u5316\u751a\u81f3\u7565\u8fc7\u6811\u72b6\u6570\u7ec4\u7684\u76f8\u5173\u77e5\u8bc6\u3002\n\n\u6709\u5173\u6811\u72b6\u6570\u7ec4\u7684\u8be6\u60c5\u8bf7\u770b[\u8fd9\u91cc](https://www.luogu.com.cn/problemnew/solution/P3374)\u3002\n\n-----------\n\n### \u89e3\u9898\u601d\u8def\n\n**\u524d\u7f6e\u77e5\u8bc6**\uff1a\n\n- \u6811\u72b6\u6570\u7ec4\u5165\u95e8\u3002\u8be6\u60c5\u70b9[\u8fd9\u91cc](https://www.luogu.com.cn/problemnew/solution/P3374)\u3002\u672c\u9898\u662f\u4e00\u4e2a\u5c0f\u5c0f\u7684\u62d3\u5c55\u800c\u5df2\u3002\n- \u5dee\u5206\u57fa\u7840\u77e5\u8bc6\u3002\n\n\u6211\u4eec\u77e5\u9053\uff0c\u666e\u901a\u7684\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u7684\u662f\u4e00\u4e2a**\u524d\u7f00\u548c**\u6570\u7ec4\uff0c\u652f\u6301**\u5355\u70b9\u4fee\u6539**\u548c**\u533a\u95f4\u67e5\u8be2**\u3002\n\n\u4f46\u662f\u8fd9\u9053\u9898\u76ee\uff0c\u8981\u6211\u4eec\u5b9e\u73b0**\u533a\u95f4\u4fee\u6539**\u548c**\u5355\u70b9\u67e5\u8be2**\u3002\n\n\u5bf9\u4e8e\u533a\u95f4\u4fee\u6539\uff0c\u6709\u4e00\u79cd\u5f88\u66b4\u529b\u601d\u8def\u662f\uff1a\n\n- \u904d\u5386 $[L,R]$ \u7684\u533a\u95f4\uff0c\u6bcf\u6b21\u8fdb\u884c\u4e00\u6b21\u5355\u70b9\u4fee\u6539\u3002\n\n\u7136\u800c\u65f6\u95f4\u590d\u6742\u5ea6\u6700\u52a3\u4e3a $O(n^2\\log n)$\uff0c\u663e\u7136\u8fd9\u662f\u4f1a\u8d85\u65f6\u7684\u3002\n\n\u60f3\u5230\u8fd9\uff0c\u5b66\u8fc7\u7684\u540c\u5b66\u5c31\u80fd\u5f88\u654f\u611f\u7684\u60f3\u5230\uff0c**\u5dee\u5206**\u53ef\u4ee5\u8f7b\u677e\u89e3\u51b3\u3002\n\n----------\n\n**\u63d0\u793a\uff1a\u4e0b\u9762\u5927\u90e8\u5206\u5185\u5bb9\u5173\u4e8e\u5dee\u5206\u3002\u82e5\u60a8\u5df2\u7ecf\u975e\u5e38\u719f\u6089\u8bf7\u8df3\u8fc7\u3002**\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff1a\u8bb0\u5dee\u5206\u6570\u7ec4\u4e3a $T$\u3002\n\n\u539f\u6765\u7684\u5e8f\u5217\u4e3a\uff1a\n\n| 1 |2  | 3 | 4 |5  |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n\n\u5dee\u5206\u6570\u7ec4\u4e3a\uff1a\n\n| 1 |1  | 1 | 1 |1  |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n\n\u5728 $[2,4]$ \u4e4b\u95f4 $+2$\uff0c\u5219\u5e8f\u5217\u4e3a\uff1a\n\n| 1 |4 | 5 | 6 |5  |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n\n\u5dee\u5206\u6570\u7ec4\u53d8\u4e3a\uff1a\n\n| 1 |3 | 1 | 1 |-1  |\n| :----------: | :----------: | :----------: | :----------: | :----------: |\n\n\u5bf9\u6bd4\u53d1\u73b0\uff0c\u53ea\u6709 $T_2+2$\uff0c\u4ee5\u53ca $T_5-2$\u3002\u53ea\u7528\u4e86\u4e24\u6b21\u5355\u70b9\u4fee\u6539\u3002\n\n\u63a8\u5e7f\u4e00\u4e0b\uff1a\n\n\u5bf9\u4e8e\u5e8f\u5217 $a_1,a_2,a_3,\\cdots,a_n$\uff0c\u5728\u533a\u95f4 $[L,R]$ \u5185\u52a0\u4e0a $\\Delta$\uff0c\u4e0d\u96be\u53d1\u73b0\uff1a\n\n- $[L,R]$ \u7531\u4e8e\u52a0\u4e0a\u540c\u4e00\u4e2a\u6570\uff0c**\u76f8\u5bf9\u5927\u5c0f\u662f\u4e0d\u53d8**\u7684\uff0c\u56e0\u6b64 $(L,R]$ \u533a\u95f4\u5185\u7684 $T$ \u4e0d\u9700\u8981\u4fee\u6539\u3002\n\n- \u800c $T_L=a_L-a_{L-1}$\uff0c$a_{L-1}$ \u5927\u5c0f\u4e0d\u53d8\uff0c\u53ea\u6709 $a_L$ \u589e\u52a0\u4e86 $\\Delta$\uff0c\u56e0\u6b64 $T_L$ \u589e\u52a0\u4e86 $\\Delta$\u3002\u540c\u7406\uff0c$T_{R+1}$ \u51cf\u5c11 $\\Delta$\u3002\n\n\u901a\u8fc7\u4e0a\u8ff0\u65b9\u6cd5\uff0c\u5c31\u53ef\u4ee5\u5b9e\u73b0\u53ea\u4fee\u6539 $T_L$ \u548c $T_{R+1}$ \u5171\u4e24\u6b21\u5c31\u5b8c\u6210\u4e86 $[L,R]$ \u7684\u533a\u95f4\u4fee\u6539\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u5927\u5927\u964d\u4f4e\u3002\n\n\u6211\u4eec\u53ea\u9700\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u8fd9\u4e2a $T$ \u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u4f46\u662f\u5bf9\u4e8e**\u5355\u70b9\u67e5\u8be2**\uff0c\u9700\u8981\u7565\u5fae\u6539\u52a8\u3002\n\n\u6211\u4eec\u76f4\u63a5\u8f93\u51fa`query(x)`\u5373\u53ef\uff0c\u56e0\u4e3a$a_x=\\sum^x_{i=1}T_i$\uff0c\u800c\u6811\u72b6\u6570\u7ec4\u8be2\u95ee\u6070\u597d\u662f**\u5dee\u5206\u6570\u7ec4\u7684\u524d\u7f00\u548c**\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4f9d\u7136\u4e3a $O(n\\log n)$\u3002\n\n------------\n\n### \u5176\u5b83\u65b9\u6cd5\n\n\u6a21\u677f\u9898\u81ea\u7136\u6709\u5f88\u591a\u89e3\u6cd5\uff0c\u8fd9\u91cc\u987a\u5e26\u4e00\u63d0\u3002\u8be6\u60c5\u8bf7\u770b\u5176\u5b83\u9898\u89e3\u3002\n\n- \u5206\u5757\u3002\n- \u7ebf\u6bb5\u6811\u3002\n- \u5dee\u5206\u3002\n- ~~cdq\u5206\u6cbb\u3002~~\n\n----\n\n### \u53c2\u8003\u4ee3\u7801\n\n\u5176\u5b9e\u4e5f\u5c31\u662f\u7565\u52a0\u6539\u52a8\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\nusing namespace std;\n\nconst int MAXN=6e5+5;\nint n,m;\nint tree[MAXN],a[MAXN];\n\ninline int lowbit(const int x)\n{\n\treturn x&(-x);\n}\n\nvoid modify(int x,const int k)\n{\n\twhile(x<=n)\n\t{\n\t\ttree[x]+=k;\n\t\tx+=lowbit(x);\n\t}\n}\n\nint query(int x)\n{\n\tint res=0;\n\twhile(x)\n\t{\n\t\tres+=tree[x];\n\t\tx-=lowbit(x);\n\t}\n\treturn res;\n}\n//\u4ee5\u4e0a\u90fd\u662f\u6811\u72b6\u6570\u7ec4\u6a21\u677f\nint main()\n{\n\tcin>>n>>m;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tcin>>a[i];\n\t\tmodify(i,a[i]-a[i-1]);//a[i]-a[i-1]\u5c31\u662f\u6c42\u5dee\u5206\u6570\u7ec4\n\t}\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint opt,x,y,k;\n\t\tcin>>opt>>x;\n\t\tif(opt==1)\n\t\t{\n\t\t\tcin>>y>>k;\n\t\t\tmodify(x,k);\n\t\t\tmodify(y+1,-k);//\u4fee\u6539\u4e24\u6b21\u5dee\u5206\u6570\u7ec4\uff0c\u5c31\u5b8c\u6210\u533a\u95f4\u4fee\u6539\u5e8f\u5217\n\t\t}\n\t\tif(opt==2)\n\t\t cout<<query(x)<<endl;//\u76f4\u63a5\u8f93\u51fa\u5373\u53ef\uff0c\u539f\u56e0\u8bf4\u8fc7\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1581663511,
        "uid": 80049,
        "name": "Hexarhy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "# \u6811\u72b6\u6570\u7ec4\u8fd8\u884c\u5427\n###### ~~\u6211\u8fd8\u662f\u60f3\u53eb\u4ed6\u6811\u6570\u7ec4~~\n\n\u4eca\u5929\u6211\u4eec\u5b66\u6811\u72b6\u6570\u7ec4\uff0c\u8001\u5e08\u7684\u9898\u6211\u4e0d\u4f1a\uff0c\u5c31\u6765\u770b\u770b\u6a21\u677f\uff0c\u987a\u4fbf\u53d1\u4e00\u6761\u5904\u5973\u9898\u89e3\u3002\u5927\u4f6c\u4eec\u90fd\u5728\u5237\u84dd\u9898\u7d2b\u9898\uff0c\u4e5f\u5c31\u6211\u8fd9\u6837\u7684\u849f\u84bb\u5199\u6a21\u677f\u3002\u3002\u3002\n\u4e8e\u662f\u770b\u770b\u6211\u7684\u6210\u679c\n\n### \u5e94\u8be5\u662f\u5dee\u5206\u6765\u641e\n\n\u4e4b\u524d\u6ca1\u7814\u7a76\uff0c\u521a\u521a\u53d1\u73b0\u5dee\u5206\u633a\u597d\u7528\n\n### \u5dee\u5206\n\u5bf9\u4e8e\u4e00\u4e2a\u6570\u7ec4\uff0c\u6709\u5dee\u5206\u5e8f\u5217 b[1]=a[1];b[i]=a[i]-a[i-1];\n\n\u6bd4\u5982A={a1,a2,a3,a4,a5};\n\n\u5219\u6709B={a1,a2-a1,a3-a2,a4-a3,a5-a4};\n\n#### \u4ed6\u548c\u524d\u7f00\u53ef\u4ee5\u4e92\u9006\u8fd0\u7b97\n\n\u5bf9B\u6709S={a1,a2-a1+a1,a3-a2+a2-a1+a1....}\n\n\u53caS={a1,a2,a3,a4,a5}\n\n\u5dee\u5206\u7684\u524d\u7f00\u5c31\u662f\u539f\u6570\u7ec4\uff0c\u540c\u7406\uff0c\u524d\u7f00\u7684\u5dee\u5206\u662f\u539f\u6570\u7ec4\n\n```cpp\nb[1]=a[1];\nfor(int i=1;i<=n;i++){//\u7ef4\u62a4\u4e00\u4e0b\u5dee\u5206\n\tb[i]=a[i]-a[i-1];\n}       \ncin>>x>>y>>k;\nb[x]+=k;//\u4fee\u6539\u5de6\u53f3\u8282\u70b9\u7684\u5dee\u5206\u503c\uff08\u8fde\u8d77\u6765\u8bfb\uff09\nb[y+1]-=k;//\u8fd9\u6837\u5c31\u80fd\u591f\u4f7f\u53ea\u6709\u8fd9\u4e00\u6bb5\u7684\u6570\u636e\u6539\u53d8\nfor(int i=1;i<=n;i++){//\u56e0\u4e3a\u8981\u518d\u7b97\u524d\u7f00b[y]-k\n\ts[i]=b[i]+b[i-1];//\u540e\uff0c\u540e\u9762\u5c31\u4e0d\u5f71\u54cd\u4e86\n}\n\n```\n\u8fd9\u6837\u4e00\u6765\uff0c\u7f8e\u6ecb\u6ecb\u3002\n\n\u5dee\u5206 \u6811\u6570\u7ec4\uff08\u53eb\u7740\u633a\u8212\u670d\u7684\uff09\n### \u539f\u6570\u7ec4\n\u539f\u6570\u7ec4\u6bcf\u6b21\u8bfb\u5165\u65f6\uff0c\u51cf\u53bb\u524d\u4e00\u4e2a\uff0c\u518d\u52a0\u5230\u6811\u6570\u7ec4\u91cc\uff0c\u8fd9\u6837\u5c31\u5dee\u5206\u4e86\u3002\n### \u64cd\u4f5c\n\u6bcf\u6b21\u8bfb\u5165\u64cd\u4f5c\uff0c\u6709\u5de6\u53f3\u4e24\u4e2a\u8282\u70b9\uff0c\u4e2d\u95f4\u52a0k\uff0c\n\n\u6839\u636e\u6811\u72b6\u6570\u7ec4\u7684\u6027\u8d28\uff0c\u53ea\u9700\u8981\u524d\u540e\u8282\u70b9\u90fd\u7ef4\u62a4\u5c31\u884c\u4e86\n```\nvoid add(int x,int k){\n\n\twhile(x<=n){\n\t\tc[x]+=k;\n\t\tx+=lowbit(x);\n\t}\n}\n\nadd(x,k);\nadd(y+1,-k);\n```\n\n\n### \u63d0\u53d6\n\n\u56e0\u4e3a\u6211\u4eec\u7528\u7684\u662f\u5dee\u5206\uff0c\u8be5\u8282\u70b9\u7684\u7ed3\u675f\u503c\u5c31\u662f\u6b64\u65f6\u5dee\u5206\u6570\u7ec4\u7684\u524d\u7f00\uff0c\u4e8e\u662f\n\n```\nint ans(int x){\n\tint an=0;\n\twhile(x>0){\n\t\tan+=c[x];\n\t\tx-=lowbit(x);\n\t}\n\treturn an;\n}\nprintf(\"%d\\n\",ans(a));\n```\n\u6700\u540e\u662f\u5b8c\u6574\u4ee3\u7801\n```\n#include<bits/stdc++.h>\nusing namespace std;\nint c[500050],n,m;\n\nint lowbit(int x){\t//lowbit\u64cd\u4f5c\n\treturn x&(-x);\n}\n\nvoid add(int a,int x){\t//\u66f4\u6539\u6570\u503c\n\twhile(x<=n){\n\t\tc[x]+=a;\n\t\tx+=lowbit(x);\n\t}\n}\n\nint ans(int x){\t//\u63d0\u53d6\u6570\u503c\n\tint an=0;\n\twhile(x>0){\n\t\tan+=c[x];\n\t\tx-=lowbit(x);\n\t}\n\treturn an;\n}\n\nint main(){\n\tscanf(\"%d\",&n);\n\tint la=0,a;\n\tmemset(c,0,sizeof(c));\t//\u597d\u4e60\u60ef\uff08\u5b66\u957f\u8840\u7684\u6559\u8bad\n\tfor(int i=1;i<=n;i++){\t//\u8bfb\u5165\u65f6\u5dee\u5206\n\t\tscanf(\"%d\",&a);\n\t\tadd(a-la,i);\n\t\tla=a;\n\t}\n\t\n\tint k,a,b,aa;\n\tfor(int i=1;i<=m;i++){\t//\u5343\u4e07\u4e0d\u8981\u76f4\u63a5scanf(\"%d%d%d%d\"&k,&a,&b,&aa);\u4f1a\u72060\n\t\tscanf(\"%d\",&k);\n\t\tif(k==1){\n\t\t\tscanf(\"%d%d%d\",&a,&b,&aa);\n\t\t\tadd(aa,a);\n\t\t\tadd(-aa,b+1);\n\t\t}\n\t\telse {\n\t\t\tscanf(\"%d\",&a);\n\t\t\tprintf(\"%d\\n\",ans(a));\n\t\t}\n\t}\n\treturn 0;\n} \n\n```\n\u7801\u98ce\u6bd4\u8f83\u5783\u573e\uff0c\u8bf7\u89c1\u8c05\n\n\u65b0\u73a9\u5bb6\uff0c\u6bd4\u8f83\u83dc\uff0c\u5e0c\u671b\u5927\u4f6c\u6307\u5bfc\n\n",
        "postTime": 1561638260,
        "uid": 197283,
        "name": "you_xiao",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "### \u5f15\u5165\n**\u6811\u72b6\u6570\u7ec4\u662f\u4ec0\u4e48\uff1f**\n\n\u6811\u72b6\u6570\u7ec4\u662f\u4e00\u4e2a\u67e5\u8be2\u548c\u4fee\u6539\u590d\u6742\u5ea6\u90fd\u4e3alog(n)\u7684\u6570\u636e\u7ed3\u6784\u3002\u4e3b\u8981\u7528\u4e8e\u67e5\u8be2\u4efb\u610f\u4e24\u4f4d\u4e4b\u95f4\u7684\u6240\u6709\u5143\u7d20\u4e4b\u548c\uff0c\u4f46\u662f\u6bcf\u6b21\u53ea\u80fd\u4fee\u6539\u4e00\u4e2a\u5143\u7d20\u7684\u503c;\u7ecf\u8fc7\u7b80\u5355\u4fee\u6539\u53ef\u4ee5\u5728log(n)\u7684\u590d\u6742\u5ea6\u4e0b\u8fdb\u884c\u8303\u56f4\u4fee\u6539\uff0c\u4f46\u662f\u8fd9\u65f6\u53ea\u80fd\u67e5\u8be2\u5176\u4e2d\u4e00\u4e2a\u5143\u7d20\u7684\u503c(\u5982\u679c\u52a0\u5165\u591a\u4e2a\u8f85\u52a9\u6570\u7ec4\u5219\u53ef\u4ee5\u5b9e\u73b0\u533a\u95f4\u4fee\u6539\u4e0e\u533a\u95f4\u67e5\u8be2)\u3002\uff08by \u767e\u5ea6\u767e\u79d1\uff09\n\n\u7b80\u5355\u70b9\u8bf4\uff0c\u5c31\u662f\u4e00\u4e2a\u53ef\u4ee5\u5f88\u5feb\u533a\u95f4\u4fee\u6539\uff0c\u5355\u70b9\u4fee\u6539\uff0c\u533a\u95f4\u67e5\u8be2\uff0c\u5355\u70b9\u67e5\u8be2\u7684\u6570\u636e\u7ed3\u6784\n\n\u9898\u5916\u8bdd\uff1a\u5176\u5b9e\u7ebf\u6bb5\u6811\u4e5f\u53ef\u4ee5\u505a\u5230\u8fd9\u4e00\u70b9\uff0c\u5e76\u4e14\u6bd4\u6811\u72b6\u6570\u7ec4\u53ef\u5b9e\u73b0\u7684\u4e1c\u897f\u591a\u5f97\u591a\uff0c\u4f46\u662f\u56e0\u4e3a\u6811\u72b6\u6570\u7ec4\u7b80\u5355\u597d\u5199\uff0c\u4e14\u6548\u7387\u8fd8\u8981\u9ad8\u4e9b\uff0c\u6240\u4ee5\u5728\u8fd9\u9898\u6211\u4eec\u5199\u6811\u72b6\u6570\u7ec4\n\n### \u600e\u4e48\u505a\uff1f\n\n\u9065\u60f3\u6211\u5f53\u5e74\u4e00\u9053\u9ec4\u9898\u6ca1\u505a\u8fc7\u5c31\u70b9\u5f00\u4e86\u8fd9\u9898\uff0c\u6b38\uff1f\u8fd9\u4e48\u7b80\u5355\uff1f\u96be\u9053\u4eba\u751f\u7b2c\u4e00\u9053\u9ec4\u9898\u5c31\u662f\u8fd9\u9053\u4e86\u5417\uff1f\u7136\u540e\u6211\u5c31\u4ea4\u4e86\u4e00\u4e2a\u8fd9\u6837\u7684\u7a0b\u5e8f\uff1a\n```\nfor(int j=l;j<=r;j++) a[j]+=k;\n```\n\u6b38\uff0c\u600e\u4e48\u4e0d\u5bf9\uff1f\u70b9\u5f00\u9898\u89e3\u4e24\u5206\u949f\u540e\uff0c\u6211\u9ed8\u9ed8\u5730\u5173\u6389\u4e86\u9875\u9762...\n\n\u626f\u8fdc\u4e86\uff0c\u8bb2\u6b63\u7ecf\u7684,\u5176\u5b9e\u6811\u72b6\u6570\u7ec4\u8ddf\u6811\u7684\u5173\u7cfb\u5e76\u4e0d\u592a\u5927\uff0c\u5f53n=8\u65f6\uff0c\u5b83\u662f\u4e0b\u9762\u8fd9\u4e2a\u6837\u5b50\u7684\uff1a\n(A\u662f\u8f93\u5165\u7684\u6570\u7ec4\uff0cC\u662f\u6211\u4eec\u7684\u6811\u72b6\u6570\u7ec4\uff09\n![](http://images.cnblogs.com/cnblogs_com/wxl-Ezio/1173002/o_QQ%e6%88%aa%e5%9b%be20180412203826.png)\n\u5176\u4e2d\n\n$C[1]=A[1]$\n\n$C[2]=A[1]+A[2]$\n\n$C[3]=A[3]$\n\n$C[4]=A[1]+A[2]+A[3]+A[4]$\n\n$C[5]=A[5]$\n\n$C[6]=A[5]+A[6]$\n\n$C[7]=A[7]$\n\n$C[8]=A[1]+A[2]+A[3]+A[4]+A[5]+A[6]+A[7]+A[8]$\n\n\u4ee5\u6b64\u7c7b\u63a8\n\n\u90a3\u4e48\u8fd9\u9897\u6811\u6709\u4ec0\u4e48\u7528\u5462\uff1f\n\n\u5047\u8bbe\u6211\u4eec\u8981\u7ed9$A[1]$\u52a0\u4e0a1\uff0c\u54ea\u4e9b\u6570\u503c\u4f1a\u88ab\u6539\u53d8\uff1f\n\n$C[1],C[2],C[4],C[8],C[16]...$\n\n$A[2]$\u5462\uff1f\n\n$C[2],C[4],C[8],C[16]$\n\n$A[3]$\n\n$C[3],C[4],C[8],C[16]$\n\n$A[5]$\n\n$C[5],C[6],C[8],C[16]$\n\n\u6211\u76f8\u4fe1\u4f60\u770b\u51fa\u89c4\u5f8b\u4e86\uff0c\u5bf9\u5427\uff08\u9003\n\n\u597d\u5427\u4f60\u53ea\u8981\u77e5\u9053\uff0c\u5982\u679c\u7ed9$A[I]+K$\uff0c\u8bbe$I$\u4e8c\u8fdb\u5236\u6700\u540e\u4e00\u4f4d$1$\u6240\u5728\u7684\u4f4d\u7f6e\u662f$q$,\u90a3\u4e48$C[I]$\u548c$C[I+q]$\u90fd\u4f1a$+K$\u5c31\u884c\u4e86\uff08$I$\u548c$q$\u4e0d\u65ad\u66f4\u65b0\uff09\n\n//\u8fd9LATEX\u7ed9\u6211\u5199\u5410\u4e86\n\n\u6bd4\u5982\u8bf4$A[5]$\n\n$5$\u7528\u4e8c\u8fdb\u5236\u662f$101$,\u6240\u4ee5$C[5]+=k$\u7684\u503c\u4f1a\u4f7f$C[101+1]$\u5373$C[6]+=k$\n\n\u800c$C[6]+=k$\u65f6,\u56e0\u4e3a$6=110$\u540c\u65f6\u53c8\u4f1a\u4f7f$C[110+10]$\u5373$C[8]+=k$\n\n\u7136\u540e$C[8]+=k$\u53c8\u4f1a\u4f7f$C[16]+=k$\n\n\u4ee5\u6b64\u7c7b\u63a8,\u76f4\u5230\u8981\u8d85\u8fc7$n$\n\n//\u5455~\u5478\n\n### \u4ee3\u7801\u5b9e\u73b0\n\n\u9996\u5148\uff0c**\u5355\u70b9\u4fee\u6539**\u600e\u4e48\u505a\uff1f\n\n\u4ecb\u7ecd\u4e00\u4e2a\u4e1c\u897f\u53eb$lowbit$\uff0c\u8fd9\u4e2a\u4e1c\u897f\u662f\u7528\u6765\u6c42\u51fa\u4e00\u4e2a\u6570\u8f6c\u5316\u4e3a\u4e8c\u8fdb\u5236\u540e\uff0c\u6700\u540e\u4e00\u4e2a1\u6240\u5728\u7684\u4f4d\u7f6e\n\n\u522b\u60f3\u4e86\uff0c\u4e0d\u662f\u7cfb\u7edf\u81ea\u5e26\u7684\u51fd\u6570\uff0c\u8981\u81ea\u5df1\u5199\u7684\n\n\u5b83\u7684\u5199\u6cd5\u662f\n\n```\nint lowbit(int k){\n\treturn k&-k;\n}\n```\n\u795e\u5947\u5417\uff1f\u4e3a\u4ec0\u4e48\u5462\uff1f\u9996\u5148\uff0c&\u7b26\u53f7\u662f\u4e0e\uff0c-k\u56e0\u4e3a\u8865\u7801\u7684\u539f\u56e0\uff0c\u4ece\u53f3\u5411\u5de6\u9047\u5230\u7b2c\u4e00\u4e2a1\u4e3a\u6b62\uff0c\u8fd9\u4e2a1\u524d\u9762\u7684\u4f4d\u53d6\u53cd\uff0c\u9996\u4f4d\u4e0d\u52a8\n\n\u90a3\u4e48\u518d\u5229\u7528\u4e0e\u8fd0\u7b97\u53ea\u53d6\u4e24\u4e2a1\u7684\u7279\u6027\uff0c\u6211\u4eec\u5c31\u8fd4\u56de\u4e86\n$2^p$(\u5176\u4e2d$p: k$ \u7684\u4e8c\u8fdb\u5236\u8868\u793a\u6570\u4e2d\uff0c \u53f3\u5411\u5de6\u6570\u7b2c\u4e00\u4e2a1\u7684\u4f4d\u7f6e)\n\n\u597d\u4e86\uff0c\u90a3\u4e48\u600e\u4e48add\u5462\uff1f\u521a\u521a\u5df2\u7ecf\u8bb2\u8fc7\u4e86\uff0c\u5982\u679c\u7ed9$A[I]+K$\uff0c\u8bbe$I$\u4e8c\u8fdb\u5236\u6700\u540e\u4e00\u4f4d$1$\u6240\u5728\u7684\u4f4d\u7f6e\u662f$q$,\u90a3\u4e48$C[I]$\u548c$C[I+q]$\u90fd\u4f1a$+K$\n\n\u4ee3\u7801\u5c31\u662f\n```\nvoid add(int x,int q){\n\twhile(x<=n){\n\t\ta[x]+=q;\n\t\tx+=lowbit(x);\n\t}\n}\n```\n\u5f88\u7b80\u5355\uff0c\u4e0d\u662f\u5417\n\n\u90a3\u4e48\u7b2c\u4e8c\u4e2a\uff0c**\u533a\u95f4\u67e5\u8be2**\u5462\uff1f\n\n\u6211\u4eec\u7528\u524d\u7f00\u548c\u7684\u601d\u60f3\uff0c$x$\u5230$y$\u7684\u548c\uff0c\u90a3\u4e48\u5c31\u5c06\u4ece$1$\u5230$y$\u7684\u548c\u51cf\u53bb\u4ece$1$\u5230$x-1$\u7684\u548c\u3002\n\n$1$\u5230$x$\u7684\u548c\u6c42\u6cd5\u662f\uff0c\u5c06$x$\u8f6c\u4e3a$2$\u8fdb\u5236\uff0c\u7136\u540e\u4e00\u76f4\u51cf\u53bb$lowbit(x)$\uff0c\u76f4\u5230$0$\n\n```\nint sum(int x){\n\tans=0;\n\twhile(x){\n\t\tans+=a[x];\n\t\tx-=lowbit(x);\n\t}\n\treturn ans;\n}\n```\n\u597d\u4e86\uff0c\u90a3\u4e48\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5ACP3374\u4e86\uff0c\u4f46\u6211\u4eec\u8fd8\u8981ACP3368\n\n\u90a3\u4e48\u5c31\u8981\u8bb2\u5230\u5dee\u5206\n\n\u5dee\u5206\u662f\u4ec0\u4e48\uff1f\u8bbe\u6570\u7ec4$a=${$1,2,3,6,4$}\uff0c\u90a3\u4e48\u5dee\u5206\u6570\u7ec4$b=${$1,1,1,3,-2$}\uff0c$b[i]=a[i]-a[i-1]$,\u90a3\u4e48\u5f88\u663e\u7136\uff0c\u6c42$a[i]$\u5c31\u662f$b[1]+b[2]+...+b[i]$\n\n\u5047\u8bbe\u6211\u4eec\u4f4d\u533a\u95f4{2\uff0c4}\u90fd+3\uff0c\u90a3\u4e48\u6570\u7ec4$a$\u53d8\u4e3a{$1,5,6,9,4$},$b$\u53d8\u4e3a{$1,4,1,3,-5$}\n\n\u770b\uff0c\u53ea\u6709$b[2]$\u548c$b[5]$\u53d8\u4e86\uff0c\u8fd9\u662f\u56e0\u4e3a2\u52304\u90fd\u52a0\u4e862\uff0c\u90a3\u4e48\u5dee\u5e76\u4e0d\u4f1a\u53d8\n\n\u6240\u4ee5\u600e\u6837\u7ed9\u533a\u95f4\u52a0\u548c\u5462\uff1f\u6211\u4eec\u5148\u628a\u6811\u72b6\u6570\u7ec4\u53d8\u4e3a\u5dee\u5206\u6570\u7ec4\uff0c\u7136\u540e\u518d\u52a0\u65f6\u76f4\u63a5\u52a0b[x-1]\u548cb[y]\uff0c\u8fd9\u9898\u5c31\u89e3\u51b3\u4e86\n\nP3374 \u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 1 \u4ee3\u7801\n```\n#include<bits/stdc++.h>\nint n,m,a[500005],ans,w,xx,yy,zz; \nusing namespace std;\nint lowbit(int k){\n\treturn k&-k;\n}\nvoid add(int x,int q){\n\twhile(x<=n){\n\t\ta[x]+=q;\n\t\tx+=lowbit(x);\n\t}\n}\nint sum(int x){\n\tans=0;\n\twhile(x){\n\t\tans+=a[x];\n\t\tx-=lowbit(x);\n\t}\n\treturn ans;\n}\nint main(){\n\tcin>>n>>m;\n\tfor(int i=1;i<=n;i++){\n\t\tcin>>w;\n\t\tadd(i,w);\n\t}\n\tfor(int i=1;i<=m;i++){\n\t\tcin>>xx>>yy>>zz;\n\t\tif(xx==1) add(yy,zz);\n\t\telse cout<<sum(zz)-sum(yy-1)<<endl;\n\t}\n\treturn 0;\n}\n\n```\nP3368 \u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2 \u4ee3\u7801\n```\n#include<bits/stdc++.h>\nint n,m,a[500005],ans,w,xx,yy,zz,kk,lst; \nusing namespace std;\nint lowbit(int k){\n\treturn k&-k;\n}\nvoid add(int x,int q){\n\twhile(x<=n){\n\t\ta[x]+=q;\n\t\tx+=lowbit(x);\n\t}\n}\nint cx(int x){\n\tans=0;\n\twhile(x){\n\t\tans+=a[x];\n\t\tx-=lowbit(x);\n\t}\n\treturn ans;\n}\nint main(){\n\tcin>>n>>m;\n\tfor(int i=1;i<=n;i++){\n\t\tcin>>w;\n\t\tadd(i,w-lst);\n\t\tlst=w;\n\t}\n\tfor(int i=1;i<=m;i++){\n\t\tcin>>xx;\n\t\tif(xx==1){\n\t\t\tcin>>yy>>zz>>kk;\n\t\t\tadd(yy,kk);\n\t\t\tadd(zz+1,-kk);\n\t\t} \n\t\telse{\n\t\t\tcin>>yy;\n\t\t\tcout<<cx(yy)<<endl;\n\t\t} \n\t}\n\treturn 0;\n}\n\n```\n\u5199\u4e86\u975e\u5e38\u4e45\uff0c\u751a\u81f3\u4e27\u5fc3\u75c5\u72c2\u7684\u628a\u6240\u6709\u6570\u5b57\u548c\u5b57\u6bcd\u90fd\u52a0\u4e86LATEX\n\n\u6211\u75af\u4e86\uff0c\u7ba1\u7406\u5458\u8fc7\u5427",
        "postTime": 1571843237,
        "uid": 123936,
        "name": "hfee",
        "ccfLevel": 5,
        "title": "\u6d45\u8c08\u6811\u72b6\u6570\u7ec4"
    },
    {
        "content": "#### \u9898\u76ee\u63cf\u8ff0\n\n\u533a\u95f4\u4fee\u6539\uff0c\u5355\u70b9\u8be2\u95ee\n\n#### \u601d\u8def\u7b80\u8ff0\n\n\u6211\u4eec\u770b\u5230\u9898\u76ee\u662f\"\u6811\u72b6\u6570\u7ec4\"\uff0c\u4f46\u662f\u8eab\u4e3a\u849f\u84bb\u7684\u6211\u603b\u662f\u5199\u4e0d\u5bf9\u5dee\u5206\uff0c\u4e8e\u662f\u6211\u4eec\u6765\u770b\u4e00\u770b\u4e00\u79cd**\u6700\u574f**\u590d\u6742\u5ea6\u4e3a$O(m\\sqrt n)$\u7684\u60f3\u6cd5\u2014\u2014\u5206\u5757\uff01\n\n\u5206\u5757\u7684\u4f18\u70b9\u5728\u4e8e\u5176\u6781\u5176\u597d\u5199\uff0c\u601d\u8def\u7b80\u5355\uff0c\u53ef\u89c6\u4e3a\u4e00\u79cd\u66b4\u529b\u7684\u6539\u8fdb\u7248\n\n\u6211\u4eec\u628a\u8fd9\u4e2a\u6570\u7ec4\u5206\u4e3a$\\sqrt n$\u5757\uff0c\u8fd9\u6837\u505a\u7684\u597d\u5904\u5f88\u660e\u663e\uff0c\u6bcf\u6b21\u8fdb\u884c\u4fee\u6539\u53ef\u76f4\u63a5\u5bf9\u6574\u5757\u8fdb\u884c\u52a0\u6cd5\uff0c\u4e0d\u662f\u6574\u5757\u5219\u4e00\u4e2a\u4e00\u4e2a\u52a0\uff0c\u4e24\u4e2a\u64cd\u4f5c\u7684\u590d\u6742\u5ea6\u5747\u4e3a$\\sqrt n$\u3002\u8be2\u95ee\u65f6\u53ea\u9700\u76f4\u63a5\u8f93\u51fa\u5757\u6240\u79ef\u7d2f\u7684\u548c\u52a0\u4e0a\u5728\u5904\u7406\u5355\u4e2a\u65f6\u6240\u79ef\u7d2f\u7684\u548c\u5373\u53ef\u3002\n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u73a9\u610f\u6700\u5927\u8dd1\u4e86500\u591ams\uff0c\u8fc7\u4e86\u672c\u9898\u3002\n\n#### \u4ee3\u7801\u53ca\u89e3\u91ca\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll z,y,x,t,L,n,m,a[500005],b[500005],c[10005];\n//a\u6570\u7ec4\u5b58\u50a8\u5355\u4e2a\u7d2f\u8ba1\u7684\u548c\n//b\u6570\u7ec4\u5b58\u50a8\u6539\u6570\u4f4d\u4e8e\u54ea\u4e00\u5757\n//c\u6570\u7ec4\u5b58\u50a8\u6574\u5757\u7d2f\u8ba1\u7684\u548c\nvoid add(ll x,ll y,ll z){\n\tif(b[x]==b[y])//\u8fd9\u91cc\u8981\u7279\u5224\n\t\tfor(ll i=x;i<=y;i++) a[i]+=z;\n\telse {\n\t\tfor(ll i=x;b[i]==b[x];i++) a[i]+=z;//\u5355\u5757\u7684\u548c\n\t\tfor(ll i=y;b[i]==b[y];i--) a[i]+=z;\n\t\tfor(ll k=b[x]+1;k<=b[y]-1;k++) c[k]+=z;//\u6574\u5757\u7684\u548c\n\t}\n}\nint main(){\n\tscanf(\"%lld%lld\",&n,&m);\n\tL=sqrt(n);//\u5757\u7684\u5927\u5c0f\n\tfor(int i=1;i<=n;i++) scanf(\"%lld\",&a[i]);\n\tfor(ll i=1;i<=n;i++) b[i]=(i-1)/L+1;//\u586b\u5199b\u6570\u7ec4\n\tfor(ll i=1;i<=m;i++){//\u6ca1\u4ec0\u4e48\u8981\u8bf4\u7684\n\t\tscanf(\"%lld%lld\",&t,&x);\n\t\tif(t==1){\n\t\t    scanf(\"%lld%lld\",&y,&z);\n\t\t\tadd(x,y,z);\n\t\t}\n\t\telse printf(\"%lld\\n\",(a[x]+c[b[x]]));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1576507546,
        "uid": 149872,
        "name": "\u5c0f\u5c0f\u5c0f\u670b\u53cb",
        "ccfLevel": 5,
        "title": "P3368 \u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2"
    },
    {
        "content": "\u4e4b\u524d\u770b\u4e86\u8bb8\u591a\u5927\u4f6c\u7684\u9898\u89e3\u849f\u84bb\u90fd\u4e0d\u592a\u660e\u767d\n\n\u6700\u540e\u8fd8\u662f\u81ea\u5df1\u770b\u7684\u5c0f\u4f19\u4f34\u7684\u4ee3\u7801\u624d\u604d\u7136\u5927\u609f\uff08\u53ef\u80fd\u662f\u56e0\u4e3a\u6211\u592a\u84bb\u4e86\uff09\n\n\u56e0\u6b64\u6211\u51b3\u5b9a\u5199\u4e00\u7bc7\u8be6\u7ec6\u7684\u9898\u89e3\n\n\uff08\u5982\u679c\u60a8\u8fd8\u672a\u63a5\u89e6\u8fc7\u6811\u72b6\u6570\u7ec4\uff0c\u8bf7\u5de6\u8f6c[\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 1](https://www.luogu.com.cn/problem/P3374)\uff09\n\n\n------------\n\n\u901a\u8fc7\u4e4b\u524d\u7684\u5b66\u4e60\u6211\u4eec\u5b66\u4f1a\u4e86\u8fd0\u7528\u6811\u72b6\u6570\u7ec4\u8fdb\u884c\u5355\u70b9\u4fee\u6539\u548c\u533a\u95f4\u67e5\u8be2\n\n\u4f46\u662f\u8fd9\u4e00\u9898\u8981\u6c42\u662f**\u533a\u95f4\u4fee\u6539\uff0c\u5355\u70b9\u67e5\u8be2**\n\n\u90a3\u6211\u4eec\u5c31**\u60f3\u529e\u6cd5\u628a\u533a\u95f4\u4fee\u6539\u3001\u5355\u70b9\u67e5\u8be2\u8f6c\u5316\u4e3a\u5355\u70b9\u4fee\u6539\u3001\u533a\u95f4\u67e5\u8be2**\u5457\n\n\n------------\n\u600e\u4e48\u8f6c\u5316\u5462\uff1f\u8fd9\u91cc\u6211\u4eec\u8981\u5f15\u5165\u4e00\u4e2a\u65b0\u6982\u5ff5\uff1a**\u5dee\u5206**\n\n\u5dee\u5206\u662f\u5565\uff1f\u7b80\u5355\u7684\u8bf4\uff0c\u5dee\u5206\u5c31\u662f\u6307**\u4e24\u9879\u4e4b\u5dee**\n\n\u5982\u679c\u6211\u4eec\u5bf9\u4e00\u4e2a\u542b\u6709$n$\u4e2a\u5143\u7d20\u7684\u6570\u7ec4$a$\u8fdb\u884c\u5dee\u5206\u7684\u8bdd\uff0c\u4f1a\u5f97\u5230\u53e6\u4e00\u4e2a\u6570\u7ec4$b$\n\n\u5176\u4e2d\uff0c$b_{i}=a_{i}-a_{i-1}$ $(2<=i<=n)$\n\n\u7279\u522b\u5730\uff0c$b_{1}=a_{1}$\n\n\u6211\u4eec\u59d1\u4e14\u628a$b$\u6570\u7ec4\u79f0\u4e3a$a$\u6570\u7ec4\u7684**\u5dee\u5206\u6570\u7ec4**\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff1a\n```\n\u5982\u679c\u539f\u6570\u7ec4a\u4e3a\uff1a1 3 6 7 9 13\n\u5219\u5dee\u5206\u6570\u7ec4b\u4e3a\uff1a1 2 3 1 2 4\n```\n------------\n\u597d\uff0c\u7406\u89e3\u4e86\u5dee\u5206\uff0c\u6211\u4eec\u7ec8\u4e8e\u8981\u6b65\u5165\u6b63\u9898\u4e86\n\n\u4ed4\u7ec6\u89c2\u5bdf\u521a\u624d\u7684\u4f8b\u5b50\uff0c\u6709\u6ca1\u6709\u53d1\u73b0\u4ec0\u4e48\u89c4\u5f8b\uff1f\n\n$a_{1}=b_{1};$\n\n$a_{2}=b_{1}+b_{2};$\n\n$a_{3}=b_{1}+b_{2}+b_{3};$\n\n\u2026\u2026\n\n\u4e0d\u96be\u8bc1\u660e$a_{i} =$ $\\sum_{k=1}^{i}b_{k}$\n\n\u56e0\u6b64\uff0c\u5982\u679c\u6211\u4eec\u5148\u628a\u7ed9\u5b9a\u6570\u7ec4$a$\u7684\u5dee\u5206\u6570\u7ec4$b$\u6c42\u51fa\u6765\n\n\u90a3\u6211\u4eec\u7684\u5355\u70b9\u67e5\u8be2$a_{i}$\u4e0d\u5c31\u53d8\u6210\u533a\u95f4\u67e5\u8be2$\\sum_{k=1}^{i}b_{k}$\u4e86\u5417\uff1f\n\n\u60a8\u53ef\u80fd\u89c9\u5f97\u8fd9\u6709\u70b9\u50bb\uff0c\u4e0d\u8981\u7740\u6025\uff0c\u6211\u4eec\u63a5\u7740\u6765\u770b\u533a\u95f4\u4fee\u6539\n\n\n------------\n\u5728\u8fd9\u4e00\u9898\u4e2d\uff0c\u5dee\u5206\u6570\u7ec4\u6700\u5927\u7684\u597d\u5904\u5c31\u4f53\u73b0\u5728\u533a\u95f4\u4fee\u6539\u4e0a\n\n\u8fd8\u662f\u4e4b\u524d\u90a3\u4e2a\u4f8b\u5b50\uff1a\n```\na\uff1a1 3 6 7 9 13 \u539f\u6570\u7ec4\nb\uff1a1 2 3 1 2 4  \u5dee\u5206\u6570\u7ec4\n```\n\n\u73b0\u5728\u6211\u8981\u6c42\u628a\u533a\u95f4[2,5]\u7684\u5143\u7d20\u90fd\u52a0\u4e0a4\n\n\u90a3\u4e48\u5c31\u53d8\u6210\u4e86\u8fd9\u4e2a\u4e9a\u5b50\uff1a\n```\na: 1 7 10 11 13 13\nb: 1 6 3  1  2  0\n```\n\u8bf6\uff1f\u8c8c\u4f3cb\u6570\u7ec4\u4e2d\u53ea\u6709$b_{2}$\u548c$b_{6}$\u53d1\u751f\u4e86\u6539\u53d8\n\n\u90a3\u6211\u4eec\u53ef\u4ee5\u5927\u80c6\u731c\u6d4b\u4e00\u4e0b\uff1a\n\n**\u533a\u95f4\u4fee\u6539[$i$,$j$]\uff0c\u90fd\u52a0\u4e0a$v$\uff0cb\u6570\u7ec4\u4e2d\u53ea\u6709$b_{i}$\u548c$b_{j+1}$\u4f1a\u53d1\u751f\u6539\u53d8**\n\n\n------------\n\n \u4e3a\u4ec0\u4e48\uff1f\u56e0\u4e3a\u5bf9\u4e8e$b_{k}$ $(k\\in{i+1,j})$\n\n\u7531\u4e8e$b_ {k}=a_ {k} -a _ {k-1}$ **\u4e14$a_ {k}$\u548c$a_ {k-1}$\u540c\u65f6\u52a0\u4e0a\u4e86$v$**\n\n\u6240\u4ee5$a_ {k}$\u548c$a_ {k-1}$\u7684\u5dee\u4e0d\u4f1a\u53d8\uff0c\u6545$b_{k}$\u7684\u503c\u4e0d\u53d8\n\n\u90a3\u4e48$b_ {i}$\u548c $b_ {j+1}$\u7684\u503c\u53c8\u4f1a\u600e\u4e48\u53d8\u5316\u5462\uff1f\n\n\u56e0\u4e3a$b_ {i}=a_ {i}-a_ {i-1}$ \n\n\u53c8\u56e0\u4e3a$a_ {i-1}$\u7684\u503c\u6ca1\u6709\u6539\u53d8\uff0c$a_ {i}$\u7684\u503c\u52a0\u4e0a\u4e86$v$\n\n\u6545$b_ {i}$\u7684\u503c\u4f1a\u52a0\u4e0a$v$\n\n\u540c\u7406\uff0c$b_ {j+1}$\u7684\u503c\u4f1a\u51cf\u53bb$v$\uff0c\u4e5f\u5c31\u662f\u52a0\u4e0a$-v$\n\n\n------------\n\u603b\u7ed3\u4e00\u4e0b\uff0c**\u5c06\u533a\u95f4[$i$,$j$]\u7684\u503c\u90fd\u52a0\u4e0a$v$**\n\n**\u5c31\u76f8\u5f53\u4e8e\u628a$b_{i}$\u7684\u503c\u52a0\u4e0av\uff0c\u628a$b_{j+1}$\u7684\u503c\u52a0\u4e0a$-v$**\n\n\u6211\u4eec\u53c8\u628a\u533a\u95f4\u4fee\u6539\u8f6c\u5316\u6210\u4e86\u4e24\u6b21\u5355\u70b9\u4fee\u6539\uff0c\u771f\u662f\u592a\u68d2\u4e86\uff01\n\n\n------------\n\u90a3\u6211\u4eec\u5bf9\u4e8e\u7ed9\u5b9a\u7684\u6570\u7ec4$a$\uff0c**\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u5176\u5dee\u5206\u6570\u7ec4**$b$\n\n\u5355\u70b9\u67e5\u8be2$a_{i}$=\u533a\u95f4\u67e5\u8be2$\\sum_{k=1}^{i}b_{k}$\n\n\u533a\u95f4\u4fee\u6539$a_{i,j}$\uff0c\u5c06\u5176\u52a0\u4e0av =\u5355\u70b9\u4fee\u6539$a_{i}$,$a_{j+1}$\n\n\u7279\u522b\u8981\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u91cc\u6211\u4eec**\u7ef4\u62a4\u7684\u662f\u5dee\u5206\u6570\u7ec4**\n\n\n------------\n\u4ee3\u7801\u6765\u4e86~\n```cpp\n#include<iostream>\n#include<cstdio>\n#define maxn 500001\n#define fo(x,y) for(register int i=x;i<=y;++i)\n//\u5b8f\u5b9a\u4e49\u7b80\u5316for\u5faa\u73af\nusing namespace std;\nint n,tree[maxn];//n\u4e3a\u5143\u7d20\u4e2a\u6570\uff0ctree\u6570\u7ec4\u7528\u6765\u7ef4\u62a4\u5dee\u5206\u6570\u7ec4\ninline int lowbit(int x){//\u8001\u751f\u5e38\u8c08\u7684lowbit\u51fd\u6570\n\treturn (x-(x&(x-1)));//\u8fd9\u91cc\u6362\u4e86\u4e00\u79cd\u5f62\u5f0f\n} \ninline void update(int x,int v){\n//\u5355\u70b9\u4fee\u6539\uff1a\u5c06\u4e0b\u6807\u4e3ax\u7684\u5143\u7d20\u52a0\u4e0av\n\twhile(x<=n){\n\t\ttree[x]+=v;\n\t\tx+=lowbit(x);\n\t}\n}\ninline int ask(int x){\n//\u533a\u95f4\u67e5\u8be2[1,x]\uff0c\u5728\u8fd9\u4e00\u9898\u4e2d\u7b49\u4ef7\u4e8e\u5355\u70b9\u67e5\u8be2x\n\tint ans=0;\n\twhile(x){\n\t\tans+=tree[x];\n\t\tx-=lowbit(x);\n\t}\n\treturn ans;\n} \nint main(){\n\tint m,last=0,t,x,y,k;\n//last\u7528\u6765\u8bb0\u5f55\u4e0a\u4e00\u4e2a\u5143\u7d20\uff0ct\u7528\u6765\u8bb0\u5f55\u5f53\u524d\u5143\u7d20\n//\u4e24\u8005\u76f8\u51cf\u53ef\u5f97\u5230\u5dee\u5206\u6570\u7ec4\n\tcin>>n>>m;\n\tfo(1,n){\n\t\tscanf(\"%d\",&t);\n\t\tupdate(i,t-last);//\u5355\u70b9\u4fee\u6539\uff0c\u7ef4\u62a4\u5dee\u5206\u6570\u7ec4\n\t\tlast=t;\n\t}\n\tfo(1,m){\n\t\tscanf(\"%d%d\",&t,&x);\n\t\tif(t==1){//\u533a\u95f4\u4fee\u6539\n\t\t\tscanf(\"%d%d\",&y,&k);\n\t\t\tupdate(x,k);//\u7b49\u4ef7\u4e8e\u4e24\u6b21\u5355\u70b9\u4fee\u6539\n\t\t\tupdate(y+1,-k);\n\t\t}\n\t\telse{//\u5355\u70b9\u67e5\u8be2\n\t\t\tprintf(\"%d\\n\",ask(x));//\u7b49\u4ef7\u4e8e\u533a\u95f4\u67e5\u8be2\n\t\t}\n\t}\n\treturn 0;\n}\n\n```\n\u70b9\u4e2a\u8d5e\u518d\u8d70\u5427~",
        "postTime": 1580269052,
        "uid": 238408,
        "name": "vectorwyx",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "\t   \u770b\u5230\u6240\u6709\u4eba\u7684\u505a\u6cd5\u65e0\u975e\u5c31\u662f\u7ebf\u6bb5\u6811\u6216\u8005\u6811\u72b6\u6570\u7ec4+\u5dee\u5206\uff0c\n\t\u672c\u849f\u84bb\u5c31\u201c\u5927\u6750\u5c0f\u7528\u201d\u4e00\u6ce2\u2014\u2014\n# cdq\u5206\u6cbb\n## \t1.\u57fa\u672c\u601d\u60f3\n\t\u6211\u4eec\u4f9d\u7136\u662f\u5c06\u4e00\u4e2a\u5927\u533a\u95f4[l,r]\u5212\u5206\u4e3a2\u4e2a\u5c0f\u533a\u95f4[l,mid]\n    \u548c[mid+1,r]\u3002\u5bf9\u4e8e\u4e00\u822c\u7684\u5206\u6cbb\uff0c\u4e24\u4e2a\u5b50\u533a\u95f4\u662f\u5b8c\u5168\u7684\u4e24\n    \u4e2a\u5b50\u95ee\u9898\uff0c\u6ca1\u6709\u4efb\u4f55\u74dc\u845b\uff08\u672c\u849f\u84bb2018NOIPD1T1\u6253\u4e86100\n    \u591a\u884c\u7684\u5206\u6cbb\uff09\uff0ccdq\u5206\u6cbb\u7684\u7279\u522b\u4e4b\u5904\u5c31\u662f\uff0c\u4e00\u4e2a\u533a\u95f4\u4f1a\u5bf9\n    \u53e6\u4e00\u4e2a\u533a\u95f4\u4ea7\u751f\u5f71\u54cd\u3002\n##  2.\u7ecf\u5178\u5e94\u7528\n\t\u8bf8\u5982\u6c42\u9006\u5e8f\u5bf9\uff0c\u4e8c\u7ef4\u504f\u5e8f\uff0c\u4e09\u7ef4\u751a\u81f3n\u7ef4\u504f\u5e8f\u90fd\u80fd\u7528\u5230cdq\n    \u5206\u6cbb\u3002\u5728\u6b64\u5c31\u4e0d\u591a\u52a0\u8d58\u8ff0\u4e86\u3002\n###     ps:\u5982\u679c\u53ea\u662f\u60f3\u5feb\u901fA\u6389\u6b64\u9898\uff0c\u8bf7\u770b\u4e0b\u4e00\u7bc7\u9898\u89e3\u3002\n# P3368\n##  \u6811\u72b6\u6570\u7ec4\u533a\u95f4\u4fee\u6539\uff0c\u5355\u70b9\u67e5\u8be2\n\t\u6211\u4eec\u8003\u8651\u628a\u8fd9\u4e2a\u95ee\u9898\u8f6c\u5316\u6210\u4e00\u4e2a\u4e8c\u7ef4\u504f\u5e8f\u95ee\u9898\u3002\u7528\u4e00\u4e2a\u7ed3\n    \u6784\u4f53\u6765\u4fdd\u5b58\u6bcf\u6b21\u64cd\u4f5c\u3002\u7ed3\u6784\u4f53\u91cc\u67093\u4e2a\u53d8\u91cf\uff1asit(\u72b6\u6001\uff09,\n    posi(\u4f4d\u7f6e\u5750\u6807),w(\u6743\u503c)\u3002\u5f53sit=1\u65f6\uff0cw\u5b58\u7684\u662f\u672c\u6b21\u52a0\u4e0a\n    \u7684\u6570W\uff1bsit=2\u65f6\uff0cw\u5b58\u7684\u662f\u672c\u6b21\u67e5\u8be2\u7684\u7f16\u53f7\uff0c\u53730\uff0c1\uff0c2,\n    ......\n    \u6211\u4eec\u91c7\u7528\u5f52\u5e76\u6392\u5e8f\u7684\u601d\u60f3\uff0c\u5148\u641e\u5b9a\u4e24\u4e2a\u5b50\u533a\u95f4\u7684\u95ee\u9898\uff0c\u518d\n    \u548c\u8d77\u6765\u89e3\u51b3\u5f53\u524d\u533a\u95f4\u7684\u95ee\u9898\u3002\u8fd9\u6837\u64cd\u4f5c\u7684\u597d\u5904\u5c31\u662f\u4e24\u4e2a\u5b50\n    \u533a\u95f4\u5df2\u7ecf\u5b8c\u5168\u6709\u5e8f\u3002\u8fd9\u6837\uff0c\u56e0\u4e3a\u5de6\u533a\u95f4\u7684\u64cd\u4f5c\u65f6\u95f4\u90fd\u6bd4\u53f3\n    \u8fb9\u8981\u65e9\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5229\u7528\n####     \u5de6\u8fb9\u7684\u4fee\u6539\u6765\u5b8c\u6210\u53f3\u8fb9\u7684\u8be2\u95ee\u3002\n    \u8fd8\u6709\u4e00\u70b9\uff0c\u5c31\u662f\u6211\u4eec\u6c42\u51fa\u6765\u7684\u503c\u662f\u524d\u7f00\u548c\u5f62\u5f0f\u7684\uff0c\u6240\u4ee5\u8981\n    \u7528\u4e00\u4e0b\u2014\u2014\n###     \u5dee\u5206\n## \t\u770b\u4ee3\u7801\n\t```cpp\n\t#include<bits/stdc++.h>\n\tusing namespace std;\n\t#define re register int\n\t#define F(x,y,z) for(re x=y;x<=z;x++)\n\t#define FOR(x,y,z) for(re x=y;x>=z;x--)\n\t#define I inline void\n\t#define IN inline int\n\ttypedef long long ll;\n\tI read(int &res)\n\t{\n    \tre g=1;register char ch=getchar();res=0;\n    \twhile(!isdigit(ch))\n    \t{\n        if(ch=='-')g=-1;\n        ch=getchar();\n   \t\t }\n    \twhile(isdigit(ch))\n    \t{\n        res=(res<<3)+(res<<1)+(ch^48);\n        ch=getchar();\n    \t}\n    \tres*=g;\n\t}\n\tint n,m,tot=0,cnt=0,a[600000],S,X,Y,W,ans[500000];\n\tstruct Q\n\t{\n\t\tint sit,posi,w;\n\t\tfriend bool operator < (Q x,Q y)\n\t\t{\n\t\treturn x.posi==y.posi?x.sit<y.sit:x.posi<y.posi;\t\n\t\t}\n\t\tfriend bool operator <= (Q x,Q y)\n\t\t{\n\t\treturn x.posi==y.posi?x.sit<=y.sit:x.posi<=y.posi;\n        //\u6309\u4f4d\u7f6e\u5927\u5c0f\u6392\u5e8f\n        //\u82e5\u4f4d\u7f6e\u76f8\u7b49\uff0c\u5148\u4fee\u6539\u540e\u67e5\u8be2\n\t\t}\n\t}q[2200000],incur[2200000];\n\tI cdq_divide(int x,int y)\n\t{\n\t\tif(x>=y)return;\n\t\tre mid=(x+y)>>1,l,r,sum=0,pos=x;\n\t\tcdq_divide(x,mid);\n\t\tcdq_divide(mid+1,y);//\u5206\u6cbb\u89e3\u51b3\u4e24\u4e2a\u5b50\u95ee\u9898\n        //\u8fd9\u6837\u8fc7\u540e\uff0c\u4e24\u4e2a\u5b50\u533a\u95f4\u7684posi\u90fd\u662f\u5355\u589e\u7684\n\t\tl=x;r=mid+1;\n\t\twhile(l<=mid&&r<=y)\n\t\t{\n\t\t\tif(q[l]<=q[r])\n\t\t\t{\n\t\t\tif(q[l].sit==1)sum+=q[l].w;\n            //\u8bb0\u5f55\u4e0b\u5f53\u524d\u7684\u4fee\u6539\u503c\n\t\t\tincur[pos++]=q[l++];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\tif(q[r].sit==2)ans[q[r].w]+=sum;\n            //\u66f4\u65b0\u672c\u6b21\u67e5\u8be2\u7684\u7b54\u6848\n\t\t\tincur[pos++]=q[r++];\n            //incur\u662f\u4e00\u4e2a\u6682\u5b58\u6570\u7ec4\uff0c\u7528\u6765\u6392\u5e8f\n\t\t\t}\t\n\t\t}\n\t\twhile(l<=mid)\n\t\t{\n\t\t\tincur[pos++]=q[l++];\n\t\t}\n\t\twhile(r<=y)\n\t\t{\n\t\t\tif(q[r].sit==2)ans[q[r].w]+=sum;\n\t\t\tincur[pos++]=q[r++];\t\n\t\t}//\u5904\u7406\u5b8c\u5269\u4f59\u7684\u95ee\u9898\n\t\tF(k,x,y)\n\t\t{\n\t\t\tq[k]=incur[k];\t\n\t\t}//\u5c06\u6392\u597d\u5e8f\u7684incur\u4f20\u56de\u5230q\u4e2d\n\t}\n\tint main()\n\t{\n\tscanf(\"%d %d\",&n,&m);\n\tmemset(ans,0,sizeof(ans));\n\ta[0]=0;\n\tF(i,1,n)\n\t{\n\tscanf(\"%d\",&a[i]);\n\tq[tot].sit=1;\n\tq[tot].posi=i;\n\tq[tot].w=a[i]-a[i-1];\n\t++tot;\n    //\u5c06\u521d\u59cb\u6743\u503c\u4e5f\u89c6\u4e3a\u4e00\u6b21\u4fee\u6539\uff0c\u8bb0\u5f97\u8981\u505a\u4e00\u4e0b\u5dee\u5206\n\t}\n     while(m--)\n\t{\n\t\tscanf(\"%d\",&S);\n\t\tif(S==1)\n\t\t{\n\t\tscanf(\"%d %d %d\",&X,&Y,&W);\n\t\tq[tot].sit=1;\n\t\tq[tot].posi=X;\n\t\tq[tot].w=W;tot++;\n\t\tq[tot].sit=1;\n\t\tq[tot].posi=Y+1;\n\t\tq[tot].w=W*(-1);\n\t\t++tot;\t\n        //\u5dee\u5206\u601d\u60f3\uff0c\u4e0d\u61c2\u7684\u81ea\u5df1\u67e5\n\t\t}\n\t\telse\n\t\t{\n\t\tscanf(\"%d\",&X);\n\t\tq[tot].sit=2;\n\t\tq[tot].posi=X;\n\t\tq[tot].w=cnt;cnt++;\n\t\t++tot;\t\n\t\t}\n\t}\n\tcdq_divide(0,tot);\n\tF(i,0,cnt-1)\n\t{\n\tprintf(\"%d\\n\",ans[i]);\n\t}\n    return 0;\n}\n```\n\u8fd9\u6837\u6211\u4eec\u5c31\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\u3002    \n\n\u987a\u5e26\u63d0\u4e00\u4e0b\u6811\u72b6\u6570\u7ec41\u3002\n\u5176\u5b9e\u548c\u8fd9\u9053\u9898\u5927\u540c\u5c0f\u5f02\uff0c\u53ea\u4e0d\u8fc7\u5c31\u662f\u628a\u4fee\u6539\u6539\u6210\u666e\u901a\u7684\n\u5355\u70b9\u4fee\u6539\uff0c\u533a\u95f4\u67e5\u8be2\u5c31\u8f6c\u5316\u6210\u6c42r\u7684\u524d\u7f00\u548c\u51cf\u53bbl-1\u7684\u524d\n\u7f00\u548c\u4e86\u3002\u7b2c\u4e00\u6b21\u53d1\u9898\u89e3\uff0c\u6709\u54ea\u5199\u5f97\u4e0d\u597d\u8fd8\u8bf7\u591a\u591a\u6307\u6559\u3002\u3002\n\n \n",
        "postTime": 1553934778,
        "uid": 93453,
        "name": "Purple_wzy",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "# \u54b3\u54b3\uff1a\n### \u9996\u5148\uff1a\u8fd9\u662f\u4e00\u9053\u6a21\u677f\u9898\n#### \u5bf9\u4e8e\u6bcf\u4e00\u4e2aOIer\u6765\u8bf4\u90fd\u662f\u5fc5\u987b\u638c\u63e1\u7684\n\u8fd9\u9053\u9898\u8fd8\u53ef\u4ee5\u7528~~\u7ebf\u6bb5\u6811\u6765\u505a~~\u8fd9\u91cc\u5c31\u53ea\u8bb2\u6811\u72b6\u6570\u7ec4\n\u9996\u5148\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u6570\u7ec4\uff0c\u8868\u793a\u539f\u5e8f\u5217\u76f8\u90bb\u4e24\u4e2a\u7684\u5dee\uff0c\n\u5373\uff1a\n# b[i]=a[i]-a[i-1];\n\u5f88\u5bb9\u6613\u5c31\u6ce8\u610f\u5230a[i]=b[i]+b[i-1]+\u2026\u2026b[1]  \n\u521a\u597d\u662f\u4e00\u4e2a\u6c42\u548c\u7684\u8fc7\u7a0b\n\u5bf9\u4e8e\u4e00\u4e2a\u533a\u95f4l~r\u6765\u8bb2\uff0c\u7ef4\u62a4\u5dee\u5206\u548c\u53ea\u9700\u7ef4\u62a4b[l]\u548cb[r+1]\u5373\uff1a\u4e24\u7aef\u4fbf\u53ef\u4ee5\u4e86\uff0c\u56e0\u4e3a\u4e2d\u95f4\u7684\u6bcf\u4e00\u4e2a\u6570\u90fd\u52a0\u4e0a\u4e00\u4e2a\u76f8\u540c\u7684\u6570\uff0c\u5dee\u5206\u4e0d\u53d8\uff0c\u5c31\u50cf\uff1a\n#### a-b==(a+d\uff09-\uff08b+d);\n\u7528\u4e00\u4e2a\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u5dee\u5206\u548c\u5373\u53ef\n\n\n------------\n\n\n------------\n## \u8fd9\u91cc\u8fd8\u6709\u5fc5\u8981\u63d0\u4e00\u4e0b\u7ebf\u6bb5\u6811\u548c\u6811\u72b6\u6570\u7ec4\u7684\u533a\u522b\uff1a\n## \u7ebf\u6bb5\u6811\uff1a\n\u4ee3\u7801\u8f83\u957f\uff0c\u504f\u590d\u6742\uff0c\u4f46\u53ef\u4ee5\u89e3\u51b3\u7684\u95ee\u9898\u6bd4\u6811\u72b6\u6570\u7ec4\u5e7f\uff0c\u51e0\u4e4e\u6811\u72b6\u6570\u7ec4\u80fd\u505a\u7684\u7ebf\u6bb5\u6811\u90fd\u80fd\u505a\uff0c\u6709\u4ec0\u4e48\u6743\u503c\u7ebf\u6bb5\u6811\uff0c\u5e73\u8861\u6811\u5957\u7ebf\u6bb5\u6811\uff0c\u4e8c\u7ef4\u7ebf\u6bb5\u6811\u7b49\u3002\n## \u6811\u72b6\u6570\u7ec4\uff1a\n\u4ee3\u7801\u590d\u6742\u7a0b\u5ea6\u4f4e\uff0c\u8fd0\u884c\u901f\u5ea6\u7565\u5feb\u7ebf\u6bb5\u6811\uff0c\u5199\u8d77\u6765\u5f88\u65b9\u4fbf\u3002\uff08~~\u672c\u4eba\u8d85\u7ea7\u559c\u6b22~~\uff09\n\n\n------------\n\u6700\u540e\u9644\u4e0a\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define N 501000\nusing namespace std;\nint n,m,a,b,c[N];//c\u6570\u7ec4\u4e3a\u5dee\u5206\u6570\u7ec4 \nint lowbit(int x){return x&(-x);} \nvoid add(int x,int w)//\u628a\u5dee\u5206\u6570\u6dfb\u52a0\u8fdb\u6811\u72b6\u6570\u7ec4 \n{\n\tfor(int i=x;i<=n;i+=lowbit(i))\tc[i]+=w;\n}\nint sum(int x)//\u6c42\u6811\u72b6\u6570\u7ec4\u7684\u5dee\u5206\u548c \n{\n\tint ans=0;\n\tfor(int i=x;i;i-=lowbit(i))\tans+=c[i];\n\treturn ans;\n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&a);\n\t\tadd(i,a-b);//a-b\u5373\u4e3a\u5dee\u5206 \n\t\tb=a;//\u8f6c\u79fb \n\t}\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint t,x,y,k;\n\t\tscanf(\"%d\",&t);\n\t\tif(t==1)\n\t\t{\n\t\t\tscanf(\"%d%d%d\",&x,&y,&k);\n\t\t\tadd(x,k);//\u7ef4\u62a4\u5de6\u8fb9 \n\t\t\tadd(y+1,-k);//\u7ef4\u62a4\u53f3\u8fb9 \n\t\t}\n\t\telse\n\t\t{\n\t\t\tscanf(\"%d\",&x);\n\t\t\tprintf(\"%d\\n\",sum(x));//\u76f4\u63a5\u8f93\u51fa\u5dee\u5206\u548c\u5373\u53ef \n\t\t}\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1563630450,
        "uid": 126164,
        "name": "lzxy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "### \u63cf\u8ff0\n\n\u7528\u6811\u72b6\u6570\u7ec4\u6765\u7ef4\u62a4\u5927\u5c0f\u4e3a\u5e8f\u5217 $n$\uff0c\u8981\u6c42\u652f\u6301\u533a\u95f4\u4fee\u6539\uff0c\u5355\u70b9\u67e5\u8be2\u3002\n\n$n \\leq 500000, m \\leq 500000$\n\n### \u5206\u6790\n\n\u6811\u72b6\u6570\u7ec4\u7684\u672c\u804c\u662f\u652f\u6301\u5355\u70b9\u4fee\u6539\uff0c\u533a\u95f4\u67e5\u8be2\u7684\u3002\u8fd9\u6837\u628a\u64cd\u4f5c\u53cd\u8fc7\u6765\u4ee5\u540e\u5e94\u8be5\u600e\u6837\u624d\u80fd\u7ee7\u7eed\u7528\u6811\u72b6\u6570\u7ec4\u6765\u7ef4\u62a4\u5462\uff1f\n\n\n\u8fd9\u91cc\u5e94\u7528 `\u5dee\u5206` \u7684\u601d\u60f3\u3002\n\n\n\u6bd4\u5982\u539f\u6765\u6811\u72b6\u6570\u7ec4\u7684\u6bcf\u4e00\u4e2a\u53f6\u5b50\u7ed3\u70b9\u90fd\u662f $a[i]$\uff0c\u90a3\u4e48\u73b0\u5728\u5b58\u653e\u7684\u5c31\u662f $c[i] = a[i] - a[i - 1]$\u3002\n\n\n$a[i] = c[i] + c[i - 1] + c[i - 2] + \\cdots + c[2] +c[1]$\uff0c\u56e0\u6b64\u82e5\u8981\u5355\u70b9\u67e5\u8be2\uff0c\u90a3\u4e48\u76f4\u63a5\u67e5\u8be2\u524d\u7f00\u548c\u5373\u53ef\u3002\n\n\n\u81f3\u4e8e\u533a\u95f4\u4fee\u6539\u5f88\u5bb9\u6613\u7406\u89e3\uff0c\u5c31\u662f $modify[l, +k], modify[r + 1\uff0c -k]$\uff0c\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u81ea\u5df1\u5728\u6811\u72b6\u6570\u7ec4\u4e0a\u753b\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\n\u53e6\uff0c\u8fd9\u91cc\u4e5f\u63d0\u4e00\u4e0b\u5728\u8981\u652f\u6301\u533a\u95f4\u4fee\u6539\uff0c\u533a\u95f4\u67e5\u8be2\u7684\u65f6\u5019\u600e\u4e48\u529e\uff1f\n\n\u4e00\u6837\u7528\u6811\u72b6\u6570\u7ec4\u6765\u7ef4\u62a4\u4e00\u4e2a\u5dee\u5206\u6570\u7ec4\uff0c\u533a\u95f4\u4fee\u6539\u540c\u4e0a\u3002\n\n$$\\because a[i] = \\sum_{j = 1}^{i}c[j] $$\n\n$$\\therefore \\sum_{i = 1}^{n}a[i] = \\sum_{i = 1}^{n}\\sum_{j = 1}^{i}c[j] = \\sum_{i = 1}^{n}(n - i + 1)c[i] = (n + 1)\\sum_{i = 1}^{n}c[i] - \\sum_{i = 1}^{n}c[i] \\times i$$\n\n\u5f00\u4e24\u4e2a\u6811\u72b6\u6570\u7ec4\u6765\u7ef4\u62a4\u8fd9\u4e24\u9879\u5373\u53ef\u3002\n\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(nlogn)$\n\n### \u4ee3\u7801\n\n```C++\n#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntemplate<typename T> T readIn() {\n    T x(0), f(1);\n    char ch = getchar();\n    while (ch < '0' || ch > '9') {if (ch == '-') f = -1; ch = getchar();}\n    while (ch >= '0' && ch <= '9') {x = x * 10 + ch - '0'; ch = getchar();}\n    return x * f;\n}\nconst int MAX_N = 500000 + 3;\nconst int MAX_M = 500000 + 3;\nconst int INF = 0x3f3f3f3f;\nint n, m;\nint a[MAX_N];\n\nnamespace fenwickTree {\n    int vec[MAX_N];\n\n    inline void init() {\n        memset(vec, 0, sizeof vec);\n    }\n\n    inline int lowbit(int x) {\n        return x & (-x);\n    }\n\n    inline void modify(int id, int x) {\n        while (id <= n) {\n            vec[id] += x;\n            id += lowbit(id);\n        }\n    }\n\n    inline int query(int id) {\n        int res = 0;\n        while (id >= 1) {\n            res += vec[id];\n            id -= lowbit(id);\n        }\n        return res;\n    }\n}\nusing namespace fenwickTree;\n\nint main()\n{\n    n = readIn<int>(), m = readIn<int>();\n    for (int i = 1; i <= n; ++i) a[i] = readIn<int>();\n\n    init(); int last = 0;\n    for (int i = 1; i <= n; ++i) {\n        modify(i, a[i] - last);\n        last = a[i];\n    }\n\n    while (m--) {\n        int opt = readIn<int>();\n        if (opt == 1) {\n            int l = readIn<int>(), r = readIn<int>(), k = readIn<int>();\n            modify(l, k); modify(r + 1, -k);\n        }\n        else {\n            int pos = readIn<int>();\n            int ans = query(pos);\n            printf(\"%d\\n\", ans);\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1507989814,
        "uid": 47577,
        "name": "ZJYelizaveta",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "#### \u65e2\u7136\u662f\u4e2a\u533a\u95f4\u95ee\u9898,\u4e3a\u4ec0\u4e48\u6211\u4eec\u4e0d\u7528\u795e\u5947\u7684\u5206\u5757\u6765\u8dd1\u8fc7\u53bb\u5462?\n\n~~\u8fd9\u91cc\u5047\u8bbe\u6ce5\u840c\u90fd\u4f1a\u5206\u5feb\u4e86~~\n\n\u56e0\u4e3a\u6211\u5199\u7684\u5206\u5757\u7684\u5e38\u6570\u662f\u5728\u662f\u592a\u5927\u4e86,\u6240\u4ee5\u8bf4\u6211\u4e0d\u5f97\u4e0d\u5f3a\u884c\u5438\u6c27\n\n\u6240\u4ee5,\u6211\u5c31\u6765\u653e\u4e2acode\n\n```\n#include <iostream>\n#include <stdio.h>\n#include <string.h>\n#include <algorithm>\n#include <math.h>\n#define maxn 500010\nusing namespace std ;\nint n , m ;\nint blo , bl[maxn] ;\nint a[maxn] ;\nint tag[maxn] ;\nint read() {//\u52a0\u4e00\u4e2a\u4e0d\u5fc5\u8981\u7684\u5feb\u8bfb\n    long long x = 0 ;\n    int f = 1 ; x = 0 ; char s = getchar() ;\n    while(s>'9'||s<'0') {if(s=='-')f=-1;s=getchar();}\n    while(s<='9'&&s>='0') {x=x*10+(s-'0');s=getchar();}\n    return x*f ;\n}\nvoid change(int x , int y , int c) {//\u533a\u95f4\u52a0\n    for(int i = x ; i <= min(y,bl[x]*blo); i ++) {//\u66b4\u529b\u52a0\u5de6\u8fb9\u90e8\u5206\n        a[i] += c;\n    } \n    if(bl[x] != bl[y]) {//\u5904\u7406\u4e2d\u95f4\u7684\u5b8c\u6574\u5757\n        for(int i = (bl[y]-1)*blo+1;i<=y;i ++) \n        a[i] += c ;\n    }\n    for(int i = bl[x]+1;i<bl[y];i++)//\u5904\u7406\u53f3\u8fb9\u7684\u90e8\u5206\u5757\n    tag[i] += c ;\n}\nint query(int x) {\n    return a[x]+tag[bl[x]] ;//\u4e0d\u89e3\u91ca\n}\nsigned main() {\n    n = read() ;m = read() ;\n    blo = sqrt(n) ;//\u636e\u8bf4\u8fd9\u6837\u5206\u5757\u4f1a\u6bd4\u8f83\u5feb\n    for(int i = 1 ; i <= n ; i ++) {\n        bl[i] = (i-1)/blo+1 ;\n    }\n    for(int i = 1 ; i <= n ; i ++) {\n        a[i] = read() ;\n    }\n    for(int i = 1 ; i <= m ; i ++) {\n        int opt , x , y , z ;\n        opt = read() ;\n        if(opt==1) {\n        \tx = read() ;\n        \ty = read() ;\n        \tz = read() ;\n            change(x,y,z) ;\n        }\n        else\n        if(opt == 2){\n        \tx = read() ;\n        \tcout << query(x) <<endl ;\n    \t}\n\t}\n    return 0;\n}\n```\n\n\u6700\u540e,\u6211\u6765\u9644\u4e00\u4e2a\u6811\u72b6\u6570\u7ec4\u7684\u88f8\u9898\n\n[\u88f8\u9898](https://www.luogu.org/problemnew/show/U43260)\n\n",
        "postTime": 1539388314,
        "uid": 54752,
        "name": "L_Y_T",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "#\u7528\u6811\u72b6\u6570\u7ec4&\u7ebf\u6bb5\u6811\u7684\u601d\u60f3\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\n\n\n##\u524d\u8a00\n\n\u60ca\u4e86\uff0c\u770b\u5230\u4e0b\u9762\u7684dalao\u4eec\u5404\u79cd\u7ebf\u6bb5\u6811\u7ebf\u6bb5\u6811\uff0c\u76f4\u63a5\u60ca\u5566\u3002\u3002\u3002\u8fd9\u660e\u660e\u662f\u6811\u72b6\u6570\u7ec4\u7684\u9898\u3002\u3002\u3002\u6740\u9e21\u7109\u7528\u725b\u5200\u3002\u3002\u3002\n\n\u4f46\u662f\u8fd9\u4e2a\u548c\u4e66\u4e0a\u63d0\u4f9b\u7684\u6811\u72b6\u6570\u7ec4\u652f\u6301\u7684\u64cd\u4f5c\u5e76\u4e0d\u4e00\u6837\u3002\u56e0\u6b64\u8fd9\u4e2a\u9898\u53ea\u662f\u4f7f\u7528\u6811\u72b6\u6570\u7ec4\u7684\u601d\u60f3\u548c\u7ed3\u6784\u3002\n\n\u672c\u8d28\u4e0a\u8bb2\u4e0d\u662f\u6811\u72b6\u6570\u7ec4\uff0c\u4f46\u662f\u7ed3\u6784\u4e0a\u5c06\u662f\u6811\u72b6\u6570\u7ec4\u3002\n\n\n##\u8bf4\u8bf4\u601d\u8def\n\n\u9996\u5148\u6765\u8bb2\u5b9a\u4e49e[MAXN]\u4f5c\u4e3a\u6811\u72b6\u6570\u7ec4\u7684\u5b58\u50a8\u7a7a\u95f4\u3002n\u8868\u793a\u5143\u7d20\u4e2a\u6570\uff0cm\u8868\u793a\u6307\u4ee4\u6570\u3002\n\na[MAXN]\u7528\u6765\u5b58\u50a8\u521d\u59cb\u6570\u636e\u3002\n\n\u5728\u6811\u72b6\u6570\u7ec4\u4e2d\uff0c\u6811\u7684\u8282\u70b9\u7528\u6765\u5b58\u50a8\u5b83\u7ba1\u8f96\u7684\u533a\u95f4\uff08\u6bd4\u5982\u8bf48\u53f7\u638c\u7ba1\u4e86a[1]...a[8]\uff0c\u5373e[4]\u3001e[6]\u3001e[7]\u3001a[8]\uff0c\u5982\u4e0b\u56fe\uff09\n\n ![](https://cdn.luogu.com.cn/upload/pic/4310.png) \n\n\u7136\u540e\u52a0\u7684\u65f6\u5019\uff0c\u53ea\u9700\u8981\u5c06\u7ec4\u6210\u8fd9\u4e2a\u533a\u95f4\u7684\u51e0\u4e2a\u5927\u7ba1\u8f96\u8282\u70b9\u52a0\u8fd9\u4e2a\u6570\uff08\u7c7b\u4f3c\u4e8e\u7ebf\u6bb5\u6811\u4e2d\u7684\u61d2\u64cd\u4f5c\uff09\u3002\n\n\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u4f9d\u5c42\u627e\u81ea\u5df1\u7684\u4e0a\u7ea7\uff0c\u7136\u540e\u52a0\u4e0a\u81ea\u5df1\u4e0a\u7ea7\u7684\u503c\u5c31\u884c\u4e86\u3002\u56e0\u4e3a\u5728\u8fd9\u91cc\uff0c\u4e0a\u7ea7\u7684\u503c\u5c31\u76f8\u5f53\u4e8e\u61d2\u64cd\u4f5c\u7684\u503c\u3002\n\n\n##\u4ee3\u7801\u8d34\u8d34\u8d34\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n\n#define MAXN 500005\n\nint lb(int k)\n{\n    return k&(-k);\n}//lowbit \n\nint e[MAXN];\nint a[MAXN],n,m;\n\nvoid addto(int x,int v)\n{\n    while(x>0)\n    {\n        e[x]+=v;\n        x-=lb(x);\n    }\n}//\u5b9e\u73b01-x\u533a\u95f4\u52a0v \n\nint query(int x)\n{\n    int ans=a[x];\n    while(x<=n)\n    {\n        ans+=e[x];\n        x+=lb(x);\n    }\n    return ans;\n} \n\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n;i++) scanf(\"%d\",&a[i]);\n    for(int i=1;i<=m;i++)\n    {\n        int operate;\n        scanf(\"%d\",&operate);\n        if(operate==1)\n        {\n            int a,b,v;\n            scanf(\"%d%d%d\",&a,&b,&v);\n            addto(b,v);\n            addto(a-1,-v);\n        }\n        else\n        {\n            int x;\n            scanf(\"%d\",&x);\n            cout<<query(x)<<endl;\n        }\n    }\n    return 0;\n}\n\n```",
        "postTime": 1487763570,
        "uid": 19027,
        "name": "rentenglong",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "\u548c\u6a21\u677f1\u533a\u522b\u5e76\u4e0d\u662f\u5f88\u5927\u2026\u2026\n\n\u4f46\u662f\u5fc5\u987b\u89e3\u91ca\u4e00\u4e0b\u2026\u2026\n\n```cpp\n#include<cstdio>\nusing namespace std;\nint n,m,a[500009],c[500009],d,x,y,z,ans;\nint lowbit(int x)\n{\n    return x&(-x);\n}\nint sum(int x)\n{\n    ans=0;\n    for(int i=x;i>0;i=i-lowbit(i)){ans=ans+c[i];}\n    return ans;\n}\nvoid modify(int x,int d)\n{\n    if(x==0){return;}\n    for(int i=x;i<=n;i=i+lowbit(i)){c[i]=c[i]+d;}\n    return;\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n;i++)\n    {\n        scanf(\"%d\",&a[i]);\n        modify(i,a[i]);modify(i+1,-a[i]);//\u6811\u91cc\u591a\u52a0\u7684\u8981\u51cf\u56de\u6765\u2026\u2026\n    }\n    for(int i=1;i<=m;i++)\n    {\n        scanf(\"%d\",&d);\n        if(d==1)\n        {\n            scanf(\"%d%d%d\",&x,&y,&z);\n            modify(x,z);modify(y+1,-z);//\u53ea\u52a0x\u5230y\u7684\u533a\u95f4\n        }\n        if(d==2)\n        {\n            scanf(\"%d\",&x);\n            printf(\"%d\\n\",sum(x));//\u6c42\u548c\u2026\u2026\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1483328587,
        "uid": 14378,
        "name": "doby",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "\u770b\u5230\u9898\u89e3\u91cc\u51b7\u51b7\u6e05\u6e05\u7684\uff0c\u6211\u5c31\u8d70\u4e00\u6ce2\u6811\u72b6\u6570\u7ec4\u7684\u6e05\u6d41\u597d\u4e86\u3002\u3002\u3002\n\n\u5176\u5b9e\u6811\u72b6\u6570\u7ec4\u7684\u4f18\u70b9\u8fd8\u662f\u5f88\u591a\u7684\uff0c\u957f\u5ea6\u4e5f\u77ed\uff0c\u590d\u6742\u5ea6\u4e5f\u4f4e\uff0c\u4ee3\u7801\u8fd8\u4f18\u7f8e\u6613\u5199\u7b49\u3002\n\n\u5bf9\u4e8e\u5df2\u7ecf\u80fdA\u6389\u6811\u72b6\u6570\u7ec41\u7684\u540c\u5b66\u4eec\uff0c2\u5c31\u53d8\u5f97\u76f8\u5f53\u597d\u7406\u89e3\u4e86\u3002\u4e0b\u9762\u662f\u9898\u89e3\u3002\n\n###\u5206\u6790\n\n1. \u8fd9\u91cc\u7531\u4e8e\u6d89\u53ca\u5230\u533a\u95f4\u4fee\u6539\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u5f15\u5165\u5dee\u5206\u7684\u601d\u60f3\u3002\n\n2. \u5dee\u5206\u6570\u7ec4c[]\uff1a\u6211\u4eec\u5047\u8bbesigma(c\uff0ci)\u8868\u793ac\u6570\u7ec4\u7684\u524di\u9879\u548c\uff0c\u8c03\u7528\u4e00\u6b21\u7684\u590d\u6742\u5ea6\u662flog2(i)\n\n\u8bbe\u539f\u6570\u7ec4\u662fa[n]\uff0c**\\_\u5dee\u5206\u6570\u7ec4c[n]\uff0cc[i]=a[i]-a[i-1]\uff0c\u90a3\u4e48\u660e\u663e\u5730a[i]=sigma(c,i)\\_**\uff0c\u5982\u679c\u60f3\u8981\u4fee\u6539a[i]\u5230a[j](\u6bd4\u5982+v)\uff0c\u53ea\u9700\u4ee4c[i]+=v,c[j+1]-=v\n\n3. \u660e\u767d\u4e86\u4e0a\u9762\u7684\u539f\u7406\u4ee5\u540e\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u770b\u4ee3\u7801\u4e86QUQ\n\n\u6ce8\u610f\uff1a\u533a\u95f4\u4fee\u6539\u7ef4\u62a4\u7684\u662f\u4e00\u4e2a\u5dee\u5206\u6570\u7ec4\uff0c\u800c\u5355\u70b9\u4fee\u6539\u7ef4\u62a4\u7684\u662f\u4e00\u4e2a\u524d\u7f00\u548c\u6570\u7ec4\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#define maxn 500000+5\nusing namespace std;\nint m,n,k,a[maxn],c[maxn];\nint lowbit(int x) {return x&(-x);}//lowbit\u51fd\u6570\u5c31\u4e0d\u7528\u591a\u8bf4\u4e86\nvoid add(int x,int val)//\u6dfb\u52a0\u64cd\u4f5c\uff0c\u548c\u4e4b\u524d\u4e00\u6837\n{\n    for(int i=x;i<=n;i+=lowbit(i)) c[i]+=val;\n}\nint getsum(int x)//sigma\u64cd\u4f5c\uff0c\u548c\u4e4b\u524d\u4e00\u6837\n{\n    int ans=0;\n    for(int i=x;i>=1;i-=lowbit(i)) ans+=c[i];\n    return ans;\n}\nint main()\n{\n    cin>>n>>m;\n    for(int i=1;i<=n;++i) {cin>>a[i];add(i,a[i]-a[i-1]);}//\u6ce8\u610fadd\uff08\uff09\u7684\u662fa[]\u6570\u7ec4\u7684\u5dee\u5206\n    for(int i=1,l,r,v,x;i<=m;++i)\n    {\n        cin>>k;\n        if(k==1) {cin>>l>>r>>v;add(l,v);add(r+1,-v);}//\u533a\u95f4\u4fee\u6539\n        else {cin>>x;cout<<getsum(x)<<endl;}//\u5355\u70b9\u67e5\u8be2\uff0c\u81f3\u4e8e\u4ec0\u4e48\u770b\u4e0a\u53bb\u50cf\u662f\u5728\u6c42\u548c\uff0c\u5206\u67902\u91cc\u89e3\u91ca\u4e86\n    }\n    return 0;\n}\n```",
        "postTime": 1478775217,
        "uid": 11295,
        "name": "2015wanghongyu",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "# \u6811\u72b6\u6570\u7ec4\n\u5176\u5b9e\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u4e1c\u897f\uff0c\u7801\u91cf\u5c11\uff0c\u5e38\u6570\u5c0f\u2026\u2026\n\n\u5f53\u7136\uff0c\u6811\u72b6\u6570\u7ec4\u7684\u9898\u76ee\u4e5f\u53ef\u4ee5\u7528\u7ebf\u6bb5\u6811\u6765\u505a\uff0c\u4e0d\u8fc7\uff0c\u8fd8\u662f\u4ecb\u7ecd\u4e00\u4e0b\u6811\u72b6\u6570\u7ec4\u5427\u3002\n\n\u8fd9\u5c31\u662f\u6811\u72b6\u6570\u7ec4\u7684\u57fa\u672c\u6a21\u5f0f\uff1a\n```cpp\ns1=a1\ns2=a1+a2\ns3=a3\ns4=a1+a2+a3+a4\ns5=a5\ns6=a5+a6\ns7=a7\ns8=a1+a2+a3+a4+a5+a6+a7+a8\ns9=a9\n...\n```\n\u89c4\u5f8b\u5927\u5bb6\u5e94\u8be5\u90fd\u77e5\u9053\u4e86\u5427\u3002\n\n\u6240\u4ee5\uff0c\u6709\u4e00\u4e2a\u51fd\u6570\u2014\u2014lowbit\u5c31\u662f\u6765\u5b9e\u73b0\u8fd9\u4e00\u4e2a\u89c4\u5f8b\u7684\u3002\n```cpp\nint lowbit(x) {return x&(-x);}\n```\n\u539f\u7406\u5927\u5bb6\u5e94\u8be5\u90fd\u61c2\u5f97\u5427\u3002\n\n\u6811\u72b6\u6570\u7ec4\u6700\u5927\u7684\u4f18\u70b9\u5c31\u662f\u7801\u91cf\u5c11\uff0c\u6bd4\u5982\u8bf4\u50cf\u5355\u70b9\u4fee\u6539\uff1a\n```cpp\n\u5c06\u7b2cx\u4e2a\u8282\u70b9\u7684\u6570\u503c\u589e\u52a0a\nint add(int x,int a)\n{\n\twhile(x<=n)\n\t{\n\t\ts[x]+=a;\n\t\tx+=lowbit(x);\n\t}\n}\n```\n\u533a\u95f4\u67e5\u8be2\uff1a\n```cpp\n\u67e5\u8be21~x\u7684\u548c\nint sum(int x)\n{\n\tint ans=0;\n\twhile(x)\n\t{\n\t\tans+=s[x];\n\t\tx-=lowbit(x);\n\t}\n\treturn ans;\n}\n```\n\u597d\u4e86\uff0c\u5c31\u8fd9\u4e2a\u6837\u3002\n---\n\u4f46\u662f\uff0c\u6b64\u5904\u9700\u8981\u652f\u6301\u533a\u95f4\u4fee\u6539\uff0c\u600e\u4e48\u529e\u5462\uff1f\n\n\u5148\u4e86\u89e3\u4e00\u4e0b\u5dee\u5206\u3002\n\n\u73b0\u5728\u6709\u4e00\u4e2a\u5e8f\u5217\uff0c\u4e3a{1 5 4 2 3}\n\n\u5219\u5b83\u7684\u5dee\u5206\u6570\u7ec4\u4e3a\u540e\u4e00\u9879\u51cf\u53bb\u524d\u4e00\u9879\uff08\u7b2c\u4e00\u9879\u51cf\u53bb0\uff09\u3002\n\n\u4e4b\u540e\u5462\uff1f\u6211\u4eec\u5c31\u5f97\u5230\u4e00\u4e2a\u5dee\u5206\u6570\u7ec4{1 4 -1 -2 1}\n\n\u5982\u679c\u5c062~4\u533a\u95f4\u52a0\u4e0a2\uff0c\u5219\u539f\u6570\u7ec4\u5c31\u662f{1 7 6 4 3}\n\n\u5b83\u7684\u5dee\u5206\u6570\u7ec4\u662f{1 6 -1 -2 -1}\n\n\u53d1\u73b0\u4e86\u4ec0\u4e48\uff1f\u5b83\u7684\u5dee\u5206\u6570\u7ec4\u7684\u7b2c2\u9879\u589e\u52a0\u4e862\uff0c\u7b2c4+1\u9879\u589e\u52a0\u4e86-2\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u7ef4\u62a4\u5dee\u5206\u6570\u7ec4\uff0c\u8fd9\u6837\u5b50\u5c31\u53ef\u4ee5\u89e3\u51b3\u533a\u95f4\u4fee\u6539/\u5355\u70b9\u67e5\u8be2\u7684\u95ee\u9898\u4e86\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<cstdio>\n#define N 5000010\nusing namespace std;\nint lowbit(int a){return a&(-a);}\nint tr[N],a,n,T,t,b,last;\nvoid add(int x,int a)\n{\n\twhile(x<=n)\n\t{\n\t\ttr[x]+=a;\n\t\tx+=lowbit(x);\n\t}\n}\nint getsum(int x)\n{\n\tint ans=0;\n\twhile(x)\n\t{\n\t\tans+=tr[x];\n\t\tx-=lowbit(x);\n\t}\n\treturn ans;\n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&T);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&a);\n\t\tadd(i,a-last);\n\t\tlast=a;\n\t}\n\twhile(T--)\n\t{\n\t\tscanf(\"%d%d\",&t,&a);\n\t\tif(t==1)\n\t\t{\n\t\t\tscanf(\"%d%d\",&b,&t);\n\t\t\tadd(a,t);\n\t\t\tadd(b+1,-t);\n\t\t}\n\t\telse printf(\"%d\\n\",getsum(a));\n\t}\n}\n```\n# \u6269\u5c55\u4e00\u4e0b\n\u5982\u679c\u9898\u76ee\u540c\u65f6\u9700\u8981\u533a\u95f4\u4fee\u6539\u548c\u533a\u95f4\u67e5\u8be2\u600e\u4e48\u529e\uff1f\n\n\u5176\u5b9e\u4e5f\u5bb9\u6613\uff0c\u591a\u7ef4\u62a4\u4e00\u4e2a\u6570\u7ec4\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```\n#include<cstdio>\n#define N 1000010\nusing namespace std;\nint lowbit(int x) {return x&(-x);}\nint n,s1[N],s2[N],T,a,b; \n\u66f4\u6539\u5dee\u5206\u6570\u7ec4\nvoid add(int x,int a)\n{\n\tfor(int i=x;i<=n;i+=lowbit(i))\n\t{\n\t\ts1[i]+=a;\n\t\ts2[i]+=a*(x-1);\n\t}\n}\n\u67e5\u8be21~x\u7684\u548c\nint sum(int x)\n{\n\tint ans=0;\n\tfor(int i=x;i>0;i-=lowbit(i))\n\t{\n\t\tans+=s1[i]*x-s2[i];\n\t}\n\treturn ans;\n}\nint l,r,ActionEvent;\nint main()\n{\n\tscanf(\"%d%d\",&n,&T);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&a);\n\t\tadd(i,a-b);\n\t\tb=a;\n\t}\n\twhile(T--)\n\t{\n\t\tscanf(\"%d\",&ActionEvent);\n\t\tif(ActionEvent==1)\n\t\t{\n\t\t\tscanf(\"%d%d%d\",&l,&r,&a);\n\t\t\tadd(l,a),add(r+1,-a);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tscanf(\"%d\",&b);\n\t\t\tprintf(\"%d\\n\",sum(b)-sum(b-1));\n\t\t}\n\t}\n}\n```",
        "postTime": 1581313108,
        "uid": 99506,
        "name": "_LHF_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "\u5148\u4e0a\u4e24\u9053\u6a21\u677f\u9898\u84dd\u94fe[P3374\u6811\u72b6\u6570\u7ec41](https://www.luogu.com.cn/problem/P3374)  [P3368\u6811\u72b6\u6570\u7ec42](https://www.luogu.com.cn/problem/P3368)\n\n\u63a5\u4e0b\u6765\u8bb2\u89e3\u5f00\u59cb\n\n1.\u4ec0\u4e48\u662f\u6811\u72b6\u6570\u7ec4\n\n\u6811\u72b6\u6570\u7ec4\u5c31\u662f\u4e00\u4e2a\u7b80\u5355\u7248\u7684\u7ebf\u6bb5\u6811\uff0c\u53ef\u4ee5\u7528\u6570\u7ec4\u7684\u5f62\u5f0f\u6a21\u62df\u6811\uff0c\u53ef\u4ee5\u5b8c\u6210\u4e00\u4e9b\u7b80\u5355\u7684\u529f\u80fd\uff0c\u5982\u533a\u95f4\u6c42\u548c\uff0c\u5efa\u6811\u7b49\uff1b\n\n2.\u600e\u4e48\u8868\u793a\u6811\u72b6\u6570\u7ec4\n\n\u5b9a\u4e49\u4e00\u4e2a\u6570\u7ec4tree[]\u5373\u53ef\n\n3.\u4ec0\u4e48\u662flowbit\n\n```cpp\ninline int lowbit(int x)\n{\n\treturn x&(-x);\n}\n```\nx&-x\u7684\u610f\u601d\u5c31\u662f\u5f53x\u4e3a0\u65f6\u7ed3\u679c\u4e3a0\uff1bx\u4e3a\u5947\u6570\u65f6\uff0c\u7ed3\u679c\u4e3a1\uff1bx\u4e3a\u5076\u6570\u65f6\uff0c\u7ed3\u679c\u4e3ax\u4e2d2\u7684\u6700\u5927\u6b21\u65b9\u7684\u56e0\u5b50\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7lowbit\u6765\u6c42\u51fa2^k\uff1b\n\n4.\u5982\u4f55\u5f80\u6811\u72b6\u6570\u7ec4\u4e2d\u52a0\u6570\n```cpp\nvoid adds(int x,int y)\n{\n\tfor(int i=x;i<=n;i+=lowbit(i))\n\ttree[i]+=y;\t\n}\n```\n\u4ee3\u7801\u5373\u4e3a\u5c06\u7b2cx\u6570\u52a0\u4e0ay\n\n5.\u5982\u4f55\u5f80\u533a\u95f4\u91cc\u52a0\u6570\n\n\u6211\u4eec\u77e5\u9053\u5728\u6811\u72b6\u6570\u7ec4\u4e2d\u53ef\u4ee5\u7528\u524di\u9879\u7684\u548c\u6765\u8868\u793a\u7b2ci\u4e2a\u6570.\u5373\u4e3a\u524d\u7f00\u548c\u601d\u60f3\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7add(a,c),add(b+1,-c)\u6765\u5f80[a\uff0cb]\u4e2d\u6bcf\u4e00\u4e2a\u5143\u7d20\u52a0\u4e0ac\ncode:\n```cpp\nc=read();\n\t\t\td=read();\n\t\t\te=read();\n\t\t\tadds(c,e);\n\t\t\tadds(d+1,-e);\n```\n6.\u5982\u4f55\u521d\u59cb\u5316\u533a\u95f4\n\n\u6bd4\u5982\u6211\u4eec\u8f93\u5165\u7b2ci\u4e2a\u6570\u4e3aa\n\u6211\u4eec\u5c06i\u548ca\u6dfb\u52a0\u5230\u6811\u72b6\u6570\u7ec4\u4e2d\n\u5373\u4e3a\n```cpp\nfor(int i=1;i<=n;i++)\n\t{\n\tcin>>a[i];\n\taddup(i,a[i]);\n}\n```\n\n7.\u5982\u4f55\u6c42\u533a\u95f4\u5185\u6bcf\u4e2a\u6570\u7684\u548c\n```cpp\ninline int tot(int x)\n{\n\tint t=0;\n\tfor(fint i=x;i;i-=lowbit(i))\n\tt+=tree[i];\n\treturn t;\n}\n```\n\u7136\u540e\n```cpp\ntot(c)-tot(b-1)\uff1b\n```\n\u5373\u4e3a\u533a\u95f4[b,c]\u7684\u548c\n\n\u5185\u5bb9\u5dee\u4e0d\u591a\u5c31\u8fd9\u6837\u4e86\n\n\u63a5\u4e0b\u6765\u653e\u4ee3\u7801\n\n\u6811\u72b6\u6570\u7ec41\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define h 57823\n#define p 2001\nusing namespace std;\nint lb(int x);\nvoid addup(int x,int y);\nint tot(int x);\nint f[h]; \nint tree[h];\nint n,m;\nint a[h];\nsigned main()\n{\n\tcin>>n>>m;\n\tfor(int i=1;i<=n;i++)\n\t{\n\tcin>>a[i];\n\taddup(i,a[i]);\n}\n    int d,b,c;\n    for(int i=1;i<=m;i++)\n    {\n    cin>>d>>b>>c;\n    if(d==1)\n    addup(b,c);\n    else\n    if(d==2)\n    cout<<tot(c)-tot(b-1)<<endl;\n} \n}\nint lowbit(int x)\n{\n\treturn x&(-x);\n}\nvoid addup(int x,int y)\n{\n\tfor(int i=x;i<=n;i+=lowbit(i))\n\ttree[i]+=y;\t\n}\nint tot(int x)\n{\n\tint t=0;\n\tfor(int i=x;i;i-=lowbit(i))\n\tt+=tree[i];\n\treturn t;\n}\n```\n\u6811\u72b6\u6570\u7ec42\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define fint register long long\n#define p 536234\n#define h 5001\nusing namespace std;\nint tree[p];\nint n,m;\nint a[p];\ninline int read();\ninline void adds(int x,int y);\ninline int lowbit(int x);\ninline int tot(int x);\nsigned main()\n{\n\tn=read();\n\tm=read();\n\tfor(fint i=1;i<=n;i++)\n\t{\n\t\ta[i]=read();\n\t\tadds(i,a[i]-a[i-1]);\n\t}\n\tint num; \n    int c,d,e;\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tnum=read();\n\t\tif(num==1)\n\t\t{\n\t\t\tc=read();\n\t\t\td=read();\n\t\t\te=read();\n\t\t\tadds(c,e);\n\t\t\tadds(d+1,-e);\n\t\t}\n\t\telse\n\t\tif(num==2)\n\t\t{\n\t\t\tc=read();\n\t\t\tcout<<tot(c)<<endl;\n\t\t}\n\t}\n\texit(0);\n}\ninline int read()\n{\n    int x=0,f=1;\n    char ch=getchar();\n    while(ch<'0'||ch>'9')\n\t{\n        if(ch=='-')\n            f=-1;\n        ch=getchar();\n    }\n    while(ch>='0'&&ch<='9'){\n        x=(x<<1)+(x<<3)+(ch^48);\n        ch=getchar();\n    }\n    return x*f;\n}\ninline void adds(int x,int y)\n{\n\tfor(fint i=x;i<=n;i+=lowbit(i))\n\ttree[i]+=y;\n}\ninline int lowbit(int x)\n{\n\treturn x&(-x);\n}\ninline int tot(int x)\n{\n\tint t=0;\n\tfor(fint i=x;i;i-=lowbit(i))\n\tt+=tree[i];\n\treturn t;\n}\n```\n\u5b8c\u7ed3\u6492\u82b1\uff01",
        "postTime": 1578712334,
        "uid": 244059,
        "name": "king_xbz",
        "ccfLevel": 0,
        "title": "\u6765\u4e00\u53d1\u6811\u72b6\u6570\u7ec4\u7684\u8be6\u7ec6\u8bb2\u89e3"
    },
    {
        "content": "\u83dc\u9e21\u5192\u6ce1~~ \u6709\u9505\u8bf7\u5404\u4f4ddalao\u6307\u51fa\n\n~~\n~~first of all~~\n\n\u5148\u4ea4\u4ee3\u6545\u4e8b\u53d1\u751f\u7684\u80cc\u666f.........\n\n```cpp\n/*\n\u5173\u4e8elowbit\u7684\u51fd\u6570\u4ecb\u7ecd\uff08so easy\uff09\nlowbit\u662f\u627e\u6700\u540e\u4e00\u4f4d\u662f\u4e00\u7684\u4f4d\u6570 \n\u25cf\u5728\u8ba1\u7b97\u673a\u4e2d\uff0c\u8d1f\u6570\u7684\u5b58\u50a8\u4e3a\uff08\u4ee5\u516b\u8fdb\u5236\u4e3a\u4f8b\uff0c-10 \u5c31\u662f10001010\u203b\u7b2c\u4e00\u4f4d\u662f\u7b26\u53f7\u4f4d\n\u5bf9\u4e8e\u6b63\u6570\u6765\u8bf4\uff0c\u539f\u7801\uff0c\u53cd\u7801\uff0c\u8865\u7801\u90fd\u662f\u540c\u4e00\u4e2a\uff0c\u5bf9\u4e8e\u8d1f\u6570\u6765\u8bf4\uff0c\u53cd\u7801\u5c31\u662f\u9664\u53bb\u7b26\u53f7\u4f4d\u4ee5\u5916\uff0c\u5176\u4f59\u7684\u53d6\u53cd\n\u8865\u7801\u662f\u53cd\u7801\u6700\u540e\u52a0\u4e00\uff0c\uff08\u52a0\u7206\u4e86\u4e5f\u4e0d\u7528\u7ba1\uff0c\u52a0\u5c31\u662f\u4e86\uff09\uff09\n\u25cf\u6309\u4f4d&  \u4f8b\u59821&1=1\uff0c\u662f\u4e24\u8fb9\u540c\u65f6\u6ee1\u8db3\u624d\u53ef\u4ee5 \n\u25cf\u4e00\u4e2a\u6570\u548c\u4ed6\u7684\u76f8\u53cd\u6570\u7528&\uff0c\u5219\u53ef\u4ee5\u6c42\u51fa\u6700\u540e\u4e00\u4f4d\u662f1\u7684\u4f4d\u7f6e\uff08\u5c31\u662flowbit\u7684\u4ee3\u7801\u5b9e\u73b0\uff09\uff08\u203b\u4f46\u8981\u6ce8\u610f\u7684\u662f\u5982\u679c\u4e00\u4e2a\u6570\u662f2\u7684k\u6b21\u65b9\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6570\u7684lowbit\u8fd8\u662f\u8fd9\u4e2a\u6570\uff0c\u624b\u52a8\u5b9e\u73b0\u9a8c\u8bc1\uff09\n\u2605\u5173\u4e8e\u6811\u72b6\u6570\u7ec4\uff0c\u4e00\u822c\u662f\u7ed9\u67d0\u4e00\u4e2a\u6570\u52a0\u4e0a\u4e00\u4e2a\u503c\uff0c\u8fd8\u6709\u5c31\u662f\u8be2\u95ee\u67d0\u4e2a\u533a\u95f4\u7684\u548c\uff0c\n\u7ed9\u67d0\u4e00\u4e2a\u6570\u52a0\u4e0a\u4e00\u4e2a\u503c\uff0c\u8981\u6c42\u66f4\u65b0\u548c\u8fd9\u4e2a\u6570\u6709\u5173\u7684\u6240\u6709\u6570\uff0c\u7528\u6811\u72b6\u6570\u7ec4\u53ef\u4ee5\u8282\u7701\u65f6\u95f4\u5927\u7ea6\u662fO(nlogn)\n\u6bcf\u6b21\u90fd\u8981update\uff0c\u7528c\u6570\u7ec4\u53bb\u5b58a\u6570\u7ec4\u7684\u503c\uff0c\u7c7b\u4f3c\u4e8e\u4e00\u4e2a\u6811\u5f00\u59cb\u7684\u65f6\u5019\u76f4\u63a5\u52a0\u4e00\u4e2a\u503c\u5c31\u53ef\u4ee5\uff0c\u4e4b\u540e\u7684\u6bcf\u6b21\u589e\u52a0\u67d0\u4e00\u4e2a\u6570\u7684\u503c\u8981\u6c42\u662f\u6bcf\u6b21\u90fd\u8981update\n\u800c\u4ece\u4e00\u4e2a\u70b9\u627e\u5230\u4e0b\u4e00\u4e2a\u5e94\u8be5\u88ab\u66f4\u65b0\u7684\u70b9\u7528\u7684\u5c31\u662flowbit\uff08x\uff09+x\uff1b \n \u6811\u72b6\u6570\u7ec4\u4e2dc\u6570\u7ec4\u7684\u6240\u4ee3\u8868\u7684\u6570\u5b57\u53d6\u51b3\u4e8elowbit\u7684\u503c\n \u4f8b\u5982\u8bf4lowbit 1=1\u90a3\u4e48c1\u5c31\u662f\u4e00\u4e2a\u6570\u7684\u548c  lowbit 2=2\u90a3\u4e48c2\u5c31\u662f\u4e24\u4e2a\u6570\u7684\u548c\uff0clowbit3=1\u90a3\u4e48c1\u5c31\u662f\u4e00\u4e2a\u6570\u7684\u548c\u3002\u3002\u3002\u3002\u3002\u3002 \n*/\n#include<iostream>\n#include<cstdio>\n#include<stdio.h>\nusing namespace std;\nint n,m;int c[5000005];\nint lowbit(int ii)\n{\n\treturn ii&(-ii);\n}\nvoid update(int x,int k)\n{\n\twhile(x<=n)\n\t{\n\t\tc[x]+=k;\n\t\tx=x+lowbit(x);\n\t}\n}\nint getsum(int x)\n{\n\tint sum=0;\n\twhile(x!=0)\n\t{\n\t\tsum+=c[x];\n\t\tx=x-lowbit(x);\n\t}\n\treturn sum;\n}\nint main()\n{\n\tcin>>n>>m;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint a;\n\t\tcin>>a;\n\t\tupdate(i,a);\t\n\t}\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint p,x,y;\n\t\tcin>>p>>x>>y;\n\t\tif(p==1)\n\t\t{\n\t\t\tupdate(x,y);\n\t\t} \n\t\tif(p==2)\n\t\t{\n\t\t\tint ckwnb=getsum(y)-getsum(x-1);\n\t\t\tcout<<ckwnb<<endl;\n\t\t\t\n\t\t}\n\t}\t\n} \n\n```\n~~~\u819c\u4ee5\u4e0bckw\uff08&&ccs\u6280\u672f\u652f\u6301\uff09\n\n\n\u5e94\u7528\u5982\u4e0b\n\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstdio>\n#include<stdio.h>\nusing namespace std;\nlong long int n;long long int c[500015]={0};\nstruct strr{\n  long long int id,wei;\n}map[500005];\nlong long int  com(strr x,strr y)\n{\n\tif(x.wei!=y.wei)\n\treturn x.wei>y.wei;\n\tif(x.wei==y.wei)\n\treturn x.id>y.id;\n}\nlong long int lowbit(int l)\n{\n\treturn l&(-l);\n}\nvoid update(int x)\n{\n\twhile(x<=n)\n\t{\n\t\tc[x]++;\n\t\tx=x+lowbit(x);\n\t}\t\n}\nlong long int getsum(int x)\n{\n\tlong long int sum=0;\n\twhile(x>0)\n\t{\n\t\tsum+=c[x];\n\t\tx-=lowbit(x);\n\t}\n\treturn sum;\n}\nint main()\n{\n\tlong long int ans=0;\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tcin>>map[i].wei;\n\t\tmap[i].id=i;\n\t}\n\tsort(map+1,map+n+1,com);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tupdate(map[i].id);\n\t\tans+=getsum(map[i].id-1);\n\t}\n\tcout<<ans;\n\treturn 0;\n}  \n/*make an summary\n\u5c06\u4e00\u4e2a\u6570\u7684id\u548c\u8fd9\u4e2a\u6570\u7684\u503c\u8054\u7cfb\u5230\u4e00\u8d77\uff0c\u5bf9\u503c\u8fdb\u884c\u6392\u5e8f\uff0c\u4f46\u662f \u5b9e\u9645\u7528\u5230\u7684\u8fd8\u662f\u8fd9\u4e2a\u6570\u7684\u5730\u5740\n\u7528\u6811\u72b6\u6570\u7ec4\u5bf9id\u6392\u73a9\u987a\u5e8f\u4ee5\u540e\u7684\u6570\u7ec4\u5f53\u505a\u539f\u6765\u7684c\u6570\u7ec4\n\u8fd9\u662f\u8981\u8bb0\u5f97\u7528\u4e00\u4e2aans\u53d8\u91cf\u6765\u8bb0\u5f55\u76ee\u524d\u5df2\u7ecf\u6709\u591a\u5c11\u662f\u7b26\u5408\u8981\u6c42\u7684\u4e86\uff0c\u4e0d\u65ad\u7684\u8fd0\u7528\u52a0\u6cd5\u5373\u53ef\uff0c\n\u6bd4\u5982\u8bf4\u4e00\u5f00\u59cb\u7684\u539f\u6570\u7ec4\u4e3a5 4 2 6 3 1\uff0c\u6309\u7740\u4ece\u5927\u5230\u5c0f\u62cd\u5b8c\u987a\u5e8f\u4ee5\u540e\uff0c\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u7684id\u987a\u5e8f\u4e3a4 1 2 5 3 6\n\u6b64\u65f6\uff0c\u628a\u65b0\u5f97\u5230\u7684id\u4f5c\u4e3ac\u6570\u7ec4\uff0c\u4e0d\u65ad\u7684\u52a0\uff08\u25c6\u539f\u7406\u548c\u7b80\u5355\uff09\n{\n\u00a4\u7b2c\u4e00\u4e2a\u6570\u4e3a4\n\u5148\u653e\u8fdb\u53bb4 \uff0c\u8fd9\u662f4\u662f\u6700\u5927\u7684\uff0c\uff08\u8981\u77e5\u9053\uff0c\u73b0\u5728\u52a0\u8fdb\u53bb\u7684\u6570\u7684id\u5982\u679c\u5f88\u5927\uff0c\uff08\u6bd4\u5df2\u7ecf\u52a0\u8fdb\u53bb\u7684\u8fd8\u8981\u6253\uff0c\u5c31\u8bf4\u660e\u8fd9\u7684\u6570\u7684id\u5927\u4f46\u662f\u6570\u76ee\u5c0f\uff0c\u8fd9\u65f6\u5019\u770b\u770b\u4f20\u8f93\u7ec4\u4e2d\n\u5df2\u7ecf\u52a0\u8fdb\u53bb\u7684\uff0c\u5982\u679cid\u6bd4\u8fd9\u4e2a\u5c0f\u4f46\u662f\u5df2\u7ecf\u653e\u8fdb\u53bb\u4e86\uff0c\u5c31\u53ea\u80fd\u8bf4\u660e\u5df2\u7ecf\u653e\u8fdb\u53bb\u7684\u6570\u6bd4\u8fd9\u4e2aid\u5927\u7684\u6570\u6570\u503c\u5927\uff0c\u5c31\u7b26\u5408\u9006\u5e8f\u5bf9\u7684\u8981\u6c42\uff0c\u8fd9\u6837\u5c31\u6bd4\u8f83\u660e\u663e\u4e86\n\u53ea\u8981\u5728\u6bcf\u653e\u4e00\u4e2a\u6570\u7684\u65f6\u5019\uff0c\u627e\u51faid\u6bd4\u5f53\u524d\u503c\u5c0f\u7684\u5c31ok\u4e86\uff09\uff0c\u4e8e\u662f\u6709\u4e86\u4ee5\u4e0a\u4ee3\u7801\uff0c\u25ce\u25ce\u25ce\u25ce\u25ce\u25ce\u25ce\u25ce\uff09\nlast but not least\n\u6c42\u9006\u5e8f\u5bf9\u6570\u76ee\u7684\u65f6\u5019\u8981\u7528\u5230\u6811\u72b6\u6570\u7ec4\uff08\u8fd9\u4e9b\u90fd\u662f\u5c0f\u4e8b\uff0cbut \u8fd8\u633a\u597d\u7528\u7684\uff09 \n} */\n \n\n\n\n\n\n\n\n\n",
        "postTime": 1569072166,
        "uid": 184355,
        "name": "lsm123",
        "ccfLevel": 0,
        "title": "\u6811\u72b6\u6570\u7ec4 \uff08\u53ca\u5176\u5e94\u7528~~~\uff09"
    },
    {
        "content": "\u8fd9\u91cc\u4ecb\u7ecd\u4e09\u79cd\uff08\u5b9e\u9645\u4e0a\u662f\u4e24\u79cd\uff09\u65b9\u6cd5\u3002\n\n## ~~\uff08\u79d1\u5b66\uff09~~\u66b4\u529b\u6cd5\n\n\u867d\u7136\u662f\u66b4\u529b\uff0c\u4f46\u662f\u8fd9\u4e2a\u66b4\u529b\u53ef\u4ee5\u5f97\u5230$70pts$\uff08[\u8bc4\u6d4b\u8bb0\u5f55](https://www.luogu.org/record/23109798)\uff09\u7684\u597d\u6210\u7ee9\u3002\n\n\u601d\u60f3\u5f88\u7b80\u5355\uff0c\u5982\u679c\u662f1\u64cd\u4f5c\uff0c\u5c31\u5c06\u64cd\u4f5c\u533a\u95f4\u4fdd\u5b58\u3002\n\n\u5982\u679c\u662f2\u64cd\u4f5c\uff0c\u5c31\u904d\u5386\u4fdd\u5b58\u8fc7\u7684\u6240\u6709\u533a\u95f4\uff0c\u5224\u65ad\u8981\u67e5\u8be2\u7684\u6570\u662f\u5426\u5728\u533a\u95f4\u5185\u90e8\u5c31\u53ef\u4ee5\u4e86\u3002\n\n```cpp\n#include <iostream>\n#include <cstring>\n#include <cstdio>\nusing namespace std;\ntypedef long long LL;\n\nconst LL maxn = 5e5 + 10;\n\nLL n, m;\nLL A[maxn];\nLL L[maxn], R[maxn], K[maxn];\nLL add_cnt = 0;\n\ninline LL fast_read(){\n\tLL f = 1, x = 0;\n\tchar ch = getchar();\n\twhile(ch < '0' || ch > '9'){\n\t\tif(ch == '-') f = -1;\n\t\tch = getchar();\n\t}\n\twhile(ch >= '0' && ch <= '9'){\n\t\tx = (x * 10) + (ch - '0');\n\t\tch = getchar();\n\t}\n\treturn f * x;\n}\n\nint main(){\n\tLL o, x, y, k;\n\tn = fast_read(); m = fast_read();\n\tfor(register LL i = 1 ; i <= n ; i++) A[i] = fast_read();\n\tfor(register LL i = 1 ; i <= m ; i++){\n\t\to = fast_read();\n\t\tif(o == 1){\n\t\t\tx = fast_read(); y = fast_read(); k = fast_read();\n\t\t\tL[add_cnt] = x; R[add_cnt] = y; K[add_cnt] = k;\n\t\t\tadd_cnt += 1;\n\t\t}\n\t\tif(o == 2){\n\t\t\tx = fast_read();\n\t\t\tLL res = A[x];\n\t\t\tfor(LL j = 0 ; j < add_cnt ; j++){\n\t\t\t\tif(L[j] <= x && R[j] >= x) res += K[j];\n\t\t\t}\n\t\t\tcout << res << endl;\n\t\t}\n\t}\n}\n```\n\n## \u6811\u72b6\u6570\u7ec4\u7684\u4e24\u79cd\u7406\u89e3\uff08\u7f16\u7a0b\uff09\u65b9\u5f0f\n\u7b2c\u4e00\u79cd\u65b9\u5f0f\u975e\u5e38\u597d\u7406\u89e3\u3002\n\n\u8003\u8651\u4e0b\u9762\u8fd9\u4e2a\u60c5\u51b5\uff0c\u6211\u7528\u62ec\u53f7\u8868\u793a\u5f53\u524d\u4fee\u6539\u8fc7\u7684\u533a\u95f4\uff0c$*$\u8868\u793a\u8981\u67e5\u8be2\u7684\u4f4d\u7f6e\n\n$\\{\\quad[\\quad (\\quad\\; )\\quad*\\;]\\quad\\}$\n\n\u60f3\u8c61\u4f60\u4ece\u6700\u5de6\u8fb9\u5411$*$\u7684\u4f4d\u7f6e\u8d70\u53bb\uff0c\u5982\u679c\u649e\u5230\u4e86\u5de6\u62ec\u53f7\uff0c\u90a3\u4e48\u5c31\u8bf4\u660e\u4f60\u8fdb\u5165\u4e86\u4e00\u4e2a\u4fee\u6539\u8fc7\u7684\u533a\u95f4\uff0c\u5982\u679c\u649e\u5230\u4e86\u53f3\u62ec\u53f7\uff0c\u90a3\u4e48\u8bf4\u660e\u4f60\u4ece\u67d0\u4e2a\u533a\u95f4\u51fa\u53bb\u4e86\u3002\n\n\u6bd4\u5982\u4e0a\u9762\u7684\u60c5\u51b5\uff0c\u4f60\u5148\u649e\u89c1\u4e86$\\{$\uff0c\u5c31\u8fdb\u5165\u4e86$\\{\\;\\}$\u533a\u95f4\u7684\u8303\u56f4\uff0c\u53c8\u649e\u89c1\u4e86$[$\uff0c\u5c31\u8fdb\u5165$[\\;]$\u533a\u95f4\u7684\u8303\u56f4\uff0c\u63a5\u7740\u4f60\u649e\u89c1\u4e86$($\uff0c\u4f46\u662f\u4f60\u53c8\u649e\u89c1\u4e86$)$\uff0c\u4e8e\u662f\u4f60\u5c31\u8d70\u51fa\u4e86$(\\;)$\u533a\u95f4\u7684\u8303\u56f4\u3002\u518d\u5f80\u524d\u8d70\u5c31\u5230\u4e86$*$\u3002\n\n\u603b\u8ba1\u4e00\u4e0b\uff0c\u4f60\u4e00\u5171\u8fdb\u5165\u4e86\u4e24\u4e2a\u533a\u95f4$\\{\\}$\u4e0e$[]$\uff0c\u6240\u4ee5\u8bf4$*$\u7684\u503c\u4e00\u5b9a\u662f\u539f\u6765\u7684\u503c\u518d\u52a0\u4e0a\u8fd9\u4e24\u4e2a\u533a\u95f4\u7684\u4fee\u6539\u3002\n\n\u6211\u4eec\u6574\u7406\u4e00\u4e0b\uff0c\u5c31\u53ef\u4ee5\u5f97\u51fa\u4ee5\u4e0b\u7b97\u6cd5\uff1a\n\n\u8d77\u521d\uff0c$B$\u6570\u7ec4\uff08\u4ee5$1$\u5f00\u59cb\uff09\u7684\u503c\u5168\u90e8\u4e3a$0$\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u6b21\u4fee\u6539$(x, y, k)$\uff0c\u5c06$B[x]$\u7684\u503c\u589e\u52a0$k$,$B[y+1]$\uff08\u4e3a\u4ec0\u4e48\u662f$y+1$\u5728\u4e0b\u9762\u8bf4\u660e\uff09\u7684\u503c\u51cf\u5c11$k$\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u6b21\u67e5\u8be2$x$\uff0c\u8ba1\u7b97$B[1]$\u503c$B[x]$\u7684\u548c\uff08\u82e5$x$\u6b63\u597d\u5728\u67d0\u4e2a\u533a\u95f4\u7684\u53f3\u7aef\uff0c\u90a3\u4e48\u5b83\u8fd8\u662f\u5728\u8fd9\u4e2a\u533a\u95f4\u5185\u7684\uff0c\u6240\u4ee5\u8981\u5c06$B[y+1]$\u800c\u4e0d\u662f$B[y]$\u51cf\u5c11$k$\uff09\n\n\u8fd9\u5c31\u662f\u6811\u72b6\u6570\u7ec4\u7684\u6807\u51c6\u64cd\u4f5c\uff08\u5355\u70b9\u4fee\u6539&\u533a\u95f4\u67e5\u8be2\uff09\uff0c\u5c06\u6a21\u677f\u98981\u7684\u4ee3\u7801\u7565\u5fae\u6539\u52a8\u4e00\u4e0b\u5c31\u53ef\u4ee5$AC$\u3002\n\n```cpp\n#include <iostream>\n#include <cstring>\n#include <cstdio>\nusing namespace std;\ntypedef long long LL;\n\nconst LL maxn = 5e5 + 100;\nLL C[maxn], A[maxn];\nLL n, m;\n\ninline LL fast_read(){\n\tLL f = 1, x = 0;\n\tchar ch = getchar();\n\twhile(ch < '0' || ch > '9'){\n\t\tif(ch == '-') f = -1;\n\t\tch = getchar();\n\t}\n\twhile(ch >= '0' && ch <= '9'){\n\t\tx = x * 10 + (ch - '0');\n\t\tch = getchar();\n\t}\n\treturn f * x;\n}\n\ninline LL lowbit(LL x){\n\treturn x & (-x);\n}\n\nLL prefix_sum(LL x){\n\tif(x == 0) return 0;\n\tLL res = 0;\n\twhile(x > 0){\n\t\tres += C[x];\n\t\tx -= lowbit(x);\n\t}\n\treturn res;\n}\n\nvoid add(LL x, LL k){\n\twhile(x <= n){\n\t\tC[x] += k;\n\t\tx += lowbit(x);\n\t}\n}\n\nint main(){\n\tcin >> n >> m;\n\tLL o, x, y, k;\n\tmemset(C, 0, sizeof(C));\n\tfor(register LL i = 1 ; i <= n ; i++) A[i] = fast_read();\n\tfor(register LL i = 1 ; i <= m ; i++){\n\t\to = fast_read();\n\t\tif(o == 1){\n\t\t\tx = fast_read(); y = fast_read(); k = fast_read();\n\t\t\tadd(x, k); add(y + 1, -k);\n\t\t}\n\t\tif(o == 2){\n\t\t\tx = fast_read();\n\t\t\tcout << A[x] + prefix_sum(x) << endl;\n\t\t}\n\t}\n}\n```\n\n\u7b2c\u4e8c\u79cd\u65b9\u6cd5\u4e0d\u592a\u5bb9\u6613\u7406\u89e3\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u6811\u72b6\u6570\u7ec4\u652f\u6301\u5355\u70b9\u4fee\u6539&\u533a\u95f4\u67e5\u8be2\u3002\u4f46\u662f\u8fd9\u9053\u9898\u9700\u8981\u533a\u95f4\u4fee\u6539&\u5355\u70b9\u67e5\u8be2\u3002\n\n\u6211\u4eec\u4e0d\u59a8\u5c06\u533a\u95f4\u67e5\u8be2\u7684\u4ee3\u7801\u6539\u52a8\u4e00\u4e0b\uff0c\u53d8\u4e3a\u533a\u95f4\u4fee\u6539\u7684\u4ee3\u7801\u3002\n\n```\nvoid prefix_add(LL x, LL k){\n\tif(x == 0) return;\n\twhile(x > 0){\n\t\tC[x] += k;\n\t\tx -= lowbit(x);\n\t}\n}\n```\n\n\u540c\u6837\uff0c\u5c06\u5355\u70b9\u4fee\u6539\u7684\u4ee3\u7801\u4fee\u6539\u4e00\u4e0b\uff0c\u53d8\u4e3a\u5355\u70b9\u67e5\u8be2\u7684\u4ee3\u7801\u3002\n\n```\nLL get(LL x){\n\tLL res = 0;\n\twhile(x <= n){\n\t\tres += C[x];\n\t\tx += lowbit(x);\n\t}\n\treturn res;\n}\n```\n\n\u8fdb\u800c\u5f97\u6765\u4e86\u4e0b\u9762\u7684\u4ee3\u7801\uff1a\n\n```cpp\n#include <iostream>\n#include <cstring>\n#include <cstdio>\nusing namespace std;\ntypedef long long LL;\n\nconst LL maxn = 5e5 + 100;\nLL C[maxn], A[maxn];\nLL n, m;\n\ninline LL fast_read(){\n\tLL f = 1, x = 0;\n\tchar ch = getchar();\n\twhile(ch < '0' || ch > '9'){\n\t\tif(ch == '-') f = -1;\n\t\tch = getchar();\n\t}\n\twhile(ch >= '0' && ch <= '9'){\n\t\tx = x * 10 + (ch - '0');\n\t\tch = getchar();\n\t}\n\treturn f * x;\n}\n\ninline LL lowbit(LL x){\n\treturn x & (-x);\n}\n\nvoid prefix_add(LL x, LL k){\n\tif(x == 0) return;\n\twhile(x > 0){\n\t\tC[x] += k;\n\t\tx -= lowbit(x);\n\t}\n}\n\nLL get(LL x){\n\tLL res = 0;\n\twhile(x <= n){\n\t\tres += C[x];\n\t\tx += lowbit(x);\n\t}\n\treturn res;\n}\n\nint main(){\n\tcin >> n >> m;\n\tLL o, x, y, k;\n\tmemset(C, 0, sizeof(C));\n\tfor(register LL i = 1 ; i <= n ; i++){\n\t\tA[i] = fast_read();\n\t}\n\tfor(register LL i = 1 ; i <= m ; i++){\n\t\to = fast_read();\n\t\tif(o == 1){\n\t\t\tx = fast_read(); y = fast_read(); k = fast_read();\n\t\t\tprefix_add(y, k); prefix_add(x - 1, -k);\n\t\t}\n\t\tif(o == 2){\n\t\t\tx = fast_read();\n\t\t\tcout << A[x] + get(x) << endl;\n\t\t}\n\t}\n}\n```\n\n\u5927\u4f53\u601d\u8def\u5c31\u662f\u5728\u533a\u95f4\u4fee\u6539\u65f6\uff0c\u5c06$[1, y]$\u533a\u95f4\u52a0$k$\uff0c$[1, x-1$\u533a\u95f4\u51cf$k$\u3002",
        "postTime": 1566372950,
        "uid": 68573,
        "name": "usercjh123",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "\u524d\u7f6e\u77e5\u8bc6:[P3374 \u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 1](https://www.luogu.org/problemnew/show/P3374)\n\n\u5982\u679c\u4f60\u6ca1\u6709\u5b66\u8fc7,\u70b9\u51fb[\u8fd9\u91cc](https://www.luogu.org/blog/rezerotime/solution-p3374)\n\n\u8fd9\u9898\u7684\u4fee\u6539\u64cd\u4f5c\u4e0e\u67e5\u8be2\u64cd\u4f5c\u6b63\u597d\u4e0eP3374\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec41\u76f8\u53cd,\u90a3\u6211\u4eec\u5e94\u8be5\u600e\u4e48\u53bb\u5199\u5462\uff1f\n\n\u5dee\u5206\uff01\n\n\u5dee\u5206,\u5c31\u662f\u8bb0\u5f55\u540e\u4e00\u4e2a\u6570\u7684\u503c\u51cf\u53bb\u524d\u4e00\u4e2a\u6570\u3002\n\n\u90a3\u4e48\u95ee\u9898\u6765\u4e86:\u5dee\u5206\u6709\u4ec0\u4e48\u7528\u5462\uff1f\n\n\u5de8\u4f6c\u4eec:\u8fd9\u9898\u89e3\u5c45\u7136\u8fd8\u80fd\u63d0\u51fa\u8fd9\u4e48ZZ\u7684\u95ee\u9898,\u4f5c\u8005\u60f3\u5fc5\u84bb\u5230\u7206\u70b8,\u4e5f\u6ca1\u4ec0\u4e48\u597d\u770b\u7684,\u6563\u4e86\u6563\u4e86\n\n\u8bf6,\u522b\u8d70\u554a,\u8ba9\u6211\u4eec\u6765\u770b\u4e00\u770b\u5dee\u5206\u5728\u8fd9\u9898\u4e2d\u7684\u5999\u5904\n\n\u5dee\u5206\u540e,\u6bcf\u6b21\u4fee\u6539\u533a\u95f4\u53ea\u9700\u8981\u4fee\u6539\u5dee\u5206\u6570\u7ec4\u4e2d\u533a\u95f4\u5de6\u7aef\u548c\u53f3\u7aef\u53f3\u8fb9\u4e00\u4e2a\u5143\u7d20\u7684\u503c\u5c31\u591f\u4e86,\u65f6\u95f4\u590d\u6742\u5ea6O(1)\n\n\u81f3\u4e8e\u67e5\u8be2,\u5c31\u662f\u88ab\u67e5\u8be2\u7684\u5143\u7d20\u4e0e\u5176\u4e4b\u524d\u7684\u5dee\u5206\u6570\u7ec4\u4e4b\u548c,\u65f6\u95f4\u590d\u6742\u5ea6O(x)\n\n\u7531\u4e8e\u6211\u4eec\u77e5\u9053\u51fa\u9898\u4eba\u80af\u5b9a\u4f1a\u6bd2\u7624\u5730\u51fa\u5f88\u591a\u5f88\u591a\u67e5\u8be2\u64cd\u4f5c\u5361\u66b4\u529b,\u6240\u4ee5\u6211\u4eec\u7528\u6811\u72b6\u6570\u7ec4\u6765\u50a8\u5b58\u5dee\u5206\u6570\u7ec4\n\n\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u5927\u5927\u5747\u8861,\u4fee\u6539\u4e3aO(logn),\u67e5\u8be2\u4e3aO(logx)\n\n\u4ee3\u7801:\n```cpp\n#include<bits/stdc++.h>\n#define MAX 500005\nusing namespace std;\nint n,m,tree[MAX];\ninline void add(int k,int num)\n{\n    while(k<=n)\n    {\n        tree[k]+=num;\n        k+=k&-k;\n    }\n}//\u4fee\u6539\ninline int sum(int k)\n{\n   int sum(0);\n   while(k)\n   {\n\tsum+=tree[k];\n\tk-=k&-k;\n   }\n   return sum;\n}//\u67e5\u8be2\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\tint s(0);\n\tfor(int i(1);i<=n;++i)\n\t{\n\t\tint x;\n\t\tscanf(\"%d\",&x);\n\t\tadd(i,x-s);//\u521d\u59cb\u5316\n\t\ts=x;//\u6eda\u52a8\u6570\u7ec4\u8bb0\u5dee\u5206\n\t}\n\tfor(int i(1);i<=m;++i)\n\t{\n\t\tscanf(\"%d\",&s);\n\t\tif(s==1)\n\t\t{\n\t\t\tint x,y,z;\n\t\t\tscanf(\"%d%d%d\",&x,&y,&z);\n\t\t\tadd(x,z),add(y+1,-z);//\u524d\u4e00\u4e2a+z,\u540e\u4e00\u4e2a-z\u5c31\u5b9e\u73b0\u4e86\u4fee\u6539\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint x;\n\t\t\tscanf(\"%d\",&x);\n\t\t\tprintf(\"%d\\n\",sum(x));\n\t\t}\n\t}\n}\n```\n",
        "postTime": 1563264328,
        "uid": 111741,
        "name": "\u5854\u7f57\u5170",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "\u5982\u9898\u76ee\u7684\u6807\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4\uff0c\u4f46\u662f\u5462\uff0c\u5176\u5b9e\u6211\u53d1\u73b0\u7528\u5206\u5757\u4e5f\u53ef\u4ee5\u8fc7\u8fd9\u9898\u7684\u3002\n\n[\u8bc4\u6d4b\u8bb0\u5f55](https://www.luogu.org/recordnew/show/16528023)\n\n\u867d\u7136\u4e09\u4e2a\u70b9\u6bd4\u8f83\u6162\uff0c\u4f46\u662f\u4e0d\u7ba1\u63d0\u4ea4\u591a\u5c11\u6b21\u90fd\u4e0d\u4f1aTLE\u7684\u3002\n\n\u597d\u7684\uff0c\u90a3\u4e48\uff0c\u6211\u4eec\u6765\u8bf4\u4e00\u4e0b\uff0c\u4ec0\u4e48\u662f\u5206\u5757\u3002\u5206\u5757\u53c8\u53eb\u505a\u4f18\u96c5\u7684\u66b4\u529b\uff08\u5c31\u662f\u66b4\u529b\uff09\uff0c\u4f46\u662f\u5462\uff0c\u4e0d\u662f\u7eaf\u66b4\u529b\uff0c\u800c\u5df2\u5c06\u66b4\u529b\u7684\u539f\u5e8f\u5217\u8fdb\u884c\u5206\u5272\uff0c\u53d8\u6210\u51e0\u4e2a\u5757\uff0c\u4e00\u822c\u6211\u4eec\u90fd\u662f\u5206\u6210$\\sqrt(n)$\u4e2a\u7684\uff0c\u8fd9\u6837\u53ef\u4ee5\u8ba9\u6211\u4eec\u5728\u9047\u5230\u4e0d\u5b8c\u6574\u7684\u5757\u65f6\uff0c\u7eaf\u66b4\u529b\u7684\u6b21\u6570\u5747\u644a\u6700\u5c11\u3002\u4f46\u662f\uff0c\u6ce8\u610f\uff0c\u6211\u4eec\u6240\u8981\u5206\u5757\u7684\u5e8f\u5217\u5fc5\u987b\u662f\u4e2a\u9759\u6001\u5e8f\u5217\uff0c\u4e0d\u662f\u8bf4\u5143\u7d20\u4e0d\u80fd\u53d8\uff0c\u800c\u662f\u4e0d\u80fd\u5c06\u4e2a\u6570\u8fdb\u884c\u6539\u53d8\uff0c\u5982\u679c\u8981\u505a\u52a8\u6001\u5e8f\u5217\u7684\u5206\u5feb\u7684\u8bdd\uff0c\u9700\u8981\u501f\u52a9\u6570\u636e\u7ed3\u6784\uff0c\u5728\u8fd9\u91cc\u5c31\u4e0d\u8bf4\u4e86\u3002\uff08\u56e0\u4e3a\u6211\u592a\u5f31\u4e86QAQ\u4e0d\u6562\u73ed\u95e8\u5f04\u65a7\uff09\n\n\u90a3\u4e48\u6211\u4eec\u6765\u8bf4\u4e00\u4e0b\u8fd9\u4e00\u9898\u3002  \n\u5176\u5b9e\u8fd9\u9898\u7528\u4e0d\u5230\u5206\u5757\u7684\u5168\u90e8\uff0c\u53ea\u9700\u8981\u7528\u5230\u6807\u5fd7\u7684tag\u6570\u7ec4\uff0c\u5373\u53ef\u6c42\u503c\u3002\n$belong_i$\u8868\u793a\u7b2ci\u4e2a\u5143\u7d20\u6240\u5728\u7684\u662f\u7b2c\u51e0\u4e2a\u5757\uff0c$l_i\\ \\ r_i$\u8868\u793a\u7b2ci\u4e2a\u5757\u7684\u5de6\u8fb9\u754c\u548c\u53f3\u8fb9\u754c\u3002\n\n\u4e0b\u9762\u8bf7\u770b\u7a0b\u5e8f\uff0c\u9644\u6709\u6ce8\u91ca\u3002\n\n\u5982\u679c\u60f3\u5b66\u4e60\u5206\u5757\u57fa\u7840\uff0c\u53ef\u4ee5\u770b[cn\u82cf\u537f\u5ff5\u7684\u535a\u5ba2](https://www.cnblogs.com/cn-suqingnian/p/9302143.html)  \n\u5982\u679c\u60f3\u5b66\u4e60\u591a\u79cd\u5206\u5757\uff0c\u53ef\u4ee5\u770b[\u8fd9\u4f4d\u7237\u7684\u535a\u5ba2](http://hzwer.com/8053.html)  \n\uff08\u8fd9\u4e0d\u662f\u5ba3\u4f20\u2026\u2026\u2026\u2026\u6302\u7684\u53c8\u4e0d\u662f\u6211\u7684\u535a\u5ba2\u2026\u2026\u2026\u2026\uff09\n\nPS\uff1a\u5206\u5757\u4e0d\u6b62\u53ef\u4ee5\u8fc7\u8fd9\u9898\uff0c\u7ebf\u6bb5\u6811\u7684\u6a21\u677f\u4e5f\u662f\u53ef\u4ee5\u8fc7\u5f97\u3002[\u8bc4\u6d4b\u8bb0\u5f55](https://www.luogu.org/recordnew/show/16554702)\n```cpp\n#include<stdio.h>\n#include<cctype>\n#include<cstring>\n#include<algorithm>\n#include<cmath>\nusing namespace std;\ntypedef unsigned long long ull;\ntypedef unsigned long int ul;\ntypedef long long ll;\nchar buf[1<<21],*p1=buf,*p2=buf;\ninline int getch()\n{\n    return p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++;\n}\nchar buf2[1<<21],pr[20];\nint p,p3=-1;\ninline void flush()\n{\n    fwrite(buf2,1,p3+1,stdout),p3=-1;\n}\ninline void print(int x)\n{\n    if(p3>1<<20) flush();\n    do{pr[++p]=x%10+48;}while(x/=10);\n    do{buf2[++p3]=pr[p];}while(--p);\n    buf2[++p3]='\\n';\n}\ntemplate <class code>inline code read(const code &a)\n{\n    code x=0;short w=0;char ch=getch();\n    while(!isdigit(ch)) {w|=ch=='-';ch=getch();}\n    while(isdigit(ch)) {x=(x<<3)+(x<<1)+(ch^48);ch=getch();}\n    return w?-x:x;\n}\nint n;\nconst int N=500000;\nconst int M=50000;\nint a[N+5];\nint tag[M+5];\nint belong[N+5];\nint l[M+5];\nint r[M+5];\nint block;//\u5206\u5757\u7684\u5757\u6570\uff0c\u4e3asqrt(n)\nint num;\nint m;\nint main ()\n{\n    //freopen(\"blocking.in\",\"r\",stdin);\n    //freopen(\"blocking.out\",\"w\",stdout);\n    n=read(n),m=read(m);\n    block=sqrt(n);\n    num=ceil(1.0*n/block);\n    for(register int i=1;i<=n;i++)\n    {\n        a[i]=read(a[i]);\n        belong[i]=(i-1)/block+1;\n    }\n    for(register int i=1;i<=num;i++)\n    {\n        l[i]=r[i-1]+1;\n        r[i]=r[i-1]+block;\n    }\n    r[num]=n;\n    while(m--)\n    {\n        int f,b;\n        f=read(f);\n        if(f==1)//\u6700\u91cd\u8981\u7684\u5728\u8fd9\u91cc\uff0c\u5982\u4f55\u533a\u95f4\u4fee\u6539\n        {\n            /*\u6211\u4eec\u5c06\u8981\u4fee\u6539\u7684\u5730\u65b9\u5206\u62103\u90e8\u5206a,b,c\uff08\u53d8\u91cf\u610f\u4e49\u4e0e\u4ee3\u7801\u4e2d\u7684\u53d8\u91cf\u65e0\u5173\uff09\u3002\n            a\u7684\u90e8\u5206\u662f\u5de6\u8fb9\u4e0d\u5b8c\u6574\u7684\u5757\uff0cb\u7684\u90e8\u5206\u662f\u5b8c\u6574\u7684\u5757\uff0cc\u7684\u90e8\u5206\u662f\u53f3\u8fb9\u4e0d\u5b8c\u6574\u7684\u5757\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5355\u72ec\u5904\u7406a,c\uff08\u7eaf\u66b4\u529b\u5904\u7406\uff09\u5373\u53ef*/\n            /*\u5355\u72ec\u5904\u7406\u7684\u90e8\u5206\u662f\u4fee\u6539\u5e8f\u5217\uff0c\u5b8c\u6574\u7684\u5757\u7684\u8bdd\uff0c\u662f\u4fee\u6539tag\uff0c\u6700\u540e\u8f93\u51fa\u662f\u53ea\u9700\u8f93\u51fa\u539f\u5e8f\u5217\u7684\u6570\u52a0\u4e0atag\u5373\u53ef*/\n            int q,c;\n            q=read(q),b=read(b),c=read(c);\n            int left=q,right=b,x=c;\n            for(register int i=left;i<=min(right,r[belong[left]]);i++)\n            {\n                a[i]+=x;\n            }\n            if(belong[left]!=belong[right])\n            {\n                for(register int i=l[belong[right]];i<=right;i++)\n                {\n                    a[i]+=x;\n                }\n            }\n            for(register int i=belong[left]+1;i<=belong[right]-1;i++)\n            {\n                tag[i]+=x;\n            }\n        }\n        else\n        {\n            b=read(b);\n            print(a[b]+tag[belong[b]]); \n        }\n    }\n    flush();\n    return 0;\n}\n```\n",
        "postTime": 1550676831,
        "uid": 96340,
        "name": "AC\u673a",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "\u9053\u9898\u5f88\u660e\u663e\u53ef\u4ee5\u7528\u66b4\u529b\u554a\uff0c\u800c\u4e14\u6570\u636e\u679c\u7136\u4e3a70%\uff0c\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u4ed6\u8ba9\u6211\u4eec\u5e72\u4ec0\u4e48\uff0c\u548b\u4eec\u5c31\u5e72\u4ec0\u4e48\uff0c\u8fd9\u6837\u53ef\u4ee5\u5f9770\u5206\n\u4ee3\u7801\u5982\u4e0b\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint a[500020];\nint n,m;\nvoid jia(){//\u8ba9\u4f60\u5e72\u4ec0\u4e48\u4f60\u5c31\u5e72\u4ec0\u4e48\uff0c\u8ba9\u6211\u4eec\u52a0\u548b\u4eec\u5c31\u52a0 \n\tint x,y,z;\n\tcin>>x>>y>>z;\n\tfor(int i=x;i<=y;i++){\n\t\ta[i]+=z;//\u6b64\u5904\u4e3anot AC\u57cb\u4e0b\u4e86\u4f0f\u7b14 \n\t}\n}\nvoid shu(){\n\tint x;\n\tcin>>x;\n\tcout<<a[x]<<endl;\n} \nint main(){\n\tcin>>n>>m;\n\tfor(int i=1;i<=n;i++){\n\t\tcin>>a[i];\n\t}\n\tfor(int i=1;i<=m;i++){\n\t\tint o;\n\t\tcin>>o; \n\t\tif(o==1){\n\t\t\tjia();\n\t\t}else{\n\t\t\tshu();\n\t\t}\n\t}\n\treturn 0;\n}\n\n```\n\u559c\u95fb\u4e50\u89c1\uff0c\u679c\u7136\u771f\u662f70\u5206\uff0c\u770b\u6765\u80cc\u4e0d\u8fc7\u6a21\u677f\u8fd8\u771f\u80fd\u9a97\u5230\u5206\u554a\n\u6211\u53bb\u8fd9\u4e48\u597d\u7684\u601d\u8def\uff0c\u7adf\u7136\u6302\u4e86\uff0c\u4ed4\u7ec6\u4e00\u770b\uff0c\u53d1\u73b0\u6570\u636e\u662f500000\uff0c\u771f\u662f..\uff08\u5176\u5b9e\u662f\u6545\u610f\u7684\uff09\n\u6362\u4e00\u79cd\u601d\u8def\uff0c\u7b49\u7b49\u8fd9\u9053\u9898\u7684\u9898\u76ee\u53eb\u6811\u72b6\u6570\u7ec4\uff0c\u90a3\u6211\u4eec\u5c31\u7528\u8fd9\u4e2a\u6a21\u677f\u5427 \n\u8c8c\u4f3c\u548c\u6811\u72b6\u6570\u7ec4\u4e00\u7684\u533a\u522b\u662f\u9700\u8981\u5dee\u5206\uff08\u79ef\u6728competition\uff09\u7684\u601d\u60f3 \n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint a[500020];\nint c[500020];\nint n,m;\nvoid jia(int x,int y) {//\u8ba9\u4f60\u5e72\u5565\u4f60\u5c31\u5e72\u5565..\n\tfor(int i=x;i<=n;i+=i&-i){//\u6a21\u677f\u6807\u51c6\u5faa\u73af \n\t\tc[i]+=y; //y\u4e3a\u6bcf\u6b21\u52a0\u7684\u6570\uff0cx\u4e3a\u5728\u6b64\u4e0a\u52a0\u7684\u6570 \n\t} \t\n} //\u548c\u4e0a\u4e00\u9898\u6ca1\u5565\u533a\u522b\uff0c\u4e0d\u8fc7\u6211\u4eec\u9700\u8981\u77e5\u9053\u4e00\u70b9\u4e1c\u897f\n/*lowbit(i) \u5b9a\u4e3a\u4e8c\u8fdb\u5236\u6700\u4f4e\u4f4d\u76841\n\u5927\u6982\u5f97\u5230\n\nlowbit(6) = 2     110//\u4e3a\u4ec0\u4e48\uff1f\u56e0\u4e3a1\u5728\u5012\u6570\u7b2c\u4e8c\u4f4d\uff0c2\u76841\u6b21\u65b9\u4e3a2 \nlowbit(1024) = 1024  10000000000\nlowbit(x) = x & -x\nx - lowbit(x) = (x & (x - 1))\n\na[1] a[2] a[3] a[4] a[5] a[6] a[7] a[8]\nc[i] = sum(a[i - lowbit(i) + 1 .. i])\n\nc[1] = a[1]\nc[2] = a[1] + a[2]\nc[3] = a[3]\nc[4] = a[1] + a[2] + a[3] + a[4]\nc[5] = a[5]\nc[6] = a[5] + a[6]\nc[7] = a[7]\nc[8] = a[1] + a[2] + ... + a[7] + a[8] \n\u597d\u5904\u5728\u4e8e\u628a\u4e0a\u4e00\u9898n^2\u4f18\u5316\u6210nlogn\n\u597d\u4e86\u628a\u4ec0\u4e48\u662fi&-i\u89e3\u91ca\u5b8c\u4e86 \n*/ \nint shu(int x){//\u4e4d\u4e00\u770b\u548c\u4e0a\u4e00\u9898\u4e00\u6837\uff0c\u5176\u5b9e\u7565\u6709\u6539\u52a8\n\tint re=0;\n\tfor(int i=x;i;i-=i&-i){\n\t\tre+=c[i];\n\t} //\u548c\u4e0a\u4e00\u5757\u53ea\u662f\u5012\u8fc7\u6765\u554a \n\treturn re;\n}\nint main(){\n\tcin>>n>>m;\n\tfor(int i=1;i<=n;i++){\n\t\tcin>>a[i];//\u8bfb\u5165\u6bcf\u4e00\u4e2a\u6570\u5b57 \n\t}\n\tfor(int i=1;i<=m;i++){\n\t\tint o,x,y,k;\n\t\tcin>>o;\n\t\tif(o==1){ \n\t\t\tcin>>x>>y>>k;\n\t\t\tjia(x,k);//\u6bcf\u6b21+k\uff0c\u9898\u76ee\u8bf4\u4e86 \n\t\t\tjia(y+1,-k);//\u5dee\u5206 \n\t\t}else{\n\t\t\tint x;\n\t\t\tcin>>x;\n\t\t\tcout<<shu(x)+a[x]<<endl;//\u5dee\u5206\u7684\u601d\u60f3 \n\t\t}\n\t}\n\treturn 0; \n} \n```\n\u679c\u7136AC\u4e86\n```cpp\n//\u5b8c\u5168\u53ef\u4ee5\u7528\u7ebf\u6bb5\u6811\u7684\u65b9\u6cd5\uff0c\u8fd9\u65b9\u6cd5\u662f\u6211\u6700\u4e0d\u719f\u7684 \n//\u4e00\u4e0b\u4e3a\u6a21\u677f\uff0c\u53ef\u80cc\u8fc7 \n#include <bits/stdc++.h>\nusing namespace std;\nlong long n, m;\nlong long a[10000020];\nlong long sm[10000020];\nlong long ad[10000020];\nlong long read(){\n\tlong long ret=0,f=1;char ch=getchar();\n\twhile(ch>'9'||ch<'0'){if(ch=='-')f=-f;ch=getchar();}\n\twhile(ch>='0'&&ch<='9') ret=ret*10+ch-'0',ch=getchar();\n\treturn ret*f;\n}//\u5feb\u8bfb\u4f18\u5316 \nvoid build(long long x, long long l, long long r) {\n\tif (l == r) {\n\t\tsm[x] = a[l];\n\t\treturn;\n\t}\n\tlong long mid = (l + r) / 2;\n\tbuild(x * 2, l, mid);\n\tbuild(x * 2 + 1, mid + 1, r);\n\tsm[x] = sm[x * 2] + sm[x * 2 + 1];\n}\nvoid add(long long x, long long l, long long r, long long v) {\n\tsm[x] += (r - l + 1) * v;\n\tad[x] += v;\n}\nvoid push(long long x, long long l, long long r) {\n\tint mid = (l + r) / 2;\n\tadd(x * 2, l, mid, ad[x]);\n\tadd(x * 2 + 1, mid + 1, r, ad[x]);\n\tad[x] = 0;\n}\nvoid change(long long x, long long l,long long r, long long L, long long R, long long v) {\n\tif (r < L || R < l) {\n\t\treturn;\n\t}\n\tif (L <= l && r <= R) {\n\t\tadd(x, l, r, v);\n\t\treturn;\n\t}\n\tpush(x, l, r);\n\tint mid = (l + r) / 2;\n\tchange(x * 2, l, mid, L, R, v);\n\tchange(x * 2 + 1, mid + 1, r, L, R, v);\n\tsm[x] = sm[x * 2] + sm[x * 2 + 1];\n}\nlong long query(long long x, long long l, long long r, long long L, long long R) {\n\tif (r < L || R < l) {\n\t\treturn 0;\n\t}\n\tif (L <= l && r <= R) {\n\t\treturn sm[x];\n\t}\n\tpush(x, l, r);\n\tlong long mid = (l + r) / 2;\n\treturn query(x * 2, l, mid, L, R) + query(x * 2 + 1, mid + 1, r, L, R);\n}\nint main() {\t\n\tn=read();\n\tm=read();\n\tfor (int i = 1; i <= n; i++) {\n\ta[i]=read();\n\t}\n\tbuild(1, 1, n);\n\tfor (int i = 0; i < m; i++) {\n\t\tlong long o, x, y,z;\n\t\to=read();\n\t\tif (o == 1) {\n\t\tx=read();\n\t\ty=read();\n\t\tz=read();\n\t\t\tchange(1, 1, n, x, y, z);\n\t\t} else {\n\t\tx=read();\n\t\t\tprintf(\"%lld\\n\", query(1, 1, n, x, x));\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1550411074,
        "uid": 155971,
        "name": "chongxinzailaile",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "\u4e0d\u7528\u8bf4\uff0c\u8fd8\u662f\u7ebf\u6bb5\u6811\u5927\u6cd5\u597d\uff0c\u8fd9\u662f\u7ebf\u6bb5\u6811\u6a21\u677f\uff0c\u533a\u95f4\u4fee\u6539\uff0c\u533a\u95f4\u67e5\u8be2\uff08\u5355\u70b9\u53ef\u4ee5\u6269\u5c55\u6210\u957f\u5ea6\u4e3a1\u7684\u533a\u95f4\uff09\uff0c\u4e0a\u4ee3\u7801\uff0c\u8be6\u89e3\u5728\u795e\u5947\u7684\u7ebf\u6bb5\u6811\u4e2d\u3002~~\uff08\u4f4d\u8fd0\u7b97\u52ff\u55b7\uff09~~\n\n\n------------\n\n```cpp\n// luogu-judger-enable-o2  \u5438\u6c27\u662f\u4e2a\u597d\u4e1c\u897f\n#include <bits/stdc++.h>\nusing namespace std;\nint n,m;\nint a[500005];\nint sum[4000005];\nint tag[4000005];\ninline void pushup(int x)\n{\n    sum[x]=sum[x<<1]+sum[(x<<1)+1];\n}\nvoid build(int x,int l,int r) //\u5efa\u6811\n{\n    if(l==r)\n    {\n        sum[x]=a[l];\n        return;\n    }\n    int m=(l+r)>>1;\n    build(x<<1,l,m);\n    build((x<<1)+1,m+1,r);\n    pushup(x);\n    return;\n}\nvoid pushdown(int x,int l,int r) //lazy_tag\n{\n    if(tag[x])\n    {\n        int m=(l+r)>>1;\n        int ls=x<<1;\n        int rs=ls+1;\n        tag[ls]+=tag[x];\n        tag[rs]+=tag[x];\n        sum[ls]+=tag[x]*(m-l+1);\n        sum[rs]+=tag[x]*(r-m);\n        tag[x]=0;\n    }\n    return;\n}\nvoid update(int x,int l,int r,int L,int R,int k) //\u533a\u95f4\u4fee\u6539\n{\n    if(R<l||r<L)\n        return;\n    if(L<=l&&r<=R)\n    {\n        tag[x]+=k;\n        sum[x]+=k*(r-l+1);\n        return;\n    }\n    pushdown(x,l,r);\n    int m=(l+r)>>1;\n    update(x<<1,l,m,L,R,k);\n    update((x<<1)+1,m+1,r,L,R,k);\n    pushup(x);\n    return;\n}\nint query(int x,int l,int r,int L,int R) //\u67e5\u8be2\n{\n    pushdown(x,l,r);\n    if(R<l||r<L)\n        return 0;\n    if(L<=l&&r<=R)\n        return sum[x];\n    int m=(l+r)>>1;\n    int ans=query(x<<1,l,m,L,R)+query((x<<1)+1,m+1,r,L,R);\n    return ans;\n}\nint main()\n{\n    ios::sync_with_stdio(0); //\u4e00\u70b9\u5c0f\u4f18\u5316\n    cin>>n>>m; //\u8bfb\u5165\n    for(int i=1;i<=n;++i)\n        cin>>a[i];\n    build(1,1,n); //\u5efa\u6811\n    int cnt;\n    while(m--)\n    {\n        cin>>cnt;\n        if(cnt==1) //\u533a\u95f4\u4fee\u6539\n        {\n            int x,y,k;\n            cin>>x>>y>>k;\n            update(1,1,n,x,y,k);\n        }\n        else //\u533a\u95f4\u67e5\u8be2\uff08\u5355\u70b9\u67e5\u8be2\uff09\n        {\n            int x;\n            cin>>x;\n            int ans=query(1,1,n,x,x); //x,x\u8868\u793a\u4e00\u4e2a\u957f\u5ea6\u4e3a1\u7684\u533a\u95f4\n            cout<<ans<<endl;\n        }\n    }\n    return 0;\n}\n```\n\n\n------------\n\u7801\u98ce\u5f88\u4e11\uff0c\u52ff\u55b7\u3002",
        "postTime": 1532416259,
        "uid": 37881,
        "name": "yzhang",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "## \u5206\u5757\n\n\u8c8c\u4f3c\u9898\u89e3\u91cc\u9762\u6ca1\u6709**\u5206\u5757**\u554a...\u6211\u6765\u53d1\u4e00\u4e2a\u5427\u3002\n\n\u867d\u7136\u662f\u6811\u72b6\u6570\u7ec4\u6a21\u677f\uff0c\u7528**\u5206\u5757\u89e3\u51b3**\u4e5f\u662f\u4e00\u4e2a\u5f88\u597d\u7684\u65b9\u6cd5\u3002\n\n\n\u7b80\u5355\u8bf4\u4e00\u4e0b\u5c31\u662f\u5c06\u5e8f\u5217\u5206\u4e3a$sqrt(n)$\u5757\uff0c\u6bcf\u4e00\u5757\u957f\u5ea6$sqrt(n)$\u3002\u4fee\u6539\u7684\u65f6\u5019\u5728\u4e00\u4e2a\u5757\u91cc\u9762\u5c31\u76f4\u63a5\u7ed9\u5757\u6253\u6807\uff0c\u4e0d\u5728\u5757\u91cc\u9762\u5c31\u66b4\u529b\u4fee\u6539\uff08\u4e0d\u4f1a\u8d85\u8fc7$2 * sqrt(n)$\u4e2a\uff09\u3002\n\n\n\u590d\u6742\u5ea6$O(n*sqrt(n))$\n\n\u4e0d\u5f00$O2$\u548c\u5f00$O2$\u90fd\u662f\u53ef\u4ee5$AC$\u7684\n\n\u6ca1\u6709O2\uff1a2000+ms O2:1000+ms\n\n\u4e0d\u5f97\u4e0d\u8bf4Luogu\u7684\u8bc4\u6d4b\u673a\u662f\u5f88\u5feb\u7684\n\n## \u4ee3\u7801\n\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(x, y, z) for(register int x = y; x <= z; x ++) \ninline int read(){\n    char ch = getchar(); int u = 0, f = 1;\n    while (!isdigit(ch)){ if (ch == '-') f = -1; ch = getchar();}\n    while (isdigit(ch)) {u = (u << 3) + (u << 1) + ch - 48; ch = getchar();}\n    return u * f;\n}\nconst int maxn = 500500;\nint n, m, blo;\nint v[maxn], tag[maxn], bl[maxn];\nnamespace Blo{//\u5206\u5757\n    inline void Add(int l, int r, int c){\n        rep (i, l, std::min(bl[l] * blo, r))\n            v[i] += c;\n        if (bl[l] != bl[r])\n        rep (i, (bl[r] - 1) * blo + 1, r)\n            v[i] += c;\n        rep (i, bl[l] + 1, bl[r] - 1)\n            tag[i] += c;\n    }\n    inline int query(int pos){//\u67e5\u8be2\u7684\u65f6\u5019\u5c31\u8fd4\u56de\u5355\u70b9+\u5757\u7684\u6807\u8bb0\n        return v[pos] + tag[bl[pos]];\n    }\n}\nint main(){\n    n = read(), m = read(); blo = sqrt(n);//\u5757\u7684\u5927\u5c0f\n    for (int i = 1; i <= n; i++) bl[i] = (i - 1)/blo + 1;\n    for (int i = 1; i <= n; i++) v[i] = read();\n    while (m--){\n        int opt = read();\n        if (opt == 1) {int l = read(), r = read(), c = read(); Blo::Add(l, r, c);} \n        else {\n            int x = read();\n            printf(\"%d\\n\",Blo::query(x));\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1515575098,
        "uid": 42857,
        "name": "Edgration",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "#\u201c\u6539\u6bb5\u53d6\u70b9\u201d\u578b\uff0c\u5dee\u5206\u6700\u9ad8\u6548\uff08\u81ea\u8ba4\u4e3a\uff0c\u4e0d\u559c\u52ff\u55b7\uff09\n\n##\u5341\u5206\u949f\u6253\u5b8c\u5dee\u5206\uff0c\u867d\u7136\u7b2c\u4e00\u6b21\u4ea4T\u4e86\u4e00\u4e2a\u70b9\uff0c\u4f46\u52a0\u5b8c\u5feb\u8bfb\u540e\u5c31\u8fc7\u4e86\uff0c\u5927\u4f6c\u4e5f\u53ef\u4ee5\u5e2e\u6211\u770b\u770b\uff0c\u54ea\u91cc\u53ef\u4ee5\u964d\u4f4e\u65f6\u95f4\u590d\u6742\u5ea6\n\n###\u5dee\u5206\u5373\u7528\u53e6\u4e00\u6570\u7ec4\u8868\u793aa[i],d[i]=a[i]-a[i-1],\u4e4b\u540e\u7528\u6811\u72b6\u6570\u7ec4c[i]\u7ef4\u62a4\uff1b\n\n\n\n```cpp\n#include<cstdio>\n#include<iostream>\nusing namespace std;\nint n,m;\nconst int maxn=500005;\nint a[maxn],d[maxn],c[maxn];\ninline void read(int &x){//\u5feb\u8bfb\uff08\u6709\u8bb8\u591a\u65b9\u5f0f\uff0c\u53ef\u767e\u5ea6\uff09\n    char c;bool flag=0;//flag\u5224\u65ad\u8bfb\u5165\u662f\u5426\u4e3a\u8d1f\u6570\n    while((c=getchar())<'0'||c>'9')\n      if(c=='-') flag=1;\n    x=c-'0';\n    while((c=getchar())>='0'&&c<='9') \n      x=x*10+c-'0';\n    if(flag) x=-x;\n}\ninline int lowbit(int x){//c[x]\u6240\u5305\u542b\u6240\u7ef4\u62a4\u6811\u72b6\u6570\u7ec4\u7684\u5927\u5c0f\n    return x&(-x);\n}\ninline void add(int pos,int x){//pos\u4f4d\u7f6e\u52a0x\uff0c\u5178\u578b\u5355\u70b9\u4fee\u6539\n    while(pos<=n){//\u4e0d\u8d85\u8fc7\u8303\u56f4\n        c[pos]+=x;//\u4f9d\u6b21\u6539\u53d8\u6811\u72b6\u6570\u7ec4c[]\u7684\u503c\n        pos+=lowbit(pos);//\u8df3\u5230\u4e0b\u4e00\u4e2a\u88ab\u5305\u542b\u7684c[];\n    }\n}\ninline int getsum(int pos){//\u6811\u72b6\u6570\u7ec4\u6c42\u548c\n    int ans=0;\n    while(pos>0){\n        ans+=c[pos];\n        pos-=lowbit(pos);\n    }\n    return ans;\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n;i++){\n        scanf(\"%d\",&a[i]);\n        d[i]=a[i]-a[i-1];//\u5dee\u5206\n        add(i,d[i]);//\u4e5f\u53ef\u4ee5\u5efa\u6811\u72b6\u6570\u7ec4\uff0c\u4f46\u7531\u4e8e\u6570\u7ec4\u521d\u59cb\u5316\u4e3a0\uff0c\u4fee\u6539\u5373\u65b0\u5efa\uff0c\u53ea\u662f\u6709\u4e9b\u61d2\uff0c\u60f3\u5c11\u6253\u4e00\u4e2a\u51fd\u6570\n    }\n//    for(int i=1;i<=n;i++)\n//      cout<<a[i]<<\" \"<<d[i]<<\"\\n\";\n    int t1,x,y,ad;\n    for(int i=1;i<=m;i++){//\u64cd\u4f5c\u6570\n        scanf(\"%d\",&t1);\n        if(t1==1){\n            scanf(\"%d%d%d\",&x,&y,&ad);\n                       //\u5dee\u5206\u6838\u5fc3\uff0c\u8868\u793aa[x->y]+ad\n            d[x]+=ad;add(x,ad);\n            d[y+1]-=ad,add(y+1,-ad);\n        }\n        else if(t1==2){\n            scanf(\"%d\",&x);\n            printf(\"%d\\n\",getsum(x));\u6c42d\u6570\u7ec4\u524dx\u9879\u548c\uff0c\u5373\u6c42a\u6570\u7ec4x\u70b9\u503c\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1504399912,
        "uid": 43195,
        "name": "jiezi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "\u8d77\u521d\u8fd9\u4e9b\u9898\u89e3\u6211\u6839\u672c\u770b\u4e0d\u61c2\uff0c\u540e\u9762\u6211\u604d\u60da\u95f4\u660e\u767d\u4e86\u4ec0\u4e48\uff0c\u4e8e\u662f\u6211\u6b22\u5929\u559c\u5730\u6765\u505a\u5206\u4eab\u3002\n\n\n\u4e00\u5f00\u59cb\u6211\u4e0d\u660e\u767d\n\n```cpp\nfor(int i=1;i<=n;i++)\n    {\n        scanf(\"%d\",&a[i]);\n          change(i,a[i]-a[i-1]);\u8fd9\u4e00\u6b65\u662f\u4ec0\u4e48\u9b3c\n    }\n```\n\u540e\u6765\u7ed3\u5408\nprintf(\"%d\\n\",getsum(x));\u8fd9\u4e2a\n\n\u6211\u660e\u767d\u4e86\u3002\n\n\u8fd9\u5c31\u662f\u4e2a\u6570\u5b66\u6570\u5217\u4e2d\u7531\u9012\u63a8\u516c\u5f0f\u6c42\u901a\u9879\u516c\u5f0f\u7684\u57fa\u672c\u65b9\u6cd5\n\n- - - - - - \u7d2f\u52a0\u6cd5\uff01\uff01\uff01\n\na[n]=(a[n]-a[n-1])+(a[n-1]-a[n-2])~~~~+(a[1]-a[0])+a[0]\n\n\u5728\u5168\u5c40\u53d8\u91cf\u79cda\u3010\u3011\u9ed8\u8ba4\u4e3a0\uff1b\u6545\u53ef\u5ffd\u7565\n\n\u5176\u4ed6\u67e5\u5206\u601d\u60f3\u4ec0\u4e48\u697c\u4e0b\u5927\u4f6c\u8bf4\u7684\u5f88\u6e05\u695a\n\n\u6211\u89c9\u5f97\u8fd9\u4f4d\u8bb2\u5f97\u5f88\u6e05\u695a\n\n\nkanate\\_saikou\n\n\n\u5c31\u5728\u9065\u8fdc\u7684\u697c\u4e0b\n\n\u4ed6\u4ee3\u7801\u4e5f\u5f88\u6f02\u4eae\uff0c\u6211\u5c31\u4e0d\u8bb2\u4e5f\u4e0d\u8d34\u4e86\n",
        "postTime": 1503913830,
        "uid": 34259,
        "name": "GadTD",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "\u8fd9\u4e00\u9898\u7684\u6811\u72b6\u6570\u7ec4\u62d3\u5c55\u663e\u5f97\u7b80\u5355\u3002\n\n\u5982\u679c\u662f\u533a\u95f4\u4fee\u6539\u548c\u533a\u95f4\u67e5\u8be2\u8be5\u600e\u4e48\u529e\uff1f\n\n\u8be6\u89c1\u6211\u7684\u535a\u5ba2\uff1a<http://blog.csdn.net/no1\\_terminator/article/details/51713474>\n\n\n\u8fd9\u91cc\u5c31\u662f\u4e00\u4e2a\u5077\u6362\u6982\u5ff5\uff0c\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u4e00\u4e2a\u8457\u540d\u7684\u7b49\u5f0f\n\n\u533a\u95f4\u4fee\u6539+\u70b9\u67e5\u8be2+imos=\u524d\u7f00\u548c+\u533a\u95f4\u67e5\u8be2+\u70b9\u4fee\u6539\n\n\nimos\u662f\u5565\uff1f\u53ef\u89c1\u6211\u7684\u535a\u5ba2\u3002\n\n\n\u4e0a\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<iostream>\nusing namespace std;\nint n,m;\nint a[500010],b[500010];\nvoid add(int i,int x){\n    while (i<=n){\n        b[i]+=x;\n        i+=i&(-i);\n    }\n}\nint query(int i){\n    int sum=0;\n    while (i>0){\n        sum+=b[i];\n        i-=i&(-i);\n    }\n    return sum;\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    for (int i=1;i<=n;i++){\n        int x;\n        scanf(\"%d\",&x);\n        a[i]=x;\n    }\n    for (int i=1;i<=m;i++){\n        int opt,x,y;\n        scanf(\"%d%d\",&opt,&x);\n        if (opt==1){\n            int k;\n            scanf(\"%d%d\",&y,&k);\n            add(x,k);\n            add(y+1,-k);\n        }else{\n            printf(\"%d\\n\",a[x]+query(x));\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1502155813,
        "uid": 48966,
        "name": "707001933K",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "1.\u5bf9\u4e8e\u533a\u95f4\u4fee\u6539\uff1a\n\n\u76f4\u63a5\u4fee\u6539\u6570\u7ec4c[]\uff0c\u5373\u8fdb\u884cn\u6b21add\uff0c\u80af\u5b9a\u4f1aTLE\uff1b\n\n\u4e8e\u662f\u5728\u6b64\u5f15\u5165\u4e00\u4e2a\u65b0\u6570\u7ec4\uff1aaddv[]\uff0caddv[i]\u6307\u7684\u662f\u4ee5\u7ed3\u70b9i\u4e3a\u6839\u7684\u6811\u7684\u6240\u6709\u5143\u7d20\u52a0\u4e0aaddv[i]\u3002\n\n\u8bbe\u5c06\u533a\u95f4[a,b]\u4e2d\u6bcf\u4e2a\u6570\u52a0\u4e0ax\uff0c\n\n\u5219\u53ea\u9700\u81eab\u5411\u5de6\uff0c\u5c06\u76f8\u5e94\u7684addv[]\u52a0\u4e0ax\uff0c\u518d\u81eaa-1\u5411\u5de6\uff0c\u5c06\u591a\u4fee\u6539\u7684\u7ed3\u70b9\u7684addv[]\u51cf\u53bbx\u5373\u53ef\u3002\n\n2.\u5bf9\u4e8e\u5355\u70b9\u67e5\u8be2\uff1a\n\n\u8bbe\u67e5\u8be2\u7ed3\u70b9i\uff0c\u5219\u5176\u539f\u503c\u4e3a\uff1a\n\n\uff08\u4ee5\u7ed3\u70b9i\u4e3a\u6839\u7684\u6811\u7684\u6240\u6709\u5143\u7d20\u7684\u548c\uff09-\uff08\u6b64\u6811\u4e2d\u9664\u7ed3\u70b9i\u4e4b\u5916\u7684\u6240\u6709\u8282\u70b9\u7684\u548c\uff09\uff1b\n\n\u7136\u540e\u4ece\u7ed3\u70b9i\u5411\u6811\u6839\u904d\u5386\uff0c\u5c06\u904d\u5386\u5230\u7684\u8282\u70b9\u7684addv[]\u503c\u52a0\u7ed9\u4e4b\u524d\u5df2\u8ba1\u7b97\u51fa\u7684\u7ed3\u70b9i\u7684\u539f\u503c\uff0c\u6700\u7ec8\u7ed3\u679c\u5c31\u662f\u7ed3\u70b9i\u73b0\u5728\u7684\u503c\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n\n\n\n\n\n\n\n\n    \n\n\n    \n    \n        \n\n        \n    \n    \n```cpp\n#include<cstdio>\n#include<iostream>\n#include<cstring>\n//#include<cmath>\n#include<ctime>\n#include<cstdlib>\n#include<algorithm>\n#include<string>\n#include<stack>\n#include<queue>\n#include<vector>\nusing namespace std;\nvoid add(int,int);\nvoid update(int,int,int);\nint query(int);\nint c[500010];\nint addv[500010];\nint n,m;\nint i,t;\nint f;\nint x,y,k;\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    for(i=1;i<=n;i++){\n        scanf(\"%d\",&t);\n        add(i,t);\n    }\n    for(i=1;i<=m;i++){\n        scanf(\"%d\",&f);\n        if(f==1){\n            scanf(\"%d%d%d\",&x,&y,&k);\n            update(x,y,k);\n        }\n        else{\n            scanf(\"%d\",&x);\n            printf(\"%d\\n\",query(x));\n        }\n    }\n    return 0;\n}\nvoid add(int p,int x){\n    while(p<=n){\n        c[p]+=x;\n        p+=p&-p;\n    }\n}\nvoid update(int a,int b,int x){\n    while(b>=a){     //\u533a\u95f4\u52a0\n        addv[b]+=x;\n        b-=b&-b;\n    }\n    a--;\n    while(a>b){     //\u533a\u95f4\u51cf\n        addv[a]-=x;\n        a-=a&-a;\n    }\n}\nint query(int p){\n    int p1=p-(p&-p);\n    int p2=p-1;\n    int t=c[p];\n    while(p2>p1){\n        t-=c[p2];\n        p2-=p2&-p2;\n    }         //\u8ba1\u7b97\u7ed3\u70b9\u539f\u503c\n    while(p<=n){\n        t+=addv[p];\n        p+=p&-p;\n    }     //\u8ffd\u52a0addv[]\n    return t;\n}\n```",
        "postTime": 1494768772,
        "uid": 22630,
        "name": "Running_Coder",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "\u8fd9\u6a21\u677f\u9898\u540d\u5b57\u5c31\u662f\u6811\u72b6\u6570\u7ec4..\u5e72\u561b\u7528\u7ebf\u6bb5\u6811..\u4ee3\u7801\u8fd8\u8d3c\u957f..\n\n\u8fd9\u91cc\u4ecb\u7ecd\u6811\u72b6\u6570\u7ec4+\u5dee\u5206\u601d\u60f3\uff0c\u7b97\u662f\u5bf9\u4e0b\u9762\u5927\u795e\u7684\u8865\u5145\u5427\u3002\n\n###\u4f55\u4e3a\u5dee\u5206\n\n\u73b0\u5728\u6211\u4eec\u6709\u4e00\u4e2a\u4ece\u5c0f\u5230\u5927\u7684\u6570\u5217a[]\n\n- a 1 3 6 8 9\n\n\u7136\u540e\u8fd8\u6709\u4e00\u4e2a\u5dee\u5206\u6570\u7ec4b[]\n\n- b 1 2 3 2 1\n\n\u76f8\u4fe1\u67d0\u4e9b\u5c0f\u4f19\u4f34\u5df2\u7ecf\u770b\u51fa\u7aef\u502a\u4e86..\u8fd9\u91cc**b[i]=a[i]-a[i-1]**\uff0c\u6211\u4ee4a[0]=0\uff0c\u6545b[1]=a[1]\u3002\n\n\u62e5\u6709\u4e86b\u6570\u7ec4\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f88\u7b80\u5355\u7684\u6c42\u51fabit[]\u4e2d\u4efb\u610f\u4e00\u4e2a\u6570\uff0c\u53ea\u9700**bit[i]=sigma(k=1 to i) b[k]**\uff08\u8fd9\u4e2a\u5f88\u597d\u63a8\u5427..\uff09\n\n\u6211\u89c9\u5f97\u73b0\u5728\u8be5\u6709\u4eba\u8bf4\u6211zz\u4e86..\u4f55\u5fc5\u4e0d\u76f4\u63a5\u67e5\u8be2a[i]\u800c\u662f\u627e\u8fd9\u4e48\u9ebb\u70e6\u4e00\u4e2a\u65b9\u6cd5..\u8fd9\u91cc\u6211\u4eec\u8f6c\u56de\u6b63\u9898\uff01\u522b\u5fd8\u4e86\uff0c\u9898\u76ee\u8981\u6211\u4eec\u8fdb\u884c\u533a\u95f4\u4fee\u6539..\n\n\u6211\u4eec\u77e5\u9053\uff0c\u6811\u72b6\u6570\u7ec4\u5bf9\u4e8e\u5355\u70b9\u503c\u7684\u4fee\u6539\u5341\u5206\u65b9\u4fbf\uff08\u4e0d\u61c2\u7684\u53bb\u770b\u6811\u72b6\u6570\u7ec41\uff09\uff0c\u5bf9\u4e8e\u533a\u95f4\u7684\u4fee\u6539\u5c31\u6bd4\u8f83\u5c34\u5c2c..\u800c\u6211\u4eec\u53c8\u4e0d\u60f3\u6572\u6b7b\u957f\u7684\u7ebf\u6bb5\u6811..\u600e\u4e48\u529e\u5462\uff0c\u8fd9\u65f6\u5019\u5dee\u5206\u5c31\u663e\u51fa\u4f18\u52bf\n\n\u8fd8\u662f\u4e0a\u9762\u7684a[]\u548cb[]\uff0c\u73b0\u5728\u6211\u4eec\u4f7f\u533a\u95f4[2,4]\u7684\u6240\u6709\u6570\u5747+2\uff0c\u5219a[]/b[]\u53d8\u4e3a\n\n- a 1 5 8 10 9\n\n- b 1 4 3 2 -1\n\n\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u91cc\u53ea\u6709b[2]\u548cb[5]\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u56e0\u4e3a\u533a\u95f4\u5185\u5143\u7d20\u5747\u589e\u52a0\u4e86\u540c\u4e00\u4e2a\u503c\uff0c\u6240\u4ee5b[3]\uff0cb[4]\u662f\u4e0d\u4f1a\u53d8\u5316\u7684\u3002\n\n\u8fd9\u91cc\u6211\u4eec\u5c31\u6709\u4e86\u7b2c\u4e8c\u4e2a\u5f0f\u5b50\uff1a\u5bf9\u4e8e\u533a\u95f4[x,y]\u7684\u4fee\u6539\uff08\u589e\u52a0\u503c\u4e3ad\uff09\u5728b\u6570\u7ec4\u5185\u5f15\u8d77\u53d8\u5316\u7684\u53ea\u6709 **b[x]+=d\uff0cb[y+1]-=d**\u3002\uff08\u8fd9\u4e2a\u4e5f\u5f88\u597d\u63a8\u7684..\uff09\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u628a\u6811\u72b6\u6570\u7ec4\u7684\u8f6f\u808b\u7528\u5dee\u5206\u89e3\u51b3\u4e86\u3002\n\n\u9644\u4ee3\u7801\n\n```cpp\n#include<iostream>\nusing namespace std;\n\nint n,m,a[1000000],t[1000000];\n\nint lowbit(int x) {\n    return x&(-x);\n}\n\nvoid add(int x,int d) {\n    while(x<=n) {\n        t[x]+=d;\n        x+=lowbit(x);\n    }\n}\n\nint sum(int x) {\n    int ans=0;\n    while(x) {\n        ans+=t[x];\n        x-=lowbit(x);\n    }\n    return ans;\n}\n\nint main() {\n    cin>>n>>m;\n    for(int i=1;i<=n;i++) {\n        cin>>a[i];\n        add(i,a[i]-a[i-1]);   //\u76f4\u63a5\u5c06\u6811\u72b6\u6570\u7ec4\u5b58\u4e3a\u5dee\u5206\u540e\u6570\u5217 #**b[i]=a[i]-a[i-1]**#\n    }\n    for(int p=1,op,x,y,k;p<=m;p++) {\n        cin>>op;\n        if(op==1) {\n            cin>>x>>y>>k;\n            add(x,k); add(y+1,-k);   // #**b[x]+=d\uff0cb[y+1]-=d**#\n        }\n        if(op==2) {\n            cin>>x;\n            int ans=sum(x);   //#**bit[i]=sigma(k=1 to i) b[k]**#\n            cout<<ans<<endl;\n        }\n    }\n}\n```",
        "postTime": 1485052699,
        "uid": 31031,
        "name": "kanate_saikou",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "\u5176\u5b9e\u5f88\u591a\u5173\u4e8e\u6811\u72b6\u6570\u7ec4\u7684\u6559\u7a0b\u91cc\u90fd\u8bf4\u7684\u662f[\u6811\u72b6\u6570\u7ec41](/problem/show?pid=3374)\u3002\n\n\u4f46\u662f\u5bf9\u4e8e\u8fd9\u9898\u8fd8\u662f\u53ef\u4ee5\u8f6c\u5316\u7684\u3002\n\n\u5728\u6811\u72b6\u6570\u7ec41\u4e2d\uff0c\u5927\u5bb6\u5e94\u8be5\u6709\u8fd9\u4e48\u4e00\u4e2a\u8fc7\u7a0b\uff1a\n\n```c\nvoid add(long long x,long long d)//\u628aa[x]\u52a0\u4e0ad\n{\n    if (x==0) return;\n    while (x<=n) {\n        c[x]+=d;\n        x+=lowbit(x);\n    }\n}\n```\n\n\u7136\u540e\u5728\u4e3b\u7a0b\u5e8f\u91cc\u5199\n\n```c\nscanf(\"%d\",&t);\nif (t==1) {\n  scanf(\"%d%d%d\",&x,&y,&k);\n  add(x,k);\n}\n```\n\u8fd9\u6837\u7684add\u64cd\u4f5c\u5176\u5b9e\u628ax\u5230n\u7684\u7ed3\u70b9\u5168\u90e8\u52a0\u4e0a\u4e86k\uff0c\u6240\u4ee5\u518d\u6b21\u8c03\u7528\u4e00\u4e2aadd(y+1,-k)\u5c31\u53ef\u4ee5\u628a\u591a\u589e\u52a0\u7684\u7ed3\u70b9\u518d\u51cf\u56de\u53bb\u3002\n\n\u597d\u4e86\uff0c\u7b2c\u4e00\u4e2a\u64cd\u4f5c\u8f6c\u5316\u5b8c\u6bd5\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u64cd\u4f5c\u5c31\u66f4\u7b80\u5355\u4e86\uff0c\u76f4\u63a5scanf(\"%d\",&x); printf(\"%d\\n\",sum(x)); \u5c31\u53ef\u4ee5\u4e86\u3002\n\n//\u6b64\u4e3a\u7ed9\u697c\u4e0b\u7684\u9898\u89e3\u5b8c\u5584\u4e00\u4e9b\n",
        "postTime": 1475677011,
        "uid": 3116,
        "name": "\u98de\u7fd4",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "```cpp\n//\u5bf9\u4e8e30%\u7684\u6570\u636e\uff1aN<=8\uff0cM<=10\n//\u5bf9\u4e8e70%\u7684\u6570\u636e\uff1aN<=10000\uff0cM<=10000\n//\u5bf9\u4e8e100%\u7684\u6570\u636e\uff1aN<=500000\uff0cM<=500000\n//n\u4e2a\u70b9\uff0cm\u6b21\u64cd\u4f5c \n//\u6811\u72b6\u6570\u7ec4\u53d8\u5f62 \n//\u601d\u8def\uff1ac[x]\u5b58\u6811\u72b6\u6570\u7ec4\uff0c\u5047\u8bbea[i]\u4e3a\u6bcf\u4e2a\u6570\u7684\u503c\uff08\u9898\u76ee\u4e2d\u672a\u51fa\u73b0\uff0c\u6b64\u5904\u4fbf\u4e8e\u7406\u89e3\uff09\n//a[x]=sum(c[i])(i1=x,i2=i1-lowbit(i1),i3=i2-lowbit(i2),...)\n//\u7b80\u5355\u6765\u8bf4\uff0c\u539f\u672c\u6811\u72b6\u6570\u7ec4\u7ba1\u5236\u7684\u533a\u95f4\u4e0d\u518d\u662f\u548c\uff0c\u800c\u662fa[i]\u7684\u79bb\u6563 \n#include<cstdio>\n#include<iostream>\n#include<cstdlib>\n#include<algorithm>\n#define maxn 500000\n//#define lb(x) (x&(-x))//\u597d\u50cf\u8fd9\u91cc\u53ef\u4ee5\uff0c\u4fdd\u9669\u8d77\u89c1\u8fd8\u662f\u5199\u51fd\u6570\u5427 \nusing namespace std;\n//////////////////////////\nint n,m;\nint c[maxn];\n//////////////////////////\nint lb(int x)\n{\n    return (x&(-x));\n}\nvoid add(int x,int num)\n{\n    if(x==0)\n      return ;\n    int k=x;\n    while(k<=n)\n      {\n        c[k]+=num;\n        k+=lb(k);\n      }\n}\nint read(int x)\n{\n    int sum=0,k=x;\n    while(k>=1)\n      {\n          sum+=c[k];\n          k-=lb(k);\n      }\n    return sum;\n}\n//////////////////////////\nint main()\n{\n    freopen(\"shu(2).in\",\"r\",stdin);\n    cin>>n>>m;\n    for(int i=1;i<=n;i++)\n      {\n          int num;\n          scanf(\"%d\",&num);\n          add(i,num);\n          add(i+1,-num);\n      }\n    for(int i=1;i<=m;i++)\n      {\n          int caozuo;\n          scanf(\"%d\",&caozuo);\n          if(caozuo==1)\n            {\n                int x,y,nnum;\n                scanf(\"%d %d %d\",&x,&y,&nnum);\n                add(x,nnum);\n                add(y+1,-nnum);//\u8fd9\u4e00\u6b65\u662f\u5173\u952e\uff0c\u4e0a\u4f20\u5230y\u5c31\u4e0d\u4e0a\u4f20\u4e86 \n              }\n        if(caozuo==2)\n          {\n              int a;\n              scanf(\"%d\",&a);\n              cout<<read(a)<<endl;//\u5355\u70b9\u6c42\u503c\u53d8\u4e3a\u6811\u72b6\u6570\u7ec4\u6c42sum \n          }\n      }\n}\n```",
        "postTime": 1475159721,
        "uid": 14941,
        "name": "\u65f6\u5149_Memory",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "## \u3010\u601d\u8def\u3011\n\u6811\u72b6\u6570\u7ec4   \n\n### \u3010\u9898\u76ee\u5927\u610f\u3011 \n\u533a\u95f4\u4fee\u6539\u548c\u5355\u70b9\u67e5\u8be2    \n\n### \u3010\u9898\u76ee\u5206\u6790\u3011\n~~\u660e\u663e\u5c31\u662f\u8981\u7528\u7ebf\u6bb5\u6811\u7684\u597d\u5427~~    \n\u4f46\u662f\u65e2\u7136\u662f\u6811\u72b6\u6570\u7ec4\u7684\u6a21\u677f\u8fd8\u662f\u8981\u7ed9\u4ed6\u4e2a\u9762\u5b50\u7684   \n\u6240\u4ee5\u8fd8\u5f97\u7528\u6811\u72b6\u6570\u7ec4\u5199    \n\u533a\u95f4\u4fee\u6539\u548c\u5355\u70b9\u67e5\u8be2   \n\u7b2c\u4e00\u77ac\u95f4\u60f3\u5230\u7684\u65f6\u5019\u66b4\u529b\u679a\u4e3e\u6bcf\u4e00\u4e2a\u533a\u95f4\u5185\u7684\u70b9\u4fee\u6539   \n\u7136\u540e\u6c42x\u4f4d\u7f6e\u7684\u65f6\u5019\u7528sum(x) - sum(x - 1)\u5c31\u884c\u4e86    \n\u6ca1\u6709\u95ee\u9898    \n\u4f46\u662f\u8fd9\u6837\u771f\u7684\u4f18\u7f8e\u5417\uff1f    \n \n### \u3010\u6838\u5fc3\u601d\u8def\u3011\n\u60f3\u8981\u5feb\u901f\u4fee\u6539\u4e00\u4e2a\u533a\u95f4\u7684\u503c   \n\u9664\u4e86\u7ebf\u6bb5\u6811\u8fd8\u6709\u4ec0\u4e48\u5462\uff1f     \n\u5f53\u7136\u662f\u5dee\u5206\u4e86\uff01     \n\u5dee\u5206\u4e4b\u540e\u4e0d\u4ec5\u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4\u8f7b\u677e\u4fee\u6539\u4e00\u4e2a\u533a\u95f4\u5185\u7684\u503c    \n\u800c\u4e14\u6c42\u67d0\u4e2a\u70b9\u7684\u503c\u5f97\u65f6\u5019    \n\u4e5f\u4e0d\u9700\u8981\u505a\u5dee    \n\u56e0\u4e3a\u5728\u5dee\u5206\u6570\u7ec4\u4e2d1-i\u7684\u503c\u52a0\u8d77\u6765\u5c31\u662fi\u539f\u672c\u7684\u503c    \n\u800c\u4e14sum(x)\u53c8\u662f\u6c42\u5f971 - x\u7684\u503c      \n\u6240\u4ee5\u5f88\u597d\u7684\u53ef\u4ee5\u5e94\u7528\u4e0a\u53bb     \n## \u3010\u601d\u8def\u3011\n```cpp\n#include<iostream>\n#include<cstdio>\n#define int long long\n\nusing namespace std;\nconst int Max = 500005;\nint a[Max];\nint n,m;\nint read()\n{\n\tint sum = 0,fg = 1;\n\tchar c = getchar();\n\twhile(c < '0' || c > '9')\n\t{\n\t\tif(c == '-')fg = -1;\n\t\tc = getchar();\n\t}\n\twhile(c >= '0' && c <= '9')\n\t{\n\t\tsum = sum * 10 + c - '0';\n\t\tc = getchar();\n\t}\n\treturn sum * fg;\n}\n\nint lowbit(int x)\n{\n\treturn x & -x;\n}\n\nvoid add(int x,int y)\n{\n\twhile(x <= n)\n\t{\n\t\ta[x] += y;\n\t\tx += lowbit(x);\n\t}\n}\n\nint sum(int x)\n{\n\tint ans = 0;\n\twhile(x > 0)\n\t{\n\t\tans += a[x];\n\t\tx -= lowbit(x);\n\t}\n\treturn ans;\n}\n\nsigned main()\n{\n\tn = read(),m = read();\n\tint last = 0;\n\tfor(register int i = 1;i <= n;++ i)\n\t{\n\t\tint qwq = read();\n\t\tadd(i,qwq - last);\n\t\tlast = qwq;\n\t}\n\tfor(register int i = 1;i <= m;++ i)\n\t{\n\t\tint qwq = read();\n\t\tif(qwq == 1)\n\t\t{\n\t\t\tint x = read(),y = read(),z = read();\n\t\t\tadd(x,z);\n\t\t\tadd(y + 1,-z);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint x = read();\n\t\t\tcout << sum(x) << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1573564934,
        "uid": 186489,
        "name": "EarthGiao",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    },
    {
        "content": "**70 \u5206\u505a\u6cd5**\n\n\u8fd9\u9053\u9898\u5355\u7eaf\u7528\u7c7b\u4f3c\u5dee\u5206\u7684\u505a\u6cd5\u4f1aTle 3 \u4e2a\u70b9\n\n\u5177\u4f53\u7684\u601d\u8def\u662f\u58f0\u660e\u4e00\u4e2a\u6570\u7ec4c\uff0c\u82e5\u8981\u5728l-r\u4e4b\u95f4\u589e\u52a0k,\u5c31c[l]+=k,c[l]-=k\u3002\n\n\u6bcf\u6b21\u8981\u6c42x\u7684\u503c\u5c31\u7528x\u8fd9\u4e2a\u4f4d\u7f6e\u539f\u6765\u7684\u503c\u52a0\u4e0ac[1]\uff0cc[2]....c[x]\n\n\u4f46\u663e\u7136\u8fd9\u6837\u8981\u8d85\u65f6\n\n**70\u5206\u4ee3\u7801**\n\n\n\n\n\n\n        \n      \n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ninline int read()\n{\n    int f=1,x=0;\n    char ch;\n    do{\n      ch=getchar();\n      if(ch=='-')\n         f=-1;\n    }while(ch<'0'||ch>'9');\n    do{\n       x=x*10+ch-'0';\n       ch=getchar();\n    }while(ch>='0'&&ch<='9');\n    return f*x;\n}\nconst int MN=500005;\nint n,m;\nint a[MN],c[MN]={0};\nint x,l,r,k,y;\ninline int  sums(int x)\n{\n    int s=0;\n    for (int i=1;i<=x;i++)\n        s += c[i];\n    return s;\n}\nint main()\n{\n    n= read();m=read();\n    for (int i=1;i<=n;i++)\n      a[i]=read();\n    for (int i=1;i<=m;i++)\n    {\n        x= read();\n        if (x==1)\n        {\n            l= read();\n            r = read();\n            k = read();\n            c[l]+= k;\n            c[r+1] -= k;\n        }\n        if (x==2)\n        {\n            y =read();\n            cout<<a[y]+sums(y)<<endl;\n        }\n    }\n    return 0;\n}\n```\n**100\u5206\u505a\u6cd5**\n\u6811\u72b6\u6570\u7ec4+\u5dee\u5206\u7684\u505a\u6cd5\uff0c\u4e0b\u9762\u7684dalao\u5df2\u7ecf\u8bb2\u7684\u5f88\u660e\u767d\u4e86\n\n\u4e3b\u8981\u7684\u601d\u8def\u5c31\u662f\u7528\u6811\u72b6\u6570\u7ec4\u6765\u7ef4\u62a4\uff08\u8fd9\u4e2a\u505a\u6cd5\u662f\u849f\u84bb\u6211\u770b\u4e86\u9898\u89e3\u5199\u7684\uff09\n\n\u4e3b\u8981\u5c31\u662f\u7528c\u6570\u7ec4\u7684\u7b2ci\u9879\u8868\u793a\u7b2ci\u4e2a\u6570\n\n\u5982\u679c\u662f\u533a\u95f4\u4fee\u6539\u8981\u4f9d\u8d56\u5dee\u5206\uff0c\u5982\u679c\u641e\u61c2\u4e86\u6811\u72b6\u6570\u7ec4\u7684\u57fa\u672c\u539f\u7406\u8fd9\u4e2a\u5dee\u5206\u5f88\u5bb9\u6613\u7406\u89e3\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ninline int read()\n{\n    int f=1,x=0;\n    char ch;\n    do{\n      ch=getchar();\n      if(ch=='-')\n         f=-1;\n    }while(ch<'0'||ch>'9');\n    do{\n       x=x*10+ch-'0';\n       ch=getchar();\n    }while(ch>='0'&&ch<='9');\n    return f*x;\n}\nint c[1000001];\nint lb(int x){return x&-x;};\nint n,m; \nint a1[1000001];\nint s;\nint a2,b1,k;\nvoid change(int a,int b)\n{\n    if(a)\n    { \n    while(a<=n)\n    {\n        c[a]+=b;\n        a+=lb(a);\n    }\n    }\n}\nint g_sum(int x)\n{\n    int re=0;\n    while(x>=1)\n    {\n        re+=c[x];\n        x-=lb(x);\n    }\n    return re;\n}\nint main()\n{\n    n=read();\n    m=read();\n    for(int i=1;i<=n;i++)\n    { \n           a1[i]=read();\n        change(i,a1[i]-a1[i-1]); \n    } \n    for(int i=1;i<=m;i++)\n    {\n        s=read();\n        if(s==1)\n        {\n            a2=read();\n            b1=read();\n            k=read();\n            change(a2,k);\n            change(b1+1,-1*k);\n        }\n        if(s==2)\n        {\n            a2=read();\n            cout<<g_sum(a2)<<endl;\n        }\n    } \n}\n```",
        "postTime": 1507294916,
        "uid": 37408,
        "name": "Randyhoads",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3368 \u3010\u3010\u6a21\u677f\u3011\u6811\u72b6\u6570\u7ec4 2\u3011"
    }
]
[
    {
        "content": "\u53cd\u6f14\u795e\u9898\u2026\u2026\n\n\u9996\u5148\u4f60\u5f97\u770b\u51fa\u6765\u8fd9\u9053\u9898\u662f\u4e00\u4e2a\u53cd\u6f14\u9898\n\n\u5982\u679c\u4f60\u8fd9\u9053\u9898\u536194\u4e86\u68c0\u67e5\u4e00\u4e0b\u4f60\u7684Miller-Rabin\u6709\u6ca1\u6709\u5728\u5224\u5b9a\u5927\u8d28\u6570\u7684\u65f6\u5019\u8fd4\u56de\u5947\u5947\u602a\u602a\u7684\u503c\u2026\u2026\n_______________\n\n## \u672c\u9898\u9898\u89e3\n\n\u9898\u76ee\u7684\u8981\u6c42\u662f\u6c42\u4e0b\u5217\u7b26\u5408\u6761\u4ef6\u7684\u5b57\u7b26\u4e32\u4e2a\u6570(\u957f\u5ea6\u4e3an,\u5b57\u7b26\u96c6\u5927\u5c0f\u4e3ak)\n\n## \u8fd9\u4e2a\u4e32\u7684\u4e00\u4e2a\u8f6e\u6362\u662f\u4e00\u4e2a\u56de\u6587\u4e32\n\n\u4e24\u4e2a\u5b57\u7b26\u4e32\u4e0d\u540c\u5f53\u4e14\u4ec5\u5f53\u8fd9\u4e2a\u5b57\u7b26\u4e32\u4e2d\u6709\u4e00\u4e2a\u4f4d\u7f6e\u7684\u5b57\u7b26\u4e0d\u540c\n\n\u7136\u540e\u6b64\u65f6\u6211\u4eec\u770b\u4e86\u4e00\u6837\u6570\u636e\u8303\u56f4$n<=10^{18}$\u975e\u5e38\u9b54\u5e7b\n\n\u8fd9\u5df2\u7ecf\u4e0d\u662fdp\u53ef\u4ee5\u89e3\u51b3\u7684\u95ee\u9898\u4e86\uff0c\u6240\u4ee5\u8ba9\u6211\u4eec\u6765\u8003\u8651\u4e00\u4e0b\u5982\u4f55\u5217\u5f0f\u5b50\n\n### \u627e\u89c4\u5f8b\n\n\u9996\u5148\u6211\u4eec\u60f3\u4e00\u4e2a\u975e\u5e38trival\u7684\u95ee\u9898\uff0c\u957f\u5ea6\u4e3an\u5b57\u7b26\u96c6\u5927\u5c0f\u4e3ak\u7684\u5b57\u7b26\u4e32\u96c6\u91cc\u6709\u591a\u5c11\u4e2a\u56de\u6587\u4e32\uff1f\u663e\u7136\u662f\n\n## $k^{\\lfloor\\frac{n+1}{2}\\rfloor}$\n\n\u4f46\u662f\u6211\u4eec\u7684\u76f4\u89c9\u544a\u8bc9\u6211\u4eec\u7b54\u6848\u663e\u7136\u4e0d\u662f\n\n## $nk^{\\lfloor\\frac{n+1}{2}\\rfloor}$\n\n\u6bd4\u5982\u50cfaaaaaa\u2026\u2026\u8fd9\u79cd\u4e32\u7684\u6240\u6709\u8f6e\u6362\u90fd\u662f\u540c\u4e00\u4e2a\u4e32\uff0c\u7136\u540e\u663e\u7136\u662f\u4e0d\u53ef\u4ee5\u7b97n\u904d\u7684\n\n\u90a3\u4e48\u6211\u4eec\u8bf4\u6211\u4eec\u5228\u6389\u8fd9\u79cd\u60c5\u51b5\u4e0d\u5c31\u597d\u54af\uff0c\u7136\u540e\u6211\u4eec\u53d1\u73b0\u6709\u8fd9\u6837\u7684\u53cd\u4f8b\n\nabc abc abc abc abc abc\n\n\u8f6e\u63623\u6b21\u4e4b\u540e\u9677\u5165\u4e86\u5faa\u73af\u8fd8\u662f\u4e0d\u80fd\u7b97n\u904d\n\n\u90a3\u4e48\u6211\u4eec\u8003\u8651\u4e00\u4ef6\u4e8b\u60c5\uff0c\u4e00\u4e2a\u4e32\u5230\u5e95\u6709\u591a\u5c11\u4e2a\u4e92\u4e0d\u76f8\u540c\u7684\u8f6e\u6362\uff1f\n\n\u53d1\u73b0\u521a\u597d\u7b49\u4e8e\u5b83\u7684\u6700\u5c0f\u5faa\u73af\u8282\u957f\u5ea6(\u8fd9\u91cc\u8981\u6c42\u7684\u6700\u5c0f\u5faa\u73af\u8282\u662f\u4e0d\u5141\u8bb8\u91cd\u53e0\u7684\uff0c\u6362\u53e5\u8bdd\u8bf4\u6700\u5c0f\u5faa\u73af\u8282\u5fc5\u987b\u662f\u8fd9\u4e2a\u4e32\u7684\u7ea6\u6570)\n\n\u90a3\u4e48\u6211\u4eec\u662f\u4e0d\u662f\u53ef\u4ee5\u679a\u4e3e\u6bcf\u4e00\u4e2a\u56de\u6587\u4e32\u7684\u6700\u5c0f\u5faa\u73af\u8282\u957f\u5ea6d\uff0c\u7136\u540e\u6bcf\u4e2a\u56de\u6587\u4e32\u5bf9\u7b54\u6848\u4ea7\u751fd\u7684\u8d21\u732e\u5462\uff1f\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u4f1a\u6709\u8fd9\u6837\u7684\u53cd\u4f8b\n\nabcd abcd abcd abcd\n\n\u8f6e\u6362\u4e24\u6b21\u4e4b\u540e\u53d8\u6210\u4e86\n\ncd abcd abcd abcd ab\n\n\u6211\u4eec\u60ca\u8bb6\u7684\u53d1\u73b0\u8fd9\u4e2a\u4e32\u4e5f\u662f\u4e00\u4e2a\u56de\u6587\u4e32\uff0c\u6362\u53e5\u8bdd\u8bf4\"abcdabcdabcdabcd\"\u548c\"cdabcdabcdabcdab\"\u8fd9\u4e24\u4e2a\u4e32\u5171\u540c\u4ea7\u751f\u4e864\u7684\u8d21\u732e\uff0c\u56e0\u6b64\u6bcf\u4e2a\u4e32\u5e73\u644a\u4e0b\u6765\u4ec5\u4ec5\u4ea7\u751f\u4e862\u7684\u8d21\u732e\n\n\u8fdb\u4e00\u6b65\u601d\u8003\uff0c\u5982\u679c\u6700\u5c0f\u5faa\u73af\u8282\u957f\u5ea6d\u4e3a\u5076\u6570\u7684\u8bdd\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u5728\u5b83\u7684d\u79cd\u4e0d\u540c\u7684\u8f6e\u6362\u5b57\u7b26\u4e32\u5f53\u4e2d\u6070\u597d\u6709\u4e24\u4e2a\u6216\u8005\u96f6\u4e2a\u56de\u6587\u4e32\uff0c\u56e0\u6b64\u6211\u4eec\u679a\u4e3e\u7684\u56de\u6587\u4e32\u6700\u5c0f\u5faa\u73af\u8282\u957f\u5ea6d\u5982\u679c\u662f\u5076\u6570\u7684\u8bdd\u4ec5\u4ec5\u4f1a\u4ea7\u751f$d/2$\u7684\u8d21\u732e\uff0c\u56e0\u4e3a\u53e6\u4e00\u534a\u88ab\u548c\u5b83\"\u914d\u5bf9\"\u7684\u56de\u6587\u4e32\u644a\u6389\u4e86\n\n\u7136\u540e\u8ba9\u6211\u4eec\u6765\u60f3\u4e00\u4e0bd\u4e3a\u5947\u6570\u7684\u65f6\u5019\u4f1a\u51fa\u73b0\u4ec0\u4e48\uff0c\u4e07\u5e78\u7684\u662f\u5728\u5b83\u7684d\u79cd\u4e0d\u540c\u7684\u8f6e\u6362\u5b57\u7b26\u4e32\u4e2d\u6700\u591a\u6709\u4e00\u4e2a\u56de\u6587\u4e32\uff0c\u6240\u4ee5\u5982\u679cd\u4e3a\u5947\u6570\u90a3\u4e48\u521a\u597d\u4ea7\u751fd\u7684\u8d21\u732e\n\n\u90a3\u4e48\u6211\u4eec\u4f3c\u4e4e\u53ef\u4ee5\u7528\u4e00\u4e2a\u5206\u6bb5\u51fd\u6570h\u6765\u63cf\u8ff0\u6211\u4eec\u6700\u5c0f\u5faa\u73af\u8282\u957f\u5ea6\u4e3ad\u7684\u5b57\u7b26\u4e32\u5bf9\u7b54\u6848\u7684\u8d21\u732e\n\n## $h(d)=(dmod2)?d:d/2$\n\n\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u7ec8\u4e8e\u53ef\u4ee5\u6109\u5feb\u7684\u679a\u4e3e\u5faa\u73af\u8282\u957f\u5ea6d\u4e86\uff0c\u4ec0\u4e48\uff1f\u600e\u4e48\u6c42\u6700\u5c0f\u5faa\u73af\u8282\u957f\u5ea6\u4e3ad\u7684\u56de\u6587\u4e32\u6570\u91cf?\u522b\u6025\uff0c\u8ba9\u6211\u4eec\u8bbe\u6700\u5c0f\u5faa\u73af\u8282\u957f\u5ea6\u4e3ad\u7684\u56de\u6587\u4e32\u6570\u91cf\u4e3a$f(d)$\n\n\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u7ec8\u4e8e\u53ef\u4ee5\u5217\u51fa\u5f0f\u5b50\u6765\u4e86\n\n## $Ans=\\sum_{d|n}h(d)f(d)$\n\n\u95ee\u9898\u6765\u4e86\uff0c\u600e\u4e48\u6c42$f(d)$?\u4f60\u4e0d\u4f1a\u6c42\u6211\u4e5f\u4e0d\u4f1a\u6c42\u2026\u2026\n\n\u4f46\u662f\u4e07\u5e78\u7684\u662f\u8fd9\u91cc\u6709\u4e00\u4e2a\u6bd4\u8f83\u663e\u7136\u7684\u6052\u7b49\u5f0f($g(m)$\u4ee3\u8868\u957f\u5ea6\u4e3am\u7684\u56de\u6587\u4e32\u603b\u6570)\n\n## $g(m)=k^{\\lfloor\\frac{m+1}{2}\\rfloor}=\\sum_{d|m}f(d)$\n\n\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u679a\u4e3e\u4e86\u957f\u5ea6\u4e3am\u7684\u6240\u6709\u56de\u6587\u4e32\u7684\u6700\u5c0f\u5faa\u73af\u8282,\u7136\u540e\u628a\u6bcf\u79cd\u56de\u6587\u4e32\u7684\u6570\u91cf\u52a0\u5230\u4e86\u4e00\u8d77(\u663e\u7136\u4e24\u4e2a\u4e32\u6700\u5c0f\u5faa\u73af\u8282\u957f\u5ea6\u4e0d\u540c\u90a3\u4e48\u8fd9\u4e24\u4e2a\u4e32\u4e0d\u540c\uff0c\u56e0\u6b64\u6700\u5c0f\u5faa\u73af\u8282\u4e3ad\u7684\u56de\u6587\u4e32\u5c5e\u4e8e\u4e92\u65a5\u4e8b\u4ef6\uff0c\u7528\u52a0\u6cd5\u539f\u7406\u8fdb\u884c\u5408\u5e76)\u90a3\u4e48\u6211\u4eec\u5c31\u4f1a\u5f97\u5230\u957f\u5ea6\u4e3am\u7684\u6240\u6709\u56de\u6587\u4e32\u7684\u6570\u91cf\u4e86\n\n(\u4e0b\u9762\u5f00\u59cb\u53cd\u6f14\u4e86\uff0c\u5982\u679c\u8fd8\u5bf9\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u4e0d\u662f\u76f8\u5f53\u719f\u7ec3\u7684\u8bdd\u8fd8\u5148\u53bb\u5b66\u4e60\u4e0b\u53cd\u6f14\u518d\u6765\u770b\u8fd9\u9053\u9898\u5427)\n\n\u5982\u679c\u4f60\u5bf9\u72c4\u5229\u514b\u96f7\u5377\u79ef\u90a3\u4e00\u5957\u76f8\u5f53\u719f\u7ec3\u7684\u8bdd\u4f60\u4f1a\u7acb\u5373\u60f3\u5230\n\n## $g(m)=\\sum_{d|m}f(d)1(m/d)$\n\n\u5176\u4e2d$1()$\u662f\u5e38\u51fd\u6570,1(x)=1\uff0c\u5176\u4e2dx\u662f\u4efb\u610f\u503c\n\n\u4e5f\u5c31\u662f\u8bf4\n\n## $g=f\u00d71$\n\n\u90a3\u4e48\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u516c\u5f0f\u544a\u8bc9\u6211\u4eec\n\n## $g=f\u00d71 \\leftrightarrow f=g\u00d7\\mu$\n\n\u6362\u53e5\u8bdd\u8bf4\u6211\u4eec\u53ef\u4ee5\u63a8\u51fa\n\n## $f(m)=\\sum_{d|m}g(d)\\mu(m/d)$\n\n\u597d\u4e86\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u8ba1\u7b97f\u51fd\u6570\u7684\u503c\u4e86\uff0c\u90a3\u4e48\u6211\u4eec\u628a\u5b83\u4ee3\u5165\u539f\u6765\u7b54\u6848\u7684\u8868\u8fbe\u5f0f\u4f1a\u53d1\u751f\u4ec0\u4e48\u2026\u2026\n\n## $Ans=\\sum_{d|n}h(d)\\sum_{p|d}g(p)\\mu(d/p)$\n\n\u597d\u4e86\u4e0b\u9762\u662f\u795e\u5947\u7684\u4ea4\u6362$\\Sigma$\u7684\u73af\u8282\u4e86\uff01\n\n\u6211\u4eec\u4ee4$d/=p$,\u5219\u6709$d=dp$,\u56e0\u4e3a$d|n$\u6240\u4ee5$dp|n$\u6240\u4ee5$d|n/p$\n\n\u6211\u4eec\u63a5\u4e0b\u6765\u5c31\u5168\u90e8\u7528$dp$\u66ff\u6362\u539f\u6765\u5f0f\u5b50\u5f53\u4e2d\u7684d,\u5f97\u5230\u4e86\n\n## $Ans=\\sum_{p|n}g(p)\\sum_{d|\\frac{n}{p}}h(dp)\\mu(d)$\n\n\u90a3\u4e48\u6211\u4eec\u5230\u8fd9\u4e00\u6b65\u5176\u5b9e\u5df2\u7ecf\u4e0d\u53ef\u4ee5\u53cd\u6f14\u4e86\n\n\u6240\u4ee5\u8ba9\u6211\u4eec\u6765\u8003\u8651\u4e00\u4e0bh\u51fd\u6570\u7684\u6027\u8d28\uff0c\u6211\u4eec\u5c1d\u8bd5\u7740\u628a$h(dp)$\u4e2d\u7684$d$\u63d0\u51fa\u6765\n\n\u6362\u53e5\u8bdd\u8bf4\uff0c\u6211\u4eec\u8003\u8651\u8fd9\u4e2a\u5f0f\u5b50\u5728\u4ec0\u4e48\u6761\u4ef6\u4e0b\u6210\u7acb\n\n## $h(dp)=dh(p)$\n\n\u53d1\u73b0\u5f53\u4e14\u4ec5\u5f53d\u4e3a\u5076\u6570\u4e14p\u4e3a\u5947\u6570\u7684\u65f6\u5019\u8fd9\u4e2a\u5f0f\u5b50\u4e0d\u4f1a\u6210\u7acb\n\n\u4f46\u662f\u8ba9\u6211\u8003\u8651\u4e0b\u4ec0\u4e48\u65f6\u5019d\u4e3a\u5076\u6570\u4e14p\u4e3a\u5947\u6570\u5462\uff1f\n\nd\u5fc5\u987b\u662f$\\frac{n}{p}$\u7684\u7ea6\u6570\uff0c\u7136\u800c\u5982\u679c$\\frac{n}{p}$\u662f\u5947\u6570\u7684\u8bddd\u4e0d\u53ef\u80fd\u662f\u5076\u6570\n\n\u90a3\u4e48\u8fd9\u4e2a\u5f0f\u5b50\u552f\u4e00\u4e0d\u6210\u7acb\u7684\u60c5\u51b5\u5c31\u662fp\u4e3a\u5947\u6570\u4e14$\\frac{n}{p}$\u4e3a\u5076\u6570\u4e86\n\n\u90a3\u4e48\u6211\u4eec\u8003\u8651\u6b64\u65f6\u8fd9\u4e2a\u5f0f\u5b50\u7684\u503c\u662f\u591a\u5c11\n\n## $\\sum_{d|\\frac{n}{p}}h(dp)\\mu(d)$\n\n\u7531\u4e8ep\u662f\u5947\u6570\uff0c\u6240\u4ee5\u53ef\u4ee5\u5199\u6210\n\n## $p\\sum_{d|\\frac{n}{p}}h(d)\\mu(d)$\n\n\u90a3\u4e48\u6211\u4eec\u8003\u8651\u540e\u8fb9\u5f0f\u5b50\u5c55\u5f00\u4e4b\u540e\u7684\u9879,$\\mu$\u503c\u4e3a0\u7684\u9879\u6211\u4eec\u4e0d\u7ba1\uff0c\u8003\u8651$\\mu$\u503c\u4e3a1\u548c-1\u7684\u9879\n\n\u90a3\u4e48\u6211\u4eec\u5bf9d\u662f\u5947\u6570\u7684\u9879\u628a\u5b83\u4e582\uff0c\u5076\u6570\u7684\u7684\u9879\u628a\u5b83\u96642\n\n\u90a3\u4e48\u663e\u7136\u53ef\u4ee5\u628a\u8fd9\u4e9b$\\mu$\u503c\u4e3a1\u548c-1\u7684\u9879\u4e24\u4e24\u914d\u4e0a\u5bf9\n\n\u90a3\u4e48\u6211\u4eec\u53d1\u73b0\u4e582\u6216\u8005\u96642\u7684\u8fc7\u7a0b\u4e2d$h(d)$\u7684\u503c\u5e76\u6ca1\u6709\u53d8\u800c$\\mu(d)$\u7684\u503c\u521a\u597d\u53d6\u53cd\n\n\u56e0\u6b64\u6bcf\u4e2a\u5bf9\u7684\u548c\u6070\u597d\u662f0\n\n\u6240\u4ee5\u6211\u4eec\u8bc1\u660e\u4e86\u4ec0\u4e48\uff1f\u521a\u624d\u7684\u5f0f\u5b50\u7684\u548c\u4e3a0\uff0c\u56e0\u6b64\u8fd9\u79cd\u60c5\u51b5\u9047\u5230\u4e4b\u540e\u76f4\u63a5continue\u6389\u5c31\u597d\u4e86\n\n\u90a3\u4e48\u5269\u4e0b\u7684\u60c5\u51b5\u6211\u4eec\u8ba4\u4e3a$h(dp)=dh(p)$\u8fd9\u4e2a\u5f0f\u5b50\u90fd\u662f\u6210\u7acb\u7684\n\n\u90a3\u4e48\u5f0f\u5b50\u53ef\u4ee5\u5316\u7b80\u6210\n\n## $Ans=\\sum_{p|n}g(p)h(p)\\sum_{d|\\frac{n}{p}}d\\mu(d)$\n\n\u90a3\u4e48\u6211\u4eec\u8bb0$t(m)=\\sum_{d|m}d\\mu(d)$\n\n\u90a3\u4e48\u6211\u4eec\u770b\u4e00\u770b\u5b83\u7b49\u4e8e\u4ec0\u4e48\uff0c\u8fd8\u662f\u8001\u6837\u5b50\u6211\u4eec\u8003\u8651\u8fd9\u4e2a\u5f0f\u5b50\u7684\u5c55\u5f00\u5f0f\uff0c$\\mu$\u503c\u4e3a0\u7684\u6211\u4eec\u4e0d\u7528\u7ba1\uff0c\u8003\u86511\u548c-1\u7684\u9879\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u628am\u8d28\u56e0\u6570\u5206\u89e3\uff0c\u4e8e\u662f\u4e0a\u8fb9\u7684\u5f0f\u5b50\u548c\u4e0b\u8fb9\u7684\u5f0f\u5b50\u5e94\u8be5\u662f\u7b49\u4ef7\u7684\n\n## $t(m)=\\prod_{i=1}^{q}(1-p_{i})$\n\n\u5176\u4e2d$p_{1}\u2026\u2026p_{q}$\u662fm\u7684\u8d28\u56e0\u6570\u5206\u89e3\n\n\u56e0\u4e3a\u6211\u4eec\u628a\u4e0b\u9762\u7684\u5f0f\u5b50\u5c55\u5f00\u4e4b\u540e\u5e94\u8be5\u6bcf\u4e00\u9879\u662f\u4e00\u5806p\u4e58\u8d77\u6765\uff0c\u800c\u5982\u679c\u8fd9\u4e2a\u9879\u91cc\u6709\u5947\u6570\u4e2a\u8d28\u6570\u7684\u8bdd\u90a3\u4e48\u7cfb\u6570\u5c31\u662f-1\u53cd\u4e4b\u5c31\u662f1\uff0c\u90a3\u4e48\u521a\u597d\u548c\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u7684\u5b9a\u4e49\u5bf9\u5e94\u8d77\u6765\uff0c\u800c\u8fd9\u4e9b\u8d28\u6570\u4e58\u8d77\u6765\u7684\u503c\u6070\u597d\u5c31\u662fd,\u7531\u4e8e\u6bcf\u4e2a\u8d28\u56e0\u5b50\u53ea\u51fa\u73b0\u4e00\u6b21\u56e0\u6b64$\\mu$\u503c\u4e3a0\u7684\u9879\u4e0d\u4f1a\u51fa\u73b0\uff0c\u6240\u4ee5\u4e0a\u8fb9\u548c\u4e0b\u9762\u7684\u5f0f\u5b50\u662f\u7b49\u4ef7\u7684\n\n\u6240\u4ee5\u6700\u540e\u6211\u4eec\u7684\u5f0f\u5b50\u5c31\u53d8\u6210\u4e86\n\n## $Ans=\\sum_{p|n}g(p)h(p)t(n/p)$\n\n\u6700\u540e\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u4f55\u751f\u6210\u4e00\u4e2a\u6570\u7684\u6240\u6709\u7ea6\u6570?\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u4e2a\u6570\u8fdb\u884c\u8d28\u56e0\u6570\u5206\u89e3\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5dfs\u51fa\u6240\u6709\u7684\u7ea6\u6570\u4e86\n\n\u95ee\u9898\u6765\u4e86\u600e\u4e48\u8d28\u56e0\u6570\u5206\u89e3\uff1f\n\n___________________\n\n### \u524d\u7f6e\u829d\u58eb:Pollard-Rho\u7b97\u6cd5\n\n\u671f\u671b\u590d\u6742\u5ea6$O(\\sqrt{\\sqrt{n}})$\u7684\u795e\u5947\u7b97\u6cd5\n\n\u7b80\u5355\u6765\u8bf4\uff0c\u6211\u4eec\u4e0d\u505c\u7684\u968f\u673a\u4e24\u4e2a\u6570\uff0c\u7136\u540e\u53d6\u4ed6\u4eec\u7684\u5dee\uff0c\u548c\u8981\u5206\u89e3\u7684\u6570\u53d6gcd\uff0c\u5982\u679cgcd\u4e0d\u662f1\u7684\u8bdd\u9012\u5f52\u5206\u89e3gcd\u548cn/gcd\uff0c\u76f4\u5230\u9047\u5230\u4e86\u8d28\u6570\uff0c\u6b64\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u8fd9\u4e2a\u8d28\u56e0\u6570\u653e\u5230set\u91cc\u4e86\n\n\u4f46\u662f\u5176\u5b9e\u6211\u4eec\u5199\u4e0d\u51fa\u968f\u673a\u51fd\u6570\u6765\uff0c\u6211\u4eec\u7684\u968f\u673a\u51fd\u6570\u662f\u7528\u4e00\u4e9b\u5947\u5947\u602a\u602a\u7684\u5f0f\u5b50\u751f\u6210\u7684\uff0c\u6bd4\u5982$x=(x^2+1)modn$\u8fd9\u4e2a\u4e1c\u897f\u6700\u540e\u4e00\u5b9a\u4f1a\u9677\u5165\u6b7b\u5faa\u73af\uff0c\u6b64\u65f6\u5982\u679c\u6211\u4eec\u8fd8\u662f\u6ca1\u6709\u731c\u5bf9\u6211\u4eec\u5c31\u51c9\u4e86\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u8003\u8651\u5982\u4f55\u5224\u6389\u8fd9\u4e2a\u73af\uff0c\u4e00\u4e2a\u6bd4\u8f83\u53e4\u8001\u7684\u65b9\u5f0f\u662fFloyd2\u500d\u901f\u5224\u65ad\u6cd5\uff0c\u8fd9\u91cc\u4ecb\u7ecd\u4e00\u4e2a\u6bd4\u8f83\u673a\u667a\u7684\u5224\u73af\u6cd5\uff0cBrent\u5224\u73af\u6cd5\n\n\u6211\u4eec\u5148\u94a6\u5b9a\u4e00\u4e2a\u521d\u59cb\u7684\u79cd\u5b50x1\n\n\u7136\u540e\u8ba1\u7b97$x_{2}=x_{1},x_{1}=(x_{1}^{2}+1)modn$\n\n\u7136\u540e\u6211\u4eec\u4e0d\u505c\u7684\u8ba1\u7b97$x_{i}$\u5982\u679ci\u662f2\u7684\u6574\u6b21\u5e42\u90a3\u4e48\u4ee4$x_{2}=x_{1}$\n\n\u6bcf\u6b21\u8fd4\u56de$x_{2}-x_{1}$\u4f5c\u4e3a\u6211\u4eec\u51fd\u6570\u7684\u8fd4\u56de\u503c\uff0c\u5f53\u8fd4\u56de\u503c\u662f0\u7684\u65f6\u5019\u8868\u660e\u51fa\u73b0\u4e86\u73af\u76f4\u63a5\u91cd\u65b0\u9009\u62e9\u79cd\u5b50\n\n\u542c\u8d77\u6765\u633a\u7384\u5b66\u7684\u4f46\u662f\u4f60\u81ea\u5df1\u753b\u4e00\u4e2a$\\rho$\u578b\u7684\u73af\u4f60\u4f1a\u53d1\u73b0\u8fd9\u4e2a\u4e1c\u897f\u771f\u7684\u53ef\u4ee5\u628a\u73af\u5224\u51fa\u6765\n\n\u7136\u540e\u6709\u4eba\u8bc1\u660e\u4e86\u8fd9\u4e2a\u4e1c\u897f\u7684\u590d\u6742\u5ea6\u662f\u671f\u671b$O(\\sqrt{\\sqrt{n}})$\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u5bf9\u8fd9\u4e2a\u6570\u505a\u8d28\u56e0\u6570\u5206\u89e3\u4e86\n\n## \u5b9e\u73b0\n\n\u6211\u4eecdfs\u51fa\u6240\u6709\u7684\u7ea6\u6570\u503c\uff0ct\u51fd\u6570\u7684\u503c\u53ef\u4ee5\u5728dfs\u7684\u65f6\u5019\u987a\u4fbf\u6c42\u51fa\uff0c\u7136\u540e\u6211\u4eec\u76f4\u63a5\u6309\u7167\u63a8\u51fa\u6765\u7684\u5f0f\u5b50\u679a\u4e3e\u7ea6\u6570\u66b4\u529b\u8ba1\u7b97\u5373\u53ef\uff0ct\u51fd\u6570\u7684\u503c\u7528unordered_map\u5b58\u4e00\u4e0b\u5c31\u884c\u4e86\uff0cPollard-Rho\u7684\u8d28\u6570\u5224\u5b9a\u91c7\u7528Miller-Rabin\u968f\u673a\u5224\u5b9a\u6cd5\u5373\u53ef\n\n\u6700\u540e\u4e00\u4e2a\u5c0f\u95ee\u9898\uff0c\u6211\u4eec\u53ef\u80fd\u8981\u505a\u819c\u6570\u662flonglong\u8303\u56f4\u5185\u7684\u4e58\u6cd5\uff0c\u8be5\u600e\u4e48\u529e\u5462\uff1f\n\n### \u5f3a\u884c\u8f6c\u6210long double\u624b\u52a8\u6a21\u62df\u819c\u6cd5\u5373\u53ef/int_128\u4e5f\u53ef\n\n\u4e0a\u4ee3\u7801~\n\n```C\n// luogu-judger-enable-o2\n#include<cstdio>\n#include<algorithm>\n#include<set>\n#include<cstdlib>\n#include<tr1/unordered_map>\nusing namespace std::tr1;\nusing namespace std;const int N=1e5+1e4+10;typedef long long ll;typedef long double ld;\nll n;ll k;ll mod;set <ll> s;int T;ll tims;\ninline ll mul(ll a,ll b,ll md){ll tp=a*b-(ll)((ld)a/md*b+1.0e-8)*md;return tp<0?tp+md:tp;}\\\\\u8f6clongdouble\u7684\u4e58\u6cd5\ninline ll po(ll a,ll p){ll r=1;for(;p;p>>=1,a=a*a%mod)if(p&1)r=r*a%mod;return r;}//\u5feb\u901f\u5e42\nnamespace MiiR//miiler-rabin\n{\n    const ll bs[20]={2,3,5,7,11,61,24151};//\u5077\u61d2\u5c11\u9009\u4e86\u51e0\u4e2abase\n    inline ll po(ll a,ll p,ll mod){ll r=1;for(;p;p>>=1,a=mul(a,a,mod))if(p&1)r=mul(r,a,mod);return r;}\n    inline bool tst(ll x,int t)//\u4e8c\u6b21\u63a2\u6d4b\n    {for(ll p=x-1;;p>>=1){ll g=po(bs[t],p,x)%x;if(g==x-1)return 0;if(g!=1)return 1;if(p&1)return 0;}}\n    inline bool ck(ll x){for(int i=0;i<=6&&bs[i]<x;i++){if(tst(x,i))return false;}return true;}\n}\nnamespace PollR\n{\n    ll st;\n    inline ll mabs(ll x,ll y){return (x>y)?x-y:y-x;}\n    inline ll gcd(ll a,ll b){ll c;while(b){c=a%b;a=b;b=c;}return a;}\n    inline ll rd(ll x,ll md){return (mul(x,x,md)+st)%md;}\n    inline ll bigr(){ll ret=0;for(int i=0;i<=62;i++)ret+=(1LL<<i)*(rand()%2);return ret;}//\u8fd9\u91cc\u5199\u4e86\u4e2a\u66b4\u529brand\uff0c\u5927\u5bb6\u4e0d\u8981\u5b66\u6211\n    inline void solve(ll x)//\u9012\u5f52\u5206\u89e3\uff0c\u8d28\u6570\u76f4\u63a5\u8fd4\u56de\n    {\n        if(x==1)return;if(MiiR::ck(x)){s.insert(x);return;}\n        while(1)\n        {\n            ll x1=bigr()%x;st=rand()%x+1;\n            ll g=gcd(x,x1);if(g!=1&&g!=x){solve(g);solve(x/g);return;}\n            ll x2=x1;x1=rd(x1,x);ll k=0;ll tr=1;\n            for(;x1-x2;x1=rd(x1,x),k++)//brent\u5224\u5708\u6cd5\n            {\n                g=gcd(x,mabs(x1,x2));if(g!=1&&g!=x){solve(g);solve(x/g);return;}\n                if(k==tr){x2=x1;tr<<=1;}\n            }\n        }\n    }\n}\nll ys[N];int hd;\nunordered_map <ll,ll> fuc;//\u5b58t\u51fd\u6570\u7684map\nvoid dfs(ll d,ll f,set <ll>::iterator it)//dfs\u627e\u8d28\u6570\n{\n    if(it==s.end()){ys[++hd]=d;fuc[d]=f;return;}\n    set <ll>:: iterator it1=++it;--it;dfs(d,f,it1);\n    for(ll mi=*it;;mi*=(*it))//\u6ce8\u610f\u522b\u7206longlong\n    {dfs(d*mi,f*(mod-*it%mod+1)%mod,it1);if((n/mi)%(*it)!=0)break;}\n}\ninline void solve()\n{\n    scanf(\"%lld%lld%lld\",&n,&k,&mod);ll ret=0;k%=mod;//\u5c0f\u5fc3\u7206longlong\n    PollR::solve(n);dfs(1,1,s.begin());//\u5206\u89e3\u4e4b\u540e\u627e\u7ea6\u6570\n    for(int i=1;i<=hd;i++)//\u679a\u4e3e\u7ea6\u6570\u66b4\u529b\u8ba1\u7b97\u5373\u53ef\n    {\n        ll d=ys[i];if(d%2==1&&(n/d)%2==0){continue;}\n        (ret+=((d%2)?d:d/2LL)%mod*po(k,(d+1)/2)%mod*fuc[n/d]%mod)%=mod;\n    }printf(\"%lld\\n\",ret);\n}\ninline void clear(){set <ll> emp;unordered_map <ll,ll> ep;swap(s,emp);swap(fuc,ep);hd=0;tims=0;}//O(1)\u7684clear\nint main(){srand(66623366);scanf(\"%d\",&T);for(int z=1;z<=T;z++){solve();clear();}return 0;}//\u62dc\u62dc\u7a0b\u5e8f~\n\n```\n\n\n\n\n\n\n\n\n",
        "postTime": 1526812047,
        "uid": 56384,
        "name": "shadowice1984",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4607 \u3010[SDOI2018]\u53cd\u56de\u6587\u4e32\u3011"
    },
    {
        "content": "\n\u8fd9\u9053\u9898\u5f88\u6709\u610f\u601d\uff0c\u9700\u8981\u4f60\u8fdb\u884c\u5927\u91cf\u7684\u624b\u73a9\u6765\u63a8\u7ed3\u8bba\n\n- \u7ed3\u8bba$1$\uff1a\u4e00\u4e2a\u5b57\u7b26\u4e32 A \u7684\u4e0d\u540c\u7684\u8f6e\u6362\u7684\u6570\u91cf\u4e3a $|\\sigma(A)|$\uff0c\u5176\u4e2d $\\sigma(S)$ \u8868\u793a S \u7684\u6700\u5c0f\u5faa\u73af\u8282\u3002\n\n\u8fd9\u4e2a\u7ed3\u8bba\u6bd4\u8f83\u57fa\u7840/fad\n\n- \u7ed3\u8bba$2$\uff1a\u4e00\u4e2a\u56de\u6587\u4e32\u7684\u6700\u5c0f\u5faa\u73af\u8282 $\\sigma(S)$ \u5fc5\u7136\u4e5f\u662f\u4e00\u4e2a\u56de\u6587\u4e32\u3002\n\n\u8bc1\u660e\u7684\u8bdd\u53ef\u4ee5\u624b\u73a9\u3002\n\n- \u7ed3\u8bba$3$\uff1a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5b57\u7b26\u4e32\u53ef\u4ee5\u88ab\u4e00\u4e2a\u6700\u5c0f\u5faa\u73af\u8282\u552f\u4e00\u8868\u793a\uff0c\u540c\u65f6\u8fd9\u4e2a\u5faa\u73af\u8282\u4e5f\u4f1a\u552f\u4e00\u8868\u793a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5b57\u7b26\u4e32\u3002\n\n\u8fd9\u4e2a\u7ed3\u8bba\u4e5f\u975e\u5e38\u663e\u7136\u3002\n\n\u4e0d\u8fc7\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u8f6c\u53d8\u601d\u8def\u4e86\uff0c\u6211\u4eec\u5c1d\u8bd5\u5bf9 $\\sigma$ \u8fdb\u884c\u8ba1\u6570\uff0c\u6839\u636e\u7ed3\u8bba $1$ \u4e00\u4e2a $\\sigma$ \u53ef\u4ee5\u884d\u751f\u51fa\u6765\u7684\u672c\u8d28\u4e0d\u540c\u7684\u5b57\u7b26\u4e32\u7684\u6570\u91cf\u4e3a $|\\sigma|$\n\n\u6240\u4ee5\u6211\u4eec\u731c\u60f3\u7b54\u6848\u662f\uff1a$\\sum |\\sigma|$\n\n\u5f88\u5feb\u4f60\u5c31\u4f1a\u610f\u8bc6\u5230\u4e0d\u5bf9\uff0c\u6211\u4eec\u53d1\u73b0\u6bd4\u5982\u5b57\u7b26\u4e32 ```abbaabba``` \u4ed6\u5728\u4e00\u5b9a\u7684\u5faa\u73af\u4e4b\u540e\u4f1a\u53d8\u6210 ```baabbaab``` \u6211\u4eec\u7edf\u8ba1 $\\sigma$ \u7684\u65f6\u5019\u4f1a\u5c06 ```abba``` \u4e0e ```baab``` \u90fd\u4e00\u8d77\u7b97\u4e00\u904d\u3002\n\n\u6211\u4eec\u63a5\u7740\u53c8\u53ef\u4ee5\u53d1\u73b0\u8fd9\u51e0\u4e2a\u7ed3\u8bba\uff1a\n\n- \u7ed3\u8bba$4$\uff1a\u5982\u679c\u4e00\u4e2a\u5408\u6cd5\u7684\u5faa\u73af\u8282 $\\sigma$ \u7684\u957f\u5ea6\u4e3a\u5076\u6570\uff0c\u90a3\u4e48\u81f3\u5c11\u5b58\u5728\u53e6\u4e00\u4e2a $\\sigma$ \u4e0e\u4e4b\u5bf9\u5e94\u3002\n\n~~\u8bc1\u660e\u7684\u8bdd\u624b\u73a9~~\uff0c\u5927\u6982\u5c31\u662f\u628a $\\sigma$ \u5206\u89e3\u4e3a $s1+s2$\uff0c\u90a3\u4e48 $s1\\ne s2,s1=rev(s2)$\uff0c\u90a3\u4e48\u4e00\u5b9a\u5b58\u5728\u53e6\u4e00\u4e2a\u5faa\u73af\u8282\u4e3a $s2+s1$ \u53ef\u4ee5\u901a\u8fc7\u8f6e\u6362\u5f97\u5230\u4e00\u6837\u7684\u7ed3\u679c\u3002\n \n- \u7ed3\u8bba$5$\uff1a\u5728\u7ed3\u8bba $4$ \u7684\u57fa\u7840\u4e0a\uff0c\u6bcf\u4e2a\u957f\u5ea6\u4e3a\u5076\u6570\u7684\u5408\u6cd5\u6700\u5c0f\u5faa\u73af\u8282 $\\sigma$ \u90fd\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a $\\zeta$ \u4e0e\u4e4b\u5bf9\u5e94\uff0c\u5373 $4$ \u7684\u8bc1\u660e\u4e0b\u9762\u8865\u5145\u7684\u4f8b\u5b50\u3002\n\n\u8fd9\u4e2a\u7ed3\u8bba\u5c31\u9700\u8981\u624b\u73a9\u4e86\uff0c\u753b\u4e00\u4e2a\u56fe\uff0c\u7136\u540e\u5047\u8bbe\u4e00\u4e2a\u4f4d\u79fb $k$ \u4f7f\u5f97\u5176\u56de\u6587\uff0c\u6700\u540e\u4f1a\u63a8\u5bfc\u51fa\u6765 $\\sigma$ \u662f\u5b58\u5728\u5faa\u73af\u8282\u7684\u4e4b\u7c7b\u7684\uff0c\u6bd4\u8f83\u611f\u6027...\u4e0d\u8fc7\u76f4\u89c9\u4e0a\u8fd9\u4e2a\u7ed3\u8bba\u633a\u5bf9\u7684\u3002\n\n- \u7ed3\u8bba$6$\uff1a\u7c7b\u6bd4\u7ed3\u8bba $5$\uff0c\u5982\u679c\u4e00\u4e2a\u56de\u6587\u6700\u5c0f\u5faa\u73af\u8282 $\\sigma$ \u4e3a\u5947\u6570\uff0c\u90a3\u4e48\u5176\u4e0d\u5b58\u5728\u4efb\u610f\u4e00\u4e2a\u4e0e\u4e4b\u5bf9\u5e94 $\\zeta$ \u4f7f\u4e4b\u56de\u6587\u3002\n\n\u8fd9\u4e2a\u7ed3\u8bba\u7684\u624b\u73a9\u65b9\u5f0f\u548c $5$ \u7c7b\u4f3c\u3002\n\n- \u7ed3\u8bba $7$\uff1a\u7ea6\u6570\u4e2a\u6570\u51fd\u6570\u7684\u589e\u957f\u5341\u5206\u7f13\u6162\uff0c\u5bf9\u4e8e $n\\le 10^{18}$\uff0c\u6709 $\\max\\{d(n)\\}=103680$\n\n\u6211\u4eec\u53d1\u73b0\u7ed3\u8bba $6$ \u5341\u5206\u7684\u4f18\u7f8e\uff0c\u4ed6\u610f\u5473\u7740\u5982\u679c\u4e00\u4e2a\u56de\u6587\u5faa\u73af\u8282\u7684\u957f\u5ea6\u4e3a\u5947\u6570\uff0c\u90a3\u4e48\u5176\u5bf9\u4e8e\u7b54\u6848\u7684\u8d21\u732e\u5c31\u662f $|\\sigma|$\n\n\u800c\u7ed3\u8bba $5$ \u5219\u8ba9\u6211\u4eec\u610f\u8bc6\u5230\u5bf9\u4e8e\u957f\u5ea6\u4e3a\u5076\u6570\u7684\u56de\u6587\u5faa\u73af\u8282\uff0c\u5176\u603b\u662f\u4e24\u4e24\u914d\u5bf9\u7684\uff0c\u6240\u4ee5\u5355\u72ec\u4e00\u8005\u7684\u8d21\u732e\u53ef\u4ee5\u76f4\u63a5\u89c6\u4e3a $\\frac{|\\sigma|}{2}$\n\n\u7ed3\u8bba $7$ \u5219\u544a\u8bc9\u6211\u4eec\uff0c\u590d\u6742\u5ea6\u4e3a $O(d(n))$\uff08$d(x)$ \u8868\u793a $x$ \u7684\u7ea6\u6570\u4e2a\u6570\uff09\u7684\u7b97\u6cd5\u662f\u53ef\u4ee5\u901a\u8fc7\u8fd9\u9053\u9898\u7684\u3002\n\n\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u8ba1\u6570\u4e86\uff0c\u4ee4 $f(d)$ \u8868\u793a\u6700\u5c0f\u5faa\u73af\u8282\u957f\u5ea6\u4e3a $d$ \u7684\u5faa\u73af\u8282\u6570\u91cf\uff0c\u90a3\u4e48\u6211\u4eec\u77e5\u9053\u7b54\u6848\u5c31\u662f\uff1a\n\n$$\\sum_{d|n}f(d)\\times \\frac{d}{1+r(d)}$$\n\n\u5176\u4e2d $r(d)$ \u8868\u793a \"[$d$ \u4e3a\u5076\u6570]\"\uff0c\u6211\u4eec\u53d1\u73b0 $f(d)$ \u4e0d\u597d\u6c42\uff0c\u4f46\u662f\u6211\u4eec\u4e0d\u59a8\u8bbe $F(x)$ \u4e3a\u957f\u5ea6\u4e3a $x$ \u7684\u56de\u6587\u4e32\u7684\u6570\u91cf\uff0c\u90a3\u4e48\u6709\uff1a\n\n$$\\sum_{d|x}f(d)=F(x)$$\n\n~~\u53ef\u4ee5\u76f4\u63a5\u5f53\u4f5c\u7528\u4e86\u4e00\u6b21\u7ed3\u8bba$2$\uff0c\u867d\u7136\u4e5f\u6bd4\u8f83\u663e\u7136~~\n\n\u6211\u4eec\u77e5\u9053 $F(x)=m^{\\lceil\\frac{x}{2}\\rceil}$\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5f97\u5230 $f$\n\n\u4e8e\u662f\u6709\uff1a\n\n$$f(d)=\\sum_{x|d}F(x)\\times \\mu(\\frac{d}{x})$$\n\n\u4e8e\u662f\u6211\u4eec\u77e5\u9053\uff1a\n\n$$Ans=\\sum_{d|n} \\dfrac{d}{1+r(d)}\\sum_{x|d}\\mu(\\frac{d}{x})F(x)$$\n\n\u4ee4 $g(d)=\\frac{d}{1+r(d)}$\uff0c\u5219\u6709\uff1a\n\n$$Ans=\\sum_{d|n}\\sum_{x|d}\\mu(\\frac{d}{x})F(x)g(d)$$\n\n$$Ans=\\sum_{x|n}F(x)\\sum_{k|\\frac{n}{x}}\\mu(k)g(kx)$$\n\n\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u5982\u679c\u6211\u4eec\u80fd\u591f\u505a\u5230 $O(d(n))$ \u7684\u679a\u4e3e\u7ea6\u6570\u90a3\u4e48\u672c\u9898\u5df2\u7ecf\u53ef\u4ee5\u5f97\u5230\u90e8\u5206\u5206\u4e86\u3002\n\n\u6211\u4eec\u80af\u5b9a\u5e0c\u671b\u6709\u4e00\u79cd\u7384\u5e7b\u7684\u64cd\u4f5c\u53ef\u4ee5\u5c06 $g(kx)$ \u5206\u89e3\u51fa\u6765\uff0c\u8ba9\u540e\u9762\u53d8\u6210\u4e4b\u548c $\\frac{n}{x}$ \u6709\u5173\u7684\u4e00\u4e2a\u51fd\u6570\u3002\n\n\u5047\u8bbe\u5c06 $k$ \u4ece $g(kx)$ \u4e2d\u63d0\u53d6\u51fa\u6765\u53d8\u6210 $kg(x)$\uff0c\u90a3\u4e48\u6b64\u65f6 $kg(x)\\ne g(kx)$ \u5f53\u4e14\u4ec5\u5f53 $x$ \u4e3a\u5947\u6570\uff0c$k$ \u4e3a\u5076\u6570\u3002\n\n\u7531\u4e8e $k|\\frac{n}{x}$\uff0c\u4e8e\u662f $\\frac{n}{x}$ \u4e3a\u5076\u6570\uff0c\u6211\u4eec\u73b0\u5728\u6765\u8003\u8651\u8fd9\u4e2a\u5f0f\u5b50\u7684\u53d6\u503c\uff1a\n\n$$\\sum_{k|\\frac{n}{x}}\\mu(k)g(kx)$$\n\n~~\u901a\u8fc7\u6253\u8868\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u7684\u503c\u6052\u5b9a\u4e3a $0$~~\n\n\u6211\u4eec\u7406\u6027\u5206\u6790\u4e00\u4e0b\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u7684\u524d\u63d0\u4e3a $\\frac{n}{x}$ \u4e3a\u5076\u6570\uff0c$x$ \u4e3a\u5947\u6570\uff0c\u6240\u4ee5\u5bf9\u4e8e\u7b54\u6848\u6709\u8d21\u732e\u7684 $\\mu(k)$ \u90fd\u6ee1\u8db3 $\\mu(k)\\ne 0$\uff0c\u6211\u4eec\u5bf9\u4e8e $\\frac{n}{x}$ \u8fdb\u884c\u8d28\u56e0\u6570\u5206\u89e3\uff0c\u73b0\u5728\u53ea\u5173\u6ce8 $\\mu(k)\\ne 0$ \u7684 $k$\uff0c\u6211\u4eec\u53d1\u73b0\u6bcf\u4e00\u4e2a\u4e0d\u542b $2$ \u4f5c\u4e3a\u56e0\u6570\u7684 $k$ \u90fd\u5b58\u5728\u4e00\u4e2a $\\mu(2k)$ \u4e0e\u4e4b\u5bf9\u5e94\uff0c\u4e14\u5176\u503c\u6070\u597d\u76f8\u53cd\uff0c\u800c\u4e14 $g(kx),g(2kx)$ \u662f\u76f8\u540c\u7684\uff0c\u6240\u4ee5\u8fd9\u4e24\u4e2a\u503c\u4f1a\u5728\u4e00\u8d77\u62b5\u6d88\uff0c\u6240\u4ee5\u8fd9\u4e00\u90e8\u5206\u5bf9\u4e8e\u7b54\u6848\u7684\u8d21\u732e\u4e3a $0$\u3002\n\n\u7531\u4e8e\u6211\u4eec\u4e0d\u5173\u6ce8 $0$ \u7684\u53d6\u503c\uff0c\u6211\u4eec\u53ef\u4ee5\u5ffd\u7565\u8fd9\u4e00\u7c7b\uff0c\u5bf9\u4e8e\u5269\u4e0b\u7684\u60c5\u51b5\uff0c\u6709\u7b54\u6848\u4e3a\uff1a\n\n$$\\sum_{x|n}F(x)g(x)\\sum_{k|\\frac{n}{x}}\\mu(k)k$$\n\n\u5982\u679c\u80fd\u591f $O(1)$ \u7684\u6c42\u51fa\u540e\u9762\u7684\u5f0f\u5b50\u7684\u503c\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a $O(d(n))$ \u7684\u89e3\u6cd5\u4e86\uff0c\u73b0\u5728\u8003\u8651\uff1a\n\n$$\\sum_{k|n}\\mu(k)k$$\n\n\u7684\u53d6\u503c\uff0c\u6211\u4eec\u4ecd\u7136\u53ea\u8003\u8651 $\\mu(k)\\ne 0$ \u7684\u6570\uff0c\u90a3\u4e48\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u5c06\u4e00\u4e2a $k$ \u89c6\u4e3a $p_1p_2...p_m$\n\n\u8003\u8651\u4e00\u4e2a dp \u7684\u601d\u60f3\u6765\u7edf\u8ba1\u7b54\u6848\uff0c\u6bcf\u6b21\u65b0\u589e\u4e00\u4e2a\u8d28\u56e0\u6570 $p'$ \u8fdb\u5165\u96c6\u5408\u7684\u65f6\u5019\uff0c\u663e\u7136\u7b54\u6848\u6709\u4e24\u7c7b\uff0c\u4e00\u7c7b\u662f\u4e0d\u9009\u5165 $p'$ \u4e00\u7c7b\u662f\u9009\u5165 $p'$\uff0c\u9009\u5165 $p\n'$ \u7684\u540c\u65f6\u4f1a\u4f7f\u5f97\u6240\u6709\u8d21\u732e\u90fd\u4e58\u4ee5 $(-1)$\uff0c\u4ee4 $f_i$ \u8868\u793a\u4e4b\u524d\u7684\u7b54\u6848\uff0c\u5219\u6709 $f_i'=(f_i-p'f_i)$\uff0c\u6211\u4eec\u628a\u6bcf\u4e00\u9879\u7684\u8d21\u732e\u5355\u72ec\u63d0\u53d6\u51fa\u6765\uff0c\u5219\u53ef\u4ee5\u5f97\u5230\u4e0a\u5f0f\u4e3a\uff1a\n\n$$\\sum_{k|n}\\mu(k)k=\\prod(1-p_i)$$\n\n\u6211\u4eec\u5148\u901a\u8fc7 Pollard\u2212Rho \u5c06 $n$ \u8fdb\u884c\u8d28\u56e0\u6570\u5206\u89e3\uff0c\u7136\u540e\u901a\u8fc7\u8d28\u56e0\u6570\u6765\u8fdb\u884c\u641c\u7d22\uff0c\u505a\u5230 $O(d(n))$ \u679a\u4e3e\u6240\u6709\u7ea6\u6570\uff0c\u5bf9\u4e8e $x$ \u4e3a\u5947\u6570\u800c $\\frac{n}{x}$ \u4e3a\u5076\u6570\u7684\u60c5\u51b5\u5ffd\u7565\uff0c\u7136\u540e\u6cbf\u9014\u7edf\u8ba1\u4e00\u4e0b $\\prod(1-p_i)$ \u5373\u53ef\u3002\n\n\u503c\u5f97\u6ce8\u610f\u7684\u662f\u88ab\u7edf\u8ba1\u7684 $\\prod (1-p_i)$ \u662f\u8865\u96c6\u7684\u3002\n\n\u590d\u6742\u5ea6 $O(T\\times (d(n)\\log n+n^{1/4}\\log n))$\n\n$Code:$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std ;\n#define Next( i, x ) for( register int i = head[x]; i; i = e[i].next )\n#define rep( i, s, t ) for( register int i = (s); i <= (t); ++ i )\n#define drep( i, s, t ) for( register int i = (t); i >= (s); -- i )\n#define re register\n#define int __int128\nint gi() {\n\tchar cc = getchar() ; int cn = 0, flus = 1 ;\n\twhile( cc < '0' || cc > '9' ) {  if( cc == '-' ) flus = - flus ; cc = getchar() ; }\n\twhile( cc >= '0' && cc <= '9' )  cn = cn * 10 + cc - '0', cc = getchar() ;\n\treturn cn * flus ;\n}\nconst int N = 10000 + 5 ; \nint T, n, m, P, st[N], top, w[N], num, c[N] ; \nint mul( int a, int b, int p ) {\n\treturn ( a % p ) * ( b % p ) % p ;  \n}\nint fpow( int x, int k, int p ) {\n\tint ans = 1, base = x % p ; \n\twhile( k ) {\n\t\tif( k & 1 ) ans = mul( ans, base, p ) ;\n\t\tbase = mul( base, base, p ), k >>= 1 ; \n\t} return ans % p ; \n}\nbool M_R( int p ) {\n\tif( p == 2 || p == 3 ) return 1 ; \n\tif( p == 1 || ( p % 2 == 0 ) ) return 0 ; \n\tre int d = p - 1, s = 0 ; while( !( d & 1 ) ) ++ s, d >>= 1 ; \n\trep( i, 0, 5 ) {\n\t\tre int a = rand() % ( p - 3 ) + 2 ; \n\t\tre int x = fpow( a, d, p ), y = 0 ;\n\t\tfor( register int j = 0; j < s; ++ j ) {\n\t\t\ty = mul( x, x, p ) ; if( y == 1 && ( x != 1 ) && x != ( p - 1 ) ) return 0 ;\n\t\t\tx = y ;\n\t\t} if( y != 1 ) return 0 ;\n\t} return 1 ; \n}\nint gcd( int x, int y ) {\n\treturn ( x == 0 ) ? y : gcd( y % x, x ) ;\n}\nint Rand( int x ) {\n\treturn 1ll * ((rand() << 15 ^ rand()) << 30 ^ (rand() << 15 ^ rand())) % x ; //2\n}\nint work( int p ) {\n\tre int k = 2, x = Rand(p - 1) + 1, y = x, d = 1, c = Rand(p) % 999997 ;\n\tfor( re int i = 1; d == 1; ++ i ) {\n\t\tx = ( mul( x, x, p ) + c ) % p ;\n\t\td = gcd( (x > y) ? x - y : y - x, p ) ;\n\t\tif( i == k ) y = x, k <<= 1 ; \n\t} return d ; \n}\nvoid Pollard_Rho(int p) {\n\tif( p == 1 ) return ; \n\tif( M_R(p) ) { st[++ top] = p; return ; }\n\tint x = p ; while( x == p ) x = work(x) ;\n\tPollard_Rho(x), Pollard_Rho(p / x) ;\n}\nint Ans = 0 ;\nvoid dfs( int x, int f, int d, int p ) {\n\tif( x == num + 1 ) {\n\t\tif( ( (d & 1) ) && ( !( (n / d) & 1 ) ) ) return ;\n\t\tint g = ( d & 1 ) ? d : d / 2 ;\n\t\tAns = ( Ans + mul( mul( fpow( m, ( d + 1 ) / 2, p ), g, p ), (f + p) % p, p ) + p ) % p ;\n\t\treturn ; \n\t}\n\tint fd = 1 ; \n\trep( i, 0, c[x] ) {\n\t\tif( i == c[x] ) dfs( x + 1, f, d * fd, p ) ;\n\t\telse dfs( x + 1, f * ( 1 - w[x] ), d * fd, p ) ;\n\t\tfd = fd * w[x] ; \n\t}\n}\nsigned main()\n{\n\tsrand(time(NULL)) ; \n\tT = gi() ; \n\twhile( T-- ) {\n\t\tn = gi(), m = gi(), P = gi(), top = 0, num = 0, Ans = 0 ;\n\t\tmemset( c, 0, sizeof(c) ), memset( w, 0, sizeof(w) ), memset( st, 0, sizeof(st) ) ;\n\t\tPollard_Rho(n) ; \n\t\tsort( st + 1, st + top + 1 ) ;\n\t\trep( i, 1, top ) {\n\t\t\tif( st[i] == st[i - 1] ) ++ c[num] ; \n\t\t\telse w[++ num] = st[i], c[num] = 1 ; \n\t\t}\n\t\tdfs( 1, 1, 1, P ) ;\n\t\tprintf(\"%lld\\n\", (long long)((Ans) % P) ) ;\n\t}\n\treturn 0 ;\n}\n```",
        "postTime": 1588169183,
        "uid": 30036,
        "name": "Soulist",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P4607 \u3010[SDOI2018]\u53cd\u56de\u6587\u4e32\u3011"
    },
    {
        "content": "**[\u9898\u610f](https://www.luogu.com.cn/problem/P4607)**\n- \u95ee\u6240\u6709\u662f\u56de\u6587\u4e32\u53ca\u5176\u65cb\u8f6c\u53d8\u6362\u7684\u4e32\u7684\u4e2a\u6570\u3002\n\n**\u5206\u6790**\n- \u9996\u5148\u957f\u5ea6\u4e3a $n$ \u7684\u56de\u6587\u4e32\u4e2a\u6570\u4e3a $k^{\\lceil n/2\\rceil}$\uff0c\u8bb0\u4f5c $f(n)$\u3002\n- \u5565\u90fd\u4e0d\u8003\u8651\u5f97\u5230 $n\\cdot k^{\\lceil n/2\\rceil}$ \u7684\u7ed3\u8bba\uff0c\u7136\u540e\u4f60\u53d1\u73b0\u53ea\u6709 $n=1$ \u65f6\u7b54\u6848\u624d\u6b63\u786e\u3002\n- \u7136\u540e\u963b\u6320\u6211\u4eec\u76f4\u63a5\u7b97\u65b9\u6848\u6570\u7684\u662f\u4e00\u4e2a\u56de\u6587\u4e32\u5b9e\u9645\u7684\u65cb\u8f6c\u5f62\u6210\u7684\u65b0\u4e32\u4e2a\u6570\u662f\u5c0f\u4e8e $n$ \u7684\u3002\n- \u56e0\u6b64\u6211\u4eec\u8003\u8651\u56de\u6587\u4e32\u7684\u5468\u671f\uff0c\u5c1d\u8bd5\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u8bbe $g(n)$ \u4e3a\u957f\u5ea6\u4e3a $n$ \u7684\uff0c\u6700\u5c0f\u6574\u5468\u671f\u4e3a $n$ \u7684\u56de\u6587\u4e32\u7684\u4e2a\u6570\uff0c\u90a3\u4e48\u7b54\u6848\u53ef\u4ee5\u8868\u793a\u4e3a $(((f\\times \\mu)\\cdot i_1)\\times 1)(n)$\uff0c\u7136\u540e\u4f60\u53d1\u73b0\u53ea\u6709\u5728 $n$ \u662f\u8d28\u6570\u7684\u65f6\u5019\u7b97\u7684\u7b54\u6848\u624d\u6b63\u786e\u3002\n- \u4f60\u53d1\u73b0\u4e86 $n=4$ \u65f6\u7684\u4e00\u4e2a\u91cd\u8981\u53cd\u4f8b\uff1a$\\text{abba}$ \u548c $\\text{baab}$\uff0c\u4f60\u8ba4\u4e3a\u4f3c\u4e4e\u522b\u7684\u53cd\u4f8b\u90fd\u4f1a\u5bfc\u81f4\u5468\u671f\uff0c\u8bbe $z(n)=n/(1+[n\\bmod 2=0])$\uff0c\u7b54\u6848\u53ef\u4ee5\u8868\u793a\u4e3a $(((f\\times \\mu)\\cdot z)\\times 1)(n)$\uff0c\u8fd9\u56de\u6ca1\u4e8b\u4e86\u3002\n- \u66b4\u529b\u8ba1\u7b97 $f\\times \\mu$ \u590d\u6742\u5ea6\u4f1a\u70b8\uff0c\u5229\u7528\u9ad8\u7ef4\u5dee\u5206\u7684\u601d\u60f3\u53ef\u4ee5\u52c9\u5f3a\u4e0d\u70b8\uff0c[\u8fd9\u7bc7](https://www.luogu.com.cn/blog/luo1gu1zui1bang1/gao-wei-qian-zhui-hu)\u6709\u4ecb\u7ecd\uff0c\u4e3b\u8981\u74f6\u9888\u662f\u56e0\u6570\u5206\u89e3\u7684\u590d\u6742\u5ea6\u548c\u5fc5\u4e0d\u53ef\u5c11\u7684\u5feb\u901f\u5e42 $O(\\sigma_0(n)\\log n)$\uff0c[\u4ee3\u7801](https://www.luogu.com.cn/paste/3tkoyi7k)\u3002",
        "postTime": 1661657185,
        "uid": 260884,
        "name": "WeLikeStudying",
        "ccfLevel": 0,
        "title": "\u53cd\u56de\u6587\u4e32"
    },
    {
        "content": "\u9898\u76ee\u662f\u8981\u6c42\u957f\u4e3a $n$ \u7684\u56de\u6587\u4e32\u6709\u591a\u5c11\u79cd\u672c\u8d28\u4e0d\u540c\u7684\u5faa\u73af\u540c\u6784\u3002\n\n\u4e0d\u59a8\u5148\u8003\u8651 $n$ \u4e3a\u5947\u6570\u7684\u60c5\u51b5\u3002\u679a\u4e3e\u6700\u5c0f\u5faa\u73af\u8282\u957f\u5ea6\u4e3a $d$\uff0c\u90a3\u4e48\u4e00\u79cd\u56de\u6587\u4e32\u5bf9\u5e94 $d$ \u4e2a\u5faa\u73af\u540c\u6784\u3002\u5c1d\u8bd5\u6570\u51fa\u6700\u5c0f\u5faa\u73af\u8282\u4e3a $d$ \u7684\u56de\u6587\u4e32\u6570\uff0c\u8bbe\u4e3a $f(d)$\u3002\u663e\u7136\uff0c\u6700\u5c0f\u5faa\u73af\u8282\u4e3a $d$ \u56e0\u6570\u7684\u4e32\u6570\u4e3a $k^{\\frac{d+1}2}$\uff0c\u5373\n$$\\sum_{t|d}f(t)=k^{\\frac{d+1}2}$$\n\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u5f97\n$$f(d)=\\sum_{t|d}\\mu(\\frac dt)k^{\\frac{t+1}2}$$\n\u6240\u4ee5\u7b54\u6848\u662f\n$$\\begin{aligned}&\\sum_{d|n}d\\sum_{t|d}\\mu(\\frac dt)k^{\\frac{t+1}2}\\\\=&\\sum_{t|n}k^{\\frac{t+1}2}\\sum_{dt|n}dt\\mu(d)\\\\=&\\sum_{t|n}k^{\\frac{t+1}2}t\\sum_{d|\\frac nt}d\\mu(d)\\end{aligned}$$\n\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u679a\u4e3e\u56e0\u6570\u662f\u9003\u4e0d\u6389\u4e86\uff0c\u800c\u6734\u7d20\u7684 $O(\\sqrt n)$ \u679a\u4e3e\u663e\u7136\u4f1a\u5bc4\uff0c\u6240\u4ee5\u6211\u4eec\u5bf9 $n$ \u505a\u8d28\u56e0\u6570\u5206\u89e3\u540e\u679a\u4e3e\u5404\u8d28\u56e0\u6570\u7684\u6307\u6570\u505a\u5230\u679a\u4e3e\u56e0\u6570\u3002\n\n\u8003\u8651\u540e\u9762\u90a3\u5768\u4e1c\u897f\uff0c\u7531\u4e8e $\\mu(n)$ \u5728\u5b58\u5728\u8d28\u56e0\u5b50\u6b21\u6570 $>1$ \u65f6\u4e3a $0$\uff0c\u6240\u4ee5\u5176\u5b9e\u53ea\u4e0e $\\dfrac nt$ \u7684\u7d20\u56e0\u5b50\u96c6\u5408\u6709\u5173\uff0c\u53d1\u73b0\u8fd9\u4e2a\u4e1c\u897f\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u9ad8\u7ef4\u524d\u7f00\u548c\uff0c\u53ef\u4ee5\u4e00\u904d FMT \u89e3\u51b3\u3002\n\n\u90a3\u4e48\u6211\u4eec\u505a\u4e00\u6b21\u7684\u590d\u6742\u5ea6\u5c31\u662f $O(n^{\\frac14}\\log n+d\\log n+w2^{w})$\uff0c\u5176\u4e2d $d$ \u662f $n$ \u7684\u56e0\u5b50\u4e2a\u6570\uff0c$w$ \u662f $n$ \u7684\u4e0d\u540c\u8d28\u56e0\u5b50\u4e2a\u6570\u3002\u4e8b\u5b9e\u4e0a\u7531\u4e8e $w2^w<d\\log n$ \u6240\u4ee5\u53ef\u4ee5\u5ffd\u7565\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u5076\u6570\u7684\u60c5\u51b5\uff0c\u4e4d\u4e00\u770b\u4e0b\u597d\u50cf\u53ea\u9700\u8981\u7ed9 $\\frac{t+1}2$ \u52a0\u4e2a\u53d6\u6574\u5c31\u53ef\u4ee5\u4e86\uff0c\u4f46\u6211\u4eec\u6d4b\u4e86\u4e0b\u6837\u4f8b\u53d1\u73b0\u6302\u4e86\u3002\u539f\u56e0\u662f\u628a\u5faa\u73af\u8282\u5de6\u53f3\u4e24\u534a\u5bf9\u8c03\u540e\u4ea7\u751f\u7684\u5faa\u73af\u540c\u6784\u96c6\u5408\u662f\u76f8\u540c\u7684\uff0c\u6240\u4ee5 $d$ \u4e3a\u5076\u6570\u65f6\u8fd8\u8981\u989d\u5916\u9664\u4ee5 $2$\uff0c\u4f46\u8fd9\u9020\u6210\u4e86\u4e00\u4e9b\u5c0f\u95ee\u9898\uff0c\u5c31\u662f\u63a8\u7684\u67ff\u5b50\u4e2d $d$ \u88ab\u6362\u6210\u4e86 $dt$\uff0c\u6211\u4eec\u8ba8\u8bba $t$ \u7684\u5947\u5076\uff0c\u82e5\u4e3a\u5076\u6570\uff0c\u90a3\u4e48 $2$ \u9664\u5728 $t$ \u4e0a\uff0c\u5426\u5219\u9664\u5728 $d$ \u4e0a\u3002\u4e8e\u662f\u95ee\u9898\u89e3\u51b3\uff0c\u590d\u6742\u5ea6 $O(T(n^{\\frac 14}\\log n+d\\log n))$\uff0c\u7531\u4e8e $n\\le 10^{18}$ \u65f6 $d\\le 103680$ \u6240\u4ee5\u8db3\u4ee5\u901a\u8fc7\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef unsigned long long ull;\ntypedef long long ll;\nconst int N=1e5+5; \nll T,n,k,p,pr[N/5],cntp,fact[70],cntf,s1[1<<16],s2[1<<16],f[70],cf,w[70],a[70],ans;ull seed;bool isnpr[N];vector<int> vf[N];\null rnd(){return seed^=seed<<13,seed^=seed>>43,seed^=seed<<29;}\nll mul(ll x,ll y,ll p){return (__int128)x*y%p;}\nll qpow(ll x,ll y,ll p){\n\tll res=1;\n\tfor(;y;x=mul(x,x,p),y>>=1)\n\t\tif(y&1)res=mul(res,x,p);\n\treturn res;\n}\nbool mr(ll p){\n\tif(p==1)return 0;\n\tif(p==2||p==3)return 1;\n\tll t=p-1,s=0;\n\twhile(t&1^1)s++,t>>=1;\n\tfor(int k=0;k<7;k++){\n\t\tll a=rnd()%(p-2)+1,x=qpow(a,t,p);\n\t\tif(x==1||x==p-1)continue;\n\t\tfor(int i=0;i<s-1;i++){x=mul(x,x,p);if(x==p-1)break;}\n\t\tif(x!=p-1)return 0;\n\t}\n\treturn 1;\n}\nvoid PR(ll x){\n\tif(x<N){for(int i:vf[x])fact[++cntf]=i;return;}\n\tif(mr(x)){fact[++cntf]=x;return;}\n\tll y=1,c=rnd()%(x-3)+2,z=c+1,g,cnt=0,tmp=1,lim=1;\n\twhile(y!=z){\n\t\ty=(mul(y,y,x)+c)%x,z=(mul(z,z,x)+c)%x,z=(mul(z,z,x)+c)%x,cnt++,tmp=mul(tmp,abs(y-z),x);\n\t\tif(cnt==lim){\n\t\t\tif((g=__gcd(tmp,x))!=1){PR(g),PR(x/g);return;}\n\t\t\tcnt=0,tmp=1;if(lim<128)lim<<=1;\n\t\t}\n\t}\n\tif((g=__gcd(tmp,x))!=1){PR(g),PR(x/g);return;}\n\tPR(x);\n}\nint qpow(ll x,ll y){\n\tint res=1;x%=p;\n\tfor(;y;x=1ll*x*x%p,y>>=1)\n\t\tif(y&1)res=1ll*res*x%p;\n\treturn res;\n}\nvoid upd(ll &x,ll y){if((x+=y)>=p)x-=p;}\nvoid dfs(int x,ll t){\n\tif(x==cf+1){\n\t\tint ms=0;\n\t\tfor(int i=1;i<=cf;i++)if(a[i]!=w[i])ms|=(1<<i-1);\n\t\tif(t&1)ans=(ans+1ll*qpow(k,t+1>>1)*(t%p)%p*s2[ms])%p;\n\t\telse ans=(ans+1ll*qpow(k,t>>1)*((t>>1)%p)%p*s1[ms])%p;\n\t\treturn;\n\t}\n\ta[x]=0,dfs(x+1,t);\n\tfor(a[x]=1;a[x]<=w[x];a[x]++)dfs(x+1,t*=f[x]);\n}\nint main(){\n\tfor(int i=2;i<N;i++){\n\t\tif(!isnpr[i])pr[++cntp]=i;\n\t\tfor(int j=1;j<=cntp&&i*pr[j]<N;j++){\n\t\t\tisnpr[i*pr[j]]=1;\n\t\t\tif(i%pr[j]==0)break;\n\t\t}\n\t}\n\tfor(int i=1;i<=cntp;i++)\n\t\tfor(int j=pr[i];j<N;j+=pr[i]){\n\t\t\tint t=j;\n\t\t\twhile(t%pr[i]==0)vf[j].push_back(pr[i]),t/=pr[i];\n\t\t}\n\tseed=time(0);\n\tscanf(\"%lld\",&T);\n\twhile(T--){\n\t\tscanf(\"%lld%lld%lld\",&n,&k,&p);\n\t\tcntf=0,PR(n);\n\t\tfor(int i=1;i<=cntf;i++)f[i]=fact[i];\n\t\tsort(f+1,f+cntf+1),cf=unique(f+1,f+cntf+1)-f-1,fill(w+1,w+cf+1,0);\n\t\tfor(int i=1;i<=cntf;i++)w[lower_bound(f+1,f+cf+1,fact[i])-f]++;\n\t\tfor(int i=0;i<(1<<cf);i++){\n\t\t\tll t=1;\n\t\t\tfor(int j=0;j<cf;j++)if(i&(1<<j))t*=-f[j+1];\n\t\t\ts1[i]=(t%p+p)%p,s2[i]=((t%2!=0?t:t/2)%p+p)%p;\n\t\t}\n\t\tint lim=1<<cf;\n\t\tfor(int i=1;i<lim;i<<=1)\n\t\t\tfor(int j=0;j<lim;j+=i<<1)\n\t\t\t\tfor(int k=0;k<i;k++)upd(s1[i+j+k],s1[j+k]),upd(s2[i+j+k],s2[j+k]);\n\t\tans=0,dfs(1,1);\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1643619261,
        "uid": 77174,
        "name": "FunnyCreatress",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P4607\u3010[SDOI2018]\u53cd\u56de\u6587\u4e32\u3011"
    },
    {
        "content": "\u6d1b\u8c37\u7528\u65f6 $\\text{1.13s}$\uff0cloj \u7528\u65f6 $\\text{468ms}$\uff0c\u5747\u4e3a\u5f53\u524d\u6700\u5feb\u3002\n\n\u8003\u8651\u4e00\u4e2a\u56de\u6587\u4e32\u5bf9\u7b54\u6848\u7684\u8d21\u732e\uff0c\u53d1\u73b0\u4e0e\u5176**\u6700\u5c0f\u5faa\u73af\u8282**\u6709\u5173\u3002\u8bbe\u5176\u6700\u5c0f\u5faa\u73af\u8282\u957f\u4e3a $S$\uff0c\u82e5 $S$ \u4e3a\u5947\u6570\uff0c\u5219\u8be5\u56de\u6587\u4e32\u6709 $S$ \u79cd\u8f6e\u6362\uff1b\u82e5 $S$ \u4e3a\u5076\u6570\uff0c\u5219\u8be5\u56de\u6587\u4e32\u4e0e\u53e6\u4e00\u5bf9\u5e94\u56de\u6587\u4e32**\u5171\u6709** $S$ \u79cd\u8f6e\u6362\u3002\u5219\u6700\u5c0f\u5faa\u73af\u8282\u957f\u4e3a $S$ \u7684\u56de\u6587\u4e32\u5bf9\u7b54\u6848\u6709 $w(S)=\\dfrac S{2^{[2|S]}}$ \u7684\u8d21\u732e\u3002\n\n\u8bbe $f(n)$ \u4e3a\u6700\u5c0f\u5faa\u73af\u8282\u4e3a $n$ \u7684\u56de\u6587\u4e32\u4e2a\u6570\uff0c$g(n)$ \u4e3a\u6700\u5c0f\u5faa\u73af\u8282\u4e3a $n$ \u7684**\u56e0\u6570**\u7684\u4e2a\u6570\uff0c\u7531\u4e8e $S|n$\uff0c\u53ef\u4ee5\u5f97\u5230\n$$\nans=\\sum_{d|n}w(d)f(d)\n$$\n$$\ng(n)=\\sum_{d|n}f(n)=k^{\\lceil n/2\\rceil}\n$$\n\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5f97\u5230\n$$\nf(n)=\\sum_{d|n}g(d)\\mu(\\dfrac nd)\n$$\n$$\nans=\\sum_{d|n}w(d)\\cdot \\sum_{p|d}g(p)\\mu(\\dfrac dp)\n$$\n$$\n=\\sum_{p|n}g(p)\\cdot  \\sum_{d|\\frac np}w(d\\cdot p)\\mu(d)\n$$\n\u5c1d\u8bd5\u5206\u79bb $w(d\\cdot p)$\u3002\u6ce8\u610f\u5230\u5f53\u4e14\u4ec5\u5f53 $2|d \\land 2\\nmid p$\uff0c\u5373 $2|\\dfrac np\\land 2\\nmid p$ \u65f6\u4e0d\u6ee1\u8db3 $w(d\\cdot p)=d\\cdot w(p)$\u3002\n\n\u6b64\u65f6\n$$\n\\sum_{d|\\frac np}w(d\\cdot p)\\mu(d)=p\\cdot\\sum_{d|\\frac np}w(d)\\mu(d)\n$$\n$$\n=p\\cdot\\sum_{d|\\frac np\\land \\mu(d)\\ne 0}w(d)\\mu(d)\n$$\n$$\n=p\\cdot\\sum_{d|\\frac np\\land \\mu(d)\\ne 0\\land 2\\nmid d}(w(d)\\mu(d)+w(2d)\\mu(2d))\n$$\n$$\n=p\\cdot\\sum_{d|\\frac np\\land \\mu(d)\\ne 0\\land 2\\nmid d}(w(d)\\mu(d)+w(d)\\cdot(-\\mu(d))=p\\cdot 0=0\n$$\n\u56e0\u6b64\u4e0d\u6ee1\u8db3 $w(d\\cdot p)=d\\cdot w(p)$ \u7684\u9879\u5747\u4e3a $0$\u3002\u6240\u4ee5\n$$\nans=\\sum_{d|\\frac np\\land (2|p\\lor 2\\nmid\\frac np)}g(p)w(p)\\sum_{d|\\frac np}d\\cdot \\mu(d)\n$$\n$$\n=\\sum_{d|\\frac np\\land (2|p\\lor 2\\nmid\\frac np)}g(p)w(p)\\sum_{d|\\frac np\\land \\mu(d)\\ne 0}d\\cdot \\mu(d)\n$$\n$$\n=\\sum_{d|\\frac np\\land (2|p\\lor 2\\nmid\\frac np)}g(p)w(p)\\prod_{x\\in \\text{Prime},x|\\frac np}(1-x)\n$$\n\u8bbe $t(n)=\\prod_{x\\in \\text{Prime},x|\\frac np}(1-x)$\uff0c\u5219 $ans=\\sum_{d|\\frac np\\land (2|p\\lor 2\\nmid\\frac np)}g(p)w(p)t(\\dfrac np)$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 Pollard-Rho \u5728 $O(n^{1/4})$ \u7684\u65f6\u95f4\u5185\u5c06 $n$ \u8d28\u56e0\u6570\u5206\u89e3\uff0cdfs \u679a\u4e3e\u56e0\u6570\u53ca\u5176\u6b21\u6570\u540c\u65f6\u8ba1\u7b97 $t$\uff0c$g(p)$ \u53ef\u4ee5\u5149\u901f\u5e42\u9884\u5904\u7406\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\max(d))$\u3002\n\n### code\n\n```cpp\n/*FreeTimeLove's code.\nLove has a nasty habit of disappearing over night.*/\n#include<bits/stdc++.h>\nnamespace chiptune{\n#define ll long long\n#define LD long double\n#define i7 __int128\n#define re return\n#define con continue\nusing namespace std;\ninline void ckmin(auto &a,auto b){if(b<a)a=b;}\ninline void ckmax(auto &a,auto b){if(a<b)a=b;}\nconst int N=4e4+5;\ninline ll rd(){\n\tll ans=0,f=0;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9')f^=(ch=='-'),ch=getchar();\n\twhile(ch>='0'&&ch<='9')ans=(ans<<3)+(ans<<1)+(ch^48),ch=getchar();\n\tre f?-ans:ans;\n}\nmt19937_64 rnd(chrono::system_clock::now().time_since_epoch().count());\nll mod,n,K,ans;\nint cnt,tt;\nll a[20],b[20],c[100],mi0[N],mi1[N],mi2[N],mi3[N];\ninline ll ksm(i7 x,ll k,ll m){\n\ti7 ans=1;\n\twhile(k){\n\t\tif(k&1)ans=ans*x%m;\n\t\tk>>=1,x=x*x%m;\n\t}re ans;\n}\ninline ll gcd(ll a,ll b){while(b)a%=b,a^=b^=a^=b;re a;}\nbool MR(ll n){\n\tif(n<3)re n==2;\n\tll u=n-1,t=0,s;\n\twhile(!(u&1))u>>=1,++t;\n\tfor(int i=1;i<=10;i++){\n\t\tll v=ksm(rnd()%(n-2)+2,u,n);\n\t\tif(v==1)con;\n\t\tfor(s=0;s<t&&v!=n-1;s++)v=(i7)v*v%n;\n\t\tif(s==t)re 0;\n\t}\n\tre 1;\n}\nll PR(ll n){\n\tif(!(n&1))re 2;\n\twhile(1){\n\t\tll c=rnd()%(n-1)+1;\n\t\tauto f=[=](ll x){re ((i7)x*x+c)%n;};\n\t\tll s=0,t=0,u=1,v;\n\t\tdo{\n\t\t\tfor(int i=0;i<128;i++){\n\t\t\t\tif((s=f(s))==(t=f(f(t))))break;\n\t\t\t\tif(!(v=(i7)u*llabs(t-s)%n))break;\n\t\t\t\tu=v;\n\t\t\t}\n\t\t\tll d=gcd(u,n);\n\t\t\tif(d>1)re d;\n\t\t}while(s!=t);\n\t}\n}\nvoid sol(ll n){\n\tif(n==1)re;\n\tif(MR(n)){c[++tt]=n;re;}\n\tll x=PR(n);\n\tsol(x),sol(n/x);\n}\nvoid init(ll n){\n\tmi0[0]=mi1[0]=mi2[0]=mi3[0]=1;\n\tfor(int i=1;i<=32768;i++)mi0[i]=mi0[i-1]*K%mod;\n\tfor(int i=1;i<=32768;i++)mi1[i]=mi1[i-1]*mi0[32768]%mod;\n\tfor(int i=1;i<=32768;i++)mi2[i]=mi2[i-1]*mi1[32768]%mod;\n\tfor(int i=1;i<=32768;i++)mi3[i]=mi3[i-1]*mi2[32768]%mod;\n\tcnt=tt=ans=0;\n\tif(MR(n))a[++cnt]=n,b[cnt]=1;\n\telse{\n\t\tsol(n);\n\t\tsort(c+1,c+tt+1);\n\t\tint la=0;\n\t\tfor(int i=1;i<=tt;i++)\n\t\t\tif(i==tt||c[i]!=c[i+1])a[++cnt]=c[i],b[cnt]=i-la,la=i;\n\t}\n}\ninline ll g(ll n){n=(n+1)>>1;re mi3[n>>45]*mi2[(n>>30)&32767]%mod*mi1[(n>>15)&32767]%mod*mi0[n&32767]%mod;}\nvoid dfs(int st,ll p,ll t){\n\tif(st>cnt){\n\t\tans+=(i7)g(p)*(p&1?p:p>>1)%mod*t%mod;\n\t\tre;\n\t}\n\tif(st!=1||a[st]!=2)dfs(st+1,p,(i7)t*(mod+1-a[st]%mod)%mod);\n\tfor(int i=1;i<b[st];i++)p*=a[st],dfs(st+1,p,(i7)t*(mod+1-a[st]%mod)%mod);\n\tp*=a[st],dfs(st+1,p,t);\n}\nint main(){\n\tint T=rd();\n\twhile(T--){\n\t\tn=rd(),K=rd(),mod=rd();\n\t\tK%=mod;\n\t\tinit(n);\n\t\tdfs(1,1,1);\n\t\tprintf(\"%lld\\n\",ans%mod);\n\t}\n\tre 0;\n}\n/*\n\n*/\n}int main(){re chiptune::main();}\n```\n\n> $\\text{Love has a nasty habit of disappearing over night.}$\n",
        "postTime": 1674628946,
        "uid": 346440,
        "name": "FreeTimeLove",
        "ccfLevel": 7,
        "title": "P4607 [SDOI2018]\u53cd\u56de\u6587\u4e32"
    },
    {
        "content": "\u6c42\u957f\u5ea6\u4e3a $n$\uff0c\u5b57\u7b26\u96c6\u5927\u5c0f\u4e3a $k$ \u7684\u53ef\u4ee5\u901a\u8fc7\u8f6e\u6362\u53d8\u6210\u4e00\u4e2a\u56de\u6587\u4e32\u7684\u4e32\u7684\u6570\u91cf\uff0c\u5bf9 $10^9+7$ \u53d6\u6a21\u3002$T\\leqslant 10$\uff0c$k\\leqslant n\\leqslant 10^{18}$\u3002\n\n\n\n\u6211\u4eec\u53bb\u8003\u8651\u6bcf\u4e00\u4e2a\u56de\u6587\u4e32\u7684\u8d21\u732e\u3002\u9996\u5148\u957f\u5ea6\u4e3a $n$\uff0c\u5b57\u7b26\u96c6\u5927\u5c0f\u4e3a $k$ \u7684\u56de\u6587\u4e32\u7684\u6570\u91cf\u4e3a $k^{\\lceil\\frac{n}{2}\\rceil}$\uff0c\u4f46\u662f\u7b54\u6848\u5e76\u4e0d\u662f $nk^{\\lceil\\frac{n}{2}\\rceil}$\uff0c\u56e0\u4e3a\u4e00\u4e2a\u4e32\u53ef\u80fd\u6709\u591a\u4e2a\u8f6e\u6362\u90fd\u662f\u56de\u6587\u4e32\uff0c\u4f1a\u7b97\u91cd\u3002\n\n\u6211\u4eec\u73b0\u5728\u8bbe $l$ \u4e3a\u56de\u6587\u4e32 $s$ \u7684\u6700\u77ed\u5faa\u73af\u8282\u957f\u5ea6\uff08\u8fd9\u91cc\u5fc5\u987b\u5faa\u73af\u5b8c\uff09\uff0c\u5219 $s(1,l)$ \u4e5f\u662f\u56de\u6587\u4e32\uff0c\u6211\u4eec\u8003\u8651\u6709 $s_1=s_n$\uff0c\u53c8\u56e0\u4e3a $s_n=s_l$ \u6240\u4ee5 $s_1=s_l$\uff0c\u7c7b\u4f3c\u53ef\u4ee5\u5f97\u5230\u6bcf\u4e00\u7ec4\u5bf9\u5e94\u4f4d\u7f6e\u5747\u76f8\u7b49\u3002\u540c\u65f6\u6211\u4eec\u53ef\u4ee5\u6ce8\u610f\u5230\uff0c\u4e00\u4e2a\u6700\u77ed\u5faa\u73af\u8282\u957f\u5ea6 $l$ \u7b49\u4e8e\u4e32\u957f\uff0c\u4e14 $l\\mid n$ \u7684\u56de\u6587\u4e32\u548c\u4e00\u4e2a\u957f\u4e3a $n$ \u7684\u56de\u6587\u4e32\u4e00\u4e00\u5bf9\u5e94\u3002\n\n\u6211\u4eec\u8003\u8651\u6bcf\u4e2a\u6700\u77ed\u5faa\u73af\u8282\u957f\u5ea6\u7b49\u4e8e\u4e32\u957f\u7684\u56de\u6587\u4e32 $s$ \u7684\u8d21\u732e\uff0c\u4e3a\u4e86\u65b9\u4fbf\u6211\u4eec\u79f0\u8fd9\u6837\u7684\u56de\u6587\u4e32\u662f\u597d\u7684\uff0c\u5b83\u53ef\u4ee5\u88ab\u5b9a\u4e49\u4e3a\u628a\u591a\u4e2a $s$ \u987a\u5e8f\u653e\u5230\u4e00\u8d77\u76f4\u5230\u957f\u5ea6\u4e3a $n$ \u6240\u5f97\u5230\u7684\u4e32\uff0c\u4e00\u76f4\u5411\u5de6\u5faa\u73af\u4f4d\u79fb\u76f4\u5230\u518d\u53d8\u4e3a\u4e00\u4e2a\u56de\u6587\u4e32\u7684\u6b21\u6570 $x$\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u6837\u6bcf\u4e00\u4e2a\u662f\u7b54\u6848\u7684\u4e32\u90fd\u6070\u597d\u88ab\u4e00\u4e2a\u597d\u7684\u56de\u6587\u4e32\u8ba1\u7b97\u5230\u3002\n\n\u90a3\u4e48\u6211\u4eec\u6709\u65ad\u8a00\uff0c$x=\\begin{cases}l&2\\not\\mid l\\\\\\dfrac{l}{2}&2\\mid l\\end{cases}$\u3002\u901a\u8fc7\u624b\u73a9\u4e0d\u96be\u9a8c\u8bc1\u8fd9\u4e2a\u7ed3\u8bba\uff0c\u4e5f\u53ef\u4ee5\u7b80\u5355\u8bc1\u660e\uff0c\u9996\u5148\u4e0d\u96be\u53d1\u73b0\u8fd9\u4e48\u591a\u6b21\u540e\u4e00\u5b9a\u662f\u4e00\u4e2a\u56de\u6587\u4e32\uff1b\u7136\u540e\u5047\u8bbe\u5982\u679c\u4e0d\u5230\u8fd9\u4e48\u591a\u6b21\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a\u56de\u6587\u4e32\uff0c\u90a3\u4e48\u53ef\u4ee5\u901a\u8fc7\u76f8\u7b49\u5173\u7cfb\u5f97\u5230 $s$ \u7684\u524d $l$ \u4e2a\u5b57\u7b26\u90fd\u76f8\u7b49\uff0c\u4e0e $l$ \u662f\u6700\u77ed\u5faa\u73af\u8282\u957f\u5ea6\u51b2\u7a81\u3002\n\n\u8bbe $f(m)$ \u8868\u793a\u957f\u4e3a $m$ \u7684\u597d\u7684\u56de\u6587\u4e32\u6570\u91cf\uff0c$h(m)$ \u8868\u793a\u957f\u5ea6\u4e3a $m$ \u7684\u4e32\u7684\u8d21\u732e\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f\n$$\n\\sum_{m\\mid n} f(m)h(m)\n$$\n\u6839\u636e\u4e0a\u9762\u7684\u7406\u8bba\uff0c\u957f\u4e3a $m$ \u7684\u56de\u6587\u4e32\u4e0e\u6240\u6709\u957f\u5ea6\u662f $m$ \u7684\u7ea6\u6570\u7684\u597d\u7684\u56de\u6587\u4e32\u4e00\u4e00\u5bf9\u5e94\uff0c\u6240\u4ee5\u8bbe $g(m)$ \u8868\u793a\u957f\u4e3a $m$ \u7684\u56de\u6587\u4e32\u7684\u6570\u91cf\uff0c\u5219 $g(m)=\\sum\\limits_{d\\mid m}f(d)$\uff0c\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u53ef\u77e5\uff0c\u7b54\u6848\u7b49\u4e8e\n$$\n\\begin{aligned}\n&\\sum_{m\\mid n}h(m)\\sum_{d\\mid m}g(d)\\mu(\\frac{m}{d})\\\\\n=&\\sum\\limits_{d\\mid n}g(d)\\sum_{i\\mid\\frac{n}{d}}\\mu(i)h(di)\n\\end{aligned}\n$$\n\u63a5\u4e0b\u6765\u7684\u6b65\u9aa4\u6bd4\u8f83\u795e\u4ed9\uff0c\u6211\u4eec\u53d1\u73b0\u90a3\u4e2a $h(di)$ \u5982\u679c\u80fd\u628a $i$ \u63d0\u51fa\u6765\uff0c\u90a3\u4e48\u7b2c\u4e8c\u4e2a\u6c42\u548c\u53f7\u4ee5\u540e\u53ea\u8ddf $\\dfrac{n}{d}$ \u6709\u5173\u800c\u4e14\u770b\u4e0a\u53bb\u6bd4\u8f83\u5bb9\u6613\u6c42\u51fa\u6765\u3002\u6211\u4eec\u53d1\u73b0\u5927\u90e8\u5206\u65f6\u5019 $h(di)=ih(d)$\uff0c\u800c\u7b49\u5f0f\u4e0d\u6210\u7acb\u65f6\u5f53\u4e14\u4ec5\u5f53 $i$ \u662f\u5076\u6570\u4e14 $d$ \u662f\u5947\u6570\uff0c\u6ce8\u610f\u5230\u8fd9\u79cd\u60c5\u51b5\u4e0b\u4e00\u5b9a\u6709 $\\dfrac{n}{d}$ \u662f\u5076\u6570\uff0c\u6211\u4eec\u8003\u8651\u6240\u6709 $\\mu(i)\\not=0$ \u7684\u60c5\u51b5\uff0c\u53d1\u73b0\u4efb\u610f\u4e00\u7ec4\u5947\u6570 $i$ \u548c $2i$\uff0c\u6709 $\\mu(i)=-\\mu(2i)$\uff0c$h(di)=h(2di)$\uff0c\u6240\u4ee5\u8bf4\u5bf9\u4e8e $d$ \u662f\u5947\u6570\uff0c$\\dfrac{n}{d}$ \u662f\u5076\u6570\u7684\u60c5\u51b5\uff0c\u540e\u9762\u6c42\u548c\u53f7\u662f $0$\uff0c\u6240\u4ee5\u6211\u4eec\u628a\u8fd9\u79cd\u60c5\u51b5\u8df3\u8fc7\uff0c\u5c31\u53ef\u4ee5\u628a $i$ \u63d0\u51fa\u6765\u3002\u4e8e\u662f\u6709\n$$\n\\begin{aligned}\nans=&\\sum\\limits_{d\\mid n}g(d)\\sum_{i\\mid\\frac{n}{d}}\\mu(i)h(di)\\\\\n=&\\sum_{d\\mid n}g(d)h(d)\\sum_{i\\mid \\frac{n}{d}}[2\\mid d\\or 2\\not\\mid \\frac{n}{d}]i\\mu(i)\n\\end{aligned}\n$$\n\u6839\u636e\u67d0\u5f20\u523b\u5728 DNA \u5185\u7684\u56fe\uff0c\u6211\u4eec\u6ce8\u610f\u5230 $\\sigma_0(n)$ \u6700\u5927\u53ea\u6709 $103680$\uff0c\u8fd9\u8bf4\u660e\u590d\u6742\u5ea6\u662f\u53ef\u4ee5\u5e26\u4e00\u4e2a $\\sigma_0(n)$ \u7684\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651\u5728\u679a\u4e3e $n$ \u7684\u7ea6\u6570\u65f6\u987a\u4fbf\u7b97\u51fa\u7b2c\u4e8c\u4e2a\u6c42\u548c\u53f7\u5185\u90e8\u7684\u4e1c\u897f\u3002\u6211\u4eec\u4e0d\u96be\u53d1\u73b0\u53ea\u6709\u6bcf\u4e00\u4e2a\u8d28\u56e0\u5b50 $p$ \u7b2c\u4e00\u6b21\u88ab\u52a0\u5165\u65f6\u6709\u8d21\u732e\uff0c\u5982\u679c\u5176\u6ca1\u6709\u88ab\u9009\u4e2d\uff0c\u90a3\u4e48\u8d21\u732e\u4e3a $1$\uff1b\u5982\u679c\u88ab\u9009\u4e2d\uff0c$\\mu$ \u53d6\u53cd $i$ \u4e58\u4e0a $p$\uff0c\u8d21\u732e\u4e3a $-p$ \u3002\u6240\u4ee5\u6709\n$$\n\\sum_{i\\mid m}=i\\mu(i)\\prod_{p\\in\\mathbb P,p\\mid m}(1-p)\n$$\n\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u5148\u901a\u8fc7 Pollard-Rho \u7b97\u6cd5\u5206\u89e3 $n$\uff0c\u7136\u540e dfs \u679a\u4e3e\u7ea6\u6570\uff0c\u5355\u7ec4\u6570\u636e\u590d\u6742\u5ea6 $O(\\sqrt[4]n+\\sigma_0(n)\\log n)$\u3002\n\n\u4ee3\u7801\uff08\u8bf7\u539f\u8c05\u6211\u76f4\u63a5\u7c98\u4e86\u4e0a\u53e4\u65f6\u671f\u7684 pr \u677f\u5b50\uff09\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define mul(x,y,p) ((long long)((__int128)x*y%p))\nusing namespace std;\ntypedef long long ll;\nint const base[]={2,325,9375,28178,450775,9780504,1795265022};\nll pw(ll x,ll y,ll mod)\n{\n    ll res=1;\n    while(y)\n    {\n        if(y&1)res=mul(res,x,mod);\n        x=mul(x,x,mod);\n        y>>=1;\n    }\n    return res;\n}\nbool mr(ll x)\n{\n    if(x<=1)return 0;\n    if(x==2)return 1;\n    if(!(x&1))return 0;\n    ll tmp=x-1,k=0;\n    while(!(tmp&1))tmp>>=1,k++;\n    for(int i=0;i<7;i++)\n    {\n        if(!(base[i]%x))continue;\n        ll t=pw(base[i],tmp,x),nxt;\n        for(int _=1;_<=k;_++)\n        {\n            nxt=mul(t,t,x);\n            if(nxt==1&&t!=1&&t!=x-1)return 0;\n            t=nxt;\n        }\n        if(t!=1)return 0;\n    }\n    return 1;\n}\nll f(ll x,ll c,ll p){return (mul(x,x,p)+c)%p;}\nll pr(ll x)\n{\n    ll s=0,t=0,c=rand();\n    c=c%(x-1)+1;\n    ll val=1;\n    for(int i=1;;i<<=1,s=t,val=1)\n    {\n        for(int j=1;j<i;++j)\n        {\n            t=f(t,c,x);\n            val=mul(val,abs(t-s),x);\n            if(j==127)\n            {\n                ll d=__gcd(val,x);\n                if(d>1)return d;\n            }\n        }\n        ll d=__gcd(val,x);\n        if(d>1)return d;\n    }\n    return x;\n}\nvoid Pollard_Rho(ll x,vector<ll>&v)\n{\n    if(x==1)return;\n    if(mr(x)){v.push_back(x);return;}\n    while(1)\n    {\n        ll t=pr(x);\n        if(t!=x)\n        {\n            Pollard_Rho(x/t,v),Pollard_Rho(t,v);\n            return;\n        }\n    }\n}\nll n,k,mod,ans;\nvector<pair<ll,int>>v2;\nll get(ll x)\n{\n    return pw(k,(x+1)>>1,mod)*((x&1)?x%mod:(x>>1)%mod)%mod;\n}\nvoid dfs(int x,ll nowa,ll nowb)\n{\n    if(x==v2.size())\n    {\n        if((nowa&1)||(!((n/nowa)&1)))ans=(ans+1ll*get(n/nowa)*nowb)%mod;\n        return;\n    }\n    for(int i=0;i<=v2[x].second;i++,nowa*=v2[x].first)\n        if(!i)dfs(x+1,nowa,nowb);\n        else dfs(x+1,nowa,nowb%mod*(1-v2[x].first%mod+mod)%mod);\n}\nint main()\n{\n    int _;\n    scanf(\"%d\",&_);\n    while(_--)\n    {\n        vector<ll>v;\n        scanf(\"%lld%lld%lld\",&n,&k,&mod);\n        Pollard_Rho(n,v);\n        sort(v.begin(),v.end());\n        v2.clear();ans=0;\n        for(int i=0;i<v.size();i++)\n            if((!i)||v[i]!=v[i-1])v2.push_back({v[i],1});\n            else v2[v2.size()-1].second++;\n        dfs(0,1,1);\n        printf(\"%lld\\n\",ans);\n    }\n    return 0;\n}\n```\n\n",
        "postTime": 1613827737,
        "uid": 96912,
        "name": "AzusaCat",
        "ccfLevel": 9,
        "title": "\u300cSDOI2018\u300d\u53cd\u56de\u6587\u4e32"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u4e2a\u4e0d\u5e26\u8111\u5b50\u7684\u505a\u6cd5\uff0c\u590d\u6742\u5ea6\u6bd4\u8f83\u5bc4\uff0c\u4f46\u662f\u6ca1\u5565\u601d\u7ef4\u96be\u5ea6\u3002\n\n---\n\n\u8ba9\u6240\u6709\u5408\u6cd5\u4e32\u5728\u5176\u56de\u6587\u5faa\u73af\u540c\u6784\u5904\u8ba1\u7b97\u3002\u5047\u8bbe\u6211\u4eec\u6c42\u51fa\u4e86**\u6700\u5c0f\u6b63\u5468\u671f**\u4e3a $i$ \u7684\u56de\u6587\u4e32\u4e2a\u6570\u4e3a $f_i$\uff0c\u90a3\u4e48\u7b54\u6848\u4e3a\uff1a\n\n$$\n\\sum_{i|n} i\\times \\begin{cases}\nf_i & i \\bmod 2=1 \\\\\nf_i / 2 & i \\bmod 2 = 0\n\\end{cases}\n$$\n\n\u5076\u6570\u8981\u9664 2 \u7684\u539f\u56e0\u662f\u5f62\u5982 $ss'ss'\\cdots ss'$ \u7684\u5faa\u73af\u540c\u6784 $s'ss's\\cdots s's$ \u4ecd\u7136\u662f\u4e00\u4e2a\u56de\u6587\u4e32\uff0c\u4e0d\u5e94\u8be5\u8ba1\u7b97\u4e24\u6b21\u3002\n\n\u5f53\u6a21\u6570\u4e3a\u5947\u6570\u7684\u65f6\u5019 $2$ \u6709\u9006\u5143\uff0c\u53ef\u4ee5\u76f4\u63a5\u7b97\u3002\u5426\u5219\u6a21\u6570\u4e3a\u5076\u6570\uff0c\u6b64\u65f6\u6211\u4eec\u6709\u5e38\u89c1\u5957\u8def\uff1a\n\n$$\n\\frac{f_i}{2}\\bmod P = \\frac{f_i \\bmod 2P}{2} \\bmod P\n$$\n\n$P$ \u4e3a\u5947\u6570\u7684\u65f6\u5019\u4e0d\u80fd\u7b80\u5355\u5730\u8fd9\u6837\u5904\u7406\uff08\u4f46\u662f\u53ef\u4ee5\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\uff09\uff0c\u8bfb\u8005\u4e0d\u59a8\u81ea\u884c\u601d\u8003\u539f\u56e0\u53ca\u5177\u4f53\u5b9e\u73b0\u3002\n\n---\n\n\u8fd9\u4e2a\u4e1c\u897f\u5f88\u4e0d\u597d\u7b97\uff0c\u90a3\u4e48\u6211\u4eec\u9996\u5148\u8ba1\u7b97 $g_i$ \u8868\u793a\u5b58\u5728\u6574\u5468\u671f $i$ \u7684\u56de\u6587\u4e32\u4e2a\u6570\u4e3a $g_i$\u3002\u663e\u7136\n\n$$\ng_i = k^{\\lceil i/2 \\rceil}\n$$\n\n\u63a5\u4e0b\u6765\u8003\u8651\u5df2\u77e5 $g$\uff0c\u5982\u4f55\u8ba1\u7b97 $f$\u3002\u6211\u4eec\u77e5\u9053 $f$ \u548c $g$ \u6709\u5982\u4e0b\u5173\u7cfb\uff1a\n\n$$\ng_n=\\sum_{d|n} f_n\n$$\n\n\u6b64\u65f6\u56fa\u7136\u53ef\u4ee5\u4f7f\u7528 Mobius Inversion Formula \u8fdb\u884c\u63a8\u5bfc\uff0c\u4f46\u6211\u4eec\u6709\u66f4\u52a0\u7b80\u5355\u7684\u505a\u6cd5\u3002\n\n\u5982\u679c\u5df2\u77e5 $f$\uff0c\u90a3\u4e48\u53ef\u4ee5\u7528\u9ad8\u7ef4\u524d\u7f00\u548c\u6765\u8ba1\u7b97 $g$\u3002\u5177\u4f53\u5730\uff0c\u6bcf\u4e00\u7ef4\u662f\u4e00\u4e2a\u8d28\u56e0\u5b50\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u53ef\u4ee5\u7528 FMT \u89e3\u51b3\u3002\u7b2c\u4e00\u7ef4\u679a\u4e3e\u8d28\u56e0\u5b50 $p$\uff0c\u7b2c\u4e8c\u7ef4\u4ece\u5c0f\u5230\u5927\u679a\u4e3e\u56e0\u6570 $d$\u3002\u5982\u679c $p|d$\uff0c\u90a3\u4e48\u6267\u884c $f_d \\leftarrow f_d + f_{d/p}$\u3002\n\n\u73b0\u5728\u8003\u8651\u5df2\u77e5 $g$\uff0c\u53cd\u63a8 $f$\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u5176\u5b9e\u5c31\u662f IFMT\u3002\u800c IFMT \u8fc7\u7a0b\u5c31\u662f\u628a FMT \u7684\u8fc7\u7a0b\u5012\u7740\u5199\u4e00\u904d\uff08\u5faa\u73af\u53cd\u5411\uff0c\u52a0\u6cd5\u53d8\u51cf\u6cd5\uff09\u3002\n\nFMT\uff08\u5feb\u901f\u83ab\u6bd4\u4e4c\u65af\u53d8\u6362\uff09\u7684\u9006\u6309\u7406\u8bf4\u5e94\u8be5\u79f0\u4e3a\u5feb\u901f\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u6240\u4ee5\u5176\u5b9e\u8fd9\u4e2a\u65b9\u6cd5\u672c\u8d28\u4e0a\u8fd8\u662f\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff08\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\n\nint get() {\n\tint x = 0, f = 1; char c = getchar();\n\twhile(!isdigit(c)) { if(c == '-') f = -1; c = getchar(); }\n\twhile(isdigit(c)) { x = x * 10 + c - '0'; c = getchar(); }\n\treturn x * f;\n}\n\nconst int N = 1e6 + 5;\nint n, k, P, inv2;\nmap<int, int> sum;\nunordered_map<int, int> f;\nint d[N], cnt, pri[N], tot;\n\nint qpow(int x, int y) {\n\tint res = 1; x %= P;\n\twhile(y) res = res * ((y & 1)? x : 1) % P, x = x * x % P, y >>= 1;\n\treturn res; \n}\n\nnamespace PR {\n\tconst int pri[] = { 0, 2, 3, 5, 6, 11, 13, 17, 19, 23, 29, 31, 37 };\n\tmt19937 rnd;\n\t\n\tint mul(int x, int y, int P) { return (x * y - (int)((long double)x / P * y) * P + P) % P; }\n\tint f(int x, int c, int P) { return (mul(x, x, P) + c) % P; }\n\tint gcd(int x, int y) { return y? gcd(y , x % y) : x; }\n\t\n\tint qpow(int x, int y, int P) {\n\t\tint res = 1;\n\t\twhile(y) {\n\t\t\tif(y & 1) res = mul(res, x, P);\n\t\t\tx = mul(x, x, P), y >>= 1;\n\t\t}\n\t\treturn res;\n\t}\n\t\n\tint IsPrime(int n) {\n\t\tif(n == 2) return 1;\n\t\tif(n == 1) return 0; \n\t\tint a = n - 1, b = 0;\n\t\twhile(!(a & 1)) ++b, a /= 2;\n\t\tfor(int i = 1; i <= 12; i++) {\n\t\t\tif(pri[i] % n == 0) continue;\n\t\t\tint x = qpow(pri[i], a, n), nxt;\n\t\t\tfor(int j = 1; j <= b; j++, x = nxt) {\n\t\t\t\tnxt = mul(x, x, n);\n\t\t\t\tif(nxt == 1 && (x != 1 && x != n - 1)) return 0;\n\t\t\t}\n\t\t\tif(x != 1) return 0;\n\t\t} \n\t\treturn 1;\n\t}\n\t\n\tint PollardRho(int n) {\n\t\tint s = 0, t = 0, c = (unsigned long long)(rnd() * rnd()) % (n - 1) + 1, val = 1;\n\t\tfor(int lim = 1; lim; lim <<= 1, s = t, val = 1) {\n\t\t\tfor(int i = 1; i <= lim; i++) {\n\t\t\t\tt = f(t, c, n), val = mul(val, abs(t - s), n);\n\t\t\t\tif(i % 114 == 0) {\n\t\t\t\t\tint d = gcd(n, val);\n\t\t\t\t\tif(d > 1) return d;\n\t\t\t\t}\n\t\t\t}\n\t\t\tint d = gcd(n, val);\n\t\t\tif(d > 1) return d;\n\t\t}\n\t\treturn n;\n\t}\n}\n\nvoid GetFac(int n) {\n\tif(n == 1) return;\n\tif(PR::IsPrime(n)) return sum[n]++, void();\n\tint now = n;\n\twhile(now == n) now = PR::PollardRho(n);\n\tGetFac(now), GetFac(n / now);\n}\n\nvoid dfs(int dep, int now) {\n\tif(dep == tot + 1) \n\t\treturn d[++cnt] = now, f[now] = qpow(k, (now + 1) / 2) % (2 * P), void();\n\tint pr = pri[dep], ap = sum[pri[dep]];\n\tfor(int i = 0; i <= ap; i++, now = now * pr) \n\t\tdfs(dep + 1, now);\n}\n\nvoid solve() {\n\tn = get(), k = get(), P = get(), inv2 = (P + 1) / 2;\n\t\n\tsum.clear(), tot = 0, cnt = 0, f.clear();\n\tGetFac(n);\n\tfor(auto v : sum) pri[++tot] = v.first;\n\tdfs(1, 1), sort(d + 1, d + 1 + cnt);\n\t\n    // \u6b64\u5904\u4e3a\u7c7b IFMT\n\tfor(int i = 1; i <= tot; i++)\n\t\tfor(int j = cnt; j >= 1; j--)\n\t\t\tif(d[j] % pri[i] == 0) {\n\t\t\t\t(f[d[j]] -= f[d[j] / pri[i]]) %= (2 * P);\n\t\t\t}\n\n\t// \u6700\u540e\u8ba1\u7b97\u7b54\u6848\u7684\u5206\u7c7b\u8ba8\u8bba\n\tint ans = 0;\n\tif(P % 2 == 0) {\n\t\tfor(int i = 1; i <= cnt; i++) \n\t\t\tif(d[i] & 1) ans = (ans + d[i] % P * f[d[i]] % P) % P;\n\t\t\telse ans = (ans + d[i] % P * ((f[d[i]] / 2) % P) % P) % P;\n\t\tans = (ans % P + P) % P;\n\t}\n\telse {\n\t\tfor(int i = 1; i <= cnt; i++) \n\t\t\tif(d[i] & 1) ans = (ans + d[i] % P * f[d[i]]) % P;\n\t\t\telse ans = (ans + d[i] % P * f[d[i]] % P * inv2 % P) % P;\n\t\tans = (ans % P + P) % P;\n\t}\n\tcout << ans << endl;\n}\n\nmain() {\n\tint T = get();\n\twhile(T--) solve();\n\treturn 0;\n}\n```",
        "postTime": 1650874983,
        "uid": 92254,
        "name": "Social_Zhao",
        "ccfLevel": 9,
        "title": "P4607 [SDOI2018]\u53cd\u56de\u6587\u4e32 \u4e0d\u5e26\u8111\u5b50\u505a\u6cd5"
    }
]
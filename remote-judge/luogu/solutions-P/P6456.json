[
    {
        "content": "\u7b80\u5355\u54c8\u5e0c+\u4e8c\u5206\uff0c\u4e0d\u7528 SA \u548c SAM\u3002\n\n\u770b\u5230\u6c42\u6700\u5927\u957f\u5ea6\uff0c\u5148\u4e8c\u5206\u7b54\u6848\u3002\u5bf9\u4e8e\u957f\u5ea6 $x$\uff0c\u6c42\u51fa\u6bcf\u4e00\u4e2a\u957f\u5ea6\u4e3a $x$ \u7684\u5b50\u4e32\u7684\u54c8\u5e0c\u503c\uff0c\u5224\u65ad\u662f\u5426\u6709\u4e00\u4e2a\u503c\u51fa\u73b0\u4e86\u4e24\u6b21\u3002\n\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\text{O(nlog}^\\text{2}\\text{n)}$\uff0c\u5982\u679c check \u65f6\u518d\u54c8\u5e0c\u4e00\u6b21\u5e94\u8be5\u80fd\u505a\u5230 $\\text{O(nlogn)}$\u3002\n\n\n\u53e6\u5916\uff0c\u8fd9\u9053\u9898\u5e94\u8be5\u662f\u5c5e\u4e8e\u5f31\u5316\u7248\u4e86\uff0c\u6539\u6210\u51fa\u73b0 $k$ \u6b21\u4e5f\u662f\u80fd\u505a\u7684\uff0c\u53ea\u662f check \u7684\u65f6\u5019\u7a0d\u5fae\u9ebb\u70e6\u4e00\u70b9\u3002\n\n\u4ee3\u7801\u4e3b\u8981\u957f\u5728\u7528\u4e86\u53cc\u6a21\u6570\u54c8\u5e0c\uff0c\u4f46\u5e94\u8be5\u662f\u76ee\u524d\u6700\u7b80\u5355\u7684\u505a\u6cd5\u4e86\u3002\n\n\u6709\u6ce8\u91ca\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=200010;\nconst int mod1=998244353;\nconst int mod2=1e9+7;\nconst int base1=37;\nconst int base2=39;\ninline char cread(){\n\tint x=0;\n\tchar c=getchar();\n\tfor(;!(c>='a'&&c<='z');c=getchar());\n\treturn c;\n}\npair<int,int>Tmp[maxn];\nint a[maxn];\nint n,H1[maxn],H2[maxn],Pow1[maxn],Pow2[maxn];\nint Hash1(int l,int r){\n\treturn ((H1[r]-H1[l-1]*1ll*Pow1[r-l+1])%mod1+mod1)%mod1;\n}\nint Hash2(int l,int r){\n\treturn ((H2[r]-H2[l-1]*1ll*Pow2[r-l+1])%mod2+mod2)%mod2;\n}\nbool check(int x){\n\tfor(int i=x;i<=n;i++)//\u7528Tmp\u6570\u7ec4\u5b58\u4e0b\u6240\u6709\u5b50\u4e32\u7684\u54c8\u5e0c\u503c\n\t\tTmp[i-x+1]=make_pair(Hash1(i-x+1,i),Hash2(i-x+1,i));\n\tsort(Tmp+1,Tmp+n-x+2);\n\tfor(int i=2;i<=n-x+1;i++)//\u5224\u65ad\u662f\u5426\u6709\u503c\u51fa\u73b0\u4e24\u6b21\n\t\tif(Tmp[i-1]==Tmp[i]) return 1;\n\treturn 0;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++) a[i]=cread()-'a';\n\tPow1[0]=Pow2[0]=1;\n\tfor(int i=1;i<=n;i++){\n\t\tH1[i]=(H1[i-1]*1ll*base1+a[i])%mod1;\n\t\tH2[i]=(H2[i-1]*1ll*base2+a[i])%mod2;\n\t\tPow1[i]=(Pow1[i-1]*1ll*base1)%mod1;\n\t\tPow2[i]=(Pow2[i-1]*1ll*base2)%mod2;\n\t}//\u54c8\u5e0c\n\tint l=0,r=n-1,mid;\n\twhile(r>l){//\u4e8c\u5206\u7b54\u6848\n\t\tmid=l+r+1>>1;\n\t\tif(check(mid)) l=mid;\n\t\telse r=mid-1;\n\t}\n\tprintf(\"%d\\n\",l);\n\treturn 0;\n}\n```",
        "postTime": 1644225974,
        "uid": 288716,
        "name": "lzqy_",
        "ccfLevel": 7,
        "title": "[COCI2006-2007#5] DVAPUT \u9898\u89e3"
    },
    {
        "content": "### \u524d\u8a00\n\n\u5f31\u5316\u7248\u7684\u6c42\u51fa\u73b0 $k$ \u6b21\u7684\u6700\u957f\u957f\u5ea6\u7684\u5b50\u4e32\u3002\n\n### \u601d\u8def\n\n\u52a0\u5f3a\u7248\u7684\u8be5\u9898\uff0c\u5176\u5b9e\u6b63\u89e3\u4e3a\u5355\u8c03\u961f\u5217\u4f18\u5316\u67e5\u627e\u533a\u95f4\u6700\u5c0f\u503c\u7684\u6700\u5927\u503c\uff0c\u5c31\u548c\u6ed1\u52a8\u7a97\u53e3\u7c7b\u4f3c\uff0c\u627e\u51fa $k-1$ \u4e2a\u8fde\u7eed\u7684 $\\text{height}$ \u6570\u7ec4\u7684\u6700\u5c0f\u503c\u7684\u6700\u5927\u503c\u5373\u53ef\uff0c\u6c42\u51fa $\\text{height}$ \u6570\u7ec4\u6765\u76f4\u63a5\u505a\u5373\u53ef\u3002\n\n\u8fd9\u4e2a\u662f\u6c42\u51fa\u73b0\u4e24\u6b21\u7684\uff1f\u770b\u4e00\u770b $\\text{height}$ \u6570\u7ec4\u7684\u5b9a\u4e49\uff0c$\\text{height}_i$ \u8868\u793a\u6392\u540d\u4e3a $i$ \u548c\u6392\u540d\u4e3a $i-1$ \u7684\u5b57\u4e32\u7684\u6700\u957f\u516c\u5171\u524d\u7f00\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u7684\u662f\uff0c\u4e00\u4e2a $\\text{height}$ \u6570\u7ec4\u4e2d\u662f\u5305\u542b\u4e86\u4e24\u4e2a\u540e\u7f00\u7684\u6700\u957f\u516c\u5171\u524d\u7f00\uff0c\u5f88\u663e\u7136\u7684\u53ef\u4ee5\u8003\u8651\u5957\u7528\u6a21\u677f\u6c42\u51fa $\\text{height}$ \u6570\u7ec4\uff0c\u7136\u540e\u5faa\u73af\u4e00\u904d\u53d6\u6700\u5927\u503c\u5373\u53ef\n\n### \u4ee3\u7801\u5b9e\u73b0\n\n```cpp\n/*\n\t\u6c42\u51fa\u51fa\u73b02\u6b21\u7684\u5b57\u4e32\u7684\u6700\u5927\u957f\u5ea6\n\t\u7528\u6839\u636eheight\u6570\u7ec4\u7684\u5b9a\u4e49\uff0c\u4e5f\u5c31\u662f\u6c42\u51fa\u6240\u6709\u8fde\u7eed 2-1 \u4e2aheight \u6570\u7ec4\u7684\u6700\u5c0f\u503c\u6700\u5927\u503c \n*/\n#include<algorithm>\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<stack>\n#include<cstring>\n#include<queue>\n#include<map>\nusing namespace std;\nconst int N=2e5+9;\nint rk[N<<1],sa[N],oncerk[N<<1];\nint rkid[N],id[N],height[N];\nint cnt[N];\nchar s[N];\nint b[N]; \nint n,m;\nint q[N<<1];//\u5355\u8c03\u961f\u5217\u4f18\u5316 \nint ans;\nint read()\n{\n\tint f=1,x=0;\n\tchar s=getchar();\n\twhile(s<'0'||s>'9'){if(s=='-')f=-1;s=getchar();}\n\twhile(s>='0'&&s<='9'){x=(x<<1)+(x<<3)+(s^'0');s=getchar();}\n\treturn f*x;\n}\nbool cmp(int x,int y,int len)//\u6392\u5e8f\n{\n\treturn (oncerk[x]==oncerk[y])&&(oncerk[x+len]==oncerk[y+len]);\n}\nvoid getheight()//\u6c42\u51fa height \u6570\u7ec4\n{\n\tfor(int i=1,k=0;i<=n;i++)\n\t{\n\t\tif(rk[i]==1) k=0;\n\t\telse\n\t\t{\n\t\t\tif(k) k--;\n\t\t\tint j=sa[rk[i]-1];\n\t\t\twhile(i+k<=n&&j+k<=n&&s[i+k]==s[j+k])\n\t\t\t\tk++;\n\t\t}\n\t\theight[rk[i]]=k;\n\t}\n}\nvoid SA()//SA\u7684\u677f\u5b50\n{\n\tfor(int i=1;i<=n;i++) cnt[rk[i]=s[i]]++;\n\tfor(int i=1;i<=m;i++) cnt[i]+=cnt[i-1];\n\tfor(int i=n;i>=1;i--) sa[cnt[rk[i]]--]=i;\n\tfor(int len=1,p;len<n;len<<=1)\n\t{\n\t\tp=0;\n\t\tfor(int i=n;i>n-len;i--) id[++p]=i;\n\t\tfor(int i=1;i<=n;i++) \n\t\t\tif(sa[i]>len)\n\t\t\t\tid[++p]=sa[i]-len;\n\t\t\n\t\tmemset(cnt,0,sizeof(cnt));\n\t\tfor(int i=1;i<=n;i++) cnt[rkid[i]=rk[id[i]]]++;\n\t\tfor(int i=1;i<=m;i++) cnt[i]+=cnt[i-1];\n\t\tfor(int i=n;i>=1;i--) sa[cnt[rkid[i]]--]=id[i];\n\t\t\n\t\tmemcpy(oncerk,rk,sizeof(rk));\n\t\tm=0;\n\t\tfor(int i=1;i<=n;i++)\n\t\t\trk[sa[i]]=(m+=(cmp(sa[i],sa[i-1],len)^1)); \n\t}\n\treturn;\n}\nint main()\n{\n\tn=read();\n\tscanf(\"%s\",s+1);\n\tm=max(n,300);\n\tSA();//\u9020\u540e\u7f00\u6570\u7ec4\n\tgetheight();//\u6c42height\u6570\u7ec4\n    //k>2\u53ef\u4ee5\u8003\u8651\u7528\u5355\u8c03\u961f\u5217\u4f18\u5316\uff0c\u53ea\u9700\u8981\u627e\u51fa\n    //\u6240\u6709\u8fde\u7eed\u7684k-1\u4e2aheight\u6570\u7ec4\u7684\u6700\u5c0f\u503c\u7684\u6700\u5927\u503c\u5373\u523b\n\tfor(int i=1;i<=n;i++)\n\t\tans=max(height[i],ans);\n\tprintf(\"%d\\n\",ans);\n\treturn 0; \n}\n```\n",
        "postTime": 1615693797,
        "uid": 230804,
        "name": "Durancer",
        "ccfLevel": 4,
        "title": "P6456 [COCI2006-2007#5] DVAPUT \u9898\u89e3"
    },
    {
        "content": "\u65e2\u7136 caq \u7528 [SA](https://www.luogu.com.cn/blog/230804/solution-p6456) \u8fc7\u4e86\u8fd9\u9053\u9898\uff0c\u90a3\u6211\u5c31\u6765\u53d1\u4e00\u4e0b SAM \u7684\u9898\u89e3\u5427\u3002\n\n\u6c42\u51fa\u73b0\u81f3\u5c11\u4e24\u6b21\u7684\u5b57\u7b26\u4e32\u7684\u6700\u957f\u957f\u5ea6\uff0c\u8fd9\u662f\u4e00\u4e2a SAM \u7684\u7ecf\u5178\u95ee\u9898\u3002\u663e\u7136\u53ef\u4ee5\u76f4\u63a5\u5728 parent \u6811\u4e0a dp \u6c42\u51fa\u67d0\u4e2a\u8282\u70b9\u4ee3\u8868\u5b50\u4e32\u7684\u51fa\u73b0\u6b21\u6570\uff0c\u7136\u540e\u53d6\u6ee1\u8db3\u6761\u4ef6\u7684\u6700\u5927\u503c\u3002\n\n\u7136\u800c\uff0c\u5f53\u6211\u6572\u5b8c SAM \u7684\u677f\u5b50\u7684\u65f6\u5019\uff0cMLE\uff01\u4ea4\u4e0a\u53bb\u5374\u53d1\u73b0\u7a7a\u95f4\u9650\u5236\u53ea\u6709 32M\u3002\n\n\u4e8e\u662f\u7528\u65f6\u95f4\u6362\u7a7a\u95f4\uff0c\u8003\u8651\u5230 SAM \u6700\u591a\u6709 $3n - 4$ \u6761\u8f6c\u79fb\u8fb9\uff0c\u56e0\u6b64\u6539\u4e3a\u4f7f\u7528\u94fe\u5f0f\u524d\u5411\u661f\u5b58\u56fe\uff0c\u4fee\u6539\u6216\u67e5\u627e\u7684\u65f6\u5019\u76f4\u63a5\u66b4\u529b $\\mathcal O\\left(|\\small\\sum|\\right)$ \u679a\u4e3e\u51fa\u8fb9\u3002\uff08$|\\small\\sum|$ \u8868\u793a\u5b57\u7b26\u96c6\u5927\u5c0f\uff09\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O\\left(n\\right)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int Maxn = 2e5 + 1;\n\nint ver[Maxn * 3], nxt[Maxn * 3], head[Maxn << 1], key[Maxn * 3];\nint link[Maxn << 1], len[Maxn << 1], siz[Maxn << 1], cnt = 1, last = 1, ecnt;\nvoid add(int u, int v, int w) {ecnt++; ver[ecnt] = v; key[ecnt] = w; nxt[ecnt] = head[u]; head[u] = ecnt;}\nint findkey(int u, int w) {\n\tfor(int i = head[u]; i; i = nxt[i])\n\t\tif(key[i] == w) return i;\n\treturn 0;\n}\nvoid extend(int c) {\n\tint cur = ++cnt, p = last; last = cur;\n\tlen[cur] = len[p] + 1; siz[cur] = 1;\n\twhile(p && !findkey(p, c)) add(p, cur, c), p = link[p];\n\tif(!p) {link[cur] = 1; return;}\n\tint q = ver[findkey(p, c)]; if(len[q] == len[p] + 1) {link[cur] = q; return;}\n\tint cl = ++cnt; len[cl] = len[p] + 1; link[cl] = link[q];\n\tlink[q] = link[cur] = cl; for(int i = head[q]; i; i = nxt[i]) add(cl, ver[i], key[i]);\n\tint t; while(p && ver[t = findkey(p, c)] == q) ver[t] = cl, p = link[p];\n}\n\nint rk[Maxn << 1], id[Maxn << 1], ans;\nchar ch;\n\nint main() {\n\tch = getchar(); while(!isalpha(ch)) ch = getchar(); while(isalpha(ch)) extend(ch - 'a'), ch = getchar();\n\tfor(int i = 1; i <= cnt; ++i) ++rk[len[i]];\n\tfor(int i = 1; i <= cnt; ++i) rk[i] += rk[i - 1];\n\tfor(int i = cnt; i >= 1; --i) id[rk[len[i]]--] = i;\n\tfor(int i = cnt; i >= 1; --i) {\n\t\tint cur = id[i];\n\t\tsiz[link[cur]] += siz[cur];\n\t\tif(siz[cur] > 1) ans = max(ans, len[cur]);\n\t}\n\tprintf(\"%d\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1615705515,
        "uid": 118196,
        "name": "zimujun",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P6456 \u3010[COCI2006-2007#5] DVAPUT\u3011"
    },
    {
        "content": "\u663e\u7136\uff0c\u5982\u679c\u67d0\u4e2a\u540e\u7f00\u7684 height \u503c\u4e0d\u4e3a $0$ \u90a3\u4e48\u6240\u5bf9\u5e94\u7684\u5b50\u4e32\u5c31\u81f3\u5c11\u51fa\u73b0\u4e86\u4e24\u6b21\u3002\u56e0\u4e3a height \u6c42\u7684\u662f LCP\uff0c\u6240\u4ee5\u5982\u679c\u5f53\u524d\u8fd9\u4e2a $height_i$ \u7684\u503c\u4e0d\u4e3a $0$\uff0c\u5219\u8fd9\u4e2a\u5b50\u4e32\u81f3\u5c11\u5728\u7b2c $i$ \u4e2a\u540e\u7f00\u548c\u7b2c $i-1$ \u4e2a\u540e\u7f00\u51fa\u73b0\u8fc7\uff0c\u56e0\u6b64\u81f3\u5c11\u51fa\u73b0\u4e86\u4e24\u6b21\u3002\n\n\u5229\u7528\u8fd9\u4e2a\u6027\u8d28\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa height \u6570\u7ec4\u4e2d\u7684\u6700\u5927\u503c\u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1e6+10;\nchar s[N];\nint n,m;\nint height[N];\nint sa[N],rk[N];\nint x[N],y[N],c[N];\nvoid solve_init()\n{\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tx[i]=s[i];\n\t\t++c[x[i]];\n\t}\n\tfor(int i=2;i<=m;i++) c[i]+=c[i-1];\n\tfor(int i=n;i>=1;i--)\n\t{\n\t\tsa[c[x[i]]--]=i;\n\t}\n}\nvoid solve_sa()\n{\n\tfor(int k=1;k<=n;k=k<<1)\n\t{\n\t\tint num=0;\n\t\tfor(int i=n-k+1;i<=n;i++) y[++num]=i;\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tif(sa[i]>k) y[++num]=sa[i]-k;\n\t\t}\n\t\tfor(int i=1;i<=m;i++) c[i]=0;\n\t\tfor(int i=1;i<=n;i++) c[x[i]]++;\n\t\tfor(int i=2;i<=m;i++) c[i]+=c[i-1];\n\t\tfor(int i=n;i>=1;i--)\n\t\t{\n\t\t\tsa[c[x[y[i]]]--]=y[i];\n\t\t\ty[i]=0;\n\t\t}\n\t\tswap(x,y);\n\t\tnum=1;\n\t\tx[sa[1]]=1;\n\t\tfor(int i=2;i<=n;i++)\n\t\t{\n\t\t//\tint tmp=x[sa[i]];\n\t\t\tif(y[sa[i]]==y[sa[i-1]] and y[sa[i]+k]==y[sa[i-1]+k])x[sa[i]]=num;\n\t\t\telse x[sa[i]]=++num; \n\t\t\n\t\t}\n\t\tif(num==n) break;\n\t\tm=num;\n\t}\n\tint k=0;\n\tfor(int i=1;i<=n;i++) rk[sa[i]]=i;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(rk[i]==1) continue;\n\t\tif(k) k--;\n\t\tint j=sa[rk[i]-1];\n\t\twhile(i+k<=n and j+k<=n and s[i+k]==s[j+k]) k++;\n\t\theight[rk[i]]=k;\n\t}\n}\nint ans=0;\nint main()\n{\n\tcin>>n;\n\tscanf(\"%s\",s+1);\n\tm=122;\n\tsolve_init();\n\tsolve_sa();\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tans=max(ans,height[i]); \n\t} \n\tcout<<ans<<endl;\n\treturn 0;\n} \n```",
        "postTime": 1644291785,
        "uid": 369904,
        "name": "zplqwq",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6456 [COCI2006-2007#5] DVAPUT"
    },
    {
        "content": "## Description\n\n\u9898\u76ee\u610f\u601d\u5f88\u660e\u786e\uff0c\u5728\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2d\u5bfb\u627e\u4e24\u4e2a\u76f8\u540c\u7684\u4e0d\u5728\u540c\u4e00\u4f4d\u7f6e\u7684\u6700\u957f\u7684\u5b50\u4e32\u3002\n\n\u53d1\u73b0\u8fd9\u9053\u9898\u76ee\u662f\u8f93\u51fa\u957f\u5ea6\uff0c\u4e0d\u7528\u8f93\u51fa\u5b50\u4e32\uff0c\u6240\u4ee5\u76f4\u63a5\u4e0a SA\u3002\n\n## Solution\n\n\u5f88\u663e\u7136\u6211\u4eec\u53ef\u4ee5\u6c42\u51fa\u8fd9\u4e2a\u5b57\u7b26\u4e32\u7684\u540e\u7f00\u6392\u5e8f\uff0c\u8fdb\u800c\u6c42\u51fa $\\text{Height}$ \u6570\u7ec4\u3002\n\n\u56e0\u4e3a $\\text{Height}$ \u662f\u6392\u540d\u4e3a $i$ \u7684\u540e\u7f00\u4e0e\u6392\u540d\u4e3a $i\u22121$ \u7684\u540e\u7f00\u7684\u6700\u957f\u516c\u5171\u524d\u7f00\uff0c\u6240\u4ee5\u6211\u4eec\u6309\u7167\u6a21\u677f\u6c42\u51fa $\\text{Height}$ \u6570\u7ec4\u5c31\u53ef\u4ee5\u4e86\uff0c\u6700\u540e\u5faa\u73af\u6c42\u51fa\u6700\u957f\u7684\uff0c\u4e0d\u65ad\u66f4\u65b0\u7b54\u6848\u5373\u53ef\u3002\n\n\u5b66\u4e60 SA \u7684\u8bdd\uff0c\u63a8\u8350\u4e00\u7bc7\u535a\u5ba2 [Link](https://www.cnblogs.com/luckyblock/p/14217034.html)\uff0c\u4ed6\u8bb2\u7684\u633a\u8be6\u7ec6\u7684\u3002\n\n## Code\n\n```cpp\n#include <cstdio>\n#include <cmath>\n#include <iostream>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\nconst int Maxk = 2e5 + 10;\nchar s[Maxk];\nint len_,cnt[Maxk],H[Maxk],n,m,ans;\nint rk[Maxk],sa[Maxk],tak[Maxk],tp[Maxk];\ninline int read()\n{\n\tint s = 0, f = 0;char ch = getchar();\n\twhile (!isdigit(ch)) f |= ch == '-', ch = getchar();\n\twhile (isdigit(ch)) s = s * 10 + (ch ^ 48), ch = getchar();\n\treturn f ? -s : s;\n}\nvoid Max(int &x,int y) {if(x < y) x = y;}//\u53d6\u6700\u5927 && \u8d4b\u503c\nvoid Sort()//\u8ba1\u6570\u6392\u5e8f\n{\n  for(int i = 1;i <= m;i ++) cnt[i] = 0;\n  for(int i = 1;i <= n;i ++) cnt[rk[i]] ++;\n  for(int i = 1;i <= m;i ++) cnt[i] += cnt[i - 1];\n  for(int i = n;i >= 1;i --) sa[cnt[rk[tp[i]]] --] = tp[i];\n  return; \n}\nvoid Height()//\u6c42\u51fa Height \u6570\u7ec4\n{\n  int k = 0;\n  for(int i = 1;i <= n;i ++) {\n    if(k) k --;\n    int j = sa[rk[i] - 1];\n    while(s[i + k] == s[j + k]) k ++;\n    H[rk[i]] = k;\n  }\n  return;\n}\nvoid Solve()\n{\n  m = 300;\n  for(int i = 1;i <= n;i ++) rk[i] = s[i] - '0' + 1,tp[i] = i;\n  Sort();\n  for(int w = 1,k = 0;k < n;m = k,w <<= 1) {\n\t\tk = 0;\n    for(int i = 1;i <= w;i ++) tp[++ k] = n - w + i;\n    for(int i = 1;i <= n;i ++) if(sa[i] > w) tp[++ k] = sa[i] - w;\n    Sort();\n    swap(tp,rk);\n    rk[sa[1]] = k = 1;\n    for(int i = 2;i <= n;i ++) {\n      rk[sa[i]] = (tp[sa[i - 1]] == tp[sa[i]] && tp[sa[i - 1] + w] == tp[sa[i] + w]) ? k : ++ k;\n    } \n  }\n  Height(); \n  return;\n}\nsigned main()\n{\n  n = read();\n  scanf(\"%s\",s + 1);\n  Solve();\n  for(int i = 2;i <= n;i ++) {\n    Max(ans,H[i]);//\u4e0d\u65ad\u53d6\u51fa\u6700\u5927\u503c\n  }\n  printf(\"%d\\n\",ans);\n  return 0;\n}\n```\n",
        "postTime": 1618751967,
        "uid": 381904,
        "name": "\u659c\u63fd\u6b8b\u7bab",
        "ccfLevel": 6,
        "title": "\u3010P6456 [COCI2006-2007#5] DVAPUT\u3011\u9898\u89e3"
    }
]
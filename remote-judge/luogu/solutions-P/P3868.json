[
    {
        "content": "####\u660e\u660e\u662f\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u88f8\u9898\u7adf\u7136\u6ca1\u6709\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u9898\u89e3\r\n\r\n[\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u8bb2\u89e3](https://blog.csdn.net/niiick/article/details/80229217)\r\n\r\n\u7531\u9898\u610f\u77e5\r\n\r\n\r\n $$\\left\\{\\begin{aligned}(n-a_1)\\mid b_1 \\\\ (n-a_2)\\mid b_2\\\\ ...\\\\ (n-a_k)\\mid b_k\\end{aligned}\\right.$$ \r\n\r\n\u53d8\u6362\u6210\u540c\u4f59\u65b9\u7a0b\u7ec4\u5f97\r\n\r\n$$\\left\\{\\begin{aligned}n-a_1\\equiv 0(\\mod b_1) \\\\ n-a_2\\equiv 0(\\mod b_2)\\\\ ...\\\\ n-a_k\\equiv 0(\\mod b_k)\\end{aligned}\\right.$$ \r\n\r\n\u6839\u636e\u540c\u4f59\u5f0f\u53d8\u6362\u6cd5\u5219\uff0c\r\n\r\n\u5982\u679c\u6709$a\\equiv b(\\mod m)$\uff0c\r\n\u5219$a+c\\equiv b+c(\\mod m)$\u6210\u7acb\r\n\r\n\u5c06\u4e0a\u8ff0\u65b9\u7a0b\u7ec4\u53d8\u5f62\u5f97\r\n\\begin{cases}\r\nn\\equiv a_1(\\mod b_1)\\quad \\\\\r\nn\\equiv a_2(\\mod b_2)\\quad \\\\\r\n...\\quad \\\\\r\nn\\equiv a_k(\\mod b_k)\\quad \\\\\r\n\\end{cases}\r\n\r\n $$\\left\\{\\begin{aligned}n\\equiv a_1(\\mod b_1)\\\\ n\\equiv a_2(\\mod b_2)\\\\ ...\\\\ n\\equiv a_k(\\mod b_k)\\end{aligned}\\right.$$ \r\n\r\n\u5230\u8fd9\u91cc\u5c31\u662f\u88f8\u5f97\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u4e86\r\n\u4e0d\u8fc7\u8981\u6ce8\u610f\u8ba1\u7b97\u524d\u8981\u5c06\u6240\u6709$a[i]=(a[i]\\mod b[i]+b[i])\\mod b[i];$\r\n\r\n\u53e6\u5916\u8fd9\u9898\u51fa\u9898\u4eba\u7528(sang)\u5fc3(xin)\u826f(bing)\u82e6(kuang)\r\n\u8981\u7528\u5feb\u901f\u4e58\uff0c\u4e0d\u7136\u6700\u540e\u4e00\u4e2a\u70b9\u7206long long\r\n**********************\r\n\r\n```\r\n#include<iostream>\r\n#include<cstdio>\r\n#include<vector>\r\n#include<queue>\r\n#include<algorithm>\r\n#include<cstring>\r\nusing namespace std;\r\ntypedef long long lt;\r\n\r\nlt read()\r\n{\r\n    lt f=1,x=0;\r\n    char ss=getchar();\r\n    while(ss<'0'||ss>'9'){if(ss=='-')f=-1;ss=getchar();}\r\n    while(ss>='0'&&ss<='9'){x=x*10+ss-'0';ss=getchar();}\r\n    return x*f;\r\n}\r\n\r\nint k;\r\nlt a[20],b[20];\r\n\r\nlt qmul(lt a,lt b,lt mod)\r\n{\r\n    lt ans=0;\r\n    while(b>0)\r\n    {\r\n        if(b&1) ans=(ans+a)%mod;\r\n        a=(a+a)%mod;\r\n        b>>=1;\r\n    }\r\n    return ans;\r\n}\r\n\r\nvoid exgcd(lt a,lt b,lt &x,lt &y)\r\n{\r\n    if(b==0){ x=1; y=0; return;}\r\n    exgcd(b,a%b,x,y);\r\n    int tp=x;\r\n    x=y; y=tp-a/b*y;\r\n}\r\n\r\nlt china()\r\n{\r\n    lt ans=0,lcm=1,x,y;\r\n    for(int i=1;i<=k;++i) lcm*=b[i];\r\n    for(int i=1;i<=k;++i)\r\n    {\r\n        lt tp=lcm/b[i];\r\n        exgcd(tp,b[i],x,y);\r\n        x=(x%b[i]+b[i])%b[i];\r\n        ans=(ans+qmul(qmul(tp,x,lcm),a[i],lcm))%lcm;//\u8bb0\u5f97\u5feb\u901f\u4e58\r\n    }\r\n    return (ans+lcm)%lcm;\r\n}\r\n\r\nint main()\r\n{\r\n    k=read();\r\n    for(int i=1;i<=k;++i) a[i]=read();\r\n    for(int i=1;i<=k;++i) b[i]=read();\r\n    for(int i=1;i<=k;i++) a[i]=(a[i]%b[i]+b[i])%b[i];\r\n    cout<<china();\r\n    return 0;\r\n    //niiick\r\n}\r\n```",
        "postTime": 1525690752,
        "uid": 60885,
        "name": "niiick",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3868 \u3010[TJOI2009]\u731c\u6570\u5b57\u3011"
    },
    {
        "content": "\u6211\u6254\uff1ahttps://www.luogu.org/problemnew/show/P3868\n\n\n\n# [\u5728blog\u4f53\u9a8c\u597d\u5f88\u591a\u54e6\uff08\u771f\u7684\uff09](https://blog.csdn.net/qq_38944163/article/details/85677874)\n\n\n### \u9898\u610f\n![233](https://i.loli.net/2019/01/03/5c2d6f94bdd9b.png)\n\n\n\u5c31\u662f\u6c42\u8fd9\u4e2a $x$\n\n\u88f8\u7684\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\uff0c\u4ec0\u4e48\uff1f\u4f60\u4e0d\u77e5\u9053\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u3002\u597d\u5427\uff0c\u6211\u8bb2\u8bb2\u3002\n\n\u9996\u5148\uff0c\u770b\u4e0a\u9762\u90a3\u4e00\u5768\u5f0f\u5b50\uff0c\u8981\u6ee1\u8db3\n\n#### $m_1, m_2, m_3, ...., m_k$\u4e24\u4e24\u4e92\u8d28 \n\n\u90a3\u4e48\u6211\u4eec\u8bbe\n\n$M = m1 \\times m2 \\times m3 \\times .... \\times mk$\n\n$M_i = M / m_i$\n\n\u5219\u5bf9\u4e8e$x \\equiv  a_i  (\\mod  m_i)$, \u6211\u4eec\u53ef\u4ee5\u5148\u6c42\u51fa\n\n$M_i$ \u5728 $\\mod m_i$ \u610f\u4e49\u4e0b\u7684\u9006\u5143\uff08\u6269\u6b27\u5c31\u884c\u4e86\uff09\n\n\u8bbe\u9006\u5143\u4e3a$M_i^{-1}$\n\n\u53ef\u5f97$M_i \\times M_i^{-1} \\equiv  1 (\\mod m_i)$ \n\n\u6240\u4ee5$a_i \\times M_i \\times M_i^{-1} \\equiv  a_i (\\mod m_i)$\n\n\u53c8\u56e0\u4e3a $M_i = M / m_i$\n\n\u6240\u4ee5\u5bf9\u4e8e\u6240\u6709\u7684 $j \\neq i$ ($j$ \u4e0d\u7b49\u4e8e $i$\uff09\n\n $a_i \\times M_i  \\times M_i^{-1} \\equiv 0(\\mod m_j)$\n \n \u6240\u4ee5\u53ea\u9700\u8981\u628a\u6240\u6709\u7684 $a_i \\times M_i \\times M_i^{-1}$ \u52a0\u8d77\u6765\u5c31\u662f\u7b54\u6848\u4e86\n \n\n```cpp\nint crt(){\n    int M = 1, x, y, ans = 0;\n    for(int i = 1; i <= n; i ++) M = M * b[i]; //\u6c42M\n    for(int i = 1; i <= n; i ++){\n        int m = M / b[i]; //\u5373Mi\n        exgcd(b[i], m, x, y); //\u6c42\u9006\u5143\uff0c\u6c42\u5f97\u4e3ay\n        ans =(ans + y * m * a[i]) % M;//\u7d2f\u52a0\u7b54\u6848\n    }\n    if(ans < 0) ans += M;//\u5224\u65ad\u4e00\u4e0b\n    return ans;\n}\n```\n\u90a3\u5bf9\u4e8e\u8fd9\u9898\u5462\uff1f\n\n~~Ctrl + c  + Ctrl + v~~ \n\n\u76f4\u63a5\u5957\u677f\u5b50?\n\n## ${\\color{red} WA \\ on \\ \\#10}$\n## ${\\color{white} WTF??}$\n # \uff1f\uff1f\uff1f\uff1f\n \u6ce8\u610f\u9898\u76ee\u4e2d\u7684\u4e00\u53e5\u8bdd\n #### \u6240\u6709\u6570\u636e\u4e2d\uff0c\u7b2c\u4e00\u7ec4\u6570\u5b57\u7684\u7edd\u5bf9\u503c\u4e0d\u8d85\u8fc7$10^9$\uff08\u53ef\u80fd\u4e3a\u8d1f\u6570\uff09\uff0c\u7b2c\u4e8c\u7ec4\u6570\u5b57\u5747\u4e3a\u4e0d\u8d85\u8fc7$6000$\u7684\u6b63\u6574\u6570\uff0c\u4e14\u7b2c\u4e8c\u7ec4\u91cc\u6240\u6709\u6570\u7684\u4e58\u79ef\u4e0d\u8d85\u8fc7$10^{18}$\n # $10^{18}$ ??!!  \u4e58\u8d77\u6765\u4e0d\u5c31 $10^{36}$ \u7206long long\u8fa3\n \n \u90a3\u600e\u4e48\u529e\n \n \u4e8e\u662f\u5c31~~\u7ffb\u9898\u89e3~~\u5b66\u4e60\u4e86\u4e00\u4e2a\u53eb\u505a\u5feb\u901f\u4e58\u7684\u4e1c\u897f\u3002\n \n\u5feb\u901f\u4e58\u5c31\u662f\u7528\u6765\u5904\u7406\u5728\u7206long long ~~\u7684\u8fb9\u7f18\u6765\u56de\u8bd5\u63a2~~ \u7684\u4e58\u6cd5\u4e0b\u8981\u53d6\u6a21\u7684\u4e00\u79cd~~\u9a9a~~\u64cd\u4f5c\n\n~~\u5176\u5b9e\u5e94\u8be5\u53eb\u505a\u9f9f\u901f\u4e58~~\n\n\u6838\u5fc3\u601d\u60f3\u5c31\u662f\u628a\u4e00\u4e2a\u6570\u6309\u4e8c\u8fdb\u5236\u62c6\u5206\uff0c\u7136\u540e\u4e00\u4f4d\u4e00\u4f4d\u5bf9\u5e94\u4e58\u3002\n\n\u770b\u4ee3\u7801\u611f\u6027\u7406\u89e3\u4e00\u4e0b\u5427\uff1a\n```cpp\nint ksc(int a, int b, int mod){\n\tint ans = 0;\n\tfor(;b; b >>= 1, a = (a + a) % mod) if(b&1) ans = (ans + a) % mod;\n\t//\u89e3\u91ca\u4e00\u4e0b, \u662f\u628a b \u6309\u4e8c\u8fdb\u5236\u4f4d\u62c6\u5206\uff0c a = a + a \u5c31\u662f\u6bcf\u6b21\u5c06 a \u4e58 2\uff08b\u6bcf\u6b21\u96642\uff0c a\u80af\u5b9a\u8981\u5bf9\u5e94\u4e582\u561b\uff09\n\t//\u5982\u679cb\u5f53\u524d\u4f4d\u4e3a1\uff0c\u5c31\u5bf9\u7b54\u6848\u6709\u8d21\u732e\n\treturn ans;\n}\n```\n\u7136\u540e\u8fd9\u9898\u5c31\u89e3\u51b3\u4e86\n\n# ${\\color{red} ma?}$\n\n## ${\\color{blue} TLE \\ on \\ \\# 2}$\n# ${\\color{white} WTF???}$\n\u54e6\uff0c\u5fd8\u8bb0\u8bf4\u4e86\uff0c~~\u7531\u4e8e\u51fa\u9898\u4eba\u592a\u6bd2\u7624~~ \u8f93\u5165\u7684$a_i$\u53ef\u80fd\u4e3a\u8d1f\u6570\uff0c\u6240\u4ee5\u5728\u505a\u5feb\u901f\u4e58\u4e4b\u524d\u8981\u628a\u5b83\u8f6c\u4e3a\u6b63\u6570\n\n\n\u6ca1\u4e86\uff1f\n\n\u6ca1\u4e86\u3002\n\n\u7b49\u7b49\u5fd8\u8bb0\u8d34\u4ee3\u7801\u4e86\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint exgcd(int a, int b, int &x, int &y){//\u6269\u6b27 \n\tif(!b) {x = 1, y = 0; return a;}\n\tint d = exgcd(b, a % b, x, y);\n\tint t = x;\n\tx = y;\n\ty = t - a / b * y;\n\treturn d;\n}\nint ksc(int a, int b, int mod){//\u5feb\u901f\u4e58 \n\tint ans = 0;\n\tfor(;b; b >>= 1, a = (a + a) % mod) if(b&1) ans = (ans + a) % mod;\n\treturn ans;\n}\nint a[15], b[15], n;\nint crt(){\n\tint M = 1, x, y, ans = 0;\n\tfor(int i = 1; i <= n; i ++) M = M * b[i];//\u7b97 M \n\tfor(int i = 1; i <= n; i ++){\n\t\tint m = M / b[i];\n\t\texgcd(b[i], m, x, y);//\u6c42\u9006\u5143 \n\t\ty = (y % b[i] + b[i]) % b[i];\n\t\tans =(ans + ksc(y, ksc(m, (a[i] + M) % M, M), M) + M) % M;//\u5feb\u901f\u4e58\uff0c\u8bb0\u5f97a[i]\u8981\u8f6c\u4e3a\u6b63\u6570 \n\t}\n\tif(ans < 0) ans += M;\n\treturn ans;\n}\n main(){\n\tscanf(\"%lld\", &n);\n\tfor(int i = 1; i <= n; i ++) scanf(\"%lld\", &a[i]);\n\tfor(int i = 1; i <= n; i ++) scanf(\"%lld\", &b[i]);\n\tprintf(\"%lld\", crt());\n\treturn 0;\n}\n```\n\n## ${\\color{white} enough?}$\n\n ~~\u6211\u662f\u4e0d\u4f1a\u544a\u8bc9\u4f60\u4eec\u7a7a\u767d\u7684\u5730\u65b9\u8fd8\u6709\u5b57\u7684~~\n",
        "postTime": 1546481344,
        "uid": 31656,
        "name": "lomit",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3868 \u3010[TJOI2009]\u731c\u6570\u5b57\u3011"
    },
    {
        "content": "# P3868 [TJOI2009]\u731c\u6570\u5b57\n#### [_\u4f20\u9001\u95e8_](https://www.luogu.com.cn/problem/P3868)\n\n$\\texttt{CRT}$ \u7684\u9898\u600e\u4e48\u80fd\u4e0d\u6765\u4e71\u641e\u5462\uff1f\n\n\u8fd9\u79cd\u5199\u6cd5\u5f88\u7b80\u5355\uff0c\u601d\u7ef4\u96be\u5ea6\u4e5f\u4e0d\u9ad8\uff0c\u4e5f\u4e0d\u9700\u8981\u7528\u5230\u5feb\u901f\u4e58\u3002\n## \u601d\u8def\n\u6211\u4eec\u53ef\u4ee5\u5c06\u9898\u76ee\u4e2d\u7684\u8981\u6c42\u8f6c\u5316\u4e3a\u4e00\u4e2a\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u7ec4\uff1a\n$$\\begin{cases}n\\equiv a_1(\\mod b_1)\\\\n\\equiv a_2(\\mod b_2)\\\\n\\equiv a_3(\\mod b_3)\\\\...\\\\n\\equiv a_k(\\mod b_k)\\end{cases}$$\n\u6ce8\u610f\u8fd9\u91cc\u7684 $a_i$ \u8981\u5148\u5bf9 $b_i$ \u53d6\u6a21.\n\n\u7531\u4e8e $b_i$ \u4e24\u4e24\u4e92\u8d28\uff0c\u6211\u4eec~~\u663e\u7136\u5730~~\u53ef\u4ee5\u4f7f\u7528 $\\texttt{CRT}$\uff0c\u4f46\u662f\u4e0d\u60f3\u5199\u600e\u4e48\u529e\uff1f\n\n\u4e8e\u662f\u6211\u4eec\u6765\u4e71\u641e\u3002\n\n\u6211\u4eec\u4f9d\u6b21\u5904\u7406\u6bcf\u4e2a\u540c\u4f59\u6761\u4ef6\uff0c\u8bbe\u73b0\u5728\u5904\u7406\u5230\u7b2c $i$ \u4e2a\u6761\u4ef6\uff0c\u6700\u5c0f\u7684\u6ee1\u8db3\u524d $i$ \u6761\u6761\u4ef6\u662f\u6570\u4e3a $s$.\n\n\u663e\u7136\uff0c\u5f53 $i=1$ \u65f6\uff0c$s=a_1$.\n\n\u73b0\u5728\u8003\u8651\u63a8\u8fdb\u81f3 $i=2$\uff0c\u5982\u679c $s$ \u5df2\u7ecf\u4e0e $a_2$ \u5728\u6a21 $b_2$ \u610f\u4e49\u4e0b\u540c\u4f59\uff0c\u5c31\u4e0d\u64cd\u4f5c\uff0c\u7ee7\u7eed\u8df3\u5230 $i=3$\uff1b\u5426\u5219\uff0c\u6211\u4eec\u9700\u8981\u66f4\u65b0 $s$ \u4ee5\u6ee1\u8db3\u6761\u4ef6 $2$\uff0c\u6b64\u65f6\u6211\u4eec\u4ecd\u7136\u8981\u6ee1\u8db3\u6761\u4ef6 $1$\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u53ea\u80fd\u5c06 $s$ \u52a0\u4e0a $b_1$ \u7684\u6574\u6570\u500d\u4ee5\u6ee1\u8db3\u6761\u4ef6 $2$.\n\n\u540c\u7406\u5f53 $i=3$ \u4e14 $s$ \u4e0d\u6ee1\u8db3\u6761\u4ef6 $3$ \u65f6\uff0c\u53ea\u80fd\u52a0\u4e0a\u4e00\u4e2a\u6570 $l\\equiv a_1(\\mod b_1)$ \u4e14 $l\\equiv a_2(\\mod b_2)$ \u7684\u6574\u6570\u500d.\n\n\u6240\u4ee5\uff0c\u5f53\u5904\u7406\u7b2c $i$ \u4e2a\u6761\u4ef6\u65f6\uff0c$s$ \u6240\u80fd\u52a0\u4e0a\u7684\u53ea\u80fd\u662f $\\texttt{lcm}(b_1,b_2,b_3,...,b_{i-1})$\u3002\u56e0\u4e3a $\\gcd(b_1,b_2,b_3,...,b_{i-1})=1$\uff0c\u6240\u4ee5 $\\texttt{lcm}(b_1,b_2,b_3,...,b_{i-1})=\\prod\\limits_{j=1}^{i-1}b_j$.\n\n\u7531\u4e8e\u6ee1\u8db3\u6761\u4ef6\u65f6\u52a0\u6570\u7684\u6b21\u6570\u4e0d\u6e05\u695a\uff08~~\u5176\u5b9e\u662f\u6211\u4e0d\u4f1a\u8bc1~~\uff09\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O\\texttt{(\u7384\u5b66\u80fd\u8fc7)}$ .\n\n\u63a5\u4e0b\u6765\u7ed9\u51fa\u4ee3\u7801\u3002\n\n$Code:$\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nnamespace IO{\n\t//read()\n}using namespace IO;\nll a[11],b[11];\nint main(){\n\tint n=read();\n\tfor(int i=1;i<=n;i++){\n\t\ta[i]=read();\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tb[i]=read();\n\t\ta[i]=(a[i]%b[i]+b[i])%b[i];\n\t}\n\tll sum=b[1],ans=a[1];\n\tfor(int i=2;i<=n;i++){\n\t\tfor(;ans%b[i]!=a[i];ans+=sum);\n\t\tsum*=b[i];\n\t}\n\tprintf(\"%lld\",ans);\n}\n```\n\u4e0d\u8fc7\u8fd9\u79cd\u505a\u6cd5\u53ea\u80fd\u89e3\u51b3 $b$ \u6570\u7ec4\u4e92\u8d28\u7684\u60c5\u51b5\uff0c$b$ \u6570\u7ec4\u4e0d\u4e92\u8d28\u5c31\u53ea\u80fd\u5b89\u5fc3\u5199 $\\texttt{EXCRT}$ \u4e86\u3002\n\n\u518d\u89c1\u4e86 $qwq$~",
        "postTime": 1611570516,
        "uid": 365127,
        "name": "cyffff",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3868 \u3010[TJOI2009]\u731c\u6570\u5b57\u3011"
    },
    {
        "content": "90\u5206WA\u7b2c\u4e8c\u4e2a\u70b9\u7684\u770b\u8fc7\u6765\uff01\n\n\u7b80\u8981\u4ecb\u7ecd\u4e00\u4e0b\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\n\n\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\uff0c\u5c31\u662f\u7528\u6765\u6c42\u89e3\u8fd9\u6837\u7684\u95ee\u9898\uff1a\n\n\u5047\u5b9a\u4ee5\u4e0b\u51fa\u73b0\u6570\u90fd\u662f\u81ea\u7136\u6570\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u7ec4\uff08\u5176\u4e2d$\\forall i,j\\in[1,k],i\\neq j,b_i$\u4e0e$b_j$\u4e92\u8d28\uff09\n\n$\\begin{cases}n\\equiv a_1(\\mod b_1)\\\\n\\equiv a_2(\\mod b_2)\\\\......\\\\n\\equiv a_k(\\mod b_k)\\end{cases}$\n\n\u8bbe$lcm=\\prod_{i=1}^kb_i$\uff0c\u90a3\u4e48\u6b64\u65b9\u7a0b\u7ec4\u5728\u6a21$lcm$\u610f\u4e49\u4e0b\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a\u89e3$\\sum_{i=1}^ka_ix_i\\frac{lcm}{b_i}$\uff0c\u5176\u4e2d$\\frac{lcm}{b_i}x_i\\equiv1(\\mod b_i)$\n\n\u8bc1\u660e\u601d\u8def\u4ec0\u4e48\u7684\u770b\u522b\u7684\u5927\u4f6c\u7684\u5427\n\n\u90a3\u4e48\u5c31\u53ef\u4ee5\u76f4\u63a5\u7528\u6269\u6b27\u6216\u6b27\u62c9\u5b9a\u7406\u6c42$x_i$\uff0c\u8f7b\u677e\u5730\u5f97\u5230\u7ed3\u679c\u3002\n\n\u7531\u4e8e\u76f4\u63a5\u4e58\u7684\u65f6\u5019\u4f1a\u7206longlong\uff0c\u6240\u4ee5\u8981\u5199\u5feb\u901f\u4e58\uff0c\u53ca\u65f6\u53d6\u6a21\n\n\u53ef\u662f\u8fd8WA\u7b2c\u4e8c\u4e2a\u70b9\u662f\u600e\u4e48\u56de\u4e8b\uff1f\n\n\u539f\u6765\u9898\u76ee\u91cc\u8bf4\u4e86$a_i$\u53ef\u80fd\u4e3a\u8d1f\u6570\uff01\u771f\u662f\u7528(sang)\u5fc3\u826f(bing)\u82e6(kuang)\u554a\uff01\n\n\u65e2\u7136\u662f\u6a21$b_i$\u610f\u4e49\u4e0b\u7684\uff0c\u53ef\u4ee5\u5f88\u5feb\u628a\u5b83\u8f6c\u6210\u6b63\u6570\u3002\n```\n#include<cstdio>\n#define LL long long\n#define in(x) scanf(\"%lld\",x)\n#define add(a,b) a=(a+b)%s\nLL k,a[11],b[11],i,x,y,t,s=1,ans=0;\nvoid exgcd(LL a,LL b){//\u6269\u6b27\n\tif(!b){x=1;y=0;return;}\n\texgcd(b,a%b);\n\tt=x;x=y;y=t-a/b*y;\n}\nLL mul(LL a,LL b){//\u5feb\u901f\u4e58\n\tLL r=0;\n\twhile(b){\n\t\tif(b&1)add(r,a);\n\t\tadd(a,a);\n\t\tb>>=1;\n\t}\n\treturn r;\n}\nint main(){\n\tin(&k);\n\tfor(i=1;i<=k;++i)in(a+i);\n\tfor(i=1;i<=k;++i)in(b+i),s*=b[i];//\u6c42lcm\n\tfor(i=1;i<=k;++i){\n\t\texgcd(s/b[i],b[i]);\n\t\tx=(x%b[i]+b[i])%b[i];//\u6c42xi\u6700\u5c0f\u975e\u8d1f\u6574\u6570\u89e3\n\t\tadd(ans,mul(s/b[i]*x,(a[i]%b[i]+b[i])%b[i]));//\u522b\u5fd8\u5904\u7406ai\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n\u4ee5\u4e0a\u7684main\u51fd\u6570\u91cc\uff0c\u849f\u84bb\u628a$x_i,a_i$\u90fd\u5316\u6210\u4e86\u6700\u5c0f\u975e\u8d1f\u6574\u6570\u3002\u5b9e\u9645\u4e0a\uff0c\u540c\u4f59\u7684\u6027\u8d28\u5f88\u597d\uff0c\u7528\u4e0d\u7740\u5316\u6765\u5316\u53bb\u7684\u3002\u6700\u7cbe\u7b80\u7684\u5199\u6cd5\u662f\u8fd9\u6837\n```\n\tfor(i=1;i<=k;++i){\n\t\texgcd(s/b[i],b[i]);\n\t\tadd(ans,mul(s/b[i]*x,a[i]%b[i]+b[i]));\n\t}\n```",
        "postTime": 1528352132,
        "uid": 61325,
        "name": "FlashHu",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3868 \u3010[TJOI2009]\u731c\u6570\u5b57\u3011"
    },
    {
        "content": "\u4e00\u9053\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u4e5f\u5c31\u662f CRT \u7684\u88f8\u9898\uff0c\u4f46\u662f\u51fa\u9898\u4eba\u5f88 bjwd \u641e\u51fa\u4e86\u5947\u5947\u602a\u602a\u7684\u5751/baojin  \n\u95f2\u8bdd\u5c11\u8bf4\uff0c\u5207\u5165\u6b63\u9898\u2014\u2014  \n\n---\n\u9898\u76ee\u6c42\u4e00\u4e2a\u6700\u5c0f\u7684\u6ee1\u8db3\u4ee5\u4e0b\u8fd9\u4e9b\u7ea6\u675f\u6761\u4ef6\u7684 $n$\uff0c\u4e14 $b$ \u4e24\u4e24\u4e92\u8d28\u3002\n$$\\begin{cases}b_1|(n - a_1)\\\\b_2|(n-a_2)\\\\\\dots\\\\b_k|(n-a_k)\\end{cases}$$\n\n\n\u90a3\u4e48\u663e\u7136\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u6761\u4ef6 $b_i | (n - a_i)$\uff0c\u53ef\u4ee5\u5c06\u5176\u6539\u5199\u6210 $b_i \\times g + a_i = n$\u3002  \n\u6211\u4eec\u4e0d\u96be\u628a\u8fd9\u4e2a\u5f0f\u5b50\u6539\u6210\u4e00\u4e2a\u53d6\u4f59\u7684\u5f0f\u5b50\u3002  \n\u5173\u7cfb\u4e5f\u5c31\u51fa\u6765\u4e86\uff0c$n \\equiv a_i \\pmod{b_i}$\u3002  \n\u7136\u540e\u8fd9\u4e2a\u6761\u4ef6\u5c31\u80fd\u5199\u6210\u2014\u2014  \n$$\\begin{cases} n \\equiv a_1 \\pmod{b_1}\\\\n\\equiv a_2 \\pmod{b_2}\\\\\\dots\\\\n\\equiv a_k \\pmod{b_k} \\end{cases}$$    \n$b$ \u4e24\u4e24\u4e92\u8d28\u3002  \n\u8bf6\u8fd9\u4e0d\u662f CRT \u677f\u5b50\u5417\uff1f  \n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u7528 CRT \u677f\u5b50\u6109\u5feb\u7684\u5207\u6389\u8fd9\u9053\u6c34\u9898\u3002  \n\n---\n\u5207\u4e86\uff1f\u4e0d\u4e0d\u4e0d\u60f3\u591a\u4e86\u3002  \n\u9996\u5148\u5982\u679c\u4f60\u628a P1495 \u8fd9\u9053\u9898\u7684\u4ee3\u7801\u6539\u4e2a\u8f93\u5165\u641e\u8fdb\u53bb\u4f1a WA on 10\uff0c\u56e0\u4e3a\u6700\u540e\u4e00\u4e2a\u70b9\u7206 long long \u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u7528\u9f9f\u901f\u4e58\u3002  \n\u7136\u540e\u4f60\u5c31\u4f1a\u53d1\u73b0\u5355\u7eaf\u7684\u7528\u9f9f\u901f\u4e58\u6539\u5199\u8ba1\u7b97\u5f0f\u5b50\u540e\u4f1a TLE 8 \u4e2a\u70b9\uff0c\u56e0\u4e3a exgcd \u6c42\u51fa\u7684 $x$ \u53ef\u80fd\u662f\u8d1f\u6570\u3002\u3002\u3002  \n\u7136\u540e\u4f60\u4ec5\u4ec5\u628a $x$ \u6539\u6210 $[(x \\mod M + M) + M]\\mod M$ \u540e\u53d1\u73b0\u4f1a T \u6389\u4e00\u4e2a\u70b9\uff0c\u6700\u540e\u4f60\u53d1\u73b0\u4e86\u4e00\u4e2a\u6761\u4ef6\u2014\u2014  \n\n> $\\left| a_i \\right| \\le 10 ^9$  \n\n\u8bf6\u4e0d\u662f\uff0c\u7edd\u5bf9\u503c\uff0c\u8fd9\u4e2a $a_i$ \u53ef\u80fd\u662f\u4e2a\u8d1f\u6570\u7136\u540e\u9f9f\u901f\u4e58\u7684\u65f6\u5019\u70b8\u6389\u4e86\uff1ff***  \n\u51fa\u9898\u4eba\uff0cbjwd  \n~~\u4f60\u7684\u51b3\u5fc3\u788e\u4e86\u4e00\u5730~~\n\n---\n\u4ee3\u7801\u5f88\u7b80\u5355\uff0c\u5b8c\u5168\u5c31\u662f CRT \u677f\u5b50\u3002\u53ea\u8981\u6ce8\u610f\u51e0\u4e2a\u9f9f\u901f\u4e58\u7684\u5c0f\u7ec6\u8282\u5c31\u597d\u4e86\u3002  \n\n```cpp\n#include <cstdio>\n#define int long long//long long\uff0c\u6211\u61d2\u6240\u4ee5 define \u4e86\u4e00\u4e0b\n#define MAXN 100000\nusing namespace std;\nint a[MAXN + 10], m[MAXN + 10], n;\nint exgcd(int a, int b, int &x, int &y) {//exgcd \u677f\u5b50\u7528\u4e8e CRT \u6c42\u9006\u5143\n\tif(!b) {\n\t\tx = 1, y = 0;\n\t\treturn a;\n\t}\n\telse {\n\t\tint ret, temp;\n\t\tret = exgcd(b, a % b, x, y);\n\t\ttemp = x, x = y, y = temp - a / b * y;\n\t\treturn ret;\n\t}\n}\nint mul(int a, int b, int M) {//\u4e07\u6076\u4e4b\u6e90\u9f9f\u901f\u4e58\n\tint ans = 0;\n\twhile(b) {\n\t\tif(b & 1) ans = (ans + a) % M;\n\t\ta = (a + a) % M, b >>= 1;\n\t}\n\treturn ans;\n}\nint CRT(int n) {//CRT \u677f\u5b50\n\tint M = 1, x, y, ans = 0;\n\tfor(int p = 1; p <= n; p++)\n\t\tM *= m[p];\n\tfor(int p = 1; p <= n; p++) {\n\t\tx = y = 0;\n\t\texgcd(M / m[p], m[p], x, y);\n\t\tint M_ = M / m[p]; x = ((x % M + M) + M) % M;//x \u53ef\u80fd\u662f\u8d1f\u6570\n\t\tans = (ans + mul(mul(M_, a[p], M), x, M) + M) % M;//\u9f9f\u901f\u4e58\u6539\u5199\u540e\u7684\u5f0f\u5b50\n\t}\n\treturn (ans + M) % M;\n}\nsigned main() {\n\tscanf(\"%lld\", &n);\n\tfor(int p = 1; p <= n; p++)\n\t\tscanf(\"%lld\", &a[p]);\n\tfor(int p = 1; p <= n; p++)\n\t\tscanf(\"%lld\", &m[p]), a[p] = ((a[p] % m[p] + m[p]) + m[p]) % m[p];//a \u4e5f\u53ef\u80fd\u662f\u8d1f\u6570\n\tprintf(\"%lld\", CRT(n));\n}\n```",
        "postTime": 1619359026,
        "uid": 298549,
        "name": "SIXIANG32",
        "ccfLevel": 5,
        "title": "\u9898\u89e3\u3010[TJOI2009]\u731c\u6570\u5b57\u3011"
    },
    {
        "content": "\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u677f\u5b50\u9898\u3002\n\n\u7531\u9898\u610f\u5f97 $\\begin{cases}b_1 | (n-a_1)\\\\b_2 | (n-a_2)\\\\.......\\\\b_k | (n-a_k)\\end{cases}$.\n\n\u5373 $\\begin{cases}n-a_1\\equiv 0(mod \\; b_1)\\\\n-a_2\\equiv 0(mod \\; b_2)\\\\......\\\\n-a_k\\equiv 0(mod \\; b_k)\\end{cases}$.\n\n\u7531\u6b64\u53ef\u5f97 $\\begin{cases}n\\equiv a_1(mod\\; b_1)\\\\n\\equiv a_2(mod\\; b_2)\\\\......\\\\n\\equiv a_k(mod\\; b_k)\\end{cases}$.\n\n\u8fd9\u4e0d\u5c31\u662f\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u6a21\u677f\u5417\uff1f\n\n\u4f46\u662f\u6b64\u9898\u6709\u4e24\u4e2a\u5751\u70b9\uff0c$a_i$ \u53ef\u80fd\u4e3a\u8d1f\u6570\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u9700\u8981\u5148\u9884\u5904\u7406 $a_i$ \u4f7f\u5f97 $a_i>0$\uff0c\u6839\u636emod\u7684\u6027\u8d28\u6211\u4eec\u77e5\u9053 $a_i\\;mod\\;b_i+b_i$\u4e00\u5b9a\u4e3a\u6b63\u6570\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u9700\u8981\u628a\u6bcf\u4e2a $a_i$ \u5904\u7406\u4e3a $a_i\\;mod\\;b_i+b_i$\uff0c\u8fd9\u6837\u5c31\u89e3\u51b3\u4e86\u8d1f\u6570\u7684\u95ee\u9898\u3002\n\n\u7b2c\u4e8c\uff0c\u6211\u4eec\u6ce8\u610f\u5230\u672c\u9898\u7684\u6570\u636e\u8303\u56f4\uff0c\u5982\u679c\u6c42\u89e3\u65f6\u4e58\u5b8c\u540e\u518d\u53d6\u6a21\u4f1a\u7206 `long long` \uff0c\u8fd9\u91cc\u6211\u4eec\u7528\u4e00\u79cd\u7c7b\u4f3c\u5feb\u901f\u5e42\u7684\u7b97\u6cd5\u5feb\u901f\u4e58\uff08\uff1f\u9f9f\u901f\u4e58\uff09\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u6211\u4eec\u77e5\u9053\u5feb\u901f\u5e42\u7684\u539f\u7406\u662f\u5c06\u6307\u6570\u62c6\u6210\u82e5\u5e72 $2$ \u7684\u5e42\u7684\u548c\uff0c\u518d\u628a\u8fd9\u4e9b\u4e58\u79ef\u76f8\u4e58\u5f97\u5230\u7ed3\u679c\u3002\u7c7b\u4f3c\u5730\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u4e00\u4e2a\u56e0\u6570\u62c6\u6210\u82e5\u5e72 $2$ \u7684\u5e42\u7684\u548c\uff0c\u4f9d\u6b21\u4e58\u4ee5\u53e6\u4e00\u4e2a\u56e0\u6570\u5e76\u53d6\u6a21\uff0c\u5373\u53ef\u907f\u514d\u7206 `long long`\u3002\n\n\u8fd9\u91cc\u4e0d\u5efa\u8bae\u7528 `__int128`\uff0c\u56e0\u4e3a N O I P \u663e\u7136\u662f\u7528\u4e0d\u4e86\u7684\u3002\n\nCode\n\n```cpp\n#include <cstdio>\n#define MAXK 15\n#define int long long\nusing namespace std;\nint k,m=1,ans;\nint a[MAXK],b[MAXK],mi[MAXK];\ninline int mul(int a,int b) {//\u5feb\u901f\u4e58\n\tint r=0;\n\twhile(b) {//\u901a\u8fc7\u6bcf\u6b21\u8ba1\u7b97\u90fd\u53d6\u6a21\u6765\u89e3\u51b3\u6ea2\u51fa\u95ee\u9898\n\t\tif(b&1) r=(r+a)%m;\n\t\ta=(a+a)%m;\n\t\tb>>=1;\n\t}\n\treturn r;\n}\ninline int exgcd(int a,int b,int &x,int &y) {//\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\n\tif(!b) {x=1; y=0; return a;}\n\tint d=exgcd(b,a%b,x,y);\n\tint z=x; x=y; y=z-y*(a/b);\n\treturn d;\n}\nsigned main() {\n\tscanf(\"%lld\",&k);\n\tfor(register int i=1;i<=k;++i) scanf(\"%lld\",a+i);\n\tfor(register int i=1;i<=k;++i) scanf(\"%lld\",b+i),m*=b[i];\n    for(register int i=1;i<=k;i++)\n        a[i]=(a[i]%b[i]+b[i])%b[i];//a[i]\u53ef\u80fd\u4e3a\u8d1f\u6570\uff0c\u9700\u8981\u9884\u5904\u7406\n\tfor(register int i=1;i<=k;++i) {//\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\n\t\tmi[i]=m/b[i];\n\t\tint x=0,y=0;\n\t\texgcd(mi[i],b[i],x,y);\n        x%=b[i];\n\t\tif(x<0) x+=b[i];\n\t\tans=(ans+mul(a[i],mi[i]*x))%m;\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1596950936,
        "uid": 149815,
        "name": "Isprime",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3868 \u3010[TJOI2009]\u731c\u6570\u5b57\u3011"
    },
    {
        "content": "Updated on 2020.11.11\uff1a\u611f\u8c22 [@1lgorithm](https://www.luogu.com.cn/user/287355) \u63d0\u51fa\u9519\u8bef\uff0c\u5e76\u8c03\u6574\u4e86\u521d\u5b66 OI \u65f6\u671f\u7684\u9b54\u9b3c\u6392\u7248\u3002\n\n$b_i$ \u4e4b\u95f4\u4e24\u4e24\u4e92\u8d28\uff0c\u53ef\u4ee5\u7528\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u6c42\u89e3\uff0c\u8fd9\u91cc\u4ecb\u7ecd\u4f7f\u7528\u6269\u5c55\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u6c42\u89e3\u3002\n   \n[P4777 \u3010\u6a21\u677f\u3011\u6269\u5c55\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\uff08EXCRT\uff09](https://www.luogu.org/problemnew/show/P4777)\n   \n\u8981\u89e3\u5982\u4e0b\u7684\u540c\u4f59\u65b9\u7a0b\u7ec4 \uff1a\n   \n$$\\begin{cases}x \\equiv a_1\\pmod {b_1}\\\\x \\equiv a_2\\pmod {b_2}\\\\......\\\\x \\equiv a_n\\pmod {b_n}\\\\\\end{cases}$$\n   \n\u5176\u4e2d , $a_i,b_i$\u4e3a\u975e\u8d1f\u6574\u6570 \uff0c $b_1,b_2,...,b_n$ \u4e0d\u4e00\u5b9a\u4e92\u8d28\n   \n## \u6c42\u89e3\n   \n\u5047\u8bbe\u5df2\u7ecf\u6c42\u51fa\u4e86\u524d $k-1$ \u4e2a\u65b9\u7a0b\u7684\u89e3 $x_{k-1}$\uff0c\u8bbe $M=\\operatorname{lcm}_{i=1}^{k-1} b_i$ , \u5373 $M$ \u4e3a\u524d $k-1$ \u4e2a\u6a21\u6570 $b$ \u7684\u6700\u5c0f\u516c\u500d\u6570\u3002   \n\u5219\u5bf9\u4e8e\u524d $k-1$\u4e2a\u65b9\u7a0b, \u90fd\u6ee1\u8db3$x_{k-1}+tM\\equiv a_i\\pmod {b_i}\\ \\ (t\\in Z)$\uff0c\u5373\u524d $k-1$ \u4e2a\u65b9\u7a0b , \u901a\u89e3\u4e3a $x_{k-1}+tM\\ \\ (t\\in Z)$\u3002\n     \n\u6b32\u6c42\u5f97\u7b2c $k$ \u4e2a\u65b9\u7a0b\u7684\u89e3\uff0c\u5e76\u4e14\u6c42\u5f97\u7684\u89e3\uff0c\u4e5f\u6ee1\u8db3\u524d $k-1$ \u4e2a\u65b9\u7a0b\uff0c\u5219\u9700\u8981\u4f7f\u7b2c $k$ \u4e2a\u65b9\u7a0b\u7684\u89e3\u4e3a\u524d $k-1$ \u7684\u65b9\u7a0b\u7684\u901a\u89e3\u7684\u540c\u65f6\uff0c\u4e5f\u6ee1\u8db3\u7b2c $k$ \u4e2a\u65b9\u7a0b\u7684\u6761\u4ef6\u3002\n    \n\u8bbe\u7b2c $k$ \u4e2a\u65b9\u7a0b\u7684\u89e3 $x_k = x_{k-1}+tM\\ \\ (t\\in Z)$\uff0c\u5c06\u6b64\u89e3\u4ee3\u5165\u7b2c $k$ \u4e2a\u65b9\u7a0b\u4e2d\uff0c\u53ef\u5f97\uff1a\n$$x_{k-1}+tM\\equiv a_k\\pmod{b_k}$$   \n\u5373\uff1a  \n$$tM\\equiv a_k-x_{k-1}\\pmod{b_k}$$\n\n\u5176\u4e2d $M,a_k,x_{k-1},b_k$ \u90fd\u662f\u5df2\u77e5\u7684\uff0c\u4f7f\u7528 exgcd \u89e3\u51fa\u6b64\u540c\u4f59\u65b9\u7a0b\uff0c\u5373\u53ef\u4ee5\u5f97\u5230 $t$ \u7684\u503c\u3002    \n\u5c06 $t$ \u7684\u503c\u4ee3\u56de $x_k = x_{k-1}+tM\\ \\ (t\\in Z)$ \uff0c\u5c31\u53ef\u5f97\u5230$x_k$\u7684\u503c\u3002\u8fdb\u884c $k$ \u6b21\u4e0a\u8ff0\u64cd\u4f5c\u540e \uff0c\u4fbf\u53ef\u5f97\u5230 \u65b9\u7a0b\u7ec4\u7684\u89e3 \u3002\n     \n## \u672c\u9898\u5751\u70b9\n \n\u5982\u679c\u53ea\u662f\u5f00 `long long` \u7684\u8bdd\uff0c\u53d6\u4f59\u65f6\u65e0\u8bba\u5982\u4f55\u90fd\u4f1a\u70b8\u6389\u3002   \n\u4e3a\u4e86\u907f\u514d\u53d8\u91cf\u7206\u7834\uff0c\u8981\u7528\u4e00\u79cd\u53eb\u505a\u5feb\u901f\u4e58\u53d6\u4f59\u7684\u5947(ba)\u5999(ka) \u7b97\u6cd5\u3002   \n\u5176\u672c\u8d28\u4e0e\u5feb\u901f\u5e42\u53d6\u4f59\u7c7b\u4f3c\uff0c\u90fd\u662f\u4e8c\u8fdb\u5236\u7684\u62c6\u5206\u5e94\u7528\u3002   \n         \n\u5047\u8bbe\u6709 $k$ \u4e2a $a$ \u76f8\u4e58\uff0c\u5feb\u901f\u4e58 \u5c06\u5176\u5206\u89e3\u6210\u4e86 $a+ 2a + 4a+ ....$ \u7684\u5f62\u5f0f\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u8fb9\u4e58\u8fb9\u53d6\u4f59\uff0c\u6765\u9632\u6b62\u53d8\u91cf\u7206\u7834\u3002    \n\u4f46\u662f\u5374\u5c06\u4e58\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6 \u62c9\u5230\u4e86 $O(\\log n)$ \u7ea7\u522b\u3002  \n\n```cpp\nll mul(ll A,ll B,ll mod) //\u5feb\u901f\u4e58\u53d6\u4f59 \u6a21\u677f\n{\n \tll ans=0;\n\twhile(B>0)\n\t{\n\t\tif(B & 1) ans=(ans+A%mod)%mod;\n\t\tA=(A+A)%mod;\n\t\tB>>=1;\n\t}\n\treturn ans;\n}\n```\n\n---\n\n$a_i$ \u53ef\u80fd\u4e3a\u8d1f\u6570\u3002  \n      \n\u6269\u5c55\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u53ea\u9002\u7528\u4e8e  $a_i,b_i$ \u975e\u8d1f\u7684\u60c5\u51b5\uff0c\u8981\u5148\u5c06 $a_i$ \u90fd\u8f6c\u5316\u4e3a\u975e\u8d1f\u6574\u6570\uff0c\u53ea\u9700\u8981\u52a0\u8fd9\u4e48\u4e00\u6b65\u64cd\u4f5c\u5373\u53ef\uff1a\n       \n```cpp\nfor(int i=1;i<=n;i++) a[i]=(a[i]+b[i])%b[i];\n```\n\u6839\u636e\u540c\u4f59\u7684\u6027\u8d28\uff0c\u6b63\u786e\u6027\u663e\u7136\u3002  \n  \n## \u4ee3\u7801\u5b9e\u73b0\n\n```cpp\n//\u6269\u5c55\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u6a21\u677f \n//\u8be6\u89c1\u6ce8\u91ca \n#include<cstdio>\nusing namespace std;\ntypedef long long ll;\nll n;\nll a[100010],b[100010]; \nll mul(ll A,ll B,ll mod) //\u5feb\u901f\u4e58\u53d6\u4f59 \u6a21\u677f\n{\n    ll ans=0;\n    while(B>0)\n      {\n        if(B & 1) ans=(ans+A%mod)%mod;\n        A=(A+A)%mod;\n        B>>=1;\n      }\n    return ans;\n}\nll exgcd(ll A,ll B,ll &x,ll &y) //\u6269\u5c55\u6b27\u51e0\u91cc\u5f97 \u6a21\u677f\n{\n    if(!B)\n      {\n        x=1,y=0;\n        return A;\n      }\n    ll d=exgcd(B,A%B,x,y);\n    ll tmp=x;\n    x=y , y=tmp-A/B*y;\n    return d;\n}\nll lcm(ll A,ll B) //\u6c42\u6700\u5c0f\u516c\u500d\u6570\n{\n    ll xxx,yyy;\n    ll g=exgcd(A,B,xxx,yyy);\n    return (A/g*B);\n}\nll excrt() //\u91cd\u70b9:\u6c42\u89e3\u540c\u4f59\u65b9\u7a0b\u7ec4\n{\n    ll x,y;\n    ll M=b[1],ans=a[1]; //\u8d4b\u521d\u503c \n    //M\u4e3a\u524dk-1\u4e2a\u6570\u7684\u6700\u5c0f\u516c\u500d\u6570\uff0cans\u4e3a\u524dk-1\u4e2a\u65b9\u7a0b\u7684\u901a\u89e3\n    for(int i=2;i<=n;i++)\n      {\n        ll A=M,B=b[i];\n        ll C=(a[i]-ans%B+B)%B; //\u4ee3\u8868\u540c\u4f59\u65b9\u7a0b ax\u2261c(mod b) \u4e2da,b,c\n\n        ll g=exgcd(A,B,x,y);\n        //\u6c42\u5f97A,B\u7684\u6700\u5927\u516c\u7ea6\u6570\uff0c\u4e0e\u540c\u4f59\u65b9\u7a0bax\u2261gcd(a,b)(mod b)\u7684\u89e3\uff0c\n\n        if(C%g) return -1; //\u65e0\u89e3\u7684\u60c5\u51b5\n\n        x=mul(x,C/g,B); //\u6c42\u5f97x\u7684\u503c,x\u5373t \n        ans+=x*M;  //\u83b7\u5f97\u524dk\u4e2a\u65b9\u7a0b\u7684\u901a\u89e3\n        M=lcm(M,B); //\u66f4\u6539M\u7684\u503c\n        ans=(ans%M+M)%M;\n      }\n    return ans;\n}\nint main()\n{\n    scanf(\"%lld\",&n);\n    for(int i=1;i<=n;i++)\n      scanf(\"%lld\",&a[i]);\n    for(int i=1;i<=n;i++)\n      scanf(\"%lld\",&b[i]);\n    for(int i=1;i<=n;i++)\n      a[i]=(a[i]+b[i])%b[i];\n    ll ans=excrt();\n    printf(\"%lld\",ans);\n}\n```",
        "postTime": 1558314399,
        "uid": 186186,
        "name": "\u7075\u4e4c\u8def\u7a7a",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3868 \u3010[TJOI2009]\u731c\u6570\u5b57\u3011"
    },
    {
        "content": "**\u9898\u76ee\u5927\u610f**\n\n\u7ed9\u5b9a\u6574\u6570\u5e8f\u5217$(a_i)_{i=1}^k,(b_i)_{i=1}^k$\u4e14\n$$\\forall i\\ne j,\\ \\gcd(b_i,b_j)=1$$\n\u6c42\u6700\u5c0f\u7684\u81ea\u7136\u6570$n$\u4f7f\u5f97\u5bf9\u4e8e\u6240\u6709\u7684$i$\u5747\u6709$b_i|(n-a_i)$\u3002\n\n**\u89e3\u6cd5**\n\n\u4f9d\u9898\u610f\u6211\u4eec\u80fd\u5f97\u5230\u4e00\u4e2a\u540c\u4f59\u65b9\u7a0b\u7ec4\n$$\\begin{cases}n-a_1\\equiv 0\\pmod {b_1}\\\\n-a_2\\equiv 0\\pmod {b_2}\\\\\\qquad\\vdots\\\\n-a_k\\equiv 0\\pmod {b_k}\\end{cases}$$\n\u7a0d\u52a0\u53d8\u5f62\u5373\u6709\n$$\\begin{cases}n\\equiv a_1\\pmod {b_1}\\\\n\\equiv a_2\\pmod {b_2}\\\\\\qquad\\vdots\\\\n\\equiv a_k\\pmod {b_k}\\end{cases}$$\n\u5047\u8bbe$n$\u80fd\u88ab\u8868\u793a\u4e3a$\\displaystyle\\sum_{i=1}^kc_i$\u7684\u5f62\u5f0f\uff0c\u5176\u4e2d$c_i$\u6ee1\u8db3$c_i \\bmod b_i=a_i$\u4e14\n$$\\forall j\\ne i,\\ c_i \\bmod b_j=0$$\n\u4e8e\u662f\u6211\u4eec\u81ea\u7136\u800c\u7136\u5730\u60f3\u5230\u4e86$M=\\displaystyle\\prod_{i=1}^k b_i$\u7684\u4e00\u4e9b\u6027\u8d28\uff0c\u663e\u7136$M_i=\\frac{M}{b_i}$\u80fd\u591f\u6ee1\u8db3\u6211\u4eec\u9700\u8981\u7684\u7b2c\u4e8c\u6761\u6027\u8d28\u4e14\u6240\u6709\u4ee5$M_i$\u4e3a\u56e0\u5b50\u7684\u6570\u5747\u80fd\u6ee1\u8db3\u7b2c\u4e8c\u6761\u6027\u8d28\uff0c\u6545\u6211\u4eec\u53ef\u4ee5\u4ee4\n$$c_i=a_iM_i[M_i]_{b_i}^{-1}$$\n\u53ef\u4ee5\u53d1\u73b0\u5b83\u80fd\u6ee1\u8db3\u6211\u4eec\u7684\u9700\u6c42\u3002\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u4e0a\u8ff0\u540c\u4f59\u65b9\u7a0b\u7ec4\u7684\u4e00\u4e2a\u7279\u89e3\uff0c\u800c\u6211\u4eec\u4e0d\u96be\u53d1\u73b0$x$\u662f\u8be5\u540c\u4f59\u65b9\u7a0b\u7ec4\u7684\u4e00\u4e2a\u89e3\u7684\u5145\u8981\u6761\u4ef6\u4e3a\n$$n-x\\equiv 0\\pmod M$$\n\u4e8e\u662f\u8fd9\u6837\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u8fd9\u4e2a\u540c\u4f59\u65b9\u7a0b\u7ec4\u7684\u6240\u6709\u89e3\uff0c\u800c\u6240\u6c42\u7684$n$\u5373\u4e3a\n$$n=(\\sum_{i=1}^na_iM_i[M_i]_{b_i}^{-1})\\bmod M$$\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nconst int NR=11;\nusing namespace std;\nll mod(ll a,ll b)\n{\n    return (a%b+b)%b;//\u9632\u6b62\u51fa\u8d1f\u6570\n}\nll mul(ll a,ll b,ll m)//\u5feb\u901f\u5e42\n{\n    ll res=0,base=a;\n    while(b){\n        if(b&1)\n            res=(res+base)%m;\n        base=2*base%m;\n        b>>=1;\n    }return res;\n}\nll exgcd(ll a,ll b,ll &x,ll &y)//\u6269\u6b27\u6c42\u9006\u5143\n{\n    if(!b){\n        x=1,y=0;\n        return 1;\n    }ll X,Y;\n    exgcd(b,a%b,X,Y);\n    x=Y,y=X-(a/b)*Y;\n    return x;\n}\nll n,M=1,x,y,ans,a[NR],b[NR];\nint main()\n{\n    scanf(\"%lld\",&n);\n    for(int i=1;i<=n;++i)\n        scanf(\"%lld\",a+i);\n    for(int i=1;i<=n;++i)\n        scanf(\"%lld\",b+i),M*=b[i],a[i]=mod(a[i],b[i]);//\u5148\u6a21\u4e00\u904d\u5bf9\u7b54\u6848\u4e0d\u4f1a\u6709\u5f71\u54cd\n    for(int i=1;i<=n;++i)\n        ans=mod((ans+mul(mul(a[i],(M/b[i]),M),mod(exgcd(M/b[i],b[i],x,y),M),M)),M);//\u6c42\u7b54\u6848\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```\n",
        "postTime": 1627010149,
        "uid": 88791,
        "name": "rain_forest",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3868"
    },
    {
        "content": "\u4e00\u9053\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u7684\u677f\u5b50\u3002\n\n\u9898\u76ee\u544a\u8bc9\u6211\u4eec\u5bf9\u4e8e\u4efb\u4f55\u4e00\u7ec4 $b_i,b_j$ \u90fd\u6ee1\u8db3 $\\gcd(b_i,b_j)=1$\uff0c\u6240\u4ee5\u6211\u4eec\u5e94\u5f53\u654f\u611f\u5730\u60f3\u5230\u8fd9\u5b9e\u9645\u4e0a\u5e94\u8be5\u662f\u53ef\u4ee5\u8f6c\u5316\u4e3a\u540c\u4f59\u65b9\u7a0b\u7684\u5f62\u5f0f\uff0c\u800c\u4e0b\u6587\u7684 $b_i|(n-a_i)$ \u66f4\u5f3a\u5316\u4e86\u8fd9\u4e2a\u7406\u89e3\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u4e2a\u5f0f\u5b50\u8f6c\u5316\u4e3a $n-a_i\\equiv 0\\pmod{b_i}$\uff0c\u8fdb\u884c\u7b80\u5355\u7684\u79fb\u9879\u5f97\u5230 $n\\equiv a_i\\pmod{b_i}$\u3002\u5217\u6210\u540c\u4f59\u65b9\u7a0b\u7ec4\u7684\u5f62\u5f0f\u5c31\u662f\uff1a\n\n$$\\begin{cases}n\\equiv a_1\\pmod{b_1}\\\\n\\equiv a_2\\pmod{b_2}\\\\n\\equiv a_3\\pmod{b_3}\\\\\\cdots\\cdots\\\\n\\equiv a_k\\pmod{b_k}\\\\\\end{cases}$$\n\n\u4f60\u4e00\u770b\uff0c\u53d1\u73b0\u8fd9\u662f[\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406 CRT](https://www.luogu.com.cn/blog/LinearExpectation/CRT-ExCRT)\u7684\u88f8\u9898\uff01\n\n\u90a3\u4e48\u6211\u4eec\u6309\u7167\u94fe\u63a5\u6587\u7ae0\u6240\u793a\uff0c\u5199\u51fa\u4ee3\u7801\u63d0\u4ea4\uff0c\u4f60\u4f1a\u53d1\u73b0\u53ea\u80fd\u62ff\u5230 $90$ \u5206\uff0c\u5b9e\u9645\u4e0a\u6700\u540e\u4e00\u4e2a\u70b9\u7206\u4e86 `long long` \u6211\u4eec\u53ef\u80fd\u5f97\u4f7f\u7528\u9f9f\u901f\u4e58\u89e3\u51b3\uff0c\u5e76\u4e14\u5728\u4f7f\u7528\u9f9f\u901f\u4e58\u7684\u65f6\u5019\u8981\u6ce8\u610f\u4e00\u4e0b $a_i$ \u53ef\u80fd\u4e3a\u8d1f\u6570\uff0c\u56e0\u4e3a\u9898\u76ee\u7ed9\u7684\u6570\u636e\u8303\u56f4\u662f $|a_i|\\le 10^9$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint n,a[99],m[99],al[99],mul=1,ans;\nint gsc(int a,int b,int mod){\n\tint ans=0;\n\twhile(b>0){\n\t\tif(b&1)ans=(ans+a)%mod;\n\t\ta=(a+a)%mod;\n\t\tb>>=1;\n\t}return ans;\n}int Exgcd(int a,int b,int &x,int &y){\n    if(!b){\n        x=1,y=0;\n        return a;\n    }int d=Exgcd(b,a%b,x,y),t=x;\n    x=y;\n    y=t-(a/b)*y;\n    return d;\n}signed main(){\n    scanf(\"%lld\",&n);\n    for(int i=1;i<=n;i++){\n    \tscanf(\"%lld\",&a[i]);\n    }for(int i=1;i<=n;i++){\n    \tscanf(\"%lld\",&m[i]);\n    \tmul=mul*m[i];\n    }for(int i=1;i<=n;i++){\n        al[i]=mul/m[i];\n        int x=0,y=0;\n        Exgcd(al[i],m[i],x,y);\n        if(x<0)x+=m[i];\n        ans=(ans+gsc(x,gsc(\n\t\t\t\tal[i],(a[i]+mul)%mul,\n\t\t\tmul),mul)+mul)%mul;\n    }printf(\"%lld\\n\",ans%mul);\n    return 0;\n}\n```",
        "postTime": 1626238122,
        "uid": 212283,
        "name": "Aw\u987f\u987f",
        "ccfLevel": 5,
        "title": "\u3010\u9898\u89e3\u3011P3868 [TJOI2009]\u731c\u6570\u5b57"
    },
    {
        "content": "### \u9898\u610f\n\u89e3\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u7ec4\n\n\n$\\left\\{\\begin{matrix} \n  x-a_1\\equiv 0 \\pmod {b_1}\\\\  \n  x-a_2\\equiv 0 \\pmod {b_2}\\\\\n  x-a_3\\equiv 0 \\pmod {b_3}\\\\\n  ...\\\\\n  x-a_k\\equiv 0 \\pmod {b_k}\n\\end{matrix}\\right.$\n\n### \u601d\u8def\n\n\u6839\u636e\u540c\u4f59\u5f0f\u53d8\u6362\u6cd5\u5219:\n\u5982\u679c $a\\equiv b\\pmod m$\u6210\u7acb\uff0c\u90a3\u4e48$a+c\\equiv b+c\\pmod m$\u4e5f\u6210\u7acb\u3002\n\u6545\u53ef\u5c06\u65b9\u7a0b\u7ec4\u5de6\u53f3\u4e24\u8fb9\u540c\u65f6$+a_i$\uff0c\u5f97\n\n$\\left\\{\\begin{matrix} \n  x\\equiv a_1 \\pmod {b_1}\\\\  \n  x\\equiv a_2 \\pmod {b_2}\\\\\n  x\\equiv a_3 \\pmod {b_3}\\\\\n  ...\\\\\n  x\\equiv a_k \\pmod {b_k}\n\\end{matrix}\\right.$\n\n\u4e8e\u662f\u672c\u9898\u5c31\u6210\u4e3a\u4e86[\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406](https://www.luogu.com.cn/problem/P1495)\u7684\u6a21\u677f\u9898\u3002\n\n### \u7ec6\u8282\n\n\u5982\u679c\u76f4\u63a5\u63d0\u4ea4\u677f\u5b50\u9898\u7684\u4ee3\u7801\uff0c\u4f1a\u53d1\u73b0\u6700\u540e\u4e00\u4e2a\u6d4b\u8bd5\u70b9\u4e00\u76f4\u8fc7\u4e0d\u53bb\uff0c\u90a3\u662f\u56e0\u4e3a~~\u826f\u5fc3\u51fa\u9898\u4eba~~\u5c06\u6570\u636e\u7279\u522b\u5927\uff0c\u4ee5\u81f3\u4e8e\u6ea2\u51fa\u4e86long long\u3002\u3002\u3002\u4e8e\u662f\u672c\u9898\u9700\u8981\u8fd0\u7528\u9f9f\u901f\u4e58\u6765\u9632\u6b62\u6ea2\u51fa\u3002\u5177\u4f53\u4f7f\u7528\u6280\u5de7\u89c1\u4ee3\u7801\u3002\n\n### code:\n```cpp\n#include<cstdio>\nusing namespace std;\nconst int N=12;\n#define int long long\nint a[N],b[N],k,x,y,ans,M=1;\nint exgcd(int &x,int &y,int a,int b)\n{\n\tif(b==0)\n\t{\n\t\tx=1,y=0;\n\t\treturn a;\n\t}\n\tint d=exgcd(x,y,b,a%b);\n\tint t=x;\n\tx=y,y=t-a/b*y;\n\treturn d;\n}\nint gsc(int a,int b,int mod)\n{\n\tint res=0;\n\twhile(b)\n\t{\n\t\tif(b&1) res=(res+a)%mod;\n\t\ta=(a+a)%mod;\n\t\tb>>=1;\n\t}\n\treturn res;\n}\nsigned main()\n{\n\tscanf(\"%lld\",&k);\n\tfor(int i=1;i<=k;i++) scanf(\"%lld\",&a[i]);\n\tfor(int i=1;i<=k;i++) scanf(\"%lld\",&b[i]),M*=b[i];\n\tfor(int i=1;i<=k;i++)\n\t{\n\t\tint m=M/b[i];\n\t\tx=0,y=0;\n\t\texgcd(x,y,m,b[i]);\n\t\tx=(x%b[i]+b[i])%b[i];\n\t\tans=(ans+gsc(gsc(a[i],m,M),x,M))%M;//\u8fd9\u91cc\u7528\u9f9f\u901f\u4e58\u5c31\u53ef\u4ee5AC\u4e86 \n\t}\n\tprintf(\"%lld\\n\",ans%M);\n\treturn 0;\n}\n```\n",
        "postTime": 1622370123,
        "uid": 288192,
        "name": "ListenSnow",
        "ccfLevel": 7,
        "title": "P3868 [TJOI2009]\u731c\u6570\u5b57"
    },
    {
        "content": "## [[TJOI2009]\u731c\u6570\u5b57](https://www.luogu.com.cn/problem/P3868)\n\n### \u6e29\u99a8\u63d0\u793a\uff1a[\u5728\u535a\u5ba2\u98df\u7528\u66f4\u4f73](https://www.luogu.com.cn/blog/224229/solution-p3868)\n\n\u672c\u9898\u6240\u9700\u7b97\u6cd5\uff1a\n> \u4e2d\u56fd\u5269\u4f59\u5b9a\u7406----[\u6a21\u677f](https://www.luogu.com.cn/problem/P1495)\n\n> \u9f9f\u901f\u4e58\n\n\u4ee5\u4e0b\u90e8\u5206\u4e3b\u8981\u4e3a[\u6269\u5c55\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406](https://www.luogu.com.cn/problem/P4777)\u7684\u63a8\u5bfc\u8fc7\u7a0b(\u4e0e\u672c\u9898\u65e0\u5173\uff0c\u4e0d\u60f3\u770b\u7684\u53ef\u4ee5\u76f4\u63a5\u8df3\u8fc7)\n------------\n\u9996\u5148\u6211\u4eec\u8981\u77e5\u9053\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u7684\u4f7f\u7528\u8981\u6c42\n\n\u5373\u9898\u76ee\u8981\u6c42\u4e2d\u53ef\u4ee5\u5316\u4e3a\u4e00\u4e0b\u65b9\u7a0b\u7ec4\n$$\n\\left\\{ \n\\begin{array}{c}\nx\\equiv b_1(mod(a_1)) \\\\ \nx\\equiv b_2(mod(a_2)) \\\\ \nx\\equiv b_3(mod(a_3)) \\\\\n \\dots\\dots\\dots  \\\\\nx\\equiv b_n(mod(a_n))\n\\end{array}\n\\right. \n$$\n\n\u5bf9\u4e8e\u6bcf\u5bf9\u65b9\u7a0b\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\n$$\n\t\\left\\{\n\t\\begin{array}{c}\n    x=b_a+k_a*a_a \\\\\n    x=b_b+k_b*a_b\n   \\end{array}\n   \\right.\n$$\n\u8054\u7acb\u5316\u7b80\u4e00\u4e0b\n$$\n    k_a*a_a+k_b*a_b=b_b-b_a\n$$\n\u5bf9\u4e8e\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u6211\u4eec\u53ef\u4ee5\u7528exgcd \u6c42\u51fa \u6ee1\u8db3\u8981\u6c42\u7684\u5173\u4e8e$x$\u7279\u89e3$x_0$,\u90a3\u4e48\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u5f0f\u5b50\n$$\t\n\\left\\{\n\t\\begin{array}{c}\n    x_0=b_a+k_a*a_a \\\\\n    x=b_a+k_i*a_a \\\\\n    k_i=n*\\frac{a_b}{gcd(a_a,a_b)}+k_a(n\\in Z)\n   \\end{array}\n   \\right.\n\t\n$$\n\u90a3\u4e48\u53ef\u4ee5\u5f97\u5230\n$$\nx=n*\\frac{a_b*a_a}{gcd(a_a,a_b)}+k_a*a_a+b_a=n*lcm(a_a,b_a)+x_0(n\\in Z)\n$$\n\u6700\u540e\u4e24\u4e2a\u540c\u4f59\u5f0f\u5c31\u53ef\u4ee5\u5408\u5e76\u4e3a\n$$\n\tx\\equiv x_0(mod(lcm(a_a,a_b))\n$$\n\n**\u56de\u5230\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406**\uff0c\n\n\u7531\u4e8e\u6a21\u6570 $P_i$\u90fd\u4e3a\u8d28\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\n$n_i$\u662f\u6ee1\u8db3\u4e0b\u9762\u4e24\u4e2a\u5f0f\u5b50\u7684\u6700\u5c0f\u6b63\u6574\u6570\n$$\n\n\t\\left\\{\n\t\\begin{array}{c}\n    n_i\\equiv b_i(mod(a_i))\\\\\n    \\frac{\\prod_{j=1}^{k}{a_j}}{a_i}\\mid n_i\n   \\end{array}\n   \\right.\n$$\n\u90a3\u4e48$\\sum_{i=1}^k{n_i}$\u4e00\u5b9a\u662f\u6ee1\u8db3\u6761\u4ef6\u4e00\u4e2a\u89e3\u3002\n\u4f46\u662f\u8fd9\u5e76\u4e0d\u662f\u6ee1\u8db3\u6761\u4ef6\u7684\u6700\u5c0f\u503c\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u8981\u5728\u6b64\u57fa\u7840\u4e0a\u5bf9$\\prod_{j=1}^{k}{a_j}$\u53d6\u6a21\n\n\u90a3\u4e48\u600e\u4e48\u8ba1\u7b97$n_i$\u5462\uff1f\n\u6211\u4eec\u53ef\u4ee5\u8fd0\u7528exgcd\u6c42\u51fa\u6ee1\u8db3\n$n_i\\equiv 1(mod(a_i))$\u7684$n_i$,\u90a3\u4e48\u53ef\u4ee5\u5f97\u51fa \n$$\nb_i*n_i\\equiv b_i(mod(a_i)\n$$\n\u6240\u4ee5\u6211\u4eec\u7b54\u6848\u4e3a\n\n\n$$\n\n\t\\left\\{\n\t\\begin{array}{c}\n    ans=\\sum_{i=1}^k{n_i*b_i}\\\\\n    n_i\\equiv 1(mod(a_i))\n   \\end{array}\n   \\right.\n$$\n\n\u4ee3\u7801\u5b9e\u73b0\n```cpp\ninline ll china()\n{\n\tll W=1,k,z,w,ans=0;\n\tfor(int i=1;i<=n;++i)W*=a[i];\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tw=W/a[i];\n\t\texgcd(w,a[i],k,z);\n\t\tans=(ans+slow(slow(w,k,W),b[i],W))%W;\n\t}\n\treturn ans=(ans+W)%W;\n}\n```\n\n\n ### \u9f9f\u901f\u4e58\n\n\u5c06\u4e58\u6cd5\u8fdb\u884c\u4e8c\u8fdb\u5236\u62c6\u5206\uff0c\u5206\u6b65\u53d6\u6a21\u9632\u6b62\u5355\u6b21\u4e58\u6cd5\u6ea2\u51fa,\u4ee3\u7801\u7c7b\u4f3c\u4e8e\u5feb\u901f\u5e42\uff0c\u53ea\u9700\u8981\u5c06\u5176\u4e2d\u7684\u4e58\u6cd5\u6362\u6210\u52a0\u6cd5\n\n\u4ee3\u7801\u5b9e\u73b0\n```cpp\ninline ll slow(ll a,ll b,ll mod)\n{\n\tll ans=0;\n\tif(b<0)b=(b%mod+mod)%mod;\\\\\u5982\u679c b \u4e3a\u8d1f\u6570\uff0c\u9f9f\u901f\u4e58\u53ef\u80fd\u4f1a\u70b8\u6389\uff0c\u6240\u4ee5\u5148\u53d6\u6a21\u5c06b\u6539\u4e3a\u6b63\u6574\u6570\n\twhile(b)\n\t{\n\t\tif(b%2)ans=(ans+a)%mod;\n\t\tb=b>>1;\n\t\ta=(a<<1)%mod;\n\t}\n\treturn ans;\n}\n```\n>> **Thanks for your reading**",
        "postTime": 1588218677,
        "uid": 224229,
        "name": "Caicz",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3868 \u3010[TJOI2009]\u731c\u6570\u5b57\u3011"
    },
    {
        "content": "## \u601d\u8def\n\n> \u4e2d\u56fd\u5269\u4f59\u5b9a\u7406 + \u5feb\u901f\u4e58\n\n\u9898\u76ee\u8981\u6c42\u627e\u5230\u6700\u5c0f\u7684$n$\uff0c\u6ee1\u8db3\u5bf9\u4e8e$\\forall i\\in [1,k]$\uff0c\u6709$b_i | (n-a_i)$\n\n\u6211\u4eec\u8bd5\u7740\u6765\u8f6c\u5316\u4e00\u4e0b\u8fd9\u4e2a\u5f0f\u5b50\n\n$b_i|(n-a_i)$\uff0c\u4e5f\u5c31\u662f\u8bf4$(n-a_i)$\u5728\u6a21$b_i$\u610f\u4e49\u4e0b\u540c\u4f59$0$\uff0c\u5373$n - a_i\\equiv 0(\\text{mod}\\ b_i)$\uff0c\u8fdb\u4e00\u6b65\u8f6c\u5316\uff0c\u5c31\u80fd\u5f97\u5230$n\\equiv a_i(\\text{mod}\\ b_i)$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u662f\u4e0d\u662f\u5f88\u773c\u719f\uff1f\u6ca1\u9519\uff0c\u5c31\u662f\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u7684\u5f0f\u5b50\uff0c\u56e0\u4e3a\u9898\u76ee\u4e2d\u5df2\u7ecf\u4fdd\u8bc1\u4e86$b_i$\u4e24\u4e24\u4e92\u7d20\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u5957\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u7684\u677f\u5b50\u4e86\n\n\u8bbe$N=\\prod_{i=1}^nb_i$\uff0c$Mi=N/b_i$\uff0c$x_i$\u662f\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b$M_ix_i\u22611(\\text{mod}\\ b_i)$\u7684\u4e00\u4e2a\u89e3(\u5373$Mi$\u7684\u9006\u5143)\uff0c\u6700\u540e\u7684\u89e3\u5373\u4e3a$ans=\\sum\\limits_{i=1}^ka_iM_ix_i$\n\n\u90a3\u4e48\u8fd9\u6837\u5c31\u5b8c\u4e86\u561b\uff1f\n\n~~\u6b64\u9898\u7ec8\u7ed3~~\u5176\u5b9e\u4e0d\u7136\n\n\u8fd9\u6837\u4ea4\u4e0a\u53bb\u4e4b\u540e\uff0c\u4f1a\u53d1\u73b0\u53ea\u6709\u4e5d\u5341\u5206\uff0c\u6700\u540e\u4e00\u4e2a\u70b9$WA$\u4e86\uff0c\u56e0\u4e3a\u8fd9\u9898\u8981\u7528\u5feb\u901f\u4e58\uff0c\u4e8e\u662f\u5199\u4e0a\u5feb\u901f\u4e58\n\n\u90a3\u4e48\u8fd9\u6837\u5c31\u5b8c\u4e86\u561b\uff1f\n\n~~\u6b64\u9898\u7ec8\u7ed3~~\u5176\u5b9e\u4e5f\u4e0d\u7136\n\n\u53c8\u4ea4\u4e0a\u53bb\u4e4b\u540e\uff0c\u53d1\u73b0\u8fd8\u662f\u4e5d\u5341\u5206\uff0c\u4e0d\u8fc7\u8fd9\u6b21\u9519\u7684\u70b9\u662f\u7b2c\u4e8c\u4e2a\u4e86\u3002\n\n\u8fd9\u662f\u4e3a\u4ec0\u4e48\u5462\uff1f\n\n\u770b\u9898\u76ee\u6761\u4ef6\uff1a$\u2223a_i\u2223\u226410^9$\n\n\u4ec0\u4e48\u610f\u601d\u5462\uff1f\u610f\u601d\u5c31\u662f$a_i$\u53ef\u80fd\u662f\u8d1f\u7684\uff01\uff08\u51fa\u9898\u4eba\u771f\u662f\u7528\u5fc3\u826f\u82e6\n\n\u5904\u7406\u7684\u65b9\u6cd5\u5c31\u662f\uff1a\u5feb\u901f\u4e58\u4f20\u53c2\u65f6\u53d6\u6a21\n\n\u90a3\u4e48\u8fd9\u6837\u5c31\u5b8c\u4e86\u561b\uff1f\n\n~~\u5174\u51b2\u51b2\u7684~~\u4ea4\u4e0a\u53bb\uff0c\u7ec8\u4e8e\u6ee1\u5206\u4e86\uff0c\u6ca1\u9519\uff0c\u8fd9\u6b21\u771f\u5b8c\u4e86\n\n## \u4ee3\u7801\n\n```cpp\n/*\nAuthor:loceaner\n\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u677f\u5b50\u9898 \n*/\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\n#define int long long\nusing namespace std;\n\nconst int A = 5e5 + 11;\nconst int B = 1e6 + 11;\nconst int mod = 1e9 + 7;\nconst int inf = 0x3f3f3f3f;\n\ninline int read() {\n\tchar c = getchar(); int x = 0, f = 1;\n\tfor( ; !isdigit(c); c = getchar()) if(c == '-') f = -1;\n\tfor( ; isdigit(c); c = getchar()) x = x * 10 + (c ^ 48);\n\treturn x * f;\n}\n\nint n, N = 1, b[A], a[A], ans;\n\ninline int mul(int n, int m, int mod) {\n\tint res = 0;\n\twhile (m) {\n\t\tif (m & 1) res = (res + n) % mod;\n\t\tn = (n + n) % mod, m >>= 1;\n\t}\n\treturn res;\n}\n\ninline void exgcd(int a, int b, int &x, int &y) {\n\tif (!b) x = 1, y = 0;\n\telse exgcd(b, a % b, y, x), y -= a / b * x;\n}\n\nsigned main() {\n\tn = read();\n\tfor (int i = 1; i <= n; i++) a[i] = read();\n\tfor (int i = 1; i <= n; i++) b[i] = read(), N *= b[i];\n\tfor (int i = 1; i <= n; i++) {\n\t\tint x, y, Mi = N / b[i];\n\t\texgcd(Mi, b[i], x, y);\n\t\tans = (ans + mul(mul(Mi, x % N + N, N), a[i] % N + N, N) % N + N) % N; \n\t}\n\tcout << ans % N << '\\n';\n\treturn 0;\n}\n```\n\n",
        "postTime": 1587687997,
        "uid": 198323,
        "name": "loceaner",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P3868 \u3010[TJOI2009]\u731c\u6570\u5b57\u3011"
    },
    {
        "content": "## \u521a\u5b66CRT\uff0c\u6765\u53d1\u4e00\u7bc7\u9898\u89e3\u3002\n\n\u5207\u5165\u6b63\u9898\n\n\u5f88\u663e\u7136\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\n$$ b_i | (n-a_i)$$\n\u90fd\u7b49\u4ef7\u4e8e\n$$ n \\equiv a_i \\ (mod\\ b_i)$$\n\n\u6240\u4ee5\u8fd9$k$\u4e2a\u5f0f\u5b50\uff0c\u5c31\u8f6c\u5316\u6210\u4e86\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u7684\u6a21\u578b\u3002\n\n\u5957\u677f\u5b50\u5373\u53ef\u3002\n\n\u7136\u540e\u4f60\u4f1a\u53d1\u73b0WA90\n\n\u56e0\u4e3a\u6240\u6709$b_i$\u4e58\u8d77\u6765\u6700\u5927\u662f$10^{18}$\uff0c\u6240\u4ee5\u518d\u4e58\u5176\u4ed6\u6570\u5c31\u4f1a\u7206long long\u3002\n\n\u600e\u4e48\u7834\uff1f\n\n\u53ef\u4ee5\u7528`__int128` \u6216 \u5feb\uff08\u9f9f\uff09\u901f\u4e58\u3002\n\n\u7531\u4e8e\u6211\u61d2\uff08\u5176\u5b9e\u662f\u4e0d\u4f1a\u9f9f\u901f\u4e58\uff09,\u5c31\u6253\u4e86`_int128`\u3002\n\n$Code$:\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\nusing namespace std;\n#define int __int128\ntemplate<class T>inline void read(T &x){\n\tx=0;\n\tregister int f=0,ch=getchar();\n\twhile('0'>ch||ch>'9')f^=ch=='-',ch=getchar();\n\twhile('0'<=ch&&ch<='9')x=(x<<3)+(x<<1)+(ch^'0'),ch=getchar();\n\tx=f?-x:x;\n}\ntemplate<class T>inline void print(T x){\n\tif(x<0)putchar('-'),x=-x;\n\tif(x>9)print(x/10);\n\tputchar(x%10+'0');\n}\nconst int MAX=15; \nint n,M=1,m,p[MAX],a[MAX],inv,ans;\nvoid exgcd(int a,int b,int &x,int &y){\n\tif(b==0){x=1,y=0;}\n\telse {\n\t\texgcd(b,a%b,x,y);\n\t\tregister int t=x;x=y;y=t-a/b*y;\n\t}\n}\nint res;\nint x,y;\ninline int CRT(){\n\tfor(register int i=1;i<=n;++i){\n\t\tm=M/p[i];x=y=0;\n\t\texgcd(m,p[i],x,y);\n\t\tans=(ans+m%M*x%M*a[i]%M)%M;\n\t}\n\tans=(ans%M+M)%M;\n\treturn ans;\n}\nsigned main(){\n\tread(n);\n\tfor(register int i=1;i<=n;++i)read(a[i]);\n\tfor(register int i=1;i<=n;++i)read(p[i]),M*=p[i];\n\tprint(CRT()%M);\n\treturn 0;\n}\n\n\n```\n",
        "postTime": 1583053301,
        "uid": 119062,
        "name": "Lates",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3868 \u3010[TJOI2009]\u731c\u6570\u5b57\u3011"
    },
    {
        "content": "\u4e00\u9053\u7ecf\u5178\u7684\u6570\u8bba\u9898\uff0c\u89e3\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u7ec4\u3002\n\n\u867d\u7136\u6570\u636e\u91cf\u5f88\u5c0f\uff08\u4f30\u8ba1\u7206\u641c\u4e5f\u80fd\u8fc7\uff09\uff0c\u4f46\u6211\u8fd8\u662f\u5199\u4e86\u4e00\u5927\u6bb5\u7834\u7834\u70c2\u70c2\u7684\u4ee3\u7801\u3002\n\n\u56de\u5f52\u4e3b\u9898\uff0c\u8bbes[i]\u4e3ab[1],\u2026\u2026,b[i]\u7684\u6700\u5c0f\u516c\u500d\u6570\uff0cn[i]\u4e3a\u524di\u4e2a\u65b9\u7a0b\u7ec4\u7684\u6700\u5c0f\u89e3\uff0c\u6545\n\nn[i]=n[i-1]+t\\*s[i-1]\u4e0ea[i]\u6a21b[i]\u540c\u4f59\uff0c\u6545\u8981\u6c42t\u7684\u6700\u5c0f\u503c\u3002\n\n\u8bbephi(x)\u4e3a\u6b27\u62c9\u51fd\u6570\uff0c\u4ee4y=phi(b[i])\uff0c\u7531\u8d39\u9a6c\u5c0f\u5b9a\u7406\u77e5\uff0ct\u4e3a(a[i]-n[i-1])\\*(s[i-1]^(y-1))\u6a21b[i]\u7684\u6700\u5c0f\u5269\u4f59\u6570\uff08\u53ef\u80fd\u6709\u70b9\u7ed5\uff0c\u770b\u4ee3\u7801\u5c31\u77e5\u9053\u4e86\uff09\u3002\n\n\u4e3a\u9632\u6b62\u8d8a\u754c\u548c\u8d85\u65f6\uff0c\u6211\u4f7f\u7528\u4e86\u5feb\u901f\u5e42\u548c\u5feb\u901f\u4e58\u3002\n\n\u4ee5\u4e0b\u662f\u6211\u7684\u4ee3\u7801\uff1a\n\n\n\n\n\n    \n    \n```cpp\n#include<iostream>\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<stack>\n#include<queue>\n#include<map>\n#include<list>\n#include<functional>\n#include<vector>\n#include<set>\n#include<cctype>\n#include<ctime>\n#include<cstdlib>\n#include<algorithm>\n#define ll long long\nusing namespace std;\nint k;\nll n[20],s[20],a[20],b[20];\nll phi(ll x)                                                  //\u8ba1\u7b97\u6b27\u62c9\u51fd\u6570\n{\n    int f[100];\n    ll ans=1,t,i=1;\n    while (x>1)\n    {\n        i++;\n        if ((x%i)==0)\n        {\n            t=1;\n            while ((x%i)==0)\n            {\n                t*=i;\n                x/=i;\n            }\n            ans*=(t-t/i);\n        }\n    }\n    return ans;\n}\nll ji(ll u,ll v,ll w)                                    //\u5feb\u901f\u4e58\n{\n    ll t=0,y=u;\n    while (v>0)\n    {\n        if ((v&1)==1) t=(t+y)%w;\n        y=(y+y)%w;\n        v>>=1;\n    }\n    return t;\n}\nll mi(ll u,ll v,ll w)                                         //\u5feb\u901f\u5e42\n{\n    ll t=1,y=u;\n    while (v>0)\n    {\n        if ((v&1)==1) t=ji(t,y,w);\n        y=ji(y,y,w);\n        v>>=1;\n    }\n    return t;\n}\nint main()\n{\n    scanf(\"%d\",&k);\n    for (int i=1;i<=k;i++)\n        scanf(\"%lld\",&a[i]);\n    for (int i=1;i<=k;i++)\n        scanf(\"%lld\",&b[i]);\n    memset(s,0,sizeof(s));\n    memset(n,0,sizeof(n));\n    s[0]=1;\n    for (int i=1;i<=k;i++)\n    {\n        s[i]=s[i-1]*b[i];\n        a[i]%=b[i];\n        if (a[i]<0) a[i]+=b[i];\n    }\n    n[1]=a[1];\n    for (int i=2;i<=k;i++)\n    {\n        ll x=a[i]-n[i-1];\n        x%=b[i];\n        if (x<0) x+=b[i];\n        ll y=phi(b[i]);\n        ll t=mi(s[i-1],y-1,b[i]);\n        t*=x;\n        t%=b[i];\n        n[i]=n[i-1]+t*s[i-1];\n    }\n    printf(\"%lld\",n[k]);\n}\n\n```",
        "postTime": 1506780735,
        "uid": 27469,
        "name": "xh2010",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3868 \u3010[TJOI2009]\u731c\u6570\u5b57\u3011"
    },
    {
        "content": "## \u96f6. \u5b89\u5229\uff1a\n\n[\u5b89\u5229\u4e00\u4e0b\u6211\u7684\u535a\u5ba2\u3002](https://rsdbkhusky.github.io/)\n\n## \u4e00. \u601d\u8def\n\n\u9996\u5148\u62ff\u9053\u9898\u770b\u5230\u6761\u4ef6\u7ed9\u51fa\u4e24\u7ec4\u6570\uff0c\u5176\u4e2d\u4e00\u7ec4\u4e92\u7d20\uff0c\u8ba9\u731c\u4e00\u4e2a\u6570\u5b57\u3002\u81ea\u7136\u800c\u7136\u5f80 **crt** \u4e0a\u60f3\u3002\u4f46\u4e3a\u4ec0\u4e48\u662f **crt** \u5462\uff1f\n\n$\\forall i \\in [1,k]$\uff0c\u6709 $b_i \\mid (n - a_i)$\uff0c\u8fd9\u53e5\u8bdd\u53ef\u4ee5\u5316\u4e3a\u4e00\u7ec4\u540c\u4f59\u65b9\u7a0b\uff0c\u518d\u79fb\u9879\u53ef\u5f97\u6807\u51c6\u7684 **crt** \u683c\u5f0f\uff1a\n$$~~~~~~~~~~~~~~\\begin{cases}n - a_1 \\equiv 0 &(\\operatorname{mod}~b_1) \\\\n - a_2 \\equiv 0 &(\\operatorname{mod}~b_2) \\\\\\cdots \\\\n - a_k \\equiv 0 &(\\operatorname{mod}~b_k) \\\\\\end{cases}$$\n\n$$\\Longrightarrow\\begin{cases}\nn \\equiv a_1 &(\\operatorname{mod}~b_1) \\\\\nn \\equiv a_2 &(\\operatorname{mod}~b_2) \\\\\n\\cdots \\\\\nn \\equiv a_k &(\\operatorname{mod}~b_k) \\\\\n\\end{cases}$$\n\u7136\u540e **crt** \u6c42\u89e3\u5c31\u597d\u4e86\u3002**crt** \u2014\u2014\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u5c31\u662f\u63d0\u4f9b\u4e86\u4e00\u4e2a\u89e3\u540c\u4f59\u65b9\u7a0b\u7ec4 $\\begin{cases}x \\equiv a_1 &(\\operatorname{mod}~m_1) \\\\ x \\equiv a_2 &(\\operatorname{mod}~m_2) \\\\ \\cdots \\\\ x \\equiv a_n &(\\operatorname{mod}~m_n) \\\\ \\end{cases}$ \u7684\u516c\u5f0f\uff0c\u5373 $x = \\sum\\limits_{i = 1}^{n} \\{ a_i \\times M_i \\times t_i \\}$\uff0c\u5176\u4e2d $M_i = \\dfrac{\\prod\\limits_{j = 1}^{n}m_j}{m_i}$\uff0c $t_i = \\operatorname{inv}(M_i)$\u3002\u516c\u5f0f\u7684\u63a8\u5bfc\u8be6\u89c1 [OI-Wiki](https://oi-wiki.org/math/crt/)\u3002\n\n## \u4e8c. \u5751\u70b9\n\n\u4ea4\u4ee3\u7801\u4e0a\u53bb\u4e00\u770b\uff0c\u4e3a\u4ec0\u4e48\u53ea\u6709 90 \u5206\uff1f\u6700\u540e\u4e00\u4e2a\u70b9 WA \u6389\u4e86\uff0c\u5e76\u4e14\u663e\u793a\u7b2c\u4e00\u884c\u7b2c\u4e00\u5217\u8f93\u51fa\u4e86\u51cf\u53f7\u3002\u770b\u6765\u662f\u7206 long long \u4e86\u3002\u6240\u4ee5\u9700\u8981~~\u9f9f\u901f~~\u5feb\u901f\u4e58\u9632\u6b62\u7206 long long\u3002\uff08\u672c\u849f\u84bb\u4e0d\u4f1along double\uff09\n\n## \u4e09. \u4ee3\u7801\n\n```cpp\n#include<cstdio>\n#define int long long\n#define re register\nconst int MAXn = 10;\n\ntemplate <typename T>\ninline T qmul(T x, T y, T mod) {\n    if (x == 0 || y == 0) return 0;\n    T ret = 0;\n    while (y) {\n        if (y & 1) ret = ((ret % mod) + (x % mod)) % mod;\n        y >>= 1;\n        x = ((x % mod) + (x % mod)) % mod;\n    }\n    return ret;\n}\n\nint exgcd(int a, int b, int &x, int &y) {\n\tif (!b) {\n\t\tx = 1; y = 0;\n\t\treturn a;\n\t} else {\n\t\tint d = exgcd(b, a % b, y, x);\n\t\ty -= a / b * x;\n\t\treturn d;\n\t}\n}\n\nint inv(int a, int m) {\n\tint k, inv;\n\texgcd(a, m, inv, k);\n\treturn (inv % m + m) % m;\n}\n\nint crt(int cnta, int *a, int *m) {\n\tint prod = 1, ans = 0;\n\tfor (re int i = 1; i <= cnta; ++i) {\n\t\tprod *= m[i];\n\t}\n\tfor (re int i = 1, M; i <= cnta; ++i) {\n\t\tM = prod / m[i];\n\t\tans = (ans + qmul(qmul(a[i], M, prod), inv(M, m[i]), prod)) % prod;\n\t}\n\treturn ans;\n}\n\nint n, a[MAXn + 10], m[MAXn + 10];\nsigned main() {\n\tscanf(\"%lld\", &n);\n\tfor (re int i = 1; i <= n; ++i) {\n\t\tscanf(\"%lld\", &a[i]);\n\t}\n\tfor (re int i = 1; i <= n; ++i) {\n\t\tscanf(\"%lld\", &m[i]);\n\t}\t\n\tprintf(\"%lld\\n\", crt(n, a, m));\n}\n```\n\n",
        "postTime": 1625790391,
        "uid": 392727,
        "name": "rsdbk_husky",
        "ccfLevel": 8,
        "title": "Luogu P3868 [TJOI2009]\u731c\u6570\u5b57"
    },
    {
        "content": "# P3868 \u731c\u6570\u5b57\n\n**\u9898\u76ee**\n\n\u6c42\u6700\u5c0f\u7684 $ans$ \u4f7f\n\n$$m\\left\\{\\begin{matrix} \n  \\equiv a_1\\ (mod\\ m_1)\\\\  \n  \\equiv a_2\\ (mod\\ m_2)\\\\\n  ......\\\\\n  \\equiv a_n\\ (mod\\ m_n)\n\\end{matrix}\\right. $$\n\n**\u5206\u6790**\n\n\u8bbe\n\n$$T\\ =\\ \\prod_{i\\ =\\ 1}^{n} m_i\\ ,\\ t_i\\ (i \\in [1,n])\\ = \\ T \\ \\div\\ m_i$$ \n\n\u5219\u6839\u636e $\\texttt{exgcd}$ \uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u51fa\n\n$$\u2200\\ e_i\\ (i \\in [1,n])\\ \\times\\ t_i\\ \\equiv\\ 1\\ (mod\\ m_i)$$\n\n\u663e\u7136 \n\n$$e_i\\ \\equiv\\ 0\\ (mod\\ m_j)\\ (\u2200\\ i \\ne j)$$\n\n\u6240\u4ee5\u5f53\n\n$$ans\\ = \\sum_{i\\ =\\ 1}^{n} a_i\\times e_i\\times t_i\\ mod\\ T$$\n\n\u65f6\uff0c\u6ee1\u8db3\u9898\u76ee\u4e2d\u7684\u8981\u6c42\u3002\n\n**Code**\n\n```cpp\n#include <cstdio>\n#include <algorithm>\n\nusing namespace std;\n\nconst int NR = 15;\nlong long n, a[NR], m[NR], res;\nlong long T, t[NR], e[NR], MOD[NR];\n\ninline long long __lcm(long long a, long long b)\n{\n\treturn a / __gcd(a, b) * b; \n}\n\ninline long long EXGCD(long long a, long long b, long long &x, long long &y)\n{\n\tif (b == 0)\n\t{\n\t\tx = 1, y = 0;\n\t\treturn a;\n\t}\n\tlong long x1, y1;\n\tlong long d = EXGCD(b, a % b, x1, y1);\n\tx = y1, y = x1 - a / b * y1;\n\treturn d;\n}\n\ninline long long MUL(long long x, long long y, long long p)\n{\n\tif (x == 0 || y == 0) return 0;\n\tlong long res = 0;\n\tfor (; y; y >>= 1, x = (x << 1) % p)\n\t    if (y & 1)\n\t\t    res = (res + x) % p;\n    return res;\n}\n\ninline long long CRT()\n{\n\tlong long tmp = MUL(MUL(a[1] % T, t[1] % T, T), e[1] % T, T);\n\tfor (int i = 2; i <= n; i++)\n\t{\n\t\tlong long p = MUL(MUL(a[i] % T, t[i] % T, T), e[i] % T, T);\n\t\ttmp = (tmp + p) % T;\n\t}\n\treturn tmp;\n}\n\ninline void gets()\n{\n\tlong long x = 0, y = 0;\n\tT = 1, MOD[0] = 1;\n\tfor (int i = 1; i <= n; i++)\n\t    T = __lcm(T, m[i]);\n\tfor (int i = 1; i <= n; i++)\n\t    t[i] = T / m[i], EXGCD(t[i], m[i], x, y), e[i] = (x % m[i] + m[i]) % m[i], x = y = 0;\n\treturn;\n}\n\ninline void read()\n{\n\tscanf(\"%lld\", &n);\n\tfor (int i = 1; i <= n; i++)\n\t    scanf(\"%lld\", &a[i]);\n    for (int i = 1; i <= n; i++)\n\t    scanf(\"%lld\", &m[i]);\n\treturn;\n}\n\nint main()\n{\n    read();\n\tgets();\n\tres = CRT();\n\tprintf(\"%lld\\n\", res);\n\treturn 0;\n}\n```",
        "postTime": 1619672832,
        "uid": 384498,
        "name": "soweak",
        "ccfLevel": 0,
        "title": "P3868"
    },
    {
        "content": "EXCRT\u677f\u5b50\u9898\u76ee\n\n\u524d\u7aef\u77e5\u8bc6\uff1aexgcd(Euclid\u6269\u5c55)\n\n\u6211\u7684\u535a\u5ba2[\u6570\u8bba\u77e5\u8bc6](https://zxshetzy.blog.luogu.org/shuo-lun)\n\n\u8fd9\u91cc\u7b80\u5355\u7684\u8bc1\u660e\u4e00\u4e0b\u6269\u5c55\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\uff08EXCRT\uff09\n\n\u65b9\u7a0b\u7ec4\n$$\n\n\\begin{cases}\nx\\equiv a_1(\\mod m_1)\\\\\nx\\equiv a_2(\\mod m_2)\n\\end{cases}\n$$\n\n\n\u6838\u5fc3\u65b9\u7a0b\uff1a\n\n$a=um_1+a_1=vm_2+a_2$\n\n$m=\\operatorname{lcm}(m_1,m_2)$ \uff0c$x\\equiv a(\\mod m)$\n\n\u8bc1\u660e\u4e0a\u9762\u7684\u5f0f\u5b50\uff08\u4e3a\u4ec0\u4e48\u662f $\\operatorname{lcm}$\uff09\n\n\u4ee4 $x=km+a$ \uff0c$\\because x\\equiv a_1(\\mod m_1) $ \u5e76\u4e14 $a=um_1+a_1$ \n\n\u4ee3\u6362\u5f97\n$$\nkm+um_1+a_1\\equiv a_1(\\mod m_1)\n$$\n  $\\because$ \u4e0a\u8ff0\u5f0f\u5b50\u6210\u7acb\n\n\u6240\u4ee5 $km$ \u6ee1\u8db3 $km\\equiv0\uff08\\mod m_1\uff09$ \uff0c \u540c\u7406\u53ef\u8bc1 $km=0(\\mod m_2)$\n\n\u6240\u4ee5 $km$ \u662f $m1,m2$ \u7684\u500d\u6570\uff0c\u4e0d\u59a8\u53d6$\\operatorname{lcm}(m1.m2)$\n\n\u5373\uff1a$x\\equiv a(\\mod m)$\n\n**\u5982\u4f55\u6c42 $a$**\n\n\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\uff1a$ um_1-vm_2=a_2-a_1$\n\nmul(\u9f9f\u901f\u52a0)\n\n```c\nll mul(int a,int b,int p)\n{\n    int ret=0;\n    for (;b;b>>=1,a=(a+a)%p)\n        if (b&1) \n            ret=(ret+a)%p;\n    return ret;\n}\n```\n\u6ce8/ \u7b54\u6848\u6700\u540e\u9700\u8981\u53d6\u6478\uff0c\u5426\u5219\u4f1a\u4e0d\u5b9a\u65f6wa\n```c\n#include <cmath>\n#include <queue>\n#include <cstdio>\n#include <vector>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\n#define int long long\nusing namespace std;\n\n//const int A = 1e7+10;\n//const int B = 1e6+10;\nconst int LL = 1e7 + 7;\nconst int inf = 0x3f3f3f3f;\n\ninline int read() {\n  char c = getchar();\n  int x = 0, f = 1;\n  for ( ; !isdigit(c); c = getchar()) if (c == '-') f = -1;\n  for ( ; isdigit(c); c = getchar()) x = x * 10 + (c ^ 48);\n  return x * f;\n}\n\nint l[LL],b[LL],d,M,n,k,u,v,A,a,m;\n\nvoid exgcd(int a,int b,int &d,int &x,int &y)\n{\n\tif (b) exgcd(b,a%b,d,y,x),y-=x*(a/b);\n\telse d=a,x=1,y=0; \n}\n\nint mul(int a,int b,int p)\n{\n\tint res=0;\n\tfor (;b;b>>=1,a=(a+a)%p)\n\t\tif (b&1) res=(res+a)%p;\n\treturn res;\n}\n\nmain()\n{\n\tk=read();\n\tfor (int i=1;i<=k;i++) l[i]=read();\n\tfor (int i=1;i<=k;i++) b[i]=read();\n\tM=b[1],A=l[1];\n\tint cnt=2;\n\twhile (cnt<=k)\n\t{\n\t\ta=l[cnt],m=b[cnt++];\n\t\tint B=((a-A)%m+m)%m;\n\t\texgcd(M,m,d,u,v);\n\t\tu=mul(u,B/d,m);\n\t\tA+=M*u;\n\t\tM=M/d*m;\n\t\tA=(A+M)%M; \n\t}\n\tprintf(\"%lld\",A%M);\n}\n```",
        "postTime": 1618054974,
        "uid": 230808,
        "name": "Zxsoul",
        "ccfLevel": 4,
        "title": "\u3010\u9898\u89e3\u3011P3868 [TJOI2009]\u731c\u6570\u5b57"
    },
    {
        "content": "\u51e0\u4e4e\u662f\u53cc\u500d\u7ecf\u9a8c\u00b7\u00b7\u00b7\u00b7\u00b7\u00b7\n\n\u7531\u539f\u5f0f\u76f4\u63a5\u8f6c\u5316\u4e3a$n\\equiv a_i\\pmod {b_i}$.\n\n\u7136\u540e\u5c31\u662f\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u677f\u5b50\u3002\n\n**\u4f46\u7a9d\u4e0d\u4f1a\u3002**\n\n\u5176\u5b9e\u8fd9\u79cd\u9898\u8fd8\u6709\u53e6\u4e00\u79cd\u601d\u8def\uff08\u63d0\u4f9b\u4e00\u4e0b\uff09\uff1a\u5206\u6cbb\uff08\u5176\u5b9e\u662f\u4f2a\u7684\uff0c\u4e00\u4e2a\u4e00\u4e2a\u7b97\u4e5f\u53ef\u4ee5\uff09\u3002\n\n\u8be6\u7ec6\u7684\u53ef\u4ee5\u89c1\u7a9d\u7684[\u66f9\u51b2\u517b\u732a](https://www.luogu.com.cn/blog/2007100723874wxz/solution-p1495)\u3002\n\n\u7b80\u8981\u6982\u8ff0\u4e00\u4e0b\uff0c\u5148\u7b97\u524d\u534a\u90e8\u5206\uff0c\u518d\u7b97\u540e\u534a\u90e8\u5206\uff0c\u6700\u540e\u4e24\u4e2a\u5f0f\u5b50\u5408\u5e76\u3002\n\n\u8981\u5408\u5e76\uff0c\u53ea\u8981\u6c42\u51fa\u4e24\u4e2a\u819c\u6570\u4e92\u76f8\u7684\u9006\u5143\uff08\u4e3a\u4ec0\u4e48\uff1f\u89c1\u94fe\u63a5\u597d\u4e86\uff0c\u6216\u8005\u81ea\u5df1\u601d\u8003\uff0c\u8fd9\u5e76\u4e0d\u96be\uff09\u3002\n\n\u9006\u5143\u600e\u4e48\u7b97\uff1f\u6b27\u62c9\u5b9a\u7406\uff0c\u53ea\u9700\u8981\u6c42\u51fa\u819c\u6570\u7684\u6b27\u62c9\u51fd\u6570\u503c\u5c31\u73c2\u4ee5\u4e86\u3002\n\n\u7ebf\u6027\u7b5b\u80af\u5b9a\u8dd1\u4e0d\u591flong long\u8303\u56f4\uff0c\u600e\u4e48\u529e\uff1f\n\n~~\u51c9\u62cc\u3002~~\n\n\u6bcf\u4e2a\u819c\u6570\u521d\u59cb\u8fd8\u4e0d\u523010000\uff08\u597d\u50cf\u662f\uff1f\uff09\uff0c\u73c2\u4ee5\u7ebf\u6027\u7b5b\u6bcf\u4e2a\u521d\u59cb\u819c\u6570\u7684\u9006\u5143\u3002\n\n\u7136\u540e\u7ef4\u62a4\u6b27\u62c9\u51fd\u6570\uff0c\u56e0\u4e3a\u819c\u6570\u90fd\u4e92\u8d28\uff0c\u7f29\u4ee5\u65b0\u6b27\u62c9\u51fd\u6570\u5c31\u662f\u539f\u6765\u7684\u6b27\u62c9\u51fd\u6570\u76f4\u63a5\u76f8\u4e58\u3002\n\nOver.\n\n\u5e76\u4e0d\u662f\u5f88\u8be6\u7ec6\uff0c\u73c2\u4ee5\u89c1\u94fe\u63a5\u3002\n\n\u8fd9\u79cd\u601d\u8def\u7684\u4ee3\u7801\uff08\u7565\u957f\uff0c\u4f46\u662f\u5206\u89e3\u4e0b\u6765\u6bcf\u4e00\u6b65\u90fd\u5f88\u597d\u5199\uff0c\u800c\u4e14\u6ca1\u7ec6\u8282\uff09\uff1a\n```cpp\n//\u5feb\u901f\u5e42\u4f1a\u7206ll\u7f29\u4ee5\u4e0a__int128\n#include<bits/stdc++.h>\n#define int __int128\nusing namespace std;\nint Phi[1000009],prime[1000009],tot;\nbool vis[1000009];\nsigned n;\nint qpow(const int&a,const int&p,const int&tomod){\n\tif(!p)return 1;\n\tint h=qpow(a,p>>1,tomod);\n\th=h*h%tomod;\n\tif(p&1)h=h*a%tomod;\n\treturn h;\n}\nstruct bind{\n\tint mod;\n\tint lft;\n\tint phi;\n\tfriend bind operator * (const bind &x,const bind &y){\n\t\tint k=x.mod*y.mod,ret1=qpow(x.mod,y.phi,k),ret2=qpow(y.mod,x.phi,k);\n\t\treturn (bind){k,(ret1*y.lft%k+ret2*x.lft%k)%k,x.phi*y.phi};\n\t}\n}input[1000009];\nvoid ola(){\n\tPhi[1]=1;\n\tfor(int i=2;i<=1000000;++i){\n\t\tif(!vis[i])prime[++tot]=i,Phi[i]=i-1;\n\t\tfor(int j=1;j<=tot&&prime[j]*i<=1000000;++j){\n\t\t\tvis[i*prime[j]]=1;\n\t\t\tif(i%prime[j])Phi[i*prime[j]]=Phi[i]*(prime[j]-1);\n\t\t\telse{\n\t\t\t\tPhi[i*prime[j]]=Phi[i]*prime[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\nbind solve(const signed&l,const signed&r){\n\treturn l==r?input[l]:solve(l,l+r>>1)*solve((l+r>>1)+1,r);\n}\nvoid write(int x){\n\tif(x>9)write(x/10);\n\tputchar(x%10|48);\n}\nsigned main(){\n\tola();\n\tcin>>n;\n\tfor(signed i=1,j;i<=n;++i)cin>>j,input[i].lft=j;\n\tfor(signed i=1,j;i<=n;++i)cin>>j,input[i]=(bind){j,input[i].lft%j,Phi[j]};\n\twrite(solve(1,n).lft);\n\tputchar('\\n');\n    return 0;\n}\n```",
        "postTime": 1582642125,
        "uid": 250637,
        "name": "UnyieldingTrilobite",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3868 \u3010[TJOI2009]\u731c\u6570\u5b57\u3011"
    },
    {
        "content": "# [TJOI2009]\u731c\u6570\u5b57\n\n## \u4e2d\u56fd\u5269\u4f59\u5b9a\u7406+\u9f9f\u901f\u4e58\n\n\u8fd9\u4e2a\u5927\u6982\u5c31\u662f\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u7684\u677f\u5b50\u9898\u4e86\u554a\u3002\u3002\u3002\n\n## \u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\uff1a\n\n### \u95ee\u9898\uff1a\n\n\u82e5$m_1,m_2...m_n,$\u662f\u4e24\u4e24\u4e92\u8d28\u7684\u6b63\u6574\u6570\uff0c\n\n\u6c42\u89e3\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u7ec4\uff1a\n\n$$f(n)=\\begin{cases}\nx\\equiv a_1\\pmod {m_1}\\\\\nx\\equiv a_2\\pmod {m_2}\\\\\n... ...\\\\\nx\\equiv a_n\\pmod {m_n}\\\\\n\\end{cases}$$\n\n\u7684\u89e3$x$\u3002\n\n### \u89e3\u6cd5\uff1a\n\n\u8bbe$M=\\prod_{i=1}^n,M_i=M/m_i$\n\n$t$\u662f\u540c\u4f59\u65b9\u7a0b$M_it_i\\equiv 1\\pmod {m_i}$\u7684\u4e00\u4e2a\u89e3\n\n[\u5173\u4e8e\u600e\u4e48\u89e3\u540c\u4f59\u65b9\u7a0b](https://www.luogu.org/blog/wyhwyh/gcd-exgcd)\n\n\u7136\u540e\u7b54\u6848\u5c31\u662f\n\n$$x=\\sum_{i=1}^n a_im_it_i$$\n\n### \u8bc1\u660e\uff1a\n\n\u56e0\u4e3a$M_i$\u662f\u5904$m_i$\u5916\u6240\u6709\u6570\u7684\u500d\u6570\uff0c\u6240\u4ee5\n\n$$\\forall k\\not=i,a_iM_it_i\\equiv 0\\pmod {m_k}$$\n\n\u800c\u4e14\n\n$$a_iM_it_i\\equiv a_i\\pmod {m_i}$$\n$$x=\\sum_{i=1}^na_iM_it_i$$\n\n\u539f\u65b9\u7a0b\u6210\u7acb\u3002\n\n### \u901a\u89e3\uff1a\n\n$$x=\\sum_{i=1}^n a_im_it_i$$\n\n\u662f\u95ee\u9898\u7684\u4e00\u4e2a\u7279\u6b8a\u89e3\uff0c\u901a\u89e3\u4e3a\n\n$$x+kM(k\\in Z)$$\n\n#### \u8bc1\u660e\uff1a\n\n\u663e\u7136\uff08\u5927\u96fe\uff09\n\n## \u9f9f\u901f\u4e58\uff1a\n\n$O(logn)$\u7684\u5176\u4ed6\u9898\u89e3\u91cc\u90fd\u6709\uff0c\u5f88\u597d\u7406\u89e3\uff0c\u5c31\u4e0d\u8bf4\u4e86\u3002\n\n### $O(1)$\u7684\u9f9f\u901f\u4e58\uff1a\n\n\u5f53\u4e24\u4e2a\u6570\u4e58\u8d77\u6765\u7206 long long \u7684\u65f6\u5019\uff0c\u9700\u8981\u7528\u5feb\u901f\u4e58\uff0c\u867d\u7136O(1)\u7684\u6bd4O(logn)\u7684\u5feb\u4e86\u8bb8\u591a\uff0c\u4f46\u662f\u4ed6\u8fd8\u662f\u6ca1\u6709\u666e\u901a\u4e58\u5feb\uff0c\u6240\u4ee5\u6211\u53eb\u4ed6\u9f9f\u901f\u4e58qwq\n\n**Code**\n\n```cpp\n\ninline ll qmul(ll x,ll y,ll mod)\n{\n    x%=mod;y%=mod;\n    return ((x*y-(ll)(((long double)x*y+0.5)/mod)*mod)%mod+mod)%mod;\n}\n\n```\n\n\u8fd9\u4e2a\u3002\u3002\u3002\u4e5f\u633a\u597d\u7406\u89e3\u554a\uff0c\u800c\u4e14\u4e5f\u6ca1\u6cd5\u89e3\u91ca\u554aqwq~~\u53ef\u610f\u4f1a\u4e0d\u53ef\u8a00\u4f20~~\n\n\u7136\u540e\u5c31\u662f\u6253\u677f\u5b50\u4e86emmmm\n\n**Code**\n\n```cpp\n#include<algorithm>\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\n\ntypedef long long ll;\ntypedef long double ld;\n\nconst int N = 1e5+1;\nll n,ans;\nll M=1,Mi,a[N],m[N];\n\ninline void file()\n{freopen(\"text.in\",\"r\",stdin);freopen(\"text.out\",\"w\",stdout);}\ninline void closefile()\n{fclose(stdin);fclose(stdout);}\n\ninline void readx(ll &x)\n{\n\tx=0;int s=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9')\n\t{if(ch=='-') s=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9')\n\t{x=(x<<1)+(x<<3)+ch-'0';ch=getchar();}\n\tx*=s;\n}\n\ninline ll qmul(ll x,ll y,ll mod)\n{\n    x%=mod;y%=mod;\n    return ((x*y-(ll)(((long double)x*y+0.5)/mod)*mod)%mod+mod)%mod;\n}\n\ninline void exgcd(ll a,ll b,ll &x,ll &y)\n{\n\tif(b==0) {x=1;y=0;return;}\n\texgcd(b,a%b,y,x);\n\ty=y-a/b*x;\n}\n\ninline void china()\n{\n\tfor(ll i=1;i<=n;++i) readx(a[i]);\n\tfor(ll i=1;i<=n;++i)\n\t{\n\t\treadx(m[i]);\n\t\ta[i]=(a[i]%m[i]+m[i])%m[i];\n\t\tM*=m[i];\n\t}\n\tfor(ll i=1;i<=n;++i)\n\t{\n\t\tMi=M/m[i];\n\t\tll x,y;\n\t\texgcd(Mi,m[i],x,y);\n\t\tx=(x%m[i]+m[i])%m[i];\n\t\tans=((ans+qmul(qmul(a[i],x,M),Mi,M)%M)+M)%M;\n\t}\n\tans=(ans+M)%M;\n\tprintf(\"%lld\\n\",ans);\n}\n\nint main()\n{\n//\tfile();\n\n\treadx(n);\n\tchina();\n\n//\tclosefile();\n\treturn 0;\n}\n\n```",
        "postTime": 1566187616,
        "uid": 55032,
        "name": "wyhwyh",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3868 \u3010[TJOI2009]\u731c\u6570\u5b57\u3011"
    },
    {
        "content": "**\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u7684\u88f8\u9898**\n\n\u9898\u76ee\u8981\u6c42\u7684\u662f\u6700\u5c0f\u7684\u975e\u8d1f\u6574\u6570$n$\u6ee1\u8db3$b_{i}|n-a_{i}(1\\le i\\le k)$\n\n\u5c06\u5176\u8f6c\u5316\u6210\u540c\u4f59\u95ee\u9898\u7684\u65b9\u7a0b\u7ec4\n\n$\\begin{cases}n&\\equiv &a_{1}(mod\\ b_{1})\\\\n&\\equiv &a_{2}(mod\\ b_{2})\\\\n&\\equiv &a_{3}(mod\\ b_{3})\\\\\u2026&\u2026&\\\\n&\\equiv &a_{k}(mod\\ b_{k})\\end{cases}$\n\n\u90a3\u4e48\u5982\u4f55\u53bb\u6c42\u5462\uff0c\u8fd9\u5c31\u8981\u7528\u5230**\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406**\u4e86\n\n\u6211\u4eec\u8bbe$M=\\prod_{i=1}^{n}b_{i}$\uff0c$m_{i}=M/b_{i}$\n\n$x_{i}$\u662f\u65b9\u7a0b$m_{i}\\times x_{i}\\equiv 1(mod\\ b_{i})$\u7684\u4e00\u4e2a\u89e3\uff0c\u53ef\u4ee5\u7531\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u6c42\u5f97\n\n\u90a3\u4e48\u7b54\u6848$n$\u5c31\u4e3a$\\sum_{i=1}^{n}a_{i}\\times m_{i}\\times x_{i}$\n\n\u4e3a\u4ec0\u4e48\u5462\uff0c\u6211\u4eec\u6765\u8bc1\u660e\u4e00\u4e0b\n\n\u56e0\u4e3a$m_{i}=M/b_{i}$\u662f\u9664\u4e86$b_{i}$\u4e4b\u5916\u7684\u6240\u6709$b$\u7684\u79ef\n\n\u6240\u4ee5$\\forall k\\ne i,a_{i}\\times m_{i}\\times x_{i}\\equiv 0(mod\\ m_{k})$\n\n\u7531$t_{i}$\u662f\u65b9\u7a0b$m_{i}\\times x_{i}\\equiv 1(mod\\ b_{i})$\uff0c\u7684\u4e00\u4e2a\u89e3\u5f97$a_{i}\\times m_{i}\\times x_{i}\\equiv a_{i}(mod\\ b_{i})$\n\n\u4ee3\u5165$n=\\sum_{i=1}^{n}a_{i}\\times m_{i}\\times x_{i}$\uff0c\u539f\u65b9\u7a0b\u7ec4\u6210\u7acb\u3002\n\n\u800c\u6211\u4eec\u8981\u6c42\u7684\u662f\u6700\u5c0f\u975e\u8d1f\u6574\u6570\u89e3\uff0c\u90a3\u4e48\u53ea\u9700\u8981\u5c06$n$\u53d6\u6a21$M$\u4f7f\u5176\u843d\u57280~M-1\u7684\u8303\u56f4\u5185\u5373\u53ef\u3002\n\n\u8fd9\u9053\u9898\u7684\u5751\u70b9\u5728\u4e8e\u76f4\u63a5\u76f8\u4e58\u7684\u8bdd\u4f1a\u7206$long\\ long$\uff0c\u90a3\u4e48\u5c31\u9700\u8981\u7528\u5230\u5feb\u901f\u4e58\u4e86\uff0c\u601d\u60f3\u8ddf\u5feb\u901f\u5e42\u4e00\u6837\uff0c\u5199\u8d77\u6765\u4e5f\u5f88\u7b80\u5355\n\n\u8fd8\u6709\u4e00\u70b9\u5c31\u662f\u5bf9\u4e8e\u8d1f\u6570\u7684\u60c5\u51b5\u8981\u52a0\u4e0a$M$\u518d\u6a21$M$\n\n**Code**\n``` cpp\n#include <iostream>\n#include <cstdio>\n#define int long long\nusing namespace std;\nint k,a[20],b[20],M=1,ans;\nvoid exgcd(int a,int b,int &x,int &y) //\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u6c42\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u7684\u89e3\n{\n\tif (!b)x=1,y=0;\n\telse\n\t{\n\t\texgcd(b,a%b,x,y);\n\t\tint t=x;\n\t\tx=y;\n\t\ty=t-a/b*y;\n\t}\n}\nint cc(int x,int y)  //\u5feb\u901f\u4e58\n{\n\tint s=0;\n\tx=(x%M+M)%M;    \n\ty=(y%M+M)%M;    //\u5148\u5c06\u8d1f\u6570\u8f6c\u5316\u4e3a\u6b63\u6570\n\twhile (y)\n\t{\n\t\tif (y&1)s=(s+x)%M;\n\t\tx=x*2%M;\n\t\ty>>=1;\n\t}\n\treturn s;\n}\nsigned main()\n{\n\tcin>>k;\n\tfor (int i=1;i<=k;i++)\n\t\tcin>>a[i];\n\tfor (int i=1;i<=k;i++)\n\t\tcin>>b[i],M*=b[i];\n\tfor (int i=1;i<=k;i++)\n\t{\n\t\tint m=M/b[i],x=0,y=0;\n\t\texgcd(m,b[i],x,y);\n\t\tans=(ans+cc(cc(a[i],m),x))%M;\t\t\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1561295657,
        "uid": 73231,
        "name": "eee_hoho",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3868 \u3010[TJOI2009]\u731c\u6570\u5b57\u3011"
    },
    {
        "content": "CRT\u6a21\u677f\u3002\u5176\u4ed6\u7528CRT\u5199\u7684\u5927\u4f6c\u4f3c\u4e4e\u8981\u4e48\u7528\u4e86\u624b\u5199\u00d7\uff0c\u8981\u4e48\u7528\u4e86int__128\u3002\u6211\u53ea\u662f\u60f3\u8bf4\u4e0d\u8981\u5fd8\u4e86unsigned long long\u3002\u96f6\u98ce\u9669\uff0c\u5e38\u6570\u5c0f\uff0c\u8fd8\u7701\u4e8b\uff0c\u9002\u5408\u8ffd(xi)\u6c42(huan)\u5353(tou)\u8d8a(lan)\u7684oier\u4eec\uff01\n```cpp\n#include<cstdio>\n#include<cctype>\n#define R register\n#define I inline\n#define L unsigned long long\nusing namespace std;\nconst int S=13;\nchar buf[1000000],*p1,*p2;\nI char gc(){return p1==p2&&(p2=(p1=buf)+fread(buf,1,S,stdin),p1==p2)?EOF:*p1++;}\nI int rd(){\n\tR int f=0,b=1; R char c=gc();\n\twhile((c<48||c>57)&&c!=45) c=gc();\n\tif(c==45) b=0,c=gc();\n\twhile(c>47&&c<58) f=f*10+(c^48),c=gc();\n\treturn b?f:~f+1;\n}\nint a[S],b[S],k;\nvoid exgcd(L a,L b,L &x,L &y){\n\tif(b) exgcd(b,a%b,y,x),y-=a/b*x;\n\telse x=1,y=0;\n}\nL crt(){\n\tL o=0,p=1,t,x,y;\n\tR int i;\n\tfor(i=1;i<=k;++i)\n\t\tp=p*b[i];\n\tfor(i=1;i<=k;++i)\n\t\tt=p/b[i],exgcd(t,b[i],x,y),x=(x+b[i])%b[i],o=(o+t*x%p*a[i])%p;\n\treturn (o+p)%p;\n}\nint main(){\n\tR int i;\n\tfor(k=rd(),i=1;i<=k;++i)\n\t\ta[i]=rd();\n\tfor(i=1;i<=k;++i)\n\t\tb[i]=rd(),a[i]=(a[i]+b[i])%b[i];\n\tprintf(\"%lld\",crt());\n\treturn 0;\n}\n\n```",
        "postTime": 1545048352,
        "uid": 91933,
        "name": "newbiechd",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3868 \u3010[TJOI2009]\u731c\u6570\u5b57\u3011"
    },
    {
        "content": "\u672c\u9898\u786e\u5b9e\u662f\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u7684\u88f8\u9898\uff0c\u4f46\u5751\u70b9\u5728\u4e8e\u672c\u9898\u6700\u540e\u4e00\u4e2a\u70b9\u7206long long\n\u90a3\u4e48\u849f\u84bb\u5c31\u6765\u53d1\u4e00\u4e2a__int128\u7684\u9898\u89e3\u3002\n\n__int128\u6570\u636e\u8303\u56f4\u662f\u5dee\u4e0d\u591a $ 2^{127} $\u5de6\u53f3\uff0c\u9002\u5408\u5904\u7406\u4e00\u4e0b\u6bd4long long\u5927\u4e00\u70b9\u7684\u6570\u636e\u3002\u4f46\u662f__int128\u4e0d\u652f\u6301\u8f93\u5165\u8f93\u51fa\uff0c\u8f93\u5165\u4e00\u822c\u5c31\u76f4\u63a5\u628a\u9898\u76ee\u7ed9\u7684\u6570\u636e\u5f3a\u5236\u8f6c\u6362\u4e00\u4e0b\uff0c\u8f93\u51fa\u5c31\u81ea\u5df1\u624b\u5199\u4e00\u4e2a\u3002\n\n\n\u4f46\u849f\u84bb\u4e0d\u662f\u5f88\u61c2__int128 noip \u7701\u9009 noi\u53ef\u4e0d\u53ef\u4ee5\u7528\uff0c\u6709\u6ca1\u6709dalao\u613f\u610f\u5728\u8bc4\u8bba\u91cc\u8bc4\u8bba\u4e00\u4e0b\u3002\u3002\u3002\u3002\n\n\n\n---\n## \u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef __int128 ll;\nconst int maxn=1000000;\nll m[maxn], a[maxn];\nvoid print(__int128 a){\n\tif(!a) return;\n\tprint(a/10); putchar(a%10+'0');\n}\nvoid exgcd(ll a,ll b,ll& x,ll& y){\n\tif(!b){x=1;y=0;return;}\n\telse{ exgcd(b,a%b,y,x); y-=(a/b)*x; }\n}\nll CRT(int n){\n\tll M=1,ans=0;\n\tfor(int i=1;i<=n;i++) M*=m[i];\n\tfor(int i=1;i<=n;i++){\n\t\tll q=M/m[i], x=0, y=0;\n\t\texgcd(q,m[i],x,y); \n\t\tans=(ans+q%M*x%M*a[i]%M+M)%M;\n\t}\n\treturn ans;\n}\nll cal(ll a,ll b){\n\twhile(a<0){ a+=b; }\n\treturn (a+b)%b;\n}\nint main(){\n\tint n;scanf(\"%d\",&n); long long z;\n\tfor(int i=1;i<=n;i++){ scanf(\"%lld\",&z);a[i]=(ll)z; }\n\tfor(int i=1;i<=n;i++){ scanf(\"%lld\",&z);m[i]=(ll)z; }\n\tfor(int i=1;i<=n;i++){ a[i]=cal(a[i],m[i]); }\n\t__int128 x=CRT(n); \n\tif(x!=0) print(CRT(n));  else puts(\"0\");\n\treturn 0;\n}\n```\n\n\u6765\u81ea\u849f\u84bbnoble_\uff0c\u6211\u7684\u535a\u5ba2\uff1a[\u4f20\u9001\u95e8](http://www.cnblogs.com/noblex/)",
        "postTime": 1533992961,
        "uid": 36281,
        "name": "noble_",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3868 \u3010[TJOI2009]\u731c\u6570\u5b57\u3011"
    }
]
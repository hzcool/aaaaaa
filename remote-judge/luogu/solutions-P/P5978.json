[
    {
        "content": "\u76ee\u524d\u7684[\u6700\u4f18\u89e3](https://www.luogu.com.cn/record/list?pid=P5978&orderBy=1&status=&page=1)\u3002\n## Description\n\u7ed9\u5b9a\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u7ec4 $a$ \uff0c\u4f60\u53ef\u4ee5\u5c06\u4efb\u610f\u4e00\u6bb5\u533a\u95f4 $[l,r]$ \u4e2d\u7684\u6bcf\u4e00\u4e2a\u5143\u7d20 $+d$\uff0c\u5176\u4e2d $-x\\le d\\le x$\uff0c\u95ee\u4e00\u6b21\u64cd\u4f5c\u540e\u7684\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u957f\u5ea6\u3002\n## Solution\n\u5982\u679c\u5c06 $[l,r]$ \u533a\u95f4\u5185\u7684\u5143\u7d20\u90fd\u51cf\u5c0f\uff0c\u53ef\u4ee5\u589e\u52a0 $[l,r]$ \u4e0e $[r+1,n]$ \u8fde\u63a5\u7684 LIS \u957f\u5ea6\u3002\u4f46\u8fd9\u6709\u53ef\u80fd\u51cf\u5c0f $[l,r]$ \u4e0e $[1,l-1]$ \u8fd9\u6bb5\u7684 LIS\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8d2a\u5fc3\u7684\u60f3\u5230\uff0c**\u5bf9\u4e8e $d<0$ \u7684\u60c5\u51b5\uff0c\u9009\u62e9 $[1,r]$ \u533a\u95f4\u4e00\u5b9a\u4f1a\u6bd4 $[l,r]$ \u533a\u95f4\u66f4\u4f18**\u3002\n\n\u5bf9\u4e8e $d>0$ \u7684\u60c5\u51b5\u4e5f\u540c\u7406\u3002\u56e0\u4e3a\u533a\u95f4\u5185\u76f8\u5bf9\u5927\u5c0f\u4e0d\u53d8\uff0c\u6240\u4ee5\u4e0d\u96be\u53d1\u73b0\u5c06 $[i+1,n]$ \u52a0\u4e00\u4e2a\u503c\u7684\u6548\u679c\u548c $[1,i]$ \u533a\u95f4\u51cf\u4e00\u4e2a\u503c\u7684\u6548\u679c\u662f\u76f8\u540c\u7684\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u8003\u8651 $d<0$ \u7684\u60c5\u51b5\u3002\n\n\u6211\u4eec\u8fdb\u4e00\u6b65\u5206\u6790\uff0c**\u53ef\u4ee5\u53d1\u73b0\u5c06 $[1,i]$ \u533a\u95f4\u51cf\u7684\u503c\u8d8a\u5927\u4e00\u5b9a\u66f4\u4f18**\u3002\u6240\u4ee5\u539f\u95ee\u9898\u5c31\u53d8\u6210\u4e86**\u6c42 $[1,i]$ \u533a\u95f4\u5185\u7684\u5143\u7d20\u90fd\u51cf\u53bb $x$ \u540e\uff0c\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684\u957f\u5ea6\u6700\u5927\u4e3a\u591a\u5c11**\u3002\n\n\u66b4\u529b\u4fee\u6539 + LIS \u7684\u590d\u6742\u5ea6\u662f $O(n^2\\log n)$ \u7684\uff0c\u9700\u8981\u4f18\u5316\u3002\u8003\u8651\u5230\u4fee\u6539\u8fc7\u540e\u533a\u95f4\u5185\u90e8\u76f8\u5bf9\u5927\u5c0f\u4e0d\u53d8\uff0c\u53ef\u4ee5\u9884\u5148\u6c42\u51fa $[1,i]$ \u533a\u95f4\u4ee5 $a_i$ \u7ed3\u5c3e\u7684 LIS \u957f\u5ea6\uff0c\u4e3a $L_i$\uff0c\u8bbe\u4fee\u6539\u8fc7\u540e $[i,n]$ \u533a\u95f4\u4ee5 $a_i$ \u5f00\u5934\u7684 LIS \u957f\u5ea6\u4e3a $R_i$\uff0c\u7b54\u6848\u5373\u4e3a $\\max\\limits_{i=1}^nL_i+R_i-1$\u3002\u590d\u6742\u5ea6\u662f $O(n\\log n)$ \u7684\uff0c\u8f7b\u677e\u6700\u4f18\u89e3\u3002\n\n\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u79bb\u6563\u5316\u540e\u7528\u6811\u72b6\u6570\u7ec4\u6c42\u6700\u5927\u503c\uff0c\u590d\u6742\u5ea6\u4e0d\u53d8\uff0c\u53ea\u662f\u4ee3\u7801\u590d\u6742\u4e00\u4e9b\uff0c\u6b22\u8fce\u8bfb\u8005\u601d\u8003\u3002\n## Code\n```cpp\n#include <bits/stdc++.h>\n#define Rint register int\nusing namespace std;\nconst int N=2e5+5;\nint n,x,a[N],lis[N],L[N],R[N],ans;\ninline int read()\n{\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n\treturn x*f;\n}\nint main()\n{\n\tn=read(),x=read();\n\tfor(Rint i=1;i<=n;++i)a[i]=read();\n\tmemset(lis,0x7f,sizeof(lis));\n\tfor(Rint i=1;i<=n;++i)\n\t{\n\t\tint j=lower_bound(lis,lis+n,a[i])-lis;\n\t\tlis[j]=a[i];L[i]=j+1;ans=max(ans,L[i]);\n\t}\n\tmemset(lis,0x7f,sizeof(lis));\n\tfor(Rint i=n;i>=1;--i)\n\t{\n\t\tint j=lower_bound(lis,lis+n,-a[i]+x)-lis;\n\t\tint jj=lower_bound(lis,lis+n,-a[i])-lis;\n\t\tlis[jj]=-a[i];ans=max(ans,L[i]+j);\n\t}\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1657943646,
        "uid": 451328,
        "name": "lnwhl",
        "ccfLevel": 6,
        "title": "\u3010\u9898\u89e3\u3011P5978 [CEOI2018] Global warming"
    },
    {
        "content": "# P5978 [CEOI2018]Global warming \u9898\u89e3\n\n\u9898\u610f\uff1a\u7ed9\u5b9a\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u7ec4 $a$ \uff0c\u4f60\u53ef\u4ee5\u5c06\u4efb\u610f\u4e00\u6bb5\u533a\u95f4 $[l,r]$ \u4e2d\u7684\u6bcf\u4e00\u4e2a\u5143\u7d20 $+d$ \uff0c\u5176\u4e2d $-x\\le d\\le x$ \uff0c\u95ee\u4e00\u6b21\u64cd\u4f5c\u540e\u7684\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u957f\u5ea6\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\le n\\le 2\\times 10^5$\u3002\n\n\u601d\u8def\uff1a\u5982\u679c\u628a $[l,r]$ \u533a\u95f4\u7684\u6570\u53d8\u5c0f\uff0c\u53ef\u80fd\u4f1a\u589e\u52a0\u5230\u8fd9\u4e00\u6bb5\u533a\u95f4\u548c\u540e\u9762 $[r+1,n]$ \u63a5\u4e0a\u7684 LCS \u957f\u5ea6\uff0c\u4f46\u540c\u65f6\u53ef\u80fd\u51cf\u5c11 $[1,r]$ \u8fd9\u6bb5\u7684 LCS \u957f\u5ea6\u3002\u4e0d\u96be\u53d1\u73b0\uff0c\u5bf9\u4e8e\u540c\u6837\u7684 $d<0$ \uff0c\u64cd\u4f5c $[1,r]$ \u8fd9\u4e2a\u533a\u95f4\u4e00\u5b9a\u6bd4\u64cd\u4f5c $[l,r]$ \u533a\u95f4\u66f4\u4f18\u3002\n\n\u540c\u65f6\uff0c\u7531\u4e8e\u64cd\u4f5c\u8fc7\u540e\u5143\u7d20\u7684\u76f8\u5bf9\u5927\u5c0f\u4e0d\u53d8\uff0c $[1,r]$ \u51cf\u5c0f $d$ \u548c $[r+1,n]$ \u589e\u52a0 $d$ \u8fd9\u4e24\u4e2a\u64cd\u4f5c\u672c\u8d28\u4e0a\u662f\u4e00\u6837\u7684\u3002\u56e0\u4e3a\u524d\u7f00\u4e2d\u5143\u7d20\u7684\u76f8\u5bf9\u5927\u5c0f\u4e0d\u53d8\uff0c\u4e3a\u4e86 LCS \u66f4\u957f\uff0c\u663e\u7136 $d=x$ \u65f6\u6700\u4f18\u3002\u4e8e\u662f\u9898\u76ee\u5c31\u8f6c\u5316\u6210\u4e86\uff1a\u8003\u8651\u5bf9\u524d\u7f00 $[1,r]$ \u4e2d\u7684\u5143\u7d20 $-x$ \uff0c\u95ee\u64cd\u4f5c\u540e\u6700\u957f\u7684 LCS \u957f\u5ea6\u3002\u66b4\u529b+ LCS \u53ef\u4ee5\u505a\u5230 $O(n^2\\log n)$ \uff0c\u4f46\u8fd9\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u7684\u3002\n\n\u64cd\u4f5c\u4e86\u4e00\u6bb5\u524d\u7f00\u5e76\u4e0d\u4f1a\u5f71\u54cd\u8fd9\u6bb5\u524d\u7f00\u5185\u90e8\u7684 LCS \uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u6c42\u51fa$[1,i]$ \u8fd9\u6bb5\u524d\u7f00\u4ee5 $a_i$ \u4e3a\u7ec8\u70b9\u7684 LCS \u957f\u5ea6\uff0c\u8bb0\u4e3a $L_i$ \u3002\u8bbe $R_i$ \u4e3a\u5728 $[1,i]$ \u533a\u95f4\u4fee\u6539\u8fc7\u540e\uff0c\u4ee5 $a_i$ \u4e3a\u8d77\u70b9\u7684 LCS \uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f\u4e24\u4e2a LCS \u7684\u5408\u5e76\uff1a\n\n$$\\max_{i=1}^n L_i+R_i-1$$\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(n\\log n)$\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i,a,b) for(int i=(a);i<=(b);i++)\n#define per(i,a,b) for(int i=(a);i>=(b);i--)\n#define ll long long\nusing namespace std;\ninline ll read(){\n    ll x=0,f=1;char ch=getchar();\n    while (!isdigit(ch)){if (ch=='-') f=-1;ch=getchar();}\n    while (isdigit(ch)){x=x*10+ch-48;ch=getchar();}\n    return x*f;\n}\nconst int N=2e5+5;\nint n,x,a[N],lis[N],L[N],R[N],ans;\nint main(){\n    n=read(),x=read();\n    rep(i,1,n)a[i]=read();\n    memset(lis,0x3f,sizeof(lis));\n    rep(i,1,n){//\u8ba1\u7b97[1,i]\u7684LIS\n        int j=lower_bound(lis,lis+n,a[i])-lis;\n        lis[j]=a[i];\n        L[i]=j+1;\n        ans=max(ans,L[i]);\n    }\n    memset(lis,0x3f,sizeof(lis));\n    per(i,n,1){//\u8ba1\u7b97\u540e\u7f00\u7684\u4e0b\u964d\u5b50\u5e8f\u5217=\u4ee5i\u4e3a\u8d77\u70b9\u7684\u4e0a\u5347\u5b50\u5e8f\u5217\n        int j=lower_bound(lis,lis+n,-a[i]+x)-lis;\n        int jj=lower_bound(lis,lis+n,-a[i])-lis;\n        lis[jj]=-a[i];\n        ans=max(ans,L[i]+j);\n    }\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n```\n\n",
        "postTime": 1614826754,
        "uid": 218501,
        "name": "ETHANK",
        "ccfLevel": 0,
        "title": "P5978 [CEOI2018]Global warming \u9898\u89e3"
    }
]
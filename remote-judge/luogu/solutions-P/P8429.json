[
    {
        "content": "tag\uff1a\u77e9\u9635\u4e58\u6cd5\r\n\r\n\u9996\u5148\uff0c\u6bcf\u6b21\u64cd\u4f5c\u90fd\u662f\u53ef\u4ee5\u8f6c\u5316\u6210\u4e00\u6b21\u5f02\u6216\u5377\u79ef\u3002\u56e0\u4e3a\u6bcf\u79cd\u72b6\u6001\u90fd\u53ef\u4ee5\u770b\u4f5c\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6570\uff0c\u4e24\u4e2a\u4e8c\u8fdb\u5236\u6570\u5f02\u6216\u540e\u5c31\u662f\u53e6\u5916\u4e00\u79cd\u72b6\u6001\u3002\u800c\u8fd9\u4e24\u4e2a\u72b6\u6001\u5408\u8d77\u6765\u7684\u8d21\u732e\u5c31\u662f\u76f8\u4e58\u7684\u6570\u503c\u3002\r\n\r\n\u8fd9\u6837 $K$ \u6b21\u64cd\u4f5c\u53ef\u4ee5\u8fdb\u884c\u77e9\u9635\u5feb\u901f\u5e42\u6765\u4f18\u5316\u3002\u90a3\u4e48\u73b0\u5728\u7684\u95ee\u9898\u662f\u6bcf $K$ \u6b21\u90fd\u8981\u4fdd\u8bc1\u6240\u6709\u7684\u72b6\u6001\u662f\u5408\u6cd5\u7684\u3002\u5982\u679c\u505a $\\frac n K$ \u6b21\uff0c\u6bcf\u6b21\u6e05\u7a7a\u4e0d\u5408\u6cd5\u7684\u72b6\u6001\u7684\u8bdd\u590d\u6742\u5ea6\u8fd8\u662f\u70b8\u88c2\u3002\u6240\u4ee5\u6211\u4eec\u9700\u8981\u8003\u8651\u4f18\u5316\u4e00\u4e0b\u3002\r\n\r\n\u6211\u4eec\u8003\u8651\u628a $K$ \u6b21\u8f6c\u79fb\u540e\u7684\u7ed3\u679c\u90fd\u538b\u6210\u4e00\u4e2a\u77e9\u9635\uff0c\u8fd9\u4e2a\u77e9\u9635\u7684\u542b\u4e49\u5c31\u662f\u4ece $i$  \u8f6c\u79fb\u5230\u5230 $j$ \u7684\u5408\u6cd5\u65b9\u6848\u6570\uff0c\u5176\u4e2d $i$  \u548c $j$ \u90fd\u662f\u6570\u5b57\uff0c\u800c\u4e0d\u662f\u521a\u624d\u7684\u4e8c\u8fdb\u5236\u72b6\u6001\u3002\u8fd9\u6837\u8fdb\u884c $\\lfloor \\frac n K \\rfloor\\times K$ \u6b21\u8f6c\u79fb\u5c31\u53ef\u4ee5\u7528\u8fd9\u4e2a\u77e9\u9635\u6765\u8fdb\u884c\u5feb\u901f\u5e42\uff0c\u800c\u5269\u4e0b $n\\mod K$ \u7684\u90e8\u5206\u5c31\u53ef\u4ee5\u8f6c\u5316\u56de\u4e8c\u8fdb\u5236\u72b6\u6001\u6765\u8fdb\u884c\u5feb\u901f\u5e42\u3002\r\n\r\n\u6211\u4eec\u6765\u634b\u4e00\u4e0b\u7ef4\u62a4\u7684\u4e1c\u897f\u548c\u8fc7\u7a0b\uff1a\r\n\r\n1. \u5148\u9884\u5904\u7406 $K$ \u6b21\u5f02\u6216\u5377\u79ef\uff0c\u8fd0\u7528\u5feb\u901f\u5e42\uff0c\u5f97\u5230 $f_{i}$ \u4e3a\u5728\u8fdb\u884c $K$ \u6b21\u64cd\u4f5c\u540e\u4ece $0$ \u5230\u53e6\u4e00\u4e2a\u4e8c\u8fdb\u5236\u72b6\u6001\u4e3a $i$ \u7684\u7684\u65b9\u6848\u6570\u3002\r\n2. \u518d\u628a\u7ed3\u679c\u538b\u6210\u77e9\u9635\uff0c\u8bbe $g_{i,j}$ \u8868\u793a $K$ \u6b21\u64cd\u4f5c\u540e\u4ece\u6570\u5b57 $i$ \u8f6c\u79fb\u5230\u6570\u5b57 $j$ \u7684\u65b9\u6848\u6570\uff0c$g_{i,j}=f_{mp_i\\oplus mp_j}$\uff0c$mp_i$ \u8868\u793a\u6570\u5b57 $i$ \u7684\u4e8c\u8fdb\u5236\u72b6\u6001\u8868\u793a\u3002\u7136\u540e\u548c\u4e00\u4e2a\u53ea\u6709 $g_{x,x}=1$ \u5176\u4f59\u4e3a $0$ \u7684\u77e9\u9635\u4e58 $\\frac n K$ \u6b21\uff0c\u540c\u6837\u7528\u5feb\u901f\u5e42\u3002\r\n3. \u628a\u5f97\u5230\u7684\u77e9\u9635\u8f6c\u56de\u4e8c\u8fdb\u5236\u72b6\u6001\u8868\u793a\uff0c\u518d\u8fdb\u884c $n \\bmod K$ \u6b21\u5f02\u6216\u5377\u79ef\u3002\r\n\r\n\u8fd9\u6837\uff0c\u8fd9\u9053\u9898\u5c31\u505a\u5b8c\u4e86\uff0c\u7b54\u6848\u5c31\u662f\u8f93\u51fa\u6bcf\u4e2a\u6570\u5b57\u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e0b\u7684\u5f02\u6216\u5377\u79ef\u4e4b\u540e\u7684\u7ed3\u679c\u3002\r\n\r\n\u4ee3\u7801\uff1a\r\n\r\n```cpp\r\n#include <bits/stdc++.h>\r\nusing namespace std;\r\ntypedef long long ll;\r\nll n,K;int m,X;int sz,num,mx;\r\nint mp[]={3,1,6,21,9,28,18,5,30,29};//\u6bcf\u4e2a\u6570\u7684\u4e8c\u8fdb\u5236\u72b6\u6001\u8868\u793a\r\nll b[102][102],g[102][102],tt[102][102];\r\nstruct martix\r\n{\r\n\tll p[1025];int siz;\r\n\tmartix (int xx){siz=xx;for(int i=0;i<xx;i++) p[i]=0;}\r\n};\r\nconst int mod=1e9+7;\r\nvoid mul(martix &a,martix &f,martix &t)\r\n{\r\n\tfor(int i=0;i<mx;i++) \r\n\t{\r\n\t\tif(!a.p[i]) continue;\r\n\t\tfor(int j=0;j<mx;j++) \r\n\t\t{\r\n\t\t\tif(!f.p[j]) continue;\r\n\t\t\tt.p[i^j]=(t.p[i^j]+a.p[i]*f.p[j]%mod)%mod;\r\n\t\t}\r\n\t}\r\n\tfor(int i=0;i<mx;i++)\r\n\t\ta.p[i]=t.p[i],t.p[i]=0;\r\n}\r\nvoid ksm1(martix &a,martix &f,ll K)//\u5f02\u6216\u5377\u79ef\u7684\u5feb\u901f\u5e42\r\n{\r\n\tmartix t(a.siz);memset(t.p,0,sizeof(t.p));\r\n\twhile(K)\r\n\t{\r\n\t\tif(K&1) mul(f,a,t);\r\n\t\tmul(a,a,t);K>>=1;\r\n\t}\r\n}\r\nvoid ksm2(ll K)//\u77e9\u9635\u4e58\u6cd5\u7684\u5feb\u901f\u5e42\r\n{\r\n\twhile(K)\r\n\t{\r\n\t\tif(K&1) \r\n\t\t{\r\n\t\t\tfor(int k=0;k<num;k++)\r\n\t\t\t{\r\n\t\t\t\tfor(int i=0;i<num;i++)\r\n\t\t\t\t{\r\n\t\t\t\t\tif(!g[i][k]) continue;\r\n\t\t\t\t\tfor(int j=0;j<num;j++)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tif(!b[k][j]) continue;\r\n\t\t\t\t\t\ttt[i][j]=(tt[i][j]+g[i][k]*b[k][j]%mod)%mod;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tfor(int i=0;i<num;i++) for(int j=0;j<num;j++) g[i][j]=tt[i][j],tt[i][j]=0;\r\n\t\t}\r\n\t\tfor(int k=0;k<num;k++)\r\n\t\t{\r\n\t\t\tfor(int i=0;i<num;i++)\r\n\t\t\t{\r\n\t\t\t\tif(!b[i][k]) continue;\r\n\t\t\t\tfor(int j=0;j<num;j++)\r\n\t\t\t\t{\r\n\t\t\t\t\tif(!b[k][j]) continue;\r\n\t\t\t\t\ttt[i][j]=(tt[i][j]+b[i][k]*b[k][j]%mod)%mod;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(int i=0;i<num;i++) for(int j=0;j<num;j++) b[i][j]=tt[i][j],tt[i][j]=0;\r\n\t\tK>>=1;\r\n\t}\r\n}\r\nint find(int x){return (m==1)?mp[x]:((mp[x/10]<<5)|mp[x%10]);}\r\nint main()\r\n{\r\n//\tfreopen(\"p.in\",\"r\",stdin);\r\n\tscanf(\"%d%lld%lld%d\",&m,&n,&K,&X);\r\n\tif(m==1) sz=5,num=10,mx=32;else sz=10,num=100,mx=1024;\r\n\tmartix a(mx),t(mx);\r\n\tmemset(a.p,0,sizeof(a.p));memset(t.p,0,sizeof(t.p));\r\n\tfor(int i=0;i<sz;i++) a.p[1<<i]=1; \r\n\tmartix f(mx);memset(f.p,0,sizeof(f.p));f.p[0]=1;ksm1(a,f,K);\r\n\tfor(int i=0;i<num;i++)\r\n\t{\r\n\t\tfor(int j=0;j<num;j++)\r\n\t\t\tb[i][j]=f.p[find(i)^find(j)];//\u628a\u7ed3\u679c\u538b\u6210\u77e9\u9635\r\n\t}\r\n\tg[X][X]=1; ksm2(n/K);\r\n\tmartix ans(mx);memset(ans.p,0,sizeof(ans.p));\r\n\tfor(int i=0;i<num;i++) ans.p[find(i)]=g[X][i];//\u628a\u77e9\u9635\u7684\u7ed3\u679c\u8f6c\u5316\u56de\u4e8c\u8fdb\u5236\u72b6\u6001\r\n\tmemset(a.p,0,sizeof(a.p));memset(f.p,0,sizeof(f.p));\r\n\tfor(int i=0;i<sz;i++) a.p[1<<i]=1; \r\n\tf.p[0]=1;ksm1(a,f,n%K);\r\n\tmul(ans,f,t);\r\n\tfor(int i=0;i<num;i++)\r\n\t{\r\n\t\tprintf(\"%lld\\n\",ans.p[find(i)]);\r\n\t}\r\n    return (0-0);\r\n}\r\n```\r\n\r\n",
        "postTime": 1663643507,
        "uid": 236523,
        "name": "cc0000",
        "ccfLevel": 7,
        "title": "\u3010\u9898\u89e3\u3011 [COCI2020] Semafor"
    }
]
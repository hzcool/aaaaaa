[
    {
        "content": "\u5927\u610f\uff1a\u5224\u65ad\u4e00\u4e2a\u5b57\u7b26\u4e32\u662f\u5426\u80fd\u591f\u901a\u8fc7\u4e00\u4e2a\u7279\u5b9a\u7684\u4e32\u5206\u88c2\u5f97\u5230\uff0c\u5982\u679c\u53ef\u4ee5\u7684\u8bdd\u8f93\u51fa\u7279\u5b9a\u7684\u4e32\u7684\u957f\u5ea6\u7684\u6700\u5c0f\u503c\uff0c\u5982\u679c\u4e0d\u53ef\u4ee5\u7684\u8bdd\u8f93\u51fa$NIE$\u3002\n\n\u4fd7\u8bdd\u8bf4\u5f97\u597d\uff0c\u6b63\u96be\u5219\u53cd\uff0c\u5206\u88c2\u5f88\u96be\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u60f3\uff1a\u6211\u4eec\u53ef\u4e0d\u53ef\u4ee5\u5c06\u7ed9\u5b9a\u7684\u5b57\u7b26\u4e32\u8fdb\u884c\u5408\u5e76\u5f97\u5230\u8fd9\u4e2a\u6700\u5c0f\u7279\u5b9a\u7684\u4e32\u5462\uff1f\n\n\u5176\u5b9e\u8fd9\u4e2a\u95ee\u9898\u5c31\u50cf\u5341\u5206\u6734\u7d20\u7684\u533a\u95f4$DP$\uff0c\u8003\u8651\u6709\u4e00\u4e2a$dp[l][r]$\uff0c\u6211\u4eec\u9700\u8981\u679a\u4e3e\u4e00\u4e2a\u4e2d\u70b9$k$\uff0c\u8ba1\u7b97\u6c42\u5b83\u6240\u9700\u8981\u7684\u7279\u5b9a\u7684\u4e32\u7684\u4e2a\u6570$dp[l][r]=min(dp[l][r],dp[l][k]+dp[k+1][r]);$\n\n\u5f53\u7136\u4e86\uff0c\u8fd9\u4e2a\u7279\u5b9a\u7684\u4e32\u53ea\u5305\u542b**\u5927\u5199\u5b57\u6bcdS**\uff0c\u5176\u5b9e\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u72b6\u6001\u538b\u7f29\u7684\u65b9\u5f0f\uff0c\u8868\u793a\u5f53\u524d\u533a\u95f4\u53ef\u4ee5\u53d8\u6210\u7684\u5b57\u7b26\u6709\u54ea\u4e9b\uff0c\u90a3\u4e48\u5c31\u662f\u8981\u8003\u8651\u5206\u6210\u7684\u4e24\u4e2a\u90e8\u5206\u53ef\u4ee5\u53d8\u6210\u7684\u5b57\u7b26\u4ee5\u53ca\u53ef\u4ee5\u7ec4\u5408\u6210\u7684\u5b57\u7b26\n\n\u6700\u540e\u53ea\u8981$dp[1][stlen]$\u53ea\u8981\u4e0d\u662f\u6781\u5927\u503c\uff0c\u5c31\u662f\u6709\u89e3\uff0c\u89e3\u662f$dp[1][stlen]$\uff0c\u5426\u5219\u65e0\u89e3\u3002\n\n\u53c2\u8003\u7a0b\u5e8f\n\n```cpp\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<=b;i++)\nusing namespace std;\nconst int maxn=300+10;\nint n,k;\nint Merge[maxn][maxn],zt[maxn][maxn],dp[maxn][maxn];\nint main()\n{\n  scanf(\"%d\",&n);\n  rep(i,1,n)\n  {\n    string ch;\n    cin>>ch;\n    Merge[ch[1]-'A'+1][ch[2]-'A'+1]|=1<<(ch[0]-'A'+1);\n  }\n  scanf(\"%d\",&k);\n  while(k--)\n  {\n    memset(zt,0,sizeof(zt));\n    memset(dp,0x3f,sizeof(dp));\n    string now;\n    cin>>now;\n    int stlen=now.size();\n    rep(i,0,stlen-1)\n    {\n      if(now[i]=='S') dp[i+1][i+1]=1;\n      zt[i+1][i+1]|=(1<<(now[i]-'A'+1));\n    }\n    rep(len,0,stlen-1)\n    {\n      for(int l=1;l+len<=stlen;l++)\n      {\n        int r=l+len;\n        rep(k,l,r-1)\n        {\n          \tdp[l][r]=min(dp[l][r],dp[l][k]+dp[k+1][r]);\n          \trep(x,1,26)\n         \t \trep(y,1,26)\n            \t\tif((zt[l][k]&(1<<(x)))&&(zt[k+1][r]&(1<<(y))))\n              \t\t\tzt[l][r]|=Merge[x][y];\n        }\n        if(zt[l][r]&(1<<('S'-'A'+1))) dp[l][r]=1;\n      }\n    }\n    if(dp[1][stlen]>=0x3f3f3f3f) printf(\"NIE\\n\");\n    else printf(\"%d\\n\",dp[1][stlen]);\n  }\n}\n```\n",
        "postTime": 1605679691,
        "uid": 51800,
        "name": "\u5929\u5357\u5730\u5317",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P6701 \u3010[POI1997] Genotype\u3011"
    },
    {
        "content": "## Subject \n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P6701)\n\n## Analysis\n\u6ce8\u610f\u5230\u57fa\u56e0\u7684\u957f\u5ea6\uff0c\u4e14\u6240\u6709\u4e32\u53ea\u5305\u542b\u5927\u5199\u5b57\u6bcd\u3002\u53d1\u73b0\u5b83\u6ee1\u8db3\u4e00\u4e2a\u4ece\u5c0f\u533a\u95f4\u7684\u7b54\u6848\u63a8\u51fa\u5927\u533a\u95f4\u7b54\u6848\u7684\u6027\u8d28\uff0c\u8003\u8651\u4f7f\u7528\u533a\u95f4 dp \u89e3\u51b3\u3002\n\n\u8bbe $dp[L][R][s]$ \u8868\u793a\u533a\u95f4 $[L,R]$ \u80fd\u5426\u5408\u6210\u5b57\u6bcd $s$ \uff0c\u7136\u540e\u679a\u4e3e\u65ad\u70b9\uff0c\u7528\u5df2\u77e5\u7684\u5206\u88c2\u89c4\u5219\uff0c\u6765\u5224\u65ad\u662f\u5426\u53ef\u4ee5\u5408\u5e76\u56de\u53bb\u3002\n\n\u8be6\u7ec6\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\nfor(int len=2;len<=m;len++){\n    for(int L=1;L+len-1<=m;L++){\n        int R=L+len-1;\n        for(int k=L;k<R;k++){\n            for(int x=1;x<=n;x++){\n                dp[L][R][a[x][0]]|=dp[L][k][a[x][1]]&dp[k+1][R][a[x][2]];\n            }\n        }\n     }\n}\n```\n\n\u7136\u540e\u8bb0 $g_i$ \u8868\u793a\u533a\u95f4 $[1,i]$ \u5168\u90e8\u53ea\u5305\u542b\u5b57\u6bcd S \u7684\u6700\u5c0f\u957f\u5ea6\uff0c\u663e\u7136\u6709\n$$g[i]=\\min\\limits_{0\\leq j<i}  (g[i],g[j]+1) $$ \n\u53ef\u4ee5\u679a\u4e3e\u6240\u6709\u4ee5 $i$ \u4e3a\u53f3\u7aef\u70b9\u7684\u533a\u95f4\u3002\u8f6c\u79fb\u7684\u6761\u4ef6\u662f $dp[j+1][i]['S']$ \u4e3a\u771f\u3002\n\n\u8bb0\u539f\u57fa\u56e0\u7684\u957f\u5ea6\u4e3a $m$ ,\u5219\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(nm^3k)$ \uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n## Code\n```cpp\n#include<map>\n#include<queue>\n#include<cmath>\n#include<vector>\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\nconst int S='S'-'A'+1;\nconst int M=2e3+10;\nconst int Mod=1e5+3;\nconst int inf=0x3f3f3f3f;\nconst double eps=1e-5;\ninline int Read(void){\n    int s=0,f=1;char v=getchar();\n    while(!isdigit(v)){if(v=='-')f=-1;v=getchar();}\n    while(isdigit(v)){s=s*10+v-48;v=getchar();}\n    return s*f;\n}\nchar s[110];\nint n,m,t,a[M][3],g[110];\nbool dp[110][110][30];\nsigned main(void){\n    n=Read();\n    for(int i=1;i<=n;i++){\n        scanf(\"%s\",s);\n        for(int x=0;x<3;x++){\n            a[i][x]=s[x]-'A'+1;\n        }\n    }\n    t=Read();\n    while(t--){\n        scanf(\"%s\",s+1);\n        m=strlen(s+1);\n        memset(dp,false,sizeof dp);\n        for(int i=1;i<=m;i++){\n            dp[i][i][s[i]-'A'+1]=true;\n        }\n        for(int len=2;len<=m;len++){\n            for(int L=1;L+len-1<=m;L++){\n                int R=L+len-1;\n                for(int k=L;k<R;k++){\n                    for(int x=1;x<=n;x++){\n                        dp[L][R][a[x][0]]|=dp[L][k][a[x][1]]&dp[k+1][R][a[x][2]];\n                    }\n                }\n            }\n        }\n        dp[0][0][S]=true;\n        g[0]=0;\n        for(int i=1;i<=m;i++){\n            g[i]=inf;\n            for(int j=0;j<i;j++){\n               if(dp[j+1][i][S]){\n                   g[i]=min(g[i],g[j]+1);\n               }\n            }\n        }\n        if(g[m]==inf) printf(\"NIE\\n\");\n        else printf(\"%d\\n\",g[m]);\n    }\n    return 0;\n}\n```",
        "postTime": 1646713964,
        "uid": 246005,
        "name": "StupidSeven",
        "ccfLevel": 4,
        "title": "P6701"
    },
    {
        "content": "~~**\u6709\u6bd2\u7684\u6570\u636e\u8303\u56f4**~~\n\n\u4f7f\u7528\u533a\u95f4 DP + \u72b6\u538b\uff1a\n\n\u8f6c\u5316\u4e3a\u5c06\u7ed9\u5b9a\u7684\u5b57\u7b26\u4e32\u80fd\u538b\u7f29\u6210\u7684 \u53ea\u542b\u6709 S \u7684\u6700\u77ed\u5b57\u7b26\u4e32\u3002  \n\n\u5bf9\u4e8e\u7ed9\u5b9a\u7684\u5206\u88c2\uff08\u5408\u5e76\uff09\u89c4\u5219\uff0c\u4e5f\u5c31\u662f\u4e24\u4e2a\u5b57\u7b26\u5408\u5e76\u4e3a\u4e00\u4e2a\u5b57\u7b26\uff0c\u6211\u4eec\u7528\u72b6\u538b\u601d\u60f3\uff0c\u4ee5\u4e8c\u8fdb\u5236\u6765\u5b58\u50a8\u8fd9\u4e24\u79cd\u5b57\u7b26\u53ef\u4ee5\u5408\u5e76\u4e3a\u90a3\u4e9b\u79cd\u7c7b\u7684\u5b57\u7b26\uff0c\u4e5f\u5c31\u662f:\n\n```cpp\nc[get(ins[1])][get(ins[2])]|=(1<<(get(ins[0])));\n```\n\n\u518d\u8003\u8651\u5982\u4f55 DP\u3002\n\n\u8bbe $dp_{i,j}$ \u8868\u793a\u533a\u95f4 $[i,j]$ \u4e2d\u7684\u7b54\u6848\uff0c$git_{i,j}$ \u8868\u793a\u533a\u95f4 $[i,j]$ \u53ef\u4ee5\u5408\u5e76\u6210\u4e3a\u90a3\u4e9b\u5b57\u7b26\u3002\n\n\u5728\u8fdb\u884c\u533a\u95f4 DP \u7684\u540c\u65f6\uff0c\u66f4\u65b0 $git_{i,j}$\uff0c\u5982\u679c\u5408\u5e76\u51fa\u4e86 S\uff0c\u5219 $dp_{i,j}=1$\u3002\n\n\u5927\u4f53\u7684\u601d\u8def\u5c31\u662f\u8fd9\u6837\uff0c\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\uff0c\u6211\u5b9e\u73b0\u7684\u4ee3\u7801\u5728\u8d85\u65f6\u7684\u8fb9\u7f18\u53cd\u590d\u6a2a\u8df3\uff0c\u5728\u8fdb\u884c\u4ee5\u4e0b\u4fee\u6539\u540e\u624d\u8dd1\u8fc7 ~~\uff08\u7ed3\u679c\u8dd1\u5230\u4e86\u7b2c3\uff09~~ \u3002\uff08orz 31ms \u5de8\u4f6c\uff09\n\n1. \u5f00\u5c0f\u6570\u7ec4\uff0c\u5b9e\u6d4b\u5bf9\u6b64\u9898\u4f18\u5316\u660e\u663e\u3002\n2. \u5f88\u591a\u5927\u4f6c\u91c7\u7528\u7684\u662f\u679a\u4e3e\u6bcf\u4e2a\u5b57\u7b26\uff0c\u5176\u5b9e\u53ef\u4ee5\u76f4\u63a5\u5b58\u6bcf\u4e00\u79cd\u5408\u5e76\uff0c\u518d\u6765\u679a\u4e3e\uff0c\u8fd9\u6837\u4f1a\u5feb\u4e00\u4e9b\u3002\n\n\u5177\u4f53\u770b\u4ee3\u7801\u5427\uff0c\u8fd8\u662f\u6bd4\u8f83\u597d\u7406\u89e3\u7684\u3002\n\n```cpp\n#include<bits/stdc++.h>\n\nusing namespace std;\n\nconst int MX=105;\n#define LL long long\n#define inf 0x3f3f3f3f\n\n#define modn 10000\n\ninline int read()\n{\n    int x=0,f=1;char ch=getchar();\n    while (!isdigit(ch)){if (ch=='-') f=-1;ch=getchar();}\n    while (isdigit(ch)){x=x*10+ch-48;ch=getchar();}\n    return x*f;\n}\n\nint m;//\u89c4\u5219\u6570\n\nchar ins[10];\nint c[30][30];//\u5408\u5e76\u7528\n\nint git[MX][MX];\n\nchar s[MX];\nint n;\n\ninline int get(char x)\n{\n\treturn x-'A'+1;//1~26\n}\n\nint dp[MX][MX];\n\ninline void csh()\n{\n\tmemset(dp,0x3f,sizeof(dp));\n\tmemset(git,0,sizeof(git));\n}\n\nstruct tCod\n{\n\tint x,y;\n}cod[800];\nint idx=0;\n\nint main(int argc, char const *argv[])\n{\n\tm=read();\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tscanf(\"%s\",ins);\n\t\tif(c[get(ins[1])][get(ins[2])]==0)\n\t\t{\n\t\t\tcod[++idx]=tCod{get(ins[1]),get(ins[2])};\n\t\t}\n\t\tc[get(ins[1])][get(ins[2])]|=(1<<(get(ins[0])));\n\n\t}\n\tint T;\n\tT=read();\n\twhile(T--)\n\t{\n\t\tcsh();\n\t\tscanf(\"%s\",s+1);\n\t\tn=strlen(s+1);\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tif(s[i]=='S')\n\t\t\t{\n\t\t\t\tdp[i][i]=1;\n\t\t\t}\n\t\t\tgit[i][i]|=(1<<(get(s[i])));\n\t\t}\n\t\tfor(int len=0;len<n;len++)\n\t\t{\n\t\t\tfor(int l=1;l+len<=n;l++)\n\t\t\t{\n\t\t\t\tint r=l+len;\n\t\t\t\t//l~k k+1~r\n\t\t\t\tfor(int k=l;k<=r-1;k++)\n\t\t\t\t{\n\t\t\t\t\tdp[l][r]=min(dp[l][r],dp[l][k]+dp[k+1][r]);\n\t\t\t\t\tfor(int q=1;q<=idx;q++)\n\t\t\t\t\t{\n\t\t\t\t\t\tint x=cod[q].x,y=cod[q].y;\n\t\t\t\t\t\tif(c[x][y])//\u5982\u679c\u8fd9\u4e24\u4e2a\u5b57\u7b26\u80fd\u5408\u5e76\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t//git\u662f\u653e\u5355\u5b57\u7b26\u7684\u591a\u60c5\u51b5\u7684\uff0c\u5982\u679c\u80fd\u5408\u5e76\u7684\u8bdd\u5c31\u5408\u5e76\uff0c\u4e00\u4e2a\u533a\u95f4\u5408\u5e76\u6210\u4e00\u4e2a\u5b57\u7b26\uff0c\u7136\u540e\u8bb0\u5f55\u8fd9\u4e00\u4e2a\u5b57\u7b26\u6709\u591a\u5c11\u79cd\u60c5\u51b5\n\t\t\t\t\t\t\tif((git[l][k]&(1<<(x)))&&((git[k+1][r])&(1<<(y))))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tgit[l][r]|=c[x][y];\n\t\t\t\t\t\t\t\t//printf(\"%d %d %d %d\\n\",l,k,r,c[x][y]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\t\n\t\t\t\t\tif((git[l][r]&(1<<(get('S')))))\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[l][r]=1;//\u5982\u679c\u5408\u5e76\u51faS\u4e86\uff0c\u5c31\u76f4\u63a5\u53d8\u62101\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(dp[1][n]==inf) printf(\"NIE\\n\");\n\t\telse printf(\"%d\\n\",dp[1][n]);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1634285405,
        "uid": 64976,
        "name": "hewo",
        "ccfLevel": 5,
        "title": "\u9898\u89e3\uff1aP6701"
    },
    {
        "content": "\u4e66\u866b\u4f9b\u7684\u9898/se\n\n\u8fd8\u6ca1\u4eba\u5199\u9898\u89e3\u3002\n\n\n\u9898\u610f\u662f\u7ed9\u4e00\u4e9b\u64cd\u4f5c\uff0c\u6bcf\u6b21\u53ef\u4ee5\u628a\u4e24\u4e2a\u5b57\u7b26\u7f29\u6210\u4e00\u4e2a\u5b57\u7b26\u3002\u95ee\u6700\u540e\u80fd\u7f29\u6210\u591a\u5c11\u4e2a```'S'```\uff0c\u8981\u4f7f```'S'```\u4e2a\u6570\u6700\u5c11\u3002\n\n\n\u5f88\u5957\u8def\u7684\u533a\u95f4$\\texttt{DP}$\uff0c\u6211\u4eec\u7528$f_{l,r}$\u8868\u793a\u533a\u95f4$[l,r]$\u4e4b\u95f4\u7684\u5b57\u7b26\u80fd\u591f\u7f29\u6210\u54ea\u4e9b\u5b57\u7b26\u3002\u56e0\u4e3a\u5b57\u7b26\u96c6\u5927\u5c0f\u4e3a$26$\uff0c\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u7528\u4e00\u4e2a```int```\u72b6\u6001\u538b\u7f29\u4e00\u4e0b\u5373\u53ef\u3002\n\n$f_{l,r}=calc(f_{l,k},f_{k+1,r})$\u3002\u8fd9\u91cc\u7684$calc$\u662f\u6839\u636e\u7ed9\u5b9a\u7684\u89c4\u5219\u8ba1\u7b97\u4e24\u4e2a\u5b57\u7b26\u96c6\u5408\u6210\u7684\u65b0\u7684\u5b57\u7b26\u96c6\u3002\n\n\u5982\u679c$f_{l,r}$\u5305\u542b$2^{18}$\uff0c\u5373```'S'```\u7684\u72b6\u6001\u8868\u793a\uff0c\u8bf4\u660e\u533a\u95f4$[l,r]$\u53ef\u4ee5\u7f29\u6210\u4e00\u4e2a```'S'```\u3002\n\n\u7136\u540e$g_i$\u8868\u793a\u533a\u95f4$[1,i]$\u80fd\u7f29\u6210\u7684\u6700\u5c11\u957f\u5ea6\u3002\n\n$g_i=\\min\\{g_j+1\\}$\uff0c\u663e\u7136\u8981\u6ee1\u8db3\u533a\u95f4$[j+1,i]$\u80fd\u7f29\u6210\u4e00\u4e2a```'S'```\u3002\n\n\n\u7136\u540e\u8fd9\u9053\u9898\u5c31\u5199\u5b8c\u4e86OoO\u3002\u65f6\u95f4\u590d\u6742\u5ea6$\\operatorname{O(26^2Len^3)}$\u3002\u8fd9\u91cc\u5e38\u6570\u4e0d\u5c0f\u6240\u4ee5\u4fdd\u7559\u4e86\u3002\n\n\n```cpp\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<=b;i++)\n#define pre(i,a,b) for(int i=a;i>=b;i--)\n#define N 10005\nusing namespace std;\nint n,f[105][105],c[27][27],g[105];\nvoid calc(int u,int v,int &x){rep(i,0,25)rep(j,0,25)if((u>>i)&(v>>j)&1)x|=c[i][j];}\nint main(){\n\tscanf(\"%d\",&n);char s[105];\n\trep(i,1,n)scanf(\"%s\",s),c[s[1]-'A'][s[2]-'A']|=1<<(s[0]-'A');\n\tscanf(\"%d\",&n);while(n--){\n\t\tscanf(\"%s\",s+1);int m=strlen(s+1);\n\t\tmemset(f,0,sizeof(f));memset(g,0x3f,sizeof(g));\n\t\trep(i,1,m)f[i][i]=1<<(s[i]-'A');\n\t\tpre(l,m,1)rep(r,l+1,m)rep(k,l,r-1)calc(f[l][k],f[k+1][r],f[l][r]);\n\t\tg[0]=0;rep(i,1,m)rep(j,0,i-1)if(1&(f[j+1][i]>>('S'-'A')))g[i]=min(g[i],g[j]+1);\n\t\tif(g[m]^0x3f3f3f3f)printf(\"%d\\n\",g[m]);else puts(\"NIE\");\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1600947092,
        "uid": 119261,
        "name": "7KByte",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6701 \u3010[POI1997] Genotype\u3011"
    },
    {
        "content": "\u770b\u5230\u9898\u76ee\u4e4b\u540e\u6700\u81ea\u7136\u7684\u601d\u8def\u5c31\u662f\u8003\u8651\u533a\u95f4 $[l, r]$ \u80fd\u4e0d\u80fd\u88ab\u5408\u5e76\u6210\u67d0\u4e2a\u5b57\u6bcd $C$.\n\n\u8bb0\u6bcf\u4e2a Genotype \u4e3a $T$\uff0c$f_{l,r,C}$ \u4e3a\u533a\u95f4 $[l, r]$ \u80fd\u5426\u88ab\u5408\u5e76\u6210\u5355\u4e2a\u5b57\u6bcd $C$. \u663e\u7136\uff0c\u521d\u59cb\u503c\u4e3a $f_{i,i,T_i}=1$\uff0c\u5373\u5355\u4e2a\u5b57\u6bcd\u672c\u8eab\u3002\u4e4b\u540e\u6309\u7167\u533a\u95f4 dp \u7684\u4f20\u7edf\u601d\u8def\uff0c\u5148\u679a\u4e3e\u533a\u95f4\u957f\u5ea6\uff0c\u518d\u679a\u4e3e\u5206\u5272\u70b9 $k$\uff0c\u6700\u540e\u679a\u4e3e $n$ \u4e2a\u5206\u88c2\u89c4\u5219\uff0c\u5c1d\u8bd5\u7528\u6bcf\u4e2a\u89c4\u5219\u5408\u5e76\u5de6\u533a\u95f4\u548c\u53f3\u533a\u95f4\u3002\n\n\u6838\u5fc3\u4ee3\u7801\uff1a\n```cpp\nfor (int i = 1; i <= n; ++i) f[i][i][s[i]] = 1;\nfor (int len = 2; len <= n; ++len)\n    for (int i = 1, j = i + len - 1; j <= n; ++i, ++j) \n        for (int k = i; k < j; ++k)\n            for (int x = 1; x <= m; ++x)\n                f[i][j][a[x][1]] |= f[i][k][a[x][2]] && f[k + 1][j][a[x][3]];\n                // \u5982\u679c S[i,k] \u80fd\u88ab\u5408\u6210 a[x][2], S[k + 1, j] \u80fd\u88ab\u5408\u6210 a[x][3], \u90a3\u4e48\u6839\u636e\u89c4\u5219 x, S[i,j] \u80fd\u88ab\u5408\u6210 a[x][1].\n```\n\n\u5f97\u5230\u6bcf\u4e2a\u533a\u95f4\u80fd\u5426\u88ab\u5408\u6210\u67d0\u4e2a\u5b57\u6bcd\u7684\u6240\u6709\u60c5\u51b5\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u6c42\u51fa $g_i$ \u8868\u793a $T[1,i]$ \u88ab\u5408\u6210**\u53ea\u5305\u542b\u5927\u5199\u5b57\u6bcd $S$ \u7684\u4e32**\u7684\u6700\u5c0f\u957f\u5ea6\u3002\u53ef\u4ee5\u679a\u4e3e\u6240\u6709\u53f3\u7aef\u70b9\u4e3a $i$ \u7684\u533a\u95f4\uff0c$g_i = min\\{g_{j}+1\\}(0\\leq j \\lt i, f_{i,j,'S'}=1)$\u3002\n\n\u6838\u5fc3\u4ee3\u7801\uff1a\n```cpp\nf[0][0][S] = 1;\ng[0] = 0;\nfor (int i = 1; i <= n; ++i)\n    for (int j = 0; j < i; ++j)\n        if (f[j + 1][i][S]) // \u533a\u95f4[j+1, i]\u80fd\u88ab\u5408\u6210 'S'\n            g[i] = min(g[i], g[j] + 1);\n```\n\n\u5b8c\u6574\u4ee3\u7801\u89c1[\u4e91\u526a\u8d34\u677f](https://www.luogu.com.cn/paste/anpbfeog)\u3002",
        "postTime": 1644834212,
        "uid": 120324,
        "name": "Yansuan_HCl",
        "ccfLevel": 7,
        "title": "P6701 [POI1997] Genotype \u9898\u89e3"
    },
    {
        "content": "~~\u6211\u4ea4\u4e86\u90a3\u4e48\u591a\u6b21\u7684\u75db\u82e6\u4f60\u61c2\u5417~~\n\n\u9996\u5148\u611f\u89c9\u6570\u636e\u8303\u56f4\u6709\u95ee\u9898\uff0c\u6211\u7b97\u4e0b\u6765\u6211\u7684\u7a0b\u5e8f\u7684\u89c4\u6a21\u662f\u8fd9\u6837\u7684\uff1a\n$$\n26   \u00d7   26   \u00d7   100   \u00d7   100   \u00d7   100   \u00d7   2000 = 1,352,000,000,000\n$$\n\n\u6211\u4e0d\u884c\u8fd9\u4e2a\u80fd **1s** \u8fc7\n\n\u6211\u4eec\u8003\u8651\u5230\u8fd9\u4e2a\u9898\u7684\u5206\u88c2\u53ef\u4ee5\u53cd\u8fc7\u6765\u53d8\u6210\u5408\u5e76\uff0c\u5176\u5b9e\u5c31\u8f6c\u5316\u6210\u4e86\u95ee\u4f60\u4e00\u4e2a\u4e32\u80fd\u4e0d\u80fd\u5408\u5e76\u6210\u4e00\u4e2a\u53ea\u6709 `S` \u7ec4\u6210\u7684\u4e32\n\n\u90a3\u4e48\u6211\u4eec\u8003\u8651\u6734\u7d20\u7684\u533a\u95f4 dp \u7684\u601d\u8def\uff0c\u7528\u4e00\u4e2a `ans` \u6570\u7ec4\u8868\u793a\u4e00\u4e2a\u533a\u95f4\u53ef\u4ee5\u53d8\u6210\u7684\u6700\u5c0f\u7684\u53ea\u6709 `S` \u7ec4\u6210\u7684\u4e32\u3002\u6211\u4eec\u5982\u679c\u679a\u4e3e\u4e2d\u70b9\uff0c\u4e24\u8fb9\u7684\u90fd\u53ef\u4ee5\u53d8\u6210\u53ea\u6709 `S` \u7ec4\u6210\u7684\u4e32\uff0c\u90a3\u4e48\u8fd9\u4e2a\u533a\u95f4\u4e5f\u53ef\u4ee5\u53d8\u6210\u53ea\u6709 `S` \u7ec4\u6210\u7684\u4e32\n\n\u540c\u65f6\u4e3a\u4e86\u7ef4\u62a4\u4e00\u4e0b\u6211\u4eec\u662f\u5426\u53ef\u4ee5\u53d8\u6210\u53ea\u6709 `S` \u7ec4\u6210\u7684\u4e32\uff0c\u8003\u8651\u7528\u72b6\u538b\u7684\u601d\u8def\uff0c\u7528 `sign` \u6570\u7ec4\u8868\u793a\u5f53\u524d\u533a\u95f4\u53ef\u4ee5\u53d8\u6210\u7684\u5b57\u7b26\u6709\u54ea\u4e9b\uff0c\u8fd9\u5b9e\u9645\u5c31\u8003\u8651\u5206\u6210\u7684\u4e24\u534a\u53ef\u4ee5\u53d8\u6210\u7684\u5b57\u7b26\u53ef\u4ee5\u7ec4\u5408\u6210\u7684\u5b57\u7b26\n\n\u6211\u4eec\u8fd9\u4e2a\u53ef\u4ee5\u7528 `to` \u6570\u7ec4\u5b58\u4e0b\u6765\uff0c\u5f88\u663e\u7136\uff0c\u7531\u4e8e\u53ef\u4ee5\u4e0d\u6b62\u4e00\u79cd\u53d8\u6362\u65b9\u6cd5\uff0c\u6211\u4eec\u4e5f\u8981\u72b6\u538b\n\n\u6700\u540e\u6211\u4eec\u5224\u65ad\u4e00\u4e0b\u5168\u533a\u95f4\u7684 `ans` \u662f\u4e0d\u662f `inf`\uff0c\u5982\u679c\u662f\u663e\u7136\u65e0\u89e3\uff08\u5c31\u76f8\u5f53\u4e8e\u6ca1\u6709\u53d1\u751f\u53d8\u5316\uff0c\u5176\u5b9e\u5982\u679c\u4e00\u5f00\u59cb\u5c31\u662f\u7b26\u5408\u8981\u6c42\u7684\uff0c\u6211\u8fd9\u4e2a\u7a0b\u5e8f\u8fd8\u9700\u8981\u7279\u5224\uff0c\u53ef\u60dc\u51fa\u9898\u4eba\u6ca1\u6709\u6574\u6d3b\uff09\uff0c\u5426\u5219\u6211\u4eec\u76f4\u63a5\u8f93\u51fa `ans`\n\n\u603b\u590d\u6742\u5ea6\uff1a$O(n \\times w^2+q \\times w^2 \\times l^3)$\n\n\u5176\u4e2d $w$ \u4e3a\u5b57\u96c6\u5927\u5c0f\n\n```cpp\n#include <cstdio>\n#include <string>\n#include <iostream>\n#include <cstring>\n\nusing namespace std;\n\nint n,q;\n\nint to[300][300],sign[300][300],ans[300][300];\n\nint main()\n{\n  scanf(\"%d\",&n);\n  for(int i=1;i<=n;i++)\n  {\n    string s;\n    cin>>s;\n    to[s[1]-'A'+1][s[2]-'A'+1]|=1<<(s[0]-'A'+1);\n  }\n  scanf(\"%d\",&q);\n  while(q--)\n  {\n    memset(sign,0,sizeof(sign));\n    memset(ans,0x3f,sizeof(ans));\n    string now;\n    cin>>now;\n    for(int i=0;i<now.size();i++)\n    {\n      if(now[i]=='S') ans[i+1][i+1]=1;\n      sign[i+1][i+1]|=(1<<(now[i]-'A'+1));\n    }\n    for(int len=1;len<=now.size();len++)\n    {\n      for(int l=1;l+len<=now.size();l++)\n      {\n        int r=l+len;\n        for(int k=l;k<r;k++)\n        {\n          ans[l][r]=min(ans[l][r],ans[l][k]+ans[k+1][r]);\n          for(int x=1;x<=26;x++)\n          for(int y=1;y<=26;y++)\n            if((sign[l][k]&(1<<(x)))&&(sign[k+1][r]&(1<<(y))))\n              sign[l][r]|=to[x][y];\n        }\n        if(sign[l][r]&(1<<('S'-'A'+1))) ans[l][r]=1;\n      }\n    }\n    if(ans[1][now.size()]>=0x3f3f3f3f) printf(\"NIE\\n\");\n    else printf(\"%d\\n\",ans[1][now.size()]);\n  }\n}\n```",
        "postTime": 1601200623,
        "uid": 62573,
        "name": "zzqDeco",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6701 \u3010[POI1997] Genotype\u3011"
    },
    {
        "content": "# \u9898\u76ee\u63cf\u8ff0\n\n[\u9898\u9762\u4f20\u8f93\u95e8](https://www.luogu.com.cn/problem/P6701)\n\n\u5927\u610f\uff1a\u4e00\u4e9b\u4e09\u5143\u7ec4 $ABC$ \uff08$ABC$ \u90fd\u662f\u5b57\u7b26\uff09\uff0c\u8868\u793a $A$ \u53ef\u4ee5\u5206\u88c2\u6210 $BC$\uff0c\u7136\u540e\u7ed9\u5b9a\u591a\u4e2a\u5b57\u7b26\u4e32\uff0c\u95ee\u8fd9\u4e9b\u5b57\u7b26\u4e32\u6700\u5c11\u7528\u51e0\u4e2a\u53ea\u6709 $S$ \u5b57\u7b26\u7684\u5b57\u7b26\u4e32\u5206\u88c2\u5f97\u5230\u7684\u3002\n\n# \u89e3\u6cd5\n\n**\u8fd9\u662f\u4e00\u4e2a\u975e\u72b6\u538b\u4e2a\u4eba\u89c9\u5f97\u6bd4\u8f83\u597d\u7406\u89e3\u7684\u89e3\u6cd5**\n\n\u8fd9\u9898\u5f88\u7b26\u5408\u533a\u95f4 dp \u7684\u7279\u5f81\uff0c\u591a\u4e2a\u533a\u95f4\u53ef\u4ee5\u4e24\u4e24\u5206\u89e3\u3001\u5408\u5e76\u662f\u533a\u95f4 dp \u7684\u4e00\u5927\u7279\u5f81\uff0c\u53ef\u4ee5\u5f80\u533a\u95f4 dp \u4e0a\u60f3\u4e00\u60f3\u3002\n\n\u4f46\u662f\u8fd9\u9898\u6570\u636e\u8303\u56f4\u597d\u50cf\u6709\u8bef\uff0c\u5bb9\u6613\u628a\u4eba\u5e26\u504f\u3002\n\n\u4e00\u4e0a\u6765\u7684\u6700\u4f18\u5316\u95ee\u9898\u6211\u4eec\u4e0d\u597d\u89e3\u51b3\u4e0d\u5982\u8bd5\u7740\u628a\u4ed6\u8f6c\u6362\u4e3a\u5224\u5b9a\u6027\u95ee\u9898\uff0c\u4e4b\u540e\u518d\u901a\u8fc7\u5224\u5b9a\u6027\u95ee\u9898\u7684\u89e3\u6784\u9020\u539f\u6765\u7684\u6700\u4f18\u6027\u95ee\u9898\u3002\n\n\u6240\u8c13\u5224\u5b9a\u6027\u95ee\u9898\uff0c\u5c31\u662f\u4e00\u4e2a\u5927\u533a\u95f4\u662f\u5426\u80fd\u7531\u67d0\u4e2a\u5b57\u7b26\u5206\u88c2\u5f97\u51fa\u3002\n\n\u8fd9\u4e2a\u5224\u5b9a\u6027\u95ee\u9898\u5bb9\u6613\u8ba9\u4eba\u8054\u60f3\u5230\u4e00\u4e2a\u533a\u95f4 dp \u7684\u6bd4\u8f83\u7ecf\u5178\u7684\u95ee\u9898[\u73a9\u5177\u53d6\u540d](https://www.luogu.com.cn/problem/P4290)\u3002\n\n\u5f53\u7136\u6ca1\u505a\u8fc7\u4e5f\u6ca1\u5173\u7cfb\uff0c\u4e0b\u9762\u6211\u6765\u5206\u6790\u3002\n\n## \u5224\u5b9a\u6027\u95ee\u9898\u7684\u89e3\u6cd5\n\n\u5b9a\u4e49  $\\mathit{dp}_{i,j,k}$  \u8868\u793a\u533a\u95f4  $[i,j]$  \u662f\u5426\u80fd\u88ab\u5b57\u7b26 $k$ \u5206\u88c2\u5f97\u5230\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\u5904\u7406\u6211\u4eec\u7edf\u4e00\u5c06\u5b57\u7b26\u8f6c\u6362\u6210\u6570\u5b57\u3002\n\n\u72b6\u6001\u5b9a\u4e49\u662f\u4e00\u4e2a\u52a8\u6001\u89c4\u5212\u95ee\u9898\u7684\u5173\u952e\uff0c\u849f\u84bb\u5bf9\u52a8\u6001\u89c4\u5212\u7684\u6bd4\u8f83\u6d45\u663e\u7684\u7406\u89e3\u5c31\u662f\u6211\u4eec\u5148\u6839\u636e\u9898\u76ee\u5b9a\u4e49\u4e00\u4e2a\u72b6\u6001\uff0c \u5047\u8bbe\u6bd4\u8f83\u5c0f\u7684\u72b6\u6001\u5df2\u7ecf\u6c42\u89e3\u597d\u4e86\uff0c\u90a3\u4e48\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u5c0f\u95ee\u9898\u7684\u72b6\u6001\u6784\u6210\u5927\u95ee\u9898\u7684\u72b6\u6001\uff08\u8fd9\u4e4b\u95f4\u9700\u8981\u4e00\u4e9b\u5206\u7c7b\u8ba8\u8bba\uff09\uff0c\u90a3\u4e48\u6211\u4eec\u7684\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5c31\u80fd\u5217\u51fa\u6765\u4e86\uff0c\u95ee\u9898\u5c31\u89e3\u51b3\u7684\u5dee\u4e0d\u591a\u4e86\uff0c\u5426\u5219\u6211\u4eec\u8981\u6839\u636e\u9898\u76ee\u4fe1\u606f\u8c03\u6574\u72b6\u6001\uff0c\u4f8b\u5982 **\u589e\u51cf\u7ef4\u5ea6** \u7b49\u7b49\u3002\n\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5728\u4ee3\u7801\u91cc\uff0c\u4ee3\u7801\u5199\u4e86\u6ce8\u91ca\u6bd4\u8f83\u6e05\u6670\u3002\n\n\n**trick:\u5728\u5217\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u7684\u65f6\u5019\u6211\u4eec\u53ea\u9700\u8981\u5047\u8bbe\u5c0f\u89c4\u6a21\u7684\u95ee\u9898\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u7b54\u6848\u4e86\uff0c\u53ea\u9700\u8981\u8003\u8651\u5927\u7684\u95ee\u9898\u7684\u6700\u540e\u4e00\u6b65\u6709\u54ea\u4e9b\u60c5\u51b5\u5206\u7c7b\u8ba8\u8bba\u5373\u53ef\u3002**\n\n## \u6784\u9020\u539f\u6700\u4f18\u6027\u95ee\u9898\u7684\u89e3\n\n\u6240\u8c13\u6700\u4f18\u6027\u95ee\u9898\u7684\u89e3\u5c31\u662f\u9898\u76ee\u6c42\u7684\u6700\u5c11\u9700\u8981\u51e0\u4e2a $S$ \u7ec4\u6210\u7684\u4e32\u5206\u88c2\u5f97\u5230\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5728\u505a\u5224\u5b9a\u6027\u95ee\u9898\u7684\u65f6\u5019\u7528\u4e00\u4e2a\u6570\u7ec4\u8bb0\u4e0b\u6709\u54ea\u4e9b\u533a\u95f4\u53ef\u4ee5\u7531\u4e00\u4e2a $S$ \u5206\u88c2\u5f97\u5230\uff08\u7ec6\u8282\u4ee3\u7801\u91cc\u6709\uff09\u3002\n\n\u73b0\u5728\u95ee\u9898\u53d8\u6210\u4e86\uff0c\u7ed9\u5b9a\u4e00\u4e9b\u533a\u95f4\uff0c\u95ee\u6700\u5c11\u7528\u51e0\u4e2a\u4e0d\u91cd\u590d\u7684\u533a\u95f4\u8986\u76d6\u6574\u4e2a\u5927\u7684\u533a\u95f4\u3002\n\n\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u57fa\u7840\u7684\u7ebf\u6027 dp \u95ee\u9898\u3002\n\n\u5b9a\u4e49  $f_{i}$  \u8868\u793a\u8986\u76d6\u4ece $1$ \u5230 $i$ \u6700\u5c11\u7528\u51e0\u4e2a\u5c0f\u533a\u95f4\u3002\n\n~~\u4e0d\u96be\u60f3\u5230\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b~~\n\n$\\mathit{f}_{r}=\\max(\\mathit{f}_{l}+1,\\mathit{f}_{r})$\n\n\u5176\u4e2d  $l,r$  \u662f\u67d0\u4e2a\u5c0f\u533a\u95f4\u7684\u5de6\u53f3\u7aef\u70b9\u3002\n\n\u4e3a\u4e86\u4fdd\u8bc1\u8fd9\u4e2adp\u65e0\u540e\u6548\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u5c06\u53f3\u7aef\u70b9\u6392\u5e8f\u3002\n\n\u81f3\u6b64\u95ee\u9898\u89e3\u51b3\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(nklen^3)$ \u6709\u70b9\u5413\u4eba\u4e0d\u8fc7\u8fd9\u9898\u6570\u636e\u6bd4\u8f83\u6c34\uff0c\u4e0d\u5f00 $O2$ \u53ef\u4ee5\u8dd1\u8fc7[\u5f00O2 500\u591ams\u53ef\u4ee5\u63a5\u53d7](https://www.luogu.com.cn/record/84913710)\u3002\n\n# Code\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<iostream>\n#include<vector>\nusing namespace std;\nconst int maxn=110;\nint dp[maxn][maxn][30],n,l[2010][3],f[maxn];\nchar str[110];\nvector<int> v[maxn],vv;//vv\u6570\u7ec4\u5b58\u53f3\u7aef\u70b9\uff0cv[k]\u5b58\u53f3\u7aef\u70b9k\u6240\u6709\u7684\u5de6\u7aef\u70b9\uff0c\u6700\u540edp\u7684\u65f6\u5019\u7528 \nbool vis[maxn];//\u4e00\u4e2a\u53f3\u7aef\u70b9\u6709\u6ca1\u6709\u5b58\u8fc7\uff0c\u907f\u514d\u5197\u4f59\u7684\u4fe1\u606f\u5b58\u8fdbvv\u6570\u7ec4\u4e2d\u5bfc\u81f4\u5e38\u6570\u53d8\u5927 \nint main(){\n\tscanf(\"%d\",&n);\n\tfor(register int i=1;i<=n;i++){\n\t\tchar a[5];\n\t\tscanf(\"%s\",a); \n\t\tl[i][0]=a[0]-'A',l[i][1]=a[1]-'A',l[i][2]=a[2]-'A';//\u5c0f\u6280\u5de7\uff0c\u53ea\u6709\u6ee1\u8db3\u7ed9\u5b9an\u4e2a\u53ef\u4ee5\u5206\u88c2\u7684\u65b9\u6848\u624d\u7528\u4e8e\u8f6c\u79fb\uff0c\u907f\u514d\u4e86\u591a\u4f59\u7684\u65f6\u95f4\u82b1\u8d39\n\t\t//l[i][0]\u53ef\u4ee5\u5206\u88c2\u6210l[i][1]\u548cl[i][2] \n\t}\n\tregister int T;\n\tscanf(\"%d\",&T);\n\twhile(T--){\n\t\tmemset(dp,0,sizeof(dp));\n\t\tfor(int i=0;i<vv.size();i++) v[vv[i]].clear();\n\t\tvv.clear();//\u591a\u7ec4\u6570\u636e\uff0c\u8bb0\u5f97\u6e05\u7a7a\u6570\u7ec4 \n\t\tscanf(\"%s\",str+1);\n\t\tint len=strlen(str+1);\n\t\tfor(register int i=1;i<=len;i++) dp[i][i][str[i]-'A']=1,f[i]=0x3f3f3f3f,vis[i]=0;//\u521d\u59cb\u5316dp\u6570\u7ec4\uff0c\u4e00\u4e2a\u5b57\u7b26\u4e00\u5b9a\u53ef\u4ee5\u76f4\u63a5\u5206\u88c2\u6210\u81ea\u5df1 \n\t\tfor(register int d=2;d<=len;d++)\n\t\t\tfor(register int i=1;i<=len-d+1;i++){\n\t\t\t\tint j=i+d-1;//\u65b0\u624b\u6bd4\u8f83\u4e0d\u5bb9\u6613\u9519\u7684\u533a\u95f4dp\u5199\u6cd5\uff0c\u5148\u679a\u4e3e\u533a\u95f4\u957f\u5ea6\u518d\u679a\u4e3e\u5de6\u7aef\u70b9\uff0c\u7b97\u53f3\u7aef\u70b9\uff0c\u679a\u4e3e\u4e24\u4e2a\u7aef\u70b9\u7684\u65f6\u95f4\u82b1\u9500\u8fd8\u662fO(n^2) \n\t\t\t\tfor(register int k=i;k<j;k++)\n\t\t\t\t\tfor(register int t=1;t<=n;t++){//\u8fd9\u91cc\u8f6c\u79fb\u8981\u82b1O(n*len)\u7684\u65f6\u95f4 \n\t\t\t\t\t\tbool flag=0;\n\t\t\t\t\t\tif(dp[i][j][l[t][0]]==0&&l[t][0]=='S'-'A') flag=1;//\u7b2c\u4e00\u6b21\u66f4\u65b0\u624d\u628a\u8fd9\u4e2a\u53f3\u7aef\u70b9\u548c\u5176\u5bf9\u5e94\u7684\u5de6\u7aef\u70b9 \n\t\t\t\t\t\tdp[i][j][l[t][0]]|=dp[i][k][l[t][1]]&&dp[k+1][j][l[t][2]];//\u6838\u5fc3\uff0c\u5982\u679c\u4e24\u4e2a\u5c0f\u7684\u533a\u95f4\u80fd\u5206\u522b\u5408\u6210l[t][1]\u548cl[t][2]\u5219\u4ed6\u4eec\u7ec4\u5408\u6210\u7684\u5927\u533a\u95f4\u80fd\u5408\u6210l[t][0] \n\t\t\t\t\t\tif(flag&&dp[i][j][l[t][0]]){\n\t\t\t\t\t\t\tv[j].push_back(i);\n\t\t\t\t\t\t\tif(!vis[j]) vis[j]=1,vv.push_back(j);//\u5c06\u53f3\u7aef\u70b9\u52a0\u5165vector\uff0c\u6700\u540e\u7b97\u7b54\u6848\u7684\u65f6\u5019dp\u7528 \n\t\t\t\t\t\t} \n\t\t\t\t\t}\n\t\t\t}\n\t\tsort(vv.begin(),vv.end());\n\t\tfor(register int i=0;i<vv.size();i++)\n\t\t\tfor(register int j=0;j<v[vv[i]].size();j++)\n\t\t\t\tf[vv[i]]=min(f[vv[i]],f[v[vv[i]][j]-1]+1);//\u4e00\u4e2a\u5f88\u57fa\u7840\u7684dp\u95ee\u9898\uff0c\u7ed9\u5b9a\u4e00\u4e9b\u533a\u95f4\uff0c\u95ee\u8fd9\u4e9b\u533a\u95f4\u4e2d\u6700\u5c11\u7528\u51e0\u4e2a\u533a\u95f4\u4e0d\u60f3\u4ea4\u7684\u8986\u76d6\u6574\u4e2a\u5927\u7684\u533a\u95f4 \n\t\tif(f[len]==0x3f3f3f3f) printf(\"NIE\\n\");\n\t\telse printf(\"%d\\n\",f[len]);\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1661257251,
        "uid": 490694,
        "name": "x17875487211",
        "ccfLevel": 4,
        "title": "P6701 [POI1997] Genotype\u9898\u89e3"
    },
    {
        "content": "### \u9898\u610f\n\u7ed9\u5b9a\u4e00\u4e2a\u5b57\u7b26\u4e32\u548c $n$ \u79cd\u5206\u88c2\u65b9\u6848\uff0c\u6c42\u51fa\u6ee1\u8db3\u80fd\u4ece\u82e5\u5e72\u4e2a\u5b57\u7b26\u4e32 $\\text S$ \u5206\u88c2\u6210\u76ee\u6807\u4e32\u7684\u60c5\u51b5\u4e0b\uff0c\u6700\u5c0f\u7684 $\\text S$ \u6570\u91cf\uff0c\u82e5\u8bef\u89e3\u8f93\u51fa ```NIE```\u3002\n### \u601d\u8def\n\u5206\u88c2\u7684\u60c5\u51b5\u8fc7\u4e8e\u590d\u6742\uff0c\u4e8e\u662f\u6211\u4eec\u53cd\u5411\u8003\u8651\u5408\u5e76\u7684\u60c5\u51b5\u3002\u65e2\u7136\u662f\u5408\u5e76\u5c31\u5f88\u5bb9\u6613\u60f3\u5230\u533a\u95f4 dp\u3002\u53ef\u4ee5\u5f97\u51fa\u4e00\u4e2a\u7c97\u7565\u7684\u8f6c\u79fb\u65b9\u7a0b:\n\n\u533a\u95f4\u5185\u4e0d\u80fd\u5168\u90e8\u5408\u5e76\u6210 $\\text S$\uff1a$f_{l,r}=\\min(f_{l,k}+f_{k+1,r})$\n\n\u533a\u95f4\u5185\u53ef\u4ee5\u5168\u90e8\u5408\u5e76\u6210 $\\text S$\uff1a$f_{l,r}=1$\n\n\u5176\u4e2d $f$ \u8868\u793a $l$ \u81f3 $r$ \u8303\u56f4\u4e2d\u5408\u5e76\u4e3a $\\text S$ \u7684\u6700\u5c0f\u4e2a\u6570\u3002\n\n\u73b0\u5728\u7684\u95ee\u9898\u5728\u4e8e\u5982\u4f55\u5feb\u901f\u5224\u65ad\u80fd\u5426\u5408\u5e76\u3002\u65e2\u7136\u53ea\u670926\u4e2a\u5b57\u6bcd\uff0c\u5c06\u4e24\u4e2a\u5b57\u6bcd\u95f4\u80fd\u5408\u5e76\u6210\u7684\u6240\u6709\u5b57\u6bcd\u7684\u96c6\u5408\u72b6\u6001\u538b\u7f29\u540e\u5b58\u5165\u77e9\u9635\uff0c\u5c31\u53ef\u4ee5\u5feb\u901f\u67e5\u8be2\u4e86\u3002\u63a5\u4e0b\u6765\u5728\u8f6c\u79fb\u7684\u8fc7\u7a0b\u4e2d\u66b4\u529b\u66f4\u65b0\u8be5\u533a\u95f4\u80fd\u5408\u5e76\u51fa\u7684\u5b57\u6bcd\u96c6\u5408\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(26^2\\times len^3)$\u3002\n\n\u6700\u540e\uff0c\u4e0d\u8981\u5fd8\u8bb0\u5224\u65ad\u65e0\u89e3\u7684\u60c5\u51b5\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,t;\nchar a[4];\nchar seq[110];\nint f[110][110];\nint now[110][110];\nint mp[110][110];\nsigned main() {\n    cin>>n;\n    int S = 'S' - 'A' + 1;\n    for(int i = 1;i<=n;i++) {\n        cin>>a+1;\n        mp[a[2] - 'A' + 1][a[3] - 'A' + 1] |= (1 << (a[1] - 'A' + 1));\n    }\n    cin>>t;\n    while (t--) {\n        cin>>seq + 1;\n        memset(f, 0x3f, sizeof(f));\n        memset(now, 0, sizeof(now));\n        n = strlen(seq + 1);\n        for(int i = 1; i <= n; i++) {\n            f[i][i]=seq[i]=='S'?1:0x3f3f3f3f;\n            now[i][i] = (1<<(seq[i]-'A'+1));\n        }\n        for(int len = 1;len<n;len++) {\n            for(int l = 1, r = l+len;l<n&&r<=n;l++,r++) {\n                for(int k = l; k < r; k++) {\n                    f[l][r] = min(f[l][r],f[l][k]+f[k+1][r]);\n                    for(int i = 1; i <= 26; i++) \n                        for(int j = 1; j <= 26; j++) \n                            if(now[l][k]&(1<<i)&&now[k+1][r]&(1<<j)) \n                                now[l][r]|=mp[i][j];\n                }\n                if(now[l][r]&(1<<S))f[l][r]=1;\n            }\n        }\n        if(f[1][n]==0x3f3f3f3f)puts(\"NIE\");\n        else cout<<f[1][n]<<endl;\n    }\n    return 0;\n}\n```\n",
        "postTime": 1661252745,
        "uid": 551389,
        "name": "Mr_Min",
        "ccfLevel": 5,
        "title": "P6701"
    },
    {
        "content": "# P6701 [POI1997] Genotype\n\n#### \u3010\u9898\u76ee\u5927\u610f\u3011\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u5927\u5199\u82f1\u6587\u5b57\u6bcd $A-Z$ \u6765\u63cf\u8ff0 Genotype\uff0c\u6bcf\u4e2a\u5b57\u6bcd\u5c31\u4ee3\u8868\u4e00\u4e2a\u57fa\u56e0\u3002\u89c4\u5b9a\u4e00\u79cd\u300c\u5206\u88c2\u300d\u89c4\u5219\uff0c\u7531\u4e09\u4e2a\u5927\u5199\u5b57\u6bcd $A_1A_2A_3$ \u7ec4\u6210\uff0c\u4ee3\u8868 $A_1$ \u53ef\u4ee5\u300c\u5206\u88c2\u300d\u4e3a $A_2A_3$\u3002\u73b0\u5728\u7ed9\u5b9a $n$ \u4e2a\u300c\u5206\u88c2\u300d\u89c4\u5219\u548c $k$ \u4e2a Genotype\uff0c\u5224\u65ad\u8fd9\u4e9b Genotype \u662f\u5426\u80fd\u4ece\u4e00\u4e2a\u7279\u5b9a\u7684 **\u53ea\u5305\u542b\u5927\u5199\u5b57\u6bcd $S$ \u7684** \u4e32\u901a\u8fc7\u300c\u5206\u88c2\u300d\u89c4\u5219\u5f97\u5230\uff0c\u5982\u679c\u53ef\u4ee5\u7684\u8bdd\u8f93\u51fa\u7279\u5b9a\u7684\u4e32\u7684\u957f\u5ea6\u7684\u6700\u5c0f\u503c\uff0c\u5982\u679c\u4e0d\u53ef\u4ee5\u7684\u8bdd\u8f93\u51fa `NIE`\u3002\n\n\u5982\u679c\u4f60\u505a\u8fc7 [P4290](https://www.luogu.com.cn/problem/P4290)\uff0c\u90a3\u4e48\u53ef\u4ee5\u60f3\u5230\u8fd9\u53ef\u80fd\u662f\u4e00\u9053\u533a\u95f4DP\u7684\u9898\u76ee\u3002\u4f46\u662f\u53d1\u73b0\u6570\u636e\u8303\u56f4\u4f3c\u4e4e\u6709\u70b9\u5927\uff0c\u53ef\u80fd\u5e76\u4e0d\u80fd\u7528\u533a\u95f4DP\u53bb\u505a\u3002\u4f46\u4e8b\u5b9e\u4e0a\u6570\u636e\u8303\u56f4\u4e0d\u592a\u5bf9\uff0c\u5199\u6b63\u5e38\u7684\u533a\u95f4DP\u90fd\u53ef\u4ee5\u8fc7\u3002\n\n\u6309\u7167\u533a\u95f4DP\u7684\u57fa\u672c\u60f3\u6cd5\u8bbe\u8ba1\u4e00\u4e0b\u72b6\u6001\u3002\u4e0d\u59a8\u628a\u6240\u8c13\u7684\u201c\u5206\u88c2\u201d\u6210\u4e24\u4e2a\u4e32\u770b\u6210\u4e24\u4e2a\u4e32\u5408\u5e76\u4e3a\u4e00\u4e2a\u4e32\u3002\u9996\u5148\u9898\u76ee\u95ee\u6574\u4e2a\u4e32\u80fd\u5426\u5408\u5e76\u4e3a\u5168\u4e3a\u5b57\u6bcd $S$ \u7684\u4e32\uff0c\u5982\u679c\u53ef\u4ee5\uff0c\u95ee\u8fd9\u4e2a\u5168 $S$ \u4e32\u7684\u6700\u5c0f\u957f\u5ea6\u3002\u7531\u4e8e\u6709\u82e5\u5e72\u5408\u5e76\u89c4\u5219\uff0c\u90a3\u4e48\u663e\u7136\u4e0d\u80fd\u53ea\u8003\u8651\u5b57\u6bcd $S$\u3002\u6240\u4ee5\u53ef\u4ee5\u8bbe\u8ba1\u4e00\u4e2a\u6bd4\u8f83\u76f4\u63a5\u7684\u72b6\u6001\uff1a$dp[i][j][x]$ \u8868\u793a\u533a\u95f4 $[i,j]$ \u4e2d\uff0c\u5c06\u5176\u5408\u5e76\u4e3a\u5168\u662f\u5b57\u6bcd $x$ \u7684\u4e32\uff0c\u8fd9\u4e2a\u4e32\u7684\u6700\u5c0f\u957f\u5ea6\u3002\u8fd9\u6837\u5c31\u4e0d\u96be\u5f97\u5230\u5982\u4e0b\u8f6c\u79fb\uff1a\n\n1. \u82e5 $\\exist\\ k\\in[i,j)$\uff0c\u4f7f\u5f97 $dp[i][k][y]=1$ \u4e14 $dp[k+1][j][z]=$1 \u6210\u7acb\uff0c\u4e14\u5b57\u6bcd $x$ \u53ef\u4ee5\u5206\u88c2\u6210 $y,z$\uff0c\u5219 $dp[i][j][x]=1$\u3002\n2. $dp[i][j][x]=\\min(dp[i][j][x],dp[i][k][x]+dp[k+1][j][x])$\u3002\n\n\u5bf9\u4e8eDP\u6570\u7ec4\u7684\u521d\u503c\uff0c\u9996\u5148\u5e94\u5168\u90e8\u8d4b\u6210 $\\inf$\uff0c\u7136\u540e\u5bf9\u4e8e\u5b57\u7b26\u4e32\u4e2d\u7b2c $i$ \u4e2a\u5b57\u7b26 $x$\uff0c\u6709 $dp[i][i][x]=1$\u3002\u5bf9\u4e8e\u5224\u65ad\u662f\u5426\u53ef\u4ee5\u5206\u88c2\uff0c\u7531\u4e8e\u9898\u76ee\u6ca1\u6709\u7ed9\u51fa\u4efb\u4f55\u4fdd\u8bc1\uff0c\u6240\u4ee5\u6211\u91c7\u7528\u4e00\u4e2a\u4e09\u7ef4\u6570\u7ec4 $trans[x][y][z]$\uff0c\u8bb0\u5f55 $x$ \u662f\u5426\u80fd\u5206\u88c2\u4e3a $y,z$\u3002\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(26^3len^3)$\u3002\u597d\u50cf\u6bd4\u5176\u4ed6\u9898\u89e3\u591a\u4e86\u4e2a $26$\uff0c\u4e0d\u8fc7\u81ea\u8ba4\u4e3a\u601d\u8def\u66f4\u7b80\u5355\u3002\n\n\u53c2\u8003\u4ee3\u7801\u5b9e\u73b0\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define endl '\\n'\nconst int inf=0x3f3f3f3f;\nusing namespace std;\nint trans[30][30][30];\nint dp[110][110][30];\ninline int min(int a, int b){return a<b?a:b;}\nint main(){\n\tios::sync_with_stdio(0);\n\tcin.tie(nullptr);cout.tie(nullptr);\n\tint N,K;cin>>N;\n\tfor (int i=1;i<=N;i++){\n\t\tstring s;cin>>s;\n\t\ttrans[s[0]-'A'][s[1]-'A'][s[2]-'A']=1;\n\t}\n\tcin>>K;\n\twhile (K--){\n\t\tstring s;cin>>s;\n\t\tint n=s.length();\n\t\tmemset(dp,0x3f,sizeof(dp));\n\t\tfor (int i=1;i<=n;i++){\n\t\t\tdp[i][i][s[i-1]-'A']=1;\n\t\t}\n\t\tfor (int len=2;len<=n;len++){\n\t\t\tfor (int i=1;i+len-1<=n;i++){\n\t\t\t\tint j=i+len-1;\n\t\t\t\tfor (int k=i;k<j;k++){\n\t\t\t\t\tfor (int a=0;a<26;a++){\n\t\t\t\t\t\tif (dp[i][k][a]==inf) continue;\n\t\t\t\t\t\tfor (int b=0;b<26;b++){\n\t\t\t\t\t\t\tif (dp[k+1][j][b]==inf) continue;\n\t\t\t\t\t\t\tif (a==b){\n\t\t\t\t\t\t\t\tdp[i][j][a]=min(dp[i][k][a]+dp[k+1][j][b],dp[i][j][a]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tfor (int c=0;c<26;c++){\n\t\t\t\t\t\t\t\tif (trans[c][a][b]){\n\t\t\t\t\t\t\t\t\tif (dp[i][k][a]==dp[k+1][j][b]&&dp[i][k][a]==1)\n\t\t\t\t\t\t\t\t\t\tdp[i][j][c]=1;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (dp[1][n]['S'-'A']>=inf) cout<<\"NIE\"<<endl;\n\t\telse cout<<dp[1][n]['S'-'A']<<endl;\n\t}\n\treturn 0;\n} \n```\n\n\n\n\n\n",
        "postTime": 1649844326,
        "uid": 574568,
        "name": "Dr_Gilbert",
        "ccfLevel": 7,
        "title": "P6701 [POI1997] Genotype"
    }
]
[
    {
        "content": "\u8003\u8651\u6811\u5f62 DP\u3002\u8bbe $f_u$ \u4e3a $u$ \u5904\u6709\u4e00\u4e2a\u5b58\u6863\u70b9\uff0c\u63a5\u4e0b\u6765\u4e0d\u5b58\u6863\uff0c\u8bbf\u95ee\u5b8c\u4ee5 $u$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u6240\u6709\u5267\u60c5\u7684\u6700\u77ed\u65f6\u95f4\u3002\u4e0d\u96be\u5f97\u5230\u8f6c\u79fb\uff08\u8fd9\u91cc\u7684 $s_u$ \u8868\u793a\u4ee5 $u$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u53f6\u5b50\u8282\u70b9\u7684\u4e2a\u6570\uff09\n\n$$f_u=\\sum_{(u,v,w)\\in E}f_v+s_v\\times w$$\n\n\u518d\u8bbe $dp_u$ \u4e3a $u$ \u5904\u6709\u4e00\u4e2a\u5b58\u6863\u70b9\uff0c\u63a5\u4e0b\u6765\u53ef\u4ee5\u5b58\u6863\uff0c\u8bbf\u95ee\u5b8c\u4ee5 $u$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u6240\u6709\u5267\u60c5\u7684\u6700\u77ed\u65f6\u95f4\u3002\u8003\u8651\u8f6c\u79fb\n\n- \u9996\u5148\u6bcf\u4e2a\u5b50\u8282\u70b9 $v$ \u53ef\u4ee5\u4e0d\u5b58\u6863\uff0c\u6700\u77ed\u65f6\u95f4\u4e3a $f_v+s_v\\times w$\uff0c\u4e5f\u53ef\u4ee5\u5b58\u6863\uff0c\u6700\u77ed\u65f6\u95f4\u4e3a $dp_v+w+dep$\uff08$dep$ \u4e3a $u$ \u5230\u6839\u7684\u8ddd\u79bb\uff09\u3002\n- \u7136\u540e\u56e0\u4e3a $u$ \u6709\u4e00\u4e2a\u5b58\u6863\u70b9\uff0c\u6240\u4ee5\u53ef\u4ee5\u6709\u81f3\u591a\u4e00\u4e2a\u5b50\u8282\u70b9\u7684\u6700\u77ed\u65f6\u95f4\u53d8\u4e3a $dp_v+w$\uff0c\u679a\u4e3e\u4e00\u4e0b\u5373\u53ef\u3002\n\n\u6700\u540e\u7b54\u6848\u5373\u4e3a $dp_1$\u3002\n\n\u4ee3\u7801\u8fd8\u662f\u53bb\u5e74\u5199\u7684\u3002\n\n```cpp\n// ===================================\n//   author: M_sea\n//   website: http://m-sea-blog.com/\n// ===================================\n#include <bits/stdc++.h>\n#define re register\nusing namespace std;\ntypedef long long ll;\n \ninline int read() {\n    int X=0,w=1; char c=getchar();\n    while (c<'0'||c>'9') { if (c=='-') w=-1; c=getchar(); }\n    while (c>='0'&&c<='9') X=X*10+c-'0',c=getchar();\n    return X*w;\n}\n \nconst int N=1000000+10;\n \nint n;\n \nstruct edge { int v,w,nxt; } e[N];\nint head[N];\ninline void addEdge(int u,int v,int w) {\n    static int c=0;\n    e[++c]=(edge){v,w,head[u]},head[u]=c;\n}\n \nll s[N],f[N],dp[N];\n \ninline void dfs(int u,ll d) {\n    if (!head[u]) { s[u]=1; return; }\n    ll tmp=0;\n    for (re int i=head[u];i;i=e[i].nxt) {\n        int v=e[i].v,w=e[i].w;\n        dfs(v,d+w); s[u]+=s[v],f[u]+=f[v]+1ll*s[v]*w;\n        tmp+=min(f[v]+1ll*s[v]*w,dp[v]+d+w);\n    }\n    dp[u]=f[u];\n    for (re int i=head[u];i;i=e[i].nxt) {\n        int v=e[i].v,w=e[i].w;\n        dp[u]=min(dp[u],tmp-min(f[v]+1ll*s[v]*w,dp[v]+d+w)+dp[v]+w);\n    }\n}\n \nint main() {\n    n=read();\n    for (re int u=1;u<=n;++u) {\n        for (re int k=read();k;--k) {\n            int v=read(),w=read(); addEdge(u,v,w);\n        }\n    }\n    dfs(1,0); printf(\"%lld\\n\",dp[1]);\n    return 0;\n}\n\n```",
        "postTime": 1610547649,
        "uid": 38370,
        "name": "M_sea",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7232 \u3010[JSOI2014] \u652f\u7ebf\u5267\u60c5 2\u3011"
    }
]
[
    {
        "content": "\u672c\u6587\u540c\u65f6\u4e5f\u4f5c\u4e3a`P6178`\u7684\u9898\u89e3\u3002\n\n# 1.\u884c\u5217\u5f0f\u57fa\u7840\n\n- ## \u884c\u5217\u5f0f\u7684\u5b9a\u4e49\n\n\u5bf9\u4e8e\u4e00\u4e2a\u77e9\u9635 $A[1...n][1...n]$ ,\u5176\u884c\u5217\u5f0f\u4e3a\n\n$\\det(A)=\\sum\\limits_{P}(-1)^{\\mu(P)}\\prod\\limits_{i=1}^nA[i][p_i]$\n\n(\u679a\u4e3e\u6392\u5217 $P[1...n]$ ,\u5176\u4e2d $\\mu(P)$ \u4e3a\u6392\u5217 $P$ \u7684\u9006\u5e8f\u5bf9\u6570)\n\n( $\\det(A)$ \u53c8\u4f5c $|A|$ )\n\n\u4e5f\u5c31\u662f\u8bf4\u5728\u6bcf\u4e00**\u884c**\u6311\u4e00\u4e2a\u4e58\u8d77\u6765,\u7136\u540e\u518d\u62ff\u9006\u5e8f\u5bf9\u6709\u5173\u7684\u4e1c\u897f\u505a\u7cfb\u6570\u3002\n\n\u76f4\u63a5\u6309\u7167\u5b9a\u4e49\u8ba1\u7b97,\u590d\u6742\u5ea6\u662f $O(n!\u00b7n)$ \u7684\u3002\n\n- ## \u884c\u5217\u5f0f\u7684\u6027\u8d28\n\n\u77e5\u9053\u4e86\u4e0b\u9762\u51e0\u6761\u6027\u8d28\u4e4b\u540e,\u6211\u4eec\u5c31\u80fd\u5feb\u901f\u8ba1\u7b97\u884c\u5217\u5f0f\u4e86\u3002\n\n- (0) \u5355\u4f4d\u77e9\u9635 $I$ \u7684\u884c\u5217\u5f0f\u4e3a $1$ \u3002\n\n\u8fd9\u4e2a\u6bd4\u8f83\u663e\u7136,\u56e0\u4e3a $P$ \u9664\u4e86\u5bf9\u89d2\u7ebf\u4e4b\u5916\u6ca1\u6709\u522b\u7684\u9009\u62e9,\u800c\u5bf9\u89d2\u7ebf\u4e58\u79ef\u4e3a $1$\u3002\n\n\u7c7b\u4f3c\u7684,\u4e0a\u4e09\u89d2\u77e9\u9635\u548c\u4e0b\u4e09\u89d2\u77e9\u9635\u7684\u884c\u5217\u5f0f\u90fd\u662f\u5bf9\u89d2\u7ebf\u4e58\u79ef\u3002\n\n- (1) \u4ea4\u6362\u77e9\u9635\u7684\u4e24\u884c,\u884c\u5217\u5f0f\u53d8\u53f7\u3002\n\n(\u6839\u636e\u9006\u5e8f\u5bf9\u611f\u6027\u7406\u89e3\u5373\u53ef)\n\n\u6211\u4eec\u8003\u8651\u5bf9\u4e8e**\u6bcf\u4e2a\u6392\u5217**,\u8fd9\u4e00\u6b21\u4ea4\u6362**\u53ea\u4f1a**\u5f71\u54cd\u4e58\u79ef\u7ec4\u524d\u9762\u7684\u9006\u5e8f\u5bf9\u7cfb\u6570\u3002\n\n\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u5e8f\u5217,\u4ea4\u6362\u4e24\u4e2a\u6570\u5bf9\u4e8e\u9006\u5e8f\u5bf9\u4e2a\u6570\u7684\u5f71\u54cd\u5fc5\u5b9a\u4e3a**\u5947\u6570**(\u53ef\u4ee5\u81ea\u5df1\u8ba8\u8bba\u4e00\u4e0b)\u3002\n\n\u6240\u4ee5\u9006\u5e8f\u5bf9\u7cfb\u6570\u5168\u90e8\u90fd\u6539\u53d8,\u5373\u53d8\u53f7\u3002\n\n- (2) \u82e5\u67d0\u4e00**\u884c**\u4e58\u4ee5 $t$ ,\u884c\u5217\u5f0f\u5c31\u4e5f\u4e58\u4ee5 $t$ \u3002\n\n\u8fd9\u4e2a\u6bd4\u8f83\u597d\u7406\u89e3,\u56e0\u4e3a\u8fd9\u4e00\u884c**\u9009\u4e14\u53ea\u9009**\u4e00\u4e2a\u561b\u3002\n\n- (3) \u770b\u516c\u5f0f:\n\n$\\begin{vmatrix}a+a'&b+b'\\\\c&d\\end{vmatrix}=\\begin{vmatrix}a&b\\\\c&d\\end{vmatrix}+\\begin{vmatrix}a'&b'\\\\c&d\\end{vmatrix}$\n\n\u8fd8\u662f\u56e0\u4e3a\u4e00\u884c\u9009\u4e14\u53ea\u9009\u4e00\u4e2a,\u7136\u540e**\u4e58\u6cd5\u5206\u914d\u5f8b**\u5c31\u597d\u4e86\u3002\n\n(2,3\u5408\u8d77\u6765\u5c31\u662f**\u884c**\u7684\u7ebf\u6027\u6027)\n\n- (4) \u6709\u67d0\u4e24\u884c\u4e00\u6837\u7684\u77e9\u9635,\u884c\u5217\u5f0f\u662f $0$.\n\n\u8fd9\u4e2a\u8bc1\u660e\u6bd4\u8f83\u5de7\u5999 : \u8003\u8651\u4ea4\u6362\u76f8\u540c\u7684\u8fd9\u4e24\u884c,\u6839\u636e(1)\u5f97\u884c\u5217\u5f0f**\u53d8\u53f7**\u3002\n\n\u4f46\u662f\u77e9\u9635\u5e76\u6ca1\u6709\u5b9e\u8d28\u7684\u6539\u53d8,\u884c\u5217\u5f0f**\u4e0d\u53d8**,\u6240\u4ee5\u884c\u5217\u5f0f\u7684\u503c\u53ea\u80fd\u662f $0$.\n\n- (5) \u7528\u77e9\u9635\u7684\u4e00\u884c\u52a0\u4e0a\u53e6\u4e00\u884c\u7684\u500d\u6570,\u884c\u5217\u5f0f\u4e0d\u53d8\u3002\n\n\u8003\u8651\u6784\u9020(**\u7701\u7565\u7684\u90e8\u5206\u8868\u793a\u4e0d\u53d8**):\n\n\u6b32\u8bc1$\\begin{vmatrix}a&b&c\\\\.&.&.\\\\d&e&f\\end{vmatrix}=\\begin{vmatrix}a&b&c\\\\.&.&.\\\\d+ka&e+kb&f+kc\\end{vmatrix}$\n\n\n\u9996\u5148\u6784\u9020\u4e00\u4e2a$\\begin{vmatrix}a&b&c\\\\.&.&.\\\\a&b&c\\end{vmatrix}$,\u6839\u636e(4)\u5f97\u5176\u503c\u4e3a0.\n\n\u53c8\u6839\u636e(2)\u5f97$\\begin{vmatrix}a&b&c\\\\.&.&.\\\\ka&kb&kc\\end{vmatrix}$\u4e5f\u4e3a0\u3002\n\n\u7136\u540e\u6839\u636e(3)\u5f97\n\n$$\\begin{vmatrix}a&b&c\\\\.&.&.\\\\d+ka&e+kb&f+kc\\end{vmatrix}=\\begin{vmatrix}a&b&c\\\\.&.&.\\\\d&e&f\\end{vmatrix}+\\begin{vmatrix}a&b&c\\\\.&.&.\\\\ka&kb&kc\\end{vmatrix}=\\begin{vmatrix}a&b&c\\\\.&.&.\\\\d&e&f\\end{vmatrix}$$\n\n- ## \u6d88\u5143\u6c42\u884c\u5217\u5f0f\n\n\u5176\u5b9e\u6211\u4eec\u4e0a\u9762\u8bc1\u660e\u7684\u6027\u8d28,\u5c31\u662f\u4e3a\u8fd9\u4e2a\u6765\u6253\u57fa\u7840\u7684\u3002\n\n\u6211\u4eec\u6d88\u5143\u7684\u65f6\u5019,\u53ea\u662f\u7528\u4e86 {\u4ea4\u6362\u4e24\u884c, \u67d0\u4e00\u884c\u4e58\u4e00\u4e2a\u5e38\u6570, \u4e00\u884c\u52a0\u4e0a\u53e6\u4e00\u884c\u7684\u500d\u6570} \u4e09\u79cd\u64cd\u4f5c\u3002\n\n\u90a3\u4e48,\u6211\u4eec\u5bf9\u4e8e $A$ \u8fdb\u884c\u6d88\u5143,\u7136\u540e\u8bb0\u5f55\u64cd\u4f5c\u5bf9\u4e8e\u884c\u5217\u5f0f\u7684\u5f71\u54cd,\u6700\u540e\u5f97\u5230\u4e0a\u4e09\u89d2\u77e9\u9635,\u884c\u5217\u5f0f\u5c31\u662f\u5bf9\u89d2\u7ebf\u4e58\u79ef,\u5982\u679c\u6d88\u4e0d\u51fa\u6765\u90a3\u4e48\u8fd4\u56de $0$\u3002\n\n\u6700\u540e\u518d\u628a\u5f71\u54cd\u9006\u56de\u53bb\u5373\u53ef\u3002\n\n# 2.\u77e9\u9635\u6811\u5b9a\u7406\u4e0e\u90e8\u5206\u6269\u5c55\n\n(\u9ed8\u8ba4\u56fe\u4e2d**\u65e0\u81ea\u73af**)\n\n- ## \u7ecf\u5178\n\n\u7ed9\u51fa\u4e00\u4e2a\u65e0\u5411\u65e0\u6743\u56fe,\u8bbe $A$ \u4e3a\u90bb\u63a5\u77e9\u9635, $D$ \u4e3a\u5ea6\u6570\u77e9\u9635( $D[i][i]=$\u8282\u70b9 $i$ \u7684\u5ea6\u6570,\u5176\u4ed6\u7684\u65e0\u503c)\u3002\n\n\u5219\u57fa\u5c14\u970d\u592b(Kirchhoff)\u77e9\u9635\u5373\u4e3a : $K=D-A$\n\n\u7136\u540e\u4ee4 $K'$ \u4e3a $K$ \u53bb\u6389**\u7b2ck\u884c\u4e0e\u7b2ck\u5217**(k\u4efb\u610f)\u7684\u7ed3\u679c($n-1$\u9636\u4e3b\u5b50\u5f0f),\n\n$\\det(K')$ \u5373\u4e3a\u8be5\u56fe\u7684\u751f\u6210\u6811\u4e2a\u6570\u3002\n\n~~\u8bc1\u660e\u4e0d\u4f1a\u3002\u611f\u5174\u8da3\u7684\u540c\u5b66\u53ef\u4ee5\u81ea\u884c\u767e\u5ea6\u3002~~\n\n**\u4f8b\u9898** : [P4336 [SHOI2016]\u9ed1\u6697\u524d\u7684\u5e7b\u60f3\u4e61](https://www.luogu.org/problemnew/show/P4336)\n\n- ## \u52a0\u6743\u6269\u5c55\n\n\u5bb9\u6613\u7406\u89e3 : \u5e26\u91cd\u8fb9\u7684\u60c5\u51b5,\u4e0a\u9762\u7684\u7ecf\u5178\u77e9\u9635\u6811\u5b9a\u7406\u4e5f\u662f\u80fd\u591f\u5904\u7406\u7684\u3002\n\n\u6839\u636e\u4e58\u6cd5\u539f\u7406,\u5bf9\u4e8e\u67d0\u79cd\u751f\u6210\u6811\u7684\u5f62\u6001,\u5176\u8d21\u732e\u4e3a**\u6bcf\u6761\u8fb9\u91cd\u7684\u6b21\u6570\u7684\u4e58\u79ef**\u3002\n\n\u5982\u679c\u628a\u91cd\u8fb9\u6b21\u6570\u7406\u89e3\u6210\u6743\u503c\u7684\u8bdd,\u90a3\u4e48\u77e9\u9635\u6811\u5b9a\u7406\u6c42\u7684\u5c31\u662f : \u6240\u6709\u751f\u6210\u6811\u8fb9\u6743\u4e58\u79ef\u7684\u603b\u548c\u3002\n\n(\u8fd9\u91cc\u6ce8\u610f\u5ea6\u6570\u77e9\u9635\u53d8\u6210\u4e86\u76f8\u90bb\u8fb9\u7684\u6743\u503c\u548c)\n\n**\u4f8b\u9898** : [P3317 [SDOI2014]\u91cd\u5efa](https://www.luogu.com.cn/problem/P3317)\n\n- ## \u6709\u5411\u6269\u5c55\n\n\u524d\u9762\u90fd\u662f\u65e0\u5411\u56fe,\u795e\u5947\u7684\u662f\u6709\u5411\u56fe\u7684\u60c5\u51b5\u4e5f\u662f\u53ef\u4ee5\u505a\u7684\u3002\n\n(\u90bb\u63a5\u77e9\u9635 $A$ \u7684\u610f\u4e49\u540c\u6709\u5411\u56fe\u90bb\u63a5\u77e9\u9635)\n\n\u90a3\u4e48\u73b0\u5728\u7684\u77e9\u9635 $D$ \u5c31\u8981\u53d8\u4e00\u4e0b\u4e86\u3002\n\n\u82e5 $D[i][i]=\\sum\\limits_{j=1}^nA[j][i]$ ,\u5373**\u5230\u8be5\u70b9\u7684\u8fb9\u6743\u603b\u548c(\u5165)**\u3002\n\n\u6b64\u65f6\u6c42\u7684\u5c31\u662f**\u5916\u5411\u6811** (\u4ece\u6839\u5411\u5916)\n\n\u82e5 $D[i][i]=\\sum\\limits_{j=1}^nA[i][j]$ ,\u5373\u4ece**\u4ece\u8be5\u70b9\u51fa\u53d1\u7684\u8fb9\u6743\u603b\u548c(\u51fa)**\u3002\n\n\u6b64\u65f6\u6c42\u7684\u5c31\u662f**\u5185\u5411\u6811** (\u4ece\u5916\u5411\u6839)\n\n(\u5982\u679c\u8003\u573a\u4e0a\u4e0d\u5c0f\u5fc3\u5fd8\u6389\u4e86,\u53ef\u4ee5\u624b\u73a9\u5c0f\u6837\u4f8b)\n\n(\u540c\u6837\u53ef\u4ee5\u52a0\u6743!)\n\n\u6b64\u5916,\u65e2\u7136\u662f\u6709\u5411\u7684,\u90a3\u4e48\u5c31\u9700\u8981**\u6307\u5b9a\u6839**\u3002\n\n\u524d\u9762\u63d0\u8fc7\u8981\u4efb\u610f\u53bb\u6389\u7b2c $k$ \u884c\u4e0e\u7b2c $k$ \u5217,\u662f\u56e0\u4e3a\u65e0\u5411\u56fe\u6240\u4ee5\u4e0d\u7528\u5728\u610f\u8c01\u4e3a\u6839\u3002\n\n\u5728\u6709\u5411\u6811\u7684\u65f6\u5019\u9700\u8981\u7406\u89e3\u4e3a\u6307\u5b9a\u6839,\u7ed3\u8bba\u662f : \u53bb\u6389\u54ea\u4e00\u884c\u5c31\u662f\u90a3\u4e00\u4e2a\u5143\u7d20\u4e3a\u6839\u3002\n\n**\u4f8b\u9898** : [P4455 [CQOI2018]\u793e\u4ea4\u7f51\u7edc](https://www.luogu.com.cn/problem/P4455) (\u5185\u5411\u6811)\n\n\u672c\u9898\u5c31\u662f\u5916\u5411\u6811,\u4e0b\u9762\u7ed9\u51fa\u4ee3\u7801(\u51fa\u4e4e\u610f\u6599,\u8dd1\u7684\u8fd8\u633a\u5feb)\u3002\n\n```cpp\n#include<algorithm>\n#include<cstdio>\n#define ll long long\n#define mod 1000000007\n#define Maxn 305\nusing namespace std;\nll powM(ll a,int t=mod-2)\n{\n  ll ans=1;\n  while(t){\n    if (t&1)ans=ans*a%mod;\n    a=a*a%mod;t>>=1;\n  }return ans;\n}\nint n,m;\nll *a[Maxn],_a[Maxn][Maxn];\nll det(ll **a)\n{\n  ll ans=1;bool tr=0;\n  for (int j=1;j<n;j++){\n    for (int i=j;i<n;i++)\n      if (a[i][j]){\n        if (i!=j){\n          swap(a[i],a[j]);\n          tr=!tr;\n        }break;\n      }\n  \tif (a[j][j]==0)return 0;\n  \tans=ans*a[j][j]%mod;\n  \tll t=powM(a[j][j]);\n  \tfor (int k=j;k<n;k++)a[j][k]=t*a[j][k]%mod;\n    for (int i=j+1;i<n;i++){\n  \t  t=mod-a[i][j];\n  \t  for (int k=j;k<n;k++)\n  \t    a[i][k]=(a[i][k]+t*a[j][k])%mod;\n    }\n  }return tr? (mod-ans)%mod : ans;\n}\nint op;\nint main()\n{\n  scanf(\"%d%d%d\",&n,&m,&op);\n  for (int i=1;i<=n;i++)a[i]=_a[i];\n  for (int i=1,f,t,w;i<=m;i++){\n    scanf(\"%d%d%d\",&f,&t,&w);\n    if (f==n)f=1;else if (f==1)f=n;\n    if (t==n)t=1;else if (t==1)t=n;\n    if (op==1){\n      a[f][t]=(a[f][t]-w+mod)%mod;\n      a[t][t]=(a[t][t]+w)%mod;\n    }else {\n      a[f][t]=(a[f][t]-w+mod)%mod;\n      a[t][t]=(a[t][t]+w)%mod;\n      a[t][f]=(a[t][f]-w+mod)%mod;\n      a[f][f]=(a[f][f]+w)%mod;\n    }\n  }printf(\"%lld\",det(a));\n  return 0;\n}\n```",
        "postTime": 1576040414,
        "uid": 58705,
        "name": "command_block",
        "ccfLevel": 10,
        "title": "\u77e9\u9635\u6811\u5b9a\u7406(+\u884c\u5217\u5f0f)"
    },
    {
        "content": "\u7f51\u4e0a\u8c8c\u4f3c\u8bc1\u660e\u6bd4\u8f83\u5c11\uff0c\u800c\u4e14\u4e0d\u5168\uff0c\u4e8e\u662f\u6765 ~~\u6c34\u4e00\u7bc7\u535a\u5ba2~~\u3002\n\n\u9996\u5148\u4ecb\u7ecd\u884c\u5217\u5f0f\u53ca\u5176\u57fa\u672c\u6027\u8d28\uff1a\n\n## \u884c\u5217\u5f0f\u4e4b\u524d\n\n\u5b9a\u4e49\u5947\u6392\u5217\u4e3a\u9006\u5e8f\u5bf9\u6570\u91cf\u4e3a\u5947\u6570\u7684\u6392\u5217\uff0c\u5bf9\u4e8e\u5076\u6392\u5217\u7c7b\u4f3c\u3002\n\n1. \u4ea4\u6362\u6392\u5217\u4e24\u4e2a\u5143\u7d20\uff0c\u6392\u5217\u5947\u5076\u6027\u6539\u53d8\u3002\n\n> \u4e00\u4e2a\u7b80\u5355\u7684\u8bc1\u660e\u65b9\u6cd5\uff1a\u8003\u8651\u4ea4\u6362\u76f8\u90bb\u4e24\u4e2a\u5143\u7d20\uff0c\u9006\u5e8f\u5bf9\u6570\u91cf\u5fc5 $+1/-1$\uff0c\u5947\u5076\u6027\u5fc5\u6539\u53d8\u3002\n> \n> \u90a3\u4e48\u5047\u8bbe\u4ea4\u6362\u6392\u5217\u4e2d\u4e24\u4e2a\u5143\u7d20 $p_i, p_j$ \u76f8\u5f53\u4e8e\u5148\u5c06 $p_i$ \u5411\u53f3\u4ea4\u6362 $j - i$ \u6b21\uff0c\u518d\u5c06 $p_j$ \u5411\u5de6\u4ea4\u6362 $j - i - 1$ \u6b21\uff0c\u5171 $2 \\times (j - i) - 1$ \u6b21\u5fc5\u6539\u53d8\u5947\u5076\u6027\u3002\n\n2. $n > 1$ \u7684\u6392\u5217\u4e2d\uff0c\u5bf9\u4e8e\u957f\u5ea6\u76f8\u540c\u7684\u5947\u5076\u6392\u5217\u6570\u91cf\u76f8\u7b49\u3002\n\n> \u4e0d\u59a8\u5c06\u95ee\u9898\u8f6c\u5316\u4e00\u4e0b\uff1a\u8003\u8651\u5e8f\u5217 $f$ \u8868\u793a\u6bcf\u4e2a\u4f4d\u7f6e\u524d\u9762\u6bd4\u5176\u5927\u7684\u6570\u7684\u4e2a\u6570\uff0c\u90a3\u4e48 $\\sum f_i$ \u4e3a\u9006\u5e8f\u5bf9\u6570\u91cf\u3002\n> \n> \u4e0d\u96be\u53d1\u73b0\u5bf9\u4e8e\u4efb\u610f\u7684\u5e8f\u5217 $f$\uff0c\u82e5\u6ee1\u8db3 $\\forall i, f_i \\in [0, i - 1]$\uff0c$f$ \u53ef\u552f\u4e00\u5bf9\u5e94\u4e00\u4e2a\u6392\u5217\u4e14\u4e0d\u91cd\u4e0d\u6f0f\u3002\u8bc1\u660e\u8003\u8651\u5c40\u9650\u524d $k$ \u4e2a\u6570\u4e3a\u4e00\u4e2a\u6392\u5217\uff0c\u63d2\u5165\u4e00\u4e2a\u6570\u5c06\u4e4b\u524d\u4e0d\u5c0f\u4e8e\u5176\u7684\u6570 $+1$ \u7684\u6392\u5217\u8ba1\u6570\u65b9\u5f0f\u3002\n> \n> \u518d\u5bf9\u4e8e\u539f\u95ee\u9898\u4f7f\u7528\u5f52\u7eb3\u6cd5\uff0c\u53ef\u6613\u8bc1\u5f97\u539f\u547d\u9898\u6210\u7acb\u3002\n\n## \u5b9a\u4e49\n\n\u5bf9\u4e8e\u65b9\u9635 $A$\uff1a\n\n$$\n\\begin{vmatrix}\na_{1, 1} & a_{1, 2} & \\cdots & a_{1, n} \\\\ \na_{2, 1} & a_{2, 2} & \\cdots & a_{2, n} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\na_{n, 1} & a_{n, 2} & \\cdots & a_{n, n}\n\\end{vmatrix}\n$$\n\n\u5b9a\u4e49\u5176\u884c\u5217\u5f0f $\\det(A) = \\sum\\limits_{p} \\mathrm{sgn}(p) \\prod\\limits_{i = 1} ^ n a_{i, p_i}$ \u5176\u4e2d $p$ \u4e3a\u4e00\u4e2a\u6392\u5217\u3002\n\n## \u6027\u8d28\n\n1. \u4ea4\u6362\u884c\u5217\uff08\u65b9\u9635\u8f6c\u7f6e\uff09\uff0c\u884c\u5217\u5f0f\u503c\u4e0d\u53d8\u3002\uff08\u5373\u5c06\u539f\u6765\u7684 $a_{i, j} \\rightarrow a_{j, i}$\uff09\n\n> \u53ea\u9700\u8bc1 $\\sum\\limits_{p} \\mathrm{sgn}(p) \\prod\\limits_{i = 1} ^ n a_{i, p_i} = \\sum\\limits_{p} \\mathrm{sgn}(p) \\prod\\limits_{i = 1} ^ n a_{p_i, i} \\Longleftrightarrow \\mathrm{sgn}(p) = \\mathrm{sgn}(p')(p'_{p_i} = i)$\n> \n> \u5bf9\u4e8e\u540e\u8005\uff0c\u5176\u7b49\u4ef7\u4e8e\u6309\u7167\u6392\u5217\u6743\u503c\u5927\u5c0f\u6392\u5e8f\u540e\u4e0b\u6807\u7684\u9006\u5e8f\u5bf9\u6570\u91cf\uff0c\u8fd9\u4e0e\u539f\u9006\u5e8f\u5bf9\u5b9a\u4e49\u7684\u6570\u91cf\u662f\u4e00\u81f4\u7684\u3002\n\n2. \u884c\u5217\u5f0f\u67d0\u4e00\u884c\u7684\u500d\u6570\u53ef\u4ee5\u76f4\u63a5\u63d0\u53d6\u5230\u884c\u5217\u5f0f\u7684\u503c\u7684\u5916\u9762\n\n\u5373\u5bf9\u4e8e\u65b9\u9635 $A$\uff1a\n\n$$\n\\begin{vmatrix}\na_{1, 1} & a_{1, 2} & \\cdots & a_{1, n} \\\\ \n\\vdots & \\vdots & \\ddots & \\vdots \\\\\nka_{i, 1} & ka_{i, 2} & \\cdots & ka_{i, n} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\na_{n, 1} & a_{n, 2} & \\cdots & a_{n, n}\n\\end{vmatrix}\n$$\n\n\u5176\u884c\u5217\u5f0f $\\det(A) = k\\sum\\limits_{p} \\mathrm{sgn}(p) \\prod\\limits_{i = 1} ^ n a_{i, p_i}$\uff0c\u8bc1\u660e\u662f\u5bb9\u6613\u7684\u3002\n\n3. \u53ef\u4ee5\u5c06\u884c\u5217\u5f0f\u67d0\u884c\u7684\u503c\u62c6\u6210\u4e24\u4e2a\u90e8\u5206\u5176\u4f59\u884c\u4e0d\u53d8\uff0c\u7136\u540e\u62c6\u5f00\u6c42\u548c\u539f\u884c\u5217\u5f0f\u503c\u76f8\u7b49\n\n\u5373\uff1a\n\n$$\n\\begin{vmatrix}\na_{1, 1} & a_{1, 2} & \\cdots & a_{1, n} \\\\ \n\\vdots & \\vdots & \\ddots & \\vdots \\\\\nb_{i, 1} + c_{i, 1} & b_{i, 2} + c_{i, 2} & \\cdots & b_{i, n} + c_{i, n} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\na_{n, 1} & a_{n, 2} & \\cdots & a_{n, n}\n\\end{vmatrix}\n=\n\\begin{vmatrix}\na_{1, 1} & a_{1, 2} & \\cdots & a_{1, n} \\\\ \n\\vdots & \\vdots & \\ddots & \\vdots \\\\\nb_{i, 1} & b_{i, 2} & \\cdots & b_{i, n} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\na_{n, 1} & a_{n, 2} & \\cdots & a_{n, n}\n\\end{vmatrix}\n+\n\\begin{vmatrix}\na_{1, 1} & a_{1, 2} & \\cdots & a_{1, n} \\\\ \n\\vdots & \\vdots & \\ddots & \\vdots \\\\\nc_{i, 1} & c_{i, 2} & \\cdots & c_{i, n} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\na_{n, 1} & a_{n, 2} & \\cdots & a_{n, n}\n\\end{vmatrix}\n$$\n\n\u8bc1\u660e\u662f\u7b80\u5355\u7684\u3002\n\n4. \u4ea4\u6362\u884c\u5217\u5f0f\u4e24\u884c\uff0c\u884c\u5217\u5f0f\u503c\u53cd\u53f7\u3002\n\n> \u6839\u636e\u6392\u5217\u6027\u8d28 $1$\uff0c\u76f8\u5f53\u4e8e\u4ea4\u6362\u539f\u6392\u5217\u7684\u4e24\u4e2a\u4f4d\u7f6e\uff0c\u5947\u5076\u6027\u6539\u53d8 $\\rm sgn$ \u503c\u4e5f\u5fc5\u6539\u53d8\u3002\n\n5. \u82e5\u884c\u5217\u5f0f\u4e24\u884c\u6210\u6bd4\u4f8b\uff0c\u5219\u884c\u5217\u5f0f\u503c\u4e3a $0$\u3002\n\n> \u9996\u5148\u5c06\u6bd4\u4f8b\u63d0\u51fa\uff0c\u90a3\u4e48\u6b64\u65f6\u884c\u5217\u5f0f\u5b58\u5728\u4e24\u884c\u76f8\u7b49\uff0c\u4ea4\u6362\u4e24\u884c\u884c\u5217\u5f0f\u4e0d\u53d8\u4f46\u503c\u53cd\u53f7\uff0c\u53ef\u77e5\u884c\u5217\u5f0f\u503c\u4e3a $0$\u3002\n\n6. \u5c06\u884c\u5217\u5f0f\u67d0\u4e00\u884c\u7684 $k$ \u500d\u52a0\u5230\u53e6\u4e00\u884c\u4e0a\uff0c\u884c\u5217\u5f0f\u503c\u4e0d\u53d8\u3002\n\n> \u5c06\u52a0\u540e\u884c\u5217\u5f0f\u7684\u88ab\u52a0\u884c\u6539\u5199\u6210 $kx + b$ \u7684\u5f62\u5f0f\uff0c\u5229\u7528 $3$ \u7ebf\u6027\u62c6\u5f00\uff0c\u5176\u4e2d $kx$ \u7684\u884c\u5217\u5f0f\u6839\u636e $5$ \u503c\u4e3a $0$\u3002\n\n7. \u4e0a\u8ff0\u6240\u6709\u5bf9\u884c\u6ee1\u8db3\u7684\u6027\u8d28\uff0c\u5bf9\u4e8e\u5217\u800c\u8a00\u4e5f\u6ee1\u8db3\u3002\n\n> \u9996\u5148\u5c06\u77e9\u9635\u8f6c\u7f6e\uff0c\u4e8e\u662f\u539f\u6765\u5217\u64cd\u4f5c\u7b49\u4ef7\u4e8e\u8f6c\u7f6e\u540e\u7684\u884c\u64cd\u4f5c\uff0c\u6700\u540e\u518d\u8f6c\u56de\u6765\u5373\u53ef\u3002\n\n## \u884c\u5217\u5f0f\u503c\u6c42\u6cd5\n\n**1. \u6a21\u6570\u4e3a\u8d28\u6570** \n\n\u5bf9\u4e8e\u4e0a\u4e09\u89d2\u65b9\u9635 $A$\uff1a\n\n$$\n\\begin{vmatrix}\na_{1, 1} & a_{1, 2} & \\cdots & a_{1, n} \\\\ \n0 & a_{2, 2} & \\cdots & a_{2, n} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\n0 & 0 & \\cdots & a_{n, n}\n\\end{vmatrix}\n$$\n\n\u5176\u884c\u5217\u5f0f\u503c\u663e\u7136\u4e3a $\\det(A) = \\prod\\limits_{i = 1} ^ n a_{i, i}$\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u5c06\u539f\u884c\u5217\u5f0f\u53d8\u6210\u4e00\u4e2a\u4e8e\u5176\u503c\u76f8\u540c\u7684\u4e0a\u4e09\u89d2\u65b9\u9635\u5373\u53ef\u3002\n\n\u4e0d\u96be\u53d1\u73b0\u53ef\u4ee5\u5229\u7528 $6$ \u7684\u6027\u8d28\u914d\u5408\u9ad8\u65af\u6d88\u5143\u5373\u53ef\u6c42\u5f97\u884c\u5217\u5f0f\u7684\u503c\u3002\n\n\u590d\u6742\u5ea6 $\\mathcal{O(n ^ 3)}$\u3002\n\n**2. \u4e00\u822c\u60c5\u51b5**\n\n\u82e5\u6a21\u5f0f\u4e0d\u4e3a\u8d28\u6570\uff0c\u6211\u4eec\u5728\u6d88\u5143\u65f6\u5c31\u4e0d\u80fd\u76f4\u63a5\u7b97\u51fa $\\dfrac{a_{j, i}}{a_{i, i}}$\uff0c\u56e0\u4e3a\u4e0d\u5b58\u5728\u9006\u5143\u3002\n\n\u6545\u6211\u4eec\u4e0d\u80fd\u4f7f\u7528\u5206\u6570\u7684\u65b9\u5f0f\u4e00\u6b21\u6027\u6d88\u6389\u53e6\u4e00\u884c\uff0c\u4f46\u6ce8\u610f\u5230\u6211\u4eec\u53ea\u9700\u8981\u6d88\u9664\u8fd9\u4e00\u884c\uff0c\u6545\u53ef\u4ee5\u5bfb\u627e\u4e00\u4e9b\u522b\u7684\u65b9\u5f0f\u3002\n\n\u8003\u8651\u8f97\u8f6c\u76f8\u9664\u7684\u8fc7\u7a0b\uff0c\u6211\u4eec\u6bcf\u6b21\u5c06\u7b2c $j$ \u884c\u6d88\u53bb\u81f3 $a_{j, i} \\rightarrow a_{j, i} \\% a_{i, i}$ \u7136\u540e\u4ea4\u6362\u4e24\u884c\uff0c\u76f4\u81f3 $a_{j, i} = 0$\u3002\n\n\u56e0\u4e3a\u8f97\u8f6c\u76f8\u9664\u8fc7\u7a0b\u4e2d\u53ea\u4f1a\u53d8\u5c0f\uff0c\u56e0\u6b64\u53d6\u6a21\u4e0d\u4f1a\u5f71\u54cd\u590d\u6742\u5ea6\uff0c\u6545\u53ef\u4ee5\u53d6\u6a21\u3002\n\n\u6ce8\u610f\u5230\u8f97\u8f6c\u76f8\u9664\u7684\u590d\u6742\u5ea6\u4e3a $a_{i, i}$ \u7684\u51cf\u5c0f\u6b21\u6570\uff0c\u4e3a $\\mathcal{O(\\log P)}$\uff0c\u6b64\u90e8\u5206\u603b\u590d\u6742\u5ea6\u4e3a $\\mathcal{O(n ^ 2\\log P)}$ \u4e0d\u4e3a\u74f6\u9888\u3002\n\n\u56e0\u6b64\u590d\u6742\u5ea6\u4e3a $\\mathcal{O(n ^ 3)}$\u3002\n\n---\n\n## \u5b9a\u4e49\n\n1. \u5bf9\u4e8e\u65e0\u5411\u56fe\uff0c\u5b9a\u4e49 $D(G)$ \u4e3a\u56fe $G$ \u7684\u5ea6\u6570\u77e9\u9635\uff0c\u5176\u4e2d\uff1a\n\n$$\nD(G)(i, j) = \n\\begin{cases}\n\\deg_i & (i = j) \\\\\n0 & (i \\ne j)\n\\end{cases}\n$$\n\n2. \u5bf9\u4e8e\u6709\u5411\u56fe\uff0c\u5b9a\u4e49 $D ^ {in}(G)$ \u4e3a\u56fe $G$ \u7684\u5165\u5ea6\u77e9\u9635\uff0c$D ^ {out}(G)$ \u4e3a\u56fe $G$ \u7684\u51fa\u5ea6\u77e9\u9635\uff0c\u5176\u4e2d\uff1a\n\n$$\nD(G) ^ {in}(i, j) = \n\\begin{cases}\n\\mathrm{in}_i & (i = j) \\\\\n0 & (i \\ne j)\n\\end{cases},\nD(G) ^ {out}(i, j) = \n\\begin{cases}\n\\mathrm{out}_i & (i = j) \\\\\n0 & (i \\ne j)\n\\end{cases}\n$$\n\n3. \u5b9a\u4e49 $A(G)$ \u4e3a\u56fe $G$ \u7684\u90bb\u63a5\u77e9\u9635\uff0c\u5176\u4e2d\uff1a\n\n$$A(G)(i, j) = \\text{the number of the path from i to j}$$\n\n4. \u5b9a\u4e49\u56fe $G$ \u7684 $\\rm kirchhoff$ \u77e9\u9635 $K(G) = D(G) - A(G)$\u3002\n\n5. \u5b9a\u4e49\u65e0\u5411\u56fe $G$ \u7684\u751f\u6210\u6811\u6570\u91cf\u4e3a $t(G)$\uff0c\u6709\u5411\u56fe\u6839\u5411\u6811\u751f\u6210\u6811\uff08\u6839\u4e3a $u$\uff0c\u4e0b\u540c\uff09\u6570\u91cf\u4e3a $t ^ {root}(G, u)$\uff0c\u6709\u5411\u56fe\u53f6\u5411\u6811\u6570\u91cf\u4e3a $t ^ {leaf}(G, u)$\u3002\n\n6. \u5b9a\u4e49\u56fe $G$ \u7684\u5173\u8054\u77e9\u9635 $M(G)$ \u4e3a\u4e00\u4e2a\u5927\u5c0f\u4e3a $n \\times m$ \u7684\u77e9\u9635\uff0c\u5176\u4e2d\uff08\u4e00\u4e0b\u7684\u65b9\u5411\u5bf9\u4e8e\u65e0\u5411\u56fe\u968f\u610f\uff09\uff1a\n\n$$\nM(G)(i, j) = \n\\begin{cases}\n-1 & (\\text{i is the end of the } edge_j) \\\\\n1 & (\\text{i is the start of the } edge_j) \\\\\n0 & (\\text{Otherwise}) \\\\\n\\end{cases}\n$$\n\n7. \u5b9a\u4e49\u56fe $G$ \u7684\u51cf\u5173\u8054\u77e9\u9635 $M_0(G)$ \u4e3a\u5173\u8054\u77e9\u9635 $M(G)$ \u53bb\u6389\u6700\u540e\u4e00\u884c\u540e\u7684\u5927\u5c0f\u4e3a $(n - 1) \\times m$ \u7684\u77e9\u9635\u3002\n\n8. \u5b9a\u4e49\u56fe $G$ \u7684\u5b50\u51cf\u5173\u8054\u77e9\u9635 $M_0(G)[S]$ \u4e3a\u9009\u51fa $M_0(G)$ \u4e2d\u7684\u5217\u6784\u6210\u5b50\u96c6 $S$\uff0c\u6ee1\u8db3 $|S| = n - 1, S \\subseteq \\{1, 2, \\cdots m\\}$\u3002\n\n## \u5b9a\u7406\n\n**\u4ee5\u4e0b\u9ed8\u8ba4\u6240\u6709\u6570\u5747\u4e3a\u6b63\u6574\u6570\uff0c\u56fe\u4e0d\u5b58\u5728\u81ea\u73af\u4f46\u53ef\u5b58\u5728\u91cd\u8fb9**\u3002\n\n1. \u65e0\u5411\u56fe\u77e9\u9635\u6811\u5b9a\u7406\uff1a\n\n$$\\forall i \\in [1, n], t(G) = \\det K(G) \\begin{pmatrix}1, 2, \\cdots i - 1, i + 1, \\cdots n \\\\ 1, 2, \\cdots i - 1, i + 1, \\cdots n\\end{pmatrix}$$\n\n2. \u6709\u5411\u56fe\u77e9\u9635\u6811\u5b9a\u7406\uff1a\n\n$$\\forall i \\in [1, n], t ^ {root}(G, i) = \\det K ^ {out}(G) \\begin{pmatrix}1, 2, \\cdots i - 1, i + 1, \\cdots n \\\\ 1, 2, \\cdots i - 1, i + 1, \\cdots n\\end{pmatrix}$$\n\n$$\\forall i \\in [1, n], t ^ {leaf}(G, i) = \\det K ^ {in}(G) \\begin{pmatrix}1, 2, \\cdots i - 1, i + 1, \\cdots n \\\\ 1, 2, \\cdots i - 1, i + 1, \\cdots n\\end{pmatrix}$$\n\n3. $\\rm Best$ \u5b9a\u7406\uff1a\u8bbe\u6709\u5411\u6b27\u62c9\u56fe $G$ \u7684\u6b27\u62c9\u56de\u8def\u6570\u91cf\u4e3a $ec(G)$\uff0c\u5219\u6709\uff1a\n\n$$\\forall i \\in [1, n], ec(G) = t ^ {root}(G, i) \\prod\\limits_{u \\in V} (\\deg_u - 1)!$$\n\n\u5176\u4e2d\u5bf9\u4e8e\u6b27\u62c9\u56fe $\\mathrm{in}, \\mathrm{out}$ \u5747\u76f8\u540c\uff0c\u56e0\u6b64 $\\deg$ \u53ef\u4efb\u9009\u5176\u4e00\u3002\n\n\u82e5\u8981\u6c42\u6b27\u62c9\u56de\u8def\u8d77\u70b9 $k$\uff0c\u5219\u4ee5 $k$ \u4e3a\u8d77\u70b9\u7684\u6b27\u62c9\u56de\u8def\u6570\u91cf $ec(G, k)$ \u4e3a\uff1a\n\n$$ec(G, k) = t ^ {root}(G, k) \\deg_k \\prod\\limits_{u \\in V} (\\deg_u - 1)!$$\n\n\u6b64\u5b9a\u7406\u4e0b\u9762\u6682\u4e0d\u8bc1\u660e\uff0c~~\u5148\u5495\u7740~~\u3002\n\n\u4ee5\u4e0a\u6240\u6709\u5b9a\u7406\uff0c\u82e5\u5e26\u6743\u6c42\u751f\u6210\u6811 / \u6b27\u62c9\u56de\u8def\u6743\u503c\u4e4b\u548c\uff0c\u53ef\u770b **\u5c06\u6743\u503c\u770b\u4f5c\u91cd\u8fb9** \u4e8e\u662f\u5c31\u53ef\u4ee5\u5212\u5f52\u5230\u6ca1\u6709\u6743\u503c\u7684\u60c5\u51b5\u3002\n\n## \u8bc1\u660e\n\n\u4ee5\u4e0b\u53ea\u8bc1\u660e\u65e0\u5411\u56fe\u65e0\u6839\u6811\u751f\u6210\u6811\u77e9\u9635\u6811\u5b9a\u7406\u3002\n\n**1. \u5f15\u7406 $1$**\uff1a\n\n$$M \\times M ^ {T} = K$$\n\n$$\n\\begin{aligned}\nM \\times M ^ {T}(i, j) &= \\sum\\limits_{k = 1} ^ m M(i, k) \\times M ^ {T}(k, j) \\\\\n&= \\sum\\limits_{k = 1} ^ m M(i, k) \\times M(j, k) \\\\\n\\end{aligned}\n$$\n\n\u53ef\u4ee5\u53d1\u73b0\u5f53\u4e14\u4ec5\u5f53 $i, j$ \u90fd\u4e3a\u8fb9 $k$ \u7684\u4e00\u4e2a\u7aef\u70b9\u65f6\uff0c\u8d21\u732e\u4e0d\u4e3a $0$\u3002\n\n\u82e5 $i = j$ \u5219 $M(i, k) = M(j, k)$ \u8d21\u732e\u76f8\u7b49\uff0c\u90a3\u4e48\u4e24\u8005\u4e58\u79ef\u8d21\u732e $1$\u3002\u56e0\u6b64\u603b\u8d21\u732e\u4e3a $\\deg_i$\u3002\n\n\u82e5 $i \\ne j$ \u5219 $M(i, k) \\ne M(j, k)$ \u8d21\u732e\u76f8\u53cd\uff0c\u90a3\u4e48\u4e24\u8005\u4e58\u79ef\u8d21\u732e $-1$\u3002\u56e0\u6b64\u603b\u8d21\u732e\u4e3a $-A(i, j)$\u3002\n\n\u4e8e\u662f\u6709\u5f15\u7406 $1$ \u6210\u7acb\u3002\n\n**2. \u5f15\u7406 $2$**\uff1a\n\n\u82e5 $S$ \u6784\u6210\u7684\u8fb9\u96c6\u5728\u539f\u56fe\u4e0a\u6784\u6210\u751f\u6210\u6811\uff0c\u90a3\u4e48 $\\det M_0[S] = 1 / -1$ \u5426\u5219 $\\det M_0[S] = 0$\u3002\n\n\u5148\u8bc1\u540e\u8005\uff1a\n\n\u82e5\u539f\u56fe\u6ca1\u6709\u6784\u6210\u6811\uff0c\u90a3\u4e48\u81f3\u5c11\u5b58\u5728\u4e00\u4e2a\u7b80\u5355\u73af $C(e_{i_1}, e_{i_2}, \\cdots e_{i_k})$\uff0c\u8bb0 $e_{{i_j}_u}, e_{{i_j}_v}$ \u5206\u522b\u4e3a\u8fb9 $e_{i_j}$ \u7684\u4e24\u4e2a\u7aef\u70b9\u3002\n\n\u540c\u65f6\uff0c\u5bf9\u4e8e $M_0[S]$ \u6709\u5982\u4e0b\u4e24\u70b9\u89c2\u5bdf\uff1a\n\n* \u5bf9\u4e8e\u540c\u4e00\u884c\uff08\u5904\u4e8e\u7b80\u5355\u73af\u5bf9\u5e94\u7684\u884c\uff09\uff0c\u6070\u597d\u5b58\u5728\u4e24\u5217\uff08\u7b80\u5355\u73af\u5bf9\u5e94\u5217\uff09\u975e $0$\u3002\n\n* \u5bf9\u4e8e\u540c\u4e00\u5217\uff08\u7b80\u5355\u73af\u5bf9\u5e94\u5217\uff09\uff0c\u6070\u597d\u5b58\u5728\u4e24\u884c\uff08\u5904\u4e8e\u7b80\u5355\u73af\u5bf9\u5e94\u7684\u884c\uff09\u4e00\u884c\u4e3a $1$ \u4e00\u884c\u4e3a $-1$\u3002\uff08\u82e5\u4e3a\u6700\u540e\u4e00\u884c\u4e5f\u53ef\u89c6\u4f5c\u51fa\u73b0\uff09\n\n\u4e0b\u9762\u8bc1\u660e $M_0[S]$ \u5bf9\u5e94\u539f\u7b80\u5355\u73af\u4e2d\u7684 $i_1, i_2, \\cdots i_k$ \u5217\u7ebf\u6027\u76f8\u5173\uff0c\u8003\u8651\u4f9d\u6b21\u5408\u5e76\u6240\u6709\u5217\uff1a\n\n\u6211\u4eec\u9996\u5148\u62ff\u7b2c $i_1$ \u5217\u6d88 $i_2$ \u5217\uff0c\u56e0\u4e3a\u7b80\u5355\u73af\u4e0a\u4e24\u8fb9\u5171\u70b9\uff0c\u56e0\u6b64\u81f3\u5c11\u5b58\u5728\u4e00\u884c\u4f7f\u5f97\u4e24\u5217\u4e0a\u5747\u975e $0$\uff0c\u6211\u4eec\u6d88\u6389\u8fd9\u4e00\u884c\u540e\u6839\u636e\u89c2\u5bdf $2$ \u5fc5\u6070\u597d\u4ec5\u6709 $e_{{i_1}_u}, e_{{i_2}_v}$ \u8fd9\u4e24\u884c\u4e00\u884c\u4e3a $1$ \u4e00\u884c\u4e3a $-1$\u3002\n\n\u5047\u8bbe\u5408\u5e76\u5230\u7b2c $i_j$ \u5217\uff0c\u82e5 $j \\ne k$ \u90a3\u4e48\u4f7f\u7528 $i_{j - 1}$ \u5217\u5408\u5e76\u7684\u7ed3\u679c\u540c\u7b2c\u4e00\u5217\u6d88\u7b2c\u4e8c\u5217\u7684\u65b9\u5f0f\u6d88\u6389\u7b2c $i_j$ \u5217\uff0c\u4e8e\u662f\u7b2c $i_j$ \u5217\u6d88\u5b8c\u540e\u5fc5\u6070\u597d\u5728 $e_{{i_1}_u}, e_{{i_j}_v}$ \u8fd9\u4e24\u884c\u4e00\u884c\u4e3a $1$ \u4e00\u884c\u4e3a $-1$\u3002\n\n\u6700\u540e\u5408\u5e76\u5230\u7b2c $i_{k - 1}$ \u5217\u65f6\uff0c\u6b64\u65f6\u975e $0$ \u4e24\u884c\u4e0e\u539f $i_k$ \u5217\u672a\u6d88\u65f6\u4e00\u81f4\uff0c\u6545\u6b64\u65f6\u53ef\u4ee5\u5c06\u7b2c $i_k$ \u5217\u6d88\u4e3a\u5168 $0$\u3002\n\n\u56e0\u6b64\u8fd9 $i_1, i_2, \\cdots i_k$ \u5217\u7ebf\u6027\u76f8\u5173\uff0c$\\det M_0[S] = 0$\u3002 \n\n---\n\n\u518d\u8bc1\u524d\u8005\uff1a\n\n\u8003\u8651\u5c06\u539f\u884c\u5217\u5f0f\u6d88\u6210\u597d\u7b97\u7684\u5f62\u5f0f\uff0c\u7c7b\u4f3c\u4e8e\u9ad8\u65af\u6d88\u5143\u7684\u65b9\u5f0f\uff0c\u6211\u4eec\u94a6\u5b9a\u4e00\u884c\u7684\u4e3b\u5143\u62ff\u6b64\u884c\u53bb\u6d88\u6240\u6709\u884c\u3002\n\n\u5177\u4f53\u5730\uff0c\u82e5 $S$ \u6784\u6210\u7684\u8fb9\u96c6\u4e3a\u4e00\u68f5\u6811\uff0c\u90a3\u4e48\u5fc5\u5b9a\u80fd\u627e\u5230\u53f6\u5b50\u8282\u70b9 $u$\uff0c\u6b64\u65f6\u9009\u51fa $u$ \u6240\u5728\u7684\u884c\uff0c\u5fc5\u5b9a\u6070\u597d\u53ea\u5b58\u5728\u4e00\u5217\u975e $0$\uff0c\u62ff\u6b64\u5217\u53bb\u6d88\u6240\u6709\u884c\uff08\u4e8b\u5b9e\u4e0a\u53ea\u80fd\u6d88\u6389\u8fb9\u7684\u53e6\u4e00\u4e2a\u8282\u70b9\u6240\u5bf9\u5e94\u7684\u884c\uff09\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u8fd9\u7b49\u4ef7\u4e8e\u6bcf\u6b21\u5728 $M_0[S]$ \u4e2d\u5220\u53bb\u6811\u4e0a\u53f6\u5b50\u8282\u70b9\u6240\u5bf9\u5e94\u7684\u4e00\u6761\u8fb9\uff0c\u6545\u6b64\u8fc7\u7a0b\u4e00\u5b9a\u53ef\u4ee5\u4e0d\u65ad\u9012\u5f52\u76f4\u81f3\u6d88\u53bb\u6240\u6709\u8fb9\u3002\n\n\u6700\u540e\u6211\u4eec\u53d1\u73b0\uff0c\u6bcf\u4e00\u884c\u90fd\u53ea\u5269\u4e0b\u6070\u597d\u4e00\u5217\u4e3a\u5176\u505a\u4e3a\u53f6\u5b50\u65f6\u6240\u5bf9\u5e94\u5217\u4e3a $1 / -1$\uff0c\u6545\u6b64\u65f6\u884c\u5217\u5f0f\u503c\u4ec5\u5728\u6bcf\u884c\u9009\u8fd9\u4e9b\u5217\u65f6\u975e $0$\uff0c\u4e0d\u8bba\u9006\u5e8f\u5bf9\u6570\u91cf\uff0c\u6240\u5f97\u884c\u5217\u5f0f\u503c\u5747\u4e3a $1 / -1$\u3002\n\n**3. \u5f15\u7406 $3$\uff08$\\rm Binet - Cauchy$ \u5b9a\u7406\uff09**\uff1a\n\n\u5b9a\u4e49\u5927\u5c0f\u5206\u522b\u4e3a $n \\times m, m \\times n(n \\le m)$ \u7684\u77e9\u9635 $A, B$ \u5219\u6709\uff1a\n\n$$\\det(AB) = \\sum\\limits_{S \\subseteq \\{1, 2, \\cdots m\\}, |S| = n} \\det(A[S]) \\times \\det(B[S])$$\n\n\u5176\u4e2d $A[S], B[S]$ \u5206\u522b\u8868\u793a $A$ \u53d6 $S$ \u96c6\u5408\u5185\u7684\u5217\uff0c$B$ \u53d6 $S$ \u96c6\u5408\u5185\u7684\u884c\u6240\u6784\u6210\u7684\u77e9\u9635\u3002\n\n\u8bc1\u660e\u5f15\u7406 $3$ \u4e4b\u524d\u518d\u7ed9\u51fa\u4e24\u6761\u5f15\u7406\uff1a\n\n\u5b9a\u4e49 $\\lambda(P)$ \u4e3a\u6392\u5217 $P$ \u7684\u9006\u5e8f\u5bf9\u6570\u91cf\u3002\n\n* 1. \u5f15\u7406 $1$\uff1a\n\n* \u5b9a\u4e49 $P'$ \u4e3a $P$ \u7684\u9006\u6392\u5217\uff0c\u5373\u6ee1\u8db3 $P'_{P_i} = i$\uff0c\u90a3\u4e48\u6709\uff1a\n\n$$\\lambda(P) = \\lambda(P')$$\n\n$\\quad$ \u4e0d\u59a8\u8f6c\u5316 $P'$ \u7684\u9006\u5e8f\u5bf9\u6c42\u6cd5\uff0c\u4e0d\u96be\u53d1\u73b0\u7b49\u4ef7\u4e8e\u7ed9\u5b9a\u5e8f\u5217 $A$\uff0c\u6bcf\u4e2a\u5143\u7d20\u5b58\u5728\u4e24\u4e2a\u5173\u952e\u5b57 $x, y$\uff0c\u5176\u4e2d $A_{i_x} = p_i, A_{i_y} = i$\u3002\n\n$\\quad$ \u90a3\u4e48 $\\lambda(P')$ \u7b49\u4ef7\u4e8e\u5c06\u5c06\u5e8f\u5217 $A$ \u6309\u7167\u7b2c\u4e00\u5173\u952e\u5b57\u6392\u5e8f\u540e\u4ee5\u7b2c\u4e8c\u5173\u952e\u5b57\u4e3a\u6743\u503c\u7684\u9006\u5e8f\u5bf9\u6570\u91cf\u3002\n\n$\\quad$ \u5728\u8fd9\u91cc\u7b49\u4ef7\u4e8e\u6309\u7167\u6743\u503c\u6392\u5e8f\u540e\u6c42\u4e0b\u6807\u7684\u9006\u5e8f\u5bf9\uff0c\u8fd9\u4e0e\u76f4\u63a5\u6c42\u539f\u6392\u5217\u7684\u9006\u5e8f\u5bf9\u662f\u7b49\u4ef7\u7684\u3002\n\n* 2. \u5f15\u7406 $2$\uff1a\n\n* \u5b9a\u4e49 $P_{Q}$ \u4e3a\u6392\u5217 $Q$ \u4e0e\u6392\u5217 $P$ \u7684\u590d\u5408\uff0c\u5219 $\\lambda(P_{Q})$ \u4e0e $\\lambda(P) + \\lambda(Q)$ \u7684\u5947\u5076\u6027\u76f8\u540c\u3002\n\n$\\quad$ \u4eff\u7167\u5f15\u7406 $1$ \u7684\u8bc1\u660e\u65b9\u6cd5\uff0c\u90a3\u4e48\u5de6\u5f0f\u7b49\u4ef7\u53bb\u6c42\u7ed9\u5b9a\u5e8f\u5217 $A$\uff0c\u6bcf\u4e2a\u5143\u7d20\u5b58\u5728\u4e24\u4e2a\u5173\u952e\u5b57 $x, y$ \u5176\u4e2d $A_{i_x} = Q'_i, A_{i_y} = P_i$\uff0c\n\n$\\quad$ \u90a3\u4e48 $\\lambda(P_Q)$ \u7b49\u4ef7\u4e8e\u6309\u7167\u7b2c\u4e00\u5173\u952e\u5b57\u6392\u5e8f\u540e\u4ee5\u7b2c\u4e8c\u5173\u952e\u5b57\u4e3a\u6743\u503c\u7684\u9006\u5e8f\u5bf9\u6570\u91cf\u3002\n\n$\\quad$ \u8003\u8651\u8c03\u6574\u8bc1\u660e\uff0c\u53ef\u77e5\u4e00\u5f00\u59cb\u7684\u9006\u5e8f\u5bf9\u6570\u91cf\u4e3a $\\lambda(P)$\uff0c\u6392\u5e8f\u5229\u7528\u5192\u6ce1\u6392\u5e8f\u7684\u8fc7\u7a0b\uff0c\u53ef\u77e5\u6709\u6548\u7684\u4ea4\u6362\u4ec5\u6709 $Q'$ \u7684\u9006\u5e8f\u5bf9\u4e2a\u3002\n\n$\\quad$ \u800c\u6211\u4eec\u77e5\u9053\u6bcf\u4ea4\u6362\u6392\u5217\u91cc\u4e24\u4e2a\u5143\u7d20\u6392\u5217\u9006\u5e8f\u5bf9\u6570\u5947\u5076\u6027\u6539\u53d8\uff0c\u6545\u603b\u5171\u6539\u53d8 $\\lambda(P)$ \u6b21\uff0c\u6240\u4ee5 $\\lambda(P_Q)$ \u4e0e $\\lambda(P) + \\lambda(Q)$ \u5947\u5076\u6027\u76f8\u540c\u3002\n\n---\n\n\u9996\u5148\u6211\u4eec\u5c55\u5f00\u7b49\u5f0f\u53f3\u4fa7\uff1a\n\n$$\n\\begin{aligned}\n& \\sum\\limits_{S \\subseteq \\{1, 2, \\cdots m\\}, |S| = n} \\det(A[S]) \\times \\det(B[S]) \\\\\n&= \\sum\\limits_{S \\subseteq \\{1, 2, \\cdots m\\}, |S| = n} \\left(\\sum\\limits_{P} (-1) ^ {\\lambda(P)} \\prod\\limits_{i = 1} ^ n A_{i, S_{P_i}}\\right) \\times \\left(\\sum\\limits_{Q} (-1) ^ {\\lambda(Q)} \\prod\\limits_{i = 1} ^ n B_{S_i, Q_i}\\right) \\\\\n&= \\sum\\limits_{S} \\sum\\limits_{P} \\sum\\limits_{Q} (-1) ^ {\\lambda(P) + \\lambda(Q)} \\prod\\limits_{i = 1} ^ n A_{i, S_{P_i}} \\times B_{S_i, Q_i} \\\\\n\\end{aligned}\n$$\n\n\u518d\u5c55\u5f00\u7b49\u5f0f\u5de6\u4fa7\uff1a\n\n$$\n\\begin{aligned}\n& \\det(AB) \\\\\n&= \\sum\\limits_{P} (-1) ^ {\\lambda(P)} \\prod\\limits_{i = 1} ^ n \\left(\\sum\\limits_{j = 1} ^ m A_{i, j} \\times B_{j, P_i}\\right) \\\\\n&= \\sum\\limits_{P} (-1) ^ {\\lambda(P)} \\sum\\limits_{R} \\left(\\prod\\limits_{i = 1} ^ n  A_{i, R_i} \\times B_{R_i, P_i}\\right) (|R| = n, \\forall i, R_i \\in \\{1, 2, \\cdots m\\}) \\\\\n&= \\sum\\limits_{R} \\sum\\limits_{P} (-1) ^ {\\lambda(P)} \\left(\\prod\\limits_{i = 1} ^ n A_{i, R_i}\\right) \\times \\left(\\prod\\limits_{i = 1} ^ n B_{R_i, P_i}\\right)\n\\end{aligned}\n$$\n\n\u4ed4\u7ec6\u89c2\u5bdf\u53ef\u77e5\uff0c\u5bf9\u4e8e\u53ef\u91cd\u6392\u5217 $R$\uff0c\u82e5\u5b58\u5728 $i < j, R_i = R_j$ \u90a3\u4e48\u4ea4\u6362 $P_i, P_j$ \u540e\u540e\u9762\u7684\u79ef\u5f0f\u4e0d\u53d8\uff0c\u4f46\u9006\u5e8f\u5bf9\u5947\u5076\u6027\u6539\u53d8\uff0c\u56e0\u6b64\u4e24\u8005\u8d21\u732e\u4e92\u4e3a\u76f8\u53cd\u6570\u53ef\u62b5\u6d88\u3002\n\n\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u94a6\u5b9a\u6bcf\u4e2a\u5b58\u5728 $i < j, R_i = R_j$ \u7684\u53ef\u91cd\u6392\u5217 $R$\uff0c\u8ba9\u5176\u548c\u4ea4\u6362\u6ee1\u8db3\u6761\u4ef6\u7684\u6700\u5c0f $P_i, P_j$ \u4ea4\u6362\u540e\u7684\u6392\u5217 $P$ \u7684\u8d21\u732e\u76f8\u62b5\u5373\u53ef\u3002\n\n\u56e0\u4e3a\u4ea4\u6362\u6700\u5c0f\u7684 $i, j$ \u540e\u4f9d\u7136\u6ee1\u8db3 $i, j$ \u4e3a\u6700\u5c0f\u7684\u6ee1\u8db3\u6761\u4ef6\u7684\u70b9\u5bf9\uff0c\u56e0\u6b64\u53ef\u4ee5\u4e24\u4e24\u552f\u4e00\u914d\u5bf9\u3002\n\n\u6545\u6211\u4eec\u53ea\u9700\u679a\u4e3e\u4e0d\u91cd\u7684\u5e8f\u5217\u5373\u53ef\uff0c\u4e3a\u6b64\u6211\u4eec\u9996\u5148\u679a\u4e3e $\\{1, 2, \\cdots m\\}$ \u7684\u5b50\u96c6\uff0c\u7136\u540e\u679a\u4e3e\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6392\u5217 $Q$\uff1a\n\n$$\n\\begin{aligned}\n& \\det(AB) \\\\\n&= \\sum\\limits_{S} \\sum\\limits_{Q} \\sum\\limits_{P} (-1) ^ {\\lambda(P)} \\prod\\limits_{i = 1} ^ n A_{i, S_{Q_i}} \\times B_{S_{Q_i}, P_i} \\\\\n&= \\sum\\limits_{S} \\sum\\limits_{Q} \\sum\\limits_{P_{Q'}} (-1) ^ {\\lambda(P_{Q'})} \\left(\\prod\\limits_{i = 1} ^ n A_{i, S_{Q_i}}\\right) \\times \\left(\\prod\\limits_{i = 1} ^ n B_{S_i, P_{Q'_i}}\\right) \\\\\n&= \\sum\\limits_{S} \\sum\\limits_{Q} \\sum\\limits_{P_{Q'}} (-1) ^ {\\lambda(P) + \\lambda(Q)} \\left(\\prod\\limits_{i = 1} ^ n A_{i, S_{Q_i}}\\right) \\times \\left(\\prod\\limits_{i = 1} ^ n B_{S_i, P_{Q'_i}}\\right)\n\\end{aligned}\n$$\n\n\u6574\u7406\u5373\u53ef\u5f97\u5230\u4ece\u53f3\u4fa7\u63a8\u5bfc\u5f97\u5230\u7684\u5f0f\u5b50\u3002\n\n---\n\n\u4e0b\u9762\u6211\u4eec\u53ea\u8bc1\u660e\u77e9\u9635\u6811\u5b9a\u7406\u5220\u53bb\u6700\u540e\u4e00\u884c\u6700\u540e\u4e00\u5217\u662f\u6b63\u786e\u7684\uff08\u5bf9\u4e8e\u5220\u53bb\u5176\u4f59\u7684\u60c5\u51b5\uff0c\u53ea\u9700\u5c06 $M_0$ \u7684\u5b9a\u4e49\u4fee\u6539\u6210\u5220\u53bb\u6539\u884c\u5373\u53ef\uff09\u3002\n\n\u7c7b\u4f3c\u4e8e\u5f15\u7406 $1$\uff0c\u6211\u4eec\u77e5\u9053 $K_0 = M_0 \\times M_0 ^ T$ \u5176\u4e2d $K_0$ \u4e3a $K$ \u53bb\u6389\u6700\u540e\u4e00\u884c\u548c\u6700\u540e\u4e00\u5217\u5f97\u5230\u7684\u65b9\u9635\u3002\n\n\u518d\u6839\u636e\u5f15\u7406 $3$\uff0c\u53ef\u77e5\uff1a\n\n$$\n\\begin{aligned}\n\\det K_0 &= \\sum\\limits_S \\det(M_0[S]) \\det(M_0 ^ T[S]) \\\\\n&= \\sum\\limits_S \\det{^ 2}(M_0[S])\n\\end{aligned}\n$$\n\n\u7531\u5b9a\u7406 $2$\uff0c\u82e5\u8fb9\u96c6 $S$ \u4e0d\u6784\u6210\u751f\u6210\u6811\uff0c\u5219 $\\det(M_0[S]) = 0$\uff0c\u5728\u8be5\u5f0f\u4e2d\u8d21\u732e\u4e3a $0$\u3002\n\n\u82e5\u8fb9\u96c6 $S$ \u6784\u6210\u751f\u6210\u6811\uff0c\u5219 $\\det(M_0[S]) = 1 / -1$\uff0c\u5728\u8be5\u5f0f\u4e2d\u8d21\u732e\u4e3a $1$\u3002\n\n\u6545\u53ef\u5f97\u5230 $\\det K_0$ \u5373\u4e3a\u539f\u56fe\u7684\u751f\u6210\u6811\u6570\u91cf\u3002\n\n---\n\n\u53c2\u8003\u8d44\u6599\uff1a\n\n[OI-Wiki](https://oi-wiki.org/graph/matrix-tree/)\n\n[\u884c\u5217\u5f0f\u5b66\u4e60\u7b14\u8bb0 - suxxsfe](https://www.cnblogs.com/suxxsfe/p/12446673.html)\n\n[\u77e9\u9635\u6811\u5b9a\u7406\uff08Matrix-tree Theorem\uff09\u7b14\u8bb0 - silverxz](https://zhuanlan.zhihu.com/p/108209378)\n\n[Binet-Cauchy\u5b9a\u7406\u7684\u8bc1\u660e - lyyi2003](https://www.cnblogs.com/lishuyu2003/p/12093947.html)",
        "postTime": 1614996408,
        "uid": 78386,
        "name": "Achtoria",
        "ccfLevel": 9,
        "title": "\u77e9\u9635\u6811\u5b9a\u7406\u53ca\u5176\u65e0\u5411\u56fe\u5f62\u5f0f\u8bc1\u660e"
    },
    {
        "content": "## \u77e9\u9635\u6811\u5b9a\u7406\n\n[ \u535a\u5ba2\u9605\u8bfb](https://www.cnblogs.com/wljss/p/12421603.html)\n\n\u60f3\u5fc5\u5927\u5bb6\u5e94\u8be5\u90fd\u4f1a\u9ad8\u65af\u6d88\u5143\u5427\uff0c\u4e0d\u4f1a\u7684\u8bdd\u53ef\u4ee5\u770b[\u6a21\u677f](https://www.luogu.com.cn/problem/P3389),\u6211\u4eec\u73b0\u5728\u7740\u91cd\u8bb2\u4e00\u4e0b\u5efa\u77e9\u9635\u7684\u65b9\u6cd5\u3002\n\n\u524d\u7f6e\u77e5\u8bc6\uff1a\u6211\u4eec\u7528\u5230\u7684\u77e9\u9635\uff0c\u4e5f\u5c31\u662f\u57fa\u5c14\u970d\u592b\u77e9\u9635\u7684\u4efb\u610f\u4e00\u4e2a\u4ee3\u6570\u4f59\u5b50\u5f0f\u662f\u6240\u6709\u751f\u6210\u6811\u7684\u8fb9\u6743\u79ef\u7684\u548c\u3002\n\n\u5f53\u6240\u6709\u8fb9\u8fb9\u6743\u4e3a1\u65f6\u6c42\u7684\u5c31\u662f\u751f\u6210\u6811\u7684\u4e2a\u6570\u4e86\u3002\n\n\u6211\u4eec\u4ee5\u4e0b\u8bbe $(x,y,z)$ \u4e3a $x$ \u5230 $y$ \u6709\u4e00\u6761\u8fb9\u6743\u4e3a $z$ \u7684 \u65e0\u5411/\u6709\u5411 \u8fb9\u3002\n\n### 1.\u65e0\u5411\u56fe\n\n\u5047\u8bbe\u73b0\u5728\u7ed9\u5b9a\u4e00\u4e2a\u56fe $G$ .\n\n\u5ea6\u6570\u77e9\u9635D:\u82e5\u5b58\u5728\u8fb9 $(x,y,z)$ ,\u5219 $D[x][x]+=z;D[y][y]+=z;$ \n\n\u90bb\u63a5\u77e9\u9635C:\u82e5\u5b58\u5728\u8fb9 $(x,y,z)$ ,\u5219 $C[x][y]+=z;C[y][x]+=z;$ \n\n\u56feG\u7684\u57fa\u5c14\u970d\u592b\u77e9\u9635 $A$ = $D$ \u2212 $C$ \u3002\n\n\u5220\u53bb\u4efb\u610f\u4e00\u884c\u548c\u4efb\u610f\u4e00\u5217\uff0c\u6c42\u5269\u4e0b\u7684\u77e9\u9635\u884c\u5217\u5f0f\u5373\u53ef\u3002\n\n### 2.\u6709\u5411\u56fe\n\n\u5047\u8bbe\u73b0\u5728\u7ed9\u5b9a\u4e00\u4e2a\u56feG.\n\n\u5ea6\u6570\u77e9\u9635D:\u82e5\u5b58\u5728\u8fb9 $(x,y,z)$ ,\u5219 \u5916\u5411\u6811\u4e2d $D[y][y]+=z;$ \u5185\u5411\u6811\u4e2d $D[x][x]+=z;$\n\n\u90bb\u63a5\u77e9\u9635C:\u82e5\u5b58\u5728\u8fb9 $(x,y,z)$ ,\u5219 \u5185\u5411\u6811\u548c\u5916\u5411\u6811\u4e2d\u5747\u4e3a $C[x][y]+=z;$ \n\n\u56feG\u7684\u57fa\u5c14\u970d\u592b\u77e9\u9635 $A$ = $D$ \u2212 $C$ \u3002\n\n\u5220\u53bb\u6307\u5b9a\u7684\u6839\u6240\u5728\u7684\u884c\u548c\u5217\uff0c\u6c42\u5269\u4e0b\u7684\u77e9\u9635\u884c\u5217\u5f0f\u5373\u53ef\u3002\n\n\u672c\u9898\u4e2d\u5373\u4e3a\u5916\u5411\u6811\u7684\u60c5\u51b5.\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#define LL long long\nusing namespace std;\nint n, m, t, x, y, z, ans = 1;\nconst int N = 305, mod = 1e9 + 7;\nint a[N][N];\nint ksm(int a, int b, int mod)\n{\n\tint res = 1;\n\tfor (; b; b >>= 1, a = (LL)a * a % mod)\n\t\tif (b & 1)res = (LL)res * a % mod;\n\treturn res;\n}\nvoid work()\n{\n\tfor (int i = 2, inv, tmp; i <= n; ++i)\n\t{\n\t\tfor (int j = i + 1; j <= n; ++j)\n\t\t\tif (!a[i][i] && a[j][i]) {ans = -ans; swap(a[i], a[j]); break;}\n\t\tinv = ksm(a[i][i], mod - 2, mod);\n\t\tfor (int j = i + 1; j <= n; ++j)\n\t\t{\n\t\t\ttmp = (LL)a[j][i] * inv % mod;\n\t\t\tfor (int k = i; k <= n; ++k)a[j][k] = (a[j][k] - (LL)a[i][k] * tmp % mod) % mod;\n\t\t}\n\t}\n}\nsigned main()\n{\n\tcin >> n >> m >> t;\n\tfor (int i = 1; i <= m; ++i)\n\t{\n\t\tscanf(\"%d%d%d\", &x, &y, &z);\n\t\tif (!t)\n\t\t{\n\t\t\t(a[x][x] += z) %= mod; (a[y][y] += z) %= mod;\n\t\t\t(a[x][y] -= z) %= mod; (a[y][x] -= z) %= mod;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t(a[y][y] += z) %= mod; (a[x][y] -= z) %= mod;\n\t\t}\n\t}\n\twork();\n\tfor (int i = 2; i <= n; ++i)ans = (LL)ans * a[i][i] % mod;\n\tcout << (ans % mod + mod) % mod;\n\treturn 0;\n}\n```",
        "postTime": 1583402026,
        "uid": 153843,
        "name": "wljss",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6178 \u3010\u3010\u6a21\u677f\u3011Matrix-Tree \u5b9a\u7406\u3011"
    },
    {
        "content": "## Matrix-Tree \u5b9a\u7406\n\n### \u524d\u8a00\n\n\u4f3c\u4e4e\u8fd9\u91cc\u8fd8\u6ca1\u6709 Matrix-Tree \u5b9a\u7406\u7684\u8bc1\u660e\uff0c\u8fd9\u8fb9\u5199\u4e00\u4e2a\u3002\n\n### \u5185\u5bb9\n\n\u5bf9\u4e8e\u4e00\u5f20\u65e0\u5411\u5e26\u6743\u56fe\uff0c\u6bcf\u6761\u8fb9\u5e26\u6709\u4ea4\u6362\u73af $(R,+,\\cdotp)$ \u4e0a\u7684\u8fb9\u6743\uff0c\u8bb0 $\\mathcal T$ \u662f\u5176\u6240\u6709\u751f\u6210\u6811\u6784\u6210\u7684\u96c6\u5408\uff0c\u6211\u4eec\u6709\uff1a\n\n\uff08\u6ce8\uff1a\u4f60\u53ef\u4ee5\u5c06\u4ea4\u6362\u73af\u7406\u89e3\u4e3a\u4e00\u4e2a\u5b9a\u4e49\u4e86\u52a0\u6cd5\u548c\u4e58\u6cd5\u8fd0\u7b97\uff0c\u5e76\u4e14\u6ee1\u8db3\u4ea4\u6362\u5f8b\u3001\u7ed3\u5408\u5f8b\u3001\u5206\u914d\u5f8b\u4ee5\u53ca\u5b58\u5728\u5355\u4f4d\u5143\uff0c\u5bf9\u4efb\u610f\u5143\u7d20\u90fd\u5b58\u5728\u52a0\u6cd5\u9006\u5143\uff0c\u4e14\u5bf9\u8fd9\u4e24\u79cd\u8fd0\u7b97\u90fd\u5c01\u95ed\u7684\u96c6\u5408\uff09\n\n\u5b9a\u4e49\u5176 Kirchhoff \u77e9\u9635\u4e3a\uff1a\n\n$$K_{i,j} = \\left\\{\\begin{aligned}& \\sum_{k\\neq i} w(i,k) &,i=j\\\\& -w(i,j) &,i\\neq j\\end{aligned}\\right.$$\n\n\u8bb0 $M$ \u8868\u793a $K$ \u5220\u53bb\u4efb\u610f\u76f8\u540c\u7f16\u53f7\u7684\u884c\u5217\u540e\u7684\u77e9\u9635\uff0c\u5219\uff1a\n\n$$\\sum_{t\\in\\mathcal T} \\prod_{(u,v)\\in t} w(u,v) = |M|$$\n\n\uff08\u5373\uff0c\u5b9a\u4e49\u4e00\u4e2a\u751f\u6210\u6811\u7684\u6743\u503c\u662f\u5176\u4e0a\u6240\u6709\u8fb9\u6743\u7684\u4e58\u79ef\uff0c\u6c42\u6240\u6709\u751f\u6210\u6811\u7684\u6743\u503c\u548c\uff09\n\n\u5176\u4e2d $|A|$ \u8868\u793a $A$ \u7684\u884c\u5217\u5f0f\u3002\n\n### \u8bc1\u660e\n\n\u5148\u8bb0\u4f4f\u884c\u5217\u5f0f\u7684\u5b9a\u4e49\uff1a\n\n$$|A| = \\sum_{p} (-1)^{\\tau(p)} \\prod_{i} A_{i,p_i}$$\n\n\u6211\u4eec\u5148\u5efa\u51fa\u4e0d\u5e26\u7b26\u53f7\u7684 Kirchhoff \u77e9\u9635\u3002\n\n\u6211\u4eec\u8003\u8651\u4efb\u9009\u4e00\u4e2a\u70b9\u505a\u6839\uff0c\u5e76\u5728\u63a5\u4e0b\u6765\u7684\u5904\u7406\u4e2d\u628a\u5b83\u5ffd\u7565\uff08\u53ea\u5ffd\u7565\u8fd9\u4e2a\u70b9\uff0c\u800c\u4e0d\u5ffd\u7565\u4e0e\u5b83\u76f8\u8fde\u7684\u8fb9\uff09.\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u5bf9\u6bcf\u4e2a\u70b9\u4efb\u53d6\u4e00\u6761\u51fa\u8fb9\uff0c\u7edf\u8ba1\u5b83\u7684\u6743\u503c\uff08\u4e5f\u5c31\u662f\u5b9a\u7406\u4e2d $M$ \u4e3b\u5bf9\u89d2\u7ebf\u4e0a\u7684\u5143\u7d20\u4e4b\u79ef\uff0c\u53ef\u4ee5\u901a\u8fc7\u5c55\u5f00\u4e58\u79ef\u7684\u5f0f\u5b50\u53d1\u73b0\u4e3a\u4efb\u53d6\u4e00\u6761\u51fa\u8fb9\u7684\u65b9\u6848\u6570\uff09\u3002\n\n\u5bb9\u6613\u53d1\u73b0\uff0c\u8fd9\u6837\u6211\u4eec\u4f1a\u8fde\u51fa\u6765\u6070\u597d\u4e00\u68f5\u6811\uff0c\u53ef\u80fd\u4f1a\u8fde\u51fa\u6765\u82e5\u5e72\u57fa\u73af\u6811\u3002\n\n\u4e8e\u662f\u6211\u4eec\u8003\u8651\u5bf9\u73af\u7684\u4e2a\u6570\u8fdb\u884c\u5bb9\u65a5\uff1a\n\n- \u6211\u4eec\u679a\u4e3e\u6240\u6709\u73af\uff0c\u7136\u540e\u5269\u4e0b\u7684\u8fb9\u968f\u4fbf\u8fde\uff0c\u8ba1\u7b97\u8fd9\u79cd\u60c5\u51b5\u7684\u65b9\u6848\u6570\uff0c\u5e76\u51cf\u53bb\u5b83\u3002\n- \u6211\u4eec\u679a\u4e3e\u6240\u6709\u4e0d\u4ea4\u7684\u4e24\u4e2a\u73af\uff0c\u7136\u540e\u5269\u4e0b\u7684\u8fb9\u968f\u4fbf\u8fde\uff0c\u8ba1\u7b97\u8fd9\u79cd\u60c5\u51b5\u7684\u65b9\u6848\u6570\uff0c\u5e76\u52a0\u4e0a\u5b83\u3002\n- ...\n\n\u6211\u4eec\u53c8\u6ce8\u610f\u5230\u4e00\u4e2a\u6392\u5217\uff08\u7f6e\u6362\uff09\u53ef\u4ee5\u88ab\u8868\u793a\u6210\u82e5\u5e72\u8f6e\u6362\u7684\u5f62\u5f0f\uff0c\u6240\u4ee5\u5b9e\u9645\u4e0a\u6211\u4eec\u76f8\u5f53\u4e8e\u679a\u4e3e\u6392\u5217\u3002\n\n- \u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u4e2a\u6392\u5217\u5bf9\u5e94\u7684\u6743\u503c\u548c\u4e3a $\\prod M_{i,p_{i}}$\uff0c\u4efb\u53d6\u7684\u90e8\u5206\u540c\u6837\u53ef\u4ee5\u901a\u8fc7\u5c55\u5f00\u5f0f\u5b50\u5f97\u5230\u3002\n- \u90a3\u4e48\u5bb9\u65a5\u7cfb\u6570\u662f\u4ec0\u4e48\u5462\uff1f\u6ce8\u610f\u5230\u6211\u4eec\u679a\u4e3e\u7684\u6392\u5217\u4e2d $p_i = i$ \u8868\u793a\u201c\u968f\u4fbf\u8fde\u201d\uff0c\u800c\u4e0d\u662f\u81ea\u73af\uff0c\u5047\u5982\u6211\u4eec\u7edf\u8ba1\u4e86\u6392\u5217\u7684\u8f6e\u6362\u4e2a\u6570\u7684\u8bdd\uff0c\u6211\u4eec\u5e94\u8be5\u7ed9\u4ed6\u4eec\uff08$M_{i,i}$\uff09\u5e26\u4e0a\u5bb9\u65a5\u7cfb\u6570 $-1$\uff0c\u4ee5\u6d88\u53bb\u8fd9\u90e8\u5206\u7684\u5bb9\u65a5\u7cfb\u6570\u3002\n\n\u8bb0 $C(p)$ \u8868\u793a\u6392\u5217 $p$ \u5f62\u6210\u8f6e\u6362\u7684\u4e2a\u6570\n\n$$\\sum(-1)^{C(p)} \\prod M_{i,p_i}$$\n\n\u6162\u7740\uff0c\u867d\u7136\u6211\u4eec\u4ee5\u53ca\u80fd\u611f\u89c9\u5230\u4e0a\u9762\u7684\u5f0f\u5b50\u548c\u884c\u5217\u5f0f\u7684\u5b9a\u4e49\u5f88\u50cf\uff0c\u4f46\u4e0a\u9762\u8bf4\u7684\u662f\u201c\u7edf\u8ba1\u6392\u5217\u7684\u8f6e\u6362\u4e2a\u6570\u201d\u7684\u5947\u5076\u6027\uff0c\u4f46\u662f\u884c\u5217\u5f0f\u5f0f\u5b50\u4e2d\u5374\u7edf\u8ba1\u4e86\u201c\u9006\u5e8f\u5bf9\u4e2a\u6570\u201d\u7684\u5947\u5076\u6027\uff0c\u90a3\u4e48\u8fd9\u4e24\u4e2a\u503c\u6709\u4ec0\u4e48\u5173\u7cfb\u5462\uff1f\n\n**\u5f15\u7406 1**\uff1a\u4ea4\u6362\u6392\u5217\u4e2d\u7684\u4efb\u610f\u4e24\u4e2a\u6570\uff0c\u9006\u5e8f\u5bf9\u4e2a\u6570\u7684\u5947\u5076\u6027\u6539\u53d8\u3002\n\n**\u8bc1\u660e**\uff1a\u9996\u5148\u6211\u4eec\u663e\u7136\u53ef\u4ee5\u77e5\u9053\u4ea4\u6362\u6392\u5217\u4e2d\u7684\u76f8\u90bb\u4e24\u4e2a\u6570\uff0c\u9006\u5e8f\u5bf9\u4e2a\u6570\u7684\u5947\u5076\u6027\u6539\u53d8\uff0c\u7136\u540e\u6211\u4eec\u8003\u8651\u6392\u5217\u4e2d\u7684\u4e24\u4e2a\u4f4d\u7f6e $p_j,p_k$\uff1a\n\n$$p_j,p_{j+1},\\cdots,p_{k-1}p_k$$\n\n\u5148\u4e0d\u65ad\u628a $p_k$ \u5411\u524d\u4ea4\u6362\u5230 $p_j$ \u539f\u5148\u7684\u4f4d\u7f6e\uff0c\u8bb0\u4ea4\u6362\u4e86\u6070\u597d $x$ \u6b21\uff1a\n\n$$p_k,p_j,p_{j+1},\\cdots,p_{k-1}$$\n\n\u7136\u540e\u518d\u628a $p_j$ \u4e0d\u65ad\u5411\u53f3\u4ea4\u6362\uff0c\u5219\u4ea4\u6362\u4e86\u6070\u597d $x-1$ \u6b21\uff1a\n\n$$p_k,p_{j+1},\\cdots,p_{k-1},p_j$$\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u6211\u4eec\u603b\u5171\u4ea4\u6362\u4e86\u6070\u597d $2x - 1$ \u6b21\uff0c\u5373\u5947\u5076\u6027\u6539\u53d8\u4e86 $2x - 1$ \u6b21\uff0c\u663e\u7136\u8fd9\u662f\u5947\u6570\uff0c\u6240\u4ee5\u9006\u5e8f\u5bf9\u4e2a\u6570\u7684\u5947\u5076\u6027\u5fc5\u7136\u6539\u53d8\u3002\n\n**\u5f15\u7406 2**\uff1a\u5bf9\u4e8e\u6392\u5217 $p$\uff0c$\\tau(p)$ \u7684\u5947\u5076\u6027\u548c\u6392\u5217\u957f\u5ea6\u51cf\u53bb\u8f6e\u6362\u7684\u4e2a\u6570\u7684\u5947\u5076\u6027\u76f8\u7b49\u3002\n\n**\u8bc1\u660e**\uff1a\u8003\u8651\u5bf9\u4e8e\u6bcf\u4e2a\u8f6e\u6362\u6211\u4eec\u90fd\u53ef\u4ee5\u4ea4\u6362\u73af\u957f $-~1$ \u6b21\u5c06\u5176\u4e0a\u7684\u5143\u7d20\u6392\u5e8f\uff0c\u6240\u4ee5\u603b\u5171\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4ea4\u6362 $\\sum$ \u73af\u957f $-~1$ \u6b21\u5f97\u5230\u6392\u5217 $1,2,\\cdots,n$\uff0c\u663e\u7136\u8be5\u503c\u7b49\u4e8e $n - C(p)$\u3002\u6ce8\u610f\u5230\u6211\u4eec\u6bcf\u6b21\u4ea4\u6362\u4e24\u8005\u5947\u5076\u6027\u90fd\u540c\u65f6\u6539\u53d8\uff0c\u6700\u540e\u6392\u5217\u53d8\u4e3a $1,2,\\cdots,n$ \u65f6\u4e24\u8005\u5947\u5076\u6027\u76f8\u540c\uff0c\u6545\u521a\u5f00\u59cb\u65f6\u4e24\u8005\u5947\u5076\u6027\u4e5f\u76f8\u540c\u3002\n\n\u8fd9\u6837\u5df2\u7ecf\u5f88\u6e05\u695a\u4e86\uff0c\u552f\u4e00\u7684\u95ee\u9898\u662f\u591a\u4e86\u4e00\u4e2a $(-1)^n$\uff0c\u6211\u4eec\u53ea\u9700\u8981\u628a\u4e0a\u9762 $M$ \u7684\u6240\u6709\u7cfb\u6570\u53d6\u76f8\u53cd\u6570\u5c31\u53ef\u4ee5\u628a\u8fd9\u4e2a\u7cfb\u6570\u6d88\u53bb\u4e86\uff0c\u540c\u65f6\u6211\u4eec\u4e5f\u5c31\u5f97\u5230\u4e86\u884c\u5217\u5f0f\u7684\u5f62\u5f0f\u3002\n\n\u81f3\u6b64\uff0cMatrix-Tree \u5b9a\u7406\u5f97\u8bc1\u3002\n\n### \u5e94\u7528\n\n#### \u751f\u6210\u6811\u8ba1\u6570\n\n**\u9898\u76ee**\uff1a\u8ba1\u7b97\u4e00\u5f20 $n(n\\le 300)$ \u4e2a\u70b9\u7684\u65e0\u5411\u56fe\u7684\u751f\u6210\u6811\u7684\u4e2a\u6570\u3002\n\n\u6211\u4eec\u53ea\u9700\u8981\u4ee4 $u,v$ \u4e4b\u95f4\u7684\u6743\u503c\u4e3a\u5b83\u4eec\u4e4b\u95f4\u7684\u8fb9\u6570\uff0c\u7136\u540e\u5957\u7528 Matrix-Tree \u5b9a\u7406\uff0c\u9ad8\u65af\u6d88\u5143\u6c42\u884c\u5217\u5f0f\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal O(n^3)$.\n\n#### \u751f\u6210\u6811\u6743\u503c\u548c\n\n**\u9898\u76ee**\uff1a\u8ba1\u7b97\u4e00\u5f20 $n(n\\le 300)$ \u4e2a\u70b9\u7684\u65e0\u5411\u56fe\u7684\u751f\u6210\u6811\u7684\u6240\u6709\u751f\u6210\u6811\u7684\u6743\u503c\u548c\uff0c\u5176\u4e2d\u6743\u503c\u5b9a\u4e49\u4e3a\u751f\u6210\u6811\u6bcf\u6761\u8fb9\u8fb9\u6743\u4e4b\u548c\u3002\n\n\u82e5\u539f\u6765 $u,v$ \u4e4b\u95f4\u7684\u8fb9\u6743\u4e3a $w$\uff0c\u4ee4\u5b83\u4eec\u4e4b\u95f4\u65b0\u7684\u8fb9\u6743\u4e3a\u4e00\u4e2a\u4e00\u6b21\u7684\u591a\u9879\u5f0f $wx+1$\uff0c\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u4e24\u4e2a\u8fb9\u6743\u4e58\u79ef\u7684\u4e00\u6b21\u9879\u6070\u4e3a\u8fb9\u6743\u503c\u548c\uff0c\u5728 $\\bmod~x^2$ \u610f\u4e49\u4e0b\u5b9a\u4e49\u4e58\u6cd5\uff0c\u5957\u7528 Matrix-Tree \u5b9a\u7406\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4ecd\u4e3a $\\mathcal O(n^3)$.\n\n#### \u6709\u5411\u56fe\u6811\u5f62\u56fe\u8ba1\u6570\n\n**\u9898\u76ee**\uff1a\u8ba1\u7b97\u4e00\u5f20 $n(n\\le 300)$ \u4e2a\u70b9\u7684\u6709\u5411\u56fe\u7684\u4ee5 $1$ \u4e3a\u6839\u7684\u5916\u5411\u6811\u5f62\u56fe\u4e2a\u6570\u3002\n\n\u5047\u5982\u6211\u4eec\u8981\u6c42\u67d0\u4e2a\u6709\u5411\u56fe\u4ee5\u67d0\u4e2a\u70b9\u4e3a\u6839\u7684\u5916\u5411 / \u5185\u5411\u6811\u5f62\u56fe\u4e2a\u6570\uff0c\u7c7b\u6bd4\u65e0\u5411\u56fe\uff0c\u6211\u4eec\u53d8\u4e3a\u4e86\u679a\u4e3e\u5165\u8fb9 / \u51fa\u8fb9\uff0c\u5e76\u4e14\u4e3b\u5bf9\u89d2\u7ebf\u4e0a\u7684\u6743\u503c\u5c31\u53d8\u4e3a\u4e86\u5165\u5ea6 / \u51fa\u5ea6\uff0c\u5728\u65e0\u5411\u56fe\u4e0a\u7684 Matrix-Tree \u5b9a\u7406\u7684\u8bc1\u660e\u7684\u57fa\u7840\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u6784\u9020\u77e9\u9635\u3002\n\n### \u4ee3\u7801\n\nLuogu \u4e0a\u7684\u677f\u5b50\u9898\u3002\n\n```cpp\nconst int kN = 3e2 + 5, kMod = 1e9 + 7;\n\nint n, m, typ, mat[kN][kN];\n\nint Det() {\n\tint ret = 1, si = 1;\n\tfor(int i = 1; i <= n; ++i) {\n\t\tfor(int j = i + 1; j <= n; ++j)\n\t\t\twhile(mat[j][i]) {\n\t\t\t\tint t = mat[i][i] / mat[j][i];\n\t\t\t\tfor(int k = i; k <= n; ++k) {\n\t\t\t\t\tmat[i][k] = (mat[i][k] - 1LL * t * mat[j][k]) % kMod;\n\t\t\t\t\tstd::swap(mat[i][k], mat[j][k]);\n\t\t\t\t}\n\t\t\t\tsi *= -1;\n\t\t\t}\n\t\tret = 1LL * ret * mat[i][i] % kMod;\n\t}\n\treturn (ret * si % kMod + kMod) % kMod;\n}\n\nint main() { \n\trd(n, m, typ); --n;\n\tfor(int i = 1; i <= m; ++i) {\n\t\tint u, v, w; rd(u, v, w);\n\t\t--u; --v;\n\t\tif(!typ) {\n\t\t\tmat[u][u] = (mat[u][u] + w) % kMod;\n\t\t\tmat[v][v] = (mat[v][v] + w) % kMod;\n\t\t\tmat[u][v] = (mat[u][v] - w) % kMod;\n\t\t\tmat[v][u] = (mat[v][u] - w) % kMod;\n\t\t} else {\n\t\t\tmat[v][v] = (mat[v][v] + w) % kMod;\n\t\t\tmat[v][u] = (mat[v][u] - w) % kMod;\n\t\t}\n\t}\n\tprintf(\"%d\\n\", Det());\n}\n```",
        "postTime": 1611649855,
        "uid": 34238,
        "name": "zhylj",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P6178 \u3010\u3010\u6a21\u677f\u3011Matrix-Tree \u5b9a\u7406\u3011"
    },
    {
        "content": "### \u9898\u76ee\u5927\u610f\uff1a\n\u6c42\u89e3\u6b64\u516c\u5f0f\u7684\u503c\uff1a$\\sum_{T}^{}\\prod_{e\\in T}^{}p_{e}$\n### \u601d\u8def\uff1a\n\u8003\u70b9\u975e\u5e38\u660e\u786e\uff0c\u5373\u77e9\u9635\u6811\u5b9a\u7406\uff0c\u77e9\u9635\u6811\u4ee3\u7801\u57fa\u672c\u90fd\u5dee\u4e0d\u591a\uff0c\u552f\u4e00\u7684\u533a\u522b\u5c31\u5728\u4e8e\u5efa\u56fe\u3002\u8003\u8651\u5230\u672c\u9898\u7ed9\u51fa\u7684\u5e26\u6743\u56fe\u65e2\u53ef\u80fd\u4e3a\u65e0\u5411\u56fe\uff0c\u4e5f\u53ef\u80fd\u4e3a\u6709\u5411\u56fe\uff0c\u5206\u522b\u5904\u7406\u5373\u53ef\n### \u5efa\u56fe\uff1a\n- \u65e0\u5411\u56fe\n\n\u5ea6\u6570\u77e9\u9635D\uff1a\u82e5\u5b58\u5728\u8fb9$(x\uff0cy\uff0cz)$\uff0c\u5219 $D[x] [x] + = z$ ; $D[y] [y] + = z$ ;\n\n\u90bb\u63a5\u77e9\u9635A\uff1a\u82e5\u5b58\u5728\u8fb9$(x\uff0cy\uff0cz)$\uff0c\u5219 $A[x] [y] + = z$ ; $D[y] [x] + = z$ ;\n\n\u57fa\u5c14\u970d\u592b\u77e9\u9635 $K = D - A$\n\n\u5220\u53bb\u4efb\u610f\u4e00\u884c\u548c\u4efb\u610f\u4e00\u5217\uff0c\u6c42\u77e9\u9635\u884c\u5217\u5f0f\u5373\u53ef\n\n- \u6709\u5411\u56fe\n\n\u5ea6\u6570\u77e9\u9635D\uff1a\u82e5\u5b58\u5728\u8fb9$(x\uff0cy\uff0cz)$\uff0c\u5219\u5916\u5411\u6811\u4e2d $D[y] [y] + = z$ ; \u5185\u5411\u6811\u4e2d $D[x] [x] + = z$;\n\n\u90bb\u63a5\u77e9\u9635A\uff1a\u82e5\u5b58\u5728\u8fb9$(x\uff0cy\uff0cz)$\uff0c\u5219\u5185\u5411\u6811\u548c\u5916\u5411\u6811\u4e2d\u5747\u4e3a $A[x] [y] + = z$ ;\n\n\u5220\u53bb\u6307\u5b9a\u6839\u6240\u5728\u7684\u884c\u548c\u5217\uff0c\u6c42\u77e9\u9635\u884c\u5217\u5f0f\u5373\u53ef\n\n\u672c\u9898\u7684\u5904\u7406\uff1a\n```c\nx--;y--;//\u672c\u9898\u9650\u5b9a1\u4e3a\u6839,\u6545\u8981\u5220\u53bb\u6839\u6240\u5728\u7684\u884c\u548c\u5217 \nif(!op){\n\tK[x][x]=(K[x][x]+z)%mod;K[y][y]=(K[y][y]+z)%mod;\n\tK[x][y]=(K[x][y]-z+mod)%mod;\n\tK[y][x]=(K[y][x]-z+mod)%mod;\n}\nelse{\n\tK[x][y]=(K[x][y]-z+mod)%mod;\n\tK[y][y]=(K[y][y]+z)%mod;\n}\n```\n\n### \u4ee3\u7801\uff1a\n```c\n#include<iostream>\n#include<cstring>\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int N=310;\nconst int mod=1e9+7;\n\nLL K[N][N];\nint n,m,op;\n\ninline LL qpow(LL x,LL n){\n\tLL ret=1;\n\twhile(n){\n\t\tif(n&1)\n\t\tret=1ll*ret*x%mod;\n\t\tx=1ll*x*x%mod;\n\t\tn>>=1;\n\t}\n\treturn ret;\n}\n\ninline LL gauss(){\n\tint ret=1;\n\tn--;\n\tfor(int i=1;i<=n;i++){\n        for(int j=i;j<=n;j++)\n            if(K[j][i]){\n                swap(K[i],K[j]);\n                if(i!=j)\n                    ret=mod-ret;\n                break;\n            }\n        int t=qpow(K[i][i],mod-2);\n        for(int j=i+1;j<=n;j++)\n            if(K[j][i])\n                for(int k=n;k>=i;k--)\n                    K[j][k]=(K[j][k]-K[i][k]*t%mod*K[j][i]%mod+mod)%mod;\n    }\n\tfor(int i=1;i<=n;i++)\n\t\tret=1ll*ret*K[i][i]%mod;\n\treturn ret;\n}\n\nint main(){\n\tscanf(\"%d%d%d\",&n,&m,&op);\n\tint x,y,z;\n\tfor(int i=1;i<=m;i++){\n\t\tscanf(\"%d%d%d\",&x,&y,&z);\n\t\tx--;y--;//\u672c\u9898\u9650\u5b9a1\u4e3a\u6839,\u6545\u8981\u5220\u53bb\u6839\u6240\u5728\u7684\u884c\u548c\u5217 \n\t\tif(!op){\n\t\t\tK[x][x]=(K[x][x]+z)%mod;K[y][y]=(K[y][y]+z)%mod;\n\t\t\tK[x][y]=(K[x][y]-z+mod)%mod;\n\t\t\tK[y][x]=(K[y][x]-z+mod)%mod;\n\t\t}\n\t\telse{\n\t\t\tK[x][y]=(K[x][y]-z+mod)%mod;\n\t\t\tK[y][y]=(K[y][y]+z)%mod;\n\t\t}\n\t}\n\tcout<<gauss();\n}\n```\n",
        "postTime": 1617604814,
        "uid": 263057,
        "name": "\u6708\u4e0b\u8424\u706b",
        "ccfLevel": 0,
        "title": "P6178 \u3010\u6a21\u677f\u3011Matrix-Tree \u5b9a\u7406"
    },
    {
        "content": "## \u672c\u6587\u4ec5\u8bb2\u8ff0\u884c\u5217\u5f0f\u6c42\u503c\uff08\u4efb\u610f\u6a21\u6570\uff09\n\n\u4f17\u6240\u5468\u77e5\uff0c\u884c\u5217\u5f0f\u6c42\u503c\u7684\u901a\u7528\u65b9\u6cd5\u662f $ans\\leftarrow ans*inv(a_{i,i}),a_{i,i}\\leftarrow 1$\u3002\n\n\u4f46\u662f\uff0c\u5f53 $p$ \u4e0d\u662f\u7d20\u6570\u65f6\u9006\u5143\u4e0d\u5b58\u5728\uff0c\u4e0d\u80fd\u7528\u8fd9\u79cd\u65b9\u6cd5\u3002\n\n\u8003\u8651\u5230\u884c\u5217\u5f0f\u884c\u76f8\u51cf\u4e0d\u6539\u53d8\u503c\uff0c\u53c8\u6ce8\u610f\u5230\u8fd9\u6837\u505a\u672c\u8d28\u662f\u4e3a\u4e86\u6e05 $0$ \uff0c\u53ef\u4ee5\u8003\u8651\u5bf9\u884c\u7528\u8f97\u8f6c\u76f8\u9664\u6cd5\u7684\u65b9\u6cd5\u5b8c\u6210\u3002\u590d\u6742\u5ea6\u4ecd\u4e3a $O(n^3)$\u3002\n\n\u8bc1\u660e\uff1a$(x,y)$ \u4e24\u6b21\u8f97\u8f6c\u76f8\u9664\u4e4b\u540e\u6700\u5927\u503c\u51cf\u534a\uff0c\u52bf\u80fd\u5206\u6790\u53ef\u5f97\u8fd9\u4e2a $\\log $ \u5176\u5b9e\u662f\u644a\u5230 $O(n)$ \u884c\u7684\uff0c\u4e5f\u5c31\u662f $O(n^2(n+\\log p))$\u3002\n\n\u4ee3\u7801\u4e3a[\u884c\u5217\u5f0f\u6c42\u503c\u677f\u5b50](https://www.luogu.com.cn/problem/U135840)std\u3002\n\nupd\uff1a\u73b0\u5df2\u52a0\u5165\u4e3b\u9898\u5e93\u8c6a\u534e\u6a21\u677f\u3002\n```\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N=602;\ninline void read(register int &x)\n{\n\tregister int c=getchar();\n\twhile ((c<48)||(c>57)) c=getchar();\n\tx=c^48;c=getchar();\n\twhile ((c>=48)&&(c<=57))\n\t{\n\t\tx=x*10+(c^48);\n\t\tc=getchar();\n\t}\n}\nint a[N][N];\nint n,p,i,j;\nint cal(int a[][N],register int n,const int p)\n{\n\tregister int i,j,k,r=1,fh=0,l;\n\tfor (i=1;i<=n;i++)\n\t{\n\t\tk=i;\n\t\tfor (j=i+1;j<=n;j++) if (a[j][i]>a[k][i]) break;\n\t\tif (a[k][i]==0) return 0;j=k;\n\t\tif (i!=j) {swap(a[j],a[i]);fh^=1;}\n\t\tfor (j=i+1;j<=n;j++)\n\t\t{\n\t\t\tif (a[j][i]>a[i][i]) {swap(a[j],a[i]);fh^=1;}\n\t\t\twhile (a[j][i])\n\t\t\t{\n\t\t\t\tl=a[i][i]/a[j][i];\n\t\t\t\tfor (k=i;k<=n;k++) a[i][k]=(a[i][k]+(ll)(p-l)*a[j][k])%p;\n\t\t\t\tswap(a[j],a[i]);fh^=1;\n\t\t\t}\n\t\t}\n\t\tr=(ll)r*a[i][i]%p;\n\t}\n\tif (fh) return (p-r)%p;\n\treturn r;\n}\nint main()\n{\n\tread(n);read(p);\n\tfor (i=1;i<=n;i++) for (j=1;j<=n;j++) {read(a[i][j]);a[i][j]%=p;}\n\tprintf(\"%d\",cal(a,n,p));\n}\n```",
        "postTime": 1603295875,
        "uid": 29826,
        "name": "SSerxhs",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P6178 \u3010\u3010\u6a21\u677f\u3011Matrix-Tree \u5b9a\u7406\u3011"
    }
]
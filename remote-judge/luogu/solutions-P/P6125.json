[
    {
        "content": "\u6211\u4e5f\u662f\u767e\u601d\u4e0d\u5f97\u5176\u89e3\u540e\u770b\u4e86[\u8fd9\u7bc7\u535a\u5ba2](https://blog.sengxian.com/solutions/bzoj-1444)\u540e\u624d\u660e\u767d\u4e86\u6982\u7387\u5230\u671f\u671b\u7684\u8f6c\u5316\uff0c\u4f46\u4e0d\u5e78\u7684\u662f\u8fd9\u7bc7\u6587\u7ae0\u4f9d\u7136\u6709\u4e00\u4e2a\u5c0f\"\u8ff7\"\u4eba\u7684\u5730\u65b9\n\n\u9996\u5148\u95ee\u9898\u53ef\u4ee5\u88ab\u7b49\u4ef7\u6210\u5728 AC \u81ea\u52a8\u673a\u4e0a\u7684\u4e00\u4e2a\u5339\u914d\u8fc7\u7a0b\uff0c\u5339\u914d\u5230\u4e00\u4e9b\u5173\u952e\u70b9\u540e\u4f1a\u505c\u6b62\uff0c\u6c42\u5230\u8fd9\u4e9b\u5173\u952e\u70b9\u505c\u4e0b\u7684\u6982\u7387\n\n\u8003\u8651\u8bbe $f(i)=P(i$\u70b9\u88ab\u7ecf\u8fc7$)$\u7684\u8bbe\u6cd5\u5b58\u5728\u4e24\u4e2a\u95ee\u9898\n\n- $f(x)(x|$ $x$\u4e0d\u662f\u5173\u952e\u70b9 $)$\n- $f($ \u6839 $)$\u7684\u53d6\u503c\u672a\u5b9a\uff0c\u8f7b\u6613\u7684\u53ef\u4ee5\u53d1\u73b0\uff0c$f($ \u6839 $)=1$\u660e\u663e\u4e0e\u8fd9\u4e2a\u5339\u914d\u8fc7\u7a0b\u53ef\u4ee5\u53cd\u590d\u8fd4\u6839\u77db\u76fe\n\n\u4e0d\u59a8\u8f6c\u6362\u8bbe\u6cd5\n\n$f(i)=E(i$\u70b9\u88ab\u7ecf\u8fc7\u6b21\u6570$)$\n\n\u53d1\u73b0\u8fd9\u6837\u7684\u8bdd\uff0c\u6bcf\u4e2a\u70b9\u90fd\u5177\u6709\u5b9a\u4e49\uff0c\u4e14\u5728\u5173\u952e\u70b9\u65f6\u5176\u5230\u8fbe\u6b21\u6570\u7684\u671f\u671b=\u5728\u8fd9\u91cc\u505c\u6b62\u7684\u6982\u7387(\u56e0\u4e3a\u4f60\u53ea\u4f1a\u5230\u8fbe\u8fd9\u6837\u7684\u70b9\u4e00\u6b21)\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u7528\u5168\u671f\u671b\u516c\u5f0f\u5199\u6bcf\u4e2a\u70b9\u4ece\u5176\u4f59\u70b9\u8fc7\u6765\u7684\u8f6c\u79fb\u8fc7\u7a0b\u4e86\uff0c\u8bbe$x\\to y$\u8f6c\u79fb\u7684\u6982\u7387\u662f $P_{x\\to y}$,\u5bb9\u6613\u6ce8\u610f\u5230$1=\\sum_{y}P_{x\\to y}$\n\n$$\nf_x=\\begin{cases}1+\\sum_{y }P_{y\\to x}f_y&x=0\\\\\\sum_{y }P_{y\\to x}f_y&x\\neq0\\end{cases}\n$$\n\n\u89e3\u91ca\u4e0b\u90a3\u4e2a$1$\u662f\u72b6\u6001\u521d\u59cb\u7d2f\u8ba1\u7684\n\n\u7136\u540e\u9ad8\u65af\u6d88\u5143\u5c31\u4e0d\u5b58\u5728\u95ee\u9898\u4e86\n\n\n\u5230\u8fd9\u91cc\u4f60\u53ef\u80fd\u4f1a\u6709\u4e00\u70b9\u7591\u60d1\uff0c\u5173\u4e8e\u521d\u503c $f_0$ \uff0c\u5176\u5b9e\u662f\u4e0d\u9700\u8981\u7684\u4e14\u672a\u77e5\u7684\uff0c\u6ce8\u610f\u5230\u6211\u4eec\u5217\u51fa\u7684\u65b9\u7a0b\u6709$n$\u4e2a\uff0c\u672a\u77e5\u6570\u4e5f\u662f$n$\u4e2a\uff0c\u56e0\u6b64\u90fd\u662f\u53ef\u4ee5\u89e3\u51fa\u6765\u7684",
        "postTime": 1608966859,
        "uid": 40629,
        "name": "zzw4257",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P6125 \u3010[JSOI2009]\u6709\u8da3\u7684\u6e38\u620f\u3011"
    },
    {
        "content": "[$\\text{Link}$](https://www.luogu.com.cn/problem/P6125)\n## \u9898\u610f\n\u7ed9\u4f60 $n$ \u4e2a\u957f\u4e3a $l$ \u7684\u5b57\u7b26\u4e32 $a_{1,2,...,n}$\uff0c\u5b57\u7b26\u96c6\u5927\u5c0f\u4e3a $m$\uff0c\u6bcf\u6b21\u968f\u673a\u5728\u672b\u5c3e\u6dfb\u52a0\u4e00\u4e2a\u5b57\u7b26\uff0c\u5f53\u5f53\u524d\u5b57\u7b26\u4e32\u5305\u542b\u5b57\u7b26\u4e32 $a_i$ \u65f6\u7ed3\u675f\u64cd\u4f5c\uff0c\u5bf9 $1\\le i\\le n$ \u95ee $a_i$ \u6210\u4e3a\u7ed3\u675f\u64cd\u4f5c\u65f6\u6240\u5305\u542b\u7684\u5b57\u7b26\u4e32\u7684\u6982\u7387\u3002\n\n$1\\le n,l,m\\le10$\n## \u601d\u8def\n\u6211\u4eec\u5efa\u51fa $\\text{ACAM}$ \u548c\u5176 $\\text{Fail}$ \u6811\uff0c\u7136\u540e\u95ee\u9898\u5c31\u53d8\u6210\u4e86 $\\text{Fail}$ \u6811\u4e0a\u505c\u4e8e\u67d0\u4e00\u70b9\u7684**\u6982\u7387**\u3002\n\n\u8fd9\u8ba9\u6211\u4eec\u5bb9\u6613\u8054\u60f3\u5230\u9ad8\u65af\u6d88\u5143\uff0c\u4f46\u662f\u6211\u4eec\u5e76\u4e0d\u4f1a\u6c42\u7ecf\u8fc7 $x$ \u70b9\u7684\u6982\u7387\u3002\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u8bbe $f_x$ \u4e3a\u7ecf\u8fc7 $x$ \u70b9\u7684**\u671f\u671b**\u3002\u5219\u6211\u4eec\u6709 $f_x=[x=0]+\\sum_y\\text{P}_{y\\to x}f_y$\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5bf9\u5176\u8fdb\u884c\u9ad8\u65af\u6d88\u5143\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3l^3)$\u3002\n\n\u5f53\u7136\u6709 $O(n^3)$ \u7684\u9ad8\u8bba\u751f\u6210\u51fd\u6570\u505a\u6cd5\uff0c\u4f46\u6211\u4e0d\u4f1a\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nnamespace IO{//by cyffff\n\t\n}\nconst int N=100+10;\n#define Tr ACAM.a[cur].ch\n#define pid pair<int,double>\n#define mpr make_pair\nint n,l,m,endp[N];\ndouble A[N][N],ans[N],p[N],q[N];\nchar str[N];\nvector<pid>e[N];\nstruct AC_AutoMaton{\n\t#define son a[cur].ch\n\tint fail[N];\n\tint cnt=0;\n\tstruct node{\n\t\tint ch[10];\n\t\tbool endp;\n\t}a[N];\n\tinline void insert(char *s,int n,int x){\n\t\tint cur=0;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tint x=s[i]-'A'; \n\t\t\tif(!son[x]) son[x]=++cnt;\n\t\t\tcur=son[x];\n\t\t}\n\t\tendp[x]=cur;\n\t\ta[cur].endp=1;\n\t}\n\tinline void getfail(){\n\t\tqueue<int>q;\n\t\tfor(int i=0;i<m;i++){\n\t\t\tif(a[0].ch[i]) q.push(a[0].ch[i]);\n\t\t}\n\t\twhile(!q.empty()){\n\t\t\tint cur=q.front();\n\t\t\tq.pop();\n\t\t\tfor(int i=0;i<m;i++){\n\t\t\t\tif(!son[i]){\n\t\t\t\t\tson[i]=a[fail[cur]].ch[i];\n\t\t\t\t}else{\n\t\t\t\t\tint v=fail[cur];\n\t\t\t\t\tfail[son[i]]=a[v].ch[i];\n\t\t\t\t\tq.push(son[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tinline void build(){\n\t\tfor(int i=0;i<=cnt;i++){\n\t\t\tif(!a[i].endp){\n\t\t\t\tfor(int j=0;j<m;j++){\n\t\t\t\t\te[a[i].ch[j]].push_back(mpr(i,p[j+1]/q[j+1]));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<=cnt;i++){\n\t\t\tA[i+1][i+1]=-1;\n\t\t\tif(i==0) A[i+1][cnt+2]=-1;\n\t\t\tfor(int j=0;j<e[i].size();j++){\n\t\t\t\tint t=e[i][j].first;\n\t\t\t\tdouble w=e[i][j].second;\n\t\t\t\tA[i+1][t+1]+=w;\n\t\t\t}\n\t\t}\n\t}\n}ACAM;\ninline void Gauss(int n){\n\tfor(int i=1;i<=n;i++){\n\t\tint k=i;\n\t\tfor(int j=i+1;j<=n;j++){\n\t\t\tif(fabs(A[j][i])>fabs(A[k][i])){\n\t\t\t\tk=j;\n\t\t\t}\n\t\t}\n\t\tfor(int j=1;j<=n+1;j++){\n\t\t\tswap(A[i][j],A[k][j]);\n\t\t}\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tif(i!=j){\n\t\t\t\tdouble res=A[j][i]/A[i][i];\n\t\t\t\tfor(int l=i+1;l<=n+1;l++){\n\t\t\t\t\tA[j][l]-=A[i][l]*res;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tans[i]=A[i][n+1]/A[i][i];\n\t}\n}\nint main(){\n\tn=read(),l=read(),m=read();\n\tfor(int i=1;i<=m;i++){\n\t\tp[i]=read(),q[i]=read();\n\t\tif(p[i]==0) p[i]=0.000001;\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\treadstr(str);\n\t\tACAM.insert(str,l,i);\n\t}\n\tACAM.getfail();\n\tACAM.build();\n\tGauss(ACAM.cnt+1);\n\tfor(int i=1;i<=n;i++){\n\t\tprintf(\"%.2lf\\n\",max(ans[endp[i]+1],0.0));\n\t}\n}\n```\n\u518d\u89c1 qwq~",
        "postTime": 1624357904,
        "uid": 365127,
        "name": "cyffff",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6125\u3010[JSOI2009]\u6709\u8da3\u7684\u6e38\u620f\u3011"
    },
    {
        "content": "## \u601d\u8def\n\n\u8003\u8651\u5efa\u51fa AC \u81ea\u52a8\u673a\u4e4b\u540e `dp`\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u4eba\u5206\u522b\u8ba1\u7b97\u5b83\u7684\u80dc\u7387\uff0c\u8bbe\u5f53\u524d\u8ba1\u7b97\u5230\u7b2c $i$ \u4e2a\u4eba\u7684\u80dc\u7387\uff0c\u8bbe $f_u$ \u8868\u793a\u5f53\u524d\u5728 AC \u81ea\u52a8\u673a\u4e0a\u7684 $u$ \u53f7\u7ed3\u70b9\u83b7\u80dc\u7684\u6982\u7387\uff0c\u5bf9 AC \u81ea\u52a8\u673a\u4e0a\u6bcf\u4e2a\u7ed3\u70b9 $u$ \u5199\u51fa\u5b83\u7684\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n- \u82e5 $u$ \u4e3a\u7b2c $i$ \u4e2a\u5b57\u7b26\u4e32\u7684\u53f6\u5b50\u7ed3\u70b9\uff0c$f_u = 1$\u3002\n\n- \u82e5 $u$ \u4e3a\u53f6\u5b50\u7ed3\u70b9\u4f46 $u$ \u4e0d\u4e3a\u7b2c $i$ \u4e2a\u5b57\u7b26\u4e32\u7684\u53f6\u5b50\u7ed3\u70b9\uff0c$f_u = 0$\u3002\n\n- \u82e5 $u$ \u4e0d\u4e3a\u53f6\u5b50\u7ed3\u70b9\uff0c$f_u = \\sum\\limits_{i=0}^m f_{ch_{u,i}} \\times \\dfrac{p_i}{q_i}$\u3002\n\n\u7b54\u6848\u5373\u4e3a $f_0$\u3002\n\n\u53d1\u73b0\u8fd9\u4e2a\u8f6c\u79fb\u662f\u6709\u73af\u7684\uff0c\u4e0d\u80fd\u76f4\u63a5\u8f6c\u79fb\uff0c\u56e0\u6b64\u9ad8\u65af\u6d88\u5143\u540e\u5f97\u51fa\u7b54\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2ml + n^4l^3)$\u3002\n\n## \u4ee3\u7801\n\n[code](https://pastebin.ubuntu.com/p/HcsSSYWnHn/)",
        "postTime": 1658132256,
        "uid": 275273,
        "name": "zltqwq",
        "ccfLevel": 0,
        "title": "P6125 \u9898\u89e3"
    },
    {
        "content": "### [P6125 [JSOI2009]\u6709\u8da3\u7684\u6e38\u620f](https://www.luogu.com.cn/problem/P6125)\n\n\u5efa\u51fa `fail` \u6811\u4e4b\u540e\uff0c\u76f8\u5f53\u4e8e\u5bf9\u4e8e\u7ed9\u51fa\u7684\u5b57\u5178\u6811\uff0c\u4e00\u4e2a\u70b9\u5728\u4e0a\u968f\u673a\u6e38\u8d70\uff0c\u6bcf\u6b21\u968f\u673a\u8d70\u5230\u4ed6\u7684\u51fa\u8fb9\uff08\u5373\u4ed6\u7684 $m$ \u4e2a\u513f\u5b50\uff09\u4e4b\u4e00\uff08\u56e0\u4e3a\u5efa\u4e86 `fail` \u6811\u7684\u7f18\u6545\uff0c\u6240\u6709\u70b9\u7684\u513f\u5b50\u90fd\u4f1a\u6307\u5411\u4e00\u4e2a\u8282\u70b9\uff0c\u6216\u8005\u662f\u6839\u8282\u70b9\uff09\uff0c\u7136\u540e\u5982\u679c\u8d70\u5230\u67d0\u4e2a\u5b57\u7b26\u4e32\u7ed3\u5c3e\u5c31\u505c\u6b62\uff0c\u95ee\u6700\u7ec8\u5728\u54ea\u4e2a\u5b57\u7b26\u4e32\u4e0a\u505c\u6b62\u7684\u6982\u7387\u3002~~\u8fd9\u4e0d\u5c31\u662f\u663e\u7136\u7684\u9ad8\u65af\u6d88\u5143\u5417\uff0c\u5b9e\u5728\u662f\u592a\u7b80\u5355\u4e86\uff0c\u6211\u4e00\u773c\u5c31\u79d2\u4e86\uff01~~\n\n\u7136\u540e\u4f60\u53d1\u73b0\u4f60\u4e0d\u4f1a\u505a\u8fd9\u4e2a\u4e1c\u897f\u3002\u539f\u6765\u662f\u8fd9\u6837\uff01\u666e\u901a\u7684\u9ad8\u65af\u6d88\u5143\u7684\u65b9\u6cd5\u662f\u8bbe\u7ecf\u8fc7\u70b9 $x$ \u7684\u6982\u7387\u4e3a $f_x$ \u7136\u540e\u5217\u65b9\u7a0b\u6d88\u5143\uff0c\u4f46\u662f\u8fd9\u4e2a\u9898\u5f88\u96be\u8fd9\u4e48\u505a\u2026\u2026\u4e00\u79cd\u66f4\u52a0\u55b5\u55b5\u55b5\u7684\u505a\u6cd5\u662f\u8bbe\u7ecf\u8fc7\u70b9 $x$ \u7684**\u671f\u671b**\u7684\u6b21\u6570\u4e3a $f_x$\uff0c\u90a3\u4e48\u663e\u7136\uff0c\u7531\u4e8e\u7ed3\u5c3e\u5904\u6700\u591a\u7ecf\u8fc7\u4e00\u6b21\uff08\u6ca1\u6709\u51fa\u8fb9\uff09\uff0c\u90a3\u4e48\u6b64\u65f6\u7684\u671f\u671b\u5c31\u662f\u6982\u7387\u4e86\u3002\u6b64\u5916\uff0c\u4e0e\u524d\u8005\u76f8\u6bd4\uff0c\u671f\u671b\u7684\u6b21\u6570\u663e\u7136\u662f\u66f4\u52a0\u5bb9\u6613\u6c42\u7684\uff0c\u5177\u4f53\u7684\uff0c\u6709\uff1a\n$$\nf_x=\n\\begin{cases}\n\\displaystyle \\sum_y P(y \\to x)\\times f_y+1 \\ (x=0)\n\\\\\n\\displaystyle \\sum_y P(y \\to x)\\times f_y \\ (x\\ne 0)\n\\end{cases}\n$$\n\u5176\u4e2d\uff0c$P(y\\to x)$ \u8868\u793a\u70b9 $y$ \u5230\u70b9 $x$ \u7684\u51e0\u7387\uff0c$x=0$ \u65f6\u5019\u7684 $+1$ \u662f\u56e0\u4e3a\u4e00\u5f00\u59cb\u7684\u8d21\u732e\uff0c\u7136\u540e\u9ad8\u65af\u6d88\u5143\u5373\u53ef\u3002\u4e0d\u77e5\u9053\u4e3a\u5565\u6709\u4e00\u4e2a\u70b9\u4f1a\u8f93\u51fa\u5947\u602a\u7684\u4e1c\u897f\uff0c\u628a $p=0$ \u65f6\u8bbe\u7f6e\u6210 $0.00001$ \u5c31\u53ef\u4ee5\u4e86\uff0c\u6682\u65f6\u4e0d\u662f\u5f88\u61c2\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define pb push_back\n#define mp make_pair\n#define x first\n#define y second\n#define WT int T=read();while(T--) \n#define NO puts(\"NO\");\n#define YES puts(\"YES\");\n#define debug puts(\"qwq\");\nusing namespace std;\n\ninline int read()\n{\n    char c=getchar();int x=0;bool f=0;\n    for(;!isdigit(c);c=getchar())f^=!(c^45);\n    for(;isdigit(c);c=getchar())x=(x<<1)+(x<<3)+(c^48);\n    if(f)x=-x;return x;\n}\n\nconst int M=15;\nconst int N=110;\nint n,l,m,ed[M];\nstring s[M];\ndouble a[N][N],ans[N],p[M],q[M];\nstruct node\n{\n\tint son[26],fail,val;\n}t[N];int cnt;\nvector<pair<int,double> >e[N];\nvoid insert(string s,int p)\n{\n\tint now=0;\n\tfor (int i=0;i<l;i++)\n\t{\n\t\tif (!t[now].son[s[i]-'A'])t[now].son[s[i]-'A']=++cnt;\n\t\tnow=t[now].son[s[i]-'A'];\n\t}ed[p]=now;t[now].val=1;\n}\nvoid get_fail()\n{\n\tqueue<int>q;\n\tfor (int i=0;i<m;i++)\n\t\tif (t[0].son[i])q.push(t[0].son[i]);\n\twhile(!q.empty())\n\t{\n\t\tint now=q.front();q.pop();\n\t\tfor (int i=0;i<m;i++)\n\t\t{\n\t\t\tint v=t[now].son[i];\n\t\t\tif (v)t[v].fail=t[t[now].fail].son[i],q.push(v);\n\t\t\telse t[now].son[i]=t[t[now].fail].son[i];\n\t\t}\n\t}\n}\nvoid get_edge()\n{\n\tfor (int i=0;i<=cnt;i++)\n\t\tif (!t[i].val)\n\t\t\tfor (int j=0;j<m;j++)\n\t\t\t\te[t[i].son[j]].pb(mp(i,p[j+1]*1.0/q[j+1]));\n}\n\nvoid guass(int n)\n{\n//\tfor (int i=1;i<=n;i++)\n//\t{\n//\t\tfor (int j=1;j<=n+1;j++)\n//\t\t\tcout<<a[i][j]<<' ';\n//\t\tputs(\"\");\n//\t}\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tint p=i;\n\t\tfor (int j=i+1;j<=n;j++)\n\t\t\tif (fabs(a[j][i])>fabs(a[p][i]))\n\t\t\t\tp=j;\n\t\tfor (int j=1;j<=n+1;j++)\n\t\t\tswap(a[i][j],a[p][j]);\n\t\tfor (int j=n+1;j>=i;j--)a[i][j]/=a[i][i];\n\t\tfor (int j=i+1;j<=n;j++)\n\t\t\tfor (int k=n+1;k>=i;k--)\n\t\t\t\ta[j][k]-=a[j][i]*a[i][k];\n\t}\n//\tfor (int i=1;i<=n;i++){\n//\t\tfor (int j=1;j<=n+1;j++)cout<<a[i][j]<<' ';cout<<endl;}\n\tans[n]=a[n][n+1];\n\tfor (int i=n-1;i>=1;i--)\n\t{\n\t\tans[i]=a[i][n+1];\n\t\tfor (int j=i+1;j<=n;j++)\n\t\t\tans[i]-=a[i][j]*ans[j];\n\t}\n}\n\nsigned main()\n{\n\tcin>>n>>l>>m;\n\tfor (int i=1;i<=m;i++)\n\t{\n\t\tcin>>p[i]>>q[i];\n\t\tif (p[i]==0)p[i]=0.00001;\n\t}\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tcin>>s[i];\n\t\tinsert(s[i],i);\n\t}\n\tget_fail(),get_edge();//debug\n\tfor (int i=0;i<=cnt;i++)\n\t{\n\t\ta[i+1][i+1]=-1;if (i==0)a[i+1][cnt+2]=-1;\n\t\tfor (int j=0;j<e[i].size();j++)\n\t\t{\n\t\t\tint to=e[i][j].x;double w=e[i][j].y;\n\t\t\ta[i+1][to+1]+=w;\n\t\t}\n\t}guass(cnt+1);\n\tfor (int i=1;i<=n;i++)printf(\"%.2lf\\n\",max(ans[ed[i]+1],0.0));\n\treturn 0;\n}\n```\n\n",
        "postTime": 1621313492,
        "uid": 141179,
        "name": "pigstd",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P6125"
    },
    {
        "content": "[P6125 [JSOI2009]\u6709\u8da3\u7684\u6e38\u620f](https://www.luogu.com.cn/problem/P6125)\n\n\u5e9f\u8bdd\uff1a\n\n\u56e0\u4e3a\u592a\u4e45\u6ca1\u641e PGF \u8c03\u4e86\u56db\u4e2a\u5c0f\u65f6\uff0c\u6700\u540e\u5728 $\\color{black}{\\texttt{z}}\\color{red}{\\texttt{houkangyang}}$ \u7684\u6307\u5bfc\u4e0b\u8c03\u4e86\u51fa\u6765\u3002\u8c03\u7684\u8fc7\u7a0b\u4e2d\u7b54\u5e94\u67d0\u540c\u5b66\u8c03\u51fa\u6765\u5c31\u5199\u9898\u89e3\uff0c\u56e0\u4e3a\u8fd9\u79cd\u505a\u6cd5\u4e0d\u9700\u8981 ACAM \u5e76\u4e14\u590d\u6742\u5ea6\u66f4\u5c0f\uff0c\u7136\u540e\u5c31\u6765\u53d1\u9898\u89e3\u4e86qwq\u2026\u2026orz zhouakngyang\uff01\n\n--------------------\n\n\u5982\u679c\u505a\u8fc7 [P4548 [CTSC2006]\u6b4c\u5531\u738b\u56fd](https://www.luogu.com.cn/problem/P4548) \u548c [P3706 [SDOI2017]\u786c\u5e01\u6e38\u620f](https://www.luogu.com.cn/problem/P3706) \u4f1a\u53d1\u73b0\u8fd9\u9898\u51e0\u4e4e\u4e00\u6837\u3002\n\n\u8bbe $n$ \u4e2a\u751f\u6210\u51fd\u6570 $F_i(x)$\uff0c$[x^k]F_i(x)$ \u8868\u793a\u7b2c $i$ \u4e2a\u4eba\u5728\u7b2c $k$ \u8f6e\u83b7\u80dc\u7684\u6982\u7387\u3002\n\n\u518d\u8bbe\u4e00\u4e2a\u751f\u6210\u51fd\u6570 $G(x)$\uff0c$[x^k]G(x)$ \u8868\u793a\u6e38\u620f\u5728\u7b2c $k$ \u8f6e\u4ecd\u672a\u7ed3\u675f\u7684\u6982\u7387\u3002\n\n\u63a5\u4e0b\u53bb\u53ef\u4ee5\u5f97\u5230\u82e5\u5e72\u7b49\u5f0f\uff1a\n\n$$\n\\sum_{i=1}^{n} F_i(x)+G(x)=xG(x)+1\n$$\n\n\u5373\u5728\u7b2c $i - 1$ \u8f6e\u6ca1\u6709\u7ed3\u675f\u7684\u6982\u7387\u7b49\u4e8e\u5728\u7b2c $i$ \u8f6e\u7ed3\u675f\u7684\u6982\u7387\u52a0\u4e0a\u6ca1\u7ed3\u675f\u7684\u6982\u7387\uff0c\u6216\u8bb8\u5199\u6210 $f_i+g_i=g_{i-1}$ \u66f4\u597d\u7406\u89e3\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $1\\le i\\le n$ \u90fd\u53ef\u4ee5\u5217\u51fa\u4e0b\u9762\u7684\u7b49\u5f0f\n\n$$\nG(x)x^lP_{i, 1, l}=\\sum_{j=1}^{n}\\sum_{k=1}^{l}[S_i[1,k]=S_j[l-k+1,l]]F_j(x)x^{l - k}P_{i,l - k + 1, l}\n$$\n\n\u5176\u4e2d $P_{i,l, r}$ \u8868\u793a\u51fa\u73b0 $S_i[l, r]$ \u7684\u6982\u7387\u3002\n\n\u7b49\u5f0f\u5de6\u8fb9\u7684\u542b\u4e49\u662f\u7ed9\u6ca1\u7ed3\u675f\u7684\u5b57\u7b26\u4e32\u63a5\u4e0a\u4e00\u4e2a\u5b57\u7b26\u4e32\u8ba9\u4ed6\u7ed3\u675f\uff0c\u4f46\u662f\u4e5f\u4f1a\u5b58\u5728\u649e\u4e0a\u53e6\u4e00\u4e2a\u4eba\u7684\u4e32\u5bfc\u81f4\u63d0\u524d\u7ed3\u675f\u7684\u60c5\u51b5\u3002\n\n\u7b49\u5f0f\u53f3\u8fb9\u5c31\u662f\u6240\u6709\u53ef\u4ee5\u7ed3\u675f\u7684\u72b6\u51b5\u7684\u548c\u3002\u4e00\u4e2a\u4e32 $j$ \u5df2\u7ecf\u7ed3\u675f\u4e4b\u540e\u53c8\u63a5\u4e0a\u4e86 $S_i[1,l - k]$ \u6240\u4ee5\u9664\u6389 $P_{i,l - k + 1, l}$\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u4e24\u8fb9\u7ec4\u5408\u610f\u4e49\u76f8\u540c\u3002\n\n\u56e0\u4e3a\u4e2a\u4eba\u4e60\u60ef\uff0c\u628a $P$ \u7684\u5b9a\u4e49\u6539\u6210\u524d\u7f00\u548c\uff0c\u51cf\u5c0f\u4e00\u4e9b\u5e38\u6570\uff0c\u5373 $P_{i,k}$ \u8868\u793a\u51fa\u73b0 $S_i[1,k]$ \u7684\u6982\u7387\uff0c\u5316\u7b80\u4e00\u4e0b\u53ef\u4ee5\u5f97\u5230\uff1a\n$$\nG(x)x^l=\\sum_{j=1}^{n}\\sum_{k=1}^{l}[S_i[1,k]=S_j[l-k+1,l]]F_j(x)x^{l - k}/P_{i,k}\n$$\n\u7136\u540e\u6ce8\u610f\u5230\u6bcf\u4e2a\u4eba\u83b7\u80dc\u7684\u6982\u7387\u5c31\u662f $F_i(1)$\uff0c\u90a3\u4e48\u628a $x=1$ \u5e26\u8fdb\u53bb\u3002\n\n$$\n\\sum_{i=1}^{n} F_i(1)=1\n$$\n\n$$\nG(1)=\\sum_{j=1}^{n}\\sum_{k=1}^{l}[S_i[1,k]=S_j[l-k+1,l]]F_j(x)/P_{i,k}\n$$\n\n$n+1$ \u4e2a\u65b9\u7a0b $n+1$ \u4e2a\u672a\u77e5\u6570\u76f4\u63a5\u9ad8\u65af\u6d88\u5143\uff0c\u590d\u6742\u5ea6 $O(n^3)$\u3002\n\n\u6ce8\u610f\u5230\u8fd9\u4e2a\u65b9\u7a0b\u5728\u6240\u6709\u4e32\u90fd\u4e0d\u53ef\u80fd\u5f97\u5230\u7684\u60c5\u51b5\u4e0b\u4f1a\u65e0\u89e3\u8981\u7279\u5224\u3002\u7136\u540e\u8fd8\u6709\u4e00\u5806\u5947\u602a\u7684\u8fb9\u754c\u8981\u6ce8\u610f\uff0c\u770b\u4e2a\u4eba\u5199\u6cd5\u4e86\uff0c\u4e3b\u8981\u662f\u9664\u4ee5 $0$ \u7684\u60c5\u51b5\u8981\u5c0f\u5fc3\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define fi first\n#define se second\n#define mkp(x,y) make_pair(x,y)\n#define pb(x) push_back(x)\n#define sz(v) (int)v.size()\ntypedef long long LL;\ntypedef double db;\ntemplate<class T>bool ckmax(T&x,T y){return x<y?x=y,1:0;}\ntemplate<class T>bool ckmin(T&x,T y){return x>y?x=y,1:0;}\n#define rep(i,x,y) for(int i=x,i##end=y;i<=i##end;++i)\n#define per(i,x,y) for(int i=x,i##end=y;i>=i##end;--i)\ninline int read(){\n\tint x=0,f=1;char ch=getchar();\n\twhile(!isdigit(ch)){if(ch=='-')f=0;ch=getchar();}\n\twhile(isdigit(ch))x=x*10+ch-'0',ch=getchar();\n\treturn f?x:-x;\n}\nconst int N = 13;\nconst int base = 11;\nconst int mod = 20050103;// tommy0103/qq\n//\u5ffd\u7136\u53d1\u73b0\u4e0d\u7528\u53d6\u6a21\uff0c\u4f46\u662f\u4e0a\u9762\u90a3\u884c\u4e0d\u60f3\u5220\u4e86\uff08 \nint n, l, m, s[N][N];\ndb p[N], P[N][N], a[N][N], ans[N];\nLL H[N][N], pw[N];\ninline LL getHash(int i, int l, int r) {\n\treturn H[i][r] - H[i][l - 1] * pw[r - l + 1];\n}\ninline void Gauss(int n) {\n\trep(i, 1, n) {\n\t\tint mx = i;\n\t\trep(j, i + 1, n) if(fabs(a[j][i]) > fabs(a[mx][i])) mx = j;\n\t\tif(mx != i) { rep(j, 1, n + 1) swap(a[mx][j], a[i][j]); }\n\t\trep(j, 1, n) {\n\t\t\tif(i == j) continue;\n\t\t\tdb d = a[j][i] / a[i][i];\n\t\t\trep(k, i, n + 1) a[j][k] -= a[i][k] * d;\n\t\t}\n\t}\n\trep(i, 1, n) ans[i] = a[i][n + 1] / a[i][i];\n}\nsigned main() {\n\tn = read(), l = read(), m = read();\n\trep(i, 1, m) p[i] = read(), p[i] /= read();\n\tpw[0] = 1;\n\trep(i, 1, l) pw[i] = pw[i - 1] * base;\n\trep(i, 1, n) {\n\t\tstatic char str[N];\n\t\tscanf(\"%s\", str + 1), P[i][0] = 1;\n\t\trep(j, 1, l)\n\t\t\ts[i][j] = str[j] - 'A' + 1,\n\t\t\tH[i][j] = H[i][j - 1] * base + s[i][j],\n\t\t\tP[i][j] = P[i][j - 1] * p[s[i][j]];\n\t}\n\tbool flg = 1;\n\trep(i, 1, n) {\n\t\tif(P[i][l] < 1e-11) {\n\t\t\ta[i][i] = 1;\n\t\t\tcontinue;\n\t\t}\n\t\tflg = 0;\n\t\trep(j, 1, n) if(P[j][l] > 1e-11) {\n\t\t\trep(k, 1, l) if(getHash(i, 1, k) == getHash(j, l - k + 1, l))\n\t\t\t\ta[i][j] += 1. / P[i][k];\n\t\t}\n\t\ta[i][n + 1] = -1, a[i][n + 2] = 0;\n\t}\n\tif(flg) {\n\t\trep(i, 1, n) puts(\"0.00\");\n\t\treturn 0;\n\t}\n\trep(i, 1, n) a[n + 1][i] = 1;\n\ta[n + 1][n + 1] = 0, a[n + 1][n + 2] = 1;\n\tGauss(n + 1);\n\trep(i, 1, n) printf(\"%.2lf\\n\", ans[i] < 1e-5 ? 0. : ans[i]);\n\treturn 0;\n}\n````\n\n\n\n",
        "postTime": 1621346333,
        "uid": 123384,
        "name": "tommy0221",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 \u3010P6125 [JSOI2009]\u6709\u8da3\u7684\u6e38\u620f\u3011"
    },
    {
        "content": "\u8fd9\u4e2a\u9898\u662f\u4e0d\u9519\u7684AC\u81ea\u52a8\u673a\u548c\u9ad8\u65af\u6d88\u5143\u7684\u7ec3\u624b\u9898\u3002\n\n[\u4e0d\u4f1aAC\u81ea\u52a8\u673a\u5de6\u8f6c](https://www.luogu.com.cn/problem/P3808#submit)\uff0c[\u4e0d\u4f1a\u9ad8\u65af\u6d88\u5143\u5de6\u8f6c](https://www.luogu.com.cn/problem/P3389)\u3002\n\n\u8fd9\u4e2a\u9898\u5b9e\u9645\u4e0a\u5c31\u662f\u5728AC\u81ea\u52a8\u673a\u4e0a\u505a\u4e00\u4e2a```dp```\uff0c```f[i]```\u4ee3\u8868\u8d70\u5230```i```\u8fd9\u4e2a\u8282\u70b9\u7684\u6982\u7387\uff0c\u8f6c\u79fb\u65b9\u7a0b\u5c31\u662f```f[go[i][j]] += p[j] *f[i]```, \u7136\u540e\u4f1a\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u5c31\u662f\u8f6c\u79fb\u7684\u65f6\u5019\u51fa\u73b0\u4e86\u73af\uff0c\u8fd9\u6837\u5b50\u5c31\u8f6c\u79fb\u4e0d\u4e0b\u53bb\u4e86\u3002\n\n\u4e00\u822cdp\u8f6c\u79fb\u6210\u73af\u6709\u4e24\u79cd\u89e3\u51b3\u529e\u6cd5\uff0c\u8981\u4e48```cdq```\u5206\u6cbb\uff0c\u8981\u4e48```gauss```\u6d88\u5143\uff0c```cdq```\u5206\u6cbb\u4e00\u822c\u90fd\u662f\u89e3\u51b3\u76842D\u4ee5\u4e0a\u4e14\u67d0\u4e00\u7ef4\u6210\u73af\u800c\u53e6\u4e00\u7ef4\u53ea\u6709\u5c0f\u7684\u5bf9\u5927\u7684\u4ea7\u751f\u5f71\u54cd\u7684```dp```\u7684\uff0c\u800c\u5bf9\u4e8e\u6240\u6709\u7684\u6210\u73af\u95ee\u9898\uff0c```gauss```\u6d88\u5143\u624d\u662f\u901a\u6cd5\u3002\n\n\u8fd9\u4e2a\u9898\u600e\u4e48\u6d88\u5462\uff0c\u8fd9\u662f\u4e2a\u7279\u522b\u5e38\u89c1\u7684\u5957\u8def\uff0c\u5e38\u7528\u4e8e\u671f\u671b\u9898\u7684\u9a97\u5206\u3002\u5927\u6982\u5c31\u662f\u4f60\u5bf9\u6bcf\u4e2aAC\u81ea\u52a8\u673a\u4e0a\u7684\u8282\u70b9\u5efa\u4e00\u4e2a\u65b9\u7a0b\uff0c\u600e\u4e48\u5efa\u5462\uff0c\u5982\u679c```j```\u80fd\u901a\u8fc7```go[j][k]```\u8f6c\u79fb\u5230```i```,\u90a3\u4e48```i```\u8fd9\u4e2a\u65b9\u7a0b\u7b2c```j```\u9879\uff0c\u7cfb\u6570\u5c31\u662f```-p[k]```\uff0c\u7b2c```i```\u4e2a\u65b9\u7a0b\u7684\u7b2c```i```\u9879\u7cfb\u6570\u5c31\u662f1\uff0c\u7136\u540e\u89e3\u8fd9\u4e2a\u65b9\u7a0b\u7ec4\u5373\u53ef\u3002\n\n\u8bf4\u53e5\u9898\u5916\u8bdd\uff0c\u6211\u731c\u6d4b\u8fd9\u4e2a\u77e9\u9635\u662f\u4e00\u4e2a\u7a00\u758f\u77e9\u9635\uff0c\u6216\u8bb8\u53ef\u4ee5O(n ^ 2)\u5730\u9ad8\u65af\u6d88\u5143\uff0c\u4e0d\u8fc7\u8fd9\u4e2a\u9898\u66b4\u529b\u6d88\u5143\u5c31\u80fd\u8fc7\u3002\n\n\u5177\u4f53\u7ec6\u8282\u8bf7\u89c1\u4ee3\u7801\u3002\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define eps 1e-9\n#define maxn 105\n#define A go[now][s[i] - 'A']\n#define For(i, j, n) for(register int i = j ; i <= n ; ++i)\nint n, m, l, tot, dfn[maxn], vis[maxn], fail[maxn], go[maxn][20];\ndouble u, v, p[maxn], c[maxn][maxn];\nstring s;\n\ninline void insert(string s, int x){\n\tint now = 0;\n\tFor(i, 0, l - 1) A = A ? A : ++tot, now = A; \n\tdfn[x] = now, vis[now] = 1;\n}\ninline void build(){\n\tqueue<int>q;\n\tFor(i, 0, m - 1) if(go[0][i]) q.push(go[0][i]); \n\twhile(!q.empty()){\n\t\tint u = q.front(); q.pop();\n\t\tFor(i, 0, m - 1){\n\t\t\tif(go[u][i]) fail[go[u][i]] = go[fail[u]][i], q.push(go[u][i]);\n\t\t\telse go[u][i] = go[fail[u]][i]; \n\t\t}\n\t}\n}\ninline void start(){\n\tc[0][tot + 1] = 1;\n\tFor(i, 0, tot){\n\t\tc[i][i] = 1;\n\t\tif(!vis[i]) For(j, 0, m - 1) c[go[i][j]][i] -= p[j];\n\t}\n}\n\ninline void gauss(){\n\tFor(i, 0, tot){\n\t\tint tmph = i;\n\t\tFor(j, i + 1, tot) if(fabs(c[tmph][i]) < fabs(c[j][i])) tmph = j;\n\t\tif(i ^ tmph) swap(c[i], c[tmph]);\n\t\tdouble tmp = c[i][i];\n\t\tif(fabs(tmp) < eps) continue;\n\t\tFor(j, i + 1, tot + 1) c[i][j] /= tmp;\n\t\tFor(j, 0, tot){\n\t\t\tif(i ^ j){\n\t\t\t\ttmp = c[j][i];\n\t\t\t\tFor(k, i, tot + 1) c[j][k] -= c[i][k] * tmp;\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tscanf(\"%d %d %d\", &n, &l, &m);\n\tFor(i, 0, m - 1) scanf(\"%lf %lf\", &u, &v), p[i] = u / v;\n\tFor(i, 1, n) cin >> s, insert(s, i);\n\tbuild(), start(), gauss();\n\tFor(i, 1, n) printf(\"%.2lf\\n\", c[dfn[i]][tot + 1]);\n\treturn 0;\n}\n```",
        "postTime": 1584540803,
        "uid": 163980,
        "name": "\u884c\u541f\u5578\u4e5d\u5dde",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P6125 \u3010[JSOI2009]\u6709\u8da3\u7684\u6e38\u620f\u3011"
    },
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a[AC \u81ea\u52a8\u673a](https://oi-wiki.org/string/ac-automaton/)\u3001[\u9ad8\u65af\u6d88\u5143](https://oi-wiki.org/math/gauss/)\n\n\u770b\u5230\u5b57\u7b26\u4e32\u5339\u914d\uff0c\u8003\u8651 AC \u81ea\u52a8\u673a\u3002\u5bf9\u6240\u6709\u5b57\u6bcd\u6392\u5217\u5efa\u51fa AC \u81ea\u52a8\u673a\u540e\uff0c\u4e0d\u96be\u60f3\u5230\u5bf9\u6bcf\u4e2a\u4eba\u5206\u5f00\u5904\u7406\u3002\u5bf9\u4e8e\u7b2c $i$ \u4e2a\u4eba\uff0c\u8bbe $dp_j$ \u8868\u793a\u73b0\u5728\u4f4d\u4e8e Trie \u6811\u4e0a\u7684 $j$ \u53f7\u8282\u70b9\u65f6\uff0c\u7b2c $i$ \u4e2a\u4eba\u83b7\u80dc\u7684\u6982\u7387\u3002\n\n\u521d\u503c\uff1a$j$ \u53f7\u8282\u70b9\u4ee3\u8868\u7684\u5b57\u7b26\u4e32\u4e3a $i$ \u65f6\uff0c$dp_j = 1$\uff1b$j$ \u53f7\u8282\u70b9\u6709\u5b57\u7b26\u4e32\u4e14\u4ee3\u8868\u7684\u5b57\u7b26\u4e32\u4e0d\u4e3a $i$ \u65f6\uff0c$dp_j = 0$.\n\n\u8f6c\u79fb\uff1a$dp_j = \\displaystyle\\sum_{k = 1}^m dp_{nxt_{j, k}}$\u3002\n\n\u7b54\u6848\uff1a$dp_1$\u3002\n\n\u5bb9\u6613\u53d1\u73b0\uff0c\u8fd9\u6837\u8f6c\u79fb\u4f1a\u51fa\u73b0\u73af\uff0c\u9ad8\u65af\u6d88\u5143\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^2 ml + n^4l^3)$\u3002\n\n\u6ce8\u610f\u672c\u9898\u5361\u7cbe\u5ea6\uff0ceps \u9700\u8981\u5f00\u5230 $10^{-11}$ \u624d\u80fd AC\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <iostream>\n#include <queue>\n#include <cstdio>\n#include <cstring>\n#include <cmath>\n\nusing namespace std;\n\ntypedef struct {\n\tint pos;\n\tint nxt[17];\n} Node;\n\ntypedef struct Matrix_tag {\n\tint n;\n\tint m;\n\tdouble a[107][107];\n\tMatrix_tag(int n_, int m_){\n\t\tn = n_;\n\t\tm = m_;\n\t\tmemset(a, 0, sizeof(a));\n\t}\n} Matrix;\n\nconst double eps = 1e-11;\nint cnt = 1;\nint fail[107];\ndouble prob[17];\nchar s[17];\nNode tree[107];\nqueue<int> q;\n\ninline void insert(char s[], int pos){\n\tint len = strlen(&s[1]), i = 1;\n\tfor (register int j = 1; j <= len; j++){\n\t\tint ch = s[j] - 'A' + 1;\n\t\tif (tree[i].nxt[ch] == 0) tree[i].nxt[ch] = ++cnt;\n\t\ti = tree[i].nxt[ch];\n\t}\n\ttree[i].pos = pos;\n}\n\ninline void build(int n){\n\tfail[1] = 1;\n\tfor (register int i = 1; i <= n; i++){\n\t\tif (tree[1].nxt[i] == 0){\n\t\t\ttree[1].nxt[i] = 1;\n\t\t} else {\n\t\t\tfail[tree[1].nxt[i]] = 1;\n\t\t\tq.push(tree[1].nxt[i]);\n\t\t}\n\t}\n\twhile (!q.empty()){\n\t\tint cur = q.front();\n\t\tq.pop();\n\t\tfor (register int i = 1; i <= n; i++){\n\t\t\tif (tree[cur].nxt[i] == 0){\n\t\t\t\ttree[cur].nxt[i] = tree[fail[cur]].nxt[i];\n\t\t\t} else {\n\t\t\t\tfail[tree[cur].nxt[i]] = tree[fail[cur]].nxt[i];\n\t\t\t\tq.push(tree[cur].nxt[i]);\n\t\t\t}\n\t\t}\n\t}\n}\n\ninline int gauss(Matrix &a){\n\tint ni = a.n + 1, i = 1, j = 1;\n\tfor (; i <= a.m && j <= a.n; i++, j++){\n\t\tint t1 = i;\n\t\tfor (register int k = i + 1; k <= a.m; k++){\n\t\t\tif (fabs(a.a[t1][j]) < fabs(a.a[k][j])) t1 = k;\n\t\t}\n\t\tif (i != t1) swap(a.a[i], a.a[t1]);\n\t\tif (fabs(a.a[i][j]) < eps){\n\t\t\ti--;\n\t\t\tcontinue;\n\t\t}\n\t\tfor (register int k = i + 1; k <= a.m; k++){\n\t\t\tdouble t2 = a.a[k][j] / a.a[i][j];\n\t\t\tfor (register int l = j; l <= ni; l++){\n\t\t\t\ta.a[k][l] -= t2 * a.a[i][l];\n\t\t\t}\n\t\t}\n\t}\n\tif (i <= a.m){\n\t\tfor (; i <= a.m; i++){\n\t\t\tif (fabs(a.a[i][j]) > eps) return 0;\n\t\t}\n\t\treturn 0x7fffffff;\n\t}\n\tfor (register int k = a.n; k >= 1; k--){\n\t\tfor (register int l = k + 1; l <= a.n; l++){\n\t\t\ta.a[k][ni] -= a.a[k][l] * a.a[l][ni];\n\t\t}\n\t\ta.a[k][ni] /= a.a[k][k];\n\t}\n\treturn 1;\n}\n\nint main(){\n\tint n, l, m, cnt_i;\n\tcin >> n >> l >> m;\n\tfor (register int i = 1; i <= m; i++){\n\t\tint p, q;\n\t\tcin >> p >> q;\n\t\tprob[i] = 1.0 * p / q;\n\t}\n\tfor (register int i = 1; i <= n; i++){\n\t\tcin >> &s[1];\n\t\tinsert(s, i);\n\t}\n\tcnt_i = cnt + 1;\n\tbuild(m);\n\tfor (register int i = 1; i <= n; i++){\n\t\tMatrix a(cnt, cnt);\n\t\tfor (register int j = 1; j <= cnt; j++){\n\t\t\ta.a[j][j] = 1.0;\n\t\t\tif (tree[j].pos == i){\n\t\t\t\ta.a[j][cnt_i] = 1.0;\n\t\t\t} else if (tree[j].pos == 0){\n\t\t\t\tfor (register int k = 1; k <= m; k++){\n\t\t\t\t\ta.a[j][tree[j].nxt[k]] -= prob[k];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tgauss(a);\n\t\tprintf(\"%.2lf\\n\", a.a[1][cnt_i]);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1646996242,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P6125 \u3010[JSOI2009] \u6709\u8da3\u7684\u6e38\u620f\u3011"
    }
]
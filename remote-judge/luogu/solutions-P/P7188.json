[
    {
        "content": "[[CRCI2008-2009] CVJETICI](https://www.luogu.com.cn/problem/P7188)\n\n\n\u89c2\u5bdf\u56fe\u7247\u53ca\u6837\u4f8b\u4e00\uff1a\n![](https://s1.ax1x.com/2020/08/08/a5mp5j.png)\n\n\u6ce8\uff1a\u4e0b\u6587\u4e2d\u7684\u88ab\u5360\u9886\uff0c\u6307\u7684\u662f\u5728\u8fd9\u4e00\u4e2a\u533a\u95f4\u5185\uff0c\u624d\u6709\u4ea4\u53c9\u5f00\u82b1\u7684\u53ef\u80fd\u3002\n\n\u7b2c\u4e00\u5f20\u5c0f\u56fe\u53d1\u73b0 $2 \\sim 3$ \u88ab\u5360\u9886\u3002\n\u7b2c\u4e8c\u5f20\u5c0f\u56fe\u53d1\u73b0 $4 \\sim 6$ \u88ab\u5360\u9886\uff0c\u5e76\u4f38\u5165 $2 \\sim 3$ \u5185\uff0c\u5f00\u82b1\u3002\u7b2c\u4e09\u5f20\u5c0f\u56fe\u53d1\u73b0 $2 \\sim 5$ \u88ab\u5360\u9886\uff0c\u5e76\u4f38\u5165 $4 \\sim 6$ \u5185\uff0c\u5f00\u82b1\uff0c\u5176\u4e2d $2$ \u88ab\u5360\u9886\u4e86\u4e24\u6b21\uff0c\u53ef\u80fd\u4f1a\u5f00\u4e24\u6b21\u82b1\uff0c$6$ \u5df2\u7ecf\u5f00\u82b1\uff0c\u5c06\u6765\u4e0d\u5728\u5f00\u82b1\u3002\u7b2c\u56db\u5f20\u5c0f\u56fe\u53d1\u73b0 $3 \\sim 5$ \u88ab\u5360\u9886\uff0c\u5e76\u4f38\u5165\u88ab\u4e24\u6b21\u5360\u9886\u7684\u5730\u65b9\u5185\uff0c\u5f00\u4e24\u6b21\u82b1\u3002\n\n\u4e11\u56fe\u732e\u4e0a\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4t2mcd3p.png)\n\n\u8fd9\u91cc\u6709\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u600e\u4e48\u5224\u65ad\u6bcf\u4e2a\u70b9\u88ab\u5360\u9886\u4e86\u51e0\u6b21\uff1f\uff0c\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u7ebf\u6bb5\u6811\u6765\u5904\u7406\u4e00\u4e2a\u533a\u95f4\u5185\u6bcf\u4e2a\u70b9\u90fd\u88ab\u5360\u9886\u4e86\u4e00\u6b21\uff0c\u76f8\u5f53\u4e8e\u6bcf\u4e2a\u70b9\u52a0\u4e00\u3002\u7136\u540e\u5355\u70b9\u67e5\u8be2\uff0c\u5224\u65ad\u88ab\u5360\u9886\u4e86\u51e0\u6b21\u3002\u7531\u4e8e\u770b\u8fc7\u82b1\u7684\u5730\u65b9\u4e0d\u80fd\u5728\u5f00\u82b1\uff0c\u6211\u4eec\u8981\u51cf\u53bb\u4e4b\u524d\u6709\u8fc7\u7684\u6570\u91cf\uff0c\u4e5f\u5f88\u7b80\u5355\uff0c\u7528\u6570\u7ec4\u5b58\u8d2e\u4e4b\u524d\u8fd9\u4e2a\u70b9\u4e0a\u5f00\u8fc7\u591a\u5c11\u82b1\u5c31\u884c\u4e86\u3002\n\n\u6811\u72b6\u6570\u7ec4\u601d\u8def\u76f8\u540c\uff0c\u8bb0\u5f97\u7528\u4e0a\u5dee\u5206\u3002\u5e76\u5728\u8d77\u70b9\u5904\u52a0\u4e00\uff0c\u7ec8\u70b9\u51cf\u4e00\uff0c\u7528\u524d\u7f00\u548c\u4ee3\u8868\u8fd9\u4e00\u6bb5\u7684\u6570\u91cf\u3002\n\n\u7ebf\u6bb5\u6811\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define p2 (p<<1)  //\u5de6\u53f3\u513f\u5b50\n#define p3 (p<<1|1)\nconst int M=100005;\nint n,tr[M<<2],had[M];//had\u662f\u6807\u8bb0\u6570\u7ec4\nvoid upd(int l,int r,int x,int y,int p){\n\tif(l==x&&r==y){\n\t\ttr[p]++;\n\t\treturn;\n\t}\n\tint mid=(l+r)/2;\n\ttr[p2]+=tr[p];\n\ttr[p3]+=tr[p];\n\ttr[p]=0;\n\tif(y<=mid) upd(l,mid,x,y,p2);\n\telse if(x>=mid+1) upd(mid+1,r,x,y,p3);\n\telse upd(l,mid,x,mid,p2),upd(mid+1,r,mid+1,y,p3);\n}\nint query(int l,int r,int x,int p){\n\tif(l==r) return tr[p];\n\tint mid=(l+r)/2,ret=0;\n\ttr[p2]+=tr[p];\n\ttr[p3]+=tr[p];\n\ttr[p]=0;\n\tif(x<=mid) ret=query(l,mid,x,p2);\n\telse ret=query(mid+1,r,x,p3);\n\treturn ret;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++){\n\t\tint a,b;\n\t\tscanf(\"%d%d\",&a,&b);\n\t\tif(a>b) swap(a,b);\n\t\tint r1=query(1,100000,a,1);\n\t\tint r2=query(1,100000,b,1);//\u8fdb\u884c\u67e5\u8be2\n\t\t//\u67e5\u8be2\u5b8c\u540e\uff0c\u53ef\u80fd\u53ef\u4ee5\u5f00\u82b1\u7684\u6570\u91cf\u6570r1+r2\uff0c\u5f53\u65f6\u4e24\u6735\u82b1\u4e0d\u80fd\u5728\u4e00\u70b9\uff0c\u6240\u4ee5\u51cf\u53bb\u5f00\u8fc7\u7684\u82b1\uff0c\u4e5f\u5c31\u662fhad\n\t\tprintf(\"%d\\n\",r1-had[a]+r2-had[b]);\n\t\t//\u66f4\u65b0a\u70b9\u4e0a\u76ee\u524d\u6709\u7684\u6570\u91cfr1\n\t\thad[a]=r1;\n\t\thad[b]=r2;\n\t\t//a+1\u5230b-1\u8fd9\u4e2a\u533a\u95f4\uff0c\u53bb\u589e\u52a0\u4e00\n\t\t//\u4e3a\u4e86\u9632\u6b62\u6ca1\u6709\u533a\u95f4\uff0c\u5982a=1,b=2\u7684\u60c5\u51b5\u8981\u5224\u65ad\u4e00\u4e0b\n\t\tif(a+1<=b-1) upd(1,100000,a+1,b-1,1);\n\t}\n\treturn 0;\n}\n```\n\u6811\u72b6\u6570\u7ec4\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int M=100005;\nint n,C[M+5],had[M+5];\nvoid add(int x,int y){//\u5728x\u7684\u5730\u65b9\u52a0\u4e0ay\n\tfor(int i=x;i<=M;i+=i&-i) C[i]+=y;\n}\nint sum(int x){\n\tint ret=0;\n\tfor(int i=x;i;i-=i&-i) ret+=C[i];\n\treturn ret;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++){\n\t\tint a,b;\n\t\tscanf(\"%d%d\",&a,&b);\n\t\tif(a>b) swap(a,b);\n\t\tint r1=sum(a);\n\t\tint r2=sum(b);//\u8fdb\u884c\u67e5\u8be2\n\t\t//\u67e5\u8be2\u5b8c\u540e\uff0c\u53ef\u80fd\u53ef\u4ee5\u5f00\u82b1\u7684\u6570\u91cf\u6570r1+r2\uff0c\u5f53\u65f6\u4e24\u6735\u82b1\u4e0d\u80fd\u5728\u4e00\u70b9\uff0c\u6240\u4ee5\u51cf\u53bb\u5f00\u8fc7\u7684\u82b1\uff0c\u4e5f\u5c31\u662fhad\n\t\tprintf(\"%d\\n\",r1-had[a]+r2-had[b]);\n\t\t//\u66f4\u65b0a\u70b9\u4e0a\u76ee\u524d\u6709\u7684\u6570\u91cfr1\n\t\thad[a]=r1;\n\t\thad[b]=r2;\n\t\t//a+1\u4f4d\u7f6e\u4e0a\u52a01\uff0cb-1\u4f4d\u7f6e\u4e0a-1\n\t\t//\u4e3a\u4e86\u9632\u6b62\u6ca1\u6709\u533a\u95f4\uff0c\u5982a=1,b=2\u7684\u60c5\u51b5\u8981\u5224\u65ad\u4e00\u4e0b\n\t\tif(a+1<=b-1) add(a+1,1),add(b,-1);\n\t}\n\treturn 0;\n}\n```\n\u5b98\u65b9\u4ee3\u7801\uff08\u601d\u8def\u5dee\u4e0d\u591a\u7684\uff0c\u4ed6\u5c06\u5176\u5206\u6210\u4e86 $256$ \u5757\uff09\n\n```cpp\n#include <cstdio>\n\nint N;\nint A[100001];\nint B[1000];\n\nint main( void ) {\n   scanf( \"%d\", &N );\n   for( int i = 0; i < N; ++i ) {\n      int L, R;\n      scanf( \"%d%d\", &L, &R );\n\n      printf( \"%d\\n\", A[L]+B[L>>8] + A[R]+B[R>>8] );\n\n      A[L] = -B[L>>8];\n      A[R] = -B[R>>8]; \n\n      int x = L+1;\n      for( ; x < R && (x&0xFF); ++x ) ++A[x];\n      for( ; x+256 <= R;   x += 256 ) ++B[x>>8];\n      for( ; x < R;             ++x ) ++A[x];\n   }\n\n   return 0;\n}\n```\n",
        "postTime": 1673753372,
        "uid": 616964,
        "name": "shoot_down",
        "ccfLevel": 4,
        "title": "[CRCI2008-2009] CVJETICI"
    }
]
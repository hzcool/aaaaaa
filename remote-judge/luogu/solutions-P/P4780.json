[
    {
        "content": "\u6700\u591a\u670910\u4e2a\u8d28\u6570\uff0c\u56e0\u4e3a$$2*3*5*7*11*13*17*19*23*29=6469693230$$\n\u4e00\u4e2a\u8d28\u6570\u6700\u591a\u670930\u4e2a\uff0c\u56e0\u4e3a$$2^{31}=2147483648$$\n\u5747\u5927\u4e8e\u7b49\u4e8e$2^{31}$\uff0c\u6545\u5e94\u4e3a$-1$\u3002\n\n\u53ef\u89c1\uff0c\u672c\u9898\u6570\u636e\u8303\u56f4\u8f83\u5c0f\uff0c\u53ef\u7528$dfs$\u6765\u5b8c\u6210\u3002\n```\n#include<cstdio>\n#include<iostream>\n#include<cmath>\nusing namespace std;\n#define LL long long\nint tot,vis[46500];\nLL prime[4800];\nvoid init(){  //\u9884\u5904\u7406\u7d20\u6570\n\tprime[++tot]=2;\n\tfor(int i=3;i<=46400;i+=2)\n\tif(!vis[i]){\n\t\tprime[++tot]=i;int qq=i<<1;\n\t\tfor(int j=i*3;j<=46400;j+=qq)\n\t\tif(!vis[j])vis[j]=1;\n\t}\n\t//4796 primes\n}\nLL n,ans=4294967296;\nbool pr(LL qq){  //\u5224\u65ad\u5355\u4e2a\u6570\u5b57\u662f\u5426\u4e3a\u7d20\u6570\n\tif(qq&1^1)return false;\n\tint rr=sqrt(qq);\n\tfor(int i=3;i<=rr;i+=2)\n\tif(qq%i==0)return false;\n\treturn true;\n}\nvoid dfs(int pri,LL num,LL phi){\n\tif(num==1){  //\u82e5\u8be5\u6570\u5df2\u7ecf\u88ab\u62c6\u5b8c\uff0c\u76f4\u63a5\u66f4\u65b0\u7b54\u6848\n\t\tans=min(ans,phi);\n\t\treturn;\n\t}\n\tif(num>sqrt(n)&&pr(num+1)){  //\u82e5\u5f53\u524d\u6570\u5927\u4e8esqrt(n)\uff0c\u90a3\u4e48\u53ef\u80fd\u4e3a\u8d28\u6570\u4e14\u53ea\u6709\u4e00\u4e2a\uff0c\u6545\u8fdb\u884c\u5224\u65ad\n\t\tans=min(ans,phi*(num+1)); //\u82e5\u662f\u8d28\u6570\u76f4\u63a5\u66f4\u65b0\u7b54\u6848\n        return;\n\t}\n\tfor(int i=pri+1;i<=tot&&(prime[i]-1)<=num;i++) //\u679a\u4e3e\u6240\u6709\u8d28\u6570\n\tif(num%(prime[i]-1)==0){\n\t\tLL num_=num/(prime[i]-1);\n\t\tLL phi_=phi*prime[i];  //\u8ba1\u7b97\u65b0\u7684\u6570\u5b57\u548c\u7b54\u6848\n\t\tdfs(i,num_,phi_);  //\u4e0b\u4e00\u8f6edfs\n\t\twhile(num_%prime[i]==0){//\u679a\u4e3e\u8be5\u8d28\u6570\u7684\u6b21\u6570\n\t\t\tnum_/=prime[i];   //\u8ba1\u7b97\u65b0\u7684\u6570\u5b57\u548c\u7b54\u6848\n\t\t\tphi_*=prime[i];\n\t\t\tdfs(i,num_,phi_);  //\u4e0b\u4e00\u8f6edfs\n\t\t}\n\t}\n}\nint main(){\n\tinit();   //\u5f97\u5230sqrt(2147483647)\u4ee5\u5185\u7684\u8d28\u6570 \n\tscanf(\"%d\",&n);\n\tdfs(0,n,1);  //\u8fdb\u884cdfs\uff0c\u4e00\u5b9a\u8981\u521d\u59cb\u5316\u7b54\u6848\u4e3a1\n\tif(ans!=4294967296)printf(\"%lld\\n\",ans);\n\telse puts(\"-1\");  //\u8f93\u51fa\u7b54\u6848\n}\n```",
        "postTime": 1532397983,
        "uid": 50092,
        "name": "da32s1da",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P4780 \u3010Phi\u7684\u53cd\u51fd\u6570\u3011"
    },
    {
        "content": "\u672c\u9898\u89e3\u5206\u4e3a\u4e09\u4e2a\u90e8\u5206\uff1a\n\n - \u6b27\u62c9\u51fd\u6570\u5b9a\u7406\n - \u672c\u9898\u601d\u8def\n - \u4ee3\u7801\n \n## 1. \u6b27\u62c9\u51fd\u6570\u5b9a\u7406\n\u6b27\u62c9\u51fd\u6570\u8868\u793a\u7684\u662f\u5c0f\u4e8e\u7b49\u4e8e $n$ \u7684\u4e0e $n$ \u4e92\u8d28\u7684\u6570\u7684\u4e2a\u6570\uff0c\u5199\u4f5c $\\varphi(n)$ \u3002\n\n1.1 $\\varphi(n) = \\prod_{p | n}^{n} \\frac{p - 1}{p}$\n\n1.2 \u6b27\u62c9\u51fd\u6570\u662f\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\uff0c\u5373\uff1a\u5bf9\u4efb\u610f\u4e92\u8d28\u7684\u6b63\u6574\u6570 $n, m$\uff0c\u6709 $\\varphi(nm) = \\varphi(n) \\times \\varphi(m)$\n\n1.3 \u8d28\u6570 $p$ \u7684\u6b27\u62c9\u51fd\u6570\u7b49\u4e8e $p - 1$ \u3002\n\n## 2. \u672c\u9898\u601d\u8def\n\n\u672c\u9898\u6c42\u89e3\u53cd\u6b27\u62c9\u51fd\u6570\uff0c\u5373\uff1a\u5df2\u77e5\u4e0e\u5c0f\u4e8e\u7b49\u4e8e $x$ \u4e14 $x$ \u4e92\u8d28\u7684\u6570\u6709 $n$ \u4e2a\uff0c\u6c42  $x$ \u7684\u6700\u5c0f\u503c\u3002\n\n\u6709\u6027\u8d28 1.1 \u53ef\u77e5\uff0c\u4e00\u4e2a\u6570\u8d28\u56e0\u5b50\u51fa\u73b0\u7684\u6b21\u6570\u591a\u5c11\u5bf9\u4ed6\u7684\u6b27\u62c9\u51fd\u6570\u6ca1\u6709\u5f71\u54cd\uff0c\u7531\u4e8e\u8981\u6c42 $x$ \u7684\u6700\u5c0f\u503c\uff0c\u6240\u4ee5\u5f53\u6211\u4eec\u628a\u6240\u6709\u8d28\u56e0\u5b50\u7684\u6307\u6570\u5747\u53d6 1 \u65f6\uff0c\u5c31\u4f1a\u8fbe\u5230\u6700\u5c0f\u503c\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u5c06 $x$ \u8868\u793a\u4e3a $p_1 \\cdot p_2 \\dots p_m$ \uff0c\u5c06 $n$ \u8868\u793a\u4e3a $(p_1 - 1)(p_2 - 1)\\dots(p_m - 1)$\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06 $n$ \u5206\u89e3\u4e3a\u4e00\u4e9b\u8d28\u6570 $-1$\uff08\u4e00\u5b9a\u522b\u5fd8\u4e86\u51cf\u4e00\uff01\uff01\uff09\u7684\u4e58\u79ef\uff0c\u8fd9\u53ef\u4ee5\u7528 dfs \u6765\u5b9e\u73b0\u3002\n\n\u540c\u65f6\u8981\u4fdd\u8bc1\u5206\u89e3\u7684\u8d28\u6570\u5e76\u4e0d\u91cd\u590d\uff0c\u8fd9\u53ef\u4ee5\u7528\u4e00\u4e2a Map\uff08\u6216\u8005\u6570\u7ec4\uff09\u6765\u8bb0\u5f55\u8be5\u8d28\u6570\u662f\u5426\u88ab\u641c\u7d22\u8fc7\u3002\n\n## 3. \u4ee3\u7801\n\n```\n#include <iostream>\n#include <cstring>\n#include <cstdio>\n#include <algorithm>\n#include <cmath>\n#include <unordered_map> // \u7528\u6765\u8bb0\u5f55\u5f53\u524d\u6570\u662f\u5426\u7528\u8fc7\n\nusing namespace std;\n\nint n;\nint res = 2147483647;\nunordered_map<int, bool> Map;\n\nbool is_prime(int n)\n{\n\tif (n <= 1) return false;\n\tfor (int i = 2; i <= n / i; i ++ )\n\t\tif (n % i == 0)\n\t\t\treturn false;\n\t\t\t\n\treturn true;\n}\n\nvoid dfs(int u, int arcphi, int rest)\n{\n\tif (arcphi >= res) return; // \u526a\u679d\u4f18\u5316\n\t\n\tif (rest == 1) {\n\t\tres = min(res, arcphi);\n\t\treturn;\n\t}\n\t\n\tif (is_prime(rest + 1)) dfs(u + 1, arcphi * (rest + 1), 1);\n\t// \u5982\u679c\u5f53\u524d\u5269\u4f59\u7684\u6570\u662f\u4e00\u4e2a\u5927\u7d20\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u5224\u6389\n\tfor (int i = 2; i <= rest / i; i ++ )\n\t\tif (is_prime(i + 1) && rest % i == 0 && Map[i] == false)\n\t\t{\n\t\t\tMap[i] = true; // \u8bb0\u5f55\u4e00\u4e0b\u5df2\u7ecf\u88ab\u7528\u8fc7\u4e86\n\t\t\tdfs(i, arcphi * (i + 1), rest / i);\n\t\t\tMap[i] = false;\n\t\t}\n}\n\nint main()\n{\n\tcin >> n;\n\t\n\tdfs(1, 1, n);\n\t\n\tcout << (res == 2147483647 ? -1 : res) << endl;\n\t\n\treturn 0;\n}\n```",
        "postTime": 1648538359,
        "uid": 519384,
        "name": "Link_Cut_Y",
        "ccfLevel": 0,
        "title": "[P4780] Phi \u306e \u53cd\u51fd\u6570"
    },
    {
        "content": "~~\u6211\u4eec\u5728\u5c0f\u5b66\u4e8c\u5e74\u7ea7\u5b66\u8fc7~~\n\n\u82e5 $\\gcd(a,b)=1$ \uff0c\u5219 $\\varphi(ab)=\\varphi(a) \\times \\varphi(b)$ \n\n\u82e5 $p$ \u4e3a\u8d28\u6570\uff0c\u5219 $\\varphi(p)=p-1$\n\n\uff08\u8bc1\u660e\u7565\uff09\n\n\u5219\u53ef\u8fdb\u4e00\u6b65\u5f97\u5230\uff1a\n\n> \u82e5 $p$ \u4e3a\u8d28\u6570\u4e14 $\\gcd(a,p)=1$ \uff0c\u5219 $\\varphi(ap)=\\varphi(a)\\times(p-1)$ \n\n\n\u8bbe $n=\\prod_{i=1}^sp_i^{c_i}$ \uff08\u552f\u4e00\u5206\u89e3\u5b9a\u7406\uff09\uff0c\u5219   $\\varphi(n)=n\\times\\prod_{i=1}^s\\frac{p_i-1}{p_i}$\n\n**\u8bc1\u660e\uff1a**\n$$\n\\begin{aligned}\n\\varphi(n)&=\\prod_{i=1}^s\\varphi(p_i^{c_i})\\\\\n&=\\prod_{i=1}^sp_i^{c_i-1}(p_i-1)\\\\\n&=\\prod_{i=1}^sp_i^{c_i}(1-\\frac 1 {p_i})\\\\\n&=n\\prod_{i=1}^s(1-\\frac 1 {p_i})\n\\end{aligned}\n$$\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe $n=(p_1-1)(p_2-1)\\cdots (p_k-1)$ \u3002\n\n\u5373\u628a $n$ \u5206\u89e3\u6210\u82e5\u5e72\u4e2a **$\u8d28\u6570-1$** \u7684\u4e58\u79ef\uff0c\u7528 dfs \u5b9e\u73b0\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u89c1\u4ee3\u7801\u6ce8\u91ca\u3002\n\n**\u4ee3\u7801\uff1a**\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define INF 2147483647\n#define MAXN (1<<16)|1\nusing namespace std;\nint n;\nll Ans=INF;\nint prime[MAXN];\nbool vis[MAXN];\nvoid getPrime(int m)//\u7b5b\u51fa<=m\u7684\u8d28\u6570\n{\n\tfor(int i=2;i<=m;i++)\n\t{\n\t\tif(vis[i]==0)prime[++prime[0]]=i;\n\t\tfor(int j=1;j<=prime[0]&&i*prime[j]<=m;j++)\n\t\t{\n\t\t\tvis[i*prime[j]]=1;\n\t\t\tif(i%prime[j]==0)break;\n\t\t}\n\t}\n}\nbool check(ll x)//\u5224\u65adx\u662f\u5426\u4e3a\u8d28\u6570\n{\n\tfor(int i=2;i*i<=x;i++)\n\tif(x%i==0)return 0;\n\treturn 1;\n}\nvoid dfs(int id,ll num,ll ans)\n//id\uff1a\u641c\u5230\u7b2cid\u4e2a\u8d28\u6570\n//num\uff1a\u8fd8\u9700\u5206\u89e3\u7684\u6570\n//ans\uff1a\u5f53\u524d\u7684x\n{\n\tif(num==1)//n\u5df2\u88ab\u5206\u89e3\u5b8c\n\t{\n\t\tAns=min(Ans,ans);//\u66f4\u65b0\u7b54\u6848\n\t\treturn;\n\t}\n\tif(check(num+1)){dfs(id,1,ans*(num+1));return;}\n   //\u5269\u4f59\u4e00\u4e2a\u5927\u8d28\u6570\uff0c\u5219\u76f4\u63a5\u5224\u6389\n\tfor(int i=id;i<=prime[0];i++)\n\t{\n\t\tif(num%(prime[i]-1)==0)//\u53ef\u4ee5\u5206\u89e3\n\t\t{\n\t\t\tll Newnum=num/(prime[i]-1),Newans=ans*prime[i];//\u89c1\u7b2c\u4e00\u4e2a\u63a8\u8bba\n\t\t\tdfs(i+1,Newnum,Newans);\n\t\t\twhile(Newnum%prime[i]==0)\n\t\t\t\tNewnum/=prime[i],Newans*=prime[i],dfs(i,Newnum,Newans);//\u641c\u7d22\u6307\u6570\n\t\t}\n\t}\n}\nint main()\n{\n\tgetPrime(MAXN);//\u8d28\u6570\u7b5b\u5230sqrt(2^31)\u5373\u53ef\n\tscanf(\"%d\",&n);\n\tdfs(1,n,1);\n\tif(Ans==INF)printf(\"-1\\n\");\n\telse printf(\"%lld\",Ans);\n\treturn 0;\n}\n```",
        "postTime": 1652100349,
        "uid": 476620,
        "name": "Guolar_JueMu",
        "ccfLevel": 5,
        "title": "P4780 Phi\u7684\u53cd\u51fd\u6570"
    },
    {
        "content": "\u03c6(x)\uff1a\u6b27\u62c9\u51fd\u6570\uff1b\n**{\u5728\u6570\u8bba\uff0c\u5bf9\u6b63\u6574\u6570n\uff0c\u6b27\u62c9\u51fd\u6570\u662f\u5c0f\u4e8en\u7684\u6b63\u6574\u6570\u4e2d\u4e0en\u4e92\u8d28\u7684\u6570\u7684\u6570\u76ee\uff08\u03c6(1)=1\uff09\u3002}**\n~~\u6709\u5174\u8da3\u7684\u540c\u978b\u53ef\u4ee5\u641c\u4e00\u4e0b~~\n\u5176\u4f59\u4e0d\u89e3\u91ca\u4e86\uff1b\n\u4ee3\u7801\u9644\u4e0a\uff1a\n \n ```cpp\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#define N 50000\nusing namespace std;\nint x,prm[50010];\nlong long ans;\nbool ext[50010];\nvoid get_prime(){\n    for (int i=2;i<=N;i++){\n        if (ext[i]==false) prm[++prm[0]]=i;\n        for (int j=1;j<=prm[0];j++){\n            if ((long long)i*prm[j]>N) break;\n            ext[i*prm[j]]=true;\n            if (i%prm[j]==0) break;\n        }\n    }\n}\nbool is_prime(long long x){\n    for (int i=2;i<=floor(sqrt(x));i++)\n      if (x%i==0) return false;\n    return true;\n}\nvoid search(int last,long long res,long long sum){\n    if (res==1){ans=min(ans,sum);return;}\n    if (res>floor(sqrt(x))&&is_prime(res+1)){\n        ans=min(ans,sum*(long long)(res+1));\n        return;//\u76f4\u63a5\u9000\u51fa\uff0c\u56e0\u4e3a\u540e\u9762\u5373\u4f7f\u641c\u7d22\u4e5f\u641c\u4e0d\u5230\u66f4\u4f18\u89e3\u4e86\n    }//\u6ce8\u610f\u5fc5\u987b\u5f53\u5269\u4e0b\u7684\u6570\u5927\u4e8esqrt(x)\u7684\u65f6\u5019\u624d\u80fd\u7b97\u6210\u5927\u8d28\u6570\u4e0d\u7136\u4f1a\u9519\n    for (int i=last+1;i<=prm[0];i++){\n        if (res%(prm[i]-1)==0){\n            int nwres=res/(prm[i]-1);\n            long long nwsum=sum*(long long)prm[i];\n            search(i,nwres,nwsum);\n            while (nwres%prm[i]==0){\n                nwres/=prm[i];\n                nwsum=nwsum*(long long)prm[i];\n                search(i,nwres,nwsum);//\u679a\u4e3e\u8d28\u56e0\u6570\u7684\u6b21\u6570\uff0c\u6bcf\u6b21\u90fd\u8981search\n            }\n        }\n        if (prm[i]>res) return;\n    }\n}\nint main()\n{\n    freopen(\"phi.in\",\"r\",stdin);\n    freopen(\"phi.out\",\"w\",stdout);\n    get_prime();\n    ans=2147483647;++ans;\n    scanf(\"%d\",&x);\n    search(0,x,1);\n    if (ans<=2147483647) printf(\"%d\\n\",ans);\n    else printf(\"-1\\n\");\n    return 0;\n}\n```",
        "postTime": 1532392536,
        "uid": 90642,
        "name": "liyifan200626",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4780 \u3010Phi\u7684\u53cd\u51fd\u6570\u3011"
    },
    {
        "content": "# P4780 Phi \u7684\u53cd\u51fd\u6570\nupdate 2023/2/17 \u4f5c\u8005\u7b14\u8bef\n## $\\varphi$ \u5b9a\u4e49\n\n $\\varphi(n)$  \u4ee3\u8868\u4ece $1-n$ \u6240\u6709\u4e0e $n$ \u4e92\u8d28\u7684\u6570\u7684\u4e2a\u6570\u3002\n\n## \u6c42$~\\varphi(n)~$\n\n### \u666e\u901a\u6c42\u6cd5\uff1a\n\n\u9996\u5148\u5c06 $n$ \u552f\u4e00\u5206\u89e3\u4e3a\uff1a\n\n$n=x_1^{p_1}\\times x_2^{p_2}\u2026\u2026{\\times} x_n^{p_n} $\n\n$\\varphi(n)=n{\\times} (1-\\frac1{x_1}){\\times} (1-\\frac1{x_2}){\\times} \u2026\u2026{\\times} (1-\\frac1{x_n})$\n\n\u8bc1\u660e\uff1a\n\n\u9996\u5148\u6211\u4eec\u8003\u8651\u5728\u6240\u6709\u6570\u4e2d\u6709 $\\frac{1}{x}$ \u7684\u6982\u7387\u4f1a\u53d6\u5230\u4e00\u4e2a\u6570\u662f $x$ \u7684\u500d\u6570\uff0c\u90a3\u4e48\u6709 $(1-\\frac{1}{x})$ \u7684\u6982\u7387\u4f1a\u53d6\u5230\u4e00\u4e2a\u6570\u4e0d\u662f $x$ \u7684\u500d\u6570\uff0c $1-n$ \u6709 $n$ \u4e2a\u6570\uff0c\u6211\u4eec\u8981\u627e\u5230 $1-n$ \u6240\u6709\u4e0e $n$ \u4e92\u8d28\u7684\u6570\uff0c\u4e5f\u5c31\u662f\u53bb\u4e00\u4e2a\u4e0d\u662f $n$ \u7684\u4efb\u610f\u4e00\u4e2a\u56e0\u6570 $(x_1,x_2,x_3\u2026\u2026x_n)$ \u7684\u500d\u6570\uff0c\u5c31\u5f97\u5230\u4ee5\u4e0a\u5f0f\u5b50\u3002\n\n## \u4e24\u4e2a\u5b9a\u7406\uff1a\n\n$$\n1.\\begin{cases}\n\\varphi(nm)=\\varphi(n){\\times} \\varphi(m)~~~~~\\gcd(n,m)=1\\\\\n\\varphi(nm)=\\varphi(n){\\times} m~~~~~~~~~~~\\gcd(n,m)=m\n\\end{cases}\n$$\n\n\u5b9a\u7406 1 \u8bc1\u660e\uff1a\n\n\u5728 $\\gcd(n,m)=1$ \u60c5\u51b5\u4e0b\u53ef\u4ee5\u63a8\u5bfc\uff1a\n\n$n=x_1^{p_1}{\\times} x_2^{p_2}\u2026\u2026{\\times} x_n^{p_n} $\n\n$m=y_1^{q_1}{\\times} y_2^{q_2}\u2026\u2026{\\times} y_n^{q_n} $\n\n$n{\\times} m=x_1^{p_1}{\\times} x_2^{p_2}\u2026\u2026{\\times} x_n^{p_n}{\\times} y_1^{q_1}{\\times} y_2^{q_2}\u2026\u2026{\\times} y_n^{q_n} $\n\n$\\varphi(nm)=n{\\times} m{\\times} (1-\\frac1{x_1})\u2026\u2026{\\times} (1-\\frac1{x_n}){\\times} (1-\\frac1{y_1})\u2026\u2026{\\times} (1-\\frac1{y_n})=\\varphi(n){\\times} \\varphi(m)~~~~~~~~~~~~gcd(n,m)=1$\n\n2. \u5728 $\\gcd(n,m)=m$ \u60c5\u51b5\u4e0b\n\n\u8003\u8651\u611f\u6027\u7406\u89e3\uff0c $1-n$ \u91cc\u9762\u6709 $\\varphi(n)$ \u4e2a\u4e0e $n$ \u4e92\u8d28\uff0c\u90a3\u4e48\u6269\u5927 $m$  \u500d\uff0c\u76f8\u5f53\u4e8e\u6709 $m$ \u4e2a $1-n$ \u5c31\u76f4\u63a5\u4e58(\u56e0\u4e3a\u6211\u4eec\u4fdd\u8bc1\u4e86 $\\gcd(n,m)=m$ \u4e5f\u5c31\u662f $n$ \u662f $m$ \u7684\u500d\u6570,\u6240\u4ee5\u4e0d\u5b58\u5728\u4e58\u4e0a $m$ \u540e\u591a\u51fa\u4e86\u4e0d\u5c5e\u4e8e $n$ \u7684\u56e0\u5b50)\u3002\n\n\u5b9a\u7406 2.$\\varphi(n)=n-1~~~~~~~~~~~~~n\\in prim$\uff08\u8fd9\u663e\u800c\u6613\u89c1\uff09\n\n### \u6211\u4eec\u9700\u8981\u6c42 Phi \u7684\u53cd\u51fd\u6570\u5c31\u8981\u5148\u6df1\u523b\u7406\u89e3\u4e0a\u8ff0\u5185\u5bb9\u7136\u540e\u8fdb\u884c\u8fd0\u7528\n\n\u53ef\u4ee5\u6839\u636e\u4e0a\u8ff0\u5b9a\u7406 1 \u5f97\u5230\uff1a\n\n\uff08\u5728\u8fd9\u91cc\u6211\u4eec\u7528\u5230\u4e86\u5b9a\u7406\u4e00\u7b2c\u4e00\u7c7b\u548c\u5b9a\u7406\u4e00\u7b2c\u4e8c\u7c7b\u7684\u4e00\u79cd\u7279\u6b8a\u60c5\u51b5   $~\\varphi(n{\\times} n)=\\varphi(n){\\times} n~$\n\n\u5f97\u51fa\n$~\\varphi(x)=\\varphi(a_1){\\times} a_1^{p_1-1}{\\times} \\varphi(a_2){\\times} a_2^{p_2-1}{\\times} ......\\varphi(a_n){\\times} a_n^{p_n-1}~~~~~~~~~~~~~~~~~~a_i\\in prime$\n\n\u7531\u5b9a\u7406\u4e8c\u5f97\uff1a $a_i$ \u90fd\u662f\u8d28\u6570\uff0c\u6240\u4ee5 $\\varphi(a_i)=a_i-1$\n\n\u6240\u6709\u8d28\u6570\u5206\u89e3\u51fa\u6765\u4e0d\u8d85\u8fc7 $10$ \u4e2a\uff0c\u56e0\u4e3a$2{\\times} 3{\\times} 5{\\times} 7{\\times} 11{\\times} 13{\\times} 17{\\times} 19{\\times} 23{\\times} 29=6469693230$\n\n$~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~2^{31}=2147483648$\n\n\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u66b4\u529b\u641c\u7d22\u3002\n\n\uff08\u5173\u4e8e\u5224\u65ad\u662f\u5426\u4e3a\u8d28\u6570\u7684\u51fd\u6570\uff09\n\n\u56e0\u4e3a\u6570\u636e\u8303\u56f4\u5728 $2^{31}$  ,\u5982\u679c\u6211\u4eec\u6c42 $2^{31}$  \u8303\u56f4\u5185\u7684\u8d28\u6570\uff0c\u76f4\u63a5\u7206\u70b8\uff0c\n\n\u5176\u5b9e\u6211\u4eec\u53ea\u9700\u8981\u627e\u51fa $2^{16}$ \u7684\u8d28\u6570\uff0c\u6bcf\u6b21\u5224\u65ad\u4e00\u4e0b\u5f53\u524d\u8fd9\u4e2a\u6570 $now+1$ (\u4e5f\u5c31\u662f $revphi(now)$ \u662f\u4e0d\u662f\u8d28\u6570\n\n\u4f8b\u5982 $\\varphi(x)=n=\\varphi(3){\\times} \\varphi(10000000007)$\u3002\n\n\u7b2c\u4e00\u6b21\u627e\u5230 $\\varphi(3)$ \u5904\u7406\u4ee5\u540e\uff0c\u7531\u4e8e\u6211\u4eec\u53ea\u627e\u4e86 $2^{16}$ \u7684\u8d28\u6570\uff0c\u6211\u4eec\u627e\u4e0d\u5230 $\\varphi(1000000007)$ \u5728\u91cc\u9762\uff0c\u6211\u4eec\u9700\u8981\u6bcf\u6b21\u5224\u65ad\u5f53\u524d\u8fd9\u662f\u6570\u662f\u4e0d\u662f\u8d28\u6570\u3002\n\n\u5177\u4f53\u7684\uff1a\n\n\u7b2c\u4e00\u6b21\u5224\u65ad $\\varphi(3){\\times} \\varphi(1000000007)$ \u663e\u7136\u4e0d\u662f\u8d28\u6570\u3002\n\n\u9664\u4ee5 $\\varphi(3)$ \u540e\u53d8\u6210\u4e86 $\\varphi(1000000007)$  \u4e5f\u5c31\u662f $now=1e9+6$\u3002\n\n\u7b2c\u4e8c\u6b21\u5224\u65ad $(now+1)\\in prime$  \u90a3\u4e48\u76f4\u63a5\u628a\u8d28\u6570\u7ed9\u9664\u4e86\uff0c\u76f4\u63a5\u7ed3\u675f\u4e86\u3002\n\n### \u90a3\u4e48\u600e\u4e48\u5f97\u51fa\u7b54\u6848\u5462\n\n$$\n1.\\begin{cases}\n\\varphi(nm)=\\varphi(n){\\times} \\varphi(m)~~~~~\\gcd(n,m)=1\\\\\n\\varphi(nm)=\\varphi(n){\\times} m~~~~~~~~~~~\\gcd(n,m)=m\n\\end{cases}\n$$\n\n$\\varphi(x)=\\varphi(a_1){\\times} a_1^{p_1-1}{\\times} \\varphi(a_2){\\times} a_2^{p_2-1}{\\times} ......\\varphi(a_n){\\times} a_n^{p_n-1}~~~~~~~~~~~~~~~~~~a_i\\in prime$\n\n\u6211\u4eec\u518d\u6765\u91cd\u65b0\u770b\u770b\u8fd9\u4e9b\u5f0f\u5b50\uff1a\n\n\u53ef\u4ee5\u770b\u51fa\u6700\u540e\u7684 $ans=a_1{\\times} a_1^{p_1-1}{\\times} a_2{\\times} a_2^{p_2-1}{\\times} ......{\\times} a_n{\\times} a_n^{p_n-1}~$\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h> \n#define ll long long \nusing namespace std;\nconst int N=1e7+10;\nint vis[N],s[30],tot=0,n,cnt=0;\nll ans=1e17+10,prim[N];\nvoid shai(int x){\n    for(int i=2;i<=x;i++){\n        if(!vis[i]){\n            prim[++tot]=i;\n        }\n        for(int j=1;j<=tot&&i*prim[j]<=x;j++){\n            vis[prim[j]*i]=1;\n            if(!i%prim[j]){\n                break;\n            }\n        }\n    }    \n}//\u8d28\u6570\u7b5b\nbool is_p(ll x){\n    for(int i=2;i* i<=x;i++){\n        if(x%i==0){\n            //cout<<x<<i<<endl;\n            return 0;\n        }\n    }\n    return 1;\n}//\u5224\u65ad\u662f\u5426\u4e3a\u8d28\u6570\nvoid dfs(int now,int id,ll rev){//id\u4ee3\u8868\u5f53\u524d\u5e72\u8fc7\u7684\u8d28\u6570\uff0c\u662f\u4e2a\u4f18\u5316\n    if(now>=ans) return ;//\u7b80\u5355\u4f18\u5316\n    if(now==1){\n        ans=min(rev,ans);\n        return ;\n    }\n    if(is_p(now+1)) dfs(1,id+1,rev*(now+1));\n    for(int i=id;i<=tot;i++){\n        if(now%(prim[i]-1)==0){\n            int a=now;\n            ll b=rev;\n            a/=(prim[i]-1);b*=prim[i]; //\u5b9a\u74061\u7684\u60c5\u51b51\n            dfs(a,i+1,b);\n            while(a%prim[i]==0){//\u5b9a\u74061\u7684\u60c5\u51b52\n                a/=prim[i];b*=prim[i]; \n                dfs(a,i,b);\n            } \n        }\n    }\n}\n\nint main(){\n    scanf(\"%d\",&n);\n    shai(sqrt(n)+1);    \n    dfs(n,1,1);\n    if(ans==1e17+10){//\u65e0\u89e3\u6216\u8005\u592a\u5927\u4e86\n        printf(\"-1\");\n    }else printf(\"%lld\",ans);\n    return 0;\n}\n//2147483647\n```",
        "postTime": 1673780152,
        "uid": 251449,
        "name": "He_Zi",
        "ccfLevel": 4,
        "title": "P4780 Phi\u7684\u53cd\u51fd\u6570"
    },
    {
        "content": "# \u9898\u76ee\u5927\u610f\uff1a\n\n\u4f20\u9001\u95e8\uff1a[P4780 Phi\u7684\u53cd\u51fd\u6570](https://www.luogu.com.cn/problem/P4780)\n\n\u8fd9\u9053\u9898\u5c31\u662f\u8ba9\u4f60\u53bb\u6c42\u4e00\u4e2a**\u6700\u5c0f**\u7684\u6b63\u6574\u6570 $x$\uff0c\u4f7f\u5f97 $\\varphi(x)=n$\u3002\n\n# \u5177\u4f53\u601d\u8def\uff1a\n\n\u5728\u90a3\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u6765\u8bb2\u4e00\u4e9b\u6b27\u62c9\u51fd\u6570\u7684\u6027\u8d28\u3002\n\n### \u6027\u8d28\uff1a\n\n- \u82e5 $n\\in prime$, \u5219\u6709\uff1a$\\varphi(n)=n-1$\u3002\n\n- \u6b27\u62c9\u51fd\u6570\u4e3a\u79ef\u6027\u51fd\u6570\uff0c\u6709\uff1a$\\varphi(ab)=\\varphi(a)\\varphi(b)$\u3002\n\n- \u7531\u552f\u4e00\u5206\u89e3\u5b9a\u7406\uff0c\u8bbe $n=\\prod_{i=1}^sp_i^{k_i}$\uff0c\u5176\u4e2d\uff0c$p_i\\in prime$\uff0c\u6709\uff1a$\\varphi(n)=n\\times\\prod_{i=1}^s\\dfrac{p_i-1}{p_i}$\u3002\n\n\u8bc1\u660e\uff1a\u7565\uff0c\u4ee5\u4e0a\u6027\u8d28\u8bc1\u660e\u53ef\u4ee5\u53bb bdfs \u4e00\u4e0b\u3002\uff08~~\u771f\u7684\u4e0d\u662f\u6211\u4e0d\u4f1a\u554a~~\uff09\n\n### \u601d\u8def\uff1a\n\n\u9996\u5148\uff0c\u6211\u4eec\u5bf9 $x$ \u5206\u89e3\u8d28\u56e0\u6570\uff0c\u8bbe $x=p_1^{c_1}p_2^{c_2}\\dots p_k^{c_k}$\uff0c\u5373 $x=\\prod_{i=1}^s p_i^{c_i}$\u3002\n\n\u7531\u4e8e $\\varphi(x)$ \u662f\u79ef\u6027\u51fd\u6570\uff0c\u56e0\u6b64 $\\varphi(x)=\\varphi(p_1^{c_1})\\varphi(p_2^{c_2})\\dots \\varphi(p_k^{c_k})$\uff0c\u5373 $\\varphi(x)=\\prod_{i=1}^s\\varphi(p_i^{c_i})$\u3002\n\n\u4f46\u662f\u9898\u76ee\u6c42\u7684\u662f $x$ \u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3\uff0c\u90a3\u600e\u6837\u7684 $x$ \u624d\u80fd\u4fdd\u8bc1\u662f\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u5462\uff1f\n\n\u6211\u4eec\u4ed4\u7ec6\u89c2\u5bdf\u5f0f\u5b50\uff1a\n$$\\varphi(n)=n\\times\\prod_{i=1}^s\\dfrac{p_i-1}{p_i}$$\n\u4e0a\u5f0f\u4e2d $\\varphi(n)$ \u7684\u503c\u4e0e $p_i$ \u7684\u6307\u6570 $c_i$ \u65e0\u5173\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a\u6570\u7684\u6b27\u62c9\u51fd\u6570\u503c\u4e0e\u8d28\u56e0\u5b50\u7684\u6307\u6570\u65e0\u5173\u3002\n\n\u90a3\u5c31\u5f88\u597d\u6c42\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u4e86\uff0c\u6211\u4eec\u53ea\u8981\u4ee4 $x$ \u7684\u6240\u6709\u8d28\u56e0\u5b50\u6307\u6570\u90fd\u4e3a $1$,\u5373 $x=\\prod_{i=1}^s p_i$\u3002\n\n\u56e0\u6b64\uff0c\u539f\u5f0f\u5316\u4e3a $n=\\prod_{i=1}^s \\varphi(p_i)$\uff0c\u5176\u4e2d $p_i\\in prime$\u3002\n\n\u90a3\u6211\u4eec\u53c8\u77e5\u9053\u82e5 $n\\in prime$\uff0c\u5219\u6709 $\\varphi(n)=n-1$\uff0c\n\n\u6240\u4ee5\uff0c\u539f\u5f0f\u53c8\u53ef\u4ee5\u5316\u7b80\u4e3a\uff1a$n=\\prod_{i=1}^s (p_i-1)$\u3002\n\n\u90a3\u63a5\u4e0b\u6765\u7684\u601d\u8def\u90fd\u5f88\u5bb9\u6613\u60f3\u5230\u4e86\uff0c\u6211\u4eec\u7528\u7ebf\u6027\u7b5b\u5148\u5c06\u4e00\u90e8\u5206\u7684\u8d28\u6570\u627e\u51fa\u6765\uff0c\u7136\u540e\u76f4\u63a5 dfs \u6765\u5c06 $n$ \u5206\u89e3\u4e3a\u51e0\u4e2a\u8d28\u6570 $-1$ \u7684\u4e58\u79ef\u3002\n\n\u4e0d\u8fc7\uff0c\u8fd9\u9053\u9898\u9700\u8981\u4e00\u4e2a\u526a\u679d\uff0c\u5c31\u662f\u5982\u679c\u4f60\u5f53\u524d\u8981\u5206\u89e3\u7684 $n$ \u662f\u4e00\u4e2a\u5f88\u5927\u7684\u8d28\u6570\uff0c\u4f60\u7ebf\u6027\u7b5b\u7684\u65f6\u5019\u6ca1\u628a\u5b83\u627e\u51fa\u6765\uff0c\u7136\u540e\u5206\u89e3\u7684\u65f6\u5019\u4e00\u76f4\u8dd1\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4 TLE\uff0c\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5728\u5206\u89e3 $n$ \u4e4b\u524d\uff0c\u5c31\u53ef\u4ee5\u5224\u65ad $n$ \u662f\u4e0d\u662f\u4e00\u4e2a\u8d28\u6570\uff0c\u5982\u679c\u662f\uff0c\u76f4\u63a5 dfs\uff0c\u53ef\u4ee5\u7701\u4e0b\u4e00\u70b9\u65f6\u95f4\u3002\n\n\u7136\u540e\u4f60\u5224\u65ad\u8d28\u6570\u65f6\uff0c\u53ef\u4ee5\u91c7\u7528\u6700\u4f20\u7edf\u7684\u8bd5\u9664\u6cd5\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u50cf\u6211\u4e00\u6837\u7528\u65b0\u5b66\u7684 Miller-Robin \u7b97\u6cd5\uff0c\u53ef\u80fd\u53ef\u4ee5\u5feb\u4e00\u70b9\uff0c\u4e0d\u8fc7\u6211\u4e5f\u8bd5\u4e86\u4e00\u4e0b\u4e24\u79cd\u65b9\u6cd5\uff0c\u90fd\u662f\u53ef\u4ee5\u8fc7\u7684\u3002\n\n\u6700\u540e\u7ed9\u4e00\u70b9\u5c0f Tips:\n\n- \u6ca1\u4e8b\u4e0d\u8981\u5168\u90e8\u53d8\u91cf\u90fd\u5f00 long long\u3002\n\n- \u7528 Miller-Robin \u65f6\uff0c\u5e38\u6570\u8bb0\u5f97\u5f00\u5c0f\u4e00\u70b9\uff0c\u5f00 $20$ \u5df2\u7ecf\u53ef\u4ee5\u5f97\u51fa\u6b63\u786e\u7b54\u6848\u4e86\uff0c\u5f00 $50$ \u76f4\u63a5 TLE \u4e86\uff0c\u66f4\u522b\u8bf4 $114514$ \u4e86\uff01\n\n# AC Code\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\nconst int N=1e5;\nLL v[N+10],prime[N+10],pr,ans=0x7fffffff;\ninline int read()//\u5feb\u8bfb \n{\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'&&ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9')x=x*10+ch-'0',ch=getchar();\n\treturn x*f;\n}\ninline void write(int s)//\u5feb\u8f93 \n{\n    int n=0,buf[15];\n    if(s<0) putchar('-'),s=-s;\n    do buf[n++]=s%10;while(s/=10);\n    while(n--) putchar(buf[n]+'0');\n}\nLL witness(LL a,int n)\n{\n\tLL ans=1,t=n-1,x;\n\twhile(t)\n\t{\n\t\tif(t&1)ans=ans*a%n;\n\t\tx=a;a=a*a%n;\n\t\tif(a==1&&x!=1&&x!=(n-1))return 1;\n\t\tt>>=1;\n\t}\n\treturn (ans==1)?0:1;\n}\nint Miller_Robin(LL n,int s)\n{\n\tif(n==2)return 1;\n\tif(n<2||!(n&1))return 0;\n\tLL a;\n\tfor(int i=0;i<s;++i)\n\t{\n\t\ta=rand()*(n-2)/RAND_MAX+1;\n\t\tif(witness(a,n))return 0;\n\t}\n\treturn 1;\n}//\u4ee5\u4e0a\u90e8\u5206\u4e3aMiller Robin\u7b97\u6cd5,\u53ef\u4ee5bdfs\u5b66\u4e60\u4e00\u4e0b \nvoid init()//\u7ebf\u6027\u7b5b,\u522b\u7b5b\u592a\u5927\u7684\u8d28\u6570,\u53ef\u80fd\u4f1aTLE \n{\n\tmemset(v,0,sizeof(v));pr=0;\n\tfor(int i=2;i<=N;++i)\n\t{\n\t\tif(!v[i])prime[++pr]=i;\n\t\tfor(int j=1;j<=pr&&i*prime[j]<=N;++j)\n\t\t{\n\t\t\tv[i*prime[j]]=1;\n\t\t\tif(i%prime[j]==0)break;\n\t\t}\n\t}\n}\nvoid dfs(int k,LL n,LL x)\n{\n\tif(n==1){ans=min(ans,x);return;}\n\tif(Miller_Robin(n+1,20)){dfs(114514,1,x*(n+1));return;}//\u526a\u679d \n\tfor(int i=k;i<=pr;++i)//\u5206\u89e3n \n\t{\n\t\tif(n%(prime[i]-1)==0)\n\t\t{\n\t\t\tdfs(i+1,n/(prime[i]-1),x*prime[i]);\n\t\t\tLL nn=n/(prime[i]-1),xx=x*prime[i];\n\t\t\twhile(nn%prime[i]==0){nn=nn/prime[i];xx=xx*prime[i];dfs(i,nn,xx);}\n\t\t}\n\t}\n}\nint main()\n{\n\tinit();//\u9884\u5904\u7406 \n\tint n;n=read();//\u8f93\u5165 \n\tdfs(1,n,1);\n\twrite((ans==0x7fffffff)?-1:ans);//\u5982\u679cans\u7684\u503c\u6ca1\u6709\u88ab\u4fee\u6539\u5230,\u76f4\u63a5\u8f93\u51fa-1,\u5426\u5219\u8f93\u51faans \n\treturn 0;//\u5b8c\u7ed3\u6492\u82b1\n}\n```\n",
        "postTime": 1665544880,
        "uid": 654281,
        "name": "reclusive",
        "ccfLevel": 5,
        "title": "\u9898\u89e3P4780"
    },
    {
        "content": "\u6839\u636e\u6b27\u62c9\u51fd\u6570\u7684\u5b9a\u4e49\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\narcphi(n)=min{x|phi(x)=n};\n\u5728\u4e4b\u6709\u6b27\u62c9\u516c\u5f0f x\u03c6(p) mod p=1\uff0c \n\u6240\u4ee5x\u2217x\u03c6(p)\u22121 mod p=1 \uff0c\n\u8fd9\u6837x\u03c6(p)\u22121\u5c31\u662fx\u5728mod p \u610f\u4e49\u4e0b\u7684\u9006\u5143\uff0c\u4e0d\u8fc7\u82e5\u53bb\u67e5\u4e00\u67e5\u6b27\u62c9\u51fd\u6570\u8868\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5728\u503c\u57df\u5185\u7684x\uff0c\u4e0d\u53ea\u6709\u552f\u4e00\u7684\u5728\u5b9a\u4e49\u57df\u5185\u7684n\u4e0e\u4e4b\u5bf9\u5e94\uff0c\u6240\u4ee5\u5982\u679c\u7528\u679a\u4e3e\u4f1a\u5f88\u8981\u547d\uff0c\u5f88\u53ef\u80fd\u4f1aTLE\u3002\u800c\u4e14\u6837\u4f8b\u6570\u636e\u91cc\u8bf4\u4e86n<=2^31\uff01\uff01\uff01\uff01\u80af\u5b9a\u7ed3\u679c\u8981\u6bd4\u8fd9\u4e2a\u6570\u5927\u5f88\u591a\uff01\uff01\uff01~~\uff08\u9ad8\u7cbe\u5ea6\uff1f\uff09~~\nSO\uff0c\u82e5\u6211\u4eec\u8981\u6c42\u03c6(x)\uff0c\u53ef\u4ee5\u5148\u5c06\u5176\u5206\u89e3\u6210\u220f(ai^Pi)\u7684\u5f62\u5f0f\uff0c\u5176\u4e2da\u662f\u7d20\u6570\u3002 \n\u7136\u540e\u53ef\u4ee5\u63a8\u5bfc\u51fa\u516c\u5f0f\u03c6(x)=\u220f(ai&Pi\u2212ai^Pi\u22121) \n\u7136\u540e\u8fd9\u4e2a\u53ef\u4ee5\u5b9e\u73b0\u4e3a\u03c6(x)=x/\u220f(ai\u22121) \n\u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u221a\u65f6\u95f4\u5185\u51fa\u89e3\u4e86\u3002\u5e9f\u8bdd\u4e0d\u591a\uff0c\u8d34\u4e0a\u4ee3\u7801\uff1a\n```\n#include\"bits/stdc++.h\"\n#define last last_\n \nusing namespace std;\ntypedef long long LL;//\u672c\u4eba\u61d2\u3002\u3002\u3002\n \nconst int N=100005;//\u672c\u4eba\u61d2\u4e0d\u89e3\u91ca\u3002\u3002\u3002\n \nint k,pri[N],pcnt,S,len,num[N>>4];\nbool fl[N];\nset<LL> s;\nset<LL>::iterator it;//\u7528\u96c6\u5408\u505a\u4f1a\u65b9\u4fbf\u4e00\u70b9\uff0c\u4e0d\u7528\u6392\u5e8f\u548c\u53bb\u91cd\u4e5f\u662f\u5f88\u597d\u7684\u3002\u3002\u3002\n \nvoid push(LL x){\n\ts.insert(x);\n\tif(s.size()<=k)return;\n\ts.erase(--(it=s.end()));\n}\n \nbool go(LL x){\n\tif(s.size()<k)return true;\n\treturn x<*(--(it=s.end()));\n}\n \nconst int jp[]={2,3,5,7,11,13,17};\n \nLL mult(LL x,LL y,LL z){\n\treturn ((x*y-(LL)((long double)x*y/z+0.5)*z)%z+z)%z;\n}\n \nLL power(LL a,LL t,LL P){\n\tLL r=1;\n\twhile(t){\n\t\tif(t&1)r=mult(r,a,P);\n\t\ta=mult(a,a,P);t>>=1;\n\t}\n\treturn r;\n}\n \nbool Miller_Rabin(LL n){\n\tif(n==2||n==3||n==5||n==7||n==13||n==17||n==19||n==23||n==29||n==31)return true;\n\tif(n%2&&n%3&&n%5&&n%7&&n%11&&n%13&&n%17&&n%19&&n%23&&n%29&&n%31){\n\t\tLL r=n-1;\n\t\tint t=0;\n\t\twhile(!(r&1))r>>=1,t++;\n\t\tfor(int i=0;i<7;i++){\n\t\t\tLL x=power(jp[i],r,n),y;\n\t\t\tfor(int j=0;j<t;j++){\n\t\t\t\ty=mult(x,x,n);\n\t\t\t\tif(y==1&&x!=1&&x!=n-1)return false;\n\t\t\t\tx=y;\n\t\t\t}\n\t\t\tif(x!=1)return false;\n\t\t}\n\t\treturn true;\n\t}\n\treturn false;\n}\n \nvoid dfs(int p,LL n,LL m){\n\tif(n==1){\n\t\tif(p)push(m*2);\n\t\tpush(m);\n\t\treturn;\n\t}\n\tif((double)(n+1)*m>1E17)return;\n\tif(!go((n+1)*m))return;\n\tif(p==0){\n\t\tif(n>=S&&Miller_Rabin(n+1))push(m*(n+1));\n\t\tif(n==1)push(m);\n\t\treturn;\n\t}\n\tdfs(p-1,n,m);\n\tif(n%(num[p]-1)==0){\n\t\tn=n/(num[p]-1)*num[p];\n\t\twhile(n%num[p]==0){\n\t\t\tn/=num[p],m*=num[p];\n\t\t\tdfs(p-1,n,m);\n\t\t}\n\t}\n}\n \nLL n;\n \nint main(){\n\tcin>>n; k=1;\n\tS=3*(int)sqrt(n+.1);\n\tfor(int i=2;i<=S;i++){\n\t\tif(!fl[i]){\n\t\t\tpri[++pcnt]=i;\n\t\t\tif(n%(i-1)==0)num[++len]=i;\n\t\t}\n\t\tfor(int j=1;i*pri[j]<=S;j++){\n\t\t\tfl[i*pri[j]]=1;\n\t\t\tif(i%pri[j]==0)break;\n\t\t}\n\t}\n\tdfs(len,n,1);\n\tif(s.empty()||*s.begin()>0x7FFFFFFF) puts(\"-1\");\n\telse printf(\"%lld\\n\",*s.begin());\n\treturn 0;\n}\n\n```",
        "postTime": 1532393347,
        "uid": 111748,
        "name": "Anvet",
        "ccfLevel": 0,
        "title": "Phi\u7684\u53cd\u51fd\u6570-\u9898\u89e3"
    },
    {
        "content": "\u6b27\u62c9\u51fd\u6570\u5927\u5bb6\u80af\u5b9a\u90fd\u4f1a\u5427~~\u4e0d\u4f1a\u8fd8\u662f\u6d17\u6d17\u7761\u5427~~\u3002\n\n\u9996\u5148\u6211\u4eec\u8bbe\u7b54\u6848 $ans$=$p_1$^$a_1$ \u00d7 $p_2$^$a_2$ \u00d7 \u2026\u2026 \u00d7 $p_m$^$a_m$ \uff0c\u5176\u4e2d $p_i$ \u662f\u7d20\u6570\u3002\n\n\u4e14\u5bf9\u4e8e\u4efb\u610f $i$ \u548c $j$ \u90fd\u6709 $pi\u2260pj$\u3002\n\n\u80fd\u591f\u53ef\u4ee5\u770b\u51fa $n$=$p_1$^$(a_1-1)$ \u00d7 $p_2$^$(a_2-1)$ \u00d7 \u2026\u2026 \u00d7 $p_m$^$(a_m-1)$\u00d7$(p_1-1)$\u00d7$(p_2-1)$\u00d7\u2026\u2026\u00d7$(p_m-1)$\n\n\u90a3\u4e48\u76f4\u63a5 $DFS$ \u4e86\u3002\u66b4\u529b $(p_1-1)$ \u00d7 $(p_2-1$) \u00d7 \u2026\u2026 \u00d7$(p_m-1)$,\u7136\u540e\u6a21$n$\u540e\u9a8c\u8bc1\u662f\u5426\u662f\u8fd9\u4e9b\u6570\u7684\u500d\u6570\u5373\u53ef\u3002\n\n\u6240\u4ee5\u6211\u4eec\u9884\u5904\u7406\u51fa $1-sqrt(n)$ \u7684\u6240\u6709\u7d20\u6570\uff0c\u56e0\u4e3a\u6211\u4eec\u53ea\u4f1a\u7528\u5230\u8fd9\u4e9b\u7d20\u6570\u3002\u5982\u679c\u6709$pk$\u5927\u4e8e\u8fd9\u4e2a\u8303\u56f4\uff0c\u663e\u7136\u4e0d\u5b58\u5728 $t\u2260k$ \u5e76\u4e14 $pk$ \u4e5f\u4e0d\u7b26\u9898\u610f\u3002\n\n\u6240\u4ee5\u5bf9\u8fd9\u79cd\u60c5\u51b5\u7279\u5224\u4e00\u4e0b\uff0c\u53ea\u6c42\u51fa\u8fd9\u6837\u7684\u6570\u770b\u770b\u662f\u5426\u6b63\u786e\u5373\u53ef\u3002\n\n\u8fd9\u6837\u7a0b\u5e8f\u7684 $DFS$ \u5c31\u5206\u6210\u4e86\u4e09\u4e2a\u6d41\u7a0b\uff1a \u76f4\u63a5\u7ed3\u5c3e\uff0c\u4e58\u4e0a\u4e00\u4e2a\u5927\u7d20\u6570\u540e\u7ed3\u5c3e\uff0c\u548c\u7ee7\u7eed\u6269\u5c55\u8fd9\u4e09\u79cd\u3002\n   \n\u5b8c\u7ed3\u6492\u82b1\u3002\n\n\u603c\u9898\u9762\uff1a$\u03c6\uff08x\uff09$\u54ea\u6765\u7684\u53cd\u51fd\u6570\uff0c\u5176\u5b9a\u4e49\u57df\u5185\u90fd\u4e0d\u5177\u5907\u4e25\u683c\u7684\u5355\u8c03\u6027\u3002",
        "postTime": 1589195067,
        "uid": 327534,
        "name": "Siyunshan",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4780 \u3010Phi\u7684\u53cd\u51fd\u6570\u3011"
    },
    {
        "content": "[P4780 Phi\u7684\u53cd\u51fd\u6570](https://www.luogu.com.cn/problem/P4780)\n\n\u5728\u505a\u672c\u9898\u4e4b\u524d\u5148\u56de\u987e\u4e00\u4e9b\u6b27\u62c9\u51fd\u6570\u7684\u6027\u8d28\uff1a\n\n1. \u5982\u679c\u6709 $\\gcd(a,b)=1$\uff0c\u90a3\u4e48 $\\varphi(a\\times{b})=\\varphi(a)\\times\\varphi(b)$\n\n2. $n=\\sum_{d|n}\\varphi(d)$\n\n3. \u7531\u552f\u4e00\u5206\u89e3\u5b9a\u7406\uff0c $\\varphi(n)=n\\times\\prod_{i=1}^s\\frac{p_i-1}{p_i}$\n\n4. \u5bf9\u4e8e\u4e00\u4e2a\u7d20\u6570\uff0c\u6709 $\\varphi(n)=n-1$\n\n\u4e0b\u9762\u662f\u5bf9\u4e8e\u5355\u4e00\u7684\u6570\u503c\u7684\u6b27\u62c9\u51fd\u6570\u6c42\u89e3\uff1a\n\n```cpp\ninline int getphi(int n)\n{\n\tint ans=n;\n\tfor(int i=2;i*i<=n;i++)\n\t{\n\t\tif(n%i==0)\n\t\t{\n\t\t\tans=ans/i*(i-1);\n\t\t\tfor(;n%i==0;n/=i);\n\t\t}\n\t}\n\tif(n>1) ans=ans/n*(n-1);\n\treturn ans;\n}\n\n```\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u7d20\u6570\uff0c\u4e0d\u7ba1\u5b83\u5728\u8fd9\u4e2a\u6570\u88ab\u5206\u89e3\u540e\u51fa\u73b0\u4e86\u51e0\u6b21\uff0c\u5b83\u5bf9\u6574\u4e2a\u6570\u7684\u6b27\u62c9\u51fd\u6570\u7684\u53d6\u503c\u7684\u8d21\u732e\u90fd\u53ea\u4f1a\u88ab\u8ba1\u5165\u4e00\u6b21\uff08\u8fd9\u5728\u6b27\u62c9\u51fd\u6570\u7684\u7b2c\u4e09\u6761\u6027\u8d28\u4e2d\u53ef\u4ee5\u770b\u51fa\u6765\uff09\u3002\n\n\u90a3\u4e48\u53cd\u8fc7\u6765\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u6b27\u62c9\u51fd\u6570\u503c\u8981\u6c42\u51fa\u6700\u5c0f\u7684\u6570\u65f6\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5206\u89e3\u540e\u7684\u7d20\u6570\u6211\u4eec\u90fd\u53ea\u51fa\u73b0\u4e00\u6b21\u5fc5\u7136\u662f\u6700\u4f18\u7684\u3002\n\n\u8003\u8651\u5bf9\u6570\u8fdb\u884c\u5206\u89e3\uff0c\u53ef\u4ee5\u91c7\u53d6\u8bd5\u9664\u6cd5\uff0c\u6ce8\u610f\u6211\u4eec\u5206\u89e3\u7684\u662f\u6b27\u62c9\u51fd\u6570\u503c\uff0c\u771f\u5b9e\u7684\u7d20\u6570\u503c\u5e94\u5f53\u662f\u5206\u89e3\u7684\u6570\u52a0\u4e0a\u4e00\uff0c\u5224\u65ad\u65f6\u53ef\u4ee5\u91c7\u7528\u7c73\u52d2\u62c9\u5bbe\u7b97\u6cd5\u3002\n\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <vector>\n#include <queue>\n#include <ctime>\n#include <algorithm>\nusing namespace std;\ntypedef long long ull;\n\ninline ull read()\n{\n\tull a=0,f=1;\n\tchar ch=getchar();\n\tfor(;!isdigit(ch);ch=getchar())\n\t\tif(ch=='-')f=-1;\n\tfor(;isdigit(ch);ch=getchar())\n\t\ta=(a<<3)+(a<<1)+ch-'0';\n\treturn a*f;\n}\n\nconst ull INF=1e18;\nconst int N=1e6;\null ans=INF,n,st[N]={-1},top;\n\ninline ull qmul(ull a,ull b,ull p)\n{\n\ta%=p;b%=p;\n\treturn (a*b-(ull)((long double)a/p*b)*p+p)%p;\n}\n\ninline ull qpow(ull a,ull n,ull p)\n{\n\tull ans=1;\n\tfor(;n;n>>=1)\n\t{\n\t\tif(n&1) ans=ans*a%p;\n\t\ta=a*a%p;\n\t}\n\treturn ans;\n}\n\ninline bool miller_rabin(ull n)\n{\n\tif(n==2) return true;\n\tif(n<2||!(n&1)) return false;\n\tull m=n-1,k=0;\n\tfor(;!(m&1);k++,m>>=1);\n\tfor(int i=1;i<=20;i++)\n\t{\n\t\tull a=rand()%(n-1)+1;\n\t\tull x=qpow(a,m,n),y;\n\t\tfor(int j=1;j<=k;j++)\n\t\t{\n\t\t\ty=qmul(x,x,n);\n\t\t\tif(y==1&&x!=1&&x!=n-1)\n\t\t\t\treturn false;\n\t\t\tx=y;\n\t\t}\n\t\tif(y!=1) return false;\n\t}\n\treturn true;\n}\n\nvoid dfs(int now,ull x,ull tmp)\n{\n\tif(tmp>=ans) return;\n\tif(x==1){ans=tmp;return;}\n\tif(miller_rabin(x+1))\n\t\tdfs(now+1,1,tmp*(x+1));\n\tfor(int i=2;i*i<=x;i++)\n\t\tif(x%i==0&&i>st[now-1]&&miller_rabin(i+1))\n\t\t\tst[now]=i,dfs(now+1,x/i,tmp*(i+1));\n\treturn;\n}\n\nsigned main()\n{\n\tn=read();\n\tdfs(1,n,1);\n\tif(ans>2147483648ull)puts(\"-1\");\n\telse printf(\"%llu\\n\",ans);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1618031153,
        "uid": 213841,
        "name": "Steadywelkin",
        "ccfLevel": 7,
        "title": "P4780 Phi\u7684\u53cd\u51fd\u6570 \u9898\u89e3"
    }
]
[
    {
        "content": "[~~\u542c\u8bf4\u6709~~\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.luogu.com.cn/blog/352464/solution-p2557)\n\n\u9898\u76ee\u5927\u610f\n---\n\u8f93\u5165 $a,k$ \uff0c\u8f93\u51fa $a^k$ \u7684\u7ea6\u6570\u548c\u3002\n\n\u9898\u76ee\u601d\u8def\n---\n\u8981\u5207\u6389\u8fd9\u9053\u9898\uff0c\u4f60\u9996\u5148\u9700\u8981\u77e5\u9053\uff0c**\u7ea6\u6570\u548c\u5b9a\u7406**\u662f\u4ec0\u4e48\u3002\n\n#### \u7ea6\u6570\u548c\u5b9a\u7406\uff1a\n\n\u542c\u8d77\u6765\u5f88\u9ad8\u5927\u5c1a\uff0c\u5176\u5b9e\u5f88\u7b80\u5355\uff1a\n\n\u5bf9\u4e8e\u4e00\u4e2a\u5927\u4e8e $1$ \u6b63\u6574\u6570 $n$ \u53ef\u4ee5\u5206\u89e3\u8d28\u56e0\u6570\uff1a\n\n$$n=p1^{a1}*p2^{a2}*p3^{a3}*\u2026*pk^{ak}$$\n\n\u57fa\u672c\u7684\u5206\u89e3\u8d28\u56e0\u6570\u7684\u5b9a\u4e49\uff0c\u4e0d\u4f1a\u7684\u8bdd\u81ea\u5df1[\u770b\u8fd9\u91cc](https://baike.baidu.com/item/%E5%88%86%E8%A7%A3%E8%B4%A8%E5%9B%A0%E6%95%B0/2253749?fr=aladdin)\u3002\n\n\u4e4b\u540e\u5462\uff0c $n$ \u7684 $(a_1+1)(a_2+1)(a_3+1)\u2026(a_k+1)$ \u4e2a\u6b63\u7ea6\u6570\u7684\u548c\u4e3a\n\n$$f(n)=(p1^0+p1^1+p1^2+...+p1^a1)(p2^0+p2^1+p2^2+...+p2^a2)+(pk^0+pk^1+pk^2+...+pk^ak)$$\n\n\u8bc1\u660e\u53ef\u4ee5\u770b[\u767e\u5ea6\u767e\u79d1](https://baike.baidu.com/item/%E7%BA%A6%E6%95%B0%E5%92%8C%E5%AE%9A%E7%90%86/3808428?fr=aladdin)\u3002\n\n---\n\n\u4e4b\u540e\uff0c\u518d\u770b\u770b\u6570\u636e\u8303\u56f4\uff0c $ 1<= n < 2^{16}$ ~~\u83ab\u975e\u662f\u4f20\u8bf4\u4e2d\u7684 $n^2$ \u8fc7\u767e\u4e07~~ \u80af\u5b9a\u662f\u8981\u7528 __\u9ad8\u7cbe__\u3002\n\n\u90a3\u6211\u4eec\u6765\u590d\u4e60\u4e00\u4e0b\u9ad8\u7cbe\uff0c\u9ad8\u7cbe\u5176\u5b9e\u5c31\u662f\u7c7b\u4f3c\u7ad6\u5f0f\u4e00\u6837\uff0c\u4f46\u662f\u662f\u4f7f\u7528`string`\u7c7b\u578b\u8fdb\u884c\u8fd0\u7b97\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff0c\n\n$$\\begin{aligned}221\\\\\\dfrac{+111}{332}\\end{aligned}\n$$\n\n\u5c31\u662f\u53f3\u5bf9\u9f50\uff0c\u7136\u540e\u6bcf\u4f4d\u5206\u522b\u76f8\u52a0\uff0c\u6ce8\u610f\u8fdb\u4f4d~~\u5f53\u7136\u7531\u4e8e\u6280\u672f\u539f\u56e0\u6211\u6ca1\u5bf9\u9f50\uff0c\u8bf7\u89c1\u8c05~~\u3002\n\n\u90a3\u4e48\uff0c\u9ad8\u7cbe\u52a0\u6cd5\u7684\u5f0f\u5b50\u5c31\u63a8\u5bfc\u51fa\u6765\uff0c\n\n```cpp\nstring add(string s1, string s2)\n{\n    int n = s1.length(), m = s2.length();\n    for (int i = 0; i < n; i ++) a[i] = s1[n-1-i] - '0';\n    for (int i = 0; i < m; i ++) b[i] = s2[m-1-i] - '0';\n    int len = max(n, m) + 1;\n    for (int i = n; i < len; i ++) a[i] = 0;\n    for (int i = m; i < len; i ++) b[i] = 0;\n    for (int i = 0; i < len; i ++) res[i] = 0;\n    for (int i = 0; i < len; i ++)\n\t{\n        res[i] += a[i] + b[i];\n        if (res[i] >= 10)\n\t\t{\n            res[i+1] += res[i] / 10;\n            res[i] %= 10;\n        }\n    }\n    int i = len-1;\n    while (res[i] == 0 && i > 0) i --;\n    string s = \"\";\n    for (; i >= 0; i --)\n\t{\n        char c = (char) (res[i] + '0');\n        s += c;\n    }\n    return s;\n}\n```\n~~\u7136\u540e\u4f60\u5c31\u53d1\u73b0\uff0c\u4f60\u80fdAC\u6389[\u8fd9\u9053\u9898](https://www.luogu.com.cn/problem/P1601)\uff0c\u7b80\u76f4\u662f\u53cc\u500d\u7ecf\u9a8c\u5bf9\u4e0d\u5bf9~~\n\n\u90a3\u4e48\u51cf\u6cd5\u7684\u5f0f\u5b50\u4e5f\u5f88\u597d\u63a8\uff0c\n\n$$\\begin{aligned}221\\\\\\dfrac{-111}{110}\\end{aligned}$$\n\n\u5c31\u662f\u6ce8\u610f\u53f3\u5bf9\u9f50\u548c\u9000\u4f4d\u3002\n\n```cpp\nstring sub(string s1, string s2)\n{\n    int n = s1.length(), m = s2.length();\n    for (int i = 0; i < n; i ++) a[i] = s1[n-1-i] - '0';\n    for (int i = 0; i < m; i ++) b[i] = s2[m-1-i] - '0';\n    int len = max(n, m);\n    for (int i = n; i < len; i ++) a[i] = 0;\n    for (int i = m; i < len; i ++) b[i] = 0;\n    for (int i = 0; i < len; i ++) res[i] = 0;\n    for (int i = 0; i < len; i ++) {\n        res[i] += a[i] - b[i];\n        if (res[i] < 0) {\n            res[i+1] --;\n            res[i] += 10;\n        }\n    }\n    int i = len-1;\n    while (res[i] == 0 && i > 0) i --;\n    string s = \"\";\n    for (; i >= 0; i --) {\n        char c = (char) (res[i] + '0');\n        s += c;\n    }\n    return s;\n}\n```\n\u4f46\u662f\u6ce8\u610f\uff0c\u4e00\u5b9a\u662f\u5927\u7684\u51cf\u5c0f\u7684\uff0c\u6240\u4ee5\u8ba1\u7b97\u524d\u6ce8\u610f\u4e00\u4e0b\u3002\n\n\u63a5\u4e0b\u6765\u4e58\u548c\u9664\u7684\u6a21\u677f\u5c31\u76f4\u63a5\u7ed9\u51fa\u4e86\uff1a\n\n```cpp\nbool cmp(string s1, string s2)\n{\n    int n = s1.length(), m = s2.length();\n    int i;\n    for (i = 0; i < n-1 && s1[i] == '0'; i ++);\n    s1 = s1.substr(i);\n    for (i = 0; i < m-1 && s2[i] == '0'; i ++);\n    s2 = s2.substr(i);\n    if (s1.length() != s2.length()) return s1.length() < s2.length();\n    return s1 < s2;\n}\n\nstring div(string s1, string s2)\n{\n    string s = \"\", t = \"\";\n    int n = s1.length(), m = s2.length();\n    bool flag = false;\n    for (int i = 0; i < n; i ++)\n\t{\n        s += s1[i];\n        int num = 0;\n        while (cmp(s, s2) == false)\n\t\t{\n            num ++;\n            s = sub(s, s2);\n        }\n        if (num > 0)\n\t\t{\n            flag = true;\n            char c = (char)(num + '0');\n            t += c;\n        }\n        else if (flag)\n\t\t{\n            t += '0';\n        }\n    }\n    if (t.length() == 0) t = \"0\";\n    while (s[0] == '0' && s.length() > 1) s = s.substr(1);\n    return t;\n}\n\nstring mul(string s1, string s2)\n{\n    int n = s1.length(), m = s2.length();\n    for (int i = 0; i < n; i ++) a[i] = s1[n-1-i] - '0';\n    for (int i = 0; i < m; i ++) b[i] = s2[m-1-i] - '0';\n    int len = n + m;\n    for (int i = n; i < len; i ++) a[i] = 0;\n    for (int i = m; i < len; i ++) b[i] = 0;\n    for (int i = 0; i < len; i ++) res[i] = 0;\n    for (int i = 0; i < n; i ++)\n        for (int j = 0; j < m; j ++)\n            res[i+j] += a[i] * b[j];\n    for (int i = 0; i < len; i ++) {\n        res[i+1] += res[i] / 10;\n        res[i] %= 10;\n    }\n    int i = len-1;\n    while (res[i] == 0 && i > 0) i --;\n    string s = \"\";\n    for (; i >= 0; i --) {\n        char c = (char) (res[i] + '0');\n        s += c;\n    }\n    return s;\n}\n```\n\n\u4f46\u662f\u6ce8\u610f\uff0c\u5728\u5f00\u5934\u5148\n```cpp\nconst int maxn = 100010;//\u8fd9\u4e2a\u91cf\u53ef\u4ee5\u6539\u52a8\nint a[maxn], b[maxn],res[maxn];\n```\n\u6765\u8f85\u52a9\u8fd0\u7b97\u3002\n\n\u4f46\u662f\u5728\u8bb2\u4e3b\u51fd\u6570\u524d\uff0c\u5148\u8bb2\u4e00\u4e0b\uff0c\u5982\u4f55\u5728\u6570\u5b57\u548c\u5b57\u7b26\u4e32\u4e4b\u95f4**\u8fdb\u884c\u8f6c\u6362**\uff0c\u6bd4\u5982\u5c06\u4e00\u4e2a`int`\u503c\u8f6c\u5316\u6210\u4e00\u4e2a`string`\u5b57\u7b26\u4e32\u3002\n\n\u6211\u4eec\u5c06\u7528\u5230`stringstream`\u3002\n```cpp\n//stringstream\u5177\u4f53\u4f7f\u7528\nint i=114514;\nstring str;\nstringstream ss;\nss>>i;\nss<<str;\ncout<<str;\n```\n\u8fd9\u6837\u5c06\u4f1a\u8f93\u51fa `114514`\u3002\n\n\u90a3\u4e48\u7528\u6cd5\u5c31\u5f88\u663e\u7136\uff0c\u548c`cin>>`\u5dee\u4e0d\u591a\u542b\u4e49\uff0c\u8fd9\u4e2a\u5c06\u6570\u636e\u63d2\u5165\u4e86\u6570\u5b57\u6d41\u4e2d\uff0c\u5e76\u8d4b\u503c\u7ed9\u4e86\u5b57\u7b26\u4e32\u3002\u5f88\u65b9\u4fbf\u5bf9\u4e0d\u5bf9\u3002\n\n---\n\u6700\u540e\uff0c\u5c31\u662f\u9898\u76ee\u4ee3\u7801\u5b9e\u73b0\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u5206\u89e3\u8d28\u56e0\u6570\u7684\u4ee3\u7801\uff0c\u8bb0\u5f55\u56e0\u5b50\u7684\u4e2a\u6570\u548c\u6570\u503c\u3002\u76f8\u4fe1\u8fd9\u4e2a\u5927\u5bb6\u90fd\u4f1a\uff0c\u5148`int f[65550];//\u7531\u4e8e\u9898\u76ee\u5927\u5c0f\uff0c\u6700\u591a\u5230\u8fd9\u91cc\u5373\u53ef`\uff0c\u4e4b\u540e\u7684\u4e0d\u7528\u6211\u8bf4\u4e86\uff0c\u770b\u4ee3\u7801\u5c31\u884c\uff0c\u76f8\u4fe1\u90fd\u770b\u5f97\u61c2\u3002\n\n```cpp\nint f[maxn];//maxn==65550\nvoid work(int n)\n{\n\tfor(int i=2;i<=maxn;i++)\n\t{\n\t\tif(n<=1)\n\t\treturn;\n\t\twhile(n%i==0)\n\t\t{\n\t\t\tn/=i;f[i]++;\n\t\t}\n\t}\n}\n```\n\u4e4b\u540e\uff0c\u53ea\u9700\u8981\u4f9d\u7167\u9898\u610f\u8ba1\u7b97\u5373\u53ef\uff0c\u4ee3\u7801\uff1a\n```cpp\nfor(int i=2;i<=maxn;i++)\n\t{\n\t\tif(f[i]!=0)\n\t\t{\n\t\t\tstring s;\n\t\t\tstringstream ss;\n\t\t\tss<<i;\n\t\t\tss>>s;\n\t\t\tc[i]=\"1\";\n\t\t\tfor(int j=1;j<=f[i]*k+1;j++)\n\t\t\t{ \n\t\t\t\tc[i]=mul(c[i],s);\n\t\t\t}\n\t\t\tss.clear();\n\t\t\tc[i]=sub(c[i],\"1\");\n\t\t\tstring sum;\n\t\t\tss<<i-1;\n\t\t\tss>>sum;\n\t\t\tc[i]=div(c[i],sum);\n\t\t}\n\t}\n\tfor(int i=2;i<=maxn;i++)\n\t{ \n\t\tif(f[i]!=0)\n\t\t{ \n\t\t\tans=mul(ans,c[i]);\n\t\t}\n\t}\n\tcout<<ans;\n```\n\u4e8e\u662f\u5c31\u6109\u5feb\u5730AC\u4e86\n\n\u5b8c\u6574\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define maxn 65550\nusing namespace std;\nint a[maxn], b[maxn],res[maxn];\nstring sub(string s1, string s2)\n{\n    int n = s1.length(), m = s2.length();\n    for (int i = 0; i < n; i ++) a[i] = s1[n-1-i] - '0';\n    for (int i = 0; i < m; i ++) b[i] = s2[m-1-i] - '0';\n    int len = max(n, m);\n    for (int i = n; i < len; i ++) a[i] = 0;\n    for (int i = m; i < len; i ++) b[i] = 0;\n    for (int i = 0; i < len; i ++) res[i] = 0;\n    for (int i = 0; i < len; i ++) {\n        res[i] += a[i] - b[i];\n        if (res[i] < 0) {\n            res[i+1] --;\n            res[i] += 10;\n        }\n    }\n    int i = len-1;\n    while (res[i] == 0 && i > 0) i --;\n    string s = \"\";\n    for (; i >= 0; i --) {\n        char c = (char) (res[i] + '0');\n        s += c;\n    }\n    return s;\n}\nstring add(string s1, string s2)\n{\n    int n = s1.length(), m = s2.length();\n    for (int i = 0; i < n; i ++) a[i] = s1[n-1-i] - '0';\n    for (int i = 0; i < m; i ++) b[i] = s2[m-1-i] - '0';\n    int len = max(n, m) + 1;\n    for (int i = n; i < len; i ++) a[i] = 0;\n    for (int i = m; i < len; i ++) b[i] = 0;\n    for (int i = 0; i < len; i ++) res[i] = 0;\n    for (int i = 0; i < len; i ++)\n\t{\n        res[i] += a[i] + b[i];\n        if (res[i] >= 10)\n\t\t{\n            res[i+1] += res[i] / 10;\n            res[i] %= 10;\n        }\n    }\n    int i = len-1;\n    while (res[i] == 0 && i > 0) i --;\n    string s = \"\";\n    for (; i >= 0; i --)\n\t{\n        char c = (char) (res[i] + '0');\n        s += c;\n    }\n    return s;\n}\nbool cmp(string s1, string s2)\n{\n    int n = s1.length(), m = s2.length();\n    int i;\n    for (i = 0; i < n-1 && s1[i] == '0'; i ++);\n    s1 = s1.substr(i);\n    for (i = 0; i < m-1 && s2[i] == '0'; i ++);\n    s2 = s2.substr(i);\n    if (s1.length() != s2.length()) return s1.length() < s2.length();\n    return s1 < s2;\n}\n\nstring div(string s1, string s2)\n{\n    string s = \"\", t = \"\";\n    int n = s1.length(), m = s2.length();\n    bool flag = false;\n    for (int i = 0; i < n; i ++)\n\t{\n        s += s1[i];\n        int num = 0;\n        while (cmp(s, s2) == false)\n\t\t{\n            num ++;\n            s = sub(s, s2);\n        }\n        if (num > 0)\n\t\t{\n            flag = true;\n            char c = (char)(num + '0');\n            t += c;\n        }\n        else if (flag)\n\t\t{\n            t += '0';\n        }\n    }\n    if (t.length() == 0) t = \"0\";\n    while (s[0] == '0' && s.length() > 1) s = s.substr(1);\n    return t;\n}\n\nstring mul(string s1, string s2)\n{\n    int n = s1.length(), m = s2.length();\n    for (int i = 0; i < n; i ++) a[i] = s1[n-1-i] - '0';\n    for (int i = 0; i < m; i ++) b[i] = s2[m-1-i] - '0';\n    int len = n + m;\n    for (int i = n; i < len; i ++) a[i] = 0;\n    for (int i = m; i < len; i ++) b[i] = 0;\n    for (int i = 0; i < len; i ++) res[i] = 0;\n    for (int i = 0; i < n; i ++)\n        for (int j = 0; j < m; j ++)\n            res[i+j] += a[i] * b[j];\n    for (int i = 0; i < len; i ++) {\n        res[i+1] += res[i] / 10;\n        res[i] %= 10;\n    }\n    int i = len-1;\n    while (res[i] == 0 && i > 0) i --;\n    string s = \"\";\n    for (; i >= 0; i --) {\n        char c = (char) (res[i] + '0');\n        s += c;\n    }\n    return s;\n}\nint f[maxn];\nvoid work(int n){\n\tfor(int i=2;i<=maxn;i++)\n\t{\n\t\tif(n<=1)\n\t\treturn;\n\t\twhile(n%i==0)\n\t\t{\n\t\t\tn/=i;f[i]++;\n\t\t}\n\t}\n}\nstring c[maxn];\nint main()\n{\n\tstring ans=\"1\";\n\tint n,k,a;\n\tscanf(\"%d%d\",&n,&k);\n\twork(n);\n\tfor(int i=2;i<=maxn;i++)\n\t{\n\t\tif(f[i]!=0)\n\t\t{\n\t\t\tstring s;\n\t\t\tstringstream ss;\n\t\t\tss<<i;\n\t\t\tss>>s;\n\t\t\tc[i]=\"1\";\n\t\t\tfor(int j=1;j<=f[i]*k+1;j++)\n\t\t\t{ \n\t\t\t\tc[i]=mul(c[i],s);\n\t\t\t}\n\t\t\tss.clear();\n\t\t\tc[i]=sub(c[i],\"1\");\n\t\t\tstring sum;\n\t\t\tss<<i-1;\n\t\t\tss>>sum;\n\t\t\tc[i]=div(c[i],sum);\n\t\t}\n\t}\n\tfor(int i=2;i<=maxn;i++)\n\t{ \n\t\tif(f[i]!=0)\n\t\t{ \n\t\t\tans=mul(ans,c[i]);\n\t\t}\n\t}\n\tcout<<ans;\n}\n```\n\u671b\u91c7\u7eb3\uff0c\u8c22\u8c22\u3002",
        "postTime": 1603022791,
        "uid": 352464,
        "name": "JJA_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2557 \u3010[AHOI2002]\u829d\u9ebb\u5f00\u95e8\u3011"
    },
    {
        "content": "~~\u8bdd\u8bf4\u672c\u9898C++\u9898\u89e3\u8fd9\u4e48\u5c11\u5417~~\n\n\u8fd9\u9053\u9898\u9700\u8981\u4e00\u4e2a\u7ed3\u8bba\u2014\u2014\u7ea6\u6570\u548c\u5b9a\u7406\u3002\uff08~~\u5176\u5b9e\u662f\u4e00\u4e2a\u4e0d\u6298\u4e0d\u6263\u7684\u6570\u8bba\u9898~~\uff09\n\n\u7ea6\u6570\u548c\u5b9a\u7406\uff1a\u4e00\u4e2a\u6570\u5728\u5206\u89e3\u8d28\u56e0\u6570\u4e4b\u540e\u5c06\u6bcf\u4e2a\u8d28\u56e0\u6570\u76840\u6b21\u65b9\uff0c1\u6b21\u65b9\u2026\u2026\u4e00\u76f4\u52a0\u5230\u5728\u8fd9\u4e2a\u6570\u4e2d\u51fa\u73b0\u7684\u6700\u5927\u6b21\u65b9\u6570\u4e3a\u6b62\uff0c\u4e4b\u540e\u4e58\u8d77\u6765\u3002\n\n\u7528dfs\u5206\u89e3\u8d28\u56e0\u6570\u4e4b\u540e\u5c31\u53ef\u4ee5\u5566\uff0c\u522b\u5fd8\u8bb0\u4e58\u65b9\uff0c\u53ef\u4ee5\u5e26\u5165dfs\u51fd\u6570\u4e2d\u3002\n\n\u7528\u4e00\u4e2a\u6570\u7ec4\u5b58\u50a8\u6240\u6709\u7684\u8d28\u56e0\u6570\u3002\uff08\u5f00\u5230100\u5c31\u884c\uff09\n\n\u6700\u540e\u5c31\u662f~~\u70e6\u4eba~~\u7684\u9ad8\u7cbe\u5ea6\u3002\n\n\u4e0a\u4ee3\u7801\uff08~~\u53c8\u81ed\u53c8\u957f~~\uff09\n\n```\n// luogu-judger-enable-o2\n#include<bits/stdc++.h>\nusing namespace std;\ntemplate<typename T>inline void read(T&x)\n{\n\tT ll=1;\n    T res=0;\n\tchar ch=getchar();\n    while(!isdigit(ch))\n    {\n\t\tif(ch=='-')\n\t\tll=-1;\n\t\tch=getchar();\n\t}\n    while(isdigit(ch))\n\tres=(res<<3)+(res<<1)+ch-'0',ch=getchar();\n    x=res*ll;\n}\ntemplate<typename T>void print(T x)\n{\n    if(x<0)putchar('-'),x=-x;\n    if(x<10)\n    putchar(x+'0');\n    else\n    {\n        print(x/10);\n        putchar(x%10+'0');\n    }\n}\nint _compare(string str1,string str2)\n{\n    if(str1.length()>str2.length()) return 1;\n    else if(str1.length()<str2.length())  return -1;\n    else return str1.compare(str2);\n}\nstring abs(string s)\n{\n    s.erase(0,s.find_first_not_of('-'));\n    return s;\n}\nint compare(string a,string b)\n{\n    bool x=a[0]!='-',y=b[0]!='-';\n    if(x==1&&y==1)return _compare(a,b);\n    if(x==1&&y==0)return 1;\n    if(x==0&&y==1)return -1;\n    else return -_compare(abs(a),abs(b));\n}\nint get(string s)\n{\n    for(int i=0;i<s.length();i++)\n    {\n        if(s[i]!='-')return i;\n    }\n    return s.length();\n}\nbool all(string s)\n{\n    for(int i=0;i<s.length();i++)\n    {\n        if(s[i]!='0')return 0;\n    }\n    return 1;\n}\nstring _add(string a,string b)\n{\n    string ans;\n    int x=max(a.length(),b.length());\n    for(int i=a.length();i<x;i++)a=\"0\"+a;\n    for(int i=b.length();i<x;i++)b=\"0\"+b;\n    for(int i=0;i<x;i++)\n    ans+=\"0\";\n    int jw=0;\n    for(int i=x-1;i>=0;i--)\n    {\n        int s=a[i]+b[i]-96+jw;\n        jw=s/10;\n        ans[i]=s%10+48;\n    }\n    if(jw==1)ans=\"1\"+ans;\n    ans.erase(0,ans.find_first_not_of('0'));\n    return ans;\n} \nstring _sub(string a,string b)\n{\n    string ans;\n    int x=max(a.length(),b.length());\n    for(int i=a.length();i<x;i++)a=\"0\"+a;\n    for(int i=b.length();i<x;i++)b=\"0\"+b;\n    for(int i=0;i<x;i++)\n    ans+=\"0\";\n    int jw=0;\n    for(int i=x-1;i>=0;i--)\n    {\n        int s=a[i]-b[i]-jw;\n        if(s<0)s+=10,jw=1;\n        else jw=0;\n        ans[i]=s%10+48;\n    }\n    if(jw==1)\n    {\n        for(int i=0;i<ans.length();i++)\n        {\n            ans[i]=105-ans[i];\n        }\n        ans=_add(ans,\"1\");\n        ans.erase(0,ans.find_first_not_of('0'));\n        ans=\"-\"+ans;\n    }\n    if(all(ans))\n    return \"0\";\n    ans.erase(0,ans.find_first_not_of('0'));\n    return ans;\n}\nstring _mul(string a,string b)\n{\n    string ans;\n    int x=a.length();\n    int y=b.length();\n    string tmp;\n    for(int i=y-1;i>=0;i--)\n    {\n        tmp=\"\";\n        int temp=b[i]-'0';\n        int t=0;\n        int jw=0;\n        if(temp!=0)\n        {\n            for(int j=1;j<=y-1-i;j++)\n            {\n                tmp+=\"0\";\n            }\n            for(int j=x-1;j>=0;j--)\n            {\n                t=(temp*(a[j]-'0')+jw)%10;\n                jw=(temp*(a[j]-'0')+jw)/10;\n                tmp=char(t+'0')+tmp;\n            }\n            if(jw!=0) \n            {\n                tmp=char(jw+'0')+tmp;\n            }\n        }\n        ans=_add(ans,tmp);\n    }\n    ans.erase(0,ans.find_first_not_of('0'));\n    if(ans==\"\")return \"0\";\n    return ans;\n}\nvoid __div(string a,string b,string &x,string &y)\n{\n    x=y=\"\";\n    if(b==\"0\")\n    {\n        x=y=\"ERROR\";\n        return;\n    }\n    if(a==\"0\")\n    {\n        x=y=\"0\";\n        return;\n    }\n    int res=_compare(a,b);\n    if(res<0)\n    {\n        x=\"0\";\n        y=a;\n        return;\n    }\n    else if(res==0)\n    {\n        x=\"1\";\n        y=\"0\";\n        return;\n    }\n    else\n    {\n        int _x=a.length();\n        int _y=b.length();\n        string k;\n        k.append(a,0,_y-1);\n        for(int i=_y-1;i<_x;i++)\n        {\n            k=k+a[i];\n            k.erase(0,k.find_first_not_of('0'));\n            if(k.empty())\n                k=\"0\";\n            for(char ch='9';ch>='0';ch--)\n            {\n                string str,tmp;\n                str=str+ch;\n                tmp=_mul(b,str);\n                if(_compare(tmp,k)<=0)\n                {\n                    x=x+ch;\n                    k=_sub(k,tmp);\n                    break;\n                }\n            }\n        }\n        y=k;\n    }\n    x.erase(0,x.find_first_not_of('0'));\n    if(x.empty()) x=\"0\";\n    y.erase(0,y.find_first_not_of('0'));\n    if(x.empty()) y=\"0\";\n}\nstring i(string ans)\n{\n    string bbb;\n    for(int kk=0;kk<ans.length();kk++)\n    {\n        if(ans[kk]!='+')\n        bbb+=ans[kk];\n    }\n    ans=bbb;\n    int w=get(ans);\n    ans.erase(0,ans.find_first_not_of('-'));\n    if(w%2==1)ans=\"-\"+ans;\n    return ans; \n}\nstring add(string a,string b)\n{\n    a=i(a),b=i(b);\n    bool x=(a[0]!='-'),y=(b[0]!='-');\n    if(x==1&&y==1)return _add(a,b);\n    if(x==1&&y==0)return _sub(a,abs(b));\n    if(x==0&&y==1)return _sub(b,abs(a));\n    return \"-\"+_add(abs(a),abs(b));\n}\nstring _div(string a,string b)\n{\n    string tmp1,tmp2;\n    __div(a,b,tmp1,tmp2);\n    return tmp1;\n}\nstring div(string a,string b)\n{\n    a=i(a),b=i(b);\n    int x=(a[0]!='-'),y=(b[0]!='-');\n    string s=_div(abs(a),abs(b));\n    for(int i=1;i<=x+y;i++)\n    s=\"-\"+s;\n    s=i(s);\n    return s;\n}\nstring sub(string a,string b)\n{\n    return add(a,\"-\"+b);\n} \nstring mul(string a,string b)\n{\n    a=i(a),b=i(b);\n    int x=(a[0]!='-'),y=(b[0]!='-');\n    string s=_mul(abs(a),abs(b));\n    for(int i=1;i<=x+y;i++)\n    s=\"-\"+s;\n    s=i(s);\n    return s;\n}\nint m[1<<8+1<<2];\nint num[100];\nint now=1;\nvoid dfs(long long l,long long r)\n{\n\tfor(long long i=2;i*i<=l;i++)\n\t{\n\t\tif(l%i==0)\n\t\t{\n\t\t\twhile(l%i==0)\n\t\t\t{\n\t\t\t\tl/=i;\n\t\t\t\tm[i]+=r;\n\t\t\t}\n\t\t\tnum[now]=i;\n\t\t\tnow++;\n\t\t\tdfs(l,r);\n\t\t\treturn;\n\t\t}\n\t}\n\tif(l==1)return;\n\tm[l]+=r;\n\tnum[now]=l;\n\tnow++;\n\treturn;\n} \nstring pow(string x,long long y)\n{\n\tif(y==0)return \"1\";\n    string res=\"1\";\n    while(y)\n    {\n        if(y&1)\n            res=mul(res,x);\n        x=mul(x,x);\n        y=y>>1;\n    }\n    return res;\n} \nint main()\n{\n\tlong long n,k;\n\tread(n);\n\tread(k);\n\tdfs(n,k);\n\tstring ans=\"1\";\n\tfor(int i=1;i<now;i++)\n\t{\n\t\tstring s=to_string(num[i]),g=s;\n\t\ts=pow(s,m[num[i]]+1);\n\t\ts=sub(s,\"1\");\n\t\ts=div(s,sub(g,\"1\"));\n\t\tans=mul(ans,s);\n\t}\n\tcout<<ans<<endl;\n}\n```",
        "postTime": 1568097304,
        "uid": 61940,
        "name": "QwQ_lky_QwQ",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2557 \u3010[AHOI2002]\u829d\u9ebb\u5f00\u95e8\u3011"
    },
    {
        "content": "~~\u829d\u9ebb\u5f00\u95e8.~~\n\n\u9898\u610f.\u6c42\u51fa$n^k$\u6240\u6709\u7684\u7ea6\u6570\u548c..\n\n\u82e5\u6574\u6570$i\\ (1<=i<=p)$\u80fd\u6574\u9664$p$.\u5219$i$\u662f$p$\u7684\u7ea6\u6570..\n\n\u6b64\u9898\u628a$n$\u5206\u89e31\u4e0b...\n\n\u8bbe$n = 180 = 2*2*3*3*5$.\n\n\u82e5\u53ea\u8003\u8651$2$.\u67093\u79cd\u7ea6\u6570$(1,2,4)$.\n\n\u540c\u7406\u6709\u7ea6\u6570$(1,3,9)$,$(1,5)$.\n\n\u53ef\u4ee5\u53d1\u73b0\u5176\u5b83\u7684\u7ea6\u6570\u662f\u901a\u8fc7\u7ec4\u5408\u51fa\u6765\u7684..\n\n\u6240\u4ee5\u795e\u5947\u7684\u8f6c\u6362\u6210\u591a\u9879\u5f0f\u4e58\u6cd5..\n\n\u7ea6\u6570\u548c\u5c31\u662f.$(1+2+4)*(1+3+9)*(1+5) = 546\\ (n = 180,k = 1)$.\n\n\u8fd9\u91cc\u591a\u4e86\u4e2a$k$.\u90a3\u4e48\u6bcf1\u79cd\u7ea6\u6570\u7684\u4e2a\u6570\u53d8\u6210$k$\u500d.\n\n\u6700\u540e\u7528\u4e0a\u9ad8\u7cbe\u5c31\u597d\u4e86..\n\n~~\u590d\u6742\u5ea6\u96be\u4ee5\u5206\u6790..~~\n\n\u5947\u602a\u7684\u53c2\u8003\u6587\u732e.[....](http://oi.nks.edu.cn/zh/Discussion/Details/1736?entry=prob&pid=1374 \"....\").\n\nDiu\u4ee3\u7801..\n\n```cpp\nprogram P2557;\n type\n  gg=record\n   f:array[0..201] of int64;                   //\u9ad8\u7cbe\u6570\u7ec4..\n   s:longint;                                  //\u6570\u7ec4\u7684\u4f4d\u6570.\n  end;\n var\n  a,b:gg;\n  i,j,k,n,s:longint;\n procedure hahaincdec(var a:gg);               //\u8fdb\u9000\u4f4d\u5904\u7406..\n  var\n   i:longint;\n  begin\n   i:=1;\n   while i<=a.s do\n    begin\n     if a.f[i]>=10 then\n      begin\n       inc(a.f[i+1],a.f[i] div 10);\n       a.f[i]:=a.f[i] mod 10;\n       if i=a.s then inc(a.s);\n      end;\n     if a.f[i]<=-1 then\n      begin\n       inc(a.f[i+1],(a.f[i]-9) div 10);\n       a.f[i]:=a.f[i] mod 10+10;\n      end;\n     inc(i);\n    end;\n   while (a.s>=2) and (a.f[a.s]=0) do dec(a.s);\n  end;\n operator *(a,b:gg)c:gg;                   //\u9ad8\u7cbe*\u9ad8\u7cbe.\n  var\n   i,j:longint;\n  begin\n   fillchar(c,sizeof(c),0);\n   for i:=1 to a.s do\n    for j:=1 to b.s do\n     inc(c.f[i+j-1],a.f[i]*b.f[j]);\n   c.s:=a.s+b.s-1;\n   hahaincdec(c);\n  end;\n operator **(a:gg;b:longint)c:gg;         //\u9ad8\u7cbe*\u4f4e\u7cbe.\n  var\n   i,j:longint;\n  begin\n   for i:=1 to a.s do\n    a.f[i]:=a.f[i]*b;\n   hahaincdec(a);\n   c:=a;\n  end;\n operator -(a:gg;b:longint)c:gg;          //\u9ad8\u7cbe-\u4f4e\u7cbe.\n  var\n   i:longint;\n  begin\n   dec(a.f[1],b);\n   hahaincdec(a);\n   c:=a;\n  end;\n operator /(a:gg;b:longint)c:gg;          //\u9ad8\u7cbe/\u4f4e\u7cbe.\n  var\n   i:longint;\n   p:int64;\n  begin\n   p:=0;\n   for i:=a.s downto 1 do\n    begin\n     p:=p*10+a.f[i];\n     a.f[i]:=p div b;\n     p:=p mod b;\n    end;\n   hahaincdec(a);\n   c:=a;\n  end;\n begin\n  readln(n,k);\n  if n=1 then writeln(n)                 //\u8bf4\u660en\u6c38\u8fdc\u662f1....\n         else\n  begin\n   a.s:=1;\n   a.f[a.s]:=1;                          //\u7528\u4e8e\u7d2f\u8ba1\u6700\u540e\u7ed3\u679c.\n   for i:=2 to n do                      //\u679a\u4e3e\u7ea6\u6570..\n    begin\n     s:=0;\n     fillchar(b,sizeof(b),0);            //\u7528\u4e8e\u8ba1\u7b97\u5f53\u524d\u7ea6\u6570\u7ed3\u679c..\n     b.s:=1;\n     b.f[b.s]:=1;\n     while n mod i=0 do\n      begin\n       inc(s);                           //\u7ea6\u6570\u4e2a\u6570..\n       n:=n div i;\n      end;\n     s:=s*k;                             //k\u500d..\n     for j:=1 to s+1 do\n      b:=b**i;                           //\u7528\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u516c\u5f0f\u8ba1\u7b97...\n     b:=(b-1)/(i-1);\n     a:=a*b;                             //\u7d2f\u4e58..\n    end;\n   for i:=a.s downto 1 do\n    write(a.f[i]);\n   writeln;\n  end;\n end.\n```\n(\u0ca1\u03c9\u0ca1).\n",
        "postTime": 1515120855,
        "uid": 20454,
        "name": "BFSBFSBFSBFS",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2557 \u3010[AHOI2002]\u829d\u9ebb\u5f00\u95e8\u3011"
    },
    {
        "content": "\u524d\u8a00\n\n------------\n\n\u6bd4\u8f83\u7b80\u5355\u7684\u4e00\u9053\u63a8\u5f0f\u5b50\u9898\uff0c\u96be\u5ea6\u5c31\u5728\u4f60\u6709\u6ca1\u6709\u9ad8\u7cbe\u5ea6\u7684\u677f\u5b50\u4e86\u3002\n\n\u63a8\u7406\n\n------------\n\n\u6211\u4eec\u80af\u5b9a\u5c06 $n^k$ \u5206\u89e3\u8d28\u56e0\u6570\uff0c\u53d8\u6210\u5982\u4e0b\u5f62\u5f0f\uff1a\n\n$n^k = p_{1}^{x_1} \\times p_{2}^{x_2} \\times \u2026\u2026\\times p_{i}^{x_i}$\n\n\u5f53\u7136\uff0c\u6c42\u8fd9\u4e2a\u8d28\u56e0\u6570\u65f6\uff0c\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u8fd9\u6837\u6c42\uff1a\n\n$n = p_{1}^{x_1} \\times p_{2}^{x_2} \\times \u2026\u2026\\times p_{i}^{x_i}$\n\n$n^k = p_{1}^{k \\times x_1} \\times p_{2}^{k \\times x_2} \\times \u2026\u2026\\times p_{i}^{k \\times x_i}$\n\n**\u4ee5\u4e0a\u662f\u7b2c\u4e00\u4e2a\u4f18\u5316\u3002**\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u5c31\u4ee5\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u6765\u63a8\u7b97\u3002\n\n\u6211\u4eec\u77e5\u9053\uff0c$n^k$ \u7684\u67d0\u4e00\u4e2a\u6b63\u56e0\u5b50\u53ef\u4ee5\u8fd9\u6837\u8868\u793a\uff1a\n\n$p_{1}^{a_1} \\times p_{2}^{a_2} \\times \u2026\u2026\\times p_{i}^{a_i}$ \uff08\u5176\u4e2d $0 \\leq a_{i} \\leq x_{i}$\uff09\n\n\u90a3\u4e48 $n^k$ \u7684\u6b63\u56e0\u6570\u548c\u90a3\u4e5f\u5c31\u597d\u6c42\u4e86\uff0c\u6211\u4eec\u53ea\u9700\u8981\u627e\u5230\u80fd\u8868\u793a\u51fa\u4e0a\u65b9\u6240\u6709\u5236\u7684\u591a\u9879\u5f0f\u4e58\u6cd5\u7684\u4e00\u4e2a\u5f0f\u5b50\uff1a\n\n$(p_{1}^{0}+p_{1}^{1}+p_{1}^{2}+\u2026\u2026+p_{1}^{a_1}) \\times (p_{2}^{0}+p_{2}^{1}+p_{2}^{2}+\u2026\u2026+p_{1}^{a_2}) \\times \u2026\u2026\\times (p_{i}^{0}+p_{i}^{1}+p_{i}^{2}+\u2026\u2026+p_{1}^{a_i})$\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u516c\u5f0f\u5c06\u6b64\u5f0f\u5b50\u53d8\u4e00\u4e0b\u3002\n\n$\\tfrac{p_{1}^{a_1+1}-1}{p_{1}-1} \\times \\tfrac{p_{2}^{a_2+1}-1}{p_{2}-1} \\times \u2026\u2026\\times \\tfrac{p_{i}^{a_i+1}-1}{p_{i}-1}$\n\n**\u4ee5\u4e0a\u662f\u7b2c\u4e8c\u4e2a\u4f18\u5316**\u3002\n\n**Code:**\n\n------------\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nint n,k,a;\nchar arr[16];\nstring sum=\"1\";\nstring gles(string a1,string b1){\n\tint lena=a1.length(),lenb=b1.length(),lenc;\n\tint a[5005],b[5005],c[5005];\n\tfor(int i=0;i<lena;i++)a[lena-i]=a1[i]-'0';\n\tfor(int i=0;i<lenb;i++)b[lenb-i]=b1[i]-'0';\n\tint i=1;\n\twhile(i<=lena||i<=lenb){\n\t\tif(a[i]<b[i]){\n\t\t\ta[i]+=10;\n\t\t\ta[i+1]--;\n\t\t}c[i]=a[i]-b[i];\n\t\ti++;\n\t}lenc=i;\n\twhile(c[lenc]==0&&lenc>1)lenc--;\n\tstring k=\"\";\n\tfor(i=lenc;i>0;i--)k+=c[i]+'0';\n\treturn k;\n}\nstring mul(string x,string y){\n\tint a[50005]={0},b[50005]={0},c[100005]={0};\n\tint lena=x.size();\n\tint lenb=y.size();\n\tfor(int i=0;i<lena;i++)a[lena-i]=x[i]-'0';\n\tfor(int i=0;i<lenb;i++)b[lenb-i]=y[i]-'0';\n\tfor(int i=1;i<=lenb;i++){\n\t\tint k=0;\n\t\tfor(int j=1;j<=lena;j++){\n\t\t\tc[i+j-1]=c[i+j-1]+a[j]*b[i]+k;\n\t\t\tk=c[i+j-1]/10;\n\t\t\tc[i+j-1]%=10;\n\t\t}c[i+lena]=k;\n\t}int lenc=lena+lenb;\n\twhile(c[lenc]==0&&lenc>1)lenc--;\n\tstring l;\n\tfor(int i=lenc;i>0;i--){\n\t\tl+=c[i]+'0';\n\t}\n\treturn l;\n}\nint cmp(string x,string y){\n\tif(x.size()>y.size())return 1;\n\tif(x.size()<y.size())return -1;\n\treturn x>y;\n}\nstring div(string x,string y){\n\tint lena=x.size(),lenb=y.size();\n\tstring t,z;\n\tt.append(x,0,lenb-1);\n\tfor(int i=lenb-1;i<lena;i++){\n\t\tt+=x[i];\n\t\tt.erase(0,t.find_first_not_of('0'));\n\t\tif(t.empty())t=\"0\";\n\t\tfor(char j='9';j>='0';j--){\n\t\t\tstring mul1;mul1+=j;\n\t\t\tmul1=mul(mul1,y);\n\t\t\tif(cmp(mul1,t)<1){\n\t\t\t\tz+=j;\n\t\t\t\tt=gles(t,mul1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}z.erase(0,z.find_first_not_of('0'));\n\tif(z.empty())z=\"0\";\n\treturn z;\n}\nstring gpow(string x,int p) {\n\tif(p==1) return x;\n\tif(p==0) return \"1\";\n\tstring fx=gpow(x,p/2);\n\tif(p&1) {\n\t\treturn mul(mul(fx,x),fx);\n\t}\n\treturn mul(fx,fx);\n} \nbool Is_prime(int x) {\n\tif(x==2) return 0;\n\tif(x==1) return 1;\n\tfor(int i=2;i<=sqrt(x)+1;i++) {\n\t\tif(x%i==0) {\n\t\t\treturn 1;\n\t\t}\n\t}\n\treturn 0;\n}\nvoid itoa(int x) {\n\tint ind=0;\n\twhile(x>0) {\n\t\tarr[ind]=x%10+'0';\n\t\tind++;\n\t\tx/=10;\n\t}\n\tind--;\n\tfor(int i=0;i<=ind/2;i++) {\n\t\tswap(arr[i],arr[ind-i]);\n\t}\n\treturn;\n}\nint main() {\n\tcin>>n>>k;\n\tfor(int i=1;i<=n;i++) {\n\t\tif(Is_prime(i)) continue;\n\t\ta=0;\n\t\twhile(n%i==0) {\n\t\t\tn/=i;\n\t\t\ta++;\n\t\t}\n\t\tif(a>=1) {\n\t\t\titoa(i);\n\t\t\tstring si=arr;\n\t\t\tsum=mul(sum,div(gles(gpow(si,a*k+1),\"1\"),gles(si,\"1\")));\n\t\t}\n\t}\n\tcout<<sum;\n\treturn 0;\n} \n```\n\n\n\n",
        "postTime": 1626445050,
        "uid": 271260,
        "name": "PosVII",
        "ccfLevel": 7,
        "title": "P2557 [AHOI2002]\u829d\u9ebb\u5f00\u95e8 \u9898\u89e3"
    },
    {
        "content": "\u9898\u610f\u5373\u6c42$a^k$\u7684\u7ea6\u675f\u548c\n\n\u7531[\u767e\u5ea6\u767e\u79d1-\u7ea6\u675f\u548c\u5b9a\u7406](https://baike.baidu.com/item/%E7%BA%A6%E6%95%B0%E5%92%8C%E5%AE%9A%E7%90%86/3808428?fr=aladdin)\u53ef\u5f97\n\n\u6211\u4eec\u4fbf\u53ef\u4ee5\u628a$a^k$\u5206\u89e3\uff0c\u5f97\u5230\n$$Ans=(1+p_1^1+p_1^2+\\cdots+p_1^{w_1k-1}+p_1^{w_1k})(1+p_2^1+p_2^2+\\cdots+p_2^{w_2k-1}+p_j^{w_2k})\\cdots(1+p_i^1+p_i^2+\\cdots+p_i^{w_ik-1}+p_i^{w_ik})$$\n\u5176\u4e2d\n$$a=\\prod\\limits p_i^{w_i}$$\n\n\u4e8e\u662f\u5351\u5fae\u7684\u5199\u5b8c\u9ad8\u7cbe\u5ea6\u5c31\u53ef\u4ee5\u8fc7\u4e86\n## $Code$\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nstring div(string a,int b)\n{\n\tstring c=\"\";int d=0;\n\tfor(int i=0;i<a.length();i++)\n\t\ta[i]-='0';\n\tfor(int i=0;i<a.length();i++)\n\t\tc.push_back((d*10+a[i])/b+'0'),d=(d*10+a[i])%b;\n\tfor(int i=0;c[0]=='0';i++)\n\t\tc.erase(c.begin(),c.begin()+1);\n\treturn c;\n}\nstring times(string a,string b){\n    char ans[255]={};\n    int a1[255]={},b1[255]={},s[255]={};\n    int k=0,t,len,lena=a.length(),lenb=b.length();\n    for(int i=0;i<lena;i++)a1[i]=a[i]-'0';\n    for(int i=0;i<lenb;i++)b1[i]=b[i]-'0';\n    for(int j=lenb-1;j>=0;j--)\n    {\n    \tt=k;\n    \tfor(int i=lena-1;i>=0;i--)s[t]+=a1[i]*b1[j],t++;\n    \tk++,len=t;\n\t}\n\tfor(int i=0;i<len;i++)while(s[i]>=10)s[i]-=10,s[i+1]++;\n\tif(s[len]!=0)for(int i=len;i>=0;i--)ans[len-i]=s[i]+'0';\n\telse for(int i=len-1;i>=0;i--)ans[len-1-i]=s[i]+'0';\n\treturn ans;\n}\nstring jian(string a)\n{\n\tchar ans[255]={};\n\tint len=a.length();\n\tans[len-1]=a[len-1]-1;for(int i=len-2;i>=0;i--)ans[i]=a[i];\n\treturn ans;\n}\nint f[65536+5];\nstring c[65536+5];\nint main()\n{\n\tstring ans=\"1\";\n\tint n,k,a;\n\tscanf(\"%d%d\",&n,&k);\n\tfor(int i=2;n>1&&i<=65536;i++)\n\t\tif(n%i==0)\n\t\t\twhile(1)\n\t\t\t\tif(n%i==0)n/=i,f[i]++;\n\t\t\t\telse break;\n\tfor(int i=2;i<=65536;i++)\n\t\tif(f[i]!=0)\n\t\t{\n\t\t\tstring s;\n\t\t\tstringstream ss;\n\t\t\tss<<i;\n\t\t\tss>>s;\n\t\t\tc[i]=\"1\";\n\t\t\tfor(int j=1;j<=f[i]*k+1;j++)\n\t\t\t\tc[i]=times(c[i],s);\n\t\t\tc[i]=jian(c[i]);\n\t\t\tc[i]=div(c[i],i-1);\n\t\t}\n\tfor(int i=2;i<=65536;i++)\n\t\tif(f[i]!=0)\n\t\t\tans=times(ans,c[i]);\n\tcout<<ans;\n\treturn 0;\n}\n```\n",
        "postTime": 1592670117,
        "uid": 115855,
        "name": "Yyxxxxx",
        "ccfLevel": 4,
        "title": "P2557 [AHOI2002]\u829d\u9ebb\u5f00\u95e8 \u9898\u89e3"
    },
    {
        "content": "\u8fd9\u662f\u6211\u7b2c\u4e00\u6b21\u5199\u9898\u89e3 , \u5199\u5f97\u4e0d\u597d\u7684\u5730\u65b9\u8bf7\u6307\u6b63QwQ\n\n**\u9898\u76ee\u8fde\u63a5** [P2557 AHOI2002 \u829d\u9ebb\u5f00\u95e8](https://www.luogu.com.cn/problem/P2557)\n\n## \u9898\u76ee\u5927\u610f\n\n\u7528\u6d45\u663e\u6613\u61c2\u7684\u8bdd\u6765\u8bf4\u5c31\u662f\u7ed9\u51fa $n$ \u548c $k$\uff0c\u6c42$n^{k}$\u7684\u56e0\u6570\u7684\u548c\u3002\n$1 \\le n < 2^{16}$ , $1 \\le k < 20 $\uff0c\u7b54\u6848\u957f\u5ea6 $ \\le 100$\u3002\n\n## \u89e3\u9898\u601d\u8def\n\n\u5bf9\u4e8e\u4e00\u4e2a\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u8868\u793a\u4e3a\u82e5\u5e72\u4e2a\u8d28\u6570\u6b21\u65b9\u548c\uff0c\u5373\n\n$$p_1^{a_1}*p_2^{a_2}*\u2026*p_q^{a_q}$$\n\n\u90a3\u4e48\u8fd9\u4e2a\u6570\u7684\u56e0\u6570\u5c31\u53ef\u4ee5\u8868\u793a\u4e3a\n\n$$p_1^{b_1}*p_2^{b_2}*\u2026*p_q^{b_q}$$\n\n\u5176\u4e2d\u5bf9\u4e8e $\\forall 1 \\le i \\le q $\uff0c\u6709$0 \\le b_i \\le a_i$\u3002\n\n\u8fd9\u662f\u524d\u63d0\u3002\n\n##\n\n\u63a5\u4e0b\u6765\u662f\u4e3b\u8981\u90e8\u5206\u3002\n\n\u5bf9\u4e8e $n$\uff0c\u6211\u4eec\u5c06\u5176\u5206\u89e3\u6210 $p_1^{a_1}*p_2^{a_2}*\u2026*p_q^{a_q}$ \u7684\u5f62\u5f0f\u3002\n\n\u90a3\u4e48 $n^k$ \u5c31\u53ef\u4ee5\u8868\u793a\u4e3a $p_1^{k*a_1}*p_2^{k*a_2}*\u2026*p_q^{k*a_q}$\u3002\n\n\u6240\u4ee5 $n^k$ \u7684\u56e0\u6570\u5c31\u53ef\u4ee5\u8868\u793a\u4e3a $p_1^{b_1}*p_2^{b_2}*\u2026*p_q^{b_q}$ , \u5176\u4e2d\u5bf9\u4e8e $\\forall 1 \\le i \\le q $ , \u6709$0 \\le b_i \\le k*a_i$\u3002\n\n\u6240\u4ee5 $n^k$ \u7684\u56e0\u6570\u548c\u5c31\u4e3a\n\n$$\\prod_{i=1}^q \\sum_{j=1}^{k*a_i} p_i^j$$\n\n##\n\n\u518d\u770b **\u7b54\u6848\u957f\u5ea6 $ \\le 100$**\u3002\n\n\u90a3\u5c31\u662f~~\u6076\u5fc3\u7684~~\u9ad8\u7cbe\u5ea6\u65f6\u95f4\u4e86\u3002\n\n##\n\n\u56e0\u4e3a $n < 2^{16}$\uff0c\u6240\u4ee5 $q \\le 7$\uff0c$a_i \\le 16$\u3002\n\n\u9ad8\u7cbe\u5ea6\u590d\u6742\u5ea6\u5927\u6982\u662f $\\Theta(len^2)$\uff0c\u53ef\u4ee5\u76f4\u63a5 $\\Theta(qka_ilen^2)$ \u76f4\u63a5\u786c\u7b97\u3002\n\n##\n\n\u5927\u6982\u5c31\u662f\u8fd9\u4e9b\uff0c\u4e0b\u9762\u9644\u4e0a\u4ee3\u7801\n```cpp\n#include<iostream>\nusing namespace std;\nlong long a[110],b[110],c[110];\nint la,lb,lc;\nint main()\n{\n\tint n,k;\n\tcin>>n>>k;\n\tif(n==1)\n\t{\n\t\tcout<<1;\n\t\treturn 0;\n\t}\n\tb[1]=1;\n\tlb=1;\n\tfor(int p=2;p<=n;p++)\n\t{\n\t\tfor(int i=1;i<=109;i++)\n\t\t\ta[i]=c[i]=0;\n\t\tla=1;\n\t\ta[1]=1;\n\t\tlc=0;\n\t\twhile(n%p==0)\n\t\t{\n\t\t\tn/=p;\n\t\t\tfor(int i=1;i<=k;i++)\n\t\t\t{\n\t\t\t\tfor(int i=1;i<=la;i++)\n\t\t\t\t\ta[i]*=p;\n\t\t\t\tint s=0;\n\t\t\t\twhile((a[s+1]||s<la)&&s<=105)\n\t\t\t\t{\n\t\t\t\t\ts++;\n\t\t\t\t\ta[s+1]+=a[s]/10;\n\t\t\t\t\ta[s]%=10;\n\t\t\t\t}\n\t\t\t\tla=s;\n\t\t\t\ta[1]++;\n\t\t\t\ts=0;\n\t\t\t\twhile((a[s+1]||s<la)&&s<=105)\n\t\t\t\t{\n\t\t\t\t\ts++;\n\t\t\t\t\ta[s+1]+=a[s]/10;\n\t\t\t\t\ta[s]%=10;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=1;i<=la;i++)\n\t\t\tfor(int j=1;j<=lb&&j+i<=106;j++)\n\t\t\t\tc[i+j-1]+=a[i]*b[j];\n\t\tlc=lb+la-1;\n\t\tint s=0;\n\t\twhile((c[s+1]||s<lc)&&s<=105)\n\t\t{\n\t\t\ts++;\n\t\t\tc[s+1]+=c[s]/10;\n\t\t\tc[s]%=10;\n\t\t}\n\t\tlc=s;\n\t\tfor(int i=1;i<=109;i++)\n\t\t\tb[i]=0;\n\t\tfor(int i=1;i<=lc;i++)\n\t\t\tb[i]=c[i];\n\t\tlb=lc;\n\t}\n\tfor(int i=lb<100?lb:100;i>=1;i--)\n\t\tcout<<b[i];\n}\n```\n\u4ee3\u7801\u662f\u4e00\u5e74\u524d\u7801\u7684\uff0c~~\u5947\u4e11\u65e0\u6bd4~~\u3002",
        "postTime": 1607090457,
        "uid": 149808,
        "name": "\u56de\u56e6\u56e8\u56f8",
        "ccfLevel": 7,
        "title": "\u300e\u9898\u89e3\u300fP2557 [AHOI2002]\u829d\u9ebb\u5f00\u95e8"
    },
    {
        "content": "\u8fd9\u9053\u9898emmm\u4e00\u9053\u7b97\u662f\u4e58\u6cd5\u539f\u7406\u8fd8\u662f\u4ec0\u4e48balabala\u7684\u9898  \n\u5927\u6982\u601d\u8def:\n\u8f93\u5165\u7684\u6570\u53ef\u4ee5\u5206\u89e3\u6210\u7d20\u6570$a_i$\u7684$k_i$\u6b21\u65b9\u4e4b\u79ef  \n\u7136\u540e\u8fdb\u884c\u6a21\u62df  \n\u6837\u4f8b\u4ec0\u4e48\u7684\u697c\u4e0b\u7ed9\u4e86\u53ef\u4ee5\u81ea\u5df1\u770b\u4e00\u4e0b  \n\u62ffPython\u6012\u6c34\u4e00\u6ce2  \n~~\uff08\u624d\u4e0d\u662f\u56e0\u4e3aC++\u9ad8\u7cbe\u5ea6\u5199\u70b8\u4e86\u5462 \u54fc\u5527\uff09~~  \n\u4e0b\u89c1\u4ee3\u7801  \n~~\uff08\u4ec0\u4e48\uff0c\u4e0d\u4f1aPython?\uff09~~  \nPython\u8fd9\u79cd\u4e1c\u897f\u5728NOIP/NOI\u8d5b\u573a\u4e0ahin\u6709\u7528\uff0c\u63a8\u8350\u4e00\u5b66  \n\u5feb\u901f\u5165\u95e8\u7684\u8bdd\u770b\u4e0b\u9762\u94fe\u63a5????  \n[\u4e22\u84dd\u94fe](https://github.com/luogu-dev/cyaron/wiki/Python-30%E5%88%86%E9%92%9F%E5%85%A5%E9%97%A8%E6%8C%87%E5%8D%97)  \n\u4ee3\u7801\u4e22\u4e00\u4e0b\uff08\uff08\uff08\u9003\n```python\nlst=dict() \nn,k=int(),int() \naccess=[] \ndef research(x): \n    i=2\n    while i<=x :\n        if x%i==0 :\n            access.append(i)\n            lst[i]=0\n        while x%i==0 :\n            x/=i\n            lst[i]+=k\n        i+=1\n    if x>1 :\n        lst[x]+=1\n\nn,k=map(int,input().split())\n\nresearch(n)\n\nans=1\n\nfor i in access:\n    t=0\n    tmp=1\n    for j in range(lst[i]+1):\n        t+=tmp\n        tmp*=i\n    ans*=t\n\nprint(ans)\n```\n",
        "postTime": 1559900235,
        "uid": 127191,
        "name": "Doveqise",
        "ccfLevel": 6,
        "title": "P2557 [AHOI2002]\u829d\u9ebb\u5f00\u95e8 \u9898\u89e3"
    },
    {
        "content": "~~\u672c\u7bc7\u9898\u89e3\u9ed8\u8ba4\u4f60\u8bfb\u61c2\u4e86\u9898~~\n\n## \u524d\u7f6e\u77e5\u8bc6\n\u6570\u8bba\uff0c\u9ad8\u7cbe\u5ea6\n## \u5206\u6790\n\u9996\u5148\u6211\u4eec\u51c6\u5907\u8981\u6c42\u7684\u662f**\u4e00\u4e2a\u6570\u7684\u56e0\u6570\u548c**\u3002\n\n\u5982\u4f55\u6c42\u4e00\u4e2a\u6570\u7684\u56e0\u6570\u548c\u5462\uff1f\n\n\u5148\u4e3e\u4e2a\u4f8b\u5b50\uff1a$12$ \u7684\u56e0\u6570\u548c\u662f $1 + 2 + 3 + 4 + 6 + 12 = 28$\uff0c\u4f3c\u4e4e\u6ca1\u4ec0\u4e48\u89c4\u5f8b\u53ef\u8a00\u3002\n\n\u4e0d\u8fc7\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u6bcf\u4e2a\u56e0\u6570\u62c6\u5f00\uff0c\u6bcf\u4e2a\u56e0\u6570\u90fd\u53ef\u4ee5\u62c6\u6210 $2 ^ x 3 ^ y$ \u7684\u5f62\u5f0f\u3002\u8fd9\u5c31\u7ed9\u6211\u4eec\u4e86\u542f\u793a\uff1a\u4f3c\u4e4e\u53ef\u4ee5\u679a\u4e3e $x$ \u540e\u627e\u5230\u6240\u6709\u7684 $y$\uff0c\u518d\u6c42\u548c\u3002\n\n\u8fd8\u662f\u4ee5 $12$ \u4e3a\u4f8b\uff1a$2 ^ 0 (3 ^ 0 + 3 ^ 1) + 2 ^ 1 (3 ^ 0 + 3 ^ 1) + 2 ^ 2(3 ^ 0 + 3 ^ 1) = 28$\u3002\u63a5\u4e0b\u6765\u53ea\u9700\u7b80\u5316\u8ba1\u7b97\u7684\u8fc7\u7a0b\u5373\u53ef\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u5f0f\u5b50\u6709\u516c\u56e0\u6570 $(3 ^ 0 + 3 ^ 1)$\uff0c\u63d0\u51fa\u6765\u540e\u5c31\u53ef\u4ee5\u8f6c\u5316\u4e3a $(2 ^ 0 + 2 ^ 1 + 2 ^ 2)(3 ^ 0 + 3 ^ 1) = 28$\u3002\n\n\u4e8e\u662f\u6211\u4eec\u6210\u529f\u5730\u628a\u8ba1\u7b97\u7684\u8fc7\u7a0b\u7b80\u5316\u6210\u4e86\u591a\u9879\u5f0f\u4e58\u6cd5\u3002\n\n\u63a5\u4e0b\u6765\u76f4\u63a5\u7528\u9ad8\u7cbe\u5ea6\u6c42\u5373\u53ef\u3002\n\n\u4e0d\u8fc7\u8fd8\u6709\u5f88\u591a\u4f18\u5316\uff0c\u4f8b\u5982\uff1a\n\n+ \u4e2d\u95f4\u7684\u5206\u89e3\u8d28\u56e0\u6570\u7684\u6b65\u9aa4\u53ef\u4ee5\u5148\u5206\u89e3 $n$ \u540e\u628a\u6bcf\u4e00\u4e2a\u6307\u6570\u4e58 $k$\uff0c\u53ef\u4ee5\u907f\u514d\u9ad8\u7cbe\u9664\u3002\n\n+ \u4e2d\u95f4\u7684\u591a\u9879\u5f0f\u6c42\u503c\u53ef\u4ee5\u4f7f\u7528\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u516c\u5f0f\u4f18\u5316\uff0c\u4e0d\u8fc7\u5f97\u52a0\u4e0a\u9ad8\u7cbe\u9664\u3002\n\n## \u4ee3\u7801\n\u4e0b\u9762\u662f\u4e00\u79cd\u5178\u578b\u7684\u5199\u6cd5\uff1a\n```cpp\n#include <bits/stdc++.h>\n#define lld long long\nusing namespace std;\nstruct Hint {\n\tint data[101];\n\tint len;\n\tHint(int x = 0){\n\t\tlen = 0;\n\t\twhile (x) {\n\t\t\tdata[++len] = x % 10;\n\t\t\tx /= 10;\n\t\t}\n\t}\n\tvoid print()const{\n\t\tif (!len) puts(\"0\");\n\t\telse{\n\t\t\tfor (int i = len; i; --i)\n\t\t\t\tprintf(\"%d\", data[i]);\n\t\t\tputs(\"\");\n\t\t}\n\t}\n};\nHint operator + (Hint a, Hint b) {\n\tif (a.len < b.len){\n\t\tfor (++a.len; a.len < b.len; ++a.len) a.data[a.len] = 0;\n\t\ta.data[a.len] = 0;\n\t}\n\tif (a.len > b.len){\n\t\tfor (++b.len; a.len > b.len; ++b.len) b.data[b.len] = 0;\n\t\ta.data[b.len] = 0;\n\t}\n\tfor (int i = 1; i <= a.len || i <= b.len; ++i){\n\t\ta.data[i] += b.data[i];\n\t\tif (a.data[i] >= 10){\n\t\t\tif (i + 1 <= a.len) ++a.data[i + 1], a.data[i] -= 10;\n\t\t\telse a.len = i + 1, a.data[a.len] = 1, a.data[i] -= 10;\n\t\t}\n\t}\n\treturn a;\n}\nHint operator * (const Hint & a, const Hint & b) {\n\tHint res(0);\n\tfor (int i = 1; i <= 100; ++i)\n\t\tres.data[i] = 0;\n\tfor (int i = 1; i <= a.len; ++i)\n\t\tfor(int j = 1; j <= b.len; ++j){\n\t\t\tres.data[i + j - 1] += a.data[i] * b.data[j];\n\t\t\tif(res.data[i + j - 1] >= 10){\n\t\t\t\tres.data[i + j] += res.data[i + j - 1] / 10;\n\t\t\t\tres.data[i + j - 1] %= 10;\n\t\t\t}\n\t\t}\n\tres.len = a.len + b.len - 1;\n\tif (res.data[a.len + b.len]) ++res.len;\n\treturn res;\n}\nint pw[100001];\nint m, n, k;\nint main() {\n\tscanf(\"%d%d\", &n, &k);\n\tm = n;\n\tfor (int i = 2; i * i <= m; ++i)\n\t\t\twhile (m % i == 0){\n\t\t\t\t++pw[i];\n\t\t\t\tm /= i;\n\t\t\t}\n\tif (m != 1) ++pw[m];\n\tfor (int i = 1; i <= n; ++i)\n\t\tpw[i] *= k;\n\tHint now, res, ans = 1;\n\tfor (int i = 2; i <= n; ++i){\n\t\tnow = 1; res = 1;\n\t\tfor (int j = 1; j <= pw[i]; ++j) {\n\t\t\tnow = now * i;\n\t\t\tres = res + now;\n\t\t}\n\t\tans = ans * res;\n\t}\n\tans.print();\n}\n```",
        "postTime": 1630310074,
        "uid": 228486,
        "name": "SunsetSamsara",
        "ccfLevel": 7,
        "title": "P2557 [AHOI2002]\u829d\u9ebb\u5f00\u95e8"
    },
    {
        "content": "\u5927\u5bb6\u597d\u554a\uff0c\u6211\u662fdyisz\n\n[\u9898\u9762](https://www.luogu.com.cn/problem/P2557)\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.luogu.com.cn/blog/dyisz666/ti-xie-p2557-ahoi2002-zhi-ma-kai-men)\n\n\u9996\u5148\u770b\u6807\u7b7e\uff1a\u6570\u8bba\u3002\u518d\u770b\u9898\u9762\uff0c\u628a\u9898\u9762\u7b80\u5316\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u9898\u76ee\u8003\u7684\u662f\u4e24\u70b9\uff1a\n###### 1. \u9ad8\u7cbe\u5ea6\n\n###### 2. \u7ea6\u6570\u548c\u7684\u5b9a\u4e49\uff08\u672c\u9898\u96be\u70b9\uff09\n\u7b80\u5355\u6765\u8bb2\uff0c\u9898\u76ee\u95ee\u7684\u5c31\u662fa^k\u7684\u7ea6\u6570\u548c\u3002\n\n\u5f53\u6211\u4eec\u77e5\u9053\u7ea6\u6570\u548c\u5b9a\u4e49\u540e\uff0c\u5c31\u80fd\u6839\u636e\u5b9a\u4e49\u5199\u51fa\u7a0b\u5e8f\u3002\u6240\u4ee5\u63a5\u4e0b\u6765\u8bb2\u7ea6\u675f\u548c\u7684\u5b9a\u4e49\u3002\n# \u7ea6\u6570\u548c\u5b9a\u4e49\u5982\u4e0b\uff1a\n\n\u5bf9\u4e8e\u4e00\u4e2a\u5927\u4e8e1\u6b63\u6574\u6570n\u53ef\u4ee5\u5206\u89e3\u8d28\u56e0\u6570\uff1a\n\n$\\operatorname{n} = p1^ {a1}  * p2^ {a2} * p3^ {a3} * \u2026 * pk^{ak}$\n\n\u8bbes\u4e3an\u7684\u6b63\u7ea6\u6570\u4e2a\u6570\uff0c\u5219\n\n$\\operatorname{s} = (a_1 + 1)(a_2 + 1)(a_3 + 1)\u2026(a_k + 1)$\n\n\u90a3\u4e48n\u7684(a\u2081 + 1)(a\u2082 + 1)(a\u2083 + 1)\u2026(ak + 1)\u4e2a\u6b63\u7ea6\u6570\u7684\u548c\u4e3a\n\n$\\operatorname{f(n)} = (p1^0 + p1^1 + p1^2 + \u2026 p1^a1)(p2^0 + p2^1 + p2^2 +\u2026 p2^a2) \u2026 (pk^0 + pk^1 + pk^2 + \u2026 pk^ak)$\n\n\u4ee5\u4e0a\u5c31\u662f\u5b9a\u4e49\uff0c\u63a5\u4e0b\u6765\u8bb2\u601d\u8def\u90e8\u5206\u3002\n# \u601d\u8def\n\u9996\u5148\uff0c\u6570\u636e\u8303\u56f4\u662f1 \u2264 n \u2264 2^16\uff0c\u8ba1\u7b97\u65f6\u8981\u7528\u9ad8\u7cbe\u5ea6\uff0c\u4e0a\u6587\u6709\u63d0\u5230\u3002\n\n\u7a0b\u5e8f\u91cc\uff0c\u5148\u7528dfs\u5206\u89e3 $a^k$ \u7684\u8d28\u56e0\u6570\uff0c\u7136\u540e\u7528\u4e00\u4e2a\u6570\u7ec4\uff08\u5927\u5c0f100\u4ee5\u4e0a\u5dee\u4e0d\u591a\uff09\uff0c\u7136\u540e\u4e00\u76f4\u5c06\u6bcf\u4e2a\u56e0\u6570\u81ea\u4e58\u5230\u6700\u9ad8\u6b21\u6570\uff0c\u6700\u7ec8\u52a0\u8d77\u6765\uff0c\u8f93\u51fa\u7ed3\u679c\u3002\n\n\u672c\u83dc\u9e21\u7684\u4ee3\u7801\u5c31\u4e0d\u4e0a\u4e86\uff0c\u76f8\u4fe1\u60a8\u4eec\u8fd9\u6837\u7684dalao\u4e00\u5b9a\u80fd\u5199\u51fa\u6765\u3002",
        "postTime": 1606228174,
        "uid": 297798,
        "name": "FANTA5TlC",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2557 [AHOI2002]\u829d\u9ebb\u5f00\u95e8"
    },
    {
        "content": "\u4f5c\u4e3a\u4e00\u540d\u53ea\u6709\u666e\u53ca\u7ec4\u6c34\u5e73\u7684ACMer\u9047\u5230\u8fd9\u79cd\u5927\u6570\u7684\u95ee\u9898\u80af\u5b9a\u662f\u5148\u60f3\u5230\u7528JAVA\u7684\u3002\u3002\u3002  \n\u5f0f\u5b50\u8fd8\u662f\u5f88\u597d\u63a8\u7684\uff0c\u6839\u636e\u7ea6\u6570\u548c\u5b9a\u7406\u7136\u540e\u628an\u5206\u89e3\u8d28\u56e0\u6570\u7136\u540e\u5957\u4e0a\u4e00\u4e2a\u7b49\u6bd4\u6570\u5217\u7684\u6c42\u548c\u516c\u5f0f\u5373\u53ef\u3002  \n\u4e0a\u4e00\u4efd\u4e11\u964b\u7684java AC\u4ee3\u7801.\u4e58\u79ef\u6211\u8fd8\u7528\u4e86\u5feb\u901f\u5e42\u6211\u6015java\u53c8\u5361\u5927\u6570\u8d85\u65f6\n```java\nimport java.io.BufferedInputStream;\nimport java.math.BigInteger;\nimport java.util.Scanner;\npublic class Main \n{\n\tstatic int p[]=new int[100005],cnt[]=new int[100005],q=0;\n\tstatic BigInteger qpow(int a,int b)\n\t{\n\t\tBigInteger base=new BigInteger(new Integer(a).toString());\n\t\tBigInteger ans=BigInteger.ONE;\n\t\twhile(b!=0)\n\t\t{\n\t\t\tif((b&1)==1)\n\t\t\tans=ans.multiply(base);\n\t\t\tbase=base.multiply(base);\n\t\t\tb>>=1;\n\t\t}\n\t\treturn ans;\n\t}\n\tpublic static void main(String[] args) \n\t{\n\t\tScanner cin=new Scanner(new BufferedInputStream(System.in));\n\t\tint n,k;\n\t\tn=cin.nextInt();\n\t\tk=cin.nextInt();\n\t\tfor(int i=2;i*i<=n;i++)\n\t\t{\n\t\t\tif(n%i==0)\n\t\t\t{\n\t\t\t\tp[++q]=i;\n\t\t\t\twhile(n%i==0)\n\t\t\t\t{\n\t\t\t\t\tcnt[q]++;\n\t\t\t\t\tn/=i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(n>1)\n\t\t{\n\t\t\tp[++q]=n;\n\t\t\tcnt[q]=1;\n\t\t}\n\t\tBigInteger ans=new BigInteger(\"1\");\n\t\tfor(int i=1;i<=q;i++)\n\t\tans=ans.multiply(qpow(p[i],cnt[i]*k+1).subtract(BigInteger.ONE).divide(new BigInteger(new Integer(p[i]-1).toString())));\n\t\tSystem.out.println(ans);\n\t}\n}\n```",
        "postTime": 1566386313,
        "uid": 122920,
        "name": "baccano",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2557 \u3010[AHOI2002]\u829d\u9ebb\u5f00\u95e8\u3011"
    }
]
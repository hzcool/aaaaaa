[
    {
        "content": "**\u8fd9\u9898\u53ef\u4ee5O($n^2$)\u8fc7\uff0c\u4ee5\u4e0b\u662fO\uff08$n^2$)\u601d\u8def\uff1a**\n\n\u66b4\u529b\u679a\u4e3e\u5220\u6389\u7684\u8fb9\uff0c\u4f7f\u5b83\u5206\u6210\u4e24\u68f5\u6811\uff0c\u7136\u540e\u8003\u8651\u8fde\u63a5\u54ea\u4e24\u4e2a\u70b9\u53ef\u4ee5\u4f7f\u6700\u5927\u4ea4\u901a\u8d39\u7528\u6700\u5c0f\n\n#### \u8fd9\u65f6\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\n\n   1.\u8981\u6700\u5927\u4ea4\u901a\u8d39\u7528\u7684\u4e24\u4e2a\u70b9\u5728\u540c\u4e00\u68f5\u6811\u4e0a\n\n   2.\u6700\u5927\u8d39\u7528\u7684\u4e24\u4e2a\u70b9\u5206\u522b\u5728\u4e24\u68f5\u6811\u4e0a\n     \n\u7b2c\u4e00\u79cd\u60c5\u51b5\u662f\u4e0d\u4f1a\u88ab\u8fde\u63a5\u7684\u8fb9\u5f71\u54cd\u7684\uff0c\u6211\u4eec\u8981\u60f3\u529e\u6cd5\u8fde\u8fb9\u8ba9\u7b2c\u4e8c\u79cd\u60c5\u51b5\u7684\u6700\u5927\u8d39\u7528\u6700\u5c0f\u3002~~\u663e\u7136\u662f\u8fde\u63a5\u4e24\u68f5\u6811\u4e0a\u76f4\u5f84\u7684\u4e2d\u70b9~~\uff08\u8fd9\u91cc\u522b\u7684\u9898\u89e3\u90fd\u8bb2\u5f97\u6bd4\u8f83\u8be6\u7ec6\uff0c\u5c31\u4e0d\u518d\u8d58\u8ff0\u4e86\uff09\n\n# \u91cd\u70b9\u6765\u4e86\uff1a\u5982\u4f55\u4f18\u5316\u5230O(n)\n\u56de\u987eO\uff08$n^2$\uff09\u7684\u5199\u6cd5\uff1a\u5728\u6bcf\u53bb\u6389\u4e00\u6761\u8fb9\u540e\u90fd\u5206\u522b\u5728\u4e24\u68f5\u6811\u4e0a\u7528\u4e24\u904dbfs\u6c42\u6811\u7684\u76f4\u5f84\u3002\u4e8b\u5b9e\u4e0a\u53ea\u5206\u522b\u7528\u4e00\u904d\u5c31\u884c\u4e86\u3002**\u5bf9\u4e8e\u4e00\u68f5\u88ab\u5206\u5272\u51fa\u6765\u7684\u6811\uff0c\u5b83\u76f4\u5f84\u7684\u4e00\u7aef\u4e00\u5b9a\u662f\u672a\u5220\u8fb9\u65f6\u6811\u7684\u76f4\u5f84\u7684\u4e00\u7aef\u3002**\n\n```\n\u53cd\u8bc1\uff1a\uff08\u6b64\u65f6a->d\u4e3a\u539f\u6811\u4e0a\u76f4\u5f84\uff0cb->e\u4e3a\u8981\u5220\u7684\u8fb9\uff09\u5047\u8bbex1>x2\uff0c\u90a3\u4e48x1+y+z>x2\n+y+z\uff0c\u5219\u539f\u6811\u4e0a\u76f4\u5f84\u4e3ac->d\uff0c\u4e0e\u6761\u4ef6\u77db\u76fe\u3002\u6240\u4ee5a\u8ddd\u79bbb\u6700\u8fdc\uff0ca\u4e3a\u65b0\u6811\u4e0a\u534a\u5f84\u4e00\u7aef\n\t\u5f97\u8bc1\n```\n![](https://cdn.luogu.com.cn/upload/pic/66890.png)\n\n**\u4f18\u5316\u540e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4f9d\u7136\u8fbe\u4e0d\u5230O\uff08n\uff09\uff0c\u7ee7\u7eed\u4f18\u5316\u5269\u4e0b\u4e00\u904dbfs\uff1a**\n\n![](https://cdn.luogu.com.cn/upload/pic/66891.png)\n\n(\u6a59\u8272\u4e3a\u622a\u6389\u7684\u8fb9\uff0c\u7eff\u8272\u4e3a\u76f4\u5f84\uff0c\u5de6\u8fb9\u84dd\u8272\u4e3a\u904d\u5386\u5230\u7684\u70b9\u53f3\u8fb9\u7ea2\u8272\u4e3a\u904d\u5386\u4e00\u904d\u7684\u70b9\uff0c\u7d2b\u8272\u4e3a\u91cd\u590d\u904d\u5386\u7684\u70b9)\u53ef\u4ee5\u770b\u5230\uff0c\u5728\u679a\u4e3e\u5220\u8fb9\u65f6\u6709\u5f88\u591a\u70b9\u88ab\u91cd\u590d\u904d\u5386\u5230\u4e86\u3002**\u53ef\u4ee5\u8003\u8651\u7b2c\u4e8c\u6b21\u53ea\u904d\u5386\u7ea2\u8272\u90e8\u5206**\u3002\u8fd9\u6837\u603b\u5171\u53ea\u5c06\u6811\u904d\u5386\u4e86\u4e00\u904d\uff0c\u53ef\u4ee5\u8fbe\u5230O\uff08n\uff09\u3002\n\n![](https://cdn.luogu.com.cn/upload/pic/66898.png)\n\n\u904d\u5386\u5230\u53f6\u8282\u70b9\u65f6\u66f4\u65b0\u76f4\u5f84\uff08\u4e3a\u4e86\u8868\u8ff0\u65b9\u4fbf\uff0c\u6240\u6709\u8fb9\u957f\u5ea6\u4e3a1\uff09\uff08\u5de6\u8fb9\u65b0\u6811\u76f4\u5f844\uff0c\u53f3\u8fb96\uff09\n\n### \u7ef4\u62a4\u76f4\u5f84\u4e2d\u70b9\n\n\u6c42\u51fa\u76f4\u5f84\u540e\uff0c\u8981\u5bfb\u627e\u76f4\u5f84\u4e2d\u70b9\uff0c\u6b64\u65f6\u5982\u679c\u904d\u5386\u76f4\u5f84\u6c42\u4e2d\u70b9\uff0c\u5728\u6781\u7aef\u60c5\u51b5\u4e0b\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u8fd8\u662fO\uff08$n^2$)\u3002\u4f46\u53ef\u4ee5\u53d1\u73b0\uff0c\u76f4\u5f84\u957f\u5ea6\u662f\u5355\u8c03\u4e0d\u51cf\u7684\uff0c\u56e0\u6b64**\u534a\u5f84\u957f\u5ea6\u4e5f\u5355\u8c03\u4e0d\u51cf**\u3002\u53ef\u4ee5\u7531\u4e0a\u6b21\u7684\u4e2d\u70b9\u63a8\u51fa\u8fd9\u6b21\u7684\u4e2d\u70b9\u3002\n\n## \u8bb2\u89e3~~\u778e\u8bf4~~\u65f6\u95f4\u5230\u6b64\u7ed3\u675f\n### \u4e0b\u9762\u6765\u68b3\u7406\u4e00\u904d\u601d\u8def\n1. \u6c42\u51fa\u539f\u6811\u4e0a\u76f4\u5f84\uff0c\u8bb0\u7aef\u70b9\u4e3ar\uff0cl\n2. \u4ece\u76f4\u5f84\u5de6\u4fa7\u5f00\u59cb\n3. \u5728\u76f4\u5f84\u4e0a\u622a\u8fb9\uff0c\u904d\u5386\u65b0\u589e\u5b50\u6811\uff0c\u66f4\u65b0\u76f4\u5f84\n4. \u4e0a\u4e00\u6b21\u7684\u4e2d\u70b9\u540e\u79fb\uff0c\u4f5c\u4e3a\u8fd9\u4e00\u6b21\u4e2d\u70b9\n5. \u66f4\u65b0\u534a\u5f84\n6. \u5b58\u50a8\u4fe1\u606f\n7. \u91cd\u590d\u6b65\u9aa43-6\uff0c\u76f4\u5230\u904d\u5386\u5b8c\u6574\u4e2a\u76f4\u5f84\n8. \u53f3\u4fa7\u540c\u7406\n9. \u626b\u63cf\u6240\u6709\u5b58\u50a8\u7684\u4fe1\u606f\uff0c\u6c42\u51fa\u6700\u7ec8\u7b54\u6848\n\n### \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nstruct bbbb{\n\tint to,nextt,xx;\n}b[10010];\nint n,tail,dd[5010],dis[5010],vis[5010],ldd,rdd,diss[5010],ttll;\nstruct llbb{\n\tint xxx,x;\n}lb[5010];\nstruct cccc{\n\tint zjcd,bjcd,zd;\n}cc1[5010],cc2[5010];\nvoid jb(int x,int y,int z){\n\ttail++;\n\tb[tail].nextt=dd[x];\n\tb[tail].to=y;\n\tb[tail].xx=z;\n\tdd[x]=tail;\n\treturn;\n}\nqueue<int>q; \nvoid bfs(int x){\n\tmemset(vis,0,sizeof(vis));\n\tdis[x]=0;\n\tvis[x]=1;\n\tq.push(x);\n\twhile(q.empty()==false){\n\t\tint xx=q.front();q.pop();\n\t\tfor(int i=dd[xx];i!=0;i=b[i].nextt){\n\t\t\tif(vis[b[i].to]==0){\n\t\t\t\tvis[b[i].to]=1;\n\t\t\t\tdis[b[i].to]=dis[xx]+b[i].xx;\n\t\t\t\tq.push(b[i].to);\n\t\t\t}\n\t\t}\n\t} \n\treturn;\n}\nbool dfs(int x,int mb){\n\tif(x==mb){\n\t\tttll++;\n\t\tlb[ttll].x=x;\n\t\treturn true;\n\t}\n\tfor(int i=dd[x];i!=0;i=b[i].nextt){\n\t\tif(vis[b[i].to]==0){\n\t\t\tvis[b[i].to]=1;\n\t\t\tif(dfs(b[i].to,mb)==true){\n\t\t\t\tttll++;\n\t\t\t\tlb[ttll].x=x;\n\t\t\t\tlb[ttll].xxx=b[i].xx;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\nint bfs1(int x){\n\tint maxx=0;\n\tq.push(x);\n\twhile(q.empty()==false){\n\t\tint xx=q.front();q.pop();\n\t\tmaxx=max(maxx,diss[xx]);\n\t\tfor(int i=dd[xx];i!=0;i=b[i].nextt){\n\t\t\tif(vis[b[i].to]==0){\n\t\t\t\tvis[b[i].to]=1;\n\t\t\t\tdiss[b[i].to]=diss[xx]+b[i].xx;\n\t\t\t\tq.push(b[i].to);\n\t\t\t}\n\t\t}\n\t} \n\treturn maxx;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<n;i++){\n\t\tint x,y,z;\n\t\tscanf(\"%d%d%d\",&x,&y,&z);\n\t\tjb(x,y,z);\n\t\tjb(y,x,z);\n\t}\n\tbfs(1);\n\tfor(int i=1;i<=n;i++){\n\t\tif(dis[ldd]<=dis[i]){\n\t\t\tldd=i;//\u5de6\u7aef\u70b9 \n\t\t}\n\t}\n\tbfs(ldd);\n\tfor(int i=1;i<=n;i++){\n\t\tif(dis[rdd]<=dis[i]){\n\t\t\trdd=i;//\u53f3\u7aef\u70b9 \n\t\t}\n\t}\n\tmemset(vis,0,sizeof(vis));\n\tvis[ldd]=1;\n\tdfs(ldd,rdd);//\u5b58\u50a8\u6811\u7684\u76f4\u5f84 \n//-------------\u4e0a\u9762\u662f\u6811\u7684\u76f4\u5f84\u90e8\u5206-----------------\n\tmemset(vis,0,sizeof(vis));\n\tfor(int i=1;i<=ttll;i++){\n\t\tvis[lb[i].x]=1;\n\t}\n\tint zhongd=1;\n\tfor(int i=2;i<=ttll;i++){\n\t\tdiss[lb[i].x]=diss[lb[i-1].x]+lb[i].xxx;\n\t\tint qwq=bfs1(lb[i].x);//\u904d\u5386\u65b0\u5b50\u6811 \n\t\tif(qwq<=cc1[lb[i-1].x].zjcd){\n\t\t\tcc1[lb[i].x]=cc1[lb[i-1].x];\n\t\t}\n\t\telse{\n\t\t\twhile(zhongd<i&&max(diss[lb[zhongd].x],qwq-diss[lb[zhongd].x])>max(diss[lb[zhongd+1].x],qwq-diss[lb[zhongd+1].x])){\n\t\t\t\tzhongd++;//\u4e2d\u70b9\u540e\u79fb \n\t\t\t}\n\t\t\tcc1[lb[i].x].zjcd=qwq;//\u66f4\u65b0\u76f4\u5f84 \n\t\t\tcc1[lb[i].x].bjcd=max(diss[lb[zhongd].x],qwq-diss[lb[zhongd].x]);//\u66f4\u65b0\u534a\u5f84 \n\t\t}\n\t}\n\tmemset(vis,0,sizeof(vis));\n\tmemset(diss,0,sizeof(diss));\n\tfor(int i=1;i<=ttll;i++){//\u53f3\u4fa7\u540c\u7406 \n\t\tvis[lb[i].x]=1;\n\t}\n\tzhongd=ttll;\n\tfor(int i=ttll-1;i>=1;i--){\n\t\tdiss[lb[i].x]=diss[lb[i+1].x]+lb[i+1].xxx;\n\t\tint qwq=bfs1(lb[i].x);\n\t\tif(qwq<=cc2[lb[i+1].x].zjcd){\n\t\t\tcc2[lb[i].x]=cc2[lb[i+1].x];\n\t\t}\n\t\telse{\n\t\t\twhile(zhongd>i&&max(diss[lb[zhongd].x],qwq-diss[lb[zhongd].x])>max(diss[lb[zhongd-1].x],qwq-diss[lb[zhongd-1].x])){\n\t\t\t\tzhongd--;\n\t\t\t}\n\t\t\tcc2[lb[i].x].zjcd=qwq;\n\t\t\tcc2[lb[i].x].bjcd=max(diss[lb[zhongd].x],qwq-diss[lb[zhongd].x]);\n\t\t}\n\t}\n\tint minn=1e9;\n\tfor(int i=1;i<ttll;i++){//\u626b\u63cf,\u6c42\u51fa\u6700\u7ec8\u7b54\u6848 \n\t\tminn=min(minn,max(cc1[lb[i].x].bjcd+cc2[lb[i+1].x].bjcd+lb[i+1].xxx,max(cc1[lb[i].x].zjcd,cc2[lb[i+1].x].zjcd)));\n\t}\n\tprintf(\"%d\",minn);\n\treturn 0;\t\t\n}\n```\n### -end-\n\np.s.\u5982\u679c\u54ea\u91cc\u4e0d\u662f\u5f88\u6e05\u695a\uff0c\u6b22\u8fce\u79c1\u4fe1\u63d0\u5efa\u8bae\u54e6~",
        "postTime": 1564535463,
        "uid": 102754,
        "name": "getchar123",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3761 \u3010[TJOI2017]\u57ce\u5e02\u3011"
    },
    {
        "content": "\u597d\u5566\u9996\u5148\u6211\u4eec\u4e0d\u8981\u88ab\u6570\u636e\u8303\u56f4\u5413\u5230\uff0c\u5e38\u6570\u9002\u5b9c\u7684\u60c5\u51b5\u4e0b3s\u65f6\u9650O(n^2)\u53ef\u4ee5\u4fe1\u4ef0\u8fc75000\uff0c\u6bd5\u7adf\u53ea\u662f\u76f8\u8f831000\u7ffb\u4e8625\u500d\uff0c\u5982\u679c\u6211\u4eec\u7684\u7b97\u6cd5\u53ef\u4ee5\u5728100-120ms\u5185\u901a\u8fc71000\uff0c\u5c31\u53ef\u4ee5\u51ed\u501f\u4fe1\u4ef0\u8fc7\u6389\u8fd9\u9053\u9898\n\n# \u672c\u9898\u9898\u89e3\n\n\u5176\u5b9e\u6211\u4eec\u53d1\u73b0\u8fd9\u9053\u9898\u662f\u53ef\u4ee5\u66b4\u529b\u679a\u4e3e\u5220\u90a3\u4e00\u6761\u8fb9\u7684\uff0c\u8fd9\u9996\u5148\u6709\u4e86\u4e00\u4e2aO(N)\u7684\u590d\u6742\u5ea6\n\uff0c\u6211\u4eec\u63a5\u4e0b\u6765\u8981\u7528\u53e6\u4e00\u4e2aO(N)\u5904\u7406\u6700\u8fdc\u70b9\u5bf9\u7684\u95ee\u9898\n\n\u90a3\u4e48\u5220\u53bb\u8fd9\u6761\u8fb9\u4e4b\u540e\uff0c\u6574\u68f5\u6811\u5c06\u88ab\u5206\u4e3a\u4e24\u4e2a\u8054\u901a\u5757\n\n\u90a3\u4e48\u6b64\u65f6\u7684\u6700\u957f\u8def\u6709\u4e09\u79cd\u6765\u6e90\uff0c\n\n1.\u4e24\u4e2a\u7aef\u70b9\u90fd\u5728\u8054\u901a\u57571\u4e2d\n\n2.\u4e24\u4e2a\u7aef\u70b9\u90fd\u5728\u8054\u901a\u57572\u4e2d\n\n3.\u4e24\u4e2a\u7aef\u70b9\u4e00\u4e2a\u5728\u8054\u901a\u57571\uff0c\u53e6\u4e00\u4e2a\u5728\u8054\u901a\u57572\n\n\u5bf9\u4e8e1\u548c2\u6211\u4eec\u6c42\u4e00\u4e2a\u6811\u4e0a\u76f4\u5f84\u5373\u53ef\uff0c\u5bf9\u4e8e\u95ee\u98983\u5462?\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c\u8fde\u63a5\u4e86u\uff0cv\uff0c\u90a3\u4e48\u6700\u957f\u8def\u5c31\u662f u\u5230\u8054\u901a\u57571\u4efb\u610f\u4e00\u70b9\u7684\u6700\u957f\u8ddd\u79bb+val+v\u5230\u8054\u901a\u57572\u7684\u4efb\u610f\u4e00\u70b9\u6700\u957f\u8ddd\u79bb\u3002\u5982\u679c\u6211\u4eec\u9002\u5f53\u7684\u9009\u53d6u\u548cv\uff0c\u4f7f\u5f97\u8fd9\u4e24\u4e2a\u70b9\u7684\u5230\u81ea\u5df1\u8054\u901a\u5757\u7684\u6700\u957f\u8ddd\u79bb\u6700\u5c0f\u3002\u90a3\u4e48\u5c31\u662f\u6700\u4f18\u7684\u51b3\u7b56\u4e86\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u8981\u6c42\u6811\u4e0a\u7684\u534a\u5f84\uff1f\n\n#### \u6811\u4e0a\u534a\u5f84\u6c42\u6cd5\n\n\u9996\u5148\u6211\u4eec\u5148\u505a\u4e00\u8fb9\u6811\u5f62dp\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5b50\u6811\uff0c\u6c42\u51fa\u7ecf\u8fc7\u5b83\u7684\u6700\u957f\u94fe\u548c\u6b21\u957f\u94fe\n\u7136\u540e\u76f4\u5f84\u5c31\u662f\u679a\u4e3e\u6bcf\u4e00\u4e2a\u70b9\uff0c\u5b83\u7684\u6700\u957f\u94fe+\u6b21\u957f\u94fe\u7684\u6700\u5927\u503c\n\n\u90a3\u4e48\u534a\u5f84\u5462\uff1f\u6211\u4eec\u8003\u8651\u4e00\u4ef6\u4e8b\uff0c\u5c31\u662f\u8ddd\u79bb\u5b83\u6700\u8fdc\u7684\u90a3\u4e2a\u70b9\uff0c\u5728\u5b83\u7684\u5b50\u6811\u5185\u8fd8\u662f\u5b50\u6811\u5916\u3002\n\n\u5982\u679c\u5728\u5b50\u6811\u5185\uff0c\u8ddd\u79bb\u5c31\u662f\u7b2c\u4e00\u904ddfs\u6c42\u51fa\u7684\u6700\u957f\u94fe\uff0c\u5982\u679c\u5728\u5b50\u6811\u5916\u7684\u8bdd\uff0c\u6211\u4eec\u5728\u6811\u4e0a\u5728\u505a\u7b2c\u4e8c\u904ddfs\uff0c\u8fd9\u4e2adfs\u989d\u5916\u4f20\u4e00\u4e2afrom\u53c2\u6570\uff0cfrom\u8868\u793a\u8fd9\u4e2a\u5b50\u6811\u4e4b\u5916\u7684\u6700\u957f\u94fe\n\n\u90a3\u4e48\u8fd9\u4e2a\u6700\u957f\u94fefrom\u6709\u4e24\u4e2a\u6765\u6e90\n\n1.\u5b83\u7236\u4eb2\u7684from+\u5b83\u548c\u7236\u4eb2\u7684\u8ddd\u79bb\n\n2.\u5b83\u7236\u4eb2\u7684\u5176\u4ed6\u5b50\u6811\u4e2d\u7684\u6700\u957f\u94fe+\u4ed6\u548c\u7236\u4eb2\u7684\u8ddd\u79bb\n\n\u5bf9\u4e8e\u60c5\u51b5\u4e8c\uff0c\u5982\u679c\u4ed6\u5c31\u662f\u7236\u4eb2\u7684\u6240\u6709\u5b69\u5b50\u4e2d\u7684\u6700\u957f\u94fe\uff0c\u90a3\u4e48\u6211\u4eec\u7684\u60c5\u51b52\u8981\u53d6\u6b21\u957f\u94fe\uff0c\u5982\u679c\u4e0d\u662f\u53d6\u6700\u957f\u94fe\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u7136\u540e\u679a\u4e3e\u6bcf\u4e2a\u70b9\uff0c\u534a\u5f84\u5c31\u662fmin(max(dp\\[i],from\\[i]))\u4e86\n\n\u7136\u540e\u53ea\u9700\u505a4\u904d\u4e00\u534a\u7684dfs\u5373\u53ef\uff0c\u4ee3\u7801\u4e5f\u662f\u975e\u5e38\u7684\u597d\u5199\n\n _(\u5c0f\u6280\u5de7:dfs\u7684\u65f6\u5019\u76f4\u63a5\u628a\u53e6\u4e00\u4e2a\u70b9\u6253\u4e0a\u8bbf\u95ee\u6807\u8bb0\u5373\u53ef\u53eadfs\u4e00\u534a)_ \n \n \u4e0a\u4ee3\u7801~\n \n ```c\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nconst int N=5010;const int INF=0x3f3f3f3f;\nstruct data{int v;int nxt;int val;}edge[2*N];\nint alist[N];int cnt;int n;\ninline void add(int u,int v,int val)\n{edge[++cnt].v=v;edge[cnt].nxt=alist[u];alist[u]=cnt;edge[cnt].val=val;}\nint dp[N];int mv[N];int nxdp[N];bool book[N];int rad=INF;int dis;int res=INF;\nvoid getd(int x)//\u6c42\u76f4\u5f84 \n{\n\tbook[x]=true;int nxt=alist[x];\n\twhile(nxt)\n\t{\n\t\tint v=edge[nxt].v;int val=edge[nxt].val;\n\t\tif(!book[v])\n\t\t{\n\t\t\tgetd(v);int va=dp[v]+val;//\u6700\u957f\u94fe\u548c\u6b21\u957f\u94fe \n\t\t\tif(va>dp[x]){nxdp[x]=dp[x];dp[x]=va;mv[x]=v;}\n\t\t\telse if(va>nxdp[x]){nxdp[x]=va;}\n\t\t}nxt=edge[nxt].nxt;\n\t}dis=max(dis,dp[x]+nxdp[x]);//\u66f4\u65b0\u76f4\u5f84 \n}\nvoid getr(int x,int fr)\n{\n\trad=min(rad,max(fr,dp[x]));//\u66f4\u65b0\u534a\u5f84 \n\tbook[x]=false;int nxt=alist[x];\n\twhile(nxt)\n\t{\n\t\tint v=edge[nxt].v;int val=edge[nxt].val;\n\t\tif(book[v])//\u66f4\u65b0fr\uff0c\u8bb0\u5f97\u7279\u5224\u81ea\u5df1\u5c31\u662f\u6700\u957f\u94fe\u7684\u60c5\u51b5 \n\t\t{\n\t\t\tif(v==mv[x]){getr(v,max(nxdp[x]+val,fr+val));}\n\t\t\telse {getr(v,max(dp[x]+val,fr+val));}\n\t\t}nxt=edge[nxt].nxt;\n\t}\n}//\u6e05\u7a7adp\u7684\u51fd\u6570 \ninline void clear(){for(int i=1;i<=n;i++){dp[i]=mv[i]=nxdp[i]=book[i]=0;}rad=INF;dis=0;}\nint u[N];int v[N];int val[N];\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<n;i++)//\u8bfb\u8fdb\u6765 \n\t{\n\t\tscanf(\"%d%d%d\",&u[i],&v[i],&val[i]);\n\t\tadd(u[i],v[i],val[i]);add(v[i],u[i],val[i]);\n\t}\n\tfor(int i=1;i<n;i++)//\u679a\u4e3e\u8fb9 \n\t{\n\t\tint d1;int d2;int r1;int r2;\n\t\tbook[v[i]]=1;getd(u[i]);d1=dis;//\u6c42\u76f4\u5f84 \n\t\tdis=0;getd(v[i]);d2=dis;//\u6c42\u534a\u5f84 \n\t\tbook[v[i]]=0;getr(u[i],0);r1=rad;//\u6c42\u76f4\u5f84 \n\t\trad=INF;getr(v[i],0);r2=rad;//\u6c42\u534a\u5f84 \n\t\tres=min(res,max(max(d1,d2),r1+r2+val[i]));//\u66f4\u65b0\u7b54\u6848 \n\t\tclear();//\u4e0d\u8981\u5fd8\u8bb0\u6e05\u7a7a \n\t}\n\tprintf(\"%d\",res);return 0;//\u62dc\u62dc\u7a0b\u5e8f~ \n}\n```\n\n\n",
        "postTime": 1520212175,
        "uid": 56384,
        "name": "shadowice1984",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3761 \u3010[TJOI2017]\u57ce\u5e02\u3011"
    },
    {
        "content": "\u663e\u7136\u53ef\u4ee5\u679a\u4e3e\u4e00\u6761\u8fb9\u5220\u9664\uff0c\u518d\u9009\u62e9\u4e24\u4e2a\u7aef\u70b9\u52a0\u8fb9\uff0c\u53d6\u6700\u4f18\u7684\u65b9\u6848\u3002\n\n\u4f46\u8fd9\u6837\u663e\u7136\u662f$O(n^3)$\u8d77\u6b65\u7684\u3002\n\n\u6240\u4ee5\u8003\u8651\u5982\u4f55\u4f18\u5316\u3002\n\n\u9996\u5148\uff0c\u679a\u4e3e\u4e00\u6761\u8fb9\uff0c\u4e8e\u662f\u5df2\u7ecf\u6709\u4e86$O(n)$\u7684\u590d\u6742\u5ea6\u3002\n\n\u7136\u540e\u6211\u4eec\u9009\u62e9\u52a0\u54ea\u6761\u8fb9\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u6539\u53d8\u4e00\u6761\u8fb9\u540e\u6240\u6709\u7684\u8def\u5f84\u53ef\u4ee5\u5206\u4e3a\u4e24\u7c7b\uff1a\n\n1. \u4e0d\u7ecf\u8fc7\u8fd9\u6761\u8fb9\u7684\u8def\u5f84\uff1b\n\n2. \u7ecf\u8fc7\u8fd9\u6761\u8fb9\u7684\u8def\u5f84\u3002\n\n\u7531\u4e8e\u65e0\u8bba\u5982\u4f55\u52a0\u8fb9\uff0c\u7b2c\u4e00\u7c7b\u8def\u5f84\u7684\u6700\u5927\u503c\u90fd\u4e0d\u4f1a\u6539\u53d8\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u6c42\u6811\u7684\u76f4\u5f84\u7684\u65b9\u6cd5\u8f7b\u677e$O(n)$\u6c42\u51fa\u3002\n\n\u91cd\u70b9\u662f\u5982\u4f55\u4f7f\u7b2c\u4e8c\u7c7b\u8def\u5f84\u6700\u4f18\u3002\n\n\u5bb9\u6613\u8bc1\u660e\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728\u5df2\u9009\u62e9\u8fd9\u6761\u8fb9\u6240\u5212\u5206\u7684\u4e24\u4e2a\u5b50\u6811\u5185\u5206\u522b\u9009\u62e9\u4e24\u4e2a\u70b9\uff0c\u4f7f\u5f97\u8fd9\u4e24\u4e2a\u70b9\u80fd\u5230\u8fbe\u7684\u6700\u8fdc\u8ddd\u79bb\u4e4b\u548c\u6700\u5c0f\u5373\u53ef\n\n\u90a3\u4e48\u8003\u8651\u7f16\u5199\u4e24\u4e2a\u51fd\u6570$\\text{dfs1}$\u548c$\\text{dfs2}$\uff1a\n\n## $\\text{dfs1}$\n\n$\\text{dfs1(now)}$\u9700\u8981\u5904\u7406\u51e0\u6837\u5185\u5bb9\uff1a\n\n- $Max1[now]$\u8868\u793a\u8282\u70b9$now$\u5411\u4e0b\u80fd\u62d3\u5c55\u7684\u6700\u957f\u94fe\u7684\u957f\u5ea6\n\n- $Max2[now]$\u8868\u793a\u8282\u70b9$now$\u5411\u4e0b\u80fd\u62d3\u5c55\u7684\u6b21\u957f\u94fe\uff08\u5411\u4e0e\u6700\u957f\u94fe\u4e0d\u540c\u7684\u513f\u5b50\u62d3\u5c55\uff09\u7684\u957f\u5ea6\n\n- \u540c\u65f6\u5904\u7406\u7b2c\u4e00\u7c7b\u8def\u5f84\u7684\u6700\u5927\u503c\n\n\u8fd9\u4e09\u6837\u5185\u5bb9\u90fd\u53ef\u4ee5\u7528\u548c\u6c42\u6811\u7684\u76f4\u5f84\u7c7b\u4f3c\u7684\u65b9\u6cd5\u8f7b\u677e\u6c42\u51fa\n\n## $\\text{dfs2}$\n\n$\\text{dfs2(now)}$\u4e5f\u9700\u8981\u5904\u7406\u51e0\u6837\u5185\u5bb9\uff1a\n\n- $Max0[now]$\u8868\u793a\u8282\u70b9$now$\u5411\u7236\u4eb2\u80fd\u62d3\u5c55\u7684\u6700\u957f\u94fe\u7684\u957f\u5ea6\n\n   \u663e\u7136$Max0[now]$\u53ef\u4ee5\u7531\u4e24\u79cd\u60c5\u51b5\u8f6c\u79fb\u8fc7\u6765\uff1a\n\n     1. $now$\u7684\u7236\u4eb2\u5411\u5b83\u7684\u7236\u4eb2\u62d3\u5c55\u7684\u6700\u5927\u503c\uff08\u5373$Max0[father]$\uff09\n\n     2. $now$\u7684\u7236\u4eb2\u5411$now$\u7684\u5144\u5f1f\u62d3\u5c55\u7684\u6700\u5927\u503c\n\n   \u5bf9\u4e8e\u60c5\u51b52\uff0c\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n     1. \u5f53\u5411\u5b83\u62d3\u5c55\u662f\u6700\u5927\u503c\uff08\u5373\u7b49\u4e8e$Max1$\uff09\u65f6\uff0c\u7b54\u6848\u5c31\u662f\u6b21\u5927\u503c\uff08\u5373$Max2$\uff09\n\n     2. \u5f53\u5411\u5b83\u62d3\u5c55\u4e0d\u662f\u6700\u5927\u503c\uff08\u5373\u4e0d\u7b49\u4e8e$Max1$\uff09\u65f6\uff0c\u7b54\u6848\u5c31\u662f\u6700\u5927\u503c\uff08\u5373$Max1$\uff09\n\n   \u5176\u4e2d\u7684\u6b21\u5927\u503c\u548c\u6700\u5927\u503c\u6211\u4eec\u5df2\u7ecf\u7528$\\text{dfs1}$\u5904\u7406\u597d\u4e86\n\n- $Max[now]$\u8868\u793a\u8282\u70b9$now$\u80fd\u62d3\u5c55\u7684\u6700\u957f\u94fe\u7684\u957f\u5ea6\n\n  $Max[now]$\u53ea\u9700\u8981\u4ee4$Max[now]=max(Max1[now],Max0[now])$\u5373\u53ef\n\n\u6700\u540e\u8fd9\u4e2a\u8282\u70b9\u7684\u8d21\u732e\u5c31\u662f$Max[now]$\u4e86\uff0c\u53d6\u6700\u5c0f\u503c\u8fde\u8fb9\u5373\u53ef\n\n$Code\\ Below$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=5005;\nconst int inf=INT_MAX/2;\n\ninline int read()\n{\n\tregister int s=0;\n\tregister char c=getchar(),lc='+';\n\twhile (c<'0'||'9'<c) lc=c,c=getchar();\n\twhile ('0'<=c&&c<='9') s=s*10+c-'0',c=getchar();\n\treturn lc=='-'?-s:s;\n}\nvoid write(register int x)\n{\n\tif (x<0)\n\t{\n\t\tputchar('-');\n\t\tx=-x;\n\t}\n\tif (x<10) putchar(x+'0');\n\telse\n\t{\n\t\twrite(x/10);\n\t\tputchar(x%10+'0');\n\t}\n}\ninline void print(const register int x,const register char c='\\n')\n{\n\twrite(x);\n\tputchar(c);\n}\nstruct edge\n{\n\tint to,val,nxt;\n}e[2*N];\nint head[N],cnt=0,u[N],v[N],w[N],ans=inf;\nvoid add(int u,int v,int w)\n{\n\te[++cnt].to=v;\n\te[cnt].val=w;\n\te[cnt].nxt=head[u];\n\thead[u]=cnt;\n}\nint Max0[N],Max1[N],Max2[N],Max[N],mxn=0;\nint dfs1(int now,int fa)\n{\n\tMax1[now]=Max2[now]=0;\n\tfor (int i=head[now];i;i=e[i].nxt)\n\tif (e[i].to!=fa)\n\t{\n\t\tint to=e[i].to;\n\t\tint v=e[i].val+dfs1(to,now);\n\t\tif (v>Max1[now])\n\t\t{\n\t\t\tMax2[now]=Max1[now];\n\t\t\tMax1[now]=v;\n\t\t}\n\t\telse\n\t\tif (v>Max2[now]) Max2[now]=v;//\u5904\u7406Max1\u548cMax2\n\t}\n\tmxn=max(mxn,Max1[now]+Max2[now]);//\u6c42\u7b2c\u4e00\u7c7b\u8def\u5f84\u7684\u6700\u5927\u503c\n\treturn Max1[now];\n}\nint dfs2(int now,int fa)\n{\n\tint ret=inf;\n\tMax[now]=max(Max1[now],Max0[now]);//\u5904\u7406Max\uff0c\u56e0\u4e3a\u8ba1\u7b97Max0\u662f\u5728\u7236\u4eb2\u8282\u70b9\u8fdb\u884c\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u5728\u524d\u9762\u5904\u7406\n\tfor (int i=head[now];i;i=e[i].nxt)\n\tif (e[i].to!=fa)\n\t{\n\t\tint to=e[i].to,val=e[i].val;\n\t\tint v=val+Max1[to];\n\t\tif (v==Max1[now]) Max0[to]=max(Max0[now],Max2[now])+val;\n\t\t\t\t\t else Max0[to]=max(Max0[now],Max1[now])+val;//\u5904\u7406Max0\n\t}\n\tfor (int i=head[now];i;i=e[i].nxt)\n\tif (e[i].to!=fa)\n\tret=min(ret,dfs2(e[i].to,now));\n\treturn min(ret,Max[now]);//\u8ba1\u7b97\u7b2c\u4e8c\u7c7b\u8def\u5f84\u7684\u6700\u5927\u503c\n}\n\nint main()\n{\n\tint n=read();\n\tfor (int i=1;i<n;i++)\n\t{\n\t\tu[i]=read();\n\t\tv[i]=read();\n\t\tw[i]=read();\n\t\tadd(u[i],v[i],w[i]);\n\t\tadd(v[i],u[i],w[i]);\n\t}\n\tfor (int i=1;i<n;i++)//\u679a\u4e3e\u8fb9\n\t{\n\t\tmxn=0;\n\t\tfor (int j=1;j<=n;j++) Max0[j]=0;\n\t\tdfs1(u[i],v[i]);\n\t\tdfs1(v[i],u[i]);\n\t\tans=min(ans,max(dfs2(u[i],v[i])+dfs2(v[i],u[i])+w[i],mxn));//\u6c42\u6700\u4f18\u8fde\u8fb9\u65b9\u6848\n\t}\n\tprint(ans);\n\n\treturn 0;\n}\n```",
        "postTime": 1590894428,
        "uid": 61120,
        "name": "QwQcOrZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3761 \u3010[TJOI2017]\u57ce\u5e02\u3011"
    },
    {
        "content": "#### update 2020/7/15 \u4f18\u5316\u4e86\u4e00\u4e0b $markdown$ \u7684\u7528\u6cd5\uff0c\u589e\u52a0\u4e86\u524d\u9762\u7684\u9898\u76ee\u63cf\u8ff0\u3002\n# \u9898\u76ee\uff1a\n### \u9898\u76ee\u63cf\u8ff0\n##### \u4ece\u52a0\u91cc\u6566\u5927\u5b66\u57ce\u5e02\u89c4\u5212\u4e13\u4e1a\u6bd5\u4e1a\u7684\u5c0f\u660e\u6765\u5230\u4e86\u4e00\u4e2a\u5730\u533a\u57ce\u5e02\u89c4\u5212\u5c40\u5de5\u4f5c\u3002\u8fd9\u4e2a\u5730\u533a\u4e00\u5171\u6709 $n$ \u5ea7\u57ce\u5e02\uff0c$n-1$ \u6761\u9ad8\u901f\u516c\u8def\uff0c\u4fdd\u8bc1\u4e86\u4efb\u610f\u4e24\u8fd0\u57ce\u5e02\u4e4b\u95f4\u90fd\u53ef\u4ee5\u901a\u8fc7\u9ad8\u901f\u516c\u8def\u76f8\u4e92\u53ef\u8fbe\uff0c\u4f46\u662f\u901a\u8fc7\u4e00\u6761\u9ad8\u901f\u516c\u8def\u9700\u8981\u6536\u53d6\u4e00\u5b9a\u7684\u4ea4\u901a\u8d39\u7528\u3002\u5c0f\u660e\u5bf9\u8fd9\u4e2a\u5730\u533a\u6df1\u5165\u7814\u7a76\u540e\uff0c\u89c9\u5f97\u8fd9\u4e2a\u5730\u533a\u7684\u4ea4\u901a\u8d39\u7528\u592a\u8d35\u3002\n\n##### \u5c0f\u660e\u60f3\u5f7b\u5e95\u6539\u9020\u8fd9\u4e2a\u5730\u533a\uff0c\u4f46\u662f\u7531\u4e8e\u4e0a\u53f8\u7ed9\u4ed6\u7684\u8d44\u6e90\u6709\u9650\uff0c\u56e0\u800c\u5c0f\u660e\u73b0\u5728\u53ea\u80fd\u5bf9\u4e00\u6761\u9ad8\u901f\u516c\u8def\u8fdb\u884c\u6539\u9020\uff0c\u6539\u9020\u7684\u65b9\u5f0f\u5c31\u662f\u53bb\u6389\u4e00\u6761\u9ad8\u901f\u516c\u8def\uff0c\u5e76\u4e14\u91cd\u65b0\u4fee\u5efa\u4e00\u6761\u4e00\u6837\u7684\u9ad8\u901f\u516c\u8def\uff08\u5373\u4ea4\u901a\u8d39\u7528\u4e00\u6837\uff09\uff0c\u4f7f\u5f97\u8fd9\u4e2a\u5730\u533a\u7684\u4e24\u4e2a\u57ce\u5e02\u4e4b\u95f4\u7684\u6700\u5927\u4ea4\u901a\u8d39\u7528\u6700\u5c0f\uff08\u5373\u4f7f\u5f97\u4ea4\u901a\u8d39\u7528\u6700\u5927\u7684\u4e24\u5ea7\u57ce\u5e02\u4e4b\u95f4\u7684\u4ea4\u901a\u8d39\u7528\u6700\u5c0f\uff09\uff0c\u5e76\u4e14\u4fdd\u8bc1\u4fee\u5efa\u5b8c\u4e4b\u540e\u4efb\u610f\u4e24\u5ea7\u57ce\u5e02\u76f8\u4e92\u53ef\u8fbe\u3002\u5982\u679c\u4f60\u662f\u5c0f\u660e\uff0c\u4f60\u600e\u4e48\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1f\n\n### \u8f93\u5165\u683c\u5f0f\n##### \u8f93\u5165\u6570\u636e\u7684\u7b2c\u4e00\u884c\u4e3a\u4e00\u4e2a\u6574\u6570 $n$\uff0c\u4ee3\u8868\u57ce\u5e02\u4e2a\u6570\u3002\n\n##### \u63a5\u4e0b\u6765\u7684 $n - 1$ \u884c\u5206\u522b\u4ee3\u8868\u4e86\u6700\u521d\u7684 $n - 1$ \u6761\u516c\u8def\u60c5\u51b5\u3002\u6bcf\u4e00\u884c\u90fd\u6709\u4e09\u4e2a\u6574\u6570 $u,v,d$ \u3002$u,v$ \u4ee3\u8868\u8fd9\u6761\u516c\u8def\u7684\u4e24\u7aef\u57ce\u5e02\u6807\u53f7\uff0c$d$ \u4ee3\u8868\u8fd9\u6761\u516c\u8def\u7684\u4ea4\u901a\u8d39\u7528\u3002\n\n##### $ 1 \\leq u,v \\leq $\uff0c $ 1\\leq d \\leq 2000 $\u3002\n\n### \u8f93\u51fa\u683c\u5f0f\n##### \u8f93\u51fa\u6570\u636e\u4ec5\u6709\u4e00\u884c\uff0c\u4e00\u4e2a\u6574\u6570\uff0c\u8868\u793a\u8fdb\u884c\u4e86\u6700\u4f18\u7684\u6539\u9020\u4e4b\u540e\uff0c\u8be5\u5730\u533a\u4e24\u57ce\u5e02 \u4e4b\u95f4\u6700\u5927\u4ea4\u901a\u8d39\u7528\u3002\n\n\u9996\u5148\u7531 $n \\leq 5000 $ ,\u65f6\u95f4\u9650\u5236\u662f $3s$ \u6211\u4eec\u53ef\u4ee5\u786e\u5b9a\u672c\u9898 $O(n^2)$\u53ef\u4ee5\u5361\u8fc7\u53bb\u3002\n\n# \u521d\u6b65\u89e3\u6cd5\n \u6211\u4eec\u5c31\u53ef\u4ee5\u5148\u6709\u4e00\u4e2a $O(n^2)$ \u7684\u66b4\u529b\u89e3\u6cd5\u3002\n ~~\uff08\u8fd9\u4e00\u7248\u57fa\u672c\u662f\u7167\u7740\u67d0\u4e00\u697c\u7684\u9898\u89e3\u6253\u51fa\u6765\u7684\uff09~~\n \u6211\u4eec\u679a\u4e3e\u6bcf\u4e00\u6761\u8fb9\u65ad\u5f00\uff0c\u7136\u540e\u6c42\u8fde\u4e2a\u8054\u901a\u5757\u5404\u81ea\u7684\u76f4\u5f84\uff0c\u4ee5\u53ca\u4e24\u4e2a\u8054\u901a\u5757\u7684\u6700\u77ed\u534a\u5f84\uff0c\u57fa\u672c\u53ef\u4ee5\u8bf4\u662f\u534a\u4e2a\u7eaf\u66b4\u529b\u3002\n ```\nvoid Diameter(const int u)//\u627e\u76f4\u5f84\u7684\u51fd\u6570\n{\t\n\tbook[u] = 1;//\u7528\u6765\u6807\u8bb0\u662f\u5426\u904d\u5386\u8fc7\u3002\n\n\tfor(reg int i = head[u]; i ; i = e[i].next)\n\t\tif(!book[e[i].to])\n\t\t{\n\t\t\tDiameter(e[i].to);\n\t\t\t\n\t\t\tint v = f[e[i].to][0] + e[i].wi;\n\t\t\t\n   \t\t\tif(v > f[u][0]){f[u][1] = f[u][0];f[u][0] = v;mv[u] = e[i].to;}\n   \t\t\t\n   \t\t\telse if(v > f[u][1]){f[u][1] = v;}\n\t\t}\n\tdiameter = Max(diameter,f[u][1] + f[u][0]);//\u5f88\u6807\u51c6\u7684\u4e00\u4e2a\u6c42\u6811\u76f4\u5f84\u7684 DP\u3002\n}\n\nvoid Radius(const int u,const int front)//\u627e\u534a\u5f84\u7684\u51fd\u6570\n{\t// front \u7528\u6765\u8bb0\u5f55\u81ea\u8eab\u5b50\u6811\u5185\u7684\u6700\u77ed\u534a\u5f84\u3002\n\tbook[u] = 0;radius = Min(radius,Max(front,f[u][0]));\n\n\tfor(reg int i = head[u]; i ; i = e[i].next)\n\t\tif(book[e[i].to]) Radius(e[i].to,Max(front,mv[u] == e[i].to ? f[u][1] : f[u][0]) + e[i].wi);\n}\n\n\nint main()\n{\n\tn = Read();\n\t\n\tfor(reg int i = 1; i < n ; ++i) add_edge(Read(),Read(),Read());\n\t\n\tfor(reg int i = 2; i <= tot_edge; i += 2)\n\t{\n\t\tint d1,d2,r1,r2;\n\t\t\n\t\tdiameter = 0;\n\t\t\n\t\tbook[e[i].to]=1;\n\t\t\n\t\tDiameter(e[i^1].to);\n\t\t\n\t\td1 = diameter;\n\t\t\n   \t\tdiameter = 0;\n   \t\t\n\t\tDiameter(e[i].to);\n\t\t\n\t\td2 = diameter;\n\t\t \n   \t\tbook[e[i^1].to]=0;\n   \t\t\n   \t\tradius = INF;\n   \t\t\n\t\tRadius(e[i].to,0);\n\t\t\n\t\tr1 = radius;\n\t\t\n   \t\tradius = INF;\n   \t\t\n\t\tRadius(e[i^1].to,0);\n   \t\t\n\t\tr2 = radius;\n\t\t\n   \t\tAns = Min(Ans,Max(Max(d1,d2),r1+r2+e[i].wi));\n   \t\t\n   \t\tfor(reg int i = 1 ; i <= n; ++i) {f[i][0] = mv[i] = f[i][1] = book[i] = 0;}\n\t}\n\t\n\tprintf(\"%d\",Ans);\n\t\n\treturn 0;\n}\n```\n\n# \u5982\u4f55\u4f18\u5316\uff1f\n\n## \u4f18\u5316\u4e00\uff1a\u65ad\u8fb9\n\u65ad\u7684\u8fb9\u4e00\u5b9a\u5728\u539f\u6765\u6811\u7684\u76f4\u5f84\u4e0a\uff0c\u4e14\u662f\u6811\u6240\u6709\u76f4\u5f84\u7684\u516c\u5171\u8fb9\u3002\n\n\u5bf9\u4e8e\u975e\u76f4\u5f84\u4e0a\u7684\u8fb9\uff0c\u5c31\u7b97\u65ad\u6389\uff0c\u5269\u4e0b\u7684\u4e24\u4e2a\u8054\u901a\u5757\u7684\u76f4\u5f84\u6709\u4e00\u4e2a\u8fd8\u662f\u539f\u6765\u7684\u76f4\u5f84\uff0c\u6240\u4ee5\u5bf9\u5176\u6211\u4eec\u8981\u6c42\u7684\u7b54\u6848\u65e0\u5f71\u54cd\u3002\n\n\u7136\u540e\u76f4\u5f84\u7684\u975e\u516c\u5171\u8fb9\u3002\n![](https://cdn.luogu.com.cn/upload/image_hosting/brn0344g.png)\n\u5982\u56fe\u6811\u7684\u76f4\u5f84\u6709\u4e24\u6761\uff0c $ 1->8 $ \u548c $ 1->9 $ \uff0c\u65ad\u6389 $ 5->6,5->7,6->9,7->8$ \u4e2d\u7684\u4efb\u610f\u4e00\u6761\uff0c\u90fd\u4e0d\u4f1a\u8ba9\u5269\u4e0b\u7684\u4e24\u4e2a\u8054\u901a\u5757\u7684\u76f4\u5f84\u51cf\u5c0f\uff0c\u6240\u4ee5\u5176\u5bf9\u7b54\u6848\u4e5f\u65e0\u5f71\u54cd\u3002\n\uff08\u8fd9\u91cc\u7684\u6027\u8d28\u4f7f\u9009\u539f\u6811\u4efb\u610f\u4e00\u6761\u76f4\u5f84\u8fdb\u884c\u5220\u8fb9\u90fd\u53ef\u4ee5\u627e\u5230\u6b63\u786e\u7b54\u6848\u6240\u5220\u7684\u90a3\u4e00\u6761\u8fb9\uff09\n\n\u7531\u6b64\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u4f18\u5316\uff0c \u65f6\u95f4\u590d\u6742\u5ea6\u662f $ O(nL)$ , $L$ \u662f\u539f\u6811\u76f4\u5f84\u7684\u8fb9\u6570\u3002\n\n```\nvoid dfs(const int u,const int fa)\n{\t\n\tfor(reg int i = head[u]; i ; i = e[i].next)\n\t\tif(e[i].to != fa)\n\t\t{\n\t\t\tdis[e[i].to] = dis[u] + e[i].wi;\n\t\t\t\n\t\t\tmv[e[i].to] = i;\n\t\t\t\n\t\t\tdfs(e[i].to,u);\n\t\t}\n}\n\nvoid Diameter(const int u)\n{\t\n\tbook[u] = 1;\n\n\tfor(reg int i = head[u]; i ; i = e[i].next)\n\t\tif(!book[e[i].to])\n\t\t{\n\t\t\tDiameter(e[i].to);\n\t\t\t\n\t\t\tint v = f[e[i].to][0] + e[i].wi;\n\t\t\t\n   \t\t\tif(v > f[u][0]){f[u][1] = f[u][0];f[u][0] = v;mv[u] = e[i].to;}\n   \t\t\t\n   \t\t\telse if(v > f[u][1]){f[u][1] = v;}\n\t\t}\n\tdiameter = Max(diameter,f[u][1] + f[u][0]);\n}\n\nvoid Radius(const int u,const int front)\n{\t\n\tbook[u] = 0;radius = Min(radius,Max(front,f[u][0]));\n\n\tfor(reg int i = head[u]; i ; i = e[i].next)\n\t\tif(book[e[i].to]) Radius(e[i].to,Max(front,mv[u] == e[i].to ? f[u][1] : f[u][0]) + e[i].wi);\n}\n\n\nint main()\n{\n\tn = Read();\n\t\n\tfor(reg int i = 1; i < n ; ++i) add_edge(Read(),Read(),Read());\n\t\n\tdfs(1,1);\n\t\n\tfor(reg int i = 1; i <= n ; ++i) if(dis[S] < dis[i]) S = i;\n\t\n\tdis[S] = 0;\n\t\n\tfor(reg int i = 1; i <= n ; ++i) mv[i] = 0;\n\t\n\tdfs(S,S);\n\t\n\tfor(reg int i = 1; i <= n ; ++i) if(dis[T] < dis[i]) T = i;\n\t\n\tfor(reg int i = mv[T]; i ; i = mv[e[i^1].to])  \n\t\tded[++tde] = i;\n\t\n\tfor(reg int i = 1; i <= n ; ++i) mv[i] = 0;\n\t\n\tfor(reg int i = 1; i <= tde; i++)//\u53ef\u4f18\u5316\uff0c\u53ea\u5220\u76f4\u5f84 \n\t{\n\t\tint d1,d2,r1,r2;\n\t\t\n\t\tdiameter = 0;\n\t\t\n\t\tbook[e[ded[i]].to]=1;\n\t\t\n\t\tDiameter(e[ded[i]^1].to);\n\t\t\n\t\td1 = diameter;\n\t\t\n   \t\tdiameter = 0;\n   \t\t\n\t\tDiameter(e[ded[i]].to);\n\t\t\n\t\td2 = diameter;\n\t\t \n   \t\tbook[e[ded[i]^1].to]=0;\n   \t\t\n   \t\tradius = INF;\n   \t\t\n\t\tRadius(e[ded[i]].to,0);\n\t\t\n\t\tr1 = radius;\n\t\t\n   \t\tradius = INF;\n   \t\t\n\t\tRadius(e[ded[i]^1].to,0);\n   \t\t\n\t\tr2 = radius;\n\t\t\n   \t\tAns = Min(Ans,Max(Max(d1,d2),r1+r2+e[ded[i]].wi));\n   \t\t\n   \t\tfor(reg int i = 1 ; i <= n; ++i) {f[i][0] = mv[i] = f[i][1] = book[i] = 0;}\n\t}\n\t\n\tprintf(\"%d\",Ans);\n\t\n\treturn 0;\n}\n```\n\n### \u4f18\u5316\u6548\u679c\uff1a\n\u4ece $ 17.55s -> 1.61s $,\u6302\u4e86\u6c27\u6c14\u80fd\u8fbe\u5230 $871ms$ \u3002\n\n### [$O(n^2)$](https://www.luogu.com.cn/record/35031836)\n\n### [$O(nL)$](https://www.luogu.com.cn/record/35032620)\n\n### [\u6c27\u6c14](https://www.luogu.com.cn/record/35038614)\n\n## \u4f18\u5316\u4e8c\uff1a\u8fde\u8fb9\n\n $1.$ 2\u5982\u679c\u8fde\u7684\u662f\u76f4\u5f84\u4e0a\u7684\u70b9\uff0c\u90a3\u4e48\u53ef\u4ee5\u786e\u5b9a\u65b0\u6811\u7684\u76f4\u5f84\u662f\u4e24\u4e2a\u8054\u901a\u5757\u76f4\u5f84\u4e0a\u7684\u8f83\u957f\u94fe\u76f8\u52a0\uff0c\u4e3a\u4e86\u4f7f\u5176\u5c3d\u53ef\u80fd\u77ed\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u8fde\u4e24\u4e2a\u8054\u901a\u5757\u76f4\u5f84\u7684\u4e2d\u70b9\u6765\u4f7f\u8f83\u957f\u94fe\u66f4\u77ed\u3002\n\n $2.$ \u5982\u679c\u8fde\u7684\u4e0d\u662f\u76f4\u5f84\u4e0a\u7684\u70b9\uff0c\u90a3\u4e48\u53ef\u4ee5\u786e\u5b9a\u65b0\u6811\u7684\u76f4\u5f84\u662f\u4e24\u4e2a\u8054\u901a\u5757\u76f4\u5f84\u4e0a\u7684\u8f83\u957f\u94fe\u76f8\u52a0\u5728\u52a0\u4e0a\u8fde\u63a5\u70b9\u5230\u5404\u81ea\u76f4\u5f84\u7684\u8ddd\u79bb\uff0c\u662f\u4e00\u5b9a\u957f\u4e8e \u65b9\u6848 $1$ \u7684\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u5199\u4e00\u4e2a\u627e\u76f4\u5f84\u4e2d\u70b9\u7684\u51fd\u6570\u4ee3\u66ff\u4e0a\u6587\u4e2d\u627e\u534a\u5f84\u7684\u51fd\u6570\u3002\n\n\u8fd9\u4e2a\u51fd\u6570\u65f6\u95f4\u590d\u6742\u5ea6\u5f88\u96be\u7b97\uff0c\u59d1\u4e14\u53ef\u5f53\u505a $\\Omega(1)$ \uff0c\u5361\u4e00\u5361\u5c31\u53d8 $O\uff08L\uff09$  \u4e86\u3002\n\n\u53ef\u4ee5\u8bc1\u660e\u7684\u662f\u8054\u901a\u5757\u4e0a\u7684\u76f4\u5f84\u4e00\u5b9a\u6709\u4e00\u534a\u4ee5\u4e0a\u7684\u957f\u5ea6\u662f\u4e0e\u539f\u6811\u76f4\u5f84\u91cd\u5408\u7684\uff08\u53ea\u9700\u8981\u7406\u89e3\u4e00\u4e0b\u4e0a\u6587\u7528 $DP$ \u6c42\u76f4\u5f84\u7684\u505a\u6cd5)\uff0c\u53ef\u4ee5\u7528\u8fd9\u4e2a\u6027\u8d28\u6765\u627e\u4e2d\u70b9\u3002\n\n~~\u8fd9\u4e2a\u4f18\u5316\u4ee3\u7801\u6211\u6ca1\u5355\u72ec\u5199~~\n\n```\n\t\tint rt=0,lt=0,Half = ans>>1,cur;\n\t\t\n\t\tcur = i;\n\t\t\n\t\twhile(dp[cur][0] - WW[cur] > Half && cur) cur = mvv[cur];\n\t\t\n\t\trt = dp[cur][0];\n\t\t\n\t\tcur = mv[i];\n\t\t\n\t\tHalf = (f[mv[i]][0] + f[mv[i]][1])>>1;\n\t\t\n\t\twhile(f[cur][0] - W[cur]> Half && cur) cur = mv[cur];\n\t\t\n\t\tlt = f[cur][0];\n\t\t\n\t\tans = Max(ans,W[i] + lt + rt);\n```\n\n\n## \u7ec8\u6781\u4f18\u5316 \n~~\u8c03\u4e86\u5f88\u4e45\u4e5f\u6ca1\u8c03\u51fa\u6765\u3002~~\n\n\u6211\u4eec\u5728\u76f4\u5f84\u4e0a\u904d\u5386\u5220\u8fb9\u7684\u65f6\u5019\uff0c\u4e0d\u96be\u53d1\u73b0\u505a\u4e86\u5f88\u591a\u7684\u91cd\u590d\u7684\u904d\u5386\u3002\n![](https://cdn.luogu.com.cn/upload/image_hosting/fug1umam.png?x-oss-process=image/resize,m_lfit,h_1700,w_2250)\n\n### \u9ec4\u8272\u662f\u65ad\u4e86\u7684\u8fb9\u3002\n\n### \u5bf9\u4e8e\u65ad\u8fb9\u5de6\u4fa7\uff1a\u4ece\u4e0a\u5f80\u4e0b\u7684\u8fc7\u7a0b\u4e2d\uff0c\u7ea2\u8272\u7684\u70b9\u8fdb\u884c\u4e86\u591a\u4f59\u7684\u904d\u5386\uff0c\u53ea\u6709\u6a59\u8272\u7684\u70b9\u624d\u662f\u9700\u8981\u904d\u5386\u7684\u3002\n### \u5bf9\u4e8e\u65ad\u8fb9\u53f3\u4fa7\uff1a\u6211\u4eec\u53d1\u73b0\u82e5\u662f\u4ece\u6700\u5de6\u8fb9\u7684\u70b9\u8fdb\u884c\u7b2c\u4e00\u6b21\u904d\u5386\uff0c\u90a3\u4e48\u6211\u4eec\u4fbf\u5df2\u7ecf\u5f97\u5230\u4e86\u53f3\u8054\u901a\u5757\u9700\u8981\u7684\u6240\u6709\u4fe1\u606f\u3002\n\u5728\u627e\u53f3\u8fb9\u76f4\u5f84\u7684\u8fc7\u7a0b\u90fd\u662f\u53ef\u4ee5\u901a\u8fc7 $O(n)$ \u9884\u5904\u7406\u53d8\u6210 $O(1)$ \u7684\u3002\n\n\u5728\u627e\u5de6\u8fb9\u76f4\u5f84\u7684\u8fc7\u7a0b\u53ef\u4ee5\u7528 $book$ \u6570\u7ec4\u6807\u8bb0\uff0c\u4e0d\u91cd\u590d\u904d\u5386\uff0c\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u6574\u4f53 $O(n)$\u7684\u3002\n\n\u6700\u7ec8\u52a0\u4e0a\u8fde\u8fb9\u7684\u4f18\u5316\u662f\u53ef\u4ee5\u8fbe\u5230 $\\Omega(n)$\uff1f\n\n\u9700\u8981\u7279\u522b\u6ce8\u610f\u7684\u662f\uff0c\u4f1a\u6709\u7279\u6b8a\u7684\u6570\u636e\u5982\u56fe\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/241knedn.png?x-oss-process=image/resize,m_lfit,h_1700,w_2250)\n\n\u5c31\u662f\u5982\u56fe\u6240\u793a\uff0c\u5220\u53bb $6 -> 1$ \u7684\u8fb9\u540e\u6700\u957f\u94fe\u4e0d\u7ecf\u8fc7 $1$ \u70b9\uff0c\u8fd9\u9700\u8981\u7279\u6b8a\u5904\u7406\u3002\n\u5373\u65ad\u7684\u8fb9\u7684\u7aef\u70b9\u4e0d\u4e00\u5b9a\u5728\u65ad\u8fb9\u540e\u8054\u901a\u5757\u7684\u76f4\u5f84\u4e0a\u3002\n\n\u6211\u7684\u60f3\u6cd5\u5c31\u662f\u5148\u627e\u5230\u6700\u957f\u94fe\u7684\u4e24\u4e2a\u7aef\u70b9\uff0c\u518d\u5206\u522b\u4ece\u4e24\u4e2a\u7aef\u70b9\u8dd1\u4e00\u6b21 $dfs$ \u3002\n\n\u8981\u8bb0\u5f55\u4e24\u4e2a\u4e1c\u897f\u3002\n\n\u5f53\u524d\u5b50\u6811\u76f4\u5f84\u3002\n\n\u636e\u5f53\u524d\u5b50\u6811\u6839\u8282\u70b9\u6700\u8fd1\u7684\u76f4\u5f84\u4e0a\u7684\u8282\u70b9\u3002\n\n```\nvoid dfs1(const int u,const int fa)\n{\t\n\tfor(reg int i = head[u]; i ; i = e[i].next)\n\t\tif(e[i].to != fa)\n\t\t{\n\t\t\tdfs1(e[i].to,u);\n\t\t\t\n\t\t\tint v = f[e[i].to][0] + e[i].wi;\n\t\t\t\n   \t\t\tif(v > f[u][0]){f[u][1] = f[u][0];f[u][0] = v;mv[u] = e[i].to;W[u] = e[i].wi;}\n   \t\t\t\n   \t\t\telse if(v > f[u][1]){f[u][1] = v;}\n   \t\t\t\n   \t\t\tA[u] = Max(A[u],A[e[i].to]);\n\t\t}\n\t\tA[u] = Max(A[u],f[u][1] + f[u][0]);\n}\n\nvoid dfs(const int u,const int fa)\n{\t\n\tfor(reg int i = head[u]; i ; i = e[i].next)\n\t\tif(e[i].to != fa)\n\t\t{\n\t\t\tdfs(e[i].to,u);\n\t\t\t\n\t\t\tint v = dp[e[i].to][0] + e[i].wi;\n\t\t\t\n   \t\t\tif(v > dp[u][0]){dp[u][1] = dp[u][0];dp[u][0] = v;mvv[u] = e[i].to;WW[u] = e[i].wi;}\n   \t\t\t\n   \t\t\telse if(v > dp[u][1]){dp[u][1] = v;}\n   \t\t\t\n   \t\t\tB[u] = Max(B[u],B[e[i].to]);\n\t\t}\n\t\tB[u] = Max(B[u],dp[u][1] + dp[u][0]);\n}\n\n\n```\n\n#### \u8bb0\u5f55\u6bcf\u4e00\u4e2a\u5b50\u6811\u7684\u6700\u957f\u94fe\uff0c\u6b21\u957f\u94fe\uff0c\u7136\u540e\u65ad\u7684\u8fb9\u79fb\u52a8\uff0c\u4f46\u662f\u4e0d\u7528 $DP$ \u4e86\uff0c\u53ef\u4ee5\u76f4\u63a5\u4ece\u6570\u7ec4\u4e2d\u627e\u5230\u5f53\u524d\u60c5\u51b5\u4e0b\u5404\u8054\u901a\u5757\u7684\u76f4\u5f84\uff0c\u6700\u540e\u627e\u4e00\u4e0b\u5bf9\u5e94\u76f4\u5f84\u4e2d\u70b9\u5c31\u53ef\u4ee5\u627e\u5230\u7b54\u6848\u4e86\u3002\n",
        "postTime": 1594437451,
        "uid": 222127,
        "name": "\u4e91\u5c81\u6708\u4e66",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3761 \u3010[TJOI2017]\u57ce\u5e02\u3011"
    },
    {
        "content": "\u9898\u610f:https://www.luogu.org/problem/P3761\n\n$O(n)$\u679a\u4e3e\u65ad\u54ea\u6761\u8fb9,\u4e4b\u540e\u8003\u8651\u8fde\u54ea\u4e24\u4e2a\u70b9\u4f7f\u5f97\u4e24\u70b9\u95f4\u6700\u5927\u8ddd\u79bb\u6700\u5c0f\n\n\u5047\u5982\u6211\u4eec\u8fde\u63a5\u4e86$(u,v)$,\u90a3\u4e48\u8003\u8651\u6700\u5927\u503c\u6709\u54ea\u4e9b\u53ef\u80fd:\n\n1.$u$\u6240\u5728\u8054\u901a\u5757\u7684\u76f4\u5f84\n\n2.$v$\u6240\u5728\u8fde\u901a\u5757\u7684\u76f4\u5f84\n\n3.$u$\u6240\u5728\u8fde\u901a\u5757\u4e2d\u5230$u$\u6700\u5927\u8ddd\u79bb+$v$\u6240\u5728\u8fde\u901a\u5757\u4e2d\u5230$v$\u6700\u5927\u8ddd\u79bb+$w(u,v)$\n\n\u524d\u9762\u4e24\u4e2a\u76f4\u63a5\u6811\u7684\u76f4\u5f84,\u8003\u6700\u540e\u4e00\u4e2a\n\n\u8bbe$h[x]$\u8868\u793a$x$\u7684\u8fde\u901a\u5757\u5230$x$\u7684\u6700\u5927\u8ddd\u79bb,\u6211\u4eec\u663e\u7136\u8981\u8fde\u63a5$u$\u548c$v$\u7684\u8fde\u901a\u5757\u4e2d$h[]$\u6700\u5c0f\u7684\u4e24\u4e2a\n\n\u8003\u8651$h[x]$\u7684\u53d6\u503c\u53ef\u80fd:\n\n1.$f[x]$\u8868\u793ax\u7684\u5b50\u6811\u4e2d\u6700\u957f\u94fe,\u8fd9\u4e2a\u5728\u6c42\u76f4\u5f84\u65f6\u5df2\u7ecf\u6c42\u51fa\u6765\u4e86\n\n2.\u5047\u8bbe$z$\u662f$x$\u7684\u7236\u4eb2\u8282\u70b9,z\u5b50\u6811\u4e2d\u9664\u4e86\u5305\u542bx\u7684\u5b50\u6811\u7684\u6700\u957f\u94fe+w(z,x)\n\n3.\u5047\u8bbe$z$\u662f$x$\u7684\u7236\u4eb2\u8282\u70b9,\u9664\u4e86z\u7684\u5b50\u6811\u5916\u5230z\u6700\u957f\u94fe+w(z,x)\n\n\u5728\u6c42\u76f4\u5f84\u65f6\u6c42\u51fa$f[x]$\u8868\u793ax\u7684\u5b50\u6811\u4e2d\u6700\u957f\u94fe\u548c$g[x]$x\u7684\u5b50\u6811\u4e2d\u6b21\u957f\u94fe,$maxson[x]$\u8868\u793a\u542b\u6709x\u7684\u5b50\u6811\u4e2d\u6700\u957f\u94fe\u7684x\u7684\u513f\u5b50\u7684\u4f4d\u7f6e,\u4e4b\u540e\u518ddfs\u4e00\u904d\u5373\u53ef\n\ncode:\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=5010;\nint n,cnt=1,ans=453533453,tmp;\nint head[maxn],f[maxn],g[maxn],maxson[maxn];\nbool check[maxn<<1];\nstruct edge{int to,nxt,dis;}e[maxn<<1];\ninline void add(int u,int v,int w){e[++cnt].nxt=head[u];head[u]=cnt;e[cnt].to=v;e[cnt].dis=w;}\nvoid dfs1(int x,int fa)\n{\n\tfor(int i=head[x];i;i=e[i].nxt)\n\t{\n\t\tint y=e[i].to;\n\t\tif(y==fa||check[i])continue;\n\t\tdfs1(y,x);\n\t\ttmp=max(tmp,f[x]+f[y]+e[i].dis);\n\t\tif(f[y]+e[i].dis>f[x])g[x]=f[x],f[x]=f[y]+e[i].dis,maxson[x]=y;\n\t\telse if(f[y]+e[i].dis>g[x])g[x]=f[y]+e[i].dis;\n\t}\n}\nvoid dfs2(int x,int fa,int maxx)\n{\n\ttmp=min(tmp,max(maxx,f[x]));\n\tfor(int i=head[x];i;i=e[i].nxt)\n\t{\n\t\tint y=e[i].to;\n\t\tif(y==fa||check[i])continue;\n\t\tif(maxson[x]==y)dfs2(y,x,max(g[x]+e[i].dis,maxx+e[i].dis));\n\t\telse dfs2(y,x,max(f[x]+e[i].dis,maxx+e[i].dis));\n\t}\n}\ninline void init()\n{\n\tmemset(f,0,sizeof(f));\n\tmemset(g,0,sizeof(g));\n\tmemset(maxson,0,sizeof(maxson));\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tint u,v,w;scanf(\"%d%d%d\",&u,&v,&w);\n\t\tadd(u,v,w);add(v,u,w);\n\t}\n\tfor(int i=2;i<=cnt;i+=2)\n\t{\n\t\tinit();\n\t\tint d1,d2,d3,d4,x=e[i].to,y=e[i^1].to;\n\t\tcheck[i]=check[i^1]=1;\n\t\ttmp=0,dfs1(x,0);d1=tmp;\n\t\ttmp=0,dfs1(y,0);d2=tmp;\n\t\ttmp=42342344,dfs2(x,0,0);d3=tmp;\n\t\ttmp=42342344,dfs2(y,0,0);d4=tmp;\n\t\tans=min(ans,max(max(d1,d2),d3+d4+e[i].dis));\n\t\tcheck[i]=check[i^1]=0;\n\t}\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1571659382,
        "uid": 145441,
        "name": "nofind",
        "ccfLevel": 6,
        "title": "P3761 [TJOI2017]\u57ce\u5e02(\u6811\u5f62DP)"
    },
    {
        "content": "## \u77e5\u8bc6\u70b9\n\n- \u6811\u7684\u76f4\u5f84\n\n- \u6362\u6839$dp$\n\n## \u601d\u8def\n\n\u9898\u76ee\u8f6c\u5316\u4e3a\u91cd\u8fde\u4e00\u6761\u8fb9\u4f7f\u5f97\u65b0\u76f4\u5f84\u6700\u5c0f\u3002\n\n\u53d1\u73b0 $n$ \u5e76\u4e0d\u5927\u4e14\u8fd9\u9053\u9898\u5e76\u4e14\u770b\u4e0d\u51fa\u4ec0\u4e48\u660e\u663e\u7684\u6027\u8d28\uff0c\u8003\u8651\u679a\u4e3e\u65ad\u8fb9\uff0c$O(n)$\u3002\n\n\u6211\u4eec\u77e5\u9053\u8fd9\u79cd\u4e24\u68f5\u5b50\u6811\u5408\u5e76\u540e\u7684\u65b0\u76f4\u5f84\u8981\u5206\u8fc7\u8fde\u8fb9\u548c\u5728\u4e24\u68f5\u539f\u5b50\u6811\u4ea7\u751f\uff0c\u4e00\u5171\u4e09\u79cd\u60c5\u51b5\uff0c\u4e24\u5b50\u6811\u7684\u76f4\u5f84\u53ef\u4ee5 $O(n)$ \u5f97\u5230\uff0c\u90a3\u4e48\u95ee\u9898\u5c31\u5728\u8fc7\u4e2d\u95f4\u7684\u76f4\u5f84\u3002\n\n\u4e00\u79cd\u663e\u7136\u7684 $O(n ^ 3)$ \u66b4\u529b\uff1a$O(n ^ 2)$ \u9884\u5904\u7406\u51fa\u6bcf\u4e2a\u70b9\u4e3a\u4e3a\u7aef\u70b9\uff0c\u5728\u5b50\u6811\u4e2d\u7684\u6700\u957f\u94fe\u957f\u5ea6\uff0c\u518d $O(n ^ 2)$ \u679a\u4e3e\u8fde\u8fb9\u7684\u4e24\u7aef\u70b9\u6c42\u89e3\u3002\n\n\u4ed4\u7ec6\u89c2\u5bdf\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u4e24\u5b50\u6811\u4e92\u4e0d\u5f71\u54cd\uff0c\u5982\u679c\u80fd\u5feb\u901f\u627e\u5230\u4e24\u4e2a\u70b9\uff0c\u4f7f\u5f97\u5728\u5404\u81ea\u5b50\u6811\u4e2d\uff0c\u4ee5\u81ea\u8eab\u4e3a\u8d77\u70b9\u7684\u6700\u957f\u94fe\u90fd\u6700\u5c0f\uff0c\u90a3\u4e48\u8fd9\u4e00\u5b9a\u662f\u5728\u5f53\u524d\u65ad\u8fb9\u4e0a\u7684\u6700\u4f18\u65b9\u6848\u3002\n\n\u600e\u4e48\u627e\u5462\uff1f\u6211\u4eec\u8003\u8651\u7c7b\u4f3c\u6811\u7684\u91cd\u5fc3\u7684\u601d\u8def\uff0c\u6267\u884c\u6362\u6839\u6765\u679a\u4e3e\uff0c\u6700\u957f\u94fe\u8981\u4e48\u8fc7\u7236\u4eb2\uff0c\u8981\u4e48\u8fc7\u513f\u5b50\u3002\u8fc7\u513f\u5b50\u7684\u5199\u6cd5\u548c\u6c42\u76f4\u5f84\u5b8c\u5168\u4e00\u81f4\u3002\u8fc7\u7236\u4eb2\u65f6\uff0c\u663e\u7136\u662f\u8fc7\u7236\u4eb2\u4e14\u4e0d\u8fc7\u513f\u5b50\u7684\u6700\u957f\u94fe $+$ \u7236\u5b50\u8fde\u8fb9\u957f\u5ea6\uff0c\u8fdb\u4e00\u6b65\u8f6c\u5316\u4e3a\uff0c\u4ece\u7237\u7237\u8282\u70b9\u4f38\u4e0b\u6765\uff0c\u6216\u8005\u4ece\u5144\u5f1f\u8282\u70b9\u62d0\u8fc7\u6765\u3002\u90a3\u4e48\u6362\u6839\u65f6\uff0c\u9664\u4e86\u94fe\u6700\u957f\u7684\u513f\u5b50\uff0c\u6211\u4eec\u90fd\u5e94\u4f20\u4e0b $max(len_{father},max{len_{son}})$\uff0c\u94fe\u6700\u957f\u7684\u513f\u5b50\u4f20\u4e0b\u6b21\u957f\u94fe\u5373\u53ef\u3002\n\n\u8bf7\u770b\u4ee3\u7801\uff0c\u6ce8\u610f\u4e0d\u8981\u6f0f\u7edf\u8ba1\u8fb9\u3002\n\n## Code\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nnamespace input {\n\tbool Sign;\n\ttemplate <typename T>\n\t\n\tinline void read(T &a) {\n\t\tregister char ch = getchar();\n\t\twhile(!isdigit(ch) && ch != '-') ch = getchar();\n\t\ta = (Sign = (ch == '-')) ? 0 : ch - 48;\n\t\twhile(isdigit(ch = getchar())) a = a * 10 + ch - 48;\n\t\ta = Sign ? -a : a;\n\t}\n}\nusing input::read;\n\n#define match(x) (x == cut || x == (cut ^ 1))\n\nconst int INF = 1 << 30;\nconst int N = 5e3 + 5;\nint n, cut, DIA, c[N];\nint tot = 1, head[N], nex[N << 1], ver[N << 1], edge[N << 1];\n\ninline void addEdge(int x, int y, int z) {\n\tver[++tot] = y, edge[tot] = z, nex[tot] = head[x], head[x] = tot;\n}\n\nint diameter(int now, int fa) {\n\tint Mx = 0;\n\tfor(int u = head[now]; u; u = nex[u])\n\t\tif(ver[u] != fa && !match(u)) {\n\t\t\tint y = diameter(ver[u], now) + edge[u];\n\t\t\tDIA = max(DIA, y + Mx), Mx = max(Mx, y);\n\t\t}\n\tc[now] = Mx;\n\treturn Mx;\n}\n\nint dp(int now, int fa, int len) {\n\tint Mx1 = 0, Mx2 = 0, p1; // c[Mx1] > c[Mx2]\n\tfor(int u = head[now]; u; u = nex[u]) {\n\t\tif(match(u)) continue;\n\t\tint y = ver[u];\n\t\tif(y == fa) continue;\n\t\tif(c[y] + edge[u] > Mx1) swap(Mx1, Mx2), Mx1 = c[y] + edge[u], p1 = u;\n\t\telse if(c[y] + edge[u] > Mx2) Mx2 = c[y] + edge[u];\n\t}\n\t//printf(\"\t%d %d %d %d\\n\", now, len, c[Mx1], c[Mx2]);\n\tint ans = max(len, Mx1);\n\tfor(int u = head[now]; u; u = nex[u]) {\n\t\tif(match(u)) continue;\n\t\tint y = ver[u];\n\t\tif(y == fa) continue;\n\t\tint t;\n\t\tif(y == ver[p1]) t = dp(y, now, max(len, Mx2) + edge[u]);\n\t\telse t = dp(y, now, max(len, Mx1) + edge[u]);\n\t\tans = min(ans, t);\n\t}\n\treturn ans;\n}\n\nint main() {\n\tfreopen(\"data.in\", \"r\", stdin);\n\t//freopen(\"city.out\", \"w\", stdout);\n\t\n\tread(n);\n\tfor(int i = 1; i < n; ++i) {\n\t\tint x, y, z; read(x), read(y), read(z);\n\t\taddEdge(x, y, z), addEdge(y, x, z);\n\t}\n\t\n\tint ans = INF;\n\tfor(int i = 1; i < n; ++i) {\n\t\tcut = i << 1;\n\t\tDIA = 0, diameter(ver[cut], 0), diameter(ver[cut ^ 1], 0);\n\t\tint d1 = dp(ver[cut], 0, 0), d2 = dp(ver[cut ^ 1], 0, 0);\n\t\t//printf(\"%d %d\t%d %d\\n\", ver[cut], ver[cut ^ 1], d1, d2);\n\t\t//for(int j = 1; j <= n; ++j) printf(\"%d \", c[j]); puts(\"\");\n\t\tans = min(ans, max(DIA, d1 + d2 + edge[cut]));\n\t}\n\t\n\tprintf(\"%d\\n\", ans);\n\t\n\treturn 0;\n}\n```\n",
        "postTime": 1573568458,
        "uid": 75520,
        "name": "Merc03",
        "ccfLevel": 7,
        "title": "[P3761 / TJOI2017]\u57ce\u5e02"
    },
    {
        "content": "> \u65f6\u95f4\u590d\u6742\u5ea6$O(n^2)$\u7684\u505a\u6cd5\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\u4f46\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u4f18\u5316\u5230$O(n)$\u3002\u672c\u6587\u5c06\u5206\u522b\u4ecb\u7ecd\u8fd9\u4e24\u79cd\u505a\u6cd5\u3002\n\n### $O(n^2)$\u505a\u6cd5\n\n\u6211\u4eec\u628a\u6811\u4e0a\u8ddd\u79bb\u6700\u5927\u7684\u4e00\u5bf9\u70b9\uff0c\u79f0\u4e3a\u6811\u7684\u76f4\u5f84\u3002\n\n\u679a\u4e3e\u65ad\u6389\u54ea\u6761\u8fb9\uff0c\u8bbe\u65ad\u6389\u7684\u8fb9\u4e3a$(u,v)$\u3002\u90a3\u4e48\u6811\u5c31\u88ab\u5206\u6210\u4e86\u5305\u542b$u$\u7684\u8fde\u901a\u5757\u548c\u5305\u542b$v$\u7684\u8fde\u901a\u5757\uff0c\u8fd9\u4e24\u90e8\u5206\u3002\u518d\u8fde\u8fb9\u65f6\uff0c\u65b0\u8fb9\u7684\u4e24\u4e2a\u7aef\u70b9\uff0c\u4e00\u5b9a\u5206\u522b\u4f4d\u4e8e\u4e24\u4e2a\u8fde\u901a\u5757\u91cc\uff0c\u8bb0\u8fd9\u4e24\u4e2a\u7aef\u70b9\u4e3a$(u',v')$\u3002\u65b0\u6811\u7684\u76f4\u5f84\uff0c\u53ef\u80fd\u6709\u4e09\u79cd\u60c5\u51b5\uff1a\n\n1. $u$\u6240\u5728\u8fde\u901a\u5757\u7684\u76f4\u5f84\u3002\n2. $v$\u6240\u5728\u8fde\u901a\u5757\u7684\u76f4\u5f84\u3002\n3. \u3010$u$\u6240\u5728\u8fde\u901a\u5757\u91cc\uff0c\u4e0e$u'$\u8ddd\u79bb\u6700\u5927\u7684\u70b9\u7684\u8ddd\u79bb\u3011+\u3010\u8fb9$(u,v)$\u7684\u957f\u5ea6\u3011+\u3010$v$\u6240\u5728\u8fde\u901a\u5757\u91cc\uff0c\u4e0e$v'$\u8ddd\u79bb\u6700\u5927\u7684\u70b9\u7684\u8ddd\u79bb\u3011\u3002\n\n\u524d\u4e24\u4e2a\u60c5\u51b5\uff0c\u957f\u5ea6\u662f\u5df2\u7ecf\u786e\u5b9a\u7684\uff0c\u4e0e\u6211\u4eec\u5982\u4f55\u9009\u62e9$u',v'$\u65e0\u5173\u3002\u53ef\u4ee5\u5148\u5c06\u524d\u4e24\u4e2a\u60c5\u51b5\u7684\u957f\u5ea6\u6c42\u51fa\u6765\u3002\u7b2c3\u4e2a\u60c5\u51b5\uff0c\u53d1\u73b0$u'$, $v'$\u7684\u9009\u62e9\u662f\u4e92\u4e0d\u5f71\u54cd\u7684\uff0c\u53ef\u4ee5\u5206\u522b\u6c42\u6700\u5c0f\u503c\u3002\u4e8e\u662f\u95ee\u9898\u8f6c\u5316\u4e3a\uff0c\u6709\u4e00\u68f5\u6811\uff08\u4e5f\u5c31\u662f$u$\u6216$v$\u6240\u5728\u7684\u8fde\u901a\u5757\uff09\uff0c\u8bf7\u4f60\u6c42\u4e00\u4e2a\u70b9$x$\uff0c\u4f7f\u5f97\u6811\u4e0a\u6240\u6709\u70b9\u5230$x$\u7684\u6700\u5927\u8ddd\u79bb\u6700\u5c0f\u3002\n\n\u5148\u968f\u4fbf\u9009\u4e00\u4e2a\u70b9\u4f5c\u4e3a\u6839\uff08\u5728\u5177\u4f53\u5b9e\u73b0\u65f6\uff0c\u4e0d\u59a8\u5c31\u9009$u$\u548c$v$\uff09\u3002\u6c42\u51fa\u201c\u6811\u4e0a\u201d\u6240\u6709\u70b9\u5230\u6839\u7684\u6700\u5927\u8ddd\u79bb\u3002\u7136\u540e\u6362\u6839\uff0c\u8fd9\u6837\u5c31\u80fd\u6c42\u51fa\u4ee5\u6bcf\u4e2a\u70b9\u4e3a\u6839\u7684\u60c5\u51b5\uff0c\u7136\u540e\u53d6\u6700\u5c0f\u7684\u5373\u53ef\u3002\u4e3a\u4e86\u6362\u6839\uff0c\u6211\u4eec\u8981\u5148\u6c42\u51fa\u6bcf\u4e2a\u70b9\u5b50\u6811\u5185\uff0c\u5230\u5b83\u8ddd\u79bb\u6700\u5927\u548c**\u6b21\u5927**\u7684\u70b9\uff0c\u6c42\u6b21\u5927\u7684\uff0c\u662f\u4e3a\u4e86\u907f\u514d\u6362\u6839\u65f6\uff0c\u8981\u6362\u7684\u90a3\u4e2a\u5b50\u6811\u6070\u597d\u5c31\u662f\u6700\u5927\u7684\u3002\n\n\u8fd9\u6837\uff0c\u5c31\u5728$O(n)$\u7684\u65f6\u95f4\u91cc\u6c42\u51fa\u4e86\u65ad\u6389\u8fd9\u6761\u8fb9\u65f6\uff0c\u65b0\u6811\u7684\u6700\u5c0f\u76f4\u5f84\u3002\u5bf9\u6bcf\u6761\u8fb9\u7684\u60c5\u51b5\u53d6\u6700\u5c0f\u503c\uff0c\u5c31\u662f\u7b54\u6848\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n^2)$\u3002\n\n### $O(n)$\u505a\u6cd5\n\n\u9700\u8981\u4e00\u4e9b\u89c2\u5bdf\u3002\n\n> **\u89c2\u5bdf\u4e00**\uff1a\u6211\u4eec\u8981\u65ad\u6389\u7684\u8fb9\uff0c\u4e00\u5b9a\u5728\u539f\u6811\u7684\u76f4\u5f84\u4e0a\u3002\n>\n> \u5426\u5219\u4e0d\u4f1a\u4f7f\u76f4\u5f84\u53d8\u5c0f\u3002\n\n> **\u89c2\u5bdf\u4e8c**\uff1a\u6839\u636e\u89c2\u5bdf\u4e00\uff0c$u$, $v$\u4e24\u4e2a\u8fde\u901a\u5757\u91cc\uff0c\u4e00\u5b9a\u5206\u522b\u6709\u4e00\u4e2a\u539f\u76f4\u5f84\u7684\u7aef\u70b9\u3002\u90a3\u4e48\uff0c$u$, $v$\u4e24\u4e2a\u8fde\u901a\u5757\u7684\u76f4\u5f84\uff0c\u5176\u4e2d\u7684\u4e00\u7aef\uff0c\u4e00\u5b9a\u662f\u539f\u76f4\u5f84\u7684\u7aef\u70b9\u3002\n>\n> \u5426\u5219\u539f\u76f4\u5f84\u5c31\u4e0d\u662f\u6700\u957f\u7684\u4e86\u3002\u4e0d\u7b26\u5408\u76f4\u5f84\u7684\u5b9a\u4e49\u3002\n\n> **\u89c2\u5bdf\u4e09**\uff1a\u524d\u9762\u6211\u4eec\u7528\u6362\u6839\u6cd5\u89e3\u51b3\u7684\u95ee\u9898\uff1a\n>\n> > \u6709\u4e00\u68f5\u6811\uff08\u4e5f\u5c31\u662f$u$\u6216$v$\u6240\u5728\u7684\u8fde\u901a\u5757\uff09\uff0c\u8bf7\u4f60\u6c42\u4e00\u4e2a\u70b9$x$\uff0c\u4f7f\u5f97\u6811\u4e0a\u6240\u6709\u70b9\u5230$x$\u7684\u6700\u5927\u8ddd\u79bb\u6700\u5c0f\u3002\n>\n> \u8fd9\u4e2a\u70b9$x$\uff0c\u4e00\u5b9a\u5c31\u662f\u6811\u7684\u76f4\u5f84\u7684\u4e2d\u70b9\uff08\u662f\u5e26\u6743\u610f\u4e49\u4e0a\u7684\u4e2d\u70b9\uff09\u3002\u200b\n\n\u6839\u636e\u89c2\u5bdf\u4e00\uff0c\u6211\u4eec\u53ef\u4ee5\u6309\u987a\u5e8f\u679a\u4e3e\u76f4\u5f84\u4e0a\u7684\u6bcf\u6761\u8fb9\u3002\u6b64\u65f6\uff0c\u4e24\u8fb9\u7684\u8fde\u901a\u5757\uff0c\u4f1a\u65b0\u591a\u51fa\u4e00\u90e8\u5206\u8282\u70b9\uff0c\u6216\u8005\u65b0\u51cf\u5c11\u4e00\u90e8\u5206\u8282\u70b9\u3002\u5bf9\u4e8e\u51cf\u5c11\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u53cd\u7740\u8d70\u4e00\u904d\uff0c\u5b83\u5c31\u4e5f\u53d8\u6210\u4e86\u65b0\u589e\u3002\n\n\u6bcf\u6b21\u904d\u5386\u8fd9\u4e9b\u201c\u65b0\u589e\u201d\u7684\u90e8\u5206\uff0c\u7136\u540e\u5229\u7528\u89c2\u5bdf\u4e8c\uff0c\u66f4\u65b0\u76f4\u5f84\u3002\u53d1\u73b0\u65b0\u589e\u90e8\u5206\u7684\u603b\u548c\u662f$O(n)$\u7684\u3002\u8fd9\u6837\uff0c\u5c31\u80fd\u5728\u603b\u5171$O(n)$\u7684\u65f6\u95f4\u91cc\uff0c\u6c42\u51fa$u,v$\u5404\u81ea\u6240\u5728\u8fde\u901a\u5757\u7684\u76f4\u5f84\u3002\n\n\u518d\u6839\u636e\u89c2\u5bdf\u4e09\uff0c\u6211\u4eec\u8981\u627e\u7684$x$\u4e0d\u9700\u8981\u7528\u6362\u6839\u6cd5\u4e86\u3002\u7531\u4e8e\u6bcf\u6b21\u65b0\u589e\u4e00\u4e9b\u90e8\u5206\u540e\uff0c\u8fde\u901a\u5757\u7684\u76f4\u5f84\u957f\u5ea6\u662f\u5355\u8c03\u4e0d\u964d\u7684\uff0c\u90a3\u4e48\u201c\u76f4\u5f84\u4e2d\u70b9\u201d\u4e5f\u662f\u201c\u5355\u8c03\u201d\u7684\uff0c\u5411\u524d\u679a\u4e3e\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n)$\u3002\n\n### \u53c2\u8003\u4ee3\u7801\n\n~~\u56e0\u4e3a\u535a\u4e3b\u662f\u9e3d\u5b50~~\uff0c\u6240\u4ee5\u53ea\u5199\u4e86$O(n^2)$\u7684\u4ee3\u7801\u3002\n\n```cpp\n//problem:P3761\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb push_back\n#define mk make_pair\n#define lob lower_bound\n#define upb upper_bound\n#define fi first\n#define se second\n#define SZ(x) ((int)(x).size())\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> pii;\n\nconst int MAXN=5000;\nconst int INF=1e9;\nint n,cnt;\nstruct EdgeAndSize{\n\tint u,v,w,sz_u,sz_v;\n\tEdgeAndSize(int _u,int _v,int _w,int _su,int _sv){\n\t\tu=_u;v=_v;w=_w;sz_u=_su;sz_v=_sv;\n\t}\n\tEdgeAndSize(){}\n}e[MAXN+5];\n\nstruct EDGE{int nxt,to,w;}edge[MAXN*2+5];\nint head[MAXN+5],tot;\ninline void add_edge(int u,int v,int w){\n\tedge[++tot].nxt=head[u],edge[tot].to=v,edge[tot].w=w,head[u]=tot;\n}\n\nint sz[MAXN+5];\nvoid dfs1(int u,int fa){\n\tsz[u]=1;\n\tfor(int i=head[u];i;i=edge[i].nxt){\n\t\tint v=edge[i].to;\n\t\tif(v==fa)continue;\n\t\tdfs1(v,u);\n\t\te[++cnt]=EdgeAndSize(u,v,edge[i].w,n-sz[v],sz[v]);\n\t\tsz[u]+=sz[v];\n\t}\n}\nint f[MAXN+5],f2[MAXN+5];\nvoid dfs2(int u,int fa){\n\tf[u]=f2[u]=0;\n\tfor(int i=head[u];i;i=edge[i].nxt){\n\t\tint v=edge[i].to;\n\t\tif(v==fa)continue;\n\t\tdfs2(v,u);\n\t\tint val=f[v]+edge[i].w;\n\t\tif(val>f[u]){\n\t\t\tf2[u]=f[u];\n\t\t\tf[u]=val;\n\t\t}\n\t\telse if(val>f2[u]){\n\t\t\tf2[u]=val;\n\t\t}\n\t}\n}\nvoid dfs3(int u,int fa,int& mn,int& mx){\n\tmn=min(mn,f[u]);\n\tmx=max(mx,f[u]);\n\tfor(int i=head[u];i;i=edge[i].nxt){\n\t\tint v=edge[i].to;\n\t\tif(v==fa)continue;\n\t\t//\u6362\u6839\n\t\tint t=f[u];\n\t\tif(f[v]+edge[i].w==f[u])t=f2[u];\n\t\tint val=t+edge[i].w;\n\t\tif(val>f[v]){\n\t\t\tf2[v]=f[v];\n\t\t\tf[v]=val;\n\t\t}\n\t\telse if(val>f2[v]){\n\t\t\tf2[v]=val;\n\t\t}\n\t\tdfs3(v,u,mn,mx);\n\t}\n}\nint main() {\n\tcin>>n;\n\tfor(int i=1;i<=n-1;++i){\n\t\tint u,v,w;cin>>u>>v>>w;\n\t\tadd_edge(u,v,w);add_edge(v,u,w);\n\t}\n\tdfs1(1,0);\n\tassert(cnt==n-1);\n\tint ans=INF;\n\tfor(int i=1;i<=n-1;++i){\n\t\tdfs2(e[i].u,e[i].v);\n\t\tint min_u=INF,max_u=0;\n\t\tdfs3(e[i].u,e[i].v,min_u,max_u);\n\t\t\n\t\tdfs2(e[i].v,e[i].u);\n\t\tint min_v=INF,max_v=0;\n\t\tdfs3(e[i].v,e[i].u,min_v,max_v);\n\t\t\n\t\tans=min(ans,max(min_u+min_v+e[i].w,max(max_u,max_v)));\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```\n\n",
        "postTime": 1591415643,
        "uid": 100674,
        "name": "duyi",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3761 \u3010[TJOI2017]\u57ce\u5e02\u3011"
    },
    {
        "content": "\u603b\u5171\u6709$n$\u4e2a\u7ed3\u70b9\u3001$n-1$\u6761\u8fb9\uff0c\u8bf4\u660e\u6574\u4e2a\u56fe\u662f\u4e00\u4e2a\u65e0\u6839\u6811\u3002\n\n\u679a\u4e3e\u6bcf\u4e00\u6761\u8fb9$w$\uff0c\u5e76\u8ba1\u7b97\u5220\u9664\u8fd9\u6761\u8fb9\u4ee5\u540e\u7684\u6700\u5927\u8d39\u7528\u3002\n\n\n\u9996\u5148\u6211\u81ea\u5df1\u5b9a\u4e49\u4e86\u4e24\u4e2a\u6982\u5ff5\uff1a\n\n**\u6811\u7684\u4e2d\u5fc3**\uff1a\u6811\u4e0a\u7684\u4e00\u70b9\uff0c\u4fdd\u8bc1\u4ece\u8be5\u70b9\u51fa\u53d1\u7684\u6700\u957f\u7b80\u5355\u8def\u6700\u77ed\u3002\n\n**\u6811\u7684\u534a\u5f84**\uff1a\u4ece\u6811\u7684\u4e2d\u5fc3\u51fa\u53d1\u7684\u6700\u957f\u7b80\u5355\u8def\u3002\n\n\n\u6bcf\u6b21\u5220\u8fb9\u65f6\u4f1a\u628a\u6574\u68f5\u6811\u5206\u6210\u4e24\u4e2a\u4e0d\u76f8\u4ea4\u7684\u65b0\u6811\u3002\n\n\u5bf9\u4e8e\u6bcf\u68f5\u65b0\u6811\uff0c\u53ef\u4ee5\u5206\u522b\u6c42\u51fa\u5b83\u4eec\u7684\u76f4\u5f84$d1$ $d2$\u3001\u4e2d\u5fc3\u53ca\u534a\u5f84$r1$ $r2$\u3002\u5219\u6700\u4f18\u5316\u4fee\u6539\u8be5\u8fb9\u540e\u6240\u80fd\u83b7\u5f97\u7684\u6700\u5927\u8d39\u7528\u4e3a$max(d1,d2,r1+r2+w)$\u3002\n\n\n\u53d7\u5230zx2003\u7684\u542f\u53d1\uff0c\u6709\u4e86\u4ee5\u4e0b\u7684\u4e00\u4e2a\u4f18\u5316\uff1a\u5148\u6c42\u51fa\u6574\u68f5\u6811\u7684\u76f4\u5f84\uff0c\u5219\u9700\u8981\u5220\u9664\u7684\u8fb9\u4e00\u5b9a\u5728\u76f4\u5f84\u4e0a\u3002\n\n\u8bc1\u660e\uff1a\u5982\u679c\u4fee\u6539\u7684\u8fb9\u4e0d\u5728\u76f4\u5f84\u4e0a\uff0c\u90a3\u4e48\u4fee\u6539\u6539\u8fb9\u540e\uff0c\u76f4\u5f84\u4ecd\u7136\u5b58\u5728\uff0c\u5219\u5bf9\u4e8e\u8be5\u8fb9\u7684\u4fee\u6539\u6ca1\u6709\u610f\u4e49\u3002\n\n\nzx2003\u63d0\u51fa\u7684\u53e6\u4e00\u4e2a\u6bd4\u8f83\u6709\u7528\u4f46\u662f\u6ca1\u6709\u88ab\u6211\u91c7\u7528\u7684\u4f18\u5316\uff1a\u7279\u5224\u94fe\u7684\u60c5\u51b5\u3002\n\n\n'''cpp\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<vector>\n#include<cctype>\ninline int getint() {\n    char ch;\n    while(!isdigit(ch=getchar()));\n    int x=ch^'0';\n    while(isdigit(ch=getchar())) x=(((x<<2)+x)<<1)+(ch^'0');\n    return x;\n}\nconst int N=6000,inf=0x7fffffff;\nstruct Edge {\n    int to,w;\n};\nint n;\nstd::vector<Edge> e[N];\nint uu=0,vv=0,stop=0;\nint v,w,d,y,u;\nvoid find_vertex(int x,int depth,int parent) {\n    if(depth>d) {\n        d=depth;\n        v=x;\n    }\n    for(register unsigned int i=0;i<e[x].size();i++) {\n        if((e[x][i].to!=parent)&&(e[x][i].to!=uu)&&(e[x][i].to!=vv)) {\n            find_vertex(e[x][i].to,depth+e[x][i].w,x);\n        }\n    }\n}\nvoid find_d(int x,int depth,int parent) {\n    if(depth>y) {\n        y=depth;\n        u=x;\n    }\n    for(unsigned int i=0;i<e[x].size();i++) {\n        if((e[x][i].to!=parent)&&(e[x][i].to!=stop)) {\n            find_d(e[x][i].to,depth+e[x][i].w,x);\n        }\n    }\n}\nint l[N];\nbool find_path(int x,int depth,int parent) {\n    w++;\n    l[w]=depth;\n    if(x==u) return true;\n    for(register unsigned int i=0;i<e[x].size();i++) {\n        if(e[x][i].to!=parent) {\n            if(find_path(e[x][i].to,depth+e[x][i].w,x)) return true;\n        }\n    }\n    w--;\n    return false;\n}\ninline int find_mid() {\n    for(int i=0;i<w;i++) {\n        if((l[i]<=(y>>1))&&(l[i+1]>=(y>>1))) {\n            return std::min(std::max(l[i],y-l[i]),std::max(l[i+1],y-l[i+1]));\n        }\n    }\n    return 0;\n}\ninline int getsum(int p) {\n    w=0,d=0,y=0,v=p;\n    find_vertex(p,0,0);\n    find_d(v,0,0);\n    find_path(v,0,0);\n    return find_mid();\n}\nstruct Edge2 {\n    int from,to,w;\n};\nEdge2 p[N];\nint w_whole;\nbool find_path_whole(int x,int parent,int w) {\n    p[w_whole]=(Edge2){parent,x,w};\n    w_whole++;\n    if(x==u) return true;\n    for(register unsigned int i=0;i<e[x].size();i++) {\n        if(e[x][i].to!=parent) {\n            if(find_path_whole(e[x][i].to,x,e[x][i].w)) return true;\n        }\n    }\n    w_whole--;\n    return false;\n}\nint main() {\n    n=getint();\n    for(int i=1;i<n;i++) {\n        u=getint(),v=getint(),w=getint();\n        e[u].push_back((Edge){v,w});\n        e[v].push_back((Edge){u,w});\n    }\n    w_whole=0,d=0,y=0;\n    find_vertex(1,0,0);\n    find_d(v,0,0);\n    find_path_whole(v,0,0);\n    int ans=inf;\n    for(register int i=1;i<w_whole;i++) {\n        uu=p[i].from;\n        vv=p[i].to;\n        int s1,s2,cmp=0;\n        stop=vv;\n        s1=getsum(uu);\n        cmp=std::max(cmp,y);\n        stop=uu;\n        s2=getsum(vv);\n        cmp=std::max(cmp,y);\n        ans=std::min(ans,std::max(s1+p[i].w+s2,cmp));\n    }\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n```\n```cpp",
        "postTime": 1498020827,
        "uid": 10086,
        "name": "skylee",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3761 \u3010[TJOI2017]\u57ce\u5e02\u3011"
    },
    {
        "content": "### [$\\texttt{TJOI2017-\u57ce\u5e02}$](https://www.luogu.com.cn/problem/P3761)\n\n\u7531\u4e8e\u53ef\u4ee5 $O(n^2)$\uff0c\u679a\u4e3e\u6bcf\u6761\u5220\u8fb9\u3002\u679a\u4e3e\u5220\u8fb9\u4e4b\u540e\u5bf9\u4e8e\u4e24\u4e2a\u6811\u5206\u522b\u6c42\u51fa\u5728\u8fd9\u68f5\u6811\u4e2d**\u8ddd\u79bb\u8282\u70b9 $u$ \u7684\u6700\u8fdc\u8ddd\u79bb**\uff0c\u8fd9\u4e2a\u9700\u8981\u4e8c\u6b21\u626b\u63cf\u6cd5\u8fdb\u884c\u6c42\u89e3\uff08\u5373\u4e0a\u4e0b\u7684\u6811\u5f62dp\uff09\u3002\n\n\u4e4b\u540e\uff0c\u6211\u4eec\u8981\u770b\u52a0\u54ea\u6761\u8fb9\u3002\u663e\u7136\uff0c\u6211\u4eec\u8981\u8fde\u63a5\u4e24\u4e2a\u6811\u7684\u201c\u4ea4\u901a\u67a2\u7ebd\u201d\u7136\u540e\u8fde\u63a5\u3002\u201c\u4ea4\u901a\u67a2\u7ebd\u201d\u6307\u6811\u4e0a\u5230\u8fd9\u68f5\u6811\u4e0a\u5230\u5176\u4ed6\u70b9\u7684\u6700\u8fdc\u8ddd\u79bb \u6700\u5c0f\u7684\u4e00\u4e2a\u70b9\u3002\u663e\u7136\u5728\u6c42\u51fa\u6700\u8fdc\u8ddd\u79bb\u540e\uff0c\u8fd9\u4e2a\u4e5f\u53ef\u4ee5\u901a\u8fc7\u679a\u4e3e\u6c42\u51fa\u3002\u5047\u8bbe\u4e24\u4e2a\u4ea4\u901a\u67a2\u7ebd $u,v$ \u6c42\u51fa\u4e86\uff0c\u90a3\u4e48\u8fde\u63a5\u4ed6\u4eec\uff0c\u6700\u957f\u8def\u5f84\u5373 $g_u+g_v+w$\uff0c\u5176\u4e2d $w$ \u4ee3\u8868\n\n\u4e8e\u662f\u8fd9\u4e2a\u7ed3\u679c\u5c31\u662f\u7b2c\u4e00\u68f5\u6811\u7684\u76f4\u5f84\uff0c\u7b2c\u4e8c\u68f5\u6811\u7684\u76f4\u5f84\u548c\u91cd\u65b0\u8fde\u8fb9\u540e\u7684\u76f4\u5f84\u7684\u6700\u5927\u503c\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=5e3+9;\nstruct edge{int to,nxt,w;}e[N*2]; int hd[N],tot;\nvoid add(int u,int v,int w){e[++tot]=(edge){v,hd[u],w};hd[u]=tot;}\nint f[N][2],mx[N],g[N],tmp[2],mn[2],ans=1e9;\n//f\u4e3a\u5b50\u6811\u91cc\u9762\u6700\u8fdc\u7684\u70b9\uff08f[u][0]\u4ee3\u8868\u6700\u8fdc\uff0cf[u][1]\u4ee3\u8868\u6b21\u8fdc\uff09\uff0cg\u4e3a\u5b50\u6811\u5916\u6700\u8fdc\u7684\u70b9\uff08\u540e\u9762\u901a\u8fc7\u548cf\u53d6max\u7b97\u51fa\u603b\u7684\u6700\u8fdc\u7684\u70b9\uff09\n//mx\u8bb0\u5f55\u6700\u8fdc\u7684\u90a3\u4e2a\u70b9\u662f\u4ece\u54ea\u4e2a\u513f\u5b50\u8282\u70b9\u51fa\u53d1\u7684\uff0c\u4fbf\u4e8e\u540e\u9762\u8ba1\u7b97g\nvoid dfs1(int u,int fa){\n\tfor(int i=hd[u],v;i;i=e[i].nxt)\n\t\tif((v=e[i].to)!=fa){\n\t\t\tdfs1(v,u);\n\t\t\tif(f[v][0]+e[i].w>f[u][0]){\n\t\t\t\tf[u][1]=f[u][0],f[u][0]=f[v][0]+e[i].w,mx[u]=v;\n\t\t\t}\n\t\t\telse if(f[v][0]+e[i].w>f[u][1]) f[u][1]=f[v][0]+e[i].w;\n\t\t} \n}\nvoid dfs2(int u,int fa,int k){\n\tfor(int i=hd[u],v;i;i=e[i].nxt)\n\t\tif((v=e[i].to)!=fa){\n\t\t\tif(mx[u]!=v) g[v]=max(g[u]+e[i].w,f[u][0]+e[i].w);\n\t\t\telse g[v]=max(g[u]+e[i].w,f[u][1]+e[i].w);\n\t\t\tdfs2(v,u,k);\n\t\t}\t\n\tg[u]=max(g[u],f[u][0]);\n\t\n\ttmp[k]=max(tmp[k],g[u]);\n\tmn[k]=min(mn[k],g[u]);\n}\nint main(){\n\tint n; scanf(\"%d\",&n);\n\tfor(int i=1,u,v,w;i<n;i++)\n\t\tscanf(\"%d%d%d\",&u,&v,&w),add(u,v,w),add(v,u,w);\n\tfor(int u=1;u<=n;u++){\n\t\tfor(int i=hd[u],v;i;i=e[i].nxt){\n\t\t\tif((v=e[i].to)<=u) continue;\n\t\t\tmemset(f,0,sizeof(f)),memset(g,0,sizeof(g)),memset(mx,0,sizeof(mx));\n\t\t\ttmp[0]=tmp[1]=0,mn[0]=mn[1]=1e9;\n               \t\t//\u4e0a\u9762\u662f\u521d\u59cb\u5316\n\t\t\tdfs1(u,v),dfs2(u,v,0),dfs1(v,u),dfs2(v,u,1);\n\t\t\tans=min(ans,max(max(tmp[0],tmp[1]),e[i].w+mn[0]+mn[1]));\n             \t\t//\u66f4\u65b0\u7b54\u6848\n\t\t}\n\t}\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1588914971,
        "uid": 180652,
        "name": "_lgswdn",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3761 \u3010[TJOI2017]\u57ce\u5e02\u3011"
    },
    {
        "content": "## \u9898\u610f\n\u4e00\u68f5\u6811\uff0c\u8fb9\u53c8\u8fb9\u6743\u3002\n\u5220\u4e00\u6761\u8fb9\uff0c\u91cd\u65b0\u94fe\u63a5\u4e00\u6761\u8fb9\uff0c\u8fb9\u6743\u76f8\u540c\uff0c\u8981\u6c42\u91cd\u65b0\u94fe\u63a5\u7684\u56fe\u8fd8\u662f\u6811\uff0c\u6c42\u51fa\u6700\u5c0f\u7684\u53ef\u80fd\u76f4\u5f84\n## \u89e3\u6cd5\n\u4e00\u5b9a\u5f97\u679a\u4e3e\u76f4\u5f84\u4e0a\u7684\u8fb9\u624d\u6709\u53ef\u80fd\u8ba9\u76f4\u5f84\u53d8\u5c0f\uff0c\u6240\u4ee5\u82b1$O(N)$\u679a\u4e3e\u76f4\u5f84\u4e0a\u7684\u8fb9\uff0c\u6b64\u65f6\u6811\u88ab\u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff0c\u7b54\u6848\u53ef\u80fd\u662f\u5176\u4e2d\u4efb\u610f\u4e00\u4e2a\u90e8\u5206\u7684\u76f4\u5f84\uff0c\u6216\u8005\u4e24\u4e2a\u6811\u8fde\u63a5\u540e\u7684\u6700\u957f\u94fe\u3002\n\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97\u51fa\u4e24\u68f5\u5c0f\u6811\u7684\u76f4\u5f84\uff0c\u7531\u4e8e\u6bcf\u4e2a\u70b9\u5728\u6811\u4e0a\u79bb\u5f97\u6700\u8fdc\u7684\u70b9\u90fd\u662f\u76f4\u5f84\u7aef\u70b9\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u9700\u8981dp\u5c31\u53ef\u4ee5\u7b97\u51fa\u6bcf\u4e2a\u70b9\u5728\u6811\u4e0a\u79bb\u5f97\u6700\u8fdc\u7684\u70b9\u7684\u8ddd\u79bb\uff0c\u53ea\u9700\u8981\u7528\u4e24\u4e2a\u76f4\u5f84\u7aef\u70b9\u5206\u522b\u505abfs\uff0c\u5c31\u53ef\u4ee5\u4e86\u3002\u7136\u540e\u5c31\u662f\u4ece\u4e24\u68f5\u6811\u4e2d\u90fd\u9009\u51fa\u6700\u5c0f\u7684\u70b9\uff0c\u52a0\u4e0a\u679a\u4e3e\u7684\u8fb9\u7684\u6743\u503c\u4f5c\u4e3a\u7b2c3\u79cd\u53ef\u80fd\u3002\n\n\u590d\u6742\u5ea6$O(N^2)$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=5e3+5;\ninline int read(){\n\tchar c=getchar();int t=0,f=1;\n\twhile((!isdigit(c))&&(c!=EOF)){if(c=='-')f=-1;c=getchar();}\n\twhile((isdigit(c))&&(c!=EOF)){t=(t<<3)+(t<<1)+(c^48);c=getchar();}\n\treturn t*f;\n}\nint n;\ntypedef pair<int,int> pii;\nvector<pii> g[maxn];\nint dis[maxn];\n#define fi first\n#define se second\nint ed,pre[maxn],st;\nint x[maxn],y[maxn],tot,dx,dy,alfa[maxn],val[maxn],vis[maxn];\ninline bool get(int u,int v){\n\tif((u==dx)&&(v==dy))return 1;\n\tif((u==dy)&&(v==dx))return 1;\n\treturn 0;\n}\nvoid bfs(int s){\n\tmemset(dis,-1,sizeof(dis));\n\tdis[s]=0;\n\tqueue<int> q;\n\twhile(!q.empty())q.pop();\n\tq.push(s);\n\twhile(!q.empty()){\n\t\tint u=q.front();q.pop();\n\t\tfor(auto i:g[u]){\n\t\t\tint v=i.fi,w=i.se;\n\t\t\tif(get(u,v))continue;\n\t\t\tif(dis[v]==-1){\n\t\t\t\tpre[v]=u;\n\t\t\t\tdis[v]=dis[u]+w;\n\t\t\t\tif(dis[v]>dis[ed])ed=v;\n\t\t\t\tq.push(v);\n\t\t\t}\n\t\t}\n\t}\n}\nint vp;\nint deal(int s){\n\ted=s;\n\tbfs(s);\n\tst=ed;\n\tbfs(st);\n\tfor(int i=1;i<=n;i++){\n\t\tif(dis[i]!=-1){\n\t\t\talfa[i]=dis[i];\n\t\t}\n\t}\n\tbfs(ed);\n\tint mn=0x3f3f3f3f,mx=0;\n\tfor(int i=1;i<=n;i++){\n\t\tif(dis[i]!=-1){\n\t\t\tvis[i]=1;\n\t\t\talfa[i]=max(alfa[i],dis[i]);\n\t\t\tmn=min(mn,alfa[i]);\n\t\t\tmx=max(mx,dis[i]);\n\t\t}\n\t}\n\tvp=max(vp,mx);\n\treturn mn;\n}\nsigned main(){\n\tn=read();\n\tfor(int i=1;i<n;i++){\n\t\tint a=read(),b=read(),c=read();\n\t\tg[a].push_back(pii(b,c));\n\t\tg[b].push_back(pii(a,c));\n\t}\n\ted=1;\n\tbfs(1);\n\tst=ed;\n\tbfs(ed);\n\tfor(int i=ed;i!=st;i=pre[i]){\n\t\ttot++;\n\t\tx[tot]=i;y[tot]=pre[i];val[tot]=dis[i]-dis[pre[i]];\n\t}\n\tint ans=0x3f3f3f3f;\n\tfor(int i=1;i<=tot;i++){\n\t\tdx=x[i],dy=y[i];vp=0;\n\t\tint tmp=val[i];\n\t\tfor(int u=1;u<=n;u++){\n\t\t\tif(!vis[u]){\n\t\t\t\ttmp+=deal(u);\n\t\t\t\t//printf(\"%d %d %d %d\\n\",dx,dy,u,deal(u));\n\t\t\t}\n\t\t}\n\t\tans=min(ans,max(tmp,vp));\n\t\tfor(int i=1;i<=n;i++)vis[i]=0;\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n\n```\n\n",
        "postTime": 1587718599,
        "uid": 29006,
        "name": "xiayuyang",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3761 \u3010[TJOI2017]\u57ce\u5e02\u3011"
    },
    {
        "content": "\n### \u9898\u89e3\n\n\u9996\u5148\u6bd4\u8f83\u663e\u7136\u7684\u662f\u65ad\u5f00\u7684\u8fb9\u4e00\u5b9a\u662f\u5728\u76f4\u5f84\u4e0a\u7684\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u679a\u4e3e\u76f4\u5f84\u4e0a\u65ad\u5f00\u7684\u8fb9\uff0c\u7136\u540e\u8003\u8651\u600e\u6837\u8fde\u8fb9\u624d\u80fd\u4f7f\u4e4b\u540e\u7684\u6700\u8fdc\u8ddd\u79bb\u6700\u5c0f\u3002\n\n\u53ef\u4ee5\u5bf9\u65ad\u5f00\u8fb9\u4e4b\u540e\u7684\u4e24\u68f5\u5b50\u6811\u5206\u522b\u8fdb\u884c\u6811\u5f62DP\uff0c\u6c42\u51fa\u6bcf\u68f5\u5b50\u6811\u4e2d\u4e0e\u6bcf\u4e2a\u70b9\u8ddd\u79bb\u6700\u8fdc\u7684\u70b9\u7684\u8ddd\u79bb\u3002\u8fd9\u4e2a\u6811\u5f62DP\u53ef\u4ee5\u5728$O(n)$\u7684\u590d\u6742\u5ea6\u5185\u5b9e\u73b0\uff0c\u4f46\u662f\u849f\u84bb\u6211\u6bd4\u8f83\u83dc\uff0c\u5199\u7684\u5f88\u957f\u3002\n\n\u90a3\u4e48\u65b0\u8fde\u7684\u8fb9\u7684\u4e24\u4e2a\u7aef\u70b9\u5fc5\u5b9a\u4e3a\u4e24\u68f5\u5b50\u6811\u4e2d\u4e0e\u8be5\u70b9\u7684\u6700\u8fdc\u8ddd\u79bb\u6700\u5c0f\u7684\u70b9\u3002\n\n\u8fd9\u6837\u8fde\u8fb9\u540e\u7684\u76f4\u5f84\u4e3a\u4e24\u4e2a\u7aef\u70b9\u7684\u6700\u8fdc\u8ddd\u79bb\u4e4b\u548c\u52a0\u4e0a\u65b0\u8fde\u8fb9\u7684\u957f\u5ea6\u3002\n\n\u6ce8\u610f\u65b0\u7684\u76f4\u5f84\u4e0d\u80fd\u6bd4\u4e24\u68f5\u5b50\u6811\u7684\u76f4\u5f84\u5c0f\u3002\n\n### \u4ee3\u7801\n\n\u849f\u84bb\u6211\u6bd4\u8f83\u83dc\uff0c\u4ee3\u7801\u5199\u7684\u53c8\u81ed\u53c8\u957fQwQ\u3002\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nconst int maxn=5005,inf=0x3F3F3F3F;\nint n,tot,lnk[maxn],son[maxn*2],w[maxn*2],nxt[maxn*2],idx,dfn[maxn],siz[maxn],sum,rt,Ver[maxn],E[maxn],u,v,ans,F[maxn][4];bool flg,vis[maxn*2];\ninline int read()\n{\n\tint ret=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-f;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){ret=ret*10+ch-'0';ch=getchar();}\n\treturn ret*f;\n}\ninline void add_e(int x,int y,int z){tot++;son[tot]=y;w[tot]=z;nxt[tot]=lnk[x];lnk[x]=tot;}\nvoid DFS(int now,int fa,int dist)\n{\n\tif(dist>sum){sum=dist;rt=now;}\n\tfor(int i=lnk[now];i;i=nxt[i])\n\t\tif(son[i]!=fa)\n\t\t\tDFS(son[i],now,dist+w[i]);\n}\nvoid DFS2(int now,int fa)\n{\n\tdfn[now]=++idx;siz[now]=1;\n\tif(!flg) Ver[++Ver[0]]=now;\n\tif(now==v){flg=true;return;}\n\tfor(int i=lnk[now];i;i=nxt[i])\n\t{\n\t\tif(son[i]!=fa)\n\t\t{\n\t\t\tif(!flg) E[++E[0]]=i;\n\t\t\tDFS2(son[i],now);\n\t\t\tsiz[now]+=siz[son[i]];\n\t\t\tif(!flg) E[0]--;\n\t\t}\n\t}\n\tif(!flg) Ver[0]--;\n}\nvoid DFS3(int now,int fa)\n{\n\tfor(int i=lnk[now];i;i=nxt[i])\n\t{\n\t\tif(son[i]!=fa&&!vis[i])\n\t\t{\n\t\t\tDFS3(son[i],now);\n\t\t\tif(F[son[i]][0]+w[i]>=F[now][0])\n\t\t\t{\n\t\t\t\tF[now][2]=F[now][0];\n\t\t\t\tF[now][3]=F[now][1];\n\t\t\t\tF[now][0]=F[son[i]][0]+w[i];\n\t\t\t\tF[now][1]=son[i];\n\t\t\t}\n\t\t\telse if(F[son[i]][0]+w[i]>F[now][2])\n\t\t\t{\n\t\t\t\tF[now][2]=F[son[i]][0]+w[i];\n\t\t\t\tF[now][3]=son[i];\n\t\t\t}\n\t\t\tif(F[son[i]][2]+w[i]>F[now][2]&&son[i]!=F[now][1])\n\t\t\t{\n\t\t\t\tF[now][2]=F[son[i]][2]+w[i];\n\t\t\t\tF[now][3]=son[i];\n\t\t\t}\n\t\t}\n\t}\n}\nvoid DFS4(int now,int fa)\n{\n\tfor(int i=lnk[now];i;i=nxt[i])\n\t{\n\t\tif(son[i]!=fa&&!vis[i])\n\t\t{\n\t\t\tif(F[now][1]!=son[i])\n\t\t\t{\n\t\t\t\tif(F[now][0]+w[i]>=F[son[i]][0])\n\t\t\t\t{\n\t\t\t\t\tF[son[i]][2]=F[son[i]][0];\n\t\t\t\t\tF[son[i]][3]=F[son[i]][1];\n\t\t\t\t\tF[son[i]][0]=F[now][0]+w[i];\n\t\t\t\t\tF[son[i]][1]=now;\n\t\t\t\t}\n\t\t\t\telse if(F[now][0]+w[i]>F[son[i]][2])\n\t\t\t\t{\n\t\t\t\t\tF[son[i]][2]=F[now][0]+w[i];\n\t\t\t\t\tF[son[i]][3]=now;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(F[now][3]!=son[i]&&F[now][2]+w[i]>=F[son[i]][0])\n\t\t\t{\n\t\t\t\tF[son[i]][2]=F[son[i]][0];\n\t\t\t\tF[son[i]][3]=F[son[i]][1];\n\t\t\t\tF[son[i]][0]=F[now][2]+w[i];\n\t\t\t\tF[son[i]][1]=now;\n\t\t\t}\n\t\t\telse if(F[now][3]!=son[i]&&F[now][2]+w[i]>=F[son[i]][2])\n\t\t\t{\n\t\t\t\tF[son[i]][2]=F[now][2]+w[i];\n\t\t\t\tF[son[i]][3]=now;\n\t\t\t}\n\t\t\tDFS4(son[i],now);\n\t\t}\n\t}\n}\ninline void Solve()\n{\n\tfor(int i=1;i<Ver[0];i++)\n\t{\n\t\tvis[E[i]]=vis[(E[i]&1)?E[i]+1:E[i]-1]=true;\n\t\tmemset(F,0,sizeof(F));\n\t\tDFS3(Ver[i],0);DFS3(Ver[i+1],0);\n\t\tDFS4(Ver[i],0);DFS4(Ver[i+1],0);\n\t\tint Max=0,Min1=inf,Min2=inf;\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tif(dfn[Ver[i]]<=dfn[j]&&dfn[j]<=dfn[Ver[i]]+siz[Ver[i]]) Min1=min(Min1,F[j][0]);\n\t\t\telse Min2=min(Min2,F[j][0]);\n\t\t\tMax=max(Max,F[j][0]);\n\t\t}\n\t\tif(max(Max,Min1+Min2+w[E[i]])<ans) ans=max(Max,Min1+Min2+w[E[i]]);\n\t\tvis[E[i]]=vis[(E[i]&1)?E[i]+1:E[i]-1]=false;\n\t}\n}\nint main()\n{\n\tn=read();\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tint a=read(),b=read(),c=read();\n\t\tadd_e(a,b,c);add_e(b,a,c);\n\t}\n\tDFS(1,0,0);sum=0;u=rt;\n\tDFS(u,0,0);ans=sum;v=rt;\n\tDFS2(u,0);\n\tSolve();\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1563106220,
        "uid": 42392,
        "name": "\u5f90\u81f4\u8fdc",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3761 \u3010[TJOI2017]\u57ce\u5e02\u3011"
    },
    {
        "content": "\u7ed9\u4f60\u4e00\u68f5n\u4e2a\u7ed3\u70b9\u7684\u5e26\u8fb9\u6743\u7684\u6811,\u8bf7\u4f60\u6539\u53d8\u5176\u4e2d\u4e00\u6761\u8fb9\u7684\u4f4d\u7f6e,\u4f7f\u5f97\u5269\u4e0b\u7684\u56fe\u4ecd\u662f\u4e00\u68f5\u6811,\u5e76\u4f7f\u6811\u7684\u76f4\u5f84\u5c3d\u53ef\u80fd\u5c0f\u3002\n\n\u6c42\u6539\u9020\u540e\u6811\u7684\u76f4\u5f84\u3002\n\n\u663e\u7136\u6539\u53d8\u7684\u8fb9\u5fc5\u7136\u662f\u8fd9\u68f5\u6811\u7684\u76f4\u5f84\u4e0a\u7684\u8fb9\u3002\n\n\u53bb\u6389\u4e00\u6761\u8fb9\u540e\uff0c\u4f1a\u53d8\u6210\u4e24\u68f5\u6811\uff0c\u6211\u4eec\u8981\u7528\u4e00\u6761\u8fb9\u8fde\u63a5\u8fd9\u4e24\u68f5\u6811\u4f7f\u5f97\u65b0\u6811\u7684\u76f4\u5f84\u5c3d\u53ef\u80fd\u5c0f\u3002\n\n\u90a3\u4e48\u5c31\u662f\u8fde\u63a5\u4ed6\u4eec\u7684\u4e2d\u5fc3\u4e86\u3002\n\n\u6240\u4ee5\u65b0\u6811\u7684\u76f4\u5f84=max(l1,l2,r1+r2+x)\n\n\u56e0\u4e3a\u65b0\u6811\u7684\u76f4\u5f84\u80af\u5b9a\u4e0d\u5c0f\u4e8e\u4e24\u68f5\u5b50\u6811\u7684\u76f4\u5f84\uff0c\u4e5f\u4e0d\u5c0f\u4e8e\u4e24\u68f5\u5b50\u6811\u7684\u534a\u5f84\u548c\u4e0e\u6539\u53d8\u7684\u8fb9\u7684\u548c\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u679a\u4e3e\u76f4\u5f84\u4e0a\u7684\u8fb9\uff0c\u5206\u522b\u6c42\u51fa\u53bb\u6389\u8fd9\u6761\u8fb9\u540e\u7684\u4e24\u68f5\u5b50\u6811\u7684\u76f4\u5f84\u548c\u534a\u5f84\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\n\n\n\n\n\n\n\n```cpp\n#include<iostream>\n#include<vector>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nvector<int> son[5001];\nint a[5001][5001],v[5001],last[5001],k,vv[5001];\nint u,dis[5001],s,lastt[5001],kk,op,uu;\nvoid dfs1(int o,int p,int q)\n{\n    if((son[o].size()==1)&&(v[q]))\n    {\n        if(p>op){op=p;k=o;}\n        return;\n    }\n    for(int i=0;i<son[o].size();i++)\n        if((!v[son[o][i]])&&(son[o][i]!=q))\n        {\n            v[son[o][i]]=true;\n            dfs1(son[o][i],p+a[o][son[o][i]],o);\n        }\n}\nvoid dfs2(int o,int p,int q)\n{\n    last[o]=q;\n    if((son[o].size()==1)&&(v[q]))\n    {\n        if(p>op){op=p;u=o;}\n        return;\n    }\n    for(int i=0;i<son[o].size();i++)\n        if((!v[son[o][i]])&&(son[o][i]!=q))\n        {\n            v[son[o][i]]=vv[son[o][i]]=true;\n            dfs2(son[o][i],p+a[o][son[o][i]],o);\n        }\n}\nvoid dfs11(int o,int p,int q)\n{\n    if(p>op){op=p;kk=o;}\n    for(int i=0;i<son[o].size();i++)\n        if((!v[son[o][i]])&&(son[o][i]!=q)&&(a[o][son[o][i]]))\n        {\n            v[son[o][i]]=vv[son[o][i]]=true;\n            dfs11(son[o][i],p+a[o][son[o][i]],o);\n        }\n}\nvoid dfs22(int o,int p,int q)\n{\n    lastt[o]=q;\n    dis[o]=p;\n    if(p>op){op=p;uu=o;}\n    for(int i=0;i<son[o].size();i++)\n        if((!v[son[o][i]])&&(son[o][i]!=q)&&(a[o][son[o][i]]))\n        {\n            v[son[o][i]]=true;\n            dfs22(son[o][i],p+a[o][son[o][i]],o);\n        }\n}\nint main()\n{\n    int n;\n    cin>>n;\n    for(int i=1;i<n;i++)\n    {\n        int x,y,z;\n        cin>>x>>y>>z;\n        a[x][y]=z;\n        a[y][x]=z;\n        son[x].push_back(y);\n        son[y].push_back(x);\n    }\n    op=-1;\n    memset(v,0,sizeof(v));\n    dfs1(1,0,0);\n    op=-1;\n    memset(v,0,sizeof(v));\n    dfs2(k,0,0);\n    int ans=1000000000;\n    for(int i=u;last[i]!=0;i=last[i])\n    {\n        int yu=a[i][last[i]];\n        a[i][last[i]]=0;\n        a[last[i]][i]=0;\n        memset(vv,0,sizeof(vv));\n        memset(lastt,0,sizeof(lastt));\n        int l1,l2,r1,r2;\n        l1=l2=-1;\n        r1=r2=1000000000;\n        for(int j=1;j<=n;j++)\n        {\n            if(!vv[j]&&(l1==-1))\n            {\n                memset(dis,0,sizeof(dis));\n                op=-1;\n                memset(v,0,sizeof(v));\n                vv[j]=true;\n                dfs11(j,0,0);\n                op=-1;\n                memset(v,0,sizeof(v));\n                vv[kk]=true;\n                dfs22(kk,0,0);\n                l1=op;\n                for(int i1=uu;i1!=0;i1=lastt[i1])\n                    r1=min(r1,max(dis[i1],l1-dis[i1]));\n            }\n            if(!vv[j]&&(l1!=-1))\n            {\n                memset(dis,0,sizeof(dis));\n                op=-1;\n                memset(v,0,sizeof(v));\n                vv[j]=true;\n                dfs11(j,0,0);\n                op=-1;\n                memset(v,0,sizeof(v));\n                vv[kk]=true;\n                dfs22(kk,0,0);\n                l2=op;\n                for(int i1=uu;i1!=0;i1=lastt[i1])\n                    r2=min(r2,max(dis[i1],l2-dis[i1]));\n            }\n        }\n        ans=min(ans,max(max(l1,l2),r1+r2+yu));\n        a[i][last[i]]=yu;\n        a[last[i]][i]=yu;       \n    }\n    cout<<ans<<endl;\n    return 0;\n}\n```",
        "postTime": 1515028385,
        "uid": 79044,
        "name": "\u7834\u58c1\u4eba",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3761 \u3010[TJOI2017]\u57ce\u5e02\u3011"
    }
]
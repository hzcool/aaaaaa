[
    {
        "content": "## \u9898\u89e3 JSOI2013 \u6253\u5730\u9f20\n\n### \u9898\u9762\n\n[luogu5263](https://www.luogu.com.cn/problem/P5263)\n\n### \u89e3\u6790\n\n\u4e8b\u5148\u58f0\u660e:\n\n\u4f3c\u4e4e\u5e76\u4e0d\u7528\u8003\u8651\u5de6\u53f3\u624b???\n\n\u8d2a\u5fc3\u5730\u60f3\u4e00\u60f3\u5b83\u5de6\u624b\u80fd\u8d70\u5230\u53f3\u624b\u53f3\u8fb9\u90a3\u4e0d\u5982\u76f4\u63a5\u7528\u53f3\u624b\u8d70???\n\n\u4ee5\u4e0a\u4e3a\u4e2a\u4eba\u731c\u6d4b,\u5e76\u65e0\u8bc1\u660e...\n\n~~\u4f46\u662f\u8ff7\u4e4b\u80fd\u8fc7...~~\n\n----\n\n\u8003\u8651\u7528\u4e00\u4e2a bitset \u7ef4\u62a4\u6bcf\u6b21\u6253\u5b8c\u540e\u4e0b\u6b21\u80fd\u6253\u7684\u5730\u9f20.\n\n\u7136\u540e\u76f4\u63a5\u62c6\u70b9\u8fde\u8fb9...\n\n\u628a\u5de6\u53f3\u624b\u770b\u4e3a $1$ \u53f7\u548c $2$ \u53f7\u5730\u9f20,\u628a $i$ \u5206\u4e3a $i$ \u548c $i+n$.\n\n\u6253\u5b8c $i$ \u540e\u82e5\u80fd\u6253 $j$ \u5219\u8fde $i+n->j$,\u8d39\u7528\u4e3a $0$,\n\n\u6bcf\u4e2a\u70b9\u8fde $i->i+n$,\u8d39\u7528\u4e3a $-p$.\n\n\u6700\u540e $S$ \u8fde $1$ \u548c $2$,$i+n$ \u8fde $T$,\u8dd1\u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\u5373\u53ef.\n\n\u4f46\u663e\u7136\u4f1a TLE....\n\n\u8003\u8651\u4f18\u5316\u4e00\u4e0b,\n\n\u5bf9\u4e8e $i$,\u5982\u679c\u5b83\u8fde\u4e86 $j$,\u90a3\u4e48 $j$ \u80fd\u8fde\u7684\u6240\u6709\u70b9 $i$ \u90fd\u4e0d\u8fde\u4e86..\n\n\u7136\u540e\u6bcf\u4e2a\u70b9 $i$ \u8fde $i->i+n$,\u8d39\u7528\u4e3a0,\u8868\u793a\u4e0d\u9009\u8fd9\u4e2a,\u4f46\u662f\u7ed9\u4e4b\u524d\u7684\u63d0\u4f9b\u4e00\u6761\u8def\u5f84...\n\n### code\n\n```cpp\n#include <iostream>\n#include <stdio.h>\n#include <cstring>\n#include <bitset>\n#include <queue>\n#include <cstdlib>\n#define ll long long\n#define filein(a) freopen(a\".cpp\",\"r\",stdin)\n#define fileout(a) freopen(a\".cpp\",\"w\",stdout);\nusing namespace std;\n\ninline int read(){\n\tint sum=0,f=1;char c=getchar();\n\twhile((c<'0'||c>'9')&&c!=EOF){if(c=='-') f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9'&&c!=EOF){sum=sum*10+c-'0';c=getchar();}\n\treturn sum*f;\n}\n\nconst int N=10008;\nconst int M=1000005;\nconst int INF=0x3f3f3f3f;\nstruct edge{int to,next,v,w;}e[M];\nstruct node{int x,t,p;}a[N];\nint n,V,S,T,ans;\nint head[N],cnt=1;\nint in[N],d[N],cur[N],v[N];\nbitset<3008> G[3008],ret;\nqueue<int> que;\n\ninline void add(int x,int y,int v,int w){\n\te[++cnt]=(edge){head[x],y,v,w};head[x]=cnt;\n\te[++cnt]=(edge){head[y],x,0,-w};head[y]=cnt;\n}\n\ninline bool SPFA(){\n\tmemset(d,INF,sizeof(d));\n\tmemcpy(cur,head,sizeof(cur));\n\tque.push(S);d[S]=0;\n\twhile(!que.empty()){\n\t\tint x=que.front();que.pop();in[x]=0;\n\t\tfor(int i=head[x];i;i=e[i].to){\n\t\t\tint k=e[i].next;\n\t\t\tif(!e[i].v||d[k]<=d[x]+e[i].w) continue;\n\t\t\td[k]=d[x]+e[i].w;\n\t\t\tif(!in[k]) in[k]=1,que.push(k);\n\t\t}\n\t}\n\treturn d[T]!=INF;\n}\n\ninline int dfs(int x,int mi){\n\tif(x==T||!mi) return mi;\n\tint flow=0;v[x]=1;\n\tfor(int &i=cur[x];i;i=e[i].to){\n\t\tint k=e[i].next;\n\t\tif(v[k]||!e[i].v||d[k]!=d[x]+e[i].w) continue;\n\t\tint ret=dfs(k,min(mi,e[i].v));\n\t\tflow+=ret;mi-=ret;\n\t\te[i].v-=ret;e[i^1].v+=ret;\n\t\tans+=ret*e[i].w;\n\t\tif(!mi) break;\n\t}\n\tv[x]=0;\n\treturn flow;\n}\n\ninline void DINIC(){\n\twhile(SPFA()) dfs(S,INF);\n}\n\nint main(){\n\tn=read()+2;V=read();S=n*2+10;T=S+1;\n\ta[1].x=read();a[2].x=read();\n\tfor(int i=3;i<=n;i++) a[i].x=read(),a[i].t=read(),a[i].p=read();\n\tfor(int i=1;i<=n;i++) G[i].reset();\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tif(a[i].t<a[j].t&&(abs(a[i].x-a[j].x)<=V*(a[j].t-a[i].t))) G[i].set(j,1);\n\tfor(int i=1;i<=n;i++){\n\t\tret.reset();\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tif(G[i][j]&&!ret[j]) add(i+n,j,INF,0),ret|=G[j];\t\t\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tadd(i,i+n,1,-a[i].p);\n\t\tadd(i,i+n,INF,0);\n\t}\n\tadd(S,1,1,0);add(S,2,1,0);\n\tfor(int i=1;i<=n;i++) add(i+n,T,INF,0);\n\tDINIC();\n\tprintf(\"%d\\n\",-ans);\n\treturn 0;\n}\n```",
        "postTime": 1581561630,
        "uid": 172304,
        "name": "zsq259",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5263 \u3010[JSOI2013]\u6253\u5730\u9f20\u3011"
    }
]
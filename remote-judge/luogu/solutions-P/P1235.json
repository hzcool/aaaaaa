[
    {
        "content": "\u96be\u5f97\u6210\u4e3a\u6b64\u9898\u7b2c\u4e00\u4e2a\u5403\u8783\u87f9\u7684\u849f\u84bb\u2026\u2026\n\n\u8fd9\u9053\u9898\u7684\u601d\u7ef4\u96be\u5ea6\u4e0d\u662f\u592a\u5927\uff0c\u4f46\u5b9e\u73b0\u96be\u5ea6\u7a0d\u5927\uff0c\u6709\u4e00\u5b9a\u7efc\u5408\u6027\u3002\n\n#\u57fa\u672c\u9012\u63a8\n\n\u9996\u5148\uff0c\u6211\u4eec\u8bb0F[a][b]\u8868\u793aa\u548cb\u7684\u57fa\u56e0\u76f8\u4f3c\u5ea6\u3002\n\n\u4e0d\u96be\u53d1\u73b0\uff0cF[a][b]=F[b][a]\uff0c\u81ea\u8eab\u6ca1\u6709\u7956\u5148\u7684\u90a3\u4e9b\u70b9\u4e4b\u95f4F[a][b]=0\uff0c\u81ea\u8eab\u548c\u81ea\u8eabF[a][a]=1\u3002\n\n\u5f52\u7eb3\u8bc1\u660e\u53ef\u5f97\u5230F[a][b]=(F[f[a][0]][b]+F[f[a][1]][b])/2\uff0c\u5176\u4e2df[a][0],f[a][1]\u662fa\u7684\u7236\u6bcd\uff0c\u4e14a\u7684\u8f88\u5206\u6bd4b\u4f4e\u6216\u76f8\u540c\u3002\u5982\u679c\u4e0d\u662f\u5f88\u5bb9\u6613\u7406\u89e3\u53ef\u4ee5\u624b\u52a8\u8ba1\u7b97\u4e00\u4e0b\u6837\u4f8b\u3002\n\n\u6240\u4ee5\u6211\u4eec\u5df2\u7ecf\u627e\u5230\u4e86\u9012\u63a8\u516c\u5f0f\u3002\u5b9e\u73b0\u7684\u65f6\u5019\u53ef\u4ee5\u5148\u786e\u5b9a\u6240\u6709\u70b9\u7684\u8f88\u5206\uff08\u7528\u7c7b\u4f3c\u62d3\u6251\u7684\u65b9\u6cd5\uff09\uff0c\u7136\u540e\u8bb0\u5fc6\u5316\u641c\u7d22\uff08\u76f4\u63a5\u9012\u63a8\u6bd4\u8f83\u96be\u786e\u5b9a\u5148\u540e\u987a\u5e8f\uff0c\u4e0d\u63d0\u5021\uff09\u3002\n\n#\u9ad8\u7cbe\u5ea6\u5c0f\u6570\n\n\u5230\u8fd9\u91cc\u6211\u4eec\u5df2\u7ecf\u660e\u786e\u4e86\u7b54\u6848\u7684\u8ba1\u7b97\u65b9\u5f0f\uff0c\u4f46\u662f\u6b64\u9898\u6709\u4e00\u4e2a\u5f88\u5927\u7684\u5751\u70b9\u2014\u2014\u9ad8\u7cbe\u5ea6\u5c0f\u6570\u3002\n\n\u5982\u679c\u8981\u624b\u5199\u6d6e\u70b9\u6570\uff08\u79d1\u5b66\u8ba1\u6570\u6cd5\uff09\u6216\u9ad8\u7cbe\u5206\u6570\u80af\u5b9a\u662f\u80fd\u5b9e\u73b0\u7684\uff0c\u53ef\u60dc\u672c\u849f\u84bb\u5e76\u4e0d\u4f1a\u3002\u6ce8\u610f\u5230F[a][b]\u53ea\u80fd\u662f0,1\u6216\u7eaf\u5c0f\u6570\uff0c\u53ef\u4ee5\u7528\u5b9a\u70b9\u6570\u5b58\u653e\u3002\n\n#\u65f6\u7a7a\u5206\u6790\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6O(n\u00b2\uff08\u5c31\u662f\u6700\u5927\u7684m\uff09\u00d7n\uff08\u9ad8\u7cbe\u5ea6\u7684\u8f6c\u79fb\u4ee3\u4ef7\uff09)=O(n\u00b3)\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6\u4e5f\u662fO(n\u00b3)\u3002\n\n\u4e3a\u4ec0\u4e48\u9ad8\u7cbe\u5ea6\u7684\u5b58\u50a8\u8f6c\u79fb\u4ee3\u4ef7\u662fO(n)\u5462\uff1f\u5176\u5b9e\u6b64\u9898\u53ea\u6d89\u53ca\u52a0\u6cd5\u548c\u96642\uff0cO(n)\u8ba1\u7b97\u8f6c\u79fb\u64cd\u4f5c\u662f\u53ef\u4ee5\u5b9e\u73b0\u7684\u3002\u51fa\u4e00\u7ec4\u6570\u636e\uff1a3\u662f1,2\u7684\u5b69\u5b50\uff0c4\u662f1,3\u7684\u5b69\u5b50\uff0c5\u662f1,4\u7684\u5b69\u5b50\uff0c\u4ee5\u6b64\u7c7b\u63a8\u76f4\u5230300\u662f1,299\u7684\u5b69\u5b50\uff0c\u8fd9\u6837\u67e5\u8be21\u548c300\u7684\u76f8\u4f3c\u5ea6\u7684\u7b54\u6848\u662f1-2^(-298)\uff0c\u9700\u8981298\u4f4d\u5c0f\u6570\u624d\u80fd\u5b58\u653e\uff0c\u6240\u4ee5\u5b58\u50a8\u4ee3\u4ef7\u4e5f\u662fO(n)\u3002\n\n\u65f6\u95f4\u4e0a1s\u591a\u534a\u662f\u8d44\u8f9e\u7684\uff0c\u4f46\u662f\u7a7a\u95f4\u4e0a\u76f4\u63a5\u5f00300\u00b3\u7684int\u597d\u50cf\u4f1aMLE\u3002C++\u9009\u624b\u53ef\u4ee5\u7528vector\u6765\u5b58\u653e\u5c0f\u6570\u6765\u9632\u6b62MLE\u3002\u4e5f\u53ef\u4ee5\u7528short\u7c7b\u578b\u3002\n\n\u867d\u7136\u5199\u5f97\u53c8\u957f\u53c8\u96be\u770b\uff0c\u4f46\u8fd8\u662f\u8d34\u4e00\u4e0b\u4ee3\u7801\u5427\u3002\u76f8\u4fe1\u5927\u5bb6\u90fd\u662f\u8bda\u5b9e\u7684\u597d\u5b69\u5b50\u4e0d\u4f1a\u6284\u9898\u89e3\u3002\n\n```cpp\n/*luoguP1235 AC code, Copyright \u00a9 JSSY(i.e. jiangyougogogo)*/\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<ctime>\n#include<cctype>\n#include<algorithm>\n#include<iostream>\n#include<string>\n#include<vector>\n#define hk 310\nusing namespace std;\nstruct DB{short N[hk];};//\u6b63\u5e8f\u5b58\u50a8\u5b9a\u70b9\u5c0f\u6570\uff0cN[0]\u4ee3\u8868\u4f4d\u6570\uff0cN[1]\u662f\u6574\u6570\u90e8\u5206\uff0cN[2]\u5230N[N[0]]\u662f\u5c0f\u6570\u90e8\u5206\nDB div(DB x,int y){//\u9ad8\u7cbe\u5ea6\u9664\u6cd5\n    int rem,flg=0;DB z;if(!x.N[1]&&x.N[0]==1)return x;\n    for(memset(z.N,0,sizeof z.N),z.N[z.N[0]=1]=x.N[1]/y,rem=x.N[1]%y;(rem||!flg)||z.N[0]<x.N[0];z.N[0]++){\n        z.N[z.N[0]+1]=(rem*10+x.N[z.N[0]+1])/y;\n        rem=(rem*10+x.N[z.N[0]+1])%y;if(z.N[z.N[0]+1])flg=1;\n    }return z;\n}DB plu(DB x,DB y){//\u9ad8\u7cbe\u5ea6\u52a0\u6cd5\n    int i=max(x.N[0],y.N[0]);DB z;for(memset(z.N,0,sizeof z.N);i;i--){\n        z.N[i-1]+=(z.N[i]+x.N[i]+y.N[i])/10;\n        z.N[i]=(z.N[i]+x.N[i]+y.N[i])%10;\n    }for(z.N[0]=max(x.N[0],y.N[0]);z.N[0]>1&&!z.N[z.N[0]];z.N[0]--);\n    return z;\n}void wri(DB x){//\u8f93\u51fa\uff0c\u5148\u8f93\u51fa\u767e\u5206\u6570\u7684\u6574\u6570\u90e8\u5206\uff0c\u518d\u8f93\u51fa\u5c0f\u6570\u90e8\u5206\n    int i,t=0;for(i=1;i<4;i++)t=t*10+x.N[i];\n    printf(\"%d\",t);if(x.N[0]<4){puts(\"%\");return;}\n    for(putchar('.'),i=4;i<=x.N[0];i++)printf(\"%d\",x.N[i]);puts(\"%\");return;\n}\nvector<int>eg[hk];int n,k,i,j,x,y,z,f[hk][2],m,q[hk],la[hk],to[hk],hd,tl,tt;\nbool iss[hk],lab[hk][hk],inq[hk];DB F[hk][hk];\nDB C(int x,int y){//\u8bb0\u5fc6\u5316\u641c\u7d22\n    if(lab[x][y])return F[x][y];//\u8ba1\u7b97\u8fc7\u5c31\u76f4\u63a5\u628a\u7b54\u6848\u62ff\u6765\n    if(la[x]>la[y]||!iss[y])F[x][y]=F[y][x]=div(plu(C(f[x][0],y),C(f[x][1],y)),2);\n    else F[x][y]=F[y][x]=div(plu(C(x,f[y][0]),C(x,f[y][1])),2);//\u9009\u8f88\u5206\u4f4e\u7684\u5411\u7956\u5148\u65b9\u5411\u7ee7\u7eed\u641c\n    lab[x][y]=lab[y][x]=1;return F[x][y];\n}int main(){\nfor(scanf(\"%d%d\",&n,&k),i=0;i<k;i++)\nscanf(\"%d%d%d\",&x,&y,&z),f[x][0]=y,f[x][1]=z,iss[x]=1,eg[y].push_back(x),eg[z].push_back(x),to[x]+=2;\n    for(i=1;i<=n;i++)if(!iss[i])q[++tl]=i,la[i]=inq[i]=1;//\u7c7b\u4f3c\u62d3\u6251\u7684\u65b9\u6cd5\u5904\u7406\u8f88\u5206\uff0c\u5148\u628a\u6ca1\u6709\u7236\u6bcd\uff08\u5373iss[i]==0\uff09\u7684\u90a3\u4e9b\u70b9\u8bb0\u4f5c\u7b2c\u4e00\u5c42\uff0c\u8ba1\u7b97la[]\u8868\u793a\u5c42\u6570\uff0c\u5206\u5c42\n    for(hd=0;hd^tl;){\n        for(hd++,i=eg[q[hd]].size()-1;i+1;i--)if(!(--to[tt=eg[q[hd]][i]])&&!inq[tt])\n            q[++tl]=tt,inq[tt]=1,la[tt]=la[q[hd]]+1;\n}//BFS\u62d3\u6251\nfor(i=1;i<=n;i++)for(j=1;j<=n;j++){\n        if(!iss[i]&&!iss[j])F[i][j].N[1]=0,F[i][j].N[0]=1,lab[i][j]=1;\n        if(i==j)F[i][j].N[1]=1,F[i][j].N[0]=1,lab[i][j]=1;\n}//\u8d4b\u521d\u503c\uff0c\u5176\u4e2dlab[i][j]\u8868\u793a\u5f53\u524d\u4f4d\u7f6e\u6709\u6ca1\u6709\u88ab\u8ba1\u7b97\u8fc7\nfor(scanf(\"%d\",&m);m;m--){\n        scanf(\"%d%d\",&x,&y);\n        wri(C(x,y));//\u8ba1\u7b97\u5373\u8f93\u51fa\n    }return 0;\n}\n```",
        "postTime": 1477787997,
        "uid": 819,
        "name": "jiangyougogogo",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1235 \u3010\u8840\u7f18\u5173\u7cfb\u3011"
    },
    {
        "content": "\u672c\u9898\u8f83\u4e3a\u9ebb\u70e6\u3002\n\n\u9996\u5148\u7528f[i][j]\u8868\u793ai\u4e0ej\u4e4b\u95f4\u7684\u76f8\u4f3c\u5ea6\uff0cfa[i]\u8868\u793ai\u7684\u7236\u4eb2\uff0cma[i]\u8868\u793ai\u7684\u6bcd\u4eb2\u3002\n\n\u6709\u9012\u63a8\u5f0f\uff1a\uff08\u8fd9\u4e2a\u6211\u60f3\u4e86\u597d\u4e45\uff09f[i][j]=(f[fa[i]][j]+f[ma[i]][j])/2,\u6216\u8005\u662ff[i][j]=(f[i][fa[j]]+f[i][ma[j]])/2\n\n\u81f3\u4e8e\u5177\u4f53\u53d6\u54ea\u4e00\u4e2a\u4e0b\u9762\u4f1a\u8bb2\u3002\n\n\n\u9996\u5148\u521d\u59cb\u5316\u5404\u4e2a\u7956\u5148\u4e4b\u95f4\u76f8\u4f3c\u5ea6\u4e3a0\u3002\n\n\u53d1\u73b0\u6839\u672c\u4e0d\u77e5\u9053\u6309\u4ec0\u4e48\u987a\u5e8f\u63a8\u3002\u6240\u4ee5\u8bb0\u5fc6\u5316\u641c\u7d22\u3002b[i][j]\u8bb0\u5f55i\u548cj\u7684\u5173\u7cfb\u662f\u5426\u5df2\u7ecf\u5f97\u51fa\u3002\n\n\n\u4f46\u662f\u8fd9\u65f6\u5019\u95ee\u9898\u6765\u4e86\uff1a\n\n\u5982\u679c\u6211\u4eec\u4e00\u76f4\u53d6i\u7684\u7236\u6bcd\u4e0ej\u6bd4\u8f83\uff0c\u5373\u7528\u9012\u63a8\u5f0ff[i][j]=(f[fa[i]][j]+f[ma[i]][j])/2\uff0c\n\n\u6709\u53ef\u80fd\u51fa\u73b0\u4e00\u4e2a\u60c5\u51b5\uff1aj\u662fi\u7684\u5b50\u8f88\uff0c\u90a3\u4e48\u6b64\u65f6i\u7684\u7236\u6bcd\u4f1a\u79bbj\u8d8a\u6765\u8d8a\u201c\u8fdc\u201d\uff0c\u8fd9\u6837\u8bb0\u5fc6\u5316\u641c\u7d22\u6c38\u8fdc\u7ed3\u675f\u4e0d\u4e86\u3002\n\n\u6240\u4ee5\u8fd8\u8981\u7528\u62d3\u6251\u6392\u5e8f\uff0c\u8bb0\u5f55\u4e0b\u5404\u4e2a\u602a\u7269\u5728\u62d3\u6251\u5e8f\u5217\u4e2d\u7684\u4f4d\u7f6e\uff0c\u7528\u6765\u6bd4\u8f83\u8f88\u5206\uff0c\u6bcf\u6b21\u8981\u53d6\u8f88\u5206\u9760\u540e\u7684\u602a\u7269\u7684\u7236\u6bcd\u5206\u522b\u4e0e\u53e6\u4e00\u4e2a\u8fdb\u884c\u6bd4\u8f83\u3002\n\n\n\u81f3\u4e8e\u9ad8\u7cbe\u5ea6\uff0c\u8fd8\u662f\u8981\u81ea\u5df1\u6162\u6162\u6253\u4e86\u3002\n\n\n\u8be6\u89c1\u4ee3\u7801\uff1a\n\n\n\n\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define file(x) freopen(#x\".in\",\"r\",stdin),freopen(#x\".out\",stdout)\nstruct num //\u9ad8\u7cbe\u5ea6\u8fd0\u7b97\u7b26\u91cd\u8f7d\n{\n    int a[302],len;\n    num()\n    {\n        len=1;\n        memset(a,0,sizeof a);\n    }\n    num operator=(num x)\n    {\n        for(int i=1;i<=x.len;i++)\n            a[i]=x.a[i];\n        len=x.len;\n        return *this;\n    }\n    void div2()\n    {\n        for(int i=1;i<=len;i++)\n        {\n            if(a[i+1]&1)a[i]+=10;\n            a[i]/=2;\n        }\n        while(a[len]==0&&len>1)len--;\n    }\n    num operator+(num b)\n    {\n        num a=*this,c;\n        int x=0;\n        c.len=max(a.len,b.len)+1;\n        for(int i=1;i<=c.len;i++)\n        {\n            c.a[i]=a.a[i]+b.a[i]+x;\n            x=c.a[i]/10;\n            c.a[i]%=10;\n        }\n        while(c.a[c.len]==0&&c.len>1)c.len--;\n        return c;\n    }\n};\ntypedef num number;\nostream& operator<<(ostream &cout,num x)\n{\n    int a[301],len=x.len,beg=1;\n    for(int i=1;i<=x.len;i++)\n        a[i]=x.a[i];\n    while(len<298)a[++len]=0;\n    while(a[beg]==0&&beg<298)beg++;\n    for(int i=len;i>=beg;i--)\n    {\n        if(i==297)printf(\".\");\n        printf(\"%d\",a[i]);\n    }\n    return cout;\n```\n}//\u8f93\u51fa\u81ea\u5df1\u60f3\u529e\u6cd5\n\n\n\n    \n```cpp\nnumber f[301][301];\nint fa[301][2],n,m,k,anc[301],dep[301],son[301][301],num[301],sta[301],top=0,fat[301];\n//dep\u662f\u5728\u62d3\u6251\u5e8f\u5217\u4e2d\u7684\u4f4d\u7f6e\uff0cfat\u662f\u7236\u6bcd\u6570\u91cf\uff0canc\u8bb0\u5f55\u6240\u6709\u7684\u7956\u5148\uff0cson\u662f\u5404\u4e2a\u8282\u70b9\u7684\u513f\u5b50\u4eec\uff0cnum\u662f\u513f\u5b50\u6570\u91cf\nbool b[301][301];//\u8bb0\u5f55\u5173\u7cfb\u662f\u5426\u5df2\u7ecf\u5f97\u51fa\nnumber dfs(int x,int y)//\u8bb0\u5fc6\u5316\u641c\u7d22\n{\n    if(b[x][y])return f[x][y];\n    if(dep[x]<dep[y])swap(x,y);//\u5982\u679cx\u7684\u5907\u4efd\u8f83\u9ad8\uff0c\u5373\u5728\u62d3\u6251\u5e8f\u5217\u4e2d\u7684dep\u8f83\u5c0f\uff0c\u5c31\u8981\u4ea4\u6362\n    number p;\n    b[x][y]=b[y][x]=1;\n    p=dfs(fa[x][0],y)+dfs(fa[x][1],y);//\u53d6x\u7684\u7236\u6bcd\u4e0ey\u6bd4\u8f83\n    p.div2();\n    return f[y][x]=f[x][y]=p;\n}\nint main()\n{\n    //file(family);\n    scanf(\"%d%d\",&n,&k);\n    for(int i=1,aa,bb,cc;i<=k;i++)\n    {\n        scanf(\"%d%d%d\",&aa,&bb,&cc);\n        son[bb][++num[bb]]=aa;\n        son[cc][++num[cc]]=aa;\n        fa[aa][0]=bb;\n        fa[aa][1]=cc;\n        fat[aa]=2;\n```\n}//\u8f93\u5165\n    \n    \n    \n```cpp\n    for(int i=1;i<=n;i++)\n    {\n        f[i][i].len=300;\n        f[i][i].a[300]=1;//\u521d\u59cb\u5316\u9ad8\u7cbe\u5ea6\n        b[i][i]=1;\n        if(!fa[i][0]&&!fa[i][1])anc[++anc[0]]=i;\n    }\n    for(int i=1;i<anc[0];i++)\n        for(int j=i+1;j<=anc[0];j++)\n            b[anc[i]][anc[j]]=b[anc[j]][anc[i]]=1;//\u7956\u5148\u4e4b\u95f4\u5173\u7cfb\u5df2\u7ecf\u5f97\u51fa\n    int deep=0;\n    for(int i=1;i<=anc[0];i++)\n        sta[++top]=anc[i];//\u62d3\u6251\u6392\u5e8f\uff0c\u7956\u5148\u5165\u6808\n    while(top>0)//\u62d3\u6251\u6392\u5e8f\n    {\n        int k=sta[top--];\n        dep[k]=++deep;//\u8bb0\u5f55\u6df1\u5ea6\n        for(int i=1;i<=num[k];i++)\n        {\n            fat[son[k][i]]--;\n            if(!fat[son[k][i]])sta[++top]=son[k][i];\n        }\n    }\n    scanf(\"%d\",&m);\n    for(int i=1,u,v;i<=m;i++)\n    {\n        scanf(\"%d%d\",&u,&v);\n        dfs(u,v);\n        cout<<f[u][v]<<'%'<<endl;\n    }\n    return 0;\n}\n```",
        "postTime": 1481945192,
        "uid": 20176,
        "name": "Salamander",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1235 \u3010\u8840\u7f18\u5173\u7cfb\u3011"
    },
    {
        "content": "\u849f\u84bb\u7b2c\u4e00\u6b21\u5199\u7d2b\u9898\u9898\u89e3\uff0c\u8bf7\u591a\u591a\u5305\u6db5\u3002\n\n\u8fd9\u9053\u9898\u5176\u5b9e\u4e0d\u7b97\u7279\u522b\u96be\uff0c\u96be\u7684\u662f\u7ec6\u5fc3\u4e0e Debug \u7684\u8010\u5fc3...(~~\u6211\u4e0d\u4f1a\u544a\u8bc9\u4f60\u6211\u4ea4\u4e8620\u591a\u6b21\u624d\u8fc7\u7684\uff01~~)\n\n\u9996\u5148\uff0c\u53d1\u73b0 $n \\le 300$ ,\u8bf4\u660e\u6700\u591a\u6709 $300$ \u4f4d,\u53c8\u56e0\u4e3a\u9898\u76ee\u8bf4`\u6709\u591a\u5c11\u7cbe\u5ea6\u5c31\u8f93\u51fa\u591a\u5c11`\uff0c\u6240\u4ee5\u9700\u8981\u9ad8\u7cbe\u5ea6\u3002\u8fd9\u91cc\u56e0\u4e3a\u90fd\u5728 0 \u4e0e 1 \u4e4b\u95f4\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u5b9a\u70b9\u6570\u5b58\u653e\u3002\n\n\u6211\u4eec\u7528 dp \u5904\u7406\u76f8\u4f3c\u7a0b\u5ea6\u3002\n\n\u90a3\u4e48 $i$ \u4e0e $j$ \u7684\u76f8\u4f3c\u7a0b\u5ea6\u5176\u5b9e\u5c31\u662f $i$ \u4e0e $j$ \u7684\u53cc\u4eb2\u76f8\u4f3c\u7a0b\u5ea6\u9664\u4ee5 $2$\uff0c\n\u56e0\u4e3a $j$ \u7684\u57fa\u56e0\u5c31\u662f\u53cc\u4eb2\u6bcf\u4eba\u8d21\u732e$\\dfrac1 2$\u7684\u57fa\u56e0\n\n\u6240\u4ee5\uff0c\u4ee4 $dp[i][j]$ \u8868\u793a $i$ \u4e0e $j$ \u7684\u57fa\u56e0\u76f8\u4f3c\u7a0b\u5ea6\uff0c\u5219\u6709$dp[i][j]=(dp[i][par[j][0]]+dp[i][par[j][1]])/2$,\n\n\u5176\u4e2d $par[i][0]$ \u8868\u793a $i$ \u7684\u7236\u4eb2\uff0c$par[i][1]$\u8868\u793a $i$ \u7684\u6bcd\u4eb2\u3002\n\n\u6240\u4ee5\u5176\u5b9e\u8fd9\u91cc\u53ea\u9700\u8981\u652f\u6301\u9ad8\u7cbe\u52a0\uff0c\u9ad8\u7cbe\u9664\u5355\u7cbe($2$)\u3002\u4e0b\u9762\u662f\u9ad8\u7cbe\u65b9\u9762\u7684\u4ee3\u7801\n\n```cpp\nstruct High{char A[301];int len;};\nHigh operator+(High a,High b){\n\tfor(int i=a.len+1;i<=300;++i)a.A[i]=0;\n\tfor(int i=b.len+1;i<=300;++i)b.A[i]=0;\n\tint n=(a.len<b.len)?(b.len):(a.len);//\u4f4d\u6570\u591a\u7684 \n\tfor(int i=n;i>=0;--i){\n\t\ta.A[i]+=b.A[i];\n\t\tif(a.A[i]>=10&&i)a.A[i-1]+=a.A[i]/10,a.A[i]%=10;//\u8fdb\u4f4d \n\t}\n\ta.len=n;//\u4f4d\u6570\u53d6\u591a\u7684 \n\twhile(a.len&&!a.A[a.len])--a.len;\n\treturn a;\n}\nHigh Div2(High a){\n\tint c=0,t;//\u9000\u4e0b\u6765\u7684\u6570 \n\tfor(int i=a.len+1;i<=300;++i)a.A[i]=0;\n\ta.A[++a.len]=0;//\u4e0d\u7ba1\u600e\u6837\u4f4d\u6570\u5148\u52a01 \n\tfor(int i=0;i<=a.len;++i){\n\t\tt=c;\n\t\tif(a.A[i]&1)c=1;//\u5947\u6570\u843d\u4e0b1 \n\t\telse c=0;\n\t\ta.A[i]=(a.A[i]+t*10)/2;\n\t}\n\twhile(a.len&&!a.A[a.len])--a.len;//\u6700\u540e\u4e00\u4f4d\u662f\u96f6 \n\treturn a;\n}\nvoid Print(High a){\n\tprintf(\"%d\",(a.A[0]*10+a.A[1])*10+a.A[2]);\n\tif(a.len>=3){//\u8fd8\u6709\u8981\u8f93\u51fa\u7684 \n\t\tputchar('.');//\u5c0f\u6570\u70b9 \n\t\tfor(int i=3;i<=a.len;++i)\n\t\t\tputchar('0'+a.A[i]);\n\t}\n\tputchar('%');//\u4e00\u5b9a\u8981\u6709'%' \n\tputchar('\\n'); \n}\n```\n\n\u7136\u540e\u518d\u901a\u8fc7\u62d3\u6251\u6392\u5e8f\u5904\u7406 $i$ \u7684\u6df1\u5ea6(\u8f88\u5206?),\u76f4\u63a5 BFS \u5373\u53ef\u3002\n\n```cpp\n/*\u7b97\u8f88\u5206*/\nqueue<int> q;\nbool vis[301];\nfor(int i=1;i<=N;++i)\n\tif(!isSon[i])\n\t\tq.push(i),dept[i]=1,vis[i]=true;\nwhile(q.size()){\n\tfor(int i=0;i<sons[q.front()].size();++i)\n\t\tif((--deg[sons[q.front()][i]])&&!vis[sons[q.front()][i]]){\n\t\t\tq.push(sons[q.front()][i]);\n\t\t\tdept[sons[q.front()][i]]=dept[q.front()]+1;\n\t\t\tvis[sons[q.front()][i]]=true;\n\t\t}\n\tq.pop();\n}\n```\n\n\u65e2\u7136\u662f dp\uff0c\u81ea\u7136\u5c31\u8981\u8d4b\u521d\u503c\u4e86\u3002\n\u9898\u9762\u4e2d\u5199\u4e86\uff0c\u5982\u679c\u6ca1\u6709\u53cc\u4eb2\u7684\u5996\u7cbe\uff0c\u76f8\u4f3c\u5ea6\u4e3a $0\\%$\u3002\n\u800c\u4e00\u4e2a\u5996\u7cbe\u4e0e\u81ea\u5df1\u7684\u76f8\u4f3c\u7a0b\u5ea6\u81ea\u7136\u5c31\u662f $100\\%$ \u4e86\u3002\n\n\u4ee3\u7801:\n```cpp\n/*\u8d4b\u521d\u503c*/\nint i,j;\nfor(i=1;i<=N;++i)\n\tfor(j=1;j<=N;++j){\n\t\tif(i==j){//\u5c31\u662f\u4e00\u4e2a\u5996\u7cbe \n\t\t\tdp[i][j].len=1;\n\t\t\tdp[i][j].A[0]=1;\n\t\t\tcc[i][j]=1;\n\t\t}else if(!isSon[i]&&!isSon[j]){//\u4e24\u8005\u4e92\u4e0d\u76f8\u5173 \n\t\t\tdp[i][j].len=1;\n\t\t\tdp[i][j].A[0]=0;\n\t\t\tcc[i][j]=1;\n\t\t}\n\t}\n```\n\n\u6700\u540e\uff0c\u4f7f\u7528 DFS \u5904\u7406 dp \u5c31\u7ed3\u675f\u4e86\u3002\u4e0d\u8fc7\u6211\u8fd9\u91cc\u7528\u7684\u662f\u8bb0\u5fc6\u5316\u641c\u7d22\uff0c\u76f4\u63a5 dp \u4e5f\u53ef\u4ee5\u4e86\u3002\n```cpp\nHigh Dfs(int u,int v){//\u5f00\u59cb\u8bb0\u5fc6\u5316\u641c\u7d22 \n\tif(cc[u][v])return dp[u][v]; //\u7b97\u8fc7\u4e86\n\tif(dept[u]>dept[v]){int t=v;v=u;u=t;}//\u4ea4\u6362u,v\n\tif(isSon[v])dp[u][v]=dp[v][u]=Div2(Dfs(u,par[v][0])+Dfs(u,par[v][1])); //\u628a\u6df1\u7684\u5f80\u4e0a\u62c9 \n\telse dp[u][v]=dp[v][u]=Div2(Dfs(par[u][0],v)+Dfs(par[u][1],v)); //\u628a\u6df1\u7684\u5f80\u4e0a\u62c9 \n\tcc[u][v]=cc[v][u]=true;\n\treturn dp[u][v];\n}//PS:\u600e\u4e48\u5199\u7740\u6709\u70b9\u66b4\u529bLCA\u7684\u611f\u89c9\u4e86? \n```\n\n\u63a5\u4e0b\u6765\uff0c\u5728\u8be2\u95ee\u4e2d\u4e00\u4e2a\u4e2a DFS \u5c31\u53ef\u4ee5\u5904\u7406\u51fa\u7b54\u6848\u3002",
        "postTime": 1619842496,
        "uid": 228486,
        "name": "SunsetSamsara",
        "ccfLevel": 7,
        "title": "P1235 \u8840\u7f18\u5173\u7cfb \u9898\u89e3"
    },
    {
        "content": "## \u5206\u6790\n\n- \u5b9e\u9645\u4e0a\u8fd9\u9053\u9898\u7684\u96be\u70b9\u5e76\u4e0d\u5728\u52a8\u6001\u89c4\u5212\u4e0a\uff0c\u800c\u662f\u5404\u79cd\u590d\u6742\u7684\u5904\u7406\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u8840\u7f18\u5173\u7cfb\u770b\u6210\u662f\u4e00\u4e2a\u6709\u62d3\u6251\u5e8f\u7684\u6709\u5411\u56fe\u3002\u53ea\u9700\u8981\u4e00\u70b9\u70b9\u7b80\u5355\u7684\u601d\u8003\u5c31\u53ef\u4ee5\u5206\u6790\u672c\u9898\u3002\n\n### \u52a8\u6001\u89c4\u5212\u90e8\u5206\n\n\u8fd9\u4e00\u90e8\u5206\u5b9e\u9645\u4e0a\u975e\u5e38\u7b80\u5355\u3002\n\n- \u521d\u59cb\u5316\uff1a\u82e5 C \u548c D \u6ca1\u6709\u4efb\u4f55\u5173\u7cfb\uff0c\u90a3\u4e48\u4ed6\u4eec\u7684\u76f8\u4f3c\u5ea6\u4e3a $0\\%$\uff1b\u5e76\u4e14\u4e00\u4e2a\u5996\u7cbe\u548c\u4ed6\u81ea\u5df1\u7684\u76f8\u4f3c\u5ea6\u662f $100\\%$\u3002\n- \u6211\u4eec\u8bb0 $fa[u][0,1]$ \u4e3a\u8fd9\u4e2a\u5996\u7cbe $u$ \u7684\u4e24\u4e2a\u7236\u4eb2\u3002\u90a3\u4e48\u663e\u7136\u6839\u636e\u9898\u610f $f[u][v]=f[v][u]=(f[fa[u][0]][v]+f[fa[u][1]][v])\\div 2$\u3002\u90a3\u4e48\u4e3a\u4e86\u4f7f\u5f97\u6700\u540e\u4e00\u5b9a\u80fd\u591f\u5904\u7406\u51fa\u6765\uff0c\u5373\u56de\u6eaf\u5230\u4e24\u8005\u5df2\u8ba1\u7b97\u7684\u4e14\u6709\u5173\u8054\u7684\u7956\u5148\uff0c\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u4e24\u8005\u6df1\u5ea6\u6709\u4e00\u5b9a\u7684\u5173\u7cfb\uff0c\u8fd9\u91cc\u53ef\u4ee5\u8f6c\u5230\u62d3\u6251\u6392\u5e8f\u90e8\u5206\u3002\n- \u53ea\u9700\u8981\u4fdd\u8bc1 $dep[u]>dep[v]$\uff08$u$ \u7684\u8f88\u5206\u6bd4 $v$ \u5c0f\uff09\u5c31\u53ef\u4ee5\u7528\uff0c\u5982\u679c\u987a\u5e8f\u53cd\u4e86\u53ea\u8981\u8c03\u6362\u4e00\u4e0b\u5c31\u884c\u3002\n- \u4ee3\u7801\u4e2d\u5c55\u793a\u7684\u662f\u8bb0\u5fc6\u5316\u641c\u7d22\u3002\n\n### \u62d3\u6251\u6392\u5e8f\n\n\u5176\u5b9e\u5c31\u662f\u62d3\u6251\u6392\u5e8f\u6a21\u677f\uff0c\u5e76\u6ca1\u6709\u591a\u5c11\u503c\u5f97\u6ce8\u610f\u7684\u70b9\uff0c\u4f46\u662f\u5728\u52a0\u8fb9\u7684\u65f6\u5019\u6ce8\u610f\u5165\u5ea6\u52a0\u4e8c\u800c\u4e0d\u662f\u52a0\u4e00\uff0c\u5e76\u4e14\u9700\u8981\u6ce8\u610f\u5148\u521d\u59cb\u5316\u518d\u62d3\u6251\u6392\u5e8f\uff08\u521d\u59cb\u5316\u9700\u8981\u8bfb\u5165\u5ea6\uff09\u3002\n```cpp\nvector<int> e[N];\nqueue<int> q;\nint in[N],dep[N];\nbool vis[N];\n  \nvoid topo(){\n    for(int i=1;i<=n;i++)\n        if(!in[i])\n            q.push(i),vis[i]=true,dep[i]=1;\n    while(!q.empty()){\n        int u=q.front();\n        q.pop();\n        for(int v:e[u]){\n            in[v]--;\n            if(!vis[v]&&!in[v]){\n                vis[v]=true,dep[v]=dep[u]+1;\n                q.push(v);\n            }\n        }\n    }\n    return ;\n}\n```\n\n### \u9ad8\u7cbe\u5ea6\n\n\u5176\u5b9e\u8fd8\u662f\u6709\u86ee\u591a\u5904\u7406\u7ec6\u8282\u7684\uff0c\u8bf4\u4e00\u4e0b\u6700\u91cd\u8981\u7684\u51e0\u70b9\u3002\n\n- \u56e0\u4e3a\u672c\u9898\u662f\u5b9a\u70b9\u5c0f\u6570\u8ba1\u7b97\uff0c\u6240\u4ee5\u628a $a[1]$ \u4f5c\u4e3a\u9ad8\u4f4d\u6765\u5904\u7406\u66f4\u52a0\u65b9\u4fbf\u3002\n- \u4e0d\u80fd\u591f\u76f4\u63a5\u521d\u59cb\u5316\uff0c\u4f1a\u88ab\u5361\u6389\uff0c\u4f1a\u51fa\u73b0\u5168\u90e8 ```RE``` \u6216\u76f4\u63a5 ```CE```\u3002\u6240\u4ee5\u5728\u8ba1\u7b97\u7684\u65f6\u5019\u5904\u7406\u8fd9\u4e00\u95ee\u9898\uff08\u5373\u4ee3\u7801\u4e2d ```attention``` \u4f4d\u7f6e\uff09\u4f1a\u8ba9\u590d\u6742\u5ea6\u5c0f\u5f88\u591a\u3002\n- \u6ce8\u610f\u5904\u7406 ```0``` \u7684\u95ee\u9898\u3002\n\n```cpp\nstruct huge{\n    int a[N];\n    int len;  // 1 \u4e3a\u6700\u9ad8\u4f4d\n}f[N][N];\nhuge operator+(huge x,huge y){\n    for(int i=x.len+1;i<=300;i++)\n        x.a[i]=0;\n    for(int i=y.len+1;i<=300;i++)\n        y.a[i]=0;\t// attention\n    huge tmp;\n    tmp.len=std::max(x.len,y.len);tmp.a[tmp.len+1]=0;\n    for(int i=tmp.len;i>=0;i--){\n        tmp.a[i]=x.a[i]+y.a[i]+(tmp.a[i+1]/10);\n        tmp.a[i+1]%=10;\n    }\n    while(!tmp.a[tmp.len]&&tmp.len)\n        tmp.len--;\n    return tmp;\n}\nhuge div_equal(huge x){\n    for(int i=x.len+1;i<=300;++i)\n        x.a[i]=0;\t// attention\n    x.len++;\n    for(int i=0;i<=x.len;i++){\n        if(x.a[i]%2==1)\n            x.a[i+1]+=10;\n        x.a[i]>>=1;\n    }\n    while(x.a[x.len]==0&&x.len)\n        x.len--;\n    return x;\n}\nvoid print(huge x){\n    printf(\"%d\",x.a[0]*100+x.a[1]*10+x.a[2]);\n    // \u5148\u8f93\u51fa\u6574\u6570\u90e8\u5206\n    if(x.len>=3){\n        putchar('.');\n        for(int i=3;i<=x.len;i++)\n            printf(\"%d\",x.a[i]);\n    }\n    putchar('%');\n    putchar('\\n');\n    return ;\n}\n```\n\n### \u603b\u7ed3\n\u4e3b\u8981\u6765\u8bf4\u8fd9\u9053\u9898\u5982\u679c\u6ca1\u6709\u9ad8\u7cbe\u53ef\u80fd\u4e5f\u5c31\u7eff\u9898\u6c34\u5e73\uff0c\u52a0\u4e0a\u9ad8\u7cbe\u4f1a\u8ba9\u6574\u4e2a\u9898\u5904\u7406\u7684\u96be\u5ea6\u63d0\u9ad8\u5f88\u591a\uff0c\u6bd4\u8f83\u8003\u9a8c\u7801\u529b\u3002\n\n## Code\n\u5c31\u7ed9\u4e00\u4e0b\u4e3b\u51fd\u6570\u548c\u641c\u7d22\u90e8\u5206\u5427\uff0c\u5176\u4ed6\u90e8\u5206\u89c1\u4e0a\u6587\u3002\n```cpp\nvoid init(){\n    for(int i=1;i<=n;i++)\n        for(int j=1;j<=n;j++){\n            if(i==j)\n                f[i][j].len=1,f[i][j].a[0]=1,flag[i][j]=true;\n            else if(!in[i]&&!in[j])\n                f[i][j].len=1,f[i][j].a[0]=0,flag[i][j]=true;\n        }\n    return ;\n}\nhuge dfs(int u,int v){\n    if(flag[u][v])\n        return f[u][v];\n    if(dep[u]<dep[v])\n        swap(u,v);\n    flag[u][v]=flag[v][u]=true;\n    return f[u][v]=f[v][u]=div_equal(dfs(fa[u][0],v)+dfs(fa[u][1],v));\n}\nint main(){\n    int T;\n    scanf(\"%d%d\",&n,&k);\n    for(int i=1;i<=k;i++){\n        int u,x,y;\n        scanf(\"%d%d%d\",&u,&x,&y);\n        e[x].push_back(u);\n        e[y].push_back(u);\n        fa[u][0]=x,fa[u][1]=y;\n        in[u]+=2;\n    }\n    init();\n    topo();\n    scanf(\"%d\",&T);\n    while(T--){\n        int u,v;\n        scanf(\"%d%d\",&u,&v);\n        print(dfs(u,v));\n    }\n    return 0;\n}\n```\n",
        "postTime": 1673694640,
        "uid": 264360,
        "name": "Comentropy",
        "ccfLevel": 5,
        "title": "P1235 \u9898\u89e3"
    },
    {
        "content": "f[i][j]\u8868\u793ai\u3001j\u7684\u4eb2\u7f18\u5173\u7cfb\u3002             \nf[i][j]=(f[i][fa[j]]+f[i][mo[j]])/2\u6216f[i][j]=(f[fa[i]][j]+f[mo[i]][j])/2              \n\u6309\u62d3\u6251\u5e8f\u63a8\u4e00\u904d\u5c31\u597d\u4e86\u3002         \n\u542c\u8bf4\u6709\u9ad8\u7cbe\u5ea6\u5c0f\u6570\u3002            \n\u4e0b\u9762\u662f\u4ee3\u7801(\u5f88\u5947\u8469)\n```\n\n#include<cstdio>\n#include<iostream>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\n#define rep(i,j,k) for(i=j;i<=k;++i)\n#define per(i,j,k) for(i=j;i>=k;--i)\n#define sqr(x) ((x)*(x))\n#define G getchar()\n#define LL long long\n#define pll pair<LL,LL>\n#define mkp make_pair\n#define X first\n#define Y second\n#define N 305\nint n,m,fa[N],mo[N];\nint he[N],ne[N<<1],to[N<<1],tot;\nint q[N],in[N];\nstruct DATA{short dat[N];int ln;}f[N][N];\nDATA operator +(DATA x,DATA y){\n    x.ln=max(x.ln,y.ln);\n    int i;per(i,x.ln,1)\n        if((x.dat[i]+=y.dat[i])>9)++x.dat[i-1],x.dat[i]-=10;\n    x.dat[0]+=y.dat[0];\n    while(x.ln&&!x.dat[x.ln])--x.ln;\n    return x;\n}\nDATA div2(DATA x){\n    int i;\n    rep(i,0,x.ln){\n        if(x.dat[i]&1)x.dat[i+1]+=10;\n        x.dat[i]>>=1;\n    }\n    if(x.dat[x.ln+1])x.dat[++x.ln]=5;\n    return x;\n}\nvoid add(int x,int y){\n    to[++tot]=y;ne[tot]=he[x];he[x]=tot;\n}\nint read(){\n    int x=0;char ch=G;\n    while(ch<48||ch>57)ch=G;\n    for(;ch>47&&ch<58;ch=G)x=x*10+ch-48;\n    return x;\n}\nvoid BFS(){\n    int Ft=1,Rr=1,u,v,i;\n    rep(i,1,n){\n        if(!in[i])q[Rr++]=i;f[i][i].dat[0]=1;\n    }\n    while(Ft<Rr){\n        u=q[Ft++];\n        per(i,Ft-2,1){\n            v=q[i];f[u][v]=f[v][u]=div2(f[v][fa[u]]+f[v][mo[u]]);\n        }\n        for(i=he[u];i;i=ne[i])if(--in[v=to[i]]==0)q[Rr++]=v;\n    }\n}\nvoid write(DATA x){\n    printf(\"%d\",x.dat[0]*100+x.dat[1]*10+x.dat[2]);int i;\n    if(x.ln>2){\n        putchar('.');\n        rep(i,3,x.ln)printf(\"%d\",x.dat[i]);\n    }\n    puts(\"%\");\n}\nint main(){\n    int i,x,Q,y;\n    n=read();m=read();\n    while(m--){\n        in[x=read()]=2;fa[x]=read();mo[x]=read();\n        add(fa[x],x);add(mo[x],x);\n    }\n    BFS();\n    for(Q=read();Q--;){\n        x=read();y=read();write(f[x][y]);\n    }\n    return 0;\n}\n\n```\n",
        "postTime": 1570436180,
        "uid": 240677,
        "name": "123456_zzm",
        "ccfLevel": 0,
        "title": "P1235"
    }
]
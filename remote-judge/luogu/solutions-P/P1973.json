[
    {
        "content": "\u9996\u5148\uff0c\u5c06\u65f6\u95f4\u79bb\u6563\u5316\u3002\u8bbe\u79bb\u6563\u5316\u540e\u7684\u65f6\u95f4\u533a\u95f4\u4e3a$[1,T]$\uff0c\u5176\u4e2d$t\\leq 2n$\u3002\u4e4b\u540e\u5148\u9884\u5904\u7406$inter[i][j]$\u8868\u793a\u5b8c\u5168\u5728\u65f6\u95f4i\u5230\u65f6\u95f4j\u4e4b\u95f4\u4e3e\u884c\u7684\u6d3b\u52a8\u4e2a\u6570\u3002\n\n\u5bb9\u6613\u60f3\u5230\u6700\u7b80\u5355\u7684DP\uff0c$f[i][j],g[i][j]$\uff0c\u5206\u522b\u8868\u793a\u5728\u533a\u95f4$[1,i]$\u548c$[i,T]$\uff0c\u4e00\u4e2a\u4f1a\u573a\u81f3\u5c11\u4e3e\u529ej\u4e2a\u6d3b\u52a8\u7684\u60c5\u51b5\u4e0b\uff0c\u53e6\u4e00\u4e2a\u4f1a\u573a\u81f3\u5c11\u4e3e\u529e\u591a\u5c11\u4e2a\u6d3b\u52a8\uff1f\u8f6c\u79fb\u5c31\u662f\u679a\u4e3e\u4e00\u4e2a\u533a\u95f4\uff0c\u5c06\u5176\u4e2d\u6240\u6709\u6d3b\u52a8\u5206\u914d\u7ed9\u67d0\u4e2a\u4f1a\u573a\u3002\n\n\u8fd9\u6837\u4e00\u6765\uff0c\u7b2c\u4e00\u95ee\u7b54\u6848\u53ef\u4ee5\u7531$\\max_{j}\\min(f[T][j],j)$\u786e\u5b9a\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u95ee\uff0c\u5982\u4f55\u5f3a\u5236\u8ba9\u4e00\u4e2a\u4f1a\u573a\u4e3e\u529e\u7b2ci\u4e2a\u6d3b\u52a8? \u6211\u4eec\u53ef\u4ee5\u9009\u4e00\u4e2a\u5305\u542b\u7b2ci\u4e2a\u6d3b\u52a8\u7684\u533a\u95f4$[L,R]$\uff0c\u7136\u540e\u5f3a\u5236\u7b2c\u4e00\u4e2a\u4f1a\u573a\u4e3e\u529e\u6240\u6709\u5728$[L,R]$\u4e4b\u95f4\u4e3e\u884c\u7684\u6d3b\u52a8\u3002\u5e76\u679a\u4e3e\u5728$[1,L]$\u4e0e$[R,T]$\u8fd9\u4e24\u6bb5\u533a\u95f4\u7b2c\u4e00\u4e2a\u4f1a\u573a\u4e3e\u529e\u7684\u6d3b\u52a8\u4e2a\u6570$x,y$\u3002\u7b54\u6848\u5c31\u662f\n$$\\max_{L,R,x,y} \\min(x+inter[L][R]+y,f[L][x]+g[R][y])$$\u3002\n\n\u4f46\u7c97\u7565\u5730\u770b\u8d77\u6765\u65f6\u95f4\u590d\u6742\u5ea6\u5f88\u5927\uff0c\u5bf9\u4e8e\u6bcf\u4e2a$k$\uff0c\u90fd\u8981\u56db\u91cd\u5faa\u73af\u8ba1\u7b97\u7b54\u6848\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f$O(n^5)$\u3002\u6ce8\u610f\u5230\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97\u6570\u7ec4\n$$ans[L][R]=\\max_{L,R,x,y} \\min(x+inter[L][R]+y,f[L][x]+g[R][y])$$\u3002\u8fd9\u6837\u5c31\u628a\u65f6\u95f4\u590d\u6742\u5ea6\u964d\u5230\u4e86$O(n^4)$\u3002\n\n\u4f3c\u4e4e\u5bf9\u4e8e200\u8fd8\u662f\u6709\u4e9b\u56f0\u96be\uff0c\u66f4\u8fdb\u4e00\u6b65\uff0c\u6ce8\u610f\u5230\uff0c$f[L][x]$\u548c$g[R][y]$\u5206\u522b\u662f\u5173\u4e8e$x$\u548c$y$\u7684\u51cf\u51fd\u6570\u3002\u6240\u4ee5\u5bf9\u4e8e\u56fa\u5b9a\u7684$L,R$\uff0c\n\u5f53$x$\u53d8\u5927\u65f6\uff0c\u6700\u4f18\u7684$y$\u5e94\u8be5\u53d8\u5c0f\u624d\u80fd\u4f7f\u7b54\u6848\u66f4\u597d\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u5c06y\u4f5c\u4e3a\u4e00\u4e2a\u968fx\u589e\u52a0\u800c\u9012\u51cf\u7684\u6307\u9488\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(n^3)$\u3002\n\n\u5f53\u7136\uff0c\u5982\u679c\u4f60\u5acc\u9ebb\u70e6\uff0c\u6216\u8005\u8003\u573a\u4e0a\u6ca1\u60f3\u5230\u8fd9\u91cc\uff0c\u76f4\u63a5$n^4$\u679a\u4e3e\u7b54\u6848\uff0c\u52a0\u4e0a\u4e00\u4e9b\u5f88\u5bb9\u6613\u60f3\u5230\u7684\u526a\u679d\uff0c\u53ef\u4ee5\u628a\u5e38\u6570\u63a7\u5236\u5f97\u6781\u5c0f\uff0c\u4e5f\u80fd\u8f7b\u677e\u901a\u8fc7\u672c\u9898\u3002\u3002\u3002\u3002\u3002\u3002\u3002\n```cpp\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nint const N=401,M=101,INF=1e6;\nint n,t,a[N],b[N],u[N],v[N],p[N],q[N],inter[N][N],\nf[N][N],g[N][N],ans[N];\nint main(){\n\tcin>>n;\n\tfor (int i=1;i<=n;i++){ \n\t\tcin>>a[i]>>b[i];\n\t\tb[i]+=a[i];\n\t\tp[++t]=a[i];\n\t\tp[++t]=b[i];\n\t}\n\tsort(p+1,p+1+t);\n\tq[1]=1;\n\tfor (int i=2;i<=t;i++)\n\t\tif (p[i]==p[i-1]) q[i]=q[i-1]; else q[i]=q[i-1]+1;\n\tfor (int i=1;i<=n;i++)\n\t\tfor (int j=1;j<=t;j++) {\n\t\t\tif (a[i]==p[j]) u[i]=q[j];\n\t\t\tif (b[i]==p[j]) v[i]=q[j];\n\t\t}\n\tt=q[t];\n\tfor (int i=1;i<=t;i++)\n\t\tfor (int j=i+1;j<=t;j++)\n\t\t\tfor (int k=1;k<=n;k++)\n\t\t\t\tif (u[k]>=i && v[k]<=j) inter[i][j]++;\n\tfor (int i=1;i<=t;i++)\n\t\tfor (int j=0;j<=n/2;j++){\n\t\t\tf[i][j]=-INF;\n\t\t\tif (j==0) f[i][j]=inter[1][i];\n\t\t\tfor (int k=1;k<=i-1;k++){\n\t\t\t\tf[i][j]=max(f[i][j],f[k][j]+inter[k][i]);\n\t\t\t\tf[i][j]=max(f[i][j],f[k][max(0,j-inter[k][i])]); \n\t\t\t}\n\t\t}\n\tfor (int i=t;i>=1;i--)\n\t\tfor (int j=0;j<=n/2;j++){\n\t\t\tg[i][j]=-INF;\n\t\t\tif (j==0) g[i][j]=inter[i][t];\n\t\t\tfor (int k=i+1;k<=t;k++){\n\t\t\t\tg[i][j]=max(g[i][j],g[k][j]+inter[i][k]);\n\t\t\t\tg[i][j]=max(g[i][j],g[k][max(0,j-inter[i][k])]); \n\t\t\t}\n\t\t}\n\tfor (int k=1;k<=n;k++){\n\t\tfor (int i=u[k];i>=1;i--)\n\t\t\tfor (int j=v[k];j<=t;j++){\n\t\t\t\tfor (int l=0;l<=inter[1][i];l++){\n\t\t\t\t\tfor (int r=0;r<=inter[j][t];r++){\n\t\t\t\t\t\tans[k]=max(ans[k],min(l+r+inter[i][j],f[i][l]+g[j][r]));\n\t\t\t\t\t\tif (g[j][r]<r) break; \t\t\n\t\t\t\t\t}\n\t\t\t\t\tif (f[i][l]<l) break;\n\t\t\t\t}\n\t\t\t\tif (inter[1][i]+inter[j][t]<ans[k]) break;\n\t\t\t\tif (inter[i][j]>inter[1][i]+inter[j][t]) break;\n\t\t\t}\n\t\tans[0]=max(ans[0],ans[k]); \n\t} \n\tfor (int k=0;k<=n;k++)\n\t\tcout<<ans[k]<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1535345162,
        "uid": 95804,
        "name": "wu3412790",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1973 \u3010[NOI2011]Noi\u5609\u5e74\u534e\u3011"
    },
    {
        "content": "DP\u9898\u6015\u662f\u90fd\u8981\u5927\u5927\u7684\u8111\u6d1e\u3002\u3002\u3002\u3002\u3002\u3002\n\n\u9996\u5148\uff0c\u65f6\u95f4\u90a3\u4e48\u5927\u6ca1\u7528\uff0c\u76f4\u63a5\u79bb\u6563\u5316\u3002\n\n\u7b2c\u4e00\u95ee\u8fd8\u597d\u3002\u6839\u636e\u9898\u610f\u5bb9\u6613\u53d1\u73b0\uff0c\u5f53\u4e00\u5806\u6d3b\u52a8\u7684\u65f6\u95f4\u6709\u5927\u91cf\u91cd\u53e0\u7684\u65f6\u5019\uff0c\u66f4\u597d\u7684\u529e\u6cd5\u662f\u628a\u5b83\u4eec\u5168\u90e8\u5b89\u6392\u5230\u4e00\u8fb9\u53bb\u3002\u90a3\u4e48\u6211\u4eec\u8f6c\u79fb\u7684\u65f6\u5019\u4e5f\u80af\u5b9a\u662f\u8981\u4e00\u5757\u4e00\u5757\u5730\u8f6c\u79fb\u5566\u3002\n\n\u8bbe$tot_{l,r}$\u4e3a\u5b8c\u5168\u88ab\u5305\u542b\u5728$l-r$\u65f6\u95f4\u5185\u6d3b\u52a8\u603b\u6570\uff0c\u76f4\u63a5$O(n^3)$\u66b4\u529b\u6c42\u5c31\u597d\u4e86\u3002\n\n\u8bbe$pre_{i,j}$\u4e3a\u65f6\u95f4$1-i$\u5185\u4e00\u8fb9\u9009$j$\u4e2a\u65f6\uff0c\u53e6\u4e00\u8fb9\u80fd\u9009\u7684\u6700\u5927\u503c\u3002\u679a\u4e3e\u4e00\u5757\u8f6c\u79fb\u7684\u8bdd\uff0c\u6211\u4eec\u7684\u65b9\u7a0b\u5e94\u8be5\u5199\u6210\u8fd9\u6837\uff1a\n\n$$pre_ {i,j}=\\max\\limits_{k=1}^i\\{pre_ {k,j}+tot_{k,i},pre _{k,j-tot _{k,i}}\\}$$\n\n\uff08\u663e\u7136\u4e24\u79cd\u60c5\u51b5\u90fd\u8981\u8003\u8651\uff09\n\n\u7136\u540e\u7b54\u6848\u5c31\u662f$\\max\\limits_{j=1}^n\\{\\min(pre_{m,j},j)\\}$\u5566\uff08$m$\u4e3a\u79bb\u6563\u5316\u540e\u7684\u65f6\u95f4\u603b\u957f\uff0c\u4e0d\u4f1a\u8d85\u8fc7$2n$\uff09\n\n\u8fd9\u4e2a\u6570\u7ec4\u4e3a\u4ec0\u4e48\u8981\u53eb$pre$\u5462\uff1f\u8fd9\u662f\u4e2a\u524d\u7f00DP\u503c\u3002\u4e3a\u4e86\u7b2c\u4e8c\u95ee\uff0c\u6211\u4eec\u8fd8\u8981\u505a\u4e2a\u540e\u7f00DP\uff0c$suf_{i,j}$\u8868\u793a\u65f6\u95f4$i-m$\u5185\u4e00\u8fb9\u9009$j$\u4e2a\u65f6\uff0c\u53e6\u4e00\u8fb9\u80fd\u9009\u7684\u6700\u5927\u503c\uff0c\u8ddf$pre$\u51e0\u4e4e\u4e00\u6837\u7684\u8f6c\u79fb\uff0c\u4e5f\u662f$O(n^3)$\u7684\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u95ee\uff0c\u6211\u4eec\u663e\u7136\u53ef\u4ee5\u80af\u5b9a$s_i-t_i$\u4e4b\u5185\u7684\u6d3b\u52a8\u90fd\u88ab\u4e00\u8fb9\u9009\u8d70\u4e86\u3002\u81f3\u4e8e$s_i$\u4e4b\u524d\u548c$t_i$\u4ee5\u540e\u9009\u4e86\u591a\u5c11\uff0c\u6211\u4eec\u4e5f\u53ea\u597d\u679a\u4e3e\u3002\u8bbe$f_{l,r}$\u4e3a\u4e00\u8fb9\u5f3a\u5236\u9009$l-r$\u4e4b\u95f4\u6240\u6709\u6d3b\u52a8\u65f6\u6700\u4f18\u7684\u6700\u5c0f\u503c\uff0c\u5047\u5b9a\u8fd9\u4e00\u8fb9\u5728\u524d\u9762\u9009\u4e86$x$\u4e2a\uff0c\u5728\u540e\u9762\u9009\u4e86$y$\u4e2a\uff0c\u53e6\u4e00\u8fb9\u6700\u591a\u80fd\u9009\u591a\u5c11\u4e5f\u5c31\u77e5\u9053\u4e86\uff0c\u6709\u65b9\u7a0b\n\n$$f_{l,r}=\\max\\limits_{x=1}^m\\max\\limits_{y=1}^m\\{\\min(x+tot_{l,r}+y,pre_{l,x}+suf_{r,y})\\}$$\n\n\u7136\u540e\u7b2c$i$\u4e2a\u7684\u7b54\u6848\u5c31\u662f$f_{s_i,t_i}$\u4e48\uff1f\u6ce8\u610f\u5343\u4e07\u522b\u6389\u5165\u8fd9\u4e2a\u8bef\u533a\uff01$pre$\u548c$suf$\u53ea\u662f\u4fdd\u8bc1\u4e86\u5c40\u90e8\u6700\u4f18\uff0c\u800c\u6ca1\u6709\u4fdd\u8bc1\u5168\u5c40\u6700\u4f18\u3002\u8981\u8bf4\u4eba\u8bdd\u7684\u8bdd\uff0c\u5c31\u662f\u53ef\u80fd\u6709\u4e00\u4e2a\u6d3b\u52a8\u8de8\u8fc7\u4e86$s_i$\uff0c\u7136\u800c$f_{s_i,t_i}$\u5e76\u6ca1\u6709\u7edf\u8ba1\u5230\u5b83\uff0c\u53ea\u6709\u6269\u5927\u5f3a\u5236\u9009\u7684\u533a\u95f4\u4f7f\u5f97\u80fd\u591f\u5305\u542b\u5b83\uff0c\u624d\u80fd\u7edf\u8ba1\u5230\u6700\u4f18\u89e3\u3002\u4e8e\u662f\u9700\u8981\u679a\u4e3e\u5f3a\u5236\u9009\u533a\u95f4\u4e86\uff0c$ans_i=\\max\\limits_{l=1}^{s_i}\\max\\limits_{r=t_i}^m\\{f_{l,r}\\}$\n\n\u8fd9\u6837\u7684\u8bdd\uff0c\u6574\u4e2a$f$\u90fd\u5fc5\u987b\u8981\u7b97\u51fa\u6765\uff0c\u4e0a\u9762\u7684\u679a\u4e3e\u7b97\u6cd5\u5c31\u53d8\u6210$O(n^4)$\u4e86\uff0c\u8dd1\u4e0d\u52a8\u3002\n\n\u70b9\u5f00\u6807\u7b7e\u53d1\u73b0\u6709\u5355\u8c03\u961f\u5217\uff1f\uff01\u849f\u84bb\u5c31\u5f80\u5355\u8c03\u6027\u4e0a\u9762\u60f3\u4e86\u60f3\uff0c\u4e8e\u662f\u5c31\u6709\u4e86\u4e00\u4e2a\u7ed3\u8bba\uff1a\u8bbe\u679a\u4e3e$x$\u65f6\u6709\u4e00\u4e2a\u4f7f\u7b54\u6848\u6700\u4f18\u7684$y$\uff0c\u90a3\u4e48\u5f53$x$\u589e\u5927\u65f6\uff0c\u5982\u679c$y$\u4e5f\u589e\u5927\u90a3\u4e48\u7b54\u6848\u4e0d\u4f1a\u66f4\u4f18\u3002\u89c2\u5bdf\u4e0a\u9762\u90a3\u4e2a\u5f0f\u5b50$\\min(x+tot_{l,r}+y,pre_{l,x}+suf_{r,y})$\uff0c\u90a3\u4e48\u56e0\u4e3a$pre,suf$\u90fd\u662f\u9012\u51cf\u7684\uff0c\u6240\u4ee5\u5f88\u663e\u7136\u6211\u4eec\u4e0d\u80fd\u8ba9$x,y$\u53d8\u5927\u800c$pre,suf$\u53d8\u5c0f\u3002\n\n\u4e8e\u662f\uff0c\u5b9e\u73b0\u7684\u65f6\u5019\uff0c\u53ea\u8981\u628a$y$\u4ece\u5927\u5f80\u5c0f\u626b\u4e86\uff0c\u5e76\u4e0d\u9700\u8981\u4ec0\u4e48\u5355\u8c03\u961f\u5217\u6765\u7ef4\u62a4\u5b83\u3002\n```cpp\n#include<cstdio>\n#include<algorithm>\n#define RG register\n#define R RG int\n#define G c=getchar()\n#define Upd(A,L,R)     {chkmx(A[i][j],A[k][j]+tot[L][R]);\t\\\n\t\tif(j>=tot[L][R])chkmx(A[i][j],A[k][j-tot[L][R]]);}\n#define Calc(y) min(x+tot[l][r]+y,pre[l][x]+suf[r][y])\nusing namespace std;\nconst int N=209,M=409,INF=1e9;\nint s[N],t[N],b[M],tot[M][M],pre[M][N],suf[M][N],f[M][M];\ninline int in(){\n\tRG char G;\n\twhile(c<'-')G;\n\tR x=c&15;G;\n\twhile(c>'-')x=x*10+(c&15),G;\n\treturn x;\n}\ninline int min(R x,R y){return x<y?x:y;}\ninline void chkmx(R&x,R y){if(x<y)x=y;}\nint main(){\n\tR n=in(),m=0,i,j,k,l,r,x,y,p0,p1,ans;\n\tfor(i=1;i<=n;++i){\n\t\tb[++m]=s[i]=in();\n\t\tb[++m]=t[i]=in()+s[i];\n\t}\n\tsort(b+1,b+m+1);//\u79bb\u6563\u5316\n\tm=unique(b+1,b+m+1)-b-1;\n\tfor(i=1;i<=n;++i){\n\t\ts[i]=lower_bound(b+1,b+m+1,s[i])-b;\n\t\tt[i]=lower_bound(b+1,b+m+1,t[i])-b;\n\t\tfor(l=1;l<=s[i];++l)//tot\u66b4\u529b\u6c42\n\t\t\tfor(r=m;r>=t[i];--r)++tot[l][r];\n\t}\n\tfor(i=1;i<=m;++i)//\u6ce8\u610f\u521d\u59cb\u5316\n\t\tfor(j=1;j<=n;++j)pre[i][j]=suf[i][j]=-INF;\n\tfor(i=1;i<=m;++i)\n\t\tfor(j=0;j<=tot[1][i];++j)\n\t\t\tfor(k=1;k<=i;++k)Upd(pre,k,i);\n\tfor(i=m;i;--i)//\u8f6c\u79fb\u5f88\u76f8\u4f3c\uff0c\u641e\u4e86\u4e2a\u5b8f\u5b9a\u4e49\n\t\tfor(j=0;j<=tot[i][m];++j)\n\t\t\tfor(k=i;k<=m;++k)Upd(suf,i,k);\n\tfor(l=1;l<=m;++l)\n\t\tfor(r=l+1;r<=m;++r)\n\t\t\tfor(y=n,x=0;x<=n;++x){\n\t\t\t\tp0=Calc(y);//p0\u4e3a\u6700\u4f18\u51b3\u7b56\uff0cp1\u4e3a\u5f53\u524d\u51b3\u7b56\n\t\t\t\twhile(y&&p0<=(p1=Calc(y-1)))p0=p1,--y;\n\t\t\t\tchkmx(f[l][r],Calc(y));\n\t\t\t}\n\tans=0;\n\tfor(j=1;j<=n;++j)chkmx(ans,min(pre[m][j],j));\n\tprintf(\"%d\\n\",ans);\n\tfor(i=1;i<=n;++i){\n\t\tans=0;\n\t\tfor(l=1;l<=s[i];++l)\n\t\t\tfor(r=m;r>=t[i];--r)chkmx(ans,f[l][r]);\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1534153166,
        "uid": 61325,
        "name": "FlashHu",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P1973 \u3010[NOI2011]Noi\u5609\u5e74\u534e\u3011"
    },
    {
        "content": "\u524d\u9762\u7684\u8bdd:\n\n\u8fd9\u9053dp\u4f18\u5316\u7684\u96be\u5ea6\u5e76\u4e0d\u5927,\u4f46\u662f\u63a8\u5bfc\u6bd4\u8f83\u7ecf\u5178,\u6700\u540e\u7684\u4f18\u5316\u624b\u6bb5\u4e5f\u5f88\u7ecf\u5178,\u662f\u4e00\u9053\u7ec3\u4e60\u597d\u9898!\n\n\u7ec6\u8282\u6709\u70b9\u591a,\u4e0d\u8fc7\u5982\u679c\u8ba4\u771f\u601d\u8003\u65b9\u6cd5\u7684\u8bdd\u53ef\u4ee5\u8eb2\u6389\u5927\u90e8\u5206\u3002\n\n~~\u81ea\u4ee5\u4e3a\u628a\u6700\u540e\u7684\u5355\u8c03\u6027\u4f18\u5316\u8bb2\u7684\u6bd4\u8f83\u6e05\u695a~~\n\n------------\n\n\u9898\u610f\u6bd4\u8f83\u590d\u6742,\u7b80\u5355\u6765\u8bf4\u5427:\n\n\u7ed9\u51fa$n$\u4e2a\u533a\u95f4,\u8ba9\u4f60\u628a\u8fd9\u4e9b\u533a\u95f4\u5206\u6210\u4e24\u4efd,\u5141\u8bb8\u4e22\u5f03,**\u4e24\u4efd**\u533a\u95f4\u4e0d\u80fd\u6709\u4ea4\u3002\n\n**\u7b2c\u4e00\u95ee**: \u8ba9\u4e24\u4efd\u4e2d\u5206\u5230\u533a\u95f4\u6570\u6700\u5c0f\u7684\u4e00\u4efd,\u5c3d\u91cf\u5f97\u5230\u66f4\u591a\u7684\u533a\u95f4\u3002\n\n**\u7b2c\u4e8c\u95ee**: \u5728\u7b2c$\\forall i$\u4e2a\u533a\u95f4\u5fc5\u987b\u4e0d\u4e22\u5f03\u7684\u60c5\u51b5\u4e0b\u7684\u4e0a\u4e00\u95ee\u7b54\u6848\u3002\n\n------------\n\n## \u5206\u6790\u7b2c\u4e00\u95ee:\n\n\u6d3b\u52a8\u4e0d\u5305\u542b\u5f00\u59cb\u548c\u7ed3\u675f\u77ac\u95f4,\u4e3a\u4e86\u65b9\u4fbf\u5904\u7406,\u6211\u4eec\u5427\u6240\u6709\u7684\u533a\u95f4\u5c3e\u5148\u51cf\u4e00,\u5c31\u80fd\u8f6c\u5316\u6210\u719f\u6089\u7684\u6570\u7ec4\u5360\u4f4d\u3002\n\n\u663e\u7136\u53ef\u4ee5\u628a\u533a\u95f4\u90fd\u79bb\u6563\u5316,\u8bbe\u79bb\u6563\u5316\u4e4b\u540e\u7684\u65f6\u95f4\u57df\u4e3a$[1,T]$\n\n\u6709\u4e00\u4e2a\u4e8c\u7ef4dp:\u8bbe$f[i][j]$\u4e3a\n\n\u524d$i$\u4e2a\u65f6\u523b\u7b2c\u4e00\u4efd\u9009\u62e9\u4e86$j$(\u53ef\u4ee5\u4e3a0)\u4e2a\u533a\u95f4,\u6b64\u65f6\u7b2c\u4e8c\u4efd\u6700\u591a\u80fd\u9009\u62e9\u591a\u5c11\u4e2a\u3002\n\n(\u6ce8\u610f\u8981\u521d\u59cb\u5316\u6210-INF,\u8fb9\u754c\u662f$f[0][0]=0$)\n\n\u4e3a\u4e86\u65b9\u4fbf\u5904\u7406,\u6211\u4eec\u5728\u79bb\u6563\u5316\u540e\u65f6\u95f4\u8f74\u4e0a\u7559\u4e00\u524d\u4e00\u540e**\u4e24\u4e2a\u7a7a\u4f4d**\u3002\n\n**\u8f6c\u79fb:**\n\n\u5148\u8bbe$c(l,r)$\u6307\u88ab$[l,r]$\u5b8c\u5168\u5305\u542b\u7684\u533a\u95f4\u4e2a\u6570\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u5927\u529b$O(n^3)$\u9884\u5904\u7406,\u65b9\u6cd5\u5c31\u662f\u5224\u65ad\u6bcf\u4e2a\u533a\u95f4\u6709\u6ca1\u6709\u88ab\u5305\u5bb9\u5728$[l,r]$\u5185\u3002\n\n- (1)\u9009\u62e9\u4e00\u6bb5\u533a\u95f4\u653e\u5230\u7b2c\u4e00\u4efd\n\n$f[i][j]\\leftarrow\\max\\limits_{k=1}^{i-1}f[k][j-c(k+1,i)]$\n\n- (2)\u9009\u62e9\u4e00\u6bb5\u533a\u95f4\u653e\u5230\u7b2c\u4e8c\u4efd\n\n$f[i][j]\\leftarrow\\max\\limits_{k=1}^{i-1}f[k][j]+c(k+1,i)$\n\n\u90a3\u4e48\u7b54\u6848\u5c31\u662f$\\max\\limits_{j=0}^{n}min(f[T][j],j)$\n\n\u603b\u7684\u590d\u6742\u5ea6\u662f$O(n^3)$\n\n## \u5206\u6790\u7b2c\u4e8c\u95ee:\n\n\u5982\u4f55\u5f3a\u5236\u9009\u62e9\u67d0\u4e00\u4e2a\u533a\u95f4?\u6211\u4eec\u53ef\u4ee5\u5148\u628a\u8fd9\u4e2a\u533a\u95f4\u7ed9\u4e88\u67d0\u4e00\u4efd(\u90a3\u4e00\u4efd\u90fd\u884c,**\u4e0d\u59a8\u7ed9\u7b2c\u4e00\u4efd**),\u7136\u540e\u628a\u5269\u4e0b\u7684\u4e1c\u897f\u7b97\u51fa\u6765\u3002\n\n\u8be6\u7ec6\u5730\u8bf4:\n\n\u6211\u4eec\u8981\u8bbe$g[i][j]$\u4e3a\n\n\u540e$i$\u4e2a\u65f6\u523b\u7b2c\u4e00\u4efd\u9009\u62e9\u4e86$j$\u4e2a\u533a\u95f4,\u6b64\u65f6\u7b2c\u4e8c\u4efd\u6700\u591a\u80fd\u9009\u62e9\u591a\u5c11\u4e2a\u3002\n\n\u8f6c\u79fb\u7c7b\u4f3c$f$,\u4e0d\u518d\u8d58\u8ff0\u3002(\u8fb9\u754c\u662f$g[n+1][0]=0$)\n\n\u90a3\u4e48,\u5f3a\u5236\u9009\u62e9\u4e86\u67d0\u4e2a\u533a\u95f4$[l,r]$\u7ed9\u7b2c\u4e8c\u4efd\u4e4b\u540e,\u6211\u4eec\u8981\u679a\u4e3e\u4e2d\u95f4\u5206\u7ed9\u7b2c\u4e00\u4efd\u7684\u4e00\u6574\u6bb5\u533a\u95f4(\u5305\u542b$[l,r]$)\n\n\u6b64\u5916\u8fd8\u8981\u679a\u4e3e\u7b2c\u4e00\u4efd\u9009\u62e9\u7684\u533a\u95f4\u6570(\u524d\u540e\u90fd\u8981\u679a\u4e3e):\n\n$\\max\\limits_{i=1}^{l-1}\\max\\limits_{j=r+1}^{T}\\max\\limits_{k=0}^{n}\\max\\limits_{t=0}^{n}min(f[i][k]+g[j][t],k+t+c(i+1,j-1))$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u662f$O(n^4)$\u7684,\u603b\u590d\u6742\u5ea6\u5c31\u662f$O(n^5)$,\u4e0d\u80fd\u901a\u8fc7\u672c\u9898\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u5c0f\u533a\u95f4\u90fd\u627e\u4e00\u4e2a\u5927\u6bb5\u6765\u5305\u542b,\u6211\u4eec\u5176\u5b9e\u505a\u4e86\u5f88\u591a\u91cd\u590d\u7684\u5de5\u4f5c\u3002\n\n\u8bbe$s(l,r)=\\max\\limits_{k=0}^{n}\\max\\limits_{t=0}^{n}min(f[l][k]+g[r][t],k+t+c(l+1,r-1))$\n\n(\u6ce8\u610f\u8fd9\u4e2a\u533a\u95f4\u4e24\u8fb9\u5f00)\n\n\u90a3\u4e48\u7b54\u6848\u5c31\u53d8\u6210$\\max\\limits_{i=1}^{l-1}\\max\\limits_{j=r+1}^{T}s(i,j)$,\u8fd9\u6837\u5b50\u5c31\u662f\u4e00\u6b21$O(n^2)$\u7684\u4e86\u3002\n\n\u95ee\u9898\u5728\u4e8e\u5982\u4f55\u9884\u5904\u7406$s(l,r)$,\u6309\u7167\u4e0a\u9762\u7684\u5f0f\u5b50\u7206\u7b97\u590d\u6742\u5ea6\u9ad8\u8fbe$O(n^4)$,\u4f46\u662f\u636e\u8bf4\u52a0\u526a\u679d\u5361\u5e38\u80fd\u8fc7\u3002\n\n\u5148\u8d34\u4e00\u4e2a\u66b4\u529bCode:\n\n\u7531\u4e8e\u6570\u636e\u8fc7\u6c34\u5c45\u7136AC\u4e86?\u770b\u6765\u8003\u573a\u4e0a\u4e5f\u53ef\u4ee5\u4f7f\u7528\u8fd9\u4e9b\u9762\u5411\u6570\u636e\u7f16\u7a0b\u7684\u529e\u6cd5,\u6bd5\u7adf\u6570\u636e\u4e0d\u597d\u9020\u554a\u2026\u2026\n\n```cpp\n#include<algorithm>\n#include<cstdio>\n#define MaxN 205\n#define INF 1000000000\nusing namespace std;\nint n;\nstruct Line\n{int l,r;}l[MaxN];\nint xx[MaxN*2],tot;\nint f[MaxN*2][MaxN],g[MaxN*2][MaxN];\nint c[MaxN*2][MaxN*2],s[MaxN*2][MaxN*2];\nint main()\n{\n  scanf(\"%d\",&n);\n  for (int i=1;i<=n;i++){\n  \tscanf(\"%d%d\",&l[i].l,&l[i].r);\n  \tl[i].r+=l[i].l-1;\n  \txx[++tot]=l[i].l;\n  \txx[++tot]=l[i].r;\n  }sort(xx+1,xx+tot+1);\n  for (int i=1;i<=n;i++){\n  \tl[i].l=lower_bound(xx+1,xx+tot+1,l[i].l)-xx+1;\n  \tl[i].r=lower_bound(xx+1,xx+tot+1,l[i].r)-xx+1;\n  }tot+=2;\n\n  for (int i=1;i<=tot;i++)\n    for (int j=i;j<=tot;j++)\n      for (int k=1;k<=n;k++)\n        if (i<=l[k].l&&l[k].r<=j)\n\t\t  c[i][j]++;\n\n  for (int i=0;i<=tot+1;i++)\n    for (int j=0;j<=n;j++)\n      f[i][j]=g[i][j]=-INF;\n  f[0][0]=g[tot+1][0]=0;\n  for (int i=1;i<=tot;i++)\n    for (int j=0;j<=n;j++)\n      for (int k=0,sav;k<i;k++){\n        sav=c[k+1][i];\n        if (j>=sav)f[i][j]=max(f[i][j],f[k][j-sav]);\n        f[i][j]=max(f[i][j],f[k][j]+sav);\n      }\n\n  int ans=0;\n  for (int i=0;i<=n;i++)\n    ans=max(ans,min(f[tot][i],i));\n  printf(\"%d\\n\",ans);\n  \n  for (int i=tot;i;i--)\n    for (int j=0;j<=n;j++)\n      for (int k=i+1,sav;k<=tot+1;k++){\n        sav=c[i][k-1];\n        if (j>=sav)g[i][j]=max(g[i][j],g[k][j-sav]);\n        g[i][j]=max(g[i][j],g[k][j]+sav);\n      }\n  \n  for (int i=1;i<=tot;i++)\n    for (int j=i+2;j<=tot;j++){\n      s[i][j]=-INF;\n      for (int k=0;k<=n;k++){\n        if (f[i][k]<0)break;\n        for (int t=0;t+k<=n;t++){\n          if (g[j][t]<0)break;\n          s[i][j]=max(s[i][j],\n\t\t    min(f[i][k]+g[j][t],k+t+c[i+1][j-1])\n\t\t  );\n        }\n      }\n    }\n\n  for (int t=1;t<=n;t++){\n    ans=0;\n    for (int i=1;i<l[t].l;i++)\n      for (int j=l[t].r+1;j<=tot;j++)\n        ans=max(ans,s[i][j]);\n    printf(\"%d\\n\",ans);\n  }return 0;\n}\n```\n\n\u518d\u770b\u4e00\u904d\u5f0f\u5b50:\n\n$s(l,r)=\\max\\limits_{k=0}^{n}\\max\\limits_{t=0}^{n}min(f[l][k]+g[r][t],k+t+c(l+1,r-1))$\n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a$min$\u5f88\u70e6,\u4f46\u662f\u5b83\u7684\u5de6\u53f3\u4e24\u8fb9\u5206\u522b\u662f\u4e24\u4efd\u7684\u533a\u95f4\u6570,\u8fd9\u4e24\u4efd\u7684\u5730\u4f4d\u662f\u4e00\u6837\u7684\u3002\n\n\u90a3\u4e48,\u5bf9\u4e8e\u4e00\u79cd\u5206\u6cd5,\u628a\u4e24\u4efd\u7684\u5185\u5bb9\u4ea4\u6362\u53c8\u80fd\u5f97\u5230\u53e6\u4e00\u79cd,\u6240\u4ee5\u4f1a\u5728$min$\u4e2d\u6309\u4e24\u79cd\u987a\u5e8f\u5404\u51fa\u73b0\u4e00\u6b21\u3002\n\n\u4e5f\u5c31\u662f\u8bf4,\u6211\u4eec\u76f4\u63a5\u8ba4\u4e3a$k+t+c(l+1,r-1)$\u662f\u8f83\u5927\u503c,\u6309\u7167\u8fd9\u4e2a\u89c4\u5219\u6765\u4f18\u5316,\u6700\u7ec8\u4e0d\u4f1a\u6f0f\u6389\u6700\u4f18\u89e3\u3002\n\n(\u524d\u9762\u8bb2\u4e86$c(l+1,r-1)$\u8fd9\u4e2a\u5e38\u6570\u5206\u7ed9\u8c01\u65e0\u6240\u8c13,\u90a3\u4e48\u73b0\u5728\u89c4\u5b9a\u987a\u5e8f\u4ee5\u540e\u5206\u7ed9\u6700\u5927\u503c\u80af\u5b9a\u4e0d\u4f1a\u5f71\u54cd\u3002)\n\n\u73b0\u5728\u7684\u76ee\u6807\u5c31\u662f\u5c3d\u91cf\u8ba9\u5de6\u8fb9\u53d8\u5927(\u5728\u7ef4\u6301\u53f3\u8fb9\u5927\u7684\u60c5\u51b5\u4e0b)\n\n\u6211\u4eec\u53d1\u73b0,$f[l][k]$\u968f\u7740$k$\u7684\u589e\u5927\u800c\u51cf\u5c0f;$g[r][t]$\u968f\u7740$t$\u7684\u589e\u5927\u800c\u51cf\u5c0f\u3002\n\n\u90a3\u4e48,\u518d$k$\u589e\u52a0\u7684\u65f6\u5019,\u518d\u4ee4$t$\u589e\u52a0\u663e\u7136\u4e0d\u4f18,\u56e0\u4e3a\u6211\u4eec\u5728\u5355\u7eaf\u5730\u524a\u51cf\u5de6\u8fb9\u800c\u589e\u52a0\u53f3\u8fb9\u3002\n\n\u6709\u4e86\u8fd9\u4e2a\u5355\u8c03\u6027,\u9884\u5904\u7406\u7684\u590d\u6742\u5ea6\u5c31\u53d8\u4e3a\u4e86$O(n^3)$,\u53ef\u4ee5\u8f7b\u677e\u901a\u8fc7\u672c\u9898\u3002\n\n**Code:**\n\n\u8c8c\u4f3c\u53ea\u6bd4\u66b4\u529b\u5feb\u4e86\u4e00\u500d\u2026\u2026\n\n```cpp\n#include<algorithm>\n#include<cstdio>\n#define MaxN 205\n#define INF 1000000000\nusing namespace std;\nint n;\nstruct Line\n{int l,r;}l[MaxN];\nint xx[MaxN*2],tot;\nint f[MaxN*2][MaxN],g[MaxN*2][MaxN];\nint c[MaxN*2][MaxN*2],s[MaxN*2][MaxN*2];\nint main()\n{\n  scanf(\"%d\",&n);\n  for (int i=1;i<=n;i++){\n  \tscanf(\"%d%d\",&l[i].l,&l[i].r);\n  \tl[i].r+=l[i].l-1;\n  \txx[++tot]=l[i].l;\n  \txx[++tot]=l[i].r;\n  }sort(xx+1,xx+tot+1);\n  for (int i=1;i<=n;i++){\n  \tl[i].l=lower_bound(xx+1,xx+tot+1,l[i].l)-xx+1;\n  \tl[i].r=lower_bound(xx+1,xx+tot+1,l[i].r)-xx+1;\n  }tot+=2;\n\n  for (int i=1;i<=tot;i++)\n    for (int j=i;j<=tot;j++)\n      for (int k=1;k<=n;k++)\n        if (i<=l[k].l&&l[k].r<=j)\n\t\t  c[i][j]++;\n\n  for (int i=0;i<=tot+1;i++)\n    for (int j=0;j<=n;j++)\n      f[i][j]=g[i][j]=-INF;\n  f[0][0]=g[tot+1][0]=0;\n  for (int i=1;i<=tot;i++)\n    for (int j=0;j<=n;j++)\n      for (int k=0,sav;k<i;k++){\n        sav=c[k+1][i];\n        if (j>=sav)f[i][j]=max(f[i][j],f[k][j-sav]);\n        f[i][j]=max(f[i][j],f[k][j]+sav);\n      }\n\n  int ans=0;\n  for (int i=0;i<=n;i++)\n    ans=max(ans,min(f[tot][i],i));\n  printf(\"%d\\n\",ans);\n  \n  for (int i=tot;i;i--)\n    for (int j=0;j<=n;j++)\n      for (int k=i+1,sav;k<=tot+1;k++){\n        sav=c[i][k-1];\n        if (j>=sav)g[i][j]=max(g[i][j],g[k][j-sav]);\n        g[i][j]=max(g[i][j],g[k][j]+sav);\n      }\n  \n  for (int i=1;i<=tot;i++)\n    for (int j=i+2;j<=tot;j++){\n      s[i][j]=-INF;\n      for (int k=0,sav,t=n;k<=n;k++){\n        if (f[i][k]<0)break;\n        while(t>=0){\n          sav=min(f[i][k]+g[j][t],k+t+c[i+1][j-1]);\n          if (sav>=s[i][j])s[i][j]=sav;\n          else break;\n          t--;\n        }t++;\n      }\n    }\n\n  for (int t=1;t<=n;t++){\n    ans=0;\n    for (int i=1;i<l[t].l;i++)\n      for (int j=l[t].r+1;j<=tot;j++)\n        ans=max(ans,s[i][j]);\n    printf(\"%d\\n\",ans);\n  }return 0;\n}\n```",
        "postTime": 1564734478,
        "uid": 58705,
        "name": "command_block",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P1973 \u3010[NOI2011]NOI \u5609\u5e74\u534e\u3011"
    },
    {
        "content": "# \u89e3\u51b3\u65b9\u6848\uff1aDP\n\n>   \u9898\u76ee\u7ed9\u51fa\u4e00\u4e9b\u533a\u95f4\uff08\u6d3b\u52a8\uff09\uff0cA\u3001B\u4e24\u4e2a\u4f1a\u573a\u5206\u522b\u9009\u62e9\u5176\u4e2d\u4e00\u4e9b\uff0c\u9009\u62e9\u7684\u533a\u95f4\u4e0d\u80fd\u6709\u91cd\u53e0\u90e8\u5206\u3002\n\n\u6709\u4e24\u4e2a\u95ee\u9898\uff1a\n\n1. \u6c42\u51fa\u4e24\u4e2a\u4f1a\u573a\u4e2d\u9009\u62e9\u6d3b\u52a8\u6700\u5c11\u7684\u4e00\u4e2a\u4f1a\u573a\uff0c\u6700\u591a\u80fd\u9009\u62e9\u51e0\u4e2a\u6d3b\u52a8\u3002\n\n2. \u6c42\u51fa\u4e24\u4e2a\u4f1a\u573a\u4e2d\u9009\u62e9\u6d3b\u52a8\u6700\u5c11\u7684\u4e00\u4e2a\u4f1a\u573a\uff0c\u6700\u591a\u80fd\u9009\u62e9\u51e0\u4e2a\u6d3b\u52a8\uff08\u4f46\u8981\u4fdd\u8bc1\u5176\u4e2d\u4e00\u4e2a\u4f1a\u573a\u9009\u62e9\u7b2c$i$\u4e2a\u6d3b\u52a8\uff09\u3002\n\n\u8ba9\u6211\u4eec\u5206\u522b\u6765\u8003\u8651\u4e24\u4e2a\u95ee\u9898\u3002\n\n# \u9884\u5904\u7406\n\n\u53ef\u4ee5\u770b\u5230\u65f6\u95f4\u6bd4\u8f83\u5927\uff0c\u4e0b\u9762\u4f1a\u4f7f\u7528\u5230\u65f6\u95f4\u4f5c\u4e3aDP\u7684\u4e0b\u6807\uff0c\u8bf7**\u79bb\u6563\u5316**\u3002\n\n\u8bbe $t$ \u4e3a\u79bb\u6563\u5316\u540e\u7684\u6700\u5927\u65f6\u95f4\u70b9\u3002\n\n\u8bbe $cnt[i][j]$ \u4e3a\uff1a\u4ece\u65f6\u95f4 $i$ \u5230\u65f6\u95f4 $j$ \u4e2d\uff0c\uff08\u5b8c\u6574\u7684\uff09\u6d3b\u52a8\u6709\u591a\u5c11\u4e2a\u3002\n\n\u8ba1\u7b97 $cnt$ \uff0c\u53ef\u4ee5\u76f4\u63a5\u66b4\u529b\u6c42\u51fa\uff08\u679a\u4e3e $i$ \uff0c\u679a\u4e3e $j$ \uff0c\u679a\u4e3e\u4e00\u4e2a\u6d3b\u52a8\uff0c\u82e5\u6b64\u6d3b\u52a8\u5728 $i$ \u3001 $j$ \u533a\u95f4\u5185\uff0c $cnt[i][j]$ \u52a01\uff09\n\n**\u4ee3\u7801**\uff1a\n\n```cpp\nfor(int i = 1; i <= t; i ++) {\n\tfor(int j = 1; j <= t; j ++) {\n\t\tfor(int k = 1; k <= n; k ++) {\n\t\t\tif(i <= a[k].begin && a[k].end <= j) {\n\t\t\t\tcnt[i][j] ++;\n\t\t\t}\n\t\t\tif(j <= a[k].begin && a[k].end <= i) {\n\t\t\t\tcnt[i][j] ++;\n\t\t\t}\n\t\t}\n\t}\n}\n```\n\n# \u5bf9\u4e8e\u7b2c\u4e00\u95ee\n\n\u8bbe $pre(i, j)$ \u4e3a\uff1a\u5bf9\u4e8e\u524d $i$ \u4e2a\u65f6\u95f4\uff08\u65f6\u95f4 $[1, i]$ \uff09\uff0c\u82e5\u4f1a\u573aA\u4fdd\u8bc1\u9009\u62e9\u4e86 $j$  \u4e2a\u6d3b\u52a8\uff0c\u4f1a\u573aB\u6700\u591a\u80fd\u9009\u62e9\u591a\u5c11\u6d3b\u52a8\u3002\n\n\u8bbe $suf(i, j)$ \u4e3a\uff1a\u5bf9\u4e8e\u540e $(t - i)$ \u4e2a\u65f6\u95f4\uff08\u65f6\u95f4 $[i, t]$ \uff09\uff0c\u82e5\u4f1a\u573aA\u4fdd\u8bc1\u9009\u62e9\u4e86 $j$  \u4e2a\u6d3b\u52a8\uff0c\u4f1a\u573aB\u6700\u591a\u80fd\u9009\u62e9\u591a\u5c11\u6d3b\u52a8\u3002\uff08 $suf$ \u4e0e $pre$ \u6bd4\u8f83\u7c7b\u4f3c\uff0c\u540e\u9762\uff08\u7b2c\u4e8c\u95ee\uff09\u624d\u4f1a\u7528\u5230\uff09\n\n$pre$ \u548c $suf$ \u5148\u9884\u5904\u7406\u4e3a $-INF$ \u3002\uff08\u6ce8\u610f\uff1a $INF$ \u4e0d\u80fd\u592a\u5927\uff0c\u5426\u5219\u76f8\u51cf\u65f6\u4f1a\u6ea2\u51fa\uff09\n\n```cpp\nfor(int i = 0; i <= t; i ++) {\n    for(int j = 0; j <= n; j ++) {\n        pre[i][j] = suf[i][j] = -INF;\n    }\n}\n```\n\n\u5f97\u5230\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$\\large pre(i, j) = \\max \\limits _{1 \\le k \\le i}  pre(k, j - cnt[k][i])$\n\n$\\large \\operatorname{suf}(i, j) = \\max \\limits _{i \\le k \\le t} suf(k, j - cnt[i][k])$\n\n\u89e3\u91ca\uff1a\u5982\u679c\u4ece\u524d $i$ \u4e2a\u65f6\u95f4\u4e2d\u9009\u62e9 $j$ \u4e2a\u6d3b\u52a8\uff0c\u53ef\u4ee5\u8f6c\u6362\u4e3a\uff1a\u4ece\u524d $k$ \u4e2a\u65f6\u95f4\u4e2d\u9009\u62e9 $j - cnt[i][k]$ \u4e2a\u6d3b\u52a8\uff0c\u5c06\u5269\u4e0b\u7684 $cnt[i][k]$ \u4e2a\u6d3b\u52a8\u5206\u7ed9A\u4f1a\u573a\u3002\n\n$suf$ \u540c\u7406\u3002\n\n**\u4ee3\u7801**\uff1a\n\n```cpp\nfor(int i = 1; i <= t; i ++) {\n    for(int j = 0; j <= cnt[1][i]; j ++) {\n        if(j == 0) {\n            pre[i][j] = cnt[1][i];\n        }\n        else {\n            for(int k = 1; k <= i; k ++) {\n                pre[i][j] = max(pre[i][j], pre[k][j] + cnt[k][i]);\n                if(j >= cnt[k][i])\n                    pre[i][j] = max(pre[i][j], pre[k][j - cnt[k][i]]);\n            }\n        }\n    }\n}\nfor(int i = t; i >= 1; i --) {\n    for(int j = 0; j <= cnt[i][t]; j ++) {\n        if(j == 0) {\n            suf[i][j] = cnt[i][t];\n        }\n        else {\n            for(int k = i; k <= t; k ++) {\n                suf[i][j] = max(suf[i][j], suf[k][j] + cnt[i][k]);\n                if(j >= cnt[i][k])\n                    suf[i][j] = max(suf[i][j], suf[k][j - cnt[i][k]]);\n            }\n        }\n    }\n}\n```\n\n\u5bf9\u4e8e\u7b2c\u4e00\u95ee\uff0c\u7b54\u6848\u5c31\u662f $\\large \\max \\limits _{1 \\le i \\le n} \\{ min(pre[t][i], i) \\}$\n\n```cpp\nint answer = -INF;\nfor(int i = 1; i <= n; i ++) {\n\tanswer = max(answer, min(pre[t][i], i));\n}\ncout<<answer<<endl;\n```\n\n# \u5bf9\u4e8e\u7b2c\u4e8c\u95ee\n\n\u7b2c\u4e8c\u95ee\u5c31\u6709\u70b9\u9ebb\u70e6\u4e86\u3002\u5fc5\u987b\u9009\u62e9\u7b2c $k$ \u4e2a\u6d3b\u52a8\uff0c\u5047\u8bbe\u5c06\u7b2c $k$ \u4e2a\u6d3b\u52a8\u5206\u7ed9A\u4f1a\u573a\uff08\u5206\u7ed9\u8c01\u90fd\u6ca1\u5173\u7cfb\uff09\uff0c\u90a3\u4e48\u53ef\u4ee5\u679a\u4e3e\u4e00\u4e2a\u5305\u542b\u7b2c $k$ \u4e2a\u6d3b\u52a8\u7684\u533a\u95f4 $[i, j]$\uff0c\u8ba9\u5176\u4e2d\u7684\u6240\u6709\u5b8c\u6574\u533a\u95f4\u90fd\u5206\u7ed9A\u4f1a\u573a\uff08\u5f53\u7136\u4e5f\u5305\u542b\u7b2c $i$ \u4e2a\u6d3b\u52a8\uff09\u3002\n\n\u8fd9\u65f6\u518d\u679a\u4e3e\u4e00\u4e2a $x$ \u548c\u4e00\u4e2a $y$ \uff0c\u8ba9A\u4f1a\u573a\u5728\u533a\u95f4\u4e24\u8fb9\u5206\u522b\u9009\u62e9 $x$ \u548c $y$ \u4e2a\u6d3b\u52a8\uff0c\u5f97\u5230\u7b54\u6848\u3002\n\n$\\large ans = \\max \\limits _{i, j, x, y} \\{min(x + cnt[i][j] + y, pre(i,x) + suf(j,y))\\} $\n\n\u5176\u4e2dA\u4f1a\u573a\u9009\u62e9 $x + cnt[i][j] + y$ \u4e2a\u6d3b\u52a8\uff0c \u5269\u4e0b $pre(i, x) + suf(j, y)$ \u4e2a\u6d3b\u52a8\u7559\u7ed9B\u4f1a\u573a\u3002\n\n\u6709\u4e00\u70b9\u9700\u8981\u6ce8\u610f\uff1a\u7b54\u6848\u5fc5\u987b\u679a\u4e3e $i, j$ \u3002\u539f\u56e0\u662f\u53ef\u80fd\u4f1a\u6709\u4e00\u4e2a\u6d3b\u52a8\uff0c\u8de8\u8fc7\u7b2c $k$ \u4e2a\u6d3b\u52a8\u7684\u5f00\u59cb\u6216\u7ed3\u675f\uff0c\u6b64\u65f6\u4e0d\u7ba1\u662f $x + cnt[i][j] + y$ \u8fd8\u662f $pre(i, x) + suf(j, y)$ \u90fd\u4e0d\u4f1a\u5305\u542b\u5b83\u3002\n\n```\nk\uff1a                   = = = = = =\n\u67d0\u4e00\u4e2a\u6d3b\u52a8\uff1a    = = = = =\n```\n\n\u770b\u8d77\u6765\u65f6\u95f4\u590d\u6742\u5ea6\u5f88\u5927\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $k$\uff0c\u90fd\u8981\u679a\u4e3e $i, j, x, y$ \uff0c\u590d\u6742\u5ea6\u9ad8\u8fbe $O(n^5)$ \uff01\n\n\u4e8b\u5b9e\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97 $ans[i][j]$ \u4e3a\u5fc5\u987b\u9009\u62e9 $[i, j]$ \u533a\u95f4\u65f6\u7684\u7b54\u6848\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u964d\u4e3a $O(n^4)$ \u3002\n\n\u5bf9\u4e8e\u7b2c $k$ \u4e2a\u6d3b\u52a8\uff0c\u679a\u4e3e $i, j$ \uff0c\u7b54\u6848\u4e3a $\\max \\limits _{1 \\le i, j \\le t} \\{ ans[i][j] \\}$ \u3002\n\n\u5f97\u5230\u590d\u6742\u5ea6\u4e3a $O(n^4)$ \u7684\u7b97\u6cd5\u3002\n\n# \u7b2c\u4e8c\u95ee\u4f18\u5316\n\n\u7b2c\u4e8c\u95ee\u8ba1\u7b97\u7684\u6548\u7387\u74f6\u9888\u5728\u4e8e $ans[i][j]$ \u4e0a\u3002\n\n\u8ba9\u6211\u4eec\u601d\u8003\u4e00\u4e0b\uff1a\u5728 $pre(i, j)$ \u4e2d\uff0c\u5f53 $j$ \u8d8a\u6765\u8d8a\u5c0f\u65f6\uff0c\u5c31\u8bf4\u660eA\u4f1a\u573a\u5728 $[1, i]$ \u533a\u95f4\u4e2d\u9009\u62e9\u5f97\u66f4\u5c11\uff0c\u76f8\u5e94\u5730B\u4f1a\u573a\u9009\u62e9\u5f97\u66f4\u591a\u3002\n\n\u5c31\u662f\u8bf4\uff0c\u5f53 $j$ \u8d8a\u6765\u8d8a\u5c0f\uff0c $pre(i, j)$ \u7684\u503c\u4f1a\u8d8a\u6765\u8d8a\u5927\u3002\n\n$suf(i, j)$ \u4e5f\u540c\u7406\u3002\u5b83\u4eec\u90fd\u662f**\u5355\u8c03\u51fd\u6570**\u3002\n\n\u90a3\u4e48\u5f53\u8ba1\u7b97 $ans[i][j]$ \u65f6\uff0c\u968f\u7740 $x$ \u7684\u589e\u5927\uff0c $y$ \u53ea\u6709\u51cf\u5c0f\uff0c\u624d\u80fd\u66f4\u65b0\u7b54\u6848\u3002\n\n\u6211\u4eec\u4e0d\u9700\u8981\u679a\u4e3e $y$ \u4e86\uff0c\u800c\u662f\u8ba9 $y$ \u4f5c\u4e3a\u4e00\u4e2a\uff08\u626b\u63cf\uff09\u6307\u9488\uff0c\u4ece $n$ \u5f00\u59cb\u6162\u6162\u51cf\u5c0f\u3002\n\n\u5f53 $y$ \u65e0\u6cd5\u66f4\u65b0\u7b54\u6848\u65f6\uff0c\u5c31\u5c06 $y$ \u51cf1\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3)$ \u3002\n\n\u4ee3\u7801\u5e38\u6570\u8f83\u5927\uff0c\u5f00O2\u5373\u53ef\u901a\u8fc7\u672c\u9898\u3002\n\n![](https://cdn.luogu.com.cn/upload/pic/37443.png)\n\n```cpp\n//  \u6301\u7eed\u65f6\u95f4time\uff0c\u5b9e\u9645\u4e0aend = begin + time - 1\n#include<bits/stdc++.h>\n#include<unordered_map>\n#include<unordered_set>\nusing namespace std;\nconst int MAXN = 2 * 200 + 10;\nconst int INF = 10000;\nstruct Mapping {\n\tunordered_map<int, int> m;\n\tunordered_map<int, int> am;\n\tint top;\n\tint query(int x) {\n\t\tif(!m.count(x)) {\n\t\t\tm[x] = ++ top;\n\t\t\tam[top] = x;\n\t\t}\n\t\treturn m[x];\n\t}\n\tint anti_query(int x) {\n\t\treturn am[x];\n\t}\n};\nstruct Act {\n\tint begin, time, end;\n\tint index;\n};\nint n, t;\nAct a[MAXN];\nMapping Map;\nunordered_set<int> dis_set;\nvector<int> dis_array;\nvoid disp() {  //  \u79bb\u6563\u5316\n\tfor(int i = 1; i <= n; i ++) {\n\t\tdis_set.insert(a[i].begin);\n\t\tdis_set.insert(a[i].end);\n\t}\n\tfor(unordered_set<int>::iterator iter = dis_set.begin(); iter != dis_set.end(); iter ++) {\n\t\tdis_array.push_back(*iter);\n\t}\n\tsort(dis_array.begin(), dis_array.end());\n\tfor(unsigned int i = 0; i < dis_array.size(); i ++) {\n\t\tMap.query(dis_array[i]);\n\t}\n\tfor(int i = 1; i <= n; i ++) {\n\t\ta[i].begin = Map.query(a[i].begin);\n\t\ta[i].end = Map.query(a[i].end);\n\t}\n}\nint cnt[MAXN][MAXN];\nint pre[MAXN][MAXN];\nint suf[MAXN][MAXN];\nint ans[MAXN][MAXN];\n//  \u5728ans\u6570\u7ec4\u8ba1\u7b97\u4e2d\u4f7f\u7528\nint answer_clac(int i, int j, int x, int y) {\n\treturn min(x + cnt[i][j] + y, pre[i][x] + suf[j][y]);\n}\nint main() {\n\tcin>>n;\n\tfor(int i = 1; i <= n; i ++) {\n\t\tcin>>a[i].begin>>a[i].time;\n\t\ta[i].end = a[i].begin + a[i].time;\n\t\ta[i].index = i;\n\t}\n\t//  \u79bb\u6563\u5316\n\tdisp();\n\t//  \u9884\u5904\u7406cnt\u6570\u7ec4\n\tt = Map.m.size();\n\tfor(int i = 1; i <= t; i ++) {\n\t\tfor(int j = 1; j <= t; j ++) {\n\t\t\tfor(int k = 1; k <= n; k ++) {\n\t\t\t\tif(i <= a[k].begin && a[k].end <= j) {\n\t\t\t\t\tcnt[i][j] ++;\n\t\t\t\t}\n\t\t\t\tif(j <= a[k].begin && a[k].end <= i) {\n\t\t\t\t\tcnt[i][j] ++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i = 0; i <= t; i ++) {\n\t\tfor(int j = 0; j <= n; j ++) {\n\t\t\tpre[i][j] = suf[i][j] = -INF;\n\t\t}\n\t}\n\tfor(int i = 1; i <= t; i ++) {\n\t\tfor(int j = 0; j <= cnt[1][i]; j ++) {\n\t\t\tif(j == 0) {\n\t\t\t\tpre[i][j] = cnt[1][i];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor(int k = 1; k <= i; k ++) {\n\t\t\t\t\tpre[i][j] = max(pre[i][j], pre[k][j] + cnt[k][i]);\n\t\t\t\t\tif(j >= cnt[k][i])\n\t\t\t\t\t\tpre[i][j] = max(pre[i][j], pre[k][j - cnt[k][i]]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i = t; i >= 1; i --) {\n\t\tfor(int j = 0; j <= cnt[i][t]; j ++) {\n\t\t\tif(j == 0) {\n\t\t\t\tsuf[i][j] = cnt[i][t];\n\t\t\t}\n\t\t\telse {\n\t\t\t\tfor(int k = i; k <= t; k ++) {\n\t\t\t\t\tsuf[i][j] = max(suf[i][j], suf[k][j] + cnt[i][k]);\n\t\t\t\t\tif(j >= cnt[i][k])\n\t\t\t\t\t\tsuf[i][j] = max(suf[i][j], suf[k][j - cnt[i][k]]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint answer = -INF;\n\tfor(int i = 1; i <= n; i ++) {\n\t\tanswer = max(answer, min(pre[t][i], i));\n\t}\n\tcout<<answer<<endl;\n\tfor(int i = 1; i <= t; i ++) {\n\t\tfor(int j = 1; j <= t; j ++) {\n\t\t\tans[i][j] = -INF;\n\t\t\tint y = n;\n\t\t\tfor(int x = 0; x <= n; x ++) {\n\t\t\t\tint now, next;\n\t\t\t\tfor(; y >= 0; y --) {\n\t\t\t\t\tnow = answer_clac(i, j, x, y);\n\t\t\t\t\tnext = answer_clac(i, j, x, y - 1);\n\t\t\t\t\tif(next < now)\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tans[i][j] = max(ans[i][j], now);\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i = 1; i <= n; i ++) {\n\t\tanswer = -INF;\n\t\tfor(int j = 1; j <= a[i].begin; j ++) {\n\t\t\tfor(int k = a[i].end; k <= t; k ++) {\n\t\t\t\tanswer = max(answer, ans[j][k]);\n\t\t\t}\n\t\t}\n\t\tcout<<answer<<endl;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1539236802,
        "uid": 57525,
        "name": "longlongzhu123",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1973 [NOI2011]Noi\u5609\u5e74\u534e"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P1973)\n\n[\u535a\u5ba2\u98df\u7528\u6548\u679c\u66f4\u4f73](https://rsdbkhusky.github.io/2021/10/13/%E5%8F%8C%E6%8C%87%E9%92%88%E4%BC%98%E5%8C%96dp%20&%20Luogu%20P1973%20%5BNOI2011%5D%20NOI%20%E5%98%89%E5%B9%B4%E5%8D%8E/)\n\n## \u4e00. \u601d\u8def\n\n\u9996\u5148\u8fdb\u884c\u79bb\u6563\u5316\uff0c\u5c06\u6240\u6709\u533a\u95f4\u5de6\u53f3\u7aef\u70b9\u79bb\u6563\u5316\uff0c\u79bb\u6563\u6210 $m$ \u4e2a\u201c\u79bb\u6563\u70b9\u201d\uff0c\u53ea\u6709\u8fd9\u4e9b\u5730\u65b9\u624d\u53ef\u80fd\u8bbe\u7f6e\u4e3a\u65ad\u70b9\uff0c\u4e0d\u7136\u4e00\u5b9a\u662f\u4e0d\u4f18\u7684\u3002\n\n\u9996\u5148\u8003\u8651\u6734\u7d20DP\uff0c\u8bbe $sec_{l,r}$ \u4e3a\u5b8c\u5168\u88ab\u5305\u542b\u5728\u79bb\u6563\u70b9 $l\\sim r$ \u5185\u7684\u533a\u95f4\u603b\u6570\uff0c\u76f4\u63a5 \n $O(n^3)$ \u66b4\u529b\u6c42\u5c31\u597d\u4e86\u3002\n\n$pre_{i,j}$\uff1a\u79bb\u6563\u70b9 $1\\sim i$ \u5185\u5305\u542b\u7684\u533a\u95f4\uff0c\u4e00\u4e2a\u7ec4\u5206\u5230 $j$ \u4e2a\u533a\u95f4\u65f6\uff0c\u53e6\u4e00\u7ec4\u80fd\u5206\u5230\u7684\u6700\u5927\u503c\u3002\u6211\u4eec\u7684\u65b9\u7a0b\u5e94\u8be5\u5199\u6210\u8fd9\u6837\uff1a\n$$\npre_{i,j}=\\max\\limits_{k=1}^{k<i}\\{pre_{k,j}+sec_{k,i},pre_{k,j-sec_{k,i}}\\}\n$$\n\n\u7136\u540e\u6ca1\u6709\u9650\u5236\u6761\u4ef6\u4e0b\u7684\u7b54\u6848\u5c31\u662f $\\max\\limits_{j=1}^n\\{\\min(pre_{m,j},j)\\}$\n\n$suf_{i,j}$\uff1a\u79bb\u6563\u70b9 $i\\sim m$ \u5185\u5305\u542b\u7684\u533a\u95f4\uff0c\u4e00\u4e2a\u7ec4\u5206\u5230 $j$ \u4e2a\u533a\u95f4\u65f6\uff0c\u53e6\u4e00\u7ec4\u80fd\u5206\u5230\u7684\u6700\u5927\u503c\uff0c\u4e0e $pre$ \u76f8\u4f3c\u3002\n\n$d_{i,j}$\uff1a\u9650\u5236\u4e3a\u79bb\u6563\u70b9 $i\\sim j$ \u95f4\u4e0d\u80fd\u6709\u65ad\u70b9\u7684\u60c5\u51b5\u4e0b\u5206\u5230\u7684\u533a\u95f4\u8f83\u5c11\u7684\u7ec4\u522b\u4e2d\u533a\u95f4\u6570\u91cf\u7684\u6700\u5927\u503c\uff0c\u6709\u72b6\u8f6c\u65b9\u7a0b\uff1a\n\n$$\nd_{l,r}=\\max_{x=1}^{m}\\max_{y=1}^{m}\\left\\{\\min\\left(x+sec_{l,r}+y,pre_{l, x}+suf_{r, y}\\right)\\right\\}\n$$\n\n\u8981\u6c42\u7f16\u53f7\u4e3a $i$ \u7684\u533a\u95f4\uff08\u5de6\u7aef\u70b9\u4e3a $le_i$\uff0c\u53f3\u7aef\u70b9 $ri_i$\uff09\u4e0d\u80fd\u88ab\u820d\u5f03\u4e0b\u7684\u7b54\u6848\u662f\uff1a\n\n$$\nans_{i}=\\max _{l=1}^{le_{i}} \\max _{r=ri_{i}}^{m}\\left\\{d_{l, r}\\right\\}\n$$\n\n\u53ef\u4ee5\u770b\u5230\uff0c\u6574\u4e2a\u89e3\u9898\u8fc7\u7a0b\u7684\u74f6\u9888\u5c31\u662f $2\\operatorname{D}/2\\operatorname{D}$ \u7684\u6c42 $d_{i,j}$ \u7684\u8fc7\u7a0b\uff0c\u6211\u4eec\u65e0\u6cd5\u627f\u53d7 $O(n^4)$ \u7684\u590d\u6742\u5ea6\uff0c\u8981\u8003\u8651\u4f18\u5316\uff0c\u6211\u4eec\u53d1\u73b0\u5bf9\u4e8e\u56fa\u5b9a\u7684 $l,r$\uff0c\u56fa\u5b9a\u4e00\u4e2a $x$ \u540e\uff0c\u6709\u4e00\u4e2a $y$ \u4f7f $\\min\\left(x+sec_{l,r}+y,pre_{l,x}+suf_{r,y}\\right)$ \u6700\u5927\uff0c\u8bbe\u8fd9\u4e2a\u503c\u4e3a $y'_x$ \uff0c\u6839\u636e $pre_i$ \u7684\u6027\u8d28\uff0c$j$ \u4e0d\u53d8\u65f6\uff0c$pre_{i,j}$ \u968f\u7740 $j$ \u589e\u5927\u800c\u51cf\u5c0f\u3002\n\n\u5047\u8bbe\u6211\u4eec\u5df2\u6c42\u51fa\u4e86 $y'_{x}$\uff0c\u73b0\u5728\u8003\u8651 $y'_{x+a}$\uff08$a$ \u4e3a\u6b63\u6574\u6570\uff09\uff0c$x+a$ \u76f8\u5bf9\u4e8e $x$\uff0c$y$ \u4e0d\u53d8\uff0c$x+sec_{l,r}+y$ \u7684\u503c\u589e\u52a0\uff0c$pre_{l,x}+suf_{r,y}$ \u7684\u503c\u51cf\u5c0f\u3002$y'_x+b$ \uff08$b$ \u4e3a\u6b63\u6574\u6570\uff09\u76f8\u5bf9\u4e8e $y'_x$\uff0c$x$ \u4e0d\u53d8\uff0c$x+sec_{l,r}+y$ \u7684\u503c\u589e\u52a0\uff0c$pre_{l,x}+suf_{r,y}$ \u7684\u503c\u51cf\u5c0f\u3002\n\n\u6240\u4ee5\u5f97\u51fa\u7ed3\u8bba\uff0c$y'_{x+a}\\le y'_x$\uff0c\u56e0\u4e3a $>y'_x$ \u7684\u51b3\u7b56\uff0c\u5bf9 $x$ \u662f\u4e0d\u4f18\u7684\uff0c\u90a3\u4e48\u5bf9\u4e8e $x+a$ \u5c31\u66f4\u4e0d\u4f18\u4e86\u3002\n\n\u8bbe $g_{l,r,x}(y)=\\min\\left(x+sec_{l,r}+y,pre_{l,x}+suf_{r,y}\\right)$\uff08\u5728\u63a5\u4e0b\u6765\u7684\u63a8\u5bfc\u4e2d\u90fd\u5c06 $l$ \u548c $r$ \u5f53\u4f5c\u5e38\u91cf\uff0c\u6240\u4ee5\u7b80\u5199\u4e3a $g_x(y)$\uff09\uff0c\u4ed4\u7ec6\u60f3\u60f3\u53ef\u4ee5\u53d1\u73b0\uff0c\u8be5\u51fd\u6570\u6709\u4e00\u4e2a\u6781\u503c\uff0c\u5373 $x+sec_{l,r}+y=pre_{l,x}+suf_{r,y}$ \u65f6\uff0c\u5f53\u7136\u56e0\u4e3a\u53d6\u503c\u90fd\u662f\u6574\u6570\u4ed6\u4eec\u6709\u53ef\u80fd\u6ca1\u6709\u76f8\u7b49\u7684\u65f6\u523b\uff0c\u8fd9\u91cc\u6307\u7684\u662f\u8fde\u6210\u5e73\u6ed1\u66f2\u7ebf\u540e\u7684\u51fd\u6570\u3002\u5e76\u4e14\u51fd\u6570 $g_x(y)$ \u6781\u70b9\u7684\u4e00\u4fa7\u5355\u8c03\u3002\n\n\u8bf7\u6ce8\u610f\u73b0\u5728\u7684\u4e00\u4e2a**\u51fd\u6570**\u5bf9\u5e94\u7684\u662f\u4e00\u4e2a**\u72b6\u6001**\uff0c**\u6a2a\u5750\u6807**\u5bf9\u5e94\u7684\u662f**\u51b3\u7b56**\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5c1d\u8bd5\u753b\u51fa\u8fd9\u4e2a\u56fe\u8c61\uff0c\u521a\u624d\u6211\u4eec\u5df2\u7ecf\u8bc1\u51fa\u4e24\u6761\u6027\u8d28\uff1a\n\n- $op$\uff08\u6700\u4f18\u51b3\u7b56\uff09\u5177\u6709\u5355\u8c03\u6027\u3002\n- $g_i(j)$ \u6781\u70b9\u7684\u4e00\u4fa7\u5177\u6709\u5355\u8c03\u6027\u3002\n\n![](https://figurebed-1306986731.file.myqcloud.com/%E8%AF%BE%E4%BB%B6/%E6%A0%91%E5%BD%A2DP%20%26%20DP%E4%BC%98%E5%8C%96/6.png)\n\n\uff08\u56fe\u50cf\u4ec5\u4f9b\u53c2\u8003\uff0c\u4e0d\u4ee3\u8868\u5b9e\u9645\u4e0a\u5c31\u957f\u8fd9\u6837\uff0c\u8be5\u56fe\u8c61\u53ea\u663e\u793a\u51fa\u4e86\u5bf9\u89e3\u9898\u6709\u7528\u7684\u7279\u5f81\uff09\n\n- $op$\uff08\u6700\u4f18\u51b3\u7b56\uff09\u5177\u6709\u5355\u8c03\u6027\u3002\n- $g_i(j)$ \u6781\u70b9\u7684\u4e00\u4fa7\u5177\u6709\u5355\u8c03\u6027\u3002\n\n\u6839\u636e\u8fd9\u4e24\u6761\u6027\u8d28\uff0c\u53ef\u4ee5\u76f4\u63a5\u7528\u4e00\u4e2a\u6307\u9488\u4ece\u53f3\u5f80\u5de6\u626b\uff0c\u5411\u4e0a\u201c\u722c\u5761\u201d\uff0c\u5230\u9876\u70b9\u540e\u5c31\u8bb0\u5f55\u8fd9\u4e2a\u503c\uff0c\u5e76\u8f6c\u5230\u4e0b\u4e00\u6761\u51fd\u6570\uff1a\n\n![](https://figurebed-1306986731.file.myqcloud.com/%E8%AF%BE%E4%BB%B6/%E6%A0%91%E5%BD%A2DP%20%26%20DP%E4%BC%98%E5%8C%96/7.png)\n\n\u8f6c\u79fb\u7684\u4ee3\u7801\u5b9e\u73b0\uff1a\n\n```cpp\nfor (int i = 1; i <= cntmap; ++i) {\n\tfor (int j = i + 1; j <= cntmap; ++j) {\n\t\tint y = n;\n\t\tfor (int x = 0; x <= n; ++x) {\n\t\t\twhile (y && min(x+sec[i][j]+y,pre[i][x]+suf[j][y])<=min(x+sec[i][j]+y-1,pre[i][x]+suf[j][y-1])) --y;\n\t\t\td[i][j] = max(d[i][j], min(x + sec[i][j] + y, pre[i][x] + suf[j][y]));\n\t\t}\n\t\tans = max(ans, d[i][j]);\n\t}\n}\n```\n\n## \u4e8c. \u7ec6\u8282\n\n**\u5f88\u91cd\u8981\uff0c\u4e5f\u5f88\u81f4\u547d**\u3002\n\n1. \u5411\u4e0a\u201c\u722c\u5761\u201d\u65f6\uff0c\u6211\u4eec\u9700\u8981\u6bd4\u8f83\u6307\u9488\u5f53\u524d\u4f4d\u7f6e\u548c\u6307\u9488\u4e0b\u4e00\u4e2a\u4f4d\u7f6e\u4f5c\u4e3a\u51b3\u7b56\u54ea\u4e00\u4e2a\u66f4\u4f18\uff0c\u6709\u4eba\u4f1a\u7528 ```<=```\uff0c\u6709\u4eba\u4f1a\u7528 ```<```\uff0c\u5982\u679c\u4f60\u7528 ```<```\uff0c\u4f60\u4f1a\u83b7\u5f97 ${\\color{Red}0}$ \u5206\u7684\u597d\u6210\u7ee9\u3002\u95ee\u9898\u5728\u54ea\u5462\uff1f\u5982\u679c\u6709\u4e00\u4e2a\u8fd9\u6837\u7684\u51fd\u6570\uff1a\n\n   ![](https://figurebed-1306986731.file.myqcloud.com/%E8%AF%BE%E4%BB%B6/%E6%A0%91%E5%BD%A2DP%20%26%20DP%E4%BC%98%E5%8C%96/8.png)\n\n2. \u6211\u4eec\u7684\u4ee3\u7801\u5b9e\u73b0\u548c\u7406\u8bba\u662f\u6709\u4e00\u5b9a\u533a\u522b\u7684\uff0c\u901a\u5e38\u4f1a\u81ea\u52a8\u5ffd\u7565\u4e00\u4e9b\u4e0d\u53ef\u80fd\u662f\u6700\u4f18\u7684\u51b3\u7b56\uff0c\u4ee5\u672c\u4f53\u4e3a\u4f8b\uff0c\u6bd4\u5982\u6709\u8fd9\u6837\u7684\u4e00\u4e2a\u201c\u533a\u95f4\u201d\uff0c\u91cc\u9762\u521a\u597d\u5305\u542b\u4e24\u4e2a\u91cd\u5408\u7684\u533a\u95f4\uff08\u8fd8\u8bb0\u5f97\u52a0\u548c\u4e0d\u52a0\u5f15\u53f7\u7684\u201c\u533a\u95f4\u201d\u5206\u522b\u4ee3\u8868\u4ec0\u4e48\u5417\uff1f\uff09\uff1a\n\n   ![](https://figurebed-1306986731.file.myqcloud.com/%E8%AF%BE%E4%BB%B6/%E6%A0%91%E5%BD%A2DP%20%26%20DP%E4%BC%98%E5%8C%96/9.png)\n\n   \u6211\u4eec\u5f53\u7136\u4e0d\u4f1a\u820d\u5f03\u8fd9\u4e24\u4e2a\u533a\u95f4\u5176\u4e2d\u4efb\u610f\u4e00\u4e2a\uff0c\u56e0\u4e3a\u5b8c\u5168\u53ef\u4ee5\u4e0d\u820d\u5f03\u3002\u4f46\u786e\u5b9e\u6709\u4e00\u79cd\u9009\u62e9\u662f\u820d\u5f03\u5176\u4e2d\u4e00\u4e2a\uff0c\u867d\u7136\u8fd9\u6837\u4e0d\u4f18\uff0c\u4f46\u6211\u4eec\u5728\u4ee3\u7801\u4e2d\u505a\u7684\u662f\u5c06\u6240\u9009\u201c\u533a\u95f4\u201d\u4e2d\u533a\u95f4\u7684\u6570\u91cf\u4f5c\u4e3a\u6743\u503c $sec$\uff0c\u8ba1\u7b97\u7684\u65f6\u5019\u52a0\u4e0a $sec$\uff0c\u5c31\u76f8\u5f53\u4e8e\u5ffd\u7565\u4e86\u820d\u5f03\u4e00\u4e2a\u533a\u95f4\u8fd9\u79cd\u60c5\u51b5\uff0c\u8fd9\u5c31\u5bfc\u81f4\u6211\u5728\u8f93\u51fa\u6570\u7ec4 $suf$ \u4e2d\u7684\u503c\u65f6\uff0c\u770b\u5230\u4e86\u8fd9\u6837\u7684\u4e00\u5e55\uff1a\n\n   ![](https://figurebed-1306986731.file.myqcloud.com/%E8%AF%BE%E4%BB%B6/%E6%A0%91%E5%BD%A2DP%20%26%20DP%E4%BC%98%E5%8C%96/10.png)\n\n\u53ef\u4ee5\u770b\u5230\uff0c$suf$ \u51fd\u6570\u4e0d\u662f\u5355\u8c03\u7684\u4e86\uff0c\u8fd9\u662f\u56e0\u4e3a\u6211\u7684\u8f93\u5165\u6570\u636e\u6709\u4e24\u4e2a\u533a\u95f4\u662f\u91cd\u5408\u7684\uff0c\u6211\u4eec\u5728\u8ba1\u7b97 $suf$ \u65f6\u6ca1\u6709\u7b97\u53ea\u4e22\u5f03\u4ed6\u4eec\u4e4b\u4e2d\u4e00\u4e2a\u8fd9\u79cd\u60c5\u51b5\uff0c\u5bf9\u4e8e\u6734\u7d20DP\u81ea\u7136\u65e0\u4f24\u5927\u96c5\uff0c\u4f46\u53cc\u6307\u9488\u4f18\u5316DP\u8981\u6c42\u51fd\u6570\u6709\u4e25\u683c\u7684\u5355\u8c03\u4e0d\u964d\u6027\u3002\u7528\u56fe\u50cf\u6765\u8bf4\u8bdd\u5c31\u662f\u51fa\u73b0\u4e86\u8fd9\u79cd\u60c5\u51b5\uff1a\n\n   ![](https://figurebed-1306986731.cos.ap-beijing.myqcloud.com/%E8%AF%BE%E4%BB%B6/%E6%A0%91%E5%BD%A2DP%20%26%20DP%E4%BC%98%E5%8C%96/11.png)\n\n   **\u6ce8\u610f**\uff1a\u4e0a\u9762\u8fd9\u4e2a\u51fd\u6570\u8868\u793a\u7684\u662f\u6570\u7ec4\u91cc\u5b58\u7684\u503c\uff0c\u662f\u7528\u8ba1\u7b97\u673a\u7b97\u51fa\u6765\u7684\u503c\uff0c\u800c\u975e\u5b9e\u9645\u7684\u51fd\u6570\uff0c\u5982\u679c\u51fd\u6570\u786e\u5b9e\u5c31\u957f\u8fd9\u6837\u4ed6\u6839\u672c\u5c31\u6ee1\u8db3\u4e0d\u4e86\u53cc\u6307\u9488\u4f18\u5316\u7684\u524d\u63d0\u6761\u4ef6\uff01\n\n   \u56e0\u4e3a\u6ee1\u8db3 $suf_i\\ge suf_{i+a}$\uff08$a$ \u4e3a\u6b63\u6574\u6570\uff09\uff0c\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u5751\u586b\u5e73\uff1a\n\n   ![](https://figurebed-1306986731.file.myqcloud.com/%E8%AF%BE%E4%BB%B6/%E6%A0%91%E5%BD%A2DP%20%26%20DP%E4%BC%98%E5%8C%96/12.png)\n\n\u586b\u5751\u4ee3\u7801\u5b9e\u73b0\uff1a\n\n```cpp\nfor (int i = 1; i <= cntmap; ++i) {\n\tfor (int j = n - 1; ~j; --j) {\n\t\tpre[i][j] = max(pre[i][j], pre[i][j + 1]);\n\t}\n}\n\nfor (int i = 1; i <= cntmap; ++i) {\n\tfor (int j = n - 1; ~j; --j) {\n\t\tsuf[i][j] = max(suf[i][j], suf[i][j + 1]);\n\t}\n}\n```\n\n## \u4e09. \u4ee3\u7801\n\n\u5b8c\u6574\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int MAXn = 2e2;\n\ntemplate <typename T> \ninline void read(T &a) {\n    register char c;while (c = getchar(), c < '0' || c > '9');register T x(c - '0');while (c = getchar(), c >= '0' && c <= '9') {x = (x << 1) + (x << 3) + (c ^ 48);}a = x;  \n}\ntemplate <typename T, typename ...Argv>\ninline void read(T &n, Argv &...argv) {\n    read(n), read(argv...);\n}\n\nint n;\nint cntmap, mapup[MAXn * 2 + 10]; map<int, int> mapdown;\nint le[MAXn + 10], ri[MAXn + 10];\nint sec[MAXn * 2 + 10][MAXn * 2 + 10];\nint pre[MAXn * 2 + 10][MAXn + 10], suf[MAXn * 2 + 10][MAXn + 10], d[MAXn * 2 + 10][MAXn * 2 + 10], ans;\nsigned main() {\n\tread(n);\n\tfor (int i = 1, l, len, r; i <= n; ++i) {\n\t\tread(l, len); r = l + len;\n\t\tle[i] = l;\n\t\tri[i] = r;\n\t\tmapup[++cntmap] = l;\n\t\tmapup[++cntmap] = r;\n\t}\n\tsort(mapup + 1, mapup + 1 + cntmap);\n\tcntmap = unique(mapup + 1, mapup + 1 + cntmap) - (mapup + 1);\n\tfor (int i = 1; i <= cntmap; ++i) {\n\t\tmapdown[mapup[i]] = i;\n\t}\n\tfor (int i = 1; i <= n; ++i) {\n\t\tle[i] = mapdown[le[i]];\n\t\tri[i] = mapdown[ri[i]];\n\t}\n\tfor (int i = 1; i <= cntmap; ++i) {\n\t\tfor (int j = i + 1; j <= cntmap; ++j) {\n\t\t\tfor (int k = 1; k <= n; ++k) {\n\t\t\t\tif (le[k] >= i && ri[k] <= j) ++sec[i][j];\n\t\t\t}\n\t\t}\n\t}\n\tmemset(pre, 0xc0, sizeof(pre));\n\tpre[1][0] = 0;\n\tfor (int i = 2; i <= cntmap; ++i) {\n\t\tfor (int j = 0; j <= n; ++j) {\n\t\t\tfor (int k = 1; k < i; ++k) {\n\t\t\t\tpre[i][j] = max(pre[i][j], max(pre[k][j - sec[k][i]], pre[k][j] + sec[k][i]));\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i = 1; i <= cntmap; ++i) {\n\t\tfor (int j = n - 1; ~j; --j) {\n\t\t\tpre[i][j] = max(pre[i][j], pre[i][j + 1]);\n\t\t}\n\t}\n\tmemset(suf, 0xc0, sizeof(suf));\n\tsuf[cntmap][0] = 0;\n\tfor (int i = cntmap - 1; i; --i) {\n\t\tfor (int j = 0; j <= n; ++j) {\n\t\t\tfor (int k = cntmap; k > i; --k) {\n\t\t\t\tsuf[i][j] = max(suf[i][j], max(suf[k][j - sec[i][k]], suf[k][j] + sec[i][k]));\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i = 1; i <= cntmap; ++i) {\n\t\tfor (int j = n - 1; ~j; --j) {\n\t\t\tsuf[i][j] = max(suf[i][j], suf[i][j + 1]);\n\t\t}\n\t}\n\tfor (int i = 1; i <= cntmap; ++i) {\n\t\tfor (int j = i + 1; j <= cntmap; ++j) {\n\t\t\tint y = n;\n\t\t\tfor (int x = 0; x <= n; ++x) {\n\t\t\t\twhile (y && min(x + sec[i][j] + y, pre[i][x] + suf[j][y]) <= min(x + sec[i][j] + y - 1, pre[i][x] + suf[j][y - 1])) --y;\n\t\t\t\td[i][j] = max(d[i][j], min(x + sec[i][j] + y, pre[i][x] + suf[j][y]));\n\t\t\t}\n\t\t\tans = max(ans, d[i][j]);\n\t\t}\n\t}\n\tprintf(\"%d\\n\", ans);\n\tfor (int i = 1; i <= n; ++i) {\n\t\tint partans = 0;\n\t\tfor (int j = le[i]; j; --j) {\n\t\t\tfor (int k = ri[i]; k <= cntmap; ++k) {\n\t\t\t\tpartans = max(partans, d[j][k]);\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\", partans);\n\t}\n}\n```",
        "postTime": 1634129327,
        "uid": 392727,
        "name": "rsdbk_husky",
        "ccfLevel": 8,
        "title": "Luogu P1973 [NOI2011] NOI \u5609\u5e74\u534e"
    },
    {
        "content": "\u9996\u5148\u5c06\u65f6\u95f4\u79bb\u6563\u5316\u3002\u8bbe\u79bb\u6563\u5316\u4ee5\u540e\u65f6\u95f4\u7684\u503c\u57df\u4e3a $[1,N], N \\leq 2n$ \u3002\n\n\u53ef\u4ee5 $\\mathcal{O}(n^2)$ \u524d\u7f00\u548c\uff08\u5176\u5b9e $\\mathcal{O}(n^3)$ \u66b4\u529b\u5c31\u884c\u5566\uff09\u9884\u5904\u7406 $\\operatorname{cnt}_{l,r}$ \uff0c\u8868\u793a\u5b8c\u5168\u5305\u542b\u5728 $[l,r]$ \u4e4b\u95f4\u7684\u6d3b\u52a8\u6570\u91cf\u3002\n\n$\\operatorname{pre}_{i,j}$ \u8868\u793a\u5728\u533a\u95f4 $[1,i]$ \u4e2d\uff0c\u4fdd\u8bc1\u5176\u4e2d\u4e00\u4e2a\u4f1a\u573a\u81f3\u5c11\u6709 $j$ \u573a\u6d3b\u52a8\u65f6\uff0c\u53e6\u4e00\u4e2a\u4f1a\u573a\u6d3b\u52a8\u6570\u91cf\u7684\u6700\u5927\u503c\u3002\n\n\u521d\u59cb\u6761\u4ef6\u662f\uff1a $\\operatorname{pre}_{1,0} = 0$ \u3002\u4e0d\u53ef\u884c\u7684\u90fd\u8d4b\u4e3a $-\\infty$ \u3002\uff08\u6211\u4ee3\u7801\u91cc\u8d4b\u4e86 $-1$ \u5e76\u7279\u5224\uff09\n\n\u8f6c\u79fb\u65b9\u6cd5\u662f\u679a\u4e3e\u533a\u95f4 $[k, i]$\uff0c\u5c06\u5176\u4e2d\u6240\u6709\u6d3b\u52a8\u90fd\u5206\u914d\u7ed9\u67d0\u4e00\u4e2a\u4f1a\u573a\u3002\n\n\u5177\u4f53\u6765\u8bb2\u662f\uff1a\n\n$$\\operatorname{pre}_{i,j} = \\max_{k = 1}^{i}\\{\\operatorname{pre}_{k,j} + \\operatorname{cnt}_{k,i}\\}$$\n\n\u4ee5\u53ca\n\n$$\\operatorname{pre}_{i,j} = \\max_{k = 1}^{i}\\{\\operatorname{pre}_{k,\\max(j-\\operatorname{cnt}_{k,i},0)}\\}$$\n\n$\\operatorname{suf}_{i,j}$ \u8868\u793a\u5728\u533a\u95f4 $[i,N]$ \u4e2d\uff08\u7c7b\u4f3c\u7684\u4e8b\u60c5\uff09\uff0c\u8fd9\u91cc\u4e0d\u518d\u505a\u8d58\u8ff0\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u53d1\u73b0 $\\operatorname{pre}_{n}$\uff08\u5176\u5b9e $\\operatorname{suf}_1$ \u4e5f\u662f\uff09\u8bb0\u5f55\u4e86\u5168\u5c40\u7684\u60c5\u51b5\u3002\n\n\u4e8e\u662f\u7b2c\u4e00\u95ee\u5c31\u53ef\u4ee5\u89e3\u51b3\u4e86\uff1a\n\n$$\\operatorname{ans}_0=\\max_{i=1}^{N}\\{\\min(i,\\operatorname{pre}_{N,i})\\}$$\n\n\u5230\u8fd9\u91cc\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n^3)$ \u3002\n\n\u5173\u952e\u5728\u4e8e\u7b2c\u4e8c\u95ee\u3002\u6709\u4e00\u4e2a\u6d3b\u52a8\u5f3a\u5236\u9009\u62e9\uff0c\u600e\u4e48\u5904\u7406\u5462\uff1f\n\n\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u4e00\u4e2a\u5b8c\u5168\u5305\u542b\u8fd9\u4e00\u9879\u6d3b\u52a8\u7684\u533a\u95f4\uff0c\u628a\u533a\u95f4\u5185\u6240\u6709\u7684\u6d3b\u52a8\u90fd\u5206\u914d\u7ed9\u67d0\u4e00\u4e2a\u4f1a\u573a\u3002\u81f3\u4e8e\u8fd9\u4e2a\u533a\u95f4\u7684\u4e24\u4fa7\uff0c\u518d\u5206\u522b\u679a\u4e3e\u5b83\u4eec\u6709\u51e0\u4e2a\u6d3b\u52a8\u5206\u914d\u7ed9\u8be5\u4f1a\u573a\uff0c\u5176\u4f59\u7684\u90fd\u5206\u914d\u7ed9\u53e6\u4e00\u4e2a\u4f1a\u573a\u3002\n\n\u4e8e\u662f\u7b54\u6848\u5c31\u662f\uff1a\n\n$$\\operatorname{ans}_i=\\max_{L=1}^{l_i}\\max_{R=r_i}^{N}\\max_{x=0}^{n}\\max_{y=0}^{n}\\{\\min(\\operatorname{cnt}_{L,R}+x+y,\\operatorname{pre}_{L,x}+\\operatorname{suf}_{R,y})\\}$$\n\n\u90a3\u4e48\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u76f4\u63a5\u5c31\u8fd9\u4e2a\u6d3b\u52a8\u672c\u8eab\u7684\u5de6\u53f3\u4e24\u8fb9\u8fdb\u884c\u8ba8\u8bba\u5462\uff1f\u5f88\u7b80\u5355\uff0c\u5982\u679c\u6709\u53e6\u4e00\u9879\u6d3b\u52a8\u8de8\u8d8a\u4e86\u5b83\u7684\u7aef\u70b9\uff0c\u5b83\u5c31\u6c38\u8fdc\u4e0d\u53ef\u80fd\u88ab\u9009\u62e9\u3002\n\n\u73b0\u5728\u8fd9\u4e2a\u7b97\u6cd5\u662f $\\mathcal{O}(n^5)$ \u7684\u3002\u4f46\u662f\uff0c\u6211\u4eec\u53d1\u73b0\u5f3a\u5236\u9009\u53d6\u7684\u533a\u95f4\uff0c\u5b83\u4f1a\u88ab\u8ba1\u7b97\u591a\u904d\uff0c\u6240\u4ee5\u53ef\u4ee5\u5148\u628a\u5b83\u9884\u5904\u7406\u4e00\u4e0b\uff0c\u4e5f\u5c31\u662f\uff1a\n\n$$\\operatorname{tmp}_{L,R}=\\max_{x=0}^{n}\\max_{y=0}^{n}\\{\\min(\\operatorname{cnt}_{L,R}+x+y,\\operatorname{pre}_{L,x}+\\operatorname{suf}_{R,y})\\}$$\n\n\u800c\n\n$$\\operatorname{ans}_i=\\max_{L=1}^{l_i}\\max_{R=r_i}^{N}\\{\\operatorname{tmp}_{L,R}\\}$$\n\n\u73b0\u5728\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}(n^4)$\uff0c\u74f6\u9888\u5728\u6c42 $\\operatorname{tmp}$ \u4e0a\u3002\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\uff0c\u5728\u6c42\u89e3 $\\operatorname{tmp}$ \u65f6\uff0c\u5f53 $x$ \u589e\u52a0\u65f6\uff0c$y$ \u5e94\u5f53\u51cf\u5c0f\u624d\u80fd\u8fbe\u5230\u4e00\u4e2a\u65b0\u7684\u6700\u4f18\u4f4d\u7f6e\u3002\n\n\u4e8e\u662f\u53ef\u4ee5\u4e0d\u679a\u4e3e $y$ \uff0c\u800c\u662f\u4f7f\u7528\u53cc\u6307\u9488\uff0c\u5f53 $x$ \u589e\u52a0\u65f6\uff0c$y$ \u51cf\u5c11\u5230\u4e0d\u80fd\u518d\u51cf\u5c11\uff08\u4e5f\u5c31\u662f\u51cf\u5c11\u4ee5\u540e\u4f1a\u662f\u7b54\u6848\u53d8\u5c0f\uff09\u3002\n\n\u4e8e\u662f\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u53d8\u6210\u4e86 $\\mathcal{O}(n^3)$ \u3002\u53ef\u4ee5\u8fc7\u4e86\u3002\n\n\u90a3\u4e3a\u4ec0\u4e48\u8fd9\u662f\u5bf9\u7684\u5462\uff1f\u5728\u5927\u591a\u6570\u9898\u89e3\u91cc\u90fd\u6ca1\u6709\u8bc1\u660e\u3002\n\n\u6240\u4ee5\u6211\u6765\u5927\u81f4\u8bf4\u660e\u4e00\u4e0b\u53cc\u6307\u9488\u7684\u6b63\u786e\u6027\u3002\n\n\u6211\u4eec\u7528\u53cc\u6307\u9488\u6c42\u7684\u662f \u5173\u4e8e $x,y$ \u7684\u51fd\u6570 $f(x,y)=\\min(\\operatorname{cnt}_{L,R}+x+y,\\operatorname{pre}_{L,x}+\\operatorname{suf}_{R,y})$ \u7684\u6700\u5927\u503c\u3002\n\n\u9996\u5148\uff0c\u5f53 $x$ \u4e0d\u53d8\u65f6\uff0c$\\operatorname{cnt}_{L,R}+x+y$ \u5355\u8c03\u589e\u52a0\uff0c\u800c $\\operatorname{pre}_{L,x}+\\operatorname{suf}_{R,y}$ \u5355\u8c03\u4e0d\u589e\uff0c\n\n\u6240\u4ee5 $f(x,y)$ \u662f\u5173\u4e8e $y$ \u7684\u975e\u4e25\u683c\u5355\u5cf0\u51fd\u6570\u3002\n\n\u6240\u4ee5\u51cf\u5c11\u5230\u4e0d\u80fd\u518d\u51cf\u5c11\u5c31\u505c\u6b62\u7684\u529e\u6cd5\u662f\u53ef\u884c\u7684\u3002\n\n\u7136\u540e\uff0c\u5f53 $x$ \u589e\u52a0\u65f6\uff0c$\\operatorname{cnt}_{L,R}+x+y$ \u5e38\u6570\u9879\uff08\u56e0\u4e3a\u662f\u5173\u4e8e $y$ \uff0c\u6240\u4ee5 $x$ \u5c31\u662f\u5e38\u6570\u9879\uff09\u589e\u52a0\uff0c\u800c $\\operatorname{pre}_{L,x}+\\operatorname{suf}_{R,y}$ \u5e38\u6570\u9879\u4e0d\u589e\uff0c\n\n\u753b\u56fe\u53ef\u77e5\u4ea4\u70b9\u4f1a\u5f80\u5de6\u79fb\u3002\u6240\u4ee5\u5cf0\u503c\u6240\u5bf9\u5e94\u7684 $y$ \u7684\u503c\u4e0d\u51cf\u3002\n\n\u6ce8\u610f\u4e24\u4e2a\u4ee3\u7801\u7ec6\u8282\uff1a\n\n1. \u8f6c\u79fb\u4e2d\uff0c$\\operatorname{pre}_{i,j} = \\max_{k = 1}^{i}\\{\\operatorname{pre}_{k,\\max(j-\\operatorname{cnt}_{k,i},0)}\\}$\uff0c\u4e0d\u53ef\u5199 $\\operatorname{pre}_{k,j-\\operatorname{cnt}_{k,i}}$ \uff0c\u5426\u5219\u51fd\u6570\u7684\u5355\u8c03\u6027\u5c31\u4e0d\u80fd\u4fdd\u8bc1\u3002\n\n2. \u53cc\u6307\u9488\u4e2d\uff0c$y$ \u5728\u8f6c\u79fb\u65f6\uff0c\u65b0\u7b54\u6848\u548c\u65e7\u7b54\u6848\u6bd4\u8f83\u65f6\u4e00\u5b9a\u8981\u4f7f\u7528 $\\leq$ \uff0c\u800c\u4e0d\u662f $\\lt$ \u3002\u56e0\u4e3a\u6211\u8bf4\u8fc7\u5b83\u662f\u975e\u4e25\u683c\u5355\u5cf0\u51fd\u6570\u3002\n\n\u7efc\u4e0a\uff0c\u7b97\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n^3)$\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include <cstdio>\n#include <algorithm>\n#define _ 210\n#define __ 410\nint n, N, s[_], t[_], p[__];\nint cnt[__][__], pre[__][_], suf[__][_], tmp[__][__], ans[_];\ninline int max(int a, int b) {\n\treturn a>b?a:b;\n}\ninline int min(int a, int b) {\n\treturn a<b?a:b;\n}\nint main() {\n\tscanf(\"%d\", &n);\n\tfor (int i = 1; i <= n; i++) {\n\t\tscanf(\"%d%d\", s+i, t+i);\n\t\tt[i] += s[i];\n\t\tp[++N] = s[i];\n\t\tp[++N] = t[i];\n\t}\n\tstd::sort(p+1, p+N+1);\n\tN = std::unique(p+1, p+N+1) - p - 1;\n\tfor (int i = 1; i <= n; i++) {\n\t\ts[i] = std::lower_bound(p+1, p+N+1, s[i]) - p;\n\t\tt[i] = std::lower_bound(p+1, p+N+1, t[i]) - p;\n\t\tcnt[s[i]][t[i]]++;\n\t}\n\tfor (int l = 1; l <= N; l++) {\n\t\tfor (int i = 1; i+l <= N; i++) {\n\t\t\tcnt[i][i+l] += cnt[i][i+l-1] + cnt[i+1][i+l] - cnt[i+1][i+l-1];\n\t\t}\n\t}\n\tpre[1][0] = 0;\n\tfor (int j = 1; j <= n; j++) {\n\t\tpre[1][j] = -1;\n\t}\n\tfor (int i = 2; i <= N; i++) {\n\t\tfor (int j = 0; j <= n; j++) {\n\t\t\tpre[i][j] = -1;\n\t\t\tfor (int k = 1; k <= i; k++) {\n\t\t\t\tif (pre[k][j] != -1) pre[i][j] = max(pre[i][j], pre[k][j] + cnt[k][i]);\n\t\t\t\tpre[i][j] = max(pre[i][j], pre[k][max(0, j - cnt[k][i])]);\n\t\t\t}\n\t\t}\n\t}\n\tsuf[N][0] = 0;\n\tfor (int j = 1; j <= n; j++) {\n\t\tsuf[N][j] = -1;\n\t}\n\tfor (int i = N-1; i >= 1; i--) {\n\t\tfor (int j = 0; j <= n; j++) {\n\t\t\tsuf[i][j] = -1;\n\t\t\tfor (int k = N; k >= i; k--) {\n\t\t\t\tif (suf[k][j] != -1) suf[i][j] = max(suf[i][j], suf[k][j] + cnt[i][k]);\n\t\t\t\tsuf[i][j] = max(suf[i][j], suf[k][max(j - cnt[i][k], 0)]);\n\t\t\t}\n\t\t}\n\t}\n\tfor (int l = 1; l <= N; l++) {\n\t\tfor (int r = l; r <= N; r++) {\n\t\t\ttmp[l][r] = -1;\n\t\t\tfor (int x = 0, y = n; x <= n; x++) {\n\t\t\t\tif (pre[l][x] == -1) break;\n\t\t\t\twhile (y && (suf[r][y] == -1 || min(cnt[l][r] + x + y, pre[l][x] + suf[r][y]) <= min(cnt[l][r] + x + y - 1, pre[l][x] + suf[r][y-1]))) y--;\n\t\t\t\ttmp[l][r] = max(tmp[l][r], min(cnt[l][r] + x + y, pre[l][x] + suf[r][y]));\n\t\t\t}\n\t\t}\n\t}\n\tans[0] = -1;\n\tfor (int i = 0; i <= n; i++) {\n\t\tans[0] = max(ans[0], min(i, pre[N][i]));\n\t}\n\tfor (int i = 1; i <= n; i++) {\n\t\tans[i] = -1;\n\t\tfor (int l = s[i]; l >= 1; l--) {\n\t\t\tfor (int r = t[i]; r <= N; r++) {\n\t\t\t\tans[i] = max(ans[i], tmp[l][r]);\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i = 0; i <= n; i++) {\n\t\tprintf(\"%d\\n\", ans[i]);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1647782374,
        "uid": 153422,
        "name": "0x3F",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1973\u3010[NOI2011] NOI \u5609\u5e74\u534e\u3011"
    },
    {
        "content": "[P1973 [NOI2011] NOI \u5609\u5e74\u534e](https://www.luogu.com.cn/problem/P1973)\n\n\u9996\u5148\u628a\u65f6\u95f4\u79bb\u6563\u5316\u3002\u8003\u8651\u7b2c\u4e00\u95ee\uff0c\u8bbe $f_{i,j}$ \u8868\u793a\u524d $i$ \u65f6\u95f4\uff0c\u82e5\u4fdd\u8bc1 A \u4f1a\u573a\u6709 $j$ \u4e2a\u6d3b\u52a8\uff0cB \u4f1a\u573a\u6d3b\u52a8\u6570\u7684\u6700\u5927\u503c\u3002\u8f6c\u79fb\u65b9\u7a0b\u663e\u7136\u4e3a \n\n\n$$\nf_{i,j}=\\max\\limits_{k=0}^{i-1}\\{\\max (f_{k,j}+c_{k+1,i},f_{k,j-c_{k+1,i}})\\}\u3002\n$$\n\u5176\u4e2d $c_{i,j}$ \u8868\u793a $[i,j]$ \u65f6\u95f4\u5185\u7684\u6d3b\u52a8\u6570\u91cf\uff0c\u76f4\u63a5 $O(n^3)$ \u9884\u5904\u7406\u5373\u53ef\u3002\n\n\u518d\u8003\u8651\u7b2c\u4e8c\u95ee\u3002\u5fc5\u987b\u9009\u7b2c $i$ \u4e2a\u6d3b\u52a8\uff0c\u5c31\u662f\u4e0d\u80fd\u5b58\u5728 $[l_i,r_i]$ \u4e4b\u95f4\u7684\u8f6c\u79fb\u3002\u9884\u5904\u7406\u51fa $g_{i,j}$ \u8868\u793a\u540e $i$ \u65f6\u95f4\uff0c\u82e5\u4fdd\u8bc1 A \u4f1a\u573a\u6709 $j$ \u4e2a\u6d3b\u52a8\uff0cB \u4f1a\u573a\u6d3b\u52a8\u6570\u7684\u6700\u5927\u503c\u3002\u94a6\u5b9a\u7b2c $i$ \u4e2a\u6d3b\u52a8\u5b89\u6392\u5728 A \u4f1a\u573a\uff0c\u5219\u6709\n$$\nans=\\max\\limits_{i=0}^{l}\\max\\limits_{j=r}^{m}\\max\\limits_{x=0}^n\\max\\limits_{y=0}^n\\min(x+y+c_{i,j},f_{i-1,x}+g_{j+1,y})\n$$\n\u5355\u6b21 $O(n^4)$\uff0c\u603b\u590d\u6742\u5ea6 $O(n^5)$ \u3002\u9884\u5904\u7406\u51fa $h_{i,j}=\\max\\limits_{x=0}^n\\max\\limits_{y=0}^n\\min(x+y+c_{i,j},f_{i-1,x}+g_{j+1,y})$\uff0c\u5219 $ans=\\max\\limits_{i=0}^{l}\\max\\limits_{j=r}^{m}h_{i,j}$\u3002\u9884\u5904\u7406\u590d\u6742\u5ea6 $O(n^4)$\uff0c\u603b\u590d\u6742\u5ea6 $O(n^4)$\u3002\n\n\u66b4\u529b\u6c42 $h$\uff1a\n```cpp\nfor(int i=1;i<=tot;i++)\n\tfor(int j=i;j<=tot;j++)\n\t\tfor(int x=0;x<=n&&f[i-1][x]>=0;x++)\n\t\t\tfor(int y=0;y+x<=n&&g[j+1][y]>=0;y++)\n\t\t\t\th[i][j]=max(h[i][j],min(x+y+c[i][j],f[i-1][x]+g[j+1][y]));\n```\n~~\u5176\u5b9e\u5230\u8fd9\u91cc\u5c31\u53ef\u4ee5\u8279\u8fc7\u672c\u9898\u4e86\uff0c\u522b\u95ee\u6211\u4e3a\u55658e8\u80fd\u8fc7\u3002~~\n\n\u8003\u8651\u4f18\u5316\u6c42 $h_{i,j}$ \u7684\u590d\u6742\u5ea6\u3002\u5047\u8bbe $x+y+c_{i,j}\\le f_{i-1,x}+g_{j+1,y}$\uff08\u56e0\u4e3a\u4e24\u4e2a\u4f1a\u573a\u662f\u7b49\u4ef7\u7684\uff0c\u6240\u4ee5\u8fd9\u6837\u505a\u4e0d\u5f71\u54cd\u6b63\u786e\u6027\uff09\uff0c\u5219\u6211\u4eec\u53ea\u9700\u8981\u5c3d\u91cf\u8ba9 $f_{i-1,x}+g_{j+1,y}$ \u5927\u5373\u53ef\u3002\u53d1\u73b0 $f_{i,x}$ \u662f\u5173\u4e8e $x$ \u7684\u975e\u589e\u51fd\u6570\uff0c$g_{j,y}$ \u662f\u5173\u4e8e $y$ \u7684\u975e\u589e\u51fd\u6570\uff0c\u6240\u4ee5\u8981\u60f3\u8ba9\u548c\u503c\u5927\uff0c $x$ \u589e\u5927\u65f6 $y$ \u5fc5\u987b\u51cf\u5c0f\u3002\u90a3\u4e48\u5c31\u4e0d\u9700\u8981\u679a\u4e3e $y$ \u4e86\uff0c\u5355\u8c03\u5730\u4ece\u5927\u5f80\u5c0f\u626b\u4e00\u904d\u5373\u53ef\u3002\n\n\u4e00\u4e9b\u5b9e\u73b0\u65f6\u8981\u6ce8\u610f\u7684\u7ec6\u8282\uff1a\n\n*  \u6ce8\u610f $\\min(x+y+c_{i,j},f_{i-1,x}+g_{j+1,y})$ \u53ef\u80fd\u4f1a\u6709\u8fde\u7eed\u7684\u4e00\u6bb5\u51fd\u6570\u503c\u76f8\u540c\uff0c\u6240\u4ee5\u51cf\u5c11 $y$ \u7684\u65f6\u5019\u53ea\u8981\u51cf\u5c11\u540e\u4e0d\u4f1a\u53d8\u5dee\u5c31\u5fc5\u987b\u51cf\u5c11\u3002 \n* \u5982\u679c\u6709\u4e24\u573a\u6d3b\u52a8 $i,j$ \u65f6\u95f4\u91cd\u5408\uff0c$c$ \u5728\u8ba1\u7b97\u65f6\u4f1a\u540c\u65f6\u7b97\u4e0a\u5b83\u4eec\u4e24\u4e2a\uff0c\u5bfc\u81f4\u5b9e\u9645\u8ba1\u7b97\u65f6\u4f1a\u5f3a\u5236\u9009\u4e0a $i,j$ \u4e24\u573a\u6d3b\u52a8\u3002\u6240\u4ee5\u6211\u4eec\u9700\u8981\u7ed9\u5176\u4e2d\u4e00\u573a\u6d3b\u52a8\u52a0\u4e0a\u504f\u79fb\u91cf\u3002\n\n\u8fd9\u9898\u6570\u636e\u771f\u662f\u69fd\u591a\u65e0\u53e3\u3002\u3002\u3002 $O(n^3)$ \u6ca1\u6bd4 $O(n^4)$ \u5feb\u591a\u5c11\u4e0d\u8bf4\uff0c\u6211\u6709\u4e00\u6b21\u6837\u4f8b\u6ca1\u8fc7\u76f4\u63a5\u4ea4\u5c45\u7136 AC \u4e86\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nnamespace FGF\n{\n\tint n,m;\n\tconst int N=505,INF=0x3f3f3f3f;\n\tint a[N],tot,c[N][N],ans,l[N],r[N],f[N][N],g[N][N],h[N][N],vis[N][N];\n\tvoid work()\n\t{\n\t\tscanf(\"%d\",&n);\n\t\tfor(int i=1,s,t;i<=n;i++)\n\t\t{\n\t\t\tscanf(\"%d%d\",&s,&t);\n\t\t\ta[++tot]=l[i]=s,a[++tot]=r[i]=s+t-1;\n\t\t} \n\t\tsort(a+1,a+tot+1);\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tl[i]=lower_bound(a+1,a+tot+1,l[i])-a,r[i]=lower_bound(a+1,a+tot+1,r[i])-a;\n\t\t\tif(vis[l[i]][r[i]])r[i]++;\n\t\t\tvis[l[i]][r[i]]=1;\n\t\t}\n\t\tfor(int i=1;i<=tot;i++)\n\t\t\tfor(int j=i;j<=tot;j++)\n\t\t\t\tfor(int k=1;k<=n;k++)\n\t\t\t\t\tc[i][j]+=(l[k]>=i&&r[k]<=j);\n\t\tmemset(f,-0x3f,sizeof(f)),memset(g,-0x3f,sizeof(g));;\n\t\tg[tot+1][0]=f[0][0]=0;\n\t\tfor(int i=1;i<=tot;i++)\n\t\t\tfor(int j=0;j<=n;j++)\n\t\t\t\tfor(int k=0;k<i;k++)\n\t\t\t\t\tf[i][j]=max(f[i][j],max(f[k][j]+c[k+1][i],(j>=c[k+1][i]?f[k][j-c[k+1][i]]:-INF)));\n\t\tfor(int i=0;i<=n;i++)\n\t\t\tans=max(ans,min(i,f[tot][i]));\n\t\tprintf(\"%d\\n\",ans);\n\t\tfor(int i=tot;i;i--)\n\t\t\tfor(int j=0;j<=n;j++)\n\t\t\t\tfor(int k=i+1;k<=tot+1;k++)\n\t\t\t\t\tg[i][j]=max(g[i][j],max(g[k][j]+c[i][k-1],(j>=c[i][k-1]?g[k][j-c[i][k-1]]:-INF)));\n\t\tfor(int i=1;i<=tot;i++)\n\t\t\tfor(int j=i;j<=tot;j++)\n\t\t\t\tfor(int x=0,y=tot;x<=n&&f[i-1][x]>=0;x++)\n\t\t\t\t{\n\t\t\t\t\twhile(y&&min(f[i-1][x]+g[j+1][y],x+y+c[i][j])<=min(f[i-1][x]+g[j+1][y-1],x+y-1+c[i][j]))y--;\n\t\t\t\t\th[i][j]=max(h[i][j],min(x+y+c[i][j],f[i-1][x]+g[j+1][y]));\n\t\t\t\t}\t\t\t\t\n\t\tfor(int x=1;x<=n;x++)\n\t\t{\n\t\t\tans=0;\n\t\t\tfor(int i=1;i<=l[x];i++)\n\t\t\t\tfor(int j=r[x];j<=tot;j++)\n\t\t\t\t\tans=max(ans,h[i][j]);\n\t\t\tprintf(\"%d\\n\",ans);\n\t\t}\n\t}\n}\nint main()\n{\n\tFGF::work();\n\treturn 0;\n}\n```\n\n",
        "postTime": 1612187676,
        "uid": 224403,
        "name": "\u6728xx\u6728\u5927",
        "ccfLevel": 9,
        "title": "P1973 [NOI2011] NOI \u5609\u5e74\u534e\uff08\u51b3\u7b56\u5355\u8c03\u6027\u4f18\u5316dp\uff09"
    },
    {
        "content": "\u8c8c\u4f3c\u73b0\u6709\u9898\u89e3\u6709\u4e9b\u4e0d\u80fd\u8fc7hack,\u5199\u4e86\u4e00\u4efd\u53ef\u8fc7hack\u7684\u9898\u89e3....QAQ\n\n# init:\n\n\u9996\u5148\u9884\u5904\u7406$tot_{l,r}$\u8868\u793al,r\u65f6\u95f4\u6bb5\u4e2d\u7684\u6d3b\u52a8\u6709\u54ea\u4e9b....\n\n\u7136\u540e\u8fd9\u4e2a\u53ef\u4ee5\u7528$n^3$\u7684\u65f6\u95f4\u9884\u5904\u7406\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u518d\u9884\u5904\u7406\u4e24\u4e2a\u6570\u7ec4\n\n$pre_{i,j}$\u8868\u793a1~i\u65f6\u95f4\u6211\u4eec\u7b2c\u4e00\u4e2a\u9009\u4e86x\u7684\u524d\u63d0\u4e0b,\u7b2c\u4e8c\u4e2a\u9009\u4e86\u6d3b\u52a8\u4e2a\u6570\u7684\u6700\u5927\u503c\n\n\u7136\u540e\u600e\u4e48\u6c42\u5462?dp\u4e00\u4e0b\n\n$$pre_{i,j}=\\max_{k<i}{pre_{k,j}+tot_{i,k},pre_{k,j-tot_{i,k}}}$$\n\n\u4f60\u6ca1\u770b\u9519,\u8981\u4e48\u5206\u7ed9\u7b2c\u4e00\u4e2a\u4f1a\u573a\u8981\u4e48\u5206\u7ed9\u7b2c\u4e8c\u4e2a,$O(n^3)$\n\n\u7136\u540e\u6211\u4eec\u8fd8\u80fd\u518d\u5904\u7406\u51fa\u4e00\u4e2a$suf_{i,j}$,\u5c31\u662f\u540e\u7f00\u7684\u9009\u62e9\n\n\u5f88\u6613\u5f97\u51fa\u8f6c\u79fb\u65b9\u7a0b:\n\n$$suf_{i,j}=\\max_{k>i}{suf_{k,j}+tot_{j,k},suf_{k,j-tot_{i,k}}}$$\n\n\u8fd9\u6837\u5c31\u505a\u5b8c\u9884\u5904\u7406\u5566qwq\n\n# \u641e\u4e8b\u60c5:\n\n\u6211\u4eec\u8fd8\u8981\u8ba1\u7b97\u4e00\u4e2a\u6c42\u89e3\u7684\u6570\u7ec4$f_{l,r}$\u8868\u793a$[l,r]$\u533a\u95f4\u7684\u6d3b\u52a8\u5168\u90e8\u88ab\u4e00\u8fb9\u9009\u8d70,\u4e24\u8fb9\u6700\u4f18\u7684\u6700\u5c0f\u503c\n\n\u7136\u540e\u6211\u4eec\u8fd8\u6709\u679a\u4e3e$s_i$\u4e4b\u524d\u548c$t_i$\u4e4b\u540e\u6709\u591a\u5c11\u6d3b\u52a8\u7ed9\u4e86\u8fd9\u4e00\u8fb9,\u6240\u4ee5$x+y+sum_{l,r}$\u5c31\u662f\u7b2c\u4e00\u8fb9\u9009\u7684\u4e2a\u6570!\n\n\u800c\u53e6\u4e00\u8fb9\u5462?\u4f60\u4f1a\u53d1\u73b0\u6211\u4eec\u7684pre\u548csuf\u5c31\u6709\u7528\u4e86,\u53ef\u4ee5\u5f00\u773c\u4e86!\n\n$pre_{l,x}+suf_{r,y}$\u5c31\u662f\u7b54\u6848\n\n\u4e24\u90e8\u5206\u7ed3\u5408\u8d77\u6765,\u8f6c\u79fb\u65b9\u7a0b\u5c31\u662f\n\n$$f_{l,r}=\\max_{x}\\max_{y}{x+y+tot_{l,r},pre_{l,x}+suf_{r,y}}$$\n\n\u8fd8\u6ca1\u5b8c.....\u7b54\u6848\u5e76\u4e0d\u662f$f_{s_i,t_i}$\n\n\u56e0\u4e3a\u8fd9\u4e2apre\u548csuf\u53ea\u662f\u5c40\u90e8\u6700\u4f18,\u4ec5\u7528\u4ed6\u4eec\u5e76\u4e0d\u80fd\u63a8\u51fa\u5168\u5c40\u6700\u4f18\u89e3,\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec$f_{?,?}$\u624d\u53ef\u80fd\u662f\u5168\u5c40\u6700\u4f18\u89e3,\u800c\u6211\u4eec\u65e0\u6cd5\u77e5\u9053\u8fd9\u4e2a?\n\n\u89e3\u51b3\u65b9\u6cd5\u4e5f\u5f88\u7b80\u5355$\\max_{i<=l}\\max_{j>=r}$\u4e00\u5b9a\u662f\u7b54\u6848,\u56e0\u4e3a\u6211\u4eec\u867d\u7136\u6bcf\u4e2a\u72b6\u6001\u5e76\u4e0d\u4e00\u5b9a\u662f\u5168\u5c40\u6700\u4f18\u89e3,\u4f46\u6700\u4f18\u89e3\u4e00\u5b9a\u5728\u8fd9\u4e2a\u6570\u7ec4\u4e2d\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5$O(n^4)$\u6c42\u89e3f\u7136\u540eTLE\u4e86!\n\n\u7528\u8111\u888b\u4ed4\u7ec6\u60f3\u60f3,pre\u6570\u7ec4\u968f\u7740\u7b2c\u4e8c\u7ef4\u7684\u589e\u5927,\u4ed6\u7684\u503c\u53ea\u6709\u53ef\u80fd\u53d8\u5c0f,\u6ca1\u6709\u8bf4\u6211\u7b2c\u4e00\u4e2a\u4f1a\u573a\u6d3b\u52a8\u591a\u7b2c\u4e8c\u4e2a\u4f1a\u573a\u8ddf\u7740\u53d8\u591a\u7684\u9053\u7406\n\n\u4e5f\u5c31\u662f\u8bf4,\u968f\u7740x\u7684\u589e\u5927,y\u5982\u679c\u968f\u7740\u589e\u5927, min\u524d\u9762\u90a3\u4e2a\u53ea\u80fd\u8d8a\u6765\u8d8a\u5927,\u540e\u9762\u90a3\u4e2a\u8d8a\u6765\u8d8a\u5c0f\n\n\u6240\u4ee5\u5bf9\u4e8ex\u589e\u52a0\u6211\u4eec\u7684y\u53ea\u80fd\u4ece\u5927\u5230\u5c0f\u7684\u53d8\u6362....\n\n\u7136\u540ex\u4e00\u589e\u5927y\u53d8\u5c0f\u6328\u7740\u627e\u6700\u4f18\u51b3\u7b56\u70b9\u5c31\u505a\u5b8c\u4e86....\u56e0\u4e3a\u4e00\u5b9amin\u5728\u53d6\u5230\u540e\u9762\u90a3\u4e2a\u6570\u4e4b\u540e\u4e00\u5b9a\u4e0d\u4f1a\u518d\u53d6\u56de\u4e4b\u524d\u4e86.....\u53ea\u4f1a\u8d8a\u6765\u8d8a\u52a3\n\n\u8fd9\u6837\u51b3\u7b56\u5355\u8c03\u6027\u4f18\u5316\u6211\u4eec\u5c31\u53ef\u4ee5$O(n^3)$\u4e86...\n\n# \u8fc7hack\n\n\u4f46\u662f\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898,\u7531\u4e8etot\u662f\u8bb0\u5f55\u4e86\u6240\u6709\u5b8c\u5168\u5305\u542b\u7684,\u6240\u4ee5\u4f1a\u5bfc\u81f4\u5982\u679c\u6709\u4e24\u4e2a\u5b8c\u5168\u76f8\u540c\u7684\u533a\u95f4,\u6211\u4eectot\u4f1a\u94a6\u70b9\u4ed6\u5f3a\u5236\u90fd\u9009\u4e0a,\u6211\u4eec\u7684f\u6570\u7ec4\u6b65\u957f\u4e3a1\u5c31\u4f1a\u66f4\u65b0\u51fa\u9519,\u800c\u4e14\u8fd9\u4e2ahack\u5728\u8ba8\u8bba\u533a\u4e5f\u7ed9\u51fa\u4e86\n\n\u8981\u4e48\u66f4\u6539\u6c42f\u6570\u7ec4\u7684\u8fc7\u7a0b,\u8981\u4e48\u4f7f\u5f97\u6ca1\u6709\u4e24\u4e2a\u76f8\u540c\u533a\u95f4,\u7531\u4e8e\u8fd9\u6837\u5176\u5b9e\u672c\u8d28\u4e0a\u6211\u4eec\u53ea\u662f\u7f3a\u5c11\u4e86\u53ea\u9009\u62e9\u5176\u4e2d**\u51e0\u4e2a\u76f8\u540c\u533a\u95f4**\u7684\u51b3\u7b56,\u6240\u4ee5\u6211\u4eec\u6700\u540e\u628a\u76f8\u540c\u7684\u533a\u95f4\u53f3\u7aef\u70b9\u5411\u5185\u6270\u52a8\u4e00\u4e0b\u5c31\u597d\u4e86\n\ncode:\n\n```cpp\n\n#include<bits/stdc++.h>\n#define db double\nusing namespace std;\n#define mkp(x,y) (make_pair(x,y))\nconst int MAXN = 500;\nmap<pair<db, db>, int> mp;\nvector<db> v;\nint n, m;\nstruct rec {\n\tdb s, t;\n\tbool operator<(const rec &x)const {\n\t\treturn s + t < x.s + x.t;\n\t}\n} a[MAXN];\nint pre[MAXN][MAXN], suf[MAXN][MAXN], f[MAXN][MAXN], tot[MAXN][MAXN];\nint s[MAXN], t[MAXN]; //\u5f3a\u5361\u533a\u95f4\u91cd\u590d....\n\ninline int getid(db x) {\n\treturn lower_bound(v.begin(), v.end(), x) - v.begin() + 1;\n}\n\ninline void init() {\n\tsort(v.begin(), v.end());\n\tv.erase(unique(v.begin(), v.end()), v.end());\n\tfor(int i = 1; i <= n; ++i) {\n\t\ts[i] = getid(a[i].s);\n\t\tt[i] = getid(a[i].t);\n\t\t// printf(\"activity %d st in : %d ed in :%d \\n\", i, s[i], t[i]);\n\t}\n\tm = v.size();\n\treturn;\n}\n\ninline void init2() {\n\tfor(int i = 1; i <= m; ++i) {\n\t\tfor(int j = 1; j <= n; ++j) {\n\t\t\tpre[i][j] = suf[i][j] = -0x3f3f3f3f;\n\t\t}\n\t}\n\tfor(int i = 1; i <= m; ++i) {\n\t\tfor(int j = 0; j <= n; ++j) {\n\t\t\tfor(int k = 1; k < i; ++k) {\n\t\t\t\tpre[i][j] = max(pre[i][j], tot[k][i] + pre[k][j]);\n\t\t\t\tif(j >= tot[k][i]) {\n\t\t\t\t\tpre[i][j] = max(pre[i][j], pre[k][j - tot[k][i]]);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// printf(\"pre:!%d %d %d?\\n\", i, j, pre[i][j]);\n\t\t}\n\t}\n\tfor(int i = m; i >= 1; --i) {\n\t\tfor(int j = 0; j <= n; ++j) {\n\t\t\tfor(int k = i + 1; k <= m; ++k) {\n\t\t\t\tsuf[i][j] = max(suf[i][j], tot[i][k] + suf[k][j]);\n\t\t\t\tif(j >= tot[i][k]) {\n\t\t\t\t\tsuf[i][j] = max(suf[i][j], suf[k][j - tot[i][k]]);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// printf(\"suf:!%d %d %d?\\n\", i, j, suf[i][j]);\n\t\t}\n\t}\n\treturn ;\n}\n\nint main() {\n\tscanf(\"%d\", &n);\n\tfor(int i = 1; i <= n; ++i) {\n\t\tscanf(\"%lf%lf\", &a[i].s, &a[i].t);\n\t\ta[i].t = a[i].s + a[i].t;\n\t\tif(mp.find(mkp(a[i].s, a[i].t)) != mp.end())\n\t\t\ta[i].t = a[i].t - mp[mkp(a[i].s, a[i].t)] * 0.001;\n\t\tmp[mkp(a[i].s, a[i].t)]++;\n\t\tv.push_back(a[i].s);\n\t\tv.push_back(a[i].t);\n\t}\n\tinit();\n\tfor(int i = 1; i <= m; ++i) {\n\t\tfor(int j = i + 1; j <= m; ++j) {\n\t\t\tfor(int k = 1; k <= n; ++k) {\n\t\t\t\tif(s[k] >= i && t[k] <= j)\n\t\t\t\t\ttot[i][j]++;\n\t\t\t}\n\t\t\t// printf(\"%d %d %d\\n\", i, j, tot[i][j]);\n\t\t}\n\t}\n\tinit2();\n\tfor(int i = 1; i <= m; ++i) {\n\t\tfor(int j = i + 1; j <= m; ++j) {\n\t\t\tint p0, p1;\n\t\t\tfor(int y = n, x = 0; x <= n; ++x) {\n\t\t\t\tp0 = min(x + y + tot[i][j], pre[i][x] + suf[j][y]);\n\t\t\t\twhile(y && p0 <= (p1 = min(x + y - 1 + tot[i][j], pre[i][x] + suf[j][y - 1])))\n\t\t\t\t\tp0 = p1, --y;\n\t\t\t\tf[i][j] = max(f[i][j], min(x + y + tot[i][j], pre[i][x] + suf[j][y]));\n\t\t\t}\n\t\t}\n\t}\n\tint ans = 0;\n\tfor(int j = 1; j <= n; ++j) {\n\t\tans = max(ans, min(pre[m][j], j));\n\t\t// printf(\"?%d?%d?\\n\", j, pre[m][j]);\n\t}\n\tprintf(\"%d\\n\", ans);\n\tfor(int i = 1; i <= n; ++i) {\n\t\tans = 0;\n\t\tfor(int j = 1; j <= s[i]; ++j) {\n\t\t\tfor(int k = t[i]; k <= m; ++k) {\n\t\t\t\tans = max(ans, f[j][k]);\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\", ans);\n\t}\n\treturn 0;\n}\n\n\n\n```\n",
        "postTime": 1598658731,
        "uid": 76990,
        "name": "loveJY",
        "ccfLevel": 9,
        "title": "P1973 \u3010[NOI2011]NOI \u5609\u5e74\u534e\u3011"
    },
    {
        "content": "\u9898\u89e3:\n\n\u6211\u4eec\u8bbe\u8ba1\u72b6\u6001\u65b9\u7a0b\u5982\u4e0b:\n\nnum[i][j]\u8868\u793a\u4ece\u65f6\u95f4i\u5230j\u4e2d\u6709\u591a\u5c11\u4e2a\n\npre[i][j]\u8868\u793a\u65f6\u95f41~i\u4e2d,A\u9009\u4e86j\u4e2a\u65f6\u7684B\u80fd\u9009\u7684\u6570\u91cf\u7684\u6700\u5927\u503c.\n\nnex[i][j]\u8868\u793a\u65f6\u95f4i~cnt\u4e2d,A\u9009\u4e86j\u4e2a\u65f6\u7684B\u80fd\u9009\u7684\u6570\u91cf\u7684\u6700\u5927\u503c.\n\nmus[i][j]\u8868\u793a\u4ece\u65f6\u95f4i\u5230j\u7684\u4fdd\u8bc1\u9009\u65f6,A\u548cB\u9009\u7684\u6570\u91cf\u4e2d\u7684\u8f83\u5c0f\u503c\u7684\u6700\u5927\u503c.\n\n\u2460\u5bf9\u4e8enum\u6570\u7ec4\u76f4\u63a5\u53ef\u4ee5\u66b4\u529b\u6c42,\u6ca1\u95ee\u9898.\n\n\u2461\u5bf9\u4e8epre\u548cnex\u6570\u7ec4\u5728\u8fd9\u91cc\u5c31\u53ea\u8bb2pre\u7684\u8f6c\u79fb,nex\u7684\u8f6c\u79fb\u7c7b\u4f3c.\n\npre[i][j]=max(pre[i-1][j],pre[k][j]+num[k][i],pre[k][j-num[k][i]]);(1<=k<i)\n\n\u5c31\u662f\u5206\u6210\u4e0d\u7ba1i\u65f6\u95f4,\u6216\u8005\u4ece\u65f6\u95f4k\u5230i\u7684\u90fd\u7531B\u9009,\u6216\u8005\u4ece\u65f6\u95f4k\u5230i\u7684\u90fd\u7531A\u9009\u4e09\u79cd\u60c5\u51b5\n\n\u2462\u5bf9\u4e8emus\u6570\u7ec4,\u6211\u4eec\u5f97\u5230\u8f6c\u79fb\u65b9\u7a0bmus[i][j]=max(x+y,pre[i][x]+num[i][j]+nex[j][y]),x\u8868\u793a\u65f6\u95f41~i\u4e2dA\u9009x\u4e2a,y\u8868\u793a\u65f6\u95f4j~cnt\u4e2dA\u9009y\u4e2a,\u4e2d\u95f4num[i][j]\u4e2a\u7531B\u9009.\u8fd9\u6837\u66b4\u529b\u8f6c\u79fb\u7684\u8bdd\u662fO(n^4)\u7684,\u65f6\u95f4\u4e0a\u662f\u4e0d\u5141\u8bb8\u7684,\u90a3\u4e48\u6211\u4eec\u89c2\u5bdf\u8f6c\u79fb\u65b9\u7a0b,\u5f53x\u589e\u5927\u65f6,y\u53ea\u6709\u5355\u8c03\u9012\u51cf\u7b54\u6848\u624d\u4f1a\u66f4\u4f18,\u56e0\u4e3a\u5982\u679cx\u589e\u5927\u4e14y\u4e5f\u589e\u5927\u7684\u8bdd,\u8868\u793aA\u9009\u7684\u8d8a\u6765\u8d8a\u591a,B\u9009\u7684\u8d8a\u6765\u8d8a\u5c11,\u663e\u7136\u7b54\u6848\u4e0d\u4f1a\u66f4\u4f18\u7684,\u6240\u4ee5\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2ay\u7684\u5355\u8c03\u9012\u51cf\u7684\u6307\u9488\u6765\u8f6c\u79fb\u5c31\u53ef\u4ee5\u4e86,\u65f6\u95f4\u4e3aO(n^3).\n\n\u2463\u5bf9\u4e8e\u7b2c\u4e00\u95ee\u7684\u7b54\u6848\u5c31\u662fmax(min(pre[i][j],j)),\u679a\u4e3e\u65f6\u95f4i\u548cA\u9009\u7684\u4e2a\u6570j\u6765\u5f97\u5230\u6700\u4f18\u89e3.\n\n\u7136\u540e\u5bf9\u4e8e\u7b2c\u4e8c\u95ee\u6211\u4eec\u5bf9\u4e8e\u4e00\u4e2a\u6d3b\u52a8l~r,\u7b54\u6848\u4e3amax(mus[i][j]),1<=i<=l,r<=j<=cnt.\n\n```cpp\n#include<iostream>\n#include<cstdlib>\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\n#include<cstring>\n#include<queue>\n#include<vector>\n#include<stack>\n#define min(a,b) ((a)<(b)?(a):(b))\n#define max(a,b) ((a)>(b)?(a):(b))\n#define MAXN 10100\n#define RG register\n#define LL long long int\nusing namespace std;\nconst int INF=1e9;\nstruct node{\n  int l,r;int id;\n}t[1010];\nint n;\nint num[1010][1010];//\u4ece\u65f6\u95f4i\u5230j\u4e2d\u6709\u591a\u5c11\u4e2a\nint pre[1010][1010];//\u65f6\u95f41~i\u4e2d,A\u9009\u4e86j\u4e2a\u65f6\u7684B\u80fd\u9009\u7684\u6570\u91cf\u7684\u6700\u5927\u503c.\nint nex[1010][1010];//\u65f6\u95f4i~n\u4e2d,A\u9009\u4e86j\u4e2a\u65f6\u7684B\u80fd\u9009\u7684\u6570\u91cf\u7684\u6700\u5927\u503c.\nint mus[1010][1010];//\u4ece\u65f6\u95f4i\u5230j\u7684\u4fdd\u8bc1\u9009\u65f6,A\u548cB\u9009\u7684\u6570\u91cf\u4e2d\u7684\u8f83\u5c0f\u503c\u7684\u6700\u5927\u503c.\nint st[MAXN],cnt;\nint ans[MAXN];\nint main()\n{\n  freopen(\"1.in\",\"r\",stdin);\n  scanf(\"%d\",&n);\n   for(int i=1;i<=n;i++){\n    scanf(\"%d%d\",&t[i].l,&t[i].r);t[i].r+=t[i].l;t[i].id=i;\n    st[++cnt]=t[i].l;st[++cnt]=t[i].r;\n  }\n  sort(st+1,st+cnt+1);cnt=unique(st+1,st+cnt+1)-st-1;\n  for(int i=1;i<=n;i++){\n    t[i].l=lower_bound(st+1,st+cnt+1,t[i].l)-st;\n    t[i].r=lower_bound(st+1,st+cnt+1,t[i].r)-st;\n    }\n  for(int i=1;i<=cnt;i++)\n    for(int j=1;j<=t[i].l;j++)\n      for(int k=t[i].r;k<=cnt;k++)\n    num[j][k]++;\n  for(int i=1;i<=cnt;i++)\n    for(int j=1;j<=n;j++)\n      pre[i][j]=nex[i][j]=-INF;\n  pre[0][0]=nex[cnt+1][0]=0;\n  for(int i=1;i<=cnt;i++){\n    for(int j=0;j<=num[1][i];j++)\n      pre[i][j]=max(pre[i-1][j],pre[i][j]);\n    for(int j=0;j<=num[1][i];j++){\n      for(int k=1;k<i;k++){\n    pre[i][j]=max(pre[k][j]+num[k][i],pre[i][j]);\n    if(j>=num[k][i]) pre[i][j]=max(pre[k][j-num[k][i]],pre[i][j]);\n      }\n    }\n  }\n  for(int i=cnt;i>=1;i--){\n    for(int j=0;j<=num[i][cnt];j++)\n      nex[i][j]=max(nex[i+1][j],nex[i][j]);\n    for(int j=0;j<=num[i][cnt];j++){\n      for(int k=cnt;k>i;k--){\n    nex[i][j]=max(nex[k][j]+num[i][k],nex[i][j]);\n    if(j>=num[i][k]) nex[i][j]=max(nex[k][j-num[i][k]],nex[i][j]);\n      }\n    }\n  }\n  for(int i=1;i<=cnt;i++)\n    for(int j=i+1;j<=cnt;j++)\n      {\n    for(int x=0,y=n;x<=n;x++){\n      while(y){\n        int val1=min(x+y,pre[i][x]+num[i][j]+nex[j][y]);\n        int val2=min(x+y-1,pre[i][x]+num[i][j]+nex[j][y-1]);\n        if(val2>=val1) y--;else break;\n      }\n      mus[i][j]=max(mus[i][j],min(x+y,pre[i][x]+num[i][j]+nex[j][y]));\n    }\n      }\n  for(int i=1;i<=cnt;i++)\n    for(int j=0;j<=num[1][i];j++)\n      ans[0]=max(ans[0],min(pre[i][j],j));\n  for(int i=1;i<=n;i++)\n      for(int j=t[i].l;j>=1;j--)\n    for(int k=t[i].r;k<=cnt;k++)\n      ans[i]=max(ans[i],mus[j][k]);\n  for(int i=0;i<=n;i++) printf(\"%d\\n\",ans[i]);\n  return 0;\n}\n\n```",
        "postTime": 1514528238,
        "uid": 38708,
        "name": "\u82b1\u6837\u767e\u51fa",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1973 \u3010[NOI2011]Noi\u5609\u5e74\u534e\u3011"
    },
    {
        "content": "## \u89e3\u6790\n\n\u65f6\u95f4\u8303\u56f4\u5f88\u5927\uff0c\u4f46 $n$ \u5f88\u5c0f\uff0c\u53ef\u4ee5\u76f4\u63a5\u79bb\u6563\u5316\u3002\u8bbe\u79bb\u6563\u5316\u540e\u7684\u65f6\u95f4\u8303\u56f4 $(0, T)$\n\n\u9996\u5148\u8981\u60f3\u5230\u4e00\u6b21\u76f4\u63a5\u9009\u4e00\u4e2a**\u533a\u95f4**\u5185\u7684\u6d3b\u52a8\u8f6c\u79fb\uff0c\u800c\u4e0d\u662f\u4e00\u4e2a\u4e2a\u6d3b\u52a8\u5730\u8f6c\u79fb\uff1b\u5426\u5219\u5728\u72b6\u6001\u6570\u4f1a\u8fc7\u9ad8\u5bfc\u81f4\u4e0d\u597d\u4f18\u5316\uff0c\u4e14\u8f6c\u79fb\u65b9\u7a0b\u4e5f\u5f88\u4e0d\u53ef\u60f3\n\n\u8bbe $w(l, r)$ \u8868\u793a\u6d3b\u52a8\u4e3e\u529e\u65f6\u95f4\u6bb5\u5b8c\u5168\u5728**\u533a\u95f4** $[l, r]$ \u5185\u7684\u6d3b\u52a8\u6570\n\n\u8bbe\u72b6\u6001 $f(k, r)$ \u8868\u793a\u7b2c\u4e00\u4e2a\u573a\u5730\u4e3e\u529e $k$ \u4e2a\u6d3b\u52a8\uff0c\u5728 $r$ \u65f6\u523b\u7b2c\u4e00\u4e2a\u573a\u5730\u7684\u6240\u6709\u6d3b\u52a8\u7ed3\u675f\uff0c\u7b2c\u4e8c\u4e2a\u573a\u5730\u4e3e\u529e\u7684\u6d3b\u52a8\u6570\u7684\u6700\u5927\u503c\uff1b\u518d\u8bbe\u72b6\u6001 $g(k, l)$ \u8868\u793a\u7b2c\u4e00\u4e2a\u573a\u5730\u4e3e\u529e $k$ \u4e2a\u6d3b\u52a8\uff0c\u6700\u65e9\u5728 $l$ \u65f6\u523b\u7b2c\u4e00\u4e2a\u573a\u5730\u6709\u6d3b\u52a8\u5f00\u59cb\uff0c\u7b2c\u4e8c\u4e2a\u573a\u5730\u4e3e\u529e\u7684\u6d3b\u52a8\u6570\u7684\u6700\u5927\u503c\uff08\u5176\u5b9e $f$ \u548c $g$ \u5dee\u4e0d\u591a\u5c31\u662f\u524d\u540e\u7f00\u7684\u5173\u7cfb\uff09\n\n\uff08\u8fd9\u91cc\u5e76\u4e0d\u9700\u8981\u518d\u540c\u6837\u4e3a\u7b2c\u4e8c\u4e2a\u573a\u5730\u8bbe\u4e24\u4e2a\u72b6\u6001\uff0c\u56e0\u4e3a\u4e24\u4e2a\u573a\u5730\u5e76\u65e0\u533a\u5206\uff0c\u4e0d\u7ba1\u7ed9\u54ea\u4e2a\u573a\u5730\u8bbe\u72b6\u6001\u7b97\u51fa\u6765\u7684\u90fd\u662f\u4e00\u6837\u7684\uff09\n\n\u8f6c\u79fb\u53ea\u9700\u6309\u533a\u95f4\u8f6c\u79fb\uff0c\u679a\u4e3e\u6700\u540e\u4e00\u6bb5\u533a\u95f4\u7684\u6d3b\u52a8\u7ed9\u54ea\u4e2a\u573a\u5730\u5373\u53ef\u3002\u53ef\u4ee5\u5f97\u5230\u8f6c\u79fb\u65b9\u7a0b\uff1a$f(k, r)=\\max\\limits_{0\\leq r' < r}\\{f(k-w(r', r), r'), f(k, r')+w(r', r)\\}$\uff0c$g(k, l)=\\max\\limits_{l < l' \\leq T}\\{g(k-w(l, l'), l'), g(k, l')+w(l, l')\\}$\n\n\u540c\u65f6\u8f6c\u79fb\u65f6\u8fd8\u8981\u6c42\u5408\u6cd5\u3002\u4ee5 $f$ \u4e3a\u4f8b\uff0c$f(k-w(r', r), r'$ \u8981\u6c42 $k\\geq w(r', r)$\uff1b$f(k, r')+w(r', r)$ \u8981\u6c42 $k\\leq w(0, r')$\uff08\u5982\u679c\u8bbe\u4e86\u7f3a\u7701\u503c\uff0c\u8fd9\u4e2a\u4e0d\u5224\u4e5f\u884c\uff09\n\n\u8fd9\u6837\u7b2c\u4e00\u95ee\u5c31\u505a\u5b8c\u4e86\n\n&nbsp;\n\n\u73b0\u5728\u518d\u8003\u8651\u7b2c\u4e8c\u95ee\n\n\u5982\u679c\u8981\u6c42\u7b2c $i$ \u4e2a\u6d3b\u52a8\u5fc5\u9009\uff0c\u8bbe\u8be5\u6d3b\u52a8\u7684\u5f00\u59cb\u65f6\u95f4\u4e3a $l_i$\uff0c\u7ed3\u675f\u65f6\u95f4\u4e3a $r_i$\u3002\u6211\u4eec\u53ea\u9700\u5f3a\u5236\u9009 $[l_i. r_i]$ \u4e2d\u7684\u6240\u6709\u533a\u95f4\uff0c\u7136\u540e\u518d\u5206\u522b\u518d\u628a $[0, l_i]$ \u548c $[r_i, T]$ \u5355\u72ec\u62ce\u51fa\u6765\u505a\u4e00\u6b21\u548c\u521a\u624d\u610f\u4e49\u4e00\u6837\u7684 dp \u5373\u53ef\uff0c\u53ef\u4ee5\u76f4\u63a5\u5957\u7528\u4e0a\u9762\u9884\u5904\u7406\u7684 $f, g$\n\n\u4f46\u6ce8\u610f\u5230\uff0c\u5047\u8bbe\u6211\u4eec\u5bf9\u4e00\u4e2a\u573a\u5730\u9009\u4e86\u4e00\u4e2a $[a, l_i], 0\\leq a\\leq l_i$ \u7684\u6d3b\u52a8\uff0c\u518d\u6709\u4e00\u4e2a $[b, c], a\\leq b\\leq r_i, b\\leq c\\leq r_i$ \u7684\u6d3b\u52a8\uff0c\u5373\u4f7f\u8fd9\u6837\uff0c$[b, c]$ \u8fd9\u4e2a\u6d3b\u52a8\u4e5f\u4e0d\u4f1a\u88ab\u9009\u3002\u6216\u8005\u8bf4\uff0c\u7531\u4e8e\u6211\u4eec\u8bbe\u7f6e\u7684 \u201c\u65ad\u70b9\u201d\uff08$l_i, r_i$\uff09\uff0c\u4e00\u4e9b\u8de8\u65ad\u70b9\u7684\u6d3b\u52a8\uff0c\u5373\u4f7f\u5408\u6cd5\uff0c\u4e5f\u4e0d\u4f1a\u88ab\u9009\uff1b\u4e8e\u662f\u6211\u4eec\u53ea\u597d\u679a\u4e3e\u65ad\u70b9\n\n\u4e8e\u662f\u6700\u7ec8\u5f97\u5230\u65b9\u7a0b\uff1a$ans[i]=\\max\\limits_{0\\leq l\\leq l_i, r_i\\leq r\\leq T}\\{\\max\\limits_{0\\leq j\\leq n, 0\\leq k\\leq n}\\{\\min(j+k+w(l, r), f(j, l)+g(k, r))\\}\\}$\uff08\u8fd9\u91cc\u628a $w(l, r)$ \u4e0d\u7ba1\u7ed9\u54ea\u4e2a\u573a\u5730\u7b97\u51fa\u6765\u7684\u7b54\u6848\u90fd\u662f\u4e00\u6837\u7684\uff0c\u539f\u56e0\u540c\u4e0a\uff09\n\n\u5176\u4e2d $ans[i]$ \u8868\u793a\u5fc5\u9009\u7b2c $i$ \u4e2a\u6d3b\u52a8\u7684\u7b54\u6848\u3002\u8fd9\u6837\u590d\u6742\u5ea6\u662f $O(n^5)$ \u7684\uff0c\u9700\u8981\u4f18\u5316\n\n\u53d1\u73b0\u5916\u9762\u7684 $l, r$ \u5b9e\u9645\u4e0a\u4f1a**\u91cd\u590d\u53d6\u503c**\u5f88\u591a\u6b21\uff0c\u6211\u4eec\u8003\u8651\u76f4\u63a5\u5c06\u6bcf\u4e2a\u5408\u6cd5\u7684 $l, r$ \u7684\u7b54\u6848\u90fd\u9884\u5904\u7406\u51fa\u6765\u3002\u5177\u4f53\u5373\uff1a\n\n$anstmp[l][r]=\\max\\limits_{0\\leq j\\leq n, 0\\leq k\\leq n}\\{\\min(j+k+w(l, r), f(j, l)+g(k, r))\\}$\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u628a $ans[.]$ \u7684\u65b9\u7a0b\u5199\u6210 $O(n^3)$ \u7684\uff1a\n\n$ans[i]=\\max\\limits_{0\\leq l\\leq l_i, r_i\\leq r\\leq T}\\{antmp[l][r]\\}$\n\n&nbsp;\n\n\u4f46 $anstmp[.][.]$ \u7684\u65b9\u7a0b\u662f $O(n^4)$ \u7684\uff0c\u8fd8\u662f\u6709\u70b9\u60ac\uff08\u5982\u679c\u4f60\u5361\u5e38\u6280\u672f\u591f\u597d\uff0c\u5176\u5b9e\u8bf4\u4e0d\u5b9a\u4e5f\u80fd\u8fc7...\uff09\uff0c\u8003\u8651\u4f18\u5316\n\n\u8003\u8651\u72b6\u6001\u7684\u5b9a\u4e49\uff0c\u6211\u4eec\u53d1\u73b0\uff1a\n\n> \u5f15\u7406 $1.$ \u5bf9\u4e8e\u56fa\u5b9a\u7684 $l, r$\uff0c$j+k+w(l, r)$ \u7684\u503c\u968f $j, k$ \u7684\u589e\u5927\u5355\u8c03\u9012\u589e\n\n> \u5f15\u7406 $2.$ \u5bf9\u4e8e\u56fa\u5b9a\u7684 $l, r$\uff0c$f(j, l)+g(k, r)$ \u7684\u503c\u968f $j, k$ \u7684\u589e\u5927**\u5355\u8c03\u4e0d\u589e**\n\n\u4e8e\u662f\u7531 \u5f15\u7406 $1$\u3001\u5f15\u7406 $2$ \u53ef\u5f97\uff0c\u82e5\u56fa\u5b9a $j, k$ \u4e2d\u7684\u5176\u4e2d\u4e00\u4e2a\uff0c\u5c06 $\\min$ \u5de6\u8fb9\u548c\u53f3\u8fb9\u7684\u5f0f\u5b50\u90fd\u8868\u793a\u6210\u5173\u4e8e\u53e6\u4e00\u4e2a\u53d8\u91cf\uff08$j, k$\uff09\u7684\u51fd\u6570 $F, G$\uff08\u5206\u522b\u5bf9\u5e94\u5de6\u8fb9\uff0c\u53f3\u8fb9\uff09\uff0c\u5219\u8fd9\u4e24\u4e2a\u51fd\u6570\u4e00\u5b9a\u53ea\u6709\u4e00\u4e2a\u4ea4\u70b9\uff1b\u800c\u8fd9\u4e2a\u4ea4\u70b9\u5c31\u628a $\\min$ \u7684\u51fd\u6570\u56fe\u50cf\u5206\u6210\u4e86\u4e24\u6bb5\n\n\u8fd9\u91cc\u6211\u4eec\u5c06\u5de6\u53f3\u7684\u5f0f\u5b50\u8868\u793a\u6210\u5173\u4e8e $k$ \u7684\u51fd\u6570\n\n\u63a5\u7740\u5bf9\u6bcf\u4e2a $j$\uff0c\u6211\u4eec\u8bbe \u201c\u4ea4\u70b9\u201d $m_j$\uff08\u4f46\u542b\u4e49\u6709\u70b9\u4e0d\u540c\uff0c\u4e3b\u8981\u56e0\u4e3a\u8fd9\u91cc\u7684\u51fd\u6570\u5b9a\u4e49\u5728\u6574\u6570\u57df\uff09\uff0c\u6ee1\u8db3 $\\forall k:0\\leq k\\leq m_j, F(k)\\leq G(k)$ \u4e14 $\\forall k:m_j < k \\leq n, F(k) > G(k)$\n\n\u53c8\u7531 \u5f15\u7406 $2$ \u53ef\u5f97\uff0c\u5f53 $j$ \u589e\u5927\u65f6\uff0c$m_j$ \u4e5f**\u5355\u8c03\u4e0d\u589e**\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u679a\u4e3e $j$ \u65f6\u8bbe $m_j$ \u201c\u968f\u7740\u201d $j$ \u4e00\u8d77\u679a\u4e3e\uff08\u6709\u70b9\u50cf\u53cc\u6307\u9488\uff09\u3002\u7531\u4e8e $m_j$ \u5355\u8c03\u4e0d\u589e\uff0c\u5173\u4e8e $j, m_j$ \u8fd9\u5c42\u5faa\u73af\u7684\u590d\u6742\u5ea6\u5c31\u662f $O(n)$ \u7684\n\n\u4e8e\u662f\u6211\u4eec\u6210\u529f\u5c06 $anstmp[.][.]$ \u7684\u8ba1\u7b97\u8fc7\u7a0b\u4e5f\u4f18\u5316\u4e3a $O(n^3)$ \u7684\n\n## CODE\n\n```cpp\n#include <cstdio>\n#include <algorithm>\n#pragma GCC optimize(\"O3\")\n#pragma GCC optimize(\"Ofast\", \"-funroll-loops\", \"-fdelete-null-pointer-checks\")\n#pragma GCC target(\"ssse3\", \"sse3\", \"sse2\", \"sse\", \"avx2\", \"avx\")\nusing std::sort;\nusing std::pair;\nusing std::max;\nusing std::min;\ntypedef pair<int, int> pad;\n\nconst int MAXN =210, MAXT =420;\n\nint T;\nint S[MAXN], E[MAXN], ans[MAXN];\nint w[MAXT][MAXT], anstmp[MAXT][MAXT];\nint dppre[MAXT][MAXN], dpsuf[MAXT][MAXN];/*\u7edf\u8ba1\u4e86 [0, r]/[l, MAXT] \u7684\u6d3b\u52a8\uff0c\u7b2c\u4e00\u573a\u5730 k \u4e2a\u6d3b\u52a8\uff0c\u7b2c\u4e8c\u573a\u5730\u6d3b\u52a8\u6700\u5927\u503c*/\n\npad a[MAXT];\n\nint main(){\n\tint n;\n\tscanf(\"%d\", &n);\n\tfor(int i =0; i < n; ++i){\n\t\tscanf(\"%d%d\", &S[i], &E[i]);\n\t\tE[i] +=S[i];\n\t\ta[i] =pad(S[i], i), a[n+i] =pad(E[i], n+i);\n\t}\n\tsort(a, a+2*n);/*\u79bb\u6563\u5316*/\n\tfor(int i =0; i < 2*n; ++i){\n\t\tif(a[i].second < n)\n\t\t\tS[a[i].second] =T;\n\t\telse\n\t\t\tE[a[i].second-n] =T;\n\t\tif(i < 2*n-1 && a[i].first != a[i+1].first)\n\t\t\t++T;\n\t}\n\tfor(int l =0; l <= T; ++l)/*\u9884\u5904\u7406 w*/\n\t\tfor(int r =l; r <= T; ++r)\n\t\t\tfor(int i =0; i < n; ++i)\n\t\t\t\tif(S[i] >= l && E[i] <= r)\n\t\t\t\t\t++w[l][r];\n\t\n\tfor(int r =0; r <= T; ++r)/*\u9884\u5904\u7406 f*/\n\t\tfor(int k =0; k <= n; ++k)\n\t\t\tfor(int rpre =0; rpre < r; ++rpre){\n\t\t\t\tif(k >= w[rpre][r])/*\u6700\u540e\u4e00\u6bb5\u7ed9\u7b2c\u4e00\u4f1a\u573a*/\n\t\t\t\t\tdppre[r][k] =max(dppre[r][k], dppre[rpre][k-w[rpre][r]]);\n\t\t\t\tif(w[0][rpre] >= k)/*\u6700\u540e\u4e00\u6bb5\u7ed9\u7b2c\u4e8c\u4f1a\u573a*/\n\t\t\t\t\tdppre[r][k] =max(dppre[r][k], dppre[rpre][k]+w[rpre][r]);\n\t\t\t}\n\tfor(int l =T; l >= 0; --l)/*\u9884\u5904\u7406 g*/\n\t\tfor(int k =0; k <= n; ++k)\n\t\t\tfor(int lpre =T; lpre > l; --lpre){\n\t\t\t\tif(k >= w[l][lpre])/*\u6700\u540e\u4e00\u6bb5\u7ed9\u7b2c\u4e00\u4f1a\u573a*/\n\t\t\t\t\tdpsuf[l][k] =max(dpsuf[l][k], dpsuf[lpre][k-w[l][lpre]]);\n\t\t\t\tif(w[lpre][T] >= k)/*\u6700\u540e\u4e00\u6bb5\u7ed9\u7b2c\u4e8c\u4f1a\u573a*/\n\t\t\t\t\tdpsuf[l][k] =max(dpsuf[l][k], dpsuf[lpre][k]+w[l][lpre]);\n\t\t\t}\n\tfor(int l =0; l <= T; ++l)/*\u8ba1\u7b97 anstmp*/\n\t\tfor(int r =l; r <= T; ++r)\n\t\t\tfor(int kl =0, kr =w[r][T]; kl <= w[0][l]; ++kl){/*kl -> j, kr -> m_j*/\n\t\t\t\t/*min(kl+w[l][r]+kr, dppre[l][kl]+dpsuf[r][kr])*/\n\t\t\t\twhile(kr >= 0 && kl+w[l][r]+kr > dppre[l][kl]+dpsuf[r][kr])\n\t\t\t\t\t--kr;\n\t\t\t\tif(kr >= 0)/*\u907f\u514d\u8d8a\u754c/\u4e0d\u5408\u6cd5\u60c5\u51b5*/\n\t\t\t\t\tanstmp[l][r] =max(anstmp[l][r], kl+w[l][r]+kr);\n\t\t\t\tif(kr < w[r][T])/*\u907f\u514d\u4e0d\u5408\u6cd5\u60c5\u51b5*/\n\t\t\t\t\tanstmp[l][r] =max(anstmp[l][r], dppre[l][kl]+dpsuf[r][kr+1]);\n\t\t\t}\n\tfor(int i =0; i < n; ++i)\n\t\tfor(int l =0; l <= S[i]; ++l)\n\t\t\tfor(int r =E[i]; r <= T; ++r)\n\t\t\t\tans[i] =max(ans[i], anstmp[l][r]);\n\t\n\tint Ans1 =0;\n\tfor(int k =0; k <= w[0][T]; ++k)\n\t\tAns1 =max(Ans1, min(dppre[T][k], k));\n\tprintf(\"%d\\n\", Ans1);\n\tfor(int i =0; i < n; ++i)\n\t\tprintf(\"%d\\n\", ans[i]);\n}\n```",
        "postTime": 1601212561,
        "uid": 105254,
        "name": "Piwry",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1973 \u3010[NOI2011]NOI \u5609\u5e74\u534e\u3011"
    },
    {
        "content": "# [NOI2011] NOI\u5609\u5e74\u534e\n\n\u8fd9\u662f\u4e00\u9053`dp`\u9898\uff0c\u5e76\u4e14\u6ca1\u6709\u7528\u4ec0\u4e48\u9ad8\u7ea7\u77e5\u8bc6\n\n## \u9898\u76ee\u53d9\u8ff0\n\n\u6709$n$\u4e2a\u6d3b\u52a8\uff0c\u6bcf\u4e2a\u6d3b\u52a8\u6709\u4e00\u4e2a\u65f6\u95f4\u8303\u56f4$[l,r]$\u3002\u4e24\u4e2a\u95ee\u9898\uff1a\n\n+ \u628a\u8fd9\u4e9b\u6d3b\u52a8\u5206\u6210\u4e24\u90e8\u5206\uff0c\u4f7f\u5f97\u5728\u4e24\u4e2a\u4e0d\u540c\u90e8\u5206\u7684\u6d3b\u52a8\u4e0d\u80fd\u6709\u516c\u5171\u65f6\u95f4\uff0c\u95ee\u8fd9\u4e24\u90e8\u5206\u4e2d\u6d3b\u52a8\u8f83\u5c11\u7684\u6700\u591a\u591a\u5c11\u4e2a\u6d3b\u52a8\u3002\n+ \u5728\u7b2c\u4e00\u95ee\u7684\u57fa\u7840\u4e0a\uff0c\u5f3a\u5236\u9009\u7b2c$i$\u4e2a\u6d3b\u52a8\uff0c\u8f83\u5c11\u7684\u6700\u591a\u591a\u5c11\uff08\u5bf9\u4e8e\u4efb\u610f$i$\uff0c\u90fd\u8981\u6c42\uff09\u3002\n\n## \u9898\u89e3\n\n\u8fd9\u662f\u4e00\u4e2a\u5206\u6210\u4e24\u4e2a\u90e8\u5206\u7684\u95ee\u9898\uff0c\u56e0\u6b64\u53ef\u4ee5\u8003\u8651\u628a\u4e00\u90e8\u5206\u8bbe\u5230\u72b6\u6001\u91cc\uff0c\u53e6\u4e00\u90e8\u5206\u4f5c\u4e3a\u72b6\u6001\u7684\u503c\u3002\u6709\u4e00\u4e2a\u7c7b\u4f3c\u7684\u9898\uff0c[P2577 [ZJOI2005]\u5348\u9910](https://www.luogu.com.cn/problem/P2577)\u3002\n\n\u8bbe$pre_{i,j}$\u4e3a\u524d$i$\u4e2a\u65f6\u95f4\u70b9\uff0c\u7b2c\u4e00\u573a\u6709$j$\u4e2a\u6d3b\u52a8\uff0c\u7b2c\u4e8c\u573a\u6700\u591a\u9009\u591a\u5c11\u4e2a\u3002\n\n\u8003\u8651\u679a\u4e3e\u9009\u4e0d\u9009\u7b2c$k$\u4e2a\u6d3b\u52a8\u8f6c\u79fb\u3002\u7136\u540e\u53d1\u73b0\u5e76\u4e0d\u884c\u3002\n\n\u8003\u8651\u679a\u4e3e\u4e0a\u4e00\u4e2a\u65f6\u95f4\u70b9\u662f$k$\uff0c\u628a\u5b8c\u6574\u5728$[k,i]$\u65f6\u95f4\u5185\u7684\u6240\u6709\u6d3b\u52a8\u90fd\u9009\u4e0a\u3002\u6240\u4ee5\u8981\u7edf\u8ba1$tot_{l,r}$\u8868\u793a\u533a\u95f4$[l,r]$\u5185\u6240\u6709\u9879\u76ee\u90fd\u9009\u4e0a\u80fd\u9009\u51e0\u4e2a\u3002\n\n\u7b2c\u4e00\u95ee\u5c31\u89e3\u51b3\u4e86\u3002\n\n\u7b2c\u4e8c\u95ee\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6d3b\u52a8\uff0c\u76f8\u5f53\u4e8e$[l,r]$\u5185\u4e0d\u80fd\u9009\u4efb\u4f55\u5176\u4ed6\u6d3b\u52a8\u3002\n\n\u4e8e\u662f\u8bbe$f_{l,r}$\u8868\u793a\u65f6\u95f4\u533a\u95f4$[l,r]$\u5185\u6240\u6709\u6d3b\u52a8\u90fd\u9009\u4e0a\u7684\u6700\u4f18\u89e3\u3002\n\n\u8003\u8651\u628a\u524d\u7f00\u548c\u540e\u7f00\u8fd8\u6709$[l,r]$\u62fc\u8d77\u6765\u5f53\u6210\u7b54\u6848\u3002\u524d\u7f00\u548c\u540e\u7f00\u641e\u6210\u5c40\u90e8\u6700\u4f18\u89e3\uff0c\u6240\u4ee5\u8fd8\u8981\u7edf\u8ba1\u4e00\u4e2a$suf$\u8868\u793a\u4ece$i$\u5411\u540e\u9009$j$\u4e2a\u6d3b\u52a8\u7684\u5c40\u90e8\u6700\u4f18\u89e3\u3002\n\n\u8fd9\u53ea\u662f\u5c40\u90e8\u6700\u4f18\u89e3\uff0c\u8fd8\u8981\u628a\u5176\u4ed6\u60c5\u51b5\u7b97\u4e0a\uff08\u6bd4\u5982\u4e00\u4e2a\u533a\u95f4\u6709\u4e00\u90e8\u5206\u5728$[l,r]$\u91cc\u9762\uff09\uff0c\u6240\u4ee5\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\u90fd\u9700\u8981\u679a\u4e3e\u6240\u6709\u5305\u542b$[l,r]$\u7684\u6240\u6709\u533a\u95f4\uff0c\u6240\u4ee5\u6bcf\u4e2a$f_{l,r}$\u90fd\u9700\u8981\u7b97\u51fa\u6765\u3002\n\n\u8003\u8651\u5982\u4f55\u8ba1\u7b97\uff1a\u679a\u4e3e\u4e24\u8fb9\u7684\u6570\u91cf\uff0c$cnt_l,cnt_r$\uff0c\u7136\u540e\u663e\u7136\u662f$cnt_l+cnt_r+tot_{l,r}$\u4e0e$pre_{l,cnt_l}+suf_{r,cnt_r}$\u4e2d\u7684\u6700\u5c0f\u503c\u3002\n\n\u4f46\u662f\u53d1\u73b0\u8fd9\u6837\u8ba1\u7b97$f_{l,r}$\u7684\u590d\u6742\u5ea6\u662f$n^4$\u7684\u3002\n\n\u73b0\u5728\u8003\u8651$l$\u56fa\u5b9a\u65f6\uff0c$r$\u7684\u6700\u4f18\u89e3\u7684\u884c\u52a8\u8f68\u8ff9\u3002\u6211\u4eec\u77e5\u9053\uff0c$pre_{l,cnt_l}$\u548c$suf_{r,cnt_r}$\u5728$cnt_l$\u548c$cnt_r$\u4e0b\u964d\u65f6\uff0c\u8fd9\u4e24\u4e2a\u6570\u4e5f\u4e0b\u964d\u3002\u56e0\u4e3a\u53ef\u4ee5\u611f\u53d7\u5230\uff0c$pre_{l,cnt_l}$\u5728$cnt_l$\u66f4\u5c0f\u7684\u65f6\u5019\uff0c\u53e6\u4e00\u4e2a\u573a\u7684\u9650\u5236\u5c0f\uff0c\u6240\u4ee5\u81ea\u7136\u6700\u591a\u591a\u5c11\u4e2a\u5c31\u5927\u3002\n\n\u5728\u8003\u8651\u5728$cnt_l$\u4e0d\u65ad\u589e\u5927\u7684\u65f6\u5019\uff0c$cnt_l+cnt_r+tot_{l,r}$\u4f1a\u51cf\u5c0f\u3002\u6700\u4f18\u72b6\u6001\u4e00\u5b9a\u662f\u4e00\u4e2a\u5e73\u8861\u72b6\u6001\uff08\u5c31\u662f$\\min$\u7684\u4e24\u8fb9\u57fa\u672c\u76f8\u540c\u7684\u65f6\u5019\uff09\u3002\u5bf9\u4e8e\u4e00\u4e2a\u539f\u672c\u76f8\u540c\u7684\u72b6\u6001\uff0c$cnt_l$\u5728\u679a\u4e3e\u65f6\u4f1a\u53d8\u5927\uff0c$cnt_r$\u5982\u679c\u4e5f\u53d8\u5927\uff0c\u90a3\u4e48$pre_{l,cnt_l}+suf_{r,cnt_r}$\u4f1a\u53d8\u5c0f\uff0c\u800c\u5de6\u8fb9\u6bd4\u539f\u672c\u7684\u4e00\u4e2a\u5e73\u8861\u72b6\u6001\u66f4\u5927\uff0c\u90a3\u4e48\u5b9a\u7136\u4e0d\u5e73\u8861\u4e86\u3002\n\n\u4e8e\u662f\u8fd9\u5c31\u53ef\u4ee5\u7ef4\u62a4\u4e00\u4e2a$r$\u7684\u6307\u9488\uff0c\u7136\u540e\u6bcf\u6b21\u79fb\u52a8\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u590d\u6742\u5ea6$O(n^3)$\u4e86\u3002\n\n\u8ba1\u7b97\u5b8c$f_{l,r}$\u540e\u518d\u679a\u4e3e\u5c31\u53ef\u4ee5\u5f97\u5230\u7b54\u6848\u5566\u3002\n\n## \u4ee3\u7801\n\n\u6ce8\u610f\uff1a\n\n+ \u51b3\u7b56\u5355\u8c03\u6027\u79fb\u52a8\u6307\u9488\u7684\u65f6\u5019\u4e00\u5b9a\u5199$\\le$\u800c\u4e0d\u662f$<$\uff01\u56e0\u4e3a\u6709\u4e00\u6bb5\u65f6\u5e73\u7740\u7684\u3002\n\n```cpp\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\nusing namespace std;\nconst int maxActive = 205, maxTime = 405;\nint nb, tail, ans, pre[maxTime][maxActive], suf[maxTime][maxActive], diff[maxTime], tot[maxTime][maxTime];\nint reg[maxTime][maxTime];\nstruct Activity {\n\tint beg, end;\n} act[maxActive];\nint Find(int val) {\n\treturn lower_bound(diff + 1, diff + tail + 1, val) - diff;\n}\nint main() {\n\tscanf(\"%d\", &nb);\n\tfor (int at = 1; at <= nb; ++at) {\n\t\tint beg, len;\n\t\tscanf(\"%d%d\", &beg, &len);\n\t\tact[at].beg = beg;\n\t\tact[at].end = beg + len;\n\t\tdiff[++tail] = beg;\n\t\tdiff[++tail] = beg + len;\n\t}\n\tsort(diff + 1, diff + tail + 1);\n\ttail = unique(diff + 1, diff + tail + 1) - (diff + 1);\n\tfor (int at = 1; at <= nb; ++at) {\n\t\tact[at].beg = Find(act[at].beg);\n\t\tact[at].end = Find(act[at].end);\n\t}\n\tfor (int L = 1; L <= tail; ++L)\n\t\tfor (int R = L; R <= tail; ++R)\n\t\t\tfor (int at = 1; at <= nb; ++at)\n\t\t\t\ttot[L][R] += ((L <= act[at].beg) && (act[at].end <= R));\n\tmemset(pre, 0x8f, sizeof(pre));\n\tmemset(suf, 0x8f, sizeof(suf));\n\t//\u4e0d\u5408\u6cd5\u72b6\u6001\u8981\u8bbe\u6210 -inf \n\tpre[0][0] = suf[0][0] = 0;\n\tfor (int tim = 1; tim <= tail; ++tim) {\n\t\tpre[tim][0] = 0;\n\t\tfor (int ge = 0; ge <= tot[1][tim]; ++ge)\n\t\t\tfor (int from = 0; from < tim; ++from) {\n\t\t\t\tpre[tim][ge] = max(pre[tim][ge], pre[from][ge] + tot[from][tim]);\n\t\t\t\tif (ge >= tot[from][tim])\n\t\t\t\t\tpre[tim][ge] = max(pre[tim][ge], pre[from][ge - tot[from][tim]]);\n\t\t\t}\n\t}\n\t//\u8fd9\u91cc\u65f6\u95f4\u70b9\u91cd\u590d\u662f\u4e0d\u7b97\u91cd\u590d\u7684 \n\tfor (int ge = 1; ge <= nb; ++ge)\n\t\tans = max(ans, min(pre[tail][ge], ge));\n\tprintf(\"%d\\n\", ans);\n\tfor (int tim = tail; tim >= 1; --tim) {\n\t\tsuf[tim][0] = 0;\n\t\tfor (int ge = 0; ge <= tot[tim][tail]; ++ge)\n\t\t\tfor (int from = tim + 1; from <= tail; ++from) {\n\t\t\t\tsuf[tim][ge] = max(suf[tim][ge], suf[from][ge] + tot[tim][from]);\n\t\t\t\tif (ge >= tot[tim][from])\n\t\t\t\t\tsuf[tim][ge] = max(suf[tim][ge], suf[from][ge - tot[tim][from]]);\n\t\t\t}\n\t}\n\tfor (int bg = 1; bg <= tail; ++bg)\n\t\tfor (int ed = bg + 1; ed <= tail; ++ed)\n\t\t\tfor (int L = 0, R = tot[ed][tail]; L <= tot[1][bg]; ++L) {\n\t\t\t\tint nowVal = min(L + R + tot[bg][ed], pre[bg][L] + suf[ed][R]);\n\t\t\t\t//\u52a0\u4e0a\u51b3\u7b56\u5355\u8c03\u6027\u4e4b\u540e\u5e94\u8be5\u662f nowVal <= min(......) \n\t\t\t\twhile (R >= 1 && nowVal <= min(L + (R - 1) + tot[bg][ed], pre[bg][L] + suf[ed][R - 1]))\n\t\t\t\t\t--R, nowVal = min(L + R + tot[bg][ed], pre[bg][L] + suf[ed][R]);\n\t\t\t\treg[bg][ed] = max(reg[bg][ed], nowVal);\n\t\t\t\t//\u8fd9\u4e5f\u5f97\u53d6 max\uff0c\u56e0\u4e3a\u8fd9\u91cc\u5e76\u4e0d\u662f\u76f4\u63a5\u7b97\u51fa\u8fd9\u4e2a\u70b9\u7684\u6700\u4f18\u4f4d\u7f6e\u7684\n\t\t\t\t//\u8fd9\u91cc\u662f\u4e00\u4e2a...\u53ef\u4ee5\u7c7b\u4f3c\u4e8e\u526a\u679d\u4e4b\u7c7b\u7684\u4e1c\u897f \n\t\t\t}\n\tfor (int ac = 1; ac <= nb; ++ac) {\n\t\tint ans = 0;\n\t\tfor (int bg = 1; bg <= act[ac].beg; ++bg)\n\t\t\tfor (int ed = act[ac].end; ed <= tail; ++ed)\n\t\t\t\tans = max(ans, reg[bg][ed]);\n\t\tprintf(\"%d\\n\", ans);\n\t}\n\treturn 0;\n}\n```\n\n## \u60f3\u6cd5\n\n+ \u4e24\u90e8\u5206\u7684\u9898\u76ee\u53ef\u4ee5\u8003\u8651\u8bbe\u4e00\u7ef4\u662f\u7b2c\u4e00\u90e8\u5206\uff0c\u503c\u662f\u7b2c\u4e8c\u90e8\u5206\u7684\u6700\u4f18\u89e3\u3002",
        "postTime": 1584186953,
        "uid": 75715,
        "name": "KokiNiwa",
        "ccfLevel": 0,
        "title": "[NOI2011] NOI\u5609\u5e74\u534e\uff08\u52a8\u6001\u89c4\u5212\uff0c\u51b3\u7b56\u5355\u8c03\u6027\uff09"
    },
    {
        "content": "**C++\u505a\u6cd5**\n\u5148\u819c\u62dc\u5927\u4f6c\u4eec\u7684\u505a\u6cd5\n\u7136\u540e\u518d\u8dea\u62dc\u4e00\u4e0b\u7ba1\u7406\u5458\n\u6700\u540e\u8bb2\u505a\u6cd5\n\n------------\n~~\u54c8\u54c8\u54c8\u54c8~~\n\u6b64\u9898\u89e3\u6765\u81ea\uff1a[[BZOJ 2436][NOI 2011]NOI\u5609\u5e74\u534e(DP\u4f18\u5316)](https://blog.csdn.net/qpswwww/article/details/45251877)\n~~\u771f\u7684\u9a84\u50b2\uff0c\u4e00\u4e2a\u8fde\u533a\u8d5b\u90fd\u8fdb\u4e0d\u4e86\u7684\u5c0f\u4eba\u513f\u5f04\u61c2\u4e86\u8fd9\u4e2a~~\n###### \u79bb\u6563\u5316\n\u8fd9\u662f\u6b64\u9898\u7684\u7ec8\u6781\u505a\u6cd5\n~~\u54c8\u54c8\u54c8\u54c8~~\n\n-----------\n\u79bb\u6563\u5316\u540e\uff0c\u5c31\u662f\u6c42\u4e09\u4e2a\u6570\u7ec4num[i][j],pre[i][j],suf[i][j]\nsee\uff1a\uff01\uff01\nnum[i][j]=[i,j]\u533a\u95f4\u5185\u7684\u7ebf\u6bb5\u4e2a\u6570.\npre[i][j]=[0,i]\u533a\u95f4\u5185\u7ed9B j\u4e2a\u7ebf\u6bb5\uff0cA\u5f97\u5230\u6700\u591a\u7ebf\u6bb5\u4e2a\u6570\u3002\nsuf[i][j]=[j,\u221e]\u533a\u95f4\u5185\u7ed9B j\u4e2a\u7ebf\u6bb5\uff0cA\u5f97\u5230\u6700\u591a\u7ebf\u6bb5\u4e2a\u6570.\n\n------------\n\u5148\u63a8\u51fanum[i][j]\uff0c\u679a\u4e3ei\uff0c\u5bf9\u4e8e\u6240\u6709\u5de6\u7aef\u70b9Li\u5927\u4e8e\u7b49\u4e8ei\u7684\u533a\u95f4\u53f3\u7aef\u70b9Ri\uff0c\u6807\u8bb0 num[i][Ri]++;\n\u90a3\u4e48\uff1anum[i][j]=num'[i][k](\u4e0a\u9650j\uff0c\u4e0b\u9650:k=i)\n\n------------\n\u63a5\u7740\u662f\u7136\u540e\u5c31\u662fpre[i][j]\u548csuf[i][j]\u4e86\n\u8bf7\u6c42\u51fa\u4ee5\u4e0b\u516c\u5f0f\uff08\u5728\u4e0b\u65b9\uff09\uff1a\npre[i][j]=max(max(pre[k][j]+num[k][i],pre[k][j]\u2212num[k][i]));\nAND\nsuf\u548cpre\u5dee\u4e0d\u591a\n\n------------\ng[i][j]=max\uff08min(x+y,pre[i][x]+num[i][j]+suf[j][y]))\\\n(x,y\u2208[0,n])\n\u8fd9\u5c31\u4ee4\nf[x][y]=min{x+y,pre[i][x]+num[i][j]+suf[j][y]}\n~~\u4f46\u6211\u6ca1\u770b\u89c1\u4ee3\u7801\u91cc\u6709f\u6570\u7ec4\u554a\uff01\uff01\uff01~~\n\uff08\u6ce8\uff1ax\u662f[i,j]\u5de6\u8fb9\u653e\u5165B\u4e2d\u7684\u7ebf\u6bb5\u4e2a\u6570\uff0cy\u662f[i,j]\u53f3\u8fb9\u653e\u5165B\u4e2d\u7684\u7ebf\u6bb5\u4e2a\u6570\uff09\n\n------------\n\u603b\u7ed3\uff1a\n\u5728x\u56fa\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0cf[x][y]\u968fy\u9012\u589e,\u5448\u5355\u51f8\u7279\u70b9\uff0c\u56e0\u6b64\u53ef\u4ee5\u5229\u7528\u8fd9\u4e00\u6027\u8d28\uff0c\u7ef4\u62a4\u4e24\u4e2a\u6307\u9488x,y\uff0c\u904d\u5386x\uff0c\u5bf9\u4e8e\u6bcf\u4e2ax\uff0c\u53ef\u4ee5\u5728\u671f\u671b\u590d\u6742\u5ea6O(1))\u65f6\u95f4\u5185\uff0c\u79fb\u52a8\u6307\u9488y\u5e76\u5feb\u901f\u627e\u5230\u4f7f\u5f97\u5f53\u524d\u7684f[x][y]\u6700\u5927\u7684y\n\n------------\n~~\u91cd\u8981\u73af\u8282\uff01\uff01\uff01\uff01\uff01\uff01\uff01\u4ee3\u7801\u5448\u73b0\uff01\uff01\uff01\uff01\uff01\uff01~~\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<algorithm>\n#define INF 0x3f3f3f3f\nusing namespace std;\nstruct Segment\n{\n    long long L,R;\n}seg[2020];\nlong long stack[6666],top=0,n,pre[2222][2222],suf[2222][2222],g[2222][2222],num[2222][2222],i,k,j,x,y,ans;\nint main()\n{\n    scanf(\"%lld\",&n);\n    for(i=1;i<=n;i++){\n        scanf(\"%lld%lld\",&seg[i].L,&seg[i].R);\n        seg[i].R+=seg[i].L;\n        stack[top++]=seg[i].L;\n        stack[top++]=seg[i].R;\n    }\n    sort(stack,stack+top);\n    top=unique(stack,stack+top)-stack;\n    for(i=1;i<=n;i++)\n        seg[i].L=lower_bound(stack,stack+top,seg[i].L)-stack,seg[i].R=lower_bound(stack,stack+top,seg[i].R)-stack;\n    for(i=0;i<top;i++){\n        for(j=1;j<=n;j++)\n            if(seg[j].L>=i)\n                num[i][seg[j].R]++;\n        for(j=i+1;j<top;j++)\n            num[i][j]+=num[i][j-1];\n    }\n    memset(pre,~INF,sizeof(pre));\n    memset(suf,~INF,sizeof(suf));\n    pre[0][0]=0;\n    suf[top-1][0]=0;\n    for(i=0;i<top;i++){\n        for(j=0;j<=n;j++)\n            if(pre[i][j]>~INF)\n                pre[i][pre[i][j]]=max(pre[i][pre[i][j]],j);\n        for(j=n-1;j>=0;j--)\n            pre[i][j]=max(pre[i][j],pre[i][j+1]);\n        for(j=0;j<=n;j++)\n            for(k=i+1;k<top;k++)\n                if(pre[i][j]>~INF)\n                    pre[k][pre[i][j]]=max(pre[k][pre[i][j]],j+num[i][k]);\n    }\n    for(i=top-1;i>=0;i--{\n        for(j=0;j<=n;j++)\n            if(suf[i][j]>~INF)\n                suf[i][suf[i][j]]=max(suf[i][suf[i][j]],j);\n        for(j=n-1;j>=0;j--)\n            suf[i][j]=max(suf[i][j],suf[i][j+1]);\n        for(j=0;j<=n;j++)\n            for(k=i-1;k>=0;k--)\n                if(suf[i][j]>~INF)\n                    suf[k][suf[i][j]]=max(suf[k][suf[i][j]],j+num[k][i]);\n    }\n    for(i=0;i<top;i++)\n        for(j=i;j<top;j++){\n            g[i][j]=~INF;\n            for(x=0,y=n;x<=n;x++){\n                while(y>=0&&x+y>num[i][j]+pre[i][x]+suf[j][y])y--;\n                if(y>=0)g[i][j]=max(g[i][j],x+y);\n            }\n        }\n    for(i=0;i<=n;i++)\n        ans=max(ans,min(i,suf[0][i]));\n    printf(\"%lld\\n\",ans);\n    for(i=1;i<=n;i++){\n        ans=0;\n        for(int j=0;j<=seg[i].L;j++)\n            for(int k=seg[i].R;k<top;k++)\n                ans=max(ans,g[j][k]);\n        printf(\"%lld\\n\",ans);\n    }\n    return 0;\n}\n```\n\n------------\n\u6700\u540e\n\u6211\u518d\u6b21\u819c\u62dc\u7ba1\u7406\u5458\u548c\u5728\u6211\u4e4b\u524d\u51fa\u9898\u89e3\u7684\u5927\u4f6c\u4eec\uff0c\u5927\u4f6c\u4eec\u4e5f\u7ed9\u4e86\u6211\u5f88\u591a\u542f\u53d1\uff0c\u8c22\u8c22\u5927\u4f6c\u4eec\n\u4e03\u4e2a\u5b57\uff1a\u7ba1\u7406\u5458\u548c\u5927\u4f6c\u5f3a\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01",
        "postTime": 1552307482,
        "uid": 125094,
        "name": "Sakura_Magician",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1973 \u3010[NOI2011]Noi\u5609\u5e74\u534e\u3011"
    },
    {
        "content": "\u7b80\u5355\u9898\uff0c\u5199\u6302\u4e86\uff0c\u611f\u89c9\u6a21\u62df\u8d5b\u968f\u4fbf\u80e1\u4e86\u4e2a\u7b97\u6cd5\u548c\u5176\u4ed6\u4eba\u4e0d\u592a\u4e00\u6837\uff0c\u4f46\u4f30\u8ba1\u672c\u8d28\u8fd8\u662f\u5dee\u4e0d\u591a\u7684\u3002\n\n\u9996\u5148\u53d1\u73b0\u65f6\u95f4\u70b9\u4e4b\u95f4\u7684\u95f4\u9694\u5927\u5c0f\u6ca1\u6709\u7528\uff0c\u53ea\u7528\u8003\u8651\u65f6\u95f4\u70b9\u5c31\u53ea\u6709 $O(n)$ \u4e2a\uff0c\u4ee4\u65f6\u95f4\u70b9\u4e2a\u6570\u4e3a $t$\u3002\n\n\u8003\u8651\u4e24\u4e2a\u4f1a\u573a\u53d1\u73b0\u65e0\u672c\u8d28\u533a\u522b\uff0c\u4e8e\u662f\u8c01\u9009\u591a\u9009\u5c11\u65e0\u5173\u800c\u53ea\u4e0e\u4e24\u8005\u6d3b\u52a8\u5dee\u503c\u6709\u5173\u3002\n\n\u4e8e\u662f\u8bbe\u4ec5\u5728 $1\\sim i$ \u7684\u65f6\u95f4\u70b9\u4e4b\u5185\u9009\u6d3b\u52a8\uff0c\u4f7f\u5f97\u4e24\u4e2a\u4f1a\u573a\u6d3b\u52a8\u76f8\u5dee\u4e3a $j$\uff0c\u5c11\u7684\u90a3\u4e2a\u4f1a\u573a\u4e3e\u529e\u7684\u6d3b\u52a8\u6700\u591a\u4e3a $f_{i,j}$\uff0c\u540c\u7406\u5b9a\u4e49\u4ec5\u5728 $i\\sim t$ \u4e2a\u65f6\u95f4\u70b9\u5185\u9009\u7684\u5c11\u7684\u90a3\u4e2a\u6700\u591a\u6d3b\u52a8\u6570\u4e3a $g_{i,j}$\u3002\n\n\u8f6c\u79fb\u7684\u8bdd\u8fd8\u5f97\u9884\u5904\u7406 $w_{i,j}$ \u8868\u793a\u5728 $i\\sim j$ \u7684\u65f6\u95f4\u70b9\u4e4b\u95f4\u7684\u533a\u95f4\u4e2a\u6570\uff0c\u6ce8\u610f\u8fd9\u9053\u9898\u6bd4\u8f83\u5947\u602a\u7aef\u70b9\u90fd\u53ef\u4ee5\u7b97\u8fdb\u6765\uff0c\u7136\u540e\u679a\u4e3e\u628a $w$ \u7ed9\u54ea\u4e2a\u4f1a\u573a\u5c31\u6709\u4e86\u8f6c\u79fb\u5f0f\uff1a\n\n$$f_{j,k}\\to f_{i,k+w_{j,i}}$$\n\n$$f_{j,k}+k\\to f_{i,w_{j,i}-k},k\\le w_{i,j}$$\n\n$$f_{j,k}+w_{j,i}\\to f_{i,k-w_{j,i}},k>w_{i,j}$$\n\n\u7b2c\u4e00\u95ee\u7684\u7b54\u6848\u5c31\u51fa\u6765\u4e86\uff0c\u5c31\u662f $\\max_x f_{n,x}$\uff0c\u6216\u662f $\\max_x g_{1,x}$\u3002\n\n\u8003\u8651\u7b2c\u4e8c\u95ee\uff0c\u9996\u5148\u6211\u4eec\u80af\u5b9a\u679a\u4e3e\u5f3a\u5236\u9009\u4e86\u5f53\u524d\u533a\u95f4 $i$ \u7684\u662f\u54ea\u4e2a\u65f6\u95f4\u70b9\u4e4b\u5185\uff0c\u4e5f\u5373\u679a\u4e3e $w_{j,k},j\\le S_i,T_i\\le k$\u3002\n\n\u53d1\u73b0\u4e3a\u4e86\u5408\u5e76\u8fd8\u5f97\u679a\u4e3e\u5de6\u8fb9\u7684\u5dee\u4e3a $a$\uff0c\u53f3\u8fb9\u7684\u5dee\u4e3a $b$\uff0c\u603b\u5171\u5c31 $O(n^5)$ \u4e86\uff0c\u63a5\u4e0b\u6765\u6709\u4e24\u79cd\u505a\u6cd5\uff1a\n\n- \u4e00\u4e2asb\u7684\u6a21\u62df\u8d5b\u8003\u573a\u505a\u6cd5\u662f\u6539\u53d8\u679a\u4e3e\u987a\u5e8f\u540e\u628a $k,b$ \u6539\u4e3a\u9884\u5904\u7406\uff0c\u4e5f\u5373\u6211\u4eec\u5b8c\u5168\u628a\u5de6\u8fb9\u7684\u60c5\u51b5\u679a\u4e3e\u51fa\u6765\uff0c\u53f3\u8fb9\u7684\u60c5\u51b5\u901a\u8fc7\u63d0\u524d\u5904\u7406\u5feb\u901f\u5f97\u5230\u3002\n\n  \u4f46\u7531\u4e8e\u6709\u504f\u5e8f $j\\le S_i,T_i\\le k$ \u7684\u540c\u65f6\u8fd8\u5f97\u5904\u7406\u5408\u5e76\u5f97\u5230\u6700\u5927\u503c\uff0c\u9884\u5904\u7406\u8fc7\u540e\u53ea\u597d\u4e0a\u4e00\u68f5\u4e3b\u5e2d\u6811\u6765\u5feb\u901f\u8be2\u95ee\uff0c$O(n^3\\log n)$\uff0c\u73b0\u5728\u90fd\u8fd8\u6ca1\u6539\u51fa\u6765\u3002\n  \n- \u771f\u6b63\u7684\u7b80\u5355\u7684\u505a\u6cd5\u662f\u628a $i$ \u4e22\u6389\uff0c\u5148\u7b97 $val_{j,k}$ \u7684\u7b54\u6848\uff0c\u518d\u679a\u4e3e\u5f3a\u5236\u9009\u4e86 $i$ \u7684\u65f6\u95f4\u70b9\u4e4b\u5185 $w_{j,k}$\uff0c\u76f4\u63a5\u53d6\u4e4b\u524d\u7b97\u51fa\u6765\u7684\u7b54\u6848\u5373\u53ef\u3002\n\n  \u7136\u540e\u53d1\u73b0\u4e0a\u4e00\u4e2a\u505a\u6cd5\u4e00\u6837\u9884\u5904\u7406\u4e00\u4e0b\uff0c\u5408\u5e76\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u628a $w,a,b$ \u4e22\u6389\u4e00\u4e2a $a/b$\uff0c\u6ca1\u6709\u504f\u5e8f\u4e8e\u662f\u968f\u4fbf\u5199\u4f7f\u7528\u7684\u65f6\u5019\u90fd\u662f $O(1)$ \u7684\uff0c\u8f7b\u677e $O(n^3)$\u3002\n  \n[\u4ee3\u7801\u8f7b\u5ea6\u538b\u884c](https://www.luogu.com.cn/paste/up1ge3yi)",
        "postTime": 1643186454,
        "uid": 158948,
        "name": "\u7ea6\u745f\u592b\u7528\u8111\u73a9",
        "ccfLevel": 0,
        "title": "P1973 [NOI2011] NOI \u5609\u5e74\u534e"
    },
    {
        "content": "\u4e00\u9053\u6bd4\u8f83\u666e\u901a\u7684dp\u9898\u3002\n\n\u8fd9\u91cc\u7ed9\u51fa\u4e00\u79cd $O(n^3\\log n)$\uff08\u4f46\u662f\u80fd\u8fc7\uff09\u7684\u65b9\u6cd5\u3002\n\n\u8003\u8651\u6700\u666e\u901a\u7684 dp\uff0c\u5148\u628a\u65f6\u95f4\u79bb\u6563\u5316\uff0c\u79bb\u6563\u5316\u7684\u65f6\u5019\u6709\u4e00\u4e2a\u5c0f\u7ec6\u8282\uff1a\u5c06\u533a\u95f4 $[l,r]$ \u8f6c\u5316\u6210\u533a\u95f4 $[l,r+1)$ \u6548\u679c\u66f4\u4f73\uff0c\u8bbe $c_{l,r}$ \u8868\u793a\u5305\u542b\u5728 $[l,r]$ \u533a\u95f4\u5185\u7684\u6d3b\u52a8\u6570\uff0c\u8bbe $f_{i,j}$ \u8868\u793a\u5230\u7b2c $i$ \u4e2a\u65f6\u95f4\u70b9\uff0c$1$ \u53f7\u6d3b\u52a8\u573a\u4e3e\u529e\u4e86 $j$ \u573a\u6d3b\u52a8\uff0c\u90a3\u4e48 $2$ \u53f7\u6d3b\u52a8\u573a\u6700\u591a\u80fd\u4e3e\u529e\u591a\u5c11\u6d3b\u52a8\u3002\n\n\u8f6c\u79fb\uff1a$f_{i,j}=max(f_{k,j}+c_{k,i}),f_{i,j}=max(f_{k,j-c_{k,i}})$\n\n\u8bb0\u5f97\u8bb0\u5f55\u4e00\u4e0b\u6bcf\u4e2a\u4f4d\u7f6e\u662f\u5426\u5b58\u5728\u5373\u53ef\u3002\n\n\u606d\u559c\u4f60\u62ff\u5230\u4e86 $40$ \u5206\u3002\n\n\u5bf9\u4e8e $100$ \u5206\u7684\u505a\u6cd5\uff0c\u663e\u7136\u662f\u8981\u7ef4\u62a4\u4e00\u4e2a\u524d\u7f00\uff0c\u4e00\u4e2a\u540e\u7f00\uff0c\u8bbe\u524d\u7f00\u6570\u7ec4\u4e3a $f$\uff0c\u540e\u7f00\u4e3a $g$\uff0c\u8bbe $s_{i,j}$ \u8868\u793a $[i,j]$ \u533a\u95f4\u5185\u7684\u6d3b\u52a8\u90fd\u5fc5\u987b\u4e3e\u529e\u7684\u65b9\u6848\uff0c\u90a3\u4e48\u53ef\u4ee5\u76f4\u63a5\u7b97\u51fa\u7b54\u6848\u3002\n\n\u73b0\u5728\u7684\u95ee\u9898\u662f\u5982\u4f55\u8ba1\u7b97 $s_{i,j}$\u3002\n\n\u679a\u4e3e $i,j$\uff0c\n$$s_{i,j}=\\max_{x,y}(min(x+y+c_{i,j},f_{i,x}+g_{j,y}))$$\n\u4f46\u56e0\u4e3a\u6211\u592a\u83dc\uff0c\u4e0d\u4f1a\u4ec0\u4e48\u7ebf\u6027\u7684\u505a\u6cd5\u3002\n\n\u8bbe $h_k=\\max(f_{i,x}+g_{j,y})(x+y=k)$\uff0c\u90a3\u4e48\u4e0d\u96be\u5f97\u5230 $h_k$ \u662f\u5355\u8c03\u9012\u51cf\u7684\u3002\n\n\u679a\u4e3e $t=x+y$\uff0c\u53d8\u6210\u4e86 $s_{i,j}=\\max(min(t+c_{i,j},h_t))$\u3002\n\n\u76f4\u63a5\u7b97\u51fa\u6240\u6709\u7684 $h_t$ \u663e\u7136\u5f00\u9500\u6709\u70b9\u5927\uff0c\u4e0d\u8fc7\u6211\u4eec\u53ef\u4ee5\u7528 $O(n)$ \u7684\u65f6\u95f4\u7b97\u51fa\u4e00\u4e2a $h_t$\n\n\u663e\u7136\uff0c\u4e00\u4e2a\u5355\u589e\u51fd\u6570\u548c\u4e00\u4e2a\u5355\u95f4\u51fd\u6570\u53d6 $\\min$ \u4e4b\u540e\u7684\u6700\u5927\u503c\u662f\u4e24\u51fd\u6570\u7684\u4ea4\u70b9\uff0c\u4e8c\u5206\u4e00\u4e0b\u5373\u53ef\u3002\n\n\u518d\u63a8\u8350\u4e00\u9053\u7c7b\u4f3c\u7684\u9898\u76ee\uff1a[[\u7701\u9009\u8054\u8003 2020 A/B \u5377] \u51b0\u706b\u6218\u58eb](https://www.luogu.com.cn/problem/P6619)\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a $O(n^3\\log n)$\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<cstdio>\n#include<algorithm>\n#define N 410\n#define mid ((l+r)>>1)\nusing namespace std;\nint n,a,l[N],r[N],x[N],len,ans[N],ss[N][N];\nint dp[N][N],c[N][N],p[N][N],dp2[N][N],p2[N][N];\nint calc(int a,int b,int x)\n{\n\tint s=0;\n\tfor(int i=0;i<=x;i++)\n\t\tif(i<=c[1][a]&&x-i<=c[b][len])\n\t\t\ts=max(s,dp[a][i]+dp2[b][x-i]);\n\treturn s;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d%d\",&l[i],&r[i]);r[i]+=l[i];\n\t\tx[++len]=l[i],x[++len]=r[i];\n\t}\n\tsort(x+1,x+len+1);\n\tlen=unique(x+1,x+len+1)-x-1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tl[i]=lower_bound(x+1,x+len+1,l[i])-x;\n\t\tr[i]=lower_bound(x+1,x+len+1,r[i])-x;\n\t}\n\tfor(int i=1;i<len;i++)\n\t\tfor(int j=i+1;j<=len;j++)\n\t\t\tfor(int k=1;k<=n;k++)\n\t\t\t\tif(l[k]>=i&&r[k]<=j) c[i][j]++;\n\tp[1][0]=1;\n\tfor(int i=2;i<=len;i++)\n\t\tfor(int j=0;j<=n;j++)\n\t\t\tfor(int k=1;k<i;k++)\n\t\t\t{\n\t\t\t\ta=c[k][i];\n\t\t\t\tif(p[k][j]) dp[i][j]=max(dp[i][j],dp[k][j]+a),p[i][j]=1;\n\t\t\t\tif(j>=a&&p[k][j-a]) dp[i][j]=max(dp[i][j],dp[k][j-a]),p[i][j]=1;\n\t\t\t}\n\tp2[len][0]=1;\n\tfor(int i=len-1;i;i--)\n\t\tfor(int j=0;j<=n;j++)\n\t\t\tfor(int k=i+1;k<=len;k++)\n\t\t\t{\n\t\t\t\ta=c[i][k];\n\t\t\t\tif(p2[k][j]) dp2[i][j]=max(dp2[i][j],dp2[k][j]+a),p2[i][j]=1;\n\t\t\t\tif(j>=a&&p2[k][j-a]) dp2[i][j]=max(dp2[i][j],dp2[k][j-a]),p2[i][j]=1;\n\t\t\t}\n\tfor(int i=1;i<=n;i++) ans[0]=max(ans[0],min(i,dp[len][i]));\n\tfor(int i=1;i<len;i++)\n\t\tfor(int j=i+1;j<=len;j++)\n\t\t{\n\t\t\tint l=0,r=n-c[i][j];\n\t\t\twhile(l<r)\n\t\t\t\tif(calc(i,j,mid)>mid+c[i][j]) l=mid+1;\n\t\t\t\telse r=mid;\n\t\t\tss[i][j]=min(l+c[i][j],calc(i,j,l));\n\t\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=l[i];j++)\n\t\t{\n\t\t\tfor(int k=r[i];k<=len;k++)\n\t\t\t\tans[i]=max(ans[i],ss[j][k]);\n\t\t}\n\t}\n\tfor(int i=0;i<=n;i++) printf(\"%d\\n\",ans[i]);\n}\n```",
        "postTime": 1624359326,
        "uid": 99506,
        "name": "_LHF_",
        "ccfLevel": 0,
        "title": "NOI \u5609\u5e74\u534e \u89e3\u9898\u62a5\u544a"
    }
]
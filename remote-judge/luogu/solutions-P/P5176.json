[
    {
        "content": "\u611f\u89c9\u6807\u51c6\u9898\u89e3\u91cc\u7684\u5f0f\u5b50\u63a8\u9519\u4e86\u3002\u3002\u3002\u6211\u6765\u5199\u4e00\u7bc7\u8be6\u7ec6\u4e00\u70b9\u7684\u9898\u89e3\u5427\u3002\n\n\u6ce8\u610f\uff1a\u672c\u6587\u6240\u6709\u9664\u6cd5\u5747\u4e3a\u5411\u4e0b\u53d6\u6574\u3002\n\n## \u516c\u5f0f\u3001\u5f15\u7406\u53ca\u8bc1\u660e\n\n### \u5f15\u7406\uff1a$gcd(ij,ik,jk)=\\frac {gcd(i,j)gcd(i,k)gcd(j,k)}{gcd(i,j,k)}$\n\n\u8bc1\u660e\uff1a\u8003\u8651\u6bcf\u4e2a\u6570\u8d28\u56e0\u6570\u7684\u5e42\u6b21\uff0c\u8bbe $i,j,k$ \u5173\u4e8e\u8d28\u56e0\u5b50 $p$ \u7684\u5e42\u6b21\u5206\u522b\u4e3a $a,b,c$ ,\u4e0d\u59a8\u8bbe $a\\le b\\le c$ \u3002\n\n\u6613\u8bc1 $gcd(i,j)$ \u5173\u4e8e $p$ \u7684\u5e42\u6b21\u4e3a $min(a,b)$ \u3002\n\n\u5219\u539f\u5f0f\u5173\u4e8e $p$ \u7684\u5e42\u6b21\u7684\u5f0f\u5b50\u7b49\u4e8e\n\n$min(a+b,a+c,b+c)=min(a,b)+min(a,c)+min(b,c)-min(a,b,c)$\n\n\u5373 $a+b=a+a+b-a$ \uff0c\u663e\u7136\u6210\u7acb\u3002\n\n\u82e5\u4e24\u4e2a\u6570\u5173\u4e8e\u5404\u8d28\u56e0\u5b50\u7684\u5e42\u6b21\u90fd\u76f8\u7b49\uff0c\u5219\u8fd9\u4e24\u4e2a\u6570\u76f8\u7b49\u3002\n\n\u5f97\u8bc1\u3002\n\n\u6240\u4ee5\n\n$Ans=\\sum_{i=1}^n \\sum_{j=1}^m \\sum_{k=1}^p gcd^2(i,j)+gcd^2(i,k)+gcd^2(j,k)$\n\n\u53d1\u73b0\u6bcf\u4e2a $gcd$ \u4e2d\u90fd\u53ea\u6709\u4e24\u4e2a\u53c2\u6570\uff0c\u7b2c\u4e09\u4e2a\u53c2\u6570\u4e0d\u4f1a\u5f71\u54cd $gcd$ \u7684\u503c\uff0c\u53ea\u4f1a\u5f71\u54cd $gcd$ \u7684\u503c\u51fa\u73b0\u7684\u6b21\u6570\uff0c\u5206\u522b\u679a\u4e3e\uff0c\u5f97\n\n$Ans=p\\times \\sum_{i=1}^n\\sum_{j=1}^m gcd^2(i,j)$\n\n$+m\\times \\sum_{i=1}^n\\sum_{j=1}^p gcd^2(i,j)$\n\n$+n\\times \\sum_{i=1}^m\\sum_{j=1}^p gcd^2(i,j)$\n\n\u53d1\u73b0\u8981\u6c42\u7684 $gcd$ \u7684\u5e73\u65b9\u548c\u90fd\u662f\u5f62\u5982 $\\sum_{i=1}^n\\sum_{j=1}^m gcd^2(i,j)$ \u7684\uff0c\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u5982\u4e0b\uff1a\n\n\u679a\u4e3e $gcd$ \u7684\u503c\n\n$\\sum_{i=1}^n \\sum_{j=1}^m gcd^2(i,j)=\\sum_{d=1}^{min(n,m)} d^2\\sum_{i=1}^n\\sum_{j=1}^m [gcd(i,j)=d]$\n\n\u5bf9\u4e8e\u65b9\u62ec\u53f7\u5185\u7684\u5185\u5bb9\uff0c\u5982\u679c\u5f0f\u5b50\u7684\u503c\u4e3a\u771f\uff0c\u5219\u65b9\u62ec\u53f7\u7684\u8fd4\u56de\u503c\u4e3a $1$ \uff0c\u5426\u5219\u4e3a $0$ \u3002\n\n$gcd(i,j)=d$ \uff0c\u53ea\u6709\u5728 $i,j$ \u5747\u4e3a $d$ \u7684\u500d\u6570\u65f6\u624d\u6709\u53ef\u80fd\uff0c\u6240\u4ee5\u53ea\u679a\u4e3e $i,j$ \u5747\u4e3a $d$ \u7684\u500d\u6570\u7684\u60c5\u51b5\n\n$=\\sum_{d=1}^{min(n,m)} d^2 \\sum_{i=1}^{\\frac n d} \\sum_{j=1}^{\\frac m d} [gcd(i,j)=1]$\n\n\u73b0\u5728\u9898\u76ee\u8f6c\u5316\u4e3a\u6c42 $\\sum_{i=1}^a \\sum_{j=1}^b [gcd(i,j)=1]$ \u7684\u503c\u4e86\u3002\n\n\u6211\u4eec\u8bbe $f(x)=\\sum_{i=1}^a\\sum_{j=1}^b [gcd(i,j)=x]$ \uff0c $F(x)=\\sum_{i=1}^a\\sum_{j=1}^b [x|gcd(i,j)]$ \uff0c\u6613\u5f97 $F(x)=\\sum_{x|d} f(d)$\n\n\u800c\u56e0\u4e3a $gcd(i,j)$ \u662f $x$ \u7684\u500d\u6570\uff0c\u5f53\u4e14\u4ec5\u5f53 $i,j$ \u5747\u4e3a $x$ \u7684\u500d\u6570\uff0c\u6240\u4ee5 $F(x)=\\frac n x \\times \\frac m x$\n\n\u7531\u500d\u6570\u53cd\u6f14\u7684\u5f0f\u5b50 $f(1)=\\sum_{d=1}\\mu(d)F(d)$\n\n$=\\sum_{d=1}^{min(n,m)} \\mu(d)\\times \\frac n d\\times \\frac m d$\n\n$\\therefore \\sum_{i=1}^n \\sum_{j=1}^m gcd^2(i,j)=\\sum_{d=1}^{min(n,m)} d^2 \\sum_{i=1}^{\\frac n d} \\sum_{j=1}^{\\frac m d} [gcd(i,j)=1]$\n\n$=\\sum_{d=1}^{min(n,m)} d^2 \\sum_{g=1}^{min(\\frac n d,\\frac m d)} \\mu(g)\\times \\frac n {gd}\\times \\frac m {gd}$\n\n\u679a\u4e3e $T=gd$ \uff0c\u540c\u65f6\u679a\u4e3e $d|T$ \uff0c\u5219 $g=\\frac T d$\n\n$=\\sum_{T=1}^{min(n,m)} \\frac n T \\times \\frac m T \\times \\sum_{d|T} d^2\\mu(\\frac T d)$\n\n\u89c2\u5bdf\u5230 $\\frac n T$ \u548c $\\frac m T$ \u90fd\u6700\u591a\u5206\u522b\u53ea\u6709 $O(\\sqrt n)$ \u79cd\u53d6\u503c\uff08\u9ed8\u8ba4 $n,m$ \u540c\u9636\uff09\uff0c\u53ef\u4ee5\u7528\u6574\u9664\u5206\u5757\u4f7f\u679a\u4e3e $T$ \u7684\u503c\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u964d\u4e3a $O(\\sqrt n)$ \uff0c\u73b0\u5728\u7684\u95ee\u9898\u662f\uff0c\u5982\u4f55\u5728\u5408\u7406\u7684\u9884\u5904\u7406\u65f6\u95f4\u5185\uff0c\u5728 $O(1)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e0b\u6c42\u51fa $\\sum_{d|x} d^2\\mu(\\frac x d)$ \u7684\u503c\u6216\u524d\u7f00\u548c\u3002\n\n\u89c2\u5bdf\u5230 $f(x)=d^2$ \u548c $g=\\mu$ \u90fd\u662f ** \u79ef\u6027\u51fd\u6570 ** \u3002\u6240\u6c42\u503c\u7684\u5f62\u5f0f\u4e3a\u4e24\u4e2a\u51fd\u6570\u7684\u5377\u79ef\uff0c\u6240\u4ee5\u4e5f\u662f\u79ef\u6027\u51fd\u6570\u3002\u8003\u8651\u5230 $O(n)$ \u7684\u9884\u5904\u7406\u65f6\u95f4\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\uff0c\u501f\u52a9\u5b83\u662f\u79ef\u6027\u51fd\u6570\u7684\u6027\u8d28\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528 ** \u7ebf\u6027\u7b5b ** \u8ba1\u7b97\u51fa\u8be5\u51fd\u6570\u7684\u503c\u3002\n\n\u8bb0 $h(x)=\\sum_{d|x} d^2\\mu(\\frac x d)$ \u3002\n\n\u6839\u636e\u5b9a\u4e49\u8ba1\u7b97\u5f97\uff0c $h(1)=1,h(p)=1^2\\times \\mu(p)+p^2\\times \\mu(1)=p^2-1$ \uff08$p$ \u662f\u8d28\u6570\uff09\u3002\n\n\u7531\u79ef\u6027\u51fd\u6570\u7684\u6027\u8d28\u5f97\uff0c $h(xy)=h(x)h(y)~(gcd(x,y)=1)$ \u3002\n\n\u73b0\u5728\uff0c\u6211\u4eec\u53ea\u9700\u8003\u8651\u7ebf\u6027\u7b5b\u7684\u6700\u540e\u4e00\u4e2a\u95ee\u9898\uff0c\u82e5 $x=\\prod_{i=1}^k p_i^{a_i}(p_i<p_{i+1})$ \uff0c\u5219 $h(x\\times p_1)$ \u5982\u4f55\u8868\u793a\uff1f\n\n### \u5f15\u7406\uff1a $h(x\\times p_1)=h(x)\\times p_1^2$\n\n\u8bc1\u660e\uff1a\u89c2\u5bdf $h$ \u51fd\u6570\u7684\u5f62\u5f0f\u3002\u56e0\u4e3a $p_1$ \u662f $x$ \u7684\u6700\u5c0f\u7d20\u6570\u56e0\u5b50\uff0c\u6240\u4ee5 $x\\times p_1$ \u4e00\u5b9a\u542b\u6709 $p_1$ \u7684\u5e73\u65b9\u56e0\u5b50\u3002\u8003\u8651 $\\mu$ \u503c\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u3002$\\mu$ \u503c\u4e3a $0$ \u65f6\uff0c\u5373 $\\frac x d$ \u6709\u5e73\u65b9\u56e0\u5b50\u65f6\uff0c\u8be5 $d$ \u5bf9\u7b54\u6848\u65e0\u8d21\u732e\u3002\n\n\u82e5\u4e00\u4e2a $x$ \u7684\u7ea6\u6570 $d$ \u5bf9 $h(x)$ \u7684\u7b54\u6848\u6709\u8d21\u732e\uff0c\u5219 $d\\times p_1$ \u5bf9 $h(x\\times p_1)$ \u7684\u7b54\u6848\u4e5f\u6709\u8d21\u732e\uff0c\u5426\u5219\u5373\u6709\u5e73\u65b9\u56e0\u5b50\uff0c\u5373\u53ea\u6709\u8fd9\u4e9b $d\\times p_1$ \u5bf9\u7b54\u6848\u6709\u8d21\u732e\u3002\u56e0\u4e3a\u4e58\u4e0a $p_1$ \u540e\u8d21\u732e\u7684\u503c\u4e58\u4e86\u5e73\u65b9\uff0c\u6240\u4ee5\u7b54\u6848\u4f1a\u4e58\u4e0a $p_1^2$ \u3002\n\n\u5f97\u8bc1\u3002\n\n\u540c\u7406\uff0c\u8be5\u7ed3\u8bba\u4e5f\u80fd\u6269\u5c55\u5230\u4efb\u610f $x$ \u7684\u8d28\u56e0\u5b50 $p_k$ \u4e0a\u3002\n\n\u540c\u6837\u7684\uff0c\u4e5f\u53ef\u4ee5\u7c7b\u6bd4 $\\phi(x)=\\sum_{d|x} d\\mu(\\frac x d)$ \u7684\u7ebf\u6027\u7b5b\u6cd5\u5f97\u51fa $h(x)$ \u7684\u7ebf\u6027\u7b5b\u65b9\u6cd5\u3002\n\n## \u4ee3\u7801\u5c55\u793a\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nconst int maxn=20000010;\ntypedef long long ll;\nconst ll mod=1000000007;\nll T,n,m,p,cur,pri[maxn],f[maxn],sum[maxn];\nbool tf[maxn];\nll calc(ll n,ll m)\n{\n\tll ret=0;\n\t//for(ll T=1;T<=min(n,m);T++)ret=(ret+(n/T)*(m/T)%mod*f[T]%mod)%mod;\n\tfor(ll i=1,j;i<=min(n,m);i=j+1)\n\t{\n\t\tj=min(n/(n/i),m/(m/i));\n\t\tret=(ret+(n/i)*(m/i)%mod*((sum[j]-sum[i-1]+mod)%mod)%mod)%mod;\n\t}\n\treturn ret;\n}\nint main()\n{\n\tf[1]=1;\n\tfor(ll i=2;i<=20000000;i++)\n\t{\n\t\tif(!tf[i]){pri[++cur]=i;f[i]=(i*i%mod-1+mod)%mod;}\n\t\tfor(ll j=1;j<=cur&&i<=20000000/pri[j];j++)\n\t\t{\n\t\t\ttf[i*pri[j]]=true;\n\t\t\tif(i%pri[j]==0){f[i*pri[j]]=f[i]*pri[j]%mod*pri[j]%mod;break;}\n\t\t\telse f[i*pri[j]]=f[i]*f[pri[j]]%mod;\n\t\t}\n\t}\n\tfor(ll i=1;i<=20000000;i++)sum[i]=(sum[i-1]+f[i])%mod;\n\tscanf(\"%lld\",&T);\n\twhile(T--)\n\t{\n\t\tscanf(\"%lld%lld%lld\",&n,&m,&p);\n\t\tprintf(\"%lld\\n\",(p*calc(n,m)%mod+m*calc(n,p)%mod+n*calc(m,p)%mod)%mod);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1547785875,
        "uid": 43486,
        "name": "hsfzLZH1",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5176 \u3010\u516c\u7ea6\u6570\u3011"
    },
    {
        "content": "~~\u770b\u5230\u8fd9\u9898\u76ee\u5c31\u4e0d\u60f3\u505a\u4e86\u7cfb\u5217\uff0c\u51fa\u9898\u4eba\u662f\u4e0d\u662f\u90fd\u4e0d\u77e5\u9053\u675c\u6559\u7b5b\u662f\u4ec0\u4e48\u4e1c\u897f\u554a\uff0c\u4ed6\u5bb6\u675c\u6559\u7b5b\u53ef\u4ee5\u9884\u5904\u7406\u4f18\u5316\u5230~~$O(n^\\frac{2}{3})$\n\n~~\u5148\u5413\u552c\u4f60\u4e00\u4e0b\uff0c\u6211\u4eec\u8981\u6c42\uff1a~~\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{k=1}^p\\gcd(i\\cdot j,i\\cdot k,j\\cdot k)\\times \\gcd(i,j,k)\\times \\left(\\frac{\\gcd(i,j)}{\\gcd(i,k)\\times \\gcd(j,k)}+\\frac{\\gcd(i,k)}{\\gcd(i,j)\\times \\gcd(j,k)}+\\frac{\\gcd(j,k)}{\\gcd(i,j)\\times \\gcd(i,k)}\\right)$$\n\n\u6211\u4eec\u4ee4$x = gcd(i, j), y = gcd(i, k), z = gcd(j, k)$\n\n\u4e8e\u662f\u6211\u4eec\u6709\uff1a\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{k=1}^p\\gcd(i\\cdot j,i\\cdot k,j\\cdot k)\\times \\gcd(i,j,k)\\times \\left(\\frac{x}{y\\times z}+\\frac{y}{x\\times z}+\\frac{z}{x\\times y}\\right)$$\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{k=1}^p\\gcd(i\\cdot j,i\\cdot k,j\\cdot k)\\times \\gcd(i,j,k) \\times \\frac{x ^ 2 + y ^ 2 + z ^ 2}{x \\times y \\times z}$$\n\n\u5c55\u5f00\u7b2c\u4e00\u9640\u6076\u5fc3\u4eba\u7684\u67ff\u5b50\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n$$gcd(i\\cdot j,i\\cdot k,j\\cdot k) = \\frac{x \\times y\\times z}{gcd(i, j, k)}$$\n\n\uff08\u8bc1\u660e\u53ef\u4ee5\u901a\u8fc7**\u552f\u4e00\u5206\u89e3\u5b9a\u7406**\u5c55\u5f00\uff09\n\n\u4e8e\u662f\u6211\u4eec\u60ca\u559c\u5730\u53d1\u73b0\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6c42$($\u8fd8\u539f$x, y, z)$\uff1a\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{k=1}^p gcd(i, j)^2 +gcd(j, k) ^ 2 + gcd(i, k) ^ 2$$\n\n\u6211\u4eec\u628a\u67ff\u5b50\u5206\u5f00\u5199\uff0c\u5f97\u5230\uff1a\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{k=1}^p gcd(i, j)^2+\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{k=1}^pgcd(j, k) ^ 2 +\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{k=1}^p gcd(i, k) ^ 2$$\n\n\u56e0\u4e3a$gcd(i, j)$\u4e0ek\u65e0\u5173\uff08\u5176\u4ed6\u540c\u7406\uff09\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u63d0\u51fak\uff0c\u53d8\u6210p\u4e2a$\\sum_{i=1}^n\\sum_{j=1}^m gcd(i, j)^2$\u76f8\u52a0\uff0c\u6545\u6709\uff1a\n\n$$p \\times \\sum_{i=1}^n\\sum_{j=1}^m gcd(i, j)^2+n \\times \\sum_{j=1}^m\\sum_{k=1}^pgcd(j, k) ^ 2 +m \\times \\sum_{i=1}^n\\sum_{k=1}^p gcd(i, k) ^ 2$$\n\n\u8bbe$F(n, m) = \\sum_{i=1}^n\\sum_{j=1}^m gcd(i, j)^2$\n\n\u539f\u5f0f$=p \\times F(n, m) + n \\times F(p, m) + m \\times F(n, p)$\n\n\u6240\u4ee5\u95ee\u9898\u8f6c\u5316\u4e3a\u5982\u4f55\u5feb\u901f\u7684\u6c42\u51fa$F(n, m)$\uff08\u4e0d\u59a8\u8bbe$n \u2264 m$\uff09\n\n$$F(n, m) = \\sum_{d = 1}^n\\sum_{i=1}^n\\sum_{j=1}^m d^2 \\times [gcd(i, j) == d]$$\n\n$i, j$\u540c\u65f6\u9664\u4ee5d\u5f97\uff1a\n\n$$F(n, m) = \\sum_{d = 1} ^ n\\sum^{n / d}_{i = 1}\\sum^{m / d}_{j = 1} d ^ 2 \\times [gcd(i, j) == 1]$$\n$$F(n, m) = \\sum_{d = 1} ^ nd ^ 2\\sum^{n / d}_{i = 1}\\sum^{m / d}_{j = 1}\\sum_{k|gcd(i, j)} \\mu(k)$$\n\n\u63d0\u524d\u679a\u4e3eK\u5f97\uff1a\n\n$$F(n, m) = \\sum_{d = 1} ^ n d ^ 2\\sum_{k = 1}^{n / d}\\mu(k)\\sum^{n / (d * k)}_{i = 1}\\sum^{m / (d * k)}_{j = 1}  $$\n\n\n$$F(n, m) = \\sum_{d = 1} ^ n d ^ 2\\sum_{k = 1}^{n / d}\\mu(k)\\left \\lfloor \\frac{n}{d * k} \\right \\rfloor \\times \\left \\lfloor \\frac{m}{d * k} \\right \\rfloor$$\n\n\n\u8ddf\u636e\u53cd\u6f14\u5957\u8def\uff0c\u6211\u4eec\u4ee4$T = d * k$\n\n$$F(n, m) = \\sum_{T = 1}^n \\left \\lfloor \\frac{n}{T} \\right \\rfloor \\times \\left \\lfloor \\frac{m}{T} \\right \\rfloor\\sum_{d | T} d ^ 2\\times \\mu(\\frac{T}{d})$$\n\n\u4ee4$g(x) = x * x, mu(x) = \\mu(x)$\n\n\u4e8e\u662f$F(n, m) = \\sum_{T = 1}^n \\left \\lfloor \\frac{n}{T} \\right \\rfloor \\times \\left \\lfloor \\frac{m}{T} \\right \\rfloor\\times(g(x) \\times mu(x))$\n\n\u53d1\u73b0\u540e\u9762\u90a3\u4e00\u5806\u5c31\u662f\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u800c\u4e14\u662f\u4e24\u4e2a\u79ef\u6027\u51fd\u6570\u7684\u5377\u79ef\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u7528\u7ebf\u6027\u7b5b\u7b5b\u51fa\uff0c\u7b5b\u6cd5\u89c1[\u4e8e\u795e\u4e4b\u6012\u52a0\u5f3a\u7248](https://www.luogu.org/problem/P4449)\n\n\u603b\u7ed3\u4e00\u4e0b\u6c42\u6cd5\uff1a\n\n\u6211\u4eec\u8bb0$prim[i]$\u4e3a\u7b2ci\u4e2a\u8d28\u6570\uff0c$low[i]$\u4e3ai\u8d28\u56e0\u6570\u5206\u89e3\u540e\u6700\u5c0f\u7684\u8d28\u56e0\u5b50\u7684\u6307\u6570\u6b21\u5e42\uff0c$f[x]$\u4e3a$g(x)$\u5377$mu(x)$\uff0c$mu[x]$\u4e3a$\\mu(x)$\n\n\u7c7b\u4f3c\u4e8e\u7ebf\u6027\u7b5b\uff0c\u6211\u4eec\u5206\u4e09\u79cd\u60c5\u51b5\u8ba8\u8bba\uff1a\n\n$case1:$ $i$\u662f\u8d28\u6570\n\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u7b97\u51fa\u6765\uff1a$low[i] = i,\\;\\ f[i] = i \\times i - 1,\\;\\ mu[i] = -1$\n\n$case2:i \\% prim[j] != 0$\uff1a\u8fd9\u79cd\u60c5\u51b5\u662f\u6ee1\u8db3\u79ef\u6027\u51fd\u6570\u5b9a\u4e49\u7684\uff0c\u5373$i, prim[j]$\u4e92\u8d28\uff0c\u4ee4$p = i \\times prim[j]$\uff0c\u6240\u4ee5\u6211\u4eec\u6709$low[p] = prim[j],\\;\\  mu[p] = -mu[i],\\;\\  f[i] = f[i] \\times f[prim[j]]$\n\n$case3:i \\% prim[j] == 0$\uff1a\u8fd9\u79cd\u60c5\u51b5\u4e0d\u6ee1\u8db3\u79ef\u6027\u51fd\u6570\u7684\u5b9a\u4e49\uff0c\u4e8e\u662f\u6211\u4eec\u8003\u8651\u7528\u6211\u4eec\u521a\u521a\u7ef4\u62a4\u7684$low[i]$\n\n\u8003\u8651\u5230$i / low[i],prim[j]$\u662f\u4e92\u8d28\u7684\uff0c\u90a3\u6211\u4eec\u53ef\u4e0d\u53ef\u4ee5\u7c7b\u6bd4$case2$\u901a\u8fc7$f[i / low[i]], f[prim[j]]$\u6765\u63a8\u51fa$f[p]$\u5462\uff1f\n\n\u5047\u8bbe$a, b$\u4e92\u8d28\uff0c\u6211\u4eec\u6709\uff1a$f[a \\times b] = f[a] \\times f[b]$\n\n\u6240\u4ee5\u6211\u4eec\u4e5f\u6709\uff1a$f[p] = f[i] \\times f[prim[j]] = f[i\\ /\\ low[i]] \\times f[prim[j] \\times low[i]]$\n\n\u6839\u636e\u5b9a\u4e49\uff0c$i\\ /\\ low[i]$\u6ca1\u6709$prim[j]$\u8fd9\u4e2a\u7ea6\u6570\uff0c\u6240\u4ee5$i / low[i],\\;\\ prim[j] \\times low[i]$\u4e92\u8d28\n\ni\u80af\u5b9a\u6709$prim[j]$\u8fd9\u4e2a\u8d28\u56e0\u6570\uff0c\u800c\u4e14\u6839\u636e\u7ebf\u6027\u7b5b\u7684\u6027\u8d28\uff0c$prim[j]$\u80af\u5b9a\u662fi\u7684\u6700\u5c0f\u8d28\u56e0\u6570\uff0c\u6545\u6211\u4eec\u6709$mu[p] = 0,\\;\\  low[p] = low[i] \\times prim[j]$\n\n\u5982\u679c$low[i] < i$\uff0c\u8bc1\u660e$low[i] \\times prim[j] <= i$\uff0c\u6545\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u7528$f[p] = f[i\\ /\\ low[i]] \\times f[prim[j] \\times low[i]]$\n\n\u5982\u679c$low[i] == i$\uff0c\u8bc1\u660ei\u4ee5\u524d\u80af\u5b9a\u6ca1\u6709\u88ab\u7b5b\u8fc7\uff0c\u82e5$low[i] = prim[j] ^ k$\uff0c\u5219k\u80af\u5b9a\u4e3a\u8d28\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u7528\uff1a$f[p] = (i * prim[j]) ^ 2 - i ^ 2$\n\n### $ps:$ \n\u5199\u5b8c\u540e\u770b\u9898\u89e3\u624d\u53d1\u73b0\uff1a\u8fd9\u9053\u9898\u6839\u4e8e\u795e\u4e4b\u6012\u4e0d\u4e00\u6837\uff0c\u5e76\u4e0d\u9700\u8981\u8bb0\u5f55$low[i]$\uff0c\u5bf9\u4e8e$case3$\uff0c$f[p] = f[i] \\times prim[j] ^2$\u5373\u53ef\n\n# $Code:$\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define il inline\n#define re register\nil int read() {\n    re int x = 0, f = 1; re char c = getchar();\n    while(c < '0' || c > '9') { if(c == '-') f = -1; c = getchar();}\n    while(c >= '0' && c <= '9') x = x * 10 + c - 48, c = getchar();\n    return x * f;\n}\n#define rep(i, s, t) for(re int i = s; i <= t; ++ i)\n#define mod 1000000007\n#define maxn 20000007\nil int Pow(int x) {return 1ll * x * x % mod;}\nint cnt, prim[maxn], f[maxn], mu[maxn], low[maxn];\nbool vis[maxn];\nil void init() {\n\tf[1] = mu[1] = 1;\n\trep(i, 2, 2e7) {\n\t\tif(!vis[i]) f[i] = Pow(i) - 1, mu[i] = -1, low[i] = i, prim[++ cnt] = i;\n\t\tfor(re int j = 1; j <= cnt; ++ j) {\n\t\t\tif(i * prim[j] > 2e7) break;\n\t\t\tint p = i * prim[j];\n\t\t\tvis[p] = 1;\n\t\t\tif(i % prim[j] == 0) {\n\t\t\t\tlow[p] = low[i] * prim[j];\n\t\t\t\tif(low[i] == i) f[p] = (Pow(1ll * i * prim[j] % mod) - Pow(i) + mod) % mod;\n\t\t\t\telse f[p] = 1ll * f[i / low[i]] * f[low[i] * prim[j]] % mod;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmu[p] = -mu[i], low[p] = prim[j], f[p] = 1ll * f[i] * f[prim[j]] % mod;\n\t\t}\n\t}\n\trep(i, 1, 2e7) f[i] = (f[i - 1] + f[i]) % mod;\n}\nil int F(int n, int m) {\n\tif(n > m) swap(n, m);\n\tint ans = 0;\n\tfor(re int l = 1, r; l <= n; l = r + 1) {\n\t\tr = min(n / (n / l), m / (m / l));\n\t\tans = (ans + 1ll * (1ll * (n / l) * (m / l) % mod) * (f[r] - f[l - 1]) % mod) % mod;\n\t}\n\treturn (ans + mod) % mod;\n}\nil int get(int n, int m, int p) {\n\treturn ((1ll * p * F(n, m) % mod + 1ll * n * F(p, m) % mod) % mod + 1ll * m * F(n, p)) % mod;\n}\nil void outit() {\n\tfor(re int i = 1, T = read(); i <= T; ++ i) printf(\"%d\\n\", get(read(), read(), read()));\n}\nint main() {\n\tinit(), outit();\n\treturn 0;\n}\n```",
        "postTime": 1569594500,
        "uid": 57014,
        "name": "Nemlit",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5176 \u3010\u516c\u7ea6\u6570\u3011"
    },
    {
        "content": "\u9996\u5148\u6709\u4e00\u4e2a\u7ed3\u8bba\uff1a\n\n$$gcd(i\\cdot j,i\\cdot k,j\\cdot k)=\\frac{gcd(i , j )\\cdot gcd(j , k) \\cdot gcd(i,k)}{gcd(i,j,k)}$$\n\n\u8bc1\u660e\u5982\u4e0b\uff1a\n\n\u5148\u5c06 $i,j,k$ \u7528\u552f\u4e00\u5206\u89e3\u5b9a\u7406\u5c55\u5f00\u7684\u6b21\u65b9\u5206\u522b\u4e3a $w_1,w_2,w_3$\u3002\n\n$$gcd(i \\cdot j,j \\cdot k,i \\cdot k)=\\sum_{i=1}^k {p_i}^{min(w_{1i}+w_{2i},w_{2i}+w_{3i},w_{1i}+w_{3i})}$$\n\n$$gcd(i,j) \\cdot gcd(j,k) \\cdot gcd(i,k)=\\sum_{i=1}^k {p_i}^{min(w_{1i},w_{2i})+min(w_{2i},w_{3i})+min(w_{1i},w_{3i})}$$\n\n$$gcd(i,j,k)=\\sum_{i=1}^k {p_i}^{min(w_{1i},w_{2i},w_{3i})}$$\n\n***\n\n$$gcd(i\\cdot j,i\\cdot k,j\\cdot k)=\\frac{gcd(i , j )\\cdot gcd(j , k) \\cdot gcd(i,k)}{gcd(i,j,k)}$$\n\n$$\\Leftarrow \\sum_{i=1}^k {p_i}^{min(w_{1i}+w_{2i},w_{2i}+w_{3i},w_{1i}+w_{3i})}=\\frac{\\sum_{i=1}^k {p_i}^{min(w_{1i},w_{2i})+min(w_{2i},w_{3i})+min(w_{1i},w_{3i})}}{\\sum_{i=1}^k {p_i}^{min(w_{1i},w_{2i},w_{3i})}}$$\n\n$$\\Leftarrow \\sum_{i=1}^k {min(w_{1i}+w_{2i},w_{2i}+w_{3i},w_{1i}+w_{3i})}=\\sum_{i=1}^k {min(w_{1i},w_{2i})+min(w_{2i},w_{3i})+min(w_{1i},w_{3i})-min(w_{1i},w_{2i},w_{3i})}$$\n\n\u8fd9\u662f\u4e00\u4e2a\u8f6e\u6362\u5f0f \uff0c \u4e0d\u59a8\u4ee4 $w_{1i} \\le w_{2i} \\le w_{3i}$ , \u5219\u6709\n\n$$\\Leftarrow \\sum_{i=1}^k {w_{1i}+w_{2i}}=\\sum_{i=1}^k {w_{1i}+w_{2i}+w_{1i}-w_{1i}}$$\n\n$$\\Leftarrow \\sum_{i=1}^k {w_{1i}+w_{2i}}=\\sum_{i=1}^k {w_{1i}+w_{2i}}$$\n\n\u6240\u4ee5\u539f\u7ed3\u8bba\u6210\u7acb\u3002\n\n***\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{k=1}^p\\gcd(i\\cdot j,i\\cdot k,j\\cdot k)\\times \\gcd(i,j,k)\\times \\left(\\frac{\\gcd(i,j)}{\\gcd(i,k)\\times \\gcd(j,k)}+\\frac{\\gcd(i,k)}{\\gcd(i,j)\\times \\gcd(j,k)}+\\frac{\\gcd(j,k)}{\\gcd(i,j)\\times \\gcd(i,k)}\\right)$$\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{k=1}^p\\frac{gcd(i , j )\\cdot gcd(j , k) \\cdot gcd(i,k)}{gcd(i,j,k)}\\times \\gcd(i,j,k)\\times \\left(\\frac{\\gcd(i,j)}{\\gcd(i,k)\\times \\gcd(j,k)}+\\frac{\\gcd(i,k)}{\\gcd(i,j)\\times \\gcd(j,k)}+\\frac{\\gcd(j,k)}{\\gcd(i,j)\\times \\gcd(i,k)}\\right)$$\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{k=1}^p gcd(i , j)\\cdot gcd(j , k) \\cdot gcd(i,k)\\times \\left(\\frac{\\gcd(i,j)}{\\gcd(i,k)\\times \\gcd(j,k)}+\\frac{\\gcd(i,k)}{\\gcd(i,j)\\times \\gcd(j,k)}+\\frac{\\gcd(j,k)}{\\gcd(i,j)\\times \\gcd(i,k)}\\right)$$\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{k=1}^p gcd(i , j)^2 \\cdot gcd(j , k)^2 \\cdot gcd(i,k)^2$$\n\n$$p \\times \\sum_{i=1}^n\\sum_{j=1}^m gcd(i,j)^2+n \\times \\sum_{i=1}^m\\sum_{j=1}^p gcd(i,j)^2+m \\times \\sum_{i=1}^n\\sum_{j=1}^p gcd(i,j)^2$$\n\n\u73b0\u5728\u53ea\u9700\u8981\u5904\u7406\u51fa $\\sum_{i=1}^n\\sum_{j=1}^m gcd(i,j)^2$ \uff0c\u5c31\u53ef\u4ee5\u7528\u4e09\u6b21\u53cd\u6f14\u89e3\u51b3\u3002\n\n\u4ee4 $s = min(n,m)$\uff0c\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m gcd(i,j)^2$$\n\n$$\\sum_{k=1}^{s}k^2\\sum_{i=1}^n\\sum_{j=1}^m [gcd(i,j)=k]$$\n\n$$\\sum_{k=1}^{s}k^2\\sum_{i=1}^{\\lfloor \\frac{n}{k} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{m}{k} \\rfloor} [gcd(i,j)=1]$$\n\n$$\\sum_{k=1}^{s}k^2 \\sum_{d=1}^{\\lfloor \\frac{s}{k} \\rfloor } \\mu(d) \\lfloor \\frac{n}{kd} \\rfloor  \\lfloor \\frac{m}{kd} \\rfloor$$\n\n$$\\sum_{k=1}^{s}\\sum_{d=1}^{\\lfloor \\frac{s}{k} \\rfloor } k ^2 \\mu(d) \\lfloor \\frac{n}{kd} \\rfloor  \\lfloor \\frac{m}{kd} \\rfloor$$\n\n$$\\sum_{k=1}^{s}\\sum_{kd=1}^{s} k ^2 \\mu(d) \\lfloor \\frac{n}{kd} \\rfloor  \\lfloor \\frac{m}{kd} \\rfloor$$\n\n\u4ee4 $T=kd$ ,\n\n$$\\sum_{T=1}^{s}\\sum_{k|T} k^2 \\mu(\\frac{T}{k}) \\lfloor \\frac{n}{T} \\rfloor  \\lfloor \\frac{m}{T} \\rfloor$$\n\n$$\\sum_{T=1}^{s}f(T)\\lfloor \\frac{n}{T} \\rfloor  \\lfloor \\frac{m}{T} \\rfloor$$\n\n\u5176\u4e2d $f(n)=\\sum_{k|n} k^2 \\mu(\\frac{n}{k})$ , \u7531\u5377\u79ef\u7684\u6027\u8d28\u5f97\u8be5\u51fd\u6570\u4e3a\u79ef\u6027\u51fd\u6570\uff0c\u8003\u8651\u5982\u4f55\u7528\u7ebf\u6027\u7b5b\u6c42\u51fa\u5176\u524d\u7f00\u548c\u3002\n\n\u5982\u679c $p$ \u662f\u4e00\u4e2a\u8d28\u6570\uff0c\u90a3\u4e48\u6709\uff1a\n\n$$\nf(p)=1^2 \\times \\mu(p)+p^2 \\times \\mu(1)=p^2-1\n$$\n\n$$\nf(p^k)=\\sum_{i=0}^k p^{2i} \\times \\mu(p^{k-i})\n$$\n\n\u53c8\u56e0\u4e3a\u5f53 $k-i \\ge 2$ \u65f6\uff0c$\\mu(p^{k-i})=0$\uff0c\u6240\u4ee5\u6240\u6709\u6709\u8d21\u732e\u7684 $i > k - 2$ , \u5373 $i=k$ \u6216 $i=k-1$ \u3002\n\n$$\nf(p^k)=p^{2k}-p^{2(k-1)}=(p^2-1)p^{2(k-1)}=f(p)p^{2(k-1)}\n$$\n\n\u89c2\u5bdf\u53d1\u73b0\u62ec\u53f7\u5185 $p$ \u51cf\u5c11\u4e86 $k-1$ \u6b21\u65b9\uff0c\u7cfb\u6570\u589e\u52a0 $p^{2(k-1)}$\n\n\u6240\u4ee5 $f(p^k)=f(p^{k-1}) \\times p^2$\n\n\u6574\u7406\u4e00\u4e0b\u5f97\uff1a\n\n$$f(i \\times prime[j])=\\begin{cases}\nf(i) \\times f(prime[j]) & (i,prime[j])=1 \\\\\\\\\nf(i) \\times prime[j]^2  & (i,prime[j])\\not=1\n\\end{cases}\n$$\n\n\u590d\u6742\u5ea6$\\Theta(n+t\\sqrt n)$\n\n```cpp\n#include <cstdio>\n#include <iostream>\nusing namespace std; \n#define Mod 1000000007\n\ntemplate<typename _T>\nvoid Read( _T &x ) {\n\tx = 0; int f = 1;\n\tchar s = getchar( );\n\tfor( ; s < '0' || s > '9' ; s = getchar( ) ) f = s == '-' ? -f : f;\n\tfor( ; s >= '0' && s <= '9' ; s = getchar( ) ) x = x * 10 + s - '0';\n\tx *= f;\n}\ntemplate<typename _T>\nvoid Write( _T x ) {\n\tif( x < 0 ) putchar('-') , x = -x;\n\tif( x >= 10 ) Write( x / 10 );\n\tputchar( x % 10 + '0' );\n}\n\nconst int MAXN = 20000000;\nint t , n , m , p , k , prime[ MAXN + 5 ] , f[ MAXN + 5 ];\nbool vis[ MAXN + 5 ];\n\nvoid sieve( ) {\n    f[ 1 ] = 1;\n    for( int i = 2 ; i <= MAXN ; i ++ ) {\n        if( !vis[ i ] ) {\n            prime[ ++ k ] = i;\n            f[ i ] = ( 1ll * i * i - 1 ) % Mod;\n        }\n        for( int j = 1 ; j <= k && 1ll * i * prime[ j ] <= MAXN ; j ++ ) {\n            vis[ i * prime[ j ] ] = 1;\n            if( i % prime[ j ] == 0 ) {\n                f[ i * prime[ j ] ] = 1ll * f[ i ] * prime[ j ] % Mod * prime[ j ] % Mod;\n                break;\n            }\n            f[ i * prime[ j ] ] = 1ll * f[ i ] * f[ prime[ j ] ] % Mod;\n        }\n    }\n    for( int i = 2 ; i <= MAXN ; i ++ )\n        f[ i ] = ( f[ i ] + f[ i - 1 ] ) % Mod;\n}\n\nint solve( int n , int m ) {\n    int d = min( n , m ) , Ans = 0;\n    for( int l = 1 , r ; l <= d ; l = r + 1 ) {\n        r = min( n / ( n / l ) , m / ( m / l ) );\n        Ans = ( Ans + 1ll * ( f[ r ] - f[ l - 1 ] + Mod ) % Mod * ( n / l ) % Mod * ( m / l ) % Mod ) % Mod;\n    }\n    return Ans;\n}\n\nint main( ) {\n    sieve( );\n    Read( t );\n    while( t -- ) {\n        Read( n ) , Read( m ) , Read( p );\n        int Ans = ( 1ll * n * solve( m , p ) % Mod + 1ll * m * solve( n , p ) % Mod + 1ll * p * solve( n , m ) % Mod ) % Mod;\n        Write( Ans ) , putchar('\\n');\n    }\n    return 0;\n}\n```",
        "postTime": 1578123400,
        "uid": 123802,
        "name": "chihik",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5176 \u3010\u516c\u7ea6\u6570\u3011"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.org/problemnew/show/P5176)\n\n\u8001\u5e74\u9009\u624b\u5565\u90fd\u4e0d\u60f3\u63a8\u53ea\u80fd\u641e\u4e2a\u675c\u6559\u7b5b\u4e86\n\n\u8fd9\u4e2a\u5f0f\u5b50\u957f\u5f97\u597d\u5413\u4eba\u554a\uff0c\u6240\u4ee5\u6211\u4eec\u552f\u4e00\u5206\u89e3\u4e4b\u540e\u6765\u8003\u8651\u8fd9\u9053\u9898\n\n\u8bbe$i,j,k$\u5206\u522b\u662f$p^a,p^b,p^c$\uff0c\u81f3\u4e8e\u5230\u5e95\u8c01\u662f\u8c01\u5e76\u4e0d\u91cd\u8981\uff0c\u6211\u4eec\u4e0d\u59a8\u5047\u8bbe$a\\leq b\\leq c$\n\n\u90a3\u4e48$gcd(i\\times j,j\\times k,k\\times i)=min\\{p^{a+b},p^{a+c},p^{b+c}\\}=p^{a+b}$\n\n$gcd(i,j,k)=min\\{p^a,p^b,p^c\\}=p^a$\n\n\u4e5f\u5c31\u662f\u524d\u9762\u4e24\u4e2a\u67ff\u5b50\u4e58\u8d77\u6765\u662f$p^{2a+b}$\n\n\u6211\u4eec\u628a\u540e\u9762\u7684\u67ff\u5b50\u5206\u6bcd\u901a\u5206\n\n$$\\frac{(i,j)^2+(j,k)^2+(k,i)^2}{(i,j)(j,k)(k,i)}$$\n\n\u6211\u4eec\u53d1\u73b0\u5206\u6bcd\u4e0a\u8fd8\u662f\u7b49\u4e8e$p^{2a+b}$\uff0c\u56e0\u4e3a$p^a$\u8ddf\u53e6\u5916\u4e24\u4e2a\u7ec4\u5408\u5f97\u5230\u7684$gcd$\u90fd\u662f$p^a$\uff0c$p^b$\u548c$p^{c}$\u7684$gcd$\u662f$p^b$\uff0c\u6240\u4ee5\u5206\u6bcd\u4e0a\u662f$p^{2a+b}$\n\n\u548c\u5916\u9762\u4e00\u7ea6\u5206\uff0c\u6ca1\u4e86\n\n\u663e\u7136\u552f\u4e00\u5206\u89e3\u4e4b\u540e\u5404\u4e2a\u8d28\u6570\u6b21\u5e42\u662f\u76f8\u4e92\u72ec\u7acb\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u5f97\u51fa\u7ed3\u8bba\uff0c\u6211\u4eec\u8981\u6c42\u7684\u5c31\u662f\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{k=1}^p(i,j)^2+(j,k)^2+(k,i)^2$$\n\n\u663e\u7136\u53ef\u4ee5\u62c6\u6210\n\n$$p\\times \\sum_{i=1}^n\\sum_{j=1}^m(i,j)^2+n\\times \\sum_{j=1}^m\\sum_{k=1}^p(j,k)^2+m\\times \\sum_{i=1}^n\\sum_{k=1}^p(k,i)^2$$\n\n\u5957\u8def\u53cd\u6f14\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u6211\u4eec\u8981\u6c42\u7684\u4e1c\u897f\u5b9e\u9645\u4e0a\u662f\n\n$$\\sum_{i=1}^n\\left \\lfloor \\frac{n}{i} \\right \\rfloor\\left \\lfloor \\frac{m}{i} \\right \\rfloor\\sum_{d|i}\\mu(\\frac{i}{d})d^2$$\n\n\u540e\u9762\u7684\u4e1c\u897f\u7ebf\u7b5b\u4e5f\u5f88\u597d\u63a8\uff0c\u4f46\u662f\u8001\u5e74\u9009\u624b\u5e76\u4e0d\u60f3\u52a8\u8111\u5b50\u4e86\n\n\u53d1\u73b0\u540e\u9762\u7684\u67ff\u5b50\u662f$id^2\\times \\mu$\uff0c\u6211\u4eec\u76f4\u63a5\u675c\u6559\u7b5b\u5377\u4e0a$1$\u5c31\u53d8\u6210$id^2$\u4e86\uff0c$id^2$\u7684\u524d\u7f00\u548c\u81ea\u7136\u662f$\\frac{n(n+1)(2n+1)}{6}$\u4e86\n\n\u8fd9\u6837\u662f$O(n^{\\frac{3}{4}})$\u7684\uff0c\u4f46\u662f\u6211\u4eec\u66b4\u529b\u8c03\u5408\u7ea7\u6570\u5904\u7406\u4e00\u4e9b\uff0c\u5c31\u80fd\u8dd1\u7684\u5f88\u5feb\u4e86\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\n#define re register\n#define LL long long\n#define max(a,b) ((a)>(b)?(a):(b))\n#define min(a,b) ((a)<(b)?(a):(b))\ninline int read() {\n\tchar c=getchar();int x=0;while(c<'0'||c>'9') c=getchar();\n\twhile(c>='0'&&c<='9') x=(x<<3)+(x<<1)+c-48,c=getchar();return x;\n}\nint T;\nconst int I6=166666668;\nconst int mod=1e9+7;\nconst int maxn=1e6+1;\nint p[maxn>>1],is[maxn],mu[maxn];\nint f[20000005],vis[20000005];\ninline int calc(int x) {return 1ll*x*(x+1)%mod*(x+x+1)%mod*I6%mod;}\ninline int solve(int x) {\n\tif(vis[x]) return f[x];\n\tvis[x]=1;int ans=calc(x);\n\tfor(re int l=2,r;l<=x;l=r+1) {\n\t\tr=x/(x/l);\n\t\tans=(ans-1ll*solve(x/l)*(r-l+1)%mod+mod)%mod;\n\t}\n\treturn f[x]=ans;\n}\ninline int work(int n,int m) {\n\tif(n>m) std::swap(n,m);\n\tint ans=0;\n\tfor(re int l=1,r;l<=n;l=r+1) {\n\t\tr=min(n/(n/l),m/(m/l));\n\t\tans=(ans+1ll*(n/l)*(m/l)%mod*(solve(r)-solve(l-1)+mod)%mod)%mod;\n\t}\n\treturn ans;\n}\nint main() {\n\tT=read();is[1]=mu[1]=1;\n\tfor(re int i=2;i<maxn;i++) {\n\t\tif(!is[i]) p[++p[0]]=i,mu[i]=-1;\n\t\tfor(re int j=1;j<=p[0]&&p[j]*i<maxn;j++) {\n\t\t\tis[p[j]*i]=1;if(i%p[j]==0) break;mu[p[j]*i]=-1*mu[i];\n\t\t}\n\t}\n\tfor(re int i=1;i<maxn;i++)\n\t\tfor(re int j=i;j<maxn;j+=i) {\n\t\t\tif(!mu[j/i]) continue;\n\t\t\tif(mu[j/i]<0) f[j]=(f[j]-1ll*i*i%mod+mod)%mod;\n\t\t\t\telse f[j]=(f[j]+1ll*i*i)%mod;\n\t\t}\n\tfor(re int i=1;i<maxn;i++)\n\t\tvis[i]=1,f[i]=(f[i]+f[i-1])%mod;\n\twhile(T--) {\n\t\tint n=read(),m=read(),p=read();\n\t\tint tmp=1ll*work(n,m)*p%mod+1ll*work(m,p)*n%mod;tmp%=mod;\n\t\ttmp=(tmp+1ll*work(n,p)*m%mod)%mod;\n\t\tprintf(\"%d\\n\",tmp%mod);\n\t}\n}\n```\n",
        "postTime": 1556327148,
        "uid": 35178,
        "name": "asuldb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3  \u3010LGP5176\u3011\u516c\u7ea6\u6570"
    },
    {
        "content": "\u5e7f\u544a,\u63a8\u8350\u6211\u7684[$\\large{\\text{\u6570\u8bba\u4e13\u9898}}$](https://www.luogu.org/blog/command-block/shuo-lun-zhuan-ti)!\n\n\u9898\u610f\uff1a\u6c42$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\sum\\limits_{k=1}^pgcd(ij,jk,ik)*gcd(i,j,k)*(\\dfrac{gcd(i,j)}{gcd(i,k)gcd(j,k)}+\\dfrac{gcd(i,k)}{gcd(i,j)gcd(j,k)}+\\dfrac{gcd(j,k)}{gcd(i,j)gcd(i,k)})$\n\n\u5bf9\u5927\u8d28\u6570\u53d6\u6a21\uff0c\u5176\u4e2d$n,m,q<=2*10^7$\n\n\u9898\u9762\u90fd\u8fd9\u4e48\u6bd2\u7624\uff0c\u8fd9\u9053\u9898\u4e00\u5b9a\u5f88\u96be\u2026\u2026\n\n\u5148\u5316\u4e00\u4e0b\u5f0f\u5b50\u5427\u3002\n\n$gcd(ij,jk,ik)*gcd(i,j,k)*(\\dfrac{gcd(i,j)}{gcd(i,k)gcd(j,k)}+\\dfrac{gcd(i,k)}{gcd(i,j)gcd(j,k)}+\\dfrac{gcd(j,k)}{gcd(i,j)gcd(i,k)})$\n\n$gcd(ij,jk,ik)$\u8fd9\u4e2a\u4e1c\u897f\u771f\u6700\u9ebb\u70e6\uff0c\u60f3\u529e\u6cd5\u628a\u5b83\u62c6\u5f00\u3002\n\n\u8003\u8651\u6211\u4eec\u628a$i,j,k$\u90fd\u5206\u89e3\u4e86\uff0c\u5f62\u5f0f\u4e3a$\\large{p_1^{ci_1}p_2^{ci_2}...p_m^{ci_m}}$\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u53ea\u8ba8\u8bba$i,j,k$\u90fd\u53ea\u6709\u540c\u4e00\u4e2a\u8d28\u56e0\u5b50$p$\u7684\u60c5\u51b5\uff0c\u800c\u5176\u53ef\u4ee5\u7b80\u5355\u7684\u6269\u5c55\u5230\u6574\u6570\u57df\u3002\n\n\u90a3\u4e48\uff1a\n\n$\\large{ij=p^{ci+cj}}$\n\n$\\large{ik=p^{ci+ck}}$\n\n$\\large{jk=p^{cj+ck}}$\n\n$\\large{gcd(i,j)=p^{min(ci,cj)}}$\n\n$\\large{gcd(i,k)=p^{min(ci,ck)}}$\n\n$\\large{gcd(j,k)=p^{min(cj,ck)}}$\n\n$\\large{gcd(i,j,k)=p^{min(ci,cj,ck)}}$\n\n$\\large{gcd(ij,ik,jk)=p^{min(cj+ck,ci+ck,ci+cj)}}$\n\n\u5f88\u660e\u663e\uff0c$min(cj+ck,ci+ck,ci+cj)=ci,cj,ck$\u4e2d\u6700\u5c0f\u7684\u4e24\u4e2a\u7684\u548c\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u7528$gcd(i,j)gcd(i,k)gcd(j,k)$\u6765\u51d1\uff0c\u5176\u4e3a:\n\n$\\large{p^{min(ci,cj)+min(ci,ck)+min(cj,ck)}}$\n\n\u800c\u7ecf\u8fc7\u624b\u73a9\uff0c\u6211\u4eec\u5f97\u5230$min(ci,cj)+min(ci,ck)+min(cj,ck)$\u5c31\u662f\u6700\u5c0f\u7684*2+\u6b21\u5c0f\u7684\u3002\n\n\u6211\u4eec\u9700\u8981\u51cf\u6389\u6700\u5c0f\u7684\u5c31\u53ef\u4ee5\u51d1\u597d\u4e86\uff01\n\n\u5373\u5728\u6307\u6570\u4e0a\u51cf\u53bb$min(ci,cj,ck)$,\u4e5f\u5c31\u662f\u9664\u4ee5$gcd(i,j,k)$\n\n\u603b\u7684\u6765\u8bf4\u5c31\u662f\uff1a\u6839\u636e$min(ci,cj)+min(ci,ck)+min(cj,ck)-min(ci,cj,ck)=min(cj+ck,ci+ck,ci+cj)$\n\n\u6211\u4eec\u5f97\u5230$gcd(ij,ik,jk)=\\dfrac{gcd(i,j)gcd(i,k)gcd(j,k)}{gcd(i,j,k)}$\n\n\u628a\u8fd9\u4e2a\u5f0f\u5b50\u56de\u5e26\u5230\u9898\u9762\u4e2d\uff0c\u5f97\u5230\uff1a\n\n$gcd(ij,jk,ik)*gcd(i,j,k)*(\\dfrac{gcd(i,j)}{gcd(i,k)gcd(j,k)}+\\dfrac{gcd(i,k)}{gcd(i,j)gcd(j,k)}+\\dfrac{gcd(j,k)}{gcd(i,j)gcd(i,k)})$\n\n$=\\dfrac{gcd(i,j)gcd(i,k)gcd(j,k)}{gcd(i,j,k)}*gcd(i,j,k)*(\\dfrac{gcd(i,j)}{gcd(i,k)gcd(j,k)}+\\dfrac{gcd(i,k)}{gcd(i,j)gcd(j,k)}+\\dfrac{gcd(j,k)}{gcd(i,j)gcd(i,k)})$\n\n$=gcd(i,j)gcd(i,k)gcd(j,k)*(\\dfrac{gcd(i,j)}{gcd(i,k)gcd(j,k)}+\\dfrac{gcd(i,k)}{gcd(i,j)gcd(j,k)}+\\dfrac{gcd(j,k)}{gcd(i,j)gcd(i,k)})$\n\n$=gcd(i,j)^2+gcd(i,k)^2+gcd(j,k)^2$\n\n\u5f0f\u5b50\u4e00\u4e0b\u5b50\u53d8\u5f97\u975e\u5e38\u7b80\u6d01\uff0c~~\u8fd9\u548cP4240\u6bd2\u7624\u8003\u9a8c\u90a3\u9898\u76f8\u6bd4\u771f\u662f\u592a\u53cb\u597d\u4e86~~\uff0c\u9887\u6709\u4e9b\u6708\u6d4b\u4ee3\u6570\u6700\u540e\u4e00\u95ee\u7684\u98ce\u8303\u2026\u2026\n\n\u6211\u4eec\u628a\u5408\u5f0f\u5199\u4e0a\uff1a\n\n$ANS=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\sum\\limits_{k=1}^pgcd(i,j)^2+gcd(i,k)^2+gcd(j,k)^2$\n\n$=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\sum\\limits_{k=1}^pgcd(i,j)^2+\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\sum\\limits_{k=1}^pgcd(i,k)^2+\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\sum\\limits_{k=1}^pgcd(j,k)^2$\n\n\u660e\u663e\u7684\uff0c\u6211\u4eec\u53ea\u8981\u628a\u7b2c\u4e00\u90e8\u5206\u6c42\u51fa\u6765\uff0c\u5176\u4ed6\u7684\u90e8\u5206\u4e5f\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\u6765\u6c42\u3002\n\n\u90a3\u5c31\u5269\u4e0b\u4e86$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\sum\\limits_{k=1}^pgcd(i,j)^2$\n\n$=p\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^mgcd(i,j)^2$\n\n\u8fd9\u5c31\u5f88\u6c34\u4e86\u2026\u2026\u4e0d\u5c31\u662fP4449\u4e8e\u795e\u4e4b\u6012\u5f31\u5316\u7248\u561b\u2026\u2026\n\n\u679a\u4e3egcd\uff1a\n\n$=\\sum\\limits_{d=1}^m\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^md^2[(i,j)==d]$\n\n\u5957\u8def\uff0c\u540e\u65b9\u540c\u9664d\u3002\n\n$=\\sum\\limits_{d=1}^md^2\\sum\\limits_{i=1}^{n/d}\\sum\\limits_{j=1}^{m/d}[(i,j)==1]$\n\n\u540e\u9762\u662f\u5957\u8def\uff0c\u4f46\u662f\u8fd8\u662f\u5199\u4e0b\u5b8c\u6574\u8fc7\u7a0b\u5427\u2026\u2026\n\n\u8bbe$f(n,m,x)=\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{m}[(i,j)==x]$\n\n$F(n,m,x)=\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{m}[x|(i,j)]$\n\n\u5f88\u660e\u663e$F(n,m,x)=\\sum\\limits_{k=1}^\u221ef(kn,m,kx)$\n\n\u6839\u636e\u53cd\u6f14\u5b9a\u7406\u53ef\u5f97$f(n,m,x)=\\sum\\limits_{k}^\u221e\\mu(k)F(n,m,kx)$\n\n\u6211\u4eec\u8981\u6c42$f(n,m,1)$,\u6839\u636e\u4e0a\u5f0f\u5f97$f(n,m,1)=\\sum\\limits_{k}^\u221e\\mu(k)F(n,m,k)$\n\n$F(n,m,k)=\\sum\\limits_{i=1}^{n}\\sum\\limits_{j=1}^{m}[x|(i,j)]$\n\n$=\\sum\\limits_{i=1}^{n/x}\\sum\\limits_{j=1}^{m/x}[1|(i,j)]$\n\n$=\\lfloor n/x\\rfloor\\lfloor m/x\\rfloor$\n\n\u56de\u4ee3\u53ef\u5f97$f(n,m,1)=\\sum\\limits_{k}^\u221e\\mu(k)\\lfloor n/k\\rfloor\\lfloor m/k\\rfloor$\n\n\u518d\u6b21\u56de\u4ee3\u53ef\u5f97$ANS=\\sum\\limits_{d=1}^md^2f(n/d,m/d,1)=\\sum\\limits_{d=1}^md^2\\sum\\limits_{k}^{m/d}\\mu(k)\\lfloor n/dk\\rfloor\\lfloor m/dk\\rfloor$\n\n\u6b64\u65f6\uff0c\u5df2\u7ecf\u53ef\u4ee5\u6574\u9664\u5206\u5757\u5957\u6574\u9664\u5206\u5757\u5b9e\u73b0\u5355\u7ec4$O(n^{\\frac{3}{4}})$(\u5e38\u6570\u6781\u5927)\u3002\n\n\u6211\u4eec\u6539\u5199\u6c42\u548c\u53d8\u91cf\uff0c\u4ee4$T=dk$\n\n\u5f97\u5230$ANS=\\sum\\limits_{T=1}^m\\lfloor n/T\\rfloor\\lfloor m/T\\rfloor\\sum\\limits_{d|T}d^2\\mu(T/d)$\n\n\u90a3\u4e48\u6211\u4eec\u8bbe$F(T)=\\sum\\limits_{d|T}d^2\\mu(T/d)$\u53ea\u8981\u628a\u8fd9\u4e2a\u51fd\u6570\u7684\u524d\u7f00\u548c\u641e\u51fa\u6765\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6574\u9664\u5206\u5757$O(\\sqrt{n})$\u4e86\u3002\n\n\u89c2\u5bdf\u53ef\u5f97$F=id^2*\\mu$\u7531\u4e8e\u5176\u662f\u4e24\u4e2a\u79ef\u6027\u51fd\u6570\u7684\u5377\u79ef\uff0c\u5176\u672c\u8eab\u4e5f\u662f\u4e2a\u79ef\u6027\u51fd\u6570\u3002\n\n$F(1)=1$\n\n$F(p)=\\sum\\limits_{d|p}d^2\\mu(p/d)=1^2\\mu(p)+p^2\\mu(1)=p^2-1$\n\n$F(p^k)=\\sum\\limits_{d|p^k}d^2\\mu(p/d)=1^2\\mu(p^k)+p^2\\mu(p^{k-1})+...+p^{2(k-1)}\\mu(p)+p^{2k}\\mu(1)$\n\n\u7531\u4e8e\u5927\u90e8\u5206$\\mu$\u90fd\u662f0\uff0c\u5f97\u5230\uff1a\n\n$=p^{2(k-1)}\\mu(p)+p^{2k}\\mu(1)=p^{2k}-p^{2(k-1)}=(p^2-1)p^{2(k-1)}=F(p)p^{2(k-1)}$\n\n\u7531$F(p^k)=F(p)p^{2(k-1)}$\u5f97\u5230$F(p^k)=F(p^{k-1})*p^2$\n\n\u6240\u6709\u6027\u8d28\u90fd\u5168\u4e86\uff0c\u76f4\u63a5\u7ebf\u6027\u7b5b\u5373\u53ef\u3002\n\n~~\u8fd9\u9898\u6709\u675c\u6559\u7b5b\u677f\u672c\u5417\uff1f~~\n\n\u4ee3\u7801\u4ec5\u4f9b\u53c2\u8003\uff1a\n\n```cpp\n#include<algorithm>\n#include<cstdio>\n#define MaxN 20005000\n#define mod 1000000007\nusing namespace std;\nint T,N,M,P,Limit;\nbool e[MaxN+500];\nint tn,p[MaxN+500],p2[MaxN+500];\nlong long F[MaxN+500];\nvoid getsth()\n{\n  e[1]=1;F[1]=1;\n  for (int i=2,t;i<=Limit;i++){\n    if (!e[i]){\n      p[++tn]=i;\n      p2[tn]=1ll*i*i%mod;\n      F[i]=p2[tn]-1;\n    }\n    for (int j=1;j<=tn&&(t=p[j]*i)<=Limit;j++){\n      F[t]=(F[i]*(i%p[j]==0 ? p2[j] : F[p[j]]))%mod;\n      e[t]=1;\n      if (i%p[j]==0)break;\n    }\n  }for (int i=1;i<=Limit;i++){\n  \t F[i]+=F[i-1];\n  \t if (F[i]>=mod)F[i]-=mod;\n  }\n}\nlong long calc(int N,int M)\n{\n  int l=1,r;\n  long long ans=0;\n  for (;l<=min(N,M);l=r+1){\n  \tr=min(N/(N/l),M/(M/l));\n    ans=(ans+1ll*(N/l)*(M/l)%mod*(F[r]-F[l-1]))%mod;\n  }return ans;\n}\nint main()\n{\n  scanf(\"%d\",&T);\n  Limit=T>100 ? 20000000 : 5000000;\n  getsth();\n  while(T--){\n  \tscanf(\"%d%d%d\",&N,&M,&P);\n  \tlong long ans=0;\n  \tans=1ll*N*calc(M,P)+1ll*M*calc(N,P)+1ll*P*calc(N,M);\n  \tprintf(\"%lld\\n\",(ans%mod+mod)%mod);\n  }return 0;\n}\n```\n\n~~\u4e3a\u4e86\u6700\u4f18\u89e3\u677e\u4e86\u534a\u5929\uff0c\u7ec8\u4e8e\u5230\u624b~~",
        "postTime": 1555035404,
        "uid": 58705,
        "name": "command_block",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5176 \u3010\u516c\u7ea6\u6570\u3011"
    },
    {
        "content": "#### \u601d\u8003\u96be\u5ea6\uff1a\u63d0\u9ad8?\n#### \u4ee3\u7801\u96be\u5ea6\uff1a\u7701\u9009-?\n\n\u7b97\u6cd51\uff1a\u66b4\u529b\u8ba1\u7b97\n\n\u5b9e\u9645\u5f97\u5206\uff1a10\n\n\u7b97\u6cd52\uff1a\n\n\u9996\u5148$\\gcd(i\\cdot j,i\\cdot k,j\\cdot k)=\\frac{\\gcd(i,j)\\times \\gcd(i,k)\\times \\gcd(j,k)}{\\gcd(i,j,k)}$\n\n\u6240\u4ee5\u539f\u5f0f$=\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{k=1}^p(\\gcd^2(i,j)+\\gcd^2(i,k)+gcd^2(j,k))$\n\n\u8003\u8651\u4e00\u4e2a\u5f0f\u5b50$\\sum_{i=1}^n\\sum_{j=1}^m\\gcd^2(i,j)=\\sum_{d=1}^{\\min(n,m)}\\sum_{x|d}d^2\\mu\\left(\\frac{x}{d}\\right)$\n\n\u8003\u8651\u5bf9\u540e\u9762\u7684$\\sum$\u5206\u5757\u8ba1\u7b97\uff0c$O(n+T\\cdot n\\sqrt{n})$\n\n\u5b9e\u9645\u5f97\u5206\uff1a30\n\n\u7b97\u6cd53\uff1a\n\n\u53d1\u73b0\u524d\u9762\u7684$\\sum$\u4e5f\u53ef\u4ee5\u5206\u5757\uff0c$O(n+T\\cdot n)$\n\n\u5b9e\u9645\u5f97\u5206\uff1a50\n\n\u7b97\u6cd54\uff1a\n\n\u8003\u8651\u4ee4$f(x)=x^2,g(x)=\\mu\\left({x}\\right)$\uff0c\u8ba1\u7b97\u8fd9\u4e24\u4e2a\u51fd\u6570\u7684**\u72c4\u5229\u514b\u96f7\u5377\u79ef$h(x)$**\uff0c\u518d\u5bf9$h(x)$\u5206\u5757\u8ba1\u7b97\uff0c$O(n+T\\cdot \\sqrt{n})$\n\n\u5b9e\u9645\u5f97\u5206\uff1a100\n\n\u7b97\u6cd55(\u53ef\u80fd\u65f6\u95f4\u590d\u6742\u5ea6\u6709\u70b9bug\uff09\uff1a\n\n\u675c\u6559\u7b5b\u4e00\u4e0b\uff0c\u628a\u9884\u5904\u7406\u590d\u6742\u5ea6\u7531$O(n)$\u964d\u4f4e\u4e3a$O(n^{\\frac{2}{3}})$\uff0c~~\u6211\u592a\u61d2\u4e86\u6ca1\u6709\u5b66\u675c\u6559\u7b5b~~\n\n\u5b9e\u9645\u5f97\u5206\uff1a100\n\n# code:\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<iostream>\nusing namespace std;\ntypedef long long LL;\nconst LL N=2e7+50;\nconst LL mod=1e9+7;\nLL t,x,y,z,ans;\nLL f[N],df[N];\nint pri[N],vis[N],cnt;\ninline void pr(int x){printf(\"%d \",x);}\ninline void prll(LL x){printf(\"%lld \",x);}\n#define en putchar('\\n')\n#define kg putchar(' ')\nvoid pre(LL n){\n    f[1]=df[1]=1;\n    for(int i=2;i<=n;++i){\n        if(!vis[i]){pri[++cnt]=i;df[i]=(1ll*i*i-1)%mod;}\n        for(int j=1;j<=cnt&&i*pri[j]<=n;++j){\n            vis[i*pri[j]]=1;\n            if(i%pri[j])df[i*pri[j]]=df[i]*df[pri[j]]%mod;\n            else {df[i*pri[j]]=df[i]*pri[j]%mod*pri[j]%mod;break;}\n        }\n        f[i]=(f[i-1]+df[i])%mod;\n    }\n}\nLL work(LL n,LL m){\n    LL res=0,rr=0;\n    for(LL d=1;d<=n;d=rr+1){\n    \trr=min(n/(n/d),m/(m/d));\n    \tres=(res+(n/d)*(m/d)%mod*(f[rr]-f[d-1]))%mod;\n    }\n    return res;\n}\nint main(){\n    pre(N-50);\n    for(scanf(\"%lld\",&t);t;--t){\n        scanf(\"%lld%lld%lld\",&x,&y,&z);\n        ans=1ll*work(min(x,y),max(x,y))*z%mod;\n        ans=ans+1ll*work(min(x,z),max(x,z))*y%mod;\n        ans=ans+1ll*work(min(y,z),max(y,z))*x%mod;\n        printf(\"%lld\\n\",(ans+3*mod)%mod);\n    }\n}\n```",
        "postTime": 1546601250,
        "uid": 45475,
        "name": "ShineEternal",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5176 \u3010\u516c\u7ea6\u6570\u3011"
    },
    {
        "content": "\u672c\u6587\u516c\u5f0f\u6e32\u67d3\u8f83\u591a\uff0c\u5982\u679c\u7206\u70b8\u53ef\u4ee5\u53bb\u535a\u5ba2\u83b7\u5f97\u66f4\u597d\u4f53\u9a8c\u3002[\u6233\u6211](https://www.luogu.com.cn/blog/blog10086001/solution-p5176)\u3002\n\n\u5f0f\u5b50\u5f88\u957f\uff0c\u8ba9\u4eba\u611f\u5230\u65e0\u4ece\u4e0b\u624b\u3002\u5b9e\u9645\u4e0a\u539f\u9898\u7684\u5f0f\u5b50\u5c31\u662f\u4e0b\u9762\u7684\u5f0f\u5b50\uff1a\n\n$$\\displaystyle \\sum_{i=1}^n \\sum_{j=1}^m \\sum_{k=1}^p \\gcd(i,j)^2 + \\gcd(i,k)^2 + \\gcd(j,k)^2 $$\n\n\u8fd9\u4e2a\u7ed3\u8bba\u53ef\u4ee5\u901a\u8fc7\u552f\u4e00\u5206\u89e3\u5b9a\u7406\u5c55\u5f00\u5f97\u5230\u3002\u5173\u952e\u662f\u8fd9\u4e2a\u5f0f\u5b50\u600e\u4e48\u6c42\u3002\n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u957f\u5f0f\u5b50\u53ef\u4ee5\u62c6\u6210\u4e09\u4e2a\u5c0f\u5f0f\u5b50\uff0c\u56e0\u4e3a $\\gcd(i,j)$ \u4e0e $k$\uff0c$\\gcd(i,k)$ \u4e0e $j$\uff0c$\\gcd(j,k)$ \u4e0e $i$ \u90fd\u65e0\u5173\u3002\u4e8e\u662f\u539f\u5f0f\u53ef\u4ee5\u5316\u4e3a\uff1a\n\n$$\\displaystyle p\\times \\sum_{i=1}^n  \\sum_{j=1}^m \\gcd(i,j)^2 + m\\times \\sum_{i=1}^n \\sum_{j=1}^p \\gcd(i,j)^2 + n \\times \\sum_{i=1}^m \\sum_{j=1}^p \\gcd(i,j)^2$$\n\n\u6682\u65f6\u4e0d\u7ba1\u7cfb\u6570\u3002\u6211\u4eec\u53d1\u73b0\u8fd9\u4e09\u4e2a\u5c0f\u5f0f\u5b50\u662f\u7c7b\u4f3c\u7684\u3002\u4e8e\u662f\u6211\u4eec\u8003\u8651\u8ba1\u7b97 $\\displaystyle \\sum_{i=1}^n \\sum_{j=1}^m \\gcd(i,j)^2$\u3002\n\n\u6211\u4eec\u94a6\u5b9a $n<m$\uff0c\u63a5\u4e0b\u6765\u5c31\u5316\u5f0f\u5b50\u5427\u3002\n\n\u679a\u4e3e $\\gcd(i,j)$\uff1a\n\n$$\\displaystyle \\sum_{d=1}^n \\sum_{i=1}^n \\sum_{j=1}^m [\\gcd(i,j)=d] \\times d^2$$\n\n\u5c06 $d^2$ \u63d0\u524d\uff0c\u5e76\u4e14\u4fee\u6539\u4e0a\u754c\u53ca $[\\ ]$ \u91cc\u7684\u5185\u5bb9\uff1a\n\n$$\\displaystyle \\sum_{d=1}^{n} d^2\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor} \\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor}[\\gcd(i,j)=1]$$\n\n\u5df2\u7ecf\u51fa\u73b0\u4e86 $[\\gcd(i,j)=1]$ \u4e86\u3002\u5957\u7528\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u5957\u8def\uff1a\n\n$$\\displaystyle \\sum_{d=1}^n d^2 \\sum_{D=1}^{{\\lfloor \\frac{n}{d} \\rfloor}}\\mu(D) \\lfloor \\dfrac{n}{dD}\\rfloor \\lfloor \\dfrac{m}{dD}\\rfloor$$\n\n$dD$ \u770b\u8d77\u6765\u592a\u9ebb\u70e6\uff0c\u4ee4 $dD=T$ \u5e76\u8fdb\u884c\u679a\u4e3e\u3002\n\n$$\\displaystyle \\sum_{d=1}^n \\sum_{T=1}^n d^2\\mu(T) \\lfloor \\dfrac{n}{T}\\rfloor \\lfloor \\dfrac{m}{T}\\rfloor$$\n\n$$\\displaystyle \\sum_{T=1}^n \\sum_{k|T}k^2\\mu(\\dfrac{T}{k}) \\lfloor \\dfrac{n}{T}\\rfloor \\lfloor \\dfrac{m}{T}\\rfloor$$\n\n\u4ee4 $f(T) =\\sum_{k|T}k^2 \\mu(\\dfrac{T}{k})$\u3002\n\n$$\\displaystyle \\sum_{T=1}^n f(T) \\lfloor \\dfrac{n}{T}\\rfloor \\lfloor \\dfrac{m}{T}\\rfloor$$\n\n\u6211\u4eec\u53d1\u73b0 $f(x)$ \u662f\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\u3002\u53ef\u4ee5\u7ebf\u6027\u7b5b\u51fa\u5904\u7406\u3002\u5269\u4e0b\u7684\u90e8\u5206\u6574\u9664\u5206\u5757\u5373\u53ef\u3002\n\n---\n\n### \u5bf9\u4e8e $f(x)$ \u7684\u5904\u7406\n\n\u5982\u679c $x$ \u4e3a\u8d28\u6570\uff0c\u6b64\u65f6 $x$ \u552f\u6709 $1,x$ \u4e24\u4e2a\u56e0\u5b50\uff0c$\\displaystyle f(x)=x^2\\times \\mu(\\dfrac{x}{x}=1)+1^2 \\times \\mu(\\dfrac{x}{1}=x)=x^2-1$\u3002\n\n\u5426\u5219\uff0c\u5728\u7ebf\u6027\u7b5b\u4e2d\u5904\u7406 $f(i \\times \\operatorname{prime}_j)$\uff1a\n\n$$f(i \\times \\operatorname{prime}_j)=\n\\begin{cases}\nf(i) \\times {\\operatorname{prime}_j}^2 \\ \\ \\ \\ \\ \\operatorname{prime}_j|i\\\\\\\\\nf(i) \\times f(\\operatorname{prime}_j)\\ \\operatorname{otherwise}\n\\end{cases}$$\n\n---\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef __int128 LL;\nchar buf[1<<21],*p1=buf,*p2=buf;\n#define getchar() (p1==p2 && (p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\nLL read()\n{\n    LL x=0,f=1;\n    char c=getchar();\n    while(c<'0' || c>'9')\n    {\n        if(c=='-')  f=-1;\n        c=getchar();\n    }\n    while(c>='0' && c<='9') x=(x<<1)+(x<<3)+(c^'0'),c=getchar();\n    return x*f;\n}\nvoid write(LL x)\n{\n    if(x<0) putchar('-'),x=-x;\n    if(x>9) write(x/10);\n    putchar(x%10+'0');\n}\nconst LL MOD=1000000007;\nLL f[20000005];\nint prime[20000005],mu[20000005],cnt;\nbool vis[20000005];\nvoid shai(LL up)\n{\n\tf[1]=1;\n\tfor(LL i=2;i<=up;++i)\n\t{\n\t\tif(!vis[i])\tprime[++cnt]=i,mu[i]=-1,f[i]=i*i%MOD-1;\n\t\tfor(LL j=1;j<=cnt && prime[j]*i<=up;++j)\n\t\t{\n\t\t\tvis[i*prime[j]]=true;\n\t\t\tif(i%prime[j])\tf[i*prime[j]]=f[i]*f[prime[j]]%MOD;\n\t\t\telse\n\t\t\t{\n\t\t\t\tf[i*prime[j]]=f[i]*prime[j]%MOD*prime[j]%MOD;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tfor(LL i=2;i<=up;++i)\tf[i]+=f[i-1],f[i]%=MOD;\n}\nLL calc(LL n,LL m)\n{\n\tif(n>m)\tn^=m^=n^=m;\n\tLL ans=0;\n\tfor(LL l=1,r;l<=n;l=r+1)\n\t{\n\t\tr=min(n/(n/l),m/(m/l));\n\t\tans+=(f[r]-f[l-1]+MOD)*(n/l)%MOD*(m/l)%MOD;\n\t\tans%=MOD;\n\t}\n\treturn ans%MOD;\n}\nint main(){\n\tLL T=read();\n\tshai(20000003);\n\twhile(T-->0) \n\t{\n\t\tLL n=read(),m=read(),p=read();\n\t\tLL ans=((n*calc(m,p)%MOD+m*calc(n,p)%MOD)%MOD+p*calc(n,m)%MOD)%MOD;\n\t\twrite(ans);\n\t\tputs(\"\");\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1596100978,
        "uid": 184977,
        "name": "pomelo_nene",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5176 \u3010\u516c\u7ea6\u6570\u3011"
    },
    {
        "content": "[luogu P5176 \u516c\u7ea6\u6570](https://www.luogu.com.cn/problem/P5176)\n\n~~\u770b\u4e86\u5c31\u4e0d\u60f3\u505a\u7cfb\u5217~~\n\n\u5148\u901a\u5206\uff1a\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{m}\\sum_{k=1}^{p}\\gcd(ij,ik,jk)\\gcd(i,j,k)\\frac{\\gcd^2(i,j)+\\gcd^2(i,k)+\\gcd^2(j,k)}{\\gcd(i,j)\\gcd(i,k)\\gcd(j,k)}$$\n\n\u770b\u5206\u6bcd\u5f88\u4e0d\u723d\uff0c\u8003\u8651\u5982\u4f55\u7ea6\u53bb\u3002\n\n\u6211\u4eec\u6709\u516c\u5f0f\uff1a\n\n$$\\gcd(ij,ik,jk)=\\frac{\\gcd(i,j)\\gcd(i,k)\\gcd(j,k)}{\\gcd(i,j,k)}$$\n\n\u8bc1\u660e\uff1a\u5bf9\u4e8e\u4e00\u4e2a\u8d28\u6570 $p$\uff0c\u8bbe $i$ \u5206\u89e3\u8d28\u56e0\u6570\u540e\u6709 $a$ \u4e2a $p$\uff0c$j$ \u6709 $b$ \u4e2a\uff0c$k$ \u6709 $c$ \u4e2a\u3002\u4e0d\u59a8\u4ee4 $a \\leqslant b \\leqslant c$\uff0c\u5219 $\\gcd(i,j)$ \u5206\u89e3\u8d28\u56e0\u6570\u540e\u6709 $\\min(a,b)$ \u4e2a $p$\uff0c\u5176\u4f59\u540c\u7406\u3002\u6700\u540e\u53d1\u73b0\u5de6\u5f0f\u4e3a $a+b$\uff0c\u53f3\u5f0f\u4e3a $a+a+b-a$\uff0c\u4e24\u5f0f\u76f8\u7b49\uff0c\u5f97\u8bc1\u3002\n\n\u4e4b\u540e\u5316\u7b80\u4e3a\uff1a\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{m}\\sum_{k=1}^{p} \\operatorname{gcd^2} (i,j)+\\operatorname{gcd^2}(i,k)+\\operatorname{gcd^2}(j,k)$$\n\n\u6613\u5f97\uff1a\n\n$$\\left(p\\sum_{i=1}^{n}\\sum_{j=1}^{m}\\operatorname{gcd^2} (i,j))+(m\\sum_{i=1}^{n}\\sum_{k=1}^{p} \\operatorname{gcd^2}(i,k)\\right)+\\left(\\sum_{j=1}^{m}\\sum_{k=1}^{p}\\operatorname{gcd^2}(j,k)\\right)$$\n\n\u4e4b\u540e\u628a\n\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{m}\\operatorname{gcd^2} (i,j)$$\n\n\u7b97\u51fa\u5c31 ok \u4e86\uff0c\u5341\u5206\u5957\u8def\u3002\n$$\\sum_{k=1}^{n}k^2\\sum_{i=1}^{n/k}\\sum_{j=1}^{m/k}[\\gcd(i,j)=1]$$\n$$\\sum_{k=1}^{n}k^2\\sum_{i=1}^{n/k}\\sum_{j=1}^{m/k}\\sum_{d|i,d|j}\\mu(d)$$\n$$\\sum_{k=1}^{n}k^2\\sum_{d=1}^{n}\\mu(d)\\left\\lfloor\\frac{n}{kd}\\right\\rfloor\\left\\lfloor\\frac{m}{kd}\\right\\rfloor$$\n\n\u4ee4 $T=kd$\uff0c\u5f97\n\n$$\\sum_{T=1}^{n}\\left\\lfloor\\frac{n}{T}\\right\\rfloor\\left\\lfloor\\frac{m}{T}\\right\\rfloor\\sum_{k|T}k^2\\mu\\left(\\frac{T}{k}\\right)$$\n\n\u540e\u9762\u7684\u90e8\u5206\u7ebf\u6027\u7b5b\uff0c\u6bcf\u6b21\u8be2\u95ee\u6574\u9664\u5206\u5757\u5373\u53ef\u3002\n\n```cpp\n#include <iostream>\nconst int MAXN = 20000000, lnMAXN = 14, MOD = 1e9 + 7;\nint Prime[MAXN/lnMAXN + 5], size;\nbool not_prime[MAXN + 5];\nint f[MAXN + 5];\n\ninline int pm(int x)\n{ return x < 0 ? x + MOD : x; }\n\ninline int mm(int x)\n{ return x >= MOD ? x - MOD : x; }\n\ninline int Min(int x, int y)\n{ return x < y ? x : y; }\n\nvoid sieve(int n) { //\u9884\u5904\u7406 \n\tnot_prime[1] = true;\n\tf[1] = 1;\n\t//\u8fb9\u754c \n\tfor(int i = 2; i <= n; ++i) {\n\t\tif(not_prime[i] == false) {\n\t\t\tPrime[size++] = i; //\u52a0\u5165\u8d28\u6570\u8868 \n\t\t\tf[i] = 1LL*i*i%MOD - 1;\n\t\t}\n\t\tfor(int j = 0; j < size && i*Prime[j] <= n; ++j) {\n\t\t\tnot_prime[i*Prime[j]] = true;\n\t\t\tif(i%Prime[j] == 0) {\n\t\t\t\tf[i*Prime[j]] = 1LL*f[i]*Prime[j]%MOD*Prime[j]%MOD;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tf[i*Prime[j]] = 1LL*f[i]*f[Prime[j]]%MOD;\n\t\t}\n\t}\n\tfor(int i = 2; i <= n; ++i)\n\t\tf[i] = mm(f[i - 1] + f[i]); //\u5904\u7406\u524d\u7f00\u548c \n}\n\nint solve(int n, int m) { //\u6574\u9664\u5206\u5757 \n\tif(n > m) //\u522b\u5fd8\u4e86swap \n\t\tstd::swap(n, m);\n\tint res = 0;\n\tfor(int i = 1, ni; i <= n; i = ni + 1) {\n\t\tni = Min(n/(n/i), m/(m/i));\n\t\tres = mm(res + 1LL*(n/i)*(m/i)%MOD*pm(f[ni] - f[i - 1])%MOD);\n\t}\n\treturn res;\n}\n\nint main() {\n\tstd::ios_base::sync_with_stdio(false);\n\tstd::cin.tie(0), std::cout.tie(0);\n\tsieve(MAXN);\n\tint t;\n\tstd::cin >> t;\n\twhile(t--) {\n\t\tint n, m, p, ans;\n\t\tstd::cin >> n >> m >> p;\n\t\tans = (1LL*n*solve(m, p)%MOD + 1LL*m*solve(n, p)%MOD + 1LL*p*solve(n, m)%MOD)%MOD;\n\t\tstd::cout << ans << \"\\n\";\n\t}\n\treturn 0;\n} \n```",
        "postTime": 1592449702,
        "uid": 225734,
        "name": "derta",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P5176 \u3010\u516c\u7ea6\u6570\u3011"
    },
    {
        "content": "\u633a\u6709\u610f\u601d\u7684\u4e00\u4e2a\u9898\u3002\n\n\u6ce8\u610f\u5230$\\gcd$\u7684\u4e00\u4e2a\u6027\u8d28\uff0c\u6211\u4eec\u53ea\u8003\u8651\u4e00\u4e2a\u8d28\u56e0\u5b50\uff0c\u8bbe$i=p^x,j=p^y,k=p^z$\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n$$\n\\gcd(i,j)=p^{\\min(x,y)},\\gcd(i,j,k)=p^{\\min(x,y,z)}\n$$\n\u90a3\u4e48\u6839\u636e\u8fd9\u4e2a\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u7740\u5316\u7b80\u9898\u76ee\u7ed9\u51fa\u7684\u5f0f\u5b50\uff0c\u901a\u5206\u4e4b\u540e\u628a\u5206\u6bcd\u63d0\u51fa\u6765\uff0c\u548c\u524d\u9762\u4e24\u9879\u4e58\u8d77\u6765\u5c31\u662f\uff1a\n$$\nres=\\dfrac{\\gcd(i,j,k)\\times \\gcd(i\\cdot j,j\\cdot k,k\\cdot i)}{\\gcd(i,j)\\times\\gcd(j,k)\\times\\gcd(i,k)}\n$$\n\u7531\u4e8e\u8fd9\u91cc\u53ea\u8003\u8651\u4e00\u4e2a\u8d28\u56e0\u5b50\uff0c\u6211\u4eec\u53ef\u4ee5\u4e24\u8fb9\u53d6$\\log$\uff0c\u7136\u540e\u8bbe$\\min(x,y,z)=x$\uff0c\u5373$x$\u4e3a\u6700\u5c0f\u503c\uff0c\u8fd9\u5bf9\u7b54\u6848\u662f\u6ca1\u6709\u5f71\u54cd\u7684\uff0c\u90a3\u4e48\u5f0f\u5b50\u53ef\u4ee5\u53d8\u6210\u8fd9\u6837\uff1a\n$$\n\\log_p(res)=2x+\\min(y,y+z-x,z)-(2x+\\min(y,z))\n$$\n\u53ef\u4ee5\u53d1\u73b0$y+z-x\\geqslant y,y+z-x\\geqslant z$\uff0c\u6240\u4ee5\u53ef\u4ee5\u5f97\u5230\uff1a\n$$\n\\log_p(res)=2x+\\min(y,z)-(2x+\\min(y,z))\n$$\n\u6240\u4ee5\uff1a\n\n$$\n\\log_p(res)=0,res=1\n$$\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u60ca\u5947\u7684\u53d1\u73b0\uff0c\u524d\u9762\u4e24\u9879\u548c\u5206\u6bcd\u7ea6\u6389\u4e86\uff0c\u5269\u4e0b\u7684\u5f0f\u5b50\u5199\u51fa\u6765\u5c31\u662f\uff1a\n\n$$ans=\\sum_{i}\\sum_{j}\\sum_{k}\\gcd(i,j)^2+\\gcd(j,k)^2+\\gcd(i,k)^2$$\n\n\u8fd9\u4e2a\u76f4\u63a5\u5927\u529b\u53cd\u6f14\u5c31\u597d\u4e86\u3002\n\n```c++\n#include<bits/stdc++.h>\nusing namespace std;\n \nvoid read(int &x) {\n    x=0;int f=1;char ch=getchar();\n    for(;!isdigit(ch);ch=getchar()) if(ch=='-') f=-f;\n    for(;isdigit(ch);ch=getchar()) x=x*10+ch-'0';x*=f;\n}\n \nvoid print(int x) {\n    if(x<0) putchar('-'),x=-x;\n    if(!x) return ;print(x/10),putchar(x%10+48);\n}\nvoid write(int x) {if(!x) putchar('0');else print(x);putchar('\\n');}\n\nconst int maxn = 2e7+10;\nconst int mod = 1e9+7;\n\nint pri[maxn/10],mu[maxn],f[maxn],vis[maxn],tot;\n\nvoid sieve() {\n\tmu[1]=f[1]=1;\n\tfor(int i=2;i<maxn;i++) {\n\t\tif(!vis[i]) pri[++tot]=i,mu[i]=-1,f[i]=1ll*i*i%mod-1;\n\t\tfor(int v,j=1;j<=tot&&i*pri[j]<maxn;j++) {\n\t\t\tvis[v=i*pri[j]]=1;\n\t\t\tif(i%pri[j]==0) {f[v]=1ll*f[i]*pri[j]%mod*pri[j]%mod;break;}\n\t\t\tf[v]=1ll*f[i]*f[pri[j]]%mod,mu[v]=-mu[i];\n\t\t}\n\t}\n\tfor(int i=1;i<maxn;i++) f[i]=(f[i]+f[i-1])%mod;\n}\n\nint calc(int n,int m) {\n\tint T=1,res=0;\n\twhile(T<=min(n,m)) {\n\t\tint pre=T;T=min(n/(n/T),m/(m/T));\n\t\tres=(res+1ll*(f[T]-f[pre-1])*(n/T)%mod*(m/T)%mod)%mod;T++;\n\t}return (res+mod)%mod;\n}\n\nint main() {\n\tsieve();\n\tint T,n,m,p;read(T);\n\twhile(T--) read(n),read(m),read(p),write(((1ll*calc(n,m)*p%mod+1ll*calc(n,p)*m%mod)%mod+1ll*calc(m,p)*n%mod)%mod);\n\treturn 0;\n}\n```",
        "postTime": 1552308833,
        "uid": 50777,
        "name": "Hyscere",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5176 \u3010\u516c\u7ea6\u6570\u3011"
    },
    {
        "content": "\u9996\u5148\uff0c\u8003\u8651\u5982\u4f55\u7b80\u5316 $\\gcd(ij,ik,jk)\\gcd(i,j,k)$\u3002\n\n\u5047\u8bbe\u8d28\u6570 $p$ \u5728 $i,j,k$ \u91cc\u9762\u7684\u8d28\u56e0\u6570\u5206\u89e3\u6b21\u5e42\u5206\u522b\u662f $a,b,c$\u3002\u4e0d\u59a8\u8bbe $0\\le i\\le j\\le k$\u3002\u90a3\u4e48\uff0c$p$ \u5728 $\\gcd(ij,ik,jk)\\gcd(i,j,k)$ \u7684\u6b21\u5e42\u7b49\u4e8e\u5b83\u5728 $\\gcd(ij,ik,jk)$ \u91cc\u9762\u7684\u6b21\u5e42\u52a0\u4e0a\u5b83\u5728 $\\gcd(i,j,k)$ \u7684\u6b21\u5e42\u3002\n\n\u6839\u636e $\\gcd$ \u6027\u8d28\uff0c$\\gcd(ij,ik,jk)$ \u91cc\u6b21\u5e42\u662f $\\min(a+b,a+c,b+c)=a+b$\uff0c\u5728 $\\gcd(i,j,k)$ \u91cc\u6b21\u5e42\u662f $\\min(a,b,c)=a$\uff0c\u603b\u5171\u662f $2a+b$\u3002\n\n\u6ce8\u610f\u5230\u8fd9\u4e2a\u7528\u4e86\u6700\u5c0f\u6b21\u5e42 $a$ \u4e24\u6b21\uff0c\u6b21\u5c0f\u6b21\u5e42 $b$ \u4e00\u6b21\uff0c\u6700\u5927\u6b21\u5e42 $c$ \u96f6\u6b21\uff0c\u8fd9\u4e2a\u7b49\u4ef7\u4e8e\u6240\u6709 $\\{i,j,k\\}$ \u5f62\u6210\u7684\u5bf9\u91cc\u9762\u6b21\u5e42\u6700\u5c0f\u7684\u6b21\u5e42\uff0c\u6216\u8005 $\\gcd(i,j)\\gcd(i,k)\\gcd(j,k)$\u3002\n\n\u63a8\u5f0f\u5b50\u3002\n\n$$\\gcd(ij,ik,jk)\\gcd(i,j,k)(\\frac{\\gcd(i,j)}{\\gcd(i,k)\\gcd(j,k)}+\\frac{\\gcd(i,k)}{\\gcd(i,j)\\gcd(j,k)}+\\frac{\\gcd(j,k)}{\\gcd(i,j)\\gcd(i,k)})=$$\n$$\\gcd(i,j)\\gcd(i,k)\\gcd(j,k)(\\frac{\\gcd(i,j)}{\\gcd(i,k)\\gcd(j,k)}+\\frac{\\gcd(i,k)}{\\gcd(i,j)\\gcd(j,k)}+\\frac{\\gcd(j,k)}{\\gcd(i,j)\\gcd(i,k)})=$$\n$$\\gcd(i,j)^2+\\gcd(i,k)^2+\\gcd(j,k)^2$$\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{k=1}^p\\gcd(i,j)^2+\\gcd(i,k)^2+\\gcd(j,k)^2=$$\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{k=1}^p\\gcd(i,j)^2+\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{k=1}^p\\gcd(i,k)^2+\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{k=1}^p\\gcd(j,k)^2$$\n\u6ce8\u610f\u5230\u5728\u7b2c\u4e00\u4e2a\u548c\u91cc\u9762 $k$ \u6ca1\u6709\u4efb\u4f55\u8d21\u732e\uff0c\u5728\u7b2c\u4e8c\u4e2a\u91cc\u9762 $j$ \u6ca1\u6709\u4efb\u4f55\u8d21\u732e\uff0c\u5728\u7b2c\u4e09\u4e2a\u91cc\u9762 $i$ \u6ca1\u6709\u4efb\u4f55\u8d21\u732e\uff0c\u6240\u4ee5\u53ef\u4ee5\u628a\u6240\u6709\u548c\u91cc\u9762\u7684\u4e00\u4e2a $\\sum$ \u53bb\u6389\u3002\n$$p\\sum_{i=1}^n\\sum_{j=1}^m\\gcd(i,j)^2+m\\sum_{i=1}^n\\sum_{k=1}^p\\gcd(i,k)^2+n\\sum_{j=1}^m\\sum_{k=1}^p\\gcd(j,k)^2$$\n\n\u5230\u8fd9\u91cc\u5c31\u53ef\u4ee5\u76f4\u63a5\u642c\u8fd0 P4449 \u4ee3\u7801\u4e86\u3002\n\n```cpp\n// writer: w33z8kqrqk8zzzx33\n#include <bits/stdc++.h>\nusing namespace std;\n\n// begin fast read template by CYJian (source: https://www.luogu.com.cn/paste/i11c3ppx)\n\nnamespace io {\n\tconst int __SIZE = (1 << 21) + 1;\n\tchar ibuf[__SIZE], *iS, *iT, obuf[__SIZE], *oS = obuf, *oT = oS + __SIZE - 1, __c, qu[55]; int __f, qr, _eof;\n\t#define Gc() (iS == iT ? (iT = (iS = ibuf) + fread (ibuf, 1, __SIZE, stdin), (iS == iT ? EOF : *iS ++)) : *iS ++)\n\tinline void flush () { fwrite (obuf, 1, oS - obuf, stdout), oS = obuf; }\n\tinline void gc (char &x) { x = Gc(); }\n\tinline void pc (char x) { *oS ++ = x; if (oS == oT) flush (); }\n\tinline void pstr (const char *s) { int __len = strlen(s); for (__f = 0; __f < __len; ++__f) pc (s[__f]); }\n\tinline void gstr (char *s) { for(__c = Gc(); __c < 32 || __c > 126 || __c == ' ';)  __c = Gc();\n\t\tfor(; __c > 31 && __c < 127 && __c != ' '; ++s, __c = Gc()) *s = __c; *s = 0; }\n\ttemplate <class I> inline bool gi (I &x) { _eof = 0;\n\t\tfor (__f = 1, __c = Gc(); (__c < '0' || __c > '9') && !_eof; __c = Gc()) { if (__c == '-') __f = -1; _eof |= __c == EOF; }\n\t\tfor (x = 0; __c <= '9' && __c >= '0' && !_eof; __c = Gc()) x = x * 10 + (__c & 15), _eof |= __c == EOF; x *= __f; return !_eof; }\n\ttemplate <class I> inline void print (I x) { if (!x) pc ('0'); if (x < 0) pc ('-'), x = -x;\n\t\twhile (x) qu[++ qr] = x % 10 + '0',  x /= 10; while (qr) pc (qu[qr --]); }\n\tstruct Flusher_ {~Flusher_(){flush();}}io_flusher_;\n} using io::pc; using io::gc; using io::pstr; using io::gstr; using io::gi; using io::print;\n\n// end fast read template by CYJian\n\n#define iter(i, a, b) for(int i=(a); i<(b); i++)\n#define rep(i, a) iter(i, 0, a)\n#define rep1(i, a) iter(i, 1, (a)+1)\n#define log(a) cerr<<\"\\033[32m[DEBUG] \"<<#a<<'='<<(a)<<\" @ line \"<<__LINE__<<\"\\033[0m\"<<endl\n#define all(a) a.begin(), a.end()\n#define fi first\n#define se second\n#define pb push_back\n#define mp make_pair\n \nusing ll=long long;\nusing pii=pair<int, int>;\n//#define int ll\nconst int MOD = 1000000007;\n\nint qpow(const int&b, const int&e) {\n\tif(!e) return 1;\n\tif(!(e&1)) return qpow(1ll*b*b%MOD,e>>1);\n\treturn 1ll*b*qpow(b,e-1)%MOD;\n}\nint pp[20000006];\n\nint K = 2;\n\nint primes[1600000]; int cnt;\nint bs[20000006], tot[20000006];\nll g[20000006];\nvoid sve(int n) {\n\tg[1] = 1;\n\titer(i, 2, n+1) {\n\t\tif(!bs[i]) {\n\t\t\tprimes[cnt++] = i;\n\t\t\tbs[i] = tot[i] = i;\n\t\t\tg[i] = pp[i] + MOD - 1;\n\t\t\tif(g[i] >= MOD) g[i] -= MOD;\n\t\t}\n\t\tfor(int j=0; j<cnt && i*primes[j]<=n; j++) {\n\t\t\tint v = i*primes[j];\n\t\t\tif(i%primes[j]) {\n\t\t\t\tbs[v] = tot[v] = primes[j];\n\t\t\t\tg[v] = 1ll*g[i]*g[primes[j]]%MOD;\n\t\t\t} else {\n\t\t\t\tbs[v] = primes[j];\n\t\t\t\ttot[v] = tot[i]*primes[j];\n\t\t\t\tg[v] = 1ll*g[v/tot[v]]*(pp[tot[v]]-pp[tot[i]]+MOD)%MOD;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n\nint solve(ll n, ll m) {\n\tint s = min(n, m), r, ans = 0;\n\tfor(int l=1; l<=s; l=r+1) {\n\t\tr = min(n/(n/l), m/(m/l));\n\t\tint t = g[r] - g[l-1] + MOD;\n\t\tans = (ans + t * (n/l) % MOD * (m/l)) % MOD;\n\t}\n\treturn ans;\n}\n\nsigned main() {\n    ios_base::sync_with_stdio(false); cin.tie(0);\n\tint T; gi(T);\n\trep1(i, 20000000) pp[i] = 1ll * i * i % MOD;\n\tsve(20000000);\n\trep1(i, 20000000) {\n\t\tg[i] += g[i-1];\n\t\tif(g[i] >= MOD) g[i] -= MOD;\n\t}\n\twhile(T--) {\n\t\tll n, m, p; gi(n), gi(m), gi(p);\n\t\tll ans = n * solve(m, p) + m * solve(n, p) + p * solve(n, m);\n\t\tprint(ans % MOD); pc('\\n');\n\t}\n}\n\n```",
        "postTime": 1596080824,
        "uid": 220037,
        "name": "w33z8kqrqk8zzzx33",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5176 \u3010\u516c\u7ea6\u6570\u3011"
    }
]
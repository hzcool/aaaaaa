[
    {
        "content": "\u663e\u7136\u662f SG \u51fd\u6570\u9898\u3002\n\n\u5982\u679c\u4e0d\u4f1a SG \u51fd\u6570\u53ef\u4ee5\u5b66\u4e00\u4e0b\uff0c\u63a8\u9500[\u6211\u7684\u535a\u5ba2](https://59388.blog.luogu.org/game-theory-1)\u3002\n\n\u9898\u5916\u8bdd\uff1a\u672c\u6765\u60f3\u76f4\u63a5\u51fa\u5148\u624b\u662f\u5426\u5fc5\u80dc\u7684\uff0c\u540e\u6765\u61d2\u5f97\u6784\u9020\u540e\u624b\u5fc5\u80dc\u6570\u636e\u5c31\u6574\u6210\u73b0\u5728\u8fd9\u6837\u811a\u9020\u6570\u636e\u90fd\u9a97\u4e0d\u5230\u5206\u7684\u95ee\u6cd5\uff08\n\n\u6709\u4e00\u8bf4\u4e00\uff0c\u8fd9\u9898\u7684 SG \u51fd\u6570\u8fd8\u662f\u5f88\u597d\u6c42\u7684\uff0c\u4e0d\u7528\u627e\u4ec0\u4e48\u89c4\u5f8b\uff0c\u8bc1\u660e\u66f4\u662f\u975e\u5e38\u7b80\u5355\u3002\n\n\u56de\u5230\u9898\u89e3\u3002\n\n\u9996\u5148\u6211\u4eec\u8003\u8651\u4e00\u4e32\u6570\u5217 $(a_1,a_2,\\dots,a_n,0)$ \u7684 SG \u503c\u3002\n\n\u663e\u7136 $(0)$ \u7684 SG \u503c\u4e3a $0$\u3002\u73b0\u5728\u8003\u8651 $(a_2,\\dots,a_n,0)$ \u7684 SG \u503c\u5df2\u77e5\u4e14\u4e3a $t$\u3002\n\n\u663e\u7136 $(a_1,a_2,\\dots,a_n,0)$ \u7684\u540e\u7ee7\u72b6\u6001\u6709 $(a_1-1,a_2,\\dots,a_n,0),(a_1-2,a_2,\\dots,a_n,0),\\dots,(a_2,\\dots,a_n,0)$\u3002\u7531\u6b64\u53ef\u4ee5\u53d1\u73b0 $(a_1,a_2,\\dots,a_n,0)$ \u7684 SG \u51fd\u6570\u503c\u5728 $a_1 \\le t$ \u65f6\u4e3a $a_1-1$\uff0c\u5728 $a_1 > t$ \u65f6\u4e3a $a_1$\u3002\n\n\u518d\u770b\u539f\u9898\u4e2d $x$ \u7684 SG \u51fd\u6570\u3002\u663e\u7136 $t_1=\\lfloor\\sigma x\\rfloor\\ge\\lfloor\\sigma(x-t_1)\\rfloor=t_2$\uff0c\u6240\u4ee5\u53ea\u6709 $t_1=t_2$ \u4e14 $x-\\lfloor\\sigma x\\rfloor$ \u7684 SG \u51fd\u6570\u503c\u4e3a $t_2$ \u65f6 $x$ \u7684 SG \u51fd\u6570\u503c\u624d\u4e3a $t_1-1$\uff0c\u5176\u4f59\u60c5\u51b5\u5747\u4e3a $t_1$\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5 $O(1)$ \u6c42\u51fa $x$ \u7684 SG \u503c\u4e86\u3002\n\n\u663e\u7136\u6709 $x$ \u53ca\u5176\u540e\u7ee7\u72b6\u6001 SG \u503c\u53d6\u904d $0,1,\\dots,\\lfloor\\sigma x\\rfloor$ \u4e14\u4e92\u4e0d\u91cd\u590d\u3002\u56e0\u6b64\u53ea\u8981\u5bf9\u4e8e\u6700\u7ec8\u6574\u4e2a\u6e38\u620f\u7684 SG \u503c $ans$ \u6ee1\u8db3 $\\operatorname{SG}(x) \\operatorname{xor} ans \\le \\lfloor\\sigma x\\rfloor$ \u5219\u5c06\u7b54\u6848\u52a0\u4e0a $\\dfrac{1}{n\\lfloor\\sigma x\\rfloor}$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log{n})$\u3002\n\nCode:\n```cpp\n#include<cstdio>\n#define rg register\n#define LL __int128\n#define ll unsigned long long\n#define _tau(x) ((ll)((id<4)?(x*tau[id]):((x*q-1)/p)))\n#define _sigma(x) ((ll)((id<4)?(x*sigma[id]):(x*p/q)))\nconst ll ntf=20190816170251;\ninline char rc()\n{\n\tstatic char buf[1048576],*pn=buf,*pe=buf;\n\treturn (pn==pe)&&(pe=(pn=buf)+fread(buf,1,1048576,stdin),pn==pe)?EOF:*pn++;\n}\ninline int read()\n{\n\tint x=0;\n\tchar cc=rc();\n\twhile(cc<'0'||cc>'9')cc=rc();\n\twhile(cc>='0'&&cc<='9')x=x*10+cc-'0',cc=rc();\n\treturn x;\n}\ninline ll _read()\n{\n\tll x=0;\n\tchar cc=rc();\n\twhile(cc<'0'||cc>'9')cc=rc();\n\twhile(cc>='0'&&cc<='9')x=x*10+cc-'0',cc=rc();\n\treturn x;\n}\nvoid print(LL x)\n{\n\tif(x>9)print(x/10);\n\tputchar(x%10^48);\n}\nint id,n,m;\nll s[300007],d,p,q,r,SG[300007];\ndouble tau[7]={0,1.242640687119285,1.8301270189222,1.61803398874989};\ndouble sigma[7]={0,0.8047378541243,0.5464101615137,0.61803398874989};\ninline ll _gcd(ll a,ll b)\n{\n\twhile(b^=a^=b^=a%=b);\n\treturn a;\n}\ninline ll sg(ll x)\n{\n\tll t=_sigma(x);\n\tif(!t)return 0;\n\treturn t-(((x-_tau(t)-1)/t)&1);\n}\nLL exgcd(LL a,LL b,LL &x,LL &y)\n{\n\tif(!b)\n\t{\n\t\tx=1,y=0;\n\t\treturn a;\n\t}\n\tLL d=exgcd(b,a%b,y,x);\n\ty-=a/b*x;return d;\n}\ninline LL _inv(LL a)\n{\n\tLL d,x,y;\n\td=exgcd(ntf,a,x,y);\n\treturn (y%ntf+ntf)%ntf;\n}\nint main()\n{\n\tid=rc()^48,n=read();\n\tfor(rg int i=1;i<=n;++i)s[i]=_read();\n\t(id>=4)&&(p=_read(),q=_read(),d=_gcd(p,q),p/=d,q/=d);d=r=m=0;\n\tfor(rg int i=1;i<=n;++i)SG[i]=sg(s[i]),d^=SG[i];\n\tfor(rg int i=1;i<=n;++i)(_sigma(s[i])==0)?(++m):(((SG[i]^d)<=_sigma(s[i]))&&(r+=_inv(_sigma(s[i])),(r>=ntf)&&(r-=ntf)));\n\tprint((d)?r*_inv(n-m)%ntf:0);\n\treturn 0;\n}\n```",
        "postTime": 1616478565,
        "uid": 59388,
        "name": "VinstaG173",
        "ccfLevel": 7,
        "title": "F1 \u84b2\u516c\u82f1\u7684\u7ea6\u5b9a\uff08vol.1\uff09 \u9898\u89e3"
    }
]
[
    {
        "content": "~~\u76f4\u63a5\u6a21\u62df\u5373\u53ef\u3002~~\n\n### \u5206\u6790\n\u6211\u4eec\u6ce8\u610f\u5230\u8fd9\u6837\u4e00\u4ef6\u4e8b\u60c5\uff0c\u5bf9\u4e8e\u4e00\u5f20\u7f51\u683c\u56fe\u6765\u8bf4\uff0c\u786e\u5b9a\u4e24\u4e2a\u90bb\u89d2\u5230\u6bcf\u4e2a\u70b9\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u5c31\u53ef\u4ee5\u786e\u5b9a\u6574\u5f20\u56fe\u7684\u7ed3\u6784\u3002\n\n\u89c4\u5b9a\u7f51\u683c\u56fe\u89c4\u6a21\u4e3a $l \\times c$ \uff0c $(i,j)$ \u4ee3\u8868\u7b2c $i$ \u884c\u7b2c $j$ \u5217\u3002\n\n\u4f8b\u5982\uff0c\u8bbe\u56fe\u7684\u5de6\u4e0a\u89d2\u4e3a $a$ \uff0c\u5de6\u4e0b\u89d2\u4e3a $b$ \uff0c\u5219\u5bf9\u4e8e\u70b9 $p$ \u6765\u8bf4\uff0c\u5f88\u663e\u7136\u6709\n\n$$p : (\\frac{1}{2}(dis(a,p) - dis(b,p) + dis(a,b) + 2),\\frac{1}{2}(dis(a,p) + dis(b,p) - dis(a,b) + 2))$$\n\n\u6211\u4eec\u6784\u9020\u4e24\u6761\u8def\u5f84\uff1a\n\n1.\u4ece\u5de6\u4e0a\u89d2 $a$ \u4e00\u76f4\u5411\u4e0b\u8d70\uff0c\u81f3 $p$ \u70b9\u6240\u5728\u884c\uff0c\u518d\u5411\u53f3\u8d70\uff0c\u81f3 $p$ \u70b9\u6240\u5728\u5217\u3002\n\n2.\u4ece\u53f3\u4e0b\u89d2 $b$ \u4e00\u76f4\u5411\u4e0a\u8d70\uff0c\u81f3 $p$ \u70b9\u6240\u5728\u884c\uff0c\u518d\u5411\u53f3\u8d70\uff0c\u81f3 $p$ \u70b9\u6240\u5728\u5217\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u4e24\u6761\u8def\u5f84\u7684\u957f\u5ea6\u5206\u522b\u4e3a $dis(a,p),dis(b,p)$ \u3002\n\n\u9996\u5148\uff0c\u65e0\u8bba $p$ \u70b9\u7684\u5750\u6807\u5728\u54ea\u4e2a\u4f4d\u7f6e\uff0c\u4e24\u6761\u8def\u5f84\u5fc5\u7136\u6070\u597d\u8986\u76d6\u5168\u4e86\u4e00\u6574\u5217\uff0c\u5e76\u4e14\u4ece\u7b2c\u4e00\u5217\u81f3 $p$ \u6240\u5728\u5217\u8d70\u4e86\u4e24\u6b21\uff0c\u8fdb\u800c\u53ef\u6c42\u5f97 $p$ \u70b9\u7684 $y$ \u5750\u6807\uff0c\u53c8\u7531\u4e8e $p$ \u70b9\u5230 $a,b$ \u7684\u8ddd\u79bb\u786e\u5b9a\uff0c\u76f8\u51cf\u5c31\u80fd\u5f97\u51fa $x$ \u5750\u6807\u3002\n\n\u73b0\u5728\u95ee\u9898\u5c31\u8f6c\u5316\u6210\u4e86\u5728 $3$ \u6b21\u8be2\u95ee\u5185\u627e\u51fa\u7f51\u683c\u56fe\u7684\u4e24\u4e2a\u90bb\u89d2\u3002\n\n\u6211\u4eec\u5148\u8be2\u95ee $1$ \u53f7\u70b9\uff0c\u8fd9\u65f6\u5019\uff0c\u8ddd\u79bb $1$ \u53f7\u70b9\u6700\u8fdc\u7684\u70b9\u4e00\u5b9a\u5728\u89d2\u4e0a\uff0c\u53ef\u4ee5\u91c7\u7528\u53cd\u8bc1\u6cd5\uff0c\u82e5\u5176\u4e0d\u662f\u4e00\u4e2a\u89d2\uff0c\u5219\u53ef\u7ee7\u7eed\u5411\u8fdc\u79bb $1$ \u7684\u4f4d\u7f6e\u627e\u70b9\uff0c\u627e\u5230\u7684\u89d2\u5fc5\u7136\u66f4\u8fdc\u3002\u8fd9\u65f6\u5019\uff0c\u6211\u4eec\u77e5\u9053\u4e86\u4e00\u4e2a\u89d2\uff0c\u8be2\u95ee\u8fd9\u4e2a\u89d2\uff0c\u4fbf\u4e00\u5b9a\u80fd\u627e\u51fa\u8fd9\u4e2a\u89d2\u7684\u5bf9\u89d2\uff08\u8ddd\u79bb\u5176\u6700\u8fdc\u7684\u70b9\uff09\u3002\u94a6\u5b9a\u627e\u5230\u7684\u89d2\u4e3a $x$ \uff0c\u5bf9\u89d2\u4e3a $y$ \uff0c\u5219\u6709 $l + c = dis(x,y) - 2$ \uff0c\u53c8\u5df2\u77e5 $l \\times c = n$ \uff0c\u5219\u80fd\u786e\u5b9a\u51fa $l,c$ \u3002\n\n\u5e76\u4e14\uff0c\u6211\u4eec\u786e\u5b9a\u4e86 $l,c$ \uff0c\u53ea\u9700\u8981\u77e5\u9053\u4e00\u4e2a\u70b9\u548c $x$ \u7684\u8ddd\u79bb\uff0c\u5c31\u80fd\u786e\u5b9a\u5176\u4e0e $y$ \u7684\u8ddd\u79bb\u3002\n\n\u73b0\u5728\uff0c\u6211\u4eec\u6839\u636e\u5df2\u77e5\u6761\u4ef6\uff0c\u6c42\u51fa\u70b9 $1$ \u7684\u5750\u6807\u3002\n\n\u8bbe\uff1a\n$$sum_1 = \\sum_{i = 1}^{ n } { [dis(x,i) + dis(1,i) = dis(x,1)] }$$\n$$sum_2 = \\sum_{i = 1}^{ n } { [dis(y,i) + dis(1,i) = dis(y,1)] }$$\n\n\u4e0d\u59a8\u8bbe $x$ \u4e3a\u5de6\u4e0a\u89d2\uff0c $y$ \u4e3a\u53f3\u4e0b\u89d2\u3002\n\n\u6211\u4eec\u89c2\u5bdf\u5230\uff0c\u6ee1\u8db3 $sum_1$ \u6c42\u548c\u53f7\u5185\u6761\u4ef6\u7684\u70b9\u5fc5\u7136\u5728\u4ee5\u5de6\u4e0a\u89d2\u4e3a $x$ \uff0c\u53f3\u4e0b\u89d2\u4e3a $1$ \u7684\u77e9\u5f62\u4e2d\uff0c\u6ee1\u8db3 $sum_2$ \u6c42\u548c\u53f7\u5185\u6761\u4ef6\u7684\u70b9\u5fc5\u7136\u5728\u4ee5 $1$ \u4e3a\u5de6\u4e0a\u89d2\uff0c $y$ \u4e3a\u53f3\u4e0b\u89d2\u7684\u77e9\u5f62\u4e2d\u3002\u4e5f\u5c31\u610f\u5473\u7740\uff0c\u8bbe\u70b9 $1$ \u7684\u5750\u6807\u4e3a $(i,j)$ \uff0c\u5219 $sum_1 = i \\times j,sum_2 = (r - i + 1) \\times (c - j + 1)$ \uff0c\u53c8\u7531\u4e8e\u6211\u4eec\u77e5\u9053 $1$ \u4e0e\u5de6\u4e0a\u89d2\u7684\u8ddd\u79bb\uff0c\u4fbf\u53ef\u4ee5\u6c42\u5f97\u5750\u6807\u3002\n\n\u4e0d\u59a8\u8bbe $l \\leq c$ \uff0c\u6211\u4eec\u4ece\u7f51\u683c\u56fe\u7684\u5de6\u4e0a\u5411\u53f3\u4e0b\u753b\u4e00\u6761\u7ebf\uff0c\u6ce8\u610f\u5230\uff0c\u5f53 $1$ \u5728\u7ebf\u7684\u4e0b\u4fa7\u65f6\uff0c\u53f3\u4e0a\u89d2\u6bd4\u5de6\u4e0b\u89d2\u8ddd\u79bb\u66f4\u8fdc\u3002\u6240\u6709\u8ddd\u79bb $x$ \u4e3a $c - 1$ \u7684\u70b9\u5fc5\u7136\u5728\u4ece\u53f3\u4e0a\u89d2\u5f00\u59cb\uff0c\u5750\u6807\u6bcf\u6b21\u53d8\u5316 $(1,-1)$ \u5f97\u5230\u7684\uff0c\u90a3\u4e48\uff0c\u5176\u4ed6\u8ddd\u79bb $x$ \u4e3a $c - 1$ \u7684\u70b9\u5c31\u4e00\u5b9a\u6bd4\u53f3\u4e0a\u89d2\u8fd1\uff0c\u56e0\u6b64\uff0c\u4e0d\u53ef\u80fd\u5b58\u5728\u4e00\u4e2a\u70b9\u4f7f\u5f97 $1$ \u5230\u8fd9\u4e2a\u70b9\u7684\u8ddd\u79bb\u4e0e $1$ \u5230\u53f3\u4e0a\u89d2\u7684\u8ddd\u79bb\u76f8\u7b49\uff0c\u56e0\u6b64\u53ef\u4ee5\u786e\u5b9a\u53f3\u4e0b\u89d2\uff0c\u5de6\u4e0a\u89d2\u540c\u7406\u3002\n\n\u6ce8\u610f\u5230 $l = c$ \u65f6\u65e0\u6cd5\u5224\u65ad\u662f\u5de6\u4e0a\u89d2\u8fd8\u662f\u53f3\u4e0b\u89d2\uff0c\u4e0d\u8fc7\u6b64\u65f6\u662f\u5bf9\u79f0\u7684\uff0c\u6ca1\u6709\u5f71\u54cd\u3002\n\n\u53e6\u5916\uff0c\u6211\u4eec\u89c2\u5bdf\u5230\uff0c\u6709\u5f88\u591a\u60c5\u51b5\u9700\u8981\u7279\u5224\u3002\n\n\u5b9a\u4e49\u4e00\u4e2a\u70b9\u7684\u5ea6\u6570\u4e3a\u4e0e\u5176\u8ddd\u79bb\u4e3a $1$ \u7684\u8282\u70b9\u7684\u4e2a\u6570\u3002\n\n\u9996\u5148\uff0c\u53ea\u6709\u4e00\u4e2a\u70b9\u7684\u65f6\u5019\u76f4\u63a5\u5224\u3002\n\n\u7136\u540e\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u82e5\u70b9 $1$ \u7684\u5ea6\u6570\u4e3a $1$ \uff0c\u5219\u5fc5\u7136\u662f\u4e00\u4e2a $1 \\times n$ \u7684\u7f51\u683c\uff0c\u76f4\u63a5\u8f93\u51fa\u5373\u53ef\u3002\n\n\u540c\u7406\uff0c\u82e5\u70b9 $1$ \u7684\u5ea6\u6570\u4e3a $2$ \uff0c\u5219\u8be2\u95ee\u5176\u4e2d\u4e00\u4e2a\u4e0e\u70b9 $1$ \u76f8\u90bb\u7684\u70b9 $q$ \uff0c\u82e5 $q$ \u5ea6\u6570\u4e3a $1$ \uff0c\u5219\u662f $1 \\times n$ \uff0c\u82e5\u5176\u5ea6\u6570\u4e3a $3$ \uff0c\u5219\u5c06 $1$ \u770b\u505a\u627e\u5230\u7684\u89d2\uff0c $q$ \u770b\u505a\u6700\u5f00\u59cb\u8be2\u95ee\u7684 $1$ \uff0c\u6b63\u5e38\u8ba1\u7b97\u5373\u53ef\u3002\u82e5 $q$ \u5ea6\u6570\u4e3a $2$ \uff0c\u8be2\u95ee\u8ddd\u79bb\u5176\u6700\u8fdc\u7684\u70b9 $s$ \uff0c\u82e5 $s$ \u5ea6\u6570\u4e3a $1$ \uff0c\u5219\u662f $1 \\times n$ \u7684\u60c5\u51b5\uff0c\u5426\u5219\u8868\u660e $1,q$ \u662f\u4e00\u4e2a $2 \\times \\frac{n}{2}$ \u7684\u7f51\u683c\u7684\u4e24\u4e2a\u90bb\u89d2\u3002\n\n~~\u4ee5\u4e0a\u662f\u6211\u82b1 $10$ \u5757\u94b1\u4e70\u4e86\u5b98\u65b9\u9898\u89e3\u7684\u539f\u56e0\u3002~~\n\n### AC \u4ee3\u7801\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<utility>\n#include<vector>\n#include<algorithm>\n#define MAXN 100005\n#define fi first\n#define se second\n\nusing namespace std;\n\nint n,a1[MAXN],a2[MAXN],a3[MAXN];\n\nvoid Ask(int * a,int x){\n\tcout << x << endl;\n\tfor(int i=1;i<=n;i++) cin >> a[i];\n}\n\nint X,Y,Z,l,c,x_1,y_1;\n\ninline int dis_1(int x) { return a1[x]; }\ninline int dis_X(int x) { return a2[x]; }\ninline int dis_Y(int x) { return l+c-2-a2[x]; }\ninline int dis_Z(int x) { return a3[x]; }\ninline int Abs(int x) { return x>0?x:-x; }\n\ninline int get_d(int * a){\n\tint ret=0;\n\tfor(int i=1;i<=n;i++) ret+=(a[i]==1);\n\treturn ret;\n}\n\nvoid solve_1(){\n\tvector <int> a(n,0);\n\ta[0]=1;\n\tfor(int i=1;i<=n;i++) a[a1[i]]=i;\n\tcout << 0 << endl;\n\tcout << 1 << ' ' << n << endl;\n\tfor(int i=0;i<n;i++) cout << a[i] << ' ';\n\tcout << endl;\n}\n\nvoid get_ans(int pos_1){\n\tfor(int i=1;i<=n;i++) if(a2[i]>=a2[Y]) Y=i;\n\tint sum_lc=dis_X(Y)+2;\n\tfor(int i=1;i<=n;i++){\n\t\tif((!(n%i))&&i+n/i==sum_lc){\n\t\t\tl=i; c=n/i; break;\n\t\t}\n\t}\n\tint t1=0,t2=0;\n\tfor(int i=1;i<=n;i++){\n\t\tif(dis_1(i)+dis_X(i)==dis_X(pos_1)) t1++;\n\t\tif(dis_1(i)+dis_Y(i)==dis_Y(pos_1)) t2++;\n\t}\n\tfor(int i=1;i<=l;i++){\n\t\tfor(int j=1;j<=c;j++){\n\t\t\tif(i+j==dis_1(X)+2&&i*j==t1&&(l-i+1)*(c-j+1)==t2){\n\t\t\t\tx_1=i,y_1=j;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tvector <int> ld,ru;\n\tfor(int i=1;i<=n;i++){\n\t\tif(dis_X(i)==l-1&&dis_1(i)==Abs(l-x_1)+Abs(y_1-1)){\n\t\t\tld.push_back(i);\n\t\t}\n\t\tif(dis_X(i)==c-1&&dis_1(i)==Abs(1-x_1)+Abs(c-y_1)){\n\t\t\tru.push_back(i);\n\t\t}\n\t}\n\tvector < vector <int> > a(l,vector <int> (c,0));\n\tif(Z){\n\t\tif(dis_X(Z)==l-1){\n\t\t\tfor(int i=1,tx,ty;i<=n;i++){\n\t\t\t\tty=(dis_Z(i)+dis_X(i)-dis_X(Z)+2)/2;\n\t\t\t\ttx=dis_X(i)-ty+2;\n\t\t\t\ta[tx-1][ty-1]=i;\n\t\t\t}\n\t\t\tcout << 0 << endl;\n\t\t\tcout << l << ' ' << c << endl;\n\t\t\tfor(int i=0;i<l;i++){\n\t\t\t\tfor(int j=0;j<c;j++){\n\t\t\t\t\tcout << a[i][j] << ' ';\n\t\t\t\t}\n\t\t\t\tcout << endl;\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tfor(int i=1,tx,ty;i<=n;i++){\n\t\t\t\ttx=(dis_Z(i)+dis_X(i)-dis_X(Z)+2)/2;\n\t\t\t\tty=dis_X(i)-tx+2;\n\t\t\t\ta[tx-1][ty-1]=i;\n\t\t\t}\n\t\t\tcout << 0 << endl;\n\t\t\tcout << l << ' ' << c << endl;\n\t\t\tfor(int i=0;i<l;i++){\n\t\t\t\tfor(int j=0;j<c;j++){\n\t\t\t\t\tcout << a[i][j] << ' ';\n\t\t\t\t}\n\t\t\t\tcout << endl;\n\t\t\t}\n\t\t}\n\t\treturn;\n\t}\n\tif(ld.size()==1){\n\t\tAsk(a3,ld[0]),Z=ld[0];\n\t\tfor(int i=1,tx,ty;i<=n;i++){\n\t\t\tty=(dis_Z(i)+dis_X(i)-dis_X(Z)+2)/2;\n\t\t\ttx=dis_X(i)-ty+2;\n\t\t\ta[tx-1][ty-1]=i;\n\t\t}\n\t\tcout << 0 << endl;\n\t\tcout << l << ' ' << c << endl;\n\t\tfor(int i=0;i<l;i++){\n\t\t\tfor(int j=0;j<c;j++){\n\t\t\t\tcout << a[i][j] << ' ';\n\t\t\t}\n\t\t\tcout << endl;\n\t\t}\n\t}\n\telse{\n\t\tAsk(a3,ru[0]),Z=ru[0];\n\t\tfor(int i=1,tx,ty;i<=n;i++){\n\t\t\ttx=(dis_Z(i)+dis_X(i)-dis_X(Z)+2)/2;\n\t\t\tty=dis_X(i)-tx+2;\n\t\t\ta[tx-1][ty-1]=i;\n\t\t}\n\t\tcout << 0 << endl;\n\t\tcout << l << ' ' << c << endl;\n\t\tfor(int i=0;i<l;i++){\n\t\t\tfor(int j=0;j<c;j++){\n\t\t\t\tcout << a[i][j] << ' ';\n\t\t\t}\n\t\t\tcout << endl;\n\t\t}\n\t}\n}\n\nvoid solve_2(){\n\tint p;\n\tfor(int i=1;i<=n;i++){\n\t\tif(a1[i]==1) { p=i; Ask(a2,p); break; }\n\t}\n\tif(get_d(a2)>=3){\n\t\tswap(a2,a1); X=1;\n\t\tget_ans(p);\n\t}\n\telse if(get_d(a2)==1){\n\t\tvector <int> a(n,0);\n\t\ta[0]=p;\n\t\tfor(int i=1;i<=n;i++) a[a2[i]]=i;\n\t\tcout << 0 << endl;\n\t\tcout << 1 << ' ' << n << endl;\n\t\tfor(int i=0;i<n;i++) cout << a[i] << ' ';\n\t\tcout << endl;\n\t}\n\telse{\n\t\tfor(int i=1;i<=n;i++) if(a2[i]>=a2[Z]) Z=i;\n\t\tAsk(a3,Z);\n\t\tif(get_d(a3)==1){\n\t\t\tvector <int> a(n,0);\n\t\t\ta[0]=Z;\n\t\t\tfor(int i=1;i<=n;i++) a[a3[i]]=i;\n\t\t\tcout << 0 << endl;\n\t\t\tcout << 1 << ' ' << n << endl;\n\t\t\tfor(int i=0;i<n;i++) cout << a[i] << ' ';\n\t\t\tcout << endl;\n\t\t}\n\t\telse{\n\t\t\tswap(a1,a2);\n\t\t\tget_ans(p);\n\t\t}\n\t}\n}\n\nvoid solve(){\n\tX=Y=Z=l=c=x_1=y_1=0;\n\tcin >> n;\n\tAsk(a1,1);\n\tif(get_d(a1)==0){\n\t\tcout << 0 << endl;\n\t\tcout << 1 << ' ' << 1 << endl;\n\t\tcout << 1 << endl;\n\t\treturn;\n\t}\n\tif(get_d(a1)==1) return solve_1();\n\tif(get_d(a1)==2) return solve_2();\n\tfor(int i=1;i<=n;i++) if(a1[i]>=a1[X]) X=i;\n\tAsk(a2,X);\n\tget_ans(1);\n}\n\nint main(){\n\tint T; cin >> T;\n\twhile(T--) solve();\n\treturn 0;\n}\n\n```",
        "postTime": 1654609391,
        "uid": 525349,
        "name": "Sakura_xyz",
        "ccfLevel": 4,
        "title": "P8303 [CoE R4 C] \u7f51\u683c \u9898\u89e3"
    }
]
[
    {
        "content": "> *[P3448 [POI2006]MIS-Teddies](https://www.luogu.com.cn/problem/P3448)\n>\n> [POI \u5408\u96c6](https://www.cnblogs.com/alex-wei/p/POI.html)\u3002\n\n\u8fd8\u7b97\u6709\u8da3\u7684 DP\uff0c\u611f\u89c9\u96be\u5ea6\u6ca1\u6709\u9ed1\u724c\u3002\n\n\u5947\u5947\u602a\u602a\u7684\u9650\u5236 + \u5f88\u5c0f\u7684\u6570\u636e\u8303\u56f4\uff0c\u52a8\u6001\u89c4\u5212\u6ca1\u8dd1\u4e86\u3002\u6ce8\u610f\u5230\u6211\u4eec\u6839\u672c\u4e0d\u9700\u8981\u77e5\u9053\u5e8f\u5217\u957f\u4ec0\u4e48\u6837\uff0c\u53ea\u8981\u6bcf\u79cd\u73a9\u5177\u653e\u7684\u4e2a\u6570\u4ee5\u53ca\u6700\u540e\u4e24\u4e2a\u73a9\u5177\u662f\u4ec0\u4e48\u5c31\u53ef\u4ee5\u8f6c\u79fb\u4e86\u3002\u56e0\u6b64\u8bbe\u516d\u7ef4 DP $f_{i,j,k,l,m,n}$ \u8868\u793a\u653e\u4e86 $i,j,k,l$ \u4e2a $A1,A2,B1,B2$\uff08\u5206\u522b\u6807\u53f7\u4e3a $0,1,2,3$\uff09\uff0c\u6700\u540e\u4e24\u4e2a\u73a9\u5177\u5206\u522b\u662f $m$ \u548c $n$ \u7684\u65b9\u6848\u6570\uff0c\u8f6c\u79fb\u76f4\u63a5\u679a\u4e3e\u4e0b\u4e00\u4e2a\u653e\u4ec0\u4e48\uff0c\u68c0\u67e5\u4e00\u4e0b\u662f\u5426\u7b26\u5408\u9898\u610f\u5373\u53ef\u3002\n\n\u7a7a\u95f4\u590d\u6742\u5ea6\u53ef\u4ee5\u901a\u8fc7\u6eda\u52a8\u6570\u7ec4\u4f18\u5316\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u56db\u65b9\uff0c\u6709 $64$ \u500d\u5e38\u6570\u3002\n\n```cpp\nconst int N = 39;\nconst int mod = 1e6;\nvoid add(int &x, int y) {x += y, x >= mod && (x -= mod);}\nint a, b, c, d, ans, f[2][N][N][N][4][4];\nbool check(int x, int y, int z) {\n\tif(x == -1) return 1;\n\tint a = (x & 1) + (y & 1) + (z & 1), b = (x < 2) + (y < 2) + (z < 2);\n\treturn a && a < 3 && b && b < 3;\n}\nint main(){\n\tcin >> a >> b >> c >> d, f[0][0][0][0][0][0] = 1;\n\tfor(int I = 0, i = 0; I <= a; I++, i ^= 1) {\n\t\tmem(f[i ^ 1], 0, N);\n\t\tfor(int j = 0; j <= b; j++)\n\t\t\tfor(int k = 0; k <= c; k++)\n\t\t\t\tfor(int l = 0, s = I + j + k; l <= d; l++, s++)\n\t\t\t\t\tfor(int x = 0; x < 4; x++)\n\t\t\t\t\t\tfor(int y = 0, v; y < 4; y++)\n\t\t\t\t\t\t\tif(v = f[i][j][k][l][x][y]) {\n\t\t\t\t\t\t\t\tint q2 = s <= 1 ? -1 : x, q1 = !s ? -1 : y;\n\t\t\t\t\t\t\t\tif(I < a && check(q2, q1, 0)) add(f[i ^ 1][j][k][l][y][0], v);\n\t\t\t\t\t\t\t\tif(j < b && check(q2, q1, 1)) add(f[i][j + 1][k][l][y][1], v);\n\t\t\t\t\t\t\t\tif(k < c && check(q2, q1, 2)) add(f[i][j][k + 1][l][y][2], v);\n\t\t\t\t\t\t\t\tif(l < d && check(q2, q1, 3)) add(f[i][j][k][l + 1][y][3], v);\n\t\t\t\t\t\t\t}\n\t}\n\tfor(int i = 0; i < 4; i++) for(int j = 0; j < 4; j++) add(ans, f[a & 1][b][c][d][i][j]);\n\tcout << ans << endl;\n\treturn 0;\n}\n```",
        "postTime": 1639447848,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "P3448 [POI2006]MIS-Teddies"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u9053dp\u3002\n\n\u8bbe$f[i][a][b][c][y][x]$\u8868\u793adp\u5230\u7b2ci\u4e2a\u718a\uff0c\u7b2c\u4e00\u79cd\u718a\u7528\u4e86a\u4e2a\uff0c\u7b2c\u4e8c\u79cd\u7528\u4e86b\u4e2a\uff0c\u7b2c\u4e09\u79cd\u7528\u4e86c\u4e2a\uff0c\u90a3\u4e48\u81ea\u7136\u7b2c\u56db\u79cd\u7528\u4e86i-a-b-c\u4e2a\uff0c\u6700\u540e\u4e00\u53ea\u718a\u662f\u7b2cx\u79cd\uff0c\u5012\u6570\u7b2c\u4e8c\u53ea\u662f\u7b2cy\u79cd\u7684\u65b9\u6848\u6570\u3002\n\n\u628a\u6bcf\u4e00\u4f4d\u90fd\u679a\u4e3e\u51fa\u6765\uff0c\u518d\u679a\u4e3e\u5012\u6570\u7b2c\u4e09\u53ea\u718a\u5224\u65ad\u5408\u6cd5\u5c31\u53ef\u4ee5\u8f6c\u79fb\u4e86\u3002\n\n\u56e0\u4e3a\u8f6c\u79fb\u53ea\u4f1a\u7528\u5230i\u548ci-1\uff0c\u6240\u4ee5\u7b2c\u4e00\u7ef4\u53ef\u4ee5\u6eda\u52a8\u6389\uff0c\u8fd8\u6709\uff0c\u524d\u4e24\u53ea\u718a\u8981\u81ea\u5df1\u7528\u624b\u586b\u51fa\u6765\u3002\n\n\u4ee5\u53ca\u5224\u65ad\u5408\u6cd5\u7684\u65b9\u5f0f\u501f\u9274\u4e86\u53e6\u4e00\u7bc7\u9898\u89e3\u3002\n\n```cpp\n#include<cmath>\n#include<cstdio>\n#include<iostream>\n#define mod 1000000\nusing namespace std;\nint f[2][39][39][39][4][4];\nint u[4],ans,p[4][4];\nint main(){\n//\tfreopen(\"3448.in\",\"r\",stdin);\n//\tfreopen(\"my.out\",\"w\",stdout);\n\tscanf(\"%d%d%d%d\",&u[0],&u[1],&u[2],&u[3]);\n\tint n=u[0]+u[1]+u[2]+u[3],o,d;\n\tif (n<2){\n\t\tputs(\"1\");\n\t\treturn 0;\n\t}\n\tp[0][0]=p[0][2]=1;p[0][1]=p[0][3]=-1;\n\tp[1][0]=p[1][1]=1;p[1][2]=p[1][3]=-1;\n\tfor (int i=0; i<=3; i++)\n\t\tfor (int j=0; j<=3; j++){\n\t\t\tif (i==j&&u[i]<2) continue;\n\t\t\tif (i==0&&u[i]){\n\t\t\t\tif (j==0&&u[j]) f[0][2][0][0][0][0]++;\n\t\t\t\tif (j==1&&u[j]) f[0][1][1][0][0][1]++;\n\t\t\t\tif (j==2&&u[j]) f[0][1][0][1][0][2]++;\n\t\t\t\tif (j==3&&u[j]) f[0][1][0][0][0][3]++;\n\t\t\t}\n\t\t\tif (i==1&&u[i]){\n\t\t\t\tif (j==0&&u[j]) f[0][1][1][0][1][0]++;\n\t\t\t\tif (j==1&&u[j]) f[0][0][2][0][1][1]++;\n\t\t\t\tif (j==2&&u[j]) f[0][0][1][1][1][2]++;\n\t\t\t\tif (j==3&&u[j]) f[0][0][1][0][1][3]++;\n\t\t\t}\n\t\t\tif (i==2&&u[i]){\n\t\t\t\tif (j==0&&u[j]) f[0][1][0][1][2][0]++;\n\t\t\t\tif (j==1&&u[j]) f[0][0][1][1][2][1]++;\n\t\t\t\tif (j==2&&u[j]) f[0][0][0][2][2][2]++;\n\t\t\t\tif (j==3&&u[j]) f[0][0][0][1][2][3]++;\n\t\t\t}\n\t\t\tif (i==3&&u[i]){\n\t\t\t\tif (j==0&&u[j]) f[0][1][0][0][3][0]++;\n\t\t\t\tif (j==1&&u[j]) f[0][0][1][0][3][1]++;\n\t\t\t\tif (j==2&&u[j]) f[0][0][0][1][3][2]++;\n\t\t\t\tif (j==3&&u[j]) f[0][0][0][0][3][3]++;\n\t\t\t}\n\t\t}\n\tfor (int i=3; i<=n; i++){\n\t\to=i%2;\n\t\tfor (int a=0; a<=u[0]; a++)\n\t\tfor (int b=0; b<=u[1]; b++)\n\t\tfor (int c=0; c<=u[2]; c++){\n\t\t\tif (a+b+c<i-u[3]) continue;\n\t\t\td=i-a-b-c;\n\t\t\tfor (int x=0; x<=3; x++)\n\t\t\tfor (int y=0; y<=3; y++){\n\t\t\tf[o][a][b][c][y][x]=0;\n\t\t\tfor (int z=0; z<=3; z++){\n\t\t\t\tif(abs(p[0][x]+p[0][y]+p[0][z])==3||\n\t\t\t\t   abs(p[1][x]+p[1][y]+p[1][z])==3) continue;\n\t\t\t\tif (x==0&&a)\n\t\t\t\t\t(f[o][a][b][c][y][x]+=f[o^1][a-1][b][c][z][y])%=mod;\n\t\t\t\tif (x==1&&b)\n\t\t\t\t\t(f[o][a][b][c][y][x]+=f[o^1][a][b-1][c][z][y])%=mod;\n\t\t\t\tif (x==2&&c)\n\t\t\t\t\t(f[o][a][b][c][y][x]+=f[o^1][a][b][c-1][z][y])%=mod;\n\t\t\t\tif (x==3&&d)\n\t\t\t\t\t(f[o][a][b][c][y][x]+=f[o^1][a][b][c][z][y])%=mod;\n\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\to=n%2;\n\tfor (int i=0; i<=3; i++)\n\t\tfor (int j=0; j<=3; j++){\n\t\t\t(ans+=f[o][u[0]][u[1]][u[2]][i][j])%=mod;\n//\t\t\tprintf(\"%d %d: %d\\n\",i,j,f[o][u[0]][u[1]][u[2]][i][j]);\n\t\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1562387375,
        "uid": 63661,
        "name": "Taduro",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3448 \u3010[POI2006]MIS-Teddies\u3011"
    },
    {
        "content": "\u7531\u9898\u76ee\u5f97 A1\u548cB1\u3001A1\u548cA2\u3001A2\u548cB2\u3001B1\u548cB2\u653e\u5728\u4e00\u8d77\u4e0d\u5f97\u8d85\u8fc72\u4e2a\n\u6240\u4ee5\u6211\u4eec\u7ed9A1\u3001B1\u3001A2\u3001B2\u5b9a\u4e00\u4e2a\u6743\u503c\n```cpp\np[0][1]=p[0][3]=1;p[0][2]=p[0][4]=-1;\np[1][1]=p[1][2]=1;p[1][3]=p[1][4]=-1;\n```\nw\u3001x\u3001y\u4e3a\u4e09\u4e2a\u718a\u7684\u6807\u53f7\n```cpp\nif(abs(p[0][x]+p[0][y]+p[0][w])==3||\nabs(p[1][x]+p[1][y]+p[1][w])==3) continue;\n```\n\u8fd9\u6837\u53ef\u4ee5\u5224\u65ad\u662f\u5426\u6709\u4e09\u53ea\u4e0d\u5408\u89c4\u7684\u718a\u653e\u5728\u4e00\u8d77\n\n\u6211\u4eec\u53ef\u4ee5\u7801\u4e00\u4e2aDP\nf[i][j][k][g][x][y][z]\ni-->\u679a\u4e3eA1\u4e2a\u6570\nj-->\u679a\u4e3eA2\u4e2a\u6570\nk-->\u679a\u4e3eB1\u4e2a\u6570\ng-->\u679a\u4e3eB2\u4e2a\u6570\nx\u3001y\u3001z\u679a\u4e3e\u7684\u5e8f\u5217\u540e\u4e09\u53ea\u718a\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49 f[40][40][40][40][5][5][5]\n\n\u4f46\u8fd9\u663e\u7136\u8d85\u51fa128MB\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u53d1\u73b0\u5faa\u73af\u4e2di\u662f\u4f9d\u6b21\u589e\u52a0\u7684\uff0c\u4e14\u6bcf\u6b21\u53ea\u9700\u8981i-1\u7684\u6570\u503c\uff0c\u6240\u4ee5\u6211\u4eec\u81ea\u7136\u4f1a\u60f3\u5230\u6eda\u52a8\u6570\u7ec4\n\u5c31\u53ef\u4ee5\u5b9a\u4e49 f[2][40][40][40][5][5][5]\n\u4f46\u8981\u8bb0\u5f97 f[i%2][j][k][g][x][y][z]=0;\n\n\u4f46\u8fd9\u6837\u8fd8\u4e0d\u884c\uff0c\u65f6\u6548\u8fc7\u4e0d\u53bb\n\u6240\u4ee5\u5c31\u679a\u4e3e\u540e\u4e24\u53ea\u718a\uff1b\nf[2][40][40][40][5][5]\n\u518d\u679a\u4e3e\u8fd9\u4e2a\u5e8f\u5217\u7684\u4e0a\u4e00\u72b6\u6001\uff0c\u4e5f\u5c31\u662f\u4e0a\u4e00\u53ea\u718a\uff1b\n\u672c\u9898\u7684\u5927\u81f4\u601d\u60f3\u4fbf\u662f\u5982\u6b64\uff1b\nDP\u4e2d\u8981\u6ce8\u610f\u5c06\u4e0d\u5b58\u5728\u7684\u60c5\u51b5\u5224\u505c\n\u4ee3\u7801\u5982\u4e0b\n```cpp\n#include<bits/stdc++.h>\n#define TT 1000000\nusing namespace std;\nint ans,f[2][40][40][40][5][5],n,p[2][5],a,b,c,d,h[5],hh[5];\nint get(int i,int j,int k,int g,int x,int w,int y){\n\tif(y==1) i--;\n\tif(y==2) j--;\n\tif(y==3) k--;\n\tif(y==4) g--;\n\treturn f[i%2][j][k][g][w][x];\n}\nint main(){\n\tscanf(\"%d%d%d%d\",&a,&b,&c,&d);\n\tn=a+b+c+d;f[0][0][0][0][0][0]=1;\n\tp[0][1]=p[0][3]=1;p[0][2]=p[0][4]=-1;\n\tp[1][1]=p[1][2]=1;p[1][3]=p[1][4]=-1;\n\tfor(int i=0;i<=a;i++)\n\tfor(int j=0;j<=b;j++)\n\tfor(int k=0;k<=c;k++)\n\tfor(int g=0;g<=d;g++)\n\tfor(int x=0;x<=4;x++)\n\tfor(int y=1;y<=4;y++){\n\t\tf[i%2][j][k][g][x][y]=0;\n\t\tint m=i+j+k+g;\n\t\tif(m>0&&y==0) break;\n\t\tif(m>1&&x==0) break;\n\t\thh[0]=1<<30;hh[1]=i;hh[2]=j;hh[3]=k;hh[4]=g;\n\t\th[1]=h[2]=h[3]=h[4]=0;\n\t\th[x]++;h[y]++;\n\t\tif(h[1]>i||h[2]>j||h[3]>k||h[4]>g) continue;\n\t\tfor(int w=0;w<=4;w++){\n\t\t\tif((x<1||y<1)&&w>0) break;\n\t\t\tif(m-1>1&&w==0) continue;\n\t    \tif(abs(p[0][x]+p[0][y]+p[0][w])==3||abs(p[1][x]+p[1][y]+p[1][w])==3) continue;\n\t\t\th[y]--;h[w]++;hh[y]--;\n\t\t\tif(h[w]>hh[w]) continue;\n\t\t\th[y]++;h[w]--;hh[y]++;\n\t\t\tint ff=get(i,j,k,g,x,w,y);\n\t\t\tf[i%2][j][k][g][x][y]=(f[i%2][j][k][g][x][y]+ff)%TT;\n\t\t}\n\t\tif(i==a&&j==b&&k==c&&g==d)\n\t\tans=(ans+f[a%2][b][c][d][x][y])%TT;\n    }\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n\n```\n\n",
        "postTime": 1559552974,
        "uid": 156884,
        "name": "\u603a\u5fc6",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3448 \u3010[POI2006]MIS-Teddies\u3011"
    },
    {
        "content": "\u975e\u5e38\u641e\u7b11\u7684\u4e00\u9053 dp\uff0c\u7ec6\u8282\u591a\u88c2\u4e86\uff0c\u6211\u611f\u5230\u9707\u60ca\u3002\n\n\u8003\u8651\u5230\u6211\u4eec\u7684\u6570\u636e\u8303\u56f4\u6bd4\u8f83\u5c0f\u5e76\u4e14\u718a\u7684\u79cd\u6570\u5f88\u5c11\uff0c\u6240\u4ee5\u663e\u7136\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u5176\u4f5c\u4e3a dp \u7684\u56db\u7ef4\uff08\u5176\u4e2d\u4e00\u7ef4\u662f\u5f53\u524d\u7684\u603b\u718a\u6570\uff0c\u4f46\u662f\u663e\u7136\u6211\u4eec\u77e5\u9053\u718a\u7684\u603b\u6570\u548c\u4e09\u79cd\u718a\u7684\u6570\u91cf\uff0c\u80af\u5b9a\u77e5\u9053\u7b2c\u56db\u79cd\u7684\u6570\u91cf\uff09\u3002\u65b0\u6dfb\u52a0\u4e00\u53ea\u718a\uff0c\u9020\u6210\u7684\u5f71\u54cd\u53ea\u6709\u524d\u9762\u4e24\u4e2a\uff0c\u518d\u6b21\u5c06\u5176\u4f5c\u4e3a dp \u4e24\u7ef4\u3002\n\n\u5b9a\u4e49 $dp_{i,a,b,c,x,y}$ \u4e3a\u5f53\u524d\u9009\u4e86 $i$ \u53ea\u718a\uff0c$a$ \u4e2a $A1$ \u718a\uff0c$b$ \u4e2a $A2$ \u718a\uff0c$c$ \u4e2a $B1$ \u718a\uff0c\u53ef\u4ee5\u5f97\u5230\u6709 $i-a-b-c$ \u4e2a $B2$ \u718a\uff0c\u4e0a\u4e0a\u6b21\u9009\u4e86 $x$ \u79cd\u718a\uff0c\u4e0a\u6b21\u9009\u4e86 $y$ \u79cd\u718a\u3002\u5176\u4e2d $0 \\leq x,y \\leq 3$\u3002\u6211\u4eec\u5728\u8f6c\u79fb\u7684\u8fc7\u7a0b\u4e2d\u53d1\u73b0\uff0cdp \u8fc7\u7a0b\u53ea\u4f1a\u7528\u5230 $dp_{i-1}$ \u53bb\u66f4\u65b0 $dp_i$\uff0c\u53ef\u4ee5\u6eda\u52a8\u6570\u7ec4\u3002\n\n\u7ec6\u8282\u5f88\u591a\uff0c\u53ef\u4ee5\u7ed9\u5177\u4f53\u5b9e\u73b0\uff0c\u6ce8\u91ca\u770b\u4ee3\u7801\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int MOD=1000000;\nbool ident(int x,int y,int z)\n{\n\tif((x&1) && (y&1) && (z&1))\treturn false;//A1 \u548c B1 \u51b2\u7a81\n\tif(!(x&1) && !(y&1) && !(z&1))\treturn false;//A2 \u548c B2 \u51b2\u7a81\n\tif(x<=1 && y<=1 && z<=1)\treturn false;//A \u5b57\u7b26\u51b2\u7a81\n\tif(x>=2 && y>=2 && z>=2)\treturn false;//B \u5b57\u7b26\u51b2\u7a81\n\treturn true;\n}\nint a1,a2,b1,b2,dp[2][40][40][40][4][4];\nint main(){\n\tscanf(\"%d %d %d %d\",&a1,&a2,&b1,&b2);\n\tint n=a1+a2+b1+b2;\n\tif(n<=1)\treturn puts(\"1\")&0;//\u7279\u5224\u4e00\u53ea\u718a\u6216\u8005\u6ca1\u6709\u718a\n\tfor(int i=0;i<=3;++i)\n\t{\n\t\tfor(int j=0;j<=3;++j)\n\t\t{\n\t\t\tint a=int(i==0)+int(j==0),b=int(i==1)+int(j==1),c=int(i==2)+int(j==2),d=int(i==3)+int(j==3);\n\t\t\tif(a>a1 || b>a2 || c>b1 || d>b2)\tcontinue;\n\t\t\tdp[0][a][b][c][i][j]=1;//\u586b\u4e24\u53ea\u718a\u7684\u60c5\u51b5\u8981\u81ea\u5df1\u5224\u65ad\u3002\u6ce8\u610f\u770b\u4e0b\u662f\u5426\u8d85\u8fc7\u4e86\u603b\u6570\n\t\t}\n\t}\n\tfor(int i=3;i<=n;++i)\n\t{\n\t\tmemset(dp[i&1],0,sizeof dp[i&1]);//\u6ce8\u610f\u6e05\u7a7a\n\t\tfor(int a=0;a<=min(i,a1);++a)\n\t\t{\n\t\t\tfor(int b=0;b<=min(i,a2);++b)\n\t\t\t{\n\t\t\t\tif(a+b>i)\tcontinue;\n\t\t\t\tfor(int c=0;c<=min(i,b1);++c)\n\t\t\t\t{\n\t\t\t\t\tif(a+b+c>i)\tcontinue;\n\t\t\t\t\tint d=i-a-b-c;\n\t\t\t\t\tif(d>b2)\tcontinue;\n\t\t\t\t\tfor(int x=0;x<=3;++x)\n\t\t\t\t\t{\n\t\t\t\t\t\tfor(int y=0;y<=3;++y)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfor(int z=0;z<=3;++z)\n\t\t\t\t\t\t\t{//\u679a\u4e3e\u5f53\u524d\u56db\u79cd\u718a\u7684\u60c5\u51b5\u4ee5\u53ca\u4e0a\u4e0a\u4e2a\uff0c\u4e0a\u4e2a\uff0c\u5f53\u524d\u8fd9\u4e2a\u9009\u7684\u718a\u7684\u60c5\u51b5\n\t\t\t\t\t\t\t\tif(!ident(x,y,z))\tcontinue;\n\t\t\t\t\t\t\t\tint la=a-int(z==0),lb=b-int(z==1),lc=c-int(z==2),ld=d-int(z==3);\n\t\t\t\t\t\t\t\tif(la<0 || lb<0 || lc<0 || ld<0)\tcontinue;\n\t\t\t\t\t\t\t\tdp[i&1][a][b][c][y][z]+=dp[(i&1)^1][la][lb][lc][x][y];\n\t\t\t\t\t\t\t\tdp[i&1][a][b][c][y][z]%=MOD;//dp \u66f4\u65b0\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint ans=0;\n\tfor(int i=0;i<=3;++i)\tfor(int j=0;j<=3;++j)\tans+=dp[n&1][a1][a2][b1][i][j],ans%=MOD;\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1602140629,
        "uid": 184977,
        "name": "pomelo_nene",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3448 \u3010[POI2006]MIS-Teddies\u3011"
    },
    {
        "content": "### [\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3448)\n\uff08\u5982\u679c $\\LaTeX$ \u70b8\u4e86\uff0c\u8bf7\u5230\u535a\u5ba2[\u89c2\u770b](https://www.luogu.com.cn/blog/thats-me/ti-jie-p3448-poi2006mis-teddies)\uff09\n\n$\\Large\\mathscr{Part\\,\\,1\\;\\;}\\text{\u57fa\u672c\u601d\u8def}$\n\n\u8fd9\u9053\u9898\u662f\u5728\u7ed9\u51fa\u6211\u4eec $4$ \u4e2a\u7269\u54c1\u548c\u4e00\u7cfb\u5217\u7981\u6b62\u6761\u4ef6\u540e\u8ba9\u6211\u4eec\u6c42\u65b9\u6cd5\u603b\u6570\uff0c\u5f88\u5bb9\u6613\u5c31\u60f3\u5230\u4e86 $DP$ \u3002\u6211\u4eec\u4ece\u6700\u7b80\u5355\u7684\u60f3\u6cd5\u8bb2\u8d77\u3002\n\n\u4ee4 $f[i][j][k][l][m][x][y]$ \u8868\u793a\u4e00\u5171\u53d6\u4e86 $i$ \u4e2a\u73a9\u5177\uff0c\u5176\u4e2d\u6709 $j$ \u4e2a $A_1$ \u578b\u7684\uff0c$k$ \u4e2a $A_2$ \u578b\u7684\uff0c$l$ \u4e2a $B_1$ \u578b\u7684\uff0c$m$ \u4e2a $B_2$ \u578b\u7684\uff0c\u4e14\u524d\u4e24\u4e2a\u7528\u7684\u73a9\u5177\u5206\u522b\u662f $x$ \u548c $y$ $\\text{( x , y \u4e3a 0 \u81f3 3 \u7684\u6574\u6570\uff0c\u4e14\u4e0e }A_1\\,,A_2\\,,B_1\\,,B_2\\text{ \u578b\u7684\u73a9\u5177\u7684\u7f16\u53f7\u4f9d\u6b21\u5bf9\u5e94)}$ \u65f6\u7684\u65b9\u6cd5\u6570\u3002\u4f46\u5f88\u660e\u663e\uff0c\u5185\u5b58\u7206\u4e86\u3002\u4e8e\u662f\u6211\u4eec\u60f3\u5230\u4e86\u964d\u7ef4\u3002\n\n\u4ee4 $f[i][j][k][l][x][y]$ \u8868\u793a\u4e00\u5171\u53d6\u4e86 $i$ \u4e2a\u73a9\u5177\uff0c\u5176\u4e2d\u6709 $j$ \u4e2a $A_1$ \u578b\u7684\uff0c$k$ \u4e2a $A_2$ \u578b\u7684\uff0c$l$ \u4e2a $B_1$ \u578b\u7684\uff0c$i-j-k-l$ \u4e2a $B_2$ \u578b\u7684\uff0c\u4e14\u524d\u4e24\u4e2a\u7528\u7684\u73a9\u5177\u5206\u522b\u662f $x$ \u548c $y$ \u65f6\u7684\u65b9\u6cd5\u6570\u3002\u5219\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e3a $f[i][j][k][l][x][y] = f[i-1][j-1][k][l][x'][y'] + \\cdots$\u3002\u6ce8\u610f\u5230\u6bcf\u6b21\u72b6\u6001\u8f6c\u79fb\u53ea\u9700\u8981\u7528\u5230\u7b2c\u4e00\u7ef4\u524d\u4e00\u4e2a\u6570\u7684\u65b9\u6cd5\u6570\uff0c\u6545\u7b2c\u4e00\u7ef4\u53ef\u4ee5\u6eda\u52a8\u6389\uff0c\u5c31\u6709\u4e86 $f[2][j][k][l][x][y]$ \uff0c\u8868\u793a\u5728\u5faa\u73af\u7b2c $i$ \u6b21\u65f6\u53d6\u4e86 $i$ \u4e2a\u73a9\u5177\uff0c\u5176\u4e2d\u6709 $j$ \u4e2a $A_1$ \u578b\u7684\uff0c$k$ \u4e2a $A_2$ \u578b\u7684\uff0c$l$ \u4e2a $B_1$ \u578b\u7684\uff0c$i-j-k-l$ \u4e2a $B_2$ \u578b\u7684\uff0c\u4e14\u524d\u4e24\u4e2a\u7528\u7684\u73a9\u5177\u5206\u522b\u662f $x$ \u548c $y$ \u65f6\u7684\u65b9\u6cd5\u6570\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\u679a\u4e3e\u4e14\u51cf\u5c11\u5185\u5d4c\u5faa\u73af\uff0c\u6211\u4fbf\u7528\u4e00\u4e2a\u56db\u8fdb\u5236\u6570 $q$ \u6765\u8868\u793a\u524d\u4e24\u4e2a\u73a9\u5177\u53d6\u7684\u72b6\u51b5\uff0c$q\\div{4}$ \u4e3a\u524d $2$ \u4e2a\u53d6\u7684\u73a9\u5177\u7684\u7f16\u53f7\uff0c$q\\mod{4}$ \u4e3a\u524d $1$ \u4e2a\u53d6\u7684\u73a9\u5177\u7684\u7f16\u53f7\uff0c\u5373\u6709 $f[now][j][k][l][q]$ \u5728\u8fdb\u884c\u7b2c $i$ \u6b21\u5faa\u73af\u65f6\u8868\u793a\u4e00\u5171\u53d6\u4e86 $i$ \u4e2a\u73a9\u5177\uff0c\u5176\u4e2d\u6709 $j$ \u4e2a $A_1$ \u578b\u7684\uff0c$k$ \u4e2a $A_2$ \u578b\u7684\uff0c$l$ \u4e2a $B_1$ \u578b\u7684\uff0c$i-j-k-l$ \u4e2a $B_2$ \u578b\u7684\uff0c\u4e14\u524d\u4e24\u4e2a\u7528\u7684\u73a9\u5177\u5206\u522b\u662f $q\\div{4}$ \u548c $q\\mod{4}$ \u65f6\u7684\u65b9\u6cd5\u6570\u3002\n\n\u90a3\u4e48\u73b0\u5728\u600e\u4e48\u5224\u65ad\u5408\u6cd5\u65b9\u6cd5\u6570\u5462\uff1f\u6ce8\u610f\u5230\u6bcf\u4e2a\u73a9\u5177\u6240\u542b\u5143\u7d20 **\uff08\u89c1\u4e0b\u8868\uff09** \uff0c\u5982\u679c\u524d\u4e24\u4e2a\u73a9\u5177\u542b\u6709\u56db\u4e2a\u4e92\u4e0d\u76f8\u540c\u7684\u7684\u5143\u7d20\uff0c\u90a3\u4e48\u63a5\u4e0b\u6765\u53ef\u4ee5\u53d6\u4efb\u610f\u7684\u73a9\u5177\uff1b\u5982\u679c\u524d\u4e24\u4e2a\u73a9\u5177\u4e00\u6a21\u4e00\u6837\uff0c\u90a3\u4e48\u53ea\u5269\u4e0b\u4e00\u4e2a\u73a9\u5177\u53ef\u4ee5\u53d6\uff08\u4e0d\u542b\u91cd\u590d\u5143\u7d20\uff09\uff0c\u5373 $3$ \u4e0e\u8fd9\u79cd\u73a9\u5177\u7684\u7f16\u53f7\u5dee\uff1b\u73b0\u5728\u5269\u4e0b\u7684\u60c5\u51b5\u5c31\u662f\u4ec5\u6709\u4e00\u4e2a\u76f8\u540c\u5143\u7d20\u7684\u4e24\u4e2a\u4e0d\u540c\u73a9\u5177\uff0c\u53ea\u8981\u4e0d\u542b\u6709\u76f8\u540c\u90a3\u4e2a\u5143\u7d20\uff08\u5373\u4e0d\u4e3a\u90a3\u4e24\u4e2a\u73a9\u5177\uff09\u5373\u53ef\u3002\n\n| |$A$|$B$|$1$|$2$|\n| -----------: | -----------: | -----------: | -----------: | -----------: |\n|$A_1$|$\\checkmark$|  |$\\checkmark$|  |\n|$A_2$|$\\checkmark$|  |  |$\\checkmark$|\n|$B_1$|  |$\\checkmark$|$\\checkmark$|  |\n|$B_2$|  |$\\checkmark$|  |$\\checkmark$|\n\n\u7531\u4e8e\u5728\u524d\u53d6\u4e24\u4e2a\u73a9\u5177\u65f6\u6ca1\u6709\u9650\u5236\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5224\u65ad\u53d6\u4e24\u4e2a\u73a9\u5177\u65f6\u662f\u5426\u6709\u8db3\u591f\u7684\u4e2a\u6570\uff0c\u82e5\u53ef\u884c\uff0c\u5219\u53ef\u884c\u65b9\u6cd5\u6570\u52a0\u4e00\u3002\n#### \u4f46\u6b64\u65f6\uff0c\u6211\u4eec\u53d1\u73b0\u4e86\u7279\u6b8a\u7684\u60c5\u51b5\uff0c\u5c31\u662f\u5f53\u603b\u548c\u5c0f\u4e8e\u7b49\u4e8e\u4e00\u65f6\uff0c\u65e0\u6cd5\u6784\u6210\u4e24\u4e2a\u8fde\u7eed\u7684\u73a9\u5177\uff0c\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u8f93\u51fa\u603b\u548c\uff08\u56e0\u4e3a\u603b\u548c\u4e3a\u4e00\u65f6\u53ea\u6709$1$\u79cd\u60c5\u51b5\uff0c\u603b\u548c\u4e3a\u96f6\u65f6\u53ea\u6709$0$\u79cd\u60c5\u51b5\uff09\u3002\n$\\Large\\mathscr{Part\\,\\,2\\;\\;}\\text{Code\\qquad}\\tiny\\sout\\text{\u6211\u5c31\u77e5\u9053\u4f60\u4eec\u53ea\u770b\u8fd9\u4e2a}$\n```cpp\n#include <cstdio>\nconst int N=40,M=1000000; // M \u662f\u6a21\u6570\nint a[4],f[2][N][N][N][16],sum,now,ans; // a \u4e3a 4 \u4e2a\u73a9\u5177\u7684\u6570\u91cf\uff0csum \u4e3a\u603b\u548c\uff0cnow \u4e3a\u6eda\u52a8\ninline bool check(int x,int y){ // \u5224\u65ad\u51fd\u6570\n\tint l1=x/4,l2=x%4;\n\tif(l1+l2==3) return 0;\n\telse if(l1!=l2) return (y==l1)||(y==l2);\n\treturn y!=3-l1;\n}\nint main(){\n\tfor(register int i=0; i<4; i++){ // \u8f93\u5165\n\t\tscanf(\"%d\",a+i);\n\t\tsum+=a[i];\n\t}\n\tif(sum<=1){ // \u7279\u5224\n\t\tprintf(\"%d\",sum);\n\t\treturn 0;\n\t}\n\tfor(register int i=0; i<16; i++){ // \u679a\u4e3e\u524d\u53d6\u4e24\u4e2a\u73a9\u5177\u7684\u65b9\u6cd5\n\t\tint aa[]={(i/4==0?1:0)+(i%4==0?1:0),(i/4==1?1:0)+(i%4==1?1:0),(i/4==2?1:0)+(i%4==2?1:0),(i/4==3?1:0)+(i%4==3?1:0)};\n\t\tif(aa[0]>a[0]||aa[1]>a[1]||aa[2]>a[2]||aa[3]>a[3]) continue;\n\t\tf[0][aa[0]][aa[1]][aa[2]][i]++;\n\t}\n\tfor(register int i=3; i<=sum; ++i){ // \u53d6 n \u4e2a\u73a9\u5177\uff0c\u56e0\u4e3a\u524d\u4e24\u4e2a\u73a9\u5177\u5df2\u7ecf\u88ab\u53d6\uff0c\u6240\u4ee5\u4ece 3 \u5f00\u59cb\u5faa\u73af\n\t\tnow^=1;\n\t\tfor(register int j=a[0]; j>=0; --j){\n\t\t\tfor(register int k=a[1]; k>=0; --k){\n\t\t\t\tfor(register int l=a[2]; l>=0; --l){\n\t\t\t\t\tint m=i-j-k-l;\n\t\t\t\t\tif(m>a[3]) break; // \u8fd9\u91cc\u80fd\u76f4\u63a5\u8df3\u51fa\u5faa\u73af\u7684\u539f\u56e0\u662f j, k, l \u5747\u662f\u4ece\u5927\u5230\u5c0f\u679a\u4e3e\u7684\uff0c\u6240\u4ee5\u518d\u5faa\u73af\u5747\u662f\u65e0\u610f\u4e49\u7684\n\t\t\t\t\tfor(register int q=0; q<16; ++q){ // \u679a\u4e3e\u524d\u4e24\u4e2a\u73a9\u5177\u7684\u6bcf\u4e00\u79cd\u72b6\u6001\n\t\t\t\t\t\tf[now][j][k][l][q]=0; //\u7531\u4e8e\u662f\u6eda\u52a8\u6570\u7ec4\uff0c\u6240\u4ee5\u8981\u5148\u5f52\u96f6\n\t\t\t\t\t\tfor(register int w=0; w<4; ++w){\n\t\t\t\t\t\t\tif(check(q,w)) continue; // \u6ce8\u610f\u8fd9\u91cc\u662f\u5224\u65ad\u4e0d\u80fd\u53d6\u7684\u8df3\u8fc7\u5faa\u73af\n\t\t\t\t\t\t\tif(j&&q%4==0) f[now][j][k][l][q]+=f[now^1][j-1][k][l][w*4+q/4]%M; //\u5224\u65ad\u662f\u5426\u80fd\u53d6\uff08\u5373\u4e0a\u4e00\u4e2a\u53d6\u7684\u72b6\u6001\u4e0d\u4e3a\u96f6\uff09\n\t\t\t\t\t\t\telse if(k&&q%4==1) f[now][j][k][l][q]+=f[now^1][j][k-1][l][w*4+q/4]%M;\n\t\t\t\t\t\t\telse if(l&&q%4==2) f[now][j][k][l][q]+=f[now^1][j][k][l-1][w*4+q/4]%M;\n\t\t\t\t\t\t\telse if(m&&q%4==3) f[now][j][k][l][q]+=f[now^1][j][k][l][w*4+q/4]%M;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(register int i=0; i<16; ++i) ans+=f[now][a[0]][a[1]][a[2]][i]%M; //\u7edf\u8ba1\u65b9\u6cd5\u603b\u6570\n\tprintf(\"%d\",ans%M); //\u6253\u5370\n\treturn 0;\n}\n```\n\u4ee3\u7801\u91cc\u8be5\u89e3\u91ca\u7684\u90fd\u6ce8\u91ca\u4e86\u2026\u2026\n\n\u6211\u76f8\u4fe1\u5982\u679c\u4f60\u6ca1\u5438\u6c27\uff0c\u80af\u5b9a\u4f1a $T$ \u51e0\u4e2a\u70b9\uff0c\u6240\u4ee5\uff0c\u624d\u6709\u4e86\u63a5\u4e0b\u6765\u7684\u2026\u2026\n\n$\\Large\\mathscr{Part\\,\\,3\\;\\;}\\text{\u6253\u8868\uff01}$\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u4e0a\u8ff0\u4ee3\u7801\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u867d\u7136\u662f $\\Theta(N^4)$\uff0c\u4f46\u5e38\u6570\u8fbe\u5230\u4e86 $256$ \u500d\uff01\u5bf9\u4e8e\u4e0d\u53ef\u907f\u514d\u7684\u5916\u5c42\u5faa\u73af\uff0c\u6211\u4eec\u65e0\u80fd\u4e3a\u529b\uff0c\u4f46\u5bf9\u4e8e\u5185\u5d4c\u7684\u679a\u4e3e\u4e0e\u5224\u65ad\uff0c\u6211\u4eec\u5374\u53ef\u4ee5\u5728\u6b64\u505a\u6587\u7ae0\uff0c\u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2a$\\footnotesize\\sout\\text{\uff08\u7b80\u5355\u7684\u4e0d\u80fd\u518d\u7b80\u5355\u7684\uff09}$\u6253\u8868\u7a0b\u5e8f\u3002\n```cpp\nchar c[]={'j','k','l','m'};\nfor(int i=0; i<16; i++) for(int j=0; j<4; j++) if(!check(i,j)) printf(\"\\t\\tif(%c) f[now][j][k][l][%d]+=f[now^1][j%s][k%s][l%s][%d]%M;\\n\",c[i%4],i,(i%4==0?\"-1\":\"\"),(i%4==1?\"-1\":\"\"),(i%4==2?\"-1\":\"\"),(j*4)+(i/4)); //\u662f\u4e0d\u662f\u5f88\u957f\uff1f\uff08\u6781\u9650\u538b\u884c\uff09\n```\n\u5176\u4e2d $check$ \u51fd\u6570\u4e3a\u4e0a\u6587\u63d0\u5230\u8fc7\u7684\u5224\u65ad\u51fd\u6570\u3002\u4f46\u8fd9\u8fd8\u4e0d\u591f\uff0c\u6548\u7387\u548c\u539f\u6765\u7684\u4ee3\u7801\u4e00\u6837\uff0c\u6240\u4ee5\u6211\u4eec\u51cf\u5c11\u5224\u65ad\uff0c\u51cf\u5c11\u591a\u4f59\u6a21\uff0c\u4e8e\u662f\u5c31\u6709\u4e86\u4ee5\u4e0b\u4ee3\u7801\uff1a\n```cpp\n#include <cstdio>\nconst int N=40,M=1000000;\nint a[4],f[2][N][N][N][16],sum,now,ans;\ninline int read(){\n\tint x=0;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9') ch=getchar();\n\twhile(ch>='0'&&ch<='9') x=(x<<3)+(x<<1)+ch-'0',ch=getchar();\n}\nint main(){\n\tfor(register int i=0; i<4; i++){\n\t\tscanf(\"%d\",a+i);\n\t\tsum+=a[i];\n\t}\n\tif(sum<=1){\n\t\tprintf(\"%d\",sum);\n\t\treturn 0;\n\t}\n\tfor(register int i=0; i<16; i++){\n\t\tint aa[]={(i/4==0?1:0)+(i%4==0?1:0),(i/4==1?1:0)+(i%4==1?1:0),(i/4==2?1:0)+(i%4==2?1:0),(i/4==3?1:0)+(i%4==3?1:0)};\n\t\tif(aa[0]>a[0]||aa[1]>a[1]||aa[2]>a[2]||aa[3]>a[3]) continue;\n\t\tf[0][aa[0]][aa[1]][aa[2]][i]++;\n\t}\n\tfor(register int i=3; i<=sum; ++i){\n\t\tnow^=1;\n\t\tfor(register int j=a[0]; j>=0; --j){\n\t\t\tfor(register int k=a[1]; k>=0; --k){\n\t\t\t\tfor(register int l=a[2]; l>=0; --l){\n\t\t\t\t\tint m=i-j-k-l;\n\t\t\t\t\tif(m>a[3]) break;\n\t\t\t\t\tif(j){\n\t\t\t\t\t\tf[now][j][k][l][0]=f[now^1][j-1][k][l][12]%M;\n\t\t\t\t\t\tf[now][j][k][l][4]=(f[now^1][j-1][k][l][9]+f[now^1][j-1][k][l][13])%M;\n\t\t\t\t\t\tf[now][j][k][l][8]=(f[now^1][j-1][k][l][6]+f[now^1][j-1][k][l][14])%M;\n\t\t\t\t\t\tf[now][j][k][l][12]=(f[now^1][j-1][k][l][3]+f[now^1][j-1][k][l][7]+f[now^1][j-1][k][l][11]+f[now^1][j-1][k][l][15])%M;\n\t\t\t\t\t}\n\t                if(k){\n\t                \tf[now][j][k][l][1]=(f[now^1][j][k-1][l][8]+f[now^1][j][k-1][l][12])%M;\n\t                \tf[now][j][k][l][5]=f[now^1][j][k-1][l][9]%M;\n\t                \tf[now][j][k][l][9]=(f[now^1][j][k-1][l][2]+f[now^1][j][k-1][l][6]+f[now^1][j][k-1][l][10]+f[now^1][j][k-1][l][14])%M;\n\t                \tf[now][j][k][l][13]=(f[now^1][j][k-1][l][3]+f[now^1][j][k-1][l][11])%M;\t\n\t\t\t\t\t}\n        \t        if(l){\n        \t        \tf[now][j][k][l][2]=(f[now^1][j][k][l-1][4]+f[now^1][j][k][l-1][12])%M;\n        \t        \tf[now][j][k][l][6]=(f[now^1][j][k][l-1][1]+f[now^1][j][k][l-1][5]+f[now^1][j][k][l-1][9]+f[now^1][j][k][l-1][13])%M;\n        \t        \tf[now][j][k][l][10]=f[now^1][j][k][l-1][6]%M;\n        \t        \tf[now][j][k][l][14]=(f[now^1][j][k][l-1][3]+f[now^1][j][k][l-1][7])%M;\n\t\t\t\t\t}\n                \tif(m){\n                \t\tf[now][j][k][l][3]=(f[now^1][j][k][l][0]+f[now^1][j][k][l][4]+f[now^1][j][k][l][8]+f[now^1][j][k][l][12])%M;\n                \t\tf[now][j][k][l][7]=(f[now^1][j][k][l][1]+f[now^1][j][k][l][9])%M;\n                \t\tf[now][j][k][l][11]=(f[now^1][j][k][l][2]+f[now^1][j][k][l][6])%M;\n                \t\tf[now][j][k][l][15]=f[now^1][j][k][l][3]%M;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(register int i=0; i<16; ++i) ans+=f[now][a[0]][a[1]][a[2]][i]%M;\n\tprintf(\"%d\",ans%M);\n\treturn 0;\n}\n```\n\u4e8e\u662f\u6211\u4eec\u5c31\u6109\u5feb\u5730 [$AC$](https://www.luogu.com.cn/record/32183359) \u4e86\u3002$\\text{\uff08\u7528\u65f6\uff1a}1.69s\\text{\uff0c \u5185\u5b58\uff1a}8.28MB\\text{\uff09}$\n\n\u2193\u5947\u602a\u7684\u7a7a\u884c\n\n$\\color{white}\\colorbox{white}{\u6211\u662f\u4e0d\u4f1a\u544a\u8bc9\u4f60\u5438\u6c27\u624d\u8dd1\u4e86 340ms \u7684qwq}$",
        "postTime": 1585270910,
        "uid": 238421,
        "name": "A_Pikachu",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3448 \u3010[POI2006]MIS-Teddies\u3011"
    }
]
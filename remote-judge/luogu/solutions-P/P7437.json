[
    {
        "content": "\u9898\u76ee\u5927\u610f\uff1a\u7ed9\u5b9a $n$ \u70b9 $m$ \u8fb9\u65e0\u5411\u8fde\u901a\u56fe\uff0c\u968f\u673a\u4e00\u4e2a\u751f\u6210\u6811\uff0c\u6c42 $1$ \u5230 $n$ \u7684\u7b80\u5355\u8def\u5f84\u7ecf\u8fc7\u70b9 $z$ \u7684\u6982\u7387\u3002\u5bf9 $998244353$ \u53d6\u6a21\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$n\\le 20$\n\n\u89e3\u7b54\uff1a\n\n\u9996\u5148\u5f88\u663e\u7136\u751f\u6210\u6811\u4e2a\u6570\u53ef\u4ee5 $O(n^3)$ \u6c42\u51fa\uff0c\u56e0\u6b64\u6c42\u51fa $1\\sim n$ \u7ecf\u8fc7 $z$ \u7684\u603b\u751f\u6210\u6811\u4e2a\u6570\u5373\u53ef\u3002\n\n$f_{i,S}$ \u8868\u793a\u4ece $1$ \u5f00\u59cb\u7ecf\u8fc7\u70b9\u96c6 $S$ \u5230\u8fbe $i$ \u7684\u8def\u5f84\u6570\uff0c$g_{i,S}$ \u8868\u793a\u4ece $n$ \u5f00\u59cb\u7ecf\u8fc7\u70b9\u96c6 $S$ \u5230\u8fbe $i$ \u7684\u8def\u5f84\u6570\uff0c$h_{S}$ \u8868\u793a\u5c06 $S$ \u4e4b\u5916\u7684\u70b9\u5168\u90e8\u7f29\u6210\u4e00\u4e2a\u70b9\u4e4b\u540e\u7684\u751f\u6210\u6811\u4e2a\u6570\u3002\u5219\u6700\u7ec8\u7b54\u6848\u4e3a $\\displaystyle Ans=\\sum_{S_1\\cap S_2=\\{z\\}}f_{z,S_1}\\cdot g_{z,S_2}\\cdot h_{S-S_1-S_2}$\u3002\n\n\u53ef\u4ee5\u7528\u6734\u7d20\u7684 $O(3^n)$ \u7b97\u6cd5\u6216 $O(2^n\\cdot n^2)$ \u5b50\u96c6\u5377\u79ef\u5b9e\u73b0\u3002\n\n$f$ \u7684\u8ba1\u7b97\u65b9\u5f0f\uff1a$f_{i,S}$\uff1a$f_{1,\\{1\\}}=1$\uff1b$f_{i,S}=[i\\in S]\\sum_{j\\in S}e(j,i)\\cdot f_{j,S-\\{i\\}}$\u3002$g$ \u7684\u8ba1\u7b97\u65b9\u5f0f\u7c7b\u4f3c\u3002\n\n\u73b0\u5728\u6211\u4eec\u9762\u4e34\u4e86\u4e00\u4e2a\u95ee\u9898\uff1a\u5bf9\u6bcf\u4e00\u4e2a $S\\subset \\{1,2,\\ldots n\\}$ \u6c42\u51fa $h_S$\u3002\n\n\u6734\u7d20\u5b9e\u73b0\uff1a$O(2^n\\cdot n^3)$ \u9ad8\u65af\u6d88\u5143\u3002\n\n\u7cbe\u7ec6\u5b9e\u73b0\uff1a\u4f18\u5316\u9ad8\u65af\u6d88\u5143\u7684\u8fc7\u7a0b\u3002\u8003\u8651\u65b0\u52a0\u5165\u4e00\u4e2a\u70b9\u5bf9\u884c\u5217\u5f0f\u7684\u6539\u53d8\u5176\u5b9e\u662f\u52a0\u5165\u4e00\u884c\u4e00\u5217\uff0c\u5728\u9ad8\u65af\u6d88\u5143\u7684\u8fc7\u7a0b\u4e2d\u8bb0\u5f55\u884c\u53d8\u6362\u7684\u6b65\u9aa4\uff08$O(n^2)$\uff09\uff0c\u5219\u6bcf\u6b21\u52a0\u5165\u4e00\u884c\u4e00\u5217\u90fd\u81f3\u591a\u591a\u51fa $O(n)$ \u6b21\u884c\u53d8\u6362\uff0c\u53ef\u4ee5 $O(n^2)$ \u66f4\u65b0\u3002\u8fd9\u6837\u5373\u53ef\u7528 $h_S$ \u63a8\u51fa $h_{S\\cup \\{i\\}}$ \u7684\u7b54\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(2^n\\cdot n^2)$\u3002\n\n\uff08\u5b9e\u9645\u4e0a\u7531\u4e8e\u5e38\u6570\u539f\u56e0\uff0c\u540e\u8005\u4e0d\u4e00\u5b9a\u8dd1\u5f97\u8fc7\u524d\u8005\uff0c\u800c $O(2^n\\cdot n^3)$ \u7684\u7b97\u6cd5\u4e5f\u53ef\u4ee5\u901a\u8fc7\uff0c\u5e26 $3^n$ \u7684\u7b97\u6cd5\u80fd\u62ff $80$ \u5206\u3002\u6b22\u8fce\u5927\u795e\u5199\u51fa\u4e00\u4e9b\u5c0f\u5e38\u6570\u7684\u4ee3\u7801\uff0c\u7136\u540e\u628a\u8fd9\u9898\u52a0\u5f3a\u4e00\u4e0b\u3002\uff09",
        "postTime": 1613734454,
        "uid": 66287,
        "name": "\u6a31\u521d\u97f3\u6597\u6a61\u76ae",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 - T168872 \u65e2\u89c1\u541b\u5b50"
    },
    {
        "content": "\u5927\u5bb6\u597d\u8fd9\u91cc\u662f\u70b9\u540d\u653e\u8fc7\u7684 $\\Theta(n^32^n)$ \u505a\u6cd5\uff0c\u5176\u5b9e\u672c\u9898\u89e3\u7528\u610f\u8fd8\u662f\u7ed9\u8fd9\u9053\u9898\u5728\u9898\u89e3\u533a\u653e\u4e00\u4e2a\u80fd\u8fc7\u7684\u4ee3\u7801\u65b9\u4fbf\u5bf9\u62cd\n\n\u505a\u6cd5\u8fd8\u662f\u5f88\u7ecf\u5178\u7684\uff0c\u6982\u7387\u5206\u6bcd\u662f\u603b\u65b9\u6848\u6570\uff0c\u4f7f\u7528\u77e9\u9635\u6811\u5b9a\u7406\u53ef\u4ee5\u6c42\u89e3\uff0c\u5206\u5b50\u662f\u7ecf\u8fc7 $z$ \u7684\u751f\u6210\u6811\u6570\u91cf\n\n\u8bbe $f_{i,S}$ \u8868\u793a\u4ece $1$ \u5f00\u59cb $i$ \u7ed3\u675f\u7684\u4e00\u6761\u94fe\u4e0a\u7ecf\u8fc7\u4e86\u70b9\u96c6 $S$ \u7684\u65b9\u6848\u6570\uff0c$g_{i,S}$ \u540c\u7406\uff0c\u4e0d\u8fc7\u662f\u8868\u793a\u4ece $n$ \u5f00\u59cb\u7684\u8def\u5f84\u6570\n\n\u6ce8\u610f\u8fd9\u91cc\u7684\u5b9a\u4e49\u662f **\u4e00\u6761\u94fe** \u7684\u65b9\u6848\u6570\uff0c\u5373\u4e0d\u80fd\u91cd\u590d\u7ecf\u8fc7\u4e00\u4e2a\u70b9\uff0c\u8fd9\u6837\u7684\u5b9a\u4e49\u5728\u540e\u9762\u53ef\u4ee5\u907f\u514d\u91cd\u590d\u8ba1\u7b97\n\n\u8fd9\u4e24\u4e2a dp \u503c\u6c42\u89e3\u662f\u5bb9\u6613\u7684\uff1a\u679a\u4e3e\u72b6\u6001\u5e76\u679a\u4e3e\u4e0a\u4e00\u4e2a\u70b9\uff0c\u7cfb\u6570\u662f\u8fd9\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u8fb9\u6570\uff0c\u5373 `dp[i][S]+=dp[j][S^(1<<i)]*edge[i][j];`\n\n\u8ba1\u7b97\u51fa $f,g$ \u4e4b\u540e\u53ef\u4ee5\u5728 $z$ \u5904\u5408\u5e76 \u4ea4\u96c6\u6709\u4e14\u4ec5\u6709 $\\{z\\}$ \u7684\u4e24\u4e2a\u72b6\u6001\u5f97\u5230\u4e00\u6761\u94fe\uff0c\u4f7f\u7528\u5b50\u96c6\u5377\u79ef\u505a\u5230 $\\Theta(n^22^n)$ \u590d\u6742\u5ea6\n\n\u5269\u4e0b\u7684\u90e8\u5206\u662f\u8ba1\u7b97\u52a0\u5165\u5176\u4ed6\u70b9\u7684\u65b9\u6848\n\n\u6700\u76f4\u63a5\u7684\u60f3\u6cd5\u5c31\u662f\u5bf9\u4e8e\u5c06\u6bcf\u4e2a\u88ab\u5408\u5e76\u7684\u70b9\u96c6\u89c6\u4f5c\u4e00\u4e2a\u70b9\uff0c**\u5176\u5b83\u70b9\u8fde\u5411\u5b83\u7684\u8fb9\u7684\u6570\u91cf\u662f\u8fde\u5411\u96c6\u5408\u5185\u70b9\u7684\u8fb9\u6570\u7684\u548c**\uff0c\u76f4\u63a5\u505a\u77e9\u9635\u6811\u5b9a\u7406\uff0c\u590d\u6742\u5ea6 $\\Theta(n^32^n)$\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u5408\u6cd5\u7684\u751f\u6210\u6811\uff0c\u5176 $1\\sim n$ \u7684\u94fe\u662f\u56fa\u5b9a\u7684\uff0c\u5c06 $z$ \u89c6\u4e3a\u6811\u6839\u540e\u5176\u5b83\u70b9\u7684\u5f62\u6001\u4e5f\u662f\u56fa\u5b9a\u7684\uff0c\u4e0d\u96be\u53d1\u73b0\u90fd\u88ab\u5728\u679a\u4e3e $1\\sim n$ \u94fe\u4e0a\u70b9\u96c6\u662f\u8ba1\u7b97\u4e14\u53ea\u88ab\u8ba1\u7b97\u4e86\u4e00\u6b21\uff0c\u662f\u4e0d\u91cd\u4e0d\u6f0f\u7684\n\n\u6807\u7b97\u7684\u4f18\u5316\u662f\u4f18\u5316\u9ad8\u65af\u6d88\u5143\u7684\u8fc7\u7a0b\uff0c\u5c06\u6bcf\u4e2a\u72b6\u6001\u5bf9\u5e94\u7684\u884c\u53d8\u6362\u5b58\u4e0b\u6765\uff0c\u65b0\u52a0\u5165\u4e00\u884c\u4e00\u5217\u540e\u6c42\u884c\u5217\u5f0f\u53ef\u4ee5\u51cf\u5c11\u6d88\u5143\u90e8\u5206\u7684\u8ba1\u7b97\u5197\u4f59\uff0c\u8fd8\u662f\u5f88\u5de7\u5999\u7684\uff0c\u4f46\u662f\u6211\u600e\u4e48\u5408\u8ba1\u4e5f\u4e0d\u77e5\u9053\u548b\u5b58\u50a8\uff0c\u6240\u4ee5\u5c31\u4e0d\u4f1a\u5199\n\n\u5199\u7684\u70b9\u540d\u653e\u8fc7\u7684\u505a\u6cd5\u6709\u4ee5\u4e0b\u51e0\u4e2a\u5408\u7406\u7684\u5361\u5e38\u65b9\u5f0f\uff1a\n\n- \u81ea\u5df1\u5377\u79ef\u4e2d `c[i+j]+=a[i]*b[j]` \uff0c\u679a\u4e3e $i$ \u7684\u65f6\u5019\u68c0\u67e5 $a_i$ \u662f\u5426\u6709\u503c\n\n- \u505a\u6bcf\u4e2a\u72b6\u6001\u7684\u77e9\u9635\u6811\u5b9a\u7406\u524d\u5148\u5224\u65ad\u5bf9\u5e94\u7684\u5b50\u96c6\u5377\u79ef\u7684\u7ed3\u679c\u662f\u5426\u4e0d\u4e3a $0$\n\n- \u505a dp \u65f6\u679a\u4e3e\u72b6\u6001\u5185\u90e8\u7684\u70b9\u5c3d\u91cf\u5148\u5b58\u4e0b\u6765\uff0c\u800c\u4e0d\u662f\u4ece $1\\sim n$ \u4e00\u4e2a\u4e00\u4e2a\u6765\n\n- \u5b50\u96c6\u5377\u79ef\u7684\u5f62\u5f0f\u662f\u4ea4\u96c6\u4e3a $z$\uff0c\u90a3\u4e48\u76f4\u63a5\u7701\u7565\u505a $n=19$ \u7684 FWT\n\n\u7a7a\u8361\u7684\u96e8\u5df7\uff0c\u84ec\u677e\u7684\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define sec second\n#define fir first\n#define pb push_back\n#define rep(i,a,b) for(int i=a;i<=b;++i) \n#define Down(i,a,b) for(int i=a;i>=b;--i)\ntemplate<typename T>inline void ckmax(T &x,T y){x=x<y?y:x; return ;}\ntemplate<typename T>inline void ckmin(T &x,T y){x=x<y?x:y; return ;}\nnamespace FastIO{\n    template<typename T=int>inline T read(){\n        T res=0,f=1; char k;\n        while(!isdigit(k=getchar())) if(k=='-') f=-1;\n        while(isdigit(k)) res=res*10+k-'0',k=getchar();\n        return res*f;\n    }\n    char OPUT[100];\n    template<typename T>inline void print(T x){\n        if(x<0) putchar('-'),x=-x; \n        int cnt=0; do OPUT[++cnt]=x%10,x/=10; while(x); \n        Down(i,cnt,1) putchar(OPUT[i]+'0'); putchar('\\n'); return ;\n    }\n}using namespace FastIO;\nconst int mod=998244353;\ninline int add(int x,int y,int Mod=mod){return x+y>=Mod?x+y-Mod:x+y;}\ninline int del(int x,int y,int Mod=mod){return x-y<0?x-y+Mod:x-y;}\ninline int mul(int x,int y,int Mod=mod){return 1ll*x*y-1ll*x*y/Mod*Mod;}\ninline void ckadd(int &x,int y,int Mod=mod){x=x+y>=Mod?x+y-Mod:x+y;}\ninline void ckdel(int &x,int y,int Mod=mod){x=x-y<0?x-y+Mod:x-y;}\ninline void ckmul(int &x,int y,int Mod=mod){x=1ll*x*y-1ll*x*y/Mod*Mod;}\ninline int ksm(int x,int y,int Mod=mod){\n    int res=1; \n    for(;y;y>>=1,ckmul(x,x,Mod)) if(y&1) ckmul(res,x,Mod); \n    return res;\n}\nconst int N=21,SZ=1<<20;\nint Gra[N][N],a[N][N],n,m,z,S,dp[SZ][N];\ninline int Guass(int n){\n    int ans=1;\n    for(int i=1;i<n;++i){\n        if(!a[i][i]){\n            for(int j=i+1;j<n;++j){\n                if(a[j][i]){\n                    swap(a[i],a[j]);\n                    ans=del(0,ans);\n                    break;\n                }\n            }\n        }\n        if(!a[i][i]) return 0;\n        ckmul(ans,a[i][i]); \n        int inv=ksm(a[i][i],mod-2);\n        for(int j=i+1;j<n;++j){\n            int tmp=mul(a[j][i],inv);\n            for(int k=i;k<n;++k) ckdel(a[j][k],mul(a[i][k],tmp));\n        }\n    } \n    return ans;\n}\nint bit[SZ],id[SZ];\nvector<int> nds[SZ];\ninline int calc(int i){\n    int lef=i&((1<<(z-1))-1),rig=(i>>z)<<(z-1);\n    return lef|rig;\n}\nstruct Poly{\n    int a[21];\n    inline void init(){memset(a,0,sizeof(a)); return ;}\n    Poly operator +(const Poly &p)const{\n        Poly res; res.init(); \n        rep(i,0,n-1) res.a[i]=add(a[i],p.a[i]);\n        return res;\n    }\n    Poly operator -(const Poly &p)const{\n        Poly res; res.init();\n        rep(i,0,n-1) res.a[i]=del(a[i],p.a[i]);\n        return res;\n    }\n    Poly operator *(const Poly &p)const{\n        Poly res; res.init();\n        rep(i,0,n-1) if(a[i]) rep(j,0,n-1-i) ckadd(res.a[i+j],mul(a[i],p.a[j]));\n        return res;\n    }\n}F[SZ],G[SZ];\ninline void FWT(Poly *f,int lim,int opt){\n    for(int p=2;p<=lim;p<<=1){\n        int len=p>>1;\n        for(int k=0;k<lim;k+=p){\n            for(int l=k;l<k+len;++l){\n                if(opt==1) f[l+len]=f[l+len]+f[l];\n                else f[l+len]=f[l+len]-f[l];\n            }\n        }\n    } return ;\n}\ninline void DP(Poly *F){\n    for(int st=2;st<=S;++st){\n        if(dp[1][1]&&(!(st&1))) continue;\n        if(dp[1<<(n-1)][1]){st=1<<(n-1); continue;}\n        for(auto t1:nds[st]){\n            for(auto t2:nds[st]){\n                ckadd(dp[st][t2],mul(dp[st^(1<<(t2-1))][t1],Gra[t1][t2]));\n            }\n        }\n    } \n    rep(i,1,S) if(dp[i][z]){\n        int New=calc(i);\n        F[New].a[bit[New]]=dp[i][z];\n    } \n    FWT(F,S/2+1,1);\n    memset(dp,0,sizeof(dp));\n    return ;\n}\nsigned main(){\n    S=1<<(n=read()); --S; m=read(); z=read();\n    for(int i=1;i<=n;++i) id[1<<(i-1)]=i;\n    for(int i=1;i<=m;++i){\n        int u=read(),v=read();\n        Gra[u][v]++; Gra[v][u]++;\n    }\n    for(int i=1;i<=S;++i){\n        bit[i]=bit[i>>1]+(i&1);\n        nds[i]=nds[i^(i&(-i))];\n        nds[i].pb(id[i&(-i)]);\n    }\n    dp[1][1]=1; DP(F);\n    dp[1<<(n-1)][n]=1; DP(G);\n    S>>=1;\n    for(int i=0;i<=S;++i) F[i]=F[i]*G[i],G[i].init();\n    FWT(F,S+1,-1);\n    int ans=0;\n    S=S<<1|1;\n    rep(i,1,S){\n        for(auto x:nds[S^i]){\n            int lb=i&(-i);\n            dp[i][x]=dp[i-lb][x]+Gra[x][id[lb]];\n        }\n    }\n    rep(i,0,S) if(!(i>>(z-1)&1)){\n        int pos=(S>>1)^calc(i);\n        if(!F[pos].a[bit[pos]]) continue;\n        memset(a,0,sizeof(a));\n        rep(j,1,bit[i]) rep(k,j+1,bit[i]){\n            int edg=Gra[nds[i][j-1]][nds[i][k-1]];\n            a[j][k]=a[k][j]=del(0,edg);\n            ckadd(a[k][k],edg);\n            ckadd(a[j][j],edg);\n        }\n        rep(j,1,bit[i]){\n            int edg=dp[S^i][nds[i][j-1]];\n            a[j][bit[i]+1]=a[bit[i]+1][j]=del(0,edg);\n            ckadd(a[j][j],edg);\n            ckadd(a[bit[i]+1][bit[i]+1],edg);\n        }\n        ckadd(ans,mul(F[pos].a[bit[pos]],Guass(bit[i]+1)));\n    }\n    rep(i,1,n) a[i][i]=0;\n    rep(i,1,n) rep(j,i+1,n){\n        a[i][j]=a[j][i]=del(0,Gra[i][j]);\n        ckadd(a[i][i],Gra[i][j]);\n        ckadd(a[j][j],Gra[i][j]);\n    }\n    print(mul(ksm(Guass(n),mod-2),ans));\n    return 0;\n}\n```",
        "postTime": 1640073411,
        "uid": 97448,
        "name": "yspm",
        "ccfLevel": 9,
        "title": "Luogu P7437 Solution"
    }
]
[
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4846)\n# Description\n\u5bf9\u4e8e\u4e00\u4e2a\u5e8f\u5217 A \uff0c\u6211\u4eec\u5b9a\u4e49 $f(A,k)$ \u8868\u793a\u5728\u6a21 $k$ \u610f\u4e49\u4e0b A \u5e8f\u5217\u5bf9\u4e8e\u4e00\u6bb5\u8fde\u7eed\u533a\u95f4 $+1$ \u6216 $-1$ \u4f7f\u5f97 A \u5e8f\u5217\u6240\u6709\u5143\u7d20\u7686\u4e3a $0$ \u7684\u6700\u5c11\u64cd\u4f5c\u6b65\u6570\u3002\n\n\u73b0\u5728\u7ed9\u51fa\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684 $a_{1,2,...,n}$ \u5e8f\u5217\uff0c\u6709 $m$ \u6b21\u67e5\u8be2\uff0c\u6bcf\u6b21\u7ed9\u51fa $l,r,k$\uff0c\u8868\u793a\u9700\u8981\u67e5\u8be2 $f([l,r],k)$\u3002\n\n$n\\le 2\\times 10^5,m\\le 10^5,\\max\\{a_1,a_2,...,a_n\\}<k\\le 2^{30}$\n# Solution\n>\n\u51fa\u9898\u4eba\uff1a\u552f\u4e00\u4e00\u9053\u6570\u636e\u7ed3\u6784\u9898\uff0c\u6240\u4ee5\u601d\u8def\u4e0d\u662f\u90a3\u4e48\u96be\u3002\u53ea\u8981\u4f60\u4f1a50\u5206\uff0c\u5c31\u53ef\u4ee5\u8f7b\u677e\u4f18\u5316\u5230100\u5206\u3002\n\n\u6211\u8868\u793a\u6211\u2122\u60f3\u4e0d\u5230 $50$ \u5206\u505a\u6cd5\uff0c\u770b\u4e86\u9898\u89e3\u4e4b\u540e\u624d\u604d\u7136\u5927\u609f\u3002\n\n\u8fd9\u7bc7\u9898\u89e3\u53c8\u8ddf\u5b98\u65b9\u9898\u89e3\u6709\u6240\u4e0d\u540c\uff0c\u4f46\u662f\u6574\u4f53\u601d\u8def\u5dee\u4e0d\u591a\uff0c\u4ee3\u7801\u5b9e\u73b0\u8981\u7b80\u5355\u4e00\u4e9b\u3002\n\n\u6211\u4eec\u9996\u5148\u8003\u8651\u4e00\u4e2a\u5e8f\u5217\u7684\u60c5\u51b5\u3002\u6211\u4eec\u5148\u5728\u9996\u5c3e\u52a0 $0$\u3002\u5047\u5982\u6ca1\u6709\u6a21 $k$ \u7684\u6761\u4ef6\u7684\u8bdd\uff0c\u6211\u4eec\u8bbe $b_i=a_i-a_{i-1}$\uff0c\u90a3\u4e48\u95ee\u9898\u5c31\u76f8\u5f53\u4e8e $\\sum b_i=0$\uff0c\u6bcf\u6b21\u53ef\u4ee5\u5bf9\u4e8e $b_i\\to b_i+1,b_j\\to b_j-1(i<j)$\uff0c\u95ee\u6700\u5c0f\u6b65\u6570\u4f7f\u5f97\u6240\u6709 $b_i$ \u7686\u4e3a $0$ \u3002\n\n\u4e0d\u96be\u770b\u51fa\uff0c\u56e0\u4e3a $\\sum b_i=0$\uff0c\u6240\u4ee5\u5982\u679c\u73b0\u5728\u8fd8\u6ca1\u6709\u6ee1\u8db3\u6761\u4ef6\uff0c\u90a3\u4e48\uff0c\u4e00\u5b9a\u6709 $b_i>0$ \u4e14 $b_j<0$\uff0c\u6240\u4ee5\u53ef\u4ee5\u60f3\u5230\uff0c\u7b54\u6848\u5c31\u662f $(\\sum|b_i|)/2$ \u3002\n\n\u8003\u8651\u6709\u6a21 $k$ \u7684\u6761\u4ef6\uff0c\u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u6210\u662f\u4e00\u5f00\u59cb\u5e8f\u5217\u67d0\u4e9b\u503c $+k$ \u6216 $-k$\u3002\u53ef\u4ee5\u770b\u51fa\uff0c$\\sum b_i$ \u4ecd\u9700\u7b49\u4e8e $0$\uff0c\u6240\u4ee5\u4f60\u4e00\u4e2a\u6570 $+k$\uff0c\u90a3\u4e48\u5fc5\u6709\u53e6\u5916\u4e00\u4e2a\u6570 $-k$\u3002\u53e6\u5916\u53ef\u4ee5\u770b\u51fa\u7684\u662f\uff0c\u5bf9\u4e8e $-a$\uff0c\u5982\u679c\u4f60\u52a0 $k$\uff0c\u90a3\u4e48\u8d21\u732e\u5c31\u4f1a\u51cf\u5c11 $2a-k$\uff0c\u5bf9\u4e8e $a$\uff0c\u5982\u679c\u4f60\u51cf $k$ \uff0c\u90a3\u4e48\u8d21\u732e\u4e5f\u4f1a\u51cf\u5c11 $2a-k$\u3002\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u53ef\u4ee5\u505a\u5230 $50$ \u5206\u4e86\uff0c\u5c31\u662f\u76f4\u63a5\u6bcf\u6b21\u76f4\u63a5\u628a $2a-k$ \u63d0\u51fa\u6765\u6392\u4e2a\u5e8f\u6c42\u524d\u7f00\u548c\uff0c\u7136\u540e\u6c42\u4e2a\u6700\u5927\u503c\u5373\u53ef\u3002\n\n\u8003\u8651\u4f18\u5316\uff0c\u4e0d\u96be\u770b\u51fa\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e3b\u5e2d\u6811\u7ef4\u62a4\u4e00\u4e2a\u533a\u95f4 $|2a|$ \u7684\u524d $s$ \u5927\u7684\u548c\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u6211\u4eec\u77e5\u9053\u6211\u4eec\u8981\u52a0\u591a\u5c11\u6b21 $s$ \uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8ba1\u7b97\u51fa\u8d21\u732e\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\u7684\u53e6\u4e00\u4e2a\u6027\u8d28\u662f\uff0c\u8fd9\u4e2a\u8d21\u732e\u968f $s$ \u7684\u53d8\u5316\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u51f8\u51fd\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u4e8c\u5206\u9876\u70b9\uff0c\u8bc1\u660e\u7684\u8bdd\u5e94\u8be5\u53ef\u4ee5\u611f\u6027\u7406\u89e3\u4e00\u4e0b\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n\\log w+m\\log n\\log w)$\uff0c\u5176\u4e2d $w$ \u662f\u503c\u57df\uff0c$\\log w=30$\u3002\n# Code for 50 pts\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define Int register int\n#define int long long\n#define MAXN 200005\n\ntemplate <typename T> inline void read (T &t){t = 0;char c = getchar();int f = 1;while (c < '0' || c > '9'){if (c == '-') f = -f;c = getchar();}while (c >= '0' && c <= '9'){t = (t << 3) + (t << 1) + c - '0';c = getchar();} t *= f;}\ntemplate <typename T,typename ... Args> inline void read (T &t,Args&... args){read (t);read (args...);}\ntemplate <typename T> inline void write (T x){if (x < 0){x = -x;putchar ('-');}if (x > 9) write (x / 10);putchar (x % 10 + '0');}\n\nint n,m,A[MAXN],pre1[MAXN],pre2[MAXN];\n\n#define abs(x) ((x)<0?-(x):(x))\nint Count (int L,int R,int K){\n\tint ans = abs (A[L]) + abs (A[R]);\n\tfor (Int i = L + 1;i <= R;++ i) ans += abs (A[i] - A[i - 1]);\n\tint tot1 = 0,tot2 = 0;\n\tif (A[L] < 0) pre1[++ tot1] = 2 * abs(A[L]) - K;else pre2[++ tot2] = 2 * abs(A[L]) - K;\n\tif (A[R] > 0) pre1[++ tot1] = 2 * abs(A[R]) - K;else pre2[++ tot2] = 2 * abs(A[R]) - K;\n\tfor (Int i = L + 1;i <= R;++ i) \n\t\tif (A[i] - A[i - 1] < 0) pre1[++ tot1] = 2 * abs(A[i] - A[i - 1]) - K;\n\t\telse pre2[++ tot2] = 2 * abs (A[i] - A[i - 1]) - K; \n\tsort (pre1 + 1,pre1 + tot1 + 1,[](int a,int b){return a > b;}),\n\tsort (pre2 + 1,pre2 + tot2 + 1,[](int a,int b){return a > b;});\n\tfor (Int i = 1;i <= tot1;++ i) pre1[i] += pre1[i - 1];\n\tfor (Int i = 1;i <= tot2;++ i) pre2[i] += pre2[i - 1];\n\tint res = ans;\n\tfor (Int i = 1;i <= tot1 && i <= tot2;++ i) res = min (res,ans - pre1[i] - pre2[i]);\n\treturn res >> 1;\n}\n\nsigned main(){\n\tread (n,m);\n\tfor (Int i = 1;i <= n;++ i) read (A[i]);\n\tfor (Int i = 1,l,r,k;i <= m;++ i) read (l,r,k),write (Count (l,r,k)),putchar ('\\n');\n\treturn 0;\n}\n```\n# Code for 100 pts\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define Int register int\n#define int long long\n#define MAXN 200005\n\ntemplate <typename T> inline void read (T &t){t = 0;char c = getchar();int f = 1;while (c < '0' || c > '9'){if (c == '-') f = -f;c = getchar();}while (c >= '0' && c <= '9'){t = (t << 3) + (t << 1) + c - '0';c = getchar();} t *= f;}\ntemplate <typename T,typename ... Args> inline void read (T &t,Args&... args){read (t);read (args...);}\ntemplate <typename T> inline void write (T x){if (x < 0){x = -x;putchar ('-');}if (x > 9) write (x / 10);putchar (x % 10 + '0');}\n\nint n,m,inf,A[MAXN],pre[MAXN];\n\n#define abs(x) ((x)<0?-(x):(x))\n\nstruct Segment{\n#define LOGN 105\n\tint tot,rt[MAXN],siz[MAXN * LOGN],sum[MAXN * LOGN],son[MAXN * LOGN][2];\n\tvoid modify (int &x,int y,int l,int r,int pos){\n\t\tx = ++ tot,siz[x] = siz[y] + 1,sum[x] = sum[y] + pos,son[x][0] = son[y][0],son[x][1] = son[y][1];\n\t\tif (l == r) return ;\n\t\tint mid = (l + r) >> 1;\n\t\tif (pos <= mid) modify (son[x][0],son[y][0],l,mid,pos);\n\t\telse modify (son[x][1],son[y][1],mid + 1,r,pos);\n\t}\n\tint query (int x,int y,int l,int r,int k,int pos){\n\t\tif (!k) return 0;\n\t\tif (l == r) return k * l;\n\t\tint mid = (l + r) >> 1,alls = siz[son[y][1]] - siz[son[x][1]] + (mid < pos && pos <= r);\n\t\tif (alls <= k) return query (son[x][0],son[y][0],l,mid,k - alls,pos) + sum[son[y][1]] - sum[son[x][1]] + (mid < pos && pos <= r) * pos;\n\t\telse return query (son[x][1],son[y][1],mid + 1,r,k,pos);\n\t}\n}Tree[2];\n\nint Count (int l,int r,int k,int S){\n\tint ans = (pre[r] - pre[l] + A[l] + A[r]) / 2;\n\treturn S * k + ans - Tree[0].query (Tree[0].rt[l],Tree[0].rt[r],0,inf,S,A[r]) - Tree[1].query (Tree[1].rt[l],Tree[1].rt[r],0,inf,S,A[l]); \n}\n\nint Work (int l,int r,int K){\n\tint tot1 = Tree[0].siz[Tree[0].rt[r]] - Tree[0].siz[Tree[0].rt[l]] + 1,tot2 = Tree[1].siz[Tree[1].rt[r]] - Tree[1].siz[Tree[1].rt[l]] + 1;\n\tint L = 0,R = min (tot1,tot2),ans = 0;\n\twhile (L <= R){\n \t\tint mid = (L + R) >> 1;\n\t\tif (mid == 0 || Count (l,r,K,mid - 1) >= Count (l,r,K,mid)) ans = mid,L = mid + 1;\n\t\telse R = mid - 1;\n\t}\n\treturn Count (l,r,K,ans);\n}\n\nsigned main(){\n//\tfreopen (\"data.in\",\"r\",stdin);\n//\tfreopen (\"WA.out\",\"w\",stdout);\n\tread (n,m),inf = 1 << 30;\n\tfor (Int i = 1;i <= n;++ i) read (A[i]);\n\tfor (Int i = 2,val;i <= n;++ i){\n\t\tval = abs (A[i] - A[i - 1]),pre[i] = pre[i - 1] + abs (A[i] - A[i - 1]);\n\t\tif (A[i] >= A[i - 1]) Tree[0].rt[i] = Tree[0].rt[i - 1],Tree[1].modify (Tree[1].rt[i],Tree[1].rt[i - 1],0,inf,val);\n\t\telse Tree[1].rt[i] = Tree[1].rt[i - 1],Tree[0].modify (Tree[0].rt[i],Tree[0].rt[i - 1],0,inf,val); \n\t}\n\tfor (Int i = 1,l,r,k;i <= m;++ i) read (l,r,k),write (Work (l,r,k)),putchar ('\\n');\n\treturn 0;\n}\n```",
        "postTime": 1612581840,
        "uid": 124781,
        "name": "Walking_Dead",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4846 \u3010LJJ\u7231\u6570\u4e66\u3011"
    },
    {
        "content": "##### [\u539f\u9898\u94fe\u63a5](https://www.luogu.com.cn/problem/P4846)\n\n---\n\n\u770b\u5230\u533a\u95f4\u4fee\u6539\uff0c\u6211\u4eec\u9996\u5148\u60f3\u5230\u5c06\u5176\u5dee\u5206\u3002\n\n\u90a3\u4e48\u95ee\u9898\u8f6c\u53d8\u6210\uff1a\n\n\u5728\u4e00\u4e2a\u5e8f\u5217\u4e2d\uff0c\u6bcf\u6b21\u5c06\u4e00\u4e2a\u5143\u7d20 $+1$ \u5e76\u5c06\u53e6\u4e00\u4e2a\u5143\u7d20 $-1$\uff0c\u6216\u8005\u5c06\u4e00\u4e2a\u5143\u7d20 $+1$ \u6216 $-1$\uff0c\u4f7f\u5176\u80fd\u591f\u6ee1\u8db3\u6240\u6709\u5143\u7d20\u4e3a\u5bf9 $k$ \u53d6\u6a21\u4e3a $0$\u3002\n\n\u6211\u4eec\u8bbe $a$ \u7684\u5dee\u5206\u5e8f\u5217\u4e3a $b$\uff0c\u53ef\u4ee5\u53d1\u73b0\uff0c\u6bcf\u6b21\u8be2\u95ee $l$\u3001$r$ \u6240\u95ee\u7684\u5e8f\u5217\uff0c\u5c31\u662f $a_l,b_l+1,\\cdots,b_r$\u3002\n\n\u7531\u4e8e $0\\leq a_i<k$ \u800c $-k<b_i<k$\uff0c\u6240\u4ee5\u6700\u540e\u5143\u7d20\u7684\u503c\u53ea\u6709\u53ef\u80fd\u662f $-k$\u3001$0$ \u6216 $k$\u3002\n\n\u6211\u4eec\u8bbe\u4e0a\u9762\u8be2\u95ee\u7684\u5e8f\u5217\u4e3a $c$\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u6211\u4eec\u4e00\u5b9a\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a\u5206\u754c\u70b9 $mid$\uff0c\u4f7f\u5f97\u5bf9\u4e8e $0<c_i\\leq mid$  \u548c $-k\\leq c_i\\leq-k+mid$ \u5206\u522b\u6700\u7ec8\u53d8\u6210 $0$ \u548c $-k$\uff0c\u800c\u5bf9\u4e8e $mid<c_i\\leq k$ \u548c $-k+mid<c_i<0$ \u7684\u5143\u7d20\u5206\u522b\u53d8\u6210 $0$ \u548c $k$\u3002\n\n\u7406\u7531\u5982\u4e0b\uff1a\n\n\u6211\u4eec\u628a $c$ \u4e2d\u7684\u6240\u6709\u5143\u7d20\u5bf9 $k$ \u53d6\u6a21\u4e4b\u540e\u653e\u5728\u6570\u8f74\u4e0a\uff0c\u5982\u679c\u6709\u4e24\u4e2a\u5143\u7d20 $u$\u3001$v$ \u6ee1\u8db3 $u$ \u79bb\u5de6\u8fb9\u7684 $0$ \u8fd1\uff0c$v$ \u79bb\u53f3\u8fb9\u7684 $k$ \u8fd1\uff0c\u6211\u4eec\u5f53\u7136\u8981\u4f7f $u$ \u6210\u4e3a $0$\uff0c$v$ \u6210\u4e3a $k$\u3002\n\n\u4e8c\u5206\u627e\u5230\u5206\u754c\u7ebf\u4e4b\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff1a\n\n\u6700\u7ec8\u7684\u7b54\u6848\u4e3a $max(\\sum_{c_i\\bmod k\\leq mid} c_i\\bmod k,\\sum_{c_i \\bmod k>mid} k-(c_i\\bmod k))$\u3002\n\n\u4e5f\u5c31\u662f\u5c06\u4e8c\u8005\u6b65\u6570\u7684\u516c\u5171\u90e8\u5206\u914d\u5bf9\uff0c\u5269\u4e0b\u7684\u90e8\u5206\u5355\u72ec\u64cd\u4f5c\u3002\n\n\u90a3\u4e48\u6700\u4f18\u7684\u5206\u754c\u7ebf\u5e94\u5f53\u8ba9\u4e24\u4fa7\u7684\u6b65\u6570\u5c3d\u53ef\u80fd\u76f8\u7b49\u3002\n\n\u8fd9\u6837\uff0c\u6bcf\u6b21\u8be2\u95ee\u5c31\u53ef\u4ee5\u7528\u4e8c\u5206\u548c\u53ef\u6301\u4e45\u5316\u6743\u503c\u7ebf\u6bb5\u6811\u5b9e\u73b0\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log^2 n)$\u3002\n\n##### \u5b9e\u73b0\u7ec6\u8282\n\n\u7b2c\u4e00\u4e2a\u5143\u7d20 $a_l$ \u9700\u8981\u5355\u72ec\u8ba1\u7b97\u3002\n\n\u627e\u5230\u5206\u754c\u7ebf\u4e4b\u540e\uff0c\u6ce8\u610f\u5206\u754c\u7ebf\u4e0a\u7684\u503c\u76f8\u540c\u7684\u5143\u7d20\u53ef\u4ee5\u88ab\u5206\u522b\u5212\u5206\u5230\u5de6\u53f3\u4e24\u4fa7\uff0c\u8fd9\u4e5f\u8981\u5355\u72ec\u8ba1\u7b97\u3002\n\n### Code\n\n```cpp\n#include<cstdio>\n#define mid ((l+r)/2)\n#define v(x) (x+HALF)\nusing namespace std;\ntypedef long long ll;\nconst ll SIZE=2e5+10,EXTRA=1e7+10,HALF=1e9,MAXV=2e9;\ninline ll read()\n{\n    ll x=0;char ch=getchar();\n    while(ch<'0'||ch>'9')ch=getchar();\n    while(ch>='0'&&ch<='9')x=(x*10)+(ch^48),ch=getchar();\n    return x;\n}\ninline ll abs(ll x){return x>0?x:-x;}\nll n,m,a[SIZE],b[SIZE];\nll root[SIZE],ls[EXTRA],rs[EXTRA],sum[EXTRA],cnt[EXTRA],sizep;\ninline ll copy(ll thisp){return sizep++,ls[sizep]=ls[thisp],rs[sizep]=rs[thisp],sum[sizep]=sum[thisp],cnt[sizep]=cnt[thisp],sizep;}\ninline void pushup(ll thisp){sum[thisp]=sum[ls[thisp]]+sum[rs[thisp]],cnt[thisp]=cnt[ls[thisp]]+cnt[rs[thisp]];}\nll modify(ll thisp,ll l,ll r,ll t,ll val)\n{\n    thisp=copy(thisp);\n    if(l==r)return sum[thisp]+=val,cnt[thisp]++,thisp;\n    return t<=mid?ls[thisp]=modify(ls[thisp],l,mid,t,val):rs[thisp]=modify(rs[thisp],mid+1,r,t,val),pushup(thisp),thisp;\n}\ninline ll modify(ll thisp,ll t,ll val){return modify(thisp,1,MAXV,t,val);}\nll getsum(ll u,ll v,ll l,ll r,ll L,ll R)\n{\n    if(!v)return 0;\n    if(L<=l&&r<=R)return sum[v]-sum[u];\n    if(R<=mid)return getsum(ls[u],ls[v],l,mid,L,R);\n    if(mid<L)return getsum(rs[u],rs[v],mid+1,r,L,R);\n    return  getsum(ls[u],ls[v],l,mid,L,R)+getsum(rs[u],rs[v],mid+1,r,L,R);\n}\ninline ll getsum(ll u,ll v,ll L,ll R){return getsum(u,v,1,MAXV,L,R);}\nll getcnt(ll u,ll v,ll l,ll r,ll L,ll R)\n{\n    if(!v)return 0;\n    if(L<=l&&r<=R)return cnt[v]-cnt[u];\n    if(R<=mid)return getcnt(ls[u],ls[v],l,mid,L,R);\n    if(mid<L)return getcnt(rs[u],rs[v],mid+1,r,L,R);\n    return  getcnt(ls[u],ls[v],l,mid,L,R)+getcnt(rs[u],rs[v],mid+1,r,L,R);\n}\ninline ll getcnt(ll u,ll v,ll L,ll R){return getcnt(u,v,1,MAXV,L,R);}\ninline ll getpre(ll u,ll v,ll t,ll k)\n{\n    if(t<=0)return 0;\n    return getsum(u,v,v(0),v(t))+getsum(u,v,v(-k),v(t-k))+k*getcnt(u,v,v(-k),v(-k+t));\n}\ninline ll getsuf(ll u,ll v,ll t,ll k)\n{\n    if(t>k)return 0;\n    return k*getcnt(u,v,v(t),v(k))-getsum(u,v,v(t),v(k))-getsum(u,v,v(t-k),v(-1));\n}\ninline ll div(ll x,ll y){return x%y==0?x/y:x/y+1;}\ninline ll min(ll x,ll y){return x<y?x:y;}\ninline ll max(ll x,ll y){return x>y?x:y;}\nint main()\n{\n    n=read(),m=read();\n    for(ll i=1;i<=n;i++)a[i]=read(),b[i]=a[i]-a[i-1],root[i]=modify(root[i-1],v(b[i]),b[i]);\n    for(ll i=1,l,r,ans,L,R,K,res,t1,t2,tmp,prt;i<=m;i++)\n    {\n        L=read(),R=read(),K=read(),ans=l=0,r=K;\n        while(l<=r)\n        {\n            res=getsuf(root[L],root[R],mid+1,K)-getpre(root[L],root[R],mid,K);\n            if(a[L]<=mid)res-=a[L];\n            else res+=K-a[L];\n            if(res>=0)ans=mid,l=mid+1;\n            else r=mid-1;\n        }\n        t1=getpre(root[L],root[R],ans,K),t2=getsuf(root[L],root[R],ans+1,K);\n        if(a[L]<=ans)t1+=a[L];\n        else t2+=K-a[L];\n        prt=max(t1,t2);\n        tmp=div(t2-t1,K);\n        prt=min(prt,max(t1+tmp*(ans+1),t2-tmp*(K-(ans+1))));\n        printf(\"%lld\\n\",prt);\n    }\n    return 0;\n}\n```\n\n",
        "postTime": 1668230939,
        "uid": 327355,
        "name": "FQ04gty",
        "ccfLevel": 0,
        "title": "LJJ\u7231\u6570\u4e66"
    }
]
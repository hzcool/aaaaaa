[
    {
        "content": "## Description\n\n\u5bf9\u4e8e\u7b49\u5f0f $a_1x_1 + a_2x_2 + \\cdots + a_nx_n = B\\ \\left(B \\in \\left[l,r \\right] \\right)$\uff0c\u5df2\u77e5 $n\\ (1 \\leq n \\leq 12)$\uff0c$a_i\\ (0 \\leq a_i \\leq 5 \\times 10^5)$\uff0c$l, r\\ (1 \\leq l \\leq r \\leq 10^{12})$\uff0c\u6c42\u6709\u591a\u5c11 $B$ \u53ef\u4ee5\u4f7f\u8be5\u7b49\u5f0f\u5b58\u5728\u975e\u8d1f\u6574\u6570\u89e3\u3002\n\n## Solution\n\n\u5f88\u5bb9\u6613\u60f3\u5230 **\u5b8c\u5168\u80cc\u5305**\uff0c\u7528 $f_i$ \u8868\u793a $B$ \u7684\u503c\u80fd\u5426\u4e3a $i$\uff0c\u90a3\u4e48\u8f6c\u79fb\u65b9\u7a0b\u4e3a\n\n$$\\large {f_j = f_j \\mid f_{j - a_i}}$$\n\n\u8fd8\u53ef\u4ee5\u7528 $\\rm bitset$ \u4f18\u5316\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\frac{nr}{w})$ \u3002\n\n$l, r$ \u5f88\u5927\uff0c\u4e0a\u8ff0\u65b9\u6cd5\u663e\u7136\u884c\u4e0d\u901a\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5206\u522b\u6c42\u51fa $0 \\sim r$ \u4e2d\u7b26\u5408\u6761\u4ef6\u7684 $B$ \u7684\u6570\u91cf \u548c $0 \\sim l - 1$ \u4e2d\u7b26\u5408\u6761\u4ef6\u7684 $B$ \u7684\u6570\u91cf\uff0c\u524d\u8005\u51cf\u53bb\u540e\u8005\u5373\u662f\u7b54\u6848\u3002\u73b0\u5728\u5047\u8bbe $mn$ \u662f $a_i$ \u4e2d\u7684\u4e00\u4e2a\u6570\uff0c\u90a3\u4e48\u5bf9\u4e8e $a_1x_1 + a_2x_2 + \\cdots + a_nx_n = i$\uff0c\u90fd\u6ee1\u8db3 $a_1x_1 + a_2x_2 + \\cdots + a_nx_n = i + k \\times mn\\ (k \\in \\rm N)$ \u3002\u5728\u8fd9\u4e2a\u5f0f\u5b50\u4e2d\uff0c\u663e\u7136 $i$ \u8d8a\u5c0f\uff0c\u7b26\u5408\u6761\u4ef6\u7684\u6570\u5c31\u4f1a\u8d8a\u591a\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u7528 $dis_i$ \u8868\u793a $B$ \u6a21 $mn$ \u7b49\u4e8e $i$ \u65f6\u7684\u6700\u5c0f\u503c\u3002\u63a5\u4e0b\u6765\u8fde\u6709\u5411\u8fb9 $i \\to (i + a_j) \\bmod mn$\uff0c\u5176\u4e2d $0 \\leq i < mn$\uff0c\u8fb9\u6743\u4e3a $a_j$\uff0c\u8868\u793a\u4ece $i$ \u53d8\u4e3a $i + a_j$ \u6240\u82b1\u8d39\u7684\u4ee3\u4ef7\u662f $a_j$ \u3002$0$ \u5230 $i$ \u7684\u6700\u77ed\u8def\u5373\u662f $B$ \u6a21 $mn$ \u7b49\u4e8e $i$ \u65f6\u7684\u6700\u5c0f\u503c\u3002\u5047\u5b9a\u73b0\u5728\u8981\u6c42 $0 \\sim x$ \u4e2d\u7b26\u5408\u6761\u4ef6\u7684 $B$ \u7684\u6570\u91cf\uff0c\u82e5\u8fd9\u4e2a\u6700\u5c0f\u503c\u4e0d\u5927\u4e8e $x$\uff0c\u5219\u6240\u6709\u7684 $i + k \\times mn\\ (i + k \\times mn \\leq x,k \\in \\rm N)$ \u90fd\u7b26\u5408\u6761\u4ef6\uff0c\u4e00\u5171\u6709 $\\left \\lfloor \\frac{x - dis_i}{mn} \\right \\rfloor + 1$ \u4e2a\u3002\n\n\u6240\u4ee5\u679a\u4e3e $i$\uff0c\u7d2f\u52a0\u5c31\u80fd\u5f97\u5230\u7b54\u6848\u3002\u540c\u65f6 $mn$ \u53d6\u6240\u6709 $a_i$ \u7684\u6700\u5c0f\u503c\u6700\u4f18\uff0c\u56e0\u4e3a\u8fd9\u6837\u8fb9\u6570\u6700\u5c11\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(kn\\max\\limits_{i = 1}^n\\{ a_i \\})$ \u3002\u7531\u4e8e\u7279\u6b8a\u7684\u8fde\u8fb9\uff0c$\\rm SPFA$ \u4e0d\u4f1a\u88ab\u5361\uff0c\u53ef\u4ee5\u653e\u5fc3\u4f7f\u7528\u3002\n\n\u6211\u4eec\u4e00\u822c\u79f0\u8fd9\u79cd\u7b97\u6cd5\u4e3a **\u540c\u4f59\u6700\u77ed\u8def** \u3002\n\n## Code\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\n\ntemplate <class T>\ninline void read(T &x) {\n    x = 0;\n    char c = getchar();\n    bool f = 0;\n    for (; !isdigit(c); c = getchar()) f ^= c == '-';\n    for (; isdigit(c); c = getchar()) x = x * 10 + (c ^ 48);\n    x = f ? -x : x;\n}\n\ntemplate <class T>\ninline void write(T x) {\n    if (x < 0) {\n        putchar('-');\n        x = -x;\n    }\n    T y = 1;\n    int len = 1;\n    for (; y <= x / 10; y *= 10) ++len;\n    for (; len; --len, x %= y, y /= 10) putchar(x / y + 48);\n}\n\nconst int MAXN = 5e5, MAXM = 6e6;\nconst LL INF = 1e12;\nint n, m, mn = MAXN + 5, tot, a[MAXN + 5], head[MAXN + 5];\nLL l, r, dis[MAXN + 5];\nbool vis[MAXN + 5];\nstruct Edge {\n    int next, to, dis;\n} e[MAXM + 5];\n\ninline void addEdge(int u, int v, int w) {\n    e[++tot] = (Edge) { head[u], v, w };\n    head[u] = tot;\n}\n\ninline void spfa(int s) {\n    for (int i = 0; i < mn; ++i) dis[i] = INF + 1;//\u521d\u59cb\u5316 \n    queue<int> q;\n    dis[s] = 0;//\u6ee1\u8db3\u6a21 mn \u7b49\u4e8e 0 \u7684\u6700\u5c0f\u7684 B \u662f 0\n    q.push(s);\n    for (; !q.empty(); ) {\n        int u = q.front();\n        q.pop();\n        vis[u] = 0;\n        for (int v, w, i = head[u]; v = e[i].to, w = e[i].dis, i; i = e[i].next)\n            if (dis[v] > dis[u] + w) {\n                dis[v] = dis[u] + w;\n                if (!vis[v]) {\n                    q.push(v);\n                    vis[v] = 1;\n                }\n            }\n    }\n}\n\ninline LL query(LL x) {//\u6c42\u51fa 0 ~ x \u4e2d\u7b26\u5408\u6761\u4ef6\u7684 B \u7684\u6570\u91cf \n    LL res = 0;\n    for (int i = 0; i < mn; ++i)\n        if (dis[i] <= x)\n            res += (x - dis[i]) / mn + 1;//\u7d2f\u52a0\u7b54\u6848 \n    return res;\n}\n\nint main() {\n    read(n), read(l), read(r);\n    for (int x, i = 1; i <= n; ++i) {\n        read(x);\n        if (x) {//a[i] = 0 \u53ef\u4ee5\u8df3\u8fc7\uff0c\u56e0\u4e3a\u6ca1\u6709\u8d21\u732e \n            a[++m] = x;\n            mn = min(mn, x);//\u6c42\u51fa\u6700\u5c0f\u4e14\u975e 0 \u7684 a[i] \u4f5c\u4e3a mn \u7684\u503c \n        }\n    }\n    n = m;\n    for (int i = 0; i < mn; ++i)\n        for (int j = 1; j <= n; ++j)\n            if (a[j] != mn)//\u81ea\u5df1\u5411\u81ea\u5df1\u6ca1\u5fc5\u8981\u8fde\u8fb9 \n                addEdge(i, (i + a[j]) % mn, a[j]);//\u8fde\u6709\u5411\u8fb9 \n    spfa(0);//\u4ece 0 \u5f00\u59cb\n    write(query(r) - query(l - 1));\n    putchar('\\n');\n    return 0;\n}\n```",
        "postTime": 1556541791,
        "uid": 32139,
        "name": "Heartlessly",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2371 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u58a8\u58a8\u7684\u7b49\u5f0f\u3011"
    },
    {
        "content": "\u9996\u5148\uff0c\u672c\u9898\u6211\u4eec\u53d1\u73b0B\u5f88\u5927(\u226410\u768412\u6b21\u65b9)\uff0cN\u5f88\u5c0f(\u226412)\u3002\n\n\u90a3\u4e48\uff0c\u6211\u4eec**\u53ef\u4ee5\u66b4\u529b**\u5417\uff1f\n\n\u597d\u50cf\u53ea\u670920\u5206\u7684\u6837\u5b50\u554a...\n\n...\n\n...\n\n\u6240\u4ee5\u6211\u4eec\u8981\u60f3**\u4f18\u5316**~~(\u5e9f\u8bdd)~~\n\n\u5bf9\u4e8e40%\u7684\u6570\u636e\uff0c\n\n\u6211\u4eec\u60f3\u5230\u80cc\u5305\u3002\n\n\u8fd9\u4e0d\u662f\u5b8c\u5168\u80cc\u5305\u88f8\u9898\u5417\uff01\n\n\u6240\u4ee5\u6211\u4eec\u7528O(Bn)\u7684\u590d\u6742\u5ea6\u62ff\u5230\u4e8640\u5206\u3002\n\n...\n...\n\n\n\u5bf9\u4e8e100%\u7684\u6570\u636e\uff1a\n\n\u6211\u4eec\u5bf9a[]\u6570\u7ec4\u627e\u5230\u4e00\u4e2a\u6700\u5c0f\u503c,\u628a\u5b83\u5b58\u5165mn\n(srf\u5f88\u61d2\uff0c\u6392\u4e86\u4e2a\u5e8fQAQ)\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u5f0f\u5b50\u7684\u503c\u53ef\u4ee5\u8fbe\u5230 k * mn + t\n\n\u90a3\u4e48\u8fd9\u4e2a\u5f0f\u5b50\u7684\u503c\u4e5f\u4e00\u5b9a\u53ef\u4ee5\u8fbe\u5230 (k + i) * mn + t.\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u6bcf\u4e2a\u4f59\u6570t\u5efa\u4e00\u4e2a\u70b9\uff0c(0 \u2264 t \u2264 mn)\n\n\u5728 t \u548c (t + a[i]) % mn \u4e4b\u95f4\u8fde\u4e00\u6761**\u6709\u5411\u8fb9**\n\n\u7528SPFA\u6c42\u4e00\u4e0b**\u4ece0\u5f00\u59cb**\u7684\u6700\u77ed\u8def\u3002\n\n\u6c42\u5f97\u6700\u77ed\u8def\u540e\uff0c\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e2a\u4f59\u6570\u7edf\u8ba1\u7b54\u6848\u5373\u53ef\u3002\n\n\u4ee3\u7801\uff1a\n\n```\n#include <bits/stdc++.h>\n#define N 15\n#define M 500005\n#define LL long long\n\nusing namespace std;\n\nLL INF = (LL)1 << 62; //INF\u5f00\u5927\uff01\uff01\uff01\nLL n,l,r,a[N];\nLL k,dis[M];\n\nLL ans,ll,rr,t1,t2;\n\nqueue<int>Q; int x,now;\nbool vis[M];\n\nint main(){\n\tios::sync_with_stdio(false); //\u5361\u5e38\u4e13\u7528\n\tcin >> n >> l >> r;\n\tfor (int i = 1; i <= n; ++i) cin >> a[i];\n\tsort(a+1,a+n+1);\n\tk = a[1];\n\t\n\t//SPFA\n\tdis[0] = 0;\n\tfor (int i = 1; i < k; ++i) dis[i] = INF;\n\t\n\twhile (!Q.empty()) Q.pop();\n\tQ.push(0);\n\t\n\tmemset(vis,0,sizeof(vis));\n\tvis[0] = 1;\n\t\n\twhile (!Q.empty()){\n\t\tx = Q.front(); Q.pop();\n\t\tfor (int i = 1; i <= n; ++i){\n\t\t\tnow = (x + a[i]) % k;\n\t\t\tif (dis[now] > dis[x] + a[i]){\n\t\t\t\tdis[now] = dis[x] + a[i];\n\t\t\t\tif (!vis[now]) Q.push(now);\n\t\t\t\tvis[now] = 1;\n\t\t\t}\n\t\t}\n\t\tvis[x] = 0;\n\t}\n\t\n\tans = 0;\n\tfor (int i = 0; i < k; ++i)\n\t\tif (dis[i] != INF) dis[i] -= i,dis[i] /= k;\n\t\n\t//\u7edf\u8ba1ans\n\tfor (int i = 0; i < k; ++i)\n\t\tif (dis[i] != INF){\n\t\t\tll = (l - 1 - i) / k;\n\t\t\trr = (r - i) / k;\n\t\t\tt1 = ll - dis[i] + 1;\n\t\t\tt2 = rr - dis[i] + 1;\n\t\t\tt1 = max((LL)0,t1);\n\t\t\tt2 = max((LL)0,t2);\n\t\t\tans = ans - t1 + t2;\n\t\t}\n\t//\u6536\u5de5\n\tcout << ans << endl;\n\treturn 0;\n}\n```\n",
        "postTime": 1527173308,
        "uid": 52518,
        "name": "s_r_f",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P2371 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u58a8\u58a8\u7684\u7b49\u5f0f\u3011"
    },
    {
        "content": "## \u57fa\u672c\u601d\u60f3\n\n\u901a\u8fc7\u540c\u4f59\u6784\u9020\u67d0\u4e9b\u72b6\u6001\uff0c\u72b6\u6001\u4e4b\u95f4\u7684\u5173\u7cfb\u7c7b\u4f3c\u4e8e\u4e24\u70b9\u4e4b\u95f4\u7684\u5e26\u6743\u6709\u5411\u8fb9\u3002\n\n\u90a3\u4e48\u53ef\u4ee5\u4ee5\u6b64\u5efa\u56fe\uff0c\u5c06\u67d0\u4e9b\u95ee\u9898\u8f6c\u5316\u4e3a\u6700\u77ed\u8def\u95ee\u9898\uff0c\u518d\u4f7f\u7528\u5177\u6709\u4f18\u79c0\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u7b97\u6cd5\u6c42\u89e3\u3002\n\n#### \u3010\u4f8b\u9898\u3011[P3403 \u8df3\u697c\u673a](https://www.luogu.com.cn/problem/P3403)\n\n\u9996\u5148\u53ef\u4ee5\u5c06 $h$ \u51cf\u53bb $1$\uff0c\u540c\u65f6\u8d77\u59cb\u697c\u5c42\u8bbe\u4e3a $0$\u3002\n\n\u8bbe $d_i$ \u4e3a\u80fd\u591f\u5230\u8fbe\u7684\u6700\u4f4e\u7684 $\\bmod x = i$ \u7684\u697c\u5c42\u3002\n\n\u5219\u6709 $i \\stackrel{y}{\\longrightarrow} (i+y)\\bmod x$ \u548c $i \\stackrel{z}{\\longrightarrow} (i+z)\\bmod x$\u3002\n\n\u50cf\u8fd9\u6837\u5efa\u56fe\u540e\uff0c$d_i$ \u5c31\u76f8\u5f53\u4e8e $0 \\to i$ \u7684\u6700\u77ed\u8def\uff0cDijkstra \u5373\u53ef\u3002\n\n\u6700\u540e\u7edf\u8ba1\u65f6\uff0c\u5bf9\u4e8e $d_i \\le h$\uff0c\u6709\u8d21\u732e $\\lfloor\\frac{h-d_i}x\\rfloor + 1$\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n \\log n)$\u3002\n\n```cpp\nconst int N = 1e5 + 7;\nconst ll inf = (1ull << 63) - 1;\nll h, d[N], ans;\nint x, y, z, v[N];\nvector< pi > e[N];\npq< pair< ll, int > > q; \n\nint main() {\n\trd(h), --h, rd(x), rd(y), rd(z);\n\tfor (int i = 0; i < x; i++) e[i].pb(mp((i + y) % x, y)), e[i].pb(mp((i + z) % x, z)), d[i] = inf;\n\td[0] = 0, q.push(mp(0, 0));\n\twhile (q.size()) {\n\t\tint x = q.top().se;\n\t\tq.pop();\n\t\tif (v[x]) continue;\n\t\tv[x] = 1;\n\t\tfor (ui i = 0; i < e[x].size(); i++) {\n\t\t\tint y = e[x][i].fi, z = e[x][i].se;\n\t\t\tif (d[y] > d[x] + z) d[y] = d[x] + z, q.push(mp(-d[y], y));\n\t\t}\n\t}\n\tfor (int i = 0; i < x; i++)\n\t\tif (h >= d[i]) ans += (h - d[i]) / x + 1;\n\tprint(ans);\n\treturn 0;\n}\n```\n\n#### \u3010\u4f8b\u9898\u3011[P2371 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u58a8\u58a8\u7684\u7b49\u5f0f](https://www.luogu.com.cn/problem/P2371)\n\n\u4e0a\u4e00\u9898\u7684\u6269\u5c55\u3002\n\n```cpp\nconst int N = 5e5 + 7;\nconst ll inf = 1e18;\nll l, r, d[N], ans;\nint n, x, v[N];\nvector< pi > e[N];\npq< pair< ll, int > > q; \n\nint main() {\n\trd(n), rd(l), --l, rd(r), rd(x);\n\tfor (int i = 1; i < x; i++) d[i] = inf;\n\tfor (int i = 1, y; i < n; i++) {\n\t\trd(y);\n\t\tfor (int i = 0; i < x; i++)\n\t\t\te[i].pb(mp((i + y) % x, y));\n\t}\n\tq.push(mp(0, 0));\n\twhile (q.size()) {\n\t\tint x = q.top().se;\n\t\tq.pop();\n\t\tif (v[x]) continue;\n\t\tv[x] = 1;\n\t\tfor (ui i = 0; i < e[x].size(); i++) {\n\t\t\tint y = e[x][i].fi, z = e[x][i].se;\n\t\t\tif (d[y] > d[x] + z) d[y] = d[x] + z, q.push(mp(-d[y], y));\n\t\t}\n\t}\n\tfor (int i = 0; i < x; i++) {\n\t\tif (r >= d[i]) ans += (r - d[i]) / x + 1;\n\t\tif (l >= d[i]) ans -= (l - d[i]) / x + 1;\n\t}\n\tprint(ans);\n\treturn 0;\n}\n```",
        "postTime": 1576063054,
        "uid": 100544,
        "name": "xht",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2371 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u58a8\u58a8\u7684\u7b49\u5f0f\u3011"
    },
    {
        "content": "\u3000  \u8fd9\u9053\u9898\u679c\u7136\u662f\u56fd\u5bb6\u96c6\u8bad\u961f\u7684\u795e\u4ed9\u9898\uff0c\u601d\u7ef4\u72ec\u7279\u3002\n\n\u3000\u3000\u9996\u5148\u82e5\u65b9\u7a0b$ \\sum_{i=1}^{n}a_ix_i=k $\u6709\u975e\u8d1f\u6574\u6570\u89e3\uff0c\u90a3\u4e48\u663e\u7136\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$ a_i $\u65b9\u7a0b$ \\sum_{i=1}^{n}a_ix_i=k $\u90fd\u5fc5\u6709\u975e\u8d1f\u6574\u6570\u89e3\u3002\u4e8e\u662f\u82e5\u53d6$ Min=\\min(a_i) $\uff0c\u90a3\u4e48\u5bf9\u4e8e\u4efb\u610f$ j \\in [0,min) $\uff0c\u82e5\u5bf9\u4e8e\u81ea\u7136\u6570\u6570$ k $\uff0c$ \\sum_{i=1}^{n}a_ix_i=k (k \\equiv j (mod \\ Min)) $\u6709\u89e3\uff0c\u5219\u5bf9\u4e8e\u4e00\u5207\u81ea\u7136\u6570$ B>k(B \\equiv j (mod \\ Min)) $\uff0c\u65b9\u7a0b$ \\sum_{i=1}^{n}a_ix_i=k $\u90fd\u5fc5\u6709\u89e3\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ea\u9700\u5bf9\u6bcf\u4e00\u4e2a$ j $\u6c42\u51fa\u5bf9\u5e94\u7684$ k $\u503c\u3002\uff08\u6211\u4ee3\u7801\u4e2d\u5b9e\u9645\u6c42\u7684\u662f$ k/Min $\uff0c\u53d6$ Min $\u662f\u4e3a\u4e86\u8ba9\u72b6\u6001\u6570\u5c3d\u53ef\u80fd\u5c0f\uff09\n\n\u3000\u3000\u4f46\u662f\uff0c\u8fd9\u4e2a\u503c\u600e\u4e48\u6c42\u5462\uff1f\u6839\u636e\u4e0a\u6587\uff0c\u82e5$ \\sum_{i=1}^{n}a_ix_i=k $\uff0c\u5219\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u5c06$ k $\u5206\u522b\u52a0\u4e0a\u6bcf\u4e00\u4e2a$ a_i $\u5f97\u5230\u65b0\u7684\u5408\u6cd5\u6570\u503c\u3002\u8fd9\u5176\u5b9e\u76f8\u5f53\u4e8e\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$ i \\in [1,n] $\uff0c\u4ece$ k $\u5411$ (k+a_i)mod \\ Min $\u8fde\u4e00\u6761\u957f\u5ea6\u4e3a$ a_i $\u7684\u8fb9\u3002\u540c\u65f6\uff0c\u6211\u4eec\u8981\u4f7f$ k $\u5c3d\u53ef\u80fd\u5c0f\uff0c\u6240\u4ee5\u8981\u5728\u539f\u56fe\u4e2d\u8dd1\u6700\u77ed\u8def\u6c42\u89e3\u3002\n\n\u3000\u3000\u4ee3\u7801\uff1a\n\n1\u3001dijkstra+\u5806\uff08\u8fd9\u4e2a\u5982\u679cdijkstra\u5199\u5f97\u4e0d\u597d\u5728\u6d1b\u8c37\u4e0a\u4f1atle\uff09\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<cstdlib>\n#include<cstring>\n#include<ctime>\n#include<algorithm>\n#include<queue>\n#include<vector>\n#include<map>\n#define ll long long\n#define ull unsigned long long\n#define max(a,b) (a>b?a:b)\n#define min(a,b) (a<b?a:b)\n#define lowbit(x) (x& -x)\n#define mod 1000000000\n#define inf 0x3f3f3f3f\n#define eps 1e-18\n#define maxn 5010\ninline ll read(){ll tmp=0; char c=getchar(),f=1; for(;c<'0'||'9'<c;c=getchar())if(c=='-')f=-1; for(;'0'<=c&&c<='9';c=getchar())tmp=(tmp<<3)+(tmp<<1)+c-'0'; return tmp*f;}\ninline ll power(ll a,ll b){ll ans=1; for(;b;b>>=1){if(b&1)ans=ans*a%mod; a=a*a%mod;} return ans;}\ninline ll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\ninline void swap(int &a,int &b){int tmp=a; a=b; b=tmp;}\nstruct data{\n    int id,dis;\n    friend bool operator < (data a,data b){\n        return a.dis>b.dis;\n    }\n};\nstd::priority_queue<data>heap;\nstruct edge{\n    int to,nxt,d;\n}e[6000010];\nint fir[500010],mark[500010],dist[500010];\nint a[20];\nint n,m,tot=0;\nll l,r;\nvoid add(int x,int y,int z){e[tot].to=y; e[tot].d=z; e[tot].nxt=fir[x]; fir[x]=tot++;}\nvoid dij(int S)\n{\n    memset(dist,0x3f,sizeof(dist));\n    memset(mark,0,sizeof(mark));\n    data now; now.id=S; now.dis=0; dist[S]=0; heap.push(now);\n    while(!heap.empty()){\n        now=heap.top(); heap.pop();\n        if(mark[now.id])continue;\n        mark[now.id]=1;\n        for(int i=fir[now.id];~i;i=e[i].nxt)\n            if(dist[e[i].to]>dist[now.id]+e[i].d){\n                data tmp; tmp.id=e[i].to; tmp.dis=dist[now.id]+e[i].d;\n                heap.push(tmp); dist[e[i].to]=tmp.dis;\n            }\n    }\n}\nint main()\n{\n    memset(fir,255,sizeof(fir));\n    n=read(); l=read(); r=read();\n    int mn=inf;\n    for(int i=1;i<=n;i++)\n        a[i]=read(),mn=min(mn,a[i]);\n    for(int i=0;i<mn;i++)\n        for(int j=1;j<=n;j++){\n            int nxt=i+a[j];\n            add(i,nxt%mn,nxt/mn);\n        }\n    dij(0);\n//\tfor(int i=0;i<=n;i++)printf(\"%d %d\\n\",i,dist[i]);\n    ll ans=0;\n    for(int i=0;i<mn;i++)\n        if(1ll*dist[i]*mn+i<=r){\n        \tll L=max(dist[i]*mn+i,l),R=r;\n        \tif(L/mn<R/mn){\n        \t\tans+=R/mn-L/mn-1;\n        \t\tif(L<=L/mn*mn+i&&L/mn*mn+i<=R)++ans;\n        \t\tif(L<=R/mn*mn+i&&R/mn*mn+i<=R)++ans;\n            }\n            else if(L<=L/mn*mn+i&&L/mn*mn+i<=R)++ans;\n        }\n    printf(\"%lld\\n\",ans);\n}\n```\n2\u3001spfa\uff08\u8fd9\u4e2a\u5c31\u5f88\u6e05\u771f\u4e86\uff0c\u8dd1\u5f97\u98de\u5feb\uff09\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<cstdlib>\n#include<cstring>\n#include<ctime>\n#include<algorithm>\n#include<queue>\n#include<vector>\n#include<map>\n#define ll long long\n#define ull unsigned long long\n#define max(a,b) (a>b?a:b)\n#define min(a,b) (a<b?a:b)\n#define lowbit(x) (x& -x)\n#define mod 1000000000\n#define inf 0x3f3f3f3f\n#define eps 1e-18\n#define maxn 5010\ninline ll read(){ll tmp=0; char c=getchar(),f=1; for(;c<'0'||'9'<c;c=getchar())if(c=='-')f=-1; for(;'0'<=c&&c<='9';c=getchar())tmp=(tmp<<3)+(tmp<<1)+c-'0'; return tmp*f;}\ninline ll power(ll a,ll b){ll ans=1; for(;b;b>>=1){if(b&1)ans=ans*a%mod; a=a*a%mod;} return ans;}\ninline ll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\ninline void swap(int &a,int &b){int tmp=a; a=b; b=tmp;}\nusing namespace std;\nstruct edge{\n    int to,nxt,d;\n}e[6000010];\nint fir[500010],inq[500010],dist[500010];\nint q[10000010];\nint a[20];\nint n,m,tot=0;\nll l,r;\nvoid add(int x,int y,int z){e[tot].to=y; e[tot].d=z; e[tot].nxt=fir[x]; fir[x]=tot++;}\nvoid spfa(int S)\n{\n    memset(dist,0x3f,sizeof(dist));\n    memset(inq,0,sizeof(inq));\n    int h=1,t=1; q[1]=S; inq[S]=1; dist[S]=0;\n    while(h<=t){\n        for(int i=fir[q[h]];~i;i=e[i].nxt)\n            if(dist[q[h]]+e[i].d<dist[e[i].to]){\n                dist[e[i].to]=dist[q[h]]+e[i].d;\n                if(!inq[e[i].to]){\n                    q[++t]=e[i].to; inq[e[i].to]=1;\n                }\n            }\n        inq[q[h++]]=0;\n    }\n}\nint main()\n{\n    memset(fir,255,sizeof(fir));\n    n=read(); l=read(); r=read();\n    int mn=inf;\n    for(int i=1;i<=n;i++)\n        a[i]=read(),mn=min(mn,a[i]);\n    for(int i=0;i<mn;i++)\n        for(int j=1;j<=n;j++){\n            int nxt=i+a[j];\n            add(i,nxt%mn,nxt/mn);\n        }\n    spfa(0);\n    ll ans=0;\n    for(int i=0;i<mn;i++)\n        if(1ll*dist[i]*mn+i<=r){\n            ll L=max(dist[i]*mn+i,l),R=r;\n            if(L/mn<R/mn){\n                ans+=R/mn-L/mn-1;\n                if(L<=L/mn*mn+i&&L/mn*mn+i<=R)++ans;\n                if(L<=R/mn*mn+i&&R/mn*mn+i<=R)++ans;\n            }\n            else if(L<=L/mn*mn+i&&L/mn*mn+i<=R)++ans;\n        }\n    printf(\"%lld\\n\",ans);\n}\n```\n",
        "postTime": 1535032010,
        "uid": 15620,
        "name": "QuartZ_Z",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2371 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u58a8\u58a8\u7684\u7b49\u5f0f\u3011"
    },
    {
        "content": "##  \u6982\u5ff5\n\n\u540c\u4f59\u6700\u77ed\u8def\u662f\u4e00\u79cd\u4f18\u5316\u6700\u77ed\u8def\u5efa\u56fe\u7684\u65b9\u6cd5\n\n\u901a\u5e38\u662f\u89e3\u51b3\u7ed9\u5b9a $m$ \u4e2a\u6574\u6570\uff0c\u6c42\u8fd9 $m$ \u4e2a\u6574\u6570\u80fd\u62fc\u51d1\u51fa\u591a\u5c11\u7684\u5176\u4ed6\u6574\u6570(\u8fd9 $m$ \u4e2a\u6574\u6570\u53ef\u4ee5\u91cd\u590d\u53d6)\u6216\u7ed9\u5b9a $m$ \u4e2a\u6574\u6570\uff0c\u6c42\u8fd9 $m$ \u4e2a\u6574\u6570\u4e0d\u80fd\u62fc\u51d1\u51fa\u7684\u6700\u5c0f\uff08\u6700\u5927\uff09\u7684\u6574\u6570\u3002\n\n## \u6817\u9898\n\n[P2371 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u58a8\u58a8\u7684\u7b49\u5f0f](https://www.luogu.com.cn/problem/P2371)\n\n> **\u9898\u76ee\u5927\u610f\uff1a** \n>\n> \u5bf9\u4e8e $\\sum_{i = 1}^na_ix_i = b$\u200b \uff0c\u7ed9\u5b9a $n$\u200b \uff0c$a_{1 \\cdots n}$\u200b \uff0c$l$\u200b\uff0c$r$\u200b \uff0c\u6c42\u6709\u591a\u5c11 $b \\in[l,r]$\u200b \u53ef\u4ee5\u4f7f\u5f97\u7b49\u5f0f\u5b58\u5728\u975e\u8d1f\u6574\u6570\u89e3\u3002\n>\n> $n\\leq 12, 0\\leq a_i\\leq5\\times 10^5,0\\leq l\\leq r\\leq 10^{12}$\u200b\n\n**solution**\n\n\u628a\u9898\u76ee\u7a0d\u5fae\u53d8\u4e00\u4e0b\u5f62\n\n\u6c42\u6709\u591a\u5c11\u7ec4 $x_i$\u200b\u200b  \uff0c\u4f7f\u5f97 $a_1 \\times x_1 + a_2 \\times x_2 \\cdots a_n \\times x_n = b$\u200b\u200b  \u6210\u7acb\n\n\u53d1\u73b0\u8fd9\u4e2a\u9898\u548c[\u8d27\u5e01\u7cfb\u7edf](https://www.luogu.com.cn/problem/P5020)\u90a3\u4e2a\u9898\u5f88\u50cf\uff0c\u8003\u8651\u5b8c\u5168\u80cc\u5305\u505a\u6cd5\uff0c\u4f46\u662f\u8fd9\u4e2a\u9898\u7684 $l, r$ \u5f88\u5927\uff0c\u6240\u4ee5\u5c31\u6709\u4e86**\u540c\u4f59\u6700\u77ed\u8def**\u3002\n\n\u597d\u50cf\u9898\u89e3\u89e3\u91ca\u7684\u90fd\u4e0d\u662f\u5f88\u6e05\u695a \uff1f\uff1f\u8fd9\u7528\u5206\u7ec4\u7684\u601d\u60f3\u611f\u89c9\u89e3\u91ca\u597d\u50cf\u80fd\u89e3\u91ca\u7684\u66f4\u6e05\u695a\u70b9 = =\n\n\u5bf9\u4e8e\u8fd9\u4e2a\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u6c42\u51fa $[1, l - 1]$  \u6709\u591a\u5c11 $b$ \u6ee1\u8db3\u6761\u4ef6\uff0c\u518d\u6c42\u51fa $[1, r]$ \u6709\u591a\u5c11 $b$ \u6ee1\u8db3\u6761\u4ef6\uff0c\u4f5c\u5dee\u5c31\u597d\u4e86\u3002\n\n\u8f6c\u6362\u4e00\u4e0b\uff0c\u4e0e\u5176\u8003\u8651 $b$ \u662f\u5426\u6ee1\u8db3\u6761\u4ef6\uff0c\u4e0d\u5982\u8003\u8651 $b$ \u662f\u5426\u80fd\u88ab\u51d1\u51fa\u6765\u3002\n\n\u597d\uff0c\u73b0\u5728\u6211\u4eec\u7684\u76ee\u6807\u5c31\u662f\u7edf\u8ba1 $[1,x]$ \u5185\u6709\u591a\u5c11\u4e2a\u6570\u80fd\u88ab\u51d1\u51fa\u6765\u3002\n\n\u8003\u8651\u8fd9\u4e48\u4e00\u4ef6\u4e8b\uff1a\u627e\u51fa $a_i$ \u4e2d\u6700\u5c0f\u7684\u8bb0\u4e3a $Min$  \uff0c\u4ee4 $p \\in[1, Min)$\uff1b\n\n\u6211\u4eec\u6240\u6709\u7684\u6570\u6309\u7167\u5bf9 $Min$ \u53d6\u6a21\uff0c\u6309\u7167\u4f59\u6570\u5206\u4e3a $Min$ \u7c7b\u3002 \n\n\u5982\u679c $p + k*Min$\u200b \u80fd\u591f\u88ab\u51d1\u51fa\u6765\uff0c\u90a3\u4e48 $p + (k + N^{+}) \\times Min$\u200b  \u4e5f\u4e00\u5b9a\u80fd\u88ab\u51d1\u51fa\u6765\uff0c\u4e5f\u5c31\u662f\u4ece\u8fd9\u4e4b\u540e\uff0c\u8fd9\u4e00\u7c7b\u90fd\u80fd\u88ab\u51d1\u51fa\u6765\u4e86\uff0c\u4ee4 $tmp = p + k_{min} \\times Min$\u200b \uff0c\u4e5f\u5c31\u662f\u8fd9\u4e00\u7c7b\u6700\u65e9\u80fd\u88ab\u51d1\u51fa\u6765\u7684\u6570\u3002\u5982\u679c $tmp \\leq x$\u200b\uff0c\u90a3\u4e48\u8fd9\u4e2a\u533a\u95f4\u5173\u4e8e\u8fd9\u4e00\u7c7b\u80fd\u51d1\u51fa\u6765\u7684\u6570\u7684\u4e2a\u6570\u5c31\u662f $\\frac{x - tmp}{Min} + 1$\u200b \uff0c\u6c42\u6240\u6709\u7c7b\u5c31\u662f\u5bf9\u6bcf\u4e00\u7c7b\u6570\u505a\u76f8\u540c\u64cd\u4f5c\u52a0\u548c\u5c31\u597d\u4e86\u3002\n\n\u73b0\u5728\u5c31\u53ea\u5269\u600e\u4e48\u6c42\u6bcf\u4e00\u7c7b\u88ab\u7b2c\u4e00\u6b21\u51d1\u51fa\u6765\u7684\u6570\u662f\u591a\u5c11\u3002\n\n\u628a\u5b83\u653e\u5728\u56fe\u91cc\uff0c\u8ba9 $p$\u200b \u5411 $(p +a_i) \\bmod Min$\u200b \u8fde\u4e00\u6761\u6743\u503c\u4e3a $a_i$\u200b \u6709\u5411\u8fb9\uff0c\u4e5f\u5c31\u662f\u8bf4\u51d1\u51fa $p + a_i$\u200b  \u7684\u4ee3\u4ef7\u4e3a $a_i$\u200b \uff0c\u4ece $0$\u200b \u70b9\u5230 $[0, Min)$\u200b \u7684\u6700\u77ed\u8def\u957f\u5ea6\u5c31\u662f\u6bcf\u4e00\u7c7b\u7b2c\u4e00\u6b21\u88ab\u51d1\u51fa\u6765\u7684\u6570\u662f\u591a\u5c11\u3002\n\n\u7136\u540e\u5c31\u5b8c\u6210\u5566\u3002\n\n**code**\n\n```c++\n/*\nwork by:Ariel_\n*/\n#include <iostream>\n#include <cstring>\n#include <cstdio>\n#include <queue>\n#include <algorithm>\n#define int long long\n#define rg register\nusing namespace std;\nconst int N = 5e5 + 5;\nconst int M = 6e6 + 5;\nconst int INF = 0x3f3f3f3f3f3f;\nint read(){\n    int x = 0,f = 1; char c = getchar();\n    while(c < '0'||c > '9') {if(c == '-') f = -1; c = getchar();}\n    while(c >= '0' && c <= '9') {x = x*10 + c - '0'; c = getchar();}\n    return x*f;\n}\nint n, l, r, a[N], m, Min = INF, dis[N], vis[N];\nstruct edge {int v, nxt, w;}e[M]; \nint head[N], E;\nvoid add_edge(int u, int v, int w) {\n   e[++E] = (edge) {v, head[u], w};\n   head[u] = E;\n}\nqueue<int> q;\nvoid SPFA(int s) {\n   memset(dis, INF, sizeof dis); \n   dis[s] = 0, q.push(s);\n   while(!q.empty()) {\n   \t  int u = q.front(); q.pop(); vis[u] = 0;\n   \t      for (rg int i = head[u]; i; i = e[i].nxt){\n   \t        int v = e[i].v, w = e[i].w;\n   \t  \t    if (dis[v] > dis[u] + e[i].w){\t\n\t\t\t   dis[v] = dis[u] + e[i].w;\n\t\t\t   if (!vis[v]) q.push(v), vis[v] = 1;\n\t\t    }\n\t    }\n   }\n}\nint query(int x) {\n    int res = 0;\n    for (rg int i = 0; i < Min; i++) \n       if (dis[i] <= x)\n       \t  res += (x - dis[i]) / Min + 1;\n\treturn res;\n}\nsigned main(){\n   n = read(), l = read(), r = read();\n   for (rg int i = 1, x; i <= n; i++) {\n   \t   x = read();\n       if (x) a[++m] = x, Min = min(x, Min);//0 \u8fb9\u6ca1\u6709\u8d21\u732e \n   }\n   n = m;\n   for (rg int i = 0; i < Min; i++) \n   \t  for (rg int j = 1; j <= n; j++)\n   \t      if (a[j] != Min) add_edge(i, (i + a[j]) % Min, a[j]);\n   SPFA(0);\n   printf(\"%lld\", query(r) - query(l - 1));\n   puts(\"\");\n   return 0;\n}\n```\n\n\u8fd9\u9053\u9898\u7684\u5f31\u5316\u7248 [P3403 \u8df3\u697c\u673a](https://www.luogu.com.cn/problem/P3403) \n\n\u6ce8\u610f\u8fd9\u9053\u9898\u662f\u4ece\u4e00\u697c\u5f00\u59cb\uff0c\u60f3\u60f3\u4e0e\u4e0a\u9762\u677f\u5b50\u6bd4\u8f83\u54ea\u91cc\u53d8\u4e86 = =\n\n$finish$",
        "postTime": 1627033661,
        "uid": 285235,
        "name": "Dita",
        "ccfLevel": 0,
        "title": "\u540c\u4f59\u6700\u77ed\u8def"
    },
    {
        "content": "## \u4e0d\u6127\u662f\u56fd\u5bb6\u96c6\u8bad\u961f\u7684\u9898\n\n------------\n\n\n\u5199\u8fd9\u9053\u9898\u5462\uff0c\u4e5f\u7b97\u662f\u6709\u70b9\u7f18\u5206\uff1f\u968f\u673a\u8df3\u9898\u8df3\u5230\u4e86\u3002\n\n[\u8fd9\u9053\u9898](https://www.luogu.com.cn/problem/P3403)\n\n\u4e00\u9053\u677f\u5b50\u9898\uff0c\u7136\u540e\u4ece\u6b64\u6211\u5c31\u5b66\u4f1a\u4e86 **\u540c\u4f59\u6700\u77ed\u8def**\n##### \u5e9f\u8bdd\u4e0d\u591a\u8bf4\uff0c\u4e0a\u6b63\u9898\n\n\u6240\u8c13\u540c\u4f59\u6700\u77ed\u8def\uff0c\u5c31\u662f\u89e3\u51b3\u7c7b\u4f3c\u4e8e\u8fd9\u6837\u7684\u95ee\u9898 \uff08\u5c31\u662f\u4e0a\u9762\u90a3\u4e00\u9053\u9898\u5566\uff09\u3002\n\n### $Q\\,$:\u6709$\\,n\\,$\u4e2a\u6570,\u95ee\u5728\u4e00\u5b9a\u6570\u503c\u4e0b\u53ef\u80fd\u7ec4\u6210\u7684\u6570\u7684\u4e2a\u6570?\n\n\u6817\u5b50:\u6bd4\u5982 $n = 3$ \uff0c\u90a3\u7ed9\u51fa\u7684\u6570\u662f $\\,x\\,$\uff0c$\\,y\\,$ \uff0c $z\\,$\uff0c\u6c42\u6ee1\u8db3$\\,ax + by + cz = k$\u4e2d$\\,k\\,$\u7684\u4e2a\u6570\u3002\uff08\u5728\u4e00\u5b9a\u8303\u56f4\u5185\n\n\n\u8fd9\u79cd\u9898\u5728\u6570\u636e\u5141\u8bb8\u7684\u8303\u56f4\u5185\uff0c\u6211\u4eec\u4e00\u822c\u4f7f\u7528\u80cc\u5305\u6216\u8005\u76f4\u63a5\u66b4\u529b\uff0c\u4f46\u662f\u5f88\u53ef\u60dc\uff0c\u8fd9\u9053\u9898\u6211\u4eec\u65e0\u6cd5\u7528\u8fd9\u4e24\u79cd\u65b9\u6cd5$AC$\n\uff0c \u90a3\u4e48\u6211\u4eec\u6765\u5f15\u5165\u4e00\u4e2a\u65b0\u7684\u5b9a\u4e49\uff0c\u5c31\u662f\u6211\u4eec\u4eca\u5929\u7684\u4e3b\u89d2\u3002\n \n### \u540c\u4f59\u6700\u77ed\u8def\n\n\u8bd5\u60f3\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u8bf4\uff0c\u6211\u4eec\u53ea\u52a0 $\\,y\\,$\uff0c$\\,z\\,$\uff0c\u5728\u5141\u8bb8\u8303\u56f4\u5185\uff0c\u80fd\u8fbe\u5230\u7684\u6570\u518d\u52a0\u82e5\u5e72\n\u4e2a$\\,x\\,$\u90fd\u662f\u80fd\u8fbe\u5230\u7684\uff0c\u90a3\u4e48\u5c31\u4ee5$\\bmod \\,x\\,$\u7684\u503c\u505a\u5206\u7c7b\u3002\n\n\u6362\u53e5\u8bdd\u6765\u8bf4\u5c31\u662f\uff0c\u8981\u80fd\u7528\u82e5\u5e72\u4e2a $\\,y\\,$\uff0c$\\,z\\,$\u8fbe\u5230\u7684\u4e00\u5b9a\u80fd\u518d\u52a0\u4e0a$\\,x\\,$\u800c\u8fbe\u5230\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u628a\u8fd9\u7c7b\u9898\u62bd\u8c61\u6210\u4e86\u56fe\u8bba\u9898\uff0c\u5c31\u662f\u4ee5$\\,n\\,$\u4e2a\u6570\u4e2d\u6700\u5c0f\u7684\u4e00\u4e2a\u4f5c\u4e3a\u6a21\u6570\uff08\u6700\u4f18\uff09\u3002\n\n\n$ \\centerdot \\quad i \\xrightarrow{y} (i + y) \\;\\bmod\\ x $\n\n$ \\centerdot \\quad i \\xrightarrow{z} (i + z) \\;\\bmod\\ x $\n\n\n------------\n\n\n```\nfor(int i = 0; i < x; ++i)\n{\n\tadd(i, (i+y) % x , y);\n\tadd(i, (i+z) % x , z);\n}\n```\n\n\n------------\n\n\u6211\u4eec\u5728\u8fd9\u4e2a\u56fe\u91cc\u9762\u8dd1\u4e00\u904d\u6700\u77ed\u8def\uff0c\u6837\u6211\u4eec\u5c31\u6c42\u51fa\u4e86\u6700\u5c0f\u7684\u4f59\u6570\u4e3a $i$ \u7684\u80fd\u8fbe\u5230\u7684\u6570\u3002$h$ \u6307\u4e0a\u9650\uff0c\u4ece 1 \u5230 $h$\u3002\n\n\u6700\u540e\u7edf\u8ba1\u7b54\u6848\u3002\n\n$\\sum\\limits_{i=1}^{x-1} {(\\dfrac{h-d_i}{x} + 1)}$\n\n\n\n------------\n\n```\nfor(int i = 0; i < x; ++i)\n{\n\tif(d[i] <= h)\n\t{\n\t\tans += (h-d[i])/x + 1;// \u6ce8\u610f\u8fd9\u91cc\u662f\u6709+1\u7684\n\t}\n}\n```\n\n\n------------\n\n\n\u90a3\u4e48\u6211\u4eec\u62bd\u8c61\u5230\u8fd9\u9898\u4e0a\u5c31\u662f\u5c06$\\,h\\,$\u53d8\u4e3a $\\,l\\,$\u548c$\\,r\\,$\uff0c\u662f\u95ed\u533a\u95f4\u90a3\u6211\u4eec\u5c31\u5728\u6700\u540e\u7edf\u8ba1\u7684\u65f6\u5019~~\u505a\u70b9\u624b\u811a~~\u3002\n\n```\nfor(ll i = 0; i < w[1]; ++i)\n{\n\tif(d[i] <= r) // \u5982\u679c\u5c0f\u4e8er \uff0c\u5c31\u52a0\u7b54\u6848 \n\t{\n\t\tans += (r - d[i])/w[1] + 1;\n\t}\n\tif(d[i] < l) // \u5982\u679c\u5c0f\u4e8el \uff0c\u8bf4\u660e\u4e0d\u5408\u6cd5\uff0c\u51cf\u53bb\u8fd9\u4e00\u90e8\u5206 \n\t{\n\t\tans -= (l - 1 - d[i])/w[1] + 1;\n\t}\n}\n```\n\n\u6700\u540e\uff0c\u4f60\u4eec\u6700\u7231\u7684\u5168\u5957\u4ee3\u7801\n```\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int maxn = 5e6 + 20;\n\nint n;\nll w[15];\nll h,ans;\nll d[maxn];\nll l,r; \nbool v[maxn];\n\n\nstruct N{\n\tint to,net,va;\n}a[maxn << 2];\nint head[maxn];\nint cnt;\n\nvoid add(int x,int y,int w)\n{\n\ta[++cnt].to = y;\n\ta[cnt].net = head[x];\n\ta[cnt].va = w;\n\thead[x] = cnt;\n}\n\nvoid SPFA()\n{\n\tmemset(v,0,sizeof v);\n\tmemset(d,0x3f3f3f3f,sizeof d);\n\tqueue<int> q;\n\tq.push(0);\n\tv[0] = 1;\n\td[0] = 0;// \u6ce8\u610f\u4ece0\u5f00\u59cb\uff0c\u56e0\u4e3a\u57fa\u6570\u4e3a 0\uff0c\u6362\u53e5\u8bdd\u8bf4\u5c31\u662f\uff0c\u4f59\u6570\u4ece0\u5f00\u59cb\u7b97 \n\twhile(!q.empty())\n\t{\n\t\tint from = q.front(); q.pop();\n\t\tv[from] = 0;\n\t\tfor(int i = head[from]; i; i = a[i].net)\n\t\t{\n\t\t\tint to = a[i].to;\n\t\t\tint va = a[i].va;\n\t\t\tif(d[to] > d[from] + va)\n\t\t\t{\n\t\t\t\td[to] = d[from] + va;\n\t\t\t\tif(!v[to])\n\t\t\t\t{\n\t\t\t\t\tv[to] = 1;\n\t\t\t\t\tq.push(to);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n\nint main()\n{\n\tscanf(\"%d%lld%lld\",&n,&l,&r);\n\tfor(int i = 1; i <= n; ++i)\tscanf(\"%lld\",&w[i]);\n\tsort(w+1,w+n+1);\n\tfor(ll i = 0; i < w[1]; ++i)\n\t{\n\t\tfor(int j = 2; j <= n; ++j)\n\t\t{\n\t\t\tadd(i, (i+w[j]) % w[1] , w[j]);\n\t\t}\n\t}\n\tSPFA();\n\tfor(ll i = 0; i < w[1]; ++i)\n\t{\n\t\tif(d[i] <= r) // \u5982\u679c\u5c0f\u4e8er \uff0c\u5c31\u52a0\u7b54\u6848 \n\t\t{\n\t\t\tans += (r - d[i])/w[1] + 1;\n\t\t}\n\t\tif(d[i] < l) // \u5982\u679c\u5c0f\u4e8el \uff0c\u8bf4\u660e\u4e0d\u5408\u6cd5\uff0c\u51cf\u53bb\u8fd9\u4e00\u90e8\u5206 \n\t\t{\n\t\t\tans -= (l - 1 - d[i])/w[1] + 1;\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n\u5b8c\u7ed3\u6492\u82b1\uff01",
        "postTime": 1626662697,
        "uid": 437336,
        "name": "ttwyzz",
        "ccfLevel": 0,
        "title": "P2371 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u58a8\u58a8\u7684\u7b49\u5f0f"
    },
    {
        "content": "AC \u4e4b\u540e\u770b\u4e86\u770b\u9898\u89e3\u91cc\u597d\u50cf\u6ca1\u6709\u5199\u5b58\u8fb9\u7684\uff0c\u90a3\u6211\u5c31\u6765\u5199\u4e00\u4e2a\u6ca1\u5b58\u8fb9\u7684\u9898\u89e3\u548c\u5b58\u4e86\u8fb9\u7684\u9898\u89e3\u5427\u3002\n\n\u9996\u5148\u8fd9\u9898\u7684\u601d\u8def\u5c31\u662f\u540c\u4f59\u6700\u77ed\u8def\uff0c\u5982\u679c\u6ca1\u6709\u505a**\u8df3\u697c\u673a**\u7684\u53ef\u4ee5\u5148\u53bb\u505a\u4e00\u4e0b\u8df3\u697c\u673a\uff0c\u8fd9\u9898\u7b97\u662f\u5b83\u7684\u4e00\u4e2a\u62d3\u5c55\u3002\n# \u540c\u4f59\u6700\u77ed\u8def\n\u5047\u8bbe\u6709\u8fd9\u6837\u4e00\u4e2a\u7b49\u5f0f $ax\\,+\\,by\\,+\\,cz\\,=\\,k$  \uff0c $ k\\,$\u662f\u6240\u80fd\u5230\u8fbe\u7684\u9ad8\u5ea6\uff0c$\\,x\\,$,$\\,y\\,$,$\\,z\\,$\u662f\u7ed9\u51fa\u7684\u5e38\u91cf\uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u6c42\u51fa$\\,a\\,$\uff0c$b\\, $\uff0c $\\,c\\,$ (\u7ed9\u51fa\u7684\u5e38\u91cf\u5728\u8fd9\u9053\u9898\u91cc\u662f\u4e0d\u5b9a\u7684\uff0c\u8fd9\u91cc\u5c31\u62ff\u4e09\u4e2a\u4e3e\u4f8b\u5b50)\u3002\n\n\u5148\u4e0d\u8003\u8651$\\,x\\,$\uff0c\u5c31\u8ba1\u7b97\u4e00\u4e0b$\\,y\\,$\u548c$\\,z\\,$\u7684\u5230\u8fbe\u7684\u6700\u4f4e\u9ad8\u5ea6 $d_i$\uff0c$d_i\\,\\ mod\\ x\\,= \\,i\\,$\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u4ee5\u6b64\u6765\u5efa\u8fb9\n\n$ \\centerdot \\quad i \\xrightarrow{y} (i + y) \\;\\bmod\\ x $\n\n$ \\centerdot \\quad i \\xrightarrow{z} (i + z) \\;\\bmod\\ x $\n\n\u7136\u540e\u6c42\u51fa\u6765\u6700\u77ed\u8def\uff0c\u6700\u540e\u5c31\u662f\u7edf\u8ba1\u7b54\u6848\u3002\n\n\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c\u7edf\u8ba1\u7b54\u6848\u600e\u4e48\u7b97\u5462\uff0c\u6c42\u51fa\u6765$\\,d_i\\,$\u7684\u8d21\u732e$\\,(h-d_i)\\,/\\,x+1\\,$\u633a\u597d\u80cc\u7684\u5427\u3002\n# \u4e0d\u5b58\u56fe\n\u4e0d\u5b58\u56fe\u5176\u5b9e\u6bd4\u8f83\u5b8c\u7f8e\u7684\u907f\u514d\u4e86\u8fb9\u592a\u591a\u7684\u5f0a\u7aef\uff0c\u4e5f\u5c31\u6210\u4e86\u5f88\u591a\u4eba\u91c7\u53d6\u7684\u529e\u6cd5\u3002\n```c\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nconst ll maxn=5000005;\nconst ll inf=0x3f3f3f3f3f3f3f3f;//long long 8\u5b57\u8282 \nll n,l,r,a[maxn],dis[maxn],ans;\nqueue<int> q;\nll solve(ll k)\n{\n\tll sum=0;\n\tfor(ll i=0;i<a[1];i++) \n\t\tif(dis[i]<=k) \n\t\t\tsum+=(k-dis[i])/a[1]+1;\n\treturn sum;\n} \nint main()\n{\n\tmemset(dis,inf,sizeof(dis));//\u522b\u5fd8\u8bb0\u521d\u59cb\u5316 \n\tcin>>n>>l>>r;\n\tfor(ll i=1;i<=n;i++)cin>>a[i];\n\tsort(a+1,a+1+n);\n\tif(a[1]==1){//\u7136\u800c\u6ca1\u4ec0\u4e48\u7528\u7684\u7279\u5224\uff0c\u4f46\u662f\u8df3\u697c\u673a\u8981\u7279\u5224 \n\t\tcout<<r-l+1;\n\t\treturn 0;\n\t}\n\tdis[0]=0;\n\tq.push(0);\n\twhile(!q.empty())//\u6700\u77ed\u8def\u4e0d\u5fc5\u591a\u8bf4\u4e86\u5427 \n\t{\n\t\tll u=q.front();\n\t\tq.pop();\n\t\tfor(ll i=2;i<=n;i++)\n\t\t    if (dis[(u+a[i])%a[1]]>dis[u]+a[i])\n\t\t\t{\n\t\t    \tdis[(u+a[i])%a[1]]=dis[u]+a[i];\n\t\t\t\tq.push((u+a[i])%a[1]); \n\t\t\t}\n\t}\n\tcout<<solve(r)-solve(l-1)<<endl;//\u7edf\u8ba1\u7b54\u6848\uff0cl\u4e00\u5b9a\u8981\u51cf1 \n\treturn 0;\n} \n```\n# \u5b58\u56fe\n\u94fe\u5f0f\u524d\u5411\u661f\u5b58\u56fe\uff0c\u4f46\u662f\u8fb9\u592a\u591a\u4e86\uff0c\u5f00\u5c0f\u4e86 RE \uff0c\u5f00\u5927\u4e86 MLE \uff0c\u6211\u4e5f\u662f\u8bd5\u4e86\u597d\u4e45\u624d\u8bd5\u51fa\u6765\u5408\u9002\u7684\u6570\u7ec4\u5927\u5c0f\u3002\n\n```c\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int maxn=2000005;//\u5408\u9002\u7684\u6570\u7ec4\u5927\u5c0f \nconst ll inf=0x3f3f3f3f3f3f3f3f;//long long 8\u5b57\u8282 \nlong long n,l,r,a[maxn],dis[maxn],head[maxn],cnt,ans;\nbool inq[maxn];\nll solve(ll k)\n{\n\tll sum=0;\n\tfor(ll i=0;i<a[1];i++) \n\t\tif(dis[i]<=k) \n\t\t\tsum+=(k-dis[i])/a[1]+1;\n\treturn sum;\n} \nstruct Edge{\n\tlong long to,next,w;\n}e[maxn<<2];//\u4f4d\u8fd0\u7b97\u4e58\u4e8c \nvoid addedge(int u,int v,int w)\n{\n\te[++cnt].to=v;\n\te[cnt].next= ead[u];\n\te[cnt].w=w;\n\thead[u]=cnt;\n}//\u5b58\u56fe \nvoid spfa()//spfa\u4e0d\u5fc5\u591a\u8bf4\u4e86\u5427 \n{\n\tmemset(dis,inf,sizeof dis );\n\tmemset(inq,0,sizeof inq );\n\tqueue<long long> q;\n\tq.push(0);\n\tinq[0]=1;\n\tdis[0]=0;\n\twhile(!q.empty())\n\t{\n\t\tlong long u=q.front();\n\t\tq.pop();\n\t\tinq[u]=0;\n\t\tfor(long long i=head[u];i;i=e[i].next)\n\t\t{\n\t\t\tlong long v=e[i].to;\n\t\t\tlong long w=e[i].w;\n\t\t\tif(dis[v]>dis[u]+w)\n\t\t\t{\n\t\t\t\tdis[v]=dis[u]+w;\n\t\t\t\tif(!inq[v])\n\t\t\t\t{\n\t\t\t\t\tq.push(v);\n\t\t\t\t\tinq[v]=1;\n\t\t\t\t} \n\t\t\t}\n\t\t}\n\t}\n}\nint main()\n{\n\tcin>>n>>l>>r;\n\tfor(int i=1;i<=n;i++)cin>>a[i];\n\tsort(a+1,a+1+n);\n\tif(a[1]==1)//\u7136\u800c\u6ca1\u4ec0\u4e48\u7528\u7684\u7279\u5224\uff0c\u4f46\u662f\u8df3\u697c\u673a\u8981\u7279\u5224 \n\t{\n\t\tcout<<r-l+1<<endl;\n\t\treturn 0;\n\t}\n\tfor(int i=0;i<a[1];i++)\n\t{\n\t\tfor(int j=2;j<=n;j++)\n\t\t{\n\t\t\taddedge(i,(i+a[j])%a[1],a[j]);\n\t\t}\n\t}//\u5b58\u8fb9 \n\tspfa();\n\tcout<<solve(r)-solve(l-1)<<endl;//\u7edf\u8ba1\u7b54\u6848 \n\treturn 0;\n}\n```\n\u5b8c\u7ed3\u6492\u82b1\uff01",
        "postTime": 1626659209,
        "uid": 453100,
        "name": "Tzs_yousa",
        "ccfLevel": 4,
        "title": "P2371\u58a8\u58a8\u7684\u7b49\u5f0f \u9898\u89e3"
    },
    {
        "content": "\u4e00\u5e74\u524d\u5199\u8fc7\u8fd9\u9053\u9898\uff0c\u7136\u540e\u73b0\u5728\u53d1\u73b0\u4e86\u4e00\u4e9b\u5947\u602a\u7684\u4e1c\u897f\u3002\n\n\u9996\u5148\u8fd9\u9053\u9898\u53ef\u4ee5\u8f6c\u5316\u4e3a\u6a21 $A_i$ \u6700\u5c0f\u503c $m$ \u610f\u4e49\u4e0b\u7684\u6700\u77ed\u8def\uff0c\u6c42\u51fa\u6bcf\u4e2a\u6a21 $m$ \u610f\u4e49\u4e0b\u7684\u503c\u6700\u5c11\u8981\u591a\u5c11\u4ee3\u4ef7\u53ef\u4ee5\u8fbe\u6210\uff0c\u7136\u540e\u5206\u522b\u8ba1\u7b97\u7b54\u6848\u7684\u8d21\u732e\u3002\u8fd9\u4e2a\u662f\u7ecf\u5178\u7684\u540c\u4f59\u6700\u77ed\u8def\u3002\n\n\u5b9e\u9645\u4e0a\uff0c\u7531\u4e8e\u540c\u4f59\uff0c\u8fb9\u7684\u66f4\u65b0\u987a\u5e8f\u65e0\u5173\u2014\u2014\u4e5f\u5c31\u662f\u80fd\u5206\u5c42\u66f4\u65b0\u3002\u5f88\u50cf\u5faa\u73af\u4e0b\u6807\u7684\u80cc\u5305\uff0c\u4f46\u662f\u662f\u53d6min\u7684\u800c\u4e0d\u662f\u65b9\u6848\u6570\u3002\n\n\u56e0\u4e3a\u987a\u5e8f\u65e0\u5173\uff0c\u8003\u8651\u5355\u72ec\u66f4\u65b0\u6bcf\u4e2a\u6743\u503c\u3002\u56e0\u4e3a\u540c\u4f59\uff0c\u628a $0 \\dots m - 1$ \u7684\u6240\u6709\u70b9\u6309\u7167\u6a21 $A_i mod m$ \u7684\u503c\u5206\u7c7b\uff0c\u5bf9\u4e8e\u70b9 $i$ \u80fd\u66f4\u65b0\u5230 $j$ \u5f53\u4e14\u4ec5\u5f53 $i \\equiv j (mod A_i)$\uff0c\u56e0\u6b64\uff0c\u70b9\u88ab\u5212\u5206\u6210\u4e86\u4e00\u5806\u73af\uff0c\u73af\u5185\u7684\u5206\u522b\u5904\u7406\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u73af\uff0c\u5bb9\u6613\u8bc1\u660e\u9009\u62e9\u8ddd\u79bb\u6700\u5c0f\u7684\u70b9\u5f00\u59cb\u66f4\u65b0\u662f\u6700\u4f18\u7684\u3002\u56e0\u6b64\u4ece\u6700\u5c0f\u70b9\u5f00\u59cb\uff0c\u7ef4\u62a4\u4e00\u4e2a\u5230\u5f53\u524d\u70b9\u6700\u5c0f\u8ddd\u79bb\uff0c\u7ebf\u6027\u626b\u8fc7\u53bb\u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6 $O(nm)$\n\n\u6240\u4ee5\u4e3a\u4ec0\u4e48\u90a3\u4e48\u591a\u4eba\u90fd\u5728\u5199\u6700\u77ed\u8def\u554a\u2026\u2026\u4e3a\u4ec0\u4e48\u6211\u8fd8\u8dd1\u4e0d\u8fc7\u6700\u77ed\u8def\u554a\u2026\u2026\n\n```cpp\n#include <bits/stdc++.h>\n\ntypedef long long LL;\nconst int MAXN = 500010;\nint n;\nLL bmin, bmax, minn, f[MAXN];\nint mn, A[MAXN];\n\nint main() {\n\tstd::cin >> n >> bmin >> bmax; --bmin;\n\tmn = 1234567;\n\tfor (int i = 1; i <= n; ++i)\n\t\tstd::cin >> A[i], mn = std::min(mn, A[i]);\n\tmemset(f, 0x3f, mn << 3);\n\tf[0] = 0;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tint mod = A[i] % mn;\n\t\tif (!mod) continue;\n\t\tstatic bool vis[MAXN];\n\t\tmemset(vis, 0, mn);\n\t\tfor (int j = 0; j < mn; ++j) if (!vis[j]) {\n\t\t\tint ma = j, now = j;\n\t\t\twhile (!vis[now]) {\n\t\t\t\tvis[now] = true;\n\t\t\t\tif (f[now] < f[ma]) ma = now;\n\t\t\t\tnow += mod - mn, now += now >> 31 & mn;\n\t\t\t}\n\t\t\tnow = ma;\n\t\t\tLL vn = f[now];\n\t\t\tdo {\n\t\t\t\tf[now] = std::min(f[now], vn);\n\t\t\t\tvn = std::min(vn, f[now]) + A[i];\n\t\t\t\tnow += mod - mn, now += now >> 31 & mn;\n\t\t\t} while (now != ma);\n\t\t}\n\t}\n\tLL ans = 0;\n\tfor (int i = 0; i < mn; ++i) {\n\t\tans += f[i] <= bmax ? (bmax - f[i]) / mn + 1 : 0;\n\t\tans -= f[i] <= bmin ? (bmin - f[i]) / mn + 1 : 0;\n\t}\n\tstd::cout << ans << std::endl;\n\treturn 0;\n}\n\n```",
        "postTime": 1568215525,
        "uid": 22066,
        "name": "daklqw",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P2371 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u58a8\u58a8\u7684\u7b49\u5f0f\u3011"
    },
    {
        "content": "## \u540c\u4f59\u6700\u77ed\u8def\n**\u9898\u610f\u5206\u6790\uff1a** \u7ed9\u4f60\u4e00\u4e2an\uff0c\u6709n\u4e2a\u6570\uff0c\u5206\u522b\u4e3aa1\uff0ca2.....an\uff0c\u7136\u540e\u5b58\u5728\u4e00\u4e2a\u7b49\u5f0f\na1x1+a2x2+.....+anxn=B \u5176\u4e2dx\u90fd\u662f\u975e\u8d1f\u6574\u6570\uff0c\u6b64\u65f6\u8fd9\u4e9bx\u53eb\u505a\u4e00\u7ec4\u89e3\uff0c\u7ed9\u4f60B\u7684\u4e00\u4e2a\u4e0a\u4e0b\u5c4a\uff0c\u7136\u540e\u95ee\uff1a\u5bf9\u4e8e\u8fd9\u4e2a\u4e0a\u4e0b\u754c\uff0c\u4e00\u5171\u6709\u591a\u5c11\u7ec4\u89e3\n\n**\u601d\u8def\uff1a** \u9996\u5148\u6211\u4eec\u9700\u8981\u7b80\u5316\u95ee\u9898\uff0c(\u8fd9\u5e94\u8be5\u662f\u6211\u4eec\u90fd\u64c5\u957f\u7684)\uff0c\u7531\u4e8ea\u6709\u5f88\u591a\uff0c\u5c31\u5f88\u70e6\uff0c\u6211\u4eec\u4e0d\u59a8\u627e\u5230\u6700\u5c0f\u7684\u90a3\u4e2aa\uff08amin\uff09\uff0c\u7136\u540e\u5bf9\u4e8e\u4e00\u4e2a\u6570aixi(1<=i<=n)\uff0c\u6211\u4eec\u90fd\u53ef\u4ee5\u5c06\u5176\u5316\u6210amin\u7684\u5176\u4e2d\u4e00\u4e2a\u7c7b\uff0c\u6211\u4eec\u4e00\u5171\u4f1a\u5f97\u5230amin\u4e2a\u7c7b(\u8fd9\u662f\u663e\u7136\u7684)0,1.....amin-1\n\n**\u5b9e\u73b0\uff1a** \u6211\u4eec\u60f3\u8981\u627e\u5230\u4e0a\u4e0b\u754c[l,r]\u4e2d\u6709\u51e0\u4e2a\u6570\u6211\u4eec\u53ef\u4ee5\u7528a1x1+a2x2+.....+anxn\u6765\u8868\u793a\uff0c\u6211\u4eec\u4e0d\u59a8\u5bf9\u7b54\u6848\u5206\u7c7b\uff0c\u6ca1\u9519\uff0c\u5206\u6210amin\u7c7b\uff0c\u663e\u7136\uff0c\u5bf9\u4e8ex\u7c7b\uff0c\u8868\u793a\u7b54\u6848%amin\u7b49\u4e8ex\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u7528amin\u6765\u8868\u793a\u6240\u6709\u7684\u7b54\u6848\u4e86\n\n\u6765\u6027\u611f\u7684\u770b\u4e00\u4e0b\uff1a\n\n\u6211\u4eec\u7528dis[x]\u8868\u793ax\u7c7b\u7684\u6700\u5c0f\u503c(\u5bf9\u4e8e\u6b64\u9898\uff0c\u663e\u7136\uff0c0\u7c7b\u7684\u6700\u5c0f\u503c\u662f0,\u6b64\u65f6\u6240\u6709\u7684x\u90fd\u7b49\u4e8e0\uff0c\u6211\u4eec\u7684\u7b54\u6848\u4e3a0\uff0c\u6240\u4ee50\u7c7b\u7b54\u6848\u7684\u6700\u5c0f\u503c\u4e3a0)(\u5bf9\uff0c\u6ca1\u9519\uff0c\u53ea\u662f\u5bf9\u4e8e\u6b64\u9898\uff0c\u8fd8\u6709\u4e0d\u592a\u4e00\u6837\u7684\uff0c\u6bd4\u5982[P3403](https://www.luogu.org/problem/P3403)\uff0c\u8fd9\u4e2a\u9898\u6bd4\u8fd9\u9053\u9898\u8981\u7b80\u5355\u4e00\u4e9b\uff0c\u5927\u5bb6\u53ef\u4ee5\u641e\u5b8c\u8fd9\u4e2a\u58a8\u58a8\u7136\u540e\u53bb\u505a\u90a3\u4e2a\u9898\uff0c\u5f53\u505a\u7ec3\u4e60)\n\n\u6211\u4eec\u6240\u6709\u7684\u7b54\u6848\uff1a\n\ndis[0],dis[0]+amin,dis[0]+amin+amin,dis[0]+amin+amin+amin\n\ndis[1],dis[1]+amin,dis[1]+amin+amin,dis[1]+amin+amin+amin\n\n........\n\ndis[amin-1]\u3002\u3002\u3002\u3002\u3002\u3002\u3002\u3002\u3002\u3002\u3002\u3002\n\n**\u90a3\u597d\uff0c\u6211\u4eec\u6700\u540e\u7528\u6700\u77ed\u8defspfa\u6765\u6700\u6c42dis\u5c31\u597d\u4e86\uff0c\u7531\u4e8e\u8fb9\u6709\u70b9\u591a\uff0c\u6211\u5c31\u6ca1\u6709\u5efa\u8fb9\uff0cspfa\u6211\u5c31\u4e0d\u53bb\u89e3\u91ca\u4e86\uff0c\u5982\u679c\u5927\u5bb6\u770b\u61c2\u4e86\u90a3\u4e2aspfa\uff0c\u76f8\u4fe1\u5927\u5bb6\u5bf9spfa\uff0c\u8fd8\u6709\u5bf9**\u540c\u4f59\u6700\u77ed\u8def**\u90fd\u4f1a\u6709\u66f4\u5f97\u7406\u89e3\u4e86\uff0c\u81ea\u7136\u7684\uff0c\u8fd9\u9053\u9898\u4e5f\u5c31\u505a\u51fa\u6765\u4e86**\n\n**\u4e0a\u4ee3\u7801\uff1a**\n```cpp\n# include <iostream>\n# include <cstdio>\n# include <cstring>\n# include <algorithm>\n# include <queue>\n# include <stack>\n# define FOR(i,st,ed) for(int i=st;i<=ed;++i)\n# define _FOR(u) for(int v,i=hd[u];i;i=e[i].nt)\n# define _V v=e[i].to\n# define int long long\nusing namespace std;\nint re(){\n\tint s=0,f=1;char ch=getchar();\n\twhile(!isdigit(ch)){if(ch=='-')f=-1;ch=getchar();}\n\twhile(isdigit(ch)){s=(s<<1)+(s<<3)+ch-'0';ch=getchar();}\n\treturn s*f;\n}\nconst int N=5e5+7;\nconst int inf=1e15;\nint n,l,r;int ans;\nint a[N];\nint dis[N],vis[N];\nqueue <int> q;\nvoid spfa(){\n\tFOR(i,0,a[1]-1) dis[i]=inf; \n\tdis[0]=0;q.push(0);vis[0]=1;\n\twhile(q.size()){\n\t\tint u=q.front();q.pop();vis[u]=0;\n\t\tFOR(i,2,n){\n\t\t\tint v=(u+a[i])%a[1];\n\t\t\tif(dis[v]>dis[u]+a[i]){\n\t\t\t\tdis[v]=dis[u]+a[i];\n\t\t\t\tif(!vis[v]) q.push(v),vis[v]=1; \n\t\t\t}\n\t\t}\n\t}\n}\nsigned main(){\n\tn=re();l=re();r=re();\n\tFOR(i,1,n) a[i]=re();\n\tsort(a+1,a+n+1);\n\tspfa();\n\tFOR(i,0,a[1]-1){\n\t\tif(dis[i]<l) ans+=(r-dis[i])/a[1]+1-(l-1-dis[i])/a[1]-1;\n        //\u5dee\u5206\u65f6\uff0c\u6ce8\u610f\u662fl-1\uff0c\u800c\u4e0d\u662fl\n\t\tif(l<=dis[i]&&dis[i]<=r) ans+=(r-dis[i])/a[1]+1;\n\t}\n\tcout<<ans;\n\treturn 0;\n}\n\n```\n",
        "postTime": 1564821723,
        "uid": 118118,
        "name": "\u51cc\u4e71",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2371 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u58a8\u58a8\u7684\u7b49\u5f0f\u3011"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u9053\u6570\u5b66?\u8fd9\u662f\u4e00\u4e2a\u80cc\u5305?\u4e0d,\u8fd9\u662f\u4e00\u9053\u56fe\u8bba!\n\n\u89c2\u5bdf\u53d1\u73b0\u7cfb\u6570\u90fd\u5f88\u5c0f\u3002\u6211\u4eec\u6839\u636ePOI2013SUMS\u7684\u540c\u4f59\u7c7bbfs\uff0c\u9996\u5148\u8f6c\u5316\u4e3a\u5728\u540c\u4f59\u6700\u5c0f\u7684\u90a3\u4e2a\u8ddd\u79bb\u4e0a\u641e\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u627e\u5230\u7b2c\u4e00\u4e2a\u5728%X(\u5047\u5b9aX\u662f\u6700\u5c0f\u7684\u90a3\u4e00\u4e2a\u7cfb\u6570)\u6700\u5c0f\u7684\u5230\u8fbe\u90a3\u4e2a%X\u610f\u4e49\u4e0b\u7684\u6700\u5c0f\u6570\u3002\u8fd9\u6837%X\u610f\u4e49\u4e0b\u66f4\u5927\u7684\u7b54\u6848\u4e5f\u4e00\u5b9a\u53ef\u4ee5\u5230\u8fbe\u3002\u8fd9\u6837\u6211\u4eec\u8dd1\u4e00\u4e0bSPFA(\u663e\u7136\u8fd9\u79cd\u9898\u5bf9SPFA\u5341\u5206\u53cb\u597d),\u5c31\u53ef\u4ee5\u627e\u51fa\u6765\u4e86\uff0c\u4e4b\u540e\u5c31\u968f\u4fbf\u641e\u51fa\u6765\u4e86\u3002\n\n\u4e3b\u8981\u53d7\u5230\u90a3\u9053\u9898\u542f\u53d1\u624d\u505a\u51fa\u6765\u3002\u5bf9\u4e8e\u8fd9\u6837\u7684\u4e00\u7c7b\u9898\uff0c\u6709\u4e00\u4e2a\u540d\u5b57\uff0c\u53eb\u540c\u4f59\u7c7bBFS,\u6709\u673a\u4f1a\u5b66\u4e00\u5b66\u8fd8\u662f\u89c9\u5f97\u5341\u5206\u673a\u667a\u7684.\n\n\u6b22\u8fce\u6765[Newuser\u849f\u84bb\u535a\u5ba2](http://www.newuser.top/2018/10/28/%e3%80%90%e5%9b%bd%e9%9b%86%e5%a2%a8%e5%a2%a8%e7%9a%84%e7%ad%89%e5%bc%8f%e3%80%91%e5%90%8c%e4%bd%99%e7%b1%bbbfs/)\u770b\u770b!\n\ntalk is cheap , show me code!\n```\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<queue>\nusing namespace std;\ntypedef long long ll;\nconst int maxn = 500005;\nll dis[maxn];\nint n;ll bmin,bmax;\nint a[15]; bool rd[maxn];\nqueue<int>q;\nvoid spfa() {\n    for(int i=0;i<a[1];i++) dis[i]=1e15;\n    q.push(0); rd[0]=1; dis[0]=0;\n    while(q.size()) {\n        int x=q.front(); q.pop(); rd[x]=0;\n        for(int i=2;i<=n;i++) {\n            int o = (x+a[i])%a[1];\n            if(dis[o]>dis[x]+a[i]) {\n                dis[o]=dis[x]+a[i];\n                if(!rd[o]) {\n                    q.push(o);  rd[o]=1;\n                }\n            }\n        }\n    } \n}\nint main()  {\n    scanf(\"%d%lld%lld\",&n,&bmin,&bmax);\n    for(int i=1;i<=n;i++) {\n        scanf(\"%d\",&a[i]);\n    }\n    sort(a+1,a+1+n);\n    spfa();\n    ll ans = 0;\n    for(int i=0;i<a[1];i++) {\n        if(dis[i]<=bmax) {\n            if(dis[i]>=bmin) ans += ((bmax-dis[i])/a[1]+1);\n            else {\n                ans+=(bmax-dis[i])/a[1]+1;\n                ans-=(bmin-dis[i]+a[1]-1)/a[1];\n            }\n        }\n    }\n    printf(\"%lld\",ans);\n}\n```",
        "postTime": 1540671152,
        "uid": 55343,
        "name": "Newuser",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2371 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u58a8\u58a8\u7684\u7b49\u5f0f\u3011"
    },
    {
        "content": "\u8003\u5bdf\u7684\u662f\u300e\u540c\u4f59\u6700\u77ed\u8def\u300f\uff0c\u5f88\u5de7\u5999\u7684\u4e00\u79cd\u5904\u7406\u65b9\u6cd5\u3002\u8fd9\u91cc\u8bf4\u4e00\u4e0b\u81ea\u5df1\u7684\u7406\u89e3\u3002\n\n\u9898\u610f\u770b\u4e0a\u53bb\u5f88\u7b80\u5355\uff0c\u4f46\u611f\u89c9\u65e0\u4ece\u4e0b\u624b\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u4e00\u5c42\u4e00\u5c42\u5730\u5206\u6790\u3002\n\n1.\u9996\u5148\u6c42\u533a\u95f4$[l,r]$\u7684\u6ee1\u8db3\u6761\u4ef6\u7684\u4e2a\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u8f6c\u5316\u4e3a\u6c42$[1,r]-[1,l-1]$\u7684\u7b54\u6848\uff0c\u95ee\u9898\u53d8\u6210\u4e86:\u5c0f\u4e8e\u7b49\u4e8e$x$\u7684$b$\u6709\u591a\u5c11\u4e2a\u3002\n\n2.\u89c2\u5bdf\u6570\u636e\u8303\u56f4:\u53d1\u73b0$n$\u6781\u5c0f\uff0c\u4e0d\u77e5\u9053\u6709\u4ec0\u4e48\u7528,$a[i]$\u7684\u8303\u56f4\u5f88\u6709\u7279\u70b9\uff0c$10^5$\u8fd9\u4e2a\u6570\u5b57\u548c\u5f88\u591a\u7684\u7b97\u6cd5\u6709\u5173\uff0c\u800c$l,r$\u7684\u8303\u56f4\u5de8\u5927\uff0c\u4ece$l,r$\u5165\u624b\u4e0d\u592a\u53ef\u53d6\u3002\u56e0\u6b64\u6211\u4eec\u60f3\u4ece$n,a[i]$\u4e2d\u627e\u70b9\u6027\u8d28\u3002\n\n\uff13\uff0e\u6211\u4eec\u5148\u7ed9$a[i]$\u6392\u4e2a\u5e8f\uff0c\u7136\u540e\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u5982\u679c\u4e00\u4e2a\u503c$val$\u5b83\u53ef\u4ee5\u88ab\u8868\u793a\u51fa\u6765\uff0c\u90a3\u4e48\u6240\u6709\u7684$val+k*a[1]$\u90fd\u53ef\u4ee5\u88ab\u8868\u793a\u51fa\u6765\u3002\n\n\uff14\uff0e\u8fdb\u4e00\u6b65\u5206\u6790\uff1a\u786e\u5b9a\u4e86\u4e00\u4e2a$val$\uff0c$val+k*a[1]$\u90fd\u80fd\u88ab\u8868\u793a\uff0c\u5b83\u4eec\u5bf9$a[1]$\u53d6\u819c\u540e\u7684\u7ed3\u679c\u662f\u4e00\u6837\u7684\uff01\u90a3\u6211\u6709\u4e00\u4e2a\u5f88\u68d2\u7684\u60f3\u6cd5\uff1a\u4f59\u6570$0,1.....a[1]-1$\uff0c\u6211\u60f3\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u4f59\u6570$p$\uff0c\u90fd\u627e\u5230\u7528\u6240\u6709\u7684$a[i]$\uff0c\u80fd\u591f\u8868\u793a\u51fa\u7684\u6700\u5c0f\u7684%$a[1]=p$\u7684\u503c\u662f\u591a\u5c11\uff0c\u7531\u6b64\u5c31\u80fd\u77e5\u9053\u5728\u5c0f\u4e8e\u7b49\u4e8e$x$\u7684\u6240\u6709\u503c\u4e2d\uff05$a[1]=p$\u7684\u503c\u4e00\u5171\u6709\u591a\u5c11\u4e2a\u3002\n\n\uff15\uff0e\u611f\u89c9\u627e\u5230\u80fd\u591f\u8868\u793a\u51fa\u7684\u6700\u5c0f\u7684\uff05$a[1]=p$\u7684\u503c\u662f\u591a\u5c11\u5f88\u96be\u529e\uff1f\u6211\u4eec\u53ef\u4ee5\u5047\u8bbe$dp[i]$\u8868\u793a\u6700\u5c0f\u7684\uff05$a[1]=i$\u7684\u503c\u662f\u591a\u5c11\u3002\u90a3\u4e48\u53ef\u4ee5\u60f3\u5230\u4e00\u4e2a\u8f6c\u79fb\u65b9\u7a0b:$dp[(a[j]+i)$%$a[1]]=min(dp[(a[j]+i)$%$a[1]],dp[i]+a[j]).$ \u4f60\u628a$dp$\u6362\u6210$dis$\uff0c\u662f\u4e0d\u662f\u611f\u89c9\u8fd9\u5f88\u50cf\u6700\u77ed\u8def\u7684\u5f62\u5f0f\uff1f\u6211\u4eec\u628a$dp[i]$\u653e\u5230\u6700\u77ed\u8def\u4e2d\u5b8c\u6210\u8fd9\u4ef6\u4e8b\u60c5\uff0c\u4e8e\u662f\u672c\u9898\u5f97\u5230\u5b8c\u7f8e\u89e3\u51b3\u3002\n\n\uff16\uff0e\u603b\u7ed3\uff1a\u540c\u4f59\u6700\u77ed\u8def\u662f\u4e00\u79cd\u975e\u5e38\u795e\u5947\u7684\u6280\u5de7\uff0c\u5e76\u53ef\u4ee5\u5728\u4e00\u4e9b\u9898\u76ee\u4e2d\u5f97\u5230\u5b8c\u7f8e\u7684\u5c55\u73b0\u3002\u5b9e\u9645\u4e0a\uff0c\u6211\u8ba4\u4e3a\u5b83\u662f\u4ece$dp$\u65b9\u7a0b\u8f6c\u79fb\u63a8\u8fc7\u6765\u7684\u4e00\u79cd\u4f18\u5316\u7684\u5904\u7406\u65b9\u5f0f\uff0c\u5b83\u7684\u5b9e\u8d28\u662f$dp$\u3002\n\u8f6c\u5316\u4e3a\u6700\u77ed\u8def\u540e\uff0c\u5c31\u53ef\u4ee5\u4f7f\u590d\u6742\u5ea6\u964d\u4e3a$O(a_{1}log \\ a_{1})$,\u6548\u7387\u5927\u5927\u63d0\u9ad8\u3002\n\n$code:$\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define reg register\nusing namespace std;\nconst int maxn=1e6+5;\nconst int mod=31011;\nconst int INF=2e16;\ninline int read()\n{\n\tint x=0,f=1;\n\tchar ch=getchar();\n\twhile(ch<'0' || ch>'9')\n\t{\n\t\tif(ch=='-')\n\t\tf=-1;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0' && ch<='9')\n\t{\n\t\tx=x*10+ch-'0';\n\t\tch=getchar();\n\t}\n\treturn x*f;\n}\nint n,l,r,a[maxn],k,vis[maxn],dist[maxn];\nqueue<int> q;\nint Work(int x)\n{\n\tint res=0;\n\tfor(reg int i=0;i<k;i++)\n\t{\n\t\tif(dist[i]!=INF)\n\t\t{\n\t\t\tint wns=max((x-i)/k+1-dist[i],(int)0);\n\t\t\tres+=wns;\n\t\t}\n\t}\n\treturn res;\n}\nsigned main()\n{\n\tn=read();\n\tl=read(),r=read();\n\tfor(reg int i=1;i<=n;i++)\n\t{\n\t\ta[i]=read();\n\t}\n\tsort(a+1,a+1+n);\n\tk=a[1];\n\tfor(reg int i=0;i<=k;i++)\n\tdist[i]=2e16;\n\tdist[0]=0;\n\tvis[0]=1;\n\tq.push(0);\n\twhile(!q.empty())\n\t{\n\t\tint x=q.front();\n\t\tq.pop();\n\t\tvis[x]=0;\n\t\tfor(reg int i=1;i<=n;++i)\n\t\t{\n\t\t\tint t=(x+a[i])%k;\n\t\t\tif(dist[t]>dist[x]+a[i])\n\t\t\t{\n\t\t\t\tdist[t]=dist[x]+a[i];\n\t\t\t\tif(vis[t]==0)\n\t\t\t\t{\n\t\t\t\t\tvis[t]=1;\n\t\t\t\t\tq.push(t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(reg int i=0;i<k;i++)\n\t{\n\t\tif(dist[i]!=INF)\n\t\t{\n\t\t\tdist[i]=(dist[i]-i)/k;\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",Work(r)-Work(l-1));\n\treturn 0;\n}\n```\n",
        "postTime": 1610497518,
        "uid": 114514,
        "name": "zzr8178541919",
        "ccfLevel": 7,
        "title": "P2371 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u58a8\u58a8\u7684\u7b49\u5f0f"
    },
    {
        "content": "\u4e00\u4e2a\u6bd4\u8f83\u7b80\u5355\u7684 trick\u3002\u4f3c\u4e4e\u7f51\u4e0a\u73b0\u5728\u53ea\u6709\u4e24\u9053\u9898\uff08[\u8df3\u697c\u673a](https://www.luogu.com.cn/problem/P3403) \u548c [\u58a8\u58a8\u7684\u7b49\u5f0f](https://www.luogu.com.cn/problem/P2371)\uff09\u3002\u5e72\u8106\u5c31\u6765\u5199\u4e00\u4e0b\u5427\u3002\n\n## \u540c\u4f59\u6700\u77ed\u8def\n\n\u901a\u8fc7\u540c\u4f59\u6784\u9020\u4e00\u4e9b\u72b6\u6001\uff0c\u72b6\u6001 $x \\to y$ \u76f8\u5f53\u4e8e\u56fe\u4e0a\u70b9 $x$ \u8fde\u4e0a\u4e00\u6761\u6709\u5411\u5e26\u6743\u7684\u8fb9\u81f3 $y$\u3002\n\n\u56e0\u6b64\u53ef\u901a\u8fc7\u6b64\u65b9\u6cd5\u5efa\u56fe\u8dd1\u6700\u77ed\u8def\uff0c\u4ee5\u6b64\u8fbe\u5230\u89e3\u51b3\u95ee\u9898\u7684\u6548\u679c\u3002\n\n### [\u3010\u4f8b\u9898\u3011\u8df3\u697c\u673a](https://www.luogu.com.cn/problem/P3403)\n\n\u6709\u56db\u79cd\u64cd\u4f5c\uff0c\u5206\u522b\u4e3a\uff1a\n\n- \u5411\u4e0a\u8df3 $x$ \u5c42\uff1b   \n- \u5411\u4e0a\u8df3 $y$ \u5c42\uff1b   \n- \u5411\u4e0a\u8df3 $z$ \u5c42\uff1b   \n- \u56de\u5230\u7b2c $1$ \u5c42\u3002\n\n\u7ed9\u5b9a\u6700\u9ad8\u697c\u5c42 $h$\uff0c\u95ee\u53ef\u4ee5\u5230\u8fbe\u591a\u5c11\u4e0d\u540c\u7684\u697c\u5c42\u3002\n\n---\n\n\u5148\u5047\u8bbe $x < y < z$\u3002\n\n\u5b9a\u4e49 $d_i$ \u4e3a\u53ea\u901a\u8fc7\u64cd\u4f5c $2,3$ \u80fd\u591f\u8fbe\u5230\u7684\u6700\u4f4e\u697c\u5c42 $p$\uff0c\u5e76\u4e14\u6ee1\u8db3 $p \\ \\bmod x =i$\u3002\n\n\u4e0d\u96be\u5f97\u5230\u4e24\u4e2a\u72b6\u6001\uff1a\n\n- $i \\stackrel{y}{\\longrightarrow}[(i+y) \\ \\bmod x]$\uff1b\n- $i \\stackrel{z}{\\longrightarrow}[(i+z) \\ \\bmod x]$\u3002\n\n\u53ea\u8981\u6211\u4eec\u6c42\u51fa $d_0,d_1,\\dots,d_{x-1}$\uff0c\u7b54\u6848\u5c31\u663e\u800c\u6613\u89c1\u4e86\u3002\u5728\u6b64\u57fa\u7840\u4e0b\u6211\u4eec\u53ea\u9700\u8981\u8df3\u5230\u4e0d\u80fd\u518d\u8df3\uff0c\u5bf9\u4e8e\u7b54\u6848\u7d2f\u52a0\u5c31\u884c\u4e86\u3002\u663e\u7136\u80fd\u591f\u8bc1\u660e\u8df3\u7684\u697c\u5c42\u4e0d\u4f1a\u91cd\u590d\u3002\u7b54\u6848\u5373\u4e3a\uff1a\n\n$$\\sum_{i=0}^{x-1} \\lfloor \\frac{(h-d_i)}{x} \\rfloor +1$$\n\n\u6ce8\uff1a\u8fd9\u91cc\u9700\u8981\u52a0\u4e00\u7684\u539f\u56e0\u662f\u73b0\u5728\u6240\u5904\u7684\u697c\u5c42\u4e5f\u8981\u7b97\u4e00\u6b21\u3002\n\n\u73b0\u5728\u7684\u6700\u4e3b\u8981\u95ee\u9898\u662f $d_i$ \u5982\u4f55\u6c42\u51fa\u3002\n\n\u8054\u60f3\u5230\u6700\u77ed\u8def\uff0c\u6700\u77ed\u8def\u7684\u8f6c\u79fb\u662f\uff1a\n\n$$i \\stackrel{val}{\\longrightarrow}j$$\n\n\u8fd9\u4e2a\u8f6c\u79fb\u5b9e\u9645\u4e0a\u548c\u9898\u76ee\u8981\u6c42\u7684\u72b6\u6001\u662f\u76f8\u50cf\u7684\uff0c\u6211\u4eec\u53ea\u9700\u8981\u4ee4 $i,[(i+y) \\ \\bmod x]$ \u4e0e $[(i+z) \\ \\bmod x]$ \u4e3a\u70b9\uff0c$y,z$ \u4e3a\u6743\u503c\u5c31\u80fd\u591f\u8f6c\u79fb\u4e86\u3002\n\n\u5b9a\u4e49\u5230\u8fd9\u91cc\uff0c\u663e\u7136\u7684\uff0c$d_i$ \u5c31\u662f $1 \\to i$ \u7684\u6700\u77ed\u8def\u3002\u76f4\u63a5\u4f7f\u7528\u6700\u77ed\u8def\u7b97\u6cd5\u5373\u53ef\u3002\u8fd9\u91cc\u4f7f\u7528\u7684 Dijkstra \u7b97\u6cd5\u3002\u4f46\u662f\u8fd9\u79cd\u9898\u63a8\u8350\u4f7f\u7528 SPFA\uff0c\u8fd9\u6837\u5efa\u56fe\u662f\u4e0d\u4f1a\u88ab\u5361\u7684\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\nstruct Edge{\n\tLL v,val;\n\tEdge(){}\n\tEdge(LL V,LL VAL){v=V,val=VAL;}\n};\nstruct Point{\n\tLL val;\n\tint s;\n\tPoint(){}\n\tPoint(LL VAL,int S){val=VAL,s=S;}\n\tbool operator < (Point another) const {return val<another.val;}\n};\nvector<Edge> G[100005];\nLL h,d[100005];\nint x,y,z;\nvoid Dijkstra(LL s)\n{\n\tmemset(d,63,sizeof d);\n\td[1]=1;\n\tpriority_queue<Point> Q;\n\tQ.push(Point(1,s));\n\twhile(!Q.empty())\n\t{\n\t\tPoint now=Q.top();\n\t\tQ.pop();\n\t\tint p=now.s;\n\t\tLL val=now.val;\n\t\tif(val<d[p])\tcontinue;\n\t\tfor(unsigned int i=0;i<G[p].size();++i)\n\t\t{\n\t\t\tif(G[p][i].val+d[p]<d[G[p][i].v])\n\t\t\t{\n\t\t\t\td[G[p][i].v]=G[p][i].val+d[p];\n\t\t\t\tQ.push(Point(d[G[p][i].v],G[p][i].v));\n\t\t\t}\n\t\t}\n\t}\n}\nint main(){\n\tscanf(\"%lld %d %d %d\",&h,&x,&y,&z);\n\tif(x==1 || y==1 || z==1)\treturn printf(\"%lld\",h)&0;\n\tint a[5];\n\ta[1]=x,a[2]=y,a[3]=z;\n\tsort(a+1,a+4);\n\tx=a[1],y=a[2],z=a[3];\n\tfor(int i=0;i<x;++i)\tG[i].emplace_back(Edge((i+y)%x,y)),G[i].emplace_back(Edge((i+z)%x,z));\n\tDijkstra(1);\n\tLL ans=0;\n\tfor(int i=0;i<x;++i)\tif(d[i]<=h)\tans+=(h-d[i])/x+1;\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```\n\n### [\u3010\u62d3\u5c55\u3011\u58a8\u58a8\u7684\u7b49\u5f0f](https://www.luogu.com.cn/problem/P2371)\n\n\u9898\u610f\uff1a\n\n\u7ed9\u5b9a $a_1,a_2,\\dots,a_n,l,r,n$\uff0c\u6c42\u6709\u591a\u5c11\u4e2a $b \\in [l,r]$\uff0c\u4f7f\u5f97\u7b49\u5f0f\u5b58\u5728\u975e\u8d1f\u6574\u6570\u89e3\u3002\n\n\u4e0e\u4e0a\u9898\u76f8\u5dee\u4e0d\u5927\uff0c\u552f\u4e00\u7684\u53d8\u5316\u662f\u6c42\u6709\u591a\u5c11\u4e2a $b \\in [l,r]$ \u6ee1\u8db3\u6761\u4ef6\uff0c\u5b9e\u9645\u4e0a\u7b49\u540c\u4e8e\u5206\u522b\u6c42\u6709\u591a\u5c11\u4e2a $b \\in [1,r]$ \u6ee1\u8db3\u6761\u4ef6\u548c\u6709\u591a\u5c11\u4e2a $b \\in [1,l-1]$ \u6ee1\u8db3\u6761\u4ef6\u3002\u7136\u540e Dijkstra \u5199\u4e11\u7684\u88ab\u5361\u4e86\u3002\n\n\u533a\u522b\u5728\u4e8e\u4e0a\u9898\u6709 $3$ \u4e2a\u4e0a\u697c\u7684\u64cd\u4f5c\uff0c\u8fd9\u4e2a\u9898\u6709 $n$ \u4e2a\u3002\u7167\u5e38\u5efa\u56fe\u5c31\u884c\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\nchar buf[1<<21],*p1=buf,*p2=buf;\n#define getchar() (p1==p2 && (p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\nLL read()\n{\n\tLL x=0,f=1;\n\tchar c=getchar();\n\twhile(c<'0' || c>'9')\n\t{\n\t\tif(c=='-')\tf=-1;\n\t\tc=getchar();\n\t}\n\twhile(c>='0' && c<='9')\tx=(x<<1)+(x<<3)+(c^'0'),c=getchar();\n\treturn x*f;\n}\nvoid write(LL x)\n{\n\tif(x<0)\tputchar('-'),x=-x;\n\tif(x>9)\twrite(x/10);\n\tputchar(x%10+'0');\n}\nstruct Edge{\n\tint v,val;\n\tEdge(){v=val=0;}\n\tEdge(int V,int VAL){v=V,val=VAL;}\n};\nstruct Point{\n\tint val,s;\n\tPoint(){val=s=0;};\n\tPoint(int VAL,int S){val=VAL,s=S;}\n\tbool operator < (Point another) const {return val<another.val;}\n};\nvector<Edge> G[500005];\nLL l,r,d[500005];\nbool vis[500005];\nint n,a[15];\nvoid Spfa(int s)\n{\n\tmemset(d,63,sizeof d);\n\tqueue<int> Q;\n\td[s]=0;\n\tQ.push(s);\n\twhile(!Q.empty())\n\t{\n\t\tint now=Q.front();\n\t\tQ.pop();\n\t\tvis[now]=false;\n\t\tfor(unsigned int i=0;i<G[now].size();++i)\n\t\t{\n\t\t\tint to=G[now][i].v,val=G[now][i].val;\n\t\t\tif(d[to]>d[now]+val)\n\t\t\t{\n\t\t\t\td[to]=d[now]+val;\n\t\t\t\tif(!vis[to])\tQ.push(to),vis[to]=true;\n\t\t\t}\n\t\t}\n\t}\n}\nLL query(LL upper)\n{\n\tLL ans=0;\n\tfor(LL i=0;i<a[1];++i)\tif(d[i]<=upper)\tans+=(upper-d[i])/a[1]+1;\n\treturn ans;\n}\nint main(){\n\tn=read(),l=read(),r=read();\n\tfor(LL i=1;i<=n;++i)\n\t{\n\t\ta[i]=read();\n\t\tif(a[i]==1)\treturn write(r-l+1),0;\n\t\tif(!a[i])\t--n,--i;\n\t}\n\tsort(a+1,a+1+n);\n\tLL p=unique(a+1,a+1+n)-a-1;\n\tn=p;\n\tif(n==1)\treturn write(r/a[1]-(l-1)/a[1]),0;\n\tfor(LL i=0;i<a[1];++i)\tfor(LL j=2;j<=n;++j)\tG[i].emplace_back(Edge((i+a[j])%a[1],a[j]));\n\t/*\n\t0 2\n\t1 0\n\t2 1\n\t*/\n\tSpfa(0);\n\twrite(query(r)-query(l-1));\n\treturn 0;\n}\n```\n\n\n\u5b8c\u3002",
        "postTime": 1593913909,
        "uid": 184977,
        "name": "pomelo_nene",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2371 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]\u58a8\u58a8\u7684\u7b49\u5f0f\u3011"
    },
    {
        "content": "\u65f6\u949f\u7684\u5206\u9488\u5411\u524d\u8d70\u52a8\u4e86\u4e00\u4e2a\uff0c\u5c4f\u5e55\u91cc\u7684\u9898\u76ee\u9759\u9759\u505c\u5728\u4e00\u4e2a\u65b9\u7a0b\u4e0a\uff0c\u8fd9\u662f\u7c73\u5c14\u5609\u5728\u7ed9\u540c\u5b66\u4eec\u4f5c\u62a5\u544a\u3002\n\n\u6211\u4eec\u90fd\u5728\u770b\u9898\u3002\u6211\u8ba4\u771f\u60f3\u4e86\u4e94\u5206\u949f\uff0c\u600e\u4e48\u770b\u600e\u4e48\u662f\u6570\u5b66\u9898\u2014\u2014\u5373\u4f7f\u8fd9\u6837\uff0c\u8fd8\u662f\u6709\u4eba\u60f3\u5230\u4e86 DP\uff0c\u6709\u4eba\u60f3\u5230\u4e86\u6570\u8bba\uff0c\u6709\u4eba\u60f3\u5230\u4e86\u4e8c\u5206\uff0c\u8fd8\u6709\u4eba\u66f4\u63a5\u8fd1\u76ee\u7684\u5730\uff0c\u610f\u8bc6\u5230\u4e86\u540c\u4f59\u3002\n\n\u201c\u6211\u4eec\u80fd\u4e0d\u80fd\u8f6c\u5316\u4e00\u4e0b\u95ee\u9898\uff0c\u628a\u4ed6\u53d8\u6210\u4e24\u4e2a\u533a\u95f4\u6c42\u5dee\u7684\u95ee\u9898\u5462\uff1f\u201d\u6cf0\u6735\u62c9\u8bf4\u3002\n\n\u201c\u6211\u77e5\u9053\u4f60\u4eec\u90fd\u6709\u5f88\u591a\u7684\u601d\u8def\uff0c\u4f46\u662f\u5982\u679c\u6211\u4eec\u4ece\u533a\u95f4\u5165\u624b\u2026\u2026\u201d\u7c73\u5c14\u5609\u8bdd\u97f3\u8fd8\u6ca1\u843d\uff0c\u5979\u8eab\u8fb9\u7684\u5c24\u91cc\u4e3e\u8d77\u4e86\u624b\u3002\n\n\u201c\u5c24\u91cc\u4f60\u8bf4\u3002\u201d\n\n\u201c\u7c73\u5c14\u5609\u5927\u4eba\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0d\u53ef\u4ee5\u518d\u6570\u5b66\u7684\u57fa\u7840\u4e0a\uff0c\u7528\u56fe\u8bba\u7684\u601d\u60f3\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u5462\uff1f\u6211\u89c9\u5f97\u8fd9\u4e2a\u662f\u5f88\u5e38\u89c1\u7684\u3002\u201d\n\n\u201c\u5bf9\u4e86\uff0c\u8fd9\u9053\u9898\u5176\u5b9e\u662f\u4e00\u9053\u2026\u2026\u201d\u7c73\u5c14\u5609\u6e05\u6670\u7684\u58f0\u97f3\u56de\u8361\u5728\u5927\u5385\u3002\n\n\u201c\u6700\u77ed\u8def\u3002\u201d\u91cc\u7eb1\u8865\u5145\u9053\u3002\n\n## \u540c\u4f59\u6700\u77ed\u8def\n\n\u6700\u77ed\u8def\uff0c\u6211\u60f3\u3002\n\n\u90a3\u5c31\u5148\u7ed9 $a_i$ \u6392\u4e2a\u5e8f\u5427\u3002\n\n\u6211\u4eec\u5e94\u8be5\u8981\u610f\u8bc6\u5230\uff0c\u5bf9\u4e8e $[l,r]$ \u5982\u6b64\u4e4b\u5927\u7684\u8303\u56f4\uff0c\u7528\u5b8c\u5168\u80cc\u5305\u663e\u7136\u662f\u4e0d\u884c\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u6c42\u51fa $0\\sim r$ \u6ee1\u8db3\u6761\u4ef6\u7684 $b$\uff0c\u518d\u6c42\u51fa $0\\sim l-1$\uff0c\u4e24\u4e2a\u76f8\u51cf\u5c31\u53ef\u4ee5\u5f97\u5230\u6211\u4eec\u6240\u9700\u7684\u533a\u95f4\u7b54\u6848\u3002\n\n\u6211\u4eec\u7684\u624b\u4e0a\u6709\u4e00\u4e2a $b$\uff0c\u8fd9\u662f\u4e00\u4e2a\u53ef\u4ee5\u88ab\u8868\u793a\u51fa\u6765\u7684 $b$\uff0c\u5177\u4f53\u5730\uff1a\n\n$$\\sum\\limits_{i=1}^{n}a_ix_i=b$$\n\n\u9664\u4e86\u8fd9\u4e2a $b$\uff0c\u6211\u4eec\u624b\u4e0a\u4ec0\u4e48\u90fd\u6ca1\u6709\uff0c\u6211\u4eec\u8981\u521b\u9020\u51fa\u65b0\u7684\u4e1c\u897f\uff0c\u6211\u4eec\u8981\u8ba9\u770b\u770b\u80fd\u6709\u591a\u5c11\u4e2a $b$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u8bd5\u7740\u5c06\u5176\u4e2d\u7684 $x_1$ \u589e\u52a0 $1$\uff0c\u4e5f\u5c31\u662f $x_1\\gets x_1+1$\u3002\u8fd9\u65f6\u5019\u6211\u4eec\u7684 $b$ \u53d8\u5316\u4e86\u2014\u2014\u7531\u4e8e $x_1$ \u53d8\u5316\u4e86 $1$\uff0c\u800c\u5b83\u7684\u7cfb\u6570\u662f $a_i$\uff0c\u6240\u4ee5\u6211\u4eec\u7684 $b$ \u53d8\u6210\u4e86 $b'$\uff0c\u6ee1\u8db3 $b'=b+a_1$\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c\u6309\u7167\u8fd9\u6837\u7684\u65b9\u6cd5\uff0c\u7eb7\u7e41\u53d8\u6362\u5404\u79cd\u5404\u6837\u7684 $x_i$\uff0c\u6211\u4eec\u5b9e\u9645\u4e0a\u53ef\u4ee5\u5f97\u5230\u5f88\u591a\u6570\u3002\u4f46\u662f\u6211\u4eec\u4e0d\u8981\u8ba9\u4e8b\u60c5\u592a\u590d\u6742\uff0c\u6211\u4eec\u53ea\u8003\u8651 $a_1$\u3002\u5982\u679c $b$ \u662f\u53ef\u4ee5\u8868\u793a\u7684\uff0c\u90a3\u4e48 $k\\cdot a_1+b$ \u4e00\u5b9a\u53ef\u4ee5\u8868\u793a\u3002\n\n\u6211\u4eec\u518d\u8fdb\u4e00\u6b65\u5427\u3002\n\n\u65e2\u7136\u4ed6\u4eec\u6709\u7740\u76f8\u540c\u7684\u5f62\u5f0f\uff0c\u90fd\u53ef\u4ee5\u8868\u793a\u4e3a $b'=k\\cdot a_1+b$\uff0c\u90a3\u4e48\u5fc5\u7136\u4f1a\u5b58\u5728 $b\\bmod a_1\\equiv b$\uff0c\u4ed6\u4eec\u5c5e\u4e8e\u540c\u4e00\u4e2a\u540c\u4f59\u7c7b\u3002\u6211\u4eec\u4e00\u5171\u6709 $1,2,3\\cdots a_1$ \u8fd9\u4e48\u591a\u4e2a\u540c\u4f59\u7c7b\u3002\u4e3a\u4e86\u5bf9\u5e94\u540c\u4f59\u7c7b\uff0c\u6211\u4eec\u53ef\u4ee5\u53bb\u518d $a$ \u6570\u5217\u4e2d\u5bfb\u627e\u4e00\u4e2a $a_i$ \u4f7f\u5f97 $a_i\\bmod a_1\\equiv p$\uff0c\u8fd9\u4e2a $p$ \u5bf9\u5e94\u5176\u4e2d\u7684\u67d0\u4e00\u4e2a\u540c\u4f59\u7c7b\u3002\n\n\u63a5\u4e0b\u6765\u8fd9\u4e00\u6b65\u6700\u4e3a\u5de7\u5999\u3002\u5982\u679c\u6211\u4eec\u5c1d\u8bd5\u7528\u52a8\u6001\u89c4\u5212\u53bb\u89e3\u51b3\u8fd9\u9053\u9898\u76ee\uff0c\u5373\u7528 $f_i$ \u8868\u793a\u6700\u5c0f\u7684 $b$ \u4f7f\u5f97 $b\\bmod a_1\\equiv i$\u2014\u2014\u4e5f\u5c31\u662f\u627e\u5230\u6700\u5c0f\u7684\u4e00\u4e2a $b$\uff0c\u4f7f\u5f97\u5b83\u5c5e\u4e8e $i$ \u8fd9\u4e2a\u540c\u4f59\u7c7b\u3002\u56e0\u6b64\u6211\u4eec\u5217\u51fa\u4e86\u4e00\u4e2a\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$\\large f_{(a_j+i)\\bmod a_1}=\\min(f_{(a_j+i)\\bmod a_1},f_i+a_j)$$\n\n\u5982\u679c\u770b\u4e0d\u61c2\u6ca1\u6709\u5173\u7cfb\uff0c\u6211\u4eec\u89e3\u91ca\u4e00\u4e0b\u5427\u3002\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u76f8\u5f53\u4e8e\u662f\u4ece $\\omega$ \u5230\u8fbe $\\omega+a_j$ \u7684\u4ee3\u4ef7\u662f $a_j$\uff0c\u6240\u4ee5\u4ece $0$ \u5230 $i$ \u7684\u6700\u77ed\u8def\u5373\u662f $b$ \u6a21 $a_1$ \u7b49\u4e8e $i$ \u65f6\u7684\u6700\u5c0f\u503c\u3002\u6211\u4eec\u53ef\u4ee5\u8fde\u6709\u5411\u8fb9 $i\\to (i+a_j)\\bmod a_1$\u3002\u56e0\u6b64\u5bf9\u4e8e\u6211\u4eec\u6240\u9700\u89e3\u51b3\u95ee\u9898\u7684\u90e8\u5206\n\n\u4e8e\u662f\u5c31\u53ef\u4ee5\u7528\u6700\u77ed\u8def\u89e3\u51b3\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(a_1\\log a_1)$\u3002\n\n\u7b49\u7b49\u2026\u2026\u4e3a\u4ec0\u4e48\u8981\u53d6 $a_1$ \u4f5c\u4e3a\u6a21\u6570\u5462\uff1f\u6211\u4eec\u6392\u8fc7\u5e8f\u4e86\uff0c\u53d6\u5f97\u6700\u5c0f\u7684\u503c\u53ef\u4ee5\u5f97\u5230\u6700\u5c11\u7684\u8fb9\uff0c\u8fd9\u6837\u80fd\u591f\u63d0\u9ad8\u6548\u7387\uff0c\u53e6\u5916\uff0c\u6211\u4eec\u4e0d\u59a8\u7528 SPFA \u5427\u2014\u2014\u867d\u7136\u6211\u4e0d\u80fd\u8bc1\u660e\uff0c\u4f46\u662f\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u8fde\u8fb9\uff0cSPFA \u4e0d\u4f1a\u88ab\u5361\u7684\u3002\u54e6\u5bf9\u4e86\uff0cDijkstra \u5982\u679c\u5199\u7684\u4e0d\u5927\u9762\u826f\uff0c\u8bf4\u4e0d\u5b9a\u4f1a\u88ab\u5361\u54e6\u3002\n\n## \u540e\u8bdd\n\n\u201c\u662f\u7684\uff0c\u8fd9\u662f\u4e00\u9053\u540c\u4f59\u6700\u77ed\u8def\u7684\u9898\u76ee\u3002\u540c\u4f59\u6700\u77ed\u8def\u5f88\u6709\u610f\u601d\uff0c\u5b83\u672c\u8d28\u662f\u4e00\u7c7b DP\uff0c\u800c\u6211\u4eec\u5982\u679c\u7528\u56fe\u8bba\u7684\u65b9\u5f0f\u8ba4\u8bc6\u8fd9\u79cd\u9898\u76ee\uff0c\u53ef\u80fd\u4f1a\u6709\u622a\u7136\u4e0d\u540c\u7684\u8ba4\u8bc6\u3002\u6211\u4eec\u4e0d\u80fd\u62d8\u6ce5\u4e8e\u8868\u8c61\u3002\u201d\n\n\u539f\u6765\u5728\u6211\u60f3\u7684\u65f6\u5019\uff0c\u5979\u4eec\u5df2\u7ecf\u7b80\u8981\u5206\u6790\u5b8c\u8fd9\u9053\u9898\u76ee\u4e86\u3002\n\n\u201c\u542c\u5f97\u61c2\u5417\uff0c\u5c24\u91cc\uff1f\u201d\n\n\u5979\u7528\u529b\u70b9\u4e86\u70b9\u5934\u3002\n\n",
        "postTime": 1626407873,
        "uid": 212283,
        "name": "Aw\u987f\u987f",
        "ccfLevel": 5,
        "title": "\u3010\u9898\u89e3\u3011P2371 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u58a8\u58a8\u7684\u7b49\u5f0f"
    },
    {
        "content": "\u5bf9\u4e8e\u672c\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528**\u540c\u4f59\u6700\u77ed\u8def**\u7684\u7b97\u6cd5\u6765\u6c42\u89e3\u3002\n\n\u9996\u5148\u53ef\u4ee5\u6765\u770b\u4e00\u4e0b\u8fd9\u4e00\u9898\uff0c[P3403 \u8df3\u697c\u673a](https://www.luogu.com.cn/problem/P3403)\u3002\n\n\u5bf9\u4e8e\u672c\u9898\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u7c7b\u4f3c\u7684\u72b6\u6001\u8bbe\u8ba1\u3002\n\n\u6211\u4eec\u8bbe\u8ba1\u72b6\u6001 $d[i]$\uff0c\u8868\u793a\u4ee4 $x \\bmod y=i$ \u7684\u6700\u5c0f $x$ \u503c\u662f\u591a\u5c11\u3002\uff08$y$ \u7684\u9009\u53d6\u6211\u4eec\u4f1a\u5728\u4e0b\u9762\u518d\u8bb2\u89e3\uff09\n\n\u6839\u636e\u540c\u4f59\u7684\u6027\u8d28\uff0c\u6211\u4eec\u663e\u7136\u6709\u8f6c\u79fb $d[(i+j)\\bmod y]=d[i]+j$\uff0c\u6ee1\u8db3\u4f59\u6570\u53ef\u52a0\u6027\u3002\n\n\u8fd9\u79cd\u8f6c\u79fb\u6709\u5f88\u591a\u79cd\uff0c\u6211\u4eec\u663e\u7136\u8981\u53d6\u6700\u5c0f\u503c\u3002\n\n\u8fd9\u4ee4\u6211\u4eec\u60f3\u5230\u4e86\u7528\u6700\u77ed\u8def\u6765\u6c42\u89e3\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i$ $(0\\le i\\le y-1)$ \u6211\u4eec\u53ef\u4ee5\u7528 $a[p](1\\le p\\le n)$ \u53bb\u8f6c\u79fb\u3002\u5373\u5728 $i$ \u4e0e $(i+a[p])$ \u95f4\u8fde\u4e00\u6761\u957f\u5ea6\u4e3a $a[p]$ \u7684\u8fb9\uff0c\u76f4\u63a5\u4ee5 $0$ \u4e3a\u8d77\u70b9\u8dd1\u6700\u77ed\u8def\u5373\u53ef\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u6765\u8bb2 $y$ \u7684\u610f\u4e49\uff0c\u5bf9\u4e8e $y$ \u5b9e\u9645\u4e0a\u662f\u4ee5 $y$ \u6784\u5efa\u5269\u4f59\u7cfb\uff0c\u4e0d\u4f7f\u7528 $y$ \u7684\u60c5\u51b5\u4e0b\uff0c\u7528\u5176\u4ed6\u6570\u6784\u5efa\u51fa\u5176\u4f59\u6570\uff0c\u6700\u540e\u53ea\u4f7f\u7528 $y$ \u5bf9 $d[i]$ \u64cd\u4f5c\u3002\u6240\u4ee5 $y$ \u5176\u5b9e\u53ef\u4ee5\u662f $a$ \u6570\u7ec4\u4e2d\u7684\u4efb\u610f\u975e\u96f6\u6570\uff0c\u4e3a\u4e86\u4f7f\u6700\u77ed\u8def\u4e2d\u70b9\u6570\u6700\u5c11\uff0c\u6211\u4eec\u4e00\u822c\u4f1a\u9009\u53d6 $a$ \u4e2d\u7684\u6700\u5c0f\u975e\u96f6\u6574\u6570\u3002\n\n\u63a5\u4e0b\u6765\u7684\u95ee\u9898\u5c31\u5f88\u597d\u89e3\u51b3\u4e86\uff0c\u6211\u4eec\u5229\u7528\u524d\u7f00\u548c\u601d\u60f3\uff0c\u6c42\u51fa $r$ \u4e2d\u7684\u7b54\u6848\u4e0e $l-1$ \u7684\u7b54\u6848\u76f8\u51cf\u5373\u53ef\u3002\n\n\u6bcf\u4e2a\u4f59\u6570\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5373\u4e3a $(o-d[i])/y+1$\uff0c\u663e\u7136\u8fd9\u79cd\u7edf\u8ba1\u4e0d\u4f1a\u5e26\u6765\u91cd\u590d\u3002\n\n$\\mathtt{AC}$ \u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define MP make_pair\n#define F first\n#define S second\n#define PA pair<ll,int>\nusing namespace std;\nint n;\nll l,r;\nint a[20];\nconst int M=6000005;\nint Next[M],ver[M],head[M];\nll edge[M];\nll d[M];\nint vis[M];\nint mod=1e9;\nint tot;\nvoid add(int x,int y,int z)\n{\n\tNext[++tot]=head[x],head[x]=tot;\n\tver[tot]=y,edge[tot]=z;\n}\npriority_queue<PA,vector<PA>,greater<PA> > q;\nvoid dijkstra()\n{\n\tmemset(d,0x3f,sizeof d);\n\td[0]=0;\n\tq.push(MP(d[0],0));\n\twhile(q.size())\n\t{\n\t\tint x=q.top().S;\n\t\tq.pop();\n\t\tif(vis[x])continue;\n\t\tvis[x]=1;\n\t\tfor(int i=head[x];i;i=Next[i])\n\t\t{\n\t\t\tint y=ver[i],z=edge[i];\n\t\t\tif(d[y]>d[x]+z)\n\t\t\t{\n\t\t\t\td[y]=d[x]+z;\n\t\t\t\tq.push(MP(d[y],y));\n\t\t\t}\n\t\t}\n\t}\n}\nll ans;\nint m;\nint main()\n{\n\tscanf(\"%d%lld%lld\",&n,&l,&r);\n\tl--;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint x;\n\t\tscanf(\"%d\",&x);\n\t\tif(x)a[++m]=x;\n\t}\n\tn=m;\n\tif(n==0){\n\t\tputs(\"0\");\n\t\treturn 0;\n\t}\n\tsort(a+1,a+n+1);\n\tmod=a[1];\n\tfor(int i=1;i<=n;i++)\n\t  for(int j=0;j<mod;j++)\n\t    if(a[i]!=mod)add(j,(j+a[i])%mod,a[i]);\n\tdijkstra();\n\tfor(int i=0;i<mod;i++)\n\t{\n\t\tif(r>=d[i])ans+=(r-d[i])/mod+1;\n\t\tif(l>=d[i])ans-=(l-d[i])/mod+1;\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1629687407,
        "uid": 240405,
        "name": "wkjwkj",
        "ccfLevel": 0,
        "title": "[\u56fd\u5bb6\u96c6\u8bad\u961f]\u58a8\u58a8\u7684\u7b49\u5f0f"
    },
    {
        "content": "#### \u89e3\u6790\n\nP3403 \u8df3\u697c\u673a \u5347\u7ea7\u7248\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u4eff\u7167\u90a3\u9898\u7684\u7ecf\u5178\u505a\u6cd5\uff0c\u4f7f\u7528[**\u540c\u4f59\u6700\u77ed\u8def**](https://www.luogu.com.cn/blog/Izayoimiku9/tong-yu-zui-duan-lu)\u89e3\u51b3\u95ee\u9898\u3002\n\n\u5bf9\u4e8e\u6240\u6709\u7684 $a_i$\uff0c\u6211\u4eec\u5148\u5c06\u503c\u4e3a $0$ \u7684\u5143\u7d20\u53bb\u6389\uff0c\u7136\u540e\u627e\u5230\u6700\u5c0f\u503c\uff0c\u8bbe\u4e3a $base$\u3002\n\n\u4e4b\u540e\u6211\u4eec\u679a\u4e3e\u6240\u6709\u7684\u5269\u4f59\u7c7b $[\\ i\\ ]$ \u548c\u7ed9\u5b9a\u6570\u7ec4 $a_i$\uff0c\u6309\u7167\u5982\u4e0b\u65b9\u5f0f\u5efa\u56fe\u3002\n\n```cpp\nfor(int i=0;i<base;i++)\n{\n    for(int j=1;j<=n;j++)\n        add(i,(i+a[i])%base,a[i]);\n}\n```\n\n\u7136\u540e\u5728\u8fd9\u4e2a\u56fe\u4e0a\u8dd1\u6700\u77ed\u8def\u3002\n\n\u8fd9\u6837\u4e4b\u540e\uff0c\u6211\u4eec\u8dd1\u51fa\u6765\u7684\u6700\u77ed\u8def\u6570\u7ec4 $f[x]$ \u8868\u793a\u7684\u5c31\u662f\u6211\u4eec\u80fd\u591f\u62fc\u51fa\u6765\u7684\u6700\u5c0f\u7684\u5728\u5269\u4f59\u7cfb $[x]$ \u4e2d\u7684\u6570\u3002\n\n\u73b0\u5728\u6211\u4eec\u8003\u8651\u5982\u4f55\u8ba1\u7b97 $[l,r]$ \u4e2d\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u3002\n\n\u9996\u5148\u6211\u4eec\u80fd\u591f\u8f7b\u6613\u8ba1\u7b97\u51fa $[1,x]$ \u4e2d\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\uff1a$\\sum_{i=1}^{base-1}(\\frac{x-f[i]}{base}+1)$\u3002\n\n\u663e\u7136\u7684\u662f\u533a\u95f4\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u662f\u7c7b\u578b\u4e0e\u6709\u524d\u7f00\u548c\u6027\u8d28\u7684\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u8ba1\u7b97\uff1a$[1,r]$ \u4e2d\u6ee1\u8db3\u6761\u4ef6\u7684\u6570 $-$ $[1,l-1]$ \u4e2d\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<ll,int> PII;\n\nconst int N=5e6+10;\n\nint n;\nll l,r,base=1e9;\nvector<ll> a;\nint head[N],ver[N<<1],nxt[N<<1],tot=0;\nll edg[N<<1];\nvoid add(int x,int y,ll z)\n{\n\tver[++tot]=y; edg[tot]=z; nxt[tot]=head[x]; head[x]=tot;\n}\nbool vis[N];\nll f[N];\npriority_queue<PII, vector<PII>,greater<PII> > q;\n\nvoid dijkstra()\n{\n\tmemset(f,0x42,sizeof f);\n\tmemset(vis,0,sizeof vis);\n\tf[0]=0; q.push({0,0});\n\twhile(q.size())\n\t{\n\t\tint x=q.top().second;\n\t\tq.pop();\n\t\tif(vis[x]) continue;\n\t\tvis[x]=1;\n\t\tfor(int i=head[x];i;i=nxt[i])\n\t\t{\n\t\t\tint y=ver[i];\n\t\t\tif(f[y]>f[x]+edg[i])\n\t\t\t{\n\t\t\t\tf[y]=f[x]+edg[i];\n\t\t\t\tq.push({f[y],y});\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main()\n{\n\tscanf(\"%d%lld%lld\",&n,&l,&r);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint x;\n\t\tscanf(\"%d\",&x);\n\t\tif(x) a.push_back((ll)x),base=min(base,(ll)x);\n\t}\n\tfor(int i=0;i<base;i++)\n\t{\n\t\tfor(int j=0;j<a.size();j++)\n\t\t\tadd(i,(i+a[j])%base,a[j]);\n\t}\n\tdijkstra();\n\tll ansl=0,ansr=0;\n\tfor(int i=0;i<base;i++)\n\t{\n\t\tif(r>=f[i]) ansr+=(r-f[i])/base+1LL;\n\t\tif(l-1>=f[i]) ansl+=(l-1-f[i])/base+1LL;]);\n\t}\n\tprintf(\"%lld\",ansr-ansl);\n\treturn 0;\n}\n```\n",
        "postTime": 1620270351,
        "uid": 278259,
        "name": "RemiliaScarlet\u25ce",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P2371 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u58a8\u58a8\u7684\u7b49\u5f0f"
    }
]
[
    {
        "content": "[$$\\Large\\texttt{My Blog}$$](https://hydingsy.github.io/)\n\n---\n\n> \u9898\u76ee\u94fe\u63a5\uff1ahttps://www.luogu.org/problemnew/show/P1829\n\n\u6c42\u89e3\uff08\u5bf9 $20101009$ \u53d6\u6a21\uff09\n\n$$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\operatorname{lcm}(i,j)$$\n\n\u6570\u636e\u8303\u56f4\uff1a$n,m\\leqslant 10^7$\n\n---\n\n## Solution\n\n\u6613\u77e5\u539f\u5f0f\u7b49\u4ef7\u4e8e\n\n$$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\frac{i\\cdot j}{\\gcd(i,j)}$$\n\n\u679a\u4e3e\u6700\u5927\u516c\u56e0\u6570 $d$\uff0c\u663e\u7136\u4e24\u4e2a\u6570\u9664\u4ee5 $d$ \u5f97\u5230\u7684\u6570\u4e92\u8d28\n\n$$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\sum\\limits_{d|i,d|j,\\gcd(\\frac{i}{d},\\frac{j}{d})=1}\\frac{i\\cdot j}{d}$$\n\n\u975e\u5e38\u7ecf\u5178\u7684 $\\gcd$ \u5f0f\u5b50\u7684\u5316\u6cd5\n\n$$\\sum\\limits_{d=1}^n d\\cdot\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}[\\gcd(i,j)=1]\\cdot i\\cdot j$$\n\n\u540e\u534a\u6bb5\u5f0f\u5b50\u4e2d\uff0c\u51fa\u73b0\u4e86\u4e92\u8d28\u6570\u5bf9\u4e4b\u79ef\u7684\u548c\uff0c\u4e3a\u4e86\u8ba9\u5f0f\u5b50\u66f4\u7b80\u6d01\u5c31\u628a\u5b83\u62ff\u51fa\u6765\u5355\u72ec\u8ba1\u7b97\u3002\u4e8e\u662f\u6211\u4eec\u8bb0\n\n$$\\operatorname{sum}(n,m)=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m [\\gcd(i,j)=1]\\cdot i\\cdot j$$\n\n\u63a5\u4e0b\u6765\u5bf9 $\\operatorname{sum}(n,m)$ \u8fdb\u884c\u5316\u7b80\u3002\u9996\u5148\u679a\u4e3e\u7ea6\u6570\uff0c\u5e76\u5c06 $[\\gcd(i,j)=1]$ \u8868\u793a\u4e3a $\\varepsilon(\\gcd(i,j))$\n\n$$\\sum\\limits_{d=1}^n\\sum\\limits_{d|i}^n\\sum\\limits_{d|j}^m\\mu(d)\\cdot i\\cdot j$$\n\n\u8bbe $i=i'\\cdot d$\uff0c$j=j'\\cdot d$\uff08\u5176\u4e2d $i',j'$ \u6307\u4e0a\u5f0f\u4e2d\u7684 $i,j$ \uff09\uff0c\u663e\u7136\u5f0f\u5b50\u53ef\u4ee5\u53d8\u4e3a\n\n$$\\sum\\limits_{d=1}^n\\mu(d)\\cdot d^2\\cdot\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}i\\cdot j$$\n\n\u89c2\u5bdf\u4e0a\u5f0f\uff0c\u524d\u534a\u6bb5\u53ef\u4ee5\u9884\u5904\u7406\u524d\u7f00\u548c\uff1b\u540e\u534a\u6bb5\u53c8\u662f\u4e00\u4e2a\u8303\u56f4\u5185\u6570\u5bf9\u4e4b\u548c\uff0c\u8bb0\n\n$$g(n,m)=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m i\\cdot j=\\frac{n\\cdot(n+1)}{2}\\times\\frac{m\\cdot(m+1)}{2}$$\n\n\u53ef\u4ee5 $\\Theta(1)$ \u6c42\u89e3\n\n\u81f3\u6b64\n\n$$\\operatorname{sum}(n,m)=\\sum\\limits_{d=1}^n\\mu(d)\\cdot d^2\\cdot g(\\lfloor\\frac{n}{d}\\rfloor,\\lfloor\\frac{m}{d}\\rfloor)$$\n\n\u6211\u4eec\u53ef\u4ee5 $\\lfloor\\frac{n}{\\lfloor\\frac{n}{d}\\rfloor}\\rfloor$ \u6570\u8bba\u5206\u5757\u6c42\u89e3 $\\operatorname{sum}(n,m)$ \u51fd\u6570\u3002\n\n\u5728\u6c42\u51fa $\\operatorname{sum}(n,m)$ \u540e\uff0c\u56de\u5230\u5b9a\u4e49 $\\operatorname{sum}$ \u7684\u5730\u65b9\uff0c\u53ef\u5f97\u539f\u5f0f\u4e3a\n\n$$\\sum\\limits_{d=1}^n d\\cdot\\operatorname{sum}(\\lfloor\\frac{n}{d}\\rfloor,\\lfloor\\frac{m}{d}\\rfloor)$$\n\n\u53ef\u89c1\u8fd9\u53c8\u662f\u4e00\u4e2a\u53ef\u4ee5\u6570\u8bba\u5206\u5757\u6c42\u89e3\u7684\u5f0f\u5b50\uff01\n\n\u672c\u9898\u9664\u4e86\u63a8\u5f0f\u5b50\u6bd4\u8f83\u590d\u6742\u3001\u4ee3\u7801\u7ec6\u8282\u8f83\u591a\u4e4b\u5916\uff0c\u662f\u4e00\u9053\u5f88\u597d\u7684\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7ec3\u4e60\u9898\uff01\uff08\u4e0a\u8ff0\u8fc7\u7a0b\u4e2d\uff0c\u9ed8\u8ba4 $n\\leqslant m$\uff09\n\n**\u65f6\u95f4\u590d\u6742\u5ea6**\uff1a$\\Theta(n+m)$\uff08\u4e24\u6b21\u6570\u8bba\u5206\u5757\uff09\n\n---\n\n## Code\n\n```cpp\n#include <cstdio>\n#include <algorithm>\nusing std::min;\n\nconst int N=1e7;\nconst int mod=20101009;\nint n,m,mu[N+5],p[N/10+5],sum[N+5];\nbool flg[N+5];\n\nvoid init() {\n    mu[1]=1;\n    int tot=0,k=min(n,m);\n    for(int i=2;i<=k;++i) {\n        if(!flg[i]) p[++tot]=i,mu[i]=-1;\n        for(int j=1;j<=tot&&i*p[j]<=k;++j) {\n            flg[i*p[j]]=1;\n            if(i%p[j]==0) {mu[i*p[j]]=0;break;}\n            mu[i*p[j]]=-mu[i];\n        }\n    }\n    for(int i=1;i<=k;++i) sum[i]=(sum[i-1]+1LL*i*i%mod*(mu[i]+mod))%mod;\n}\nint Sum(int x,int y) {\n    return (1LL*x*(x+1)/2%mod)*(1LL*y*(y+1)/2%mod)%mod;\n}\nint func(int x,int y) {\n    int res=0;\n    for(int i=1,j;i<=min(x,y);i=j+1) {\n        j=min(x/(x/i),y/(y/i));\n        res=(res+1LL*(sum[j]-sum[i-1]+mod)*Sum(x/i,y/i)%mod)%mod;\n    }\n    return res;\n}\nint solve(int x,int y) {\n    int res=0;\n    for(int i=1,j;i<=min(x,y);i=j+1) {\n        j=min(x/(x/i),y/(y/i));\n        res=(res+1LL*(j-i+1)*(i+j)/2%mod*func(x/i,y/i)%mod)%mod;\n    }\n    return res;\n}\nint main() {\n    scanf(\"%d%d\",&n,&m);\n    init();\n    printf(\"%d\\n\",solve(n,m));\n}\n```",
        "postTime": 1542441844,
        "uid": 49725,
        "name": "Siyuan",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB\u3011"
    },
    {
        "content": "\u6211\u987a\u4fbf\u6765\u5b89\u5229\u4e00\u4e0b\u81ea\u5df1\u7684\u535a\u5ba2[peng-ym's blog](http://www.cnblogs.com/peng-ym/)\u91cc\u9762\u4e5f\u6709[\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14](http://www.cnblogs.com/peng-ym/p/8647856.html)\u4e0e[\u6574\u9664\u5206\u5757](http://www.cnblogs.com/peng-ym/p/8661118.html)\u7684\u4ecb\u7ecd\uff0c\u4e0d\u77e5\u9053\u7684\u53ef\u4ee5\u770b\u4e00\u770b\u54e6\uff01\n## \u89e3\u9898\u601d\u8def\n- \u5f88\u663e\u7136\uff0c\u9898\u76ee\u6240\u6c42\u7684\u5c31\u662f$Ans=\\sum_{i=1}^{n}\\sum_{j=1}^{m}lcm(i,j)$\n- \u6211\u4eec\u6839\u636e$lcm(i,j)=\\frac{ij}{gcd(i,j)}$\u8fd9\u4e2a\u6027\u8d28\u628a\u5b83\u8f6c\u6362\u6210$gcd$\n$$Ans=\\sum_{i=1}^{n}\\sum_{j=1}^{m}\\frac{ij}{gcd(i,j)}$$\n- \u6211\u4eec\u5957\u8def\u7684\u679a\u4e3e$gcd$\u4e3a$d$\u5e76\u4e14\u987a\u4fbf\u628a\u5b83\u63d0\u5230\u6700\u524d\u9762\n$$Ans=\\sum_{d=1}^{min(n,m)}\\sum_{i=1}^{n}\\sum_{j=1}^{m}[gcd(i,j)=d]\\frac{ij}{d}$$\n- \u5c06$d$\u7ed9\u63d0\u51fa\u6765\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u770b\u505a\u662f\u6362\u679a\u4e3e\u9879$i,j$\u4e3a$di,dj$\n$$Ans=\\sum_{d=1}^{min(n,m)}d\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}[gcd(i,j)=1]ij$$\n- \u5229\u7528$\\sum_{d|n}\\mu(d)=[n=1]$\u7684\u6027\u8d28\uff0c\u4ee3\u5165\n$$Ans=\\sum_{d=1}^{min(n,m)}d\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}\\sum_{x|gcd(i,j)}\\mu(x)ij$$\n- \u8fd9\u4e2a\u679a\u4e3e$gcd(i,j)$\u7ea6\u6570\u7684\u5f0f\u5b50\u5f88\u4e0d\u723d\uff0c\u6240\u4ee5\u6211\u4eec\u679a\u4e3e$x$\uff0c\u8fd9\u6837$x$\u4e0e$i,j$\u65e0\u5173\u5c31\u53ef\u4ee5\u63d0\u5230\u524d\u9762\n$$Ans=\\sum_{d=1}^{min(n,m)}d\\sum_{x=1}^{min(\\lfloor\\frac{n}{d}\\rfloor,\\lfloor\\frac{m}{d}\\rfloor)}\\mu(x)\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}ij[x|gcd(i,j)]$$\n- \u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u5f0f\u5b50\u7531\u679a\u4e3e$i,j$\u53d8\u4e3a\u679a\u4e3e$xu,xv$(\u4e0d\u7528$i,j$\u8fd9\u6837\u5b50\u770b\u8d77\u6765\u6ca1\u90a3\u4e48\u522b\u626d)\u3002\u56e0\u4e3a\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u4e0d\u7528\u5904\u7406$[x|gcd(i,j)]$\u8fd9\u4e2a\u6761\u4ef6\uff0c\u56e0\u4e3a\u5b83\u4e00\u5b9a\u6ee1\u8db3\u3002\n$$Ans=\\sum_{d=1}^{min(n,m)}d\\sum_{x=1}^{min(\\lfloor\\frac{n}{d}\\rfloor,\\lfloor\\frac{m}{d}\\rfloor)}\\mu(x)\\sum_{xu=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{xv=1}^{\\lfloor\\frac{m}{d}\\rfloor}x^2uv$$\n- \u6700\u540e\u6211\u4eec\u5c06$x^2$\u7ed9\u63d0\u51fa\u6765\uff0c\u5c31\u5dee\u4e0d\u591a\u5316\u5b8c\u4e86\n$$Ans=\\sum_{d=1}^{min(n,m)}d\\sum_{x=1}^{min(\\lfloor\\frac{n}{d}\\rfloor,\\lfloor\\frac{m}{d}\\rfloor)}x^2\\mu(x)(\\sum_{u=1}^{\\lfloor\\frac{n}{dx}\\rfloor}u)(\\sum_{v=1}^{\\lfloor\\frac{m}{dx}\\rfloor}v)$$\n- \u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5$O(n)$\u7ebf\u6027\u7b5b\u51fa$x^2\\mu(x)$\uff0c\u6700\u540e\u4e24\u4e2a\u5f0f\u5b50\u5c31\u662f\u7b49\u5dee\u6570\u5217\u6c42\u548c\uff0c\u53ef\u4ee5\u7528**[\u6574\u9664\u5206\u5757](http://www.cnblogs.com/peng-ym/p/8661118.html)**\u4f18\u5316\u3002\u8fd9\u9053\u9898\u5c31\u53ef\u4ee5$A$\u4e86\u3002\n\n## Code:\n\n```cpp\n#include<bits/stdc++.h>\n#define N 10010000\nusing namespace std;\ninline void read(int &x)\n{\n    x=0;\n    static int p;p=1;\n    static char c;c=getchar();\n    while(!isdigit(c)){if(c=='-')p=-1;c=getchar();}\n    while(isdigit(c)) {x=(x<<1)+(x<<3)+(c-48);c=getchar();}\n    x*=p;\n}\nconst long long mod=20101009;\nint n,m;\nbool vis[N];\nint cnt,prim[N],mu[N];\nlong long sum[N];\nvoid get_mu(int maxn)\n{\n    mu[1]=1;\n    for(int i=2;i<=maxn;i++)\n    {\n        if(!vis[i]){prim[++cnt]=i;mu[i]=-1;}\n        for(int j=1;j<=cnt&&prim[j]*i<=maxn;j++)\n        {\n            vis[i*prim[j]]=1;\n            if(i%prim[j]==0)break;\n            else mu[i*prim[j]]=-mu[i];\n        }\n    }\n    for(int i=1;i<=maxn;i++)(sum[i]=sum[i-1]+1ll*mu[i]*1ll*i%mod*1ll*i%mod)%=mod;\n}\nint main()\n{\n//\tfreopen(\".in\",\"r\",stdin);\n//\tfreopen(\".out\",\"w\",stdout);\n    read(n);read(m);\n    int max_rep=0;\n    get_mu(max_rep=min(n,m));\n    long long ans=0;\n    long long inv2=(mod+1ll)/2ll;\n    long long summ=0;\n    for(int d=1;d<=max_rep;d++)\n    {\n        int maxx=n/d,maxy=m/d,minn=min(maxx,maxy);\n        summ=0ll;\n        for(int l=1,r;l<=minn;l=r+1ll)\n        {\n            r=min(maxx/(maxx/l),maxy/(maxy/l));\n            (summ+=(sum[r]-sum[l-1])%mod*(((1ll+maxx/l)%mod*1ll*(maxx/l)%mod*inv2%mod)%mod)%mod*(((1ll+maxy/l)%mod*1ll*(maxy/l)%mod*inv2%mod)%mod)%mod)%=mod;\n        }\n        (ans+=summ*1ll*d)%=mod;\n    }\n    cout<<(ans%mod+mod)%mod<<endl;\n    return 0;\n}\n```",
        "postTime": 1522899264,
        "uid": 22016,
        "name": "pengym",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c\u3011"
    },
    {
        "content": "# \u9898\u76ee\u5206\u6790\n\n[\u4e2a\u4ebablog](http://blog.csdn.net/litble/article/details/79518721)\n\n\u9996\u5148\u662f\u4e00\u4e9b\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u57fa\u672c\u5957\u8def\uff1a\n\n\u8bbe$n<m$\uff0c\u9996\u5148\u770b\u8981\u6c42\u7684\u5f0f\u5b50\uff1a\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\frac{ij}{gcd(i,j)}$$\n\n**\u5957\u8def1**:\u4f18\u5148\u679a\u4e3egcd\n\n$$\\sum_{d=1}^nd\\sum_{i=1}^{n}\\sum_{j=1}^{m}[gcd(i,j)==d]$$\n\n**\u5957\u8def2**:$gcd(i,j)=d $\u7b49\u4ef7\u4e8e $gcd(i/d,j/d)=1$\n\n$$\\sum_{d=1}^nd\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor }\\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor }[gcd(i,j)==1]$$\n\n**\u5957\u8def3**:\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u7684\u6027\u8d28\n\n\u82e5n\u4e0d\u4e3a1\uff0c\u5219$\\sum_{d|n}=1$\uff0c\u5426\u5219\u539f\u5f0f\u4e3a0.\n$$\\sum_{d=1}^nd\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor }\\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor }\\sum_{t|gcd(i,j)}\\mu(t)$$\n\n**\u5957\u8def4**:\u4f18\u5148\u679a\u4e3e$t$(\u540c\u65f6\u8bbe$sum(n)=\\sum_{i=1}^ni=\\frac{n(n+1)}{2}$)\n\n$$\\sum_{d=1}^nd\\sum_{t=1}^{\\lfloor \\frac{n}{d} \\rfloor}t^2\\mu(t)sum(\\lfloor \\frac{n}{dt} \\rfloor)sum(\\lfloor \\frac{m}{dt} \\rfloor) $$\n\n**\u5957\u8def5**:\u8bbe$dt=T$\uff0c\u4f18\u5148\u679a\u4e3e$sum(\\lfloor \\frac{n}{T} \\rfloor)sum(\\lfloor \\frac{m}{T} \\rfloor) $(\u56e0\u4e3a\u8fd9\u4e00\u5757\u53ef\u4ee5\u6570\u8bba\u5206\u5757\u6839\u53f7\u65f6\u95f4\u5185\u6c42\uff0c\u5177\u4f53\u65b9\u6cd5\u8bed\u8a00\u8bb2\u4e0d\u6e05\uff0c\u770b\u4ee3\u7801\u5427\uff09\n\n$$\\sum_{T=1}^nsum(\\lfloor \\frac{n}{T} \\rfloor)sum(\\lfloor \\frac{m}{T} \\rfloor)T\\sum_{d|T}d\\mu(T)$$\n\n\u5957\u8def\u7ed3\u675f\u3002\n\n\u73b0\u5728\u6211\u4eec\u8981\u8003\u8651\u8fc5\u901f\u641e\u51fa$T\\sum_{d|T}d\\mu(T)$,\u90a3\u4e48\u6211\u4eec\u8bbe$f(T)=\\sum_{d|T}d\\mu(d)$\n\n\u8fd9\u662f\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\uff0c\u53ef\u4ee5\u7ebf\u6027\u7b5b\u3002\u8003\u8651\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u7ebf\u6027\u7b5b\uff0c\u6211\u4eec\u4e3a\u4e00\u4e2a\u6570$T$\u52a0\u5165\u4e00\u4e2a\u65b0\u7684\u8d28\u56e0\u5b50$p$\uff0c\u5982\u679c$T$\u6709\u8fd9\u4e2a\u8d28\u56e0\u5b50\u7684\u8bdd\uff0c\u90a3\u4e48\u5bf9\u4e8e$T$\u539f\u6765\u7684\u7ea6\u6570$d$\uff0c\u8fd9\u4e2a\u6570\u5982\u679c\u6709\u8d28\u56e0\u5b50$p$\uff0c\u52a0\u4e0a\u8fd9\u4e2a$p$\u4e4b\u540e\uff0c\u5e76\u4e0d\u4f1a\u4ea7\u751f\u65b0\u7684\u8d28\u56e0\u5b50\u3002\u5426\u5219\uff0c$\\mu(pd)=0$\uff0c\u6240\u4ee5\u6b64\u65f6$f(Tp)=f(T)$\u3002\u5982\u679c$T$\u6ca1\u6709\u8fd9\u4e2a\u56e0\u5b50\uff0c\u90a3\u4e48\u5176\u6bcf\u4e00\u4e2a\u7ea6\u6570\u4e58\u4e0a\u8fd9\u4e2a\u56e0\u5b50\u540e\uff0c\u7531\u4e8e$\\mu(pd)=-\\mu(d)$\uff0c\u6240\u4ee5$f(Tp)=f(T)-pf(T)=(1-p)f(T)=f(p)f(T)$\n\n# \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mod=20101009,N=10000005;\nint f[N],pri[N],is[N],s[N];\nint n,m,tot,ans,div2;\nint qm(int x) {return x>=mod?x-mod:x;}\nvoid init() {\n    f[1]=1;\n    for(int i=2;i<=n;++i) {//\u7ebf\u6027\u7b5b\n        if(!is[i]) pri[++tot]=i,f[i]=qm(mod+1-i);\n        for(int j=1;j<=tot&&i*pri[j]<=n;++j) {\n            int k=i*pri[j]; is[k]=1;\n            if(i%pri[j]) f[k]=1LL*f[i]*f[pri[j]]%mod;\n            else {f[k]=f[i];break;}\n        }\n    }\n    for(int i=1;i<=n;++i) f[i]=qm(f[i-1]+1LL*f[i]*i%mod);\n    for(int i=1;i<=m;++i) s[i]=qm(s[i-1]+i);\n}\nint main()\n{\n   \tscanf(\"%d%d\",&n,&m);\n   \tif(n>m) swap(n,m);\n   \tinit();\n   \tfor(int i=1,j;i<=n;i=j+1) {//\u6570\u8bba\u5206\u5757\u6839\u53f7\u6c42\u89e3\n   \t\tj=min(n/(n/i),m/(m/i));\n   \t\tans=qm(ans+1LL*qm(f[j]-f[i-1]+mod)*s[n/i]%mod*s[m/i]%mod);\n   \t}\n   \tprintf(\"%d\\n\",ans);\n    return 0;\n}\n```\n",
        "postTime": 1520764733,
        "uid": 20604,
        "name": "litble",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c\u3011"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.org/problem/P1829)\n\n\u6211\u7684\u7b2c\u4e00\u7bc7\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u9898\u89e3  ~~\u5174\u594b\u5174\u594b\u5174\u594b~~\n\n\u8d21\u732e\u4e00\u4e2a\u672c\u4eba\u81ea\u5df1\u60f3\u7684\u601d\u8def\uff0c\u4f60\u4ece\u672a\u770b\u5230\u8fc7\u7684\u8239\u65b0\u601d\u8def\n\n---\n\n**\u3010\u5206\u6790\u3011**\n---\n\n\u663e\u7136\uff0c\u9898\u76ee\u8981\u6c42\u6c42\u7684\u662f $\\displaystyle Ans=\\sum_{i=1}^n\\sum_{j=1}^m lcm(i,j)$\n\n\u6839\u636e\u6570\u8bba\u77e5\u8bc6\uff0c\u5f88\u663e\u7136 $lcm(i,j)={ij\\over gcd(i,j)}$\n\n$\\therefore \\displaystyle Ans=\\sum_{i=1}^n\\sum_{j=1}^m lcm(i,j)$\n\n$\\displaystyle \\qquad\\quad=\\sum_{i=1}^n\\sum_{j=1}^m{ij\\over gcd(i,j)}$\n\n$\\displaystyle \\qquad\\quad =\\sum_{k=1}^{min(n,m)}\\sum_{i=1}^n\\sum_{j=1}^m{ij\\over k}[gcd(i,j)= k]$\n\n\u8003\u8651 $i,j$ \u7684\u8d21\u732e\uff1a\n\n$\\displaystyle \\quad Ans=\\sum_{k=1}^{min(n,m)}\\sum_{i=1}^{\\lfloor{n\\over k}\\rfloor}\\sum_{j=1}^{\\lfloor{m\\over k}\\rfloor}{ik\\times jk\\over k}[gcd(i,j)= 1]$\n\n\u7531 $\\displaystyle \\sum_{d\\mid n}\\boldsymbol \\mu(d)=\\sum_{d\\mid n}\\boldsymbol \\mu(d)\\boldsymbol I({n\\over d})=(\\boldsymbol \\mu*\\boldsymbol I)(n)=\\boldsymbol \\epsilon(n)=[n=1]$ \u5f97\n\n$\\displaystyle \\quad Ans=\\sum_{k=1}^{min(n,m)}\\sum_{i=1}^{\\lfloor{n\\over k}\\rfloor}\\sum_{j=1}^{\\lfloor{m\\over k}\\rfloor}ijk\\sum_{d\\mid gcd(i,j)}\\boldsymbol\\mu(d)$\n\n$\\displaystyle \\qquad\\quad =\\sum_{k=1}^{min(n,m)}\\sum_{i=1}^{\\lfloor{n\\over k}\\rfloor}\\sum_{j=1}^{\\lfloor{m\\over k}\\rfloor}ijk\\sum_{d\\mid i\\bigwedge d\\mid j}\\boldsymbol\\mu(d)$\n\n\u8c03\u6362\u987a\u5e8f\uff0c\u679a\u4e3e $d$\n\n$\\displaystyle \\quad Ans=\\sum_{k=1}^{min(n,m)}\\sum_{d=1}^{min(\\lfloor{n\\over k}\\rfloor,\\lfloor{m\\over k}\\rfloor)}\\boldsymbol \\mu(d)\\sum_{i=1}^{\\lfloor{n\\over k}\\rfloor}\\sum_{j=1}^{\\lfloor{m\\over k}\\rfloor}ijk[d\\mid i\\bigwedge d\\mid j]$\n\n$\\displaystyle \\qquad\\quad =\\sum_{k=1}^{min(n,m)}\\sum_{d=1}^{min(\\lfloor{n\\over k}\\rfloor,\\lfloor{m\\over k}\\rfloor)}\\boldsymbol \\mu(d)\\sum_{i=1}^{\\lfloor{n\\over k}\\rfloor}\\sum_{j=1}^{\\lfloor{m\\over k}\\rfloor}ijk[d\\mid i][d\\mid j]$\n\n\u5404\u56de\u5404\u5bb6 ~~\uff0c\u5404\u627e\u5404\u5988~~\n\n$\\displaystyle \\quad Ans=\\sum_{k=1}^{min(n,m)}k\\sum_{d=1}^{min(\\lfloor{n\\over k}\\rfloor,\\lfloor{m\\over k}\\rfloor)}\\boldsymbol \\mu(d)\\sum_{i=1}^{\\lfloor{n\\over k}\\rfloor}i[d\\mid i]\\sum_{j=1}^{\\lfloor{m\\over k}\\rfloor}j[d\\mid j]$\n\n\u8003\u8651 $i,j$ \u7684\u8d21\u732e\uff1a\n\n$\\displaystyle \\quad Ans=\\sum_{k=1}^{min(n,m)}k\\sum_{d=1}^{min(\\lfloor{n\\over k}\\rfloor,\\lfloor{m\\over k}\\rfloor)}\\boldsymbol \\mu(d)\\sum_{i=1}^{\\lfloor{n\\over kd}\\rfloor}i\\times d[1\\mid i]\\sum_{j=1}^{\\lfloor{m\\over kd}\\rfloor}j\\times d[1\\mid j]$\n\n$\\displaystyle \\qquad\\quad=\\sum_{k=1}^{min(n,m)}k\\sum_{d=1}^{min(\\lfloor{n\\over k}\\rfloor,\\lfloor{m\\over k}\\rfloor)}d^2\\boldsymbol \\mu(d)\\sum_{i=1}^{\\lfloor{n\\over kd}\\rfloor}i\\sum_{j=1}^{\\lfloor{m\\over kd}\\rfloor}j$\n\n\u5927\u90e8\u5206 dalao \u5c31\u5230\u6b64\u4e3a\u6b62\uff0c\u63a5\u4e0b\u6765\u5206\u6bb5\u7528\u6574\u9664\u5206\u5757\u6c42\u89e3\n\n\u672c\u4eba\u5219\u6839\u636e\u5957\u8def\u53c8\u5316\u7b80\u4e86\u4e00\u4e0b\uff1a\n\n\u8bbe $\\displaystyle T=kd,Sum(n)=\\sum_{i=1}^ni={i(i+1)\\over 2}$\n\n$\\displaystyle \\quad Ans=\\sum_{k=1}^{min(n,m)}k\\sum_{T=1}^{min(n,m)}[k\\mid T]({T\\over k})^2\\boldsymbol \\mu({T\\over k})Sum(\\lfloor{n\\over T}\\rfloor)Sum(\\lfloor{m\\over T}\\rfloor)$\n\n\u8c03\u6362\u987a\u5e8f\uff0c\u5148\u679a\u4e3e $T$\n\n$\\displaystyle \\quad Ans=\\sum_{T=1}^{min(n,m)}T^2Sum(\\lfloor{n\\over T}\\rfloor)Sum(\\lfloor{m\\over T}\\rfloor)\\sum_{k\\mid T}{1\\over k}\\boldsymbol \\mu({T\\over k})$\n\n~~\u54e6\u543c\uff0c\u51c9\u51c9\u3002\u8fd9\u662f\u4ec0\u4e48\u9b3c\u4e1c\u897f~~\n\n---\n\n\u4e00\u770b\u9898\u76ee\uff0c\u7b54\u6848\u9700\u8981\u5bf9\u4e00\u4e2a\u5927\u4e8e $min(n,m)$ \u7684\u8d28\u6570\u53d6\u6a21\n\n\u6240\u4ee5\uff0c${1\\over k}$ \u663e\u7136\u53ef\u4ee5\u8868\u73b0\u4e3a\u9006\u5143\u5f62\u5f0f\n\n\u8bbe $\\boldsymbol {Inv}(n)=n^{-1}$\n\n$\\displaystyle \\quad Ans=\\sum_{T=1}^{min(n,m)}T^2Sum(\\lfloor{n\\over T}\\rfloor)Sum(\\lfloor{m\\over T}\\rfloor)\\sum_{k\\mid T}\\boldsymbol{Inv}(k)\\boldsymbol \\mu({T\\over k})$\n\n\u5927\u5bb6\u6ce8\u610f $\\displaystyle\\sum_{k\\mid T}\\boldsymbol{Inv}(k)\\boldsymbol \\mu({T\\over k})$\n\n\u8fd9\u73a9\u610f\u513f\u662f\u4e0d\u662f\u5f88\u50cf\u8fea\u5229\u514b\u96f7\u5377\u79ef\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u786e\u5b9a $\\boldsymbol\\mu(n)$ \u662f\u4e2a\u79ef\u6027\u51fd\u6570\uff0c\u5982\u679c $\\boldsymbol{Inv}(n)$ \u4e5f\u662f\u79ef\u6027\u51fd\u6570\uff0c\u90a3\u5b83\u5c31\u5fc5\u7136\u662f\u5377\u79ef\u6210\u4e00\u4e2a\u65b0\u7684\u79ef\u6027\u51fd\u6570\u4e86\n\n\u800c\u5bf9 $\\forall gcd(a,b)=1\\Leftrightarrow \\boldsymbol{Inv}(ab)=(ab)^{-1}\\equiv a^{-1}\\times b^{-1}=\\boldsymbol{Inv}(a)\\times \\boldsymbol{Inv}(b)(\\mod 20101009)$\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u5728\u53d6\u6a21\u610f\u4e49\u4e0b $\\boldsymbol {Inv}(n)$ \u4e5f\u662f\u79ef\u6027\u51fd\u6570\n\n\u6240\u4ee5\u4e0d\u59a8\u8bbe $\\boldsymbol f=\\boldsymbol \\mu*\\boldsymbol {Inv}$\n\n$\\displaystyle \\quad Ans=\\sum_{T=1}^{min(n,m)}T^2\\boldsymbol f(T)Sum(\\lfloor{n\\over T}\\rfloor)Sum(\\lfloor{m\\over T}\\rfloor)$\n\n\u518d\u8bbe $\\boldsymbol g(n)=n^2\\boldsymbol f(n)$\n\n> $\\boldsymbol g(n)=\\boldsymbol{id}^2(n)\\boldsymbol f(n)$\n\n\u6240\u4ee5 $\\boldsymbol g(n)$ \u4e5f\u662f\u79ef\u6027\u51fd\u6570\uff0c\u540c\u65f6\uff0c\u5f0f\u5b50\u5316\u7b80\u5b8c\u6bd5\uff1a\n\n$\\displaystyle \\quad Ans=\\sum_{T=1}^{min(n,m)}\\boldsymbol g(T)Sum(\\lfloor{n\\over T}\\rfloor)Sum(\\lfloor{m\\over T}\\rfloor)$\n\n\u53ea\u8981\u6211\u4eec\u7ebf\u6027\u6c42\u51fa $\\boldsymbol g(T)$ \u7684\u524d\u7f00\u548c\uff0c\u5c31\u53ef\u4ee5\u7528\u6574\u9664\u5206\u5757\u51fa\u6765\u4e86\n\n---\n\n\u6839\u636e $\\boldsymbol g(n)$ \u662f\u79ef\u6027\u51fd\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u5b83\u4e00\u5b9a\u662f\u53ef\u4ee5\u7ebf\u6027\u7b5b\u51fa\u6765\u7684\n\n\u6211\u4eec\u5148\u8003\u8651 $\\boldsymbol f(n)$\n\n$\\displaystyle \\boldsymbol f(1)=\\sum_{d\\mid 1}\\boldsymbol \\mu({1\\over d})\\times d^{-1}=\\boldsymbol \\mu(1)\\times 1^{-1}=1\\times 1=1$\n\n$\\displaystyle \\therefore \\boldsymbol g(1)=1^2\\boldsymbol f(1)=1\\times 1=1$\n\n\u5bf9 $\\forall p\\in prime$\n\n$\\displaystyle \\boldsymbol f(p)=\\sum_{d\\mid p}\\boldsymbol {Inv}(d)\\boldsymbol\\mu({p\\over d})$\n\n$\\displaystyle \\qquad\\ =\\boldsymbol \\mu(p)\\times 1^{-1}+\\boldsymbol \\mu(1)\\times p^{-1}$\n\n$\\displaystyle \\qquad\\ =(-1)+p^{-1}$\n\n$\\displaystyle \\qquad\\ =p^{-1}-1$\n\n$\\displaystyle \\qquad\\ =(p^1)^{-1}-(p^0)^{-1}$\n\n\u5bf9 $\\forall k>1$\n\n$\\displaystyle \\boldsymbol f(p^k)=\\sum_{d\\mid p^k}\\boldsymbol {Inv}(d)\\boldsymbol\\mu({p^k\\over d})$\n\n$\\displaystyle\\qquad\\ =\\sum_{t=0}^k\\boldsymbol{Inv}(p^{k-t})\\boldsymbol \\mu(p^t)$\n\n$\\displaystyle\\qquad\\ =\\sum_{t=0}^1\\boldsymbol{Inv}(p^{k-t})\\boldsymbol \\mu(p^t)+\\sum_{t=2}^k\\boldsymbol{Inv}(p^{k-t})\\boldsymbol \\mu(p^t)$\n\n$\\displaystyle \\qquad\\ =\\boldsymbol{Inv}(p^k)\\boldsymbol \\mu(1)+\\boldsymbol{Inv}(p^{k-1})\\boldsymbol \\mu(p)+\\sum_{t=2}^k\\boldsymbol{Inv}(p^{k-t})\\times 0$\n\n$\\displaystyle \\qquad\\ =(p^k)^{-1}-(p^{k-1})^{-1}$\n\n$\\therefore \\boldsymbol f(p^k)=(p^k)^{-1}-(p^{k-1})^{-1}=(p^k)^{-1}(1-p),k\\in N_+$\n\n$\\therefore \\boldsymbol g(p^k)=(p^k)^2\\boldsymbol f(p^k)$\n\n$\\displaystyle \\qquad\\quad\\ \\ =p^k\\times p^k\\times (p^k)^{-1}\\times (1-p)$\n\n$\\displaystyle \\qquad\\quad\\ \\ =p^k\\times (1-p)$\n\n$\\displaystyle \\qquad\\quad\\ \\ =p^k-p^{k+1}$\n\n$\\displaystyle \\boldsymbol g(p^k)=p\\times \\boldsymbol g(p^{k-1})$\n\n---\n\n$\\therefore$ \u5bf9 $\\forall p\\in prime$\n\n$\\boldsymbol g(p\\times n)=\\begin{cases}p\\times \\boldsymbol g(n),p\\mid n\\\\\\ \\\\\\ \\\\(1-p)p\\times \\boldsymbol g(n),p\\nmid n\\end{cases}$\n\n\u5373 $\\boldsymbol g(p\\times n)=p\\times\\boldsymbol g(n)\\times\\begin{cases}1,p\\mid n\\\\\\ \\\\\\ \\\\(1-p),p\\nmid n\\end{cases}$\n\n---\n\n\u8fd9\u91cc\u5bf9\u6574\u9664\u5206\u5757\u505a\u4e00\u4e2a\u8bb2\u89e3\uff0c\u5df2\u7ecf\u638c\u63e1\u7684 dalao \u8bf7\u8df3\u8fc7\uff1a\n\n\u5bf9\u4e8e\u521a\u521a\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u6211\u4eec\u5e0c\u671b\u5728\u5df2\u77e5 $\\boldsymbol g(n)$ \u7684\u60c5\u51b5\u4e0b $O(\\sqrt n)$ \u5f97\u51fa\u7b54\u6848\n\n$\\displaystyle \\quad Ans=\\sum_{T=1}^{min(n,m)}\\boldsymbol g(T)Sum(\\lfloor{n\\over T}\\rfloor)Sum(\\lfloor{m\\over T}\\rfloor)$\n\n\u8fd9\u8fb9\u6709\u4e00\u4e2a\u539f\u7406\uff1a \u5bf9 $\\forall d\\in Z_+,\\lfloor{n\\over d}\\rfloor$ \u7684\u53d6\u503c\u53ea\u6709\u4e0d\u8d85\u8fc7 $2\\sqrt n$ \u4e2a\n\n>\u8bc1\u660e\uff1a\u5bf9 $\\forall d\\leq \\sqrt n,{n\\over d}$ \u53ea\u6709\u4e0d\u8d85\u8fc7 $\\sqrt n$ \u4e2a\u53d6\u503c\uff1b\u5bf9 $\\forall d> \\sqrt n,\\lfloor{n\\over d}\\rfloor<\\lfloor\\sqrt n\\rfloor$ \uff0c\u4e5f\u53ea\u6709\u4e0d\u8d85\u8fc7 $\\sqrt n$ \u4e2a\u53d6\u503c\u3002\u52a0\u8d77\u6765\uff0c\u4e0d\u8d85\u8fc7 $2\\sqrt n$ \u4e2a\n\n\u6574\u9664\u5206\u5757\u7684\u539f\u7406\u5373\u4ece\u6b64\u800c\u6765\uff1a\n\n\u6211\u4eec\u5148\u8003\u8651\u5355\u7ef4\u60c5\u51b5\uff0c\u53ea\u542b $n$ \u6216\u53ea\u542b $m$\uff1a\n\n\u8bbe\u5bf9 $i\\in[l,r]$ \u6ee1\u8db3\uff1a\n\n$\\lfloor{n\\over l-1}\\rfloor\\neq\\lfloor{n\\over l}\\rfloor=\\lfloor{n\\over i}\\rfloor=\\lfloor{n\\over r}\\rfloor\\neq \\lfloor{n\\over r+1}\\rfloor$\n\n\u5219\u6709 $r=max(i)\\Leftrightarrow {n\\over r}=min({n\\over i})=\\lfloor{n\\over i}\\rfloor$\n\n$\\therefore r={n\\over \\lfloor{n\\over i}\\rfloor}$\n\n\u82e5\u5df2\u77e5 $l$ \uff0c\u5219 $r={n\\over \\lfloor{n\\over l}\\rfloor}$\n\n\u90a3 $l$ \u600e\u4e48\u77e5\u9053\u5462\uff1f\n\n\u5df2\u77e5\u7b2c\u4e00\u4e2a\u4e3a $l=1$ \uff0c\u4e14\u6bcf\u4e2a $l$ \u5bf9\u5e94\u4e14\u4ec5\u5bf9\u5e94\u4e00\u4e2a $r$\n\n\u6240\u4ee5\u5f53 $l=r+1$ \u65f6\uff0c $l$ \u4e00\u5b9a\u4e3a\u4e0b\u4e2a\u533a\u95f4\u7684\u6700\u5c0f\u503c\n\n\u65e2\u7136\u6ee1\u8db3\u5982\u6b64\u5173\u7cfb\uff0c\u5219\uff1a\n\n$\\displaystyle \\quad ans=\\sum_{T=l}^r\\boldsymbol g(T)Sum(\\lfloor{n\\over T}\\rfloor)Sum(\\lfloor{m\\over T}\\rfloor)$\n\n$\\displaystyle \\qquad\\quad =\\sum_{T=l}^r\\boldsymbol g(T)Sum(\\lfloor{n\\over r}\\rfloor)Sum(\\lfloor{m\\over r}\\rfloor)$\n\n$\\displaystyle \\qquad\\quad =Sum(\\lfloor{n\\over r}\\rfloor)Sum(\\lfloor{m\\over r}\\rfloor)\\sum_{T=l}^r\\boldsymbol g(T)$\n\n\u8bbe $\\displaystyle G(n)=\\sum_{i=1}^n\\boldsymbol g(n)$\n\n$\\displaystyle ans=Sum(\\lfloor{n\\over r}\\rfloor)Sum(\\lfloor{m\\over r}\\rfloor)[G(r)-G(l-1)]$\n\n\u6700\u540e\u53ea\u9700\u8981 $Ans=\\sum ans$ \u8fdb\u884c $O(\\sqrt n)$ \u7edf\u8ba1\u5373\u53ef\n\n---\n\n\u5bf9\u4e8e\u4e8c\u7ef4\u60c5\u51b5\uff0c\u4f9d\u846b\u82a6\u753b\u74e2\uff1a\n\n\u8bbe $i\\in[l,r],s.t.$\n\n$\\lfloor{n\\over l-1}\\rfloor\\neq\\lfloor{n\\over l}\\rfloor=\\lfloor{n\\over i}\\rfloor=\\lfloor{n\\over r}\\rfloor\\neq \\lfloor{n\\over r+1}\\rfloor$\n\n$\\lfloor{m\\over l-1}\\rfloor\\neq\\lfloor{m\\over l}\\rfloor=\\lfloor{m\\over i}\\rfloor=\\lfloor{m\\over r}\\rfloor\\neq \\lfloor{m\\over r+1}\\rfloor$\n\n\u5219\u5728 $l$ \u786e\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u4e3a\u4e86\u4f7f\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u5f97\u5230\u6ee1\u8db3\uff0c\u4f1a\u5f97\u5230 $r_1={n\\over \\lfloor{n\\over l}\\rfloor}$\n\n\u4e3a\u4e86\u4f7f\u7b2c\u4e8c\u4e2a\u5f0f\u5b50\u5f97\u5230\u6ee1\u8db3\u4f1a\u5f97\u5230 $r_2={m\\over \\lfloor{m\\over l}\\rfloor}$\n\n\u6545\u4e3a\u4f7f\u5f97\u4e24\u5f0f\u540c\u65f6\u6210\u7acb\uff0c\u53d6 $r=min(r_1,r_2)$ \u5373\u53ef\n\n\u5269\u4f59\u7684\u6b65\u9aa4\u4e0e\u4e00\u7ef4\u4e00\u6837  ~~\u5f88\u7b80\u5355\u5427~~\n\n---\n\n**\u3010\u4ee3\u7801\u3011**\n---\n\n\u90a3\u672c\u849f\u84bb\u5c31\u653e ~~\u6211\u7801\u98ce\u6781\u4e11\u7684~~ \u4ee3\u7801\u4e86\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#define f(a,b,c,d) for(register int a=b,c=d;a<=c;a++)\n#define g(a,b,c,d) for(register int a=b,c=d;a>=c;a--)\n//#define LOCAL\ntypedef int i32;\ntypedef unsigned int u32;\ntypedef long long int i64;\ntypedef unsigned long long int u64;\nconst i32 MOD=20101009;\nconst i32 MAXN=1e7+10;\ntypedef i32 ar[MAXN];\n\nnamespace HABIT{//\u8bfb\u5165\u8f93\u51fa\u4f18\u5316\u548c\u4e00\u5806\u9ed1\u79d1\u6280\uff0c\u4e0d\u5fc5\u7ba1\n    template<typename T> inline T Max(T a) { return a; }\n    template<typename T,typename... Args> inline T Max(T a,Args... args){\n        T b=Max(args...);\n        return (a>b)?a:b;\n    }\n    template<typename T> inline T Min(T a) { return a; }\n    template<typename T,typename... Args> inline T Min(T a,Args... args){\n        T b=Min(args...);\n        return (a<b)?a:b;\n    }\n\n    #ifdef LOCAL\n        inline char gc() { return getchar(); }\n    #else\n        inline char gc() {\n            static char s[1<<20|1]={0},*p1=s,*p2=s;\n            return (p1==p2)&&(p2=(p1=s)+fread(s,1,1<<20,stdin),p1==p2)?EOF:*(p1++);\n        }\n    #endif\n    inline i32 read(){\n        register i32 ans=0;register char c=gc();register bool neg=0;\n        while(c<48||c>57) neg^=!(c^'-'),c=gc();\n        while(c>=48&&c<=57) ans=(ans<<3)+(ans<<1)+(c^48),c=gc();\n        return neg?-ans:ans;\n    }\n\n    char Output_Ans[1<<20|1],*Output_Cur=Output_Ans;\n    inline bool output() { Output_Cur-=fwrite(Output_Ans,1,Output_Cur-Output_Ans,stdout); }\n    inline void print(char c) { (Output_Cur-Output_Ans+1>>20)&&output(),*(Output_Cur++)=c; }\n    inline void print(i32 x){\n        char buf[20]={0}; (Output_Cur-Output_Ans+sprintf(buf,\"%d\",x)>>20)&&output();\n        Output_Cur+=sprintf(Output_Cur,\"%d\",x);\n    }\n}\nusing namespace HABIT;\n\ni32 d_N,d_M;\n\nar ar_d_G,ar_d_Fc,ar_d_Prime;\ninline void pre(){\n    i32 *ptr_d_Prime=ar_d_Prime;\n    ar_d_G[1]=1;\n    f(i,2,I,d_N){\n        if(!ar_d_Fc[i])\n            ar_d_G[i]=(1ll-i)*(*(ptr_d_Prime++)=(ar_d_Fc[i]=i))%MOD+MOD;\n            //\u80af\u5b9a\u662f\u8d1f\u6570\uff0c\u53d6\u6a21\u5b8c\u76f4\u63a5\u52a0\u4e0a\n        for(register i32 *p=ar_d_Prime;p<ptr_d_Prime&&*p*i<=d_N;p++){\n            ar_d_Fc[*p*i]=*p;\n            ar_d_G[*p*i]=1ll*(*p)*ar_d_G[i]%MOD;\n            if(*p<ar_d_Fc[i]) ar_d_G[*p*i]=(1ll-*p)*ar_d_G[*p*i]%MOD+MOD;\n            //\u80af\u5b9a\u662f\u8d1f\u6570\uff0c\u53d6\u6a21\u5b8c\u76f4\u63a5\u52a0\u4e0a\n            else break;\n        }\n        ar_d_G[i]+=ar_d_G[i-1];\n        if(ar_d_G[i]>=MOD) ar_d_G[i]-=MOD;\n        //\u524d\u7f00\u548c\n    }\n}\n\nint main(){\n    d_N=read(),d_M=read();\n    if(d_N>d_M) d_N^=d_M^=d_N^=d_M;\n    pre();\n    i32 d_Ans=0;\n    for(register i32 l=1,r;l<=d_N;l=r+1){\n        r=Min( d_N/(d_N/l) , d_M/(d_M/l) );\n        i64 d_Tmp=ar_d_G[r]-ar_d_G[l-1];\n        i32 d_A=(1ll+d_N/r)*(d_N/r)/2%MOD;\n        i32 d_B=(1ll+d_M/r)*(d_M/r)/2%MOD;\n        d_Tmp=d_Tmp*d_A%MOD*d_B%MOD;\n        d_Ans+=d_Tmp;\n        if(d_Ans<0) d_Ans+=MOD;\n        else if(d_Ans>=MOD) d_Ans-=MOD;\n    }\n    print(d_Ans);\n    output();\n    return 0;\n}\n```\n\n---\n\n\u6700\u540e\u5b89\u5229\u4e00\u4e0b [\u672c\u849f\u84bb\u7684\u535a\u5ba2](https://www.luogu.org/blog/JustinRochester/)",
        "postTime": 1566198503,
        "uid": 36031,
        "name": "JustinRochester",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB\u3011"
    },
    {
        "content": "# \u9898\u89e3-[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB\n\n**[\u535a\u5ba2\u4e2d\u9605\u8bfb](https://www.cnblogs.com/Wendigo/p/12456965.html)**\n\n**\u524d\u7f6e\u77e5\u8bc6\uff1a**\n> \u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14 [</>](https://www.cnblogs.com/Wendigo/p/12441788.html)\n\n---\n\n> [\\[\u56fd\u5bb6\u96c6\u8bad\u961f\\]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB](https://www.luogu.com.cn/problem/P1829)\n\n> \u5355\u7ec4\u6d4b\u8bd5\u6570\u636e\uff0c\u7ed9\u5b9a $n,m$ \uff0c\u6c42 \n> $$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\operatorname{lcm}(i,j)\\bmod 20101009$$\n\n> \u6570\u636e\u8303\u56f4\uff1a$1\\le n,m\\le 10^7$\u3002\n\n---\n\n\u4f5c\u4e3a\u5199\u51fa\u4e86\u6700\u66b4\u529b\u7684\u505a\u6cd5\u7684\u849f\u84bb\uff0c\u6765\u63a8\u4e2a\u5f0f\u5b50\u3002\n\n$n\\le m$\uff0c\u4e00\u6c14\u5475\u6210\uff08\u6d1b\u8c37\u597d\u50cf\u4e0d\u600e\u4e48\u652f\u6301\u8fd9\u79cd\u6050\u6016 $\\LaTeX$\uff09\uff1a\n\n![bbbbb.png](https://i.loli.net/2020/03/10/JsBZhKzfaCT9yY1.png)\n\n\u5c06 $x=dk$ \u5e26\u5165\uff1a\n\n$$g(n,m)=\\sum\\limits_{x=1}^nx\\cdot\\frac{\\lfloor\\frac{n}{x}\\rfloor(\\lfloor\\frac{n}{x}\\rfloor+1)}{2}\\cdot\\frac{\\lfloor\\frac{m}{x}\\rfloor(\\lfloor\\frac{m}{x}\\rfloor+1)}{2}\\sum\\limits_{k|x}k\\mu(k)$$\n\n\u7136\u540e\u7b5b $\\mu(k)$ \u65f6\u987a\u4fbf\u8ba1\u7b97 $h(k)=k\\mu(k)$\uff0c\u6700\u540e\u72c4\u5229\u514b\u96f7\u524d\u7f00\u548c\u6c42 $f(k)=\\sum\\limits_{k|x}k\\mu(k)$\u3002\n\n\u522b\u5fd8\u4e86\u819c\u62dc $20101009$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(N+n)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n//&Start\n#define lng long long\n#define lit long double\n#define kk(i,n) \"\\n \"[i<n]\nconst int inf=0x3f3f3f3f;\nconst lng Inf=1e17;\n\n//&Mobius\nconst int N=1e7;\nconst int mod=20101009;\nbitset<N+10> np;\nint mu[N+10],cnt,p[N+10],f[N+10];\nvoid Mobius(){\n\tf[1]=mu[1]=1;\n\tfor(int i=2;i<=N;i++){\n\t\tif(!np[i]) p[++cnt]=i,mu[i]=-1;\n\t\tf[i]=(mu[i]*i+mod)%mod;\n\t\tfor(int j=1;j<=cnt&&i*p[j]<=N;j++){\n\t\t\tnp[i*p[j]]=1;\n\t\t\tif(i%p[j]==0){mu[i*p[j]]=0;break;}\n\t\t\tmu[i*p[j]]=-mu[i];\n\t\t}\n\t}\n\tfor(int j=1;j<=cnt;j++)\n\t\tfor(int i=1;i*p[j]<=N;i++)\n\t\t\t(f[i*p[j]]+=f[i])%=mod; //\u72c4\u5229\u514b\u96f7\u524d\u7f00\u548c\n}\n\n\n//&Data\nint n,m,ans;\nint bitfun(int x){\n\tlng res=1ll*x*f[x]%mod;\n\t(res*=1ll*(n/x+1)*(n/x)/2%mod)%=mod;\n\t(res*=1ll*(m/x+1)*(m/x)/2%mod)%=mod; //\u5982\u4e0a\n\t//\u8fd9\u4e2a1ll\u4e0d\u4e58\u8981\u7206long long\uff0c30\u5206\u3002\n\treturn (int)res;\n}\n\n//&Main\nint main(){\n\tMobius();\n\tscanf(\"%d%d\",&n,&m);\n\tif(n>m) swap(n,m);\n\tfor(int i=1;i<=n;i++)\n\t\t(ans+=bitfun(i))%=mod;\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n\n---\n\n**\u795d\u5927\u5bb6\u5b66\u4e60\u6109\u5feb\uff01**",
        "postTime": 1583832361,
        "uid": 118365,
        "name": "George1123",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB\u3011"
    },
    {
        "content": "# \u5206\u6790\n\u9996\u5148\uff0c\u8bbe$n\\leq m$\uff0c\u8981\u6c42\u7684\u5f0f\u5b50\u662f\uff1a\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{m}lcm(i, j)$$\n\u5373\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{m}\\frac{i*j}{gcd(i, j)}$$\n\u63d0\u4e2a$gcd$\u51fa\u6765\uff1a\n$$\\sum_{d=1}^{n}\\sum_{i=1}^{n}\\sum_{j=1}^{m}\\frac{i*j}{d}[gcd(i,j)=d]$$\n\u7ea6\u6389$d$\uff1a\n$$\\sum_{d=1}^{n}d\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}i*j[gcd(i,j)=1]$$\n\u7531\n$$\\sum_{n|d}\\mu(n)=[d==1]$$\n\u5f97\u539f\u5f0f\uff1a\n$$\\sum_{d=1}^{n}d\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}i*j\\sum_{a|gcd(i,j)}\\mu(a)$$\n\u5408\u5e76\uff1a\n$$\\sum_{d=1}^{n}d\\sum_{t=1}^{\\lfloor\\frac{n}{d}\\rfloor}t^2\\mu(t)*S(\\lfloor\\frac{n}{dt}\\rfloor)*S(\\lfloor\\frac{m}{dt}\\rfloor)$$\n\u5176\u4e2d\n$$S(n)=\\frac{n*(n+1)}{2}$$\n\u4f7f$dt=T$\uff0c\u628a\u4ed6\u62c9\u5230\u524d\u9762\uff1a\n$$\\sum_{T=1}^{n}S(\\lfloor\\frac{n}{T}\\rfloor)*S(\\lfloor\\frac{m}{T}\\rfloor)*\\sum_{ab=T}a*b^2\\mu(b)$$\n\u5373\n$$\\sum_{T=1}^{n}S(\\lfloor\\frac{n}{T}\\rfloor)*S(\\lfloor\\frac{m}{T}\\rfloor)*T*\\sum_{b|T}b*\\mu(b)$$\n\u8bbe$f(T)=\\sum_{b|T}b*\\mu(b)$\uff0c\u6613\u77e5$f(n)$\u4e3a\u79ef\u6027\u51fd\u6570\uff0c\u4e14\n$$f(p)=1-p, f(p^k)=f(p)\\quad(p\\in prime)$$\n# \u505a\u6cd5\n\u7ebf\u6027\u7b5b\u51fa$f(n)$\uff0c\u9884\u5904\u7406\u51fa$T*f(T)$\u7684\u524d\u7f00\u548c\uff0c\u539f\u5f0f\u7528\u6570\u8bba\u5206\u5757\u7b97\u5373\u53ef\u3002\n# \u4ee3\u7801\n```cpp\n#include <algorithm>\n#include <iostream>\n\nusing namespace std;\nconstexpr long long kcz = 20101009;\n\nint v[10000001], p[10000001], pc;\nlong long g[10000001];\n\nvoid preproc(int n)\n{\n\tg[1] = 1;\n\tfor(int i = 2; i <= n; i++)\n\t{\n\t\tif(!v[i]) p[++pc] = i, g[i] = (1 - i) % kcz;\n\t\tfor(int j = 1; j <= pc && i * p[j] <= n; j++)\n\t\t{\n\t\t\tv[i * p[j]] = true;\n\t\t\tif(!(i % p[j]) && (g[i * p[j]] = g[i])) break;\n\t\t\tg[i * p[j]] = (g[i] * g[p[j]]) % kcz;\n\t\t}\n\t}\n\tfor(int i = 2; i <= n; i++)\n\t\t(g[i] = g[i] * i % kcz + g[i - 1]) %= kcz;\n}\n\ninline long long s(long long k)\n{\n\treturn (k * (k + 1) / 2) % kcz;\n}\n\nint main()\n{\n\tpreproc(10000000);\n\tint n, m;\n\tlong long ret = 0;\n\tscanf(\"%d%d\", &n, &m);\n\tif(n > m) swap(n, m);\n\tfor(int l = 1, r; l <= n; l = r + 1)\n\t{\n\t\tr = min(n / (n / l), m / (m / l));\n\t\t(ret += (((s(n / l) * s(m / l)) % kcz) * (g[r] - g[l - 1] + kcz) % kcz) % kcz + kcz) %= kcz;\n\t}\n\tprintf(\"%lld\\n\", ret);\n}\n```",
        "postTime": 1535024642,
        "uid": 49189,
        "name": "Js2xxx",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB\u3011"
    },
    {
        "content": "\u521a\u521a\u5b66\u4e86\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u6765\u5199\u4e00\u7bc7\u9898\u89e3qwq\uff08\u5b89\u5229\u4e00\u6ce2[\u6211\u7684\u535a\u5ba2](https://www.icelocke.site/?p=1271)\uff0c\u91cc\u9762\u4e5f\u6709\u8fd9\u9898\u7684\u9898\u89e3\uff09\u3002\n\n\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86 $lcm(i, j) = \\frac{ij}{\\gcd(i, j)}$ \uff0c\u76f4\u63a5\u8fdb\u884c\u4e00\u6ce2\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u3002\u63a5\u4e0b\u6765\u5c31\u6765\u63a8\u4e00\u63a8\u5f0f\u5b50\uff1a\n\n![](https://www.icelocke.site/wp-content/uploads/2018/12/QQ20181210-231801.png)\n\n\uff08\u6d1b\u8c37\u8fd9\u8fb9\u5bf9\u8fde\u7b49\u5f0f\u7684\u663e\u793a\u597d\u50cf\u6709\u70b9\u95ee\u9898\uff0c\u53ea\u80fd\u7528\u56fe\u7247\u5566qwq\uff09\n\n\u6211\u4eec\u4ece $(1)$ ~ $(5)$ \u4f9d\u6b21\u4ecb\u7ecd\u4e00\u4e0b\u63a8\u5bfc\u8fc7\u7a0b\u548c\u5e38\u89c1\u7684\u5957\u8def\uff1a\n\n1. \u901a\u5e38\u6211\u4eec\u53ef\u4ee5\u5c06\u6c42 $\\sum \\gcd(i, j)$ \u7684\u95ee\u9898\u8f6c\u4e3a\u679a\u4e3e $\\gcd(i, j)$ \u7edf\u8ba1 $[\\gcd(i, j) == k]$ \u7684\u95ee\u9898\u3002\u4e8e\u662f\u6211\u4eec\u5c06 $(0)$ \u4e2d\u5bf9 $\\frac{ij}{\\gcd(i, j)}$ \u6c42\u548c\u8f6c\u4e3a\u679a\u4e3e $k$ \u7edf\u8ba1 $\\frac{ij}{k}[gcd(i, j) == k]$\uff0c\u56e0\u4e3a\u679a\u4e3e $k$ \u7684\u90e8\u5206\u5728\u6700\u5916\u5c42\uff0c\u663e\u7136 $\\frac{1}{k}$ \u53ef\u4ee5\u653e\u5728\u5916\u9762\uff0c \u8ba9\u5f0f\u5b50\u66f4\u7b80\uff0c\u8fd9\u6837\u5c31\u5f97\u5230\u4e86 $(1)$\u3002\n\n2. \u56e0\u4e3a $\\gcd(i, j) == k$\uff0c\u663e\u7136\u6709 $\\gcd(\\frac{i}{k}, \\frac{j}{k}) == 1$ \uff0c\u6211\u4eec\u5c1d\u8bd5\u679a\u4e3e $\\frac{i}{k}$ \u548c $\\frac{j}{k}$\uff0c\u663e\u7136\u4e0a\u754c\u4e3a $\\lfloor\\frac{n}{k}\\rfloor$ \u548c $\\lfloor \\frac{m}{k} \\rfloor$ \u3002\u8bbe $i' = \\frac{i}{k}, j' = \\frac{j}{k}$\uff0c\u7531\u4e8e\u679a\u4e3e $i', j'$\u7684\u8d21\u732e\u5c11\u4e86 $k^2$ \uff0c\u6211\u4eec\u5728\u524d\u9762\u4e58\u4e0a $k^2$\uff0c\u4e8e\u662f\u6709\n$$\\sum_{i=1}^{n}\\sum_{j=1}^m ij\\ [\\gcd(i, j) == k] \\Leftrightarrow \\sum_{i'=1}^{\\lfloor{\\frac{n}{k}}\\rfloor} \\sum_{j'=1}^{\\lfloor{\\frac{m}{k}}\\rfloor} i'j'k^2 \\ [\\gcd(i', j') == 1]$$\n    \u7136\u540e\u4e3a\u4e86\u5199\u8d77\u6765\u7b80\u5355\u4e00\u70b9\uff08~~\u5176\u5b9e\u5c31\u662f\u61d2~~\uff09\uff0c\u6211\u4eec\u5c31\u5e72\u8106\u628a $'$ \u7ed9\u4ed6\u53bb\u6389\u4e86\uff0c\u5f0f\u5b50\u4e5f\u5c31\u53d8\u6210\u4e86 $(2)$\u3002\n\n3. \u7136\u540e\u662f\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u7b80\u5355\u5957\u8def\n$$[\\gcd(i, j) == 1] \\Leftrightarrow \\sum_{d\\mid \\gcd(i, j)} \\mu(d)$$\n    \u76f4\u63a5\u5957\u8fdb\u53bb\u5c31\u884c\u4e86\uff0c\u6211\u4eec\u5c31\u5f97\u5230\u4e86 $(3)$\u3002\n\n4. \u770b\u4e0a\u53bb\u5bf9 $\\mu(d)$ \u7684\u679a\u4e3e\u4e2d\u5fc5\u987b\u8981\u6574\u9664 $\\gcd(i, j)$ \u662f\u4e0d\u662f\u975e\u5e38\u70e6\uff1f\u6211\u4eec\u7ee7\u7eed\u5c06 $\\sum \\limits _{d\\mid \\gcd(i, j)} \\mu(d)$ \u53d8\u6362\u4f4d\u7f6e\uff0c\u8003\u8651\u679a\u4e3e $d$ \u6765\u5b9e\u73b0\u6211\u4eec\u7684\u60f3\u6cd5\u3002\u56e0\u4e3a $d\\mid\\gcd(i, j)$\uff0c\u663e\u7136\u53ef\u4ee5\u5f97\u5230 $d$ \u7684\u4e0a\u754c\u4e3a $\\min(\\lfloor\\frac{n}{k}\\rfloor, \\lfloor\\frac{m}{k}\\rfloor)$ \uff0c\u540c\u6837\u6211\u4eec\u4e5f\u53ef\u4ee5\u77e5\u9053\u5728\u679a\u4e3e $i, j$ \u7684\u65f6\u5019\u8981\u6ee1\u8db3 $d \\mid i, \\ d \\mid j$\uff0c\u56e0\u6b64\n    $$\\sum_{i=1}^{\\lfloor{\\frac{n}{k}}\\rfloor} \\sum_{j=1}^{\\lfloor{\\frac{m}{k}}\\rfloor} ij \\sum_{d\\mid\\gcd(i, j)} \\mu(d) \\Leftrightarrow \\sum_{d=1}^{\\min(\\lfloor{\\frac{n}{k}}\\rfloor, \\lfloor\\frac{m}{k}\\rfloor)} \\mu(d)\\ \\sum_{d\\mid i}^{\\lfloor\\frac{n}{k}\\rfloor}\\sum_{d\\mid j}^{\\lfloor\\frac{m}{k}\\rfloor} ij$$\n    \u4e5f\u5c31\u5f97\u5230\u4e86 $(4)$\u3002\n\n5. \u597d\u50cf\u5feb\u7ed3\u675f\u4e86\uff01\u6211\u4eec\u60f3\u4e00\u4e0b\u5982\u4f55\u5c06\u540e\u9762\u7684\u548c\u5f0f $\\sum \\limits_{d\\mid i}^{\\lfloor\\frac{n}{k}\\rfloor}\\sum \\limits_{d\\mid j}^{\\lfloor\\frac{m}{k}\\rfloor} ij$ \u53d8\u5f97\u66f4\u7b80\u5355\u4e00\u70b9\u3002\u8ddf\u521a\u521a\u8bf4\u7684\u7b2c $2$ \u70b9\u7c7b\u4f3c\uff0c\u6211\u4eec\u91c7\u7528\u6362\u5143\u6cd5\uff0c\u76f4\u63a5\u679a\u4e3e $i, j$ \u6765\u7edf\u8ba1 $ij$ \u3002\u8bbe $i' = di, j' = dj$ \uff0c\u663e\u7136\u53ef\u4ee5\u5f97\u5230 $i', j'$ \u679a\u4e3e\u7684\u4e0a\u754c\u4e3a $\\lfloor\\frac{n}{kd}\\rfloor, \\lfloor\\frac{n}{kd}\\rfloor$ \uff0c\u56e0\u6b64\n    $$\\sum \\limits_{d\\mid i}^{\\lfloor\\frac{n}{k}\\rfloor}\\sum \\limits_{d\\mid j}^{\\lfloor\\frac{m}{k}\\rfloor} ij \\Leftrightarrow \\sum_{i'=1}^{\\lfloor\\frac{n}{kd}\\rfloor}\\sum_{j'=1}^{\\lfloor\\frac{m}{kd}\\rfloor} i'j'$$\n    \u63a5\u7740\u628a $'$ \u53bb\u6389\uff0c\u5c31\u5f88\u5f00\u5fc3\u7684\u63a8\u5b8c\u4e86\u3002\n\n\u6211\u4eec\u7ee7\u7eed\u5316\u7b80\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u4ee5\u4fbf\u7a0b\u5e8f\u5b9e\u73b0\u3002\u8bbe $f(n, m) = \\sum \\limits_{i=1}^n \\sum \\limits_{j=1}^m i j$ \u3002\u8003\u8651\u4e00\u4e0b\u8fd9\u4e2a\u5f0f\u5b50\u7684 $O(1)$ \u6c42\u6cd5\uff0c\u663e\u7136\u6709\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{m}ij = \\sum_{i=1}^{n}i\\sum_{j=1}^{m}j$$\n\u7136\u540e\u7528\u4e00\u4e0b\u7b49\u5dee\u6570\u5217\u6c42\u548c\u516c\u5f0f\u5c31\u6709\n$$f(n, m) = \\frac{n(n+1)}{2} \\times \\frac{m(m+1)}{2}$$\n\u7136\u540e\u5c31\u6709$$\\mathbf{Orig\\ Equ}= \\sum_{k=1}^{\\min(n, m)} k \\sum_{d=1}^{\\min(\\lfloor{\\frac{n}{k}}\\rfloor, \\lfloor\\frac{m}{k}\\rfloor)} \\mu(d)\\ d^2 \\ f(\\lfloor{\\frac{n}{kd}}\\rfloor, \\lfloor\\frac{m}{kd}\\rfloor)$$\n\u8fdb\u4e00\u6b65\u5316\u7b80\uff0c\u8bbe $g(n, m) = \\sum \\limits_{d=1}^{\\min(n, m)} \\mu(d)\\ d^2 \\ f(\\lfloor{\\frac{n}{d}}\\rfloor, \\lfloor\\frac{m}{d}\\rfloor)$ \uff0c\u5219\u6709\n$$\\mathbf{Orig\\ Equ} = \\sum_{k=1}^{\\min(n, m)} g(\\lfloor\\frac{n}{k}\\rfloor, \\lfloor\\frac{m}{k}\\rfloor)$$\n\n\u76f4\u5230\u8fd9\u6b65\uff0c\u6211\u4eec\u6c42\u89e3\u7b54\u6848\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u8fd8\u662f $O(n\\log n)$\uff0c\u660e\u663e\u4e0d\u7b26\u5408\u6570\u636e\u89c4\u6a21\u3002\u89c2\u5bdf\u53d1\u73b0 $f(n, m)$ \u548c $g(n, m)$ \u90fd\u53ef\u4ee5\u6570\u8bba\u5206\u5757\uff0c\u5957\u4e24\u904d\u6570\u8bba\u5206\u5757\u5c31\u53ef\u4ee5\u5c06\u65f6\u95f4\u590d\u6742\u5ea6\u4f18\u5316\u5230 $O(n)$\uff0c\u8fd9\u6837\u5c31\u505a\u5b8c\u5566qwq\n\n---\n**\u4ee3\u7801**\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <bitset>\n#define R register\n#define LL long long\n#define int LL\n\nusing namespace std;\n\nconst int MAXN = 2e7 + 10, \n          MOD = 20101009;\n\nint n, m, cnt, ans, s[MAXN], mu[MAXN], prime[MAXN];\nbitset<MAXN> bits;\n\n// \u7ebf\u6027\u7b5b\u7b5b\u51fa mu(d) * d^2 \u7684\u524d\u7f00\u548c\ninline void prework() {\n    int lim = max(n, m);\n    mu[1] = 1;\n    for(int i = 2; i <= lim; i++) {\n        if(bits[i] == 0)\n            mu[i] = -1, prime[++cnt] = i;\n        for(int j = 1; j <= cnt && prime[j] * i <= lim; j++) {\n            bits[i * prime[j]] = 1;\n            if(i % prime[j] == 0) {\n                mu[i * prime[j]] = 0;\n                break;\n            }\n            else mu[i * prime[j]] = -mu[i];\n        }\n    }\n    // \u7b5b\u51fa\u524d\u7f00\u548c\n    for(int i = 1; i <= lim; i++)\n        s[i] = (s[i - 1] + 1ll * (mu[i] + MOD) % MOD * i % MOD * i) % MOD;\n}\n\ninline int f(int a, int b) {\n    return ((1ll * a * (a + 1) / 2 % MOD) % MOD * (1ll * b * (b + 1) / 2 % MOD) % MOD) % MOD;\n}\n\n// \u7b2c\u4e00\u6b21\u6570\u8bba\u5206\u5757\ninline int g(int a, int b) {\n    int lim = min(a, b), res = 0;\n    for(int l = 1, r; l <= lim; l = r + 1) {\n        r = min(a / (a / l), b / (b / l));\n        res = (res + 1ll * (s[r] - s[l - 1] + MOD) % MOD * f(a / l, b / r) % MOD) % MOD;\n    }\n    return res;\n}\n\n// \u7b2c\u4e8c\u6b21\u6570\u8bba\u5206\u5757\ninline int slove(int a, int b) {\n    int lim = min(a, b), res = 0;\n    for(int l = 1, r; l <= lim; l = r + 1) {\n        r = min(a / (a / l), b / (b / l));\n        res = (res + 1ll * (r - l + 1) * (l + r) / 2 % MOD * g(a / l, b / l) % MOD + MOD) % MOD;\n    }\n    return res;\n}\n\nsigned main() {\n\n    scanf(\"%lld%lld\", &n, &m);\n\n    prework();\n\n    printf(\"%lld\\n\", (slove(n, m) + MOD) % MOD);\n}\n```",
        "postTime": 1544785951,
        "uid": 29615,
        "name": "IceLocke",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB\u3011"
    },
    {
        "content": "### \u9898\u76ee\u5927\u610f\n\u7ed9\u5b9a $n,m$\uff0c\u4ee4\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{m}lcm(i,j)\u2261x\\pmod {20101009}$$\n\n\u6c42\u6700\u5c0f\u7684\u975e\u8d1f $x$\u3002\n\n**\u6570\u636e\u8303\u56f4**\u3000$1\\leqslant n,m\\leqslant 10^{7}$\n$$\\begin{aligned}\\end{aligned}$$\n\n### \u9898\u89e3\n\u5f00\u59cb\u63a8\u5f0f\u5b50\u3002\n$$\\begin{aligned}Ans&=\\sum_{i=1}^{n}\\sum_{j=1}^{m}\\frac{i\\times j}{(i,j)}\\\\&=\\sum_{d=1}^{n}\\sum_{i=1}^{n}\\sum_{j=1}^{m}\\frac{i\\times j}{d}[(i,j)=d]\\\\&=\\sum_{d=1}^{\\min(n,m)}\\sum_{i=1}^{\\large\\lfloor\\frac nd\\rfloor}\\sum_{j=1}^{\\large\\lfloor\\frac md\\rfloor}\\frac{d\\cdot i\\times d\\cdot j}{d}[(i,j)=1]\\\\&=\\sum_{d=1}^{\\min(n,m)}d\\sum_{i=1}^{\\large\\lfloor\\frac nd\\rfloor}\\sum_{j=1}^{\\large\\lfloor\\frac md\\rfloor}ij[(i,j)=1]\\\\&=\\sum_{d=1}^{\\min(n,m)}d\\times \\sum_{i=1}^{\\large\\lfloor\\frac nd\\rfloor}\\sum_{j=1}^{\\large\\lfloor\\frac md\\rfloor}ij\\sum_{k|i,k|j}\\mu(k)\\\\&=\\sum_{d=1}^{\\min(n,m)}d\\times \\sum_{k=1}^{\\large\\lfloor\\frac nd\\rfloor}\\mu(k)\\sum_{k|i}^{i\\leqslant {\\large\\lfloor\\frac nd\\rfloor}}i\\sum_{k|j}^{j\\leqslant {\\large\\lfloor\\frac md\\rfloor}}j\\\\&=\\sum_{d=1}^{\\min(n,m)}d\\times \\sum_{k=1}^{\\large\\lfloor\\frac {\\min(n,m)}d\\rfloor}\\mu(k)\\left(\\sum_{k|i}^{i\\leqslant {\\large\\lfloor\\frac nd\\rfloor}}i\\right)\\left(\\sum_{k|j}^{j\\leqslant {\\large\\lfloor\\frac md\\rfloor}}j\\right)\\\\&=\\sum_{d=1}^{\\min(n,m)}d\\times \\sum_{k=1}^{\\large\\lfloor\\frac {\\min(n,m)}d\\rfloor}\\mu(k)\\left(\\sum_{i=1}^{\\large\\lfloor\\frac n{dk}\\rfloor}ik\\right)\\left(\\sum_{j=1}^{\\large\\lfloor\\frac m{dk}\\rfloor}jk\\right)\\\\&=\\sum_{d=1}^{\\min(n,m)}d\\times \\sum_{k=1}^{\\large\\lfloor\\frac {\\min(n,m)}d\\rfloor}k^2\\mu(k)\\left(\\frac{\\left(1+\\Big\\lfloor\\dfrac n{dk}\\Big\\rfloor\\right)\\Big\\lfloor\\dfrac n{dk}\\Big\\rfloor}2\\right)\\left(\\frac{\\left(1+\\Big\\lfloor\\dfrac m{dk}\\Big\\rfloor\\right)\\Big\\lfloor\\dfrac m{dk}\\Big\\rfloor}2\\right)\\end{aligned}$$\n\n\n\u66f4\u6362\u679a\u4e3e\u9879\uff0c\u679a\u4e3e $T=kd$\uff0c\u6613\u5f97\u5176\u4e0a\u754c\u4e3a $n$\uff0c\u5e76\u4e14 $k|T$\uff0c\u5219\u6709\n$$\\begin{aligned}Ans&=\\sum_{T=1}^{\\min(n,m)}\\sum_{k|T}\\frac Tk\\times k^2\\times \\mu(k)\\times {\\left(\\frac{\\left(1+\\Big\\lfloor\\dfrac n{T}\\Big\\rfloor\\right)\\Big\\lfloor\\dfrac n{T}\\Big\\rfloor}2\\right)}{\\left(\\frac{\\left(1+\\Big\\lfloor\\dfrac m{T}\\Big\\rfloor\\right)\\Big\\lfloor\\dfrac m{T}\\Big\\rfloor}2\\right)}\\\\&=\\sum_{T=1}^{\\min(n,m)}{\\left(\\frac{\\left(1+\\Big\\lfloor\\dfrac n{T}\\Big\\rfloor\\right)\\Big\\lfloor\\dfrac n{T}\\Big\\rfloor}2\\right)}{\\left(\\frac{\\left(1+\\Big\\lfloor\\dfrac m{T}\\Big\\rfloor\\right)\\Big\\lfloor\\dfrac m{T}\\Big\\rfloor}2\\right)}\\sum_{k|T}k^2\\times \\mu(k)\\times \\frac Tk\\end{aligned}$$\n\n\u8fd9\u91cc\u6700\u597d\u4e0d\u8981\u5316\u7b80\u540e\u9762\u7684\n$$\\sum_{k|T}k^2\\times \\mu(k)\\times \\frac Tk$$\n\n\u6700\u597d\u76f4\u63a5\u628a\u5b83\u8f6c\u6362\u4e3a\u5377\u79ef\n$$\\begin{aligned}Ans&=\\sum_{T=1}^n{\\left(\\frac{\\left(1+\\Big\\lfloor\\dfrac n{T}\\Big\\rfloor\\right)\\Big\\lfloor\\dfrac n{T}\\Big\\rfloor}2\\right)}{\\left(\\frac{\\left(1+\\Big\\lfloor\\dfrac m{T}\\Big\\rfloor\\right)\\Big\\lfloor\\dfrac m{T}\\Big\\rfloor}2\\right)}\\Big((id^2\\cdot\\mu)*id\\Big)(T)\\end{aligned}$$\n\n\u5982\u679c\u6211\u4eec\u80fd\u7ebf\u6027\u7b5b\u51fa\u524d\u9762\u7684 $(id^2\\cdot\\mu)*id$ \u5c31\u5927\u529f\u544a\u6210\u4e86\u3002\n\u8fd9\u9700\u8981\u8ba1\u7b97\u5176\u4e09\u6761\u7279\u70b9\uff1a\n$$\\Big((id^2\\cdot\\mu)*id\\Big)(1)=1$$\n\n$$\\Big((id^2\\cdot\\mu)*id\\Big)(p)=p\\cdot(1-p)$$\n\n$$\\Big((id^2\\cdot\\mu)*id\\Big)(p^k)=p^k\\cdot(1-p)$$\n\n\u8bc1\u660e\uff1a\u7531\u4e8e $p^0=1,p^1=p$\uff0c\u56e0\u800c\u6211\u4eec\u53ea\u9700\u8981\u8bc1\u660e\u7b2c\u4e09\u6761\u6027\u8d28\u6210\u7acb\u5373\u53ef\u3002\n$$\\begin{aligned}\\Big((id^2\\cdot\\mu)*id\\Big)(p^k)&=\\sum_{d|p^k} (id^2\\cdot\\mu)(d)\\times id\\left(\\frac{p^k}{d}\\right)\\\\&=p^k\\times \\sum_{d|p^k} d\\cdot\\mu(d)\\\\&=p^k\\times \\sum_{t=0}^k p^t\\cdot\\mu(p^t)\\\\&=p^k\\times \\left(p^0\\cdot\\mu(p^0)+p^1\\cdot\\mu(p^1)+\\sum_{t=2}^kp^t\\cdot\\mu(p^t)\\right)\\\\&=p^k\\times \\left(1-p+\\sum_{t=2}^kp^t\\times0\\right)\\\\&=p^k\\cdot\\left(1-p\\right)\\end{aligned}$$\n\n\u81f3\u6b64\uff0c\u6211\u4eec\u80fd\u591f\u5728 $T(k)=\\Theta(1)$ \u7684\u65f6\u95f4\u5185\u6c42\u51fa\u4e0a\u9762\u4e09\u79cd\u4f4d\u7f6e\u7684\u51fd\u6570\u503c\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u7ebf\u6027\u7b5b\u4e86\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u8fdb\u4e00\u6b65\u964d\u4f4e\u5230 $T(n)=\\Theta(n+\\sqrt n)$\u3002\n\n\u4f46\u8fd9\u6837\u5e38\u6570\u6709\u4e9b\u5927\uff0c\u4f1a\u4e0d\u4f1a\u6709\u98ce\u9669\uff1f\n\n\u8003\u8651\u675c\u6559\u7b5b\u3002\n\n\u53ea\u8981\u6c42\u51fa\u51fd\u6570 $\\Big((id^2\\cdot \\mu)*id\\Big)$ \u7684\u524d\u7f00\u548c\u5373\u53ef\u3002\u56e0\u6b64\u8003\u8651\u53d6 $g=id$\u3002\n\n**\u7b49\u7b49\uff01**\n\n\u4e3a\u4ec0\u4e48\u8981\u8003\u8651 $g=id$\uff1f\u4e3a\u4e86\u8ba9\u540e\u7eed\u7684 ~~**\u4e71\u731c**~~ \u66f4\u65b9\u4fbf\uff1f\u5982\u679c $g=id$ \u80fd\u505a\u5230\u4e9b\u4ec0\u4e48\u7684\u8bdd\uff0c\u4e3a\u4ec0\u4e48\u91cc\u9762\u90a3\u4e2a $id$ \u4e0d\u80fd\u505a\u5230\uff1f\n\u8003\u8651\u5230\u5377\u79ef\u6709\u4ea4\u6362\u5f8b\uff0c\u6211\u4eec\u53ef\u4ee5\u5ffd\u7565\u540e\u9762\u90a3\u4e2a $*id$ \u800c\u76f4\u63a5\u8003\u8651\u524d\u9762\u7684 $(id^2\\cdot \\mu)$\uff0c\u5f88\u5bb9\u6613\u53d1\u73b0\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u7528\u70b9\u4e58\u5f97\u5230\u51fd\u6570\u53ea\u9700\u8981\u53d6 $g=id^2$ \u5373\u53ef\u3002\n$$\\begin{aligned}\\bigg(\\Big((id^2\\cdot \\mu)*id\\Big)*id^2\\bigg)(n)&=\\bigg(\\Big((id^2\\cdot \\mu)*id^2\\Big)*id\\bigg)(n)\\\\&=\\sum_{d|n}\\Big((id^2\\cdot \\mu)*id^2\\Big)(d)\\times\\frac nd\\\\&=\\sum_{d|n}\\sum_{k|d}k^2\\cdot \\mu(k)\\times\\frac {d^2}{k^2}\\times \\frac nd\\\\&=n\\sum_{d|n}d\\sum_{k|d}\\mu(k)\\\\&=n\\sum_{d|n}d[d=1]\\\\&=n\\\\&=id(n)\\end{aligned}$$\n\n\u7684\u786e\u662f\u4e2a\u8ba9\u4eba\u7701\u5fc3\u7684\u51fd\u6570\u3002\n\u56e0\u800c\u6709\n$$\\begin{aligned}n&=\\bigg(\\Big((id^2\\cdot \\mu)*id\\Big)*id^2\\bigg)(n)\\\\&=\\sum_{d|n}\\Big((id^2\\cdot \\mu)*id\\Big)(d)\\times \\frac{n^2}{d^2}\\\\&=\\sum_{d|n,d\\not=n}\\Big((id^2\\cdot \\mu)*id\\Big)(d)\\times \\frac{n^2}{d^2}+\\Big((id^2\\cdot \\mu)*id\\Big)(n)\\end{aligned}$$\n\n\u79fb\u9879\uff0c\u5f97\n$$\\Big((id^2\\cdot \\mu)*id\\Big)(n)=n-\\sum_{d|n,d\\not=n}\\Big((id^2\\cdot \\mu)*id\\Big)(d)\\times \\frac{n^2}{d^2}$$\n\u6c42\u548c\n$$\\begin{aligned}\\text{Sum}_{(id^2\\cdot \\mu)*id}(n)&=\\sum_{i=1}^n\\Big((id^2\\cdot \\mu)*id\\Big)(i)\\\\&=\\sum_{i=1}^ni-\\sum_{i=1}^n\\sum_{d|i,d\\not=i}\\Big((id^2\\cdot \\mu)*id\\Big)(d)\\times \\frac{i^2}{d^2}\\\\&=\\frac{(1+n)n}2-\\sum_{k=2}^n\\sum_{d=1}^{\\large\\lfloor\\frac nk\\rfloor}\\Big((id^2\\cdot \\mu)*id\\Big)(d)\\times\\frac{k^2d^2}{d^2}\\\\&=\\frac{(1+n)n}2-\\sum_{k=2}^nk^2\\times \\text{Sum}_{(id^2\\cdot \\mu)*id}(n)\\left(\\Big\\lfloor\\frac nk\\Big\\rfloor\\right)\\end{aligned}$$\n\n\u9012\u5f52\u9664\u6cd5\u5206\u5757\u5904\u7406\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $T(n)=\\Theta(n^{\\frac 34})$\n\u524d\u9762\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u90e8\u5206\u9664\u6cd5\u5206\u5757\u5904\u7406\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6**\u4ecd\u7136**\u4e3a $T(n)=\\Theta(n^{\\frac 34})$\u3002\n\u518d\u628a\u524d\u9762 $n\\frac 23$ \u7ebf\u6027\u7b5b\u51fa\u6765\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u964d\u4f4e\u5230\u4e86 $\\Theta(n^{\\frac 23})$\n\nAccepted  100\n\u7528\u65f6: 470ms\n\u5185\u5b58: 13828KB\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define maxn 406415\nconst long long mod=20101009;\nlong long inv_2=500000004;\nlong long inv_6=166666668;\nlong long low[maxn],f[maxn],pri[maxn],vis[maxn],s[maxn];\nvoid sieve(long long n){\n    memset(vis,0,sizeof vis);\n    long long tot=0;\n    vis[1]=low[1]=f[1]=1;\n    for (long long i=2;i<=n;i++)\n    {\n        if(!vis[i]) low[i]=pri[++tot]=i,f[i]=(i-(i*i)%mod+mod)%mod;\n        for (long long j=1;j<=tot&&i*pri[j]<=n;j++)\n        {\n            vis[i*pri[j]]=1;\n            if (i%pri[j]==0)\n            {\n                low[i*pri[j]]=low[i]*pri[j];\n                if (low[i]==i)\n                    f[i*pri[j]]=((((1-pri[j])*i+mod)%mod)*pri[j]+mod)%mod;\n                else\n                    f[i*pri[j]]=(f[i/low[i]]*f[low[i]*pri[j]]+mod)%mod;\n                break;\n            }\n            low[i*pri[j]]=pri[j];\n            f[i*pri[j]]=(f[i]*f[pri[j]])%mod;\n        }\n    }\n    for(int i=1;i<=n;i++)\n    \ts[i]=(s[i-1]+f[i]+mod)%mod;\n}\nlong long ft_1(long long a){\n    long long t=a%mod;\n    return ((((1+(t))*(t))%mod)*inv_2)%mod;\n}\nlong long ft_2(long long a){\n    long long t=a%mod;\n    return (((t*(t+1)%mod)*(2*t+1)%mod)*inv_6)%mod;\n}\nmap<long long,long long> Sf;\nlong long S(long long n){\n    if(n<=maxn-10) return s[n];\n    {\tmap<long long,long long>::iterator t=Sf.find(n);\n        if(t!=Sf.end()) return t->second;\t}\n    long long ans=ft_1(n);\n    for(long long l=2,r;l<=n;l=r+1){\n        r=n/(n/l);\n        ans-=S(n/l)*(ft_2(r)-ft_2(l-1))%mod;\n        ans=(ans+mod)%mod;\n    } return Sf[n]=ans;\n}\nvoid main2(long long n,long long m){\n    long long ans=0;\n    long long len=min(n,m);\n    for(long long l=1,r;l<=len;l=r+1){\n        r=min(n/(n/l),m/(m/l));\n        if(r>n) r=n;\n        ans+=ft_1(n/l)*ft_1(m/l)%mod*(S(r)-S(l-1))%mod;\n        ans=(ans+mod)%mod;\n    } printf(\"%lld\",ans); \n}\nlong long pow_t(long long a,long long b){\n    if(b==1) return a%mod;\n    long long t=pow_t(a,b/2);\n    if((b&1)==0) return t*t%mod;\n    return t*t%mod*a%mod;\n}\nint main(){\n    inv_2=pow_t(2,mod-2);\n    inv_6=pow_t(6,mod-2);\n    sieve(maxn-10);\n    long long n,m,ans=0;\n    scanf(\"%lld%lld\",&n,&m);\n    main2(n,m);\n    return 0;\n}\n```\n**\u8bb0\u5f97\u8bb0\u5fc6\u5316\uff0c\u8bb0\u5f97\u8bb0\u5fc6\u5316\uff0c\u8bb0\u5f97\u8bb0\u5fc6\u5316\u2026\u2026\u522b\u95ee\u6211\u600e\u4e48\u77e5\u9053\u7684\u3002**\n~~\u4fee\u6539\u4e00\u4e0b\u6a21\u6570\u548c\u89c4\u6a21\uff0c\u672c\u4ee3\u7801\u8fd8\u53ef\u4ee5\u901a\u8fc7\u5176[\u589e\u5f3a\u7248](https://www.51nod.com/Question/Index.html#!#questionId=1063&isAsc=false)\u3002~~\n\nPS\uff1a\u9762\u5bf9luogu\u7684Latex\u516c\u5f0f\u4e0d\u80fd\u6362\u884c\u6beb\u65e0\u8fd8\u624b\u4e4b\u529b\uff0c\u6539\u5230\u81ea\u95ed\u2026\u2026\n\n#### \u9644\u5f55\uff1a\u516c\u5f0f\u5bf9\u9f50\u65b9\u6cd5\n```latex\n$$\\begin{aligned}\nT&=\\sum_{i=1}^ni\\\\\n&=\\frac{n(1+n)}{2}\\\\\n&=\\frac 12\\left(n+n^2\\right)\n\\end{aligned}$$\n```\n\u4f46\u662fluogu\u7684\u516c\u5f0f\u5fc5\u987b\u5199\u5728\u540c\u4e00\u884c\u4e2d\uff0c\u56e0\u6b64\u5e94\u8be5\u8fd9\u4e48\u5199\n\n```latex\n$$\\begin{aligned}T&=\\sum_{i=1}^ni\\\\&=\\frac{n(1+n)}{2}\\\\&=\\frac 12\\left(n+n^2\\right)\\end{aligned}$$\n```\n\n\u6548\u679c\uff1a\n$$\\begin{aligned}T&=\\sum_{i=1}^ni\\\\&=\\frac{n(1+n)}{2}\\\\&=\\frac 12\\left(n+n^2\\right)\\end{aligned}$$",
        "postTime": 1557898506,
        "uid": 29372,
        "name": "glassy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB\u3011"
    },
    {
        "content": "[\u539f\u535a\u5ba2\u5730\u5740][1]\n\n[1]:https://www.cnblogs.com/nlKOG/p/10543409.html\n\n\u8fd9\u9053\u9898\u5728bzoj\u6709\u591a\u7ec4\u6570\u636e,\u90a3\u4e48\u6d1b\u8c37\u9898\u89e3\u91cc\u7684\u53cc\u91cd\u5206\u5757\u5728bzoj\u5c31\u4f1aT\n\n\u90a3\u6211\u5c31\u8bb2\u4e00\u4e0b\u53ea\u6709\u4e00\u91cd\u5206\u5757\u7684\u505a\u6cd5\n\n\u65f6\u95f4\u590d\u6742\u5ea6(\u5927\u6982) O($N_{max}+T\\sqrt{N_i}$) \u5176\u4e2dT\u4e3a\u6570\u636e\u7ec4\u6570\n\n$\n\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\operatorname{lcm(i,j)}\n$\n\n$\n=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\frac{i\\cdot j}{\\gcd(i,j)} \n$\n\n$\n=\\sum\\limits_{i=1}^n\n\\sum\\limits_{i=1}^m\n\\sum\\limits_{d=1}^{min(n,m)}\\frac{i\\cdot j}d[gcd(i,j)=d]\n$\n\n$\n=\\sum\\limits_{d=1}^{min(n,m)}\n\\sum\\limits_{i=1}^{\\lfloor\\frac{n}d\\rfloor}\n\\sum\\limits_{i=1}^{\\lfloor\\frac{m}d\\rfloor}\ndij\\cdot [gcd(i,j)=1]\n$\n\n$\n=\\sum\\limits_{d=1}^{min(n,m)}\n\\sum\\limits_{i=1}^{\\lfloor\\frac{n}d\\rfloor}\n\\sum\\limits_{i=1}^{\\lfloor\\frac{m}d\\rfloor}\ndij\n\\sum\\limits_{x|gcd(i,j)}^{}\\mu(x)\n$\n\n$\n=\\sum\\limits_{d=1}^{min(n,m)}\n\\sum\\limits_{i=1}^{\\lfloor\\frac{n}d\\rfloor}\n\\sum\\limits_{i=1}^{\\lfloor\\frac{m}d\\rfloor}\ndij\n\\sum\\limits_{x|i,x|j}\\mu(x)\n$\n\n\u7136\u540e\u628a\u03bc(x)\u548cd\u8c03\u5230\u524d\u9762\u53bb,i\u53d8\u6210ix,j\u53d8\u6210jx\n\n$\n=\\sum\\limits_{d=1}^{min(n,m)}d\n\\sum\\limits_{x=1}^{min(\\lfloor\\frac{n}d\\rfloor,\\lfloor\\frac{m}d\\rfloor)}\u03bc(x)\n\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{dx}\\rfloor}ix\n\\sum\\limits_{j=1}^{\\lfloor\\frac{m}{dx}\\rfloor}jx\n$\n\n\u7136\u540e\u628ax\u4e5f\u8c03\u5230\u524d\u9762\u53bb\n\n$\n=\\sum\\limits_{d=1}^{min(n,m)}d\n\\sum\\limits_{x=1}^{min(\\lfloor\\frac{n}d\\rfloor,\\lfloor\\frac{m}d\\rfloor)}x^2\u03bc(x)\n\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{dx}\\rfloor}\n\\sum\\limits_{j=1}^{\\lfloor\\frac{m}{dx}\\rfloor}ij\n$\n\n\u7136\u540e\u7b49\u5dee\u6570\u5217\n\n$\n=\\sum\\limits_{d=1}^{min(n,m)}d\n\\sum\\limits_{x=1}^{min(\\lfloor\\frac{n}d\\rfloor,\\lfloor\\frac{m}d\\rfloor)}x^2\\mu(x)\n\\frac{(1+\\lfloor\\frac{n}{dx}\\rfloor)\\lfloor\\frac{n}{dx}\\rfloor}{2}\\frac{(1+\\lfloor\\frac{m}{dx}\\rfloor)\\lfloor\\frac{m}{dx}\\rfloor}{2}\n$\n\n\u5728\u6d1b\u8c37\u7684\u8bdd\u63a8\u5230\u8fd9\u4e00\u6b65\u5c31\u591f\u4e86\n\n\n\u4f46\u662f\u60f3\u8981\u5728bzoj\u8fc7\u8fd9\u9053\u9898\u8fd8\u8981\u63a5\u7740\u4f18\u5316\n\n\u7136\u540e\u8bbeT=dx,\u6240\u4ee5x=$\\frac{T}{d}$\n\n$\n=\\sum\\limits_{T=1}^{min(n,m)}\n\\frac{(1+\\lfloor\\frac{n}{T}\\rfloor)\\lfloor\\frac{n}{T}\\rfloor}{2}\\frac{(1+\\lfloor\\frac{m}{T}\\rfloor)\\lfloor\\frac{m}{T}\\rfloor}{2}\n\\sum\\limits_{d|T}d\\frac{T^2}{d^2}\\mu(\\frac{T}{d})\n$\n\n\u7531\u4e8e\u5bf9\u79f0\u6027\n\n$\n=\\sum\\limits_{T=1}^{min(n,m)}\n\\frac{(1+\\lfloor\\frac{n}{T}\\rfloor)\\lfloor\\frac{n}{T}\\rfloor}{2}\\frac{(1+\\lfloor\\frac{m}{T}\\rfloor)\\lfloor\\frac{m}{T}\\rfloor}{2}\n\\sum\\limits_{d|T}\\frac{T}{d}d^2\\mu({d})\n$\n\n$\n=\\sum\\limits_{T=1}^{min(n,m)}\n\\frac{(1+\\lfloor\\frac{n}{T}\\rfloor)\\lfloor\\frac{n}{T}\\rfloor}{2}\\frac{(1+\\lfloor\\frac{m}{T}\\rfloor)\\lfloor\\frac{m}{T}\\rfloor}{2}\n\\sum\\limits_{d|T}Td\\mu({d})\n$\n\n\u7136\u540e\u6211\u4eec\u8bbe\n\n$\ng(T)=\\sum\\limits_{d|T}Td\\mu({d})\n$\n\n\u7136\u540e\u53ef\u4ee5\u53d1\u73b0g\u662f\u4e00\u4e2a\u79ef\u6027\u51fd\u6570\n\n\u6240\u4ee5\u6709\n\n$\ng(\\Pi P_i^{ai})=\\Pi g(P_i^{ai})\n$\n\n$\n=\\Pi (T*P_i^{0}*\\mu(1)+T*P_i*\\mu(P_i))\n$\n\n$\n=\\Pi (T-T*P_i)\n$\n\n$\n=\\Pi (T*(1-P_i))\n$\n\n\u56e0\u6b64\n\n$\ng(p)=1-p\n$\n\n$\ng(p^k)=g(p^{k-1})\n$\n\n\u5f53np\u4e92\u8d28\u65f6,\u6709\n\n$\ng(np)=g(n)*g(p)\n$\n\n\u7136\u540e\u7b5b\u4e00\u7b5b\u5c31\u51fa\u6765\u4e86\n\n\u4ee3\u7801\uff1a\n```\n#pragma GCC optimize(3)\n#include<bits/stdc++.h>\n#define int long long\n#define N 10000010\nusing namespace std;\nconst int mod=20101009;\nint vis[N],prim[N/10],mu[N],low[N],sum[N],cnt;\nvoid pre(int n){\n\tmu[1]=1;\n\tsum[1]=low[1]=1;\n\tfor(int i=2;i<=n;i++){\n\t\tif(!vis[i])mu[i]=-1,prim[++cnt]=i,low[i]=i,sum[i]=(1-i+mod)%mod;\n\t\tfor(int j=1;j<=cnt&&i*prim[j]<=n;j++){\n\t\t\tvis[i*prim[j]]=1;\n\t\t\tif(i%prim[j]==0){\n\t\t\t\tlow[i*prim[j]]=low[i]*prim[j];\n\t\t\t\tif(low[i]==i)sum[i*prim[j]]=sum[i];\n\t\t\t\telse sum[i*prim[j]]=sum[i/low[i]]*sum[prim[j]*low[i]]%mod;\n\t\t\t\tbreak;\n\t\t\t}else{\n\t\t\t\tlow[i*prim[j]]=prim[j];\n\t\t\t\tsum[i*prim[j]]=sum[i]*sum[prim[j]]%mod;\n\t\t\t\tmu[i*prim[j]]=-mu[i];\n\t\t\t}\n\t\t}\n\t}\n\tfor(int T=1;T<=n;T++)sum[T]=(T*sum[T]%mod+sum[T-1])%mod;\n}\nint ask(int x,int y){return (x+y)*(y-x+1)/2%mod;}\nint query(int n,int m){\n\tint re=0;\n\tint mx=min(n,m);\n\tfor(int l=1,r;l<=mx;l=r+1){\n\t\tr=min(n/(n/l),m/(m/l));\n\t\tint tmp=ask(1,n/l)*ask(1,m/l)%mod;\n\t\ttmp=tmp*(sum[r]-sum[l-1]+mod)%mod;\n\t\tre=(re+tmp)%mod;\n\t}\n\treturn re;\n}\nint t;\nsigned main(){\n\tpre(10000000);\n\tint n,m;\n\tscanf(\"%lld%lld\",&n,&m);\n\tprintf(\"%lld\\n\",query(n,m));\n\treturn 0;\n}\n```\n\nupd:\u4e4b\u524dletax\u70b8\u4e86,\u8865\u4e0b\u9505",
        "postTime": 1552731252,
        "uid": 98051,
        "name": "The_KOG",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB\u3011"
    },
    {
        "content": "## \u9898\u610f\n\n\u6c42\u89e3\u5f0f\u5b50\n$$ANS(n,m) = \\sum_{i=1}^n\\sum_{j=1}^mlcm(i,j)$$\n\n\u5176\u4e2d$1 \\leq n,m \\leq 1e7$\n\n## \u5206\u6790\n\n\u56e0\u4e3a\u662f\u5355\u6b21\u8be2\u95ee\uff0c\u6240\u9700\u590d\u6742\u5ea6\u4e0d\u9ad8\u4e8eO(n)\n\n\u63a8\u5bfc\u7684\u601d\u8def\uff1a \n\n\u5c06lcm\u8f6c\u5316\u6210gcd\n$$ANS(n,m) = \\sum_{i=1}^n\\sum_{j=1}^m \\frac{i\\cdot j}{gcd(i,j)}$$\n\u6c42\u548c\u4e2d\u6709gcd, \u8f6c\u53d8\u6c42\u548c\u987a\u5e8f\uff0c\u5148\u4ee5\u76f8\u540c\u7684gcd\u5206\u7ec4\uff0c\u679a\u4e3egcd\u3002\n\n\u7531gcd\u7684\u6027\u8d28\u53ef\u4ee5\u77e5\u9053$gcd(i,j)| i $ \u5e76\u4e14$gcd(i,j)|j$\n$$ANS(n,m) = \\sum_{d=1}^n (\\frac 1 d\\sum_{d|i} \\sum_{d|j} ([gcd(i,j)==d]\\cdot i \\cdot j))$$\n\n\u89c2\u5bdf\u53d1\u73b0$i$\u7684\u53d6\u503c\u662f$d,2d,...,\\lfloor\\frac n d \\rfloor d$\uff0c\n$j$\u7684\u53d6\u503c\u662f$d,2d,...,\\lfloor\\frac m d \\rfloor d$\n\n\u6362\u5143 $i = \\frac i d,j = \\frac j d$\n\n\n$$ANS(n,m) = \\sum_{d=1}^n d\\sum_{i=1}^{\\lfloor \\frac n d \\rfloor} \\sum_{j=1}^{\\lfloor \\frac m d \\rfloor}([gcd(i,j)==1]\\cdot i \\cdot j )$$\n\n\u4ee4 \n$$S(n,m) = \\sum_{i=1}^{n} \\sum_{j=1}^{m}([gcd(i,j)==1]\\cdot i \\cdot j )$$\n\n\u8fd9\u91cc\u662f\u5728\u6c42\u89e3\u4e92\u8d28\u7684\u6570\u5bf9\u7684\u4e58\u79ef\u548c\n\n\u5219\n$$ANS(n,m) = \\sum_{d=1}^n( d \\cdot S(\\lfloor \\frac n d\\rfloor,\\lfloor \\frac m d\\rfloor))$$\n\n\u8003\u8651\u5982\u4f55\u6c42\u89e3$S(n,m)$\n\n\u56e0\u4e3a$\\epsilon(n)$\u5728n\u4e3a1\u7684\u65f6\u5019\u4e3a1\uff0c\u5176\u4ed6\u65f6\u5019\u4e3a0\n\n$$S(n,m) = \\sum_{i=1}^{n} \\sum_{j=1}^{m}(\\epsilon(gcd(i,j))\\cdot i \\cdot j )$$\n\n\u56e0\u4e3a$1 * \\mu = \\epsilon$\n\n\u6240\u4ee5\u7528$\\mu$ \u66ff\u4ee3$\\epsilon$\n\n$$S(n,m) = \\sum_{i=1}^{n} \\sum_{j=1}^{m}(\\sum _{d|gcd(i,j)}\\mu(d))\\cdot i \\cdot j )$$\n\n\u4e8e\u662f\u8fd9\u91cc\u6ee1\u8db3\u7684\u5173\u7cfb\u662f$d | gcd(i,j)$ \u4e14$gcd(i,j)|i,gcd(i,j)|j$\uff0c\u5373$d|i,d|j$\n\n\u548c\u521a\u521a\u4e00\u6837\u7684\u601d\u8def\uff0c\u8f6c\u5316\u4e3a\u5148\u679a\u4e3e\u56e0\u5b50\n\n$$S(n,m) = \\sum_{d=1}^{n} \\mu (d) \\sum_{d|i} \\sum _{d|j} i \\cdot j$$\n\n\u6362\u5143 $i = \\frac i d,j = \\frac j d$\n\n$$S(n,m) = \\sum_{d=1}^n \\mu(d) d^2\\sum_{i=1}^{\\lfloor \\frac n d \\rfloor} \\sum_{j=1}^{\\lfloor \\frac m d \\rfloor}( i \\cdot j )$$\n\n\u4ee4\n$$g(n,m) = \\sum_{i=1}^{n} \\sum_{j=1}^{m}( i \\cdot j )$$\n\n\u8fd9\u91cc\u53ef\u4ee5\u7528\u516c\u5f0f\u8ba1\u7b97\u51fa\u6765 \n\n$$g(n,m) = \\frac {n(n+1)} 2 \\cdot \\frac {m(m+1)} 2$$\n\n\u800c\u524d\u534a\u90e8\u5206\u7684$\\mu(d) d^2$\u53ef\u4ee5\u7ebf\u6027\u7b5b\u7b5b\u51fa\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u540e\uff0c\u9884\u5904\u7406\u524d\u7f00\u548c\u6c42\u89e3\n\n\u5219\n$$S(n,m) = \\sum_{d=1}^n \\mu(d)\\cdot d^2\\cdot g(\\lfloor \\frac n d \\rfloor,\\lfloor \\frac m d \\rfloor)$$\n\n\u53ef\u4ee5\u5206\u5757\u6c42\u89e3\n\n$$ANS(n,m) = \\sum_{d=1}^n( d \\cdot S(\\lfloor \\frac n d\\rfloor,\\lfloor \\frac m d\\rfloor))$$\n\n\u518d\u6b21\u5206\u5757\u6c42\u89e3\n\n\u6c42\u5f97\u6700\u540e\u7b54\u6848\n\n## \u4ee3\u7801\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mod = 20101009;\ntypedef long long ll;\n\nbool not_prime[10000001];\nint mu[10000001];\nint prime[1000001];\nvoid mus(int n){\n    mu[1] = 1;int tot=0;\n    for(int i=2;i<=n;i++) {\n        if(not_prime[i]==0) prime[++tot] = i,mu[i]=-1;\n        for(int j=1;j<=tot&& prime[j]*i<=n;j++) {\n            not_prime[prime[j]*i] = 1;\n            if(i%prime[j]==0) {\n                mu[i*prime[j]]=0;\n                break;\n            }\n            mu[i*prime[j]] = -mu[i];\n        }\n    }\n\n    for(int i=1;i<=n;i++) {\n        mu[i] = mu[i] *1ll* i % mod * i % mod;\n        mu[i] += mu[i-1];\n        mu[i] %= mod;\n    }\n}\n\nint sum2(int n,int m){\n    int a = (n*1ll*(n+1)/2)%mod;\n    int b = (m*1ll*(m+1)/2)%mod;\n    return a*1ll*b%mod;\n}\n\nint sum(int n,int m) {\n\n    if(n>m) swap(n,m);\n    int res = 0;\n    for(int d=1;d<=n;) {\n        int en = min(n/(n/d),m/(m/d));\n        int a = sum2(n/d,m/d);\n        int b = (mu[en] - mu[d-1] + mod)%mod;\n        res += (a*1ll*b%mod);\n        res %=mod;\n        d = en+1;\n    }\n    return res;\n}\nint solve(int n,int m) {\n    if(n>m) swap(n,m);\n    int res = 0;\n    for(int d=1;d<=n;) {\n        int en = min(n/(n/d),m/(m/d));\n        int a = sum(n/d,m/d);\n\n        int b = ((d+en)*1ll*(en-d+1)/2)%mod;\n        res += (a*1ll*b%mod);\n        res %= mod;\n        d = en+1;\n    }\n    return res;\n}\n\n\nint main() {\n    int n,m;\n    cin>>n>>m;\n    mus(n);\n    cout<<solve(n,m)<<endl;\n    return 0;\n    int res =0;\n    for(int i=1;i<=n;i++) {\n        for(int j=1;j<=m;j++) {\n            int g = __gcd(i,j);\n            res += ((i*1ll*j / g) %mod);\n            res %=mod;\n        }\n    }\n    cout<<res<<endl;\n}\n```\n\n\n\n",
        "postTime": 1562744475,
        "uid": 24071,
        "name": "greenty",
        "ccfLevel": 0,
        "title": "\u3010luogu P1829\u3011Crash\u7684\u6570\u5b57\u8868\u683c (\u6570\u8bba\u5206\u5757\uff0c\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff09"
    },
    {
        "content": "~~\u770b\u5230\u6ca1\u6709\u5199\u675c\u6559\u7b5b\u7684\u5341\u5206\u5f00\u5fc3.~~\n\n$n,m\\leq 1000?$\n\n\u6211\u4f1a\u6c42$lcm$!\n\n$n,m\\leq 10000000?$\n\n\u9996\u5148\u4e00\u5b9a\u53ef\u4ee5\u5957\u4e0a[\u8fd9\u91cc](https://www.luogu.org/blog/qwaszx/ru-men-fan-yan-tao-lu#)\u7684\u505a\u6cd5.\n\n\u4e0d\u8fc7\u8fd8\u662f\u6765\u63a8\u4e00\u904d(\u8df3\u8dc3\u6027\u53ef\u80fd\u7565\u5927\uff0c\u8be6\u7ec6\u6b65\u9aa4\u8bf7\u770b\u4e0a\u9762\u7684\u94fe\u63a5).\u4ee5\u4e0b\u9664\u6cd5\u5747\u5411\u4e0b\u53d6\u6574.\u4e0d\u5931\u4e00\u822c\u6027\uff0c\u8bbe$n\\leq m$\uff0c\u90a3\u4e48\n\n$\\begin{array}{lcc}\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m lcm(i,j)=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\dfrac{ij}{\\gcd(i,j)}\\\\=\\sum\\limits_{d=1}^n\\frac{1}{d}\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^mij[\\gcd(i,j)=d]\\\\=\\sum\\limits_{d=1}^nd\\sum\\limits_{i=1}^{\\frac{n}{d}}\\sum\\limits_{j=1}^\\frac{m}{d}ij[gcd(i,j)=1]\\\\=\\sum\\limits_{d=1}^nd\\sum\\limits_{k}\\mu(k)\\sum\\limits_{i=1}^\\frac{n}{d}\\sum\\limits_{j=1}^\\frac{m}{d}ij[k|i][k|j]\\\\=\\sum\\limits_{d=1}^nd\\sum\\limits_{k=1}^\\frac{n}{d}\\mu(k)k^2\\sum\\limits_{i=1}^\\frac{n}{kd}\\sum\\limits_{j=1}^\\frac{m}{kd}ij\\end{array}$\n\n\u8bbe$S(n)=\\sum\\limits_{i=1}^ni=\\dfrac{n(n+1)}{2}$\uff0c\u90a3\u4e48\u53ef\u4ee5\u5199\u6210\n\n$\\sum\\limits_{d=1}^nd\\sum\\limits_{k=1}^\\frac{n}{d}\\mu(k)k^2S(\\frac{n}{kd})S(\\frac{m}{kd})$\n\n\u5982\u679c\u6211\u4eec\u518d\u8bbe\u4e00\u4e2a$F(n,m)=\\sum\\limits_{k=1}^n\\mu(k)k^2S(\\frac{n}{k})S(\\frac{m}{k})$\uff0c\u90a3\u4e48\u663e\u7136$F(n,m)$\u53ef\u4ee5\u9884\u5904\u7406$\\mu$\u540e\u5728$O(\\sqrt{n})$\u65f6\u95f4\u5185\u6570\u8bba\u5206\u5757\u7b97\u51fa\u6765\n\n\u539f\u5f0f\u53ef\u4ee5\u5199\u6210$\\sum\\limits_{d=1}^ndF(\\frac{n}{d},\\frac{m}{d})$\u4e5f\u53ef\u4ee5\u6570\u8bba\u5206\u5757.\n\n\u603b\u7684\u590d\u6742\u5ea6\u5176\u5b9e\u662f$O(\\sum\\limits_{i=1}^{\\sqrt{n}}\\sqrt{i}+\\sum\\limits_{i=1}^{\\sqrt{n}}\\sqrt{\\frac{n}{i}})=O(n^\\frac{3}{4})$\n\n\u4f46\u662f\u8981\u9884\u5904\u7406$\\mu$\uff0c\u6240\u4ee5\u662f$O(n)$\u7684.\n\n$n,m\\leq 1000000,T$\u7ec4\u8be2\u95ee\uff0c$T\\leq 10000?$\n\n\u56de\u5230\u8bbe$F$\u4e4b\u524d\u7684\u90a3\u4e2a\u4f4d\u7f6e\uff0c\u6362\u4e00\u4e2a\u89d2\u5ea6.\n\n\u4ee4$T=kd$\uff0c\u679a\u4e3e$T$\uff0c\u90a3\u4e48\u4e00\u5b9a\u6709$d|T$\n\n\u539f\u5f0f$=\\sum\\limits_{T=1}^nS(\\frac{n}{T})S(\\frac{m}{T})\\sum\\limits_{d|T}d\\mu(\\frac{T}{d})\\left(\\frac{T}{d}\\right)^2=\\sum\\limits_{T=1}^nS(\\frac{n}{T})S(\\frac{m}{T})\\sum\\limits_{d|T}Td\\mu(d)$\n\n\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u9884\u5904\u7406$\\sum\\limits_{d|T}Td\\mu(d)$\u8fd9\u4e2a\u4e1c\u897f\u5373\u53ef\u505a\u5230$\\sqrt{n}$\u56de\u7b54\u4e00\u4e2a\u8be2\u95ee.\n\n\u600e\u4e48\u9884\u5904\u7406\u5462?\u663e\u7136\u53ef\u4ee5\u76f4\u63a5$O(n\\log n)$\uff0c\u4f46\u662f\u6211\u4eec\u8fd8\u662f\u8003\u8651\u7ebf\u7b5b.\n\n\u5148\u628a$T$\u62ff\u51fa\u6765\uff0c\u7136\u540e\u601d\u8003$\\mu$\u7684\u610f\u4e49.\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651$d$\u65e0\u5e73\u65b9\u56e0\u5b50\u7684\u60c5\u51b5.\u5982\u679c$n=\\prod p_i$\uff0c\u90a3\u4e48$\\sum\\limits_{d|T}d\\mu(d)=1-\\sum p_i+\\sum p_ip_j-\\cdots$.\u7ecf\u8fc7\u4e00\u756a\u601d\u8003\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50$=\\prod(1-p_i)$.(\u6bcf\u4e2a\u8d28\u56e0\u5b50\u6709\u53d6\u548c\u4e0d\u53d6\u4e24\u79cd\u9009\u62e9\uff0c\u5e76\u4e14\u5982\u679c\u53d6\u5c31\u4f1a\u6709\u4e00\u4e2a$-1$\u4e58\u4e0a\u53bb).\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u5feb\u4e50\u7ebf\u7b5b\u4e86.\n\n```cpp\nvoid make(int n)\n{\n\tf[1]=p[1]=1;\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tif(!p[i])prime[++cnt]=i,f[i]=i*(1LL-i);\n\t\tfor(int j=1;j<=cnt&&i*prime[j]<=n;j++)\n\t\t{\n\t\t\tint x=i*prime[j];p[x]=1;\n\t\t\tif(i%prime[j])f[x]=f[i]*prime[j]*(1-prime[j]);\n\t\t\telse f[x]=f[i]*prime[j];\n\t\t}\n\t}\n\tfor(int i=2;i<=n;i++)f[i]=(f[i]+f[i-1])%mod;//\u5904\u7406\u4e00\u4e2a\u524d\u7f00\u548c\n}\n```\n\n\u73b0\u5728\u662f$O(n+T\\sqrt{n})$\n\n\u5355\u7ec4\u8be2\u95ee\uff0c$n,m\\leq 10^9?$\n\n~~\u6211\u521a\u624d\u770b\u5230\u67d0\u4e2a\u795e\u4ed9\u5199\u5b8c$O(n+T\\sqrt{n})$\u5fd8\u8bb0\u4e86\u9700\u8981\u7ebf\u7b5b\u8fd9\u4e2a\u4e8b\u5b9e\u4ece\u800c\u8ba4\u4e3a\u81ea\u5df1\u505a\u5230\u4e86$O(\\sqrt{n})$~~\n\n\u663e\u7136\u675c\u6559\u7b5b\u4e86.\u8bbe$f(n)=n\\sum\\limits_{d|n}d\\mu(d)$\uff0c\u6211\u4eec\u9700\u8981\u675c\u6559\u7b5b\u51fa\u5b83\u7684\u524d\u7f00\u548c.\n\n\u6362\u4e00\u6362\u5f62\u5f0f\u6211\u4eec\u5f97\u5230$f(n)=\\sum\\limits_{d|n}d^2\\mu(d)\\frac{T}{d}$\uff0c\u5373$f(n)=(id^2\\cdot \\mu)\\ast id$.(\u5b9a\u4e49$f\\cdot g(n)=g(n)g(n)$)\n\n\u6211\u4eec\u6765\u8bd5\u8bd5\u627e\u4e00\u4e2a$g$\u4f7f\u5f97$f\\ast g$\u548c$g$\u7684\u524d\u7f00\u548c\u90fd\u53ef\u4ee5\u5feb\u901f\u8ba1\u7b97.\u56e0\u4e3a$(id^k\\cdot\\mu)\\ast id^k=\\epsilon$\uff0c\u6240\u4ee5\u6211\u4eec\u53d6$g=id^2$\uff0c\u4e8e\u662f$f\\ast g=id$\n\n\u675c\u6559\u7b5b\u5c31\u597d\u5566.\n\n\u5361\u4e86\u5361\u5e38\u6570\uff0c\u73b0\u5728\u662f\u6362\u65b0\u8bc4\u6d4b\u59ec\u4e4b\u540e\u8dd1\u7684\u6700\u5feb\u7684\u4e86(\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#define mod 20101009\n#define INF 1000000000000000000LL\n#define inv2 10050505\n#define inv6 16750841\nusing namespace std;\nconst int N=1e7+10;\nint p[N],prime[N],cnt,mu[N],N2;\nlong long f[N],n,m;\nstruct Hash_map\n{\n    struct pair{long long u,v;}val[N];\n    int fst[N],nxt[N],node_cnt;\n    long long find(long long n)\n    {\n        int key=n&8388607;//\u79d8\u6280\u00b7\u624b\u5199\u54c8\u5e0c\u8868\u00b7\u6a21\u65702\u7684\u5e42\n        for(int i=fst[key];i;i=nxt[i])if(val[i].u==n)return val[i].v;\n        return 1e18;\n    }\n    void ins(long long u,long long v)\n    {\n        int key=u&8388607;\n        val[++node_cnt]=(pair){u,v},nxt[node_cnt]=fst[key],fst[key]=node_cnt;\n    }\n}mpf;\nvoid make(int n)\n{\n    f[1]=p[1]=1;\n    for(int i=2;i<=n;i++)\n    {\n        if(!p[i])prime[++cnt]=i,f[i]=i*(1LL-i);\n        for(int j=1;j<=cnt&&i*prime[j]<=n;j++)\n        {\n            int x=i*prime[j];p[x]=1;\n            if(i%prime[j])f[x]=f[i]*f[prime[j]];\n            else {f[x]=f[i]*prime[j],mu[x]=0;break;}\n        }\n    }\n    for(int i=2;i<=n;i++)f[i]=(f[i]%mod+f[i-1]+mod)%mod;\n}\nlong long S(long long n){return n*(n+1)%mod*inv2%mod;}\nlong long S2(long long n){return n*(n+1)%mod*(2*n+1)%mod*inv6%mod;}\nlong long Sf(long long n)\n{\n    if(n<=N2)return f[n];\n    long long x=mpf.find(n);\n    if(x!=INF)return x;\n    long long ans=S(n);long long lstans=1;//\u8fd9\u91cc\u8bb0\u5f55\u4e0a\u4e00\u6b21\u7684\u7b54\u6848\u6765\u907f\u514d\u91cd\u590d\u8ba1\u7b97.\u5927\u7ea6\u80fd\u5feb\u90a3\u4e48\u4e00\u70b9\u70b9???\n    for(long long i=2,lt;i<=n;i=lt+1)\n    {\n        long long fn=n/i;lt=n/fn;long long tmp=S2(lt);\n        ans-=(tmp-lstans)*Sf(fn)%mod;\n        lstans=tmp;\n    }\n    ans=(ans%mod+mod)%mod;mpf.ins(n,ans);return ans;\n}\nint main()\n{\n    scanf(\"%lld%lld\",&n,&m);\n    if(n>m)swap(n,m);N2=pow(n,0.7)+1;make(N2);\n    long long ans=0;long long lstans=0;\n    for(int i=1,lt;i<=n;i=lt+1)\n    {\n        int fn=n/i,fm=m/i;lt=min(n/fn,m/fm);\n        long long tmp=Sf(lt);//\u540c\u4e0a\n        ans=(ans+(tmp-lstans)*S(fn)%mod*S(fm)%mod)%mod;\n        lstans=tmp;\n    }\n    cout<<(ans+mod)%mod<<endl;\n}\n```\n\n~~\u771f\u662f\u5feb\u4e50\u7684\u5361\u5e38\u6570\u9898~~",
        "postTime": 1556011274,
        "uid": 22136,
        "name": "qwaszx",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB\u3011"
    },
    {
        "content": "\u8fd9\u9898\u4ee3\u7801\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u77ed\uff01\uff08\u597d\u5427\u6570\u8bba\u9898\u90fd\u77ed\uff09\n\n\n\u603b\u4e4b\u5c31\u662f\u4e0d\u65ad\u63a8\u67ff\u5b50...\n\n### $[i,j]$ \u8868\u793a $i$ \u548c $j$ \u7684 $lcm$ \n\n### $(i,j)$ \u8868\u793a $i$ \u548c $j$ \u7684 $gcd$ \n\n### $[\\text{\u8868\u8fbe\u5f0f}]$ \u8868\u793a \u8868\u8fbe\u5f0f\u6210\u7acb\u65f6\u53d6 1  \uff0c\u5426\u5219\u4e3a 0  \n\n$\\sum$ \u7684\u8fb9\u754c\u9ed8\u8ba4\u4e0b\u53d6\u6574\uff0c\u5982 $\\sum_{i=1}^{n/d}$ \u4e2d\u7684 $n/d$ \u9ed8\u8ba4\u4e3a $\\lfloor \\dfrac{n}{d} \\rfloor$\n\n\u5e76\u4e14\u5f3a\u5236 $n$ \u5c0f\u4e8e $m$ \uff08\u8f93\u5165\u5927\u4e8e\u7684\u8bdd $swap$ \u4e00\u4e0b\u4e0d\u5f71\u54cd\u7b54\u6848\uff09\n\n\u7136\u540e\u4e0b\u9762\u7684\u8fc7\u7a0b\u4f1a\u63a8\u7684\u8f83\u6162\uff0c\u4e00\u8fb9\u521d\u5b66\u8005\u80fd\u770b\u61c2\uff08woc \u521d\u5b66\u6570\u8bba\u5207\u56fd\u7c4d\u9898...\uff09...\u5927\u4f6c\u5f53\u7136\u662f\u4e00\u76ee\u4e86\u7136\u54af\n\n$$ANS=\\sum_{i=1}^n\\sum_{j=1}^m[i,j]$$\n$$=\\sum_{i=1}^n\\sum_{j=1}^m\\dfrac{i\\times j}{(i,j)}$$\n$$=\\sum_{d=1}^n \\dfrac{1}{d}\\sum_{d|i}^n\\sum_{d|j}^m i\\times j[(i,j)=1]$$\n$$=\\sum_{d=1}^n \\dfrac{1}{d} \\times d^2\\sum_{i=1}^{n/d}\\sum_{j=1}^{m/d} i\\times j[(i,j)=1]$$\n\n$$=\\sum_{d=1}^n d\\sum_{i=1}^{n/d}\\sum_{j=1}^{m/d} i\\times j [(i,j)=1]$$\n>>\u53cd\u6f14\u4e00\u4e0b\uff0c\u5c06\u8868\u8fbe\u5f0f\u66ff\u6362\u6210 $\u03bc$\n$$=\\sum_{d=1}^n d\\sum_{i=1}^{n/d}\\sum_{j=1}^{m/d} i\\times j \\sum_{k|i,k|j}\\mu(k)$$\n\n\n$$=\\sum_{d=1}^n d\\sum_{k=1}^{n/d}\\mu(k)\\sum_{k|i}^{n/d}\\sum_{k|j}^{m/d} i\\times j $$\n\n\n$$=\\sum_{d=1}^n d\\sum_{k=1}^{n/d}\\mu(k)\\times k^2\\sum_{i=1}^{n/(kd)}\\sum_{j=1}^{m/(kd)} i\\times j $$\n$$=\\sum_{d=1}^n d\\sum_{k=1}^{n/d}\\mu(k)\\times k^2\\sum_{i=1}^{n/(kd)}\\sum_{j=1}^{m/(kd)} i\\times j $$\n\n>>\u6211\u4eec\u53d1\u73b0\u540e\u9762\u4e24\u4e2a $\\sum$ \u53ef\u4ee5 $O(1)$ \u7528\u516c\u5f0f\u8868\u793a\n\n$$=\\sum_{d=1}^n d\\sum_{k=1}^{n/d}\\mu(k)\\times k^2 \\times \\dfrac{ \\lfloor \\dfrac{n}{kd}\\rfloor \\times(\\lfloor \\dfrac{n}{kd}\\rfloor +1)}{2} \\times \\dfrac{ \\lfloor \\dfrac{m}{kd}\\rfloor \\times(\\lfloor \\dfrac{m}{kd}\\rfloor +1)}{2}  $$\n\n>>\u4e3a\u4e86\u8ba9\u8868\u8fbe\u5f0f\u6e05\u6670\u4e00\u70b9\uff0c\u6211\u4eec\u4ee4 $g(n)=\\dfrac{n\\times (n+1)}{2}$\uff0c\u7136\u540e\u7528 g \u5e26\u5165\u539f\u5f0f\n\n$$=\\sum_{d=1}^n d\\sum_{k=1}^{n/d}\\mu(k)\\times k^2 \\times g(\\lfloor\\dfrac{n}{kd}\\rfloor) \\times g(\\lfloor\\dfrac{m}{kd}\\rfloor)  $$\n\n\u90a3\u4e48\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u7684\u540e\u534a\u90e8\u5206\u53ef\u4ee5\u5355\u72ec\u62ce\u51fa\u6765\n\n\u5c31\u662f\u4ee4 $f(n)= \\sum_{k=1}^{n}\\mu(k)\\times k^2 \\times g(\\lfloor\\dfrac{n}{k}\\rfloor) \\times g(\\lfloor\\dfrac{m}{k}\\rfloor)$\n\n\u8fd9\u73a9\u610f\u513f\u53ef\u4ee5\u6570\u8bba\u5206\u5757\u89e3\uff0c$O(\\sqrt{n})$\u7684\u590d\u6742\u5ea6\n\n\u6c42\u51fa\u6765\u4e4b\u540e\u5e26\u5165\u8fdb\u539f\u5f0f\u5b50\u5c31\u662f\uff1a\n\n$$ANS=\\sum_{d=1}^nd\\times f(\\lfloor n/d\\rfloor)$$\n\n\u7136\u540e\u53d1\u73b0\u8fd9\u73a9\u610f\u513f\u8fd8\u662f\u53ef\u4ee5\u6570\u8bba\u5206\u5757\u89e3\uff0c$O(\\sqrt{n})$ \u7684\u590d\u6742\u5ea6\n\n\u7136\u540e\u968f\u4fbf\u53e3\u80e1\u4e00\u4e0b\u53d1\u73b0\u590d\u6742\u5ea6\u6ca1\u6bdb\u75c5\uff0c\u636e\u8bf4\u603b\u7684\u590d\u6742\u5ea6\u662f $O(n+m)$ \u5427\uff0c\u849f\u84bb\u4e0d\u4f1a\u63a8\uff0c\u5927\u4f6c\u6559\u6559\u6211...\n\n\n\n\n\u5f53\u7136\u8fd9\u4ee3\u7801\u91cc\u9762\u7684\u7ec6\u8282\u597d\u591a\u7684\u8bf4\uff08\u6bcf\u6b21\u505a\u8fd9\u79cd\u6570\u8bba\u9898\u6211\u90fd\u662f\u5c0f\u9519\u8bef\u9891\u53d1\uff09\n\n\n\u6240\u4ee5\u603b\u7ed3\u4e00\u4e0b\u6613\u9519\u70b9\uff08\u591a\u4ee5\u672c\u4eba\u4e3a\u53cd\u9762\u6559\u6750\uff0c\u5927\u4f6c\u4e0d\u559c\u52ff\u55b7\uff09\uff1a\n\n1. $ADD(a,b)$ \u4e2d\u7684 $b$ \u522b\u5fd8\u4e86\u53d6\u6a21\n\n2. \u6ce8\u610f\u7cbe\u5ea6\u4e0d\u80fd\u7206\uff0c\u6709\u4e8b\u6ca1\u4e8b\u52a0\u4e2a $1ll$\n\n3. \u6570\u8bba\u5206\u5757\u53f3\u533a\u95f4\u8d21\u732e\u51cf\u5de6\u533a\u95f4\u8d21\u732e\u522b\u5c31\u4e22\u4e2a\u5de6\uff08\u53f3\uff09\u533a\u95f4\u5728\u90a3\u513f\u5c31\u5b8c\u4e8b\u513f\n\n4. \u9884\u5904\u7406\u522b\u51fa\u9505\u4e0d\u7136\u5f97\u5b8c\n\n5. \u6709\u4e24\u4e2a\u53d8\u91cf\uff08$n$ \u548c $m$\uff09\u8f93\u5165\u8fdb\u6765\u7684\uff0c $r$ \u522b\u5fd8\u4e86\u5bf9 $n/(n/l)$ \u548c $m/(m/l)$ \u53d6 $Min$ \u800c\u4e0d\u662f\u76f4\u63a5\u8d4b\u6210 $n/(n/l)$ \n\n\u7b2c\u4e00\u4e2a\u603b\u662f\u4f1a\u72af...\u6240\u4ee5\u5199\u5b8c\u90a3\u4e00\u884c\u5c31\u5f97\u68c0\u67e5\u4e00\u4e0b\n\n\u7b2c\u4e8c\u4e2a\u4e0d\u600e\u4e48\u72af\u5427...\u611f\u89c9\u7cbe\u5ea6\u95ee\u9898\u81ea\u5df1\u8fd8\u662f\u4f1a\u7279\u522b\u5173\u6ce8\u7684\n\n\u7b2c\u4e09\u4e2a\u5c31\u662f\u72af\u4e8c\u4e86...\uff08 $I'm$ \u4e2d\u4e8c\u75c5\u60a3\u8005\u2192_\u2192 \u83ab\u540d\u9a84\u50b2...\uff09\n\n\u7b2c\u56db\u4e2a\u677f\u5b50\u719f\u7684\u8bdd\u4e0d\u4f1a\u6709\u6bdb\u75c5\u5427\u53cd\u6b63\u6211**\u76ee\u524d**\u8fd8\u6ca1\u51fa\u8fc7\u4e8b\u513f\n\n\n\u7b2c\u4e94\u4e2a\u53ef\u80fd\u662f\u675c\u6559\u7b5b\u6216\u8005\u8f93\u5165\u53ea\u6709\u4e00\u4e2a $n$  \u7684\u6570\u8bba\u9898\u6253\u591a\u4e86...\n\n\n\n```\n//by Judge\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int mod=20101009;\nconst int M=1e7+3; \ntypedef int arr[M];\nint n,m,cnt; arr v,p,mu;\ninline void prep(int n){ v[1]=mu[1]=1;\n\tfor(int i=2;i<=n;++i){ if(!v[i]) p[++cnt]=i,mu[i]=-1;\n\t\tfor(int j=1;j<=cnt&&i*p[j]<=n;++j){ v[i*p[j]]=1;\n\t\t\tif(!(i%p[j])) break; mu[i*p[j]]=-mu[i];\n\t\t} mu[i]=(mu[i-1]+1ll*mu[i]*i*i%mod+mod)%mod;\n\t}\n}\ninline void ADD(int& a,int b){a+=a+b>=mod?b-mod:b;}\ninline int sum1(int x){return 1ll*x*(x+1)/2%mod;}\ninline int Min(int a,int b){return a<b?a:b;}\ninline int calc(int n,int m){ int ans=0;\n\tfor(int l=1,r;l<=n;l=r+1) r=Min(n/(n/l),m/(m/l)),\n\t\tADD(ans,1ll*(mu[r]-mu[l-1]+mod)*sum1(n/l)%mod*sum1(m/l)%mod); return ans;\n}\nint main(){ cin>>n>>m; if(n>m) swap(n,m); prep(m); int ans=0;\n\tfor(int l=1,r;l<=n;l=r+1) r=Min(n/(n/l),m/(m/l)),\n\t\tADD(ans,1ll*(sum1(r)-sum1(l-1)+mod)*calc(n/l,m/l)%mod);\n\treturn !printf(\"%d\\n\",ans); \n}\n```\n",
        "postTime": 1552154385,
        "uid": 38576,
        "name": "J\u03bcdge",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB\u3011"
    },
    {
        "content": "### \u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n\n~~\u63a8\u5f0f\u5b50\u63a8\u6b7b\u6211\u4e86~~\n\n\n\u9996\u5148\uff0c\u539f\u9898\u8981\u6c42\uff1a\n\n\n$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m lcm(i,j)$\n\n\n\u7136\u540e\u5f00\u59cb\u5316\u5f0f\u5b50\u3002\n\n\n\n$ans=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m \\frac{ij}{\\gcd(i,j)}$\n\n\n$=\\sum\\limits_{d=1}^{\\min(n,m)}d\\sum\\limits_{i=1}^{n/d}\\sum\\limits_{j=1}^{m/d} ij[\\gcd(i,j)==1]$\n\n\n\n\u8bbe\n$f(x,d)=\\sum\\limits_{i=1}^{n/d}\\sum\\limits_{j=1}^{m/d}ij[gcd(i,j)==x]$\uff0c\n\n$g(x,d)=\\sum\\limits_{i=1}^{n/d}\\sum\\limits_{j=1}^{m/d}ij[gcd(i,j)|x]$\uff0c\u90a3\u4e48\n\n\n$f(1,D)=\\sum_{d=1}^{\\min(n/D,m/D)}\\mu(d)g(d)$\n\n\n$g(x,D)=x^2\\sum\\limits_{i=1}^{\\lfloor\\frac{n/D}{x}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{m/D}{x}\\rfloor}ij$\n\n\n\u6240\u4ee5\n\n$ans=\\sum_{D=1}^{\\min(n,m)}D\\sum\\limits_{d=1}^{\\min(n/D,m/D)}\\mu(d)d^2\\sum\\limits_{i=1}^{\\lfloor\\frac{n/D}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{m/D}{d}\\rfloor}ij$\n\n\n$=\\sum\\limits_{D=1}^{\\min(n,m)}D\\sum_{d=1}^{\\min(n/D,m/D)}\\mu(d)d^2\\frac{(1+\\lfloor\\frac{n/D}{d}\\rfloor)(1+\\lfloor\\frac{m/D}{d}\\rfloor)\\lfloor\\frac{n/D}{d}\\rfloor\\lfloor\\frac{m/D}{d}\\rfloor}{4}$\n\n\n\u8fd9\u6837\u76f4\u63a5\u7b97\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(n^2)$\uff0c\u5229\u7528\u6574\u9664\u5206\u5757\u4f18\u5316\u81f3$O(n\\sqrt{n})$\u3002\n\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#include<cctype>\n#define For(i,a,b) for(i=(a);i<=(b);++i)\n#define Forward(i,a,b) for(i=(a);i>=(b);--i)\n#define Rep(i,a,b) for(register int i=(a),i##end=(b);i<=i##end;++i)\n#define Repe(i,a,b) for(register int i=(a),i##end=(b);i>=i##end;--i)\nusing namespace std;\ntemplate<typename T>inline void read(T &x){\n    T s=0,f=1;char k=getchar();\n    while(!isdigit(k)&&k^'-')k=getchar();\n    if(!isdigit(k)){f=-1;k=getchar();}\n    while(isdigit(k)){s=s*10+(k^48);k=getchar();}\n    x=s*f;\n}\nvoid file(void){\n    #ifndef ONLINE_JUDGE\n    freopen(\"water.in\",\"r\",stdin);\n    freopen(\"water.out\",\"w\",stdout);\n    #endif\n}\nstatic int n,m;\nconst int mod=20101009ll;\nconst int MAXN=1e7+7;\nstatic int mu[MAXN];\nstatic int is[MAXN],pri[MAXN],e;\nvoid predone(int x)\n{\n    static int j;\n    Rep(i,2,x)\n    {\n        if(!is[i])pri[++e]=i,mu[i]=-1;\n        For(j,1,e)\n        {\n            if(i%pri[j]==0||i*pri[j]>x)break;\n            is[i*pri[j]]=true;\n            mu[i*pri[j]]=-mu[i];\n        }\n        if(i%pri[j]==0&&i*pri[j]<=x)\n            is[i*pri[j]]=true,mu[i*pri[j]]=0;\n    }\n    mu[1]=1;\n    Rep(i,1,x)mu[i]=(mu[i-1]+1ll*mu[i]*i*i%mod+mod)%mod;\n}\nvoid init()\n{\n    read(n);read(m);\n    predone(min(n,m));\n}\nstatic long long ans,sum;\ninline int power(int a,int b)\n{\n    static int sum;\n    for(sum=1;b;b>>=1,a=1ll*a*a%mod)if(b&1)\n        sum=1ll*sum*a%mod;\n    return sum;\n}\nvoid solve()\n{\n    static int j,last,N,M;\n    static int div4=power(4,mod-2);\n    Rep(i,1,min(n,m))\n    {\n        sum=0ll;\n        N=n/i;M=m/i;\n        for(j=1;j<=min(N,M);j=last+1)\n        {\n            last=min(N/(N/j),M/(M/j));\n            sum+=1ll*(mu[last]-mu[j-1])%mod\n                *(1+N/j)%mod*(1+M/j)%mod*(N/j)%mod*(M/j)%mod*div4%mod;\n            sum=(sum%mod+mod)%mod;\n        }\n        ans=(ans+sum*i%mod+mod)%mod;\n    }\n    printf(\"%lld\\n\",ans);\n}\nint main(void){\n    file();\n    init();\n    solve();\n    return 0;\n}\n```",
        "postTime": 1516521538,
        "uid": 7035,
        "name": "Great_Influence",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c\u3011"
    },
    {
        "content": "\u6211\u6709\u4e00\u79cd\u7384\u5b66\u590d\u6742\u5ea6\u7684\u505a\u6cd5\u3002\n\n\u7ea6\u5b9a\uff1a$[y]$ \u5f53 $y$ \u4e3a\u771f\u65f6\u4e3a $1$\uff0c\u5426\u5219\u4e3a $0$\u3002\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m \\frac{ij}{\\gcd(i,j)}$$\n\n$$=\\sum_d\\frac{1}{d}\\sum_{i=1}^n\\sum_{j=1}^mij[\\gcd(i,j)=d]$$\n\n$$=\\sum_dd\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}ij[\\gcd(i,j)=1]$$\n\n$$=\\sum_dd\\sum_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}ij\\sum_p\\mu(p)[p|i][p|j]$$\n\n$$=\\sum_dd\\sum_pp^2\\mu(p)\\sum_{i=1}^{\\lfloor\\frac{n}{dp}\\rfloor}\\sum_{j=1}^{\\lfloor\\frac{m}{dp}\\rfloor}ij$$\n\n\u4ee4 $T=dp$\uff0c$f(i,j)=\\sum_{x=1}^i\\sum_{y=1}^jxy=\\frac{x(x+1)y(y+1)}{4}$\uff0c\u539f\u5f0f\n\n$$=\\sum_TTf(\\lfloor\\frac{n}{T}\\rfloor,\\lfloor\\frac{m}{T}\\rfloor)\\sum_{p|T}p\\mu(p)$$\n\n\u5230\u8fd9\u91cc\u5c31\u53ef\u4ee5\u505a\u4e86\uff08\u540e\u9762\u90a3\u4e00\u5768\u53ef\u4ee5\u7b5b\u51fa\u6765\uff09\u3002\u7531\u4e8e\u5355\u7ec4\u8be2\u95ee\uff0c\u56e0\u6b64\u4e0d\u7528\u6574\u9664\u5206\u5757\u3002\n\n\u4f46\u662f\u76f4\u63a5\u7b5b\u662f $O(n\\log n)$ \u7684\uff0c\u4f1a T\u3002\u52a0\u4e0a\u4e00\u4e2a\u4f18\u5316\uff1a\u82e5 $\\mu(i)=0$\uff0c\u5219\u76f4\u63a5\u8df3\u8fc7 $i$\uff0c\u5c31\u80fd\u8fc7\u4e86\u3002\u4f46\u8dd1\u5f97\u5f88\u6162\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define MaxN 10000005\n#define mod 20101009\nusing namespace std;\nint miu[MaxN],prime[MaxN],vst[MaxN];\nlong long f[MaxN];\nvoid Mobius(int n){\n\tmiu[1]=1;\n\tfor(int i=2;i<=n;i++){\n\t\tif(!vst[i]){\n\t\t\tprime[++prime[0]]=i;\n\t\t\tmiu[i]=-1;\n\t\t}\n\t\tfor(int j=1;j<=prime[0]&&i*prime[j]<=n;j++){\n\t\t\tvst[i*prime[j]]=1;\n\t\t\tif(i%prime[j])miu[i*prime[j]]=-miu[i];\n\t\t\telse {\n\t\t\t\tmiu[i*prime[j]]=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tif(!miu[i])continue;\n\t\tfor(int j=i;j<=n;j+=i)f[j]+=miu[i]*i;\n\t}\n\tfor(int i=1;i<=n;i++)f[i]=(f[i]%mod+mod)%mod;\n}\nlong long F(int x,int y){\n\treturn 1ll*x*(x+1)%mod*((mod+1)/2)%mod*y%mod*(y+1)%mod*((mod+1)/2)%mod;\n}\nint main(){\n\tMobius(10000000);\n\tint n,m,sum=0;\n\tcin>>n>>m;\n\tfor(int i=1;i<=min(n,m);i++)sum=(sum+1ll*i*f[i]%mod*F(n/i,m/i)%mod)%mod;\n\tcout<<sum<<endl;\n    return 0;\n}\n```",
        "postTime": 1580460641,
        "uid": 42156,
        "name": "feecle6418",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB\u3011"
    },
    {
        "content": "\u6709\u70b9\u96be\u5ea6\u7684\u9898\u76ee\u3002\n\n\u4e00\u773c\u770b\u5230 $\\gcd(i,j)$ \u5c31\u7528\u4e86 $\\phi$ , \u7ed3\u679c\u6b7b\u4e86\u3002\n\n\u7528\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u5957\u8fdb\u53bb\u641e\u4e00\u641e\u5148 : \n\n$$\\begin{aligned}  & \\sum\\limits^n_{i=1} \\sum\\limits^m_{j=1} \\text{lcm}(i,j) \\\\ = &\\sum\\limits^n_{i=1} \\sum\\limits^m_{j=1} \\frac {ij}{\\gcd(i,j)} \\\\ = & \\sum\\limits^{\\min\\{n,m\\}}_{k=1} \\sum\\limits^n_{i=1} \\sum\\limits^m_{j=1} \\frac{ij}{k} [\\gcd(i,j)=k] \\\\ = & \\sum\\limits^{\\min\\{n,m\\}}_{k=1} \\sum\\limits^{\\left\\lfloor \\frac n k \\right\\rfloor}_{i=1} \\sum\\limits^{\\left\\lfloor \\frac m k \\right\\rfloor}_{j=1} \\frac{(ik)(jk)}{k} [\\gcd(i,j)=1] \\\\ = & \\sum\\limits^{\\min\\{n,m\\}}_{k=1} \\sum\\limits^{\\left\\lfloor \\frac n k \\right\\rfloor}_{i=1} \\sum\\limits^{\\left\\lfloor \\frac m k \\right\\rfloor}_{j=1} ijk \\sum\\limits_{d|\\gcd(i,j)}\\mu(d) \\\\ = & \\sum\\limits^{\\min\\{n,m\\}}_{k=1} \\sum\\limits^{\\min\\{\\left\\lfloor \\frac n k \\right\\rfloor,\\left\\lfloor \\frac m k \\right\\rfloor\\}}_{d=1}  \\mu(d) \\sum\\limits^{\\left\\lfloor \\frac n k \\right\\rfloor}_{i=1} \\sum\\limits^{\\left\\lfloor \\frac m k \\right\\rfloor}_{j=1} ijk [d|i] [d|j] \\\\ = & \\sum\\limits^{\\min\\{n,m\\}}_{k=1} \\sum\\limits^{\\min\\{\\left\\lfloor \\frac n k \\right\\rfloor,\\left\\lfloor \\frac m k \\right\\rfloor\\}}_{d=1} \\mu(d) \\sum\\limits^{\\left\\lfloor \\frac n {kd} \\right\\rfloor}_{i=1} \\sum\\limits^{\\left\\lfloor \\frac m {kd} \\right\\rfloor}_{j=1} ijkd^2  \\\\ = & \\sum\\limits^{\\min\\{n,m\\}}_{k=1} k \\sum\\limits^{\\min\\{\\left\\lfloor \\frac n k \\right\\rfloor,\\left\\lfloor \\frac m k \\right\\rfloor\\}}_{d=1} d^2\\mu(d)  \\left( \\sum\\limits^{\\left\\lfloor \\frac n {kd} \\right\\rfloor}_{i=1} i \\right)  \\left( \\sum\\limits^{\\left\\lfloor \\frac m {kd} \\right\\rfloor}_{j=1} j \\right) \\\\ = & \\sum\\limits^{\\min\\{n,m\\}}_{T=1} \\left( \\sum\\limits^{\\left\\lfloor \\frac n T \\right\\rfloor}_{i=1} i \\right)  \\left( \\sum\\limits^{\\left\\lfloor \\frac m T \\right\\rfloor}_{j=1} j \\right) \\sum\\limits_{d|T} d^2\\mu(d) \\frac{T}{d} \\\\ = & \\sum\\limits^{\\min\\{n,m\\}}_{T=1} T \\left( \\sum\\limits^{\\left\\lfloor \\frac n T \\right\\rfloor}_{i=1} i \\right)  \\left( \\sum\\limits^{\\left\\lfloor \\frac m T \\right\\rfloor}_{j=1} j \\right) \\sum\\limits_{d|T} d\\mu(d) \\end{aligned}$$\n\n\u6211\u4eec\u53d1\u73b0\u5982\u679c $T\\sum\\limits_{d|T} d\\mu(d)$ \u53ef\u4ee5\u8fdb\u884c\u9884\u5904\u7406\u7684\u8bdd\u90a3\u4e48\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u662f $O(n^{\\frac{1}{2}})$ \u7684\u3002\n\n\u6211\u4eec\u8bbe $\\text F(T)=\\sum\\limits_{d|T} d\\mu(d)$ , \u662f\u4e00\u4e2a\u79ef\u6027\u51fd\u6570 : $\\mu$ \u662f\u79ef\u6027\u51fd\u6570 , $\\sum\\limits_{d|T}=\\sum\\limits_{x|T,y|T,x \\perp y} xy$ , \u5f97\u8bc1\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u77e5\u9053 $\\text F(Tp)=\\text F(T) \\times \\text F(p)$ ( $p \\in prime$ ) \u3002\u6211\u4eec\u53c8\u53ef\u4ee5\u77e5\u9053 $\\text F(p)=1+(-p)=1-p$ , \u6ce8\u610f\u5230\u8fd9\u4e2a\u6709\u8d28\u6570\u8d21\u732e\u7684\u5bfc\u5411 , \u6240\u4ee5\u53ef\u4ee5\u6b27\u62c9\u7b5b\u3002\n\n\u6700\u540e\u8bb0\u5f97\u628a $T$ \u4e58\u8fdb\u53bb\u5e76\u4e14\u53d6\u524d\u7f00\u548c\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n+n^{\\frac{1}{2}})$\u3002\n\n```pascal\nUses math;\n\nConst\n    total=10000000+10;\n    modn=20101009;\n\nvar\n    isprime:array[-1..total] of boolean;\n    prime:array[-1..total] of longint;\n    incea:array[-1..total] of int64;\n    i,j,n,m:longint;\n    ans:int64;\n\nfunction Square(n:longint):longint; begin exit(n*(n+1) >> 1 mod modn); end;\n\nprocedure Incea_make(total:longint);\nvar i,j,k,tail:longint;\nbegin\n   incea[1]:=1; tail:=0;\n   for i:=2 to total do\n   begin\n        if isprime[i]=False then begin inc(tail); prime[tail]:=i; incea[i]:=1-i; end;\n        for j:=1 to tail do\n        begin\n            if prime[j]*i>total then break;\n            isprime[prime[j]*i]:=True;\n            if (i mod prime[j]=0) then begin incea[prime[j]*i]:=incea[i] mod modn; break; end\n            else incea[prime[j]*i]:=incea[i]*incea[prime[j]] mod modn;\n        end;\n   end;\n   for i:=1 to total do incea[i]:=(incea[i]*i mod modn+incea[i-1]) mod modn;\nend;\n\nbegin\n    read(n,m); Incea_make(max(m,n)+1);\n    i:=1; j:=0;\n    repeat\n        j:=min(n div (n div i),m div (m div i));\n        inc(ans,(Square(n div i)*Square(m div i) mod modn)*(incea[j]-incea[i-1]) mod modn);\n        ans:=ans mod modn; i:=j+1;\n    until i>min(n,m);\n    writeln((ans+modn) mod modn);\nend.\n```\n\n**\u5751\u70b9 : \u6700\u540e\u8bb0\u5f97 $(ans+modn) \\mod modn$ !! \u4e0d\u7136\u7206\u8d1f\u6570**",
        "postTime": 1573210430,
        "uid": 77760,
        "name": "arfa",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB\u3011"
    },
    {
        "content": "$$\\sum_{i=1}^n\\sum_{j=1}^mlcm(i,j)$$\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\frac{i*j}{gcd(i,j)}$$\n\n$$\\sum_{d=1}^{min(n,m)}\\sum_{i=1}^n\\sum_{j=1}^m [gcd(i,j)=d] * \\frac{i*j}{d}$$\n\n$$\\sum_{d=1}^{min(n,m)}\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor}[gcd(i,j)=1]*i*j*d$$\n\n$$\\sum_{d=1}^{min(n,m)}\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor}\\sum_{k|gcd(i,j)}\\mu(k)*i*j*d$$\n\n$$\\sum_{d=1}^{min(n,m)}\\sum_{k=1}^{min(\\lfloor \\frac{n}{d} \\rfloor,\\lfloor \\frac{m}{d} \\rfloor)}\\mu(k)*k^2*d\\sum_{i=1}^{\\lfloor \\frac{n}{dk} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{m}{dk} \\rfloor}i*j$$\n\n$$\\sum_{d=1}^{min(n,m)}d\\sum_{k=1}^{min(\\lfloor \\frac{n}{d} \\rfloor,\\lfloor \\frac{m}{d} \\rfloor)}\\mu(k)*k^2*(\\frac{\\lfloor \\frac{n}{dk} \\rfloor*(\\lfloor \\frac{n}{dk} \\rfloor+1)*\\lfloor \\frac{m}{dk} \\rfloor*(\\lfloor \\frac{m}{dk} \\rfloor+1)}{4})$$\n\n\u5185\u5916\u8fdb\u884c\u4e24\u6b21\u6570\u8bba\u5206\u5757\uff0c\u53ef\u4ee5\u505a\u5230$\\Theta(\\sqrt n * \\sqrt n~)=\\Theta(n)$\u6c42\u89e3\n\n```cpp\n#include <cstdio>\n#include <iostream>\nusing namespace std;\n#define Mod 20101009\n\nconst int MAXN = 10000000;\nint n , m , f[ MAXN + 5 ];\n\nint k , prime[ MAXN + 5 ] , mu[ MAXN + 5 ];\nbool vis[ MAXN + 5 ];\nvoid sieve( ) {\n    mu[ 1 ] = 1;\n\tfor( int i = 2 ; i <= MAXN ; i ++ ) {\n\t\tif( !vis[ i ] ) {\n\t\t\tprime[ ++ k ] = i;\n\t\t\tmu[ i ] = -1;\n\t\t}\n\t\tfor( int j = 1 ; j <= k && 1ll * i * prime[ j ] <= MAXN ; j ++ ) {\n\t\t\tvis[ i * prime[ j ] ] = 1;\n\t\t\tif( i % prime[ j ] == 0 ) break;\n            mu[ i * prime[ j ] ] = -mu[ i ];\n\t\t}\n\t}\n    for( int i = 1 ; i <= MAXN ; i ++ )\n        f[ i ] = ( f[ i - 1 ] + 1ll * mu[ i ] % Mod * i % Mod * i % Mod ) % Mod;\n}\n\nint Quick_pow( int x , int po ) {\n    int Ans = 1;\n    while( po ) {\n        if( po % 2 )\n            Ans = 1ll * Ans * x % Mod;\n        x = 1ll * x * x % Mod;\n        po /= 2;\n    }\n    return Ans;\n}\nint inv( int x ) {\n    return Quick_pow( x , Mod - 2 );\n}\n\nint Get( int n1 , int m1 ) {\n    int d1 = min( n1 , m1 ) , Ans = 0;\n    for( int l = 1 , r ; l <= d1 ; l = r + 1 ) {\n        r = min( n1 / ( n1 / l ) , m1 / ( m1 / l ) );\n        Ans = ( Ans + 1ll * ( f[ r ] - f[ l - 1 ] + Mod ) % Mod * ( 1ll * ( n1 / l ) * ( n1 / l + 1 ) % Mod * ( m1 / l ) % Mod * ( m1 / l + 1 ) % Mod ) % Mod * inv( 4 ) % Mod ) % Mod;\n    }\n    return Ans;\n}\nint solve( int n , int m ) {\n    int Ans = 0 , d = min( n , m );\n    for( int l = 1 , r ; l <= d ; l = r + 1 ) {\n        r = min( n / ( n / l ) , m / ( m / l ) );\n        Ans = ( Ans + 1ll * Get( n / l , m / l ) * ( l + r ) * ( r - l + 1 ) / 2 ) % Mod;\n    }\n    return Ans;\n}\n\nint main( ) {\n    sieve( );\n    scanf(\"%d %d\",&n,&m);\n    printf(\"%d\\n\",solve( n , m ));\n    return 0;\n}\n```\n",
        "postTime": 1572674671,
        "uid": 123802,
        "name": "chihik",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB\u3011"
    },
    {
        "content": "### \u9898\u76ee\u63cf\u8ff0\n\u6c42(\u5bf9 $20101009$ \u53d6\u6a21\uff0c$n,m\\le10^7$ )\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\operatorname{lcm}(i,j)$$\n\n----\n### \u5927\u4f53\u601d\u8def\n\u76f4\u63a5\u4e0a\u6765\u63a8\u5f0f\u5b50\u3002\u3002\u3002  \n\uff08\u56e0\u4e3a\u4e0d\u80fd\u7528aligned\u6240\u4ee5\u5199\u7684\u4e0d\u592a\u597d\u770b\u3002\u3002\u3002\uff09\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\operatorname{lcm}(i,j)$$\n$$=\\sum_{i=1}^n\\sum_{j=1}^m\\frac{i\\times j}{\\gcd(i,j)}$$\n$$=\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{d|\\gcd(i,j)}\\frac{i\\times j}{d}$$\n$$=\\sum_{d=1}^{\\min(n,m)}\\times d\\times\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor}[\\gcd(i,j)=1]\\times i\\times j$$\n\u628a\u5f0f\u5b50\u540e\u9762\u90a3\u4e00\u5927\u5806\u8bbe\u4e3a $sum(n,m)$ \uff1a\n$$sum(n,m)=\\sum_{i=1}^n\\sum_{j=1}^m[\\gcd(i,j)=1]\\times i\\times j$$\n\u8003\u8651\u5316\u7b80\u4e00\u4e0b $sum$ :\n$$sum(n,m) = \\sum_{i=1}^n\\sum_{j=1}^m[\\gcd(i,j)=1]\\times i\\times j$$\n$$=\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{d|\\gcd(i,j)}\\mu(d)\\times i\\times j$$\n$$=\\sum_{d=1}^{\\min(n,m)}\\mu(d)\\times d^2\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor}i\\times j$$\n\u53ef\u4ee5\u53d1\u73b0 $sum$ \u540e\u9762\u90a3\u4e00\u5927\u5806(\u8bbe\u4e3a $g(n,m)$ )\u53ef\u4ee5 $O(1)$ \u6c42\uff1a\n$$g(n,m)=\\sum_{i=1}^n\\sum_{j=1}^m i\\times j$$\n$$=\\frac{n\\times(n+1)}{2}\\times \\frac{m\\times(m+1)}{2}$$\n\u90a3\u4e48 $sum(n,m)$ \u53ef\u4ee5\u5316\u4e3a\uff1a\n$$sum(n,m)=\\sum_{d=1}^{\\min(n,m)}\\mu(d)\\times d^2\\times g(\\lfloor\\frac{n}{d}\\rfloor,\\lfloor\\frac{m}{d}\\rfloor)$$\n\u8fd9\u4e2a\u53ef\u4ee5\u6570\u8bba\u5206\u5757 $\\lfloor\\frac{n}{\\lfloor\\frac{n}{d}\\rfloor}\\rfloor$ \u6c42\u3002  \n\u518d\u56de\u5230\u5b9a\u4e49 $sum$ \u7684\u5730\u65b9\uff0c\u90a3\u4e48\uff1a\n$$Ans=\\sum_{d=1}^{\\min(n,m)}\\times d\\times sum(\\lfloor\\frac{n}{d}\\rfloor,\\lfloor\\frac{m}{d}\\rfloor)$$\n\u597d\u50cf\u8fd9\u4e2a\u8fd8\u662f\u53ef\u4ee5\u6570\u8bba\u5206\u5757 $QwQ$  \n\u81f3\u6b64\u8fd9\u9053\u9898\u5c31\u89e3\u51b3\u4e86\u3002\n\n----\n### \u7ec6\u8282\u6ce8\u610f\u4e8b\u9879\n+ $long\\ long$\u4e00\u5b9a\u8981\u5f00\u5440\u3002\n+ \u4e0d\u8981\u5199\u6302\u5440\uff01\uff01\uff01\n\n----\n### \u53c2\u8003\u4ee3\u7801\n```cpp\n/*--------------------------------\n  Code name: crash.cpp\n  Author: The Ace Bee\n  This code is made by The Ace Bee\n--------------------------------*/\n#include <cstdio>\n#define rg register\n#define int long long \n#define fileopen(x)\t\t\t\t\t\t\t\t\\\n\tfreopen(x\".in\", \"r\", stdin);\t\t\t\t\\\n\tfreopen(x\".out\", \"w\", stdout);\n#define fileclose\t\t\t\t\t\t\t\t\\\n\tfclose(stdin);\t\t\t\t\t\t\t\t\\\n\tfclose(stdout);\nconst int mod = 20101009;\nconst int MAXN = 10000010;\ninline int min(int a, int b) { return a < b ? a : b; }\ninline int read() {\n\tint s = 0; bool f = false; char c = getchar();\n\twhile (c < '0' || c > '9') f |= (c == '-'), c = getchar();\n\twhile (c >= '0' && c <= '9') s = (s << 3) + (s << 1) + (c ^ 48), c = getchar();\n\treturn f ? -s : s;\n}\nint vis[MAXN], mu[MAXN];\nint num, pri[MAXN], sum[MAXN];\ninline void seive() {\n\tmu[1] = 1;\n\tfor (rg int i = 2; i < MAXN; ++i) {\n\t\tif (!vis[i]) mu[i] = -1, pri[++num] = i;\n\t\tfor (rg int j = 1; j <= num && i * pri[j] < MAXN; ++j) {\n\t\t\tvis[i * pri[j]] = 1;\n\t\t\tif (i % pri[j]) mu[i * pri[j]] = - mu[i];\n\t\t\telse { mu[i * pri[j]] = 0; break; }\n\t\t}\n\t}\n\tfor (rg int i = 1; i < MAXN; ++i)\n\t\tsum[i] = (sum[i - 1] + 1ll * i * i % mod * (mu[i] + mod) % mod) % mod;\n}\ninline int g(int n, int m)\n{ return 1ll * n * (n + 1) / 2 % mod * (m * (m + 1) / 2 % mod) % mod; }\ninline int f(int n, int m) {\n\tint res = 0;\n\tfor (rg int i = 1, j; i <= min(n, m); i = j + 1) {\n\t\tj = min(n / (n / i), m / (m / i));\n\t\tres = (res + 1ll * (sum[j] - sum[i - 1] + mod) * g(n / i, m / i) % mod) % mod;\n\t}\n\treturn res;\n}\ninline int solve(int n, int m) {\n\tint res = 0;\n\tfor (rg int i = 1, j; i <= min(n, m); i = j + 1) {\n\t\tj = min(n / (n / i), m / (m / i));\n\t\tres = (res + 1ll * (j - i + 1) * (i + j) / 2 % mod * f(n / i, m / i) % mod) % mod;\n\t}\n\treturn res;\n}\nsigned main() {\n//\tfileopen(\"crash\");\n\tseive();\n\tint n = read(), m = read();\n\tprintf(\"%lld\\n\", solve(n, m));\n//\tfileclose;\n\treturn 0;\n}\n\n```\n**\u5b8c\u7ed3\u6492\u82b1$qwq$**",
        "postTime": 1564616742,
        "uid": 87839,
        "name": "Sangber",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB\u3011"
    },
    {
        "content": "[\u5b89\u5229blog](https://ctz45562.github.io/2019/07/10/\u6d1b\u8c37-P1829-\u56fd\u5bb6\u96c6\u8bad\u961f-Crash\u7684\u6570\u5b57\u8868\u683c/)\n\n[\u4f20\u9001\u95e8](https://www.luogu.org/problemnew/show/P1829)\n\n\u5c0f\u5b66\u6570\u8bba\u77e5\u8bc6\uff1a$lcm(i,j)=\\dfrac{ij}{gcd(i,j)}$\n\n\u4ee5\u4e0b\u89c4\u5b9a$n<m$\u3002\n\n$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^mlcm(i,j)$\n\n$=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\dfrac{ij}{gcd(i,j)}$\n\n\u5957\u8def\u679a\u4e3e$gcd$\uff1a\n\n$=\\sum\\limits_{d=1}^n\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m\\dfrac{ij[gcd(i,j)=d]}{d}$\n\n\u5957\u8def\u679a\u4e3e$d$\u7684\u500d\u6570\uff1a\n\n$=\\sum\\limits_{d=1}^n\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}ijd[gcd(i,j)=1]$\n\n$=\\sum\\limits_{d=1}^n\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}ijd\\sum\\limits_{a|gcd(i,j)}\\mu(a)$\n\n$=\\sum\\limits_{d=1}^nd\\sum\\limits_{a=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(a)\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\sum\\limits_{j=1}^{\\lfloor\\frac{m}{d}\\rfloor}ij[a|i][a|j]$\n\n\u5957\u8def\u679a\u4e3e$a$\u7684\u500d\u6570\uff1a\n\n$=\\sum\\limits_{d=1}^nd\\sum\\limits_{a=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(a)\\sum\\limits_{i=1}^{\\frac{\\lfloor\\frac{n}{d}\\rfloor}{a}}ia\\sum\\limits_{j=1}^{\\frac{\\lfloor\\frac{m}{d}\\rfloor}{a}}ja$\n\n$=\\sum\\limits_{d=1}^nd\\sum\\limits_{a=1}^{\\lfloor\\frac{n}{d}\\rfloor}\\mu(a)a^2\\sum\\limits_{i=1}^{\\frac{\\lfloor\\frac{n}{d}\\rfloor}{a}}i\\sum\\limits_{j=1}^{\\frac{\\lfloor\\frac{m}{d}\\rfloor}{a}}j$\n\n\u8bbe$g(n)=\\sum\\limits_{i=1}^ni$\uff08\u5c31\u662f\u81ea\u7136\u6570\u524d$n$\u9879\u548c\uff09,$f(n,m)=\\sum\\limits_{i=1}^n\\mu(i)i^2g(\\lfloor\\dfrac{n}{i}\\rfloor)g(\\lfloor\\dfrac{m}{i}\\rfloor)$\n\n\u8fd9\u4e2a$f(n,m)$\u663e\u7136\u53ef\u4ee5\u9884\u5904\u7406$\\mu(i)i^2$\u540e\u6574\u9664\u5206\u5757\u3002\n\n\u6211\u4eec\u6c42\u7684\u5c31\u6210\u4e86$\\sum\\limits_{d=1}^ndf(\\lfloor\\dfrac{n}{d}\\rfloor,\\lfloor\\dfrac{m}{d}\\rfloor)$\n\n\u53c8\u53ef\u4ee5\u6574\u9664\u5206\u5757\u4e86\u3002\n\n\u6574\u9664\u5206\u5757\u5957\u6574\u9664\u5206\u5757\u590d\u6742\u5ea6\u662f$O(n^{\\frac{3}{4}})$\u7684\u3002\n\n\u7136\u540e\u53d1\u73b0\u4e86\u4e00\u4e2a\u6709\u8da3\u7684\u4e1c\u897f\uff1a\n\n\u66b4\u529b\u8ba1\u7b97$f(n,m)$\u662f$O(n)$\u7684\u3002\n\n\u8bbe$F(n)$\u4e3a$\\lfloor\\dfrac{n}{i}\\rfloor(i\\le n)$\u6240\u6709\u4e0d\u540c\u53d6\u503c\u7684\u548c\uff0c\u5b83\u8fd1\u4f3c\u4e8e\u5728$f(n,m)$\u4e0d\u6574\u9664\u5206\u5757\u65f6\u7684\u6574\u4e2a\u7b97\u6cd5\u590d\u6742\u5ea6\u3002\n\n\u7ecf\u8fc7\u8ba1\u7b97\u5728$F(1e7)\\approx 9e7$\u3002\u8bd5\u7740\u6539\u4e86\u4e00\u4e0b\u4e0d\u5438\u6c27\u5c31\u8fc7\u4e86\u3002\u3002\u3002\n\n\u4ee3\u7801\uff1a\n\n``` cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cmath>\n#include <cstring>\n\n#define maxn 10000001\n#define inf 0x3f3f3f3f\n\nconst int mod = 20101009;\n\nusing namespace std;\n\ninline int read(){\n    int x=0,y=0;\n    char ch=getchar();\n    while(ch<'0'||ch>'9'){if(ch=='-')y=1;ch=getchar();}\n    while(ch>='0'&&ch<='9')x=(x<<1)+(x<<3)+(ch^48),ch=getchar();\n    return y?-x:x;\n}\nint mu[maxn],sum[maxn],psum[maxn],prime[maxn>>3],cnt;\nbool is[maxn];\ninline int f(int n,int m){\n    if(n>m)swap(n,m);\n    int ans=0;\n    for(register int l=1,r;l<=n;l=r+1){\n        r=min(n,min(n/(n/l),m/(m/l)));\n        (ans+=1ll*(psum[r]-psum[l-1])*sum[n/l]%mod*sum[m/l]%mod)%=mod;\n    }\n    return ans;\n}\nint main(){\n    mu[1]=is[1]=sum[1]=psum[1]=1;\n    for(register int i=2;i<maxn;++i){\n        if(!is[i])prime[++cnt]=i,mu[i]=-1;\n        sum[i]=(sum[i-1]+i)%mod,psum[i]=(psum[i-1]+1ll*i*i*mu[i]%mod)%mod;\n        for(register int j=1;j<=cnt&&i*prime[j]<maxn;++j){\n            is[i*prime[j]]=1;\n            if(i%prime[j]==0){mu[i*prime[j]]=0;break;}\n            mu[i*prime[j]]=-mu[i];\n        }\n    }\n    int n=read(),m=read(),ans=0;\n    if(n>m)swap(n,m);\n    for(register int l=1,r;l<=n;l=r+1){\n        r=min(n,min(n/(n/l),m/(m/l)));\n        (ans+=1ll*(sum[r]-sum[l-1])*f(n/l,m/l)%mod)%=mod;\t\n    }\n    printf(\"%d\\n\",(ans+mod)%mod);\n}\n```\n\n",
        "postTime": 1562750430,
        "uid": 111762,
        "name": "_ctz",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB\u3011"
    },
    {
        "content": "# P1829 [\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB     \n\n## \u9898\u76ee\u5927\u610f    \n\u6c42 $\\sum_{i=1}^{n}\\sum_{j=1}^{m}lcm(i,j)$     \n\n## \u9898\u89e3    \n\u8fd8\u662f\u63a8\u67ff\u5b50\u554a    \n\u9996\u5148\u4e3a\u4e86\u65b9\u4fbf\u6211\u4eec\u8bbe $n<m$\n$$\\sum_{i=1}^{n}\\sum_{j=1}^{m}lcm(i,j)$$      \n$$\\sum_{i=1}^{n}\\sum_{j=1}^{m} (\\frac{i \u00d7 j}{gcd(i,j)})$$     \n$$\\sum_{d=1}^{d=n}\\sum_{i=1}^{n}\\sum_{j=1}^{m} (\\frac{i \u00d7 j}{[gcd(i,j)==d]\u00d7d})$$    \n$$\\sum_{d=1}^{d=n}~d~\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor} (\\frac{i \u00d7 j}{[gcd(i,j)==1]})$$      \n$$\\sum_{d=1}^{d=n}~d~\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor} (\\frac{i \u00d7 j}{[gcd(i,j)==1]})$$   \n\u56e0\u4e3a\u6211\u4eec $[gcd(i,j)==1]$ \u662f\u53ef\u4ee5\u7ffb\u5230\u4e0a\u9762\u7684\uff0c\u4e0d\u5f71\u54cd \u3002   \n\u6240\u4ee5    \n$$\\sum_{d=1}^{d=n}~d~\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor} ({i \u00d7 j} \u00d7{[gcd(i,j)==1]})$$     \n\n$$\\sum_{d=1}^{d=n}~d~\\sum_{i=1}^{\\lfloor \\frac{n}{d} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{m}{d} \\rfloor} ({i \u00d7 j} \u00d7\\sum_{k|i,k|j}\\mu(k))$$     \n$$\\sum_{d=1}^{d=n}~d~\\sum_{k=1}^{\\lfloor \\frac{n}{d} \\rfloor}\\mu(k)\u00d7k^2\u00d7\\sum_{i=1}^{\\lfloor \\frac{n}{dk} \\rfloor}\\sum_{j=1}^{\\lfloor \\frac{m}{dk} \\rfloor} ({i \u00d7 j} )$$   \n\n\u5bf9\u4e8e\u524d\u9762\u4e00\u90e8\u5206\u6211\u4eec\u663e\u7136\u53ef\u4ee5\u6570\u8bba\u5206\u5757\uff0c\u5bf9\u4e8e\u540e\u9762\u5462\u4e00\u5757\u6211\u4eec\u4e5f\u662f\u53ef\u4ee5\u6570\u8bba\u5206\u5757\u7684 \u3002   \n\u6700\u540e\u6211\u4eec\u5206\u5757\u5957\u5206\u5757  \u3002   \n\u590d\u6742\u5ea6 $O(n)$  \n\n* $\\frak{Code}$   \n\n```cpp\n\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst ll mod=20101009;\nconst ll maxn=1e7+10;\nll np[maxn],pr[maxn],num,mu[maxn],S[maxn];\nll n,m;\nvoid init() {\n\tmu[1]=1;\n\tfor(ll i=2;i<maxn;++i) {\n\t\tif(!np[i]) pr[++num]=i,mu[i]=-1;\n\t\tfor(ll j=1;j<=num;++j) {\n\t\t\tif(i*pr[j]>=maxn) break ;\n\t\t\tnp[i*pr[j]]=1;\n\t\t\tif(i%pr[j]==0) {\n\t\t\t\tmu[i*pr[j]]=0;\n\t\t\t\tbreak ;\n\t\t\t}\n\t\t\tmu[i*pr[j]]=-mu[i];\n\t\t}\n\t}\n\tfor(ll i=1;i<maxn;++i) {\n\t\tS[i]=(S[i-1]+(mu[i]*i+mod)%mod*i%mod)%mod;\n\t}\n}\n\nll get(ll n,ll m) {\n\treturn (n*(n+1)/2)%mod*(m*(m+1)/2%mod)%mod;\n}\n\nll so(ll x,ll y) {\n\tll ans=0;\n\tfor(ll l=1,r;l<=x;l=r+1) {\n\t\tr=min(x/(x/l),y/(y/l));\n\t\tans=(ans+(S[r]-S[l-1]+mod)%mod*get(x/l,y/l)%mod)%mod;\n\t}\n\treturn ans;\n}\n\nll wo() \n{\n\tll ans=0;\n\tfor(ll l=1,r;l<=n;l=r+1) {\n\t\tr=min((n/(n/l)),m/(m/l));\n\t\tans=(ans+(l+r)*(r-l+1)/2%mod*(so(n/l,m/l))%mod)%mod;\n\t}\n\treturn ans;\n}\n\nint main() \n{\n\tinit();\n\tscanf(\"%lld%lld\",&n,&m);\n\tif(n>m) swap(n,m);\n\tcout<<wo()<<\"\\n\";\n\treturn 0;\n}\n\n\n```",
        "postTime": 1556092255,
        "uid": 102786,
        "name": "Sym_Je",
        "ccfLevel": 0,
        "title": "P1829 [\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB"
    },
    {
        "content": "\u849f\u84bb\u535a\u5ba2\uff1a[\u6233\u6211\u83b7\u5f97\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8cw](https://www.cnblogs.com/GoldenPotato/p/10312872.html)\n\n---\n# Solution\n\n~~\u8c03\u5230\u81ea\u95ed\uff0c\u6211\u597d\u83dc\u554a~~\n\n**\u4e3a\u4e86\u65b9\u4fbf\u8ba8\u8bba\uff0c\u4ee5\u4e0b\u5f0f\u5b50$m>=n$**\n\n**\u4e3a\u4e86\u65b9\u4fbf\u4e66\u5199\uff0c\u4ee5\u4e0b\u5f0f\u5b50\u4e2d\u7684\u9664\u53f7\u5747\u4e3a\u5411\u4e0b\u53d6\u6574**\n\n\u6211\u4eec\u6765\u9893\u67ff\u5b50\u5427qwq\n\n\u663e\u7136\uff0c\u9898\u76ee\u8ba9\u6211\u4eec\u6c42\uff1a\n\n$\\large \\sum_{i=1}^n\\sum_{j=1}^m lcm(i,j)$\n\n$lcm$\u6ca1\u6cd5\u73a9\uff0c\u6211\u4eec\u8f6c\u5230$gcd$\u5f62\u5f0f\uff1a\n\n$\\large \\sum_{i=1}^n\\sum_{j=1}^m \\frac{i*j}{gcd(i,j)}$\n\n\u6839\u636e\u5957\u8def\uff0c\u6211\u4eec\u53bb\u679a\u4e3e$gcd$\n\n$\\large \\sum_{i=1}^n\\sum_{j=1}^m\\sum_{d=1}^{n} \\frac{i*j}{d}[gcd(i,j)=d]$\n\n\u7136\u540e\u53ef\u4ee5\u628a$d$\u7684\u548c\u53f7\u79fb\u5230\u524d\u9762\u53bb\n\n$\\large \\sum_{d=1}^{n}\\sum_{i=1}^n\\sum_{j=1}^m \\frac{i*j}{d}[gcd(i,j)=d]$\n\n\u8981\u8ba9$gcd(i,j)=d$\uff0c$i,j$\u90fd\u5fc5\u987b\u8981\u4e3a$d$\u7684\u500d\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u539f\u6765\u7684$i*d,j*d$\u6620\u5c04\u4e3a$i,j$,\u6709\uff1a\n\n$\\large \\sum_{d=1}^{n}\\sum_{i=1}^{n/d}\\sum_{j=1}^{m/d} {i*j}*d[gcd(i,j)=1]$\n\n\u628a$d$\u79fb\u5230\u524d\u9762\u53bb\n\n$\\large \\sum_{d=1}^{n}d\\sum_{i=1}^{n/d}\\sum_{j=1}^{m/d} {i*j}[gcd(i,j)=1]$\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5957\u8def\u5730\u6839\u636e$[x=1]=\\sum_{d|x}\\mu(d)$\u8fd9\u4e2a\u67ff\u5b50\u628a$gcd(i,j)$\u5904\u7406\u6389\uff1a\n\n$\\large \\sum_{d=1}^{n}d\\sum_{i=1}^{n/d}\\sum_{j=1}^{m/d} {i*j}\\sum_{k|gcd(i,j)}\\mu(k)$\n\n\u6839\u636e\u5957\u8def\uff0c\u6211\u4eec\u628a\u8fd9\u79cd\u5947\u5947\u602a\u602a\u7684\u548c\u5f0f\u53d8\u4e3a\u679a\u4e3e\u7684\u5f62\u5f0f\n\n$\\large \\sum_{d=1}^{n}d\\sum_{i=1}^{n/d}\\sum_{j=1}^{m/d} {i*j}\\sum_{k=1}^{n/d}[k|gcd(i,j)]\\mu(k)$\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u628a$k$\u5f80\u524d\u63d0\u4e86\n\n$\\large \\sum_{d=1}^{n}d\\sum_{k=1}^{n/d}\\sum_{i=1}^{n/d}\\sum_{j=1}^{m/d} {i*j}*[k|gcd(i,j)]\\mu(k)$\n\n\u8981\u6709$k|gcd(i,j)$\uff0c$i,j$\u4e00\u5b9a\u8981\u4e3a$k$\u7684\u500d\u6570\n\n$\\large \\sum_{d=1}^{n}d\\sum_{k=1}^{n/d}\\sum_{i=1}^{\\frac{n}{d*k}}\\sum_{j=1}^{\\frac{m}{d*k}} {i*j*k^2}*\\mu(k)$\n\n\u7136\u540e\u6211\u4eec\u7b80\u5355\u7684\u79fb\u4e00\u4e0b\u9879\u65b9\u4fbf\u5904\u7406\uff1a\u540e\u9762\u7684$j$\u4e0e$i$\u6ca1\u6709\u534a\u6bdb\u94b1\u5173\u7cfb\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u5206\u79bb\u5f00\u6765\n\n$\\large \\sum_{d=1}^{n}d\\sum_{k=1}^{n/d}*\\mu(k)*k^2(\\sum_{i=1}^{\\frac{n}{d*k}}i)(\\sum_{j=1}^{\\frac{m}{d*k}} j)$\n\n\u641e\u5b9a\uff0c\u5230\u8fd9\u91cc\u4e3a\u6b62\uff0c\u6211\u4eec\u6240\u6709\u4e1c\u897f\u90fd\u53ef\u4ee5\u6c42\u4e86\u3002\n\n\u5bf9\u4e8e\u524d\u9762\u7684$d$\u7684\u548c\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5f53$n/d,m/d$\u4e0d\u53d8\u7684\u65f6\u5019\uff0c\u540e\u9762\u7684\u67ff\u5b50\u8ba1\u7b97\u51fa\u6765\u7684\u7ed3\u679c\u662f\u4e00\u6837\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5$O(\\sqrt n)$\u6765\u6574\u9664\u5206\u5757\u6389\u524d\u9762\u90a3\u4e2a\u548c\u5f0f\u3002\n\n\u540e\u9762\u7684\u90a3\u4e2a\u67ff\u5b50\u6211\u4eec\u53ef\u4ee5\u518d\u6765\u4e00\u6b21\u6574\u6570\u9664\u6cd5\u6765\u8ba1\u7b97\uff1a\u6700\u540e\u9762\u7684\u4e24\u4e2a\u548c\u5f0f\u90fd\u662f\u7b49\u5dee\u6570\u5217\uff0c\u524d\u9762\u7684$\\mu(k)*k^2$\u53ef\u4ee5\u524d\u7f00\u548c\u76f4\u63a5\u8ba1\u7b97\u3002\n\n\u603b\u590d\u6742\u5ea6$O(\\sqrt n * \\sqrt n)=O(n)$\n\n~~\u4f46\u662f\u8fd9\u9898\u8fd8\u6709\u4e00\u4e2a$O(\\sqrt n)$\u7684\u505a\u6cd5\uff0c\u849f\u84bb\u592a\u83dc\u4e86\u4e0d\u4f1a\uff0c\u5c31\u4e0d\u8bf4\u4e86~~\n\n---\n# Code\n**\u8fd9\u9898\u7ec6\u8282\u7e41\u591a\uff0c\u8bf7\u6ce8\u610f\u591a\u819c\u4ee5\u9632\u4e58\u7206**\n\n**\u9884\u5904\u7406\u4e2d\u7684$i^2$\u4f1a\u7206int\uff0c\u8bf7\u6ce8\u610f**\n```cpp\n//Luogu  P1829 [\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB\n//Jan,23rd,2019\n//\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n#include<iostream>\n#include<cstdio>\nusing namespace std;\nlong long read()\n{\n\tlong long x=0,f=1; char c=getchar();\n\twhile(!isdigit(c)){if(c=='-') f=-1;c=getchar();}\n\twhile(isdigit(c)){x=x*10+c-'0';c=getchar();}\n\treturn x*f;\n}\nconst int N=10000000+1000;\nconst int M=10000000;\nconst int poi=20101009;\nint prime[N],cnt_p,mu[N];\nbool noPrime[N];\nvoid GetPrime(int n)\n{\n\tnoPrime[1]=true,mu[1]=1;\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tif(noPrime[i]==false)\n\t\t\tprime[++cnt_p]=i,mu[i]=-1;\n\t\tfor(int j=1;j<=cnt_p and i*prime[j]<=n;j++)\n\t\t{\n\t\t\tnoPrime[i*prime[j]]=true;\n\t\t\tif(i%prime[j]==0)\n\t\t\t{\n\t\t\t\tmu[i*prime[j]]=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmu[i*prime[j]]=mu[i]*mu[prime[j]];\n\t\t}\n\t}\n}\nlong long n,m,pre_mu[N];\nlong long f(int d)\n{\n\tlong long t_ans=0;\n\tfor(long long l=1,r;l<=n/d;l=r+1)\n\t{\n\t\tr=min((n/d)/((n/d)/l),(m/d)/((m/d)/l));\n\t\tt_ans=(t_ans+(pre_mu[r]-pre_mu[l-1])*(((1+n/d/l)*(n/d/l)/2)%poi)%poi*(((1+m/d/l)*(m/d/l)/2)%poi))%poi;\n\t}\n\treturn (t_ans%poi+poi)%poi;\n}\nint main()\n{\n\tn=read(),m=read();\n\tif(n>m) swap(n,m);\n\t\n\tGetPrime(m);\n\tfor(long long i=1;i<=m;i++)\n\t\tpre_mu[i]=((pre_mu[i-1]+mu[i]*i*i)%poi+poi)%poi;\n\tlong long ans=0;\n\tfor(long long l=1,r;l<=n;l=r+1)\n\t{\n\t\tr=min(n/(n/l),m/(m/l));\n\t\tans=((ans+(l+r)*(r-l+1)/2%poi*f(l))%poi+poi)%poi;\n\t}\n\t\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n\n```\n\n\n\n\n\n\n",
        "postTime": 1548295722,
        "uid": 52563,
        "name": "GoldenPotato137",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB\u3011"
    },
    {
        "content": "\u6211\u539f\u672c\u4e0d\u77e5\u8fd9\u79cd\u9898\u53ef\u4ee5**\u591a\u7ec4**\u6570\u636e\u7684\u3002\u67d0**\u826f\u5fc3**\u51fa\u9898\u4eba\u51fa\u4e86\u4e00\u9053\u591a\u7ec4\u6570\u636e\u7684\u7c7b\u4f3c\u9898\u540e\uff0c\u75db\u5b9a\u601d\u75db\uff0c\u5b66\u4e60\u4e86\u8fd9\u9053\u9898\u7684\u591a\u7ec4\u6570\u636e\u89e3\u6cd5\u3002\n\n\u5404\u4f4d\u5927\u4f6c\u7684\u535a\u5ba2\u8bb2\u5f97\u5f88\u660e\u767d\u4e86\uff0c\u6700\u540e\u7684\u5f0f\u5b50\u662f\uff1a\n\n$\\sum_{k=1 \\to n}k\\sum_{d=1 \\to \\frac{n}{k}}\\mu{(d)}d^2f(\\frac{n}{kd},\\frac{m}{kd})$\n\n\u53d1\u73b0\u5f53kd\u76f8\u7b49\u65f6\u5f88\u591a\u6b21\u6570\u8bba\u5206\u5757\u9020\u6210\u6d6a\u8d39\uff0c\u6240\u4ee5\u679a\u4e3e$p=kd$\uff0c\u5316\u4e3a\uff1a\n\n$\\sum_{p=1 \\to n}p*f(\\frac{n}{p},\\frac{m}{p})\\sum_{d|p}\\mu{(d)}d$\n\n=$\\sum_{p=1 \\to n}f(\\frac{n}{p},\\frac{m}{p})\\sum_{d|p}\\mu{(d)}d*p$\n\n\u53d1\u73b0$g(p)=\\sum_{d|p}\\mu{(d)}d$\u662f\u79ef\u6027\u51fd\u6570\uff0c\u6240\u4ee5\u7ebf\u7b5b\u6c42\u51fa\uff0c\u518d\u4e58\u4ee5p\u3002\u6c42\u4e2a\u524d\u7f00\u548c\u5c31\u53ef\u4ee5\u5206\u5757\u4e86~\n\n\u590d\u6742\u5ea6\uff1a$O(n+T\\sqrt{n})$\uff0c\u5176\u4e2dT\u662f\u8be2\u95ee\u6b21\u6570\u3002\n\n\u8fd9\u91cc\u6709\u4e2a\u95ee\u9898\uff0c\u4f7f\u7528\u6b27\u62c9\u7b5b\u6c42\u79ef\u6027\u51fd\u6570\uff0c$i \\space mod \\space prime[j]=0$\u65f6\u5982\u4f55\u6c42g\u7684\u503c\u5462\uff1f\u8bbe$i=a_1^{x_1}*a_2^{x_2}*...*a_n^{x_n}$\uff0c\u4e0d\u59a8\u4ee4$fac[i]=a_1^{x_1}$\uff0c$fac[i]$\u5f88\u5bb9\u6613\u7b5b\u51fa\u3002$i \\space mod \\space prime[j]=0$\u65f6\u5206\u60c5\u51b5\u8ba8\u8bba\uff0c\u82e5$fac[i*prime[j]]=i*prime[j]$\uff0c\u5219$\\mu{(i)}=0$\uff0c$fac[i*prime[j]]=fac[i]$;\u53cd\u4e4b\uff0c\u9664\u53bb$i*prime[j]$\u4e2d\u7684$fac$\uff0c\u5373\u53ef\u5316\u4e3a\u4e24\u4e2a\u4e92\u7d20\u6570\u7684\u4e58\u79ef\u3002\n\n~~$T=1$\u4e0d\u662f\u968f\u4fbf\u8fc7\u5417\uff1f~~\n\n\u4ee3\u7801\uff1a\n\n```\n\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<string>\n#include<algorithm>\n#include<math.h>\nusing namespace std;\n\nconst int N=1e7+5;\nconst int M=1e7;\nconst int mod=20101009;\n\nint T,n,m,prime[N],tot;\nint mju[N],s[N],f[N],fac[N];\nbool used[N];\n\nnamespace MATHEMATICS\n{\n\tint add(int x,int y)\n\t{\n\t\tint ret=x+y;\n\t\tif(ret>=mod) ret-=mod;\n\t\treturn ret;\n\t}\n\tint mi(int x,int y)\n\t{\n\t\tint ret=x-y;\n\t\tif(ret<0) ret+=mod;\n\t\treturn ret;\n\t}\n\t\n\tvoid inc(int &x,int y)\n\t{\n\t\tx+=y;\n\t\tif(x>=mod) x-=mod;\n\t}\n\tvoid dec(int &x,int y)\n\t{\n\t\tx-=y;\n\t\tif(x<0) x+=y;\n\t}\n\t\n\tint mul(int x,int y)\n\t{\n\t\treturn 1LL*x*y%mod;\n\t}\n}\nusing namespace MATHEMATICS;\n\nvoid prework()\n{\n\tint i,j;\n\tfac[1]=mju[1]=used[1]=f[1]=1;\n\tfor(i=2;i<=M;++i)\n\t{\n\t\tif(!used[i])\n\t\t{\n\t\t\tmju[i]=mi(0,1);\n\t\t\tf[i]=mi(1,i);\n\t\t\tfac[i]=i;\n\t\t\tprime[++tot]=i;\n\t\t}\n\t\tfor(j=1;j<=tot&&i*prime[j]<=M;++j)\n\t\t{\n\t\t\tused[i*prime[j]]=1;\n\t\t\tif(i%prime[j])\n\t\t\t{\n\t\t\t\tf[i*prime[j]]=mul(f[i],f[prime[j]]);\n\t\t\t\tfac[i*prime[j]]=prime[j];\n\t\t\t\tmju[i*prime[j]]=mul(mju[i],mju[prime[j]]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfac[i*prime[j]]=fac[i]*fac[prime[j]];\n\t\t\t\tmju[i*prime[j]]=0;\n\t\t\t\tif(fac[i*prime[j]]==i*prime[j])\n\t\t\t\t\tf[i*prime[j]]=f[i];\n\t\t\t\telse\n\t\t\t\t\tf[i*prime[j]]=mul(f[i*prime[j]/fac[i*prime[j]]],f[fac[i*prime[j]]]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tfor(i=1;i<=M;++i) f[i]=mul(f[i],i);\n\tfor(i=1;i<=M;++i) s[i]=add(s[i-1],f[i]);\n}\n\nint _sum(int x)\n{\n\treturn (1LL*x*(x+1)>>1)%mod;\n}\nint func(int x,int y)\n{\n\treturn mul(_sum(x),_sum(y));\n}\n\nvoid work()\n{\n\tint l,r,ans=0;\n\tscanf(\"%d%d\",&n,&m);\n\tif(n>m) swap(n,m);\n\tfor(l=1;l<=n;++l)\n\t{\n\t\tr=min(n/(n/l),m/(m/l));\n\t\tinc(ans,mul(func(n/l,m/l),mi(s[r],s[l-1])));\n\t\tl=r;\n\t}\n\tprintf(\"%d\\n\",ans);\n}\n\nint main()\n{\n\tprework();work();\n\treturn 0;\n}\n\n```",
        "postTime": 1544365281,
        "uid": 31435,
        "name": "hwk0518",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1829 \u3010[\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c / JZPTAB\u3011"
    }
]
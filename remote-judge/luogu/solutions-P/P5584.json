[
    {
        "content": "$\\color{#00cfff}T3.\\ Sunny's\\ Crystals$\n\n[$\\color{#00cfff}\\text{\u9898\u9762}$](https://www.luogu.org/problem/T99101?contestId=21489)\n\n\u5b98\u65b9\u9898\u89e3\n\n---\n\n$Sol\\ 1\\ :\\ 15\\ pts$\n\n$n!$ \u679a\u4e3e\uff0c\u53ef\u8fc7 $15\\%$ \u7684\u70b9\n\n\u4ee3\u7801\u5c31\u4e0d\u8d34\u4e86\n\n---\n\n$Sol\\ 2:\\ 30-35\\ pts$\n\n$n^2$ \u8d2a\u5fc3\uff0c\u53ef\u8fc7 $30-35\\%$ \u7684\u70b9\n\n\u6a21\u62df\u6bcf\u6b21\u6467\u6bc1\n\n- \u5982\u679c\u6709\u53ef\u4ee5\u6467\u6bc1\u7684\u6c34\u6676\uff0c\u6467\u6bc1\u4f4d\u7f6e\u9760\u540e\u7684\n\n**\uff08\u5982\u679c\u4e0d\u662f\u4f4d\u7f6e\u5728\u6700\u540e\uff0c\u90a3\u4e48\u6467\u6bc1\u8be5\u6c34\u6676\u7684\u65f6\u4f1a\u5f71\u54cd\u5230\u540e\u9762\u53ef\u6467\u6bc1\u7684\u6c34\u6676\uff09**\n\n- \u5426\u5219\u6467\u6bc1\u5f53\u524d\u5e8f\u5217\u7b2c\u4e00\u4e2a\n\n\uff08\u8d2a\u5fc3\u601d\u60f3\uff0c\u6ca1\u6709\u53ef\u6467\u6bc1\u7684 $w$\uff0c\u5219\u6467\u6bc1\u4f4d\u7f6e\u8d8a\u524d\u8d8a\u597d\uff09\n\n\u4ee3\u7801\u5c31\u4e0d\u8d34\u4e86\n\n---\n\n$Sol\\ 3:\\ 80-100\\ pts$\n\n$nlog(n)$\uff0c\u7ebf\u6bb5\u6811\u7ef4\u62a4\u8d2a\u5fc3\n\n\n\u7ebf\u6bb5\u6811\u7684\u5e38\u6570\u5de8\u5927\uff0c\u5982\u679c\u4f60\u8138\u9ed1\u53ef\u80fd\u62ff\u4e0d\u5230\u6ee1\u5206\uff08\u6bd5\u7adf\u53ea\u5f00\u4e86\u4e0d\u52a0\u4f18\u5316\u7684\u6807\u7a0b $+500ms$\uff09\n\n\u6211\u4eec\u5148\u627e\u51fa\u6240\u6709 $w$\uff0c\u53ef\u4ee5 $O(n)$ \u6c42\u51fa\u7b2c $i$ \u4e2a $w$ \u5230 **\u5728\u5b83\u4e4b\u524d\u7b2c\u4e00\u4e2a\u53ef\u4ee5\u6467\u6bc1\u7684\u4f4d\u7f6e** \u7684\u8ddd\u79bb\uff0c\u8bb0\u4e3a $d_i$\uff0c\u5171\u6709 $c$ \u4e2a\uff0c\u8bb0\u5f55\u521d\u59cb\u4f4d\u7f6e $pos_i$\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6c42\u51fa $pos_i-v_i$\uff0c\u5176\u4e2d $v_i\\leq pos_i,v_i=2^x,x$ \u4e3a\u975e\u8d1f\u6574\u6570\u4e14 $v_i$ \u8981\u6700\u5927\n\n\u63a5\u7740\u5728 $d_1-d_c$ \u4e4b\u95f4\u5efa\u7ebf\u6bb5\u6811\uff0c\u7ef4\u62a4\u533a\u95f4\u6700\u5c0f\u503c\n\n\u4ecd\u7136\u662f\u6a21\u62df\u6bcf\u6b21\u6467\u6bc1\n\n- $1.$ \u5982\u679c\u6709\u53ef\u4ee5\u6467\u6bc1\u7684\u6c34\u6676\uff0c\u6467\u6bc1\u4f4d\u7f6e\u9760\u540e\u7684\n\n\u8fd9\u5176\u5b9e\u5c31\u662f\u627e\u5230\u4e00\u4e2a $i$ \u6700\u5927\u4e14 $d_i$ \u4e3a $0$ \u7684 $i$\uff0c\u6467\u6bc1\n\n\u63a5\u7740**\u628a\u8fd9\u4e2a\u4f4d\u7f6e\u4e0a\u7684\u503c\u8d4b\u4e3a\u6781\u5927**\uff0c $2147483647$ \u6216\u4e00\u4e2a\u5927\u4e8e $10^7$ \u7684\u6570\n\n\u7136\u540e\u5b83\u540e\u9762\u6240\u6709\u7684 $d_{i+1},d_{i+2},\\dots,d_c$ \u90fd\u8981 $-1$\uff08\u8fd9\u4e2a\u80fd\u7406\u89e3\u5427 $qwq$\uff09\n\n- $2.$ \u5426\u5219\u6c42\u51fa $d_1,d_2,\\dots,d_c$ \u4e2d\u6700\u5c0f\u7684\u6570\uff0c\u8bb0\u4e3a $l$\uff0c\u6467\u6bc1 $l$ \u4e2a\u4f4d\u7f6e\u4e3a $1$ \u7684\u6c34\u6676\uff0c$d_1,d_2,\\dots,d_c$ \u5168\u90e8\u51cf\u53bb $l$\uff0c\u518d\u6267\u884c\u64cd\u4f5c $1$\n\n\u7b80\u800c\u8a00\u4e4b\uff0c\u5c31\u662f\u8ba9\u4f60\u7ef4\u62a4\u4e00\u4e2a **\u533a\u95f4\u4fee\u6539\uff0c\u533a\u95f4\u6700\u5c0f\u503c** \u7684\u7ebf\u6bb5\u6811\n\n---\n\n\u4ee3\u7801\n\n```\n//by ALEX_WEI\n#include<bits/stdc++.h>\nusing namespace std;\n//pragma GCC optimize(3) \u5f00\u4e86 O(3) \u8dd1\u5f97\u98de\u5feb , \u5988\u5988\u518d\u4e5f\u4e0d\u7528\u62c5\u5fc3\u6211 TLE \u5566 !\nconst int N=3e6+2;\nconst int inf=2e9+7;\ninline void read(int &x)//\u5efa\u8bae\u5199\u5feb\u8bfb\n{\n\tx=0;char s=getchar();\n\twhile(!isdigit(s))s=getchar();\n\twhile(isdigit(s))x=(x<<1)+(x<<3)+s-'0',s=getchar();\n}\ninline int _min(int a,int b){return a<b?a:b;}//\u5efa\u8bae\u624b\u5199 min\nint n,x,a,cnt,pow2=1,pos,ori[N],dis[N],els[N],t[N<<2],laz[N<<2],ans[N],now;\n//ori \u8bb0\u5f55\u521d\u59cb\u4f4d\u7f6e , els \u8bb0\u5f55\u4e0d\u662f w \u7684\u4f4d\u7f6e , dis \u4e3a\u9898\u89e3\u4e2d\u7684 pos[i]-v[i] , ans \u4e3a\u7b54\u6848\u5e8f\u5217 , cnt \u4e3a\u9898\u89e3\u4e2d\u7684 c\nvoid build(int l,int r,int x)//\u5efa\u6811\n{\n\tif(l==r){t[x]=dis[l];return;}\n\tint m=l+r>>1;\n\tbuild(l,m,x<<1);\n\tbuild(m+1,r,x<<1|1);\n\tt[x]=_min(t[x<<1],t[x<<1|1]);\n}\nvoid push_down(int l,int r,int x)\n{\n\tt[x<<1]-=laz[x];\n\tt[x<<1|1]-=laz[x];\n\tlaz[x<<1]+=laz[x];\n\tlaz[x<<1|1]+=laz[x];\n\tlaz[x]=0;//\u6e05\u96f6\n\tt[x]=_min(t[x<<1],t[x<<1|1]);//\u66f4\u65b0\n}\nvoid update(int l,int r,int ql,int qr,int x)\n{\n\tif(ql<=l&&r<=qr){laz[x]++,t[x]--;return;}\n\tint m=l+r>>1;\n\tif(m>=ql)update(l,m,ql,qr,x<<1);\n\tif(m<qr)update(m+1,r,ql,qr,x<<1|1);\n\tt[x]=_min(t[x<<1],t[x<<1|1]);//\u6700\u5c0f\u503c\n}\nint get(int l,int r,int x)\n{\n\tif(l==r){t[x]=inf;return l;}//\u8fd4\u56de\u7684\u662f\u7f16\u53f7 ! \n\tpush_down(l,r,x);//pushdown\n\tint m=l+r>>1,tmp;\n\tif(!t[x<<1|1])tmp=get(m+1,r,x<<1|1);//\u5982\u679c\u5de6\u8fb9\u662f 0, \u5f80\u5de6\u8fb9\u8dd1\n\telse tmp=get(l,m,x<<1);//\u5426\u5219\u5f80\u53f3\u8fb9\u8dd1\n\tt[x]=_min(t[x<<1],t[x<<1|1]);//\u66f4\u65b0\n\treturn tmp;\n}\nint main()\n{\n\tread(n),read(x);\n\tfor(int i=1;i<=n;i++){//O(n) \u6c42 dis \u6570\u7ec4\n\t\tread(a);\n\t\tif((pow2<<1)==i)pow2<<=1;\n\t\tif(a==x)ori[++cnt]=i,dis[cnt]=i-pow2;\n\t\telse els[++pos]=i;\n\t}\n\tbuild(1,cnt,1),pos=0;\n\tfor(int i=1;i<=cnt;i++){\n\t\tif(t[1]){//t[1] \u5373\u4e3a min(dis[1],dis[2],...,dis[cnt]) \n\t\t\tlaz[1]+=t[1];//\u61d2\u60f0\u6807\u8bb0\u6807\u4e0a\n\t\t\tfor(int j=1;j<=t[1];j++)\n\t\t\t\tans[++now]=els[++pos];//\u4ece\u4e0d\u662f w \u7684\u53d6 t[1] \u4e2a\n\t\t\tt[1]=0;//\u6e05\u96f6\n\t\t}\n\t\tint p=get(1,cnt,1);//\u6c42\u51fa\u53ef\u6467\u6bc1\u7684\u6c34\u6676\u7f16\u53f7\n\t\tans[++now]=ori[p];//\u6467\u6bc1\u6389 , \u7f16\u53f7\u4e3a\u521d\u59cb\u4f4d\u7f6e\n\t\tif(p<cnt)update(1,cnt,p+1,cnt,1);//\u5982\u679c\u6467\u6bc1\u7684\u4e0d\u662f\u6700\u540e\u4e00\u4e2a , \u5c06 d[p+1],d[p+2],...,d[c] \u51cf\u53bb 1\n\t}\n\tcout<<now<<endl;//\u8f93\u51fa\n\tfor(int i=1;i<=now;i++)\n\t\tcout<<ans[i]<<\" \";\n\treturn 0;\n}\n```\n\n\u6c42\u8d5e $qwq$ ",
        "postTime": 1570031028,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "\u3010SWTR-01\u3011Sweet Round 01 T3 Sunny's Crystals"
    },
    {
        "content": "\u53ef\u4ee5\u60f3\u5230\u8d2a\u5fc3: \n\n\u5982\u679c\u76ee\u524d\u6709\u53ef\u4ee5\u6467\u6bc1\u7684\u76ee\u6807\u6c34\u6676,\u90a3\u4e48\u6467\u6bc1\u6700\u9760\u540e\u7684\n\n\u5426\u5219\u6467\u6bc1\u7b2c\u4e00\u4e2a\u6c34\u6676\n\n\u8bc1\u660e: \n\n> \u5982\u679c\u4e00\u4e2a\u6c34\u6676\u76ee\u524d\u65e0\u6cd5\u6467\u6bc1,\u5b83\u5fc5\u987b\u7b49\u524d\u9762\u82e5\u5e72\u4e2a\u6c34\u6676\u88ab\u6467\u6bc1\u5b83\u624d\u80fd\u79fb\u52a8\u5230\u76ee\u6807\u4f4d\u7f6e\n> \n> \u6240\u4ee5\u5f53\u76ee\u6807\u6c34\u6676\u6ca1\u6709\u53ef\u4ee5\u6467\u6bc1\u7684\u65f6\u5019,\u6467\u6bc1\u5e8f\u5217\u7b2c\u4e00\u4e2a\u53ef\u4ee5\u79fb\u52a8\u6700\u591a\u7684\u76ee\u6807\u6c34\u6676\n\n> \u5f53\u6709\u8d85\u8fc7\u4e00\u4e2a\u76ee\u6807\u6c34\u6676\u53ef\u4ee5\u6467\u6bc1\u7684\u65f6\u5019,\u4ece\u540e\u5f80\u524d\u6467\u6bc1\u663e\u7136\u662f\u6700\u4f18\u7684\n\n\u90a3\u4e48\u8981\u5982\u4f55\u5b9e\u73b0\u8fd9\u4e2a\u8d2a\u5fc3\u5462?\n\n\u5f88\u5bb9\u6613\u60f3\u5230\u6570\u636e\u7ed3\u6784\n\n1. \u5e73\u8861\u6811\u66b4\u529b\u64cd\u4f5c: \u6570\u636e\u8303\u56f4$3\\times 10^6$,\u663e\u7136\u662f\u4e0d\u884c\u7684\n   \n2. \u7ebf\u6bb5\u6811 \u76ee\u6807\u6c34\u6676\u6700\u591a$1.5\\times 10^6$,\u4e14\u7ebf\u6bb5\u6811\u5e38\u6570\u4e0d\u5927,\u53ef\u884c\n\n\u5b9e\u73b0: \n\n1. \u7ebf\u6bb5\u6811\u7ef4\u62a4\n\n\u7ef4\u62a4$d_1,d_2,\\dots,d_{cnt}$\u8868\u793a\u76ee\u6807\u6c34\u6676\u5230\u53ef\u4ee5\u6467\u6bc1\u7684\u4f4d\u7f6e\u7684\u8ddd\u79bb\n\n\u7ef4\u62a4\u6700\u5c0f\u503c\n\n\u82e5\u6700\u5c0f\u503c\u4e3a$0$,\u8fd9\u627e\u5230\u6700\u9760\u540e\u7684$d_x=0$,\u6467\u6bc1,\u4e5f\u5c31\u662f\u8ddd\u79bb\u8d4b\u503c\u4e3a\u65e0\u7a77\u5927,\u7136\u540e\u5c06$d_i,i\\in[x+1,cnt]$\u90fd\u51cf\u53bb$1$\n\n\u5426\u5219\u4e00\u76f4\u6467\u6bc1\u7b2c\u4e00\u4e2a\u6c34\u6676\u76f4\u5230\u6700\u5c0f\u503c\u4e3a$0$,\u4e5f\u5c31\u662f\u6240\u6709$d_i$\u90fd\u51cf\u53bb$min(d_i)$\n\n\u4ee3\u7801\u5982\u4e0b:\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i=x;i<=y;++i)\nil int MIN(int x,int y){return x<y?x:y;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}}using namespace IO;\nconst int N=1500011;\nint n,w,cnt=0,s[N<<2],laz[N<<2],a[N],old[N],ANS[N<<1],ans=0,oth[N<<1];\n#define ls rt<<1\n#define rs rt<<1|1\nil void pu(int rt){s[rt]=MIN(s[ls],s[rs]);}\nil void pd(int rt){\n    if(laz[rt]){\n        laz[ls]+=laz[rt];s[ls]-=laz[rt];\n        laz[rs]+=laz[rt];s[rs]-=laz[rt];\n        laz[rt]=0;\n    }\n}\nvoid build(int l,int r,int rt){\n    if(l==r){s[rt]=a[l];return;}\n    int m=(l+r)>>1;\n    build(l,m,ls);build(m+1,r,rs);\n    pu(rt);\n}\nvoid upd(int L,int c,int l,int r,int rt){\n    if(L<=l){s[rt]-=c;laz[rt]+=c;return;}\n    int m=(l+r)>>1;\n    pd(rt);\n    if(L<=m)upd(L,c,l,m,ls);\n    upd(L,c,m+1,r,rs);\n    pu(rt);\n}\nint ask(int l,int r,int rt){\n    if(l==r){\n        s[rt]=(1<<30);\n        ANS[++ans]=old[l];\n        return l;\n    }\n    int m=(l+r)>>1,res;\n    pd(rt);\n    if(!s[rs])res=ask(m+1,r,rs);\n    else res=ask(l,m,ls);\n    pu(rt);\n    return res;\n}\nint main(){\n    in(n,w);\n    int x,b=1,now=0;\n    Fur(i,1,n){\n        if((b<<1)<=i)b<<=1;\n        in(x);\n        if(x==w)a[++cnt]=i-b,old[cnt]=i;\n        else oth[++now]=i;\n    }\n    now=0;\n    build(1,cnt,1);\n    Fur(t,1,cnt){\n        if(s[1]){\n            Fur(j,1,s[1])ANS[++ans]=oth[++now];\n            upd(1,s[1],1,cnt,1);\n        }\n        x=ask(1,cnt,1)+1;\n        if(x<=cnt)upd(x,1,1,cnt,1);\n    }\n    out(ans);pt('\\n');\n    Fur(i,1,ans)out(ANS[i]),pt(' ');\n    flush();\n}\n```\n\n2. \u5de7\u5999\u7684\u6a21\u62df\n\n\u53ef\u4ee5\u53ea\u7ef4\u62a4\u6240\u6709$2$\u6b21\u5e42\u4f4d\u7f6e\u5728\u539f\u5e8f\u5217\u4e2d\u7684\u4f4d\u7f6e\n\n\u6bcf\u6b21\u4fee\u6539\u53ea\u9700\u8981\u4fee\u6539$\\log_2 n$\u4e2a\u4f4d\u7f6e,\u590d\u6742\u5ea6\u5b8c\u5168\u53ef\u4ee5\u63a5\u53d7\n\n\u6839\u636e\u8fd9\u4e2a\u7279\u6027,\u66b4\u529b\u8dd1\u7684\u6bd4\u6b63\u89e3\u7ebf\u6bb5\u6811\u8fd8\u5feb\n\n\u4ee3\u7801\u5982\u4e0b: \n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i=x;i<=y;++i)\n#define Fdr(i,x,y) for(int i=x;i>=y;--i)\nil int MIN(int x,int y){return x<y?x:y;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}}using namespace IO;\nconst int N=3000011;\nint n,tot=0,b=0,w,a[N],p[N],ans=0,ANS[N];\nint main(){\n    in(n,w);\n    Fur(i,1,n){\n        in(a[i]);\n        if(a[i]==w)++tot;\n    }\n    a[n+1]=-1;\n    while((1<<b)<=n)p[b+1]=(1<<b),++b;\n    while(tot){\n        bool f=0;\n        Fdr(i,b,1)if(a[p[i]]==w){\n            ANS[++ans]=p[i];\n            a[p[i]]=0;\n            Fur(j,i,b)if(p[j]<=n)\n                while(!a[++p[j]]);\n            --tot;f=1;break;\n        }\n        if(!f){\n            ANS[++ans]=p[1],a[p[1]]=0;\n            Fur(i,1,b)if(p[i]<=n)\n                while(!a[++p[i]]);\n        }\n    }\n    out(ans);pt('\\n');\n    Fur(i,1,ans)out(ANS[i]),pt(' ');\n    flush();\n}\n```\n",
        "postTime": 1582882290,
        "uid": 36532,
        "name": "localhost",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5584 \u3010\u3010SWTR-01\u3011Sunny's Crystals \u3011"
    },
    {
        "content": "~~\u95f2\u6765\u65e0\u4e8b\u6c34\u4e00\u7bc7\u9898\u89e3~~\n\n\u4e00\u4e2a\u5c0f\u8d2a\u5fc3\uff1a\n\n>\u5982\u679c\u6709\u53ef\u4ee5\u6467\u6bc1\u7684\u6c34\u6676\uff0c\u5219\u6467\u6bc1\u6700\u9760\u540e\u7684\u6c34\u6676\uff0c\u5426\u5219\u6467\u6bc1\u7b2c\u4e00\u4e2a\u3002\n\n\u56e0\u4e3a\u6467\u6bc1\u6700\u9760\u540e\u7684\u6c34\u6676\u4e0d\u4f1a\u5f71\u54cd\u524d\u9762\u7684\u6c34\u6676\u7684\u4f4d\u7f6e\uff0c\u5982\u679c\u6ca1\u6709\u53ef\u4ee5\u6467\u6bc1\u7684\uff0c\u5c31\u9700\u8981\u6539\u53d8\u6c34\u6676\u7684\u4f4d\u7f6e\uff0c\u6467\u6bc1\u7b2c\u4e00\u4e2a\u5c31\u4f1a\u628a\u540e\u9762\u7684\u5168\u90fd\u5411\u524d\u79fb\u52a8\u3002\n\n\u4e8e\u662f\uff0c\u8bb0\u5f55\u4e0b\u6765\u7b2c $i$ \u4e2a\u4ef7\u503c\u4e3a $w$ \u7684\u6c34\u6676\u7684\u4f4d\u7f6e $pos_i$ \u548c\u7b2c $i$ \u4e2a\u6c34\u6676\u5230\u524d\u4e00\u4e2a\u53ef\u4ee5\u6467\u6bc1\u7684\u4f4d\u7f6e\u7684\u8ddd\u79bb $dis_i$\u3002\u8fd8\u8981\u8bb0\u5f55\u4e0b\u6765\u4ef7\u503c\u4e0d\u4e3a $w$ \u7684\u7b2c $i$ \u4e2a\u6c34\u6676\u7684\u4f4d\u7f6e $del_i$\uff0c\u56e0\u4e3a\u540e\u9762\u8981\u8f93\u51fa\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u5c31\u4f1a\u53d1\u73b0\u53ef\u4ee5\u7528\u7ebf\u6bb5\u6811**\u7ef4\u62a4 $dis$ \u6570\u7ec4\u6700\u5c0f\u503c**\u548c**\u533a\u95f4\u4fee\u6539**\u3002\n\n\u7ebf\u6bb5\u6811\u6570\u7ec4\u4e3a $t$\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c $t_1=0$\uff0c\u8bf4\u660e\u6709\u53ef\u4ee5\u6467\u6bc1\u7684\u6c34\u6676\uff0c\u4e8e\u662f\u67e5\u627e\u6700\u9760\u540e\u7684 $dis$ \u4e3a $0$ \u7684\u6c34\u6676\u7684\u4e0b\u89d2\u6807\uff0c\u5426\u5219\uff0c\u6467\u6bc1 $t_1-1$ \u4e2a\u6c34\u6676\uff0c\u8ba9\u4e00\u4e2a\u4ef7\u503c\u4e3a $w$ \u7684\u6c34\u6676\uff0c\u79fb\u52a8\u5230\u53ef\u4ee5\u6467\u6bc1\u7684\u4f4d\u7f6e\u4e0a\uff0c\u540c\u65f6\uff0c\u5176\u4f59\u6c34\u6676\u8ddf\u7740\u5411\u524d\u79fb\u52a8\u3002\u6700\u540e\u7528 $ans_i$ \u8bb0\u5f55\u4e0b\u6765\u7b2c $i$ \u6b21\u6467\u6bc1\u7684\u4f4d\u7f6e\u3002\n\n\u672c\u9898\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#define INF 0x3f3f3f3f\n\nusing namespace std;\n\nconst int N=3e6+10;\nint n,w,cnt,tot;\nint pos[N],del[N],dis[N],ans[N];\nint t[N<<2],tag[N<<2];\n\nint read()\t//\u5feb\u8bfb \n{\n\tint x=0;\n\tchar c=getchar();\n\twhile(c<'0'||c>'9') c=getchar();\n\twhile(c>='0'&&c<='9') x=x*10+c-'0',c=getchar();\n\treturn x;\n}\n\nvoid pushup(int rt)\n{\n\tt[rt]=min(t[rt<<1],t[rt<<1|1]);\n}\n\nvoid build(int l,int r,int rt)\n{\n\tif(l==r)\n\t{\n\t\tt[rt]=dis[l];\n\t\treturn;\n\t}\n\tint m=(l+r)>>1;\n\tbuild(l,m,rt<<1);\n\tbuild(m+1,r,rt<<1|1);\n\tpushup(rt);\n}\n\nvoid pushdown(int rt)\n{\n\tif(tag[rt])\n\t{\n\t\tt[rt<<1]-=tag[rt];\n\t\tt[rt<<1|1]-=tag[rt];\n\t\ttag[rt<<1]+=tag[rt];\n\t\ttag[rt<<1|1]+=tag[rt];\n\t\ttag[rt]=0;\n\t\tpushup(rt);\n\t}\n}\n\nint get(int l,int r,int rt)\n{\n\tif(l==r)\n\t{\n\t\tt[rt]=INF;\n\t\treturn l;\n\t}\n\tpushdown(rt);\n\tint m=(l+r)>>1,ret;\n\tif(!t[rt<<1|1]) ret=get(m+1,r,rt<<1|1);\t//\u8fd9\u91cc\u8981\u5148\u627e\u9760\u540e\u7684\u6c34\u6676 \n\telse ret=get(l,m,rt<<1);\n\tpushup(rt);\n\treturn ret;\n}\n\nvoid update(int L,int R,int l,int r,int rt)\n{\n\tif(L<=l&&r<=R)\n\t{\n\t\ttag[rt]++;\n\t\tt[rt]--;\n\t\treturn;\n\t}\n\tint m=(l+r)>>1;\n\tif(L<=m) update(L,R,l,m,rt<<1);\n\tif(m<R) update(L,R,m+1,r,rt<<1|1);\n\tpushup(rt);\n}\n\nint main()\n{\n\tint p2=1,sum=0;\n\tn=read();\n\tw=read();\n\tfor(int i=1; i<=n; i++)\n\t{\n\t\tint a=read();\n\t\tif((p2<<1)==i) p2<<=1;\t//p2:\u6bcf\u4e2a\u53ef\u4ee5\u6467\u6bc1\u7684\u4f4d\u7f6e \n\t\tif(a==w) pos[++cnt]=i,dis[cnt]=i-p2;//pos:\u4ef7\u503c\u4e3aw\u7684\u6c34\u6676\u7684\u4f4d\u7f6e\uff0cdis:\u6c34\u6676\u5230\u524d\u4e00\u4e2a\u53ef\u4ee5\u6467\u6bc1\u7684\u4f4d\u7f6e\u7684\u8ddd\u79bb \n\t\telse del[++sum]=i;\t//\u4ef7\u503c\u4e0d\u4e3aw\u7684\u6c34\u6676 \n\t}\n\tbuild(1,cnt,1);\n\tsum=0;\n\tfor(int i=1; i<=cnt; i++)\n\t{\n\t\tif(t[1])\t//\u6ca1\u6709\u53ef\u4ee5\u6467\u6bc1\u7684\u6c34\u6676 \n\t\t{\n\t\t\ttag[1]+=t[1];\t//lazytag \n\t\t\tfor(int j=1; j<=t[1]; j++)\n\t\t\t\tans[++tot]=del[++sum];\n\t\t\tt[1]=0;\n\t\t}\n\t\tint x=get(1,cnt,1);\t//\u83b7\u53d6dis\u6700\u5c0f\u7684\u6c34\u6676\u7684\u4e0b\u89d2\u6807 \n\t\tans[++tot]=pos[x];\n\t\tif(x<cnt) update(x+1,cnt,1,cnt,1);\n\t}\n\tprintf(\"%d\\n\",tot);\n\tfor(int i=1; i<=tot; i++)\n\t\tprintf(\"%d \",ans[i]);\n\tprintf(\"\\n\");\n\treturn 0;\n}\n```\n",
        "postTime": 1582992896,
        "uid": 211300,
        "name": "Acestar",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5584 \u3010\u3010SWTR-01\u3011Sunny's Crystals \u3011"
    },
    {
        "content": "[\u5728\u6211\u7684\u535a\u5ba2\u83b7\u5f97\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/mk-oi/p/LuoguP5584.html)\n\n## Problem\n\n[P5584 \u3010SWTR-01\u3011Sunny's Crystals](https://www.luogu.com.cn/problem/P5584)\n\n**\u9898\u76ee\u5927\u610f\uff1a**\n\n\u7ed9\u4f60\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217\uff0c\u6bcf\u6b21\u53ef\u4ee5\u5220\u6389\u4e0b\u6807\u4e3a $2$ \u7684\u975e\u8d1f\u6574\u6570\u6b21\u5e42\u7684\u6570\uff0c\u5220\u6389\u4e00\u4e2a\u6570\u540e\u4ed6\u540e\u9762\u7684\u6570\u4f1a\u5f80\u524d\u8865\uff0c\u95ee\u5220\u6389\u6240\u6709\u503c\u4e3a $w$ \u7684\u6570\u6240\u9700\u8981\u7684\u6700\u5c0f\u6b65\u6570\u53ca\u5bf9\u5e94\u7684\u65b9\u6848\u3002\n\n## Solution\n\n\u8003\u8651\u8d2a\u5fc3\u505a\u6cd5\u3002\n\n\u5982\u679c\u5f53\u524d\u80fd\u5220\u7684\u6570\u4e2d\u6709 $w$\uff0c\u663e\u7136\u5220 $w$ \u6700\u4f18\u3002\u4f46\u5f53\u6709\u591a\u4e2a\u503c\u4e3a $w$ \u7684\u4f4d\u7f6e\u65f6\u5e94\u8be5\u5982\u4f55\u9009\u62e9\uff1f\u5bb9\u6613\u53d1\u73b0\u5220\u6700\u540e\u4e00\u4e2a\u66f4\u4f18\uff0c\u56e0\u4e3a\u5220\u524d\u9762\u7684\u6570\u4f1a\u5f71\u54cd\u540e\u9762\u7684\u6570\uff0c\u6240\u4ee5\u8981\u5c3d\u91cf\u4e0d\u5f71\u54cd\u540e\u9762\u3002  \n\u5982\u679c\u5f53\u524d\u80fd\u5220\u7684\u6570\u4e2d\u6ca1\u6709 $w$\uff0c\u90a3\u4e48\u4e0e\u4e4b\u524d\u76f8\u53cd\uff0c\u8981\u8ba9\u5c3d\u53ef\u80fd\u591a\u7684\u4f4d\u7f6e\u6539\u53d8\uff0c\u6240\u4ee5\u5220\u7b2c\u4e00\u4e2a\u6570\u3002\n\n\u4f46\u662f\u76f4\u63a5\u505a\u662f $n^2$ \u7684\uff0c\u6240\u4ee5\u8003\u8651\u4f18\u5316\u3002  \n\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4e2a\u4e0d\u9700\u8981\u6570\u636e\u7ed3\u6784\u7684\u505a\u6cd5\u3002  \n\u8003\u8651\u5230\u80fd\u5220\u7684\u4f4d\u7f6e\u53ea\u6709 $\\log n$ \u4e2a\uff0c\u6240\u4ee5\u53ef\u4ee5\u7ef4\u62a4 $\\log n$ \u4e2a\u6307\u9488\uff0c\u5206\u522b\u6307\u5411\u80fd\u5220\u7684\u4f4d\u7f6e\u3002\u6bcf\u6b21\u5220\u4e00\u4e2a\u6570\u5c31\u628a\u5f53\u524d\u53ca\u4e4b\u540e\u7684\u6307\u9488\u53f3\u79fb\u4e00\u4f4d\u3002\u5e76\u4e14\u5728\u5220\u8fc7\u7684\u6570\u4e0a\u6253\u4e0a tag\u3002\u6bcf\u6b21\u5220\u6570\u90fd\u53ea\u4f1a\u5f71\u54cd $\\log n$ \u4e2a\u6307\u9488\uff0c\u4e14\u6bcf\u4e2a\u6570\u6700\u591a\u88ab $\\log n$ \u4e2a\u6307\u9488\u626b\u5230\uff0c\u590d\u6742\u5ea6\u4e3a $O(n \\log n)$\u3002\n\n## Code\n\n\u5b9e\u73b0\u8d77\u6765\u5f88\u7b80\u5355\uff0c\u7801\u5c31\u4e0d\u8d34\u4e86\u3002",
        "postTime": 1665358368,
        "uid": 195331,
        "name": "Mine_King",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5584 \u3010\u3010SWTR-01\u3011Sunny's Crystals\u3011"
    }
]
[
    {
        "content": "\u8fd9\u9898\u7684\u601d\u8def\u5f88\u7cbe\u5999\u3002\n\n\u5148\u8003\u8651\u521d\u59cb\u70b9\u65e0\u6cd5\u8df3\u5230\u4efb\u4f55\u4e00\u4e2a\u8e66\u5e8a\u4e0a\u53bb\uff0c\u90a3\u4e48\u8fd9\u79cd\u60c5\u51b5\u7684\u6700\u5927\u697c\u623f\u6570\u5c31\u53ea\u80fd\u662f\u4e0e\u5b83\u76f8\u90bb\u7684\u8fde\u7eed\u5de6\u8fb9\u6216\u53f3\u8fb9\u4e00\u6bb5\u6570\uff0c\u8fd9\u4e2a\u5224\u65ad\u4e00\u4e0b\u5c31\u597d\u4e86\u3002\n\n\u518d\u6765\u8003\u8651\u521d\u59cb\u70b9\u80fd\u8df3\u5230\u8e66\u5e8a\u4e0a\u53bb\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c\u67d0\u4e00\u4e2a\u70b9\u53ef\u4ee5\u8df3\u5230\u8e66\u5e8a\uff0c\u90a3\u4e48\u76f8\u5f53\u4e8e\u8fd9\u4e2a\u697c\u623f\u4e5f\u662f\u4e00\u4e2a\u8e66\u5e8a\uff08\u8df3\u7740\u8df3\u7740\u5c31\u80fd\u53bb\u4e00\u4e2a\u8e66\u5e8a\u4e86\uff09\u3002\u4e8e\u662f\u6211\u4eec\u628a\u4e0e\u8e66\u5e8a\u53ef\u4ee5\u8df3\u5230\u7684\u4f4d\u7f6e\u5168\u90fd\u6539\u6210\u8e66\u5e8a\uff0c\u56e0\u4e3a\u521d\u59cb\u70b9\u53ef\u4ee5\u53bb\u8e66\u5e8a\uff08\u4e5f\u5c31\u662f\u53ef\u4ee5\u8df3\u5230\u4efb\u4f55\u4e00\u4e2a\u5730\u65b9\uff09\uff0c\u90a3\u4e48\u8fd9\u4e9b\u4e0e\u8e66\u5e8a\u76f8\u90bb\u7684\u70b9\u90fd\u53ef\u4ee5\u88ab\u8df3\u5230\u3002\u90a3\u4e48\u8df3\u5b8c\u4e86\u6240\u6709\u4e0e\u8e66\u5e8a\u76f8\u90bb\u7684\u70b9\u540e\u600e\u4e48\u529e\uff1f\u518d\u627e\u4e00\u6bb5\u6700\u5927\u7684\u6ca1\u6709\u4e0e\u8e66\u5e8a\u76f8\u90bb\u7684\u70b9\u8df3\u8fc7\u53bb\uff0c\u8fd9\u4e9b\u5c31\u662f\u7b54\u6848\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nchar s[500001];\nint n,m,i,l,r,ans,a[500001],rs[500001],ls[500001],sum;\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(i=1;i<=n;i++)scanf(\"%d\",&a[i]);\n\tscanf(\"%s\",&s);\n\tfor(i=2;i<=n;i++)\n\t if(a[i]>=a[i-1]){\n\t \tls[i]=ls[i-1]+1;\n\t \tif(s[i-2]=='T')s[i-1]='T';\n\t }\n\tfor(i=n-1;i;i--)\n\t if(a[i]>=a[i+1]){\n\t \trs[i]=rs[i+1]+1;\n\t \tif(s[i]=='T')s[i-1]='T';\n\t } \n\t/*for(i=1;i<=n;i++)printf(\"%d \",ls[i]);\n\tputs(\"\");\n\tfor(i=1;i<=n;i++)printf(\"%d \",rs[i]);\n\tputs(\"\"); \n\tprintf(\"%s\\n\",s);*/\n\tif(s[m-1]=='T'){\n\t\tfor(i=1;i<=n;i++){\n\t\t\tif(s[i-1]=='T')ans++;\n\t\t\t else sum=max(sum,max(ls[i],rs[i])+1);\n\t\t}\n\t\tprintf(\"%d\",ans+sum);\n\t\treturn 0;\n\t} \n\tl=r=m;\n\twhile(l>1&&a[l-1]==a[l])l--;\n\twhile(r<n&&a[r+1]==a[r])r++;\n\tprintf(\"%d\",max(ls[r],rs[l])+1);\n}\n```",
        "postTime": 1528853745,
        "uid": 50251,
        "name": "\u59ec\u5c0f\u8def\u79cb\u5b50",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4611 \u3010[COCI2011-2012#7] TRAMPOLIN\u3011"
    },
    {
        "content": "# P4611 [COI2012] TRAMPOLIN \u9898\u89e3\r\n\r\n**\u4e00\u9053\u7f29\u70b9\u548c\u6700\u77ed\u8def\u7684\u597d\u9898\uff01**\r\n\r\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P4611)\r\n\r\n## \u9898\u76ee\u5927\u610f\r\n\r\n\u6709\u4ece\u5de6\u5230\u53f3\u6392\u5217\u7684 $n$ \u4e2a\u70b9\uff0c\u6bcf\u4e2a\u70b9\u7684\u503c\u4e3a $a_{i}$\uff0c\u6bcf\u4e2a\u70b9\u53ef\u4ee5\u5411\u4e0e\u5b83\u76f8\u90bb\u4e14\u503c\u5c0f\u4e8e\u7b49\u4e8e\u5b83\u7684\u70b9\u8f6c\u79fb\uff0c\u8fd8\u6709\u4e00\u4e9b\u70b9\u53ef\u4ee5\u5411\u4efb\u610f\u4e00\u70b9\u8f6c\u79fb\uff0c\u6c42\u4ece $1$ \u53f7\u70b9\u51fa\u53d1\u6700\u591a\u80fd\u7ecf\u8fc7\u51e0\u4e2a\u70b9\u3002\r\n\r\n## \u601d\u8def\r\n\r\n\u9996\u5148\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u60f3\u5230\u628a\u6bcf\u4e2a\u70b9\u5411\u5b83\u53ef\u4ee5\u5230\u8fbe\u7684\u70b9\u8fde\u4e00\u6761\u6709\u5411\u8fb9\uff0c\u7136\u540e\u8dd1\u4e00\u904d\u6700\u957f\u8def\u3002\r\n\r\n\u4f46\u8fd9\u6837\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u5c31\u662f\u8fd9\u6837\u5efa\u51fa\u6765\u7684\u56fe\u662f\u53ef\u80fd\u6709**\u73af**\u7684\uff0c\u5c31\u4e0d\u80fd\u76f4\u63a5\u8dd1\u6700\u957f\u8def\u3002\r\n\r\n\u6240\u4ee5\u6211\u4eec\u5148\u8981\u7528 **Tarjan** \u7f29\u70b9\uff08\u6ca1\u5b66\u8fc7 Tarjan \u7f29\u70b9\u7684\u53ef\u4ee5\u53bb\u5b66\u4e00\u4e0b [\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3387) \uff09\r\n\r\n\u7f29\u5b8c\u70b9\u540e\u53bb\u91cd\u8fb9\u539f\u56fe\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a DAG\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u8dd1\u6700\u957f\u8def\u4e86\u3002\r\n\r\n\u5728\u7f29\u70b9\u524d\u5efa\u8fb9\u7684\u65f6\u5019\u8fd8\u6709\u4e00\u4e2a\u5730\u65b9\u8981\u6ce8\u610f\uff0c\u5c31\u662f\u5728\u9047\u5230\u53ef\u4ee5\u5411\u4efb\u610f\u4e00\u70b9\u8f6c\u79fb\u7684\u70b9\u65f6\u5982\u679c\u76f4\u63a5\u5faa\u73af $n$ \u4e2a\u70b9\u5efa\u8fb9\u7684\u8bdd\u4f1a TLE\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u5efa\u4e00\u4e2a\u865a\u70b9\u5411\u6240\u6709\u70b9\u8fde\u8fb9\uff0c\u518d\u5c06\u53ef\u4ee5\u5411\u4efb\u610f\u4e00\u70b9\u8f6c\u79fb\u7684\u70b9\u5411\u8fd9\u4e2a\u865a\u70b9\u8fde\u8fb9\uff0c\u8fd9\u6837\u624d\u4e0d\u4f1a TLE\u3002\r\n\r\n## \u4ee3\u7801\r\n\r\n```cpp\r\n#include<bits/stdc++.h>\r\nusing namespace std;\r\nint n,m,qs,dfn[300003],ans[300003],scc[300003],low[300003],tot=0,cl=0,stk[300003],h=0,k,a[300003],anss,dis[300010],q[300110];\r\nconst int mod=300003;\r\nvector<int> f[300003],f2[300003];\r\nchar str[300003];\r\nbool vis[300003];\r\nstruct as{\r\n\tint x,y;\r\n}p[1000003];\r\ninline bool cmp(as p,as q){\r\n\treturn (p.x==q.x)?p.y<q.y:p.x<q.x;\r\n}\r\ninline int read(){\r\n\tint x=0;char ch= getchar();\r\n\twhile(ch<'0'||ch>'9')ch=getchar();\r\n\twhile(ch>='0'&&ch<='9')x=(x<<1)+(x<<3)+ch-'0',ch=getchar();\r\n\treturn x;\r\n}\r\ninline void Max(int &aa,int bb){\r\n\tif(aa<bb) aa=bb;\r\n\treturn;\r\n}\r\ninline void Min(int &aa,int bb){\r\n\tif(aa>bb) aa=bb;\r\n\treturn;\r\n}\r\nvoid trj(int u){//Tarjan \u7f29\u70b9\r\n\tregister int i;\r\n\tdfn[u]=++tot;\r\n\tlow[u]=tot;\r\n\tvis[u]=true;\r\n\tstk[++h]=u;\r\n\tfor(i=0;i<f[u].size();++i){\r\n\t\tif(!dfn[f[u][i]]){\r\n\t\t\ttrj(f[u][i]);\r\n\t\t\tMin(low[u],low[f[u][i]]);\r\n\t\t}\r\n\t\telse if(vis[f[u][i]])Min(low[u],dfn[f[u][i]]);\r\n\t}\r\n\tif(dfn[u]==low[u]){\r\n\t\t++cl;\r\n\t\tdo{\r\n\t\t\tscc[stk[h]]=cl,vis[stk[h]]=false;\r\n\t\t}while(stk[h--]!=u);\r\n\t}\r\n}\r\nvoid spfa(int x){//spfa\u8dd1\u6700\u957f\u8def\r\n\tregister int i,h=0,t=-1;\r\n\tq[++t]=x;\r\n\tdis[x]=ans[x];\r\n\tvis[x]=true;\r\n\twhile(h<=t){\r\n\t\tint u=q[h%mod];\r\n\t\th++;\r\n\t\tvis[u]=false;\r\n\t\tfor(i=0;i<f2[u].size();++i){\r\n\t\t\tint v=f2[u][i];\r\n\t\t\tif(dis[v]<dis[u]+ans[v]){\r\n\t\t\t\tdis[v]=dis[u]+ans[v];\r\n\t\t\t\tif(!vis[v]){\r\n\t\t\t\t\tvis[v]=true;\r\n\t\t\t\t\tt++;\r\n\t\t\t\t\tq[t%mod]=v;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tfor(i=1;i<=cl;++i){\r\n\t\tMax(anss,dis[i]);\r\n\t}\r\n\treturn;\r\n}\r\nvoid init(){\r\n\tregister int i;\r\n\tn=read();qs=read();\r\n\tfor(i=1;i<=n;++i){\r\n\t\ta[i]=read();\r\n\t}\r\n\ta[0]=a[n+1]=2147483647;\r\n\tscanf(\"%s\",str+1);\r\n\tfor(i=1;i<=n;++i){\r\n\t\tf[0].push_back(i);//\u865a\u70b9\u5411\u6240\u6709\u70b9\u8fde\u8fb9\r\n\t\tif(a[i]>=a[i-1]){\r\n\t\t\tf[i].push_back(i-1);\r\n\t\t}\r\n\t\tif(a[i]>=a[i+1]){\r\n\t\t\tf[i].push_back(i+1);\r\n\t\t}\r\n\t\tif(str[i]=='T'){\r\n\t\t\tf[i].push_back(0);//\u6709\u8e66\u5e8a\u7684\u70b9\u5411\u865a\u70b9\u8fde\u8fb9\r\n\t\t}\r\n\t}\r\n\ttrj(0);\r\n\tfor(i=1;i<=n;++i){\r\n\t\tif(!dfn[i]){\r\n\t\t\ttrj(i);\r\n\t\t}\r\n\t\t++ans[scc[i]];\r\n\t} \r\n\tint az=0;\r\n\tfor(i=1;i<=n;++i){//\u904d\u5386\u6240\u6709\u7684\u8fb9\r\n\t\tfor(int j=0;j<f[i].size();j++){\r\n\t\t\tp[++az].x=scc[i],p[az].y=scc[f[i][j]];\r\n\t\t}\r\n\t}\r\n\tsort(p+1,p+az+1,cmp);//\u7ed9\u8fb9\u6392\u5e8f\r\n\tfor(i=1;i<=az;++i){\r\n\t\tif(p[i].x==p[i-1].x&&p[i].y==p[i-1].y)continue;//\u53bb\u91cd\r\n\t\tif(p[i].x!=p[i].y){\r\n\t\t\tf2[p[i].x].push_back(p[i].y);//\u5efa\u8fb9\r\n\t\t}\r\n\t}\r\n\treturn ;\r\n}\r\nint main(){\r\n\tinit();\r\n\tspfa(scc[qs]);\r\n\tprintf(\"%d\",anss);\r\n\treturn 0;\r\n}\r\n```\r\n\r\n",
        "postTime": 1668830045,
        "uid": 557468,
        "name": "yuqihao",
        "ccfLevel": 5,
        "title": "P4611 [COI2012] TRAMPOLIN \u9898\u89e3"
    },
    {
        "content": "## \u7f29\u70b9 + \u4e71\u641e\n\n### [\u9898\u76ee\u94fe\u63a5](https://www.luogu.org/problemnew/show/P4611)\n\n### *Simplified Discription*\n> + \u7ed9\u4f60\u4e00\u4e2a\u6709\u5411\u56fe(\u6709\u73af)\n  \n> + \u6709\u7684\u70b9\u53ef\u4ee5\u5230\u8fbe\u4efb\u4f55\u4e00\u4e2a\u70b9(\u53ef\u4ee5\u5efa\u4e00\u4e2a\u865a\u70b9, \u5411\u6240\u6709\u70b9\u8fde\u8fb9)\n\n> + \u95ee\u7ed9\u5b9a\u7684 *K* \u70b9\u6700\u591a\u53ef\u4ee5\u5230\u8fbe\u54ea\u4e9b\u70b9\n\n### *Solution*\n\n> +\t\u56e0\u4e3a\u6709\u73af\u6240\u4ee5\u8fd9\u9053\u9898\u7528\u56fe\u8bba\u7b97\u6cd5\u5e76\u4e0d\u597d\u5199\n\n> + \u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u7f29\u70b9(\u628a\u53ef\u4ee5\u76f8\u4e92\u62b5\u8fbe\u7684\u70b9\u7f29\u6210\u4e00\u4e2a\u70b9)\n\n> + \u865a\u70b9\u5411\u6240\u6709\u70b9\u8fde\u8fb9\n\n> + \u6bcf\u4e2a\u70b9\u5411\u4e24\u8fb9\u53ef\u5230\u8fbe\u7684\u70b9\u8fde\u8fb9, \u5982\u679c\u53ef\u5230\u865a\u70b9, \u5c31\u518d\u8fde\u4e00\u6761\u901a\u5f80\u865a\u70b9\u7684\u8fb9\n\n> + \u7f29\u70b9\u4e4b\u540e\u53bb\u91cd\u8fb9\u539f\u56fe\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a *Dag* \u7136\u540e\u5c31\u53ef\u4ee5~~\u5f00\u5fc3\u5730~~\u4e71\u641e\u4e86\u266a(^\u2207^*)\n\n> + \u5927\u5bb6\u53ef\u4ee5\u8003\u8651\u4e00\u4e0b\u7f29\u70b9\u540e\u600e\u4e48\u5199, \u60f3\u5b8c\u4e4b\u540e\u518d\u770b\u770b\u4e0b\u9762\n\n### *In Addition*\n\n> + \u6ca1\u5b66\u8fc7Tarjan\u7f29\u70b9\u7684\u4eba\u53ef\u4ee5\u53bb\u5b66\u4e00\u4e0b\n ***[Link](https://www.luogu.org/problemnew/show/P3387)***\n \n> + \u6700\u597d\u5b66\u4e60\u4e00\u4e0b *topo* \u6392\u5e8f ~~\u867d\u7136\u8fd9\u9898\u5e76\u6ca1\u6709\u4ec0\u4e48ruan\u7528\u800c\u4e14\u8fd8\u4f1a *WA*~~\n\n> + \u8fd9\u9898\u627e\u6700\u5927\u53ef\u5230\u70b9\u4e0d\u80fd\u7528 *topo* \u6392\u5e8f, \u56e0\u4e3a\u53ef\u80fd\u4f1a\u6709 **\u4e00\u4e9b\u70b9** \u4e0d\u7528\u5230\u8fbe, \u5374\u5bf9 **\u8981\u5230\u8fbe\u7684\u70b9** \u7684 *deg* (\u5165\u5ea6) \u6709\u8d21\u732e\n\n> + \u6240\u4ee5\u5f97\u7528Spfa\u7b97\u6cd5\u6765\u6c42\u89e3 *Ans*\n\n### Code\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define MaxN 300003\n\nint N, K, Ans;\nint hi[MaxN], dfn[MaxN], low[MaxN], col[MaxN], val[MaxN], totcol;\nint fir[MaxN], nxt[MaxN << 2], to[MaxN << 2], cnt;\nint deg[MaxN], dp[MaxN];\nchar jump[MaxN];\nstruct Edge {\n\tint u, v;\n}e[MaxN << 2];\n\n//pre\ninline int Rd() {\n\tint x = 0; char ch = getchar();\n\twhile(ch < '0' || ch > '9') ch = getchar();\n\twhile(ch >= '0' && ch <= '9') x = x * 10 + ch - '0', ch = getchar();\n\treturn x;\n}\ninline void add(int u, int v) {\n\tnxt[++cnt] = fir[u], to[cnt] = v, fir[u] = cnt;\n\treturn;\n}\ninline void ChkMin(int &A, int B) {\n\tif(A > B) A = B;\n\treturn;\n}\ninline void ChkMax(int &A, int B) {\n\tif(A < B) A = B;\n\treturn;\n}\ninline bool cmp(Edge A, Edge B) {\n\treturn (A.u == B.u) ? A.v < B.v : A.u < B.u;\n}\n\n//init\nint stk[MaxN], top, tim;\nbool vis[MaxN];\nvoid Tarjan(int str) { // Tarjan \u7f29\u70b9\n\tdfn[str] = low[str] = ++tim;\n\tstk[++top] = str, vis[str] = true;\n\tfor(register int i = fir[str]; i; i = nxt[i]) {\n\t\tif(dfn[to[i]] == 0) {\n\t\t\tTarjan(to[i]), ChkMin(low[str], low[to[i]]);\n\t\t}\n\t\telse if(vis[to[i]] == 1) {\n\t\t\tChkMin(low[str], dfn[to[i]]);\n\t\t}\n\t}\n\tif(dfn[str] == low[str]) {\n\t\t++totcol;\n\t\tdo {\n\t\t\tcol[stk[top]] = totcol, vis[stk[top]] = false;\n\t\t} while(stk[top--] != str);\n\t}\n\treturn;\n}\nvoid init() {\n\tregister int i;\n\tN = Rd(), K = Rd();\n\tfor(i = 1; i <= N; ++i)\n\t\thi[i] = Rd();\n\n\thi[0] = hi[N + 1] = 2147483647;\n\tscanf(\"%s\", jump + 1);\n\tfor(i = 1; i <= N; ++i) { // \u5efa\u56fe\n\t\tadd(0, i), e[cnt].u = 0, e[cnt].v = i;\n\t\tif(hi[i] >= hi[i - 1])\n\t\t\tadd(i, i - 1), e[cnt].u = i, e[cnt].v = i - 1;\n\t\tif(hi[i] >= hi[i + 1])\n\t\t\tadd(i, i + 1), e[cnt].u = i, e[cnt].v = i + 1;\n\t\tif(jump[i] == 'T')\n\t\t\tadd(i, 0), e[cnt].u = i, e[cnt].v = 0;\n\t}\n\n\t// Tarjan\u7f29\u70b9 + \u53bb\u91cd\u8fb9\u6784\u56fe\n\tTarjan(0);\n\tfor(i = 1; i <= N; ++i) {\n\t\tif(dfn[i] == 0)\n\t\t\tTarjan(i);\n\t\t++val[col[i]];\n\t}\n\t\n\tfor(i = 1; i <= cnt; ++i)\n\t\te[i].u = col[e[i].u], e[i].v = col[e[i].v];\n\t\t\tsort(e + 1, e + 1 + cnt, cmp);\n\n\tint tmp = cnt;\n\t\tcnt = 0, memset(fir, 0, sizeof fir);\n\tfor(i = 1; i <= tmp; ++i) {\n\t\tif(e[i].u == e[i - 1].u && e[i].v == e[i - 1].v) continue; \n\t\tif(e[i].u != e[i].v)\n\t\t\tadd(e[i].u, e[i].v), ++deg[e[i].v];\n\t}\n\treturn;\n}\n\n//solve\nint Que[MaxN]; // \u624b\u6253\u961f\u5217 233\nvoid Spfa(register int str) { // Spfa \u6c42\u89e3 Ans\n\tregister int i, head = 0, tail = -1;\n\tQue[++tail] = str, vis[str] = 1, dp[str] = val[str];\n\twhile(head <= tail) {\n\t\tstr = Que[head % MaxN], vis[str] = 0;\n\t\tfor(i = fir[str]; i; i = nxt[i]) {\n\t\t\tif(dp[to[i]] < dp[str] + val[to[i]]) {\n\t\t\t\tdp[to[i]] = dp[str] + val[to[i]];\n\t\t\t\tif(!vis[to[i]]) \n\t\t\t\t\tQue[(++tail) % MaxN] = to[i], vis[to[i]] = 1;\n\t\t\t}\n\t\t} ++head;\n\t}\n\tfor(i = 1; i <= totcol; ++i)\n\t\tChkMax(Ans, dp[i]);\n\treturn;\n}\n\nint main() {\n\tinit();\n\tSpfa(col[K]);\n\tprintf(\"%d\\n\", Ans);\n\treturn 0;\n}\n```\n\n### \u4e0e\u5176\u8bf4\u662f\u540e\u8bb0, \u4e0d\u5982\u8bf4\u662f\u4e00\u4e9b\u611f\u609f\n\n> \u6211\u8001\u65e9\u4e4b\u524d\u6253\u4e86\u8fd9\u9053\u9898, \u7528\u7684\u8d2a\u5fc3 + \u6a21\u62df, \u53ea\u6709 10 ~ 50 pts\n\n> \u540e\u6765\u5b66\u4e86\u4e00\u4e9b\u7b97\u6cd5, \u56de\u5934\u505a\u4e86\u8fd9\u9053\u9898, \u611f\u89c9\u8fd9\u9053\u9898\u771f\u7684\u4e0d\u9519(\u597d\u9898 !)\n\n> \u6240\u4ee5\u5927\u5bb6\u505a\u4e00\u9053\u9898\u8981\u591a\u53bb\u60f3\u4e0d\u540c\u7684\u5199\u6cd5, \u4e0d\u8981\u88ab\u4e00\u4e9b\u4e1c\u897f\u675f\u7f1a\u4f4f\u4e86\u601d\u7ef4\n\n> \u6700\u540e\u653e\u4e0a\u6211\u7684\u505a\u8fd9\u9053\u9898\u7684\u8bb0\u5f55 ***[Link](https://www.luogu.org/recordnew/lists?uid=88471&pid=P4611&status=&sort=0)***\n\n#### \u5f97\u5206\u8bb0\u5f55\n\n> \u778e\u641e *10* \u5206\n\n> \u8d2a\u5fc3\u6253\u6302 *50* \u5206\n\n> \u7f29\u70b9 + topo\u6392\u5e8f *90* \u5206\n\n> \u7f29\u70b9 + Spfa *Ac*",
        "postTime": 1554430777,
        "uid": 88471,
        "name": "Lskkkno1",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4611 \u3010[COCI2011-2012#7] TRAMPOLIN\u3011"
    },
    {
        "content": "### \u9898\u610f\n\n\u4e00\u4e2a\u4eba\u4ece $k$ \u53f7\u697c\u5f00\u59cb\u5411\u76f8\u90bb\u7684\u4e14\u6bd4\u5f53\u524d\u77ee\u7684\u5927\u697c\u8df3\uff08\u5982\u679c\u5f53\u524d\u697c\u6ca1\u6709\u8e66\u5e8a\u4e14\u76f8\u90bb\u7684\u697c\u90fd\u6bd4\u5f53\u524d\u9ad8\u5c31\u505c\u6b62\u4e86\uff09\uff0c\u82e5\u8df3\u81f3\u4e00\u4e2a\u6709\u8e66\u5e8a\u7684\u697c\uff0c\u5c31\u53ef\u4ee5\u8df3\u5411\u4efb\u610f\u4e00\u697c\uff0c\u95ee\u8fd9\u4eba\u80fd\u5230\u8fbe\u591a\u5c11\u9ad8\u697c\u3002\n### \u89e3\u9898\n#### \u89e3\u6cd5\u4e00\u3001\n\u8e66\u5e8a\u80af\u5b9a\u662f\u8981\u7528\u7684\uff08\u56e0\u4e3a\u8e66\u5e8a\u53ef\u4ee5\u591a\u53bb\u4e00\u4e9b\u697c\uff0c\u8e66\u5e8a\u95f4\u53ef\u4ee5\u76f8\u4e92\u5230\u8fbe\uff09\uff0c\u90a3\u4e48\u73b0\u5728\u6765\u8003\u8651\u8e66\u5e8a\u53ef\u4ee5\u600e\u4e48\u8df3\u3002\n\n**1.\u5982\u679c $k$ \u53f7\u697c\u5230\u4e0d\u4e86\u8e66\u5e8a\uff0c\u90a3\u5c31\u627e\u6700\u957f\u7684\u4e00\u6bb5\u5f80\u4e0b\u8df3\u5427\u3002**\n\n**2.\u5982\u679c $k$ \u53f7\u697c\u80fd\u5230\u8e66\u5e8a\uff0c\u90a3\u8e66\u5e8a\u600e\u4e48\u8df3\uff1f**\n\n\u770b\u4e0b\u56fe\uff08\u624b\u6296\u6c42\u539f\u8c05\uff09\n![\u80fd\u8df3\u5230\u8e66\u5e8aT\u7684\u697c](https://cdn.luogu.com.cn/upload/image_hosting/wibmbw2u.png)\n\n\u8e66\u5e8a\u53f3\u8fb9\u8fd9\u4e00\u6bb5\u7eff\u8272\u7684\uff08\u65e2\u80fd\u8df3\u81f3\u8e66\u5e8a\u7684\u9ad8\u697c\uff09\u90fd\u80fd\u4f7f\u7528\u5230\u8e66\u5e8a\uff0c\u90a3\u4e48\u6211\u4eec\u90fd\u53ef\u4ee5\u628a\u7eff\u8272\u8fd9\u4e00\u6bb5\u770b\u6210\u8e66\u5e8a\u3002\n\n\u5982\u679c\u662f\u4ee5\u4e0b\u8fd9\u79cd\u60c5\u51b5\uff0c\u7eff\u8272\u8fd9\u4e00\u6bb5\u4f9d\u65e7\u53ef\u4ee5\u4f7f\u7528\u5230\uff08\u8df3\u5230\uff09\u8e66\u5e8a\u3002\n![\u7eff\u8272\u8fd9\u4e00\u6bb5\u4f9d\u65e7\u53ef\u4ee5\u4f7f\u7528\u5230\u8e66\u5e8a](https://cdn.luogu.com.cn/upload/image_hosting/8xjzruyd.png)\n\n\u4f60\u53ef\u4ee5\u5148\u8df3\u81f3\u8e66\u5e8a\uff0c\u518d\u4f7f\u7528\u8e66\u5e8a\u8df3\u81f3\u6700\u9ad8\u70b9\uff0c\u7136\u540e\u518d\u8df3\u4e0b\u6765\uff0c\u56e0\u6b64\u8e66\u5e8a\u53ef\u4ee5\u8986\u76d6\u5230\u7eff\u8272\u8fd9\u4e00\u6bb5\u3002\n\n\u4e8e\u662f\u8fd9\u4e00\u6bb5\u7eff\u8272\u7684\u90fd\u53ef\u7d2f\u52a0\u5230\u7b54\u6848\u91cc\u3002\n![](https://cdn.luogu.com.cn/upload/image_hosting/09125dot.png)\n\u5982\u56fe\uff0c\u6211\u4eec\u5148\u7d2f\u52a0\u80fd\u8df3\u5230\u8e66\u5e8a\u7684\u3002\n>> \u8df3\u5b8c\u7eff \u2461 \u8fd9\u4e00\u6bb5\uff0c\u518d\u901a\u8fc7\u8e66\u5e8a\u8df3\u81f3\u7eff \u2460 \u8fd9\u4e00\u6bb5\uff0c\u518d\u8df3\u81f3\u7eff \u2462 \u8fd9\u4e00\u6bb5\u3002\n\n\n\u6700\u540e\u518d\u8df3\u81f3\u67d0\u4e00\u70b9\u9009\u62e9\u6700\u957f\u7684\u4e00\u6bb5\u7c89\u8272\u8df3\uff08\u6ce8\u610f\u8fd9\u4e00\u6bb5\u4e0d\u80fd\u5305\u542b\u80fd\u7528\u8e66\u5e8a\u7684\uff0c\u5426\u5219\u4f1a\u91cd\u590d\u7b97\uff09\u3002\n\n**\u5177\u4f53\u505a\u6cd5**\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,k,a[300005],b[300005],c[300005],ans1,ans2;\nstring s,ss;\nint main()\n{\n\tcin>>n>>k;\n\tfor(int i=1;i<=n;i++)\n\t\tcin>>a[i];\n\tcin>>s;\n\ts=\" \"+s;//\u4e0b\u6807\u4ece1\u5f00\u59cb\n\tfor(int i=2;i<=n;i++)\n\t\tif(a[i]>=a[i-1])\n\t\t{\n\t\t\tb[i]=b[i-1]+1;//\u5411\u5de6\u80fd\u5230\u54ea\u513f\n\t\t\tif(s[i-1]=='T') s[i]='T';//\u5982\u679c\u80fd\u5230\u8e66\u5e8a\uff0c\u90a3\u4e48\u5b83\u5c31\u5f53\u4f5c\u8e66\u5e8a\u7528\n\t\t}\n\tfor(int i=n-1;i>0;i--)\n\t\tif(a[i]>=a[i+1])\n\t\t{\n\t\t\tc[i]=c[i+1]+1;//\u5411\u53f3\u80fd\u5230\u54ea\u513f\n\t\t\tif(s[i+1]=='T') s[i]='T';//\u5982\u679c\u80fd\u5230\u8e66\u5e8a\uff0c\u90a3\u4e48\u5b83\u5c31\u5f53\u4f5c\u8e66\u5e8a\u7528\n\t\t}\n\tif(s[k]=='T')k\u80fd\u5230\u8e66\u5e8a\n\t{\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tif(s[i]=='T') ans1++;//\u8e66\u5e8a\u90fd\u53ef\u4ee5\u8df3\u5230\n\t\t\telse ans2=max(ans2,max(b[i],c[i])+1);//\u8df3\u4e0d\u5230\u8e66\u5e8a\u5c31\u9009\u6700\u957f\u4e00\u6bb5\u6700\u540e\u6765\u8df3\n         //\u6ce8\u610fb[i]\u548cc[i]\u9700\u8981\u53d6max\u800c\u4e0d\u662f\u52a0\u8d77\u6765\uff08\u4e00\u53bb\u4e0d\u56de\u5934\uff09\n\t\t}\n\t\tcout<<ans1+ans2<<endl;\n\t}\n\telse \n\t{\n\t\tans1=ans2=k;\n\t\twhile(ans1>1 && a[ans1]==a[ans1-1]) ans1--;\n\t\twhile(ans2<n && a[ans2]==a[ans2+1]) ans2++;\n\t\tcout<<max(c[ans1],b[ans2])+1<<endl;//\u5411\u5de6\u62d3\u5c55\u6216\u8005\u5411\u53f3\u62d3\u5c55\n\t}\n\treturn 0;\n} \n```\n#### \u89e3\u6cd5\u4e8c\u3001\n\u521a\u5f00\u59cb\u60f3\u5230\u7684\u662f\u7f29\u70b9\uff0c\u4f46\u662f\u5982\u679c\u6bcf\u4e2a\u8e66\u5e8a\u90fd\u5411\u5176\u5b83\u70b9\u8fde\u8fb9\uff0c\u8fde\u8fb9\u90fd\u7528\u53bb $O(n^2)$ \u4e86\uff0c\u4f1a T\u3002\n\n\u4e8e\u662f\u770b\u5230\u9898\u89e3\u533a\u6709\u5927\u4f6c\u5efa\u7acb\u4e00\u4e2a\u865a\u70b9\uff0c\u865a\u70b9\u8fde\u5411\u6240\u6709\u70b9\uff0c\u8fd9\u6837\u4e4b\u540e\u628a\u8e66\u5e8a\u8fde\u5411\u865a\u70b9\uff0c\u5c31\u76f8\u5f53\u4e8e\u628a\u8e66\u5e8a\u8fde\u5411\u6240\u6709\u70b9\uff0c\u65b9\u4fbf\u5feb\u6377\u3002",
        "postTime": 1629426535,
        "uid": 67912,
        "name": "\u767d\u53b6\u51af\u5f13\u543f\u6c35",
        "ccfLevel": 6,
        "title": "P4611 [COI2012] TRAMPOLIN \u9898\u89e3"
    },
    {
        "content": "\u5982\u679c\u53ef\u4ee5\uff0c\u5c3d\u53ef\u80fd\u7ecf\u8fc7\u6240\u6709\u8e66\u5e8a\n\n\u53ea\u8981\u5230\u8fbe\u4e00\u4e2a\u8e66\u5e8a\uff0c\u90a3\u4e48\u5c31\u80fd\u5230\u8fbe\u6240\u6709\u8e66\u5e8a\n\n\u6682\u4e14\u5148\u4e0d\u8003\u8651\u9ad8\u5ea6\u76f8\u5e73\u7684\u60c5\u51b5\uff0c\u90a3\u4e48\u5fc5\u5b9a\u5f62\u5982\n\n![\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0](https://img-blog.csdnimg.cn/20201106171646519.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01vZGVzdENvZGVyXw==,size_16,color_FFFFFF,t_70#pic_center)\n\n\u5047\u8bbe\u6211\u73b0\u5728\u6b63\u5728$a$\u8e66\u5e8a\uff0c\u6211\u53ef\u4ee5\u8df3\u5230$d$\uff0c\u518d\u56de\u5230$a$\n\n\u5047\u8bbe\u6211\u73b0\u5728\u6b63\u5728$b$\u8e66\u5e8a\uff0c\u6211\u53ef\u4ee5\u5148\u8df3\u5230$e$\uff0c\u518d\u56de\u5230$b$\uff0c\u518d\u8df3\u5230$c$\uff0c\u518d\u56de\u5230$b$\n\n\u5047\u8bbe\u6211\u73b0\u5728\u6b63\u5728$c$\u8e66\u5e8a\uff0c\u6211\u4ec0\u4e48\u4e5f\u5e72\u4e0d\u4e86\n\n\u8fd9\u6837\u6211\u5c31\u628a\u8e66\u5e8a\u7684\u4e09\u79cd\u4f4d\u7f6e\u60c5\u51b5\u7684\u64cd\u4f5c\u65b9\u6cd5\u641e\u6e05\u695a\u4e86\n\n![\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0](https://img-blog.csdnimg.cn/20201106171933282.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01vZGVzdENvZGVyXw==,size_16,color_FFFFFF,t_70#pic_center)\n\u5982\u679c\u8e66\u5e8a\u5728\u4e00\u6bb5\u659c\u5761\u4e2d\uff0c\u53ef\u4ee5\u8df3\u5230\u65c1\u8fb9\u7684\u9ad8\u5cf0\uff0c\u5728\u56de\u6765\uff08\u8e66\u5e8a\u5728\u9876\u5cf0\u7684\u60c5\u51b5\u5f52\u4e8e\u6b64\uff09\n\n\u5982\u679c\u8e66\u5e8a\u5728\u8c37\u5e95\u5904\uff0c\u53ef\u4ee5\u5206\u522b\u5f80\u4e24\u8fb9\u7684\u9ad8\u5cf0\u8df3\uff0c\u518d\u8df3\u56de\u6765\n\n\u7136\u540e\u8ba8\u8bba\u8d77\u70b9\n![\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0](https://img-blog.csdnimg.cn/20201106172246677.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01vZGVzdENvZGVyXw==,size_16,color_FFFFFF,t_70#pic_center)\n\u5982\u679c\u8d77\u70b9\uff0c\u80fd\u8dd1\u5230\u8e66\u5e8a\uff0c\u5c31\u8dd1\u5411\u8e66\u5e8a\n\n\u56e0\u4e3a\uff0c\u53ea\u8981\u5230\u8fbe\u4e86\u8e66\u5e8a\uff0c\u5c31\u53ef\u4ee5\u8e66\u5e8a\u8fde\u51fb\u4e86\n\n\n\u4f46\u662f\u5982\u679c\u8d77\u70b9\u5230\u4e0d\u4e86\u8e66\u5e8a\uff0c\u90a3\u5c31\u53ea\u80fd\u5f80\u4e24\u8fb9\u770b\u770b\uff0c\u80fd\u8d70\u591a\u8fdc\n\n\n\u6211\u9700\u8981\u5904\u7406\u51fa\uff0c\u6bcf\u4e2a\u70b9\uff0c\u5f80\u5de6\u3001\u5f80\u53f3\uff0c\u4e00\u76f4\u4e0a\u5c71\u3001\u4e0b\u5c71\u80fd\u8d70\u591a\u8fdc\n\n\u7136\u540e\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8e66\u5e8a\uff0c\u4ece\u5b83\u65c1\u8fb9\u7684\u9ad8\u5cf0\u8dd1\u5230\u5b83\u7684\u8fd9\u4e00\u6bb5\u70b9\u533a\u95f4\u8986\u76d61\uff0c\u8868\u793a\u6211\u8d70\u8fc7\u4e86\n\n\u90fd\u505a\u597d\u4e4b\u540e\uff0c\u6211\u73b0\u5728\u7ad9\u5728\u6700\u540e\u4e00\u4e2a\u8e66\u5e8a\uff0c\u53ef\u4ee5\u8df3\u5411\u67d0\u4e00\u4e2a\u9ad8\u5cf0\uff0c\u518d\u5f80\u67d0\u4e00\u4e2a\u65b9\u5411\u8dd1\u5230\u6700\u4f4e\u5904\n![\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0](https://img-blog.csdnimg.cn/20201106172928677.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L01vZGVzdENvZGVyXw==,size_16,color_FFFFFF,t_70#pic_center)\n\u84dd\u7ebf\u662f\u5df2\u7ecf\u8986\u76d6\u7684\uff0c\u6bcf\u6761\u7eff\u7ebf\u51cf\u53bb\u84dd\u7ebf\u4e2d\u53d6\u6700\u5927\u503c\uff0c\u8fd9\u90e8\u5206\u662f\u7ebf\u6bb5\u6811\u7684\u7528\u5904\n\n\u6700\u540e\uff0c\u5982\u679c\u6709\u9ad8\u5ea6\u76f8\u540c\u7684\u600e\u4e48\u529e\uff0c\u53ef\u4ee5\u591a\u5f00\u4e2a\u6570\u7ec4\u5b58\u50a8\u4e00\u4e0b\n\n\u8fd9\u4e2a\u601d\u8def\u975e\u5e38\u66b4\u529b\uff0c\u8c28\u614e\u53c2\u8003\n\nCode\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define maxn 300010\n#define ls rt << 1\n#define rs rt << 1 | 1\nusing namespace std;\nint n, st, a[maxn], b[maxn], cnt[maxn], peakl[maxn], peakr[maxn], bottoml[maxn], bottomr[maxn], samel[maxn], samer[maxn];\nint tag[maxn << 2], ans;\nstruct Seg{\n\tint l, r, sum;\n}seg[maxn << 2];\n\ninline int read(){\n\tint s = 0, w = 1;\n\tchar c = getchar();\n\tfor (; !isdigit(c); c = getchar()) if (c == '-') w = -1;\n\tfor (; isdigit(c); c = getchar()) s = (s << 1) + (s << 3) + (c ^ 48);\n\treturn s * w;\n}\n\ninline int Read(){\n\tchar c = getchar();\n\tfor (; c != '.' && c != 'T'; c = getchar());\n\treturn c == 'T';\n}\n\nvoid pushup(int rt){ seg[rt].sum = seg[ls].sum + seg[rs].sum; }\n\nvoid pushdown(int rt){\n\ttag[ls] = tag[rs] = 1;\n\tseg[ls].sum = seg[ls].r - seg[ls].l + 1;\n\tseg[rs].sum = seg[rs].r - seg[rs].l + 1;\n}\n\nvoid build(int rt, int l, int r){\n\tseg[rt].l = l, seg[rt].r = r;\n\tif (l == r) return;\n\tint mid = (l + r) >> 1;\n\tbuild(ls, l, mid); build(rs, mid + 1, r);\n}\n\nvoid update(int rt, int l, int r){\n\tif (seg[rt].l > r || seg[rt].r < l) return;\n\tif (seg[rt].l >= l && seg[rt].r <= r){\n\t\tseg[rt].sum = seg[rt].r - seg[rt].l + 1;\n\t\ttag[rt] = 1;\n\t\treturn;\n\t}\n\tif (tag[rt]) pushdown(rt);\n\tupdate(ls, l, r), update(rs, l, r);\n\tpushup(rt);\n}\n\nint query(int rt, int l, int r){\n\tif (seg[rt].l > r || seg[rt].r < l) return 0;\n\tif (seg[rt].l >= l && seg[rt].r <= r) return seg[rt].r - seg[rt].l + 1 - seg[rt].sum;\n\tif (tag[rt]) pushdown(rt);\n\treturn query(ls, l, r) + query(rs, l, r);\n\tpushup(rt);\n}\n\nint main(){\n\tn = read(), st = read();\n\tfor (int i = 1; i <= n; ++i) a[i] = read();\n\tfor (int i = 1; i <= n; ++i) b[i] = Read(), cnt[i] = cnt[i - 1] + b[i];\t\n\tpeakl[1] = bottoml[1] = samel[1] = 1;\n\tint PEAK = 1, BOTTOM = 1;\n\tfor (int i = 2; i <= n; ++i){\n\t\tif (a[i] <= a[i - 1]) peakl[i] = PEAK;\n\t\telse peakl[i] = PEAK = i;\n\t\tif (a[i] >= a[i - 1]) bottoml[i] = BOTTOM;\n\t\telse bottoml[i] = BOTTOM = i;\n\t\tif (a[i] == a[i - 1]) samel[i] = samel[i - 1];\n\t\telse samel[i] = i;\n\t}\t\n\tpeakr[n] = bottomr[n] = samer[n] = n;\n\tPEAK = BOTTOM = n;\n\tfor (int i = n - 1; i; --i){\n\t\tif (a[i] <= a[i + 1]) peakr[i] = PEAK;\n\t\telse peakr[i] = PEAK = i;\n\t\tif (a[i] >= a[i + 1]) bottomr[i] = BOTTOM;\n\t\telse bottomr[i] = BOTTOM = i;\n\t\tif (a[i] == a[i + 1]) samer[i] = samer[i + 1];\n\t\telse samer[i] = i;\n\t}\n\tif (cnt[bottomr[st]] - cnt[bottoml[st] - 1] == 0){\n\t\tprintf(\"%d\\n\", max(bottomr[st] - samel[st] + 1, samer[st] - bottoml[st] + 1));\n\t\treturn 0;\n\t}\n\tbuild(1, 1, n);\n\tfor (int i = 1; i <= n; ++i)\n\t\tif (b[i]){\n\t\t\tint L = peakl[i], R = peakr[i];\n\t\t\tif (L < i && R > i) continue;\n\t\t\tif (L < i) update(1, L, i); else update(1, i, R);\n\t\t}\n\t\t\n\tfor (int i = 1; i <= n; ++i)\n\t\tif (b[i]){\n\t\t\tint L = peakl[i], R = peakr[i];\n\t\t\tupdate(1, L, R);\n\t\t}\n\tint ansl = 0, ansr = 0;\n\tfor (int i = 1; i <= n; ++i)\n\t\tif (a[peakl[i]] == a[i] && a[peakr[i]] == a[i]){\n\t\t\tif (query(1, bottoml[i], i) > ans)\n\t\t\t\tans = query(1, bottoml[i], i), ansl = bottoml[i], ansr = i;\n\t\t\tif (query(1, i, bottomr[i]) > ans)\n\t\t\t\tans = query(1, i, bottomr[i]), ansl = i, ansr = bottomr[i];\n\t\t}\n\tupdate(1, ansl, ansr);\n\tprintf(\"%d\\n\", n - query(1, 1, n));\n\treturn 0;\n}\n```\n",
        "postTime": 1604655264,
        "uid": 51719,
        "name": "ModestCoder_",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4611 \u3010[COI2012] TRAMPOLIN\u3011"
    },
    {
        "content": "\u5b89\u5229\u4e00\u4e0b[blog](https://blog.csdn.net/xumingyang0/article/details/80673735)\n[\u9898\u76ee](https://www.luogu.org/problemnew/show/P4611)\n#\u9898\u89e3\uff1a\n\u6a21\u62df\u9898\uff0cO(n)\n\u82e5i\u53ef\u4ee5\u8df3\u5230i-1\uff0c\u4e14i-1\u6709\u8e66\u5e8a\uff0c\u8bf4\u660ei\u4e5f\u53ef\u4ee5\u8df3\u5230\u6240\u6709\u70b9\uff0c\u76f8\u5f53\u4e8ei\u4e5f\u6709\u8e66\u5e8a\uff0ci+1\u540c\u7406\nle[i]\u8868\u793a\u4ecei\u5f00\u59cb\u5f80\u5de6\u80fd\u8df3\u5230\u591a\u5c11\u4e2a\u70b9\uff0cri[i]\u8868\u793a\u5f80\u53f3\n#\u6807\u7a0b\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=300003;\nint n,m,i,le[N],ri[N],l,r,mx,T,h[N];\nchar s[N];\ninline char gc(){\n    static char buf[100000],*p1=buf,*p2=buf;\n    return p1==p2&&(p2=(p1=buf)+fread(buf,1,100000,stdin),p1==p2)?EOF:*p1++;\n}\n#define gc getchar\ninline int read(){\n    int x=0,fl=1;char ch=gc();\n    for (;ch<48||ch>57;ch=gc())if(ch=='-')fl=-1;\n    for (;48<=ch&&ch<=57;ch=gc())x=(x<<3)+(x<<1)+(ch^48);\n    return x*fl;\n}\nint main(){\n\tn=read();m=read();\n\tfor (i=0;i<n;i++) h[i]=read();\n\tscanf(\"%s\",s);\n\tfor (i=1;i<n;i++)\n\t\tif (h[i]>=h[i-1]){\n\t\t\tif (s[i-1]=='T') s[i]='T';\n\t\t\tle[i]=le[i-1]+1;\n\t\t}\n\tfor (i=n-2;i>=0;i--)\n\t\tif (h[i]>=h[i+1]){\n\t\t\tif (s[i+1]=='T') s[i]='T';\n\t\t\tri[i]=ri[i+1]+1;\n\t\t}\n\tm--;\n\tif (s[m]=='T'){\n\t\tfor (i=0;i<n;i++)\n\t\t\tif (s[i]=='T') T++;\n\t\t\telse mx=max(mx,max(le[i],ri[i])+1);//\u662fmax\uff0c\u4e0d\u662f\u52a0\uff0c\u5f88\u591a\u4eba\u4f1a\u4e60\u60ef\u6027\u5199\u6210\u52a0\n\t\tprintf(\"%d\",T+mx);\n\t}else{\n\t\tl=r=m;\n\t\twhile (l && h[l-1]==h[m]) l--;\n\t\twhile (r<n-1 && h[r+1]==h[m]) r++;\n\t\tprintf(\"%d\",r-l+1+max(le[l],ri[r]));\n\t}\n}\n```",
        "postTime": 1528850874,
        "uid": 22469,
        "name": "Mingoal",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P4611 \u3010[COCI2011-2012#7] TRAMPOLIN\u3011"
    },
    {
        "content": "### \u9898\u610f\n\u7ed9\u5b9a $n$ \u4e2a\u6709\u5e8f\u7684\u6570\u5b57\uff0c\u548c\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5b57\u7b26\u4e32 $s$\uff0c\u5f00\u59cb\u5728\u7b2c $k$ \u4e2a\u6570\u5b57\u4e0a\uff0c\u5f53 $s[i]==T$ \u65f6\uff0c\u53ef\u4ee5\u5230\u4efb\u610f\u4f4d\u7f6e\uff0c$s[i]==.$ \u65f6\uff0c\u53ea\u80fd\u9009\u62e9\u8d70\u5230\u6bd4\u81ea\u5df1\u5c0f\u7684\u76f8\u90bb\u4f4d\u7f6e\uff0c\u6c42\u53ef\u5230\u8fbe\u4f4d\u7f6e\u7684\u6700\u5927\u503c\n\n### \u89e3\u9898\u601d\u8def\n\u4ee5\u6837\u4f8b $2$ \u4e3a\u4f8b\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/t336hyno.png)\n\n\u7528\u4e24\u4e2a\u6570\u7ec4 $sum1,sum2$ \u5206\u522b\u5b58\u5411\u53f3\u8d70\u548c\u5411\u5de6\u8d70\u6700\u5927\u4f4d\u7f6e\u6570\uff0c\u7528 $tag$ \u6570\u7ec4\u5b58\u662f\u5426\u78b0\u5230 $T$\n\n$sum1=\\{0,0,0,0,1,2,0,0,1,2\\}$\n\n$sum2=\\{4,3,2,1,0,2,1,0,0,0\\}$\n\n$tag=\\{1,1,1,0,0,1,0,0,0,0\\}$\n\n\u6b64\u5904 $sum1,sum2$ \u6570\u7ec4\u5747\u4e0d\u542b\u81ea\u8eab\n\n\u4e0b\u9762\u5206\u4e24\u7c7b\n\n#### $tag[k]$ \u4e3a1\u3010\u5373\u4ece\u5f00\u59cb\u70b9\u80fd\u78b0\u5230 $T$\u3011\n\u6240\u6709 $tag$ \u503c\u4e3a $1$ \u7684\u70b9\u90fd\u80fd\u8d70\u5230\uff0c\u518d\u52a0\u4e0a $tag$ \u503c\u4e0d\u4e3a $1$ \u70b9\u80fd\u8d70\u5230\u7684\u6700\u5927\u4f4d\u7f6e\uff0c\u5373\n$$\nans=\\sum^n_{i=1}tag[i]+\\max_{tag[i]==0}(sum1[i],sum2[i])\n$$\n\n#### $tag[k]$ \u4e0d\u4e3a1\u3010\u5373\u4ece\u5f00\u59cb\u70b9\u4e0d\u80fd\u78b0\u5230 $T$\u3011\n\u5148\u5411\u4e24\u8fb9\u8d70\uff0c\u76f4\u5230\u9047\u5230\u548c $a[k]$ \u4e0d\u540c\u7684\u4f4d\u7f6e\uff0c\u4ee4 $l$ \u4e3a\u5de6\u8fb9\u754c\uff0c$r$ \u4e3a\u53f3\u8fb9\u754c\uff0c\u8f93\u51fa $\\max(sum1[l],sum2[r])$\n\n**\u3010\u5177\u4f53\u7ec6\u8282\u8bf7\u770b\u4ee3\u7801\u3011**\n### \u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\n#define N 300010\n\nusing namespace std;\n\nint n,m,a[N],tag[N],sum1[N],sum2[N],ans,sum;\nchar c;\n\ninline int read()\n{\n\tint __=0,___=1;\n\tchar _=getchar();\n\tfor (;_<'0' || _>'9';_=getchar()) if (_=='-') ___=-1;\n\tfor (;_>='0' && _<='9';_=getchar()) __=(__<<1)+(__<<3)+_-'0';\n\treturn __*___;\n}\n\nint main()\n{\n\tn=read(),m=read();\n\tfor (int i=1;i<=n;i++) a[i]=read();\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tc=getchar();\n\t\twhile (c!='.' && c!='T') c=getchar();\n\t\tif (c=='T') tag[i]=1;\n\t}\n\tfor (int i=2;i<=n;i++)\n\t\tif (a[i]>=a[i-1]) sum1[i]=sum1[i-1]+1,tag[i]=tag[i-1]|tag[i];\n\tfor (int i=n-1;i;i--)\n\t\tif (a[i]>=a[i+1]) sum2[i]=sum2[i+1]+1,tag[i]=tag[i+1]|tag[i];\n\\\\\u5904\u7406sum1,sum2,tag\u6570\u7ec4\n\tif (!tag[m])\t\t\\\\\u5f53\u524d\u4f4d\u7f6e\u4e0d\u80fd\u78b0\u5230T\n\t{\n\t\tint l=m,r=m;\n\t\tfor (;l>1 && a[l]==a[m];l--);\n\t\tfor (;r<n && a[r]==a[m];r++);\n\t\tif (a[l]!=a[m]) l++;\n\t\tif (a[r]!=a[m]) r--;     \\\\\u8fc7\u8fb9\u754c\u65f6l,r\u8981\u8fd4\u56de\u5230\u4e0ea[m]\u76f8\u7b49\u7684\u6700\u8fdc\u4f4d\u7f6e\n\t\tprintf(\"%d\\n\",max(sum1[r],sum2[l])+1);  \\\\sum1,sum2\u6570\u7ec4\u4e0d\u542b\u81ea\u8eab\uff0c\u8f93\u51fa\u8981+1\n\t}\n\telse\n\t{\n\t\tfor (int i=1;i<=n;i++)\n\t\t\tif (tag[i]) ans++;\n\t\t\telse sum=max(sum,max(sum1[i],sum2[i])+1);\n\t\tprintf(\"%d\\n\",ans+sum);\n\t}    \\\\\u80fd\u78b0\u5230T\u7684\u60c5\u51b5\n\treturn 0;\n}\n```",
        "postTime": 1604633019,
        "uid": 67718,
        "name": "G\u6211\u5c31\u662f\u83dcG",
        "ccfLevel": 6,
        "title": "\u3010\u9898\u89e3\u3011P4611 [TRAMPOLIN]"
    },
    {
        "content": "\u57fa\u672c\u601d\u8def\u662ftarjan\u7f29\u70b9\uff0c\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u91cc\u7684\u6bcf\u4e00\u5bf9\u70b9\u90fd\u662f\u76f8\u4e92\u53ef\u8fbe\u7684\n\n\u4e4b\u540e\u91cd\u5efa\u56fe\uff0c\u539f\u56fe\u5c31\u53d8\u6210\u4e86\u4e00\u5f20\u6709\u5411\u65e0\u73af\u56fe\uff0c\u66b4\u529bdfs\u641e\u5c31\u53ef\u4ee5\uff0c\u751a\u81f3\u4e0d\u9700\u8981\u8bb0\u5fc6\u5316\n\n\u4f46\u6211\u603b\u89c9\u5f97\u6837\u4f8b\u4e8c\u6709\u95ee\u9898\uff0c~~\u56e0\u4e3a\u6211\u6ca1\u8fc7\u6837\u4f8b\u4e8c\u4f46\u662fAC\u4e86~~\n\n\u6ce8\u610f\u4e00\u4e2a\u5751\u70b9\uff1a\\\n\u5982\u679c\u4f60\u50cf\u6211\u4e00\u6837\u6dfb\u52a0\u4e86\u4e00\u4e2a\u8d85\u7ea7\u6e90\u70b9\u4f7f\u5f97\u5b83\u5230\u6240\u6709\u7684\u70b9\u90fd\u8fde\u6709\u4e00\u6761\u8fb9\uff0c\u90a3\u4e48\u4e00\u5b9a\u8981\u8bb0\u5f97\u8d85\u7ea7\u6e90\u70b9\u6240\u5728\u7684\u5f3a\u8fde\u901a\u5206\u91cf\u7684\u70b9\u4e2a\u6570\u8981\u51cf\u4e00\n\n**\u56e0\u4e3a\u8d85\u7ea7\u6e90\u70b9\u4e0d\u662f\u73b0\u5b9e\u7684\u70b9\uff0c\u5b83\u662f\u4e00\u4e2a\u201c\u865a\u70b9\u201d**\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u5feb\u4e50\u5730AC\u8fa3\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int maxn=300005;\n\nint n,k,a[maxn];\nvector<int> v[maxn],vv[maxn],scc[maxn];\nvector<pair<int,int>> save;\nchar ss[maxn];\nint dfn[maxn],low[maxn],timer=0,c[maxn],color=0,cnt[maxn];\nbool vis[maxn];\nstack<int> s;\nint ans=-0x3f3f3f3f;\n\nvoid tarjan(int x){\n\tdfn[x]=low[x]=++timer;\n\tvis[x]=1;\n\ts.push(x);\n\tfor(auto y:v[x]){\n\t\tif(!dfn[y]){\n\t\t\ttarjan(y);\n\t\t\tlow[x]=min(low[x],low[y]);\n\t\t}\n\t\telse if(vis[y])\n\t\t\tlow[x]=min(low[x],dfn[y]);\n\t}\n\tif(dfn[x]==low[x]){\n\t\tint t;\n\t\t++color;\n\t\twhile(s.top()!=x){\n\t\t\tt=s.top();\n\t\t\ts.pop();\n\t\t\tc[t]=color;\n\t\t\tscc[color].push_back(t);\n\t\t\tvis[t]=0;\n\t\t}\n\t\tt=s.top();\n\t\ts.pop();\n\t\tc[t]=color;\n\t\tscc[color].push_back(t);\n\t\tvis[t]=0;\n\t}\n}\n\nvoid build(){\n\tfor(auto x:save){\n\t\tif(c[x.first]!=c[x.second]){\n\t\t\tvv[c[x.first]].push_back(c[x.second]);\n\t\t}\n\t}\n\tfor(int i=1;i<=color;++i)\n\t\tcnt[i]=scc[i].size();\n\tcnt[c[0]]--;\n}\n\nvoid dfs(int x,int sum){\n\tans=max(ans,sum);\n\tfor(auto y:vv[x])\n\t\tdfs(y,sum+cnt[y]);\n}\n\nint main(){\n\tscanf(\"%d%d\",&n,&k);\n\tfor(int i=1;i<=n;++i)\n\t\tv[0].push_back(i);\n\tfor(int i=1;i<=n;++i)\n\t\tscanf(\"%d\",&a[i]);\n\tfor(int i=2;i<=n-1;++i){\n\t\tif(a[i]>=a[i-1]) v[i].push_back(i-1),save.emplace_back(i,i-1);\n\t\tif(a[i]>=a[i+1]) v[i].push_back(i+1),save.emplace_back(i,i+1);\t\n\t}\n\tif(a[1]>=a[2]) v[1].push_back(2),save.emplace_back(1,2);\n\tif(a[n]>=a[n-1]) v[n].push_back(n-1),save.emplace_back(n,n-1);\n\tscanf(\"%s\",ss+1);\n\tfor(int i=1;i<=n;++i)\n\t\tif(ss[i]=='T') v[i].push_back(0),save.emplace_back(i,0);\n\tfor(int i=0;i<=n;++i)\n\t\tif(!dfn[i]) tarjan(i);\n\tbuild();\n\tdfs(c[k],cnt[c[k]]);\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1569856068,
        "uid": 170866,
        "name": "oneman233",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P4611 \u3010[COCI2011-2012#7] TRAMPOLIN\u3011"
    }
]
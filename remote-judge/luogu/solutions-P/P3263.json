[
    {
        "content": "\u9996\u5148\u5f97\u51fa\uff0c$\\frac{b+\\sqrt d}{2}$\u548c$\\frac{b-\\sqrt d}{2}$\u662f\u4e00\u5143\u4e8c\u6b21\u65b9\u7a0b$x^2-bx+\\frac{b^2-d}{4}=0$\u7684\u4e24\u6839\u3002\n\n\u628a$x^2-bx+\\frac{b^2-d}{4}=0$\u79fb\u9879\u5f97$x^2=bx+\\frac{d-b^2}{4}$\u3002\n\n\u4e24\u8fb9\u540c\u4e58\u4ee5$x^{n-2}$\uff0c\u53ef\u4ee5\u5f97\u51fa\uff0c$x^n=bx^{n-1}+\\frac{d-b^2}{4}x^{n-2}$\u3002\n\n\u8bbe$f[i]=(\\frac{b+\\sqrt d}{2})^i+(\\frac{b-\\sqrt d}{2})^i$\uff0c\n\n\u6b64\u65f6\u5c31\u5bb9\u6613\u5f97\u51fa$f[i]$\u662f\u4e2a\u6574\u6570\uff0c\u5e76\u4e14\u9012\u63a8\u5f0f\u4e3a$f[i]=bf[i-1]+\\frac{d-b^2}{4}f[i-2]$\uff0c$f[0]=2,f[1]=b$\u3002\u8fd9\u65f6\u5019\u5c31\u80fd\u901a\u8fc7\u77e9\u9635\u4e58\u6cd5\u6c42\u5f97$f[n]$\uff08\u6ce8\u610f\uff0c\u76f8\u4e58\u4f1a\u7206long long\uff0c\u56e0\u6b64\u8981\u7528\u5feb\u901f\u4e58\uff09\u3002\n\n\u6700\u540e\u8003\u8651\u600e\u6837\u901a\u8fc7$f[n]$\u6c42\u5f97\u7ed3\u679c\u3002\u7531\u4e8e\u9898\u76ee\u9650\u5b9a$b^2\\leq d<(b+1)^2$\uff0c\u6240\u4ee5$n$\u662f\u5947\u6570\u65f6$-1<(\\frac{b-\\sqrt d}{2})^n\\leq0$\uff0c\u5426\u5219$n$\u662f\u5076\u6570\u65f6$0\\leq(\\frac{b-\\sqrt d}{2})^n<1$\u3002\u6240\u4ee5\u5982\u679c\u6ee1\u8db3$b^2\\neq d$\u5e76\u4e14$n$\u4e3a\u5076\u6570\uff0c\u5219\u7b54\u6848\u4e3a$f[n]-1$\uff0c\u5426\u5219\u7b54\u6848\u4e3a$f[n]$\u3002\n\n\u6ce8\u610f\u7279\u5224$n=0$\u65f6\u7ed3\u679c\u4e3a$1$\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\nll b, d, n, tm; const ll ZZQ = 7528443412579576937ll;\nll add(ll a, ll b) {\n    return (1ull * a + 1ull * b) % ZZQ;\n}\nll prod(ll a, ll b) {\n    ll res = 0;\n    while (b) {\n        if (b & 1) res = add(res, a);\n        a = add(a, a);\n        b >>= 1;\n    }\n    return res;\n}\nstruct cyx {\n    int n, m; ll v[4][4];\n    cyx() {}\n    cyx(int _n, int _m) :\n        n(_n), m(_m) {memset(v, 0, sizeof(v));}\n    friend inline cyx operator * (cyx a, cyx b) {\n        int i, j, k; cyx res = cyx(a.n, b.m);\n        for (i = 1; i <= res.n; i++) for (j = 1; j <= res.m; j++)\n        for (k = 1; k <= a.m; k++)\n            res.v[i][j] = add(res.v[i][j], prod(a.v[i][k], b.v[k][j]));\n        return res;\n    }\n    friend inline cyx operator ^ (cyx a, ll b) {\n        int i; cyx res = cyx(a.n, a.m);\n        for (i = 1; i <= res.n; i++) res.v[i][i] = 1;\n        while (b) {\n            if (b & 1) res = res * a;\n            a = a * a;\n            b >>= 1;\n        }\n        return res;\n    }\n} P, Q;\nint main() {\n    cin >> b >> d >> n; P = cyx(2, 2); Q = cyx(2, 1);\n    if (!n) return printf(\"1\\n\"), 0;\n    tm = (d >> 2) - prod(b + 1 >> 1, b - 1 >> 1);\n    P.v[1][1] = b; P.v[1][2] = tm; P.v[2][1] = 1;\n    Q.v[1][1] = b; Q.v[2][1] = 2; P = (P ^ n - 1) * Q;\n    ll ans = P.v[1][1]; if (d != b * b && !(n & 1)) ans--;\n    if (ans < 0) ans += ZZQ; cout << ans << endl;\n    return 0;\n}\n```",
        "postTime": 1512297982,
        "uid": 29936,
        "name": "xyz32768",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3263 \u3010[JLOI2015]\u6709\u610f\u4e49\u7684\u5b57\u7b26\u4e32\u3011"
    },
    {
        "content": "\u539f\u5f0f\u662f\u4e00\u5768\u96be\u770b\u7684\u4e1c\u897f,\u8003\u8651\u600e\u4e48\u7f8e\u5316\u5b83.\n\n\u5148\u4e0d\u7ba1\u4e0b\u53d6\u6574,\u6211\u4eec\u53ef\u4ee5\u7ed9\u5b83\u6dfb\u4e00\u9879,\u53d8\u6210 $(\\frac{b+\\sqrt{d}}{2})^n+(\\frac{b-\\sqrt{d}}{2})^n$,\u518d\u5728\u540e\u9762\u51cf\u53bb\u5b83\u5c31\u53ef\u4ee5\u4e86.\n\n\u7136\u540e\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u975e\u5e38\u7684\u597d,\u8bbe$A=(\\frac{b+\\sqrt{d}}{2}),B=(\\frac{b-\\sqrt{d}}{2})$,\u5219\u539f\u5f0f\u5c31\u53ef\u4ee5\u8868\u793a\u4e3a$A^n+B^n$.\n\n\u8003\u8651\u5982\u4f55\u9012\u63a8.\n$$A^n+B^n=(A^{n-1}+B^{n-1})(A+B)-A^{n-1}B-AB^{n-1}$$\n\u800c\n$$A^{n-1}B+AB^{n-1}=AB(A^{n-2}+B^{n-2})$$\n\u6240\u4ee5\u8bbe$f_n=A^n+B^n$,\u5219\n$$f_n=f_{n-1}(A+B)-f_{n-2}(AB)$$\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u7528\u77e9\u9635\u4e58\u6cd5\u52a0\u901f\u9012\u63a8\u4e86.\n\u4f46\u662f\u5f0f\u5b50\u4e2d\u7684\u6839\u53f7\u770b\u4f3c\u4f1a\u5f15\u5165\u6d6e\u70b9\u6570,\u5176\u5b9e\u4ed4\u7ec6\u89c2\u5bdf\u4e00\u4e0b:\n$$A+B=(\\frac{b+\\sqrt{d}}{2})+(\\frac{b-\\sqrt{d}}{2})=b$$\n$$AB=\\frac{b^2-d}{4}$$\n$A+B$ \u663e\u7136\u662f\u4e00\u4e2a\u6574\u6570,\u800c $AB$ \u56e0\u4e3a\u9898\u76ee\u6761\u4ef6\u4e2d $b\\ mod\\ 2=1,d\\ mod\\ 4=1$ ,\u6240\u4ee5 $AB$ \u540c\u6837\u662f\u4e00\u4e2a\u6574\u6570.\n\u522b\u5fd8\u4e86\u7b2c\u4e8c\u9879( $B$ )\u4f7f\u6211\u4eec\u6dfb\u4e0a\u53bb\u7684,\u6700\u540e\u8981\u51cf\u53bb.\u90a3\u4e48\u6211\u4eec\u6765\u8ba8\u8bba\u51cf\u53bb\u8fd9\u4e2a\u5f0f\u5b50\u7684\u5f71\u54cd.\n\u89c2\u5bdf$(\\frac{b-\\sqrt{d}}{2})^n$\u8fd9\u4e2a\u5f0f\u5b50,\u5b83\u7684\u5e95\u6570$\\frac{b-\\sqrt{d}}{2}$\u56e0\u4e3a\u9898\u76ee\u6761\u4ef6\u7684\u9650\u5236\u663e\u7136\u662f\u4e00\u4e2a\u5927\u4e8e $-1$ \u7684\u8d1f\u6570.\n\n\u5f53 $n$ \u662f\u5947\u6570\u7684\u65f6\u5019,\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u662f\u4e00\u4e2a\u5927\u4e8e$-1$\u7684\u8d1f\u5c0f\u6570.\u800c\u6211\u4eec\u51cf\u53bb\u4e00\u4e2a\u8d1f\u6570\u76f8\u5f53\u4e8e\u52a0\u4e0a\u4e00\u4e2a\u6b63\u6570,\u800c\u8fd9\u4e2a\u6b63\u6570\u53c8\u4e0d\u5927\u4e8e1,\u6240\u4ee5\u5c31\u4f1a\u88ab\u5f0f\u5b50\u4e2d\u7684\u4e0b\u53d6\u6574\u5403\u6389.\n\n\u800c\u5f53$n$ \u662f\u5076\u6570\u7684\u65f6\u5019,\u8fd9\u4e2a\u5f0f\u5b50\u53c8\u662f\u4e00\u4e2a\u5c0f\u4e8e $1$ \u7684\u975e\u8d1f\u6570, \u6240\u4ee5$b^2=d$ \u65f6,\u8fd9\u4e2a\u5f0f\u5b50\u7b49\u4e8e0,\u5bf9\u7b54\u6848\u6ca1\u6709\u5f71\u54cd,\u800c$b^2\\neq d$\u65f6,\u539f\u5f0f\u7684\u6574\u6570\u5e94\u8be5\u51cf\u53bb\u4e86\u4e00\u4e2a\u5c0f\u4e8e1\u7684\u6d6e\u70b9\u6570,\u518d\u4e0b\u53d6\u6574,\u5c31\u53d8\u6210\u4e86\u51cf\u4e00.\n\n\u6240\u4ee5\u5b83\u7684\u5f71\u54cd\u5728\u6700\u540e\u7edf\u8ba1\u4e00\u4e0b\u5373\u53ef.\n\n----------\n\n\u8d34\u4e0a\u4ee3\u7801:\n```\n#include<stdio.h>\n#include<cstdlib>\n#include<cstring>\n#define ll unsigned long long\n#define p 7528443412579576937ll\nusing namespace std;\ntypedef ll Mat[4][4];\nll b,d,n;\ninline ll add(ll a,ll b){a+=b;return a>=p?a-p:a;}\nll ksc(ll a,ll b){\n    ll ret=0;\n    while(b){\n        if(b&1)ret=add(ret,a);\n        b>>=1;\n        a=add(a,a);\n    }\n    return ret;\n}\ninline void Mulmat(Mat a,Mat b)\n{\n    Mat c;\n    c[1][1]=add(ksc(a[1][1],b[1][1]),ksc(a[1][2],b[2][1]));\n    c[1][2]=add(ksc(a[1][1],b[1][2]),ksc(a[1][2],b[2][2]));\n    c[2][1]=add(ksc(a[2][1],b[1][1]),ksc(a[2][2],b[2][1]));\n    c[2][2]=add(ksc(a[2][1],b[1][2]),ksc(a[2][2],b[2][2]));\n    memcpy(a,c,sizeof(c));\n}\nvoid solve()\n{\n    Mat a={0};\n    a[1][2]=(d-b*b)/4,a[2][1]=1,a[2][2]=b;\n    Mat s={0};\n    s[1][1]=1,s[2][2]=1;\n    int flag=(n&1);\n    while(n)\n    {\n        if(n&1) Mulmat(s,a);\n        Mulmat(a,a);\n        n>>=1;\n    }\n    ll ans=add(ksc(2,s[1][2]),ksc(b,s[2][2]));\n    if(d*d!=b&&flag) ans--; \n    printf(\"%lld\",ans);\n}\nint main()\n{\n    scanf(\"%lld%lld%lld\",&b,&d,&n);\n    n--;\n    if(n==-1) {printf(\"1\");return 0;}\n    solve();\n}\n```",
        "postTime": 1540741892,
        "uid": 20815,
        "name": "PhantasmDragon",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3263 \u3010[JLOI2015]\u6709\u610f\u4e49\u7684\u5b57\u7b26\u4e32\u3011"
    },
    {
        "content": "## \u9898\u610f\u63cf\u8ff0\n\n\u7ed9\u5b9a $b$\u3001$d$ \u548c $n$\u3002\n\n~~\u8bd5~~\u6c42\u51fa\uff1a\n\n$$\\left \\lfloor  \\left (    \\frac{b+\\sqrt{d} }{2}   \\right )^{n} \\right \\rfloor \\bmod{p} $$\n\n\u5176\u4e2d $p=7528443412579576937$\uff0c$0<b^{2} \\le d < (b+1)^{2}\\le 10^{18} $\uff0c$n\\le 10^{18}$ \u4e14 $b\\bmod{2}=1$\uff0c$d \\bmod{4}=1$\u3002\n\n## \u9898\u89e3\u62a5\u544a\n\u5f0f\u5b50\u8f83\u4e3a\u590d\u6742\uff0c\u770b\u4e86\u4e0b\u6807\u7b7e\u662f\u201c\u77e9\u9635\u4e58\u6cd5\u201d\uff0c\u66f4\u52a0\u8499\u4e86\u3002\uff08\u539f\u672c\u90fd\u6253\u7b97\u641e\u4e2a double \u7684\u77e9\u9635\u4e86\u3002\u3002\u3002\uff09\n\n\u60f3\u8981\u8ba9\u5f0f\u5b50\u4e0e\u77e9\u4e58\u6302\u4e0a\u94a9\uff0c\u9996\u5148\u60f3\u5230\u8981\u628a\u90a3\u4e2a\u6839\u53f7\u7ed9\u53bb\u6389\u3002\u4e8e\u662f\u60f3\u5230\u5728\u539f\u5f0f\u540e\u52a0\u4e00\u4e2a\u5f0f\u5b50\u4f7f\u4e24\u8005\u76f8\u52a0\u80fd\u5c06\u6839\u53f7\u53bb\u6389\u3002\n\n\u7531\u4e8e\u6709\u4e00\u4e2a $n$\uff0c\u53ef\u4ee5\u60f3\u5230\u5c06\u5e26\u6839\u53f7\u7684\u90a3\u4e00\u9879\u53d6\u8d1f\uff0c\u5176\u4ed6\u4e0d\u53d8\uff08\u6682\u4e0d\u8003\u8651\u53d6\u6a21\u548c\u5411\u4e0b\u53d6\u6574\uff09\uff0c\u7136\u540e\u539f\u5f0f\u53d8\u4e3a\uff1a\n\n$$  \\left (  \\frac{b-\\sqrt{d} }{2}  \\right )^{n}   $$\n\n\u5728\u539f\u5f0f\u540e\u52a0\u4e0a\u73b0\u5728\u8fd9\u4e2a\u5f0f\u5b50\u4fbf\u53ef\u5c06\u6839\u53f7\u6d88\u6389\uff0c\u5373\uff1a\n\n$$ \\left (  \\frac{b+\\sqrt{d} }{2}  \\right )^{n}+ \\left (  \\frac{b-\\sqrt{d} }{2} \\right )^{n} $$\n\n\u7136\u540e\u5728\u5f0f\u5b50\u6700\u540e\u51cf\u53bb\u4e00\u4e2a $\\left (  \\frac{b-\\sqrt{d} }{2} \\right )^{n}$ \u5c31\u597d\u4e86\u3002\n\n\u8bbe $x$ \u4e3a $\\frac{b+\\sqrt{d} }{2} $\uff0c$y$ \u4e3a $\\frac{b-\\sqrt{d} }{2} $\u3002\n\n\u8bbe $f_{n}=x^{n}+y^{n}$\u3002\n\n\u90a3\u4e48\u53ef\u4ee5\u8bbe\u6211\u4eec\u7684\u72b6\u6001\u77e9\u9635\u4e3a\uff1a\n\n$$\\begin{bmatrix}  f_{n}&f_{n-1} \\end{bmatrix}$$\n\n\u9700\u8981\u901a\u8fc7 $\\begin{bmatrix}  f_{n-1}&f_{n-2} \\end{bmatrix}$ \u8f6c\u79fb\u5230 $\\begin{bmatrix}  f_{n}&f_{n-1} \\end{bmatrix}$\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u5982\u4f55\u8f6c\u79fb\u3002\n\n\u5c06 $f_{n}$ \u62c6\u6210 $X\\times f_{n-1}-X\\times f_{n-2}$ \u7684\u5f62\u5f0f\uff0c\u53c8\u56e0\u4e3a $f_{n-1}=x^{n-1}+y^{n-1}$\uff0c$f_{n-2}=x^{n-2}+y^{n-2}$\uff0c\u4ee3\u5165\u5f97\uff1a \n\n$$X\\times \\left ( x^{n-1}+y^{n-1} \\right ) -X\\times \\left ( x^{n-2}+y^{n-2} \\right ) $$\n\n\u4e8e\u662f\u7a0d\u52a0\u8003\u8651\u5c31\u53ef\u4ee5\u5f97\u51fa\uff1a\n\n$$x^{n}+y^{n}=\\left ( x+y \\right ) \\times \\left ( x^{n-1}+y^{n-1} \\right ) - xy \\times \\left ( x^{n-2}+y^{n-2} \\right ) $$\n\n\u6240\u4ee5\u8f6c\u79fb\u5f0f\u4e3a\uff1a\n\n$$f_{n}=\\left ( x+y \\right ) \\times f_{n-1}- xy \\times f_{n-2}$$\n\n\u80fd\u4fdd\u8bc1\u8fd9\u4e2a\u5f0f\u5b50\u4e2d\u6ca1\u6709\u4efb\u4f55\u6d6e\u70b9\u6570\u5417\uff1f\n\n\u6211\u4eec\u53d1\u73b0 $f_{1}=\\frac{b+\\sqrt{d} }{2}+\\frac{b-\\sqrt{d} }{2}=b$\uff0c$f_{2}= \\left (  \\frac{b+\\sqrt{d} }{2}  \\right )^{2}+ \\left (  \\frac{b-\\sqrt{d} }{2} \\right )^{2} = \\frac{b^{2}+d }{2} $\u3002\n\n$b$ \u4e00\u5b9a\u662f\u6574\u6570\uff0c\u800c\u7531\u4e8e $b\\bmod{2}=1$\uff0c$d \\bmod{4}=1$\uff0c\u7531\u8d39\u9a6c\u5c0f\u5b9a\u7406\u53ef\u5f97 $b^{2}\\equiv b \\pmod{2}$\uff0c\u6240\u4ee5 $b^{2}+d \\bmod{2}=0$\uff0c\u6240\u4ee5 $ \\frac{b^{2}+d }{2} $ \u4e5f\u662f\u6574\u6570\u3002\n\n\u4e8e\u662f\u4e4e\uff0c$f_{1}$ \u548c $f_{2}$ \u90fd\u662f\u6574\u6570\uff0c\u63a5\u4e0b\u6765\u53ea\u9700\u8bc1\u660e\u51fa\u4ed6\u4fe9\u524d\u9762\u7684\u7cfb\u6570\u4e5f\u662f\u6574\u6570\u5c31\u597d\u4e86\u3002\n\n\u9996\u5148\u6613\u5f97 $x+y=b$\uff0c\u6240\u4ee5 $x+y$ \u662f\u6574\u6570\uff0c\u7136\u540e $xy=\\frac{b^{2}-d}{4}$\uff0c\u7531\u6b27\u62c9\u5b9a\u7406\u53ef\u5f97 $b^{\\varphi (4)}=b^{2}\\equiv 1\\pmod{4}$\uff0c\u53c8\u56e0\u4e3a $d \\bmod{4}=1$\uff0c\u6240\u4ee5 $\\left ( b^{2}-d \\right ) \\bmod 4=0$\uff0c\u6240\u4ee5 $xy$ \u4e3a\u6574\u6570\u3002\n\n\u7efc\u4e0a\uff0c$f_{n}$ \u603b\u4e3a\u6574\u6570\u3002\n\n\u6240\u4ee5\u8f6c\u79fb\u77e9\u9635\u4e5f\u540c\u65f6\u63a8\u51fa\u6765\u4e86\u3002\n\n\u5982\u4e0b\uff1a\n\n$$\\begin{bmatrix} b &1 \\\\ -\\frac{b^{2}-d}{4} &0\\end{bmatrix}$$\n\n\u8fd9\u91cc\u7684 $-\\frac{b^{2}-d}{4}$ \u4e3a\u4e86\u65b9\u4fbf\u53ef\u4ee5\u5199\u6210 $\\frac{d-b^{2}}{4}$\u3002\n\n\u6700\u540e\u518d\u6765\u770b\u770b\u521a\u624d\u8fd9\u4e2a\u4e1c\u897f\u5bf9\u7b54\u6848\u7684\u5f71\u54cd\uff1a\n\n>\u7136\u540e\u5728\u5f0f\u5b50\u6700\u540e\u51cf\u53bb\u4e00\u4e2a $\\left (  \\frac{b-\\sqrt{d} }{2} \\right )^{n}$ \u5c31\u597d\u4e86\u3002\n\n\u7531\u4e8e\u7b54\u6848\u662f\u5411\u4e0b\u53d6\u6574\uff0c\u6240\u4ee5\u5f53 $-\\left (  \\frac{b-\\sqrt{d} }{2} \\right )^{n}$ \u4e3a\u6b63\u4e14\u5927\u5c0f\u5728\u533a\u95f4 $\\left [ 0,1 \\right )$ \u65f6\u5bf9\u7b54\u6848\u65e0\u5f71\u54cd\u3002\n\n\u7531\u4e8e $0<b^{2} \\le d < (b+1)^{2}\\le 10^{18} $\uff0c\u6240\u4ee5 $\\left (  \\frac{b-\\sqrt{d} }{2} \\right )^{n}$ \u7684\u8303\u56f4\u4e00\u5b9a\u5728\u533a\u95f4 $\\left [ 0,1 \\right )$ \u5185\u3002\n\n\u63a5\u4e0b\u6765\u53ea\u8981\u8ba8\u8bba\u5f0f\u5b50\u7684\u6b63\u8d1f\u6027\u3002\n\n\u56e0\u4e3a $0<b^{2} \\le d $\uff0c\u6240\u4ee5 $ \\frac{b-\\sqrt{d} }{2}$ \u4e00\u5b9a\u5c0f\u4e8e 0\u3002\n\n\u5f53 $n \\bmod{2}=1$ \u65f6\uff0c\u5373 $n$ \u4e3a\u5947\u6570\u65f6\uff0c$-\\left (  \\frac{b-\\sqrt{d} }{2} \\right )^{n}$ \u4e00\u5b9a\u7684\u8303\u56f4\u4e00\u5b9a\u5728 $\\left [ 0,1 \\right )$ \u5185\uff0c\u5bf9\u7b54\u6848\u6ca1\u6709\u5f71\u54cd\u3002\n\n\u76f8\u53cd\uff0c\u5f53 $n \\bmod{2}=0$ \u65f6\uff0c$-\\left (  \\frac{b-\\sqrt{d} }{2} \\right )^{n}$ \u7684\u8303\u56f4\u5728\u533a\u95f4 $\\left ( -1,0 \\right ]$ \u5185\u3002\u5f53\u5f0f\u5b50\u7b49\u4e8e 0 \u65f6,\u5373 $b=\\sqrt{d}$\uff0c$b^{2}=d$ \u65f6\uff0c\u8be5\u5f0f\u5bf9\u7b54\u6848\u65e0\u5f71\u54cd\u3002\n\n\u7efc\u4e0a\uff0c\u5f53\u4e14\u4ec5\u5f53 $n$ \u4e3a\u5076\u6570\u4e14 $b^{2}\\ne d$ \u65f6\uff0c\u8be5\u5f0f\u5bf9\u7b54\u6848\u6709\u5f71\u54cd\uff0c\u7b54\u6848\u5411\u4e0b\u53d6\u6574\u540e\u7684\u503c\u9700\u8981\u51cf\u4e00\u3002\n\n\u8bf4\u4e86\u4e00\u5927\u5806\uff0c\u7ec8\u4e8e\u5230\u4e86\u5927\u5bb6\u6700\u7231\u7684\u4ee3\u7801\u65f6\u95f4\u3002\n\n## \u55f2\u5417\n```cpp\n#define int long long\n#define ull unsigned long long\n\nint tormul(int a, int k) \n{  //\u9f9f\u901f\u4e58\n\tull ans = 0;  //\u6ce8\u610f\u8981\u5f00 ull\uff0c\u5426\u5219\u4f1a TLE\uff01\uff01\uff08\u7384\u5b66 T\uff0c\u96be\u9053\u4e0d\u5e94\u8be5 WA \u5417\uff09\n\twhile (k) \n\t{\n\t\tif (k & 1)ans = (ans + a) % MOD;\n\t\ta = (ull)(a + a) % MOD;  //\u5f00 ull\u3002\n\t\tk >>= 1;\n\t}\n\treturn ans;\n}\nstruct mat \n{\n\tint a[2][2];\n\tmat() { memset(a, 0, sizeof a); }\n\tmat operator *(const mat &b)const \n\t{\n\t\tmat op;\n\t\tfor (int i = 0; i < 2; i++) \n\t\t\tfor (int k = 0; k < 2; k++) \n\t\t\t\tfor (int j = 0; j < 2; j++) \n\t\t\t\t\top.a[i][j] = (ull)(op.a[i][j] + tormul(a[i][k], b.a[k][j])) % MOD;  //ull\n\t\treturn op;\n\t}\n} ans, I;\nvoid init() \n{\n\tI.a[0][0] = b, I.a[0][1] = 1, I.a[1][0] = (d - b * b) / 4;\n\tans.a[0][0] = (b * b + d) / 2, ans.a[0][1] = b;\n}\nsigned main() \n{\n\tb = read(), d = read(), n = read();\n\tinit();\n\tif (n == 0ll) \n\t{\n\t\tprintf(\"1\");\n\t\treturn 0;\n\t} else if (n == 1ll) \n\t{\n\t\tprintf(\"%lld \", (int)((b + sqrt(d)) / 2) % MOD);\n\t\treturn 0;\n\t}\n\tn -= 2;\n\tint ff = 0; //\u7528\u6765\u5224\u65ad\u6700\u540e\u51cf\u53bb\u7684\u5f0f\u5b50\u5bf9\u7b54\u6848\u662f\u5426\u6709\u5f71\u54cd\u3002\n\tif (b * b != d && n % 2 == 0) ff--;\n\twhile (n) \n\t{\n\t\tif (n & 1)ans = ans * I;\n\t\tI = I * I;\n\t\tn >>= 1;\n\t}\n\tans.a[0][0] += ff;\n\tprintf(\"%lld \", ans.a[0][0]);\n\treturn 0;\n}\n```\n\u6709\u9519\u8bef\u8bf7 D \u6211",
        "postTime": 1629967447,
        "uid": 478449,
        "name": "Dumby_cat",
        "ccfLevel": 0,
        "title": "Luogu P3263 \u6709\u610f\u4e49\u7684\u5b57\u7b26\u4e32 \u9898\u89e3\u62a5\u544a"
    },
    {
        "content": "\u770b\u6765\u6211\u6570\u5b66\u8fd8\u662f\u592a\u5f31\u4e86\uff0c\u8fd9\u9053\u9898\u4e5f\u6ca1\u6709\u60f3\u5230\u3002\n\u6211\u4eec\u53d1\u73b0$(\\frac{b+\\sqrt d}{2})^n$\u662f\u4e2a\u65e0\u7406\u6570\uff0c\u800c\u4e14\u8fd9\u4e2a\u6570\u975e\u5e38\u5927\uff0c\u6240\u4ee5\u65e0\u6cd5\u76f4\u63a5\u8ba1\u7b97\u3002\u6211\u4eec\u53c8\u53d1\u73b0$(\\frac{b-\\sqrt d}{2})^n$\u7684\u503c\u867d\u7136\u662f\u4e2a\u65e0\u7406\u6570\uff0c\u4f46\u662f\u4ed6\u7684\u503c\u5411\u4e0b\u53d6\u6574\u4e4b\u540e\u975e\u5e38\u597d\u8ba1\u7b97\u3002\u7136\u540e\u6211\u4eec\u53c8\u53d1\u73b0\uff0c$(\\frac{b+\\sqrt d}{2})^n+(\\frac{b-\\sqrt d}{2})^n$\u662f\u4e2a\u6709\u7406\u6570\uff0c\u53c8\u56e0\u4e3a$b\\space mod\\space2=1,d\\space mod\\space4=1$\uff0c\u6240\u4ee5\u4e0d\u96be\u8bc1\u660e\u8fd9\u4e2a\u6570\u662f\u4e00\u4e2a\u6574\u6570\u3002\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u95ee\u9898\u8f6c\u53d8\u4e3a\u6c42$\\lfloor[(\\frac{b+\\sqrt d}{2})^n+(\\frac{b-\\sqrt d}{2})^n]-(\\frac{b-\\sqrt d}{2})^n\\rfloor$\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u95ee\u9898\u62c6\u6210\u4e24\u90e8\u5206\u3002\n\u9996\u5148\u6211\u4eec\u8003\u8651\u7b2c\u4e00\u90e8\u5206\u3002\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u4e00\u5143\u4e8c\u6b21\u65b9\u7a0b\uff1a$x^2-b+\\frac{b^2-d}{4}=0$\uff0c\u90a3\u4e48\u5b83\u7684\u89e3$x_1=\\frac{b+\\sqrt d}{2},x_2=\\frac{b-\\sqrt d}{2}$\u3002\n\u90a3\u4e48\u7b2c\u4e00\u90e8\u5206\u5c31\u7b49\u4e8e$x_1^n+x_2^n$\n\u7136\u540e\u6211\u4eec\u628a\u8fd9\u4e2a\u5f0f\u5b50\u53d8\u5f62\u4e00\u4e0b\u5c31\u53ef\u4ee5\u5f97\u5230\uff1a$x_1^n+x_2^n=(x_1+x_2)(x_1^{n-1}+x_2^{n-1})-x_1x_2(x_1^{n-2}+x_2^{n-2})$\n\u7136\u540e\u4ee4$F(n)=x_1^n+x_2^n$\uff0c\n\u53ef\u4ee5\u5f97\u5230$F(n)=(x_1+x_2)F(n-1)-x_1x_2F(n-2)$\n\u7136\u540e\u6211\u4eec\u6784\u9020\u7684\u4e00\u5143\u4e8c\u6b21\u65b9\u7a0b\u5c31\u6d3e\u4e0a\u7528\u573a\u4e86\uff01\n\u97e6\u8fbe\u5b9a\u7406\uff1a$$x_1+x_2=-\\frac{b}{a}$$$$x_1x_2=\\frac{c}{a}$$\n\u6240\u4ee5$F(n)=bF(n-1)+\\frac{d-b^2}{2}F(n-2)$\n\u5176\u4e2d$F(0)=2,F(1)=b$\n\u63a8\u5230\u8fd9\u91cc\u5c31\u662f\u975e\u5e38\u7ecf\u5178\u7684\u7684\u77e9\u4e58\u5feb\u901f\u9012\u63a8\u5566\uff01\n\u5bf9\u4e8e\u7b2c\u4e8c\u90e8\u5206\uff0c\n$\\because b^2\\leq d<(b+1)^2$\n\u53c8$\\because b,d\\in N$\n$\\therefore b\\leq\\sqrt d< b+1$\n$\\therefore \\frac{b-\\sqrt d}{2}\\in(-1,0]$\n\u4e0d\u96be\u53d1\u73b0\uff0c\u5f53\u4e14\u4ec5\u5f53$n$\u4e3a\u5947\u6570\u4e14$\\sqrt d!=b$\u65f6\uff0c\u8fd9\u4e00\u90e8\u5206\u5bf9\u7b54\u6848\u6709$-1$\u7684\u8d21\u732e\u3002\u6240\u4ee5\u6211\u4eec\u5224\u4e00\u4e0b\u662f\u5426\u51cf$1$\u5c31\u884c\u4e86\u3002\n\u6709\u4e00\u4e2a\u5751\u70b9\uff0c\u8fd9\u4e2a\u6a21\u6570\u975e\u5e38\u5927\uff0c\u52a0\u8d77\u6765\u53ef\u80fd\u4f1a\u7206$long\\space long$\uff0c\u6240\u4ee5\u6211\u4eec\u52a0\u7684\u65f6\u5019\u8981\u5224\u4e00\u4e0b\u5b83\u4eec\u7684\u548c\u662f\u5426\u5c0f\u4e8e$0$\u3002\n\u6ce8\u610f\u4e24\u4e2a\u6570\u76f8\u4e58\u4f1a\u7206$long\\space long$\uff0c\u6240\u4ee5\u8981\u7528\u5feb\u901f\u4e58\u3002\n\u5feb\u901f\u4e58\u5176\u5b9e\u4e3b\u8981\u5c31\u662f\u5229\u7528$long\\space double$\u7684\u8f83\u9ad8\u7684\u7cbe\u5ea6\uff0c\u518d\u5229\u7528\u6211\u4eec\u5c0f\u5b66\u5b66\u7684\u4e00\u4e2a\u4e1c\u897f\uff08\u88ab\u9664\u6570\u51cf\u9664\u6570\u4e58\u5546\u7b49\u4e8e\u4f59\u6570\uff09,\u5c31\u53ef\u4ee5\u5728$O(1)$\u7684\u65f6\u95f4\u5185\u5b8c\u6210\u8f83\u5927\u7684\u6570\u7684\u4e58\u6cd5\u5e76\u53d6\u6a21\u3002\n\u5982\u679c\u6709\u9519\u5728\u8bc4\u8bba\u533a\u543c\u4e00\u58f0\u54e6\uff01\n\u4ee3\u7801\uff1a\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\ntypedef long long ll;\nconst ll mod=7528443412579576937ll;\nll b,d,n;\nll Add(ll x,ll y){\n\treturn x+y>=mod||x+y<0?x+y-mod:x+y;\n}\nll Minus(ll x,ll y){\n\treturn x-y<0?x-y+mod:x-y;\n}\nll Mul(ll x,ll y){\n\tll d=(ll)(x*(long double)y/mod+0.5);\n\treturn Minus(x*y,d*mod);\n}\nstruct Matrix{\n\tll a[2][2];\n\tll *operator[](int b){\n\t\treturn a[b];\n\t}\n\tfriend Matrix operator*(Matrix A,Matrix B){\n\t\tMatrix ret;\n\t\tfor(int i=0;i<2;i++)\n\t\t\tfor(int j=0;j<2;j++){\n\t\t\t\tret[i][j]=0;\n\t\t\t\tfor(int k=0;k<2;k++)\n\t\t\t\t\tret[i][j]=Add(ret[i][j],Mul(A[i][k],B[k][j]));\n\t\t\t}\n\t\treturn ret;\n\t}\n\tMatrix operator*=(Matrix B){\n\t\t*this=*this*B;\n\t\treturn *this;\n\t}\n}A,B;\nMatrix qpow(Matrix x,ll n){\n\tMatrix ret;\n\tret[0][0]=ret[1][1]=1,ret[0][1]=ret[1][0]=0;\n\twhile(n){\n\t\tif(n&1ll)\n\t\t\tret*=x;\n\t\tx*=x;\n\t\tn>>=1ll;\n\t}\n\treturn ret;\n}\nint main(){\n\tscanf(\"%lld%lld%lld\",&b,&d,&n);\n\tif(!n){\n\t\tputs(\"1\");\n\t\treturn 0;\n\t}\n\tA[0][0]=b;\n\tA[0][1]=2;\n\tB[0][0]=b;\n\tB[0][1]=1;\n\tB[1][0]=(d-b*b)/4;\n\tA[1][0]=A[1][1]=B[1][1]=0;\n\tA*=qpow(B,n-1);\n\tprintf(\"%lld\",Minus(A[0][0],!(n&1ll)&&(d!=b*b)));\n\treturn 0;\n}\n```",
        "postTime": 1535379792,
        "uid": 49097,
        "name": "ezoiHQM",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3263 \u3010[JLOI2015]\u6709\u610f\u4e49\u7684\u5b57\u7b26\u4e32\u3011"
    },
    {
        "content": "\u9898\u76ee\u94fe\u63a5\uff1a[$\\texttt{Link}$](https://www.luogu.com.cn/problem/P3263)\n## $\\textbf{Description}$\n\u7ed9\u5b9a\u4e09\u4e2a\u6574\u6570 $b, d,n$\uff0c\u8bd5\u6c42\u51fa\n$$\\left\\lfloor{\\left(\\dfrac{b + \\sqrt d}{2} \\right)}^n\\right\\rfloor$$\n\n\u5176\u4e2d $1 < b^2\\leq d < (b+1)^2 \\le 10^{18}, 1\\le n\\le 10^{18}$\uff0c\n\n\u4e14 $b\\equiv1\\pmod2,d\\equiv1\\pmod4$\u3002\n\n## $\\textbf{Solution}$\n[\u672c\u9898\u5f31\u5316\u7248](https://www.luogu.com.cn/problem/P5136) \u4e0e [\u849f\u84bb\u5199\u7684\u9898\u89e3](https://www.luogu.com.cn/blog/2018-28/solution-p5136)\u3002\n\n\u548c P5136 \u7c7b\u4f3c\uff0c\u8003\u8651\u5176\u5171\u8f6d\u3002\u8bbe $x=\\dfrac{b+\\sqrt d}{2},y=\\dfrac{b-\\sqrt d}{2}$\u3002\n\n\u4e00\u4e2a\u663e\u7136\u7684\u601d\u8def\u662f\u6784\u9020 $F_n = x^n+y^n$\u3002\n\n$\\begin{aligned}F_n&=(x+y)(x^{n-1}+y^{n-1})-xy(x^{n-2}+y^{n-2})\\\\&=(x+y)F_{n-1}-xy\\times  F_{n-2}.\\end{aligned}$\n\n\u5c06 $x+y=b,xy=\\dfrac{b^2-d}{4}$ \u4ee3\u5165\u77e5 $F_n=b\\times F_{n-1} + \\dfrac{d - b^2}{4}\\times F_{n-2}$\u3002\n\n\u7136\u540e\u662f\u8f6c\u79fb\u77e9\u9635\u3002\u6211\u4eec\u9700\u8981\u901a\u8fc7 $\\begin{bmatrix}F_{n-1}&F_{n-2}\\end{bmatrix}$ \u63a8\u5f97 $\\begin{bmatrix}F_n &F_{n-1}\\end{bmatrix}$\u3002\n\n\u7ed3\u5408 $F_{n-1}=1\\times F_{n-1}+0\\times F_{n-2} $ \u624b\u63a8\u4e00\u4e0b\uff0c\u5f97\u5230\uff1a\n\n$\\begin{bmatrix}F_{n-1}&F_{n-2}\\end{bmatrix}\\times\\begin{bmatrix}b&1\\\\ \\frac{d-b^2}{4}&0\\end{bmatrix}=\\begin{bmatrix}F_n &F_{n-1}\\end{bmatrix}$\n\n\u4f46\u662f $\\dfrac{d-b^2}{4}$ \u662f\u5206\u6570\uff0c\u603b\u4e0d\u80fd\u5199\u4e00\u4e2a\u5e26 `double` \u7684\u77e9\u9635\u3002\n\n\u56de\u8fc7\u6765\u53d1\u73b0\u9898\u76ee\u4e2d\u6709\u4e24\u4e2a\u5947\u602a\u7684\u6761\u4ef6\uff0c\u628a\u5b83\u8f6c\u5316\u4e00\u4e0b\u5f97\u5230\uff1a\n\n$\\begin{cases}b\\equiv1\\pmod2 \\\\ d\\equiv1\\pmod4\\end{cases} \\Rightarrow \\begin{cases}b^2\\equiv1\\pmod4 \\\\ d\\equiv1\\pmod4\\end{cases} \\Rightarrow d-b^2\\equiv 0\\pmod4$\n\n\u5373 $4\\, |\\, d-b^2$\u3002\u7ed3\u5408 $b^2\\le d$ \u77e5 $\\dfrac{d-b^2}{4}\\in \\mathbb{N}$\u3002\u4e8e\u662f\u53ef\u4ee5\u653e\u5fc3\u7684\u628a\u5b83\u653e\u5230\u8f6c\u79fb\u77e9\u9635\u4e2d\u3002\n\n\u56de\u5230\u539f\u9898\u3002\u6211\u4eec\u9700\u8981\u6c42\u51fa $\\lfloor x^n\\rfloor=\\left\\lfloor F_n-y^n\\right\\rfloor$\u3002\n\n\u6839\u636e $b^2\\le d \\Rightarrow y\\in(-1,0]$\uff0c\u6211\u4eec\u5f97\u51fa\uff1a\n\n- \u5f53 $n$ \u4e3a\u5947\u65f6\uff0c$\\lfloor x^n\\rfloor=F_n$\uff1b\n\n- \u5f53 $n$ \u4e3a\u5076\u65f6\uff0c$\\lfloor x^n\\rfloor=F_n-[d=b^2]$\u3002\n\n\n\u5408\u8d77\u6765\u5c31\u662f $\\lfloor x^n\\rfloor=F_n-[d=b^2 \\text{ and } 2|n]$\u3002\n\n\u4e8e\u662f\u5c31\u53ef\u4ee5\u76f4\u63a5\u5199\u4ee3\u7801\u4e86\u3002\n\n## $\\textbf{Extra}$\n\n- \u4e24\u4e2a `long long` \u76f8\u4e58\u4f1a\u70b8\u3002\u5e94\u7528\u5feb\u901f\u4e58\u6216 `__int128`\u3002\n\n- \u53d6\u6a21\uff0c\u53d6\u6a21\uff0c\u53d6\u6a21\u3002\n\n- \u7279\u5224 $n=0 \\text{ or } n=1$\u3002\n\n- \u521d\u59cb\u77e9\u9635 $\\begin{bmatrix}F_1&F_2 \\end{bmatrix}=\\begin{bmatrix}b&\\dfrac{b^2 + d}{2}\\end{bmatrix}$\u3002\n\n\n\u6ce8\u610f\u6837\u4f8b\u4e0d\u7b26\u5408\u6570\u636e\u8303\u56f4\u4e2d\u7684 $d< (b+1)^2$\uff0c\u4e0d\u8fc7\u5bf9\u6211\u7684\u4ee3\u7801\u4f3c\u4e4e\u6ca1\u6709\u5f71\u54cd\uff1f\n\n\n## $\\textbf{AC Code}$\n```cpp\n#include <bits/stdc++.h>\ntypedef long long i64;\ntypedef __int128 i128;\nconst i64 p = 7528443412579576937ll;\n\n// FastIO...\n\nstruct Matrix {\n    i128 a[2][2];\n    Matrix() {memset(a, 0, sizeof(a));}\n    Matrix operator * (const Matrix& mat) {\n        Matrix res;\n        for(int i = 0; i < 2; i++) {\n            for(int k = 0; k < 2; k++) {\n                for(int j = 0; j < 2; j++) {\n                    res.a[i][j] += a[i][k] * mat.a[k][j];\n                    res.a[i][j] %= p;\n                }\n            }\n        } return res;\n    }\n}ans, base;\n\ninline i64 cal(i64 b, i64 d) {\n\treturn (i64)((b + sqrt(d)) / 2) % p;\n}\n\ninline void init(i64 b, i64 d) {\n    base.a[0][0] = b, base.a[0][1] = 1;\n    base.a[1][0] = d - b * b >> 2, base.a[1][1] = 0;\n    ans.a[0][0] = b * b + d >> 1, ans.a[0][1] = b;\n    ans.a[1][0] = 0, ans.a[1][1] = 0;\n}\n\ninline i128 solve(i64 b, i64 d, i64 n) {\n    int f = ~(n -= 2) & 1 && d != b * b;\n    for(init(b, d); n; n >>= 1) {\n        if(n & 1) ans = ans * base;\n        base = base * base;\n    } return (ans.a[0][0] - f + p) % p;\n}\n\ni64 b, d, n;\nsigned main() {\n    read(b), read(d), read(n);\n    if(n == 0) return puts(\"1\"), 0;\n\tif(n == 1) return write(cal(b, d)), 0;\n\twrite(solve(b, d, n));\n    return 0;\n}\n```",
        "postTime": 1677907988,
        "uid": 498779,
        "name": "Matrix_mlt",
        "ccfLevel": 4,
        "title": "P3263 [JLOI2015]\u6709\u610f\u4e49\u7684\u5b57\u7b26\u4e32 \u9898\u89e3"
    },
    {
        "content": "\u62ff\u5230\u9898\u76ee\uff0c\u6211\u4eec\u9996\u5148\u5206\u6790\u4e00\u4e0b\u8fd9\u4e2a\u5947\u602a\u7684\u5f0f\u5b50\uff1a\n\n$$\\lfloor(\\frac{b+\\sqrt{d}}{2})^n \\rfloor ~\\text{mod}~p$$\n\n\u91cd\u70b9\u80af\u5b9a\u662f\u5728\u91cc\u9762\u7684\u90a3\u4e2a\u5f0f\u5b50\u91cc\u9762\uff0c\u6700\u663e\u773c\u7684\u80af\u5b9a\u4e5f\u5c31\u662f\u90a3\u4e2a $\\sqrt{d}$\uff0c\u6839\u636e\u6574\u4f53\u5f62\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u8054\u7cfb\u4e00\u5143\u4e8c\u6b21\u65b9\u7a0b\u7684\u6c42\u6839\u516c\u5f0f $x=-\\dfrac{-b \\pm \\sqrt{b^2-4ac}}{2a}$\uff0c\u8fd9\u91cc\u4e5f\u662f\u4e00\u4e2a\u6839\u53f7\uff0c\u5e76\u4e14\u548c\u6211\u4eec\u8981\u6c42\u7684\u6781\u4e3a\u76f8\u4f3c\u3002\u4e8e\u662f\u4e4e\u6211\u4eec\u5c1d\u8bd5\u7740\u5c06\u539f\u5f0f\u8f6c\u6362\u6210\u4e00\u4e2a\u65b9\u7a0b\u7684\u6839\u3002\u8bbe\u539f\u65b9\u7a0b\u4e3a $Ax^2+Bx+C=0$\uff0c\u6839\u636e\u5bf9\u7167\u53ef\u4ee5\u5217\u51fa\u65b9\u7a0b\uff1a\n\n$$\\begin{cases} 2A=2\\\\ -B=b \\\\B^2-4AC=d \\end{cases}$$\n\n\u89e3\u5f97\uff1a\n\n$$\\begin{cases} A=1\\\\ B=-b \\\\ C=\\dfrac{b^2-d}{4} \\end{cases}$$\n\n\u56e0\u6b64\u539f\u65b9\u7a0b\u8f6c\u53d8\u6210\u4e86\uff1a$x^2-bx+\\dfrac{b^2-d}{4}=0$\u3002\u7531\u4e8e\u6bcf\u4e00\u9879\u7684\u6b21\u6570\u5448\u9012\u51cf\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u79fb\u9879\uff0c\u770b\u770b\u662f\u5426\u4f1a\u5f62\u6210\u4e00\u4e2a\u8f6c\u79fb\u5f0f\u5b50\uff1a\n\n$$x^2=bx-\\dfrac{b^2-d}{4}$$\n\n\u8fd9\u4e2a\u975e\u5e38\u660e\u663e\uff0c\u662f\u4e2a\u6807\u51c6\u7684\u8f6c\u79fb\u5f0f\u5b50\u3002\u8fd9\u4e2a\u65f6\u5019\u5c31\u53ef\u4ee5\u60f3\u5230\u6734\u7d20 DP \u5927\u6cd5\uff0c\u6309\u7167\u6b21\u6570\u8bbe\u8ba1\u72b6\u6001\uff0c\u7136\u540e\u6839\u636e\u524d\u9762\u7684\u6b21\u6570\u8fdb\u884c\u8f6c\u79fb\u3002\n\n\u4f46\u539f\u65b9\u7a0b\u4f1a\u6709\u4e24\u4e2a\u6839\uff0c\u5c31\u662f $\\dfrac{b\\pm \\sqrt{d}}{2}$\u3002\u6240\u4ee5\u76f4\u63a5\u7684\u8f6c\u79fb\u4f1a\u5305\u62ec $\\dfrac{b-\\sqrt{d}}{2}$ \u5e26\u6765\u7684\u5f71\u54cd\u503c\u3002\u90a3\u4e48\u6211\u4eec\u9700\u8981\u5c06 DP \u8fdb\u884c\u5408\u7406\u7684\u5b9a\u4e49\u3002\u8bbe $dp_n$ \u8868\u793a $(\\dfrac{b+\\sqrt{d}}{2})^n+(\\dfrac{b-\\sqrt{d}}{2})^n$ \u7684\u503c\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u53ea\u9700\u8981\u62ff $dp_n$ \u51cf\u53bb $(\\dfrac{b-\\sqrt{d}}{2})^n$ \u7684\u5f71\u54cd\u503c\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u8f7b\u677e\u5199\u51fa\u8f6c\u79fb\u5f0f\u5b50\uff1a\n\n$$dp_{i}=b\\times dp_{i-1}-\\dfrac{b^2-d}{4}\\times dp_{i-2}$$\n\n\u4f46\u662f\u7531\u4e8e\u8fd9\u4e2a\u6b21\u6570\u8d85\u51fa\u4e86 `int` \u8303\u56f4\uff0c\u6240\u4ee5\u8003\u8651\u8fdb\u884c\u4f18\u5316\uff0c\u8fd9\u79cd\u5bf9\u6781\u5927 $n$ \u7684\u4f18\u5316\uff0c\u6211\u4eec\u4e0d\u96be\u60f3\u5230\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\u3002\u6211\u4eec\u628a\u8f6c\u79fb\u65b9\u7a0b\u7b49\u53f7\u53f3\u8fb9\u6d89\u53ca\u5230\u7684\u53d8\u91cf\u63d0\u53d6\u51fa\u6765\uff1a$dp_{i-1}$\uff0c$dp_{i-2}$\uff0c\u56e0\u6b64\u521d\u59cb\u77e9\u9635\u662f\u4e00\u4e2a $1\\times 2$ \u7684\u77e9\u9635 \uff0c\u800c\u5bf9\u5e94\u7684\u5e38\u6570\u9879\u5c31\u662f $b$ \u548c $\\dfrac{b^2-d}{4}$\uff0c\u6240\u4ee5\u8f6c\u79fb\u77e9\u9635\u662f\u4e00\u4e2a $2\\times 2$ \u7684\u77e9\u9635\u3002\u521d\u59cb\u77e9\u9635 $st$ \u548c\u8f6c\u79fb\u77e9\u9635 $a$ \u5982\u4e0b\uff1a\n\n$$\nst=\n\\left(\n\\begin{matrix}\ndp_{i-1} & dp_{i-2}\n\\end{matrix}\n\\right)\n$$\n\n$$\na=\n\\left(\n\\begin{matrix}\nb & 1 \\\\\n-\\dfrac{b^2-d}{4} & 0\n\\end{matrix}\n\\right)\n$$\n\n$st$ \u7684\u521d\u59cb\u5316\u5c31\u662f $n=1$ \u548c $n=0$ \u7684\u60c5\u51b5\u3002\n\n\u7136\u540e\u6211\u4eec\u7a81\u7136\u53d1\u73b0\u4e00\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u51cf\u53bb\u7684 $(\\dfrac{b-\\sqrt{d}}{2})^n$ \u662f\u4e00\u4e2a\u5e26\u6839\u53f7\u7684\u5f0f\u5b50\uff0c\u6211\u4eec\u8be5\u5982\u4f55\u6c42\u51fa\u8fd9\u4e2a\u5411\u4e0b\u53d6\u6574\u7684\u503c\u5462\uff1f\n\n\u5c31\u5728\u4e00\u7b79\u83ab\u5c55\u4e4b\u9645\uff0c\u90a3\u4e2a\u4eae\u773c\u7684\u6570\u636e\u8303\u56f4\u6620\u5165\u773c\u5e18\uff1a$b^2\\leq d<(b+1)^2$\u3002\u6211\u4eec\u5c1d\u8bd5\u5c06 $\\sqrt{d}$ \u5e26\u5165\u8fdb\u53bb\uff0c$b\\leq \\sqrt{d} < b+1$\u3002\u6240\u4ee5 $-1< \\dfrac{b-\\sqrt{d}}{4}\\leq 0$\u3002\n\n\u7531\u4e8e $|\\dfrac{b-\\sqrt{d}}{4}|<1$\uff0c$n$ \u662f\u4e2a\u975e\u8d1f\u6574\u6570\uff0c\u6240\u4ee5 $0\\leq |(\\dfrac{b-\\sqrt{d}}{2})^n|<1$\uff0c\u6b64\u65f6\u8fdb\u884c\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n- \u5982\u679c $b-\\sqrt{d}=0$\uff0c\u5219 $(\\dfrac{b-\\sqrt{d}}{2})^n=0$\uff0c\u5411\u4e0b\u53d6\u6574\u4e3a $0$\u3002\n\n- \u5982\u679c $b-\\sqrt{d}<0$\uff0c\u4e14 $2\\mid n$\uff0c\u6b64\u65f6\u539f\u5f0f\u4f1a\u53d8\u6210\u6b63\u6570\uff0c\u5219 $0<(\\dfrac{b-\\sqrt{d}}{2})^n<1$\uff0c\u5411\u4e0b\u53d6\u6574\u4e3a $0$\u3002\n\n- \u5982\u679c $b-\\sqrt{d}<0$\uff0c\u4e14 $2\\nmid n$\uff0c\u6b64\u65f6\u539f\u5f0f\u4f9d\u7136\u662f\u8d1f\u6570\uff0c\u5219 $-1<(\\dfrac{b-\\sqrt{d}}{2})^n<0$\uff0c\u5411\u4e0b\u53d6\u6574\u4e3a $-1$\u3002\n\n\u7efc\u4e0a\u6240\u8ff0\uff0c$(\\dfrac{b-\\sqrt{d}}{2})^n$ \u7684\u5f71\u54cd\u503c\u65e0\u5916\u4e4e\u5c31\u662f $0$ \u6216\u8005 $-1$\uff0c\u8ba1\u7b97\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5224\u65ad\u7b2c\u4e09\u79cd\u60c5\u51b5\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u6700\u540e\u7531\u4e8e\u6a21\u6570 $p=7528443412579576937 \\approx 7\\times 10^{18}$\uff0c\u8ba1\u7b97\u8fc7\u7a0b\u5f88\u6709\u53ef\u80fd\u7206 `long long`\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f00\u4e00\u4e2a\u8001\u7956\u5b97 `__int128`\uff0c\u5199\u4e2a\u5feb\u8bfb\u5feb\u5199\uff0c\u5c31\u53ef\u4ee5\u4e86\u8fc7\u4e86\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define int __int128//\u61d2 \nusing namespace std;\nconst int MAXN=83;\nconst int MOD=7528443412579576937;\nint b,d,n;\nvoid read(int &x)\n{\n\tx=0;\n\tshort flag=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9')\n\t{\n\t\tif(ch=='-')\tflag=-1;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9')\n\t{\n\t\tx=(x<<1)+(x<<3)+(ch^48);\n\t\tch=getchar();\n\t}\n\tx*=flag;\n}\nint quick_mul(int x,int y)//\u9f9f\u901f\u4e58\uff0c\u53ef\u80fd\u6ca1\u6709\u5fc5\u8981\u4f46\u662f\u5c31\u662f\u60f3\u5199 \n{\n\tint res=0;\n\twhile(y)\n\t{\n\t\tif(y&1)\tres=res+x,res%=MOD;\n\t\tx=x+x,x%=MOD;\n\t\ty>>=1;\n\t}\n\treturn res;\n}\nvoid mul(int f[3],int a[3][3])//\u8f6c\u79fb\u6a21\u677f \n{\n    int c[3];\n    memset(c,0,sizeof(c));\n    for(int j=1;j<=2;j++)\n    {\n        for(int k=1;k<=2;k++)    c[j]=(c[j]+quick_mul(f[k],a[k][j]))%MOD;\n    }\n    memcpy(f,c,sizeof(c));\n}\nvoid mulself(int a[3][3])//\u77e9\u9635\u81ea\u4e58\u6a21\u677f \n{\n    int c[3][3];\n    memset(c,0,sizeof(c));\n    for(int i=1;i<=2;i++)\n    {\n        for(int j=1;j<=2;j++)\n        {\n            for(int k=1;k<=2;k++)    c[i][j]=(c[i][j]+quick_mul(a[i][k],a[k][j]))%MOD;\n        }\n    }\n    memcpy(a,c,sizeof(c));\n}\nvoid write(int x)\n{\n\tif(x<10)\n\t{\n\t\tputchar(x+'0');\n\t\treturn;\n\t}\n\twrite(x/10);\n\tputchar(x%10+'0');\n}\nsigned main()\n{\n\tread(b),read(d),read(n);\n\tif(!n)//\u7279\u5224 \n\t{\n\t\tputs(\"1\");\n\t\treturn 0;\n\t}\n\tif(n==1)//\u7279\u5224 \n\t{\n\t\tlong long B=b,D=d;//\u7384\u5b66\u8c03\u8bd5 \n\t\tcout<<((B+sqrt(D)))/2;\n\t\treturn 0;\n\t}\n\tint f[3];\n\tmemset(f,0,sizeof(f));\n\tint a[3][3];\n\tmemset(a,0,sizeof(a));\n\ta[1][1]=b,a[1][2]=1,a[2][1]=-(b*b-d)/4;\n\tf[2]=b,f[1]=(b*b+d)/2;//\u6784\u9020\u4e24\u4e2a\u77e9\u9635 \n\tn-=2;\n\tint temp=n;//n\u548cn-2\u7684\u5947\u5076\u6027\u76f8\u540c\uff0c\u6240\u4ee5\u63d0\u524d\u50a8\u5b58n-2\u4e0d\u4f1a\u9519 \n\twhile(n)//\u5feb\u901f\u5e42\u6a21\u677f \n\t{\n\t\tif(n&1)\tmul(f,a);\n\t\tmulself(a);\n\t\tn>>=1;\n\t}\n\tif(b*b!=d&&!(temp&1))\tf[1]--;//\u7279\u5224\u7b2c\u4e09\u79cd\u60c5\u51b5 \n\twrite(f[1]);//\u8f93\u51fa \n\treturn 0;//\u534e\u4e3d\u6536\u573a \n}\n```",
        "postTime": 1679714930,
        "uid": 439177,
        "name": "Super_Sheep",
        "ccfLevel": 0,
        "title": "P3263\u9898\u89e3"
    },
    {
        "content": "~~ilovegzd~~\n\n\u9996\u5148\u4f60\u9700\u8981\u77e5\u9053 [\u77e9\u9635\u8fd0\u7b97](https://www.luogu.com.cn/blog/_post/501422)\u3002\n\n## \u8fc7\u7a0b\n\n\u8ba9\u6211\u4eec\u770b\u770b\u6570\u636e\u8303\u56f4\uff1a$0<b^2\\leq d<(b+1)^2\\leq 10^{18},n\\leq 10^{18}$\uff0c\u5e76\u4e14 $b\\bmod 2=1,d\\bmod 4=1$\u3002\n\n\u770b\u5230\u8fd9\u4e2a\u6570\u636e\u8303\u56f4\u6211\u4eec\u80af\u5b9a\u8981\u4e00\u4e2a $O(\\log n)$ \u5de6\u53f3\u7684\u7b97\u6cd5\u3002\n\n\u7136\u540e\u6211\u4eec\u5bf9\u4e24\u8fb9\u53d6\u4e2a\u6839\u53f7\uff0c\u5f97\u5230 $0<b\\leq\\sqrt{d}<b+1\\leq 10^9$\u3002\n\n\u6cbf\u7528 P5136 \u7684\u89e3\u6cd5\uff0c\u5982\u679c\u6211\u4eec\u8bbe\u4e00\u4e2a\u6570\u5217\n$$\nF_n=(\\dfrac{b+\\sqrt{d}}{2})^n+(\\dfrac{b-\\sqrt{d}}{2})^n\n$$\n\u6211\u4eec\u80fd\u5728 $O(\\log n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u4f7f\u7528\u77e9\u9635\u5feb\u901f\u5e42\u8ba1\u7b97 $F_n$\u3002\n\n## \u8ba1\u7b97 $(\\frac{b-\\sqrt{d}}{2})^n$\n\n$$\n\\begin{aligned}\nb&\\leq\\sqrt{d}<b+1\\\\\n0&\\leq\\sqrt{d}-b<1\\\\\n-1&< b-\\sqrt{d}\\leq 0\\\\\n-1<-\\frac{1}{2}&<\\frac{b-\\sqrt{d}}{2}\\leq 0\n\\end{aligned}\n$$\n\n\u4e8e\u662f\n$$\n(\\frac{b-\\sqrt{d}}{2})^n\n\\left\\{\\begin{aligned}\n\\leq 0,n\\bmod 2=1\\\\\n\\geq 0,n\\bmod 2=0\n\\end{aligned}\\right.\n$$\n\n## $O(\\log n)$ \u8ba1\u7b97 $F_n$\n\n\u7b2c\u4e8c\u6ce2\u5f0f\u5b50\uff1a\n$$\n\\begin{aligned}\nF_n&=(\\dfrac{b+\\sqrt{d}}{2})^n+(\\dfrac{b-\\sqrt{d}}{2})^n\\\\\n&=\\dfrac{b^2+2b\\sqrt{d}+d}{4}\\times (\\dfrac{b+\\sqrt{d}}{2})^{n-2}+\\dfrac{b^2-2b\\sqrt{d}+d}{4}\\times (\\dfrac{b-\\sqrt{d}}{2})^{n-2}\\\\\n&=\\dfrac{2b^2+2b\\sqrt{d}+d-b^2}{4}\\times (\\dfrac{b+\\sqrt{d}}{2})^{n-2}+\\dfrac{2b^2-2b\\sqrt{d}+d-b^2}{4}\\times (\\dfrac{b-\\sqrt{d}}{2})^{n-2}\\\\\n&=\\dfrac{2b^2+2b\\sqrt{d}}{4}\\times (\\dfrac{b+\\sqrt{d}}{2})^{n-2}+\\dfrac{d-b^2}{4}\\times (\\dfrac{b+\\sqrt{d}}{2})^{n-2}+\\dfrac{2b^2-2b\\sqrt{d}}{4}\\times (\\dfrac{b-\\sqrt{d}}{2})^{n-2}+\\dfrac{d-b^2}{4}\\times (\\dfrac{b-\\sqrt{d}}{2})^{n-2}\\\\\n&=\\dfrac{b(b+\\sqrt{d})}{2}\\times (\\dfrac{b+\\sqrt{d}}{2})^{n-2}+\\dfrac{d-b^2}{4}\\times (\\dfrac{b+\\sqrt{d}}{2})^{n-2}+\\dfrac{b(b-\\sqrt{d})}{2}\\times (\\dfrac{b-\\sqrt{d}}{2})^{n-2}+\\dfrac{d-b^2}{4}\\times (\\dfrac{b-\\sqrt{d}}{2})^{n-2}\\\\\n&=b((\\dfrac{b+\\sqrt{d}}{2})^{n-1}+(\\dfrac{b-\\sqrt{d}}{2})^{n-1})+\\dfrac{d-b^2}{4}((\\dfrac{b+\\sqrt{d}}{2})^{n-2}+(\\dfrac{b-\\sqrt{d}}{2})^{n-2})\\\\\n&=bF_{n-1}+\\dfrac{d-b^2}{4}F_{n-2}\\\\\n\\end{aligned}\n$$\n\u7531\u4e8e $b\\bmod 2=1,d\\bmod 4=1$\uff0c\u5f97\u5230 $\\frac{d-b^2}{4}\\in\\mathbb{Z}$\u3002\n\n\u9012\u63a8\u77e9\u9635\u5373\u4e3a\n$$\n\\left\\lbrack\\begin{matrix}\nb&1\\\\\n\\frac{d-b^2}{4}&0\\\\\n\\end{matrix}\\right\\rbrack\n$$\n\u521d\u59cb\u77e9\u9635\u5373\u4e3a\n$$\n\\left\\lbrack\\begin{matrix}\nF_2&F_1\\\\\n0&0\\\\\n\\end{matrix}\\right\\rbrack=\\left\\lbrack\\begin{matrix}\nd+b^2&b\\\\\n0&0\\\\\n\\end{matrix}\\right\\rbrack\n$$\n\u7136\u540e\u5c31\u53ef\u4ee5\u77e9\u9635\u5feb\u901f\u5e42\u4e86\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\nmat base, res;\nconstexpr mint one(1), zero(0);\nmint ans;\nunsigned long long n = 0;\nmint b, d;\ninline void solve() {\n    cin >> b >> d >> n;\n    if (n == 0) cout << '1' << '\\n';\n    else if (n == 1) cout << mint((unsigned long long)(b.val() + sqrt(d.val())) >> 1) << '\\n';\n    else {\n        base.mat[1][1] = zero;\n        base.mat[0][0] = b;\n        base.mat[0][1] = one;\n        base.mat[1][0] = (d - b * b).val() >> 2;\n        ans = !(n & 1);\n        ans = -ans;\n        n -= 2;\n        res.mat[0][0] = (b * b + d).val() >> 1;\n        res.mat[1][0] = res.mat[1][1] = zero;\n        res.mat[0][1] = b;\n        for (; n; base *= base, n >>= 1) if (n & 1) res *= base;\n        ans += res.mat[0][0];\n        cout << ans << '\\n';\n    }\n}\nint main() {\n    base.mat.resize(2);\n    base.mat[0].resize(2);\n    base.mat[1].resize(2);\n    res.mat.resize(2);\n    res.mat[0].resize(2);\n    res.mat[1].resize(2);\n    solve();\n}\n```",
        "postTime": 1668347658,
        "uid": 589895,
        "name": "Ruiqun2009",
        "ccfLevel": 0,
        "title": "\u77e9\u9635\u8fd0\u7b974/\u9898\u89e3P3263[JLOI2015]\u6709\u610f\u4e49\u7684\u5b57\u7b26\u4e32"
    },
    {
        "content": "##     [P3263 [JLOI2015]\u6709\u610f\u4e49\u7684\u5b57\u7b26\u4e32](https://www.luogu.com.cn/problem/P3263)\n\n**\u3010\u9898\u610f\u7b80\u8ff0\u3011**\n\n**\u6ce8\u610f\uff1a\u6837\u4f8b\u6709\u8bef**\n\n\u7ed9\u5b9a $b$\u200b\uff0c$d$\u200b\uff0c$n$\u200b \u4e14\u4fdd\u8bc1 $b \\bmod 2=1$\u200b\uff0c$d \\bmod 4=1$\u200b\u3002\n\n\u6c42: \n$$\n\\left\\lfloor\\left(\\dfrac{b+\\sqrt{d}}{2}\\right)^n\\right\\rfloor\\bmod p\n$$\n\u5176\u4e2d $p=7528443412579576937$\u3002\n\n**\u3010\u89e3\u9898\u601d\u8def\u3011**\n\n~~\u6211\u4e5f\u6765\u6c34\u4e00\u7bc7\u9898\u89e3\u3002~~\n\n\u53d1\u73b0\u539f\u5f0f\u7684\u56f0\u96be\u4e4b\u5904\u5728\u4e8e\u6709\u6839\u53f7\uff0c\u53ef\u80fd\u4f1a\u51fa\u73b0\u5c0f\u6570\uff0c\u4ece\u800c\u4e0d\u80fd\u76f4\u63a5\u53d6\u6a21\u3002\n\n\u4e0d\u90a3\u4e48\u663e\u7136\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u5f0f\u5b50:\n\n$\\dfrac{b+\\sqrt{d}}{2}+\\dfrac{b-\\sqrt{d}}{2}=\\dfrac{d}{2}$\u3002\u53d1\u73b0\u7531\u4e8e $b\\bmod2=1$ \u4e14 $d \\bmod 4 = 1$\uff0c\u6240\u4ee5 $\\dfrac{b}{2}$ \u4e3a\u6574\u6570\u3002\n\n\u53d1\u73b0 $\\dfrac{b+\\sqrt{d}}{2}$\uff0c$\\dfrac{b-\\sqrt{d}}{2}$ \u53ef\u4ee5\u770b\u505a\u4e00\u4e2a\u65b9\u7a0b\u7684\u4e24\u4e2a\u6839\u3002\u8bbe\u8fd9\u4e2a\u6839\u4e3a $x_1$ \u548c $x_2$\u3002\n\n\u5219\u6709 $x^2-bx+\\dfrac{b^2-d}{4}=0$\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u9879\u4e58\u4ee5 $x^{n-2}$\u3002\n\n\u5f97\u5230 $x^n-bx^{n-1}+\\dfrac{b^2-d}{4}x^{n-2}=0$\u3002\n\n\u79fb\u9879\u7684 $x^{n}=bx^{n-1}-\\dfrac{b^2-d}{4}x^{n-2}$\u3002\n\n \u53d1\u73b0\u5f0f\u5b50\u5f88\u50cf\u4e00\u4e2a\u7c7b\u4f3c\u6590\u6ce2\u90a3\u5951\u7684\u7ebf\u6027\u9012\u63a8\u5e8f\u5217\uff0c\u4f46\u662f\u53d1\u73b0\u65e0\u6cd5\u4fdd\u8bc1 $x^{i}$ \u4e3a\u6574\u6570\u3002\u6b64\u65f6\u8bbe $F_i=x_1^i+x_2^i$ \u3002\n\n\u90a3\u4e48 $F_i$ \u662f\u5426\u662f\u6574\u6570\u5c31\u5f88\u597d\u5224\u65ad\u4e86\u3002\n\n\u7531\u4e8e $F_0=1+1=2$\uff0c$F_1=\\dfrac{b+\\sqrt{d}+b-\\sqrt{d}}{2}=b$\u3002\n\n\u7531\u4e8e $F_0$\u3001$F_1$ \u5747\u4e3a\u6574\u6570\uff0c\u4e14 $\\dfrac{b^2-d}{4}$\u3001$b$ \u5747\u4e3a\u6574\u6570\uff0c\u6240\u4ee5 $F_i$ \u4e5f\u4e00\u5b9a\u4e3a\u6574\u6570\u3002\n\n\u8003\u8651\u6784\u9020\u521d\u59cb\u77e9\u9635\uff1a\n$$\nS=\\begin{bmatrix}2&b\\end{bmatrix}\n$$\n\u8003\u8651\u6784\u9020\u8f6c\u79fb\u77e9\u9635\uff1a\n$$\nT=\n\\begin{bmatrix}\n0&-\\dfrac{b^2-d}{4}\\\\\n1&b\n\\end{bmatrix}\n$$\n\u5219\u6700\u540e\u7b54\u6848\u77e9\u9635 $A=S\\times T^{n-1}$\u3002\n\n\u6700\u540e\u5f97\u5230\u7684\u7b54\u6848\u662f $x_1^n+x_2^n$\uff0c\u5219\u53ea\u9700\u51cf\u53bb $x_2^n$ \u5373\u53ef\u3002\u7531\u4e8e\u9898\u4e2d\u4fdd\u8bc1\uff08~~\u6837\u4f8b\u5c31\u6ca1\u6709~~\uff09 $b^2\\le d<(b+1)^2\\to b\\le\\sqrt{d}<b+1$\u3002\u6240\u4ee5 $x_2$ \u4e3a\u8d1f\u6570\uff0c\u4e14 $x_2>-1$\u3002\u5219 $x_2$ \u5728 $n$ \u6b21\u65b9\u540e\u7684\u7edd\u5bf9\u503c\u7684\u5927\u5c0f\u4e00\u5b9a\u5c0f\u4e8e $1$\uff0c\u5219\u53ea\u9700\u8981\u8003\u8651 $x_2$ \u7684\u7b26\u53f7\u3002\n\n\u5982\u679c $x_2^n<0$\uff0c\u5219\u6700\u7ec8\u7b54\u6848\u4e0d\u53d8\uff0c\u5426\u5219\u6700\u7ec8\u7b54\u6848\u51cf\u53bb $1$\u3002\n\n#### $\\texttt{CODE}$\n\n```cpp\n#include<bits/stdc++.h>\n#define getchar() p1==p2&&(p2=(p1=buf)+fread(buf,1,1000000,stdin),p1==p2)?EOF:*p1++\n#define putchar(x) (p3-obuf<1000000)?(*p3++=x):(fwrite(obuf,p3-obuf,1,stdout),p3=obuf,*p3++=x)\nusing namespace std;\nstatic char buf[1000000], *p1 = buf, *p2 = buf, obuf[1000000],*p3 = obuf;\ntemplate<typename item>\ninline void read(register item &x) {\n\tx = 0; register int f = 1; register char c = getchar();\n\twhile(c < '0' || c > '9') { if(c=='-')f = -1; c = getchar(); }\n\twhile(c >= '0' && c <='9') x = (x << 3) + (x << 1) + (c ^ 48), c = getchar();\n\tx *= f;\n}\ntemplate<typename T>\ninline void print(register T x) {\n\tx < 0 ? (putchar('-'), x = -x) : x;\n\tregister int c[32], len = 0;\n\tif (x == 0) len = 1;\n\twhile (x) ++len, c[len] = x % 10, x /= 10;\n\tfor (int i = len; i >= 1; --i) {\n\t\tputchar(c[i] + '0');\n\t}\n}\n#define ll __int128\n#define p 7528443412579576937ll\nstruct Matrix{\n\tll a[2][2];\n\tMatrix() {\n\t\tmemset(a, 0, sizeof(a));\n\t}\n\tMatrix operator * (const Matrix b) const {\n\t\tMatrix ret;\n\t\tfor (int i = 0; i < 2; ++i)\n\t\t\tfor (int k = 0; k < 2; ++k)\n\t\t\t\tfor (int j = 0; j < 2; ++j)\n\t\t\t\t\tret.a[i][j] += a[i][k] * b.a[k][j], ret.a[i][j] %= p;\n\t\treturn ret;\n\t}\n};\n\nMatrix T;\n\nMatrix quickPow(Matrix a, ll b) {\n\tMatrix ret; ret.a[0][0] = ret.a[1][1] = 1;\n\twhile (b) {\n\t\tif (b & 1) ret = a * ret;\n\t\ta = a * a;\n\t\tb >>= 1;\n\t}\n\treturn ret;\n}\n\nint main() {\n\tll b, d, n, ans = 0; read(b), read(d), read(n);\n\tif (n == 0) return (puts(\"1\"), 0);\n\tT.a[1][0] = 1, T.a[1][1] = b, T.a[0][1] = ((-b * b + d) / 4) % p;\n\tMatrix A = quickPow(T, n - 1);\n\tprint((2 * A.a[0][1] + b  * A.a[1][1]) % p + ((n & 1) ? 0 : -1));\n\tfwrite(obuf, p3 - obuf, 1, stdout);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1667390153,
        "uid": 675237,
        "name": "DiruiXiao",
        "ccfLevel": 6,
        "title": "P3263 [JLOI2015]\u6709\u610f\u4e49\u7684\u5b57\u7b26\u4e32"
    },
    {
        "content": "\u7531\u4e8e $\\sqrt{d}$ \u6bd4\u8f83\u96be\u5904\u7406\uff0c\u6240\u4ee5\u8003\u8651\u8f6c\u5316\u3002\n\n\u56e0\u4e3a\u8981\u6c42\u51fa\u9012\u63a8\u5f0f\uff0c\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u4e00\u5143\u4e8c\u6b21\u65b9\u7a0b $x^2+mx+n=0$ \u6709\u4e00\u6839\u4e3a $x=\\dfrac{b+\\sqrt{d}}{2}$\u3002\u663e\u7136\uff0c\u53e6\u4e00\u6839\u4e3a $x=\\dfrac{b-\\sqrt{d}}{2}$\u3002\n\n\u6211\u4eec\u5f97\u5230 $x_1=\\dfrac{b+\\sqrt{d}}{2}$\uff0c$x_2=\\dfrac{b-\\sqrt{d}}{2}$\u3002\n\n\u7531\u97e6\u8fbe\u5b9a\u7406\u53ef\u5f97\uff1a$\\begin{cases}x_1+x_2=-m\\\\x_1x_2=n\\end{cases}$\uff0c\u6240\u4ee5 $m=-b$\uff0c$n=\\dfrac{b^2-d}{4}$\u3002\n\n\u6545\u8be5\u4e00\u5143\u4e8c\u6b21\u65b9\u7a0b\u4e3a $x^2-bx+\\dfrac{b^2-d}{4}=0$\u3002\n\n\u5148\u79fb\u9879\uff0c\u5f97 $x^2=bx+\\dfrac{d-b^2}{4}$\u3002\n\n\u518d\u5c06\u5176\u8f6c\u5316\u6210\u9012\u63a8\u5f62\u5f0f\uff0c\u5f97 $x^n=bx^{n-1}+\\dfrac{d-b^2}{4}x^{n-2}$\u3002\n\n\u8bbe $f_i=\\left(\\dfrac{b+\\sqrt{d}}{2}\\right)^i+\\left(\\dfrac{b-\\sqrt{d}}{2}\\right)^i$\u3002( $i\\in\\mathbb{Z}^+$ )\n\n\u7531\u524d\u9762\u7684\u9012\u63a8\u5f0f\uff0c\u6211\u4eec\u5f97\u5230 $f$ \u7684\u9012\u63a8\u5f0f\uff1a$f_n=bf_{n-1}+\\dfrac{d-b^2}{4}f_{n-2}$\u3002\n\n\u7136\u540e\u7528\u77e9\u9635\u4e58\u6cd5\u5373\u53ef\u3002\n\n\u8f6c\u79fb\u5f62\u5f0f\u4e0e\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7c7b\u4f3c\uff0c\u6211\u4eec\u5f88\u5feb\u5c31\u80fd\u5f97\u5230\u5176\u8f6c\u79fb\u77e9\u9635\u4e3a $\\begin{bmatrix}b&1\\\\\\dfrac{d-b^2}{4}&0\\end{bmatrix}$\uff0c\u521d\u59cb\u77e9\u9635\u4e3a $\\begin{bmatrix}\\dfrac{d+b^2}{2}&1\\end{bmatrix}$\uff0c\u7531\u6b64\u5f97\u5230 $\\begin{bmatrix}f_n&f_{n-1}\\end{bmatrix}=\\begin{bmatrix}\\dfrac{d+b^2}{2}&1\\end{bmatrix}\\times\\begin{bmatrix}b&1\\\\\\dfrac{d-b^2}{4}&0\\end{bmatrix}^{n-2}$\u3002\n\n\u6ce8\u610f $n=0$ \u548c $n=1$ \u65f6\u8981\u7279\u5224\u3002\n\n\u56e0\u4e3a $b\\equiv1\\pmod{2}$\uff0c\u6240\u4ee5 $b\\equiv1,3\\pmod{4}$\uff0c\u4ece\u800c\u5f97\u5230 $b^2\\equiv1\\pmod{4}$\u3002\n\n\u53c8\u56e0\u4e3a $d\\equiv1\\pmod{4}$\uff0c\u6240\u4ee5 $b^2-d\\equiv0\\pmod{4}$\uff0c\u5373 $\\dfrac{b^2-d}{4}$ \u4e3a\u6574\u6570\u3002\n\n\u6545\u9012\u63a8\u8fc7\u7a0b\u4e2d $f_i$ \u5747\u4e3a\u6574\u6570\u3002\n\n\u6700\u540e\uff0c\u56e0\u4e3a\u6211\u4eec\u6c42\u7684\u662f $\\left\\lfloor\\left(\\dfrac{b+\\sqrt{d}}{2}\\right)^n\\right\\rfloor$\uff0c\u6240\u4ee5\u8981\u628a $\\left(\\dfrac{b-\\sqrt{d}}{2}\\right)^n$ \u51cf\u6389\u3002\n\n\u56e0\u4e3a $\\begin{cases}0\\leqslant-\\left(\\dfrac{b-\\sqrt{d}}{2}\\right)^n<1&n\\text{\u4e3a\u5947\u6570}\\\\-1<-\\left(\\dfrac{b-\\sqrt{d}}{2}\\right)^n\\leqslant0&n\\text{\u4e3a\u5076\u6570}\\end{cases}$ \uff0c\n\n\u6240\u4ee5\u5f53 $n$ \u4e3a\u5076\u6570\u4e14 $b\\ne\\sqrt{d}$\uff08\u5373 $b^2\\ne d$ \uff09\u65f6\uff0c\u5f97\u5230\u7684\u7b54\u6848\u8981\u51cf $1$\u3002\n\n\u4e2a\u4eba\u8ba4\u4e3a\u672c\u9898\u7684\u601d\u7ef4\u96be\u5ea6\u8fd8\u662f\u6bd4\u8f83\u9ad8\u7684\u3002\u4ee3\u7801\u96be\u5ea6\u4e0d\u7b97\u592a\u9ad8\uff0c\u53ea\u8981\u4f1a\u77e9\u9635\u4e58\u6cd5\u5373\u53ef\u3002\n\n\u6ce8\uff1a\u672c\u9898\u53ef\u80fd\u4f1a\u7206 long long\uff0c\u9700\u8981\u4f7f\u7528 __int128 \u6216\u5feb\u901f\u4e58\u3002\n\n\u4ee3\u7801\uff08\u7528\u7684\u662f __int128\uff09\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef __int128  ll;\ntypedef long long l;\nconst ll MOD=7528443412579576937;\nll b,d,n;\nvoid read(ll&a){\n    a=0;\n\tll f=1;\n\tchar ch=getchar();\n    while(ch<'0'||ch>'9'){\n    \tif(ch=='-'){\n    \t\tf=-1;\n\t\t}\n\t\tch=getchar();\n    }\n    do{\n\t\ta=a*10+ch-'0';\n\t\tch=getchar(); \n\t}while('0'<=ch&&ch<='9');\n    a*=f;\n}\nvoid print(ll n){\n    if(n>9)print(n/10);\n    putchar(n%10+48);\n}\nstruct Matrix{\n    ll a[3][3];\n    Matrix(){\n        memset(a,0,sizeof a);\n    }\n    Matrix operator*(const Matrix &b)const{\n        Matrix res;\n        for(int i=1;i<=2;++i){\n            for(int j=1;j<=2;++j){\n                for(int k=1;k<=2;++k){\n                    res.a[i][j]=(res.a[i][j]+a[i][k]*b.a[k][j])%MOD;\n                }\n            }\n        }\n        return res;\n    }\n}ans,base;\nvoid init(){\n    base.a[1][1]=b;\n    base.a[1][2]=1;\n\tbase.a[2][1]=(d-b*b)/4;\n    ans.a[1][1]=(d+b*b)/2;\n\tans.a[1][2]=b;\n}\nvoid qpow(ll b){\n    while(b){\n        if(b&1){\n            ans=ans*base;\n        }\n        base=base*base;\n        b>>=1;\n    }\n}\nint main(){\n    read(b);\n    read(d);\n    read(n);\n    if(n==0){\n        printf(\"1\\n\");\n        return 0;\n    }\n    if(n==1){\n        printf(\"%lld\\n\",ll(b+sqrt((l)d)/2)%MOD);\n        return 0;\n    }\n    init();\n    qpow(n-2);\n    print(ans.a[1][1]-(b*b!=d&&n%2==0));\n    return 0;\n}\n```\n",
        "postTime": 1644483074,
        "uid": 352363,
        "name": "C_S_L",
        "ccfLevel": 0,
        "title": "P3263 [JLOI2015]\u6709\u610f\u4e49\u7684\u5b57\u7b26\u4e32 \u9898\u89e3"
    },
    {
        "content": "**[\u7279\u5f81\u65b9\u7a0b\u662f\u5565\uff1f-> \u4f20\u9001\u95e8](https://zhuanlan.zhihu.com/p/104596563)**\n\n\u89c2\u5bdf\u6570\u636e\u8303\u56f4\uff0c\u53d1\u73b0\u6709\u4e2a $b^2$ \u548c $d$ \u7684\u5927\u5c0f\u5173\u7cfb\uff0c\n\n\u7531\u6b64\u8054\u60f3\u5230 $b^2-d$\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e58\u4e0a\u539f\u5f0f\u7684\u5171\u8f6d\u6839\u5f0f $\\large\\frac{b-\\sqrt d}{2}$ \u5f97\u5230\u3002\n\n\u8bbe $\\large x_1=\\frac{b+\\sqrt d}{2}\\ ,\\ x_2=\\frac{b-\\sqrt d}{2}$\uff0c\u5219\n\n$$\\begin{cases} x_1+x_2=b\\\\ x_1x_2=b^2-d \\end{cases}$$ \n\n\n\u6545 $x_1,x_2$ \u4e3a\u65b9\u7a0b $x^2-bx-(b^2-d)=0$ \u7684\u4e24\u6839\uff0c\n\n\u4e5f\u662f\u6570\u5217 $a_n=ba_{n-1}+(d-b^2)a_{n-2}$ \u7684\u7279\u5f81\u6839\u3002\n\n\u8fd9\u4e2a\u6570\u5217\u7684\u6bcf\u4e00\u9879\u53ef\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u5728 $O(\\log n)$ \u7684\u6548\u7387\u5185\u6c42\u51fa\u3002\n\n\u9898\u76ee\u8981\u6c42 $( \\frac{b+\\sqrt{d}}{2} ) ^n$ \u5373 $x_1^n$\uff0c\u6545\u8003\u8651\u539f\u6570\u5217\u7684\u901a\u9879\uff0c\n\n\u8bbe $a_n=\\alpha\\cdot ( \\frac{b+\\sqrt{d}}{2} ) ^n+\\beta\\cdot ( \\frac{b-\\sqrt{d}}{2} ) ^n$\uff0c\u53d6 $\\alpha=\\beta=1$\uff0c\u5219\n\n$$a_0=2\\ ,\\ a_1=b\\ ,\\ a_n=( \\frac{b+\\sqrt{d}}{2} ) ^n+( \\frac{b-\\sqrt{d}}{2} ) ^n$$ \n\n\u8fd9\u91cc\u6709 $a_n\\in \\mathbb{Z}^*$\u3002\n\n\u51fa\u73b0 $( \\frac{b+\\sqrt{d}}{2} ) ^n$ \u4e86\uff0c\u5373\u6c42\u51fa $a_n$ \u7684\u503c\u518d $-(\\frac{b-\\sqrt d}{2})^n$\u3002\n\n\u518d\u6765\u770b $a_n$\uff0c\u7531\u9898\u76ee\u6761\u4ef6 $0<b^2 \\le d<(b+1)^2 \\le 10^{18}$ \u53ef\u77e5 $-1<b-\\sqrt d\\le0$\u3002\n\n\u5f53 $b^2=d$ \u65f6\u663e\u7136\u4e0d\u5f71\u54cd\u4e0b\u53d6\u6574\u7684\u7ed3\u679c\u3002\n\n\u8003\u8651 $b^2\\ne d$\u3002\u6b64\u65f6\uff0c\n\n\u5f53 $n$ \u4e3a\u5947\u6570\u65f6\uff0c $0<-(\\frac{b-\\sqrt d}{2})^n<1$\uff0c\u53c8 $a_n\\in\\mathbb Z^*$\uff0c\u6545\u6b64\u65f6\u4e0d\u4f1a\u5f71\u54cd\u4e0b\u53d6\u6574\u7684\u503c\uff0c\u7b54\u6848\u4e3a $a_n$\u3002\n\n\u4f46\u5f53 $n$ \u4e3a\u5076\u6570\u65f6\uff0c $-1<-(\\frac{b-\\sqrt d}{2})^n< 0$\uff0c$a_n\\in\\mathbb Z^*$\uff0c\u6545\u6b64\u65f6\u4f1a\u5f71\u54cd\u4e0b\u53d6\u6574\u7684\u503c\uff0c\u7b54\u6848\u4e3a $a_n-1$\u3002\n\n\u6700\u540e\u518d\u6765\u770b\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u6839\u636e\u6570\u5217 $a_n=ba_{n-1}+(d-b^2)a_{n-2}$\uff0c\u53ef\u5f97\n\n$$\\begin{bmatrix} a_{n-1}&a_{n} \\end{bmatrix}= \\begin{bmatrix} a_{n-2}&a_{n-1} \\end{bmatrix}\\cdot \\begin{bmatrix} 0&d-b^2\\\\ 1&b \\end{bmatrix}$$\n\n$n=0$ \u65f6\u7279\u5224\u4e00\u4e0b\u3002\n\n\u53e6\u5916\uff0c\u7531\u4e8e\u672c\u9898\u7684\u6a21\u6570\u5f88\u5927\uff0c\u5e73\u65b9\u4e00\u4e0b\u4f1a\u7206long long\uff0c\u6240\u4ee5\u8981\u7528\u5feb\uff08\u9f9f\uff09\u901f\u4e58\u3002\n\n\n------------\n\n\n _AC Code_ \n\n```cpp\n#include<iostream>\n#include<stdio.h>\n#include<string.h>\n#include<algorithm>\n#define int unsigned long long\nusing namespace std;\n\nconst int MOD=7528443412579576937;\n\nint b,d,n;\n\nint calc(int a,int b) //gui\u901f\u4e58\n{\n\tint ans=0;\n\tfor(;b;b>>=1)\n\t{\n\t\tif(b&1) ans=(ans+a)%MOD;\n\t\ta=a*2%MOD;\n\t}\n\treturn ans;\n}\n\nvoid mul(int f[2],int a[2][2]) //\u4e24\u77e9\u9635\u76f8\u4e58\n{\n\tint c[2];\n\tmemset(c,0,sizeof c);\n\tfor(register int j=0;j<2;j++)\n\t\tfor(register int k=0;k<2;k++)\n\t\t\tc[j]=(c[j]+calc(f[k],a[k][j]))%MOD;\n\tmemcpy(f,c,sizeof c);\n}\n\nvoid mulself(int a[2][2]) //\u81ea\u5df1\u4e58\u81ea\u5df1\n{\n\tint c[2][2];\n\tmemset(c,0,sizeof c);\n\tfor(register int i=0;i<2;i++)\n\t\tfor(register int j=0;j<2;j++)\n\t\t\tfor(register int k=0;k<2;k++)\n\t\t\t\tc[i][j]=(c[i][j]+calc(a[i][k],a[k][j]))%MOD;\n\tmemcpy(a,c,sizeof c);\n}\n\nsigned main()\n{\n\tscanf(\"%lld%lld%lld\",&b,&d,&n);\n\tif(!n) return puts(\"1\"),0; //\u7279\u5224\n\tint p=b,q=(d-b*b)>>2;\n\tint f[2]={2,b},a[2][2]={{0,q},{1,p}};\n\tfor(register int t=n;t;t>>=1) //\u77e9\u9635\u5feb\u901f\u5e42\n\t{\n\t\tif(t&1) mul(f,a);\n\t\tmulself(a);\n\t}\n\tif(d!=b*b&&!(n&1)) printf(\"%lld\\n\",(f[0]-1)%MOD); //n\u4e3a\u5076\u6570\n\telse printf(\"%lld\\n\",f[0]%MOD); //n\u4e3a\u5947\u6570\n\treturn 0;\n}\n```",
        "postTime": 1643532765,
        "uid": 431106,
        "name": "JackWei",
        "ccfLevel": 0,
        "title": "P3263\u9898\u89e3"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3263)\n\n\u6211\u4eec\u6709\u4e00\u79cd\u5e38\u89c1\u7684\u5904\u7406 $A_n=(\\frac{b+\\sqrt{d}}{2})^n$ \u7684\u6570\u7684\u529e\u6cd5\uff0c\u5c31\u662f\u52a0\u4e0a $B_n=(\\frac{b-\\sqrt{d}}{2})^n$\n\n\u5728\u672c\u9898\u4e2d\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u53d1\u73b0\uff0c$|\\frac{b-\\sqrt{d}}{2}|\\le 1$\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u8f6c\u800c\u6c42 $f_n=A_n+B_n$ \n\n\u5b9e\u8df5\u544a\u8bc9\u6211\u4eec\uff0c\u8fd9\u662f\u4e8c\u9636\u7ebf\u6027\u9012\u63a8\u516c\u5f0f\u7684\u901a\u9879\uff0c\u5e76\u4e14\n\n$$\nf_n=(A_1+B_1)f_{n-1}-(A_1B_1)f_{n-2}\n$$\n\n\u5173\u4e8e\u8fd9\u4e2a\u5f0f\u5b50\u7684\u8bc1\u660e\uff0c\u5e94\u8be5\u633a\u663e\u7136\u7684\uff0c\u4f60\u53ea\u8981\u62c6\u5f00\u5c31\u884c\n\n\u6211\u4eec\u53ef\u4ee5\u6309\u7167\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u901a\u9879\u6c42\u6cd5\uff0c\u7528\u77e9\u9635\u5feb\u901f\u5e42\u3002\n\n\u5177\u4f53\u7684\uff0c\u5047\u8bbe\u9012\u63a8\u5f0f\u4e3a $f_n=af_{n-1}+bf_{n-2}$\n\n$$\n\\begin{bmatrix}\nf_{n+1}&f_{n}\n\\end{bmatrix}\n=\\begin{bmatrix}\nf_2&f_1\n\\end{bmatrix}\n\\begin{bmatrix}\na&1\\\\b&0\n\\end{bmatrix}^{n-1}\n$$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nconst int N=100005;\nvoid write(__int128 x)\n{\n\tint sta[30];\n\tint top=0;\n\tdo{\n\t\tsta[top++]=x%10,x/=10;\n\t}while(x);\n\twhile(top) putchar(sta[--top]+48);\n}\nstruct matrix{\n\tint n,m;\n\t__int128 num[3][3];\n\t/*void print()\n\t{\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tfor(int j=1;j<=m;j++)\n\t\t\t{\n\t\t\t\twrite(num[i][j]);\n\t\t\t\tprintf(\" \");\n\t\t\t}\n\t\t\tprintf(\"\\n\");\n\t\t}\n\t}*/\n};\n__int128 P=7528443412579576937;\nmatrix operator *(const matrix& a,const matrix& b)\n{\n\tmatrix c;\n\tmemset(c.num,0,sizeof(c.num));\n\tc.n=a.n;\n\tc.m=b.m;\n\tint n=c.n,m=c.m;\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tfor(int t=1;t<=a.m;t++)\n\t\t\t{\n\t\t\t\tc.num[i][j]+=a.num[i][t]*b.num[t][j];\n\t\t\t\tc.num[i][j]%=P;\n\t\t\t}\n\n\treturn c;\n}\nmatrix ksm(matrix a,ll b)\n{\n\tif(b==1) return a;\n\tmatrix tmp;\n\tif(b%2==0)\n\t{\n\t\ttmp=ksm(a,b/2);\n//\t\tprintf(\"KSM a %lld\\n\",b/2);\n//\t\ttmp.print();\n\t\treturn tmp*tmp;\n\t}\n\telse\n\t{\n\t\ttmp=ksm(a,b/2);\n//\t\tprintf(\"KSM a %lld\\n\",b/2);\n//\t\ttmp.print();\n\t\treturn tmp*tmp*a;\n\t}\n}\n\n__int128 read()\n{\n    __int128 x=0;\n    char ch=getchar();\n    while(ch<'0'||ch>'9')\n    {\n        ch=getchar();\n    }\n    while(ch>='0' && ch<='9')\n        x=x*10+ch-'0',ch=getchar();\n    return x;\n}\n__int128 b,d;\nll n;\nmatrix A,B;\nint main()\n{\n\tb=read(); d=read();\n\tscanf(\"%lld\",&n);\n\tif(n==0)\n\t{\n\t\tprintf(\"1\");\n\t\treturn 0;\n\t}\n\tA.m=B.n=B.m=2;\n\tA.n=1;\n\tA.num[1][1]=b;\n\tA.num[1][2]=2;\n\tB.num[1][1]=b;\n\tB.num[1][2]=1;\n\tB.num[2][1]=(d-b*b)/4;\n\tB.num[2][2]=0;\n//\tprintf(\"A=\\n\");\n//\tA.print();\n//\tprintf(\"B=\\n\");\n//\tB.print();\n\tA=A*ksm(B,n-1);\n//\tprintf(\"A=\\n\");\n//\tA.print();\n\twrite(A.num[1][1]-(n%2==0));\n\treturn 0;\n}\n```",
        "postTime": 1651027875,
        "uid": 148507,
        "name": "_Imaginary_",
        "ccfLevel": 0,
        "title": "P3263 \u9898\u89e3"
    }
]
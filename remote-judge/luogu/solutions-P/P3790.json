[
    {
        "content": "## \u4e00\u53e5\u8bdd\u9898\u610f\n\n\n\u6c42\u65e0\u5411\u56fe\u7684\u6240\u6709\u751f\u6210\u6811\u7684\u6743\u503cgcd\u4e4b\u548c\u3002\n\n\n## 20\u5206\u505a\u6cd5\n\n\n\u66b4\u529b\u679a\u4e3e\u8fb9\u7684\u96c6\u5408\uff0c\u5224\u65ad\u662f\u5426\u662f\u751f\u6210\u6811\uff0c\u8ba1\u7b97gcd\u5e76\u6c42\u548c\u3002\n\n\n\u590d\u6742\u5ea6$O(N logW 2^M)$\n\n\n## 30\u5206\u505a\u6cd5\n\n\n\u572820\u5206\u505a\u6cd5\u7684\u57fa\u7840\u4e0a\u52a0\u4e00\u4e9b\u526a\u679d\uff0c\u6216\u8005\u7528dfs\u6765\u679a\u4e3e\u751f\u6210\u6811\u3002\n\n\n## 50\u5206\u505a\u6cd5\n\n\n\u56e0\u4e3a\u503c\u57df\u4e0d\u5927\uff0c\u8003\u8651\u679a\u4e3egcd\u7684\u503c\u5e76\u8fdb\u884c\u5bb9\u65a5\uff08\u53cd\u6f14\uff09\u3002\n\n\n\u63a8\u5f0f\u5b50\uff1a\n\n\n\u8bbe$f(n)=$\u6743\u503cgcd\u4e3an\u7684\u751f\u6210\u6811\u4e2a\u6570\uff0c\u6211\u4eec\u53d1\u73b0$f(n)$\u4e0d\u662f\u5f88\u597d\u76f4\u63a5\u8ba1\u7b97\u3002\n\n\n\u4e8e\u662f\u8bbe$F(n)=$\u6743\u503cgcd**\u88abn\u6574\u9664**\u7684\u751f\u6210\u6811\u4e2a\u6570\uff0c\n\n\n\u663e\u800c\u6613\u89c1\uff0c$F(n)=\\sum_{n|d} f(d)$\u3002\n\n\n\u800c\u4e14$F(n)$\u6bd4\u8f83\u5bb9\u6613\u5f97\u5230\uff08\u53ef\u4ee5\u901a\u8fc7\u77e9\u9635\u6811\u5b9a\u7406\u5728$O(N^3)$\u7684\u65f6\u95f4\u5185\u8ba1\u7b97\uff09\u3002\n\n\n\u8fdb\u884c\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u5f97\u5230$f(n)=\\sum_{n|d} \\mu(\\frac{d}{n})F(d)$\n\n\n\u4e8e\u662f\n\n$ans=\\sum_{n=1}^W {n f(n)}$\n\n\n$=\\sum_{n=1}^W {n \\sum_{n|d} {\\mu(\\frac{d}{n})F(d)}}$\n\n\n$=\\sum_{d=1}^W {F(d) \\sum_{n|d} {n \\mu(\\frac{d}{n})}}$\n\n\n$=\\sum_{d=1}^W {F(d) \\phi(d)}$\n\n\n\u679a\u4e3ed\u4ece1\u5230W\uff0c\u7136\u540e\u52a0\u5165d\u6574\u9664\u6743\u503c\u7684\u8fb9\uff0c\u4f7f\u7528\u77e9\u9635\u6811\u5b9a\u7406\u8ba1\u7b97F\uff0c\u6ce8\u610f\u5224\u65ad\u751f\u6210\u6811\u4e2a\u6570\u4e3a0\u7684\u60c5\u51b5\uff08\u56fe\u4e0d\u8054\u901a\uff09\u3002\n\n\n\u590d\u6742\u5ea6$O(W(M+N^3))$\n\n\n## \u53e6\u591620\u5206\u505a\u6cd5\uff08v=u+1\uff09\n\n\n\u6ce8\u610f\u5230\u751f\u6210\u6811\u90fd\u662f\u4e00\u6761\u94fe\uff0c\u4e0d\u9700\u8981\u4f7f\u7528\u77e9\u9635\u6811\u5b9a\u7406\uff0c\u76f4\u63a5\u5229\u7528**\u4e58\u6cd5\u539f\u7406**\u8ba1\u7b97\u3002\n\n\n\u590d\u6742\u5ea6$O(WM)$\n\n\n## 100\u5206\u505a\u6cd5\n\n\n\u572850\u5206\u505a\u6cd5\u7684\u57fa\u7840\u4e0a\u8fdb\u4e00\u6b65\u4f18\u5316\uff1a\n\n\n\u6ce8\u610f\u5230\u5f88\u591a\u65f6\u5019\u751f\u6210\u6570\u4e2a\u6570\u4e3a0\uff08\u56fe\u4e0d\u8054\u901a\uff09\uff0c\u4e00\u4e2a\u663e\u7136\u7684\u5145\u5206\u6761\u4ef6\u662f**\u6ee1\u8db3\u6761\u4ef6\u7684\u8fb9\u6570<N-1**\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u9884\u5148\u7b5b\u6389\u8fd9\u4e9b\u60c5\u51b5\u3002\n\n\n\u5bf9\u4e8e\u6bcf\u4e00\u6761\u8fb9\uff0c\u53ea\u4f1a\u5bf9\u5b83\u6743\u503c\u7684\u56e0\u6570d\u9020\u6210\u5f71\u54cd\uff0c\u7136\u540e\u7edf\u8ba1\u6bcf\u4e2a\u6570\u4f5c\u4e3a\u56e0\u6570\u51fa\u73b0\u4e86\u591a\u5c11\u6b21\uff0c\u5c0f\u4e8eN-1\u7684\u4e0d\u7528\u8ba1\u7b97\u3002\n\n\u5bf9\u4e8e\u5c0f\u4e8e$\\sqrt{W}$\u7684\u56e0\u5b50\uff0c\u5b83\u4eec\u6bcf\u4e2a\u6700\u591a\u51fa\u73b0\u4e00\u6b21\uff1b\u5bf9\u4e8e\u8d85\u8fc7$\\sqrt{W}$\u7684\u56e0\u5b50\uff0c\u7531\u4e8e\u8fb9\u6743\u4e0d\u8d85\u8fc7$W$\uff0c\u6bcf\u4e2a\u8fb9\u6743\u81f3\u591a\u53ea\u6709\u4e00\u4e2a\u5927\u56e0\u5b50\u3002\u6240\u4ee5\u6709\u6548\u7684\u56e0\u5b50\u603b\u6570\u6700\u591a\u4e3a$\\sqrt{W}+\\frac{M}{N-1}$\uff0c\u7ea6\u4e3a2000\u3002\n\n\n\u590d\u6742\u5ea6$O((\\sqrt{W}+\\frac{M}{N-1})(M+N^3))$\u3002\n",
        "postTime": 1496155989,
        "uid": 15326,
        "name": "will7101",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3790 \u3010\u6587\u827a\u6570\u5b66\u9898\u3011"
    },
    {
        "content": "\u5efa\u8bae\u6539\u4e3a \u7701 \u9009 \u539f \u9898\n\n\u9898\u610f\uff1a\u6c42\u6240\u6709\u751f\u6210\u6811\u7684\u8fb9\u6743 $ \\gcd $ \u4e4b\u548c\u3002\n\n\u770b\u5230 $ \\gcd $ \u7acb\u523b\u60f3\u53cd\u6f14\u3002\n$$ \\sum_T\\gcd_{e \\in T}e_v $$\n\u8fd9\u91cc\u8bbe $ E=e_v(e \\in T) $\n$$ \\sum_T\\gcd_E $$\n$$ \\sum_T\\sum_{d \\mid e(e \\in E)}\\varphi(d) $$\n$$ \\sum_{d=1}^{\\infty}\\sum_{T,T \\in E(e_v \\in E(d \\mid e_v))} $$\n\u4e5f\u5c31\u662f\u8bf4\u53ea\u9700\u8981\u6c42\u8fb9\u6743\u4e3a $ d $ \u7684\u500d\u6570\u7684\u8fb9\u6784\u6210\u7684\u56fe\u7684\u751f\u6210\u6811\u4e2a\u6570\u5373\u53ef\uff0c\u4f7f\u7528\u77e9\u9635\u6811\u3002\n\n\u7a0d\u5fae\u526a\u679d\u4e00\u4e0b\uff0c\u590d\u6742\u5ea6\u5927\u6982\u662f $ O(240mn^3+V\\log V) $\uff0c\u5b9e\u6d4b\u53ef\u4ee5\u901a\u8fc7\u3002\n```cpp\n#include<cstdio>\n#include<vector>\ntypedef unsigned ui;\nconst ui M=1e6+5,mod=1e9+7;\nui n,m,mx,top,G[65][65],u[3005],v[3005],pos[M],pri[M],phi[M];std::vector<ui>id[M];\ninline ui Add(const ui&a,const ui&b){\n\treturn a+b>=mod?a+b-mod:a+b;\n}\ninline ui Del(const ui&a,const ui&b){\n\treturn b>a?a-b+mod:a-b;\n}\ninline ui pow(ui a,ui b){\n\tui ans=1;\n\tfor(;b;b>>=1,a=1ull*a*a%mod)if(b&1)ans=1ull*ans*a%mod;\n\treturn ans;\n}\ninline ui Gauss(){\n\tui i,j,k,d,inv,ans(1);\n\tfor(i=1;i^n;++i){\n\t\tif(!G[i][i])for(j=i+1;j^n;++j)if(G[j][i]){\n\t\t\tans=mod-ans;std::swap(G[i],G[j]);break;\n\t\t}\n\t\tinv=pow(G[i][i],mod-2);ans=1ull*ans*G[i][i]%mod;\n\t\tfor(j=i+1;j^n;++j)for(d=1ull*(mod-G[j][i])*inv%mod,k=i;k^n;++k)G[j][k]=(G[j][k]+1ull*d*G[i][k])%mod;\n\t}\n\treturn ans;\n}\ninline ui Solve(const ui&x){\n\tui i,j;\n\tfor(i=1;i^n;++i)for(j=1;j^n;++j)G[i][j]=i^j?mod:0;\n\tfor(i=1;(j=i*x)<=mx;++i)for(ui&x:id[j])++G[u[x]][u[x]],++G[v[x]][v[x]],--G[u[x]][v[x]],--G[v[x]][u[x]];\n\treturn Gauss();\n}\nsigned main(){\n\tui i,j,x,S,val,ans;\n\tscanf(\"%u%u\",&n,&m);\n\tfor(i=1;i<=n;++i)for(j=1;j<=n;++j)G[i][j]=i^j?mod:0;\n\tfor(i=1;i<=m;++i){\n\t\tscanf(\"%u%u%u\",u+i,v+i,&val);id[val].push_back(i);if(val>mx)mx=val;\n\t\t++G[v[i]][v[i]];++G[u[i]][u[i]];--G[u[i]][v[i]];--G[v[i]][u[i]];\n\t}\n\tans=Gauss();\n\tfor(i=2;i<=mx;++i){\n\t\tif(!pos[i])pos[pri[++top]=i]=top,phi[i]=i-1;S=0;\n\t\tfor(j=1;(x=i*j)<=mx;++j)S+=id[x].size();if(S>=n-1)ans=(ans+1ull*phi[i]*Solve(i))%mod;\n\t\tfor(j=1;j<=pos[i]&&(x=i*pri[j])<=mx;++j)phi[x]=phi[i]*(pri[j]-((pos[x]=j)!=pos[i]));\n\t}\n\tprintf(\"%u\",ans);\n}\n```",
        "postTime": 1638363435,
        "uid": 160839,
        "name": "Prean",
        "ccfLevel": 7,
        "title": "\u7ebf\u6027\u4ee3\u6570 \u77e9\u9635\u6811 P3790\u9898\u89e3"
    }
]
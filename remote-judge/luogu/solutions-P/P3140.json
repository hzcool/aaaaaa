[
    {
        "content": "**\u77e5\u8bc6\u70b9\uff1aDP**\n\n~~\u505a\u6cd5\u4e0d\u592a\u597d\u7406\u89e3 \u4ee3\u7801\u4e2d\u6709\u6ce8\u91ca~~\n\n\u628a\u73af\u8f6c\u5316\u4e3a\u5728\u7ebf\u6027\u65f6\u95f4\u5185\u505a\uff1a**rotate(q,q+1,q+n);** ~~\u624b\u52a8\u8c03\u8bd5\u770b\u770b~~\n\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a**f[kk][j]=min(f[kk][j],val+f[kk-1][a]);**\n\n**\u5f00kk\u9053\u95e8\u5f00\u7b2cj\u4e2a\u623f\u95f4\u5176\u4ed6\u725b\u7684\u8def\u7a0b=min(\u5176\u4ed6\u623f\u95f4\u7684\u725b\u5230j\u623f\u95f4\u7684\u8def\u7a0b+\u4e0a\u4e00\u6b21\u5f00\u7b2ca\u9053\u95e8\u82b1\u8d39\u7684\u8def\u7a0b)**\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<cstring>\n#include<algorithm>\n#include<queue>\n#include<stack>\n#include<set>\n#define MAXN 100005\n#define LL long long\n#define INF 2147483647\n#define MOD 1000000007\n#define free(s) freopen(\"s.txt\",\"r\",stdin);\n#define lowbit(x) ((x&(-x))) \n#define debug(x) cout<<x<<endl;\nusing namespace std;\nconst int L=1005;\nLL int n,k,q[L],ans=INF,f[10][L];\nint main()\n{\n\tscanf(\"%d%d\",&n,&k);\n\tfor(int i=0;i<n;i++)\n\t\tscanf(\"%d\",&q[i]);\n  \tfor(int i=0;i<n;i++)\n  \t{\n\t\tmemset(f,0x3f,sizeof(f));\n\t\tf[0][n]=0;\n\t\tfor(int kk=1;kk<=k;kk++)//\u5f53\u524d\u7b2c\u51e0\u9053\u95e8\n\t\t{\n   \t  \t\tfor(int j=0;j<n;j++)//\u5f00\u7b2cj\u4e2a\u623f\u95f4\n\t\t  \t{\n       \t\t\tlong long val=0;\n       \t\t\tfor(int a=j+1;a<=n;a++)//j\u4ee5\u540e\u7684\u623f\u95f4\u5230j\u82b1\u8d39\u7684\u603b\u8def\u7a0b \n\t\t\t\t{\n        \t\t\t val+=q[a-1]*(a-j-1);\n        \t\t\t f[kk][j]=min(f[kk][j],val+f[kk-1][a]);\n       \t\t\t}\n     \t\t}\n  \t\t}\n  \t\tans=min(ans,f[k][0]);\n  \t\trotate(q,q+1,q+n);//\u9876\u5143\u7d20\u79fb\u5230\u672b\u4f4d\u7f6e\uff1a\u62c6\u73af\u4e3a\u94fe \n\t}\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1529197152,
        "uid": 37427,
        "name": "\u66f9\u8001\u5e08",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3140 \u3010[USACO16FEB]\u518d\u63a2\u5706\u5f62\u8c37\u4ed3Circular Barn R\u2026\u3011"
    },
    {
        "content": "\u8fd9\u79cd\u73af\u7684\u9898\u628a\u73af\u6253\u5f00\u53d8\u6210\u94fe\u5e94\u8be5\u4e0d\u96be\u60f3\u5230\uff0c\u5c31\u4e0d\u591a\u8bf4\u4e86\u3002\uff08\u591a\u8bf4\u4e00\u53e5\uff1aN\u4e2a\u5143\u7d20\u7684\u73af\u53d8\u6210\u7684\u94fe\u662fa[1]\u5230a[N]\u518d\u7531a[1]\u5230a[N-1]\uff0c\u51712\\*N-1\u4e2a\u5143\u7d20\u3002\u7b97\u4e86\u4e00\u4f1a\u770b\u4ee3\u7801\u5427\u3002\uff09\n\n\n\u9898\u76ee\u4e2d\u8bf4\u725b\u4eec\u662f\u987a\u65f6\u9488\u8fdb\u5165\u7684\u8c37\u4ed3\uff0c\u53ef\u4ee5\u8f6c\u6362\u6210\u725b\u4eec\u5df2\u7ecf\u5728\u8c37\u4ed3\u4e2d\u7ad9\u597d\u4e86\uff0c\u8981\u9006\u65f6\u9488\u51fa\u8c37\u4ed3\uff0c\u8fd9\u6837\u9012\u63a8\u516c\u5f0f\u66f4\u597d\u6c42\uff0c\u7531\u4e8e\u672c\u4eba\u4e00\u5947\u602a\u7684\u7656\u597d\uff0c\u4e0d\u5927\u559c\u6b22\u4ece\u53f3\u5f80\u5de6\u6c42dp\uff0c\u6240\u4ee5\u6211\u662f\u53cd\u7740\u8bfb\u5165\u7684\uff0c\u5c31\u662f\u4e0d\u5b9e\u9645\u4e0a\u7684a[i]\u5b58\u5728\u4e86a[N-i+1]\u4e2d\uff0c\u8fd9\u6837\u5728\u6c42dp\u662f\u5c31\u662f\u4e00\u5806\u725b\u5728\u8c37\u4ed3\u4e2d\u4ece\u5de6\u5f80\u53f3\u8d70\u3002\uff08\u4e2a\u4eba\u8ba4\u4e3a\u66f4\u597d\u7406\u89e3\uff0c\u5982\u679c\u4f60\u4e0d\u8fd9\u6837\u8ba4\u4e3a\uff0c\u5c31\u7b97\u4e86\u3002\uff09\n\n\n\u4e4b\u540e\u5c31\u662f\u5bf9\u82b1\u8d39\u9884\u5904\u7406\uff0cimp[i][j]\u8868\u793a\u4ecei\u5230j\u533a\u95f4\u4e2d\u7684\u725b\u90fd\u5230j\u7684\u82b1\u8d39\u3002\uff08\u6709\u9012\u63a8\u6027\u3002\uff09\n\n\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5728\u7a0b\u5e8f\u91cc\u81ea\u5df1\u770b\u5427\uff0c\u5e94\u8be5\u80fd\u770b\u61c2\u3002\u3002\u3002\n\n\n\u4ee3\u7801\uff1a\n\n\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint N,K;\nint a[210];\nlong long dp[210][10][210];\n//dp[p][i][j]\u8868\u793a\u4ee5p\u4f5c\u4e3a\u5f00\u5934\u5904\u7406\u5230j\u5e76\u4e14\u4e00\u5b9a\u5728j\u5f00\u95e8\uff0c\u5728[p,j]\u7684\u533a\u95f4\u5185\u5f00\u4e86i\u4e2a\u95e8\u65f6\u7684\u6700\u5c0f\u82b1\u8d39\nlong long imp[210][210];\n//imp[i][j]\u8868\u793a[i,j]\u533a\u95f4j\u5904\u5f00\u95e8\u7684\u82b1\u8d39\nint n;\nint main()\n{\n    scanf(\"%d%d\",&N,&K);\n    n=N;\n    while(n>0)//\u53cd\u7740\u5b58\n    {\n        scanf(\"%d\",&a[n]);\n        n--;\n    }\n    for(int i=N+1;i<2*N;i++)//\u628a\u73af\u6253\u5f00\n    {\n        a[i]=a[i-N];\n    }\n    for(int j=2*N-1;j>=1;j--)//\u6c42imp[i][j]\n    {\n        for(int i=j;i>=max(j-N,1);i--)\n        {\n            if(i==j)\n            {\n                imp[i][j]=0;//\u5728\u672c\u4ed3\u5e93\u5f00\u95e8\u672c\u4ed3\u5e93\u65e0\u82b1\u8d39\n            }\n            else\n            {\n                imp[i][j]=imp[i+1][j]+a[i]*(j-i);//\u5229\u7528imp\u7684\u9012\u63a8\u6027\n            }\n        }\n    }\n    for(int p=1;p<=N;p++)//\u7ed9dp\u8d4b\u521d\u503c\n    {\n        for(int i=1;i<=K;i++)\n        {\n            for(int j=p+i-1;j<=p+N-1-K+i;j++)\n            {\n                dp[p][i][j]=100000000000;\n            }\n        }\n    }\n    for(int p=1;p<=N;p++)//\u5c31\u5f00\u4e00\u4e2a\u95e8\u65f6\u82b1\u8d39\u5c31\u662fimp[p][j]\n    {\n        for(int j=p;j<=p+N-1;j++)\n        {\n            dp[p][1][j]=imp[p][j];\n        }\n    }\n    for(int p=1;p<=N;p++)//\u679a\u4e3e\u8d77\u70b9\n    {\n        for(int i=2;i<=K;i++)//\u679a\u4e3e\u5f00\u95e8\u6570\n        {\n            for(int j=p+i-1;j<=p+N-1-K+i;j++)//\u679a\u4e3e\u7ec8\u70b9\n            {\n                for(int x=j-1;x>p+i-2;x--)\n                {\n                    dp[p][i][j]=min(dp[p][i-1][x]+imp[x+1][j],dp[p][i][j]);//\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\n                }\n            }\n        }\n    }\n    long long ans=dp[1][K][N];//\u627e\u4ee5\u54ea\u4e2a\u70b9\u4f5c\u4e3a\u8d77\u70b9\u7ed3\u679c\u6700\u5c0f\n    for(int p=2;p<=N;p++)\n    {\n       ans=min(ans,dp[p][K][N+p-1]);\n    }\n    printf(\"%d\",ans);\n    return 0;\n}\n\n```",
        "postTime": 1502267474,
        "uid": 47180,
        "name": "\u559d\u62b9\u8336\u7684\u5e03\u4e01",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3140 \u3010[USACO16FEB]\u518d\u63a2\u5706\u5f62\u8c37\u4ed3Circular Barn R\u2026\u3011"
    },
    {
        "content": "[\u535a\u5ba2\u5185\u98df\u7528\u6548\u679c\u66f4\u4f73](https://www.luogu.com.cn/blog/Ksy/solution-p3140)\n\n\u601d\u8def\uff1a\u73af\u5f62 DP  \n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(n^3k)$  \n\n**\u672c\u9898\u89e3\u9898\u76ee\u4e2d\u6240\u7ed9\u6700\u591a\u80fd\u6253\u5f00\u7684\u95e8\u6570\u91cf\u7528 $K$ \u8868\u793a\uff0c\u9898\u89e3\u4e2d\u7684 $k$ \u5747\u4e3a\u5faa\u73af\u53d8\u91cf\u3002**\n\n\u8bbe $F_{i,j}$ \u4e3a\u6253\u5f00 $i$ \u53f7\u95e8\u540e\u4e00\u5171\u6253\u5f00 $j$ \u4e2a\u95e8\u7684\u603b\u8def\u7a0b\u6700\u5c0f\u503c\uff0c\u5f97\u5230\u8f6c\u79fb\u65b9\u7a0b\uff1a  \n$$F_{i,j}=\\min\\left\\{F_{k,j-1}+sum_{k,i}\\right\\}$$\n\u5176\u4e2d $k$ \u4e3a\u679a\u4e3e\u7684\u5728 $i$ \u4e4b\u524d\u6700\u8fd1\u7684\u6253\u5f00\u7684\u95e8\uff0c$sum_{k,i}$ \u8868\u793a\u4ece\u95e8 $k$ \u8f6c\u79fb\u5230 $i$ \u6240\u4ea7\u751f\u7684\u8def\u7a0b\u548c\uff0c\u9700\u8981\u8fdb\u884c\u9884\u5904\u7406\u3002\n\n\u56e0\u4e3a\u662f\u73af\u5f62 DP\uff0c\u6240\u4ee5\u8003\u8651\u5c06\u539f\u6570\u7ec4\u589e\u957f\u4e00\u500d\u8fdb\u884c\uff0c\u5e76\u679a\u4e3e\u6bcf\u4e00\u4e2a\u8282\u70b9\u4f5c\u4e3a\u7b2c\u4e00\u4e2a\u6253\u5f00\u7684\u95e8\u8fdb\u884c DP\uff0c\u6700\u540e\u7edf\u8ba1\u7b54\u6848\u65f6\u8981\u52a0\u4e0a\u6700\u540e\u4e00\u4e2a\u95e8\u5230\u8d77\u70b9\u95e8\u4e4b\u95f4\u7684\u8d21\u732e\uff0c\u5373\uff1a\n\n$$ans=\\min\\left\\{F_{i,K}+sum_{i,st}\\right\\}$$\n\u5176\u4e2d $st$ \u4e3a\u679a\u4e3e\u7684\u8d77\u70b9\u3002\n\n\u4ee3\u7801\u5b9e\u73b0\u9700\u8981\u6ce8\u610f\u7684\u5730\u65b9\uff1a\n- \u56e0\u4e3a\u505a\u4e86\u589e\u957f\uff0c\u6240\u4ee5\u9884\u5904\u7406 $sum_{i,j}$ \u65f6\u9700\u8981\u8003\u8651 $i\\in\\left[n+1,2n-1\\right]$ \u7684\u60c5\u51b5\u3002\n- \u679a\u4e3e $F_{i,j}$ \u65f6\uff0c\u82e5 $i$ \u5230 $st$ \u7684\u8ddd\u79bb\u5c0f\u4e8e $K$\uff0c\u5219 $j$ \u65e0\u9700\u679a\u4e3e\u5230 $K$\uff0c\u53ea\u9700\u8981\u679a\u4e3e\u5230 $i-st+1$\u3002\n- \u6bcf\u6b21\u679a\u4e3e\u8d77\u70b9 $st$ \u8981\u6ce8\u610f\u7ed9 $F$ \u6570\u7ec4\u8d4b\u521d\u503c\u3002\n- \u9700\u8981\u5f00 long long\u3002\n\n\u4ee3\u7801\u4e2d $sum_{i,j}$ \u4fdd\u8bc1\u4e25\u683c $i<j$\u3002  \n\u53c2\u8003\u4ee3\u7801\uff1a\n```cpp\n#define LL long long\n#define UN unsigned\n#include<bits/stdc++.h>\nusing namespace std;\n\nconst int N=201;\n\nint n,K;\nLL a[N],sum[N][N];\n\nLL ans=INT_MAX,f[N][8];\n\nint main()\n{\n\tscanf(\"%d%d\",&n,&K);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%lld\",&a[i]);\n\t\ta[i+n]=a[i]; //\u589e\u957f\n\t}\n\t\n\tfor(int i=1;i<=2*n-1;i++)\n\t\tfor(int j=i+2;j<=min(2*n,i+n);j++)//\u6ce8\u610f\u8fb9\u754c\u5224\u65ad\n\t\t\tsum[i][j]=sum[i][j-1]+a[j-1]*(j-i-1);\n\tfor(int st=1;st<=n;st++)\n\t{\n\t\tmemset(f,0x3f,sizeof(f));\n\t\tf[st][1]=0;\n\t\tfor(int i=st+1;i<=st+n-1;i++)\n\t\t{\n\t\t\tint temp=min(i-st+1,K);//j \u679a\u4e3e\u8303\u56f4\n\t\t\tfor(int j=2;j<=temp;j++)\n\t\t\t\tfor(int k=st;k<i;k++)\n\t\t\t\t\tf[i][j]=min(f[i][j],f[k][j-1]+sum[k][i]);\n\t\t}\n\t\tfor(int i=st+K-1;i<=st+n-1;i++)\n\t\t\tans=min(ans,f[i][K]+sum[i][st+n]);//st+n \u4fdd\u8bc1 i<st+n\n\t}\n\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1683273606,
        "uid": 998247,
        "name": "One_Ksy",
        "ccfLevel": 0,
        "title": "[\u9898\u89e3] P3140 [USACO16FEB]Circular Barn Revisited G"
    },
    {
        "content": "\u6211\u7528\u7684\u662f\u5b98\u65b9\u9898\u89e3\u4e2d\u63d0\u5230\u7684\u5229\u7528\u5206\u6cbb\u4f18\u5316 $O(n^3 k)$ \u7684\u66b4\u529b\u7a0b\u5e8f\u7684\u505a\u6cd5\u3002\u4f18\u5316\u540e\u590d\u6742\u5ea6\u4e3a $O(n^2k \\log n)$ \u3002\n\n\u8bbe $f[i][j]$ \u8868\u793a\u5230\u4e86 $j-1$ \u4f4d\u7f6e\u4e00\u5171\u5f00\u4e86 $i$ \u6247\u95e8\u3002 $f[0][n]$ \u521d\u59cb\u5316\u4e3a $0$ \u3002\uff08\u6709\u4e00\u7ef4\u8d77\u70b9\u9690\u85cf\u6389\u4e86\uff09 \u3002\n\n$f[i][j] = \\min { \\{ f[i-1][k] + sum_{k,j}\\} }$ \uff0c\u5176\u4e2d $k$ \u662f\u5f00\u95e8\u7684\u4f4d\u7f6e\u3002\n\n\u76f4\u63a5\u8dd1\u663e\u7136\u662f\u4e0d\u884c\u7684\uff0c\u679a\u4e3e\u8d77\u70b9\u3001\u5f00\u95e8\u6570\u3001\u7ec8\u70b9\u3001\u5f00\u95e8\u70b9\u9700\u8981 $O(n^3 k)$ \u7684\u590d\u6742\u5ea6\u3002\n\n\u5982\u679c\u8ba1\u7b97\u7b2c $i$ \u4e2a\u95e8\u5728 $f[i][n/2]$ \u4e2d\u7684\u4f4d\u7f6e\uff0c\u90a3\u4e48\u5bf9\u4e8e $j<n/2$ \u7684 $f[i][j]$ \u5fc5\u987b\u5728\u5176\u5de6\u4fa7\uff0c\u5bf9\u4e8e $j>n/2$ \u7684 $f[i][j]$ \u5fc5\u987b\u5728\u5176\u53f3\u4fa7\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u9012\u5f52\u7684\u6bcf\u4e2a\u7ea7\u522b\u5e73\u5747\u5c06\u641c\u7d22\u7a7a\u95f4\u51cf\u534a\u3002\u8fd9\u6837\u5c31\u5c06\u590d\u6742\u5ea6\u964d\u4e86\u4e00\u4e2a\u7ea7\u522b\u3002\u4e5f\u5c31\u662f $O(n^2k \\log n)$ \u3002\n\n```cpp\n#include <iostream>\n#include <vector>\n#include <algorithm>\n#include <cstring>\nusing namespace std;\nconst int N = 1005, K = 10;\n#define INF 0x3fffffffffffffff\nint t, n, k;\nlong long a[N], f[K][N], s[N][N];\ninline int pos(int x, int y) {\n  return x+y>=n?x+y-n:x+y;\n}\ninline long long calc(int a, int b) {\n  return s[pos(a, t)][pos(b, n - a)];\n}\ninline void dfs(int k, int x1, int x2, int y1, int y2) {\n\tif (x1 == x2) return;\n\tint midx = (x1 + x2) >> 1;\n\tint midy = -1;\n\tf[k][midx] = INF;\n\tfor (int j = max(midx + 1, y1); j < y2; j++) {\n\t\tlong long v = f[k - 1][j] + calc(midx, j);\n\t\tif (v < f[k][midx]) {\n\t\t\tmidy = j;\n\t\t\tf[k][midx] = v;\n\t\t}\n\t}\n\tdfs(k, x1, midx, y1, midy + 1);\n\tdfs(k, midx + 1, x2, midy, y2);\n\treturn;\n}\nint main() {\n\tios::sync_with_stdio(false);\n\tcin.tie(NULL);\n\tcin >> n >> k;\n\tfor (int i = n - 1; ~i; i--)  cin >> a[i];\n\tfor (int i = 0; i < n; i++) {\n    \tlong long sum = 0;\n\t\tfor (int j = 1; j <= n; j++) {\n\t\t\ts[i][j] = s[i][j - 1] + sum;\n\t\t\tsum += a[pos(i, j - 1)];\n\t\t}\n\t}\n\tmemset(f, 63, sizeof(f));\n\tlong long ans = INF;\n\tf[0][n] = 0;\n\tfor (t = 0; t < n; t++) {\n\t\tfor (int i = 1; i <= k; i++) dfs(i, 0, n, 1, n + 1);\n\t\tans = min(ans, f[k][0]);\n\t}\n\tcout << ans << '\\n';\n\treturn 0;\n}\n```\n",
        "postTime": 1639028471,
        "uid": 434929,
        "name": "Usada_Pekora",
        "ccfLevel": 7,
        "title": "P3140 DP+\u5206\u6cbb"
    },
    {
        "content": "\u6211\u4e0d\u77e5\u9053\u5404\u4f4d\u5927\u7287\u662f\u600e\u4e48\u505a\u7684\uff0c\u53cd\u6b63\u6211\u7528\u7684\u662f\u52a8\u89c4\u3002\n\n\u590d\u6742\u5ea6\uff1aO\uff08n3+n3\u00d7s\uff09\n\n\u5148\u7834\u73af\u4e3a\u94fe\uff0c\u7136\u540e\u7528map\u6570\u7ec4\u8868\u793ai\uff5ej\u8981\u4ed8\u51fa\u7684\u4ee3\u4ef7\n\nf[i][j]\u8868\u793a\u524di\u4e2a\u5f00j\u4e2a\u95e8\u7684\u6700\u5c0f\u4ee3\u4ef7\n\n\u8f6c\u79fb\u65b9\u7a0b\u5728\u4ee3\u7801\u91cc\u4e86\n\n    \n```cpp\n#include<cstdio>\n#include<cstring>\n#define INF 1000000000\n#define ll long long\nusing namespace std;\nll n,s,a[210],ans=INF;\nll map[110][110],f[110][8];\nll min(ll a,ll b) {return a<b?a:b;} \nint main()\n{\n    int i,j,k,t;\n    scanf(\"%d %d\",&n,&s);\n    for(i=1;i<=n;i++) { scanf(\"%d\",&a[i]);a[n+i]=a[i];}\n    for(t=1;t<=n;t++)\n    {\n        memset(f,0,sizeof(f));\n        memset(map,0,sizeof(map));\n        for(i=t;i<=n+t-1;i++)\n            for(j=i+1;j<=n+t-1;j++)\n                map[i-t+1][j-t+1]=map[i-t+1][j-t]+a[j]*(j-i);\n        /*for(i=1;i<=n;i++)\n        {\n            for(j=i;j<=n;j++)\n                printf(\"%d \",map[i][j]);\n            printf(\"\\n\");\n        }*///\u8c03\u8bd5map\n        for(i=1;i<=n;i++) f[i][1]=map[1][i];\n        for(i=1;i<=n;i++)\n            for(j=2;j<=min(i,s);j++)\n            {\n                f[i][j]=INF;\n                for(k=j;k<i;k++)\n                    f[i][j]=min(f[i][j],f[k][j-1]+map[k+1][i]);//\u65b9\u7a0b\n            }\n        /*for(i=1;i<=n;i++)\n        {\n            for(j=1;j<=s;j++)\n                printf(\"%d \",f[i][j]);\n            printf(\"\\n\");\n        }printf(\"\\n\");*///\u8c03\u8bd5f\n        ans=min(ans,f[n][s]);\n    }\n    printf(\"%d\",ans);\n    return 0;\n}\n```",
        "postTime": 1492298522,
        "uid": 19390,
        "name": "functionendless",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3140 \u3010[USACO16FEB]\u518d\u63a2\u5706\u5f62\u8c37\u4ed3Circular Barn R\u2026\u3011"
    },
    {
        "content": "# pascal\u7684\u9898\u89e3\u597d\u5c11\u2026\u2026\n\n\u770b\u5230\u5176\u5b83\u7684\u9898\u89e3\u90fd\u662f$O(n^3k)$\uff0c\u4e0b\u9762\u662f$O(n^2k)$\u7b97\u6cd5\u3002\n\n\u539f\u9898\u9898\u610f\u53ef\u4ee5\u8f6c\u5316\u4e00\u4e0b\uff0c\u628a\u725b\u5b89\u6392\u5728$k$\u4e2a\u623f\u95f4\u91cc\uff0c\u5b83\u4eec\u53ef\u4ee5\u9006\u65f6\u9488\u8d70\uff0c\u4f7f\u5f97\u7b2c$i$\u4e2a\u4f4d\u7f6e\u6709$ri$\u5934\u725b\uff0c\u6c42\u6700\u77ed\u603b\u8def\u7a0b\u3002\n\n\u80fd\u60f3\u7684\u53ea\u6709$dp$\u4e86\u3002\n\n\u6211\u4eec\u5148\u9700\u8981\u7834\u73af\u4e3a\u94fe\uff0c\u8fd9\u662f\u7ecf\u5178\u73af\u72b6$dp$\u601d\u8def\u3002\n\n\u8fd8\u6709\uff0c\u8003\u8651\u5230\u6700\u5c0f\u8def\u7a0b\uff0c\u6211\u4eec\u80af\u5b9a\u662f\u628a\u4e00\u6bb5\u533a\u95f4\u7684\u725b\u5168\u90e8\u96c6\u4e2d\u5230\u533a\u95f4\u6700\u5de6\u7aef\uff0c\u8fd9\u6837\u6700\u4f18\u3002\u8fd9\u6837$dp$\u65b9\u7a0b\u5c31\u5f88\u597d\u60f3\u4e86\u3002\n\n\u8bbe$f[i,j]$\u8868\u793a\u5b89\u6392$i$\u4e2a\u95e8\uff0c\u524d$j$\u5934\u725b\u6240\u80fd\u4ea7\u751f\u7684\u6700\u77ed\u8def\u7a0b\u3002\n\n\u5219$f[i,j]=min(f[i,j],f[i-1,k]+\u2211(l-k-1)*r[l])(k+1<=l<=j,0<=k<j)$\n\n\u628a\u540e\u9762\u7684\uff08\u628a$[k+1,j]$\u7684\u725b\u96c6\u4e2d\u5230\u7b2c$k+1$\u4e2a\u4f4d\u7f6e\uff09\u5316\u5f00\uff0c\u7528\u524d\u7f00\u548c\uff0c$s1[i]=a[1]+a[2]\u2026\u2026a[i]$\uff0c$s2[i]=a[2]*(2-1)+\u2026\u2026a[i]*(i-1)$\u3002\n\n\u90a3\u4e48\uff0c\u540e\u9762\u7684\u5c31\u53d8\u6210\u4e86$s2[j]-s2[k]-k*(s1[j]-s1[k])$\u3002\n\n\u5ffd\u7565$i$\uff0c\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u659c\u7387\u4f18\u5316\u7684\u7ecf\u5178\u5f62\u5f0f\uff08\u5982\u679c\u4e0d\u77e5\u9053\u659c\u7387\u4f18\u5316\u53ef\u4ee5\u53bb\u770b[\u6d45\u8c08\u659c\u7387\u4f18\u5316](https://www.luogu.org/blog/top-oier/qian-tan-xie-shuai-you-hua)\uff09\u3002\n\n\u90a3\u4e48\uff0c\u8bbe\u8be5\u4e00\u6b21\u51fd\u6570\u4e3a$y=Kx+b$\uff0c\u5219\n\n$K=s1[i]$\n\n$x=j$\n\n$y=s1[j]*j+f[l-1,j]-s2[j]$\n\n$b=f[l,i]-s2[i]$\n\n\u4e8e\u662f\uff0c\u672c\u9898\u7ed3\u675f\uff0c\u5176\u4e2d\u72b6\u6001$O(nk)$\uff0c\u7834\u73af\u4e3a\u94fe$O(n)$\uff0c\u72b6\u6001\u8f6c\u79fb$O(1)$\uff0c\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6$O(n^2k)$\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```pascal\nvar f:array[0..7,0..1000] of int64;\n    s1,s2,a:array[0..1000] of int64;\n    q:array[0..1000] of longint;\n    n,k,p,l,r,i,j:longint;\n    minn:int64;\nfunction jiao(s,k1,k2:longint):extended; //\u6c42\u659c\u7387\nbegin\n  exit((s1[k1]*k1-s1[k2]*k2+f[s,k1]-f[s,k2]-s2[k1]+s2[k2])/(k1-k2));\nend;\nprocedure dp; //\u659c\u7387\u4f18\u5316dp\nvar m,i,j:longint;\nbegin\n  for m:=1 to k do\n  begin\n    f[m,0]:=0;l:=1;r:=1;q[1]:=0;\n    for i:=1 to n do\n    begin\n      while (l<r) and (jiao(m-1,q[l],q[l+1])<=s1[i]) do inc(l);\n      j:=q[l];f[m,i]:=f[m-1,j]+s2[i]-s2[j]-j*(s1[i]-s1[j]);\n      while (l<r) and (jiao(m-1,i,q[r-1])<=jiao(m-1,q[r-1],q[r])) do dec(r);\n      inc(r);q[r]:=i;\n    end;\n  end;\nend;\nbegin\n  minn:=1000000000000000000;\n  readln(n,k);\n  for i:=1 to n do readln(a[i]);\n  for j:=1 to n do //\u7834\u73af\u4e3a\u94fe\n  begin\n    fillchar(f[0],sizeof(f[0]),127);f[0,0]:=0;\n    s1[0]:=0;s2[0]:=0;\n    for i:=1 to n do begin s1[i]:=s1[i-1]+a[i];s2[i]:=s2[i-1]+a[i]*(i-1);end;\n    //for i:=1 to n do write(s1[i],' ');writeln;\n    //for i:=1 to n do write(s2[i],' ');writeln;\n    dp;\n    if f[k,n]<minn then minn:=f[k,n];\n    p:=a[1];for i:=2 to n do a[i-1]:=a[i];a[n]:=p; //\u8f6c\u6362\u5230\u4e0b\u4e00\u4e2a\u94fe\uff0c\u628a\u7b2c\u4e00\u4e2a\u653e\u5230\u6700\u540e\u4e00\u4e2a\n  end;\n  writeln(minn);\nend.\n```",
        "postTime": 1551613550,
        "uid": 43697,
        "name": "chenyewei_1234",
        "ccfLevel": 7,
        "title": "P3140 [USACO16FEB]\u518d\u63a2\u5706\u5f62\u8c37\u4ed3Circular Barn R\u2026"
    }
]
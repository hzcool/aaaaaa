[
    {
        "content": "\u8fd9\u662f\u4e00\u7bc7\u6709\u8be6\u7ec6\u8bc1\u660e\u7684\u9898\u89e3 $qwq$~\n\n\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u4e2a\u9898\u5c31\u662f\u4e3a\u4e86\u8ba9\u6211\u4eec\u89e3\u4e00\u4e2a\u65b9\u7a0b\uff1a\n\n$$\nx+km\\equiv y+kn\\pmod{l}\n$$\n\n\u5176\u4e2d $k$ \u4e3a\u6240\u6c42\u3002\n\n\u8ba9\u6211\u4eec\u628a\u8fd9\u4e2a\u770b\u4e0a\u53bb\u5f88 zz \u7684\u65b9\u7a0b\u53d8\u5316\u4e00\u4e0b\uff1a\n\n$$\nx+km-(y+kn)=lz,z \\in Z\n$$\n\n\u90a3\u4e48\u5c31\u662f\uff1a\n\n$$\n\\begin{aligned}\nx-y+k(m-n)-lz&=0\\\\\nk(m-n)-lz&=-(x-y)\n\\end{aligned}\n$$\n\n\u6211\u4eec\u8bbe $S=x-y,W=n-m$\uff08\u6ce8\u610f\u8fd9\u4e2a\u5730\u65b9\u6709\u53d8\u53f7\uff0c\u5373 $m-n$ \u88ab\u6211\u8bbe\u4f5c $n-m$\uff0c\u4e3a\u7684\u662f\u8ba9\u7b49\u5f0f\u53f3\u8fb9\u7684 $S$ \u51a0\u6b63\u53f7\uff09\u3002\n\n\u8fd9\u4e2a\u5f0f\u5b50\u4fbf\u53ef\u5199\u4f5c\uff1a\n\n$$\nkW+lz=S\n$$\n\n\u8bf6\uff0c\u8fd9\u4e0d\u5c31\u662f\u4e00\u4e2a\u4e0d\u5b9a\u65b9\u7a0b\u5417\uff1f\n\n\u5bf9\u554a\uff0c\u6240\u4ee5\u6211\u4eec\u6240\u8981\u505a\u7684\u5c31\u662f\u5bf9\u8fd9\u4e2a\u4e0d\u5b9a\u65b9\u7a0b\u6c42\u51fa\u6700\u5c0f\u89e3\u3002\n\n\u90a3\u4e48\u5176\u5b9e\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u65b9\u7a0b\uff0c\u6211\u4eec\u662f\u8981\u89e3\u51fa\u6b65\u6570\u7684\u6700\u5c0f\u503c\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa$k$\u6700\u5c0f\u5373\u53ef\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6269\u5c55\u6b27\u51e0\u91cc\u5fb7\u7b97\u6cd5\u6c42\u51fa\u4e00\u7ec4\u7279\u89e3\uff0c\u7136\u540e\u5bf9\u4e8e\u8fd9\u7ec4\u7279\u89e3\uff0c\u6211\u4eec\u518d\u63a8\u5bfc\u51fa\u6700\u5c0f\u89e3\u6765\u3002\n\n\u4f46\u7531\u4e8e\u8fd9\u4e2a\u65b9\u7a0b\u5728\u89e3 $exgcd$ \u7684\u65f6\u5019\uff0c\u90a3\u4e2a\u65b9\u7a0b\u8f6c\u5316\u6210\u4e86\uff1a\n\n$$\nk_jW+lz_j=(W,l)\n$$\n\n\u90a3\u4e48\u6211\u4eec\u6c42\u51fa\u7684 $k_j$ \u5c31\u662f\u8fd9\u4e2a\u65b9\u7a0b\u5f97\u4e00\u4e2a\u7279\u89e3\u3002\n\n\u4e4b\u540e\uff0c\u8fd9\u4e2a\u65b9\u7a0b\u7684\u6240\u6709\u89e3\u5c31\u53ef\u4ee5\u8868\u793a\u6210\n\n$$\nk_i=k_j+t\\frac{l}{gcd(W,l)}\n$$\n\n________________________\n\n\n_\u8fd9\u662f\u4e0a\u9762\u8fd9\u4e2a\u5f0f\u5b50\u4e3a\u4ec0\u4e48\u53ef\u4ee5\u8fd9\u4e48\u505a\u7684\u8bc1\u660e\uff1a_\n\n\u82e5\u6709 $ax+by=c$ \u4e14 $a_0x+b_0y=c$\u3002\n\n\u90a3\u4e48\u4fbf\u6709 $a(x-x_0)+b(y-y_0)=0$\u3002\n\n\u4e24\u8fb9\u540c\u65f6\u9664\u4ee5 $gcd(a,b)$ \u53ef\u5f97\n\n$$\n\\frac{a}{gcd(a,b)}(x-x_0)=-\\frac{b}{gcd(a,b)}(y-y_0)\\quad (1)\n\n$$\n\n\u800c\u56e0\u4e3a\n\n$$\n(\\frac{a}{gcd(a,b)},\\frac{b}{gcd(a,b)})=1\n$$\n\n\u6240\u4ee5\u7531 $(1)$ \u53ef\u5f97 $\\frac{b}{gcd(a,b)}$ \u6574\u9664 $(x-x_0)$\u3002\n\n\u6240\u4ee5\u5f88\u663e\u7136\u6709 \n\n$$\n\\frac{b}{gcd(a,b)}\\times{t}={(x-x_0)},t \\in \\mathbb{Z}\n$$\n\n\u90a3\u4e48\u5c31\u6709\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a $x_i$\uff0c\u6709\n\n$$\nx_i=x_0+\\frac{b}{gcd(a,b)} \\times{t}\n$$\n________________________\n____________________________\n\n\u8ba9\u6211\u4eec\u56de\u5230\u539f\u95ee\u9898\u3002\u56e0\u4e3a\n\n$$ \nk_j=k_{min}+\\frac{l}{gcd(W,l)} \\times{t} \n$$\n\n\u8fd9\u4e2a\u65b9\u7a0b\u5bf9\u4e8e $t \\in Z$ \u800c\u8a00\uff0c\u60f3\u8981\u901a\u8fc7\u4e00\u4e2a\u7279\u89e3\u63a8\u51fa\u6700\u5c0f\u89e3\uff0c\u53ef\u4ee5\u5982\u6b64\u505a\uff1a\n\n$$\nk_{min}=k_j \\bmod \\frac{l}{gcd(W,l)}\n$$\n\n\u800c\u56e0\u4e3a\u8fd9\u4e2a $k$ \u662f\u5efa\u7acb\u5728 $\\rm exgcd$ \u5f97\u51fa\u7684\u65b9\u7a0b\u4e0a\u7684\uff0c\u65b9\u7a0b\u53f3\u8fb9\u662f $gcd(W,l)$ \u800c\u4e0d\u662f $S$\u3002\u6240\u4ee5\u6700\u540e\u6211\u4eec\u9700\u8981\u5c06\u7ed3\u679c $\\times{ \\frac{S}{gcd(W,l)} }$ \u3002\n\n```cpp\nll ans,x1,y1;\n\nll exgcd(ll a,ll b,ll &x1, ll &y1){\n    if(!b){\n        x1=1;\n        y1=0;\n        return a;\n    }\n    ans=exgcd(b,a%b,x1,y1);\n    ll t=x1;\n    x1=y1;\n    y1=t-a/b*y1;\n    return ans;\n}\n\nint main(){\n    ll n,m,x,y,l;\n    cin>>x>>y>>m>>n>>l;\n    ll b=n-m,a=x-y;\n    if(b<0){\n        b=-b;\n        a=-a;\n    }//\u5904\u7406\u8d1f\u6570 \n    exgcd(b,l,x1,y1);\n    if(a%ans!=0)//\u5224\u65ad\u65b9\u7a0b\u6709\u65e0\u89e3\u3002 \n        cout<<\"Impossible\";\n    else\n        cout<<((x1*(a/ans))%(l/ans)+(l/ans))%(l/ans);//\u5904\u7406\u8d1f\u6570 \n}\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",
        "postTime": 1523541433,
        "uid": 28313,
        "name": "\u768e\u6708\u534a\u6d12\u82b1",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "\u5f88\u5bb9\u6613\u60f3\u5230\uff0c\u5982\u679c\u4ed6\u4eec\u76f8\u9047\uff0c\u4ed6\u4eec\u521d\u59cb\u7684\u4f4d\u7f6e\u5750\u6807\u4e4b\u5dee$x-y$\u548c\u8df3\u7684\u8ddd\u79bb$(n-m)t$\uff08\u8bbe$t$\u4e3a\u8df3\u7684\u6b21\u6570\uff09\u4e4b\u5dee\u5e94\u8be5\u662f\u6a21\u7eac\u7ebf\u957f$l$\u540c\u4f59\u7684\uff0c\u5373$(n-m)t\\equiv x-y(\\mod l)$\n\n\u8f6c\u5316\u4e00\u4e0b\uff0c\u4e0d\u5c31\u53d8\u6210\u4e86\u8ba9\u6211\u4eec\u6c42\u4e00\u4e2a\u4e0d\u5b9a\u65b9\u7a0b$(n-m)t+kl=x-y(k\\in \\mathbb Z)$\u4e2d$t$\u7684\u6700\u5c0f\u975e\u8d1f\u6574\u6570\u89e3\u4e48\uff1f\n\n\u8bbe$a=n-m,b=l,c=x-y$\uff0c\u628a\u5b83\u8f6c\u5316\u6210\u6211\u4eec\u6bd4\u8f83\u719f\u6089\u7684\u4e00\u822c\u4e0d\u5b9a\u65b9\u7a0b\u7684\u5f62\u5f0f$ax+by=c$\uff08\u6b64\u5f0f\u7684$x,y$\u4e0e\u9898\u76ee\u7ed9\u7684\u5750\u6807\u610f\u4e49\u4e0d\u540c\uff09\n\n\u9996\u5148\uff0c\u8bbe$g=\\gcd(a,b)$\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6269\u6b27\u6c42\u51fa$ax_0+by_0=g$\u4e2d$x_0$\u7684\u4e00\u4e2a\u89e3\n\n\u8fd9\u65f6\uff0c\u56e0\u4e3a$\\frac{ax+by}g$\u4e3a\u6574\u6570\uff0c\u6240\u4ee5$\\frac c g$\u4e5f\u5fc5\u987b\u662f\u6574\u6570\uff0c\u5426\u5219\u65e0\u89e3\n\n\u5426\u5219\uff0c\u7b49\u5f0f\u4e24\u8fb9\u540c\u4e58$\\frac cg$\uff0c\u5f97$a\\frac{cx_0}g+b\\frac{cy_0}{g}=c$\n\n\u90a3\u4e48\uff0c$x=\\frac{cx_0}g$\u5c31\u662f$ax+by=c$\u4e2d$x$\u7684\u4e00\u4e2a\u89e3\n\n\u5982\u4f55\u7531\u4e00\u4e2a\u89e3\u5f97\u5230\u5176\u5b83\u89e3\u5462\uff1f\u6709\u4e00\u4e2a\u6052\u7b49\u5f0f$a(x+db)+b(y-da)=c$\n\n\u5728\u4fdd\u8bc1$db,da$\u90fd\u662f\u6574\u6570\u7684\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u8ba9$d$\u6700\u5c0f\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u6240\u6709\u7684\u6574\u6570\u89e3\uff0c\u90a3\u4e48$d=\\frac 1g$\n\n\u5982\u679c\u89e3\u51fa\u7684$x>0$\uff0c\u90a3\u4e48\u6700\u5c0f\u975e\u8d1f\u6574\u6570\u89e3\u7b49\u4e8e$x\\mod\\frac b g$\uff1b\u5426\u5219\u7b49\u4e8e$x\\mod\\frac b g+\\frac b g$\n\n\u4ee3\u7801\u5c31\u53ef\u4ee5\u76f4\u63a5\u5199`(x%(b/g)+b/g)%(b/g)`\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u4ea4\u4e0a\u53bb\u4e86\uff0c\u53d1\u73b0\u83b7\u5f97\u4e8670\u5206\n\n\u600e\u4e48\u56de\u4e8b\uff1f\u56e0\u4e3a$\\gcd$\u53ea\u5bf9\u975e\u8d1f\u6574\u6570\u6709\u610f\u4e49\uff0c\u6240\u4ee5\u5982\u679c$a<0$\u7b49\u5f0f\u4e24\u8fb9\u8981\u540c\u65f6\u53d6\u8d1f\uff0c$a,c$\u90fd\u8981\u53d8\u6210\u76f8\u53cd\u6570\uff1b$b$\u672c\u6765\u5c31\u662f\u6b63\u6570\uff0c\u4e0d\u7528\u53d8\u4e5f\u4e0d\u80fd\u53d8\u3002\n\n\u603b\u4e4b\uff0c\u867d\u7136\u662f\u88f8\u7684exgcd\u9898\uff0c\u4f46\u662f\u5f88\u5bb9\u6613\u88ab\u7ec6\u8282\u5b9e\u73b0\u5751\u5230\uff0c\u5c24\u5176\u662f\u6c42\u6700\u5c0f\u975e\u8d1f\u6574\u6570\u89e3\u548c\u5904\u7406$a$\u4e3a\u8d1f\u6570\u7684\u5730\u65b9\u3002\n```cpp\n#include<cstdio>\n#define LL long long\nLL x,y,m,n,l,a,b,c,x0,y0,g,tmp;\nvoid exgcd(LL a,LL b){\n\tif(!b){x0=1;g=a;return;}//\u987a\u4fbf\u6c42gcd\n\texgcd(b,a%b);\n\ttmp=x0;x0=y0;y0=tmp-a/b*y0;\n}\nint main(){\n\tscanf(\"%lld%lld%lld%lld%lld\",&x,&y,&m,&n,&l);\n\ta=n-m;b=l;c=x-y;\n\tif(a<0)a=-a,c=-c;//\u5904\u7406a\u4e3a\u8d1f\u6570\u60c5\u51b5\n\texgcd(a,b);\n\tif(c%g)puts(\"Impossible\");\n\telse printf(\"%lld\\n\",(c/g*x0%(b/g)+b/g)%(b/g));//\u6c42\u6700\u5c0f\u975e\u8d1f\u6574\u6570\u89e3\n\treturn 0;\n}\n```",
        "postTime": 1528336865,
        "uid": 61325,
        "name": "FlashHu",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "\u89e3\u91ca\uff1a\n\n1.\u4e24\u53ea\u9752\u86d9\u76f8\u9047\uff0c\u4f1a\u6709[(x-y)+k(m-n)]%l=0;(k\u8868\u793a\u8df3\u7684\u6b21\u6570)\u3002\u3010\u65b9\u7a0b\u6765\u6e90\u3011\n\n2.\u5c06(x-y)\u8bb0\u4e3aA,(m-n)\u8bb0\u4e3aB,\u5373(A+kB)%l=0,(A+kB)\u5bf9l\u53d6\u4f59\u7b49\u4e8e\u96f6\u53ef\u4ee5\u7b49\u4ef7\u4e3a(A+kB)\u51cf\u53bby\u4e2al\u7b49\u4e8e\u96f6\uff0c\u5373(A+kB)-yl=0\uff0c\u79fb\u9879\u5f97kB-yl=-A\u3002\u3010\u65b9\u7a0b\u3011\n\n3.\u5c06k\u6362\u4e3ax\uff0c\u5f97\u5230xB-yl=A(\u7531\u4e8e\u5c06-A\u53d8\u6210\u4e86A\uff0c\u5728\u5f00\u59cb\u8d4b\u503c\u65f6\u82e5B=m-n\uff0cA\u5c31\u4e3ay-x\uff0c\u82e5B=n-m\uff0cA\u5c31\u4e3ax-y)\uff0c\u7136\u540e\u5224\u65ad\u662f\u5426\u6709\u89e3\uff1a\u4ee4d\u4e3aB\u4e0el\u7684\u6700\u5927\u516c\u7ea6\u6570gcd(B,l);\u65b9\u7a0b\u4e24\u8fb9\u540c\u65f6\u9664\u4ee5d\uff0c\u5f97\u5230\n\n\u4e86xB/d-yl/d=A/d,\u7531\u4e8ed=gcd(B,l),\u6240\u4ee5B/d\u3001l/d\u4e3a\u6574\u6570\uff0c\u7136\u540ex\u3001-y\u4e5f\u662f\u6574\u6570\uff0c\u6240\u4ee5\u65b9\u7a0b\u6210\u7acb\u7684\u6761\u4ef6\u5c31\u662fA/d\u4e5f\u4e3a\u6574\u6570\u3002\u3010\u8bc1\u660e\u65b9\u7a0b\u6210\u7acb\u3011\n\n4.\u8fd9\u4e2a\u65b9\u7a0b\u5c31\u662f\u6269\u5c55\u6b27\u51e0\u91cc\u5f97exgcd(B,l,x,y)\uff08\u5ffd\u7565y\u524d\u7684\u8d1f\u53f7\uff09\uff0c\u8fd9\u6837\u53ef\u4ee5\u89e3\u51fax\uff0c\u6b64\u65f6\u7684x\u4e0d\u662f\u6700\u4f18\u89e3\uff0c\u8fd8\u8981\u8f6c\u6362\uff0c\u5373((x\\*(A/d))%(l/d)+(l/d))%(l/d)\u3010\u6c42\u6700\u5c0f\u89e3\u7684\u5f0f\u5b50\uff0c\u4e0d\u7406\u89e3\u5148\u80cc\u4e0b\u6765\u3011\u3002\n\n\n\n\u4ee3\u7801\uff08c++\uff09\u3010\u90e8\u5206\u8868\u793a\u4e0e\u89e3\u91ca\u4e2d\u4e0d\u540c\uff0c\u4e5f\u6ca1\u5173\u7cfb\uff0c\u6ce8\u610f\u4e00\u4e0b\u5c31\u597d\u4e86\u3011\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\nusing namespace std;\nlong long m,n,xn,yy,l;\nlong long r,a,b,x,y;\nint exgcd(long long a,long long b,long long &x, long long &y);\nint main()\n{\n    cin>>xn>>yy>>m>>n>>l;\n    a=xn-yy;\n    b=n-m;\n    if(b<0)\n    {\n        b=-b;\n        a=-a;\n    }\n    exgcd(b,l,x,y);\n    if(a%r!=0)\n        printf(\"Impossible\");\n    else\n        cout<<((x*(a/r))%(l/r)+(l/r))%(l/r);\n    return 0;\n}\nint exgcd(long long a,long long b,long long &x, long long &y)\n{\n    if(b==0)\n    {\n        x=1;\n        y=0;\n        return a;\n    }\n    r=exgcd(b,a%b,x,y);\n    long long cnt=x;\n    x=y;\n    y=cnt-a/b*y;\n    return r;\n}\n\n```",
        "postTime": 1500521035,
        "uid": 36560,
        "name": "QSWei",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "#### Solution\n\u53ef\u4ee5\u5199\u51fa\u4ee5\u4e0b\u7684\u65b9\u7a0b\n$$a(m-n)+bl=y-x$$\n**\u5982\u4f55\u5224\u65ad\u662f\u5426\u5b58\u5728\u89e3?**\n\n\u6211\u4eec\u77e5\u9053\u5bf9\u4e8e\u65b9\u7a0b$ax+by=c$\u6210\u7acb\u7684\u6700\u5c0f\u7684c\u4e3a$(a,b)$.\n\u6240\u4ee5\u5bf9\u4e8e\u6b64\u9898, \u5f53$(m-n,l)\\mid y-x$\u65f6\u5b58\u5728\u89e3.\n\n**\u5982\u4f55\u6c42\u51fa\u65b9\u7a0b\u7684\u4e00\u7ec4\u7279\u89e3?**\n\n\u8bb0$d=(m-n,l)$,\u90a3\u4e48\u4fbf\u53ef\u4ee5\u5c06\u6b64\u65b9\u7a0b\u5199\u6210\u4ee5\u4e0b\u5f62\u5f0f\n$$a\\frac{m-n}{d}+b\\frac{l}{d}=\\frac{y-x}{d}$$\n\n(*\u6b64\u5f62\u5f0f\u5c31\u662f\u6211\u4eec\u540e\u9762\u8ba8\u8bba\u7684\u5f62\u5f0f.*)\n\n\u7531\u4e8e$(\\frac{m-n}{d},\\frac{l}{d})=1$, \u6240\u4ee5\u4fbf\u53ef\u4ee5\u6c42\u51fa\u5bf9\u4e8e\u65b9\u7a0b$a\\frac{m-n}{d}\\equiv 1\\mod \\frac{l}{d}$\u7684\u4e00\u7ec4\u7279\u89e3$a'$.\n\n\u90a3\u4e48\u5bf9\u4e8e\u65b9\u7a0b$a\\frac{m-n}{d}+b\\frac{l}{d}=\\frac{y-x}{d}$\u7684\u4e00\u7ec4\u7279\u89e3\u4e3a$a_0=a'\\frac{y-x}{d}$.\n\n**\u5982\u4f55\u6c42\u51fa\u65b9\u7a0b\u7684\u901a\u89e3**\n\n\u5047\u8bbe\u65b9\u7a0b\u7684\u53e6\u4e00\u7ec4\u89e3\u8bb0\u4f5c$a_1$\n\u90a3\u4e48$$a_0\\frac{m-n}{d}+b_0\\frac{l}{d}=\\frac{y-x}{d}$$\n$$a_1\\frac{m-n}{d}+b_1\\frac{l}{d}=\\frac{y-x}{d}$$\n\u8054\u7acb\u4e24\u5f0f\u5f97$$(a_1-a_0)\\frac{m-n}{d}+(b_1-b_0)\\frac{l}{d}=0$$\n\u7531\u4e8e$(\\frac{m-n}{d},\\frac{l}{d})=1$, \u6240\u4ee5\u5fc5\u5b9a\u6709$(a_1-a_0)\\mid \\frac{l}{d}$.\n\u4e5f\u5c31\u662f\u8bf4\n$$a_1=a_0+t\\frac{l}{d}$$\n\u56e0\u4e3a$a_1$\u662f\u4efb\u610f\u7684, \u6240\u4ee5\u53ef\u4ee5\u8bf4\u5bf9\u4e8e\u65b9\u7a0b\u7684\u4efb\u4f55\u4e00\u7ec4\u89e3$a$\u90fd\u53ef\u4ee5\u8868\u793a\u6210$a=a_0+t\\frac{l}{d}$\u7684\u5f62\u5f0f.\n\n\u6c42\u51fa\u901a\u89e3\u540e, \u6700\u5c0f\u6b63\u6574\u6570\u89e3$a_{\\min}$\u4fbf\u53ef\u4ee5\u8868\u793a\u6210$a \\equiv a_{\\min}\\mod \\frac{l}{d}$\u7684\u5f62\u5f0f.\n#### Code\n```c++\n#include<cstdio>\n#include<cstdlib>\n#define int long long\nusing namespace std;\n\nint gcd(int a,int b){return b?gcd(b,a%b):a;}\nvoid exgcd(int a,int b,int &x,int &y){\n\tif(!b){x=1,y=0;return ;}\n\texgcd(b,a%b,y,x);\n\ty-=a/b*x;\n}\nmain(){\n\tint a,b,x,y,n,m,l;\n\tscanf(\"%lld%lld%lld%lld%lld\",&a,&b,&m,&n,&l);\n\tint gg=gcd(m-n,l),mod=abs(l/gg);\n\texgcd(m-n,l,x,y);\n\tif((b-a)%gg){\n\t\tprintf(\"Impossible\");\n\t\treturn 0;\n\t}\n\tx=(x*((b-a)/gg)%mod+mod)%mod;\n\tprintf(\"%lld\",x);\n\treturn 0;\n}\n```",
        "postTime": 1528875992,
        "uid": 39067,
        "name": "aiyougege",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "\u672c\u849f\u84bb\u5728dalao\u4eec\u7684\u6307\u5bfc\u4e0b\u7ec8\u4e8eA\u4e86\u8fd9\u9053\u9898\uff0c\u7136\u540e\u53bb\u770b\u9898\u89e3\uff0c\u53d1\u73b0\u6839\u672c\u770b\u4e0d\u61c2QAQ\u4e8e\u662f\u4e4e\u5c31\u5199\u4e86\u8fd9\u4e2a\u975e\u5e38\u901a\u4fd7\u7684\u9898\u89e3ovo\u5e94\u8be5\u4f1a\u6709\u95ee\u9898qwq\n\n**\u6838\u5fc3**\n```cpp\nint exgcd(int a,int b,int &x,int &y)\n{\n    if(b==0)\n    {\n        x=1;\n        y=0;\n        return a;\n    }\n    int ans=exgcd(b,a%b,x,y);\n    int temp=x;\n    x=y;\n    y=temp-a/b*y;\n    return ans;\n}\t\t\t//\u5f97\u51fa\u7684x,y\u4e3a\u4e00\u7ec4\u7279\u89e3\n```\n\u8bc1\u660e\n\u8bbegcd(a,b)=a*x+b*y\n\ngcd(a,b)=gcd(a%b)\n\ngcd(b,a%b)  =b*x'+(a%b)*y'\n\n=b*x'+(a-a/b*b)*y'\n\n=b*x'+a*y'-a/b*b*y'\n\n=a*y'+b*(x'-a/b*y')\n\n\u2234a*x+b*y=a*y'+b*(x'-a/b*y')\n\n\u2234x=y',y=x'-a/b*y'\n\n\n-----\u795e\u5947\u7684\u5206\u5272\u7ebf-------\n\n\n\u4f8b\u9898\u5206\u6790\nP1516 \u9752\u86d9\u7684\u7ea6\u4f1a\n\n[\u9898\u76ee](https://www.luogu.org/problemnew/show/P1516)\n\n\u7531\u9898\u610f\u53ef\u5f97\n\n\u8bbe\u5171\u8df3\u4e86k\u6b21\uff0c\u90a3\u4e48\n\nx+k*m\u2261y+k*n(mod l)\n\n\u8bbex+k*m\u9664l\u5546\u4e3aa\uff0c\u4f59z\uff0c\u8bbey+k*n\u9664l\u5546\u4e3ab\uff0c\u4f59z\u3002\u90a3\u4e48\n\nx+k*m+a*l=y+k*m+b*l\n\n\u5316\u7b80\u5f97\n\nk*(m-n)+(a-b)*l=y-x\n\n\u6b64\u65f6(m-n)\u5df2\u77e5,(y-x)\u5df2\u77e5,l\u5df2\u77e5\n\n\u8bbe(m-n)=A,k=X,(a-b)+Y,l=B,(x-y)=K\n\n\u82e5A<0,\u8981\u5904\u7406\u8d1f\u6570\n\n```cpp\nif(A<0)\n{\nA=-A;\nB=-B;\n}\n```\n\u5373A*X+B*Y=K\n\n\u662f\u4e00\u4e2a\u4e0d\u5b9a\u9879\u65b9\u7a0b\uff0c\u6b64\u65f6\u5373\u53ef\u4ee5\u7528\n\nexgcd(B,x,y),\u6c42\u51fa\u4e00\u7ec4\u7279\u89e3x0,y0\u53bb\u6c42\u4ed6\u7684\u53e6\u4e00\u7ec4\u7279\u89e3X,Y\n\n\u6b64\u65f6\uff0c\u6709\n\nA*X+B*Y=K\n\nA*x0+B*y0=gcd(A,B)\n\n\u8bbegcd(A,B)*m=K\uff0c\u5219\n\nm*(A*x0+B*y0)=gcd(A,B)*m=K=A*X+B*Y\nm=K/gcd(A,B)\n\n\u5373A*m*x0+B*m*y0=A*X+B*Y\n\n\u2234X=m*x0,Y=m*y0;\n\n\u6b64\u65f6\u518d\u5957\u7528\u6c42\u6700\u5c0f\u6574\u6570\u89e3\u7684\u516c\u5f0f\n\n _**((x0*(K/gcd(a,b)))%(l/gcd(a,b))+(l/gcd(a,b)))%(l/gcd(a,b))**_ \n\n\u6c42\u51fak\n\n\u6ce8\u610f\uff1a\u82e5K%gcd(a,b)!=0,\u6b64\u65b9\u7a0b\u65e0\u89e3\n\n\u4e0b\u9762\u662f\u4ee3\u7801\uff1a\n--------------------------------------------------------------------------------\n```cpp\n#include<iostream>\nusing namespace std;\nlong long x,y,m,n,l,r=0;\nlong long exgcd(long long a,long long b,long long &x,long long &y)\n{\n\tif(b==0)\n\t{\n\t\tx=1;\n\t\ty=0;\n\t\treturn a;\n\t}\n\tr=exgcd(b,a%b,x,y);\n\tlong long t=x;\n\tx=y;\n\ty=t-a/b*y;\n\treturn r;\n}\nint main(){\n\tcin>>x>>y>>m>>n>>l;\n\tlong long A=n-m,B=x-y;\n\tif(A<0)\n\t{\n\t\tA=-A;\n\t\tB=-B;\n\t}\n\texgcd(A,l,x,y);\n\tif(B%r!=0)\n\t\tcout<<\"Impossible\";\n\telse cout<<((x*(B/r))%(l/r)+(l/r))%(l/r);\n}\n```\n--------------------------------------------------------------------------------\n",
        "postTime": 1536473155,
        "uid": 21241,
        "name": "\u4e0d\u77e5\u540d\u7684\u849f\u84bb",
        "ccfLevel": 0,
        "title": "P1516 \u9752\u86d9\u7684\u7ea6\u4f1a"
    },
    {
        "content": "\u8fd9\u9053\u9898\u76ee\u9996\u5148\u9700\u8981\u7b80\u5355\u5730\u63a8\u5bfc\u4e00\u4e0b\uff0c\u5c31\u53ef\u4ee5\u7b97\u51fa\u6765\u4e86\u3002\n\n\u6838\u5fc3\u601d\u8def\uff1a\u901a\u8fc7\u63a8\u5bfc\u5f97\u51fa\u4e00\u4e2a\u4e0d\u5b9a\u65b9\u7a0b\u7ec4\uff0c\u7136\u540e\u7528\u5760\u543c\u7684\u6269\u6b27\u6c42\u51fa\u4e00\u7ec4\u7279\u89e3\u5c31\u80fd\u7b97\u51fa\u6765\u4e86\u3002\n\n\u5148\u653e\u4e0achen\u521a\u5f00\u59cb\u753b\u7684\u56fe\u3002\n\n![](https://cdn.luogu.com.cn/upload/pic/20502.png)\n\n\u4e3a\u4ec0\u4e48\u753b\u7684\u8fd9\u4e48\u5dee\u5462\uff1f\u56e0\u4e3achen\u7684\u753b\u56fe\u8f6f\u4ef6\u7528\u7684\u662f\u4e00\u79cd\u9e2d\u5634\u7684\u7b14\uff0c\u65c1\u8fb9\u6709\u4e00\u4e2a\u8c03\u8272\u76d8\uff0c\u6700\u75db\u82e6\u7684\u5c31\u662f\u9009\u53d6\u8c03\u8272\u76d8\u6700\u4f73\u7684\u989c\u8272\u7ed9\u8fd9\u652f\u7b14\u8c03\u4e0a\u53bb\uff0c\u7136\u540e\u63cf\u56fe\u7684\u65f6\u5019\u624b\u5c31\u6296\u4e86\uff0c\u8fd8\u5f97\u7528\u6a61\u76ae\u64e6\u53bb\u64e6\uff0c\u8fd9\u4e2a\u5c31\u662f\u753b\u56fe\u6700\u75db\u82e6\u7684\u3002\n\n\u6211\u4eec\u8bbe\u9752\u86d9\u8df3\u4e86X\u6b65\u3002\n\n\u9996\u5148\u6839\u636e\u9898\u610f\uff0c\u5217\u51fa\u5f0f\u5b50\n\n$$(x+Xm) mod L=(y+Xn) mod L$$\n\n\u610f\u601d\u662f\u7b2c\u4e00\u53ea\u9752\u86d9\u4ece\u81ea\u5df1\u7684\u4f4d\u7f6e\u5411\u67d0\u4e2a\u65b9\u5411\u8df3X\u6b65\uff0c\u7ecf\u8fc7\u591a\u6b21\u8df3\u8dc3\u78b0\u5230\u4e86\u4ece\u81ea\u5df1\u7684\u4f4d\u7f6e\u5411\u67d0\u4e2a\u65b9\u5411\u8df3X\u6b65\u7684\u53e6\u4e00\u53ea\u9752\u86d9\uff0c\u4ed6\u4eec\u7684\u5750\u6807\u662f\u76f8\u540c\u7684\u3002\n\n_//\u9752\u86d9\uff1aI am angry!_\n\n$$(x+Xm-y-Xn)modL=0$$\n\n$$[x-y+X(m-n)]modL=0$$\n\n$$x-y+X(m-n)=YL$$\n\n$$X(n-m)+YL=x-y$$\n\n\u628a\u5df2\u77e5\u5e38\u91cf\u6362\u5143\uff0c\u8bbeA=n-m,B=L,C=x-y\u5f97\n\n$$AX+BY=C$$\n\n\u5c31\u53d8\u6210\u6269\u6b27\u4e86\uff01\n\n\u63a5\u4e0b\u6765\u7684\u4e8b\u60c5\u5c31\u7b80\u5355\u591a\u4e86\uff0c\u628aX Y\u7684\u4e00\u7ec4\u7279\u89e3\u6c42\u51fa\u6765\uff0cX\u5c31\u662f\u7b54\u6848\u4e86\u3002\n\n\u81f3\u4e8eY\u6709\u4ec0\u4e48\u610f\u4e49\uff0c\u53ef\u80fd\u53ea\u6709\u795e\u5947\u6d77\u87ba\u77e5\u9053\u4e86\u5427\uff01\n\n~~\u795e\u5947\u6d77\u87ba\uff1a\u65e0\u53ef\u5949\u544a~~",
        "postTime": 1527998040,
        "uid": 14381,
        "name": "1jia1",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "## \u4ece\u96f6\u5f00\u59cb\u7406\u89e3\u4e00\u6b21\u4e0d\u5b9a\u65b9\u7a0b\n\n\u4e4b\u524d\u7684\u9898\u89e3\u867d\u7136\u5df2\u7ecf\u5f88\u8be6\u7ec6\u4e86\uff0c\u4f46\u662f\u603b\u611f\u89c9\u4e0d\u662f\u5bf9\u65b0\u4eba\uff08\u6bd4\u5982\u6211\uff09\u4e0d\u662f\u5f88\u53cb\u597d\u3002\u6240\u4ee5\u8fd9\u91cc\u518d\u8bb2\u4e00\u904d\uff0c\u4e89\u53d6\u903b\u8f91\u987a\u7545\u3002\n\nP1516\uff0c\u9752\u86d9\u7684\u7ea6\u4f1a\uff0c\u672c\u8d28\u5c31\u662f\u6c42\u89e3**\u4e00\u6b21\u4e0d\u5b9a\u65b9\u7a0b**\u3002 \u4f55\u8c13\u4e00\u6b21\u4e0d\u5b9a\u65b9\u7a0b\uff0c\u901a\u4fd7\u7684\u6765\u8bf4\uff0c\u5c31\u662f\u4e00\u4e2a\u5b58\u5728\u4e24\u4e2a\u672a\u77e5\u6570\u7684\u65b9\u7a0b\uff0c\u6240\u4ee5\u8fd9\u79cd\u65b9\u7a0b\u7684\u7b54\u6848\u662f\u4ee5\u89e3\u96c6\u7684\u5f62\u5f0f\u5448\u73b0\u7684\u3002\n\n\u90a3\u4e48\u5982\u4f55\u6c42\u89e3\u4e00\u6b21\u4e0d\u5b9a\u65b9\u7a0b\u5462\uff1f\u9700\u8981\u63d0\u524d\u4e86\u89e3\u4e24\u4e2a\u6570\u5b66\u5b9a\u7406\u2014\u2014****\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u548c\u88f4\u8700\u5b9a\u7406**\n\n------------\n\n------------\n\n\n### \u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\uff08exgcd\uff09\n\n\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u5373\u4e3a\u6c42\u89e3\u5f62\u5982 ax + by = gcd(a, b) \uff08\u5e76\u4e14\u6709a,b\u2208N*, x,y\u2208Z\uff09\u7684\u65b9\u7a0b\u7684\u89e3\u96c6\uff0cgcd()\u5373\u4e3a\u6c42\u89e3\u6700\u5927\u516c\u56e0\u6570\u3002\n\n\u662f\u4e0d\u662f\u6709\u4eba\u8981\u95ee\u4e86\uff0c\u6211TM\u4e3a\u4ec0\u4e48\u8981\u6c42\u957f\u5f97\u8fd9\u4e48\u4e11\uff0c\u770b\u8d77\u6765\u6beb\u65e0\u610f\u4e49\u7684\u65b9\u7a0b ? \u53ea\u80fd\u8bf4\uff0c\u5148\u4e0d\u8981\u6025\uff0c\u540e\u9762\u8981\u7528\u3002\n\n\u5173\u4e8eexgcd\u6c42\u6cd5\u7684\u63a8\u5bfc\uff0c\u5176\u5b9e\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a**\u8fed\u4ee3\u9012\u63a8**\u7684\u8fc7\u7a0b\uff0c\u5373\u5229\u7528gcd(a, b) = gcd(b, a % b)\uff0c\u4ece\u800c\u7f29\u5c0fa, b\u7684\u6570\u503c\uff0c\u6700\u7ec8\u8fbe\u5230\u7ec8\u672b\u72b6\u6001\u2014\u2014\u518d\u56de\u6eaf\u6c42\u5f97\u539f\u65b9\u7a0b\u7684\u89e3\u3002\u8fd9\u91cc\u7b80\u5355\u63a8\u5bfc\u4e00\u4e0b\n\n**\u8bbe** x, y, \u6709\u65b9\u7a0b ax + by = gcd(a, b)\n\n**\u518d\u8bbe** x', y', \u6709\u65b9\u7a0b bx' + (a%b)y' = gcd(b, a%b)\n\n**\u56e0\u4e3a** gcd(a, b) == gcd(b, a%b)\n\n**\u6240\u4ee5** \u8054\u7acb\u5f97 ax + by = bx' + (a%b)y'\n\uff08\u63a5\u4e0b\u6765\uff0c\u9700\u8981\u6211\u4eec\u63a8\u5bfcx\u4e0ex', y\u548cy'\u7684\u5173\u7cfb\uff0c\u539f\u56e0\u89c1\u4e0a\u6587\uff09\n\n**\u56e0\u4e3a** a%b = a - (a / b) * b \n[ \u6ce8\uff1a\u8fd9\u91cc\u9664\u53f7\u4e3a\u4e0b\u53d6\u6574 ]\n\n _\uff08\u5173\u4e8e\u4e3a\u4ec0\u4e48\u53ef\u4ee5\u8fd9\u4e48\u8868\u793a\uff0c\u5177\u4f53\u53ef\u4ee5\u81ea\u5df1\u5728\u6570\u8f74\u4e0a\u5212\u4e00\u5212\uff0c\u5c31\u53ef\u4ee5\u660e\u767d\u4e86\uff09_ \n\n**\u6240\u4ee5** \u6709 ax + by = bx' + (a - a/b * b) y'\n\n**\u5408\u5e76\u540c\u7c7b\u9879** \u5f97 ax + by = ay' + b * (x' - a/b * y')\n\n**\u6240\u4ee5** \u89c2\u5bdf\u7b49\u5f0f\u4e24\u8fb9\uff0c\u5f97:\n\n _1_ . x = y'\n\n _2_ . y = x' - (a/b) * y'\n \n _(\u90a3\u4e48\u662f\u4e0d\u662f\u53ea\u8981\u77e5\u9053x'\u4e0ey'\uff0c\u5c31\u53ef\u4ee5\u5f97\u51fax,y\u7684\u503c\u4e86\uff1f)\n(\u90a3\u4e48x\u2019\uff0cy\u2019\u600e\u4e48\u6c42\uff1f\u53ea\u9700\u8981\u628ax',y'\u770b\u505a\u662f\u8981\u6c42\u89e3\u7684x\uff0cy\uff0c\u518d\u8fdb\u4e00\u6b65\u8fed\u4ee3\u5373\u53ef\u3002)_ \n\n**\u89c2\u5bdf** \u5728a,b\u9010\u6e10\u51cf\u5c0f\u65f6\u6709:\n\n**\u5f53b=0\u65f6**\uff0c a * 1 + b * 0 = gcd(a, b)\n\n**\u5373\u5f97** \u8fb9\u754c\u6761\u4ef6x0 = 1, y0 = 0;\n(\u5173\u4e8eb\u662f\u5982\u4f55\u53d8\u4e3a0\u7684\uff0c\u8bf7\u4ee3\u4e0a\u6570\u503c\u8be6\u7ec6\u6a21\u62df\u4e00\u8fb9gcd\u7684\u7b97\u6cd5)\n\n**\u81f3\u6b64\uff0c\u63a8\u5bfc\u5b8c\u6bd5.**\n\n\u603b\u7ed3\u4ee5\u4e0a\u63a8\u5bfc\uff0c\u6211\u4eec\u4fbf\u62e5\u6709\u4e86\u6c42\u89e3ax + by = gcd(a, b)\u7684\u5de5\u5177\u3002\n\n\n------------\n\n### \u88f4\u8700\uff08\u8d1d\u7956\uff09\u5b9a\u7406\n\n\u5177\u4f53\u8bc1\u660e\u6bd4\u8f83\u590d\u6742\uff0c\u6b64\u5904\u7565\uff08\u81ea\u884c\u767e\u5ea6\u5373\u53ef\uff09\n\n**\u5b9a\u7406**->  \u65b9\u7a0b ax+by=c \uff08a,b,c\u2208N*\uff09\u6709\u89e3\u7684\u5145\u8981\u6761\u4ef6\u662f gcd(a, b) | c\n\n _( gcd(a, b) | c\u7684\u610f\u601d\u662f\uff0cgcd(a, b)\u662fc\u7684\u4e00\u4e2a\u56e0\u6570\uff0c\u6216\u8005\u8bf4\uff0c c % gcd(a, b) == 0\u3002\u5145\u8981\u6761\u4ef6\u7684\u5b9a\u4e49\u8bf7\u5de6\u8f6c\u89c1\u6570\u5b66\u5fc5\u4fee2)_ \n\n\u901a\u8fc7\u8fd9\u4e2a\u5b9a\u7406\uff0c\u6211\u4eec\u4e0d\u4ec5\u80fd\u591f\u5224\u65ad\u65b9\u7a0b\u7684**\u53ef\u89e3\u6027**\uff0c\u8fd8\u53ef\u4ee5\u5f97\u51fa\u65b9\u7a0b\u7684\u89e3\u96c6\uff0c\u63a8\u5bfc\u89c1\u4e0b\uff1a\n\n\u8bbe a\u00b7x0 + b\u00b7y0 = gcd(a, b)\n\n\u5219\u4ee4 k = c \u00f7 gcd(a, b)\n\n\u5f97 a\u00b7x0\u00b7k + b\u00b7y0\u00b7k = c\n\n\u8bbe\u53d8\u91cft\uff0c\u5219\n\u53c8\u53d8\u5f62\u5f97\n\na\u00b7(x0\u00b7k + b / gcd(a, b) * t) + b\u00b7(y0\u00b7k - a / gcd(a, b) * t) = c\n\n\u6240\u4ee5 ax + by = c  \u7684\u89e3\u96c6\u5c31\u662f\n\n{(x, y)|x = x0\u00b7k + b / gcd(a, b) * t, \n\ny = y0\u00b7k - a / gcd(a, b) * t, \u4e14t\u2208Z}\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u5c31\u89e3\u5b8c\u4e86\u4e00\u5143\u4e0d\u5b9a\u65b9\u7a0b\uff1f\u662f\u4e0d\u662f\u975e\u5e38\u7b80\u53552333\n\n\n\n\n------------\n\n\n------------\n\n------------\n\n## \u90a3\u4e48\u8fd9\u4e2a\u9898\uff1f\n\n\u5173\u952e\u8bcd\uff1a**\u300c\u8f6c\u5316\u80fd\u529b\u300d**\n\n\u6839\u636e\u9898\u76ee\u6240\u8ff0\uff0c\u6211\u4eec\u6709x, y, m, n, L, \u90a3\u4e48\u6839\u636e\u9898\u76ee\u6761\u4ef6\u4fbf\u6709(\u8bbet\u662f\u7ecf\u8fc7\u7684\u65f6\u95f4\uff0cL*k\u5373\u4e3a\u4e24\u4e2a\u9752\u86d9\uff08\uff1f\uff09\u7684\u8ddd\u79bb)\uff1a\n\n(\u65b9\u4fbf\u8d77\u89c1\uff0c\u4e0d\u59a8\u8bben > m)\n\n**\u7531** x + mt - (y + nt) = L * k,  k\u2208Z\n\n**\u5f97**  (x - y) - (n - m)t = L * k\n\n**\u79fb\u9879\u5f97** Lk + (n - m) * t = (x - y)\n\n\u672a\u77e5\u6570\u53ea\u6709k\u548ct\u4e86\uff0c\u90a3\u4e48\u8fd9\u4e2a\u65b9\u7a0b\u662f\u4e0d\u662f\u611f\u89c9\u5728\u54ea\u91cc\u89c1\u8fc7\u554a\uff1f\uff1f\n\n\u90a3\u4e48\u662f\u4e0d\u662f\u53ef\u4ee5\u5f88\u6109\u5feb\u5730\u89e3\u65b9\u7a0b\u5566\uff1f\n\n\u6700\u540e\u6211\u4eec\u5f97\u5230\u4e86\u5173\u4e8et\u3001k\u7684\u89e3\u96c6\u3002\n\n**\u56e0\u4e3a** t>=0\u6052\u6210\u7acb\uff08\u4e3a\u4ec0\u4e48?\u4f60\u89c1\u8fc7\u65f6\u95f4\u5012\u6d41\u5417=.=\uff09\n\n**\u6240\u4ee5** \u53ea\u53d6t\u7684\u6700\u5c0f\u6b63\u6574\u6570\u5373\u53ef\u3002\n\u8fd9\u91cc\u7a0d\u5fae\u8bf4\u660e\u4e00\u4e2a\u5c0f\u6280\u5de7\u2014\u2014\n\u5982\u679c\u6709y = x + a*t\uff0c \u90a3\u4e48y\u7684\u6700\u5c0f\u6b63\u6574\u6570y'\u53ef\u4ee5\u8fd9\u4e48\u6c42\uff1a\n\uff08\u8fd9\u91cc\u7684\u5b57\u6bcd\u662f\u778e\u7f16\u7684\uff0c\u4e0d\u662f\u539f\u9898\u3002\uff09\n\ny' = (x % t + t) % t; \n\n\u6700\u540e\u5c31\u505a\u5b8c\u4e86\u3002\u4ee3\u7801\u5949\u4e0a\n\n\n\n```\n.....\n#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\n\nvoid exgcd(ll a, ll b, ll &x, ll &y)\n{\n\tif(!b){x = 1; y = 0; return;}\n\texgcd(b, a % b, y, x);\n\ty -= a / b * x;\n}\n\nll gcd(ll a, ll b){\n\treturn (b == 0) ? a : gcd(b, a % b);\n}\n\nll X, Y, M, N, L, g, x, y;\n\nint main()\n{\n\tios::sync_with_stdio(0);\n\tcin >> X >> Y >> M >> N >> L;\n\tif(N < M) swap(X, Y), swap(M, N);\n\tg = gcd(L, N - M);\n\texgcd(L, N - M, x, y);\n\tif((X - Y) % g != 0) cout << \"Impossible\" << endl;\n\telse {\n\t\tcout << (y * ((X - Y) / g) % (L / g) + (L / g)) % (L / g) << endl;\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1564489134,
        "uid": 45571,
        "name": "606gtfp6k1",
        "ccfLevel": 0,
        "title": "\u4ece\u96f6\u5f00\u59cb\u7406\u89e3\u4e00\u6b21\u4e0d\u5b9a\u65b9\u7a0b"
    },
    {
        "content": "\u8fd9\u9053\u9898\uff0c\u662f\u4e00\u9053\u633a\u6709\u96be\u5ea6\u7684\u9898\u3002\n\n\u8bbe\u4e24\u53ea\u9752\u86d9\u8df3\u4e86$a$\u6b65\uff0c\u5219$A$\u86d9\u7684\u5750\u6807\u662f$x+ma$,$B$\u86d9\u7684\u5750\u6807\u662f$y+na$\n\n\u6240\u4ee5\u4e24\u53ea\u9752\u86d9\u76f8\u9047\u7684\u5145\u5206\u6761\u4ef6\u662f$x+ma-(y+na) = Lb\\ (b \\in Z)$\n\n\u63d0\u516c\u56e0\u5f0f\u5f97$(m-n)a + (x-y) = Lb$\n\n\u79fb\u9879\uff0c\u65b9\u7a0b\u4e24\u8fb9\u540c\u57ce$-1$\u5f97$(n-m)a + Lb = (x-y)$\n\n\u4ee4$x = (m-n)$,$y = L$,$d = gcd(x,y)$\n\n\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u89e3$xa + yb = d$\u7684\u4e00\u7ec4\u89e3$(a,b)$\n\n\u82e5$(x-y) \\% d \\neq 0$\u6216$m = n$\u65e0\u89e3\n\n\u5426\u5219$a$\u5c31\u662f\u6211\u4eec\u6c42\u7684\u4e00\u7ec4\u89e3\uff0c\u4f46\u4e0d\u4e00\u5b9a\u662f\u9898\u76ee\u8981\u6c42\u7684\u89e3\n\n\u6240\u4ee5\u8fd8\u8981\u5bf9$a$\u8fdb\u884c\u64cd\u4f5c\n\n\u4ee4$c = (x-y)$,\u4e3a\u4e86\u65b9\u4fbf\u8868\u793a\u6211\u4eec$swap(x,a) \\ swap(y,b)$\n\n\u5462\u4e48\u6211\u4eec\u672c\u6765\u8981\u89e3\u7684\u65b9\u7a0b\u5f0f\u662f$ax_0+by_0 = c$\n\n\u4f46\u662f\u6211\u4eec\u89e3\u7684\u65b9\u7a0b\u5f0f\u662f$ax_1+by_1 = d$\n\n\n\u5bf9\u4e8e\u8fd9\u4e2a\u65b9\u7a0b\u6211\u4eec\u540c\u4e58$\\frac{c}{d}$\u5f97$ax_1\\frac{c}{d}+by_1\\frac{c}{d} = c$\n\n\u6240\u4ee5\u5bf9\u4e8e\u4e00\u7ec4$(x_1,y_1)$\u7b26\u5408$ax_1+by_1 = d$,\u5219\u5fc5\u6709\u4e00\u7ec4$(x_1\\frac{c}{d},y_1\\frac{c}{d})$\u7b26\u5408$ax_0+by_0 = c$\n\n\u53c8\u56e0\u4e3a\u5982\u679c$(x,y)$\u662f\u4e22\u756a\u56fe\u65b9\u7a0b\u7684\u4e00\u7ec4\u89e3\u5219$(x-\\frac{b}{d} ,y+\\frac{a}{d})$\u4e5f\u662f\u4e00\u7ec4\u89e3\n\n\u6240\u4ee5\u5982\u679c\u6211\u4eec\u77e5\u9053$x$\u662f\u4e00\u4e2a\u6b63\u6574\u6570\u89e3\uff0c\u5219\u6700\u5c0f\u5c31\u662f\u8ba9$x$\u4e0d\u65ad\u5730\u7684\u51cf$\\frac{b}{d}$\u8fd9\u4e2a\u8fc7\u7a0b\u5c31\u76f8\u5f53\u4e8e\u53d6\u6a21$(x_1\\frac{c}{d})\\% \\frac{b}{d}$\n\n\u5728\u628ax,y,a,b\u6362\u56de\u6765\uff0c\u5e76\u4ee3\u5165\u6570\u636e\u5f97$result = (a\\times(\\frac{x-y}{d}) \\% (\\frac{L}{d})+(\\frac{L}{d}))\\%(\\frac{L}{d})$\n\n**coding**\n```cpp\n#include <iostream>\n#define LL long long\nusing namespace std;\n\n\nLL x,y,n,m,l;\n\n\ninline LL exgcd(LL a,LL b,LL &x,LL &y)\n{\n\tif(a == 0)\n\t{\n\t\tx = 0,y = 1;\n\t\treturn b;\n\t}\n\tregister LL d = exgcd(b%a,a,y,x);\n\tx -= b / a * y;\n\treturn d;\n}\n\n\nint main()\n{\n\tLL a,b,d;\n\tcin >> x >> y >>  m >> n >> l;\n\tif(n < m) swap(m,n), swap(x,y);\n\td = exgcd(n-m,l,a,b);\n\tif((x-y) % d || m == n) puts(\"Impossible\");\n\telse cout << (a*(x-y) / d % (l/d) + (l/d)) % (l/d) << endl;\n\treturn 0;\n} \n```",
        "postTime": 1559541579,
        "uid": 85348,
        "name": "PHarr",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "\u4ee4**A=x-y**,**B=m-n**\uff0c**K\u4e3a\u6b65\u6570**\uff0c**L\u4e3a\u8ddd\u79bb**\n\n\u4e5f\u5c31\u662fA\u4e3a\u521d\u59cb\u4f4d\u7f6e\u7684\u8ddd\u79bb\u5dee   B\u4e3a\u901f\u5ea6\u5dee\uff1b\n\n\u53ef\u4ee5\u5f97\u5230**abs\uff08A+K\\*B\uff09%L=0**\n\n\u53d8\u5f62\u5f97**abs\uff08A+KB\uff09=YL**\n\n\u518d\u53d8\u5f97**xB-yL=-A**\n\n\u8fd9\u5c31\u5f88\u5bb9\u6613\u60f3\u5230\u62d3\u5c55\u6b27\u51e0\u91cc\u5f97\u5b9a\u7406\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\ntypedef long long ll;\nll x,y,m,n,l,k,r,a,b;\nint xx,yy;\nll gcd(ll a,ll b,int &xx,int &yy)//\u62d3\u6b27\n{\n    if(b==0)\n    {\n        xx=1;yy=0;\n        return a;\n    }\n    ll r=gcd(b,a%b,xx,yy);\n    int t=xx;\n    xx=yy;\n    yy=t-(a/b)*yy;\n    return r;\n}\nint main()\n{\n    scanf(\"%lld%lld%lld%lld%lld\",&x,&y,&m,&n,&l);\n    a=x-y;b=n-m;//\u5b9a\u4e49A,B\n    if(b<0)\n    {\n        a=-a;\n        b=-b;\n    }\n    r=gcd(b,l,xx,yy);\n    if(a%r!=0)\n    {\n        printf(\"Impossible\");\n        return 0;\n    }\n    printf(\"%lld\",((xx*(a/r))%(l/r)+(l/r))%(l/r));\n    return 0;\n}\n\n```",
        "postTime": 1500470633,
        "uid": 35360,
        "name": "\u661f\u7235",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "\u4e0d\u59a8\u8bbe\u9752\u86d9A\u7684\u51fa\u53d1\u70b9\u5750\u6807\u662f$m1$\uff0c\u9752\u86d9B\u7684\u51fa\u53d1\u70b9\u5750\u6807\u662f$n1$\u3002\u9752\u86d9A\u4e00\u6b21\u80fd\u8df3$m$\u7c73\uff0c\u9752\u86d9B\u4e00\u6b21\u80fd\u8df3$n$\u7c73\uff0c\u8df3\u4e00\u5708\u957f$l$\u7c73\uff0c\u8bbe\u9752\u86d9A\u3001B\u8df3\u4e86$x$\u6b21\u3002\n\n\u90a3\u4e48\u9898\u76ee\u8981\u6c42\u7684\u662f\u6ee1\u8db3\u4e0b\u9762\u8fd9\u4e2a\u67ff\u5b50\u6700\u5c0f$x$\u6b63\u6574\u6570\u89e3\uff1a\n\n$$(m-n)\\times x\\equiv m1-n1\\pmod{l}$$\n\n\u4e0d\u59a8\u628a\u8fd9\u4e2a\u4e0d\u5b9a\u65b9\u7a0b\u53d8\u5f62\u4e00\u4e0b\uff1a\n\n$$(m-n)\\times x+l\\times y=m1-n1$$\n\n\u770b\u5230\u8fd9\u4e2a\u5f62\u5f0f\uff0c\u5c31\u60f3\u5230\u7528**\u6269\u5c55\u6b27\u51e0\u91cc\u5f97**\u6765\u6c42\u89e3\u3002\n\n\u4e0d\u59a8\u8bbe$a=m-n,b=l,c=m1-n1$\u3002\n\n\u90a3\u4e48\u539f\u65b9\u7a0b\u5c31\u662f\uff1a\n\n$$a\\times x+b\\times y=c$$\n\n\u7136\u540e\u6211\u4eec\u77e5\u9053\u4e00\u4e2a\u6027\u8d28\uff1a\n\n\u82e5$a\\times x+b\\times y=c$\u6709\u89e3\uff0c\u5219\u6ee1\u8db3$gcd(a,b)|c$\u3002\n\n\u6240\u4ee5\u8bf4\u6211\u4eec\u5148\u5224\u65ad\u65b9\u7a0b\u662f\u5426\u6709\u89e3\uff0c\u82e5\u65e0\u89e3\u5c31\u8f93\u51fa$\\mathbf{Impossible}$\u3002\n\n\u7136\u540e\u5982\u679c\u6709\u89e3\uff0c\u6211\u4eec\u5c31\u5148\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u6c42\u51fa$a\\times x+b\\times y=gcd(a,b)$\u7684\u4e00\u7ec4\u89e3\u3002\n\n\u7136\u540e\u6211\u4eec\u5bf9\u8fd9\u4e2a\u65b9\u7a0b\u5de6\u53f3\u4e24\u8fb9\u540c\u65f6\u4e58\u4e0a$c\\div gcd(a,b)$\u3002\n\n\u90a3\u4e48\u6709\uff1a\n\n$a\\times(c\\div gcd(a,b))\\times x+b\\times(c\\div gcd(a,b))\\times y=c$\n\n\u4e3a\u4e86\u65b9\u4fbf\u8d77\u89c1\uff0c\u6211\u4eec\u8fd9\u91cc\u4ee4$p=a\\times(c\\div gcd(a,b))$\uff0c$q=b\\times(c\\div gcd(a,b))$\u3002\n\n\u8fd9\u65f6\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6c42\u51fa\u6ee1\u8db3\u4e0b\u5217\u65b9\u7a0b\u7684\u4e00\u7ec4\u7279\u89e3\uff1a\n\n$p\\times x+q\\times y=c$\n\n\u6b64\u65f6\uff0c\u6211\u4eec\u53d1\u73b0$x$\u53ef\u4ee5\u4efb\u610f\u53d8\u4e3a$(x+k\\times \\frac{q}{gcd(p,q)})$\uff0c\u4e14\u603b\u6709\u5bf9\u5e94\u7684\u4e00\u4e2a\u6574\u6570\u89e3$y$\u4f7f\u5f97\u539f\u65b9\u7a0b\u4f9d\u65e7\u6210\u7acb\uff0c\u56e0\u4e3a\uff1a\n\n\u82e5$p\\times x+q\\times y=c$\u6210\u7acb\uff0c\u5219\u5fc5\u6709$p\\times (x+\\frac{q}{gcd(p,q)})+q\\times (y-\\frac{p}{gcd(p,q)})=c$ \u6210\u7acb\u3002\n\n\uff08\u4e3a\u4ec0\u4e48\u4e00\u5b9a\u8981\u9664$gcd(p,q)$\uff1f\u56e0\u4e3a\u5728\u7535\u8111\u4e2d\u4f1a\u5411\u4e0b\u53d6\u6574\uff0c\u800c\u4e14\u6211\u4eec\u8981\u4f7f\u5f97$\\frac{q}{gcd(p,q)}$\u5c3d\u91cf\u5c0f\uff0c\u8fd9\u6837\u624d\u80fd\u627e\u5230\u66f4\u591a\u7684$x$\u89e3\uff09\u3002\n\n\u6240\u4ee5\u4ee4$g=\\frac{q}{gcd(p,q)}$\uff0c\u5373\uff1a\n\n$$g=\\frac{q}{gcd(p,q)}=\\frac{b\\times(c\\div gcd(a,b))}{gcd(a\\times(c\\div gcd(a,b)),b\\times(c\\div gcd(a,b)))}=\\frac{q}{gcd(a,b)}$$\n\n\u90a3\u4e48$x$\u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u4e3a\uff1a\n\n$$((x \\bmod g)+g)\\bmod g$$\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u8f93\u51fa\u7b54\u6848\u4e86\u3002\n\n\u6700\u540e\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n \n#define ll long long\n \nusing namespace std;\n \nll m1,n1,m,n,l;\n \nll exgcd(ll a,ll b,ll &x,ll &y)\n{\n    if(!b)\n    {\n        x=1ll,y=0ll;\n        return a;\n    }\n    ll ans=exgcd(b,a%b,x,y);\n    ll xx=x;\n    x=y;\n    y=xx-(a/b)*y;\n    return ans;\n}\n \nint main()\n{\n    while(~scanf(\"%lld%lld%lld%lld%lld\",&m1,&n1,&m,&n,&l))\n    {\n        if(n<m)\n        {\n            swap(n,m);\n            swap(n1,m1);\n        }\n        ll a=n-m,b=l,c=m1-n1,x,y;\n        ll t=exgcd(a,b,x,y);\n        if(c%t)\n        {\n            puts(\"Impossible\");\n            continue;\n        }\n        c/=t;\n        x*=c;\n        ll mod=b/t;\n        x=(x%mod+mod)%mod;\n        printf(\"%lld\\n\",x);\n    }\n    return 0;\n}\n```",
        "postTime": 1576898956,
        "uid": 118318,
        "name": "ez_lcw",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "dalao\u4eec\u771f\u662f\u592a\u5f3a\u4e86,\u540a\u6253\u6211\u65e0\u540d\u849f\u84bb\n\n\u6211\u8fde\u9898\u89e3\u90fd\u770b\u4e0d\u61c2,\u5728\u6b64\u7bc7\u9898\u89e3\u4e2d,\u6211\u5c3d\u91cf\u7528\u8bed\u8a00\u63cf\u8ff0,\u4e0d\u7528\u516c\u5f0f\u63a8\u5bfc(~~dalao\u559c\u6b22\u770b\u516c\u5f0f\u7684\u8bdd\u7ed5\u9053,\u8fd9\u7bc7\u9898\u89e3\u7559\u7ed9\u50cf\u6211\u4e00\u6837\u5f31\u7684~~)\n\n\u8fdb\u5165\u6b63\u9898\n\n\u5982\u679c\u4e0d\u4f1a\u6269\u5c55\u6b27\u91cc\u51e0\u5fb7\u7684\u8bdd\u8bf7\u5148\u53bb\u505a\n\n\u6d1b\u8c37 p1082 \u540c\u4f59\u65b9\u7a0b\n\n\n\u8bbe\u8df3\u4e86k\u6b21\n\n\u6240\u4ee5km - kn + x - y = 0(mod l)\n\u6240\u4ee5k(m - n) + h * l = y - x\n~~\u8fd9\u4e2a\u79fb\u9879\u5e94\u8be5\u6ca1\u95ee\u9898\u5427~~\n\n\u8bbe(m - n)\u4e3aa,k\u4e3ax,h\u4e3ay,\nl\u4e3ab,(y - x)\u4e3am\n\n\u90a3\u4e48\u8f6c\u6362\u4e3aax + by = m\n\u6839\u636e\u88f4\u8700\u5b9a\u7406ax + by = gcd(a,b)\u6709\u89e3\n\n\u4f46\u4e0d\u4ee3\u8868ax + by = m\u65e0\u89e3\n\u6211\u4eec\u53ef\u4ee5\u8ba9\u7b49\u5f0f\u4e24\u8fb9\u540c\u9664\u4e00\u4e2am,\u518d\u540c\u4e58\u4e00\u4e2agcd(a,b)\n\n\u5c31\u6210\u4e86ax / m * gcd(a,b) + by / m * gcd(a,b) = gcd(a,b)\n\n\u628a(x / m * gcd(a,b))\u4f5c\u4e3a\u65b0\u7684x,(y / m * gcd(a,b))\u4f5c\u4e3a\u65b0\u7684y\n\n\u518d\u5229\u7528\u6269\u5c55\u6b27\u91cc\u51e0\u5fb7\u53ef\u4ee5\u6c42\u51fa\u65b0\u7684x\n\u5373(x / m * gcd(a,b))\n\n\u6211\u4eec\u5982\u679c\u6c42\u51fa\u4e86(x / m * gcd(a,b)),\u90a3\u4e48\u4e5f\u53ef\u4ee5\u6c42\u51fax(\u4e58\u4e00\u4e2am\u518d\u9664\u4e00\u4e2agcd\u5c31\u597d\u4e86)\n\n\u4f46\u662f\u8fd9\u5e76\u4e0d\u610f\u5473\u8fd9\u6bcf\u4e2a\u65b9\u7a0b\u90fd\u6709\u89e3,\u56e0\u4e3a\u6211\u4eec\u7684x\u4ee3\u8868\u7684\u662fk\n\u4e5f\u5c31\u662fx\u4ee3\u8868\u8df3\u7684\u6b21\u6570,\u6240\u4ee5\u4ec5\u53ef\u4ee5\u4f5c\u4e3a\u6574\u6570\n\u4e5f\u5c31\u662f\u5982\u679c\u6211\u4eec\u5fc5\u987b\u8ba9 m\u6574\u9664gcd(a,b)\u5373m % gcd(a,b) == 0\n\u5982\u679cm % gcd(a,b)\u4e0d\u7b49\u4e8e0,\u90a3\u4e48\u65b9\u7a0b\u65e0\u89e3\n \n```cpp\n#include<bits/stdc++.h>\n\nusing namespace std;\n\ninline long long read(){long long s=0,w=1;char ch=getchar();while(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}while(ch>='0'&&ch<='9') s=s*10+ch-'0',ch=getchar();return s*w;}\n\nlong long xx,yy,t,AC = 0;\n\nlong long gcd(long long x,long long y){//\u6c42gcd\n\tif(y == 0) return x;\n\treturn gcd(y,x % y);\n}\n\nvoid exgcd(long long a,long long b){//\u6b63\u5b97exgcd\n\tif(b == 0){\n\t\txx = 1;\n\t\tyy = 0;\n\t\treturn ;\n\t}\n\texgcd(b,a % b);\n\tt = xx;\n\txx = yy;\n\tyy = t - a / b * yy;\n}\n\nint main()\n{\n\tlong long x = read(),y = read();\n\tlong long m = read(),n = read();\n\tlong long l = read();\n\n\tlong long a = n - m,b = l,mm = x - y;\n\tif(a < 0){//\u6211\u4eec\u8ba9\u7b2c\u4e00\u53ea\u9752\u86d9\u5f00\u59cb\u518d\u7b2c\u4e8c\u53ea\u540e\u9762,\u5982\u679c\u4e0d\u662f\u8fd9\u6837\u5c31\u8c03\u6362\u4f4d\u7f6e(~~\u56e0\u4e3a\u9752\u86d9\u662f\u4e00\u6837\u7684~~)\n\t\tmm = -mm;\n\t\ta = -a;\n\t}\n\tlong long g = gcd(a,b);\n\tlong long t = b / g;\n\n\tif(mm % g){//\u4e0d\u662f0\u5219\u65e0\u89e3\n\t\tcout<<\"Impossible\"<<endl;\n\t\treturn AC;\n\t}\n\n\texgcd(a,b);\n\tlong long ans = xx * (mm / g);//\u6211\u4ee5\u4e3a\u7b54\u6848\u5c31\u662f\u8fd9\u6837\n\n\tcout<<(ans % t + t) % t<<endl;//\u81f3\u4e8e%t+t%t\u4e5f\u662f\u770b\u4e86\u5176\u4ed6\u5927\u4f6c\u7684\u9898\u89e3\u624d\u77e5\u9053\u7684,\u4e0d\u8fc7\u6211\u5e76\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48,(\u592a\u5f31\u4e86,\u96fe)\n\n\treturn AC;//\u8fd4\u56deAC\u4fdd\u5e73\u5b89\n}\n\n```",
        "postTime": 1565855735,
        "uid": 192006,
        "name": "liuzitong",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "\u9898\u610f\u8fd8\u662f\u975e\u5e38\u597d\u7406\u89e3\u7684.....\n\n\u5047\u5982\u8fd9\u4e0d\u662f\u4e00\u9053\u73af\u5f62\u7684\u8dd1\u9053\u800c\u662f\u4e00\u6761\u76f4\u7ebf\uff0c\u4f60\u4f1a\u600e\u6837\u505a\u5462\uff1f\n\n\u5982\u679c\u662f\u6211\u5c31\u4f1a\u5217\u4e00\u4e2a\u65b9\u7a0b\uff0c\u50cf\n\n$$x+m \\times k = y+n \\times k $$\n\n\u6c42\u51fa\u65b9\u7a0b\u89e3\u5f97k\u503c\u3002\n\n\u7136\u800c\u8fd9\u662f\u4e00\u4e2a\u73af\u5f62\u8dd1\u9053\uff0c\u4e5f\u5c31\u6709\u4e86\u53d6\u6a21\u7684\u95ee\u9898\uff0c\u7136\u800c\u6211\u4eec\u53ea\u9700\u8981\u7a0d\u5fae\u6539\u53d8\u4e00\u4e0b\u65b9\u7a0b\n\n$$x + m \\times k = y + n \\times k + l \\times z(z \\in \\mathbb{Z})$$ \n\nz\u8868\u793a\u88ab%\u6389\u4e86\u591a\u5c11\u5708\uff0c\u6211\u4eec\u8bd5\u7740\u4e24\u8fb9\u8f6c\u79fb\u4e00\u4e0b\n\n$$(x-y)+(m-n) \\times k = l \\times z$$\n\n\u6211\u4eec\u5b9a\u4e49$a=(x-y),b=(m-n)$\n\n$$a +b \\times k= l \\times z $$\n\n$$ bk+lz=a $$\n\n\u90a3\u4e48\u6211\u4eec\u7684\u4efb\u52a1\u5c31\u53d8\u6210\u4e86\u89e3\u51fa\u8fd9\u4e2a\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\u4e86\u3002\n\n\u9996\u5148\u5224\u65ad$ a\u662f\u5426\u6574\u9664gcd(b,l) $\uff0c\u4e0d\u6574\u9664\u5219\u65e0\u89e3\uff0c\u5426\u5219\u6709\u89e3\u7684\u8bdd\u5c31\u53ef\u4ee5\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u6c42\u5f97\u89e3\u3002\n\n```cpp\n#include <algorithm>\n#include <iostream>\n#include <cstdio>\nusing namespace std;\n#define LL long long \nLL xx,yy,n,m,x,y,a,b,l,r;\nLL gcd(LL a,LL b)\n{\n    return !b?a:gcd(b,a%b);\n}\nLL exgcd(LL a,LL b,LL &x,LL &y)\n{\n    return !b?(x=1,y=0):(exgcd(b,a%b,y,x),y-=a/b*x);\n}\nint main()\n{\n    cin>>xx>>yy>>m>>n>>l;\n    a=xx-yy;\n    b=n-m;\n    if(b<0)b=-b,a=-a;\n    r=gcd(b,l);\n    exgcd(b,l,x,y);\n    //\u73b0\u5728\u6211\u4eec\u89e3\u51fa\u7684\u662fbx+lz=gcd(b,l)\u7684\u89e3\uff0c\u8f93\u51fa\u7b54\u6848\u662f\u8981\u6269\u5927\u81f3a. \n    if(a%r!=0)printf(\"Impossible\");\n    else  cout<<((x*(a/r))%(l/r)+(l/r))%(l/r);\n    //\u8fd9\u4e2a\u7b54\u6848\u6211\u7814\u7a76\u4e86\u597d\u4e45\uff0c\u6700\u540e\u624d\u53d1\u73b0\u8fd9\u4e2a\u6a21\u6570\u662f\u56e0\u4e3a\u7ec4\u8fd9\u4e48\u591a\u6b65\u4ee5\u540e\n\t//\u4ed6\u4eec\u4e24\u4e2a\u90fd\u56de\u5230\u4e86\u8d77\u59cb\u70b9. \n//cout<<x*(a/r);\n}\n```",
        "postTime": 1539155707,
        "uid": 61727,
        "name": "Manjusaka\u4e36\u68a6\u5bd2",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "\u5206\u6790\uff1a\n\u7531\u9898\u610f\u6613\u5f97\u51fa\u540c\u4f59\u65b9\u7a0b\uff1a\nx + k*m \u2261 y + k*n (mod L)\uff1b\n\u5316\u89e3\u65b9\u7a0b\u5f97\uff1a\n(n-m) * k \u2261 x-y (mod L)\uff1b\n\u8f6c\u5316\u4e3a\u4e00\u822c\u65b9\u7a0b\u5f97\uff1a\n(n-m)*k + L*s = x-y\uff1b\n\u770b\u6210ax+by=c\uff1b\n\u8981\u6c42ax + by = c\u7684\u6574\u6570\u89e3 x\uff0c\u9996\u5148\uff0c\u8bbed = gcd(a, b)\uff0c\u65b9\u7a0b\u4e24\u8fb9\u540c\u65f6\u9664\u4ee5d\u5f97\u5230a/d * x + b/d * y = c/d\uff0c\u7531\u4e8ea\u662f\u6574\u9664d\u7684\uff0cb\u4e5f\u662f\u6574\u9664d\u7684\uff0c\u800cx\u3001y\u90fd\u662f\u6574\u6570\u89e3\uff0c\u6240\u4ee5\u8981\u6c42c/d\u4e5f\u662f\u6574\u6570\u3002\u5982\u679cc\u4e0d\u6574\u9664d\uff0c\u5c31\u8f93\u51faImpossible\u3002\u4e0d\u7136\u7684\u8bdd\uff0c\u5982\u679c\u6211\u4eec\u80fd\u6c42\u51faax0+by0=d\u7684\u89e3x0\u548cy0\uff0c\u90a3\u4e48\u4e24\u8fb9\u4e58\u4ee5c/d\u5373a(c/d * x0) + b(c/d * y0) = c\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u539f\u6765\u65b9\u7a0b\u7684\u89e3x = (c/d * x0)\uff0cy = (c/d * y0)\u3002\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<iostream>\n#include<cstdio>\n#define ll long long \nusing namespace std;\nll ans,x1,y1;\n\nll exgcd(ll a,ll b,ll &x1, ll &y1)\n{\n    if(!b)\n    {\n        x1=1;\n        y1=0;\n        return a;\n    }\n    ans=exgcd(b,a%b,x1,y1);\n    ll t=x1;\n    x1=y1;\n    y1=t-a/b*y1;\n    return ans;\n}\n\nint main()\n{\n    ll n,m,x,y,l;\n    cin>>x>>y>>m>>n>>l;\n    ll b=n-m,a=x-y;\n    if(b<0)\n    {\n        b=-b;\n        a=-a;\n    }//\u5904\u7406\u8d1f\u6570 \n    exgcd(b,l,x1,y1);\n    if(a%ans!=0)//\u5224\u65ad\u65b9\u7a0b\u6709\u65e0\u89e3\u3002 \n        cout<<\"Impossible\";\n    else\n        cout<<((x1*(a/ans))%(l/ans)+(l/ans))%(l/ans);//\u5904\u7406\u8d1f\u6570 \n}\n```\n",
        "postTime": 1568776913,
        "uid": 169187,
        "name": "luminouris",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "### \u4e00\u7bc7\u6e05\u695a\uff08~~\u5b57\u5c11~~\uff09\u7684\u9898\u89e3\n\n\u7531\u4e8e\u7eac\u5ea6\u7ebf\u662f\u73af\u5f62\u7684\uff0c\u81ea\u7136\u7684\u60f3\u5230\u4e86\u540c\u4f59\u65b9\u7a0b\n\n\u5bf9\u4e8e$x$\uff0c$y$\uff0c$m$\uff0c$n$\uff0c$L$\uff0c\u6211\u4eec\u4ee4\n\n$$a=y-x,\\ b=n-m,\\ p=L$$\n\n\u4ee4\u7b54\u6848\u4e3a$k$\uff0c\u53ef\u5f97\u65b9\u7a0b\n\n$$a+b*k\\equiv 0\\mod p$$\n\n\u5982\u679c$gcd(b,p)=1$\uff0c\u5219 $b$ \u6709\u9006\u5143\uff0c\u76f4\u63a5\u5f97\u51fa\n\n$$k\\equiv -a*b^{-1}$$\n\n\u6b64\u65f6\u65b9\u7a0b\u6709\u5728$\\text{mod}\\ p$ \u610f\u4e49\u4e0b\u6709\u552f\u4e00\u89e3\u3002\n\n\u4f46\u662f\u6211\u4eec\u8fd8\u8981\u8003\u8651\u5230\u65b9\u7a0b\u6574\u4f53\uff0c\u6bd4\u5982a=4\uff0cb=2\uff0cp=6\uff0c\u867d\u7136$gcd(b,p)=2$\uff0c\u4f46\u662fk=2\u65f6\uff0c\u65b9\u7a0b\u662f\u6210\u7acb\u7684\uff0c\u8fd9\u65f6\u6211\u4eec\u5e94\u8be5\u5bf9\u65b9\u7a0b\u53d6\u6a21\u3002\n\n\u4ee4$g=gcd(a,b,p)$\uff0c\u5219\n\n$$A=\\frac ag,B=\\frac bg,P=\\frac pg$$\n\n\u6b64\u65f6\u5982\u679c$gcd(B,P)\\ne 1$\uff0c\u5219 $B$ \u65e0\u9006\u5143\uff0c\u53ef\u5224\u65e0\u89e3\u3002\n\n### code\uff1a\n\n```cpp\n// SeptEtavioxy\n#include<cstdio>\n#define ll long long\nusing namespace std;\n\nvoid exgcd(ll a,ll b,ll&d,ll&x,ll&y){\n\tif( !b ){ d=a,x=1,y=0;return ;}\n\texgcd(b,a%b,d,y,x); y-=x*(a/b);\n}\nll gcd(ll a,ll b){\n\treturn b? gcd(b,a%b):a;\n}\nint main(){\n\tint a1,a2,a3,a4,a5;\n\tscanf(\"%d%d%d%d%d\",&a1,&a2,&a3,&a4,&a5);\n\t\n\tll a=((a2-a1)%a5+a5)%a5, b=((a4-a3)%a5+a5)%a5, p= a5;\n\t\n\tll g= gcd(a,gcd(b,p));\n\ta/=g, b/=g, p/=g;\n\t\n\tll d,x,y;\n\texgcd(b,p,d,x,y);\n\tif( d==1 ) printf(\"%lld\",((-a)*x%p+p)%p);\n\telse puts(\"Impossible\");\n\t\n\treturn 0;\n}\n```",
        "postTime": 1568618306,
        "uid": 127195,
        "name": "z7z_Eta",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "[\u4f20\u9001\u95e8](https://www.luogu.org/problem/P1516)\n\n# \u524d\u7f6e\u77e5\u8bc6\n### \u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\n\n- \u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u662f\u7528\u6765\u6c42\u4e24\u4e2a\u6570\u7684\u6700\u5927\u516c\u56e0\u6570\u7684\u4e00\u4e2a\u7b97\u6cd5\uff0c\u5b83\u7684\u590d\u6742\u5ea6\u662f $O(log(a+b))$\n- $ \\forall a,b \\in N,b \\neq 0 $\u6709$ gcd(a,b) =gcd(b,a \\bmod b) $\n\n\u8bc1\u660e\u5982\u4e0b\uff1a\n\n\u82e5$ a<b ,gcd(b,a \\bmod b)=gcd(b,a)=gcd(a,b)$,\u6210\u7acb\uff1b\n\n\u82e5$ a \\geq b$\n\n- \u8bbe$ a=q \\times b+r(q,r \\in N,0 \\leq r<b) $\n- \u90a3\u4e48$ r = a \\bmod b $\u3002\n- \u5bf9\u4e8e\u6240\u6709\u7684$a,b$\u7684\u516c\u56e0\u6570$d$\u90fd\u6709 $ d|a,d|q \\times b $,\u6240\u4ee5$d|r$\n- $a,b$\u7684\u516c\u56e0\u6570\u96c6\u5408\u4e0e$b,a \\bmod b$\u7684\u516c\u56e0\u6570\u96c6\u5408\u76f8\u7b49\uff0c\u6210\u7acb\n\n```cpp\nint gcd(int x,int y)\n{\n\treturn b ? gcd(b,a%b) : a;\n}\n```\n\n## \u6269\u5c55\u6b27\u51e0\u91cc\u5f97\n### TA\u7684\u7528\u9014\u662f\u89e3ax+by==gcd(a,b)\u7684\u4e00\u7ec4\u7279\u89e3\n\n\u65b9\u6cd5\u5982\u4e0b\uff1a\n- \u8bbe$d=gcd(a,b)$\n- $ax_{1}+by_{1}=d,bx_{2}+(a\\bmod b)y_{2}=d$\n- $bx_{2}+(a-  \\lfloor\\frac{a}{b}\\rfloor\\times b)y_{2}=d$\n- $bx_{2}+ay_{2}-\\lfloor\\frac{a}{b}\\rfloor \\times by_{2}=d$\n- $ay_{2}+b(x_{2}- \\lfloor\\frac{a}{b}\\rfloor \\times y_{2})=d$\n\n- $x_{1}=y_{2},y_{1}=x_{2}- \\lfloor\\frac{a}{b}\\rfloor \\times y_{2}$\n\n```cpp\nint exgcd(int a,int b,int &x,int &y)\n{\n    if(!b)\n    {\n        x=1,y=0;\n        return a;\n    }\n    int gcd=exgcd(b,a%b,x,y);\n    int t=x;\n    x=y,y=t-a/b*y;\n    return gcd;\n}\n```\n\n### \u5b83\u8fd8\u53ef\u4ee5\u7528\u6765\u6c42$ax+by=c$\u7684\u901a\u89e3\n**\uff08\u4ee5\u4e0b\u63a8\u5bfc\u5747\u6781\u4e0d\u4e25\u8c28\uff0c\u4ec5\u4f9b\u7406\u89e3\uff09**\n- **\u5f53$c$\u662f$d$\u7684\u6574\u6570\u500d\u65f6**\n\n\u6211\u4eec\u5148\u7528\u6269\u6b27\u6c42\u51fa$ax+by=d$\u7684\u4e00\u7ec4\u7279\u89e3$a_{0},b_{0}$.\n\n\u7136\u540e\u628a\u5de6\u53f3\u4e24\u8fb9\u540c\u65f6\u4e58\u4e0a$\\frac{c}{d}$\n,\u5f97\u5230$a_{0}\\frac{c}{d}x+b_{0}\\frac{c}{d}y=c$\n,\u5373\u76ee\u6807\u65b9\u7a0b\u7684\u4e00\u7ec4\u7279\u89e3\u3002\n\n\u90a3\u4e48\u600e\u4e48\u6c42\u901a\u89e3\u5462\uff1f\uff1f\n\n\u5176\u5b9e\uff0c\u611f\u89c9\u4e00\u4e0b\uff0c\u8981\u6c42\u901a\u89e3\uff0c\u4e24\u4e2a\u672a\u77e5\u6570\u5e94\u8be5\u662f\u6b64\u6d88\u5f7c\u957f\u7684\u5173\u7cfb,\u5c31\u662f\u4e00\u4e2a\u53d8\u5927\u53e6\u4e00\u4e2a\u53d8\u5c0f\u5566.\n\n\u4e0d\u59a8\u8bbe$(\\frac{c}{d}x+p)a_{0}+(\\frac{c}{d}y-q)b_{0}=c(p,q\\in Z)$\n\n\u6574\u7406\u4e00\u4e0b\uff0c$\\frac{c}{d}xa_{0}+pa_{0}+\\frac{c}{d}yb_{0}-qb_{0}=c$\n\n\u5373$pa_{0}=qb_{0}$\n\n\u73b0\u5728\u518d\u62cd\u51fa\u901a\u89e3\u516c\u5f0f\uff1a$x=\\frac{c}{d}x_{0}+k\\times\\frac{b}{d},y=\\frac{c}{d}y_{0}+k\\times\\frac{a}{d}$,\u662f\u4e0d\u662f\u597d\u7406\u89e3\u4e86\u4e00\u4e9b\uff1f\n\n\u5176\u4e2d$k$\u53d6\u904d\u6574\u6570\uff0c\u8fd9\u4e5f\u6bd4\u8f83\u597d\u7406\u89e3\uff0c\u52a0\u4e00\u6b21\u6210\u7acb\uff0c\u52a0\u4e24\u6b21\u4e09\u6b21\u81ea\u7136\u4e5f\u6210\u7acb\uff0c\u540c\u7406,\u51cf\u540c\u6837\u6210\u7acb\u3002\n\n- **\u5f53$c$\u4e0d\u662f$d$\u7684\u6574\u6570\u500d\u65f6**\n\n\u6b64\u65b9\u7a0b\u65e0\u6574\u6570\u89e3.\n\n## \u63a5\u4e0b\u6765\u770b\u9898\uff1a\n\n\u4e00\u53e5\u8bdd\u9898\u610f:\u5df2\u77e5$ x+qm=y+qn(mod L) $,\u6c42$q$\u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3\n\n\u5148\u53d8\u5f62\uff1a\n- $x+qm-y-qn=pL$\n- $(m-n)q-Lp=y-x$\n- $(n-m)q+Lp=x-y$\n\n\u8fd9\u6837\u5c31\u53d8\u6210\u4e86$ax+by=c$\u7684\u5f62\u5f0f\u4e86\u5462\n\n\u5176\u4e2d$a=n-m,b=L,c=x-y$\n\n\u4ecd\u7136\u6c42$q$\u7684\u6700\u5c0f\u6574\u6570\u89e3.\n\n\u6839\u636e\u901a\u89e3\u516c\u5f0f\uff0c\u5e94\u8be5\u7528\u7279\u89e3\u7684\u52a0\u4e0a\u6216\u51cf\u53bb$k\\frac{b}{d}$,\u7528\u53d6\u6a21\u5b9e\u73b0\uff0c\u8be6\u89c1\u4ee3\u7801\u3002\n\n```\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll exgcd(ll a,ll b,ll &x,ll &y)\n{\n    if(!b)\n    {\n        x=1,y=0;\n        return a;\n    }\n    ll ans=exgcd(b,a%b,x,y);\n    ll t=x;\n    x=y;\n    y=t-a/b*y;\n    return ans;\n}\nint main()\n{\n    ll x,y,m,n,l;\n    scanf(\"%lld%lld%lld%lld%lld\",&x,&y,&m,&n,&l);\n    ll q0=0,p0=0,a=n-m,b=l,c=x-y;\n    ll d=exgcd(a,b,q0,p0);\n    //cout<<d<<\" \"<<q0<<\" \"<<p0<<endl;\n    if(c%d!=0)puts(\"Impossible\\n\");\n    else\n    {\n        ll q=c/d*q0%(b/d);\n        if(q<=0)q+=abs(b/d);///\u9632\u6b62\u51fa\u73b0\u8d1f\u6570\n        printf(\"%d\\n\",q);\n    }\n}\n```\n",
        "postTime": 1567770838,
        "uid": 178867,
        "name": "kevin006",
        "ccfLevel": 0,
        "title": "\u9752\u86d9\u7684\u7ea6\u4f1a\uff08exgcd\uff09"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u4e2a\u5178\u578b\u6570\u8bba\uff08~~\u672c\u4eba\u8ba4\u4e3a\u6570\u8bba\u96be\u5230\u70b8~~\uff09\n\n\u5e9f\u8bdd\u4e0d\u591a\u8bf4\uff0c\u8fdb\u5165\u6b63\u9898\n\n\u4e24\u53ea\u9752\u86d9\u5728\u4e00\u4e2a\u73af\u4e0a,\u521d\u59cb\u4f4d\u7f6e\u4e3ax\uff0cy\uff0c\u901f\u5ea6\u4e3am\uff0cn\uff0c\u95ee\u591a\u957f\u65f6\u95f4\u540e\u76f8\u9047\n\n\u5148\u628a\u56fe\u653e\u51fa\u6765\u4fbf\u4e8e\u7406\u89e3\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/61821.png)\n\n\u8bbe\u4e24\u53ea\u9752\u86d9\u8df3\u4e86x\u6b65\uff0c\u5219\u7ea2\u8272\u5c31\u662fA\u9752\u86d9\u8981\u8ffd\u7684\u8def\u7a0b\uff0c\u84dd\u8272\u5c31\u662f\u5269\u4f59\u8def\u7a0b\n\n\u7531\u56fe\u77e5\u4e24\u6bb5\u76f8\u52a0\u7b49\u4e8e\u6574\u5708\u7684\u6574\u6570\u500d\n\n\u65b9\u7a0b\u5982\u4e0b\uff1a\n\n**(n-m) * x + y1 - x1 = l * y**\n\n**(n-m) * x - l * y = x1 - y1**\n\n\u5c31\u5316\u6210\u4e86ax+by=c\u7684\u5f62\u5f0f\uff0cx\u7684\u503c\u7531exgcd\u6c42\u51fa\uff0c\u82e5\u65e0\u89e3\u5219\u8f93\u51faImpossible\n\n\u5177\u4f53\u7ec6\u8282\u770b\u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#define ll long long\nusing namespace std;\nll n,m,t,l,x,y;\nll exgcd(ll a,ll b,ll &x,ll &y)\n{\n    if(!b)\n    {\n        x=1,y=0;\n        return a;\n    }\n    int ret=exgcd(b,a%b,x,y);\n    int t=x;x=y;y=t-a/b*y;\n    return ret;\n}//\u6269\u6b27\u6a21\u677f\nint main()\n{\n    ll x1,y1,c,d,a,b;\n    scanf(\"%lld%lld%lld%lld%lld\",&x1,&y1,&m,&n,&l);\n    if(m==n)//\u5982\u679c\u901f\u5ea6\u76f8\u540c\u5219\u65e0\u6cd5\u76f8\u9047\uff08\u76f8\u5bf9\u9759\u6b62\uff09\n    t=1;\n    else\n    {\n        a=n-m;\n        b=l;\n        d=x1-y1;\n        if(a<0)//\u5982\u679c\u4e0d\u8fd9\u6837\u505a\u5c31\u4f1a\u89e3\u51fa\u8d1f\u6570\n        {\n            a=-a;\n            d=-d;\n        }\n        c=exgcd(a,b,x,y);\n        if(d%c)\n        t=1;//\u65e0\u89e3\n    }\n    if(t)\n    printf(\"Impossible\\n\");\n    else\n    {\n        b/=c,d/=c;\n        printf(\"%lld\\n\",((x*d)%b+b)%b);\n    }\n    return 0;\n}\n```\n",
        "postTime": 1561970720,
        "uid": 103029,
        "name": "James_Brady",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "\u5178\u578b\u7684exgcd\u9898\u76ee\u3002\n\u8bbe\u8d70k\u6b65\uff0c\u9996\u5148\u7531\u9898\u76ee\u53ef\u5f97\n\uff08mk+x\uff09%l=\uff08nk+y\uff09%l\uff1b\u7531\u540c\u4f59\u516c\u5f0f\u53ef\u5f97\n\uff08mk+x\uff09%l-\uff08nk+y\uff09%l=0\uff1b\n\uff08\uff08mk+x\uff09%l=\uff08nk+y\uff09%l\uff09%l=0\uff1b\n\u5373mk-nk+x-y=ul\u3010u\u4e3a\u4e00\u6574\u6570\u3011\u3002\nk\uff08m-n\uff09-ul=y-x\u3002\n\u628ak\u770b\u6210x\uff0cn-m\u770b\u6210a\uff0cl\u770b\u6210b\uff0cu\u770b\u6210y\u5373\u53ef\u6c42exgcd\uff1b\n\u6b64\u9898\u8fd8\u8981\u5bf9\u6700\u540e\u7ed3\u679c\u53bb\u6700\u5c0f\u6574\u6570\u89e3\uff0c\u516c\u5f0f\u89c1\u4ee3\u7801\uff1a\n```c\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\nusing namespace std;\n#define xx 10010 \nlong l,x,y,m,n;\nlong xz,yz,r;\nint exgcd(long a,long b)\n{\n\tif(b==0)\n\t{\n\t\txz=1;\n\t\tyz=0;\n\t\treturn a;\n\t}\n\tr=exgcd(b,a%b);\n\tlong u=xz;\n\txz=yz;\n\tyz=u-(a/b)*yz;\n\treturn r;\n}\nint main()\n{\n\tcin>>x>>y>>m>>n>>l;\n\tlong az=n-m,bz=l;\n\tlong a=x-y;\n\tif(az<0)//\u8d1f\u6570\u5904\u7406\u3002 \n    {\n        az=-az;\n        a=-a;\n    }\n\texgcd(az,bz);\n\tif(a%r!=0) \n    cout<<\"Impossible\";\n    else\n    cout<<((xz*(a/r))%(l/r)+(l/r))%(l/r);\n    //\u6709\u7279\u6b8a\u89e3\u5f97\u6700\u5c0f\u89e3\u7684\u516c\u5f0f\u3002 \n\treturn 0;\n}\n```",
        "postTime": 1524887484,
        "uid": 37488,
        "name": "ghmgjf",
        "ccfLevel": 0,
        "title": "1516\u9752\u86d9\u7684\u7ea6\u4f1a"
    },
    {
        "content": "\u4ee4A=x-y;B=n-m;\n\n\u53ef\u5f97\u5230abs(A+B\\*y)%l=0;\n\n\u5373A+B\\*y=x\\*l;\n\n\u5316\u7b80\u7684B\\*y-x\\*l=-A;\n\n\u8fd9\u4e0d\u5c31\u662f\u5c31\u662f\u62d3\u5c55\u6b27\u51e0\u91cc\u5f97\u5417\uff1b\n\n\u4e0a\u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\ntypedef long long ll;\nll n,m,x,y,l,t;\nll b,a;\nll x1,y2,r,d;\nint gcd(ll a,ll b,ll&x,ll&y)\n{\n    if(b==0)\n    {\n        x=1;y=0;\n        return a;\n    }\n    d=gcd(b,a%b,x,y);\n    int t=x;\n    x=y;\n    y=t-(a/b)*y;\n    return d;\n}\nint main()\n{\n    scanf(\"%lld%lld%lld%lld%lld\",&x1,&y2,&m,&n,&l);\n     a=(x1-y2);\n    b=(n-m);\n    if(b<0)\n    {\n        a=-a;\n        b=-b;\n    }\n    r=gcd(b,l,x,y);\n    if(a%r!=0)\n        printf(\"Impossible\");\n    else\n    printf(\"%lld\",((x*a/r)%(l/r)+(l/r))%(l/r));\nreturn 0;\n}\n```",
        "postTime": 1500470610,
        "uid": 36557,
        "name": "zclong",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "/\\*\n\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u5e94\u7528\n\n(x+m\\*t)-(y+n\\*t)=p\\*L (t\u662f\u8df3\u7684\u6b21\u6570\uff0cp\u662fa,b\u7684\u5708\u6570\u5dee)\n\n\u7b49\u4ef7\u4e8e:(n-m)\\*t+L\\*p=y-x;\n\n\u4ee4a=n-m;b=L;c=y-x;\n\n\u7b49\u4ef7\u4e8e:a\\*t+b\\*p=c;\n\n\u6c42t\u7684\u6700\u5c0f\u6574\u6570\u89e3\u3002\n\n\n\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u6c42\u51fa\u5176\u4e2d\u4e00\u7ec4\u89e3t0,p0,\u4ee4g=gcd(a,b);\n\n\u56e0\u4e3a\u4e0d\u5b9a\u65b9\u7a0b\u6709\u89e3,\u6240\u4ee5a\\*t/g  b\\*t/g  d/g \u4e3a\u6574\u6570\n\n\u65b9\u7a0b\u4e24\u8fb9\u90fd\u4e58(c/g) \u5f97\u5230 a\\*t0\\*(c/g)+b\\*p0\\*(c/g)=c\\*(c/g);\n\n\u6240\u4ee5 t0\\*(c/g)\u662f\u6700\u5c0f\u89e3.\u4f46\u6709\u53ef\u80fd\u662f\u8d1f\u6570\n\n\u56e0\u4e3a a\\*(t0\\*(c/g)+b\\*k)+b\\*(p0\\*(c/g)-a\\*k)=c\\*(c/g);\u5176\u4e2dk\u662f\u81ea\u7136\u6570\n\n\u6240\u4ee5\u89e3\u4e3a (t0\\*(c/g)%b+b)%b;\n\n\\*/\n\n\n\n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\nlong long a,b,c,m,n,l,x,y,g;\nvoid ex_gcd(long long a,long long b)//\u6c42\u51fa\u4e00\u7ec4\u89e3t0,p0 \n{\n    if(b==0)\n    {\n        x=1;y=0;g=a;\n        return;\n    }\n    ex_gcd(b,a%b);\n    long long tmp=x;x=y;y=tmp-a/b*y;\n}\nint main()\n{\n    scanf(\"%lld%lld%lld%lld%lld\",&x,&y,&m,&n,&l);\n    a=m-n;b=l;c=y-x;\n    if(a<0){a=-a;c=-c;}\n    ex_gcd(a,b);\n    if(c%g){printf(\"Impossible\\n\");return 0;}//\u65e0\u89e3 \n    else//\u6709\u89e3 \n    {\n        x=x*c/g;l=l/g;\n        x=(x%l+l)%l;//\u5904\u7406x\u53ef\u80fd\u4e3a\u8d1f \n        printf(\"%d\\n\",x);\n    }\n    return 0;\n}\n```",
        "postTime": 1492904326,
        "uid": 20833,
        "name": "\u5b89\u597d",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "\u4e00\u5f00\u59cb\u7684\u5efa\u6a21\u90e8\u5206\u3002\u5f88\u5bb9\u6613\u5199\u51fa\u4e0b\u9762\u7684\u7b49\u5f0f:\n\n(x + a\\*m) mod L = (y + b\\*n) mod L \n\n\u5229\u7528\u7ebf\u6027\u540c\u4f59\u8fdb\u4e00\u6b65\u5316\u6210\u5982\u4e0b\u5f62\u5f0f:\n\na\\*x = b (mod n)   \n\n\u5176\u4e2d a = (n - m)\n\n        b = (x - y)   \n\n        n = L \n\n\u9996\u5148\u5224\u65ad\u6b64\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u662f\u5426\u6709\u89e3\uff0c\u6709\u89e3\u7684\u8bdd\uff0c\u7ed9\u51fa\u6700\u5c0f\u6b63\u6570\u89e3\u3002\n\n\u8fd9\u4e2a\u7ebf\u6027\u65b9\u7a0b\u6709\u89e3\uff0c\u5f53\u4e14\u4ec5\u5f53gcd(a, n)\u80fd\u6574\u9664b\u3002\u800c\u6c42gcd\uff0c\u5f53\u7136\u5c31\u662f\u9012\u5f52\u7684\u3002\n\n\u82e5\u6c42gcd(a, b),\u5047\u8bbea < b, \u90a3\u4e48\u4e00\u5b9a\u53ef\u4ee5\u5199\u6210:\n\nb = a\\*q + r \n\n\u5176\u4e2dq\u662f\u5546\uff0cr\u662f\u4f59\u6570\u3002\u5047\u8bbed = gcd(a, b); \u90a3\u4e48\u663e\u7136d\u80fd\u6574\u9664b\u548ca\uff0c\u6240\u4ee5d\u4e5f\u80fd\u6574\u9664\u4e0a\u5f0f\u7684r\u3002\u7531\u4e8er \u4e00\u5b9a\u5c0f\u4e8ea\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ea\u8981\u6c42 gcd(r, a)\u3002\u4e8e\u662f\u95ee\u9898\u7684\u89c4\u6a21\u5c31\u9012\u5f52\u5316\u7b80\u4e86\u3002\u518d\u60f3\u60f3\u8fb9\u754c\u6761\u4ef6\uff0c\u663e\u7136\u662f a | b\u3002\u8fd9\u65f6r\u4e3a0.\n\n```cpp\nvar\n  x,y,l,m,n:int64;\nfunction exgcd(a,b:int64;var x,y:int64):int64;\nbegin\n  if b=0 then begin x:=1;y:=0;exit(a); end;\n  exgcd:=exgcd(b,a mod b,y,x);\n  y:=y-(a div b)*x;\nend;\nprocedure work(a,b,m:int64);\nvar\n  n,x,y:int64;\nbegin\n  n:=exgcd(a,b,x,y);\n  if m mod n<>0 then begin\n        write('Impossible');\n        halt;\n    end;\n  m:=m div n;\n  b:=abs(b div n);\n  x:=x*m;\n  x:=(x mod b+b) mod b;\n  writeln(x);\nend;\nbegin\n  readln(x,y,m,n,l);\n  if m=n then begin\n        write('Impossible');\n        halt;\n    end;\n  work(m-n,l,y-x);\nend.\n```",
        "postTime": 1471838377,
        "uid": 3116,
        "name": "\u98de\u7fd4",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "## \u63a8\u5bfc\n\u6839\u636e\u9898\u610f\u4e0d\u96be\u5f97\u51fa\u8fd9\u6837\u5b50\u7684\u540c\u4f59\u65b9\u7a0b\n\n$$x+mx_0\u2261y+nx_0\\ (mod\\ l)$$\n\n\u7136\u540e\u5c31\u662f\u4e2a\u5957\u8def\u9898\u3002\n\n\u5bf9\u4e8e$x\u2261y(mod\\ m)$,\u5f53\u4e14\u4ec5\u5f53$x=km+y$\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5217\u51fa\u8fd9\u6837\u7684\u65b9\u7a0b\n\n$$x+mx_0=y_0L+y+nx_0$$\n\n\u5316\u4e3a\u4e00\u822c\u5f62\u5f0f\n\n$$(m-n)x_0+ly_0=y-x$$\n\n\u5269\u4e0b\u7684\u5c31\u662f\u4e2a$exgcd$\n\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nll x,y,m,n,l;\nll x_,y_,d;\nvoid exgcd(ll a,ll b,ll &x,ll &y){\n\tif(!b){\n\t\tx=1,y=0;d=a;return;\n    }\n\texgcd(b,a%b,y,x);\n   \ty-=a/b*x;\n}\nint main(){\n\tscanf(\"%lld%lld%lld%lld%lld\",&x,&y,&m,&n,&l);\n\tll a=m-n,b=y-x;\n\tif(a<0)a=-a,b=-b;\n\texgcd(a,l,x_,y_);\n\tif(b%d){\n\t\tputs(\"Impossible\");\n\t\texit(0);\n    }\n\telse printf(\"%lld\\n\",(x_*b/d%(l/d)+(l/d))%(l/d));\n\treturn 0;\n}\n```",
        "postTime": 1567417161,
        "uid": 58707,
        "name": "Edward_Elric",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "~~\u9752\u86d9\u90fd\u6709\u7ea6\u4f1a     www~~~\n\n# \u524d\u8a00\n\n#### \u25c6\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\n\u5bf9\u4e8e\u4efb\u610f\u6574\u6570a.b,\u5b58\u5728\u4e00\u5bf9\u6574\u6570x\uff0cy,\u6ee1\u8db3ax+by=gcd(a.b)\u3002\n,\u5728\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u7684\u6700\u540e\u4e00\u6b65,\u5373b=0\u65f6,\u663e\u7136\u6709\u4e00\u5bf9\u6574\u6570x=1\uff0cy=0,\u4f7f\u5f97a+0=gcd(a,O);\u82e5b>0,\u5219\u5047\u8bbe\u5b58\u5728\u4e00\u5bf9\u6574\u6570x,y,\u6ee1\u8db3b*x+\n(a mod b)*y=gcd(b, a mod b),\u53c8\u6839\u636e\u6a21\u6027\u8d28\uff0c\u62c6\u5f00\u540e\u5f97\uff1a\nay+b(x-ay/b)=gcd(b,a mod b);\u5219\u53ef\u8ba9x=y,y=x-(a/b)*y\u4e00\u6b65\u6b65\u9012\u5f52\u4e0b\u53bb\u3002\n\n#### \u25c6\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\n\u7ed9\u5b9a\u6574\u6570a\uff0cb\uff0cm,\u6c42\u4e00\u4e2a\u6574\u6570x\u6ee1\u8db3a*x\u2261b(mod m),\u6216\u8005\u7ed9\u51fa\u65e0\u89e3\u3002\u56e0\u4e3a\n\u672a\u77e5\u6570\u7684\u6307\u6570\u4e3a1,\u6240\u4ee5\u6211\u4eec\u79f0\u4e4b\u4e3a\u4e00\u6b21\u540c\u4f59\u65b9\u7a0b,\u4e5f\u79f0\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u3002\na*x\u2261b(mod m)\u7b49\u4ef7\u4e8eax-b\u662fm\u7684\u500d\u6570,\u4e0d\u59a8\u8bbe\u4e3a-y\u500d\u3002\u4e8e\u662f,\u8be5\n\u65b9\u7a0b\u53ef\u4ee5\u6539\u5199\u4e3aa*x+m*y=b\u3002\n\u6839\u636e\u5b9a\u7406\u53ca\u5176\u8bc1\u660e\u8fc7\u7a0b,\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u6709\u89e3\u5f53\u4e14\u4ec5\u5f53b\u662fgcd(a,m)\u7684\u500d\u6570\u3002\n\u5728\u6709\u89e3\u65f6,\u5148\u7528\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u6c42\u51fa\u4e00\u7ec4\u6574\u6570x0\uff0cy0,\u6ee1\u8db3a*x0+m*y0=gcd(a,m)\n\u3002\u7136\u540e**x=x0+b/gcd(a,m)** \u5c31\u662f\u539f\u7ebf\u6027\u540c\u4f59\u65b9\u7a0b\u7684\u4e00\u4e2a\u89e3\n\u65b9\u7a0b\u7684\u901a\u89e3\u5219\u662f\u6240\u6709\u6a21m/gcd(a,m)\u4e0ex\u540c\u4f59\u7684\u6574\u6570\u3002\n\n# \u5f00\u59cb\u6b63\u9898\n\n\u6ce8\u610f\u5411\u897f\u4e3a\u6b63\u65b9\u5411\uff0c\u53ef\u81ea\u884c\u753b\u4e00\u4e2a\u5706\u6a21\u62df\u6837\u4f8b\n\n\u6613\u5f97\u65b9\u7a0b **x+km=y+kn;** k\u5373\u4e3a\u6240\u6c42\n\n\u5219\u6709x+km\u4e0ey+kn\u5173\u4e8emod l\u540c\u4f59\uff0c\u5373x+km\u2261\uff08y+kn\uff09mod l\n\n\u65e2\u7136\u4f59\u6570\u76f8\u7b49 \u5219x+km\u51cf\u53bby+kn\u4e00\u5b9a\u4e3al\u500d\u6570\uff0c\u8bbe\u4e3ap\n\n**\uff08\uff08x+km\uff09-(y+kn\uff09)=pl**\n\n\u5408\u5e76\u5f97k(m-n)+pl=y-x\n\n\u518d\u8bbea=m-n; b=l res=y-x;\u5c31\u6709ak+bp=res\n\n\u7b49\u7b49\uff0c\u597d\u719f\u6089\uff0c\u8fd9\u4e0d\u662f\u540c\u4f59\u65b9\u7a0b\u6c42k\u5417\n\n\u90a3\u95ee\u9898\u5c31\u7b80\u5355\u4e86\uff0c\u5c31\u662f\u7528\u6269\u6b27\u6c42\u65b9\u7a0b\u7684\u65b9\u6cd5\n\nimpossble\u7684\u60c5\u51b5\u5373c\u4e0d\u662fgcd(a,b)\u7684\u500d\u6570\u65f6\u3002\n\n\u6211\u4eec\u5148\u628a\u5f0f\u5b50\u770b\u6210ak+bp=gcd(a,b)\uff0c\u7528\u6269\u6b27\u6c42\u51fak\uff0c\u518d\u7528\u4e0a\u9762\u6240\u8bb2\u7684\u540c\u4f59\u65b9\u7a0b\u7684\u77e5\u8bc6\u6c42\u51fa\u771f\u6b63\u65b9\u7a0bak+bp=res\u7684\u4e00\u4e2a\u89e3k\n\u4e0d\u8fc7\u8fd9\u4e2a\u89e3\u53ef\u80fd\u4e0d\u662f\u6700\u5c0f\u503c\uff0c\u6211\u4eec\u9700\u8981\u518d\u8003\u8651\uff0c\u5982\u4e0b\uff1a\n\n\u82e5\u6709ax+by=c\uff0cax0+by0=c\uff0c\u5219\u6709a\uff08x-x0\uff09+b(y-y0)=\n0\uff0c\n\u4e24\u8fb9\u540c\u65f6\u9664\u4ee5gcd(a,b)\u53ef\u5f97\uff1aa/gcd(a,b)\u4e58\u4ee5\uff08x-x0\uff09=-b/gcd(a,b)\u4e58\u4ee5(y-y0)\u3002\n\u7531a/gcd(a,b)\u4e0eb/gcd(a,b)\u4e92\u8d28//**\u4e00\u9879\u57fa\u672c\u5b9a\u7406**\n\u53ef\u5f97\u8981\u4f7f\u7b49\u5f0f\u6210\u7acb\u4e00\u5b9a\u6709\uff08x-x0\uff09\u662fb/gcd(a,b)\u7684\u500d\u6570\uff0c\u5373x=x0+k*(b/gcd(a,b)),k\u2208Z;\n\u90a3\u4e48k\u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u5373\u53ef\u7528k = (k % (b / cd) + (b / cd)) % (b / cd)\u8868\u793a    ~~//cd\u5373gcd(a,b)~~\n\u60f3\u4e00\u4e0b\uff0c\u4e3a\u4ec0\u4e48\u8981\u8fd9\u6837\u8868\u793a\uff1f\n\n\u597d\u5427\uff0c~~\u6211\u8fd8\u662f\u592a\u5584\u826f\u4e86~~\uff0c\u8fd9\u6837\u53ef\u4ee5\u76f4\u63a5\u5c06\u6b63\u8d1f\u6570\u90fd\u7ed9\u5316\u7b80\u6210\u6700\u5c0f\u6b63\u6574\u6570\u89e3\uff0c\u5c31\u4e0d\u7528\u5206\u7c7b\u8ba8\u8bba\u4e86qwq\u3002\n\n\u90a3\u8fd9\u9053\u9898\u5c31work out\u4e86  //~~\u6765\u81ea\u82f1\u8bed\u849f\u84bb\u7684\u663e\u6446~~\n\nAC code\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#define ll long long\n\nusing namespace std;\n\nll x, y, n, m, l, ans;\n\nll gcd(ll x, ll y)\n{\n\tif(!y)\n\t\treturn x;\n\treturn gcd(y, x % y);\n}\n\nvoid exgcd(ll a, ll b)\n{\n\tif(!b)\n\t{\n\t\tx = 1;\n\t\ty = 0;\n\t\treturn;\n\t}\n\texgcd(b, a % b);\n\tll t = x;\n\tx = y;\n\ty = t - (a / b * y);\n}\n\nint main()\n{\n\tscanf(\"%lld%lld%lld%lld%lld\", &x, &y, &m, &n, &l);\n\tll a = m - n, b = l;\n\tll res = y - x;\n\tif(a < 0)\n\t\ta = -a, res = - res;//\u8fd9\u91cc\u6ce8\u610f\u53d6\u503c\n\tif(res % gcd(a, b) != 0) \n\t{\n\t\tprintf(\"Impossible\");\n\t\treturn 0;\n\t}\n\telse\n\t{\n\t\texgcd(a, b);\n\t\tll cd = gcd(a, b);\n\t\tll bei = res / cd;\n\t\tx = x * bei;\n\t\tx = (x % (b / cd) + (b / cd)) % (b / cd);\n\t}\n\tprintf(\"%lld\", x);\n\t\nreturn 0;\n}\n```\n\u7ed3\u675f\u4e86\u5417\uff1f\uff1f\uff1f\n\u597d\u5427\u518d\u89c1qwq",
        "postTime": 1565442408,
        "uid": 145306,
        "name": "\u4e36\u96d6",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "\u4e00\u770b\u8fd9\u9053\u9898\u5c31\u662f\u540c\u4f59\u3002\u7136\u540e\u5c31\u5f00\u59cb\u63a8\u65b9\u7a0bqwq\n\n$$x+mk\\equiv y+nk\\pmod L$$\n\n$$x+mk-(y+nk)=Lz$$\n\n$$(m-n)k+Lz=y-x$$\n\n\u56e0\u4e3a$m-n$\u3001$L$\u3001$y-x$\u90fd\u662f\u5df2\u77e5\u7684\uff0c\u6240\u4ee5\u8fd9\u5c31\u662f\u4e00\u4e2a\u6269\u6b27\u7684\u6a21\u578b\u3002\n\n\u6269\u6b27\u5c31\u4e0d\u8bf4\u4e86\uff0c\u53ef\u4ee5\u770b[\u8fd9\u7bc7](https://www.luogu.org/blog/wyhwyh/shu-lun)\u6587\u7ae0\n\n\u603b\u4f53\u6765\u8bf4\uff0c\u5982\u679c\u4f60\u770b\u61c2\u4e86\u6269\u6b27\uff0c\u8fd9\u5012\u9898\u5e94\u8be5\u4e0d\u96be\uff0c\u4e0d\u8fc7\u7ec6\u8282\u86ee\u591a\u7684\u3002\n\n1. \u4e0d\u80fd\u4e71\u7528abs()\uff0c\u8003\u8651\u597d\u518d\u7528\u3002\n\n2. \u5343\u4e07\u4e0d\u8981\u53d8\u91cf\u91cd\u540d\uff0c\u8fd9\u5bfc\u81f4\u4e86\u621120min\u7684\u9898\u505a\u4e862h\u3002\n\n3. \u6ce8\u610f\u53d6\u6a21\u65f6\u7684\u5224\u8d1f\uff0c\u8fd9\u662f\uff08\u6211\u8ba4\u4e3a\u7684\uff09\u96be\u70b9\n\n4. \u5f00long long ! \u5f00long long ! \u5f00long long !\n\n\u2026\u2026\u5e94\u8be5\u5c31\u8fd9\u4e9b\u4e86\u3002\n\n**Code**\n\n```cpp\n#include<algorithm>\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\n\ntypedef long long ll;\n\nll x_0,y_0,m,n,L;\nll g,x,y,ans;\nll a,b,c,mod;\n\ninline void readx(ll &x)\n{\n\tx=0;\n\tint s=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9')\n\t{\n\t\tif(ch=='-')\n\t\t\ts=-1;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9')\n\t{\n\t\tx=(x<<1)+(x<<3)+ch-'0';\n\t\tch=getchar();\n\t}\n\tx*=s;\n}\n\ninline ll gcd(ll a,ll b)\n{\n\tif(b==0) return a;\n\treturn gcd(b,a%b);\n}\n\ninline void exgcd(ll a,ll b,ll &x,ll &y)\n{\n\tif(!b) {x=1;y=0;return;}\n\texgcd(b,a%b,y,x);\n\ty-=a/b*x;\n}\n\nint main()\n{\n\treadx(x_0);readx(y_0);\n\treadx(m);readx(n);readx(L);\n\ta=m-n,b=L,c=y_0-x_0;\n\tg=gcd(a,b);\n\tmod=abs(L/g);\n\tif(c%g)\n\t{\n\t\tprintf(\"Impossible\\n\");\n\t\treturn 0;\n\t}\n\texgcd(a,b,x,y);\n\tans=(x*(c/g)%mod+mod)%mod;\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1565409891,
        "uid": 55032,
        "name": "wyhwyh",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "# \u9752\u86d9\u7684\u7ea6\u4f1a\n## \u539f\u9898\n\n> [\u539f\u9898](https://www.luogu.org/problemnew/show/P1516)\n\n\u4eca\u5f97\u9752\u86d9\u4e24\u53ea\uff0c\u5176\u4e00\u540d\u4e3a$A$\uff0c \u53e6\u4e00\u540d\u4e3a$B$\u3002\n\n\u9752\u86d9$A$\u4ece$x$\u5f00\u59cb\u8df3\uff0c\u6bcf\u6b21\u8df3$m$\u7c73\uff0c \u9752\u86d9$B$\u4ece$y$\u5f00\u59cb\u8df3\uff0c\u6bcf\u6b21\u8df3$n$\u7c73\uff0c\u4e24\u9752\u86d9\u540c\u65f6\u5f00\u59cb\u5f80\u540c\u4e00\u65b9\u5411\u8df3\uff0c\u95ee\u8df3\u51e0\u6b21\u53ef\u4ee5\u8df3\u5230\u540c\u4e00\u4f4d\u7f6e\u3002\uff08\u5730\u7403\u662f\u5706\u5f97\uff0c\u5468\u957f\u662f$L$\uff09\n\n\u5982\u679c\u4e0d\u80fd\u8df3\u5230\u540c\u4e00\u4f4d\u7f6e\uff0c\u5c31\u8f93\u51fa`Impossible`\n\n## \u5206\u6790\n\n\u8bbe\u4e00\u8d77\u8df3$K$\u6b21\u80fd\u8df3\u5230\u540c\u4e00\u4f4d\u7f6e\u3002\n\n> $$x + mK \\equiv y + nK \\pmod L$$\n\n\u79fb\u5411\u5f97\u5230\n\n> $$\\left ( x - y \\right ) + \\left ( m - n \\right )K \\equiv 0 \\pmod L$$\n\n\u8f6c\u6362\u4e3a\u6b27\u51e0\u91cc\u5f97\u65b9\u7a0b\u5f97\u5230\n\n> $$\\left ( x - y\\right ) + (m - n)K + K'L = 0$$\n\n\u79fb\u5411\u5f97\u5230\n\n> $$(m - n)K + K'L = \\left ( y - x\\right )$$\n\n$(m - n)$\u3001$(y - x)$\u548c$L$\u5df2\u7ecf\u77e5\u9053\uff0c\u62d3\u5c55\u6b27\u51e0\u91cc\u5f97\u6c42\u51fa\u4e00\u7ec4$K$\u548c$K'$\u5373\u53ef\n\n\u7136\u540e\u5c06$K$\u8c03\u6574\u5230\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u3002\n\n\u5173\u4e8e\u4e0d\u5b9a\u65b9\u7a0b\u4ece\u4e00\u7ec4\u89e3\u5f97\u5230\u5176\u4ed6\u89e3\u5f97\u8fc7\u7a0b\uff1a\n\n\u8bbe\n> $$d = gcd(a,b)$$\n\n> $$ d = ax + by = a(x + \\frac{b}{d} \\times t) + b(y - \\frac{a}{d} \\times t) ,t \\in \\mathbb{Z} $$\n\n\u901a\u8fc7\u786e\u5b9a\u8c03\u6574 $t$\uff0c\u5373\u53ef\u8c03\u6574\u4e00\u89e3\u5230\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u3002\n\n## \u6e90\u4ee3\u7801\n```cpp\n/*!\n * FileName: luogu-1516.cpp\n * This Problem is on luogu. The ID of the problem is 1516. \n * Copyright(c) 2019 Shu_Yu_Mo\n * MIT Licensed\n * Luogu: https://www.luogu.org/space/show?uid=44615\n * Github: https://github.com/oldsuold/\n * Gitee: https://gitee.com/Shu_Yu_Mo/\n * These words were created by an amazing tool written by Shu_Yu_Mo.\n */\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<cstring>\n#include<iostream>\n#include<cmath>\n#include<vector>\n#include<queue>\n#include<algorithm>\n#define inf 0x7fffffff\n#define LL long long\nusing namespace std;\nconst int _ = 233;\ninline LL read()\n{\n    char c = getchar(); LL sign = 1; LL x = 0;\n    while(c > '9' || c < '0') { if(c=='-')sign = -1; c = getchar(); } \n    while(c <= '9' && c >= '0') { x *= 10; x += c - '0'; c = getchar(); }\n    return x * sign;\n}\nvoid exgcd(LL a, LL b, LL &x, LL &y, LL &g)\n{\n    if(b == 0)\n    { g = a; x = 1;y = 0; }\n    else\n    {exgcd(b, a%b, x, y, g);  int X = x; x = y; y = X - (a / b) * y;}\n}\nint main()\n{\n    LL x = read(), y = read(), m = read(), n = read(), L = read(), d, tx, ty;\n//\texgcd(//, y, tx, ty, d);\n//\tcout<<tx<< ' '<< ty<<' '<<d<<endl; \n    if(n > m)\n        swap(x, y), swap(m, n);\n    exgcd(m - n, L, tx, ty, d);\n    int k = (y - x) % d;\n    if(k != 0)\n        puts(\"Impossible\");\n    else\n    {\n        tx = (y - x) / d * tx;//\u8c03\u6574\u65b9\u7a0b`c`\u81f3gcd(a, b)\n        printf(\"%lld\", (tx % (L / d) + (L / d)) % (L / d));\n    }\n    return 0;\n}\n```\n\n## tips\n - \u62d3\u5c55\u6b27\u51e0\u91cc\u5f97\u9700\u8981\u4f7fa\u548cb\u4e3a\u6b63\u6570\uff0c\u82e5 n > m \u65f6\uff0c\u4ea4\u6362\u4e24\u9752\u86d9\u7684\u4fe1\u606f\u3002\n - \u5bf9\u4e8e\u8c03\u6574\u5230\u6700\u5c0f\u6b63\u6574\u6570\u89e3\uff0c\u4f8b\u5982\u5f97\u5230\u4e00\u4e2a\u89e3$K$\uff0c\u901a\u8fc7\u4e58 $t$ \u500d\u7684 $\\frac{a}{d}$ \u5f97\u5230\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u3002\u53ea\u9700\u8981\n $$K = ((K mod \\frac{a}{d} )+ \\frac{a}{d})mod\\frac{a}{d}$$\n \n \u6ce8\u610f $long long$\u3002",
        "postTime": 1563243076,
        "uid": 44615,
        "name": "ShuYuMo",
        "ccfLevel": 8,
        "title": "\u3010luogu-1516\u3011\u9752\u86d9\u7684\u7ea6\u4f1a"
    },
    {
        "content": "\u9898\u76ee\u4f20\u9001\u95e8: [\u300cLuogu P1516\u300d\u9752\u86d9\u7684\u7ea6\u4f1a](https://www.luogu.org/problemnew/show/P1516)\n\n### \u9898\u76ee\u5927\u610f\n(\u89c4\u5b9a\u7eac\u5ea6\u7ebf\u4e0a\u4e1c\u7ecf0\u5ea6\u5904\u4e3a\u539f\u70b9\uff0c\u7531\u4e1c\u5f80\u897f\u4e3a\u6b63\u65b9\u5411\uff0c\u5355\u4f4d\u957f\u5ea61\u7c73\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u4e00\u6761\u9996\u5c3e\u76f8\u63a5\u7684\u6570\u8f74)\n\u73b0\u6709\u4e24\u53ea\u9752\u86d9$A,B$\n\u8bbe\u9752\u86d9$A$\u7684\u51fa\u53d1\u70b9\u5750\u6807\u662f$x$\uff0c\u9752\u86d9$B$\u7684\u51fa\u53d1\u70b9\u5750\u6807\u662f$y$\n\u9752\u86d9$A$\u4e00\u6b21\u80fd\u8df3$m$\u7c73\uff0c\u9752\u86d9$B$\u4e00\u6b21\u80fd\u8df3$n$\u7c73\uff0c\u4e24\u53ea\u9752\u86d9\u8df3\u4e00\u6b21\u6240\u82b1\u8d39\u7684\u65f6\u95f4\u76f8\u540c\n\u7eac\u5ea6\u7ebf\u603b\u957f$l$\u7c73\n\u6c42\u4e24\u53ea\u9752\u86d9\u8df3\u4e86\u51e0\u6b21\u4ee5\u540e\u624d\u4f1a\u78b0\u9762\n\n### \u9898\u89e3\n__*\u540c\u4f59\u65b9\u7a0b*__ \u6a21\u677f\u9898\n\u6c42\u89e3$x + km\\equiv y + kn \\pmod l$\n\n$Solve:$\n\n$x+km-(y+kn)=lz, z\\in Z$\n\n$(x-y)+k(m-n)-lz=0$\n\n$k(n-m)+lz=(x-y)$\n\n\u4ee4$a=x-y,b=n-m$\n\n\u4e0a\u5f0f\u53ef\u5316\u4e3a:\n$$\nkb+lz=a\n$$\n\u6c42\u8fd9\u4e2a\u65b9\u7a0b\u7684\u6700\u5c0f\u6574\u6570\u89e3\n\u5316\u4e3a\u6c42\u6b64\u4e0d\u5b9a\u65b9\u7a0b\u6700\u5c0f\u6574\u6570\u89e3\n$$k'b+lz'=gcd(b,l)$$\n\u4f7f\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u53ef\u5f97\u4e00\u7ec4\u7279\u89e3$(k',b')$\n\u6700\u5c0f\u89e3\u4e3a$k_{min} = k'\\bmod \\frac{l}{gcd(b,l)}$\n\u4ee5\u4e0a\u89e3$k_{min}$\u7684\u65b9\u7a0b\u53f3\u8fb9\u662f$gcd(b,l)$\u800c\u4e0d\u662f$a$\n\u6240\u4ee5\u7ed3\u679c\u4e3a\n$$\\boxed{ (k'\\times \\frac{a}{gcd(b,l)})\\bmod \\frac{l}{gcd(b,l)} }$$\n\n### \u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\n\nvoid exgcd(LL a, LL b, LL& d, LL& x, LL& y) {\n    if (!b) { d = a; x = 1; y = 0; }\n    else { exgcd(b, a % b, d, y, x); y -= x * (a / b); }\n}\n\nint main() {\n    LL n, m, x, y, l, gcd, x1, y1;\n    scanf(\"%lld %lld %lld %lld %lld\", &x, &y, &m, &n, &l);\n    LL b = n - m, a = x - y;\n    if (b < 0) { b = -b, a = -a; }\n    exgcd(b, l, gcd, x1, y1);\n    if (a % gcd) {\n        printf(\"Impossible\\n\");\n    } else {\n        LL ans = ((x1 * (a / gcd)) % (l / gcd) + (l / gcd)) % (l / gcd);\n        printf(\"%lld\\n\", ans);\n    }\n    return 0;\n}\n/* 26ms 916kB */\n```",
        "postTime": 1560498909,
        "uid": 141791,
        "name": "Tony_Wong",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "# \u7b80\u5355\u6570\u8bba\n\n\uff08\u6211\u7684\u7b2c\u4e00\u9053\u6570\u8bba\u9898\uff09\n\n------------\n\u7531\u9898\u610f\u77e5\uff1a\n1. x+mt\u2261y+nt(mod L)\n1. x+mt+kL=y+nt\n1. (m-n)t+Lk=(y-x)\n\n\u4e00\u5b9a\u5b58\u5728\u4e00\u7ec4t,k,\u4f7f(m-n)t+Lk==gcd(m-n,L)\n\n\u62d3\u5c55\u6b27\u51e0\u91cc\u5fb7\u5b9a\u7406\u6c42\u51fa\u4e00\u7ec4t,k\uff1b\n\n\u5982\u679c(y-x)%gcd(m-n,L)!=0,\u65e0\u89e3\n\n\u5426\u5219t*=((y-x)/gcd(m-n,L))\n\n\u901a\u8fc7a(x+b/d*t)+b(y-b/d*t)=c\u8c03\u6574t\uff0c\u4f7ft\u4e3a\u6700\u5c0f\u6b63\u6574\u6570\u5373\u53ef\n\n\n------------\n\n### \u4ee3\u7801\uff1a\n```c\n#include<bits/stdc++.h>\nusing namespace std;\n#define go(i,a,b) for(int i=(a);i<=(b);++(i))\n#define com(i,a,b) for(int i=(a);i>=(b);--(i))\n#define mem(a,b) memset((a),(b),sizeof(a))\n#define inf 0x3f3f3f3f\n#define fin freopen(\"input.txt\",\"r\",stdin)\n#define fout freopen(\"output.txt\",\"w\",stdout)\ntypedef long long ll;\n\nvoid exgcd(ll a,ll b,ll &x,ll& y,ll& d){\n\tif(b) exgcd(b,a%b,y,x,d),y-=a/b*x;\n\telse d=a,x=1,y=0;\n}\n\nvoid init(){\n\tll x,y,m,n,l;\n\tscanf(\"%lld%lld%lld%lld%lld\",&x,&y,&m,&n,&l);\n\tll d,t,k;\n\tif(m<n){\n\t\tswap(m,n),swap(x,y);\n\t}\n\texgcd(m-n,l,t,k,d);\n\tif((y-x)%d){\n\t\tprintf(\"Impossible\");\n\t}\n\telse{\n\t\tt*=((y-x)/d);\n\t\tt=(t%(l/d)+(l/d))%(l/d);\n\t\tprintf(\"%lld\",t);\n\t}\n\t\n}\n\nint main()\n{\n\t//fin;\n\tinit();\n\treturn 0;\n}\n```",
        "postTime": 1550548418,
        "uid": 109434,
        "name": "\u98ce\u968f\u9010\u5f71",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "//\u6269\u5c55gcd\u771f\u597d\u73a9\uff01\n\n\u56e0\u4e3a\u9898\u76ee\u7ed9\u51fa\u7684\u662f\u4e00\u6761\u9996\u5c3e\u76f8\u63a5\u7684\u6570\u8f74\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a\u9898\u76ee\u7684\u95ee\u9898\u8f6c\u5316\u6210\u6210\uff1a\u6c42\u89e3 x+m*k\u2261y+n*k(mod L)\n\n\u6765\u6765\u6765\u8ba9\u6211\u4eec\u5316\u7b80\u8fd9\u4e2a\u5f0f\u5b50\uff01\n\nk*(m-n)\u2261y-x(mod L)\n\n\u518d\u628amod L\u53bb\u6389\u884c\u4e0d\u884c\u554aqwq\n\n\u53ef\u4ee5\u554a\uff01\n\n$$k*(m-n)+r*L=y-x$$\n\n\u8fd9\u4e2a\u65f6\u5019\u8bbe**a=m-n,b=L,y-x=c**\uff0c\u5219\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u6ee1\u8db3\u4e86ax+by=c\u7684\u5f62\u5f0f\uff0c\u53ef\u4ee5\u4ee3\u5165\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5 [\u4e0d\u4f1a\u6269\u5c55gcd\u7684\u540c\u5b66\u5efa\u8bae\u5148\u53bb\u767e\u5ea6\u5b66\u4e00\u4e0b\u518d\u6765\u6253qwq] \u6c42\u5f97\u4e00\u7ec4\u7279\u89e3\n\n\u4f46\u662f\u6c42\u51fa\u7279\u89e3\u540e\u95ee\u9898\u53c8\u6765\u4e86 \u9898\u76ee\u8981\u6c42\u7684\u662f\u4e00\u7ec4\u6700\u5c0f\u6b63\u6574\u6570\u89e3 \u53ef\u662f\u6211\u4eec\u6c42\u51fa\u7684\u53ea\u662f\u4e00\u7ec4\u7279\u89e3\uff0c\u5e76\u4e0d\u4fdd\u8bc1\u5b83\u7684\u6b63\u8d1f\u6027\uff0c\u600e\u4e48\u529e\u5462\uff1f\n\n\u6211\u4eec\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u5c31\u8981\u77e5\u9053\u53e6\u5916\u4e00\u4e2a\u6027\u8d28 ax+by=c \u5728\u6c42\u51fa\u4e00\u7ec4\u7279\u89e3\u4e4b\u540e $x+k*a/gcd(a,b)$ \u4e5f\u4f1a\u662f\u539f\u65b9\u7a0b\u7684\u4e00\u7ec4\u89e3[\u81ea\u5df1\u7a0d\u5fae\u63a8\u4e00\u4e0b\u5e94\u8be5\u662f\u53ef\u4ee5\u63a8\u51fa\u6765\u7684qwq]\n\n\u672c\u4eba\u849f\u84bbqwq \u63a8\u5f97\u5982\u679c\u6709\u9519\u8bf7\u6307\u51fa\u6765qwq\n\u4e0b\u9762\u4e0a\u4ee3\u7801[\u5199\u7684\u5de8\u4e11QAQ]\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nlong long n,mss,yss;\nlong long x,y,xx,yy,mm,nn,L;\nvoid Exgcd(long long a,long long b)\n{\n\tif (a%b==0)\n\t{\n\t\tx=0;\n\t\ty=1;\n\t   return;\n\t}\n\tExgcd(b,a%b);\n    long long r=x;\n\tx=y;\n\ty=r-(a/b)*y;\n}\nint main()\n{\n\tscanf(\"%lld%lld%lld%lld%lld\",&xx,&yy,&mm,&nn,&L);\n\tif (mm<nn) swap(mm,nn),swap(xx,yy);\n\tlong long rr=mm-nn;\n\tlong long qwq=yy-xx;\n\tlong long nq=__gcd(rr,L);\n\tif (qwq%nq) \n\t{\n\t\tcout<<\"Impossible\";\n\t\treturn 0;\n\t}\n\tExgcd(rr,L);\n\tlong long ms=L/nq;\n\tcout<<((x*qwq/nq)%ms+ms)%ms;\n\treturn 0;\n} \n```",
        "postTime": 1539328388,
        "uid": 23899,
        "name": "\u4e03\u6761\u73b2\u5948",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    },
    {
        "content": "\u8fd9\u662f\u6211\u53d1\u7684\u7b2c\u4e8c\u7bc7\u9898 \u89e3\uff0c\u5176\u5b9e\u8fd9\u9898\u5f88~~\u7b80\u5355~~\nexgcd\u51fd\u6570\u7528\u7684\u662f\u6211~~\u81ea\u5df1~~\u8001\u5e08\u5199\u7684\u6a21\u677f\n\u7136\u540e\u4e3b\u51fd\u6570\u7528\u7684\u662f\u4e0d\u5b9a\u5f0f\u601d\u60f3\uff0c\u6211\u8bb0\u5f97\u6709\u5927\u4f6c\u5df2\u7ecf\u5199\u4e86\uff0c\u6211\u5c31\u4e0d\u591aBB\u4e86\n\n\n------------\n\n\u5185\u5fc3os\uff1a~~\u88c5\u903c\u7684\u673a\u4f1a\u6ca1\u4e86 \u5624\u5624\u5624~~\n\n\n------------\n\u4ee3\u7801\u5982\u4e0b\uff08AC\u7248\u672c\uff09\n```cpp\n#include<bits/stdc+.h>//\u901a\u7528\u5934\u6587\u4ef6\uff0c\u907f\u514d\u590d\u5236\u7c98\u8d34\uff0c\u6211\u52a8\u4e86\u70b9\u624b\u811a\n#define ll long long\nusing namespace std;\nint exgcd(ll a,ll b,ll&x,ll&y){\n\tif(b==0){\n\t\tx=1;\n\t\ty=0;\n\t\treturn a;\n\t}\n\tint g=exgcd(b,a%b,y,x);\n\ty-=a/b*x;\n\treturn g;\n}\nint main(){\n\tll x,y,m,n,l;\n\tcin>>x>>y>>m>>n>>l;\n\tll b=n-m,a=x-y;\n\tif(b<0){\n\t\tb=-b;\n\t\ta=-a;\n\t}\n\tint g=exgcd(b,l,x,y);\n\tif(a%g!=0){\n\t\tcout<<\"Impossible\";\n\t}\n\telse\n        cout<<((x*(a/g))%(l/g)+(l/g))%(l/g);\n    return 0;\n}\n\n\n```\n",
        "postTime": 1538810663,
        "uid": 65845,
        "name": "white_Norton",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1516 \u3010\u9752\u86d9\u7684\u7ea6\u4f1a\u3011"
    }
]
[
    {
        "content": "**Update On 2020.03.07: \u4fee\u590d\u4e86\u4ee3\u7801\u4e2d\u7684\u5c0f\u95ee\u9898\uff0c\u4fee\u6539\u4e86\u90e8\u5206\u7ec6\u8282\uff0c\u4f18\u5316\u4e86\u9605\u8bfb\u4f53\u9a8c\u3002\u611f\u8c22 [Marser](https://www.luogu.com.cn/user/17930) \u6307\u51fa\u4ee3\u7801\u9519\u8bef\u3002**\n\n---\n\n\u8003\u8651\u62c6\u5f00\u7edd\u5bf9\u503c\u8ba1\u7b97\u8d21\u732e\u3002\u5bf9\u4e8e $1$ \u5230 $N$ \u7684\u6392\u5217\uff0c\u4ece\u5c0f\u5230\u5927\u5730\u5c06\u63d2\u5165\u5b83\u4eec\u63d2\u5165\u6392\u5217\u4e2d\uff0c\u5047\u8bbe\u5373\u5c06\u63d2\u5165\u6570 $i$ \uff0c\u5219\u524d $i-1$ \u4e2a\u6570\u5df2\u7ecf\u88ab\u63d2\u5165\u5230\u6392\u5217\u4e2d\u3002\u8003\u8651\u5982\u4f55\u8ba1\u7b97 $i$ \u7684\u8d21\u732e\u3002\n\n\u4e0d\u96be\u53d1\u73b0\uff1a\u5728\u6700\u7ec8\u7684\u6392\u5217\u4e2d\uff0c$i$ \u7684\u8d21\u732e\u4e0e\u5b83\u548c\u524d $i-1$ \u4e2a\u6570\u548c\u8fb9\u754c\u7684\u76f8\u90bb\u60c5\u51b5\u6709\u5173\u3002\u5982\u679c $i$ \u67d0\u4e00\u8fb9\u4e0e\u8fb9\u754c\u76f8\u90bb\uff0c\u4f1a\u4ea7\u751f $0$ \u7684\u8d21\u732e\uff1b\u67d0\u4e00\u8fb9\u4e0e\u5c0f\u4e8e $i$ \u7684\u6570\u76f8\u90bb\uff0c\u4f1a\u4ea7\u751f $i$ \u7684\u8d21\u732e\uff1b\u67d0\u4e00\u8fb9\u4e0e\u5927\u4e8e $i$ \u7684\u6570\u76f8\u90bb\uff0c\u4f1a\u4ea7\u751f $-i$ \u7684\u8d21\u732e\u3002\n\n\u4f46\u662f\u5728\u8fd9\u91cc\u5927\u4e8e $i$ \u7684\u6570\u8fd8\u6ca1\u6709\u88ab\u63d2\u5165\uff0c\u6240\u4ee5\u8fd9\u91cc\u5fc5\u987b\u8981**\u5f3a\u5236**\u6570 $i$ \u4e0e\u524d $i-1$ \u4e2a\u6570\u548c\u8fb9\u754c\u7684\u76f8\u90bb\u60c5\u51b5\u624d\u80fd\u591f\u5728\u5f53\u524d\u9636\u6bb5\u8ba1\u7b97\u51fa $i$ \u5bf9\u5e8f\u5217\u4ef7\u503c\u7684\u8d21\u732e\u3002\n\n\u8bbe $f_{i,j,k,l}$ \u8868\u793a\u653e\u5b8c\u524d $i$ \u4e2a\u6570\u3001\u6570\u5217\u4e2d\u5b58\u5728 $j$ \u4e2a\u8fde\u901a\u5757\uff08\u5b9a\u4e49\u8fde\u901a\u5757\u4e3a\u4e00\u6bb5\u6781\u957f\u533a\u95f4\uff0c\u6ee1\u8db3\u8fd9\u4e00\u6bb5\u533a\u95f4\u4efb\u610f\u7684\u76f8\u90bb\u7684\u4e24\u4e2a\u6570\u90fd\u88ab\u5f3a\u5236\u5b9a\u4e3a\u76f8\u90bb\uff0c\u4e5f\u5c31\u662f\u8bf4\u5728\u4e4b\u540e\u7684\u8f6c\u79fb\u4e2d\uff0c\u8fd9\u4e00\u6bb5\u533a\u95f4\u5185\u4e0d\u80fd\u63d2\u5165\u6570\uff09\u3001\u6570\u5217\u603b\u4ef7\u503c\u4e3a $k-5000$\u3001\u6709 $l$ \u4e2a\u8fb9\u754c\u5df2\u7ecf\u4e0e\u67d0\u4e2a\u6570\u5f3a\u5236\u76f8\u90bb\u7684\u65b9\u6848\u6570\u3002\n\n\u8f6c\u79fb\u8003\u8651\u6570 $i$ \u7684\u76f8\u90bb\u60c5\u51b5\uff1a\n\n1. \u4e00\u8fb9\u4e0e\u8fb9\u754c\u76f8\u90bb\uff0c\u4e00\u8fb9\u4e0d\u4e0e\u5f53\u524d\u5b58\u5728\u7684\u8fde\u901a\u5757\u76f8\u90bb\u3002\u8fd9\u4f1a\u4ea7\u751f\u989d\u5916\u7684\u4e00\u4e2a\u8fde\u901a\u5757\uff0c\u5e76\u4ea7\u751f $-i$ \u7684\u4ef7\u503c\uff0c\u65b9\u6848\u6570\u4e3a $2-l$\uff1b\n\n2. \u4e00\u8fb9\u4e0e\u8fb9\u754c\u76f8\u90bb\uff0c\u4e00\u8fb9\u4e0e\u5f53\u524d\u5b58\u5728\u7684\u8fde\u901a\u5757\u76f8\u90bb\u3002\u8fd9\u4e0d\u4f1a\u5bfc\u81f4\u8fde\u901a\u5757\u6570\u53d8\u5316\uff0c\u4ea7\u751f $i$ \u7684\u4ef7\u503c\uff0c\u65b9\u6848\u6570\u4e3a $2-l$ \uff0c\u8981\u6c42 $j \\neq 0$\uff1b\n\n3. \u4e24\u8fb9\u5747\u4e0e\u5f53\u524d\u5b58\u5728\u7684\u8fde\u901a\u5757\u76f8\u90bb\u3002\u8fd9\u4f1a\u5bfc\u81f4\u4e24\u4e2a\u8fde\u901a\u5757\u5408\u5e76\u4ece\u800c\u8fde\u901a\u5757\u6570\u51cf\u5c11 $1$\uff0c\u4ea7\u751f $2i$ \u7684\u4ef7\u503c\uff0c\u65b9\u6848\u6570\u4e3a $j-1$ \uff0c\u8981\u6c42 $j \\geq 2$\uff1b\n\n4. \u4e24\u8fb9\u5747\u4e0d\u4e0e\u5f53\u524d\u5b58\u5728\u7684\u8fde\u901a\u5757\u76f8\u90bb\u3002\u8fd9\u4f1a\u4ea7\u751f\u989d\u5916\u7684\u4e00\u4e2a\u8fde\u901a\u5757\uff0c\u4ea7\u751f $-2i$ \u7684\u4ef7\u503c\uff0c\u65b9\u6848\u6570\u4e3a $j+1-l$\uff1b\n\n5. \u4e00\u8fb9\u4e0e\u5f53\u524d\u5b58\u5728\u7684\u8fde\u901a\u5757\u76f8\u90bb\uff0c\u53e6\u4e00\u8fb9\u4e0d\u4e0e\u5f53\u524d\u5b58\u5728\u7684\u8fde\u901a\u5757\u76f8\u90bb\u3002\u8fd9\u4e0d\u4f1a\u4ea7\u751f\u989d\u5916\u7684\u8fde\u901a\u5757\uff0c\u4ea7\u751f $0$ \u7684\u4ef7\u503c\uff0c\u65b9\u6848\u6570\u4e3a $2j-l$ \uff0c\u8981\u6c42 $j \\neq 0$\u3002\n\n\u6ce8\u610f\u5230 $45$ \u4e24\u79cd\u8f6c\u79fb\u7684\u65b9\u6848\u6570\u90fd\u51cf\u53bb\u4e86 $l$\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u4e24\u7aef\u90fd\u4e0d\u4e0e\u8fb9\u754c\u76f8\u90bb\u7684\u8fde\u901a\u5757\uff0c\u53ef\u4ee5\u9009\u62e9\u5de6\u53f3\u4e4b\u4e00\u4e0e\u5f53\u524d\u7684\u6570\u76f8\u90bb\uff0c\u4f46\u662f\u6709\u4e00\u6bb5\u4e0e\u8fb9\u754c\u76f8\u90bb\u7684\u8fde\u901a\u5757\u53ea\u6709\u53e6\u4e00\u7aef\u53ef\u4ee5\u3002\n\n\u7b54\u6848\u662f $\\frac{\\sum\\limits_{i=5000+M}^{10000} f_{N,1,i,2}}{n!}$\u3002\n\n\u7136\u540e\u8fd9\u9b3c\u9898\u8fd8\u8981\u6570\u636e\u7c7b\u578b\u5206\u6cbb\u2026\u2026$K \\leq 8$\u4f7f\u7528long double\uff0c$K \\leq 30$\u4f7f\u7528__float128\u3002\n\n\u8fd8\u8981\u6ce8\u610f\u5728 DP \u7684\u8fc7\u7a0b\u4e2d\u5c06 $\\frac{1}{n!}$ \u4e58\u5165\uff0c\u4e5f\u5c31\u662f\u5f53\u8f6c\u79fb\u5b8c $f_{i,j,k,l}$ \u4e4b\u540e\u5c06\u5176\u4e58\u4e0a $\\frac{1}{i}$\uff0c\u800c\u4e0d\u662f\u5148\u8ba1\u7b97\u65b9\u6848\u6570\u518d\u4e58\u4e0a $\\frac{1}{n!}$\u3002\u540e\u8005\u5728\u6bd4\u8f83\u5201\u94bb\u7684\u6570\u636e\u4e0b\u4f1a\u6389\u7cbe\u5ea6\u3002\n\n```c++\n#include<bits/stdc++.h>\n//This code is written by Itst\nusing namespace std;\n\nnamespace db{long double dp[2][110][10010][3];}\nnamespace flt{__float128 dp[2][110][10010][3];}\nint N , M , K;\n\ntemplate < class T >\n\nvoid out(T ans){\n        if(ans + 1e-14 >= 1){cout << \"1.\" << string(K,'0') << endl; return;}\n\tcout << \"0.\";\n\tans *= 10;\n\tfor(int i = 1 ; i <= K ; ++i){\n\t\tcout << (int)(ans + (K == i) * 0.5);\n\t\tans = (ans - (int)ans) * 10;\n\t}\n}\n\ntemplate < class T >\n\ninline void solve(T dp[][110][10010][3]){\n\tT ans = 0;\n\tdp[0][0][5000][0] = 1;\n\tint now = 0;\n\tfor(int i = 1 ; i <= N ; ++i){\n\t\tnow ^= 1;\n\t\tmemset(dp[now] , 0 , sizeof(dp[now]));\n\t\tfor(int j = 0 ; j < i ; ++j)\n\t\t\tfor(int k = 0 ; k <= 10000 ; ++k)\n\t\t\t\tfor(int p = 0 ; p <= 2 ; ++p)\n\t\t\t\t\tif(dp[now ^ 1][j][k][p]){\n\t\t\t\t\t\tif(k - 2 * i >= 0)\n\t\t\t\t\t\t\tdp[now][j + 1][k - 2 * i][p] += dp[now ^ 1][j][k][p] * (j + 1 - p) / i;\n\t\t\t\t\t\tif(j)\n\t\t\t\t\t\t\tdp[now][j][k][p] += dp[now ^ 1][j][k][p] * (j * 2 - p) / i;\n\t\t\t\t\t\tif(j >= 2 && k + 2 * i <= 10000)\n\t\t\t\t\t\t\tdp[now][j - 1][k + 2 * i][p] += dp[now ^ 1][j][k][p] * (j - 1) / i;\n\t\t\t\t\t\tif(p != 2){\n\t\t\t\t\t\t\tif(k - i >= 0)\n\t\t\t\t\t\t\t\tdp[now][j + 1][k - i][p + 1] += dp[now ^ 1][j][k][p] * (2 - p) / i;\n\t\t\t\t\t\t\tif(j && k + i <= 10000)\n\t\t\t\t\t\t\t\tdp[now][j][k + i][p + 1] += dp[now ^ 1][j][k][p] * (2 - p) / i;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t}\n\tfor(int i = M ; i <= 5000 ; ++i)\n\t\tans += dp[now][1][5000 + i][2];\n\tout(ans);\n}\n\nint main(){\n\tcin >> N >> M >> K;\n\tif(K <= 8)\n\t\tsolve(db::dp);\n\telse\n\t\tsolve(flt::dp);\n\treturn 0;\n}\n```",
        "postTime": 1548596366,
        "uid": 96296,
        "name": "Itst",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2612 \u3010[ZJOI2012]\u6ce2\u6d6a\u3011"
    },
    {
        "content": "\u56e0\u4e3a\u6709abs\u4e0d\u592a\u597d\u641e\uff0c\u8003\u8651\u62c6\u6389abs.\n\n\u751f\u6210\u6392\u5217\u7684\u65b9\u6cd5\u4e4b\u4e00\uff1an\u4e2a\u7a7a\u4f4d\uff0c\u4ece1\u5230n\u4e00\u6b21\u63d2\u5165\u4e00\u4e2a\u7a7a\u4f4d\u3002\n\n\u8fd9\u6837\u641e\u7684\u8bdd\u8003\u8651\u4e00\u4e2a\u6570\u7684\u8d21\u732e\n\n\u5982\u679c\u662f`233333 1 666666` `|233333-1|+|1-666666|==233333+-1+666666-1` \u6240\u4ee51\u7684\u8d21\u732e\u4e3a-2\n\u5982\u679c\u662f`233333 inf 666666` `|233333-inf|+|inf-666666|==inf-233333+inf-666666` \u6240\u4ee5inf\u7684\u8d21\u732e\u4e3a2inf\n\u5982\u679c\u662f`1 2 3` `|1-2|+|2-3|==2-1+3-2` \u6240\u4ee52\u7684\u8d21\u732e\u4e3a0\n\u4e5f\u5c31\u662f\u8bf4\u4e00\u4e2a\u6570\u7684\u8d21\u732e\u4e3a(-\u8fd9\u4e2a\u6570\u00d7(sgn(\u5de6\u8fb9\u7684\u6570-\u8fd9\u4e2a\u6570)+sgn(\u53f3\u8fb9\u7684\u6570-\u8fd9\u4e2a\u6570)))\n\n(\u8fb9\u754c\u4e0a\u7684\u6570\u53ef\u4ee5\u770b\u6210\u8fd9\u4e2a\u6570\u00d7(sgn(\u76f8\u90bb\u7684\u6570-\u8fd9\u4e2a\u6570))\n\n\u7136\u540e\u56e0\u4e3a\u662f\u4ece\u5c0f\u5230\u5927\u63d2\u7684\uff0c\u6240\u4ee5\u53ea\u8981\u770b\u8fd9\u4e2a\u6570\u548c\u591a\u5c11\u5df2\u63d2\u5165\u7684\u6570\u76f8\u90bb\n\n$f[i][j][k][l]:\u5df2\u7ecf\u63d2\u5165\u4e86i\u4e2a\u70b9\uff0c\u5171j\u6bb5\u8fde\u7eed\uff0c\u524d\u9762\u6570\u7684\u603b\u8d21\u732e\u4e3a(k-5000)\uff0c\u8fb9\u754c\u5171\u653e\u4e86l\u4e2a\u7684\u65b9\u6848\u6570$\n\nk\u7684\u8bdd\u4ece0~10000\uff0cC++\u515a\u6ca1\u8d1f\u4e0b\u6807\u53ea\u597d\u8fd9\u6837\u4e86\uff0cP\u515a\u65e0\u6240\u8c13\n\n\u63d2\u5165i\u5206\u591a\u79cd\u60c5\u51b5\n\n\n- \u63d2\u5165\u5728\u8fb9\u754c\uff0c\u4e14\u4e0e\u4e00\u6bb5\u76f8\u8fde\uff0c\u8d21\u732e\u4e3ai\n\n- \u63d2\u5165\u5728\u8fb9\u754c\uff0c\u81ea\u6210\u4e00\u6bb5\uff0c\u8d21\u732e\u4e3a-i\n\n- \u63d2\u5165\u4e0d\u5728\u8fb9\u754c\uff0c\u4e0e\u4e00\u6bb5\u76f8\u8fde\uff0c\u8d21\u732e\u4e3a0\uff08\u56e0\u4e3a\u4e00\u8fb9\u653e\u4e86\u4e00\u8fb9\u6ca1\u653e\uff09\n\n- \u63d2\u5165\u4e0d\u5728\u8fb9\u754c\uff0c\u81ea\u6210\u4e00\u6bb5\uff0c\u8d21\u732e\u4e3a-2i\n\n- \u63d2\u5165\u4e0d\u5728\u8fb9\u754c\uff0c\u800c\u4e14\u8fd9\u6b21\u63d2\u5165\u4f7f\u5f97\u4e24\u6bb5\u76f8\u8fde\uff0c\u8d21\u732e\u4e3a2i\n\n\n\u6700\u540e\u7edf\u8ba1\u4e00\u4e0b\u6bcf\u79cd\u591a\u5c11\u79cd\u60c5\u51b5\u5373\u53ef\u3002\n\n\u4e0d~~\u60f3~~\u4f1a\u5199\u9ad8\u7cbe\uff0c\\_\\_float128\u5927\u6cd5\u597d\n\n\nk<=8\u7528double\n\n[\u4ee3\u7801](http://www.cnblogs.com/xzz\\_233/p/7513366.html)\n",
        "postTime": 1505266346,
        "uid": 23118,
        "name": "\u03bb\u1d09\u028d",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2612 \u3010[ZJOI2012]\u6ce2\u6d6a\u3011"
    },
    {
        "content": "## \u5206\u6790\n\u849f\u84bb\u53d1\u73b0\u6ca1\u6709\u9ad8\u7cbe\u5ea6\u7684\u9898\u89e3\uff0c\u4e8e\u662f\u6765\u6c34\u4e00\u53d1\n\n\u56e0\u4e3a\u6709\u7edd\u5bf9\u503c\u4e0d\u597d\u5904\u7406\uff0c\u6240\u4ee5\u6211\u4eec\u5f3a\u5236\u4ece\u5c0f\u5230\u5927\u586b\u6570\n\n\u8bbe $f[i][j][p][o]$ \u4e3a\u5f53\u524d\u586b\u5230\u4e86\u7b2c $i$ \u4e2a\u6570\uff0c\u6ce2\u52a8\u5f3a\u5ea6\u4e3a $j$\uff0c\u6709 $p$ \u4e2a\u8fde\u7eed\u6bb5\u5e76\u4e14\u4e24\u7aef\u7684\u7aef\u70b9\u9009\u4e86 $o$ \u4e2a\u65f6\u7684\u6982\u7387\n\n\u6ce8\u610f\u8fd9\u91cc\u7684\u8fde\u7eed\u6bb5\u662f\u5f3a\u5236\u89c4\u5b9a\u7684\n\n\u90a3\u4e48\u8f6c\u79fb\u6709\u4e94\u79cd\uff1a\n\n$1$\u3001\u586b\u7684\u6570\u5355\u72ec\u6210\u4e3a\u4e00\u6bb5\u5e76\u4e14\u4e0d\u5728\u6574\u4e2a\u533a\u95f4\u7684\u4e24\u4e2a\u7aef\u70b9\u4e0a\n\n$f[i+1][j-i*2-2][p+1][o]+=f[i][j][p][o]*(p+1-o)$\n\n\u56e0\u4e3a\u540e\u9762\u586b\u5728\u8fd9\u4e2a\u6570\u4e24\u8fb9\u7684\u6570\u4e00\u5b9a\u6bd4\u8fd9\u4e2a\u6570\u5927\uff0c\u6240\u4ee5\u8fd9\u4e2a\u6570\u4e00\u5b9a\u505a\u8d1f\u8d21\u732e\n\n\u4e4b\u524d\u4e00\u5171\u6709 $p$ \u6bb5\uff0c\u53ef\u4ee5\u586b\u7684\u4f4d\u7f6e\u6709 $p+1$ \u79cd\n\n\u56e0\u4e3a\u4e00\u4e2a\u6bb5\u5982\u679c\u5728\u6574\u4e2a\u533a\u95f4\u7684\u4e24\u7aef\u7684\u8bdd\uff0c\u53ea\u80fd\u5728\u5b83\u7684\u4e00\u8fb9\u586b\uff0c\u8fd8\u8981\u51cf\u53bb $o$\n\n$2$\u3001\u586b\u7684\u6570\u5355\u72ec\u6210\u4e3a\u4e00\u6bb5\u5e76\u4e14\u5728\u6574\u4e2a\u533a\u95f4\u7684\u4e24\u4e2a\u7aef\u70b9\u4e0a\n\n$f[i+1][j-i-1][p+1][o+1]+=f[i][j][p][o]*(2-o)$\n\n\u6b64\u65f6\u8fd9\u4e2a\u6570\u53ea\u4f1a\u505a\u4e00\u6b21\u8d1f\u8d21\u732e\n\n\u65b9\u6848\u6570\u4e3a\u5269\u4f59\u7684\u6574\u4e2a\u533a\u95f4\u7684\u7aef\u70b9\u7684\u6570\u91cf\uff0c\u5373 $2-o$\n\n$3$\u3001\u65b0\u586b\u7684\u6570\u653e\u5728\u5df2\u6709\u7684\u8fde\u7eed\u6bb5\u7684\u4e00\u7aef\u5e76\u4e14\u4e0d\u4e0e\u5176\u5b83\u8fde\u7eed\u6bb5\u76f8\u90bb\n\n$f[i+j][j][p][o]+=f[i][j][p][o]*(p*2-o)$\n\n\u56e0\u4e3a\u8fd9\u4e2a\u6570\u4e00\u5b9a\u505a\u4e00\u6b21\u6b63\u8d21\u732e\u548c\u4e00\u6b21\u8d1f\u8d21\u732e\uff0c\u6240\u4ee5\u4f1a\u62b5\u6d88\uff0c\u603b\u8d21\u732e\u4e0d\u53d8\n\n\u6bcf\u4e2a\u8fde\u7eed\u6bb5\u90fd\u6709\u4e24\u4e2a\u7aef\u70b9\u53ef\u4ee5\u9009\uff0c\u518d\u51cf\u53bb\u5df2\u9009\u6574\u4e2a\u533a\u95f4\u7684\u7aef\u70b9\u7684\u6570\u91cf\n\n$4$\u3001\u65b0\u586b\u7684\u6570\u653e\u5728\u5df2\u6709\u7684\u8fde\u7eed\u6bb5\u7684\u4e00\u7aef\u5e76\u4e14\u4e0e\u5176\u5b83\u8fde\u7eed\u6bb5\u76f8\u90bb\n\n$f[i+1][j+2*i+2][p-1][o]+=f[i][j][p][o]*(p-1)$\n\n\u5176\u5b9e\u5c31\u662f\u628a\u4e24\u4e2a\u7aef\u62fc\u6210\u4e86\u4e00\u4e2a\u5927\u6bb5\n\n\u505a\u4e24\u6b21\u6b63\u8d21\u732e\n\n$5$\u3001\u65b0\u586b\u7684\u6570\u653e\u5728\u5df2\u6709\u7684\u8fde\u7eed\u6bb5\u7684\u4e00\u7aef\u5e76\u4e14\u5f53\u524d\u7684\u6570\u586b\u5230\u4e86\u6574\u4e2a\u533a\u95f4\u7684\u7aef\u70b9\u4e0a\n\n$f[i+1][j+i+1][p][o+1]+=f[i][j][p][o]*(2-o)$\n\n\u505a\u4e00\u6b21\u6b63\u8d21\u732e\n\n\u56e0\u4e3a\u9898\u76ee\u8981\u6c42\u4fdd\u7559\u7684\u4f4d\u6570\u4e0d\u4e00\u6837\n\n\u6240\u4ee5\uff0c\u5bf9\u4e8e\u7cbe\u5ea6\u8f83\u4f4e\u7684\u6d4b\u8bd5\u70b9\uff0c\u53ef\u4ee5\u7528 $double$ \u5199\n\n\u5bf9\u4e8e\u7cbe\u5ea6\u8f83\u9ad8\u7684\u6d4b\u8bd5\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u624b\u5199\u9ad8\u7cbe\u5ea6\n\n\u624b\u5199\u9ad8\u7cbe\u5ea6\u6d6e\u70b9\u6570\u5176\u5b9e\u5c31\u662f\u5148\u628a\u6574\u4e2a\u6570\u5de6\u79fb\u5f88\u591a\u4f4d\n\n\u7136\u540e\u8fdb\u884c\u6b63\u5e38\u7684\u52a0\u3001\u4e58\u3001\u9664\u7684\u64cd\u4f5c\n\n\u6700\u540e\u8981\u591a\u5c11\u4f4d\u518d\u56db\u820d\u4e94\u5165\u53d6\u5230\u591a\u5c11\u4f4d\u5373\u53ef\n## \u4ee3\u7801\n``` cpp\n#include<cstdio>\n#include<iostream>\n#include<algorithm>\n#include<cstring>\n#include<iomanip>\n#define rg register\nconst int maxn=105,maxm=8005,bas=2500,jz=10000000;\nint n,m,k,mmax;\nstruct asd{\n\tint num[10],len;\n\tasd(){\n\t\tmemset(num,0,sizeof(num));\n\t\tlen=0;\n\t}\n\tfriend asd operator +(const asd &A,const asd &B){\n\t\tasd C;\n\t\tC.len=std::max(A.len,B.len);\n\t\tfor(rg int i=0;i<C.len;i++){\n\t\t\tC.num[i]+=A.num[i]+B.num[i];\n\t\t\tif(C.num[i]>=jz){\n\t\t\t\tC.num[i]-=jz;\n\t\t\t\tC.num[i+1]+=1;\n\t\t\t}\n\t\t}\n\t\tif(C.num[C.len]) C.len++;\n\t\treturn C;\n\t}\n\tfriend asd operator *(const asd &A,const asd &B){\n\t\tasd C;\n\t\tfor(rg int i=0;i<B.len;i++){\n\t\t\tfor(rg int j=0;j<A.len;j++){\n\t\t\t\tC.num[i+j]+=B.num[i]*A.num[j];\n\t\t\t}\n\t\t}\n\t\tfor(rg int i=0;i<B.len;i++){\n\t\t\tfor(rg int j=0;j<A.len;j++){\n\t\t\t\tif(C.num[i+j]>=jz){\n\t\t\t\t\tC.num[i+j+1]+=C.num[i+j]/jz;\n\t\t\t\t\tC.num[i+j]%=jz;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tC.len=B.len+A.len;\n\t\twhile(C.num[C.len-1]==0 && C.len-1!=0) C.len--;\n\t\treturn C;\n\t}\t\t\n\tfriend asd operator /(const asd &A,const int B){\n\t\tasd C,D;\n\t\tD=A;\n\t\tfor(rg int i=D.len-1;i>=0;i--){\n\t\t\trg int haha=D.num[i]+D.num[i+1]*jz;\n\t\t\tC.num[i]=haha/B;\n\t\t\tD.num[i]=haha%B;\n\t\t\tD.num[i+1]=0;\n\t\t\tif(i==0 && D.num[i]>=B/2){\n\t\t\t\tC.num[i]++;\n\t\t\t}\n\t\t\tif(C.len==0 && C.num[i]){\n\t\t\t\tC.len=i+1;\n\t\t\t}\n\t\t}\n\t\twhile(C.num[C.len-1]==0 && C.len-1!=0) C.len--;\n\t\treturn C;\n\t}\n\tvoid read(int aa){\n\t\tlen=0;\n\t\twhile(aa){\n\t\t\tnum[len++]=aa%jz;\n\t\t\taa/=jz;\n\t\t}\n\t\twhile(num[len-1]==0 && len-1!=0) len--;\n\t}\n\tvoid write(int aa){\n\t\trg int pd=0;\n\t\tprintf(\"0.\");\n\t\tfor(rg int i=len-1;i>=0;i--){\n\t\t\tif(aa-7>=0){\n\t\t\t\tif(aa==7 && num[i-1]%1000000%10>=5) pd=1;\n\t\t\t\tprintf(\"%07d\",num[i]+pd);\n\t\t\t\taa-=7;\n\t\t\t} else {\n\t\t\t\tif(aa==1 && num[i]/100000%10>=5){\n\t\t\t\t\tpd=1;\n\t\t\t\t}\n\t\t\t\tif(aa){\n\t\t\t\t\tprintf(\"%01d\",num[i]/1000000%10+pd);\n\t\t\t\t\taa--;\n\t\t\t\t}\n\t\t\t\tif(aa==1 && num[i]/10000%10>=5){\n\t\t\t\t\tpd=1;\n\t\t\t\t}\n\t\t\t\tif(aa){\n\t\t\t\t\tprintf(\"%01d\",num[i]/100000%10+pd);\n\t\t\t\t\taa--;\n\t\t\t\t}\n\t\t\t\tif(aa==1 && num[i]/1000%10>=5){\n\t\t\t\t\tpd=1;\n\t\t\t\t}\n\t\t\t\tif(aa){\n\t\t\t\t\tprintf(\"%01d\",num[i]/10000%10+pd);\n\t\t\t\t\taa--;\n\t\t\t\t}\n\t\t\t\tif(aa==1 && num[i]/100%10>=5){\n\t\t\t\t\tpd=1;\n\t\t\t\t}\n\t\t\t\tif(aa){\n\t\t\t\t\tprintf(\"%01d\",num[i]/1000%10+pd);\n\t\t\t\t\taa--;\n\t\t\t\t}\n\t\t\t\tif(aa==1 && num[i]/10%10>=5){\n\t\t\t\t\tpd=1;\n\t\t\t\t}\n\t\t\t\tif(aa){\n\t\t\t\t\tprintf(\"%01d\",num[i]/100%10+pd);\n\t\t\t\t\taa--;\n\t\t\t\t}\n\t\t\t\tif(aa==1 && num[i]%10>=5){\n\t\t\t\t\tpd=1;\n\t\t\t\t}\n\t\t\t\tif(aa){\n\t\t\t\t\tprintf(\"%01d\",num[i]/10%10+pd);\n\t\t\t\t\taa--;\n\t\t\t\t}\n\t\t\t\tif(aa){\n\t\t\t\t\tprintf(\"%01d\",num[i]%10+pd);\n\t\t\t\t\taa--;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tprintf(\"\\n\");\n\t}\n}g[2][maxm][maxn/2][3];\nasd anss;\nvoid solve1(){\n\tmmax=n/2+1;\n\trg int now=1;\n\tg[0][bas][0][0].num[6]=1;\n\tg[0][bas][0][0].len=7;\n\tfor(rg int i=0;i<n;i++){\n\t\tnow^=1;\n\t\tfor(rg int j=0;j<maxm;j++){\n\t\t\tfor(rg int p=0;p<=mmax;p++){\n\t\t\t\tfor(rg int o=0;o<=2;o++){\n\t\t\t\t\tg[now^1][j][p][o].len=0;\n\t\t\t\t\tmemset(g[now^1][j][p][o].num,0,sizeof(g[now^1][j][p][i].num));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tasd haha;\n\t\tfor(rg int j=0;j<maxm;j++){\n\t\t\tfor(rg int p=0;p<=mmax;p++){\n\t\t\t\tfor(rg int o=0;o<=2;o++){\n\t\t\t\t\tif(g[now][j][p][o].len){\n\t\t\t\t\t\tif(j-2*i-2>=0){\n\t\t\t\t\t\t\thaha.read(p+1-o);\n\t\t\t\t\t\t\tg[now^1][j-2*i-2][p+1][o]=g[now^1][j-2*i-2][p+1][o]+g[now][j][p][o]*haha/(i+1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(o<2 && j-i-1>=0){\n\t\t\t\t\t\t\thaha.read(2-o);\n\t\t\t\t\t\t\tg[now^1][j-i-1][p+1][o+1]=g[now^1][j-i-1][p+1][o+1]+g[now][j][p][o]*haha/(i+1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\thaha.read(p*2-o);\n\t\t\t\t\t\tg[now^1][j][p][o]=g[now^1][j][p][o]+g[now][j][p][o]*haha/(i+1);\n\t\t\t\t\t\tif(p && j+2*i+2<maxm){\n\t\t\t\t\t\t\thaha.read(p-1);\n\t\t\t\t\t\t\tg[now^1][j+2*i+2][p-1][o]=g[now^1][j+2*i+2][p-1][o]+g[now][j][p][o]*haha/(i+1);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(o<2 && j+i+1<maxm){\n\t\t\t\t\t\t\thaha.read(2-o);\n\t\t\t\t\t\t\tg[now^1][j+i+1][p][o+1]=g[now^1][j+i+1][p][o+1]+g[now][j][p][o]*haha/(i+1);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(rg int j=bas+m;j<=bas+(n+1)*n/2;j++){\n\t\tanss=anss+g[now^1][j][1][2];\n\t}\n\tanss.write(k);\n}\ndouble f[2][maxm][maxn/2][3],ans;\nvoid solve2(){\n\tmmax=n/2+1;\n\trg int now=1;\n\tf[0][bas][0][0]=1.0;\n\tfor(rg int i=0;i<n;i++){\n\t\tnow^=1;\n\t\tfor(rg int j=0;j<maxm;j++){\n\t\t\tfor(rg int p=0;p<=mmax;p++){\n\t\t\t\tfor(rg int o=0;o<=2;o++){\n\t\t\t\t\tf[now^1][j][p][o]=0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(rg int j=0;j<maxm;j++){\n\t\t\tfor(rg int p=0;p<=mmax;p++){\n\t\t\t\tfor(rg int o=0;o<=2;o++){\n\t\t\t\t\tif(f[now][j][p][o]){\n\t\t\t\t\t\tif(j-2*i-2>=0) f[now^1][j-2*i-2][p+1][o]+=f[now][j][p][o]*(p+1-o)/(i+1);\n\t\t\t\t\t\tif(o<2 && j-i-1>=0) f[now^1][j-i-1][p+1][o+1]+=f[now][j][p][o]*(2-o)/(i+1);\n\t\t\t\t\t\tf[now^1][j][p][o]+=f[now][j][p][o]*(p*2-o)/(i+1);\n\t\t\t\t\t\tif(p && j+2*i+2<maxm)  f[now^1][j+2*i+2][p-1][o]+=f[now][j][p][o]*(p-1)/(i+1);\n\t\t\t\t\t\tif(o<2 && j+i+1<maxm) f[now^1][j+i+1][p][o+1]+=f[now][j][p][o]*(2-o)/(i+1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(rg int j=bas+m;j<=bas+(n+1)*n/2;j++){\n\t\tans+=f[now^1][j][1][2];\n\t}\n\tstd::cout<<std::fixed<<std::setprecision(k)<<ans<<std::endl;\n}\nint main(){\n\tstd::cin>>n>>m>>k;\n\tif(k<=8) solve2();\n\telse solve1();\n\treturn 0;\n}\n\n```",
        "postTime": 1605911377,
        "uid": 316322,
        "name": "hzoi_liuchang",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P2612 \u3010[ZJOI2012]\u6ce2\u6d6a\u3011"
    }
]
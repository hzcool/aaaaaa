[
    {
        "content": "# \u5199\u5728\u524d\u9762\n\n\u5b9e\u9645\u4e0a\u5df2\u8fd1\u5199\u8fc7\u4e00\u7bc7\u8fd9\u4e2a\u9898\u7684\u9898\u89e3\u4e86\uff0c\u8fd9\u6b21\u53ea\u662f\u7a0d\u4f5c\u4fee\u6539\uff0c\u538b\u7f29\u4e86\u4ee5\u524d\u53c8\u81ed\u53c8\u957f\u7684\u4ee3\u7801\uff0c\u987a\u4fbf\u518d\u8bf4\u660e\u4e00\u4e0b\u89e3\u9898\u601d\u8def\u3002\n\n\n\n## \u9047\u5230\u7684\u95ee\u9898\n\u4e00\u770b\u8fd9\u4e2a\u9898\u5c31\u77e5\u9053\u662f\u6a21\u62df\uff0c\u4f46\u662f\u600e\u4e48\u6a21\u62df\u5462\uff1f\n\n\u9996\u5148\uff0c\u8bfb\u5165\u4e0e\u5b58\u50a8\u95ee\u9898\uff0c\u5982\u4f55\u51c6\u786e\u7684\u8bfb\u5165\u4ee5\u53ca\u5982\u4f55\u5c06\u8f93\u5165\u7684\u4ee3\u7801\u5b58\u8d77\u6765\u3002\n\n\u5176\u6b21\uff0c\u4e5f\u662f\u6700\u96be\u7684\uff0c\u6a21\u62df\u7a0b\u5e8f\u8fd0\u884c\uff0c\u5176\u4e2d\u6700\u5173\u952e\u7684\u5c31\u662f\u5982\u4f55\u6a21\u62df\u5faa\u73af\u7684\u8fd0\u884c\u3002\n\n\u518d\u8005\uff0c\u8ba1\u7b97\u5668\u7684\u95ee\u9898\uff0c\u8d4b\u503c\u8bed\u53e5\u4e0e\u5faa\u73af\u6b21\u6570\u7684\u8ba1\u7b97\u3002\n\n\n\n## \u89e3\u51b3\u65b9\u6848\n1.\u8bfb\u5165\u4e0e\u5b58\u50a8\uff0c\u5f00\u4e00\u4e2a\u4e8c\u7ef4\u7684char\u6570\u7ec4\uff08string\u4e5f\u884c\uff0c\u4e2a\u4eba\u559c\u597d\uff09\uff0c\u4f7f\u7528scanf(\"%s\",s)\u8bfb\u5165\uff0c\u9047\u5230\u7a7a\u683c\u8df3\u8fc7\u3002\n\n2.\u8fd0\u884c\u8fc7\u7a0b\uff0c\u5176\u4ed6\u8bed\u53e5\u4e0d\u591a\u8bf4\uff0c\u5c31\u8bb2\u8bb2\u6700\u5173\u952e\u7684\u5faa\u73af\u8bed\u53e5\u5427\uff0c\u770b\u5230\u6709\u5f88\u591a\u5927\u4f6c\u90fd\u662f\u7528\u6808\u6765\u6a21\u62df\uff0c\u4e2a\u4eba\u4e0d\u592a\u4e60\u60ef\u7528\u6808\u6a21\u62df\uff0c\u4e8e\u662f\u7528\u4e86\u7c7b\u4f3c\u4e8e\u9012\u5f52\u7684\u65b9\u6cd5\uff0c\u4e00\u5c42\u5c42\u8fdb\u5165\uff0c\u518d\u9000\u51fa\u3002\n\n3.\u6709\u5173\u8ba1\u7b97\u5668\uff0c\u7531\u4e8e\u9898\u4e2d\u7ed9\u51fa\u4e86\u8bed\u53e5\u7684\u6267\u884c\u6b21\u6570\u7684\u603b\u548c\u5c0f\u4e8e2000000\u6b21\uff0c\u90a3\u4e48\u8ba1\u7b97\u5668\u5b8c\u5168\u53ef\u4ee5\u4f7f\u7528\u9012\u5f52\u4ee3\u66ff\u6808\u6765\u5199\uff0c\u5e76\u4e14\u5b8c\u5168\u4e0d\u7528\u62c5\u5fc3\u4f1a\u8d85\u65f6\u3002\n\n\n\n### \u6700\u540e\u9644\u4e0aAC\u4ee3\u7801\uff0c\u4ee3\u7801\u4e2d\u6709\u89e3\u91ca\n```c\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#include <string>\n#include <cmath>\n#include <algorithm>\n#define MAXN 1001\nusing namespace std;\n \n//\u51fd\u6570\u603b\u89c8\uff0c\u540e\u9762\u6709\u89e3\u91ca\nvoid read();\nvoid work();\nvoid find();\nvoid write(char x[]);\nint check(char x[]);\nvoid run(char x[]);\nvoid pre(char x[],int l,int r);\nint calc(char x[],int l,int r);\nvoid run_loo(char x[]);\nint run_fu(char x[],int in,int enk);\n \nchar str[MAXN][MAXN],s[MAXN];\nint tot=0,h=1,f[MAXN],ff[MAXN],sh[30];\nconst int sta=1,en=2,loo=3,con=4,wri=5,bre=6,fu=7;\n \n//\u8bfb\u5165\uff0c\u5904\u7406\u6389\u7a7a\u683c\nvoid read(){\n    while((scanf(\"%s\",s))!=EOF){\n        if(s[0]!=' '){\n            strcpy(str[++tot],s);\n        }\n    }\n}\n\n//\u8f93\u51fa\nvoid run_wri(char x[]){\n    ++h;\n    printf(\"%d\\n\",run_fu(str[h],0,strlen(str[h])-1));\n}\n\n//\u9884\u5904\u7406\uff0c\u627e\u5230\u5faa\u73af\u7684\u5f00\u59cb\u4e0e\u7ed3\u675f\nvoid find(){\n    int v[MAXN],v1=0;\n    for(int i=2;i<tot;i++){\n        if(check(str[i])==loo){\n            v1++;\n            v[v1]=i;\n        }else if(check(str[i])==en){\n            f[v[v1]]=i;\n            v1--;\n        }\n    }\n}\n\n//\u5faa\u73af\u8bed\u53e5\u7684\u9012\u5f52\u5b9e\u73b0\nvoid run_loo(char x[]){\n    ++h;\n    int t=run_fu(str[h],0,strlen(str[h])-1),tmp=h-1;\n    for(int i=1;i<=t;i++){\n        ++h;\n        while(check(str[h])!=en){\n            if(check(str[h])==loo){\n                run_loo(x);\n            }else if(check(str[h])==con){\n                break;\n            }else if(check(str[h])==bre){\n                h=f[tmp];\n                return;\n            }\n            run(str[h]);\n            ++h;\n        }\n        h=tmp+1;\n    }\n    h=f[tmp];\n}\n\n//\u6bcf\u6b21\u4f7f\u7528\u8ba1\u7b97\u5668\u4e4b\u524d\u7684\u9884\u5904\u7406\uff0c\u4e3a\u4e86\u5904\u7406\u8868\u8fbe\u5f0f\u4e2d\u6709\u62ec\u53f7\u5339\u914d\u7684\u60c5\u51b5\nvoid pre(char x[],int l,int r){\n    int v[MAXN],tot=0;\n    for(int i=l;i<=r;++i){\n        if(x[i]=='('){\n            v[++tot]=i;\n        }else if(x[i]==')'){\n            ff[v[tot]]=i;\n            --tot;\n        }\n    }\n}\n\n//\u9012\u5f52\u5b9e\u73b0\u7b80\u5355\u8ba1\u7b97\u5668\nint calc(char x[],int l,int r){\n    if(l==r&&x[l]>='a'&&x[l]<='z') return sh[x[l]-'a'];\n    if(x[l]=='('&&x[r]==')'&&ff[l]==r){\n        return calc(x,l+1,r-1);\n    }\n    int jia=0,cheng=0,isjia=0,ischeng=0,fa=0,isfa=0;\n    for(int i=l;i<=r;++i){\n        if(x[i]=='+') jia=i,isjia=1;\n        else if(x[i]=='*') cheng=i,ischeng=1;\n        else if(x[i]=='/') cheng=i,ischeng=0;\n        else if(x[i]=='-') jia=i,isjia=0;\n        else if(x[i]=='^') isfa=1,fa=i;\n        else if(x[i]=='(') i=ff[i]-1;\n    }\n    if(jia!=0){\n        if(isjia==1) return (calc(x,l,jia-1)+calc(x,jia+1,r));\n        else return (calc(x,l,jia-1)-calc(x,jia+1,r));\n    }else if(cheng!=0){\n        if(ischeng==1) return (calc(x,l,cheng-1)*calc(x,cheng+1,r));\n        else return (calc(x,l,cheng-1)/calc(x,cheng+1,r));\n    }else if(isfa!=0){\n        return (int)pow(calc(x,l,fa-1)*1.0,calc(x,fa+1,r)*1.0);\n    }else if(jia==0&&cheng==0&&isfa==0){\n        int tmp=0;\n        for(int i=l;i<=r;++i){\n            tmp=(tmp*10+(x[i]-'0'));\n        }\n        return tmp;\n    }\n}\n \n//\u8d4b\u503c\u8bed\u53e5\u7684\u8fd0\u884c\uff0c\u8c03\u7528calc()\u51fd\u6570\u8ba1\u7b97\nint run_fu(char x[],int in,int enk){\n    memset(ff,0,sizeof(ff));\n    pre(x,in,enk);\n    int res=calc(x,in,enk);\n    return res;\n}\n\n//\u5224\u65ad\u662f\u54ea\u4e00\u79cd\u8bed\u53e5\nint check(char x[]){\n    if(x[1]=='='){\n        return fu;\n    }else if(x[0]=='s'){\n        return sta;\n    }else if(x[0]=='e'&&x[1]=='n'){\n        return en;\n    }else if(x[0]=='l'&&x[1]=='o'){\n        return loo;\n    }else if(x[0]=='c'&&x[1]=='o'){\n        return con;\n    }else if(x[0]=='w'&&x[1]=='r'){\n        return wri;\n    }else if(x[0]=='b'&&x[1]=='r'){\n        return bre;\n    }else{\n        return -1;\n    }\n}\n \n//\u8fd0\u884c\u6bcf\u4e00\u53e5\u8bed\u53e5\nvoid run(char x[]){\n    int k=check(x);\n    switch(k){\n        case 3:run_loo(x); break;\n        case 5:run_wri(x); break;\n        case 7:sh[x[0]-'a']=run_fu(x,2,strlen(x)-1); break;\n        default:break;\n    }\n}\n \n//\u5faa\u73af\u6bcf\u4e00\u53e5\u8bed\u53e5\nvoid work(){\n    while(h<=tot){\n        run(str[h]);\n        ++h;\n    }\n}\n \nint main(){ \n    read();\n    find();\n    work();\n    return 0;\n}\n\n```\n\n\u6709\u95ee\u9898\u53ef\u5728\u8bc4\u8bba\u533a\u7559\u8a00\u54df\u3002(\u25cf'\u25e1'\u25cf)\u3002~~~~~~~",
        "postTime": 1532095013,
        "uid": 89038,
        "name": "Oxygen_L",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2229 \u3010[HNOI2002]\u6c99\u6f20\u5bfb\u5b9d\u3011"
    },
    {
        "content": "### [AC](https://www.luogu.org/record/show?rid=10100545)\n\n\u8fd9\u9053\u6a21\u62df\u9898\u53ef\u4ee5\u8bf4\u662f\u76f8\u5f53~~\u6bd2\u7624~~\u4ec1\u6148\u4e86\n\n\u8981\u662f\u8fd8\u6709\u8bed\u6cd5\u9519\u8bef\u7b49\u7b49\u4e71\u4e03\u516b\u7cdf\u7684\n\n\u90a3\u5c31\u9ed1\u9898\u65e0\u7591\u4e86\n\n\u6240\u4ee5\u62b1\u7740\u8fd9\u9053\u9898\u8fd8\u7b97\u7b80\u5355\u7684~~\u81ea\u6211\u5b89\u6170~~\u601d\u60f3\n\n\u6211\u4eec\u6765\u6162\u6162\u89e3\u5256\u8fd9\u9053\u7f8e\u5473\u7684\u7d2b\u9898\n\n# \u601d\u8def\u4e0e\u4ee3\u7801\n\n### \u8bfb\u5165\u4e0e\u9884\u5904\u7406 \n\n~~\u786e\u5b9e\u5f88\u7b80\u5355\u554a\u6709\u4ec0\u4e48\u597d\u8bf4\u7684~~\n\n\u6211\u4eec\u91c7\u7528**\u79bb\u7ebf\u8bfb\u5165,**~~\u778ejb~~**\u5c3d\u60c5\u6a21\u62df**\u7684\u65b9\u6cd5\n\n\u5148\u5b9a\u4e49\u4e00\u4e2a\u884c\u7ed3\u6784**Line**\n```cpp\nstruct Line{\n\tint type;//\u8bed\u53e5\u7c7b\u578b \n\tstring expre;//\u8bb0\u5f55\u4e0b\u8868\u8fbe\u5f0f \n\tint lef,pos;//lef \u8d4b\u503c\u8868\u8fbe\u5f0f\u7684\u5de6\u503c\uff0cpos \u5faa\u73af\u8bed\u53e5\u7684end\u7684\u4f4d\u7f6e \n}line[N];//1000\u884c \n```\n\u8bed\u53e5\u7c7b\u578b\uff1f\u4e0d\u662f\u95ee\u9898\uff1a\n```cpp\nconst int START=1,END=2,LOOP=3,CONTINUE=4,BREAK=5,WRITE=6,EQUAL=7;\n\n```\n**~~\u7b80\u5355\u7c97\u66b4~~**\n\n\u8bfb\u5165\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e4b\u540e,\u8981\u5224\u65ad\u5b83\u662f\u4ec0\u4e48\u7c7b\u578b\n\n\u5bf9\u4e8ec\u98ce\u683c\u5b57\u7b26\u4e32\u6211\u4eec\u53ef\u4ee5\u7528\u5b57\u7b26\u4e32\u6bd4\u8f83\u51fd\u6570**strcmp**\n\n\u5bf9\u4e8estring...~~string\u662f\u4e0d\u53ef\u80fdstring\u7684,\u8fd9\u8f88\u5b50\u90fd\u4e0d\u53ef\u80fdstring\u7684~~\n\n\u6211\u8fd9\u91cc\u51fa\u4e8e~~\u61d2~~\u65f6\u95f4\u8003\u8651,\u7528**\u524d\u4e24\u4e2a\u5b57\u7b26**\u6765\u8bc6\u522b\n\n\u5148\u6839\u636e\u7b2c\u4e8c\u4e2a\u5b57\u7b26\u6765\u8fa8\u522b\u8d4b\u503c\u8bed\u53e5,\u518d\u6839\u636e\u7b2c\u4e00\u4e2a\u5b57\u7b26\u6765\u5206\u8fa8write,break\u7b49\u6df7\u6dc6\u7684\u8bed\u53e5\uff1a\n\n```cpp\nchar tem[83] \nint cnt=0;\nstack<int> cir;\nwhile(scanf(\"%s\",tem)!=EOF){\n     switch(tem[1]){\n        case 't'://start\n        case 'n'://end\n        case 'o':\n            switch(tem[0]){\n                case 'l'://loop\n                case 'c'://continue\n           }\n        case 'r':\n            switch(tem[0]){\n               case 'w'://write\n               case 'b'://break\n           }\n        case '='://\u8d4b\u503c\n      }\n}\n\n```\n\ncir\u6808\u8bb0\u5f55\u6bcf\u4e2a\u5faa\u73af(circulate)\u7684**loop\u4f4d\u7f6e**\n\n\u8bc6\u522b\u51fa\u4e86\u6bcf\u79cd\u7c7b\u578b\u540e\u5c31\u5b58\u5728\u8be5\u884c\u7684type\u91cc\n\n\u5bf9\u4e8e\u4e00\u4e9b**\u7279\u6b8a\u7684\u7c7b\u578b**(loop,end,\u8d4b\u503c)\u7684\u9884\u5904\u7406\uff1a\n\n**loop,end:\u9047\u5230loop\u65f6\u884c\u6570cnt\u5165\u6808,\u9047\u5230\u5bf9\u5e94\u7684end\u65f6\u51fa\u6808\u5e76\u7528end\u884c\u7684\u884c\u6570cnt\u521d\u59cb\u5316loop\u884c\u7684pos(\u4e0a\u4e0a\u65b9\u4ee3\u7801\u89e3\u91capos)**\n\n**\u8d4b\u503c:**\u5b58\u7740**\u5de6\u503c(lef)\u53f3\u503c(expre)**\u5c31\u884c\u4e86(\u7b49\u53f7\u5de6\u53f3\u4e24\u8fb9\u7684\u503c),\u53f3\u503c\u5148\u5b58\u7740\u8868\u8fbe\u5f0f\n\n\u5176\u4ed6\u7684\u6709\u8868\u8fbe\u5f0f\u5c31\u8bfb\u5165\u8868\u8fbe\u5f0f\u518d\u5b58\u7740\n\n\u9884\u5904\u7406\u4ee3\u7801:\n```cpp\nswitch(tem[1]){\n                case 't':cir.push(cnt);line[cnt++].type=START;break;\n                case 'n':line[cir.top()].pos=cnt;cir.pop();line[cnt++].type=END;break;\n                case 'o':\n                    switch(tem[0]){\n                        case 'l':cir.push(cnt);scanf(\"%s\",tem);line[cnt++]=(Line){LOOP,tem};break;\n                        case 'c':line[cnt++].type=CONTINUE;break;\n                    }\n                    break;\n                case 'r':\n                    switch(tem[0]){\n                        case 'w':scanf(\"%s\",tem);line[cnt++]=(Line){WRITE,tem};break;\n                        case 'b':line[cnt++].type=BREAK;break;\n                    }\n                    break;\n                case '=':line[cnt++]=(Line){EQUAL,tem+2,tem[0]-'a'};break;\n            }\n```\n\n\u597d,\u73b0\u5728\u5f00\u59cb\u5c3d\u60c5\u6a21\u62df\n\ni\u8868\u793a\u884c\u6570,end\u65f6\u5229\u7528\u4e00\u4e2a\u7279\u6b8a\u60c5\u51b5\u8d70\u51fa\u7a0b\u5e8f\n\nloop\u8fd8\u662f\u4e00\u6837\u7528\u6808\u6a21\u62df\n\n\u4e0d\u8fc7\u9700\u8981\u50a8\u5b58\u7684\u4fe1\u606f\u591a\u4e86\u90a3\u4e48\u4e00\u4e22\u4e22\n1. \u5f00\u59cb\u4f4d\u7f6e\n2. \u5df2\u5faa\u73af\u6b21\u6570\n3. \u4e0a\u9650\n\n```cpp\n\nstruct Loop{//\u8bb0\u5f55\u6bcf\u5c42\u5faa\u73af\u7684\u4fe1\u606f \n\tint pos,cnt,end;\n//\tpos loop\u7684\u4f4d\u7f6e\n//  cnt \u8bb0\u5f55\u6b21\u6570 0\u5230end-1 \n//  end \u8bb0\u5f55\u8868\u8fbe\u5f0f\u7684\u503c \n};\n```\n\n\u8fd8\u662f\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n**loop:\u8ba1\u7b97\u51fa\u4e0a\u9650,\u5faa\u73af\u6b21\u6570\u521d\u59cb\u5316\u4e3a0,\u4e22\u5230\u6808\u91cc\u53bb\u5c31\u597d\u4e86**\n\n**break: \u53d6\u51fa\u6808\u9876\u5143\u7d20\u5e76\u5f39\u51fa\u5f97\u5230\u5faa\u73af\u5f00\u59cb\u884c,\u9884\u5904\u7406\u65f6\u53c8\u5728\u5f00\u59cb\u884c\u5b58\u4e86\u6bcf\u4e00\u4e2aloop\u7684end\u4f4d\u7f6e,\u76f4\u63a5\u628ai\u8d70\u5230end\u4e0b\u4e00\u884c**\n\n**continue:\u540c\u4e0a\u627e\u5230end\u4f4d\u7f6e\u76f4\u63a5\u8d70\u5230end**\n\n**end:\u6b21\u6570\u9012\u589e,\u5e76\u5224\u65ad\u662f\u5426\u7ee7\u7eed\u5faa\u73af,\u5426\u5219\u51fa\u6808\n\u82e5\u78b0\u5230end\u65f6\u6808\u4e3a\u7a7a,\u8bf4\u660e\u8d70\u5230\u7ed3\u5c3e(\u56e0\u4e3astart\u672a\u5165\u6808),\u7a0b\u5e8f\u7ed3\u675f**\n\n\u5269\u4e0b\u7684\u6ca1\u6709\u4ec0\u4e48\u6280\u5de7\u4e86,\u5199\u4e2a\u8ba1\u7b97\u5668\u5c31\u884c\u4e86\n\n\u6a21\u62df\u4ee3\u7801:\n\n```cpp\nwhile(1){\n    if(line[i].type==EQUAL){\n        name[line[i].lef]=calculater(line[i].expre);\n        i++;\n    }\n    else if(line[i].type==WRITE){\n        printf(\"%d\\n\",calculater(line[i].expre));\n        i++;\n    }\n    else if(line[i].type==LOOP){\n        cir.push((Loop){i,0,calculater(line[i].expre)});\n        i++;\n    }\n    else if(line[i].type==BREAK){\n        i=line[cir.top().pos].pos+1;\n        cir.pop();\n    }\n    else if(line[i].type==END){\n        if(cir.empty())break;\n        int &tem=cir.top().cnt;\n        tem++;\n        if(tem<cir.top().end){\n            i=cir.top().pos+1;\n        }\n        else {\n            cir.pop();\n            i++;\n        }\n    }\n    else if(line[i].type==START){\n        i++;\n    }\n    else if(line[i].type==CONTINUE){\n        i=line[cir.top().pos].pos;\n    }\n}\n```\n\n#### \u6ce8\u91ca\u7248\u5b8c\u6574\u4ee3\u7801\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<cstdio>\n#include<stack>\n#include<string>\n#define judge(a) (a=='*'||a=='/')\nusing namespace std;\nconst int N=1000;\nconst int START=1,END=2,LOOP=3,CONTINUE=4,BREAK=5,WRITE=6,EQUAL=7;\nstruct Line{\n\tint type;//\u8bed\u53e5\u7c7b\u578b \n\tstring expre;//\u8bb0\u5f55\u4e0b\u8868\u8fbe\u5f0f \n\tint lef,pos;//lef \u8d4b\u503c\u8868\u8fbe\u5f0f\u7684\u5de6\u503c\uff0cpos \u5faa\u73af\u8bed\u53e5\u7684end\u7684\u4f4d\u7f6e \n}line[N];//1000\u884c \nint name[27];//\u8bb0\u5f55\u6bcf\u4e2a\u53d8\u91cf\u7684\u503c \n//-----------------------\u8ba1\u7b97\u5668--------------------------------------- \nstack<int> sta_num;//\u8ba1\u7b97\u5668\u7684\u64cd\u4f5c\u6570\u6808 \nstack<char> sta_ope;//\u8ba1\u7b97\u5668\u7684\u64cd\u4f5c\u7b26\u6808 \ninline void calc(const char &ch){//const xxx& \u4f20\u9012\u4e0d\u80fd\u4fee\u6539\u7684\u5f15\u7528,\u5927\u5927\u52a0\u5feb\u4f20\u53c2\u901f\u5ea6 \n\tint a=sta_num.top();sta_num.pop();//\u53d6\u6808\u9876a,b \n\tint b=sta_num.top();sta_num.pop();\n\tswitch(ch){\n\t\tcase '+':b+=a;break;\n\t\tcase '-':b-=a;break;\n\t\tcase '*':b*=a;break;\n\t\tcase '/':b/=a;break;\n\t}\n\tsta_num.push(b);\n}\n\ninline bool Serious_smaller(const char& a,const char& b){\n\treturn (a=='(')?1:(judge(a))?0:judge(b);//judge\u5224\u65ad\u662f\u5426\u662f\u4e58\u9664 \n\t/*\n\tif(a=='(')return true;//'('\u4e00\u5b9a\u6700\u5c0f \n\telse if(judge(a))return false;//\u4e58\u9664\u4e00\u5b9a\u6700\u5927 \n\telse if(judge(b))return true;//a\u4e3a\u52a0\u51cf,\u770bb\u662f\u5426\u4e3a\u4e58\u9664 \n\telse return false;\n\t*/\n}\n\ninline int calculater(const string &str){//\u8ba1\u7b97\u5668\u4e3b\u4f53 \n\tint n=str.length();\n\twhile(!sta_num.empty())sta_num.pop();//\u64cd\u4f5c\u6570\u6e05\u7a7a(\u64cd\u4f5c\u7b26\u4e0d\u7528\u56e0\u4e3a\u7ed3\u5c3e\u5df2\u6e05\u7a7a) \n\tfor(int i=0;i<n;++i){\n\t\tif(isdigit(str[i])){//\u78b0\u5230\u6570\u5b57 \n\t\t\tint num=str[i++]-'0';\n\t\t\twhile(isdigit(str[i]))//\u53d6\u6570\u5b57 \n\t\t\t\tnum=num*10+str[i++]-'0';\n\t\t\ti--;\n\t\t\tsta_num.push(num);\n\t\t}\n\t\telse if(islower(str[i])){//\u78b0\u5230\u53d8\u91cf \n\t\t\tsta_num.push(name[str[i]-'a']);//\u76f4\u63a5\u4ee3\u5165 \n\t\t}\n\t\telse{\n            if(str[i]=='('){//\u78b0\u5230\u5de6\u62ec\u53f7 \n                sta_ope.push(str[i]);//\u76f4\u63a5\u5165\u6808 \n            }\n\t\t\telse if(str[i]==')'){//\u78b0\u5230\u53f3\u62ec\u53f7 \n\t\t\t\twhile((!sta_ope.empty())&&sta_ope.top()!='('){//\u4e0d\u65ad\u53d6\u51fa\u76f4\u5230\u78b0\u5230\u5de6\u62ec\u53f7 \n\t\t\t\t\tcalc(sta_ope.top());//\u8ba1\u7b97 \n\t\t\t\t\tsta_ope.pop();//\u5f39\u51fa \n\t\t\t\t}\n\t\t\t\tif(sta_ope.top()=='(')sta_ope.pop();//\u5f39\u51fa\u5de6\u62ec\u53f7 \n\t\t\t}\n\t\t\telse{\n\t\t\t\twhile((!sta_ope.empty())&&!Serious_smaller(sta_ope.top(),str[i])){//\u4e0d\u65ad\u53d6\u51fa\u76f4\u5230\u78b0\u5230\u66f4\u4f4e\u4f18\u5148\u7ea7\n\t\t\t\t\tcalc(sta_ope.top());//\u8ba1\u7b97 \n\t\t\t\t\tsta_ope.pop();//\u5f39\u51fa \n\t\t\t\t}\n\t\t\t\tsta_ope.push(str[i]);//\u5165\u6808 \n\t\t\t}\n\t\t}\n\t}\n\twhile(!sta_ope.empty()){//\u64cd\u4f5c\u7b26\u6e05\u7a7a \n\t\tcalc(sta_ope.top()); //... \n\t\tsta_ope.pop();\n\t}\n\treturn sta_num.top();//\u5269\u4e0b\u5373\u7b54\u6848 \n}\n//-------------------------------\u8ba1\u7b97\u5668\u677f\u5b50------------------------------- \nstruct Loop{//\u8bb0\u5f55\u6bcf\u5c42\u5faa\u73af\u7684\u4fe1\u606f \n\tint pos,cnt,end;\n//\tpos loop\u7684\u4f4d\u7f6e\n//  cnt \u8bb0\u5f55\u6b21\u6570 0\u5230end-1 \n//  end \u8bb0\u5f55\u8868\u8fbe\u5f0f\u7684\u503c \n};\nchar tem[83];//scanf\u8f93\u5165\u6bcf\u4e00\u884c \nint cnt;\nint main(){\n\t{//\u4f7f\u62ec\u53f7\u5185\u58f0\u660e\u7684\u53d8\u91cf\u4e3a\u81ea\u52a8\u50a8\u5b58\u7c7b\u522b,\u51fa\u5757\u9500\u6bc1,\u56e0\u4e3a\u540e\u9762\u8fd8\u6709\u4e00\u4e2acir\u61d2\u5f97\u60f3\u540d\u5b57 \n\t\tstack<int> cir;//cir \u5b58\u5165\u6bcf\u4e2a\u5faa\u73af\u5f00\u59cb\u7684\u4f4d\u7f6e \n\t\twhile(scanf(\"%s\",tem)!=EOF){//\u521d\u6b65\u7f16\u8bd1 \n\t\t\tswitch(tem[1]){//\u7b2c\u4e8c\u4e2a\u5b57\u7b26\u5206\u7c7b\u8ba8\u8bba,switch-case\u7531\u8df3\u8dc3\u8868\u5b9e\u73b0\u6bd4if-else\u5feb \n\t\t\t\tcase 't':cir.push(cnt);line[cnt++].type=START; break;//start\u8bed\u53e5 \n//\t\t\t\t\t\t\t\u63a8\u5165\u5faa\u73af\u6808           \n\t\t\t\tcase 'n':line[cir.top()].pos=cnt;cir.pop(); line[cnt++].type=END; break;//end\u8bed\u53e5 \n//\t\t\t\t\t\u5f53\u524d\u5faa\u73af\u5f00\u59cb\u6240\u5728\u884c\u6570 \u8bb0\u5f55\u5bf9\u5e94\u7684end\u6240\u5728\u884c\u6570 \n\t\t\t\tcase 'o'://loop\u6216continue \n\t\t\t\t\tswitch(tem[0]){//\u7b2c\u4e00\u4e2a\u5b57\u7b26\u5206\u7c7b\u8ba8\u8bba \n\t\t\t\t\t\tcase 'l':cir.push(cnt); scanf(\"%s\",tem); line[cnt++]=(Line){LOOP,tem}; break;//loop\u8bed\u53e5 \n//\t\t\t\t\t\t\t\t\u63a8\u5165\u5faa\u73af\u6808\t  \t   \u8bfb\u5165\u8868\u8fbe\u5f0f   \t\t\t\t\t\u7c7b\u578b \u8868\u8fbe\u5f0f(char[] \u81ea\u52a8\u8f6c\u5316\u4e3a string)\t\n\t\t\t\t\t\tcase 'c':line[cnt++].type=CONTINUE;break;//continue\u8bed\u53e5\n//\t\t\t\t\t\t\t\t\u5b58\u5c31\u662f\u4e86 \n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'r'://write\u6216break \n\t\t\t\t\tswitch(tem[0]){\n\t\t\t\t\t\tcase 'w':scanf(\"%s\",tem);line[cnt++]=(Line){WRITE,tem};break;//write\u8bed\u53e5\n//\t\t\t\t\t\t      \t\u8bfb\u5165\u540e\u9762\u7684\u8868\u8fbe\u5f0f \t  \t\t\t\t\u7c7b\u578b  \u8868\u8fbe\u5f0f(char[] \u81ea\u52a8\u8f6c\u5316\u4e3a string)\n\t\t\t\t\t\tcase 'b':line[cnt++].type=BREAK;break;//break\u8bed\u53e5\n//\t\t\t\t\t\t\t\t\u5b58\u5c31\u662f\u4e86 \n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase '=':line[cnt++]=(Line){EQUAL,tem+2,tem[0]-'a'};break;//\u8d4b\u503c\u8bed\u53e5\n//\t\t\t\t\t\t\t\t\t\t\t\u7c7b\u578b  \u53f3\u503c  \u5de6\u503c \n\t\t\t}\n\t\t}\n\t}\n\tstack<Loop> cir;//\u8bb0\u5f55\u5faa\u73af \n\twhile(!cir.empty())cir.pop();//\u6e05\u7a7a \n\tint i=0;\n\twhile(1){\n\t\tif(line[i].type==EQUAL){//\u8d4b\u503c\u8bed\u53e5 \n\t\t\tname[line[i].lef]=calculater(line[i].expre);\n//\t\t\t\t\u5de6\u503c\t\t\t\u8ba1\u7b97\u8868\u8fbe\u5f0f(\u53f3\u503c) \n\t\t\ti++;\n\t\t}\n\t\telse if(line[i].type==WRITE){//write\u8bed\u53e5 \n\t\t\tprintf(\"%d\\n\",calculater(line[i].expre));\n//\t\t\t\t\t\t\t\u8ba1\u7b97\u8868\u8fbe\u5f0f \n\t\t\ti++;\n\t\t}\n\t\telse if(line[i].type==LOOP){//loop\u8bed\u53e5 \n\t\t\tcir.push((Loop){i,0,calculater(line[i].expre)});\n//\t\t\t\t\u63a8\u5165\u5faa\u73af\u6808 \u8d77\u70b9,\u5df2\u5faa\u73af\u6b21\u6570,\u5e94\u5faa\u73af\u6b21\u6570 \n\t\t\ti++;\n\t\t}\n\t\telse if(line[i].type==BREAK){//break\u8bed\u53e5 \n\t\t\ti=line[cir.top().pos].pos+1;\n//\t\t\t\u76f4\u63a5\u5c06i\u79fb\u81f3\u5faa\u73af\u672b\u7684\u540e\u4e00\u884c \u4e24\u4e2apos\u610f\u4e49\u521a\u597d\u76f8\u5bf9 \n//  \t\t\tline[\u5f53\u524d\u5faa\u73af.loop\u4f4d\u7f6e].end\u4f4d\u7f6e+1 \n\t\t\tcir.pop();\n\t\t}\n\t\telse if(line[i].type==END){//end\u8bed\u53e5 \n\t\t\tif(cir.empty())break;//\u7531\u4e8estart\u4e0d\u7b97\u4f5c\u5faa\u73af\u6700\u540e\u4e00\u4e2aend\u6ca1\u6709\u5bf9\u5e94\u7684loop,\u53ef\u4f9d\u6b64\u5224\u65ad\u7a0b\u5e8f\u7ed3\u675f \n\t\t\tint &tem=cir.top().cnt;//\u5f15\u7528\u5f53\u524d\u5faa\u73af\u5df2\u5faa\u73af\u6b21\u6570 \n\t\t\ttem++;//\u6b21\u6570++ \n\t\t\tif(tem<cir.top().end){//\u6ee1\u8db3\u5faa\u73af\u6761\u4ef6 \n\t\t\t\ti=cir.top().pos+1;//i\u79fb\u81f3loop\u4f4d\u7f6e\u7684\u4e0b\u4e00\u884c \n\t\t\t}\n\t\t\telse {\n\t\t\t\tcir.pop();//\u8d70\u51fa\u5faa\u73af \n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\t\telse if(line[i].type==START){\n\t\t\ti++;\n\t\t}\n\t\telse if(line[i].type==CONTINUE){//continue\u8bed\u53e5 \n\t\t\ti=line[cir.top().pos].pos;\n//\t\t\t\u76f4\u63a5\u8d70\u5230end\u5c31\u884c\n//\t\ti\u79fb\u81f3 line[\u5f53\u524d\u5faa\u73af.loop\u4f4d\u7f6e].end\u4f4d\u7f6e \n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n~~\u5570\u91cc\u516b\u55e6~~",
        "postTime": 1535030634,
        "uid": 106642,
        "name": "Ajsoabk",
        "ccfLevel": 0,
        "title": "[HNOI2002]\u6c99\u6f20\u5bfb\u5b9d"
    },
    {
        "content": "\u603b\u4f53\u6765\u8bf4\u8fd9\u9053\u9898\u4e0d\u7b97\u975e\u5e38\u96be\uff0c\u4e3b\u8981\u662f\u8bfb\u9898\u8981\u4ed4\u7ec6\u6bd4\u5982write\u662f\u8f93\u51fa\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u4e0d\u662f\u4e00\u4e2a\u53d8\u91cf~~~~\u5f53\u65f6\u6211\u5c31\u770b\u6210\u4e86\u8f93\u4e00\u4e2a\u53d8\u91cf\u8fd8\u597d\u6709\u5927\u4f6c\u53ca\u65f6\u63d0\u9192~~\uff0c\u8fd8\u6709\u6570\u636e\u6bd4\u8f83\u5751\uff0c\u7ec6\u5fc3\u70b9\u6162\u6162\u8c03\u4f1aAC\uff08~~wa~~\uff09\u7684\uff0c~~\u6211\u4e5f\u5c31\u8c03\u4e86\u4e00\u4e2a\u4e0b\u5348~~\n\n```cpp\n#incldue <bits/stdc++.h>\n#define maxn 1000\nusing namespace std;\n//\u53d8\u91cf\u8bf4\u660e\nstring code[maxn];\t//string \u5b58\u4ee3\u7801\nint tot;\t\t\t//\u4ee3\u7801\u957f\u5ea6 \nint ii;\t\t\t\t//\u4ee3\u7801\u8fd0\u884c\u5230\u54ea\u91cc\u4e86 \nlong long bl[100];stack<long long>number;stack<char>fh;//\u8ba1\u7b97\u5668 \n\nint check(int i){//\u68c0\u67e5\u8bed\u53e5\u662f\u54ea\u4e00\u79cd\n    if(code[i][1]=='=')\t\t\t\treturn 1;//\u8d4b\u503c\u8bed\u53e5\n    else if(code[i]==\"loop\") \t\treturn 2;//\u5faa\u73af\n    else if(code[i]==\"write\") \t\treturn 3;//\u8f93\u51fa\n    else if(code[i]==\"end\")\t\t\treturn 4;//\u7ed3\u675f\n    else if(code[i]==\"continue\")\treturn 5;//\u8df3\u8fc7\n    else if(code[i]==\"break\")\t\treturn 6;//\u8df3\u51fa\n    else return 0;\n}\n\nvoid jisuan(){\n    char s=fh.top();\n    long long b=number.top();number.pop();\n    long long a=number.top(); \tnumber.pop();\n    switch(s){\n        case '*':\tnumber.push(a*b);break;\n        case '/':\tnumber.push(a/b);break;\n        case '+':\tnumber.push(a+b);break;\n        case '-':\tnumber.push(a-b);break;\n    }\n}\n\nlong long calc(int step){//\u8ba1\u7b97\u8868\u8fbe\u5f0f\uff0c\u5e38\u89c4\u64cd\u4f5c\n\tnumber.clear();\t\n    for(int i=2;i<(int)code[step].size();i++){//\u4ece2\u5f00\u59cb\u8df3\u8fc7\u53d8\u91cf\u4e0e\u7b49\u4e8e\u53f7\n        if(isdigit(code[step][i])){\n            int x=0;\n            while(isdigit(code[step][i]))\tx=x*10+code[step][i]-48,i++;\t\n            i--;\n            number.push(x);continue;\n        }\n        else if(code[step][i]>='a'&&code[step][i]<='z'){\n            number.push(bl[code[step][i]-'a']);\n        }\n        else{\n            if(!fh.size())fh.push(code[step][i]);\n            else if(code[step][i]=='(')fh.push(code[step][i]);\n            else if(code[step][i]==')'){\n                while(fh.top()!='(')jisuan(),fh.pop();\n                fh.pop();\n            }\n            else if(code[step][i]=='*'||code[step][i]=='/'){\n            //\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u91ccwhile\u91cc\u7684\u6761\u4ef6\u5fc5\u987b\u662ffh.size\uff08\uff09\u5728\u524d\n          //\u8fd9\u6837\u5f53\u6808\u4e3a\u7a7a\u65f6\uff0c\u5c31\u4e0d\u4f1a\u8dd1\u540e\u9762\u7684\u6761\u4ef6\u76f4\u63a5\u9000\u51fa\uff0c\u4e0b\u9762\u7684\u4e5f\u4e00\u6837\n          //\u6211\u5199\u7684\u65f6\u5019\u5c31\u56e0\u4e3a\u8fd9\u4e2a\u9519\u4e86\u597d\u51e0\u904d\u8fd8\u4e00\u76f4\u6000\u7591\u6d1b\u8c37\n                while(fh.size()&&fh.top()!='+'&&fh.top()!='-'&&fh.top()!='(')\n                    jisuan(),fh.pop();\n                fh.push(code[step][i]);\n            }\n            else if(code[step][i]=='+'||code[step][i]=='-'){\n                while(fh.size()&&fh.top()!='(')\tjisuan(),fh.pop();\n                fh.push(code[step][i]);\n            }\n                \n        }\n    }\n    while(fh.size())\tjisuan(),fh.pop();\n    return number.top();\n}\n\nint find1(int step){\n    int v=1,i=step+1;\n    while(1){\n        if(code[i]==\"loop\")v++;\n        else if(code[i]==\"end\")\tv--;\n        if(v==0)\treturn i;\n        i++;\n    }\n}\nint Loop(int step){//\u5bf9\u4e8e\u5d4c\u5957\u5faa\u73af\uff0c\u8fd9\u91cc\u53ef\u4ee5\u7528\u9012\u5f52\u5904\u7406\n    int k=find1(step),x=0,j=0;//k\u662f\u548c\u5f53\u524dloop\u5339\u914d\u7684end\u7684\u4f4d\u7f6e\uff0cx\u662f\u5faa\u73af\u6b21\u6570\n    while(j<(int)code[step].size()&&isdigit(code[step+1][j]))\n    x=x*10+code[step+1][j]-48,j++;\t\n    for(int t=1;t<=x;t++){\n        for(int i=step+2;i<=k;i++){\n            int kk=check(i);\n            if(kk==1)    bl[code[i][0]-'a']=calc(i);\n            else if(kk==2)\ti=Loop(i);\n            else if(kk==3)\tprintf(\"%lld\\n\",calc(++i));//\u5d4c\u5957\u5faa\u73af\uff0c\u9012\u5f52\n            else if(kk==4||kk==5)\tbreak;//\u6a21\u62dfcontinue\u548cend\n            else if(kk==6)return k;//\u5982\u679c\u662fbreak\u76f4\u63a5\u8df3\u51fa\uff0c\u4e0d\u7528\u518d\u5faa\u73af\u4e86\n        }\n    }\n    return k;//\u9012\u5f52\u65f6\u5f53\u5904\u7406\u5b8c\u8fd9\u4e00\u5c42\u7684\u5faa\u73af\uff0c\u4e0a\u4e00\u5c42\u7684\u5faa\u73af\u7684\u7684i\u8981\u8df3\u5230\u8fd9\u4e00\u5c42\u5faa\u73af\u7684end\uff0c\u4e5f\u5c31\u662fk\u51fa\n}\n\nvoid work(){\n    for(ii=2;ii<tot;ii++){//\u603b\u7684\u4ee3\u7801\u8fdb\u5ea6\n        int k=check(ii);//\u68c0\u67e5\u662f\u90a3\u79cd\u8bed\u53e5\n        if(k==1){    bl[code[ii][0]-'a']=calc(ii);\t\n        else if(k==2)   ii=Loop(ii);\t//\u5faa\u73af\n        else if(k==3)\tprintf(\"%lld\\n\",calc(++ii));\n        else continue;\n    }\n}\n\nint main(){\n    int flage=0;\n//\u8bfb\u5165\u8fd9\u4e48\u5199\u662f\u56e0\u4e3a\uff0cwrite\u8f93\u51fa\u7684\u4e0d\u662f\u4e00\u4e2a\u53d8\u91cf\u800c\u662f\u4e00\u4e2a\u8868\u8fbe\u5f0f\u4e3a\u4e86\u8fd0\u7528calac\u51fd\u6570\uff08\u8fd9\u4e2a\u51fd\u6570\u662f\u7528\u6765\u8ba1\u7b97\u8d4b\u503c\u8bed\u53e5\u7684\uff0c\n//\u800c\u8d4b\u503c\u8bed\u53e5\u8981\u4ece\u7b49\u53f7\u540e\u7b97\u4e5f\u5c31\u662fcode[i][2]\u7b97\u8d77\uff09\u5c31\u5f97\u5728write\u540e\u7684\u8868\u8fbe\u5f0f\u524d\u52a0\u4e0a\u4e24\u4e2a\u5b57\u7b26,\u7701\u5f97\u518d\u5199\u4e00\u4e2a\u51fd\u6570\n    while(cin>>code[++tot]){\n        if(flage==1)   code[tot]=\"A=\"+code[tot],flage=0;\n        else if(code[tot]==\"write\")\tflage=1;//\u8bfb\u5230write\uff0c\u7528flage\u6807\u8bb0\n    }\n    work(); \n    return 0;\n}\n\n```",
        "postTime": 1535024336,
        "uid": 91499,
        "name": "linz",
        "ccfLevel": 0,
        "title": "P2229 [HNOI2002]\u6c99\u6f20\u5bfb\u5b9d"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u9053\u5927\u6a21\u62df\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4f7f\u7528 `cin` \u8bfb\u5165\u5b57\u7b26\u4e32\uff0c\u4f1a\u81ea\u52a8\u8fc7\u6ee4\u7a7a\u683c\u3002\n\n\u6267\u884c\u65f6\u76f4\u63a5\u5224\u65ad\u547d\u4ee4\u7c7b\u578b\uff0c\u5982\u679c\u9047\u5230 `loop` \u5c31\u5faa\u73af\u9012\u5f52\u4e0b\u53bb\uff0c\u5176\u4ed6\u7c7b\u578b\u7684\u5904\u7406\u8be6\u89c1\u4ee3\u7801\u3002\n\n`loop`\u3001`write` \u548c\u8d4b\u503c\u8bed\u53e5\u7684\u7b49\u53f7\u540e\u90fd\u4f1a\u63a5\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u624b\u5199\u4e00\u4e2a\u8ba1\u7b97\u5668\u5c31\u884c\u4e86\u3002\n\n\u81f3\u4e8e\u8ba1\u7b97\u4e2d\u5f15\u5165\u53d8\u91cf\uff0c\u53ef\u4ee5\u5f00\u4e00\u4e2a\u6570\u7ec4\u5b58\u50a8\u5f53\u524d\u6bcf\u4e2a\u53d8\u91cf\u7684\u503c\uff0c\u9047\u5230\u8d4b\u503c\u8bed\u53e5\u5219\u53d8\u66f4\uff0c\u8ba1\u7b97\u65f6\u76f4\u63a5\u5957\u7528\u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint p=-1,a[26];//\u628a\u5f53\u524d\u6bcf\u4e2a\u53d8\u91cf\u7684\u503c\u5206\u522b\u50a8\u5b58\u8d77\u6765 \nstring s[2000000];\n//\u8ba1\u7b97\u5668\u90e8\u5206 \u2193\nint zc;\nstack<int>num,fh;\nint zj(char ch){\n\tif(ch=='+')return 1;\n\tif(ch=='-')return 2;\n\tif(ch=='*')return 4;\n\tif(ch=='/')return 5;\n\tif(ch=='(')return -1;\n\tif(ch==')')return -2;\n}\nvoid zh(int t){\n\twhile(!fh.empty()){\n\t\tif(fh.top()==-1){\n\t\t\tif(t==-2)fh.pop(),zc=num.top(),num.pop();//\u5de6\u53f3\u62ec\u53f7\u5339\u914d\uff0c\u62ec\u53f7\u4e2d\u8ba1\u7b97\u540e\u7684\u6570\u5b57\u5f39\u51fa \n\t\t\treturn; \n\t\t}\n\t\tif(fh.top()+1<t)return;\n\t\tint a=num.top();\n\t\tnum.pop();\n\t\tint b=num.top();\n\t\tnum.pop();\n\t\tif(fh.top()==1)num.push(a+b);\n\t\tif(fh.top()==2)num.push(b-a);\n\t\tif(fh.top()==4)num.push(a*b);\n\t\tif(fh.top()==5)num.push(b/a);\n\t\tfh.pop();\n\t}\n}\nint write(string s){\n\tzc=0;\n\tfor(int i=0;i<s.size();i++){\n        if('0'<=s[i]&&s[i]<='9')zc=(zc<<3)+(zc<<1)+(s[i]^48);//\u5904\u7406\u6570\u5b57 \n        else if('a'<=s[i]&&s[i]<='z')zc=a[s[i]-'a'];//\u5904\u7406\u5b57\u6bcd\uff08\u53d8\u91cf\uff09\n\t\telse{//\u5904\u7406\u7b26\u53f7\uff08\u8fdb\u884c\u8fd0\u7b97\uff09 \n            int ZJ=zj(s[i]);\n            if(ZJ!=-1)num.push(zc),zc=0;\n            if(!fh.empty()&&fh.top()+1>=ZJ&&ZJ>0)zh(ZJ);\n            else if(ZJ==-2){\n            \tzh(ZJ);\n\t\t\t\tcontinue;\n\t\t\t}\n            fh.push(ZJ);\n        }\n    }\n\tnum.push(zc),zh(0);\n\tint ans=num.top(); \n\tnum.pop();\n\treturn ans;\n}\n//\u8ba1\u7b97\u5668\u90e8\u5206 \u2191\ninline bool Do(int i){//\u76f4\u63a5\u6839\u636e\u8bed\u53e5\u6267\u884c\u547d\u4ee4 \n\twhile(s[++i]!=\"end\"){\n\t\tif(s[i]==\"continue\")return 0;\n\t\tif(s[i]==\"break\")return 1;\n\t\tif(s[i]==\"loop\"){\n\t\t\tint loop=write(s[++i]),cnt=1;\n\t\t\tfor(int j=1;j<=loop;j++)if(Do(i))break;//\u76f4\u63a5\u9012\u5f52\uff0c\u9047\u5230break\u5c31\u505c\u6b62\n\t\t\twhile(cnt){//\u8df3\u5230end\u90e8\u5206 \n\t\t\t\ti++;\n\t\t\t\tif(s[i]==\"loop\")cnt++;\n\t\t\t\tif(s[i]==\"end\")cnt--;\n\t\t\t} \n\t\t}else if(s[i]==\"write\")cout<<write(s[++i])<<'\\n';\n\t\telse a[s[i][0]-'a']=write(s[i].substr(2,s[i].size()-2));\n\t}\n\treturn 0;\n}\nsigned main(){\n\tios::sync_with_stdio(0),cin.tie(0),cout.tie(0);\n\twhile(cin>>s[++p]);//\u76f4\u63a5cin\u8bfb\u5165\u5b57\u7b26\u4e32\u5373\u53ef\uff08\u4e0d\u8bfb\u5165\u7a7a\u683c\uff09\n\tDo(0);\n}\n```\n",
        "postTime": 1659499359,
        "uid": 726899,
        "name": "ty_Ray",
        "ccfLevel": 6,
        "title": "P2229 [HNOI2002]\u6c99\u6f20\u5bfb\u5b9d \u9898\u89e3"
    },
    {
        "content": "## \u9898\u89e3\n\n\u89c2\u5bdf\u53d1\u73b0\uff0c\u672c\u9898\u4e3b\u8981\u53ef\u4ee5\u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff1a**\u4e2d\u7f00\u8868\u8fbe\u5f0f\u6c42\u503c**\u4ee5\u53ca**\u6839\u636e\u7b97\u6cd5\u6d41\u7a0b**\u6a21\u62df\u3002\u56e0\u6b64\uff0c\u4ee5\u4e0b\u5206\u522b\u8bf4\u660e\u3002\n\n### \u4e2d\u7f00\u8868\u8fbe\u5f0f\u6c42\u503c\n\n\u5728\u672c\u9898\u4e2d\uff0c\u4ec5\u4ec5\u4f1a\u51fa\u73b0\u5355\u5b57\u6bcd\u53d8\u91cf\uff0c\u4ee5\u53ca\u52a0\u51cf\u4e58\u9664\u548c\u62ec\u53f7\u3002\u6309\u7167\u60ef\u4f8b\uff0c\u6211\u4eec\u4f7f\u7528\u4e24\u4e2a\u6808\u8fdb\u884c\u7ef4\u62a4\u3002$\\text{A}$ \u6808\u7ef4\u62a4\u5f53\u524d\u5904\u7406\u5230\u7684\u6570\u5b57\uff0c$\\text{B}$ \u6808\u7ef4\u62a4\u5f53\u524d\u5904\u7406\u5230\u7684\u8fd0\u7b97\u7b26\u3002\u4e3a\u4e86\u9632\u6b62\u975e\u6cd5\u8bbf\u95ee\uff0c\u6211\u4eec\u5728 $\\text{B}$ \u6808\u91cc\u5148\u63a8\u5165\u4e00\u4e2a\u5de6\u62ec\u53f7\u3002\n\n- \u7531\u4e8e\u672c\u9898\u5141\u8bb8\u4e0d\u6b62\u4e00\u4f4d\u6574\u6570\uff0c\u6240\u4ee5\u53ea\u6709\u5f53\u8bfb\u5230\u4e86\u4e00\u4e2a\u975e\u6570\u5b57\u5b57\u7b26\u65f6\uff0c\u6211\u4eec\u518d\u628a\u8fd9\u4e2a\u6574\u6570\u4f5c\u4e3a\u6574\u4f53\u538b\u5165 $\\text{A}$ \u6808\uff1b\u5f53\u8bfb\u5165\u5230\u7684\u662f\u5c0f\u5199\u5b57\u6bcd\u65f6\uff0c\u5c31\u76f4\u63a5\u4ece\u5bf9\u5e94\u7684\u53d8\u91cf\u53d6\u51fa\u5e76\u538b\u5165 $\\text{A}$ \u6808\u5373\u53ef\u3002\n\n- \u5f53\u8bfb\u5165\u5230\u52a0\u51cf\u4e58\u9664\u4e4b\u4e00\u7684\u8fd0\u7b97\u7b26 $\\mathit{op}$ \u65f6\uff0c\u4e0d\u65ad\u53d6\u51fa $\\text{B}$ \u6808\u6808\u9876\u7684\u4e00\u4e2a\u8fd0\u7b97\u7b26 $\\mathit{op'}$ \u3002\u82e5 $\\mathit{op'}$ \u4f18\u5148\u7ea7\u4e0d\u5c0f\u4e8e $\\mathit{op}$\uff0c\u5219\u53d6\u51fa $\\text{A}$ \u6808\u6808\u9876\u7684\u4e24\u4e2a\u6570\u5b57\uff0c\u8fd0\u7b97\u540e\u52a0\u5165 $\\text{A}$ \u6808\uff0c\u76f4\u5230\u53d6\u51fa\u7684 $\\mathit{op'}$ \u4f18\u5148\u7ea7\u66f4\u5c0f\u3002\u6700\u540e\u628a\u8bfb\u5165\u7684\u8fd0\u7b97\u7b26\u538b\u5165 $\\text{B}$ \u6808\u3002\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1\uff0c\u5f53\u524d $\\text{B}$ \u6808\u4e2d\u7684\u8fd0\u7b97\u7b26\u4f18\u5148\u7ea7\u4e25\u683c\u5355\u8c03\u9012\u589e\u3002\n\n- \u5f53\u8bfb\u5165\u5230\u5de6\u62ec\u53f7\u65f6\uff0c\u76f4\u63a5\u538b\u5165\u3002\n\n- \u5f53\u8bfb\u5165\u5230\u53f3\u62ec\u53f7\u65f6\uff0c\u6309\u7167\u8bfb\u5165\u52a0\u51cf\u4e58\u9664\u8fd0\u7b97\u7b26\u7684\u65b9\u5f0f\u8fd0\u7b97\uff0c\u76f4\u5230 $\\text{B}$ \u6808\u6808\u9876\u4e3a\u5de6\u62ec\u53f7\u3002\u7ed3\u675f\u540e\u8bb0\u5f97\u5f39\u51fa\u8fd9\u4e2a\u5de6\u62ec\u53f7\u3002\n\n### \u6a21\u62df\u6d41\u7a0b\n\n\u4f7f\u7528\u7ed3\u6784\u4f53\u5b9a\u4e49\u7c7b\u578b $\\text{Node}$\uff0c\u7528\u4e8e\u8868\u793a\u5f53\u524d\u8fd0\u7b97\u5230\u7684\u8282\u70b9\u3002\u91cc\u9762\u5305\u542b\u8be5\u8282\u70b9\u7684\u79cd\u7c7b\uff08$\\text{start,end,loop,continue,break,write}$ \u4e4b\u4e00\uff09$f$\u3001\u4e0e\u8be5\u8282\u70b9\u76f4\u63a5\u5173\u8054\u7684\u8868\u8fbe\u5f0f $S$\u3001\u4e34\u65f6\u53d8\u91cf $t$ \u548c $w$\uff0c\u4ee5\u53ca\u8be5\u8282\u70b9\u7684\u540e\u7ee7\u8282\u70b9 $l$\u3002\u7279\u522b\u5730\uff0c\u6211\u4eec\u5c06 $\\text{start}$ \u89c6\u4e3a\u7279\u6b8a\u7684 $\\text{loop}$\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8bed\u53e5\uff0c\u90fd\u7528\u4e00\u4e2a\u8282\u70b9\u8868\u793a\u3002\n\n\u9884\u5904\u7406\u65f6\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u6808 $T$\u3002\u540c\u65f6\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u6570\u7ec4 $A$\uff0c\u5b58\u50a8 $26$ \u4e2a\u53d8\u91cf\u7684\u503c\u3002\n\n\u5bf9\u8f93\u5165\u6570\u636e\u8fdb\u884c\u9884\u5904\u7406\uff0c\u5904\u7406\u51fa\u5bf9\u5e94\u7684\u8282\u70b9\uff1a\n\n- \u4e3a\u4e86\u5b9e\u73b0\u8bed\u53e5\u5339\u914d\uff0c\u5f53\u8bfb\u5165\u5230 $\\text{start,loop}$ \u65f6\u5c06\u5b83\u7684\u7f16\u53f7\u5165\u6808\uff1b\u8bfb\u5165\u5230 $\\text{continue,break,end}$ \u65f6\uff0c\u5c06\u8fd9\u4e09\u79cd\u8bed\u53e5\u521b\u5efa\u51fa\u7684\u8282\u70b9\u7684 $w$ \u6307\u5411\u6808\u9876\uff08\u4e5f\u5c31\u662f\u5bf9\u5e94 $\\text{loop}$ \u8bed\u53e5\u7684\u7f16\u53f7\uff09\u3002\u7279\u522b\u5730\uff0c\u8bfb\u53d6\u5230 $\\text{end}$ \u8bed\u53e5\u5c31\u8ba9\u6808\u9876\u5f39\u51fa\uff0c\u5e76\u4e14\u5c06\u5bf9\u5e94 $\\text{loop}$ \u8282\u70b9\u7684 $t$ \u8d4b\u503c\u4e3a\u5f53\u524d\u8282\u70b9\u7684\u4e0b\u4e00\u4e2a\u8282\u70b9\u7684\u7f16\u53f7\u3002\n\n- \u4e3a\u4e86\u5b9e\u73b0\u8d4b\u503c\u8bed\u53e5\uff0c\u6211\u4eec\u5c06\u8be5\u8282\u70b9\u7684 $w$ \u8d4b\u503c\u4e3a\u9700\u8981\u8d4b\u503c\u7684\u90a3\u4e2a\u53d8\u91cf\u7684\u7f16\u53f7\u3002\n\n- \u4e3a\u4e86\u5b9e\u73b0\u5faa\u73af\u8bed\u53e5\uff0c\u6211\u4eec\u7528 $\\text{loop}$ \u8282\u70b9\u5f53\u4e2d\u7684 $w$ \u5b58\u50a8\u5f53\u524d\u5269\u4e0b\u7684\u5faa\u73af\u6b21\u6570\u3002$\\text{continue}$ \u8bed\u53e5\u7684 $t$ \u8d4b\u503c\u4e3a $-1$\uff0c$\\text{break}$ \u8bed\u53e5\u7684 $t$ \u8d4b\u503c\u4e3a $-\\infty$\uff08\u4ee3\u7801\u4e2d\uff0c\u8d4b\u503c\u4e3a\u4e00\u4e2a\u6781\u5c0f\u503c\uff09\u3002\u9884\u5904\u7406\u5230 $\\text{continue}$ \u6216\u8005 $\\text{break}$ \u65f6\uff0c**\u5ffd\u7565**\u5269\u4e0b\u7684\u6240\u6709\u8bed\u53e5\uff0c\u76f4\u5230\u78b0\u5230\u5bf9\u5e94 $\\text{loop}$ \u7684 $\\text{end}$\u3002\n\n- \u5c06\u4e0e $\\text{start}$ \u6307\u4ee4\u5339\u914d\u7684 $\\text{end}$ \u8282\u70b9\u7684 $l$ \u8d4b\u503c\u4e3a $-1$\u3002\u5176\u4ed6\u8282\u70b9\u7684 $l$ \u8d4b\u503c\u4e3a\u5b83\u7684\u7f16\u53f7 $+1$\u3002\n\n\u7136\u540e\u662f\u8fdb\u884c\u6a21\u62df\u3002\u6211\u4eec\u8bbe\u5f53\u524d\u8bbf\u95ee\u5230\u7684\u8282\u70b9\u7f16\u53f7\u4e3a $p$\u3002\n\n- \u5982\u679c\u5f53\u524d\u8282\u70b9\u4e3a\u8d4b\u503c\u8bed\u53e5\uff0c\u90a3\u5c31\u5c06\u5bf9\u5e94\u53d8\u91cf $A_w$ \u8d4b\u503c\u4e3a\u5bf9 $p(S)$ \u4e2d\u7f00\u8868\u8fbe\u5f0f\u6c42\u503c\u540e\u7684\u7ed3\u679c\u3002\u63a5\u7740 $p\\gets p(l)$\u3002\n\n- \u5982\u679c\u5f53\u524d\u8282\u70b9\u4e3a $\\text{loop}$\uff0c\u90a3\u4e48\u5c06 $p(w)$ \u8d4b\u503c\u4e3a\u5bf9 $p(S)$ \u4e2d\u7f00\u8868\u8fbe\u5f0f\u6c42\u503c\u540e\u7684\u7ed3\u679c\u3002\u63a5\u7740 $p\\gets p(l)$\u3002\n\n- \u5982\u679c\u5f53\u524d\u8282\u70b9\u4e3a $\\text{continue}$ \u6216\u8005 $\\text{break}$\uff0c\u5c31\u5c06 $\\text{loop}$ \u8282\u70b9 $p(w)$ \u7684 $t$ \u52a0\u4e0a\u5f53\u524d\u8282\u70b9\u7684 $t$\u3002\u5982\u679c\u76f8\u52a0\u540e\u5c0f\u4e8e $0$\uff0c\u5219\u8df3\u8f6c\u81f3 $p(w)$ \u5bf9\u5e94\u7684 $\\text{end}$ \u8282\u70b9\u7684\u4e0b\u4e00\u4e2a\u8282\u70b9 $(p(w))(t)$ \uff1b\u5426\u5219\u8df3\u8f6c\u81f3 $(p(w))(l)$\u3002\n\n- \u5982\u679c\u5f53\u524d\u8282\u70b9\u4e3a $\\text{write}$\uff0c\u76f4\u63a5\u8f93\u51fa\u5bf9 $p(S)$ \u8868\u8fbe\u5f0f\u6c42\u503c\u7684\u7ed3\u679c\uff0c\u5e76 $p\\gets p(l)$\u3002\u5373\u53ef\u3002\n\n- \u5982\u679c\u67d0\u4e2a\u65f6\u523b\uff0c$p=-1$\uff0c\u90a3\u4e48\u7ec8\u6b62\u7a0b\u5e8f\u3002\n\n\u4e8e\u662f\u8fd9\u9898\u5c31\u505a\u5b8c\u4e86\u3002\n\n## \u53c2\u8003\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define up(l,r,i) for(int i=l,END##i=r;i<=END##i;++i)\n#define dn(r,l,i) for(int i=r,END##i=l;i>=END##i;--i)\nusing namespace std;\ntypedef long long i64;\nconst int INF =2147483647;\nmap<char,int> A;\nint calc(const string S){\n\tstack <int > W; stack <char> C; map<char,int> M;\n\tM['+']=M['-']=1,M['*']=M['/']=2,M['(']=-2,M[')']=-1;\n\tW.push(0),C.push('#'),C.push('(');\n\tint w=0,f=1; bool d=0; for(int p=0,l=S.length();p<=l;++p){\n\t\tchar t=(p<l?S[p]:')'); if(t=='(') C.push('('); else\n\t\tif(!d&&t=='+'&&C.top()=='(') f= 1; else\n\t\tif(!d&&t=='-'&&C.top()=='(') f=-1; else\n\t\tif(isalpha(t)) w=A[t]      ,d=true; else\n\t\tif(isdigit(t)) w=w*10+t-'0',d=true; else {\n\t\t\tif(d) W.push(w*f),w=0,f=1,d=false;\n\t\t\twhile(M[C.top()]>=M[t]){\n\t\t\t\tint a=W.top(); W.pop();\n\t\t\t\tint b=W.top(); W.pop();\n\t\t\t\tint o=C.top(); C.pop(); int c;\n\t\t\t\tswitch(o){\n\t\t\t\t\tcase '+': c=b+a; break;\n\t\t\t\t\tcase '-': c=b-a; break;\n\t\t\t\t\tcase '*': c=b*a; break;\n\t\t\t\t\tcase '/': c=b/a; break;\n\t\t\t\t}\n\t\t\t\tW.push(c);\n\t\t\t}\n\t\t\tif(t==')') C.pop(); else C.push (t);\n\t\t}\n\t}\n\treturn W.top();\n}\nconst int MAXN =1e6+3;\nint p;\nstruct Node{\n\tint t,l,w,f; string S; void operator()();\n}N[MAXN];\nvoid Node::operator()(){\n\tswitch(f){\n\t\tcase 0: A[w]=calc(S),p=     l   ; break;\n\t\tcase 1:   w =calc(S),p=(w>0?l:t); break;\n\t\tcase 2: N[w].w+=t,p=(N[w].w>0?N[w].l:N[w].t); break;\n\t\tcase 3: cout<<calc(S)<<endl,p=l;  break;\n\t\tcase -1:p=-1;\n\t}\n}\nint main(){\n\tios_base::sync_with_stdio(false);\n\tstack <int> S; string x,y; int n=0;\n\tdo{\n\t\t++n,N[n].l=n+1,N[n].t=0; cin>>x;\n\t\tif(x==\"start\") S.push(n); else \n\t\tif(x==\"loop\" ) cin>>N[n].S,N[n].f=1,S.push(n);\n\t\telse if(x==\"continue\") N[n].t=-1  ,N[n].f=2,N[n].w=S.top();\n\t\telse if(x==\"break\"   ) N[n].t=-INF,N[n].f=2,N[n].w=S.top();\n\t\telse if(x==\"write\"   ) cin>>N[n].S,N[n].f=3;\n\t\telse if(x==\"end\"){\n\t\t\tif(S.top()==1) N[n].f=-1; else{\n\t\t\t\tN[S.top()].t=n+1; N[n].w=S.top(),N[n].t=-1,N[n].f=2;\n\t\t\t}\n\t\t\tS.pop();\n\t\t} else {\n\t\t\tN[n].w=x[0],N[n].S=x.substr(2),N[n].f=0;\n\t\t}\n\n\t}while(!S.empty());\n\tp=1; while(p!=-1) N[p]();\n\treturn 0;\n}\n```",
        "postTime": 1630151984,
        "uid": 330759,
        "name": "\u56e7\u4ed9",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2229 \u3010[HNOI2002]\u6c99\u6f20\u5bfb\u5b9d\u3011"
    },
    {
        "content": "\u7279\u522b\uff0c\u7279\u522b\uff0c\u6076\u5fc3\u7684\u4e00\u9053\u6a21\u62df\u9898\n\n\u6709\u70b9\u50cf17\u5e74\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff08~~\u4f46\u66f4\u6076\u5fc3~~\u6709\u6210\u4e3a\u9ed1\u9898\u7684\u6f5c\u8d28\uff09\n\n\u8003\u70b9\u4e5f\u6bd4\u8f83\u591a\uff1a\u7b80\u5355\u8ba1\u7b97\u5668\u3001\u624b\u5199\u7f16\u8bd1\u5668\n\n\u7b80\u5355\u8ba1\u7b97\u5668\u53ef\u4ee5\u7528\u6808\u5b9e\u73b0\uff08\u601d\u8def\uff1a\u5148\u7b97\u4e58\u9664\uff0c\u5728\u7b97\u52a0\u51cf\uff0c\u9047\u5230\u53f3\u62ec\u53f7\u4e00\u76f4\u51fa\u6808\u76f4\u5230\u9047\u5230\u5de6\u62ec\u53f7\uff09\uff1a\n```cpp\nlong long demo(long long start,long long len)\n{\n    long long sum,num,tem;\n    sum=num=tem=0;\n    for(long long i=start;i<len;i++)\n    {\n        if(re[t].r[i]<='9' && re[t].r[i]>='0')\n        {\n            while(re[t].r[i]<='9' && re[t].r[i]>='0')\n            {\n                num*=10;\n                num+=re[t].r[i]-'0';\n                i++;\n            }\n            i--;\n            if(!c.empty() && c.top()=='*')\n            {\n                n.top()=n.top()*num;\n                c.pop();\n            }\n            else if(!c.empty() && c.top()=='/')\n            {\n                n.top()=n.top()/num;\n                c.pop();\n            }\n            else\n            {\n                n.push(num);\n            }\n            num=0;\n        }\n        else if(re[t].r[i]<='z' && re[t].r[i]>='a')\n        {\n            if(!c.empty() && c.top()=='*')\n            {\n                n.top()=n.top()*a[re[t].r[i]-'a'];\n                c.pop();\n            }\n            else if(!c.empty() && c.top()=='/')\n            {\n                n.top()=n.top()/a[re[t].r[i]-'a'];\n                c.pop();\n            }\n            else\n            {\n                n.push(a[re[t].r[i]-'a']);\n            }\n        }\n        else\n        {\n            c.push(re[t].r[i]);\n            if(re[t].r[i]==')')\n            {\n                c.pop();\n                tem=n.top();\n                n.pop();\n                while(c.top()!='(')\n                {\n                    if(c.top()=='+')\n                    {\n                        tem+=n.top();\n                    }\n                    else\n                    {\n                        tem=n.top()-tem;\n                    }\n                    n.pop();\n                    c.pop();\n                }\n                c.pop();\n                if(c.empty())\n                n.push(tem);\n                else if(c.top()=='*')\n                {\n                    n.top()*=tem;\n                    c.pop();\n                }\n                else if(c.top()=='/')\n                {\n                    n.top()/=tem;\n                    c.pop();\n                }\n                else\n                {\n                    n.push(tem);\n                }\n                tem=0;\n            }\n        }\n    }\n    sum=n.top();\n    n.pop();\n    while(!c.empty())\n    {\n        if(c.top()=='+')\n        {\n            sum+=n.top();\n        }\n        else\n        {\n            sum=n.top()-sum;\n        }\n        c.pop();\n        n.pop();\n    }\n    return sum;\n}\n```\n\u64cd\u4f5c\u603b\u5171\u67096\u79cd\u7c7b\u578b\uff0c\u4f46\u4e3b\u8981\u662f\u5faa\u73af\u6076\u5fc3\n\n\u53ef\u4ee5\u5f00\u4e00\u4e2a\u6570\u7ec4\uff0c\u4ece\u4e00\u4e2a\u5faa\u73af\u5f00\u5934\u76f4\u63a5\u98de\u5230\u8be5\u5faa\u73af\u7ed3\u675f\uff0c\u8fd9\u6837\u4f1a\u4f7f\u4ee3\u7801\u66f4\u52a0\u7b80\u6d01\n\n200\u884c\u4ee3\u7801\u8d34\u5728\u8fd9\uff08\u672c\u849f\u84bb\u7684\u4ee3\u7801\u8fd8\u662f\u590d\u6742\u4e86\uff09\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\nlong long a[26];\nint end_num[1000];//\u8d77\u98de\nstruct node\n{\n    char r[80];\n};\nnode re[1000];//\u79bb\u7ebf\u5b58\u50a8\nstack<int>s;\nstack<int>n;\nstack<char>c;\nint maxn=1;\nint t=0;\nint maxe=0;\nint te=0;\nlong long demo(long long begin,long long len) //\u8ba1\u7b97\u5668\n{\n    long long sum,num,tem;\n    sum=num=tem=0;\n    for(long long i=begin;i<len;i++)\n    {\n        if(re[t].r[i]<='9' && re[t].r[i]>='0')\n        {\n            while(re[t].r[i]<='9' && re[t].r[i]>='0')\n            {\n                num*=10;\n                num+=re[t].r[i]-'0';\n                i++;\n            }\n            i--;\n            if(!c.empty() && c.top()=='*')   //\u4e00\u5b9a\u8981\u6709empty\u7684\u5224\u65ad\n            {\n                n.top()=n.top()*num;\n                c.pop();\n            }\n            else if(!c.empty() && c.top()=='/')\n            {\n                n.top()=n.top()/num;\n                c.pop();\n            }\n            else\n            {\n                n.push(num);\n            }\n            num=0;\n        }\n        else if(re[t].r[i]<='z' && re[t].r[i]>='a')\n        {\n            if(!c.empty() && c.top()=='*')\n            {\n                n.top()=n.top()*a[re[t].r[i]-'a'];\n                c.pop();\n            }\n            else if(!c.empty() && c.top()=='/')\n            {\n                n.top()=n.top()/a[re[t].r[i]-'a'];\n                c.pop();\n            }\n            else\n            {\n                n.push(a[re[t].r[i]-'a']);\n            }\n        }\n        else\n        {\n            c.push(re[t].r[i]);\n            if(re[t].r[i]==')')\n            {\n                c.pop();\n                tem=n.top();\n                n.pop();\n                while(c.top()!='(')\n                {\n                    if(c.top()=='+')\n                    {\n                        tem+=n.top();\n                    }\n                    else\n                    {\n                        tem=n.top()-tem;\n                    }\n                    n.pop();\n                    c.pop();\n                }\n                c.pop();\n                if(c.empty())\n                n.push(tem);\n                else if(c.top()=='*')\n                {\n                    n.top()*=tem;\n                    c.pop();\n                }\n                else if(c.top()=='/')\n                {\n                    n.top()/=tem;\n                    c.pop();\n                }\n                else\n                {\n                    n.push(tem);\n                }\n                tem=0;\n            }\n        }\n    }\n    sum=n.top();\n    n.pop();\n    while(!c.empty())\n    {\n        if(c.top()=='+')\n        {\n            sum+=n.top();\n        }\n        else\n        {\n            sum=n.top()-sum;\n        }\n        c.pop();\n        n.pop();\n    }\n    return sum;\n}\nint flag=0;\nint scan()\n{\n    long long n;\n    int start,endd,tem;\n    t++;\n    if(re[t].r[0]=='l' && re[t].r[1]=='o')//loop\u60c5\u51b5\n    {\n        t++;\n        n=demo(0,strlen(re[t].r));\n        start=t;\n        flag=0;\n        while(true)\n        {\n            tem=scan();\n            if(tem==3)\n            {\n                break;\n            }\n            else if(tem==2)\n            {\n                t=end_num[start-1];\n                flag=0;\n                return 0;\n            }\n            else if(tem==1)\n            {\n                break;\n            }\n        }\n        endd=t-1;\n        for(int i=1;i<n;i++)\n        {\n            t=start;\n            while(t<=endd)//\u6ce8\u610f\u8fd9\u91cc\u4e0d\u80fd\u7528for\u5faa\u73af\uff08\u5c31\u662f\u56e0\u4e3a\u8fd9\u4e2a100\u53d820\uff09\n            {\n                scan();\n            }\n        }\n        t=end_num[start-1];       //\u76f4\u63a5\u8d77\u98de\n    }\n    else if(re[t].r[0]=='e' && re[t].r[1]=='n')//end\n    {\n        return 3;\n    }\n    else if(re[t].r[1]=='=')//\u76f4\u63a5\u8d4b\u503c\n    {\n        a[re[t].r[0]-'a']=demo(2,strlen(re[t].r));\n    }\n    else if(re[t].r[0]=='w' && re[t].r[1]=='r')//write\n    {\n        t++;\n        printf(\"%lld\\n\",demo(0,strlen(re[t].r)));\n    }\n    else if(re[t].r[0]=='c' && re[t].r[1]=='o')//continue\n    {\n        return 1;\n    }\n    else if(re[t].r[0]=='b' && re[t].r[1]=='r')//break\n    {\n        return 2;\n    }\n    return 0;\n}\nint main()\n{\n    s.push(1);            //\u7279\u6b8a\u5904\u7406begin\uff0c\u4e0d\u7136\u4f1aRE\n    while(scanf(\"%s\",re[maxn].r)!=EOF)            //\u5904\u7406\u8d77\u98de\u4ee3\u7801\n    {\n        if(re[maxn].r[0]=='l' && re[maxn].r[1]=='o')\n        {\n            s.push(maxn);\n        }\n        if(re[maxn].r[0]=='e' && re[maxn].r[1]=='n')\n        {\n            end_num[s.top()]=maxn;\n            s.pop();\n        }\n        maxn++;\n    }\n    maxn--;\n    while(true)\n    {\n        scan();\n        if(t==maxn)\n        break;\n    }\n    return 0;\n}\n```\n\u6709\u53ef\u4ee5\u4f18\u5316\u7684\u5730\u65b9\u6b22\u8fce\u6307\u6b63",
        "postTime": 1628600693,
        "uid": 513900,
        "name": "Wilson_Lee",
        "ccfLevel": 7,
        "title": "[HNOI2002]\u6c99\u6f20\u5bfb\u5b9d\u9898\u89e3"
    },
    {
        "content": "- ## \u524d\u8a00\n\n\t\u8fd9\u662f\u4e00\u4e2a\u6a21\u62df\u9898,\u96be\u5ea6\u4e0d\u4e9a\u4e8e\u6740\u8682\u8681\n\t\n\t\u56e0\u4e3a\u4e0e\u6740\u8682\u8681\u76f8\u6bd4\u66f4\u9700\u8981\u6e05\u6670\u7684\u7ed3\u6784\n\n\t\u6240\u4ee5\u5f88\u8003\u9a8c\u4ee3\u7801\u5e95\u529b..\u5e95\u529b\u4e0e\u5199\u4ee3\u7801\u7684\u65f6\u95f4\u6210\u6b63\u6bd4\n    \n    \u540c\u65f6\u4e5f\u8003\u7814\u5bf9\u4e8e\u8bed\u8a00\u7684\u7406\u89e3\n\n---\n- ## \u9898\u89e3\n\t\u6211\u4eec\u5148\u4e00\u70b9\u4e00\u70b9\u8003\u8651\n    \n    \u4ece\u5e95\u5c42\u5f80\u4e0a\u5c42\u6765\u8003\u8651\n    \n    \u4e0b\u6587\u90fd\u662f\u4ee5c++\u4e3a\u8bed\u8a00\n    \n    ---\n    \u53d8\u91cf\u6700\u591a\u53ea\u670926\u4e2a\n    \n    \u6211\u4eec\u53ef\u4ee5\u5f00\u4e2a\u6570\u7ec4\u6765\u4fdd\u5b58\u6bcf\u4e2a\u53d8\u91cf\u7684\u503c\n    \n    --- \n    \n   \u8ba9\u4eba\u5934\u75db\u7684\u662f\u8868\u8fbe\u5f0f\u7684\u5904\u7406\n        \n   \u9996\u5148\u662f\u8868\u8fbe\u5f0f\u7684\u5b58\u50a8\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a\u4e8c\u5143\u7ec4OBJ=  \n   $<Type(int),Data(int)>$\n    \n   \u6765\u5b58\u50a8\u4e00\u4e2a\u5355\u4f4d\uff0c\u5176\u4e2dType\u8868\u793a\u7c7b\u578b\uff0cData\u8868\u793a\u6570\u636e\n        \n   \u7c7b\u578b\u53ef\u4ee5\u662f\u6574\u6570\uff0c\u4ee3\u6570\u548c\u8fd0\u7b97\u7b26\n        \n   \u800c\u6570\u636e\u5c31\u5982\u5b57\u9762\u610f\u601d\n        \n   \u90a3\u6837\u6211\u4eec\u5b58\u50a8\u4e00\u4e2a\u8868\u8fbe\u5f0f\u5c31\u53ef\u4ee5\u7528vector<OBJ>\u5b9e\u73b0\uff0c\u8bbe\u5176\u4e3aEXP\n  \n  \u4e2d\u7f00\u8868\u8fbe\u5f0f\u5f88\u96be\u5904\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u8f6c\u6362\u4e3a\u540e\u7f00\u8868\u8fbe\u5f0f\n  \n  \u5982\u4f55\u8f6c\u6362\u53ef\u4ee5\u89c1\u767e\u5ea6\n  \n  ---\n  \n  \u8bbe\u6570\u636e\u7ed3\u6784ASSIGN\u4e3a\u4e8c\u5143\u7ec4\u7c7b\u578b$<Vala(char),Valb(EXP)>$,\u8868\u793a\u5c06\u8868\u8fbe\u5f0fValb\u8ba1\u7b97\u51fa\u5e76\u8d4b\u503c\u7ed9\u53d8\u91cfVala\n  \n  \u7136\u540e\u6211\u4eec\u5efa\u7acb\u4e00\u4e2a\u901a\u7528\u7684\u53ef\u4ee5\u8868\u793a\u6240\u6709\u8bed\u53e5\u6570\u636e\u7ed3\u6784STATE\n  \n  \u53ef\u4ee5\u7406\u89e3\u4e3a\u4e8c\u5143\u7ec4$<Type(int),Data(void*)>$Type\u8868\u793a\u7c7b\u578b\uff0cData\u8868\u793a\u6709\u5173\u6570\u636e\n  \n  \u5bf9\u4e8eType\u8868\u793acontinue\uff0cbreak,start\uff0cend\u8bed\u53e5\u65f6\uff0cData\u4e0d\u7528\u7ba1\n  \n  \u5bf9\u4e8eType\u8868\u793aloop\uff0cwrite\u8bed\u53e5\u65f6\uff0cData\u8868\u793a\u5176\u540e\u7684\u8868\u8fbe\u5f0f\u53c2\u6570\uff0c\u6240\u4ee5\u6b64\u65f6Data\u5c31\u662f\u4e00\u4e2a\u6307\u5411EXP\u7684\u6307\u9488\n  \n  \u5bf9\u4e8eType\u8868\u793a\u8d4b\u503c\u8bed\u53e5\u65f6\uff0cData\u8868\u793a\u6574\u4e2a\u8d4b\u503c\u8bed\u53e5\u53c2\u6570\uff0c\u6240\u4ee5\u6b64\u65f6Data\u5c31\u662f\u4e00\u4e2a\u6307\u5411ASSIGN\u7684\u6307\u9488\n  \n  ---\n  \n  \u7136\u540e\u6211\u4eec\u5c31\u80fd\u628a\u6240\u6709\u7684\u8bed\u53e5\u90fd\u5b58\u4e0b\u6765\uff0c\u5b58\u5230\u4e00\u4e2a\u6570\u7ec4\u91cc\n  \n  \u5bf9\u4e8eloop end\u548cstart end\u6211\u4eec\u5904\u7406\u51fa\u6bcf\u4e2aloop\u548cstart\u6240\u5bf9\u5e94\u7684end\u7684\u4f4d\u7f6e\uff0c\u7528\u4e0b\u6807\u6765\u5b58\u50a8\n  \n  \u5bf9\u4e8e\u8fd0\u4f5c\u6211\u4eec\u53ef\u4ee5\u5199\u4e00\u4e2aRUNA\u51fd\u6570\u6765\u6267\u884c\u4e00\u4e2a\u8bed\u53e5\uff0c\u5f53\u7136\u5b83\u53ea\u4f1a\u5904\u7406\u8d4b\u503c\u8bed\u53e5\u548cwrite\u8bed\u53e5\uff0c\u5176\u4ed6\u90fd\u4f1a\u5ffd\u7565\n  \n  \u6211\u4eec\u518d\u5199\u4e00\u4e2aRUN\u51fd\u6570\u6765\u6267\u884c[F,T]\u8fd9\u6bb5\u8bed\u53e5\uff0c\u5b83\u7684\u8fd4\u56de\u503c\u8868\u793a\u662f\u5426\u56e0\u4e3abreak\u800c\u9000\u51fa\u7684\n  \n  RUN\u5b9e\u73b0\u5c31\u662f\u5bf9\u4e8e\u6bcf\u4e2a\u8bed\u53e5\u5148RUNA\u4e00\u904d\uff0c\u7136\u540e\u5728\u8ba8\u8bba\u662f\u4ec0\u4e48\u8bed\u53e5\n  \n  \t\t\n        \t\u5982\u679c\u662fcontinue\u5c31\u76f4\u63a5\u8fd4\u56de0\n        \n       \t \u5982\u679c\u662fbreak\u5c31\u76f4\u63a5\u8fd4\u56de1\n        \n       \t \u5982\u679c\u662floop\u5c31\u5904\u7406\u51fa\u8868\u8fbe\u5f0f\u7684\u503ck\uff0c\u7136\u540e\u591a\u6b21\u9012\u5f52\u5904\u7406loop\u6240\u8868\u793a\u7684\u8bed\u53e5\u533a\u95f4\uff0c(\u8fd9\u6bb5\u533a\u95f4\u4e0d\u5305\u62ec\u8fd9\u4e2aloop\u548cend);\u5728\u5904\u7406\u5230\u8fbek\u6b21\u6216\u8005\u9012\u5f52\u8fd4\u56de1\u65f6\u7ed3\u675f\u5bf9\u8fd9\u4e2aloop\u548cend\u7684\u5904\u7406\uff0c\u5e76\u628a\u5f53\u524d\u4f4d\u7f6e\u8df3\u5230end\u540e\n        \n        \t\u5982\u679c\u90fd\u4e0d\u662f\u5c31\u628a\u5f53\u524d\u4f4d\u7f6e+1\n            \n   \u8fd9\u6837\u6700\u540e\u4e00\u4e2aRUN(2,L-1)\u5c31\u80fd\u5b8c\u6210\u4e86\uff0c\u5047\u8bbe\u8bed\u53e5\u5b58\u50a8\u4ece1\u5f00\u59cb\u4e14\u8bed\u53e5\u4e2a\u6570\u4e3aL\n   \n   [\u4ee3\u7801](https://paste.ubuntu.com/p/xJjf5t9wKr/)\n  \n  \n  \n  \n        \n        ",
        "postTime": 1521106789,
        "uid": 25508,
        "name": "Night_Aurora",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P2229 \u3010[HNOI2002]\u6c99\u6f20\u5bfb\u5b9d\u3011"
    },
    {
        "content": "### [\u539f\u9898\u94fe\u63a5](https://www.luogu.com.cn/problem/P2229)\n\n## \u8fd9\u4e48\u597d\u7684\u4e00\u9053\u5927\u6a21\u62df\uff0c\u600e\u4e48\u80fd\u4e0d\u7528OOP\uff08Object Oriented Programming\uff09\u6765\u5199\u5462\n\n\u5f88\u591a\u4eba\u89c9\u5f97 OOP \u4f1a\u5f88\u6162\uff0c\u4f46\u5176\u5b9e OOP \u53ef\u4ee5\u8dd1\u5f97\u5f88\u5feb\u7684\uff0c\u6211\u7684\u7b2c\u4e00\u4efd AC \u4ee3\u7801\u5728\u76ee\u524d\uff08$2021.8.4$\uff09\u662f\u4ee5 $92ms$ \u6392\u884c\u7b2c\u4e09\u3002\u5c06 STL \u7684 `stack` \u6539\u6210\u624b\u5de5\u6808\u540e\u7a33\u59a5\u4ee5 $38ms$ \u62ff\u5230\u6700\u4f18\u89e3\u3002\n\n## \u89e3\u9898\u601d\u8def\n\n\u66b4\u529b\u6a21\u62df\n\n\u9700\u8981\u638c\u63e1\u7684\u6280\u5de7\uff1a\u5b57\u7b26\u4e32\u8bfb\u5165\u5206\u6790\u3001\u8868\u8fbe\u5f0f\u6c42\u503c\u3002\n\n## \u5b9e\u73b0\u7ec6\u8282\n\n\u7531\u4e8e\u5faa\u73af\u7684\u5b58\u5728\uff0c\u5982\u679c\u6211\u4eec\u5728\u6bcf\u6b21\u5faa\u73af\u4e2d\u90fd\u91cd\u65b0\u89e3\u6790\u4e00\u904d\u4ee3\u7801\uff0c\u901f\u5ea6\u5c06\u4f1a\u53d8\u5f97\u975e\u5e38\u6162\uff08`Python` \u9f9f\u901f\u7684\u539f\u56e0\uff09\uff0c\u5f88\u591a\u4eba\u5e94\u8be5\u90fd\u662f\u56e0\u4e3a\u8fd9\u4e2a\u800c\u8dd1\u5f97\u6162\u3002\n\n\u89e3\u51b3\u529e\u6cd5\u662f\u53ea\u7ecf\u8fc7\u4e00\u6b21\u626b\u63cf\uff0c\u5c06\u4ee3\u7801\u62bd\u8c61\u5316\uff0c\u6267\u884c\u65f6\u4e0d\u5fc5\u8fdb\u884c\u5206\u6790\u3002\n\n\u63a5\u4e0b\u6765\u5c31\u662f OOP \u767b\u573a\u4e86\u3002\n\n### \u7ed3\u6784\u5206\u6790\n\n\u9898\u76ee\u4e2d\u7684\u8bed\u8a00\u6709\u5982\u4e0b\u51e0\u79cd\u8bed\u53e5\uff1a\u8d4b\u503c\u3001\u5faa\u73af\u3001\u8f93\u51fa\u3002\u4e3b\u7a0b\u5e8f\u53ef\u4ee5\u770b\u505a\u4e00\u4e2a $1$ \u6b21\u7684\u5faa\u73af\u3002\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u5b9e\u73b0\u51e0\u4e2a\u7c7b\uff1a\u8bed\u53e5\u7684\u57fa\u7c7b $\\mathtt{Statement}$\u3001\u5b9e\u73b0\u8d4b\u503c\u7684\u7c7b $\\mathtt{Assignment}$\u3001\u5b9e\u73b0\u5faa\u73af\u7684\u7c7b $\\mathtt{Loop}$\u3001\u5b9e\u73b0\u8f93\u51fa\u7684\u7c7b $\\mathtt{Write}$\uff0c\u4ee5\u53ca\u7528\u4e8e\u5b58\u50a8\u8868\u8fbe\u5f0f\u7684\u7c7b $\\mathtt{Expression}$\u3002\n\n\u6211\u4eec\u5b9a\u4e49\u4e86\u5168\u5c40\u6570\u7ec4 $\\mathrm{var}$ \u6765\u50a8\u5b58\u53d8\u91cf\u6570\u503c\u3002\n\n### \u5b9e\u73b0 $\\mathtt{Expression}$ \u7c7b\n\n\u8bbe\u8ba1\u5982\u4e0b\u7684\u7c7b\u6210\u5458\uff1a\n\n* \u6210\u5458\u7c7b $\\mathtt{Element}$\uff0c\u7528\u4e8e\u50a8\u5b58\u4e00\u4e2a\u5143\u7d20\uff08\u6570\u5b57\u3001\u53d8\u91cf\u6216\u8fd0\u7b97\u7b26\uff09\uff1b\n  1. `int type`\uff1a\u7528\u4e8e\u50a8\u5b58\u8be5\u5143\u7d20\u662f\u6570\u5b57\uff08$0$\uff09\u3001\u53d8\u91cf\uff08$1$\uff09\u8fd8\u662f\u8fd0\u7b97\u7b26\uff08$2$\uff09\uff1b\n  2. `LL val`\uff1a\u5982\u679c\u662f\u6570\u5b57\uff0c\u5219\u5b58\u7684\u662f\u6570\u503c\uff0c\u5426\u5219\u5b58\u4e00\u4e2a\u5b57\u7b26\u7684 $\\text{ASCII}$ \u503c\u3002\n\n* `vector<Element> ele`\uff1a\u50a8\u5b58\u8be5\u8868\u8fbe\u5f0f\u7684\u540e\u7f00\u5f62\u5f0f\uff1b\n* `void read()`\uff1a\u7528\u4e8e\u8bfb\u5165\u4e00\u4e2a\u8868\u8fbe\u5f0f\u5e76\u8f6c\u5316\u4e3a\u540e\u7f00\u8868\u793a\u7684\u51fd\u6570\uff0c\u5b9e\u73b0\u53ef\u4ee5\u770b\u770b [P1175](https://www.luogu.com.cn/problem/P1175)\uff1b\n* `LL calculate()`\uff1a\u7528\u4e8e\u6839\u636e\u5df2\u50a8\u5b58\u540e\u7f00\u5f62\u5f0f\u8ba1\u7b97\u8868\u8fbe\u5f0f\u7684\u503c\uff0c\u5b9e\u73b0\u4ecd\u7136\u53ef\u4ee5\u770b\u770b [P1175](https://www.luogu.com.cn/problem/P1175)\uff1b\n\n### \u5b9e\u73b0 $\\mathtt{Statement}$ \u7c7b\n\n$\\mathtt{Statement}$ \u662f $\\mathtt{Assignment}$\u3001$\\mathtt{Loop}$\u3001$\\mathtt{Write}$ \u7c7b\u7684\u57fa\u7c7b\u3002\u8be5\u7c7b\u6ca1\u6709\u6210\u5458\u53d8\u91cf\uff0c\u5c3d\u7ba1\u5982\u6b64\uff0c\u8bbe\u8ba1\u4e00\u4e2a\u57fa\u7c7b\u4ecd\u7136\u80fd\u4f7f\u4e8b\u60c5\u53d8\u5f97\u7b80\u5355\u3002\n\n\u8bbe\u8ba1\u5982\u4e0b\u7684\u7eaf\u865a\u51fd\u6570\uff1a\n\n* `virtual void execute()`\uff1a\u6267\u884c\u8be5\u8bed\u53e5\uff0c\u5c06\u5728\u5b50\u7c7b\u4e2d\u5b9e\u73b0\u3002\n\n### \u5b9e\u73b0 $\\mathtt{Assignment}$ \u7c7b\n\n\u7ee7\u627f\u81ea $\\mathtt{Statement}$ \u7c7b\u3002\n\n\u8bbe\u8ba1\u5982\u4e0b\u7684\u7c7b\u6210\u5458\uff1a\n\n* `char left`\uff1a\u8d4b\u503c\u8bed\u53e5\u7684\u5de6\u503c\uff0c\u5373\u9700\u8981\u88ab\u8d4b\u503c\u7684\u53d8\u91cf\u540d\uff1b\n\n* `Expression right`\uff1a\u8d4b\u503c\u8bed\u53e5\u7684\u53f3\u503c\uff0c\u5373\u8d4b\u7ed9\u53d8\u91cf\u7684\u8868\u8fbe\u5f0f\u3002\n* `void execute()`\uff1a\u53ea\u6709\u4e00\u6761\u7b80\u6d01\u7684\u8bed\u53e5\uff0c`var[left]=right.calculate();`\uff1b\n\n### \u5b9e\u73b0 $\\mathtt{Write}$ \u7c7b\n\n\u7ee7\u627f\u81ea $\\mathtt{Statement}$ \u7c7b\u3002\n\n\u8bbe\u8ba1\u5982\u4e0b\u7684\u7c7b\u6210\u5458\uff1a\n\n* `Expression e`\uff1a\u50a8\u5b58\u9700\u8981\u8f93\u51fa\u7684\u8868\u8fbe\u5f0f\uff1b\n\n* `void execute()`\uff1a\u4ecd\u7136\u5f88\u7b80\u6d01\uff0c`printf(\"%lld\\n\",e,calculate());`\uff1b\n\n### \u5b9e\u73b0 $\\mathtt{Loop}$ \u7c7b\n\n\u7ee7\u627f\u81ea $\\mathtt{Statement}$ \u7c7b\u3002\n\n\u6bd4\u524d\u4e24\u8005\u590d\u6742\u51e0\u500d\uff08\u8bbe\u8ba1\u5982\u4e0b\u7684\u7c7b\u6210\u5458\uff1a\n\n* `vector<Statement*> sub`\uff1a\u50a8\u5b58\u5faa\u73af\u7684\u5b50\u8bed\u53e5\u3002\u4f7f\u7528\u57fa\u7c7b\u7684\u6307\u9488\u53ef\u4ee5\u4f7f\u5176\u652f\u6301\u6240\u6709\u6d3e\u751f\u7c7b\uff1b\n\n* `Expression tms`\uff1a\u50a8\u5b58\u5faa\u73af\u6b21\u6570\u7684\u8868\u8fbe\u5f0f\u3002\n\n* `void execute()`\uff1a\u4f9d\u6b21\u6267\u884c\u6bcf\u4e00\u6761\u8bed\u53e5\u5373\u53ef\n\n   ```cpp\n   int n=tms.calculate();\n   for(int i=1;i<=n;i++)\n       for(auto &j: sub)\n           j->execute();\n   ```\n\n\u8bfb\u5165\u90e8\u5206\u5199\u5728\u4e86\u7c7b\u7684\u6784\u9020\u51fd\u6570\u5185\u90e8\uff0c\u76f4\u63a5\u653e\u4ee3\u7801\u5427\uff1a\n\n```cpp\nbool con=false; //\u662f\u5426\u9047\u5230\u4e86continue\nint cnt=1; //\u9047\u5230continue\u65f6\u7684\u5806\u6808\uff0c\u7528\u4e8e\u627e\u5230\u6b63\u786e\u7684end\ntms=x; //\u8bf7\u7a0d\u540e\u7ed3\u5408\u5b8c\u6574\u4ee3\u7801\u7406\u89e3\nif(!x)\ttms.read();\nwhile(true)\n{\n\tif(con)\n\t{\n\t\twhile((str[0]=getchar())<33); //\u8fc7\u6ee4\u7a7a\u683c\n\t\tfor(int i=0;;str[++i]=getchar()) //\u8bfb\u5165\u4e00\u4e2a\u4e32\n\t\t\tif(str[i]<33)\n\t\t\t\t{ str[i]='\\0';break; }\n\t\tstr[4]='\\0'; //\u4ec5\u9700\u622a\u53d6\u4e32\u7684\u524d4\u4f4d\n\t\tif(!strcmp(str,\"loop\"))\tcnt++; //\u5806\u6808+1\n\t\tif(!strcmp(str,\"end\"))\tcnt--; //\u5806\u6808-1\n\t\tif(!cnt)\tbreak; //\u5806\u6808\u4f4d0\uff0c\u5373\u627e\u5230\u4e86\u81ea\u5df1\u7684end\n\t\tcontinue;\n\t}\n\twhile((str[0]=getchar())<33);\n\tfor(int i=1;;i++)\n\t{\n\t\tstr[i]=getchar();\n\t\tif(str[i]=='=' || str[i]<33) //\u5b57\u7b26\u4e32\u5230'='\u6216\u8005\u7a7a\u683c\u7ed3\u675f\n\t\t\t{ str[i]='\\0';break; }\n\t}\n\tif(!strcmp(str,\"end\")) // \u5404\u79cd\u60c5\u51b5\u5206\u522b\u8ba8\u8bba\n\t\tbreak;\n\telse if(!str[1])\n\t\tsub.push_back(new Assignment(str[0])); //Assignment\u7c7b\u5728\u6784\u9020\u51fd\u6570\u5185\u5199\u4e86\u8bfb\u5165\uff0cWrite\u4e5f\u662f\n\telse if(!strcmp(str,\"continue\"))\n\t\tcon=true;\n\telse if(!strcmp(str,\"break\"))\n\t\tcon=true,tms=1; //break\u7684\u6548\u679c\u5176\u5b9e\u548ccontinue\u4e00\u6837\uff0c\u90fd\u662f\u65e0\u89c6\u540e\u9762\u7684\u8bed\u53e5\n\t\t\t\t\t\t//\u4f46\u662f\u540c\u65f6\u9700\u8981\u628a\u5faa\u73af\u6b21\u6570\u8bbe\u7f6e\u4e3a1\uff08Expression\u7c7b\u91cd\u8f7d\u4e86=\u8fd0\u7b97\u7b26\uff09\n\telse if(!strcmp(str,\"loop\"))\n\t\tsub.push_back(new Loop());\n\telse if(!strcmp(str,\"write\"))\n\t\tsub.push_back(new Write());\n}\n```\n\n## \u5b8c\u6574\u4ee3\u7801\n\n\u8fd8\u662f\u6bd4\u8f83\u597d\u7406\u89e3\u7684\n\n\u8fd9\u662f $92ms$ \u7684\u4ee3\u7801\uff0c\u6539\u4e3a\u624b\u5de5\u6808\u5c31\u6709\u4e86 $38ms$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\nint var[256],pri[256];\nclass Expression\n{\n private:\n\tstruct Element\n\t{\n\t\tLL val;\n\t\tint type; //0:number, 1:variable, 2:operator\n\t\tElement(): val(0){}\n\t\tElement(int t,int x): val(x),type(t){}\n\t\tinline int operator()()\n\t\t\t{ return type?var[val]:val; }\n\t};\n\tvector<Element> ele;\n public:\n\tExpression(): ele(){}\n\tvoid read()\n\t{\n\t\tstack<Element> s;\n\t\tele.clear();\n\t\tchar ch;\n\t\twhile((ch=getchar())<33);\n\t\twhile(ch>32)\n\t\t{\n\t\t\tElement x;\n\t\t\tif(ch>='0' && ch<='9')\n\t\t\t{\n\t\t\t\tx.type=0;\n\t\t\t\tdo\n\t\t\t\t\tx.val=x.val*10+ch-'0',ch=getchar();\n\t\t\t\twhile(ch>='0' && ch<='9');\n\t\t\t\tele.push_back(x);\n\t\t\t}\n\t\t\telse if(ch>='a' && ch<='z')\n\t\t\t{\n\t\t\t\tx.type=1,x.val=ch;\n\t\t\t\tele.push_back(x),ch=getchar();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tx.type=2,x.val=ch;\n\t\t\t\tif(s.empty() || x.val=='(' || s.top().val==')')\n\t\t\t\t\ts.push(x);\n\t\t\t\telse if(x.val==')')\n\t\t\t\t{\n\t\t\t\t\twhile(s.top().val!='(')\n\t\t\t\t\t\tele.push_back(s.top()),s.pop();\n\t\t\t\t\ts.pop();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\twhile(!s.empty() && pri[ch]<=pri[s.top().val])\n\t\t\t\t\t\tele.push_back(s.top()),s.pop();\n\t\t\t\t\ts.push(x);\n\t\t\t\t}\n\t\t\t\tch=getchar();\n\t\t\t}\n\t\t}\n\t\twhile(!s.empty())\tele.push_back(s.top()),s.pop();\n\t\tele.shrink_to_fit();\n\t}\n\tLL calculate()\n\t{\n\t\tstack<Element> s;\n\t\tfor(auto &i: ele)\n\t\t{\n\t\t\tif(i.type==2)\n\t\t\t{\n\t\t\t\tint x=s.top()();s.pop();\n\t\t\t\tint y=s.top()();s.pop();\n\t\t\t\tif(i.val=='+')\n\t\t\t\t\ts.push(Element(0,x+y));\n\t\t\t\telse if(i.val=='-')\n\t\t\t\t\ts.push(Element(0,y-x));\n\t\t\t\telse if(i.val=='*')\n\t\t\t\t\ts.push(Element(0,x*y));\n\t\t\t\telse\n\t\t\t\t\ts.push(Element(0,y/x));\n\t\t\t}\n\t\t\telse\ts.push(i);\n\t\t}\n\t\treturn s.top()();\n\t}\n\tvoid operator =(LL x)\n\t\t{ ele.clear(),ele.push_back(Element(0,x)); }\n};\nclass Statement\n{\n private:\n\tint type;\n public:\n\tStatement()=default;\n\tvirtual void execute()=0;\n};\nclass Assignment: public Statement\n{\n private:\n\tchar left;\n\tExpression right;\n public:\n\tAssignment(char ch): left(ch),right()\n\t\t{ right.read(); }\n\tvoid execute()\n\t\t{ var[left]=right.calculate(); }\n};\nclass Write: public Statement\n{\n private:\n\tExpression e;\n public:\n\tWrite(): e()\n\t\t{ e.read(); }\n\tvoid execute()\n\t\t{ printf(\"%lld\\n\",e.calculate()); }\n};\nchar str[1005];\nclass Loop: public Statement\n{\n private:\n\tvector<Statement*> sub;\n\tExpression tms;\n public:\n\tLoop(int x=0): sub()\n\t{\n\t\tbool con=false;\n\t\tint cnt=1;\n\t\ttms=x;\n\t\tif(!x)\ttms.read();\n\t\twhile(true)\n\t\t{\n\t\t\tif(con)\n\t\t\t{\n\t\t\t\twhile((str[0]=getchar())<33);\n\t\t\t\tfor(int i=0;;str[++i]=getchar())\n\t\t\t\t\tif(str[i]<33)\n\t\t\t\t\t\t{ str[i]='\\0';break; }\n\t\t\t\tstr[4]='\\0';\n\t\t\t\tif(!strcmp(str,\"loop\"))\tcnt++;\n\t\t\t\tif(!strcmp(str,\"end\"))\tcnt--;\n\t\t\t\tif(!cnt)\tbreak;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\twhile((str[0]=getchar())<33);\n\t\t\tfor(int i=1;;i++)\n\t\t\t{\n\t\t\t\tstr[i]=getchar();\n\t\t\t\tif(str[i]=='=' || str[i]<33)\n\t\t\t\t\t{ str[i]='\\0';break; }\n\t\t\t}\n\t\t\tif(!strcmp(str,\"end\"))\n\t\t\t\tbreak;\n\t\t\telse if(!str[1])\n\t\t\t\tsub.push_back(new Assignment(str[0]));\n\t\t\telse if(!strcmp(str,\"continue\"))\n\t\t\t\tcon=true;\n\t\t\telse if(!strcmp(str,\"break\"))\n\t\t\t\tcon=true,tms=1;\n\t\t\telse if(!strcmp(str,\"loop\"))\n\t\t\t\tsub.push_back(new Loop());\n\t\t\telse if(!strcmp(str,\"write\"))\n\t\t\t\tsub.push_back(new Write());\n\t\t}\n\t}\n\tvoid execute()\n\t{\n\t\tint n=tms.calculate();\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tfor(auto &j: sub)\n\t\t\t\tj->execute();\n\t}\n};\nint main()\n{\n\tpri['*']=pri['/']=2,pri['+']=pri['-']=1;\n\twhile(getchar()!='\\n');\n\tLoop main_proc(1);\n\tmain_proc.execute();\n\treturn 0;\n}\n```\n",
        "postTime": 1629777539,
        "uid": 279800,
        "name": "ExplodingKonjac",
        "ccfLevel": 7,
        "title": "\u3010\u9898\u89e3\u3011P2229 [HNOI2002]\u6c99\u6f20\u5bfb\u5b9d"
    },
    {
        "content": "## \u9047\u5230\u7684\u95ee\u9898\n\n\u4e00\u770b\u8fd9\u4e2a\u9898\u5c31\u77e5\u9053\u662f\u6a21\u62df\uff0c\u4f46\u662f\u600e\u4e48\u6a21\u62df\u5462\uff1f\n\n\u9996\u5148\uff0c\u8bfb\u5165\u4e0e\u5b58\u50a8\u95ee\u9898\uff0c\u5982\u4f55\u51c6\u786e\u7684\u8bfb\u5165\u4ee5\u53ca\u5982\u4f55\u5c06\u8f93\u5165\u7684\u4ee3\u7801\u5b58\u8d77\u6765\u3002\n\n\u5176\u6b21\uff0c\u4e5f\u662f\u6700\u96be\u7684\uff0c\u6a21\u62df\u7a0b\u5e8f\u8fd0\u884c\uff0c\u5176\u4e2d\u6700\u5173\u952e\u7684\u5c31\u662f\u5982\u4f55\u6a21\u62df\u5faa\u73af\u7684\u8fd0\u884c\u3002\n\n\u518d\u8005\uff0c\u8ba1\u7b97\u5668\u7684\u95ee\u9898\uff0c\u8d4b\u503c\u8bed\u53e5\u4e0e\u5faa\u73af\u6b21\u6570\u7684\u8ba1\u7b97\u3002\n## \u89e3\u51b3\u65b9\u6848\n\n- 1.\u8bfb\u5165\u4e0e\u5b58\u50a8\uff0c\u5f00\u4e00\u4e2a\u4e8c\u7ef4\u7684\u6570\u7ec4\uff0c\u8f93\u5165\u9047\u5230\u7a7a\u683c\u8df3\u8fc7\u3002\n\n- 2.\u8fd0\u884c\u8fc7\u7a0b\uff0c\u5176\u4ed6\u8bed\u53e5\u4e0d\u591a\u8bf4\uff0c\u5c31\u8bb2\u8bb2\u6700\u5173\u952e\u7684\u5faa\u73af\u8bed\u53e5\u5427\uff0c\u770b\u5230\u6709\u5f88\u591a\u5927\u4f6c\u90fd\u662f\u7528\u6808\u6765\u6a21\u62df\uff0c\u4e2a\u4eba\u4e0d\u592a\u4e60\u60ef\u7528\u6808\u6a21\u62df\uff0c\u4e8e\u662f\u7528\u4e86\u7c7b\u4f3c\u4e8e\u9012\u5f52\u7684\u65b9\u6cd5\uff0c\u4e00\u5c42\u5c42\u8fdb\u5165\uff0c\u518d\u9000\u51fa\u3002\n\n- 3.\u6709\u5173\u8ba1\u7b97\u5668,\u5b8c\u5168\u53ef\u4ee5\u4f7f\u7528\u9012\u5f52\u4ee3\u66ff\u6808\u6765\u5199\uff0c\u5e76\u4e14\u5b8c\u5168\u4e0d\u7528\u62c5\u5fc3\u4f1a\u8d85\u65f6\u3002\n\n**\u6700\u540e\u9644\u4e0aAC\u4ee3\u7801\uff0c\u4ee3\u7801\u4e2d\u6709\u89e3\u91ca**\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#include <string>\n#include <cmath>\n#include <algorithm>\n#define MAXN 1001\nusing namespace std;\n\n//\u51fd\u6570\u603b\u89c8\uff0c\u540e\u9762\u6709\u89e3\u91ca\nvoid read();\nvoid work();\nvoid find();\nvoid write(char x[]);\nint check(char x[]);\nvoid run(char x[]);\nvoid pre(char x[],int l,int r);\nint calc(char x[],int l,int r);\nvoid run_loo(char x[]);\nint run_fu(char x[],int in,int enk);\n\nchar str[MAXN][MAXN],s[MAXN];\nint tot=0,h=1,f[MAXN],ff[MAXN],sh[30];\nconst int sta=1,en=2,loo=3,con=4,wri=5,bre=6,fu=7;\n\n//\u8bfb\u5165\uff0c\u5904\u7406\u6389\u7a7a\u683c\nvoid read(){\n    while((scanf(\"%s\",s))!=EOF){\n        if(s[0]!=' '){\n            strcpy(str[++tot],s);\n        }\n    }\n}\n\n//\u8f93\u51fa\nvoid run_wri(char x[]){\n    ++h;\n    printf(\"%d\\n\",run_fu(str[h],0,strlen(str[h])-1));\n}\n\n//\u9884\u5904\u7406\uff0c\u627e\u5230\u5faa\u73af\u7684\u5f00\u59cb\u4e0e\u7ed3\u675f\nvoid find(){\n    int v[MAXN],v1=0;\n    for(int i=2;i<tot;i++){\n        if(check(str[i])==loo){\n            v1++;\n            v[v1]=i;\n        }else if(check(str[i])==en){\n            f[v[v1]]=i;\n            v1--;\n        }\n    }\n}\n\n//\u5faa\u73af\u8bed\u53e5\u7684\u9012\u5f52\u5b9e\u73b0\nvoid run_loo(char x[]){\n    ++h;\n    int t=run_fu(str[h],0,strlen(str[h])-1),tmp=h-1;\n    for(int i=1;i<=t;i++){\n        ++h;\n        while(check(str[h])!=en){\n            if(check(str[h])==loo){\n                run_loo(x);\n            }else if(check(str[h])==con){\n                break;\n            }else if(check(str[h])==bre){\n                h=f[tmp];\n                return;\n            }\n            run(str[h]);\n            ++h;\n        }\n        h=tmp+1;\n    }\n    h=f[tmp];\n}\n\n//\u6bcf\u6b21\u4f7f\u7528\u8ba1\u7b97\u5668\u4e4b\u524d\u7684\u9884\u5904\u7406\uff0c\u4e3a\u4e86\u5904\u7406\u8868\u8fbe\u5f0f\u4e2d\u6709\u62ec\u53f7\u5339\u914d\u7684\u60c5\u51b5\nvoid pre(char x[],int l,int r){\n    int v[MAXN],tot=0;\n    for(int i=l;i<=r;++i){\n        if(x[i]=='('){\n            v[++tot]=i;\n        }else if(x[i]==')'){\n            ff[v[tot]]=i;\n            --tot;\n        }\n    }\n}\n\n//\u9012\u5f52\u5b9e\u73b0\u7b80\u5355\u8ba1\u7b97\u5668\nint calc(char x[],int l,int r){\n    if(l==r&&x[l]>='a'&&x[l]<='z') return sh[x[l]-'a'];\n    if(x[l]=='('&&x[r]==')'&&ff[l]==r){\n        return calc(x,l+1,r-1);\n    }\n    int jia=0,cheng=0,isjia=0,ischeng=0,fa=0,isfa=0;\n    for(int i=l;i<=r;++i){\n        if(x[i]=='+') jia=i,isjia=1;\n        else if(x[i]=='*') cheng=i,ischeng=1;\n        else if(x[i]=='/') cheng=i,ischeng=0;\n        else if(x[i]=='-') jia=i,isjia=0;\n        else if(x[i]=='^') isfa=1,fa=i;\n        else if(x[i]=='(') i=ff[i]-1;\n    }\n    if(jia!=0){\n        if(isjia==1) return (calc(x,l,jia-1)+calc(x,jia+1,r));\n        else return (calc(x,l,jia-1)-calc(x,jia+1,r));\n    }else if(cheng!=0){\n        if(ischeng==1) return (calc(x,l,cheng-1)*calc(x,cheng+1,r));\n        else return (calc(x,l,cheng-1)/calc(x,cheng+1,r));\n    }else if(isfa!=0){\n        return (int)pow(calc(x,l,fa-1)*1.0,calc(x,fa+1,r)*1.0);\n    }else if(jia==0&&cheng==0&&isfa==0){\n        int tmp=0;\n        for(int i=l;i<=r;++i){\n            tmp=(tmp*10+(x[i]-'0'));\n        }\n        return tmp;\n    }\n}\n\n//\u8d4b\u503c\u8bed\u53e5\u7684\u8fd0\u884c\uff0c\u8c03\u7528calc()\u51fd\u6570\u8ba1\u7b97\nint run_fu(char x[],int in,int enk){\n    memset(ff,0,sizeof(ff));\n    pre(x,in,enk);\n    int res=calc(x,in,enk);\n    return res;\n}\n\n//\u5224\u65ad\u662f\u54ea\u4e00\u79cd\u8bed\u53e5\nint check(char x[]){\n    if(x[1]=='='){\n        return fu;\n    }else if(x[0]=='s'){\n        return sta;\n    }else if(x[0]=='e'&&x[1]=='n'){\n        return en;\n    }else if(x[0]=='l'&&x[1]=='o'){\n        return loo;\n    }else if(x[0]=='c'&&x[1]=='o'){\n        return con;\n    }else if(x[0]=='w'&&x[1]=='r'){\n        return wri;\n    }else if(x[0]=='b'&&x[1]=='r'){\n        return bre;\n    }else{\n        return -1;\n    }\n}\n\n//\u8fd0\u884c\u6bcf\u4e00\u53e5\u8bed\u53e5\nvoid run(char x[]){\n    int k=check(x);\n    switch(k){\n        case 3:run_loo(x); break;\n        case 5:run_wri(x); break;\n        case 7:sh[x[0]-'a']=run_fu(x,2,strlen(x)-1); break;\n        default:break;\n    }\n}\n\n//\u5faa\u73af\u6bcf\u4e00\u53e5\u8bed\u53e5\nvoid work(){\n    while(h<=tot){\n        run(str[h]);\n        ++h;\n    }\n}\n\nint main(){ \n    read();\n    find();\n    work();\n    return 0;\n}\n```\n",
        "postTime": 1628598876,
        "uid": 470001,
        "name": "zbwcom",
        "ccfLevel": 0,
        "title": "P2229 [HNOI2002]\u6c99\u6f20\u5bfb\u5b9d \u9898\u89e3"
    },
    {
        "content": "\u8fd9\u9898\u4e00\u770b\u5c31\u77e5\u9053\u662f\u4e2a\u6a21\u62df\u3002\n\n\u505a\u6a21\u62df\u9898\u7684\u65f6\u5019\uff0c\u4e00\u5b9a\u8981\u5148\u786e\u4fdd\u4f60\u7684\u7a0b\u5e8f\u80fd\u8dd1\u51fa\u6b63\u786e\u7684\u7ed3\u679c\uff0c\u518d\u53bb\u60f3\u4f18\u5316\u65f6\u95f4\u3002\n\n\u8fd9\u9053\u9898\u8fd8\u662f\u5f88\u7b80\u5355\u7684\uff0c\u8ba9\u6211\u4eec\u5f00\u59cb\u5427\uff1a\n\n### \u8bfb\u5165\n\u6211\u4eec\u628a\u8f93\u5165\u79bb\u7ebf\uff0c\u62ff `string` \u5b58\u8d77\u6765\u3002\u5982\u679c\u4e0d\u79bb\u7ebf\uff0c\u90a3 `loop` \u5c31\u4f1a\u5f88\u96be\u5904\u7406\uff0c\u52a0\u5927\u96be\u5ea6\u3002\n```cpp\nint n;\nstring a[1010];//\u4eb2\u6d4b\u6700\u591a\u53ea\u4f1a\u6709 1000 \u6761\u8bed\u53e5\n\nwhile(cin>>a[++n]);n--;\n```\n\n### \u9884\u5904\u7406\n\u6211\u4eec\u53ef\u4ee5\u5148\u9884\u5904\u7406\u6bcf\u4e2a `start` \u548c `loop` \u5bf9\u5e94\u7684 `end` \u7684\u4f4d\u7f6e\u3002\u8fd9\u6837\u505a\u7684\u539f\u56e0\u4f1a\u5728\u540e\u9762\u8bf4\u3002\n\n```cpp\nint jump[1010];\nstack<int> init;\nfor(int i=1;i<=n;i++){\n\tif(a[i]==\"start\"||a[i]==\"loop\") init.push(i);//\u5982\u679c\u662f start/loop\uff0c\u628a\u7f16\u53f7\u538b\u5165\u6808\n\tif(a[i]==\"end\") jump[init.top()]=i,init.pop();//\u5982\u679c\u662f end\uff0c\u6807\u8bb0\u4f4d\u7f6e\n}\n```\n\n### \u8fd0\u884c\u4ee3\u7801\n\u5b9a\u4e49\u4e00\u4e2a `int run(int now)` \u51fd\u6570\uff0c\u4f7f\u7528\u9012\u5f52\u5b9e\u73b0\uff0c$now$ \u8868\u793a\u4ece\u54ea\u6761\u8bed\u53e5\u5f00\u59cb\u8fd0\u884c\uff0c\u8fd4\u56de\u503c\u8868\u793a\u6700\u7ec8\u6267\u884c\u5230\u54ea\u6761\u8bed\u53e5\u3002\n\n\u4f46\u6211\u4eec\u8981\u8003\u8651\u4e00\u4e2a\u95ee\u9898\uff1a\u9047\u5230 `break` \u8be5\u8fd4\u56de\u4ec0\u4e48\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u8fd4\u56de $-1$\uff0c\u7136\u540e\u7279\u5224\u4e00\u4e0b\u3002\n\n```cpp\nint run(int now){\n\tfor(int i=now;i<=n;i++){\n\t\tif(a[i]==\"write\"){\n        //write\uff1a\u8f93\u51fa\u4e00\u4e2a\u8868\u8fbe\u5f0f\u7684\u503c\u5e76\u6362\u884c\n        //\u90a3\u5c31\u8f93\u51fa a[i+1] \u8fd9\u4e2a\u8868\u8fbe\u5f0f\u7684\u503c\u54af\n\t\t\ti++;\n\t\t\tcout<<calc(a[i])<<endl;//\u8fd9\u4e2a calc \u662f\u8ba1\u7b97\u51fd\u6570\uff0c\u540e\u9762\u8bb2\n\t\t}else if(a[i]==\"loop\"){\n        //loop\uff1a\u5faa\u73af\u8bed\u53e5\uff0c\u6267\u884c a[i+1] \u6b21\n        //\u90a3\u5c31\u9012\u5f52\u5b9e\u73b0\n\t\t\ti++;\n\t\t\tint times=calc(a[i]);\n\t\t\tfor(int j=1;j<=times;j++){\n\t\t\t\tint tmp=run(i+1);\n\t\t\t\tif(tmp==-1) break;//\u8fd4\u56de -1 \u8bf4\u660e\u662f break\uff0c\u5916\u5c42 loop \u4e5f\u8ddf\u7740 break \n\t\t\t}\n\t\t\ti=jump[i-1];//jump \u7684\u4f5c\u7528\uff0c\u8df3\u5230\u8fd9\u4e2a loop \u540e\u9762\n\t\t}else if(a[i]==\"break\"){\n\t\t\treturn -1;//\u8fd4\u56de -1\uff0c\u4ee3\u8868\u81ea\u5df1\u662f break\n\t\t}else if(a[i]==\"continue\"){ \n\t\t\treturn jump[now-2];//\u8fd4\u56de\u8fd9\u4e2a\u8fd9\u4e2a loop \u5bf9\u5e94\u7684 end \u7684\u4f4d\u7f6e\n\t\t}else if(a[i]==\"end\"){\n\t\t\treturn i;//\u540c continue\n\t\t}else if(a[i]==\"start\"){\n\t\t\t//\u4ec0\u4e48\u4e5f\u4e0d\u505a\u54c8\u54c8\u54c8\n\t\t}else{//\u90fd\u4e0d\u662f\uff0c\u90a3\u5c31\u662f\u8d4b\u503c\u8bed\u53e5\n\t\t\tint tmp=calc(a[i].substr(2));//substr(2) \u8868\u793a\u4ece 2 \u8fd9\u4e2a\u4f4d\u7f6e\u540e\u9762\u7684\u6240\u6709\u5b57\u7b26\n\t\t\tm[a[i][0]-'a']=tmp;//\u8d4b\u503c\n\t\t}\n\t}\n\treturn n;\n}\n```\n\n### \u8ba1\u7b97\u8868\u8fbe\u5f0f\n\u8fd9\u90e8\u5206\u53ef\u4ee5\u770b [link](https://blog.csdn.net/sinat_27908213/article/details/80273557)\uff0c\u7167\u7740\u4ed6\u7684\u4ee3\u7801\u6253\u4e00\u904d\u5c31\u597d\u4e86\u3002\n```cpp\nint lev(char a){//\u4f18\u5148\u7ea7\n\tswitch(a){\n\t\tcase '(':return 0;\n\t\tcase '+':case '-':return 1;\n\t\tcase '*':case '/':return 2;\n\t\tcase ')':return 3;\n\t}\n\treturn 0;\n}\nvoid plu(stack<int> &s,char op){//\u9700\u8981\u6ce8\u610f\uff0cplus \u662f STL \u51fd\u6570\n\tint num1,num2;\n\tnum2=s.top(),s.pop();\n\tnum1=s.top(),s.pop();\n\tswitch(op){\n\t\tcase '+':s.push(num1+num2);return ;\n\t\tcase '-':s.push(num1-num2);return ;\n\t\tcase '*':s.push(num1*num2);return ;\n\t\tcase '/':s.push(num1/num2);return ;\n\t}\n}\nint calc(string a){//\u8ba1\u7b97\u51fd\u6570\n\tstack<int> s1,s2;\n\tfor(int i=0;i<a.size();i++){\n\t\tif('a'<=a[i]&&a[i]<='z') s1.push(m[a[i]-'a']);//\u5904\u7406\u53d8\u91cf\n\t\telse if('0'<=a[i]&&a[i]<='9'){//\u6570\u5b57\n\t\t\tint tmp=a[i]-48,j=i+1;\n\t\t\twhile(j<a.size()&&'0'<=a[j]&&a[j]<='9') tmp=tmp*10-48+a[j],j++;\n\t\t\ts1.push(tmp),i=j-1;\n\t\t}else if(a[i]=='+'||a[i]=='-'||a[i]=='*'||a[i]=='/'){//\u52a0\u51cf\u4e58\u9664\n\t\t\tif(s2.empty()) s2.push(a[i]);\n\t\t\telse{\n\t\t\t\twhile(!s2.empty()&&lev(s2.top())>=lev(a[i])){\n\t\t\t\t\tplu(s1,s2.top());\n\t\t\t\t\ts2.pop();\n\t\t\t\t}\n\t\t\t\ts2.push(a[i]);\n\t\t\t}\n\t\t}else{//\u62ec\u53f7\n\t\t\tif(a[i]=='(') s2.push(a[i]);\n\t\t\telse{\n\t\t\t\twhile(s2.top()!='('){\n\t\t\t\t\tplu(s1,s2.top());\n\t\t\t\t\ts2.pop();\n\t\t\t\t}\n\t\t\t\ts2.pop();\n\t\t\t}\n\t\t}\n\t}\n\twhile(!s2.empty()){\n\t\tplu(s1,s2.top());\n\t\ts2.pop();\n\t}\n\treturn s1.top();\n}\n```\n\n### \u6574\u5408\n\u628a\u4e0a\u9762\u7684\u4ee3\u7801\u7ed3\u5408\u5728\u4e00\u8d77\u5c31\u80fd A \u4e86\u3002\n\n\u5b8c\u6574\u4ee3\u7801\uff1a\n```cpp\n#pragma GCC optimize(2)\n//\u8fd9\u7bc7\u9898\u89e3\u5e38\u6570\u5f88\u5927\uff0c\u4f1a TLE on #5\uff0c\u9700\u8981 O2 \u4f18\u5316 \n#include <stack>\n#include <string>\n#include <iostream>\n#include <queue>\nusing namespace std;\nstring a[1010];\nint n,m[30],jump[1010];\nint lev(const char &a){\n\tswitch(a){\n\t\tcase '(':return 0;\n\t\tcase '+':case '-':return 1;\n\t\tcase '*':case '/':return 2;\n\t\tcase ')':return 3;\n\t}\n\treturn 0;\n}\nvoid plu(stack<int> &s,const char &op){\n\tint num1,num2;\n\tnum2=s.top(),s.pop();\n\tnum1=s.top(),s.pop();\n\tswitch(op){\n\t\tcase '+':s.push(num1+num2);return ;\n\t\tcase '-':s.push(num1-num2);return ;\n\t\tcase '*':s.push(num1*num2);return ;\n\t\tcase '/':s.push(num1/num2);return ;\n\t}\n}\nint calc(const string &a){\n\tstack<int> s1,s2;\n\tfor(int i=0;i<a.size();i++){\n\t\tif('a'<=a[i]&&a[i]<='z') s1.push(m[a[i]-'a']);\n\t\telse if('0'<=a[i]&&a[i]<='9'){\n\t\t\tint tmp=a[i]-48,j=i+1;\n\t\t\twhile(j<a.size()&&'0'<=a[j]&&a[j]<='9') tmp=tmp*10-48+a[j],j++;\n\t\t\ts1.push(tmp),i=j-1;\n\t\t}\n\t\telse if(a[i]=='+'||a[i]=='-'||a[i]=='*'||a[i]=='/'){\n\t\t\tif(s2.empty()) s2.push(a[i]);\n\t\t\telse{\n\t\t\t\twhile(!s2.empty()&&lev(s2.top())>=lev(a[i])){\n\t\t\t\t\tplu(s1,s2.top());\n\t\t\t\t\ts2.pop();\n\t\t\t\t}\n\t\t\t\ts2.push(a[i]);\n\t\t\t}\n\t\t}else{\n\t\t\tif(a[i]=='(') s2.push(a[i]);\n\t\t\telse{\n\t\t\t\twhile(s2.top()!='('){\n\t\t\t\t\tplu(s1,s2.top());\n\t\t\t\t\ts2.pop();\n\t\t\t\t}\n\t\t\t\ts2.pop();\n\t\t\t}\n\t\t}\n\t}\n\twhile(!s2.empty()){\n\t\tplu(s1,s2.top());\n\t\ts2.pop();\n\t}\n\treturn s1.top();\n}\nint run(const int &now){\n\tfor(int i=now;i<=n;i++){\n\t\tif(a[i]==\"write\"){\n\t\t\ti++;\n\t\t\tcout<<calc(a[i])<<endl;\n\t\t}else if(a[i]==\"loop\"){\n\t\t\ti++;\n\t\t\tint times=calc(a[i]);\n\t\t\tfor(int j=1;j<=times;j++){\n\t\t\t\tint tmp=run(i+1);\n\t\t\t\tif(tmp==-1) break;\n\t\t\t}\n\t\t\ti=jump[i-1];\n\t\t}else if(a[i]==\"break\"){\n\t\t\treturn -1;\n\t\t}else if(a[i]==\"continue\"){\n\t\t\treturn jump[now-2];\n\t\t}else if(a[i]==\"end\"){\n\t\t\treturn i;\n\t\t}else if(a[i]==\"start\"){\n\t\t\t//f**k ccf\n\t\t}else{\n\t\t\tint tmp=calc(a[i].substr(2));\n\t\t\tm[a[i][0]-'a']=tmp;\n\t\t}\n\t}\n\treturn n;\n}\nstack<int> init;\nint main(){\n    ios::sync_with_stdio(0),cin.tie(0);\n\twhile(cin>>a[++n]);n--;\n\tfor(int i=1;i<=n;i++){\n\t\tif(a[i]==\"start\"||a[i]==\"loop\") init.push(i);\n\t\tif(a[i]==\"end\") jump[init.top()]=i,init.pop();\n\t}\n\trun(1);\n\treturn 0;\n}\n```",
        "postTime": 1622520915,
        "uid": 390033,
        "name": "_caiji_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P2229 \u3010[HNOI2002]\u6c99\u6f20\u5bfb\u5b9d\u3011"
    }
]
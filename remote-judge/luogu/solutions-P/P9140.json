[
    {
        "content": "\u540c\u4f59\u6700\u77ed\u8def\u8fd8\u5728\u5199\u6700\u77ed\u8def\uff1f\u611f\u89c9\u4e0d\u5982\u8f6c\u5708\uff01\n\n\u4f17\u6240\u5468\u77e5\uff0c\u5728\u540c\u4f59\u6700\u77ed\u8def\u7b97\u6cd5\u4e2d\uff0c\u6211\u4eec\u9009\u53d6\u4e00\u4e2a\u57fa\u51c6\u7269\u54c1\u7684\u4f53\u79ef\u4f5c\u4e3a\u6a21\u6570 $m$\uff0c\u5e76\u5bf9\u5176\u5b83\u7269\u54c1\u7684\u4f53\u79ef $v_i$ \u548c\u6240\u6709 $0\\leq i < m$\uff0c\u4ece $i$ \u5411 $(i + v_i)\\bmod m$ \u8fde\u6743\u503c\u4e3a $v_i$ \u7684\u8fb9\uff0c\u8dd1\u6700\u77ed\u8def\u3002\n\n### \u7b97\u6cd5\u4ecb\u7ecd\n\n\u5b9e\u9645\u4e0a\uff0c\u5b58\u5728\u7b80\u5355\u7684\u4e0d\u9700\u8981\u6700\u77ed\u8def\u7684\u505a\u6cd5\u3002\n\n\u4e0d\u8981\u4ece\u56fe\u8bba\u7684\u89d2\u5ea6\u8003\u8651\u95ee\u9898\uff0c\u800c\u662f\u56de\u5f52\u672c\u6e90\uff1a\u5b8c\u5168\u80cc\u5305\u3002\u66f4\u5177\u4f53\u5730\uff0c**\u4f53\u79ef\u6a21 $m$ \u610f\u4e49\u4e0b\u7684\u5b8c\u5168\u80cc\u5305**\u3002\u5bf9\u4e8e\u4f53\u79ef\u4e3a $v_i$ \u7684\u7269\u54c1\uff0c\u5b83\u5728\u957f\u5ea6\u4e3a $m$ \u7684\u73af\u4e0a\u5f62\u6210 $d = \\gcd(v_i, m)$ \u4e2a\u5b50\u73af\u3002\u4ece\u4e00\u4e2a\u70b9\u51fa\u53d1\uff0c\u4e0d\u53ef\u80fd\u7ed5\u7740\u5b50\u73af\u8d70\u4e00\u5708\u518d\u8f6c\u79fb\u56de\u5230\u8be5\u70b9\uff0c\u56e0\u4e3a\u6700\u77ed\u8def\u4e0d\u4f1a\u7ecf\u8fc7\u540c\u4e00\u4e2a\u70b9\u4e24\u6b21\uff0c\u5426\u5219\u5b58\u5728\u8d1f\u73af\u3002\u53e6\u4e00\u79cd\u7406\u89e3\u65b9\u5f0f\u662f\uff0c\u5982\u679c\u7ed5\u7740\u73af\u8d70\u4e86\u4e00\u5708\uff0c\u76f8\u5f53\u4e8e\u9009\u62e9\u4e86 $\\frac m d$ \u4e2a\u4f53\u79ef\u4e3a $v_i$ \u7684\u7269\u54c1\uff0c\u800c\u8fd9\u4e9b\u7269\u54c1\u53ef\u4ee5\u66ff\u6362\u4e3a\u82e5\u5e72\u57fa\u51c6\u7269\u54c1\u800c\u88ab\u5ffd\u7565\uff0c\u4f7f\u5f97\u603b\u4f53\u79ef\u66f4\u5c0f\u3002\u8fdb\u4e00\u6b65\u5730\uff0c**\u5982\u679c\u91cd\u590d\u7ecf\u8fc7\u540c\u4e00\u4e2a\u70b9\uff0c\u90a3\u4e48\u53ef\u4ee5\u5c06\u8fd9\u4e24\u6b21\u7ecf\u8fc7\u4e4b\u95f4\u52a0\u5165\u7684\u6240\u6709\u7269\u54c1\u66ff\u6362\u4e3a\u82e5\u5e72\u57fa\u51c6\u7269\u54c1**\u3002\n\n\u56e0\u6b64\uff0c\u5f80\u80cc\u5305\u52a0\u5165\u4f53\u79ef\u4e3a $v_i$ \u7684\u7269\u54c1\u65f6\uff0c\u81f3\u591a\u52a0\u5165 $\\frac {m} {\\gcd(v_i, m)} - 1$ \u4e2a\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5b50\u73af\uff0c\u6211\u4eec\u7ed5\u7740\u8fd9\u4e2a\u73af\u8f6c\u4e24\u5708\uff0c\u5373\u53ef\u8003\u8651\u5230\u6240\u6709\u8f6c\u79fb\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u70b9\u90fd\u8f6c\u79fb\u5230\u4e86\u5b50\u73af\u4e0a\u7684\u5176\u5b83\u6240\u6709\u70b9\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(nm)$\u3002\n\n```cpp\nfor(int i = 0, lim = __gcd(v[i], m); i < lim; i++)\n  for(int j = i, c = 0; c < 2; c += j == i) {\n    int p = (j + v[i]) % m;\n    f[p] = min(f[p], f[j] + v[i]), j = p;\n  }\n```\n\n\u5bf9\u4e8e\u666e\u901a\u7684\u5b8c\u5168\u80cc\u5305\uff0c\u5373\u8fb9\u6743\u7b49\u4e8e $v_i$ \u7684\u95ee\u9898\uff0c\u6211\u4eec\u627e\u5230\u5b50\u73af\u4e0a\u6743\u503c\u6700\u5c0f\u7684\u70b9\uff0c\u7ed5\u7740\u73af\u8f6c\u79fb\u4e00\u5708\u5373\u53ef\uff08[daklqw](https://daklqw.blog.luogu.org/solution-p2371)\uff09\u3002\u4f46\u662f\u5199\u8d77\u6765\u4e0d\u5982\u8f6c\u4e24\u5708\u7b80\u6d01\u3002\n\n### \u4f8b\u9898\n\n#### [\u58a8\u58a8\u7684\u7b49\u5f0f](https://www.luogu.com.cn/problem/P2371)\n\n\u4ee5\u4e0b\u662f\u7ecf\u5178\u9898\u58a8\u58a8\u7684\u7b49\u5f0f\u7684\u8f6c\u5708\u4ee3\u7801\u3002\u5b83\u662f\u666e\u901a\u7684\u5b8c\u5168\u80cc\u5305\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 5e5 + 5;\nint n, m, a[N];\nlong long f[N], l, r, ans;\nint main() {\n  cin >> n >> l >> r;\n  for(int i = 1; i <= n; i++) cin >> a[i];\n  memset(f, 0x3f, sizeof(f)), f[0] = 0;\n  sort(a + 1, a + n + 1), m = a[1];\n  for(int i = 2; i <= n; i++)\n    for(int j = 0, lim = __gcd(a[i], m); j < lim; j++)\n      for(int t = j, c = 0; c < 2; c += t == j) {\n        int p = (t + a[i]) % m;\n        f[p] = min(f[p], f[t] + a[i]), t = p;\n      }\n  for(int i = 0; i < a[1]; i++) {\n    if(r >= f[i]) ans += max(0ll, (r - f[i]) / a[1] + 1);\n    if(l > f[i]) ans -= max(0ll, (l - 1 - f[i]) / a[1] + 1);\n  }\n  cout << ans << endl;\n  return 0;\n}\n```\n\n#### [\u80cc\u5305](https://www.luogu.com.cn/problem/P9140)\n\n\u80cc\u5305\u8fd9\u9053\u9898\u76ee\u5728\u5b8c\u5168\u80cc\u5305\u7684\u53ef\u884c\u6027\u57fa\u7840\u4e0a\u52a0\u5165\u4e86\u6743\u503c\u8fd9\u4e00\u7ef4\u5ea6\u3002\n\n\u6ce8\u610f\u5230\uff0c\u5982\u679c\u6211\u4eec\u5c06 $\\frac {c_i}{v_i}$ \u6700\u5927\u7684\u7269\u54c1\u9009\u505a\u57fa\u51c6\u7269\u54c1\uff0c\u8bbe\u5176\u4f53\u79ef\u4e3a $m$\uff0c\u4ef7\u503c\u4e3a $w$\uff0c\u90a3\u4e48\u6211\u4eec\u540c\u6837\u4e0d\u4f1a\u7ecf\u8fc7\u540c\u4e00\u4e2a\u70b9\uff0c\u539f\u56e0\u662f\u7c7b\u4f3c\u7684\uff1a\u56e0\u4e3a $\\frac {c_i} {v_i}\\leq \\frac w m$\uff0c\u6240\u4ee5\u5982\u679c\u82e5\u5e72\u5176\u5b83\u7269\u54c1\u53ef\u4ee5\u66ff\u6362\u4e3a\u82e5\u5e72\u57fa\u51c6\u7269\u54c1\uff0c\u6211\u4eec\u4e00\u5b9a\u4f1a\u8fd9\u4e48\u505a\uff0c\u4ee5\u6700\u5927\u5316\u5355\u4f4d\u4f53\u79ef\u8d21\u732e\u7684\u4ef7\u503c\u3002\n\n\u4f46\u662f\uff0c\u5bf9\u4e8e\u4e24\u7ec4\u80cc\u5305\u65b9\u6848 $(V_1, C_1)$ \u548c $(V_2, C_2)$\uff0c\u82e5 $V_1\\equiv V_2\\pmod m$\uff0c\u8be5\u5982\u4f55\u8861\u91cf\u8fd9\u4e24\u7ec4\u65b9\u6848\u7684\u4f18\u52a3\u5462\uff1f\n\n\u5bf9\u4e8e\u4e00\u7ec4\u80cc\u5305\u65b9\u6848 $(V', C')$ \u548c\u4e00\u6b21\u67e5\u8be2 $V$\uff0c\u82e5 $V'\\equiv V\\pmod m$ \u4e14 $V' \\leq V$\uff0c\u5219\u5176\u6700\u7ec8\u6743\u503c\u4e3a $C' + \\frac {V - V'} mw$\u3002\u56e0\u6b64\uff0c\u5bf9\u4e8e\u76f8\u540c\u5269\u4f59\u7cfb\u7684\u6240\u6709\u80cc\u5305\u65b9\u6848 $(V', C')$\uff0c\u6211\u4eec\u5e0c\u671b\u6700\u5927\u5316 $C' - \\lfloor\\frac {V'} {m}\\rfloor w$\uff0c\u8f6c\u5316\u5230\u56fe\u8bba\u5c31\u662f \u201c\u6700\u957f\u8def\u201d \u7684 $dist$\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53\u6211\u4eec\u9700\u8981\u901a\u8fc7\u52a0\u5165\u7269\u54c1 $(v_i, c_i)$ \u4ece $p$ \u8f6c\u79fb\u5230 $q = (p + v_i)\\bmod m$ \u65f6\uff0c\u7528\u4e8e\u66f4\u65b0 $f_q$ \u7684\u503c\u7b49\u4e8e $f_p + c_i - \\lfloor \\frac {p + v_i} {m}\\rfloor w$\u3002\n\n\u800c\u6839\u636e $\\frac {w} {m}$ \u7684\u6700\u5927\u6027\uff0c\u8fd9\u6837\u4e00\u5f20\u5305\u542b\u6b63\u8d1f\u6743\u8fb9\u7684\u56fe\u4e0a\u4e0d\u53ef\u80fd\u5b58\u5728\u6b63\u6743\u73af\uff08\u6c42\u6700\u957f\u8def\uff09\u3002\u53c8\u56e0\u4e3a\u4e0d\u7ecf\u8fc7\u91cd\u590d\u70b9\uff0c\u6240\u4ee5\u6bcf\u7ec4\u5269\u4f59\u7cfb\u7684\u6700\u4f18\u65b9\u6848\u5bf9\u5e94\u7684 $V'$ \u5747\u4e0d\u8d85\u8fc7 $m ^ 2$ \u5373 $10 ^ {10}$\uff0c\u914d\u5408 $V\\geq 10 ^ {11}$ \u7684\u9650\u5236\u4fdd\u8bc1\u4e86\u6b63\u786e\u6027\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nconstexpr int N = 1e5 + 5;\nll n, q, m = 1, w, V, f[N], c[55], v[55];\nint main() {\n  cin >> n >> q;\n  for(int i = 1; i <= n; i++) {\n    cin >> v[i] >> c[i];\n    if(w * v[i] < m * c[i]) w = c[i], m = v[i];\n  }\n  for(int i = 1; i < m; i++) f[i] = -1e18;\n  for(int i = 1; i <= n; i++)\n    for(int j = 0, lim = __gcd(v[i], m); j < lim; j++)\n      for(int t = j, _ = 0; _ < 2; _ += t == j) {\n        int q = (t + v[i]) % m;\n        f[q] = max(f[q], f[t] + c[i] - ((t + v[i]) / m) * w), t = q;\n      }\n  for(int i = 1; i <= q; i++) {\n    cin >> V;\n    int p = V % m;\n    if(f[p] < -1e17) cout << \"-1\\n\";\n    else cout << f[p] + V / m * w << \"\\n\";\n  }\n  return 0;\n}\n```\n\n### \u548c\u5176\u5b83\u7b97\u6cd5\u7684\u5bf9\u6bd4\n\n\u4f8b\u9898\u4e00\u7684\u8f6c\u5708\u6280\u5de7\u5e76\u6ca1\u6709 SPFA \u8dd1\u5f97\u5feb\u3002SPFA \u8dd1\u540c\u4f59\u6700\u77ed\u8def\u7684\u590d\u6742\u5ea6\u4f9d\u7136\u662f\u4e2a\u8c1c\u3002\u5b83\u7684\u7406\u8bba\u4e0a\u754c\u662f $\\mathcal{O}(|V||E|)$ \u5373 $\\mathcal{O}(nm ^ 2)$\uff0c\u4f46\u5b9e\u9645\u8868\u73b0\u6bd4\u5c0f\u5e38\u6570 $\\mathcal{O}(nm)$ \u8fd8\u8981\u4f18\u79c0\u3002\n\n\u6b64\u5916\uff0c\u5728\u53ef\u4ee5\u4f7f\u7528\u6700\u5927\u4f53\u79ef\u4f5c\u4e3a\u57fa\u51c6\u5143\u7d20\u65f6\uff0c\u4ee4 $f_i$ \u9664\u4ee5 $m$ \u4e0b\u53d6\u6574\u5f97 $f'_i$\uff0c\u5219 $f_i = f'_i m + i$\u3002\u5bf9\u4e8e $f'$\uff0c\u8fb9\u6743\u53ea\u6709 $0$ \u6216 $1$\uff0c01-BFS \u5373\u53ef\uff08[FZzzz](https://www.luogu.com.cn/blog/0123456-3456789/solution-p3403)\uff09\u3002\n\n\u5f88\u663e\u7136\uff0c\u8f6c\u5708\u6280\u5de7\u6bd4\u6700\u77ed\u8def\u505a\u6cd5\u597d\u5199\uff0c\u4e14\u9002\u7528\u8303\u56f4\u6ca1\u6709\u4efb\u4f55\u9650\u5236\uff08\u5982 01-BFS \u5c31\u65e0\u6cd5\u89e3\u51b3\u7b2c\u4e8c\u9053\u4f8b\u9898\uff09\u3002\n\n### \u603b\u7ed3\n\n\u6709\u8da3\u7684\u662f\uff0c\u540c\u4f59\u6700\u77ed\u8def\u4e0d\u5e94\u8be5\u4ece\u6700\u77ed\u8def\u7684\u89d2\u5ea6\u8003\u8651\u3002\u5176\u672c\u8d28\u4e0a\u662f\u6839\u636e\u5355\u8c03\u6027\u503c\u57df\u5b9a\u4e49\u57df\u4e92\u6362\u540e\u5c06\u5b8c\u5168\u80cc\u5305\u8f6c\u5316\u4e3a\u4f53\u79ef\u6a21 $m$ \u610f\u4e49\u4e0b\u7684\u5b8c\u5168\u80cc\u5305\u3002\u666e\u901a\u5b8c\u5168\u80cc\u5305\u7684\u8f6c\u79fb\u662f\u6709\u5411\u65e0\u73af\u56fe\uff0c\u800c\u73af\u4e0a\u5b8c\u5168\u80cc\u5305\u8f6c\u79fb\u6210\u73af\uff0c\u8fd9\u8ba9\u6211\u4eec\u60f3\u5230\u6700\u77ed\u8def\u3002\u4f46\u56e0\u4e3a\u4e00\u4e2a\u70b9\u4e0d\u4f1a\u7ecf\u8fc7\u5b83\u81ea\u5df1\uff0c\u5bf9\u5e94\u539f\u95ee\u9898\u5c31\u662f\u5bf9\u4e8e\u4e00\u4e2a\u7269\u54c1\uff0c\u4e0d\u4f1a\u4f7f\u5f97\u5b83\u7684\u603b\u4f53\u79ef\u4e3a\u57fa\u51c6\u7269\u54c1\u4f53\u79ef\u7684\u500d\u6570\uff0c\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5b8c\u5168\u80cc\u5305\u8f6c\u5316\u4e3a\u7c7b\u591a\u91cd\u80cc\u5305\u95ee\u9898\u3002\n\n\u7b14\u8005\u5728\u7814\u7a76\u300c\u80cc\u5305\u300d\u4e00\u9898\u7684\u5b98\u65b9\u89e3\u6cd5\u65f6\uff0c\u60ca\u8bb6\u4e8e\u5176 \u201c\u8f6c\u4e24\u5708\u201d \u601d\u60f3\u7684\u5de7\u5999\u548c\u81ea\u5df1\u4ece\u6765\u6ca1\u6709\u542c\u8bf4\u8fc7\u8fd9\u4e2a\u6280\u5de7\u3002\u7ffb\u4e86\u4e00\u904d\u7ecf\u5178\u540c\u4f59\u6700\u77ed\u8def\u9898\u76ee\u7684\u9898\u89e3\u533a\uff0c\u4e5f\u6ca1\u627e\u5230\u51e0\u7bc7\u9664\u4e86 SPFA \u548c Dijkstra \u4ee5\u5916\u7684\u9898\u89e3\uff0c\u6545\u5c06\u5176\u5206\u4eab\u7ed9\u5404\u4f4d\u8bfb\u8005\u3002\n\n**\u540c\u4f59\u6700\u77ed\u8def\u8fd8\u5728\u5199\u6700\u77ed\u8def\uff1f\u65f6\u4ee3\u7684\u773c\u6cea\uff01**",
        "postTime": 1678453088,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "\u540c\u4f59\u6700\u77ed\u8def\u7684\u8f6c\u5708\u6280\u5de7"
    },
    {
        "content": "\u5bf9\u4e8e\u8fd9\u79cd\u6570\u636e\u8303\u56f4\u5de8\u5927\u7684\u80cc\u5305\uff0c\u6211\u4eec\u5f80\u5f80\u90fd\u53ef\u4ee5\u7528\u8d2a\u5fc3\u53bb\u8fdb\u884c\u4e00\u4e9b\u4f18\u5316\u3002\n\n\u6ce8\u610f\u5230\u5f53\u4f53\u79ef\u5f88\u5927\u65f6\uff0c\u5f88\u591a\u65f6\u5019\u6211\u4eec\u90fd\u4f1a\u7528\u4e00\u4e9b\u6027\u4ef7\u6bd4\u5f88\u9ad8\u7684\u7269\u54c1\u53bb\u586b\u5145\u3002\u8fd9\u91cc\u6211\u4eec\u8bbe\u6027\u4ef7\u6bd4\u6700\u9ad8\u7684\u9879\u4e3a $k$\uff0c\u5219\u5728\u5e7b\u60f3\u4e2d\uff0c\u6211\u4eec\u4f1a\u5148\u7528 $\\lfloor \\frac{V}{v_k} \\rfloor$ \u4e2a $k$ \u586b\u6ee1\u7edd\u5927\u90e8\u5206\uff0c\u518d\u7528\u4e00\u4e9b\u5c0f\u7684\u586b\u6ee1 $V \\bmod v_k$\u3002\n\n\u4f46\u4e8b\u5b9e\u4e0a\u6709\u65f6\u5019\u6211\u4eec\u4e0d\u80fd\u586b\u6ee1 $V \\bmod v_k$\uff0c\u800c\u6b64\u65f6\u5374\u6709\u89e3\u2014\u2014\u5219\u6211\u4eec\u6709\u65f6\u662f\u8981\u629b\u5f03\u4e00\u4e9b $k$ \u7684\uff0c\u4f46\u4e2a\u6570\u5e76\u4e0d\u786e\u5b9a\u2026\u2026\n\n\u8003\u8651\u505a $\\bmod v_k$ \u7684\u540c\u4f59\u6700\u77ed\u8def\uff0c\u5e76\u7528\u8d70\u8fc7\u4e00\u6761\u8fb9\u8868\u793a\u52a0\u5165\u65b0\u7684\u5143\u7d20\uff0c\u4ee5\u53ca\u8d85\u8fc7 $v_k$ \u540e\u6240\u5fc5\u8981\u7684\u628a\u539f\u6765\u7684 $k$ \u6254\u6389\u7684\u64cd\u4f5c\u3002\n\n\u5177\u4f53\u5730\uff0c\u5bf9\u4e8e\u5728\u53d6\u6a21\u540e\u4e3a $i$ \u7684\u57fa\u7840\u4e0a\u52a0\u4e0a\u7269\u54c1 $j$\uff0c\u6211\u4eec\u8fde\u8fb9 $i \\to^{c_j - c_k \\lfloor \\frac{i + v_j}{v_k} \\rfloor} (i + v_j) \\bmod v_k$\u3002\n\n\u76f4\u63a5\u8dd1 SPFA \u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\operatorname{SPFA}(\\max v_i, n \\max v_i) + q)$\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <iostream>\n#include <queue>\n\nusing namespace std;\n\ntypedef long long ll;\n\ntypedef struct {\n\tint nxt;\n\tint end;\n\tll dis;\n} Edge;\n\nint cnt = 0;\nint v[57], c[57], head[100007];\nll dis[100007];\nbool vis[100007];\nEdge edge[5000007];\nqueue<int> q;\n\ninline void init(int n){\n\tfor (register int i = 0; i <= n; i++){\n\t\tdis[i] = 0x8000000000000000ll;\n\t}\n}\n\ninline void add_edge(int start, int end, ll dis){\n\tcnt++;\n\tedge[cnt].nxt = head[start];\n\thead[start] = cnt;\n\tedge[cnt].end = end;\n\tedge[cnt].dis = dis;\n}\n\ninline void spfa(int start){\n\tdis[start] = 0;\n\tvis[start] = true;\n\tq.push(start);\n\twhile (!q.empty()){\n\t\tint cur = q.front();\n\t\tq.pop();\n\t\tvis[cur] = false;\n\t\tfor (register int i = head[cur]; i != 0; i = edge[i].nxt){\n\t\t\tint x = edge[i].end;\n\t\t\tll y = dis[cur] + edge[i].dis;\n\t\t\tif (dis[x] < y){\n\t\t\t\tdis[x] = y;\n\t\t\t\tif (!vis[x]){\n\t\t\t\t\tvis[x] = true;\n\t\t\t\t\tq.push(x);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main(){\n\tint n, q, pos = -1;\n\tcin >> n >> q;\n\tfor (register int i = 1; i <= n; i++){\n\t\tcin >> v[i] >> c[i];\n\t\tif (pos == -1 || 1.0 * c[pos] / v[pos] < 1.0 * c[i] / v[i]) pos = i;\n\t}\n\tinit(v[pos] - 1);\n\tfor (register int i = 0; i < v[pos]; i++){\n\t\tfor (register int j = 1; j <= n; j++){\n\t\t\tint val = i + v[j];\n\t\t\tadd_edge(i, val % v[pos], c[j] - (ll)val / v[pos] * c[pos]);\n\t\t}\n\t}\n\tspfa(0);\n\tfor (register int i = 1; i <= q; i++){\n\t\tll V, rem;\n\t\tcin >> V;\n\t\trem = V % v[pos];\n\t\tif (dis[rem] == 0x8000000000000000ll){\n\t\t\tcout << -1 << endl;\n\t\t} else {\n\t\t\tcout << dis[rem] + c[pos] * (V / v[pos]) << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1679308765,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P9140 \u3010[THUPC 2023 \u521d\u8d5b] \u80cc\u5305\u3011"
    },
    {
        "content": "## $\\mathcal{Solution}$\n\n\u53d1\u73b0 $V$ \u5f88\u5927 $v_i$ \u5374\u5f88\u5c0f\uff0c\u800c\u4e14\u8fd8\u662f\u5b8c\u5168\u80cc\u5305\uff0c\u4e00\u822c\u90fd\u662f**\u540c\u4f59\u6700\u77ed\u8def**\u3002\n\n- \u9996\u5148\u8003\u8651\u8d2a\u5fc3\uff0c\u53d1\u73b0\u5bf9\u4e8e\u6700\u4f18\u89e3\u7684\u5f88\u5927\u4e00\u90e8\u5206\u5bb9\u91cf\uff0c\u90fd\u662f\u5728\u53d6\u6027\u4ef7\u6bd4\u6700\u9ad8\u7684\u7269\u54c1\u3002\u4ee4**\u6027\u4ef7\u6bd4\u6700\u9ad8\u7684\u7269\u54c1**\u4e3a $k$\uff0c\u5176\u4f53\u79ef\u4e3a $v_k$\uff0c\u4ef7\u503c\u4e3a $c_k$\u3002\n- \u5bb9\u6613\u53d1\u73b0\u5bf9\u4e8e\u4e00\u4e9b\u603b\u4f53\u79ef\u4e3a $v_k$ \u7684\u7269\u54c1\uff0c\u4e0d\u5982\u6362\u6210 $k$\u3002\u56e0\u4e3a $k$  \u662f\u6027\u4ef7\u6bd4\u6700\u9ad8\u7684\u3002\u4f46\u662f\u5bf9\u4e8e\u603b\u4f53\u79ef\u4e0d\u4e3a $v_k$ \u5c31\u4e0d\u4e00\u5b9a\uff0c\u6700\u4f18\u89e3\u53ef\u80fd\u4f1a\u6bd4\u5168\u90e8\u53d6 $k$ \u5e76\u7a7a\u51fa\u5269\u4e0b\u5bb9\u91cf\u8981\u4f18\u6216\u52a3\uff08\u52a3\u662f\u56e0\u4e3a\u672c\u9898\u8981\u6c42\u603b\u4f53\u79ef\u5fc5\u987b\u4e3a $V$\uff09\u3002\u8003\u8651\u6c42\u51fa\u8981\u4f18\u6216\u52a3\u591a\u5c11\u3002\n- \u8003\u8651 dp\uff0c\u8bbe $V$ \u4e3a\u4f53\u79ef\uff0c$C$ \u4e3a\u4ef7\u503c\uff0c\u8bbe $f_{i}$ \u4e3a $i\\equiv V\\text{ }(\\bmod\\text{ }v_k)$ \u4e0b\u6700\u5927\u7684 $C-\\lfloor\\frac{V}{v_k}\\rfloor\\times c_k$\uff0c\u4e5f\u5c31\u662f\u6700\u4f18\u89e3\u6bd4\u5168\u90e8\u53d6 $k$ \u4f18\u6216\u52a3\u591a\u5c11\u3002\u53ef\u4ee5\u8bc1\u660e $V$ \u4e0d\u4f1a\u5927\u4e8e\u5b9e\u9645\u8be2\u95ee\u7684 $V$\u3002\n$$f_{i}=\\max_{1\\leq j\\leq n}\\{f_{j}+c_j-\\lfloor\\frac{i+v_j}{v_k}\\rfloor\\times c_k\\}$$\n- \u53d1\u73b0 dp \u6709\u540e\u6548\u6027\uff0c\u5efa\u56fe\u8dd1\u6700\u957f\u8def\u6a21\u62df dp \u5373\u53ef\u6c42\u51fa\u3002\n- \u8be2\u95ee\u7684\u7ed3\u679c\u5373 $\\lfloor\\frac{V}{v_k}\\rfloor\\times c_k+f_{V\\bmod v_k}$\u3002\n\n\u4e00\u4e9b\u6027\u8d28\u7684\u8bf4\u660e\uff1a\n- \u5173\u4e8e\u4e3a\u4ec0\u4e48 dp \u4e2d\u7684 $V$ \u4e0d\u4f1a\u5927\u4e8e\u5b9e\u9645\u8be2\u95ee\u7684 $V$\uff1a\u8bb0\u5b9e\u9645\u8be2\u95ee\u7684 $V$ \u4e3a $V'$\uff0c\u628a dp \u8fc7\u7a0b\u770b\u6210\u4e00\u6761\u6700\u957f\u8def\uff0c\u90a3\u4e48\u8fd9\u6761\u6700\u957f\u8def\u5c31\u4e0d\u4f1a\u4e24\u6b21\u7ecf\u8fc7\u540c\u4e00\u4e2a\u7ed3\u70b9\uff0c\u4e0d\u7136\u628a\u4e24\u6b21\u7ecf\u8fc7\u8be5\u7ed3\u70b9\u4e2d\u95f4\u4f7f\u7528\u7684\u4e00\u4e9b\u7269\u54c1\u6362\u6210 $k$ \u66f4\u4f18\u3002\u6240\u4ee5 dp \u4e2d\u7684 $V\\leq\\sum v_i$\u3002\u89c2\u5bdf\u53d1\u73b0\u8fd9\u9898 $\\sum v_i\\leq 10^{11}\\leq V'$\uff0c\u6240\u4ee5\u53ef\u8bc1\u3002\n- \u5173\u4e8e\u4e3a\u4ec0\u4e48\u6ca1\u6709\u6b63\u73af\uff0c\u611f\u6027\u7406\u89e3\u4e00\u4e0b\uff0c\u6700\u957f\u8def\u5728\u6a21\u62df dp\uff0c\u800c\u8fd9\u4e2a dp \u7684\u503c\u6709\u4e0a\u9650\u3002\n\n\u7406\u8bba\u6700\u574f\u590d\u6742\u5ea6\u662f $\\mathcal{O}(nv^2+q)$\uff0c\u4f46\u662f\u5728\u672c\u9898\u7684\u56fe\u91cc\u9762 SPFA \u8dd1\u5f97\u98de\u5feb\uff0c\u800c\u4e14\u51fa\u9898\u4eba\u4e0d\u592a\u80fd\u5361\uff08\uff09\n\n## $\\mathcal{Code}$\n\n\u540c\u4f59\u6700\u77ed\u8def\uff0c[345ms](/record/104446931)\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nnamespace Milkcat {\n\ttypedef long long LL;\n\tconst int N = 1e6 + 5, M = 5e6 + 5;\n\tstruct edge {\n\t\tLL to, w, next;\n\t} e[M];\n\tqueue<LL> q;\n\tLL n, m, t, T, V, cnt, w[N], v[N], head[N], dis[N];\n\tbool vis[N];\n\tvoid add(LL u, LL v, LL w) {\n\t\te[++ cnt].to = v;\n\t\te[cnt].w = w;\n\t\te[cnt].next = head[u];\n\t\thead[u] = cnt;\n\t}\n\tvoid SPFA(int s) { // SPFA \u6c42\u6700\u957f\u8def\n    for (int i = 0; i <= m; i ++) dis[i] = -1e18;\n\t\tdis[s] = 0, q.push(s);\n\t\twhile (!q.empty()) {\n\t\t\tint u = q.front(); q.pop();\n\t\t\tvis[u] = false;\n\t\t\tfor (int i = head[u]; i; i = e[i].next) {\n\t\t\t\tint v = e[i].to;\n\t\t\t\tif (dis[v] < dis[u] + e[i].w) {\n\t\t\t\t\tdis[v] = dis[u] + e[i].w;\n\t\t\t\t\tif (!vis[v]) q.push(v), vis[v] = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint main() {\n\t\tcin >> n >> T, m = 1e6;\n\t\tfor (int i = 1; i <= n; i ++) {\n\t\t\tcin >> w[i] >> v[i];\n\t\t\tif (v[i] * m > t * w[i]) m = w[i], t = v[i];\n\t\t}\n\t\tfor (int i = 0; i <= m; i ++)\n\t\t\tfor (int j = 1; j <= n; j ++)\n\t\t\t\tadd(i, (i + w[j]) % m, v[j] - (i + w[j]) / m * t);\n\t\tSPFA(0);\n\t\tfor (int i = 1; i <= T; i ++) {\n\t\t\tcin >> V;\n\t\t\tif (dis[V % m] <= -1e17) cout << \"-1\\n\";\n\t\t\telse cout << V / m * t + dis[V % m] << '\\n';\n\t\t}\n\t\treturn 0;\n\t}\n}\nint main() {\n\treturn Milkcat::main();\n}\n```\n",
        "postTime": 1678593715,
        "uid": 560516,
        "name": "\u55b5\u4ed4\u725b\u5976",
        "ccfLevel": 0,
        "title": "P9140 [THUPC 2023 \u521d\u8d5b] \u80cc\u5305 \u9898\u89e3"
    }
]
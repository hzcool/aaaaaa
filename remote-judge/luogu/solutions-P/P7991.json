[
    {
        "content": "### \u9898\u610f\n\n\u7ed9\u51fa\u4e00\u4e2a $n$ \u4e2a\u70b9 $m$ \u6761\u8fb9\uff0c\u7f16\u53f7\u4ece $1$ \u5230 $n$ \u7684\u65e0\u5411\u56fe\uff0c\u53ef\u4ee5\u4ee5 $(i - j)^2$ \u7684\u4ee3\u4ef7\u5728\u4efb\u610f\u7684  $i,j$ \u4e4b\u95f4\u8fde\u4e00\u6761\u8fb9\u3002\n\n\u73b0\u5728\u53ef\u4ee5\u8fdb\u884c\u4e0d\u8d85\u8fc7\u4e24\u6b21\u8fde\u8fb9\u64cd\u4f5c\uff0c\u6c42\u4f7f\u5f97 $1$ \u548c $n$ \u4e24\u70b9\u8fde\u901a\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n### \u89e3\u6cd5\n\n\u9996\u5148\u4e0d\u8d85\u8fc7\u4e24\u6b21\u8fde\u8fb9\u4e00\u5b9a\u662f\u4ee5\u4e0b\u51e0\u79cd\u5f62\u5f0f\u4e2d\u7684\u4e00\u79cd : \n\n- $1,n$ \u521d\u59cb\u5373\u8fde\u901a\uff0c\u4e0d\u9700\u8fde\u8fb9\u3002\n\n- \u4ece $1$ \u548c $n$ \u5206\u522b\u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u4e2d\u627e\u51fa\u5dee\u503c\u6700\u5c0f\u7684\u4e24\u4e2a\u70b9\u8fde\u8fb9\uff0c\u5171\u8fde\u4e00\u6761\u8fb9\u3002\n\n- \u5c06 $1$ \u548c $n$ \u5206\u522b\u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u548c\u7b2c\u4e09\u4e2a\u8fde\u901a\u5206\u91cf\u76f8\u8fde\uff0c\u5171\u8fde\u4e24\u6761\u8fb9\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u90fd\u662f\u628a\u67d0\u4e2a\u70b9\u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u4e0e $1$ \u6216 $n$ \u8fde\u901a\u7684\u8fc7\u7a0b\u3002\n\n\u4ee4 $f_i$ \u8868\u793a\u5c06\u70b9 $i$ \u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u4e0e $1$ \u8fde\u63a5\u7684\u6700\u5c0f\u4ee3\u4ef7\uff0c$g_i$ \u8868\u793a\u5c06\u70b9 $i$ \u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u4e0e $n$ \u8fde\u63a5\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n\u90a3\u4e48\u7b54\u6848\u4e3a : $\\min_{i = 1}^{n} \\{f_i + g_i\\}$\u3002\n\n\u7136\u540e\u8003\u8651\u5982\u4f55\u6c42\u51fa $f$ \u548c $g$\u3002\n\n\u9996\u5148\u53ef\u4ee5\u6c42\u51fa\u521d\u59cb\u4e0e $1,n$ \u5728\u540c\u4e00\u8fde\u901a\u5206\u91cf\u7684\u70b9\u7684\u96c6\u5408\uff0c\u8bb0\u4e3a $F$ \u4e0e $G$\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u70b9 $u$\uff0c\u5728 $F,G$ \u4e2d\u5206\u522b\u4e8c\u5206\u67e5\u627e\u5f97\u5230\u4e0e\u5176\u5dee\u503c\u6700\u5c0f\u7684\u70b9\u5e76\u5c1d\u8bd5\u66f4\u65b0\u6700\u5c0f\u503c\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O} (n \\log n)$\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n\ntypedef long long ll;\nconstexpr int N = 100005;\n\nll f[N],g[N];\nint F[N],G[N],fa[N];\n\nint find(int x) {\n    return x == fa[x] ? x : fa[x] = find(fa[x]);\n}\n\nvoid solve() {\n    int n,m;\n    scanf(\"%d %d\",&n,&m);\n    memset(f,127,sizeof(f));\n    memset(g,127,sizeof(g));\n    for(int i = 1;i <= n;++i)\n        fa[i] = i;\n    for(int i = 1;i <= m;++i) {\n        int u,v;\n        scanf(\"%d %d\",&u,&v);\n        u = find(u),v = find(v);\n        if(u == v) continue;\n        fa[u] = v;\n    }\n    int r1 = find(1),rn = find(n);\n    f[r1] = 0,g[rn] = 0;\n    int cntF = 0,cntG = 0;\n    for(int i = 1;i <= n;++i) {\n        int u = find(i);\n        if(u == r1) F[++cntF] = i;\n        else if(u == rn) G[++cntG] = i;\n    }\n    for(int i = 1;i <= n;++i) {\n        int u = find(i);\n        if(u != r1) {\n            int pre = std::upper_bound(F + 1,F + cntF + 1,i) - F - 1;\n            f[u] = std::min(f[u],(ll)(i - F[pre]) * (i - F[pre]));\n            if(pre < cntF) {\n                ++pre;\n                f[u] = std::min(f[u],(ll)(i - F[pre]) * (i - F[pre]));\n            }\n        }\n        if(u != rn) {\n            int nxt = std::upper_bound(G + 1,G + cntG + 1,i) - G;\n            g[u] = std::min(g[u],(ll)(i - G[nxt]) * (i - G[nxt]));\n            if(nxt > 1) {\n                --nxt;\n                g[u] = std::min(g[u],(ll)(i - G[nxt]) * (i - G[nxt]));\n            }\n        }\n    }\n    ll ans = (ll)(n - 1ll) * (n - 1ll);\n    for(int i = 1;i <= n;++i) {\n        int u = find(i);\n        ans = std::min(ans,f[u] + g[u]);\n    }\n    printf(\"%lld\\n\",ans);\n}\n\nint main() {\n    int T;\n    scanf(\"%d\",&T);\n    while(T--) solve();\n    return 0;\n}\n\n```",
        "postTime": 1640438679,
        "uid": 122520,
        "name": "\u671b\u6708Asta",
        "ccfLevel": 6,
        "title": "P7991 \u9898\u89e3"
    },
    {
        "content": "## \u7b80\u8981\u9898\u610f\n\u7ed9\u51fa\u4e00\u4e2a $n$ \u4e2a\u70b9 $m$ \u6761\u8fb9\uff0c\u7f16\u53f7\u4e3a $1\u2026N$ \u7684\u65e0\u5411\u56fe\uff0c\u53ef\u4ee5\u4ee5 $(i - j)^2$ \u7684\u4ee3\u4ef7\u5728\u4efb\u610f\u7684 $i,j$ \u4e4b\u95f4\u8fde\u4e00\u6761\u8fb9\u3002\u73b0\u5728\u53ef\u4ee5\u8fdb\u884c**\u4e0d\u8d85\u8fc7\u4e24\u6b21**\u8fde\u8fb9\u64cd\u4f5c\uff0c\u6c42\u4f7f\u5f97 $1$ \u548c $n$ \u4e24\u70b9\u8fde\u901a\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n## \u601d\u8def\n\u660e\u663e\u53ef\u4ee5\u7528**\u5e76\u67e5\u96c6**\u6765\u8bb0\u5f55\u6bcf\u4e00\u4e2a\u70b9\u5206\u522b\u5728\u54ea\u4e00\u4e2a\u8fde\u901a\u5757\u91cc\u3002\n\n\u63a5\u4e0b\u6765\u7528 $f_i$ \u6765\u8868\u793a $i$ \u6240\u5728\u7684\u8fde\u901a\u5757\u7684\u4ee3\u8868\u70b9\u3002\n\n\u7136\u540e\u5bf9\u4e8e $1$ \u548c $n$ \u4e24\u70b9\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\n1. \u5728\u540c\u4e00\u4e2a\u8fde\u901a\u5757\u91cc\u3002\n2. \u5728\u4e24\u4e2a\u4e0d\u540c\u7684\u8fde\u901a\u5757\u91cc\u3002\n\n### \u60c5\u51b5 1\n\u5f88\u660e\u663e\u4e0d\u9700\u8981\u8fde\u4efb\u4f55\u4e00\u6761\u8fb9\uff0c\u6240\u4ee5\u4ee3\u4ef7\u5c31\u662f $0$\u3002\n\n### \u60c5\u51b5 2\n\u53ef\u4ee5**\u76f4\u63a5\u5728 $f_1$ \u548c $f_n$ \u4e2d\u6700\u8fd1\u7684\u4e24\u70b9\u8fde\u8fb9**\uff0c\u6216\u8005**\u901a\u8fc7\u5176\u4ed6\u8fde\u901a\u5757\u6765\u95f4\u63a5\u7684\u8fde\u63a5 $f_1$ \u548c $f_n$**\u3002\n### \u600e\u4e48\u6c42\u51fa\u6700\u5c0f\u503c\uff1f(\u5bf9\u4e8e\u60c5\u51b52)\n\u53ef\u4ee5\u5148\u5904\u7406\u51fa\u54ea\u4e9b\u70b9\u5728 $f_1$ \u4e2d\uff0c\u54ea\u4e9b\u70b9\u5728 $f_n$ \u4e2d\uff0c\u5206\u522b\u8bb0\u5f55\u5728 $S$ \u6570\u7ec4\u548c $E$ \u6570\u7ec4\u4e2d\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8fde\u901a\u5757 $f_i$ \u8ba1\u7b97\u51fa\u5176\u4e0e $f_1$ \u548c $f_n$ \u901a\u8fc7\u8fde\u4e00\u6761\u8fb9\u8fde\u901a\u7684\u6700\u5c0f\u4ee3\u4ef7\uff0c\u5206\u522b\u8bb0\u5f55\u5728 $s[f_i]$ \u548c $e[f_i]$ \u4e2d\uff08\u8fd9\u91cc\u7684\u8ba1\u7b97\u53ef\u4ee5\u901a\u8fc7\u4e8c\u5206\u6765\u5b9e\u73b0\uff09\u3002\n\n\u6700\u540e\u6700\u5c0f\u4ee3\u4ef7\u4e3a $\\min_{1\\le i\\le n} s[f_i]+e[f_i]$\u3002\n\nAC\u4ee3\u7801\u5949\u4e0a\u3002\n```cpp\n#include <bits/stdc++.h>\ntypedef long long ll;\nusing namespace std;\nconst int maxn = 1e5 + 5;\n\ninline int read() {\n\tint x = 0, f = 1;\n\tchar ch = getchar();\n\tfor (; !isdigit(ch); ch = getchar()) if (ch == '-') f = -f;\n\tfor (; isdigit(ch); ch = getchar()) x = (x << 1) + (x << 3) + (ch ^ 48);\n\treturn x * f;\n}\n\nint t, n, m, fa[maxn], S[maxn], E[maxn];\nll s[maxn], e[maxn];\n\nint find(int x) {\n\treturn fa[x] == x ? x : fa[x] = find(fa[x]);\n}\n\nint main() {\n\tt = read();\n\twhile (t--) {\n\t\tmemset(s, 0x3f, sizeof(s));\n\t\tmemset(e, 0x3f, sizeof(e));\n\t\tn = read(); m = read();\n\t\tfor (int i = 1; i <= n; ++i) fa[i] = i;\n\t\tfor (int i = 1; i <= m; ++i) {\n\t\t\tint x = read(), y = read();\n\t\t\tx = find(x); y = find(y);\n\t\t\tfa[x] = y;\n\t\t}\n\t\tif (find(1) == find(n)) {\n\t\t\tprintf(\"0\\n\");\n\t\t\tcontinue;\n\t\t}\n\t\tint rt1 = find(1), rtn = find(n), ct1 = 0, ctn = 0;\n\t\ts[rt1] = 0; e[rtn] = 0;\n\t\tfor (int i = 1; i <= n; ++i) {\n\t\t\tint fi = find(i);\n\t\t\tif (rt1 == fi) S[++ct1] = i;\n\t\t\tif (rtn == fi) E[++ctn] = i;\n\t\t}\n\t\tll ans = 0x3f3f3f3f3f3f3f3f;\n\t\tfor(int i = 1; i <= n; ++i) {\n\t\t\tint fi = find(i);\n\t\t\tif(fi != rt1) {\n\t\t\t\tint ub1 = upper_bound(S + 1, S + ct1 + 1, i) - S - 1;\n\t\t\t\ts[fi] = min(s[fi], (ll)(i - S[ub1]) * (i - S[ub1]));\n\t\t\t\tif (ub1 < ct1) {\n\t\t\t\t\t++ub1;\n\t\t\t\t\ts[fi] = min(s[fi], (ll)(i - S[ub1]) * (i - S[ub1]));\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (fi != rtn) {\n\t\t\t\tint ubn = upper_bound(E + 1, E + ctn + 1, i) - E;\n\t\t\t\te[fi] = min(e[fi], (ll)(i - E[ubn]) * (i - E[ubn]));\n\t\t\t\tif(ubn > 1) {\n\t\t\t\t\t--ubn;\n\t\t\t\t\te[fi] = min(e[fi], (ll)(i - E[ubn]) * (i - E[ubn]));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i = 1; i <= n; ++i) {\n\t\t\tint fi = find(i);\n//\t\t\tprintf(\"@%lld %lld\\n\", s[fi], e[fi]);\n\t\t\tans = min(ans, s[fi] + e[fi]);\n\t\t}\n\t\tprintf(\"%lld\\n\", ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1666790796,
        "uid": 367677,
        "name": "lyt_awa",
        "ccfLevel": 5,
        "title": "P7991 [USACO21DEC] Connecting Two Barns S\u9898\u89e3"
    },
    {
        "content": "## P7991 \u9898\u89e3\n\n\u5728\u8fde\u5b8c\u6240\u6709\u7684\u9053\u8def\u4ee5\u540e\uff0c\u8fd9 $n$ \u4e2a\u70b9\u4f1a\u88ab\u5206\u6210\u82e5\u5e72\u4e2a\u8fde\u901a\u5757\n\n\u7531\u4e8e\u53ea\u80fd\u5efa\u4e24\u6761\u9053\u8def\uff0c\u6240\u4ee5\u65b0\u5efa\u7684\u9053\u8def\u53ea\u53ef\u80fd\u662f\u8fd9\u79cd\u60c5\u51b5\n\n$1$ \u53f7\u70b9\u6240\u5728\u7684\u8fde\u901a\u5757\u4e0a\u7684\u4e00\u70b9 $\\rightarrow$ \u8fde\u901a\u5757 $A$ \u4e0a\u7684\u4e00\u70b9 \u548c \u8fde\u901a\u5757 $A$ \u4e0a\u7684\u4e00\u70b9 $\\rightarrow$ $n$ \u53f7\u70b9\u6240\u5728\u7684\u8fde\u901a\u5757\u4e0a\u7684\u4e00\u70b9\n\n\u8fd9\u91cc\u7684\u8fde\u901a\u5757 $A$ \u53ef\u4ee5\u662f $1$ \u53f7\u70b9\u6216\u8005 $n$ \u53f7\u70b9\u6240\u5728\u7684\u8fde\u901a\u5757\uff0c\u56e0\u4e3a\u53ef\u4ee5\u4ee4\u5efa\u4e24\u7aef\u4e3a\u540c\u4e00\u70b9\u7684\u9053\u8def\u7684\u8d39\u7528\u4e3a $0$ \n\n\u9996\u5148\u5efa\u4e00\u4e2a\u5e76\u67e5\u96c6\uff0c\u6bcf\u5efa\u4e00\u6761\u8fb9\u5c31\u505a\u4e00\u6b21\u5408\u5e76\u7684\u64cd\u4f5c\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u5c06 $1$ \u53f7\u70b9\u548c $n$ \u53f7\u70b9\u6240\u5728\u7684\u8fde\u901a\u5757\u5185\u7684\u6240\u6709\u70b9\u7684\u7f16\u53f7**\u4f9d\u6b21**\u5217\u51fa\u6765\uff0c\u5206\u522b\u5f00\u4e24\u4e2a\u6570\u7ec4 $a$ \u548c $b$ \u4fdd\u5b58\n\n\u4e4b\u540e\u679a\u4e3e $1\\sim n$ \u4e2d\u7684\u6240\u6709\u70b9\uff0c\u5206\u522b\u5728 $a$ \u4e2d\u4e8c\u5206\u8fd9\u4e2a\u70b9\u7684\u7f16\u53f7\uff0c\u5728\u7b97\u51fa\u6570\u7ec4 $a$ \u4e2d\u6bd4\u8fd9\u4e2a\u70b9\u7f16\u53f7\u5c0f\u7684\u4e14\u7f16\u53f7\u6700\u5927\u7684\u70b9\u548c\u6bd4\u8fd9\u4e2a\u70b9\u7f16\u53f7\u5927\u4e14\u7f16\u53f7\u6700\u5c0f\u7684\u70b9\u5206\u522b\u662f\u591a\u5c11\u540e\uff0c\u7b97\u51fa\u8fd9\u4e2a\u70b9\u5230 $a$ \u4e2d\u7684\u70b9\u6240\u9700\u8981\u82b1\u7684\u6700\u5c0f\u8d39\u7528\uff0c\u5e76\u8bb0\u5f55\u5230\u8fd9\u4e2a\u70b9\u6240\u5728\u7684\u8fde\u901a\u5757\u4e2d\n\n\u8fd9\u6837\u5bf9\u4e8e\u6bcf\u4e2a\u8fde\u901a\u5757\u90fd\u53ef\u4ee5\u8ba1\u7b97\u51fa\u5efa\u4e00\u6761\u8fde\u63a5\u8fd9\u4e2a\u8fde\u901a\u5757\u5185\u7684\u4e00\u70b9\u5230 $1$ \u53f7\u70b9\u6240\u5728\u8fde\u901a\u5757\u5185\u7684\u4e00\u70b9\u6240\u9700\u8981\u7684\u6700\u5c0f\u8d39\u7528\n\n\u5bf9\u6570\u7ec4 $b$ \u540c\u7406\n\n\u6700\u540e\u8fdb\u884c\u7edf\u8ba1\u5373\u53ef\n\n#### \u53cb\u60c5\u63d0\u793a\uff1a\n\n1\u3001\u6700\u7ec8\u7b54\u6848\u8981\u5f00 `long long`\n\n2\u3001\u4e0b\u9762\u7684\u4ee3\u7801\u4e2d\u6709\u4e00\u4e9b\u5c0f\u9519\u8bef\uff0c\u8bf7\u52ff\u6284\u88ad\u9898\u89e3\n\n### Code\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint T,n,m,fa[100005],a[100005],b[100005],c[100005],d[100005],cnt1,cnt2;\nlong long ans;\nint find(int x) {\n\tif(fa[x]==x) return x;\n\treturn fa[x]=find(fa[x]);\n}\nvoid merge(int x,int y) {\n\tx=find(x),y=find(y);\n\tfa[x]=y;\n}\nint main() {\n\tscanf(\"%d\",&T);\n\twhile(T--) {\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tfor(int i=1;i<=n;++i) fa[i]=i;\n\t\tfor(int i=1,u,v;i<=m;++i) scanf(\"%d%d\",&u,&v),merge(u,v);\t//\u5e76\u67e5\u96c6\u5408\u5e76\n\t\tcnt1=cnt2=0;\n\t\tmemset(a,0,sizeof(a));\n\t\tmemset(b,0,sizeof(b));\n\t\tfor(int i=1;i<=n;++i) {\n\t\t\tif(find(i)==find(1)) a[++cnt1]=i;\n\t\t\tif(find(i)==find(n)) b[++cnt2]=i;\t//\u7edf\u8ba11\u53f7\u70b9\u548cn\u6240\u5728\u8fde\u901a\u5757\u5185\u7684\u70b9\n\t\t}\n\t\tmemset(c,0x3f3f3f3f,sizeof(c));\n\t\tmemset(d,0x3f3f3f3f,sizeof(d));\n\t\tfor(int i=1;i<=n;++i) {\n\t\t\tint t1=lower_bound(a+1,a+cnt1+1,i)-a;\t//\u4e8c\u5206\n\t\t\tif(t1==1) c[find(i)]=min(c[find(i)],abs(a[1]-i));\n\t\t\telse c[find(i)]=min(c[find(i)],min(abs(a[t1]-i),abs(a[t1-1]-i)));\t//\u66f4\u65b0\u6700\u5c0f\u8d39\u7528\n\t\t}\n\t\tfor(int i=1;i<=n;++i) {\t//\u540c\u4e0a\n\t\t\tint t1=lower_bound(b+1,b+cnt2+1,i)-b;\n\t\t\tif(t1==1) d[find(i)]=min(d[find(i)],abs(b[1]-i));\n\t\t\telse d[find(i)]=min(d[find(i)],min(abs(b[t1]-i),abs(b[t1-1]-i)));\n\t\t}\n\t\tans=1ll*d[find(1)]*d[find(1)];\n\t\tfor(int i=2;i<=n;++i) {\n\t\t\tif(find(i)==i) ans=min(ans,1ll*c[find(i)]*c[find(i)]+1ll*d[find(i)]*d[find(i)]);\t//\u7edf\u8ba1\u7b54\u6848\n\t\t}\n\t\tprintf(\"%lld\\n\",&ans);\n\t}\n}\n```\n\n",
        "postTime": 1643289175,
        "uid": 369836,
        "name": "\u9cb6\u9c7c\u7684\u5fe0\u5b9e\u7c89",
        "ccfLevel": 7,
        "title": "P7991"
    },
    {
        "content": "# \u9898\u89e3  \n**\u5e76\u67e5\u96c6+\u4e8c\u5206\u67e5\u627e**\u597d\u9898  \n\u7531\u4e8e\u81f3\u591a\u8fde\u4e24\u6761\u8fb9\uff0c\u6240\u4ee5\u53ea\u6709\u4e09\u79cd\u60c5\u51b5\u3002  \n\u82e5\u4e0d\u8fde\u8fb9\uff0c\u5219 $1$ \u548c $n$ \u8fde\u901a\uff1b  \n\u82e5\u8fde\u4e00\u6761\u8fb9\uff0c\u5219\u5728\u5206\u522b\u5728 $1$ \u548c $n$ \u6240\u5728\u7684\u8fde\u901a\u5757\u91cc\u627e\u4e00\u4e2a\u70b9\u8fde\u8fb9\uff1b  \n\u82e5\u8fde\u4e24\u6761\u8fb9\uff0c\u5219\u627e\u4e00\u4e2a\u70b9\u5206\u522b\u4e0e $1$ \u548c $n$ \u6240\u5728\u7684\u8fde\u901a\u5757\u91cc\u627e\u4e00\u4e2a\u70b9\u8fde\u8fb9\u3002  \n\u8fd9\u4e09\u79cd\u60c5\u51b5\u7684\u6700\u5c0f\u503c\u5c31\u662f\u7b54\u6848\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n\\log n)$\u3002\n## Code\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int maxn=1e5+5;\nint t,n,m,u,v,fa[maxn];\nll ans;\nvector<int> g[maxn];\nll square(int x)\n{\n\treturn (ll)x*x;\n}\nint find(int x)\n{\n\tif(x==fa[x])\n\t\treturn x;\n\treturn fa[x]=find(fa[x]);\n} \nll dis(int x,int y)\n{\n\tll res=1e18;\n\tint a,b;\n\tfor(int i=0;i<g[x].size();i++)\n\t{\n\t\ta=g[x][i],b=lower_bound(g[y].begin(),g[y].end(),a)-g[y].begin();//\u4e8c\u5206\n\t\tif(b) res=min(res,square(a-g[y][b-1]));//\u6bd4a\u5c0f\u91cc\u6700\u63a5\u8fd1a\u7684 \n\t\tif(b<g[y].size()) res=min(res,square(a-g[y][b]));//\u6bd4a\u5927\u91cc\u6700\u63a5\u8fd1a\u7684 \n\t}\n\treturn res;\n}\nint main()\n{\n\tscanf(\"%d\",&t);\n\twhile(t--)\n\t{\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tfa[i]=i;\n\t\t\tg[i].clear();\n\t\t}//\u521d\u59cb\u5316 \n\t\tfor(int i=1;i<=m;i++)\n\t\t{\n\t\t\tscanf(\"%d%d\",&u,&v);\n\t\t\tfa[find(u)]=find(v);\n\t\t}\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tg[find(i)].push_back(i);\n\t\tu=fa[1],v=fa[n],ans=dis(u,v);//1\u4e0en\u76f4\u63a5\u76f8\u8fde \n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tif(fa[i]==u||fa[i]==v||fa[i]!=i)\n\t\t\t\tcontinue;\n\t\t\tans=min(ans,dis(i,u)+dis(i,v));//\u627e\u5230\u67d0\u4e2a\u70b9\u4e0e1\u548cn\u76f8\u8fde \n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1641203572,
        "uid": 379058,
        "name": "Ginger_he",
        "ccfLevel": 0,
        "title": "\u6d1b\u8c37P7991\u9898\u89e3"
    },
    {
        "content": "# \u9898\u76ee\u5927\u610f\n\n\u6709 $n$ \u4e2a\u70b9 $m$ \u6761\u8fb9\uff0c\u8981\u6c42\u8fde\u901a $1$ \u5230 $n$ \u7684\u65e0\u5411\u56fe\uff0c\u8fde\u63a5 $(i,j)$ \u9700\u82b1\u8d39 $(i-j)^2$ \u7684\u4ee3\u4ef7\uff0c\u6700\u591a\u4e0d\u80fd\u8d85\u8fc7\u4e24\u6b21\u64cd\u4f5c\u3002\n\n# \u601d\u8def\n\n\u4e00\u5171\u6709\u4e24\u79cd\u60c5\u51b5\uff0c\u7b2c\u4e00\u79cd\u662f $1$ \u548c $n$ \u4e4b\u95f4\u5df2\u7ecf\u8fde\u901a\uff0c\u4e0d\u9700\u8981\u8fdb\u884c\u64cd\u4f5c\u3002\n\n\u7b2c\u4e8c\u79cd\u662f\u9700\u8981\u8fdb\u884c\u8fde\u63a5\u6765\u8fbe\u5230\u9898\u76ee\u8981\u6c42\u3002\n\n\u9996\u5148\u5f88\u5bb9\u6613\u5c31\u53ef\u4ee5\u60f3\u5230\u7528\u5e76\u67e5\u96c6\u6765\u5224\u65ad $1$ \u548c $n$ \u662f\u5426\u8fde\u901a\uff0c\u5c3d\u91cf\u627e\u5230\u4e0b\u6807\u76f8\u8fd1\u7684\u70b9\u8fdb\u884c\u8fde\u901a\uff0c\u56e0\u4e3a $i-j$ \u8d8a\u63a5\u8fd1 $(i-j)^2$ \u8d8a\u5c0f\uff0c\u6700\u7ec8\u7684\u82b1\u8d39\u5c31\u8d8a\u4f18\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u901a\u8fc7\u679a\u4e3e\u4e2d\u95f4\u7684\u90a3\u4e00\u4e2a\u70b9\uff08\u56e0\u4e3a\u8fd9\u4e00\u4e2a\u70b9\u5305\u62ec\u8d77\u70b9\u548c\u7ec8\u70b9\uff0c\u6240\u4ee5\u76f8\u5f53\u4e8e\u540c\u65f6\u5224\u65ad\u4e86\u53ea\u8fde\u4e00\u6761\u8fb9\u7684\u60c5\u51b5\uff09\uff0c\u6765\u8ba1\u7b97\u8fde\u901a $1$ \u5230 $n$ \u7684\u4ef7\u503c\u3002\n\n\u4f46\u662f\u8fd9\u6837\u65f6\u95f4\u4f1a\u8d85\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a ```set<int> st[100005]``` \u6765\u4f18\u5316\u641c\u7d22\u65f6\u95f4\uff0c\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u53ef\u4ee5\u51cf\u5c11\u5230 $O(n \\log n)$ \u7ea7\u522b\u3002\n\n# \u4ee3\u7801\n\n\u4ee3\u7801\u5b9e\u73b0\u5982\u4e0b\uff1a\n```\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint fa[100005],t,n,m;\nset<int> st[100005];\nint find(int x){\n\treturn fa[x]==x?x:fa[x]=find(fa[x]);\n}\nint sqr(int x){\n\treturn x*x;\n}\nint solve(int x,int y){\n\tint ans=1e18;\n\tfor(set<int>::iterator it=st[x].begin();it!=st[x].end();it++){\n\t\tset<int>::iterator j=st[y].lower_bound(*it);\n\t\tif(j!=st[y].end())ans=min(ans,sqr((*j)-*it));\n\t\tif(j!=st[y].begin())ans=min(ans,sqr(*(--j)-*it));\n\t}\n\treturn ans;\n}\nsigned main(){\n\tscanf(\"%lld\",&t);\n\twhile(t--){\n\t\tscanf(\"%lld%lld\",&n,&m);\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tfa[i]=i;\n\t\t\tst[i].clear();\n\t\t}\n\t\tfor(int i=1,a,b;i<=m;i++){\n\t\t\tscanf(\"%lld%lld\",&a,&b);\n\t\t\tfa[find(a)]=find(b);\n\t\t}\n\t\tif(find(1)==find(n)){\n\t\t\tprintf(\"0\\n\");\n\t\t\tcontinue;\n\t\t}\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tst[find(i)].insert(i);\n\t\t}\n\t\tint ans=solve(find(1),find(n));\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tif(fa[i]==find(1)||fa[i]==find(n)||fa[i]!=i)continue;\n\t\t\tans=min(ans,solve(i,find(1))+solve(i,find(n)));\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1666700595,
        "uid": 698657,
        "name": "free_fall",
        "ccfLevel": 5,
        "title": "P7991 [USACO21DEC] Connecting Two Barns S \u9898\u89e3"
    },
    {
        "content": "\u597d\u9898\u3002\n\n# \u9898\u76ee\u5927\u610f\n\n\u7ed9\u51fa\u4e00\u4e2a $n$ \u4e2a\u70b9 $m$ \u6761\u8fb9\uff0c\u7f16\u53f7\u4ece $1$ \u5230 $n$ \u7684\u65e0\u5411\u56fe\uff0c\u53ef\u4ee5\u4ee5 $(i-j)^2$ \u7684\u4ee3\u4ef7\u5728\u4efb\u610f\u7684 $i,j$ \u4e4b\u95f4\u8fde\u4e00\u6761\u8fb9\u3002\n\n\u73b0\u5728\u53ef\u4ee5\u8fdb\u884c\u4e0d\u8d85\u8fc7\u4e24\u6b21\u8fde\u8fb9\u64cd\u4f5c\uff0c\u6c42\u4f7f\u5f97 $1$ \u548c $n$ \u4e24\u70b9\u8fde\u901a\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n# \u9898\u76ee\u5206\u6790\n\n\u56e0\u4e3a\u6700\u591a\u53ea\u80fd\u8fde $2$ \u6761\uff0c\u6240\u4ee5\u53ea\u4f1a\u51fa\u73b0\u4e09\u79cd\u60c5\u51b5\uff1a\n\n+ $1$ \u548c $n$ \u5df2\u5728\u540c\u4e00\u8fde\u901a\u5206\u91cf\u91cc\uff1b\n\n+ $1$ \u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u548c $n$ \u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u901a\u8fc7\u8fde\u63a5\u4e00\u6761\u8fb9\u4f7f\u5f97 $1$ \u548c $n$ \u5728\u540c\u4e00\u8fde\u901a\u5206\u91cf\u91cc\u3002\n\n+ $1$ \u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u548c $n$ \u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u901a\u8fc7\u5206\u522b\u5411\u53e6\u4e00\u8fde\u901a\u5206\u91cf\u8fde\u63a5\u4e00\u6761\u8fb9\u4f7f\u5f97 $1$ \u548c $n$ \u5728\u540c\u4e00\u8fde\u901a\u5206\u91cf\u91cc\u3002\n\n\u7b2c\u4e00\u79cd\u60c5\u51b5\u663e\u7136\u4ee3\u4ef7\u4e3a $0$\u3002\n\n\u6027\u8d28\uff1a\u6700\u4f18\u7b56\u7565\u4e2d\u8fde\u8fb9\u7684\u4e24\u4e2a\u9876\u70b9\u5dee\u503c\u5e94\u5c3d\u91cf\u5c0f\u3002\n\n\u5176\u4ed6\u60c5\u51b5\u6211\u4eec\u901a\u8fc7\u5e76\u67e5\u96c6\u5c06\u6240\u6709\u8fb9\u7684\u4e24\u4e2a\u9876\u70b9\u52a0\u5728\u540c\u4e00\u8fde\u901a\u5206\u91cf\u91cc\uff0c\u7136\u540e\u679a\u4e3e\u70b9 $i$\uff0c\u66f4\u65b0\u7b54\u6848\uff0c\u7b54\u6848\u5373\u4e3a $\\min\\limits_{i=1}^ndist(fa_1,i)+dist(i,fa_n)$\u3002\n\n\u600e\u4e48\u8ba1\u7b97 $dist(i,j)$ \u5462\uff1f\u53ef\u4ee5\u7528 $st_i$ \u8bb0\u5f55\u4ee5\u70b9 $i$ \u4e3a\u7956\u5148\u7684\u5b50\u5b59\u96c6\u5408\uff0c\u7136\u540e\u679a\u4e3e $st_i$ \u7684\u6240\u6709\u5143\u7d20\uff08\u8bb0\u5176\u4e2d\u4e00\u4e2a\u5b50\u5b59\u8282\u70b9\u4e3a $k$\uff09\uff0c\u518d\u5728 $st_j$ \u4e2d\u4e8c\u5206\u67e5\u627e\u5927\u4e8e $k$ \u7684\u6700\u8fd1\u4f4d\u7f6e $v$\uff0c\u679a\u4e3e\u6240\u6709\u7684\u8fb9 $(k,v)$ \u53d6\u6700\u5c0f\u4ef7\u503c\u5373\u53ef\u3002\n\n# \u4ee3\u7801\n\n```cpp\n//2022/2/19\n#define _CRT_SECURE_NO_WARNINGS\n#include <iostream>\n#include <cstdio>\n#include <climits>//need \"INT_MAX\",\"INT_MIN\"\n#include <cstring>//need \"memset\"\n#include <algorithm>\n#include <set>\n#define int long long\n#define enter() putchar(10)\n#define debug(c,que) cerr << #c << \" = \" << c << que\n#define cek(c) puts(c)\n#define blow(arr,st,ed,w) for(register int i = (st);i <= (ed); ++ i) cout << arr[i] << w;\n#define speed_up() cin.tie(0),cout.tie(0)\n#define mst(a,k) memset(a,k,sizeof(a))\n#define Abs(x) ((x) > 0 ? (x) : (-x))\nconst int mod = 1e9 + 7;\ninline int MOD(int x) {\n\twhile (x < 0) x += mod;\n\twhile (x >= mod) x -= mod;\n\treturn x;\n}\nnamespace Newstd {\n\tchar buf[1 << 21],*p1 = buf,*p2 = buf;\n\tinline int getc() {\n\t\treturn p1 == p2 && (p2 = (p1 = buf) + fread(buf,1,1 << 21,stdin),p1 == p2) ? EOF : *p1 ++;\n\t}\n\tinline int read() {\n\t\tint ret = 0,f = 0;char ch = getc();\n\t\twhile (!isdigit(ch)) {\n\t\t\tif(ch == '-') f = 1;\n\t\t\tch = getc();\n\t\t}\n\t\twhile (isdigit(ch)) {\n\t\t\tret = (ret << 3) + (ret << 1) + ch - 48;\n\t\t\tch = getc();\n\t\t}\n\t\treturn f ? -ret : ret;\n\t}\n\tinline void write(int x) {\n\t\tif(x < 0) {\n\t\t\tputchar('-');\n\t\t\tx = -x;\n\t\t}\n\t\tif(x > 9) write(x / 10);\n\t\tputchar(x % 10 + '0');\n\t}\n}\nusing namespace Newstd;\nusing namespace std;\n\nconst int INF = 0x3f3f3f3f3f3f3f3f;\nconst int ma = 1e5 + 5;\nint fa[ma];\nset<int>st[ma];\nint T,n,m;\ninline int getf(int x) {\n\treturn fa[x] == x ? x : fa[x] = getf(fa[x]);\n}\ninline void merge(int x,int y) {\n\tint f1 = getf(x),f2 = getf(y);\n\tif (f1 != f2) fa[f1] = f2;\n}\ninline int sq(int x) {\n\treturn x * x;\n}\ninline int dist(int x,int y) {\n\tint ans = INF;\n\tfor (set<int>::iterator it = st[x].begin();it != st[x].end(); ++ it) {\n\t\tset<int>::iterator tmp = st[y].upper_bound(*it);\n\t\tif (tmp != st[y].end()) {\n\t\t\tans = min(ans,sq(*tmp - *it));\n\t\t}\n\t\tif (tmp != st[y].begin()) {\n\t\t\tans = min(ans,sq(*(-- tmp) - *it));\n\t\t}\n\t}\n\treturn ans;\n}\ninline void solve() {\n\tn = read(),m = read();\n\tfor (register int i = 1;i <= n; ++ i) {\n\t\tfa[i] = i;\n\t\tst[i].clear();\n\t}\n\tfor (register int i = 1;i <= m; ++ i) {\n\t\tint u = read(),v = read();\n\t\tmerge(u,v);\n\t}\n\tfor (register int i = 1;i <= n; ++ i) {\n\t\tst[getf(i)].insert(i);\n\t}\n\tif (getf(1) == getf(n)) {\n\t\tputs(\"0\");\n\t} else {\n\t\tint ans = dist(getf(1),getf(n));\n\t\tfor (register int i = 1;i <= n; ++ i) {\n\t\t\tif (getf(1) != getf(i) && getf(n) != getf(i)) {\n\t\t\t\tans = min(ans,dist(i,getf(1)) + dist(i,getf(n)));\n\t\t\t}\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n}\nsigned main(void) {\n#ifndef ONLINE_JUDGE\n\tfreopen(\"in.txt\",\"r\",stdin);\n#endif\n\tT = read();\n\twhile (T --) {\n\t\tsolve();\n\t}\n\n\treturn 0;\n}\n```",
        "postTime": 1645275067,
        "uid": 430409,
        "name": "Coros_Trusds",
        "ccfLevel": 6,
        "title": "P7991 [USACO21DEC] Connecting Two Barns S"
    },
    {
        "content": "\u672c\u9898\u6211\u4eec\u53ef\u4ee5\u5206\u4e3a\u8fd9\u51e0\u79cd\u60c5\u51b5\n\n\u60c5\u51b5\u4e00\uff1a $1$ \u4e0e $n$\u200b \u672c\u8eab\u5df2\u7ecf\u8054\u901a\n\n\u60c5\u51b5\u4e8c\uff1a\u4ece $1$ \u548c $n$\u200b \u5206\u522b\u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u4e2d\u627e\u51fa\u4e24\u4e2a\u70b9\u8fde\u4e00\u6761\u8fb9\n\n\u60c5\u51b5\u4e09\uff1a\u5c06 $1$ \u548c $n$\u200b \u5206\u522b\u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u548c\u53e6\u4e00\u4e2a\u8fde\u901a\u5206\u91cf\u8fde\u4e24\u6761\u8fb9\n\n\u5bf9\u4e8e\u60c5\u51b5\u4e00\uff0c\u76f4\u63a5\u8f93\u51fa $0$ \u5373\u53ef\n\n\u5bf9\u4e8e\u60c5\u51b5\u4e8c\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u9884\u5904\u7406\u51fa\u6bcf\u4e2a\u70b9\u5230 $1$ \u548c $n$ \u5206\u522b\u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u7684\u6700\u5c0f\u4ee3\u4ef7\uff0c\u679a\u4e3e $1$ \u548c $n$\u200b \u5206\u522b\u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u4e2d\u7684\u70b9\n\n\u5bf9\u4e8e\u60c5\u51b5\u4e09\uff0c\u6211\u4eec\u540c\u6837\u50cf\u50cf\u60c5\u51b5\u4e8c\u4e00\u6837\u9884\u5904\u7406\uff0c\u4e4b\u540e\u679a\u4e3e\n\n\u4f46\u662f\u8fd9\u4f1a **TLE**\n\n\u6211\u4eec\u9700\u8981\u5f15\u5165\u4e24\u4e2a\u65b0\u7684\u6570\u7ec4 $minA$ \u4e0e $minB$\u200b\n\n $minA_i$ \u8868\u793a $i$ \u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u5230 $1$ \u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u7684\u6700\u5c0f\u4ee3\u4ef7\n\n $minB_i$ \u8868\u793a $i$ \u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u5230 $n$ \u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\u7684\u6700\u5c0f\u4ee3\u4ef7\n\n\u4e4b\u540e\u7167\u65e7\uff0c\u590d\u6742\u5ea6\u5c31\u4f1a\u5c0f\u5f88\u591a\uff08 $O(n)$\u200b \uff09\n\n```c++\n#include <cstdio>\n#include <vector>\n#include <algorithm>\n#define min(a,b) ((a)<(b)?(a):(b))\ntypedef long long ll;\nusing namespace std;\nconst int inf=0x3f3f3f3f;\nconst int N=1e5+7;\nstruct bcj {\n\tint fa[N];\n\tinline bcj() {\n\t\tclear();\n\t}\n\tinline void clear() {\n\t\tfor(int i=0;i<N;++i)\n\t\t\tfa[i]=i;\n\t}\n\tinline int find(int x) {\n\t    while(x!=fa[x]) \n\t    \tfa[x]=fa[fa[x]],x=fa[x];\n\t    return x;\n\t}\n\tinline void merge(int x,int y) {\n\t\tfa[find(x)]=find(y);\n\t}\n\tinline bool check(int x,int y) {\n\t\treturn find(x)==find(y);\n\t}\n}f;\n\nvector<int> a,b;\n\nll A[N],B[N];\nll minA[N],minB[N];\nint father[N];\n\nint T,n,m;\nll ans;\n\ninline void resetA() {\n\tsort(a.begin(),a.end());\n\tif(a.size()==1) {\n\t\tfor(int i=1;i<=n;++i)\n\t\t\tA[i]=i-1;\n\t\treturn ;\n\t}\n\tfor(int i=1,l,r;i<a.size();++i) {\n\t\tl=a[i-1],r=a[i];\n\t\tfor(int j=l;j<=r;++j)\n\t\t\tA[j]=min(j-l,r-j);\n\t}\n\tfor(int i=a[a.size()-1];i<=n;++i)\n\t\tA[i]=i-a[a.size()-1];\n}\n\ninline void resetB() {\n\tsort(b.begin(),b.end());\n\tif(b.size()==1) {\n\t\tfor(int i=1;i<=n;++i)\n\t\t\tB[i]=n-i;\n\t\treturn ;\n\t}\n\tfor(int i=1;i<=b[0];++i)\n\t\tB[i]=b[0]-i;\n\tfor(int i=1,l,r;i<b.size();++i) {\n\t\tl=b[i-1],r=b[i];\n\t\tfor(int j=l;j<=r;++j)\n\t\t\tB[j]=min(j-l,r-j);\n\t}\n\tfor(int i=b[b.size()-1];i<=n;++i)\n\t\tB[i]=i-b[b.size()-1];\n}\n\ninline void Clean() {\n\tf.clear();\n\ta.clear(),b.clear();\n\tfor(int i=1;i<=n;++i)\n\t\tminA[i]=inf,minB[i]=inf;\n}\n\nsigned main() {\n\tscanf(\"%d\",&T);\n\tfor(;T;--T) {\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tClean();\n\t\tfor(int i=1,u,v;i<=m;++i) {\n\t\t\tscanf(\"%d%d\",&u,&v);\n\t\t\tf.merge(u,v);\n\t\t}\n\t\tif(f.check(1,n)) {\n\t\t\tputs(\"0\");\n\t\t\tcontinue;\n\t\t} // 1\u4e0en\u672c\u8eab\u5df2\u7ecf\u8054\u901a\n\t\tfor(int i=1;i<=n;++i)\n\t\t\tif(f.check(1,i))\n\t\t\t\ta.push_back(i),father[i]=1;\n\t\t\telse if(f.check(i,n))\n\t\t\t\tb.push_back(i),father[i]=n;\n\t\t\telse\n\t\t\t\tfather[i]=f.find(i);// \u9884\u5904\u7406\u6bcf\u4e2a\u70b9\u6240\u5728\u7684\u8fde\u901a\u5206\u91cf\n\t\tresetA(),resetB();\n\t\tfor(int i=1;i<=n;++i) {\n\t\t\tminA[father[i]]=min(minA[father[i]],A[i]);\n\t\t\tminB[father[i]]=min(minB[father[i]],B[i]);\n\t\t}\n\t\tans=minB[1]*minB[1];\n\t\tfor(int i=1;i<=n;++i)\n\t\t\tif(father[i]!=1 && father[i]!=n)\n\t\t\tans=min(ans,minA[father[i]]*minA[father[i]]+minB[father[i]]*minB[father[i]]);\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n    return 0;\n}\n```\n\n",
        "postTime": 1640510835,
        "uid": 357101,
        "name": "wshcl",
        "ccfLevel": 4,
        "title": "P7991 [USACO21DEC] Connecting Two Barns S \u9898\u89e3"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\u3002](https://www.luogu.com.cn/blog/lvsiji/solution-p7991)\n## \u9898\u610f\n\u7ed9\u5b9a $n$ \u4e2a\u70b9\uff0c\u95ee\u7528****\u81f3\u591a $2$ \u6761\u8def\u5f84****\u8fde\u63a5\u70b9 $1$ \u548c $N$ \u6700\u5c0f\u4ee3\u4ef7\u3002\n## \u601d\u8def\n\u770b\u89c1\u8fd9\u9898\u7b2c\u4e00\u53cd\u5e94\uff1a****\u5e76\u67e5\u96c6****\uff01\n\n\u9898\u4e2d\uff0c\u63d0\u5230\n\u201c****\u4ed6\u613f\u610f\u5efa\u9020\u81f3\u591a\u4e24\u6761\u65b0\u9053\u8def\u6765\u5b9e\u73b0\u8fd9\u4e00\u76ee\u6807****\u201d\uff0c\u90a3\u4e48\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5bf9\u4e8e\u8fd9\u9898\uff0c\u6709****\u4e09\u79cd****\u53ef\u80fd\u89e3\u6cd5\uff1a\n\n- \u8fde\u63a5 $0$ \u6761\u8def\uff0c\u5f53\u4e14\u4ec5\u5f53\u7530\u5730 $1$ \u548c\u7530\u5730 $N$ \u5904\u4e8e\u540c\u4e00\u8fde\u901a\u5206\u91cf\u3002\n- \u8fde\u63a5 $1$ \u6761\u8def\uff0c\u76f4\u63a5\u8fde\u63a5\u7530\u5730 $1$ \u548c\u7530\u5730 $N$\uff0c\u4f7f\u4e4b\u5904\u4e8e\u540c\u4e00\u8fde\u901a\u5206\u91cf\u3002\n- \u8fde\u63a5 $2$ \u6761\u8def\uff0c\u901a\u8fc7\u4e00\u8054\u901a\u5206\u91cf $mid$ \u95f4\u63a5\u8fde\u63a5\u7530\u5730 $1$ \u548c\u7530\u5730 $N$\uff0c\u4f7f\u4e4b\u5904\u4e8e\u540c\u4e00\u8fde\u901a\u5206\u91cf\u3002\n\n\u5bf9\u4e8e\u4e00\u8054\u901a\u5206\u91cf\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u7528 ```vector``` \u5c06\u5176\u5b58\u8d77\u6765\u3002\n\n\u6bcf\u6b21\u8003\u8651\u8fde\u901a\u5206\u91cf $i$ \u4e2d $x$ \u70b9\u53bb\u8fde\u63a5\u8fde\u901a\u5206\u91cf $j$ \u4e2d\u7684\u54ea\u4e2a $y$ \u70b9\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7****\u4e8c\u5206\u67e5\u627e**** ```lower_bound``` \u53bb\u641c\u7d22\u79bb $x$ \u7684 $j$ \u4e2d\u6700\u8fd1\u70b9\u3002\n\n\u7ec6\u8282\u8f83\u591a\uff0c\u8be6\u89c1\u4ee3\u7801\u3002\n```cpp\n#include<bits/stdc++.h>\n#define int long long //\u5341\u5e74OI\u4e00\u573a\u7a7a\uff0c\u4e0d\u5f00longlong\u89c1\u7956\u5b97\n#define pd push_back\nusing namespace std;\nconst int N=1e5+5;\nint fa[N],n,T,m;\nint GetRoot(int x) { //\u5e76\u67e5\u96c6\u8def\u5f84\u538b\u7f29\uff08\u53ef\u4ee5\u52a0\u4e0a\u6309\u8f76\u5408\u5e76\uff09\n\tif(x==fa[x])\n\t\treturn x;\n\treturn fa[x]=GetRoot(fa[x]);\n}\nvoid Union(int x,int y) { //\u5408\u5e76\u4e24\u4e2a\u8fde\u901a\u5206\u91cf\n\tfa[GetRoot(x)]=fa[GetRoot(y)];\n}\nsigned main() {\n\tscanf(\"%lld\",&T);\n\twhile(T--) {\n\t\tscanf(\"%lld%lld\",&n,&m);\n\t\tfor(int i=1;i<=n;i++) fa[i]=i;\n\t\twhile(m--) {\n\t\t\tint u,v;\n\t\t\tscanf(\"%lld%lld\",&u,&v);\n\t\t\tUnion(u,v);\n\t\t}\n\t\tfor(int i=1;i<=n;i++) GetRoot(i); \u6ce8\u610f\u6709\u4e9b\u5b69\u5b50\u53ef\u80fd\u8fd8\u6ca1\u6709\u627e\u5230\u7956\u5b97\n\t\tvector<int> vec[N]; //vector\u5b58\u8fde\u901a\u5206\u91cf\n\t\tfor(int i=1;i<=n;i++) {\n\t\t\tif(fa[1]==fa[i]) vec[0].pd(i);\n\t\t\telse if(fa[n]==fa[i]) vec[n].pd(i);\n\t\t\telse vec[fa[i]].pd(i);\n\t\t}\n//\t\tfor(int i=1;i<=n;i++) {\n//\t\t\tif(vec[i].empty()) continue;\n//\t\t\tprintf(\"fa=%lld's list=[\",i);\n//\t\t\tfor(int j=0;j<vec[i].size();j++)\n//\t\t\t\tprintf(\" %lld\",vec[i][j]);\n//\t\t\tputs(\"]\");\n//\t\t}\n\t\tif(fa[1]==fa[n]) { //\u65e0\u9700\u8fde\u63a5\n\t\t\tputs(\"0\"); continue;\n\t\t}\n\t\tint ans=1e10;\n\t\tfor(int i=0;i<vec[0].size();i++) { //\u76f4\u63a5\u8fde\u63a5\n\t\t\tint x=lower_bound(vec[n].begin(),vec[n].end(),vec[0][i])-vec[n].begin();\n\t\t\tif(x!=vec[n].size()) ans=min(ans,(vec[n][x]-vec[0][i])*(vec[n][x]-vec[0][i]));\n\t\t\tif(x!=0) ans=min(ans,(vec[0][i]-vec[n][x-1])*(vec[0][i]-vec[n][x-1]));\n\t\t}\n\t\tfor(int i=2;i<n;i++) { //\u95f4\u63a5\u8fde\u63a5\n\t\t\tint a=1e5,b=1e5;\n\t\t\tif(vec[i].empty()) continue;\n\t\t\tfor(int j=0;j<vec[i].size();j++) {\n\t\t\t\tint x=lower_bound(vec[0].begin(),vec[0].end(),vec[i][j])-vec[0].begin();\n\t\t\t\tint y=lower_bound(vec[n].begin(),vec[n].end(),vec[i][j])-vec[n].begin();\n\t\t\t\tif(x!=vec[0].size()) a=min(a,vec[0][x]-vec[i][j]);\n\t\t\t\tif(y!=vec[n].size()) b=min(b,vec[n][y]-vec[i][j]);\n\t\t\t\tif(x!=0) a=min(a,vec[i][j]-vec[0][x-1]);\n\t\t\t\tif(y!=0) b=min(b,vec[i][j]-vec[n][y-1]);\n\t\t\t}\n\t\t\tif(a==1e5||b==1e5) continue;\n\t\t\tans=min(ans,a*a+b*b);\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 1;\n}\n```\n",
        "postTime": 1640410653,
        "uid": 468657,
        "name": "lsj2009",
        "ccfLevel": 6,
        "title": "P7991 code"
    },
    {
        "content": "## \u601d\u8def\uff1a\n\u53ef\u4ee5\u5206\u4e09\u79cd\u60c5\u51b5\u8fdb\u884c\u8ba8\u8bba\uff1a\n\n$1.$ \u4e0d\u8fde\u8fb9\uff1b\n\n$2.$ \u8fde\u4e00\u6761\u8fb9\uff1b\n\n$3.$ \u8fde\u4e8c\u6761\u8fb9\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u7b2c\u4e8c\u79cd\u548c\u7b2c\u4e09\u79cd\u60c5\u51b5\u653e\u5728\u4e00\u8d77\u64cd\u4f5c\u3002\n\n------------\n\n\n\u7b2c\u4e00\u79cd\u60c5\u51b5\uff1a\n\n\u5f53 $1$ \u548c $n$ \u5728\u540c\u4e00\u96c6\u5408\u65f6\uff0c\u82b1\u8d39\u4e3a $0$\u3002\n\n\n\n------------\n\u7b2c\u4e8c&\u4e09\u79cd\u60c5\u51b5\uff1a\n\n\u5199\u4e00\u4e2a\u6c42\u51fa\u4efb\u610f\u4e24\u4e2a\u96c6\u5408\u7684\u6700\u77ed\u8ddd\u79bb\u7684\u51fd\u6570\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u6c42\u51fa\u7b2c\u4e8c\u79cd\u60c5\u51b5\u7684\u4ee3\u4ef7\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e09\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u679a\u4e3e\u4e2d\u8f6c\u96c6\u5408\uff0c\u8ba1\u7b97\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n\u5982\u679c\u76f4\u63a5\u904d\u5386\u96c6\u5408\u4e2d\u6240\u6709\u5143\u7d20\u7684\u8bdd\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u6709\u70b9\u5371\u9669\u3002\n\n\u4e8e\u662f\u53ef\u4ee5\u4f7f\u7528\u4e8c\u5206\u67e5\u627e\uff0c\u627e\u5230\u4e0e\u5f53\u524d\u70b9\u82b1\u8d39\u6700\u5c0f\u7684\u70b9\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u8fc7\u4e86\u3002\n\n```\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst int N = 1e5 + 7;\nconst ll inf = 1e18;\n\nint fa[N];\n\nset<int> s[N];\n\nint find (int x) {\n\treturn fa[x] == x ? x : fa[x] = find (fa[x]);\n}\n\ninline void unionn (int x, int y) {\n\tfa[find (x)] = find (y);\n}\n\ninline ll pf (ll x) {\n\treturn x * x;\n}\n\ninline ll calc (int x, int y) {\n\tll res = inf;\n\t\n\tfor (set<int>::iterator i = s[x].begin (); i != s[x].end (); i ++) {\n\t\tset<int>::iterator j = s[y].upper_bound (*i);\n\t\t//\u5bfb\u627ey\u96c6\u5408\u4e2d\u7b2c\u4e00\u4e2a\u6700\u5c0f\u7684\u5927\u4e8ei\u7684\u5143\u7d20\u3002 \n\t\t\n\t\tif (j != s[y].end ()) {\n\t\t\tres = min (res, pf ((*j) - (*i)));\n\t\t\t//\u76f4\u63a5\u8ba1\u7b97\u7b54\u6848\u3002 \n\t\t} \n\t\t\n\t\tif (j != s[y].begin ()) {\n\t\t\tres = min (res, pf ((*(-- j)) - *i));\n\t\t\t\n\t\t\t//\u8ba1\u7b97\u5c0f\u4e8ei\u4e14\u6700\u5927\u7684\u5143\u7d20\u4ee3\u4ef7\u3002 \n\t\t}  \n\t\t\n\t\t/*\u53ea\u8981\u4e8c\u5206\u5230\u4e0d\u662f\u4e2d\u8f6c\u96c6\u5408\u4e2d\u6700\u5c0f\u548c\u6700\u5927\u7684\u70b9\uff0c\n     \t\u6709\u4e24\u79cd\u53ef\u80fd\u4e2d\u7684\u4e00\u79cd\u4f1a\u4f7f\u7b54\u6848\u6700\u4f18\uff0c\u53ef\u4ee5\u60f3\u60f3\u4e3a\u4ec0\u4e48\u3002\n\t\t*/ \n\t}\n\t\n\treturn res;\n}\n\nsigned main () {\n\tint T;\n\t\n\tscanf (\"%d\", &T);\n\t\n\twhile (T --) {\n\t\tint n, m;\n\t\t\n\t\tscanf (\"%d%d\", &n, &m);\n\t\t\n\t\tfor (int i = 1; i <= n; i ++) {\n\t\t\tfa[i] = i;\n\t\t}\n\t\t\n\t\tfor (int i = 1; i <= n; i ++) {\n\t\t\ts[i].clear ();\n\t\t}\n\t\t\n\t\tfor (int i = 1; i <= m; i ++) {\n\t\t\tint x, y;\n\t\t\t\n\t\t\tscanf (\"%d%d\", &x, &y);\n\t\t\t\n\t\t\tunionn (x, y);\t\n\t\t}\n\t\t\n\t\tfor (int i = 1; i <= n; i ++) {\n\t\t\tint fi = find (i);\n\t\t\t\n\t\t\ts[fi].insert (i);\n\t\t}\n\t\t\n\t\tint f1 = find (1), fn = find (n);\n\t\t\n\t\tif (f1 == fn) {\n\t\t\tprintf (\"%lld\\n\", 0);//\u60c5\u51b51\u3002\t\n\t\t}\n\t\t\n\t\telse {\n\t\t\tll ans = calc (f1, fn);\n\n\t\t\tfor (int i = 1; i <= n; i ++) {\n\t\t\t\tif (fa[i] == f1 || fa[i] == fn) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tans = min (ans, calc (i, f1) + calc (i, fn));\n\t\t\t\t//\u8bb0\u5f55\u6700\u5c0f\u4ee3\u4ef7\u3002 \n\t\t\t}\n\t\t\t\n\t\t\tprintf (\"%lld\\n\", ans);\t\n\t\t}\n\t}\n\t\n\treturn 0;\n}\n```\n",
        "postTime": 1640355635,
        "uid": 508316,
        "name": "cyhyyds",
        "ccfLevel": 0,
        "title": "P7991 [USACO21DEC] Connecting Two Barns S \u9898\u89e3"
    },
    {
        "content": "## Problem\n\n\u6709\u4e00\u5f20\u56fe\uff08\u4e0d\u4e00\u5b9a\u8054\u901a\uff09\uff0c\u4e24\u4e2a\u70b9 $i,j$ \u4e4b\u95f4\u7684\u8fb9\u6743\u4e3a $0$ \u6216 $(i-j)^2$\uff0c\u6c42\u4ece $1$ \u53f7\u70b9\u8d70\u5230 $n$ \u53f7\u70b9\uff0c\u8d70\u81f3\u591a\u4e24\u6761\u4e0d\u4e3a $0$ \u8fb9\u7684\u6700\u77ed\u8def\u3002\n\n## Solution\n\n\u663e\u7136\uff0c\u53ef\u4ee5\u8f6c\u5316\u4e3a\u4e24\u90e8\u5206\uff1a\n\n- \u4ece\u8d77\u70b9\u8d70\u5230\u4e00\u4e2a\u70b9\n\n- \u4ece\u53e6\u4e00\u4e2a\u70b9\u8d70\u5230\u7ec8\u70b9\u3002\n\n\u7b2c\u4e00\u6b65\uff0c\u628a\u6240\u6709\u8054\u901a\u5757\u6c42\u51fa\u6765\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u53ef\u4ee5\u7528 $\\Theta(n)$ \u7684\u590d\u6742\u5ea6\u5206\u522b\u6c42\u51fa\u6bcf\u4e2a\u70b9\u5230\u8d77\u70b9\u548c\u7ec8\u70b9\u7684\u8ddd\u79bb\u3002\n\n\u6700\u540e\uff0c\u5728\u6bcf\u4e2a\u8054\u901a\u5757\u4e2d\u8fdb\u884c\u5904\u7406\u3002\t\n\n## Code\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nconst int mod=1000000007;\nconst int N=100005,M=200005;\nint hd[N],nxt[M],to[M],tot;\nint f[N];\nvoid add(int x,int y)\n{\n\tto[++tot]=y;\n\tnxt[tot]=hd[x];\n\thd[x]=tot;\n}\nint find(int x){return f[x]==x?x:find(f[x]);}\nint n,m,T;\nbool AAGH;\nchar vis[N];\nint d1[N],d2[N],c1,c2;\nll len1[N],len2[N];\nll mn1[N],mn2[N];\nvoid dfs(int u)\n{\n\tif(u==n) AAGH=1;\n\tvis[u]=1;\n\td1[++c1]=u;\n//\ts1.insert(u);\n//\tprintf(\"1 in %d\\n\",u);\n\tfor(int i=hd[u];i;i=nxt[i])\n\t\tif(!vis[to[i]]) dfs(to[i]);\n}\nvoid dfs2(int u)\n{\n\tvis[u]=2;\n//\ts2.insert(u);\n\td2[++c2]=u;\n//\tprintf(\"2 in %d\\n\",u);\n\tfor(int i=hd[u];i;i=nxt[i])\n\t\tif(!vis[to[i]]) dfs2(to[i]);\n}\nint main()\n{\n\tscanf(\"%d\",&T);\n\tset<int>::iterator it;\n\tint ta,tb;\n\tll tc,td,ans;\n\twhile(T--)\n\t{\n\t\ttot=0;\n\t\tans=0x3f3f3f3f3f3f3f3f;\n\t\tmemset(hd,0,sizeof(hd));\n\t\tmemset(vis,0,sizeof(vis));\n\t\tmemset(mn1,0x3f,sizeof(mn1));\n\t\tmemset(mn2,0x3f,sizeof(mn2));\n\t\tc1=c2=0;\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tAAGH=0;\n\t\tfor(int i=1;i<=n;i++) f[i]=i;\n\t\tfor(int i=1;i<=m;i++)\n\t\t{\n\t\t\tscanf(\"%d%d\",&ta,&tb);\n\t\t\tadd(ta,tb);\n\t\t\tadd(tb,ta);\n\t\t\tf[find(ta)]=find(tb);\n\t\t}\n\t\tdfs(1);\n\t\tif(AAGH)\n\t\t{\n\t\t\tprintf(\"0\\n\");\n\t\t\tcontinue;\n\t\t}\n\t\tdfs2(n);\n\t\tsort(d1+1,d1+c1+1);\n\t\tsort(d2+1,d2+c2+1);\n\t\td1[c1+1]=0x3f3f3f3f;\n\t\td2[0]=0x3f3f3f3f;\n\t\tint it=1;\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tif(abs(d1[it+1]-i)<=abs(d1[it]-i)) it++;\n\t\t\tlen1[i]=1ll*(i-d1[it])*(i-d1[it]);\n\t\t\t\n\t\t}\n\t\tit=c2;\n\t\tfor(int i=n;i>=1;i--)\n\t\t{\n\t\t\tif(abs(d2[it-1]-i)<=abs(d2[it]-i)) it--;\n\t\t\tlen2[i]=1ll*(i-d2[it])*(i-d2[it]);\n\t\t\t\n\t\t}\n//\t\tfor(int i=1;i<=n;i++) printf(\"%lld \",len1[i]); printf(\"\\n\");\n//\t\tfor(int i=1;i<=n;i++) printf(\"%lld \",len2[i]); printf(\"\\n\");\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tmn1[find(i)]=min(mn1[find(i)],len1[i]);\n\t\t\tmn2[find(i)]=min(mn2[find(i)],len2[i]);\n\t\t}\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tans=min(ans,mn1[i]+mn2[i]);\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n//\t\tprintf(\"%lld\\n\",min(ans,hh(n)));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1640086657,
        "uid": 148507,
        "name": "_Imaginary_",
        "ccfLevel": 0,
        "title": "2021DEC S2"
    },
    {
        "content": "## \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a $n$ \u4e2a\u70b9 $m$ \u6761\u8fb9\u7684\u6709\u5411\u56fe $G$\uff0c\u8981\u6c42\u518d\u52a0\u81f3\u591a\u4e24\u6761\u8fb9\uff0c\u4f7f\u5f97\u8282\u70b9 $1$ \u548c\u8282\u70b9 $n$ \u5728\u4e00\u4e2a\u8fde\u901a\u5757\u5185\u3002\n\n## \u89e3\u6cd5\n\n\u9996\u5148\uff0c\u9898\u76ee\u4e2d\u7684\u201c\u52a0\u8fb9\u201d\u5b9e\u9645\u4e0a\u53ea\u6709\u4e09\u79cd\u5f62\u5f0f\uff1a\n\n- \u8282\u70b9 $1$ \u548c\u8282\u70b9 $n$ \u672c\u6765\u5c31\u5728\u4e00\u4e2a\u8fde\u901a\u5757\u5185\uff0c\u4e0d\u7528\u52a0\u8fb9\u3002\n- \u5c06\u8282\u70b9 $1$ \u548c\u8282\u70b9 $n$ \u5206\u522b\u6240\u5728\u7684\u8fde\u901a\u5757\u4e2d\u53d6\u4e24\u4e2a\u70b9\u8fde\u8fb9\uff0c\u5171\u8fde\u4e00\u6761\u8fb9\u3002\n- \u5c06\u8282\u70b9 $1$ \u548c\u8282\u70b9 $n$ \u5206\u522b\u6240\u5728\u7684\u8fde\u901a\u5757\u548c\u7b2c\u4e09\u4e2a\u8fde\u901a\u5757\u76f8\u8fde\uff0c\u5171\u8fde\u4e24\u6761\u8fb9\u3002\n\n\u800c\u7b2c\u4e8c\u79cd\u52a0\u8fb9\u5f62\u5f0f\u542f\u53d1\u6211\u4eec\u5b9a\u4e49 $f_i$ \u4e3a\u8282\u70b9 $i$ \u6240\u5728\u8fde\u901a\u5757\u4e2d\u7684\u4e00\u4e2a\u70b9\u5411\u8282\u70b9 $1$ \u8fde\u8fb9\u7684\u6700\u5c0f\u4ee3\u4ef7\uff0c\u5b9a\u4e49 $g_i$ \u4e3a\u8282\u70b9 $i$ \u6240\u5728\u8fde\u901a\u5757\u4e2d\u7684\u4e00\u4e2a\u70b9\u5411\u8282\u70b9 $n$ \u6240\u5728\u8fde\u901a\u5757\u8fde\u8fb9\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\uff08\u5b9e\u9645\u4e0a\u4ee3\u7801\u5185\u53ea\u8ba1\u7b97\u4e86\u6240\u6709\u4f5c\u4e3a\u5e76\u67e5\u96c6\u6839\u8282\u70b9\u7684 $f$ \u548c $g$ \u503c\uff09\n\n\u5177\u4f53\u6765\u8bb2\uff0c\u7528\u4e24\u4e2a\u6570\u7ec4 $s_1$ \u548c $s_n$ \u4ee3\u8868\u8282\u70b9 $1$ \u548c\u8282\u70b9 $n$ \u6240\u5728\u7684\u8fde\u901a\u5757\u4e2d\u7684\u8282\u70b9\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $i \\in [1, n]$ \uff0c\u4e8c\u5206\u51fa\u4e0e $s_1$ \u6216 $s_n$ \u4e2d\u5dee\u503c\u6700\u5c0f\u7684\u4e00\u4e2a\u8282\u70b9\uff0c\u8ba1\u7b97\u4ee3\u4ef7\uff0c\u66f4\u65b0\u6839\u8282\u70b9\u7684 $f$ \u6216 $g$ \u5373\u53ef\u3002\n\n\u800c\u5982\u4f55\u7ef4\u62a4\u56fe\u4e2d\u7684\u6bcf\u4e2a\u8fde\u901a\u5757\u5462\uff1f\u6211\u4eec\u60f3\u5230\u4e86\u5e76\u67e5\u96c6\u3002\n\n\u5176\u4ed6\u8be6\u60c5\u89c1\uff08\u672c\u849f\u84bb\u4e11\u964b\u7684\uff09\u4ee3\u7801\uff1a\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <limits.h>\n#include <cstring>\n#include <vector>\n//#include <time.h>\nusing namespace std;\n\ntypedef long long LL;\ntypedef pair<int, int> PII;\nconst int INF = 0x3f3f3f3f, INF_BIT = 0x3f;\n\nconst int N = 1e5 + 10;\n\nLL t;\nLL n, m;\nLL u, v;\n\nLL fa[N];\nLL find(LL x){\n    if(fa[x] == x) return x;\n    else return fa[x] = find(fa[x]);\n}\nvoid merge(LL x, LL y){\n    LL fx = find(x), fy = find(y);\n    if(fx != fy){\n        fa[fx] = fy;\n    }\n}\n\n//\u8282\u70b91\u548c\u8282\u70b9n\u5bf9\u5e94\u7684\u6811\u4e2d\u6709\u90a3\u4e9b\u8282\u70b9\nLL s1[N], sn[N];\nLL ind1, indn;\n\nLL f[N], g[N];  //\u89c1\u4e0a\uff08\u9898\u89e3\u63cf\u8ff0\uff09\n\n//\u6c42\u5728a\u4e2d\u9009\u62e9\u4e00\u4e2a\u6570y\uff0c\u4f7f\u5f97(x - y) ^ 2\u6700\u5c0f\uff0c\u90a3\u4e48(x - y) ^ 2\u4e3a\u591a\u5c11\n//\u5176\u5b9e\uff0c(x - y) ^ 2\uff0c\u90a3\u4e48|x - y|\u4e5f\u6700\u5c0f\nLL getcost(LL x, LL a[], LL n){\n    //\u627e\u5230\u4e24\u4e2a\u5728x\u9644\u8fd1\u7684\u6570\n    LL ind1 = lower_bound(a + 1, a + n + 1, x) - a;\n    LL ind2 = ind1 - 1;\n    LL chsval;\n    //\u6bd4\u8f83\u90a3\u4e2a\u5dee\u503c\u6700\u8fd1\uff0c\u5f97\u5230y\uff08\u4e0a\u6587\u6ce8\u91ca\u4e2d\u7684\uff09\n    if(ind2 < 1) chsval = a[ind1];\n    else if(ind1 > n) chsval = a[ind2];\n    else{\n        LL dif1 = abs(x - a[ind1]);\n        LL dif2 = abs(x - a[ind2]);\n        if(dif1 < dif2){\n            chsval = a[ind1];\n        }else{\n            chsval = a[ind2];\n        }\n    }\n    return (x - chsval) * (x - chsval);\n}\n\nLL ans;\n\nint main(){\n    scanf(\"%lld\", &t);\n    while(t--){\n        scanf(\"%lld%lld\", &n, &m);\n        \n        for(LL i = 1;i <= n;i++){\n            fa[i] = i;\n        }\n        \n        for(LL i = 1;i <= m;i++){\n            scanf(\"%lld%lld\", &u, &v);\n            \n            merge(u, v);\n        }\n        \n        //int st = clock();\n        \n        LL f1 = find(1), fn = find(n);\n        ind1 = indn = 0;\n        for(LL i = 1;i <= n;i++){\n            LL fx = find(i);\n            if(fx == f1) s1[++ind1] = i;\n            if(fx == fn) sn[++indn] = i;\n        }\n        \n        //\u7528\u6bcf\u4e2a\u8282\u70b9\u66f4\u65b0\u5b83\u5bf9\u5e94\u6811\u4e2d\u6839\u8282\u70b9\u4fe1\u606f\n        memset(f, INF_BIT, sizeof(f));\n        memset(g, INF_BIT, sizeof(g));\n        for(LL i = 1;i <= n;i++){\n            LL fx = find(i);\n            if(fx != f1){\n                f[fx] = min(f[fx], getcost(i, s1, ind1));\n            }else f[fx] = 0;  //\u7279\u6b8a\u60c5\u51b5\n            if(fx != fn){\n                g[fx] = min(g[fx], getcost(i, sn, indn));\n            }else g[fx] = 0;\n        }\n        \n        ans = LLONG_MAX;\n        for(LL i = 1;i <= n;i++){\n            if(find(i) == i) ans = min(ans, f[i] + g[i]);\n        }\n        \n        //cout << \"time:\" << clock() - st <<endl;\n        \n        printf(\"%lld\\n\", ans);\n    }\n    return 0;\n}\n```",
        "postTime": 1645955772,
        "uid": 474551,
        "name": "jimmy2021",
        "ccfLevel": 0,
        "title": "P7991-\u5e76\u67e5\u96c6\u3001\u4e8c\u5206"
    },
    {
        "content": "\u663e\u7136\u5728\u4e00\u4e2a\u8fde\u901a\u5757\u91cc\u7684\u70b9\u5c31\u4e0d\u7528\u4e92\u76f8\u8fde\u63a5\u4e86\uff0c\u6240\u4ee5\u627e\u5230\u8fde\u63a5 $1$ \u548c $n$ \u7684\u65b9\u5f0f\u5b9e\u9645\u4e0a\u5c31\u662f\u627e\u5230\u8fde\u901a $1$ \u4e0e $n$ \u6240\u5728\u8fde\u901a\u5757\u7684\u65b9\u5f0f\u3002\n\n\u53ef\u4ee5\u5148\u626b\u4e00\u904d\u786e\u5b9a\u6240\u6709\u8fde\u901a\u5757\uff0c\u7279\u5224\u5982\u679c $1$ \u548c $n$ \u5728\u540c\u4e00\u4e2a\u76f4\u63a5\u8f93\u51fa $0$ \uff0c\u5426\u5219\u5206\u7c7b\u8ba8\u8bba\u5230\u5e95\u662f\u8fde\u4e00\u6761\u8fb9\u8fd8\u662f\u4e24\u6761\u8fb9\u3002\uff08\u6b64\u5904\u5b9a\u4e49\u8ddd\u79bb\u4e3a\u9898\u76ee\u4e2d\u8fb9\u6743\uff0c\u5373\u70b9\u7f16\u53f7\u5dee\u7684\u5e73\u65b9\uff1b\u70b9\u5230\u8fde\u901a\u5757\u7684\u8ddd\u79bb\u662f\u70b9\u5230\u8fde\u901a\u5757\u4e2d\u6240\u6709\u70b9\u8ddd\u79bb\u7684\u6700\u5c0f\u503c\uff09\n\n* \u5982\u679c\u8fde\u4e00\u6761\u8fb9\uff0c\u90a3\u5c31\u904d\u5386 $1$ \u7684\u8fde\u901a\u5757\u4e2d\u6240\u6709\u70b9\uff0c\u627e\u4e00\u4e0b\u79bb $n$ \u8fde\u901a\u5757\u8ddd\u79bb\u6700\u5c0f\u7684\u5c31\u662f\u7b54\u6848\u3002\n* \u5982\u679c\u8fde\u4e24\u6761\u8fb9\uff0c\u679a\u4e3e\u6240\u6709\u8fde\u901a\u5757\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8fde\u901a\u5757\u5bfb\u627e\u70b9 $x$ \u4f7f\u5f97\u5176\u4e0e $1$ \u6240\u5728\u8fde\u901a\u5757\u8ddd\u79bb\u6700\u77ed\uff0c\u7136\u540e\u5bfb\u627e\u70b9 $y$ \u4f7f\u5f97\u5176\u4e0e $n$ \u6240\u5728\u8fde\u901a\u5757\u8ddd\u79bb\u6700\u77ed\uff0c\u53ef\u8fde\u63a5 $1$ \u548c $x$\uff0c$y$ \u548c $n$\u3002\n* \u6700\u540e\u4e24\u79cd\u65b9\u6848\u53d6\u4e00\u4e2a $\\min$ \u5373\u53ef\u3002\n\n\u6ce8\u610f\u5982\u679c\u6bcf\u6b21\u5bfb\u627e\u8ddd\u79bb $1$ \u6216 $n$ \u8fde\u901a\u5757\u4e2d\u70b9\u7684\u6700\u5c0f\u8ddd\u79bb\u90fd\u4f7f\u7528 `lower_bound`/`upper_bound` \u4f1a\u5f88\u5bb9\u6613\u8d85\u65f6\uff0c\u6240\u4ee5\u53ef\u4ee5\u5148\u5bf9\u4e8e\u8fd9\u4e24\u4e2a\u8fde\u901a\u5757\u4e2d\u7684\u70b9\u6309\u70b9\u7f16\u53f7\u6392\u5e8f\u4e4b\u540e $O(n)$ \u9884\u5904\u7406\u6240\u6709\u70b9\u5230\u8fde\u901a\u5757\u4e2d\u70b9\u8ddd\u79bb\u7684\u6700\u5c0f\u503c\uff0c\u540e\u9762\u76f4\u63a5 $O(1)$ \u53d6\u7528\u5373\u53ef\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```c++\n#include <cstdio>\n#include <vector>\n#include <algorithm>\n#define N 100010\n#define ll long long\nusing std::vector;\nusing std::sort;\nusing std::lower_bound;\nusing std::upper_bound;\nint fa[N];\nvector<int> chunk[N];\ninline int sq(int x) {return x*x;}\nint find(int x) {return fa[x]==x?x:fa[x]=find(fa[x]);}\nint f1[N],f2[N];\nvoid once()\n{\n\tint n,m;\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n;i++) fa[i]=i;\n\twhile(m--)\n\t{\n\t\tint u,v;\n\t\tscanf(\"%d%d\",&u,&v);\n\t\tu=find(u),v=find(v);\n\t\tif(u!=v) fa[u]=v;\n\t}\n\tif(find(1)==find(n))\n\t{\n\t\tputs(\"0\");\n\t\treturn;\n\t}\n\tfor(int i=1;i<=n;i++) if(fa[i]==i) chunk[i]=vector<int>();\n\tfor(int i=1;i<=n;i++) chunk[find(i)].push_back(i);\n\tauto &c1=chunk[find(1)],&c2=chunk[find(n)];\n\tsort(c1.begin(),c1.end());\n\tsort(c2.begin(),c2.end());\n\tfor(int i=0;i<c1.size()-1;i++)\n\t{\n\t\tint j;\n\t\tfor(j=c1[i];2*j<c1[i]+c1[i+1];j++) f1[j]=j-c1[i];\n\t\tfor(;j<c1[i+1];j++) f1[j]=c1[i+1]-j;\n\t}\n\tfor(int i=c1[0]-1;i>=1;i--) f1[i]=c1[0]-i;\n\tfor(int i=c1[c1.size()-1];i<=n;i++) f1[i]=i-c1[c1.size()-1];\n\n\n\tfor(int i=0;i<c2.size()-1;i++)\n\t{\n\t\tint j;\n\t\tfor(j=c2[i];2*j<c2[i]+c2[i+1];j++) f2[j]=j-c2[i];\n\t\tfor(;j<c2[i+1];j++) f2[j]=c2[i+1]-j;\n\t}\n\tfor(int i=c2[0]-1;i>=1;i--) f2[i]=c2[0]-i;\n\tfor(int i=c2[c2.size()-1];i<=n;i++) f2[i]=i-c2[c2.size()-1];\n\n\tll ans=0x3f3f3f3f3f3f3f3f;\n\t// \u4e00\u6761\u8fb9\n\tfor(auto i:c1)\n\t{\n\t\tint o=f2[i];\n\t\tif(1ll*o*o<ans) ans=1ll*o*o;\n\t}\n\t// \u4e24\u6761\u8fb9\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(fa[i]==i&&i!=find(1)&&i!=find(n))\n\t\t{\n\t\t\tint mn1=0x3f3f3f3f,mnn=0x3f3f3f3f;\n\t\t\tfor(auto j:chunk[i])\n\t\t\t{\n\t\t\t\tif(f1[j]<mn1) mn1=f1[j];\n\t\t\t\tif(f2[j]<mnn) mnn=f2[j];\n\t\t\t}\n\t\t\tif(1ll*mn1*mn1+1ll*mnn*mnn<ans) ans=1ll*mn1*mn1+1ll*mnn*mnn;\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",ans);\n}\nint main()\n{\n\tint t;\n\tscanf(\"%d\",&t);\n\twhile(t--) once();\n}\n```\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a\u9884\u5904\u7406 $O(n\\log n)$\uff0c\u679a\u4e3e\u4e00\u6761\u8fb9\u7684\u65b9\u6848\u548c\u679a\u4e3e\u4e24\u6761\u8fb9\u7684\u65b9\u6848\u52a0\u8d77\u6765\u6700\u591a\u8bbf\u95ee $n-1$ \u4e2a\u70b9\u590d\u6742\u5ea6 $O(n)$\uff0c\u603b\u590d\u6742\u5ea6 $O(n \\log n)$ \u800c\u4e14\u7531\u4e8e $\\log$ \u662f\u4ece `sort` \u6765\u7684\u6240\u4ee5\u8dd1\u5f97\u98de\u5feb\u3002",
        "postTime": 1640704605,
        "uid": 298051,
        "name": "xkcdjerry",
        "ccfLevel": 7,
        "title": "P7991 \u9898\u89e3"
    },
    {
        "content": "\u597d\u9898\u4e00\u9053\u3002\n\n\u7531\u4e8e\u53ea\u80fd\u8fde\u63a5\u4e24\u6761\u8fb9\uff0c\u8003\u8651\u5206\u4ee5\u4e0b\u4e24\u79cd\u60c5\u51b5\u3002\n\n1. \u8fde\u63a5 $1$ \u53f7\u70b9\u6240\u5728\u8fde\u901a\u5757\u4e2d\u7684\u4e00\u4e2a\u70b9\u548c $n$ \u53f7\u70b9\u6240\u5728\u8fde\u901a\u5757\u4e2d\u7684\u4e00\u4e2a\u70b9\u3002\u770b\u4f3c\u53ea\u7528\u4e86\u4e00\u6761\u8fb9\uff0c\u4e0d\u591f\u4f18\u79c0\u3002\u5982\u679c\u6211\u4eec\u60f3\u8fde\u63a5 $x,y$ \u4e24\u4e2a\u70b9\uff08$x<y$\uff09\uff0c\u5e94\u8be5\u62c6\u6210 $x\\to mid$ \u548c $mid \\to y$ \u4e24\u6761\u8fb9\uff0c\u5176\u4e2d $mid$ \u6839\u636e\u5c0f\u5b66\u6570\u5b66\u53ef\u4ee5\u5f97\u77e5\u5e94\u8be5\u53d6\u4e2d\u95f4\u3002\n\n2. \u8fde\u63a5 $1$ \u53f7\u70b9\u6240\u5728\u8fde\u901a\u5757\u4e2d\u7684\u4e00\u4e2a\u70b9\u548c\u4e00\u4e2a\u8f6c\u6298\u70b9\uff0c\u518d\u8fde\u63a5\u8f6c\u6298\u70b9\u548c $n$ \u53f7\u70b9\u6240\u5728\u8fde\u901a\u5757\u4e2d\u7684\u4e00\u4e2a\u70b9\u3002\n\n\u989d\uff0c\u5982\u679c\u8981\u679a\u4e3e\u8fde\u63a5\u54ea\u4fe9\u70b9\u80af\u5b9a\u662f $O(n^2)$ \u4e0d\u53ef\u53d6\u7684\u3002\n\n\u8003\u8651\u6211\u4eec\u8981\u5728\u4e24\u4e2a\u8fde\u901a\u5757\u4e2d\u9009\u53d6\u4e24\u4e2a\u70b9\u8fde\u63a5\uff0c\u80af\u5b9a\u8981\u627e\u7f16\u53f7\u5dee\u6700\u5c0f\u7684\u3002\u8fd9\u91cc\u8003\u8651\u4f7f\u7528\u542f\u53d1\u5f0f\u5408\u5e76\u7684\u601d\u60f3\u3002\n\n```cpp\nll merge(ll X, ll Y){\n\t// \u5c06 vec[X] \u548c vec[Y] \u8fd9\u4fe9\u96c6\u5408\u6c42\u51fa\u7f16\u53f7\u5dee\u6700\u5c0f\n\t// \u4e8b\u5148 vec[X] \u548c vec[Y] \u5747\u5df2\u6392\u5e8f\n\tll ans=1e18;\n\tif(vec[X].size()>vec[Y].size()){\n\t\tll t=Y; Y=X; X=t;\n\t}// \u4ea4\u6362\uff0c\u4fdd\u8bc1 vec[X] \u66f4\u5c0f\uff0c\u8fd9\u6837\u5c31\u4ece X \u5408\u5e76\u5230 Y\n\tfor(ll i: vec[X]){\n\t\tauto it=lower_bound(vec[Y].begin(),vec[Y].end(),i);\n\t\tif(it!=vec[Y].end()){\n\t\t\tif(abs(i-(*it))<ans){\n\t\t\t\tans=abs(i-(*it));\n\t\t\t}\n\t\t}\n\t\tif(it!=vec[Y].begin()){\n\t\t\tit--;\n\t\t\tif(abs(i-(*it))<ans){\n\t\t\t\tans=abs(i-(*it));\n\t\t\t}\n\t\t} // \u53ea\u8003\u8651\u5728 vec[Y] \u4e2d\u503c\u548c\u5b83\u76f8\u90bb\u7684\n\t}\n    return ans;\n}\n```\n\n\u4e0a\u9762\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(u \\log v)$ \u7684\uff0c\u5176\u4e2d $u$ \u662f ``vec[X]`` \u7684\u5927\u5c0f\uff0c$v$ \u662f ``vec[Y]`` \u7684\u5927\u5c0f\u3002\n\n\u603b\u590d\u6742\u5ea6\u7684\u4e8b\u60c5\u5462\uff0c\u5f85\u4f1a\u518d\u8bf4\uff0c\u770b\u4ee3\u7801\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll T,n,m,u,v,head[200005],sorted[200005],tot;\nstruct Edge{\n    ll to,nxt;\n}edge[200005];\nvoid add(ll u,ll v){\n\tedge[++tot].to=v;\n\tedge[tot].nxt=head[u];\n\thead[u]=tot;\n}\nvector<ll>vec[200005];\nll merge(ll X, ll Y){\n    ll ans=1e18;\n    if(vec[X].size()>vec[Y].size()){\n    \tll t=Y; Y=X; X=t;\n\t}\n    for(ll i: vec[X]){\n        auto it=lower_bound(vec[Y].begin(),vec[Y].end(),i);\n        if(it!=vec[Y].end()){\n            if(abs(i-(*it))<ans){\n                ans=abs(i-(*it));\n            }\n        }\n        if(it!=vec[Y].begin()){\n        \tit--;\n        \tif(abs(i-(*it))<ans){\n                ans=abs(i-(*it));\n            }\n\t\t} \n    }\n    return ans;\n}// \u6c42\u4e24\u4e2a\u96c6\u5408\u5143\u7d20\u5dee\u6700\u5c0f\nll vis[1000005];\nvoid dfs(ll x){\n\tfor(ll i=head[x];i;i=edge[i].nxt){\n\t\tll tmp=edge[i].to;\n\t\tif(!vis[tmp]){\n\t\t\tvis[tmp]=vis[x];\n\t\t\tdfs(tmp);\n\t\t}\n\t}\n}\nint main(){\n\tios::sync_with_stdio(0);\n\tcin>>T;\n\twhile(T--){\n\t\tcin>>n>>m;\n\t\tmemset(head,0,sizeof head); tot=0;\n\t\tfor(ll i=1;i<=m;i++){\n\t\t\tcin>>u>>v;\n\t\t\tadd(u,v); add(v,u);\n\t\t}\n\t\tmemset(vis,0,sizeof vis);\n\t\tfor(ll i=1;i<=n;i++)\n\t\t\tif(!vis[i]) vis[i]=i,dfs(i);\n\t\tfor(ll i=1;i<=n;i++) vec[i].clear();\n\t\tfor(ll i=1;i<=n;i++) vec[vis[i]].push_back(i); // \u4ee5\u4e0a\u9884\u5904\u7406\u51fa\u8fde\u901a\u5757\u5b58\u5165 vec\uff0c\u590d\u6742\u5ea6\u53ef\u4ee5\u4e0d\u8ba1\n\t\tmemset(sorted,0,sizeof sorted);\n\t\tfor(ll i=1;i<=n;i++)\n\t\t\tif(!sorted[vis[i]]) sort(vec[vis[i]].begin(),vec[vis[i]].end()),sorted[vis[i]]=1; // \u6bcf\u4e2a\u8fde\u901a\u5757\u5143\u7d20\u6392\u5e8f\uff0c\u590d\u6742\u5ea6 O(n log n)\n\t\tll temp=merge(vis[1],vis[n]); // 1 \u548c n \u6240\u5728\u8fde\u901a\u5757\u627e\u5230\u6700\u5c0f\u5dee\n\t\tll answer=(temp/2)*(temp/2)+(temp-temp/2)*(temp-temp/2); // \u5206\u5f00\u8fde\u63a5\uff0c\u8fd9\u662f\u4e00\u79cd\u65b9\u6cd5\n\t\tmemset(sorted,0,sizeof sorted); \n\t\tfor(ll i=1;i<=n;i++)\n\t\t\tif(vis[i]!=vis[1] && vis[i]!=vis[n] && !sorted[vis[i]]){ // \u679a\u4e3e\u8f6c\u6298\u8fde\u901a\u5757\n\t\t\t\tsorted[vis[i]]=1;\n\t\t\t\tll temp1=merge(vis[1],vis[i]), temp2=merge(vis[n],vis[i]); // \u5206\u522b\u5408\u5e76\n\t\t\t\tif(temp1*temp1+temp2*temp2<answer)\n\t\t\t\t\tanswer=temp1*temp1+temp2*temp2; // \u66f4\u65b0\u7b54\u6848\n\t\t\t}\n\t\tcout<<answer<<endl;\n\t}\n\treturn 0;\n}\n```\n\n\u6211\u4eec\u6765\u5206\u6790\u5206\u6790\u590d\u6742\u5ea6\u5427\u3002\u6211\u4eec\u9996\u5148\u5408\u5e76 $1$ \u548c $n$ \u6240\u5728\u8fde\u901a\u5757\uff0c\u590d\u6742\u5ea6 $O(n \\log n)$\uff0c\u7136\u540e\u679a\u4e3e\u4e2d\u8f6c\u8fde\u901a\u5757\uff0c\u4e2d\u8f6c\u8fde\u901a\u5757\u5927\u5c0f\u4e4b\u548c\u53ef\u4ee5\u770b\u4f5c $n$\uff0c\u5408\u5e76\u4e24\u4e2a\u8fde\u901a\u5757\u65f6\u590d\u6742\u5ea6\u548c\u5c0f\u7684\u8fde\u901a\u5757\u5927\u5c0f\u6709\u5173\uff0c\u603b\u7684\u5408\u5e76\u590d\u6742\u5ea6\u4e0d\u4f1a\u8d85\u8fc7 $O(n \\log n)$\u3002\u603b\u7684\u8fd8\u662f $O(n \\log n)$ \u7684\u3002\n\n\n~~\u8fd9\u4e2a\u5e38\u6570\u5de8\u5927\uff0c\u505a\u6cd5\u5f88\u70e6\u7684\u9898\u89e3\u7ec8\u4e8e\u7ed3\u675f\u4e86 /kk~~",
        "postTime": 1640353432,
        "uid": 334727,
        "name": "BreakPlus",
        "ccfLevel": 0,
        "title": "Solution P7991"
    }
]
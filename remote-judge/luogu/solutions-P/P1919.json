[
    {
        "content": "\u8fd9\u4e2a\u9898\u662f\u4e0d\u662f\u4e00\u76f4\u5c11\u4e00\u7bc7\u6b63\u5e38\u7684\u9898\u89e3\u554a $\\rm QAQ$\n\n\u611f\u89c9\u4e3a\u4ec0\u4e48\u5176\u4ed6\u540c\u6837\u662f $FFT$ \u7684\u7801\u98ce\u8fd9\u4e48\u4e0d\u6b63\u7ecf\u554a $\\rm QAQ$\n\n$py$ \u597d\u7528\u4f46\u662f ~~\u5708\u94b1\u7ec4\u7ec7~~ CCF\u4e0d\u627f\u8ba4\u554a $\\rm QAQ$\n\n\u6240\u4ee5\u6211\u4eec\u8fd8\u662f\u8001\u8001\u5b9e\u5b9e\u5730 $FFT$ \u5427 = = \n\n## \u6b63\u786e\u6027\uff1a\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $n$ \u4f4d\u7684\u5341\u8fdb\u5236\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u505a\u4e00\u4e2a $n-1$ \u6b21\u591a\u9879\u5f0f $A$\uff0c\u6ee1\u8db3\n\n$$\nA(x) =a_0+a_1 \\times 10+a_2\\times10^2 \\cdots +a_{n-1}\\times10^{n-1}\n$$\n\n\u90a3\u4e48\u5bf9\u4e8e\u4e24\u4e2a\u5927\u6574\u6570\u76f8\u4e58,\u6211\u4eec\u5c31\u53ef\u4ee5\u5377\u8d77\u6765\u8fa3$qwq$\n\n## \u5c0f\u7ec6\u8282\uff1a\n- \u4e0d\u8981\u5fd8\u8bb0\u8fdb\u4f4d$qwq$\n\n- \u4e0d\u8981\u5fd8\u4e86\u8981\u4fdd\u8bc1\u6570\u4f4d\u4e0a\u7684\u5355\u8c03\u6027\uff0c\u56e0\u4e3a\u6211\u4eec\u666e\u901a\u7684$FFT$\u5377\u79ef\u65f6\uff0c\u9ad8\u6b21\u9879\u4e00\u5b9a\u7531\u4f4e\u6b21\u9879\u5f97\u5230\uff0c\u653e\u5728\u8fd9\u91cc\u4e5f\u4e00\u6837,\u6240\u4ee5\u6211\u4eec\u8981\u5012\u5e8f\u5b58\u50a8\u3002\n\n- \u4e0d\u4f1a$FFT$\u7684\uff0c\u6233\u8fd9\u91cc[Link](https://www.cnblogs.com/pks-t/p/9251147.html)\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <iostream>\n#define il inline\n#define MAXN 3000100\n\nusing namespace std ;\nchar s1[MAXN], s2[MAXN] ;\nint N, M, K, res = 0, ans[MAXN], AA, BB ;\nint i, j, k, l, Lim = 1, L, R[MAXN] ; \nconst double Pi = acos(-1.0) ;\nstruct node{\n    double x, y ;\n    node (double xx = 0, double yy = 0){\n        x = xx, y = yy ;\n    }\n}A[MAXN], B[MAXN] ;\nnode operator * (node J, node Q){\n    return node(J.x * Q.x - J.y * Q.y , J.x * Q.y + J.y * Q.x);\n}\nnode operator + (node J, node Q){\n    return node(J.x + Q.x , J.y + Q.y);\n}\nnode operator - (node J, node Q){\n    return node(J.x - Q.x , J.y - Q.y );\n}\n\nil int qr(){\n    int k = 0, f = 1 ;\n    char c = getchar() ;\n    while(!isdigit(c)){if(c == '-') f = -1 ;c = getchar() ;}\n    while(isdigit(c)) k = (k << 1) + (k << 3) + c - 48 ,c = getchar() ;\n    return k * f ;\n}\nil void FFT(node *J, double flag){\n    for(i = 0; i < Lim; i ++)\n        if(i < R[i]) swap(J[i], J[R[i]]) ;\n    for(j = 1; j < Lim; j <<= 1){\n        node T(cos(Pi / j), flag * sin(Pi / j)) ;\n        for(k = 0; k < Lim; k += (j << 1) ){\n            node t(1, 0) ;\n            for(l = 0 ; l < j; l ++, t = t * T){\n                node Nx = J[k + l], Ny = t * J[k + j + l] ;\n                J[k + l] = Nx + Ny ;\n                J[k + j + l] = Nx - Ny ;\n            }\n        }\n    }\n}\nint main(){\n    N = qr() ;\n    scanf(\"%s%s\", s1, s2) ;\n    for(i = N - 1; i >= 0; i --) A[AA ++].x = s1[i] - 48;\n    for(i = N - 1; i >= 0; i --) B[BB ++].x = s2[i] - 48;\n    while(Lim < N + N ) Lim <<= 1, L ++ ;\n    for(i = 0; i <= Lim; i ++ ) R[i] = (R[i >> 1] >> 1) | ((i & 1) << (L - 1)) ;\n    FFT(A, 1), FFT(B, 1) ;\n    for(i = 0; i <= Lim; i ++) A[i] = A[i] * B[i] ;\n    FFT(A, -1) ;\n    int tot = 0 ;\n\tfor(i = 0; i <= Lim; i++) {\n        ans[i] += (int) (A[i].x / Lim + 0.5) ;\n        if(ans[i] >= 10) \n            ans[i + 1] += ans[i] / 10, ans[i] %= 10, Lim += (i == Lim);\n    }\n    while(!ans[Lim] && Lim >= 1) Lim -- ;\n    Lim ++ ;\n\twhile( -- Lim >= 0) cout << ans[Lim] ; \n    return 0 ;\n}\n```",
        "postTime": 1530694304,
        "uid": 28313,
        "name": "\u768e\u6708\u534a\u6d12\u82b1",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1919 \u3010\u6a21\u677f\u3011A*B Problem\u5347\u7ea7\u7248\uff08FFT\u5feb\u901f\u5085\u91cc\u53f6\uff09"
    },
    {
        "content": "[\u535a\u5ba2\u98df\u7528\u66f4\u4f73\u54e6QAQ](https://blog.csdn.net/Flag_z/article/details/99163939)\n# \u524d\u8a00\n\u6628\u5929\u5b66\u4e86\u4e00\u665a\u4e0a\uff0c\u7ec8\u4e8e\u641e\u61c2\u4e86FFT\u3002\u5e0c\u671b\u80fd\u5199\u4e00\u7bc7\u6e05\u695a\u6613\u61c2\u7684\u9898\u89e3\u5206\u4eab\u7ed9\u5927\u5bb6\uff0c\u4e5f\u8fdb\u4e00\u6b65\u52a0\u6df1\u81ea\u5df1\u7684\u7406\u89e3\u3002\nFFT\u7b97\u662f\u6570\u8bba\u4e2d\u6bd4\u8f83\u91cd\u8981\u7684\u4e1c\u897f\uff0c\u542c\u8d77\u6765\u5c31\u5f88\u9ad8\u6df1\u7684\u4e9a\u5b50\u3002\u4f46\u5176\u5b9e\u5b66\u4f1a\u4e86\uff08\u54ea\u6015\u5e76\u4e0d\u80fd\u5b8c\u5168\u7406\u89e3)\uff0c\u4f1a\u5b9e\u73b0\u4ee3\u7801\uff0c\u5e76\u77e5\u9053\u600e\u4e48\u7075\u6d3b\u8fd0\u7528 ~~\uff08\u80cc\u677f\u5b50\uff09~~ \u5c31\u884c\u3002\u63a5\u4e0b\u6765\u8fdb\u5165\u6b63\u9898\u3002\n\n# \u5b9a\u4e49\n**FFT\uff08Fast Fourier Transformation\uff09**\uff0c\u4e2d\u6587\u540d**\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362**\uff0c\u662f\u79bb\u6563\u5085\u6c0f\u53d8\u6362\u7684\u5feb\u901f\u7b97\u6cd5\uff0c\u5b83\u662f\u6839\u636e\u79bb\u6563\u5085\u6c0f\u53d8\u6362\u7684\u5947\u3001\u5076\u3001\u865a\u3001\u5b9e\u7b49\u7279\u6027\uff0c\u5bf9\u79bb\u6563\u5085\u7acb\u53f6\u53d8\u6362\u7684\u7b97\u6cd5\u8fdb\u884c\u6539\u8fdb\u83b7\u5f97\u7684\u3002\n\n\u800c\u5728\u4fe1\u5965\u4e2d\uff0c\u4e00\u822c\u7528\u6765**\u52a0\u901f\u591a\u9879\u5f0f\u4e58\u6cd5**\u3002\n\u6734\u7d20\u9ad8\u7cbe\u5ea6\u4e58\u6cd5\u7684\u65f6\u95f4\u4e3a$O(n^2)$\uff0c\u4f46FFT\u80fd\u5c06\u65f6\u95f4\u590d\u6742\u5ea6\u964d\u5230 $O(nlog_2n)$\n\n\u5b66\u4e60FFT\u4e4b\u524d\uff0c\u9700\u8981\u4e86\u89e3\u4e00\u4e9b\u6709\u5173**\u590d\u6570**\u548c**\u591a\u9879\u5f0f**\u7684\u77e5\u8bc6\u3002\n# \u6709\u5173\u77e5\u8bc6\n## \u591a\u9879\u5f0f\u7684\u4e24\u79cd\u8868\u793a\u65b9\u6cd5\n### \u7cfb\u6570\u8868\u793a\u6cd5\n$F[x]=y=a_0x^0+a_1x^1+a_2x^2+......a_nx^n$        \n\n{$a_0,a_1,a_2,...,a_n$} \u662f\u8fd9\u4e2a\u591a\u9879\u5f0f\u6bcf\u4e00\u9879\u7684\u7cfb\u6570\uff0c\u6240\u4ee5\u8fd9\u662f*\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u8868\u793a\u6cd5*\n### \u70b9\u503c\u8868\u793a\u6cd5\n\u5728\u51fd\u6570\u56fe\u50cf\u4e2d\uff0c$F[x]$\u8fd9\u4e2a\u591a\u9879\u5f0f\u53ef\u4ee5\u88abn\u4e2a\u70b9\u552f\u4e00\u786e\u5b9a\uff0c\u5373\u4ee3\u5165n\u4e2a\u70b9\u4f5c\u4e3a$x$,\u5206\u522b\u89e3\u51fa\u5bf9\u5e94\u7684 $y$\uff0c\u5f97\u5230n\u4e2a\u5f0f\u5b50\u3002\n\u628a\u8fd9n\u6761\u5f0f\u5b50\u8054\u7acb\u8d77\u6765\u6210\u4e3a\u4e00\u4e2a\u6709n\u6761\u65b9\u7a0b\u7684n\u5143\u65b9\u7a0b\u7ec4\uff0c\u6bcf\u4e00\u9879\u7684\u7cfb\u6570\u90fd\u53ef\u4ee5\u89e3\u51fa\u6765.\uff08\u53ef\u7c7b\u6bd4\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\uff09\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u4f7f\u7528{$(x_0,f[x_0])$,$(x_1,f[x_1])$,...,$(x_n,f[x_n])$}\u5c31\u53ef\u4ee5\u5b8c\u6574\u63cf\u8ff0\u51fa\u8fd9\u4e2a\u591a\u9879\u5f0f,\u8fd9\u5c31\u662f *\u591a\u9879\u5f0f\u7684\u70b9\u503c\u8868\u793a\u6cd5*\n## \u591a\u9879\u5f0f\u76f8\u4e58\n\u8bbe\u4e24\u4e2a\u591a\u9879\u5f0f\u5206\u522b\u4e3a$f(x)$,$g(x)$,\u6211\u4eec\u8981\u628a\u8fd9\u4e24\u4e2a\u591a\u9879\u5f0f\u76f8\u4e58 (\u5373\u6c42\u5377\u79ef)\u3002\n\n\u5982\u679c\u7528**\u7cfb\u6570\u8868\u793a\u6cd5**:\n\u6211\u4eec\u8981\u679a\u4e3e$f$\u7684\u6bcf\u4e00\u4f4d\u7684\u7cfb\u6570\u4e0e$g$\u7684\u6bcf\u4e00\u4f4d\u7684\u7cfb\u6570\u76f8\u4e58\uff0c\u591a\u9879\u5f0f\u4e58\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6$O(n^2)$\uff0c\u8fd9\u4e5f\u662f\u6211\u4eec\u6240\u719f\u77e5\u7684\u9ad8\u7cbe\u5ea6\u4e58\u6cd5\u7684\u539f\u7406\u3002\n\n\u5982\u679c\u7528**\u70b9\u503c\u8868\u793a\u6cd5**:\n\n$f[x]$={$(x_0,f[x_0])$,$(x_1,f[x_1])$,...,$(x_n,f[x_n])$}\n\n$g[x]$={$(x_0,g[x_0])$,$(x_1,g[x_1])$,...,$(x_n,g[x_n])$}\n\n$f[x]*g[x]$={$(x_0,f[x_0]*g[x_0])$,$(x_1,f[x_1]*g[x_1])$,...,$(x_n,f[x_n]*g[x_n])$}\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u4e24\u4e2a\u591a\u9879\u5f0f\u53d6\u76f8\u540c\u7684$x$\uff0c\u5f97\u5230\u4e0d\u540c\u7684$y$\u503c\uff0c\u90a3\u4e48\u53ea\u9700\u8981$y$\u503c\u5bf9\u5e94\u76f8\u4e58\u5c31\u53ef\u4ee5\u4e86\uff01\n\n\u590d\u6742\u5ea6\u53ea\u6709\u679a\u4e3e$x$\u7684$O(n)$ \n\n\u90a3\u4e48\u95ee\u9898\u8f6c\u6362\u4e3a\u5c06\u591a\u9879\u5f0f\u7cfb\u6570\u8868\u793a\u6cd5\u8f6c\u5316\u6210\u70b9\u503c\u8868\u793a\u6cd5\u3002\n\n\u6734\u7d20**\u7cfb\u6570\u8f6c\u70b9\u503c**\u7684\u7b97\u6cd5\u53eb**DFT\uff08\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362\uff09**,\u4f18\u5316\u540e\u4e3a**FFT\uff08\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\uff09**\uff0c**\u70b9\u503c\u8f6c\u7cfb\u6570**\u7684\u7b97\u6cd5\u53eb**IDFT\uff08\u79bb\u6563\u5085\u91cc\u53f6\u9006\u53d8\u6362\uff09**\uff0c\u4f18\u5316\u540e\u4e3a**IFFT(\u5feb\u901f\u5085\u91cc\u53f6\u9006\u53d8\u6362**)\u3002\u4e4b\u540e\u6211\u4f1a\u5206\u522b\u4ecb\u7ecd\u3002\n## \u5377\u79ef\n~~\u5176\u5b9e\u4e0d\u7406\u89e3\u5377\u79ef\u4e5f\u6ca1\u5173\u7cfb\uff0c\u4f46\u8fd9\u91cc\u987a\u4fbf\u63d0\u4e00\u4e0b\uff0c\u53ef\u4ee5\u8df3\u8fc7\u7684~~ \n \u5377\u79ef\u4e0e\u5085\u91cc\u53f6\u53d8\u6362\u6709\u7740\u5bc6\u5207\u7684\u5173\u7cfb\u3002\u5229\u7528\u4e00\u70b9\u6027\u8d28\uff0c\u5373\u4e24\u51fd\u6570\u7684\u5085\u91cc\u53f6\u53d8\u6362\u7684\u4e58\u79ef\u7b49\u4e8e\u5b83\u4eec\u5377\u79ef\u540e\u7684\u5085\u91cc\u53f6\u53d8\u6362\uff0c\u80fd\u4f7f\u5085\u91cc\u53f6\u5206\u6790\u4e2d\u8bb8\u591a\u95ee\u9898\u7684\u5904\u7406\u5f97\u5230\u7b80\u5316\u3002\n \n $F(g(x)*f(x)) = F(g(x))F(f(x))$\n\n\u5176\u4e2dF\u8868\u793a\u7684\u662f**\u5085\u91cc\u53f6\u53d8\u6362**          \n## \u590d\u6570\n\u9ad8\u4e2d\u6570\u5b66\u4f1a\u8be6\u7ec6\u8bb2\u89e3\uff0c\u77e5\u9053\u7684\u53ef\u4ee5\u8df3\u8fc7\u8fd9\u4e00\u90e8\u5206\uff0c\u6ca1\u5b66\u8fc7\u4e5f\u6ca1\u5173\u7cfb\uff0c\u770b\u4ee5\u4e0b\u5185\u5bb9\u5e94\u8be5\u80fd\u5f88\u6e05\u695a\u7684\u7406\u89e3\u3002\n### 1.\u5b9a\u4e49\n\u6570\u96c6\u62d3\u5c55\u5230\u5b9e\u6570\u8303\u56f4\u5185\uff0c\u4ecd\u6709\u4e9b\u8fd0\u7b97\u65e0\u6cd5\u8fdb\u884c\u3002\u6bd4\u5982\u5224\u522b\u5f0f\u5c0f\u4e8e0\u7684\u4e00\u5143\u4e8c\u6b21\u65b9\u7a0b\u4ecd\u65e0\u89e3\uff0c\u56e0\u6b64\u5c06\u6570\u96c6\u518d\u6b21\u6269\u5145\uff0c\u8fbe\u5230\u590d\u6570\u8303\u56f4\u3002\n\n**\u590d\u6570**$z$\u88ab\u5b9a\u4e49\u4e3a\u4e8c\u5143\u6709\u5e8f\u5b9e\u6570\u5bf9$(a,b)$,\u8bb0\u4e3a$z=a+bi$,\u8fd9\u91cc$a$\u548c$b$\u662f\u5b9e\u6570\uff0c\u89c4\u5b9a$i$\u662f\u865a\u6570\u5355\u4f4d\u3002 \n($i^2=-1$  \u5373$i=\\sqrt{-1}$)\n\n\u5bf9\u4e8e\u590d\u6570$z=a+bi$\u3002\u5b9e\u6570$a$\u79f0\u4e3a\u590d\u6570z\u7684**\u5b9e\u90e8(real part)**,\u8bb0\u4f5c$rez=a$.\u5b9e\u6570$b$\u79f0\u4e3a\u590d\u6570z\u7684**\u865a\u90e8(imaginary part**)\u8bb0\u4f5c Imz=b.\n\n\u5f53\u865a\u90e8\u7b49\u4e8e\u96f6\u65f6\uff0c\u8fd9\u4e2a\u590d\u6570\u53ef\u4ee5\u89c6\u4e3a**\u5b9e\u6570**\u3002\n\u5373\u5f53$b=0$\u65f6\uff0c$z=a$,\u8fd9\u65f6\u590d\u6570\u6210\u4e3a\u5b9e\u6570\uff1b\u5f53\u4e14\u4ec5\u5f53$a=b=0$\u65f6\uff0c\u5b83\u662f\u5b9e\u65700\uff1b\n\n\u5f53z\u7684\u865a\u90e8\u4e0d\u7b49\u4e8e\u96f6\u65f6\uff0c\u5b9e\u90e8\u7b49\u4e8e\u96f6\u65f6\uff0c\u5e38\u79f0z\u4e3a**\u7eaf\u865a\u6570**\u3002\n\u5373\u5f53$a=0$\u4e14$b\u22600$\u65f6\uff0c$z=bi$\uff0c\u6211\u4eec\u5c31\u5c06\u5176\u79f0\u4e3a\u7eaf\u865a\u6570\u3002\n\n\u5c06\u590d\u6570\u7684\u5b9e\u90e8\u4e0e\u865a\u90e8\u7684\u5e73\u65b9\u548c\u7684\u6b63\u7684\u5e73\u65b9\u6839\u7684\u503c\u79f0\u4e3a\u8be5**\u590d\u6570\u7684\u6a21**\uff0c\u8bb0\u4f5c$\u2223z\u2223$\u3002\n\n\u5373\u5bf9\u4e8e**\u590d\u6570z=a+bi**\uff0c\u5b83\u7684\u6a21\u4e3a$\u2223z\u2223=\\sqrt{(a^2+b^2)}$\n### 2.\u590d\u6570\u7684\u51e0\u4f55\u610f\u4e49\n\u76f4\u63a5\u4e24\u5f20\u56fe\u641e\u5b9a\u221a ~~(\u5e94\u8be5\u53ef\u4ee5\u4e00\u76ee\u4e86\u7136)~~ \n![\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0](https://img-blog.csdnimg.cn/20190811100118403.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0ZsYWdfeg==,size_16,color_FFFFFF,t_70)\n![\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0](https://img-blog.csdnimg.cn/2019081109564340.PNG?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0ZsYWdfeg==,size_16,color_FFFFFF,t_70)\n\n### 3.\u8fd0\u7b97\u6cd5\u5219\n**\u52a0\u6cd5\u6cd5\u5219**:$(a+bi)+(c+di)=(a+c)+(b+d)i;$\n**\u51cf\u6cd5\u6cd5\u5219**:$(a+bi)-(c+di)=(a-c)+(b-d)i;$\n  \u6ce8\uff1a\u590d\u6570\u52a0\u51cf\u6ee1\u8db3**\u5e73\u884c\u56db\u8fb9\u5f62\u6cd5\u5219**\uff1a\n\n![\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0](https://img-blog.csdnimg.cn/20190811100516641.png)\n\n**\u4e58\u6cd5\u6cd5\u5219**:$(a+bi)\u00b7(c+di)=(ac-bd)+(bc+ad)i$\n\n\u590d\u6570\u76f8\u4e58\u4e00\u4e2a\u91cd\u8981\u6cd5\u5219\uff1a**\u6a21\u957f\u76f8\u4e58\uff0c\u5e45\u89d2\u76f8\u52a0**\u3002\uff08\u8fd9\u4e2a\u5b9a\u7406\u5f88\u91cd\u8981\uff09\n\n**\u6a21\u957f**\uff1a\u8fd9\u4e2a\u5411\u91cf\u7684\u6a21\u957f\uff0c\u5373\u8fd9\u4e2a\u70b9\u5230\u539f\u70b9\u7684\u8ddd\u79bb\u3002\uff08\u4e0d\u61c2\u7684\u53ef\u518d\u770b\u4e0b\u5411\u91cf\u7684\u51e0\u4f55\u610f\u4e49\uff09\u3002\n\n**\u5e45\u89d2**:  \u4ece\u539f\u70b9\u51fa\u53d1\u3001\u6307\u5411x\u8f74\u6b63\u534a\u8f74\u7684\u5c04\u7ebf\u7ed5\u539f\u70b9\u9006\u65f6\u9488\u65cb\u8f6c\u81f3\u8fc7\u8fd9\u4e2a\u70b9\u6240\u7ecf\u8fc7\u7684\u89d2\u3002\n\n\u5728\u6781\u5750\u6807\uff08\u53ef\u770b\u6210\u5e73\u9762\u76f4\u89d2\u5750\u6807\u7cfb\uff09\u4e0b\uff0c\u590d\u6570\u53ef\u7528\u6a21\u957fr\u4e0e\u5e45\u89d2\u03b8\u8868\u793a\u4e3a$(r,\u03b8)$\u3002\n\u5bf9\u4e8e\u590d\u6570$a+bi$,  $r=\\sqrt{a^2+b^2}$\uff0c$\u03b8=arctan(b/a)$\u3002\u6b64\u65f6\uff0c\u590d\u6570\u76f8\u4e58\u8868\u73b0\u4e3a\u6a21\u957f\u76f8\u4e58\uff0c\u5e45\u89d2\u76f8\u52a0\u3002\n\n**\u9664\u6cd5\u6cd5\u5219**\uff1a$(a+bi)\u00f7(c+di)=[(ac+bd)/(c\u00b2+d\u00b2)]+[(bc-ad)/(c\u00b2+d\u00b2)]i$\n### 4. \u5171\u8f6d\u590d\u6570\n\u4e00\u4e2a\u590d\u6570$z=a+bi$\u7684**\u5171\u8f6d\u590d\u6570**\u4e3a$a\u2212bi$\uff08\u5b9e\u90e8\u4e0d\u53d8\uff0c\u865a\u90e8\u53d6\u53cd\uff09\uff0c\u8bb0\u4e3a $\\overline{z}=a-bi$ \n\u3002\u5f53\u590d\u6570**\u6a21\u4e3a1**\u65f6\uff08\u5373|z|=1\uff09\uff0c\u4e0e\u5171\u8f6d\u590d\u6570\u4e92\u4e3a**\u5012\u6570**\n\n\u8bc1\u660e\uff1a$z*\\overline{z}=a^2-b^2*i^2=a^2+b^2=|z|^2=1$\n# FFT\u52a0\u901f\u591a\u9879\u5f0f\u4e58\u6cd5\n\u7531\u4e8e\u591a\u9879\u5f0f\u4e58\u6cd5\u7528\u70b9\u503c\u8868\u793a\u6bd4\u7528\u7cfb\u6570\u8868\u793a\u5feb\u7684\u591a\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u8981\u5c06**\u7cfb\u6570\u8868\u793a\u6cd5**\u8f6c\u5316\u6210**\u70b9\u503c\u8868\u793a\u6cd5**\u76f8\u4e58\uff0c\u518d\u5c06\u7ed3\u679c\u7684**\u70b9\u503c\u8868\u793a\u6cd5**\u8f6c\u5316\u4e3a**\u7cfb\u6570\u8868\u793a\u6cd5**\u7684\u8fc7\u7a0b\u3002\n\n\u7b2c\u4e00\u4e2a\u8fc7\u7a0b\u53eb\u505a**FFT\uff08\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362)**\uff0c\u7b2c\u4e8c\u4e2a\u8fc7\u7a0b\u53eb**IFFT\uff08\u5feb\u901f\u5085\u91cc\u53f6\u9006\u53d8\u6362\uff09**\n\u5728\u8bb2\u8fd9\u4e24\u4e2a\u8fc7\u7a0b\u4e4b\u524d\uff0c\u9996\u5148\u4e86\u89e3\u4e00\u4e2a\u6982\u5ff5\uff1a\n## \u5355\u4f4d\u6839\n\u590d\u6570$\\omega$\u6ee1\u8db3$\\omega^n=1$\uff0c\u79f0$\\omega$\u662f**n\u6b21\u5355\u4f4d\u6839**\n### \u600e\u4e48\u627e\u5355\u4f4d\u6839\uff1f\n**\u5355\u4f4d\u5706**:\u5706\u5fc3\u4e3a\u539f\u70b9\u30011\u4e3a\u534a\u5f84\u7684\u5706\n\u628a**\u5355\u4f4d\u5706n\u7b49\u5206**\uff0c\u53d6\u8fd9n\u4e2a\u70b9\uff08\u6216\u70b9\u8868\u793a\u7684\u5411\u91cf\uff09\u6240\u8868\u793a\u7684**\u590d\u6570**\uff08\u5373\u5206\u522b\u4ee5\u8fd9n\u4e2a\u70b9\u7684\u6a2a\u5750\u6807\u4e3a\u5b9e\u90e8\u3001\u7eb5\u5750\u6807\u4e3a\u865a\u90e8\uff0c\u6240\u6784\u6210\u7684\u865a\u6570\uff09\uff0c\u5373\u4e3a**n\u6b21\u5355\u4f4d\u6839**\u3002\n\n\u4e0b\u56fe\u5305\u542b\u4e86\u5f53n=8\u65f6\uff0c\u6240\u6709\u76848\u6b21\u5355\u4f4d\u6839\uff0c\u5206\u522b\u8bb0\u4e3a$\\omega_8^1,\\omega_8^2.....,\\omega_8^8$\n(\u56fe\u4e2d\u5706\u7684\u534a\u5f84\u662f1\uff0cw\u8868\u793a$\\omega$,\u4e14\u4e0b\u68078\u5df2\u7701\u7565\uff09 \n\n~~\u56fe\u662f\u6211\u81ea\u5df1\u753b\u7684\uff0c\u53ef\u80fd\u6709\u70b9\u4e11QWQ~~ \n![\u5355\u4f4d\u6839\u56fe\u50cfbyTrilarflagz](https://img-blog.csdnimg.cn/20190811112251133.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0ZsYWdfeg==,size_16,color_FFFFFF,t_70)\n\u7531\u6b64\u6211\u4eec\u77e5\u9053\u5982\u4f55\u627e\u5355\u4f4d\u6839\u5566\n\u4ece\u70b9(1,0)\u5f00\u59cb\uff08\u5373$\\omega_n^1$\uff09,\u9006\u65f6\u9488\u5c06\u8fd9n\u4e2a\u70b9\u4ece0\u5f00\u59cb\u7f16\u53f7\uff0c\u7b2ck\u4e2a\u70b9\u5bf9\u5e94\u7684\u865a\u6570\u8bb0\u4f5c$\\omega_n^k$\n\n\u7531\u590d\u6570\u76f8\u4e58\u6cd5\u5219\uff1a**\u6a21\u957f\u76f8\u4e58\u5e45\u89d2\u76f8\u52a0**\u200b\t\n\u53ef\u5f97\uff1a\n\n$$(\\omega_n^1)^k=\\omega_n^k$$ \n\n\u6839\u636e\u6bcf\u4e2a\u590d\u6570\u7684\u5e45\u89d2\uff0c\u53ef\u4ee5\u8ba1\u7b97\u51fa\u6240\u5bf9\u5e94\u7684\u70b9/\u5411\u91cf\u3002\n$\\omega_n^k$\u5bf9\u5e94\u7684\u70b9/\u5411\u91cf\u662f\n\n(cos\u2061$\\frac{k}{n}2\u03c0$,sins\u2061$\\frac{k}{n}2\u03c0$)\uff0c\u5373\u4e3a\u590d\u6570 cos\u2061\u2061$\\frac{k}{n}2\u03c0$+i sin\u2061$\\frac{k}{n}2\u03c0$\n\n ### \u5355\u4f4d\u6839\u7684\u6027\u8d28\n \u5efa\u8bae\u8bb0\u4f4f\uff0c\u56e0\u4e3a\u5bf9\u4e4b\u540e\u7684\u5206\u6790\u5f88\u91cd\u8981\uff01\uff01\n\n#### 1.$\\omega_n^k=\\omega_{2n}^{2k}$\n####  2.$\\omega_n^k=-\\omega_{n}^{k+\\frac n 2}$\n#### 3.$\\omega_n^0=\\omega_{n}^n=1$\n\u81f3\u4e8e\u600e\u4e48\u8bc1\u660e\uff0c\u5c31\u662f\u590d\u6570\u76f8\u4e58\u65f6\u6a21\u957f\u76f8\u4e58\u5e45\u89d2\u76f8\u52a0\u7684\u539f\u5219\u3002\u6216\u8005\u4f60\u76f4\u63a5\u89c2\u5bdf\u56fe\u4e5f\u53ef\u4ee5\u5f88\u663e\u7136\u7684\u5f97\u51fa\u7ed3\u8bba\u3002\u200b\n# DFT\uff08\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362\uff09\n\u5bf9\u4e8e\u4efb\u610f\u591a\u9879\u5f0f\u7cfb\u6570\u8868\u793a\u8f6c\u70b9\u503c\u8868\u793a\uff0c\u4f8b\u5982$F[x]=y=a_0x^0+a_1x^1+a_2x^2+......+a_nx^n$   \uff0c\u53ef\u4ee5\u968f\u4fbf\u53d6\u4efb\u610fn\u4e2a$x$\u503c\u4ee3\u5165\u8ba1\u7b97,\u4f46\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u662f$O(n^2)$\n\n\u6240\u4ee5\u4f1f\u5927\u6570\u5b66\u5bb6[\u5085\u91cc\u53f6](https://baike.so.com/doc/5915463-6128375.html)\u53d6\u4e86\u4e00\u4e9b\u7279\u6b8a\u7684\u70b9\u4ee3\u5165\uff0c\u4ece\u800c\u8fdb\u884c\u4f18\u5316\u3002\n\n\u4ed6\u89c4\u5b9a\u4e86\u70b9\u503c\u8868\u793a\u4e2d\u7684$n$\u4e2a$x$\u4e3a$n$\u4e2a\u6a21\u957f\u4e3a1\u7684\u590d\u6570\u3002\u8fd9$n$\u4e2a\u590d\u6570\u4e0d\u662f\u968f\u673a\u7684\uff0c\u800c\u662f**\u5355\u4f4d\u6839**\u3002\n\n\u628a\u4e0a\u8ff0\u7684n\u4e2a\u590d\u6570\uff08\u5355\u4f4d\u6839\uff09$\\omega_n^0,\\omega_n^1.....,\\omega_n^{n-1}$\u4ee3\u5165\u591a\u9879\u5f0f\uff0c\u80fd\u5f97\u5230\u4e00\u79cd\u7279\u6b8a\u7684\u70b9\u503c\u8868\u793a\uff0c\u8fd9\u79cd\u70b9\u503c\u8868\u793a\u5c31\u53eb**DFT\uff08\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362\uff09**\u3002\n# FFT\uff08\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\uff09\n\u867d\u7136**DFT**\u80fd\u628a\u591a\u9879\u5f0f\u8f6c\u6362\u6210\u70b9\u503c\u4f46\u5b83\u4ecd\u7136\u662f\u66b4\u529b\u4ee3\u5165$n$\u4e2a\u6570\uff0c\u590d\u6742\u5ea6\u4ecd\u7136\u662fO(n2)\uff0c\u6240\u4ee5\u5b83\u53ea\u662f\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\u7684\u6734\u7d20\u7248\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8981\u8003\u8651\u5229\u7528**\u5355\u4f4d\u6839\u7684\u6027\u8d28**\uff0c\u52a0\u901f\u6211\u4eec\u7684\u8fd0\u7b97\uff0c\u5f97\u5230**FFT\uff08\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\uff09**\n\n\u5bf9\u4e8e\u591a\u9879\u5f0f $A(x)$=$a_0$+$a_1x$+$a_2x^2$+...+$a_{n-1}x^{n-1}$\uff0c\n\u5c06A(x)\u7684\u6bcf\u4e00\u9879\u6309\u7167\u4e0b\u6807\u7684\u5947\u5076\u5206\u6210\u4e24\u90e8\u5206\uff1a\n\n$A(x)=a_0x^0+a_2x^2+...+a_{n-2}x^{n-2}+x(a_1x^0+a_3x^2+...+a_{n-1}x^{n-2})$\n\n\u8bbe\u4e24\u4e2a\u591a\u9879\u5f0f $A_0(x)$\u548c$A_1(x)$\uff0c\u4ee4\uff1a\n$A_0(x)=a_0x^0+a_2x^1+...+a_{n-2}x^{n/2-1}$\n$A_1(x)=a_1x^0+a_3x^1+...+a_{n-1}x^{n/2-1}$\n\n\u663e\u7136\uff0c$A(x)=A_0(x^2)+x*A_1(x^2)$\n\n\u5047\u8bbe$k<n$\uff0c\u4ee3\u5165$x=\u03c9_n^k$\uff08n\u6b21\u5355\u4f4d\u6839\uff09\uff1a\n $A(\\omega_n^k)$$=A_0(\\omega_n^{2k})+\\omega_n^{k}*A_1(\\omega_n^{2k})$$=A_0(\\omega_\\frac n2^{k})+\\omega_n^{k}*A_1(\\omega_\\frac n 2^{k})$\n\n$A(\\omega_n^{k+\\frac n 2})=A_0(\\omega_n^{2k+n})+\\omega_n^{k+\\frac n 2}*A_1(\\omega_n^{2k+n})$$=A_0(\\omega_\\frac n2^{k})-\\omega_n^{k}*A_1(\\omega_\\frac n 2^{k})$\n\n\u8003\u8651A1(x)\u548cA2(x)\u5206\u522b\u5728$(\\omega_\\frac n 2^{1},\\omega_\\frac n 2^{2},\\omega_\\frac n 2^{3},...,\\omega_\\frac n 2^{\\frac n 2-1})$\u7684\u70b9\u503c\u8868\u793a\u5df2\u7ecf\u6c42\u51fa\uff0c\u5c31\u53ef\u4ee5O(n)\u6c42\u51faA(x)\u5728$(\\omega_n ^{1},\\omega_n ^{2},\\omega_n ^{3},...,\\omega_n ^{n-1})$\u5904\u7684\u70b9\u503c\u8868\u793a\u3002\n\n\u8fd9\u4e2a\u64cd\u4f5c\u53eb**\u8774\u8776\u53d8\u6362**\u3002\n\n\u800cA1(x)\u548cA2(x)\u662f\u89c4\u6a21\u7f29\u5c0f\u4e86\u4e00\u534a\u7684\u5b50\u95ee\u9898\uff0c\u6240\u4ee5\u4e0d\u65ad\u5411\u4e0b\u9012\u5f52\u5206\u6cbb\u3002\u5f53n=1\u7684\u65f6\u5019\u8fd4\u56de\u3002\n\n**\u6ce8**\uff1a\u8fd9\u4e2a\u8fc7\u7a0b\u4e00\u5b9a\u8981\u6c42\u6bcf\u5c42\u90fd\u53ef\u4ee5\u5206\u6210\u4e24\u5927\u5c0f\u76f8\u7b49\u7684\u90e8\u5206\uff0c\u6240\u4ee5\u591a\u9879\u5f0f\u6700\u9ad8\u6b21\u9879\u4e00\u5b9a\u662f2\u7684\u5e42\uff0c\u4e0d\u662f\u7684\u8bdd\u76f4\u63a5\u5728\u6700\u9ad8\u6b21\u9879\u8865\u96f6QAQ\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(nlog_2n)$\n# IFFT\uff08\u5feb\u901f\u5085\u91cc\u53f6\u9006\u53d8\u6362\uff09\n\u6211\u4eec\u5df2\u7ecf\u5c06\u4e24\u4e2a\u591a\u9879\u5f0f\u4ece\u7cfb\u6570\u8868\u793a\u6cd5\u8f6c\u5316\u6210\u70b9\u503c\u8868\u793a\u6cd5\u76f8\u4e58\u540e\uff0c\u8fd8\u8981\u5c06\u7ed3\u679c\u4ece\u70b9\u503c\u8868\u793a\u6cd5\u8f6c\u5316\u4e3a\u7cfb\u6570\u8868\u793a\u6cd5\uff0c\u4e5f\u5c31\u662f**IFFT\uff08\u5feb\u901f\u5085\u91cc\u53f6\u9006\u53d8\u6362\uff09** \n\n\u9996\u5148\u601d\u8003\u4e00\u4e2a\u95ee\u9898\uff0c\u4e3a\u4ec0\u4e48\u8981\u628a$\\omega_n^k$\uff08\u5355\u4f4d\u6839\uff09\u4f5c\u4e3ax\u4ee3\u5165\uff1f\n\n\u5f53\u7136\u662f\u56e0\u4e3a\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362\u7279\u6b8a\u7684\u6027\u8d28\uff0c\u800c\u8fd9\u4e5f\u548cIFFT\u6709\u5173\u3002\n\n**\u4e00\u4e2a\u91cd\u8981\u7ed3\u8bba**\n\n\u628a\u591a\u9879\u5f0fA(x)\u7684\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362\u7ed3\u679c\u4f5c\u4e3a\u53e6\u4e00\u4e2a\u591a\u9879\u5f0fB(x)\u7684\u7cfb\u6570\uff0c\u53d6\u5355\u4f4d\u6839\u7684\u5012\u6570\u5373$\\omega_n^0,\\omega_n^{-1}.....,\\omega_n^{1-n}$\u4f5c\u4e3ax\u4ee3\u5165B(x)\uff0c\u5f97\u5230\u7684\u6bcf\u4e2a\u6570\u518d\u9664\u4ee5n\uff0c\u5f97\u5230\u7684\u662fA(x)\u7684\u5404\u9879\u7cfb\u6570\uff0c\u8fd9\u5c31\u5b9e\u73b0\u4e86\u5085\u91cc\u53f6\u53d8\u6362\u7684\u9006\u53d8\u6362\u4e86\u3002\n\n\u76f8\u5f53\u4e8e\u5728FFT\u57fa\u7840\u4e0a\u518d\u641e\u4e00\u6b21FFT\u3002\n\n**\u8bc1\u660e**~~\uff08\u4e2a\u4eba\u89c9\u5f97\u5199\u7684\u975e\u5e38\u6e05\u695a\uff0c\u4e0d\u60f3\u770b\u7684\u8df3\u8fc7\u5427\uff09~~~~  \n\n\u8bbe$(y_0,y_1,y_2,...,y_{n-1})$\u4e3a\u591a\u9879\u5f0f\n$A(x)=a_0+a_1x+a_2x^2+...+a_{n-1}x^{n-1}$\u7684\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362\u3002\n\n\u8bbe\u591a\u9879\u5f0f$B(x)=y_0+y_1x+y_2x^2+...+y_{n-1}x^{n-1}$\n\u628a\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362\u7684$\\omega_n^0,\\omega_n^1.....,\\omega_n^{n-1}$\u8fd9n\u4e2a\u5355\u4f4d\u6839\u7684\u5012\u6570\uff0c\u5373$\\omega_n^0,\\omega_n^{-1}.....,\\omega_n^{1-n}$\u4f5c\u4e3ax\u4ee3\u5165$B(x)$, \u5f97\u5230\u4e00\u4e2a\u65b0\u7684\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362($z_0$,$z_1$,$z_2$,...,$z_{n-1}$)\n\n$z_k$=$\\sum_{i=0}^{n-1}y_i(\\omega_n^{-k})^i$\n\n=$\\sum_{i=0}^{n-1}(\\sum_{j=0}^{n-1}a_j*(\\omega_n^i)^j)(\u03c9_n^{-k})^i$ \n\n=$\\sum_{j=0}^{n-1}a_j*(\\sum_{i=0}^{n-1}(\\omega_n^i)^{j-k})$\n\n\u5f53$j-k=0$\u65f6\uff0c$\\sum_{i=0}^{n-1}(\\omega_n^i)^{j-k}=n$\n\n\u5426\u5219\uff0c\u901a\u8fc7\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u53ef\u77e5\uff1a\n\n$\\sum_{i=0}^{n-1}(\\omega_n^i)^{j-k}$\n=$\\frac{(\u03c9_n^{j-k})^n-1}{\u03c9_n^{j-k}-1}$=$\\frac{(\u03c9_n^{n})^{j-k}-1}{\u03c9_n^{j-k}-1}$=$\\frac{1-1}{\u03c9_n^{j-k}-1}=0$   \n\uff08\u56e0\u4e3a$\\omega_n^n$=$\\omega_n^0$=1\uff09\n\n\u6240\u4ee5\n\n$z_k=n*a_k$\n\n$a_k=\\frac {z_k} n$ \n\n\u5f97\u8bc1\u3002\n\n\u600e\u4e48\u6c42\u5355\u4f4d\u6839\u7684\u5012\u6570\u5462\uff1f\n\n\u5355\u4f4d\u6839\u7684\u5012\u6570\u5176\u5b9e\u5c31\u662f\u5b83\u7684\u5171\u8f6d\u590d\u6570 \u3002~~\u4e0d\u660e\u767d\u7684\u53ef\u4ee5\u770b\u770b\u524d\u9762\u5171\u8f6d\u590d\u6570\u7684\u4ecb\u7ecd~~ \n\n\u5230\u73b0\u5728\u4f60\u5df2\u7ecf\u5b8c\u5168\u5b66\u4f1aFFT\u4e86\uff0c\u4f46\u5199\u9012\u5f52\u8fd8\u662f\u53ef\u80fd\u4f1a\u8d85\u65f6\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u4f18\u5316\n# \u4f18\u5316\uff1a\u8fed\u4ee3FFT\n\u5728\u8fdb\u884cFFT\u65f6\uff0c\u6211\u4eec\u8981\u628a\u5404\u4e2a\u7cfb\u6570\u4e0d\u65ad\u5206\u7ec4\u5e76\u653e\u5230\u4e24\u4fa7\uff0c\u4e00\u4e2a\u7cfb\u6570\u539f\u6765\u7684\u4f4d\u7f6e\u548c\u6700\u7ec8\u7684\u4f4d\u7f6e\u7684\u89c4\u5f8b\u5982\u4e0b\u3002\n\n\u521d\u59cb\u4f4d\u7f6e\uff1a$\\omega_n^0$ $\\omega_n^1$ $\\omega_n^2$ $\\omega_n^3$ $\\omega_n^4$ $\\omega_n^5$ $\\omega_n^6$ $\\omega_n^7$\n\n\u7b2c\u4e00\u8f6e\u540e\uff1a$\\omega_n^0$ $\\omega_n^2$ $\\omega_n^4$ $\\omega_n^6$|$\\omega_n^1$ $\\omega_n^3$ $\\omega_n^7$ $\\omega_n^5$ \n\n\u7b2c\u4e8c\u8f6e\u540e\uff1a$\\omega_n^0$ $\\omega_n^4$|$\\omega_n^2$ $\\omega_n^6$|$\\omega_n^1$ $\\omega_n^5$|$\\omega_n^3$ $\\omega_n^7$ \n\n\u7b2c\u4e09\u8f6e\u540e\uff1a$\\omega_n^0$|$\\omega_n^4$|$\\omega_n^2$|$\\omega_n^6$|$\\omega_n^1$|$\\omega_n^5$|$\\omega_n^3$|$\\omega_n^7$\n\n\u201c|\u201d\u4ee3\u8868\u5206\u7ec4\u754c\u9650 \n\u628a\u6bcf\u4e2a\u4f4d\u7f6e\u7528\u4e8c\u8fdb\u5236\u8868\u73b0\u51fa\u6765\u3002\n\n\u4f4d\u7f6ex\u4e0a\u7684\u6570\uff0c\u6700\u540e\u6240\u5728\u7684\u4f4d\u7f6e\u662f\u201cx\u4e8c\u8fdb\u5236\u7ffb\u8f6c\u5f97\u5230\u7684\u6570\u201d\uff0c\u4f8b\u59824(100\uff09\u6700\u540e\u5230\u4e861\uff08001\uff09\u30025(101)\u6700\u540e\u4e0d\u53d8\u4e3a5(101)\uff0c3(011)\u6700\u540e\u5230\u4e866(110)\u3002\n\n\u6240\u4ee5\u6211\u4eec\u5148\u628a\u6bcf\u4e2a\u6570\u653e\u5230\u6700\u540e\u7684\u4f4d\u7f6e\u4e0a\uff0c\u7136\u540e\u4e0d\u65ad\u5411\u4e0a\u8fd8\u539f\uff0c\u540c\u65f6\u6c42\u51fa\u70b9\u503c\u8868\u793a\u5c31\u53ef\u4ee5\u5566\u3002\n\n\u8fed\u4ee3\u7248FFT\u5c31\u6bd4\u4e4b\u524d\u7684\u9012\u5f52\u7248\u5feb\u591a\u4e86,\u771f$O(nlog_2n)$\u7edd\u5999\u7b97\u6cd5\n\n# \u4ee3\u7801\u5b9e\u73b0FFT\n\u4e0b\u9762\u662f\u672c\u4eba\u5199\u7684**FFT\u52a0\u901f\u9ad8\u7cbe\u5ea6\u4e58\u6cd5**\u7684\u4ee3\u7801\uff08\u5e76\u6709\u8be6\u7ec6\u6ce8\u91ca\uff09\uff1a\n```javascript\n#include<bits/stdc++.h>\nusing namespace std;\n//complex\u662fstl\u81ea\u5e26\u7684\u5b9a\u4e49\u590d\u6570\u7684\u5bb9\u5668 \ntypedef complex<double> cp;\n#define N 2097153\n//pie\u8868\u793a\u5706\u5468\u7387\u03c0 \nconst double pie=acos(-1);\nint n;\ncp a[N],b[N];\nint rev[N],ans[N];\nchar s1[N],s2[N];\n//\u8bfb\u5165\u4f18\u5316 \nint read(){\n\tint sum=0,f=1;\n\tchar ch=getchar();\n\twhile(ch>'9'||ch<'0'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){sum=(sum<<3)+(sum<<1)+ch-'0';ch=getchar();}\n\treturn sum*f;\n}\n//\u521d\u59cb\u5316\u6bcf\u4e2a\u4f4d\u7f6e\u6700\u7ec8\u5230\u8fbe\u7684\u4f4d\u7f6e \n{\n    int len=1<<k;\n\tfor(int i=0;i<len;i++)\n\trev[i]=(rev[i>>1]>>1)|((i&1)<<(k-1));\n}\n//a\u8868\u793a\u8981\u64cd\u4f5c\u7684\u7cfb\u6570\uff0cn\u8868\u793a\u5e8f\u5217\u957f\u5ea6\n//\u82e5flag\u4e3a1\uff0c\u5219\u8868\u793aFFT\uff0c\u4e3a-1\u5219\u4e3aIFFT(\u9700\u8981\u6c42\u5012\u6570\uff09 \nvoid fft(cp *a,int n,int flag){ \n    for(int i=0;i<n;i++)\n\t{\n\t //i\u5c0f\u4e8erev[i]\u65f6\u624d\u4ea4\u6362\uff0c\u9632\u6b62\u540c\u4e00\u4e2a\u5143\u7d20\u4ea4\u6362\u4e24\u6b21\uff0c\u56de\u5230\u5b83\u539f\u6765\u7684\u4f4d\u7f6e\u3002 \n\t  if(i<rev[i])swap(a[i],a[rev[i]]);\n\t}\n\tfor(int h=1;h<n;h*=2)//h\u662f\u51c6\u5907\u5408\u5e76\u5e8f\u5217\u7684\u957f\u5ea6\u7684\u4e8c\u5206\u4e4b\u4e00\n\t{\n\tcp wn=exp(cp(0,flag*pie/h));//\u6c42\u5355\u4f4d\u6839w_n^1 \n\t for(int j=0;j<n;j+=h*2)//j\u8868\u793a\u5408\u5e76\u5230\u4e86\u54ea\u4e00\u4f4d\n\t {\n\t  cp w(1,0);\n\t   for(int k=j;k<j+h;k++)//\u53ea\u626b\u5de6\u534a\u90e8\u5206\uff0c\u5f97\u5230\u53f3\u534a\u90e8\u5206\u7684\u7b54\u6848\n\t   {\n\t     cp x=a[k];\n\t     cp y=w*a[k+h];\n         a[k]=x+y;  //\u8fd9\u4e24\u6b65\u662f\u8774\u8776\u53d8\u6362 \n         a[k+h]=x-y;\n         w*=wn; //\u6c42w_n^k \n\t   }\n\t }\n\t }\n\t //\u5224\u65ad\u662f\u5426\u662fFFT\u8fd8\u662fIFFT \n\t if(flag==-1)\n\t for(int i=0;i<n;i++)\n     a[i]/=n;\n}\nint main(){\n\tn=read(); \n\tscanf(\"%s%s\",s1,s2);\n\t//\u8bfb\u5165\u7684\u6570\u7684\u6bcf\u4e00\u4f4d\u770b\u6210\u591a\u9879\u5f0f\u7684\u4e00\u9879\uff0c\u4fdd\u5b58\u5728\u590d\u6570\u7684\u5b9e\u90e8 \n    for(int i=0;i<n;i++)a[i]=(double)(s1[n-i-1]-'0');\n\tfor(int i=0;i<n;i++)b[i]=(double)(s2[n-i-1]-'0');\n\t//k\u8868\u793a\u8f6c\u5316\u6210\u4e8c\u8fdb\u5236\u7684\u4f4d\u6570 \n\tint k=1,s=2;\n \twhile((1<<k)<2*n-1)k++,s<<=1;\n\tinit(k);\n\t//FFT \u628aa\u7684\u7cfb\u6570\u8868\u793a\u8f6c\u5316\u4e3a\u70b9\u503c\u8868\u793a \n    fft(a,s,1);\n    //FFT \u628ab\u7684\u7cfb\u6570\u8868\u793a\u8f6c\u5316\u4e3a\u70b9\u503c\u8868\u793a \n    fft(b,s,1);\n    //FFT \u4e24\u4e2a\u591a\u9879\u5f0f\u7684\u70b9\u503c\u8868\u793a\u76f8\u4e58 \n    for(int i=0;i<s;i++)\n    a[i]*=b[i];\n    //IFFT \u628a\u8fd9\u4e2a\u70b9\u503c\u8868\u793a\u8f6c\u5316\u4e3a\u7cfb\u6570\u8868\u793a \n    fft(a,s,-1);\n    //\u4fdd\u5b58\u7b54\u6848\u7684\u6bcf\u4e00\u4f4d(\u6ce8\u610f\u8fdb\u4f4d\uff09 \n    for(int i=0;i<s;i++)\n    {\n    //\u53d6\u5b9e\u6570\u56db\u820d\u4e94\u5165\uff0c\u6b64\u65f6\u865a\u6570\u90e8\u5206\u5e94\u5f53\u4e3a0\u6216\u7531\u4e8e\u6d6e\u70b9\u8bef\u5dee\u63a5\u8fd10\n\tans[i]+=(int)(a[i].real()+0.5);\n\tans[i+1]+=ans[i]/10;\n\tans[i]%=10;\n\t}\n\twhile(!ans[s]&&s>-1)s--;\n\tif(s==-1)printf(\"0\");\n\telse\n\tfor(int i=s;i>=0;i--)\n\tprintf(\"%d\",ans[i]);\n\treturn 0;\n}\n```\n# \u540e\u8bb0\n\u8fd9\u7bc7\u535a\u5ba2\u5199\u4e86\u4e00\u5929\uff0c\u7ec8\u4e8e\u5199\u5b8c\u4e86\uff0c\u5b8c\u7ed3\u6492\u82b1\u273f\u273f\u30fd(\u00b0\u25bd\u00b0)\u30ce\u273f\nFWT\u6211\u6765\u5566\uff01\uff01\uff01\n",
        "postTime": 1565610571,
        "uid": 100708,
        "name": "Trilarflagz",
        "ccfLevel": 0,
        "title": "\u8d85\u8be6\u7ec6\u6613\u61c2FFT\uff08\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\uff09\u53ca\u4ee3\u7801\u5b9e\u73b0"
    },
    {
        "content": "\u53d1\u4e00\u4e0bNTT\u7248\u672c\u7684\u9898\u89e3\n\n\u5173\u4e8eNTT\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u5229\u7528\u4e00\u4e9b\u7279\u6b8a\u7684\u8d28\u6570\uff08\u4f8b\u5982 $998244353$\uff0c\u8fd9\u4e9b\u8d28\u6570\u7684\u7279\u5f81\u90fd\u662f\u53ef\u4ee5\u53ef\u4ee5\u8868\u793a $q \\times 2 ^ k + 1$ \u7684\u5f62\u5f0f\uff09\u8fdb\u884c\u819c\u610f\u4e49\u4e0b\u7684\u8fd0\u7b97\u4ee3\u66ff\u6d6e\u70b9\u590d\u6570\u8fd0\u7b97\u6765\u4fdd\u8bc1\u7cbe\u5ea6\uff0c\u539f\u7406\u662f\u8d28\u6570\u539f\u6839\u548c\u590d\u6570\u5355\u4f4d\u6839\u5728DFT\u8fd0\u7b97\u4e2d\u5177\u6709\u76f8\u540c\u7684\u6027\u8d28\n\n\u5177\u4f53\u5b9e\u73b0\u770b\u4ee3\u7801\uff1a\uff08\u5176\u4e2d $998244353$ \u7684\u539f\u6839 $g = 3$\uff09\n\n```cpp\n/**************************************************************\n    Problem: 2179\n    User: infinityedge\n    Language: C++\n    Result: Accepted\n    Time:3424 ms\n    Memory:7052 kb\n****************************************************************/\n \n#include <iostream>\n#include <cstring>\n#include <cmath>\n#include <cstdio>\n#include <algorithm>\n#include <queue>\n#include <vector>\n#include <map>\n#include <complex>\n \n#define inf 0x3f3f3f3f\n#define N 131072\n \n#define lc k << 1\n#define rc k << 1 | 1\n \nusing namespace std;\n \ntypedef long long ll;\nconst ll p = 998244353;\ntypedef complex<double> E;\n \nconst double pi = acos(-1);\n \nll qpow(ll a, ll b, ll p){\n    ll res = 1;\n    for(; b; b >>= 1, a = a * a % p){\n        if(b & 1) res = res * a % p;\n    }\n    return res;\n}\n \nint n;\n \nll a[N], b[N];\nll tmp[N];\n \nvoid bit_reverse(int n, ll* r){\n    for(int i = 0, j = 0; i < n; i ++){\n        if(i > j) swap(r[i], r[j]);\n        for(int l = n >> 1; (j ^= l) < l; l >>= 1);\n    }\n}\nll inv3;\nll pow3[N], powinv3[N];\n \nvoid pre(){\n    inv3 = qpow(3, p - 2, p);\n    for(int i = 1; i <= n; i <<= 1) pow3[i] = qpow(3, (p - 1) / i, p);\n    for(int i = 1; i <= n; i <<= 1) powinv3[i] = qpow(inv3, (p - 1) / i, p);\n}\n \nvoid NTT(int n, ll* r, ll f){\n    bit_reverse(n, r);\n    for(int i = 2; i <= n; i <<= 1){\n        int m = i >> 1;\n        for(int j = 0; j < n; j += i){\n            ll w = 1, wn = pow3[i];\n            if(f == -1) wn = powinv3[i];\n            for(int k = 0; k < m; k ++){\n                ll z = r[j + m + k] * w % p;\n                r[j + m + k] = (r[j + k] - z + p) % p;\n                r[j + k] = (r[j + k] + z) % p;\n                w = w * wn % p;\n            }\n        }\n    }\n    if(f == -1){\n        ll inv = qpow(n, p - 2, p);\n        for(int i = 0; i < n; i ++) r[i] = r[i] * inv % p;\n    }\n}\n \nint c[N]; char ch[N];\nint main(){\n    scanf(\"%d\", &n); \n    scanf(\"%s\", ch);\n    for(int i = 0; i < n; i ++){\n        a[i] = ch[n - i - 1] - '0';\n    }\n    scanf(\"%s\", ch);\n    for(int i = 0; i < n; i ++){\n        b[i] = ch[n - i - 1] - '0';\n    }\n    int m = n * 2; n = 1;\n    while(n <= m) n <<= 1;\n    pre();\n    NTT(n, a, 1);\n    NTT(n, b, 1);\n    for(int i = 0; i < n; i ++) a[i] = a[i] * b[i] % p;\n    NTT(n, a, -1);\n    for(int i = 0; i < n; i ++) c[i] = a[i];\n    for(int i = 0; i < n; i ++){\n        if(c[i] >= 10){\n            c[i + 1] += c[i] / 10;\n            c[i] %= 10;\n        }   \n    }\n    int pp = n - 1;\n    while(c[pp] == 0) pp--;\n    for(int i = pp; i >= 0; i --){\n        printf(\"%d\", c[i]);\n    }\n    return 0;\n}\n```",
        "postTime": 1510198603,
        "uid": 19241,
        "name": "infinityedge",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P1919 \u3010\u3010\u6a21\u677f\u3011A*B Problem\u5347\u7ea7\u7248\uff08FFT\u5feb\u901f\u5085\u91cc\u53f6\uff09\u3011"
    },
    {
        "content": "\u9274\u4e8e\u6bd2\u7624\u9c30\u52a0\u5f3a\u4e86\u6570\u636e,\u5728\u6b64\u53d1\u4e00\u7bc7\u5173\u4e8e\u52a0\u5f3a\u6570\u636e\u7684NTT\u9898\u89e3\n\n## \u4e00\u3001\u5982\u4f55\u4f18\u5316\u9ad8\u7cbe\u4e58\n\n\u4f17\u6240\u5468\u77e5,\u6734\u7d20\u7684\u9ad8\u7cbe\u4e58\u662f $\\Theta(n^2)$ \u7684,\u5bf9\u4e8e\u8d85\u8fc7 $10^{10000}$ \u7684\u6570\u636e,\u8981\u5c1d\u8bd5\u53bb\u4f18\u5316ta  \n\u4e00\u4e2a\u6bd4\u8f83\u7b80\u5355\u7684\u65b9\u6cd5\u662f\u538b\u4f4d,\u5c31\u662f\u7528\u4e00\u4e2aint\u6216\u8005long long\u8fde\u7eed\u5b58\u50a8\u591a\u4f4d,\u4ee5\u6b64\u4f18\u5316\u5e38\u6570,\u7136\u800c...\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/hrsyu8mu.png)\n![](https://cdn.luogu.com.cn/upload/image_hosting/23c9eirm.png)   \n\u4e8e\u662f $a,b\\le 10^{65536} => a,b\\le 10^{1000000}$ ,\u5c31\u5fc5\u987b\u4f18\u5316\u590d\u6742\u5ea6\u6765\u505a\u8fd9\u9053\u9898\u4e86\u3002\u600e\u4e48\u4f18\u5316\u5462?\n\n\u9996\u5148,\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4f4d\u503c\u539f\u7406\u5c06\u4e00\u4e2a\u6570\u8f6c\u5316\u4e3an\u6b21\u51fd\u6570(\u591a\u9879\u5f0f),  \n\u5982$\\quad3579=3x^3+5x^2+7x+9\\quad$,\u5176\u4e2d $x=10$\u3002\n\n\u6211\u4eec\u79f0\u8fd9\u79cd\u6211\u4eec\u4e00\u822c\u7528\u6765\u8868\u793an\u6b64\u51fd\u6570\u7684\u65b9\u6cd5\u79f0\u4e3a**\u7cfb\u6570\u8868\u793a\u6cd5**\u3002  \n\u4e0d\u96be\u53d1\u73b0,\u8be5\u591a\u9879\u5f0f\u7684\u4e58\u6cd5\u5c31\u662f\u4e0d\u5e26\u8fdb\u4f4d\u7684\u9ad8\u7cbe\u4e58 (\u52a0\u6cd5\u540c\u7406)\n\n\u6b64\u5916,~~\u7528\u5c0f\u5b66\u77e5\u8bc6~~\u53ef\u77e5,\u7528 $(n+1)$ \u4e2a\u70b9\u53ef\u552f\u4e00\u786e\u5b9a\u4e00\u4e2a $n$ \u6b21\u51fd\u6570,  \n\u6211\u4eec\u5b9a\u4e49\u8fd9\u79cd\u8868\u793a\u65b9\u6cd5\u4e3a**\u70b9\u503c\u8868\u793a\u6cd5**\u3002  \n\u4e8e\u662f\u8bbe\u7b2c\u4e00\u4e2a\u591a\u9879\u5f0fA\u53ef\u8f6c\u5316\u4e3a $(x_0,a_0),(x_1,a_1)\\cdots(x_n,a_n)$\uff0c  \n\u7b2c\u4e8c\u4e2a\u591a\u9879\u5f0fB\u53ef\u8f6c\u5316\u4e3a$\\quad\\quad\\quad(x_0,b_0),(x_1,b_1)\\cdots(x_n,b_n)$\uff0c  \n\u6211\u4eec\u5c31\u53ef\u4ee5\u7528 $\\Theta(n)$ \u7684\u590d\u6742\u5ea6\u628a\u5b83\u4eec\u4e58\u8d77\u6765,\u4e8e\u662f\u7b54\u6848\u5c31\u662f  \n$(x_0,a_0\\times b_0),(x_1,a_1\\times b_1)\\cdots(x_n,a_n\\times b_n)$\n\nQ:\u53ef\u662f\u4ee3\u5165\u8fd9\u4e9b\u503c\u4e5f\u8981 $\\Theta(n^2)$ \u5440,\u800c\u4e14\u663e\u800c\u6613\u89c1\u4f1a\u7206long long,\n\t\u8fd9\u79cd\u505a\u6cd5\u4e0d\u5e94\u66f4\u52a3\u5417?  \nA:\u4e0d\u6025,\u6211\u4eec\u63a5\u4e0b\u6765\u5c31\u8bb2\u3002\n\n## \u4e8c\u3001\u5085\u91cc\u53f6\u7684\u4f18\u5316\u65b9\u6cd5  \n\u9274\u4e8e\u8fd9\u4e00\u60c5\u51b5,\u5927\u4f6c\u5085\u91cc\u53f6\u627e\u5230\u4e86\u4e00\u7ec4\u7279\u6b8a\u7684\u503c\u5728\u7279\u5b9a\u610f\u4e49\u4e0b\u4ee3\u5165,\u4ee5\u6b64\u6765\u7f29\u77ed\u503c\u57df,\u4f18\u5316\u5e38\u6570\u548c\u7cbe\u5ea6\n\n\u6211\u4eec\u628a \u5c06\u7cfb\u6570\u8868\u793a\u6cd5 \u901a\u8fc7\u4ee3\u5165\u4ed6\u627e\u5230\u7684\u503c \u8f6c\u5316\u4e3a\u70b9\u503c\u8868\u793a\u6cd5 \u79f0\u4e3a**DFT**,  \n\u518d\u628a \u7531DFT\u8f6c\u5316\u6210\u7684\u70b9\u503c\u8868\u793a\u6cd5 \u91cd\u65b0\u8f6c\u5316\u4e3a\u7cfb\u6570\u8868\u793a\u6cd5 \u79f0\u4e3a**IDFT** \n\n\u5982\u4f55\u8ba9\u4ee3\u5165\u7684\u503c\u8fbe\u5230\u8fd9\u79cd\u6548\u679c\u5462? \u6211\u4eec\u5e0c\u671b\u4ee3\u5165\u7684\u503c\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a  \n\t1.\u4ee3\u5165\u7684\u503c\u4e92\u4e0d\u76f8\u540c(\u663e\u800c\u6613\u89c1,\u5982\u679c\u76f8\u540c\u5c31\u76f8\u5f53\u4e8e\u540c\u4e00\u4e2a\u70b9)  \n    2.\u4ee3\u5165\u7684\u503c\u7684\u4e58\u65b9\u5728\u4e00\u4e2a\u8303\u56f4\u5185\u8f6c\u5708\u5708\u3002(\u8fd9\u4e2a\u6bd4\u8f83\u91cd\u8981,\u5bf9\u503c\u57df\u548c\u7cbe\u5ea6\u90fd\u6709\u9650\u5236)\n    \n\u4e8e\u662f\u6211\u4eec\u5c31\u6709\u4e24\u79cd\u505a\u6cd5\u6765\u9650\u5236:\u53d6\u6a21(NTT)\u548c\u590d\u6570\u8fd0\u7b97(FFT)\u3002\u5176\u4e2d\u590d\u6570\u8fd0\u7b97\u6d89\u53ca\u6d89\u53ca\u9ad8\u4e2d\u5185\u5bb9,  \n\u76f8\u5173\u5b9a\u7406\u5bf9\u4e8e\u521d\u4e2d\u840c\u65b0\u8f83\u4e3a\u96be\u7406\u89e3,\u800c\u4e14\u5b9e\u6570\u8fd0\u7b97\u6709\u7cbe\u5ea6\u9650\u5236,\u6240\u4ee5\u8fd9\u91cc\u6211\u4eec\u7528\u53d6\u6a21\u6765\u9650\u5236,\u5373NTT\n\n## \u4e09\u3001NTT\u7684\u524d\u7f6e\u829d\u58eb\n1.\u4e58\u6cd5\u9006\u5143(\u9c30\u53d5\u5728\u6a21\u677f\u4e0a\u9762\u5361\u4e86\u5e38)   \n[P3811 \u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u5143](https://www.luogu.org/problem/P3811)   \n[P5431 \u3010\u6a21\u677f\u3011\u4e58\u6cd5\u9006\u51432](https://www.luogu.org/problem/P5431)  \n2.\u539f\u6839  \n\t\u5b66\u8fc7\u4e58\u6cd5\u9006\u5143\u7684\u670b\u53cb\u5e94\u8be5\u90fd\u77e5\u9053\u8d39\u9a6c\u5c0f\u5b9a\u7406: $\\text{\u82e5}p\\text{\u4e3a\u8d28\u6570,\u5219}a^{p-1}\\equiv 1\\quad(\\text{mod }p)$  \n   \u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a\u8d28\u6570 $p$ ,\u5982\u679c\u6709\u4e00\u4e2a\u6570 $a$ ,\u4f7f\u5f97 $a^0,a^1,\\cdots a^{p-2} $\u5728$\\mod p$\u610f\u4e49\u4e0b\u4e92\u4e0d\u76f8\u7b49\uff0c  \n   ,\u6211\u4eec\u5c31\u79f0a\u4e3a$\\mod m$\u7684**\u539f\u6839**,\u901a\u5e38\u7528\u5b57\u6bcd $g$ \u8868\u793a\n   \n   \u6362\u4e2a\u65b9\u5f0f\u7406\u89e3,\u539f\u6839\u7684\u4e58\u65b9\u76f8\u5f53\u4e8e\u628a$1\\sim p-1$\u5168\u90e8\u904d\u5386\u4e86\u4e00\u904d\n   \u7136\u540e\u56de\u5230\u4e86\u539f\u70b9,\u521a\u597d\u6ee1\u8db3\u6761\u4ef61\u548c\u6761\u4ef62\n   \n## \u56db\u3001NTT\u52a0\u901f\u591a\u9879\u5f0f\u4e58\u6cd5\n\n1.\u5355\u4f4d\u6839  \n\t\u4e3a\u4e86\u65b9\u4fbf\u5206\u6cbb,\u6211\u4eec\u5148\u5c06\u591a\u9879\u5f0f\u8865\u8db3\u5230$2^k$,  \n   \u7136\u540e\u5c06\u5f62\u5982 $q\\times 2^k+1$ \u7684\u8d28\u6570\u4f5c\u4e3a\u6a21\u6570,\u8ba9\u8ba1\u7b97\u5728\u5176\u6a21\u610f\u4e49\u4e0b\u8fdb\u884c\n  \n   NTT\u5e38\u7528\u7684\u6a21\u6570\u6709$998244353=119\\times 2^{23}+1,1004535809=479\\times 2^{21}$,\u4e8c\u8005\u7684\u539f\u6839\u90fd\u4e3a3   \n   \u5982\u679c\u9700\u8981\u66f4\u591a\u7684\u6a21\u6570,\u53ef\u4ee5\u770b[\u8fd9\u91cc](https://www.cnblogs.com/Guess2/p/8422205.html)\n   \n   \u7136\u540e\u6211\u4eec\u4ee3\u5165\u7684\u6570\u5c31\u662f  \n   $g^0,g^q,g^{2q},g^{3q}\\cdots g^{(2^k-1)q}(\\text{mod }q\\times 2^k+1)$\n   \n   \u4e8e\u662f\u5728\u6a21\u610f\u4e49\u4e0b\u4ee3\u5165\u5b83\u4eec\u5c31\u5f97\u5230\u4e86DFT,  \n   \u800cIDFT\u5c31\u662f\u5c31\u662f\u6309\u987a\u5e8f\u628a\u4ee3\u5165\u5f97\u5230\u7684\u503c\u4f5c\u4e3a\u7cfb\u6570,\u4f9d\u6b21\u4ee3\u5165\u8fd9\u4e9b\u6570\u7684\u9006\u5143,  \n   \u6700\u540e\u4e58\u4e0a$2^k$\u7684\u9006\u5143\u5c31\u53ef\u4ee5\u8f6c\u56de\u6765\u4e86\n   \n   \u4e3a\u65b9\u4fbf\u79f0\u547c,\u6211\u4eec\u8bbe$2^k=n,w^x_n=g^{xq}$,\u6b64\u65f6$w^x_n$\u6211\u4eec\u79f0\u5b83\u4e3a**\u5355\u4f4d\u6839**\n   \n   \n   \u4e8e\u662f\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e9b\u6027\u8d28\uff1a\n   \n$\\quad$1.$w^0_n=w^n_n=1,w^x_n\\equiv (w^1_n)^x(\\text{mod }q\\times 2^k+1)$ (\u663e\u800c\u6613\u89c1)  \n$\\quad$2.$w^{2x}_{2n}\\equiv w^x_n(\\text{mod } q\\times 2^k+1)$(\u76f8\u5f53\u4e8e\u4ece$2^k$\u4e2d\u63d0\u53d6\u4e00\u4e2a2\u5230q)  \n$\\quad$3.\u82e5$x<\\frac{n}{2}$,\u5219$w^x_n\\equiv -w^{x+\\frac{n}{2}}_n(\\text{mod }q\\times 2^k+1)$  \n $\\qquad$\u8bc1\u660e:\u4e24\u8fb9\u540c\u65f6\u4e58\u4ee5$w^x_n$\u7684\u9006\u5143,\u5f97   \n $\\qquad\\qquad 1\\equiv -w^{\\frac{n}{2}}_n(\\text{mod }q\\times 2^k+1)$   \n$\\qquad\\qquad\\because (w^{\\frac{n}{2}}_n)^2=w^n_n=1,$\u4e14\u7531\u539f\u6839\u7684\u6027\u8d28$,w^{\\frac{n}{2}}_n\\ne w^0_n=1$  \n$\\qquad\\qquad\\therefore w^{\\frac{n}{2}}_n\\equiv-1(\\text{mod } q\\times 2^k+1)$,\u8bc1\u6bd5  \n\n\u900f\u8fc7\u8fd9\u4e9b\u6027\u8d28\uff0c\u5c31\u53ef\u4ee5\u7528\u5206\u6cbb\u6765\u505a\u4e86  \n\u8bbe\u8981\u4ee3\u5165\u7684\u591a\u9879\u5f0f\u4e3a$F(x)=a_0+a_1x^1+a_2x^2+\\cdots+a_{n-1}x^{n-1}$  \n\u628a\u4e0b\u6807\u4e3a\u5076\u6570\u7684\u653e\u4e00\u8fb9,\u4e0b\u6807\u4e3a\u5947\u6570\u7684\u653e\u4e00\u8fb9,\u5f97\u5230  \n$F(x)=(a_0+a_2x^2+\\cdots+a_{n-2}x^{n-2})+x(a_1+a_3x^2+\\cdots a_{n-1}x^{n-2})$  \n\u4e8e\u662f\u8bbe$A(x)=a_0+a_2x^1+\\cdot+a_{n-2}x^{\\frac{n}{2}-1},B(x)=a_1+a_3x^1+\\cdot+a_{n-1}x^{\\frac{n}{2}-1}$  \n\u6240\u4ee5$F(x)=A(x^2)+x\\times B(x^2)$  \n\u4ee3\u5165$w^x_n$,\u5f97\u5230$F(w^x_n)=A((w^x_n)^2)+w^x_n\\times B((w^x_n)^2)=A(w^x_{\\frac{n}{2}})+w^x_n\\times B(w^x_{\\frac{n}{2}})$  \n\u8fd9\u65f6,\u82e5\u6211\u4eec\u4ee3\u5165$w^{x+\\frac{n}{2}}_n$,\u5c31\u53ef\u4ee5\u5f97\u5230  \n$F(w^{x+\\frac{n}{2}}_n)=A((w^{x+\\frac{n}{2}}_n)^2)+w^{x+\\frac{n}{2}}_n\\times B((w^{x+\\frac{n}{2}}_n)^2)=A(w^x_{\\frac{n}{2}})-w^x_n\\times B(w^x_{\\frac{n}{2}})$  \n\u8fd9\u65f6,\u6211\u4eec\u53d1\u73b0,\u6211\u4eec\u5728\u626b\u8fc7$F(w^0_n\\sim w^{\\frac{n}{2}-1}_n)$\u65f6,\u53ef\u4ee5\u987a\u5e26\u5f97\u5230$F(w^{\\frac{n}{2}}_n\\sim w^{n-1}_n)$,\u4e5f\u5c31\u53ef\u4ee5$\\Theta(n\\log n)$\u5206\u6cbb\u4e86\n\n## \u4e94\u3001FFT/NTT\u7684\u5e38\u6570\u4f18\u5316\n\n1.\u975e\u9012\u5f52\u5199\u6cd5  \n\t\u6211\u4eec\u5728\u5212\u5206$A(x),B(x)$\u7684\u65f6\u5019,\u662f\u6309\u4e0b\u6807\u7684\u5947\u5076\u6027\u6765\u5206\u7684,\u4e5f\u5c31\u662f\u770b\u4e0b\u6807\u4e8c\u8fdb\u5236\u7684\u6700\u540e\u4e00\u4f4d  \n   \u4e8e\u662f\u6574\u4f53\u9012\u5f52\u4e0b\u6765,\u5c31\u662f\u5148\u770b\u4e0b\u6807\u4e8c\u8fdb\u5236\u7684\u6700\u540e\u4e00\u4f4d,\u518d\u770b\u5012\u6570\u7b2c\u4e8c\u4f4d,\u518d...  \n   \u4e8e\u662f\u6700\u7ec8\u9012\u5f52\u5230\u7684\u4f4d\u7f6e\u5c31\u662f\u4e0b\u6807\u4e8c\u8fdb\u5236\u7ffb\u8f6c\u8fc7\u6765,\u53ef\u4ee5\u9884\u5904\u7406\u597d\n   \n2.\u8774\u8776\u53d8\u6362\uff1a\u5c31\u5730\u8fdb\u884cFFT\\NTT  \n\t\u5982\u679c\u5df2\u7ecf\u987a\u5e8f\u5b58\u50a8\u4e86$A(1\\sim w^{\\frac{n}{4}}_{\\frac{n}{2}}),B(1\\sim w^{\\frac{n}{4}}_{\\frac{n}{2}})$\uff0cA\u5728B\u7684\u524d\u9762  \n  \t\u5bf9\u4e8e\u8981\u8fed\u4ee3\u5230\u7684$w^x_n$\u548c$w^{x+\\frac{n}{2}}_n$\uff0c\u53ef\u4ee5\u540c\u65f6\u8fdb\u884c\u8fed\u4ee3,  \n    \u5c06$w^x_n$\u653e\u5230\u539f$A(w^x_{\\frac{n}{2}})$\u7684\u4f4d\u7f6e,\u5c06$w^{x+\\frac{n}{2}}$\u653e\u5230\u539f$B(w^x_{\\frac{n}{2}})$\u7684\u4f4d\u7f6e,\u4fdd\u8bc1\u987a\u5e8f\u4e0d\u53d8\n    \n### \u516d\u3001\u6700\u7ec8\u4ee3\u7801\n\n```cpp\n#include<stdio.h>\n#include<string.h>\ntypedef unsigned char byte;\ntypedef unsigned int word;\ntypedef unsigned long long ull;\ntypedef long long ll;\nconst word mod=1004535809,size=21;\n//NTT\u6a21\u6570,\u7ed3\u679c\u4e0d\u8d85\u8fc7(1<<size) \nchar io[(1<<size)+1];//\u8f93\u5165\u8f93\u51fa \nword a[1<<size],b[1<<size];//\u591a\u9879\u5f0f/\u9ad8\u7cbe \nword realid[1<<size],root[1<<size],inverse[1<<size];\n//\u8fed\u4ee3\u540e\u7cfb\u6570\u6240\u5728\u7684\u4f4d\u7f6e,\u5355\u4f4d\u6839\u53ca\u5176\u9006\u5143 \nword i,id,floor;\nll num1,num2;\nchar *top;\n//\u5faa\u73af\u53d8\u91cf \ninline ll pow(ll a,ll b){//\u5feb\u901f\u5e42 \n\tregister ll ans=1;\n\tfor(;b;b>>=1){\n\t\tif(b&1) (ans*=a)%=mod;\n\t\t(a*=a)%=mod;\n\t}\n\treturn ans;\n}\ninline void loading(){//\u9884\u5904\u7406\u8fed\u4ee3\u540e\u4f4d\u7f6e,\u5355\u4f4d\u6839\u53ca\u5176\u9006\u5143 \n\troot[0]=inverse[0]=1;\n\tnum1=pow(3,mod>>size);\n\tnum2=pow(num1,mod-2);\n\tfor(i=1;i<1<<size;i++){\n\t\troot[i]=num1*root[i-1]%mod;\n\t\tinverse[i]=num2*inverse[i-1]%mod;\n\t\tfor(id=i,floor=0;floor<size;floor++,id>>=1)\n\t\t\trealid[i]=realid[i]<<1|(id&1);\n\t}\n}\ninline void read(){\n//\u76f4\u63a5\u7528fread,\u7136\u540e\u6307\u9488\u524d\u79fb\u8bfb\u5165\u6570\u636e,\u6548\u7387\u8f83\u9ad8,\u5199\u6cd5\u8f83\u7b80\u5355 \n//\u56e0fread\u7279\u6027,DEV-CPP\u4e0b\u4e0d\u80fd\u4ee5\u6570\u5b57\u7ed3\u5c3e(\u4e0d\u505c\u8bfb\u5165\u6700\u540e\u4e00\u4e2a\u5b57\u7b26),\u4f46linux\u4e0b\u53ef\u4ee5 \n\ttop=io+(1<<size);\n\tfread(io+1,1,1<<size,stdin);\n\twhile('0'>*top||*top>'9') top--;\n\tfor(i=0;'0'<=*top&&*top<='9';top--,i++)\n\t\ta[realid[i]]=*top-'0';//\u76f4\u63a5\u653e\u5230\u8fed\u4ee3\u540e\u7684\u4f4d\u7f6e \n\twhile('0'>*top||*top>'9') top--;\t\n\tfor(i=0;'0'<=*top&&*top<='9';top--,i++)\n\t\tb[realid[i]]=*top-'0';//b\u540c\u7406 \n} \ninline void DFT(){ //\u975e\u8fed\u4ee3\u7248DFT \n\tfor(floor=0;floor<size;floor++)\n\t\tfor(i=0;i<1<<size;i+=(1<<(floor+1)))\n\t\t\tfor(id=0;id<1<<floor;id++){\n\t\t\t\tnum1=a[i+id];//\u8774\u8776\u53d8\u6362 \n\t\t\t\tnum2=a[i+id+(1<<floor)];\n\t\t\t\t(num2*=root[id<<size-floor-1])%=mod;\n\t\t\t\ta[i+id]=(num1+num2)%mod;//\u653e\u56de\u539f\u4f4d \n\t\t\t\ta[i+id+(1<<floor)]=(num1+mod-num2)%mod;\n\t\t\t\t \n\t\t\t\tnum1=b[i+id];//b\u540c\u7406 \n\t\t\t\tnum2=b[i+id+(1<<floor)];\n\t\t\t\t(num2*=root[id<<size-floor-1])%=mod;\n\t\t\t\tb[i+id]=(num1+num2)%mod;\n\t\t\t\tb[i+id+(1<<floor)]=(num1+mod-num2)%mod;\n\t\t\t}\n}\ninline void IDFT(){\n\tfor(floor=0;floor<21;floor++)//\u4e0eDFT\u76f8\u540c \n\t\tfor(i=0;i<0x200000;i+=1<<floor+1)\n\t\t\tfor(id=0;id<1<<floor;id++){\n\t\t\t\tnum1=root[i+id];\n\t\t\t\tnum2=root[i+id+(1<<floor)];\n\t\t\t\t(num2*=inverse[id<<20-floor])%=mod;//\u4e58\u4e0a\u5355\u4f4d\u6839\u9006\u5143 \n\t\t\t\troot[i+id]=(num1+num2)%mod;\n\t\t\t\troot[i+id+(1<<floor)]=(num1+mod-num2)%mod;\n\t\t\t}\n}\ninline void write(){//fwrite\u8f93\u51fa,\u540c\u8f93\u5165\n\tnum2=pow(1<<size,mod-2);\n\ttop=io+(1<<size);\n\tnum1=0;\n\tfor(i=0;i<1<<size;i++){\n\t\tnum1+=num2*root[i]%mod;//\u6700\u540e\u8981\u4e58\u4e0an\u7684\u9006\u5143 \n\t\ttop--;\n\t\t*top=num1%10+'0';\n\t\tnum1/=10;\n\t}\n\twhile(*top=='0'&&top!=io+(1<<size)) top++;\n\tif(top==io+(1<<size)) putchar('0');\n\telse fwrite(top,1,io+(1<<size)-top,stdout);\n}\nint main(){\n\tloading();\n\tread(); \n\tDFT();\n\tfor(i=0;i<1<<size;i++)\n\t\troot[realid[i]]=(ll)(a[i])*b[i]%mod;//\u70b9\u503c\u76f8\u4e58 \n\tIDFT();\n\twrite(); \n\treturn 0;\n}\n```\n### END\u3001\u6570\u636e\u8303\u56f4\n\n\u8bbeNTT\u6a21\u6570\u4e3a$q\\times 2^k+1$,\u90a3\u4e48\u591a\u9879\u5f0f\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7$2^k$\n\n\u8bbe\u539f\u672c\u76f8\u4e58\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u4e0d\u8d85\u8fc7n,\u957f\u5ea6\u4e3aP,\u5219\u76f8\u4e58\u540e\u7684\u7cfb\u6570\u4e0d\u8d85\u8fc7$n^2P$  \n\n\u5982\u679c\u8981\u4f7f\u5f97\u5230\u7684\u7ed3\u679c\u5728\u6a21\u610f\u4e49\u4e0b\u4ecd\u65e7\u662f\u552f\u4e00\u7684,\u9664\u4e86\u6269\u5927NTT\u6a21\u6570,\u4e5f\u53ef\u4ee5\u53d6\u591a\u4e2a\u6a21\u6570\u505aNTT,  \n\u6700\u540e\u5c06\u5f97\u5230\u7684\u7ed3\u679c\u7528\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\u5408\u5e76(\u8fd9\u4e5f\u5c31\u662f\u4efb\u610f\u6a21\u6570NTT\u7684\u65b9\u6cd5)\n",
        "postTime": 1573465883,
        "uid": 104726,
        "name": "wangrx",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P1919 \u3010\u3010\u6a21\u677f\u3011A*B Problem\u5347\u7ea7\u7248\uff08FFT\u5feb\u901f\u5085\u91cc\u53f6\uff09\u3011"
    },
    {
        "content": "\u4ecb\u7ecd\u4e00\u79cd~~\u5e76\u4e0d\u80fd\u8fc7\u9898~~\u7684Karatsuba \u4e58\u6cd5\u3002\n\n\u5047\u8bbe\u6211\u4eec\u8981\u6c42x*y,\u6211\u4eec\u8ba9\uff1a\n$$x=a*10^{n/2}+b,y=c*10^{n/2}+d$$\n\n\u90a3\u4e48\n$$xy=ac\\times10^{(n-n/2)\\times2}+(ad+bc)\\times10^{n-n/2}+bd$$\n\u53c8\u56e0\u4e3a\n$$ad+bc=(a+b)(c+d)-(ac+bd)$$\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u91cd\u590d\u5229\u7528ac\u548cbd\u7684\u7ed3\u679c\uff0c\u4e0d\u7528\u505a\u56db\u6b21\u4e58\u6cd5\u3002\n\u8fd9\u6837\u9012\u5f52\u4e0b\u53bb\u6c42\u7684\u590d\u6742\u5ea6\u662f (\u6765\u81ea\u767e\u5ea6\u767e\u79d1)\n$$3n^{log3}\u22483n^{1.585}$$\n\n\u4e0b\u9762\u662f\u8fd9\u4e2a\u7b97\u6cd5\u672c\u849f\u84bb\u7684\u4ee3\u7801\u5b9e\u73b0\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int L=120010;\nstring add(string a,string b)\n{\n    string ans;\n    int na[L]={0},nb[L]={0};\n    int la=a.size(),lb=b.size();\n    for(int i=0;i<la;i++) na[la-1-i]=a[i]-'0';\n    for(int i=0;i<lb;i++) nb[lb-1-i]=b[i]-'0';\n    int lmax=la>lb?la:lb;\n    for(int i=0;i<lmax;i++) na[i]+=nb[i],na[i+1]+=na[i]/10,na[i]%=10;\n    if(na[lmax]) lmax++;\n    for(int i=lmax-1;i>=0;i--) ans+=na[i]+'0';\n    return ans;\n}\nstring sub(string a,string b)\n{\n    string ans;\n    int na[L]={0},nb[L]={0};\n    int la=a.size(),lb=b.size();\n    for(int i=0;i<la;i++) na[la-1-i]=a[i]-'0';\n    for(int i=0;i<lb;i++) nb[lb-1-i]=b[i]-'0';\n    int lmax=la>lb?la:lb;\n    for(int i=0;i<lmax;i++)\n    {\n        na[i]-=nb[i];\n        if(na[i]<0) na[i]+=10,na[i+1]--;\n    }\n    while(!na[--lmax]&&lmax>0)  ;lmax++;\n    for(int i=lmax-1;i>=0;i--) ans+=na[i]+'0';\n    return ans;\n}\n//---------------------\u5927\u6570\u52a0\u51cf\u6cd5---------------------------------//\nstring karatsuba(string a,string b){\n    if(a.size()<b.size()) swap(a,b);\n    int tmp=a.size()-b.size();\n    string qd0=\"\";for(int i=0;i<tmp;i++) qd0+='0';\n    b=qd0+b;\n    //---------------\u8865\u524d\u5bfc0------------------//\n    if(a.size()==b.size()&&a.size()==1){\n        string ans=\"\";\n        int ansnum=(a[0]-48)*(b[0]-48);\n        while(ansnum){ans=(char)('0'+ansnum%10)+ans;ansnum/=10;}\n        if(ans.size()==0) ans=\"0\";\n        return ans;\n    }\n    int mid=a.size()-a.size()/2;\n    string qa,ha,qb,hb;\n    qa=a.substr(0,mid);ha=a.substr(mid,a.size()-mid);\n    qb=b.substr(0,mid);hb=b.substr(mid,b.size()-mid);\n    string qaqb=karatsuba(qa,qb);\n    string hahb=karatsuba(ha,hb);\n    string qahbhaqb=sub(karatsuba(add(qa,ha),add(qb,hb)),add(qaqb,hahb));\n    //------------------\u4e09\u6b21\u4e58\u6cd5---------------------------//\n    for(int i=0;i<(a.size()-mid)*2;i++) qaqb+='0';\n    for(int i=0;i<(a.size()-mid);i++) qahbhaqb+='0';\n    //------------------\u79fb\u4f4d------------------------------//\n    string ans=add(qaqb,qahbhaqb);\n    ans=add(ans,hahb);\n    return ans;\n}\nint main(){\n    int n;cin>>n;\n    string a,b;cin>>a>>b;\n    cout<<karatsuba(a,b)<<endl;\n    return 0;\n}\n\n```\n",
        "postTime": 1555569442,
        "uid": 15728,
        "name": "cy1999",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1919 \u3010\u3010\u6a21\u677f\u3011A*B Problem\u5347\u7ea7\u7248\uff08FFT\u5feb\u901f\u5085\u91cc\u53f6\uff09\u3011"
    },
    {
        "content": "\u8fd9\u9898\u8003\u4e86FFT\u7684\u6700\u7ecf\u5178\u7684\u4e00\u4e2a\u5e94\u7528\uff0cA\\*B\uff08\u4e24\u4e2a\u6570\u7684\u4f4d\u6570\u4e4b\u79ef\u8f83\u5927\uff09\n\n\u4e0d\u4f1aFFT\u7684\u53ef\u4ee5\u770b\u8fd9\u4e9b\u5730\u65b9\uff1a\n\n\u5168\u662f\u6284\u7684\uff1a\n[https://www.luogu.com.cn/blog/xukuan/fast-fast-tle](https://www.luogu.com.cn/blog/xukuan/fast-fast-tle)\n\n\u6bd4\u8f83\u6e05\u695a\u7684\uff1a\n[https://www.luogu.com.cn/blog/attack/solution-p3803](https://www.luogu.com.cn/blog/attack/solution-p3803)\n\n\u4ee5\u53ca\u300a\u7b97\u6cd5\u5bfc\u8bba\u300b\n\n\u6211\u4eec\u8ba4\u4e3a\u4f60\u4f1a\u4e86FFT\uff0c\u7136\u540e\u505a\u8fd9\u4e00\u9898\u3002\n\n\u8fd9\u9898\u662fFFT+\u8fdb\u4f4d\uff0c\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u4e58\u6cd5\u7ed3\u675f\u4e4b\u540e\u518d\u7edf\u4e00\u8ba1\u7b97\u5373\u53ef\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<cstring>\n#define ll long long\nusing namespace std;\n\nconst ll N=5000010;\nconst double pi=acos(-1);\nstring s;\nll n,m,limit,c[N];\nstruct complex{\n    double real,imag;\n    complex(double X=0,double Y=0){real=X; imag=Y;}\n}a[N],b[N];\ninline complex operator +(complex a,complex b){return complex(a.real+b.real,a.imag+b.imag);}\ninline complex operator -(complex a,complex b){return complex(a.real-b.real,a.imag-b.imag);}\ninline complex operator *(complex a,complex b){return complex(a.real*b.real-a.imag*b.imag,a.real*b.imag+a.imag*b.real);}\n\nvoid FFT(complex *a,ll op){\n    for(ll i=0; i<limit; i++){\n        if(i<c[i]) swap(a[i],a[c[i]]);\n    }\n    for(ll mid=1; mid<limit; mid<<=1){\n        complex W(cos(pi/mid),op*sin(pi/mid));\n        for(ll r=mid<<1,j=0; j<limit; j+=r){\n            complex w(1,0);\n            for(ll l=0; l<mid; l++,w=w*W){\n                complex x=a[j+l],y=w*a[j+mid+l];\n                a[j+l]=x+y; a[j+mid+l]=x-y;\n            }\n        }\n    }\n}\n\nint main(){\n    ios::sync_with_stdio(0); \n    cin>>s; n=s.size()-1;\n    for(ll i=0; i<=n; i++) a[n-i].real=s[i]-48;\n    cin>>s; m=s.size()-1;\n    for(ll i=0; i<=m; i++) b[m-i].real=s[i]-48;\n    limit=1; ll l=0;\n    while(limit<=n+m){\n        limit<<=1;\n        l++;\n    }\n    for(ll i=0; i<limit; i++) c[i]=(c[i>>1]>>1)|((i&1)<<(l-1));\n    FFT(a,1); FFT(b,1);\n    for(ll i=0; i<=limit; i++) a[i]=a[i]*b[i];\n    FFT(a,-1);\n    //\u4e0a\u9762\u90fd\u662fFFT\u677f\u5b50\uff0c\u4e0d\u89e3\u91ca\n    memset(c,0,sizeof(c));//c\u6570\u7ec4\u8981\u6e05\u96f6\uff0c\u56e0\u4e3a\u524d\u9762\u6709\u8d4b\u503c\n    for(ll i=0; i<=n+m+1; i++) c[i]=a[i].real/limit+0.5;//\u6a21\u4effFFT\u8f93\u51fa\u65f6\u8d4b\u503c\n    for(ll i=0; i<=n+m; i++){//\u8fdb\u4f4d\n    \tc[i+1]+=c[i]/10;\n\t\tc[i]%=10;\n\t}\n\tlimit=n+m+1;\n\twhile(c[limit]){//\u8fd8\u6709\u524d\u9762\u6ca1\u6709\u5904\u7406\u7684\n\t\tc[limit+1]+=c[limit]/10;\n\t\tc[limit]%=10;\n\t\tlimit++;\n\t}\n    for(ll i=limit-1; i>=0; i--) cout<<c[i];//\u8f93\u51fa\n    return 0;\n}\n```",
        "postTime": 1575854864,
        "uid": 27924,
        "name": "xukuan",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P1919 \u3010\u3010\u6a21\u677f\u3011A*B Problem\u5347\u7ea7\u7248\uff08FFT\u5feb\u901f\u5085\u91cc\u53f6\uff09\u3011"
    },
    {
        "content": "\\*100ms\n\n\u6ce8\u610f\u6700\u597d\u624b\u5199complex\uff0c\u4e0d\u7136\u4f1a t\n\n\n\u6838\u5fc3\u5728\u4e8e \u7cfb\u6570 - >\u70b9\u503c- > \u7cfb\u6570\n\n\u7136\u540e\u5176\u4ed6\u5c31\u662f\u5728\u4ee3\u7801\u91cc\u9762\u7684\u52a0\u901f\uff0c\u5c31\u662f\u5229\u7528\u8774\u8776\u53d8\u6362\u5b9e\u73b0\u8fed\u4ee3\u7248\u3002\n\n\n\u53e6\u5916\u6ce8\u610f\u53bb\u6389\u524d\u5bfc\u96f6\n\n\n\u5982\u679c\u662ffft(a,1)\u76f8\u5f53\u4e8e\u4ece\u7cfb\u6570\u8f6c\u4e3a\u70b9\u503c\n\n\n\u5982\u679c\u662ffft(b,-1)\u76f8\u5f53\u4e8e\u4ece\u70b9\u503c\u8f6c\u4e3a\u7cfb\u6570\n\n\n[\u6211\u7684\u5b66\u4e60\u7b14\u8bb0](http://tgotp.science/fft%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/)\n\nc++\u4ee3\u7801\u5982\u4e0b\uff1a\n\n\n    \n\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<cstdlib>\n#define pi acos(-1)\n#define rep(i,x,y) for(register int i = x; i <= y;++i)\nusing namespace std;\nconst int N = 3e5;\nstruct cpx\n{\n    double r,i;\n    cpx(){ }\n    cpx(double x, double y) { r = x;i = y; }\n    inline cpx operator *(const cpx&x)const{\n        return cpx(r*x.r - i*x.i,r*x.i + i*x.r );\n    }\n    inline cpx operator *=(const cpx&x){\n        *this = *this * x;\n    }\n    inline cpx operator +(const cpx&x)const{\n        return cpx(r + x.r,i + x.i);\n    }\n    inline cpx operator -(const cpx&x)const{\n        return cpx(r - x.r,i - x.i);\n    }\n}a[N],b[N];\nint n,L,R[N],c[N];\nchar ch[N];\ninline int read()\n{\n    int x = 0; char c;int sign = 1;\n    do { c = getchar();if(c == '-') sign = -1; }while(c < '0' || c > '9');\n    do { x = x*10 + c - '0';c = getchar(); }while(c <= '9' && c >= '0');\n    x *= sign;\n    return x;\n}\ninline void fft(cpx*a,int f)\n{\n    rep(i,0,n-1) if(i < R[i]) swap(a[i],a[R[i]]);\n    for(register int i = 1;i < n;i <<= 1) {\n        cpx wn(cos(pi/i),f*sin(pi/i));\n        for(register int j = 0;j < n;j += (i<<1)) {\n            cpx w(1,0);\n            for(register int k = 0;k < i;++k,w *= wn) {\n                cpx x = a[j + k],y = w * a[j + k + i];\n                a[j + k] = x + y; a[j + k + i] = x - y;\n            }\n        }\n    }\n    if(f == -1) rep(i,0,n - 1) a[i].r /= n;\n}\nint main()\n{\n    n = read();n--;\n    scanf(\"%s\",ch);\n    rep(i,0,n) a[i].r = ch[n-i] - '0';\n    scanf(\"%s\",ch);\n    rep(i,0,n) b[i].r = ch[n-i] - '0';\n    int m = 2*n; for(n = 1;n <= m ;n <<= 1) ++L;\n    rep(i,0,n-1) R[i] = (R[i>>1]>>1)|((i&1)<<(L-1));\n    fft(a,1);fft(b,1);\n    rep(i,0,n) a[i] *= b[i];\n    fft(a,-1);\n    rep(i,0,m) c[i] = (int)(a[i].r + 0.1);\n    rep(i,0,m)\n        if(c[i] >= 10)\n        {\n            c[i+1] += c[i] / 10,c[i] %= 10;\n            if(i == m) m++;\n        }\n    while(m) if(c[m]) break; else m--;\n    while(~m) printf(\"%d\",c[m--]);\n    return 0;\n}\n```",
        "postTime": 1503572571,
        "uid": 23087,
        "name": "Tgotp",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P1919 \u3010\u3010\u6a21\u677f\u3011A*B Problem\u5347\u7ea7\u7248\uff08FFT\u5feb\u901f\u5085\u91cc\u53f6\uff09\u3011"
    },
    {
        "content": ">\u5176\u5b9e\u5c31\u662f\u4e00\u4e2a\u5f88\u88f8\u7684FFT\u95ee\u9898\uff0c\u628a\u6bcf\u4e00\u4f4d\u770b\u4f5c\u591a\u9879\u5f0f\u7684\u4e00\u4e2a\u7cfb\u6570\n> \u6700\u540e\u518d\u8fdb\u884c\u8fdb\u4f4d\u64cd\u4f5c\uff0c\u6ce8\u610f\u53bb\u6574+0.5\n## \u611f\u8c22Kirin\u7684\u8be6\u7ec6\u6307\u5bfc\n\n[zky\u795e\u7287\u7684blog\u5199\u7684\u5f88\u597d](http://blog.csdn.net/iamzky/article/details/22712347)\n\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\n#include<cstring>\n#define MAXN 300004\nusing namespace std;\n\nint logn,DP[MAXN],ttt;\nconst double PI=4*atan(1.0);\nint n;\n\nstruct C{\n    double R,I;\n    C(double _R=0,double _I=0):\n        R(_R),I(_I){}\n    C operator + (C x){return C(R+x.R,I+x.I);}\n    C operator - (C x){return C(R-x.R,I-x.I);}\n    C operator * (C x){return C(R*x.R-I*x.I,R*x.I+I*x.R);}\n};\n\nstruct BIGNUM{\n    C num[MAXN];\n    int len;\n    BIGNUM(){\n        int i;\n        for(i=0;i<(MAXN-10);i++)\n            num[i]=C(0,0);\n        len=0;\n    }\n};\n\nvoid DEBUG(const BIGNUM &x){\n    int i;\n    printf(\"len : %d\\n\",x.len);\n    for(i=x.len-1;i>=0;i--)\n        printf(\"%d\",(int)(x.num[i].R));\n}\n\nvoid SWAP(C &x,C &y){\n    C t=x;x=y;y=t;\n}\n\nvoid FFT(C *A,int type){\n    int i,j,k;\n    for(i=0;i<ttt;i++)\n        if(i<DP[i])\n            SWAP(A[i],A[DP[i]]);\n    for(i=1;i<ttt;i<<=1){\n        C Wn(cos(PI/i),type*sin(PI/i));\n        int P=i<<1;\n        for(j=0;j<ttt;j+=P){\n            C Wk(1,0);\n            for(k=0;k<i;k++,Wk=Wk*Wn){\n                C x=A[j+k],y=Wk*A[j+i+k];\n                A[j+k]=x+y;A[j+i+k]=x-y;\n            }\n        }\n    }\n    if(type==-1)\n        for(i=0;i<ttt;i++)\n            A[i].R/=ttt;\n}\n\nBIGNUM a,b;\n\nchar tmp[MAXN];\n\nBIGNUM Read(){\n    BIGNUM re;\n    scanf(\"%s\",tmp+1);\n    int len=strlen(tmp+1);\n    int i;\n    re.len=n+1;\n    int tot=0;\n    for(i=n;i>=1;i--)\n        re.num[tot++].R=tmp[i]-'0';\n    for(;re.num[re.len-1].R==0;re.len--);\n    return re;\n}\n\nvoid PRE(){\n    int n=a.len+b.len-2;int i;\n    for(ttt=1;ttt<n;ttt<<=1)\n        logn++;\n    for(i=1;i<=ttt;i++)\n        DP[i]=((DP[i>>1]>>1)|((i&1)<<(logn-1)));\n}\n\nBIGNUM mul(BIGNUM x,BIGNUM y){\n    FFT(x.num,1);FFT(y.num,1);\n    int i;\n    BIGNUM Re;\n    for(i=0;i<=ttt;i++){\n        Re.num[i]=x.num[i]*y.num[i];\n    }\n    FFT(Re.num,-1);\n    for(i=0;i<=MAXN-20;i++){\n        Re.num[i+1].R+=(int)(Re.num[i].R+0.5)/10;\n        Re.num[i].R=(int)(Re.num[i].R+0.5)%10;\n    }\n    int pos;\n    for(i=MAXN-20;i>=0;i--){\n        if(Re.num[i].R!=0){\n            pos=i;\n            break;\n        }\n    }\n    Re.len=pos+1;\n    if(i==0)\n        Re.len=1;\n    return Re;\n}\n\nvoid PRINT(const BIGNUM &x){\n    int i;\n    for(i=x.len-1;i>=0;i--)\n        printf(\"%c\",(int)(x.num[i].R)+'0');\n    printf(\"\\n\");\n}\n\nint main(){\n    scanf(\"%d\",&n);\n    a=Read();\n    b=Read();\n    PRE();\n    BIGNUM ans=mul(a,b);\n    PRINT(ans);\n    return 0;\n}\n```",
        "postTime": 1494476964,
        "uid": 34848,
        "name": "zzzc18",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1919 \u3010\u3010\u6a21\u677f\u3011A*B Problem\u5347\u7ea7\u7248\uff08FFT\u5feb\u901f\u5085\u91cc\u53f6\uff09\u3011"
    },
    {
        "content": "\nFFT \u677f\u5b50\u3002\u3002\u3002\n\n\u6ce8\u610f:\n\n1.\u6700\u597d\u624b\u5199\uff0c\u4e0d\u7136\u4f1a TLE\n\n2.FFT \u6b63\u786e\u98df\u7528\u59ff\u52bf\uff1a\u7cfb\u6570 - >\u70b9\u503c- > \u7cfb\u6570\n\n\u5373\uff1a(1)\u5982\u679c\u662ffft(a,1)\u76f8\u5f53\u4e8e\u4ece\u7cfb\u6570\u8f6c\u4e3a\u70b9\u503c\n\n(2)\u5982\u679c\u662ffft(b,-1)\u76f8\u5f53\u4e8e\u4ece\u70b9\u503c\u8f6c\u4e3a\u7cfb\u6570\n\n3.\u5229\u7528\u8774\u8776\u53d8\u6362\u5b9e\u73b0\u8fed\u4ee3\u7248\uff0c\u5728\u4ee3\u7801\u91cc\u9762\u7684\u52a0\u901f\u3002\u3002\u3002\n\n4.\u53bb\u6389\u524d\u5bfc\u96f6\u3002\u3002\u3002\n\n\n\u770b\u4ee3\u7801\u5427\uff08\u867d\u4e11\uff09\uff1a\n\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<stdio.h>\n#include<math.h>\n#include<cmath>\n#define N (1<<18)//\u5982\u679c\u4e0d\u4ecb\u610f\uff0c\u53ef\u4ee5\u5f00\u5c0f\u70b9\nusing namespace std;\nstruct cmpx{//\u4e0d\u4e00\u6837\u7684\u7ed3\u6784\u4f53\uff0c\u8fd0\u7b97\u7b26\u91cd\u8f7d\n    double r,i;\n    cmpx operator + (const cmpx &a)const{return (cmpx){r+a.r,i+a.i};}\n    cmpx operator - (const cmpx &a)const{return (cmpx){r-a.r,i-a.i};}\n    cmpx operator * (const cmpx &a)const{return (cmpx){r*a.r-i*a.i,r*a.i+i*a.r};}\n};\nint rev[N];\ncmpx A[N],a[N],b[N],c[N];\nint L,n;\nvoid DFT(cmpx a[],int f){\n     int i,j,k;\n     for(i=0;i<L;i++)\n     A[i]=a[rev[i]];\n     for(i=0;i<L;i++)\n     a[i]=A[i];\n     for(i=2;i<=L;i<<=1){\n                         cmpx wi=(cmpx){cos(2.0*M_PI/i),f*sin(2.0*M_PI/i)};\n                         for(k=0;k<L;k+=i){\n                                           cmpx w=(cmpx){1.0,0.0},x,y;\n                                           for(j=0;j<i/2;j++){\n                                                              x=a[k+j];\n                                                              y=w*a[k+j+i/2];\n                                                              a[k+j]=x+y;\n                                                              a[k+j+i/2]=x-y;\n                                                              w=w*wi;\n                                                              }\n                                           }\n                         }\n  if(f==-1)\n  for(i=0;i<L;i++)\n  a[i].r/=L;\n}\nvoid FFT(cmpx a[],cmpx b[],cmpx c[]){\n     int i;\n     DFT(a,1);\n     DFT(b,1);\n     for(i=0;i<L;i++)\n     c[i]=a[i]*b[i];\n     DFT(c,-1);\n}\nvoid init(int tmp){\n     int i,t,j;\n     for(n=0,L=1;L<tmp;L<<=1)\n     n++;\n     n++;\n     L<<=1;\n     for(i=0;i<L;i++)\n     for(t=i,j=0;j<n;j++){\n         rev[i]<<=1;\n         rev[i]|=t&1;\n         t>>=1;\n         }\n}\nint ans[N];\nvoid DSC(){//\u5f00\u59cb\u5904\u7406\u95ee\u9898\uff0c\u5f00\u59cb\u5904\u7406\u95ee\u9898\uff0c\u5f00\u59cb\u5904\u7406\u95ee\u9898\uff0c\u91cd\u8981\u7684\u4e8b\u60c5\u8bf43\u904d\uff01\n     int l1=0,l2=0,i;\n     char ch=getchar();\n     while(ch>'9'||ch<'0')\n     ch=getchar();\n     while(ch>='0'&&ch<='9'){\n                             a[l1].r=ch-'0';\n                             a[l1++].i=0.0;\n                             ch=getchar();\n                             }\n     while(ch>'9'||ch<'0')\n     ch=getchar();\n     while(ch>='0'&&ch<='9'){\n                             b[l2].r=ch-'0';\n                             b[l2++].i=0.0;\n                             ch=getchar();\n                             }\n    reverse(a,a+l1);\n    reverse(b,b+l2);\n    init(max(l1,l2));\n    FFT(a,b,c);\n    for(i=0;i<L;i++)\n    ans[i]=(int)(c[i].r+0.5);\n    for(i=0;i<L;i++){\n                     ans[i+1]+=ans[i]/10;\n                     ans[i]%=10;\n                     }\n    L=l1+l2+1;\n    while(!ans[L]&&L>0)\n    L--;\n    for(i=L;~i;i--)\n    putchar(ans[i]+'0');\n    putchar('\\n');\n}\nint main(){//\u4e3b\u51fd\u6570so easy\n    DSC();\n    return 0;\n}\n\n```",
        "postTime": 1508558122,
        "uid": 49998,
        "name": "\u65af\u5fb7\u54e5\u5c14\u6469",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P1919 \u3010\u3010\u6a21\u677f\u3011A*B Problem\u5347\u7ea7\u7248\uff08FFT\u5feb\u901f\u5085\u91cc\u53f6\uff09\u3011"
    }
]
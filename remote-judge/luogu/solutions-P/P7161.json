[
    {
        "content": "# \u58f9\u3001[\u9898\u76ee\u63cf\u8ff0](https://hsin.hr/coci/contest2_tasks.pdf) &para;\n\n\u5b9a\u4e49\u51fd\u6570\n$$\nR(a,b)=\n\\begin{cases}\nR(b,a) &a<b \\\\\nR(\\lfloor{a\\over b}\\rfloor,b)&a\\ge b>1 \\\\\na&b=1\n\\end{cases}\n$$\n\u7ed9\u5b9a $g,h$\uff0c\u8bf7\u627e\u5230 $a,b$ \u4f7f\u5f97 $\\gcd(a,b)=g\u2227R(a,b)=h$. \u4fdd\u8bc1 $g,h\\le 200000$\uff0c\u53ef\u4ee5\u8bc1\u660e\uff0c\u5b58\u5728 $a,b\\le 10^{18}$ \u7684\u89e3\u3002\n\n# \u8d30\u3001[\u9898\u89e3](https://www.cnblogs.com/Arextre/p/14903404.html) &para;\n\n\u663e\u7136\u4e00\u9053\u6784\u9020\u9898\uff0c\u4f46\u662f\u633a\u96be\u60f3\u5230\u3002\u4e0b\u9762\u6211\u4eec\u4e0d\u59a8\u5047\u8bbe $a\\ge b$.\n\n\u9996\u5148\u60f3\u5230\u7684\u5c31\u662f\u53bb\u8003\u5bdf $R$ \u7684\u6027\u8d28\uff0c\u5982\u679c\u4f60\u6253\u8868\uff0c\u4f60\u4f1a\u53d1\u73b0......\u4e0d\uff0c\u4f60\u4ec0\u4e48\u90fd\u53d1\u73b0\u4e0d\u4e86\u3002\n\n\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u5229\u7528**\u4eba\u7c7b\u667a\u6167**\uff0c\u9996\u5148\u4e00\u5b9a\u6709 $R(h,h^k)=h$\uff0c\u66f4\u4e00\u822c\u5730\uff0c\u6709 $R(h,h^k+r)=h$\uff0c\u6211\u4eec\u53ea\u9700\u8981\u4fdd\u8bc1 $r<h^k$ \u5373\u53ef\u3002\n\n\u4e5f\u5373\uff0c\u6709 $R(h,x)=h\\Big(x\\in [h^k,2h^k)\\Big)$\uff0c\u5982\u679c\u6211\u4eec\u4e0d\u8003\u8651 $\\gcd$ \u7684\u9650\u5236\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u6784\u9020 $a=h^k,b=h$\uff0c\u4f46\u662f\u50cf\u8fd9\u6837\u7531\u4e00\u8fb9\u9664\u5230\u5c3d\u5934\uff0c\u6211\u4eec\u59cb\u7ec8\u9700\u8981\u5f3a\u5236\u8ba9\u4e00\u8fb9\u4e3a $h$\uff0c\u5982 $b=h$\uff0c\u800c\u6b64\u65f6\u6211\u4eec\u662f\u4e07\u822c\u4e0d\u80fd\u8ba9 $\\gcd(a,b)=g$ \u7684\uff08\u9664\u4e86\u53ef\u80fd\u5b58\u5728\u7684\u4e00\u4e9b\u7279\u6b8a\u60c5\u51b5\uff09\u3002\u6240\u4ee5\uff0c\u8fd9\u79cd \u201c\u4e00\u8fb9\u9664\u5230\u5e95\u201d \u597d\u662f\u597d\uff0c\u4f46\u662f\u4e0d\u80fd\u6ee1\u8db3\u6240\u6709\u6761\u4ef6\u3002\n\n\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u8003\u8651\uff0c\u5f53 $a/b$ \u5b8c\u4e4b\u540e\uff0c\u5f97\u5230 $a'=h$\uff0c\u7136\u540e\u6211\u4eec\u9762\u5bf9\u7684\u662f $R(a',b)=R(h,b)$\uff0c\u7136\u540e\u7528 $h$ \u5c06 $b$ \u9664\u6210 $1$\uff0c\u8fd9\u4e2a\u65f6\u5019\uff0c$a=h\\times b^j+r(r<b^j)$\uff0c\u4e14 $b\\in[h^k,2h^k)$\uff0c\u5e76\u4e14\u5f97\u6784\u9020\u51fa $\\gcd(a,b)=g$.\n\n\u6839\u636e\u8f97\u8f6c\u76f8\u9664\u6cd5\uff0c\u6211\u4eec\u6709\n$$\n\\gcd(a,b)=g \n\\Rightarrow gcd(h\\times b^j+r,b)=\\gcd(r,b)=g\n$$\n\u5982\u679c\u8bbe $b=gh$\uff0c\u8003\u8651\u6700\u7b80\u5355\u7684\u60c5\u51b5\uff0c$r=g\u2227j=1\\Rightarrow a=h^2g+g=g(h^2+1)$\uff0c\u6211\u4eec\u4e00\u5b9a\u80fd\u591f\u4fdd\u8bc1 $\\gcd(h,h^2+1)=1$\uff0c\u8fd9\u6837\u4f3c\u4e4e\u5408\u6cd5\uff1f\n\n\u7136\u540e\uff0c\u4f60\u4f1a\u53d1\u73b0\u4f60\u9519\u4e86\uff0c\u4e3e\u4e2a\u6817\u5b50\uff1a\u5f53 $g=2,h=3$ \u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u51fa $a=20,b=6$\uff0c\u4f46\u662f $R(20,6)=2$\uff0c\u90a3\u4e48\u95ee\u9898\u51fa\u5728\u54ea\u91cc\uff1f\u6211\u4eec\u8fd8\u6709\u4e2a\u524d\u63d0\u6761\u4ef6\u662f $gh\\in [h^k,2h^k)\\Rightarrow g\\in[h^{k-1},2h^{k-1})$\uff0c\u5f97\u4fdd\u8bc1\u8fd9\u4e2a\uff0c\u6211\u4eec\u624d\u80fd\u6784\u9020\u51fa\u6b63\u786e\u7684\u7b54\u6848\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c $g$ \u7ed9\u5f97\u4e0d\u591f\u597d\uff0c\u5c31\u6ca1\u6709\u7b54\u6848\u54af\uff1f\u90a3\u4e3a\u4ec0\u4e48\u9898\u76ee \u201c\u53ef\u4ee5\u8bc1\u660e\u201d \u5b58\u5728 $a,b\\le 10^{18}$\uff1f\u4e8b\u5b9e\u4e0a\uff0c$b=gh$ \u53ea\u662f\u6211\u731c\u6d4b\u7684\u5176\u4e2d\u4e00\u79cd\u60c5\u51b5\uff0c$b$ \u4e0d\u4e00\u5b9a\u4e00\u5b9a\u5c31\u662f $gh$\uff0c\u6211\u4eec\u53ef\u4ee5\u8bb0 $b=gi$\uff0c\u4fdd\u8bc1 $b=gi\\in [h^k,2h^k)$ \u5373\u53ef\uff0c\u5373\uff0c$g\\in\\left[{h^k\\over i},{2h^k\\over i}\\right)$ \u5373\u53ef\u3002\n\n\u81f3\u4e8e\u5982\u4f55\u627e\u5230\u8fd9\u4e2a $i$\uff0c\u7531\u4e8e\u6211\u4eec\u6709\n$$\nh^k\\le gi<2h^k\n\\Rightarrow {h^k\\over g}\\le i<{2h^k\\over g}\n$$\n\u56e0\u4e3a\u8fd9\u4e2a $i$ \u662f\u4e2a\u6574\u6570\uff0c\u6211\u4eec\u53ea\u9700\u8981\u627e\u5230\u4e00\u4e2a $k$\uff0c\u6ee1\u8db3\u533a\u95f4 $\\left[{h^k\\over g},{2h^k\\over g}\\right)$ \u5305\u542b**\u81f3\u5c11\u4e00\u4e2a\u6574\u6570**\u5373\u53ef\uff0c\u4e00\u4e2a\u4e00\u5b9a\u6ee1\u8db3\u6761\u4ef6\u7684\u4e0d\u7b49\u5f0f\u662f\n$$\n{h^k\\over g}+1<{2h^k\\over g}\n\\Rightarrow g<h^k\n$$\n\u53ea\u9700\u8981\u627e\u5230\u8fd9\u4e2a $k$ \u5c31\u53ef\u4ee5\u4e86\uff0c\u53d6 $i=\\left\\lceil{h^k\\over g}\\right\\rceil$\uff0c\u800c $a=h\\times b+g$.\n\n\u4f46\u662f\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u76f4\u63a5\u53d6 $i=\\left\\lceil{h^k\\over g}\\right\\rceil$ \u7684\u540c\u65f6\uff0c\u6211\u4eec\u4e00\u5b9a\u6709 $i>1$\uff0c\u56e0\u4e3a $g<h^k$\uff0c\u4f46\u662f\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u5fc5\u987b\u4fdd\u8bc1 $i>1$ \u5462\uff1f\u56e0\u4e3a\u6211\u4eec\u7684 $a=h\\times b^j+r(r<b^j)$\uff0c\u5728\u6b64\u6211\u4eec\u53d6 $j=1$\uff0c\u5219\u9700\u4fdd\u8bc1 $r=g<b=gi$\uff0c\u663e\u7136\uff0c\u5f53 $i=1$ \u65f6\u4e0d\u7b49\u5f0f\u4e0d\u6210\u7acb\uff0c\u4f46\u662f\u6211\u4eec\u53d6\u4e0a\u53d6\u6574\u4fdd\u8bc1\u4e86 $i>1$.\n\n\u603b\u590d\u6742\u5ea6 $\\mathcal O(T\\log_hg)$.\n\n>\u9898\u89e3\u8fc7\u4e8e\u7b80\u5355\uff0c\u76f4\u63a5\u7ed9\u51fa\u6784\u9020\u65b9\u6cd5\uff1a\n>$$\n>b=g\\left\\lceil{h^K\\over g}\\right\\rceil,a=hb+g\\quad(g<h^K)\n>$$\n>\u6211\u53ea\u80fd\u8bf4\uff0c\u8fd9\u4e2a\u6784\u9020\u65b9\u6cd5\u6ca1\u6709\u65f6\u95f4\u8fd8\u771f\u60f3\u4e0d\u5230\uff0c\u6216\u8bb8\u53ea\u6709 $\\sf SYDevil$ \u548c $\\sf OID$ \u53ef\u4ee5\u76f4\u63a5\u51fa\u5427\uff1f\n\n# \u53c1\u3001\u53c2\u8003\u4ee3\u7801 &para;\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<vector>\nusing namespace std;\n\n// #define NDEBUG\n#include<cassert>\n\nnamespace Elaina{\n    #define rep(i, l, r) for(int i=(l), i##_end_=(r); i<=i##_end_; ++i)\n    #define drep(i, l, r) for(int i=(l), i##_end_=(r); i>=i##_end_; --i)\n    #define fi first\n    #define se second\n    #define mp(a, b) make_pair(a, b)\n    #define Endl putchar('\\n')\n    #define mmset(a, b) memset(a, b, sizeof a)\n    // #define int long long\n    typedef long long ll;\n    typedef unsigned long long ull;\n    typedef pair<int, int> pii;\n    typedef pair<ll, ll> pll;\n    template<class T>inline T fab(T x){ return x<0? -x: x; }\n    template<class T>inline void getmin(T& x, const T rhs){ x=min(x, rhs); }\n    template<class T>inline void getmax(T& x, const T rhs){ x=max(x, rhs); }\n    template<class T>inline T readin(T x){\n        x=0; int f=0; char c;\n        while((c=getchar())<'0' || '9'<c) if(c=='-') f=1;\n        for(x=(c^48); '0'<=(c=getchar()) && c<='9'; x=(x<<1)+(x<<3)+(c^48));\n        return f? -x: x;\n    }\n    template<class T>inline void writc(T x, char s='\\n'){\n        static int fwri_sta[1005], fwri_ed=0;\n        if(x<0) putchar('-'), x=-x;\n        do fwri_sta[++fwri_ed]=x%10, x/=10; while(x);\n        while(putchar(fwri_sta[fwri_ed--]^48), fwri_ed);\n        putchar(s);\n    }\n}\nusing namespace Elaina;\n\null R(ull a, ull b){\n    if(a<b) return R(b, a);\n    if(b==1) return a;\n    return R(a/b, b);\n}\null gcd(ull a, ull b){ return b? gcd(b, a%b): a; }\n\null g, h, k, tmp, i, a, b;\n\nsigned main(){\n    freopen(\"euklid.in\", \"r\", stdin);\n    freopen(\"euklid.out\", \"w\", stdout);\n    rep(_, 1, readin(1)){\n        g=readin(1llu), h=readin(1llu);\n        tmp=1, k=0;\n        while(g>=tmp) ++k, tmp*=h;\n        // When x,y are integers the equation ceil(x/y)=(x+y-1)/y is established\n        i=(tmp+g-1)/g, b=g*i, a=h*b+g;\n        writc(a, ' '), writc(b);\n    }\n    return 0;\n}\n```\n",
        "postTime": 1624092702,
        "uid": 125355,
        "name": "Vladilena",
        "ccfLevel": 0,
        "title": "[COCI2020/2021]Euklid"
    },
    {
        "content": "# P7161 [COCI2020-2021#2] Euklid\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P7161)\n\n## \u524d\u8a00\n\u6ce8\uff1a\u611f\u8c22zps\u795e\u4ed9\u7684\u5e2e\u52a9QwQ\n\n[\u53ef\u80fd\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.luogu.com.cn/blog/haphyxlos/ti-xie-p7161-coci2020-20212-euklid)\n\n## Sol\n\n\u9996\u5148\uff0c\u6211\u4eec\u4e0d\u59a8\u5047\u8bbe\uff0c$x,y$ \u4e3a\u672c\u9898\u7b54\u6848\uff0c\u5373 $x=ag,y=bg$ \u3002\n\n$\\because\\gcd(x, y)=g$ \n\n\u90a3\u4e48\uff0c\u6211\u4eec\u628a $x,y$ \u90fd\u7ea6\u6389\u4e00\u4e2a $g$ \uff0c\u5c31\u5269\u4e0b\u4e86 $a,b$ \u3002\n\n$\\therefore \\gcd(a, b)=1$\n\n\u7531\u9898\u610f\uff0c $R(x,y)=h $ \n\n\u90a3\u4e48\uff0c\u6211\u4eec\u5728\u8fd9\u91cc\u5047\u8bbe $a<b$ \u3002\n\n\u6211\u4eec\u6839\u636e $R$ \u7684\u5b9a\u4e49\uff0c\u53ef\u4ee5\u5c06\u5b83\u53d8\u5f62\uff1a\n\n$R(x,y)=R(ag,bg)=R( \\left \\lfloor \\frac{bg}{ag}  \\right \\rfloor ,ag)=\nR( \\left \\lfloor \\frac{b}{a}  \\right \\rfloor ,ag)$\n\n\u53c8  $\\because R(x, y)=h$\n\n\u90a3\u4e48\uff0c\u6211\u4eec\u6839\u636e\u5b9a\u4e49\u9006\u63a8\uff0c\u53ef\u5f97\uff0c\u4e0a\u4e00\u6b21\u80af\u5b9a\u4e3a $R(h,1)$ \u3002\n\n\u518d\u4e0a\u4e00\u6b21\uff0c\u662f $R(h,x) $ \u4f7f\u5f97 $ \\left \\lfloor  \\frac{x}{h}  \\right \\rfloor =h$ \u3002\n\n\u90a3\u4e48\uff0c\u663e\u7136\u6b64\u65f6 $x\\in \\left [ h^{2} ,2h^{2} \\right ) $ \uff0c\u5373 $R(h,1)=R(h,\\left [ h^{2} ,2h^{2} \\right ))$ \u3002\n\n\u6613\u5f97\uff0c$R(h,1)=R(h,\\left [ h^{2} ,2h^{2} \\right ))=R(h,\\left [ h^{3} ,2h^{3} \\right ))=\\cdots =R(h,\\left [ h^{i} ,2h^{i} \\right ))$\n\n$\\therefore x\\in \\left [ h^{i} ,2h^{i} \\right ) $ \uff0c\u5373 $ag\\in \\left [ h^{i} ,2h^{i} \\right )$ \u3002\n\n\u53c8 $\\because$ \u6211\u4eec\u53d8\u5f62\u51fa\u6765\uff0c$R(x,y)=\nR( \\left \\lfloor \\frac{b}{a}  \\right \\rfloor ,ag)$ \u3002\n\n$ \\therefore $ \u7efc\u4e0a\u6240\u8ff0\uff0c$R(x,y)=\nR( \\left \\lfloor \\frac{b}{a}  \\right \\rfloor ,ag)$ \u4e14 $ag\\in \\left [ h^{i} ,2h^{i} \\right )$ \u3002\n\n\u90a3\u4e48\uff0c\u672c\u9898\u5c31\u597d\u505a\u4e86\uff0c\u6211\u4eec\u53ea\u8981\u5148\u628a $a$ \u786e\u5b9a\uff0c\u800c $a$ \u8981\u6ee1\u8db3  $ag\\in \\left [ h^{i} ,2h^{i} \\right )$ \uff0c\u8fd9\u4e2a\u957f\u5ea6\u7684\u8303\u56f4\u4e3a $h^{i}$ \u3002\n\n\u5982\u679c\uff0c\u6211\u4eec\u4ee4\u8303\u56f4\u7684\u957f\u5ea6\u5927\u4e8e $g$ \uff0c\u90a3\u4e48\u5c31\u4e00\u5b9a\u6709\u89e3\u4e86\u3002\uff08\u8fde\u7eed $g$ \u4e2a\u6570\u91cc\u4e00\u5b9a\u5b58\u5728 $g$ \u7684\u500d\u6570\uff0c\u663e\u7136\uff09\n\n\u7136\u540e\uff0c\u6211\u4eec\u53ea\u8981\u5148\u627e\u4e00\u4e2a $i$ \uff0c\u4f7f\u5f97 $h^{i}>g$ \uff0c\u7136\u540e\u5728\u91cc\u9762\u968f\u4fbf\u627e\u627e\u5c31\u80fd\u627e\u5230\u4e00\u4e2a $g$ \u7684\u500d\u6570\uff0c\u6211\u4eec\u628a\u8fd9\u4e2a $g$ \u7684\u500d\u6570\u9664\u4ee5 $g$ \u5c31\u53ef\u4ee5\u5f97\u5230 $a$ \u3002\n\n\u63a5\u7740\uff0c\u6211\u4eec\u628a $b$ \u786e\u5b9a\u3002\n\n$\\because \\left \\lfloor  \\frac{b}{a}  \\right \\rfloor =h$ \n\n$\\therefore b=ah+k , k \\in \\left [0 ,a \\right) $\n\n\u8bd5\u4e00\u904d\u5c31\u884c\u4e86\uff0c\u770b\u770b\u54ea\u4e2a\u4e92\u8d28\u3002\n\n\u4ee3\u7801\u5c31\u4e0d\u653e\u4e86\uff0c\u8bf7\u8bfb\u8005\u81ea\u884c\u5b8c\u6210\u5427\u3002\n\nzps\uff1a\u8fd9\u6570\u636e\u597d\u900a\u554a\uff0c\u5efa\u8bae\u51fa\u5230 $ 1\\le T \\le 10^{6} , 1 \\le g \\le 10^{9} ,2\\le h\\le 10^{9} $ \u3002",
        "postTime": 1616939976,
        "uid": 235801,
        "name": "\u89e6\u60c5\u79bb\u6b87",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 P7161 [COCI2020-2021#2] Euklid"
    },
    {
        "content": "[\u9898\u9762](https://www.luogu.com.cn/problem/P7161)\u3002\n\n\n\n#### \u601d\u8def\n\n\u9996\u5148 $\\gcd(a,b)=g$\uff0c\u90a3 $a,b$ \u80af\u5b9a\u90fd\u5f97\u662f $g$ \u7684\u500d\u6570\u3002\n\n\u8bbe $a=xg,b=yg$\uff0c$x<y$ \u4e14 $x$ \u4e0e $y$ \u4e92\u8d28\u3002\u6211\u4eec\u6c42\u51fa $x,y$ \u7684\u503c\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u9898\u76ee\u4e2d\u7684 $R$ \u662f\u4e2a\u65b0\u5b9a\u4e49\u7684\u51fd\u6570\uff0c\u90a3\u5c31\u5148\u6765\u7814\u7a76\u4e00\u4e0b\u5b83\u7684\u6027\u8d28\u3002\n\n\u6709 $R(i,j)=R(\\lfloor \\frac{j}{i}\\rfloor,i)$\u3002\n\n$R(a,b)=h$\uff0c\u90a3\u4e48\u9012\u5f52\u7684\u6700\u540e\u4e00\u5c42\u662f $R(h,1)$\u3002\n\n\u5012\u6570\u7b2c\u4e8c\u5c42\u5e94\u8be5\u662f $R([h,2h),h)$\uff0c\u518d\u5f80\u4e0a\u662f $R(h,[h^2,2h^2))$\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e\u4efb\u610f\u6b63\u6574\u6570 $i$\uff0c\u90fd\u6709 $R(h,[h^i,2h^i))=h$\u3002\n\n\u7ed3\u5408\u4ee5\u4e0a\u4e24\u70b9\uff1a$R(a,b)=R(xg,yg)=R(\\lfloor \\frac{y}{x}\\rfloor,xg)$\u3002\n\n\u6211\u4eec\u60f3\u5f97\u5230\u4e00\u4e2a\u6700\u5c0f\u7684\u53ef\u884c\u89e3\uff0c\u6240\u4ee5\u8003\u8651\u6700\u5c0f\u7684\u53ef\u884c $x$ \u600e\u4e48\u6c42\u3002\n\n$x \\in [\\lfloor \\frac{h^i}{g}\\rfloor , \\lfloor \\frac{2h^i}{g}\\rfloor)$\uff0c\u60f3\u8981\u6700\u5c0f\u89e3\uff0c\u90a3\u5c31\u8ba9 $x= \\lceil \\frac{k^i}{g} \\rceil$ \u5c31\u597d\u3002\n\n\u81f3\u4e8e $y$\uff0c\u5b83\u9700\u8981\u6ee1\u8db3 $\\lfloor \\frac{y}{x}\\rfloor=h$ \u4e14\u4e0e $x$ \u4e92\u8d28\u3002\u6ee1\u8db3\u6761\u4ef6\u7684 $y$ \u53ef\u4ee5\u662f $x\\times h+1$\u3002\n\n\u6ce8\u610f\uff1a$x$ \u4e0d\u80fd\u4e3a $1$\u3002\n\n#### \u4ee3\u7801\n\n```cpp\n#include <cstdio>\nlong long T,G,H,A,B;\nvoid solve(long long g,long long h)\n{\n\tlong long now=1;\n\twhile(now<=g)\n\t\tnow*=h;\n\tA=(now-1)/G+1;\n\tB=A*h+1;\n}\nint main()\n{\n\tscanf(\"%lld\",&T);\n\twhile(T--)\n\t{\n\t\tscanf(\"%lld%lld\",&G,&H);\n\t\tsolve(G,H);\n\t\tprintf(\"%lld %lld\\n\",A*G,B*G);\n\t}\n}\n```\n",
        "postTime": 1664640074,
        "uid": 291481,
        "name": "novax",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P7161 [COCI2020-2021#2] Euklid"
    },
    {
        "content": "## \u7b80\u8981\u9898\u610f \n\n\u6709\u51fd\u6570\n\n$R(a,b)= \\begin{cases} R(b,a) &a<b \\\\ R(\\lfloor{a\\over b}\\rfloor,b)&a\\ge b>1 \\\\ a&b=1 \\end{cases}$\n \n\u7ed9\u5b9a $g , h$\uff0c\u6c42 $a,b$\uff0c\u4f7f\u5f97 $g=\\gcd(a,b),h=R(a,b)$\uff0c\u4e14 $a,b \\le 10^{18}$\u3002\n\n## \u90e8\u5206\u5206\n\n#### \u5bf9\u4e8e $g=h$ \u90e8\u5206\n\n\u663e\u7136\u6709\n\n$\\gcd(g,g)=g,R(g,g)=R(\\lfloor{g\\over g}\\rfloor,g)=R(1,g)=g=h$\u3002\n\n\u7c7b\u4f3c\u7684\uff0c**\u5bf9\u4e8e $g=h^2$\uff0c** \u53ef\u4ee5\u63a8\u51fa $a=g^3,b=g^2$ \u65f6\u7b26\u5408\u9898\u610f\u3002\n\n#### \u5bf9\u4e8e $h=2$ \u90e8\u5206\uff1a\n\n\u6709 $\\forall i \\in \\mathbf{Z^+}, R(i,2)=2$\u3002\n\n\u8bc1\u660e\uff1a\u5bf9\u4e8e $i\\leq2$\uff0c$R(i,2)=2$\u3002\n\n\u5bf9\u4e8e $i \\geq 3$\uff0c$R(2,i)=R(2,\\lfloor{i\\over 2}\\rfloor)$\uff0c\u4e14 $i > \\lfloor{i\\over 2}\\rfloor$\u3002\n\n\u8981\u4fdd\u8bc1 $\\gcd(a,b)=g$\uff0c\u53ea\u9700\u4ee4 $a=g\\times 2,b=g$ \u5373\u53ef\u3002\n\n## \u6b63\u89e3\n\n**\u5148\u5047\u8bbe $h \\le g$\u3002**\n\n\u9996\u5148\u53ef\u4ee5\u770b\u51fa $\\gcd(ka,a)=\\gcd(a,a)=a , R(ka+t,a)=R(k,a)(0 \\le t <a)$\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff1a\u8bbe $b=gx,a=gxy+gt$  $(0\\le t < x)$\uff0c\n\u5219 $\\gcd(a,b)=\\gcd(c,b)=g,R(a,b)=R(c,b)$ $(c=gt)$\u3002\n\n\u800c\u53c8$h=2$\u90e8\u5206\u5206\u7684\u8bc1\u660e\u8fc7\u7a0b\u53ef\u4ee5\u63a8\u5e7f\u5f97\u51fa\uff1a\n\n$\\exists  x \\le n, R(x,n)=R(y,n) (y\\in \\mathbf{Z^+}) $\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u6784\u9020\u51fa $x \\le n$ \u7684\u6570\u636e\uff0c\u7136\u540e\u518d\u901a\u8fc7\u653e\u7f29\u4f7f $\\gcd(a,b)=g$ \u5373\u53ef\u3002\n\n\u8bbe $a=gx,b=gy$ $(\\gcd(x,y)=1,x\\ge y)$\u3002\n\n\u8003\u8651 $y=1$ \u65f6\u7684\u60c5\u51b5\uff1a$\\gcd(a,b)=g,R(a,b)=R(gx,g)=R(x,g)$\u3002\n\n\u8fd9\u65f6\u5019\u80af\u5b9a\u6709\u79cd\u60f3\u6cd5\uff1a\u66b4\u529b\u67e5\u627e\u7b26\u5408\u6761\u4ef6\u7684 $x$\uff0c\u6839\u636e\u4e0a\u9762\u7406\u8bba\u7684\u63a8\u5e7f\u548c\u51fd\u6570\u672c\u8eab\uff0c\u53ea\u9700 $O(40n\\log n)$ \u7684\u590d\u6742\u5ea6\u5373\u53ef\u89e3\u51b3\u3002\n\n\u4f46\u8fd9\u662f\u4e0d\u5bf9\u7684\uff0c\u6bd4\u5982 $n=10$ \u65f6,\u4e0d\u5b58\u5728 $x$ \u4f7f\u5f97 $R(x,n)=4$\u3002\n\u800c\u4e14\u627e\u51fa\u7b26\u5408\u6761\u4ef6\u7684 $x$ \u7684\u65f6\u95f4\u4e5f\u8fc7\u5927\uff0c\u4e0d\u4e00\u5b9a\u80fd\u8fc7\u9898\u3002\n\n\u4e8e\u662f\u8fd8\u6709\u4e00\u79cd\u731c\u60f3\uff1a\u82e5 $x$ \u7b26\u5408\u4e0a\u8ff0\u6761\u4ef6\uff0c$R(x,n)=x$ \u5fc5\u6210\u7acb\u3002\u4f46\u4e5f\u662f\u9519\u7684\uff0c\u6bd4\u5982 $n=100,x=7$\u3002\n\n\u90a3\u6211\u4eec\u9000\u800c\u6c42\u5176\u6b21\uff0c\u6765\u6c42 $R(x,n)=x$\u3002\n\n\u53ef\u4ee5\u901a\u8fc7\u591a\u79cd\u65b9\u5f0f\u5f97\u51fa $x$ \u7684\u6761\u4ef6\u662f $x^k \\le n < 2x^k$\u3002\u5176\u4e2d $x^k$ \u4e3a\u5c0f\u4e8e $n$ \u7684 $x$ \u7684\u6b21\u5e42\u6700\u5927\u503c\u3002\u611f\u6027\u7406\u89e3\u5c31\u662f\u5982\u679c\u591a\u51fa\u4e86\u4e2a$2$\u6700\u540e$R(x,n)$\u4f1a\u5316\u6210 $R(y,x)(1 <y \\le z)$\u3002\n\n\u90a3\u4e48\u5982\u679c\u7b26\u5408\u4e0a\u8ff0\u6761\u4ef6\uff0c\u5219 $x=h$\uff0c\u6240\u4ee5 $a=gx,b=g$\u3002\n\n**\u5982\u679c\u4e0d\u7b26\u5408\u5462\uff1f**\n\n\u90a3\u4e48\u5c31\u53bb\u627e $y$\uff0c\u4f7f $x^{k+1} \\le gy < 2x^{k+1}$\u3002\u56e0\u4e3a\u539f\u6765\u7684 $2x^k$ \u5df2\u7ecf\u6bd4 $g$ \u5c0f\u4e86\uff0c\u8fd9\u91cc\u53ef\u4ee5\u76f4\u63a5\u66b4\u529b\uff0c\u56e0\u4e3a\u53ea\u6709\u53ef\u80fd $k \\ge 2$ \u65f6\u624d\u4f1a\u4e0d\u7b26\u5408\uff0c\u6b64\u65f6\u7684 $x^{k+1}$ \u5927\u6982\u5728 $10^7$ \u5de6\u53f3\u3002\n\n\u63a5\u7740\u6309\u7167\u7b26\u5408\u7684\u65b9\u6cd5\u505a\u5373\u53ef\u3002\u6700\u540e\u5f97\u51fa $a=gxy,b=gy$\uff0c\u4e3a\u4fdd\u8bc1 $\\gcd$ \u7b49\u4e8e $g$ \u4ee4 $a=gxy+g$\u3002\n\n**\u63a5\u4e0b\u6765\u8ba8\u8bba $g \\le h$\u3002**\n\n\u76f4\u63a5\u5c06 $g$ \u6269\u5927\u5230 $ h \\le g$ \u7684\u8303\u56f4\u540e\u6309\u7167\u4e0a\u8ff0\u89e3\u6cd5\u505a\u5373\u53ef\uff0c\u6ce8\u610f\u6700\u540e\u7684 $a$ \u540c\u6837\u8981\u52a0\u4e2a $g$ \u6765\u4fdd\u8bc1 $\\gcd$ \u7b49\u4e8e $g$\u3002\n\n## \u4ee3\u7801\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nint main()\n{\n\tint t;long long g,h;\n\tscanf(\"%d\",&t);\n\twhile(t--)\n\t{\n\t\tscanf(\"%lld%lld\",&g,&h);\n\t\tif(g==h)printf(\"%lld %lld\\n\",g,g);\n\t\telse if(g==h*h)printf(\"%lld %lld\\n\",h*h*h,h*h);\n\t\telse if(h==2)printf(\"%lld %lld\\n\",g*2,g);//\u90e8\u5206\u5206\n\t\telse if(h<=g)//\u60c5\u51b51\uff1ah<=g\n\t\t{\n\t\t\tlong long H=h,G=g;\n\t\t\twhile(H<=g)H*=h;H/=h;\n\t\t\tif(H*2>g)//\u627e\u5230\u7b26\u5408\u7684x\n\t\t\t\tprintf(\"%lld %lld\\n\",h*g,g);\n\t\t\telse//\u6ca1\u627e\u5230\uff0c\u6269\u5927g\n\t\t\t{\n\t\t\t\tH*=h;\n\t\t\t\twhile(H*2>G)G+=g;G-=g;\n\t\t\t\tprintf(\"%lld %lld\\n\",h*G+g,G);\n\t\t\t}\n\t\t}\n\t\telse//\u51e0\u4e4e\u7167\u6284\u4e0a\u6587\n\t\t{\n\t\t\tlong long s=0;\n\t\t\twhile(h>=s)s+=g;s-=g;\n\t\t\tswap(s,g);//swap\u540es\u4e3a\u539f\u6765\u7684g\uff0cg\u4e3a\u6269\u5145\u7684g\n\t\t\tlong long H=h,G=g;\n\t\t\twhile(H<=g)H*=h;H/=h;\n\t\t\tif(H*2>g)\n\t\t\t\tprintf(\"%lld %lld\\n\",h*g+s,g);\n\t\t\telse\n\t\t\t{\n\t\t\t\tH*=h;\n\t\t\t\twhile(H*2>G)G+=g;G-=g;\n\t\t\t\tprintf(\"%lld %lld\\n\",h*G+s,G);\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1656738047,
        "uid": 220558,
        "name": "Doqe",
        "ccfLevel": 0,
        "title": "P7161 Euklid \u9898\u89e3"
    }
]
[
    {
        "content": "\n### Subtask 1\n\n\u6211\u4f1a\u5355\u8c03\u6808\uff01\n\n### Subtask 2\n\n\u6211\u4f1a\u7206\u641c\uff01\n\n### Subtask 3 & 4\n\n\u4e0d\u96be\u53d1\u73b0\u7531\u4e8e $n\\le 100$\uff0c\u6211\u4eec\u76f4\u63a5\u679a\u4e3e\u6bcf\u4e00\u4e2a\u53ef\u80fd\u7684\u5b50\u77e9\u9635\u7b97\u5b83\u5168\u662f Drag \u7684\u6982\u7387\u7136\u540e\u52a0\u8d77\u6765\u5373\u53ef\u3002\u5982\u679c\u8fd9\u4e2a\u77e9\u9635\u4e2d\u6709 Click \u6982\u7387\u5c31\u662f $0$\uff0c\u5426\u5219\u6982\u7387\u4e3a $\\dfrac 1{2^c}$\uff0c\u5176\u4e2d $c$ \u4e3a\u77e9\u9635\u4e2d `?` \u7684\u4e2a\u6570\u3002\n\n[mivik.h](https://mivik.gitee.io/mivik.h) / [\u4ee3\u7801](https://paste.ubuntu.com/p/Gyrm8FvMqQ/)\n",
        "postTime": 1618501922,
        "uid": 45182,
        "name": "Mivik",
        "ccfLevel": 9,
        "title": "[Mivik Round / Secret Sky] [\u9898\u89e3] Cytoid"
    },
    {
        "content": "\u5148\u8003\u8651\u8fd9\u6837\u4e00\u4e2a\u95ee\u9898\uff1a\u5bf9\u4e8e\u4e00\u4e2a 0/1 \u77e9\u5f62\uff0c\u8981\u6c42\u5176\u5168 0 \u5b50\u77e9\u5f62\u7684\u6570\u91cf\u3002\n\n\u8fd9\u4e2a\u53ef\u4ee5\u5148\u679a\u4e3e \u77e9\u5f62\u53f3\u4e0b\u89d2\uff0c\u518d\u679a\u4e3e\u5de6\u4e0b\u89d2\uff08\u6216\u8005\u8bf4\uff0c\u679a\u4e3e\u77e9\u5f62\u7684\u6a2a\u957f\u5ea6\uff09\uff0c\u5feb\u901f\u8f6c\u79fb\u51fa\u5168 0 \u5b50\u77e9\u5f62\u7684\u6700\u5927\u9ad8\u5ea6\uff08\u8fd9\u4e2a\u53ef\u4ee5\u76f4\u63a5\u4ece\u4e0a\u4e00\u884c\u8f6c\u79fb\u8fc7\u6765\uff09\uff0c\u505a\u5230 $O(n^3)$\u3002\n\n\u8fd9\u9898\u4e5f\u7c7b\u4f3c\uff0c\u53ea\u662f\u8ba1\u7b97\u7684\u662f\u671f\u671b\u9ad8\u5ea6\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3)$\uff08\u4f3c\u4e4e\u5f88\u591a\u4eba\u5199\u7684\u662f $O(n^4)$\uff1f\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\ntypedef long long ll;\nchar In[1 << 20], *ss = In, *tt = In;\n#define getchar() (ss == tt && (tt = (ss = In) + fread(In, 1, 1 << 20, stdin), ss == tt) ? EOF : *ss++)\nll read() {\n\tll x = 0, f = 1; char ch = getchar();\n\tfor(; ch < '0' || ch > '9'; ch = getchar()) if(ch == '-') f = -1;\n\tfor(; ch >= '0' && ch <= '9'; ch = getchar()) x = x * 10 + int(ch - '0');\n\treturn x * f;\n}\nint readox() {\n\tchar ch = getchar();\n\tfor(; ch != 'o' && ch != 'x' && ch != '?'; ch = getchar());\n\treturn ch == 'o' ? 0 : (ch == 'x' ? 1 : 2);\n}\nconst int P = 998244353, MAXN = 105;\nint pls(int a, int b) {return a + b < P ? a + b : a + b - P;}\nint mns(int a, int b) {return a < b ? a + P - b : a - b;}\nint mul(int a, int b) {return 1ll * a * b % P;}\nint qpow(int a, int n=P-2) {int ret = 1; for(; n; n >>= 1, a = mul(a, a)) if(n & 1) ret = mul(ret, a); return ret;}\nint n, m, bo[MAXN][MAXN], he[MAXN][MAXN][MAXN], cnt[MAXN][MAXN][3], inv2k[MAXN], ans;\nint main() {\n\tn = read(); m = read();\n\tfor(int i = 1; i <= n; i++)\n\t\tfor(int j = 1; j <= m; j++)\n\t\t\tbo[i][j] = readox();\n\tfor(int i = 1; i <= n; i++) {\n\t\tfor(int k = 0; k <= 2; k++) cnt[i][0][k] = 0;\n\t\tfor(int j = 1; j <= m; j++)\n\t\t\tfor(int k = 0; k <= 2; k++)\n\t\t\t\tcnt[i][j][k] += cnt[i][j-1][k] + (bo[i][j] == k);\n\t}\n\tinv2k[0] = 1; inv2k[1] = 499122177;\n\tfor(int i = 2; i <= n; i++) inv2k[i] = mul(inv2k[i-1], inv2k[1]);\n\tfor(int i = 1; i <= n; i++) \n\t\tfor(int j = 1; j <= m; j++) {\n\t\t\tfor(int k = j; k >= 1; k--) {\n\t\t\t\tif(cnt[i][j][1] - cnt[i][k-1][1] > 0) break;\n\t\t\t\tint t = cnt[i][j][2] - cnt[i][k-1][2];\n\t\t\t\the[i][j][k] = mul(inv2k[t], he[i-1][j][k] + 1);\n\t\t\t\tans = pls(ans, he[i][j][k]);\n\t\t\t}\n\t\t}\n\t/*\n\tfor(int i = 1; i <= n; i++)\n\t\tfor(int j = 1; j <= m; j++)\n\t\t\tfor(int k = j; k >= 1; k--)\n\t\t\t\tprintf(\"(%d, %d, %d): %d\\n\", i, j, k, he[i][j][k]);\n\t\t\t\t*/\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n\n```",
        "postTime": 1619336926,
        "uid": 73032,
        "name": "\u65e5\u5c45\u6708\u8bf8",
        "ccfLevel": 8,
        "title": "P7523 Cytoid \u9898\u89e3"
    },
    {
        "content": "\u7b97\u6cd5\uff1a\u4e8c\u7ef4\u524d\u7f00\u548c\n\n\u6570\u5b66\uff1a\u9006\u5143\uff0c\u671f\u671b\n\n\u6570\u636e\u8303\u56f4\u8f83\u5c0f\uff0c\u8003\u8651\u679a\u4e3e\u6bcf\u4e2a\u5b50\u77e9\u9635\uff0c\u8ba1\u7b97\u6bcf\u4e2a\u5b50\u77e9\u9635\u5bf9\u7b80\u5355\u5ea6\u7684\u8d21\u732e\u3002\n\n\u4f9d\u9898\u610f\u53ef\u5f97\uff0c\u5982\u679c\u5b50\u77e9\u9635\u4e2d\u5168\u90fd\u662f Drag\uff0c\u8fd9\u4e2a\u5b50\u77e9\u9635\u5c31\u4f1a\u5bf9\u7b54\u6848\u4ea7\u751f 1 \u7684\u8d21\u732e\u3002\n\n\u90a3\u4e48\u5982\u4f55\u8ba1\u7b97\u5b50\u77e9\u9635\u7684\u671f\u671b\u8d21\u732e\u5462\uff1f\u5982\u679c\u5b50\u77e9\u9635\u4e2d\u672c\u8eab\u6709 `x`\uff0c\u5219\u8fd9\u4e2a\u5b50\u77e9\u9635\u4e00\u5b9a\u4e0d\u80fd\u4ea7\u751f\u8d21\u732e\uff1b\u5982\u679c\u6ca1\u6709 `x` \u800c\u6709 $t$ \u4e2a `?`\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5b50\u77e9\u9635\u5c06\u6709 $\\frac1{2^t}$ \u7684\u6982\u7387\u5168\u90fd\u662f Drag\uff0c\u4e8e\u662f\u8be5\u5b50\u77e9\u9635\u7684\u671f\u671b\u8d21\u732e\u5c31\u662f $\\frac1{2^t}$\u3002\n\n\u7531\u4e8e\u671f\u671b\u7684\u53ef\u52a0\u6027\uff0c\u628a\u6240\u6709\u5b50\u77e9\u9635\u7684\u8d21\u732e\u52a0\u8d77\u6765\u5373\u4e3a\u7b54\u6848\u3002\n\n\u5177\u4f53\u5b9e\u73b0\uff1a\u4f7f\u7528\u4e8c\u7ef4\u524d\u7f00\u548c\uff0c\u53ef\u4ee5 $O(1)$ \u6c42\u4e00\u4e2a\u5b50\u77e9\u9635\u662f\u5426\u6709 `x` \u4ee5\u53ca\u6709\u591a\u5c11\u4e2a `?`\u3002\u9884\u5904\u7406\u6240\u6709 $\\frac1{2^i}\\mod998244353$ \u7684\u503c\uff0c\u53ef\u4ee5\u7701\u53bb\u4e00\u4e2a $\\log$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n^4)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $\\Theta(n^2)$\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#define ll long long\n\nconst ll MOD = 998244353;\nconst ll _2 = (MOD+1)/2;\n\nusing namespace std;\n\nint click[110][110];\nint wen[110][110];\nll pow2[12100];\nint n, m;\nll res;\n\nbool Cube(int x1, int x2, int y1, int y2) {\n  return click[x2][y2]-click[x1][y2]-click[x2][y1]+click[x1][y1];\n}\n\nll Count(int x1, int x2, int y1, int y2) {\n  //cout << x1 << ',' << x2 << ',' << y1 << ',' << y2 << endl;\n  return pow2[wen[x2][y2]-wen[x1][y2]-wen[x2][y1]+wen[x1][y1]];\n}\n\nint main() {\n  freopen(\"P7523.in\", \"r\", stdin);\n  scanf(\"%d%d\", &n, &m);\n  char c;\n  for (int i = 1; i <= n; i++) {\n    for (int j = 1; j <= m; j++) {\n      do {\n\tc = getchar();\n      } while (c!='o'&&c!='x'&&c!='?');\n      switch(c) {\n      case 'x':\n\tclick[i][j]++;\n\tcontinue;\n      case '?':\n\twen[i][j]++;\n      }\n    }\n  }\n  fclose(stdin);\n  pow2[0] = 1ll;\n  for (int i = 1; i <= n*m; i++) {\n    pow2[i] = pow2[i-1]*_2%MOD;\n  }\n  for (int i = 1; i <= n; i++) {\n    for (int j = 2; j <= m; j++) {\n      click[i][j]+=click[i][j-1];\n      wen[i][j]+=wen[i][j-1];\n    }\n  }\n  for (int j = 1; j <= m; j++) {\n    for (int i = 2; i <= n; i++) {\n      click[i][j]+=click[i-1][j];\n      wen[i][j]+=wen[i-1][j];\n    }\n  }\n  for (int x1 = 0; x1 < n; x1++) {\n    for (int x2 = x1+1; x2 <= n; x2++) {\n      for (int y1 = 0; y1 < m; y1++) {\n\tfor (int y2 = y1+1; y2 <= m; y2++) {\n\t  if (!Cube(x1, x2, y1, y2)) res+=Count(x1, x2, y1, y2);\n\t}\n      }\n    }\n  }\n  printf(\"%lld\\n\", res%MOD);\n  return 0;\n}\n\n```\n",
        "postTime": 1619364637,
        "uid": 124314,
        "name": "lcyxds",
        "ccfLevel": 0,
        "title": "P7523 Cytoid\u9898\u89e3"
    },
    {
        "content": "\u66b4\u529b\u679a\u4e3e\u6bcf\u4e2a\u77e9\u9635\u7684\u8d21\u732e\uff0c\u82e5\u77e9\u9635\u5185\u6709 `x` \u90a3\u8d21\u732e\u4e3a $0$\uff0c\u5269\u4e0b\u7684\u60c5\u51b5\u8bbe `?` \u4e2a\u6570\u4e3a $x$\uff0c\u5219\u8d21\u732e\u4e3a $\\dfrac{1}{2^x}$\uff0c\u539f\u56e0\u662f\u53ea\u6709\u5f53\u6240\u6709 `?` \u4e3a `o` \u624d\u4f1a\u6709\u8d21\u732e\u3002\n\n\u4e8c\u7ef4\u524d\u7f00\u548c\u53ef\u4ee5\u7ef4\u62a4\u8fd9\u4e2a\u3002\u518d\u9884\u5904\u7406\u4e00\u4e0b $2$ \u7684\u6b21\u5e42\uff0c\u6700\u540e\u590d\u6742\u5ea6\u662f $O(n^4)$\u3002\n\n\u5f88\u4e11\u7684\u4ee3\u7801\uff1a\n\n```cpp\n//by DP\u738b\u5b50 \n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nconst ll mod=998244353;\nint n,m;\nchar a[101][101];\nint sum1[101][101],sum2[101][101];\nll ans,po[100001];\nll ksm(ll x,ll y)\n{\n\tif (y==0) return 1;\n\tll t=ksm(x,y/2);\n\tt=t*t%mod;\n\tif (y%2==0) return t;\n\treturn t*x%mod;\n}\nint ask(int i,int j,int k,int p,int t)\n{\n\tif (t==1) return sum1[j][p]-sum1[i-1][p]-sum1[j][k-1]+sum1[i-1][k-1];\n\telse return sum2[j][p]-sum2[i-1][p]-sum2[j][k-1]+sum2[i-1][k-1];\n } \nint main()\n{\n\tcin >> n >> m;\n\tpo[0]=1;\n\tfor (int i=1;i<=n*m;i++) po[i]=po[i-1]*2ll%mod;\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tfor (int j=1;j<=m;j++)\n\t\t{\n\t\t\tcin >> a[i][j];\n\t\t\tif (a[i][j]=='?') sum1[i][j]=1;\n\t\t\telse if (a[i][j]=='x') sum2[i][j]=1;\n\t\t}\n\t}\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tfor (int j=1;j<=m;j++)\n\t\t{\n\t\t\tsum1[i][j]=sum1[i-1][j]+sum1[i][j-1]-sum1[i-1][j-1]+sum1[i][j];\n\t\t\tsum2[i][j]=sum2[i-1][j]+sum2[i][j-1]-sum2[i-1][j-1]+sum2[i][j];\n\t\t}\n\t}\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tfor (int j=i;j<=n;j++)\n\t\t{\n\t\t\tfor (int k=1;k<=m;k++)\n\t\t\t{\n\t\t\t\tfor (int p=k;p<=m;p++)\n\t\t\t\t{\n\t\t\t\t\tint u=ask(i,j,k,p,2);\n\t\t\t\t\tif (u>0) break;\n\t\t\t\t\tu=ask(i,j,k,p,1);\n\t\t\t\t\tans=(ans+po[n*m-u])%mod;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tll res=ksm(po[n*m],mod-2);\n\tans=(ans*res)%mod;\n\tcout << ans;\n\treturn 0;\n}\n```\n",
        "postTime": 1620655839,
        "uid": 336102,
        "name": "DP\u738b\u5b50",
        "ccfLevel": 0,
        "title": "P7523 Cytoid \u9898\u89e3"
    }
]
[
    {
        "content": "\u7531\u4e8e\u662f\u9009\u51fa\u79ef\u6728\u6709\u6807\u53f7\uff0c\u6240\u4ee5\u4f7f\u7528\u6307\u6570\u578b\u751f\u6210\u51fd\u6570\n\n\u5148\u8003\u8651\u9009\u7684\u65b9\u6848\u6570\n\n\u663e\u7136\u6bcf\u4e00\u5c42\u7684\u751f\u6210\u51fd\u6570\u4e3a $F(x)=\\displaystyle\\sum_{k=1}^{\\infty}\\dfrac 1{k!}x^k=e^x-1$\n\n\u679a\u4e3e\u5c42\u6570\uff0c\u7b54\u6848\u5373\u4e3a $\\displaystyle\\sum_{k=0}^{\\infty}F^k(x)=\\dfrac 1{1-F(x)}=\\dfrac 1{2-e^x}$\n\n\u63a5\u4e0b\u6765\u6c42\u6240\u6709\u65b9\u6848\u7684\u5c42\u6570\u603b\u548c\n\n\u679a\u4e3e\u5c42\u6570\uff0c\u7b54\u6848\u5373\u4e3a $\\displaystyle\\sum_{k=0}^{\\infty}kF^k(x)=\\dfrac {F(x)}{(1-F(x))^2}=\\dfrac{e^x-1}{(2-e^x)^2}$\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u7528 FFT+\u591a\u9879\u5f0f\u6c42\u9006 \u505a\u5b8c\u4e86",
        "postTime": 1548479980,
        "uid": 26127,
        "name": "Weng_Weijie",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5162 \u3010WD\u4e0e\u79ef\u6728\u3011"
    },
    {
        "content": "### [\u535a\u5ba2\u9605\u8bfb](https://www.cnblogs.com/wljss/p/12036854.html)\n\n$NTT$ \u795e\u4ed9\u9898\uff0corz  memset0\u3002\n\n\u9898\u9762\u6ca1\u770b\u592a\u61c2\uff0c\u5927\u6982\u610f\u601d\u5c31\u662f\u6c42\u6709n\u4e2a\u4e0d\u540c\u7684\u5c0f\u7403\uff0c\u653e\u8fdb $1$\u3001$2$\u3001$\u2026\u2026n $ \u4e2a\u4e0d\u540c\u7684\u76d2\u5b50\uff0c\u4e0d\u53ef\u7a7a\u7684\u60c5\u51b5\u4e0b\uff0c\u671f\u671b\u7528\u4e86\u51e0\u4e2a\u76d2\u5b50\u3002\n\n\u6309\u7167\u5957\u8def\uff0c\u6211\u4eec\u5e94\u8be5\u5206\u522b\u6c42\u51fa\u603b\u7684\u65b9\u6848\u6570$g_i$\u548c\u603b\u5171\u7528\u7684\u76d2\u5b50\u6570 $f_i$ ,\u7b54\u6848\u5c31\u662f $f_i\\times g_i^{-1}$\u3002\n\n\u6211\u4eec\u5148\u6765\u6c42\u603b\u7684\u65b9\u6848\u6570\uff0c\u8bbe $S$ \u662f\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\uff0c\u5219\n\n$\\displaystyle g_n=\\sum_{i=1}^nS[n][i]\\times i!$\n\n\u5c31\u662f\u6211\u4eec\u679a\u4e3e\u7528\u4e86\u51e0\u4e2a\u76d2\u5b50\uff0c\u5728\u4e58\u4e0a $i!$ \u5c06\u76d2\u5b50\u770b\u6210\u662f\u4e0d\u4e00\u6837\u7684\u3002\n\n\u4f46\u662f\u6211\u4eec\u6ca1\u529e\u6cd5\u8fdb\u884c\u4e0b\u53bb\u4e86\uff0c\u6211\u4eec\u8003\u8651\u4e00\u4e0b\u9012\u63a8\u5f0f\u3002\n\n$\\displaystyle g_n=\\sum_{i=1}^nC_n^ig_{n-i}$\n\n\u542b\u4e49\u5c31\u662f\u6211\u4eec\u679a\u4e3e\u7b2c\u4e00\u4e2a\u76d2\u5b50\u91cc\u90fd\u6709\u54ea\u4e9b\u7403\uff0c\u518d\u4e58\u4e0a\u5269\u4e0b\u7684\u7403\u7684\u65b9\u6848\u6570 $g_{n-i}$ \u3002\u6211\u4eec\u5c1d\u8bd5\u5316\u7b80\u4e00\u4e0b\u5f0f\u5b50\u3002\n\n$\\displaystyle g_n=\\sum_{i=1}^n \\frac{n!}{i!(n-i)!}g_{n-i}$\n$\\displaystyle \\frac{g_n}{n!}=\\sum_{i=1}^n \\frac{1}{i!}\\frac{g_{n-i}}{(n-i)!}$\n\n\u8bbe $\\displaystyle G_n=\\frac{g_n}{n!}$   $\\displaystyle H_n=\\frac{1}{n!}$ ,\u6ce8\u610f $H_0=1,G_0=1$ \u90a3\u4e48\n\n$\\displaystyle G_n=\\sum_{i=1}^nH_iG_{n-i}$\n\n\u6709\u70b9\u50cf\u5206\u6cbb $FFT$ \uff0c~~\u4f46\u6211\u4eec\u4f1a\u591a\u9879\u5f0f\u6c42\u9006~~,\u6211\u4eec\u6309\u7167\u5206\u6cbb $FFT$ \u7684\u5957\u8def\u6765\u3002\n\n\u8bbe $\\displaystyle G=\\sum_{i=0}^{\\infty}G_ix^i$   $\\displaystyle H=\\sum_{i=0}^{\\infty}H_ix^i$\n\n$\\displaystyle G*H=\\sum_{i=0}^{\\infty}(\\sum_{j+k=i}G_jH_k)x^i$\n\n\u5f53 $i>0$ \u65f6\uff0c$\\displaystyle \\sum_{j+k=i}G_jH_k=\\sum_{j=0}^iH_jG_{i-j}=\\sum_{j=1}^iH_jG_{i-j}+H_0G_i=2G_i$\n\n\u5f53 $i=0$ \u65f6\uff0c$G_0H_0=1=2G_0-1$\n\n\u6240\u4ee5\n\n$G*H=2G-1$\n\n$G=(2-H)^{-1}$\n\n\u591a\u9879\u5f0f\u6c42\u9006\u4e00\u6ce2\u5e26\u8d70\u3002 \n\n\u6211\u4eec\u518d\u6765\u770b\u770b\u600e\u4e48\u6c42\u603b\u5171\u7684\u76d2\u5b50\u6570\u3002\n\n$\\displaystyle f_n=g_n+\\sum_{i=1}^nC_n^if_{n-i}$\n\n\u542b\u4e49\u5c31\u662f\u9996\u5148\u6211\u4eec\u6bcf\u4e00\u79cd\u65b9\u6848\u81f3\u5c11\u6709\u4e00\u4e2a\u76d2\u5b50\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u52a0\u4e0a $g_n$ ,\u5bf9\u4e8e\u5269\u4e0b\u7684 $n-i$ \u4e2a\u5c0f\u7403\uff0c\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5c31\u662f $f_{n-i}$ ,\u56e0\u4e3a\u7b2c\u4e00\u4e2a\u76d2\u5b50\u6709 $C_n^i$ \u79cd\u9009\u6cd5\uff0c\u6240\u4ee5\u5c31\u662f $\\displaystyle f_n=g_n+\\sum_{i=1}^nC_n^if_{n-i}$\n\n\u6211\u4eec\u518d\u6765\u641e\u4e00\u641e\u3002\u73b0\u5c06 $\\displaystyle g_n=\\sum_{i=1}^nC_n^ig_{n-i}$ \u5e26\u8fdb\u53bb\u3002\n\n$\\displaystyle f_n=\\sum_{i=1}^nC_n^ig_{n-i}+\\sum_{i=1}^nC_n^if_{n-i}$\n\n$\\displaystyle \\frac{f_n}{n!}=\\sum_{i=1}^{n}\\frac{1}{i!}\\frac{g_{n-i}}{(n-i)!}+\\sum_{i=1}^{n}\\frac{1}{i!}\\frac{f_{n-i}}{(n-i)!}$\n\n\u8bbe $\\displaystyle F_n=\\frac{f_n}{n!}$\n\n$\\displaystyle F_n=\\sum_{i=1}^nH_i(F_{n-i}+G_{n-i})$\n\n\u8bbe $\\displaystyle F=\\sum_{i=0}^{\\infty}F_ix^i$\n\n\u90a3\u4e48\n\n$\\displaystyle H*(F+G)=\\sum_{i=0}^{\\infty}(\\sum_{j+k=i}((F_k+G_k)H_j))x^i$ \uff08\u6ce8\u610f\u770b\u6e05\u5927\u62ec\u53f7\uff09\n\n\u5f53 $i>0$ \u65f6\uff0c$\\displaystyle \\sum_{j+k=i}(F_k+G_k)H_j=\\sum_{j=0}^i(F_{i-j}+G_{i-j})H_{j}=\\sum_{j=1}^i(F_{i-j}+G_{i-j})H_{j}+F_i+G_i=2F_i+G_i$\n\n\u5f53 $i=0$ \u65f6\uff0c$(F_0+G_0)H_0=1=2F_0+G_0$\n\n\u6240\u4ee5\n\n$\\displaystyle H*(F+G)=2F+G$\n\n$\\displaystyle F=\\frac{G-GH}{H-2}$\n\n\u56e0\u4e3a $G=(2-H)^{-1}$\n\n\u6240\u4ee5 $G-GH=1-G$\n\n\u5e26\u8fdb\u53bb\n\n$\\displaystyle F=(1-G)(H-2)^{-1}$\n\n\u6700\u540e\u7b54\u6848\u5c31\u662f $F_nG_n^{-1}$\n\n\u63a8\u8fd9\u4e9b\u5f0f\u5b50\u6211\u7adf\u7136\u63a8\u4e86\u4e00\u4e0b\u5348\uff0c\u6211\u8fd8\u662f\u592a\u83dc\u4e86\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#define DB double\n#define LL long long\nusing namespace std;\nint T, n;\nconst int N = 400010, M = 100000, mod = 998244353, YY = 3, YYinv = (mod + 1) / 3;\nint r[N];\nLL jc[N], inv[N], H[N], g[N], G[N], F[N];\ninline int read() \n{\n\tint res = 0; char ch = getchar(); bool XX = false;\n\tfor (; !isdigit(ch); ch = getchar())(ch == '-') && (XX = true);\n\tfor (; isdigit(ch); ch = getchar())res = (res << 3) + (res << 1) + (ch ^ 48);\n\treturn XX ? -res : res;\n}\nvoid Write(int x, int opt) \n{\n\tif (opt && !x)putchar('0');\n\tif (!x)return;\n\tWrite(x / 10, 0);\n\tputchar((x - x / 10 * 10) + '0');\n}\nLL ksm(LL a, LL b, LL mod) \n{\n\tLL res = 1;\n\tfor (; b; b >>= 1, a = a * a % mod)\n\t\tif (b & 1)res = res * a % mod;\n\treturn res;\n}\nvoid NTT(LL *A, int lim, int opt) \n{\n\tfor (int i = 0; i < lim; ++i)\n\t\tr[i] = (r[i >> 1] >> 1) | ((i & 1) ? (lim >> 1) : 0);\n\tfor (int i = 0; i < lim; ++i)\n\t\tif (i < r[i])swap(A[i], A[r[i]]);\n\tint len;\n\tLL wn, w, x, y;\n\tfor (int mid = 1; mid < lim; mid <<= 1) \n\t{\n\t\tlen = mid << 1;\n\t\twn = ksm(opt == 1 ? YY : YYinv, (mod - 1) / len, mod);\n\t\tfor (int j = 0; j < lim; j += len) \n\t\t{\n\t\t\tw = 1;\n\t\t\tfor (int k = j; k < j + mid; ++k, w = w * wn % mod) \n\t\t\t{\n\t\t\t\tx = A[k]; y = A[k + mid] * w % mod;\n\t\t\t\tA[k] = (x + y) % mod;\n\t\t\t\tA[k + mid] = (x - y + mod) % mod;\n\t\t\t}\n\t\t}\n\t}\n\tif (opt == 1)return;\n\tint ni = ksm(lim, mod - 2, mod);\n\tfor (int i = 0; i < lim; ++i)A[i] = A[i] * ni % mod;\n}\nLL c[N];\nvoid INV(int siz, LL *A, LL *B) \n{\n\tif (siz == 1) \n\t{\n\t\tB[0] = ksm(A[0], mod - 2, mod);\n\t\treturn;\n\t}\n\tINV((siz + 1) >> 1, A, B);\n\tint lim = 1;\n\twhile (lim < (siz << 1))lim <<= 1;\n\tfor (int i = 0; i < siz; ++i)c[i] = A[i];\n\tfor (int i = siz; i < lim; ++i)c[i] = 0;\n\tNTT(c, lim, 1); NTT(B, lim, 1);\n\tfor (int i = 0; i < lim; ++i)B[i] = B[i] * (2 - c[i] * B[i] % mod + mod) % mod;\n\tNTT(B, lim, -1);\n\tfor (int i = siz; i < lim; ++i)B[i] = 0;\n}\nvoid MUL(LL *A, int n, LL *B, int m) \n{\n\tint lim = 1;\n\twhile (lim < (n + m))lim <<= 1;\n\tNTT(A, lim, 1); NTT(B, lim, 1);\n\tfor (int i = 0; i < lim; ++i)A[i] = A[i] * B[i] % mod;\n\tNTT(A, lim, -1);\n}\nvoid YYCH() \n{\n\tinv[0] = inv[1] = jc[0] = jc[1] = 1;\n\tfor (int i = 2; i <= M; ++i)jc[i] = jc[i - 1] * i % mod;\n\tinv[M] = ksm(jc[M], mod - 2, mod);\n\tfor (int i = M - 1; i >= 1; --i)inv[i] = inv[i + 1] * (i + 1) % mod;\n\tfor (int i = 0; i <= M; ++i) \n\t{\n\t\tH[i] = inv[i];\n\t\tg[i] = mod - H[i];\n\t}\n\tg[0] += 2;\n\tINV(M + 1, g, G);\n\tfor (int i = 0; i <= M; ++i) \n\t{\n\t\tF[i] = G[i]; g[i] = G[i];\n\t}\n\tF[0]--;\n\tMUL(F, M, g, M);\n}\nint main() \n{\n\tYYCH();\n\tcin >> T;\n\twhile (T--) \n\t{\n\t\tn = read();\n\t\tprintf(\"%lld\\n\", F[n]*ksm(G[n], mod - 2, mod) % mod);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1576235462,
        "uid": 153843,
        "name": "wljss",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5162 \u3010WD\u4e0e\u79ef\u6728\u3011"
    },
    {
        "content": "\u6c34\u4e00\u53d1\u7206\u7b97\u9898\u89e3(\u5176\u5b9e\u633a\u597d\u7b97\n\n\u5206\u5b50\u5206\u6bcd\u5206\u5f00\u7b97\uff0c\u5206\u5b50\u5c31\u679a\u4e3e\u5206\u4e86\u51e0\u5c42\u7136\u540e\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u641e\u641e\uff0c\u5206\u6bcd\u4e5f\u4e00\u6837\uff0c\u5199\u51fa\u5f0f\u5b50\u6765\u5373\n\n$$\\sum_{i=0}^n\\begin{Bmatrix}n\\\\i\\end{Bmatrix}i!\\qquad\\sum_{i=0}^n\\begin{Bmatrix}n\\\\i\\end{Bmatrix}i!\\cdot i$$\n\n\u7136\u540e\u4e0d\u77e5\u9053\u8be5\u5e72\u5565\u5c31\u5927\u529b\u5bf9$n$\u5957\u4e00\u4e2a\u751f\u6210\u51fd\u6570\uff0c\u8fd9\u9898\u5e26\u6807\u53f7\u6240\u4ee5\u9009EGF\uff0c\u6709\n\n$$\\begin{aligned}&\\sum_{n\\geq 0}\\frac{x^n}{n!}\\sum_{i=0}^n\\begin{Bmatrix}n\\\\i\\end{Bmatrix}i!\\\\=&\\sum_{i\\geq 0}i!\\sum_{n\\geq 0}\\frac{x^n}{n!}\\begin{Bmatrix}n\\\\i\\end{Bmatrix}\\\\=&\\sum_{i\\geq 0}\\sum_{n\\geq 0}\\frac{x^n}{n!}\\sum_{k=0}^i(-1)^k\\binom{i}{k}(i-k)^n\\\\=&\\sum_{i\\geq 0}\\sum_{k=0}^i(-1)^{i-k}\\binom{i}{k}\\sum_{n\\geq 0}\\frac{(kx)^n}{n!}\\\\=&\\sum_{i\\geq 0}\\sum_{k=0}^i(-1)^{i-k}\\binom{i}{k}(e^x)^k\\\\=&\\sum_{i\\geq 0}(e^x-1)^i\\\\=&\\frac{1}{2-e^x}\\end{aligned}$$\n\n\u53e6\u4e00\u4e2a\u540c\u7406\uff0c\u7b97\u51fa\u6765\u662f\n\n$$\\frac{e^x-1}{(2-e^x)^2}$$\n\n\u6c42\u9006\u5c31\u5b8c\u4e86.\n\n\u4ee3\u7801\u5e26\u7740\u4e2a\u53c8\u81ed\u53c8\u957f\u7684\u591a\u9879\u5f0f\u677f\u5b50\u5c31\u4e0d\u653e\u4e86(((",
        "postTime": 1587562713,
        "uid": 22136,
        "name": "qwaszx",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 P5162 \u3010WD\u4e0e\u79ef\u6728\u3011"
    },
    {
        "content": "\u95ee\u9898\u53ef\u4ee5\u9000\u5316\u6210\u4e24\u4e2a\u90e8\u5206\uff1a\n\n - \u7ed9\u5b9a $n$\uff0c\u6c42 $[1,2,\\dots,n]$ \u6709\u591a\u5c11\u4e2a\u6709\u5e8f\u5212\u5206\uff1b\n - \u7ed9\u5b9a $n$\uff0c\u6c42\u8fd9\u4e9b\u6709\u5e8f\u5212\u5206\u4e2d\u6240\u6709\u6709\u5e8f\u5212\u5206\u91cc\u9762\u96c6\u5408\u6570\u91cf\u4e4b\u548c\u3002\n\n\u5176\u4e2d\u4e00\u4e2a\u6709\u5e8f\u5212\u5206\u662f\u4e00\u4e2a\u975e\u7a7a\u96c6\u5408\u5e8f\u5217 $A=[S_1,S_2,\\dots,S_k]$ \uff0c\u6ee1\u8db3\u4efb\u610f\u4e00\u4e2a\u5728 ${1,2,\\dots,n}$ \u91cc\u9762\u7684\u5143\u7d20\u5728\u6070\u597d\u4e00\u4e2a $S_1,S_2,\\dots,S_k$ \u91cc\u9762\u3002\u4e24\u4e2a\u6709\u5e8f\u5212\u5206 $A,B$ \u4e0d\u540c\u5f53\u4e14\u4ec5\u5f53\u5b83\u4eec\u7684\u957f\u5ea6\u4e0d\u540c\u6216\u8005\u5b58\u5728\u4e00\u4e2a $k$ \u4f7f\u5f97 $A_k\\neq B_k$\u3002\u6ce8\u610f\u96c6\u5408\u65e0\u5e8f\uff0c\u4f46\u662f\u5e8f\u5217\u6709\u5e8f\u3002\n\n\u7b2c\u4e00\u4e2a\u7b54\u6848\u4e3a\u8f93\u51fa\u5206\u6bcd\uff0c\u7b2c\u4e8c\u4e2a\u7b54\u6848\u4e3a\u8f93\u51fa\u5206\u5b50\u3002\n\n\u5206\u522b\u63a8\u5f0f\u5b50\u3002\n\n## \u7b2c\u4e00\u90e8\u5206\n\n\u679a\u4e3e\u5212\u5206\u6210\u591a\u5c11\u96c6\u5408\uff0c\u53eb $k$\u3002\u5982\u679c\u65e0\u5e8f\u7684\u8bdd\uff0c\u90a3\u4e48\u8fd9\u91cc\u7684\u7b54\u6848 $\\left\\{{n\\atop k}\\right\\}$\uff0c\u4f46\u662f\u56e0\u4e3a\u6709\u5e8f\uff0c\u8fd9\u4e2a\u4e0d\u591f\u3002\u7531\u4e8e\u6240\u6709\u96c6\u5408\u4e92\u4e0d\u76f8\u540c\uff0c\u53ef\u4ee5\u76f4\u63a5\u4e58 $k!$ \u6765\u8865\u8d77\u6765\u3002\n\n\u56e0\u4e3a\u8fd9\u9053\u9898\u76ee\u6709\u591a\u7ec4\u6570\u636e\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u66f4\u5feb\u6765\u76f4\u63a5\u8003\u8651\u751f\u6210\u51fd\u6570\uff08\u8fd9\u91cc\u7528 egf \u56e0\u4e3a\u663e\u7136\u66f4\u65b9\u4fbf\uff09\n\n$$F(z)=\\sum_{n=0}^\\infty(\\sum_{k=0}^n\\begin{Bmatrix}n\\\\k\\end{Bmatrix}k!)\\frac{z^n}{n!}$$\n\n\u63a8\n\n$$F(z)=\\sum_{k=0}^\\infty(e^z-1)^k$$\n\n$$F(z)=\\frac{1}{2-e^z}$$\n\n## \u7b2c\u4e8c\u90e8\u5206\n\n\u8fd9\u4e2a\u53ef\u4ee5\u4ece\u4e0a\u9762\u5fae\u5fae\u6539\u53d8\u6765\u63a8\u51fa\u6765\u3002\u6bcf\u4e00\u6b21\u679a\u4e3e $n,k$ \u7684\u65f6\u5019\u5728\u8003\u8651\u4e00\u4e0b\u5bf9\u8fd9\u4e2a $n$ \u7684\u7b54\u6848\u8d21\u732e\u3002\u8fd9\u4e2a\u8d21\u732e\u5c31\u662f\u5e8f\u5217\u591a\u957f\uff1a$k$\u3002\u6240\u4ee5 $\\left\\{{n\\atop k}\\right\\}k!$ \u53d8\u6210 $\\left\\{{n\\atop k}\\right\\}k!k$ \u5c31\u53ef\u4ee5\u4e86\u3002\n\n$$G(z)=\\sum_{n=0}^\\infty(\\sum_{k=0}^n\\begin{Bmatrix}n\\\\k\\end{Bmatrix}k!k)\\frac{z^n}{n!}$$\n\n$$G(z)=\\sum_{k=0}^\\infty k(e^z-1)^k$$\n\n\u7528\u5f0f\u5b50 $\\sum kc^k=\\frac{c}{(1-c)^2}$\n\n$$G(z)=\\frac{e^z-1}{(2-e^z)^2}$$\n\n\u597d\u4e86\uff0c\u76f4\u63a5\u505a\u591a\u9879\u5f0f exp&\u9006\u5143&\u4e58\u6cd5 \u5c31\u591f\uff0c\u7136\u540e\u6ce8\u610f\u4e00\u5806\u7ec6\u8282\u5c31\u53ef\u4ee5\uff0c\u6211\u8c03\u8bd5\u4e86\u597d\u957f\u65f6\u95f4\uff08\n\n\u6700\u7ec8\u7b54\u6848\uff1a\n\n$$a(n)=n!\\frac{[x^n]\\frac{1}{2-e^z}}{[x^n]\\frac{e^z-1}{(2-e^z)^2}}$$\n\n\u7279\u522b\u6ce8\u610f\n\n$$\\frac{[x^n]F(x)}{[x^n]G(x)}\\neq[x^n]\\frac{F(x)}{G(x)}$$\n\n\u4ee3\u7801\u7531\u4e8e\u677f\u5b50\u592a\u957f\uff0c\u5c31\u4e0d\u653e\u5728\u8fd9\u91cc\u4e86\u3002",
        "postTime": 1592303494,
        "uid": 220037,
        "name": "w33z8kqrqk8zzzx33",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P5162 \u3010WD\u4e0e\u79ef\u6728\u3011"
    },
    {
        "content": "## P5162 WD\u4e0e\u79ef\u6728\n\n\n\u8bbe $f_{i,j}$ \u8868\u793a\u7528\u4e86 $i$ \u5c42\u653e\u4e86 $j$ \u4e2a\u79ef\u6728\u7684\u65b9\u6848\u6570\uff0c\u6bcf\u5c42\u975e\u7a7a\uff0c$f_{i,j}=\\sum_{k=1}^j \\binom j kf_{i-1,k}$\uff0c$\\{0,1,1,1,\\cdots\\}$ \u7684 EGF \u4e3a $F(x)=\\sum_{i=1}^{\\infty}\\large\\frac{x^i}{i!}$\uff0c$f_i$ \u7684 EGF \u5b9e\u9645\u4e0a\u662f $f_{i-1}$ \u7684 EGF \u4e0e $F$ \u7684\u5377\u79ef\uff0c\u4e5f\u5c31\u662f $F^i$\u3002\n\n\u65b9\u6848\u603b\u6570\u4e3a $n!\\times [x^n]\\sum_{i\\geq 0}F^i=n!\\times [x^n]\\large\\frac{1}{1-F}$\u3002\n\n\u6240\u6709\u65b9\u6848\u5c42\u6570\u4e4b\u548c\u4e3a $\\sum_{i=1}^n if_{i,n}=n!\\normalsize\\times [x^n]\\sum_{i\\geq 1}iF^i=n!\\times [x^n]\\large\\frac{F}{(1-F)^2}$\uff0c\u6700\u540e\u4e00\u6b65\u662f\u9519\u4f4d\u76f8\u51cf & $\\sum_{i\\geq 1}F^i=\\frac{F}{1-F}$ \u5f97\u5230\u7684\u3002\n\n\u591a\u9879\u5f0f\u6c42\u9006\u5373\u53ef\u3002\n\n```cpp\n//lkytxdy\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=(1<<20)+5,mod=998244353;\nint t,n=1e5,fac[N],iv[N],a[N],b[N],c[N],d[N],len,r[N],A[N],B[N],p[N],q[N];\nint qpow(int x,int n){\n\tint ans=1;\n\tfor(;n;n>>=1,x=1ll*x*x%mod) if(n&1) ans=1ll*ans*x%mod;\n\treturn ans;\n}\nvoid NTT(int *a,int n,int op){\n\tfor(int i=0;i<n;i++) if(i<r[i]) swap(a[i],a[r[i]]);\n\tfor(int k=2;k<=n;k<<=1){\n\t\tint m=k>>1,v=qpow(~op?3:qpow(3,mod-2),(mod-1)/k),w=1,x,y; \n\t\tfor(int i=0;i<n;i+=k,w=1)\n\t\t\tfor(int j=i;j<i+m;j++)\n\t\t\t\tx=a[j],y=1ll*w*a[j+m]%mod,a[j]=(x+y)%mod,a[j+m]=(x-y+mod)%mod,w=1ll*w*v%mod;\n\t}\n\tif(op==-1){\n\t\tint inv=qpow(n,mod-2);\n\t\tfor(int i=0;i<n;i++) a[i]=1ll*a[i]*inv%mod;\n\t}\n} \nvoid mul(int *a,int *b,int len){\n\tfor(int i=0;i<len;i++)\n\t\tp[i]=a[i],q[i]=b[i],r[i]=r[i>>1]>>1|(i&1?len>>1:0);\n\tNTT(p,len,1),NTT(q,len,1);\n\tfor(int i=0;i<len;i++) a[i]=1ll*p[i]*q[i]%mod;\n\tNTT(a,len,-1);\n}\nvoid inv(int *a,int *b,int len){\n\tfor(int i=0;i<len;i++) b[i]=0;\n\tb[0]=qpow(a[0],mod-2);\n\tfor(int i=2;i<=len;i<<=1){\n\t\tfor(int j=0;j<(i<<1);j++) A[j]=j<i?a[j]:0,B[j]=j<(i>>1)?b[j]:0; \n\t\tmul(B,B,i),mul(A,B,i<<1);\n\t\tfor(int j=0;j<i;j++) b[j]=(2ll*b[j]%mod-A[j]+mod)%mod;\n\t}\n}\nsigned main(){\n\tscanf(\"%d\",&t),fac[0]=iv[0]=iv[1]=1;\n\tfor(int i=2;i<=n;i++) iv[i]=1ll*iv[mod%i]*(mod-mod/i)%mod;\n\tfor(int i=1;i<=n;i++)\n\t\tfac[i]=1ll*fac[i-1]*i%mod,a[i]=iv[i]=1ll*iv[i-1]*iv[i]%mod,b[i]=mod-a[i];\n\tfor(len=1;len<=n;len<<=1);\n\tb[0]++,inv(b,c,len),mul(b,b,len<<1),inv(b,d,len<<1),mul(a,d,len<<2);\n\twhile(t--){\n\t\tscanf(\"%d\",&n);\n\t\tprintf(\"%lld\\n\",1ll*a[n]%mod*qpow(c[n],mod-2)%mod);\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1644055156,
        "uid": 381985,
        "name": "lkytxdy",
        "ccfLevel": 0,
        "title": "P5162 WD\u4e0e\u79ef\u6728"
    },
    {
        "content": "[$$\\large \\color{purple} My\\;Blog$$](https://www.cnblogs.com/p-b-p-b/p/10352594.html)\n\n---------\n\n\n## \u9898\u89e3\n\n\u771f\u662f\u975e\u5e38\u5957\u8def\u7684\u4e00\u9053\u9898\u2026\u2026\n\n\u8003\u8651$DP$\uff1a\u8bbe$f_n$\u4e3a$n$\u4e2a\u79ef\u6728\u80fd\u642d\u51fa\u7684\u65b9\u6848\u6570\uff0c$g_n$\u4e3a\u6240\u6709\u65b9\u6848\u7684\u9ad8\u5ea6\u4e4b\u548c\u3002\n\n\u5bb9\u6613\u5f97\u5230\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$f_n=[n=0]+\\sum_{i=1}^n {n \\choose i} f_{n-i}$$\n$$g_n=\\sum_{i=1}^n {n \\choose i} (f_{n-i}+g_{n-i})$$\n\u53d1\u73b0$f_n$\u4f3c\u4e4e\u66f4\u5bb9\u6613\u641e\u51fa\u6765\uff0c\u6211\u4eec\u5148\u641e$f_n$\u3002\n\n\u7531\u8f6c\u79fb\u65b9\u7a0b\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$\\frac{f_n}{n!}=[n=0]+\\sum_{i=1}^n \\frac{1}{i!} \\frac{f_{n-i}}{(n-i)!}$$\n\n\u8bbe\n\n$$F(x)=\\sum_n \\frac{f_n}{n!} x^n$$\n$$S(x)=\\sum_{n=1}^{\\infty} \\frac{1}{n!} x^n$$\n\n\u5219\u6709\n\n$$F(x)-1=F(x)S(x)$$\n$$F(x)=\\frac{1}{1-S(x)}$$\n\n\u591a\u9879\u5f0f\u6c42\u9006\u5373\u53ef\u3002\n\n\u63a5\u4e0b\u6765\u662f\u6c42$g_n$\u3002\n\n\u4ee4$t_n=f_n+g_n$\uff0c\u5219\u6709\n\n$$\\frac{g_n}{n!}=\\sum_{i=1}^n \\frac{1}{i!} \\frac{t_{n-i}}{(n-i)!}$$\n\n\u8bbe\n\n$$G(x)=\\sum_n \\frac{g_n}{n!} x^n$$\n$$T(x)=\\sum_n \\frac{t_n}{n!}=F(x)+G(x)$$\n\n\u53ef\u4ee5\u5f97\u5230\n\n$$G(x)=S(x)T(x)=S(x)F(x)+S(x)G(x)$$\n$$G(x)=\\frac{S(x)F(x)}{1-S(x)}=S(x)[F(x)]^2=F(x)(F(x)-1)$$\n\nNTT\u5373\u53ef\u3002\n\n\u6700\u540e$ans_n=\\frac{g_n}{f_n}$\u3002\n\n-----------\n\n## \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nnamespace my_std{\n\tusing namespace std;\n\t#define pii pair<int,int>\n\t#define fir first\n\t#define sec second\n\t#define MP make_pair\n\t#define rep(i,x,y) for (int i=(x);i<=(y);i++)\n\t#define drep(i,x,y) for (int i=(x);i>=(y);i--)\n\t#define go(x) for (int i=head[x];i;i=edge[i].nxt)\n\t#define sz 400404\n\ttypedef long long ll;\n\tconst ll mod=998244353;\n\ttemplate<typename T>\n\tinline void read(T& t)\n\t{\n\t\tt=0;char f=0,ch=getchar();\n\t\tdouble d=0.1;\n\t\twhile(ch>'9'||ch<'0') f|=(ch=='-'),ch=getchar();\n\t\twhile(ch<='9'&&ch>='0') t=t*10+ch-48,ch=getchar();\n\t\tif(ch=='.')\n\t\t{\n\t\t\tch=getchar();\n\t\t\twhile(ch<='9'&&ch>='0') t+=d*(ch^48),d*=0.1,ch=getchar();\n\t\t}\n\t\tt=(f?-t:t);\n\t}\n\ttemplate<typename T,typename... Args>\n\tinline void read(T& t,Args&... args){read(t); read(args...);}\n\tvoid file()\n\t{\n\t\t#ifndef ONLINE_JUDGE\n\t\tfreopen(\"a.txt\",\"r\",stdin);\n\t\t#endif\n\t}\n//\tinline ll mul(ll a,ll b){ll d=(ll)(a*(double)b/mod+0.5);ll ret=a*b-d*mod;if (ret<0) ret+=mod;return ret;}\n}\nusing namespace my_std;\n\ninline ll ksm(ll x,int y)\n{\n\tll ret=1;\n\tfor (;y;y>>=1,x=x*x%mod) if (y&1) ret=ret*x%mod;\n\treturn ret;\n}\nll inv(ll x){return ksm(x,mod-2);}\n\nint r[sz],limit;\nvoid NTT_init(int n)\n{\n\tlimit=1;int l=-1;\n\twhile (limit<=n+n) limit<<=1,++l;\n\trep(i,0,limit-1) r[i]=(r[i>>1]>>1)|((i&1)<<l);\n}\nvoid NTT(ll *a,int type)\n{\n\trep(i,0,limit-1) if (i<r[i]) swap(a[i],a[r[i]]);\n\tfor (int mid=1;mid<limit;mid<<=1)\n\t{\n\t\tll Wn=ksm(3,(mod-1)/mid>>1);if (type==-1) Wn=inv(Wn);\n\t\tfor (int len=mid<<1,j=0;j<limit;j+=len)\n\t\t{\n\t\t\tll w=1;\n\t\t\tfor (int k=0;k<mid;k++,w=w*Wn%mod)\n\t\t\t{\n\t\t\t\tll x=a[j+k],y=w*a[j+k+mid]%mod;\n\t\t\t\ta[j+k]=(x+y)%mod;a[j+k+mid]=(mod+x-y)%mod;\n\t\t\t}\n\t\t}\n\t}\n\tif (type==1) return;\n\tll I=inv(limit);\n\trep(i,0,limit-1) a[i]=a[i]*I%mod;\n}\nll tmp1[sz],tmp2[sz];\nvoid PolyInv(ll *a,ll *f,int n)\n{\n\tif (n==1) return (void)(f[0]=inv(a[0]));\n\tint mid=(n+1)>>1;\n\tPolyInv(a,f,mid);\n\tNTT_init(n);\n\trep(i,0,mid-1) tmp1[i]=f[i];\n\trep(i,0,n-1) tmp2[i]=a[i];\n\tNTT(tmp1,1);NTT(tmp2,1);\n\trep(i,0,limit-1) tmp1[i]=tmp1[i]*(mod+2-tmp1[i]*tmp2[i]%mod)%mod;\n\tNTT(tmp1,-1);\n\trep(i,0,n-1) f[i]=tmp1[i];\n\trep(i,0,limit-1) tmp1[i]=tmp2[i]=0;\n}\n\nll fac[sz],_fac[sz];\nvoid init(){fac[0]=_fac[0]=1;rep(i,1,sz-1) _fac[i]=inv(fac[i]=fac[i-1]*i%mod);}\n\nll f[sz],g[sz],s[sz];\nll t1[sz],t2[sz],t3[sz],t4[sz];\n\nint main()\n{\n\tfile();\n\tinit();\n\tint n=1e5+5,T;\n\trep(i,1,n) s[i]=mod-_fac[i];\n\t++s[0];\n\tPolyInv(s,t1,n);\n\trep(i,1,n) f[i]=t1[i];f[0]=1;\n\trep(i,0,n) t2[i]=t3[i]=f[i];--t3[0];\n\tNTT_init(n);\n\tNTT(t2,1);NTT(t3,1);\n\trep(i,0,limit-1) t4[i]=t2[i]*t3[i]%mod;\n\tNTT(t4,-1);\n\trep(i,1,n) g[i]=t4[i];\n\tread(T);\n\twhile (T--) read(n),printf(\"%lld\\n\",g[n]*inv(f[n])%mod);\n}\n```\n\n\u770b\u5b8c\u4f60\u8c37\u795e\u4ed9\u7684\u9898\u89e3\u540e\u7a81\u7136\u611f\u89c9\u6211\u7684\u65b9\u6cd5\u771f\u9ebb\u70e6\u2026\u2026",
        "postTime": 1549337903,
        "uid": 76481,
        "name": "p_b_p_b",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P5162 \u3010WD\u4e0e\u79ef\u6728\u3011"
    },
    {
        "content": "\u8bba\u5982\u4f55\u7528 $OEIS$ \u505a\u9898\n\n\u4e3b\u8bb2\u4eba\uff1a$Owen\\_codeisking$\n\n\u65b9\u6cd5\u63d0\u51fa\u8005\uff1a$ljc1301$\n\n\u7b2c\u4e8c\u5929 $ljc1301$ \u5411\u6211\u4f20\u6388\u4e86\u8fd9\u79cd\u65b9\u6cd5\uff0c\u4e0d\u7528\u5199\u4ec0\u4e48\u66b4\u529b\uff0c\u4f1a\u6284\u677f\u5b50\u5c31\u80fd $A$ \u6389\u6b64\u9898\n\n\u6211\u4eec\u53ef\u4ee5\u4ee5\u5404\u79cd\u65b9\u5f0f\u5f97\u5230 $n=4$ \u65f6\u5206\u5b50\u4e3a $233$\uff0c\u5206\u6bcd\u4e3a $75$\n\n\u5206\u5b50\u7684\u6570\u5217\uff1a$1,5,31,233,...$\n\n\u5206\u6bcd\u7684\u6570\u5217\uff1a$1,3,13,75,...$\n\n\u6211\u4eec\u5728 $OEIS$ \u7528\u6570\u5217\u7684\u524d\u56db\u9879\u627e\u5230\u5206\u5b50\u5f0f\u53ea\u6709\u4e00\u4e2a\u6570\u5217\uff0c\u5206\u6bcd\u6709\u5341\u4e2a\u7b49\u4ef7\u7684\u6570\u5217\u3002\u627e\u5230\u5206\u5b50 $FORMULA$ \u90a3\u91cc\u6709 `(exp(x)-1)/((2-exp(x))^2)`\uff0c\u5206\u6bcd $FORMULA$ \u90a3\u91cc\u6709 ` 1/(2-exp(x))`\n\n\u5206\u5b50\u7684\u901a\u9879\u516c\u5f0f\uff1a$\\Large\\frac{e^x-1}{(2-e^x)^2}$\n\n\u5206\u6bcd\u7684\u901a\u9879\u516c\u5f0f\uff1a$\\Large\\frac{1}{2-e^x}$\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u51fa\u9898\u4eba\u975e\u5e38\u826f\u5fc3\uff0c\u4e0d\u9700\u8981\u6211\u4eec\u7528\u4efb\u610f\u6a21\u6570 $NTT$\uff0c\u6240\u4ee5\u6211\u4eec\u7528\u6734\u7d20\u7684 $NTT$ \u5c31\u884c\u4e86\n\n$P.S:e^n=\\sum_{i=0}^{n}\\Large\\frac{1}{i!}x^{i}$\n\n\u9884\u5904\u7406\u4e00\u4e0b\u9006\u5143\uff0c\u5bf9 $\\Large\\frac{1}{2-e^x}$ \u591a\u9879\u5f0f\u6c42\u9006\uff0c\u7136\u540e\u7528\u5206\u6bcd\u7684\u5f0f\u5b50\u63a8\u5230\u5206\u5b50\u7684\u5f0f\u5b50\u5c31\u597d\u4e86\n\n$Code\\ Below:$\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int maxn=500000+10;\nconst int mod=998244353;\nint n,fac[maxn],inv[maxn],a[maxn],b[maxn],c[maxn],f[maxn],r[maxn];\n\ninline void read(int &x){\n    x=0;int f=1;char ch=getchar();\n    while(!isdigit(ch)){if(ch=='-')f=-1;ch=getchar();}\n    while(isdigit(ch)){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\n    if(f==-1) x=-x;\n}\nvoid print(int x){\n    if(x<0){putchar('-');x=-x;}\n    if(x>9) print(x/10);\n    putchar(x%10+'0');\n}\n\ninline int add(int x,int y){\n    x+=y;x>=mod?x-=mod:0;\n    return x;\n}\ninline int sub(int x,int y){\n    x-=y;x<0?x+=mod:0;\n    return x;\n}\ninline int mul(int x,int y){\n    x=1ll*x*y%mod;\n    return x;\n}\ninline int fast_pow(int a,int b){\n    int ret=1;\n    for(;b;b>>=1,a=mul(a,a))\n        if(b&1) ret=mul(ret,a);\n    return ret;\n}\n\nvoid NTT(int *f,int n,int op){\n    for(int i=0;i<n;i++)\n        if(i<r[i]) swap(f[i],f[r[i]]);\n    int buf,tmp,x,y;\n    for(int len=1;len<n;len<<=1){\n        tmp=fast_pow(3,(mod-1)/(len<<1));\n        if(op==-1) tmp=fast_pow(tmp,mod-2);\n        for(int i=0;i<n;i+=len<<1){\n            buf=1;\n            for(int j=0;j<len;j++){\n                x=f[i+j];y=mul(buf,f[i+j+len]);\n                f[i+j]=add(x,y);f[i+j+len]=sub(x,y);\n                buf=mul(buf,tmp);\n            }\n        }\n    }\n    if(op==1) return ;\n    int inv=fast_pow(n,mod-2);\n    for(int i=0;i<n;i++) f[i]=mul(f[i],inv);\n}\n\nvoid work(int n,int *a,int *b){\n    if(n==1){\n        b[0]=fast_pow(a[0],mod-2);\n        return ;\n    }\n    work((n+1)>>1,a,b);\n    int lim=1;\n    for(;lim<(n<<1);lim<<=1);\n    for(int i=1;i<lim;i++) r[i]=(r[i>>1]>>1)|((i&1)?(lim>>1):0);\n    for(int i=0;i<n;i++) c[i]=a[i];\n    for(int i=n;i<lim;i++) c[i]=0;\n    NTT(b,lim,1);NTT(c,lim,1);\n    for(int i=0;i<lim;i++) b[i]=mul(sub(2,mul(b[i],c[i])),b[i]);\n    NTT(b,lim,-1);\n    for(int i=n;i<lim;i++) b[i]=0;\n}\n\nint main()\n{\n    n=100001;\n    int T;read(T);fac[0]=1;\n    for(int i=1;i<n;i++) fac[i]=mul(fac[i-1],i);\n    inv[n-1]=fast_pow(fac[n-1],mod-2);\n    for(int i=n-2;i>=0;i--) inv[i]=mul(inv[i+1],i+1);\n    for(int i=0;i<n;i++) a[i]=mod-inv[i];\n    a[0]=add(a[0],2);work(n,a,b);\n    for(int i=0;i<n;i++) a[i]=f[i]=b[i];\n    a[0]=add(a[0],mod-1);\n    int lim=1;\n    while(lim<=n) lim<<=1;\n    NTT(f,lim<<1,1);NTT(a,lim<<1,1);\n    for(int i=0;i<(lim<<1);i++) f[i]=mul(f[i],a[i]);\n    NTT(f,lim<<1,-1);\n    while(T--){\n    \tread(n);\n    \tprint(mul(f[n],fast_pow(b[n],mod-2)));putchar('\\n');\n\t}\n    return 0;\n}\n```",
        "postTime": 1546602429,
        "uid": 35069,
        "name": "Owen_codeisking",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P5162 \u3010WD\u4e0e\u79ef\u6728\u3011"
    }
]
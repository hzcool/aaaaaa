[
    {
        "content": "# [\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\u70b9\u8fd9\u91cc](http://www.cnblogs.com/zwfymqz/p/8244902.html)\n\n\n\n\n# \u591a\u9879\u5f0f\n\n## \u7cfb\u6570\u8868\u793a\u6cd5\n\n\u8bbe$A(x)$\u8868\u793a\u4e00\u4e2a$n-1$\u6b21\u591a\u9879\u5f0f\n\n\u5219$A(x)=\\sum_{i=0}^{n} a_i * x^i$\n\n\u4f8b\u5982\uff1a$A(3)=2+3*x+x^2$\n\n\u5229\u7528\u8fd9\u79cd\u65b9\u6cd5\u8ba1\u7b97\u591a\u9879\u5f0f\u4e58\u6cd5\u590d\u6742\u5ea6\u4e3a$O(n^2)$\n\n\uff08\u7b2c\u4e00\u4e2a\u591a\u9879\u5f0f\u4e2d\u6bcf\u4e2a\u7cfb\u6570\u90fd\u9700\u8981\u4e0e\u7b2c\u4e8c\u4e2a\u591a\u9879\u5f0f\u7684\u6bcf\u4e2a\u7cfb\u6570\u76f8\u4e58\uff09\n\n## \u70b9\u503c\u8868\u793a\u6cd5\n\n\u5c06$n$\u4e92\u4e0d\u76f8\u540c\u7684$x$\u5e26\u5165\u591a\u9879\u5f0f\uff0c\u4f1a\u5f97\u5230$n$\u4e2a\u4e0d\u540c\u7684\u53d6\u503c$y$\n\n\u5219\u8be5\u591a\u9879\u5f0f\u88ab\u8fd9$n$\u4e2a\u70b9$(x_1,y_1),(x_2,y_2),\\dots,(x_n,y_n)$\u552f\u4e00\u786e\u5b9a\n\n\u5176\u4e2d$y_i=\\sum_{j=0}^{n-1} a_j*x_i^j$\n\n\u4f8b\u5982\uff1a\u4e0a\u9762\u7684\u4f8b\u5b50\u7528\u70b9\u503c\u8868\u793a\u6cd5\u53ef\u4ee5\u4e3a$(0,2),(1,5),(2,12)$\n\n\u5229\u7528\u8fd9\u79cd\u65b9\u6cd5\u8ba1\u7b97\u591a\u9879\u5f0f\u4e58\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4ecd\u7136\u4e3a$O(n^2)$\n\n\uff08\u9009\u70b9$O(n)$\uff0c\u6bcf\u6b21\u8ba1\u7b97$O(n)$\uff09\n\n \n\n\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u4e24\u79cd\u65b9\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u4e3a$O(n^2)$\uff0c\u6211\u4eec\u8003\u8651\u5bf9\u5176\u8fdb\u884c\u4f18\u5316\n\n\u5bf9\u4e8e\u7b2c\u4e00\u79cd\u65b9\u6cd5\uff0c\u7531\u4e8e\u6bcf\u4e2a\u70b9\u7684\u7cfb\u6570\u90fd\u662f\u56fa\u5b9a\u7684\uff0c\u60f3\u8981\u4f18\u5316\u6bd4\u8f83\u56f0\u96be\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u79cd\u65b9\u6cd5\uff0c\u8c8c\u4f3c\u4e5f\u6ca1\u6709\u4ec0\u4e48\u597d\u7684\u4f18\u5316\u65b9\u6cd5\uff0c\u4e0d\u8fc7\u5f53\u4f60\u770b\u5b8c\u4e0b\u9762\u7684\u77e5\u8bc6\uff0c\u6216\u8bb8\u5c31\u4e0d\u8fd9\u4e48\u60f3\u4e86\n\n \n\n#\u3000\u590d\u6570\n\n\u5728\u4ecb\u7ecd\u590d\u6570\u4e4b\u524d\uff0c\u9996\u5148\u4ecb\u7ecd\u4e00\u4e9b\u53ef\u80fd\u4f1a\u7528\u5230\u7684\u4e1c\u897f\n\n## \u5411\u91cf\n\n\u540c\u65f6\u5177\u6709\u5927\u5c0f\u548c\u65b9\u5411\u7684\u91cf\n\n\u5728\u51e0\u4f55\u4e2d\u901a\u5e38\u7528\u5e26\u6709\u7bad\u5934\u7684\u7ebf\u6bb5\u8868\u793a\n\n## \u5706\u7684\u5f27\u5ea6\u5236\n\n\u7b49\u4e8e\u534a\u5f84\u957f\u7684\u5706\u5f27\u6240\u5bf9\u7684\u5706\u5fc3\u89d2\u53eb\u505a1\u5f27\u5ea6\u7684\u89d2\uff0c\u7528\u7b26\u53f7rad\u8868\u793a\uff0c\u8bfb\u4f5c\u5f27\u5ea6\u3002\u7528\u5f27\u5ea6\u4f5c\u5355\u4f4d\u6765\u5ea6\u91cf\u89d2\u7684\u5236\u5ea6\u53eb\u505a\u5f27\u5ea6\u5236\n\n\u516c\u5f0f:\n\n$1^{\\circ }=\\dfrac{\\pi}{180}rad$\n\n$180^{\\circ }=\\pi rad$\n\n## \u5e73\u884c\u56db\u8fb9\u5f62\u5b9a\u5219\n\n\u5e73\u884c\u56db\u8fb9\u5f62\u5b9a\u5219\uff1aAB+AD=AC\n\n## \u590d\u6570\n\n### \u5b9a\u4e49\n\n\u8bbe$a,b$\u4e3a\u5b9e\u6570\uff0c$i^2=-1$\uff0c\u5f62\u5982$a+bi$\u7684\u6570\u53eb\u8d1f\u6570\uff0c\u5176\u4e2d$i$\u88ab\u79f0\u4e3a\u865a\u6570\u5355\u4f4d\uff0c\u590d\u6570\u57df\u662f\u76ee\u524d\u5df2\u77e5\u6700\u5927\u7684\u57df\n\n\u5728\u590d\u5e73\u9762\u4e2d\uff0c$x$\u4ee3\u8868\u5b9e\u6570\uff0c$y$\u8f74\uff08\u9664\u539f\u70b9\u5916\u7684\u70b9\uff09\u4ee3\u8868\u865a\u6570\uff0c\u4ece\u539f\u70b9$(0,0)$\u5230$(a,b)$\u7684\u5411\u91cf\u8868\u793a\u590d\u6570$a+bi$\n\n\u6a21\u957f\uff1a\u4ece\u539f\u70b9$(0,0)$\u5230\u70b9$(a,b)$\u7684\u8ddd\u79bb\uff0c\u5373$\\sqrt{a^2+b^2}$\n\n\u5e45\u89d2\uff1a\u5047\u8bbe\u4ee5\u9006\u65f6\u9488\u4e3a\u6b63\u65b9\u5411\uff0c\u4ece$x$\u8f74\u6b63\u534a\u8f74\u5230\u5df2\u77e5\u5411\u91cf\u7684\u8f6c\u89d2\u7684\u6709\u5411\u89d2\u53eb\u505a\u5e45\u89d2\n\n### \u8fd0\u7b97\u6cd5\u5219\n\n\u52a0\u6cd5\uff1a\n\n\u56e0\u4e3a\u5728\u590d\u5e73\u9762\u4e2d\uff0c\u590d\u6570\u53ef\u4ee5\u88ab\u8868\u793a\u4e3a\u5411\u91cf\uff0c\u56e0\u6b64\u590d\u6570\u7684\u52a0\u6cd5\u4e0e\u5411\u91cf\u7684\u52a0\u6cd5\u76f8\u540c\uff0c\u90fd\u6ee1\u8db3\u5e73\u884c\u56db\u8fb9\u5f62\u5b9a\u5219\uff08\u5c31\u662f\u4e0a\u9762\u90a3\u4e2a\uff09\n\n\u4e58\u6cd5\uff1a\n\n\u51e0\u4f55\u5b9a\u4e49\uff1a\u590d\u6570\u76f8\u4e58\uff0c\u6a21\u957f\u76f8\u4e58\uff0c\u5e45\u89d2\u76f8\u52a0\n\n\u4ee3\u6570\u5b9a\u4e49\uff1a$$(a+bi)*(c+di)$$\n\n$$=ac+adi+bci+bdi^2$$\n\n$$=ac+adi+bci-bd$$\n\n$$=(ac-bd)+(bc+ad)i$$\n\n \n\n\u5355\u4f4d\u6839\n\n\u4e0b\u6587\u4e2d\uff0c\u9ed8\u8ba4$n$\u4e3a$2$\u7684\u6b63\u6574\u6570\u6b21\u5e42\n\n\u5728\u590d\u5e73\u9762\u4e0a\uff0c\u4ee5\u539f\u70b9\u4e3a\u5706\u5fc3\uff0c$1$\u4e3a\u534a\u5f84\u4f5c\u5706\uff0c\u6240\u5f97\u7684\u5706\u53eb\u5355\u4f4d\u5706\u3002\u4ee5\u5706\u70b9\u4e3a\u8d77\u70b9\uff0c\u5706\u7684$n$\u7b49\u5206\u70b9\u4e3a\u7ec8\u70b9\uff0c\u505a$n$\u4e2a\u5411\u91cf\uff0c\u8bbe\u5e45\u89d2\u4e3a\u6b63\u4e14\u6700\u5c0f\u7684\u5411\u91cf\u5bf9\u5e94\u7684\u590d\u6570\u4e3a$\\omega_n$\uff0c\u79f0\u4e3a$n$\u6b21\u5355\u4f4d\u6839\u3002\n\n\u6839\u636e\u590d\u6570\u4e58\u6cd5\u7684\u8fd0\u7b97\u6cd5\u5219\uff0c\u5176\u4f59$n-1$\u4e2a\u590d\u6570\u4e3a$\\omega_n^2,\\omega_n^3,\\ldots,\\omega_n^n$\n\n\u6ce8\u610f$\\omega_n^0=\\omega_n^n=1$\uff08\u5bf9\u5e94\u590d\u5e73\u9762\u4e0a\u4ee5$x$\u8f74\u4e3a\u6b63\u65b9\u5411\u7684\u5411\u91cf\uff09\n\n\u90a3\u4e48\u5982\u4f55\u8ba1\u7b97\u5b83\u4eec\u7684\u503c\u5462\uff1f\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u7531\u6b27\u62c9\u516c\u5f0f\u89e3\u51b3$$\\omega_{n}^{k}=\\cos\\ k *\\frac{2\\pi}{n}+i\\sin k*\\frac{2\\pi}{n}$$\n\n \n\n\u5355\u4f4d\u6839\u7684\u5e45\u89d2\u4e3a\u5468\u89d2\u7684$\\dfrac{1}{n}$\n\n\u5728\u4ee3\u6570\u4e2d\uff0c\u82e5$z^n=1$\uff0c\u6211\u4eec\u628a$z$\u79f0\u4e3a$n$\u6b21\u5355\u4f4d\u6839\n\n\u5355\u4f4d\u6839\u7684\u6027\u8d28\n\n$\\omega _{n}^{k}=\\cos k\\dfrac{2\\pi}{n}+i\\sin k\\dfrac {2\\pi }{n}$\uff08\u5373\u4e0a\u9762\u7684\u516c\u5f0f\uff09\n$\\omega _{2n}^{2k}=\\omega _{n}^{k}$\n\u8bc1\u660e\uff1a\n\n$$\\omega _{2n}^{2k}=\\cos 2k*\\frac{2\\pi}{2n}+i\\sin2k*\\frac{2\\pi}{2n}$$\n\n$$=\\omega _{n}^{k}$$\n\n$\\omega _{n}^{k+\\frac{n}{2}}=-\\omega _{n}^{k}$\n$$\\omega _{n}^{\\frac{n}{2}}=\\cos\\frac{n}{2}*\\frac{2\\pi}{n}+i\\sin\\frac{n}{2}*\\frac{2\\pi}{n}$$\n\n$$=\\cos \\pi+i\\sin\\pi$$\n\n$$=-1$$\n\n$\\omega _{n}^{0}=\\omega _{n}^{n}=1$\n \u8bb2\u4e86\u8fd9\u4e48\u591a\uff0c\u8c8c\u4f3c\u8ddf\u6211\u4eec\u7684\u6b63\u9898\u6ca1\u5565\u5173\u7cfb\u554a\u3002\u3002\n\n OK\uff01\u5404\u4f4d\u5750\u7a33\u4e86\uff0c\u524d\u65b9\u9ad8\u80fd\uff01\n\n# \u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\n\n\u6211\u4eec\u524d\u9762\u63d0\u5230\u8fc7\uff0c\u4e00\u4e2a$n$\u6b21\u591a\u9879\u5f0f\u53ef\u4ee5\u88ab$n$\u4e2a\u70b9\u552f\u4e00\u786e\u5b9a\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u628a\u5355\u4f4d\u6839\u7684$0$\u5230$n-1$\u6b21\u5e42\u5e26\u5165\uff0c\u8fd9\u6837\u4e5f\u53ef\u4ee5\u628a\u8fd9\u4e2a\u591a\u9879\u5f0f\u786e\u5b9a\u51fa\u6765\u3002\u4f46\u662f\u8fd9\u6837\u4ecd\u7136\u662f$O(n^2)$\u7684\u5440\uff01\n\n\u6211\u4eec\u8bbe\u591a\u9879\u5f0f$A(x)$\u7684\u7cfb\u6570\u4e3a$(a_o,a_1,a_2,\\ldots,a_{n-1})$\n\n\u90a3\u4e48$$A(x)=a_0+a_1*x+a_2*{x^2}+a_3*{x^3}+a_4*{x^4}+a_5*{x^5}+ \\dots+a_{n-2}*x^{n-2}+a_{n-1}*x^{n-1}$$\n\n\u5c06\u5176\u4e0b\u6807\u6309\u7167\u5947\u5076\u6027\u5206\u7c7b\n\n$$A(x)=(a_0+a_2*{x^2}+a_4*{x^4}+\\dots+a_{n-2}*x^{n-2})+(a_1*x+a_3*{x^3}+a_5*{x^5}+ \\dots+a_{n-1}*x^{n-1})$$\n\n\u8bbe\n\n \n\n$$A_1(x)=a_0+a_2*{x}+a_4*{x^2}+\\dots+a_{n-2}*x^{\\frac{n}{2}-1}$$\n\n$$A_2(x)=a_1*x+a_3*{x}+a_5*{x^2}+ \\dots+a_{n-1}*x^{\\frac{n}{2}-1}$$\n\n\u90a3\u4e48\u4e0d\u96be\u5f97\u5230\n\n$$A(x)=A_1(x^2)+xA_2(x^2)$$\n\n\u6211\u4eec\u5c06$\\omega_n^k (k<\\frac{n}{2}) $\u4ee3\u5165\u5f97\n\n$$A(\\omega_n^k)=A_1(\\omega_n^{2k})+\\omega_n^kA_2(\\omega_n^{2k})$$\n\n$$=A_1(\\omega_{\\frac{n}{2}}^{k})+\\omega_n^kA_2(\\omega_{\\frac{n}{2}}^{k})$$\n\n\u540c\u7406\uff0c\u5c06$\\omega_n^{k+\\frac{n}{2}}$\u4ee3\u5165\u5f97\n\n$$A(\\omega_n^{k+\\frac{n}{2}})=A_1(\\omega_n^{2k+n})+\\omega_n^{k+\\frac{n}{2}}(\\omega_n^{2k+n})$$\n\n$$=A_1(\\omega_n^{2k}*\\omega_n^n)-\\omega_n^kA_2(\\omega_n^{2k}*\\omega_n^n)$$\n\n$$=A_1(\\omega_n^{2k})-\\omega_n^kA_2(\\omega_n^{2k})$$\n\n \n\n\u5927\u5bb6\u6709\u6ca1\u6709\u53d1\u73b0\u4ec0\u4e48\u89c4\u5f8b\uff1f\n\n\u6ca1\u9519\uff01\u8fd9\u4e24\u4e2a\u5f0f\u5b50\u53ea\u6709\u4e00\u4e2a\u5e38\u6570\u9879\u4e0d\u540c\uff01\n\n\u90a3\u4e48\u5f53\u6211\u4eec\u5728\u679a\u4e3e\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5$O(1)$\u7684\u5f97\u5230\u7b2c\u4e8c\u4e2a\u5f0f\u5b50\u7684\u503c\n\n\u53c8\u56e0\u4e3a\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u7684$k$\u5728\u53d6\u904d$[0,\\frac{n}{2}-1]$\u65f6\uff0c$k+\\frac{n}{2}$\u53d6\u904d\u4e86$[\\frac{n}{2},n-1]$\n\n\u6240\u4ee5\u6211\u4eec\u5c06\u539f\u6765\u7684\u95ee\u9898\u7f29\u5c0f\u4e86\u4e00\u534a\uff01\n\n\u800c\u7f29\u5c0f\u540e\u7684\u95ee\u9898\u4ecd\u7136\u6ee1\u8db3\u539f\u95ee\u9898\u7684\u6027\u8d28\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u9012\u5f52\u7684\u53bb\u641e\u8fd9\u4ef6\u4e8b\u60c5\uff01\n\n\u76f4\u5230\u591a\u9879\u5f0f\u4ec5\u5269\u4e00\u4e2a\u5e38\u6570\u9879\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u76f4\u63a5\u8fd4\u56de\u5c31\u597d\u5566\n\n \n\n## \u65f6\u95f4\u590d\u6742\u5ea6\uff1a\n\n\u4e0d\u96be\u770b\u51faFFT\u662f\u7c7b\u4f3c\u4e8e\u7ebf\u6bb5\u6811\u4e00\u6837\u7684\u5206\u6cbb\u7b97\u6cd5\u3002\n\n\u56e0\u6b64\u5b83\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(nlogn)$\n\n \n\n# \u5feb\u901f\u5085\u91cc\u53f6\u9006\u53d8\u6362\n\n\u4e0d\u8981\u4ee5\u4e3aFFT\u5230\u8fd9\u91cc\u5c31\u7ed3\u675f\u4e86\u3002\n\n\u6211\u4eec\u4e0a\u9762\u7684\u8ba8\u8bba\u662f\u57fa\u4e8e\u70b9\u503c\u8868\u793a\u6cd5\u7684\u3002\n\n\u4f46\u662f\u5728\u5e73\u5e38\u7684\u5b66\u4e60\u548c\u7814\u7a76\u4e2d\u5f88\u5c11\u7528\u70b9\u503c\u8868\u793a\u6cd5\u6765\u8868\u793a\u4e00\u4e2a\u591a\u9879\u5f0f\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8981\u8003\u8651\u5982\u4f55\u628a\u70b9\u503c\u8868\u793a\u6cd5\u8f6c\u6362\u4e3a\u7cfb\u6570\u8868\u793a\u6cd5\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u53eb\u505a\u5085\u91cc\u53f6\u9006\u53d8\u6362\n\n \n\n$(y_0,y_1,y_2,\\dots,y_{n-1})$\u4e3a$(a_0,a_1,a_2,\\dots,a_{n-1})$\u7684\u5085\u91cc\u53f6\u53d8\u6362\uff08\u5373\u70b9\u503c\u8868\u793a\uff09\n\n\u8bbe\u6709\u53e6\u4e00\u4e2a\u5411\u91cf$(c_0,c_1,c_2,\\dots,c_{n-1})$\u6ee1\u8db3\n\n$$c_k=\\sum_{i=0}^{n-1}y_i(\\omega_n^{-k})^i$$\n\n\u5373\u591a\u9879\u5f0f$B(x)=y_0,y_1x,y_2x^2,\\dots,y_{n-1}x^{n-1}$\u5728$\\omega_n^{0},\\omega_n^{-1},\\omega_n^{-2},\\dots,\\omega_{n-1}^{-(n-1)}$\u5904\u7684\u70b9\u503c\u8868\u793a\n\nemmmm\u53c8\u5230\u63a8\u516c\u5f0f\u65f6\u95f4\u5566\n\n$(c_0,c_1,c_2,\\dots,c_{n-1})$\u6ee1\u8db3\n$$c_k=\\sum_{i=0}^{n-1}y_i(\\omega_n^{-k})^i$$\n\n$$=\\sum_{i=0}^{n-1}(\\sum_{j=0}^{n-1}a_j(\\omega_n^i)^j)(\\omega_n^{-k})^i$$\n\n$$=\\sum_{i=0}^{n-1}(\\sum_{j=0}^{n-1}a_j(\\omega_n^j)^i)(\\omega_n^{-k})^i$$\n\n$$=\\sum_{i=0}^{n-1}(\\sum_{j=0}^{n-1}a_j(\\omega_n^j)^i(\\omega_n^{-k})^i)$$\n\n$$=\\sum_{i=0}^{n-1}\\sum_{j=0}^{n-1}a_j(\\omega_n^j)^i(\\omega_n^{-k})^i$$\n\n$$=\\sum_{i=0}^{n-1}\\sum_{j=0}^{n-1}a_j(\\omega_n^{j-k})^i$$\n\n$$=\\sum_{j=0}^{n-1}a_j(\\sum_{i=0}^{n-1}(\\omega_n^{j-k})^i)$$\n\n \n\n\u8bbe$S(x)=\\sum_{i=0}^{n-1}x^i$\n\n\u5c06$\\omega_n^k$\u4ee3\u5165\u5f97\n\n$$S(\\omega_n^k)=1+(\\omega_n^k)+(\\omega_n^k)^2+\\dots(\\omega_n^k)^{n-1}$$\n\n\u5f53$k!=0$\u65f6\n\n\u7b49\u5f0f\u4e24\u8fb9\u540c\u4e58$\\omega_n^k$\u5f97\n\n$$\\omega_n^kS(\\omega_n^k)=\\omega_n^k+(\\omega_n^k)^2+(\\omega_n^k)^3+\\dots(\\omega_n^k)^{n}$$\n\n\u4e24\u5f0f\u76f8\u51cf\u5f97\n\n$$\\omega_n^kS(\\omega_n^k)-S(\\omega_n^k)=(\\omega_n^k)^{n}-1$$\n\n$$S(\\omega_n^k)=\\frac{(\\omega_n^k)^{n}-1}{\\omega_n^k-1}$$\n\n$$S(\\omega_n^k)=\\frac{(\\omega_n^n)^{k}-1}{\\omega_n^k-1}$$\n\n$$S(\\omega_n^k)=\\frac{1-1}{\\omega_n^k-1}$$\n\n\u89c2\u5bdf\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u4e0d\u96be\u770b\u51fa\u5b83\u5206\u6bcd\u4e0d\u4e3a0\uff0c\u4f46\u662f\u5206\u5b50\u4e3a0\n\n\u56e0\u6b64\uff0c\u5f53$K!=0$\u65f6\uff0c$S(\\omega^{k}_{n})=0$\n\n\u90a3\u5f53$k=0$\u65f6\u5462\uff1f\n\n\u5f88\u663e\u7136\uff0c$S(\\omega^{0}_{n})=n$\n\n \n\n\u7ee7\u7eed\u8003\u8651\u521a\u521a\u7684\u5f0f\u5b50\n\n$$c_k=\\sum_{j=0}^{n-1}a_j(\\sum_{i=0}^{n-1}(\\omega_n^{j-k})^i)$$\n\u5f53$j!=k$\u65f6\uff0c\u503c\u4e3a$0$\n\u5f53$j=k$\u65f6\uff0c\u503c\u4e3a$n$\n\u56e0\u6b64\uff0c\n$$c_k=na_k$$\n$$a_k=\\frac{c_k}{n}$$\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u5f97\u5230\u70b9\u503c\u4e0e\u7cfb\u6570\u4e4b\u95f4\u7684\u8868\u793a\u5566\n\n \n\n# \u7406\u8bba\u603b\u7ed3\n\n\u81f3\u6b64\uff0cFFT\u7684\u57fa\u7840\u7406\u8bba\u90e8\u5206\u5c31\u7ed3\u675f\u4e86\u3002\n\n\u6211\u4eec\u6765\u5c0f\u7ed3\u4e00\u4e0bFFT\u662f\u600e\u4e48\u6210\u529f\u5b9e\u73b0\u7684\n\n \n\n\u9996\u5148\uff0c\u4eba\u4eec\u5728\u7528\u7cfb\u6570\u8868\u793a\u6cd5\u7814\u7a76\u591a\u9879\u5f0f\u7684\u65f6\u5019\u9047\u963b\n\n\u4e8e\u662f\u5f00\u59cb\u8003\u8651\u80fd\u5426\u7528\u70b9\u503c\u8868\u793a\u6cd5\u4f18\u5316\u8fd9\u4e2a\u4e1c\u897f\u3002\n\n\u7136\u540e\u6839\u636e\u590d\u6570\u7684\u4e24\u6761\u6027\u8d28\uff08\u8fd9\u4e2a\u601d\u7ef4\u8de8\u5ea6\u6bd4\u8f83\u5927\uff09\u5f97\u5230\u4e86\u4e00\u79cd\u5206\u6cbb\u7b97\u6cd5\u3002\n\n\u6700\u540e\u53c8\u63a8\u4e86\u4e00\u6ce2\u516c\u5f0f\uff0c\u627e\u5230\u4e86\u70b9\u503c\u8868\u793a\u6cd5\u4e0e\u7cfb\u6570\u8868\u793a\u6cd5\u4e4b\u95f4\u8f6c\u6362\u5173\u7cfb\u3002\n\n \n\nemmmm\n\n\u5176\u5b9eFFT\u7684\u5b9e\u73b0\u601d\u8def\u5927\u6982\u5c31\u662f\n\n\u7cfb\u6570\u8868\u793a\u6cd5\u2014>\u70b9\u503c\u8868\u793a\u6cd5\u2014>\u7cfb\u6570\u8868\u793a\u6cd5\n\n\n \n\n\u5f53\u7136\uff0c\u518d\u5b9e\u73b0\u7684\u8fc7\u7a0b\u4e2d\u8fd8\u6709\u5f88\u591a\u6280\u5de7\n\n\u6211\u4eec\u6839\u636e\u4ee3\u7801\u6765\u7406\u89e3\u4e00\u4e0b\n\n \n\n# \u9012\u5f52\u5b9e\u73b0\n\n\u9012\u5f52\u5b9e\u73b0\u7684\u65b9\u6cd5\u6bd4\u8f83\u7b80\u5355\u3002\n\n\u5c31\u662f\u6309\u627e\u6211\u4eec\u4e0a\u9762\u8bf4\u7684\u8fc7\u7a0b\uff0c\u4e0d\u65ad\u628a\u8981\u6c42\u7684\u5e8f\u5217\u5206\u6210\u4e24\u90e8\u5206\uff0c\u518d\u8fdb\u884c\u5408\u5e76\n\n\u5728c++\u7684STL\u4e2d\u63d0\u4f9b\u4e86\u73b0\u6210\u7684complex\u7c7b\uff0c\u4f46\u662f\u6211\u4e0d\u5efa\u8bae\u5927\u5bb6\u7528\uff0c\u6bd5\u7adf\u624b\u5199\u4e5f\u5c31\u90a3\u4e48\u51e0\u884c\uff0c\u800c\u4e14\u4e07\u4e00\u67d0\u4e2a\u6bd2\u7624\u5361STL\u90a3\u5c82\u4e0d\u662f\u5f88\uff27\uff27\uff1f\n\n \n```\n#include<iostream>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\nconst int MAXN=2*1e6+10;\ninline int read()\n{\n    char c=getchar();int x=0,f=1;\n    while(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n    while(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n    return x*f;\n}\nconst double Pi=acos(-1.0);\nstruct complex\n{\n    double x,y;\n    complex (double xx=0,double yy=0){x=xx,y=yy;}\n}a[MAXN],b[MAXN];\ncomplex operator + (complex a,complex b){ return complex(a.x+b.x , a.y+b.y);}\ncomplex operator - (complex a,complex b){ return complex(a.x-b.x , a.y-b.y);}\ncomplex operator * (complex a,complex b){ return complex(a.x*b.x-a.y*b.y , a.x*b.y+a.y*b.x);}//\u4e0d\u61c2\u7684\u770b\u590d\u6570\u7684\u8fd0\u7b97\u90a3\u90e8\u5206 \nvoid fast_fast_tle(int limit,complex *a,int type)\n{\n    if(limit==1) return ;//\u53ea\u6709\u4e00\u4e2a\u5e38\u6570\u9879\n    complex a1[limit>>1],a2[limit>>1];\n    for(int i=0;i<=limit;i+=2)//\u6839\u636e\u4e0b\u6807\u7684\u5947\u5076\u6027\u5206\u7c7b\n        a1[i>>1]=a[i],a2[i>>1]=a[i+1];\n    fast_fast_tle(limit>>1,a1,type);\n    fast_fast_tle(limit>>1,a2,type);\n    complex Wn=complex(cos(2.0*Pi/limit) , type*sin(2.0*Pi/limit)),w=complex(1,0);\n    //Wn\u4e3a\u5355\u4f4d\u6839\uff0cw\u8868\u793a\u5e42\n    for(int i=0;i<(limit>>1);i++,w=w*Wn)//\u8fd9\u91cc\u7684w\u76f8\u5f53\u4e8e\u516c\u5f0f\u4e2d\u7684k \n        a[i]=a1[i]+w*a2[i],\n        a[i+(limit>>1)]=a1[i]-w*a2[i];//\u5229\u7528\u5355\u4f4d\u6839\u7684\u6027\u8d28\uff0cO(1)\u5f97\u5230\u53e6\u4e00\u90e8\u5206 \n}\nint main()\n{\n    int N=read(),M=read();\n    for(int i=0;i<=N;i++) a[i].x=read();\n    for(int i=0;i<=M;i++) b[i].x=read();\n    int limit=1;while(limit<=N+M) limit<<=1;\n    fast_fast_tle(limit,a,1);\n    fast_fast_tle(limit,b,1);\n    //\u540e\u9762\u76841\u8868\u793a\u8981\u8fdb\u884c\u7684\u53d8\u6362\u662f\u4ec0\u4e48\u7c7b\u578b\n    //1\u8868\u793a\u4ece\u7cfb\u6570\u53d8\u4e3a\u70b9\u503c\n    //-1\u8868\u793a\u4ece\u70b9\u503c\u53d8\u4e3a\u7cfb\u6570 \n    //\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u8fd9\u6837\u662f\u5bf9\u7684\uff0c\u53ef\u4ee5\u53c2\u8003\u4e00\u4e0bc\u5411\u91cf\u7684\u63a8\u5bfc\u8fc7\u7a0b\uff0c \n    for(int i=0;i<=limit;i++)\n        a[i]=a[i]*b[i];\n    fast_fast_tle(limit,a,-1);\n    for(int i=0;i<=N+M;i++) printf(\"%d \",(int)(a[i].x/limit+0.5));//\u6309\u7167\u6211\u4eec\u63a8\u5012\u7684\u516c\u5f0f\uff0c\u8fd9\u91cc\u8fd8\u8981\u9664\u4ee5n \n    return 0;\n}\n \n```\n\u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2a\u542c\u8d77\u6765\u5f88\u88c5B\u7684\u4f18\u5316\u2014\u8774\u8776\u6548\u5e94\n\n\u89c2\u5bdf\u5408\u5e76\u7684\u8fc7\u7a0b\uff0cw*a2[i] \u8fd9\u4e00\u9879\u8ba1\u7b97\u4e86\u4e24\u6b21\uff0c\u56e0\u4e3a\u7406\u8bba\u4e0a\u6765\u8bf4\u590d\u6570\u7684\u4e58\u6cd5\u662f\u6bd4\u8f83\u6162\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u4e00\u9879\u8bb0\u51fa\u6765\n```\n    for(int i=0;i<(limit>>1);i++,w=w*Wn)//\u8fd9\u91cc\u7684w\u76f8\u5f53\u4e8e\u516c\u5f0f\u4e2d\u7684k \n    {\n        complex t=w*a2[i];//\u8774\u8776\u6548\u5e94\n        a[i]=a1[i]+t,\n        a[i+(limit>>1)]=a1[i]-t;//\u5229\u7528\u5355\u4f4d\u6839\u7684\u6027\u8d28\uff0cO(1)\u5f97\u5230\u53e6\u4e00\u90e8\u5206     \n    }\n\n```\n\n\n\n\u901f\u5ea6\u4ec0\u4e48\u7684\u624d\u4e0d\u662f\u5173\u952e\u5462\uff1f\n\n\u5173\u952e\u662f\u6211\u4eecAC\u4e0d\u4e86\u554a\u554a\u554a\n\n\u8868\u7740\u6025\uff0cAC\u4e0d\u4e86\u4e0d\u4ee3\u8868\u54b1\u4eec\u7684\u7b97\u6cd5\u4e0d\u5bf9\uff0c\u53ea\u80fd\u8bf4\u8fd9\u79cd\u5b9e\u73b0\u65b9\u6cd5\u592alow\u4e86\n\n\u4e0b\u9762\u4ecb\u7ecd\u4e00\u79cd\u66f4\u9ad8\u6548\u7684\u65b9\u6cd5\n\n \n\n# \u8fed\u4ee3\u5b9e\u73b0\n\n\n\u89c2\u5bdf\u4e00\u4e0b\u539f\u5e8f\u5217\u548c\u53cd\u8f6c\u540e\u7684\u5e8f\u5217\n\n\u806a\u660e\u7684\u4f60\u6709\u6ca1\u6709\u770b\u51fa\u4ec0\u4e48\u663e\u800c\u6613\u89c1\u7684\u6027\u8d28\uff1f\n\n\u6ca1\u9519\uff01\n\n\u6211\u4eec\u9700\u8981\u6c42\u7684\u5e8f\u5217\u5b9e\u9645\u662f\u539f\u5e8f\u5217\u4e0b\u6807\u7684\u4e8c\u8fdb\u5236\u53cd\u8f6c\uff01\n\n\u56e0\u6b64\u6211\u4eec\u5bf9\u5e8f\u5217\u6309\u7167\u4e0b\u6807\u7684\u5947\u5076\u6027\u5206\u7c7b\u7684\u8fc7\u7a0b\u5176\u5b9e\u662f\u6ca1\u6709\u5fc5\u8981\u7684\n\n \n\n\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5$O(n)$\u7684\u5229\u7528\u67d0\u79cd\u64cd\u4f5c\u5f97\u5230\u6211\u4eec\u8981\u6c42\u7684\u5e8f\u5217\uff0c\u7136\u540e\u4e0d\u65ad\u5411\u4e0a\u5408\u5e76\u5c31\u597d\u4e86\n```\n// luogu-judger-enable-o2\n#include<iostream>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\nconst int MAXN=1e7+10;\ninline int read()\n{\n    char c=getchar();int x=0,f=1;\n    while(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n    while(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n    return x*f;\n}\nconst double Pi=acos(-1.0);\nstruct complex\n{\n    double x,y;\n    complex (double xx=0,double yy=0){x=xx,y=yy;}\n}a[MAXN],b[MAXN];\ncomplex operator + (complex a,complex b){ return complex(a.x+b.x , a.y+b.y);}\ncomplex operator - (complex a,complex b){ return complex(a.x-b.x , a.y-b.y);}\ncomplex operator * (complex a,complex b){ return complex(a.x*b.x-a.y*b.y , a.x*b.y+a.y*b.x);}//\u4e0d\u61c2\u7684\u770b\u590d\u6570\u7684\u8fd0\u7b97\u90a3\u90e8\u5206 \nint N,M;\nint l,r[MAXN];\nint limit=1;\nvoid fast_fast_tle(complex *A,int type)\n{\n    for(int i=0;i<limit;i++) \n        if(i<r[i]) swap(A[i],A[r[i]]);//\u6c42\u51fa\u8981\u8fed\u4ee3\u7684\u5e8f\u5217 \n    for(int mid=1;mid<limit;mid<<=1)//\u5f85\u5408\u5e76\u533a\u95f4\u7684\u4e2d\u70b9\n    {\n        complex Wn( cos(Pi/mid) , type*sin(Pi/mid) ); //\u5355\u4f4d\u6839 \n        for(int R=mid<<1,j=0;j<limit;j+=R)//R\u662f\u533a\u95f4\u7684\u53f3\u7aef\u70b9\uff0cj\u8868\u793a\u524d\u5df2\u7ecf\u5230\u54ea\u4e2a\u4f4d\u7f6e\u4e86 \n        {\n            complex w(1,0);//\u5e42 \n            for(int k=0;k<mid;k++,w=w*Wn)//\u679a\u4e3e\u5de6\u534a\u90e8\u5206 \n            {\n                 complex x=A[j+k],y=w*A[j+mid+k];//\u8774\u8776\u6548\u5e94 \n                A[j+k]=x+y;\n                A[j+mid+k]=x-y;\n            }\n        }\n    }\n}\nint main()\n{\n    int N=read(),M=read();\n    for(int i=0;i<=N;i++) a[i].x=read();\n    for(int i=0;i<=M;i++) b[i].x=read();\n    while(limit<=N+M) limit<<=1,l++;\n    for(int i=0;i<limit;i++)\n        r[i]= ( r[i>>1]>>1 )| ( (i&1)<<(l-1) ) ;\n    // \u5728\u539f\u5e8f\u5217\u4e2d i \u4e0e i/2 \u7684\u5173\u7cfb\u662f \uff1a i\u53ef\u4ee5\u770b\u505a\u662fi/2\u7684\u4e8c\u8fdb\u5236\u4e0a\u7684\u6bcf\u4e00\u4f4d\u5de6\u79fb\u4e00\u4f4d\u5f97\u6765\n    // \u90a3\u4e48\u5728\u53cd\u8f6c\u540e\u7684\u6570\u7ec4\u4e2d\u5c31\u9700\u8981\u53f3\u79fb\u4e00\u4f4d\uff0c\u540c\u65f6\u7279\u6b8a\u5904\u7406\u4e00\u4e0b\u590d\u6570 \n    fast_fast_tle(a,1);\n    fast_fast_tle(b,1);\n    for(int i=0;i<=limit;i++) a[i]=a[i]*b[i];\n    fast_fast_tle(a,-1);\n    for(int i=0;i<=N+M;i++)\n        printf(\"%d \",(int)(a[i].x/limit+0.5));\n    return 0;\n}\n```\n",
        "postTime": 1518405015,
        "uid": 36984,
        "name": "attack",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09\u3011"
    },
    {
        "content": "## [\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\u70b9\u8fd9\u91cc](http://www.cnblogs.com/zwfymqz/p/8980809.html)\n\n\n\n\u5f88\u4e45\u4ee5\u524d\u5199\u8fc7\u4e00\u7bc7FFT\u7684\u9898\u89e3\n\n\u4eca\u5929\u6709\u5e78\u5b66\u5230\u4e86NTT\u2014\u2014 \u4e00\u79cd\u6bd4FFT\u66f4\u597d\u7528\u7684\u7b97\u6cd5\uff0c\u6765\u8ddf\u5927\u5bb6\u5206\u4eab\u4e00\u4e0b\n\n## NTT\n\n\u5728FFT\u4e2d\uff0c\u6211\u4eec\u9700\u8981\u7528\u5230\u590d\u6570\uff0c\u590d\u6570\u867d\u7136\u5f88\u795e\u5947\uff0c\u4f46\u662f\u5b83\u4e5f\u6709\u81ea\u5df1\u7684\u5c40\u9650\u6027\u2014\u2014\u9700\u8981\u7528double\u7c7b\u578b\u8ba1\u7b97\uff0c\u7cbe\u5ea6\u592a\u4f4e\n\n\u90a3\u6709\u6ca1\u6709\u4ec0\u4e48\u4e1c\u897f\u80fd\u591f\u4ee3\u66ff\u590d\u6570\u4e14\u89e3\u51b3\u7cbe\u5ea6\u95ee\u9898\u5462\uff1f\n\n\u8fd9\u4e2a\u4e1c\u897f\uff0c\u53eb**\u539f\u6839**\n\n\n------------\n\n\u539f\u6839\u7684\u5b9a\u4e49\n\n> \u8bbe$m$\u662f\u6b63\u6574\u6570\uff0c$a$\u662f\u6574\u6570\uff0c\u82e5$a$\u6a21$m$\u7684\u9636\u7b49\u4e8e$\\phi(m)$\uff0c\u5219\u79f0$a$\u4e3a\u6a21$m$\u7684\u4e00\u4e2a\u539f\u6839\n\n\u5b9a\u4e49\u4e2d\u7528\u5230\u4e86\u7fa4\u8bba\u7684\u4e00\u4e9b\u77e5\u8bc6\uff0c\u4e0d\u8fc7\u4e0d\u4f1a\u4e5f\u6ca1\u5173\u7cfb\uff0c\u4e0d\u5f71\u54cd\u63a5\u4e0b\u6765\u7684\u5b66\u4e60\n\n\u6211\u4eec\u5b9a\u4e49$P$\u4e3a\u7d20\u6570\uff0c$g$\u4e3a$P$\u7684\u539f\u6839\n\n\n\u8003\u8651\u539f\u6839\u4e3a\u4ec0\u4e48\u80fd\u4ee3\u66ff\u5355\u4f4d\u6839\u8fdb\u884c\u8fd0\u7b97\uff0c(\u8fd9\u90e8\u5206\u53ef\u4ee5\u8df3\u8fc7)\n\n\u539f\u56e0\u5f88\u7b80\u5355\uff0c\u56e0\u4e3a\u5b83\u5177\u6709\u548c\u5355\u4f4d\u6839\u76f8\u540c\u7684\u6027\u8d28\n\n\u5728FFT\u4e2d\uff0c\u6211\u4eec\u7528\u5230\u4e86\u5355\u4f4d\u6839\u7684\u56db\u6761\u6027\u8d28\uff0c\u800c\u539f\u6839\u4e5f\u6ee1\u8db3\u8fd9\u56db\u6761\u6027\u8d28\n\n1. \u5bf9\u4e8e\u6240\u6709$\\omega_n ^ t (0 \\leq t \\leq n - 1)$\u5747\u4e0d\u76f8\u540c\n\n\u4e0d\u52a0\u8bc1\u660e\u7684\u6254\u51fa\u4e00\u4e2a\u5b9a\u7406\n\n \u82e5$P$\u4e3a\u7d20\u6570\uff0c\u5047\u8bbe\u4e00\u4e2a\u6570$g$\u662f$P$\u7684\u539f\u6839\uff0c\u90a3\u4e48$g^i \\mod P (1<g<P,0<i<P)$\u7684\u7ed3\u679c\u4e24\u4e24\u4e0d\u540c\n\n\u4e0d\u8981\u95ee\u6211\u4e3a\u4ec0\u4e48\uff0c\u56e0\u4e3a\u6211\u4e5f\u4e0d\u77e5\u9053\u3002\u3002\n\n2. $\\omega_{2n} ^ {2k} = \\omega_n ^ k$\n\n\u901a\u8fc7\u4ee3\u6362\u53ef\u4ee5\u5f97\u5230\n\n3. $\\omega_n ^ { k + \\frac{n}{2} } = -\\omega_n ^ k$\n\n\u6839\u636e\u8d39\u9a6c\u5c0f\u5b9a\u7406\u548c\u6027\u8d281\u53ef\u4ee5\u5f97\u5230\n\n4. $1 + \\omega_n ^ k + (\\omega_n ^ k) ^ 2 + \\dots + (\\omega_n ^ k) ^ {n - 1} = 0 $\n\n\u7531\u6027\u8d283\u548cFFT\u4e2d\u5085\u91cc\u53f6\u9006\u53d8\u6362\u7684\u5b9a\u7406\u53ef\u4ee5\u5f97\u5230\n\n\n\n------------\n\n\n\u8fd9\u6837\u6211\u4eec\u6700\u7ec8\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u7ed3\u8bba\n\n$$\\omega_n \\equiv g^\\frac{p-1}{n} \\mod p$$\n\n\u7136\u540e\u628aFFT\u4e2d\u7684$\\omega_n$\u90fd\u66ff\u6362\u6389\u5c31\u597d\u4e86\n\n$p$\u5efa\u8bae\u53d6$998244353$\uff0c\u5b83\u7684\u539f\u6839\u4e3a$3$\u3002\n\n\u5982\u4f55\u6c42\u4efb\u610f\u4e00\u4e2a\u8d28\u6570\u7684\u539f\u6839\u5462\uff1f\n\n\u53ef\u4ee5\u8bc1\u660e\u6ee1\u8db3$g^r \\equiv 1(\\mod p)$\u7684\u6700\u5c0f\u7684$r$\u4e00\u5b9a\u662f$p-1$\u7684\u7ea6\u6570\n\n\u5bf9\u4e8e\u8d28\u6570$p$\uff0c\u8d28\u56e0\u5b50\u5206\u89e3$p-1$\uff0c\u82e5$g^{\\frac{p-1}{p_i}} \\neq 1 \\pmod p$\u6052\u6210\u7acb\uff0c$g$\u4e3a$p$\u7684\u539f\u6839\n\n\n\n------------\n\nNTT\u6c42\u5377\u79ef\u4ee3\u7801:\n\n\u786e\u5b9e\u6bd4FFT\u5feb\u4e86\u4e0d\u5c11\n\n```cpp\n#include<cstdio>\n#define getchar() (p1 == p2 && (p2 = (p1 = buf) + fread(buf, 1, 1<<21, stdin), p1 == p2) ? EOF : *p1++)\n#define swap(x,y) x ^= y, y ^= x, x ^= y\n#define LL long long \nconst int MAXN = 3 * 1e6 + 10, P = 998244353, G = 3, Gi = 332748118; \nchar buf[1<<21], *p1 = buf, *p2 = buf;\ninline int read() { \n    char c = getchar(); int x = 0, f = 1;\n    while(c < '0' || c > '9') {if(c == '-') f = -1; c = getchar();}\n    while(c >= '0' && c <= '9') x = x * 10 + c - '0', c = getchar();\n    return x * f;\n}\nint N, M, limit = 1, L, r[MAXN];\nLL a[MAXN], b[MAXN];\ninline LL fastpow(LL a, LL k) {\n\tLL base = 1;\n\twhile(k) {\n\t\tif(k & 1) base = (base * a ) % P;\n\t\ta = (a * a) % P;\n\t\tk >>= 1;\n\t}\n\treturn base % P;\n}\ninline void NTT(LL *A, int type) {\n\tfor(int i = 0; i < limit; i++) \n\t\tif(i < r[i]) swap(A[i], A[r[i]]);\n\tfor(int mid = 1; mid < limit; mid <<= 1) {\t\n\t\tLL Wn = fastpow( type == 1 ? G : Gi , (P - 1) / (mid << 1));\n\t\tfor(int j = 0; j < limit; j += (mid << 1)) {\n\t\t\tLL w = 1;\n\t\t\tfor(int k = 0; k < mid; k++, w = (w * Wn) % P) {\n\t\t\t\t int x = A[j + k], y = w * A[j + k + mid] % P;\n\t\t\t\t A[j + k] = (x + y) % P,\n\t\t\t\t A[j + k + mid] = (x - y + P) % P;\n\t\t\t}\n\t\t}\n\t}\n}\nint main() {\n\tN = read(); M = read();\n\tfor(int i = 0; i <= N; i++) a[i] = (read() + P) % P;\n\tfor(int i = 0; i <= M; i++) b[i] = (read() + P) % P;\n\twhile(limit <= N + M) limit <<= 1, L++;\n\tfor(int i = 0; i < limit; i++) r[i] = (r[i >> 1] >> 1) | ((i & 1) << (L - 1));\t\n\tNTT(a, 1);NTT(b, 1);\t\n\tfor(int i = 0; i < limit; i++) a[i] = (a[i] * b[i]) % P;\n\tNTT(a, -1);\t\n\tLL inv = fastpow(limit, P - 2);\n\tfor(int i = 0; i <= N + M; i++)\n\t\tprintf(\"%d \", (a[i] * inv) % P);\n\treturn 0;\n}\n```\n\n## \u53c2\u8003\u8d44\u6599\n\n[Menci\u7684\u535a\u5ba2](https://oi.men.ci/fft-to-ntt/)\n\n[Candy?\u7684\u535a\u5ba2](http://www.cnblogs.com/candy99/p/6641972.html)\n\n\n\n\n\n\n\n\n",
        "postTime": 1525250667,
        "uid": 36984,
        "name": "attack",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08NTT\uff09\u30112"
    },
    {
        "content": "# \u3010\u591a\u9879\u5f0f\u3011FFT\n\n## Preface\n\n\u672c\u6587\u5bf9\u6240\u6709 $\\LaTeX$ \u7f16\u8bd1\u540e\u751f\u6210\u7684\u6587\u672c\u5171\u6709\u5927\u7ea6 $7000$ \u5b57\uff0c\u5176\u4e2d\u524d\u534a\u90e8\u5206\u4e3a\u524d\u7f6e\u77e5\u8bc6\u90e8\u5206\uff0c\u4ecb\u7ecd\u4e86\u591a\u9879\u5f0f\u7684\u6709\u5173\u6982\u5ff5\u3001\u8fd0\u7b97\u6cd5\u5219\u4ee5\u53ca\u590d\u6570\u7684\u6982\u5ff5\u3001\u8fd0\u7b97\u6cd5\u5219\u4ee5\u53ca\u5355\u4f4d\u6839\u6709\u5173\u5185\u5bb9\uff0c\u5e76\u8bc1\u660e\u4e86\u8774\u8776\u64cd\u4f5c\u6240\u7528\u5230\u7684\u6709\u5173\u590d\u6570\u7684\u4e24\u4e2a\u91cd\u8981\u5f15\u7406\u516c\u5f0f\u3002\u5982\u679c\u4f60\u5bf9\u4e0a\u8ff0\u5185\u5bb9\u5df2\u7ecf\u6709\u4e86\u89e3\uff0c\u53ef\u4ee5\u8df3\u8fc7 ``Pre-knowledge`` \u90e8\u5206\u3002``Pre-knowledge`` \u90e8\u5206\u5927\u7ea6\u6709 $2000$ \u5b57\u3002\n\n\u672c\u6587\u90e8\u5206 $\\LaTeX$ \u5185\u5bb9\u5728 ``luogu`` \u7684\u9898\u89e3\u754c\u9762\u663e\u793a\u53ef\u80fd\u6bd4\u8f83\u4e11\u964b\uff0c\u56e0\u6b64\u5efa\u8bae\u60a8\u70b9\u51fb ``\u4eceTa\u7684\u535a\u5ba2\u67e5\u770b`` \u6765\u8fdb\u5165\u6211\u7684 ``luogu`` \u535a\u5ba2\u9605\u8bfb\u4e0b\u9762\u7684\u5185\u5bb9\u3002\n\n## Pre-knowledge\n\n### \u591a\u9879\u5f0f\n\n#### Definition\n\n\u79f0\u4e00\u4e2a\u5173\u4e8e $x$ \u7684\u5f0f\u5b50\n\n$$f(x) = \\sum_{i = 0}^{n} a_i \\times x^i$$\n\n\u4e3a\u4e00\u4e2a $n$ \u6b21\u591a\u9879\u5f0f\uff0c\u5176\u4e2d $a_i$ \u4e3a\u5e38\u6570\u3002\u79f0 $n$ \u4e3a $f(x)$ \u7684\u6b21\u6570\u3002\u663e\u7136\uff0c$f(x)$ \u53ef\u4ee5\u770b\u505a\u4e00\u4e2a\u5173\u4e8e $x$ \u7684 $n$ \u6b21\u51fd\u6570 $y = f(x)$\u3002\n\n\u56de\u5fc6\u521d\u4e2d\u89e3\u6790\u51e0\u4f55\u6700\u540e\u4e00\u4e2a\u5927\u9898\u7684\u7b2c\u4e00\u95ee\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u90fd\u662f\u7ed9\u5b9a\u4e09\u4e2a\u70b9\u7684\u5750\u6807\uff0c\u6c42\u4e00\u4e2a\u5173\u4e8e $x$ \u7684\u4e8c\u6b21\u66f2\u7ebf\u89e3\u6790\u5f0f\u65b9\u7a0b\u3002\u800c\u7c7b\u4f3c\u7684\u5982\u679c\u6c42\u4e00\u6761\u76f4\u7ebf\u7684\u89e3\u6790\u5f0f\uff0c\u5219\u9700\u8981\u7ed9\u51fa\u4e24\u4e2a\u70b9\u7684\u5750\u6807\u3002\n\n\u7c7b\u4f3c\u7684\uff0c\u5bf9\u4e8e\u5982\u679c\u60f3\u8981\u786e\u5b9a\u4e00\u4e2a $n$ \u6b21\u51fd\u6570\u7684\u89e3\u6790\u5f0f\uff0c\u5219\u9700\u8981 $n + 1$ \u4e2a\u70b9\u7684\u5750\u6807\u3002\u8fd9\u662f\u56e0\u4e3a\u4e00\u4e2a $n$ \u6b21\u51fd\u6570\u5171\u6709 $(n + 1)$ \u4e2a\u7cfb\u6570\uff0c\u6839\u636e\u67d0\u6211\u5fd8\u4e86\u540d\u5b57\u7684\u57fa\u672c\u5b9a\u7406\uff0c$n$ \u5143\u975e\u65e0\u89e3\u65b9\u7a0b\u7ec4\u6709\u552f\u4e00\u89e3\u7684\u5fc5\u8981\u6761\u4ef6\u662f\u6709 $n$ \u4e2a\u672c\u8d28\u4e0d\u540c\u7684\u65b9\u7a0b\uff0c\u56e0\u6b64\u8fd9\u91cc\u9700\u8981 $(n + 1)$ \u4e2a\u70b9\u6784\u9020\u51fa $(n + 1)$ \u4e2a\u65b9\u7a0b\uff0c\u624d\u80fd\u6c42\u51fa\u8fd9 $(n + 1)$ \u4e2a\u7cfb\u6570\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u53ea\u8981\u7ed9\u5b9a\u4e86 $(n + 1)$ \u4e2a\u70b9\u7684\u5750\u6807\uff0c\u5c31\u53ef\u4ee5\u552f\u4e00\u786e\u5b9a\u4e00\u4e2a $n$ \u6b21\u51fd\u6570\u7684\u89e3\u6790\u5f0f\uff0c\u8fdb\u800c\u4e5f\u5c31\u53ef\u4ee5\u786e\u5b9a\u8fd9\u4e2a\u591a\u9879\u5f0f\u3002\n\n\u90a3\u4e48\uff0c\u7ed9\u51fa $(n + 1)$ \u4e2a\u4e92\u4e0d\u76f8\u540c\u7684\u70b9\u7684\u5750\u6807\u6765\u786e\u5b9a\u4e00\u4e2a\u591a\u9879\u5f0f\u7684\u5f62\u5f0f\uff0c\u79f0\u4e3a\u591a\u9879\u5f0f\u7684**\u70b9\u503c\u8868\u793a\u6cd5**\u3002\u5bf9\u5e94\u7684\uff0c\u5199\u6210 $f(x) = \\sum_{i = 0}^{n} a_i \\times x^i$ \u5f62\u5f0f\u7684\u591a\u9879\u5f0f\u88ab\u79f0\u4e3a\u591a\u9879\u5f0f\u7684**\u7cfb\u6570\u8868\u793a\u6cd5**\u3002\n\n### Operation\n\n\u5728\u8fdb\u884c\u591a\u9879\u5f0f\u8fd0\u7b97\u65f6\uff0c\u5982\u679c\u4e24\u4e2a\u591a\u9879\u5f0f\u7684\u6b21\u6570\u4e0d\u4e00\u6837\uff0c\u6ce8\u610f\u5230\u5173\u4e8e\u591a\u9879\u5f0f\u6b21\u6570\u7684\u5b9a\u4e49\u4e2d\u6ca1\u6709\u89c4\u5b9a\u6700\u9ad8\u6b21\u9879\u7684\u7cfb\u6570\u4e0d\u80fd\u4e3a $0$\uff0c\u56e0\u6b64\u53ef\u4ee5\u8ba4\u4e3a\u6b21\u6570\u8f83\u4f4e\u7684\u591a\u9879\u5f0f\u7684\u6b21\u6570\u4e5f\u4e3a\u8f83\u9ad8\u7684\u6b21\u6570\u591a\u9879\u5f0f\u7684\u6b21\u6570\u3002\n\n\u5982\u679c\u4f7f\u7528\u70b9\u503c\u8868\u793a\u6cd5\u8fdb\u884c\u591a\u9879\u5f0f\u8fd0\u7b97\uff0c\u5219\u5fc5\u987b\u4fdd\u8bc1\u4e24\u4e2a\u591a\u9879\u5f0f\u6240\u7ed9\u70b9\u503c\u7684\u6a2a\u5750\u6807\u4e00\u4e00\u5bf9\u5e94\u76f8\u7b49\u3002\n\n\u4ee5\u4e0b\u8bbe $n$ \u6b21\u591a\u9879\u5f0f $A(x) = \\sum_{i = 0}^n a_i \\times x^i$\uff0c$B(x) = \\sum_{i = 0}^{n} b_i \\times x^i$\n\n\u591a\u9879\u5f0f\u52a0\u51cf\u6cd5\uff1a\n\n\u4e24\u4e2a $n$ \u6b21\u591a\u9879\u5f0f $A(x)$ \u548c $B(x)$ \u76f8\u52a0\u51cf\u7684\u7ed3\u679c\u4e3a\n\n$$f(x)~ = ~A(x) \\pm B(x)~ = ~\\sum_{i = 0}^{n} (a_i \\pm b_i) x^i$$\n\n\u591a\u9879\u5f0f\u4e58\u6cd5\uff1a\n\n\u4e24\u4e2a $n$ \u6b21\u591a\u9879\u5f0f $A(x)$ \u548c $B(x)$ \u76f8\u4e58\u7684\u7ed3\u679c\u662f\u4e00\u4e2a $2n$ \u6b21\u591a\u9879\u5f0f\n\n$$f(x)~=~A(x) \\times B(x)~=~\\sum_{i = 0}^n \\sum_{j = 0}^n a_i \\times b_j \\times x^{i + j}$$\n\n\u540c\u65f6\uff0c\u4e0a\u5f0f\u663e\u7136\u53ef\u4ee5\u5199\u6210\u8fd9\u79cd\u5f62\u5f0f\n\n$$f(x) = \\sum_{i = 0}^{2n} \\sum_{j = 0}^{\\min(i, n)} a_j \\times b_{i - j} \\times x^i$$\n\n\u5bf9\u4e8e\u70b9\u503c\u8868\u793a\u6cd5\uff0c\u7531\u4e8e $A(x) \\pm B(x)$ \u6216 $A(x) \\times B(x)$ \u672c\u8eab\u8868\u793a\u7684\u5c31\u662f\u4e24\u4e2a\u591a\u9879\u5f0f\u7684\u503c\u505a\u52a0\u51cf\u4e58\u6cd5\uff0c\u56e0\u6b64\u76f4\u63a5\u5c06\u5bf9\u5e94\u6a2a\u5750\u6807\u4f4d\u7f6e\u7684\u7eb5\u5750\u6807\u76f8\u52a0/\u51cf/\u4e58\u5373\u53ef\u3002\u9700\u8981\u7279\u522b\u6ce8\u610f\u7684\u662f\uff0c\u505a\u4e58\u6cd5\u65f6\uff0c\u9700\u8981 $A(x)$ \u548c $B(x)$ \u5404\u7ed9\u51fa $2n$ \u7ec4\u70b9\u503c\uff0c\u800c\u4e0d\u662f $n$ \u7ec4\u3002\n\n### \u590d\u6570\n\n#### Definition\n\n\u5b9a\u4e49\u5e38\u6570 $i$\uff0c\u6ee1\u8db3 \n\n$$i^2 = -1$$\n\n\u5219\u6240\u6709\u5f62\u5982 \n\n$$z = a + b \\times i,~~~a, b \\in R$$ \n\n\u7684\u6570\u5b57 $z$ \u6784\u6210\u7684\u96c6\u5408\u79f0\u4e3a\u590d\u6570\u96c6\uff0c\u8bb0\u4e3a $C$\uff0c$C$ \u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u90fd\u79f0\u4f5c\u590d\u6570\u3002\n\n\u5bf9\u4e8e $z = a + bi$\uff0c\u79f0 $a$ \u662f $z$ \u7684\u5b9e\u90e8\uff0c$b$ \u662f $z$ \u7684\u865a\u90e8\n\n#### Geometric Interpretation\n\n\u590d\u5e73\u9762\u662f\u4e00\u4e2a\u7b1b\u5361\u5c14\u5e73\u9762\uff0c\u6709\u4e24\u6761\u5750\u6807\u8f74\uff0c\u7eb5\u8f74\u4e3a\u865a\u8f74\uff0c\u6a2a\u8f74\u4e3a\u5b9e\u8f74\uff0c\u4e24\u8f74\u76f8\u4e92\u5782\u76f4\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u590d\u6570 $z = a + bi$\uff0c\u5b83\u5728\u590d\u5e73\u9762\u4e0a\u5bf9\u5e94\u4e00\u4e2a\u4ece\u539f\u70b9\u6307\u5411 $(a,~b)$ \u7684\u5411\u91cf\u3002\u4e5f\u5373\u5b9e\u8f74\u5750\u6807\u4e3a\u5b9e\u90e8\u503c\uff0c\u865a\u8f74\u5750\u6807\u4e3a\u865a\u90e8\u503c\u7684\u70b9\u3002\n\n\u663e\u7136\u590d\u5e73\u9762\u4e0a\u4ece\u539f\u70b9\u51fa\u53d1\u7684\u4efb\u610f\u4e00\u4e2a\u5411\u91cf\u4e5f\u5bf9\u5e94\u552f\u4e00\u7684\u4e00\u4e2a\u590d\u6570\uff0c\u4e5f\u5373\u5411\u91cf $(a, b)$ \u5bf9\u5e94\u4e00\u4e2a\u590d\u6570 $z = a + bi$\u3002\n\n\u6613\u8bc1\u590d\u6570\u4e0e\u590d\u5e73\u9762\u4e0a\u4ece\u539f\u70b9\u51fa\u53d1\u7684\u5411\u91cf\u662f\u4e00\u4e00\u5bf9\u5e94\u5173\u7cfb\u3002\n\n\u4ee5\u5b9e\u8f74\u6b63\u65b9\u5411\u4e3a\u59cb\u8fb9\uff0c$z$ \u6240\u5bf9\u5e94\u7684\u5411\u91cf $Z$ \u4e3a\u7ec8\u8fb9\u7684\u89d2 $\\theta$ \u79f0\u4e3a\u590d\u6570 $z$ \u7684\u5e45\u89d2\u3002\n\n#### Operation\n\n\u590d\u6570\u7684\u6a21\uff1a\n\n\u590d\u6570 $z= a + b_i$ \u7684\u6a21\u4e3a\u5176\u5728\u590d\u5e73\u9762\u4e0a\u5bf9\u5e94\u5411\u91cf\u7684\u957f\u5ea6\uff0c\u8bb0\u505a$|z|$\u3002\n\n$$|z| = \\sqrt{a^2 + b^2}$$\n\n\u5171\u8f6d\u590d\u6570\uff1a\n\n\u590d\u6570 $z$ \u5728\u590d\u5e73\u9762\u4e0a\u5bf9\u5e94\u7684\u5411\u91cf\u5173\u4e8e\u5b9e\u8f74\u5bf9\u79f0\u540e\u5bf9\u5e94\u7684\u590d\u6570\u79f0\u4e3a $z$ \u7684\u5171\u8f6d\u590d\u6570\uff0c\u8bb0\u505a $\\overline{z}$\n\n$z$ \u4e0e $\\overline z$ \u6ee1\u8db3\u5982\u4e0b\u5173\u7cfb\uff1a\n\n\u8bbe $z$ \u7684\u5e45\u89d2\u4e3a $\\theta_0$\uff0c$\\overline z$ \u7684\u5e45\u89d2\u4e3a $\\theta_1$\n\n$$\\theta_0 + \\theta_1 = \\pi$$\n\n$$|z| = |\\overline z|$$\n\n\u4e14\u4e24\u8005\u7684\u5b9e\u90e8\u76f8\u540c\uff0c\u865a\u90e8\u4e92\u4e3a\u76f8\u53cd\u6570\u3002\n\n\u590d\u6570\u52a0\u51cf\u6cd5\uff1a\n\n\u4e24\u4e2a\u590d\u6570 $z_1 = a_1 + b_1i,~z_2 = a_2 + b_2 i$ \u76f8\u52a0\u51cf\u7684\u7ed3\u679c\u4e3a\n\n$$z_0~=~z_1 \\pm z_2~=~(a_1 \\pm a_2) + (b_1 \\pm b_2)i$$\n\n\u5728\u590d\u5e73\u9762\u4e0a\uff0c\u4e24\u4e2a\u590d\u6570\u76f8\u52a0\u51cf\u7684\u7ed3\u679c\u4e3a\u4ed6\u4eec\u6240\u5bf9\u5e94\u7684\u5411\u91cf\u6309\u7167\u5e73\u884c\u56db\u8fb9\u5f62\u5b9a\u5219\u76f8\u52a0\u51cf\n\n\u590d\u6570\u4e58\u6cd5\uff1a\n\n\u4e24\u4e2a\u590d\u6570 $z_1 = a_1 + b_1i,~z_2 = a_2 + b_2 i$ \u76f8\u4e58\u7684\u7ed3\u679c\u4e3a\n\n$$z_0~=~z_1 \\times z_2~=~(a_1 + b_1i) \\times (a_2 + b_2i) = a_1a_2 + a_1b_2i + a_2b_1i + b_1b_2i^2$$\n\n\u53c8\u56e0\u4e3a\n\n$$i^2 = -1$$\n\n\u6240\u4ee5\n\n$$z_0~=~(a_1a_2 - b_1b_2) + (a_1b_2 + a_2b_1) i$$\n\n\u5728\u590d\u5e73\u9762\u4e0a\uff0c$z_1,~z_2,~z_0$ \u6240\u5bf9\u5e94\u7684\u5e45\u89d2 $\\theta_1,~\\theta_2,~\\theta_0$ \u6709\u5982\u4e0b\u5173\u7cfb\uff1a\n\n$$\\theta_0 = \\theta_1 + \\theta_2$$\n\n\u4ed6\u4eec\u7684\u6a21\u6709\u5982\u4e0b\u5173\u7cfb\n\n$$|z_0| = |z_1| \\times |z_2|$$\n\n\u8003\u8651 $z = a + b_i$ \u548c\u5b83\u7684\u5171\u8f6d\u590d\u6570 $\\overline z = a - bi$\n\n\u6709\n\n$$z \\times \\overline z~=~(a + bi) \\times (a - bi) = a^2 + b^2$$\n\n\u56e0\u6b64\u4e24\u4e2a\u4e92\u4e3a\u5171\u8f6d\u590d\u6570\u7684\u6570\u4e4b\u79ef\u4e00\u5b9a\u662f\u4e00\u4e2a\u5b9e\u6570\u3002\n\n\u590d\u6570\u9664\u6cd5\uff1a\n\n\u5bf9\u4e8e\u4e24\u4e2a\u590d\u6570 $z_1 = a_1 + b_1i,~z_2 = a_2 + b_2 i$\uff0c\u4ed6\u4eec\u76f8\u9664\u7684\u7ed3\u679c\u4e3a\n\n$$z_0 = \\frac{z_1}{z_2}$$\n\n\u8003\u8651\u5206\u6570\u4e0a\u4e0b\u540c\u65f6\u4e58 $\\overline{z_2}$\uff0c\u6709\n\n$$z_0~=~\\frac{z_1 \\overline {z_2}}{a_2^2 + b_2^2}$$\n\n\u5206\u6bcd\u662f\u4e00\u4e2a\u5b9e\u6570\uff0c\u53ef\u4ee5\u76f4\u63a5\u5c06\u5206\u5b50\u7684\u5b9e\u90e8\u865a\u90e8\u9664\u4ee5\u5206\u6bcd\u3002\n\n\u590d\u6570\u6307\u6570\u5e42\uff1a\n\n\u6709\u6b27\u62c9\u516c\u5f0f\n\n$$e^{i\\theta} = \\cos \\theta + i \\sin \\theta$$\n\n\u5176\u4e2d $e$ \u662f\u81ea\u7136\u5bf9\u6570\u7684\u5e95\u6570\n\n\u5f53\u53d6 $\\theta = \\pi$ \u65f6\uff0c\u6709\n\n$$e^{i\\pi} = \\cos \\pi + i \\sin \\pi$$\n\n\u53c8\u56e0\u4e3a $\\cos \\pi = 1,~sin \\pi = 0$\n\n\u6240\u4ee5 \n$$e^{i\\pi} = 1$$\n\n### \u5355\u4f4d\u6839\n\n#### Definition\n\n\u5728\u590d\u6570\u57df\u4e0b\uff0c\u6ee1\u8db3 $x^n = 1$ \u7684 $x$ \u88ab\u79f0\u4e3a $n$ \u6b21\u5355\u4f4d\u6839\n\n\u6839\u636e\u4ee3\u6570\u57fa\u672c\u5b9a\u7406\uff0c$n$ \u6b21\u5355\u4f4d\u6839\u4e00\u5171\u6709 $n$ \u4e2a\u3002\n\n\u7ecf\u8fc7\u8ba1\u7b97\u53ef\u5f97\uff0c\u5c06\u6240\u6709\u7684 $n$ \u6b21\u5355\u4f4d\u6839\u6309\u7167\u5e45\u89d2\u5927\u5c0f\u6392\u5217\uff0c\u7b2c $k$  $(0 \\leq k < n)$ \u4e2a $n$ \u6b21\u5355\u4f4d\u6839\u4e3a \n\n$$x_k~=~e^{i \\frac{2 k\\pi}{n}}$$\n\n#### Proof\n\n$$x_n^k~=~e^{i 2 k\\pi}$$\n\n\u6839\u636e\u6b27\u62c9\u516c\u5f0f\n\n$$e^{i2k\\pi} = \\cos 2k\\pi + i \\sin 2k\\pi$$\n\n\u53c8\u56e0\u4e3a \n\n$$\\cos 2k\\pi = 1,~~\\sin 2k\\pi~=~0$$\n\n\u6240\u4ee5 \n\n$$x_n^k = e^{i\\frac{2k\\pi}{n}}$$\n\n\u662f\u539f\u65b9\u7a0b\u7684\u4e00\u4e2a\u89e3\u3002\n\n\u663e\u7136\u8fd9 $n$ \u4e2a\u89e3\u662f\u4e92\u4e0d\u76f8\u540c\u7684\uff0c\u53c8\u6839\u636e\u4ee3\u6570\u57fa\u672c\u5b9a\u7406\uff0c\u8be5\u65b9\u7a0b\u6709\u4e14\u4ec5\u6709 $n$ \u4e2a\u89e3\u3002\u56e0\u6b64\u8be5\u65b9\u7a0b\u89e3\u7684\u4e0e $x_k$ \u4e00\u4e00\u5bf9\u5e94\u3002\u8bc1\u6bd5\u3002\n\n#### Property\n\n\u56e0\u4e3a $\\sin^2 \\theta + \\cos^2 \\theta~=~1$\uff0c\u6240\u4ee5\u6240\u6709\u7684 $n$ \u6b21\u5355\u4f4d\u6839\u7684\u6a21\u90fd\u662f $1$\u3002\n\n$n$ \u4e2a\u5355\u4f4d\u6839\u5728\u590d\u5e73\u9762\u4e0a\u5e73\u5206\u5355\u4f4d\u5706\u3002\u4ed6\u4eec\u4e0e\u5355\u4f4d\u5706\u7684 $n$ \u7b49\u5206\u7ebf\u6240\u5728\u7ebf\u6bb5\u5206\u522b\u91cd\u5408\u3002\n\n### \u672c\u539f\u5355\u4f4d\u6839\n\n#### Definition\n\n$0$ \u5230 $(n - 1)$ \u6b21\u65b9\u7684\u503c\u80fd\u751f\u6210\u6240\u6709 $n$ \u6b21\u5355\u4f4d\u6839\u7684 $n$ \u6b21\u5355\u4f4d\u6839\u79f0\u4e3a\u4e3a $n$ \u6b21\u672c\u539f\u5355\u4f4d\u6839\u3002\n\n\u663e\u7136 $x_1 = e^{i \\frac{2\\pi}{n}}$ \u662f\u4e00\u4e2a\u672c\u539f\u5355\u4f4d\u6839\u3002\n\n\u8bc1\u660e\u4e0a\u53ef\u4ee5\u8003\u8651\u5229\u7528\u590d\u5e73\u9762\u4e0a\u5355\u4f4d\u6839\u7b49\u5206\u5355\u4f4d\u5706\uff0c\u4e14\u4e24\u590d\u6570\u76f8\u4e58\u65f6\u5e45\u89d2\u76f8\u52a0\u6a21\u76f8\u4e58\u6765\u8bc1\u660e\uff0c\u8fd9\u91cc\u7565\u53bb\u3002\n\n\u8bb0 $n$ \u6b21\u672c\u539f\u5355\u4f4d\u6839\u4e3a $\\omega_n = e^{i \\frac{2\\pi}{n}} = \\cos \\frac{2\\pi}{n} + i \\sin \\frac{2\\pi}{n}$\u3002\n\n$n$ \u6b21\u672c\u539f\u5355\u4f4d\u6839\u53ef\u80fd\u4e0d\u6b62\u4e00\u4e2a\uff0c\u4f46\u662f\u4e0b\u6587\u7684\u201c\u672c\u539f\u5355\u4f4d\u6839\u201d\u7279\u6307 $e^{i \\frac{2\\pi}{n}}$\n\n#### Property\n\n\u8bbe $n$ \u662f\u4e00\u4e2a\u6b63\u5076\u6570\uff0c\u4e14 $n = 2m$\uff0c\u6709\uff1a\n\n$$(\\omega_{n}^k)^2~=~\\omega_m^k$$\n\n$$\\omega_n^{m + k}~=~-\\omega_{n}^k$$\n\n#### Proof\n\n\u4e00\u5f0f\uff1a\n\n\u8003\u8651\u4e24\u4e2a $\\omega_n^k$ \u76f8\u4e58\uff0c\u5e45\u89d2\u76f8\u52a0\uff0c\u4e3a\u4e4b\u524d\u5e45\u89d2\u7684\u4e24\u500d\uff0c\u800c\u6a21\u4e3a $1 \\times 1 = 1$\u3002\n\n\u6240\u4ee5\u76f8\u4e58\u7684\u7ed3\u679c\u4e3a\u4e00\u4e2a\u5e45\u89d2\u4e3a $\\omega_n^k$ \u5e45\u89d2\u4e24\u500d\u7684\u5355\u4f4d\u5411\u91cf\u3002\u5bb9\u6613\u9a8c\u8bc1 $\\omega_m^k$ \u7684\u5e45\u89d2\u662f $\\omega_n^k$ \u5e45\u89d2\u7684\u4e24\u500d\uff0c\u4e14\u6a21\u4e3a $1$\u3002\u7531\u4e8e\u5411\u91cf\u548c\u590d\u6570\u662f\u4e00\u4e00\u5bf9\u5e94\u7684\uff0c\u6240\u4ee5\u4e00\u5f0f\u6210\u7acb\u3002\n\n\u4e8c\u5f0f\uff1a\n\n\u663e\u7136 $\\omega_n^m$ \u7684\u5e45\u89d2\u4e3a $\\pi$\u3002\u7b49\u5f0f\u5de6\u8fb9\u53ef\u4ee5\u5199\u6210 $w_{n}^k \\times w_n^m$\uff0c\u5373\u4e3a $w_n^k$ \u7ed5\u539f\u70b9\u65cb\u8f6c $\\pi$ \u5f27\u5ea6\u3002\u6839\u636e\u5e73\u9762\u89e3\u6790\u51e0\u4f55\u5b9a\u7406\uff0c\u65cb\u8f6c\u524d\u540e\u7684\u4e24\u4e2a\u5411\u91cf\u6a2a\u7eb5\u5750\u6807\u5206\u522b\u4e92\u4e3a\u76f8\u53cd\u6570\u3002\u8bc1\u6bd5\u3002\n\n**Pre-knowledge\u90e8\u5206\u7ed3\u675f\u4e86\u3002**\n\n---\n\n## Algorithm\n\n\u8003\u8651\u5bf9\u4e24\u4e2a\u591a\u9879\u5f0f\u505a\u4e58\u6cd5\uff0c\u5982\u679c\u8fd0\u7528\u7cfb\u6570\u8868\u793a\u6cd5\uff0c\u663e\u7136\u9700\u8981 $O(n^2)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u800c\u5982\u679c\u5df2\u77e5\u4e24\u4e2a\u591a\u9879\u5f0f\u7684\u70b9\u503c\u8868\u793a\u6cd5\uff0c\u5219\u53ea\u9700\u8981 $O(n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002\u56e0\u4e3a\u53ea\u9700\u8981\u5c06\u5bf9\u5e94\u7684\u70b9\u503c\u7eb5\u5750\u6807\u76f8\u4e58\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u4f46\u662f\u6211\u4eec\u5c06\u4e00\u4e2a\u591a\u9879\u5f0f\u4ece\u7cfb\u6570\u8868\u793a\u6cd5\u6539\u4e3a\u70b9\u503c\u8868\u793a\u6cd5\uff08\u79f0\u4e3a\u6c42\u503c\uff09\u9700\u8981 $O(n^2)$ \u7684\u590d\u6742\u5ea6\uff08\u56e0\u4e3a\u6bcf\u4e2a\u6a2a\u5750\u6807\u90fd\u9700\u8981 $O(n)$ \u7684\u65f6\u95f4\u53bb\u8ba1\u7b97\uff09\uff0c\u800c\u5c06\u4e00\u4e2a\u70b9\u503c\u8868\u793a\u6cd5\u6539\u4e3a\u7cfb\u6570\u8868\u793a\u6cd5\uff08\u79f0\u4e3a\u63d2\u503c\uff09\u5219\u9700\u8981 $O(n^3)$ \u7684\u590d\u6742\u5ea6\u6765\u505a\u9ad8\u65af\u6d88\u5143\u3002\u4f46\u662f\u53ea\u8981\u6211\u4eec\u5c06\u8fd9\u4e24\u6b65\u90fd\u4f18\u5316\u81f3\u4f4e\u4e8e $O(n^2)$ \u7684\u590d\u6742\u5ea6\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u6bd4\u76f4\u63a5\u7528\u7cfb\u6570\u8868\u793a\u6cd5\u4e58\u66f4\u4f18\u7684\u505a\u6cd5\u3002\n\n\u800c\u6c42\u51fa\u4e00\u4e2a $n$ \u6b21\u591a\u9879\u5f0f\u5728\u6bcf\u4e2a $n$ \u6b21\u5355\u4f4d\u6839\u4e0b\u7684\u70b9\u503c\u7684\u8fc7\u7a0b\uff0c\u88ab\u79f0\u4e3a**\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362(Discrete Fourier Transform\uff0cDFT)**\uff0c\u800c\u5c06\u8fd9\u4e9b\u70b9\u503c\u91cd\u65b0\u63d2\u503c\u6210\u7cfb\u6570\u8868\u793a\u6cd5\u7684\u8fc7\u7a0b\uff0c\u53eb\u505a**\u79bb\u6563\u5085\u91cc\u53f6\u9006\u53d8\u6362(Inverse Discrete Fourier Transform,IDFT)**\u3002\n\n\u4ee5\u4e0b\u8bbe\u8fdb\u884c\u53d8\u6362\u7684\u591a\u9879\u5f0f\u4e3a $(n - 1)$ \u6b21\u591a\u9879\u5f0f $A(x) = \\sum_{i = 0}^{n - 1} a_i \\times x^i$\u3002\u5176\u4e2d $n$ \u662f $2$ \u7684\u6574\u6570\u5e42\u3002\u5982\u679c\u4e0d\u662f\u7684\u8bdd\uff0c\u5219\u5411 $A(x)$ \u7684\u66f4\u9ad8\u6b21\u6570\u4f4d $n$ \u8865\u5145 $a_n = 0$ \uff0c\u4ee4\u5176\u6210\u4e3a $n$ \u6b21\u591a\u9879\u5f0f\uff0c\u4e00\u76f4\u8fdb\u884c\u76f4\u5230\u5176\u6b21\u6570+1\u7684\u503c\u662f $2$ \u7684\u6574\u6570\u5e42\uff0c\u53d6 $n$ \u7b49\u4e8e\u5176\u6b21\u6570\uff0c$m = \\frac{n}{2}$\u3002\n\n### DFT\n\n\u8003\u8651\u6c42\u51fa\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u6570\u5217 $\\{b_i\\}$\uff0c\u8fd9\u4e2a\u6570\u5217\u7684\u7b2c $k$ \u9879\u4e3a $A(x)$ \u5728 $n$ \u6b21\u5355\u4f4d\u6839\u7684 $k$ \u6b21\u5e42\u5904\u7684\u70b9\u503c\u3002\n\n\u56e0\u6b64\u6709 \n\n$$b_k~=~\\sum_{i = 0}^{n - 1} a_i \\times \\omega_{n}^i$$\n\n\u6ce8\u610f\u4e0a\u5f0f\u4e2d\u7684 $i$ \u4e3a $\\Sigma$ \u5faa\u73af\u7684\u5faa\u73af\u53d8\u91cf\uff0c\u800c\u4e0d\u662f $-1$ \u7684\u4e8c\u6b21\u65b9\u6839\u3002\n\n\u8fd9\u4e2a\u8fc7\u7a0b\u662f $O(n^2)$ \u7684\uff0c\u6211\u4eec\u8003\u8651\u4f7f\u7528**\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362(Fast Fourier Transform\uff0cFFT)**\u6765\u4f18\u5316\u8fd9\u4e2a\u8fc7\u7a0b\u3002\n\n### FFT\n\n\u6211\u4eec\u8003\u8651\u5bf9 $A(x)$ \u6309\u7167\u7cfb\u6570\u89d2\u6807\u7684\u5947\u5076\u6027\u5206\u7c7b\uff0c\u5373\n\n$$A(x)~=~\\sum_{i = 0}^{n - 1} a_i x^i~=~\\sum_{i = 0}^m a_{2i} \\times x^{2i} + \\sum_{i = 0}^m a_{2i + 1} \\times x^{2^i + 1}$$\n\n\u5bf9\u4e8e\u4e0a\u5f0f\u7684\u540e\u534a\u90e8\u5206\uff0c\u63d0\u51fa\u4e00\u4e2a $x$\uff0c\u5f97\u5230\n\n$$A(x)~=~\\sum_{i = 0}^{m - 1} a_{2i} x^{i2} + x\\sum_{i = 0}^{m - 1} a_{2i + 1} x^{2i}~=~\\sum_{i = 0}^{m - 1} a_{2i} (x^{2})^{i} + x\\sum_{i = 0}^{m - 1} a_{2i + 1} (x^2)^{i}$$\n\n\u8bbe $A_0(x)$ \u662f\u4e00\u4e2a $(m - 1)$ \u6b21\u591a\u9879\u5f0f\uff0c\u6ee1\u8db3\n\n$$A_0~=~\\sum_{i = 0}^{m - 1} a_{2i} x^i$$\n\n\u8bbe $A_1(x)$ \u662f\u4e00\u4e2a $(m - 1)$ \u6b21\u591a\u9879\u5f0f\uff0c\u6ee1\u8db3\n\n$$A_1~=~\\sum_{i = 0}^{m - 1} a_{2i + 1}x^i$$\n\n\u8054\u7acb\u4ee5\u4e0a\u4e09\u5f0f\uff0c\u53ef\u4ee5\u5f97\u5230\n\n$$A(x)~=~A_0(x^2) + x \\times A_1(x^2)$$\n\n\u5982\u679c\u6c42\u51fa\u4e86 $A_0$ \u548c $A_1$ \u5728\u5404\u70b9\u7684\u70b9\u503c\uff0c\u7531\u4e8e\u4e0a\u5f0f\u53ef\u4ee5 $O(1)$ \u8ba1\u7b97\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5 $O(n)$ \u8ba1\u7b97 $A(x)$ \u5728\u5404\u4e2a\u70b9\u7684\u70b9\u503c\u4e86\u3002\u800c\u6c42 $A_0$ \u548c $A_1$ \u7684\u8fc7\u7a0b\u548c\u6c42 $A$ \u7684\u8fc7\u7a0b\u5b8c\u5168\u4e00\u81f4\uff0c\u56e0\u6b64\u53ef\u4ee5\u9012\u5f52\u5904\u7406\u3002\n\n\u4f46\u662f\u5f88\u9057\u61be\uff0c\u6211\u4eec $A_0$ \u548c $A_1$ \u5404\u9700\u8981\u9012\u5f52\u4e00\u6b21\uff0c\u6839\u636e\u4e3b\u5b9a\u7406\uff0c\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n^2)$ \u7684\u3002\n\n\u4f46\u662f\u8003\u8651\u6211\u4eec\u6c42\u7684\u662f\u5728 $n$ \u6b21\u5355\u4f4d\u6839\u7684\u5404\u4e2a\u5e42\u6b21\u4e0b\u7684\u70b9\u503c\uff0c\u6839\u636e ``Pre-Knowledge`` \u7684\u6700\u540e\u4e00\u90e8\u5206\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u516c\u5f0f\n\n$$(\\omega_{n}^k)^2~=~\\omega_m^k$$\n\n$$\\omega_n^{m + k}~=~-\\omega_{n}^k$$\n\n\u7b2c\u4e8c\u4e2a\u5f0f\u5b50\u4f7f\u5f97\u6211\u4eec\u8003\u8651\u5c0f\u4e8e $m$ \u6b21\u7684\u70b9\u503c\u548c\u5927\u4e8e $m$ \u6b21\u70b9\u503c\u4e4b\u95f4\u7684\u5173\u7cfb\u3002\n\n\u5bf9\u4e8e $0 \\leq k < m$\uff0c\u6211\u4eec\u6709\n\n$$A(\\omega_n^k)~=~A_0((\\omega_n^k)^2) + w_n^kA_1((\\omega_n^k)^2)$$\n\n\u6839\u636e\u4e0a\u9762\u7684\u7b2c\u4e00\u4e2a\u516c\u5f0f\uff0c\u5316\u7b80\u5f97\u5230\n\n$$A(\\omega_n^k)~=~A_0(\\omega_m^k) + w_n^kA_1(\\omega_m^k)$$\n\n\u8fd9\u53ea\u662f\u524d\u534a\u90e8\u5206\u7684\u6b21\u6570\uff0c\u6211\u4eec\u8003\u8651\u540e\u534a\u90e8\u5206\u6b21\u6570\uff1a\n\n$$A(\\omega_n^{m + k})~=~A_0((\\omega_n^{m + k})^2) + \\omega_n^{m + k} A_1((\\omega_n^{m + k})^2)$$\n\n\u6839\u636e\u7b2c\u4e8c\u4e2a\u516c\u5f0f\uff0c\u5316\u7b80\u5f97\u5230\n\n$$A(\\omega_n^{m + k})~=~A_0((w_n^k)^2)+-\\omega_n^k A_1((\\omega_n^k)^2)$$\n\n\u518d\u5e94\u7528\u7b2c\u4e00\u4e2a\u516c\u5f0f\u5f97\u5230\n\n$$A(\\omega_n^{m + k})~=~A_0(\\omega_m^k) - w_n^kA_1(\\omega_m^k)$$\n\n\u6211\u4eec\u60ca\u559c\u7684\u53d1\u73b0\uff0c\u5927\u4e8e $m$ \u6b21\u7684\u70b9\u503c\u53ef\u4ee5\u7531 $A_0$ \u548c $A_1$ \u5728\u5c0f\u4e8e $m$ \u6b21\u7684\u70b9\u503c\u6c42\u51fa\u3002\u53ea\u8981\u6c42\u51fa\u4e86 $A_0$ \u548c $A_1$ \u5728\u5c0f\u4e8e $m$ \u6b21\u7684\u70b9\u503c\uff0c\u5c31\u53ef\u4ee5\u7ebf\u6027\u6c42\u51fa $A$ \u5728\u6574\u4e2a $n$ \u6b21\u5e42\u5904\u7684\u70b9\u503c\u3002\u800c\u6c42 $A_0$ \u548c $A_1$ \u5728\u5c0f\u4e8e $m$ \u6b21\u7684\u70b9\u503c\u4e5f\u662f\u53ef\u4ee5\u9012\u5f52\u6c42\u89e3\u7684\u3002\n\n\u8003\u8651\u65f6\u95f4\u590d\u6742\u5ea6\uff1a\u9012\u63a8\u5173\u7cfb\u4e3a $T(n)~=~2T(n / 2) + O(n)$\u3002\u56e0\u4e3a $O(n)~=~\\Theta(n)$\uff0c\u6240\u4ee5 $T(n)~=~\\Theta(n^{\\log_2^2} \\log n) = \\Theta(n \\log n)$\u3002\n\n\u7531\u6b64\uff0c\u5f97\u5230\u4e86\u5feb\u901f\u8ba1\u7b97 ``DFT`` \u7684\u529e\u6cd5\uff0c\u5e76\u8bc1\u660e\u4e86\u5176\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n \\log n)$\u3002\u8fd9\u79cd\u65b9\u6cd5\u88ab\u5373\u4e3a ``FFT``\u3002\n\n\u4e0a\u9762\u63a8\u5bfc\u51fa $A(\\omega_n^k)$ \u548c $A(\\omega_n^{m + k})$ \u7684\u503c\u7684\u5f0f\u5b50\u88ab\u79f0\u4e3a**\u8774\u8776\u64cd\u4f5c(Butterfly Operation)**\u3002\u8fd9\u4e2a\u540d\u5b57\u7684\u7531\u6765\u662f\u5982\u679c\u5c06 $A$ \u5728\u5404\u5904\u7684\u70b9\u503c\u753b\u6210\u4e00\u4e2a\u957f\u6761\u5f62\u7684\u6570\u7ec4\uff0c\u5728\u6570\u7ec4\u4e0b\u9762\u4e00\u6b21\u4f9d\u6b21\u662f $n$ \u6b21\u672c\u539f\u5355\u4f4d\u6839\u7684 $0 \\sim m - 1$ \u6b21\u5e42\uff0c\u5219\u6c42\u503c\u8fc7\u7a0b\u53ef\u4ee5\u753b\u6210 $\\omega_n^0$ \u8fde\u4e00\u6761\u8fb9\u5411 $A(\\omega_n^0),~A(\\omega_n^{\\frac{n}{2} - 1})$\uff1b\u800c $\\omega_n^1$ \u8fde\u5411 $A(\\omega_n^1),~A(\\omega_n^\\frac{n}{2})$\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002\u753b\u51fa\u7684\u56fe\u5f62\u5982\u540c\u8774\u8776\u7684\u7fc5\u8180\u3002\n\n### IDFT\n\n\u81f3\u6b64\uff0c\u6211\u4eec\u5df2\u7ecf\u6709\u4e86 $O(n \\log n)$ \u7684\u7b97\u6cd5\u6765\u8ba1\u7b97\u4e24\u4e2a\u7cfb\u6570\u8868\u793a\u6cd5\u7684\u591a\u9879\u5f0f\u76f8\u4e58\u540e\u7684\u70b9\u503c\u8868\u793a\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u53ea\u9700\u8981\u7528 $O(n \\log n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5b8c\u6210\u63d2\u503c\u7684\u8fc7\u7a0b\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u5b8c\u6574\u7684 $O(n \\log n)$ \u7684\u7cfb\u6570\u578b\u591a\u9879\u5f0f\u4e58\u6cd5\u7b97\u6cd5\u4e86\u3002\n\n\u6211\u4eec\u76ee\u524d\u5df2\u77e5\u4e00\u4e2a $(n - 1)$ \u6b21\u591a\u9879\u5f0f $A(x)~=~\\sum_{i = 0}^{n - 1} a_i x^i$ \u8fdb\u884c\u4e86\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362\u540e\u7684\u70b9\u503c $\\{b_i\\}$\uff0c\u5373\n\n$$b_k~=~\\sum_{i = 0}^{n - 1} a_i \\times \\omega_n^{ik}$$\n\n\u73b0\u5728\u8bd5\u56fe\u8fd8\u539f\u7cfb\u6570\u6570\u5217 $\\{a_i\\}$\u3002\n\n\u63a8\u5bfc\u8fc7\u7a0b\u6bd4\u8f83\u590d\u6742\uff0c\u6211\u4eec\u76f4\u63a5\u7ed9\u51fa\u7ed3\u8bba\uff1a\n\n$$a_k~=~\\frac{1}{n} \\sum_{i = 0}^{n - 1} b_i \\omega_n^{-ki}$$\n\n\u4e0b\u9762\u8bc1\u660e\u4e0a\u9762\u8fd9\u4e2a\u5f0f\u5b50\u662f ``DFT`` \u5f0f\u5b50(\u5373\u4e0a\u9762\u8ba1\u7b97 $b_k$ \u7684\u5f0f\u5b50)\u7684\u9006\u53d8\u6362\u3002\n\n\u6211\u4eec\u9996\u5148\u5c06 ``DFT`` \u7684\u5f0f\u5b50\u5e26\u5165 $\\sum_{i = 0}^{n - 1} b_i \\omega_n^{-ki}$\n\n\u5f97\u5230\u4e0a\u5f0f\u4e3a\n\n![qwq](https://cdn.luogu.com.cn/upload/image_hosting/6qzo0fls.png)\n\n\uff08\u8fd9\u91cc\u4f7f\u7528\u622a\u56fe\u7684\u539f\u56e0\u662f\u4f60\u8c37\u7684\u591a\u884c\u516c\u5f0f\u6e32\u67d3\u6709\u70b9\u95ee\u9898\uff0c\u5efa\u8bae\u67e5\u770b\u5927\u56fe\uff09\u3002\n\n\u8003\u8651\u5206\u7c7b\u8ba8\u8bba\u3002\n\n1\u3001\u5f53 $j = k$ \u65f6\uff1a\n\n\u5219 $j - k = 0$\uff0c\u56e0\u6b64 $\\omega_{n}^{i(j - k)} = \\omega_n^0 = 1$\u3002\u4e8e\u662f \n\n$$\\sum_{i = 0}^{n - 1} \\omega_n^{i(j - k)}~=~n \\times 1 = n$$\n\n2\u3001\u5f53 $j \\neq k$ \u65f6\uff1a\n\n\u663e\u7136 $|j - k| < n$\uff0c\u56e0\u6b64 $\\omega_n^{j - k} \\neq 1$\uff0c\u5219 $\\sum_{i = 0}^{n - 1} \\omega_n^{(j - k) i}$ \u662f\u4e00\u4e2a\u516c\u6bd4\u4e0d\u4e3a $1$ \u7684\u7b49\u6bd4\u6570\u5217\u524d\u7f00\u548c\u3002\u6839\u636e\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u516c\u5f0f\u5f97\u5230\n\n$$\\sum_{i = 0}^{n - 1} \\omega_n^{(j - k) i}~=~\\frac{1 - \\omega_n^{(n - 1)(j - k)} \\times \\omega_n^{j - k}}{1 - \\omega_{n}^{j - k}}~=~\\frac{1 - \\omega_n^{n(j - k)}}{1 - \\omega_{n}^{j - k}}~=~\\frac{1 - (\\omega_n^{(j - k)})^n}{1 - \\omega_{n}^{j - k}}$$\n\n\u6839\u636e\u590d\u6570\u7684\u51e0\u4f55\u6027\u8d28\uff0c\u6613\u8bc1\u5bf9\u4e8e\u6240\u6709\u7684 $n$ \u6b21\u5355\u4f4d\u6839 $T$\uff0c$T^{x + n}~=~T^{x}$\uff0c\u5176\u4e2d $x$ \u4e3a\u4efb\u610f\u6574\u6570\u3002\n\n$\\sum_{i = 0}^{n - 1} \\omega_n^{(j - k) i}~=~\\frac{1 - (\\omega_n^{(j - k)})^0}{1 - \\omega_{n}^{j - k}}~=~\\frac{1 - 1}{1 - \\omega_n^{j - k}}~=~0$\n\n\u7b2c\u4e8c\u79cd\u60c5\u51b5\u7684\u8bc1\u660e\u88ab\u79f0\u4e3a**\u6d88\u53bb\u5f15\u7406**\u3002\n\n\u7efc\u4e0a\u8ba8\u8bba\uff0c\u5f53 $j \\neq k$ \u65f6\uff0c\u56e0\u4e3a\u53e6\u4e00\u4e2a\u56e0\u6570\u662f $0$\uff0c\u524d\u9762\u7684 $\\sum a_j$ \u4e0d\u4f1a\u5bf9\u5f0f\u5b50\u4ea7\u751f\u8d21\u732e\uff0c\u800c $j = k$ \u65f6\uff0c\u4f1a\u5bf9\u7b54\u6848\u4ea7\u751f $n$ \u500d\u7684\u8d21\u732e\u3002\n\n\u539f\u5f0f\u53ef\u4ee5\u5199\u6210\n\n$$\\sum_{i = 0}^{n - 1} b_i \\omega_n^{-ki}~=~~\\sum_{j = 0}^{n - 1} a_j \\times \\sum_{i = 0}^{n - 1} \\omega_n^{i(j - k)}~=~\\sum_{j = 0}^{n - 1} a_j \\times [j = k] \\times n~=~a_k \\times n$$\n\n\u5c06\u4e0a\u5f0f\u5e26\u5165 ``IDFT`` \u7684\u5f0f\u5b50 $a_k~=~\\frac{1}{n} \\sum_{i = 0}^{n -1} b_i \\omega_n^{-ki}$ \u7684\u53f3\u8fb9\uff0c\u5f97\u5230\n\n$$\\text{\u53f3\u8fb9}~=~\\frac{1}{n} a_k \\times n~=~a_k~=~\\text{\u5de6\u8fb9}$$\n\n\u7c7b\u4f3c\u7684\uff0c\u53ef\u4ee5\u8bc1\u660e\u5c06 ``IDFT`` \u7684\u5f0f\u5b50\u5e26\u5165 ``DFT`` \u4e5f\u662f\u53ef\u4ee5\u4f7f\u7b49\u5f0f\u6210\u7acb\u7684\uff0c\u8fd9\u91cc\u7565\u53bb\u3002\n\n\u7531\u6b64\uff0c\u6211\u4eec\u8bc1\u660e\u4e86\u53d8\u6362\n\n$$a_k~=~\\frac{1}{n} \\sum_{i = 0}^{n - 1} b_i \\omega_n^{-ki}$$\n\n\u662f ``DFT`` \u7684\u9006\u53d8\u6362\uff0c\u79f0\u4e3a ``IDFT``\u3002\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u5f0f\u5b50\u6c42\u51fa\u8fd9\u4e2a\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u8868\u793a\u6cd5\u3002\n\n#### IFFT\n\n\u4e0b\u9762\u7684\u95ee\u9898\u662f\u5982\u4f55\u7528\u8f83\u4f4e\u7684\u590d\u6742\u5ea6\u8ba1\u7b97 $B(x)~=~\\sum_{i = 0}^{n - 1} b_i \\times x^i$ \u5728 $w_n^{-ki}$\uff0c\u5176\u4e2d $0 \\leq k < n$ \u5904\u7684\u70b9\u503c\u3002\n\n\u800c $w_n^{-k}$ \u53ef\u4ee5\u770b\u505a $n$ \u6b21\u672c\u539f\u5355\u4f4d\u6839\u6bcf\u6b21\u9006\u65f6\u9488\u65cb\u8f6c\u672c\u539f\u5355\u4f4d\u6839\u5e45\u89d2\u7684\u5f27\u5ea6\uff0c\u56e0\u6b64 $\\omega_n^{-k}$ \u548c $\\omega_n^k$ \u662f\u4e00\u4e00\u5bf9\u5e94\u7684\u3002\u5177\u4f53\u7684\uff0c$w_n^{-k} = w_n^{k + n}$\u3002\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u4f7f\u7528 ``FFT`` \u7684\u65b9\u6cd5\uff0c\u6c42\u51fa $B(x)$ \u5728 $\\omega_n$ \u5404\u4e2a\u5e42\u6b21\u4e0b\u7684\u503c\uff0c\u7136\u540e\u6570\u7ec4\u53cd\u8fc7\u6765\uff0c\u5373\u4ee4 $a_k~=~\\frac{1}{n} \\sum_{i = 0}^n B(w_n^{n - k})$ \u5373\u53ef\u3002\n\n\u8fd9\u4e00\u6b65\u5feb\u901f\u8ba1\u7b97\u63d2\u503c\u7684\u8fc7\u7a0b\u53eb\u505a**\u5feb\u901f\u5085\u91cc\u53f6\u9006\u53d8\u6362(Inverse Fast Fourier Transform\uff0cIFFT)**\u3002\n\n\u81f3\u6b64\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n \\log n)$ \u7684\u591a\u9879\u5f0f\u4e58\u6cd5\u8ba1\u7b97\u65b9\u6cd5\u3002\n\n## Code\n\n\u6839\u636e\u4e0a\u9762\u7684\u63a8\u5bfc\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u8f7b\u677e\u7684\u5199\u51fa ``FFT`` \u7684\u9012\u5f52\u5f62\u5f0f\uff1a\n\n```cpp\nvoid FFT(std::complex<double> *A, int N) {\n  if (N == 1) {\n    return;\n  }\n  int M = N >> 1;\n  std::complex<double> A0[M], A1[M];\n  for (int i = 0; i < M; ++i) {\n    A0[i] = A[i << 1];\n    A1[i] = A[(i << 1) | 1];\n  }\n  FFT(A0, M); FFT(A1, M);\n  auto W = std::complex<double>(cos(1.0 * PI / M), sin(1.0 * PI / M)), w = std::complex<double>(1.0, 0.0);\n  for (int i = 0; i < M; ++i) {\n    A[i] = A0[i] + w * A1[i];\n    A[i + M] = A0[i] - w * A1[i];\n    w *= W;\n  }\n}\n```\n\n\u4ee5\u53ca ``IFFT``\uff1a\n\n```cpp\nvoid IFFT(std::complex<double> *A, int N) {\n  FFT(A, n)\n  std::reverse(A + 1, A + N);\n}\n```\n\n\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u56e0\u4e3a $\\omega_n^0~=~\\omega_n^n$\uff0c\u6240\u4ee5\u662f\u7b2c $1$ \u4e2a\u70b9\u503c\u548c\u7b2c $N - 1$ \u4e2a\u4ea4\u6362\uff0c\u800c\u4e0d\u662f\u7b2c $0$ \u4e2a\u70b9\u503c\u548c\u7b2c $N - 1$ \u4e2a\u4ea4\u6362\u3002\n\n## optimization\n\n\u4e0a\u9762\u8fd9\u4e2a ``FFT`` \u4ea4\u5230 ``luogu`` \u4e0a\u4ee5\u540e\u53ea\u6709 $77$ \u5206\u3002\u4ed6\u7684\u590d\u6742\u5ea6\u663e\u7136\u662f $O(n \\log n)$ \u7684\uff0c\u4f46\u662f\u9012\u5f52\u548c\u52a8\u6001\u5f00\u7a7a\u95f4\u5e26\u6765\u7684\u5de8\u5927\u5e38\u6570\u8ba9\u4ed6\u96be\u4ee5\u901a\u8fc7 $10^6$ \u7684\u6570\u636e\u3002\n\n\u6211\u4eec\u8003\u8651\u4f18\u5316\u4e0a\u9762\u7684\u4ee3\u7801\u3002\n\n\u9996\u5148\u6211\u4eec\u6ce8\u610f\u5230\u6211\u4eec\u52a8\u6001\u7533\u8bf7\u548c\u5220\u9664\u4e86 $O(n \\log n)$ \u7684\u7a7a\u95f4\uff0c\u4f46\u662f\u6211\u4eec\u540c\u4e00\u65f6\u523b\u53ea\u6700\u591a\u9700\u8981 $2N$ \u7684\u7a7a\u95f4\uff0c\u800c\u9012\u5f52\u8c03\u7528\u53c8\u662f\u6808\u5f0f\u7684\uff0c\u5373\u5148\u7533\u8bf7\u7684\u540e\u5220\u9664\u3002\u8fd9\u610f\u5473\u7740\u5982\u679c\u7528\u4e00\u4e2a\u6570\u7ec4\u505a\u5185\u5b58\u6c60\uff0c\u6ca1\u6709\u88ab\u5206\u914d\u7684\u5185\u5b58\u603b\u662f\u8fde\u7eed\u7684\uff0c\u88ab\u5206\u914d\u7684\u5185\u5b58\u4e5f\u603b\u662f\u8fde\u7eed\u7684\u3002\u5e76\u4e14\u5206\u914d\u4e00\u4e2a\u6570\u7ec4\u53ef\u4ee5 $O(1)$ \u800c\u4e0d\u662f $O(size)$ \u5b8c\u6210\u3002\n\n\u7136\u800c\u8fd9\u4e2a\u4f18\u5316\u5e76\u6ca1\u6709\u4ec0\u4e48\u5375\u7528\u3002\n\n\u6211\u4eec\u8003\u8651\u5c06\u4e0a\u9762\u7684\u9012\u5f52\u6539\u6210\u8fed\u4ee3\u3002\n\n\u65e2\u7136\u9012\u5f52\u662f\u81ea\u4e0a\u800c\u4e0b\u7684\uff0c\u90a3\u4e48\u6211\u4eec\u7684\u8fed\u4ee3\u5c31\u662f\u4e00\u4e2a\u81ea\u4e0b\u800c\u4e0a\u7684\u5408\u5e76\u8fc7\u7a0b\u3002\u5f53 $n = 8$ \u65f6\uff0c\u6211\u4eec\u8003\u8651\u9012\u5f52\u65f6\u8c03\u7528\u539f\u591a\u9879\u5f0f\u7cfb\u6570\u4e0b\u6807\u7684\u9012\u5f52\u6811\uff1a\n\n```\nstep 1: 0 1 2 3 4 5 6 7\nstep 2: 0 2 4 6,  1 3 5 7\nstep 3: 0 4,  2 6,  1 3,  5 7\nstep 4: 0,  4,  2,  6,  1,  3,  5,  7\n```\n\n\u4e0a\u8868\u7684 ``step`` \u4ee3\u8868\u4e86\u9012\u5f52\u7684\u5c42\u6570\uff0c\u5192\u53f7\u540e\u7684\u6570\u5b57\u4ee3\u8868\u6570\u5b57\u7684\u4e0b\u6807\u3002\u6211\u4eec\u8003\u5bdf\u6700\u540e\u7b97\u7684\u4e00\u5c42\uff0c\u4e5f\u5c31\u662f\u7b2c $4$ \u5c42\u7684\u4e8c\u8fdb\u5236\u503c\uff1a\n\n```\n000, 100, 010, 110, 001, 011, 101, 111\n```\n\n\u770b\u8d77\u6765\u8fd8\u662f\u6ca1\u6709\u5934\u7eea\uff0c\u4f46\u662f\u6211\u4eec\u5c06\u4e8c\u8fdb\u5236\u503c\u53cd\u8fc7\u6765\n\n```\n000, 001, 010, 011, 100, 110, 101, 111\n```\n\n\u6211\u4eec\u53d1\u73b0\u4e0a\u9762 $8$ \u4e2a\u4e8c\u8fdb\u5236\u7684\u6392\u5217\u662f\u5355\u8c03\u9012\u589e\u7684\uff0c\u5728\u5341\u8fdb\u5236\u4e0b\u5206\u522b\u662f\n\n```\n0, 1, 2, 3, 4, 5, 6, 7\n```\n\n\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u5c06\u6570\u5217 $\\{a\\}$ \u6309\u7167\u4e0b\u6807\u4e8c\u8fdb\u5236\u7ffb\u8f6c\u540e\u7684\u5927\u5c0f\u6392\u5e8f\uff0c\u5f97\u5230\u5e8f\u5217 $\\{a'\\}$\u3002\u9012\u5f52\u5012\u6570\u7b2c\u4e8c\u5c42\u5bf9\u4e8e $\\{a\\}$ \u7684\u8774\u8776\u64cd\u4f5c\u5c31\u53d8\u6210\u4e86\u5bf9\u4e8e $\\{a'\\}$ \u76f8\u90bb\u4e24\u4e2a\u6570\u8fdb\u884c\u5408\u5e76\u3002\u800c\u4e0a\u9762\u51e0\u5c42\u540c\u7406\u3002\n\n\u56e0\u6b64\u95ee\u9898\u53d8\u6210\u4e86\u5982\u4f55\u5728 $O(n \\log n)$ \u7684\u65f6\u95f4\u5185\u5c06\u5e8f\u5217\u6309\u7167\u4e0b\u6807\u4e8c\u8fdb\u5236\u7ffb\u8f6c\u540e\u6392\u5e8f\u5f97\u5230\u7684\u5e8f\u5217\u3002\n\n\u663e\u7136\u5bf9\u4e8e\u4efb\u4f55\u4e00\u4e2a\u6570\u6211\u4eec\u90fd\u53ef\u4ee5 $O(\\log n)$ \u7684\u8fd0\u7528\u8fdb\u5236\u8f6c\u6362\u6765\u786e\u5b9a\u5176\u4e8c\u8fdb\u5236\u9006\u5e8f\u503c\uff0c\u4f46\u662f\u8fd9\u6837\u56e0\u4e3a\u6d89\u53ca\u5230\u4e86\u5927\u91cf\u7684\u9664\u6cd5\u548c\u53d6\u6a21\uff0c\u5e38\u6570\u5f88\u5927\uff0c\u6211\u4eec\u8003\u8651\u89c4\u907f\u8fd9\u4e2a\u505a\u6cd5\u3002\n\n\u6211\u4eec\u8003\u8651\u57fa\u6570\u6392\u5e8f\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u4e00\u4e2a\u6570\u7684\u6570\u4f4d\u5206\u4e3a\u4e24\u534a\uff0c\u5148\u5bf9\u540e\u534a\u90e8\u5206\u6570\u4f4d\u6784\u6210\u7684\u6570\u8fdb\u884c\u6392\u5e8f\uff0c\u7136\u540e\u518d\u5bf9\u524d\u534a\u90e8\u5206\u6570\u4f4d\u6784\u6210\u7684\u6570\u8fdb\u884c\u6392\u5e8f\u3002\u4e24\u4e2a\u6570\u5b57\u7684\u524d\u534a\u90e8\u5206\u6570\u4f4d\u5982\u679c\u76f8\u540c\uff0c\u90a3\u4e48\u5b83\u4eec\u7684\u5148\u540e\u987a\u5e8f\u5373\u4e3a\u540e\u534a\u90e8\u5206\u6570\u4f4d\u7684\u5148\u540e\u987a\u5e8f\u3002\u8fd9\u6837\u7531\u4e8e\u540e\u534a\u90e8\u5206\u672c\u8eab\u662f\u6709\u5e8f\u7684\uff0c\u5c31\u53ef\u4ee5\u81ea\u4f4e\u4f4d\u5411\u9ad8\u4f4d\u5bf9\u6570\u5217\u8fdb\u884c\u6392\u5e8f\u3002\n\n\u540c\u6837\u7684\uff0c\u6211\u4eec\u81ea\u4f4e\u4f4d\u5411\u9ad8\u4f4d\u5bf9\u6bcf\u4e2a\u6570\u7684\u4e8c\u8fdb\u5236\u9006\u5e8f\u6392\u5e8f\u3002\n\n\u521d\u59cb\u65f6\uff0c\u5e8f\u5217\u91cc\u53ea\u6709\u4e24\u4e2a\u6570\n\n```\n000, 100\n```\n\n\u4ed6\u4eec\u9006\u5e8f\u540e\u4e3a\n\n```\n000, 001\n```\n\n\u5206\u522b\u662f\u6700\u5c0f\u7684\u548c\u6b21\u5c0f\u7684\u7ffb\u8f6c\u503c\u3002\n\n\u7136\u540e\u6211\u4eec\u8003\u8651\u5c06\u8fd9\u4e24\u4e2a\u6570\u7684\u7b2c $2$ \u4f4d(\u6700\u53f3\u4fa7\u4e3a\u6700\u4f4e\u4f4d\uff0c\u6700\u4f4e\u4f4d\u4e3a\u7b2c $1$ \u4f4d)\u90fd\u7f6e\u4e3a $1$\uff0c\u5f97\u5230\u4e86\u4e24\u4e2a\u6570\n\n```\n010, 110\n```\n\n\u5c06\u8fd9\u4e24\u4e2a\u6570\u4e5f\u52a0\u5165\u5e8f\u5217\u4e2d\uff0c\u5f97\u5230\n\n```\n000, 100, 010, 110\n```\n\n\u7ffb\u8f6c\u503c\u5373\u4e3a\n\n```\n000, 001, 010, 011\n```\n\n\u6ce8\u610f\u5230\u7b2c $i$ \u6b21\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u52a0\u5165\u4e86\u5927\u4e8e $i$ \u4f4d\u7684\u4f4d\u7f6e\u90fd\u662f $0$\uff0c\u4e14\u7b2c $i$ \u4f4d\u662f $1$ \u7684\u6240\u6709\u6570\uff0c\u4ed6\u4eec\u663e\u7136\u6bd4\u5e8f\u5217\u4e2d\u539f\u6765\u5b58\u5728\u7684\u5927\u4e8e\u7b49\u4e8e $i$ \u4e3a\u7684\u4f4d\u7f6e\u90fd\u662f $0$ \u7684\u6570\u8981\u5927\uff0c\u800c\u6bd4\u5927\u4e8e $i$ \u4f4d\u5b58\u5728 $1$ \u7684\u6570\u5c0f\uff0c\u5e76\u4e14\u53bb\u6389 $1$ \u4ee5\u540e\u5373\u4e3a\u5e8f\u5217\u4e2d\u539f\u6709\u6570\u5b57\u7684\u987a\u5e8f\u3002\u8fd9\u6837\u6211\u4eec\u5c31\u8bc1\u660e\u4e86\u8fd9\u4e2a\u65b9\u6cd5\u7684\u6b63\u786e\u6027\u3002\n\n\u800c\u6211\u4eec\u53ea\u9700\u8981\u5904\u7406 $O(\\log n)$ \u4f4d\uff0c\u6bcf\u4f4d\u7684\u5904\u7406\u90fd\u662f $O(n)$ \u7684\uff0c\u56e0\u6b64\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n \\log n)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $O(n)$\uff0c\u4e8b\u5b9e\u4e0a\u5bf9\u4e8e\u6bcf\u4f4d\u7684\u5904\u7406\u662f\u8dd1\u4e0d\u6ee1 $O(n)$ \u7684\uff0c\u5e76\u4e14\u89c4\u907f\u4e86\u53d6\u6a21\u548c\u9664\u6cd5\u64cd\u4f5c\uff0c\u5e38\u6570\u6781\u5c0f\u3002\n\n\u4ee3\u7801\u5982\u4e0b\n\n```cpp\nvoid MakeRev(const int N) {\n  int d = N >> 1, p = 0;\n  tax[p++] = 0;\n  tax[p++] = d;\n  for (int w = 2; w <= N; w <<= 1) {\n    d >>= 1;\n    for (int p0 = 0; p0 < w; ++p0) {\n      tax[p++] = tax[p0] | d;\n    }\n  }\n}\n```\n\n\u7136\u540e\u8003\u8651\u901a\u8fc7\u6211\u4eec\u5f97\u5230\u7684 ``tax`` \u6570\u7ec4\u6765\u5bf9\u539f\u6570\u7ec4 $A$ \u8fdb\u884c\u6392\u5e8f\u3002\n\n\u8bb0 $rev(i)$ \u4e3a $i$ \u4e8c\u8fdb\u5236\u9006\u5e8f\u540e\u7684\u503c\uff0c\u663e\u7136 $rev(rev(i)) = i$\u3002\u56e0\u6b64\u5bf9\u4e8e\u4e00\u4e2a\u4e0b\u6807 $p$\uff0c\u8bbe\u5b83\u6392\u5e8f\u540e\u5728\u65b0\u5e8f\u5217\u4e2d\u7684\u4e0b\u6807\u4e3a $q$\uff0c\u90a3\u4e48\u539f\u5e8f\u5217\u4e0b\u6807\u4e3a $q$ \u7684\u4f4d\u7f6e\u5728\u65b0\u5e8f\u5217\u7684\u4e0b\u6807\u4e00\u5b9a\u662f $p$\u3002\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u5bf9\u4e8e\u6240\u6709 $rev(i) > i$ \u7684\u4f4d\u7f6e $i$\uff0c\u4ea4\u6362 $i$ \u548c $rev(i)$ \u4f4d\u7f6e\u7684\u503c\u5373\u53ef\u3002\n\n\u8fd9\u90e8\u5206\u64cd\u4f5c\u7684\u540d\u5b57\u53eb\u505a**\u4f4d\u9006\u5e8f\u7f6e\u6362**\u3002\n\n```cpp\nfor (int i = 1; i < N; ++i) if (tax[i] > i) {\n  std::swap(A[i], A[tax[i]]);\n}\n```\n\n\u6700\u540e\u8003\u8651\u8fed\u4ee3\u7684\u8774\u8776\u64cd\u4f5c\u8fc7\u7a0b\u3002\n\n\u5bf9\u4e8e\u6c42$A(x)$ \u5728 $n$ \u6b21\u5355\u4f4d\u6839\u7684\u5404\u5e42\u6b21\u7684\u70b9\u503c\u65f6\uff0c$m = \\frac{n}{2}$ \u6b21\u5355\u4f4d\u6839\u7684\u5404\u5e42\u6b21\u5728 $A_0$ \u6216 $A_1$ \u5904\u7684\u70b9\u503c\u5df2\u7ecf\u88ab\u8ba1\u7b97\u5e76\u5b58\u50a8\u5728\u4e86 $A$ \u6570\u7ec4\u4e2d\u3002\u6211\u4eec\u4ee4 $A_0(\\omega_m^k)~=~A[k]$\uff0c$A_1(\\omega_m^k)~=~A[k + m]$\u3002\u90a3\u4e48 $A(\\omega_n^k)~=~A[k] + \\omega_n^k \\times A[k + m]$\uff0c$A(\\omega_n^{k + m})~=~A[k]~-\\omega_n^k \\times A[k + m]$\uff0c\u5e76\u5c06\u4e0a\u9762\u4e24\u4e2a\u503c\u5206\u522b\u5b58\u5165 $A[k]$ \u548c $A[k + m]$ \u4e2d\u5373\u53ef\u3002\u5176\u4e2d $A(x)$ \u4ee3\u8868\u591a\u9879\u5f0f\uff0c$A[k]$ \u4ee3\u8868\u6570\u7ec4\u3002\u90a3\u4e48\u5728\u66f4\u4e0a\u9762\u4e00\u5c42\u9012\u5f52\u8c03\u7528\u65f6\uff0c\u6839\u636e $A_0$ \u548c $A_1$\u7684\u5b9a\u4e49\uff0c\u5f53\u524d\u7684 $A[k]$ \u5373\u662f\u4e0a\u9762\u4e00\u5c42\u6240\u8ba1\u7b97\u7684\u591a\u9879\u5f0f $A'(x)$ \u7684\u5bfc\u51fa\u591a\u9879\u5f0f $A'_0(x)$ \u5728 $\\omega_n^k$ \u5904\u7684\u70b9\u503c\uff0c$A[k + m]$ \u5373\u662f $A'_1(x)$ \u5728 $\\omega_n^k$ \u5904\u7684\u70b9\u503c\u3002\n\n\u81f3\u6b64\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u8fed\u4ee3\u5b8c\u6210 ``FFT`` \u7684\u7b97\u6cd5\u3002\n\n## Final Code\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <complex>\n#include <iostream>\n#include <algorithm>\n\nconst int maxn = 6000006;\nconst double PI = acos(-1);\n\nint n, m, k, sm;\nint tax[maxn];\nstd::complex<double> F[maxn], G[maxn];\n\nvoid MakeRev(const int N);\nvoid FFT(std::complex<double> *A, int N);\n\nint main() {\n  freopen(\"1.in\", \"r\", stdin);\n  qr(n); qr(m);\n  for (int i = 0, x; i <= n; ++i) {\n    x = 0; qr(x); F[i] = x;\n  }\n  for (int i = 0, x; i <= m; ++i) {\n    x = 0; qr(x); G[i] = x;\n  }\n  sm = n + m; k = 1;\n  while (k <= sm) k <<= 1;\n  MakeRev(k);\n  FFT(F, k); \n  FFT(G, k);\n  for (int i = 0; i < k; ++i) {\n    F[i] *= G[i];\n  }\n  FFT(F, k);\n  std::reverse(F + 1, F + k);\n  for (int i = 0; i < sm; ++i) {\n    qw(int((F[i].real()) / k + 0.5), ' ', true);\n  }\n  qw(int(F[sm].real() / k + 0.5), '\\n', true);\n  return 0;\n}\n\nvoid FFT(std::complex<double> *A, int N) {\n  for (int i = 1; i < N; ++i) if (tax[i] > i) {\n    std::swap(A[i], A[tax[i]]);\n  }\n  for (int len = 2, M = 1; len <= N; M = len, len <<= 1) {\n    std::complex<double> W(cos(PI / M), sin(PI / M)), w(1.0, 0.0);\n    for (auto L = 0, R = len - 1; R <= N; L += len, R += len) {\n      auto w0 = w;\n      for (auto p = L, lim = L + M; p < lim; ++p) {\n        auto x = A[p] + w0 * A[p + M], y = A[p] - w0 * A[p + M];\n        A[p] = x; A[p + M] = y;\n        w0 *= W;\n      }\n    }\n  }\n}\n\nvoid MakeRev(const int N) {\n  int d = N >> 1, p = 0;\n  tax[p++] = 0;\n  tax[p++] = d;\n  for (int w = 2; w <= N; w <<= 1) {\n    d >>= 1;\n    for (int p0 = 0; p0 < w; ++p0) {\n      tax[p++] = tax[p0] | d;\n    }\n  }\n}\n```\n\n## Appreciation\n\n\u5341\u5206\u611f\u8c22 @[**Dusker**](https://www.luogu.com.cn/user/26538) \u62bd\u51fa\u65f6\u95f4\u5ba1\u9605\u8fd9\u7bc7\u957f\u6587\u3002",
        "postTime": 1577214297,
        "uid": 65363,
        "name": "\u4e00\u6276\u82cf\u4e00",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09\u3011"
    },
    {
        "content": "\u53d1\u73b0FFT\u7684\u6a21\u677f\u9898\u7adf\u7136\u6ca1\u6709\u4e09\u6b21\u53d8\u4e24\u6b21\u4f18\u5316\u5462qwq\u3002\u3002  \n\u8fd9\u91cc\u5c31\u8bb2\u4e00\u4e0b\u5427\u3002  \n\u5efa\u8bae\u5728\u770b\u8fd9\u7bc7\u9898\u89e3\u4e4b\u524d\uff0c\u5148\u7406\u89e3\u57fa\u672c\u7684FFT\u3002\n  \n  \n****  \n\u6309\u7167\u4e00\u822c\u7684\u505a\u6cd5\uff0c\u5982\u679c\u6211\u4eec\u8981\u6c42\u51fa$F(x)$\u548c$G(x)$\u7684\u5377\u79ef\uff0c\u4f1a\u628a\u5b83\u4eec\u5206\u522bFFT\uff0c\u7136\u540e\u5bf9\u5e94\u6bcf\u9879\u4e58\u8d77\u6765\uff0c\u6700\u540e\u518d\u9006FFT\u56de\u6765\u3002  \n\u6765\u56de\u4e00\u5171\u8fdb\u884c\u4e86\u4e09\u6b21FFT\uff0c\u611f\u89c9\u8fd9\u6837\u662f\u5f88\u4e0d\u4f18\u7684\u3002  \n\n\u6211\u4eec\u53ef\u4ee5\u628a$G(x)$\u653e\u5230$F(x)$\u7684\u865a\u90e8\u4e0a\u53bb\uff0c\u6c42\u51fa$F(x)^2$\uff0c\u7136\u540e\u628a$F(x)$\u7684\u865a\u90e8\u53d6\u51fa\u6765\u9664$2$\u5c31\u662f\u7b54\u6848\u4e86qwq  \n\u6b63\u786e\u6027\u7684\u8bc1\u660e\u4e5f\u5f88\u7b80\u5355\uff1a  \n$$\\large (a+bi)^2=(a^2-b^2)+(2abi)$$  \n\u8fd9\u6837\u6211\u4eec\u5c31\u628a\u5e38\u6570\u4f18\u5316\u5230\u539f\u6765\u7684$2/3$\u5566\uff01  \nps\uff1a\u8dd1\u5f97\u6bd4NTT\u8fd8\u5feb\uff01  \n\n\u6700\u540e\u4e0a\u4ee3\u7801\uff1a  \n```cpp\n#include<cstdio> \n#include<iostream>\n#include<cstring>\n#include<algorithm>\n#include<vector>\n#include<cmath>\n#define ll long long\n#define N 4000009\n#define reg register\n#define pi 3.141592653589793\nusing namespace std;\n\nstruct complex{\n    double x,y;\n    complex(double x=0,double y=0):x(x),y(y){}\n\n    inline complex operator + (const complex b) const{\n        return complex(x+b.x,y+b.y);\n    }\n\n    inline complex operator - (const complex b) const{\n        return complex(x-b.x,y-b.y);\n    }\n\n    inline complex operator * (const complex b) const{\n        complex res;\n        res.x = x*b.x-y*b.y;\n        res.y = x*b.y+y*b.x;\n        return res;\n    }\n};\n\ninline void read(int &x);\nvoid print(int x);\ninline void FFT(complex *a,int type,int lim);\n\nint n,m;\ncomplex F[N];\nint rev[N];\n\nsigned main(){ \n    int qwq,t,lim = 1,l = -1;\n    read(n),read(m);\n    for(reg int i=0;i<=n;++i) read(t),F[i].x = t;\n    for(reg int i=0;i<=m;++i) read(t),F[i].y = t; //\u628aG(x)\u653e\u5230F(x)\u7684\u865a\u90e8\u4e0a\n    t = n+m;\n    n = max(n,m);\n    while(lim<=(n<<1)){\n        lim <<= 1;\n        ++l;\n    }\n    for(reg int i=1;i<=lim;++i)\n        rev[i] = (rev[i>>1]>>1)|((i&1)<<l);\n    FFT(F,1,lim);\n    for(reg int i=0;i<=lim;++i)\n        F[i] = F[i]*F[i]; //\u6c42\u51faF(x)^2\n    FFT(F,-1,lim);\n    for(reg int i=0;i<=t;++i){\n        qwq = F[i].y/2+0.5; //\u865a\u90e8\u53d6\u51fa\u6765\u96642\uff0c\u6ce8\u610f\u8981+0.5\uff0c\u5426\u5219\u7cbe\u5ea6\u4f1a\u6709\u95ee\u9898\n        print(qwq);\n        putchar(' ');\n    }        \n    return 0;\n}\n\ninline void FFT(complex *a,int type,int lim){ //\u6ca1\u4ec0\u4e48\u597d\u8bf4\u7684,FFT\u7684\u6a21\u677f\n    for(reg int i=1;i<=lim;++i){\n        if(i>=rev[i]) continue;\n        swap(a[i],a[rev[i]]);\n    }\n    reg complex rt,w,x,y;\n    for(reg int mid=1;mid<lim;mid<<=1){\n        reg int r = mid<<1;\n        rt = complex(cos(pi/mid),type*sin(pi/mid));\n        for(reg int j=0;j<lim;j+=r){\n            w = complex(1,0);\n            for(reg int k=0;k<mid;++k){\n                x = a[j|k];\n                y = w*a[j|k|mid];\n                a[j|k] = x+y;\n                a[j|k|mid] = x-y;\n                w = w*rt;\n            }\n        }\n    }\n    if(type==1) return;\n    for(reg int i=0;i<=lim;++i){\n        a[i].y = a[i].y/lim;\n        a[i].x = a[i].x/lim;\n    }\n}\n\ninline void read(int &x){\n    x = 0;\n    char c = getchar();\n    while(c<'0'||c>'9') c = getchar();\n    while(c>='0'&&c<='9'){\n        x = (x<<3)+(x<<1)+(c^48);\n        c = getchar();\n    }\n}\n\nvoid print(int x){\n    if(x>9) print(x/10);\n    putchar(x%10+'0');\n}\n```",
        "postTime": 1558369542,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09\u3011"
    },
    {
        "content": "### \u524d\u8a00\n\n\u4f17\u6240\u5468\u77e5\uff0c\u8fd9FFT\u662f\u7528\u6765\u7b97\u591a\u9879\u5f0f\u4e58\u6cd5\u7684\u3002\n\n\u5bf9\u4e8e\u8fd9\u79cd\u5e38\u4eba\u601d\u7ef4\u96be\u4ee5\u7406\u89e3\u7684\u4e1c\u897f\uff0c\u5c31\u5c11\u4e9b\u7406\u89e3\uff0c\u591a\u80cc\u677f\u5b50\u5427\uff01\n\n~~\u56e0\u6b64\u53ea\u603b\u7ed3\u4e00\u4e0b\u601d\u8def\u548c\u4ee3\u7801\uff0c\u4ec0\u4e48\u6982\u5ff5\u548c\u63a8\u5f0f\u5b50\u5c31\u9760\u5de8\u4f6c\u4eec\u5427~~\n\n\u63a8\u8350\u81ea\u4e3a\u98ce\u6708\u9a6c\u524d\u5352\u5de8\u4f6c\u7684[\u6982\u5ff5\u548c\u5b9a\u7406\u90fd\u975e\u5e38\u5230\u4f4d\u7684\u603b\u7ed3](http://www.cnblogs.com/zwfymqz/p/8244902.html)\n\n\u63a8\u8350ppl\u5de8\u4f6c\u7684[\u7b80\u660e\u6613\u61c2\u7684\u603b\u7ed3](http://www.cnblogs.com/cjoieryl/p/8206721.html)\n\n## \u591a\u9879\u5f0f\u4e58\u6cd5\u7684\u8e4a\u5f84\u2014\u2014\u70b9\u503c\u8868\u793a\u6cd5\n\n\u4e00\u822c\u6211\u4eec\u628a\u4e24\u4e2a\u957f\u5ea6\u4e3a$n$\u7684\u591a\u9879\u5f0f\u4e58\u8d77\u6765\uff0c\u5c31\u7c7b\u4f3c\u4e8e\u505a\u7ad6\u5f0f\u4e58\u6cd5\uff0c\u4e00\u4f4d\u4e00\u4f4d\u5730\u4e58\u518d\u52a0\u5230\u5bf9\u5e94\u4f4d\u4e0a\uff0c\u662f$O(n^2)$\u7684\n\n\u5982\u4f55\u4f18\u5316\uff1f\u76f4\u63a5\u770b\u662f\u6ca1\u6709\u601d\u8def\u7684\uff0c\u53ea\u597d\u53e6\u8f9f\u8e4a\u5f84\u4e86\u3002\n\n\u591a\u9879\u5f0f\u9664\u4e86\u6211\u4eec\u5e38\u7528\u7684\u7cfb\u6570\u8868\u793a\u6cd5$y=a_0+a_1x+a_2x^2+...+a_{n-1}x^{n-1}$\u4ee5\u5916\uff0c\u8fd8\u53ef\u4ee5\u7528\u70b9\u503c\u8868\u793a\u6cd5\u3002\n\n\u6240\u8c13\u70b9\u503c\u8868\u793a\u6cd5\uff0c\u5c31\u662f\u76f8\u5f53\u4e8e\u7528\u51fd\u6570\u56fe\u50cf\u4e0a$n$\u4e2a\u70b9\u7684\u5750\u6807$(x_i,y_i)$\u8868\u793a\u4e00\u4e2a$n$\u6b21\u591a\u9879\u5f0f\uff0c\u663e\u7136\u8fd9\u4e2a\u8868\u793a\u662f\u552f\u4e00\u7684\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u7cfb\u6570\u8868\u793a\u8f6c\u5316\u6210\u70b9\u503c\u8868\u793a\u3002\u70b9\u503c\u8868\u793a\u4e0b\u7684\u591a\u9879\u5f0f\u600e\u4e48\u76f8\u4e58\u5462\uff1f\u5c31\u662f\u9009\u76f8\u540c\u7684$x_i$\uff0c\u628a\u5bf9\u5e94\u7684$y_i$\u76f8\u4e58\u3002\n\n\u5f53\u7136\uff0c\u4e24\u4e2a\u957f\u5ea6\u4e3a$n$\u7684\u591a\u9879\u5f0f\u76f8\u4e58\u5f97\u5230\u7684\u662f\u957f\u5ea6\u4e3a$2n-1$\u7684\u591a\u9879\u5f0f\uff0c\u9700\u8981$2n-1$\u4e2a\u70b9\u503c\u624d\u80fd\u552f\u4e00\u8868\u793a\uff0c\u56e0\u6b64\u4e00\u5f00\u59cb\u4e24\u4e2a\u591a\u9879\u5f0f\u4e5f\u8981\u9009$2n-1$\u4e2a\u70b9\u8868\u793a\u3002\n\n\u4e3e\u4e00\u4e2a\u4f8b\u5b50\n\n$(x+1)(x+2)$\u2192 \u2192 \u2192 \u2192 $x^2+3x+2$\n\n\u2193$\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\ \\ \\ $\u2191\n\n\u2193\uff08\u70b9\u503c\uff09$\\qquad\\qquad\\qquad$ \uff08\u7cfb\u6570\uff09\u2191\n\n\u2193$\\qquad\\qquad\\qquad\\qquad\\qquad\\qquad\\ \\ \\ $\u2191\n\n$(0,1)(1,2)(2,3)$  \uff08\u76f8\u4e58\uff09$\\qquad\\ \\ \\ $ \u2191\n\n$(0,2)(1,3)(2,4)$\u2192 \u2192 \u2192 \u2192$(0,2)(1,6)(2,12)$\n\n\u53ef\u662f\uff0c\u968f\u610f\u9009$O(n)$\u4e2a\u70b9\uff0c\u8ba1\u7b97$y$\u662f$O(n)$\u7684\uff0c\u603b\u65f6\u95f4\u8fd8\u662f$O(n^2)$\u7684\uff0c\u628a\u5b83\u8fd8\u539f\u6210\u7cfb\u6570\u8868\u8fbe\u5f0f\u66f4\u4e0d\u8f7b\u677e\u3002\n\n\u6240\u4ee5\uff0c\u5982\u679c\u9009\u7684\u70b9\u5f88\u666e\u901a\uff0c\u8fd9\u53ea\u662f\u4e00\u6761\u8e4a\u5f84\uff0c\u5e76\u4e0d\u662f\u4e00\u6761\u6377\u5f84\u3002\n\n## \u795e\u5947\u7684\u5355\u4f4d\u6839\n\n\u4ecb\u7ecd\u4e00\u4e2a\u795e\u5947\u7684\u4e1c\u897f\u2014\u2014$n$\u6b21\u5355\u4f4d\u6839\uff08\u8bb0\u4e3a$\\omega_n$\uff09\u3002\n\n\u5b83\u662f$n$\u4e2a\u590d\u6570\u7684\u96c6\u5408\uff0c\u6bcf\u4e00\u4e2a\u7684$n$\u6b21\u65b9\u90fd\u7b49\u4e8e$1$\u3002\u5176\u4e2d\u7684\u4e00\u4e2a\u662f$e^{{2\\pi i}\\over n}$\uff0c\u8bb0\u4e3a$\\omega_n$\u3002\n\n\u666e\u53ca\u4e00\u4e0b\u6b27\u62c9\u516c\u5f0f\uff0c$e^{\\theta i}=\\cos\\theta+(\\sin\\theta)i$\uff0c$\\theta$\u5c31\u662f\u8fd9\u4e2a\u590d\u6570\u5411\u91cf\u7684\u65cb\u8f6c\u89d2\u3002\u663e\u7136\u6ee1\u8db3$(\\omega_n)^n=e^{2\\pi i}=1$\uff0c\u90a3\u4e48\u5b83\u7684$k$\u6b21\u65b9$(\\omega_n^k)^n=e^{2k\\pi i}$\u4e5f\u7b49\u4e8e$1$\u3002\n\n\u4e8e\u662f\u53ef\u4ee5\u770b\u51fa\uff0c\u6ee1\u8db3$n$\u6b21\u65b9\u7b49\u4e8e$1$\u7684\u590d\u6570\u7684\u53d6\u503c\u53ea\u4f1a\u6709$n$\u4e2a\uff0c\u4e3a$\\omega_n^k(k\\in[0,n-1])$\uff0c\u56e0\u4e3a\u4f1a\u6709$\\omega_n^{n+k}=\\omega_n^k$\u3002\n\n\u8fd9$n$\u4e2a\u590d\u6570\u5411\u91cf\u5728\u5355\u4f4d\u5706\u4e0a\u5448\u653e\u5c04\u72b6\u3002\u4e0b\u9762\u662f\u7b97\u5bfc\u7684\u56fe\u7247\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/23925.png)\n\n\u4ecb\u7ecd\u6d88\u53bb\u5f15\u7406$\u03c9^{dk}_{dn}=\u03c9^k_n$\uff0c\u8bc1\u660e\u5f88\u5bb9\u6613\u7684\u3002\n\n## DFT&IDFT\n\n\u5355\u4f4d\u6839\u6709\u4ec0\u4e48\u7528\u5462\uff1f\n\n\u770b\u770b\u6211\u4eec\u628a$\\omega_n^k(k\\in[0,n-1])$\u5206\u522b\u5e26\u5165\u591a\u9879\u5f0f\u6c42\u70b9\u503c\u4f1a\u53d1\u751f\u4ec0\u4e48\u5c31\u77e5\u9053\u4e86\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u53ebDFT\u3002\n\n\u5047\u8bbe$n$\u4e3a\u5076\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u7684\u5947\u5076\u9879\u5206\u5f00\uff0c\u7528\u4e24\u4e2a\u591a\u9879\u5f0f\u8868\u793a\u5b83\n\n$A^{[0]}(x)=a_0+a_2x+a_4x^2+...+a_{n-2}x^{{\\frac n 2}-1}$\n\n$A^{[1]}(x)=a_1+a_3x+a_5x^2+...+a_{n-1}x^{{\\frac n 2}-1}$\n\n\u90a3\u4e48$A(x)=A^{[0]}(x^2)+xA^{[1]}(x^2)$\u3002\n\n\u6ce8\u610f\uff0c\u4e0b\u9762\u7684\u53d8\u5316\u7528\u5230\u4e86$\u03c9^{2k}_n=\u03c9^k_{\\frac n 2}$\uff0c$\u03c9^n_n=1$\u548c$\u03c9^{\\frac n 2}_n=-1$\u3002\n\n\u9996\u5148\u5e26\u5165\u5355\u4f4d\u6839\n\n$\\quad A(\u03c9^k_n)$\n\n$=A^{[0]}(\u03c9^{2k}_n)+\u03c9^k_nA^{[1]}(\u03c9^{2k}_n)$\n\n$=A^{[0]}(\u03c9^k_{\\frac n 2})+\u03c9^k_nA^{[1]}(\u03c9^k_{\\frac n 2})(k<\\frac n 2)$\n\n\u90a3$k\\geq\\frac n 2$\u65f6\u53c8\u4f1a\u53d1\u751f\u4ec0\u4e48\u5462\uff1f\u628a\u5b83\u53d8\u6210$\\frac n 2+k$\n\n$\\quad A(\u03c9^{\\frac n 2+k}_n)$\n\n$=A^{[0]}(\u03c9^{n+2k}_n)+\u03c9^{\\frac n 2+k}_nA^{[1]}(\u03c9^{n+2k}_n)$\n\n$=A^{[0]}(\u03c9^{2k}_n)+\u03c9^{\\frac n 2}_n\u03c9^k_nA^{[1]}(\u03c9^{2k}_n)$\n\n$=A^{[0]}(\u03c9^k_{\\frac n 2})-\u03c9^k_nA^{[1]}(\u03c9^k_{\\frac n 2})$\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u6211\u4eec\u8981\u6c42\u4e00\u4e2a\u957f\u5ea6\u4e3a$n$\u7684\u591a\u9879\u5f0f\u53d6$\\omega_n^k(k\\in[0,n-1])$\u7684$n$\u4e2a\u70b9\u503c\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa\u4e24\u4e2a\u957f\u5ea6\u4e3a$n/2$\u7684\u591a\u9879\u5f0f\u53d6$\\omega_{\\frac n 2}^k(k\\in[0,\\frac n 2-1])$\u7684$\\frac n 2$\u4e2a\u70b9\u503c\uff0c\u518d\u901a\u8fc7\u4e0a\u8ff0\u4e24\u4e2a\u5f0f\u5b50\u5408\u5e76\u7ed3\u679c\u3002\u8fd9\u5b8c\u5168\u5c31\u662f\u4e2a\u9012\u5f52\u8fc7\u7a0b\uff0c\u5f88\u5bb9\u6613\u5199\u4e00\u4e2a\u51fd\u6570\u6765\u8ba1\u7b97\u3002\n\n\u53ef\u4ee5\u7531\u7b97\u6cd5\u5199\u51faDFT\u7684\u590d\u6742\u5ea6$T(n)=2T(\\frac n 2)+O(n)=O(n\\log n)$\n\n---\n\n\u5f53\u7136\uff0c\u522b\u5fd8\u4e86\u8fd8\u539f\u6210\u7cfb\u6570\u8868\u793a\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u53eb\u505aIDFT\u3002\n\n\u849f\u84bb\u89c9\u5f97\u8fd9\u91cc\u7406\u89e3\u592a\u9ebb\u70e6\u4e86\uff0c\u56e0\u6b64\u4e0d\u518d\u8bc1\u660eIDFT\u7684\u8fc7\u7a0b\uff0c\u60f3\u4e86\u89e3\u7684\u53c2\u89c1\u5176\u5b83\u7684\u603b\u7ed3\u3002\n\n\u53ea\u9700\u8981\u8bb0\u4f4f\uff0cIDFT\u7684$\\omega_n$\u662f$e^{-\\frac{2\\pi i}n}$\uff0c\u6700\u540e\u7684\u7ed3\u679c\u9664\u4ee5$n$\uff0c\u5176\u5b83\u8fc7\u7a0b\u540cDFT\uff0c\u53ef\u4ee5\u5199\u5728\u4e00\u4e2a\u51fd\u6570\u91cc\u3002\u5177\u4f53\u770b\u4e0b\u9762\u7684\u4ee3\u7801\uff1a\n\n```cpp\nvoid FFT(R complex<double>*a,R int n,R int op){//op=1\u4e3aDFT\uff0c-1\u4e3aIDFT\n    if(!n)return;//\u4e3a\u4e86\u65b9\u4fbf\uff0cn\u7684\u610f\u4e49\u4e0e\u4e0a\u9762\u4e0d\u4e00\u6837\uff0c\u8fd9\u91cc\u7684n\u662fa0\u3001a1\u7684\u957f\u5ea6\n    complex<double>a0[n],a1[n];\n    for(R int k=0;k<n;++k)\n        a0[k]=a[k<<1],a1[k]=a[k<<1|1];//\u5947\u5076\u9879\u5206\u79bb\n    FFT(a0,n>>1,op);FFT(a1,n>>1,op);//\u9012\u5f52\u5904\u7406\n    R complex<double>wn(cos(PI/n),sin(PI/n)*op),w(1,0);//\u5355\u4f4d\u6839\n    for(R int k=0;k<n;++k,w*=wn)//k\u4ece\u5230n/2\n        a[k]=a0[k]+w*a1[k],a[k+n]=a0[k]-w*a1[k];\n}\n```\n## \u9012\u5f52\u7248\u8fc7\u7a0b\n\n\u5f15\u5165\u4f8b\u9898\uff1a[\u6d1b\u8c37P3803 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09](https://www.luogu.org/problemnew/show/P3803)\n\n\u7531\u4e8e\u7cfb\u6570\u5f88\u5c0f\uff0c\u6211\u4eec\u4e0d\u5fc5\u62c5\u5fc3\u7cbe\u5ea6\u7684\u95ee\u9898\u4e86\uff08~~\u5f53\u7136float\u662f\u4f7f\u4e0d\u5f97\u7684~~\uff09\n\n\u9012\u5f52\u7248\u4ee3\u7801\uff1a\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<complex>\n#include<iostream>\n#define R register\n#define G c=getchar()\nusing namespace std;\nconst int N=4.2e6;\nconst double PI=acos(-1);//\u81ea\u5b9a\u4e49\u03c0\ncomplex<double>f[N],g[N];\ninline int in(){\n    R char G;\n    while(c<'-')G;\n    return c&15;\n}\nvoid FFT(R complex<double>*a,R int n,R int op){//\u540c\u4e0a\n    if(!n)return;\n    complex<double>a0[n],a1[n];\n    for(R int i=0;i<n;++i)\n        a0[i]=a[i<<1],a1[i]=a[i<<1|1];\n    FFT(a0,n>>1,op);FFT(a1,n>>1,op);\n    R complex<double>W(cos(PI/n),sin(PI/n)*op),w(1,0);\n    for(R int i=0;i<n;++i,w*=W)\n        a[i]=a0[i]+w*a1[i],a[i+n]=a0[i]-w*a1[i];\n}\nint main(){\n    R int n,m,i;\n    scanf(\"%d%d\",&n,&m);\n    for(i=0;i<=n;++i)f[i]=in();\n    for(i=0;i<=m;++i)g[i]=in();\n    for(m+=n,n=1;n<=m;n<<=1);//\u628a\u957f\u5ea6\u8865\u52302\u7684\u5e42\uff0c\u4e0d\u5fc5\u62c5\u5fc3\u9ad8\u6b21\u9879\u7684\u7cfb\u6570\uff0c\u56e0\u4e3a\u9ed8\u8ba4\u4e3a0\n    FFT(f,n>>1,1);FFT(g,n>>1,1);//DFT\n    for(i=0;i<n;++i)f[i]*=g[i];//\u70b9\u503c\u76f4\u63a5\u4e58\n    FFT(f,n>>1,-1);//IDFT\n    for(i=0;i<=m;++i)printf(\"%.0f \",fabs(f[i].real())/n);//\u6ce8\u610f\u7ed3\u679c\u9664\u4ee5n\uff0c\u5c0f\u5fc3\u201c-0\u201d\n    puts(\"\");\n    return 0;\n}\n```\n\u597d\u8bb0\u53c8\u597d\u5199\u7684\u9012\u5f52\u7248\u7ed3\u679c\u600e\u6837\u5462\uff1f\n\n~~Fast Fast TLE!~~\u53ea\u670977\u5206\u3002\n\n\u6700\u4e3b\u8981\u7684\u539f\u56e0\u5728\u4e8e\uff0c\u7a7a\u95f4\u8c03\u7528\u592a\u591a\u4e86\u3002\n\n## \u8774\u8776\u64cd\u4f5c\u548cRader\u6392\u5e8f\n\n\u9488\u5bf9\u6548\u7387\u592a\u4f4e\u7684\u95ee\u9898\uff0c\u6211\u4eec\u7ee7\u7eed\u89c2\u5bdfFFT\u5b9e\u73b0\u8fc7\u7a0b\u4e2d\u7684\u66f4\u591a\u7279\u70b9\u3002\n\n\u89c2\u5bdf\u8fd9\u4e00\u53e5\u4ee3\u7801`a[k]=a0[k]+w*a1[k],a[k+n]=a0[k]-w*a1[k];`\uff0c\u5728\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\uff0c\u53d6\u51fa\u4e86`a0[k]`\u548c`a1[k]`\u7684\u503c\uff0c\u901a\u8fc7\u8ba1\u7b97\u53c8\u6c42\u51fa\u4e86`a[k]`\u548c`a[k+n]`\u7684\u503c\u3002\u6211\u4eec\u628a\u8fd9\u6837\u7684\u4e00\u6b21\u8fd0\u7b97\u53eb\u505a\u201c\u8774\u8776\u64cd\u4f5c\u201d\u3002\n\n\u8fd9\u6837\u7684\u64cd\u4f5c\u6709\u4ec0\u4e48\u7279\u70b9\u5462\uff1f\u6211\u4eec\u8bd5\u7740\u5c06`a0`\u548c`a1`\u5408\u5e76\u6210\u4e00\u4e2a\u6570\u7ec4`a`\uff0c\u6bcf\u4e00\u6b21\u8774\u8776\u64cd\u4f5c\u540e\uff0c\u53d6\u51fa\u4e86`a[k]`\u548c`a[k+n]`\u7684\u503c\uff0c\u53c8\u6c42\u51fa\u4e86`a[k]`\u548c`a[k+n]`\u7684\u503c\u3002\u6700\u540e\uff0c\u6574\u4e2a\u6570\u7ec4\u90fd\u5b8c\u6210\u4e86\u6c42\u503c\uff0c\u800c\u5e76\u6ca1\u6709\u7528\u5230\u4e24\u4e2a\u6570\u7ec4\uff01\n\n\u4ee5$n=8$\u4e3a\u4f8b\uff0c\u770b\u770b\u9012\u5f52\u8fc7\u7a0b\u7684\u7ed3\u6784\n\n![](https://cdn.luogu.com.cn/upload/pic/23926.png)\n\n\u5176\u5b9e\uff0c\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u9012\u63a8\u6c42\u89e3\uff01\u5047\u8bbe$a$\u6570\u7ec4\u5df2\u7ecf\u53d8\u6210\u4e86\u7b2c\u56db\u5c42\u7684\u6837\u5b50\uff0c\u5148\u5bf9a0\u548ca4\u3001a2\u548ca6\u3001a1\u548ca5\u3001a3\u548ca7\u8774\u8776\u64cd\u4f5c\uff0c\u53d8\u6210\u7b2c\u4e09\u5c42\uff1b\u518d\u5bf9a0\u548ca2\u3001a4\u548ca6\u3001a1\u548ca3\u3001a5\u548ca7\u8774\u8776\u64cd\u4f5c\uff0c\u53d8\u6210\u7b2c\u4e8c\u5c42\uff1b\u6700\u540e\u5bf9a0\u548ca1\u3001a2\u548ca3\u3001a4\u548ca5\u3001a6\u548ca7\u8774\u8776\u64cd\u4f5c\uff0c\u53d8\u6210\u7b2c\u4e00\u5c42\uff0cFFT\u5c31\u5b8c\u6210\u4e86\uff0c\u800c\u7a7a\u95f4\u590d\u6742\u5ea6\u4ec5\u4e3a$O(n)$\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u53ef\u4ee5\u7528\u5faa\u73af\u6765\u63a7\u5236\u3002\n\n\u5269\u4e0b\u7684\u95ee\u9898\u5c31\u662f\u628a\u521d\u59cb\u7684\u6570\u7ec4\u53d8\u6210\u6700\u540e\u4e00\u5c42\u7684\u6837\u5b50\u4e86\u3002\u5148\u522b\u6025\u7740\u5199\u4e00\u4e2a\u9012\u5f52\u51fd\u6570\u66b4\u529b\u628a\u4f4d\u7f6e\u6362\u8fc7\u53bb\u3002\u6765\u89c2\u5bdf\u4e00\u4e0b\u6700\u540e\u5e8f\u5217\u7684\u7f16\u53f7\u7684\u4e8c\u8fdb\u5236\u8868\u793a`000,100,010,110,001,101,011,111`\uff0c\u662f\u4e0d\u662f\u4e0e\u539f\u6765`000,001,010,011,100,101,110,111`\u76f8\u6bd4\uff0c\u6bcf\u4e2a\u4f4d\u7f6e\u4e0a\u7684\u4e8c\u8fdb\u5236\u4f4d\u90fd\u53cd\u8fc7\u6765\u4e86\uff1f\u8fd9\u6837\u7684\u53d8\u5316\u53eb\u505aRader\u6392\u5e8f\u3002\n\n\u6211\u4eec\u53ef\u4ee5$O(n)$\u5c06Rader\u6392\u5e8f\u7684\u6620\u5c04\u5173\u7cfb\u6c42\u51fa\u3002\u8bbe$i$Rader\u6392\u5e8f\u540e\u7684\u6570\u4e3a$r_i$\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7$r_{\\frac i 2}$\u9012\u63a8\u6c42\u51fa\uff0c\u5177\u4f53\u65b9\u6cd5\u53ef\u4ee5\u770b\u770b\u4ee3\u7801&\u52a8\u52a8\u8111\u7b4bqwq\n\n```cpp\n#include<cmath>\n#include<cstdio>\n#define R register\n#define I inline\nusing namespace std;\nconst int N=4.2e6;\nconst double PI=acos(-1);\nint n,r[N];\nstruct C{//\u624b\u5199complex\uff0c\u6bd4STL\u5feb\u4e00\u70b9\u70b9\n\tdouble r,i;\n\tI C(){r=i=0;}\n\tI C(R double x,R double y){r=x;i=y;}\n\tI C operator+(R C&x){return C(r+x.r,i+x.i);}\n\tI C operator-(R C&x){return C(r-x.r,i-x.i);}\n\tI C operator*(R C&x){return C(r*x.r-i*x.i,r*x.i+i*x.r);}\n\tI void operator+=(R C&x){r+=x.r;i+=x.i;}\n\tI void operator*=(R C&x){R double t=r;r=r*x.r-i*x.i;i=t*x.i+i*x.r;}\n}f[N],g[N];\nI int in(){\n\tR char c=getchar();\n\twhile(c<'-')c=getchar();\n\treturn c&15;\n}\nI void FFT(R C*a,R int op){\n\tR C W,w,t,*a0,*a1;\n\tR int i,j,k;\n\tfor(i=0;i<n;++i)//\u6839\u636e\u6620\u5c04\u5173\u7cfb\u4ea4\u6362\u5143\u7d20\n\t\tif(i<r[i])t=a[i],a[i]=a[r[i]],a[r[i]]=t;\n\tfor(i=1;i<n;i<<=1)//\u63a7\u5236\u5c42\u6570\n\t\tfor(W=C(cos(PI/i),sin(PI/i)*op),j=0;j<n;j+=i<<1)//\u63a7\u5236\u4e00\u5c42\u4e2d\u7684\u5b50\u95ee\u9898\u4e2a\u6570\n\t\t\tfor(w=C(1,0),a1=i+(a0=a+j),k=0;k<i;++k,++a0,++a1,w*=W)\n\t\t\t\tt=*a1*w,*a1=*a0-t,*a0+=t;//\u8774\u8776\u64cd\u4f5c\n}\nint main(){\n    R int m,i,l=0;\n    scanf(\"%d%d\",&n,&m);\n    for(i=0;i<=n;++i)f[i].r=in();\n    for(i=0;i<=m;++i)g[i].r=in();\n    for(m+=n,n=1;n<=m;n<<=1,++l);\n    for(i=0;i<n;++i)r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));//\u9012\u63a8\u6c42r\n    FFT(f,1);FFT(g,1);\n    for(i=0;i<n;++i)f[i]*=g[i];\n    FFT(f,-1);\n    for(i=0;i<=m;++i)printf(\"%.0f \",fabs(f[i].r)/n);\n    puts(\"\");\n    return 0;\n}\n```",
        "postTime": 1531817801,
        "uid": 61325,
        "name": "FlashHu",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09\u3011"
    },
    {
        "content": "## \u591a\u9879\u5f0f\u7b80\u4ecb\n\u5bf9\u4e8e\u6570\u57df$\\mathbb F$\uff0c\u82e5\u6709$\\forall i\\in\\{1,2,3,\\cdots,n \\}$\uff0c\u5219\n$$f(x)=a_0+a_1x+a_2x^2+\\cdots+a_nx=\\sum_{i=1}^na_ix^i$$\n\u4e3a\u6570\u57df$\\mathbb F$\u4e0a\u7684\u4e00\u4e2a\u591a\u9879\u5f0f.\n## \u591a\u9879\u5f0f\u7684\u5ea6\u6570\n- \u591a\u9879\u5f0f\u6700\u9ad8\u9879\u7684\u6b21\u6570\u79f0\u4f5c\u591a\u9879\u5f0f\u7684\u6b21\u6570\n\n- $f(x)=\\sum\\limits_{i=1}^na_ix^i$\uff0c\u5176\u4e2d$a_n\u22600$\n\n- \u8bb0\u4f5c$\\text{deg}\\ f(x)=n$\n\n## \u591a\u9879\u5f0f\u7684\u7cfb\u6570\u8868\u793a\n\n\u5bf9\u4e8e\u4e0a\u8ff0\u591a\u9879\u5f0f$f(x)$\uff0c\u6709\u7cfb\u6570\u5411\u91cf$\\vec{a}$\u4e0e\u4e4b\u6620\u5c04\n$$f(x)=\\sum_{i=1}^na_ix^i\u21d4\\vec{a}=(a_1,a_2,a_3,\\cdots,a_n)$$\n\u6211\u4eec\u79f0$\\vec{a}$\u4e3a$f(x)$\u7684\u7cfb\u6570\u8868\u793a\n## \u591a\u9879\u5f0f\u5377\u79ef\n\n\u9996\u5148\u5b9a\u4e49\n$$f(x)=\\sum\\limits_{i=1}^na_ix^i$$\n\n$$g(x)=\\sum\\limits_{i=1}^nb_ix^i$$\n\u4e8e\u662f\u4ed6\u4eec\u7684\u5377\u79ef\u5f62\u5f0f\u4e3a\n$$h(x)=(f\\cdot g)(x)=\\Bigg(\\sum\\limits_{i=1}^na_ix^i\\Bigg)\\Bigg(\\sum_{i=1}^nb_ix^i\\Bigg)$$\n\u53ef\u5f97$\\text{deg}\\ h(x)=2n$\uff0c\u4e8e\u662f\u4ee4\n$$h(x)=\\sum_{i=1}^nc_ix^i$$\n$c_i$\u6ee1\u8db3\u4ee5\u4e0b\u8fd0\u7b97\u5f8b\n$$c_i=\\sum_{j+k=i}a_jb_k=\\sum_{j=i}^na_jb_{i-j}$$\n\u7cfb\u6570\u5411\u91cf$c$\u4e3a$a$\u4e0e$b$\u7684\u5377\u79ef\uff0c\u8bb0\u4f5c\n$$c=a*b$$\n## \u591a\u9879\u5f0f\u70b9\u503c\u8868\u793a\n\n\u8bbe$\\text{deg}\\ f(x)=n$\uff0c$\\forall x_i\\in\\mathbb F\\ (i=(1,2,3,\\cdots,n))$\n$$y_i=f(x_i)$$\n\u5219\u6211\u4eec\u53ef\u4ee5\u5728\u6570\u57df$\\mathbb F$\u7684\u5750\u6807\u7cfb\u4e2d\u7ed8\u5236\u51fa$n$\u4e2a\u70b9\n$$(x_1,y_1),(x_2,y_2),(x_3,y_3),\\cdots,(x_n,y_n)$$\n\u540c\u6837\u4e0e$f(x)$\u51fd\u6570\u6709\u6620\u5c04\u5173\u7cfb\u3002\n\n\u4e0d\u59a8\u5c06\u8fd9$n$\u4e2a\u70b9\u5e26\u5165\u77e9\u9635\u8fd0\u7b97\n$$\\begin{bmatrix}1\\ \\ x_1\\ \\ x_1^2\\ \\ \\ \\ \\cdots\\ \\ x_1^n\\\\\\\\1\\ \\ x_2\\ \\ x_2^2\\ \\ \\ \\ \\cdots\\ \\ x_2^n\\\\\\\\1\\ \\ x_3\\ \\ x_3^2\\ \\ \\ \\ \\cdots\\ \\ x_3^n\\\\\\\\\\vdots\\ \\ \\ \\ \\vdots\\ \\ \\ \\ \\vdots\\ \\ \\ \\ \\ddots\\ \\ \\vdots\\\\\\\\1\\ \\ x_n\\ \\ x_n^2\\ \\ \\ \\ \\cdots\\ \\ x_n^n\\end{bmatrix}\\begin{bmatrix}a_1\\\\\\\\a_2\\\\\\\\a_3\\\\\\\\\\vdots\\\\\\\\a_n\\end{bmatrix}=\\begin{bmatrix}y_1\\\\\\\\y_2\\\\\\\\y_3\\\\\\\\\\vdots\\\\\\\\y_n\\end{bmatrix}$$\n\u6211\u4eec\u79f0\u6700\u5de6\u8fb9\u7684\u77e9\u9635\u4e3a\u8303\u5fb7\u8499\u77e9\u9635.\n## \u591a\u9879\u5f0f\u63d2\u503c\n\n\u5bf9\u4e8e\u591a\u9879\u5f0f\u70b9\u503c\u8868\u793a$(x_1,y_1),(x_2,y_2),(x_3,y_3),\\cdots,(x_n,y_n)$\n\n\u6c42\u5b83\u7684\u7cfb\u6570\u5411\u91cf\u8868\u8fbe\u5f0f$\\vec{a}=(a_1,a_2,a_3,\\cdots,a_n)$\n\n\u8fd9\u4e2a\u8fc7\u7a0b\u53eb\u505a\u63d2\u503c.\n\n\u6734\u7d20\u7684\u63d2\u503c\u6cd5\u53ef\u4ee5\u5229\u7528\u8303\u5fb7\u8499\u77e9\u9635\u8fdb\u884c\u9ad8\u65af\u6d88\u5143\uff0c\u4f46\u662f\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u65e0\u6cd5\u627f\u53d7\u7684.\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6c42\u89e3\n$$f(x)=\\sum_{i=1}^ny_i\\prod_{i\u2260j}\\frac{x-x_j}{x_i-x_j}$$\n\u590d\u6742\u5ea6\u4f18\u5316\u5230\u4e86$n^2$\n## \u70b9\u503c\u6c42\u89e3\u591a\u9879\u5f0f\u4e58\u6cd5\n\n1. \u9009\u53d6$n$\u4e2a$x_i$\uff0c\u5e26\u5165\u8ba1\u7b97\u70b9\u503c\uff0c\u8fd9\u4e00\u6b65\u662f$O(n^2)$\n\n2. \u8ba1\u7b97\u70b9\u503c\u7684\u5377\u79ef\uff0c\u8fd9\u4e00\u6b65\u662f$O(n)$\n\n3. \u63d2\u503c\u8ba1\u7b97\u7cfb\u6570\u5411\u91cf\uff0c\u8fd9\u4e00\u6b65\u662f$O(n^2)$\n\n\n\u6240\u4ee5\u6700\u540e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5e94\u8be5\u4e3a$O(n^2)$\uff0c\u6734\u7d20\u7684\u70b9\u503c\u6c42\u89e3\u4e0e\u66b4\u529b\u8ba1\u7b97\u4e00\u81f4\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u4f1a\u5b66\u4e60\u4ee5\u4e0b\u77e5\u8bc6\u70b9\u4f18\u5316\u591a\u9879\u5f0f\u5377\u79ef\n\n- \u590d\u6570\u5355\u4f4d\u6839\n\n- \u539f\u6839\n\n## \u590d\u6570\u5355\u4f4d\u6839\n\n\u8003\u8651\u65b9\u7a0b\n$$z^n=1\\ \\ (z\\in\\mathbb C)$$\n\u6211\u4eec\u6309\u7167\u6781\u89d2\u6392\u5e8f\uff0c\u547d\u7b2c$k$\u4e2a\u590d\u6570\u89e3\u4e3a$\\omega_n^k$\n\n\u7531\u521d\u7b49\u4e09\u89d2\u51fd\u6570\u77e5\u8bc6\uff0c\u6211\u4eec\u89e3\u5f97\n$$\\omega_n^k=\\cos\\frac{k}{n}2\\pi+i\\sin\\frac{k}{n}2\\pi\\ \\ \\ (k\\in\\mathbb Z)$$\n\u7531\u6b27\u62c9\u516c\u5f0f\u53ef\u5f97\n$$\\omega_n^k=e^{\\frac{2\\pi ki}{n}}$$\n\u53ef\u4ee5$O(1)$\u6c42\u89e3\u3002\n\n\u7531\u4e09\u89d2\u51fd\u6570\u7684\u5468\u671f\u6027$(\\tau=2\\pi)$\uff0c\u4e0d\u96be\u8003\u8651$\\omega_n^k$\u7684\u5468\u671f\u6027\n\n- $\\omega_n^k=\\omega_n^{k\\pmod{n}}$\n\n- $\\omega_n^n=\\omega_n^0=1$\n\n\u6211\u4eec\u53d6$k\\in\\{0,2,3,\\cdots,n-1\\}$\n\n\u6709\u4ee5\u4e0b\u5b9a\u7406\n### \u76f8\u6d88\u5b9a\u7406\n\n$$\\omega_{dn}^{dk}=\\omega_n^k$$\n\u5145\u5206\u8bc1\u660e\n$$\\omega_{dn}^{dk}=\\cos\\frac{dk}{dn}2\\pi+i\\sin\\frac{dk}{dn}2\\pi$$\n$$\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ =\\cos\\frac{k}{n}2\\pi+i\\sin\\frac{k}{n}2\\pi=\\omega_n^k$$\n\u8bc1\u6bd5.\n\n\u6b64\u5916\u8865\u5145\u51e0\u79cd\u5e38\u89c1\u5f62\u5f0f\n$$\\omega_{2n}^n=\\omega_2^1=-1$$\n$$\\omega_{2n}^{n+k}=-\\omega_{2n}^k$$\n### \u6298\u534a\u5b9a\u7406\n\n$n$\u6b21\u5355\u4f4d\u6839\u7684\u5e73\u65b9\u7684\u96c6\u5408\u7b49\u4e8e$\\dfrac{n}{2}$\u6b21\u5355\u4f4d\u6839\u7684\u96c6\u5408\n$$A=\\{\\left(\\omega_n^k\\right)^2|k\\in \\mathbb Z\\}$$\n$$B=\\{\\omega_{\\frac{n}{2}}^k|k\\in\\mathbb Z\\}$$\n$$A\u2286B,B\u2286A\u21d4A=B$$\n$$\\left(\\omega_n^{k+\\frac{n}{2}}\\right)^2=\\omega_n^{n+2k}=\\omega_n^{2k}=\\left(\\omega_n^k\\right)^2$$\n### \u6c42\u548c\u5f15\u7406\n\n$$\\sum_{i=0}^{n-1}\\left(\\omega_n^k\\right)^i=0\\ \\ \\ (k\u2260n)$$\n\u7531\u7b49\u6bd4\u6570\u5217\u7684\u6c42\u548c\u516c\u5f0f\u53ef\u5f97\n$$\\sum_{i=0}^{n-1}\\left(\\omega_n^k\\right)^i=\\frac{1-\\left(\\omega_n^k\\right)^n}{1-\\omega_n^k}=\\frac{1-1}{1-\\omega_n^k}=0$$\n\u5bf9\u4e8e$(k=n)$\n$$\\sum_{k=0}^{n-1}\\left(\\omega_n^k\\right)^i=n$$\n\u5355\u4f4d\u6839\u7684\u5e26\u5165\u53ef\u4ee5\u4f18\u5316\u591a\u9879\u5f0f\u5377\u79ef.\n\n\u6ce8\uff1a\u4ee5\u4e0b\u51fa\u73b0\u7684$n$\u5747\u4e3a$2$\u7684\u6574\u6570\u5e42.\n## \u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362\n\n\u5bf9\u4e8e\u591a\u9879\u5f0f$f(x)=(a_0,a_2,a_3,\\cdots,a_{n-1})$\n\n\u6c42\u89e3$\\forall x_i=\\omega_n^k\\ \\ \\ (i=(0,1,2,\\cdots,n-1))$\u5904\u7684\u70b9\u503c.\n\n\u53ef\u4ee5\u4ee4\n$$y_k=f(x_k)=f(\\omega_n^k)$$\n\u6b64\u8fc7\u7a0b\u8bfb\u4f5c\u957f\u5ea6\u4e3a$n$\u7684\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362\uff0c\u8bb0\u4f5c\n$$y_k=\\text{DFT}_n(f)$$\n## \u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\n\n\u8003\u8651\u5206\u6cbb\n$$f_0(x)=(a_0,a_2,a_4,\\cdots,a_{n-2})$$\n$$f_1(x)=(a_1,a_3,a_5,\\cdots,a_{n-1})$$\n\u4e8e\u662f\u6709\n$$f(x)=f_0(x^2)+xf_1(x^2)$$\n\u5bf9\u4e8e$k<\\dfrac{n}{2}$\uff0c\u6211\u4eec\u6709\n$$f(\\omega_n^k)=f_0(\\omega_n^{2k})+\\omega_n^kf_1(\\omega_n^{2k})=f_0(\\omega_{\\frac{n}{2}}^k)+\\omega_n^kf_1(\\omega_{\\frac{n}{2}}^k)$$\n\u5bf9\u4e8e$k>\\dfrac{n}{2}$\uff0c\u66ff\u6362\u6210$k+\\dfrac{n}{2}$\n$$f\\left(\\omega_n^{k+\\frac{n}{2}}\\right)=f_0\\left(\\omega_{n}^{2k+n}\\right)+\\omega_{n}^{k+\\frac{n}{2}}f_1(\\omega_n^{2k+n})=f_0(\\omega_{\\frac{n}{2}}^k)-\\omega_n^kf_1(\\omega_{\\frac{n}{2}}^k)$$\n\u4ee4\n$$y_k=f(\\omega_n^k)\\ \\ \\ y_k^{[0]}=f_0(\\omega_{\\frac{n}{2}}^k)\\ \\ \\ y_k^{[1]}=f_1(\\omega_{\\frac{n}{2}}^k)$$\n\u7531\u4e0a\u8ff0\u7ed3\u8bba\uff0c\u6211\u4eec\u6709\n$$y_k=y_k^{[0]}+\\omega_n^ky_k^{[1]}$$\n$$y_{k+\\frac{n}{2}}=y_k^{[0]}-\\omega_n^ky_k^{[1]}$$\n\u4e0a\u8ff0\u64cd\u4f5c\u4e3a\u8774\u8776\u64cd\u4f5c\uff0c\u5176\u4e2d$\\omega_n^k$\u4e3a\u65cb\u8f6c\u56e0\u5b50.\n## \u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790\n\n\u4ee4$T(n)$\u4e3a\u957f\u5ea6\u4e3a$n$\u7684\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\u7684\u65f6\u95f4\u590d\u6742\u5ea6\n\n\u9012\u5f52\u6c42\u5f97$y_k^{[0]},y_k^{[1]}$,\u89c4\u6a21\u5747\u4e3a$\\dfrac{n}{2}$\n\n\u5373\n$$T(n)=2T\\left(\\frac{n}{2}\\right)+O(n)=O(n\\log_2n)$$\n## \u5feb\u901f\u5085\u91cc\u53f6\u9006\u53d8\u6362\n\n\u8bbe\u6709\u5411\u91cf$(c_0,c_1,c_2,\\cdots,c_{n-1})$\uff0c\u6ee1\u8db3\n$$c_k=\\sum_{i=0}^{n-1}y_i(\\omega_n^{-k})^i$$\n\u5c55\u5f00$y_i$\uff0c\u6211\u4eec\u6709\n$$c_k=\\sum_{i=0}^{n-1}\\sum_{j=0}^{n-1}a_j(\\omega_n^i)^j(w_n^{-k})^i$$\n$$\\ \\ \\ \\ =\\sum_{i=0}^{n-1}\\sum_{j=0}^{n-1}a_j(\\omega_n^j)^i(\\omega_n^{-k})^i$$\n$$=\\sum_{i=0}^{n-1}\\sum_{j=0}^{n-1}a_j(w_n^{j-k})^i\\ \\ \\ $$\n$$=\\sum_{j=0}^{n-1}a_j\\sum_{i=0}^{n-1}(w_n^{j-k})^i\\ \\ \\ $$\n\u8003\u8651\u5230\u6c42\u548c\u5b9a\u7406\n$$\\sum_{i=1}^{n-1}(\\omega_n^k)^i=0\\ \\ \\ (k\u2260n)$$\n\u53d6$j=k$\n$$c_k=ny_k$$\n\u6c42\u89e3\u4ee5\u4e0b$n$\u7684\u9006\u5143\u5c31\u53ef\u4ee5\u4e86\n$$y_k=c_k\\text{rev}(n)$$\n\u4e8e\u662f\u5feb\u901f\u5085\u91cc\u53f6\u9006\u53d8\u6362\u53ea\u9700\u8981\u53d6\u5171\u8f6d\u590d\u6570\u5c31\u884c\u4e86\u3002\n## \u8fed\u4ee3\u6c42\u89e3\n\n\u6211\u4eec\u9700\u8981\u8fd9\u6837\u6c42\u89e3\n\n![](https://cdn.luogu.com.cn/upload/pic/59424.png)\n\n\u5bf9\u4e8e$n=2^k$\uff0c\u8003\u8651\u7b2c$i$\u6b21\u5206\u6cbb\n\n\u4e8c\u8fdb\u5236\u7b2c$i$\u4f4d\u4e3a$0$\uff0c\u653e\u5165\u5de6\u4fa7\uff0c\u6700\u7ec8\u4f4d\u7f6e\u7684\u4e8c\u8fdb\u5236\u7684$k-i$\u4f4d\u4e3a$0$\n\n\u4e8c\u8fdb\u5236\u7b2c$i$\u4f4d\u4e3a$1$\uff0c\u653e\u5165\u53f3\u4fa7\uff0c\u6700\u7ec8\u4f4d\u7f6e\u7684\u4e8c\u8fdb\u5236\u7684$k-i$\u4f4d\u4e3a$1$\n\n\u77e5\u8bc6\u70b9\u8bb2\u5b8c\u4e86\uff0c\u4ee3\u7801\u5982\u4e0b\n```cpp\n#include <cstdio>\n#include <complex>\n\nusing namespace std;\nconst int N = 1e+7 + 1;\nconst double Pi = acos(-1);\nint n, m, rev[N];\ncomplex<double> F[N], G[N], H[N];\n\nint invert(int n) {\n    int bit = 1;\n    while((1 << bit) < n) bit++;\n    return (1 << bit);\n}\nint getint() {\n    int x = 0, f = 1; char c = getchar();\n    while(c < '0' || c > '9') {if(c == '-') f = -1; c = getchar();}\n    while(c >= '0' && c <= '9') x = (x << 1) + (x << 3) + c - '0', c = getchar();\n    return x * f;\n}\nvoid FFT(complex<double> *A, int n, int inv) {\n    int bit = 1;\n    while((1 << bit) < n) bit++;\n    for(int i = 0; i < n; i++) {\n        rev[i] = (rev[i >> 1] >> 1) | ((i & 1) << (bit - 1));\n        if(i < rev[i]) swap(A[i], A[rev[i]]);\n    }\n    for(int mid = 1; mid < n; mid <<= 1) {\n        complex<double> temp(cos(Pi / mid), inv * sin(Pi / mid));\n        for(int i = 0; i < n; i += mid << 1) {\n            complex<double> omega(1, 0);\n            for(int j = 0; j < mid; j++, omega *= temp) {\n                complex<double> x = A[i + j], y = omega * A[i + j + mid];\n                A[i + j] = x + y;\n                A[i + j + mid] = x - y;\n            }\n        }\n    }\n}\nint main()\n{\n    scanf(\"%d %d\", &n, &m);\n    for(int i = 0; i <= n; i++) F[i].real(getint());\n    for(int i = 0; i <= m; i++) G[i].real(getint());\n    FFT(F, invert(n + m), 1);\n    FFT(G, invert(n + m), 1);\n    for(int i = 0; i <= invert(n + m); i++) H[i] = F[i] * G[i];\n    FFT(H, invert(n + m), -1);\n    for(int i = 0; i <= n + m; i++)\n        printf(\"%d \", (int)(H[i].real() / invert(n + m) + 0.5));\n    return 0;\n}\n```\n",
        "postTime": 1558766303,
        "uid": 139340,
        "name": "Gauss0320",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3803\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09"
    },
    {
        "content": "## \u524d\u8a00\n\n\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\uff08$\\text{Fast Fourier Transform,FFT}$ \uff09\u662f\u4e00\u79cd\u80fd\u5728$O(n \\log n)$\u7684\u65f6\u95f4\u5185\u5b8c\u6210\u591a\u9879\u5f0f\u4e58\u6cd5\u7684\u7b97\u6cd5\uff0c\u5728$OI$\u4e2d\u7684\u5e94\u7528\u5f88\u591a\uff0c\u662f\u591a\u9879\u5f0f\u76f8\u5173\u5185\u5bb9\u7684\u57fa\u7840\u3002\u4e0b\u9762\u4ece\u5934\u5f00\u59cb\u4ecb\u7ecd$\\text{FFT}$\u3002\n\n> \u524d\u7f6e\u6280\u80fd\uff1a\u5f27\u5ea6\u5236\u3001\u4e09\u89d2\u51fd\u6570\u3001\u5e73\u9762\u5411\u91cf\u3002\n\n## \u591a\u9879\u5f0f\n\n\u5f62\u5982$f(x)=a_0+a_1x+a_2x^2+...+a_nx^n$\u7684\u5f0f\u5b50\u79f0\u4e3a$x$\u7684$n$\u6b21\u591a\u9879\u5f0f\u3002\u5176\u4e2d$a_0,a_1,...,a_n$\u79f0\u4e3a\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u3002\n\n### \u7cfb\u6570\u8868\u8fbe\u6cd5\n\n\u4e0a\u9762\u5b9a\u4e49\u4e2d\u7684\u8868\u793a\u5c31\u662f\u7cfb\u6570\u8868\u8fbe\u6cd5\u3002\u5176\u7cfb\u6570\u53ef\u770b\u6210$n+1$\u7ef4\u5411\u91cf$\\vec a=(a_0,a_1,...,a_n)$\u3002\n\n### \u70b9\u503c\u8868\u8fbe\u6cd5\n\n\u628a\u591a\u9879\u5f0f\u770b\u6210\u4e00\u4e2a\u51fd\u6570\uff0c\u70b9\u503c\u8868\u793a\u5c31\u7528\u5b83\u56fe\u50cf\u4e0a\u7684$n+1$\u4e2a\u4e0d\u540c\u7684\u70b9$(x_0,y_0),...,(x_n,y_n)$\u6765\u786e\u5b9a\u8fd9\u4e2a\u591a\u9879\u5f0f\u3002\u591a\u9879\u5f0f\u6709\u4e0d\u6b62\u4e00\u4e2a\u70b9\u503c\u8868\u793a\uff0c\u53ef\u4ee5\u8bc1\u660e\u6bcf\u4e2a\u70b9\u503c\u8868\u793a\u786e\u5b9a\u552f\u4e00\u7684\u7cfb\u6570\u8868\u8fbe\u591a\u9879\u5f0f\u3002\n\n## \u590d\u6570\n\n### \u865a\u6570\u5355\u4f4d\n\n$i$\u88ab\u79f0\u4e3a\u865a\u6570\u5355\u4f4d\u3002\u89c4\u5b9a$i=\\sqrt {-1}$\u3002\n\n### \u590d\u5e73\u9762\n\n\u590d\u6570\u7684\u5e73\u9762\u7531$x,y$\u8f74\u7ec4\u6210\u3002$x$\u8f74\u79f0\u4e3a\u5b9e\u8f74\uff0c$y$\u8f74\u79f0\u4e3a\u865a\u8f74\u3002\u5e73\u9762\u5185\u7684\u6bcf\u4e00\u4e2a\u4ece\u539f\u70b9\u5230\u67d0\u4e2a\u70b9$(a,b)$\u7684\u5411\u91cf$\\vec a=(a,b)$\u8868\u793a\u590d\u6570$a+bi$.\n\n\u590d\u6570\u7684\u6a21\u957f\uff1a$\\sqrt {a^2+b^2}$.\u5b9e\u8f74\u5230\u590d\u6570\u5411\u91cf\u7684\u8f6c\u89d2$\\theta$\u79f0\u4e3a\u5e45\u89d2\u3002\n\n### \u590d\u6570\u7684\u57fa\u672c\u8fd0\u7b97\n\n- \u590d\u6570\u7684\u52a0\uff08\u51cf\uff09\u6cd5\uff1a$(a+bi)+(c+di)=(a+c)+(b+d)i$\n\n- \u590d\u6570\u7684\u4e58\u6cd5\uff1a$(a+bi)(c+di)=(ac-bd)+(bc+ad)i$\n\n- \u4e00\u4e2a\u7ed3\u8bba\uff1a\u590d\u6570\u4e58\u6cd5\uff0c**\u6a21\u957f\u76f8\u4e58\uff0c\u5e45\u89d2\u76f8\u52a0**\u3002\n\n### \u5171\u8f6d\u590d\u6570\n\n$a+bi$\u4e0e$a-bi$\u4e92\u4e3a\u5171\u8f6d\u590d\u6570\u3002\n\n### \u5355\u4f4d\u6839\n\n$n$\u6b21\u5355\u4f4d\u6839\u662f\u6ee1\u8db3$z^n=1$\u7684$n$\u4e2a\u590d\u6570\uff0c\u5b83\u4eec\u5747\u5206\u590d\u5e73\u9762\u7684\u5355\u4f4d\u5706\u3002\n\n\u8fd9\u4e9b\u590d\u6570\u6ee1\u8db3\u6a21\u957f\u4e3a$1$\uff0c\u5e45\u89d2\u7684$n$\u500d\u662f$2\\pi$\u7684\u500d\u6570\n\n\u6839\u636e\u6b27\u62c9\u516c\u5f0f\uff1a\n\n**\u6b27\u62c9\u516c\u5f0f**\uff1a$e^{xi}=\\cos x+i \\sin x$\uff0c\u5176\u4e2d$e$\u4e3a\u81ea\u7136\u5bf9\u6570\u7684\u5e95\u6570\uff0c$i$\u4e3a\u865a\u6570\u5355\u4f4d\u3002\n\n\u53ef\u5f97$n$\u6b21\u5355\u4f4d\u6839\u4e3a$e^{\\frac{2\\pi ki}{n}},k\\in [0,n-1]$\n\n\u5f97\uff1a\u8bb0$\\omega_n=e^{\\frac{2\\pi i}{n}},$\u5219$n$\u6b21\u5355\u4f4d\u6839\u4e3a$\\omega_n^0,...,\\omega_n^{n-1}$\n\n### \u5355\u4f4d\u6839\u7684\u6027\u8d28\n\n\u6027\u8d28$1$\uff1a\u6839\u636e\u5b9a\u4e49\u5f97\u5230\uff1a$\\omega_{2n}^{2k}=\\omega_{n}^{k}$\uff08\u6d88\u53bb\u5b9a\u7406\u7684\u7279\u6b8a\u60c5\u5f62\uff09\n\n\u6027\u8d28$2$\uff1a$\\omega_{n}^{\\frac{n}{2}+k}=-\\omega_n^k$\n\n\u8bc1\u660e\uff1a\n\n$\\omega_{n}^{\\frac{n}{2}}=e^{\\frac{2\\pi i}{n} \\frac{n}{2}}=e^{\\pi i}=\\cos \\pi+i \\sin \\pi=-1$\n\n$\\omega_{n}^{\\frac{n}{2}+k}=\\omega_{n}^{\\frac{n}{2}}\\omega_{n}^{k}=-\\omega_n^k$\n\n## Fast Fourier Transform\n\n### \u591a\u9879\u5f0f\u4e58\u6cd5\n\n\u7cfb\u6570\u8868\u8fbe\u7684\u591a\u9879\u5f0f\u4e58\u6cd5\uff1a$c(x)=a(x)b(x)$\uff0c\u5219$c(x)=\\sum_{i=0}^{2n} c_i x^i$\n\n\u5176\u4e2d$c_i=\\sum_{j=0}^{n}a_jb_{i-j}$.\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n^2)$\n\n\u70b9\u503c\u8868\u8fbe\u7684\u591a\u9879\u5f0f\u4e58\u6cd5\uff1a\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n)$\n\n\u56e0\u6b64**\u591a\u9879\u5f0f\u4e58\u6cd5\u7684\u57fa\u672c\u601d\u8def**\u662f\u5148\u63d2\u503c\u5f97\u5230\u70b9\u503c\u8868\u8fbe\uff0c\u518d$O(n)$\u4e58\uff0c\u6700\u540e\u6c42\u503c\u5f97\u5230\u7cfb\u6570\u8868\u8fbe\u3002\n\n\n### DFT\n\n\u628a$n$\u6b21\u5355\u4f4d\u6839$\\omega_n^0,...,\\omega_n^{n-1}$\u5e26\u5165\u591a\u9879\u5f0f$A(x)=a_0+a_1x+...+a_nx^n$\uff0c\n\n\u5f97\u5230\u70b9\u503c\u5411\u91cf$\\vec y=(A(\\omega_n^0),A(\\omega_n^1),...,A(\\omega_n^{n-1}))$\uff0c\n\n\u79f0\u4e3a\u7cfb\u6570\u5411\u91cf$\\vec a=(a_0,a_1,...,a_n)$\u7684**\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362**\uff08$\\text{Discrete Fourier Transform, DFT}$\uff09\uff0c\u5199\u4f5c$\\vec y=\\text{DFT}_n(\\vec a)$\u3002\n\n\u76f4\u63a5\u6c42$\\text{DFT}$\u662f$O(n^2)$\u7684\u3002$\\text{FFT}$\u7684\u5e38\u7528\u7b97\u6cd5$\\text{Cooley-Tukey}$\u4f7f\u7528\u5206\u6cbb\u65b9\u6cd5\u505a\u5230$O(n\\log n)$.\n\n\u4ee5\u4e0b\u8ba8\u8bba\u57fa\u4e8e$n=2^m,m \\in N^*$\uff0c\u82e5\u4e0d\u8db3\u5219\u9ad8\u4f4d\u7cfb\u6570\u8865$0$.\n\n\u8003\u8651\u70b9\u503c\u5411\u91cf\u7684\u7b2c$k+1$\u7ef4\uff1a\uff08\u6ce8\u610f\u8fd9\u91cc\u6700\u9ad8\u6b21\u662f$n-1$\uff09\n\n$A(\\omega_{n}^{k})=\\sum_{i=0}^{n-1}a_i(\\omega_{n}^{k})^{i}=\\sum_{i=0}^{n-1}a_i\\omega_{n}^{ki}$\n\n$=\\sum_{i=0}^{\\frac{n}{2}-1}a_{2i}\\omega_{n}^{2ki}+\\sum_{i=0}^{\\frac{n}{2}-1}a_{2i+1}\\omega_{n}^{2ki+k}$\n\n$=\\sum_{i=0}^{\\frac{n}{2}-1}a_{2i}\\omega_{n}^{2ki}+\\omega_{n}^{k}\\sum_{i=0}^{\\frac{n}{2}-1}a_{2i+1}\\omega_{n}^{2ki}$\n\n\u5229\u7528\u6027\u8d281\uff1a$\\omega_{2n}^{2k}=\\omega_{n}^{k}$\n\n\u5f53$k<\\frac{n}{2}$\u65f6\uff1a\n\n$A(\\omega_{n}^{k})=\\sum_{i=0}^{\\frac{n}{2}-1}a_{2i}\\omega_{\\frac{n}{2}}^{ki}+\\omega_{n}^{k}\\sum_{i=0}^{\\frac{n}{2}-1}a_{2i+1}\\omega_{\\frac{n}{2}}^{ki}$\n\n\u5229\u7528\u6027\u8d282\uff1a$\\omega_{n}^{\\frac{n}{2}+k}=-\\omega_n^k$\n\n\u53ef\u4ee5\u63a8\u51fa\uff1a\n\n$A(\\omega_{n}^{k+\\frac{n}{2}})=(-1)^{\\frac{n}{2}}\\sum_{i=0}^{\\frac{n}{2}-1}a_{2i}\\omega_{\\frac{n}{2}}^{ki}+(-1)^{\\frac{n}{2}}\\omega_{n}^{k+\\frac{n}{2}}\\sum_{i=0}^{\\frac{n}{2}-1}a_{2i+1}\\omega_{\\frac{n}{2}}^{ki}$\n\n\n$A(\\omega_{n}^{k+\\frac{n}{2}})=\\sum_{i=0}^{\\frac{n}{2}-1}a_{2i}\\omega_{\\frac{n}{2}}^{ki}-\\omega_n^k\\sum_{i=0}^{\\frac{n}{2}-1}a_{2i+1}\\omega_{\\frac{n}{2}}^{ki}$\n\n\u4e0a\u9762\u628a\u6c42\u548c\u5206\u6210$0,2,...,n-2$\u4e0e$1,3,...,n-1$\u4e24\u90e8\u5206\uff0c\u628a\u5927\u5c0f\u4e3a$n$\u7684\u95ee\u9898\u8f6c\u5316\u6210\u4e24\u4e2a\u89c4\u6a21\u4e3a$\\frac{n}{2}$\u7684\u5b50\u95ee\u9898\uff0c\u53ef\u4ee5\u8fdb\u884c\u5206\u6cbb\u6c42\u89e3\u4e86\u3002\n\n### IDFT\n\n\u6c42\u503c\u8fc7\u7a0b\u4f7f\u7528**\u79bb\u6563\u5085\u91cc\u53f6\u9006\u53d8\u6362**\uff08$\\text{Inverse Discrete Fourier Transform, IDFT}$\uff09\n\n**\u7ed3\u8bba**\uff1a\u53ea\u8981\u628a$\\text{DFT}$\u7684$\\omega_n$\u90fd\u53d6\u5012\u6570\uff08\u5171\u8f6d\u590d\u6570\uff09\uff0c\u6700\u540e\u9664\u4ee5$n$\u5373\u53ef\u3002\n\n\u8bc1\u660e\uff1a\n\n\u8bbe$\\vec Y=(y_0,y_1,...,y_n)$\u4e3a$\\vec A = (a_0,a_1,...,a_n)$\u7684\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362\u3002\n\n\u8003\u8651\u4e00\u4e2a\u5411\u91cf\uff1a$\\vec C=(c_0,c_1,...,c_n)$\u6ee1\u8db3$c_k=\\sum_{i=0}^{n-1}y_i(\\omega_n^{-k})^i$\n\n\uff08\u5373$\\vec C$\u662f\u591a\u9879\u5f0f$\\vec Y$\u5728$\\omega_n^0,\\omega_n^{-1},...,\\omega_n^{-(n-1)}$\u5904\u7684\u70b9\u503c\uff09\n\n\u5c06\u4e0a\u5f0f\u5c55\u5f00\uff1a\n\n$c_k=\\sum_{i=0}^{n-1}y_i(\\omega_n^{-k})^i$\n\n$=\\sum_{i=0}^{n-1}(\\sum_{j=0}^{n-1}a_j(\\omega_n^i)^j)(\\omega_n^{-k})^i$\n\n$=\\sum_{i=0}^{n-1}(\\sum_{j=0}^{n-1}a_j(\\omega_n^j)^i)(\\omega_n^{-k})^i$\n\n$=\\sum_{i=0}^{n-1}\\sum_{j=0}^{n-1}a_j(\\omega_n^j)^i(\\omega_n^{-k})^i$\n\n$=\\sum_{i=0}^{n-1}\\sum_{j=0}^{n-1}a_j(\\omega_n^{j-k})^i$\n\n$=\\sum_{j=0}^{n-1}a_j(\\sum_{i=0}^{n-1}(\\omega_n^{j-k})^i)$\n\n\u8003\u8651\u4e00\u4e2a\u524d\u7f00\u548c$S(\\omega_n^k)=1+\\omega_n^k+(\\omega_n^k)^2+...+(\\omega_n^k)^{n-1}$\u3002\n\n\u5f53$(\\omega_n^k)\\not = 1$\u5373$k\\not = 0$\u65f6\uff0c\u4f7f\u7528\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u65b9\u6cd5\uff1a\n\n$\\omega_n^kS(\\omega_n^k)=\\omega_n^k+(\\omega_n^k)^2+(\\omega_n^k)^3+...+(\\omega_n^k)^{n}$\n\n$\\omega_n^kS(\\omega_n^k)-S(\\omega_n^k)=(\\omega_n^k)^{n}-1$\n\n$S(\\omega_n^k)=\\frac{(\\omega_n^k)^{n}-1}{\\omega_n^k-1}$\n\n\u5206\u6bcd\u4e0d\u4e3a$0$\uff0c\u5206\u5b50$(\\omega_n^k)^{n}-1=(\\omega_n^n)^{k}-1=1^{k}-1=0$\n\n\u56e0\u6b64$k\\not = 0$\u65f6\uff0c$S(\\omega_n^k)=0$\n\n$k=0$\u65f6\uff0c$S(\\omega_n^k)=n(\\omega_n^k)^0=n$\n\n\u7ee7\u7eed\u8003\u8651\u521a\u521a\u90a3\u4e2a\u5f0f\u5b50\n\n$c_k=\\sum_{j=0}^{n-1}a_j(\\sum_{i=0}^{n-1}(\\omega_n^{j-k})^i)$\n\n\u53ea\u6709$j-k=0$\u65f6$\\sum_{i=0}^{n-1}(\\omega_n^{j-k})^i$\u624d\u4e3a$n$\uff0c\u5426\u5219\u4e3a$0$\u3002\n\n$c_k=a_kn$\n\n\u5f97\u5230\u7ed3\u8bba\uff1a$a_k=\\frac{c_k}{n}$\u3002\n\n\u518d\u6b21\u603b\u7ed3\u4e00\u4e0b\uff0c\u79bb\u6563\u5085\u91cc\u53f6\u9006\u53d8\u6362\u5c31\u662f\u5148\u6c42\u51fa\u591a\u9879\u5f0f\u5728$\\omega_n^0,\\omega_n^{-1},...,\\omega_n^{-(n-1)}$\u5904\u7684\u70b9\u503c\u8868\u793a\uff0c\u518d\u6bcf\u4e00\u9879\u9664\u4ee5$n$\u3002\n\n### \u9012\u5f52\u7248\u4ee3\u7801\n\n\u6309\u7167\u5982\u4e0a\u6240\u8ff0\u7684\u65b9\u6cd5\u53ef\u4ee5\u8f7b\u677e\u5199\u51fa\u4e00\u4efd\u9012\u5f52\u4ee3\u7801\u3002\n\n```cpp\n//Luogu P3803 \u591a\u9879\u5f0f\u4e58\u6cd5\n#include <complex>\n#include <cstdio>\nusing namespace std;\n\ntypedef complex<double> comp;\n\nconst int N = (1 << 20) + 10 << 1;\nconst double PI2 = 2.0 * acos(-1.0);\n\nint read() {\n\tint x = 0; char c = getchar();\n\tfor(; c < '0' || c > '9'; c = getchar()) ;\n\tfor(; c >= '0' && c <= '9'; c = getchar())\n\t\tx = x * 10 + (c & 15);\n\treturn x;\n}\n\nint n, m;\ncomp a[N], b[N];\n\nvoid fft(int n, comp * a, int type) {\n\tif(n == 1) return ;\n\tcomp a1[n >> 1], a2[n >> 1];\n\tfor(int i = 0; i < n; i += 2)\n\t\ta1[i >> 1] = a[i], a2[i >> 1] = a[i + 1];\n\tfft(n >> 1, a1, type), fft(n >> 1, a2, type);\n\tcomp w(1, 0), wn(cos(PI2 / n), type * sin(PI2 / n));\n\tfor(int i = 0; i < n >> 1; i ++, w *= wn)\n\t\ta[i] = a1[i] + w * a2[i], \n\t\ta[i + (n >> 1)] = a1[i] - w * a2[i];\n}\n\nint main() {\n\tn = read(), m = read();\n\tfor(int i = 0; i <= n; i ++) a[i] = read();\n\tfor(int i = 0; i <= m; i ++) b[i] = read();\n\t\n\tint lim = 1;\n\tfor(; lim <= n + m; lim <<= 1) ;\n\t\n\tfft(lim, a, 1), fft(lim, b, 1);\n\tfor(int i = 0; i <= lim; i ++) a[i] *= b[i];\n\tfft(lim, a, -1);\n\t\n\tfor(int i = 0; i <= n + m; i ++)\n\t\tprintf(\"%d \", (int)(0.5 + a[i].real() / lim));\n\treturn 0;\n}\n```\n\n### \u8fed\u4ee3\u4f18\u5316\n\n\u672c\u6765$\\text{double}$\u5e38\u6570\u5c31\u5927\uff0c\u52a0\u4e0a\u9012\u5f52\u5c31\u5361\u7206\u4e86\u554a\uff08$qwq$\uff0c\u56e0\u6b64\u8003\u8651\u4f7f\u7528\u8fed\u4ee3\u5199\u6cd5\u3002\n\n\u901a\u8fc7[\u89c2\u5bdf](http://blog.miskcoo.com/wp-content/uploads/2015/04/bit-reverse.png)\u5f97\u5230\uff1a\u591a\u9879\u5f0f\u7684$i$\u6b21\u9879\u5230\u5206\u6cbb\u8fb9\u754c\u65f6\u4e0b\u6807\u4e3a$r[i]$,$r[i]$\u4e3a$i$\u4e8c\u8fdb\u5236\u7ffb\u8f6c\u540e\u7684\u6570\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u81ea\u5e95\u5411\u4e0a\u8fed\u4ee3\u505a\uff0c\u5e38\u6570\u5927\u6982\u662f\u9012\u5f52\u7248\u7684$1/4$\n\n```cpp\n//Luogu P3803 \u591a\u9879\u5f0f\u4e58\u6cd5 - \u8fed\u4ee3FFT \n#include <complex>\n#include <cstdio>\nusing namespace std;\n\ntypedef complex<double> comp;\n\nconst int N = (1 << 21) + 10;\nconst double PI = acos(-1);\n\nint read() {\n\tint x = 0; char c = getchar();\n\tfor(; c < '0' || c > '9'; c = getchar()) ;\n\tfor(; c >= '0' && c <= '9'; c = getchar())\n\t\tx = x * 10 + (c & 15);\n\treturn x;\n}\n\nint n, m, lim, r[N];\ncomp a[N], b[N];\n\nvoid fft(comp * a, int type) {\n\tfor(int i = 0; i < lim; i ++)\n\t\tif(i < r[i]) swap(a[i], a[r[i]]);\n\tfor(int i = 1; i < lim; i <<= 1) {\n\t\tcomp x(cos(PI / i), type * sin(PI / i));\n\t\tfor(int j = 0; j < lim; j += (i << 1)) {\n\t\t\tcomp y(1, 0);\n\t\t\tfor(int k = 0; k < i; k ++, y *= x) {\n\t\t\t\tcomp p = a[j + k], q = y * a[j + k + i];\n\t\t\t\ta[j + k] = p + q; a[j + k + i] = p - q;\n\t\t\t}\n\t\t}\n\t}\n}\n\nint main() {\n\tn = read(), m = read();\n\tfor(int i = 0; i <= n; i ++) a[i] = read();\n\tfor(int i = 0; i <= m; i ++) b[i] = read();\n\t\n\tint l = 0;\n\tfor(lim = 1; lim <= n + m; lim <<= 1) ++ l;\n\tfor(int i = 0; i < lim; i ++)\n\t\tr[i] = (r[i >> 1] >> 1) | ((i & 1) << (l - 1));\n\t\t\n\tfft(a, 1), fft(b, 1);\n\tfor(int i = 0; i <= lim; i ++) a[i] *= b[i];\n\tfft(a, -1);\n\t\n\tfor(int i = 0; i <= n + m; i ++)\n\t\tprintf(\"%d \", (int)(0.5 + a[i].real() / lim));\n\treturn 0;\n}\n```\n\n## \u7ed3\u8bed\n\n\u6211\u53ef\u80fd\u6709\u4e9b\u8fc7\u7a0b\u5199\u7684\u6bd4\u8f83\u8be6\u7ec6\u548c\u5197\u957f\uff0c\u56e0\u4e3adalao\u4eec\u7684\u535a\u5ba2\u603b\u662f\u7701\u7565\u4e00\u4e9b\u6b65\u9aa4\u8ba9\u6211\u601d\u8003\u534a\u5929qwq\n\n\u53c2\u8003\u535a\u5ba2\uff1a\n- [Algocode \u7684\u7b97\u6cd5\u4e4b\u8def](https://algocode.net/2018/05/03/20180503-KB-Fast-Fourier-Transform/) \n- [RabbitHu's Blog](http://www.cnblogs.com/RabbitHu/p/FFT.html)\n- [Attack's Blog](http://www.cnblogs.com/zwfymqz/p/8244902.html)\n\n\n\n\n\n\n\n",
        "postTime": 1542546132,
        "uid": 20375,
        "name": "hongzy",
        "ccfLevel": 9,
        "title": "\u300cNote\u300dFast Fourier Transform"
    },
    {
        "content": "\u4e13\u95e8\u7ed9\u61d2\u4eba\u770b\u7684 FFT\u3002\n\n**The procedure, since we're good at Mathematics, are ignored!**\n\n#### \u524d\u7f6e\u829d\u58eb\n\u9996\u5148\u6211\u4eec\u9700\u8981\u590d\u6570\u548c\u5355\u4f4d\u6839\uff0c\u53ef\u4ee5\u53c2\u8003\u521d\u4e2d\u5c0f\u84dd\u672c 1 \u7684 11 \u7ae0\u3002\n\n\u8bb0 $\\omega_n$ \u4e3a\u975e\u5b9e\u6570\u7684\u5e45\u89d2\u6700\u5c0f\u7684 n \u6b21\u5355\u4f4d\u6839\uff0c\u5b83\u662f $\\cos(\\frac{2\\pi}{n})+i\\sin(\\frac{2\\pi}{n})$, \u5219\u6709 $\\forall i \\in [0,n]$, $\\omega_n^i$ \u4e3a n \u6b21\u5355\u4f4d\u6839\u3002\n\n\u524d\u7f6e\u6570\u5b66\u829d\u58eb\u5176\u5b9e\u6ca1\u522b\u4eba\u8bf4\u7684\u90a3\u4e48\u590d\u6742\uff0c\u5c31\u8fd9\u4e9b\u3002\n\n\u5f53\u7136\u8fd8\u9700\u8981\u4e00\u4e9b\u591a\u9879\u5f0f\u7684\u829d\u58eb\u2014\u2014\n\n#### \u591a\u9879\u5f0f\u70b9\u503c\u8868\u793a\n\n\u5bf9\u4e8e\u4e00\u4e2a n\uff0d1 \u6b21\uff08\u6700\u9ad8\u6b21\u9879\u6b21\u6570\u4e3a n\uff0d1\uff09\u591a\u9879\u5f0f\uff0c\u628a\u5b83\u770b\u6210\u4e00\u4e2a\u51fd\u6570\uff0c\u90a3\u4e48\u4e00\u5b9a\u53ef\u4ee5\u7528\u5e73\u9762\u4e0a\u7684 n \u4e2a\u70b9\u786e\u5b9a\u5b83\u3002 \n\n\uff08~~\u663e\u7136~~\uff0c\u542b\u6709 n \u4e2a\u4e92\u76f8\u72ec\u7acb\u7684\u65b9\u7a0b\u7684 n \u5143\u7ebf\u6027\u65b9\u7a0b\u7ec4\u53ea\u6709\u4e00\u7ec4\u89e3\uff09\n\n\u90a3\u4e48\u8981\u6c42 $f \\cdot g$ \u5373 $f$, $g$ \u7684\u5377\u79ef\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u7528\u70b9\u503c\u8868\u793a\u6765\u6c42\u3002\n\n**~~\u4f17\u6240\u5468\u77e5~~\uff0c\u4e0b\u6587\u4e2d\u7684 n \u90fd\u662f 2 \u7684\u6574\u6570\u6b21\u5e42**\n\n\u9009\u5b9a\u6a2a\u5750\u6807 $x_1,x_2\u2026x_n$ \u627e\u51fa\u5bf9\u5e94\u7684\u51fd\u6570\u503c $f_1,f_2...f_n$ \u548c $g_1,g_2...g_n$\uff0c\u5219\u6211\u4eec\u8981\u7684\u5377\u79ef\u591a\u9879\u5f0f\u5728 $\\{x_n\\}$ \u5904\u7684\u51fd\u6570\u503c\u5373\u4e3a $f_1 \\cdot g_1, f_2 \\cdot g_2......f_n \\cdot g_n$\n\n\n\u8fd9\u6837\u5c31\u627e\u51fa\u4e86\u70b9\u503c\u6c42\u5377\u79ef\u6cd5\u3002\n\n**\u4e00\u4e2a\u6b8b\u9177\u7684\u4e8b\u5b9e\uff1a \u8fd9\u8fd8\u662f $O(n^2)$ \u7684**\n\n\u6240\u4ee5\u2014\u2014\n\n#### \u5feb\u901f\u5085\u7acb\u53f6\u53d8\u6362 FFT\uff01\uff01\uff01\n\n\u7136\u800c\u5085\u7acb\u53f6\u544a\u8bc9\u6211\u4eec\uff0c\u9009\u62e9 n \u4e2a\u5355\u4f4d\u6839\u65f6\u4f1a\u6709\u597d\u7ed3\u679c\uff0c\u6211\u4eec\u6765\u770b\u4e00\u4e0b\uff1a\n\n\u73b0\u5728\u6211\u4eec\u8981\u628a\u591a\u9879\u5f0f $A(x) = \\sum_{i=0}^{n-1} a_ix^i$ \u7ed9\u70b9\u503c\u4e86\n\n\u90a3\u4e48\u6211\u4eec\u628a A \u6839\u636e\u7cfb\u6570\u4e0b\u6807\u5947\u5076\u6027\u5206\u6210\u4e24\u90e8\u5206 a1, a2:\n\n$$a1(x)=\\sum_{i=0}^{\\frac{n}{2}-1}a_{2i}x^{2i}$$\n\n$$a2(x)=\\sum_{i=0}^{\\frac{n}{2}-1}a_{2i+1}x^{2i+1}$$\n\n\u53d1\u73b0\uff1a\n\n$$A(x)=a1(x^2)+x \\cdot a2(x^2)$$\n\n**\u73b0\u5728\u6211\u4eec\u4ee3\u5165 n \u4e2a\u5355\u4f4d\u6839\uff01\uff01\uff01**\n\n\u4f46\u6ce8\u610f\u5148\u4ee3\u5165\u524d\u4e00\u534a\uff1a\n\n$$A(\\omega_n^k)=a1(\\omega_{\\frac{n}{2}}^{k})+\\omega_n \\cdot a2(\\omega_{\\frac{n}{2}}^{k})$$\n\n\u540e\u4e00\u534a\uff1a\n\n$$A(\\omega_n^{k+\\frac{n}{2}})=a1(\\omega_{\\frac{n}{2}}^{k})-\\omega_n \\cdot a2(\\omega_{\\frac{n}{2}}^{k})$$\n\n**\u7136\u540e\u6211\u4eec\u53d1\u73b0\u8fd9\u53ea\u9700\u8981 $a1$, $a2$ \u5728 $n/2$ \u4e2a $n/2$ \u6b21\u5355\u4f4d\u6839\u7684\u70b9\u503c\u8868\u793a\u5373\u53ef\u6c42\u51fa\uff0c\u90a3\u6211\u4eec\u5c31\u53ef\u4ee5\u8003\u8651\u5206\u6cbb**\uff0c\u4e14\u524d\u4e00\u534a\u548c\u540e\u4e00\u534a\u53ef\u4ee5\u540c\u65f6\u7b97\n\n\uff08\u6211\u89c9\u5f97\u8fd9\u4e2a\u5e76\u4e0d\u662f\u91cd\u70b9\uff0c\u4e3b\u8981\u662f\u524d\u9762\u90a3\u4e2a\uff09\u3002\n\n#### \u9012\u5f52\u5206\u6cbb\n\n\u6240\u4ee5\uff0c\u5982\u679c\u6211\u4eec\u77e5\u9053\u4e24\u4e2a\u591a\u9879\u5f0f $a1(x)$ \u548c $a2(x)$ \u5206\u522b\u5728 $n/2$ \u4e2a $n/2$ \u6b21\u5355\u4f4d\u6839\u7684\u70b9\u503c\u8868\u793a\uff0c\u5c31\u53ef\u4ee5 $O(n)$ \u6c42\u51fa $A(x)$ \u5728 $n$ \u4e2a $n$ \u6b21\u5355\u4f4d\u6839\u5904\u7684\u70b9\u503c\u8868\u793a\u4e86\u3002\n\n\u800c $a1(x)$ \u548c $A2(x)$ \u90fd\u662f\u89c4\u6a21\u7f29\u5c0f\u4e86\u4e00\u534a\u7684\u5b50\u95ee\u9898\uff0c\u9012\u5f52\u5904\u7406\u3002\n\n\u5206\u6cbb\u8fb9\u754c\u662f $n=1$\uff0c\u6b64\u65f6\u70b9\u503c\u662f $x=1$ \u5904\u7684\u503c\uff0c\u5c31\u662f\u5269\u4e0b\u7684\u4e00\u4e2a\u7cfb\u6570\uff0c\u76f4\u63a5 return\u3002\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u7528 $O(nlogn)$ \u6c42\u51fa\u4e86\u70b9\u503c\u8868\u793a\u7684\u7b54\u6848\u591a\u9879\u5f0f\u3002\n\n\u4f46\u6211\u4eec\u80fd\u8981\u7684\u662f\u7cfb\u6570\u578b\u7684\u666e\u901a\u591a\u9879\u5f0f\u554a\u3002\n\nThis doesn't make any sense!\n\n\u522b\u6025\u2014\u2014\n\n#### IFFT\n\n\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528 FFT \u7684\u9006\u8fc7\u7a0b\uff0c\u628a\u70b9\u503c\u8868\u793a\u4e5f $O(nlogn)$ \u8f6c\u56de\u666e\u901a\u7cfb\u6570\u8868\u793a\u3002\n\n**\u7ed3\u8bba\uff1a\u4e00\u4e2a\u591a\u9879\u5f0f\u5728\u53cd\u5206\u6cbb\u7684\u8fc7\u7a0b\u4e2d\u4e58\u4e0a\u5355\u4f4d\u6839\u7684\u5171\u8f6d\u590d\u6570\uff0c\u5206\u6cbb\u5b8c\u7684\u6bcf\u4e00\u9879 $/n$ \u5373\u4e3a\u539f\u591a\u9879\u5f0f\u7684\u6bcf\u4e00\u9879\u7cfb\u6570**\n\n\u8ff7\u7cca\uff1f\u4ee3\u7801\u2014\u2014\n\n```cpp\n//coder: Feliks*GM-YB\n//FFT\n//acknowledgement: \n//blog.csdn.net/enjoy_pascal/article/details/81478582\n#include<bits/stdc++.h>\n#define fu(i,a,b) for(register int i = a, I = (b) + 1; i < I; ++i)\n#define fd(i,a,b) for(register int i = a, I = (b) - 1; i > I; --i)\ntypedef long long ll;\ntypedef double db;\nusing namespace std;\nconst int N=2e6+1e5;\nconst db pi=acos(-1.0);//\u03c0\ninline int read(){\n    int x=0;char ch=getchar();\n    while(!isdigit(ch))ch=getchar();\n    while(isdigit(ch))x=(x<<1)+(x<<3)+ch-'0',ch=getchar();\n    return x;\n}int n,m;\nstruct cp{//\u590d\u6570\uff0cx\u662f\u5b9e\u90e8\uff0cy\u662f\u865a\u90e8 \n\tdb x,y;\n\tcp(){x=y=0;}\n\tcp(db xx,db yy){x=xx,y=yy;}\n}f[N],g[N],ans[N];\n//\u590d\u6570\u8fd0\u7b97 \ncp operator + (cp a,cp b){\n\treturn cp(a.x+b.x,a.y+b.y); \n}cp operator - (cp a,cp b){\n\treturn cp(a.x-b.x,a.y-b.y);\n}cp operator * (cp a,cp b){\n\treturn cp(a.x*b.x-a.y*b.y,a.x*b.y+a.y*b.x);\n}void FFT(int n,cp *a,int t){//t\uff1a1\u8868\u793a\u7cfb\u6570\u8f6c\u70b9\u503c\uff0c-1\u5219\u76f8\u53cd \n\tif(n<=1)return;//\u9012\u5f52\u8fb9\u754c \n\tint mid=n>>1;\n\tcp a1[mid],a2[mid];\n\t//\u6309\u7cfb\u6570\u5947\u5076\u6027\u5206\u51fa a1, a2\n\tfu(i,0,mid-1){\n\t\ta1[i]=a[i<<1];\n\t\ta2[i]=a[i<<1|1];\n\t}//\u9012\u5f52 \n\tFFT(mid,a1,t);\n\tFFT(mid,a2,t);\n\tcp w1(cos(pi/mid),t*sin(pi/mid)),w(1,0),wt;\n\t//w1\uff1a\u5c31\u662f wn\uff0ct\u7684\u8fd0\u7528\u4f7fIFFT\u65f6\u80fd\u4e58\u4e0a\u5171\u8f6d\u590d\u6570 \n\t//w\u662f\u7b2c\u4e00\u4e2a\u5355\u4f4d\u6839\uff0c\u5c31\u662f\u5b9e\u6570 1 \n\tfu(i,0,mid-1){\n\t\twt=w*a2[i];\n\t\t//\u4ee3\u5165\u516c\u5f0f \n\t\ta[i]=a1[i]+wt;//\u6ce8\u610f a1[i] \u8868\u793a\u662f n/2 \u6b21\u5355\u4f4d\u6839 \n\t\ta[i+mid]=a1[i]-wt;\n\t\tw=w*w1;//\u4e0b\u4e00\u4e2a\u5355\u4f4d\u6839 \n\t}\n}\nint main(){\n\tn=read(),m=read();\n\tfu(i,0,n)f[i].x=read();\n\tfu(i,0,m)g[i].x=read();\n\tint k=1;\n\twhile(k<=n+m)k<<=1;//\u8bb0\u5f97\u5417\uff1f\u6211\u4eec\u80fd\u5904\u7406\u7684\u5fc5\u987b\u662f2\u7684\u6574\u6570\u6b21\u5e42 \n\tFFT(k,f,1);\n\tFFT(k,g,1);\n\tfu(i,0,k)\n\t\tans[i]=f[i]*g[i];\n\tFFT(k,ans,-1);\n\tfu(i,0,n+m)printf(\"%d \",(int)(ans[i].x/k+0.5));\n\t//+0.5 \u9632\u6b62\u4e4b\u524d\u4e00\u5806\u4e71\u4e03\u516b\u7cdfdouble\u8fd0\u7b97\u5bfc\u81f4\u7684\u7cbe\u5ea6\u95ee\u9898 \n\treturn 0;\n}\n```\n\n\u4f46\u662f\u3002\u3002\u3002[\u6211\u8c14\u8c14](https://www.luogu.com.cn/record/31915694)\n\n\u8003\u8651\u7528\u66f4\u9ad8\u7aef\u7684\u65b9\u6cd5\u5b9e\u73b0\u2014\u2014\n\n#### \u8fed\u4ee3\u7248FFT\uff01\n\n![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWFnZXMyMDE3LmNuYmxvZ3MuY29tL2Jsb2cvMTEwMTY5Ni8yMDE4MDIvMTEwMTY5Ni0yMDE4MDIxMjA3NDI1MDg1OS0xNTYwODExMDg2LnBuZw)\n\n\u8fd9\u662f\u795e\u4ed9\u201c\u8def\u4eba\u9ed1\u7684\u7eb8\u5dfe\u201d\u9898\u89e3\u91cc\u7684\u7ebf\u6bb5\u6811\uff08\u96fe\n\n**\u6211\u4eec\u53d1\u73b0\u6bcf\u4e2a\u6570\u8fd9\u6837\u5206\u6cbb\u540e\u7684\u4f4d\u7f6e\u662f\u5b83\u7684\u4e8c\u8fdb\u5236\u7ffb\u8f6c\u3002**\n\n\u90a3\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4ece\u4e0b\u5f80\u4e0a\u5408\u5e76\uff0c\u5f53\u7136\u4f4d\u7f6e\u8981\u5148\u8c03\u6574\u4e00\u4e0b\uff0c\u4e0d\u7136\u6700\u540e\u7684\u987a\u5e8f\u662f\u9519\u7684\u3002\n\n\u6211\u4eec\u679a\u4e3e\u8981\u5408\u5e76\u533a\u95f4\u7684\u957f\u5ea6\uff08\u5f53\u7136\u4ece\u5c0f\u5230\u5927\uff0c\u6bcf\u6b21 $\\times 2$\uff09\n\n\u518d\u679a\u4e3e\u8be5\u957f\u5ea6\u7684\u533a\u95f4\uff0c\u7136\u540e\u4ee3\u5165\u516c\u5f0f\u5373\u53ef\u3002\n\n\n```cpp\n//coder: Feliks*GM-YB\n//FFT\n//acknowledgement: \n//blog.csdn.net/enjoy_pascal/article/details/81478582\n#include<bits/stdc++.h>\n#define fu(i,a,b) for(register int i = a, I = (b) + 1; i < I; ++i)\n#define fd(i,a,b) for(register int i = a, I = (b) - 1; i > I; --i)\ntypedef long long ll;\ntypedef double db;\nusing namespace std;\nconst int N=2e6+1e5;\nconst db pi=acos(-1.0);\ninline int read(){\n    int x=0;char ch=getchar();\n    while(!isdigit(ch))ch=getchar();\n    while(isdigit(ch))x=(x<<1)+(x<<3)+ch-'0',ch=getchar();\n    return x;\n}int n,m;\nstruct cp{\n\tdb x,y;\n\tcp(){x=y=0;}\n\tcp(db xx,db yy){x=xx,y=yy;}\n}f[N],g[N],ans[N];\ncp operator + (cp a,cp b){\n\treturn cp(a.x+b.x,a.y+b.y); \n}cp operator - (cp a,cp b){\n\treturn cp(a.x-b.x,a.y-b.y);\n}cp operator * (cp a,cp b){\n\treturn cp(a.x*b.x-a.y*b.y,a.x*b.y+a.y*b.x);\n}int b,rev[N];\n//b\uff1a\u4e8c\u8fdb\u5236\u4f4d\u6570\uff1brev\uff1a\u6bcf\u4e2a\u70b9\u5206\u6cbb\u5b8c\u7684\u4f4d\u7f6e \ninline void FFT(int n,cp *a,int t){//\u8fed\u4ee3\u7248FFT \n\tfu(i,0,n-1)\n\t\tif(i<rev[i])swap(a[i],a[rev[i]]);//\u8c03\u6574\u4f4d\u7f6e\u4f7f\u5408\u5e76\u5b8c\u7684\u987a\u5e8f\u6b63\u786e\n\t//\u6ce8\u610f\u8981\u52a0if\uff0c\u5426\u5219\u4f1aswap\u4e24\u6b21 \n\tfor(int len=1;len<=(n>>1);len<<=1){\n\t\t//len\u662f\u8981\u5408\u5e76\u533a\u95f4\u7684\u534a\u957f\u5ea6\uff0c\u53ef\u53c2\u8003\u90a3\u78d5\u7ebf\u6bb5\u6811 \n\t\tcp w1(cos(pi/len),t*sin(pi/len));\n\t\tfor(int i=0;i<=n-(len<<1);i+=(len<<1)){\n\t\t\tcp w(1,0);\n\t\t\tfu(j,0,len-1){\n\t\t\t\tcp x=a[i+j],y=w*a[i+j+len];\n\t\t\t\t//\u4f7f\u7528\u4ec0\u4e48\u4f20\u8bf4\u4e2d\u7684\u8774\u8776\u64cd\u4f5c\uff08\u660e\u660e\u5f88\u666e\u901a\u4e00\u4e2a\u4f18\u5316\uff09 \n\t\t\t\ta[i+j]=x+y,a[i+j+len]=x-y;//\u4ee3\u5165\u516c\u5f0f\n\t\t\t\tw=w*w1;\n\t\t\t}\n\t\t}\n\t}\n}\nint main(){\n\tn=read(),m=read();\n\tfu(i,0,n)f[i].x=read();\n\tfu(i,0,m)g[i].x=read();\n\tint k=1;\n\twhile(k<=n+m)k<<=1,b++;\n\tfu(i,1,k-1)\n\t\trev[i]=(rev[i>>1]>>1)|((i&1)<<(b-1));\n\t//\u4e8c\u8fdb\u5236\u7ffb\u8f6c\uff0c\u6709\u70b9\u590d\u6742\uff0c\u53ef\u4ee5\u7ec6\u7ec6\u54c1\u5473 \n\tFFT(k,f,1);\n\tFFT(k,g,1);\n\tfu(i,0,k)\n\t\tans[i]=f[i]*g[i];\n\tFFT(k,ans,-1);\n\tfu(i,0,n+m)printf(\"%d \",(int)(ans[i].x/k+0.5)); \n\treturn 0;\n}\n```\n\u90a3\u6211\u4eec\u5c31 AC \u4e86\uff01\uff01\uff01\n\n\u8fd9\u4e2a\u6a21\u677f\u5176\u5b9e\u633a\u597d\u80cc\u7684\uff0c\u7406\u89e3\u4e00\u4e0b\u5927\u6982\u601d\u8def\u5c31\u884c\u4e86\u3002\n\n#### Au revoir",
        "postTime": 1584608243,
        "uid": 104292,
        "name": "YellowBean_Elsa",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09\u3011"
    },
    {
        "content": "# FFT~~(fast fast tle)~~\n\n[LuoguP3803 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09](https://www.luogu.org/problemnew/show/P3803)\n## \u524d\u7f6e\u77e5\u8bc6\uff1a\u590d\u6570\uff0c\u5355\u4f4d\u6839\uff0c\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u8868\u8fbe\u6cd5\uff0c\u591a\u9879\u5f0f\u7684\u70b9\u503c\u8868\u8fbe\u6cd5\n\n- \u590d\u6570\uff1a\n\n\u53ef\u4ee5\u8868\u793a\u4e3a$(a+bi)$\uff0c\u53ef\u4ee5\u770b\u505a\u539f\u70b9\u5230$(a,b)$\u4e00\u4e2a\u5411\u91cf\uff0c\u5176\u4e2d$i=\\sqrt{-1}$\u3002\n\n\u590d\u6570\u53ef\u4ee5\u8fdb\u884c\u52a0\uff0c\u51cf\uff0c\u4e58\uff08\u5411\u91cf\u7684\u9664\u6cd5\u6709\u70b9\u95ee\u9898\uff09\uff0c\u5176\u4e2d\n$$(a+bi)+(c+di)=((a+c)+(b+d)i)$$\n$$(a+bi)-(c+di)=((a-c)+(b-d)i)$$\n$$(a+bi)(c+di)=a(c+di)+bi(c+di)=ac+adi+bci+bdi^2=((ac-bd)+(ad+bc)i)$$\n\u5373\uff1a\n$$(a+bi)(c+di)=((ac-bd)+(ad+bc)i)$$\n\u540c\u65f6\u590d\u6570\u7684\u4e58\u8fd8\u6709\u548c\u5411\u91cf\u4e00\u6837\u7684\u51e0\u4f55\u610f\u4e49\uff1a**\u6a21\u957f\u76f8\u4e58\uff0c\u5e45\u89d2\u76f8\u52a0**\n\n\n- \u5355\u4f4d\u6839\uff1a\n\n\u5728OI\u4e2d\uff0c\u7ecf\u5e38\u7528\u52302\u7684\u6b63\u6574\u6570\u6b21\u5e42\u76f8\u5173\u7684\u6570\uff0c\u56e0\u4e3a\u8fd9\u6837\u65b9\u4fbf\u5904\u7406\uff0c\u4e3a\u65b9\u4fbf\uff0c\u6211\u4eec\u89c4\u5b9a\u4e0b\u6587\u7684$n$\u4e3a2\u7684\u6b63\u6574\u6570\u6b21\u5e42\u3002\n\n\u5b9a\u4e49\uff1a\u5982\u679c$w_n^n=1$\u90a3\u4e48$w_n$\u4e3a$n$\u6b21\u5355\u4f4d\u6839\n\n\u56e0\u4e3a$w_n^n=1$\uff0c\u6839\u636e\u590d\u6570\u4e58\u7684\u51e0\u4f55\u610f\u4e49\uff0c\u53ef\u77e5\u6a21\u957f\u4e3a1\uff0c\u5e45\u89d2\u4e3a$\\frac{2\\pi}{n}$\uff0c\u6613\u5f97\u5355\u4f4d\u6839\n$$w_n=(\\cos(\\frac{2\\pi}{n})+\\sin(\\frac{2\\pi}{n})i)$$\n\u7136\u540e$w^k_n$\u7684\u5e45\u89d2\u4e3a$\\frac{2k\\pi}{n}$\uff0c\u6240\u4ee5\n$$w^k_n=(\\cos(\\frac{2k\\pi}{n})+\\sin(\\frac{2k\\pi}{n})i)$$\n\u5355\u4f4d\u6839\u8fd9\u91cc\u8fd8\u9700\u8981\u4e24\u4e2a\u6027\u8d28\uff1a\n\u6027\u8d28\u4e00\uff1a\n$$w^{2k}_{2n}=(\\cos(\\frac{4k\\pi}{2n})+\\sin(\\frac{4k\\pi}{2n})i)=(\\cos(\\frac{2k\\pi}{n})+\\sin(\\frac{2k\\pi}{n})i)=w^k_n$$\n\u5373\n$$w^{2k}_{2n}=w^k_n$$\n\n\u6027\u8d28\u4e8c\uff1a\n$$w^{k+\\frac{n}{2}}_n=w^kw^{\\frac{n}{2}}=w^k(\\cos(\\frac{n\\pi}{n})+\\sin(\\frac{n\\pi}{n})i)=-w^k$$\n\u5373\n$$w^{k+\\frac{n}{2}}=-w^k$$\n\n- \u591a\u9879\u5f0f\u7684\u7cfb\u6570\u8868\u8fbe\u6cd5:\n\n\u5c31\u662f\u5e73\u65f6\u7684\u8868\u8fbe\u65b9\u6cd5\uff0c\u7528$n+1$\u4e2a\u7cfb\u6570\u8868\u793a\u4e00\u4e2a$n$\u6b21\u591a\u9879\u5f0f\uff0c\u6bd4\u5982\uff1a\n$$f(x)=a_0+a_1x+a_2x^2+a_3x^3+...+a_nx^n$$\n\u8be5\u65b9\u6cd5\u6613\u8bfb\uff0c\u4e5f\u6613\u6c42\u503c\uff0c\u4f46\u5f88\u96be\u5feb\u901f\u6c42\u5377\u79ef\u3002\n\n- \u591a\u9879\u5f0f\u7684\u70b9\u503c\u8868\u8fbe\u6cd5\uff1a\n\n\u5c31\u662f\u7528$n+1$\u4e2a\u70b9\u6765\u8868\u793a\u4e00\u4e2a$n$\u6b21\u591a\u9879\u5f0f\uff0c\u6bd4\u5982\uff1a\n$$f(x)=\\{(x_0,y_0),(x_1,y_1),(x_2,y_2),...,(x_n,y_n)\\}$$\n\u8be5\u65b9\u6cd5\u4e0d\u6613\u7406\u89e3\uff0c\u4f46**\u5f88\u5bb9\u6613\u6c42\u5377\u79ef**\u3002\n\n\u5982\u679c\u4e24\u4e2a\u591a\u9879\u5f0f$f,g$\u6ee1\u8db3$fx_0==gx_0,fx_1==gx_1,...,fx_n==gx_n$\uff0c\u5219\u65b0\u591a\u9879\u5f0f\n$$h(x)=\\{(x_0,fx_0 gx_0),...,(x_n,fx_n gx_n)\\}$$\n\n## \u6b63\u9898\uff1a\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\uff08FFT\uff09\u4ee5\u53ca\u5feb\u901f\u5085\u91cc\u53f6\u9006\u53d8\u6362\uff08IFFT\uff09\n\n\u4ece\u4e0a\u9762\u4e24\u79cd\u591a\u9879\u5f0f\u7684\u8868\u8fbe\u65b9\u5f0f\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5982\u679c\u80fd\u5feb\u901f\u7684\u628a\u591a\u9879\u5f0f\u5728\u7cfb\u6570\u4e0e\u70b9\u503c\u4e2d\u8f6c\u6362\uff0c\u5c31\u53ef\u4ee5\u5feb\u901f\u7684\u83b7\u53d6\u4e24\u4e2a\u591a\u9879\u5f0f\u7684\u5377\u79ef\u3002\n\n- 1\u3001\u7cfb\u6570\u591a\u9879\u5f0f\u8f6c\u70b9\u503c\u591a\u9879\u5f0f\uff08\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\uff09\n\n\u7ed9\u51fa\u591a\u9879\u5f0f\n$$f(x)=a_0+a_1x+a_2x^2+...+a_nx^n$$\n\u6211\u4eec\u9700\u8981\u5feb\u901f\u6c42\u51fa$f(1),f(w_n),...,f(w^{n-1}_{n-1})$\n\u5148\u5c06$f$\u6309\u5947\u5076\u5206\u7c7b\u5206\u4e3a\n$$f(x)=(a_0+a_2x^2+...+a_nx^n)+(a_1x+a_3x^3+...+a_{n-1}x^{n-1})$$\n\u6211\u4eec\u8bbe\n$$f1(x)=a_0+a_2x+...+a_nx^{\\frac{n}{2}}$$\n$$f2(x)=a_1+a_3x+...+a_{n-1}x^{\\frac{n-2}{2}}$$\n\u90a3\u4e48\u6709\n$$f(x)=f1(x^2)+xf2(x^2)$$\n\u5e26\u5165$x=w^k_n$,\n$$f(w^k_n)=f1(w^{2k}_n)+w^k_nf2(w^{2k}_n)$$\n\u5e26\u5165$x=w^{k+\\frac{n}{2}}_n$\n$$f(w^{k+\\frac{n}{2}}_n)=f1(w^{2k+n}_n)+w^{k+\\frac{n}{2}}_nf2(w^{2k+n}_n)$$\n\u6839\u636e\u6027\u8d28\u4e8c\uff0c\u6709\n$$f(w^{k+\\frac{n}{2}}_n)=f1(w^{2k}_n)-w^k_nf2(w^{2k}_n)$$\n\u53ef\u4ee5\u53d1\u73b0$f(w^k_n)$\u548c$f(w^{k+\\frac{n}{2}}_n)$\u4e24\u9879\u53ea\u5dee\u7b2c\u4e8c\u9879\u7684\u7cfb\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u53ea\u7528\u4e00\u534a\u7684\u65f6\u95f4\u5c31\u5904\u7406\u6574\u4e2a\u591a\u9879\u5f0f\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u6211\u4eec\u9012\u5f52\u7684\u5904\u7406\uff0c\u5c31\u53ef\u4ee5\u7528$O(n\\log n)$\u7684\u590d\u6742\u5ea6\u5b9e\u73b0FFT\u3002\n\n- 2\u3001\u70b9\u503c\u591a\u9879\u5f0f\u8f6c\u7cfb\u6570\u591a\u9879\u5f0f\uff08\u5feb\u901f\u5085\u91cc\u53f6\u9006\u53d8\u6362\uff09\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u5f0f\u5b50\u5217\u6210\u4e00\u4e2a\u77e9\u9635\uff08\u6ca1\u5b66\u8fc7\u77e9\u9635\u53ef\u4ee5\u5148\u5b66\u518d\u770b\u6216**\u8df3\u8fc7\u63a8\u5bfc**\uff09\uff1a\n\n\u5176\u4e2d$(a_0,a_1,a_2,...,a_{n-1})$\u4e3a\u7cfb\u6570\u8868\u8fbe\u6cd5\uff0c$(y_0,y_1,y_2,...,y_{n-1})$\u4e3a\u7701\u7565$x$\u7684\u70b9\u503c\u8868\u8fbe\u6cd5\u3002\n\n$$\\left|\\begin{matrix}1&1&1&\\cdots&1\\\\1&w_n&w_n^2&\\cdots&w_n^{n-1}\\\\1&w_n^2&w_n^4&\\cdots&w_n^{2(n-1)}\\\\\\vdots&\\vdots&\\vdots&\\ddots&\\vdots\\\\1&w_n^{n-1}&w_n^{2(n-1)}&\\cdots&w_n^{(n-1)(n-1)}\\end{matrix}\n\\right|\\left|\\begin{matrix}a_0\\\\a_1\\\\a_2\\\\\\vdots\\\\\\ a_{n-1}\\end{matrix}\n\\right|=\\left|\\begin{matrix}y_0\\\\y_1\\\\y_2\\\\\\vdots\\\\\\ y_{n-1}\\end{matrix}\n\\right|$$\n\n\u5982\u679c\u6211\u4eec\u80fd\u5feb\u901f\u6c42\u51fa\u5de6\u8fb9\u8fd9\u4e2a\u77e9\u9635\u7684\u9006\u77e9\u9635\uff0c\u6211\u4eec\u5c31\u80fd\u5feb\u901f\u8f6c\u6362\u3002\n\n\u8003\u8651\u77e9\u9635\u6c42\u9006\uff08$O(n^3)$\u5b8c\u5168\u8d1f\u4f18\u5316\uff09\n\n\u4f46\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u539f\u77e9\u9635\u4e2d\u6240\u6709\u6570\u4e4b\u95f4\u662f\u6709\u5173\u8054\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u8f6c\u6362\u3002\n\n\u8bbe$V$\u4e3a\u539f\u77e9\u9635\uff0c$G$\u4e3a\u9006\u77e9\u9635\uff0c\u8003\u8651\u6700\u7ec8\u77e9\u9635$E$\u5728$(i,j)$\u4e0a\u7684\u503c\uff1a\n\n$$E(i,j)=\\sum\\limits_{k=0}^{n-1}G(j,k) V(k,i)$$\n\n$$=\\sum\\limits_{k=0}^{n-1}G(j,k)w_n^{ki}$$\n\n\n\n\n\u56e0\u4e3a$V$\u548c$G$\u4e92\u9006\uff0c\u6240\u4ee5$E$\u662f\u5355\u4f4d\u77e9\u9635\uff0c\u53ea\u6709\u5f53$i=j$\u65f6\u624d\u4f1a\u6709\u503c1\uff0c\u5426\u5219\u4e3a0\u3002\n$$\\sum\\limits_{k=0}^{n-1}G(j,k)w_n^{ki}=[i==j]$$\n\n\u6211\u4eec\u5148\u8bc1\u660e\u4e00\u4e2a\u5f15\u7406\uff1a\u5f53$k$\u4e0d\u662f$n$\u7684\u500d\u6570\u65f6\n$$\\sum\\limits_{j=0}^{n-1}w_n^{kj}=0$$\n\u7531\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u5f97\n$$\\sum\\limits_{j=0}^{n-1}w_n^{kj}=\\frac{w_n^{kn}-1}{1-w_n^k}=\\frac{1-1}{w_n^k-1}$$\n\u56e0\u4e3a$k$\u4e0d\u662f$n$\u7684\u500d\u6570\uff0c\u6240\u4ee5$w_n^k\\not=1$\uff0c\u5373\u5206\u6bcd\u4e0d\u4e3a0\uff0c\u6240\u4ee5\u8be5\u5f15\u7406\u6210\u7acb\u3002\n\n\u6839\u636e\u8fd9\u4e2a\u5f15\u7406\uff0c\u53ef\u4ee5\u53d1\u73b0\u77e9\u9635$G$\u6709\u4e00\u4e2a\u6bd4\u8f83\u7b80\u5355\u7684\u6784\u9020\u65b9\u5f0f\uff0c\u5373$G(i,j)=w_n^{-ij}$\n\u8fd9\u65f6\n$$E(i,j)=\\sum\\limits_{k=0}w_n^{-jk}w_n^{ki}$$\n$$=\\sum\\limits_{k=0}w_n^{i-j}$$\n\u5f53$i-j$\u4e0d\u4e3a$n$\u7684\u500d\u6570\uff08\u4e0d\u4e3a0\u65f6\uff09\uff0c$E(i,j)=1$\uff0c\u4f46\u5f53$i=j$\u65f6\uff0c\u5df2\u77e5$E(i,j)=n$\uff0c\u8ddf\u5355\u4f4d\u77e9\u9635\u6709\u70b9\u504f\u5dee\uff0c\u6211\u4eec\u5728\u524d\u9762\u52a0\u4e00\u4e2a$\\frac{1}{n}$\u3002\n\n~~\u597d\u5427\uff0c\u8fd9\u4e2a\u63a8\u5bfc\u5176\u5b9e\u6709\u4e9b\u7275\u5f3a\uff0c\u53ea\u7528\u628a\u4ed6\u5f53\u505a\u7ed3\u8bba\u8bb0\u5c31\u53ef\u4ee5\u4e86\u3002~~\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u6709\uff1a\n\n$$\\left|\\begin{matrix}1&1&1&\\cdots&1\\\\1&w_n^{-1}&w_n^{-2}&\\cdots&w_n^{1-n}\\\\1&w_n^{-2}&w_n^{-4}&\\cdots&w_n^{2(1-n)}\\\\\\vdots&\\vdots&\\vdots&\\ddots&\\vdots\\\\1&w_n^{1-n}&w_n^{2(1-n)}&\\cdots&w_n^{(1-n)(1-n)}\\end{matrix}\n\\right|\\left|\\begin{matrix}y_0\\\\y_1\\\\y_2\\\\\\vdots\\\\\\ y_{n-1}\\end{matrix}\n\\right|=\\left|\\begin{matrix}na_0\\\\na_1\\\\na_2\\\\\\vdots\\\\\\ na_{n-1}\\end{matrix}\n\\right|$$\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u7c7b\u4f3c\u7cfb\u6570\u8f6c\u70b9\u503c\u7684\u65b9\u6cd5\u8f6c\u6362\u4e86\uff0c\u53ea\u662f\u8fd9\u8fb9\u7684\u5355\u4f4d\u6839\u8981\u53d6\u53cd\uff0c\u5176\u5b9e\u5728\u4f7f\u7528\u8d77\u6765\u65f6\u5c31\u662f\n$$(a+bi)^{-1}=(a-bi)$$\n\u975e\u5e38\u7b80\u5355\uff0c\u53ea\u7528\u5728FFT\u7684\u57fa\u7840\u4e0a\u7565\u4f5c\u4fee\u6539\u5373\u53ef\u3002\n\n\u6700\u540e\u56e0\u4e3a\u76f4\u63a5\u4e58\u51fa\u6765\u7684\u7b54\u6848\u662f\u771f\u5b9e\u503c\u7684$n$\u500d\uff0c\u6240\u4ee5\u8981\u9664\u4ee5$n$\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5199\u51fa\u6700\u57fa\u672c\u7684\u9012\u5f52\u7248FFT\uff08\u867d\u7136C++\u6709\u81ea\u5e26complex\u7c7b\u578b\uff0c\u4f46\u7528\u8d77\u6765\u4f1a\u6bd4\u8f83\u6162\uff0c\u5efa\u8bae\u624b\u5199\u4e00\u4e2a\uff09\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1000010;\nconst double pi=acos(-1);\nint n,m,lg[N<<1];\nstruct Complex{\n    double x,y;\n    Complex(double x=0,double y=0):x(x),y(y){}\n};\nComplex operator+(Complex a,Complex b){return Complex(a.x+b.x,a.y+b.y);}\nComplex operator-(Complex a,Complex b){return Complex(a.x-b.x,a.y-b.y);}\nComplex operator*(Complex a,Complex b){return Complex(a.x*b.x-a.y*b.y,a.x*b.y+a.y*b.x);}\nComplex c[N<<2],b[N<<2],t[N<<2],s[50];\nvoid fft(Complex *f,int l,int len,int op){\n    if(!len)return;\n    for(int i=l;i<l+(len<<1);++i)t[i]=f[i];\n    for(int i=l;i<l+len;++i)f[i]=t[l+((i-l)<<1)],f[i+len]=t[l+((i-l)<<1|1)];\n    fft(f,l,len>>1,op);\n    fft(f,l+len,len>>1,op);\n    Complex tmp=s[lg[len]],buf=Complex(1,0),d;\n    tmp.y*=op;\n    for(int i=l;i<l+len;++i){\n        d=buf*f[i+len];\n        t[i]=f[i]+d;\n        t[i+len]=f[i]-d;\n        buf=buf*tmp;\n    }\n    for(int i=l;i<l+(len<<1);++i)f[i]=t[i];\n}\nint main(){\n    int n,m;\n    cin>>n>>m;\n    for(int i=2;i<=n+m;++i)lg[i]=lg[i>>1]+1;\n    for(int i=0;i<=n;++i)scanf(\"%lf\",&b[i].x);\n    for(int i=0;i<=m;++i)scanf(\"%lf\",&c[i].x);\n    for(m+=n,n=1;n<=m;n<<=1);\n    for(int i=1,j=0;i<=n;i<<=1,++j)s[j]=Complex(cos(pi/i),sin(pi/i));\n    fft(b,0,n>>1,1);\n    fft(c,0,n>>1,1);\n    for(int i=0;i<n;++i)b[i]=b[i]*c[i];\n    fft(b,0,n>>1,-1);\n    for(int i=0;i<=m;++i)printf(\"%.0lf \",fabs(b[i].x)/n);\n}\n```\n\n\u4f46\u9012\u5f52\u7248\u7684\u7740\u5b9e\u5f88\u6162\uff0c\u8fd9\u65f6\u5c31\u8981\u7528\u5230\u795e\u5947\u7684\uff1a\n\n### \u4e8c\u8fdb\u5236\u53cd\u8f6c\n\n\u56e0\u4e3a\u5f00\u59cb\u7684\u65f6\u5019\u6211\u4eec\u628a\u6240\u6709\u6570\u6309\u5947\u5076\u6027\u5206\u7c7b\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u80fd\u76f4\u63a5\u679a\u4e3e\u533a\u95f4\u957f\u5ea6\u7136\u540e\u5904\u7406\u3002\u4f46\u6b63\u662f\u56e0\u4e3a\u6211\u4eec\u6309\u5947\u5076\u5206\u7c7b\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u6309\u4e8c\u8fdb\u5236\u5206\u7c7b\uff0c\u7136\u540e\u4e00\u4e2a\u6570\u7684\u771f\u5b9e\u4f4d\u7f6e\u5c31\u662f\u8be5\u6570\u7684\u4e0b\u6807\u6309\u4e8c\u8fdb\u5236\u53cd\u8f6c\u540e\u7684\u503c\u3002\n\n\u6c42\u771f\u5b9e\u4f4d\u7f6e\u7684\u65b9\u6cd5\u5176\u5b9e\u5f88\u7b80\u5355\uff1a\n```cpp\nfor(int i=0;i<limit;++i)r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n```\n\u4e00\u4e2a\u6570\u7684\u4e8c\u8fdb\u5236\u53cd\u8f6c\u4e3a\u8fd9\u4e2a\u6570\u96642\u7684\u53cd\u8f6c\u96642\uff08\u5f97\u5230\u540e\uff08l-1\uff09\u4f4d\uff09\uff0c\u5982\u679c\u8fd9\u4e2a\u6570\u7b2c\u4e00\u4f4d\u4e3a1\uff0c\u90a3\u4e48\u628a\u6700\u540e\u4e00\u4f4d\u52a01\u3002\n\u7136\u540e\u5c31\u53ef\u4ee5\u7528\u975e\u9012\u5f52\u7684\u5199\u6cd5\u4f18\u5316\u9012\u5f52\u7684\u5927\u5e38\u6570\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define eps 1e-6\nusing namespace std;\nconst int N=4e6+10;\nconst double pi=acos(-1);\nstruct Complex{\n    double x,y;\n    Complex(double x=0,double y=0):x(x),y(y){}\n};\nComplex operator+(Complex a,Complex b){return Complex(a.x+b.x,a.y+b.y);}\nComplex operator-(Complex a,Complex b){return Complex(a.x-b.x,a.y-b.y);}\nComplex operator*(Complex a,Complex b){return Complex(a.x*b.x-a.y*b.y,a.x*b.y+a.y*b.x);}\nint limit,l;\nint r[N];\nvoid FFT(Complex*f,int op){\n    for(int i=0;i<limit;++i){\n        if(i<r[i])swap(f[i],f[r[i]]); \n    }\n    for(int mid=2;mid<=limit;mid*=2){\n        Complex wn=Complex(cos(2*pi/mid),op*sin(2*pi/mid));\n        for(int j=0;j<limit;j+=mid){\n            Complex w=Complex(1,0);\n            for(int k=j;k<j+mid/2;++k,w=w*wn){\n                Complex x=f[k],y=w*f[k+mid/2];\n                f[k]=x+y;\n                f[k+mid/2]=x-y;\n            }\n        }\n    }\n    if(op==-1){\n        for(int i=0;i<limit;++i){\n            f[i].x/=limit;\n        }\n    }\n}\nint n,m;\nComplex a[N],b[N]; \nint main(){\n    cin>>n>>m;\n    for(int i=0;i<=n;++i)scanf(\"%lf\",&a[i].x);\n    for(int i=0;i<=m;++i)scanf(\"%lf\",&b[i].x);\n    for(limit=1,l=0;limit<=n+m;limit*=2,l++);\n    for(int i=0;i<limit;++i)r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n    FFT(a,1),FFT(b,1);\n    for(int i=0;i<limit;++i)a[i]=a[i]*b[i];\n    FFT(a,-1);\n    for(int i=0;i<=n+m;++i){\n    \tif(fabs(a[i].x)<eps)printf(\"0 \");\n        else printf(\"%.0lf \",a[i].x);\n    }\n}\n```",
        "postTime": 1558352039,
        "uid": 48143,
        "name": "zhenglier",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09\u3011"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\u8bf7\u70b9\u8fd9\u91cc](https://www.cnblogs.com/BrianPeng/p/12251447.html)\n\n### Intro:\n\n\u672c\u7bc7\u535a\u5ba2\u5c06\u4f1a\u4ece\u6734\u7d20\u4e58\u6cd5\u8bb2\u8d77\uff0c\u7ecf\u8fc7\u5206\u6cbb\u4e58\u6cd5\uff0c\u5230\u8fbeFFT\u548cNTT\n\n\u65e8\u5728\u80fd\u591f\u8ba9\u8bfb\u8005\uff08\u4e5f\u8ba9\u81ea\u5df1\uff09\u5145\u5206\u7406\u89e3\u5176\u601d\u60f3\n\n---\n\n## \u6734\u7d20\u4e58\u6cd5\n\n#### \u7ea6\u5b9a\uff1a\u4e24\u4e2a\u591a\u9879\u5f0f\u4e3a$A(x)=\\sum_{i=0}^{n}a_ix^i,B(x)=\\sum_{i=0}^{m}b_ix^i$\n\n### Prerequisite knowledge:\n\n\u521d\u4e2d\u6570\u5b66\u77e5\u8bc6~~\uff08\u624b\u52a8\u6ed1\u7a3d\uff09~~\n\n\u6700\u7b80\u5355\u7684\u591a\u9879\u5f0f\u65b9\u6cd5\u5c31\u662f\u9010\u9879\u76f8\u4e58\u518d\u5408\u5e76\u540c\u7c7b\u9879\uff0c\u5199\u6210\u516c\u5f0f\uff1a\n\n\u82e5$C(x)=A(x)B(x)$\uff0c\u90a3\u4e48$C(x)=\\sum_{i=0}^{n+m}c_ix^i$\uff0c\u5176\u4e2d$c_i=\\sum_{j=0}^ia_jb_{i-j}$\n\n\u4e8e\u662f\u4e00\u4e2a\u6734\u7d20\u4e58\u6cd5\u5c31\u4ea7\u751f\u4e86\uff0c\u89c1\u4ee3\u7801\uff08\u5229\u7528\u67d0\u79cd\u4e27\u5fc3\u75c5\u72c2\u7684\u65b9\u5f0f\u7701\u4e86$b$\u6570\u7ec4\uff09\n\n```cpp\n//This program is written by Brian Peng.\n#pragma GCC optimize(\"Ofast\",\"inline\",\"no-stack-protector\")\n#include<bits/stdc++.h>\nusing namespace std;\n#define Rd(a) (a=read())\n#define Gc(a) (a=getchar())\n#define Pc(a) putchar(a)\nint read(){\n\tregister int x;register char c(getchar());register bool k;\n\twhile(!isdigit(c)&&c^'-')if(Gc(c)==EOF)exit(0);\n\tif(c^'-')k=1,x=c&15;else k=x=0;\n\twhile(isdigit(Gc(c)))x=(x<<1)+(x<<3)+(c&15);\n\treturn k?x:-x;\n}\nvoid wr(register int a){\n\tif(a<0)Pc('-'),a=-a;\n\tif(a<=9)Pc(a|'0');\n\telse wr(a/10),Pc((a%10)|'0');\n}\nsigned const INF(0x3f3f3f3f),NINF(0xc3c3c3c3);\nlong long const LINF(0x3f3f3f3f3f3f3f3fLL),LNINF(0xc3c3c3c3c3c3c3c3LL);\n#define Ps Pc(' ')\n#define Pe Pc('\\n')\n#define Frn0(i,a,b) for(register int i(a);i<(b);++i)\n#define Frn1(i,a,b) for(register int i(a);i<=(b);++i)\n#define Frn_(i,a,b) for(register int i(a);i>=(b);--i)\n#define Mst(a,b) memset(a,b,sizeof(a))\n#define File(a) freopen(a\".in\",\"r\",stdin),freopen(a\".out\",\"w\",stdout)\n#define N (2000010)\nint n,m,a[N],b,c[N];\nsigned main(){\n\tRd(n),Rd(m);\n\tFrn1(i,0,n)Rd(a[i]);\n\tFrn1(i,0,m){Rd(b);Frn1(j,0,n)c[i+j]+=b*a[j];}\n\tFrn1(i,0,n+m)wr(c[i]),Ps;\n\texit(0);\n}\n```\n\n**Time complexity: $O(nm)$\uff0c\u5982\u679c$m=O(n)$\uff0c\u5219\u4e3a$O(n^2)$**\n\n**Memory complexity: $O(n)$**\n\n\u770b\u770b\u6548\u679c\n\n![](https://images.cnblogs.com/cnblogs_com/BrianPeng/1640550/o_200202024540%E6%9C%B4%E7%B4%A0%E4%B9%98%E6%B3%95.PNG)\n\n~~\u610f\u6599\u4e4b\u4e2d~~\uff0c\u6240\u4ee5\u5fc5\u987b\u4f18\u5316\n\n---\n\n## \u6734\u7d20\u5206\u6cbb\u4e58\u6cd5\n\n**P.s \u8fd9\u4e00\u90e8\u5206\u8bb2\u8ff0\u4e86FFT\u7684\u5206\u6cbb\u65b9\u6cd5\uff0c\u4e0eFFT\u8fd8\u662f\u6709\u533a\u522b\u7684\uff0c\u5982\u679c\u5df2\u7ecf\u7406\u89e3\u7684\u53ef\u4ee5\u8df3\u8fc7**\n\n#### \u7ea6\u5b9a\uff1a$n$\u4e3a\u540c\u65f6\u5c5e\u4e8e$A(x),B(x)$\u6b21\u6570\u754c\u7684\u6700\u5c0f\u7684$2$\u7684\u6b63\u6574\u6570\u5e42\uff0c\u5e76\u5c06\u4e24\u4e2a\u591a\u9879\u5f0f\u8bbe\u4e3a$A(x)=\\sum_{i=0}^{n-1}a_ix^i,B(x)=\\sum_{i=0}^{n-1}b_ix^i$\uff0c\u4e0d\u5b58\u5728\u7684\u7cfb\u6570\u8865\u96f6\n\n**\u6b21\u6570\u754c**\uff1a\u4e25\u683c$>$\u4e00\u4e2a\u591a\u9879\u5f0f\u6b21\u6570\u7684\u6574\u6570\uff08E.g \u591a\u9879\u5f0f$P(x)=x^2+x+1$\u7684\u6b21\u6570\u754c\u4e3a$\\geqslant3$\u7684\u6240\u6709\u6574\u6570\uff09\n\n### Reference\uff1a\n\n**\u300a\u7b97\u6cd5\u5bfc\u8bba\u300b**\n\n### Prerequisite knowledge:\n\n**\u5206\u6cbb\u601d\u60f3**\n\n\u73b0\u5728\u6765\u8003\u8651\u5982\u4f55\u53bb\u4f18\u5316\u4e58\u6cd5\n\n\u5c1d\u8bd5\u5c06\u4e24\u4e2a\u591a\u9879\u5f0f\u6309\u7167\u672a\u77e5\u9879\u6b21\u6570\u7684\u5947\u5076\u6027\u5206\u5f00\uff1a\n\n$A(x)=A^{[0]}(x^2)+xA^{[1]}(x^2),B(x)=B^{[0]}(x^2)+xB^{[1]}(x^2)$\n\n\u5176\u4e2d$A^{[0]}(x)=\\sum_{i=0}^{n/2-1}a_{2i}x^i,A^{[1]}(x)=\\sum_{i=0}^{n/2-1}a_{2i+1}x^i$\uff0c$B^{[0]}(x)$\u4e0e$B^{[1]}(x)$\u540c\u7406\n\n\u4e8e\u662f\u4e24\u4e2a\u591a\u9879\u5f0f\u5c31\u88ab\u62c6\u6210\u4e86\u4e24\u4e2a\u6b21\u6570\u754c\u4e3a$n/2$\u7684\u56db\u4e2a\u591a\u9879\u5f0f\u5566\uff1a\n\n**P.s \u4ee5\u4e0b\u7684\u516c\u5f0f\u4e2d\uff0c\u7528$A$\u8868\u793a$A(x)$\uff0c$A^{[0]}$\u548c$A^{[1]}$\u5206\u522b\u8868\u793a$A^{[0]}(x^2)$\u548c$A^{[1]}(x^2)$\uff0c$B$\u540c\u7406**\n\n$AB=(A^{[0]}+xA^{[1]})(B^{[0]}+xB^{[1]})=A^{[0]}B^{[0]}+x(A^{[1]}B^{[0]}+A^{[0]}B^{[1]})+x^2A^{[1]}B^{[1]}$\n\n**\u5728\u6b64\u53ef\u4ee5\u53d1\u73b0\u4e00\u79cd\u5206\u6cbb\u7b97\u6cd5\uff1a\u628a\u4e24\u4e2a\u591a\u9879\u5f0f\u6298\u534a\uff0c\u7136\u540e\u518d\u9012\u5f52\u7b97$4$\u6b21\u591a\u9879\u5f0f\u4e58\u6cd5\uff0c\u6700\u540e\u5408\u5e76\u52a0\u8d77\u6765**\uff08\u53cd\u6b63\u591a\u9879\u5f0f\u52a0\u6cd5\u662f$O(n)$\u7684\uff09\n\n**P.s \u6ce8\u610f\u5408\u5e76\u65b9\u5f0f\uff1a$A^{[0]}$\u548c$A^{[1]}$\u5206\u522b\u8868\u793a$A^{[0]}(x^2)$\u548c$A^{[1]}(x^2)$\uff0c\u6240\u4ee5\u662f\u4ea4\u9519\u7684**\uff0c\u89c1\u4ee3\u7801\n\n\uff08\u4e3a\u4e86\u7701\u7a7a\u95f4\u7528\u4e86vector\uff09\n\n```cpp\n//This program is written by Brian Peng.\n#pragma GCC optimize(\"Ofast\",\"inline\",\"no-stack-protector\")\n#include<bits/stdc++.h>\nusing namespace std;\n#define Rd(a) (a=read())\n#define Gc(a) (a=getchar())\n#define Pc(a) putchar(a)\nint read(){\n\tregister int x;register char c(getchar());register bool k;\n\twhile(!isdigit(c)&&c^'-')if(Gc(c)==EOF)exit(0);\n\tif(c^'-')k=1,x=c&15;else k=x=0;\n\twhile(isdigit(Gc(c)))x=(x<<1)+(x<<3)+(c&15);\n\treturn k?x:-x;\n}\nvoid wr(register int a){\n\tif(a<0)Pc('-'),a=-a;\n\tif(a<=9)Pc(a|'0');\n\telse wr(a/10),Pc((a%10)|'0');\n}\nsigned const INF(0x3f3f3f3f),NINF(0xc3c3c3c3);\nlong long const LINF(0x3f3f3f3f3f3f3f3fLL),LNINF(0xc3c3c3c3c3c3c3c3LL);\n#define Ps Pc(' ')\n#define Pe Pc('\\n')\n#define Frn0(i,a,b) for(register int i(a);i<(b);++i)\n#define Frn1(i,a,b) for(register int i(a);i<=(b);++i)\n#define Frn_(i,a,b) for(register int i(a);i>=(b);--i)\n#define Mst(a,b) memset(a,b,sizeof(a))\n#define File(a) freopen(a\".in\",\"r\",stdin),freopen(a\".out\",\"w\",stdout)\ntypedef vector<int> Vct;\nint n,m,s; \nVct a,b,c;\nvoid add(Vct&a,Vct&b,Vct&c){Frn0(i,0,c.size())c[i]=a[i]+b[i];}\nvoid mlt(Vct&a,Vct&b,Vct&c,int n);\nsigned main(){\n\tRd(n),Rd(m),a.resize(s=1<<int(log2(max(n,m))+1)),b.resize(s),c.resize(s<<1);\n\tFrn1(i,0,n)Rd(a[i]);\n\tFrn1(i,0,m)Rd(b[i]);\n\tmlt(a,b,c,s);\n\tFrn1(i,0,n+m)wr(c[i]),Ps;\n\texit(0);\n}\nvoid mlt(Vct&a,Vct&b,Vct&c,int n){\n\tint n2(n>>1);\n\tVct a0(n2),a1(n2),b0(n2),b1(n2),ab0(n),ab1(n),abm(n);\n\tif(n==1){c[0]=a[0]*b[0];return;}\n\tFrn0(i,0,n2)a0[i]=a[i<<1],a1[i]=a[i<<1|1],b0[i]=b[i<<1],b1[i]=b[i<<1|1];\n\tmlt(a0,b0,ab0,n2),mlt(a1,b1,ab1,n2);\n\tFrn0(i,0,n)c[i<<1]=ab0[i]+(i?ab1[i-1]:0);\n\tmlt(a0,b1,ab0,n2),mlt(a1,b0,ab1,n2),add(ab0,ab1,abm);\n\tFrn0(i,0,n-1)c[i<<1|1]=abm[i];\n}\n```\n\n\u770b\u770b\u6548\u679c\n\n![](https://images.cnblogs.com/cnblogs_com/BrianPeng/1640550/o_200202034033%E6%9C%B4%E7%B4%A0%E5%88%86%E6%B2%BB%E4%B9%98%E6%B3%95.PNG)\n\n\u597d\u50cf\u66f4\u60e8\u2026\u2026\n\n\u4e3a\u4ec0\u4e48\u5462\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u8fd8\u662f$O(n^2)$\u7684\uff0c\u5177\u4f53\u8bc1\u660e\u5982\u4e0b\n\n$T(n)=4T(n/2)+f(n)$\uff0c\u5176\u4e2d$f(n)=O(n)$\uff08\u5c31\u662f$n$\u4f4d\u52a0\u6cd5\u7684\u65f6\u95f4\uff09\n\n\u8fd0\u7528\u4e3b\u65b9\u6cd5\uff0c$a=4,b=2,log_ba=log_2 4=2>1$\uff0c\u6240\u4ee5$T(n)=O(n^{log_ba})=O(n^2)$\n\n\u800c\u4e14\u4e0d\u4ec5\u590d\u6742\u5ea6\u9ad8\uff0c\u5e38\u6570\u56e0\u5b50\u4e5f\u56e0\u4e3a\u9012\u5f52\u53d8\u9ad8\u4e86\n\n~~\u6240\u4ee5\u7ee7\u7eed\u4f18\u5316\u5427\u2026\u2026~~\n\n---\n\n## \u5206\u6cbb\u4e58\u6cd5\n\n\u63a5\u4e0a\u4e0a\u4e00\u90e8\u5206\u7684\u5185\u5bb9\uff0c\u8003\u8651\u5982\u4f55\u4f18\u5316\u65f6\u95f4\u590d\u6742\u5ea6\n\n**\u5148\u6765\u4e00\u4e2a\u5c0f\u63d2\u66f2\uff1a**\u5982\u4f55\u53ea\u505a$3$\u6b21\u4e58\u6cd5\uff0c\u6c42\u51fa\u7ebf\u6027\u591a\u9879\u5f0f$ax+b$\u4e0e$cx+d$\u7684\u4e58\u79ef\n\n\u5148\u770b\u770b\u7ed3\u679c\uff1a$(ax+b)(cx+d)=acx^2+(ad+bc)x+bd$\uff0c\u603b\u5171\u6709$4$\u6b21\u4e58\u6cd5\n\n\u6240\u4ee5\u5982\u679c\u53ea\u7528$3$\u6b21\u4e58\u6cd5\uff0c\u90a3\u4e48$ad+bc$\u5fc5\u987b\u53ea\u80fd\u7528\u4e00\u6b21\u4e58\u6cd5\u5f97\u5230\n\n\u5c1d\u8bd5\u628a$3$\u4e2a\u7cfb\u6570\u52a0\u8d77\u6765\uff0c\u5c31\u662f$ac+ad+bc+bd=(a+b)(c+d)$\n\n\u7b54\u6848\u51fa\u6765\u4e86\uff0c**\u7528$3$\u6b21\u4e58\u6cd5\u5206\u522b\u7b97\u51fa$ac,bd$\u4e0e$(a+b)(c+d)$\uff0c\u90a3\u4e48\u4e2d\u95f4\u9879\u7cfb\u6570$=(a+b)(c+d)-ac-bd$**\n\n**\u56de\u5230\u539f\u9898\u76ee**\n\n$AB=(A^{[0]}+xA^{[1]})(B^{[0]}+xB^{[1]})=A^{[0]}B^{[0]}+x(A^{[1]}B^{[0]}+A^{[0]}B^{[1]})+x^2A^{[1]}B^{[1]}$\n\n\u4e8e\u662f\u4e2d\u95f4\u9879\u4e5f\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\uff1a$A^{[1]}B^{[0]}+A^{[0]}B^{[1]}=(A^{[0]}+A^{[1]})(B^{[0]}+B^{[1]})-A^{[0]}B^{[0]}-A^{[1]}B^{[1]}$\n\n\u6210\u529f\u51cf\u5c11\u4e00\u6b21\u4e58\u6cd5\u8fd0\u7b97\uff0c\u89c1\u4ee3\u7801\n\n```cpp\n//This program is written by Brian Peng.\n#pragma GCC optimize(\"Ofast\",\"inline\",\"no-stack-protector\")\n#include<bits/stdc++.h>\nusing namespace std;\n#define Rd(a) (a=read())\n#define Gc(a) (a=getchar())\n#define Pc(a) putchar(a)\nint read(){\n\tregister int x;register char c(getchar());register bool k;\n\twhile(!isdigit(c)&&c^'-')if(Gc(c)==EOF)exit(0);\n\tif(c^'-')k=1,x=c&15;else k=x=0;\n\twhile(isdigit(Gc(c)))x=(x<<1)+(x<<3)+(c&15);\n\treturn k?x:-x;\n}\nvoid wr(register int a){\n\tif(a<0)Pc('-'),a=-a;\n\tif(a<=9)Pc(a|'0');\n\telse wr(a/10),Pc((a%10)|'0');\n}\nsigned const INF(0x3f3f3f3f),NINF(0xc3c3c3c3);\nlong long const LINF(0x3f3f3f3f3f3f3f3fLL),LNINF(0xc3c3c3c3c3c3c3c3LL);\n#define Ps Pc(' ')\n#define Pe Pc('\\n')\n#define Frn0(i,a,b) for(register int i(a);i<(b);++i)\n#define Frn1(i,a,b) for(register int i(a);i<=(b);++i)\n#define Frn_(i,a,b) for(register int i(a);i>=(b);--i)\n#define Mst(a,b) memset(a,b,sizeof(a))\n#define File(a) freopen(a\".in\",\"r\",stdin),freopen(a\".out\",\"w\",stdout)\ntypedef vector<int> Vct;\nint n,m,s;\nVct a,b,c;\nvoid add(Vct&a,Vct&b,Vct&c){Frn0(i,0,c.size())c[i]=a[i]+b[i];}\nvoid mns(Vct&a,Vct&b,Vct&c){Frn0(i,0,c.size())c[i]=a[i]-b[i];}\nvoid mlt(Vct&a,Vct&b,Vct&c);\nsigned main(){\n\tRd(n),Rd(m),a.resize(s=1<<int(log2(max(n,m))+1)),b.resize(s),c.resize(s<<1);\n\tFrn1(i,0,n)Rd(a[i]);\n\tFrn1(i,0,m)Rd(b[i]);\n\tmlt(a,b,c);\n\tFrn1(i,0,n+m)wr(c[i]),Ps;\n\texit(0);\n}\nvoid mlt(Vct&a,Vct&b,Vct&c){\n\tint n(a.size()),n2(a.size()>>1);\n\tVct a0(n2),a1(n2),b0(n2),b1(n2),ab0(n),ab1(n),abm(n);\n\tif(n==1){c[0]=a[0]*b[0];return;}\n\tFrn0(i,0,n2)a0[i]=a[i<<1],a1[i]=a[i<<1|1],b0[i]=b[i<<1],b1[i]=b[i<<1|1];\n\tmlt(a0,b0,ab0),mlt(a1,b1,ab1);\n\tFrn0(i,0,n)c[i<<1]=ab0[i]+(i?ab1[i-1]:0);\n\tadd(a0,a1,a0),add(b0,b1,b0),mlt(a0,b0,abm),mns(abm,ab0,abm),mns(abm,ab1,abm);\n\tFrn0(i,0,n-1)c[i<<1|1]=abm[i];\n}\n```\n\n\u770b\u770b\u6548\u679c\n\n![](https://images.cnblogs.com/cnblogs_com/BrianPeng/1640550/o_200202041742%E5%88%86%E6%B2%BB%E4%B9%98%E6%B3%95.PNG)\n\n\u6bd4\u6734\u7d20\u5206\u6cbb\u4e58\u6cd5\u597d\u4e00\u70b9\uff0c\u4f46\u662f\u8fd8\u662f\u6ca1\u6734\u7d20\u4e58\u6cd5\u5f3a\uff0c~~\u8fd8\u662f\u5f88\u60e8~~\n\n\u770b\u770b\u8fd9\u4e2a\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff1a\n\n$T(n)=3T(n/2)+f(n)$\uff0c\u5176\u4e2d$f(n)=O(n)$\n\n\u8fd0\u7528\u4e3b\u65b9\u6cd5\uff0c$a=3,b=2,\\log_ba=\\log_2 3\\approx1.58>1$\uff0c\u6240\u4ee5$T(n)=O(n^{\\log_ba})=O(n^{\\log_2 3})$\n\n\u989d\u90a3\u4e0d\u662f\u5e94\u8be5\u6bd4\u6734\u7d20\u7b97\u6cd5\u8981\u597d\u5417\uff0c\u8fd9\u662f\u4ec0\u4e48\u60c5\u51b5\n\nReason 1. \u5206\u6cbb\u4e58\u6cd5\u7684\u5e38\u6570\u56e0\u5b50\u592a\u5927\n\nReason 2. \u6253\u5f00$\\#5$\u6570\u636e\u4e00\u770b\uff0c$n=1,m=3e6$\uff0c\u90a3\u4e48$O(n^{\\log_2 3})$\u7684\u5206\u6cbb\u4e58\u6cd5\u4e5f\u9876\u4e0d\u8fc7$O(nm)$\u7684\u6734\u7d20\u4e58\u6cd5\u554a\u2026\u2026\n\n\u6240\u4ee5\u5c31\u8981\u8bf7\u4e0a\u672c\u6587\u7684\u4e3b\u89d2\u4e86\n\n---\n\n## \u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362 FFT (Fast Fourier Transform)\n\n~~Fairly Frightening Transform~~\n\n**\u7ea6\u5b9a\uff1a$n$\u4e3a\u5c5e\u4e8e$A(x),B(x)$\u7684\u4e58\u79ef$C(x)$\u6b21\u6570\u754c\u7684\u6700\u5c0f\u7684$2$\u7684\u6b63\u6574\u6570\u5e42\uff08\u5373\u6ee1\u8db3$>$\u8f93\u5165$n+m$\u7684\u6700\u5c0f\u7684$2$\u7684\u6b63\u6574\u6570\u5e42\uff09\uff0c\u5e76\u540c\u6837\u5c06\u4e24\u4e2a\u591a\u9879\u5f0f\u8bbe\u4e3a$A(x)=\\sum_{i=0}^{n-1}a_ix^i,B(x)=\\sum_{i=0}^{n-1}b_ix^i$**\n\n### Reference\uff1a\n\n**\u300a\u7b97\u6cd5\u5bfc\u8bba\u300b**\n\n**[\u81ea\u4e3a\u98ce\u6708\u9a6c\u524d\u5352\uff1a\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362(FFT)\u8be6\u89e3](https://www.cnblogs.com/zwfymqz/p/8244902.html)**\n\n### Prerequisite knowledge:\n\n**\u5206\u6cbb\u601d\u60f3**\n\n**\u590d\u6570\u7684\u57fa\u672c\u77e5\u8bc6**\n\n**\u7ebf\u6027\u4ee3\u6570\u7684\u57fa\u672c\u77e5\u8bc6**\n\n### Part 1: \u591a\u9879\u5f0f\u7684\u4e24\u79cd\u8868\u793a\u65b9\u5f0f\n\n#### 1. \u7cfb\u6570\u8868\u8fbe\n\n\u5bf9\u4e00\u4e2a\u6b21\u6570\u754c\u4e3a$n$\u7684\u591a\u9879\u5f0f$A(x)=\\sum_{i=0}^{n-1}a_ix^i$\uff0c\u5176\u7cfb\u6570\u8868\u8fbe\u662f\u5411\u91cf$a=\\left[\\begin{matrix}a_0\\\\a_1\\\\\\vdots\\\\a_{n-1}\\end{matrix} \\right]$\n\n\u4f7f\u7528\u7cfb\u6570\u8868\u8fbe\u65f6\uff0c\u4e0b\u5217\u64cd\u4f5c\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff1a\n\n1. \u6c42\u503c$O(n)$\n\n2. \u52a0\u6cd5$O(n)$\n\n3. \u4e58\u6cd5\u6734\u7d20$O(n^2)$\uff0c\u4f18\u5316$(n^{\\log_2 3})$\uff08\u5373\u5206\u6cbb\u4e58\u6cd5\uff09\n\n#### 2. \u70b9\u503c\u8868\u8fbe\n\n\u4e00\u4e2a\u6b21\u6570\u754c\u4e3a$n$\u7684\u591a\u9879\u5f0f$A(x)$\u7684\u70b9\u503c\u8868\u8fbe\u662f\u4e00\u4e2a\u6709$n$\u4e2a\u70b9\u503c\u5bf9\u6240\u7ec4\u6210\u7684\u96c6\u5408$\\{(x_0,y_0),(x_1,y_1),\\cdots,(x_{n-1},y_{n-1})\\}$\n\n\u8fdb\u884c$n$\u6b21**\u6c42\u503c**\u5c31\u53ef\u4ee5\u628a\u7cfb\u6570\u8868\u8fbe\u8f6c\u5316\u4e3a\u70b9\u503c\u8868\u8fbe\uff0c\u603b\u65f6\u95f4$O(n^2)$\uff0c\u7528\u516c\u5f0f\u8868\u793a\u5c31\u662f\uff1a\n\n$\\left[\\begin{matrix}1&x_0&x_0^2&\\cdots&x_0^{n-1}\\\\1&x_1&x_1^2&\\cdots&x_1^{n-1}\\\\\\vdots&\\vdots&\\vdots&\\ddots&\\vdots\\\\1&x_{n-1}&x_{n-1}^2&\\cdots&x_{n-1}^{n-1}\\end{matrix} \\right]\\left[\\begin{matrix}a_0\\\\a_1\\\\\\vdots\\\\a_{n-1}\\end{matrix} \\right]=\\left[\\begin{matrix}y_0\\\\y_1\\\\\\vdots\\\\y_{n-1}\\end{matrix} \\right]$\n\n\u5176\u4e2d\u5de6\u8fb9\u7684\u77e9\u9635\u8868\u793a\u4e3a$V(x_0,x_1,\\cdots,x_{n-1})$\u79f0\u4e3a**\u8303\u5fb7\u8499\u5fb7\u77e9\u9635**\uff0c\u4e8e\u662f\u53ef\u4ee5\u5c06\u516c\u5f0f\u7b80\u5316\u4e3a$V(x_0,x_1,\\cdots,x_{n-1})a=y$\n\n\u4f7f\u7528\u62c9\u683c\u6717\u65e5\u516c\u5f0f\uff0c\u53ef\u4ee5\u5728$O(n^2)$\u65f6\u95f4\u5c06\u70b9\u503c\u8868\u8fbe\u8f6c\u5316\u4e3a\u7cfb\u6570\u8868\u8fbe\uff0c\u8be5\u8fc7\u7a0b\u79f0\u4e3a**\u63d2\u503c**\n\n\u5bf9\u4e8e\u4e24\u4e2a\u5728\u76f8\u540c\u4f4d\u7f6e\u6c42\u503c\u7684\u70b9\u503c\u8868\u8fbe\u591a\u9879\u5f0f\uff0c\u4e0b\u5217\u64cd\u4f5c\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff1a\n\n1. \u52a0\u6cd5$O(n)$\uff08\u53ea\u8981\u5c06\u5404\u4e2a\u4f4d\u7f6e\u7684$y$\u503c\u76f8\u52a0\u5373\u53ef\uff09\n\n2. \u4e58\u6cd5$O(n)$\uff08\u540c\u7406\uff09\n\n\u6240\u4ee5\u8fd9\u5c31\u662f\u4f7f\u7528FFT\u7684\u539f\u56e0\uff1a\u901a\u8fc7\u7cbe\u5fc3\u9009\u53d6$x$\u503c\uff0c\u53ef\u4ee5\u5728$O(n\\log n)$\u65f6\u95f4\u5b8c\u6210\u6c42\u503c\uff0c\u518d$O(n)$\u4e58\u6cd5\uff0c\u6700\u540e$O(n\\log n)$\u63d2\u503c\n\n\u5085\u91cc\u53f6\u5927\u795e\u7a76\u7adf\u9009\u4e86\u4ec0\u4e48\u795e\u5947\u7684$x$\u503c\u5462\uff0c\u8bf7\u770b\n\n###Part 2: \u5355\u4f4d\u590d\u6570\u6839\u53ca\u5176\u6027\u8d28\n\n**$n$\u6b21\u5355\u4f4d\u590d\u6570\u6839**\u662f\u6ee1\u8db3$\\omega^n=1$\u7684\u590d\u6570$\\omega$\uff0c\u6b63\u597d\u6709$n$\u4e2a\uff0c\u8bb0\u4e3a\uff1a\n\n$\\omega_n^k=e^{2\\pi ik/n}=\\cos(2\\pi k/n)+i\\sin(2\\pi k/n)$\n\n\u5176\u4e2d$\\omega_n=e^{2\\pi i/n}=\\cos(2\\pi /n)+i\\sin(2\\pi /n)$\u88ab\u79f0\u4e3a**\u4e3b$n$\u6b21\u5355\u4f4d\u6839**\uff0c\u6240\u6709\u5176\u4ed6$n$\u6b21\u5355\u4f4d\u6839\u90fd\u662f$\\omega_n$\u7684\u5e42\u6b21\n\n\u53ef\u4ee5\u628a$n$\u4e2a\u5355\u4f4d\u6839\u770b\u4f5c\u662f\u590d\u5e73\u9762\u4e0a\u4ee5\u5355\u4f4d\u5706\u7684$n$\u4e2a\u7b49\u5206\u70b9\u4e3a\u7ec8\u70b9\u7684\u5411\u91cf\uff0c\u5177\u4f53\u539f\u56e0\u5c31\u662f\u590d\u6570\u4e58\u6cd5\u201c\u6a21\u957f\u76f8\u4e58\uff0c\u8f90\u89d2\u76f8\u52a0\u201d\u7684\u89c4\u5f8b\n\n\u5982\u56fe\u8868\u793a\u7684\u662f$8$\u6b21\u5355\u4f4d\u590d\u6570\u6839\u5728\u590d\u5e73\u9762\u4e0a\u7684\u4f4d\u7f6e\n\n![](https://images.cnblogs.com/cnblogs_com/BrianPeng/1640550/o_2002020623258%E6%AC%A1%E5%8D%95%E4%BD%8D%E6%A0%B9.PNG)\n\n\u4e8e\u662f\u5c31\u53ef\u4ee5\u5f97\u5230\u89c4\u5f8b\uff1a$\\omega_n^j\\omega_n^k=\\omega_n^{j+k}=\\omega_n^{(j+k)\\mod n}$\uff0c\u7c7b\u4f3c\u5730$\\omega_n^{-1}=\\omega_n^{n-1}$\n\n#### \u63a5\u4e0b\u6765\u7684\u4e09\u4e2a\u5f15\u7406\u5c31\u662fFFT\u7684\u91cd\u5934\u620f\u5566\n\n#### 1. \u6d88\u53bb\u5f15\u7406\uff1a\u5bf9\u4efb\u4f55\u6574\u6570$n\\geqslant 0,k\\geqslant 0,d>0$\uff0c\u6709$\\omega_{dn}^{dk}=\\omega_n^k$\n\n**Proof: **$\\omega_{dn}^{dk}=(e^{2\\pi i/dn})^{dk}=(e^{2\\pi i/n})^k=\\omega_n^k$\n\n#### 2. \u6298\u534a\u5f15\u7406\uff1a\u5bf9\u4efb\u4f55\u5076\u6570$n$\u548c\u6574\u6570$k$\uff0c\u6709$(\\omega_n^k)^2=(\\omega_n^{k+n/2})^2=\\omega_{n/2}^k$\n\n**Proof: **$(\\omega_n^k)^2=\\omega_n^{2k},(\\omega_n^{k+n/2})^2=\\omega_n^{2k+n}=\\omega_n^{2k}$\uff0c\u6700\u540e\u7528\u6d88\u53bb\u5f15\u7406\uff0c$\\omega_n^{2k}=\\omega_{n/2}^k$\n\n#### 3. \u6c42\u548c\u5f15\u7406\uff1a\u5bf9\u4efb\u4f55\u6574\u6570$n\\geqslant 0$\u4e0e\u975e\u8d1f\u6574\u6570$k:n\\nmid k$\uff0c\u6709$\\sum_{j=0}^{n-1}(\\omega_n^k)^j=0$\n\n**Proof: **\u5229\u7528\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u516c\u5f0f\uff0c$\\sum_{j=0}^{n-1}(\\omega_n^k)^j=\\frac{1-(\\omega_n^k)^n}{1-\\omega_n^k}=\\frac{1-\\omega_n^{nk}}{1-\\omega_n^k}=\\frac{1-1}{1-\\omega_n^k}=0$\uff0c\u4e3a\u4e86\u4f7f\u5206\u6bcd$1-\\omega_n^k\\neq 0$\uff0c\u5fc5\u987b\u6ee1\u8db3$\\omega_n^k\\neq 1\\implies n\\nmid k$\n\n### Part 3: \u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362 DFT (Discrete Fourier Transform)\n\n**DFT**\u5c31\u662f\u5c06\u6b21\u6570\u754c\u4e3a$n$\u7684\u591a\u9879\u5f0f$A(x)$\u5728**$n$\u6b21\u5355\u4f4d\u590d\u6570\u6839**\u4e0a**\u6c42\u503c**\u7684\u8fc7\u7a0b\n\n\u7b80\u5316\u4e00\u4e0b\u8868\u793a\u65b9\u6cd5\uff1a\n\n$V_n=V(\\omega_n^0,\\omega_n^1,\\cdots,\\omega_n^{n-1})=\\left[\\begin{matrix}1&1&1&1&\\cdots&1\\\\1&\\omega_n&\\omega_n^2&\\omega_n^3&\\cdots&\\omega_n^{n-1}\\\\1&\\omega_n^2&\\omega_n^4&\\omega_n^6&\\cdots&\\omega_n^{2(n-1)}\\\\1&\\omega_n^3&\\omega_n^6&\\omega_n^9&\\cdots&\\omega_n^{3(n-1)}\\\\\\vdots&\\vdots&\\vdots&\\vdots&\\ddots&\\vdots\\\\1&\\omega_n^{n-1}&\\omega_n^{2(n-1)}&\\omega_n^{3(n-1)}&\\cdots&\\omega_n^{(n-1)(n-1)}\\end{matrix} \\right]$\n\n\u7528\u516c\u5f0f\u8868\u793a\u5c31\u662f$V_na=y$\uff0c\u4e5f\u8bb0\u4e3a$y=DFT_n(a)$\n\n\u53e6\u5916\uff0c\u53ef\u4ee5\u53d1\u73b0$[V_n]_{ij}=\\omega_n^{ij}\\implies y_i=\\sum_{j=0}^{n-1}[V_n]_{ij}a_j=\\sum_{j=0}^{n-1}\\omega_n^{ij}a_j$\n\n\u7ec8\u4e8e\u53ef\u4ee5\u770b\u770b\u5177\u4f53\u64cd\u4f5c\u4e86\n\n### Part 4: FFT\n\nFFT\u5229\u7528\u5355\u4f4d\u6839\u7684\u7279\u6b8a\u6027\u8d28\u628aDFT\u4f18\u5316\u5230\u4e86$O(n\\log n)$\n\n\u548c\u5206\u6cbb\u4e58\u6cd5\u4e00\u6837\uff0c\u6309\u672a\u77e5\u9879\u6b21\u6570\u7684\u5947\u5076\u6027\u5206\u5f00\uff1a$A(x)=A^{[0]}(x^2)+xA^{[1]}(x^2)$\n\n\u5176\u4e2d$A^{[0]}(x)=\\sum_{i=0}^{n/2-1}a_{2i}x^i,A^{[1]}(x)=\\sum_{i=0}^{n/2-1}a_{2i+1}x^i$\n\n\u8fd9\u65f6\uff0c\u6c42$A(x)$\u5728$\\omega_n^0,\\omega_n^1,\\cdots,\\omega_n^{n-1}$\u7684\u503c\u53d8\u6210\u4e86\uff1a\n\n#### 1. \u6c42$A^{[0]}(x)$\u4e0e$A^{[1]}(x)$\u5728$(\\omega_n^0)^2,(\\omega_n^1)^2,\\cdots,(\\omega_n^{n-1})^2$\u7684\u503c\n\n\u6839\u636e**\u6298\u534a\u5f15\u7406**\uff0c$(\\omega_n^0)^2,(\\omega_n^1)^2,\\cdots,(\\omega_n^{n-1})^2$\u4e2d\u4e24\u4e24\u91cd\u590d\uff0c\u5176\u5b9e\u5c31\u662f**$n/2$\u4e2a$n/2$\u6b21\u5355\u4f4d\u6839**\n\n\u6240\u4ee5\u53ea\u8981\u5bf9\u62c6\u5f00\u7684\u4e24\u4e2a\u591a\u9879\u5f0f\u5206\u522b\u505a$DFT_{n/2}$\u5373\u53ef\uff0c\u5f97\u5230$y^{[0]}$\u4e0e$y^{[1]}$\n\n#### 2. \u5408\u5e76\u7b54\u6848\n\n$\\omega_n^{n/2}=e^{2\\pi i (n/2)/n}=e^{\\pi i}=-1$\uff08\u6839\u636e\u4f20\u8bf4\u4e2d\u7684\u6700\u7f8e\u516c\u5f0f$e^{i\\pi}+1=0$\uff09\n\n\u6240\u4ee5$\\omega_n^{k+n/2}=\\omega_n^k\\omega_n^{n/2}=-\\omega_n^k$\n\n\u6240\u4ee5$y_i=y^{[0]}_i+\\omega_n^i y^{[1]}_i,y_{i+n/2}=y^{[0]}_i-\\omega_n^i y^{[1]}_i,i=0,1,\\cdots,n/2-1$\n\n\u5177\u4f53\u8fd0\u884c\u65f6\uff0c\u5c31\u6bcf\u6b21\u5faa\u73af\u7ed3\u675f\u65f6\u8ba9\u4e00\u4e2a\u521d\u59cb\u4e3a$1$\u7684\u53d8\u91cf$*\\omega_n$\u5373\u53ef\n\n#### \u9012\u5f52\u8fb9\u754c\uff1a$n=1$\uff0c\u90a3\u4e48$w_1^0 a_0=a_0$\uff0c\u6240\u4ee5\u76f4\u63a5\u8fd4\u56de\u81ea\u8eab\n\n\u8ba1\u7b97\u4e00\u4e0b\u65f6\u95f4\u590d\u6742\u5ea6\n\n$T(n)=2T(n/2)+f(n)$\uff0c\u5176\u4e2d$f(n)=O(n)$\uff08\u5408\u5e76\u7b54\u6848\uff09\n\n\u8fd0\u7528\u4e3b\u65b9\u6cd5\uff0c$a=2,b=2,\\log_ba=\\log_2 2=1$\uff0c\u6240\u4ee5$T(n)=O(n^{\\log_ba}\\log n)=O(n\\log n)$~~\uff08\u7686\u5927\u6b22\u559c\uff09~~\n\n### Part 5: \u79bb\u6563\u5085\u91cc\u53f6\u9006\u53d8\u6362\n\n\u53ef\u522b\u9ad8\u5174\u592a\u65e9\uff0c\u8fd8\u6709**\u63d2\u503c**\u54e6\n\n\u56e0\u4e3a$y=DFT_n(a)=V_na$\uff0c\u6240\u4ee5$a=V_n^{-1}y$\uff0c\u8bb0\u4e3a$a=DFT_n^{-1}(y)$\n\n#### \u5b9a\u7406\uff1a\u5bf9$i,j=0,1,\\cdots,n-1$\uff0c\u6709$[V_n^{-1}]_{ij}=\\omega_n^{-ij}/n$\n\n**Proof: **\u8bc1\u660e$V_n^{-1}V_n=I_n$\u5373\u53ef\n\n$[V_n^{-1}V_n]_{ij}=\\sum_{k=0}^{n-1}(\\omega_n^{-ik}/n)\\omega_n^{kj}=\\frac{\\sum_{k=0}^{n-1}\\omega_n^{-ik}\\omega_n^{kj}}{n}=\\frac{\\sum_{k=0}^{n-1}\\omega_n^{(j-i)k}}{n}$\n\n\u5982\u679c$i=j$\uff0c\u5219\u8be5\u503c$=\\frac{\\sum_{k=0}^{n-1}\\omega_n^0}{n}=n/n=1$\n\n\u5426\u5219\uff0c\u56e0\u4e3a$n\\nmid k$\uff0c\u6839\u636e**\u6c42\u548c\u5f15\u7406**\uff0c\u8be5\u503c$=0/n=0$\uff0c\u6240\u4ee5\u6784\u6210\u4e86$I_n$\n\n\u63a5\u4e0b\u6765$a=DFT_n^{-1}(y)=V_n^{-1}y\\implies a_i=\\sum_{j=0}^{n-1}[V_n^{-1}]_{ij}y_j=\\sum_{j=0}^{n-1}(\\omega_n^{-ij}/n)y_j=\\frac{\\sum_{j=0}^{n-1}\\omega_n^{-ij}y_j}{n}$\n\n\u6bd4\u8f83\u4e00\u4e0bDFT\u4e2d$y_i=\\sum_{j=0}^{n-1}\\omega_n^{ij}a_j$\n\n\u53ea\u8981\u8fd0\u7b97\u65f6\u628a$\\omega_n$\u6362\u6210$-\\omega_n$\uff0c\u7136\u540e\u5c06\u6700\u7ec8\u7b54\u6848$/n$\uff0c\u5c31\u628aDFT\u53d8\u6210\u9006DFT\u4e86\n\n\u7ec8\u4e8e\u53ef\u4ee5\u6765\u5230~~\u6fc0\u52a8\u4eba\u5fc3\u7684~~\u5b9e\u73b0\u73af\u8282\u4e86\n\n### Part 6: \u9012\u5f52\u5b9e\u73b0\n\n\u6839\u636e\u524d\u6587\uff0c\u53ea\u8981\u5c06\u5206\u6cbb\u4e58\u6cd5\u7684\u4ee3\u7801\u4fee\u6539\u4e00\u4e0b\u5373\u53ef\n\n\u53ef\u4ee5\u505a\u5230\u76f4\u63a5\u5728\u539f\u5740\u8fdb\u884cFFT\uff0c\u5c31\u662f\u5c06\u5206\u5f00\u7684\u4e24\u4e2a\u591a\u9879\u5f0f\u5206\u7f6e\u5728\u5de6\u53f3\u4e24\u8fb9\n\nSTL\u63d0\u4f9b\u4e86\u73b0\u6210\u7684complex\u7c7b\u53ef\u4f9b\u4f7f\u7528\n\n\u4ee3\u7801\u4e2d\u7528$iv$\u8868\u793a\u662f\u5426\u4e3a\u9006DFT\uff0c\u7528$o$\u5b58\u50a8\u4e3b\u5355\u4f4d\u6839\uff0c\u7528$w$\u7d2f\u79ef\n\n**P.s **\u6700\u540e\u522b\u5fd8\u4e86$/n$\uff0c\u800c\u4e14$+0.5$\u4e3a\u4e86\u56db\u820d\u4e94\u5165\u63d0\u9ad8\u7cbe\u5ea6\n\n```cpp\n//This program is written by Brian Peng.\n#pragma GCC optimize(\"Ofast\",\"inline\",\"no-stack-protector\")\n#include<bits/stdc++.h>\nusing namespace std;\n#define Rd(a) (a=read())\n#define Gc(a) (a=getchar())\n#define Pc(a) putchar(a)\nint read(){\n\tregister int u;register char c(getchar());register bool k;\n\twhile(!isdigit(c)&&c^'-')if(Gc(c)==EOF)exit(0);\n\tif(c^'-')k=1,u=c&15;else k=u=0;\n\twhile(isdigit(Gc(c)))u=(u<<1)+(u<<3)+(c&15);\n\treturn k?u:-u;\n}\nvoid wr(register int a){\n\tif(a<0)Pc('-'),a=-a;\n\tif(a<=9)Pc(a|'0');\n\telse wr(a/10),Pc((a%10)|'0');\n}\nsigned const INF(0x3f3f3f3f),NINF(0xc3c3c3c3);\nlong long const LINF(0x3f3f3f3f3f3f3f3fLL),LNINF(0xc3c3c3c3c3c3c3c3LL);\n#define Ps Pc(' ')\n#define Pe Pc('\\n')\n#define Frn0(i,a,b) for(register int i(a);i<(b);++i)\n#define Frn1(i,a,b) for(register int i(a);i<=(b);++i)\n#define Frn_(i,a,b) for(register int i(a);i>=(b);--i)\n#define Mst(a,b) memset(a,b,sizeof(a))\n#define File(a) freopen(a\".in\",\"r\",stdin),freopen(a\".out\",\"w\",stdout)\ndouble const Pi(acos(-1));\ntypedef complex<double> Cpx;\n#define N (2100000)\nCpx o,w,a[N],b[N],tmp[N],x,y;\nint n,m,s;\nbool iv;\nvoid fft(Cpx*a,int n);\nsigned main(){\n\tRd(n),Rd(m),s=1<<int(log2(n+m)+1);\n\tFrn1(i,0,n)Rd(a[i]);\n\tFrn1(i,0,m)Rd(b[i]);\n\tfft(a,s),fft(b,s);\n\tFrn0(i,0,s)a[i]*=b[i];\n\tiv=1,fft(a,s);\n\tFrn1(i,0,n+m)wr(a[i].real()/s+0.5),Ps;\n\texit(0);\n}\nvoid fft(Cpx*a,int n){\n\tif(n==1)return;\n\tint n2(n>>1);\n\tFrn0(i,0,n2)tmp[i]=a[i<<1],tmp[i+n2]=a[i<<1|1];\n\tcopy(tmp,tmp+n,a),fft(a,n2),fft(a+n2,n2);\n\to={cos(Pi/n2),(iv?-1:1)*sin(Pi/n2)},w=1;\n\tFrn0(i,0,n2)x=a[i],y=w*a[i+n2],a[i]=x+y,a[i+n2]=x-y,w*=o;\n}\n```\n\n**Time complexity: $O(n\\log n)$**\n\n**Memory complexity: $O(n)$**\n\n\u770b\u770b\u6548\u679c\n\n![](https://images.cnblogs.com/cnblogs_com/BrianPeng/1640550/o_200202104816%E9%80%92%E5%BD%92FFT.PNG)\n\n\u6027\u80fd\u5df2\u7ecf\u8d85\u8fc7\u4e86\u6734\u7d20\u4e58\u6cd5\uff08\u5fc5\u7136\u7684\uff09\uff0c\u4f46\u662f\u8fd8\u662f\u6ca1\u6709AC\n\n\u6ce8\u610f\u5230$n,m\\leqslant 1e6$\uff0c\u6240\u4ee5\u4e0d\u4ec5\u8981\u8ba9\u65f6\u95f4\u590d\u6742\u5ea6\u81f3\u5c11$O(n\\log n)$\uff0c\u8fd8\u8981\u4fdd\u6301\u5c0f\u7684\u5e38\u6570\u56e0\u5b50\uff0c\u603b\u4e4b\u9012\u5f52\u8fd8\u4e0d\u591f\u5feb\n\n### Part 6: \u8fed\u4ee3\u5b9e\u73b0\n\n#### \u8bbe$l=\\lceil\\log_2(n+m+1)\\rceil,s=2^l$\uff0c\u90a3\u4e48$A(x),B(x),A(x)B(x)$\u90fd\u662f\u6b21\u6570\u754c\u4e3a$s$\u7684\u591a\u9879\u5f0f\n\n\u73b0\u5728\u9700\u8981\u5bfb\u627e\u5230\u4e00\u79cd\u8fed\u4ee3\u7684\u65b9\u5f0f\uff0c\u4f7f\u7b54\u6848\u81ea\u5e95\u5411\u4e0a\u5408\u5e76\u4ee5\u51cf\u5c11\u5e38\u6570\u56e0\u5b50\n\n\u8fd8\u662f\u50cf\u9012\u5f52\u7248\u4e00\u6837\uff0c\u628a$A^{[0]}(x)$\u653e\u5728\u5de6\u8fb9\uff0c$A^{[1]}(x)$\u653e\u5728\u53f3\u8fb9\n\n\u89c2\u5bdf\u6bcf\u4e00\u5c42\u9012\u5f52\u65f6\u5404\u4e2a\u7cfb\u6570\u6240\u5728\u4f4d\u7f6e\u7684\u89c4\u5f8b\uff0c\u4ee5$s=8$\u4e3a\u4f8b\n\n```\n0-> 0 1 2 3 4 5 6 7\n1-> 0 2 4 6|1 3 5 7\n2-> 0 4|2 6|1 5|3 7\nend 0|4|2|6|1|5|3|7\n```\n\n\u6ca1\u770b\u51fa\u6765\uff1f\u90a3\u5c31\u62c6\u6210\u4e8c\u8fdb\u5236\u770b\u770b\n\n```\n0-> 000 001 010 011 100 101 110 111\n1-> 000 010 100 110|001 011 101 111\n2-> 000 100|010 110|001 101|011 111\nend 000|100|010|110|001|101|011|111\n```\n\n~~\u663e\u7136\u5730~~\u5728\u6700\u540e\u4e00\u5c42\u9012\u5f52\u65f6\uff0c**\u7cfb\u6570\u7f16\u53f7\u6b63\u597d\u662f\u4f4d\u7f6e\u7f16\u53f7\u7684\u53cd\u8f6c**\uff08\u66f4\u51c6\u786e\u7684\u8bf4\u662f\u524d$l$\u4f4d\u7684\u53cd\u8f6c\uff09\n\n**\u4e00\u4e2a\u8f83\u4e3a\u611f\u6027\u7684Proof: **\u56e0\u4e3a\u662f\u6309\u7167\u5947\u5076\u6027\u5206\u7c7b\uff0c\u4e5f\u5c31\u662f\u8bf4\u5728\u7b2c$i$\u5c42\u9012\u5f52\u65f6\u5224\u65ad\u7684\u662f\u8be5\u7f16\u53f7\u4e8c\u8fdb\u5236\u7b2c$i$\u4f4d\uff08\u4ece\u96f6\u5f00\u59cb\uff09\uff0c\u4e3a$0$\u653e\u5de6\u8fb9\uff0c$1$\u653e\u53f3\u8fb9\uff0c\u800c\u653e\u53f3\u8fb9\u7684\u7ed3\u679c\u5c31\u662f\u5b83\u7684\u4f4d\u7f6e\u7f16\u53f7\u7684\u4e8c\u8fdb\u5236\u7b2c$l-i-1$\u4f4d\u662f$1$\n\n\u6240\u4ee5\u5230\u4e86\u9012\u5f52\u6700\u5e95\u5c42\uff0c\u4f4d\u7f6e\u7f16\u53f7\u7684\u4e8c\u8fdb\u5236\u5c31\u6b63\u597d\u662f\u7cfb\u6570\u7f16\u53f7\u4e8c\u8fdb\u5236\u524d$l$\u4f4d\u7684\u53cd\u8f6c\u5566\n\n\u6784\u9020\u6570\u7ec4$r_{0..s-1}$\uff0c\u5176\u4e2d$r_i$\u8868\u793a$i$\u4e8c\u8fdb\u5236\u524d$l$\u4f4d\u7684\u53cd\u8f6c\uff0c\u53ef\u4ee5\u5229\u7528\u9012\u63a8\u5b8c\u6210\uff0c\u5177\u4f53\u8bf7\u81ea\u5df1\u601d\u8003~~\uff08\u6216\u770b\u4ee3\u7801\uff09~~\n\n#### \u8774\u8776\u64cd\u4f5c (Butterfly Operation)\n\n\u5176\u5b9e\u5728\u9012\u5f52\u7248\u4ee3\u7801\u4e2d\u5df2\u7ecf\u51fa\u73b0\uff0c\u4f46\u662f\u8fd9\u91cc\u518d\u8be6\u7ec6\u8bf4\u660e\u4e00\u4e0b\n\n\u8fd8\u8bb0\u5f97$y_i=y^{[0]}_i+\\omega_n^i y^{[1]}_i,y_{i+n/2}=y^{[0]}_i-\\omega_n^i y^{[1]}_i,i=0,1,\\cdots,n/2-1$\u5417\uff1f\n\n\u4f46\u662f\u73b0\u5728\u4e0d\u4f7f\u7528$y$\uff0c\u800c\u662f$a$\u76f4\u63a5\u5408\u5e76\n\n\u56e0\u4e3a\u6309\u7167\u5947\u5076\u6027\u5206\u7f6e\u5728\u4e24\u8fb9\uff0c\u6240\u4ee5$a^{[0]}_i=a_i,a^{[1]}_i=a_{i+n/2}$\n\n\u8bbe$x=a_i,y=\\omega_n^i a_{i+n/2}$\n\n\u90a3\u4e48\u65b0\u7684$a_i=x+y,a_{i+n/2}=x-y$\n\n\u8fd9\u5c31\u662f\u8774\u8776\u64cd\u4f5c\u5566\n\n\u6709\u4e86\u8774\u8776\u64cd\u4f5c\uff0c\u53ea\u8981\u5c06\u6240\u6709\u7cfb\u6570\u6309\u7167$r$\u6570\u7ec4\u7684\u4f4d\u7f6e\u6392\u5217\uff0c\u518d\u8fed\u4ee3\u5408\u5e76\uff0c\u5c31\u5b8c\u6210\u4e86FFT\n\n\u5728\u4ee3\u7801\u4e2d\uff0c\u7528$i,i_2$\u8868\u793a\u5f53\u524d\u5408\u5e76\u4ea7\u751f\u7684\u548c\u5f00\u59cb\u7684\u5e8f\u5217\u957f\u5ea6\uff0c$j$\u8868\u793a\u5408\u5e76\u5e8f\u5217\u7684\u5f00\u5934\u4f4d\u7f6e\uff0c$k$\u63a7\u5236\u6bcf\u4e00\u4f4d\u7684\u5408\u5e76\uff0c\u4e0a\u4ee3\u7801\n\n```cpp\n//This program is written by Brian Peng.\n#pragma GCC optimize(\"Ofast\",\"inline\",\"no-stack-protector\")\n#include<bits/stdc++.h>\nusing namespace std;\n#define Rd(a) (a=read())\n#define Gc(a) (a=getchar())\n#define Pc(a) putchar(a)\nint read(){\n\tregister int u;register char c(getchar());register bool k;\n\twhile(!isdigit(c)&&c^'-')if(Gc(c)==EOF)exit(0);\n\tif(c^'-')k=1,u=c&15;else k=u=0;\n\twhile(isdigit(Gc(c)))u=(u<<1)+(u<<3)+(c&15);\n\treturn k?u:-u;\n}\nvoid wr(register int a){\n\tif(a<0)Pc('-'),a=-a;\n\tif(a<=9)Pc(a|'0');\n\telse wr(a/10),Pc((a%10)|'0');\n}\nsigned const INF(0x3f3f3f3f),NINF(0xc3c3c3c3);\nlong long const LINF(0x3f3f3f3f3f3f3f3fLL),LNINF(0xc3c3c3c3c3c3c3c3LL);\n#define Ps Pc(' ')\n#define Pe Pc('\\n')\n#define Frn0(i,a,b) for(register int i(a);i<(b);++i)\n#define Frn1(i,a,b) for(register int i(a);i<=(b);++i)\n#define Frn_(i,a,b) for(register int i(a);i>=(b);--i)\n#define Mst(a,b) memset(a,b,sizeof(a))\n#define File(a) freopen(a\".in\",\"r\",stdin),freopen(a\".out\",\"w\",stdout)\ndouble const Pi(acos(-1));\ntypedef complex<double> Cpx;\n#define N (2100000)\nCpx a[N],b[N],o,w,x,y;\nint n,m,l,s,r[N];\nvoid fft(Cpx*a,bool iv);\nsigned main(){\n\tRd(n),Rd(m),s=1<<(l=log2(n+m)+1);\n\tFrn1(i,0,n)Rd(a[i]);\n\tFrn1(i,0,m)Rd(b[i]);\n\tFrn0(i,0,s)r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\tfft(a,0),fft(b,0);\n\tFrn0(i,0,s)a[i]*=b[i];\n\tfft(a,1);\n\tFrn1(i,0,n+m)wr(a[i].real()+0.5),Ps;\n\texit(0);\n}\nvoid fft(Cpx*a,bool iv){\n\tFrn0(i,0,s)if(i<r[i])swap(a[i],a[r[i]]);\n\tfor(int i(2),i2(1);i<=s;i2=i,i<<=1){\n\t\to={cos(Pi/i2),(iv?-1:1)*sin(Pi/i2)};\n\t\tfor(int j(0);j<s;j+=i){\n\t\t\tw=1;\n\t\t\tFrn0(k,0,i2){\n\t\t\t\tx=a[j+k],y=w*a[j+k+i2];\n\t\t\t\ta[j+k]=x+y,a[j+k+i2]=x-y,w*=o;\n\t\t\t}\n\t\t}\n\t}\n\tif(iv)Frn0(i,0,s)a[i]/=s;\n}\n```\n\n**Time complexity: $O(n\\log n)$**\n\n**Memory complexity: $O(n)$**\n\n\u770b\u770b\u6548\u679c\n\n![](https://images.cnblogs.com/cnblogs_com/BrianPeng/1640550/o_200202120457FFT.PNG)\n\n~~\u7ec8\u4e8e\u2026\u2026~~\n\n\u5230\u73b0\u5728\u4e3a\u6b62FFT\u7684\u5185\u5bb9\u5df2\u7ecf\u5168\u90e8\u7ed3\u675f\u5566\uff0c\u4e0b\u9762\u662f\u62d3\u5c55\u90e8\u5206\n\n---\n\n## Extension: \u5feb\u901f\u6570\u8bba\u53d8\u6362 NTT (Number Theoretic Transform)\n\n\u867d\u7136FFT\u5177\u6709\u4f18\u79c0\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u4f46\u56e0\u4e3a\u7528\u5230\u4e86\u590d\u6570\uff0c\u4e0d\u53ef\u907f\u514d\u4f1a\u51fa\u73b0\u7cbe\u5ea6\u95ee\u9898\n\n\u5982\u679c\u591a\u9879\u5f0f\u7cfb\u6570\u548c\u7ed3\u679c\u90fd\u662f\u4e00\u5b9a\u8303\u56f4\u975e\u8d1f\u6574\u6570\uff0c\u53ef\u4ee5\u8003\u8651\u4f7f\u7528NTT\u6765\u4f18\u5316\u7cbe\u5ea6\u548c\u65f6\u7a7a\u5e38\u6570\n\n### Reference\uff1a\n\n**\u300a\u7b97\u6cd5\u5bfc\u8bba\u300b**\n\n**[\u81ea\u4e3a\u98ce\u6708\u9a6c\u524d\u5352\uff1a\u5feb\u901f\u6570\u8bba\u53d8\u6362(NTT)\u5c0f\u7ed3](https://www.cnblogs.com/zwfymqz/p/8980809.html)**\n\n### Prerequisite knowledge:\n\n**FFT**\uff08\u5fc5\u987b\u77e5\u9053\u7684\uff09\n\n**\u6a21\u8fd0\u7b97\u57fa\u672c\u77e5\u8bc6**\n\n#### \u539f\u6839\u7684\u6027\u8d28\n\n\u73b0\u5728\u8003\u8651\u6240\u6709\u8fd0\u7b97\u90fd\u5728$mod P$\u610f\u4e49\u4e0b\n\n\u8bbe\u6709\u6b63\u6574\u6570$g$\uff0c\u5982\u679c\u5728$g$\u7684\u6b21\u5e42\u80fd\u591f\u5f97\u5230$<P$\u7684\u4efb\u4f55\u6b63\u6574\u6570\uff0c\u90a3\u4e48\u79f0$g$\u662f$Z_P^*$\u7684**\u539f\u6839**\uff0c\u5176\u4e2d$Z_P^*$\u662f\u6a21$P$\u4e58\u6cd5\u7fa4\uff0c\u5728\u8fd9\u91cc\u4e0d\u591a\u4f5c\u89e3\u91ca\n\n**E.g **\u5bf9\u4e8e$P=7$\uff0c\u8ba1\u7b97\u6240\u6709$<P$\u7684\u6b63\u6574\u6570\u7684\u6b21\u5e42\u6784\u6210\u7684\u96c6\u5408\n\n```\n1-> {1}\n2-> {1,2,4}\n3-> {1,2,3,4,5,6}\n4-> {1,2,4}\n5-> {1,2,3,4,5,6}\n6-> {1,6}\n```\n\n\u6240\u4ee5$3,5$\u5c31\u662f$Z_7^*$\u7684\u539f\u6839\n\n\u5728\u4ee3\u7801\u4e2d\uff0c\u4e00\u822c\u4f7f\u7528\u5927\u8d28\u6570$P=998244353,g=3$\n\n\u539f\u6839\u7684\u7279\u70b9\u5c31\u662f\u5b83\u7684\u6b21\u5e42\u4ee5\u957f\u5ea6\u4e3a$\\phi(P)$\u5faa\u73af\n\n**E.g **$P=7,g=3$\n\n\u90a3\u4e48$g$\u7684\u6b21\u5e42\uff08\u4ece$g^0$\uff09\u5f00\u59cb\u5206\u522b\u662f\uff1a$1,3,2,6,4,5,1,3,2,6,4,5,\\cdots$\n\n\u8fd9\u4e2a\u7279\u6027\u548c\u5355\u4f4d\u6839\u975e\u5e38\u76f8\u4f3c\n\n\u4f46\u662f\u8981\u5b8c\u5168\u66ff\u6362\u5355\u4f4d\u6839\uff0c\u8fd8\u5dee\u4e00\u6b65\n\n####\u5355\u4f4d\u6839\u7684\u4ee3\u66ff\u54c1\n\n\u5728FFT\u4e2d\u4f7f\u7528\u7684\u662f\u5faa\u73af\u957f\u5ea6\u4e3a$n$\uff0c\u4e14\u6ee1\u8db3\u6d88\u53bb\u5f15\u7406\u548c\u6c42\u548c\u5f15\u7406\u7684$n$\u6b21\u5355\u4f4d\u590d\u6570\u6839\uff08\u6298\u534a\u5f15\u7406\u7531\u6d88\u53bb\u5f15\u7406\u63a8\u51fa\uff0c\u6545\u4e0d\u8003\u8651\uff09\n\n\u6240\u4ee5\u4e3a\u4e86\u8ba9\u5faa\u73af\u957f\u5ea6\u4e3a$n$\uff0c\u6211\u4eec\u4e0d\u76f4\u63a5\u4f7f\u7528\u539f\u6839\uff0c\u800c\u662f\u539f\u6839\u7684\u6b21\u5e42\n\n#### \u79bb\u6563\u5bf9\u6570\u5b9a\u7406\uff1a\u5982\u679c$g$\u662f$Z_P^*$\u7684\u4e00\u4e2a\u539f\u6839\uff0c\u5219$x\\equiv y(\\mod\\phi(P))\\iff g^x\\equiv g^y(\\mod P)$\n\n**Proof: **\u8bbe$x\\equiv y(\\mod\\phi(P))$\uff0c\u5219\u5bf9\u67d0\u4e2a\u6574\u6570$k$\u6709$x=y+k\\phi(P)$\n\n\u56e0\u6b64$g^x\\equiv g^{y+k\\phi(P)} \\equiv g^y (g^{\\phi(P)})^k \\equiv g^y 1^k \\equiv g^y (\\mod P)$\uff08\u6839\u636e**\u6b27\u62c9\u5b9a\u7406**\uff09\n\n\u53cd\u8fc7\u6765\uff0c\u56e0\u4e3a\u5faa\u73af\u957f\u5ea6\u662f$\\phi(P)$\uff0c\u5fc5\u5b9a\u6709$x\\equiv y(\\mod\\phi(P))$\n\n\u73b0\u5728\u8003\u8651\u6709\u4e00\u4e2a$g$\u7684\u6b21\u5e42$g^q$\u6ee1\u8db3$g^q$\u7684\u6b21\u5e42\u4ee5\u957f\u5ea6$n$\u5faa\u73af\n\n\u4e5f\u5c31\u662f\u8bf4\u5bf9\u4efb\u610f\u6574\u6570$x\\geqslant0,0<y<n$\uff0c\u6709$g^{qx}\\equiv g^{q(x+n)}\\not\\equiv g^{q(x+y)}(\\mod P)$\n\n\u5373$qx\\equiv q(x+n)\\not\\equiv q(x+y)(\\mod \\phi(P))$\n\n\u5373$0\\equiv qn\\not\\equiv qy(\\mod \\phi(P))$\n\n\u53ef\u5f97$\\phi(P)|qn,\\phi(P)\\nmid qy$\n\n\u90a3\u4e48\u4e3a\u4e86\u4f7f$q$\u7684\u56e0\u6570\u6570\u91cf\u6700\u5c0f\u5316\uff0c$q=\\phi(P)/n$\n\n\u6b64\u65f6$qy=\\phi(P)y/n$\n\n\u56e0\u4e3a$y<n$\uff0c\u6240\u4ee5$qy<\\phi(P)$\uff0c\u5fc5\u5b9a\u6709$\\phi(P)\\nmid qy$\n\n\u6240\u4ee5$q=\\phi(P)/n$\u662f\u53ef\u53d6\u7684\n\n\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c\u4e07\u4e00$\\phi(P)/n$\u4e0d\u662f\u6574\u6570\u600e\u4e48\u529e\uff1f\n\n\u8fd9\u5c31\u5f15\u51fa\u4e86\u5927\u8d28\u6570$P=998244353$\u7684\u53e6\u4e00\u4e2a\u6027\u8d28\uff1a$\\phi(P)=P-1=998244352=2^{23}\\cdot 7\\cdot 17$\n\n\u800c\u6839\u636e\u6570\u636e\u8303\u56f4$n,m\\leqslant1e6$\uff0c\u53ef\u77e5$l\\leqslant 21$\uff0c\u6240\u4ee5$q$\u603b\u662f\u6574\u6570\uff08\u771f\u662f\u4e00\u4e2a\u795e\u5947\u7684\u6570\u5b57\uff09\n\n\u603b\u7ed3\u4e00\u4e0b\uff0c$g^{\\phi(P)/n}=g^{\\frac{P-1}{n}}$\u5c31\u662f$\\omega_n$\u7684\u4ee3\u66ff\u8005\n\n\u6d88\u53bb\u5f15\u7406\uff08\u53ea\u9700\u8003\u8651$d=2$\u7684\u60c5\u51b5\uff09\u548c\u6c42\u548c\u5f15\u7406\u5c31\u8bf7\u5927\u5bb6\u81ea\u5df1\u8bc1\u660e\u4e86\uff08\u5176\u5b9e\u9053\u7406\u90fd\u975e\u5e38\u76f8\u4f3c\uff09\n\n\u6700\u540e\u53ea\u8981\u628a$\\omega_n$\u66ff\u6362\u6389\uff0c\u8fd0\u7b97\u90fd\u6539\u4e3a\u6a21$P$\u610f\u4e49\u4e0b\u7684\u8fd0\u7b97\u5373\u53ef\uff0c\u5728\u7b97$-\\omega_n$\u65f6\u8981\u7528\u5230$g^{-1}=332748118$\uff0c\u8fd8\u6709\u6700\u540e\u7b54\u6848\u522b\u5fd8\u4e86$*s^{-1}$\uff0c\u4e0a\u4ee3\u7801\n\n```cpp\n//This program is written by Brian Peng.\n#pragma GCC optimize(\"Ofast\",\"inline\",\"no-stack-protector\")\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define Rd(a) (a=read())\n#define Gc(a) (a=getchar())\n#define Pc(a) putchar(a)\nint read(){\n\tregister int u;register char c(getchar());register bool k;\n\twhile(!isdigit(c)&&c^'-')if(Gc(c)==EOF)exit(0);\n\tif(c^'-')k=1,u=c&15;else k=u=0;\n\twhile(isdigit(Gc(c)))u=(u<<1)+(u<<3)+(c&15);\n\treturn k?u:-u;\n}\nvoid wr(register int a){\n\tif(a<0)Pc('-'),a=-a;\n\tif(a<=9)Pc(a|'0');\n\telse wr(a/10),Pc((a%10)|'0');\n}\nsigned const INF(0x3f3f3f3f),NINF(0xc3c3c3c3);\nlong long const LINF(0x3f3f3f3f3f3f3f3fLL),LNINF(0xc3c3c3c3c3c3c3c3LL);\n#define Ps Pc(' ')\n#define Pe Pc('\\n')\n#define Frn0(i,a,b) for(register int i(a);i<(b);++i)\n#define Frn1(i,a,b) for(register int i(a);i<=(b);++i)\n#define Frn_(i,a,b) for(register int i(a);i>=(b);--i)\n#define Mst(a,b) memset(a,b,sizeof(a))\n#define File(a) freopen(a\".in\",\"r\",stdin),freopen(a\".out\",\"w\",stdout)\n#define P (998244353)\n#define G (3)\n#define Gi (332748118)\n#define N (2100000)\nint n,m,l,s,r[N],a[N],b[N],o,w,x,y,siv;\nint fpw(int a,int p){return p?a>>1?(p&1?a:1)*fpw(a*a%P,p>>1)%P:a:1;}\nvoid ntt(int*a,bool iv);\nsigned main(){\n\tRd(n),Rd(m),siv=fpw(s=1<<(l=log2(n+m)+1),P-2);\n\tFrn1(i,0,n)Rd(a[i]);\n\tFrn1(i,0,m)Rd(b[i]);\n\tFrn0(i,0,s)r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\tntt(a,0),ntt(b,0);\n\tFrn0(i,0,s)a[i]=a[i]*b[i]%P;\n\tntt(a,1);\n\tFrn1(i,0,n+m)wr(a[i]),Ps;\n\texit(0);\n}\nvoid ntt(int*a,bool iv){\n\tFrn0(i,0,s)if(i<r[i])swap(a[i],a[r[i]]);\n\tfor(int i(2),i2(1);i<=s;i2=i,i<<=1){\n\t\to=fpw(iv?Gi:G,(P-1)/i);\n\t\tfor(int j(0);j<s;j+=i){\n\t\t\tw=1;\n\t\t\tFrn0(k,0,i2){\n\t\t\t\tx=a[j+k],y=w*a[j+k+i2]%P;\n\t\t\t\ta[j+k]=(x+y)%P,a[j+k+i2]=(x-y+P)%P,w=w*o%P;\n\t\t\t}\n\t\t}\n\t}\n\tif(iv)Frn0(i,0,s)a[i]=a[i]*siv%P;\n}\n```\n\n**Time complexity: $O(n\\log n)$**\n\n**Memory complexity: $O(n)$**\n\n\u770b\u770b\u6548\u679c\n\n![](https://images.cnblogs.com/cnblogs_com/BrianPeng/1640550/o_200202142044NTT.PNG)\n\n\u65f6\u95f4\u4e0a\u7684\u63d0\u5347\u6548\u679c\u4e0d\u5927\uff0c\u4f46\u662f\u7a7a\u95f4\u5c11\u4e86\u4e00\u534a\uff08\u56e0\u4e3a\u7528\u4e86int\u800c\u4e0d\u662fcomplex\uff09\n\n### Conclusion: \n\n\u6253\u4e86\u4e00\u5929\u7684\u535a\u5ba2\u7ec8\u4e8e\u5199\u5b8c\u4e86\uff08\u597d\u7d2f\uff09\n\n\u4f46\u662f\u5bf9FFT\u548cNTT\u7684\u7406\u89e3\u4e5f\u52a0\u6df1\u4e86\u4e0d\u5c11\n\n\u8fd9\u4e2a\u7b97\u6cd5\u5bf9\u6570\u5b66\u77e5\u8bc6\u548c\u5206\u6cbb\u601d\u60f3\u7684\u8981\u6c42\u90fd\u5f88\u9ad8\n\n\u672c\u849f\u84bb\u82b1\u4e86\u8fd1\u4e00\u5e74\u7684\u65f6\u95f4\u624d\u771f\u6b63\u7406\u89e3\n\n\u5982\u679c\u6709\u9519\u8bef\u548c\u610f\u89c1\u8bf7\u5927\u4f6c\u591a\u591a\u6307\u6559\n\n\u90a3\u4e48\u672c\u7bc7\u535a\u5ba2\u5c31\u5230\u8fd9\u91cc\u5566\uff0c\u8c22\u8c22\u5404\u4f4d\u5927\u4f6c\u7684\u652f\u6301\uff01\u3042\u308a\u304c\u3068\u3046\uff01\n",
        "postTime": 1580653998,
        "uid": 66199,
        "name": "Bring",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09\u3011"
    },
    {
        "content": "\u9012\u5f52\u7248\u7684\u590d\u6742\u5ea6\u662f\u5bf9\u7684  \n\u4f46\u53ea\u662f\u5e38\u6570\u5927  \n\u800c\u4e14\u4f1a\u88ab\u5361\u7a7a\u95f4  \n\u8fd9\u4e2a\u3002\u3002\u3002\u3002\u3002\u3002\u3002  \n\u7528vector\u5c31\u884c\u4e86  \n\u9644\u4e0a\u4ee3\u7801  \n\u6700\u6162\u7684\u4e00\u4e2a\u70b92.5\u79d2  \n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstdlib>\n#include<cstring>\n#include<string>\n#include<cmath>\n#include<vector>\nusing namespace std;\n\nint n, m;\nconst double Pi = acos(-1.0);\nstruct complex\n{\n    double x,y;\n    complex (double xx=0,double yy=0){x=xx,y=yy;}\n};\ncomplex operator + (complex a,complex b){ return complex(a.x+b.x , a.y+b.y);}\ncomplex operator - (complex a,complex b){ return complex(a.x-b.x , a.y-b.y);}\ncomplex operator * (complex a,complex b){ return complex(a.x*b.x-a.y*b.y , a.x*b.y+a.y*b.x);}\nvector<complex>a, b;\n\ninline int getnum()\n{\n\tint x = 0, f = 1;\n\tchar ch = getchar();\n\twhile (ch < '0' || ch > '9') {\n\t\tif (ch == '-') f = -1; ch = getchar();\n\t}\n\twhile (ch >= '0' && ch <= '9') {\n\t\tx = x * 10 + ch - '0'; ch = getchar();\n\t}\n\treturn x * f;\n}\n\nvoid get_read()\n{\n\tn = getnum(); m = getnum();\n\tfor (int i = 0; i <= n; ++i) a.push_back(complex(getnum(), 0));\n\tfor (int i = 0; i <= m; ++i) b.push_back(complex(getnum(), 0));\n}\n\nvoid fft(int limit, vector<complex>&a, int type)\n{\n\tif (limit == 1) return;\n\tvector<complex>a1, a2;\n\ta1.clear(); a2.clear();\n\tfor (int i = 0; i <= limit; i += 2)\n\t\ta1.push_back(a[i]), a2.push_back(a[i + 1]);\n\tfft(limit >> 1, a1, type);\n\tfft(limit >> 1, a2, type);\n\tcomplex Wn = complex(cos(2.0 * Pi / limit), type * sin(2.0 * Pi / limit)), w = complex(1, 0);\n\tfor (int i = 0; i < (limit >> 1); ++i, w = w * Wn) {\n\t\ta[i] = a1[i] + w * a2[i];\n\t\ta[i + (limit >> 1)] = a1[i] - w * a2[i];\n\t}\n\ta1.clear(); a2.clear();\n}\n\nvoid get_work()\n{\n\tint limit = 1;\n\twhile (limit <= n + m) limit <<= 1;\n\tfor (int i = n + 1; i <= limit; ++i) a.push_back(complex(0, 0));\n\tfft(limit, a, 1);\n\tfor (int i = m + 1; i <= limit; ++i) b.push_back(complex(0, 0));\n\tfft(limit, b, 1);\n\tfor (int i = 0; i <= limit; ++i) a[i] = a[i] * b[i];\n\tfft(limit, a, -1);\n\tfor (int i = 0; i <= n + m; ++i) printf(\"%d \", (int)(a[i].x / limit + 0.5));\n}\n\nint main()\n{\n//\tfreopen(\"testdata.in\", \"r\", stdin);\n\t\n\tget_read();\n\n\tget_work();\n\n\treturn 0;\n}\n```\n",
        "postTime": 1553845458,
        "uid": 128083,
        "name": "calvin99",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09\u3011"
    },
    {
        "content": "#### [\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\u70b9\u8fd9\u91cc](https://blog.csdn.net/qq_43537070/article/details/103604112)\n# \u601d\u8def\n\u76f8\u4fe1\u5927\u5bb6\u90fd\u5df2\u7ecf\u5b66\u4f1a\u4e86$FFT$\uff0c\u82e5\u4e0d\u4f1a\uff0c\u8bf7\u770b\u8fd9\u7bc7\u535a\u5ba2\n\n[**\u4e00\u4e2a\u540c\u5b66\u5199\u7684\uff0c\u81ea\u8ba4\u4e3a\u4e0d\u9519**](https://blog.csdn.net/ICEEBBING/article/details/103569232)\n\n\u5728\u6211\u4eec\u7684$FFT$\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u4e86\u590d\u6570\u6765\u8fdb\u884c\u8ba1\u7b97\n\n\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u590d\u6570\u7684\u4e58\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6\u662f$O(4)$\n\n\u800c$double$\u7684\u8ba1\u7b97\u5219\u66f4\u52a0\u589e\u6dfb\u4e86\u65f6\u95f4\u590d\u6742\u5ea6\n\n\u540c\u65f6\u56e0\u4e3a\u6d6e\u70b9\u6570\u8ba1\u7b97$\\sqrt{\\ \\ \\ }$\u7684\u7cbe\u5ea6\u4f1a\u6709\u8bef\u5dee\n\n\u5bfc\u81f4\u6211\u4eec\u6700\u7ec8\u7684\u6240\u6709\u90e8\u5206\u7684\u548c\u53cd\u800c\u4e0e\u5b8c\u6574\u7684$360$&deg;\n\n\u90a3\u4e48\u6211\u4eec\u4e0d\u59a8\u8bd5\u60f3\uff0c\u82e5\u662f\u5728\u7cfb\u6570\u4e3a\u6574\u6570\u7684\u60c5\u51b5\u4e0b\n\n\u6216\u8005\u9700\u8981\u53d6\u6a21\u7684\u65f6\u5019\uff0c\u6211\u4eec\u8be5\u5982\u4f55\u6765\u89e3\u51b3\u5462\uff1f\n\n# NTT\n\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u4ecb\u7ecd\u4eca\u5929\u7684\u4e3b\u89d2\u4e86\n\n**NTT \u2014\u2014 \u5feb\u901f\u6570\u8bba\u53d8\u6362**\n\n\u662f\u4e00\u79cd\u5efa\u7acb\u5728\u6570\u8bba\u4e0a\u7684\u5bf9FFT\u7684\u4f18\u5316\n\n~~*(\u6216\u8005\u53ef\u4ee5\u8bf4\u662f\u53d6\u6a21\u8fd0\u7b97\u7684FFT)*~~\n\n\u53ea\u4e0d\u8fc7\u7531\u4e8eFFT\u7528\u5230\u662f\u590d\u6570\n\n\u800c\u4e14double\u5728\u505a\u4e86\u5927\u91cf\u7684\u5b9e\u6570\u8fd0\u7b97\u4e4b\u540e\n\n\u7cbe\u5ea6\u635f\u5931\u8f83\u5927\n\n\u800c\u6211\u4eec\u7684NTT\u5c31\u53ef\u4ee5\u5728\u6a21\u610f\u4e49\u4e0b\n\n\u5feb\u901f\u505a\u8fd9\u6837\u7684\u4e00\u4e2a\u591a\u9879\u5f0f\u4e58\u6cd5\n\nNTT\u5e38\u6570\u5c0f\u4e00\u4e9b\n\n\u4e00\u822c\u8fd9\u4e2a\u6a21\u6570\u88ab\u8ba4\u4e3a\u662f$x * 2^k+1$\n\n# \u539f\u6839\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u4ecb\u7ecd\u4e00\u4e2a\u4e1c\u897f\u2014\u2014\u539f\u6839\n\n\u8bbe$m$\u662f\u6b63\u6574\u6570\uff0c$a$\u662f\u6574\u6570\n\n\u82e5$a$\u6a21$m$\u7684\u9636\u7b49\u4e8e$\\varphi(m)$\n\n\u5219\u79f0$a$\u4e3a\u6a21$m$\u7684\u4e00\u4e2a\u539f\u6839\u3002\n\n\u5047\u8bbe\u4e00\u4e2a\u6570$g$\u662f$P$\u7684\u539f\u6839\n\n\u90a3\u4e48$g^i\\ mod\\ P$\u7684\u7ed3\u679c\u4e24\u4e24\u4e0d\u540c\n\n\u4e14\u6709$1<g<P$\uff0c$0<i<P$\n\n\u5f52\u6839\u5230\u5e95\u5c31\u662f$g^{P-1} \\equiv 1 (mod\\ P)$\n\n\u5f53\u4e14\u4ec5\u5f53\u6307\u6570\u4e3a$P-1$\u7684\u65f6\u5019\u6210\u7acb($P$\u662f\u7d20\u6570)\u3002\n\n\u7b80\u5355\u6765\u8bf4\uff0c$g^i\\ mod\\ p \\neq g^j mod\\ p$ ($p$\u4e3a\u7d20\u6570)\n\n\u5176\u4e2d$i \\ne j$ \u4e14 $i, j$\u4ecb\u4e8e$1$\u81f3$(p-1)$\u4e4b\u95f4\n\n\u5219$g$\u4e3a$p$\u7684\u539f\u6839\u3002\n\n\u63d0\u4f9b\u4e00\u79cd\u66b4\u529b\u7684\u539f\u6839\u7684\u6c42\u6cd5\n\n~~~cpp\nint calc(int x)// \u6c42\u539f\u6839\n{\n    if (x == 2)\n        return 1;\n    for (int i = 2;i ;i++)\n    {\n        bool f = 1;\n        for (int j = 2;j * j < x; j++)\n            if (qkpow(i, (x - 1) / j, x) == 1)\n            {\n                f = 0;\n                break;\n            }\n        if (f)\n            return i;\n    }\n}\n~~~\n**\u4e0b\u9762\u662f\u4e00\u4e2a\u5e38\u7528\u6a21\u6570\u7684\u8868**\n\n[*\u8f6c\u8f7d\u81eaRayment_cc\u5927\u4f6c\u7684\u535a\u5ba2*](https://blog.csdn.net/As_A_Kid/article/details/80503140)\n\n![\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0](https://img-blog.csdnimg.cn/20191218203744414.jpg?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNTM3MDcw,size_16,color_FFFFFF,t_70)\n\n# NTT\n\n\u800c\u6709\u4e86\u539f\u6839\u4ee5\u540e\n\n\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u590d\u6570\u66ff\u6362\u6210\u539f\u6839\u7684$\\frac{mod - 1}{2\\ *\\ i}$\u6b21\u65b9\n\n\u7136\u540e\u5c06FFT\u5957\u4e0a\u53bb\n\n\u5c31\u53ef\u4ee5\u5b9e\u73b0\u4e86\n\n****\u81f3\u4e8e\u4e3a\u4ec0\u4e48\uff0c\u8bf7\u770b\u8fd9\u91cc****\n\n![\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0](https://img-blog.csdnimg.cn/2019121820564560.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNTM3MDcw,size_16,color_FFFFFF,t_70)\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u641e\u5b9a\u4e86\u539f\u6839\u4e0e\u5355\u4f4d\u590d\u6839\u7684\u8f6c\u6362\n\n# code\n***\u7248\u672c1:FFT***\n~~~cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <cstdlib>\n#include <cctype>\n#include <map>\n#include <queue>\n#include <set>\n#include <vector>\n#include <iostream>\n#include <stack>\n#include <complex>\n#include <cmath>\n#define pk putchar(' ')\n#define ph puts(\"\")\n#pragma GCC optimize(2)\nusing namespace std;\ntypedef long long ll;\ntypedef complex<double> cpd;\ntemplate <class T>\nvoid rd(T &x)\n{\n    x = 0;\n    int f = 1;\n    char c = getchar();\n    while (!isdigit(c)) {if (c == '-') f = -1; c = getchar();}\n    while (isdigit(c)) x = (x << 3) + (x << 1) + (c ^ 48), c = getchar();\n    x *= f;\n}\ntemplate <class T>\nvoid pt(T x)\n{\n    if (x < 0)\n        putchar('-'), x = (~x) + 1;\n    if (x > 9)\n        pt(x / 10);\n    putchar(x % 10 ^ 48);\n}\ntemplate <class T>\nT Max(T a, T b)\n{\n    return a > b ? a : b;\n}\ntemplate <class T>\nT Min(T a, T b)\n{\n    return a < b ? a : b;\n}\ntemplate <class T>\nT Fabs(T x)\n{\n    return x > 0 ? x : -x;\n}\ntemplate <class T>\nvoid Swap(T &x, T &y)\n{\n    T t = x;\n    x = y;\n    y = t;\n}\nconst int N = (1 << 18) + 5;\nconst double pi = acos(-1.0);\nint n, R[N], l, lim, m;\ncpd a[N], b[N];\nvoid fft(cpd *a, int opt)\n// opt = 1 => dft\n// opt = -1 => idft\n{\n    for (int i = 0; i < lim; i++)\n        if (i < R[i])\n            Swap(a[i], a[R[i]]);\n    for (int i = 1;i < lim; i <<= 1)\n    {\n        cpd x{cos(pi / i), opt * sin(pi / i)}, y{1, 0};\n        for (int j = 0;j < lim; j += (i << 1), y = {1, 0})\n            for (int k = 0;k < i; k++, y *= x)\n            {\n                cpd p = a[j + k], q = y * a[j + k + i];\n                a[j + k] = p + q;\n                a[j + k + i] = p - q;\n            }\n    }\n}\n// void ptcp(cpd x)\n// {\n//     printf (\"%f+%fi\\n\", x.real(), x.imag());\n//     return;\n// }\nint main()\n{\n    rd(n), rd(m);\n    for (int i = 0, x;i <= n; i++)\n        rd(x), a[i] = x;\n    for (int i = 0, x;i <= m; i++)\n        rd(x), b[i] = x;\n    for (lim = 1;lim <= n + m; lim <<= 1) \n        l++;\n    for (int i = 0;i < lim; i++)\n        R[i] = (R[i >> 1] >> 1) | ((i & 1) << (l - 1));\n    fft(a, 1);\n    fft(b, 1);\n    for (int i = 0;i <= lim; i++)\n        a[i] = a[i] * b[i];\n    fft(a, -1);\n    for (int i = 0;i <= n + m; i++)\n        pt(int((a[i].real() + 0.5) / lim)), pk;\n    return 0;\n}\n~~~\n***\u7248\u672c2:NTT***\n~~~cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <cstdlib>\n#include <cctype>\n#include <map>\n#include <queue>\n#include <set>\n#include <vector>\n#include <iostream>\n#include <stack>\n#include <complex>\n#include <cmath>\n#define pk putchar(' ')\n#define ph puts(\"\")\n#pragma GCC optimize(2)\nusing namespace std;\ntypedef long long ll;\ntemplate <class T>\nvoid rd(T &x)\n{\n    x = 0;\n    int f = 1;\n    char c = getchar();\n    while (!isdigit(c)) {if (c == '-') f = -1; c = getchar();}\n    while (isdigit(c)) x = (x << 3) + (x << 1) + (c ^ 48), c = getchar();\n    x *= f;\n}\ntemplate <class T>\nvoid pt(T x)\n{\n    if (x < 0)\n        putchar('-'), x = (~x) + 1;\n    if (x > 9)\n        pt(x / 10);\n    putchar(x % 10 ^ 48);\n}\ntemplate <class T>\nT Max(T a, T b)\n{\n    return a > b ? a : b;\n}\ntemplate <class T>\nT Min(T a, T b)\n{\n    return a < b ? a : b;\n}\ntemplate <class T>\nT Fabs(T x)\n{\n    return x > 0 ? x : -x;\n}\ntemplate <class T>\nvoid Swap(T &x, T &y)\n{\n    T t = x;\n    x = y;\n    y = t;\n}\nconst int N = (1 << 18) + 5, mod = 998244353, g = 3;\nint n, R[N], l, lim, m, a[N], b[N];\nint qkpow(int x, int y, int mod)\n{\n    int res = 1;\n    while (y)\n    {\n        if (y & 1)\n            res = 1ll * res * x % mod;\n        y >>= 1;\n        x = 1ll * x * x % mod;\n    }\n    return res;\n}\nint calc(int x)// \u6c42\u539f\u6839\n{\n    if (x == 2)\n        return 1;\n    for (int i = 2;i ;i++)\n    {\n        bool f = 1;\n        for (int j = 2;j * j < x; j++)\n            if (qkpow(i, (x - 1) / j, x) == 1)\n            {\n                f = 0;\n                break;\n            }\n        if (f)\n            return i;\n    }\n}\nvoid ntt(int *a, int opt)\n// opt = 1 => dft\n// opt = -1 => idft\n{\n    for (int i = 0; i < lim; i++)\n        if (i < R[i])\n            Swap(a[i], a[R[i]]);\n    for (int i = 1;i < lim; i <<= 1)\n    {\n        int tmp = qkpow(g, (mod - 1) / (i << 1), mod);\n        if (opt == -1)\n            tmp = qkpow(tmp, mod - 2, mod);\n        for (int j = 0, y = 1;j < lim; j += (i << 1), y = 1)\n            for (int k = 0;k < i; k++, y = 1ll * y * tmp % mod)\n            {\n                int p = a[j + k], q = 1ll * y * a[j + k + i] % mod;\n                a[j + k] = (p + q) % mod;\n                a[j + k + i] = (p - q + mod) % mod;\n            }\n    }\n    if (opt == -1)\n    {\n        int inv = qkpow(lim, mod - 2, mod);\n        for (int i = 0;i < lim; i++)\n            a[i] = 1ll * inv * a[i] % mod;\n    }\n}\nint main()\n{\n    rd(n), rd(m);\n    for (int i = 0;i <= n; i++)\n        rd(a[i]);\n    for (int i = 0;i <= m; i++)\n        rd(b[i]);\n    for (lim = 1;lim <= n + m; lim <<= 1) \n        l++;\n    for (int i = 0;i < lim; i++)\n        R[i] = (R[i >> 1] >> 1) | ((i & 1) << (l - 1));\n    ntt(a, 1);\n    ntt(b, 1);\n    for (int i = 0;i <= lim; i++)\n        a[i] = 1ll * a[i] * b[i] % mod;\n    ntt(a, -1);\n    for (int i = 0;i <= n + m; i++)\n        pt(a[i]), pk;\n    return 0;\n}\n~~~\n***\u7248\u672c3(\u51fd\u6570\u7248NTT,\u5e26\u6c42\u4e58\u6cd5\u9006)***\n~~~cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <cstdlib>\n#include <cctype>\n#include <map>\n#include <queue>\n#include <set>\n#include <vector>\n#include <iostream>\n#include <stack>\n#include <complex>\n#include <cmath>\n#define pk putchar(' ')\n#define ph puts(\"\")\n#pragma GCC optimize(2)\nusing namespace std;\ntypedef long long ll;\ntemplate <class T>\nvoid rd(T &x)\n{\n    x = 0;\n    ll B = 1;\n    char c = getchar();\n    while (!isdigit(c)) {if (c == '-') B = -1; c = getchar();}\n    while (isdigit(c)) x = (x << 3) + (x << 1) + (c ^ 48), c = getchar();\n    x *= B;\n}\ntemplate <class T>\nvoid pt(T x)\n{\n    if (x < 0)\n        putchar('-'), x = (~x) + 1;\n    if (x > 9)\n        pt(x / 10);\n    putchar(x % 10 ^ 48);\n}\ntemplate <class T>\nT Max(T a, T b)\n{\n    return a > b ? a : b;\n}\ntemplate <class T>\nT Min(T a, T b)\n{\n    return a < b ? a : b;\n}\ntemplate <class T>\nT Fabs(T x)\n{\n    return x > 0 ? x : -x;\n}\ntemplate <class T>\nvoid Swap(T &x, T &y)\n{\n    T t = x;\n    x = y;\n    y = t;\n}\nconst int N = (1 << 19) + 5, mod = 998244353, p = 3; \nint n, R[N], c[N], a[N], b[N], m;\nint qkpow(int x, int y, int mod)\n{\n    int res = 1;\n    while (y)\n    {\n        if (y & 1)\n            res = 1ll * res * x % mod;\n        y >>= 1;\n        x = 1ll * x * x % mod;\n    }\n    return res;\n}\nvoid ntt(int *a, int opt, int lim, int mod)\n// opt = 1 => dft\n// opt = -1 => idft\n{\n    int p_inv = opt == -1 ? qkpow(p, mod - 2, mod) : 0;\n    for (int i = 0; i < lim; i++)\n        if (i < R[i])\n            Swap(a[i], a[R[i]]);\n    for (int i = 1;i < lim; i <<= 1)\n    {\n        int tmp = qkpow(opt == 1 ? p : p_inv, (mod - 1) / (i << 1), mod);\n        for (int j = 0, y = 1;j < lim; j += (i << 1), y = 1)\n            for (int k = 0;k < i; k++, y = 1ll * y * tmp % mod)\n            {\n                int p = a[j + k], q = 1ll * y * a[j + k + i] % mod;\n                a[j + k] = (p + q) % mod;\n                a[j + k + i] = (p - q + mod) % mod;\n            }\n    }\n    if (opt == -1)\n    {\n        int inv = qkpow(lim, mod - 2, mod);\n        for (ll i = 0;i < lim; i++)\n            a[i] = 1ll * inv * a[i] % mod;\n    }\n}\nvoid mul(int *a, int *b, int n, int m)\n{\n    int lim, l;\n    for (l = 0, lim = 1;lim < n + m; l++, lim <<= 1);\n    for (int i = 0;i < lim; R[i] = (R[i >> 1] >> 1) | ((i & 1) << (l - 1)), i++);\n    ntt(a, 1, lim, mod);\n    ntt(b, 1, lim, mod);\n    for (int i = 0;i < lim; i++)\n        a[i] = 1ll * a[i] * b[i] % mod;\n    ntt(a, -1, lim, mod);\n}\nvoid inv(int *a, int *b, int siz)\n{\n    if (siz == 1)\n    {\n        b[0] = qkpow(a[0], mod - 2, mod);\n        return;\n    }\n    inv(a, b, (siz + 1) >> 1);\n    int lim, l;\n    for (l = 0, lim = 1;lim < siz + siz; l++, lim <<= 1);\n    for (int i = 0;i < lim; R[i] = (R[i >> 1] >> 1) | ((i & 1) << (l - 1)), i++);\n    for (int i = 0;i < siz; i++)\n        c[i] = a[i];\n    for (int i = siz;i < lim; i++)\n        b[i] = 0;\n    ntt(c, 1, lim, mod);\n    ntt(b, 1, lim, mod);\n    for (int i = 0;i < lim; i++)\n        b[i] = (b[i] * 2 % mod - 1ll * b[i] * b[i] % mod * c[i] % mod + mod) % mod;\n    ntt(b, -1, lim, mod);\n    for (int i = siz;i < lim; i++)\n        b[i] = 0;\n}\nint main()\n{\n    // freopen(\"testdata.in\", \"r\", stdin);\n    // freopen(\"test.out\", \"w\", stdout);\n    rd(n), rd(m);\n    n++, m++;\n    for (int i = 0;i < n; i++)\n        rd(a[i]);\n    for (int j = 0;j < m; j++)\n        rd(b[j]);\n    mul(a, b, n, m);\n    for (int i = 0;i < n + m - 1; i++)\n        pt(a[i]), pk;\n    return 0;\n}\n~~~\n\n***~~\u4e0d\u8981\u541d\u556c\u60a8\u7684\u5c0f\u9f20\u6807\uff0c\u53f3\u4e0a\u89d2\u7684\u8d5e\uff0c\u8bf7\u70b9\u51fb\u4e0b~~***\n\n# Thanks!",
        "postTime": 1576743800,
        "uid": 212040,
        "name": "smoothset",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09\u3011"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u9053FFT\u7684\u88f8\u9898\n\n\u81f3\u4e8eFFT\u662f\u5e72\u5565\u7684\uff0c\u5728\u8fd9\u91cc\u51e0\u53e5\u8bdd\u4e5f\u626f\u4e0d\u5b8c\u4e86\n\n\u7b80\u5355\u7684\u8bf4\uff0c\u5c31\u662f\u591a\u9879\u5f0f\u6709\u70b9\u503c\u548c\u7cfb\u6570\u4e24\u79cd\u8868\u793a\n\n\u7528\u70b9\u503c\u8868\u793a\u7684\u591a\u9879\u5f0f\u53ef\u4ee5\u5728 $O(n)$ \u7684\u65f6\u95f4\u8ba1\u7b97\u591a\u9879\u5f0f\u4e58\u6cd5\n\n\u6240\u4ee5\u9ad8\u6548\u7684\u8fdb\u884cDFT\u548cIDFT\u5c31\u662f\u5173\u952e\u3002\n\nFFT\u5229\u7528\u5355\u4f4d\u6839\u7684\u6027\u8d28\u8fdb\u884c\u5206\u6cbb\uff0c\u53ef\u4ee5\u5728 $O(nlogn)$ \u7684\u65f6\u95f4\u5185\u5b8c\u6210DFT\u548cIDFT\n\n```cpp\n#include<bits/stdc++.h>\n#define N 2621450\n#define pi acos(-1)\nusing namespace std;\ntypedef complex<double> E;\nint n,m,l,r[N];\nE a[N],b[N];\nvoid FFT(E *a,int f){\n    for(int i=0;i<n;i++)if(i<r[i])swap(a[i],a[r[i]]);\n    for(int i=1;i<n;i<<=1){\n        E wn(cos(pi/i),f*sin(pi/i));\n        for(int p=i<<1,j=0;j<n;j+=p){\n            E w(1,0);\n            for(int k=0;k<i;k++,w*=wn){\n                E x=a[j+k],y=w*a[j+k+i];\n                a[j+k]=x+y;a[j+k+i]=x-y;\n            }\n        }\n    }\n}\ninline int read(){\n    int f=1,x=0;char ch;\n    do{ch=getchar();if(ch=='-')f=-1;}while(ch<'0'||ch>'9');\n    do{x=x*10+ch-'0';ch=getchar();}while(ch>='0'&&ch<='9');\n    return f*x;\n}\nint main(){\n    n=read();m=read();\n    for(int i=0;i<=n;i++)a[i]=read();\n    for(int i=0;i<=m;i++)b[i]=read();\n    m+=n;for(n=1;n<=m;n<<=1)l++;\n    for(int i=0;i<n;i++)r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n    FFT(a,1);FFT(b,1);\n    for(int i=0;i<=n;i++)a[i]=a[i]*b[i];\n    FFT(a,-1);\n    for(int i=0;i<=m;i++)printf(\"%d \",(int)(a[i].real()/n+0.5));\n}\n```",
        "postTime": 1498098736,
        "uid": 2978,
        "name": "zcysky",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09\u3011"
    },
    {
        "content": "# \u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\nupdate:2020.7.29 \u589e\u52a0\u4e86\u4e09\u6b21\u53d8\u4e24\u6b21\u4f18\u5316\n\n## \u3010\u9884\u544a\u3011\n* \u4ee3\u7801\u5947\u77ed\n* \u5927\u91cf\u516c\u5f0f\u63a8\u5bfc\n## \u3010\u524d\u8a00\u3011\n\n\u5728\u89e3\u51b3\u591a\u9879\u5f0f\u5377\u79ef(\u4e58\u6cd5)\u7684\u95ee\u9898\u65f6,\u76f4\u63a5\u76f8\u4e58\u7684$O(n^2)$\u505a\u6cd5\u4f3c\u4e4e\u627e\u4e0d\u5230\u4f18\u5316\u7684\u4f59\u5730\u3002\n\n\u8fd9\u65f6\uff0c\u6211\u4eec\u5c31\u9700\u8981\u5bfb\u627e\u5176\u5b83\u7684\u8def\u5f84\u6765\u8ba1\u7b97\u5377\u79ef\u3002\n\n\u4f17\u6240\u5468\u77e5,\u4e8c\u7ef4\u5750\u6807\u7cfb\u4e0a\u6a2a\u5750\u6807\u4e92\u5f02\u7684$n$\u4e2a\u70b9\u53ef\u4ee5\u786e\u5b9a\u4e00\u4e2a$n-1$\u6b21\u51fd\u6570\u3002\n\n\u4e0e\u7528\u5404\u9879\u7cfb\u6570\u8868\u793a\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u8868\u793a\u6cd5\u4e0d\u540c\uff0c\u7528\u70b9\u8868\u793a\u4e00\u4e2a\u591a\u9879\u5f0f\u7684\u65b9\u6cd5\u53eb\u70b9\u503c\u8868\u793a\u6cd5\u3002\n\n\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362($DFT$,$Discrete$ $Fourier$ $Transformation$)\u6307\u7684\u662f\u591a\u9879\u5f0f\u7531\u7cfb\u6570\u8868\u793a\u6cd5\u8f6c\u4e3a\u70b9\u503c\u8868\u793a\u6cd5\u7684\u8fc7\u7a0b\u3002\n\n\u76f8\u5bf9\u5730\uff0c\u628a\u4e00\u4e2a\u591a\u9879\u5f0f\u7684\u70b9\u503c\u8868\u793a\u6cd5\u8f6c\u5316\u4e3a\u7cfb\u6570\u8868\u793a\u6cd5\u7684\u8fc7\u7a0b\uff0c\u5c31\u662f\u79bb\u6563\u9006\u5085\u91cc\u53f6\u53d8\u6362($IDFT$)\u3002\n\n\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362($Fast$ $Fourier$ $Transformation$)\u6307\u7684\u662f\u5728\u6267\u884c$DFT$\u548c$IDFT$\u65f6\u901a\u8fc7\u4ee3\u5165\u7279\u6b8a\u7684\u503c\u52a0\u901f\u8fc7\u7a0b\u7684\u4e00\u79cd\u7b97\u6cd5\u3002\n## \u3010\u524d\u7f6e\u77e5\u8bc6\u3011\n\n1. \u4e09\u89d2\u51fd\u6570(\u4e0d\u8bb2)\n\n2. \u590d\u6570\u8fd0\u7b97(\u4e0d\u8bb2)\n\n3. \u590d\u5e73\u9762\u53ca\u5355\u4f4d\u6839(\u4e0d\u60f3\u8bb2,\u767e\u5ea6\u6709)\n\n## \u3010\u6570\u5b66\u63a8\u5bfc\u90e8\u5206\u3011\n\u9996\u5148,\u6211\u4eec\u6765\u770b\u770b\u5355\u4f4d\u6839\u7684\u6027\u8d28\n\n* $\\omega_n^k=cos\\frac{2k\\pi}{n}+isin\\frac{2k\\pi}{n}$\n   \n* $\\omega_{2n}^{2k}=\\omega_n^k$\n   \n* $\\omega_{n}^{k+n}=cos\\frac{2(k+n)\\pi}{n}+isin\\frac{2(k+n)\\pi}{n}=cos(\\frac{2k\\pi}{n}+2\\pi)+isin(\\frac{2k\\pi}{n}+2\\pi)$\n   \n  $=cos\\frac{2k\\pi}{n}+isin\\frac{2k\\pi}{n}=\\omega_n^k$\n   \n* $\\omega_{n}^{k+\\frac{n}{2}}=cos\\frac{2(k+\\frac{n}{2})\\pi}{n}+isin\\frac{2(k+\\frac{n}{2})\\pi}{n}=cos(\\frac{2k\\pi}{n}+\\pi)+isin(\\frac{2k\\pi}{n}+\\pi)$\n   \n   $=-cos\\frac{2k\\pi}{n}-isin\\frac{2k\\pi}{n}=-\\omega_n^k$\n   \n\u518d\u770b\u770b\u8fd9\u4e2a\u591a\u9879\u5f0f\n   \n   \u4e3a\u4e86\u65b9\u4fbf\u8ba8\u8bba,\u4ee5\u4e0b\u63d0\u53ca\u7684\u591a\u9879\u5f0f\u7684\u957f\u5ea6$n$\u5747\u4e3a$2$\u7684\u6574\u6570\u6b21\u5e42,\u5373\u591a\u9879\u5f0f\u6b21\u6570\u4e3a$n-1$,\u4e0d\u591f\u5c31\u5f80\u9ad8\u4f4d\u8865$0$\u3002\n   \n   \u6211\u4eec\u5728DFT\u4e2d,\u5176\u5b9e\u8981\u8ba1\u7b97\u7684\u7684\u662f\n   \n* $F(x_0)=a_{0}+a_1x_0+a_2x_0^2+...+a_{n-2}x_0^{n-2}+a_{n-1}x_0^{n-1}$\n   \n   $F(x_1)=a_{0}+a_1x_1+a_2x_1^2+...+a_{n-2}x_1^{n-2}+a_{n-1}x_1^{n-1}$\n   \n   $F(x_2)=a_{0}+a_1x_2+a_2x_2^2+...+a_{n-2}x_2^{n-2}+a_{n-1}x_2^{n-1}$\n   \n   ... ...\n   \n   $F(x_{n-1})=a_{0}+a_1x_{n-1}+a_2x_{n-1}^2+...+a_{n-2}x_{n-1}^{n-2}+a_{n-1}x_{n-1}^{n-1}$\n   \n   \n\u89c2\u5bdf\u6bcf\u4e00\u4e2a$n-1$\u6b21\u7684\u591a\u9879\u5f0f:\n   \n* $F(x)=a_{0}+a_1x+a_2x^2+...+a_{n-2}x^{n-2}+a_{n-1}x^{n-1}$\n   \n\u6309\u6b21\u6570\u5947\u5076\u6027\u5206\u7c7b,\u8bbe\n   \n* $G(x)=a_0+a_2x+a_4x^2+...+a_{n-4}x^{\\frac{n}{2}-2}+a_{n-2}x^{\\frac{n}{2}-1}$\n   \n* $H(x)=a_1+a_3x+a_5x^2+...+a_{n-3}x^{\\frac{n}{2}-2}+a_{n-1}x^{\\frac{n}{2}-1}$\n   \n\u53ef\u4ee5\u5f97\u5230\n   \n* $F(x)=a_0+a_2x^2+...+a_{n-2}x^{n-2}+a_1x+a_3x^3...+a_{n-1}x^{n-1}$\n   \n   $=H(x^2)+xG(x^2)$\n   \n\u4e0d\u59a8\u628a\u5355\u4f4d\u6839 $\\omega_n^k (k<\\frac{n}{2})$ \u4ee3\u8fdb\u53bb\u770b\u770b\n   \n* $F(\\omega_n^k)=H(\\omega_n^{2k})+\\omega_n^kG(\\omega_n^{2k})$\n   \n   $=H(\\omega_{\\frac{n}{2}}^k)+\\omega_n^kG(\\omega_{\\frac{n}{2}}^k)$\n   \n\u518d\u4ee3\u4e00\u4e2a $\\omega_{n}^{k+\\frac{n}{2}}$\n   \n* $F(\\omega_n^{k+\\frac{n}{2}})=H(\\omega_n^{2k+n})+\\omega_n^{k+\\frac{n}{2}}G(\\omega_n^{2k+n})=H(\\omega_n^{2k})-\\omega_n^kG(\\omega_n^{2k})$\n   \n   $=H(\\omega_{\\frac{n}{2}}^k)-\\omega_n^kG(\\omega_{\\frac{n}{2}}^k)$\n   \n\u8fd8\u6ca1\u53d1\u73b0\u95ee\u9898?\u6211\u628a\u8981\u6c42\u7684\u5f0f\u5b50\u518d\u5217\u51fa\u6765\n\n------------\n\n* $F(\\omega_n^0)=H(\\omega_\\frac{n}{2}^0)+\\omega_n^0G(\\omega_\\frac{n}{2}^0)$\n   \n* $F(\\omega_n^1)=H(\\omega_\\frac{n}{2}^1)+\\omega_n^1G(\\omega_\\frac{n}{2}^1)$\n   \n   ... ...\n   \n* $F(\\omega_n^{\\frac{n}{2}-1})=H(\\omega_{\\frac{n}{2}}^{\\frac{n}{2}-1})+\\omega_n^{\\frac{n}{2}-1}G(\\omega_{\\frac{n}{2}}^{\\frac{n}{2}-1})$\n   \n------------\n\n* $F(\\omega_n^\\frac{n}{2})=H(\\omega_\\frac{n}{2}^0)-\\omega_n^0G(\\omega_\\frac{n}{2}^0)$\n   \n* $F(\\omega_n^{\\frac{n}{2}+1})=H(\\omega_\\frac{n}{2}^1)-\\omega_n^1G(\\omega_\\frac{n}{2}^1)$\n   \n   ... ...\n   \n* $F(\\omega_n^{n-1})=H(\\omega_{\\frac{n}{2}}^{n-1})-\\omega_n^{n-1}G(\\omega_{\\frac{n}{2}}^{n-1})$\n\n------------\n\n\u8ba1\u7b97\u4e00\u534a\u5c31\u80fd\u77e5\u9053\u53e6\u4e00\u534a\u7684\u7ed3\u679c\n  \n\u539f\u6765$O(n^2)$\u7684\u65f6\u95f4\u5c31\u4f1a\u53d8\u6210$O(\\frac{n^2}{2})$\n   \n\u5982\u679c\u7528\u9012\u5f52\u6765\u5b8c\u6210\u6bcf\u4e00\u6b65\u8fd9\u6837\u7684\u64cd\u4f5c,\u5c06$G(x)$\u548c$H(x)$\u7684\u7cfb\u6570\u4e5f\u8fd9\u6837\u8ba1\u7b97,\u7531\u4e8e\u9012\u5f52\u6811\u4e2d\u7684\u6bcf\u4e00\u5c42\u5206\u7c7b\u3001\u8ba1\u7b97\u7684\u603b\u91cf\u590d\u6742\u5ea6\u662f$O(n)$,\u9012\u5f52\u6811\u6700\u591a$logn$\u5c42,\u6240\u4ee5\u8fd9\u6837\u5c31\u53ef\u4ee5\u5b9e\u73b0$O(nlogn)$\u8ba1\u7b97\u8fd9$n$\u4e2a\u503c\u4e86\n\n\u9012\u5f52\u5f0f\u53ef\u4ee5\u5199\u51fa\u6765\u3002\u7ecf\u8fc7\u82e5\u5e72\u6b21\u5206\u7ec4\u4e4b\u540e,\u5f53\u524d\u8ba1\u7b97\u7684\u591a\u9879\u5f0f\u7684\u957f\u5ea6\u53d8\u4e3a$2^t$,\u8bbe\u5f53\u524d\u8981\u8ba1\u7b97\u7684\u591a\u9879\u5f0f\u4e3a$G_t(x)$(\u4e5f\u6709\u53ef\u80fd\u662f$H_t(x)$)\n\n**\u6bcf\u5c42\u9012\u5f52**\u4e2d\u53ea\u9700\u8981\u5199\u6210\u4e0b\u9762\u8fd9\u6837\n\n$G_t(\\omega_n^k)=G_{t-1}(\\omega_\\frac{n}{2}^k)+\\omega_n^kH_{t-1}(\\omega_\\frac{n}{2}^k)$\n\n$G_t(\\omega_n^{k+\\frac{n}{2}})=G_{t-1}(\\omega_\\frac{n}{2}^k)-\\omega_n^kH_{t-1}(\\omega_\\frac{n}{2}^k)$\n\n\u5176\u4e2d$G_0(k)=a_k\\omega_n^k$\uff0c$k$\u4e3a\u56fe\u4e2d\u7f16\u53f7\u800c\u4e0d\u662f\u4e0b\u6807\n\n\u5982\u4e0b\u56fe,\u4ee5$n=8$\u4e3a\u4f8b,\u6bcf\u4e00\u5c42\u8fdb\u884c\u5206\u7ec4,\u6309\u4e0a\u9762\u7684\u7ed3\u8bba\u8ba1\u7b97,\u84dd\u8272\u4ee3\u8868\u76f8\u52a0,\u7ea2\u8272\u4ee3\u8868\u76f8\u51cf\n\n![FFT1](https://s2.ax1x.com/2019/12/23/l9Se6s.png)\n\n\u4e0d\u5e9f\u8bdd\u4e86,\u5148\u6765\u770b\u770b\u4ee3\u7801\n\n\u987a\u4fbf\u7ed9\u51fa\u4e00\u4e2a\u590d\u6570\u6570\u636e\u7c7b\u578b\u6a21\u677f\n\n```\nconst double pi=acos(-1.0);\nstruct Cplx{\n\tdouble Re,Im;\n\tCplx(double p=0,double q=0):Re(p),Im(q){}\n\tCplx operator + (const Cplx &a) const {return Cplx(Re+a.Re,Im+a.Im);}\n\tCplx operator - (const Cplx &a) const {return Cplx(Re-a.Re,Im-a.Im);}\n\tCplx operator * (const Cplx &a) const {return Cplx(Re*a.Re-Im*a.Im,Re*a.Im+Im*a.Re);}\n}A[MAXN],B[MAXN],C[MAXN];\nvoid FFT(Cplx *a,int n){\n\tif(n==1) return;\n\tint m=n>>1;Cplx a1[m],a2[m];\n\tfor(int i=0;i<m;i++){//\u5206\u7c7b\n\t\ta1[i]=a[i<<1];\n\t\ta2[i]=a[i<<1|1];\n\t}\n\tFFT(a1,m);FFT(a2,m);//\u9012\u5f52\n\tCplx w1=Cplx(cos(2.0*pi/n),sin(2.0*pi/n)),wk=Cplx(1,0);\n\tfor(int i=0;i<m;i++,wk=wk*w1){//\u8ba1\u7b97\n\t\ta[i]=a1[i]+wk*a2[i];\n\t\ta[i+m]=a1[i]-wk*a2[i];\n\t}\n\treturn;\n}\n```\n\n\u8bb2\u4e86\u8fd9\u4e48\u4e45,\u7ec8\u4e8e\u8bb2\u5b8c\u4e86$DFT$,\u63a5\u4e0b\u6765\u5c31\u662f$IDFT$\n\n\u7ecf\u8fc7\u4e00\u6ce2\u795e\u5947\u7684\u64cd\u4f5c,$IDFT$\u7684\u4ee3\u7801\u53ef\u4ee5\u53d8\u5f97\u548c$DFT$\u7684\u4ee3\u7801\u76f8\u4f3c\u5ea6\u9ad8\u8fbe$84.946\\%$\n\n\u4ee5\u4e0b\u662f\u516c\u5f0f\u63a8\u5bfc\u65f6\u95f4\n\n\u521a\u521a\u6211\u4eec\u5229\u7528\u7cfb\u6570$a_0,a_1,...,a_{n-1}$\u8ba1\u7b97\u51fa\u4e86$F(\\omega_n^0),F(\\omega_n^1),...,F(\\omega_n^{n-1})$\n\n\u76f8\u5f53\u4e8e\u8ba1\u7b97\u4e86\u5e8f\u5217$\\{b_k\\}$,\u5176\u4e2d$b_k=\\sum\\limits_{i=0}^{n-1}a_i(\\omega_n^k)^i$\n\n\u518d\u5c1d\u8bd5\u4e00\u4e0b\u5bf9$b_0,b_1,...,b_{n-1}$,\u5c06$\\omega_n^k$\u6362\u6210$\\omega_n^{-k}$\u518d\u8bd5\u4e00\u4e0b\n\n\u8bbe\u4e00\u6761\u5e8f\u5217$\\{c_k\\}$,\u5176\u4e2d$c_k=\\sum\\limits_{j=0}^{n-1}b_j(\\omega_n^{-k})^j$\n\n\u90a3\u4e48\n\n$c_k=\\sum\\limits_{j=0}^{n-1}(\\sum\\limits_{i=0}^{n-1}a_i(\\omega_n^j)^i)(\\omega_n^{-k})^j$\n\n$=\\sum\\limits_{j=0}^{n-1}(\\sum\\limits_{i=0}^{n-1}a_i(\\omega_n^i)^j)(\\omega_n^{-k})^j$\n\n$=\\sum\\limits_{j=0}^{n-1}\\sum\\limits_{i=0}^{n-1}a_i(\\omega_n^i)^j(\\omega_n^{-k})^j$\n\n$=\\sum\\limits_{i=0}^{n-1}\\sum\\limits_{j=0}^{n-1}a_i(\\omega_n^i)^j(\\omega_n^{-k})^j$\n\n$=\\sum\\limits_{i=0}^{n-1}(a_i\\sum\\limits_{j=0}^{n-1}(\\omega_n^{i-k})^j)$\n\n\u6211\u4eec\u5148\u770b\u770b\u8fd9\u6761\u5f0f\u5b50$S(x)=\\sum\\limits_{j=0}^{n-1}(\\omega_n^{i-k})^j$\n\n\u5f53$i=k$\u65f6\u663e\u7136\u6709$S(x)=n$\n\n\u5f53$i\\not=k$\u6839\u636e\u5355\u4f4d\u6839\u7684\u51e0\u4f55\u6027\u8d28\u663e\u7136\u6709$S(x)=0$\n\n\u6240\u4ee5$c_k=\\sum\\limits_{i=0}^{n-1}[i=k]na_i=na_k$\n\n$a_k=\\frac{c_k}{n}$\n\n\u8bbe\u5bf9\u4e8e\u5e8f\u5217\u7684\u8fd0\u7b97$FFT(\\{a_k\\})=\\{\\sum\\limits_{k=0}^{n-1}a_k\\omega_n^k\\}$\n\n$FFT^{-1}(\\{a_k\\})=\\{\\sum\\limits_{k=0}^{n-1}a_k\\omega_n^{-k}\\}$\n\n\u6709$FFT^{-1}(FFT(\\{a_k\\}))=\\{na_k\\}$\n\n\u81f3\u6b64,DFT\u548cIDFT\u6211\u4eec\u90fd\u627e\u5230\u4e86\u529e\u6cd5\u6765\u5b9e\u73b0\n\n$Quod$ $Erat$ $Demonstrandum$\n## \u3010\u9012\u5f52\u5b9e\u73b0\u4ee3\u7801\u3011\n\u5148\u4e0a\u4e00\u4e2aAC\u4e0d\u4e86\u6a21\u677f\u9898\u7684\u9012\u5f52\u4ee3\u7801\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cmath>\nusing namespace std;\n\nconst double pi=acos(-1.0);\nconst int MAXN=5000005;\nstruct Cplx{\n\tdouble Re,Im;\n\tCplx(double p=0,double q=0):Re(p),Im(q){}\n\tCplx operator + (const Cplx &a) const {return Cplx(Re+a.Re,Im+a.Im);}\n\tCplx operator - (const Cplx &a) const {return Cplx(Re-a.Re,Im-a.Im);}\n\tCplx operator * (const Cplx &a) const {return Cplx(Re*a.Re-Im*a.Im,Re*a.Im+Im*a.Re);}\n}A[MAXN],B[MAXN],C[MAXN];\nint N,M,L;\nvoid FFT(Cplx *a,int n,int d){\n\tif(n==1) return;\n\tint m=n>>1;Cplx a1[m],a2[m];\n\tfor(int i=0;i<m;i++){\n\t\ta1[i]=a[i<<1];\n\t\ta2[i]=a[i<<1|1];\n\t}\n\tFFT(a1,m,d);FFT(a2,m,d);\n\tCplx w1=Cplx(cos(2.0*pi/n),d*sin(2.0*pi/n)),wk=Cplx(1,0);\n\tfor(int i=0;i<m;i++,wk=wk*w1){\n\t\ta[i]=a1[i]+wk*a2[i];\n\t\ta[i+m]=a1[i]-wk*a2[i];\n\t}\n\treturn;\n}\nvoid Input(){\n\tscanf(\"%d%d\",&N,&M);\n\tfor(int i=0;i<=N;i++) scanf(\"%lf\",&A[i].Re);\n\tfor(int i=0;i<=M;i++) scanf(\"%lf\",&B[i].Re);\n\tfor(L=1;L<N+M+1;L<<=1);\n\treturn;\n}\nint main(){\n\tInput();\n\tFFT(A,L,1);\n\tFFT(B,L,1);\n\tfor(int i=0;i<=L;i++)\n\t\tC[i]=A[i]*B[i];\n\tFFT(C,L,-1);\n\tfor(int i=0;i<=N+M;i++)\n\t\tprintf(\"%d \",(int)(C[i].Re/L+0.5));\n\treturn 0;\n}\n```\n\n## \u3010\u8fed\u4ee3\u4f18\u5316\u3011\n\n\u590d\u6742\u5ea6\u6ca1\u9519,\u662f$O(nlogn)$\uff0c\u4e3a\u751a\u4f1aTLE?\n\n\u6211\u4eec\u9700\u8981\u4e00\u70b9\u5c0f\u5c0f\u7684\u4f18\u5316\n\n\u518d\u56de\u6765\u770b\u770b\u8fd9\u4e2a\u56fe\n\n![FFT1](https://s2.ax1x.com/2019/12/23/l9Se6s.png)\n\n\u6211\u4eec\u53d1\u73b0\n\n1. \u53ef\u4ee5\u5148\u628a\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u6392\u6210\u56fe\u4e2d\u6700\u4e0b\u9762\u4e00\u5c42\u7684\u987a\u5e8f,\u518d\u81ea\u5e95\u5411\u4e0a\u8fd0\u7b97\n\n2. \u8ba1\u7b97\u65f6\u53ea\u4f1a\u7528\u5230\u5411\u4e0b\u4e00\u5c42\u7684\u6570,\u5b8c\u5168\u53ef\u4ee5\u53ea\u7528\u540c\u4e00\u4e2a\u6570\u7ec4\u8986\u76d6\u7740\u8ba1\u7b97\n\n\u5173\u4e8e\u7b2c\u4e00\u70b9,\u6211\u4eec\u53d1\u73b0\u6709\u4e00\u79cd\u795e\u5947\u7684\u65b9\u6cd5\u53ef\u4ee5$O(n)$\u8ba1\u7b97\u51fa\u6700\u5e95\u5c42\u7684\u987a\u5e8f\n\n\u8fd8\u662f\u4ee5$n=8$\u4e3a\u4f8b\n\n\u6700\u5e95\u5c42\u662f$\\{rnk_i\\}=\\{0,4,2,6,1,5,3,7\\}$\n\n\u6070\u597d\u662f$\\{0,1,2,3,4,5,6,7\\}$\u5728\u4e8c\u8fdb\u5236\u4e0b\u7684\u53cd\u8f6c\n\n\u50cf\u8fd9\u6837\n\n$(000)_2,(001)_2,(010)_2,(011)_2,(100)_2,(101)_2,(110)_2,(111)_2$\n\n$(000)_2,(100)_2,(010)_2,(110)_2,(001)_2,(101)_2,(011)_2,(111)_2$\n\n\u6839\u636e\u8fd9\u4e2a\u539f\u7406,\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97\u51fa$\\{rnk_i\\}$\u6570\u7ec4\n\n\u5148\u770b\u4e00\u6761\u5f0f\u5b50,\u4e5f\u8bb8\u4f60\u5c31\u4f1a$O(n)$\u8ba1\u7b97$\\{rnk_i\\}$\u4e86\n\n$rnk_i=rnk_\\frac{n}{2}*2+[i \\mod 2]$\n\n\u6ca1\u9519!\u8fd9\u6837\u7b97\u5c31\u662f$rnk_i=i$\n\n\u53ea\u8981\u53cd\u8fc7\u6765\n\n$rnk_i=rnk_\\frac{n}{2}/2+(n/2)*[i \\mod 2=1]$\n\n\u5c31\u884c\u4e86\u3002\u4e0d\u4fe1\u81ea\u5df1\u63a8\n\n\u5e76\u4e14\u5728\u5c06\u7cfb\u6570\u6392\u6210$\\{rnk_i\\}$\u65f6\u8fd9\u6837\u5199\n\n```cpp\nfor\uff08int i=0;i<=n-1;i++)\n\tif(rnk[i]>i) swap(a[i],a[rnk[i]]);\n```\n\n\u5c31\u53ef\u4ee5\u4e86\n\n\u53ea\u8981\u6211\u4eec\u7b2c\u4e00\u5c42\u5faa\u73af\u679a\u4e3e\u5f53\u524d\u8981\u5408\u5e76\u7684\u533a\u95f4\u957f\u5ea6$n$\n\n\u7b2c\u4e8c\u5c42\u679a\u4e3e\u5b8c\u6bcf\u4e00\u4e2a\u8981\u5408\u5e76\u7684\u533a\u95f4,\u5176\u4e2d$i$\u662f\u5f53\u524d\u5904\u7406\u7684\u533a\u95f4\u7684\u5de6\u7aef\u70b9\n\n\u518d\u50cf\u9012\u5f52\u7684\u505a\u6cd5\u90a3\u6837\u5728$[i,i+\\frac{n}{2}]$\u91cc\u679a\u4e3e$j$\n\n\u4ee4$t1=a[j],t2=a[j+\\frac{n}{2}]*\\omega_n^k$\n\n$a[j]=t1+t2,a[j+\\frac{n}{2}]=t1-t2;$\n\n\u8be6\u60c5\u770b\u4ee3\u7801\n```cpp\nfor(int n=2;n<=L;n<<=1){\n\tCplx w1(cos(2.0*pi/n),d*sin(2.0*pi/n));\n\tfor(int i=0;i<L;i+=n){\n\t\tCplx wk(1,0);\n\t\tfor(int j=i;j<i+(n>>1);j++,wk=wk*w1){\n\t\t\tCplx t1=a[j],t2=a[j+(n>>1)]*wk;\n\t\t\ta[j]=t1+t2;\n\t\t\ta[j+(n>>1)]=t1-t2;\n\t\t}\n\t}\n}\n```\n\n## FFT\u7279\u8272\uff1a\u4e09\u6b21\u53d8\u4e24\u6b21\u4f18\u5316\n\n\u5c06B\u653e\u5230A\u7684\u865a\u90e8\u4e0a\uff0c\u5f97\u5230\n\n$$a+bi$$\n\n\u7528FFT\u8ba1\u7b97\u5b83\u7684\u5e73\u65b9\uff0c\u5f97\n\n$$(a+bi)^2=(a^2-b^2)+(2ab)i$$\n\n\u7ed3\u679c\u7684\u865a\u90e8/2\u5c31\u662f\u7b54\u6848\u4e86\u3002\u522b\u5fd8\u4e86\u9664\u4ee5L\u3002\n\n\u8fd9\u6837\u53ef\u4ee5\u5c11\u505a\u4e00\u6b21FFT\uff0c\u5e38\u6570\u5c0f\u3002\n\n### \u3010\u6a21\u677f\u4ee3\u7801\u3011Luogu P3803\n\n\u6ce8\u610f\u4e00\u4e0b\u7ec6\u8282\u5c31\u80fdAC\u4e86\n```cpp\n//Fast Fourier Transformation\n#include <iostream>\n#include <cstdio>\n#include <cmath>\nusing namespace std;\n\nconst int MAXN=4000005;\nconst double pi=acos(-1.0);\nstruct Cplx{\n\tdouble Re,Im;\n\tCplx(double re=0,double im=0):Re(re),Im(im){}\n\tCplx operator + (const Cplx &a) const {return Cplx(Re+a.Re,Im+a.Im);}\n\tCplx operator - (const Cplx &a) const {return Cplx(Re-a.Re,Im-a.Im);}\n\tCplx operator * (const Cplx &a) const {return Cplx(Re*a.Re-Im*a.Im,Re*a.Im+Im*a.Re);}\n}A[MAXN],B[MAXN],C[MAXN];\nint N,M,L,rnk[MAXN];\n\nvoid Input(){\n\tscanf(\"%d%d\",&N,&M);\n\tfor(int i=0;i<=N;i++) scanf(\"%lf\",&A[i].Re);\n\tfor(int j=0;j<=M;j++) scanf(\"%lf\",&B[j].Re);\n\tfor(L=1;L<N+M+1;L<<=1);\n\tfor(int i=1;i<L;i++){\n\t\trnk[i]=(rnk[i>>1]>>1);\n\t\tif(i&1) rnk[i]|=(L>>1);\n\t}\n\treturn;\n}\n\nvoid FFT(Cplx *a,int d){\n\tfor(int i=0;i<L;i++)\n\t\tif(i<rnk[i]) swap(a[i],a[rnk[i]]);\n\tfor(int n=2;n<=L;n<<=1){\n\t\tCplx w1(cos(2.0*pi/n),d*sin(2.0*pi/n));\n\t\tfor(int i=0;i<L;i+=n){\n\t\t\tCplx wk(1,0);\n\t\t\tfor(int j=i;j<i+(n>>1);j++,wk=wk*w1){\n\t\t\t\tCplx t1=a[j],t2=a[j+(n>>1)]*wk;\n\t\t\t\ta[j]=t1+t2;\n\t\t\t\ta[j+(n>>1)]=t1-t2;\n\t\t\t}\n\t\t}\n\t}\n\treturn;\n}\n\nvoid mul1(){\n\tFFT(A,1);FFT(B,1);\n\tfor(int i=0;i<L;i++)\n\t\tC[i]=A[i]*B[i];\n\tFFT(C,-1);\n\tfor(int i=0;i<=N+M;i++)\n\t\tprintf(\"%d \",(int)(C[i].Re/L+0.5));\n\treturn;\n}\n\n//(a+bi)^2=(a^2-b^2)+(2ab)i\nvoid mul2(){\n\tfor(int i=0;i<L;i++)\n\t\tA[i].Im=B[i].Re;\n\tFFT(A,1);\n\tfor(int i=0;i<L;i++)\n\t\tC[i]=A[i]*A[i];\n\tFFT(C,-1);\n\tfor(int i=0;i<=N+M;i++)\n\t\tprintf(\"%d \",(int)(C[i].Im/L/2.0+0.5));\n\treturn;\n}\n\nint main(){\n\tInput();\n\tmul2();\n\treturn 0;\n}\n```\n",
        "postTime": 1576848601,
        "uid": 102091,
        "name": "NashChen",
        "ccfLevel": 7,
        "title": "\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362"
    },
    {
        "content": "\u8fd9\u9898...\u6211\u53ef\u80fd\u662f\u552f\u4e00\u4e00\u4e2a\u7528\u4e09\u79cd\u8bed\u8a00\u5404\u5199\u4e00\u904d\u7684\u4eba\n\n~~\u7136\u800cPascal\u5361\u4e0d\u8fc7\u53bb~~\n\n\u5e76\u4e14\u6211\u5e94\u8be5\u662f\u7b2c\u4e00\u4e2a\u7528C\u5199FFT\u901a\u8fc7\u7684\uff08\n\n\u6240\u4ee5\u8fd9\u7bc7\u9898\u89e3\u7684\u91cd\u70b9\u4e0d\u5728\u6570\u5b66\uff0c\u800c\u5728\u5982\u4f55\u7528C\u6109\u5feb\u5730\u98df\u7528FFT\uff08\n\n~~\u65e2\u7136\u524d\u9762\u6709P\u515a\u5361\u8fc7\u53bb\u53d1\u9898\u89e3\u90a3\u8fd9\u4e2a\u5e94\u8be5\u4e5f\u884c\u5427~~\n\n---\n\n\u5148\u91cd\u590d\u4e00\u4e0b\u505a\u6cd5\uff1a\u628a\u4e24\u4e2a\u591a\u9879\u5f0f\u53d8\u6362\u6210\u70b9\u503c\u8868\u793a\uff0c\u76f4\u63a5$O(n)$\u4e58\u8d77\u6765\uff0c\u7136\u540e\u53d8\u56de\u7cfb\u6570\u8868\u793a\u5c31\u662f\u4e86\u3002\u3002\u3002\n\n---\n\n\u7136\u540e\u8fdb\u6b63\u9898\n\n\u7531\u4e8eC++\u6709\u9762\u5411\u5bf9\u8c61\u3001\u51fd\u6570\u91cd\u8f7d\u7b49\u4e00\u7cfb\u5217\u7279\u6027\uff0c\u590d\u6570\u8fd0\u7b97\u5f88\u5bb9\u6613\u4ee5\u4f18\u7f8e\u7684\u65b9\u5f0f\u5448\u73b0\n\n\u7136\u800cC\u65e2\u4e0d\u80fd\u91cd\u8f7d\u51fd\u6570\uff0c\u4e5f\u96be\u4ee5\u9762\u5411\u5bf9\u8c61...\n\n\u7136\u800c\u5728\u7814\u7a76`std::complex`\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53d1\u73b0\u5b83\u7684\u5934\u6587\u4ef6`include`\u4e86\u4e00\u4e2a`complex.h`\u5e93...\n\n\u4e8e\u662f\u4e0a\u7f51\u5b66\u4e60\uff0c\u53d1\u73b0C\u4e5f\u6709\u590d\u6570\u5e93\uff08\u5176\u5b9e\u751a\u81f3\u4e0d\u9700\u8981\u5e93\uff0c\u5728C99\u4e2d\u590d\u6570\u5df2\u7ecf\u662f\u5185\u5efa\u7c7b\u578b\u4e86\uff09\n\n\u4e8e\u662f\u5c31\u6781\u5ea6\u8212\u9002\uff08\n\n---\n\nFFT\u9700\u8981\u7684\u57fa\u672c\u7528\u6cd5\uff1a\n\n```c\n#include<complex.h>//\u4e3a\u4e86\u65b9\u4fbf\u800c\u5305\u542b\uff0c\u5b9e\u9645\u53ef\u4ee5\u7701\u7565\uff0c\u4f46\u58f0\u660e\u53d8\u91cf\u9700\u5c06complex\u6539\u4e3a_Complex\n\ndouble complex a;//\u58f0\u660e\u57fa\u4e8edouble\u7684\u590d\u6570\u53d8\u91cf\n\ncreal(a)//\u53d6a\u7684\u5b9e\u90e8\ncimag(a)//\u53d6a\u7684\u865a\u90e8\n\na=1+2*_Complex_I//_Complex_I\u5373\u662f\u5355\u4f4d\u865a\u6570i\n\n//\u53e6\u5916\u4e0d\u62c5\u5fc3\u91cd\u540d\u53ef\u4ee5\u7528I\u4ee3\u66ff_Complex_I\n\n//\u7136\u540e\u4e0d\u8003\u8651\u53ef\u79fb\u690d\u6027\u7684\u8bdd\uff0c\u5728GCC\u4e0b\u63d0\u4f9b1.0fi,1.0i,1.0li\u7b49\u5199\u6cd5\n\n//\u540c\u65f6\u4eceC++14\u5f00\u59cb\uff0c\u7c7b\u4f3c\u76841.0if,1.0i,1.0il\u662f\u6807\u51c6\u7684\u865a\u6570\u5b57\u9762\u91cf\n```\n\n\u7136\u540e\u5927\u91cf\u7684C\u6570\u5b66\u51fd\u6570\u5747\u6709\u9488\u5bf9\u590d\u6570\u7279\u5316\u7684\u6cdb\u578b\u51fd\u6570\uff0c\u5728\u540d\u5b57\u524d\u5199\u524d\u7f00`c`\u5c31\u662f\u4e86\n\n\u4e8e\u662f\u6709\u4e86\u795e\u5947\u7684\u590d\u6570\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u6109\u5feb\u5730\u641eFFT\u4e86\uff08\n\n---\n\n\u7136\u540e\u662f\u4e0d\u5f00IO\u4f18\u5316\u5361\u4e0d\u8fc7\u53bb\u7684\u4ee3\u7801\n\n```cpp\n#include<stdio.h>\n#include<ctype.h>\n#include<math.h>\n#include<complex.h>\n\nchar gc(void)\n{\n    static char buf[1<<16],*p1=buf,*p2=buf;\n    if(p1==p2)\n    {\n        p2=(p1=buf)+fread(buf,1,1<<16,stdin);\n        if(p1==p2)return EOF;\n    }\n    return *p1++;\n}\n\n// #define gc getchar\n\nvoid read(int *x)\n{\n    *x=0;\n    char c=gc();\n    while(!isdigit(c))c=gc();\n    while(isdigit(c))\n    {\n        *x=*x*10+c-48;\n        c=gc();\n    }\n}\n\nvoid write(int x)\n{\n    if(x>=10)write(x/10);\n    putchar(x%10+48);\n}\n\n#define N (1<<21)\n#define PI 3.141592653589793238462643383\n\nint n,m;\n\ndouble complex a[N],b[N];\n\nint rev[N];\n\nvoid getrev(int n)\n{\n    for(int i=0;i<n;++i)\n    {\n        rev[i]=(rev[i>>1]>>1)|(i&1?n>>1:0);\n    }\n}\n\nvoid fft(double complex *a,int n,int dft)\n{\n    for(int i=0;i<n;++i)\n    {\n        if(i<rev[i])\n        {\n            double complex temp=a[i];\n            a[i]=a[rev[i]];\n            a[rev[i]]=temp;\n        }\n    }\n    for(int step=1;step<n;step<<=1)\n    {\n        const double complex wn=cos(PI/step)+sin(dft*PI/step)*_Complex_I;\n        for(int j=0;j<n;j+=step<<1)\n        {\n            double complex wnk=1;\n            for(int k=j;k<j+step;++k)\n            {\n                double complex x=a[k];\n                double complex y=a[k+step]*wnk;\n                a[k]=x+y;\n                a[k+step]=x-y;\n                wnk*=wn;\n            }\n        }\n    }\n    if(dft==-1)\n    {\n        double inv=1./n;\n        for(int i=0;i<n;++i)a[i]*=inv;\n    }\n}\n\nint main(void)\n{\n    read(&n),read(&m);\n    for(int i=0;i<=n;++i)\n    {\n        int x;\n        read(&x);\n        a[i]=x;\n    }\n    for(int i=0;i<=m;++i)\n    {\n        int x;\n        read(&x);\n        b[i]=x;\n    }\n    int len=1;\n    while(len<=n+m+1)len<<=1;\n    getrev(len);\n    fft(a,len,1);\n    fft(b,len,1);\n    for(int i=0;i<len;++i)a[i]*=b[i];\n    fft(a,len,-1);\n    for(int i=0;i<n+m+1;++i)\n    {\n        write((int)(creal(a[i])+0.5));\n        putchar(' ');\n    }\n}\n```\n\n~~awsl\u4e3a\u4ec0\u4e48\u8fd9\u9898\u7a81\u7136\u51cf\u5c0f\u65f6\u9650\u5361\u5e38\u6570\u554a~~\n\n\u8b66\u544a\uff0c\u82e5\u7f16\u8bd1\u5668\u6709`__STDC_NO_COMPLEX__`\u5b8f\uff0c\u5219\u4e0d\u652f\u6301\u590d\u6570\uff08gcc\u53ef\u4ee5\u653e\u5fc3\n\n\u6700\u540e\uff0c\u867d\u7136\u6211\u662f\u4e2aC++&\u9762\u5411\u5bf9\u8c61\u7684\u6b7b\u5fe0\u7c89\uff0c\u4f46\u8fd8\u662f\u8981\u8bf4\u4e00\u53e5\uff1a\n\n## C\u725b\u903c\uff01\uff01\uff01\n\n\u53e6\u5916\u4e3a\u4ec0\u4e48C\u7684\u8bed\u6cd5\u9ad8\u4eae\u840e\u6389\u4e86\u554a\u6c42\u4fee\u590d\uff08\u88ab\u8feb\u5199`cpp`QwQ\n---\n### 2020.10.14\u66f4\u65b0\n\u521d\u8d5b\u524d\u9893\u5e9f\u5b66\u4e86\u4e00\u4e0bRust\n\n\u8003\u8651\u5230FFT\u4ee3\u7801\u76f8\u5bf9\u7b80\u5355\u4e8e\u662f\u5c31\u6765\u7ec3\u7ec3\u624b\n\n---\n\n\u7b80\u8981\u4ecb\u7ecdRust\uff0c\u4e00\u4e2a\u5b89\u5168\u6027\u548c\u6548\u7387\u90fd\u76f8\u5f53\u4e0d\u9519\u7684\u65b0\u5174\u8bed\u8a00\n\n\u7531Mozilla\u7684\u5927\u4f6c\u521b\u9020\u7ef4\u62a4\n\n\u5b9a\u4f4d\u548cC++\u7c7b\u4f3c\uff0c\u96f6\u5f00\u9500\uff0c\u591a\u8303\u5f0f\n\n\u4f46\u5177\u6709\u66f4\u591a\u5b89\u5168\u7684\u3001\u6d41\u884c\u7684\u7279\u6027\n\n\u57fa\u672c\u4e0a\u53ef\u4ee5\u628aUB\u627c\u6740\u5728\u7f16\u8bd1\u671f\n\n~~\u800c\u4e14\u62e5\u6709\u6bd4GNU STL\u6e05\u6670\u4e00\u4e9b\u7684\u6807\u51c6\u5e93~~\n\n---\n\n\u8fd9\u7bc7\u9898\u89e3\u672c\u6765\u5c31\u4e0d\u662f\u8bb2\u601d\u8def\u800c\u662f\u8bb2\u4ee3\u7801\u7684...\n\n\u6240\u4ee5\u4e0b\u9762\u76f4\u63a5\u7ed9\u51fa\u4ee3\u7801\u5b9e\u73b0\uff08PS\u4e0b\u9762\u6709\u6548\u7387\u5bf9\u6bd4\uff09\n\n```rust\nconst P:i64=998244353;\nconst g:i64=3;\nconst gi:i64=332748118;\nfn power(mut a:i64,mut b:i64)->i64\n{\n\tlet mut res:i64=1;\n\twhile b!=0\n\t{\n\t\tif (b&1)!=0\n\t\t{\n\t\t\tres=res*a%P;\n\t\t}\n\t\ta=a*a%P;\n\t\tb>>=1;\n\t}\n\treturn res;\n}\n\nfn getrev(rev:&mut Vec<usize>,len:usize)\n//Rust\u5bf9\u4e8e\u6240\u6709\u6743\u7684\u63a7\u5236\u5f88\u4e25\u683c\uff0c\u53ea\u80fd\u7528\u53ef\u53d8\u5f15\u7528\u6765\u6539\u53d8\u5916\u90e8\u7684\u4e1c\u897f\n//Rust\u7684\u5f15\u7528\u4e0eC++\u7684\u6307\u9488\u7c7b\u4f3c\n{\n\trev.clear();\n\trev.push(0);\n\tfor i in 1..len\n\t{\n\t\trev.push((rev[i>>1]>>1)|(if (i&1)==0{0}else{len>>1}));\n\t}\n}\n\nfn ntt(arr:&mut Vec<i64>,n:usize,dft:bool,rev:&Vec<usize>)\n{\n\tfor i in 0..n\n\t{\n\t\tif i<rev[i]\n\t\t{\n\t\t\tarr.swap(i,rev[i]);//\u5728Rust\u4e2d\uff0c\u4e00\u4e2a\u5bf9\u8c61\u4e0d\u80fd\u540c\u65f6\u5b58\u5728\u4e24\u4e2a\u53ef\u53d8\u5f15\u7528\n\t\t\t//\u6240\u4ee5\u76f4\u63a5std::mem::swap(i,rev[i])\u662funsafe\u7684\uff0c\u9700\u8981\u7528Vec\u81ea\u5df1\u7684\u65b9\u6cd5\n\t\t}\n\t}\n\tlet mut step=1;\n\twhile step<n\n\t{\n\t\tlet wn:i64=power(if dft{g}else{gi},(P-1)/(step as i64*2));\n\t\tlet mut j=0;\n\t\twhile(j<n)\n\t\t{\n\t\t\tlet mut wnk=1;\n\t\t\tfor k in j..j+step\n\t\t\t{\n\t\t\t\tlet x=arr[k];\n\t\t\t\tlet y=arr[k+step]*wnk%P;\n\t\t\t\tarr[k]=(x+y)%P;\n\t\t\t\tarr[k+step]=(x-y+P)%P;\n\t\t\t\twnk=wnk*wn%P;\n\t\t\t}\n\t\t\tj+=step*2;\n\t\t}\n\t\tstep*=2;\n\t}\n\tif !dft\n\t{\n\t\tlet inv=power(n as i64,P-2);\n\t\tfor i in 0..n\n\t\t{\n\t\t\tarr[i]=arr[i]*inv%P;\n\t\t}\n\t}\n}\n\nextern \"C\"\n{\n\tfn getchar()->u8;\n}\n\nfn read()->i64//rust\u6ca1\u6709\u539f\u751f\u7684\u6bd4\u8f83\u7b80\u6d01\u7684\u5feb\u8bfb\uff0c\u4e0d\u5f97\u4e0d\u5b66\u4e60\u5de8\u4f6ccosmicAC\u7684\n{\n\tlet mut res=0;\n\tlet mut ch;\n\tloop\n\t{\n\t\tunsafe\n\t\t{\n\t\t\tch=getchar();\n\t\t}\n\t\tif ch>=48 && ch<=57\n\t\t{\n\t\t\tbreak;\n\t\t}\n\t}\n\tloop\n\t{\n\t\tres=res*10+(ch as i64)-48;\n\t\tunsafe\n\t\t{\n\t\t\tch=getchar();\n\t\t}\n\t\tif ch<48 || ch>57\n\t\t{\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn res;\n}\n\nfn main()\n{\n\tlet n:usize=read() as usize;//Rust\u5728safe mode\u91cc\u4e0d\u80fd\u5b9a\u4e49\u5168\u5c40\u53d8\u91cf\n\tlet m:usize=read() as usize;\n\tlet n=n+1;\n\tlet m=m+1;\n\tlet mut a:Vec<i64>=Vec::new();\n\tlet mut b:Vec<i64>=Vec::new();\n\tlet mut len=1;\n\twhile len<=n+m\n\t{\n\t\tlen*=2;\n\t}\n\tfor i in 0..n\n\t{\n\t\tlet x=read();\n\t\ta.push(x);\n\t}\n\twhile a.len()<len\n\t{\n\t\ta.push(0);\n\t}\n\tfor i in 0..m\n\t{\n\t\tlet x=read();\n\t\tb.push(x);\n\t}\n\twhile b.len()<len\n\t{\n\t\tb.push(0);\n\t}\n\tlet mut rev:Vec<usize>=Vec::new();\n\tfor i in 0..len\n\t{\n\t\trev.push(0);\n\t}\n\tgetrev(&mut rev,len);\n\tntt(&mut a,len,true,&rev);\n\tntt(&mut b,len,true,&rev);\n\tlet mut res:Vec<i64>=Vec::new();\n\tfor i in 0..len\n\t{\n\t\tres.push(a[i]*b[i]%P);\n\t}\n\tntt(&mut res,len,false,&rev);\n\tfor i in 0..n+m-1\n\t{\n\t\tprint!(\"{} \",res[i]);\n\t}\n}\n```\nC++\u5728\u4f7f\u7528\u666e\u901a\u5feb\u8bfb\u7684\u60c5\u51b5\u4e0b\u662f1.4s\uff08\u6709\u6ca1\u6709`fread`\u533a\u522b\u4e0d\u5927\uff09\n\nRust\u662f1.8s...\n\n\u770b\u6765GCC\u5f00\u53d1\u8fd9\u4e48\u591a\u5e74\u6bd5\u7adf\u662f\u6bd4rustc\u6210\u719f\u7684233",
        "postTime": 1572956808,
        "uid": 60489,
        "name": "\u5c0f\u83dc\u9e1f",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09\u3011"
    },
    {
        "content": "P\u515a\u798f\u5229\uff01\n\n\u5982\u679c\u8981\u5b66FFT\u7684\u8bdd\u8bf7\u53f3\u8f6c\u6211\u7684[blog](http://zhoushengjie.pw/notes/FFT.html)\u3002\n\n\u4e0d\u8fc7\uff0c\u7531\u4e8e\u8fd9\u9898\u6570\u636e\u8303\u56f4\u5927\uff0c\u5982\u679c\u624b\u5199complex\u7528FFT\u7684\u8bdd\u4f1a\u7206\u6808\uff0c\u7136\u540e\u4f1aRE\u3002\n\n\u6240\u4ee5\u53ea\u80fd\u7528NTT\u4e86\u3002\n\n\u53e6\u5916\uff0c\u7531\u4e8ePascal\u7684mod\u6548\u7387\u662f\u771f\u7684\u4f4e\uff0c\u8fd9\u9898\u9700\u8981\u5361\u5e38\u8fc7\u3002\n\n~~\u5c1d\u8bd5\u4e86\u5404\u79cd\u65b9\u6cd5\u624d\u5361\u8fc7\u53bb\u7684~~\n\n\u5177\u4f53\u4f1a\u5728\u4ee3\u7801\u91cc\u5199\u5982\u4f55\u5361\u5e38\u3002\n\n```\ntype\n  arr=array[0..2097151]of longint;\nconst\n  p=998244353;\n  g=3;\n  gi=332748118;\nvar\n  a,b,pow,r:arr;\n  n,m,i,num,l,inv:longint;\nfunction power(x,y:longint):longint;\nbegin\n  power:=1;\n  while y>0 do\n  begin\n    if odd(y) then\n      power:=int64(power)*x mod p;//\u6240\u6709\u7684\u4e58\u6cd5\u8fd0\u7b97\u90fd\u9700\u8981\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\uff08\u4e0d\u7136\u4f1a\u6ea2\u51fa\uff09\n    x:=sqr(int64(x)) mod p;    //\u8dd1\u7684\u6162\u6ca1\u529e\u6cd5\uff08\u5982\u679cdalao\u6709\u5174\u8da3\u63a2\u7a76\u53ef\u4ee5\u628a\u6240\u6709\u53d8\u91cf\u6539\u6210int64\uff09\n    y:=y shr 1;                //\u80fd\u7528\u4f4d\u8fd0\u7b97\u5c31\u7528\u4f4d\u8fd0\u7b97\n  end;\nend;\nprocedure ntt(var a:arr;n,s:longint);\nvar\n  i,j,k,x,y,w:longint;\nbegin\n  for i:=0 to n-1 do\n    if i<r[i] then\n    begin\n      a[i]:=a[i] xor a[r[i]];  //\u4f4d\u8fd0\u7b97\u4ea4\u6362\n      a[r[i]]:=a[i] xor a[r[i]];\n      a[i]:=a[i] xor a[r[i]];\n    end;\n  i:=1;\n  while i<n do\n  begin\n    j:=0;\n    if s=1 then\n      w:=power(g,(p-1) div (i shl 1))\n    else\n      w:=power(gi,(p-1) div (i shl 1));\n    pow[0]:=1;\n    for k:=1 to i-1 do         //\u628awnk\u5b58\u4e0b\u6765\uff0c\u51cf\u5c11\u8fd0\u7b97\u6b21\u6570\n      pow[k]:=int64(pow[k-1])*w mod p;\n    while j<n do\n    begin\n      for k:=0 to i-1 do\n      begin\n        x:=a[j+k];\n        y:=int64(a[i+j+k])*pow[k] mod p;\n        a[j+k]:=(x+y) mod p;\n        a[i+j+k]:=(x-y) mod p;\n      end;\n      inc(j,i shl 1);\n    end;\n    i:=i shl 1;\n  end;\nend;\nbegin\n  read(n,m);\n  for i:=0 to n do             //\u8bfb\u5165\u4e0d\u89e3\u91ca\n    read(a[i]);\n  for i:=0 to m do\n    read(b[i]);\n  num:=1;\n  l:=0;\n  while num<=n+m do            //\u8ba1\u7b97\u957f\u5ea6\n  begin\n    num:=num shl 1;\n    inc(l);\n  end;\n  for i:=0 to num-1 do         //\u9012\u63a8\u987a\u5e8f\n    r[i]:=(r[i shr 1] shr 1) or ((i and 1) shl (l-1));\n  //\u8fd9\u91cc\u6ca1\u6709\u9009\u62e9\u9884\u5904\u7406\u6240\u6709\u7684wnk\n  //\u6211\u4eec\u77e5\u9053\u7531\u4e8en\u53d6\u7684\u662f1,2,4,8\n  //\u53ef\u4ee5\u63d0\u524d\u8ba1\u7b97\u51fa\u5f53n\u6700\u5927\u65f6\u7684wnk\uff0c\u7136\u540e\u8ba1\u7b97\u4e0b\u6807\u5c31\u884c\u4e86\n  //\u4f46\u662f\u901a\u8fc7\u8bd5\u9a8c\u53d1\u73b0\uff0c\u8fd9\u6837\u53cd\u800c\u4f1aTLE\n  //\u6240\u4ee5\u4e3a\u4e86\u5361\u5e38\u8fd8\u662f\u6bcf\u6b21\u5355\u72ec\u8ba1\u7b97wnk\u4e86\n  ntt(a,num,1);\n  ntt(b,num,1);\n  for i:=0 to num-1 do         //\u5377\u79ef\n    a[i]:=int64(a[i])*b[i] mod p;\n  ntt(a,num,-1);\n  inv:=power(num,p-2);\n  for i:=0 to n+m do\n    a[i]:=(int64(a[i])*inv mod p+p) mod p;//\u9632\u6b62\u8d1f\u6570\u5bfc\u81f4\u4e00\u4e9b\u5947\u602a\u7684\u7ed3\u679c\uff0c\u6bd5\u7adfPascal\u7684\u53d6\u6a21\u4e0d\u4e00\u6837\n  for i:=0 to n+m do\n    write(a[i],' ');\n  writeln;\nend.\n```\n\n\u611f\u89c9\u8fd9\u79cd\u9898\u76ee\u90fd\u6ca1\u6709\u4eba\u7528Pascal\u505a\u4e86\u5462\u2026\u2026",
        "postTime": 1539918213,
        "uid": 40241,
        "name": "dblark",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09\u3011"
    },
    {
        "content": "\u8fd9\u9898\u9996\u5148\u8bf4\u660e\u662f\u6bd4\u8f83\u5751\u7684\uff0c\u5361\u5e38\u6570\u5230\u662f\u597d\u4e8b\u6709\u52a9\u4e8e\u4f18\u5316\u4ee3\u7801\uff0c\u4e3b\u8981\u662f\u7f16\u8bd1\u7cfb\u7edf\u5751\uff0c\u8fd9\u4e2a\u9898\u89e3\u4e5f\u5e0c\u671b\u7ba1\u7406\u5458\u7559\u610f\uff0c\u9996\u5148\u5927\u81f4\u601d\u8def\u662f\u628a\u6bcf\u4e2a\u591a\u9879\u5f0fNTT\uff0c\u8f6c\u6362\u6210\u70b9\u8868\u8fbe\uff0c\u7136\u540e\u76f4\u63a5\u5bf9\u5e94\u7684F[i]\u76f8\u4e58\uff0c\u6700\u540e\u518d\u7528\u9006NTT\u53d8\u56de\u53bb\uff0c\u8f93\u51fa\u524dN+M+1\u4e2a\u5373\u53ef\u3002\u6240\u6709\u4eba\u90fd\u662f\u8fd9\u6837\u505a\u7684\uff0c\u6211\u518d\u8bf4\u4e00\u4e0b\u7ec6\u8282\u548c\u7531\u4e8e\u6d1b\u8c37\u7f16\u8bd1\u7cfb\u7edf\u7684\u95ee\u9898\u88ab\u5751\u60e8\u3002\n\u4e0d\u77e5\u9053\u4e0d\u4f1a\u5199NTT\u5148\u53bb\u5199\u6a21\u677f\u3002\n\u8bbe\u591a\u9879\u5f0f\u7cfb\u6570\u6570\u7ec4\u5206\u522b\u662fa\u548cb\n\u7f16\u7801\u7ec6\u8282 :\n\n(1)P\u600e\u4e48\u53d6\uff1f\u592a\u5927\u4f1a\u7a0d\u5fae\u964d\u4f4e\u6548\u7387\uff0c\u90a3\u6211\u53d6\u5c0f\u7684\uff0c\u6bd4\u598265536\uff0c\u4f46\u662f\u5982\u679c\u505a\u591a\u9879\u5f0f\u4e58\u6cd5\uff0c\u91cc\u9762\u9006\u53d8\u6362\u56de\u6765\u7684\u7ed3\u679c\u8981\u4e0en*n\u590d\u6742\u5ea6\u7b97\u6cd5\u7ed3\u679c\u4e00\u81f4\uff0cp\u592a\u5c0f\u5c31\u7ed9mod\u6389\u4e8665536\u4e0d\u884c\uff0c\u6211\u53d6\u4e86998244353\n\n(2)\u4e3a\u4e86\u52a0\u901fg^r\u7528\u79bb\u7ebf\u6253\u8868\u65b9\u5f0f\uff0c\u4e5f\u5c3120\u591a\u4e2a\uff0c\u5b83\u7684\u9006\u5143\u4e5f\u79bb\u7ebf\u6253\u8868\n\n(3)\u591a\u9879\u5f0f\u76f8\u4e58\u5e94\u8be5\u628a\u4e0d\u591f2\u7684\u6574\u6570\u6b21\u65b9\u7684N\uff0c\u88650\u52302\u7684\u6574\u6570\u6b21\u65b9\uff0c\u4e14\u5e94\u8be5\u7edf\u4e00\u957f\u5ea6N\uff0c\n\u628aN\u53d6\u5927\u70b9\u4e0d\u8981\u5c0f\u4e8elen(a)+lenb(b),\u6bd4\u5982a\u591a\u9879\u5f0f\u67093\u4e2a\u7cfb\u6570\uff0cb\u67096\u4e2a\u7cfb\u6570\uff0c\u52a0\u4e00\u8d779\u4e2a\u90a3\u4e48\u88650\u523016\uff0c\u5bf9\u4e8ea\u548cb\u7684NTT\u90fd\u752816\u957f\u5ea6\uff0cNTT\u957f\u4e86\u4e0d\u4f1a\u51fa\uff0c\u9519\u77ed\u4e86\u4f1a\u51fa\u9519\uff0c\u56e0\u4e3a\u5230\u65f6\u5019\u7528INTT\u53d8\u56de\u53bb\u7684\u65f6\u5019\uff0clen(a*b)=16\uff0c\u5e94\u8be5\u7edf\u4e00\u524d\u540e\u957f\u5ea6\n\n(4)\u5982\u679c\u591a\u4e2a\u540c\u6837\u957f\u5ea6\u7684N\u7684NTT\u9700\u8981\u505a\uff0c\u90a3\u4e48\u53ef\u4ee5\u53ea\u6c42\u4e00\u6b21\u5012\u5e8f\u5b58\u4e0b\u6765\uff0c\u8fd9\u6837\u4e5f\u6709\u52a9\u4e8e\u8282\u7701\u65f6\u95f4\uff0c\u5c31\u6bd4\u5982\u591a\u9879\u5f0f\u4e58\u6cd5\uff0c\u76842\u6b21NTT\u548c\u4e00\u6b21INTT\uff0c\u6c42\u5012\u5e8f\u53ef\u4ee5\u7528\u96f7\u5fb7\u7b97\u6cd5\n\n(5)\u4e3a\u4e86\u51cf\u5c11\u4e58\u6cd5\u64cd\u4f5c\uff0c\u6700\u5185\u5c42\u5faa\u73af\u6ce8\u610f\u7528\u4e34\u65f6\u53d8\u91cf\u7f13\u5b58\u7684\u624b\u6bb5\u8ba9\u4e58\u6cd5\u53ea\u6709\u4e00\u6b21\n\n(6)FFT\u7684\u8776\u5f62\u52a0\u901f\u65f6\u5019\u6700\u5916\u5c42\u5faa\u73af\u662ffor(n=2;n<=N;n*=2)\u6ca1\u9519\uff0c\u8fd9\u91cc\u9762\u8981\u9996\u5148\u9884\u5904\u7406g^r\u7684\u4ece0\u5230n/2\u6b21\u65b9\u5b58\u4e0b\u6765,r=(p-1)/n\u3002\n\n(7)\u63a5\u7740\u521a\u624d\u90a3\u4e2a\uff0c\u4e3a\u4ec0\u4e48\u662fn/2\u6b21\u65b9\u4e0d\u662fn\u6b21\u65b9\uff0c\u56e0\u4e3a\u91cc\u9762\u8ba1\u7b97\u5408\u5e76\u7684\u65f6\u5019\u4e5f\u8981\u6709\u7279\u6b8a\u65b9\u6cd5\u53ea\u9700\u7b97\u4e00\u534a\u4e5f\u5c31\u662fn/2,\u800c\u4e0d\u662fn\n\n(8)\u7279\u6b8a\u65b9\u6cd5\u662f\u4ec0\u4e48\u5462?\n\u6765\u770b\u6838\u5fc3\u4ee3\u7801temp\u8868\u793a\u4e0b\u4e00\u5c42\u7684F\u6570\u7ec4\uff0cF\u8868\u793a\u5f53\u524d\u5c42\u7684F\u6570\u7ec4\uff0c\u9012\u63a8\u987a\u5e8f\u662fn\u75312\u9010\u6e10\u7ffb\u500d\u5230N\n```\nfor(i=0;i<N;i+=n){\n   for(j=0;j<m;j++){\n      b=F[i+j];\n      d=F[i+j+m]*powg[j]%mod;\n      temp[i+j]=(b+d)%mod;\n      temp[i+j+m]=(b-d+mod)%mod;//\u5229\u7528\u516c\u5f0f\u5c11\u505a\u4e58\u6cd5\u52a0\u901f\n   }\n}\n```\n\n\u5176\u5b9e\u5e94\u8be5\u662f\n```\nfor(i=0;i<N;i+=n){\n   for(j=0;j<m;j++){\n      b=F[i+j];\n      d=F[i+j+m]*powg[j]%mod;\n      temp[i+j]=(b+d)%mod;\n      temp[i+j+m]= (b+powg[m+j]* F[i+j+m])%mod\n=(b+powg[m]*powg[j]* F[i+j+m])%mod\n=(b+powg[m]*d)%mod\n }\n}\n```\n\n\u4ee5\u4e0amod=p\n(b+powg[m]*d)%p\u4e2d\n\npowg[m]=g^(N/2*(p-1)/N)%p = g^( (p-1)/2)%p \n\n\u7531\u539f\u6839\u6027\u8d28\uff0cg^( (p-1)/2)%p=p-1;\n(b+powg[m]*d)%p=(b+(p-1)*d)%p=(b-d)%p=(b-d+p)%p\n\n(9)\u91cd\u70b9\u8bf4\u5751\u7684\u70b9\u4e00\u4e0b\u4ee3\u7801\u662f\u9519\u8bef\u7684:\n```\n#include<bits/stdc++.h>\n//#include<windows.h>\nusing namespace std;\n#define ll long long\nconst int MAX=5100010;\nint mod=998244353;\nll x1[MAX];\nll x2[MAX];\nll F3[MAX];\nll powg[MAX];\nint seq[MAX];\nint p2[30]={1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152};\nint grn[30]={1,998244352,911660635,372528824,929031873,452798380,922799308,781712469,476477967,166035806,258648936,584193783,63912897,350007156,666702199,968855178,629671588,24514907,996173970,363395222,565042129,733596141};\nint grninv[30]={1,998244352,86583718,509520358,337190230,87557064,609441965,135236158,304459705,685443576,381598368,335559352,129292727,358024708,814576206,708402881,283043518,3707709,121392023,704923114,950391366,428961804};\nvoid rader(int *x,int N){//\u5fc5\u987b\u662f2\u7684\u6574\u6570\u5e42\n    int i,j,k;\n    for(i=0;i<N;i++){\n        x[i]=i;\n    }\n    for(j=0,i=0;i<N-1;i++){\n        if(i<j){\n           swap(x[i],x[j]);\n        }\n        k=N/2;\n        while(j>=k){\n            j-=k;\n            k/=2;\n        }\n        j+=k;\n    }\n}\n\nll quickmi(ll a,ll b,ll mod){//\u00d7\u00ee\u00b6\u00cc\u00d0\u00b4\u00b7\u00a8\n    ll ans=1;\n    for(a%=mod;b;b>>=1,a=a*a%mod)\n        if(b&1)\n            ans=ans*a%mod;\n    return ans;\n}\n\nll* NTT(ll *x,int N,int kind){\n    int i,j,n,m,bit,now;\n    ll d,inv,b,G,Gn;\n    ll *temp,*F;\n    F=new ll[N];\n    for(i=0;i<N;i++)\n        F[i]=x[seq[i]];\n    for(n=2,bit=1;n<=N;n*=2,bit++){\n        temp=new ll[N];\n        m=n/2;\n        powg[0]=1;\n        G=kind==1?grn[bit]:grninv[bit];\n        for(i=1;i<m;i++){\n            powg[i]=powg[i-1]*G%mod;\n        }\n        for(i=0;i<N;i+=n){\n            for(j=0;j<m;j++){\n                b=F[i+j];\n                d=F[i+j+m]*powg[j]%mod;\n                temp[i+j]=(b+d)%mod;\n                temp[i+j+m]=(b-d+mod)%mod;\n            }\n        }\n        delete []F;\n        F=temp;\n    }\n    if(kind==-1){\n        ll invN=quickmi(N,mod-2,mod);\n        for(i=0;i<N;i++){\n            F[i]=F[i]*invN%mod;\n        }\n    }\n    return F;\n}\n\nvoid print(ll *x,int len){\n    int i;\n    printf(\"%lld\",x[0]);\n    for(i=1;i<len;i++){\n        printf(\" %lld\",x[i]);\n    }printf(\"\\n\");\n}\n\nint main(int argc,char *argv[]){\n    //freopen(\"data//3.txt\",\"r\",stdin); //\u8f93\u5165\u91cd\u5b9a\u5411\uff0c\u8f93\u5165\u6570\u636e\u5c06\u4ecein.txt\u6587\u4ef6\u4e2d\u8bfb\u53d6\n    //freopen(\"data//2out.txt\",\"w\",stdout); //\u8f93\u51fa\u91cd\u5b9a\u5411\uff0c\u8f93\u51fa\u6570\u636e\u5c06\u4fdd\u5b58\u5728out.txt\u6587\u4ef6\u4e2d\n    //srand(time(NULL));//\u6709\u7684OJ\u4e0d\u80fd\u52a0\u8fd9\u53e5\u8bdd\n    ll N,M,i,j,k,nm,len;\n    scanf(\"%lld%lld\",&N,&M);\n    nm=len=M+N+1;\n    for(i=0;i<=N;i++){\n        scanf(\"%lld\",&x1[i]);\n    }\n    for(i=0;i<=M;i++){\n        scanf(\"%lld\",&x2[i]);\n    }\n    for(i=0;p2[i]<nm;i++);\n    nm=p2[i];\n    rader(seq,nm);\n    ll *F1=NTT(x1,nm,1);\n    ll *F2=NTT(x2,nm,1);\n    for(i=0;i<nm;i++){\n        F3[i]=F1[i]*F2[i]%mod;\n    }\n    delete []F1;\n    delete []F2;\n    ll *x=NTT(F3,nm,-1);\n    print(x,len);\nreturn 0;\n}\n\n```\n\u600e\u4e48\u5c31\u5bf9\u4e86\u5462\uff0c\u6ce8\u610f\u4e86\uff0c\u628aint mod=998244353;\u6539\u6210const int mod=998244353;\n\u539f\u672c\u6700\u540e\u51e0\u7ec4\u5927\u6570\u636eRE\u7684\u5c31\u53d8\u6210AC\u4e86\uff0c\u7ecf\u6d4b\u8bd5\uff0c\u4ee3\u7801\u6548\u7387\u5728\u81ea\u5df1\u7535\u8111\u4e0a\u662f\u53ef\u4ee5\u89c4\u5b9a\u65f6\u95f4\u6b63\u786e\u8fd0\u884c\u7ed3\u679c\u7684\uff0c\u800c\u4e14\u68c0\u67e5\u4ee3\u7801\u4e5f\u4e0d\u5b58\u5728\u6570\u7ec4\u8d8a\u754c\u6216\u8005\u9664\u6570\u662f0\u7684\u60c5\u51b5\uff0c\u5230\u4e86\u8bc4\u6d4b\u673a\u4e0a\u52a0\u4e0d\u52a0const\u5c31\u6210\u4e862\u4e2a\u4ee3\u7801\uff0c\u5e0c\u671b\u7ba1\u7406\u5458\u5173\u6ce8\u4e00\u4e0b",
        "postTime": 1517642454,
        "uid": 73205,
        "name": "v__v",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09\u3011"
    },
    {
        "content": "# \u300c\u5b66\u4e60\u7b14\u8bb0\u300dFFT \u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\n\n\u51e0\u4e2a\u661f\u671f\u4e4b\u540e\uff0c\u7ee7 **\u6269\u5c55\u6b27\u62c9\u5b9a\u7406** \u4e4b\u540e\uff0c $lj$ \u5927\u4f6c\u53c8\u7ed9\u6211\u4eec\u6765\u4e86\u4e00\u53d1\u6570\u8bba...\n\n\u867d\u7136\u542c\u5f97\u5fc3\u6001\u7206\u70b8\uff0c \u4f46\u662f\u8fd8\u597d\u7684\u662f\u6ca1\u6709 $ymx$ \u5927\u4f6c\u7684\u98de\u673a\u5f00\u5f97\u597d...\n\n\u81f3\u5c11\u6211\u8fd8\u6ca1\u6709\u5750\u98de\u673a...\n\n## \u5565\u662f FFT \u5440\uff1f\u5b83\u53ef\u4ee5\u5e72\u4ec0\u4e48\uff1f\n\n> \u9996\u5148\uff0c\u4f60\u9700\u8981\u77e5\u9053 **\u77e9\u9635\u4e58\u6cd5** \u7684\u76f8\u5173\u77e5\u8bc6\u3002\n\n\u901a\u8fc7 **\u77e9\u9635\u4e58\u6cd5** \u7684\u77e5\u8bc6\uff0c\u6211\u4eec\u77e5\u9053\uff0c\u5bf9\u4e8e\u4e00\u4e2a $f(x)$ \u4e0e $g(x)$ \uff0c\u5982\u679c\u6211\u4eec\u7528\u6734\u7d20\u7684\u77e9\u9635\u4e58\u6cd5\u8ba1\u7b97 $f(x)\\cdot g(x)$ \uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(N^2M)$ \uff0c\u4f46\u662f\u5bf9\u4e8e\u8fd9\u662f\u51fd\u6570\uff0c\u590d\u6742\u5ea6\u4e2d\u7684 $M=1$ \uff0c\u90a3\u4e48\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(N^2)$ \u3002\n\n\u4f3c\u4e4e\u8fd9\u662f\u6bd4\u8f83\u4f18\u79c0\u7684\uff0c\u4f46\u662f\u770b\u770b\u8fd9\u9053 **\u677f\u9898** \uff1a\n\n[luoguOJ:P3803\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09](https://www.luogu.com.cn/problem/P3803)\n\n\u55ef\uff1f $n,m\\le 10^6$ \uff0c\u4f3c\u4e4e\u8fc7\u4e8e\u592a\u5c0f\u4e86\uff1f~~\uff08\u4e0d\u8981\u7ba1\u8fd9\u75c5\u53e5...\uff09~~\n\n**\u800c FFT \u5c31\u662f\u7528\u6765\u89e3\u51b3\u591a\u9879\u5f0f\u4e58\u6cd5\u7684\u95ee\u9898\u7684\uff0c\u53ef\u4ee5\u628a\u5b83\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4f18\u5316\u5230 $O(nlog^n_2)$ \u3002**\n\n\u8fd9\u91cc\u5f15\u7528\u4e00\u53e5\u8bdd\uff1a\n\n> \u5b9e\u9645\u4e0a\uff0cFFT \u5e76\u4e0d\u662f\u76f4\u63a5\u8ba1\u7b97\u591a\u9879\u5f0f\u4e58\u6cd5\uff0c\u800c\u662f\u628a\u539f\u6765\u7684\u591a\u9879\u5f0f $f(x),g(x)$ \u5728 $O(nlog^n_2)$ \u7684\u590d\u6742\u5ea6\u5185\u8f6c\u6362\u4e3a\u5b83\u7684 <u>\u70b9\u503c\u8868\u793a</u>\uff08\u540e\u9762\u4f1a\u8bb2\uff09\uff0c\u800c\u70b9\u503c\u8868\u793a\u7684\u591a\u9879\u5f0f\u76f8\u4e58\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n)$ \u7684\u3002\u6700\u540e\u518d\u7528 $O(nlog_2^n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u628a\u6240\u5f97\u591a\u9879\u5f0f\u7684\u70b9\u503c\u8868\u793a\u8f6c\u5316\u4e3a\u4e00\u822c\u5f62\u5f0f\u3002\n\n-----\n\n## \u5fc5\u5907\u829d\u58eb\n\n\u5728\u5b66\u4e60 FFT \u4e4b\u524d\uff0c\u6211\u4eec\u9700\u8981\u77e5\u9053 **\u70b9\u503c\u8868\u793a** \u548c **\u590d\u6570** \u3002\n\n### \u70b9\u503c\u8868\u793a\n\n#### \u4ec0\u4e48\u662f\u70b9\u503c\u8868\u793a\n\n\u5bf9\u4e8e\u4e00\u4e2a\u51fd\u6570 $f(x)$ \uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a\u591a\u9879\u5f0f\u8868\u793a\u5b83\uff1a\n\n$$f(x)=a_nx^n+a_{n-1}x^{n-1}+...+a_{1}x+a_0$$\n\n\u8fd9\u79cd\u8868\u8fbe\u65b9\u6cd5\u6211\u4eec\u53eb\u505a **\u4e00\u822c\u5f62\u5f0f** \u3002\n\n\u5982\u679c\u719f\u6089\uff0c\u90a3\u4e48\u53ef\u4ee5\u786e\u5b9a\u4e00\u4e2a\u4e1c\u897f\uff0c\u5982\u679c\u6211\u4eec\u6709\u5728\u8fd9\u4e2a\u51fd\u6570\u4e0a\u7684 $n+1$ \u4e2a\u70b9\u7684\u5177\u4f53\u7684\u5750\u6807 $(x_i,y_i)$ \uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5**\u552f\u4e00\u786e\u5b9a**\u8fd9\u4e2a\u51fd\u6570\u7684\u89e3\u6790\u5f0f\uff0c\u90a3\u4e48\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528\u8fd9 $n+1$ \u4e2a\u70b9\u7684\u5177\u4f53\u5750\u6807\u6765\u8868\u793a\u8fd9\u4e2a\u591a\u9879\u5f0f\u3002\n\n\u5f53\u7136\uff0c\u5982\u679c\u77e5\u9053 **\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5** \u7684\u5927\u4f6c\uff0c\u6216\u8bb8\u53ef\u4ee5\u66f4\u597d\u5730\u7406\u89e3\u8fd9\u53e5\u8bdd\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\u4e00\u4e2a\u591a\u9879\u5f0f\u4e0e\u4e00\u4e2a\u70b9\u503c\u8868\u793a\u662f\u4e00\u4e00\u5bf9\u5e94\u7684\u3002 \n\n> \u90a3\u4e48 FFT \u5b8c\u6210\u7684\u64cd\u4f5c\u5c31\u662f\uff1a \n>\n> - \u628a\u5df2\u77e5\u7684\u4e00\u4e2a\u591a\u9879\u5f0f\u8f6c\u5316\u6210\u5bf9\u5e94\u7684\u70b9\u503c\u8868\u793a\uff1b \n> - \u628a\u5df2\u77e5\u7684\u70b9\u503c\u8868\u793a\u8f6c\u6362\u6210\u5bf9\u5e94\u7684\u591a\u9879\u5f0f\u3002 \n>\n> \u590d\u6742\u5ea6\u90fd\u662f $O(nlog_2^n)$ \u3002 \n\n#### \u70b9\u503c\u8868\u793a\u7684\u4e58\u6cd5\n\n\u90a3\u4e48\uff0c\u5047\u8bbe\u6211\u4eec\u7528 $\\{x_0,x_1,x_2,...,x_n\\}$ \u6765\u8868\u793a $f(x)$ \u4e3a $\\{(x_0,f(x_0)),(x_1,f(x_1)),...,(x_n,f(x_n))\\}$ \uff0c\u8868\u793a $g(x)$ \u4e3a $\\{(x_0,g(x_0)),(x_1,g(x_1)),...,(x_n,g(x_n))\\}$ \u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u77e5\u9053 $f(x)\\cdot g(x)$ \u7684\u70b9\u503c\u8868\u8fbe\u5f0f\u4e3a $\\{(x_0,f(x_0)\\cdot g(x_0)),...,(x_n,f(x_n)\\cdot g(x_n))\\}$ \uff0c\u5176\u5b9e\u5c31\u662f\u5bf9\u5e94\u9879\u76f8\u4e58\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n)$ \uff0c\u4f3c\u4e4e\u53ef\u4ee5\u63a5\u53d7\u3002\n\n-----\n\n### \u590d\u6570\n\n#### \u590d\u6570\u7684\u5b9a\u4e49\n\n$Hint.$ \u662f **\u590d\u6570(complex)** \u800c\u4e0d\u662f **\u8d1f\u6570(negative)** \u3002\n\n\u9996\u5148\u6211\u4eec\u8981\u77e5\u9053 **\u865a\u6570** \uff0c\u5373\u6709\u4e00\u4e2a\u5f88\u7279\u522b\u7684\u6570 $i$ \uff0c\u6ee1\u8db3 $i^2=-1$ \uff0c\u5373 $i=\\sqrt{-1}$ \u3002\n\n\u4e0d\u7528\u7406\u89e3\u4e3a\u4ec0\u4e48\uff0c\u56e0\u4e3a\u4ed6\u672c\u6765\u5c31\u662f\u7279\u6b8a\u5b9a\u4e49\u7684\uff0c\u53ea\u9700\u8981\u8bb0\u4f4f\u5c31\u597d\u3002\n\n\u7136\u540e\u4e00\u4e2a\u590d\u6570 $a$ \u53ef\u4ee5\u8868\u793a\u4e3a\u5b9e\u90e8 $x$ \u548c\u865a\u90e8 $y\\times i$ \u4e4b\u548c\u2014\u2014 $a=x+y\\times i$ \u3002\u5bf9\u4e8e\u4e00\u4e2a\u5b9e\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u653e\u5728\u201c\u4e00\u7ef4\u6570\u8f74\u201d\u4e0a\uff0c\u5373\u6570\u8f74\uff1b\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a\u590d\u6570\uff0c\u6211\u4eec\u9700\u8981\u628a\u5b83\u653e\u5728\u201c\u4e8c\u7ef4\u6570\u8f74\u201d\uff0c\u4e5f\u5c31\u662f\u76f4\u89d2\u5750\u6807\u7cfb\u4e0a\u3002\n\n\u5176\u5b9e\uff0c\u6211\u4eec\u53ef\u4ee5\u628a $a$ \u8868\u793a\u6210 **\u5411\u91cf(vector)** \u7684\u5f62\u5f0f\uff0c\u5373\u5c06 $a=x+y\\times i$ \u8868\u793a\u4e3a\u5411\u91cf $(x,y)$ \uff0c\u4f46\u662f\u5bf9\u4e8e\u540e\u9762\u865a\u6570\u7684\u4e58\u6cd5\uff0c\u5176\u5b9e\u662f\u4e0d\u6ee1\u8db3\u5411\u91cf\u4e58\u6cd5\u7684\uff0c\u4f46\u662f\u8fd9\u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u7406\u89e3\u65b9\u5f0f\u3002\n\n#### \u590d\u6570\u7684\u4e58\u6cd5\u8fd0\u7b97\n\n\u5bf9\u4e8e\u4e24\u4e2a\u865a\u6570 $a,b$ \uff0c\u5176\u4e2d $a=x+y\\times i,b=x'+y'\\times i$ \uff0c\u8ba1\u7b97 $ab$ \u3002\n\n\u6211\u4eec\u6709\u4e24\u79cd\u65b9\u6cd5\uff1a\n\n1. \u53ef\u4ee5\u76f4\u63a5\u5c55\u5f00\u76f8\u4e58\uff1a $ab=(x+yi)(x'+y'i)=(xx'-yy')+(xy'+x'y)i$ \u3002\n2. \u53ef\u4ee5\u4ece\u51e0\u4f55\u89d2\u5ea6\u7406\u89e3\uff1a\u4e24\u4e2a\u590d\u6570\u76f8\u4e58\u7b49\u4e8e\u201c\u5e45\u89d2\u76f8\u52a0\uff0c\u6a21\u957f\u76f8\u4e58\u201d\uff08\u4f46\u5e76\u4e0d\u6ee1\u8db3\u5411\u91cf\u7684\u8fd0\u7b97\uff09\n\n\u66f4\u63a8\u8350\u5c31\u7528\u65b9\u6cd5\u4e00\u6765\u7406\u89e3\u3002\n\n#### \u5355\u4f4d\u590d\u6570\n\n> $Hint.$ \u590d\u6570\u7684\u6a21\u957f $|a|$ \uff08\u8fd9\u4e2a\u4e0d\u662f\u7edd\u5bf9\u503c\uff09\uff0c\u8868\u793a\u628a\u5b83\u8868\u793a\u6210\u5411\u91cf\u540e\u7684\u957f\u5ea6\uff0c\u5373 $|a|=\\sqrt{x^2+y^2}$ \u3002\n\n\u6211\u4eec\u5b9a\u4e49 $n$ \u6b21\u5355\u4f4d\u590d\u6839 $\\omega_n^i$ \u4e3a\u6ee1\u8db3 $\\text{z}^n=1$ \u7684\u590d\u6570 $\\text{z}$ \u3002\n\n>\u672c\u4eba\u7684\u7406\u89e3\u65b9\u6cd5\uff1a\u5355\u4f4d\u590d\u6839 $\\omega_n^i$ \u5373\u4e3a\u5c06\u4e00\u4e2a**\u5355\u4f4d\u5706**\u5206\u6210 $n$ \u5206\uff0c\u800c $\\omega_n^i$ \u5c31\u662f $i$ \u4e2a\u8fd9\u6837\u7684\u89d2\u62fc\u8d77\u6765\u3002\u7279\u522b\u5730\uff0c $\\omega_n^0=1$ \u3002\n>\n>\u5176\u5b9e\uff0c\u4e4b\u540e\u7684\u7406\u89e3\u90fd\u53ef\u4ee5\u901a\u8fc7 **\u4e09\u89d2\u51fd\u6570** \u6709\u66f4\u597d\u7684\u7406\u89e3\n\n\u53ef\u4ee5\u53d1\u73b0 $n$ \u6b21\u5355\u4f4d\u590d\u6839\u6ee1\u8db3\u4ee5\u4e0b\u6027\u8d28\uff08 $\\omega_n^i$ \u8868\u793a\u7b2c $i$ \u4e2a\u5355\u4f4d\u590d\u6839\uff09\uff1a\n\n- $|\\omega_n^i|=1$ \uff08\u90fd\u5728\u5355\u4f4d\u5706\u4e0a\uff09\uff1b\n-  $\\omega_n^i$ \u7684\u5e45\u89d2\u4e3a $\\frac{2\\pi i}{n}$ \uff1b$Tab.$ \u8fd9\u91cc\u7684 $i$ \u662f\u4e0b\u6807\u4e0d\u662f\u865a\u6570\uff0c\u89d2\u5ea6\u4e3a\u5f27\u5ea6\u5236\uff08 $360^{\\circ}$ \u5f27\u5ea6\u89d2\u4e3a $2\\pi$ \uff09\n- \u603b\u5171\u6709 $n$ \u4e2a\u5355\u4f4d\u590d\u6839\uff0c\u8bb0\u4e3a $\\omega_n^0,\\omega_n^1,\\omega_n^2,...,\\omega_n^{n-1}$\n\n\u53e6\u5916\uff0c\u8fd8\u6709\u4e00\u4e9b\u6bd4\u8f83\u660e\u663e\u7684\u6027\u8d28\uff1a\n\n- $\\omega_n^i\\cdot\\omega_n^j=\\omega_n^{i+j}$ \uff1b\n- $\\omega_n^{i+n}=\\omega_n^i$ \uff1b\n- $\\omega_n^i=\\omega_{kn}^{ki}$ \uff1b\n- $\\omega_n^i=-\\omega_n^{i+n/2}$ \uff08\u8fd9\u91cc\u7684\u201c\u8d1f\u201d\u8868\u793a\u5927\u5c0f\u76f8\u7b49\u3001\u65b9\u5411\u76f8\u53cd\uff09 \n\n**\u4ee5\u4e0a\u8fd9\u4e9b\u7ed3\u8bba\u90fd\u53ef\u4ee5\u901a\u8fc7\u5728\u5355\u4f4d\u5706\u4e0a\u753b\u51fa\u5355\u4f4d\u6839\u6765\u8bc1\u660e\u3002**\n\n\u5355\u4f4d\u590d\u6839\u6709\u4ec0\u4e48\u7528\u5462\uff1f\u56e0\u4e3a $n$ \u6b21\u5355\u4f4d\u590d\u6839\u6070\u597d\u6709 $n$ \u4e2a\uff0c\u5c31\u53ef\u4ee5\u628a\u8fd9 $n$ \u4e2a\u5355\u4f4d\u590d\u6839\u5206\u522b\u4ee3\u5165 $n-1$ \u6b21\u591a\u9879\u5f0f $f(x)$ \u2014\u2014 \u5f97\u5230\u70b9\u503c\u8868\u8fbe $\\{(\\omega_n^0,f(\\omega_n^0)),(\\omega_n^1,f(\\omega_n^1)),...,(\\omega_n^{n-1},f(\\omega_n^{n-1}))\\}$ \u3002\n\n## \u5085\u7acb\u53f6\u6b63\u53d8\u6362\n\n\u6709\u4e86\u8fd9\u4e9b\u8f85\u52a9\u77e5\u8bc6 ~~\u6ca1\u9519\uff0c\u867d\u7136\u4f60\u53ef\u80fd\u5df2\u7ecf\u6655\u4e86\uff0c\u4f46\u662f\u4ed6\u4eec\u771f\u7684\u53ea\u662f\u8f85\u52a9\u77e5\u8bc6~~ \uff0c\u6211\u4eec\u7ec8\u4e8e\u53ef\u4ee5\u8fdb\u884c\u6b63\u9898\u4e86\u3002\n\n\u6240\u8c13\u53d8\u6362\uff0c\u90a3\u4e48\u4e00\u5b9a\u6709\u6b63\u4e5f\u6709\u9006\uff0c\u73b0\u5728\u6211\u6211\u4eec\u5148\u6765\u638c\u63e1\u5b83\u7684\u6b63\u53d8\u6362\u3002\n\nFFT \u7684\u6b63\u53d8\u6362\u5b9e\u73b0\uff0c\u662f\u57fa\u4e8e\u5bf9\u591a\u9879\u5f0f\u8fdb\u884c\u5947\u5076\u9879\u5206\u5f00\u9012\u5f52\u518d\u5408\u5e76\u7684\u5206\u6cbb\u8fdb\u884c\u7684\u3002\n\n\u5bf9\u4e8e n-1 \u6b21\u591a\u9879\u5f0f\uff0c\u6211\u4eec\u9009\u62e9\u63d2\u5165 n \u6b21\u5355\u4f4d\u6839\u6c42\u51fa\u5176\u70b9\u503c\u8868\u8fbe\u5f0f\u3002\n\n\u8bb0\u591a\u9879\u5f0f $A(x)=a_0+a_1x+a_2x^2+...+a_{n-1}x^{n-1}$ \u3002\n\n\u518d\u8bb0 $A_o(x)=a_1+a_3x+a_5x^2+...$ \u3002\n\n\u518d\u8bb0 $A_e(x)=a_0+a_2x+a_4x^2+...$ \u3002\n\n\u6709 $A(x)=x*A_o(x^2)+A_e(x^2)$ \u3002\n\n\u4ee4 $n = 2*p$ \u3002\u5219\u6709\uff1a\n\n$A(w_n^k)=w_n^k*A_o[(w_{n/2}^{k/2})^2]+A_e[(w_{n/2}^{k/2})^2]=w_n^k*A_o(w_p^k)+A_e(w_p^k)$ \uff1b\n\n$A(w_n^{k+p})=w_n^{k+p}*A_o(w_p^{k+p})+A_e(w_p^{k+p})=-w_n^k*A_o(w_p^k)+A_e(w_p^k)$\n\n\u5728\u5df2\u77e5  $A_o(w_p^k)$ \u4e0e  $A_e(w_p^k)$ \u7684\u524d\u63d0\u4e0b\uff0c\u53ef\u4ee5 $O(1)$ \u7b97\u51fa  $A(w_n^k)$ \u4e0e  $A(w_n^{k+p})$ \u3002\n\n\u56e0\u6b64\uff0c\u5047\u5982\u6211\u4eec\u9012\u5f52\u6c42\u89e3 $A_o(x),A_e(x)$ \u4e24\u4e2a\u591a\u9879\u5f0f $p$ \u6b21\u5355\u4f4d\u6839\u7684\u63d2\u503c\uff0c\u5c31\u53ef\u4ee5\u5728 $O(n)$ \u7684\u65f6\u95f4\u5185\u7b97\u51fa $A(x)$ n \u6b21\u5355\u4f4d\u6839\u7684\u63d2\u503c\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u7ecf\u5178\u7684 $T(n)=2*T(n/2)+O(n)=O(n\\log n)$\u3002\n\n## \u5085\u91cc\u53f6\u9006\u53d8\u6362\n\n\u521a\u521a\u7814\u7a76\u5b8c\u6b63\u7684\uff0c\u73b0\u5728\u6211\u4eec\u6765\u7814\u7a76\u9006\u53d8\u6362\uff0c\u5176\u5b9e\u4e5f\u6bd4\u8f83\u597d\u7406\u89e3\u3002\n\n\u89c2\u5bdf\u6211\u4eec\u521a\u521a\u7684\u63d2\u503c\u8fc7\u7a0b\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u8fdb\u884c\u4e86\u5982\u4e0b\u7684\u77e9\u9635\u4e58\u6cd5\u3002\n\n$$\n\\begin{bmatrix} (w_n^0)^0 & (w_n^0)^1 & \\cdots & (w_n^0)^{n-1} \\\\ (w_n^1)^0 & (w_n^1)^1 & \\cdots & (w_n^1)^{n-1} \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ (w_n^{n-1})^0 & (w_n^{n-1})^1 & \\cdots & (w_n^{n-1})^{n-1} \\end{bmatrix} \\begin{bmatrix} a_0 \\\\ a_1 \\\\ \\vdots \\\\ a_{n-1} \\end{bmatrix} = \\begin{bmatrix} A(w_n^0) \\\\ A(w_n^1) \\\\ \\vdots \\\\ A(w_n^{n-1}) \\end{bmatrix}\n$$\n\n\u6211\u4eec\u8bb0\u4e0a\u9762\u7684\u7cfb\u6570\u77e9\u9635\u4e3a $V$ \u3002\n\n\u5bf9\u4e8e\u4e0b\u9762\u5b9a\u4e49\u7684 $D$ \uff1a\n\n$$\nD = \\begin{bmatrix} (w_n^{-0})^0 & (w_n^{-0})^1 & \\cdots & (w_n^{-0})^{n-1} \\\\ (w_n^{-1})^0 & (w_n^{-1})^1 & \\cdots & (w_n^{-1})^{n-1} \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ (w_n^{-(n-1)})^0 & (w_n^{-(n-1)})^1 & \\cdots & (w_n^{-(n-1)})^{n-1} \\end{bmatrix}\n$$\n\n\u8003\u8651 $D*V$ \u7684\u7ed3\u679c\uff1a\n\n$$\n(D*V)_{ij}\n=\\sum_{k=0}^{k<n}d_{ik}*v_{kj}\n=\\sum_{k=0}^{k<n}w_n^{-ik}*w_{n}^{kj}\n=\\sum_{k=0}^{k<n}w_n^{k(j-i)}\n$$\n\n \u5f53 $i = j$ \u65f6\uff0c $(D*V)_{ij}=n$ \uff1b\n\n \u5f53 $i \u2260 j$ \u65f6\uff0c $(D*V)_{ij}=1+w_n^{j-i}+(w_n^{j-i})^2+...=\\frac{1-(w_n^{j-i})^n}{1-w_n^{j-i}}=0$ \uff1b\n\n> \u6839\u636e\u5b9a\u4e49\uff0c $n$ \u6b21\u5355\u4f4d\u6839\u7684 $n$ \u6b21\u65b9\u90fd\u7b49\u4e8e $1$ \n\n\u6240\u4ee5\uff1a$\\frac1n*D=V^{-1}$\n\n \u56e0\u6b64\u5c06\u8fd9\u4e2a\u7ed3\u679c\u4ee3\u5165\u6700\u4e0a\u9762\u90a3\u4e2a\u516c\u5f0f\u91cc\u9762\uff0c\u6709\uff1a\n\n$$\n\\begin{bmatrix} a_0 \\\\ a_1 \\\\ \\vdots \\\\ a_{n-1} \\end{bmatrix} = \\frac1n \\begin{bmatrix} (w_n^{-0})^0 & (w_n^{-0})^1 & \\cdots & (w_n^{-0})^{n-1} \\\\ (w_n^{-1})^0 & (w_n^{-1})^1 & \\cdots & (w_n^{-1})^{n-1} \\\\ \\vdots & \\vdots & \\ddots & \\vdots \\\\ (w_n^{-(n-1)})^0 & (w_n^{-(n-1)})^1 & \\cdots & (w_n^{-(n-1)})^{n-1} \\end{bmatrix}\\begin{bmatrix} A(w_n^0) \\\\ A(w_n^1) \\\\ \\vdots \\\\ A(w_n^{n-1}) \\end{bmatrix}\n$$\n\n>\u201c\u8fd9\u6837\uff0c\u9006\u53d8\u6362 \u5c31\u76f8\u5f53\u4e8e\u628a \u6b63\u53d8\u6362 \u8fc7\u7a0b\u4e2d\u7684 $w_n^k$ \u6362\u6210 $w_n^{-k}$\uff0c\u4e4b\u540e\u7ed3\u679c\u9664\u4ee5 $n$ \u5c31\u53ef\u4ee5\u4e86\u3002\u201d\u2014\u2014\u6458\u81ea\u67d0\u535a\u5ba2\u3002\n\n\u2026\u2026\n\n \u8fd8\u662f\u6709\u70b9\u96be\u7406\u89e3\u3002\u6bd4\u5982\u4e3a\u4ec0\u4e48\u6211\u4eec\u4e0d\u76f4\u63a5\u628a $w_n^k$ \u6362\u6210 $\\frac1n*w_n^{-k}$ \u7b97\u4e86\u3002\n \u5b9e\u9645\u4e0a\uff0c\u56e0\u4e3a $w_n^{-k}=w_n^{n-k}$ \uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83 ~~TM~~ \u8fd8\u662f\u4e00\u4e2a $n$ \u6b21\u5355\u4f4d\u6839\u3002\u6240\u4ee5\u6211\u4eec\u63d2\u503c\u8fd8\u662f\u6b63\u5e38\u7684\u8be5\u600e\u4e48\u63d2\u600e\u4e48\u63d2\u3002\u5982\u679c\u6362\u6210 $\\frac1n*w_n^{-k}$ \u5b83\u5c31\u4e0d\u662f\u4e00\u4e2a\u5355\u4f4d\u6839\uff0c\u4ee5\u4e0a\u6027\u8d28\u5c31\u4e0d\u6ee1\u8db3\u4e86\u3002\n\n## FFT \u7684\u4ee3\u7801\u5b9e\u73b0\n\n\u6211\u4eec\u6709\u4e24\u4e2a\u7248\u672c\u2014\u2014\u9012\u5f52\u3001\u8fed\u4ee3\uff0c\u76f8\u4fe1\u5927\u5bb6\u90fd\u4e5f\u60f3\u5230\u4e86\u5427\uff1f\n\n\u6bcb\u5eb8\u7f6e\u7591\u7684\uff0c\u9012\u5f52\u7248\u672c\u786e\u5b9e\u5f88\u597d\u5199\uff0c\u5c06 $FFT$ \u7684\u601d\u8def\u5168\u90e8\u653e\u5230\u4e0a\u9762\u5373\u53ef\uff0c\u4f46\u662f\u65b9\u4fbf\u4e5f\u6709\u4ed6\u7684\u574f\u5904\u2014\u2014\u9012\u5f52\u5b9e\u73b0\u5e38\u6570\u8f83\u5927\uff0c\u8fd9\u6837\u5bf9\u4e8e\u4e00\u4e9b\u9898\u5c31\u4f1a $T$ \u98de\uff0c\u4f46\u662f\u6211\u8fd8\u662f\u5199\u4e86\uff0c\u8fd9\u91cc\u4e0a\u4ee3\u7801\u4e86\n\n```cpp\n#include<cstdio>\n#include<cmath>\n\n#define rep(i,__l,__r) for(register int i=__l,i##_end_=__r;i<=i##_end_;++i)\n#define fep(i,__l,__r) for(register int i=__l,i##_end_=__r;i>=i##_end_;--i)\n#define writc(a,b) fwrit(a),putchar(b)\n#define mp(a,b) make_pair(a,b)\n#define ft first\n#define sd second\n#define LL long long\n#define ull unsigned long long\n#define pii pair<int,int>\n#define Endl putchar('\\n')\n// #define FILEOI\n// #define int long long\n\n#ifdef FILEOI\n    #define MAXBUFFERSIZE 500000\n    inline char fgetc(){\n        static char buf[MAXBUFFERSIZE+5],*p1=buf,*p2=buf;\n        return p1==p2&&(p2=(p1=buf)+fread(buf,1,MAXBUFFERSIZE,stdin),p1==p2)?EOF:*p1++;\n    }\n    #undef MAXBUFFERSIZE\n    #define cg (c=fgetc())\n#else\n    #define cg (c=getchar())\n#endif\ntemplate<class T>inline void qread(T& x){\n    char c;bool f=0;\n    while(cg<'0'||'9'<c)f|=(c=='-');\n    for(x=(c^48);'0'<=cg&&c<='9';x=(x<<1)+(x<<3)+(c^48));\n    if(f)x=-x;\n}\ninline int qread(){\n    int x=0;char c;bool f=0;\n    while(cg<'0'||'9'<c)f|=(c=='-');\n    for(x=(c^48);'0'<=cg&&c<='9';x=(x<<1)+(x<<3)+(c^48));\n    return f?-x:x;\n}\ntemplate<class T,class... Args>inline void qread(T& x,Args&... args){qread(x),qread(args...);}\ntemplate<class T>inline T Max(const T x,const T y){return x>y?x:y;}\ntemplate<class T>inline T Min(const T x,const T y){return x<y?x:y;}\ntemplate<class T>inline T fab(const T x){return x>0?x:-x;}\ninline int gcd(const int a,const int b){return b?gcd(b,a%b):a;}\ninline void getInv(int inv[],const int lim,const int MOD){\n    inv[0]=inv[1]=1;for(int i=2;i<=lim;++i)inv[i]=1ll*inv[MOD%i]*(MOD-MOD/i)%MOD;\n}\ntemplate<class T>void fwrit(const T x){\n    if(x<0)return (void)(putchar('-'),fwrit(-x));\n    if(x>9)fwrit(x/10);putchar(x%10^48);\n}\ninline LL mulMod(const LL a,const LL b,const LL mod){//long long multiplie_mod\n    return ((a*b-(LL)((long double)a/mod*b+1e-8)*mod)%mod+mod)%mod;\n}\n\nconst int MAXN=3e6;\nconst double Pi=acos(-1.0);\n\nclass task{\nprivate:\n    struct cplx{\n        double vr,vi;//\u5b9e\u90e8\u548c\u865a\u90e8\n        cplx(const double R=0,const double I=0):vr(R),vi(I){}//\u6784\u9020\u51fd\u6570\n        //------------------overload----------------//\n        cplx operator + (const cplx a)const{return cplx(vr+a.vr,vi+a.vi);}//\u91cd\u8f7d\u52a0\u6cd5\n        cplx operator - (const cplx a)const{return cplx(vr-a.vr,vi-a.vi);}\n        cplx operator * (const cplx a)const{return cplx(vr*a.vr-vi*a.vi,vr*a.vi+a.vr*vi);}\n        cplx operator / (const double var)const{return cplx(vr/var,vi/var);}\n    };\n\n    int n,m;\n    cplx a[MAXN+5],b[MAXN+5];\n\n    void fft(cplx* f,const int len,const short opt=1){\n        //opt==-1 : FFT \u7684\u9006\u53d8\u6362\n        if(!len)return;\n        cplx f0[len+5],f1[len+5];\n        for(int i=0;i<len;++i)\n            f0[i]=f[i<<1],f1[i]=f[i<<1|1];\n        fft(f0,len>>1,opt);\n        fft(f1,len>>1,opt);\n        cplx w=cplx(cos(Pi/len),opt*sin(Pi/len)),buf=cplx(1,0);\n        for(int i=0;i<len;++i,buf=buf*w){\n            f[i]=f0[i]+buf*f1[i];\n            f[i+len]=f0[i]-buf*f1[i];\n        }\n    }\npublic:\n    inline void launch(){\n        qread(n,m);\n        rep(i,0,n)scanf(\"%lf\",&a[i].vr);\n        rep(i,0,m)scanf(\"%lf\",&b[i].vr);\n        for(m+=n,n=1;n<=m;n<<=1);\n        fft(a,n>>1);\n        fft(b,n>>1);\n        rep(i,0,n-1)a[i]=a[i]*b[i];\n        fft(a,n>>1,-1);\n        rep(i,0,m)writc((int)((a[i].vr)/n+0.5),' ');\n        Endl;\n    }\n}This;\n\nsigned main(){\n#ifdef FILEOI\n    freopen(\"file.in\",\"r\",stdin);\n    freopen(\"file.out\",\"w\",stdout);\n#endif\n    This.launch();\n    return 0;\n}\n```\n\n\u4f3c\u4e4e\u9012\u5f52\u7248\u672c\u6bd4\u8f83\u597d\u5199\uff0c\u73b0\u5728\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u8fed\u4ee3\uff08\u9012\u63a8\uff09\u7248\u672c\u5e94\u8be5\u600e\u4e48\u505a\uff1a\n\n\u539f\u5e8f\u5217\uff1a $0,1,2,3,4,5,6,7$ \n\n\u7ec8\u5e8f\u5217\uff1a $0,4,2,6,1,5,3,7$\n\n\u8f6c\u6362\u4e3a\u4e8c\u8fdb\u5236\u518d\u6765\u770b\u770b\u3002\n\n\u539f\u5e8f\u5217\uff1a $000,001,010,011,100,101,110,111$\n\n\u7ec8\u5e8f\u5217\uff1a $000,100,010,110,001,101,011,111$ \n\n\u53ef\u4ee5\u53d1\u73b0\u7ec8\u5e8f\u5217\u662f\u539f\u5e8f\u5217\u6bcf\u4e2a\u5143\u7d20\u7684**\u4e8c\u8fdb\u5236\u7ffb\u8f6c**\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5148\u628a\u8981\u53d8\u6362\u7684\u7cfb\u6570\u6392\u5728\u76f8\u90bb\u4f4d\u7f6e\uff0c**\u4ece\u4e0b\u5f80\u4e0a**\u8fed\u4ee3\u3002\n\n\u8fd9\u4e2a\u4e8c\u8fdb\u5236\u7ffb\u8f6c\u8fc7\u7a0b\u53ef\u4ee5\u81ea\u5df1\u8111\u8865\u65b9\u6cd5\uff0c\u53ea\u8981\u4fdd\u8bc1\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$ \uff0c\u4ee3\u7801\u7b80\u6d01\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u5728\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4e2a\u53c2\u8003\u7684\u65b9\u6cd5\uff1a\n\n\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e2a $i$ \uff0c\u5047\u8bbe\u5df2\u77e5 $i-1$ \u7684\u7ffb\u8f6c\u4e3a $j$ \u3002\u8003\u8651\u4e0d\u8fdb\u884c\u7ffb\u8f6c\u7684\u4e8c\u8fdb\u5236\u52a0\u6cd5\u600e\u4e48\u8fdb\u884c\uff1a\u4ece\u6700\u4f4e\u4f4d\u5f00\u59cb\uff0c\u627e\u5230\u7b2c\u4e00\u4e2a\u4e3a $0$ \u7684\u4e8c\u8fdb\u5236\u4f4d\uff0c\u5c06\u5b83\u4e4b\u524d\u7684 $1$ \u53d8\u4e3a $0$ \uff0c\u5c06\u5b83\u81ea\u5df1\u53d8\u4e3a $1$ \u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u4ece $j$ \u7684\u6700\u9ad8\u4f4d\u5f00\u59cb\uff0c\u5012\u8fc7\u6765\u8fdb\u884c\u8fd9\u4e2a\u8fc7\u7a0b\u3002\n\n\u8fd9\u662f\u8fed\u4ee3\u7248\u672c\uff1a\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\nusing namespace std;\n\n#define rep(i,__l,__r) for(register int i=__l,i##_end_=__r;i<=i##_end_;++i)\n#define fep(i,__l,__r) for(register int i=__l,i##_end_=__r;i>=i##_end_;--i)\n#define writc(a,b) fwrit(a),putchar(b)\n#define mp(a,b) make_pair(a,b)\n#define ft first\n#define sd second\n#define LL long long\n#define ull unsigned long long\n#define pii pair<int,int>\n#define Endl putchar('\\n')\n// #define FILEOI\n// #define int long long\n\n#ifdef FILEOI\n    #define MAXBUFFERSIZE 500000\n    inline char fgetc(){\n        static char buf[MAXBUFFERSIZE+5],*p1=buf,*p2=buf;\n        return p1==p2&&(p2=(p1=buf)+fread(buf,1,MAXBUFFERSIZE,stdin),p1==p2)?EOF:*p1++;\n    }\n    #undef MAXBUFFERSIZE\n    #define cg (c=fgetc())\n#else\n    #define cg (c=getchar())\n#endif\ntemplate<class T>inline void qread(T& x){\n    char c;bool f=0;\n    while(cg<'0'||'9'<c)f|=(c=='-');\n    for(x=(c^48);'0'<=cg&&c<='9';x=(x<<1)+(x<<3)+(c^48));\n    if(f)x=-x;\n}\ninline int qread(){\n    int x=0;char c;bool f=0;\n    while(cg<'0'||'9'<c)f|=(c=='-');\n    for(x=(c^48);'0'<=cg&&c<='9';x=(x<<1)+(x<<3)+(c^48));\n    return f?-x:x;\n}\ntemplate<class T,class... Args>inline void qread(T& x,Args&... args){qread(x),qread(args...);}\ntemplate<class T>inline T Max(const T x,const T y){return x>y?x:y;}\ntemplate<class T>inline T Min(const T x,const T y){return x<y?x:y;}\ntemplate<class T>inline T fab(const T x){return x>0?x:-x;}\ninline int gcd(const int a,const int b){return b?gcd(b,a%b):a;}\ninline void getInv(int inv[],const int lim,const int MOD){\n    inv[0]=inv[1]=1;for(int i=2;i<=lim;++i)inv[i]=1ll*inv[MOD%i]*(MOD-MOD/i)%MOD;\n}\ntemplate<class T>void fwrit(const T x){\n    if(x<0)return (void)(putchar('-'),fwrit(-x));\n    if(x>9)fwrit(x/10);putchar(x%10^48);\n}\ninline LL mulMod(const LL a,const LL b,const LL mod){//long long multiplie_mod\n    return ((a*b-(LL)((long double)a/mod*b+1e-8)*mod)%mod+mod)%mod;\n}\n\nconst int MAXN=3e6;\nconst double Pi=acos(-1.0);\n\nclass task{\nprivate:\n    struct cplx{\n        double vr,vi;//\u5b9e\u90e8\u548c\u865a\u90e8\n        cplx(const double R=0,const double I=0):vr(R),vi(I){}//\u6784\u9020\u51fd\u6570\n        //------------------overload----------------//\n        cplx operator + (const cplx a)const{return cplx(vr+a.vr,vi+a.vi);}//\u91cd\u8f7d\u52a0\u6cd5\n        cplx operator - (const cplx a)const{return cplx(vr-a.vr,vi-a.vi);}\n        cplx operator * (const cplx a)const{return cplx(vr*a.vr-vi*a.vi,vr*a.vi+a.vr*vi);}\n        cplx operator / (const double var)const{return cplx(vr/var,vi/var);}\n    };\n\n    int n,m;\n    cplx a[MAXN+5],b[MAXN+5];\n    int revi[MAXN+5];\n\n    /*\n        f(w^x)\n        =f0(w^{2x})+w^x*f1(w^{2x})\n        =a0+a2+a4+...,a1+a3+a5+...\n        =a0+a4+a8+...+a2+a6+a10...+a1+a5+a9+...+a3+a7+a11...\n        =f00(w^{4x})+w^{2x}*f01(w^{4x})+w^x*f10(w^{4x})+w^3x*f11(w^{4x})\n        =a0+a4+a8+...,w^{2x}*(a2+a6+a10...),w^x*(a1+a5+a9+...),w^{3x}*(a3+a7+a11...)\n        f_s -> \u4e0b\u6807\u5c06 s \u53cd\u8fc7\u6765\u4e4b\u540e, a_i \u7684 i \u7684\u4e8c\u8fdb\u5236\u53cd\u8fc7\u6765\u4e0e s \u76f8\u540c\n                .\n                .\n                .\n        s\n        000 001 010 011 \n               |\u53cd\u8fc7\u6765\n               v\n        000 100 010 110\n        a0 a{k/2} a{3*k/4} a{k}\n        a0  a4  a2  a6\n    */\n    /*\n    void fft(cplx* f,const int len,const short opt=1){\n        if(!len)return;\n        cplx f0[len+5],f1[len+5];\n        for(int i=0;i<len;++i)\n            f0[i]=f[i<<1],f1[i]=f[i<<1|1];\n        fft(f0,len>>1,opt);\n        fft(f1,len>>1,opt);\n        cplx w=cplx(cos(Pi/len),opt*sin(Pi/len)),buf=cplx(1,0);\n        for(int i=0;i<len;++i,buf=buf*w){\n            f[i]=f0[i]+buf*f1[i];\n            f[i+len]=f0[i]-buf*f1[i];\n        }\n    }\n    */\n   inline void fft(cplx* f,const short opt=1){\n        for(int i=0;i<n;++i)if(i<revi[i])\n            swap(f[i],f[revi[i]]);\n        for(int p=2;p<=n;p<<=1){\n            //\u679a\u4e3e\u5c42\u6570\n            int len=p/2;//\u4e0a\u4e00\u5c42\u7684\u4e00\u534a\u7684\u957f\u5ea6\n            cplx tmp(cos(Pi/len),opt*sin(Pi/len));\n            //\u5355\u4f4d\u590d\u6839\n            for(int k=0;k<n;k+=p){\n                cplx buf(1,0);//\u8bb0\u5f55 omega \u7684\u6b21\u65b9\n                for(int l=k;l<k+len;++l,buf=buf*tmp){\n                //\u6bcf\u6b21 buf \u7d2f\u6210\u5355\u4f4d omega\n                    cplx tt=buf*f[len+l];\n                    f[len+l]=f[l]-tt;\n                    f[l]=f[l]+tt;\n                /*\n                    \u6b64\u5904\u4e0e\u9012\u5f52\u7248\u672c\u7684 FFT \u4e2d\u8fd9\u4e00\u6bb5\u662f\u4e00\u6837\u7684:\n                    f[i]=f0[i]+buf*f1[i];\n                    f[i+len]=f0[i]-buf*f1[i];\n                */\n                }\n            }\n        }\n        if(opt==-1)for(int i=0;i<n;++i)f[i]=f[i]/n;\n        //\u5982\u679c\u662f \u9006\u53d8\u6362 , \u90a3\u4e48\u9700\u8981\u5168\u90e8 /n\n   }\npublic:\n    inline void launch(){\n        qread(n,m);\n        rep(i,0,n)scanf(\"%lf\",&a[i].vr);\n        rep(i,0,m)scanf(\"%lf\",&b[i].vr);\n        for(m+=n,n=1;n<=m;n<<=1);\n        rep(i,0,n-1)revi[i]=(revi[i>>1]>>1)|((i&1)?n>>1:0);//\u5904\u7406\u53cd\u8f6c\n        fft(a);fft(b);\n        rep(i,0,n-1)a[i]=a[i]*b[i];\n        fft(a,-1);\n        rep(i,0,m)writc((int)(a[i].vr+0.5),' ');\n        Endl;\n    }\n}This;\n\nsigned main(){\n#ifdef FILEOI\n    freopen(\"file.in\",\"r\",stdin);\n    freopen(\"file.out\",\"w\",stdout);\n#endif\n    This.launch();\n    return 0;\n}\n```\n\n> \u5982\u679c\u6211\u53ef\u4ee5\u56de\u5230\u8fc7\u53bb\uff0c\u6211\u4e00\u5b9a\u4f1a\u53bb\u5f53\u6740\u624b\u3002\n>\n> \u4e3a\u4ec0\u4e48\uff1f\u56e0\u4e3a\u6211\u8981\u53bb\u5e72\u7ffb**\u6b27\u67d0**\u548c**\u5085\u67d0\u67d0**...\n\n## \u8fd8\u4f1a\u6709\u7684 NTT \u548c\u4e09\u6a21\u6570 NTT...",
        "postTime": 1576671207,
        "uid": 125355,
        "name": "Vladilena",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09\u3011"
    },
    {
        "content": "# NTT\n\nFFT\u5728\u6b63\u6574\u6570\u4e0b\u7684\u53d8\u6362\u53ef\u4ee5\u7528\u5feb\u901f\u6570\u8bba\u53d8\u6362\uff08NTT\uff09\u5b9e\u73b0\u3002\n\n\nNTT\u4e0eFFT\u4e0d\u540c\uff0c\u5229\u7528\u7684\u662f\u539f\u6839\u800c\u975e\u5355\u4f4d\u6839\u7684\u6027\u8d28\u3002\u8fd9\u6837\u53ef\u4ee5\u6709\u6548\u907f\u514d\u56e0\u4e3aFFT\u5b9e\u6570\u8fd0\u7b97\u8fdb\u884c\u7684\u7cbe\u5ea6\u8bef\u5dee\u3002\n\n\n\u5047\u8bbe\u5404\u4f4d\u9605\u8bfb\u7684\u5927\u795e\u5df2\u7ecf\u4f1aFFT\u4e86\u3002\u3002\u3002\u8fd9\u91cc\u5c31\u4e0d\u591a\u89e3\u91caFFT\u4e86\uff0c\u697c\u4e0b\u4e24\u4f4d\u795e\u725b\u89e3\u91ca\u5f97\u5f88\u660e\u767d\u3002\u8fd9\u91cc\u4e3b\u8981\u89e3\u91ca\u4e00\u4e0b\u539f\u6839\u7684\u4e00\u4e9b\u6027\u8d28\u3002\n\n\n\u8bbeg=3\uff0cp=998244353\n\n\ng\u662fp\u7684\u539f\u6839\uff0c\u90a3\u4e48\u6709\uff1a 3^998244352=1.\n\n\uff08\u5176\u5b9e\u8fd9\u6839\u672c\u4e0d\u662f\u539f\u6839\u72ec\u6709\u7684\u6027\u8d28\uff0c\u53ea\u4e0d\u8fc7\u662f\u5bf9\u4e8ew^(n)=1\u7684\u4e00\u4e2a\u5bf9\u7167\uff09\u3002\n\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u53c2\u8003\u590d\u5e73\u9762\u4e0a\u5355\u4f4d\u5706\u7684n\u7b49\u5206\uff0c\u5c06g^(p-1)n\u7b49\u5206\uff0c\uff08\u5f53\u7136\uff0cn\u5fc5\u987b\u662fp-1\u7684\u4e00\u4e2a\u56e0\u6570\uff0c\u8bben=2^k, \u5728k\u226420\u65f6\u5747\u80fd\u6210\u7acb\uff09\n\n\n\u90a3\u4e48\u5728DFT\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06w(n,k)\u53d8\u6210g^(\uff08p-1\uff09/n\u00d7k),IDFT \u65f6\u53d6\u5012\u6570\u5373\u53ef\n\n\n\u8fed\u4ee3\u64cd\u4f5c\u548c\u8774\u8776\u53d8\u6362\u540cFFT\u3002\u3002\u3002\n\n\n\u5570\u55e6\u4e86\u8fd9\u4e48\u591a\uff0c\u63a5\u4e0b\u6765\u662f\u4ee3\u7801\n\n\n    \n    \n```cpp\n    #include<algorithm>\n    #include<cctype>\n    #include<cmath>\n    #include<cstdio>\n    #include<cstdlib>\n    #include<cstring>\n    #include<iostream>\n    #include<map>\n    #include<queue>\n    #include<stack>\n    #include<vector>\n    #define size 5000010\n    #define debug(x) cerr<<#x<<\"=\"<<x\n    #define gc getchar()\n    #define db double\n    #define mod 998244353\n    #define ll long long\n    #define rep(i,s,n) for (register int i=s;i<=n;i++)\n    #define drep(i,n,s) for (register int i=n;i>=s;i--)\n    #define il inline\n    using namespace std;\n    il ll r()\n    {\n        char c; ll x,f=1;\n        for (c=gc;!isdigit(c);c=gc) if (c=='-') f=-1; x=c-'0';\n        for (c=gc;isdigit(c);c=gc) x=(x<<1)+(x<<3)+c-'0';\n        return f*x;\n    }\n```\nll a[size],b[size],c[size],A[size],l1,l2\uff1b\n    \n    \n        \n    \n    \n    \n    \n\n\n```cpp\n    ll rev[size],L,n,pow3[size],powinv[size];\n    il ll ksm(ll x,ll y)\n    {\n        ll res=1;\n        while (y)\n        {\n            if (y&1) res=res*x%mod;\n            x=x*x%mod;\n            y>>=1;\n        }\n        return res;\n    }\n    il void init(int tmp)\n    {\n        for (n=0,L=1;L<tmp;L<<=1) n++;\n        n++; L<<=1;\n        rep(i,0,L-1)\n        {\n            int t=i;\n            for(int j=0; j<n; j++) \n            {\n                rev[i]<<=1;rev[i]|=t&1;    t>>=1;\n            }\n        }\n        ll inv3=ksm(3,mod-2);\n        for (int i=1;i<=L;i<<=1) pow3[i]=ksm(3,(mod-1)/i)%mod;\n        for (int i=1;i<=L;i<<=1) powinv[i]=ksm(inv3,(mod-1)/i)%mod;\n    }\n    il void DFT(ll F[],ll sgn)\n    {\n        rep(i,0,L-1) A[i]=F[rev[i]];\n        rep(i,0,L-1) F[i]=A[i];\n        for (int i=2;i<=L;i<<=1)\n        {\n            ll wi=pow3[i]; if (sgn ==-1) wi=powinv[i];\n            for (int k=0;k<L;k+=i)\n            {\n                ll ww=1,x=0,y=0;\n                rep(j,0,i/2-1)\n                {\n                    x=F[k+j]%mod;\n                    y=ww*F[k+j+i/2]%mod;\n                    F[k+j]=(x+y)%mod;\n                    F[k+j+i/2]=(x-y+mod)%mod;\n                    ww=ww*wi%mod;\n                }\n            }\n        }\n        if (sgn==-1)\n        {\n            ll inv=ksm(L,mod-2);\n            rep(i,0,L-1) F[i]=(F[i]*inv)%mod;\n        }\n    }\n    il void NTT()\n    {\n        DFT(a,1);DFT(b,1);\n        rep(i,0,L-1) c[i]=(a[i]*b[i])%mod;\n        DFT(c,-1);    \n    }\n    int main()\n    {\n        scanf(\"%d%d\",&l1,&l2); \n        rep(i,0,l1) scanf(\"%lld\",&a[i]);\n        rep(i,0,l2) scanf(\"%lld\",&b[i]);\n        init(max(l1,l2)+1); NTT();\n        L=l1+l2+1;\n        rep(i,0,L-1) printf(\"%lld \",c[i]);\n        return 0;\n    }\n\n```",
        "postTime": 1512908861,
        "uid": 44273,
        "name": "\u786b\u4ee3\u786b\u9178\u94a0",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3803"
    },
    {
        "content": "**\u9707\u60ca**\n\n\u8c03\u8bd5\u4e24\u5929\u8c03\u4e0d\u5bf9\u7684\u539f\u56e0\u7adf\u662finline int pls();\u6253\u9519\n\n\u8eab\u8d25\u540d\u88c2\n\n\n------------\n\n\nntt\u51e0\u4e4e\u548cfft\u4e00\u6837 \u53ea\u662f\u628a\u5355\u4f4d\u6839\u6362\u6210\u4e86\u539f\u6839\n\n**ntt\u6ca1\u6709\u7cbe\u5ea6\u95ee\u9898**\n\n\u4e22\u4e24\u4e2a\u4e0d\u9519\u7684blog\n\n\nhttps://riteme.github.io/blog/2016-8-22/ntt.html\n\nhttp://blog.csdn.net/acdreamers/article/details/39026505\n\nhttp://blog.miskcoo.com/2015/04/polynomial-multiplication-and-fast-fourier-transform\n\n------------\n\n\n\u636e\u8bf4%\u6bd4\u8f83\u6162 \u4f46\u5b9e\u6d4bntt\u6bd4fft\u5feb \\\u5947\u602a\n\n\n------------\n\n\u5f53\u9898\u4e2d\u7ed9\u4e86\u6a21\u6570\u6216\u662f\u8ba1\u7b97\u7ed3\u679c\u7cfb\u6570\u4e0d\u4f1a\u5927\u4e8e\u6a21\u6570p\u65f6\u53ef\u7528ntt\u89e3\u591a\u9879\u5f0f\u4e58\u6cd5\u95ee\u9898\n\n\u5982\u7ed3\u679c\u53ef\u80fd\u4e3a\u8d1f\n\n\u9700\u8981\u8fd9\u6837\u8f93\u51fa\n\n```cpp \nprintf(\"%d \",A[i]>=p/2?A[i]-p:A[i]) ;\n```\n\u4f46\u662f\u8fd9\u91cc\u4e0d\u7528\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\nusing namespace std;\nconst int N=3e6,p=998244353,g=3,gi=332748118;\ntypedef long long LL;\nint ans;\ninline int pls(int x,int y){x+=y;return x>=p?x-p:x;}\ninline int dec(int x,int y){x-=y;return x<0?x+p:x;}\ninline int mul(int x,int y){return (LL)x*y%p;}\ninline int pow(int x,int y)\n{\n    for (ans=1; y; y>>=1,x=mul(x,x)) \n        if (y&1)ans=mul(ans,x);\n    return ans;\n}\n\nint A[N],B[N];\nint n,m,l,r[N],inv;\n\nvoid ntt(int *a,int f)\n{\n    for (register int i=0; i<n; ++i) if (i<r[i]) swap(a[i],a[r[i]]);\n    for (register int i=1; i<n; i<<=1)\n    {\n        register int wn=pow((f==1)?g:gi,(p-1)/(i<<1));\n        for (register int j=0; j<n; j+=(i<<1))\n        {\n            int w=1;\n            for (register int k=0; k<i; ++k,w=mul(w,wn))\n            {\n                register int x=a[j+k],y=mul(w,a[i+j+k]);\n                a[j+k]=pls(x,y),a[j+k+i]=dec(x,y);\n            }\n        }\n    }\n    if (f==-1) for (register int i=0; i<n; ++i) a[i]=mul(a[i],inv);\n}\n\nint main()\n{\n    scanf(\"%d%d\",&n,&m);\n    for (register int i=0; i<=n; ++i) scanf(\"%d\",&A[i]),A[i]=dec(A[i],0);\n    for (register int i=0; i<=m; ++i) scanf(\"%d\",&B[i]),B[i]=dec(B[i],0);\n    m+=n;\n    for (n=1; n<=m; n<<=1) l++;\n    inv=pow(n,p-2);\n    for (register int i=0; i<n; ++i) r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n    ntt(A,1);\n    ntt(B,1);\n    for (register int i=0; i<n; ++i) A[i]=mul(A[i],B[i]);\n    ntt(A,-1);\n    for (register int i=0; i<=m; ++i) printf(\"%d \",A[i]);\n    return 0;\n}\n\n```\n\n------------\n",
        "postTime": 1512783343,
        "uid": 50763,
        "name": "wcwac",
        "ccfLevel": 0,
        "title": "NTT"
    },
    {
        "content": "(http://www.elijahqi.win/2018/02/04/uoj34-%E5%A4%9A%E9%A1%B9%E5%BC%8F%E4%B9%98%E6%B3%95-fft%E6%9D%BF%E5%AD%90%E7%9E%8E%E6%90%9E%E5%AD%A6%E4%B9%A0xx%E8%A2%AB%E8%99%90%E8%AE%B0/)\nhttp://blog.csdn.net/elijahqi/article/details/79249340\n\nfft\n\u849f\u84bb\u6211\u6682\u65f6\u53ea\u4f1a\u641e\u591a\u9879\u5f0f\u4e58\u6cd5\uff1f\nn-1\u6b21\u591a\u9879\u5f0fA(x)\u4e0em-1\u6b21\u591a\u9879\u5f0fB(x)\u76f8\u4e58\u83b7\u5f97l=n+m-1\u6b21\u591a\u9879\u5f0fc(x) \u76f4\u63a5\u6734\u7d20\u505a\u662fn*m\u7684\u590d\u6742\u5ea6 \u5bf9\u4e8e\u8fd9\u9898 \u663e\u7136\u4e0d\u53ef\u505a \u8003\u8651\u65b0\u5b66\u4e00\u79cd\u7b97\u6cd5fft\n\nC(x)=A(x)*B(x)\n$Ci= \\sum_{p=0}^{n-1}\\sum_{q=0}^{m-1}[p+q==i] A_{p}*B_{q}$\n $Ci= \\sum_{p=0}^{n-1}\\sum_{q=0}^{m-1}[p+q\\equiv i (mod\\ l)] A_{p}*B_{q}$\n \n \u5df2\u77e5\u4e00\u4e2a\u5f0f\u5b50 \u5bf9\u4e8e\u4efb\u610fv\u5747\u6ee1\u8db3 \n \u5982\u679c\u9700\u8981\u77e5\u9053\u8fd9\u4e2a\u5f0f\u5b50\u9996\u5148\u9700\u8981\u77e5\u9053\u590d\u6570\u7684\u5e94\u7528 \u4f8b\u5982\u6b27\u62c9\u516c\u5f0f$e^{i\\pi}=1$\n \n $\\omega_l$\u8868\u793al\u6b21\u5355\u4f4d\u590d\u6570\u6839\n \n $[v\\equiv 0(mod\\ l)]=\\frac{1}{l}*\\sum_{k=0}^{l-1}\\omega^{v*k}_{l}$\n \u5bf9\u4e8e$v\\equiv 0(mod\\ l)$ \u663e\u7136\u53ef\u4ee5\u77e5\u9053 \u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5 \u662f\u6210\u7acb\u7684 \n \n \u5bf9\u4e8e$v \\not \\equiv 0(mod\\ l)$\u7684\u60c5\u51b5 \u53ef\u4ee5\u77e5\u9053 \u5bf9\u4e8e\u539f\u5f0f\u662f\n $\\frac{1}{l}*\\sum_{i=0}^{l-1} \\omega_{l}^{i*v}$ \u5bf9\u4e8e\u8fd9\u4e2a$\\sum$\u6211\u53ef\u4ee5\u8003\u8651\u7b49\u6bd4\u6570\u5217\u641e\u51fa \u5316\u7b80\u4e4b\u540e\u5c31\u662f$\\frac{1-\\omega_{l}^{l*v}}{1-\\omega_{l}^{v}}=0$\u6240\u4ee5\u53ef\u4ee5\u8bc1\u660e\u8fd9\u4e2a\u5f0f\u5b50\u6210\u7acb\n \u5e26\u5165\u539f\u59cb\u5f0f\u5b50$Ci= \\sum_{p=0}^{n-1}\\sum_{q=0}^{m-1}[p+q-i\\equiv 0 (mod\\ l)] A_{p}*B_{q}$\n $Ci= \\sum_{p=0}^{n-1}\\sum_{q=0}^{m-1}(\\frac{1}{l}*\\sum_{k=0}^{l-1}\\omega^{(p+q-i)*k}_{l})A_{p}*B_{q}$\n \n \u4ea4\u6362\u679a\u4e3e\u5bf9\u8c61\n  $Ci= \\frac{1}{l}*\\sum_{k=0}^{l-1}\\omega^{-i*k}_{l} (\\sum_{p=0}^{n-1}\\omega^{p*k}_{l}A_{p})*(\\sum_{q=0}^{m-1}\\omega^{q*k}*B_{q})$\n \u6839\u636e\u591a\u9879\u5f0f\u5b9a\u4e49\u540e\u9762\u7684\u4e24\u90e8\u5206\u53ef\u4ee5\u5206\u522b\u8868\u793a\u4e3a\n $\\sum_{p=0}^{n-1}\\omega^{p*k}_{l}A_{p}=A[\\omega^{k}_{l}]$\n B\u540c\u7406\n \u6240\u4ee5$ci=\\frac{1}{l}*\\sum_{k=0}^{l-1}\\omega^{-i*k}_{l} *A[\\omega^{k}_{l}]*B[\\omega^{k}_{l}]$\n \u8bbe$dk=A[\\omega^{k}_{l}]*B[\\omega^{k}_{l}]$ \u663e\u7136\u5982\u679c\u6211\u6709\u529e\u6cd5\u5feb\u901f\u6c42\u51faA\u7684\u6240\u6709\u70b9\u503c\u90a3\u6211\u53ef\u4ee5\u91c7\u53d6\u540c\u6837\u7684\u65b9\u6cd5\u5feb\u901f\u6c42\u51fa\u6bcf\u4e2adk\u7684\u503c \u76f8\u5f53\u4e8e\u53ea\u662f  \u5e26\u5165\u7684\u503c\u53d8\u5316\u4e86 \u5982\u4f55\u5feb\u901f\u7403\u503c\u8fd9\u5c31\u9700\u8981\u6211\u4eec\u9009\u53d6\u7684\u8fd9\u4e2a\u503c\u5373\u53ef \u6ce8\u610f\u6211\u4eec\u9009\u62e92^n\u6b21\u590d\u6570\u6839J\u5373\u5c06n,m\u540c\u65f6\u6269\u5927\u5230\u548c\u4ed6\u4eec\u6700\u8fd1\u7684\u4e00\u4e2a2^n\u6b21\u5e42\u7684\u5730\u65b9\n \u5982\u4f55\u5feb\u901f\u6c42\u51faA[x]\u5373 $\\sum_{i=0}^{n-1} x^{i}*a_{i}$\n \u663e\u7136\u6211\u53ef\u4ee5\u9488\u5bf9\u4e0b\u6807\u5212\u5206\u6210\u5947\u5076\u4e24\u79cd\u5f62\u5f0f \u8bbeA0\u8868\u793a\u5076\u6570\u6b21\u7684\u9879 A1\u8868\u793a\u5947\u6570\u6b21\u7684\u9879 $A0(x)=\\sum_{i=0,i+=2}^{n-1}x^{i}*a_{i}$\n $A0(x)=\\sum_{i=0}^{\\left\\lfloor\\frac{n-1}{2}\\right\\rfloor}x^{2i}*a_{2i}$\n \u8bbe$di=a_{2i}$\u90a3\u4e48\u53ef\u4ee5\u8868\u793a\u6210\u8bbe$D(x)=\\sum_{i=0}^{\\left\\lfloor\\frac{n-1}{2}\\right\\rfloor}x^{i}*d_{i}$\n\u90a3\u4e48\u663e\u7136\u53ef\u4ee5\u77e5\u9053$A0(x)=D(x)^{2}$\n\u540c\u7406\u6211\u4eec\u53bb\u641e\u4e00\u4e0b\u5947\u6570\u6b21\u7684\u9879\n$A1(x)=\\sum_{i=0,i+=2}^{n-1}x^{i}*a_{i}$\n $A1(x)=x*\\sum_{i=0}^{\\left\\lfloor\\frac{n-1}{2}\\right\\rfloor}x^{2i}*a_{2i+1}$\n \u8bbe$ei=a_{2i+1}$\n$E(x)=\\sum_{i=0}^{\\left\\lfloor\\frac{n-1}{2}\\right\\rfloor}x^{i}*e_{2i}$\n$A1(x)=x*E(x^{2})$\n\u6240\u4ee5$A(x)=A1(x)+A0(x)$\n\u5f53k<$\\frac{l}{2}$\n$A(\\omega_{l}^{k})=A0(\\omega_{l}^{k})+A1(\\omega_{l}^{k})$\n$A(\\omega_{l}^{k})=D(\\omega_{l}^{2k})+\\omega_{l}^{k}*E(\\omega_{l}^{2k})$\n$A(\\omega_{l}^{k})=D(\\omega_{\\frac{2}{l}}^{k})+\\omega_{l}^{k}*E(\\omega_{\\frac{2}{l}}^{k})$\n\u540c\u7406\u83b7\u5f97\u5f53$k>=\\frac{l}{2}$\u6b64\u65f6\u8bbe\u5b9a$k=k-\\frac{l}{2}$\n$A(\\omega_{l}^{k+\\frac{l}{2}})=D(\\omega_{l}^{2k+l})+\\omega_{l}^{k+\\frac{l}{2}}*E(\\omega_{l}^{2k+l})$\n\u6b64\u65f6\u548c\u4e0a\u9762\u76f8\u540c\u53ea\u4e0d\u8fc7$\\omega_{l}^{\\frac{l}{2}}$\u662f-1\u6240\u4ee5\u8981\u6ce8\u610f\u8d1f\u53f7\n\n\u9012\u5f52\u7248\n```\n#include<cmath>\n#include<cstdio>\n#include<complex>\n#define C complex<double>\n#define N 300000\n#define pi acos(-1)\nusing namespace std;\ninline char gc(){\n\tstatic char now[1<<16],*S,*T;\n\tif (T==S){T=(S=now)+fread(now,1,1<<16,stdin);if (T==S) return EOF;}\n\treturn *S++;\n}\ninline int read(){\n\tint x=0,f=1;char ch=gc();\n\twhile(ch<'0'||ch>'9') {if(ch=='-') f=-1;ch=gc();}\n\twhile(ch<='9'&&ch>='0') x=x*10+ch-'0',ch=gc();\n\treturn x*f;\n}\nC a[N],b[N];\nint n,m;\ninline void fft(C *x,int n,int f){\n\tif (n==1) return;C l[n>>1],r[n>>1];\n\tfor (int i=0;i<n;i+=2) l[i>>1]=x[i],r[i>>1]=x[i+1];\n\tfft(l,n>>1,f);fft(r,n>>1,f);int nn=n>>1;\n\tC wn(cos(2*pi/n),f*sin(2*pi/n)),w(1,0),t;\n\tfor (int i=0;i<nn;++i,w*=wn)\n\t\tt=w*r[i],x[i]=l[i]+t,x[i+nn]=l[i]-t;\n}\nint main(){\n\tfreopen(\"uoj34.in\",\"r\",stdin);\n\tn=read();m=read();\n\tfor (int i=0;i<=n;++i) a[i]=read();\n\tfor (int i=0;i<=m;++i) b[i]=read();\n\tm=n+m;for (n=1;n<=m;n<<=1) ;\n\tfft(a,n,1);fft(b,n,1);\n\tfor (int i=0;i<=n;++i) a[i]*=b[i];\n\tfft(a,n,-1);\n\tfor (int i=0;i<=m;++i) printf(\"%d \",int(a[i].real()/n+0.5)); \n\treturn 0;\n}\n```\n\u8fed\u4ee3\u7248\n\u9884\u5904\u7406\u51fa\u6211\u7684\u53d8\u6362\u987a\u5e8f \u8fd9\u4e2aR\u662f\u600e\u4e48\u5f97\u5230\u7684 \u6709\u70b9dp\u601d\u60f3 \u5c31\u662f1~i-1\u7684\u5df2\u7ecf\u641e\u597d\u4e86\u90a3\u4e48\u6211\u73b0\u5728\u76f8\u5f53\u4e8e\u7b2ci\u4f4d\u4e0d\u597d \u6240\u4ee5\u628a\u4ed6\u53d6\u51fa\u6765 \u7136\u540e\u586b\u5230\u7b2c\u4e00\u4f4d\u4e0a\u5373\u53ef\n```\n\n #include<cmath>\n#include<cstdio>\n#include<complex>\n#include<algorithm>\n#define N 3000000\n#define pi acos(-1)\n#define C complex<double>\nusing namespace std;\ninline char gc(){\n\tstatic char now[1<<16],*S,*T;\n\tif (T==S){T=(S=now)+fread(now,1,1<<16,stdin);if (T==S) return EOF;}\n\treturn *S++;\n}\ninline int read(){\n\tint x=0,f=1;char ch=gc();\n\twhile(ch<'0'||ch>'9') {if (ch=='-') f=-1;ch=gc();}\n\twhile(ch<='9'&&ch>='0') x=x*10+ch-'0',ch=gc();\n\treturn x*f;\n}\nC a[N],b[N];\nint n,m,R[N];\ninline void fft(C *x,int f){\n\tfor (int i=0;i<n;++i) if (i<R[i]) swap(x[i],x[R[i]]);\n\tfor (int i=1;i<n;i<<=1){\n\t\tC wn(cos(pi/i),f*sin(pi/i));\n\t\tfor (int j=0;j<n;j+=i<<1){\n\t\t\tC w(1,0),t1,t2;\n\t\t\tfor (int k=0;k<i;++k,w*=wn)\n\t\t\t\tt1=x[j+k],t2=x[j+k+i]*w,x[k+j]=t1+t2,x[k+j+i]=t1-t2;\n\t\t}\n\t}\n}\nint main(){\n\t\n\tn=read();m=read();\n\tfor (int i=0;i<=n;++i) a[i]=read();\n\tfor (int i=0;i<=m;++i) b[i]=read();\n\tm=n+m;for (n=1;n<=m;n<<=1);int l=log2(n);\n\tfor (int i=1;i<n;++i) R[i]=R[i>>1]>>1|(i&1)<<l-1;\n\t//for (int i=0;i<8;++i) printf(\"%d \",R[i]);puts(\"\");\n\tfft(a,1);fft(b,1);for (int i=0;i<n;++i) a[i]*=b[i];\n\tfft(a,-1);for (int i=0;i<=m;++i) printf(\"%d \",(int)(a[i].real()/n+0.5));\n\treturn 0;\n}\n```\n\n",
        "postTime": 1517760535,
        "uid": 5037,
        "name": "elijahqi",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09\u3011"
    },
    {
        "content": "FFT\u662f\u5e72\u5565\u7684\u9898\u76ee\u5df2\u7ecf\u544a\u8bc9\u4f60\u4e86\uff0c\u591a\u9879\u5f0f\u4e58\u6cd5\u5176\u5b9e\u5c31\u662f\u7cfb\u6570\u7684\u4e58\u6cd5\uff0c\u4f46\u662f\u4f20\u7edf\u7684\u7cfb\u6570\u8868\u8fbe\u6cd5\u5e76\u4e0d\u9002\u5408\u4e58\u6cd5\uff0c\u6240\u4ee5\u9700\u8981\u6362\u6210\u70b9\u503c\u8868\u8fbe\u6cd5\uff0c\u4f46\u662f\u70b9\u503c\u8868\u8fbe\u6cd5~~\u53c8\u4e0d\u662f\u4eba\u770b\u7684~~\uff0c\u6240\u4ee5\uff0c\u5728\u7528\u70b9\u503c\u8868\u8fbe\u6cd5\u8ba1\u7b97\u4e4b\u540e\u8fd8\u8981\u5207\u56de\u6765\u3002\n\n\u4e00\u4e2an\u6b21\u591a\u9879\u5f0f\u53ef\u4ee5\u7531n+1\u4e2a\u70b9\u503c\u786e\u5b9a\uff0c\u4f8b\u5982\u4e24\u70b9\u786e\u5b9a\u4e00\u6761\u76f4\u7ebf\uff0c\u4e09\u70b9\u786e\u5b9a\u4e00\u4e2a\u4e8c\u6b21\u51fd\u6570\u3002\u5047\u8bbe\u6211\u4eec\u6709\u591a\u9879\u5f0fA\uff0c B\uff0c \u7ed3\u679c\u4e3a\u591a\u9879\u5f0fC\uff0c\u90a3\u4e48\u6211\u4eec\u901a\u8fc7DFT\u5c06\u7531\u7cfb\u6570\u8868\u8fbe\u5f0f\u786e\u5b9a\u7684A\uff0cB\u5206\u522b\u8f6c\u6362\u4e3a\u70b9\u503c\u8868\u8fbe\u5f0f\u4ee5\u540e\uff0c\u53ef\u4ee5\u5f97\u5230C\u7684\u70b9\u503c\u8868\u8fbe\u5f0f\u4ee5\u540e\uff0c\u901a\u8fc7IDFT\u53ef\u4ee5\u5f97\u5230C\u7684\u7cfb\u6570\u8868\u8fbe\u5f0f\u3002\n\n\u6709\u5173FFT\u7684\u590d\u6570\u77e5\u8bc6\u5c31\u501f\u7528\u4e00\u4e0bdalao\u7684~~\u7406\u7531\u540c\u697c\u4e0b\u8ddd\u79bb\u4e24\u7bc7\u9898\u89e3~~\n\nhttp://blog.csdn.net/ypxrain/article/details/54766702\n\n\u5c0f\u7ec6\u8282\uff1a\n\n1.\u8303\u56f4\u9700\u8981\u5f00\u52302\u7684\u6b21\u5e42\u4ee5\u4e0a\uff0c\u4e0d\u662f\u4e24\u500d\n\n2.\u591a\u6b21\u6c42FFT\u65f6\u9700\u8981\u6ce8\u610f\u521d\u59cb\u5316\u7684\u4f4d\u7f6e\n\n3.\u6570\u636e\u91cf\u8f83\u5927\u65f6\u6ce8\u610f\u7cbe\u5ea6\u95ee\u9898\uff0c\u4e0d\u80fd\u9884\u5904\u7406\u03c9\n\n4.\u6700\u540e\u7b54\u6848\u9700\u8981\u9664\u4ee5n\uff08\u8fd9\u4e2an\u5728\u4ee3\u7801\u4e2d\u5e94\u8be5\u662f2 \\* T\uff09\n\n5.\u6700\u540e\u7ed3\u679c\u5c0f\u6570\u70b9\u540e\u8981\u56db\u820d\u4e94\u5165\n\n~~6.\u628a\u03c0\u624b\u5199\u6bd4\u7528\u51fd\u6570\u5feb\u5f88\u591a~~\n\n    \n    \n    \n    \n    \n```cpp\n    #include <bits/stdc++.h>\n    using namespace std;\n    const double pi = 3.141592653589793238462643387;\n    const int MAXN = 5000003;\n    struct comp {\n        double x, y;\n        comp(double _x = 0, double _y = 0):x(_x), y(_y) {}\n        comp operator + (const comp& a) const { return comp(x + a.x, y + a.y); }\n        comp operator - (const comp& a) const { return comp(x - a.x, y - a.y); }\n        comp operator * (const comp& a) const { return comp(x * a.x - y * a.y, x * a.y + y * a.x); }\n    };\n    int rev[MAXN], T;\n    comp Sin[MAXN], tmp;\n    void fft(comp *a) {\n        for(int i = 1; i < T; i++) if(rev[i] > i) swap(a[rev[i]], a[i]);\n        for(int i = 2, mid = 1, s = (T >> 1); i <= T; mid = i, i <<= 1, s >>= 1) {\n            for(int j = 0; j < T; j += i) {\n                for(int k = j, cur = 0; k < j + mid; k++, cur += s) {\n                    tmp = a[k + mid] * Sin[cur];\n                    a[k + mid] = a[k] - tmp;\n                    a[k] = a[k] + tmp;\n                }\n            }\n        }\n    }\n    comp A[MAXN];\n    int n, m;\n    inline void init() {\n        for(T = 1; T <= n + m; T <<= 1);\n        for(int i = 1; i < T; i++) {\n            if(i & 1) rev[i] = (rev[i >> 1] >> 1) ^ (T >> 1);\n            else rev[i] = rev[i >> 1] >> 1;\n        }\n        Sin[0] = comp(1, 0); Sin[1] = comp(cos(2 * pi / T), sin(2 * pi / T));\n        for(int i = 2; i < (T >> 1); i++) Sin[i] = Sin[i - 1] * Sin[1];\n    }\n    int main() {\n        scanf(\"%d%d\", &n, &m);\n        for(int i = 0; i <= n; i++) scanf(\"%lf\", &A[i].x);\n        for(int i = 0; i <= m; i++) scanf(\"%lf\", &A[i].y);\n        init();\n        fft(A);\n        for(int i = 0; i < T; i++) A[i] = A[i] * A[i];\n        for(int i = 0; i < (T >> 1); i++) Sin[i].y = -Sin[i].y;\n        fft(A);\n        for(int i = 0; i <= n + m; i++) printf(\"%d%c\", (int)(A[i].y / T / 2 + 0.5), i == n + m ? '\\n' : ' ');\n        return 0;\n    }\n\n```",
        "postTime": 1514040977,
        "uid": 34332,
        "name": "KKarshilov",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09\u3011"
    },
    {
        "content": "\u6240\u8c13fft\uff0c\u53ea\u662f\u4e00\u79cd\u5feb\u901f\u7684\u63d2\u503c\u6280\u672f\uff0c\u6211\u4eec\u77e5\u9053\uff0c\u6734\u7d20\u7684\u591a\u9879\u5f0f\u4e58\u6cd5\u662fN^2\u7684\u3002\u6211\u4eec\u53c8\u77e5\u9053\uff0c\u4e00\u4e2a\u591a\u9879\u5f0f\u53ef\u4ee5\u7531N\u4e2a\u7684\u70b9\u503c\u6765\u8868\u793a\u3002\u90a3\u4e48N\u4e2a\u70b9\u76f8\u4e58\uff0c\u53ef\u4ee5\u5728O\uff08N\uff09\u5185\u5f97\u51fa\uff0cfft\u6240\u63d0\u4f9b\u7684\uff0c\u53ea\u662f\u5feb\u901f\u63d2\u503c\u548c\u6c42\u7cfb\u6570\u800c\u5df2\u3002\n\n\u6211\u4eec\u77e5\u9053 \u6b27\u62c9\u5b9a\u7406\uff0c e\u7684\u590d\u6570\u6b21\u5e42\u6ee1\u8db3\u5f88\u591a\u4f18\u79c0\u7684\u6027\u8d28\uff0c\u6211\u4eec\u7528\u8fd9\u4e9b\u6027\u8d28\u5feb\u901f\u6c42\u503c\u5373\u53ef\u3002\n\nhttp://www.gatevin.moe/acm/fft%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/\n\n\uff08\u7531\u4e8e\u6253\u4e0d\u51fa\u6570\u5b66\u516c\u5f0f\uff0c\u5c31\u7528\u4e0b\u5927\u4f6c\u7684\u5427\uff09\n\n```cpp\n#include<bits/stdc++.h>\n#define db double\n#define fo(i,a,b) for(int i=a;i<=b;i++)\n#define pi acos(-1)\n#define N 3378123\n#define com rrsb\nusing namespace std;\nstruct com{  //\u5b9a\u4e49\u590d\u6570\n    db r,i;\n    com(){}\n    com(db a,db b):r(a),i(b){}\n};\ninline com operator + (const com A,const com B) {\n        return com(A.r+B.r,A.i+B.i);\n    }\ninline com operator - (const com A,const com B) {\n        return com(A.r-B.r,A.i-B.i);\n    }\ninline com operator * (const com A,const com B) {\n        return com(A.r*B.r-A.i*B.i,A.i*B.r+A.r*B.i);\n    }\ncom a[N],b[N],X,Y;\nint c[N],R[N],n,m,L;\nchar ch[N];\nbool bo;\ninline int read(){\n    int f=1,x=0;char ch;\n    do{ch=getchar();if(ch=='-')f=-1;}while(ch<'0'||ch>'9');\n    do{x=x*10+ch-'0';ch=getchar();}while(ch>='0'&&ch<='9');\n    return f*x;\n}\ninline void fft(com *a,int x){\n    fo(i,0,n-1) if(i < R[i]) swap(a[i],a[R[i]]);\n    for (int i=1;i<n;i<<=1)// \u6ce8\u610f\u8fd9\u91cc\u7684n\u4e0d\u662f\u8f93\u5165\u7684n\n     { com wn(cos(pi/i),x*sin(pi/i));  //wn\u4e3a\u65cb\u8f6c\u56e0\u5b50\n      for (int j=0;j<n;j+=(i<<1)){//\u8774\u8776\u64cd\u4f5c\u51cf\u5c0f\u5e38\u719f\n          com w(1,0);\n           for (int k=0;k<i;k++,w=w*wn) {\n               X=a[j+k]; Y=w*a[j+k+i];\n               a[j+k]=X+Y; a[i+j+k]=X-Y;\n           }\n      }\n    }\n    if (x==-1) fo(i,0,n-1) a[i].r=a[i].r/n;// \u6c42\u7cfb\u6570\u8981\u9664n\n}\nint main () {\n    //0freopen(\"a.in\",\"r\",stdin);\n    n=read();m=read();\n    for(int i=0;i<=n;i++)a[i].r=read();\n    for(int i=0;i<=m;i++)b[i].r=read(); m+=n;\n    for(n = 1;n <= m ;n <<= 1) ++L;// get size \n    fo(i,0,n-1) R[i] = (R[i>>1]>>1)|((i&1)<<(L-1));// \u4e8c\u8fdb\u5236\u4e0b\u5c06\u4f4d\u7ffb\u8f6c\n    fft(a,1); fft(b,1);//\u6c42\u70b9\u503c\n    fo(i,0,n) a[i]=a[i]*b[i];//\u70b9\u4e58\n    fft(a,-1);//\u6c42\u7cfb\u6570\n    fo(i,0,m) c[i]=(int)(a[i].r+0.5);\n    fo(i,0,m) printf(\"%d \",c[i]);\n    return 0;\n}\n\n```",
        "postTime": 1508574174,
        "uid": 53193,
        "name": "\u6b87\u96ea",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09\u3011"
    },
    {
        "content": "\u7b97\u5bfc\u4e0a\u90fd\u6709\uff0c\u539f\u7406\u63a8\u5bfc\u8bc1\u660e\u8bb2\u7684\u5f88\u6e05\u695a\u4e86\u3002\n\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\nusing namespace std;\ninline int read(){int x=0,f=1,ch=getchar(); while(ch<'0'||ch>'9'){if(ch=='-') f=-1; ch=getchar();} while(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();} return x*f;}\ninline void write(int x){if (x<0) putchar('-'),x=-x; if (x>=10) write(x/10); putchar(x%10+'0');}\ninline void writeln(int x){write(x); puts(\"\");}\nconst int N=2100000;\nconst double pi=acos(-1.0);\nstruct complex{\n\tdouble x,y;\n\tcomplex (double xx=0,double yy=0) {x=xx; y=yy;}\n}a[N],b[N];\ninline complex operator +(complex A,complex B){return complex(A.x+B.x,A.y+B.y);}\ninline complex operator -(complex A,complex B){return complex(A.x-B.x,A.y-B.y);}\ninline complex operator *(complex A,complex B){return complex(A.x*B.x-A.y*B.y,A.x*B.y+A.y*B.x);}\nint n,m,l,lim,r[N];\ninline void init(){\n\tn=read(); m=read(); lim=1;\n\tfor (int i=0;i<=n;i++) a[i].x=read();\n\tfor (int i=0;i<=m;i++) b[i].x=read();\n\twhile (lim<=n+m) lim<<=1,l++;\n\tfor (int i=0;i<lim;i++) r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n}\nvoid DFT(complex *A,int opt){\n\tfor (int i=0;i<lim;i++) if (i<r[i]) swap(A[i],A[r[i]]);\n\tfor (int s=1;s<lim;s<<=1){\n\t\tcomplex Wn(cos(pi/s),opt*sin(pi/s));\n\t\tfor (int i=0;i<lim;i+=s<<1){\n\t\t\tcomplex w(1,0);\n\t\t\tfor (int j=0;j<s;j++,w=w*Wn){\n\t\t\t\tcomplex x=A[i+j],y=w*A[i+s+j];\n\t\t\t\tA[i+j]=x+y; A[i+s+j]=x-y;\n\t\t\t}\n\t\t}\n\t}\n}\ninline void solve(){\n\tDFT(a,1); DFT(b,1);\n\tfor (int i=0;i<=lim;i++) a[i]=a[i]*b[i];\n\tDFT(a,-1);\n\tfor (int i=0;i<=n+m;i++) write(int(a[i].x/lim+0.5)),putchar(' ');\n}\nint main(){\n\tinit(); solve();\n\treturn 0;\n} \n```",
        "postTime": 1544973707,
        "uid": 34444,
        "name": "\u5927\u83dc\u9e21fks",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3803 \u3010\u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09\u3011"
    }
]
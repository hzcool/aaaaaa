[
    {
        "content": "dis(a,b)=a\\*b/(gcd(a,b)^2)\u7684\u8d28\u56e0\u6570\u4e2a\u6570\n\n\u9884\u5904\u7406\u6bcf\u4e2a\u6570\u7684\u8d28\u56e0\u6570\u4e2a\u6570num\u3002\n\n\u8003\u8651\u679a\u4e3egcd\u3002\n\n\u4e5f\u5c31\u662f\u679a\u4e3ex,\u5bf9\u4e8ex\uff0c\u679a\u4e3e\u6240\u6709x\u7684\u500d\u6570a\u3002\n\n\u90a3\u4e48dis(a,b)=num(a)+num(b)-2\\*num(x)\n\n\u90a3\u4e48\u5bf9\u4e8e\u6bcf\u4e2aa,\u9009\u62e9\u7684b\u5c31\u5e94\u8be5\u662f\u6700\u5c0f\u7684\u90a3\u4e00\u4e2a\u3002\n\n\u6211\u4eec\u6c42\u51fanum\u6700\u5c0f\u7684\uff0c\u5bf9\u4e8e\u975e\u6700\u5c0f\u7528\u5b83\u66f4\u65b0\u7b54\u6848\uff0c\u540c\u65f6\u66f4\u65b0\u6700\u5c0f\u7b54\u6848\u3002\n\n\u8fd9\u6837\u867d\u7136\u4e0d\u80fd\u4fdd\u8bc1x\u662fa,b\u7684gcd\uff0c\u4f46\u662fa,b\u7684gcd\u4e00\u5b9a\u4f1a\u88ab\u679a\u4e3e\u5230\uff0c\u6240\u4ee5\u7b54\u6848\u4e00\u5b9a\u4f1a\u88ab\u66f4\u65b0\u6210\u6700\u4f18\u7684\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing std::swap; \n\n#define U 1000000\n#define N 100100\nint num[U+5],t[U+5];\nvoid init_num()\n{\n    static int p[N],top;\n    for (int i=2;i<=U;++i)\n    {\n      if (!num[i])\n      {\n           p[++top]=i;\n           num[i]=1;\n      }\n      int x;\n      for (int j=1;(x=p[j])*i<=U;++j)\n      {\n            num[x*i]=num[i]+1;\n          if (!(i%x)) break;     \n      }\n    }\n}\n\nint a[N],next[N];\nint ansj[N],ans[N];\nint q[N],top;\n\nint main()\n{\n    freopen(\"1.in\",\"r\",stdin);\n    init_num();\n    int n,i;\n    scanf(\"%d\",&n); \n    for (i=1;i<=n;++i) \n    {scanf(\"%d\",a+i);ans[i]=U;\n     next[i]=t[a[i]];t[a[i]]=i;\n    }\n    int x,j;\n    for (x=1;x<=U;++x)\n    {\n        top=0;\n        for (i=1;i<=U/x;++i)\n         for (j=t[x*i];j;j=next[j]) q[++top]=j;\n        int b=q[1];\n        for (i=2;i<=top;++i)\n        if (num[a[q[i]]]<num[a[b]]||num[a[q[i]]]==num[a[b]]&&q[i]<b) swap(b,q[i]);\n        for (i=2;i<=top;++i)\n        {\n            int A=q[i],now=num[a[A]]+num[a[b]]-(num[x]<<1);\n            if (now<ans[A]||now==ans[A]&&b<ansj[A]) \n            {\n                ans[A]=now;ansj[A]=b;\n            }\n            if (now<ans[b]||now==ans[b]&&A<ansj[b]) \n            {\n                ans[b]=now;ansj[b]=A;\n            }\n        }\n    }\n    for (i=1;i<=n;++i) printf(\"%d\\n\",ansj[i]);\n} \n```",
        "postTime": 1485957042,
        "uid": 9168,
        "name": "kczno1",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3532 \u3010[POI2012]ODL-Distance\u3011"
    },
    {
        "content": "\u8bbe $cnt(x)$ \u4e3a $x$ \u8d28\u56e0\u6570\u5206\u89e3\u540e\u8d28\u56e0\u6570\u7684\u6307\u6570\u548c\uff0c\u5373\u5c06 $x$ \u4e0d\u65ad\u9664\u5176\u4e00\u4e2a\u7ea6\u6570\u6765\u4f7f\u5176\u53d8\u4e3a $1$ \u6240\u9700\u7684\u6b21\u6570\uff0c\u5176\u53ef\u4ee5\u901a\u8fc7\u7ebf\u6027\u7b5b\u6765\u9884\u5904\u7406\u3002\n\n\u4e0d\u96be\u53d1\u73b0\uff1a\n$$\n\\large d(a_i,a_j)=cnt(a_i)+cnt(a_j)-2cnt(\\gcd(a_i,a_j))\n$$\n\u8003\u8651\u5bf9\u4e8e\u6bcf\u4e2a $a_i$\uff0c\u53ef\u4ee5\u679a\u4e3e\u5176\u7ea6\u6570\uff0c\u5373\u679a\u4e3e\u4e0e\u53e6\u4e00\u4e2a\u6570 $a_j$ \u7684 $\\gcd$\u3002\u8fd9\u6837\u7684\u8bdd\uff0c$cnt(a_i)$ \u548c $cnt(\\gcd(a_i,a_j))$ \u5c31\u90fd\u786e\u5b9a\u4e0b\u6765\u4e86\u3002\u8981\u4f7f $d(a_i,a_j)$ \u6700\u5c0f\uff0c\u53ea\u9700 $cnt(a_j)$ \u6700\u5c0f\uff0c\u4e8e\u662f\u53ef\u4ee5\u5904\u7406\u51fa\u6bcf\u4e2a\u6570\u7684\u6240\u6709\u500d\u6570\u4e2d $cnt$ \u6700\u5c0f\u7684\u6570\uff0c\u4e14\u8be5\u6570\u5728\u5e8f\u5217 $\\{ a_i \\}$ \u4e2d\u3002\u56e0\u4e3a\u8981\u6c42 $i \\not = j$\uff0c\u56e0\u6b64\u8fd8\u9700\u5904\u7406\u51fa\u6b21\u5c0f\u503c\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u7edf\u8ba1\u6bcf\u4e2a\u7ea6\u6570\u7684\u6700\u4f18\u8d21\u732e\u4e86\uff0c\u8fd9\u6837\u679a\u4e3e\u5230\u7684\u7ea6\u6570\u4e0d\u4e00\u5b9a\u6070\u597d\u4e3a $\\gcd(a_i,a_j)$\uff0c\u4f46\u5f53\u679a\u4e3e\u5230 $\\gcd(a_i,a_j)$ \u4e00\u5b9a\u4f1a\u66f4\u4f18\uff0c\u6240\u4ee5\u6700\u7ec8\u7684\u7b54\u6848\u4e00\u5b9a\u4e3a $\\gcd(a_i,a_j)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define maxn 1000010\n#define all 1000000\n#define inf 1000000000\nusing namespace std;\ntemplate<typename T> inline void read(T &x)\n{\n    x=0;char c=getchar();bool flag=false;\n    while(!isdigit(c)){if(c=='-')flag=true;c=getchar();}\n    while(isdigit(c)){x=(x<<1)+(x<<3)+(c^48);c=getchar();}\n    if(flag)x=-x;\n}\nint n,tot,ans,val;\nint a[maxn],p[maxn],cnt[maxn],mn1[maxn],mn2[maxn];\nbool tag[maxn];\nvoid init()\n{\n    for(int i=2;i<=all;++i)\n    {\n        if(!tag[i]) p[++tot]=i,cnt[i]=1;\n        for(int j=1;j<=tot;++j)\n        {\n            int k=i*p[j];\n            if(k>all) break;\n            tag[k]=true,cnt[k]=cnt[i]+1;\n            if(i%p[j]==0) break;\n        }\n    }\n}\nvoid update(int d,int x)\n{\n    if(cnt[a[x]]<cnt[a[mn1[d]]]) mn2[d]=mn1[d],mn1[d]=x;\n    else if(cnt[a[x]]<cnt[a[mn2[d]]]&&x!=mn1[d]) mn2[d]=x;\n}\nvoid work(int d,int x)\n{\n    int y=mn1[d]==x?mn2[d]:mn1[d],v=cnt[a[x]]+cnt[a[y]]-2*cnt[d];\n    if(v<val||(v==val&&y<ans)) val=v,ans=y;\n}\nint main()\n{\n    init(),read(n),cnt[0]=inf;\n    for(int i=1;i<=n;++i) read(a[i]);\n    for(int i=1;i<=n;++i)\n    {\n        for(int j=1;j*j<=a[i];++j)\n        {\n            if(a[i]%j) continue;\n            update(j,i),update(a[i]/j,i);\n        }\n    }\n    for(int i=1;i<=n;++i)\n    {\n        val=inf;\n        for(int j=1;j*j<=a[i];++j)\n        {\n            if(a[i]%j) continue;\n            work(j,i),work(a[i]/j,i);\n        }\n        printf(\"%d\\n\",ans);\n    }\n    return 0;\n}\n```",
        "postTime": 1599467198,
        "uid": 172489,
        "name": "lhm_",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 P3532 \u3010[POI2012]ODL-Distance\u3011"
    },
    {
        "content": "## \u9898\u89e3\uff1a\n\n\u5176\u5b9e\u8fd9\u9053\u9898\u7684\u6027\u8d28\u5565\u7684\u8fd8\u662f\u6bd4\u8f83\u597d\u63a8\u5bfc\u7684\uff0c\u6211\u89c9\u5f97\u96be\u70b9\u53ea\u5728\u4e8e\u5982\u4f55\u7b80\u6d01\u3001\u6b63\u786e\u5730\u5b9e\u73b0\u4ee3\u7801\u3002\n\n\u5148\u8003\u8651\uff1a\u5bf9\u4e8e\u4efb\u610f\u7684\u4e24\u4e2a\u6570$A,B$\uff0c\u5982\u4f55\u7528\u6700\u5c11\u7684\u4e58\u9664\u8d28\u6570\u7684\u64cd\u4f5c\u5b8c\u6210\u8f6c\u6362\uff1f\n\n\u80af\u5b9a\u79d2\u60f3\u8d28\u56e0\u5b50\u5206\u89e3\u554a\u3002\n\n\u73b0\u5728\u6211\u4eec\u6709A\u7684\u8d28\u56e0\u5b50\uff0cB\u7684\u8d28\u56e0\u5b50\uff0cA,B\u7684\u516c\u5171\u8d28\u56e0\u5b50\u3002\u660e\u663e\u5730\uff0c\u6700\u5c11\u6b65\u6570\u5c31\u662f**\u76f8\u540c\u7684\u8d28\u56e0\u5b50\u4fdd\u7559\uff0c\u4e0d\u540c\u7684\u8d28\u56e0\u5b50\u4e58\u9664**\uff0c\u8bbe$f(x)$\u4e3a$x$\u7684\u8d28\u56e0\u5b50\u4e2a\u6570\uff08\u8d28\u56e0\u5b50\u6307\u6570\u548c\uff09\u3002\u90a3\u4e48\u6700\u5c11\u6b65\u9aa4\u5c31\u662f\uff1a$f(A)+f(B)-2f(\\gcd(A,B))$\u3002\n\n\u8fd9\u4e2a\u5f0f\u5b50\u8fd8\u662f\u5f88\u597d\u63a8\u5bfc\u7684\u3002\n\n\u7136\u540e\u663e\u800c\u6613\u89c1\u7684\u66b4\u529b\u601d\u8def\u5c31\u662f\u5bf9\u4e8e\u6bcf\u4e2a\u4f4d\u7f6e$i$\uff0c\u4ece\u5934\u5230\u5c3e\u679a\u4e3e$j$\uff0c\u4e00\u65e6\u7b26\u5408\u6761\u4ef6\u5c31\u8df3\u51fa\u3002$O(n^2)$\u505a\u6cd5\u3002\n\n\u80af\u5b9a\u662f\u4e0d\u884c\uff0c\u6211\u4eec\u601d\u8003\u4f18\u5316\u3002\u5bf9\u4e8e\u8fd9\u79cd\u4e09\u5143\u95ee\u9898\uff0c\u5b9a\u4e00\u5143\uff0c\u679a\u4e3e\u53e6\u4e00\u5143\uff0c\u4e0d\u884c\u7684\u8bdd\u5c31\u679a\u4e3e\u4e0b\u4e00\u5143\u597d\u4e86\u3002\u65e2\u7136\u679a\u4e3e$j$\u8981T\uff0c\u6211\u4eec\u5c1d\u8bd5\u679a\u4e3e$\\gcd(a[i],a[j])=g$\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e$g$\uff0c\u6211\u4eec\u9700\u8981\u5728\u5b83\u7684\u6240\u6709\u500d\u6570\u4e2d\u627e\u5230\u5b58\u5728\u4e8e\u5e8f\u5217\u4e2d\u7684\u4e14\u4e0b\u6807\u5c3d\u53ef\u80fd\u5c0f\u7684\u4f4d\u7f6e\u3002\u8fd9\u4e2a\u6b65\u9aa4\u4e0d\u80fd\u7528\u6b63\u5411\u601d\u7ef4\uff0c\u6bd4\u5982\u7528set\u7ef4\u62a4\u3002\u8981\u9006\u5411\u60f3\uff1a\u5728\u679a\u4e3e\u4e00\u4e2a\u6570$x$\u7684\u6240\u6709\u56e0\u5b50$g$\u7684\u8fc7\u7a0b\u4e2d\uff0c$x$\u5c31\u662f$g$\u7684\u4e00\u4e2a\u500d\u6570\uff0c\u6211\u4eec\u76f4\u63a5\u7528$x$\u6765\u66f4\u65b0\u5c31\u597d\u4e86\u3002\n\n\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6709\u53ef\u80fd\u5b58\u5728\u6700\u5c0f\u4e0b\u6807\u5c31\u662f\u8fd9\u4e2a\u6570\u672c\u8eab\u7684\u60c5\u51b5\uff0c\u4e8e\u662f\u6211\u4eec\u8fd8\u9700\u8981\u7ef4\u62a4\u4e00\u4e2a\u6b21\u5c0f\u503c\u3002\n\n\u6700\u540e\u67e5\u8be2\u7684\u65f6\u5019\u76f4\u63a5$O(1)$\u5c31\u597d\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nconst int maxn=1e6+5;\nconst int maxw=1e6+6;\nconst int INF=1e9;\nint n,tot,ans,val,maxx;\nint a[maxn],prime[maxn],cnt[maxn],mn1[maxn],mn2[maxn];\n//mn1,mn2\u8868\u793a\u4e00\u4e2a\u6570\u7684\u6240\u6709\u500d\u6570\u4e2d\u6700\u5c0f\u3001\u6b21\u5c0f\u503c\u7684\u4f4d\u7f6e\nbool v[maxn];\nvoid init(int x)\n{\n    for(int i=2;i<=x;i++)\n    {\n        if(!v[i]) \n\t\t\tprime[++tot]=i,cnt[i]=1;\n        for(int j=1;j<=tot && i*prime[j]<=x;j++)\n        {\n            v[i*prime[j]]=1;\n\t\t\tcnt[i*prime[j]]=cnt[i]+1;\n            if(i%prime[j]==0) \n\t\t\t\tbreak;\n        }\n    }\n}\nvoid update(int d,int x)\n{\n    if(cnt[a[x]]<cnt[a[mn1[d]]]) \n\t\tmn2[d]=mn1[d],mn1[d]=x;\n    else if(cnt[a[x]]<cnt[a[mn2[d]]]&&x!=mn1[d]) \n\t\tmn2[d]=x;\n}\nvoid getans(int d,int x)\n{\n    int pos=mn1[d]==x?mn2[d]:mn1[d];\n\tint v=cnt[a[x]]+cnt[a[pos]]-2*cnt[d];\n    if(v<val||(v==val&&pos<ans)) \n\t\tval=v,ans=pos;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&a[i]);\n\t\tmaxx=max(maxx,a[i]);\n\t}\n    init(maxx);\n\tcnt[0]=INF;\n    for(int i=1;i<=n;i++)\n        for(int j=1;j*j<=a[i];++j)\n        {\n            if(a[i]%j) \n\t\t\t\tcontinue;\n            update(j,i);\n\t\t\tupdate(a[i]/j,i);\n        }\n    for(int i=1;i<=n;++i)\n    {\n        val=INF;\n        for(int j=1;j*j<=a[i];++j)\n        {\n            if(a[i]%j) \n\t\t\t\tcontinue;\n            getans(j,i);\n\t\t\tgetans(a[i]/j,i);\n        }\n        printf(\"%d\\n\",ans);\n    }\n    return 0;\n}\n```\n\n",
        "postTime": 1606285221,
        "uid": 175131,
        "name": "\u5085\u601d\u7ef4666",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 P3532 \u3010[POI2012]ODL-Distance\u3011"
    },
    {
        "content": "\u200b\t\u9996\u5148\uff0c\u6211\u4eec\u6765\u5206\u6790\u9898\u610f\uff1a\u7ed9\u51fa\u4e00\u4e2a\u5e8f\u5217a[1]...a[n]\uff0c\u5bf9\u4e8e\u6bcf\u4e2ai\uff0c\u627e\u5230\u4e00\u4e2aj\u4f7f\u5f97i$\\neq$j\u4e14j\u4e3a\u6700\u5c0f\u4f7f\u5f97\u4f7f\u5f97a[i]\u5230a[j]\u7684\u8ddd\u79bb\u6700\u5c0f\u7684\u6570\u3002\n\n####\t\u8ddd\u79bb\u5b9a\u4e49\u4e3a:\u5b9a\u4e49\u4e00\u4e2a\u6570\u4e58\u6216\u9664\u4ee5\u4e00\u4e2a\u8d28\u6570\u4e3a\u4e00\u6b65\uff0c\u4e00\u4e2a\u6570\u4e0e\u53e6\u4e00\u4e2a\u6570\u7684\u8ddd\u79bb\u4e3a\u4e00\u4e2a\u6570\u53d8\u4e3a\u53e6\u4e00\u4e2a\u6570\u6240\u9700\u7684\u6700\u5c0f\u6b65\u9aa4\u3002\n\n\u200b\t\u6211\u4eec\u9996\u5148\u6765\u63a8\u5f0f\u5b50\uff1a\u6211\u4eec\u8981\u628a\u4e00\u4e2a\u6570x\u53d8\u4e3ay\uff0c\u6211\u4eec\u9700\u8981\u6539\u52a8\u54ea\u4e9b\uff1f\u6211\u4eec\u8bbef(x)=dis(1,x)=\u628ax\u5206\u89e3\u8d28\u56e0\u6570\u540e\u6240\u6709\u8d28\u6570\u7684\u6307\u6570\u4e4b\u548c(**\u8fd9\u4e2a\u53ef\u4ee5\u7528\u7ebf\u578b\u7b5bO(n)\u9884\u5904\u7406**)\u3002\n\n\u200b\t\u8bbed=gcd(x,y),\u90a3\u4e48\u53ef\u4ee5\u53d1\u73b0,\u8981\u628ax\u53d8\u4e3ay\uff0c\u6211\u4eec\u65e0\u9700\u6539\u52a8\u4e58\u79ef\u4e3ad\u7684\u90e8\u5206\uff0c\u53ea\u9700\u6539\u52a8\u5269\u4e0b\u90e8\u5206\u5373\u53ef\uff0c\u4e5f\u5373\u662f\u8bf4**dis(x,y)=f($\\frac{x}{d}$)+f($\\frac{y}{d}$)=f(x)+f(y)-2f(d)**\n\n\u200b\t\u6709\u4e86\u8fd9\u4e2a\u5f0f\u5b50\u540e\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u679a\u4e3e\u7684x\u627e\u5230\u4e00\u4e2a\u5408\u9002\u7684y\u5373\u53ef\u3002\n\n\u200b\t\u6ce8\u610f\u5230\uff0cdis(x,y)\u7531x,y,d\u4e09\u90e8\u5206\u5171\u540c\u7ec4\u6210,\u800cx\u4e3a\u5b9a\u503c,\u4e0d\u7528\u7ba1\u3002\u679a\u4e3ey\u7684\u8bdd\u660e\u663e\u4f1aT\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u679a\u4e3ed\u3002\u6211\u4eec\u77e5\u9053\uff0c\u679a\u4e3ed\u53ea\u9700\u8981$\\sqrt{x}$\u6b21\u5373\u53ef\u679a\u4e3e\u5b8cx\u7684\u6240\u6709d\u3002\n\n\u200b\t\u73b0\u5728d\u662f\u4e00\u4e2a\u5b9a\u503c\u4e86\uff0c\u4e8e\u662f\uff0c\u9898\u76ee\u8f6c\u5316\u4e3a:\n\n#### \u200b\t\u7ed9\u5b9ax,d\u6c42\u4e00\u4e2a\u6570y\u4f7f\u5f97y\u662fd\u7684\u500d\u6570\u4e14f(y)\u6700\u5c0f\uff0c\u4e14y\u5bf9\u5e94\u7684\u4e0b\u6807\u6700\u5c0f\u3002\n\n\u200b\t\u800c\u4e14\uff0c\u6211\u4eec\u5f53\u524d\u5df2\u7ecf\u82b1\u4e86n$\\sqrt{n}$\u7684\u65f6\u95f4\u679a\u4e3e\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u5fc5\u987b\u5c3d\u5feb\u6c42\u51fa\u7b54\u6848\u3002\n\n\u200b\t\u90a3\u4e48\u6211\u4eec\u8003\u8651**\u9884\u5904\u7406**\u3002\n\n\u200b\t\u9996\u5148\uff0c\u6211\u4eec\u8bbeg(x)\u8868\u793a,\u5bf9\u4e8e\u6240\u6709\u5e8f\u5217\u4e2d\u662fx\u7684\u500d\u6570\u7684\u6570y\uff0c\u6700\u5c0f\u7684f(y)\u7684\u503c\uff0ct(x)\u5219\u8868\u793ag(x)\u6240\u5bf9\u5e94\u7684\u4e0b\u6807(\u6ee1\u8db3\u6700\u5c0f)\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5O(1)\u56de\u7b54\u4e0a\u9762\u7684\u95ee\u9898\u4e86\uff01\u800c\u4e14\u8fd9\u662f\u53ef\u4ee5O(n$\\sqrt{n}$)\u9884\u5904\u7406\u51fa\u7684\uff01\n\n\u200b\t\u4f46\u662f\uff0c\u5982\u679c\u60a8\u6253\u597d\u4ee3\u7801\uff0c\u76f4\u63a5\u4ea4\u4e00\u53d1\uff0c\u90a3\u4e48\u5f88\u9057\u61be\uff0c\u60a8\u4f1awa\u3002\n\n\u200b\t\u4e3a\u4ec0\u4e48\u5462\uff1f\u56e0\u4e3a\u6211\u4eec\u6ca1\u6709\u8003\u8651\u5230i$\\neq$j\u8fd9\u4e2a\u6761\u4ef6\uff01\n\n\u200b\t\u5f53i=j\u65f6dis(i,j)=0\uff0c\u5c31\u4f1a\u4f7f\u5f97\u7b54\u6848\u9519\u8bef\uff0c\u90a3\u4e48\u6211\u4eec\u6539\u600e\u4e48\u89e3\u51b3\u5462\uff1f\n\n\u200b\t\u6211\u7684\u65b9\u6cd5\u662f\uff1a**\u5728\u7ef4\u62a4\u6700\u5c0f\u503c\u7684\u57fa\u7840\u4e0a\u518d\u7ef4\u62a4\u4e00\u4e2a\u6b21\u5c0f\u503c**\n\n\u200b\t\u8fd9\u6837\uff0c\u56e0\u4e3a\u6700\u5c0f\u503c\u4e0b\u6807$ \\neq$\u6b21\u5c0f\u503c\u4e0b\u6807,\u6240\u4ee5\u5bf9\u4e8e\u6bcf\u4e2ax\u4e00\u5b9a\u80fd\u627e\u5230\u4e00\u4e2a\u6700\u5c0f\u7684\u6ee1\u8db3\u6761\u4ef6\u7684y\n\n\u200b\t\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```c\n//#pragma GCC optimize()//\u624b\u52a8Ox\u4f18\u5316\n#include<bits/stdc++.h>\n//\u7ef4\u62a4\u6700\u5c0f\u503c\u4e0e\u6b21\u5c0f\u503c\u5373\u53ef\u907f\u514d\u76f8\u540c\u6570\u7684\u60c5\u51b5 \nusing namespace std;\nconst int N=1e5+1,M=1e6+1;\nint a[N];\nint f[M],zhi[M>>1],e;\nint ti[M][2],id[M][2];//ti\u4e3ax,y\u7684\u7ea6\u6570\u4e3ai\u65f6\u6700\u5c0f,\u6b21\u5c0f\u7684f\u7684\u503c,id\u4e3a\u5bf9\u5e94\u7684\u4e0b\u6807 \ninline void sai(int maxe){//\u4e2a\u6570\u7b5b\n\tfor(int i=2;i<=maxe;++i){\n\t\tif(!f[i]){\n\t\t\tf[i]=1;\n\t\t\tzhi[++e]=i;\n\t\t}\n\t\tfor(int j=1;j<=e;++j){\n\t\t\tif(i*zhi[j]>maxe){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tf[i*zhi[j]]=f[i]+1;\n\t\t\tif(i%zhi[j]==0){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\nint main(){\n\tmemset(ti,0x3f3f,sizeof(ti));//\u8bb0\u5f97\u521d\u59cb\u5316\u6781\u5927\u503c \n\tsai(M-1);//\u7ebf\u6027\u7b5b\u7b5bf\u51fd\u6570\n\tint n;\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;++i){\n\t\tscanf(\"%d\",&a[i]);\n\t\tint now=a[i];\n\t\tfor(int j=sqrt(now);j;--j){//\u9884\u5904\u7406 \n\t\t\tif(now%j==0){\n\t\t\t\tif(ti[j][0]>f[a[i]]||(ti[j][0]==f[a[i]]&&i<id[j][0])){//\u66f4\u65b0\u6700\u5c0f\u503c \n\t\t\t\t\tti[j][1]=ti[j][0];\n\t\t\t\t\tid[j][1]=id[j][0];//\u5148\u8ba9\u6b21\u5c0f\u503c\u7ee7\u627f\u6700\u5c0f\u503c(\u5176\u5b9e\u76f8\u5f53\u4e8e\u63a8\u8868)\n\t\t\t\t\tti[j][0]=f[a[i]];\n\t\t\t\t\tid[j][0]=i;\n\t\t\t\t}else if(ti[j][1]>f[a[i]]||(ti[j][1]==f[a[i]]&&i<id[j][1])){//\u66f4\u65b0\u6b21\u5c0f\u503c \n\t\t\t\t\tti[j][1]=f[a[i]];\n\t\t\t\t\tid[j][1]=i;\n\t\t\t\t}\n\t\t\t\tif(j*j!=now){//\u679a\u4e3e\u53e6\u4e00\u4e2a\u7ea6\u6570 \n\t\t\t\t\tint k=now/j;\n\t\t\t\t\tif(ti[k][0]>f[a[i]]||(ti[k][0]==f[a[i]]&&id[k][0]>i)){\n\t\t\t\t\t\tti[k][1]=ti[k][0];\n\t\t\t\t\t\tid[k][1]=id[k][0];\n\t\t\t\t\t\tti[k][0]=f[a[i]];\n\t\t\t\t\t\tid[k][0]=i;\n\t\t\t\t\t}else if(ti[k][1]>f[a[i]]||(ti[k][1]==f[a[i]]&&id[k][1]>i)){\n\t\t\t\t\t\tti[k][1]=f[a[i]];\n\t\t\t\t\t\tid[k][1]=i;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=n;++i){\n\t\tint now=a[i];\n\t\tint ans=2e9,ji;\n\t\tfor(int j=sqrt(now);j;--j){//\u679a\u4e3ed \n\t\t\tif(now%j==0){\n\t\t\t\tint ant=ti[j][0]-2*f[j],anp=ti[j][1]-2*f[j];//\u8ba1\u7b97\u8ddd\u79bb\uff0c\u7531\u4e8ef[a[i]]\u662f\u5b9a\u503c\uff0c\u6240\u4ee5\u53ef\u4ee5\u5ffd\u7565 \n\t\t\t\tif((ans>ant&&id[j][0]!=i)||(ans==ant&&id[j][0]!=i&&id[j][0]<ji)){\n\t\t\t\t\tans=ant,ji=id[j][0];\n\t\t\t\t}else if(ans>anp||(ans==anp&&id[j][1]<ji)){\n\t\t\t\t\tans=anp,ji=id[j][1];\n\t\t\t\t}\n\t\t\t\tif(j*j!=now){//\u679a\u4e3e\u53e6\u4e00\u4e2a\u7ea6\u6570 \n\t\t\t\t\tint k=now/j;\n\t\t\t\t\tant=ti[k][0]-2*f[k],anp=ti[k][1]-2*f[k];\n\t\t\t\t\tif((ans>ant&&id[k][0]!=i)||(ans==ant&&id[k][0]!=i&&id[k][0]<ji)){\n\t\t\t\t\t\tans=ant,ji=id[k][0];\n\t\t\t\t\t}else if(ans>anp||(ans==anp&&id[k][1]<ji)){\n\t\t\t\t\t\tans=anp,ji=id[k][1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d\\n\",ji);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1547436279,
        "uid": 81847,
        "name": "ThinkofBlank",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 P3532 \u3010[POI2012]ODL-Distance\u3011"
    },
    {
        "content": "> *[P3532 [POI2012]ODL-Distance](https://www.luogu.com.cn/problem/P3532)\n>\n> [POI \u5408\u96c6](https://www.cnblogs.com/alex-wei/p/POI.html)\u3002\n\n\u8003\u8651\u5728 $i$ \u548c $p\\times i\\ (p\\in \\mathbb{P})$ \u4e4b\u95f4\u8fde\u8fb9\uff0c\u9898\u76ee\u76f8\u5f53\u4e8e\u5728\u8fd9\u5f20\u56fe\u4e0a\u6492 $n$ \u4e2a\u5173\u952e\u70b9\uff0c\u6c42\u8ddd\u79bb\u6bcf\u4e2a\u5173\u952e\u70b9\u6700\u8fd1\u4e14\u975e\u672c\u8eab\u7684\u5173\u952e\u70b9\u7684\u6700\u5c0f\u7f16\u53f7\u3002\u5bf9\u6bcf\u4e2a\u70b9\u8bb0\u5f55\u8ddd\u79bb\u8be5\u70b9\u6700\u8fd1\u548c\u7b2c\u4e8c\u8fd1\u7684\u5173\u952e\u70b9\u8ddd\u79bb\u4e0e\u7f16\u53f7\uff0c\u4e00\u904d `BFS` \u5373\u53ef\uff0c\u4f46\u662f\u5e38\u6570\u592a\u5927\uff0c\u4e0d\u5f00 O2 \u96be\u4ee5\u901a\u8fc7\u3002\n\n\u8bbe $\\omega(i)$ \u8868\u793a $i$ \u7684\u8d28\u56e0\u5b50\u4e2a\u6570\uff0c\u5219 $\\mathrm{dis}(i,j)=\\omega(i)+\\omega(j)-2\\omega(\\gcd(i,j))$\u3002\u8003\u8651\u679a\u4e3e $d=\\gcd(i,j)$\uff0c\u90a3\u4e48\u51cf\u53f7\u540e\u9762\u7684\u90e8\u5206\u5c31\u786e\u5b9a\u4e86\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u56fa\u5b9a\u7684 $i$\uff0c\u6211\u4eec\u663e\u7136\u8981\u8ba9 $(\\omega(j),buc_j)$ \u8fd9\u4e00\u4e8c\u5143\u7ec4\u6700\u5c0f\uff0c\u5176\u4e2d $buc_j$ \u8868\u793a $a$ \u503c\u4e3a $j$ \u7684\u6700\u5c0f\u4f4d\u7f6e\u3002\n\n\u8003\u8651\u679a\u4e3e $d$ \u7684\u500d\u6570 $kd$\uff0c\u6c42\u51fa $\\min_{k\\geq 1,kd\\leq r}(\\omega(kd),buc_{kd})$\uff0c\u8bbe\u4e3a $(x,y)$ \u4ee5\u53ca\u53d6\u5230\u6700\u5c0f\u503c\u7684\u4f4d\u7f6e\u4e3a $td$\u3002 \u90a3\u4e48\u5bf9\u4e8e\u6240\u6709 $k\\neq t$\uff0c\u6211\u4eec\u7528 $td$ \u548c $kd$ \u4e92\u76f8\u66f4\u65b0\u3002$kd$ \u5c31\u76f8\u5f53\u4e8e\u4e0a\u9762\u7684 $i$\uff0c\u800c $td$ \u5145\u5f53\u4e86\u4f7f\u5f97 $(\\omega(j),buc_j)$ \u6700\u5c0f\u7684 $j$\u3002\n\n\u6bcf\u4e2a $\\gcd$ \u90fd\u4f1a\u88ab\u679a\u4e3e\u5230\uff0c\u56e0\u6b64\u7b97\u6cd5\u6b63\u786e\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u8c03\u548c\u7ea7\u6570\u7684\u7ebf\u6027\u5bf9\u6570\u3002\u7531\u4e8e\u5c0f\u5e38\u6570\uff0c\u6210\u529f\u62ff\u5230\u4e86\u6700\u4f18\u89e3\uff082021.12.19\uff09\u3002\n\n```cpp\nconst int N = 1e6 + 5;\nint n, mx, a[N], buc[N], ans[N], fc[N]; pii dis[N];\nint cnt, vis[N], pr[N], mpr[N], chk[N];\nvoid sieve() {\n\tdis[1] = {N, 0};\n\tfor(int i = 2; i <= mx; i++) {\n\t\tdis[i] = {N, 0};\n\t\tif(!vis[i]) pr[++cnt] = i, mpr[i] = i;\n\t\tfor(int j = 1; j <= cnt && i * pr[j] <= mx; j++) {\n\t\t\tvis[i * pr[j]] = 1, mpr[i * pr[j]] = pr[j];\n\t\t\tif(i % pr[j] == 0) break;\n\t\t} chk[i] = chk[i / mpr[i]] + 1;\n\t}\n} \nint main() {\n\tcin >> n;\n\tfor(int i = 1; i <= n; i++) {\n\t\ta[i] = read(), cmax(mx, a[i]);\n\t\tif(buc[a[i]]) {\n\t\t\tans[i] = buc[a[i]];\n\t\t\tif(!ans[buc[a[i]]]) ans[buc[a[i]]] = i;\n\t\t} else buc[a[i]] = i;\n\t} sieve();\n\tfor(int i = 1; i <= mx; i++) {\n\t\tpii best = {N, 0};\n\t\tfor(int j = i, dv = 1; j <= mx; j += i, dv++)\n\t\t\tif(buc[j]) cmin(best, (pii){chk[dv], buc[j]});\n\t\tfor(int j = i, dv = 1; j <= mx; j += i, dv++) if(buc[j] != best.se && buc[j])\n\t\t\tcmin(dis[j], (pii){best.fi + chk[dv], best.se}),\n\t\t\tcmin(dis[a[best.se]], (pii){best.fi + chk[dv], buc[j]});\n\t\tif(buc[i] && !ans[buc[i]]) ans[buc[i]] = dis[i].se;\n\t} for(int i = 1; i <= n; i++) print(ans[i]), pc('\\n');\n\treturn flush(), 0;\n}\n```",
        "postTime": 1639925047,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "P3532 [POI2012]ODL-Distance"
    },
    {
        "content": "\u597d\u9898\u3002\n\n\u9996\u5148\u6211\u4eec\u53ea\u80fd\u8003\u8651\u57fa\u4e8e\u503c\u57df\u5904\u7406\u3002\n\n\u7136\u540e\u56e0\u4e3a\u8ba1\u7b97 $f(i,\\ j)$ \u7684\u65f6\u5019 $i$ \u548c $j$ \u662f\u76f8\u4e92\u5f71\u54cd\u7684\u6211\u4eec\u65e0\u6cd5\u76f4\u63a5\u64cd\u4f5c\u4ed6\u3002\n\n\u4e8e\u662f\u63a8\u5f97 $f(i,\\ j) = \\dfrac{d(i) \\cdot d(j)}{d(\\gcd(i,\\ j)^2)}$\u3002\u5176\u4e2d\u5b9a\u4e49 $d(i)$ \u4e3a $i$ \u548c $1$ \u7684\u8ddd\u79bb\u3002\u5bb9\u6613\u9884\u5904\u7406\u51fa\u6765 $d$\u3002\n\n\u7136\u540e\u8003\u8651\u679a\u4e3e $\\gcd$\u3002\u518d\u679a\u4e3e $\\gcd$ \u7684\u500d\u6570\u8ba1\u7b97\u3002\n\n\u6211\u4eec\u518d\u5904\u7406\u51fa\u6bcf\u4e00\u4e2a\u6570\u7684\u500d\u6570\u4e2d\uff0c\u51fa\u73b0\u5728\u6570\u5217\u4e2d\u7684\u6570\u7684 $d$ \u7684\u6700\u5c0f\u503c\u53ca\u5176\u4f4d\u7f6e\u3002\u5c31\u53ef\u4ee5\u975e\u5e38\u65b9\u4fbf\u5730\u8ba1\u7b97\u4e86\u3002\n\n\u6ce8\u610f\u5230\u4e00\u4e2a\u7ec6\u8282\u5c31\u662f\u500d\u6570\u4e0d\u4e00\u5b9a\u7b26\u5408 $\\gcd$ \u7684\u6761\u4ef6\u3002\n\n\u4f46\u5176\u5b9e\u8fd9\u91cc\u4e0d\u5f71\u54cd\uff0c\u56e0\u4e3a\u5982\u679c\u4e0d\u7b26\u5408 $\\gcd$ \u7684\u8bdd\u5c31\u4e00\u5b9a\u662f $\\gcd$ \u7684\u56e0\u6570\u3002\u53ea\u4f1a\u4f7f\u7b54\u6848\u66f4\u5c0f\u800c\u4e0d\u4f1a\u5f71\u54cd\u3002\n\n\u5982\u679c\u6709\u4eba\u4f1a\u8fd9\u9898\u6700\u5c0f\u6539\u4e3a\u6700\u5927\u7684\u505a\u6cd5\u53ef\u4ee5\u79c1\u4fe1\u6559\u6211\u4e00\u4e0b /kk\u3002",
        "postTime": 1598435233,
        "uid": 55078,
        "name": "YLWang",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 P3532 \u3010[POI2012]ODL-Distance\u3011"
    },
    {
        "content": "# \u9898\u76ee\n\n[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/P3532)\n\n# \u5206\u6790\n\n\u5148 $O(n)$ \u7ebf\u6027\u7b5b\u626b\u51fa\u6bcf\u4e2a\u6570\u7684\u8d28\u56e0\u6570\u4e2a\u6570\u3002\n\n\u7136\u540e\u8981\u6c42\u6bcf\u4e2a\u6570\u7684 $\\min (d_i+d_j-2 \\times d_{\\gcd(i,j)})$\u3002\n\n\u679a\u4e3e\u8fd9\u4e2a\u56e0\u6570\uff0c\u518d\u52a0\u4e0a\u662f\u8fd9\u4e2a\u56e0\u6570\u500d\u6570\u7684 ${b_i}_ { \\min }$\u3002\n\n\u7531\u4e8e\u53ef\u80fd\u8fd9\u4e2a\u6700\u5c0f\u503c\u5c31\u662f\u8be5\u6570\uff0c\u8fd8\u8981\u7edf\u8ba1\u4e00\u4e2a\u6b21\u5c0f\u503c\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n \\sqrt{n})$\u3002\n\n# \u4ee3\u7801\n\n```cpp\n//By AKNOI\u7684\u6893\u94a6 On 2022-06-13\n#include<cmath>\n#include<cstdio>\n#include<climits>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\n#define INF 0x3f3f3f3f\n#define LLINF 0x3f3f3f3f3f3f3f3f\n#define ll long long\n#define N 1000005\nusing namespace std;\nint read(){\n\tint x=0,f=1,ch=getchar();\n\tfor(;!isdigit(ch);ch=getchar()) f=(ch=='-')?-1:1;\n\tfor(;isdigit(ch);ch=getchar()) x=(x<<3)+(x<<1)+(ch^48);\n\treturn x*f;\n}\nvoid print(int x){\n\tif(x<0) putchar('-'),x=~(x-1);\n\tif(x>9) print(x/10);\n\tputchar(x%10+48);\n}\nint n,x,w,tot,u,d1[N],d2[N],e1[N],e2[N],b[N],p[N],a[N];\nbool vis[N];\nvoid work(int x,int y,int z){\n\tif(z<d1[x] || z==d1[x] && y<e1[x]){\n\t\td2[x]=d1[x];\n\t\te2[x]=e1[x];\n\t\td1[x]=z;\n\t\te1[x]=y;\n\t}\n\telse if(y!=e1[x] && (z<d2[x] || z==d2[x] && y<e2[x])){\n\t\td2[x]=z;\n\t\te2[x]=y;\n\t}\n}\nvoid get(int z,int y){\n\tif(z<w || z==w && y<u){\n\t\tw=z;\n\t\tu=y;\n\t}\n}\nvoid gans(int i,int j){\n\tint a1=e1[j]==i?d2[j]-2*b[j]:d1[j]-2*b[j];\n\tint a2=e1[j]==i?e2[j]:e1[j];\n\tget(a1,a2);\n}\nvoid line_prime(){\n\tmemset(d1,INF,sizeof(d1));\n\tmemset(d2,INF,sizeof(d2));\n\tfor(int i=2;i<=N-5;++i){\n\t\tif(!vis[i]){\n\t\t\tp[++tot]=i;\n\t\t\tb[i]=1;\n\t\t}\n\t\tfor(int j=1;j<=tot && i*p[j]<=N-5;++j){\n\t\t\tvis[i*p[j]]=1;\n\t\t\tb[i*p[j]]=b[i]+1;\n\t\t\tif(i%p[j]==0) break;\n\t\t}\n\t}\n}\nvoid init(){\n\tn=read();\n\tfor(int i=1;i<=n;++i){\n\t\ta[i]=read();\n\t\tfor(int j=1;j*j<=a[i];++j){\n\t\t\tif(a[i]%j==0){\n\t\t\t\twork(j,i,b[a[i]]);\n\t\t\t\tif(a[i]*a[i]!=j) work(a[i]/j,i,b[a[i]]);\n\t\t\t}\n\t\t}\n\t}\n}\nvoid GetAns(){\n\tfor(int i=1;i<=n;++i){\n\t\tw=INF;\n\t\tfor(int j=1;j*j<=a[i];++j){\n\t\t\tif(a[i]%j==0){\n\t\t\t\tgans(i,j);\n\t\t\t\tgans(i,a[i]/j);\n\t\t\t}\n\t\t}\n\t\tprint(u);\n\t\tputs(\"\");\n\t}\n}\nint main(){\n\tline_prime();\n\tinit();\n\tGetAns();\n\treturn 0;\n}\n```",
        "postTime": 1655123266,
        "uid": 479246,
        "name": "AKNOI\u7684\u6893\u94a6",
        "ccfLevel": 5,
        "title": "P3532\u9898\u89e3"
    }
]
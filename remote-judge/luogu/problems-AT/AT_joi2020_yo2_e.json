{
    "description": "[problemUrl]: https://atcoder.jp/contests/joi2020yo2/tasks/joi2020_yo2_e\n\n\u3053\u306e\u554f\u984c\u3067\u306f\uff0c\u3058\u3083\u3093\u3051\u3093\u306e\u624b\u300c\u30b0\u30fc\u300d\u300c\u30c1\u30e7\u30ad\u300d\u300c\u30d1\u30fc\u300d\u3092\u305d\u308c\u305e\u308c $ \\mathrm{R},\\ \\mathrm{S},\\ \\mathrm{P} $ \u3067\u8868\u3059\uff0e$ \\mathrm{R} $ \u306f $ \\mathrm{S} $ \u306b\u52dd\u3061\uff0c$ \\mathrm{S} $ \u306f $ \\mathrm{P} $ \u306b\u52dd\u3061\uff0c$ \\mathrm{P} $ \u306f $ \\mathrm{R} $ \u306b\u52dd\u3064\uff0e\n\n$ x,\\ y $ \u3092\u3058\u3083\u3093\u3051\u3093\u306e\u624b\u3068\u3059\u308b\u3068\u304d\uff0c$ x\\ +\\ y,\\,\\ x\\ -\\ y,\\,\\ x\\ \\ast\\ y $ \u3092\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u5b9a\u3081\u308b (\u3053\u308c\u3089\u306f\u901a\u5e38\u306e\u610f\u5473\u3067\u306e\u8db3\u3057\u7b97\u30fb\u5f15\u304d\u7b97\u30fb\u639b\u3051\u7b97\u3067\u306f\u306a\u3044)\uff1a\n\n- $ x\\ +\\ y $ \u306f\uff0c$ x\\ \\ne\\ y $ \u306e\u3068\u304d $ x $ \u3068 $ y $ \u306e\u3046\u3061\u52dd\u3064\u65b9\u3068\u3057\uff0c$ x\\ =\\ y $ \u306e\u3068\u304d $ x $ \u3068\u3059\u308b\uff0e\n- $ x\\ -\\ y $ \u306f\uff0c$ x\\ \\ne\\ y $ \u306e\u3068\u304d $ x $ \u3068 $ y $ \u306e\u3046\u3061\u8ca0\u3051\u308b\u65b9\u3068\u3057\uff0c$ x\\ =\\ y $ \u306e\u3068\u304d $ x $ \u3068\u3059\u308b\uff0e\n- $ x\\ \\ast\\ y $ \u306f\uff0c$ x\\ \\ne\\ y $ \u306e\u3068\u304d $ \\mathrm{R},\\ \\mathrm{S},\\ \\mathrm{P} $ \u306e\u3046\u3061 $ x $ \u3067\u3082 $ y $ \u3067\u3082\u306a\u3044\u3082\u306e\u3068\u3057\uff0c$ x\\ =\\ y $ \u306e\u3068\u304d $ x $ \u3068\u3059\u308b\uff0e\n\n\u3058\u3083\u3093\u3051\u3093\u306e\u624b\u3068 $ +,\\ -,\\ \\ast $ \u3068\u62ec\u5f27\u304b\u3089\u306a\u308b\u5f0f\u306f\uff0c\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8a08\u7b97\u3059\u308b\uff1a\n\n- \u62ec\u5f27\u306e\u4e2d\u306f\u5148\u306b\u8a08\u7b97\u3059\u308b\uff0e\u4f8b\u3048\u3070\uff0c$ \\mathrm{R}\\ \\ast\\ (\\mathrm{P}\\ +\\ \\mathrm{S})\\ =\\ \\mathrm{R}\\ \\ast\\ \\mathrm{S}\\ =\\ \\mathrm{P} $ \u3067\u3042\u308b\uff0e\n- \u62ec\u5f27\u306e\u6df1\u3055\u304c\u540c\u3058\u90e8\u5206\u306b\u3064\u3044\u3066\u306f\uff0c\n  - $ +,\\ - $ \u3088\u308a $ \\ast $ \u306e\u65b9\u3092\u512a\u5148\u3057\u3066\u8a08\u7b97\u3059\u308b\uff0e\u4f8b\u3048\u3070\uff0c$ \\mathrm{R}\\ -\\ \\mathrm{P}\\ \\ast\\ \\mathrm{S}\\ =\\ \\mathrm{R}\\ -\\ (\\mathrm{P}\\ \\ast\\ \\mathrm{S})\\ =\\ \\mathrm{R}\\ -\\ \\mathrm{R}\\ =\\ \\mathrm{R} $ \u3067\u3042\u308b\uff0e\n  - \u540c\u3058\u512a\u5148\u9806\u4f4d\u306e\u3082\u306e ($ + $ \u3069\u3046\u3057\uff0c$ - $ \u3069\u3046\u3057\uff0c$ + $ \u3068 $ - $\uff0c$ \\ast $ \u3069\u3046\u3057) \u306b\u3064\u3044\u3066\u306f\uff0c\u5de6\u304b\u3089\u9806\u756a\u306b\u8a08\u7b97\u3059\u308b\uff0e\u4f8b\u3048\u3070\uff0c$ \\mathrm{R}\\ -\\ \\mathrm{P}\\ +\\ \\mathrm{S}\\ =\\ (\\mathrm{R}\\ -\\ \\mathrm{P})\\ +\\ \\mathrm{S}\\ =\\ \\mathrm{R}\\ +\\ \\mathrm{S}\\ =\\ \\mathrm{R} $ \u3067\u3042\u308b\uff0e\n\nJOI \u3055\u3093\u306f\u3042\u308b\u3058\u3083\u3093\u3051\u3093\u306e\u5f0f\u3092\u6301\u3063\u3066\u3044\u305f\u304c\uff0c\u305d\u306e\u5f0f\u306e\u4e2d\u306e $ \\mathrm{R},\\ \\mathrm{S},\\ \\mathrm{P} $ \u306e\u4e00\u90e8\u304c\u898b\u3048\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3063\u305f\uff0e\u898b\u3048\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u90e8\u5206\u304c `?` \u3067\u8868\u3055\u308c\u305f\u9577\u3055 $ N $ \u306e\u6587\u5b57\u5217 $ E $ \u304c\u4e0e\u3048\u3089\u308c\u308b\uff0eJOI \u3055\u3093\u306f\uff0c\u898b\u3048\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u90e8\u5206\u306e\u305d\u308c\u305e\u308c\u306b $ \\mathrm{R},\\ \\mathrm{S},\\ \\mathrm{P} $ \u306e\u3044\u305a\u308c\u304b\u3092\u5272\u308a\u5f53\u3066\u308b\u65b9\u6cd5\u3067\u3042\u3063\u3066\uff0c\u5f0f\u306e\u8a08\u7b97\u7d50\u679c\u304c $ A $ \u306b\u306a\u308b\u3082\u306e\u304c\u4f55\u901a\u308a\u3042\u308b\u304b\u3092\u77e5\u308a\u305f\u3044\uff0e\u305d\u306e\u6570\u306f\u975e\u5e38\u306b\u5927\u304d\u304f\u306a\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u306e\u3067\uff0c$ 1\\,000\\,000\\,007 $ \u3067\u5272\u3063\u305f\u4f59\u308a\u3092\u6c42\u3081\u305f\u3044\uff0e\n\n\u672c\u554f\u3067\u7528\u3044\u3089\u308c\u308b\u6587\u6cd5\u306f\uff0cBNF (\u30d0\u30c3\u30ab\u30b9\u30fb\u30ca\u30a6\u30a2\u8a18\u6cd5) \u3092\u7528\u3044\u3066\u4ee5\u4e0b\u306e\u3088\u3046\u306b\u8868\u3055\u308c\u308b\uff0e\u3058\u3083\u3093\u3051\u3093\u306e\u5f0f\u306e\u4e00\u90e8\u304c\u898b\u3048\u306a\u304f\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u3082\u306e\u306f &lt;expression&gt; \u3067\u3042\u308b\uff0e\n\n ```\n<expression> ::= <term> | <expression> \"+\" <term> | <expression> \"-\" <term>\n<term> ::= <factor> | <term> \"*\" <factor>\n<factor> ::= \"R\" | \"S\" | \"P\" | \"?\" | \"(\" <expression> \")\"\n```\n\n\u3053\u308c\u306f\u4f8b\u3048\u3070\uff0c\u3042\u308b\u6587\u5b57\u5217\u304c &lt;expression&gt; \u3067\u3042\u308b\u3068\u306f\uff0c\u300c&lt;term&gt; \u3067\u3042\u308b\u300d\u307e\u305f\u306f\u300c&lt;expression&gt; \u3067\u3042\u308b\u6587\u5b57\u5217\uff0c`+`\uff0c&lt;term&gt; \u3067\u3042\u308b\u6587\u5b57\u5217\uff0c\u3092\u3053\u306e\u9806\u306b\u9023\u7d50\u3055\u305b\u305f\u3082\u306e\u300d\u307e\u305f\u306f\u300c&lt;expression&gt; \u3067\u3042\u308b\u6587\u5b57\u5217\uff0c`-`\uff0c&lt;term&gt; \u3067\u3042\u308b\u6587\u5b57\u5217\uff0c\u3092\u3053\u306e\u9806\u306b\u9023\u7d50\u3055\u305b\u305f\u3082\u306e\u300d\u3067\u3042\u308b\u3053\u3068\u3067\u3042\u308b\uff0c\u3068\u3044\u3046\u3088\u3046\u306b\u518d\u5e30\u7684\u306b\u5b9a\u7fa9\u3055\u308c\u308b\u3053\u3068\u3092\u610f\u5473\u3059\u308b\uff0e\n\n&lt;expression&gt; \u3067\u3042\u308b\u6587\u5b57\u5217 $ E $ \u3068\u8a08\u7b97\u7d50\u679c $ A $ \u304c\u4e0e\u3048\u3089\u308c\u308b\u306e\u3067\uff0c`?` \u306b $ \\mathrm{R},\\ \\mathrm{S},\\ \\mathrm{P} $ \u306e\u3044\u305a\u308c\u304b\u3092\u5272\u308a\u5f53\u3066\u308b\u65b9\u6cd5\u3067\u3042\u3063\u3066\u5f0f\u306e\u8a08\u7b97\u7d50\u679c\u304c $ A $ \u306b\u306a\u308b\u3082\u306e\u306e\u500b\u6570\u3092 $ 1\\,000\\,000\\,007 $ \u3067\u5272\u3063\u305f\u4f59\u308a\u3092\u6c42\u3081\u308b\u30d7\u30ed\u30b0\u30e9\u30e0\u3092\u4f5c\u6210\u305b\u3088\uff0e",
    "inputFormat": "\u5165\u529b\u306f\u4ee5\u4e0b\u306e\u5f62\u5f0f\u3067\u6a19\u6e96\u5165\u529b\u304b\u3089\u4e0e\u3048\u3089\u308c\u308b\uff0e\n\n> $ N $ $ E $ $ A $",
    "outputFormat": "\u6a19\u6e96\u51fa\u529b\u306b\uff0c`?` \u306b $ \\mathrm{R},\\ \\mathrm{S},\\ \\mathrm{P} $ \u306e\u3044\u305a\u308c\u304b\u3092\u5272\u308a\u5f53\u3066\u308b\u65b9\u6cd5\u3067\u3042\u3063\u3066\u5f0f\u306e\u8a08\u7b97\u7d50\u679c\u304c $ A $ \u306b\u306a\u308b\u3082\u306e\u306e\u500b\u6570\u3092 $ 1\\,000\\,000\\,007 $ \u3067\u5272\u3063\u305f\u4f59\u308a\u3092 $ 1 $ \u884c\u3067\u51fa\u529b\u305b\u3088\uff0e",
    "samples": [
        [
            "11\r\nS+?-(R+?)*P\r\nS",
            "6"
        ],
        [
            "15\r\n?+?-?*?+?-?*?+?\r\nR",
            "2187"
        ],
        [
            "13\r\n(((((R)))))+?\r\nP",
            "1"
        ],
        [
            "1\r\nP\r\nS",
            "0"
        ],
        [
            "27\r\nR+((?+S-?*P+?)-P*?+S-?)*R+?\r\nP",
            "381"
        ],
        [
            "83\r\n((R+?)*(?+?))*((?+?)*(?+?))*((?+?)*(?+?))-((S+?)*(?+?))*((?+?)*(?+?))*((?+?)*(?+?))\r\nP",
            "460353133"
        ]
    ],
    "hint": "### \u5236\u7d04\n\n- $ 1\\ \\leqq\\ N\\ \\leqq\\ 200\\,000 $\uff0e\n- $ E $ \u306f\u9577\u3055 $ N $ \u306e\u6587\u5b57\u5217\u3067\u3042\u308b\uff0e\n- $ E $ \u306f\u554f\u984c\u6587\u3067\u5b9a\u3081\u3089\u308c\u305f &lt;expression&gt; \u3067\u3042\u308b\uff0e\n- $ A $ \u306f `R` \u307e\u305f\u306f `S` \u307e\u305f\u306f `P` \u3067\u3042\u308b\uff0e\n\n### \u5c0f\u8ab2\u984c\n\n1. ($ 20 $ \u70b9) $ N\\ \\leqq\\ 15 $\uff0e\n2. ($ 20 $ \u70b9) $ N\\ \\leqq\\ 200 $\uff0e\n3. ($ 60 $ \u70b9) \u8ffd\u52a0\u306e\u5236\u7d04\u306f\u306a\u3044\uff0e\n\n### Sample Explanation 1\n\n$ 2 $ \u7b87\u6240\u306e `?` \u306b $ \\mathrm{R},\\ \\mathrm{S},\\ \\mathrm{P} $ \u306e\u3044\u305a\u308c\u304b\u3092\u5272\u308a\u5f53\u3066\u3066\u8a08\u7b97\u7d50\u679c\u3092 $ \\mathrm{S} $ \u306b\u3059\u308b\u65b9\u6cd5\u306f\uff0c\u4ee5\u4e0b\u306e $ 6 $ \u901a\u308a\u304c\u3042\u308b\uff1a - $ \\mathrm{S}\\ +\\ \\mathrm{R}\\ -\\ (\\mathrm{R}\\ +\\ \\mathrm{R})\\ \\ast\\ \\mathrm{P} $ - $ \\mathrm{S}\\ +\\ \\mathrm{R}\\ -\\ (\\mathrm{R}\\ +\\ \\mathrm{S})\\ \\ast\\ \\mathrm{P} $ - $ \\mathrm{S}\\ +\\ \\mathrm{S}\\ -\\ (\\mathrm{R}\\ +\\ \\mathrm{R})\\ \\ast\\ \\mathrm{P} $ - $ \\mathrm{S}\\ +\\ \\mathrm{S}\\ -\\ (\\mathrm{R}\\ +\\ \\mathrm{S})\\ \\ast\\ \\mathrm{P} $ - $ \\mathrm{S}\\ +\\ \\mathrm{P}\\ -\\ (\\mathrm{R}\\ +\\ \\mathrm{R})\\ \\ast\\ \\mathrm{P} $ - $ \\mathrm{S}\\ +\\ \\mathrm{P}\\ -\\ (\\mathrm{R}\\ +\\ \\mathrm{S})\\ \\ast\\ \\mathrm{P} $\n\n### Sample Explanation 6\n\n\u6761\u4ef6\u3092\u6e80\u305f\u3059\u5272\u308a\u5f53\u3066\u65b9\u306f $ 10\\,460\\,353\\,203 $ \u901a\u308a\u3042\u308b\u305f\u3081\uff0c\u305d\u308c\u3092 $ 1\\,000\\,000\\,007 $ \u3067\u5272\u3063\u305f\u4f59\u308a\u3067\u3042\u308b $ 460\\,353\\,133 $ \u3092\u51fa\u529b\u3059\u308b\uff0e"
}
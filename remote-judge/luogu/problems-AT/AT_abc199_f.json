{
    "description": "[problemUrl]: https://atcoder.jp/contests/abc199/tasks/abc199_f\n\n$ N $ \u9802\u70b9 $ M $ \u8fba\u306e\u5358\u7d14\u7121\u5411\u30b0\u30e9\u30d5\u304c\u3042\u308a\u307e\u3059\u3002\u9802\u70b9\u306b\u306f $ 1 $ \u304b\u3089 $ N $ \u307e\u3067\u306e\u3001\u8fba\u306b\u306f $ 1 $ \u304b\u3089 $ M $ \u307e\u3067\u306e\u756a\u53f7\u304c\u3064\u3044\u3066\u3044\u307e\u3059\u3002  \n \u8fba $ i $ \u306f\u9802\u70b9 $ X_i $ \u3068\u9802\u70b9 $ Y_i $ \u3092\u7d50\u3093\u3067\u3044\u307e\u3059\u3002\u307e\u305f\u3001\u9802\u70b9 $ i $ \u306b\u306f\u6700\u521d\u6574\u6570 $ A_i $ \u304c\u66f8\u304b\u308c\u3066\u3044\u307e\u3059\u3002  \n \u3042\u306a\u305f\u306f $ K $ \u56de\u306b\u308f\u305f\u3063\u3066\u4ee5\u4e0b\u306e\u64cd\u4f5c\u3092\u884c\u3044\u307e\u3059\u3002\n\n- $ M $ \u672c\u3042\u308b\u8fba\u306e\u4e2d\u304b\u3089\u3001\u4e00\u69d8\u30e9\u30f3\u30c0\u30e0\u304b\u3064\u4ed6\u306e\u9078\u629e\u3068\u72ec\u7acb\u306b $ 1 $ \u672c\u9078\u3076\u3002\u305d\u306e\u8fba\u304c\u7d50\u3076 $ 2 $ \u9802\u70b9\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u6570\u306e\u5e73\u5747\u3092 $ x $ \u3068\u3057\u3066\u3001\u305d\u306e $ 2 $ \u9802\u70b9\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u6570\u3092\u4e21\u65b9 $ x $ \u3067\u7f6e\u304d\u63db\u3048\u308b\u3002\n\n\u5404\u9802\u70b9 $ i $ \u306b\u3064\u3044\u3066\u3001$ K $ \u56de\u306e\u64cd\u4f5c\u5f8c\u306b\u9802\u70b9 $ i $ \u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u6570\u306e\u671f\u5f85\u5024\u3092\u6c42\u3081\u3001\u6ce8\u8a18\u306e\u901a\u308a $ \\bmod\\ (10^9\\ +\\ 7) $ \u3067\u51fa\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002",
    "inputFormat": "\u5165\u529b\u306f\u4ee5\u4e0b\u306e\u5f62\u5f0f\u3067\u6a19\u6e96\u5165\u529b\u304b\u3089\u4e0e\u3048\u3089\u308c\u308b\u3002\n\n> $ N $ $ M $ $ K $ $ A_1 $ $ A_2 $ $ A_3 $ $ \\dots $ $ A_N $ $ X_1 $ $ Y_1 $ $ X_2 $ $ Y_2 $ $ X_3 $ $ Y_3 $ $ \\hspace{15pt}\\ \\vdots $ $ X_M $ $ Y_M $",
    "outputFormat": "$ N $ \u884c\u306b\u308f\u305f\u3063\u3066\u51fa\u529b\u305b\u3088\u3002  \n $ i $ \u884c\u76ee\u306b\u306f\u3001$ K $ \u56de\u306e\u64cd\u4f5c\u5f8c\u306b\u9802\u70b9 $ i $ \u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u6570\u306e\u671f\u5f85\u5024\u3092\u3001\u6ce8\u8a18\u306b\u5f93\u3063\u3066 $ \\bmod\\ (10^9\\ +\\ 7) $ \u3067\u51fa\u529b\u305b\u3088\u3002",
    "samples": [
        [
            "3 2 1\r\n3 1 5\r\n1 2\r\n1 3",
            "3\r\n500000005\r\n500000008"
        ],
        [
            "3 2 2\r\n12 48 36\r\n1 2\r\n1 3",
            "750000036\r\n36\r\n250000031"
        ],
        [
            "4 5 1000\r\n578 173 489 910\r\n1 2\r\n2 3\r\n3 4\r\n4 1\r\n1 3",
            "201113830\r\n45921509\r\n67803140\r\n685163678"
        ]
    ],
    "hint": "### \u6ce8\u8a18\n\n\u6709\u7406\u6570\u3092\u51fa\u529b\u3059\u308b\u969b\u306f\u3001\u307e\u305a\u305d\u306e\u6709\u7406\u6570\u3092\u5206\u6570 $ \\frac{y}{x} $ \u3068\u3057\u3066\u8868\u3057\u3066\u304f\u3060\u3055\u3044\u3002  \n \u3053\u3053\u3067\u3001$ x,y $ \u306f\u6574\u6570\u3067\u3042\u308a\u3001$ x $ \u306f $ 10^9+7 $ \u3067\u5272\u308a\u5207\u308c\u3066\u306f\u306a\u308a\u307e\u305b\u3093 (\u3053\u306e\u554f\u984c\u306e\u5236\u7d04\u4e0b\u3067\u3001\u305d\u306e\u3088\u3046\u306a\u8868\u73fe\u306f\u5fc5\u305a\u53ef\u80fd\u3067\u3059)\u3002  \n \u305d\u3057\u3066\u3001$ xz\\ \\equiv\\ y\\ \\pmod\\ {10^9+7} $ \u3092\u6e80\u305f\u3059\u3088\u3046\u306a $ 0 $ \u4ee5\u4e0a $ 10^9+6 $ \u4ee5\u4e0b\u306e\u552f\u4e00\u306e\u6574\u6570 $ z $ \u3092\u51fa\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002\n\n### \u5236\u7d04\n\n- $ 2\\ \\le\\ N\\ \\le\\ 100 $\n- $ 1\\ \\le\\ M\\ \\le\\ \\frac{N(N\\ -\\ 1)}{2} $\n- $ 0\\ \\le\\ K\\ \\le\\ 10^9 $\n- $ 0\\ \\le\\ A_i\\ \\le\\ 10^9 $\n- $ 1\\ \\le\\ X_i\\ \\le\\ N $\n- $ 1\\ \\le\\ Y_i\\ \\le\\ N $\n- \u4e0e\u3048\u3089\u308c\u308b\u30b0\u30e9\u30d5\u306f\u5358\u7d14\n- \u5165\u529b\u306b\u542b\u307e\u308c\u308b\u5024\u306f\u5168\u3066\u6574\u6570\u3067\u3042\u308b\n\n### Sample Explanation 1\n\n\\- \u552f\u4e00\u306e\u64cd\u4f5c\u3067\u8fba $ 1 $ \u304c\u9078\u3070\u308c\u305f\u5834\u5408 : \u9802\u70b9 $ 1,\\ 2,\\ 3 $ \u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u6570\u306f\u305d\u308c\u305e\u308c $ 2,\\ 2,\\ 5 $ \u3068\u306a\u308a\u307e\u3059 - \u552f\u4e00\u306e\u64cd\u4f5c\u3067\u8fba $ 2 $ \u304c\u9078\u3070\u308c\u305f\u5834\u5408 : \u9802\u70b9 $ 1,\\ 2,\\ 3 $ \u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u6570\u306f\u305d\u308c\u305e\u308c $ 4,\\ 1,\\ 4 $ \u3068\u306a\u308a\u307e\u3059 \u5f93\u3063\u3066\u3001\u64cd\u4f5c\u5f8c\u306b\u9802\u70b9 $ 1,\\ 2,\\ 3 $ \u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u6570\u306e\u671f\u5f85\u5024\u306f\u305d\u308c\u305e\u308c $ 3,\\ \\frac{3}{2},\\ \\frac{9}{2} $ \u3068\u306a\u308a\u307e\u3059\u3002 \u3053\u308c\u3089\u3092\u6ce8\u8a18\u306b\u5f93\u3063\u3066 $ \\bmod\\ (10^9\\ +\\ 7) $ \u306e\u8868\u73fe\u306b\u5909\u63db\u3059\u308b\u3068\u3001\u305d\u308c\u305e\u308c $ 3,\\ 500000005,\\ 500000008 $ \u3068\u306a\u308a\u307e\u3059\u3002\n\n### Sample Explanation 2\n\n\\- $ 1 $ \u56de\u76ee\u306e\u64cd\u4f5c\u3067\u8fba $ 1 $ \u304c\u9078\u3070\u308c\u305f\u5834\u5408 \u9802\u70b9 $ 1,\\ 2,\\ 3 $ \u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u6570\u306f\u305d\u308c\u305e\u308c $ 30,\\ 30,\\ 36 $ \u3068\u306a\u308a\u307e\u3059 - $ 2 $ \u56de\u76ee\u306e\u64cd\u4f5c\u3067\u8fba $ 1 $ \u304c\u9078\u3070\u308c\u305f\u5834\u5408 : \u9802\u70b9 $ 1,\\ 2,\\ 3 $ \u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u6570\u306f\u305d\u308c\u305e\u308c $ 30,\\ 30,\\ 36 $ \u3068\u306a\u308a\u307e\u3059 - $ 2 $ \u56de\u76ee\u306e\u64cd\u4f5c\u3067\u8fba $ 2 $ \u304c\u9078\u3070\u308c\u305f\u5834\u5408 : \u9802\u70b9 $ 1,\\ 2,\\ 3 $ \u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u6570\u306f\u305d\u308c\u305e\u308c $ 33,\\ 30,\\ 33 $ \u3068\u306a\u308a\u307e\u3059 - $ 1 $ \u56de\u76ee\u306e\u64cd\u4f5c\u3067\u8fba $ 2 $ \u304c\u9078\u3070\u308c\u305f\u5834\u5408 \u9802\u70b9 $ 1,\\ 2,\\ 3 $ \u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u6570\u306f\u305d\u308c\u305e\u308c $ 24,\\ 48,\\ 24 $ \u3068\u306a\u308a\u307e\u3059 - $ 2 $ \u56de\u76ee\u306e\u64cd\u4f5c\u3067\u8fba $ 1 $ \u304c\u9078\u3070\u308c\u305f\u5834\u5408 : \u9802\u70b9 $ 1,\\ 2,\\ 3 $ \u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u6570\u306f\u305d\u308c\u305e\u308c $ 36,\\ 36,\\ 24 $ \u3068\u306a\u308a\u307e\u3059 - $ 2 $ \u56de\u76ee\u306e\u64cd\u4f5c\u3067\u8fba $ 2 $ \u304c\u9078\u3070\u308c\u305f\u5834\u5408 : \u9802\u70b9 $ 1,\\ 2,\\ 3 $ \u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u6570\u306f\u305d\u308c\u305e\u308c $ 24,\\ 48,\\ 24 $ \u3068\u306a\u308a\u307e\u3059 \u3053\u308c\u3089 $ 4 $ \u901a\u308a\u306e\u30b1\u30fc\u30b9\u304c\u5404 $ \\frac{1}{4} $ \u306e\u78ba\u7387\u3067\u8d77\u3053\u308b\u306e\u3067\u3001\u9802\u70b9 $ 1,\\ 2,\\ 3 $ \u306b\u6700\u7d42\u7684\u306b\u66f8\u304b\u308c\u3066\u3044\u308b\u6570\u306e\u671f\u5f85\u5024\u306f\u305d\u308c\u305e\u308c $ \\frac{123}{4},\\ \\frac{144}{4}\\ (=36),\\ \\frac{117}{4} $ \u3068\u306a\u308a\u307e\u3059\u3002",
    "translation": "\u7ed9\u5b9a\u4e00\u5f20 $n$ \u4e2a\u70b9 $m$ \u6761\u8fb9\u7684\u65e0\u5411\u56fe\uff0c\u8282\u70b9\u4ece $1\\sim n$ \u7f16\u53f7\uff0c\u6bcf\u4e2a\u8282\u70b9 $i$ \u90fd\u6709\u70b9\u6743 $a_i$\u3002\u63a5\u4e0b\u6765\u8981\u8fdb\u884c\u5982\u4e0b\u64cd\u4f5c\uff1a\n\n+ \u4ece $m$ \u6761\u8fb9\u4e2d\u7b49\u6982\u7387\u5730\u9009\u62e9\u4e00\u6761\uff0c\u5c06\u5176\u4e24\u4e2a\u7aef\u70b9 $u,v$ \u7684\u70b9\u6743 $a_u,a_v$ \u4fee\u6539\u4e3a\u4ed6\u4eec\u7684\u7b97\u672f\u5e73\u5747\u503c $\\dfrac{a_u+a_v}2$\u3002\n\n\u6c42 $k$ \u6b21\u64cd\u4f5c\u540e\u6bcf\u4e2a\u70b9\u70b9\u6743\u7684\u671f\u671b\u3002\n\n\u2014\u2014 by Register_int"
}
{
    "description": "[problemUrl]: https://atcoder.jp/contests/pakencamp-2019-day4/tasks/pakencamp_2019_day4_e\n\n\u6642\u306f 20XX \u5e74\uff0eIOI (International Olympiad in Iconoclasm) \u306f\u3044\u307e\u3084\u8ab0\u3082\u304c\u77e5\u308b\u6709\u540d\u306a\u5927\u4f1a\u3068\u306a\u308a\uff0c\u6bce\u5e74\u306e\u590f\u3068\u51ac\u306b\u958b\u50ac\u3055\u308c\u3066\u3044\u307e\u3059\uff0e\n\n20XX \u5e74\u306e IOI \u306f Kclc \u738b\u56fd\u3067\u958b\u304b\u308c\u307e\u3059\uff0eIOI \u738b\u56fd\u59d4\u54e1\u4f1a\u306e\u7ba1\u7406\u4eba\u3092\u52d9\u3081\u308b\u30b9\u30af\u30a8\u30a2\u306f\uff0c\u30a8\u30af\u30b9\u30ab\u30fc\u30b8\u30e7\u30f3\u306e\u9053\u306e\u308a\u3092\u8003\u3048\u308b\u3053\u3068\u306b\u3057\u307e\u3057\u305f\uff0e\n\nIOI \u3067\u4f7f\u7528\u3067\u304d\u308b Kclc \u738b\u56fd\u306e\u571f\u5730\u306f $ N $ \u500b\u3042\u308a\uff0c\u3053\u306e\u9593\u306b\u306f $ M $ \u672c\u306e\u9053\u8def\u304c\u901a\u3063\u3066\u3044\u307e\u3059\uff0e\u571f\u5730\u306b\u306f $ 1 $ \u304b\u3089 $ N $ \u306e\uff0c\u9053\u8def\u306b\u306f $ 1 $ \u304b\u3089 $ M $ \u306e\u756a\u53f7\u304c\u3064\u3051\u3089\u308c\u3066\u3044\u307e\u3059\uff0e\u3069\u306e $ 2 $ \u571f\u5730\u306e\u9593\u3082\uff0c\u9053\u8def\u3092\u3044\u304f\u3064\u304b\u901a\u3063\u3066\u884c\u304d\u6765\u3067\u304d\u307e\u3059\uff0e\n\n\u9053\u8def $ i $ \u306f\u571f\u5730 $ A_i $ \u3068 \u571f\u5730 $ B_i $ \u3092\u53cc\u65b9\u5411\u306b\u3064\u306a\u3044\u3067\u304a\u308a\uff0c\u901a\u884c\u306b\u304b\u304b\u308b\u6642\u9593\u306f\u590f\u306e\u3068\u304d $ S_i $\uff0c\u51ac\u306e\u3068\u304d $ W_i $ \u3067\u3059\uff0e\n\n\u571f\u5730 $ 1 $ \u304b\u3089\u51fa\u767a\u3057\u571f\u5730 $ N $ \u306b\u5230\u7740\u3059\u308b\u9053\u306e\u308a\u3092 *\u9060\u8db3\u30eb\u30fc\u30c8* \u3068\u547c\u3076\u3053\u3068\u306b\u3057\u307e\u3059\uff0e\n\n\u590f\u304b\u51ac\u306e\u5c11\u306a\u304f\u3068\u3082\u7247\u65b9\u306e\u5b63\u7bc0\u306b\u6b21\u306e\u6761\u4ef6\u3092\u6e80\u305f\u3059\u3088\u3046\u306a\u9060\u8db3\u30eb\u30fc\u30c8\u306f\u4f55\u901a\u308a\u3042\u308b\u3067\u3057\u3087\u3046\u304b\uff0e\n\n- \u901a\u884c\u306b\u304b\u304b\u308b\u7dcf\u6642\u9593\u304c\u3088\u308a\u77ed\u3044\u3088\u3046\u306a\u9060\u8db3\u30eb\u30fc\u30c8\u304c\u5b58\u5728\u3057\u306a\u3044\uff0e\n\n\u7b54\u3048\u306f\u975e\u5e38\u306b\u5927\u304d\u304f\u306a\u308b\u3053\u3068\u304c\u3042\u308b\u306e\u3067\uff0c$ 10^9+7 $ \u3067\u5272\u3063\u305f\u3042\u307e\u308a\u3092\u51fa\u529b\u3057\u3066\u304f\u3060\u3055\u3044\uff0e",
    "inputFormat": "\u5165\u529b\u306f\u4ee5\u4e0b\u306e\u5f62\u5f0f\u3067\u6a19\u6e96\u5165\u529b\u304b\u3089\u4e0e\u3048\u3089\u308c\u307e\u3059\uff0e\n\n> $ N $ $ M $ $ A_1 $ $ B_1 $ $ S_1 $ $ W_1 $ : $ A_M $ $ B_M $ $ S_M $ $ W_M $",
    "outputFormat": "\u590f\u304b\u51ac\u306e\u5c11\u306a\u304f\u3068\u3082\u7247\u65b9\u306e\u5b63\u7bc0\u306b\u6761\u4ef6\u3092\u6e80\u305f\u3059\u3088\u3046\u306a\u9060\u8db3\u30eb\u30fc\u30c8\u306e\u500b\u6570\u3092 $ 10^9+7 $ \u3067\u5272\u3063\u305f\u3042\u307e\u308a\u3092\u51fa\u529b\u3057\u3066\u304f\u3060\u3055\u3044\uff0e",
    "samples": [
        [
            "4 8\r\n1 2 3 2\r\n1 3 2 1\r\n1 3 3 1\r\n2 2 1 1\r\n2 3 1 1\r\n2 3 2 1\r\n2 4 1 2\r\n3 4 2 4",
            "6"
        ],
        [
            "4 5\r\n1 2 3 6\r\n2 3 1 2\r\n3 4 2 5\r\n1 3 5 3\r\n2 4 4 2",
            "2"
        ],
        [
            "20 77\r\n9 16 65551022 36847141\r\n4 8 169905126 234841269\r\n8 18 61782163 101070315\r\n8 9 763292109 656192270\r\n1 18 76893781 240632078\r\n3 19 601597138 476288881\r\n5 19 595403102 581080612\r\n3 6 980642190 183697163\r\n6 9 663706146 95151932\r\n11 18 679581087 523262198\r\n12 16 293035618 152800086\r\n3 7 814717585 273291118\r\n1 2 853500661 870996856\r\n2 3 526446904 394372085\r\n2 9 75096934 115522990\r\n4 9 599545324 421351001\r\n1 13 282807719 968765138\r\n6 15 458441410 364130005\r\n1 4 178858403 334122865\r\n4 4 242708006 509603317\r\n8 13 368467895 338762793\r\n13 17 697663167 640858525\r\n11 20 238453071 271106570\r\n2 17 126970225 114980011\r\n14 18 279244522 277866206\r\n11 20 238453071 271106570\r\n5 20 714162258 622887639\r\n4 12 694170286 610998228\r\n9 16 65551022 36847141\r\n15 15 341887831 393369008\r\n3 8 311942139 377343175\r\n1 8 15111618 99281596\r\n2 4 674642258 536873991\r\n2 16 9545912 78675849\r\n1 8 15111618 99281596\r\n12 20 121899250 49599586\r\n14 20 638789636 516502562\r\n5 17 699705205 614143827\r\n7 13 480049964 311871500\r\n9 14 422265424 394103067\r\n7 10 230695689 160298785\r\n2 20 141427278 488804437\r\n9 16 65551022 36847141\r\n2 4 746378429 794786225\r\n1 13 684196511 438044389\r\n9 19 97765056 384638724\r\n8 14 599920464 622509237\r\n16 20 446862361 693104823\r\n2 20 141427278 250722614\r\n17 18 964998636 785624956\r\n11 20 238453071 271106570\r\n1 3 327053757 476624771\r\n1 5 327955959 908911545\r\n3 11 429421111 769824924\r\n7 19 113311100 202997763\r\n13 18 205913938 237692478\r\n1 17 980470886 985976867\r\n3 12 545974932 468496322\r\n6 19 312631863 292591718\r\n11 15 651379358 427422180\r\n3 8 311942139 377343175\r\n8 17 965359268 886695271\r\n3 20 667874182 518095908\r\n12 17 107442197 40855774\r\n2 10 321338667 306331990\r\n4 13 103949316 103921524\r\n9 10 246241733 165856762\r\n7 14 406719380 271697772\r\n7 8 747746065 755010172\r\n1 9 778403727 755473866\r\n8 17 965359268 886695271\r\n5 11 475709187 351781069\r\n8 11 751809642 869885243\r\n5 19 595403102 581080612\r\n19 20 118759156 41807027\r\n3 19 646592547 476288881\r\n3 12 850613737 468496322",
            "190"
        ]
    ],
    "hint": "### \u5236\u7d04\n\n- \u5165\u529b\u306f\u3059\u3079\u3066\u6574\u6570\n- $ 2\\ \\leq\\ N\\ \\leq\\ 2\\ \\times\\ 10^5 $\n- $ 1\\ \\leq\\ M\\ \\leq\\ 2\\ \\times\\ 10^5 $\n- $ 1\\ \\leq\\ A_i,\\ B_i\\ \\leq\\ N\\ (1\\ \\leq\\ i\\ \\leq\\ M) $\n- \u3069\u306e $ 2 $ \u571f\u5730\u306e\u9593\u3082\uff0c\u9053\u8def\u3092\u3044\u304f\u3064\u304b\u901a\u3063\u3066\u884c\u304d\u6765\u3067\u304d\u308b\n- $ 1\\ \\leq\\ S_i,\\ W_i\\ \\leq\\ 10^9\\ (1\\ \\leq\\ i\\ \\leq\\ M) $\n\n### \u90e8\u5206\u70b9\n\n\u3053\u306e\u554f\u984c\u306f\u3044\u304f\u3064\u304b\u306e\u5c0f\u8ab2\u984c\u306b\u5206\u3051\u3089\u308c\uff0c\u305d\u306e\u5c0f\u8ab2\u984c\u306e\u3059\u3079\u3066\u306e\u30c6\u30b9\u30c8\u30b1\u30fc\u30b9\u306b\u6b63\u89e3\u3057\u305f\u5834\u5408\u306b\u300c\u3053\u306e\u5c0f\u8ab2\u984c\u306b\u6b63\u89e3\u3057\u305f\u300d\u3068\u307f\u306a\u3055\u308c\u307e\u3059\uff0e\n\n\u63d0\u51fa\u3057\u305f\u30bd\u30fc\u30b9\u30b3\u30fc\u30c9\u306e\u5f97\u70b9\u306f\uff0c\u6b63\u89e3\u3057\u305f\u5c0f\u8ab2\u984c\u306e\u70b9\u6570\u306e\u5408\u8a08\u3068\u306a\u308a\u307e\u3059\uff0e\n\n1. (5 \u70b9) $ M=N-1 $ \u3092\u6e80\u305f\u3059\uff0e\n2. (15 \u70b9) $ N\\ \\leq\\ 10 $ \u3092\u6e80\u305f\u3059\uff0e\n3. (20 \u70b9) \u4efb\u610f\u306e $ 1\\ \\leq\\ i\\ \\leq\\ M $ \u306b\u3064\u3044\u3066\uff0c$ S_i\\ =\\ W_i $ \u3092\u6e80\u305f\u3059\uff0e\n4. (35 \u70b9) $ N\\ \\leq\\ 1000 $ \u3092\u6e80\u305f\u3059\uff0e\n5. (25 \u70b9) \u8ffd\u52a0\u306e\u5236\u7d04\u306f\u306a\u3044\uff0e\n\n### Sample Explanation 1\n\n\u6761\u4ef6\u3092\u6e80\u305f\u3059\u9060\u8db3\u30eb\u30fc\u30c8\u306f\u4ee5\u4e0b\u306e $ 6 $ \u3064\u3067\u3059\uff0e - \u9053\u8def $ 1,\\ 7 $ \u306e\u9806\u306b\u901a\u308b\uff0e\u590f\u3068\u51ac\u306e\u4e21\u65b9\u3067\u6761\u4ef6\u3092\u6e80\u305f\u3059\uff0e - \u9053\u8def $ 2,\\ 5,\\ 7 $ \u306e\u9806\u306b\u901a\u308b\uff0e\u590f\u3068\u51ac\u306e\u4e21\u65b9\u3067\u6761\u4ef6\u3092\u6e80\u305f\u3059\uff0e - \u9053\u8def $ 2,\\ 6,\\ 7 $ \u306e\u9806\u306b\u901a\u308b\uff0e\u51ac\u306e\u3068\u304d\u306e\u307f\u6761\u4ef6\u3092\u6e80\u305f\u3059\uff0e - \u9053\u8def $ 3,\\ 5,\\ 7 $ \u306e\u9806\u306b\u901a\u308b\uff0e\u51ac\u306e\u3068\u304d\u306e\u307f\u6761\u4ef6\u3092\u6e80\u305f\u3059\uff0e - \u9053\u8def $ 3,\\ 6,\\ 7 $ \u306e\u9806\u306b\u901a\u308b\uff0e\u51ac\u306e\u3068\u304d\u306e\u307f\u6761\u4ef6\u3092\u6e80\u305f\u3059\uff0e - \u9053\u8def $ 2,\\ 8 $ \u306e\u9806\u306b\u901a\u308b\uff0e\u590f\u306e\u3068\u304d\u306e\u307f\u6761\u4ef6\u3092\u6e80\u305f\u3059\uff0e"
}
{
    "description": "[problemUrl]: https://atcoder.jp/contests/exawizards2019/tasks/exawizards2019_f\n\nAtCoder \u5171\u548c\u56fd\u306e\u9996\u90fd\u30bf\u30ab\u30cf\u5e02\u306b\u306f\uff0c\u6771\u897f\u306b\u4f38\u3073\u308b\u9053\u8def\u304c $ N $ \u672c\uff0c\u5357\u5317\u306b\u4f38\u3073\u308b\u9053\u8def\u304c $ M $ \u672c\u3042\u308a\uff0c\u3053\u308c\u4ee5\u5916\u306e\u9053\u8def\u306f\u3042\u308a\u307e\u305b\u3093\uff0e \u5317\u304b\u3089 $ i $ \u672c\u76ee\u306e\u6771\u897f\u65b9\u5411\u306e\u9053\u8def\u3068\uff0c\u897f\u304b\u3089 $ j $ \u672c\u76ee\u306e\u5357\u5317\u65b9\u5411\u306e\u9053\u8def\u306f\uff0c\u4ea4\u5dee\u70b9 $ (i,\\ j) $ \u3067\u4ea4\u308f\u3063\u3066\u3044\u307e\u3059\uff0e \u6771\u897f\u65b9\u5411\u306e\u9053\u8def\u540c\u58eb\uff0c\u5357\u5317\u65b9\u5411\u306e\u9053\u8def\u540c\u58eb\u304c\u4ea4\u308f\u308b\u3053\u3068\u306f\u3042\u308a\u307e\u305b\u3093\uff0e \u307e\u305f\uff0c\u540c\u3058\u65b9\u5411\u306e\u96a3\u308a\u5408\u3046\u9053\u8def\u306e\u9593\u306f\u8ddd\u96e2 $ 1 $ \u305a\u3064\u96e2\u308c\u3066\u3044\u307e\u3059\uff0e\n\n\u305d\u308c\u305e\u308c\u306e\u9053\u8def\u306f\u4e00\u65b9\u901a\u884c\u3067\uff0c\u7247\u65b9\u306e\u5411\u304d\u306b\u306e\u307f\u901a\u884c\u53ef\u80fd\u3067\u3059\uff0e\u5404\u9053\u8def\u306e\u901a\u884c\u53ef\u80fd\u306a\u65b9\u5411\u306f\uff0c\u9577\u3055 $ N $ \u306e\u6587\u5b57\u5217 $ S $\uff0c\u9577\u3055 $ M $ \u306e\u6587\u5b57\u5217 $ T $ \u3092\u7528\u3044\u3066\uff0c\u6b21\u306e\u3088\u3046\u306b\u306a\u3063\u3066\u3044\u307e\u3059\uff1a\n\n- $ S $ \u306e $ i $ \u6587\u5b57\u76ee\u304c `W` \u306e\u3068\u304d\uff0c\u5317\u304b\u3089 $ i $ \u672c\u76ee\u306e\u6771\u897f\u65b9\u5411\u306e\u9053\u8def\u306f\uff0c\u897f\u5411\u304d\u306b\u306e\u307f\u901a\u884c\u53ef\u80fd\uff0e\n- $ S $ \u306e $ i $ \u6587\u5b57\u76ee\u304c `E` \u306e\u3068\u304d\uff0c\u5317\u304b\u3089 $ i $ \u672c\u76ee\u306e\u6771\u897f\u65b9\u5411\u306e\u9053\u8def\u306f\uff0c\u6771\u5411\u304d\u306b\u306e\u307f\u901a\u884c\u53ef\u80fd\uff0e\n- $ T $ \u306e $ j $ \u6587\u5b57\u76ee\u304c `N` \u306e\u3068\u304d\uff0c\u897f\u304b\u3089 $ j $ \u672c\u76ee\u306e\u5357\u5317\u65b9\u5411\u306e\u9053\u8def\u306f\uff0c\u5317\u5411\u304d\u306b\u306e\u307f\u901a\u884c\u53ef\u80fd\uff0e\n- $ T $ \u306e $ j $ \u6587\u5b57\u76ee\u304c `S` \u306e\u3068\u304d\uff0c\u897f\u304b\u3089 $ j $ \u672c\u76ee\u306e\u5357\u5317\u65b9\u5411\u306e\u9053\u8def\u306f\uff0c\u5357\u5411\u304d\u306b\u306e\u307f\u901a\u884c\u53ef\u80fd\uff0e\n\n\u6b21\u306e\u3088\u3046\u306a\u5f62\u5f0f\u306e $ Q $ \u500b\u306e\u8cea\u554f\u306b\u7b54\u3048\u3066\u304f\u3060\u3055\u3044\uff0e\n\n- $ i $ \u756a\u76ee\u306e\u8cea\u554f\u3067\u306f\uff0c$ a_i,\\ b_i,\\ c_i,\\ d_i $ \u304c\u4e0e\u3048\u3089\u308c\u308b\uff0e\u3053\u306e\u3068\u304d\uff0c\u4ea4\u5dee\u70b9 $ (a_i,\\ b_i) $ \u304b\u3089 $ (c_i,\\ d_i) $ \u307e\u3067\uff0c\u9053\u8def\u306e\u307f\u3092\u901a\u884c\u3057\u3066\u79fb\u52d5\u3059\u308b\u3068\u304d\u306e\uff0c\u6700\u5c0f\u306e\u79fb\u52d5\u8ddd\u96e2\u306f\u3044\u304f\u3089\u304b\uff1f",
    "inputFormat": "\u5165\u529b\u306f\u4ee5\u4e0b\u306e\u5f62\u5f0f\u3067\u6a19\u6e96\u5165\u529b\u304b\u3089\u4e0e\u3048\u3089\u308c\u308b\uff0e\n\n> $ N $ $ M $ $ Q $ $ S $ $ T $ $ a_1 $ $ b_1 $ $ c_1 $ $ d_1 $ $ a_2 $ $ b_2 $ $ c_2 $ $ d_2 $ $ : $ $ a_Q $ $ b_Q $ $ c_Q $ $ d_Q $",
    "outputFormat": "$ i $ \u884c\u76ee\u306b\u306f\uff0c$ i $ \u756a\u76ee\u306e\u8cea\u554f\u306b\u5bfe\u3059\u308b\u7b54\u3048\u3092\u51fa\u529b\u305b\u3088\uff0e\u305f\u3060\u3057\uff0c\u4ea4\u5dee\u70b9 $ (a_i,\\ b_i) $ \u304b\u3089 $ (c_i,\\ d_i) $ \u307e\u3067\uff0c\u9053\u8def\u306e\u307f\u3092\u901a\u884c\u3057\u3066\u79fb\u52d5\u3059\u308b\u3053\u3068\u304c\u4e0d\u53ef\u80fd\u306a\u3068\u304d\u306f\uff0c\u4ee3\u308f\u308a\u306b `-1` \u3092\u51fa\u529b\u305b\u3088\uff0e",
    "samples": [
        [
            "4 5 4\r\nEEWW\r\nNSNNS\r\n4 1 1 4\r\n1 3 1 2\r\n4 2 3 2\r\n3 3 3 5",
            "6\r\n11\r\n5\r\n4"
        ],
        [
            "3 3 2\r\nEEE\r\nSSS\r\n1 1 3 3\r\n3 3 1 1",
            "4\r\n-1"
        ],
        [
            "9 7 10\r\nEEEEEWEWW\r\nNSSSNSN\r\n4 6 9 2\r\n3 7 6 7\r\n7 5 3 5\r\n1 1 8 1\r\n4 3 5 4\r\n7 4 6 4\r\n2 5 8 6\r\n6 6 2 7\r\n2 4 7 5\r\n7 2 9 7",
            "9\r\n-1\r\n4\r\n9\r\n2\r\n3\r\n7\r\n7\r\n6\r\n-1"
        ]
    ],
    "hint": "### \u5236\u7d04\n\n- $ 2\\ \\leq\\ N\\ \\leq\\ 100000 $\n- $ 2\\ \\leq\\ M\\ \\leq\\ 100000 $\n- $ 2\\ \\leq\\ Q\\ \\leq\\ 200000 $\n- $ |S|\\ =\\ N $\n- $ S $ \u306f `W`, `E` \u306e\u307f\u304b\u3089\u306a\u308b\n- $ |T|\\ =\\ M $\n- $ T $ \u306f `N`, `S` \u306e\u307f\u304b\u3089\u306a\u308b\n- $ 1\\ \\leq\\ a_i\\ \\leq\\ N $\n- $ 1\\ \\leq\\ b_i\\ \\leq\\ M $\n- $ 1\\ \\leq\\ c_i\\ \\leq\\ N $\n- $ 1\\ \\leq\\ d_i\\ \\leq\\ M $\n- $ (a_i,\\ b_i)\\ \\neq\\ (c_i,\\ d_i) $\n\n### Sample Explanation 1\n\n\u5404\u9053\u8def\u306e\u901a\u884c\u53ef\u80fd\u306a\u65b9\u5411\u306f\u4e0b\u56f3\u306e\u901a\u308a\u3067\u3059\uff08\u4e0a\u5411\u304d\u3092\u5317\u3068\u3057\u307e\u3059\uff09\uff1a !\\[\\](https://img.atcoder.jp/exawizards2019/bfb8c54cc4098353946320d8c263807e.png) $ 4 $ \u500b\u306e\u8cea\u554f\u305d\u308c\u305e\u308c\u306b\u3064\u3044\u3066\uff0c\u6700\u5c0f\u306e\u79fb\u52d5\u8ddd\u96e2\u3092\u9054\u6210\u3059\u308b\u7d4c\u8def\u306e\u4f8b\u306f\u6b21\u306e\u901a\u308a\u3067\u3059\uff1a !\\[\\](https://img.atcoder.jp/exawizards2019/d1918596004a23a20aa138e591e0ee99.png)\n\n### Sample Explanation 2\n\n\u79fb\u52d5\u304c\u4e0d\u53ef\u80fd\u306a\u5834\u5408\u3082\u3042\u308a\u307e\u3059\uff0e",
    "translation": "\u5927\u610f:\n\n\u5728\u4e00\u4e2a\u57ce\u5e02\u91cc\uff0c\u6709$N$\u6761\u4e1c\u897f\u5ef6\u4f38\u7684\u9053\u8def\uff0c$M$\u6761\u5357\u5317\u5ef6\u4f38\u7684\u9053\u8def\u3002\u6ca1\u6709\u5176\u4ed6\u9053\u8def\u3002\u5317\u5411\u7b2c$i$\u6761\u4e1c\u897f\u5411\u9053\u8def\u548c\u5411\u897f\u5411\u5f80\u7b2c$j$\u6761\u5357\u5317\u5411\u9053\u8def\u5728\u4ea4\u53c9\u70b9(i,j)\u5904\u4ea4\u53c9\u3002\u4e1c\u897f\u4e24\u8def\u4e0d\u4ea4\u53c9\uff0c\u5357\u5317\u4e24\u8def\u4e5f\u4e0d\u4ea4\u53c9\u3002\u540c\u4e00\u65b9\u5411\u7684\u4e24\u6761\u76f8\u90bb\u9053\u8def\u4e4b\u95f4\u7684\u8ddd\u79bb\u4e3a$1$\u3002\n\n\u6bcf\u6761\u8def\u90fd\u662f\u5355\u5411\u7684\uff1b\u4e00\u4e2a\u4eba\u53ea\u80fd\u671d\u4e00\u4e2a\u65b9\u5411\u8d70\u3002\u6bcf\u6761\u9053\u8def\u7684\u5141\u8bb8\u65b9\u5411\u7531\u957f\u5ea6\u4e3a$N$\u7684\u5b57\u7b26\u4e32$S$\u548c\u957f\u5ea6\u4e3a$M$\u7684\u5b57\u7b26\u4e32$T$\u63cf\u8ff0\uff0c\u5982\u4e0b\u6240\u793a\uff1a\n\n- \u5982\u679c$S$\u4e2d\u7684\u7b2c$i$\u4e2a\u5b57\u7b26\u662f**W**\uff0c\u5219\u53ea\u80fd\u4ece\u5317\u8fb9\u6cbf\u7b2c$i$\u6761\u4e1c\u897f\u5411\u7684\u9053\u8def\u5411\u897f\u8d70\uff1b\n- \u5982\u679c$S$\u4e2d\u7684\u7b2c$i$\u4e2a\u5b57\u7b26\u662f**E**\uff0c\u5219\u53ea\u80fd\u4ece\u5317\u8fb9\u6cbf\u7b2c$i$\u6761\u4e1c\u897f\u5411\u7684\u9053\u8def\u5411\u4e1c\u8d70\uff1b\n- \u5982\u679c$T$\u4e2d\u7b2c$i$\u4e2a\u5b57\u7b26\u4e3a**N**\uff0c\u5219\u53ea\u80fd\u4ece\u897f\u8fb9\u6cbf\u7b2c$i$\u6761\u5357\u5317\u5411\u5317\u8d70\uff1b\n- \u5982\u679c$T$\u4e2d\u7684\u7b2c$i$\u4e2a\u5b57\u7b26\u662f**S**\uff0c\u5219\u53ea\u80fd\u4ece\u897f\u8fb9\u6cbf\u7b2c\u6761\u897f\u5357\u8def\u5411\u5357\u8d70\u3002\n\n\u5904\u7406\u4ee5\u4e0b$Q$\u4e2a\u67e5\u8be2\uff1a\n\n\u5728\u7b2c$i$\u4e2a\u67e5\u8be2\u4e2d\uff0c\u7ed9\u51fa\u4e86$a_i$\u3001$b_i$\u3001$c_i$ \u548c $d_i$\u3002\u6cbf\u7740\u9053\u8def\u6b65\u884c\uff0c\u4ece\u4ea4\u53c9\u8def\u53e3 $(a_i,b_i)$ \u5230\u8fbe\u4ea4\u53c9\u8def\u53e3 $(c_i,d_i)$ \u7684\u6700\u77ed\u8ddd\u79bb\u662f\u591a\u5c11\uff1f"
}
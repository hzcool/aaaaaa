[
    {
        "content": "\u9996\u5148\u4e0a\u8ff0\u6761\u4ef6\u53ef\u4ee5\u8f6c\u6362\u4e3a\u533a\u95f4\u5185\u6240\u6709\u6570\u90fd\u662f\u6700\u5c0f\u6570\u7684\u500d\u6570\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u5bf9\u4e8e\u4e00\u4e2a\u6ee1\u8db3\u8fd9\u4e2a\u6761\u4ef6\u7684\u6781\u5927\u533a\u95f4\uff0c\u8bbe\u5176\u6700\u5c0f\u503c\u4e3a $a_x$\uff0c\u5219\u5176\u6240\u6709\u5305\u542b $a_x$ \u7684\u5b50\u533a\u95f4\u5fc5\u7136\u4e5f\u662f\u6ee1\u8db3\u7684\uff0c\u5373\u610f\u5473\u7740\u8fd9\u4e00\u4e2a\u6781\u5927\u533a\u95f4 $[l,r]$ \u53ef\u4ee5\u7528 $\\min(a_x,p)\\times (r-l)$ \u7684\u4ee3\u4ef7\u8fde\u901a\u3002\n\n\u4e8e\u662f\u6211\u4eec\u4ece\u5c0f\u5230\u5927\u679a\u4e3e\u6240\u6709\u8fd9\u6837\u7684\u6700\u5c0f\u503c\uff0c\u7136\u540e\u4ece\u4e2d\u95f4\u5411\u4e24\u8fb9\u6269\u5c55\u6c42\u51fa\u6ee1\u8db3\u6761\u4ef6\u7684\u6781\u5927\u533a\u95f4\u5373\u53ef\u3002\u7edf\u8ba1\u4e00\u4e0b\u8fb9\u6570\uff0c\u8fd9\u6837\u5c31\u80fd\u6c42\u51fa\u8fde\u901a\u6240\u6709\u6781\u5927\u533a\u95f4\u540e\u8fd8\u5269\u591a\u5c11\u8fb9\u6ca1\u8fde\u3002\u5bf9\u4e8e\u4e00\u4e9b\u7ec6\u8282\u95ee\u9898\u53ef\u4ee5\u81ea\u5df1\u60f3\u4e00\u60f3\uff0c\u8fd9\u9898\u57fa\u672c\u6ca1\u6709\u4ec0\u4e48\u7ec6\u8282\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define rep(i,a,b) for(register int i=(a);i<=(b);i++)\n#define per(i,a,b) for(register int i=(a);i>=(b);i--)\nusing namespace std;\nconst int N=2e5+9;\ntypedef pair<int,int> pii;\n\ninline long long read() {\n    register long long x=0, f=1; register char c=getchar();\n    while(c<'0'||c>'9') {if(c=='-') f=-1; c=getchar();}\n    while(c>='0'&&c<='9') {x=(x<<3)+(x<<1)+c-48,c=getchar();}\n    return x*f;\n}\n\nint T,n,p,a[N];\nbool vst[N];\n\nsigned main() {\n\tT=read();\n\twhile(T--) {\n\t\tn=read(), p=read();\n\t\trep(i,1,n) a[i]=read(), vst[i]=0;\n\t\tpriority_queue<pii>q;\n\t\trep(i,1,n) q.push(pii(-a[i],i));\n\t\tvst[0]=vst[n]=vst[n+1]=1;\n\t\tint cnt=0,ans=0;\n\t\twhile(!q.empty()) {\n\t\t\tint x=-q.top().first, pos=q.top().second; q.pop();\n\t\t\tif(vst[pos]&&vst[pos-1]) continue;\n\t\t\tif(x>=p) continue;\n\t\t\tint l=pos, r=pos;\n\t\t\twhile(l-1>=1&&a[l-1]%x==0&&!vst[l-1]) l--, vst[l]=1, cnt++, ans+=x;\n\t\t\twhile(r<=n&&a[r+1]%x==0&&!vst[r]) vst[r]=1, r++, cnt++, ans+=x;\n\t\t}\n\t\tans+=(n-1-cnt)*p;\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1626252224,
        "uid": 180652,
        "name": "_lgswdn",
        "ccfLevel": 0,
        "title": "CF1513D GCD and MST"
    },
    {
        "content": "### \u601d\u8def\uff1a\n\n\u9996\u5148\u4e00\u4e2a\u663e\u7136\u7684\u6027\u8d28\uff1a\u5982\u679c\u4e00\u4e2a\u533a\u95f4\u5185\u7684\u6700\u5c0f\u6570\u7b49\u4e8e\u8fd9\u4e2a\u533a\u95f4\u7684\u6700\u5927\u516c\u7ea6\u6570\uff0c\u8fd9\u4e2a\u533a\u95f4\u7684\u6240\u6709\u6570\uff0c\u4e00\u5b9a\u662f\u533a\u95f4\u6700\u5c0f\u6570\u7684\u500d\u6570\u3002\n\n\u7531\u4e8e\u6211\u4eec\u9700\u8981\u6c42\u6700\u5c0f\u751f\u6210\u6811\uff0c\u800c\u5982\u679c\u4e24\u4e2a\u70b9\u53ef\u4ee5\u8fde\u63a5\uff0c\u8fd9\u6761\u8fb9\u7684\u6743\u503c\u4f1a\u4e3a\u8fd9\u4e24\u4e2a\u70b9\u533a\u95f4\u5185\u6700\u5c0f\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u6309\u7167 a \u7684\u503c\u6392\u5e8f\uff0c\u4ece\u5c0f\u5230\u5927\u5411\u5916 \u201c\u6269\u5c55\u201d\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u6211\u4eec\u5c3d\u91cf\u5411\u5916\u8dd1\uff0c\u76f4\u5230\u6709\u4e00\u4e2a\u70b9\u7684\u503c\u5e76\u4e0d\u662f\u6700\u5c0f\u503c\u7684\u500d\u6570\u3002\n\n\u7531\u4e8e\u6211\u4eec\u6392\u4e86\u5e8f\uff0c\u8fd9\u4e2a\u548c\u4e00\u5b9a\u662f\u6700\u5c0f\u7684\u3002\n\n\u5bf9\u4e8e\u76f8\u90bb\u7684\u70b9\u8fde\u63a5\u7684\u6743\u503c\u4e3a $p$ \u7684\u8fb9\uff0c\u5904\u7406\u4e00\u4e0b\u5269\u4e0b\u8fd8\u9700\u8981\u52a0\u7684\u8fb9\u5c31\u597d\u4e86\u3002\n\n***\n\n### \u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n\n#define int long long\n#define mem(x) memset(x,0,sizeof(x))\n\nusing namespace std;\n\nint read(){\n   int s = 0,w = 1;\n   char ch = getchar();\n   while(ch < '0' || ch > '9'){if(ch == '-')w = -1;ch = getchar();}\n   while(ch >= '0' && ch <= '9')s = s * 10 + ch - '0',ch = getchar();\n   return s * w;\n}\n\nstruct node{\n\tint w;\n\tint id;\n}e[200010];\n\nint t;\nint n,m;\nint a[200010];\nint ans;\nint res;\nint q[200010];\nint l,r;\n\nbool cmp(node x,node y){\n\treturn x.w < y.w;\n}\n\nvoid move(int i){\n\twhile(!(a[l] % e[i].w) && l >= 1){\n\t\tl --;\n\t\tif(q[l + 1] == 1)break;\n\t}\n\twhile(!(a[r] % e[i].w) && r <= n){\n\t\tr ++;\n\t\tif(q[r - 1] == 1)break;\n\t}\n}\n\nsigned main(){\n\tcin>>t;\n\twhile(t --){\n\t\tn = read(),m = read();\n\t\tfor(int i = 1;i <= n;i ++)q[i] = 0;\n\t\tans = 0;\n\t\tres = n - 1;\n\t\tfor(int i = 1;i <= n;i ++){\n\t\t\ta[i] = read();\n\t\t\te[i].w = a[i];\n\t\t\te[i].id = i;\n\t\t}\n\t\tsort(e + 1,e + n + 1,cmp);\n\t\tfor(int i = 1;i <= n;i ++){\n\t\t\tif(q[e[i].id])continue;\n\t\t\tif(e[i].w >= m)break;\n\t\t\tl = e[i].id;\n\t\t\tr = e[i].id;\n\t\t\tmove(i);\n\t\t\tl ++;\n\t\t\tr --;\n\t\t\tfor(int j = l;j <= r - 1;j ++){\n\t\t\t\tq[j] ++;\n\t\t\t\tq[j + 1] ++;\n\t\t\t}\n\t\t\tans += (r - l) * e[i].w;\n\t\t\tres -= (r - l);\n\t\t}\n\t\tans += res * m;\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1618371842,
        "uid": 294562,
        "name": "EDqwq",
        "ccfLevel": 7,
        "title": "CF1513D GCD and MST \u9898\u89e3"
    },
    {
        "content": "\u5176\u5b9e\u8fd9\u9898\u5e76\u4e0d\u96be\uff0c\u4f46\u662f\u56e0\u4e3a\u5404\u79cd\u5947\u5947\u602a\u602a\u7684\u7ec6\u8282\u95ee\u9898\u5361\u4e86\u8bb8\u4e45\u3002  \n\u771f\u00b7\u7ec6\u8282\u51b3\u5b9a\u6210\u8d25  \n\u95f2\u8bdd\u5c11\u8bf4\uff0c\u5207\u5165\u6b63\u9898\u2014\u2014  \n\n---\n\u6211\u4eec\u6765\u770b\u770b\u6ee1\u8db3 $\\gcd(a_i, a_{i + 1}, a_{i + 2}\\dots, a_j) = \\min(a_i, a_{i + 1}, a_{i + 2}, \\dots a_j)$ \u8fd9\u6837\u7684\u533a\u95f4\u663e\u7136\u6ee1\u8db3 $\\min(a_i, a_{i + 1}, a_{i + 2}, \\dots a_j)$ \u4e3a\u533a\u95f4 $[i,j]$ \u4e2d\u6240\u6709\u6570\u7684\u56e0\u6570\u3002~~\u5c0f\u5b66\u6570\u5b66\u77e5\u8bc6~~    \n\u8fd9\u4e2a\u662f\u89e3\u9898\u7b97\u6cd5\u7684\u57fa\u7840\u4f9d\u636e\uff0c\u90a3\u4e48\u6839\u636e\u8be5\u7b97\u6cd5\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u8fd9\u6837\u7684\u7b97\u6cd5\u96cf\u5f62\u2014\u2014    \n\u5148\u5bf9 $a_i$ \u6392\u5e8f\uff0c\u7136\u540e\u6328\u4e2a\u679a\u4e3e\uff0c\u628a\u7b2c $i$ \u4e2a\u6570 $a_i$ \u770b\u6210\u6700\u5c0f\u7684\u3002\u5f53\u8fd9\u4e2a\u503c\u6bd4 $p$ \u8981\u5927\u7684\u65f6\u5019\u76f4\u63a5\u9000\u51fa\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u65f6\u5019\u6dfb\u52a0\u8fd9\u6761\u8fb9\u662f\u6ca1\u6709\u610f\u4e49\u7684\uff0c\u53ef\u4ee5\u88ab $p$ \u53d6\u4ee3\u3002\u6ee1\u8db3\u8fd9\u4e2a\u6761\u4ef6\uff0c\u5c31\u8981\u7528\u53cc\u6307\u9488\u62d3\u5c55\u4e00\u4e2a\u533a\u95f4 $[l,r]$ \u6ee1\u8db3\u5176\u4e2d\u4efb\u610f\u5143\u7d20\u90fd\u53ef\u4ee5\u6574\u9664 $a_i$\u3002\u663e\u7136\u5bf9\u4e8e\u7b54\u6848\u7684\u8d21\u732e\u5c31\u662f $(r - l) \\times a_i$\u3002  \n\n---\n\u5728\u5199\u4ee3\u7801\u7684\u65f6\u5019\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u53ef\u80fd\u4f1a\u6709\u533a\u95f4\u91cd\u590d\u8ba1\u7b97\u4e86\uff0c\u6240\u4ee5\u8981\u5f00\u4e00\u4e2a $vis$ \u6570\u7ec4\uff0c$vis_i = 0$ \u8868\u793a\u6ca1\u6709\u88ab\u78b0\u8fc7\uff0c$vis_i = 1$ \u662f\u8986\u76d6\u7684\u4e00\u4e2a\u7aef\u70b9\uff0c\u800c $vis_i = 2$ \u662f\u8986\u76d6\u7684\u91cc\u9762\u7684\u70b9\u3002  \n\u6bd4\u5982\u8bf4\u627e\u5230\u4e00\u4e2a\u5de6\u7aef\u70b9 $l$ \u7136\u540e $vis_l = 1$ \u4e14\u627e\u5230\u4e00\u4e2a $r$ \u7136\u540e $vis_r = 1$\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5224\u5b9a $[l, r]$ \u662f\u4e00\u4e2a\u5408\u6cd5\u533a\u95f4\uff0c\u53ea\u7528\u8ba1\u7b97\u8fd9\u4e2a\u533a\u95f4\u7684\u8d21\u732e\uff0c\u56e0\u4e3a\u518d\u628a $l$ \u5de6\u79fb\u6216\u628a $r$ \u53f3\u79fb\u4f1a\u91cd\u590d\u8ba1\u7b97\u8d21\u732e\u3002\n\n---\n\u603b\u7684\u6765\u8bf4\uff0c\u5c31\u662f\u6392\u5e8f\uff0c\u626b\u4e00\u904d\u53cc\u6307\u9488\u627e\u533a\u95f4\u7136\u540e\u6807\u8bb0\u7edf\u8ba1\u4e00\u4e0b\u8d21\u732e\u5c31\u53ef\u4ee5\u4e86\u3002  \n\u4f46\u662f\u771f\u7684\u5c31\u8fd9\u4e48\u7b80\u5355\u5417\uff1f\u4e0d\u4e0d\u4e0d\u2014\u2014  \n> $p \\le 10^9, a_i \\le 10^9$  \n\n\u8bf6\u8bf6\u8bf6\uff0c\u8fd9\u770b\u4e0a\u53bb\u8981\u5f00 long long \u7684\u6837\u5b50\u8bf6/shq/cy  \n\u7136\u540e\u5f00\u4e00\u4e2a long long \u5c31\u597d\u4e86\n\n---\n\u4ee3\u7801\uff1a  \n```cpp\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n#define MAXN 200000\n#define int long long//\u4e07\u6076\u4e4b\u6e90 long long\n#define QWQ printf(\"qwq\\n\");\nusing namespace std;\nstruct node {\n\tint pos, val;\n}pika[MAXN + 10];\nint a[MAXN + 10], vis[MAXN + 10];\nbool cmp(node &x, node &y) {//\u6392\u5e8f\n\tif(x.val != y.val) return x.val < y.val;\n\telse return x.pos < y.pos;\n}\nsigned main() {\n\tint T, n, k;\n\tscanf(\"%lld\", &T);\n\twhile(T--) {\n\t\tscanf(\"%lld%lld\", &n, &k);\n\t\tmemset(vis, 0, sizeof(vis));//\u591a\u6d4b\u4e0d\u6e05\u7a7a\uff0c\u4fdd\u9f84\u4e24\u884c\u6cea\n\t\tint ans = 0, b = n - 1;//b \u662f\u6743\u503c\u4e3a k\uff08\u521d\u59cb\u8fb9\u6743\uff09 \u7684\u8fb9\u6570\n\t\tfor(int p = 1; p <= n; p++) {\n\t\t\tscanf(\"%lld\", &a[p]);\n\t\t\tpika[p].pos = p;\n\t\t\tpika[p].val = a[p];\n\t\t}\n\t\tsort(pika + 1, pika + n + 1, cmp);\n\t\tfor(int p = 1; p <= n; p++) {\n\t\t\tint l = pika[p].pos, r = pika[p].pos;\n\t\t\tif(pika[p].val >= k) break;//\u5982\u679c\u4ee5 val[i] \u4e3a\u8fb9\u6743\u4e0d\u5982\u4ee5 k \u4e3a\u8fb9\u6743\uff0c\u7531\u4e8e val[i] \u5355\u8c03\u9012\u589e\u6240\u4ee5\u540e\u9762\u4e0d\u53ef\u80fd\u51fa\u73b0\u6743\u503c\u66f4\u5c0f\u7684\uff0c\u76f4\u63a5\u9000\u51fa\n\t\t\tif(vis[pika[p].pos]) continue;//\u66fe\u7ecf\u88ab\u8986\u76d6\u8fc7\uff0c\u8d21\u732e\u88ab\u7edf\u8ba1\u8fc7\n\t\t\twhile(l >= 1 && (a[l] % pika[p].val == 0)) {\n\t\t\t\tl--;\n\t\t\t\tif(vis[l + 1] == 1) break;\n\t\t\t}//\u627e l\n\t\t\twhile(r <= n && (a[r] % pika[p].val == 0)) {\n\t\t\t\tr++;\n\t\t\t\tif(vis[r - 1] == 1) break;\n\t\t\t}//\u627e r\n\t\t\tl++, r--;//\u8c03\u6574\u4e00\u4e0b\n\t\t\tfor(int i = l; i < r; i++) vis[i]++, vis[i + 1]++;//\u7aef\u70b9\u6807\u8bb0\u4e3a 1\uff0c\u5185\u90e8\u6807\u8bb0\u4e3a 2\n\t\t\tans = ans + (r - l) * pika[p].val;//\u7edf\u8ba1\u8d21\u732e\n\t\t\tb -= (r - l);//\u521d\u59cb\u8fb9\u6743\u7684\u8fb9\u6570\u8981\u51cf\u53bb\u8fd9\u4e9b\n\t\t}\n\t\tprintf(\"%lld\\n\", ans + b * k);//\u8f93\u51fa\u7b54\u6848\uff0c\u8bb0\u5f97\u52a0\u4e0a\u521d\u59cb\u8fb9\u6570\n\t}\n}\n```",
        "postTime": 1619961924,
        "uid": 298549,
        "name": "SIXIANG32",
        "ccfLevel": 5,
        "title": "\u9898\u89e3\u3010CF1513D GCD and MST\u3011"
    },
    {
        "content": "\u4e3a\u4e86\u611f\u8c22\u8fd9\u4e2a\u4e0a\u5206\u573a\uff0c\u51b3\u5b9a\u7ed9\u8fd9\u4e2aD\u5199\u4e00\u4efd\u9898\u89e3\u3002\n\n\u6211\u7684\u601d\u8def\u53ef\u80fd\u6bd4\u8f83\u5947\u602a\u3002\n\n\u56e0\u4e3a\u9996\u5148\u6bcf\u6b21\u662f\u6539\u53d8\u4e00\u4e2a\u533a\u95f4 $[l_i,r_i]$\u3002\u6bcf\u6b21\u8d2a\u5fc3\u679a\u4e3e $a[i]$ \u6700\u5c0f\u503c\u5e76\u8986\u76d6\u3002\n\n\u73b0\u5728\u53ea\u9700\u89e3\u51b3\u91cd\u5408\u95ee\u9898\u5373\u53ef\u3002\n\n\u7136\u540e\u6211\u4eec\u5bf9\u6bcf\u4e2a\u70b9\u8bbe\u4e00\u4e2a\u6743\u503c $val_i$\uff0c$0$ \u4ee3\u8868\u672a\u88ab\u8986\u76d6\uff0c$1$ \u4ee3\u8868\u88ab\u8986\u76d6\u4f46\u662f\u8986\u76d6\u7684\u662f\u7aef\u70b9\uff0c$2$ \u4ee3\u8868\u8986\u76d6\u7684\u70b9\u5728\u91cc\u9762\u3002\n\n\u4e00\u4e2a\u70b9\u5f53\u4e24\u6b21\u7aef\u70b9\u6743\u503c\u53d8\u6210 $2$\u3002\n\n\u7136\u540e\u5c31\u6bd4\u8f83\u7b80\u5355\u4e86\uff0c\u56e0\u4e3a\u6211\u4eec\u6bcf\u6b21\u8986\u76d6\u7684\u90a3\u4e2a\u7ebf\u6bb5\u5982\u679c\u4e0e\u5176\u4ed6\u7ebf\u6bb5\u91cd\u5408,\u4f8b\u5982\u8bf4\u533a\u95f4 $[l_i,r_i]$ \u4e0e $[l_j,r_j]$ \u5408\u5e76\u7684\u65f6\u5019\uff0c$l_j$ \u5728 $r_i$ \u5de6\u8fb9\uff0c\u90a3\u4e48\u5e94\u8be5\u5408\u5e76\u4e3a $[l_i,r_j]$\n\n\u6240\u4ee5\u6211\u4eec\u6bcf\u4e00\u6b21\u6269\u5c55\u7684\u65f6\u5019\uff0c\u627e\u5230 $val_i=1$ \u4e14\u53ef\u4ee5\u6269\u5c55\u5230\u7684\u53ef\u4ee5\u76f4\u63a5\u5c06\u5de6\u7aef\u70b9\u8bbe\u4e3a\u5b83\u5c31\u597d\u4e86\u3002\n\n\u53f3\u7aef\u70b9\u540c\u7406\uff0c\u8fd9\u6837\u53ef\u4ee5\u53d1\u73b0\u5c31\u4e0d\u4f1a\u6709\u91cd\u590d\u7684\u51fa\u73b0\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u56e0\u4e3a\u6240\u6709\u70b9\u90fd\u53ea\u4f1a\u88ab\u679a\u4e3e $\\leq3$ \u6b21\u6545\u662f $O(n)$ \u7684\u3002\n\n```cpp\n//\u7ea2\u592a\u9633zhouakngyang txdy!\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\ninline int read()\n{\n\tint sum=0,nega=1;char ch=getchar();\n\twhile(ch>'9'||ch<'0'){if(ch=='-')nega=-1;ch=getchar();}\n\twhile(ch<='9'&&ch>='0')sum=sum*10+ch-'0',ch=getchar();\n\treturn sum*nega;\n}\nint taxi,n,p;\nint a[200009];\nlong long ans,now;\nint vis[200009];\nstruct point\n{\n\tint x,pos;\n}k[200009];\ninline bool cmp(point xxx,point yyy)\n{\n\treturn xxx.x<yyy.x;\n}\nsigned main()\n{\n\ttaxi=read();\n\tfor(int ttt=1;ttt<=taxi;ttt++)\n\t{\n\t\tans=0;\n\t\tn=read(),p=read();now=n-1;\n\t\tfor(int i=1;i<=n;i++)a[i]=read(),k[i].x=a[i],k[i].pos=i,vis[i]=0;\n\t\tsort(k+1,k+n+1,cmp);\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tif(vis[k[i].pos]!=0)continue;\n\t\t\tif(k[i].x>=p)break; \n\t\t\tint l=k[i].pos,r=k[i].pos;\n\t\t\twhile(a[l]%k[i].x==0&&l>=1)\n\t\t\t{\n\t\t\t\tif(vis[l]==1)\n\t\t\t\t{\n\t\t\t\t\tl--;break;\n\t\t\t\t}\n\t\t\t\tl--;\n\t\t\t\t\n\t\t\t}\n\t\t\twhile(a[r]%k[i].x==0&&r<=n)\n\t\t\t{\n\t\t\t\tif(vis[r]==1)\n\t\t\t\t{\n\t\t\t\t\tr++;break;\n\t\t\t\t}\n\t\t\t\tr++;\n\t\t\t}\n\t\t\tl++,r--;\n\t\t\tfor(int j=l;j<r;j++)vis[j]++,vis[j+1]++;\n\t\t//\tcout<<l<<\" \"<<r<<endl;\n\t\t\tans=ans+(r-l)*k[i].x;now=now-(r-l);\n\t\t}\n\t\tans=ans+now*p;\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n\n\n```\n",
        "postTime": 1618358219,
        "uid": 97304,
        "name": "Mophie",
        "ccfLevel": 0,
        "title": "CF1513D GCD and MST"
    },
    {
        "content": "\u6211\u4eca\u5929\u5c31\u8981\u7528 $\\text{ds}$ \u4f18\u5316\u5efa\u56fe\u8fc7\u4e86\u8fd9\u9053\u9898\uff01[submission](https://codeforces.com/contest/1513/submission/203023663)\n\n\u4f60\u53d1\u73b0 $\\gcd$ \u6709\u4e00\u4e2a\u6027\u8d28\uff0c\u5c31\u662f\u5bf9\u4e8e\u76f8\u540c\u7684\u53f3\u7aef\u70b9\uff0c\u540e\u7f00 $\\text{gcd}$ \u603b\u6570\u4e0d\u4f1a\u8d85\u8fc7 $O(\\log V)$ \u6bb5\uff0c\u800c\u540e\u7f00 $\\text{min}$ \u5355\u8c03\u9012\u51cf\uff0c\u610f\u5473\u7740\u4ece\u76f8\u540c\u7684 $r$ \u7aef\u70b9\uff0c\u8fde\u8fb9 **\u6bb5\u6570** \u662f $O(\\log V)$ \u7684\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 \u6808 \u6765\u7ef4\u62a4\u540e\u7f00 $\\gcd$\uff0c\u7528 $\\text{ST}$ \u8868\u6765\u7ef4\u62a4\u540e\u7f00 $\\min$\uff08\u5f53\u7136\u8fd9\u4e2a\u4e5f\u53ef\u4ee5\u7528\u6808\u7ef4\u62a4\uff09\uff0c\u8fd9\u6837\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u7ed9\u4f60 $O(n \\log V)$ \u4e2a\u4ece\u4e00\u4e2a\u70b9\u5411\u4e00\u4e2a\u533a\u95f4\u8fde\u8fb9\uff0c\u6c42 $\\text{MST}$\u3002\u8003\u8651\u4f7f\u7528 $\\text{kruskal}$\uff0c\u95ee\u9898\u53d8\u4e3a\u5feb\u901f\u8ba9\u4e00\u4e2a\u70b9\u5bf9\u4e00\u4e2a\u533a\u95f4\u8fde\u8fb9\uff0c\u6c42\u5e76\u67e5\u96c6\u5408\u5e76\u6b21\u6570\u3002\n\n\u6ce8\u610f\u5230\u56e0\u4e3a\u662f\u6c42 $\\text{MST}$\uff0c\u6240\u4ee5\u4e0d\u80fd\u7528\u4e00\u822c\u7684\u6570\u636e\u7ed3\u6784\u4f18\u5316\u5efa\u8fb9\u89e3\u51b3\uff0c\u56e0\u4e3a\u6570\u636e\u7ed3\u6784\u7ef4\u62a4\u7684\u8fb9\u90fd\u662f\u65e0\u5411\u8fb9\uff0c\u800c\u6211\u4eec\u9700\u8981\u957f\u5ea6\u4e3a $0$ \u7684\u8f85\u52a9\u8fb9\uff0c\u5f88\u96be\u89e3\u51b3\u95ee\u9898\u3002\n\n\u7136\u800c\u8fd9\u4e2a\u8fc7\u7a0b\u53ef\u4ee5\u4f7f\u7528\u542f\u53d1\u5f0f\u5408\u5e76 $+$ \u54c8\u5e0c $+$ \u6811\u72b6\u6570\u7ec4\u89e3\u51b3\uff0c\u5177\u4f53\u7684\uff0c\u5047\u8bbe\u6211\u4eec\u8981\u5408\u5e76 $\\operatorname{merge}(u, [l, r])$\uff0c\u6211\u4eec\u7ed9\u6bcf\u4e2a\u96c6\u5408\u9644\u4e00\u4e2a\u54c8\u5e0c\u503c $h_x$\uff0c\u7136\u540e\u7528\u542f\u53d1\u5f0f\u5408\u5e76\u7ef4\u62a4\u96c6\u5408\u5408\u5e76\uff0c\u7528\u6811\u72b6\u6570\u7ec4\u67e5\u8be2\u533a\u95f4\u54c8\u5e0c\u503c\u662f\u5426\u7b49\u4e8e\u533a\u95f4\u4e2d\u6240\u6709\u6570\u90fd\u662f $u$ \u7684\u54c8\u5e0c\u503c\uff0c\u5982\u679c\u4e0d\u662f\uff0c\u53ef\u4ee5\u91c7\u7528\u5206\u6cbb\uff0c\u9012\u5f52\u5224\u5b9a\u5de6\u534a\u8fb9\u548c\u53f3\u534a\u8fb9\uff0c\u76f4\u5230\u533a\u95f4\u957f\u5ea6\u4e3a $1$ \u65f6\u66b4\u529b\u5408\u5e76\u3002",
        "postTime": 1682153279,
        "uid": 615348,
        "name": "zhouershan",
        "ccfLevel": 7,
        "title": "CF1513D GCD and MST"
    },
    {
        "content": "# CF1513D \u9898\u89e3\n\n\n\n## \u601d\u8def\u5206\u6790\n\n\u5bb9\u6613\u628a\u7b2c\u4e00\u79cd\u8fde\u8fb9\u6761\u4ef6\u8f6c\u5316\u4e3a $a_i\\sim a_j$ \u90fd\u662f\u67d0\u4e2a $a_x$ \u7684\u500d\u6570\uff0c\u8003\u8651 Kruskal \u751f\u6210\u6811\uff0c\u5bf9\u4e8e\u6240\u6709\u70b9\u6743 $<p$ \u7684\u70b9\u4ece\u5c0f\u5230\u5927\u679a\u4e3e\uff0c\u6bcf\u6b21\u5bf9\u4e8e\u4e00\u4e2a $a_x$\uff0c\u6269\u5c55\u51fa\u5176\u5de6\u8fb9\u6709\u591a\u5c11\u4e2a\u8fde\u7eed\u7684 $a_x$ \u7684\u500d\u6570\u548c\u5176\u53f3\u8fb9\u6709\u591a\u5c11\u4e2a\u8fde\u7eed\u7684 $a_x$ \u7684\u500d\u6570\uff0c\u6c42\u51fa\u6709 $a_x$ \u8fd9\u4e00\u7ea6\u6570\u7684\u6781\u5927\u7684\u533a\u95f4 $[l_x,r_x]$\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6240\u6709 $i\\in [l_x,r_x]$\uff0c\u5bf9\u4e8e\u6bcf\u6761\u53ef\u80fd\u7684\u8fb9 $(i,x)$ \u6709\u5e76\u67e5\u96c6\u5224\u65ad\u4e00\u4e0b\u5373\u53ef\uff0c\u6bcf\u6b21\u8fd9\u6837\u7684\u64cd\u4f5c\u80fd\u591f\u8054\u901a\u533a\u95f4 $[l_x,r_x]$\u3002\n\n\u6b64\u65f6\u751f\u6210\u68ee\u6797\u4e00\u5b9a\u662f\u82e5\u5e72\u4e2a\u8fde\u7eed\u7684\u533a\u95f4\u6784\u6210\u4e00\u68f5\u6811\uff0c\u628a\u5269\u4e0b\u7684\u8fb9\u7528 $p$ \u7684\u4ee3\u4ef7\u90fd\u8fde\u63a5\u8d77\u6765\u5c31\u53ef\u4ee5\u3002\n\n\u4f46\u662f\u8fd9\u79cd\u505a\u6cd5\u5bf9\u4e8e\u6bcf\u4e2a $x$ \u5728\u6700\u574f\u60c5\u51b5\u4e0b\u90fd\u9700\u8981\u904d\u5386\u6574\u4e2a\u533a\u95f4\uff0c\u590d\u6742\u5ea6\u9000\u5316\u4e3a $\\Theta(n^2)$\u3002\n\n\u8003\u8651\u4f18\u5316\uff0c\u6ce8\u610f\u5230\u5982\u4e0b\u7684\u89c2\u5bdf\uff1a\n\n> \u89c2\u5bdf\uff1a\n>\n>  \u5f53\u9047\u5230\u4e00\u4e2a $i$ \u4f7f $(i,x)$ \u6784\u6210\u73af\u540e\uff0c\u518d\u5f80\u540e\u7684 $i$ \u4e00\u6837\u4f1a\u751f\u6210\u73af\uff0c\u5728\u8fd9\u4e2a\u5730\u65b9\u76f4\u63a5 `break` \u6389\u5373\u53ef\u3002\n>\n> \u6211\u4eec\u53ea\u9700\u8981\u8bc1\u660e\uff0c\u6bcf\u6b21 `break` \u540e\u533a\u95f4 $[l_x,r_x]$ \u5df2\u7ecf\u662f\u8054\u901a\u7684\u3002\n>\n> \u8003\u8651\u6570\u5b66\u5f52\u7eb3\u6cd5\uff0c\u5f53\u524d\u6240\u6709\u533a\u95f4 $[l_x,r_x]$ \u5df2\u7ecf\u8003\u8651\u5b8c\u6bd5\u5e76\u8054\u901a\uff0c\u8003\u8651\u4e0b\u4e00\u4e2a\u533a\u95f4 $[l_{x'},r_{x'}]$\uff0c\u53ea\u9700\u8981\u8bc1\u660e $x'$ \u4e0d\u4f1a\u8d8a\u8fc7\u8fd9\u4e2a\u533a\u95f4\u53bb\u8fde\u63a5\uff0c\u5373\u4e0d\u5b58\u5728 $x'\\to i'$ \u6ee1\u8db3 $i'<l_x\\le r_x<x'$ \u6216 $i'>r_x\\ge l_x>x'$\uff0c\u6ce8\u610f\u5230\u8fd9\u79cd $x\\in[l_{x'},r_{x'}]$ \u53ea\u4f1a\u5728 $x'=x$ \u65f6\u53d1\u751f\uff0c\u6b64\u65f6\u6709 $[l_{x'},r_{x'}]=[l_x,r_x]$\uff0c\u56e0\u6b64\u8fd9\u6837\u7684 $(x',i')$ \u4e0d\u5b58\u5728\uff0c\u6545\u539f\u547d\u9898\u5f97\u8bc1\u3002\n\n\u8fd9\u6837\u6bcf\u4e2a\u70b9\u81f3\u591a\u540c\u65f6\u4f5c\u4e3a\u67d0\u4e2a\u533a\u95f4\u7684\u5de6\u7aef\u70b9\u548c\u53f3\u7aef\u70b9\uff0c\u8bbf\u95ee\u6b21\u6570\u4e0d\u4f1a\u8d85\u8fc7 $2$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n\\log n)$\u3002\n\n## \u4ee3\u7801\u5448\u73b0\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define pii pair<int,int>\nusing namespace std;\nconst int MAXN=2e5+1;\nint dsu[MAXN],a[MAXN];\ninline int find(int x) {\n\tif(dsu[x]==x) return x;\n\treturn dsu[x]=find(dsu[x]);\n}\ninline void solve() {\n\tint n,p,tot=0,ans=0;\n\tscanf(\"%lld%lld\",&n,&p);\n\tfor(int i=1;i<=n;++i) dsu[i]=i;\n\tpriority_queue <pii,vector<pii>,greater<pii> > q;\n\tfor(int i=1;i<=n;++i) {\n\t\tscanf(\"%lld\",&a[i]);\n\t\tif(a[i]<p) q.push(make_pair(a[i],i));\n\t}\n\twhile(!q.empty()) {\n\t\tint x=q.top().second; q.pop();\n\t\tfor(int i=x-1;i>=1;--i) {\n\t\t\tif(a[i]%a[x]!=0) break;\n\t\t\tint u=find(x),v=find(i);\n\t\t\tif(u!=v) {\n\t\t\t\t++tot,ans+=a[x];\n\t\t\t\tdsu[u]=v;\n\t\t\t} else break;\n\t\t}\n\t\tfor(int i=x+1;i<=n;++i) {\n\t\t\tif(a[i]%a[x]!=0) break;\n\t\t\tint u=find(x),v=find(i);\n\t\t\tif(u!=v) {\n\t\t\t\t++tot,ans+=a[x];\n\t\t\t\tdsu[u]=v;\n\t\t\t} else break;\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",ans+(n-1-tot)*p);\n}\nsigned main() {\n\tint T;\n\tscanf(\"%lld\",&T);\n\twhile(T--) solve();\n\treturn 0;\n}\n```\n\n",
        "postTime": 1673177619,
        "uid": 539618,
        "name": "DaiRuiChen007",
        "ccfLevel": 6,
        "title": "CF1513D \u9898\u89e3"
    }
]
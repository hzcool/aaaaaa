[
    {
        "content": "### \u8fd9\u662fGD\u521d\u4e8c\u849f\u84bb $lolte$ \u7684\u9898\u89e3\n\n\u6700\u8fd1\u5728\u505a\u6742\u9898\uff0c\u521a\u597d\u505a\u5230\u4e86\u8fd9\u9053\u9898\u3002\u7136\u540e\u5c31\u5f00\u5fc3\u5199\u9898\u4e86\u3002\u987a\u4fbf\u4ea4\u4e86\u7ffb\u8bd1\uff0c\u5c31\u6765\u5199\u9898\u89e3\u4e86\u3002\n\n**\u7b97\u6cd5\u6807\u7b7e** \uff1a\n- \u503c\u57df\u7ebf\u6bb5\u6811\n\n\u53c2\u8003\u4e86\u90e8\u5206\u7f51\u4e0a\u7684blog\u3002\n\n----\n\n**\u9898\u76ee\u5305\u62ec\u4e09\u79cd\u64cd\u4f5c**\uff1a\n\n- $+$ $t$ $d$ \uff0c\u8868\u793a\u5728\u65f6\u523b $t$ \u6765\u4e86\u9a91\u58eb\uff0c\u5360\u7528\u56fd\u738b $d$ \u7684\u65f6\u95f4\u3002\n- $-$ $i$ \uff0c\u8868\u793a\u64a4\u9500\u7b2c $i$ \u6b21\u64cd\u4f5c\u3002\n- $?$ $t$ \uff0c\u8868\u793a\u8be2\u95ee\u516c\u4e3b\u5728\u65f6\u523b $t$ \u65f6\u6765\u5230\uff0c\u9700\u8981\u7b49\u591a\u4e45\u3002\n\n\u7531\u4e8e\u9898\u76ee\u7ed9\u51fa $1\u2264t_i\u226410^6$ \uff0c\u8003\u8651\u4f7f\u7528\u503c\u57df\u7ebf\u6bb5\u6811\u3002\n\n\u6211\u4eec\u7528 $sum$ \u8868\u793a\u533a\u95f4\u5185\u6240\u5360\u7528\u56fd\u738b\u7684\u65f6\u95f4\u603b\u957f\uff0c$wait$ \u8868\u793a\u8981\u7b49\u5230\u4ec0\u4e48\u65f6\u523b\u624d\u5904\u7406\u5b8c\u3002\n\n\u5219\u53ef\u77e5\uff1a\n```cpp\nsum[now]=sum[lson]+sum[rson];\nwait[now]=max(wait[lson]+sum[rson],wait[rson]);\n```\n\n\u7531\u6b64\u53ef\u5efa\u503c\u57df\u7ebf\u6bb5\u6811\u3002\n\n\u5bf9\u4e8e $+$ \u64cd\u4f5c\uff0c\u5219\u4e3a\u5355\u70b9\u4fee\u6539\u3002 $-$ \u64cd\u4f5c\u5c06 $d$ \u53d6\u53cd\u518d\u4fee\u6539\u5373\u53ef\u3002\n\n\u8003\u8651 $?$ \u64cd\u4f5c\u3002\n\n\u7528 $x$ \u8868\u793a\u5f53\u524d\u8981\u67e5\u8be2\u7684\u65f6\u523b\uff0c\u5219\u6709\uff1a\n\n```cpp\nlong long query(int l,int r,int t,int x) {\n\tif (r<=x) {\n    \t//\u5bf9\u4e8e\u5c0f\u4e8ex\u7684\uff0c\u53d6wait\u548cans+sum\u7684\u6700\u5927\u503c\n\t\tans=max(wait[t],ans+sum[t]);//\n\t\treturn ans;\n\t}\n\tint mid=(l+r)>>1;\n\tquery(lson,x);//\u5fc5\u5b9a\u5f80\u5de6\n\tif (x>mid) query(rson,x);\n\treturn ans;\n}\n```\n\n\u90a3\u4e48\u8fd9\u9898\u5dee\u4e0d\u591a\u5c31\u505a\u5b8c\u4e86\uff0c\u6ce8\u610f\u7ec6\u8282\u3002\n\n### code\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=1e6+10;\nint n,a[maxn],b[maxn];\nlong long ans,sum[maxn*4],wait[maxn*4];\n#define lson l,mid,t<<1\n#define rson mid+1,r,t<<1|1\nvoid build(int l,int r,int t) {//\u5efa\u6811 \n\tif (l==r) {\n\t\twait[t]=l;\n\t\treturn;\n\t}\n\tint mid=(l+r)>>1;\n\tbuild(lson);\n\tbuild(rson);\n\twait[t]=max(wait[t<<1]+sum[t<<1|1],wait[t<<1|1]);\n\tsum[t]=sum[t<<1]+sum[t<<1|1];\n}\nvoid update(int l,int r,int t,int x,int y) {//\u4fee\u6539 \n\tif (l==r) {\n\t\tsum[t]+=y;\n\t\twait[t]+=y;\n\t\treturn;\n\t}\n\tint mid=(l+r)>>1;\n\tif (x<=mid) update(lson,x,y);\n\telse update(rson,x,y);\n\twait[t]=max(wait[t<<1]+sum[t<<1|1],wait[t<<1|1]);\n\tsum[t]=sum[t<<1]+sum[t<<1|1];\n}\nlong long query(int l,int r,int t,int x) {//\u67e5\u8be2 \n\tif (r<=x) {\n\t\tans=max(wait[t],ans+sum[t]);\n\t\treturn ans;\n\t}\n\tint mid=(l+r)>>1;\n\tquery(lson,x);\n\tif (x>mid) query(rson,x);\n\treturn ans;\n}\nsigned main(){\n\tscanf(\"%d\",&n);\n\tchar cz;\n\tbuild(1,1e6,1);//\u503c\u57df\u7ebf\u6bb5\u6811\u4e0a\u754c\u662f\u6570\u503c\u6700\u5927\uff0c\u5373\u6700\u5927\u7684t \n\tfor (int i=1;i<=n;++i) {//\u6309\u9898\u610f\u8fdb\u884c\u64cd\u4f5c \n\t\tscanf(\" %c%d\",&cz,&a[i]);\n\t\tif (cz=='+') {\n\t\t\tscanf(\"%d\",&b[i]);\n\t\t\tupdate(1,1e6,1,a[i],b[i]);\n\t\t}\n\t\telse if (cz=='-') {\n\t\t\tupdate(1,1e6,1,a[a[i]],-b[a[i]]);\n\t\t}\n\t\telse {\n\t\t\tans=0;\n\t\t\tprintf(\"%I64d\\n\",query(1,1e6,1,a[i])-a[i]);//\u8bb0\u5f97\u662f\u7b49\u5f85\u7684\u65f6\u957f\uff0c\u8981\u51cf\u53bb\u539f\u65f6\u523b \n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n---\n\n> \u6700\u540e\u2026\u2026\n\n![](https://z4a.net/images/2019/01/22/zuosha.jpg)",
        "postTime": 1548211557,
        "uid": 78752,
        "name": "lolte",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1089K \u3010King Kog's Reception\u3011"
    }
]
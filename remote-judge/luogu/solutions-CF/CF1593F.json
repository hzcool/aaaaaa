[
    {
        "content": "> \u6709 $n$ \u4e2a\u6570\u5b57\uff0c\u4f60\u9700\u8981\u5c06\u5b83\u4eec\u6bcf\u4e00\u4e2a\u90fd\u67d3\u4e0a\u7ea2\u8272\u6216\u9ed1\u8272\uff08\u81f3\u5c11\u8981\u6709\u4e00\u4e2a\u6570\u662f\u7ea2\u8272\uff0c\u9ed1\u8272\u540c\u7406\uff09\uff0c\u4f7f\u7ea2\u8272\u7684\u6570\u5b57\u4ece\u5de6\u5230\u53f3\u7ec4\u6210\u7684\u6570\u53ef\u4ee5\u88ab $a$ \u6574\u9664\uff0c\u4e14\u9ed1\u8272\u7684\u6570\u5b57\u4ece\u5de6\u5230\u53f3\u7ec4\u6210\u7684\u6570\u53ef\u4ee5\u88ab $b$ \u6574\u9664\uff0c\u540c\u65f6\u8bbe\u7ea2\u8272\u7684\u6570\u5b57\u4e2a\u6570\u4e3a $A$\uff0c\u9ed1\u8272\u7684\u6570\u5b57\u4e2a\u6570\u4e3a $B$\uff0c\u4f60\u9700\u8981\u6700\u5c0f\u5316 $|A-B|$\uff0c\u8f93\u51fa\u65b9\u6848\u6216 $-1$ \u8868\u793a\u65e0\u89e3\u3002\n\n\n### \u505a\u6cd5 $1$.\n\n\u573a\u4e0a\u770b\u5230 $n=40$ \u5c31\u60f3\u5230\u6298\u534a\u641c\u7d22\u3002\u5b9e\u9645\u4e0a\u53c8\u957f\u53c8\u96be\u5199\u3002\n\n\u5c06\u6574\u4e2a\u6570\u7ec4\u5206\u4e3a\u4e24\u534a\u641c\u7d22\uff0c$v_{0/1,i,j,k}$ \u8868\u793a\u6570\u7ec4\u524d\u4e00\u534a/\u540e\u4e00\u534a\uff0c\u7ea2\u8272\u7ec4\u6210\u7684\u6570 $\\mod a = i$\uff0c\u9ed1\u8272\u7ec4\u6210\u7684\u6570 $\\mod b = j$\uff0c\u4e14\u6709 $k$ \u4e2a\u6570\u5b57\u88ab\u67d3\u6210\u7ea2\u8272\u7684\u65b9\u6848\u3002\n\n\u6c42\u7b54\u6848\u53ef\u4ee5\u679a\u4e3e\u524d\u4e00\u534a $\\mod a$ \u548c $\\mod b$ \u7684\u7ed3\u679c\uff0c\u4ee5\u53ca\u524d\u4e00\u534a\u548c\u540e\u4e00\u534a\u67d3\u6210\u7ea2\u8272\u7684\u4e2a\u6570\u3002\u8fd9\u6837\u53ef\u4ee5\u8ba1\u7b97\u5f97\u51fa\u540e\u4e00\u534a $\\mod a$ \u548c $\\mod b$ \u7684\u7ed3\u679c\uff0c\u76f4\u63a5\u8ba1\u7b97\u7b54\u6848\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(2^{\\frac{n}2} + n^2ab)$\uff0c\u76f4\u63a5\u559c\u63d0\uff08\u76ee\u524d\uff09\u6700\u52a3\u89e3\u3002\n\n$\\text{Code}$\uff1a\n\n```cpp\nint n, a, b;\nint x[N];\nvector<int> v[2][N][N][N];\nint col[N];\n\nvoid dfs(int f, int st, int ed, int A, int B, int ca) {\n\tif(st > ed) {\n\t\tif(v[f][A][B][ca].size()) return ; \n\t\tif(ed == n) rep(i, n / 2 + 1, n) v[f][A][B][ca].pb(col[i]);\n\t\telse rep(i, 1, n / 2) v[f][A][B][ca].pb(col[i]);\n\t\treturn ;\n\t}\n\tcol[st] = 1;\n\tdfs(f, st + 1, ed, (A * 10 + x[st]) % a, B, ca + 1); \n\tcol[st] = 2;\n\tdfs(f, st + 1, ed, A, (B * 10 + x[st]) % b, ca); \n\tcol[st] = 0;\n}\n\nint main() {\n\tint t; cin >> t;\n\tW(t) {\n\t\tcin >> n >> a >> b;\n\t\trep(i, 0, a - 1) rep(j, 0, b - 1) rep(k, 0, 1) rep(l, 0, n) v[k][i][j][l].clear();\n\t\trep(i, 1, n) scanf(\"%1d\", x + i);\n\t\tdfs(0, 1, n / 2, 0, 0, 0);\n\t\tdfs(1, n / 2 + 1, n, 0, 0, 0);\n\t\tint mn = 0x3f3f3f3f, l = n / 2, lst = n - (n / 2);\n\t\trep(i, 0, a - 1) rep(j, 0, b - 1) rep(cca, 0, l) {\n\t\t\tif(!v[0][i][j][cca].size()) continue;\n\t\t\trep(ca, 0, lst) {\n\t\t\t\tif(ca + cca == 0 || ca + cca == n) continue;\n\t\t\t\tint nwa = qpow(ca, 10, a) * i % a, nwb = qpow(lst - ca, 10, b) * j % b;\n\t\t\t\tint nda = (a - nwa) % a, ndb = (b - nwb) % b;\n\t\t\t\tif(!v[1][nda][ndb][ca].size()) continue;\n\t\t\t\tTo_min(mn, abs((n - cca - ca) - ca - cca));\n\t\t\t}\n\t\t}\n//\t\tcout << mn << ' ' << v[0][0][0][0].size() << ' ' << v[1][0][0][1].size() << endl;\n\t\trep(i, 0, a - 1) rep(j, 0, b - 1) rep(cca, 0, l) {\n\t\t\tif(!v[0][i][j][cca].size()) continue;\n\t\t\trep(ca, 0, lst) {\n\t\t\t\tif(ca + cca == 0 || ca + cca == n) continue;\n\t\t\t\tint nwa = qpow(ca, 10, a) * i % a, nwb = qpow(lst -  ca, 10, b) * j % b;\n\t\t\t\tint nda = (a - nwa) % a, ndb = (b - nwb) % b;\n//\t\t\t\tif(!i && !j && !cca && ca == 1) cout << nda << ' ' << ndb << endl;\n\t\t\t\tif(!v[1][nda][ndb][ca].size()) continue;\n\t\t\t\tif(abs((n - cca - ca) - ca - cca) == mn) {\n\t\t\t\t\tfor(int co : v[0][i][j][cca]) if(co == 1) pc('R'); else pc('B');\n\t\t\t\t\tfor(int co : v[1][nda][ndb][ca]) if(co == 1) pc('R'); else pc('B');\n\t\t\t\t\tpc('\\n');\n\t\t\t\t\tgoto End;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tputs(\"-1\");\n\t\tEnd:;\n\t}\n\treturn 0;\n}\n```\n\n### \u505a\u6cd5 $2$.\n\n\u6298\u534a\u5199\u6302\u8fd8\u5403\u4e86\u4e24\u53d1\u7f5a\u65f6\uff0c\u573a\u540e\u4e00\u62cd\u8111\u5b50\uff0c\u5b9e\u9645\u4e0a\u72b6\u6001\u53ea\u6709\u56db\u7ef4\uff0c$vis_{i,j,k,l} = 0/1$ \u8868\u793a\u5f53\u524d\u5230\u7b2c $i$ \u4e2a\u6570\u5b57\uff0c\u67d3\u6210\u7ea2\u8272\u7684\u7ec4\u6210\u7684\u6570 $\\mod a = j$\uff0c\u67d3\u6210\u9ed1\u8272\u7684\u7ec4\u6210\u7684\u6570 $\\mod b = k$\uff0c\u67d3\u4e86 $l$ \u4e2a\u7ea2\u8272\u7684\u6570\u5b57\u662f\u5426\u88ab\u641c\u5230\u4e86\u3002\n\n\u4e8e\u662f\u76f4\u63a5 dfs \u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2ab)$\uff0c\u8dd1\u7684\u98de\u5feb\u3002\n\n$\\text{Code}$\uff1a\n\n```cpp\nint n, a, b;\nint x[N];\nint t[N], col[N];\nbool vis[N][N][N][N];\nint mn;\n \nvoid dfs(int st, int A, int B, int ca) {\n\tif(vis[st][A][B][ca]) return ;\n\tvis[st][A][B][ca] = 1;\n\tif(st > n) {\n\t\tif(!A && !B && abs(n - 2 * ca) < mn) {\n\t\t\tmn = abs(n - 2 * ca);\n\t\t\trep(i, 1, n) col[i] = t[i];\n\t\t}\n\t\treturn ;\n\t}\n\tt[st] = 1;\n\tdfs(st + 1, (A * 10 + x[st]) % a, B, ca + 1);\n\tt[st] = 2;\n\tdfs(st + 1, A, (B * 10 + x[st]) % b, ca);\n\tt[st] = 0;\n}\n \nint main() {\n\tint t; cin >> t;\n\tW(t) {\n\t\tmemset(vis, 0, sizeof vis);\n\t\tcin >> n >> a >> b;\n\t\tmn = n;\n\t\trep(i, 1, n) scanf(\"%1d\", x + i);\n\t\tdfs(1, 0, 0, 0);\n\t\tif(mn == n) puts(\"-1\");\n\t\telse {\n\t\t\trep(i, 1, n) if(col[i] == 1) pc('R'); else pc('B');\n\t\t\tpc('\\n'); \n\t\t}\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1634207580,
        "uid": 242543,
        "name": "BreezeEnder",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1593F Red-Black Number"
    },
    {
        "content": "## \u9898\u610f\uff1a\n\n\u7ed9\u4e00\u4e2a\u5e8f\u5217\uff0c\u5c06\u5176\u6bcf\u4e00\u4f4d\u67d3\u6210\u7ea2\u8272\u6216\u8005\u9ed1\u8272\u3002\n\n\u8981\u6c42\u7ea2\u8272\u7ec4\u6210\u7684\u6570\u5b57\u662f A \u7684\u500d\u6570\uff0c\u9ed1\u8272\u7ec4\u6210\u7684\u6570\u5b57\u662f B \u7684\u500d\u6570\u3002\n\n\u8f93\u51fa\u6ee1\u8db3\u4e0a\u8ff0\u8981\u6c42\u65f6\u7ea2\u9ed1\u4e24\u8272\u6570\u91cf\u5dee\u6700\u5c0f\u7684\u67d3\u8272\u65b9\u6848\u3002\n\n## \u601d\u8def\uff1a\n\n\u9996\u5148\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fc7\u7a0b\u4e2d\u6211\u4eec**\u4e0d\u9700\u8981\u77e5\u9053\u5f53\u524d\u6570\u5b57\u662f\u591a\u5c11\uff0c\u53ea\u8981\u77e5\u9053\u5f53\u524d\u4e24\u4e2a\u6570\u5b57\u7684\u4f4d\u6570\u548c\u9664\u4ee5 $A/B$ \u4f59\u6570\u5206\u522b\u662f\u591a\u5c11**\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8bbe $dp[i][j][a][b]$ \u8868\u793a\u524d $i$ \u4f4d\u67d3 $j$ \u4e2a\u9ed1\u8272\uff0c\u7ea2/\u9ed1\u8272\u7ec4\u6210\u7684\u6570\u5b57\u6a21 $A/B$ \u65f6\u7684\u4f59\u6570\u5206\u522b\u4e3a $a/b$ \u7684\u65b9\u6848\u662f\u5426\u5b58\u5728\u3002\n\n\u7136\u540e\u518d\u7528 $black[i][j][a][b]$ \u548c $red[i][j][a][b]$ \u8bb0\u5f55\u4e00\u4e0b\u8def\u5f84\uff08\u8bb0\u5f55\u4ece\u54ea\u4e2a\u72b6\u6001\u8f6c\u79fb\u8fc7\u6765\uff09\uff0c\u6700\u540e\u5012\u5e8f\u627e\u8def\u5f84\u3001\u6b63\u5e8f\u8f93\u51fa\u8def\u5f84\u5373\u53ef\u3002\n\n## AC\u4ee3\u7801\uff1a\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nstring s;\nint T,n,A,B,dp[45][45][45][45],black[45][45][45][45],red[45][45][45][45];\ninline void print_ans(int ans){//\u5012\u5e8f\u627e\u8def\u5f84\u5e76\u6b63\u5e8f\u8f93\u51fa\n\tint anss[50],a=0,b=0;\n\tfor(int i=n;i>=1;i--){\n\t\tif(black[i][ans][a][b]!=-1){\n\t\t\tanss[i]=0;\n\t\t\tb=black[i][ans][a][b];\n\t\t\tans--;\n\t\t}else{\n\t\t\tanss[i]=1;\n\t\t\ta=red[i][ans][a][b];\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tputchar(anss[i]?'R':'B');\n\t}\n\tputs(\"\");\n}\nint main(){\n\tcin>>T;\n\twhile(T--){\n\t\tmemset(dp,0,sizeof(dp));\n\t\tmemset(black,-1,sizeof(black));\n\t\tmemset(red,-1,sizeof(red));\n\t\tcin>>n>>A>>B;\n\t\tcin>>s;\n\t\tdp[0][0][0][0]=1;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tfor(int j=0;j<=i;j++){\n\t\t\t\tfor(int a=0;a<A;a++){\n\t\t\t\t\tfor(int b=0;b<B;b++){\n\t\t\t\t\t\tif(dp[i-1][j][a][b]){//\u8f6c\u79fb\u5e76\u8bb0\u5f55\u8def\u5f84\n\t\t\t\t\t\t\tdp[i][j+1][a][(b*10+s[i-1]-'0')%B]=1;\n\t\t\t\t\t\t\tblack[i][j+1][a][(b*10+s[i-1]-'0')%B]=b;\n\t\t\t\t\t\t\tdp[i][j][(a*10+s[i-1]-'0')%A][b]=1;\n\t\t\t\t\t\t\tred[i][j][(a*10+s[i-1]-'0')%A][b]=a;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tint ans=50;\n\t\tfor(int i=1;i<n;i++){\n\t\t\tif(dp[n][i][0][0]){\n\t\t\t\tif(abs(n-i-i)<abs(n-ans-ans)) ans=i;\n\t\t\t}\n\t\t}\n\t\tif(ans==50) cout<<-1<<endl;\n\t\telse print_ans(ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1634436916,
        "uid": 70081,
        "name": "\u5c39\u6631\u94a6",
        "ccfLevel": 7,
        "title": "CF1593F Red-Black Number  \u9898\u89e3"
    },
    {
        "content": "dp \u7684\u53e6\u4e00\u79cd\u5b9e\u73b0\u65b9\u6cd5\u3002\n\n---\n\n\u5176\u5b9e\u4e5f\u5dee\u4e0d\u591a\u3002\u4e00\u5f00\u59cb\uff0c\u81ea\u7136\u5730\u60f3\u5230 $dp_{i,j,k,r,b}$ \u8868\u793a\u524d $i$ \u4e2a\u9009\u4e86 $r$ \u4e2a\u7ea2\u8272\u7684\u70b9\uff0c\u7ec4\u6210\u7684\u5341\u8fdb\u5236\u6a21 $A$ \u4f59 $j$\uff0c\u4e14\u9009\u4e86 $b$ \u4e2a\u84dd\u70b9\uff0c\u7ec4\u6210\u7684\u5341\u8fdb\u5236\u6570\u6a21 $B$ \u4f59 $k$ \u662f\u5426\u53ef\u8fbe\u3002\n\n\u7531\u4e8e $A,B,n$ \u540c\u9636\uff0c\u6240\u4ee5\u6b64\u65f6\u72b6\u6001\u6570\u662f $n^5$ \u7ea7\u522b\u7684\uff0c\u5927\u6982\u662f $1.024\\times10^8$\u3002\n\n\u53d1\u73b0\u5176\u5b9e\u6839\u636e\u5b9a\u4e49 $r+b=i$\uff0c\u6240\u4ee5 $b$ \u53ef\u4ee5\u8868\u793a\u4e3a $i-r$\uff0c\u4e8e\u662f\u53bb\u6389\u6700\u540e\u4e00\u7ef4\u3002\n\n\u8003\u8651\u8f6c\u79fb\u3002\u5982\u679c\u8981\u4ece\u4e4b\u524d\u8f6c\u79fb\u8fc7\u6765\uff0c\u90a3\u4e48\u9700\u8981\u5f97\u5230 $\\dfrac{j-a_i}{10}$\uff0c\u800c\u5728\u6a21 $A$ \u610f\u4e49\u4e0b $10$ \u4e0d\u4e00\u5b9a\u6709\u9006\u5143\u3002\u6240\u4ee5\u8003\u8651\u5411\u540e\u8d21\u732e\u3002\n\n\u5047\u8bbe\u5df2\u7ecf\u5f97\u5230\u5f53\u524d\u72b6\u6001\uff0c\u4e14\u4e3a\u53ef\u8fbe\u3002\n\n\u82e5\u5c06\u7b2c $i+1$ \u4e2a\u6570\u67d3\u7ea2\uff0c\u5219\u5c06 $dp_{i+1,j\\times10+a_{i+1},k,r+1}$ \u6807\u8bb0\u4e3a\u53ef\u8fbe\u3002\n\n\u82e5\u5c06\u7b2c $i+1$ \u4e2a\u6570\u67d3\u9ed1\uff0c\u5219\u5c06 $dp_{i+1,j,k\\times10+a_{i+1},r}$ \u6807\u8bb0\u4e3a\u53ef\u8fbe\u3002\n\n\u6700\u540e\u627e\u51fa\u6ee1\u8db3 $dp_{n,0,0,i}$ \u4e3a\u771f\u65f6 $\\left|(n-i)-i\\right|$ \u7684\u6700\u5c0f\u503c\u3002\n\n\u4f46\u662f\uff0c\u8fd9\u4e2a\u53ea\u662f $\\left|r-b\\right|$ \u7684\u6700\u5c0f\u503c\uff0c\u800c\u9898\u76ee\u7ed9\u51fa\u6784\u9020\u3002\n\n\u90a3\u4e48\u8003\u8651\u591a\u52a0\u4e00\u7ef4 $dp_{i,j,k,r,0/1}$ \u8868\u793a\u524d $i$ \u4e2a\u9009\u4e86 $r$ \u4e2a\u7ea2\u8272\u7684\u70b9\uff0c\u7ec4\u6210\u7684\u5341\u8fdb\u5236\u6a21 $A$ \u4f59 $j$\uff0c\u4e14\u9009\u4e86 $i-r$ \u4e2a\u84dd\u70b9\uff0c\u7ec4\u6210\u7684\u5341\u8fdb\u5236\u6570\u6a21 $B$ \u4f59 $k$ \u4e14\u7b2c $i$ \u4e2a\u6570\u67d3\u8272\u4e3a \u7ea2 $/$ \u9ed1 \u662f\u5426\u53ef\u8fbe\u3002\n\n\u7136\u540e\u591a\u52a0\u4e0a\u4e00\u4e2a\u6570\u7ec4\u8bb0\u5f55\u524d\u9a71\uff0c\u5373\u4ece\u90a3\u4e2a\u72b6\u6001\u53ef\u4ee5\u5f97\u51fa\u8fd9\u4e2a\u72b6\u6001\u53ef\u8fbe\u3002\u4e3a\u4e86\u65b9\u4fbf\u8bb0\u5f55\uff0c\u53ef\u4ee5\u628a\u8fd9\u4e94\u4f4d\u7684\u72b6\u6001\u72b6\u538b\u5230\u4e00\u4e2a\u6570\u3002\n\n\u6700\u540e\u8f93\u51fa\u7b54\u6848\u7684\u65f6\u5019\u76f4\u63a5\u4ece\u627e\u5230\u7684\u67d0\u4e2a\u6ee1\u8db3 $dp_{i,j,k,r,0/1}$ \u4e3a\u771f\u4e14 $\\left|(n-i)-i\\right|$ \u6700\u5c0f\u7684\u72b6\u6001\u5f00\u59cb\u5f80\u56de\u9012\u5f52\u3002\u4e0d\u8fc7\u6ce8\u610f\u8fd9\u91cc\u662f\u4ece\u540e\u5f80\u524d\u590d\u539f\uff0c\u6240\u4ee5\u6700\u540e\u8fd8\u8981\u7ffb\u8f6c\u518d\u8f93\u51fa\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u7684\u65f6\u5019\uff0c\u56e0\u4e3a\u9664\u4e86\u6700\u5f00\u59cb\u7684\u72b6\u6001\uff0c\u82e5 $dp_{i,j,k,r,0/1}$ \u4e3a\u771f\uff0c\u5219\u8fd9\u4e2a\u72b6\u6001\u6240\u5bf9\u5e94\u7684\u524d\u9a71\u975e $0$\u3002\u90a3\u4e48\u5c31\u7ed9\u8fb9\u754c\u72b6\u6001\u7684\u524d\u9a71\u4e00\u4e2a\u503c $-1$\uff0c\u7136\u540e\u76f4\u63a5\u7528 $dp_{i,j,k,r,0/1}$ \u8bb0\u5f55\u524d\u9a71\u3002\n\n```cpp\n#include<algorithm>\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<cmath>\n#define mem(arr,val) memset(arr,val,sizeof arr)\nusing namespace std;\n\nconst int MX=41,MAXN=45,MAXM=MX*MX*MX*MX+5<<1;\ninline int getnum(int t1,int t2,int t3,int t4,bool t5){return t1*MX*MX*MX+t2*MX*MX+t3*MX+t4<<1|t5;}\nint n,A,B,a[MAXN];\nint f[MAXM];\n#define dp(t1,t2,t3,t4,t5) f[getnum(t1,t2,t3,t4,t5)]\n\nstring ans;\nvoid print(int x){\n\tif(x>0){\n\t\tans+=x&1?\"R\":\"B\";\t\t\t\t\t\t\t\t// \u56e0\u4e3a\u72b6\u538b\u7684\u65f6\u5019\u662f ...<<1|t5 \u6240\u4ee5 x&1 \u8868\u793a\u72b6\u6001 x \u7684\u7b2c\u4e94\u7ef4\uff0c\u4e5f\u5c31\u662f\u7b2c i \u4f4d\u6240\u67d3\u7684\u989c\u8272\n\t\tprint(f[x]);\n\t}\n}\ninline void solve(){\n\tscanf(\"%d%d%d\",&n,&A,&B);\n\tfor(int i=1;i<=n;i++)scanf(\"%1d\",&a[i]);\n\tmem(f,0);\n\tdp(1,a[1]%A,0,1,true)=dp(1,0,a[1]%B,0,false)=-1;\t// \u521d\u59cb\u72b6\u6001\n\tfor(int i=1;i<n;i++)\n\t\tfor(int j=0;j<A;j++)for(int k=0;k<B;k++)\n\t\t\tfor(int l=0;l<=i;l++){\n\t\t\t\tif(dp(i,j,k,l,false)){\n\t\t\t\t\tdp(i+1,(j*10+a[i+1])%A,k,l+1,true)=getnum(i,j,k,l,false);\n\t\t\t\t\tdp(i+1,j,(k*10+a[i+1])%B,l,false)=getnum(i,j,k,l,false);\n\t\t\t\t}\n\t\t\t\tif(dp(i,j,k,l,true)){\n\t\t\t\t\tdp(i+1,(j*10+a[i+1])%A,k,l+1,true)=getnum(i,j,k,l,true);\n\t\t\t\t\tdp(i+1,j,(k*10+a[i+1])%B,l,false)=getnum(i,j,k,l,true);\n\t\t\t\t}\n\t\t\t}\n\tint minn=n;\n\tfor(int i=1;i<n;i++)if(dp(n,0,0,i,false)||dp(n,0,0,i,true))minn=min(minn,abs(n-i-i));\n\tfor(int i=1;i<n;i++)for(int j=0;j<=1;j++)\n\t\tif(dp(n,0,0,i,j)&&abs(n-i-i)==minn){\t\t\t// \u968f\u4fbf\u627e\u4e00\u4e2a\u53ef\u8fbe\u4e14 abs(n-i-i) \u6700\u5c0f\u7684\u72b6\u6001\n\t\t\tans=\"\";\n\t\t\tprint(getnum(n,0,0,i,j));\n\t\t\treverse(ans.begin(),ans.end());\t\t\t\t// \u7ffb\u8f6c\u540e\u8f93\u51fa\n\t\t\tcout<<ans<<endl;\n\t\t\treturn;\n\t\t}\n\tprintf(\"-1\\n\");\t\t\t\t\t\t\t\t\t\t// \u5982\u679c\u4e00\u4e2a\u53ef\u8fbe\u7684\u72b6\u6001\u90fd\u4e0d\u5b58\u5728\uff0c\u5219\u65e0\u89e3\n}\nint main(){\n\tint T;scanf(\"%d\",&T);\n\twhile(T--)solve();\n\treturn 0;\n}\n```",
        "postTime": 1685104977,
        "uid": 350297,
        "name": "_maojun_",
        "ccfLevel": 6,
        "title": "CF1593F \u9898\u89e3"
    },
    {
        "content": "\u4e00\u9053\u601d\u7ef4\u96be\u5ea6\u5f88\u4f4e\u7684\u9898\u76ee\u3002\n\n\u6211\u4eec\u4e0d\u59a8\u5148\u8bbe $dp_{i,j,k,l}$ \u8868\u793a\u6211\u4eec\u5904\u7406\u5230\u7b2c $i$ \u4f4d\uff0c\u7ea2\u8272\u7684\u4f59\u6570\u4e3a $j$\uff0c\u9ed1\u8272\u7684\u4f59\u6570\u4e3a $k$\uff0c\u4e14\u6211\u4eec\u5df2\u7ecf\u9009\u62e9\u4e86 $l$ \u4e2a\u7ea2\u8272\u7684\u65b9\u6848\u662f\u5426\u5b58\u5728\uff08\u672c\u6765\u662f\u60f3\u8bb0 $l$ \u4e3a\u4e2a\u6570\u5dee\u7684\uff0c\u4f46\u6211\u53ef\u80fd\u6709\u70b9\u8822\uff09\u3002\n\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5341\u5206\u7b80\u5355\uff0c\u76f4\u63a5\u8003\u8651\u7b2c $i$ \u4e3a\u662f\u7ea2\u8272\u8fd8\u662f\u9ed1\u8272\u5373\u53ef\u3002\u4f46\u662f\u8003\u8651\u5230\u6211\u4eec\u8981\u8f93\u51fa\u65b9\u6848\uff0c\u5219\u989d\u5916\u518d\u5f00\u4e00\u70b9\u6570\u7ec4\u8bb0\u5f55\u6bcf\u4e00\u4e2a\u8f6c\u79fb\u7684\u51b3\u7b56\u5373\u53ef\u3002\u8f93\u51fa\u65f6\u6211\u4eec\u663e\u7136\u8981\u6309\u7167 $l$ \u8fdb\u884c\u9009\u62e9\uff0c\u4f46\u662f $l$ \u6700\u5c0f\u5e76\u4e0d\u4ee3\u8868\u5dee\u503c\u6700\u5c0f\uff0c\u6211\u4eec\u8003\u8651\u89e3\u4e00\u4e2a\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\uff1a\n\n$$\n\\begin{cases}\nx+y=n\\\\\nx-y=i\n\\end{cases}\n$$\n\n\u5176\u4e2d $i$ \u662f\u6211\u4eec\u679a\u4e3e\u7684\u5dee\u503c\uff0c\u8fd9\u4e2a\u5dee\u503c\u662f $-n$ \u5230 $n-2$ \u4e2d\u4ee5 $2$ \u4e3a\u516c\u5dee\u7684\u6570\uff08\u7a0d\u5fae\u60f3\u4e00\u60f3\u5c31\u77e5\u9053\u4e86\uff09\u3002\u5176\u4e2d $x,y$ \u5206\u522b\u662f\u4e00\u4e2a\u5dee\u503c\u5bf9\u5e94\u7684\u7ea2\u8272\u4e2a\u6570\u53d6\u503c\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(Tn^2ab)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int N=42;\ninline int read(){\n\tchar op=getchar();\n\tint w=0,s=1;\n\twhile(op<'0'||op>'9'){\n\t\tif(op=='-') s=-1;\n\t\top=getchar();\n\t}\n\twhile(op>='0'&&op<='9'){\n\t\tw=(w<<1)+(w<<3)+op-'0';\n\t\top=getchar();\n\t}\n\treturn w*s;\n}\nint a[N],dp[N][N][N][N],y[N][N][N][N];\nchar x[N][N][N][N];\nsigned main(){\n\tint T=read();\n\twhile(T--){\n\t\tint n=read(),A=read(),B=read();\n\t\tfor(register int i=1;i<=n;i++){\n\t\t\tchar op=getchar();\n\t\t\twhile(op<'0'||op>'9') op=getchar();\n\t\t\ta[i]=op-'0';\n\t\t}\n\t\tdp[1][a[1]%A][0][1]=1;\n\t\tdp[1][0][a[1]%B][0]=1;\n\t\tx[1][a[1]%A][0][1]='R';\n\t\tx[1][0][a[1]%B][0]='B';\n\t\tfor(register int i=2;i<=n;i++){\n\t\t\tfor(register int j=0;j<A;j++){\n\t\t\t\tfor(register int k=0;k<B;k++){\n\t\t\t\t\tfor(register int l=0;l<i;l++){\n\t\t\t\t\t\tdp[i][(j*10+a[i])%A][k][l+1]|=dp[i-1][j][k][l];\n\t\t\t\t\t\tdp[i][j][(k*10+a[i])%B][l]|=dp[i-1][j][k][l];\n\t\t\t\t\t\tif(dp[i-1][j][k][l]){\n\t\t\t\t\t\t\tx[i][(j*10+a[i])%A][k][l+1]='R';\n\t\t\t\t\t\t\ty[i][(j*10+a[i])%A][k][l+1]=j;\n\t\t\t\t\t\t\tx[i][j][(k*10+a[i])%B][l]='B';\n\t\t\t\t\t\t\ty[i][j][(k*10+a[i])%B][l]=k;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tbool op=false;\n\t\tchar s[45];\n\t\tfor(register int i=0;i<=44;i++) s[i]=0;\n\t\tfor(register int i=(n%2);i<=n-2;i+=2){\n\t\t\tif(dp[n][0][0][(n+i)/2]==1){//red most\n\t\t\t\tint now=n,p=0,q=0,r=(n+i)/2;\n\t\t\t\ts[n+1]=0;\n\t\t\t\twhile(now!=0){\n\t\t\t\t\ts[now]=x[now][p][q][r];\n\t\t\t\t\tif(s[now]=='R') p=y[now][p][q][r],r--;\n\t\t\t\t\telse q=y[now][p][q][r];\n\t\t\t\t\tnow--;\n\t\t\t\t}\n\t\t\t\tprintf(\"%s\\n\",s+1);\n\t\t\t\top=true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(dp[n][0][0][(n-i)/2]==1){\n\t\t\t\tint now=n,p=0,q=0,r=(n-i)/2;\n\t\t\t\ts[n+1]=0;\n\t\t\t\twhile(now!=0){\n\t\t\t\t\ts[now]=x[now][p][q][r];\n\t\t\t\t\tif(s[now]=='R') p=y[now][p][q][r],r--;\n\t\t\t\t\telse q=y[now][p][q][r];\n\t\t\t\t\tnow--;\n\t\t\t\t}\n\t\t\t\tprintf(\"%s\\n\",s+1);\n\t\t\t\top=true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(!op) printf(\"-1\\n\");\n\t\tmemset(dp,0,sizeof(dp));\n\t\tmemset(x,0,sizeof(x));\n\t\tmemset(y,0,sizeof(y));\n\t}\n}\n/*\n4\n5 3 13\n02165\n4 2 1\n1357\n8 1 1\n12345678\n2 7 9\n90\n*/\n```",
        "postTime": 1678008096,
        "uid": 754746,
        "name": "Resolute_Faith",
        "ccfLevel": 0,
        "title": "CF1593F Red-Black Number"
    }
]
[
    {
        "content": "\u5206\u89e3\u8d28\u56e0\u6570\u89c9\u5f97\u592a\u9ebb\u70e6\u4e86\uff0c\u6240\u4ee5\u6709\u4e86\u4ee5\u4e0b\u6295\u673a\u53d6\u5de7\u7684\u65b9\u6cd5\u3002\u3002\u3002~~(\u5176\u5b9e\u662f\u89c9\u5f97\u6839\u53f7\u7ea7\u7684\u4f1a$tle$\uff0c$log$\u7ea7\u7684\u61d2)~~\n\n\u5bf9\u4e8e\u6bcf\u4e00\u5bf9\u6570\u6c42\u5b83\u4eec\u7684$lcm$\uff0c\u7136\u540e\u5bf9\u4e8e\u6240\u6709\u7684$lcm$\u6c42$gcd$\uff0c\u663e\u7136$gcd$\u4e2d\u7684\u6240\u6709\u8d28\u56e0\u5b50\u6bcf\u4e00\u5bf9\u4e00\u5b9a\u4f1a\u51fa\u73b0\uff0c\u7136\u540e\u968f\u4fbf\u6c42\u4e00\u4e2a\u8d28\u56e0\u5b50\u5c31\u597d\u4e86\u3002\n\nAC\u4ee3\u7801\uff1a\n```\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n\n#define ll long long\n\nusing namespace std;\n\nll n,a,b,ans;\n\ninline ll gcd(ll x,ll y){\n\treturn x%y?gcd(y,x%y):y;\n}\n\ninline ll calc(ll x){//\u6c42\u4e00\u4e2a\u8d28\u56e0\u5b50\n\tfor(int i=2;i<=sqrt(x);i++){\n\t\tif(x%i==0){\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn x;\n}\n\nint main(){\n\tios::sync_with_stdio(false);\n\tcin>>n;\n\tn--;\n\tcin>>a>>b;\n\tans=a*b/gcd(a,b);\n\twhile(n--){\n\t\tcin>>a>>b;\n\t\tans=gcd(ans,a*b/gcd(a,b));//\u5bf9\u4e8e\u6240\u6709\u7684lcm\u6c42gcd\n\t}\n\tif(ans==1){//\u5982\u679cgcd\u4e3a1\uff0c\u90a3\u4e48\u5c31\u6ca1\u6709wcd\n\t\tcout<<-1<<endl;\n\t}else{\n\t\tif(gcd(ans,a)>1){//\u8981\u6c42\u7684\u56e0\u5b50\u4e00\u5b9a\u5728a\u4e2d\u6216b\u4e2d\n\t\t\tcout<<calc(gcd(ans,a))<<endl;\n\t\t}else{\n\t\t\tcout<<calc(gcd(ans,b))<<endl;\n\t\t}\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1538139635,
        "uid": 27884,
        "name": "zhaotiensn",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1025B \u3010Weakened Common Divisor\u3011"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u9053\u5f88\u666e\u901a\u7684\u9898\u3002\n\n\u4f46\u662f\uff0c\u8981\u6ce8\u610f\uff0c\u9700\u8981\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u56e0\u4e3a\u6bcf\u4e00\u4e2a\u56e0\u6570\u90fd\u53ef\u4ee5\u5206\u89e3\u6210\u8d28\u7684\u56e0\u6570\uff0c\u6240\u4ee5\u8fd9\u6837\u5e72\u3002\n\n\u6211\u7684\u505a\u6cd5\u662f\u8981\u5b58\u7b2c\u4e00\u5bf9\u6570\u7684\u8d28\u56e0\u6570\uff0c\u7136\u540e\u626b\u540e\u9762\u7684\uff0c\u4e0d\u505c\u5730\u628a\u4e0d\u662f\u7684\u53bb\u6389\uff0c\u6700\u540e\u5269\u4e0b\u7684\u5c31\u662f\u8f93\u51fa\u4e86\uff0c\u82e5\u6ca1\u6709\u5269\uff0c\u8f93\u51fa-1.\n\nAC\u4ee3\u7801\u5982\u4e0b\uff1a\n\n\uff08\u8be6\u89e3\u5728\u4ee3\u7801\u91cc\u3002\uff09\n\n```cpp\n#include <bits/stdc++.h>\u4e07\u80fd\u5934\nusing namespace std;\n\nlong long n,f[150000],top;f\u6570\u7ec4\u7528\u6765\u5b58\u7b2c\u4e00\u5bf9\u6570\u7684\u8d28\u56e0\u6570\u3002\nlong long a,b;\nint main() {\n\tscanf(\"%lld\",&n);\u8bfb\u5165\n\tfor(int i=1; i<=n; i++) {\n\t\tscanf(\"%lld %lld\",&a,&b);\u8bfb\u5165\n\t\tif(i==1) {\u7b2c\u4e00\u6b21\u7684\u8fd9\u4e00\u5bf9\n\t\t\tfor(int j=2; j<=sqrt(a)\u6ce8\u610f\u8fd9\u91cc\u53ef\u4ee5\u7701\u65f6\u95f4; j++) {\n\t\t\t\twhile(a!=j) {\n\t\t\t\t\tif(a%j==0) {\n\t\t\t\t\t\tf[top]=j;           \u8fd9\u91cc\u662fa\u5206\u89e3\u8d28\u56e0\u6570\n\t\t\t\t\t\ttop++;\n\t\t\t\t\t\ta/=j;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(a>1) f[top]=a,top++;\u6ce8\u610f\uff01\u81ea\u5df1\u4e5f\u8981\u7b97\u8fdb\u53bb\u54e6\uff01\n\t\t\tfor(int j=2; j<=sqrt(b)\u6ce8\u610f\u8fd9\u91cc\u53ef\u4ee5\u7701\u65f6\u95f4; j++) {\n\t\t\t\twhile(b!=j) {\n\t\t\t\t\tif(b%j==0) {\n\t\t\t\t\t\tf[top]=j;           \u8fd9\u91cc\u662fb\u5206\u89e3\u8d28\u56e0\u6570\n\t\t\t\t\t\ttop++;\n\t\t\t\t\t\tb/=j;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(b>1) f[top]=b,top++;\u6ce8\u610f\uff01\u81ea\u5df1\u4e5f\u8981\u7b97\u8fdb\u53bb\u54e6\uff01\n\t\t\tcontinue;\n\t\t}\n\t\tfor(int j=0; j<=top-1; j++) {\u5f00\u59cb\u626b\u540e\u9762\u7684\n\t\t\tif(a%f[j]!=0&&b%f[j]!=0) {\u82e5\u4e0d\u662f\u5c31\u5f04\u6389\u3002\n\t\t\t\tf[j]=-1;\u6ce8\u610f\u662f\u201c&&\u201d\uff0c\u56e0\u4e3a\u201cWCD\u201d\u7684\u5b9a\u4e49\u3002\n\t\t\t}\n\t\t}\n\t}\n\tfor(int j=0; j<=top-1; j++) {\n\t\tif(f[j]!=-1) {\n\t\t\tprintf(\"%lld\",f[j]);\u6109\u5feb\u8f93\u51fa\n\t\t\treturn 0;\n\t\t}\n\t}\n\tcout<<\"-1\";\u6109\u5feb\u8f93\u51fa\n\treturn 0;\n    \u5b8c\u7f8eAC\uff01\uff01\uff01\uff01\uff01\n}\n```\n\n\u82e5\u8fd8\u6709\u4e0d\u61c2\u7684\u53ef\u4ee5\u79c1\u4fe1\u95ee\u6211\uff0c\u6211\u4f1a\u5c3d\u529b\u5e2e\u4f60\u89e3\u51b3\u95ee\u9898\u7684\uff01",
        "postTime": 1536937830,
        "uid": 31728,
        "name": "si_zhong",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1025B \u3010Weakened Common Divisor\u3011"
    },
    {
        "content": "\u9898\u5916\u8bdd\uff1a\u6211\u4e00\u5f00\u59cb\u60f3\u9884\u5904\u7406 $2\\times 10^8$ \u5185\u6240\u6709\u8d28\u6570\uff0c\u4e0d\u51fa\u610f\u5916 MLE \u4e86\uff08\n\n### \u9898\u76ee\u5206\u6790\n\n\u6839\u636e\u9898\u76ee\u4e2d\u7684\u5b9a\u4e49\uff0c\u6613\u77e5\u82e5 $x$ \u4e3a $\\text{wcd}[(a_1,b_1),(a_2,b_2),...,(a_n,b_n)]$\uff0c\u5219 $x$ \u7684\u6240\u6709\u9664\u4e86 $1$ \u4e4b\u5916\u7684\u56e0\u6570\u90fd\u662f $\\text{wcd}[(a_1,b_1),(a_2,b_2),...,(a_n,b_n)]$\u3002\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u4ece\u8d28\u6570\u5f00\u59cb\u4e00\u4e2a\u4e00\u4e2a\u627e\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u5f00\u59cb\u6211\u4eec\u5c31\u53ef\u4ee5\u5148\u5206\u89e3\u51fa $a_1,b_1$ \u7684\u8d28\u56e0\u5b50\uff0c\u7136\u540e\u4e0e $a_i,b_i$ \u9010\u4e2a\u5224\u65ad\u80fd\u5426\u6574\u9664\u5373\u53ef\u3002\n\n### \u5b8c\u6574\u4ee3\u7801\n\n\u603b\u5171 709 \u6beb\u79d2\uff0c\u5341\u5206\u4f18\u79c0\u3002\u590d\u6742\u5ea6 $O\\left (\\sqrt{a_1}+\\sqrt{b_1}+n(a_1\\text{\u7684\u8d28\u56e0\u6570\u4e2a\u6570}+b_1\\text{\u7684\u8d28\u56e0\u6570\u4e2a\u6570})\\right )=O(\\text{\u8d85\u5feb})$\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <algorithm>\n#include <cctype>\n#include <map>\n#include <iomanip>\n\nusing namespace std;\n\n#define getchar()  (sp == ep && (ep = (sp = ibuf) + fread(ibuf,1,mm,stdin),sp == ep) ? EOF : *sp++)\n#define putchar(x) ((op-obuf<mm) ? (*op++=x) : (fwrite(obuf,op-obuf,1,stdout),op=obuf,*op++=x))\n\nconst int N = 150050;\nconst int mm = 1 << 20;\nstatic char ibuf[mm],obuf[mm],*sp=ibuf,*ep=ibuf,*op = obuf,*p3 = obuf;\n\ninline int read(){\n\tint flag = 1, x = 0;\n\tchar ch = getchar();\n\twhile (!isdigit(ch)) {\n\t\tif (ch == '-')\n\t\t\tflag = -1;\n\t\tch = getchar();\n\t}\n\twhile (isdigit(ch)) {\n\t\tx = (x<<3) + (x<<1) + (ch^48);\n\t\tch = getchar();\n\t}\n\treturn flag*x;\n}\n\nvoid write(int x){\n\tchar ch[20];\n\tint len = 0;\n\tif(x < 0)\n\t\tputchar('-'), x = -x;\n\tdo {\n\t\tch[len++] = (x%10)^48;\n\t\tx /= 10;\n\t}\n\twhile(x);\n\n\twhile(len--)\n\t\tputchar(ch[len]);\n \tputchar(' ');\n}\n\nvoid ln() {\n\tputchar('\\n');\n}\n\nvoid writeln(int x){\n\twrite(x);\n\tln();\n}\n\nstruct Num {\n\tint a, b;\n} num[N];\n\nint main() {\n\tint n = read(); \n\tmap<int, int> primes; //\u7528map\u5b58\u50a8a1,b1\u7684\u8d28\u56e0\u5b50\n\t\n\tint a1 = read(), b1 = read();\n\tfor (int i = 2; i <= a1/i; ++i) { //\u5206\u89e3a1\u7684\u8d28\u56e0\u5b50\n\t\twhile (a1 % i == 0)\n\t\t\tprimes[i] ++, a1 /= i;\n\t}\n\tif (a1 > 1) //\u5982\u679c\u5206\u89e3\u5b8c\u540ea1\u4ecd\u7136\u5927\u4e8e1,\u8bf4\u660ea1\u6709\u4e00\u4e2a\u5927\u4e8e\u7b49\u4e8esqrt(a1)\u7684\u8d28\u56e0\u5b50\n\t\tprimes[a1] ++;\n\tfor (int i = 2; i <= b1/i; ++i) { //\u5206\u89e3b1\u7684\u8d28\u56e0\u5b50\n\t\twhile (b1 % i == 0)\n\t\t\tprimes[i] ++, b1 /= i;\n\t}\n\tif (b1 > 1)\n\t\tprimes[b1] ++;\n\t\n\tfor (int i = 2; i <= n; ++i) \n\t\tnum[i].a = read(), num[i].b = read();\n\t\n\tfor (auto p : primes) { //\u904d\u5386\u6bcf\u4e00\u4e2a\u8d28\u56e0\u5b50,\u9010\u4e2a\u5224\u65ad\u662f\u5426\u6ee1\u8db3\u8981\u6c42\n\t\tbool check = 1;\n\t\tint pr = p.first;\n\t\tfor (int i = 2; i <= n; ++i) {\n\t\t\tif (!(num[i].a % pr == 0 || num[i].b % pr == 0)) { //\u4e0d\u80fd\u6574\u9664\u5c31\u76f4\u63a5\u6362\u4e0b\u4e00\u4e2a\u8d28\u6570\n\t\t\t\tcheck = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (check) {\n\t\t\twriteln(pr);\n\t\t\tfwrite(obuf,op-obuf,1,stdout);\n\t\t\treturn 0;\n\t\t}\n\t}\n\tputs(\"-1\"); //\u5982\u679c\u6240\u6709\u8d28\u6570\u90fd\u4e0d\u884c\u7684\u8bdd\u8bf4\u660e\u65e0\u89e3\n\tfwrite(obuf,op-obuf,1,stdout);\n\treturn 0;\n}\n```",
        "postTime": 1657373830,
        "uid": 581830,
        "name": "Jasper08",
        "ccfLevel": 4,
        "title": "CF1025B \u9898\u89e3"
    },
    {
        "content": "## \u9898\u610f\n\n\u7ed9\u51fa $n$ \u5bf9\u6570 $(a_i,b_i)$\uff0c\u6c42\u4efb\u610f\u4e00\u4e2a $k$\uff0c\u4f7f\u5f97\u5bf9\u4e8e\u6240\u6709 $1 \\le i \\le n$ \u6709 $k|a_i$ \u6216 $k|b_i$ \u6210\u7acb\u3002\u82e5\u4e0d\u5b58\u5728\u8f93\u51fa $-1$\u3002\n\n## \u9898\u89e3\n\n\u7b54\u6848\u5373\n\n$$\n\\gcd(\\operatorname{lcm}(a_1,b_1),\\operatorname{lcm}(a_2,b_2),...,\\operatorname{lcm}(a_n,b_n))\n$$\n\n**\u7684\u4efb\u610f\u4e00\u4e2a\u56e0\u6570**\uff0c\u5f53\u4e0a\u5f0f\uff08\u8bbe\u4e3a $ans$\uff09\u7b49\u4e8e $1$ \u65f6\u65e0\u89e3\u3002\u4e0b\u9762\u6211\u4eec\u8bc1\u660e\u8fd9\u4e2a\u7ed3\u8bba\u3002\n\n\u5148\u770b\u4e24\u4e2a\u5f15\u7406\uff0c\u5f53 $k\\le a,b$ \u65f6\uff1a\n\n- $k|a$ \u6216 $k|b \\Leftrightarrow k|\\operatorname{lcm}(a,b)$\uff1b  \n- $k|a$ \u4e14 $k|b \\Leftrightarrow k|\\gcd(a,b)$\u3002\n\n\u8fd9\u4e24\u4e2a\u5f15\u7406\u53ef\u4ee5\u901a\u8fc7\u552f\u4e00\u5206\u89e3\u5b9a\u7406\u8bc1\u660e\uff0c\u4ee5 $\\operatorname{lcm}$ \u4e3a\u4f8b\uff1a\n\n> \u8bbe $p_i$ \u662f\u7b2c $i$ \u5c0f\u7684\u8d28\u6570\u3002\u4ee4 $a=p_1^{n_1}p_2^{n_2}...p_x^{n_x},b=p_1^{m_1}p_2^{m_2}...p_y^{m_y}$\u3002  \n\u5219 $\\operatorname{lcm}(a,b)=p_1^{\\max\\{n_1,m_1\\}}p_2^{\\max\\{n_2,m_2\\}}...p_{\\max\\{x,y\\}}^{\\max\\{n_x,m_y\\}}$\u3002  \n\u4ee4 $k=p_1^{q_1}p_2^{q_2}...p_z^{q_z}(z\\le x,y)$\uff0c\u5219 $k|a$ \u7b49\u4ef7\u4e8e $\\forall i \\in [1,z],q_i \\le n_i$\uff0c\u540c\u7406 $k|b$ \u7b49\u4ef7\u4e8e $\\forall i \\in [1,z],q_i \\le m_i$\u3002  \n$k|a$ **\u6216** $k|b$ \u6210\u7acb\uff0c\u5373 $q_i \\le n_i$ \u6216 $q_i \\le m_i$\uff0c\u4e5f\u5373 $q_i \\le \\max\\{n_i,m_i\\}$\uff0c\u4e5f\u5c31\u662f $k|\\operatorname{lcm}(a,b)$\u3002  \n\uff08\u5bf9\u4e8e $\\gcd$\uff0c\u628a $\\max$ \u6362\u6210 $\\min$ \u5373\u53ef\uff0c\u5341\u5206\u7c7b\u4f3c\u3002\uff09\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u6570\u5bf9 $(a_i,b_i)$\uff0c\u6709 $k|a_i$ \u6216 $k|b_i$ \u6210\u7acb\uff0c\u6839\u636e\u5f15\u7406\u4e00\uff0c\u5373 $k|\\operatorname{lcm}(a_i,b_i)$ \u6210\u7acb\u3002\u5bf9\u4e8e\u6240\u6709\u6570\u5bf9\uff0c$k$ \u90fd\u8981\u6ee1\u8db3 $k|\\operatorname{lcm}(a_i,b_i)$\uff0c\u6839\u636e\u5f15\u7406\u4e8c\uff0c\u5373\u5f97 $k|\\gcd(\\operatorname{lcm}(a_i,b_i))$\u3002\n\n\u6240\u4ee5\u5bf9 $ans$ \u8d28\u56e0\u6570\u5206\u89e3\uff0c\u5e76\u4efb\u610f\u8f93\u51fa\u4e00\u4e2a\u56e0\u6570\u3002  \n\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c$ans$ \u5728 `long long` \u8303\u56f4\u5185\uff0c\u76f4\u63a5 $O(\\sqrt{ans})$ \u5206\u89e3\u4f1a\u8d85\u65f6\u3002\u6ce8\u610f\u5230 $k$ \u4e00\u5b9a\u5c0f\u4e8e\u4efb\u610f\u4e00\u5bf9 $a,b$\uff0c\u56e0\u6b64\u6211\u4eec\u8ba1\u7b97 $\\gcd(ans,a)$ \u6216 $\\gcd(ans,b)$\uff08\u8fd9\u91cc\u7684 $a,b$ \u65b9\u4fbf\u8d77\u89c1\uff0c\u53d6\u6700\u540e\u4e00\u5bf9\uff09\uff0c\u5206\u89e3\u8fd9\u4e24\u4e2a\u6700\u5927\u516c\u7ea6\u6570\u5373\u53ef\u3002\n\n## \u4ee3\u7801\n\n```cpp\n// factor(x) \u8fd4\u56de x \u6700\u5c0f\u7684\u8d28\u56e0\u6570\nn=read<int>();\nfor(int i=1;i<=n;++i)\n{\n    a=read<ll>(),b=read<ll>();\n    ans=gcd(ans,lcm(a,b));\n}\nif(ans==1)\n{\n    puts(\"-1\");\n    return 0;\n}\nelse\n{\n    if(gcd(ans,a)!=1)\n        printf(\"%lld\\n\",factor(gcd(ans,a)));\n    else\n        printf(\"%lld\\n\",factor(gcd(ans,b)));\n}\n```",
        "postTime": 1685197758,
        "uid": 450246,
        "name": "Franz_Liszt",
        "ccfLevel": 4,
        "title": "CF1025B Weakened Common Divisor \u9898\u89e3"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u4e2a\u7406\u8bba\u65f6\u95f4\u590d\u6742\u5ea6\u66f4\u4f18\u79c0\u7684\u505a\u6cd5\u3002\n\n\u9996\u5148\u4e0d\u96be\u53d1\u73b0\u53ea\u8981\u628a\u524d\u4e24\u4e2a\u6570\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u5219\u7b54\u6848\u4e00\u5b9a\u5728\u8fd9\u4e9b\u8d28\u56e0\u6570\u4e4b\u95f4\u4ea7\u751f\u3002\u4e8e\u662f\u5206\u89e3\u524d\u4e24\u4e2a\u6570\u7684\u8d28\u56e0\u5b50\u4e4b\u540e\u9010\u4e00\u679a\u4e3e\u540e\u9762\u7684\u6570\u5224\u65ad\u662f\u5426\u5408\u6cd5\u5373\u53ef\u3002\n\n\u74f6\u9888\u5728\u5982\u4f55\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u663e\u7136\u53ef\u4ee5\u66b4\u529b $ \\mathcal{O}(\\sqrt{n}) $ \u5206\u89e3\uff0c\u4f46\u8fd9\u4e48\u505a\u4e0d\u591f\u597d\uff0c\u6211\u4eec\u8003\u8651\u7528 Pollard-rho \u5206\u89e3\u8d28\u56e0\u6570\uff0c\u53ef\u4ee5\u505a\u5230 $ \\mathcal{O}(n^{\\frac{1}{4}}) $ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u5206\u89e3\u3002\n\n\u56e0\u4e3a\u8d28\u56e0\u5b50\u4e2a\u6570\u662f $ \\log $ \u7ea7\u522b\u7684\uff0c\u6240\u4ee5\u6700\u540e\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $ \\mathcal{O}(\\max{a_i}^{\\frac{1}{4}}+n\\log{\\max{a_i}}) $\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define gc c=getchar()\n#define r(x) read(x)\n#define ll long long\n#define int long long\ntemplate<typename T>\ninline void read(T&x) {\n\tx=0;\n\tT k=1;\n\tchar gc;\n\twhile(!isdigit(c)) {\n\t\tif(c=='-')k=-1;\n\t\tgc;\n\t}\n\twhile(isdigit(c)) {\n\t\tx=x*10+c-'0';\n\t\tgc;\n\t}\n\tx*=k;\n}\n#define li inline\n#define re register\ninline int add(int a,int b,int p) {\n\ta+=b;\n\tif(a>=p)\n\t    a-=p;\n\treturn a;\n}\ninline int mul(int a,int b,int mod) {\n\treturn (a*b-(int)((long double)a/mod*b)*mod+mod)%mod;\n}\nll pow(ll a, ll b, ll m) {\n\tll ans = 1;\n\tfor (a %= m; b; b >>= 1, a = mul(a, a, m))\n\t    if (b & 1) \n\t    ans = mul(ans, a, m);\n\treturn ans;\n}\nll gcd(ll a,ll b) {\n\treturn b?gcd(b,a%b):a;\n}\nll lcm(ll a,ll b) {\n\treturn a/gcd(a,b)*b;\n}\nbool MR_check(ll a, ll p, ll s, int d) {\n\tll k = pow(a, s, p);\n\tif (k == 1) return true;\n\tfor (; d; --d, k = mul(k, k, p)) {\n\t\tif (k == p - 1) \n\t\t    return true;\n\t\tif (k == 1) \n\t\t    return false;\n\t}\n\treturn k == 1;\n}\nbool MR(ll x) {\n\tstatic const int cnt = 12;\n\tstatic const int p[cnt] = {\n\t\t2, 3, 5, 7, 11, 13, 17, 19, 61, 2333, 4567, 24251\n\t}\n\t;\n\tif (x == 1) \n\t  return false;\n\tll s = x - 1;\n\tint d = 0;\n\twhile (!(s & 1)) \n\t  ++d, s >>= 1;\n\tfor (int i = 0; i < cnt; ++i) {\n\t\tif (x % p[i] == 0) \n\t\t    return x == p[i];\n\t\tif (!MR_check(p[i], x, s, d)) \n\t\t    return false;\n\t}\n\treturn true;\n}\nnamespace Pollard_Rho {\n\tll PR_check(ll c, ll p) {\n\t\tll y = rand() % p, z = y;\n\t\tint k = 1, j = 0;\n\t\twhile(1145141919810) {\n\t\t\tz = (mul(z, z, p) + c) % p;\n\t\t\tll t = gcd(p, std::abs(z - y));\n\t\t\tif (t > 1) \n\t\t\t    return t;\n\t\t\tif (++j == k) \n\t\t\t    y = z, k <<= 1;\n\t\t}\n\t}\n\tvoid factor_(ll x, std::vector<ll> &v) {\n\t\tif (x == 1) return;\n\t\tif (MR(x)) {\n\t\t\tv.push_back(x);\n\t\t\treturn;\n\t\t}\n\t\tll y = x;\n\t\twhile (y == x) y = PR_check(rand() % x, x);\n\t\tfactor_(y, v);\n\t\tfactor_(x / y, v);\n\t}\n\tvoid factor(ll x, std::vector<ll> &v) {\n\t\tv.clear();\n\t\tif (!(x & 1)) {\n\t\t\tv.push_back(2);\n\t\t\tx /= (x & -x);\n\t\t}\n\t\tfactor_(x, v);\n\t\tstd::sort(v.begin(), v.end());\n\t\tv.erase(std::unique(v.begin(), v.end()), v.end());\n\t}\n}\nusing Pollard_Rho::factor;\nint a[2000020],b[2000020];\nsigned main() \n{\n\tint T=1;\n\tfor (;T;--T) \n\t{\n\t\tint n;\n\t\tr(n);\n\t\tfor (int i=1;i<=n;i++)\n\t\t        r(a[i]),r(b[i]);\n\t\tvector<int>d;\n\t\tvector<int>final;\n\t\tfactor(a[1],d);\n\t\tfor (auto x:d)\n\t\t        final.push_back(x);\n\t\tfactor(b[1],d);\n\t\tfor (auto x:d)\n\t\t        final.push_back(x);\n\t\tfor (auto x:final) \n\t\t{\n\t\t\tbool ok=1;\n\t\t\tfor (int i=2;i<=n;i++)\n\t\t\t        if(a[i]%x&&b[i]%x)\n\t\t\t        ok=0;\n\t\t\tif(ok)\n\t\t\t        return !printf(\"%d\",x);\n\t\t}\n\t\tputs(\"-1\");\n\t}\n}\n```\n",
        "postTime": 1671749236,
        "uid": 714821,
        "name": "loser_seele",
        "ccfLevel": 4,
        "title": "CF1025B\u9898\u89e3"
    },
    {
        "content": "\u5176\u4ed6\u7684\u51e0\u7bc7\u9898\u89e3\u5927\u591a\u90fd\u662f\u5148\u6c42\u4e86 $c_i \\gets lcm(a_i,b_i)$ \uff0c\u7136\u540e\u6c42\u5168\u90e8 $c_i$ \u7684\u6700\u5927\u516c\u7ea6\u6570\uff0c\u4f46\u662f\u5bf9\u6bcf\u4e00\u7ec4\u6570\u90fd\u6c42\u4e00\u4e0b $lcm(a_i,b_i)$ \u4f1a\u589e\u52a0\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u6240\u4ee5\u76f4\u63a5\u628a $a_i$ \uff0c$b_i$ \u4e58\u8d77\u6765\u5c31\u884c\uff0c\u4e0d\u59a8\u8bb0\u5f55$c_i \\gets a_i * b_i $ \u6700\u540e\u518d\u6c42\u6240\u4ee5 $c_i$ \u7684\u6700\u5927\u516c\u7ea6\u6570\uff0c\u6c42\u6240\u4ee5 $c_i$ \u7684\u6700\u5927\u516c\u7ea6\u6570\u7684\u65b9\u6cd5\u662f\u5148\u6c42 $now \\gets gcd(c_{i-1},c_{i-2})$ \uff0c\u7136\u540e\u518d\u6c42 $gcd(now,c_i)$ \uff0c\u4e3a\u4ec0\u4e48 $gcd(a,b,c)=gcd(gcd(a,b),c)$ \u5462\uff0c\u56e0\u4e3a \n$$\n\n  gcd(a,b)=\\prod_{p} p^{min(a_p,b_p)}\n$$\n\u5176\u4e2d $a_p$ \u4e0e $b_p$ \u4e3a $a,b$ \u8d28\u56e0\u6570 $p$ \u7684\u6307\u6570\uff0c\u8bb0\u4e0a\u9762\u8fd9\u4e2a\u5927\u5f0f\u5b50\u4e3a $q$ ,\u90a3\u4e48\n$$\n\n  gcd(q,b)=\\prod_{p} p^{min(q_p,c_p)}=\\prod_{p} p^{min(min(a_p,b_p),c_p)}\n$$\n\u56e0\u4e3a $min(min(a,b),c)$ \u7b49\u4ef7\u4e8e $min(a,b,c)$ \uff0c\u5373 $min$ \u6ee1\u8db3\u7ed3\u5408\u5f8b \uff0c\u6240\u4ee5 $gcd$ \u4e5f\u662f\u6ee1\u8db3\u7ed3\u5408\u5f8b\u7684\u3002\n\n\u5f53\u7136\u6c42\u51fa\u6240\u4ee5 $c_i$ \u7684\u6700\u5927\u516c\u7ea6\u6570\uff08\u8bb0\u4f5c $ans$ \uff09\u662f\u4e0d\u6ee1\u8db3\u8981\u6c42\u7684 \uff0c\u4f46\u662f\u56e0\u4e3a $ans$ \u7684\u8d28\u56e0\u6570\u4e00\u5b9a\u5728\u6240\u4ee5 $c_i$ \u4e2d\u90fd\u6709\uff0c\u6240\u4ee5 $ans$ \u7684\u8d28\u56e0\u6570\u4e00\u5b9a\u662f\u5728\u4e0e $c_i$ \u5bf9\u5e94\u7684 $a_i$ \uff0c$b_i$ \u81f3\u5c11\u4e00\u4e2a\u4e2d\u5b58\u5728 \uff0c\u4e14\u6307\u6570\u5c0f\u4e8e\u7b49\u4e8e $min(a_p,b_p)$ \uff0c\u6240\u4ee5\u8f93\u51fa $ans$ \u8f93\u51fa\u4e00\u4e2a\u8d28\u56e0\u6570\u5373\u53ef\uff0c\u663e\u7136\u5f53\u6240\u6709 $c_i$ \u7684\u6700\u5927\u516c\u7ea6\u6570\u4e3a $1$ \u65f6\u4e0d\u5b58\u5728 \uff0c\u4f46\u662f\u8fd9\u9898\u6709\u70b9\u5361\u8d28\u56e0\u6570\u5206\u89e3 \uff0c\u6240\u4ee5\u5224\u65ad\u4e00\u4e0b\u9009 $a_1$ \u8fd8\u662f $b_1$ \u7136\u540e\u4e0e $ans$ \u53d6\u4e2a\u6700\u5927\u516c\u7ea6\u6570\u80fd\u51cf\u5c0f\u8981\u5206\u89e3\u7684\u6570\u7684\u5927\u5c0f \uff0c\u5177\u4f53\u89c1\u4ee3\u7801\u5b9e\u73b0\n### \u4ee3\u7801\u5b9e\u73b0:\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll read()\n{\n\tll X=0,w=0;char ch=0;\n\twhile(!isdigit(ch)){w|=ch=='-';ch=getchar();}\n\twhile(isdigit(ch)){X=(X<<3)+(X<<1)+(ch^48);ch=getchar();}\n\treturn w?-X:X;\n}\n\nvoid write(ll x)\n{\n\tif(x<0){putchar('-');x=-x;}\n\tif(x>9){write(x/10);}\n\tputchar(x%10+'0');\n}\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll lcm(ll a,ll b){return a*b/gcd(a,b);}\nstruct node\n{\n\tll a,b,l;\n\t\n};\nll f(ll x)\n{\n\tfor(int i=2;i<=sqrt(x);i++)\n\t{\n\t\tif(x%i==0){\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn x;\n}\nint main()\n{\n\tll n=read();\n\tnode arr[150000];\n\tll aaa,bbb;\n\tcin>>aaa>>bbb;\n\t for(int i=1;i<n;i++)\n\t {\n\t \tarr[i].a=read();\n\t \tarr[i].b=read();\n\t \tarr[i].l=arr[i].a*arr[i].b;\n        aaa=gcd(arr[i].a*arr[i].b,aaa);\n        bbb=gcd(arr[i].a*arr[i].b,bbb);\n\t }\n\t ll now=gcd(arr[0].l,arr[1].l);\n\tfor (int i=2;i<n;i++)\n\t{\n\t\tnow=gcd(now,arr[i].l);\n\t}\n\tif(now==1)\n\t{\n\t\tcout<<\"-1\";\n\t\treturn 0;\n\t}\n\tif(aaa!=1)\n\t{\n\t\tcout<<f(aaa);\n\t}\n\telse if(bbb!=1) cout<<f(bbb);\n\telse cout<<\"-1\";\n\treturn 0;\n}\n```\n",
        "postTime": 1626163502,
        "uid": 413777,
        "name": "npqenqpve",
        "ccfLevel": 0,
        "title": "CF1025B \u9898\u89e3"
    },
    {
        "content": "\u672c\u7bc7\u9898\u89e3\u4e3b\u8981\u662f\u89e3\u91ca\u7b2c\u4e00\u7bc7\u9898\u89e3\uff08@zhaotiensn \u7684\u90a3\u7bc7\uff09\u4e3a\u5565\u662f\u5bf9\u7684\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u77e5\u9053\u5982\u679c\u4e00\u4e2a\u6570 $d$ \u53ef\u4ee5\u6574\u9664 $a$\uff0c\u90a3\u4e48 $d$ \u4e00\u5b9a\u662f\u53ef\u4ee5\u6574\u9664 $\\operatorname{lcm}(a,b)$ \u7684\uff0c\u6240\u4ee5\u6211\u4eec\u731c\u6d4b\u7b54\u6848\u5c31\u662f\u6bcf\u7ec4 $a,b$ \u7684 $\\operatorname{lcm}$ \u7684 $\\gcd$\u3002 \n\n\u4f46\u662f\u660e\u663e\u4e0d\u5bf9\u554a\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u6570\uff08\u5f80\u540e\u8fd9\u4e2a\u6570\u6211\u4eec\u7ba1\u5b83\u53eb\u505a $tmp$\uff09\u4e0d\u4e00\u5b9a\u662f\u8d28\u6570\uff0c\u5b83\u6216\u8bb8\u80fd\u62c6\u6210 $x \\times y$\uff0c\u5176\u4e2d $x$ \u53ef\u4ee5\u6574\u9664 $a$\uff0c$y$ \u53ef\u4ee5\u6574\u9664 $b$\uff0c\u4f46\u662f\u8fd9\u4e2a\u6570\u65e2\u4e0d\u80fd\u6574\u9664 $a$\uff0c\u53c8\u4e0d\u80fd\u6574\u9664 $b$\u3002\n\n\u6240\u4ee5\u600e\u4e48\u529e\uff1f\u90a3\u6211\u4eec\u5c31\u627e $tmp$ \u7684\u4e00\u4e2a\u8d28\u56e0\u6570\uff0c\u8fd9\u4e2a\u6570\u4efb\u4f55\u4e00\u4e2a\u8d28\u56e0\u6570\u90fd\u662f\u6ca1\u95ee\u9898\u7684\uff0c\u56e0\u4e3a\u8d28\u6570\u5c31\u4e0d\u80fd\u62c6\u4e86\u3002\n\n\u90a3\u600e\u4e48\u627e\u5462\uff1f\u4f60\u76f4\u63a5 $O(\\sqrt{tmp})$ \u7684\u505a\u6cd5\u662f\u8fc7\u4e0d\u53bb\u7684\uff0c\u53ef\u4ee5\u88ab\u8fd9\u7ec4\u6570\u636e\u5361\u6389\uff1a\n```\n1\n1999999973 1999999943\n```\n\n\u600e\u4e48\u529e\u5462\uff1f\u5176\u5b9e\u53ef\u4ee5\u7528 pollard rho \u7b97\u6cd5\u6765\u505a\uff0c\u4f46\u5f88\u9057\u61be\uff0c\u6211\u4e0d\u4f1a\u3002\u3002\u3002\n\n\u4f46\u662f\u8fd9\u4e2a\u8d28\u56e0\u6570\u660e\u663e\u662f\u80fd\u6574\u9664 $a$ \u548c $b$ \u4e2d\u7684\u4e00\u4e2a\uff0c\u6240\u4ee5\u5982\u679c $\\gcd(a,tmp) > 1$\u7684\u8bdd\u5c31\u627e $\\gcd(a,tmp)$ \u7684\u67d0\u4e2a\u8d28\u56e0\u6570\uff0c\u5426\u5219\u627e $\\gcd(b,tmp)$ \u7684\u67d0\u4e2a\u8d28\u56e0\u6570\u3002\n\n\u7531\u4e8e $\\gcd$ \u540e\u7684\u7ed3\u679c\u4e00\u5b9a\u662f\u5c0f\u4e8e\u7b49\u4e8e $a$ \u6216 $b$ \u7684\uff0c\u6240\u4ee5\u8fd9\u6837\u7a33\u8fc7\u3002\n\n[\u4ee3\u7801](https://www.luogu.com.cn/paste/51dyh5ad)",
        "postTime": 1624849942,
        "uid": 203008,
        "name": "toaru",
        "ccfLevel": 5,
        "title": "CF1025B"
    },
    {
        "content": "## Content\n\u5b9a\u4e49 $n$ \u4e2a\u6570\u5bf9 $(a_1,b_1),(a_2,b_2),(a_3,b_3),...,(a_n,b_n)$ \u7684 $\\text{WCD}$ \u4e3a\u80fd\u591f\u6574\u9664\u6bcf\u4e2a\u6570\u5bf9\u4e2d\u81f3\u5c11\u4e00\u4e2a\u6570\u7684 $>1$ \u7684\u6574\u6570\u3002\u73b0\u5728\uff0c\u7ed9\u51fa $n$ \u4e2a\u6570\u5bf9\uff0c\u8bf7\u627e\u51fa\u5b83\u4eec\u7684 $\\text{WCD}$\uff0c\u6216\u8005\u8fd9 $n$ \u4e2a\u6570\u5bf9\u6ca1\u6709\u7b26\u5408\u8981\u6c42\u7684 $\\text{WCD}$\u3002\n\n**\u6570\u636e\u8303\u56f4\uff1a$1\\leqslant n\\leqslant 1.5\\times 10^5,2\\leqslant a_i,b_i\\leqslant 2\\times 10^9$\u3002**\n## Solution\n\u6211\u4eec\u5148\u628a\u7b2c\u4e00\u4e2a\u6570\u5bf9\u7684\u8d28\u56e0\u5b50\u5206\u89e3\u51fa\u6765\uff0c\u7136\u540e\u518d\u5728\u540e\u9762\u627e\u662f\u5426\u6709\u4e0d\u80fd\u591f\u6ee1\u8db3\u6761\u4ef6\u7684\u8d28\u56e0\u5b50\uff0c\u6709\u7684\u8bdd\u5c31\u5220\u9664\uff0c\u5426\u5219\u5c31\u4fdd\u7559\u7740\u3002\u6700\u540e\u770b\u662f\u5426\u8fd8\u6709\u5269\u4e0b\u7684\u8d28\u56e0\u5b50\u5373\u53ef\u3002\n## Code\n```cpp\nint n, pr[150007];\n\nint main() {\n\tn = Rint;\n\tF(i, 1, n) {\n\t\tint x = Rint, y = Rint;\n\t\tif(i == 1) {\n\t\t\tF(j, 2, sqrt(x)) if(!(x % j)) {pr[++pr[0]] = j; while(!(x % j)) x /= j;}\n\t\t\tif(x != 1) pr[++pr[0]] = x;\n\t\t\tF(j, 2, sqrt(y)) if(!(y % j)) {pr[++pr[0]] = j; while(!(y % j)) y /= j;}\n\t\t\tif(y != 1) pr[++pr[0]] = y;\n\t\t} else F(j, 1, pr[0]) if(!pr[j]) continue; else if(x % pr[j] && y % pr[j]) pr[j] = 0;\n\t}\n\tF(i, 1, pr[0]) if(pr[i]) return printf(\"%d\", pr[i]), 0;\n\tprintf(\"-1\");\n\treturn 0;\n}\n```",
        "postTime": 1605367567,
        "uid": 112917,
        "name": "Eason_AC",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF1025B \u3010Weakened Common Divisor\u3011"
    },
    {
        "content": "\u6211\u7684\u4ee3\u7801\u8dd1\u5f97\u5c31\u662f\u5f88\u5feb\u3002\n\n\u663e\u7136\u5982\u679c$a$\u4e3a$WCD$\uff0c\u5219$a$\u7684\u6240\u6709\u8d28\u56e0\u6570\u4e00\u5b9a\u4e5f\u4e3a$WCD$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u7ba1\u8d28\u6570\u5c31\u597d\u4e86\u3002\n\n\u5148\u628a\u7b2c$1$\u7ec4$a,b$\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u7136\u540e\u5224\u65ad\u6bcf\u4e2a\u8d28\u56e0\u6570\u5b83\u662f\u5426\n\u6574\u9664\u7b2c$2$~$n$\u7ec4$a,b$\u4e2d\u7684\u4e00\u4e2a\uff0c\u6700\u540e\u968f\u4fbf\u627e\u4e00\u4e2a\u6ee1\u8db3\u6761\u4ef6\u7684\u8d28\u56e0\u6570\u8f93\u51fa\u5c31\u597d\u4e86\u3002\n\n\u56e0\u4e3a\u6b63\u6574\u6570\u7684\u8d28\u56e0\u6570\u4e2a\u6570\u4e3a$loga$\u7ea7\u522b\u7684\uff0c\u6240\u4ee5\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a\n$O(\\sqrt{a}+nloga)$\u3002\n```\n#include<cstdio>\ninline int read(){\n\tint a=0;char c=getchar();\n\tfor(;c<48||c>57;c=getchar());for(;c>47&&c<58;a=a*10+c-48,c=getchar());\n\treturn a;\n}\nint n,a,b,p[20],fl[20],t[20],k;\nint main(){\n\tint f;\n\tn=read();\n\ta=read();b=read();\n\tfor(int i=2;i*i<=a;i++){\n\t  f=0;\n\t  for(;a%i==0;)a/=i,f=1;\n\t  if(f)p[++k]=i;\n\t}if(a>1)p[++k]=a;\n\tfor(int i=2;i*i<=b;i++){\n\t  f=0;\n\t  for(;b%i==0;)b/=i,f=1;\n\t  if(f)p[++k]=i;\n\t}if(b>1)p[++k]=b;\n\tfor(;--n;){\n\t  a=read();b=read();\n\t  for(int j=1;j<=k;j++)\n\t\tif(a%p[j]&&b%p[j])fl[j]=1;\n\t}\n\tfor(int i=1;i<=k;i++)if(!fl[i])\n\t  return 0*printf(\"%d\",p[i]);\n\treturn 0*puts(\"-1\");\n}\n```",
        "postTime": 1535862264,
        "uid": 72487,
        "name": "Dreamunk",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1025B \u3010Weakened Common Divisor\u3011"
    },
    {
        "content": "\u5c45\u7136\u6ca1\u6709\u9898\u89e3\u4e5f\u662f\u60ca\u4e86\uff0c\u8d76\u7d27\u6765\u6c34\u4e00\u53d1\uff08\u9003\uff09\u3002  \n\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\uff0c\u5982\u679c\u4e00\u4e2a\u6570\u662f\u6574\u4e2a\u6570\u5217\u7684$WCD$\uff0c\u90a3\u4e48\u5b83\u4e00\u5b9a\u53ef\u4ee5\u6574\u9664\u6bcf\u4e00\u7ec4\u4e2d\u81f3\u5c11\u4e00\u4e2a\u6570\u3002\u90a3\u5982\u679c\u7528\u8fd9\u4e2a\u6570\u7684\u4efb\u610f\u4e00\u4e2a\u8d28\u56e0\u6570\u4ee3\u66ff\u5b83\uff0c\u6548\u679c\u5176\u5b9e\u662f\u4e00\u6837\u7684\u3002  \n\u5373\u610f\uff0c\u5982\u679c\u4e00\u4e2a\u6570\u662f\u6574\u4e2a\u6570\u5217\u7684$WCD$\uff0c\u90a3\u4e48\u5b83\u6240\u542b\u7684\u4efb\u610f\u4e00\u4e2a\u8d28\u56e0\u6570\u90fd\u662f\u8fd9\u4e2a\u6570\u5217\u7684$WCD$\u3002\u800c\u7531\u4e8e\u9898\u76ee\u53ea\u9700\u8f93\u51fa\u4efb\u610f\u4e00\u4e2a\u7b54\u6848\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u628a\u7b54\u6848\u7684\u8303\u56f4\u7f29\u5c0f\u5230\u8d28\u6570\u3002  \n\u540c\u6837\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u5728$\\sqrt{2\\times10^9}$\u8303\u56f4\u5185\uff0c\u8d28\u6570\u53ea\u6709\u4e0d\u52305200\u4e2a\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7b5b\u51fa\u8fd9\u4e2a\u8303\u56f4\u5185\u7684\u8d28\u6570\uff0c\u4ece\u800c\u5206\u89e3\u56e0\u6570\u3002\u5982\u679c\u5728\u8fd9\u4e2a\u8303\u56f4\u5185\u4e0d\u80fd\u5206\u89e3\u5b8c\u5168\uff0c\u90a3\u4e48\u5c31\u4e00\u5b9a\u53ea\u4f1a\u5269\u4f59\u4e00\u4e2a\u5927\u8d28\u6570\u3002  \n\u901a\u8fc7\u4e4b\u524d\u7684\u5206\u6790\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u8fd9\u6837\u4e00\u4e2a\u7b97\u6cd5\uff1a\u5bf9\u6570\u5217\u4e2d\u7684\u7b2c1\u7ec4\u6570\uff0c\u5206\u522b\u5bf9\u5176\u4e2d\u7684\u4e24\u4e2a\u6570\u5206\u89e3\u56e0\u6570\u3002\u7136\u540e\uff0c\u5bf9\u4e8e\u5206\u89e3\u9664\u7684\u8d28\u56e0\u6570\uff0c\u6211\u4eec\u68c0\u67e5\u540e\u9762\u7684\u6570\u662f\u5426\u80fd\u88ab\u5b83\u4eec\u6574\u9664\u3002\u53ef\u4ee5\u8bc1\u660e\u8fd9\u6837\u662f\u6709\u6b63\u786e\u6027\u4fdd\u8bc1\u7684\u3002  \n\u7531\u8d28\u6570\u5b9a\u7406\u53ef\u4ee5\u77e5\u9053\uff0c\u7b97\u6cd5\u7684\u590d\u6742\u5ea6\u7ea6\u4e3a$O(\\frac{\\sqrt{max{a_i}}}{\\ln\\sqrt{max{a_i}}}\\times n)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002  \n\u4ee3\u7801\u5982\u4e0b\uff1a  \n```cpp\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#define reg register\n#define max(a,b) ((a)>(b)?(a):(b))\n#define min(a,b) ((a)<(b)?(a):(b))\ntypedef long long ll;\nconst int MN=150005;\nint n,pri[50005],cnt;\nbool notp[50005];\nint a[MN],b[MN],t[MN];\ninline int calc(int x){//\u8ba1\u7b97\u8fc7\u7a0b\n\treg int tot=0,tmp=x;\n\tfor(reg int i=1,f;i<=cnt;i++){//\u5206\u89e3\u56e0\u6570\n\t\tf=0;\n\t\twhile(tmp%pri[i]==0)tmp/=pri[i],f=1;\n\t\tif(f)t[++tot]=pri[i];\n\t}\n\tif(tmp>1)t[++tot]=tmp;//\u5b58\u5728\u5927\u8d28\u6570\n\tfor(reg int i=1,f;i<=tot;i++){..\u5bf9\u540e\u9762\u7684\u6570\u636echeck\n\t\tf=0;\n\t\tfor(reg int j=2;j<=n&&!f;j++)\n\t\t\tif(a[j]%t[i]!=0&&b[j]%t[i]!=0)f=1;\n\t\tif(!f)return t[i];\n\t}\n\treturn -1;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(reg int i=2;i<=50000;i++)//\u7b5b\u7d20\u6570\n\t\tif(!notp[i]){\n\t\t\tpri[++cnt]=i;\n\t\t\tfor(reg ll j=1ll*i*i;j<=50000;j+=i)notp[j]=1;\n\t\t}\n\tfor(reg int i=1;i<=n;i++)scanf(\"%d%d\",&a[i],&b[i]);\n\treg int ans1=calc(a[1]),ans2=calc(b[1]);printf(\"%d\\n\",max(ans1,ans2));\n    return 0;\n}\n```",
        "postTime": 1535003435,
        "uid": 17930,
        "name": "Marser",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1025B \u3010Weakened Common Divisor\u3011"
    }
]
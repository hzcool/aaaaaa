[
    {
        "content": "\u9898\u610f\uff1a\n\n\u6709\u56db\u9897\u76f8\u540c\u7684\u77f3\u5934\uff0c\u6bcf\u6b21\u53ef\u4ee5\u9009\u5b9a\u4e24\u9897\u77f3\u5934\u628a\u4e00\u9897\u6839\u636e\u53e6\u4e00\u9897**\u5bf9\u79f0**\uff0c\u73b0\u5728\u8981\u628a\u5b83\u4eec\u79fb\u5230\u6307\u5b9a\u7684\u4f4d\u7f6e\u4e0a\u3002\n\n\n\n\u9996\u5148\u5224\u65ad\u662f\u5426\u65e0\u89e3\uff1a\n\n\u5982\u679c\u521d\u59cb\u56db\u9897\u77f3\u5934\u90fd\u5728\u4e00\u4e2a\u4f4d\u7f6e\u4e0a\u9700\u8981\u76f4\u63a5\u7279\u5224\u6389\u3002\n\n\u4ee4 $g=\\gcd(a_2-a_1,a_3-a_1,a_4-a_1),g2=\\gcd(b_2-b_1,b_3-b_1,b_4-b_1)$ \uff0c\u90a3\u4e48\u9700\u8981\u6709 $g=g_2$ \u5e76\u4e14 $a_1=b_1 \\pmod g$ \uff0c\u5426\u5219\u663e\u7136\u65e0\u89e3\u3002\n\n\u4ee4 $d=a_1\\bmod g$\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u5c06\u6240\u6709\u5750\u6807\u53d8 $x$ \u4e3a $x=(x-d)/g$\u3002\u6b64\u65f6\u53ef\u4ee5\u53d1\u73b0\uff0c\u5728\u4efb\u4f55\u64cd\u4f5c\u4e0b\uff0c\u6bcf\u4e2a\u5750\u6807\u7684\u5947\u5076\u6027\u90fd\u662f\u4e0d\u53d8\u7684\uff0c\u56e0\u6b64 $a$ \u4e0e $b$ \u4e4b\u95f4\u7684\u5947\u6570\u548c\u5076\u6570\u6570\u91cf\u5e94\u8be5\u76f8\u540c\u3002\u5426\u5219\u4ecd\u7136\u65e0\u89e3\u3002\n\n\u7136\u540e\u8003\u8651\u56fa\u5b9a\u4e24\u4e2a\u4e2d\u95f4\u72b6\u6001\uff1a\u5c06 $a_1,\\ldots a_4$ \u653e\u5230 $[x,x+1]$ \u4e0a\uff0c\u5c06 $b_1,\\ldots b_4$ \u653e\u5230 $[y,y+1]$ \u4e0a\uff0c\u6700\u540e\u5c06 $[x,x+1]$ \u4e0a\u7684\u77f3\u5934\u653e\u5230 $[y,y+1]$ \u4e0a\u5373\u53ef\uff0c\u8f93\u51fa\u65f6\u53ea\u8981\u628a $b_1,\\ldots b_4$ \u653e\u5230 $[y,y+1]$ \u8fd9\u4e00\u90e8\u5206\u5012\u7740\u8f93\u51fa\u5373\u53ef\u3002\uff08\u4e3a\u4e86\u65b9\u4fbf\u8fd9\u91cc\u7684 $x,y$ \u7edf\u4e00\u4e3a\u5076\u6570\uff09\n\n\u63a5\u4e0b\u6765\u5148\u8003\u8651\u600e\u4e48\u628a\u77f3\u5934\u653e\u5230 $[x,x+1]$ \u4e0a\u3002\n\n\u4ee4 $\\Delta=$ \u4efb\u610f\u4e24\u5757\u77f3\u5934\u4e4b\u95f4\u7684\u6700\u5927\u8ddd\u79bb\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u5047\u8bbe $a$ \u9012\u589e\u3002\n\n\n\n\u5f53\u5176\u4e2d\u4e00\u9897\u77f3\u5934 $a_i$ \u5728 $[a_1+\\frac{\\Delta}{4},a_1+\\frac{3\\Delta}{4}]$ \u65f6\uff0c\n\n\u8003\u8651\u5c06 $[a_1,a_4]$ \u5206\u6210 $[a_1,a_i]$ \u548c $[a_i,a_4]$\uff0c\u5e76\u5c06\u6240\u6709\u7684\u77f3\u5934\u5bf9\u79f0\u5230\u76f8\u5bf9\u4e8e $a_i$ \u8f83\u8fd1\u7684\u4e00\u534a\u3002\n\n\u6b64\u65f6 $a_i$ \u5c06\u6210\u4e3a\u6700\u5de6\u8fb9\u6216\u8005\u6700\u53f3\u8fb9\u7684\u77f3\u5934\uff0c\u65b0\u7684\u6700\u5927\u8ddd\u79bb $\\Delta'$ \u6700\u5927\u4e3a $\\frac{3\\Delta}{4}$\uff0c$\\Delta$ \u51cf\u5c11\u81f3\u5c11 $\\frac{1}{4}$\u3002\n\n\n\n\u5426\u5219\u5047\u5982\u4e0d\u5b58\u5728\u8fd9\u9897\u77f3\u5934\u65f6\uff0c\u4ee4 $d_i=\\min(a_i-a_1,a_4-a_i)$ \uff0c\u5373\u4ece $a_i$ \u5230\u6700\u8fd1\u4e24\u7aef\u77f3\u5934\u7684\u6700\u77ed\u8ddd\u79bb\uff0c\u90a3\u4e48\u53ef\u4ee5\u53d1\u73b0 $d_2,d_3<\\frac{\\Delta}{4}$ \u4e14\u81f3\u5c11\u6709\u4e00\u4e2a\u6570 $\\neq 0$ \u3002\u5426\u5219\u6b64\u65f6\u5df2\u7ecf\u6709 $g=1=\\Delta$\uff0c\u5df2\u7ecf\u5b8c\u6210\u76ee\u6807\u3002\n\n\u7136\u540e\u89c2\u5bdf\u8fdb\u884c $(a_i,a_j),(a_i,a_k)$ \u4e24\u6b21\u64cd\u4f5c\u5c06 $a_i$ \u53d8\u4e3a $a_i+2(a_k-a_j)$\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u5c06 $d_i$ \u53d8\u6210 $d_i+2d_j$\u3002\u5728\u8fd9\u6837 $\\mathcal O(\\log \\Delta)$ \u6b21\u64cd\u4f5c\u540e\uff0c\u4f1a\u6709 $\\max(d_2,d_3)\\ge \\frac{\\Delta}{4}$\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u7ee7\u7eed\u91cd\u590d\u4e0a\u9762\u7684\u64cd\u4f5c\u4e86\u3002\n\n\n\n\u6700\u540e\uff0c\u6240\u6709\u7684 $a_i\\in [x,x+1]$\u3002\u4e3a\u4e86\u65b9\u4fbf\uff0c\u5982\u679c $x$ \u662f\u5947\u6570\uff0c\u53ef\u4ee5\u8ba9\u6240\u6709\u7684 $a_i=x$ \u53d8\u6210 $x+2$\u3002\n\n\u603b\u590d\u6742\u5ea6\u4e3a $\\mathcal O(\\log \\Delta)$ \u7684\u3002\n\n\n\n\u7136\u540e\u8003\u8651\u600e\u4e48\u5c06 $[x,x+1]$ \u4e0a\u7684\u77f3\u5b50\u79fb\u5230 $[y,y+1]$ \u4e0a\uff0c\u5047\u8bbe\u6b64\u65f6\u8981\u5c06\u5b83\u4eec\u79fb\u52a8 $2d$\uff0c\u5047\u8bbe $2d\\ge 0$\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u4efb\u4f55\u77f3\u5934\u7684\u6392\u5217\u7684\u6392\u5217\u90fd\u53ef\u4ee5\u901a\u8fc7\u5c06\u6700\u53f3\u8fb9\u90a3\u9897\u77f3\u5934\u5bf9\u79f0\u4e24\u6b21\u6765\u79fb\u52a8 $2\\Delta$\u3002\n\n\u5047\u8bbe $a$ \u9012\u589e\u3002\n\n\u4ee4\u4e00\u4e2a\u53eb Expand \u64cd\u4f5c\u4e3a $(a_3,a_1),(a_2,a_4)$\u3002\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u4f7f\u7528 Expand $k$ \u6b21\uff0c\u6700\u5927\u8ddd\u79bb $\\Delta$ \u5c06\u5448\u6307\u6570\u589e\u957f\u3002\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5c06\u77f3\u5934\u79fb\u52a8 $2d$ \u5982\u4e0b\uff1a\n\n1. \u8fdb\u884c Expand \u64cd\u4f5c\u76f4\u5230 $\\Delta >d$\u3002\n2. \u5f53 $\\Delta \\le d$ \u65f6\uff0c\u8fdb\u884c\u4e0a\u9762\u90a3\u79cd\u64cd\u4f5c\u5c06\u6240\u6709\u77f3\u5934\u79fb\u52a8 $2\\Delta$\uff0c\u5e76\u5c06 $d$ \u51cf\u5c11 $\\Delta$\u3002\n3.  \u82e5 $\\Delta =1$\uff0c\u5219\u9000\u51fa\u3002\n4. \u6267\u884c Expand \u7684\u9006\u64cd\u4f5c\uff0c\u8fd4\u56de\u6b65\u9aa4 2\n\n\u6700\u540e\u53ef\u4ee5\u5f97\u5230 $\\Delta =1,d=0$ \u3002\u6b64\u5916\u7531\u4e8e $\\Delta$ \u5728 Expand \u64cd\u4f5c\u4e2d\u5448\u6307\u6570\u589e\u957f\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $\\Delta$ \u57fa\u672c\u64cd\u4f5c\u90fd\u662f $\\mathcal O(1)$ \u7684\uff0c\u56e0\u6b64\u603b\u64cd\u4f5c\u6b21\u6570\u662f $\\mathcal O(\\log d)$ \u7684\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define R(i,a,b) for(int i=(a),i##E=(b);i<=i##E;i++)\n#define L(i,a,b) for(int i=(b),i##E=(a);i>=i##E;i--)\nusing namespace std;\nint a[11],b[11],g,g2;\nvector<pair<int,int> >ans1,ans2,ans;\n\ninline void nos(int a=-1)\n{\n\tcout<<a<<endl;\n\texit(0);\n}\ninline int gcd(int a,int b)\n{\n\treturn !b?a:gcd(b,a%b);\n}\nvoid solve(int *a,vector<pair<int,int> >&ans)\n{\n\twhile(1)\n\t{\n\t\tsort(a+1,a+5);\n\t\tif(a[4]-a[1]==1) break;\n\t\tint p=1e10;\n\t\twhile(1)\n\t\t{\n\t\t\tint l=a[1]*3+a[4],r=a[1]+a[4]*3;\n\t\t\tif(l<=a[2]*4&&a[2]*4<=r) p=a[2];\n\t\t\tif(l<=a[3]*4&&a[3]*4<=r) p=a[3];\n\t\t\tif(p!=1e10) break;\n\t\t\tint d2=min(a[2]-a[1],a[4]-a[2]),d3=min(a[3]-a[1],a[4]-a[3]);\n\t\t\tif(d2>d3) swap(d2,d3),swap(a[2],a[3]);\n\t\t\tint id1,id2;\n\t\t\tif(a[4]-a[3]<a[3]-a[1]) id1=3,id2=4;\n\t\t\telse id1=1,id2=3;\n\t\t\tif(a[4]-a[2]<a[2]-a[1]) swap(id1,id2);\n\t\t\tans.emplace_back(a[2],a[id1]);\n\t\t\ta[2]=(a[id1]<<1)-a[2];\n\t\t\tans.emplace_back(a[2],a[id2]);\n\t\t\ta[2]=(a[id2]<<1)-a[2];\n\t\t}\n\t\tif(a[1]+a[4]>=(p<<1))\n\t\t{\n\t\t\tR(i,1,4) if(a[i]<p) ans.emplace_back(a[i],p),a[i]=(p<<1)-a[i];\n\t\t}\n\t\telse\n\t\t{\n\t\t\tR(i,1,4) if(a[i]>p) ans.emplace_back(a[i],p),a[i]=(p<<1)-a[i];\n\t\t}\n\t}\n\tsort(a+1,a+5);\n\tif(a[1]&1)\n\t{\n\t\tR(i,1,4) if(a[i]&1) ans.emplace_back(a[i],a[i]+1),a[i]+=2;\n\t}\n\tsort(a+1,a+5);\n}\nsigned main()\n{\n\tios::sync_with_stdio(false);\n\tcin.tie(NULL);\n\t\n\t\n\tcin>>a[1]>>a[2]>>a[3]>>a[4]>>b[1]>>b[2]>>b[3]>>b[4];\n\tsort(a+1,a+4+1),sort(b+1,b+4+1);\n    \n\tR(i,2,4) g=gcd(g,a[i]-a[1]),g2=gcd(g2,b[i]-b[1]);\n\tif(g^g2) nos();\n\tif(!g) nos(a[1]==b[1]?0:-1);\n\tif((a[1]-b[1])%g) nos();\n   \n\tint d=(a[1]%g+g)%g;\n\tR(i,1,4) a[i]=(a[i]-d)/g,b[i]=(b[i]-d)/g; \n\tsolve(a,ans1),solve(b,ans2);\n\n\tR(i,1,4) if((a[i]&1)!=(b[i]&1)) nos();\n\td=(b[1]-a[1])/2;\n\tfor(;3*(a[4]-a[1])<=abs(d);)\n\t{\n\t\tans1.emplace_back(a[3],a[1]),a[3]=(a[1]<<1)-a[3];\n\t\tans1.emplace_back(a[2],a[4]);a[2]=(a[4]<<1)-a[2];\n\t\tsort(a+1,a+5);\n\t}\n\twhile(1)\n\t{\n\t\twhile(abs(d)>=a[4]-a[1])\n\t\t{\n\t\t\tif(d<0)\n\t\t\t{\n\t\t\t\td+=a[4]-a[1];\n\t\t\t\tR(i,1,2) \n\t\t\t\t{\n\t\t\t\t\tR(j,2,4)\n\t\t\t\t\t{\n\t\t\t\t\t\tans1.emplace_back(a[j],a[1]);\n\t\t\t\t\t\ta[j]=(a[1]<<1)-a[j];\n\t\t\t\t\t} \n\t\t\t\t\tsort(a+1,a+5);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\td-=a[4]-a[1];\n\t\t\t\tR(i,1,2) \n\t\t\t\t{\n\t\t\t\t\tR(j,1,3)\n\t\t\t\t\t{\n\t\t\t\t\t\tans1.emplace_back(a[j],a[4]);\n\t\t\t\t\t\ta[j]=(a[4]<<1)-a[j];\n\t\t\t\t\t}\t\t\t\n\t\t\t\t\tsort(a+1,a+5);\n\t\t\t\t}\n\n\t\t\t}\t\t\t\t\n\n\t\t}\n\t\tif(a[4]-a[1]<=1) break;\n\n\t\tans1.emplace_back(a[1],a[2]);a[1]=(a[2]<<1)-a[1];\n\t\tans1.emplace_back(a[4],a[3]);a[4]=(a[3]<<1)-a[4];\n\t\tsort(a+1,a+5);\n\t}\n\treverse(ans2.begin(),ans2.end());\n\tfor(auto x:ans2) ans1.emplace_back((x.second<<1)-x.first,x.second);\n\tfor(auto x:ans1) if(x.first!=x.second) ans.emplace_back(x.first*g+d,x.second*g+d);\n\tcout<<ans.size()<<endl;\n\tfor(auto x:ans) cout<<x.first<<\" \"<<x.second<<'\\n';\n\t\n}\n```\n\n\n\n",
        "postTime": 1638441381,
        "uid": 115779,
        "name": "\u6781\u5bd2\u795e\u51b0",
        "ccfLevel": 0,
        "title": "1276E"
    }
]
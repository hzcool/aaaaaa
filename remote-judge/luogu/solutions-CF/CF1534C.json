[
    {
        "content": "\u6ce8\u610f\u5230\uff0c\u6211\u4eec\u6bcf\u6b21\u53ef\u4ee5\u9009\u62e9\u4ea4\u6362\u7684\u4e00\u5b9a\u662f\u4e00\u4e2a\u5faa\u73af\u7f6e\u6362\u3002\n\n\u8003\u8651\u5230\u6bcf\u4e2a\u5faa\u73af\u7f6e\u6362\u6709\u4ea4\u6362\u548c\u4e0d\u4ea4\u6362\u4e24\u79cd\u60c5\u51b5\uff0c\u90a3\u4e48\u7b54\u6848\u5373\u4e3a $2^{cnt}$\uff0c\u5176\u4e2d $cnt$ \u6307\u5faa\u73af\u7f6e\u6362\u6570\u3002\n\n\u5982\u4f55\u6c42\u89e3\u5faa\u73af\u7f6e\u6362\u6570\uff1f\n\n\u8003\u8651\u5e76\u67e5\u96c6\uff0c\u628a\u6bcf\u4e00\u4e2a $a_i$ \u5411 $b_i$ \u8fde\u8fb9\uff0c\u6700\u7ec8\u7684\u8fde\u901a\u5757\u4e2a\u6570\u5c31\u662f\u5faa\u73af\u7f6e\u6362\u6570\u3002\n\n\u4f7f\u7528\u6309\u7a1a\u5408\u5e76\u548c\u8def\u5f84\u538b\u7f29\u53ef\u4ee5\u8fbe\u5230 $O(n\\alpha(n))$\uff0c\u4ee3\u7801\u4e2d\u4ec5\u4f7f\u7528\u4e86\u8def\u5f84\u538b\u7f29\uff0c\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nnamespace Acc{\n#define int long long\n    const int N = 4e5+10;\n    int n,T[N],a[N],r;\n    int find(int x){\n        return T[x]=T[x]==x?x:find(T[x]);\n    }\n    void unit(int x,int y){\n        if((x=find(x))!=(y=find(y)))T[y]=x;\n    }\n    const int mod = 1e9+7;\n    int qpow(int a,int b){\n        int r=1;\n        for(;b;b>>=1,a=a*a%mod)if(b&1)r=r*a%mod;\n        return r%mod;\n    }\n    void work(){\n        cin>>n,r=0;\n        for(int i=1;i<=n;i++)cin>>a[i],T[i]=i;\n        for(int i=1,x;i<=n;i++)cin>>x,unit(a[i],x);\n        for(int i=1;i<=n;i++)r+=T[i]==i;\n        cout<<qpow(2,r)<<'\\n';\n    }\n#undef int\n}\nint main(){\n    int T;\n    for(cin>>T;T--;)Acc::work();\n    return 0;\n}\n\n```",
        "postTime": 1623713936,
        "uid": 383079,
        "name": "Acc_Robin",
        "ccfLevel": 6,
        "title": "CF1534C Little Alawn's Puzzle \u9898\u89e3"
    },
    {
        "content": "### \u9898\u610f\n\n\u7ed9\u5b9a\u4e24\u884c\uff0c\u6bcf\u884c\u662f $n$ \u4e2a\u6570\u7684\u6392\u5217\uff0c\u53ef\u4ee5\u5c06\u540c\u4e00\u5217\u7684\u7b2c\u4e00\u884c\u7684\u6570\u4e0e\u7b2c\u4e8c\u884c\u7684\u6570\u4ea4\u6362\u3002\u8bf7\u95ee\u6709\u591a\u5c11\u4ea4\u6362\u65b9\u6cd5\u4f7f\u5f97\u6bcf\u4e00\u884c\u3001\u6bcf\u4e00\u5217\u6ca1\u6709\u91cd\u590d\u7684\u6570\u3002\u7531\u4e8e\u7b54\u6848\u53ef\u80fd\u5f88\u591a\uff0c\u8f93\u51fa\u7b54\u6848\u6a21 $10^9 + 7$ \u7684\u503c\u3002\n\n### \u778e\u626f\n\u53d1\u73b0 SSerxhs \u5946\u4f6c\u7ba1\u7406\u7684\u601d\u8def\u548c\u6211\u4e00\u6837\u8bf6\uff0c~~\u6211\u53ea\u5f97\u628a\u90a3\u4efd\u9898\u89e3\u7f16\u5f97\u8be6\u7ec6\u4e00\u70b9\u4e86\u3002~~\n\n### \u601d\u8def\n\n\u628a\u6bcf\u4e00\u5217\u7b2c\u4e00\u884c\u4e0e\u7b2c\u4e8c\u884c\u7684\u6570\u8fde\u4e00\u6761**\u6709\u5411\u8fb9**\uff0c\u6837\u4f8b\u4e00\u6bd4\u8f83\u7b80\u5355\uff0c\u4e0b\u56fe\u662f\u6837\u4f8b\u4e8c\u8fde\u8d77\u6765\u7684\u6837\u5b50\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/l5q30nim.png?x-oss-process=image/resize,m_lfit,h_170,w_225)\n\n\u8bbe\u6709 $x$ \u4e2a\u73af\uff0c\u5219\u7b54\u6848\u662f $2^x$ \u79cd\u65b9\u6848\u3002  \n\u6545\u56e0\u4e3a\u4e0a\u56fe\u6709 $3$ \u4e2a\u73af\uff0c\u7b54\u6848\u662f $2^3 = 8$ \u79cd\u3002\n\n\u539f\u56e0\u5f88\u597d\u7406\u89e3\uff1a  \n\n1. \u6bcf\u4e2a\u73af\u6709\u9009\u4e0e\u4e0d\u9009\u4e24\u79cd\u65b9\u6848\uff0c\u800c\u4e0d\u662f\u70b9\u6570\u4e2a\u65b9\u6848\uff0c\u56e0\u4e3a\u5982\u679c\u8981\u9009\u62e9\u8fd9\u4e2a\u73af\uff0c\u5fc5\u987b\u628a\u73af\u4e0a\u6240\u6709\u70b9\u4ea4\u6362\u9632\u6b62\u67d0\u4e00\u884c\u7684\u6570\u5b57\u91cd\u590d\u3002\n\n2. \u60f3\u5230\u73af\u662f\u56e0\u4e3a\u5982\u6709\u6709 $a \\to b$\uff0c\u5219\u5fc5\u987b\u6709 $b \\to a$\uff0c\u56e0\u6b64\uff0c\u76ee\u6807\u662f\u627e\u6709\u591a\u5c11\u60c5\u51b5\u4f7f\u5f97**\u9009\u62e9\u67d0\u4e9b\u6570\u6362\u4e0b\u6765\uff0c\u800c\u6362\u4e0a\u53bb\u7684\u90a3\u4e9b\u6570\u6b63\u597d\u5c31\u662f\u6700\u5f00\u59cb\u9009\u62e9\u7684\u90a3\u4e9b\u6570\u3002** \u6b63\u597d\u6ee1\u8db3\u73af\u7684\u6761\u4ef6\u3002  \n\n[AC code\u8bb0\u5f55](https://www.luogu.com.cn/record/51778110)\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\n#define fr(i, l, r) for (int i = l; i <= r; ++i)\nusing namespace std;\nint t, n; int a[400010], a2[400010], vis[400010], cnt;\nconst int mod = 1e9 + 7;\nvector <int>link[400010]; // \u5b58\u56fe\u7528\u90bb\u63a5\u77e9\u9635\u4f1a\u7206\u7a7a\u95f4\uff0c\u7136\u800c\u5176\u5b9e\u6bcf\u4e2a\u6570\u7684\u51fa\u5ea6\u90fd\u662f 1\n\nvoid dfs(int now)\n{\n\tif (!vis[link[now][0]]) vis[link[now][0]] = true, dfs(link[now][0]);\n\telse\n\t{\n\t\tcnt++; return;\n\t}\n}\n\nint main()\n{\n\tscanf(\"%d\", &t);\n\twhile (t--)\n\t{\n\t\tscanf(\"%d\", &n); cnt = 0;\n\t\tfr(i, 1, n) scanf(\"%d\", a + i), vis[i] = false;\n\t\tfr(i, 1, n) scanf(\"%d\", a2 + i), link[a[i]].push_back(a2[i]);\n\t\tfr(i, 1, n) if (!vis[i]) vis[i] = true, dfs(i);\n\t\tint ans = 1;\n\t\tfr(i, 1, cnt) ans = ans * 2 % mod; // \u8fb9\u4e58\u8fb9\u6a21\uff0c\u4e0d\u4f1a\u7206 int\n\t\tprintf(\"%d\\n\", ans);\n\t\tfr(i, 1, n) link[i].clear(); // CF \u7b2c\u4e00\u6b21\u4ea4\u6ca1\u6e05\u7a7a\uff0c\u4e8f\u6b7b\u4e86\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1623745085,
        "uid": 409236,
        "name": "StayAlone",
        "ccfLevel": 6,
        "title": "CF1534C Little Alawn's Puzzle C++\u3010\u601d\u7ef4\u9898\u3011\u9898\u89e3"
    },
    {
        "content": "\u8bb0 $pa(i)$ \u8868\u793a $i$ \u5728 $a_i$ \u51fa\u73b0\u7684\u4e0b\u6807\uff0c$pb(i)$ \u540c\u7406\u3002\n\n\u5982\u679c\u5f3a\u5236\u4ea4\u6362\u7b2c $i$ \u5217\uff0c\u90a3\u4e48\u5fc5\u5b9a\u8981\u4ea4\u6362\u7b2c $pa(b_i)$ \u5217\uff0c\u5426\u5219\u4f1a\u5bfc\u81f4\u7b2c\u4e00\u884c\u51fa\u73b0\u4e24\u4e2a $b_i$\u3002\u6b64\u65f6\u628a $pa(b_i)$ \u4f5c\u4e3a\u65b0\u7684\u5f3a\u5236\u4ea4\u6362\u5217\u7ee7\u7eed\u8003\u8651\u8fd9\u4e2a\u95ee\u9898\uff0c\u53ef\u4ee5\u53d1\u73b0\u76f4\u5230\u67d0\u4e00\u6b21\u5f3a\u5236\u4ea4\u6362\u5217\u662f\u524d\u9762\u5df2\u7ecf\u8003\u8651\u8fc7\u7684\u4e00\u5217\u65f6\u624d\u4f1a\u505c\u6b62\u3002\n\n\u5982\u679c\u770b\u6210\u4e00\u5f20\u56fe\uff0c\u4ece $a_i$ \u5411 $b_i$ \u8fde\u8fb9\uff0c\u90a3\u4e48\u76f8\u5f53\u4e8e\u6bcf\u4e2a\u70b9\u5404\u6709\u4e00\u6761\u51fa\u8fb9\u5165\u8fb9\uff0c\u4e14\u67d0\u4e2a\u70b9\u6539\u53d8\u4f1a\u5bfc\u81f4\u5176\u6240\u5728\u73af\u7684\u6240\u6709\u70b9\u6539\u53d8\u3002\u56e0\u6b64\u81ea\u7531\u5143\u4e2a\u6570 $x$ \u548c\u73af\u4e2a\u6570\u76f8\u7b49\uff0c\u7b54\u6848\u5373\u4e3a $2^x$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef unsigned int ui;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef double db;\ntypedef long double ldb;\n#define range(x) (x).begin(),(x.end())\nstd::mt19937 rnd(chrono::steady_clock::now().time_since_epoch().count());\ninline int sj(int n)\n{\n\tunsigned int x=rnd();\n\treturn x%n+1;\n}\n#define rand fst\ntemplate<typename typC> void read(register typC &x)\n{\n\tregister int c=getchar(),fh=1;\n\twhile ((c<48)||(c>57))\n\t{\n\t\tif (c=='-') {c=getchar();fh=-1;break;}\n\t\tc=getchar();\n\t}\n\tx=c^48;c=getchar();\n\twhile ((c>=48)&&(c<=57))\n\t{\n\t\tx=x*10+(c^48);\n\t\tc=getchar();\n\t}\n\tx*=fh;\n}\ntemplate<typename typC, typename... Args> void read(typC &first, Args& ... args) {\n\tread(first);\n\tread(args...);\n}\ntemplate<typename typC> void read(register typC *a,int num)\n{\n\tfor (register int i=1;i<=num;i++) read(a[i]);\n}\ntemplate<typename typC> void write(register typC x)\n{\n\tif (x<0) putchar('-'),x=-x;\n\tstatic int st[100];\n\tregister int tp=1;\n\tregister typC y;st[1]=x%10;x/=10;\n\twhile (x) y=x/10,st[++tp]=x-y*10,x=y;++tp;\n\twhile (--tp) putchar(st[tp]|48);\n}\ntemplate<typename typC> void write(register typC *a,register int num)\n{\n\tfor (register int i=1;i<=num;i++) write(a[i]),putchar(i==num?10:32);\n}\ntemplate<typename typC> typC ab(register typC x)\n{\n\tif (x<0) return -x;\n\treturn x;\n}\n#define space(x) write(x),putchar(32)\n#define enter(x) write(x),putchar(10)\nconst int p=1e9+7;\nconst db eps=1e-9;\ninline void inc(register int &x,const int y)\n{\n\tif ((x+=y)>=p) x-=p;\n}\ninline void dec(register int &x,const int y)\n{\n\tif ((x-=y)<0) x+=p;\n}\ninline int ksm(register int x,register int y)\n{\n\tregister int r=1;\n\twhile (y)\n\t{\n\t\tif (y&1) r=(ll)r*x%p;\n\t\tx=(ll)x*x%p;\n\t\ty>>=1;\n\t}\n\treturn r;\n}\npriority_queue<int> ONLYYFORRCOPYY;\npriority_queue<int,vector<int>,greater<int> > ONLYYFORRCOPYY__;\nstruct Q\n{\n\tint u,v;\n\tQ(int a=0,int b=0):u(a),v(b){}\n\tbool operator<(const Q &o) const {return v<o.v;}\n};\nconst int N=1e6+2,M=1e6+2,inf=1e9;\nchar s[N];\nint a[N],b[N],pa[N],pb[N];\nbool ed[N];\nint T,n,m,c,i,j,k,x,y,z,ans,la,ksiz,ks;\nint main()\n{\n\t//ios::sync_with_stdio(false);\n\tcout<<setiosflags(ios::fixed)<<setprecision(15);\n\tT=1;\n\tread(T);\n\twhile (T--)\n\t{\n\t\tread(n);\n\t\tread(a,n);\n\t\tread(b,n);ans=1;\n\t\tfor (i=1;i<=n;i++) pa[a[i]]=i,pb[b[i]]=i,ed[i]=0;\n\t\tfor (i=1;i<=n;i++) if (!ed[i])\n\t\t{\n\t\t\tx=a[i],y=b[i];ed[i]=1;\n\t\t\twhile (y!=x)\n\t\t\t{\n\t\t\t\ty=pa[y];\n\t\t\t\ted[y]=1;\n\t\t\t\ty=b[y];\n\t\t\t}\n\t\t\tans=(ll)ans*2%p;\n\t\t}enter(ans);\n\t}\n}\n```",
        "postTime": 1623660041,
        "uid": 29826,
        "name": "SSerxhs",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1534C\u3010Little Alawn's Puzzle\u3011"
    },
    {
        "content": "[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF1534C)\n\n# $\\texttt{Description}$\n\n\u4e00\u4e2a $2\\times n$ \u7684\u77e9\u9635\uff0c\u53ef\u4ee5\u64cd\u4f5c\u4efb\u610f\u6b21\uff0c\u6bcf\u6b21\u64cd\u4f5c\u662f\u4ea4\u6362\u67d0\u4e00\u5217\u4e0a\u7684 $2$ \u4e2a\u6570\u5b57\uff0c\u7ecf\u8fc7\u64cd\u4f5c\u4e4b\u540e\uff0c\u6709\u591a\u5c11\u79cd\u540c\u4e00\u884c\u6ca1\u6709\u76f8\u540c\u6570\u5b57\u7684\u60c5\u51b5\u3002\u65b9\u6848\u6570\u5bf9 $10^9+7$ \u53d6\u6a21\u3002\n\n# $\\texttt{Solution}$\n\n\u8fd9\u662f\u4e00\u9053\u597d\u9898\uff08\u5f53\u7136\u662f\u5bf9\u4e8e\u6211\u8fd9\u79cd\u5c51\u6765\u8bf4\uff09\u3002\n\n- \u6211\u4eec\u77e5\u9053\uff0c\u6211\u4eec\u4ea4\u6362\u7684\u4e00\u5b9a\u662f\u67d0\u4e9b\u6574\u4e2a\u7684\u5faa\u73af\u7f6e\u6362\u3002\n\n- \u5faa\u73af\u7f6e\u6362\u7684\u610f\u601d\u5c31\u662f\u5728\u8fd9\u4e2a\u7f6e\u6362\u91cc\u9762\u7684\u6bcf\u4e2a\u6570\u90fd\u51fa\u73b0\u4e86 $2$ \u6b21\uff0c\u53ef\u4ee5\u7406\u89e3\u4e3a\u662f\u4e00\u4e2a\u5c01\u95ed\u7684\u5757\u3002\n\n- \u5047\u8bbe\u6709 $cnt$ \u4e2a\u5faa\u73af\u7f6e\u6362\uff0c\u90a3\u4e48\u7b54\u6848\u5176\u5b9e\u5c31\u662f $\\sum\\limits_{i=0}^{cnt}C_{cnt}^i$\uff0c\u8fd9\u4e2a\u5e94\u8be5\u662f\u5f88\u597d\u7406\u89e3\uff08\u4ee3\u7801\u5b9e\u73b0\u4e2d\u5199\u7684\u662f\u8fd9\u79cd\uff09\u3002\u4f46\u662f\u8fd8\u6709\u53e6\u5916\u4e00\u79cd\u7b80\u5355\u7684\u6c42\u6cd5\uff0c\u5c31\u662f $2^{cnt}$\uff0c\u4e3a\u4ec0\u4e48\u5462\uff1f\u56e0\u4e3a\u6bcf\u4e2a\u90fd\u6709\u9009\u6216\u4e0d\u9009\u4e24\u79cd\u60c5\u51b5\u3002\n\n- \u81f3\u4e8e\u5982\u4f55\u6c42\u51fa $cnt$\uff0c\u6709\u4e24\u79cd\u65b9\u6cd5\uff1a\n\n\t- \u76f4\u63a5 dfs\uff0c\u8fd9\u91cc\u6211\u9009\u62e9\u4e86 dfs\u3002\n    \n    - \u5e76\u67e5\u96c6\uff0c\u5c06\u7ed9\u51fa\u7684\u77e9\u9635\u6bcf\u5217\u7684\u4e24\u4e2a\u6570\u5408\u5e76\uff0c\u518d\u7edf\u8ba1\u8fde\u901a\u5757\u6570\u91cf\u5373\u53ef\u3002\n    \n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(n\\log n)$\n\n# $\\texttt{Code}$\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#include <map>\n\nusing namespace std;\n\ntypedef long long ll;\nconst ll mod = 1e9 + 7;\ninline int Min (int x, int y) {return x < y ? x : y;}\ninline int Max (int x, int y) {return x > y ? x : y;}\n\nint a[400005], b[400005];\nbool vis[400005];\nmap<int, int> mp;\n\ninline ll quickPow (ll a, ll k, ll p) {\n\tll res = 1;\n\ta %= p;\n\twhile (k) {\n\t\tif (k & 1)\n\t\t\tres = res * a % p;\n\t\tk >>= 1;\n\t\ta = a * a % p;\n\t}\n\treturn res;\n}\n\ninline ll inv (ll x, ll p) {\n\treturn quickPow(x, p - 2, p);\n}\n\ninline void dfs (int i) {\n\tif (vis[b[i]])\n\t\treturn;\n\tvis[b[i]] = true;\n\tdfs(mp[b[i]]);\n}\n\nint main () {\n\tint T;\n\tscanf(\"%d\", &T);\n\twhile (T--) {\n\t\tint n, cnt = 0;\n\t\tscanf(\"%d\", &n);\n\t\tfor (int i = 1; i <= n; i++)\n\t\t\tscanf(\"%d\", &a[i]), mp[a[i]] = i;\n\t\tfor (int i = 1; i <= n; i++)\n\t\t\tscanf(\"%d\", &b[i]);\n\t\tmemset(vis, false, sizeof(vis));\n\t\tfor (int i = 1; i <= n; i++)\n\t\t\tif (!vis[a[i]]) {\n\t\t\t\tvis[a[i]] = true;\n\t\t\t\tdfs(i);\n\t\t\t\tcnt++;\n\t\t\t}\n\t\tll ans = 1, tot = 1ll * cnt, fac = 1;\n\t\tfor (int i = 1; i <= cnt; i++) {\n\t\t\tfac = fac * i % mod;\n\t\t\tans = (ans + tot * inv(fac, mod) % mod) % mod;\n\t\t\ttot = tot * (cnt - i) % mod;\n\t\t}\n\t\tprintf(\"%lld\\n\", ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1624164052,
        "uid": 365542,
        "name": "SDqwq",
        "ccfLevel": 7,
        "title": "CF1534C Little Alawn's Puzzle"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://codeforces.com/problemset/problem/1534/C)\n## \u9898\u76ee\u5927\u610f\n\u7ed9\u51fa\u4e00\u4e2a $2\\times n$ \u7684\u77e9\u9635\uff0c\u8981\u6c42\u4ea4\u6362\u8fd9\u4e2a\u77e9\u9635\u4e4b\u4e2d\u540c\u4e00\u5217\u7684\u4e24\u4e2a\u6570\u5b57\uff08\u5f53\u7136\u53ef\u4ee5\u4ea4\u6362\u591a\u6b21\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u6362\uff09\uff0c\u4ea4\u6362\u540e\u8981\u6c42\u6bcf\u4e00\u884c\u6bcf\u4e00\u5217\u90fd\u4e0d\u80fd\u6709\u76f8\u540c\u7684\u6570\u5b57\u3002\u6c42\u65b9\u6cd5\u6570\u91cf\u9664\u4ee5 $10^9+7$ \u7684\u4f59\u6570\u3002  \n## \u9898\u76ee\u89e3\u6790\n\u5982\u679c\u6709\u4e00\u5217\u6709\u76f8\u540c\u7684\u6570\u5b57\uff0c\u80af\u5b9a\u662f $0$\u3002  \n\u73b0\u5728\u8003\u8651\u4e00\u4e0b\u7b54\u6848\u4e0d\u4e3a $0$ \u7684\u60c5\u51b5\u3002  \n\u7531\u4e8e\u6bcf\u4e00\u884c\u90fd\u662f\u4e00\u4e2a\u5168\u6392\u5217\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5728\u4ea4\u6362\u7684\u65f6\u5019\u4fdd\u8bc1\u6709\u4e00\u4e2a\u6570\u5b57\u4ece\u4e0a\u9762\u6362\u5230\u4e86\u4e0b\u9762\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6570\u5b57\u80af\u5b9a\u8981\u518d\u6362\u4e0a\u53bb\u4e00\u4e2a\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u53d1\u73b0\uff0c\u6709\u51e0\u5217\u5fc5\u987b\u540c\u65f6\u6362,\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u641c\u7d22\u6765\u786e\u5b9a\u5fc5\u987b\u4e00\u8d77\u4ea4\u6362\u7684\u5217\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u628a\u6240\u6709\u7684 $n$ \u5217\u5206\u6210 $x$ \u4e2a\u90e8\u5206\uff0c\u7531\u4e8e\u8fd9 $n$ \u4e2a\u6570\u5b57\u90fd\u662f\u5168\u6392\u5217\uff0c\u6240\u4ee5\u4e0d\u5b58\u5728\u67d0\u4e00\u5217\u4e0d\u5c5e\u4e8e\u8fd9 $x$ \u90e8\u5206\uff0c\u7b54\u6848\u663e\u7136\u5c31\u662f $2^x$\u3002\n\u641c\u7d22\u7684\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u5f00\u4e2a\u6876\u6765\u4f18\u5316\u67e5\u627e\u7684\u8fc7\u7a0b\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<cstdio>\n#include<cstring>\n#define maxn 400039\n#define MOD 1000000007\nusing namespace std;\n//#define debug\ntypedef int Type;\ntypedef long long ll;\ninline Type read(){\n\tType sum=0;\n\tint flag=0;\n\tchar c=getchar();\n\twhile((c<'0'||c>'9')&&c!='-') c=getchar();\n\tif(c=='-') c=getchar(),flag=1;\n\twhile('0'<=c&&c<='9'){\n\t\tsum=(sum<<1)+(sum<<3)+(c^48);\n\t\tc=getchar();\n\t}\n\tif(flag) return -sum;\n\treturn sum;\n}\nint T,n,a[maxn],b[maxn];\nint vis[maxn],t[maxn],ans;\nll pow(int a,int x){\n\tll res=1,tmp=a;\n\twhile(x){\n\t\tif(x&1) res=res*tmp%MOD;\n\t\ttmp=(tmp*tmp)%MOD;\n\t\tx>>=1;\n\t}\n\treturn res;\n}\nint check(){\n\tfor(int i=1;i<=n;i++)\n\t    if(a[i]==b[i]) return 1;\n\treturn 0;\n}\nvoid dfs(int x){\n\tif(vis[x]) return;\n\tvis[x]=1;\n\tdfs(t[a[x]]);\n}\nint main(){\n\t//freopen(\".in\",\"r\",stdin);\n\t//freopen(\".out\",\"w\",stdout);\n    T=read();\n\twhile(T--){\n    \tn=read(); ans=0;\n    \tfor(int i=1;i<=n;i++) a[i]=read();\n    \tfor(int i=1;i<=n;i++) b[i]=read();\n    \tif(check()){\n    \t\tprintf(\"0\\n\");\n    \t\tcontinue;\n\t\t}\n\t\tmemset(vis,0,sizeof(vis));\n\t\tfor(int i=1;i<=n;i++)\n\t\t    t[b[i]]=i;\n\t\tfor(int i=1;i<=n;i++)\n\t\t    if(!vis[i]){\n\t\t    \tdfs(i);\n\t\t\t\tans++;\n\t\t\t}\n\t\tprintf(\"%lld\\n\",pow(2,ans));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1623828949,
        "uid": 215042,
        "name": "jiangtaizhe001",
        "ccfLevel": 7,
        "title": "CF1534C Little Alawn's Puzzle \u9898\u89e3"
    },
    {
        "content": "### \u9898\u76ee\u7b80\u5316\u548c\u5206\u6790\uff1a   \n\n\u6d89\u53ca\u7b97\u6cd5\uff1a**\u5e76\u67e5\u96c6**\u3002  \n\n\u4e3a\u4ec0\u4e48\u8981\u4f7f\u7528\u5e76\u67e5\u96c6\uff1a\n\n- \u56e0\u4e3a\u4ea4\u6362\u53ea\u80fd\u662f\u5217\u4ea4\u6362\uff0c\u5e76\u4e14\u4fdd\u8bc1\u4e0d\u4e0e\u522b\u7684\u91cd\u590d\n- \u6211\u4eec\u901a\u8fc7\u89c2\u5bdf\u9898\u76ee\u53d1\u73b0\uff0c\u67d0\u4e9b\u5217\u4e4b\u95f4\u4e92\u4e3a\u9650\u5236\u5173\u7cfb  \n- \u5373\u5982\u679c\u67d0\u5217\u5e8f\u5217\u6392\u5e8f\u65b9\u5f0f\u56fa\u5b9a\uff0c\u5219\u88ab\u9650\u5236\u7684\u5217\u4e5f\u4e3a\u56fa\u5b9a\u7684\n- \u6b64\u65f6\u6211\u4eec\u4f1a\u53d1\u73b0\u53ea\u6709\u4e24\u79cd\uff08\u4e00\u4e2a\u4e92\u76f8\u9650\u5236\u7684\u96c6\u5408\u5217\uff09   \n\n\u65e2\u7136\u5982\u6b64\uff0c\u6211\u4eec\u5c06\u8fd9\u6bcf\u4e2a\u96c6\u5408\u770b\u4f5c\u4e3a\u4e00\u4e2a\u8054\u901a\u5206\u91cf\u3002   \n\u7528\u5e76\u67e5\u96c6\u679a\u4e3e\u6709\u51e0\u4e2a\u8fde\u901a\u5206\u91cf\u3002     \n\u7279\u522b\u7684\uff0c\u4e00\u5217\u4e2d\u7684\u4e24\u4e2a\u6570\u80af\u5b9a\u4e92\u76f8\u9650\u5236\u3002     \n\n\u5982\u679c\u6211\u4eec\u6709 $ans$ \u4e2a\u8054\u901a\u5206\u91cf\u3002  \n\u5219\u7b54\u6848\u4e3a $2^{ans}$ \u3002   \n\n> \u6ce8\u610f\uff1a\u4e00\u5b9a\u8981\u5f00 long long    \n\n### Solution:\n\n```cpp\n#include<bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n#define int long long\nconst int N=4e5+50;\nconst int mod=1e9+7;\nint t,n;\nint p[N],a[N],b[N];\nint find(int x){\n\tif(x!=p[x]) return p[x]=find(p[x]);\n\treturn p[x]; \n}\nint qbow(int a,int b,int m)\n{\n    ll ans=1;\n    while(b>0)\n    {\n        if(b%2!=0)\n            ans=ans*a%m;\n        a=a*a%m;\n        b=b>>1;  \n    }\n    ans %= m;\n    return ans;\n}\nsigned main()\n{\n\tscanf(\"%lld\",&t);\n\twhile(t--){\n\t\tscanf(\"%lld\",&n);\n\t\tfor(int i=1;i<=n;++i) scanf(\"%lld\",&a[i]),p[i]=i;\n\t\tfor(int i=1;i<=n;++i) {\n\t\t\tscanf(\"%lld\",&b[i]);\n\t\t\tint fx=find(a[i]),fy=find(b[i]);\n\t\t\tif(fx!=fy){\n\t\t\t\tp[fx]=fy;\n\t\t\t}\n\t\t}\n\t\tint ans=0;\n\t\tfor(int i=1;i<n;++i){\n\t\t\tint fx=find(i),fy=find(i+1);\n\t\t\tif(fx!=fy){\n\t\t\t\tans++;\n\t\t\t\tp[fx]=fy;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%lld\\n\",qbow(2,ans+1,mod));\n\t}\n}\n```",
        "postTime": 1659582713,
        "uid": 750803,
        "name": "_Revenge_",
        "ccfLevel": 0,
        "title": "CF1534C"
    },
    {
        "content": "\u8003\u8651\u4e00\u4e0b\u4ea4\u6362\u60c5\u51b5\uff0c\u663e\u7136\u4f1a\u6709\u76f8\u4e92\u5f71\u54cd\u7684\u5217\uff0c\u800c\u8fd9\u6837\u7684\u5217\u6700\u7ec8\u4e00\u5b9a\u4f1a\u8fde\u6210\u73af\uff0c\u800c\u6bcf\u4e2a\u73af\u4e00\u5171\u53ea\u53ef\u80fd\u6709 $2$ \u79cd\u60c5\u51b5\uff0c\u6240\u4ee5\u5047\u5982\u4e00\u5171\u6709 $k$ \u4e2a\u73af\uff0c\u7b54\u6848\u5e94\u5f53\u4e3a $2^k$\u3002\n\n\u4e0b\u9762\u6765\u770b\u600e\u4e48\u627e\u73af\u3002\n\n\u6211\u4eec\u51c6\u5907\u4e24\u4e2a\u6570\u7ec4 ```a[2][N]``` \u548c ```p[2][N]```\uff0c\u5176\u4e2d ```a``` \u6570\u7ec4\u5b58\u50a8\u6570\u503c\uff0c```p``` \u6570\u7ec4\u5b58\u50a8\u6bcf\u4e00\u884c\u6bcf\u4e00\u4e2a\u6570\u6240\u5728\u7684\u4f4d\u7f6e\u3002\u7531\u4e8e\u6700\u521d\u7ed9\u51fa\u7684\u6570\u5217\u662f\u548c\u6cd5\u6570\u5217\uff0c\u6240\u4ee5\u76f8\u51b2\u7a81\u7684\u6570\u5fc5\u7136\u4e0d\u5728\u540c\u4e00\u884c\u3002\n\n\u6211\u4eec\u53ea\u9700\u8981\u627e\u5230\u4e00\u4e2a\u672a\u8bbf\u95ee\u8fc7\u7684\u5217\uff0c\u5c06\u8fd9\u4e00\u5217\u6807\u8bb0\u4e3a\u5df2\u8bbf\u95ee\uff0c\u518d\u53bb\u5bfb\u627e\u8fd9\u4e00\u5217\u7b2c\u4e8c\u884c\u7684\u6570\u5728\u7b2c\u4e00\u884c\u54ea\u91cc\u51fa\u73b0\uff0c\u8fdb\u884c\u9012\u5f52\uff0c\u76f4\u5230\u8bbf\u95ee\u5230\u4e00\u4e2a\u5df2\u8bbf\u95ee\u7684\u5217\uff0c\u8bf4\u660e\u5f62\u6210\u4e86\u73af\uff0c\u8ba1\u6570\u52a0\u4e00\uff0c\u9000\u51fa\u9012\u5f52\u3002\u91cd\u590d\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u76f4\u5230\u6240\u6709\u5217\u90fd\u88ab\u8bbf\u95ee\u3002\n\n\u7531\u4e8e\u4ec5\u6709 $n$ \u5217\uff0c\u6bcf\u5217\u53ea\u4f1a\u8bbf\u95ee\u4e00\u6b21\uff0c\u6240\u4ee5\u627e\u73af\u662f\u5747\u644a $O(1)$ \u603b\u4f53 $O(n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002\n\n\n``` cpp\nconst int N = 500010;\nconst int MOD = 1e9 + 7;\nconst int INF = 0x3fffffff;\n\nint t,n,a[2][N],v[N],p[2][N],ans = 1;\n\ninline void get_ring(int k,int f){\n    if (v[k]) return;\n    v[k] = 1;\n    get_ring(p[f][a[f ^ 1][k]],f);\n}\n\nint main(){\n    scanf(\"%d\",&t);\n    while (t --){\n        mset(v,0);ans = 1;\n        scanf(\"%d\",&n);\n        for (int i = 1;i <= n;i ++){\n            scanf(\"%d\",&a[0][i]);\n            p[0][a[0][i]] = i;\n        }\n        for (int i = 1;i <= n;i ++){\n            scanf(\"%d\",&a[1][i]);\n            p[1][a[1][i]] = i;\n        }\n        for (int i = 1;i <= n;i ++)\n          if (!v[i]){\n              (ans <<= 1) %= MOD;\n              get_ring(i,0);\n          }\n        cout << ans << endl;\n    }\n    return 0;\n}\n```",
        "postTime": 1623738116,
        "uid": 162191,
        "name": "Dfkuaid",
        "ccfLevel": 6,
        "title": "[\u9898\u89e3]CF1534C Little Alawn's Puzzle"
    },
    {
        "content": "# C Little Alawn's Puzzle\r\n\r\n[CF1534C Little Alawn's Puzzle](https://www.luogu.com.cn/problem/CF1534C)\r\n\r\n## \u9898\u610f\u7b80\u8ff0\r\n\r\n\u9898\u76ee\u7ed9\u51fa\u4e00\u4e2a $2 \\times n$ \u7684\u6570\u9635\uff0c\u95ee\u4f60\u5728\u7ecf\u8fc7\u64cd\u4f5c\u4e4b\u540e\uff0c\u80fd\u591f\u6ee1\u8db3**\u6ca1\u6709\u76f8\u540c\u6570\u5b57\u5728\u540c\u4e00\u884c**\u7684\u6570\u9635\u80fd\u6709\u591a\u5c11\u4e2a\u3002\r\n\r\n\u4f60\u53ef\u4ee5\u8fdb\u884c\u7684\u64cd\u4f5c\u5c31\u662f**\u4ea4\u6362\u4e00\u5217\u4e2d\u7684\u4e24\u4e2a\u6570\u5b57**\u3002\r\n\r\n\u7531\u4e8e\u7b54\u6848\u53ef\u80fd\u4f1a\u5f88\u5927\uff0c\u6240\u4ee5\u4f60\u9700\u8981\u5728\u8f93\u51fa\u4e4b\u524d\u6a21\u4e0a $10^9+7$\uff0c\u5e76\u4e14\u6bcf\u4e2a\u6d4b\u8bd5\u70b9\u6709\u591a\u7ec4\u6570\u636e\u3002\r\n\r\n## \u601d\u8def\u7b80\u8ff0\r\n\r\n\u6211\u4eec\u53ef\u4ee5\u5148\u6765\u89c2\u5bdf\u4e00\u4e0b\u6837\u4f8b\u3002\r\n\r\n\u53ef\u4ee5\u53d1\u73b0\u5047\u5982\u6211\u4eec\u4ea4\u6362\u4efb\u610f\u4e00\u5217\u7684\u4e24\u4e2a\u6570\uff0c\u5176\u5b83\u7684\u6240\u6709\u7684\u62e5\u6709\u8fd9\u4e24\u4e2a\u6570\u4e4b\u4e00\u7684\u5217\u4e5f\u90fd\u4f1a\u88ab\u5f71\u54cd\u5230\uff0c\u5426\u5219\u5c06\u51fa\u73b0\u77db\u76fe\u3002\r\n\r\n\u4e8e\u662f\u53ef\u4ee5\u53d1\u73b0\uff0c\u5176\u5b9e\u6bcf\u4e00\u7ec4\u76f8\u5173\u8054\u7684\u5217\u90fd\u6784\u6210\u4e86\u4e00\u4e2a\u73af\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5efa\u56fe\u6765\u67e5\u73af\u3002\r\n\r\n\u7531\u4e8e\u6211\u8111\u888b\u6bd4\u8f83\u76f4\u5c31\u968f\u624b\u5199\u4e86\u4e2a\u5e76\u67e5\u96c6\uff0c\u6700\u540e\u67e5\u4e00\u4e0b\u6709\u51e0\u4e2a\u96c6\u5373\u53ef\u3002\r\n\r\n\r\n## Code\r\n\r\n\r\n```cpp\r\n#include <bits/stdc++.h>\r\n#define Heriko return\r\n#define Deltana 0\r\n#define S signed\r\n#define LL long long\r\n#define R register\r\n#define I inline\r\n#define CI const int\r\n#define mst(a, b) memset(a, b, sizeof(a))\r\n#define ON std::ios::sync_with_stdio(false)\r\nusing namespace std;\r\nI void fr(LL & x)\r\n{\r\n    LL f=1;\r\n    char c=getchar();\r\n    x=0;\r\n    while(c<'0' or c>'9')\r\n    {\r\n        if(c=='-') f=-1;\r\n        c=getchar();\r\n    }\r\n    while (c>='0' and c<='9') \r\n    {\r\n        x=(x<<3)+(x<<1)+c-'0';\r\n        c=getchar();\r\n    }\r\n    x*=f;\r\n}\r\nI void fw(LL x)\r\n{\r\n    if(x<0) putchar('-'),x=-x;\r\n    static LL stak[35];\r\n    LL top=0;\r\n    do\r\n    {\r\n        stak[top++]=x%10;\r\n        x/=10;\r\n    }\r\n    while(x);\r\n    while(top) putchar(stak[--top]+'0');\r\n    putchar('\\n');\r\n}\r\nCI MXX=2e6+5,mod=1e9+7;\r\nLL t,n,f[MXX],a1[MXX],ans,os[MXX];\r\nLL find(LL x)\r\n{\r\n    if(x!=f[x]) f[x]=find(f[x]);\r\n    Heriko f[x];\r\n}\r\nI void uni(LL a,LL b)\r\n{\r\n    f[find(a)]=find(b);\r\n}\r\nI LL powermod(LL a,LL n,LL m)\r\n{\r\n\tif(n==0) Heriko 1%m;\r\n\tLL x=powermod(a,n/2,m);\r\n\tLL res=x*x%m;\r\n\tif(n%2!=0) res=res*a%m;\r\n\tHeriko res;\r\n}\r\nS main()\r\n{\r\n    fr(t);\r\n    while(t--)\r\n    {\r\n        fr(n);f[n+n+1]=ans=0;\r\n        //\u6574\u9f50\u5212\u4e00\u7684 for\r\n        for(R LL i=1;i<=n+n;++i) f[i]=i;\r\n        for(R LL i=1;i<=n+n;++i) fr(a1[i]);\r\n        for(R LL i=1;i<=n;++i) uni(a1[i],a1[i+n]);\r\n        for(R LL i=1;i<=n+n;++i) os[i]=0;\r\n        for(R LL i=1;i<=n+n;++i) os[find(i)]++;\r\n        for(R LL i=1;i<=n;++i) if(os[i]) ans++;\r\n        fw(powermod(2,ans,mod));\r\n    }\r\n    Heriko Deltana;\r\n}\r\n```",
        "postTime": 1623673014,
        "uid": 407417,
        "name": "HerikoDeltana",
        "ccfLevel": 4,
        "title": "CF1534C\u9898\u89e3"
    }
]
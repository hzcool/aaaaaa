[
    {
        "content": "## [***\u70b9\u6211\u83b7\u5f97\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c***](https://fanfansann.blog.csdn.net/article/details/113522707)\n\n\n\n\n**Problem D Strange Definition**\n\n\u4e24\u4e2a\u6574\u6570 $x$ \u548c $y$ \u662f **\u76f8\u90bb\u7684** \u5f53 $\\frac{lcm(x,y)}{gcd(x,y)}$\u662f\u5b8c\u5168\u5e73\u65b9\u6570\u3002\n\n\u4f60\u6709\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217 $a$\u3002\u6bcf\u4e00\u79d2\uff0c\u6240\u6709\u7684 $a_i$\u90fd\u4f1a\u53d8\u6210\u5e8f\u5217\u4e2d\u6240\u6709\u548c\u5b83 **\u76f8\u90bb\u7684** \u7684\u6570\u7684\u4e58\u79ef\u3002\u4ee4 $d_i$\u4e3a\u6570\u5217\u4e2d\u4e0e $a_i$    **\u76f8\u90bb\u7684** \u7684\u6570\u7684\u4e2a\u6570\n\n\u6709 $q$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u7ed9\u51fa\u4e00\u4e2a $w$\uff0c\u6c42\u5728 $w$ \u79d2\u65f6\u7684 \n$\\max\\{d_i\\}$\n\n**Solution**\n\n\u9996\u5148\uff0c\u6211\u4eec\u6765\u5b66\u4e60\u4e00\u4e2a\u5355\u8bcd\uff1a$\\tt perfect\\ square$\uff1a\u5b8c\u5168\u5e73\u65b9\u6570...\u6211\u8fd8\u4ee5\u4e3a\u662f\u5b8c\u7f8e\u7684\u6b63\u65b9\u5f62\uff0c\u6211\u8bf4\u54ea\u6765\u7684\u6b63\u65b9\u5f62...\u7ed9\u6211\u4eba\u770b\u50bb\u4e86...\n\n\u4ee5\u53ca $\\tt adjacent$\uff1a adj. \u76f8\u90bb\u7684\uff0c\u6bd7\u90bb\u7684\n\n\u7136\u540e\u5f00\u59cb\u7167\u4f8b\u5206\u6790\u9898\u76ee\u4e2d\u7684\u6027\u8d28\u3002\n\n\u9996\u5148\u662f\u5b8c\u5168\u5e73\u65b9\u6570\uff0c\u5c31\u662f\u6307\u6574\u6570 $x$ \u5b58\u5728\u4e00\u4e2a\u6b63\u6574\u6570 $y$ \uff0c\u4f7f\u5f97 $x=y^2$\uff0c\u6574\u6570 $x$ \u5c31\u662f\u4e00\u4e2a\u5b8c\u5168\u5e73\u65b9\u6570\u3002\n\n\u6211\u4eec\u5b9a\u4e49\u4e24\u4e2a\u6570\u662f\u76f8\u90bb\u7684\uff0c\u662f\u6307\u4e24\u4e2a\u6574\u6570 $x$ \u548c $y$ \uff0c\u6ee1\u8db3\uff1a   $\\frac{lcm(x,y)}{gcd(x,y)}$ \u662f\u5b8c\u5168\u5e73\u65b9\u6570\u3002\n\n\u6211\u4eec\u77e5\u9053 $\\gcd(x,y) \\times lcm(x,y)=x\\times y$\u3002\n\n$$\\frac{lcm(x,y)}{gcd(x,y)}=\\frac{x\\times y}{\\gcd(x,y)^2}$$\n\n\u8fd9\u4e2a\u4e1c\u897f\u662f\u5b8c\u5168\u5e73\u65b9\u6570\uff0c\u4e5f\u5c31\u610f\u5473\u7740\u5b83\u53ef\u4ee5\u88ab\u5f00\u6839\u3002\n\n\u5373\n\n$$\\sqrt{\\frac{x\\times y}{\\gcd(x,y)^2}}=\\frac{\\sqrt{x\\times y}}{\\gcd(x,y)}$$\n\n\u4e5f\u5c31\u662f\u8bf4\u5bf9\u4e8e\u4efb\u610f\u4e24\u4e2a\u6574\u6570 $x$ \u548c $y$ \u800c\u8a00\uff0c\u82e5 $x\\times y$ \u662f\u5b8c\u5168\u5e73\u65b9\u6570\uff0c\u5219\u8fd9\u4e24\u4e2a\u6570\u662f\u76f8\u90bb\u7684\u3002\n\n\u7531 **\u6570\u8bba\u5fc5\u5907** \u552f\u4e00\u5206\u89e3\u5b9a\u7406\u5f97\uff1a\n\n$x=p_1^{\\alpha_1}\\times p_2^{\\alpha_2} \\times \\cdots\\times p_{k}^{\\alpha_{k}}$\n\n$y=p_1^{\\beta_1}\\times p_2^{\\beta_2} \\times \\cdots\\times p_{k}^{\\beta_{k}}$\n\n$x\\times y=p_1^{\\alpha_1+\\beta_1}\\times p_2^{\\alpha_2+\\beta_2} \\times \\cdots\\times p_{k}^{\\alpha_k+\\beta_{k}}$\n\n\u663e\u7136\uff0c\u82e5\u4e24\u4e2a\u6570\u7684\u4e58\u79ef\u662f\u5b8c\u5168\u5e73\u65b9\u6570\uff0c\u5219\u6240\u6709\u8d28\u56e0\u5b50\u7684\u6b21\u5e42 $\\alpha +\\beta$ \u5747\u4e3a\u5076\u6570\u3002\n\n\u4e5f\u5c31\u610f\u5473\u7740\u6240\u6709\u8d28\u56e0\u5b50\u5bf9\u5e94\u7684 $\\alpha$ \u548c $\\beta$ \u662f\u540c\u5947\u5076\u6027\u7684\uff0c\u5373 $\\alpha$ \u662f\u5947\u6570\uff0c $\\beta$ \u4e5f\u662f\u5947\u6570\uff0c\u6216\u8005 $\\alpha$ \u662f\u5076\u6570\uff0c $\\beta$ \u4e5f\u662f\u5076\u6570\uff0c\u6216\u8005\u4e00\u4e2a\u662f\u5076\u6570\uff0c\u4e00\u4e2a\u662f $0$ \uff0c\u8fd9\u6837\u4e8c\u8005\u76f8\u52a0\u624d\u662f\u5076\u6570\u3002\n\n\u56e0\u4e3a\u6211\u4eec\u53d1\u73b0\u8fd8\u6709 $0$ \u7684\u5b58\u5728\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u8003\u8651\u5982\u4f55\u628a\u5076\u6b21\u5e42\u4e0e\u5076\u6b21\u5e42\uff0c\u548c $0$ \u6b21\u5e42\u4e0e\u5076\u6b21\u5e42\u8868\u793a\u6210\u4e00\u4e2a\u5f62\u5f0f\u3002\u5f88\u5bb9\u6613\u5c31\u60f3\u5230\u4e86\u6211\u4eec\u5224\u65ad\u5947\u5076\u6027\u7684\u65f6\u5019\u4f7f\u7528\u7684 `% 2`\uff0c\u8fd9\u6837\u5076\u6b21\u5e42\u6216\u8005\u672c\u6765\u5c31\u662f $0$ \u7684\u6700\u540e\u90fd\u4f1a\u53d8\u6210 $0$ \uff0c\u800c\u5947\u6b21\u5e42\u6700\u540e\u4f1a\u53d8\u6210 $1$ \u6240\u4ee5\u6211\u4eec\u5c06\u6bcf\u4e2a\u6570\u90fd\u8d28\u56e0\u6570\u5206\u89e3\u7684\u540c\u65f6\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8d28\u56e0\u5b50\u7684\u6b21\u5e42\u90fd `% 2` \uff0c\u4e5f\u5c31\u662f\u8d28\u56e0\u6570\u5206\u89e3\u7684\u65f6\u5019\u6307\u6570\u4e00\u76f4 `/= 2` \u4e5f\u5c31\u662f $/= i^2$ \u3002\u6700\u540e\u5c06 $x=p_1^{\\alpha_1}\\times p_2^{\\alpha_2} \\times \\cdots\\times p_{k}^{\\alpha_{k}}$ \u53d8\u4e3a $x=p_1^{1}\\times p_2^{0} \\times \\cdots\\times p_{k}^{0}$ \u7684\u5f62\u5f0f\u3002\n\n\u8fd9\u6837\uff0c\u6700\u540e\u53ea\u8981\u662f $0$ \u5c31\u90fd\u662f\u4e00\u7ec4\u3002\n\n\u4f46\u662f\u5bf9\u4e8e\u5947\u6570\u800c\u8a00\uff0c\u4e0d\u4e00\u5b9a\u3002\u56e0\u4e3a\u867d\u7136\u90fd\u662f\u662f $1$ \uff0c\u4f46\u662f\u5947\u6b21\u5e42\u7684\u8bdd\uff0c\u5fc5\u987b\u80fd\u591f\u914d\u5bf9\uff0c\u624d\u662f\u4e00\u7ec4\uff0c\u914d\u5bf9\u7684\u610f\u601d\u5c31\u662f \u53d8\u6210 $x=p_1^{1}\\times p_2^{0} \\times \\cdots\\times p_{k}^{0}$ \u7684\u5f62\u5f0f\u4ee5\u540e\uff0c\u4e24\u4e2a\u6570\u5269\u4f59\u7684\u8d28\u56e0\u5b50\u5fc5\u987b\u5b8c\u5168\u76f8\u540c\uff0c\u4e5f\u5c31\u662f\u62e5\u6709\u76f8\u540c\u7684 $1$ \u6b21\u5e42\u7684\u8d28\u56e0\u5b50\uff0c\u4e5f\u5c31\u662f\u8f6c\u6362\u4e3a\u4e0a\u9762\u7684\u90a3\u4e2a\u5f62\u5f0f\u4ee5\u540e\uff0c \u4e24\u4e2a\u6570\u7684\u503c\u5b8c\u5168\u76f8\u540c\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 `map` \u6765\u50a8\u5b58\u540c\u4e00\u7ec4\uff08\u76f8\u4e92\u90fd\u76f8\u90bb\uff09\u7684\u5143\u7d20\u4e2a\u6570\u3002\n\n\u5206\u6790\u5b8c\u76f8\u90bb\u7684\u6027\u8d28\u4ee5\u540e\uff0c\u6211\u4eec\u77e5\u9053\u5982\u4f55\u5224\u65ad\u662f\u5426\u76f8\u90bb\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5bf9\u4e8e\u6bcf\u4e2a\u8f93\u5165\u7684\u6570\uff0c\u5224\u65ad\u4e00\u4e0b\uff0c\u5b58\u5165 `map` \u4e2d\u3002\n\n\u7136\u540e\u518d\u6765\u8003\u8651\u7b2c\u4e8c\u4e2a\u95ee\u9898\uff0c\u9898\u76ee\u4e2d\u7684\u64cd\u4f5c\uff0c\u5408\u5e76\u3002\n\n\u6211\u4eec\u4ece\u7b2c $0$ \u79d2\u5f00\u59cb\uff0c\u6bcf\u4e00\u79d2\uff0c\u6bcf\u4e00\u4e2a\u6570\u90fd\u4f1a\u53d8\u6210\u6240\u6709\u4e0e\u81ea\u5df1\u76f8\u90bb\uff08\u5305\u62ec\u81ea\u5df1\uff09\u7684\u6570\u7684\u4e58\u79ef\uff0c\u7136\u540e\u6709 $q$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u4f1a\u95ee\u7b2c $\\omega$ \u79d2\uff0c\u6570\u5217\u4e2d\uff0c\u6240\u6709\u76f8\u90bb\u7ec4\uff08\u5168\u90e8\u4e24\u4e24\u76f8\u90bb\uff09\u4e2d\u5143\u7d20\u4e2a\u6570\u6700\u591a\u7684\u4e2a\u6570\u3002$\\omega \\le10^{18}$\u3002\u6240\u4ee5\u6211\u4eec\u77ac\u95f4\u5c31\u53ef\u4ee5\u770b\u51fa\u70b9\u4ec0\u4e48\u4e1c\u897f\uff0c\u5c31\u662f\u8fd9\u4e2a\u64cd\u4f5c\u4fee\u6539\u4ee5\u540e\uff0c\u7b54\u6848\u80af\u5b9a\u5b58\u5728\u4e00\u4e2a\u5faa\u73af\u8282\u6216\u8005\u4e4b\u540e\u7684\u67d0\u4e00\u65f6\u523b\u5c31\u4e0d\u4f1a\u518d\u53d1\u751f\u53d8\u5316\u4e86\u3002\u56e0\u4e3a\u8be2\u95ee\u7684\u6570\u636e\u592a\u5927\uff0c \u5565\u6570\u636e\u7ed3\u6784\u90fd\u4e0d\u53ef\u80fd\u5b58\u5f97\u4e0b\uff0c\u4e5f\u4e0d\u53ef\u80fd\u5feb\u901f\u5730\u6c42\u89e3\u3002\n\n\u7136\u540e\u6211\u4eec\u6765\u5206\u6790\u8fd9\u4e2a\u64cd\u4f5c\uff0c\u540c\u4e00\u7ec4\u7684\u6240\u6709\u7684\u6570\u90fd\u4f1a\u540c\u65f6\u5408\u5e76\uff0c\u6211\u4eec\u6839\u636e\u4e0a\u9762\u7684\u5206\u6790\uff0c\u77e5\u9053\u4e00\u5171\u6709\u56db\u79cd\u7ec4\u522b\n\n1. \u4e2a\u6570\u4e3a\u5076\u6570\u7684 $0$ \u7ec4\uff08\u5076\u6b21\u5e42\uff09\n2. \u4e2a\u6570\u4e3a\u5947\u6570\u7684 $0$ \u7ec4\uff08\u5076\u6b21\u5e42\uff09\n3. \u4e2a\u6570\u4e3a\u5076\u6570\u7684 $1$ \u7ec4\uff08\u5947\u6b21\u5e42\uff09\n4. \u4e2a\u6570\u4e3a\u5947\u6570\u7684 $1$ \u7ec4\uff08\u5947\u6b21\u5e42\uff09\n\n\u6211\u4eec\u6765\u5206\u6790\u8fd9\u56db\u79cd\u7ec4\u522b\u5408\u5e76\u540e\u4f1a\u53d1\u751f\u4ec0\u4e48\u3002\n\n- **\u7b2c\u4e00\u79cd\uff0c\u7b2c\u4e8c\u79cd**\n\n\u6211\u4eec\u7684\u5408\u5e76\u64cd\u4f5c\u662f\u5168\u90e8\u6570\u7684\u4e58\u79ef\uff0c\u5bf9\u4e8e\u8d28\u56e0\u6570\u5206\u89e3\u540e\u7684 $x$ \uff0c\u5168\u90e8\u6570\u7684\u4e58\u79ef\u5b9e\u9645\u4e0a\u5c31\u662f\u6240\u6709\u6570\u7684\u6307\u6570\u7684\u548c\uff0c\u800c\u7b2c\u4e00\u79cd\uff0c\u7b2c\u4e8c\u79cd\uff0c\u4e0d\u7ba1\u7ec4\u5185\u4e2a\u6570\u662f\u5947\u6570\u4e2a\u8fd8\u662f\u5076\u6570\u4e2a\uff0c\u56e0\u4e3a\u90fd\u662f\u5076\u6570\uff0c\u6240\u4ee5\u548c\u4ecd\u7136\u662f\u5076\u6570\uff0c\u4e5f\u610f\u5473\u7740\u8fd8\u662f\u7b2c\u4e00\u79cd\u6216\u8005\u7b2c\u4e8c\u79cd\uff0c\u800c\u7b2c\u4e00\u79cd\u548c\u7b2c\u4e8c\u79cd\u5b9e\u9645\u4e0a\u662f\u540c\u4e00\u79cd\uff0c\u56e0\u4e3a\u90fd\u662f\u76f8\u90bb\u7684\uff0c\u8fd9\u91cc\u5206\u5f00\u53ea\u662f\u4e24\u79cd\u4e0d\u540c\u7684\u60c5\u51b5\u3002\u6240\u4ee5\u7b2c\u4e00\u7b2c\u4e8c\u79cd\u4efb\u610f\u79d2\u4ee5\u540e\uff0c\u4ecd\u7136\u8fd8\u662f\u7b2c\u4e00\u7b2c\u4e8c\u79cd\u3002\n\n- **\u7b2c\u4e09\u79cd**\n\n\u5076\u6570\u4e2a\u5168\u90e8\u5bf9\u5e94\u7684\u5947\u6b21\u5e42\uff0c\u548c\u4e3a\u5076\u6570\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u6b21\u5e42\u90fd\u662f\u5947\u6570\uff0c\u4e5f\u5c31\u662f $1$ \uff0c\u5947\u6570\u52a0\u5947\u6570\u4e3a\u5076\u6570\uff0c\u5728\u7b2c\u4e00\u79d2\u7b2c\u4e00\u6b21\u5408\u5e76\u4ee5\u540e\u5f52\u4e3a\u7b2c\u4e00\u79cd\u6216\u8005\u7b2c\u4e8c\u79cd\u3002\n\n- **\u7b2c\u56db\u79cd**\n\n\u5947\u6b21\u5e42\uff0c\u8fd8\u662f\u5947\u6570\u4e2a\uff0c\u90a3\u4e48\u76f8\u4e58\uff0c\u4e5f\u5c31\u662f\u6307\u6570\u76f8\u52a0\uff0c\u6c38\u8fdc\u90fd\u8fd8\u662f\u7b2c\u56db\u79cd\u3002\n\n\u5206\u6790\u5b8c\u6211\u4eec\u53d1\u73b0\uff0c\u8be2\u95ee\u4e00\u5171\u5206 $\\omega=0$ \u548c $\\omega>0$ \u4e24\u79cd\u60c5\u51b5\uff0c $\\omega=0$ \u7684\u65f6\u5019\uff0c\u6570\u5217\u4e2d\u7684\u6570\u4e00\u5171\u5206\u4e3a\u4e09\u79cd\n\n- \u7b2c\u4e00\u79cd\u5c31\u662f\u6211\u4eec\u4e0a\u9762\u8bf4\u7684\u7b2c\u4e00\u7b2c\u4e8c\u79cd\uff0c\u6211\u4eec\u7d2f\u8ba1\u6240\u6709\u6307\u6570\u662f\u5076\u6b21\u5e42\u7684\u5143\u7d20\u7684\u4e2a\u6570\u3002\n- \u7b2c\u4e8c\u79cd\u4e3a\u6211\u4eec\u4e0a\u9762\u8bf4\u7684\u7b2c\u4e09\u79cd\uff0c\u5373\u867d\u7136\u662f $1$ \u7ec4\uff0c\u4f46\u662f\u4e2a\u6570\u662f\u5076\u6570\uff0c\u4e5f\u5c31\u662f\u6211\u4eec `map` \u5b58\u7684\u7b2c\u4e8c\u7ef4\u662f\u5076\u6570\u3002\n- \u7b2c\u4e09\u79cd\u5c31\u662f\u6211\u4eec\u4e0a\u9762\u8bf4\u7684\u7b2c\u56db\u79cd\uff0c\u5947\u6570\u4e2a\u7684\u5947\u6570\u6b21\u5e42\uff0c\u6211\u4eec\u7528 `map` \u6765hash\u4e00\u4e0b\uff0c\u5bf9\u4e8e\u8fd9\u4e00\u79cd\u7684\u6bcf\u4e00\u4e2a\u503c\uff0c\u90fd\u5206\u4e3a\u6bcf\u4e00\u7ec4\uff0c\u53d6\u6700\u503c\u3002\n\n $\\omega=0$ \u65f6\u7b54\u6848\u5c31\u662f\u4e0a\u8ff0\u4e09\u79cd\u7684\u5143\u7d20\u4e2a\u6570\u7684\u6700\u5927\u503c\u3002\n\n $\\omega>0$ \u65f6\uff0c \u7b2c\u4e8c\u79cd\u5168\u90e8\u5f52\u4e3a\u7b2c\u4e00\u79cd\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u7528\u7b2c\u4e09\u79cd\u91cc\u6700\u5927\u7684\u90a3\u4e00\u7ec4\u7684\u4e2a\u6570\uff0c\u4e0e\u7b2c\u4e00\u79cd\u5143\u7d20\u4e2a\u6570\u52a0\u4e0a\u7b2c\u4e8c\u79cd\u7684\u5143\u7d20\u4e2a\u6570\uff0c\u53d6\u6700\u5927\u503c\u5373\u53ef\u3002\n\n\n**detail**\n\n\u867d\u7136\u4e0a\u9762\u8bf4\u4e86\u90a3\u4e48\u5927\u4e00\u5806\uff0c\u8fd9\u4e9b\u5b9e\u9645\u4e0a\u53ea\u662f\u6211\u5f53\u65f6\u505a\u9898\u7684\u65f6\u5019\u7684\u5fc3\u7406\u6d3b\u52a8\uff0c\u5728\u6f14\u8349\u7eb8\u4e0a\u753b\u601d\u7ef4\u5bfc\u56fe\u6765\u5206\u7c7b\u8ba8\u8bba\uff0c\u603b\u5171\u82b1\u4e86\u4e0d\u5230 $10$ \u5206\u949f\uff0c\u56e0\u4e3a\u5199\u9898\u89e3\u6211\u4e60\u60ef\u8bb2\u7684\u6bd4\u8f83\u8be6\u7ec6\uff0c\u6211\u5e0c\u671b\u53ef\u4ee5\u628a\u5982\u4f55\u601d\u8003\u95ee\u9898\u5e26\u7ed9\u5927\u5bb6\uff0c\u6240\u4ee5\u5185\u5bb9\u6709\u70b9\u591a\u4e86\uff0c\u8bf7\u5927\u5bb6\u89c1\u8c05 ...\n\n**Code**\n\n\u5b9e\u73b0\u5c31\u975e\u5e38\u7b80\u5355\u4e86\uff0c\u7167\u7740\u4e0a\u9762\u7684\u601d\u8def\u6a21\u62df\u4e00\u904d\u5c31\u884c\u4e86\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#include <algorithm>\n#include <vector>\n#include <unordered_map>\n\nusing namespace std;\nconst int N = 3e5 + 7, mod = 1e9 + 7;\ntypedef long long ll;\nunordered_map<int, int> Hash;\nvoid get_factor(int x)\n{\n    for(int i = 2; ; ++ i) {\n        int even = i * i;\n        while(x % even == 0 && x >= even) x /= even;\n        if(x < even) break;\n    }\n    Hash[x] ++ ;////\u6211\u4eec\u5b9e\u9645\u4e0a\u53ea\u9700\u8981\u77e5\u9053\u5b83\u662f\u5947\u8fd8\u662f\u5076\n    //x\u5c31\u662f\u628a\u6240\u6709\u7684\u8d28\u56e0\u5b50\u7684\u6b21\u65b9\u5168\u90e8\u538b\u62100\u6216\u80051\uff0c0\u5c31\u662f\u5076\u6b21\u5e42\uff0cx=1(\u88ab\u9664\u5c3d\u4e86)\uff0c1\u6b21\u5c31\u662f\u5947\u6b21\u5e42\u3002x=\u82e5\u5e72\u4e00\u6b21\u8d28\u56e0\u5b50\u7684\u4e58\u79ef\n\n    //\u5076\u6b21\u5e42\u65e0\u6240\u8c13\uff0c\u5947\u6b21\u5e42\u5fc5\u987b\u6240\u542b\u5947\u6b21\u5e42\u7684\u8d28\u56e0\u5b50\u5168\u90e8\u5b8c\u5168\u76f8\u540c\u624d\u662f\u4e00\u7ec4\uff08\u80fd\u51d1\u6210\u5076\u6570\uff0c\u4e5f\u5c31\u662f\u5b8c\u5168\u5e73\u65b9\u6570\uff09\n}\nint n, m, t, q;\nint main()\n{\n    scanf(\"%d\", &t);\n    while(t -- ) {\n        Hash.clear();\n        scanf(\"%d\", &n);\n        for(int i = 1; i <= n; ++ i) {\n            int a;\n            scanf(\"%d\", &a);\n            get_factor(a);\n        }\n        int ans1 = 0, ans2 = 0;\n        for(auto it = Hash.begin(); it != Hash.end(); ++ it) {\n            //0\u79d2\u7684\u60c5\u51b5\u4e0d\u53d8\n            ans1 = max(ans1, it -> second);//second\u662f\u4e2a\u6570\uff0c0\u79d2\u6ca1\u6709\u53d8\u5316\u7684\u65f6\u5019\uff0c\u6700\u5927\u6570\u91cf\u7684\u90a3\u7ec4\u5c31\u662f\u6700\u5927\u7684\u90a3\u7ec4\n            //1\u79d2\u7684\u60c5\u51b5\u5408\u5e76\n            if(it -> second % 2 == 0 || it -> first == 1)//(\u7ec4\u5185\u6709\u5076\u6570\u4e2a || \u8fd9\u4e2a\u7ec4\u662f\u5076\u6570\u6b21\u5e42\u7ec4)\n                ans2 += it->second;//1\u79d2\u949f\u540e\u5c31\u4f1a\u5168\u90e8\u5f52\u4e3a\u5076\u7ec4\n        }\n        ans2 = max(ans2, ans1);//\u53d6\u5947\u6570\u7ec4\u548c\u5076\u6570\u7ec4\u4e2d\u7684\u6700\u5927\u503c\n        scanf(\"%d\", &q);\n        for(int i = 1; i <= q; ++ i) {\n            ll w;\n            scanf(\"%lld\", &w);\n            if(w == 0)\n                printf(\"%d\\n\", ans1);\n            else printf(\"%d\\n\", ans2);\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1612241942,
        "uid": 262605,
        "name": "fanfansann",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1470B \u3010Strange Definition\u3011"
    },
    {
        "content": "\u7531\u4e8e $z=\\dfrac{\\textrm{lcm}(x,y)}{\\gcd(x,y)} = \\dfrac{xy}{\\gcd(x,y)^2}$\uff0c\u6240\u4ee5\u8981\u4f7f $z$ \u4e3a\u5b8c\u5168\u5e73\u65b9\u6570\uff0c$xy$ \u9700\u8981\u662f\u5b8c\u5168\u5e73\u65b9\u6570\u3002\n\n\u5b9a\u4e49 $x$ \u7684**\u6838** $\\textrm{core}(x)$ \u4e3a $x$ \u53bb\u6389\u5176\u5b8c\u5168\u5e73\u65b9\u6570\u540e\u5269\u4f59\u7684\u90e8\u5206\uff0c\u4f8b\u5982 $\\textrm{core}(12)=\\dfrac{12}{4}=3,\\ \\textrm{core}(16)=\\dfrac{16}{16}=1$.\n\n\u7531\u5b9a\u4e49\u53ef\u77e5\uff0c$xy$ \u4e3a\u5b8c\u5168\u5e73\u65b9\u6570\uff0c\u5f53\u4e14\u4ec5\u5f53 $\\textrm{core}(x)=\\textrm{core}(y)$.\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u901a\u8fc7\u7edf\u8ba1 $\\textrm{core}(x)$ \u7684\u4e2a\u6570\u6765\u6c42\u51fa\u7b2c $0$ \u79d2\u65f6\u7684\u7b54\u6848\uff0c\u5373\u6309\u7167 $\\textrm{core}$ \u503c\u5206\u7ec4\uff0c\u5143\u7d20\u6700\u591a\u7684\u7ec4\u7684\u5143\u7d20\u4e2a\u6570\u3002\n\n\u5bf9\u4e8e**\u66ff\u6362**\u64cd\u4f5c\uff0c\u7531\u4e8e\u662f\u5c06\u6240\u6709\u7b49\u4e8e $\\textrm{core}(x)$ \u7684\u6570\u4e58\u8d77\u6765\uff0c\u82e5\u8fd9\u6837\u7684\u6570\u6709\u5076\u6570\u4e2a\uff0c\u663e\u7136\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u5b8c\u5168\u5e73\u65b9\u6570\uff0c\u4e58\u79ef\u7684 $\\textrm{core}$ \u503c\u4e3a $1$\uff1b\u82e5\u8fd9\u6837\u7684\u6570\u6709\u5947\u6570\u4e2a\uff0c\u5219\u4e58\u79ef\u7684 $\\textrm{core}$ \u503c\u4ecd\u4e3a $\\textrm{core}(x)$\u3002\n\n\u6240\u4ee5\u7ecf\u8fc7\u4e00\u79d2\u540e\uff0c$\\textrm{core}(x)$ \u8981\u4e48\u53d8\u4e3a $1$\uff0c\u8981\u4e48\u4e0d\u53d8\u3002\u800c $\\textrm{core}(x)$ \u4e00\u65e6\u53d8\u4e3a $1$ \u540e\uff0c\u540e\u7eed\u7684\u66ff\u6362\u64cd\u4f5c\u4e5f\u4e0d\u4f1a\u6539\u53d8\u5176\u503c\uff0c\u6240\u4ee5\u5bf9\u4e8e\u4efb\u610f\u6b63\u6570\u79d2\u4e4b\u540e\u7684\u7b54\u6848\u548c\u7b2c $1$ \u79d2\u7684\u7b54\u6848\u662f\u4e00\u6837\u7684\u3002\u5c06 $\\textrm{core}$ \u503c\u66f4\u65b0\u4e00\u904d\u540e\u91cd\u65b0\u7edf\u8ba1\u5373\u53ef\u3002\n\nAC \u4ee3\u7801\uff08Golang\uff09:\n\n```go\npackage main\n\nimport (\n\t\"bufio\"\n\t. \"fmt\"\n\t\"os\"\n)\n\nfunc main() {\n\tin := bufio.NewReader(os.Stdin)\n\tout := bufio.NewWriter(os.Stdout)\n\tdefer out.Flush()\n\n\tconst mx int = 1e6\n\tlpf := [mx + 1]int{1: 1}\n\tfor i := 2; i <= mx; i++ {\n\t\tif lpf[i] == 0 {\n\t\t\tfor j := i; j <= mx; j += i {\n\t\t\t\tif lpf[j] == 0 {\n\t\t\t\t\tlpf[j] = i\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tcore := func(x int) int {\n\t\tc := 1\n\t\tfor x > 1 {\n\t\t\tp := lpf[x]\n\t\t\te := 1\n\t\t\tfor x /= p; lpf[x] == p; x /= p {\n\t\t\t\te ^= 1\n\t\t\t}\n\t\t\tif e > 0 {\n\t\t\t\tc *= p\n\t\t\t}\n\t\t}\n\t\treturn c\n\t}\n\n\tvar T, n, v, q int\n\tvar w int64\n\tfor Fscan(in, &T); T > 0; T-- {\n\t\tcnt := map[int]int{}\n\t\tfor Fscan(in, &n); n > 0; n-- {\n\t\t\tFscan(in, &v)\n\t\t\tcnt[core(v)]++\n\t\t}\n\t\tmaxC, c1 := 0, cnt[1]\n\t\tfor v, c := range cnt {\n\t\t\tmaxC = max(maxC, c)\n\t\t\tif v > 1 && c&1 == 0 {\n\t\t\t\tc1 += c\n\t\t\t}\n\t\t}\n\t\tfor Fscan(in, &q); q > 0; q-- {\n\t\t\tif Fscan(in, &w); w == 0 {\n\t\t\t\tFprintln(out, maxC)\n\t\t\t} else {\n\t\t\t\tFprintln(out, max(maxC, c1))\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunc max(a, b int) int {\n\tif a > b {\n\t\treturn a\n\t}\n\treturn b\n}\n```\n\n\n",
        "postTime": 1609917072,
        "uid": 266651,
        "name": "\u7075\u8336\u5c71\u827e\u5e9c",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1470B \u3010Strange Definition\u3011"
    },
    {
        "content": "\u8003\u8651\u4e24\u4e2a\u6570\u4ec0\u4e48\u65f6\u5019\u80fd\u6ee1\u8db3\u9898\u8ff0\u6761\u4ef6\u3002\u8bbe $x=p_1^{a_1}p_2^{a_2}...p_k^{a_k},y=p_1^{b_1}p_2^{b_2}...p_{k'}^{b_{k'}}$\n\n\u8bbe\u5b83\u4eec\u8d28\u56e0\u5b50\u7684\u5e76\u96c6\u4e3a $P$\uff0c\u90a3\u4e48 LCM \u5c31\u662f $\\prod_{p_i\\in P}p_i^{\\max(a_i,b_i)}$\uff0cGCD \u5c31\u662f $\\prod_{p_i\\in P}p_i^{\\min(a_i,b_i)}$\u3002\n\n\u6545 $\\frac{LCM}{GCD}=\\prod_{p_i\\in P}p_i^{{\\max(a_i,b_i)}-{\\min(a_i,b_i)}}$\n\n\u8981\u60f3\u662f\u5b8c\u5168\u5e73\u65b9\u6570\uff0c\u53ea\u8981\u6bcf\u5bf9 $(a_i,b_i)$ \u7684\u5dee\u662f\u5076\u6570\u5c31\u884c\u4e86\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u82e5\u4e24\u4e2a\u6570\u6ee1\u8db3\u6761\u4ef6\uff0c\u5219\u5b83\u4eec\u5206\u89e3\u51fa\u6765\u7684\u6bcf\u4e2a\u6307\u6570**\u5bf9 2 \u53d6\u4f59**\u4e4b\u540e\u7684\u7ed3\u679c\u662f\u4e00\u6837\u7684\u3002\n\n\u4e8e\u662f\u6211\u4eec**\u628a\u6bcf\u4e2a\u6570\u90fd\u5206\u89e3\uff0c\u7136\u540e\u628a\u6307\u6570\u5bf9 2 \u53d6\u4f59\uff0c\u5f97\u5230\u65b0\u7684\u6570**\u3002\u90a3\u4e48\u8fd9\u4e2a\u65f6\u5019\uff0c\u76f8\u7b49\u7684\u6570\u5c31\u8bf4\u660e\u5b83\u4eec\u7684\u539f\u6570\u4e4b\u95f4\u662f\u6ee1\u8db3\u6761\u4ef6\u7684\uff0c\u6240\u4ee5 $w=0$ \u7684\u60c5\u51b5\u53ea\u9700\u8981\u627e\u51fa**\u54ea\u4e2a\u76f8\u7b49\u6570\u96c6\u5408\u6700\u5927**\u3002\n\n$w\\leq 10^{18}$\uff0c\u600e\u4e48\u89e3\u51b3\uff1f\u770b\u5230\u8fd9\u4e2a\u5c31\u60f3\u5230\u5fc5\u5b9a\u6709\u4e2a\u7ed3\u8bba\u4f7f\u5f97 $w$ \u8fc7\u5927\u65f6\u4e00\u5b9a\u662f\u67d0\u4e2a\u7b54\u6848\u3002\u6211\u4eec\u53d1\u73b0\uff0c\u5f53\u76f8\u7b49\u96c6\u5408\u5408\u5e76\u7684\u65f6\u5019\uff08\u4e5f\u5c31\u662f\u90fd\u53d8\u6210\u8fd9\u4e2a\u96c6\u5408\u7684\u4e58\u79ef\uff09\uff0c\u53ea\u6709\u4e24\u79cd\u60c5\u51b5\uff0c\u5408\u5e76\u6210 1\uff0c\u6216\u8005\u4e0d\u53d8\uff08\u5728\u53d6\u4f59\u4e4b\u540e\uff09\u3002\n\n\u8bc1\u660e\uff1a\n\n\u663e\u7136**\u539f\u96c6\u5408\u6570\u4e4b\u79ef**\u8fdb\u884c\u6307\u6570\u5bf9 2 \u53d6\u4f59\u4e4b\u540e\u7684\u7ed3\u679c\u548c**\u5df2\u7ecf\u53d6\u4f59\u8fc7\u7684\u6570\uff08\u8fd9\u4e9b\u6570\u5df2\u7ecf\u76f8\u7b49\uff09\u7684\u4e58\u79ef**\u8fdb\u884c\u6307\u6570\u5bf9 2 \u53d6\u4f59\u662f\u7b49\u4ef7\u7684\u3002\u8bbe\u8fd9\u4e9b\u76f8\u7b49\u7684\u6570\u90fd\u4e3a $p_1p_2p_3...p_k$\uff08\u6307\u6570\u4e3a0\u65e0\u5f71\u54cd\uff0c\u5ffd\u7565\uff09\uff0c\u603b\u5171\u6709 $q$ \u4e2a\u8fd9\u79cd\u6570\u3002\u90a3\u4e48\u663e\u7136 $q$ \u662f\u5947\u6570\u65f6\u4e0d\u53d8\uff0c$q$ \u662f\u5076\u6570\u65f6\u53d8\u6210\u5b8c\u5168\u5e73\u65b9\u6570\uff0c\u53d6\u4f59\u4e4b\u540e\u6240\u6709\u6307\u6570\u4e3a 0\uff0c\u4e58\u79ef\u4e3a 1\u3002\n\n\u90a3\u4e48 $w=1$ \u65f6\u5c31\u662f\u90e8\u5206\u96c6\u5408\u4e0d\u53d8\uff0c\u90e8\u5206\u96c6\u5408\u5168\u90e8\u53d8\u6210 1\u3002\u800c\u4e4b\u540e\u5c31\u4e0d\u4f1a\u53d8\u5316\u3002\uff08\u663e\u7136\uff0c\u4e3a 1 \u7684\u4e0d\u53d8\uff0c\u5148\u524d\u7684\u4e0d\u53d8\u96c6\u5408\u80af\u5b9a\u4e0d\u53d8\uff09\u3002\n\n\u6240\u4ee5\u672c\u9898\u5c31\u8f6c\u5316\u6210\u4e86 $w=0$ \u548c $w>0$ \u7684\u60c5\u51b5\u3002\n\n~~\u5176\u5b9e\u6bd4\u8d5b\u7684\u65f6\u5019\u968f\u4fbf\u731c\u731c\u8fd9\u4e2a\u7ed3\u8bba\u5c31\u884c\u4e86~~\n\ncode\uff1a\n```cpp\n#include\"bits/stdc++.h\"\nusing namespace std;\n#define N 300010\n#define ri register int\n#define ll long long\ninline ll rd(){\n    ll x=0,flg=1;\n    char ch=getchar();\n    while(!isdigit(ch)) {if(ch=='-') flg=-1;ch=getchar();}\n    while(isdigit(ch)) {x=x*10+(ch^48);ch=getchar();}\n    return x*flg;\n}\nint t,n,a[N],q,tmp,cnt,fir,sec,pre;\nll w;\nint main(){\n    t=rd();\n    while(t--){\n        n=rd();\n        for(ri i=1;i<=n;++i){\n            a[i]=rd();tmp=a[i];\n            for(ri j=2;j*j<=tmp;++j){\n                if(tmp%j==0){\n                    cnt=0;\n                    while(tmp%j==0) tmp/=j,a[i]/=j,cnt++;\n                    if(cnt&1) a[i]*=j;\n                }\n            }\n        }\n        \n        fir=0,sec=0,pre=0;\n        sort(a+1,a+1+n);a[n+1]=0;\n        for(ri i=1;i<=n;++i){\n            if(a[i]!=a[i+1]) {fir=max(fir,i-pre);if(a[i]==1) sec+=i-pre;else if(((i-pre)&1)^1) sec+=i-pre;pre=i;} //\u5224\u65ad\u4e00\u4e0b\uff0c\u957f\u5ea6\u4e3a\u5947\u6570\u5c31\u8bb0\u5165 w>0 \u7684\u7b54\u6848\n        }\n        q=rd();sec=max(sec,fir);\n        while(q--) {w=rd();if(w) printf(\"%d\\n\",sec);else printf(\"%d\\n\",fir);} \n    }\n    return 0;\n}\n```\n",
        "postTime": 1609923216,
        "uid": 135839,
        "name": "Fairicle",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF1470B \u3010Strange Definition\u3011"
    },
    {
        "content": "[$\\text{\u4e0d\u4e00\u6837\u7684\u9605\u8bfb\u4f53\u9a8c}$](https://www.cnblogs.com/do-while-true/p/14242801.html)\n\n# $\\mathcal{Translate}$\n\n\u6ce8: \"$x,y$ adjacent\" \u8bd1\u4f5c \"$x,y$ \u76f8\u90bb\"\n\n\u5b9a\u4e49 $x,y$ \u76f8\u90bb\u9700\u8981\u6ee1\u8db3 $\\frac{lcm(x,y)}{gcd(x,y)}$ \u662f\u5b8c\u5168\u5e73\u65b9\u6570\u3002\n\n\u5171\u6709 $t$ \u7ec4\u6570\u636e\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u79cd\u6570\u636e\uff0c\u7ed9\u5b9a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217 $a_i$\uff0c\u4ece\u7b2c $1$ \u79d2 $a$ \u5f00\u59cb\u53d8\u6362\uff0c\u6bcf\u4e00\u6b21 $a_i$ \u53d8\u6210\u6240\u6709\u4e0e\u5b83\u76f8\u90bb\u7684\u6570\u7684\u4e58\u79ef\uff08\u5305\u62ec\u5b83\u81ea\u5df1\uff09\u3002\n\n\u5b9a\u4e49 $d_i$ \u4e3a $a$ \u4e2d\u4e0e $a_i$ \u76f8\u90bb\u7684\u6570\u7684\u4e2a\u6570\u3002\n\n\u5171\u6709 $q$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u7ed9\u51fa\u4e00\u4e2a $w$\uff0c\u56de\u7b54\u7b2c $w$ \u79d2\u65f6\uff08\u4e5f\u5c31\u662f\u7ecf\u8fc7 $w$ \u6b21\u53d8\u6362\u540e\uff09\u7684 $\\max d_i$\u3002\n\n# $\\mathcal{Solution}$\n\n$\\frac{lcm(x,y)}{gcd(x,y)}=\\frac{x\\times y}{gcd(x,y)^2}$\n\n$\\because gcd(x,y)^2$ \u662f\u5b8c\u5168\u5e73\u65b9\u6570\u3002\n\n$\\therefore \\frac{x\\times y}{gcd(x,y)^2}$ \u662f\u5b8c\u5168\u5e73\u65b9\u6570\u7b49\u4ef7\u4e8e $x\\times y$ \u662f\u5b8c\u5168\u5e73\u65b9\u6570\u3002\n\n\u82e5 $x\\times y$ \u662f\u5b8c\u5168\u5e73\u65b9\u6570\u3002\n\n$\\therefore x\\times y$ \u8d28\u56e0\u6570\u5206\u89e3\u540e\u6bcf\u4e2a\u5e95\u6570\u7684\u6307\u6570\u90fd\u662f\u5076\u6570\u3002\n\n$\\therefore x,y$ \u5206\u522b\u8d28\u56e0\u6570\u5206\u89e3\u4e4b\u540e\u5404\u4e2a\u5e95\u6570\u7684\u6307\u6570\u5947\u5076\u6027\u76f8\u540c\u3002\n\n\u5230\u8fd9\u91cc\u663e\u7136\u53ef\u4ee5\u5f97\u51fa\u76f8\u90bb\u662f\u5177\u6709\u4f20\u9012\u6027\u7684\u3002\n\n\u8003\u8651\u628a\u6bcf\u4e2a\u4e32\u8d28\u56e0\u6570\u5206\u89e3\u540e\u51fa\u7684\u6307\u6570\u6a21 $2$ \u770b\u6210\u4e00\u4e2a $01$ \u4e32\uff0c\u82e5 $01$ \u4e32\u76f8\u7b49\u5219\u8fd9\u4e24\u4e2a\u6570\u662f\u76f8\u90bb\u7684\u3002\n\n\u82e5\u591a\u4e2a\u6570\u76f8\u4e58\uff0c\u6700\u540e\u7684\u4e58\u79ef\u7684 $01$ \u4e32\u4e3a\u6240\u6709\u56e0\u6570\u7684 $01$ \u4e32\u7684\u5f02\u6216\u540e\u7ed3\u679c\uff08\u770b\u6210\u6bcf\u4e2a\u8d28\u56e0\u5b50\u5206\u522b\u76f8\u4e58\u5373\u53ef\u8bf4\u660e\u6b64\u70b9\uff09\u3002\n\n\u90a3\u4e48\u8003\u8651\u5bf9\u76f8\u540c\u7684 $01$ \u4e32\u770b\u6210\u4e00\u4e2a\u96c6\u5408\uff0c\u8003\u8651\u4e00\u6b21\u53d8\u6362\uff0c\u82e5 $01$ \u4e32\u4e3a\u5168 $0$ \u6216\u96c6\u5408\u5927\u5c0f\u4e3a\u5947\u6570\u5219\u8fd9\u4e9b $01$ \u4e32\u4e0d\u53d8\uff0c\u5426\u5219\u8fd9\u4e9b $01$ \u4e32\u90fd\u53d8\u6210 $0$\u3002\n\n\u90a3\u4e48\u663e\u7136\u53ea\u6709\u7b2c\u4e00\u6b21\u53d8\u6362\u662f\u6709\u7528\u7684\uff0c\u8fd9\u4f1a\u4f7f\u6240\u6709\u96c6\u5408\u5927\u5c0f\u4e3a\u5076\u6570\u7684 $01$ \u4e32\u53d8\u6210\u5168 $0$\u3002\n\n\u5206\u522b\u7edf\u8ba1\u7b2c $0$ \u79d2\u548c\u7b2c $1$ \u79d2\u65f6\u7684\u7b54\u6848\u5373\u53ef\uff0c\u540e\u9762\u7684\u7b54\u6848\u548c\u7b2c $1$ \u79d2\u76f8\u540c\u3002\n\n\u628a $01$ \u4e32\u4e3a $1$ \u7684\u4f4d\u7f6e\u62ff\u4e0b\u6765\u54c8\u5e0c\u653e\u5728\u4e00\u4e2a $map$ \u91cc\u9762\u5c31\u80fd\u505a\u4e86\u3002\n\n\u4e00\u7ec4\u6570\u636e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}(n\\log n+n\\sqrt{\\max a_i})$\n\n# $\\mathcal{Code}$\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<queue>\n#include<algorithm>\n#include<map>\n#define pb push_back\n#define pp std::pair<unsigned long long, unsigned long long> \n#define mp std::make_pair\n#define fir first\n#define sec second\n#define ll long long\n#define re register\n#define ull unsigned long long\n//#define int long long\ninline int Max(int x, int y) { return x > y ? x : y; }\ninline int Min(int x, int y) { return x < y ? x : y; }\ninline int Abs(int x) { return x < 0 ? ~x + 1 : x; }\ninline int read() {\n\tint r = 0; bool w = 0; char ch = getchar();\n\twhile(ch < '0' || ch > '9') {\n\t\tif(ch == '-') w = 1;\n\t\tch = getchar();\n\t}\n\twhile(ch >= '0' && ch <= '9') {\n\t\tr = (r << 3) + (r << 1) + (ch ^ 48);\n\t\tch = getchar();\n\t}\n\treturn w ? ~r + 1 : r;\n}\n//#undef int\nconst int N = 300010;\nconst ull base = 21841;\nconst ull mod = 29050993; \nconst ull base2 = 1429;\nconst ull mod2 = 68861641;\nint n, a[N], ans1, ans2;\npp hs[N];\nstd::map<pp, int>vis;\n\npp hasher(int x) {\n\tstd::vector<int>vec; int xx = x;\n\tfor(int i = 2; i * i <= xx; ++i)\n\t\tif(x % i == 0) {\n\t\t\tint ct = 0;\n\t\t\twhile(x % i == 0) x /= i, ++ct;\n\t\t\tif(ct&1) vec.pb(i); \n\t\t}\n\tif(x > 1) vec.pb(x);\n\tull sum1 = 0, sum2 = 0;\n\tstd::sort(vec.begin(), vec.end());\n\tint len = vec.size(); \n\tfor(int i = 0; i < len; ++i) sum1 = (sum1 * base % mod + (ull)vec[i]) % mod;\n\tfor(int i = 0; i < len; ++i) sum2 = (sum2 * base2 % mod2 + (ull)vec[i]) % mod2;\n\treturn mp(sum1, sum2);\n}\n\nvoid solve() {\n\tn = read(); vis.clear(); ans1 = ans2 = 0;\n\tfor(int i = 1; i <= n; ++i) a[i] = read();\n\tfor(int i = 1; i <= n; ++i) hs[i] = hasher(a[i]), vis[hs[i]]++, ans1 = Max(ans1, vis[hs[i]]);\n\tfor(int i = 1; i <= n; ++i) if(vis[hs[i]] % 2 == 0 || hs[i].fir + hs[i].sec == 0) ans2 += vis[hs[i]], vis[hs[i]] = 0;\n\tans2 = Max(ans1, ans2);\n\tint q = read();\n\tll x;\n\twhile(q--) {\n\t\tscanf(\"%lld\", &x);\n\t\tif(x == 0) printf(\"%d\\n\", ans1);\n\t\telse printf(\"%d\\n\", ans2);\n\t}\n}\n\nsigned main() {\n\tint T = read();\n\twhile(T--) solve(); \n\treturn 0;\n}\n```",
        "postTime": 1609929180,
        "uid": 223298,
        "name": "do_while_true",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1470B \u3010Strange Definition\u3011"
    },
    {
        "content": "# CF1471D - Strange Definition\n- \u6570\u8bba\u3001\u8d28\u56e0\u6570\u3001\u54c8\u5e0c\n- https://www.luogu.com.cn/problem/CF1470B\n\n## \u9898\u610f\n\u4e24\u4e2a\u6574\u6570 $x$ \u548c $y$ \u662f*\u6709\u5173\u7684*\u5f53\u4e14\u4ec5\u5f53 $\\frac{\\operatorname{lcm}(x,y)}{\\gcd(x,y)}$ \u662f\u5b8c\u5168\u5e73\u65b9\u6570\u3002\n\n\u4f60\u6709\u4e00\u4e2a\u957f\u5ea6\u4e3a $n(n\\leq 3\\cdot 10^5)$ \u7684\u5e8f\u5217 $a(1\\leq a_i\\leq 10^6)$\u3002\u6bcf\u4e00\u79d2\uff0c\u6240\u6709\u7684 $a_i$ \u90fd\u4f1a\u53d8\u6210\u5e8f\u5217\u4e2d\u6240\u6709\u548c\u5b83*\u6709\u5173\u7684*\u6570\u7684\u4e58\u79ef\u3002\u4ee4 $d_i$ \u4e3a\u6570\u5217\u4e2d\u4e0e $a_i$ *\u6709\u5173\u7684*\u6570\u7684\u4e2a\u6570\n\n\u6709 $q$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u7ed9\u51fa\u4e00\u4e2a $w(0\\leq w\\leq 10^{18})$\uff0c\u6c42\u5728 $w$ \u79d2\u65f6\u7684 $\\max\\{d_i\\}$\u3002\n\n## \u601d\u8def\n$$\n    \\frac{\\operatorname{lcm}(x,y)}{\\gcd(x,y)}=\\frac{x\\cdot y}{\\gcd^2(x,y)}=k^2\n$$\n\n$$\n    xy=\\big( k\\cdot \\gcd(x,y)\\big )^2\n$$\n\n\u56e0\u6b64\uff0c$\\frac{\\operatorname{lcm}(x,y)}{\\gcd(x,y)}$ \u662f\u5b8c\u5168\u5e73\u65b9\u6570 $\\Leftrightarrow x\\cdot y$ \u662f\u5b8c\u5168\u5e73\u65b9\u6570\u3002\n\n$x\\cdot y$ \u662f\u5b8c\u5168\u5e73\u65b9\u6570\uff0c\u8bf4\u660e\u5bf9 $x\\cdot y$ \u5206\u89e3\u6210\u82e5\u5e72\u4e2a\u8d28\u56e0\u6570\u76f8\u4e58\u7684\u5f62\u5f0f\u540e\uff0c\u6bcf\u4e00\u79cd\u8d28\u56e0\u6570\u7684\u6307\u6570\u90fd\u662f\u5076\u6570\u3002\n\n\u5047\u8bbe\uff1a\n$$x=p_1^{k_1}\\cdot p_2^{k_2} \\cdot p_3^{k_3}\\dots p_n^{k_n}$$\n$$y=p_1^{k_1'}\\cdot p_2^{k_2'} \\cdot p_3^{k_3'}\\dots p_n^{k_n'}$$\n\n\u90a3\u4e48\uff0c$k_i$ \u4e0e $k_i'$ \u7684\u5947\u5076\u6027\u76f8\u540c\u3002\n\n### \u8ba1\u7b97\u7b2c $0$ \u79d2\u65f6\u7684\u7b54\u6848\n\u5bf9\u6bcf\u4e2a $a_i$ \u5206\u89e3\u8d28\u56e0\u6570\uff0c\u6311\u51fa\u5206\u89e3\u7684\u8d28\u56e0\u6570\u4e2d\u6307\u6570\u4e3a\u5947\u6570\u7684\u8ba1\u7b97\u54c8\u5e0c\uff0c\u5728\u6240\u6709 $a_i$ \u4e2d\u54c8\u5e0c\u76f8\u540c\u7684\u5c31\u662f\u6709\u5173\u7684\u3002\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u5982\u679c $a_i$ \u548c $a_j$ \u6709\u5173\uff0c\u5e76\u4e14 $a_j$ \u548c $a_k$ \u6709\u5173\uff0c\u90a3\u4e48 $a_i$ \u548c $a_k$ \u6709\u5173\u3002\n\n\u5b9e\u9645\u4e0a\uff0c\u5f62\u6210\u7684\u662f\u8fde\u901a\u5757\uff0c\u540c\u4e00\u4e2a\u8fde\u901a\u5757\u91cc\u7684\u5143\u7d20\u4e24\u4e24\u6709\u5173\u3002\n\n### \u7b2c $1$ \u79d2\u4ee5\u53ca\u7b2c $1$ \u79d2\u8fc7\u540e\n\u4ece\u7b2c $1$ \u79d2\u5f00\u59cb\uff0c\u6bcf\u4e00\u79d2\uff0c$a_i$ \u90fd\u4f1a\u53d8\u6210\u5e8f\u5217\u4e2d\u6240\u6709\u548c\u5b83*\u6709\u5173\u7684*\u6570\u7684\u4e58\u79ef\u3002\n\n\u5982\u679c\u7b2c $0$ \u79d2\u65f6\uff1a\n- \u67d0\u4e2a $a_i$ \u7684\u67d0\u4e2a $k_j$ \u662f\u5947\u6570\uff0c\u5e76\u4e14\u5b83\u6240\u5904\u4e8e\u7684\u8fde\u901a\u5757\u5927\u5c0f\u4e3a\u5076\u6570\uff0c\u90a3\u4e48\u7b2c $1$ \u79d2\u65f6\uff0c\u5b83\u6240\u5904\u7684\u8fde\u901a\u5757\u4e2d\u6240\u6709\u7684 $k_j$ \u4f1a\u53d8\u6210\u5076\u6570\uff0c\u5728\u8fd9\u4ee5\u540e\uff0c\u6b64 $k_j$ \u7684\u5947\u5076\u6027\u6c38\u8fdc\u4e0d\u53d8\u3002\n- \u5176\u5b83\u60c5\u51b5\uff0c$k_j$ \u7684\u5947\u5076\u6027\u4e0d\u4f1a\u518d\u53d8\u3002\n\n\u56e0\u6b64\uff0c\u5728\u7b2c $1$ \u79d2\u8fc7\u540e\uff0c\u7b54\u6848\u4e0d\u4f1a\u518d\u6539\u53d8\u3002\n\n\u8ba1\u7b97\u7b2c $0$ \u79d2\u548c \u7b2c $1$ \u79d2\u7684\u7b54\u6848\u540e\uff0c\u56de\u7b54\u8be2\u95ee\u5373\u53ef\u3002\n\n**\u7edf\u8ba1\u7b2c $1$ \u79d2\u7684\u7b54\u6848**\n\n$ans_1 = \\max(ans_0,$ $\\sum$\u6240\u6709\u957f\u5ea6\u4e3a\u5947\u6570\u7684\u8fde\u901a\u5757\u7684\u957f\u5ea6 $+\\sum$ \u6240\u6709$k_i$\u4e3a\u5076\u6570\u7684\u8fde\u901a\u5757\u957f\u5ea6  $)$",
        "postTime": 1681011064,
        "uid": 36285,
        "name": "\u6c27\u5c11Kevin",
        "ccfLevel": 4,
        "title": "CF1471D-Strange Definition-\u6570\u8bba,\u8d28\u56e0\u6570,\u54c8\u5e0c"
    },
    {
        "content": "\u601d\u7ef4\u9898\u3002\n\n\u770b\u5230 gcd \u548c lcm \u9996\u5148\u60f3\u5230\u5206\u89e3\u8d28\u56e0\u6570\u3002\u4ee4 $a=\\prod_{i=1}^{\\infty}p_{i}^{e_{i}},b=\\prod_{i=1}^{\\infin}p_{i}^{e'_{i}}$\uff08$p_{i}$ \u4e3a\u7b2c $i$ \u4e2a\u8d28\u6570\uff09\u3002\u5219 $lcm(a,b)=\\prod_{i=1}^{\\infin}p_{i}^{\\max(e_{i},e'_{i})},\\gcd(a,b)=\\prod_{i=1}^{\\infin}p_{i}^{\\min(e_{i},e'_{i})}$\u3002\u4ee4 $t=\\frac{lcm(a,b)}{gcd(a,b)}$\uff0c\u5219$t=\\prod_{i=1}^{\\infin}p_{i}^{\\max(e_{i},e'_{i})-\\min(e_{i},e'_{i})}$\u3002\u56e0\u6b64 $t$ \u4e3a\u5b8c\u5168\u5e73\u65b9\u6570\u5f53\u4e14\u4ec5\u5f53 $\\forall i\\in \\mathbb{N^{+}},2|(\\max(e_{i},e'_{i})-\\min(e_{i},e'_{i}))$\u3002\u4e5f\u5c31\u662f $e_{i}$ \u4e0e $e'_{i}$ \u5947\u5076\u6027\u76f8\u540c\u3002\u56e0\u6b64 $a$ \u548c $b$ \u662f\u5426\u76f8\u90bb\u5c31\u53ea\u4e0e $e_{i}$ \u548c $e'_{i}$ \u7684\u5947\u5076\u6027\u6709\u5173\u4e86\uff0c\u6211\u4eec\u628a\u5947\u6570\u770b\u505a $1$\uff0c\u5076\u6570\u770b\u505a $0$\uff0c\u6bcf\u4e2a\u6570\u5c31\u53ef\u4ee5\u7528\u4e00\u4e2a $01$ \u4e32\u6765\u8868\u793a\uff0c\u800c\u4e24\u4e2a\u6570\u76f8\u90bb\u5f53\u4e14\u4ec5\u5f53\u5b83\u4eec\u7684 $01$ \u4e32\u76f8\u540c\u3002\n\n\u8fd9\u4e5f\u5c31\u662f\u8bf4\uff0c\u6bcf\u6b21\u53d8\u5316\u90fd\u4f1a\u5c06\u6570\u7ec4\u4e2d\u6240\u6709 $01$ \u4e32\u76f8\u540c\u7684\u5143\u7d20\u5408\u5e76\u5728\u4e00\u8d77\uff08\u5176\u5b9e\u5c31\u662f\u628a\u8fd9\u4e9b $01$ \u4e32\u52a0\u8d77\u6765\uff09\u3002\u5982\u679c\u53c2\u4e0e\u5408\u5e76\u7684\u5143\u7d20\u4e2a\u6570\u4e3a\u5076\uff0c\u90a3\u4e48\u5408\u5e76\u8fc7\u540e\u6bcf\u4e2a $e_{i}$ \u90fd\u4f1a\u53d8\u4e3a $0$\uff0c\u5373\u4e00\u4e2a\u5168 $0$ \u4e32\u3002\u5982\u679c\u53c2\u4e0e\u5408\u5e76\u7684\u5143\u7d20\u4e2a\u6570\u4e3a\u5947\uff0c\u90a3\u4e48\u5408\u5e76\u4e4b\u540e\u6bcf\u4e2a\u5143\u7d20\u7684 $01$ \u4e32\u5e76\u4e0d\u4f1a\u53d1\u751f\u6539\u53d8\u3002\u8fd9\u610f\u5473\u7740\u6570\u7ec4\u5728\u53d8\u5316\u8fc7\u4e00\u6b21\u540e\uff0c\u51fa\u73b0\u7684\u5168 $0$ \u4e32\u4ece\u6b64\u59cb\u7ec8\u662f\u5168 $0$ \u4e32\uff0c\u975e\u5168 $0$ \u4e32\u4ece\u6b64\u4e5f\u4e0d\u4f1a\u518d\u53d1\u751f\u6539\u53d8\uff0c\u6240\u4ee5\u7b54\u6848\u6700\u591a\u53ea\u6709\u4e24\u79cd\uff1a $w=0$ \u65f6\uff0c\u548c $w=1$ \u65f6\uff0c\u76f4\u63a5\u5957\u54c8\u5e0c\u6a21\u62df\u5c31\u884c\uff0c\u7531\u4e8e  $01$ \u4e32\u7684\u54c8\u5e0c\u503c\u53ea\u4e0e $1$ \u7684\u4f4d\u7f6e\u6709\u5173\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u628a\u6240\u6709 $1$ \u7684\u4f4d\u7f6e\u62ce\u51fa\u6765\u505a\u54c8\u5e0c\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\log n+n\\sqrt {\\max a_{i})}$\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#define mod1 998244353\n#define mod2 19260817\n#define base1 19260813\n#define base2 300007\n#define ll long long\n#define fo(i,x,y) for(register int i=x;i<=y;++i)\n#define go(i,x,y) for(register int i=x;i>=y;--i)\nusing namespace std;\n\ninline int read(){\n\tint x=0,fh=1;\n\tchar ch=getchar();\n\twhile(!isdigit(ch)){\n\t\tif(ch=='-') fh=-1;\n\t\tch=getchar();\n\t}\n\twhile(isdigit(ch)){\n\t\tx=(x<<1)+(x<<3)+ch-'0';\n\t\tch=getchar();\n\t}\n\treturn x*fh;\n}\n\nconst int N=1e6+5;\nint np[N],p[N],top,rk[N];\n\nvoid xxs(){\n\tfo(i,2,N-1){\n\t\tif(!np[i]) p[++top]=i,rk[i]=top;\n\t\tfo(j,1,top){\n\t\t\tint t=i*p[j];\n\t\t\tif(t>=N) break;\n\t\t\tnp[t]=1;\n\t\t\tif(i%p[j]==0) break;\n\t\t}\n\t}\n}\n\nint a[N];\n\nstruct Ha{\n\tint v1,v2;\n\tbool operator<(const Ha &x){\n\t\tif(v1!=x.v1) return v1<x.v1;\n\t\treturn v2<x.v2;\n\t}\n\tbool operator==(const Ha &x){return v1==x.v1&&v2==x.v2;} \n}hx[N];\n\nvoid work(){\n\tint n=read();\n\tfo(i,1,n) a[i]=read();\n\tfo(i,1,n){\n\t\thx[i].v1=hx[i].v2=0;\n\t\tint t=a[i];\n\t\t//printf(\"%d:\\n\",t);\n\t\tfo(j,1,top){\n\t\t\tif(p[j]*p[j]>t) break;\n\t\t\tbool cnt=0;\n\t\t\twhile(t%p[j]==0){\n\t\t\t\tt/=p[j];\n\t\t\t\tcnt^=1;\n\t\t\t}\n\t\t\t//printf(\"%d %d\\n\",p[j],cnt);\n\t\t\tif(cnt) hx[i].v1=(1ll*hx[i].v1*base1+j)%mod1,hx[i].v2=(1ll*hx[i].v2*base2+j)%mod2;\n\t\t}\n\t\tif(t>1) hx[i].v1=(1ll*hx[i].v1*base1+rk[t])%mod1,hx[i].v2=(1ll*hx[i].v2*base2+rk[t])%mod2;\n\t\t//printf(\"v1=%d v2=%d\\n\",hx[i].v1,hx[i].v2);\n\t}\n\tsort(hx+1,hx+1+n);\n\tint ans0=0,ans1=0,cnt=0;\n\tfo(i,1,n){\n\t\tint pos=i;\n\t\twhile(pos<=n&&hx[pos]==hx[i]) ++pos;\n\t\tint len=pos-i;\n\t\t//printf(\"%d:%d %d %d %d\\n\",i,hx[i].v1,hx[i].v2,pos,len);\n\t\tans0=max(ans0,len);\n\t\tans1=max(ans1,len);\n\t\tif(len%2==0||hx[i].v1+hx[i].v2==0) cnt+=len;\n\t\ti=pos-1;\n\t}\n\tans1=max(ans1,cnt);\n\tint q=read();\n\twhile(q--){\n\t\tll w;\n\t\tscanf(\"%lld\",&w);\n\t\tif(w==0) printf(\"%d\\n\",ans0);\n\t\telse printf(\"%d\\n\",ans1);\n\t}\n\t//puts(\"\");\n}\n\nint main(){\n\txxs();\n\tint T=read();\n\twhile(T--){\n\t\twork();\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1609906292,
        "uid": 238408,
        "name": "vectorwyx",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1470B \u3010Strange Definition\u3011"
    }
]
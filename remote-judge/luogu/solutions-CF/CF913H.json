[
    {
        "content": "\u7ed9\u5b9a $n$ \u4e2a\u5b9e\u6570 $x_i$\uff0c\u8bbe $t_i$ \u662f $[0,1]$ \u4e4b\u95f4\u7684\u968f\u673a\u5b9e\u6570\uff0c\u6c42 $\\forall i\\in[1,n]$\uff0c$\\sum_{j=1}^it_j\\le x_i$ \u7684\u6982\u7387$\\bmod 998244353$\u3002\n\n$n\\le 30$\uff0c$0<x_i\\le n$\uff0c$10^6x_i\\in\\mathbb N$\u3002\n\n---\n\n\u6570\u636e\u8303\u56f4\u5f88\u5c0f\uff0c\u8003\u8651\u66b4\u529b\u7ef4\u62a4\u7d2f\u79ef\u5206\u5e03\u51fd\u6570 (CDF)\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u5b83\u662f\u5206\u6bb5\u51fd\u6570\uff0c\u6bcf\u4e00\u6bb5\u662f\u4e0d\u8d85\u8fc7 $n$ \u6b21\u7684\u591a\u9879\u5f0f\uff08\u8bc1\u660e\u5c31\u662f\u8f6c\u79fb\u8fc7\u7a0b~~\u8fd9\u91cc\u5148\u731c\u4e00\u4e0b~~\uff09\n\n\u65ad\u70b9\u53ea\u53ef\u80fd\u662f $\\{x_i\\}+j$\uff0c\u5176\u4e2d $j=0,1,\\cdots,n-1$\uff0c\u4e8e\u662f\u4e8b\u5148\u5c31\u5206\u6bb5\u597d\uff0c\u6bcf\u6b21\u5bf9\u6bcf\u4e00\u5c0f\u6bb5\u5206\u522b\u8ba1\u7b97\u662f\u6bd4\u8f83\u65b9\u4fbf\u7684\u3002\n\n\u518d\u8003\u8651\u8f6c\u79fb\uff0c\u5206\u6574\u5757\u548c\u6563\u5757\u8ba1\u7b97\u3002\u6574\u5757\u7684\u6982\u7387\u662f\u5e38\u6570\uff0c\u53ef\u4ee5\u76f4\u63a5\u52a0\u8d77\u6765\u8d21\u732e\u5230\u5e38\u6570\u9879\uff0c\u6563\u5757\u53ea\u9700\u628a\u5bf9\u5e94\u7684 CDF \u76f8\u51cf\uff0c\u5f97\u5230\u7684\u5c31\u662f\u6982\u7387\u5bc6\u5ea6\u51fd\u6570 (PDF)\uff0c\u79ef\u5206\u4e00\u4e0b\u5c31\u5f97\u5230 CDF\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^4)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define PB emplace_back\n#define all(x) x.begin(), x.end()\nusing namespace std;\ntypedef long long LL;\nconst int N = 31, mod = 998244353, B = 1e6, IB = 616898040;\ntemplate<typename T>\nbool chmin(T &a, const T &b){if(a > b) return a = b, 1; return 0;}\nvoid qmo(int &x){x += x >> 31 & mod;}\nint n, m, a[N], inv[N], val[N*N], len[N*N], sum[N*N], coe[N*N][N], ans;\nvector<int> cut; double x;\nint id(int x){return lower_bound(val, val+n*m+1, x) - val;}\nint main(){\n\tscanf(\"%d\", &n); inv[1] = 1;\n\tfor(int i = 2;i <= n;++ i) inv[i] = mod - (LL)mod / i * inv[mod % i] % mod;\n\tfor(int i = 0;i < n;++ i){\n\t\tscanf(\"%lf\", &x);\n\t\ta[i] = (int)(x * B + 0.5);\n\t\tchmin(a[i], (i+1)*B);\n\t\tcut.PB(a[i] % B);\n\t} cut.PB(0); sort(all(cut)); cut.erase(unique(all(cut)), cut.end());\n\tm = cut.size();\n\tfor(int i = n*m;~i;-- i) val[i] = i/m*B+cut[i%m];\n\tfor(int i = n*m-1;~i;-- i) len[i] = ((LL)val[i+1] - val[i]) * IB % mod;\n\tfor(int i = id(a[0])-1;~i;-- i){sum[i] = len[i]; coe[i][1] = 1;}\n\tfor(int i = 1;i < n;++ i){\n\t\tint _ = id(a[i]);\n\t\tfor(int j = _;j < (i+1)*m;++ j){memset(coe[j], 0, n+1<<2); sum[j] = 0;}\n\t\tfor(int j = _-1;~j;-- j){\n\t\t\tfor(int k = j-1;~k && k >= j-m;-- k) qmo(coe[j][0] += sum[k] - mod);\n\t\t\tif(j >= m) for(int k = 1;k <= i;++ k) qmo(coe[j][k] -= coe[j-m][k]);\n\t\t\tfor(int k = i+1;k;-- k) coe[j][k] = (LL)coe[j][k-1] * inv[k] % mod;\n\t\t\tcoe[j][0] = sum[j] = 0;\n\t\t\tfor(int k = i+1;~k;-- k) sum[j] = ((LL)sum[j] * len[j] + coe[j][k]) % mod;\n\t\t}\n\t} for(int i = 0;i < n*m;++ i) qmo(ans += sum[i] - mod);\n\tprintf(\"%d\\n\", ans);\n}\n```",
        "postTime": 1620699435,
        "uid": 68148,
        "name": "watermoon",
        "ccfLevel": 10,
        "title": "CF913H \u9898\u89e3"
    }
]
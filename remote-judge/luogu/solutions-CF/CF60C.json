[
    {
        "content": "### \u9898\u76ee\u5927\u610f\n\n\u6709\u4e00\u5f20 $n$ \u4e2a\u70b9 $m$ \u6761\u8fb9\u7684\u56fe\u3002\u73b0\u5728\u5206\u522b\u7ed9\u5b9a\u8fd9 $m$ \u6761\u8fb9\u6240\u8fde\u63a5\u7684\u4e24\u70b9\u7f16\u53f7\uff0c\u4e24\u70b9\u6743\u503c\u7684\u6700\u5927\u516c\u7ea6\u6570\u548c\u6700\u5c0f\u516c\u500d\u6570\u3002\u8bf7\u4f60\u5206\u522b\u6c42\u51fa\u8fd9 $n$ \u4e2a\u70b9\u7684\u6743\u503c\u3002\u4fdd\u8bc1\u6743\u503c\u90fd\u662f\u4e0d\u5927\u4e8e $10^6$ \u7684\u6b63\u6574\u6570\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1 \\le n \\le 100$\uff0c$0 \\le m \\le \\frac{n\\cdot(n-1)}{2}$\uff0c$1 \\le gcd,lcm \\le 10^6$\u3002\n\n------------\n\n### \u89e3\u6cd5\u5206\u6790\n\n\u8bbe $a,b$ \u4e3a\u6b63\u6574\u6570\uff0c\u4e0d\u96be\u63a8\u51fa $b=\\dfrac{\\gcd\\{a,b\\}\\cdot\\operatorname{lcm}\\{a,b\\}}{a}$\u3002\n\n\u90a3\u4e48\u6709\u8fd9\u4e2a\u4e1c\u897f\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5728\u5df2\u77e5\u8fde\u901a\u5757\u5185\u4e00\u4e2a\u70b9\u7684\u6743\u503c\u7684\u6761\u4ef6\u4e0b\u628a\u6574\u4e2a\u8fde\u901a\u5757\u7684\u70b9\u7684\u6743\u503c\u7b97\u51fa\u6765\u4e86\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u56fe\u4e2d\u6bcf\u4e2a\u8fde\u901a\u5757\u4e2d\u4efb\u610f\u4e00\u70b9\u7684\u6743\u503c\uff0c\u7136\u540e\u628a\u6574\u4e2a\u8fde\u901a\u5757\u7684\u70b9\u7684\u6743\u503c\u90fd\u7b97\u51fa\u6765\u770b\u770b\u6709\u6ca1\u6709\u6ee1\u8db3\u6761\u4ef6\u7684\u89e3\uff0c\u5982\u679c\u679a\u51fa\u4e00\u79cd\u89e3\u5c31\u8fdb\u5165\u5230\u4e0b\u4e00\u4e2a\u8fde\u901a\u5757\u7684\u679a\u4e3e\u3002\n\n\u4f46\u662f\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u679c\u679a\u4e3e\u8303\u56f4\u662f $[1,10^6]$ \u7684\u8bdd\uff0c\u7b97\u4e00\u4e0b\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u611f\u89c9\u4e0d\u592a\u7a33\uff08\u4e0d\u8fc7\u4f3c\u4e4e\u80fd\u8fc7\uff09\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u52a0\u4e00\u4e2a\u5c0f\u5c0f\u7684\u4f18\u5316\uff1a\n\n\u8bbe\u4e0e\u7b2c $i$ \u4e2a\u70b9\u76f8\u8fde\u7684\u6709 $d_i$ \u6761\u8fb9\uff0c\u8fd9 $d_i$ \u6761\u8fb9\u6240\u8fde\u63a5\u4e24\u70b9\u6743\u503c\u7684\u6700\u5927\u516c\u7ea6\u6570\u5206\u522b\u4e3a $g_{i,1},g_{i,2},\\cdots,g_{i,d_i}$\uff0c\u6700\u5c0f\u516c\u500d\u6570\u5206\u522b\u4e3a $l_{i,1},l_{i,2},\\cdots,l_{i,d_i}$\uff0c\u5219\u4e0d\u96be\u53d1\u73b0\uff0c\u7b2c $i$ \u4e2a\u70b9\u7684\u6743\u503c\u6700\u5c0f\u4e3a $\\operatorname{lcm}\\{g_{i,1},g_{i,2},\\cdots,g_{i,d_i}\\}$\uff0c\u6700\u5927\u4e3a $\\gcd\\{l_{i,1},l_{i,2},\\cdots,l_{i,d_i}\\}$\u3002\u7a0d\u5fae\u60f3\u4e00\u4e0b\u5e94\u8be5\u5c31\u80fd\u660e\u767d\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u679a\u4e3e\u8303\u56f4\u7f29\u51cf\u5230 $[\\operatorname{lcm}\\{g_{i,1},g_{i,2},\\cdots,g_{i,d_i}\\},\\gcd\\{l_{i,1},l_{i,2},\\cdots,l_{i,d_i}\\}]$ \u4e86\uff08\u6ce8\u610f\u8fd9\u4e2a\u533a\u95f4\u6709\u53ef\u80fd\u4e0d\u5b58\u5728\uff09\uff0c\u800c\u4e14\u6ce8\u610f\u679a\u4e3e\u7684\u65f6\u5019\u53ea\u80fd\u679a\u4e3e $\\operatorname{lcm}\\{g_{i,1},g_{i,2},\\cdots,g_{i,d_i}\\}$ \u7684\u500d\u6570\uff0c\u539f\u56e0\u663e\u7136\u3002\n\n9-7 upd\uff1a\u611f\u8c22\u7ba1\u7406 @dottle \u7684\u5efa\u8bae\uff0c\u5b9e\u9645\u4e0a\u679a\u4e3e\u8fd9\u4e00\u6b65\u8fd8\u80fd\u7ee7\u7eed\u4f18\u5316\u3002\u8fd9\u6bb5\u53ef\u4ee5\u6539\u4e3a\u679a\u4e3e\u6bcf\u4e2a\u8fde\u901a\u5757\u4e2d\u4efb\u610f\u4e00\u70b9\u7684\u90bb\u8fb9\u7684 $\\operatorname{lcm}$ \u7684\u56e0\u6570\u3002\u8fd9\u6837\u53ef\u80fd\u4f1a\u66f4\u5feb\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u6570\u7684\u56e0\u6570\u4e2a\u6570\u6bd4\u8f83\u5c0f\u3002\u4ee3\u7801\u6682\u65f6\u5148\u4e0d\u6539\u4e86\uff0c\u5927\u5bb6\u53ef\u4ee5\u81ea\u5df1\u60f3\u4e00\u4e0b\u600e\u4e48\u5b9e\u73b0\u8fd9\u4e2a\u4f18\u5316\uff0c\u65e5\u540e\u6211\u53ef\u80fd\u4f1a\u6311\u4e2a\u65f6\u95f4\u628a\u4ee3\u7801\u5199\u51fa\u6765\u66f4\u65b0\u3002\n\n\u5176\u5b83\u7684\u5b9e\u73b0\u7ec6\u8282\u89c1\u4ee3\u7801\u3002\n\n------------\n\n### \u4ee3\u7801\n\n\uff08\u6709\u5c11\u91cf\u538b\u884c\uff0c\u7801\u4e11\u8f7b\u55b7\uff09\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\n#define pb push_back\nusing namespace std;\nconst ll N=107,M=1e4+7;\nstruct edge { ll to,gcd,lcm; };\nll n,m,from[M],to[M],gcd[M],lcm[M],ans[N],conn[N],cong[N];\n//ans[i]\uff1a\u7b54\u6848\u6570\u7ec4\n//cong[i]\uff1a\u4e0a\u6587 lcm{g_i}\n//conn[i]\uff1a\u4e0a\u6587 gcd{l_i}\uff0c\u540c\u65f6\u8bb0\u5f55\u6bcf\u4e2a\u70b9\u7684\u6743\u503c\u662f\u5426\u5df2\u7ecf\u6709\u89e3\nvector <edge> v[N]; //\u5b58\u8fb9\nunordered_map <ll,bool> mp; //\u679a\u4e3e\u65f6\u5b58\u8fde\u901a\u5757\nbool dfs(ll x) {\n\tfor (edge i:v[x]) if (!mp[i.to]) {\n\t\t//\u53ea\u8981\u6709\u4e00\u5904\u5730\u65b9\u4e0d\u7b26\u5408\u6761\u4ef6\u5c31\u53ef\u4ee5\u76f4\u63a5\u8fd4\u56de\n\t\tif (i.gcd*i.lcm%ans[x]!=0) return 0; //\u4e0d\u6574\u9664\n\t\tif (i.gcd*i.lcm/ans[x]<cong[i.to]||i.gcd*i.lcm/ans[x]>conn[i.to]) return 0; //\u4e0d\u7b26\u5408\u4e0a\u6587\u533a\u95f4\u6761\u4ef6\n\t\tans[i.to]=i.gcd*i.lcm/ans[x],mp[i.to]=1;\n\t\tif (__gcd(ans[x],ans[i.to])!=i.gcd) return 0; //\u4e0d\u7b26\u5408\u6570\u636e\n\t\tif (ans[x]*ans[i.to]/__gcd(ans[x],ans[i.to])!=i.lcm) return 0; //\u4e0d\u7b26\u5408\u6570\u636e\n\t\tif (!dfs(i.to)) return 0;\n\t}\n\treturn 1;\n}\nint main() {\n\tscanf(\"%lld%lld\",&n,&m);\n\tfor (ll i=1;i<=n;i++) ans[i]=cong[i]=1;\n\tfor (ll i=1;i<=m;i++) {\n\t\tscanf(\"%lld%lld%lld%lld\",&from[i],&to[i],&gcd[i],&lcm[i]);\n\t\tv[from[i]].pb({to[i],gcd[i],lcm[i]});\n\t\tv[to[i]].pb({from[i],gcd[i],lcm[i]});\n\t\tconn[from[i]]=conn[from[i]]?__gcd(conn[from[i]],lcm[i]):lcm[i]; //gcd{l_i}\n\t\tconn[to[i]]=conn[to[i]]?__gcd(conn[to[i]],lcm[i]):lcm[i];\n\t\tcong[from[i]]=cong[from[i]]*gcd[i]/__gcd(cong[from[i]],gcd[i]); //lcm{g_i}\n\t\tcong[to[i]]=cong[to[i]]*gcd[i]/__gcd(cong[to[i]],gcd[i]);\n\t}\n\tfor (ll i=1;i<=n;i++) for (ll j=cong[i];j<=conn[i];j+=cong[i])\n\t\tif (conn[i]%j==0) { //\u679a\u4e3e\u6743\u503c\u6ee1\u8db3\u6761\u4ef6\n\t\t\tmp.clear();\n\t\t\tmp[i]=1,ans[i]=j;\n\t\t\tif (dfs(i)) { //\u5982\u679c\u641c\u51fa\u4e86\u4e00\u79cd\u89e3\n\t\t\t\tfor (pair<ll,ll> i:mp) conn[i.first]=0; //\u8bb0\u5f55\u6709\u89e3\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\tfor (ll i=1;i<=n;i++) if (conn[i]) { printf(\"NO\"); return 0; } //\u5b58\u5728\u70b9\u7684\u6743\u503c\u65e0\u89e3\n\tprintf(\"YES\\n\");\n\tfor (ll i=1;i<=n;i++) printf(\"%lld \",ans[i]);\n\treturn 0;\n}\n```\n\n\u8fd9\u4efd\u4ee3\u7801\u662f\u76ee\u524d\u6700\u4f18\u89e3\uff0c\u867d\u7136\u80fd\u4f18\u5316\u7684\u5730\u65b9\u8fd8\u662f\u5f88\u591a\uff0c\u6bd4\u5982\u4e0a\u9762\u7ba1\u7406\u5efa\u8bae\u7684\u679a\u4e3e\u56e0\u6570\u3002",
        "postTime": 1662450443,
        "uid": 319803,
        "name": "CarroT1212",
        "ccfLevel": 6,
        "title": "CF60C Sol"
    }
]
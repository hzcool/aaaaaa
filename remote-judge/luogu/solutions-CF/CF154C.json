[
    {
        "content": "### $\\text{Difficulty : 2300}$\n---\n### \u89e3\u9898\u601d\u8def\uff1a\n\n\u6bcf\u4e00\u4e2a\u70b9\u90fd\u662f\u72ec\u7279\u7684\uff0c\u76f4\u63a5\u7528\u54c8\u5e0c\u5373\u53ef\u3002\u70b9\u7684\u6570\u91cf\u5f88\u591a\uff0c\u4f46\u662f\u8fb9\u76f8\u5bf9\u6bd4\u8f83\u7a00\u758f\uff0c\u53ef\u4ee5\u4ece\u8fb9\u5165\u624b\u5b8c\u6210\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u70b9\u54c8\u5e0c\u503c\u7684\u8ba1\u7b97\u3002\n\n\u6211\u91c7\u7528\u7684\u662f\u4ee5\u8d28\u6570 $1009$ \u6765\u8ba1\u7b97\u503c\uff0c\u7136\u540e\u7528 $\\text{unsigned long long}$ \u7684\u81ea\u7136\u6ea2\u51fa\u6765\u5b8c\u6210\u54c8\u5e0c\u3002\u597d\u50cf\u6ca1\u6709\u88ab\u5361\u3002\n\n\u6ce8\u610f\u5f53\u4e24\u70b9\u4e4b\u95f4\u6709\u8fb9\u76f4\u63a5\u76f8\u8fde\u7684\u65f6\u5019\u8fd9\u4e24\u4e2a\u70b9\u4e0d\u8ba1\u5165\u8fd0\u7b97\uff0c\u53ef\u4ee5\u901a\u8fc7\u52a0\u5165\u8be5\u70b9\u672c\u8eab\u6765\u6d88\u9664\u5f71\u54cd\u3002\n\n---\n### \u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#define int long long\nconst int MAXN=2000005;\nunsigned long long num[MAXN],p[MAXN],P=1009;\nint n,m,x[MAXN],y[MAXN],ans,cnt;\nsigned main(){\n\tscanf(\"%I64d%I64d\",&n,&m);\n\tp[0]=1;\n\tfor(int i=1;i<=n;i++)p[i]=p[i-1]*P;\n\tfor(int i=1;i<=m;i++){\n\t\tscanf(\"%I64d%I64d\",&x[i],&y[i]);\n\t\tnum[x[i]]+=p[y[i]];\n\t\tnum[y[i]]+=p[x[i]];\n\t}\n\tfor(int i=1;i<=m;i++)\n\tif(num[x[i]]+p[x[i]]==num[y[i]]+p[y[i]])\n\tans++;\n\tsort(num+1,num+n+1);\n\tfor(int i=1;i<=n;i++){\n\t\tif(num[i]==num[i-1]){\n\t\t\tcnt++;\n\t\t}\n\t\telse{\n\t\t\tans+=cnt*(cnt-1)/2;\n\t\t\tcnt=1;\n\t\t}\n\t}\n\tans+=cnt*(cnt-1)/2;\n\tprintf(\"%I64d\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1649227555,
        "uid": 223559,
        "name": "qxp101",
        "ccfLevel": 6,
        "title": "CF154C Double Profiles \u9898\u89e3"
    },
    {
        "content": "\u7ed9\u4e00\u5f20\u65e0\u5411\u56fe,\u95ee\u6709\u591a\u5c11\u70b9\u5bf9(A,B)\u7684\u8fb9\u5b8c\u5168\u76f8\u540c. N,M \u2264 100000\n\nA,B\u51fa\u8fb9\u76f8\u540c\uff0c\u5f53\u4e14\u4ec5\u5f53A\u8fde\u63a5\u7684\u6bcf\u4e00\u6761\u8fb9\u7684\u53e6\u4e00\u4e2a\u7aef\u70b9\u4e5f\u548cB\u76f4\u63a5\u76f8\u8fde B\u8fde\u63a5\u7684\u6bcf\u4e00\u6761\u8fb9\u7684\u53e6\u4e00\u4e2a\u7aef\u70b9\u4e5f\u548cA\u76f8\u8fde\n\n\u82e5A,B\u76f4\u63a5\u76f8\u8fde\uff0c\u4e0d\u59a8\u788d\u4ee5\u4e0a\u6027\u8d28\n\n\n\n\n# Hash\n\n\n\n\u603b\u611f\u89c9\u8fd9\u9053\u9898\u5982\u679c\u6709\u4e86\u7ffb\u8bd1\u4e4b\u540e\u6700\u591a\u662f\u9053\u84dd\u9898\n\n\u8bfb\u61c2\u9898\u540e\u5c31\u5f88\u597d\u505a\u4e86\n\n\u9996\u5148\u7ed9\u6bcf\u4e2a\u70b9\u4e00\u4e2aHash\u503c\n\n\u7136\u540e\u8bfb\u5165\u6bcf\u4e00\u6761\u8fb9\uff0c\u5bf9\u6bcf\u4e2a\u70b9\u52a0\u4e0a\u53e6\u4e00\u4e2a\u7aef\u70b9\u7684Hash\u503c\n\n\u7136\u540e\u5148\u904d\u5386\u6bcf\u4e24\u4e2a\u76f8\u8fde\u7684\u70b9\uff08\u5373\u904d\u5386\u6bcf\u4e00\u6761\u8fb9\uff09 \u8fd9\u65f6\u5019\u9700\u8981\u7ed9\u4e24\u4e2a\u70b9\u7684Hash\u5206\u522b\u52a0\u4e0a\u672c\u8eab\u7684Hash\u503c\uff08\u5426\u5219\u4f1a\u8ba4\u4e3a\u4ed6\u4eec\u7684\u8fb9\u4e0d\u4e00\u6837\uff09\n\n\u4e4b\u540e\u904d\u5386\u4e0d\u76f8\u90bb\u7684\u4e24\u4e2a\u70b9\n\n\u5f53\u4e14\u4ec5\u5f53\u4ed6\u4eec\u7684Hash\u503c\u76f8\u540c\uff0c\u8fd9\u4e24\u4e2a\u70b9\u7684\u8fb9\u76f8\u540c\n\n```cpp\n#include <iostream>\n#include <algorithm>\nusing namespace std;\nconst int maxn=100000007;\n\nint ha[maxn];\nint p=1313;\nint e[maxn][2];\nvoid init()              //hash\u6bcf\u4e2a\u70b9\n{\n    ha[0]=1;\n    for(int i=1;i<maxn;i++)\n        ha[i]=ha[i-1]*p;\n}\nlong long a[maxn];\nint main()\n{\n    std::ios::sync_with_stdio(false);\n    int n,m;\n    cin>>n>>m;\n    init();\n    for(int i=1;i<=m;i++)\n    {\n        int u,v;\n        cin>>u>>v;\n        a[u]+=ha[v];                 \n        a[v]+=ha[u];\n        e[i][0]=u;\n        e[i][1]=v;\n    }\n    long long ans=0;\n    for(int i=1;i<=m;i++)             \n    {\n        int u=e[i][0],v=e[i][1];\n        long long hu=a[u]+ha[u],hv=a[v]+ha[v];\n        if(hu==hv) ans++;\n    }\n    sort(a+1,a+n+1);\n    int i=2;\n    int cnt=1;\n    while(i<=n)                     \n    {\n        if(a[i]==a[i-1])\n        {\n            cnt++;\n        }\n        else\n        {\n            ans+=(cnt*(cnt-1))/2;         \n            cnt=1;\n        }\n        i++;\n    }\n    ans+=(cnt*(cnt-1))/2;\n    cout<<ans<<endl;\n    return 0;\n}\n\n```\n\n",
        "postTime": 1570032405,
        "uid": 174793,
        "name": "huangwux",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF154C \u3010Double Profiles\u3011"
    },
    {
        "content": "\u8be2\u95ee\u4e24\u4e2a\u96c6\u5408\u662f\u5426\u76f8\u7b49\uff0c\u6709\u7ecf\u5178\u7684\u54c8\u5e0c\u7684 trick\u3002\n\n\u8003\u8651\u7ed9\u6bcf\u4e2a\u70b9\u968f\u673a\u4e00\u4e2a $[0,2^{64})$ \u7684\u6743\u503c\uff0c\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\u518d\u7ef4\u62a4\u4e00\u4e2a\u5176\u51fa\u70b9\u7684\u6743\u503c\u548c\uff0c\u7528 map \u7ef4\u62a4\u7b54\u6848\u5373\u53ef\u3002\u4e0d\u8fc7\u5bf9\u4e8e\u76f8\u90bb\u4e24\u4e2a\u70b9\u8981\u5355\u72ec\u5224\u65ad\uff0c\u901a\u8fc7\u52a0\u4e0a\u81ea\u8eab\u6765\u6ee1\u8db3\u6027\u8d28\u3002\n\n```cpp\n//\u8fd9\u91cc\u7528\u7684\u662f xor \u54c8\u5e0c\u7684\u5199\u6cd5\n#include<bits/stdc++.h>\nusing namespace std;\n\ntypedef unsigned long long ull;\nconst int N=1e6+10;\n\nmt19937_64 rnd(time(NULL));\n\nint n,m;long long ans=0;\nint u[N],v[N];\null val[N],out[N];\nmap<ull,int> mp;\n\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n;++i)out[i]=0,val[i]=rnd();\n\tfor(int i=1;i<=m;++i){\n\t\tscanf(\"%d%d\",&u[i],&v[i]);\n\t\tout[u[i]]^=val[v[i]],out[v[i]]^=val[u[i]];\n\t}\n\tfor(int i=1;i<=m;++i)if((out[u[i]]^val[u[i]])==(out[v[i]]^val[v[i]]))++ans;\n\tfor(int i=1;i<=n;++i){\n\t\tans+=mp[out[i]];\n\t\t++mp[out[i]];\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1670244014,
        "uid": 339846,
        "name": "RuntimeErr",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF154C Double Profiles"
    },
    {
        "content": "\u96c6\u5408 hash \u6a21\u677f\u9898\u3002\n\n\u4e24\u4e2a\u4e0d\u76f8\u90bb\u7684\u70b9 $(A,B)$ \u76f8\u540c\u5f53\u4e14\u4ec5\u5f53\u5b83\u4eec\u7684\u51fa\u70b9\u96c6\u5408\u76f8\u540c\u3002\u5982\u679c\u76f8\u90bb\uff0c\u90a3\u4e48\u51fa\u70b9\u96c6\u5408\u8fd8\u8981\u52a0\u4e0a\u81ea\u5df1\u3002\n\n\u4f46\u662f\uff0c\u7ef4\u62a4\u51fa\u70b9\u96c6\u5408\u9700\u8981\u7684\u4fe1\u606f\u592a\u591a\u4e86\uff0c\u8003\u8651\u7528\u4e00\u4e2a\u7b80\u5355\u7684\u65b9\u5f0f\u6765\u6bd4\u5bf9\u3002\n\n\u8003\u8651\u7ed9\u6bcf\u4e2a\u70b9\u968f\u673a\u8d4b\u4e00\u4e2a $[0,2^{64})$ \u7684\u6743\u503c\u3002\u90a3\u4e48\uff0c\u4e00\u4e2a\u70b9\u7684\u51fa\u70b9\u96c6\u5408\u53ef\u4ee5\u7528\u51fa\u70b9\u6743\u503c\u7684\u5f02\u6216\u548c\u6765\u66ff\u4ee3\u3002\u90a3\u4e48\uff0c\u6bd4\u8f83\u4e24\u4e2a\u70b9\u7684\u5f02\u6216\u548c\u662f\u5426\u76f8\u540c\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u8fd9\u79cd\u65b9\u6cd5\u7684\u5355\u54c8\u5e0c\u88ab\u5361\u4e86\uff0c\u5efa\u8bae\u4f7f\u7528\u53cc\u54c8\u5e0c\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define ull unsigned long long\n#define For(i,a,b) for(int i=(a);i<=(b);++i)\n#define Rof(i,a,b) for(int i=(a);i>=(b);--i)\nusing namespace std;\ntypedef pair<ull,ull> Pair;\nconst int Maxn=1e6;\n\ninline int read()\n{\n    int x=0,f=1;\n    char ch=getchar();\n    while(ch<'0' || ch>'9')\n    {\n        if(ch=='-') f=-1;\n        ch=getchar();\n    }\n    while(ch>='0' && ch<='9')\n    {\n        x=x*10+ch-'0';\n        ch=getchar();\n    }\n    return x*f;\n}\n\nint n,m,ind[Maxn+5]; ll ans;\null val[Maxn+5],num[Maxn+5];\null val2[Maxn+5],num2[Maxn+5];\null seed=1145140998244353661ull;\null seed2=190331214748364703ull;\nvector<int> v[Maxn+5];\n\nmap<Pair,int> mp;\ninline ull Rand() {return seed=(seed<<7)^(seed<<11)^(seed>>19);}\ninline ull Rand2() {return seed2=(seed2<<7)^(seed2<<11)^(seed2>>13);}\n\nint main()\n{\n    n=read(),m=read();\n    For(i,1,n) val[i]=Rand(),val2[i]=Rand2();\n    For(i,1,m)\n    {\n        int a=read(),b=read();\n        num[a]^=val[b],num[b]^=val[a];\n        num2[a]^=val2[b],num2[b]^=val2[a];\n        ind[a]++,ind[b]++;\n    }\n    For(i,1,n) v[ind[i]].push_back(i);\n    For(i,0,n) if(v[i].size()>1)\n    {\n        for(auto j:v[i])\n        {\n            Pair pr=make_pair(num[j],num2[j]);\n            ans+=mp[pr],mp[pr]++;\n        }\n        mp.clear();\n        for(auto j:v[i])\n        {\n            Pair pr=make_pair(num[j]^val[j],num2[j]^val2[j]);\n            ans+=mp[pr],mp[pr]++;\n        }\n        mp.clear();\n    }\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1665367352,
        "uid": 148913,
        "name": "Graphcity",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF154C\u3010Double Profiles\u3011"
    },
    {
        "content": "\u56e0\u4e3a\u4e00\u5bf9\u70b9 $(A,B)$ \u5408\u6cd5\uff0c\u5f53\u4e14\u4ec5\u5f53\u4e0e $A$ \u8fde\u8fb9\u7684\u70b9\u7684\u96c6\u5408\u548c\u4e0e $B$ \u8fde\u8fb9\u7684\u70b9\u7684\u96c6\u5408\u76f8\u7b49\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\uff0c\u628a\u8fd9\u4e2a\u70b9\u653e\u8fdb **\u548c\u5b83\u8fde\u8fb9\u7684\u70b9\u7684\u96c6\u5408** \u4e2d\uff0c\u6700\u540e\u5c06\u96c6\u5408\u76f8\u7b49\u7684\u70b9\u653e\u5728\u4e00\u7ec4\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u7ec4\uff0c\u5982\u679c\u6709 $siz$ \u4e2a\u70b9\uff0c\u5b83\u7684\u8d21\u732e\u5c31\u662f $\\Large\\binom{siz}{2}$\u3002\n\n\u4f46\u662f\u6709 $n=10^6$ \u4e2a\u70b9\uff0c\u5f00 $10^6$ \u4e2a\u96c6\u5408\u663e\u7136\u662f\u4e0d\u73b0\u5b9e\u7684\u3002\u6211\u4eec\u7528\u54c8\u5e0c\u53bb\u505a\u5373\u53ef\u3002\u6211\u7ed9\u6bcf\u4e2a\u70b9\u968f\u673a\u4e86\u4e00\u4e2a\u6570\u503c $num_i$\uff0c\u5e76\u7ef4\u62a4\u4e24\u4e2a\u503c $a_i,b_i$\uff0c\u4ee3\u8868\u4e0e $i$ \u53f7\u70b9\u76f8\u8fde\u7684\u70b9\u7684 $num$ \u7684\u5e73\u65b9\u548c\u3001\u5f02\u6216\u548c\u3002\n\n\u904d\u5386\u6bcf\u4e2a\u70b9\uff0c\u7ed9\u548c\u5b83\u8fde\u8fb9\u7684\u70b9\u66f4\u65b0 $a_i,b_i$ \u5373\u53ef\u3002\n\n\u4f46\u662f\u4f1a\u88ab\u5361\uff0c\u6240\u4ee5\u6211\u7684\u5b9e\u9645\u4ee3\u7801\u4e2d\u662f\u968f\u673a\u4e86\u4e24\u4e2a\u6570\u503c $num_i$\uff0c$a_i,b_i$ \u4e5f\u5404\u7ef4\u62a4\u4e86\u4e24\u4e2a\u3002\n\n```c++\n#include<bits/stdc++.h>\n#define rep(i,x,y) for(int i=x;i<=y;++i)\n#define mar(o) for(int E=fst[o];E;E=e[E].nxt)\n#define v e[E].to\n#define lon long long\nusing namespace std;\nconst int n7=1012345,m7=n7*2;\nstruct dino{int to,nxt;}e[m7],e0[m7];\nstruct kite{lon a,b;}val1[n7],val2[n7];\nstruct pond{lon a,b,c,d;}val[n7];\nint n,m,dcnt,ecnt,fst[n7];lon ans,num1[n7],num2[n7];\n\nint rd(){\n\tint shu=0;bool fu=0;char ch=getchar();\n\twhile( !isdigit(ch) ){if(ch=='-')fu=1;ch=getchar();}\n\twhile( isdigit(ch) )shu=(shu<<1)+(shu<<3)+ch-'0',ch=getchar();\n\treturn fu?-shu:shu;\n}\n\nvoid edge(int p,int q){\n\tecnt++;\n\te[ecnt]=(dino){q,fst[p]};\n\tfst[p]=ecnt;\n}\n\nbool cmp(pond p,pond q){\n\tif(p.a!=q.a)return p.a<q.a;\n\tif(p.b!=q.b)return p.b<q.b;\n\tif(p.c!=q.c)return p.c<q.c;\n\treturn p.d<q.d;\n}\n\nint main(){\n\tn=dcnt=rd(),m=rd();\n\trep(i,1,m){\n\t\tint p=rd(),q=rd();\n\t\te0[i]=(dino){p,q};\n\t\tedge(p,q),edge(q,p);\n\t}\n\tsrand(time(0));\n\trep(i,1,n)num1[i]=1ll*rand()*rand()*i,num2[i]=1ll*rand()*rand()*(n-i+1);\n\trep(o,1,n){\n\t\tmar(o){\n\t\t\tval1[v].a=val1[v].a+num1[o]*num1[o];\n\t\t\tval1[v].b=val1[v].b^num1[o];\n\t\t\tval2[v].a=val2[v].a+num2[o]*num2[o];\n\t\t\tval2[v].b=val2[v].b^num2[o];\n\t\t}\n\t}\n\trep(i,1,m){\n\t\tint p=e0[i].to,q=e0[i].nxt;\n\t\tif(val1[p].a+num1[p]*num1[p]==val1[q].a+num1[q]*num1[q]&&val1[p].b^num1[p]==val1[q].b^num1[q]){\n\t\t\tif(val2[p].a+num2[p]*num2[p]==val2[q].a+num2[q]*num2[q]&&val2[p].b^num2[p]==val2[q].b^num2[q])ans++;\n\t\t}\n\t}\n\trep(i,1,n)val[i]=(pond){val1[i].a,val1[i].b,val2[i].a,val2[i].b};\n\tsort(val+1,val+n+1,cmp);\n\tint l=1,r=1;\n\trep(i,2,n){\n\t\tif(val[i].a==val[i-1].a&&val[i].b==val[i-1].b&&val[i].c==val[i-1].c&&val[i].d==val[i-1].d)r++;\n\t\telse ans=ans+1ll*(r-l+1)*(r-l)/2,l=r=i;\n\t}\n\tans=ans+1ll*(r-l+1)*(r-l)/2;\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1635563429,
        "uid": 99623,
        "name": "BlankAo",
        "ccfLevel": 0,
        "title": "CF154C"
    }
]
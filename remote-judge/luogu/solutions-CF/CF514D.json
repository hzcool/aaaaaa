[
    {
        "content": "\u9996\u5148\u9898\u610f\u53ef\u4ee5\u8f6c\u5316\u4e3a\u6c42\u4e00\u4e2a\u6700\u957f\u7684\u533a\u95f4\uff0c\u4f7f\u5f97\u533a\u95f4\u5185\u7b2c $i(1\\leq i\\leq m)$ \u79cd\u7ec6\u8282\u7684\u6700\u5927\u503c\u4e4b\u548c\u5c0f\u4e8e\u7b49\u4e8e $k$\n\n\u663e\u7136\u5f53\u533a\u95f4\u53f3\u7aef\u70b9 $r$ \u56fa\u5b9a\uff0c\u5de6\u7aef\u70b9 $l$ \u53f3\u79fb\u65f6\uff0c\u8fd9\u4e2a\u6700\u5927\u503c\u4e4b\u548c\u662f\u9012\u51cf\u7684\n\n\u90a3\u4e48\u5c31\u53ef\u4ee5\u7528 `2-pointers` \u505a\u4e86\uff0c\u4e5f\u5c31\u662f\u6bcf\u6b21\u5c06\u533a\u95f4\u7684\u53f3\u7aef\u70b9\u53f3\u79fb\u4e00\u4f4d\uff0c\u5982\u679c\u4e0d\u5408\u6cd5\u5c31\u4e0d\u505c\u7684\u5c06\u5de6\u7aef\u70b9\u53f3\u79fb\uff0c\u76f4\u5230\u7b54\u6848\u5408\u6cd5\n\n\u5176\u4e2d\u627e\u6700\u5927\u503c\u7684\u8fc7\u7a0b\u53ef\u4ee5\u7528\u5355\u8c03\u961f\u5217\u4f18\u5316\uff0c\u90a3\u4e48\u603b\u590d\u6742\u5ea6\u5c31\u662f $O(nm)$ \u7684\u4e86\n\n$Code\\ Below$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1e5+5;\nconst int M=6;\n\nint read()\n{\n\tint s=0;\n\tchar c=getchar(),lc='+';\n\twhile (c<'0'||'9'<c) lc=c,c=getchar();\n\twhile ('0'<=c&&c<='9') s=s*10+c-'0',c=getchar();\n\treturn lc=='-'?-s:s;\n}\nvoid write(int x)\n{\n\tif (x<0)\n\t{\n\t\tputchar('-');\n\t\tx=-x;\n\t}\n\tif (x<10) putchar(x+'0');\n\telse\n\t{\n\t\twrite(x/10);\n\t\tputchar(x%10+'0');\n\t}\n}\nvoid print(int x,char c='\\n')\n{\n\twrite(x);\n\tputchar(c);\n}\nint a[N][M],q[M][N],h[M],t[M],ans[M];\n//\u8fd9\u91cc\u5f00\u4e86m\u4e2a\u5355\u8c03\u961f\u5217\nint calc(int m)\n{\n\tint ret=0;\n\tfor (int i=1;i<=m;i++) ret+=a[q[i][h[i]]][i];\n\treturn ret;\n}\n//\u8ba1\u7b97\u5f53\u524d\u6700\u5927\u503c\u4e4b\u548c\n\nsigned main()\n{\n\tint n=read(),m=read(),k=read(),Max=0;\n\tfor (int i=1;i<=n;i++)\n\tfor (int j=1;j<=m;j++) a[i][j]=read();\n\tfor (int j=1;j<=m;j++) h[j]=1,t[j]=0;\n\tfor (int l=1,r=1;r<=n;r++)\n\t{\n\t\tfor (int i=1;i<=m;i++)\n\t\t{\n\t\t\twhile (h[i]<=t[i]&&a[q[i][t[i]]][i]<=a[r][i]) t[i]--;\n\t\t\tq[i][++t[i]]=r;\n\t\t}//\u53f3\u7aef\u70b9\u53f3\u79fb\n\t\twhile (l<=r&&calc(m)>k)\n\t\t{\n\t\t\tl++;\n\t\t\tfor (int i=1;i<=m;i++)\n\t\t\tif (q[i][h[i]]<l)\n\t\t\th[i]++;\n\t\t}//\u5de6\u7aef\u70b9\u53f3\u79fb\n\t\tif (r-l+1>Max)\n\t\t{\n\t\t\tMax=r-l+1;\n\t\t\tfor (int i=1;i<=m;i++) ans[i]=a[q[i][h[i]]][i];\n\t\t}//\u8ba1\u7b97\u6700\u5927\u503c\n\t}\n\tfor (int i=1;i<=m;i++) print(ans[i],' ');\n\n\treturn 0;\n}\n```",
        "postTime": 1602551354,
        "uid": 61120,
        "name": "QwQcOrZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF514D \u3010R2D2 and Droid Army\u3011"
    },
    {
        "content": "[\u9898\u9762](https://codeforces.com/contest/514/problem/D)\n\n[\u6ca1\u8bf4\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/1358id/p/16343819.html)\n\nDescription:\n\n\u6709 $n$ \u4e2a\u654c\u4eba\uff0c\u6bcf\u4e2a\u654c\u4eba\u6709 $m$ \u79cd\u5c5e\u6027\u503c\uff0c\u7b2c $i$ \u4e2a\u654c\u4eba\u7684\u6bcf\u4e2a\u5c5e\u6027\u5206\u522b\u4e3a $a_{i,1},a_{i,2},\\ldots,a_{i,m}$\u3002\u4f60\u8981\u6784\u9020\u4e00\u4e2a\u957f\u5ea6\u4e3a $m$ \u7684\u6570\u5217 $b_{1\\ldots m}$\uff0c\u89c4\u5b9a\u654c\u4eba $i$ \u88ab\u6740\u6b7b\u5f53\u4e14\u4ec5\u5f53 $a_{i,1}\\leq b_1,a_{i,2}\\leq b_2,\\ldots,a_{i,m}\\leq b_m$ \u5168\u90e8\u6ee1\u8db3\u3002\n\n\u6570\u5217 $b$ \u8981\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a\n1. $\\sum b_i\\leq k$\uff1b\n2. \u8fde\u7eed\u7684\u88ab\u6740\u6b7b\u7684\u654c\u4eba\u6570\u91cf\u6700\u591a\u3002\n\n$1\\leq n\\leq 10^5,1\\leq m\\leq 5,1\\leq k\\leq 10^9$\u3002\n\n-----\n\u4ece\u7b2c $l$ \u5230\u7b2c $r$ \u4e2a\u654c\u4eba\u90fd\u88ab\u6740\u6b7b\u7684\u5fc5\u8981\u6761\u4ef6\u662f $\\max_{l\\leq i\\leq r}\\{a_{i,m}\\}\\leq b_m$\u3002\u65e2\u7136\u8981\u505a\u6700\u5927\u503c\uff0c\u9996\u5148\u60f3\u5230\u7528 ST \u8868\u7ef4\u62a4\u3002\n\n\u7136\u540e\u6211\u8981\u8fde\u7eed\u7684\u4eba\u6570\u6700\u591a\uff0c\u6240\u4ee5\u4e8c\u5206\u8fde\u7eed\u7684\u4eba\u6570\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u957f\u5ea6 $x$\uff0c\u6211\u679a\u4e3e\u6570\u5217\u4e2d\u6240\u6709\u957f\u5ea6\u4e3a $x$ \u7684\u533a\u95f4\uff0c\u770b\u6211\u80fd\u5426\u6740\u6b7b\u8fd9\u4e2a\u533a\u95f4\u4e2d\u6240\u6709\u7684\u654c\u4eba\u3002\u5f62\u5f0f\u5316\u7684\uff0c\u5bf9\u4e8e\u533a\u95f4 $[l,r]$\uff0c\u6211\u80fd\u6740\u6b7b\u8be5\u533a\u95f4\u5185\u6240\u6709\u654c\u4eba\uff0c\u5f53\u4e14\u4ec5\u5f53 \n$$\\sum_{i=1}^m \\max_{j=l}^r a_{j,i}\\leq k$$\n\n\u90a3\u660e\u663e\u901a\u8fc7 ST \u8868\u505a\u8fd9\u4e2a\u4e1c\u897f\u7684\u590d\u6742\u5ea6\u662f $O(m)$ \u7684\u3002\u7b97\u4e0a\u4e8c\u5206\u7684\u590d\u6742\u5ea6\uff0c\u603b\u590d\u6742\u5ea6\u4e3a $O(nm\\log n)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n\u5b9e\u73b0\u65f6\u6ce8\u610f\u6700\u5927\u957f\u5ea6\u4e3a $0$ \u65f6\u7684\u8f93\u51fa\u65b9\u5f0f\u3002\n\n[\u4ee3\u7801](https://paste.ubuntu.com/p/Gfj7P7KbNH/)",
        "postTime": 1654406663,
        "uid": 222865,
        "name": "\u8fdf\u66ae\u5929\u590d\u660e",
        "ccfLevel": 6,
        "title": "CF514D"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u4e2a\u65e0\u8111\u4e8c\u5206+\u7ebf\u6bb5\u6811/ ST \u8868\u505a\u6cd5\u3002\n\n\u9996\u5148\u770b\u5230\u8fd9\u4e2a\u9898\u4e00\u5b9a\u53ef\u4ee5\u60f3\u5230\u8f6c\u5316\u6210\u5bfb\u627e $l$ \u548c $r$ \uff0c\u4f7f\u5f97 $r - l + 1$ \u6700\u5927\u4e14 $[l,r]$ \u8fd9\u4e2a\u533a\u95f4\u5185\u6240\u6709\u79cd\u7c7b\u5c5e\u6027\u503c\u7684\u6700\u5927\u503c\u4e4b\u548c $<= k$ \u3002\n\n\u8f6c\u5316\u6210\u8fd9\u4e2a\u6837\u5b50\u4e4b\u540e\u5c31\u6bd4\u8f83\u597d\u505a\u4e86\n\n\u5bf9\u4e8e\u8fd9\u79cd\u6c42\u6700\u5927\u533a\u95f4\u957f\u5ea6\u7684\u9898\u6211\u7684\u505a\u6cd5\u662f\u4f1a\u91c7\u53d6\u4e8c\u5206\u957f\u5ea6\u7684\u65b9\u6cd5\u6765\u89e3\u51b3\n\n\u5177\u4f53\u5c31\u662f\u4e8c\u5206\u957f\u5ea6,\u7136\u540e\u5728 $check$ \u51fd\u6570\u91cc\u9762\u679a\u4e3e $l$ , \u7528 ST \u8868/\u7ebf\u6bb5\u6811\u67e5\u8be2  $[l, r]$ \u4e2d\u7684\u6700\u5927\u503c,\u770b\u770b\u6700\u5927\u503c\u4e4b\u548c\u662f\u4e0d\u662f\u5408\u6cd5\n\n\u6574\u4f53\u590d\u6742\u5ea6 $O (nm \\log n)$ \u6216 $O (nm \\log^2 n)$ , \u80fd\u8fc7\n\n\u4e00\u9053\u6c34\u7d2b\u5c31\u8fd9\u6837\u5207\u6389\u4e86\n\n\u795d\u5404\u4f4d csp rp++",
        "postTime": 1666093216,
        "uid": 642247,
        "name": "\u5feb\u901fherself\u53d8\u6362",
        "ccfLevel": 0,
        "title": "CF514D\u9898\u89e3\uff08\u7eaf\u53e3\u80e1\uff09"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF514D)\n## \u601d\u8def\n\u8fd9\u91cc\u63d0\u4f9b\u4e00\u79cd\u4e0d\u9700\u8981\u52a8\u8111\u7684\u53cc $\\log$ \u505a\u6cd5\u3002\n\n\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u5de6\u7aef\u70b9\uff0c\u9700\u8981 $O(n)$ \u7684\u65f6\u95f4\u6548\u7387\uff0c\u7136\u540e\u6211\u4eec\u53d1\u73b0 ${l,r}$ \u533a\u95f4\u7684\u7b54\u6848\u5c31\u7b49\u4e8e $\\sum \\max b_{i,j} \\ (l \\le i \\le r,1 \\le j \\le m)$\u3002\u8fd9\u4e2a\u4e1c\u897f\u663e\u7136\u5177\u6709\u5355\u8c03\u6027\uff0c\u6240\u4ee5\u53ef\u4ee5\u4e8c\u5206\uff0c\u4e2d\u95f4\u518d\u5957\u4e2a $\\verb!ST!$ \u8868\u67e5\u8be2\u533a\u95f4 $\\max$\uff0c\u4e3a\u4e86\u6df1\u5165\u8d2f\u5f7b\u6211\u4eec\u4e0d\u9700\u8981\u8111\u5b50\u7684\u5b97\u65e8\uff0c\u6240\u4ee5\u6211\u51b3\u5b9a\u4e0d\u628a $\\verb!ST!$ \u8868\u4f18\u5316\u6210 $O(1)$ \u67e5\u8be2\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n \\log^2 n)$\u3002\n\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nint const N=1e5+10;\nint a[N][6],now[9],k,m,f[6][N][20];\ninline int query(int q,int ll,int rr){\n    int nowmax=0;\n    for (int i=30;~i;--i)\n        if (ll+(1LL<<i)-1<=rr){\n            nowmax=max(nowmax,f[q][ll][i]);\n            ll+=(1LL<<i);\n        }\n    return nowmax;\n}\ninline bool check(int l,int r){\n    memset(now,0,sizeof(now));\n    if (l>r) return 1;\n    int ans=k;\n    for (int q=1;q<=m;++q){\n        int nowmax=query(q,l,r);\n        ans-=nowmax;now[q]=nowmax;\n        if (ans<0) return 0;\n    }\n    return 1;\n}\nsigned main(){\n    ios::sync_with_stdio(false);\n    cin.tie(0),cout.tie(0);\n    int n;cin>>n>>m>>k;\n    for (int i=1;i<=n;++i)\n        for (int j=1;j<=m;++j)\n            cin>>a[i][j];\n    for (int q=1;q<=m;++q){\n        for (int i=1;i<=n;++i) f[q][i][0]=a[i][q];\n        for (int j=1;j<=30;++j)\n            for (int i=1;i+(1<<(j-1))<=n;++i)\n                f[q][i][j]=max(f[q][i][j-1],f[q][i+(1<<(j-1))][j-1]);\n    }\n    int ans=-1,ans1[9];\n    for (int i=1;i<=n;++i){\n        int q[9],r=n,l=i-1;\n        memset(q,0,sizeof(q));\n        while (l<r){\n            if (l+1==r){\n                if (check(i,r)){\n                    for (int j=1;j<=m;++j) q[j]=now[j];\n                    l=r;\n                }\n                break;\n            }\n            int mid=(l+r)>>1;\n            if (check(i,mid)){\n                for (int j=1;j<=m;++j) q[j]=now[j];\n                l=mid;\n            }else r=mid-1;\n        }\n        if (l-i+1>ans){\n            ans=l-i+1;\n            for (int j=1;j<=m;++j) ans1[j]=q[j];\n        }\n    }\n    for (int i=1;i<=m;++i) cout<<ans1[i]<<' ';\n    cout<<'\\n';\n    return 0;\n}\n```\n",
        "postTime": 1665196254,
        "uid": 253608,
        "name": "Tx_Lcy",
        "ccfLevel": 7,
        "title": "CF514D R2D2 and Droid Army"
    },
    {
        "content": "\u53d1\u73b0\u5373\u6c42\u4e00\u4e2a\u6700\u5927\u7684\u533a\u95f4 $[l,r]$\uff0c\u4f7f\u5f97 $\\sum\\limits_{i=1}^{m}\\max\\limits_{j=l}^{r}\\{a_{j,i}\\}\\le k$\uff0c$a_{i,j}$ \u8868\u793a\u7b2c $i$ \u4e2a\u4eba\u7b2c $j$ \u79cd\u5c5e\u6027\u7684\u503c\u3002\n\n## Solution 1\n\n\u8003\u8651\u679a\u4e3e\u5de6\u7aef\u70b9 $l$\uff0c\u53d1\u73b0\u5982\u679c\u56fa\u5b9a\u8fd9\u4e2a\u7aef\u70b9\uff0c\u5219 $\\sum\\limits_{i=1}^{m}\\max\\limits_{j=l}^{r}\\{a_{j,i}\\}$ \u4e00\u5b9a\u968f\u7740 $r$ \u589e\u5927\u800c\u589e\u5927\u3002\u5e76\u4e14\u5982\u679c\u5bf9\u4e8e $l<l'$\uff0c\u6709 $r$ \u4f7f\u5f97 $\\sum\\limits_{i=1}^{m}\\max\\limits_{j=l}^{r}\\{a_{j,i}\\}\\le k$\uff0c\u5219 $\\sum\\limits_{i=1}^{m}\\max\\limits_{j=l'}^{r}\\{a_{j,i}\\}$ \u4e5f\u4e00\u5b9a\u6ee1\u8db3\u3002\u4e8e\u662f\u6ee1\u8db3\u6761\u4ef6\u6700\u5927\u7684 $r$ \u4e00\u5b9a\u662f\u5355\u8c03\u9012\u589e\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u53cc\u6307\u9488\u5728 $O(nm)$ \u7684\u590d\u6742\u5ea6\u5185\u89e3\u51b3\u3002\n\n## Solution 2\n\n\u8fd8\u662f\u56fa\u5b9a\u5de6\u7aef\u70b9 $l$\uff0c\u53d1\u73b0\u53f3\u7aef\u70b9 $r$ \u6ee1\u8db3\u5355\u8c03\u6027\uff0c\u53ef\u4ee5\u4e8c\u5206\u786e\u5b9a\u3002\n\n\u4e8c\u5206\u53f3\u7aef\u70b9 $r$\uff0c\u7528 `st` \u8868\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u533a\u95f4\u6700\u5927\u503c\uff0c\u6240\u4ee5 `check` \u53ef\u4ee5 $O(m)$\uff0c\u603b\u590d\u6742\u5ea6 $O(nm\\log n)$\u3002\n\n\u53ea\u5199\u4e86\u7b2c\u4e8c\u79cd\u65b9\u6cd5\u7684\u4ee3\u7801\uff0c\u56e0\u4e3a\u597d\u5199\u3002\n\n```cpp\n#include <bits/stdc++.h>\nnamespace mystd {\n\tinline int read() {\n\t    char c = getchar();\n\t    int x = 0, f = 1;\n\t    while (c < '0' || c > '9') f = (c == '-') ? -1 : f, c = getchar();\n\t    while (c >= '0' && c <= '9') x = (x << 1) + (x << 3) + c - '0', c = getchar();\n\t    return x * f;\n\t}\n\tinline void write(int x) {\n\t    if (x < 0) x = ~(x - 1), putchar('-');\n\t    if (x > 9) write(x / 10);\n\t    putchar(x % 10 + '0');\n\t}\n}\nusing namespace std;\nusing namespace mystd;\n\nconst int maxn = 1e5 + 100;\nconst int maxm = 20;\nint n, m, k, la, ra, ta, a[maxn][10], f[maxn][maxm][10];\n\nint query(int l, int r, int k) {\n\tint len = log2(r - l + 1);\n\treturn max(f[l][len][k], f[r - (1 << len) + 1][len][k]);\n}\n\nint main() {\n\tn = read(), m = read(), k = read();\n\tfor (int i = 1; i <= n; i++) {\n\t\tfor (int j = 1; j <= m; j++) {\n\t\t\ta[i][j] = read();\n\t\t}\n\t}\n\tfor (int i = 1; i <= m; i++) {\n\t\tfor (int j = 1; j <= n; j++) f[j][0][i] = a[j][i];\n\t\tfor (int j = 1; (1 << j) <= n; j++) {\n\t\t\tfor (int k = 1; k + (1 << j) - 1 <= n; k++) {\n\t\t\t\tf[k][j][i] = max(f[k][j - 1][i], f[k + (1 << (j - 1))][j - 1][i]);\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i = 1; i <= n; i++) {\n\t\tint sum = 0;\n\t\tfor (int j = 1; j <= m; j++) {\n\t\t\tsum += a[i][j];\n\t\t}\n\t\tif (sum > k) continue;\n\t\tint l = i, r = n;\n\t\twhile (l <= r) {\n\t\t\tint mid = (l + r) >> 1;\n\t\t\tint tp = 0;\n\t\t\tfor (int j = 1; j <= m; j++) {\n\t\t\t\ttp += query(i, mid, j);\n\t\t\t}\n\t\t\tif (tp > k) r = mid - 1;\n\t\t\telse {\n\t\t\t\tl = mid + 1;\n\t\t\t\tif (ta < mid - i + 1) {\n\t\t\t\t\tta = mid - i + 1;\n\t\t\t\t\tla = i;\n\t\t\t\t\tra = mid;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i = 1; i <= m; i++) {\n\t\twrite(query(la, ra, i)), putchar(' ');\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1662727495,
        "uid": 306573,
        "name": "Ender32k",
        "ccfLevel": 0,
        "title": "CF514D R2D2 and Droid Army \u9898\u89e3"
    },
    {
        "content": "upd : \u4fee\u6b63\u4e86\u7b14\u8bef\u4e0e\u7a7a\u683c\u95ee\u9898\u3002\n\n### \u9898\u89e3\u601d\u8def\uff1a\n\n\u89c2\u5bdf\u9898\u9762\uff0c\u5bb9\u6613\u5f97\u51fa\uff0c\u82e5\u60f3\u8981\u9500\u6bc1\u7b2c $l$ \u81f3 $r$ \u7684\u4eba\uff0c\u5219\u6240\u9700\u8981\u7684\u64cd\u4f5c\u6b21\u6570\u4e3a\uff1a\n\n$$\\sum^m_{i=1} \\max_{l\\le j\\le r}a_{j,i}$$\n\n\u5176\u4e2d $a_{i,j}$ \u8868\u793a\u7b2c $i$ \u4e2a\u4eba\u7684\u7b2c $j$ \u4e2a\u5c5e\u6027\u503c\u3002\u82e5\u4f7f\u7528 ST \u8868\uff0c$O(n \\log n)$ \u9884\u5904\u7406\uff0c$O(1)$ \u8ba1\u7b97\u3002\uff08\u56e0\u4e3a $m$ \u5f88\u5c0f\uff0c\u6211\u4eec\u628a\u5b83\u89c6\u4e3a\u5e38\u6570\u7565\u53bb\uff09\n\n\u6734\u7d20\u7684\u679a\u4e3e\u80af\u5b9a\u662f $O(n^2)$ \u7684\uff0c\u6211\u4eec\u8003\u8651\u8fdb\u884c\u4f18\u5316\u3002\n\n\u89c2\u5bdf\u5230\uff0c\u5728\u53f3\u7aef\u70b9 $r$ \u5411\u53f3\u79fb\u7684\u8fc7\u7a0b\u4e2d\uff0c\u6700\u4f18\u7684 $l$ \u4e00\u5b9a\u4f1a\u4e0d\u65ad\u5411\u53f3\u79fb\uff0c\u56e0\u4e3a\u5728\u533a\u95f4\u589e\u5927\u7684\u8fc7\u7a0b\u4e2d\u6700\u5927\u503c\u4e00\u5b9a\u4e0d\u4f1a\u51cf\u5927\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u8bb0\u5f55\u4e0a\u4e00\u6b21\u7684\u6700\u4f18\u5de6\u7aef\u70b9 $p$\uff0c$l$ \u5728 $p$ \u5230 $r$ \u7684\u8303\u56f4\u679a\u4e3e\u5373\u53ef\uff0c\u7701\u53bb\u4e86\u679a\u4e3e $1$ \u5230 $p-1$ \u8fd9\u4e00\u6bb5\uff0c\u8fd9\u6837\uff0c\u6bcf\u4e2a\u70b9\u6700\u591a\u4f1a\u88ab\u5de6\u7aef\u70b9 $l$ \u904d\u5386\u4e00\u6b21\uff0c\u6545\u590d\u6742\u5ea6\u4e3a $O(n)$\uff0c\u8fd9\u4e5f\u5c31\u662f\u8457\u540d\u7684\u53cc\u6307\u9488\u6cd5\u3002\n\n\u7ed3\u5408\u524d\u9762\u7684 ST \u8868\u9884\u5904\u7406\uff0c\u603b\u590d\u6742\u5ea6\u4e3a $O(n \\log n)$.\n\n### \u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define N 100005\ninline int read() {\n\tint x = 0, f = 1; char ch = getchar();\n\twhile (ch < '0' || ch > '9') { if (ch == '-') f = -1; ch = getchar(); }\n\twhile (ch >= '0' && ch <= '9') { x = x * 10 + ch - 48; ch = getchar(); }\n\treturn x*f;\n}\nint n, m, k, LOG[N], f[7][N][35], ans;\nvector<int> A;\nint query(int l, int r) { // \u8ba1\u7b97\u9500\u6bc1l\u5230r\u7684\u4eba\u7684\u6b21\u6570\n\tint qans = 0, k = LOG[r - l + 1];\n\tfor(int i = 1; i <= m; ++i) {\n\t\tqans += max(f[i][l][k], f[i][r - (1 << k) + 1][k]);\n\t}\n\treturn qans;\n}\nvoid update(int l, int r) { //\u8bb0\u5f55\u7b54\u6848\n\tint k = LOG[r - l + 1];\n\tvector<int> _new;\n\tfor(int i = 1; i <= m; ++i) {\n\t\t_new.push_back(max(f[i][l][k], f[i][r - (1 << k) + 1][k]));\n\t}\n\tA = _new;\n}\nsigned main() {\n\tn = read(), m = read(), k = read();\n\tLOG[1] = 0;\n\tfor(int i = 0; i < m; ++i) A.push_back(0); // \u7b54\u6848\u521d\u59cb\u4e3a\u4ec0\u4e48\u4e5f\u4e0d\u64cd\u4f5c\n\tfor(int i = 2; i <= n; ++i) LOG[i] = LOG[i >> 1] + 1; \n\tfor(int i = 1; i <= n; ++i) {\n\t\tfor(int j = 1; j <= m; ++j) {\n\t\t\tf[j][i][0] = read();\n\t\t}\n\t}\n\tfor(int p = 1; p <= m; ++p) {\n\t\tfor(int j = 1; (1 << j) <= n; ++j) {\n\t\t\tfor(int i = 1; i + (1 << j) - 1 <= n; ++i) {\n\t\t\t\tf[p][i][j] = max(f[p][i][j - 1], f[p][i + (1 << (j - 1))][j - 1]);\n\t\t\t}\n\t\t}\n\t}\n\tint pl = 1;\n\tfor(int i = 1; i <= n; ++i) {\n\t\twhile(pl <= i && query(pl, i) > k) pl ++; //\u53cc\u6307\u9488\u6cd5\n\t\tif(i - pl + 1 > ans) {\n\t\t\tupdate(pl, i);\n\t\t\tans = i - pl + 1;\n\t\t}\n\t}\n\tfor(int i : A) {\n\t\tcout << i << ' ';\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1652689059,
        "uid": 482642,
        "name": "hank0402",
        "ccfLevel": 0,
        "title": "CF514D R2D2 and Droid Army \u9898\u89e3"
    },
    {
        "content": "\u4e8c\u5206+\u7ebf\u6bb5\u6811\u5373\u53ef\n\n\u6211\u4eec\u679a\u4e3e\u5de6\u7aef\u70b9\uff0c\u5e0c\u671b\u7528\u4e8c\u5206\u627e\u5230\u6ee1\u8db3\u6761\u4ef6\u7684\u6700\u8fdc\u7684\u53f3\u7aef\u70b9\uff0c\u663e\u7136\u6ee1\u8db3\u5355\u8c03\u6027\n\n\u7136\u540e\u8003\u8651$check$\u51fd\u6570\uff0c\u5f53\u4e00\u4e2a\u533a\u95f4\u5185$m$\u4e2a\u5c5e\u6027\u7684\u6700\u5927\u503c\u7684\u548c$<=k$\uff0c\u8fd9\u4e2a\u533a\u95f4\u6ee1\u8db3\u6761\u4ef6\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f00$m$\u68f5\u7ebf\u6bb5\u6811\u6765\u7ef4\u62a4\u533a\u95f4\u6700\u5927\u503c\uff0c$check$\u7684\u65f6\u5019\u67e5\u8be2\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\n\n```cpp\n#include <iostream>\n#include <stdio.h>\n#include <string.h>\nusing namespace std;\nconst int N=100005;\nint n,m,k;\nint t[N<<2][6],a[N][6],maxn=0,Ans[6],ls[6],ans[6];\nvoid pushup(int x,int u) {\n  t[x][u]=max(t[x<<1][u],t[x<<1|1][u]);\n}\nvoid build(int x,int l,int r,int u) {\n  if(l==r) {\n    t[x][u]=a[l][u];\n    return ;\n  }\n  int mid=(l+r)>>1;\n  build(x<<1,l,mid,u);\n  build(x<<1|1,mid+1,r,u);\n  pushup(x,u);\n}\nint query(int x,int l,int r,int L,int R,int u) {\n  if(L<=l && r<=R) return t[x][u];\n  int mid=(l+r)>>1;\n  int ret=0;\n  if(L<=mid) ret=max(ret,query(x<<1,l,mid,L,R,u));\n  if(R>mid) ret=max(ret,query(x<<1|1,mid+1,r,L,R,u));\n  return ret;\n}\nbool check(int l,int r) {\n  memset(ls,0,sizeof(ls));int sum=0;\n  for (int i=1;i<=m;++i) {ls[i]=query(1,1,n,l,r,i);sum+=ls[i];}\n  if(k>=sum) return 1;\n  return 0;\n}\nint solve(int x) {\n  int l=x,r=n,ret=0;\n  while(l<=r) {\n    int mid=(l+r)>>1;\n    if(check(x,mid)) {\n      ret=mid;\n      for (int i=1;i<=m;++i) Ans[i]=ls[i];\n      l=mid+1;\n    }\n    else r=mid-1;\n  }\n  return ret;\n}\nint main() {\n  scanf(\"%d%d%d\",&n,&m,&k);\n  for (int i=1;i<=n;++i) {\n    for (int j=1;j<=m;++j) scanf(\"%d\",&a[i][j]);\n  }\n  for (int i=1;i<=m;++i) build(1,1,n,i);\n  for (int i=1;i<=n;++i) {\n    int ret1=solve(i);\n    if((ret1-i+1)>=maxn) {\n      maxn=ret1-i+1;\n      for (int j=1;j<=m;++j) ans[j]=Ans[j];\n    }\n  }\n  for (int j=1;j<m;++j) printf(\"%d \",ans[j]);\n  printf(\"%d\\n\",ans[m]);\n  return 0;\n}\n\n```",
        "postTime": 1585058755,
        "uid": 78187,
        "name": "zjjcth330",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF514D \u3010R2D2 and Droid Army\u3011"
    },
    {
        "content": "\u679a\u4e3e\u533a\u95f4\u7684\u5de6\u7aef\u70b9\uff0c\u8ba1\u7b97\u5728\u6ee1\u8db3\u8981\u6c42\u7684\u60c5\u51b5\u4e0b\u53f3\u7aef\u70b9\u6700\u8fdc\u80fd\u5230\u54ea\u91cc\u3002\n\n\u5047\u5982\u533a\u95f4\u662f $[l,r]$\uff0c\u90a3\u4e48\u628a\u8be5\u533a\u95f4\u6240\u6709\u673a\u5668\u5168\u90e8\u9500\u6bc1\u7684\u4ee3\u4ef7\u662f \n$$\\sum_{i=1}^m \\max_{j=l}^r a_{i,j}$$\n\u6240\u4ee5\u8fd9\u4e2a\u662f\u968f\u7740\u533a\u95f4\u7684\u589e\u957f\u5355\u8c03\u9012\u589e\u7684\u3002\u57fa\u4e8e\u8fd9\u4e00\u70b9\uff0c\u53ef\u4ee5\u7528\u53cc\u6307\u9488\u6216\u8005\u4e8c\u5206\u53bb\u6c42\uff0c\u8981\u7528\u7ebf\u6bb5\u6811\u6216 ST \u8868\u8fdb\u884c\u7ef4\u62a4\uff0c\u590d\u6742\u5ea6\u4e3a $\\Theta(m\\times n\\log_2 n)$\u3002\n\n\u7136\u800c\u8fd9\u4e00\u9898\u4e5f\u53ef\u4ee5\u7528\u5355\u8c03\u961f\u5217\u505a\uff0c\u590d\u6742\u5ea6\u4e3a $\\Theta(n\\times m)$\u3002\u8fd9\u662f\u6211\u4e07\u4e07\u6ca1\u60f3\u5230\u7684\u3002\n\n\u603b\u7ed3\uff1a\u8fd8\u662f\u83dc\u4e86\u70b9\u3002\n\n---\nUpd 2021/9/15: \u4fee\u590d\u4e86\u7a7a\u683c\u95ee\u9898\u3002",
        "postTime": 1631359686,
        "uid": 240812,
        "name": "45dino",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF514D \u3010R2D2 and Droid Army\u3011"
    },
    {
        "content": "### \u9898\u610f\n\n\u4e00\u5171\u6709N\u4e2a\u4eba\uff0c\u6bcf\u4e2a\u4eba\u6709M\u4e2a\u5c5e\u6027\u503c\uff0c\n\u5f53\u4e00\u4e2a\u4eba\u7684\u6240\u6709\u5c5e\u6027\u503c\u90fd\u5c0f\u4e8e\u7b49\u4e8e0\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u4eba\u5c31\u7b97\u88ab\u9500\u6bc1\u4e86\u3002\n\n\u6211\u4eec\u6bcf\u6b21\u64cd\u4f5c\u53ef\u4ee5\u9009\u4e00\u79cd\u5c5e\u6027\u503c\u8fdb\u884c\u653b\u51fb\uff0c\n\u4f7f\u5f97\u6240\u6709\u4eba\u7684\u8fd9\u4e2a\u5c5e\u6027\u7684\u503c\u90fd-1.\n\n\u6211\u4eec\u6700\u591a\u53ef\u4ee5\u8fdb\u884cK\u6b21\u64cd\u4f5c,\n\u95ee\u6211\u4eec\u6700\u591a\u53ef\u4ee5\u5e72\u6389\u591a\u5c11\u4e2a\u8fde\u7eed\u7684\u4eba\u3002\n\u95ee\u8fd9\u79cd\u65f6\u5019\u7684\u5177\u4f53\u64cd\u4f5c\uff08\u6bcf\u4e00\u79cd\u5c5e\u6027\u7528\u4e86\u591a\u5c11\u6b21\u64cd\u4f5c\uff09\n\n $n \\le 10^5 \\ m \\le 5 \\ k \\le 10^9$ \n\n### \u89e3\u6cd5\n\n\u4e8c\u5206\u5e72\u6389\u7684\u8fde\u7eed\u4eba\u6570\n\n\u76f4\u63a5\u679a\u4e3e\u6bcf\u4e2a\u957f\u5ea6\u4e3amid\u7684\u533a\u95f4\n\n\u5355\u8c03\u961f\u5217\u6c42\u533a\u95f4\u6700\u5927\u503c\u3002\n\n\u5f53\u6240\u6709 \u5404\u5c5e\u6027\u7684\u533a\u95f4\u6700\u5927\u503c \u7684\u548c $sum \\le K$ \u65f6\uff0c\u5b58\u5728\u65b9\u6848\u5e72\u6389 $mid$ \u4e2a\u4eba\u3002\n\n\u590d\u6742\u5ea6$O(nlogn)$\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define rep(i,x,y) for(int i=x;i<=y;i++)\n#define per(i,x,y) for(int i=x;i>=y;i--)\n#define rd(x) scanf(\"%d\",&x);\ntypedef long long LL;\nconst int N=1e5+10,M=7;\nint n,m,hd[M],tl[M],a[N][M],qaq[M],maxx[M];\nLL k; \nint check(int len){\n\trep(i,1,m) hd[i]=1,tl[i]=0;\n\tint q[M][N];memset(q,0,sizeof(q));\n\tint p[M][N];memset(p,0,sizeof(p));\n\trep(i,1,n){\n\t\tLL sum=0;\n\t\trep(j,1,m){\n\t\t\twhile(hd[j]<=tl[j]&&q[j][tl[j]]<=a[i][j]) tl[j]--;\n\t\t\tq[j][++tl[j]]=a[i][j],p[j][tl[j]]=i;\n\t\t\twhile(hd[j]<=tl[j]&&p[j][hd[j]]<=i-len) hd[j]++;\n\t\t\tif(i>=len) sum+=q[j][hd[j]],maxx[j]=q[j][hd[j]];\n\t\t}\n\t\tif(i>=len&&sum<=k){\n\t\t\trep(j,1,m) qaq[j]=maxx[j];\n\t\t\tqaq[m]+=k-sum;return 1;\n\t\t} \n\t}\n\treturn 0;\n}\nint main(){\n\trd(n);rd(m);scanf(\"%lld\",&k);\n\trep(i,1,n) rep(j,1,m)\n\t\trd(a[i][j]);\n\tint l=0,r=n,ans;\n\twhile(l<=r){\n\t\tint mid=(l+r)>>1;\n\t\tif(check(mid)) ans=mid,l=mid+1;\n\t\telse r=mid-1;\n\t}\n\trep(i,1,m) printf(\"%d \",qaq[i]);\n\treturn 0;\n}\n```\n\n~~\u606d\u559c\uff0c\u4e00\u9053\u6c34\u7d2b\uff01~~",
        "postTime": 1603114539,
        "uid": 106738,
        "name": "_Felix",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF514D \u3010R2D2 and Droid Army\u3011"
    }
]
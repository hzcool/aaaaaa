[
    {
        "content": "\u5f88\u5bb9\u6613\u60f3\u5230dp\n\n\u4ee4f[0/1/2][i][j][k]\u8868\u793a\u5f53\u524d\u7528\u7684\u662f\u54ea\u4e2a\u68cb\u5b50\uff0c\u5728(i,j)\u4f4d\u7f6e\uff0c\u5df2\u7ecf\u586b\u5b8c\u4e861~k\u4e2d\u7684\u6240\u6709\u6570\u7684\u6700\u5c0f\u82b1\u8d39\n\n\uff08\u7531\u4e8e\u8981\u6c42\u6b65\u6570\u6700\u5c0f\u540c\u65f6\u4ea4\u6362\u6b21\u6570\u6700\u5c11\u4e8e\u662f\u8003\u8651\u8bbe\u4e00\u4e2a\u8f83\u5927\u7684\u9608\u503cM, \u5c06\u6b65\u6570\u4e58\u4e0aM\u4f5c\u4e3a\u4ee3\u4ef7\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5b9e\u73b0\u53cc\u5173\u952e\u5b57\uff09\n\n\u4f46\u662f\u8fd9\u6837dp\u4f1a\u6709\u4e00\u4e2a\u95ee\u9898\uff1a\u4e0d\u77e5\u9053\u8f6c\u79fb\u7684\u987a\u5e8f\n\n\u4e8e\u662f\u8003\u8651\u7528\u6700\u77ed\u8def\n\n\u5bf9\u6bcf\u4e2a\u72b6\u6001\u5efa\u4e00\u4e2a\u70b9\uff0c\u5bf9\u6bcf\u79cd\u8f6c\u79fb\u8fde\u4e00\u6761\u8fb9\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u4e0d\u8003\u8651\u8f6c\u79fb\u987a\u5e8f\u6c42\u51fadp\u503c\u4e86\n\n\u5177\u4f53\u7684\uff0c\u8f6c\u79fb\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a\n\n\u4ea4\u6362\u68cb\u5b50\uff1a\u68cb\u5b50\u53d8\uff0c\u4f4d\u7f6e\u3001\u586b\u7684\u6570\u4e0d\u53d8\uff0c\u82b1\u8d39\u4e3aM+1\n\n\u79fb\u52a8\u68cb\u5b50\uff1a\u4f4d\u7f6e\u53d8\uff0c\u68cb\u5b50\u3001\u586b\u7684\u6570\u4e0d\u53d8\uff0c\u82b1\u8d39\u4e3aM\n\uff08\u9700\u8981\u5bf93\u79cd\u68cb\u5b50\u5355\u72ec\u8003\u8651\uff09\n\n\u586b\u6570\uff08\u5f53(i,j)\u4f4d\u7f6e\u7684\u6570\u4e3a\u4e0b\u4e00\u4e2a\u6570\uff09\uff1a\u586b\u7684\u6570\u53d8\uff0c\u68cb\u5b50\u3001\u4f4d\u7f6e\u4e0d\u53d8\uff0c\u82b1\u8d39\u4e3a0\n\n\u8dd1dijkstra\u5373\u53ef\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <queue>\n\nconst int N = 11;\nint p[N][N], px[N * N], py[N * N], n, vis[N * N * N * N * 3];\nint status[3][N][N][N * N], tot, head[N * N * N * N * 3];\nconst int M = 1000000;\ntypedef long long LL;\nLL dis[N * N * N * N * 3];\nconst int dx[8] = {-2, -2, -1, 1, 2, 2, 1, -1};\nconst int dy[8] = {1, -1, 2, 2, 1, -1, -2, -2};\nconst int _dx[4] = {1, -1, 1, -1};\nconst int _dy[4] = {1, 1, -1, -1};\nstruct edge {\n\tint to, nxt, cost;\n} e[9999999];\nvoid addedge(int x, int y, int z) {\n\te[++tot] = (edge) {y, head[x], z}; head[x] = tot;\n}\nint main() {\n\tstd::scanf(\"%d\", &n);\n\tfor (int i = 1; i <= n; i++)\n\t\tfor (int j = 1; j <= n; j++) {\n\t\t\tstd::scanf(\"%d\", &p[i][j]);\n\t\t\tpx[p[i][j]] = i;\n\t\t\tpy[p[i][j]] = j;\n\t\t}\n\tfor (int i = 0; i < 3; i++)\n\t\tfor (int j = 1; j <= n; j++)\n\t\t\tfor (int k = 1; k <= n; k++)\n\t\t\t\tfor (int l = 1; l <= n * n; l++) \n\t\t\t\t\tstatus[i][j][k][l] = ++tot;\n\tfor (int i = 1; i <= n; i++)\n\t\tfor (int j = 1; j <= n; j++) {\n\t\t\tfor (int k = 1; k <= n * n; k++) {\n\t\t\t\taddedge(status[0][i][j][k], status[1][i][j][k], M + 1);\n\t\t\t\taddedge(status[0][i][j][k], status[2][i][j][k], M + 1);\n\t\t\t\taddedge(status[1][i][j][k], status[0][i][j][k], M + 1);\n\t\t\t\taddedge(status[1][i][j][k], status[2][i][j][k], M + 1);\n\t\t\t\taddedge(status[2][i][j][k], status[0][i][j][k], M + 1);\n\t\t\t\taddedge(status[2][i][j][k], status[1][i][j][k], M + 1);\n\t\t\t\tif (k + 1 == p[i][j]) {\n\t\t\t\t\taddedge(status[0][i][j][k], status[0][i][j][k + 1], 0);\n\t\t\t\t\taddedge(status[1][i][j][k], status[1][i][j][k + 1], 0);\n\t\t\t\t\taddedge(status[2][i][j][k], status[2][i][j][k + 1], 0);\n\t\t\t\t}\n\t\t\t\tfor (int p = 1; p <= n; p++) {\n\t\t\t\t\tif (p != i)\n\t\t\t\t\t\taddedge(status[0][i][j][k], status[0][p][j][k], M);\n\t\t\t\t\tif (p != j)\n\t\t\t\t\t\taddedge(status[0][i][j][k], status[0][i][p][k], M);\n\t\t\t\t}\n\t\t\t\tfor (int p = 0; p < 8; p++) {\n\t\t\t\t\tint _x = i + dx[p], _y = j + dy[p];\n\t\t\t\t\tif (_x < 0 || _x > n || _y < 0 || _y > n) continue;\n\t\t\t\t\taddedge(status[1][i][j][k], status[1][_x][_y][k], M);\n\t\t\t\t}\n\t\t\t\tfor (int p = 1; p <= n; p++) {\n\t\t\t\t\tfor (int d = 0; d < 4; d++) {\n\t\t\t\t\t\tint _x = i + _dx[d] * p, _y = j + _dy[d] * p;\n\t\t\t\t\t\tif (_x < 0 || _x > n || _y < 0 || _y > n) continue;\n\t\t\t\t\t\taddedge(status[2][i][j][k], status[2][_x][_y][k], M);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\tstd::memset(dis, 0x3f, sizeof dis);\n\tstd::priority_queue<std::pair<LL, int> > q;\n\tfor (int i = 0; i < 3; i++) {\n\t\tdis[status[i][px[1]][py[1]][1]] = 0;\n\t\tq.push(std::make_pair(0, status[i][px[1]][py[1]][1]));\n\t}\n\twhile (q.size()) {\n\t\tint tmp = q.top().second; q.pop();\n\t\tif (vis[tmp]) continue;\n\t\tfor (int i = head[tmp]; i; i = e[i].nxt)\n\t\t\tif (dis[e[i].to] > dis[tmp] + e[i].cost) {\n\t\t\t\tdis[e[i].to] = dis[tmp] + e[i].cost;\n\t\t\t\tq.push(std::make_pair(-dis[e[i].to], e[i].to));\n\t\t\t}\n\t}\n\tLL ans = 0x3f3f3f3f3f3f3f3fLL;\n\tfor (int k = 0; k < 3; k++) \n\t\tans = std::min(ans, dis[status[k][px[n * n]][py[n * n]][n * n]]);\n\tstd::printf(\"%lld %lld\\n\", ans / M, ans % M);\n\treturn 0;\n}\n\n```",
        "postTime": 1541338943,
        "uid": 26127,
        "name": "Weng_Weijie",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1065D \u3010Three Pieces\u3011"
    },
    {
        "content": "\u5982\u679c\u4e0d\u559c\u6b22\u8fc7\u957f\u4ee3\u7801\u7684\u770b\u5b98\uff0c\u8bf7\u79fb\u6b65\u5176\u4ed6\u9898\u89e3...\n\n\u8fd9\u9898\u5176\u5b9e\u601d\u60f3\u6781\u5176\u7b80\u5355\uff1a\n\n\u68cb\u76d8\u95ee\u9898\u5e38\u89c1\u7684\u7b97\u6cd5\u90fd\u6bd4\u8f83\u66b4\u529b\uff0c\u5e38\u7528\u7684\u6709\u641c\u7d22\u548c\u72b6\u538bdp\n\n\u800c\u8fd9\u9053\u9898\u663e\u7136\u6ca1\u5565\u80fd\u72b6\u538b\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u641c\u7d22\n\n\u4f46\u662f\u4ec5\u4ec5\u641c\u7d22\u662f\u4e0d\u591f\u7684\uff0c\u56e0\u4e3a\u6709\u6781\u5927\u7684\u53ef\u80fd\u641c\u5230\u6b7b...\n\n\u6240\u4ee5\u6211\u4eec\u5f15\u5165\u8bb0\u5fc6\u5316\n\n\u8bbe\u72b6\u6001f[i][j][k][0/1/2]\u4ee3\u8868\u76ee\u524d\u5728\u70b9\uff08i\uff0cj\uff09\u5904\uff0c\u4e0a\u4e00\u4e2a\u5230\u8fbe\u7684\u70b9\uff08\u6ce8\u610f\u662f\u8fbe\u6210\u8981\u6c42\u800c\u975e\u7ecf\u8fc7\uff09\u7684\u7f16\u53f7\u4e3ak\uff0c\u76ee\u524d\u7684\u68cb\u5b50\u79cd\u7c7b\u4e3a1/2/3\u65f6\uff0c\u6240\u9700\u8981\u7684\u6700\u5c0f\u4ee3\u4ef7\n\n\u5f53\u7136\u8fd9\u8fd8\u4e0d\u591f\uff0c\u6211\u4eec\u8fd8\u8981\u4fdd\u8bc1\u5728\u4ee3\u4ef7\u6700\u5c0f\u65f6\u66f4\u6362\u68cb\u5b50\u6b21\u6570\u6700\u5c0f\uff0c\u6240\u4ee5\u6211\u4eec\u518d\u7528\u72b6\u6001g[i][j][k][0/1/2]\u66f4\u65b0\uff0c\u4e0b\u6807\u542b\u4e49\u4e0e\u4e0a\u8ff0\u76f8\u540c\uff0c\u8868\u793a\u5bf9\u5e94\u72b6\u6001\u6240\u9700\u7684\u6700\u5c0f\u68cb\u5b50\u66f4\u6362\u6b21\u6570\n\n\u6ce8\u610f\u4f18\u5148\u66f4\u65b0f\uff0c\u5728\u4fdd\u8bc1f\u5408\u6cd5\u7684\u60c5\u51b5\u4e0b\u7ef4\u62a4g\n\n\u7136\u540e\u7528bfs\u66f4\u65b0\u5373\u53ef\n\n```cpp\n#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <cstdlib>\n#include <iostream>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <map>\n#include <string>\n#include <vector>\n#include <ctime>\n#include <set>\n#include <deque>\n#include <bitset>\nusing namespace std;\nint dp[15][15][105][3];\nint g[15][15][105][3];\nint xp[105],yp[105];\nint maps[15][15];\nint dir[8][2]={{1,2},{2,1},{2,-1},{-1,2},{-1,-2},{-2,-1},{1,-2},{-2,1}};\nint n;\nbool check(int x,int y)\n{\n\tif(x>0&&x<=n&&y>0&&y<=n)\n\t{\n\t\treturn 1;\n\t}\n\treturn 0;\n}\nvoid bfs()\n{\n\tmemset(dp,0x3f,sizeof(dp));\n\tmemset(g,0x3f,sizeof(g));\n\tdp[xp[1]][yp[1]][1][0]=0;//\u8f66 \n\tdp[xp[1]][yp[1]][1][1]=0;//\u9a6c \n\tdp[xp[1]][yp[1]][1][2]=0;//\u8c61 \n\tg[xp[1]][yp[1]][1][0]=0;\n\tg[xp[1]][yp[1]][1][1]=0;\n\tg[xp[1]][yp[1]][1][2]=0;\n\tqueue <int> Qx,Qy,Qz,Qv;\n\tfor(int i=0;i<=2;i++)\n\t{\n\t\tQx.push(xp[1]);\n\t\tQy.push(yp[1]);\n\t\tQz.push(i);\n\t\tQv.push(1);\n\t}\n\twhile(!Qx.empty())\n\t{\n\t\tint ux=Qx.front();\n\t\tint uy=Qy.front();\n\t\tint uz=Qz.front();\n\t\tint uv=Qv.front();\n\t\tQx.pop();\n\t\tQy.pop();\n\t\tQz.pop();\n\t\tQv.pop();\n\t\tif(uv==n*n)\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\t\tif(uz==0)\n\t\t{\n\t\t\tfor(int i=1;i<=n;i++)\n\t\t\t{\n\t\t\t\tif(i==uy)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(maps[ux][i]==uv+1)\n\t\t\t\t{\n\t\t\t\t\tif(dp[ux][i][uv+1][uz]>dp[ux][uy][uv][uz]+1)\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[ux][i][uv+1][uz]=dp[ux][uy][uv][uz]+1;\n\t\t\t\t\t\tg[ux][i][uv+1][uz]=g[ux][uy][uv][uz];\n\t\t\t\t\t\tQx.push(ux);\n\t\t\t\t\t\tQy.push(i);\n\t\t\t\t\t\tQz.push(uz);\n\t\t\t\t\t\tQv.push(uv+1);\n\t\t\t\t\t}else if(dp[ux][i][uv+1][uz]==dp[ux][uy][uv][uz]+1&&g[ux][i][uv+1][uz]>g[ux][uy][uv][uz])\n\t\t\t\t\t{\n\t\t\t\t\t\tg[ux][i][uv+1][uz]=g[ux][uy][uv][uz];\n\t\t\t\t\t\tQx.push(ux);\n\t\t\t\t\t\tQy.push(i);\n\t\t\t\t\t\tQz.push(uz);\n\t\t\t\t\t\tQv.push(uv+1);\n\t\t\t\t\t}\n\t\t\t\t}else\n\t\t\t\t{\n\t\t\t\t\tif(dp[ux][i][uv][uz]>dp[ux][uy][uv][uz]+1)\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[ux][i][uv][uz]=dp[ux][uy][uv][uz]+1;\n\t\t\t\t\t\tg[ux][i][uv][uz]=g[ux][uy][uv][uz];\n\t\t\t\t\t\tQx.push(ux);\n\t\t\t\t\t\tQy.push(i);\n\t\t\t\t\t\tQz.push(uz);\n\t\t\t\t\t\tQv.push(uv);\n\t\t\t\t\t}else if(dp[ux][i][uv][uz]==dp[ux][uy][uv][uz]+1&&g[ux][i][uv][uz]>g[ux][uy][uv][uz])\n\t\t\t\t\t{\n\t\t\t\t\t\tg[ux][i][uv][uz]=g[ux][uy][uv][uz];\n\t\t\t\t\t\tQx.push(ux);\n\t\t\t\t\t\tQy.push(i);\n\t\t\t\t\t\tQz.push(uz);\n\t\t\t\t\t\tQv.push(uv);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor(int i=1;i<=n;i++)\n\t\t\t{\n\t\t\t\tif(i==ux)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(maps[i][uy]==uv+1)\n\t\t\t\t{\n\t\t\t\t\tif(dp[i][uy][uv+1][uz]>dp[ux][uy][uv][uz]+1)\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][uy][uv+1][uz]=dp[ux][uy][uv][uz]+1;\n\t\t\t\t\t\tg[i][uy][uv+1][uz]=g[ux][uy][uv][uz];\n\t\t\t\t\t\tQx.push(i);\n\t\t\t\t\t\tQy.push(uy);\n\t\t\t\t\t\tQz.push(uz);\n\t\t\t\t\t\tQv.push(uv+1);\n\t\t\t\t\t}else if(dp[i][uy][uv+1][uz]==dp[ux][uy][uv][uz]+1&&g[i][uy][uv+1][uz]>g[ux][uy][uv][uz])\n\t\t\t\t\t{\n\t\t\t\t\t\tg[i][uy][uv+1][uz]=g[ux][uy][uv][uz];\n\t\t\t\t\t\tQx.push(i);\n\t\t\t\t\t\tQy.push(uy);\n\t\t\t\t\t\tQz.push(uz);\n\t\t\t\t\t\tQv.push(uv+1);\n\t\t\t\t\t}\n\t\t\t\t}else\n\t\t\t\t{\n\t\t\t\t\tif(dp[i][uy][uv][uz]>dp[ux][uy][uv][uz]+1)\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][uy][uv][uz]=dp[ux][uy][uv][uz]+1;\n\t\t\t\t\t\tg[i][uy][uv][uz]=g[ux][uy][uv][uz];\n\t\t\t\t\t\tQx.push(i);\n\t\t\t\t\t\tQy.push(uy);\n\t\t\t\t\t\tQz.push(uz);\n\t\t\t\t\t\tQv.push(uv);\n\t\t\t\t\t}else if(dp[i][uy][uv][uz]==dp[ux][uy][uv][uz]+1&&g[i][uy][uv][uz]>g[ux][uy][uv][uz])\n\t\t\t\t\t{\n\t\t\t\t\t\tg[i][uy][uv][uz]=g[ux][uy][uv][uz];\n\t\t\t\t\t\tQx.push(i);\n\t\t\t\t\t\tQy.push(uy);\n\t\t\t\t\t\tQz.push(uz);\n\t\t\t\t\t\tQv.push(uv);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dp[ux][uy][uv][1]>dp[ux][uy][uv][uz]+1)\n\t\t\t{\n\t\t\t\tdp[ux][uy][uv][1]=dp[ux][uy][uv][uz]+1;\n\t\t\t\tg[ux][uy][uv][1]=g[ux][uy][uv][uz]+1;\n\t\t\t\tQx.push(ux);\n\t\t\t\tQy.push(uy);\n\t\t\t\tQz.push(1);\n\t\t\t\tQv.push(uv);\n\t\t\t}else if(dp[ux][uy][uv][1]==dp[ux][uy][uv][uz]+1&&g[ux][uy][uv][1]>g[ux][uy][uv][uz]+1)\n\t\t\t{\n\t\t\t\tg[ux][uy][uv][1]=g[ux][uy][uv][uz]+1;\n\t\t\t\tQx.push(ux);\n\t\t\t\tQy.push(uy);\n\t\t\t\tQz.push(1);\n\t\t\t\tQv.push(uv);\n\t\t\t}\n\t\t\tif(dp[ux][uy][uv][2]>dp[ux][uy][uv][uz]+1)\n\t\t\t{\n\t\t\t\tdp[ux][uy][uv][2]=dp[ux][uy][uv][uz]+1;\n\t\t\t\tg[ux][uy][uv][2]=g[ux][uy][uv][uz]+1;\n\t\t\t\tQx.push(ux);\n\t\t\t\tQy.push(uy);\n\t\t\t\tQz.push(2);\n\t\t\t\tQv.push(uv);\n\t\t\t}else if(dp[ux][uy][uv][2]==dp[ux][uy][uv][uz]+1&&g[ux][uy][uv][2]>g[ux][uy][uv][uz]+1)\n\t\t\t{\n\t\t\t\tg[ux][uy][uv][2]=g[ux][uy][uv][uz]+1;\n\t\t\t\tQx.push(ux);\n\t\t\t\tQy.push(uy);\n\t\t\t\tQz.push(2);\n\t\t\t\tQv.push(uv);\n\t\t\t}\n\t\t}else if(uz==1)//\u9a6c \n\t\t{\n\t\t\tfor(int i=0;i<8;i++)\n\t\t\t{\n\t\t\t\tint tx=ux+dir[i][0];\n\t\t\t\tint ty=uy+dir[i][1];\n\t\t\t\tif(tx<=0||tx>n||ty<=0||ty>n)\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(maps[tx][ty]==uv+1)\n\t\t\t\t{\n\t\t\t\t\tif(dp[tx][ty][uv+1][1]>dp[ux][uy][uv][1]+1)\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[tx][ty][uv+1][1]=dp[ux][uy][uv][1]+1;\n\t\t\t\t\t\tg[tx][ty][uv+1][1]=g[ux][uy][uv][1];\n\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\tQv.push(uv+1);\n\t\t\t\t\t\tQz.push(1);\n\t\t\t\t\t}else if(dp[tx][ty][uv+1][uz]==dp[ux][uy][uv][uz]+1&&g[tx][ty][uv+1][uz]>g[ux][uy][uv][uz])\n\t\t\t\t\t{\n\t\t\t\t\t\tg[tx][ty][uv+1][uz]=g[ux][uy][uv][uz];\n\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\tQz.push(uz);\n\t\t\t\t\t\tQv.push(uv+1);\n\t\t\t\t\t} \n\t\t\t\t}else\n\t\t\t\t{\n\t\t\t\t\tif(dp[tx][ty][uv][1]>dp[ux][uy][uv][1]+1)\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[tx][ty][uv][1]=dp[ux][uy][uv][1]+1;\n\t\t\t\t\t\tg[tx][ty][uv][1]=g[ux][uy][uv][1];\n\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\tQv.push(uv);\n\t\t\t\t\t\tQz.push(1);\n\t\t\t\t\t}else if(dp[tx][ty][uv][uz]==dp[ux][uy][uv][uz]+1&&g[tx][ty][uv][uz]>g[ux][uy][uv][uz])\n\t\t\t\t\t{\n\t\t\t\t\t\tg[tx][ty][uv][uz]=g[ux][uy][uv][uz];\n\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\tQz.push(uz);\n\t\t\t\t\t\tQv.push(uv);\n\t\t\t\t\t} \n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dp[ux][uy][uv][0]>dp[ux][uy][uv][uz]+1)\n\t\t\t{\n\t\t\t\tdp[ux][uy][uv][0]=dp[ux][uy][uv][uz]+1;\n\t\t\t\tg[ux][uy][uv][0]=g[ux][uy][uv][uz]+1;\n\t\t\t\tQx.push(ux);\n\t\t\t\tQy.push(uy);\n\t\t\t\tQz.push(0);\n\t\t\t\tQv.push(uv);\n\t\t\t}else if(dp[ux][uy][uv][0]==dp[ux][uy][uv][uz]+1&&g[ux][uy][uv][0]>g[ux][uy][uv][uz]+1)\n\t\t\t{\n\t\t\t\tg[ux][uy][uv][0]=g[ux][uy][uv][uz]+1;\n\t\t\t\tQx.push(ux);\n\t\t\t\tQy.push(uy);\n\t\t\t\tQz.push(0);\n\t\t\t\tQv.push(uv);\n\t\t\t}\n\t\t\tif(dp[ux][uy][uv][2]>dp[ux][uy][uv][uz]+1)\n\t\t\t{\n\t\t\t\tdp[ux][uy][uv][2]=dp[ux][uy][uv][uz]+1;\n\t\t\t\tg[ux][uy][uv][2]=g[ux][uy][uv][uz]+1;\n\t\t\t\tQx.push(ux);\n\t\t\t\tQy.push(uy);\n\t\t\t\tQz.push(2);\n\t\t\t\tQv.push(uv);\n\t\t\t}else if(dp[ux][uy][uv][2]==dp[ux][uy][uv][uz]+1&&g[ux][uy][uv][2]>g[ux][uy][uv][uz]+1)\n\t\t\t{\n\t\t\t\tg[ux][uy][uv][2]=g[ux][uy][uv][uz]+1;\n\t\t\t\tQx.push(ux);\n\t\t\t\tQy.push(uy);\n\t\t\t\tQz.push(2);\n\t\t\t\tQv.push(uv);\n\t\t\t}\n\t\t}else if(uz==2)\n\t\t{\n\t\t\tfor(int i=1;i<=n;i++)\n\t\t\t{\n\t\t\t\tint tx=ux+i;\n\t\t\t\tint ty=uy+i;\n\t\t\t\tif(check(tx,ty))\n\t\t\t\t{\n\t\t\t\t\tif(maps[tx][ty]==uv+1)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(dp[tx][ty][uv+1][2]>dp[ux][uy][uv][2]+1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdp[tx][ty][uv+1][2]=dp[ux][uy][uv][2]+1;\n\t\t\t\t\t\t\tg[tx][ty][uv+1][2]=g[ux][uy][uv][2];\n\t\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\t\tQv.push(uv+1);\n\t\t\t\t\t\t\tQz.push(2);\n\t\t\t\t\t\t}else if(dp[tx][ty][uv+1][uz]==dp[ux][uy][uv][uz]+1&&g[tx][ty][uv+1][uz]>g[ux][uy][uv][uz])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tg[tx][ty][uv+1][uz]=g[ux][uy][uv][uz];\n\t\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\t\tQz.push(uz);\n\t\t\t\t\t\t\tQv.push(uv+1);\n\t\t\t\t\t\t} \n\t\t\t\t\t}else\n\t\t\t\t\t{\n\t\t\t\t\t\tif(dp[tx][ty][uv][2]>dp[ux][uy][uv][2]+1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdp[tx][ty][uv][2]=dp[ux][uy][uv][2]+1;\n\t\t\t\t\t\t\tg[tx][ty][uv][2]=g[ux][uy][uv][2];\n\t\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\t\tQv.push(uv);\n\t\t\t\t\t\t\tQz.push(2);\n\t\t\t\t\t\t}else if(dp[tx][ty][uv][uz]==dp[ux][uy][uv][uz]+1&&g[tx][ty][uv][uz]>g[ux][uy][uv][uz])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tg[tx][ty][uv+1][uz]=g[ux][uy][uv][uz];\n\t\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\t\tQz.push(uz);\n\t\t\t\t\t\t\tQv.push(uv+1);\n\t\t\t\t\t\t} \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttx=ux+i;\n\t\t\t\tty=uy-i;\n\t\t\t\tif(check(tx,ty))\n\t\t\t\t{\n\t\t\t\t\tif(maps[tx][ty]==uv+1)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(dp[tx][ty][uv+1][2]>dp[ux][uy][uv][2]+1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdp[tx][ty][uv+1][2]=dp[ux][uy][uv][2]+1;\n\t\t\t\t\t\t\tg[tx][ty][uv+1][2]=g[ux][uy][uv][2];\n\t\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\t\tQv.push(uv+1);\n\t\t\t\t\t\t\tQz.push(2);\n\t\t\t\t\t\t}else if(dp[tx][ty][uv+1][uz]==dp[ux][uy][uv][uz]+1&&g[tx][ty][uv+1][uz]>g[ux][uy][uv][uz])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tg[tx][ty][uv+1][uz]=g[ux][uy][uv][uz];\n\t\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\t\tQz.push(uz);\n\t\t\t\t\t\t\tQv.push(uv+1);\n\t\t\t\t\t\t} \n\t\t\t\t\t}else\n\t\t\t\t\t{\n\t\t\t\t\t\tif(dp[tx][ty][uv][2]>dp[ux][uy][uv][2]+1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdp[tx][ty][uv][2]=dp[ux][uy][uv][2]+1;\n\t\t\t\t\t\t\tg[tx][ty][uv][2]=g[ux][uy][uv][2];\n\t\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\t\tQv.push(uv);\n\t\t\t\t\t\t\tQz.push(2);\n\t\t\t\t\t\t}else if(dp[tx][ty][uv][uz]==dp[ux][uy][uv][uz]+1&&g[tx][ty][uv][uz]>g[ux][uy][uv][uz])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tg[tx][ty][uv][uz]=g[ux][uy][uv][uz];\n\t\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\t\tQz.push(uz);\n\t\t\t\t\t\t\tQv.push(uv);\n\t\t\t\t\t\t} \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttx=ux-i;\n\t\t\t\tty=uy+i;\n\t\t\t\tif(check(tx,ty))\n\t\t\t\t{\n\t\t\t\t\tif(maps[tx][ty]==uv+1)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(dp[tx][ty][uv+1][2]>dp[ux][uy][uv][2]+1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdp[tx][ty][uv+1][2]=dp[ux][uy][uv][2]+1;\n\t\t\t\t\t\t\tg[tx][ty][uv+1][2]=g[ux][uy][uv][2];\n\t\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\t\tQv.push(uv+1);\n\t\t\t\t\t\t\tQz.push(2);\n\t\t\t\t\t\t}else if(dp[tx][ty][uv+1][uz]==dp[ux][uy][uv][uz]+1&&g[tx][ty][uv+1][uz]>g[ux][uy][uv][uz])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tg[tx][ty][uv+1][uz]=g[ux][uy][uv][uz];\n\t\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\t\tQz.push(uz);\n\t\t\t\t\t\t\tQv.push(uv+1);\n\t\t\t\t\t\t} \n\t\t\t\t\t}else\n\t\t\t\t\t{\n\t\t\t\t\t\tif(dp[tx][ty][uv][2]>dp[ux][uy][uv][2]+1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdp[tx][ty][uv][2]=dp[ux][uy][uv][2]+1;\n\t\t\t\t\t\t\tg[tx][ty][uv][2]=g[ux][uy][uv][2];\n\t\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\t\tQv.push(uv);\n\t\t\t\t\t\t\tQz.push(2);\n\t\t\t\t\t\t}else if(dp[tx][ty][uv][uz]==dp[ux][uy][uv][uz]+1&&g[tx][ty][uv][uz]>g[ux][uy][uv][uz])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tg[tx][ty][uv][uz]=g[ux][uy][uv][uz];\n\t\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\t\tQz.push(uz);\n\t\t\t\t\t\t\tQv.push(uv);\n\t\t\t\t\t\t} \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ttx=ux-i;\n\t\t\t\tty=uy-i;\n\t\t\t\tif(check(tx,ty))\n\t\t\t\t{\n\t\t\t\t\tif(maps[tx][ty]==uv+1)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(dp[tx][ty][uv+1][2]>dp[ux][uy][uv][2]+1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdp[tx][ty][uv+1][2]=dp[ux][uy][uv][2]+1;\n\t\t\t\t\t\t\tg[tx][ty][uv+1][2]=g[ux][uy][uv][2];\n\t\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\t\tQv.push(uv+1);\n\t\t\t\t\t\t\tQz.push(2);\n\t\t\t\t\t\t}else if(dp[tx][ty][uv+1][uz]==dp[ux][uy][uv][uz]+1&&g[tx][ty][uv+1][uz]>g[ux][uy][uv][uz])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tg[tx][ty][uv+1][uz]=g[ux][uy][uv][uz];\n\t\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\t\tQz.push(uz);\n\t\t\t\t\t\t\tQv.push(uv+1);\n\t\t\t\t\t\t}  \n\t\t\t\t\t}else\n\t\t\t\t\t{\n\t\t\t\t\t\tif(dp[tx][ty][uv][2]>dp[ux][uy][uv][2]+1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdp[tx][ty][uv][2]=dp[ux][uy][uv][2]+1;\n\t\t\t\t\t\t\tg[tx][ty][uv][2]=g[ux][uy][uv][2];\n\t\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\t\tQv.push(uv);\n\t\t\t\t\t\t\tQz.push(2);\n\t\t\t\t\t\t}else if(dp[tx][ty][uv][uz]==dp[ux][uy][uv][uz]+1&&g[tx][ty][uv][uz]>g[ux][uy][uv][uz])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tg[tx][ty][uv][uz]=g[ux][uy][uv][uz];\n\t\t\t\t\t\t\tQx.push(tx);\n\t\t\t\t\t\t\tQy.push(ty);\n\t\t\t\t\t\t\tQz.push(uz);\n\t\t\t\t\t\t\tQv.push(uv);\n\t\t\t\t\t\t} \n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(dp[ux][uy][uv][0]>dp[ux][uy][uv][uz]+1)\n\t\t\t{\n\t\t\t\tdp[ux][uy][uv][0]=dp[ux][uy][uv][uz]+1;\n\t\t\t\tg[ux][uy][uv][0]=g[ux][uy][uv][uz]+1;\n\t\t\t\tQx.push(ux);\n\t\t\t\tQy.push(uy);\n\t\t\t\tQz.push(0);\n\t\t\t\tQv.push(uv);\n\t\t\t}else if(dp[ux][uy][uv][1]>dp[ux][uy][uv][uz]+1&&g[ux][uy][uv][0]>g[ux][uy][uv][uz]+1)\n\t\t\t{\n\t\t\t\tg[ux][uy][uv][0]=g[ux][uy][uv][uz]+1;\n\t\t\t\tQx.push(ux);\n\t\t\t\tQy.push(uy);\n\t\t\t\tQz.push(0);\n\t\t\t\tQv.push(uv);\n\t\t\t}\n\t\t\tif(dp[ux][uy][uv][1]>dp[ux][uy][uv][uz]+1)\n\t\t\t{\n\t\t\t\tdp[ux][uy][uv][1]=dp[ux][uy][uv][uz]+1;\n\t\t\t\tg[ux][uy][uv][1]=g[ux][uy][uv][uz]+1;\n\t\t\t\tQx.push(ux);\n\t\t\t\tQy.push(uy);\n\t\t\t\tQz.push(1);\n\t\t\t\tQv.push(uv);\n\t\t\t}else if(dp[ux][uy][uv][1]==dp[ux][uy][uv][uz]+1&&g[ux][uy][uv][1]>g[ux][uy][uv][uz]+1)\n\t\t\t{\n\t\t\t\tg[ux][uy][uv][1]=g[ux][uy][uv][uz]+1;\n\t\t\t\tQx.push(ux);\n\t\t\t\tQy.push(uy);\n\t\t\t\tQz.push(1);\n\t\t\t\tQv.push(uv);\n\t\t\t}\n\t\t}\n\t}\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tscanf(\"%d\",&maps[i][j]);\n\t\t\txp[maps[i][j]]=i;\n\t\t\typ[maps[i][j]]=j;\n\t\t}\n\t}\n\tbfs();\n\tint ans=0x3f3f3f3f;\n\tint ret=0x3f3f3f3f;\n\tfor(int i=0;i<=2;i++)\n\t{\n\t\tif(ans>dp[xp[n*n]][yp[n*n]][n*n][i])\n\t\t{\n\t\t\tans=dp[xp[n*n]][yp[n*n]][n*n][i];\n\t\t\tret=g[xp[n*n]][yp[n*n]][n*n][i];\n\t\t}else if(ret>g[xp[n*n]][yp[n*n]][n*n][i]&&ans==dp[xp[n*n]][yp[n*n]][n*n][i])\n\t\t{\n\t\t\tret=g[xp[n*n]][yp[n*n]][n*n][i];\n\t\t}\n\t}\n\tprintf(\"%d %d\\n\",ans,ret);\n\treturn 0;\n}\n\n```",
        "postTime": 1540888538,
        "uid": 66905,
        "name": "leozhang",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1065D \u3010Three Pieces\u3011"
    },
    {
        "content": "### $\\text{Difficulty : 2200}$\n---\n### \u89e3\u9898\u601d\u8def\uff1a\n\n\u5b9e\u9645\u4e0a\u662f\u4e24\u4e2a $\\text{trick}$ \u7684\u8003\u3002\n\n\u8003\u8651\u53ea\u6709\u4e00\u4e2a\u68cb\u5b50\uff0c\u76f4\u63a5\u6839\u636e\u68cb\u5b50\u7684\u79fb\u52a8\u5efa\u56fe\uff0c\u7136\u540e\u8dd1\u4e00\u4e0b\u6700\u77ed\u8def\uff0c\u4f9d\u6b21\u8ba1\u7b97\u5c31\u884c\u4e86\u3002\n\n\u95ee\u9898\u5728\u4e8e\u6709\u4e09\u79cd\u68cb\u5b50\uff0c\u800c\u4e14\u8f6c\u5316\u662f\u6709\u4ee3\u4ef7\u7684\uff0c\u90a3\u4e0d\u59a8\u5c06\u4e00\u4e2a\u70b9\u5efa\u6210\u4e09\u4e2a\uff0c\u5206\u522b\u8868\u793a\u9a91\u58eb\uff08\u4e5f\u5c31\u662f\u9a6c\uff09\uff0c\u76f8\uff0c\u8f66\uff0c\u7136\u540e\u8fd9\u4e9b\u70b9\u4e4b\u95f4\u80fd\u591f\u5728\u540c\u4e00\u4e2a\u70b9\u4e0a\u8fdb\u884c\u8f6c\u5316\uff0c\u5176\u5b83\u7684\u90fd\u662f\u4e00\u6837\u7684\u3002\u8fd9\u5c31\u662f\u4e00\u4e2a\u7ecf\u5178\u7684\u5206\u5c42\u5efa\u56fe\u7684 $\\text{trick}$\u3002\n\n\u4f46\u662f\u8fb9\u6743\u76f4\u63a5\u6309\u7167 $1$ \u5efa\u7acb\u662f\u4f1a\u51fa\u95ee\u9898\u7684\uff0c\u4e0d\u4ec5\u65e0\u6cd5\u89e3\u51b3\u53cc\u5173\u952e\u5b57\u6392\u5e8f\uff0c\u5c31\u8fde\u8f93\u51fa\u8f6c\u5316\u6b21\u6570\u90fd\u505a\u4e0d\u5230\u3002\u8fd9\u91cc\u5c31\u7528\u5230\u7b2c\u4e8c\u4e2a $\\text{trick}$\uff0c\u5c06\u540c\u4e00\u5c42\u70b9\u4e0e\u70b9\u4e4b\u95f4\u7684\u8fb9\u6743\u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u5f88\u5927\u7684\u503c\uff0c\u7136\u540e\u5c06\u540c\u4e00\u4e2a\u70b9\u4e0a\u68cb\u5b50\u7684\u8f6c\u5316\u7684\u6743\u503c\u8bbe\u7f6e\u4e3a\u90a3\u4e2a\u503c\u52a0\u4e0a\u4e00\u4e2a\u5f88\u5c0f\u7684\u503c\uff0c\u8fd9\u6837\u5c31\u5b9e\u73b0\u4e86\u63d0\u53d6\u68cb\u5b50\u8f6c\u5316\u6b21\u6570\u548c\u53cc\u5173\u952e\u5b57\u4ee3\u4ef7\uff08\u65b9\u6cd5\u4e0d\u552f\u4e00\uff0c\u8fd9\u662f\u6bd4\u8f83\u7b80\u5355\u7684\u4e00\u79cd\uff09\u3002\n\n---\n### \u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nint n,a[1005][1005],p[10005],cnt,f[1005][1005],f2[10005][3],ans;\nint calc(int x,int y){\n\tif(x<=0||y<=0||x>n||y>n)return -1;\n\treturn 3*((x-1)*n+y);\n}\nvoid add(int x,int y,int num){\n\tf[x][y]=f[y][x]=num;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)\n\tfor(int j=1;j<=n;j++){\n\t\tscanf(\"%d\",&a[i][j]);\n\t\tp[a[i][j]]=calc(i,j);\n\t}\n\tcnt=3*n*n;\n\tfor(int i=1;i<=cnt;i++)\n\tfor(int j=1;j<=cnt;j++)\n\tf[i][j]=10000000;\n\t\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tif(calc(i+1,j+2)!=-1)add(calc(i,j),calc(i+1,j+2),1000);\n\t\t\tif(calc(i+1,j-2)!=-1)add(calc(i,j),calc(i+1,j-2),1000);\n\t\t\tif(calc(i-1,j+2)!=-1)add(calc(i,j),calc(i-1,j+2),1000);\n\t\t\tif(calc(i-1,j-2)!=-1)add(calc(i,j),calc(i-1,j-2),1000);\n\t\t\tif(calc(i+2,j+1)!=-1)add(calc(i,j),calc(i+2,j+1),1000);\n\t\t\tif(calc(i+2,j-1)!=-1)add(calc(i,j),calc(i+2,j-1),1000);\n\t\t\tif(calc(i-2,j+1)!=-1)add(calc(i,j),calc(i-2,j+1),1000);\n\t\t\tif(calc(i-2,j-1)!=-1)add(calc(i,j),calc(i-2,j-1),1000);\n\t\t\t//\u9a6c\u7684\u540c\u5c42\u5efa\u56fe\uff0c\u4e00\u5171\u516b\u4e2a\u65b9\u5411 \n\t\t\t\n\t\t\tfor(int k=1;k<=n;k++){\n\t\t\t\tif(calc(i+k,j+k)!=-1)add(calc(i,j)-1,calc(i+k,j+k)-1,1000);\n\t\t\t\tif(calc(i+k,j-k)!=-1)add(calc(i,j)-1,calc(i+k,j-k)-1,1000);\n\t\t\t\tif(calc(i-k,j+k)!=-1)add(calc(i,j)-1,calc(i-k,j+k)-1,1000);\n\t\t\t\tif(calc(i-k,j-k)!=-1)add(calc(i,j)-1,calc(i-k,j-k)-1,1000);\n\t\t\t}//\u76f8\u7684\u540c\u5c42\u5efa\u56fe \n\t\t\t\n\t\t\tfor(int k=1;k<=n;k++){\n\t\t\t\tif(calc(i,k)!=-1)add(calc(i,j)-2,calc(i,k)-2,1000);\n\t\t\t\tif(calc(k,j)!=-1)add(calc(i,j)-2,calc(k,j)-2,1000);\n\t\t\t}//\u8f66\u7684\u540c\u5c42\u5efa\u56fe \n\t\t\t\n\t\t\tadd(calc(i,j),calc(i,j)-1,1001);\n\t\t\tadd(calc(i,j),calc(i,j)-2,1001);\n\t\t\tadd(calc(i,j)-2,calc(i,j)-1,1001);\n\t\t\t//\u540c\u70b9\u68cb\u5b50\u8f6c\u5316 \n\t\t}\n\t}\n\tfor(int i=1;i<=cnt;i++)\n\tf[i][i]=0;\n\t\n\tfor(int k=1;k<=cnt;k++)\n\tfor(int i=1;i<=cnt;i++)\n\tif(i!=k)\n\tfor(int j=1;j<=cnt;j++)\n\tif(i!=j&&j!=k)\n\tf[i][j]=min(f[i][j],f[i][k]+f[k][j]);\n\t//\u5e73\u51e1\u7684\u6700\u77ed\u8def\uff0c\u53cd\u6b63\u70b9\u5c11\uff0c\u968f\u4fbf\u6b3a\u8d1f\u3002 \n\t\n\tfor(int i=2;i<=n*n;i++){\n\t\tf2[i][2]=min(f2[i-1][2]+f[p[i]  ][p[i-1]],min(f2[i-1][1]+f[p[i]  ][p[i-1]-1],f2[i-1][0]+f[p[i]  ][p[i-1]-2]));\n\t\tf2[i][1]=min(f2[i-1][2]+f[p[i]-1][p[i-1]],min(f2[i-1][1]+f[p[i]-1][p[i-1]-1],f2[i-1][0]+f[p[i]-1][p[i-1]-2]));\n\t\tf2[i][0]=min(f2[i-1][2]+f[p[i]-2][p[i-1]],min(f2[i-1][1]+f[p[i]-2][p[i-1]-1],f2[i-1][0]+f[p[i]-2][p[i-1]-2]));\n\t}\n\t//\u4e00\u4e2a\u4e00\u4e2a\u70b9\u8d70\u3002 \n\tans=min(min(f2[n*n][1],f2[n*n][0]),f2[n*n][2]);\n\tprintf(\"%d %d\\n\",ans/1000,ans%1000);\n\treturn 0;\n}\n```\n",
        "postTime": 1646833692,
        "uid": 223559,
        "name": "qxp101",
        "ccfLevel": 6,
        "title": "CF1065D Three Pieces \u9898\u89e3"
    },
    {
        "content": "$\\tt{codeforces}$ \u8bc4\u5206 $2200$\u3002\n\n\u8bbe $dp_{{s},{x},{y},{k}}=$ \u73b0\u5728\u4f7f\u7528\u7684\u662f\u7b2c $s$ \u79cd\u68cb\u5b50\uff0c\u73b0\u5728\u5728 $(x,y)$ \u4f4d\u7f6e\u5df2\u7ecf\u8d70\u8fc7 $k$ \u4e2a\u6570\u7684\u4ee3\u4ef7\u3002\n\n\u8981\u6c42\u5728\u65f6\u95f4\u6700\u77ed\u7684\u60c5\u51b5\u4e0b\u8981\u6c42\u6362\u68cb\u5b50\u79cd\u7c7b\u6570\u5c3d\u91cf\u5c11\u3002\n\n\u6362\u68cb\u5b50\u6b21\u6570\u4e0d\u53ef\u80fd\u8d85\u8fc7 $1000$\u3002\u6240\u4ee5\u53ef\u4ee5\u5c06\u79fb\u52a8\u4e00\u6b65\u7684\u4ee3\u4ef7\u8bbe\u4e3a $1000$\uff0c\u6362\u4e00\u6b21\u68cb\u5b50\u7684\u4ee3\u4ef7\u8bbe\u4e3a $1001$\u3002\n\n\u6211\u4eec\u53d1\u73b0\u4e0d\u597d\u8f6c\u79fb\uff0c\u6240\u4ee5\u5c31\u7528\u6700\u77ed\u8def\u8fdb\u884c\u8f6c\u79fb\u5373\u53ef\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<queue>\n#include<vector>\n#include<cstdlib>\nstd::vector<int> a[30005],b[30005];\nstd::priority_queue< std::pair<int,int> > pq;\nint dis[30005],vis[30005],n,m,ans,f[15][15],s,t;\nvoid add(int x,int y,int v){a[x].push_back(y);b[x].push_back(v);}\nint po(int x,int y,int k,int p){return ((k-1)*n*n+(y-1)*n+x-1)*3+p;}\nint dijkstra(int s,int t)\n{\n\tfor (int i=1;i<=n*n*n*n*3+2;i++) dis[i]=1000000000,vis[i]=0;\n\tdis[s]=0;pq.push(std::make_pair(-dis[s],s));\n\twhile (!pq.empty())\n\t{\n\t\tint v=pq.top().second;pq.pop();\n\t\tif (vis[v]) continue;\n\t\telse vis[v]=1;\n\t\tfor (int i=0;i<a[v].size();i++)\n\t\t{\n\t\t\tint u=a[v][i],w=b[v][i];\n\t\t\tif (dis[v]+w<dis[u])\n\t\t\t    dis[u]=dis[v]+w,pq.push(std::make_pair(-dis[u],u));\n\t\t}\n\t}\n\treturn dis[t];\n} \nvoid add_edge()\n{\n\tint sx,sy,ex,ey;\n\ts=n*n*n*n*3+1,t=n*n*n*n*3+2;\n\tfor (int i=1;i<=n;i++)\n\t    for (int j=1;j<=n;j++)\n\t        for (int k=1;k<=n*n;k++)\n\t        {\n\t        \tadd(po(i,j,k,1),po(i,j,k,2),1001);\n\t        \tadd(po(i,j,k,1),po(i,j,k,3),1001);\n    \t    \tadd(po(i,j,k,2),po(i,j,k,1),1001);\n\t        \tadd(po(i,j,k,2),po(i,j,k,3),1001);\n\t        \tadd(po(i,j,k,3),po(i,j,k,1),1001);\n\t    \t    add(po(i,j,k,3),po(i,j,k,2),1001);\n\t    \t    if (f[i][j]==k&&k!=1)\n\t    \t    {\n\t    \t    \tadd(po(i,j,k-1,1),po(i,j,k,1),0);\n\t        \t    add(po(i,j,k-1,2),po(i,j,k,2),0);\n\t    \t        add(po(i,j,k-1,3),po(i,j,k,3),0);\n\t\t\t\t}\n\t\t\t\tif (f[i][j]==1) sx=i,sy=j;\n\t\t\t\tif (f[i][j]==n*n) ex=i,ey=j;\n\t\t\t\t//1\n\t    \t    for (int p=1;p<=n;p++) if (p!=i) add(po(i,j,k,1),po(p,j,k,1),1000);\n\t    \t    for (int p=1;p<=n;p++) if (p!=j) add(po(i,j,k,1),po(i,p,k,1),1000);\n\t    \t    //2\n\t    \t    if (i+1<=n&&i+1>=1&&j+2<=n&&j+2>=1) add(po(i,j,k,2),po(i+1,j+2,k,2),1000);\n\t    \t    if (i-1<=n&&i-1>=1&&j+2<=n&&j+2>=1) add(po(i,j,k,2),po(i-1,j+2,k,2),1000);\n\t    \t    if (i+1<=n&&i+1>=1&&j-2<=n&&j-2>=1) add(po(i,j,k,2),po(i+1,j-2,k,2),1000);\n\t    \t    if (i-1<=n&&i-1>=1&&j-2<=n&&j-2>=1) add(po(i,j,k,2),po(i-1,j-2,k,2),1000);\n\t    \t    if (i+2<=n&&i+2>=1&&j+1<=n&&j+1>=1) add(po(i,j,k,2),po(i+2,j+1,k,2),1000);\n\t    \t    if (i-2<=n&&i-2>=1&&j+1<=n&&j+1>=1) add(po(i,j,k,2),po(i-2,j+1,k,2),1000);\n\t    \t    if (i+2<=n&&i+2>=1&&j-1<=n&&j-1>=1) add(po(i,j,k,2),po(i+2,j-1,k,2),1000);\n\t    \t    if (i-2<=n&&i-2>=1&&j-1<=n&&j-1>=1) add(po(i,j,k,2),po(i-2,j-1,k,2),1000);\n\t    \t    //3\n\t    \t    int x,y;\n\t\t\t\tx=i,y=j;\n\t    \t    for (;;)\n\t    \t    {\n\t    \t    \tx--,y--;\n\t    \t    \tif (x<=n&&x>=1&&y<=n&&y>=1) add(po(i,j,k,3),po(x,y,k,3),1000);\n\t    \t    \telse break;\n\t\t\t\t}\n\t\t\t\tx=i,y=j;\n\t\t\t\tfor (;;)\n\t    \t    {\n\t    \t    \tx++,y--;\n\t    \t    \tif (x<=n&&x>=1&&y<=n&&y>=1) add(po(i,j,k,3),po(x,y,k,3),1000);\n\t    \t    \telse break;\n\t\t\t\t}\n\t\t\t\tx=i,y=j;\n\t\t\t\tfor (;;)\n\t    \t    {\n\t    \t    \tx--,y++;\n\t    \t    \tif (x<=n&&x>=1&&y<=n&&y>=1) add(po(i,j,k,3),po(x,y,k,3),1000);\n\t    \t    \telse break;\n\t\t\t\t}\n\t\t\t\tx=i,y=j;\n\t\t\t\tfor (;;)\n\t    \t    {\n\t    \t    \tx++,y++;\n\t    \t    \tif (x<=n&&x>=1&&y<=n&&y>=1) add(po(i,j,k,3),po(x,y,k,3),1000);\n\t    \t    \telse break;\n\t\t\t\t}\n\t\t    }\n\tadd(s,po(sx,sy,1,1),0);\n\tadd(s,po(sx,sy,1,2),0);\n\tadd(s,po(sx,sy,1,3),0);\n\tadd(po(ex,ey,n*n,1),t,0);\n\tadd(po(ex,ey,n*n,2),t,0);\n\tadd(po(ex,ey,n*n,3),t,0);\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor (int i=1;i<=n;i++)\n\t    for (int j=1;j<=n;j++)\n\t        scanf(\"%d\",&f[i][j]);\n\tadd_edge();\n\tans=dijkstra(s,t);\n\tprintf(\"%d %d\\n\",ans/1000,ans%1000);\n\treturn 0;\n}\n```\n\n$98$ \u4e2a\u6d4b\u8bd5\u70b9\uff0c\u65f6\u95f4 $\\tt{2.29s}$\uff0c\u5185\u5b58 $\\tt{6.48MB}$\uff0c\u4ee3\u7801\u957f\u5ea6 $\\tt{3.36KB}$\u3002",
        "postTime": 1622337006,
        "uid": 36957,
        "name": "RainFestival",
        "ccfLevel": 0,
        "title": "codeforces 1065D"
    }
]
[
    {
        "content": "## \u9898\u89e3\n\n\u7531\u4e8e $\\gcd(n,dx)=\\gcd(n,dy)=1$\uff0c\u6240\u4ee5\u6070\u597d\u5728 $n$ \u6b65\u4ee5\u540e\u56de\u5230\u8d77\u70b9\u3002\n\n\u82e5\u4ece $(x,y)$ \u5411 $((x+dx) \\bmod n,(y+dy) \\bmod n)$ \u8fde\u8fb9\uff0c\u5219\u5f97\u5230\u4e86 $n$ \u4e2a\u4e92\u4e0d\u76f8\u4ea4\u7684\u5927\u5c0f\u4e3a $n$ \u7684\u73af\uff0c\u4e14\u73af\u4e0a\u6bcf\u4e2a\u70b9\u7684\u6a2a\u5750\u6807\u548c\u7eb5\u5750\u6807\u5206\u522b\u4e92\u4e0d\u76f8\u540c\u3002\n\n\u4efb\u52a1\u53d8\u4e3a\uff1a\u7ed9\u5b9a $m$ \u4e2a\u5173\u952e\u70b9\uff0c\u6c42\u8fd9 $n$ \u4e2a\u73af\u4e2d\u54ea\u4e00\u4e2a\u73af\u5305\u542b\u6700\u591a\u7684\u5173\u952e\u70b9\uff08\u82e5\u6709\u591a\u4e2a\u53d6\u4efb\u610f\u4e00\u4e2a\uff09\uff0c\u8f93\u51fa\u8fd9\u4e2a\u73af\u4e0a\u7684\u4efb\u610f\u4e00\u4e2a\u70b9\u3002\n\n\u8003\u8651**\u7528\u73af\u4e0a\u6a2a\u5750\u6807\u4e3a $0$ \u7684\u70b9\u7684\u7eb5\u5750\u6807\u5bf9\u73af\u8fdb\u884c\u7f16\u53f7**\uff0c\u4f8b\u5982\uff1a\u5305\u542b\u70b9 $(0,m)$ \u7684\u73af\u7684\u7f16\u53f7\u4e3a $m$\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a\u5173\u952e\u70b9 $(a,b)$\uff0c\u6211\u4eec\u53ea\u9700\u6c42\u51fa\u5b83\u6240\u5728\u73af\u7684\u7f16\u53f7\u5373\u53ef\u3002\n\n\u8bbe\u4ece\u6a2a\u5750\u6807\u4e3a $0$ \u7684\u70b9\u8d70 $k$ \u6b65\u53ef\u4ee5\u5230\u8fbe $(a,b)$\uff0c\u5219 $k \\cdot dx \\equiv a \\pmod n$\u3002\n\n\u79fb\u9879\u5f97 $k \\equiv a \\cdot (dx)^{-1} \\pmod n$\uff0c\u4e8e\u662f\u8fd9\u4e2a\u70b9\u6240\u5728\u73af\u7684\u7f16\u53f7\u4e3a $(y-k \\cdot dy) \\bmod n=(y-a \\cdot (dx)^{-1} \\cdot dy) \\bmod n$\u3002\n\n\u4f7f\u7528**\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5**\u6c42\u9006\u5143\uff0c\u5e76\u4f7f\u7528\u5927\u5c0f\u4e3a $n$ \u7684\u6876\u8ba1\u6570\u5373\u53ef\u89e3\u51b3\u672c\u9898\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n+m\\log{n})$\u3002\n\n## \u4ee3\u7801\n\n``` cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint x,y;\nint exgcd(int a,int b)\n{\n\tif(!b)\n\t{\n\t\tx=1,y=0;\n\t\treturn a;\n\t}\n\tint d=exgcd(b,a%b);\n\tint p=y,q=x-a/b*y;\n\tx=p,y=q;\n\treturn d;\n}\ninline int inverse(int v,int mod)\n{\n\tint d=exgcd(v,mod);\n\tassert(d==1);\n\treturn x+(x<0?mod:0);\n}\nconst int max_n=1e6+5;\nint cnt[max_n];\nint main()\n{\n\tint n,m,dx,dy;\n\tscanf(\"%d%d%d%d\",&n,&m,&dx,&dy);\n\tint inv=inverse(dx,n);\n\twhile(m--)\n\t{\n\t\tint x,y;\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tint k=1ll*(n-x)*inv%n;\n\t\t++cnt[(y+1ll*k*dy)%n];\n\t}\n\tint ans_id=-1,ans_cnt=0;\n\tfor(int i=0;i<n;++i)\n\t{\n\t\tif(cnt[i]>ans_cnt)\n\t\t{\n\t\t\tans_cnt=cnt[i];\n\t\t\tans_id=i;\n\t\t}\n\t}\n\tprintf(\"%d %d\\n\",0,ans_id);\n\treturn 0;\n}\n```",
        "postTime": 1631793499,
        "uid": 145355,
        "name": "wsyhb",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011CF492E Vanya and Field"
    },
    {
        "content": "\u5c51\u9898\u3002\n\n\u8003\u8651\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $ (x,y) $\uff0c\u5c06\u5176\u4e0e $ ((x+dx) \\mod n,(y+dy) \\mod n) $ \u8fde\u8fb9\u3002\n\n\u7b54\u6848\u5c31\u662f\u8fde\u901a\u5757\u4e2d\u6743\u503c\u6700\u5927\u7684\u90a3\u4e2a\u3002\n\n\u8003\u8651\u5bf9\u4e8e $ (x_1,y_1) $ \u548c $ (x_2,y_2) $ \u4e24\u4e2a\u70b9\u5728\u540c\u4e00\u4e2a\u8fde\u901a\u5757\u4e2d\u7684\u6761\u4ef6\u3002\n\n\u6761\u4ef6\u5c31\u662f\u540c\u4f59\u65b9\u7a0b $ x_1+x * dx \\equiv x_2 \\bmod n  $ \u548c $ y_1+y * dy \\equiv y_2 \\bmod n $ \u7684\u89e3\u662f\u540c\u4e00\u4e2a\u3002\n\n\u8003\u8651\u5316\u7b80\uff1a\n$$ x \\equiv \\frac {x_2-x_1} {dx} \\mod n $$\n$$ x \\equiv \\frac {y_2-y_1} {dy} \\mod n $$\n\u4e5f\u5c31\u662f\uff1a\n$$ \\frac {x_2-x_1} {dx} \\mod n \\equiv \\frac {y_2-y_1} {dy} \\mod n $$\n$$ \\frac {y_1} {dy} -\\frac {x_1} {dx} \\equiv \\frac {y_2} {dy} - \\frac {x_2} {dx} \\bmod n $$\n\u56e0\u4e3a\u503c\u57df\u53ea\u6709 $ O(n) $\uff0c\u5f00\u4e2a\u6876\u7edf\u8ba1\u4e00\u4e0b\u6570\u91cf\u5c31\u597d\u4e86\u3002\n\n\u56e0\u4e3a $ \\gcd(n,dx)=\\gcd(n,dy)=1 $\uff0c\u6240\u4ee5 $ dx $ \u548c $ dy $ \u7684\u9006\u5143\u53ef\u4ee5\u4f7f\u7528 exgcd \u8ba1\u7b97\u3002\n```cpp\n#include<cstdio>\ntypedef unsigned uint;\nconst uint M=1e6;\nuint n,m,id,dx,dy,x[M],y[M],sum[M];\nvoid exgcd(const uint&a,const uint&b,uint&x,uint&y){\n    if(!b)return void((x=1,y=0));exgcd(b,a%b,y,x);y-=a/b*x;\n}\ninline uint Del(const uint&a,const uint&b){\n\treturn b>a?a-b+n:a-b;\n}\nsigned main(){\n\tregister uint i,T,X,Y;\n\tscanf(\"%u%u%u%u\",&n,&m,&dx,&dy);\n\texgcd(dx,n,X,Y);dx=(X+n)%n;\n\texgcd(dy,n,X,Y);dy=(X+n)%n;\n\tfor(i=1;i<=m;++i){\n\t\tscanf(\"%u%u\",&X,&Y);\n\t\tT=Del(1ull*X*dx%n,1ull*Y*dy%n);\n\t\tif(!sum[T])x[T]=X,y[T]=Y;\n\t\tif(++sum[T]>sum[id])id=T;\n\t}\n\tprintf(\"%u %u\",x[id],y[id]);\n}\n```",
        "postTime": 1631694222,
        "uid": 160839,
        "name": "Prean",
        "ccfLevel": 7,
        "title": "\u6570\u5b66 \u6269\u5c55\u6b27\u51e0\u91cc\u5f97 CF492E\u9898\u89e3"
    },
    {
        "content": "[\u540c\u6b65\u53d1\u8868\u5728\u6211\u7684\u535a\u5ba2\u91cc\u54e6](https://foreverlasting1202.github.io/)\n\n\u778e\u641e\u6cd5\u3002\n\n\u611f\u89c9\u8fd9\u79cd\u601d\u7ef4\u9898\u6211\u5c31\u5b8c\u5168\u4e0d\u4f1a\u4e86\uff0c\u770b\u6765\u6211\u8fd8\u662f\u592a\u5f31\u4e86\u3002\n\n\u9996\u5148\u8981\u770b\u5230$gcd(n,dx)=gcd(n,dy)=1$\u8fd9\u4e2a\u91cd\u8981\u7684\u6761\u4ef6\u3002\n\n\u7136\u540e\u501f\u7528\u7f51\u4e0a\u7684\u4e00\u7bc7\u9898\u89e3\uff1a\n\n _\u5c31\u662f\u4ece\u67d0\u4e00\u884c\u548c\u67d0\u4e00\u5217\u7684\u4ea4\u70b9\u51fa\u53d1\uff0c\u8981\u91cd\u65b0\u56de\u5230\u8fd9\u4e2a\u4ea4\u70b9\uff0c\u5c31\u8981\u7ecf\u8fc7$n$\u6b65\u800c\u4e14\u8fd9$n$\u6b65\u8986\u76d6\u4e86\u6bcf\u4e00\u884c\u6bcf\u4e00\u5217\u3002\u6bcf\u4e2a\u5faa\u73af\u5fc5\u987b\u6bcf\u4e2a$x$\u8d70\u4e00\u6b21\u4ee5\u53ca\u6bcf\u4e2a$y$\u8d70\u4e00\u6b21\uff0c$n$\u4e2a\u683c\u5b50\u5c5e\u4e8e\u4e00\u7ec4\u5faa\u73af\u91cc\u9762\u7684\uff0c\u603b\u5171\u6709$n\\ast n$\u4e2a\u683c\u5b50\uff0c\u6240\u4ee5\u6709$n$\u7ec4\u5faa\u73af\u3002\u4e00\u7ec4\u5faa\u73af\u5185\u7684\u683c\u5b50\u662f\u7b49\u4ef7\u7684\u3002\u540c\u4e00\u884c\u5185\u7684$n$\u4e2a\u683c\u5b50\u5747\u6765\u81ea\u4e0d\u540c\u7684$n$\u7ec4\u3002_ \n \n\u4e8e\u662f\u6211\u4eec\u9884\u5904\u7406$a[i]$\u8868\u793a$x$\u5750\u6807\u79fb\u52a8$i$\uff0c$y$\u5750\u6807\u7684\u79fb\u52a8\u91cf $(mod n)$\n\n\u7136\u540e\u8003\u8651\u8d77\u70b9\u4e3a$(0,p)$\uff0c\u5212\u5206\u96c6\u5408\uff0c\u8f93\u51fa\u6700\u5927\u96c6\u5408\u5c31\u53ef\u4ee5\u4e86\u3002\n\ncode:\n```cpp\n//2019.2.24 by ljz\n#include<bits/stdc++.h>\nusing namespace std;\n#define res register int\n#define LL long long\n#define inf 0x3f3f3f3f\n#define eps 1e-15\ninline int read(){\n    res s=0;\n    bool w=0;\n    char ch=getchar();\n    while(ch<'0'||ch>'9'){if(ch=='-')w=1;ch=getchar();}\n    while(ch>='0'&&ch<='9')s=s*10+ch-'0',ch=getchar();\n    return w?-s:s;\n}\ninline void _swap(res &x,res &y){\n    x^=y^=x^=y;\n}\ninline int _abs(const res &x){\n    return x>0?x:-x;\n}\ninline int _max(const res &x,const res &y){\n    return x>y?x:y;\n}\ninline int _min(const res &x,const res &y){\n    return x<y?x:y;\n}\nconst int N=1e6+10;\nconst int M=1e5+10;\nnamespace MAIN{\n\tint n,m,dx,dy;\n\tint a[N],sum[N],mx,ans;\n\tinline void MAIN(){\n\t\tn=read(),m=read(),dx=read(),dy=read();\n\t\tfor(res j=0,x=0,y=0;j<n;j++)a[x]=y,x=(x+dx)%n,y=(y+dy)%n;\n\t\tfor(res i=1;i<=m;i++){\n\t\t\tres x=read(),y=read(),k=(y-a[x]+n)%n;\n\t\t\tsum[k]++;\n\t\t\tif(sum[k]>mx)mx=sum[k],ans=k;\n\t\t}\n\t\tprintf(\"0 %d\\n\",ans);\n\t}\n}\nint main(){\n    MAIN::MAIN();\n    return 0;\n}\n```",
        "postTime": 1551184030,
        "uid": 32878,
        "name": "foreverlasting",
        "ccfLevel": 7,
        "title": "\u3010CF492E\u3011Vanya and Field"
    }
]
[
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF1731E)\n\n\u4eca\u5929\u521a\u722c\u5c31\u8bc4\u7ea7\u4e86\uff0c\u8fd8\u662f\u84dd\uff0c\u6240\u4ee5\u5199\u4e2a\u9898\u89e3\u3002\n\n\u65e2\u7136\u6bcf\u6b21\u64cd\u4f5c\u8981\u8fde $k$ \u6761\u8fb9\uff0c\u8981\u6c42 $\\gcd(u,v)=k+1$\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u8981\u77e5\u9053\u6ee1\u8db3 $\\gcd(a,b)=k+1$ \u7684\u4e8c\u5143\u7ec4\u6709\u591a\u5c11\u4e2a\u3002\u56e0\u4e3a $\\gcd(a,b)=k+1$\uff0c\u90a3\u4e48 $\\gcd(\\frac a{k+1},\\frac b{k+1})=1$\u3002\u8fd9\u6837\u95ee\u9898\u5c31\u8f6c\u6362\u6210\u4e86 $a,b\\le \\frac n{k+1}$\uff0c$a$ \u4e0e $b$ \u4e92\u8d28\u7684\u4e8c\u5143\u7ec4\u6709\u591a\u5c11\u4e2a\u3002\u63d0\u5230\u4e92\u8d28\uff0c\u81ea\u7136\u4f1a\u60f3\u5230\u6b27\u62c9\u51fd\u6570\u3002\u6240\u4ee5\u53ef\u4ee5\u5f97\u51fa\uff0c\u4e8c\u5143\u7ec4\u4e2a\u6570 $=\\sum_{i=1}^{\\frac n{k+1}}\\varphi(i)$\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u7ebf\u6027\u7b5b\u7b5b\u51fa $1$ \u81f3 $n$ \u7684\u6b27\u62c9\u51fd\u6570\u503c\u5e76\u8bb0\u5f55\u524d\u7f00\u548c\u3002\u6839\u636e\u8d2a\u5fc3\uff0c\u6700\u4f18\u7b56\u7565\u80af\u5b9a\u662f\u4f18\u5148\u53d6\u66f4\u5927\u7684 $k$ \u503c\u3002\u6240\u4ee5\u518d\u4ece\u5927\u5230\u5c0f\u679a\u4e3e $k$\uff0c\u80fd\u8fde\u5c31\u8fde\u3002\u5177\u4f53\u7ec6\u8282\u53ef\u4ee5\u770b\u4ee3\u7801\u3002\n\n\u6ce8\u610f\u524d\u7f00\u548c\u6570\u7ec4\u8981\u5f00 `long long`\u3002\n\ncode\uff1a\n\n```cpp\nint n,k,pm[N],ph[N];ll m,sum[N];\nbool vis[N];\nvoid solve(){\n\tscanf(\"%d%lld\",&n,&m);\n\tll ans=0;\n\tfor(int i=n-1;i&&m;i--){\n\t\tif(i>m)continue;\n\t\tll x=sum[n/(i+1)]/i;//\u80fd\u64cd\u4f5c\u591a\u5c11\u6b21\n\t\tif(i*x>=m)ans+=(ll)(i+1)*(m/i),m%=i;//\u5982\u679c\u80fd\u8fde\u8fb9\u6570\u5927\u4e8e\u9700\u8981\u8fde\u7684\u8fb9\u6570\uff0c\u64cd\u4f5c\u76f4\u5230\u9700\u8981\u6570\u5c0f\u4e8ek\u4e3a\u6b62\n\t\telse ans+=(ll)(i+1)*x,m-=(ll)i*x;//\u5426\u5219\u5168\u8fde\n\t}\n\tif(m)puts(\"-1\");\n\telse printf(\"%lld\\n\",ans);\n}\nsigned main(){\n\tconst int mx=1e6;\n\tfor(int i=2;i<=mx;i++){\n\t\tif(!vis[i])pm[++k]=i,ph[i]=i-1;\n\t\tsum[i]=sum[i-1]+(ll)ph[i];\n\t\tfor(int j=1;j<=k&&pm[j]<=mx/i;j++){\n\t\t\tvis[i*pm[j]]=true;\n\t\t\tif(i%pm[j]==0){\n\t\t\t\tph[i*pm[j]]=ph[i]*pm[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tph[i*pm[j]]=ph[i]*(pm[j]-1);\n\t\t}\n\t}\n\tint t=1;\n\tscanf(\"%d\",&t);\n\twhile(t--)solve();\n}",
        "postTime": 1672918520,
        "uid": 578590,
        "name": "yinhee",
        "ccfLevel": 0,
        "title": "CF1731E\u9898\u89e3"
    },
    {
        "content": "[\u9898\u76ee\u94fe\u63a5](https://codeforces.com/problemset/problem/1731/E)\n\n\u4e3b\u8981\u8bb2\u4e00\u4e0b\u8bc1\u660e\u3002\n\n\u8003\u8651\u9009 $k$ \u6761\u8fb9\u80fd\u9009\u51e0\u4e2a\uff0c\u8fd9\u4e2a\u95ee\u9898\u4e5f\u5c31\u662f\u8bf4\u9009\u591a\u5c11\u5bf9 $1\\le x<y\\le n$ \u6ee1\u8db3 $\\gcd(x,y)=k+1$\u3002\u53ef\u4ee5\u628a\u5b83\u4eec\u90fd\u9664\u4ee5 $k+1$\uff0c\u5f97\u5230\u7684\u5c31\u662f\u6709\u591a\u5c11\u5bf9 $1\\le x<y\\le\\lfloor\\frac{n}{k+1}\\rfloor$ \u6ee1\u8db3 $\\gcd(x,y)=1$\uff0c\u8fd9\u4e2a\u663e\u7136\u662f $\\displaystyle\\sum_{i=2}^{\\lfloor\\frac{n}{k+1}\\rfloor}\\varphi(i)$\u3002\n\n\u8003\u8651\u5230\u5747\u644a\u5230 $k$ \u4e2a\u70b9\u4e0a\u6bcf\u4e2a\u70b9\u7684\u4ee3\u4ef7\u90fd\u662f $\\frac{k+1}{k}$\uff0c\u6240\u4ee5\u8981\u4ee3\u4ef7\u5c0f\u5219\u5fc5\u7136\u8981 $k$ \u5148\u9009\u5927\u7684\u3002\u8fd9\u91cc\u7ed9\u4e00\u4e2a\u8bc1\u660e\uff1a\n\n\u5047\u8bbe\u5b58\u5728\u67d0\u4e2a $x>y>z$ \u4f7f\u5f97\u9009 $x,z$ \u6bd4\u9009 $y$ \u52a3\u3002\u8bbe $y$ \u9009\u4e86 $c$ \u4e2a\uff0c\u5219\u6700\u574f\u60c5\u51b5\u4e0b $z$ \u9009 $c-1$ \u4e2a\uff0c$x$ \u9009 $1$ \u4e2a\u3002\u6b64\u65f6 $(c-1)z+x=cy$\uff0c\u5373\u4ee3\u4ef7\u76f8\u7b49\u3002\u6240\u4ee5\u5f97\u5230\u7ed3\u8bba\u3002\n\n\u7ebf\u6027\u7b5b\u6b27\u62c9\u51fd\u6570\uff0c\u505a\u4e2a\u524d\u7f00\u548c\uff0c\u6bcf\u6b21\u66b4\u529b\u7684\u5230\u7740\u626b\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n)$\uff0c\u6bd4\u5b98\u65b9\u9898\u89e3\u7684 $\\mathcal{O}(n\\log n)$ \u7684\u4f18\u3002[\u4ee3\u7801](https://codeforces.com/contest/1731/submission/188571676)\u3002",
        "postTime": 1673261183,
        "uid": 229669,
        "name": "Jerry__Jiang",
        "ccfLevel": 7,
        "title": "CF1731E Graph Cost"
    },
    {
        "content": "## \u524d\u7f6e\u829d\u58eb\n\n\u6b27\u62c9\u51fd\u6570 $\\varphi(x)$\uff1a\u8868\u793a\u5c0f\u4e8e\u7b49\u4e8e $x$ \u7684\u6b63\u6574\u6570\u4e2d\u4e0e $x$ \u4e92\u8d28\u7684\u6570\u7684\u4e2a\u6570\u3002\u53ef\u4ee5\u4f7f\u7528\u6b27\u62c9\u7b5b\u6c42\u89e3\u3002\n\n## \u9898\u76ee\u63cf\u8ff0\n\n\u7ed9\u5b9a $n$ \u4e2a\u70b9\u65e0\u8fb9\u7684\u65e0\u5411\u56fe\uff0c\u8fde\u63a5\u70b9 $u$ \u548c  $v$ \u9700\u8981\u6ee1\u8db3\u8fb9\u6743\u4e3a $\\gcd(u,v)$\uff0c\u6bcf\u6b21\u64cd\u4f5c\u53ef\u4ee5\u8fde\u63a5 $k$ \u6761\u8fb9\u6743\u4e3a $k+1$ \u7684\u8fb9\uff0c\u4ee3\u4ef7\u4e3a $k+1$ \uff0c\u95ee\u6070\u597d\u8fde\u63a5\u5230 $m$ \u6761\u8fb9\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n## \u5206\u6790\n\n\u56e0\u4e3a\u5bf9\u4e8e\u6bcf\u4e2a $k$\uff0c\u6bcf\u6b21\u4e00\u5b9a\u8981\u8fde $k$ \u6761\u624d\u5408\u6cd5\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u59a8\u8003\u8651\u4e00\u4e0b\u5bf9\u4e8e\u5f53\u524d\u7684 $n,k$\uff0c\u6700\u591a\u80fd\u8fde\u51e0\u6761\u8fb9\u3002\u4e5f\u5c31\u662f\u6c42 $1$ \u5230 $n$ \u5185\u6709\u591a\u5c11\u5bf9\u6570\u7684\u6700\u5927\u516c\u56e0\u6570\u4e3a $k+1$\u3002\n\n\u9996\u5148\uff0c\u8fd9\u5bf9\u6570\u663e\u7136\u4e00\u5b9a\u662f $k+1$ \u7684\u500d\u6570\uff0c\u6211\u4eec\u5148\u628a\u8fd9\u4e9b\u6570\u62ff\u51fa\u6765\u770b\u4e00\u770b\uff1a$k',2 k',3k'......\\lfloor\\dfrac{n}{k'}\\rfloor\\times k'$\uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u4f7f $k'=k+1$\u3002\u90a3\u4e48\u6700\u7ec8\u7b54\u6848\u80af\u5b9a\u8981\u4ece\u8fd9\u91cc\u9009\u3002\u5bf9\u4e8e\u4e24\u4e2a\u6570 $xk',yk'$\uff0c\u8003\u8651\u5230\u8981\u6c42 $\\gcd(xk',yk')=k'$\uff0c\u5373\u8981\u6c42 $\\gcd(x,y)=1$\uff0c\u4e5f\u5c31\u662f\u8981\u6c42\u4e24\u6570\u4e92\u8d28\u3002\n\n\u7136\u540e\u6211\u4eec\u7684\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u6c42 $1$ \u5230 $\\lfloor\\dfrac{n}{k'}\\rfloor$ \u5185\u4e92\u8d28\u7684\u6570\u5bf9\u7684\u4e2a\u6570\u3002\u770b\u5230\u4e92\u8d28\u7684\u6570\u5bf9\u7684\u4e2a\u6570\uff0c\u4e0d\u96be\u60f3\u5230\u6b27\u62c9\u51fd\u6570 $\\varphi$\u3002\u4f46\u662f\u8fd9\u91cc $\\varphi$ \u53ea\u80fd\u6c42\u4e0e\u5f53\u524d\u6570\u4e92\u8d28\u7684\u5c0f\u4e8e\u7b49\u4e8e\u5b83\u7684\u6570\u7684\u4e2a\u6570\u3002\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u9884\u5904\u7406\u3002\n\n\u6211\u4eec\u8bb0 $1$ \u5230 $p$ \u5185\u4e92\u8d28\u7684\u6570\u5bf9\u7684\u4e2a\u6570\u4e3a $f_x$\uff0c\u90a3\u4e48\u663e\u7136\u53ef\u4ee5\u5f97\u5230 $f_x=f_{x-1}+\\varphi(x),x\\ge 3$\u3002\u4e5f\u5c31\u662f\u6c42\u524d\u7f00\uff0c\u8fd9\u4e2a\u6211\u4eec\u53ea\u8981\u5728\u5904\u7406\u6b27\u62c9\u51fd\u6570\u4e4b\u540e\u987a\u4fbf\u6c42\u4e00\u4e0b\u5373\u53ef\u3002\u4f46\u662f\u6b64\u5904\u5f53 $x\\le 2$ \u65f6\u8fd8\u9700\u6ce8\u610f\uff0c\u6211\u4eec\u53ef\u4ee5\u7279\u522b\u5904\u7406\u4e00\u4e0b\uff0c\u5373 $f_1=0,f_2=1=\\varphi(2)$\u3002\n\n\u4e8e\u662f\u6211\u4eec\u77e5\u9053\u4e86\u6c42 $1$ \u5230 $n$ \u5185\u6709 $\\min(f_{\\lfloor\\frac{n}{k+1}\\rfloor},m)$ \u5bf9\u6570\u7684\u6700\u5927\u516c\u56e0\u6570\u4e3a $k+1$\u3002\u4f46\u662f\u6211\u4eec\u4e00\u6b21\u6027\u8981\u64cd\u4f5c $k$ \u6761\u8fb9\uff0c\u6240\u4ee5\u8981\u5bf9\u8fd9\u4e2a\u6570\u9664\u4ee5 $k$ \u624d\u5f97\u5230\u5bf9\u4e8e\u5f53\u524d $k$\uff0c\u6211\u4eec\u80fd\u64cd\u4f5c\u7684\u6b21\u6570\uff0c\u7531\u6b64\u5f97\u77e5\u5bf9\u603b\u8fb9\u6570\u4e0e\u603b\u4ee3\u4ef7\u7684\u8d21\u732e\u3002\n\n\u95ee\u9898\u662f\u6c42\u89e3\u6700\u5c0f\u4ee3\u4ef7\uff0c\u89c2\u5bdf\u4ee3\u4ef7\u516c\u5f0f\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u4ee3\u4ef7\u5176\u5b9e\u5c31\u662f\u672c\u6b21\u64cd\u4f5c\u5904\u7406\u7684\u8fb9\u6570 $+1$\u3002\u4f46\u6211\u4eec\u7684\u603b\u8fb9\u6570\u4e0d\u53d8\uff0c\u552f\u4e00\u7684\u53d8\u6570\u5728\u4e8e\u540e\u9762\u7684 $1$\u3002\u6240\u4ee5\u6211\u4eec\u8981\u4f7f\u64cd\u4f5c\u6b21\u6570\u6700\u5c11\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u8981\u4f7f\u6bcf\u6b21\u7684 $k$ \u5c3d\u91cf\u5927\uff0c\u679a\u4e3e\u65f6\u4ece\u5927\u81f3\u5c0f\u5373\u53ef\u3002\n\n## AC CODE\n```\n#include<bits/stdc++.h>\n#define maxn 2900001\n#define int long long\nusing namespace std;\nint T,n,m;\nint cnt,phi[maxn],p[maxn],fl[maxn];\nvoid solve(){\n\tint ans=0;\n\tscanf(\"%lld%lld\",&n,&m);\n\tfor(int i=n;i>=2;i--){//\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6b64\u5904\u679a\u4e3e\u7684\u662fk+1\n\t\tint num=min(phi[n/i],m)/(i-1);\n\t\tans+=num*i;\n\t\tm-=num*(i-1);\n\t}\n\tif(m) ans=-1;//\u6ce8\u610f\u7279\u5224\n\tprintf(\"%lld\\n\",ans);\n}\nsigned main(){\n\tscanf(\"%lld\",&T);\n\tphi[1]=1;\n\tfor(int i=2;i<=2e6;i++){\n\t\tif(fl[i]==0){\n\t\t\tp[++cnt]=i;\n\t\t\tphi[i]=i-1;\n\t\t}\n\t\tfor(int j=1;j<=cnt&&i*p[j]<=2e6;j++){\n\t\t\tfl[p[j]*i]=1;\n\t\t\tif(i%p[j]==0){\n\t\t\t\tphi[p[j]*i]=phi[i]*p[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse phi[p[j]*i]=phi[i]*phi[p[j]];\n\t\t}\n\t}\n\tphi[1]=0;\n\tfor(int i=3;i<=2e6;i++)\n\t phi[i]=phi[i-1]+phi[i];//\u6b64\u5904\u91c7\u7528\u7684\u662f\u76f4\u63a5\u8986\u76d6\u539f\u6765\u7684phi\u6570\u7ec4\n\twhile(T--){\n\t\tsolve();\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1682418990,
        "uid": 310639,
        "name": "yingkeqian9217",
        "ccfLevel": 5,
        "title": "CF1731E"
    },
    {
        "content": "\u9898\u610f\u7b80\u5316\uff1a\u70b9\u5bf9 $(i,j)$ \u4e4b\u95f4\u53ef\u4ee5\u8fde\u6743\u503c\u4e3a $\\gcd(i,j)$ \u7684\u8fb9\u3002\u6bcf\u6b21\u5efa\u8fb9\u53ea\u80fd\u5efa $k-1$ \u6761\u6743\u503c\u4e3a $k$ \u7684\u8fb9\uff0c\u4ee3\u4ef7\u4e3a $k$\u3002\u6c42 $n$ \u70b9 $m$ \u8fb9\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n\u5efa $k-1$ \u6761\u8fb9\uff0c$k$ \u7684\u4ee3\u4ef7\uff0c\u5373\uff1a$1+\\dfrac{1}{k-1}/$ \u8fb9\uff0c\u6240\u4ee5 $k$ \u8d8a\u5927\u5355\u4ef7\u8d8a\u5c0f\u3002\u8003\u8651\u8d2a\u5fc3\u3002\u5373\uff1a$k$ \u4ece\u5927\u5230\u5c0f\u5efa\u8fb9\u3002\n\n\u56e0\u4e3a\u4e0d\u540c\u6743\u503c\u7684\u8fb9\u4e4b\u95f4\u76f8\u4e92\u72ec\u7acb\u3002\n\n\u6240\u4ee5\u8bbe $num[k]$ \u8868\u793a\u8fb9\u6743\u4e3a $k$ \u7684\u8fb9\u7684\u6570\u91cf\u3002\u90a3\u4e48\u6700\u591a\u5efa $\\dfrac{num[k]}{k-1}$ \u6b21\u8fb9\u3002\n\n$num[k]=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^{i-1}[\\gcd(i,j)=k]=\\dfrac12(\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^n[\\gcd(i,j)=k]-1)$\n\n$\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^n[\\gcd(i,j)=k]=\\sum\\limits_{i'=1}^{\\lfloor\\frac{n}{k}\\rfloor}\\sum\\limits_{j'=1}^{\\lfloor\\frac{n}{k}\\rfloor}[\\gcd(i',j')=1]=2\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{k}\\rfloor}\\varphi(i)-1$\n\n\u7efc\u4e0a\uff1a$num[k]=\\sum\\limits_{i=1}^{\\lfloor\\frac{n}{k}\\rfloor}\\varphi(i)-1$\n\n\u9884\u5904\u7406\u6b27\u62c9\u51fd\u6570\uff0c\u7136\u540e\u524d\u7f00\u548c\u5373\u53ef\u3002\n\n$O(n)$\n\n\u6ce8\u610f\u6bcf\u6b21\u5bf9 $k$ \u5efa\u8fb9\u65f6\uff0c\u5efa\u8fb9\u6b21\u6570\u662f $\\min(\\dfrac{num[k]}{i-1},\\dfrac{m}{i-1})$\u3002\n\n$\\text{Code:}$\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define db double\n#define inf 2e18\n#define mp make_pair\n#define fi first\n#define se second\n#define pr printf\n#define ps puts\n#define pb push_back\n#define For(i,a,b) for(i=a;i<=b;i++)\n#define FOR(i,a,b) for(i=a;i>=b;i--)\nusing namespace std;\nconst int N=1e6+10;\nint n,m,cnt,a[N],b[N];\nint prime[N],e[N],nume[N],num[N];\nbool vis[N];\nint read(){\n\tint x=0,f=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9'){\n\t\tif(ch=='-') f=-1;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9'){\n\t\tx=(x<<1)+(x<<3)+(ch^48);\n\t\tch=getchar();\n\t}\n\treturn x*f;\n}\nvoid get_e(int n){\n    int i,j;\n    e[1]=1;\n    for(i=2;i<=n;i++){\n        if(!vis[i]){\n            prime[cnt++]=i;\n            e[i]=i-1;\n        } \n        for(j=0;prime[j]<=n/i;j++){\n            int t=prime[j]*i;\n            vis[t]=1;\n            if(i%prime[j]==0){\n                e[t]=e[i]*prime[j];\n                break;\n            }\n            e[t]=e[i]*(prime[j]-1);\n        }\n    }\n}\nvoid init(){\n\tint i;\n\tget_e(1e6);\n\tFor(i,1,1e6) nume[i]=nume[i-1]+e[i];\n}\nvoid solve(){\n\tint i,j,ans=0,len,len1,len2;\n\tFor(i,2,n) num[i]=nume[n/i]-1;\n\tFOR(i,n,2){\n\t\tif(i-1>m) continue;\n\t\tif(i-1>num[i]) continue;\n//\t\twhile(num[i]>=i-1&&m>=i-1){\n//\t\t\tans+=i;\n//\t\t\tnum[i]-=i-1;\n//\t\t\tm-=i-1;\n//\t\t}\n\t\tlen1=num[i]/(i-1);\n\t\tlen2=m/(i-1);\n\t\tlen=min(len1,len2);\n\t\tans+=len*i;\n\t\tm-=len*(i-1);\n\t}\n\tif(m) ps(\"-1\");\n\telse pr(\"%lld\\n\",ans);\n}\nsigned main(){\n\tint t,i,j;\n\tinit();\n\tt=read();\n\twhile(t--){\n\t\tn=read();m=read();\n\t\tsolve();\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1672917281,
        "uid": 225100,
        "name": "ice_in_sky",
        "ccfLevel": 0,
        "title": "CF1731E Graph Cost"
    }
]
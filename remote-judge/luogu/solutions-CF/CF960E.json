[
    {
        "content": "## CF960E\uff1a\n\n\n\n\u63d0\u4f9b\u4e00\u79cd\u7b80\u6d01\u6613\u61c2\u7684\u5199\u6cd5\u3002\n\n\u53ef\u7b80\u5316\u4e3a\u6811\u4e0a\u9ed1\u767d\u67d3\u8272\u3002\n\n\u9996\u5148\u60f3\u5230\u6811\u5f62DP\uff0c\u5982\u679c\u662f\u68f5\u6709\u6839\u6811\uff0c\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5982\u4e0b\uff1a\n$$\n{f[x][0]=f[y][1]+siz[y] \\times a[x]}\n$$\n\n$$\nf[x][1]=f[y][0]-siz[y]\\times a[x]\n$$\n\n\u8bb0 $siz[x]$ \u8868\u793a\u5b50\u6811\u5927\u5c0f\uff0c$f[x][0/1]$ \u8868\u793a\u5f53\u524d\u70b9\u989c\u8272\u4e3a $0/1$ \u65f6\u7684\u7b54\u6848\u3002\n\n\u56e0\u4e3a\u5bf9\u4e8e\u5b50\u6811\u4e2d\u6bcf\u4e2a\u70b9\u90fd\u4f1a\u6709\u4e00\u6761\u8def\u5f84\uff0c\u6240\u4ee5\u6bcf\u65b0\u52a0\u5165\u4e00\u4e2a\u70b9 $x$\uff0c\u8d21\u732e\u4e3a $siz[x]\\times a[x]\\times (-1)^{0/1}$\u3002\n\n\u73b0\u5728\u5c31\u6709\u4e86\u4e00\u4e2a $O(n^2)$ \u7684\u505a\u6cd5\u3002\n\n\u8003\u8651\u6362\u6839\u3002\n\n\u8bbe $g[x][0/1]$ \u8868\u793a\u4ee5\u5f53\u524d\u70b9 $x$ \u4e3a\u6839\u65f6\u7684\u7b54\u6848\u3002\n\n\u5c31\u662f\u51cf\u53bb\u7236\u8282\u70b9\u5bf9\u4ee5\u5f53\u524d\u70b9\u4e3a\u8d77\u70b9\u7684\u8def\u5f84\u7684\u8d21\u732e\uff0c\u518d\u52a0\u4e0a\u5f53\u524d\u70b9\u5e94\u4ea7\u751f\u7684\u8d21\u732e\u3002\n\n\u8f6c\u79fb\u65b9\u7a0b\u5982\u4e0b\uff1a\n$$\ng[y][0]=g[x][1]+siz[y]\\times a[x]+(n-siz[y])\\times a[y]\n$$\n\n$$\ng[y][1]=g[x][0]-siz[y]\\times a[x]-(n-siz[y])\\times a[y]\n$$\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$\u3002\n\n[code](https://codeforces.com/contest/960/submission/176151017)",
        "postTime": 1665990242,
        "uid": 467562,
        "name": "Awlgot",
        "ccfLevel": 0,
        "title": "CF960E Alternating Tree \u9898\u89e3"
    },
    {
        "content": "\u8fd9\u7bc7\u9898\u89e3\u53ef\u80fd\u662f\u5bf9\u697c\u4e0b\u7684\u8865\u5145\n\n\u6211\u4eec\u8003\u8651\u6bcf\u4e2a\u70b9\u80fd\u8d21\u732e\u591a\u5c11\u6b21\n\n![\u65e0\u6807\u9898.png](https://i.loli.net/2019/10/25/Evy74V8rpIaec1F.png)\n\n\u8bbe\u5f53\u524d\u8282\u70b9\u4e3a$x$,\u8def\u5f84\u6709\u4e09\u79cd\u60c5\u51b5\uff0c\u4e0a\u56fe\u5206\u522b\u5bf9\u5e94\u60c5\u51b5$1$\uff0c\u60c5\u51b5$2$\uff0c\u60c5\u51b5$3$\n\n1. $x$\u5b50\u6811\u5185$\\rightarrow x \\rightarrow x$\u5b50\u6811\u5916(\u5305\u62ec$x$)\n    \n2. $x$\u5b50\u6811\u5185(\u5305\u62ec$x$)$\\rightarrow x \\rightarrow x$\u5b50\u6811\u5185\n\n3. $x$\u5b50\u6811\u5916$\\rightarrow x \\rightarrow x$\u5b50\u6811\u5185\n\n\u6211\u4eec\u53ef\u4ee5\u5148\u5904\u7406\u51fa\u4e0e$x$\u7684\u8ddd\u79bb\u4e3a\u5076\u6570\u548c\u4e0e$x$\u7684\u8ddd\u79bb\u4e3a\u5947\u6570\u7684\u70b9\u7684\u4e2a\u6570\uff0c\u5206\u522b\u8bb0\u4f5c$f_x,g_x$\n\n\u90a3\u4e48$f_x = 1 + \\sum g_{to},g_x = 1 + \\sum f_{to}$($to$\u6307$x$\u7684\u5b69\u5b50)\n\n\u6211\u4eec\u6765\u8003\u8651\u6240\u6709\u60c5\u51b5\n\n1. $ans += V_x \\times (f_x-g_x) \\times (n-siz_x+1)$(\u53ef\u4ee5\u5728$x$\u7684\u5b50\u6811\u4e2d\u968f\u673a\u9009\u4e00\u4e2a\u5f80\u5b50\u6811\u5916\u9762\u8d70(\u53ef\u4ee5\u6307\u8d70\u5230$x$))\n\n2. $ans += V_x \\times (g_{to}-f_{to}) \\times (siz_x-siz_{to}-1)$\n  \n   $ans+= V_x \\times (siz_x-1)$(\u53ef\u4ee5\u4ece$x$\u76f4\u63a5\u5411\u4e0b\u8d70)\n\n3. \u6211\u4eec\u9700\u8981\u8bb0\u5f55$x$\u5b50\u6811\u5916\u4e0e$x$\u7684\u8ddd\u79bb\u4e3a\u5076\u6570\u548c\u4e0e$x$\u7684\u8ddd\u79bb\u4e3a\u5947\u6570\u7684\u70b9\u7684\u4e2a\u6570\uff0c\u5206\u522b\u8bb0\u4f5c$uf_x,ug_x$\n\n\t\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7$bfs$\u4ece\u4e0a\u5230\u4e0b\u6765\u5904\u7406,\u90a3\u4e48\n    \n   $uf_x=ug_{fa_x}+g_{fa_x}-f_x$\n    \n   $ug_x=uf_{fa_x}+f_{fa_x}-g_x$\n   \n   $ans += V_x \\times (uf_x-ug_x) \\times siz_x$\n   \n\u63a5\u4e0b\u6765\u653e\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define Fur(i,x,y) for(int i=x;i<=y;++i)\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nusing namespace std;\n#define N 200011\n#define mod 1000000007\nint n,cnt=0,head[N];\nlong long ans=0;\nstruct edge{\n    int to,nxt;\n}e[N*2];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint a[N],siz[N],f[N],g[N],fa[N];\nvoid dfs(int x){\n    f[x]=siz[x]=1;\n    fl(i,x)if(to!=fa[x]){\n        fa[to]=x;dfs(to);\n        siz[x]+=siz[to];\n        f[x]+=g[to];\n        g[x]+=f[to];\n    }\n    // 1:\n    ans=(ans+1ll*(f[x]-g[x])*(n-siz[x]+1)%mod*a[x]%mod)%mod;\n    //2:\n    ans=(ans+1ll*(siz[x]-1)*a[x]%mod)%mod;\n    fl(i,x)if(to!=fa[x])\n        ans=(ans+1ll*(g[to]-f[to])*(siz[x]-siz[to]-1)%mod*a[x]%mod)%mod;\n}\nint uf[N],ug[N];\nvoid bfs(){\n    queue<int>q;\n    fl(i,1)q.push(to);\n    while(!q.empty()){\n        int x=q.front();q.pop();\n        uf[x]=ug[fa[x]]+g[fa[x]]-f[x];\n        ug[x]=uf[fa[x]]+f[fa[x]]-g[x];\n        ans=(ans+1ll*(uf[x]-ug[x])*siz[x]%mod*a[x]%mod)%mod;\n        fl(i,x)if(to!=fa[x])q.push(to);\n    }\n}\nint main(){\n    ios::sync_with_stdio(0);\n    cin>>n;\n    Fur(i,1,n)cin>>a[i];\n    int x,y;\n    Fur(i,1,n-1)cin>>x>>y,add(x,y),add(y,x);\n    dfs(1);\n    bfs();\n    cout<<(ans+mod)%mod<<endl;\n}\n```",
        "postTime": 1572003683,
        "uid": 36532,
        "name": "localhost",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF960E \u3010Alternating Tree\u3011"
    },
    {
        "content": "## Problem\n\n[Alternating Tree\n](https://www.luogu.com.cn/problem/CF960E)\n\n## Sol\n\n\u6bd4\u8f83\u7b80\u5355\u7684\u9898\uff0c\u5c31\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9\u6765\u8bf4\uff0c\u4e00\u6761\u94fe\u4f1a\u6709\u4e24\u79cd\u60c5\u51b5\u8986\u76d6\u5230\u5b83\u3002\n\n$1.$ \u5b50\u6811\u5185\u7684\u70b9\u5230\u5f53\u524d\u70b9\u518d\u5230\u5b50\u6811\u5916\u3002\n\n$2.$ \u5b50\u6811\u5185\u7684\u70b9\u5230\u5f53\u524d\u70b9\u518d\u5230\u53e6\u4e00\u68f5\u5b50\u6811\u3002\n\n\u7136\u540e\u53c8\u770b\u5230\u8fd9\u4e2a\u70b9\u7684\u8d21\u732e\u4f1a\u548c $-1$ \u7684\u6b21\u65b9\u6709\u5173\uff0c\u8003\u8651\u5206\u5947\u5076\u5904\u7406\u3002\n\n\u7531\u4e8e\u5b83\u7684\u8d21\u732e\u53ea\u548c\u5230\u8d77\u70b9\u7684\u5947\u5076\u6027\u6709\u5173\uff0c\u7edf\u8ba1\u7b54\u6848\u5c31\u4e0d\u8bb2\u4e86\uff0c\u53cd\u6b63\u81ea\u5df1\u80fd\u63a8\u51fa\u6765\u3002\n\n\u5148\u4ee5 $1$ \u4e3a\u6839\u628a\u6574\u68f5\u5b50\u6811\u904d\u5386\u4e00\u904d\uff0c\u7136\u540e\u627e\u5230\u5b83\u5b50\u6811\u5185\u6709\u51e0\u4e2a\u70b9\uff08\u5305\u62ec\u5b83\u81ea\u5df1\uff09\u5230\u5b83\u7684\u8ddd\u79bb\u4e3a\u5947\u6570/\u5076\u6570\u3002\u626b\u7684\u65f6\u5019\u53ef\u4ee5\u987a\u4fbf\u628a\u7b2c\u4e8c\u79cd\u60c5\u51b5\u505a\u4e86\u3002\n\n\u81f3\u4e8e\u7b2c\u4e00\u79cd\u60c5\u51b5\uff0c\u53bb\u7528\u6362\u6839\u6c42\u51fa\u5b83\u5b50\u6811\u5916\u5230\u5b83\u7684\u8ddd\u79bb\u4e3a\u5947\u6570/\u5076\u6570\u7684\u70b9\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u628a\u7b2c\u4e00\u79cd\u60c5\u51b5\u4e5f\u5904\u7406\u4e86\u3002\n\n## Code\n\n```cpp\n#include<bits/stdc++.h>\n#define pb push_back\n#define int long long\nusing namespace std;\n\nconst int mod = 1e9 + 7;\n\nint n;\nint a[200010], f[200010][2], ans = 0;\nvector<int> G[200010];\n\nvoid dfs(int now, int fa)\n{\n    f[now][0] = 1;\n    for (auto i : G[now])\n    if (i ^ fa)\n    {\n        dfs(i, now);\n        int x, y;\n        x = f[i][0];\n        y = f[i][1];\n        ans = ans + (f[now][0] - f[now][1]) * (x + y) % mod * a[now] % mod;\n        ans = (ans % mod + mod) % mod;\n        ans = ans + (y - x) * (f[now][0] + f[now][1]) % mod * a[now] % mod;\n        ans = (ans % mod + mod) % mod;\n        f[now][0] += y;\n        f[now][1] += x;\n    }\n}\n\nvoid dfss(int now, int fa)\n{\n    if (now == 1)\n    {\n        for (auto i : G[now])\n        if (i ^ fa)\n        {\n            dfss(i, now);\n        }\n        return;\n    }\n    int x = f[fa][0] - f[now][1], y = f[fa][1] - f[now][0];//x -> even to fa\n    ans = ans + (f[now][0] - f[now][1]) * (x + y) % mod * a[now] % mod;\n    ans = (ans % mod + mod) % mod;\n    ans = ans + (y - x) * (f[now][0] + f[now][1]) % mod * a[now] % mod;\n    ans = (ans % mod + mod) % mod;\n    f[now][0] += y;\n    f[now][1] += x;\n    for (auto i : G[now])\n    if (i ^ fa)\n    {\n        dfss(i, now);\n    }\n}\n\nsigned main()\n{\n    cin >> n;\n    for (int i = 1;i <= n;i++)\n    {\n        cin >> a[i];\n    }\n    for (int i = 1;i < n;i++)\n    {\n        int x, y;\n        cin >> x >> y;\n        G[x].pb(y);\n        G[y].pb(x);\n    }\n    dfs(1, 0);\n    dfss(1, 0);\n    for (int i = 1;i <= n;i++)\n    {\n        ans = ((ans + a[i]) % mod + mod) % mod;\n    }\n    cout << ans;\n}\n```",
        "postTime": 1670913776,
        "uid": 173424,
        "name": "Hovery",
        "ccfLevel": 6,
        "title": "CF960E"
    },
    {
        "content": "# \u9898\u610f\n\u7ed9\u51fa\u4e00\u9897\u6709\u70b9\u6743\u7684\u6811\uff0c\u6811\u4e0a\u6709\u5411\u8def\u5f84 $\\{a_1,a_2,\\cdots,a_k \\}$ \u7684\u6743\u503c\u88ab\u5b9a\u4e49\u4e3a\uff1a\n$$\n\\sum_{i=1}^k(-1)^{i+1}\\cdot w_{a_i}\n$$\n\n\u6c42\u6811\u4e0a\u6240\u6709\u8def\u5f84\u7684\u6743\u503c\u548c\u3002\n\n# \u601d\u8def\n\u62ff\u6765\u7ec3\u4e60\u70b9\u5206\u6cbb\u771f\u7684\u5f88\u4e0d\u9519\u3002\n\n\u8fd9\u4e2a\u9898\u662f\u8be2\u95ee\u6811\u4e0a\u6240\u6709\u8def\u5f84\u548c\uff0c\u9996\u5148\u60f3\u5230\u70b9\u5206\u6cbb\uff0c\u8003\u8651\u5982\u679c\u5feb\u901f\u6c42\u51fa\u6765\u7ecf\u8fc7\u6839\u8282\u70b9\u7684\u7b54\u6848\u3002\n\n\u9996\u5148\u4e0d\u96be\u60f3\u5230\u6309\u987a\u5e8f\u8003\u8651\u5b50\u6811\uff0c\u8003\u8651\u4e00\u4e2a\u7684\u8d21\u732e\u540e\u52a0\u4e00\u4e2a\uff08\u8fd9\u4e2a\u4f1a\u70b9\u5206\u6cbb\u7684\u5e94\u8be5\u90fd\u4f1a\u5427\uff09\u3002\n\n\u60f3\u5982\u4f55\u7ef4\u62a4\u8fd9\u4e2a\u8d21\u732e\uff0c\u4e0d\u96be\u60f3\u5230\u5bf9\u6811\u4e0a\u8def\u5f84\u6309\u7167\u7ed3\u5c3e\u8282\u70b9\u6df1\u5ea6\u7684\u5947\u5076\u6027\u5206\u5c42\uff0c\u5219\u7b54\u6848\u5c31\u5f88\u597d\u7edf\u8ba1\u3002\n\n\u7531\u4e8e\u9650\u5236\u8def\u5f84\u5fc5\u987b\u7ecf\u8fc7\u6839\u8282\u70b9\uff0c\u6240\u4ee5\u6211\u4eec\u53d1\u73b0\u5408\u6cd5\u8def\u5f84\u4e24\u4e2a\u7aef\u70b9\u5fc5\u987b\u5904\u5728\u5947\u5076\u6027\u76f8\u540c\u7684\u5c42\u4e0a\uff08\u6839\u8282\u70b9\u4e24\u4fa7\u7684\u6b63\u8d1f\u5fc5\u987b\u4fdd\u6301\u4e00\u81f4\uff09\u3002\n\n\u4e8e\u662f\u53ea\u9700\u8981\u7ef4\u62a4\u4e00\u4e0b\u5df2\u7ecf\u904d\u5386\u8fc7\u90e8\u5206\u7684\u5947\u6570/\u5076\u6570\u6df1\u5ea6\u7684\u8def\u5f84\u6743\u503c\u548c\uff0c\u6570\u91cf\u548c\uff0c\u8bb0\u4e3a $sum1,sum2,siz1,siz2$\u3002\n\n\u5219\u5728\u7b97\u8d21\u732e\u7684\u65f6\u5019\u76f4\u63a5\u5927\u529b\u8ba8\u8bba\u53d6\u5bf9\u5e94\u5947\u5076\u6027\u7684\u8282\u70b9\u8003\u8651\u5373\u53ef\uff0c\u5982\u679c\u5f53\u524d\u662f\u5947\u6570\uff0c\u5219\u7b97\u4e0a\u8d21\u732e $sum1+siz1\\times dis$\uff0c\u5076\u6570\u5c31\u6ce8\u610f\u4e86\uff0c\u6211\u4eec\u7684 $dis$ \u662f\u6309\u7167\u6839\u8282\u70b9\u662f\u6b63\u6570\u7684\u60c5\u51b5\u6c42\u7684\uff0c\u6b64\u65f6\u5f00\u5934\u8282\u70b9\u7684\u6743\u503c\u662f\u8d1f\u7684\uff0c\u4e0d\u5408\u6cd5\uff0c\u6240\u4ee5\u8def\u5f84\u8d21\u732e\u6574\u4f53\u4e58\u4e0a $-1$ \u5373\u53ef\u3002\n\n\u5b9e\u73b0\u7ec6\u8282\u770b\u4ee3\u7801\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u5feb\u4e50\u5206\u6cbb\u4e0b\u53bb\u4e86\u3002\n\n# code\n\u8fd9\u91cc\u6709\u4e00\u4e2a\u5751\u70b9\uff0c\u6c42\u91cd\u5fc3\u8981\u91cd\u65b0\u6c42 siz\uff0c\u867d\u7136\u4e0d\u6c42\u590d\u6742\u5ea6\u6b63\u786e\uff0c\u4f46\u662f\u6709\u4e00\u4e2a\u8f83\u5927\u7684\u5e38\u6570\uff0c\u8fd9\u91cc\u5728\u5904\u7406\u5f53\u524d\u8282\u70b9\u7684\u65f6\u5019\u987a\u624b\u91cd\u65b0\u6c42\u4e00\u904d siz \u5373\u53ef\uff0c\u5426\u5219\u4f1a TLE 72\u3002\n\n```cpp\nconst int MAXN=2e5+10;\nvector<int>e[MAXN];\nint siz[MAXN],son[MAXN];\nbool book[MAXN];\nint rt,sum;\nvoid getroot(int u,int fa)\n{\n\tsiz[u]=1,son[u]=0;\n\tfor(auto&v:e[u])if(v^fa&&!book[v])\n\t{\n\t\tgetroot(v,u);\n\t\tsiz[u]+=siz[v];\n\t\tcmax(son[u],siz[v]);\n\t}\n\tcmax(son[u],sum-siz[u]);\n\tif(son[u]<son[rt])rt=u;\n \n}\nint a[MAXN];\nll ans=0;\nll s1=0,s2=0;\nint siz1,siz2;\nvoid getdis(int u,int fa,int op,int d)\n{\n\tif(op)(d+=a[u])%=mod,ans+=(s1+(ll)d*siz1)%mod;\n\telse (d+=mod-a[u])%=mod,ans+=mod-(s2+(ll)d*siz2)%mod;\n\tfor(auto& v:e[u])\n\t{\n\t\tif(v==fa||book[v])continue;\n\t\tgetdis(v,u,op^1,d);\t\n\t}\t\n}\nvoid insert(int u,int fa,int op,int d)\n{\n\tif(op)(d+=a[u])%=mod,siz1++,(s1+=d)%=mod;\n\telse (d+=mod-a[u])%=mod,siz2++,(s2+=d)%=mod;\n\tsiz[u]=1;\n\tfor(auto& v:e[u])\n\t{\n\t\tif(v==fa||book[v])continue;\n\t\tinsert(v,u,op^1,d);\t\n\t\tsiz[u]+=siz[v];\n\t}\n}\nvoid getans(int u)\n{\n\ts1=0,s2=0;\n\tsiz1=siz2=0;\n\ts1+=a[u],siz1++;\n\tfor(auto& v:e[u])if(!book[v])\n\t{\t\n\t\tgetdis(v,u,0,0);\n\t\tinsert(v,u,0,a[u]);//\u8fd9\u91cc\u5e26\u4e0a\u6839\u8282\u70b9\u7684\u6743\u503c\uff0c\u539f\u56e0\u663e\u7136\n\t\tsiz[u]+=siz[v];//\u5728\u8fd9\u91cc\u987a\u624b\u6c42\u4e00\u4e0b\u5f53\u524d\u6811\u6b63\u786e\u7684 siz\n\t}\n}\nvoid dfs(int u)\n{\n\tbook[u]=1;\n\tgetans(u);\n\tfor(auto&v:e[u])if(!book[v])\n\t{\n\t\trt=0,sum=siz[v],getroot(v,u);\t\n\t\tdfs(rt);\n\t}\n}\nsigned main()\n{\n\tson[0]=1e9;\n\tint n=R();\n\tfor(int i=1;i<=n;i++)a[i]=(R()%mod+mod)%mod;\n\tint u,v;\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tu=R(),v=R();\n\t\te[u].push_back(v);\n\t\te[v].push_back(u);\n\t}\n\tsum=n;\n\n\tdfs(1);\n\tans=ans*2%mod;//\u6709\u5411\uff0c\u6240\u4ee5\u4e58 2\n\tfor(int i=1;i<=n;i++)ans+=a[i];//\u4e00\u4e2a\u70b9\u4e5f\u7b97\u8def\u5f84\uff01\n\tcout<<ans%mod;\n\treturn 0;\n}\n```\n",
        "postTime": 1667357235,
        "uid": 571229,
        "name": "__stick",
        "ccfLevel": 7,
        "title": "CF960E"
    },
    {
        "content": "~~\u4e0d\u77e5\u9053\u4e3a\u5565\u4eca\u5929\u7a81\u7136\u60f3\u6c34\u7bc7\u9898\u89e3~~\n\n\u611f\u89c9\u6bd4\u8f83\u5178\u578b\u7684\u6811\u4e0adp\u3002\u3002\n\n\u8003\u8651\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u70b9\u7684\u6743\u503c\u4f1a\u88ab\u8bb0\u5f55\u591a\u5c11\u6b21\uff08\uff08\n\n\uff08\u7a0d\u5fae\u601d\u8003\u4e00\u4e0b\u4f1a\u53d1\u73b0\uff09\u7ecf\u8fc7\u70b9$u$\u7684\u8def\u7ebf\u4e00\u5b9a\u53ea\u6709\u4e09\u79cd\u60c5\u51b5\n\n1. \u4ece$u$\u4e3a\u6839\u7684\u5b50\u6811\u4e0a\u7684\u4e00\u70b9\u5230\u6811\u4e2d\u9664\u5f00$u$\u5b50\u6811\u7684\u70b9\uff08\u4e0b---$u$---\u4e0a\uff09\n2. \u8bbe$u$\u7684\u513f\u5b50$v$\uff0c\u4ece$v$\u7684\u5b50\u6811\u4e2d\u9009\u62e9\u4e00\u70b9\u5230\u9664\u4e86$v$\u7684\u53e6\u5916\u4e00\u4e2a\u513f\u5b50\u7684\u5b50\u6811\u4e0a\u7684\u4e00\u70b9\uff08\u4e0b---$u$---\u53e6\u4e00\u4e2a\u4e0b\uff09\n3. \u4ece\u9664\u4e86$u$\u4e3a\u6839\u7684\u5b50\u6811\u4e0a\u7684\u70b9\u5230$u$\u518d\u5230$u$\u4e3a\u6839\u7684\u5b50\u6811\u4e0a\u7684\u4e00\u70b9\uff08\u4e0a---$u$---\u4e0b\uff09\n\n\u8fd9\u91cc\u8981\u6ce8\u610f\uff0c\u7531\u4e8e\u9898\u76ee\u8fd9\u4e2a\u201c\u6709\u5411\u6743\u503c\u201d\u7684\u7279\u6b8a\u6027\uff0c\u7b2c\u4e00\u79cd\u548c\u7b2c\u4e09\u4e2d\u4e0d\u80fd\u5408\u5e76\u3002\u3002\u56e0\u4e3a\u4ece\u4e0b\u60f3\u4e0a$u$\u7684\u6743\u503c\u53ef\u80fd\u662f\u6b63\u7684\uff0c\u4f46\u662f\u4ece\u4e0a\u5411\u4e0b\u5c31\u4e0d\u4e00\u5b9a\u4e86\u5462\uff01\n\n\u90a3\u4e48\u600e\u4e48\u8ba8\u8bba\u4e0a\u9762\u7684\u4e09\u79cd\u60c5\u51b5\u5462\uff1f\u4e0b\u9762\u5c31\u662f\u6811\u5f62dp\u7684\u5957\u8def\u4e86\n\n\u8003\u8651\u8bb0\u5f55\u4e00\u4e2aS[x][0/1]\u8868\u793a$x$\u70b9\u4e3a\u6839\u7684\u5b50\u6811\u4e0a\uff1a\n\n0\uff1a \u6709\u591a\u5c11\u4e2a\u70b9\u5230$x$\u8ddd\u79bb\u4e3a\u5076\u6570  \n1\uff1a \u6709\u591a\u5c11\u4e2a\u70b9\u5230$x$\u8ddd\u79bb\u4e3a\u5947\u6570\n\n\u9996\u5148\u8fd9\u4e2a\u6570\u7ec4\u662f\u53ef\u4ee5dp\u7684\u3002\u3002\u56e0\u4e3a\u6bd5\u7adf\u53ea\u7edf\u8ba1\u5b50\u6811\u4e0a\u7684\u6ca1\u6709\u540e\u6548\u6027\n\n\u90a3\u4e48\u5bf9\u4e8e\u7b2c\u4e00\u79cd\u60c5\u51b5\uff08\u663e\u7136\uff09\n\n$ans = ans + (s[u][0]-s[u][1]) \\times (n - siz[u] + 1) \\times V[u]$\n\n\u7b2c\u4e8c\u79cd\u60c5\u51b5\u5c31\u6709\u70b9\u5c0f\u5751\u4e86\uff0c\u6ce8\u610f$u$\u672c\u8eab\u5411\u4e0b\u7684\u60c5\u51b5\u4e5f\u9700\u8981\u8ba8\u8bba\u8fdb\u53bb\u3002\u3002\u90a3\u4e48\u5bf9\u4e8e\u513f\u5b50$v$\u6709\uff1a \uff08\u8fd9\u91cc\u7684siz\u662f\u6307\u5df2\u7ecf\u7edf\u8ba1\u5b8c\u4e86\u7684\u6574\u4e2a\u5b50\u6811\u7684siz\uff09\n\n$ans = ans + (s[v][1] - s[v][0]) \\times (siz[u]-siz[v]-1) \\times V[u]$\n\n\uff08\u540e\u9762\u7684-1\u662f\u8981\u6392\u9664\u81ea\u5df1\u5230\u81ea\u5df1\u7684\u60c5\u51b5\uff0c\u56e0\u4e3a\u5df2\u7ecf\u5728\u7b2c\u4e00\u79cd\u60c5\u51b5\u7b97\u8fc7\u4e86\uff09  \n\u7b2c\u4e8c\u79cd\u60c5\u51b5\u8fd8\u6ca1\u5b8c\uff01\u8fd8\u6709\u81ea\u5df1\u5411\u4e0b\n\n$ans = ans + (siz[u]-1)\\times V[u]$\n\n\u7b2c\u4e09\u79cd\u60c5\u51b5\u7684\u7edf\u8ba1\u53ef\u80fd\u7a0d\u5fae\u9ebb\u70e6\u70b9\uff0c\u4f46\u662f\u4e5f\u662f\u6811\u5f62dp\u7684\u5957\u8def\n\n\u8003\u8651\u5bf9\u6240\u6709\u70b9\u6309\u7167\u6df1\u5ea6\u6392\u5e8f\uff0c\u7528\u4e00\u4e2a\u6570\u7ec4sup[u][0/1]\u6765\u8bb0\u5f55\u4ece$u$\u4e0a\u65b9\u5230\u8fbe$u$\u7684\u8ddd\u79bb\u4e3a\u5076\u6570/\u5947\u6570\u4e2a\u7684\u4e2a\u6570\u3002\u7531\u4e8e\u6df1\u5ea6\u662f\u6392\u5e8f\u4e86\u7684\uff0csup\u4e5f\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7$u$\u7684\u7236\u4eb2dp\u51fa\u6765\u3002\u3002\u6709\u5982\u4e0b\u9012\u63a8\u5f0f\uff08$pre[u]$\u8868\u793a$u$\u7684\u7236\u4eb2\uff09\n\n$sup[u][0] = sup[pre[u]][1] + s[pre[u]][1] - s[u][0]$\n\n\uff081 \u7c7b\u4f3c\u4e0d\u7d2f\u8d58\uff09\n\n\u7136\u540e\u7528sup\u5c31\u53ef\u4ee5\u8f7b\u677e\u7edf\u8ba1\u7b2c\u4e09\u79cd\u60c5\u51b5\u7684\u7b54\u6848\u4e86\u5462~\n\n$ans = ans + (sup[u][0] - sup[u][1]) \\times siz[u] \\times V[u]$\n\n\n\u975e\u5e38\u9700\u8981\u6ce8\u610f\u7684\u662f\u8fb9\u754c\u60c5\u51b5\u7684\u8ba8\u8bba\uff08\u5c31\u662f$u$\u672c\u8eab\u5230\u5176\u4ed6\u7684\u70b9\u7684\u60c5\u51b5\u7684\u8ba1\u7b97\uff09\uff0c\u8fd9\u4e2a\u7ec6\u8282~~\u56f0\u6270\u4e86\u83dc\u9e21\u621110\u5206\u949f~~\u7ec6\u60f3\u4e00\u4e0b\u5c31\u53ef\u4ee5\u505a\u4e0d\u7d2f\u8d58\u4e86~~\n\ncode\n\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<cstring>\n#include<cstdio>\n#include<vector>\nusing namespace std;\n#define MAXN 200006\n#define P 1000000007\ntypedef long long ll;\nint n , V[MAXN];\nvector<int> G[MAXN];\nint s[MAXN][2] , siz[MAXN] , pre[MAXN] , dep[MAXN] , sup[MAXN][2];\nll ans , tot;\nvoid dfs( int u , int fa ) {\n\tsiz[u] = 1 , s[u][0] = 1;\n\tfor( int i = 0 ; i < G[u].size() ; ++ i ) {\n\t\tint v = G[u][i];\n\t\tif( v == fa ) continue;\n\t\tpre[v] = u , dep[v] = dep[u] + 1;\n\t\tdfs( v , u );\n\t\ts[u][0] += s[v][1] , s[u][1] += s[v][0];\n\t\tsiz[u] += siz[v];\n\t}\n\tfor( int i = 0 ; i < G[u].size() ; ++ i ) {\n\t\tint v = G[u][i];\n\t\tif( v == fa ) continue;\n\t\tans += 1ll * ( s[v][1] - s[v][0] ) % P * V[u] % P * ( siz[u] - siz[v] - 1 ) % P , ans %= P;\n\t}\n\tans += 1LL * ( siz[u] - 1 ) * V[u] % P , ans %= P;\n\tans += 1LL * ( s[u][0] - s[u][1] ) * V[u] % P * ( n - siz[u] + 1 ) % P , ans %= P;\n}\nint idx[MAXN];\nbool cmp( int a , int b ) {\n\treturn dep[a] < dep[b];\n}\nint main() {\n\tcin >> n;\n\tfor( int i = 1 ; i <= n ; ++ i ) \n\t\tscanf(\"%d\",&V[i]) , tot += 1LL * V[i] , idx[i] = i;\n\tfor( int i = 1 , u , v ; i < n ; ++ i ) {\n\t\tscanf(\"%d%d\",&u,&v);\n\t\tG[u].push_back( v ) , G[v].push_back( u );\n\t}\n\tdfs( 1 , 1 );\n\tsort( idx + 1 , idx + 1 + n , cmp );\n\tfor( int i = 2 , u ; i <= n ; ++ i ) {\n\t\tu = idx[i];\n\t\tsup[u][0] = sup[pre[u]][1] + ( s[pre[u]][1] - s[u][0] );\n\t\tsup[u][1] = sup[pre[u]][0] + ( s[pre[u]][0] - s[u][1] );\n\t\tans += 1LL * ( sup[u][0] - sup[u][1] ) % P * V[u] % P * ( siz[u] ) % P , ans %= P;\n\t}\n\tcout << ( ans + P ) % P << endl;\n} \n```",
        "postTime": 1561901323,
        "uid": 63398,
        "name": "yijan",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF960E \u3010Alternating Tree\u3011"
    },
    {
        "content": "\u6811\u4e0a DP\u3002\n\n\u8003\u8651\u6bcf\u4e00\u6761\u7ecf\u8fc7 $u$ \u7684\u8def\u5f84\u7684\u8d70\u5411\uff0c\u53ef\u5206\u4e3a $3$ \u7c7b\u3002\n\n- \u5b50\u6811 $\\rightarrow u\\rightarrow$ \u5176\u4ed6\u3002\n\n- \u5176\u4ed6 $\\rightarrow u\\rightarrow$ \u5b50\u6811\u3002\n\n- \u5b50\u6811 $\\rightarrow u\\rightarrow$ \u5b50\u6811\u3002\n\n\u6211\u4eec\u8bbe $s[u][0]$ \u8868\u793a\u4ee5 $u$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u8ddd\u79bb $u$ \u4e3a\u5076\u6570\u7684\u70b9\u6570\uff0c$s[u][1]$ \u8868\u793a\u4ee5 $u$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u8ddd\u79bb $u$ \u4e3a\u5947\u6570\u7684\u70b9\u6570\u3002\n\n- \u5bf9\u4e8e\u60c5\u51b5 $1$\uff0c\u8d21\u732e\u4e3a $(s[u][0]-s[u][1])\\times w[u]\\times(n-sz[u]+1)$\uff0c$w[u]$ \u8868\u793a\u70b9\u6743\uff0c$sz[u]$ \u8868\u793a\u5b50\u6811\u8282\u70b9\u6570\u3002\n\n- \u5bf9\u4e8e\u60c5\u51b5 $2$\uff0c\u6211\u4eec\u8981\u7edf\u8ba1 $u$ \u4e0a\u65b9\uff08\u5373\u6df1\u5ea6\u5c0f\u4e8e $u$\uff09\u7684\u8ddd\u79bb $u$ \u4e3a\u5947\u6570\u6216\u5076\u6570\u7684\u70b9\u6570\uff0c\u5206\u522b\u4e3a $f[u][0]$ \u548c $f[u][1]$\uff0c\u90a3\u4e48\u8d21\u732e\u4e3a $(f[u][0]-f[u][1])\\times w[u]\\times sz[u]$\uff0c\u8003\u8651\u8ba1\u7b97 $f$\uff0c\u6211\u4eec\u5c06\u8282\u70b9\u6309\u7167\u6df1\u5ea6\u6392\u5e8f\u4e4b\u540e\u5c31\u6709 $f[u][0]=f[fa[u]][1]+s[fa[u]][1]-s[u][0],f[u][1]=f[fa[u]][0]+s[fa[u]][0]-s[u][1]$\u3002\n\n- \u5bf9\u4e8e\u60c5\u51b5 $3$\uff0c\u8d21\u732e\u4e3a $(s[v][1]-s[v][0])\\times w[u]\\times(sz[u]-sz[v]-1)+(sz[u]-1)\\times w[u]$\uff0c\u5206\u522b\u8868\u793a $u$ \u5b50\u6811\u5411\u4e0b\u548c $u$ \u8282\u70b9\u5411\u4e0b\u3002\n\n\u6ca1\u4e86\uff0c\u5751\u70b9\u4e3b\u8981\u5728\u4e8e\u5173\u4e8e $u$ \u81ea\u8eab\u7684\u8ba8\u8bba\u3002\n\n[code](https://codeforces.com/contest/960/submission/166661813)",
        "postTime": 1659426401,
        "uid": 555059,
        "name": "Stannum7507",
        "ccfLevel": 4,
        "title": "CF960E Alternating Tree"
    },
    {
        "content": "\u7ed9\u4e00\u4e2a\u4ee3\u7801\u91cf\u5c11\u4e00\u70b9\uff0c\u9002\u5408\u6bd4\u8d5b\u65f6\u5199\u7684\u4e00\u4e2a\u6362\u6839 dp \u505a\u6cd5\u3002\n\n\u8003\u8651\u6bcf\u4e00\u4e2a\u8282\u70b9\u7684\u8d21\u732e\u662f\u7531\u4ec0\u4e48\u9020\u6210\u7684\uff1a\n\n 1. \u8fd9\u4e2a\u70b9\u5f53\u8d77\u70b9\uff0c\u53bb\u6240\u6709\u522b\u7684\u5e97\uff08\u6bcf\u6b21 $1$ \u8d21\u732e\uff09\n 2. \u8fd9\u4e2a\u70b9\u5f53\u4e00\u4e2a\u4e2d\u95f4\u70b9\u6216\u8005\u7ec8\u70b9\uff0c\u5e76\u4e14\u91cc\u8d77\u70b9\u5076\u6570\u8fb9\u7684\u8ddd\u79bb\uff08\u6bcf\u6b21 $1$ \u8d21\u732e\uff09\n 3. \u5f53\u8fb9\u7684\u8ddd\u79bb\u662f\u5947\u6570\uff08\u6bcf\u6b21 $-1$ \u8d21\u732e\uff09\n\n\u663e\u7136\u7c7b\u578b 1 \u8d21\u732e\u6b21\u6570\u662f $n$\u3002\u5047\u8bbe\u5f53\u524d\u8282\u70b9\u662f\u6839\u8282\u70b9\uff0c\u56fa\u5b9a\u4e00\u4e0b\u8d77\u70b9\u6240\u5728\u7684\u5b50\u6811\u3002\u90a3\u4e48 2 \u7684\u4ece\u67d0\u4e2a\u5b50\u6811\u8d21\u732e\u6b21\u6570\u5c31\u662f\uff08\u5b50\u6811\u91cc\u5076\u6570\u8ddd\u79bb\u8282\u70b9\u4e2a\u6570\uff09\u4e58\uff08\u5168\u5c40\u5728\u8fd9\u4e2a\u5b50\u6811\u5916\u7684\u70b9\uff09\uff0c3 \u662f\u5bf9\u5947\u6570\u8ddd\u79bb\u7c7b\u4f3c\u60c5\u51b5\u3002\u5076\u6570\u8ddd\u79bb\u548c\u5947\u6570\u8ddd\u79bb\u8282\u70b9\u4e2a\u6570\u53ef\u4ee5\u76f4\u63a5\u7528\u6362\u6839\u7ef4\u62a4\u3002\n\n\u8d5b\u65f6\u4ee3\u7801\uff1a\n\n```cpp\n// writer: w33z8kqrqk8zzzx33\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define iter(i, a, b) for(int i=(a); i<(b); i++)\n#define rep(i, a) iter(i, 0, a)\n#define rep1(i, a) iter(i, 1, (a)+1)\n#define fi first\n#define se second\n#define pb push_back\n \n#define ll long long\n#define pii pair<int, int>\n//#define int ll\nconst int MOD = 1000000007;\n\nstruct data {\n    int ev, od;\n} ndat[200005];\n\nvoid makeFa(int fa, int ch) {\n    ndat[fa] = {ndat[fa].ev + ndat[ch].od, ndat[fa].od + ndat[ch].ev};\n}\n\nvoid disown(int fa, int ch) {\n    ndat[fa] = {ndat[fa].ev - ndat[ch].od, ndat[fa].od - ndat[ch].ev};\n}\n\nll ans = 0;\nvector<int> elist[200005];\nint val[200005], n;\n\nvoid dfs1(int u, int f) {\n    ndat[u] = {1, 0};\n    for(int& v:elist[u]) {\n        if(v == f) continue;\n        dfs1(v, u);\n        makeFa(u, v);\n    }\n}\n\nvoid reroot(int u, int f) {\n    ll oans = ans;\n    ans = (ans + 1ll * val[u] * n) % MOD;\n    for(int& v:elist[u])\n        ans = (ans + 1ll * val[u] * (n - ndat[v].ev - ndat[v].od) % MOD *\n        (MOD + ndat[v].od - ndat[v].ev)) % MOD;\n    for(int& v:elist[u]) {\n        if(v == f) continue;\n        disown(u, v);\n        makeFa(v, u);\n        reroot(v, u);\n        disown(v, u);\n        makeFa(u, v);\n    }\n}\n\nsigned main() {\n    ios_base::sync_with_stdio(false); cin.tie(0);\n    cin >> n;\n    rep1(i, n) {\n        cin >> val[i];\n        val[i] = (MOD + val[i]) % MOD;\n    }\n    rep(i, n-1) {\n        int u, v; cin >> u >> v;\n        elist[u].pb(v);\n        elist[v].pb(u);\n    }\n    dfs1(1, -1);\n    reroot(1, -1);\n    cout << ans << endl;\n}\n\n```",
        "postTime": 1601693988,
        "uid": 220037,
        "name": "w33z8kqrqk8zzzx33",
        "ccfLevel": 7,
        "title": "10/2 \u6a21\u62df\u8d5b \u9898\u89e3 CF960E"
    },
    {
        "content": "\u79d2\u4e86\u3002~~\u6307\u60f3\u51fa\u6765\u4f46\u5199\u4e86\u4e00\u5e74~~\n\n\u7136\u540e\u4e00\u773c\u5c31\u662f\u70b9\u5206\u2026\u4e0d\u8fc7\u597d\u50cf\u6bd4\u8f83\u9ebb\u70e6\u7684\u6837\u5b50\u3002\n\n\u6216\u8005\u8003\u8651\u76f4\u63a5\u6811\u5f62 $dp$ \u3002\u5c31\u53ea\u9700\u8981\u7edf\u8ba1\u51fa\u6bcf\u4e2a\u70b9\u5728\u591a\u5c11\u6761\u8def\u5f84\u4e0a\u662f\u5947\u6570\u4f4d\u7f6e\uff0c\u591a\u5c11\u6761\u8def\u5f84\u4e0a\u662f\u5076\u6570\u4f4d\u7f6e\u3002\u8fd9\u4e2a\u53ef\u4ee5\u7528\u6bd4\u8f83 trivial \u7684 up_and_down \u6280\u5de7\u6765\u505a\u3002\u5177\u4f53\u7684\uff0c\u8003\u8651\u5bf9\u4e8e\u5947\u5076\u4f4d\u7f6e\u5206\u522b\u7ef4\u62a4\u4e09\u4e2a\u4fe1\u606f\uff0c$f,g,h$ \u5206\u522b\u8868\u793a\u300c\u8d77\u70b9\u5728\u5b50\u6811\u5916\u3001\u7ec8\u70b9\u5728\u5b50\u6811\u5185\u300d\u3001\u300c\u8d77\u70b9\u5728\u5b50\u6811\u5185\uff0c\u7ec8\u70b9\u5728\u5b50\u6811\u5916\u300d\u3001\u300c\u8d77\u70b9\u5728\u5b50\u6811\u5185\uff0c\u7ec8\u70b9\u5728\u5b50\u6811\u5185\u300d\u4e09\u79cd\u4fe1\u606f\uff0c\u5176\u4e2d\u7b2c\u4e09\u79cd\u4f9d\u8d56\u4e8e\u7b2c\u4e8c\u79cd\uff0c\u7b2c\u4e00\u79cd\u9700\u8981\u7b2c\u4e8c\u79cd\u8fdb\u884c up_and_down \u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u7ed3\u5408\u5b50\u6811 $size$ \u76f4\u63a5\u7b97\u51fa\u8d21\u732e\u6765\u4e86\u3002\n\n\u6709\u5c0f\u7ec6\u8282\u9700\u8981\u6ce8\u610f\u3002\u5c31\u662f $f_x,g_x$ \u5728\u5904\u7406\u5947\u6570\u7684\u65f6\u5019\u9700\u8981\u5224\u4e00\u4e0b $x$ \u7684\u8fb9\u754c\u3002\n\n```cpp\n#include <cstdio>\n\n#include <vector>\n\ntypedef long long ll ;\n\ntypedef std :: vector <int> vint ;\n\n#define il inline\n\n#define p_b push_back\n\nconst int N = 200010 ;\n\nconst int P = 1000000007 ;\n\nusing namespace std ;\n\nll ans ;\n\nint n ;\nll f[N][3] ;\nll g[N][3] ;\nint size[N] ;\nint base[N] ;\n\nvint E[N] ;\n\ntemplate <typename T>\nil void add(T &x, ll y, int mod = P){\n    x += y ; x = x >= mod ? x - mod : x ;\n}\ntemplate <typename T>\nil void dec(T &x, ll y, int mod = P){\n    x -= y ; x = x < 0 ? x + mod : x ;\n}\n\nvoid dfs(int x, int fa){\n    f[x][0] = size[x] = 1 ;\n    for (auto y : E[x]){\n        if (y == fa) continue ;\n        dfs(y, x) ; size[x] += size[y] ;\n        f[x][0] += g[y][0] ; g[x][0] += f[y][0] ;\n    }\n    for (auto y : E[x]){\n        if (y == fa) continue ;\n        add(f[x][2], (size[x] - size[y] - 1) * g[y][0] % P) ;\n        add(g[x][2], (size[x] - size[y] - 1) * f[y][0] % P) ;\n    }\n}\nvoid dfs2(int x, int fa){\n    for (auto y : E[x]){\n        if (y == fa) continue ;\n        f[y][1] = g[x][1] ;\n        g[y][1] = f[x][1] ;\n        f[y][1] += (g[x][0] - f[y][0]) ;\n        g[y][1] += (f[x][0] - g[y][0]) ;\n        dfs2(y, x) ;\n    }\n}\nvoid solve(){\n    for (int x = 1 ; x <= n ; ++ x){\n        add(ans, f[x][2] * base[x] % P) ;\n        dec(ans, g[x][2] * base[x] % P) ;\n        dec(ans, base[x]) ;\n//        printf(\"%lld\\n\", ans) ;\n        add(ans, (f[x][1] + 1) * size[x] % P * base[x] % P) ;\n//        printf(\"%lld\\n\", ans) ;\n        add(ans, f[x][0] * (n - size[x] + 1) % P * base[x] % P) ;\n//        printf(\"%lld\\n\", ans) ;\n        dec(ans, g[x][1] * size[x] % P * base[x] % P) ;\n//        printf(\"%lld\\n\", ans) ;\n        dec(ans, g[x][0] * (n - size[x] + 1) % P * base[x] % P) ;\n//        printf(\"%lld\\n\", ans) ; puts(\"-----------\") ;\n    }\n}\nint main(){\n    scanf(\"%d\", &n) ; int x, y ;\n    for (int i = 1 ; i <= n ; ++ i) scanf(\"%d\", &base[i]) ;\n    for (int i = 1 ; i < n ; ++ i)\n        scanf(\"%d%d\", &x, &y), E[x].p_b(y), E[y].p_b(x) ;\n    dfs(1, 0) ; dfs2(1, 0) ; solve() ; printf(\"%lld\\n\", ans % P) ;\n}\n```\n",
        "postTime": 1591661515,
        "uid": 28313,
        "name": "\u768e\u6708\u534a\u6d12\u82b1",
        "ccfLevel": 7,
        "title": "\u300c\u7b80\u5355 DP\u300d CF960E Alternating Tree"
    },
    {
        "content": "\u8fd9\u4e2a\u4e1c\u897f\u4e00\u770b\u5c31\u548c\u5947\u5076\u6027\u6709\u5173\uff0c\u5148\u5bf9\u6574\u4e2a\u6811\u9ed1\u767d\u67d3\u8272\u4e00\u4e0b\u3002\n\n\u5bf9\u4e8e\u4e00\u6761\u8def\u5f84\uff0c\u4e0a\u9762\u7684\u4e00\u4e2a\u70b9\u5982\u679c\u548c\u8d77\u70b9\u540c\u8272\u5c31\u662f\u6b63\u8d21\u732e\uff0c\u5426\u5219\u5c31\u662f\u8d1f\u8d21\u732e\u3002\n\n\u8fd9\u6837\u5bb9\u6613\u53d1\u73b0\uff0c\u7ecf\u8fc7\u70b9\u6570\u4e3a\u5076\u6570\u7684\u8def\u5f84\u5176\u5b9e\u662f\u5047\u7684\uff0c\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u8d21\u732e\uff08\u4ea4\u6362\u8d77\u70b9\u548c\u7ec8\u70b9\u540e\u8d21\u732e\u53d8\u6210\u4e86\u539f\u6765\u7684\u76f8\u53cd\u6570\uff09\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u7edf\u8ba1\u7ecf\u8fc7\u70b9\u6570\u91cf\u4e3a\u5947\u6570\u7684\u8def\u5f84\u3002\n\n\u6211\u4eec\u62c6\u5206\u4e00\u4e2a\u70b9\u7684\u8d21\u732e\uff0c\u4ee5\u4e00\u4e2a\u9ed1\u70b9\u4e3a\u4f8b\u5b50\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/77i5t5by.png)\n\n\u7ef4\u62a4\u4e00\u4e0b\u5b50\u6811\u5185\u9ed1\u767d\u70b9\u4e2a\u6570\u5373\u53ef\u5bf9\u6bcf\u4e2a\u70b9\u5206\u522b\u7b97\u8d21\u732e\u3002\n\n[Code link](https://codeforces.com/contest/960/submission/130799037)",
        "postTime": 1633353170,
        "uid": 171487,
        "name": "cmll02",
        "ccfLevel": 8,
        "title": "pigstdwinwin"
    },
    {
        "content": "~~\u7531\u4e8ekid\u88ab\u53d1\u914d\u8fb9\u7586(\u6307\u5750\u5728\u8001\u5e08\u9762\u524d),\u4e8e\u662f\u5c31\u53ea\u80fd\u5199\u9898\u89e3\u6df7\u65f6\u95f4\u529b~~\n\n\u601d\u8def\u4e0e\u4ee3\u7801\u96be\u5ea6\u90fd\u5f88\u7b80\u5355(\u786e\u4fe1\n\n\u6211\u4eec\u8003\u8651\u8ba1\u7b97\u6bcf\u4e2a\u70b9\u7684\u8d21\u732e.\n\n\u6211\u4eec\u8bb0$f[x][0/1]$\u4e3a\u5f53\u4ee51\u4e3a\u6839\u65f6\u8fd9\u4e2a\u70b9\u5b50\u6811\u8ddd\u79bb\u5176\u4e3a \u5076\u6570 / \u5947\u6570 \u7684\u6570\u91cf(\u5305\u62ec\u81ea\u5df1)\n\n$g[0/1]$\u4e3a\u6df1\u5ea6\u4e3a\u5076\u6570\u548c\u5947\u6570\u70b9\u7684\u4e2a\u6570  (\u8fd9\u91cc\u7528\u4e0d\u4e0a\u6362\u6839,\u56e0\u4e3a\u53ea\u9700\u8981\u50a8\u5b582\u4e2a\u503c\u5c31\u80fd\u77e5\u9053\u4ee5\u5f53\u524d\u70b9\u4e3a\u6839\u4e8b\u8ddd\u79bb\u5176\u4e3a\u5947\u5076\u7684\u70b9\u7684\u4e2a\u6570)\n\n\u8003\u8651\u5982\u4f55\u8ba1\u7b97\u8d21\u732e,\u6211\u4eec\u53d1\u73b0\u5bf9\u4e8e\u957f\u5ea6\u4e3a\u5947\u6570\u7684\u8def\u5f84,\u5b83\u662f\u6ca1\u6709\u8d21\u732e\u7684(\u6765\u56de\u6b63\u597d\u62b5\u6d88),\u5bf9\u4e8e\u957f\u5ea6\u4e3a\u5076\u6570\u7684\u70b9,\u5206\u4e3a\u6b63\u8d21\u732e\u548c\u8d1f\u8d21\u732e.\n\n\u5f53\u4e00\u6761\u8def\u5f84\u5bf9\u5f53\u524d\u70b9\u6709\u6b63\u8d21\u732e\u65f6,\u8def\u5f84\u7684\u8d77\u70b9\u4e0e\u7ec8\u70b9\u9700\u8ddd\u79bb\u5f53\u524d\u70b9\u4e3a\u5076\u6570,\u6211\u4eec\u53d1\u73b0\u53ea\u8981\u8d77\u70b9\u548c\u7ec8\u70b9\u7684\u8def\u5f84\u7ecf\u8fc7\u5f53\u524d\u70b9\u5c31\u4f1a\u4ea7\u751f\u8d21\u732e.\n\n\n1.\u5b50\u6811\u5185\u9009\u4e00\u4e2a\u70b9\u518d\u5728\u5b50\u6811\u5916\u9009\u4e00\u4e2a\u70b9\n\n\u8d21\u732e\u4e3a ($d$\u4e3a\u5f53\u524d\u6df1\u5ea6&$1$,\u4e582\u662f\u56e0\u4e3a\u6709\u5411\u8def\u5f84\u8981\u7b97\u4e24\u904d\u8d21\u732e)\n$$a[x]* (g[d]-f[x][0]) * f[x][0]* 2 $$\n\n\n2.\u5b50\u6811\u5185\u9009\u4e24\u4e2a\u70b9\n\n\u5982\u4f55\u6c42\u8fd9\u79cd\u60c5\u51b5\u8def\u5f84\u4e2a\u6570\u5462,\u601d\u8def\u5f88\u7b80\u5355,\u6211\u4eec\u7528\u6240\u6709\u8def\u5f84\u7684\u51cf\u53bb\u4e0d\u5408\u6cd5\u8def\u5f84\u5c31\u884c\u4e86.\n\n\u8d21\u732e\u4e3a\n$$a[x] *f[x][0]*f[x][0] -\\sum _{to \\in s[x] }f[to][1]*f[to][1] $$\n\n\u5408\u5e76\u4e00\u4e0b\u8d21\u732e\u4e3a\n$$a[x]* (g[d]* 2-f[x][0]) * f[x][0] -\\sum _{to \\in s[x] }f[to][1]*f[to][1] $$\n\n\u8d1f\u8d21\u732e\u4e0e\u6b63\u8d21\u732e\u540c\u7406.\n\u8d21\u732e\u4e3a(\u6b64\u65f6$d$\u4e3a$d$^$1$,\u6253\u4e0d\u51fa\u6765\u5f02\u6216\u7b26\u53f7,\u60b2)\n$$-a[x] * (g[d]* 2-f[x][1]) * f[x][1] +\\sum _{to \\in s[x] }f[to][0] * f[to][0] $$\n\n\u5c06\u6b63\u8d1f\u8d21\u732e\u52a0\u8d77\u6765\u5373\u53ef\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=514514;\nconst int mod=1e9+7;\n#define ll long long\nstruct edge{int v,nt;}e[N];\nll kkr,f[N][2],g[2],a[N],cnt;\nint n,tot,hd[N];\nvoid add(int x,int y) {e[++tot].v=y;e[tot].nt=hd[x];hd[x]=tot;}\nvoid dfs(int x,int fa){f[x][0]=1;\n\tfor(int i=hd[x],to;i;i=e[i].nt){to=e[i].v;\n\t\tif(fa==to)continue;dfs(to,x);\n\t\tf[x][0]+=f[to][1];f[x][1]+=f[to][0];\n\t}\n}\nvoid solve(int x,int fa,int d){//\u6211\u5728\u4e0b\u9762\u63d0\u524d\u628ag\u4e58\u4e862\u6240\u4ee5\u8fd9\u91cc\u6ca1\u6709\u4e58\n\tcnt=((g[d]-f[x][0])*f[x][0]-(g[d^1]-f[x][1])*f[x][1])%mod; \n\tkkr=(kkr+cnt*a[x])%mod;\t\n\tfor(int i=hd[x],to;i;i=e[i].nt){to=e[i].v;\n\t\tif(fa==to)continue;solve(to,x,d^1);\n\t\tkkr=(kkr+f[to][0]*f[to][0]%mod*a[x]%mod+mod)%mod;\n\t\tkkr=(kkr-f[to][1]*f[to][1]%mod*a[x]%mod)%mod;\n       //\u51cf\u53bb\u4e0d\u5408\u6cd5\u65b9\u6848\n\t}\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)scanf(\"%lld\",&a[i]);\n\tfor(int i=1,x,y;i<n;i++)scanf(\"%d%d\",&x,&y),add(x,y),add(y,x);\n\tdfs(1,0);g[0]=f[1][0]<<1,g[1]=f[1][1]<<1;solve(1,0,0);\n\tprintf(\"%lld\",(kkr%mod+mod)%mod);\n}\n```\n\n\n",
        "postTime": 1604548574,
        "uid": 53852,
        "name": "\u5f26\u5dfb\u3053\u3053\u308d",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF960E \u3010Alternating Tree\u3011"
    }
]
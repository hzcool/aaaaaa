[
    {
        "content": "# CF1380G Circular Dungeon\n\n\u770b\u61c2\u6837\u4f8b\u5c31\u80fd\u505a\u3002\n\n~~\u867d\u7136\u6211\u77aa\u4e86 20 \u5206\u949f \u83dc\u662f\u539f\u7f6a~~\n\n\u9996\u5148\u53ef\u4ee5\u5c06\u4ece\u6bcf\u4e00\u4e2a\u70b9\u51fa\u53d1\u6240\u80fd\u83b7\u5f97\u7684\u4ef7\u503c\u76f8\u52a0\uff0c\u518d\u9664\u4ee5 $n$ \u5c31\u53ef\u4ee5\u5f97\u5230\u4ef7\u503c\u7684\u671f\u671b\u3002\n\n\u6240\u4ee5\u95ee\u9898\u8f6c\u5316\u4e3a\u4f7f\u4ece\u6bcf\u4e00\u4e2a\u70b9\u51fa\u53d1\u6240\u80fd\u83b7\u5f97\u7684\u4ef7\u503c\u4e4b\u548c\u6700\u5c0f\u3002\n\n\u6709\u4e00\u4e2a\u663e\u800c\u6613\u89c1\u7684\u7ed3\u8bba\uff1a\u6211\u4eec\u4e00\u5b9a\u4f1a\u5c06\u4ef7\u503c\u524d $k$ \u5927\u7684\u5b9d\u7bb1\u53d8\u6210\u5047\u5b9d\u7bb1\u3002\n\n\u4e3a\u4e86\u5c3d\u53ef\u80fd\u51cf\u5c0f\u4ef7\u503c\u4e4b\u548c\uff0c\u8fd9\u4e9b\u5047\u5b9d\u7bb1\u4e00\u5b9a\u4e0d\u4f1a\u76f8\u90bb\uff0c\u4e8e\u662f\u8fd9 $k$ \u4e2a\u5047\u5b9d\u7bb1\u628a\u8fd9\u4e2a\u73af\u5206\u6210\u4e86 $k$ \u6bb5\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\u8d77\u89c1\uff0c\u4f60\u53ef\u4ee5\u628a\u73af\u65ad\u5f00\u6210\u94fe\uff0c\u4ee5\u67d0\u4e2a\u5047\u5b9d\u7bb1\u4e3a\u65ad\u70b9\uff0c\u6bcf\u4e00\u6bb5\u90fd\u662f\u5b8c\u6574\u7684\u3002\n\n\u90a3\u4e48\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u5c06\u771f\u5b9d\u7bb1\u5206\u4e3a $k$ \u6bb5\uff0c\u4f7f\u5f97\u4ece\u6bcf\u4e00\u4e2a\u70b9\u51fa\u53d1\u6240\u80fd\u83b7\u5f97\u7684\u4ef7\u503c\u4e4b\u548c\u6700\u5c0f\u3002\n\n\u663e\u7136\u5728\u540c\u4e00\u6bb5\u7684\u70b9\u53ea\u80fd\u83b7\u5f97\u81ea\u5df1\u8fd9\u4e00\u6bb5\u4e2d\u5b9d\u7bb1\u7684\u4ef7\u503c\u3002\n\n\u8003\u8651\u5728\u540c\u4e00\u6bb5\u7684\u6bcf\u4e2a\u70b9\u51fa\u53d1\u6240\u80fd\u83b7\u5f97\u7684\u603b\u4ef7\u503c\uff0c\u8bbe\u8fd9\u4e00\u6bb5\u5b9d\u7bb1\u4e2d\u7b2c $i$ \u4e2a\u5b9d\u7bb1\u7684\u4ef7\u503c\u4e3a $v_i$\u3002\n\n\u5219\u6709\n$$\nsum=\\sum_{i=1}^niv_i\n$$\n\u90a3\u4e48\u663e\u7136\u8fd9\u4e00\u6bb5\u4e2d\u7684\u5b9d\u7bb1\u4ef7\u503c\u5e94\u6309\u7167\u964d\u5e8f\u6392\u5e8f\u624d\u80fd\u4fdd\u8bc1\u603b\u4ef7\u503c\u6700\u5c0f\u3002\n\n\u6211\u4eec\u521a\u624d\u8003\u8651\u4e86\u4e00\u6bb5\u7684\u603b\u4ef7\u503c\uff0c\u73b0\u5728\u6211\u4eec\u4ece\u603b\u4f53\u4e0a\u770b\uff0c\u600e\u6837\u80fd\u591f\u4f7f\u5f97\u4ef7\u503c\u6700\u5c0f\uff1f\n\n\u6ce8\u610f\u5230\u6bcf\u4e00\u6bb5\u7684\u7b2c\u4e00\u4e2a\u6570\u4f1a\u5bf9\u7b54\u6848\u4ea7\u751f\u4e00\u6b21\u8d21\u732e\uff0c\u6bcf\u4e00\u6bb5\u7684\u7b2c\u4e8c\u4e2a\u6570\u4f1a\u5bf9\u7b54\u6848\u4ea7\u751f\u4e8c\u6b21\u8d21\u732e\uff0c...\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u6bcf\u4e00\u6bb5\u7684\u7b2c\u4e00\u4e2a\u6570\u5c3d\u53ef\u80fd\u5927\uff0c\u8fd9\u6837\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u624d\u4f1a\u5c0f\u3002\n\n\u5373\u8bbe\u4e00\u5171\u6709 $k$ \u6bb5\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u771f\u5b9d\u7bb1\u4e2d\u4ef7\u503c\u524d $k$ \u5927\u7684\u5b9d\u7bb1\u653e\u5728\u6bcf\u4e00\u6bb5\u7684\u7b2c\u4e00\u4e2a\uff0c\u5269\u4f59\u771f\u5b9d\u7bb1\u4e2d\u7684\u524d $k$ \u5927\u653e\u5728\u6bcf\u4e00\u6bb5\u7684\u7b2c\u4e8c\u4e2a\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff0c\u4e0d\u8db3 $k$ \u4e2a\u53ef\u4ee5\u770b\u4f5c\u7528 $0$ \u8865\u9f50\u3002\n\n\u8fd9\u6837\u8fd9\u4e2a\u9898\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\log_2n)$\u3002\n\n\uff08\u5176\u5b9e\u4f60\u770b\u6211\u8bf4\u8fd9\u4e48\u5927\u4e00\u5806\u4ee3\u7801\u8d85\u7b80\u5355\u7684\uff09\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int p=998244353;\nconst int maxn=3e5+5;\nint a[maxn],sum[maxn];\nint ksm(int a,int b,int p){\n\tint ans=1;\n\twhile(b){\n\t\tif(b&1) ans=1ll*ans*a%p;\n\t\tb>>=1,a=1ll*a*a%p;\n\t}\n\treturn ans;\n}\nint main(){\n\tios::sync_with_stdio(0);\n\tcin.tie(0),cout.tie(0);\n\tint n;cin>>n;\n\tfor(int i=1;i<=n;++i) cin>>a[i];\n\tsort(a+1,a+n+1);\n\treverse(a+1,a+n+1);\n\tfor(int i=1;i<=n;++i) sum[i]=(sum[i-1]+a[i])%p;\n\tint inv=ksm(n,p-2,p);\n\tfor(int k=1;k<=n;++k){\n\t\tint ans=0;\n\t\tfor(int j=0,i=0;i<n;++j,i+=k)\n\t\t\tans=(ans+1ll*j*(sum[min(n,i+k)]-sum[i]+p)%p)%p;\n\t\tcout<<1ll*ans*inv%p<<' ';\n\t}\n\treturn 0;\n}\n```\n\n\n\n\n\n",
        "postTime": 1599793422,
        "uid": 43957,
        "name": "HenryHuang",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1380G \u3010Circular Dungeon\u3011"
    },
    {
        "content": "# CF1380G Circular Dungeon\n\n[link](https://codeforces.com/problemset/problem/1380/G)\n\n## \u5206\u6790\n\n\u4f9d\u9898\u610f\u5f97\uff1a$ans_k=\\frac{\\sum_{i=1}^n \\text{\u4ece\u7b2c}\\ i\\  \\text{\u4e2a\u70b9\u51fa\u53d1\u6240\u80fd\u83b7\u5f97\u7684\u4ef7\u503c}}{n}$\uff0c\u90a3\u4e48\u53ef\u4ee5\u5c06\u95ee\u9898\u8f6c\u5316\u4e3a\u4f7f\u4ece\u6bcf\u4e00\u4e2a\u70b9\u51fa\u53d1\u6240\u80fd\u83b7\u5f97\u7684\u4ef7\u503c\u4e4b\u548c\u6700\u5c0f\n\n\u4e3a\u4e86\u4f7f\u5b83\u6700\u5c0f\uff0c\u7a7a\u5b9d\u7bb1\u4e00\u5b9a\u662f\u4ef7\u503c\u6700\u5927\u7684 $k$ \u4e2a\u5b9d\u7bb1\u4e14\u8fd9\u4e9b\u5047\u5b9d\u7bb1\u4e00\u5b9a\u4e0d\u4f1a\u76f8\u90bb\uff0c\u6240\u4ee5\u8fd9 $k$ \u4e2a\u5047\u5b9d\u7bb1\u628a\u8fd9\u4e2a\u73af\u5206\u6210\u4e86 $k$ \u6bb5\n\n\u8003\u8651\u4e00\u6bb5\u7684\u603b\u4ef7\u503c\uff0c\u8bbe\u8fd9\u4e00\u6bb5\u4e2d\u7b2c $i$ \u4e2a\u5b9d\u7bb1\u7684\u4ef7\u503c\u4e3a $c'_i$\uff0c\u90a3\u4e48\u603b\u4ef7\u503c\u4e3a $\\sum_{i=1}^ni\\times c'_i$\uff0c\n\u4ece\u800c\u53ef\u4ee5\u5f97\u51fa\u8fd9\u4e00\u6bb5\u4e2d\u7684\u5b9d\u7bb1\u4ef7\u503c\u5e94\u6309\u7167**\u964d\u5e8f**\u6392\u5e8f\u624d\u80fd\u4fdd\u8bc1\u603b\u4ef7\u503c\u6700\u5c0f\n\n\u6211\u4eec\u603b\u7ed3\u4e00\u4e0b\uff0c\u4f7f\u7b54\u6848\u6700\u5c0f\u7684\u6446\u653e\u65b9\u6848\u662f\uff1a\n\n1. \u5c06\u771f\u5b9d\u7bb1\u4e2d\u4ef7\u503c\u524d $k$ \u5927\u7684\u653e\u5728\u6bcf\u4e00\u6bb5\u7684\u7b2c\u4e00\u4e2a\n\n2. \u5c06\u5269\u4f59\u771f\u5b9d\u7bb1\u4e2d\u7684\u524d $k$ \u5927\u7684\u653e\u5728\u6bcf\u4e00\u6bb5\u7684\u7b2c\u4e8c\u4e2a\n\n3. $\\dots$\n\n4. \u4ee5\u6b64\u7c7b\u63a8\uff0c\u4e0d\u8db3 $k$ \u4e2a\u7528 $0$ \u8865\u9f50\n\n\u518d\u603b\u7ed3\u4e00\u4e0b\u5047\u5b9d\u7bb1\u4e2a\u6570\u4e3a $k$ \u65f6\u7684\u7b97\u6cd5\u6d41\u7a0b\uff1a\n\n1. \u679a\u4e3e\u6bcf\u6bb5\u7684\u7b2c $i$ \u4e2a\u5728 $c$ \u4e0a\u7684\u533a\u95f4 $i\\times k+1$ ~ $min((i+1)\\times k,n)$\uff0c\u52a0\u4e0a\u5b83\u7684\u8d21\u732e $i\\times \\sum_{i\\times k+1}^{min((i+1)\\times k,n)} c_i$\uff0c\u5176\u4e2d $\\sum_{i\\times k+1}^{min((i+1)\\times k,n)} c_i$ \u53ef\u4ee5\u7528\u524d\u7f00\u548c\u4f18\u5316\n\n2. \u8f93\u51fa $\\frac{\\text{\u8d21\u732e\u548c}}{n}$\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(n\\log n)$\n\n## \u4ee3\u7801\n\n~~~cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int mod=998244353,MAXN=3e5+10;\nint n;\nint c[MAXN],pre[MAXN]; //pre \u662f c \u7684\u524d\u7f00\u548c \nint ksm(int u,int v) //\u5feb\u901f\u8ba1\u7b97 u^v \n{\n\tint res=1;\n\twhile(v)\n\t{\n\t\tif(v&1) res=1ll*res*u%mod;\n\t\tu=1ll*u*u%mod; v>>=1;\n\t}\n\treturn res;\n}\nbool cmp(int x,int y) //\u81ea\u5b9a\u4e49\u6bd4\u8f83\u51fd\u6570 \n{\n\treturn x>y;\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)\n\t\tscanf(\"%d\",&c[i]);\n\tsort(c+1,c+n+1,cmp); //\u5c06\u6570\u7ec4 c \u4ece\u5927\u5230\u5c0f\u6392\u5e8f \n\tfor(int i=1;i<=n;i++)\n\t\tpre[i]=(pre[i-1]+c[i])%mod; //\u524d\u7f00\u548c \n\tfor(int k=1;k<=n;k++) //\u679a\u4e3e\u5047\u5b9d\u7bb1\u4e2a\u6570 k \n\t{\n\t\tint ans_k=0;\n\t\tfor(int i=k,j=1;i<n;i+=k,j++) //i\uff1a\u5f53\u524d\u6bb5\u7684\u5de6\u7aef\u70b9\u7684\u5de6\u8fb9\u90a3\u4e00\u4f4d\uff0cj\uff1a\u5bf9\u7b54\u6848\u7684\u8d21\u732e \n\t\t\tans_k=(ans_k+1ll*j*(pre[min(n,i+k)]-pre[i]+mod)%mod)%mod;\n\t\t\t//\u8ba1\u7b97\u5f53\u524d\u6bb5 i~min(n,i+k) \u5bf9\u7b54\u6848\u7684\u8d21\u732e\uff0c\u5e76\u5c06\u5176\u52a0\u5165 ans_k \n\t\tprintf(\"%d \",1ll*ans_k*ksm(n,mod-2)%mod);\n\t}\n\treturn 0;\n}\n~~~\n\n[AC\u8bb0\u5f55](https://codeforces.com/problemset/submission/1380/175125186)\n\n## \u5199\u5728\u6700\u540e\n\n\u7b14\u8005\u6c34\u5e73\u6709\u9650\uff0c\u5982\u679c\u5199\u7684\u6709\u4e0d\u6e05\u695a\u6216\u4e0d\u5bf9\u7684\u5730\u65b9\u671b\u8bfb\u8005\u79c1\u4fe1\u6211\u6307\u51fa\uff0c\u6211\u4f1a\u53ca\u65f6\u4fee\u6b63",
        "postTime": 1665228010,
        "uid": 355970,
        "name": "__lyx",
        "ccfLevel": 0,
        "title": "CF1380G Circular Dungeon"
    },
    {
        "content": "## \u9898\u89e3\n\n\u867d\u7136\u5957\u4e86\u5c42\u671f\u671b\u7684\u58f3\uff0c\u4f46\u5f88\u5bb9\u6613\u53d1\u73b0\u671f\u671b\u503c\u5c31\u662f\u4ece\u6bcf\u4e2a\u70b9\u51fa\u53d1\u83b7\u5f97\u7684\u6536\u76ca\u4e4b\u548c\uff0c\u9664\u4ee5 $n$\u3002\n\n\u73b0\u5728\u8003\u8651\u8fd9\u6837\u4e00\u4e32\u5b9d\u7bb1\u7684\u6536\u76ca\uff08\u5176\u4e2d $\\mathrm{Fake}$ \u8868\u793a\u5047\u5b9d\u7bb1\uff09\uff1a\n\n$$[b_1, b_2,b_3,\\cdots b_k,\\mathrm{Fake}]$$\n\n\u5bb9\u6613\u53d1\u73b0\u5b83\u4eec\u7684\u8d21\u732e\u4e3a\uff1a\n\n$$(b_1+b_2+\\cdots+b_k)+(b_2+b_3+\\cdots+b_k)+\\cdots=b_1+2b_2+3b_3+\\cdots+kb_k$$\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u8d8a\u9760\u8fd1 $\\mathrm{Fake}$\uff0c\u5b83\u7684\u6743\u91cd\u8d8a\u5927\u3002\u5e76\u4e14\u6743\u91cd\u5c31\u662f\u5230 $\\mathrm{Fake}$ \u8d70\u8fc7\u7684\u6b65\u6570\u3002\u5bb9\u6613\u8d2a\u5fc3\u5730\u53bb\u60f3\uff0c\u5c06 $b$ \u6570\u7ec4\u4ece\u5927\u5230\u5c0f\u6392\u5217\uff08\u53ef\u4ee5\u7528\u90bb\u9879\u4ea4\u6362\u8bc1\u660e\uff09\u3002\n\n\u53ef\u4ee5\u8fdb\u4e00\u6b65\u63a8\u5e7f\u8fd9\u4e2a\u7ed3\u8bba\u3002\u5047\u8bbe\u4e00\u5171\u6709 $k$ \u4e2a\u5047\u5b9d\u7bb1\uff0c\u90a3\u4e48\u6743\u503c\u4e3a $1$ \u7684\u5b9d\u7bb1\u6570\u91cf\u6700\u591a\u6709 $k$ \u4e2a\uff08\u53ef\u4ee5\u653e\u5728\u6bcf\u4e2a\u5047\u5b9d\u7bb1\u540e\u4e00\u4e2a\u4f4d\u7f6e\uff09\uff0c\u6743\u503c\u4e3a $2$ \u7684\u5b9d\u7bb1\u6700\u591a\u6709 $k$ \u4e2a\uff08\u53ef\u4ee5\u653e\u5728\u6bcf\u4e2a\u5047\u5b9d\u7bb1\u540e\u4e24\u4e2a\u4f4d\u7f6e\uff09\u2026\u2026\n\n\u5bb9\u6613\u8d2a\u5fc3\u5730\u53bb\u628a\u524d $k$ \u5927\u7684\u5b9d\u7bb1\u90fd\u8bbe\u4e3a\u5047\u5b9d\u7bb1\uff0c\u8fd9\u6837\u80af\u5b9a\u4e0d\u52a3\u3002\u63a5\u7740\u6211\u4eec\u8d2a\u5fc3\u5730\u5206\u914d\u6743\u503c\u3002\u7ed9\u771f\u5b9d\u7bb1\u524d $k$ \u5927\u7684\u5b9d\u7bb1\u6743\u91cd\u8bbe\u4e3a $1$\uff0c\u5269\u4e0b\u7684\u771f\u5b9d\u7bb1\u91cc\u524d $k$ \u5927\u7684\u6743\u91cd\u8bbe\u4e3a $2$\u2026\u2026\u5c06\u6570\u5217 $a$ \u6392\u5e8f\u540e\u505a\u4e00\u4e2a\u524d\u7f00\u548c\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5 $\\mathcal O(1)$ \u8ba1\u7b97\u6392\u540d\u8fde\u7eed\u7684\u5b9d\u7bb1\u7684\u4ef7\u503c\u4e4b\u548c\u3002\u6211\u4eec\u66b4\u529b\u5730\u5206\u914d\u6743\u91cd\uff0c\u5f97\u5230\u590d\u6742\u5ea6\uff1a\n\n$$\\mathcal O\\left(\\sum_i\\dfrac{n-i}{i}\\right)= \\mathcal O\\left(\\sum_i\\dfrac{n}{i}-n\\right)=\\mathcal O(n\\log n)$$\n\n\u90a3\u4e48\u8fd9\u9898\u5c31\u505a\u5b8c\u4e86\u3002\n\n## \u53c2\u8003\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define up(l, r, i) for(int i = l, END##i = r;i <= END##i;++ i)\n#define dn(r, l, i) for(int i = r, END##i = l;i >= END##i;-- i)\nusing namespace std;\ntypedef long long i64;\nconst int INF = 2147483647;\nint qread(){\n    int w=1,c,ret;\n    while((c = getchar()) >  '9' || c <  '0') w = (c == '-' ? -1 : 1); ret = c - '0';\n    while((c = getchar()) >= '0' && c <= '9') ret = ret * 10 + c - '0';\n    return ret * w;\n}\nconst int MAXN = 3e5 + 3;\nconst int MOD  = 998244353;\nint n, A[MAXN], S[MAXN], ans, t;\nint pwr(int a, int b){\n    int r = 1;\n    while(b){\n        if(b & 1) r = 1ll * r * a % MOD;\n        a = 1ll * a * a % MOD, b >>= 1;\n    }\n    return r;\n}\nbool cmp(int a, int b){ return a > b; }\nint main(){\n    n = qread(), t = pwr(n, MOD - 2);\n    up(1, n, i) A[i] = qread();\n    sort(A + 1, A + 1 + n, cmp);\n    up(1, n, i) S[i] = (S[i - 1] + A[i]) % MOD;\n    up(1, n, i){\n        int tot = 0;\n        for(int l = i + 1, r = min(l + i - 1, n), c = 1;l <= n;l += i, r = min(n, l + i - 1), ++ c){\n            tot = (tot + 1ll * (S[r] - S[l - 1] + MOD) * c % MOD) % MOD;\n        }\n        printf(\"%lld%c\", 1ll * tot * t % MOD, \" \\n\"[i == n]);\n    }\n    return 0;\n}\n```",
        "postTime": 1675142789,
        "uid": 68344,
        "name": "\u79bb\u6563\u5c0f\u6ce2\u53d8\u6362\u00b0",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 \u3010CF1380G Circular Dungeon\u3011"
    },
    {
        "content": "ACM \u628a\u8fd9\u9053\u9898\u7ed9\u8bfb\u9519\u4e86/ll\u3002\n\n\u4ed4\u7ec6\u60f3\u4e86\u60f3\u611f\u89c9\u4e0d\u96be\uff0c\u6ca1\u6709 *2600\u3002\n\n\u9996\u5148\u80af\u5b9a\u662f\u628a\u4ef7\u503c\u5927\u7684\u5b9d\u7269\u53d8\u4e3a\u5047\u7684\u6700\u4f18\u3002\n\n\u7136\u540e\u8fd9\u4e9b\u5927\u7684\u5b9d\u7269\u80af\u5b9a\u662f\u8981\u5747\u5300\u5730\u5206\u5e03\u5728\u5706\u73af\u56db\u5468\u3002\n\n\u8fd9\u6837\u7684\u8bdd\u6bcf\u6bb5\u957f\u5ea6\u8981\u4e0d\u7136\u662f $\\left\\lfloor\\dfrac{n}{k}\\right\\rfloor$\uff0c\u8981\u4e0d\u7136\u662f $\\left\\lceil\\dfrac{n}{k}\\right\\rceil$\u3002\n\n\u5982\u679c\u67d0\u4e00\u6bb5\u957f\u5ea6\u662f $l$\uff0c\u800c\u5728\u8fd9\u4e00\u6bb5\u4e2d\u67d0\u4e2a\u771f\u5b9d\u7269\u8ddd\u79bb\u4e0b\u4e00\u4e2a\u5047\u5b9d\u7269\u7684\u6700\u8fd1\u8ddd\u79bb\u662f $d$\uff0c\u90a3\u4e48\u5b83\u4f1a\u5bf9\u7b54\u6848\u4ea7\u751f $(l-d+1)$ \u6b21\u8d21\u732e\u3002\n\n\u6362\u53e5\u8bdd\u8bf4\uff0c\u5982\u679c\u67d0\u4e00\u6bb5\u7684\u957f\u5ea6\u662f $l$\uff0c\u90a3\u4e48\u8fd9\u4e00\u6bb5\u7684\u6bcf\u4e2a\u5b9d\u7269\u7684\u8d21\u732e\u6b21\u6570\u5448 $1$ ~ $l$ \u7684\u6392\u5217\u7684\u5f62\u5f0f\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u8981\u5c06\u4ef7\u503c\u8d8a\u5927\u7684\u5b9d\u7269\u8ba9\u4ed6\u7684\u8d21\u732e\u6b21\u6570\u8d8a\u5c0f\u3002\n\n\u5982\u679c\u5c06\u5b9d\u7269\u6309\u7167\u4ef7\u503c\u6392\u5e8f\uff0c\u90a3\u4e48\u6bcf\u7c7b\u76f8\u540c\u8d21\u732e\u6b21\u6570\u7684\u5b9d\u7269\u4f1a\u5f62\u6210\u4e00\u4e2a\u8fde\u7eed\u6bb5\uff0c\u603b\u5171\u4f1a\u6709 $\\left\\lceil\\dfrac{n}{k}\\right\\rceil$ \u6bb5\u3002\n\n\u8fd9\u6837\u66b4\u529b\u679a\u4e3e\u8fde\u7eed\u6bb5\u7684\u590d\u6742\u5ea6\u5176\u5b9e\u662f $O(n\\ln n)$ \u7684\uff0c\u4e14\u6bcf\u4e2a\u8fde\u7eed\u6bb5\u7684\u4ef7\u503c\u548c\u90fd\u53ef\u4ee5\u901a\u8fc7\u524d\u7f00\u548c\u7684\u5f62\u5f0f $O(1)$ \u7b97\uff0c\u6240\u4ee5\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n\\ln n+n\\log n)$\u3002\n\n# AC code\uff1a\n```cpp\nint a[300005],sum[300005];\ninline int rmod(int x){return x-mod+(x-mod>>31&mod);}\ninline int lmod(int x){return x+(x>>31&mod);}\ninline int ksm(int cur,int indx){\n\tint res=1;\n\twhile(indx){\n\t\tif(indx&1) res=(ll)res*cur%mod;\n\t\tcur=(ll)cur*cur%mod,indx>>=1;\n\t}return res;\n}\nint main(){\n\tint n=re(n),i,j,inv=ksm(n,mod-2);\n\tfor(i=1;i<=n;i++) re(a[i]);sort(a+1,a+n+1,greater<int>());\n\tfor(i=1;i<=n;i++) sum[i]=rmod(sum[i-1]+a[i]);\n\tfor(i=1;i<=n;i++){\n\t\tint ans=0;\n\t\tfor(j=1;(j-1)*i<n-i;j++) ans=(ans+(ll)lmod(sum[min(j*i+i,n)]-sum[j*i])*j)%mod;\n\t\tpr((ll)ans*inv%mod),sp;\n\t}\n}\n```",
        "postTime": 1649170701,
        "uid": 80614,
        "name": "ZCPB",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1380G"
    }
]
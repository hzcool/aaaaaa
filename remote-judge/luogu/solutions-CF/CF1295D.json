[
    {
        "content": "### [CF1295D Same GCDs](https://www.luogu.com.cn/problem/CF1295D)\n\n#### \u9898\u610f\n\n\u7ed9\u5b9a\u4e24\u4e2a\u6574\u6570 $a,m\\ (1\\le a<m\\le 10^{10})$\u3002\u8ba1\u7b97\u6ee1\u8db3\u6761\u4ef6 $0 \\le x < m$ \u4e14 $\\gcd(a,m)=\\gcd(a+x,m)$ \u7684\u6574\u6570 $x$ \u7684\u4e2a\u6570\u3002\n\n#### \u7b80\u5355\u8f6c\u5316\n\n\u9996\u5148\u53ef\u4ee5\u6ce8\u610f\u5230\uff0c$a$ \u548c $m$ \u90fd\u662f\u5df2\u77e5\u7684\uff0c\u56e0\u6b64\u53ef\u4ee5\u6c42\u51fa $a,m$ \u7684\u6700\u5927\u516c\u56e0\u6570 $g$\u3002\u90a3\u4e48\uff0c$\\gcd(a,m)=\\gcd(a+x,m)=g\\ (0\\le x<m)$ \u5c31\u7b49\u4ef7\u4e8e $\\gcd(a',m')=\\gcd(a'+x',m')=1\\ (0\\le x'<m')$\uff0c\u5176\u4e2d $a',m',x'$ \u6ee1\u8db3 $a=ga',\\ m=gm',x=gx'$\u3002\n\n\u4e0b\u6587\u4e2d\u5c06\u6574\u6570 $u$ \u4e0e $v$ \u4e92\u8d28\u8bb0\u4f5c $u\\perp v$\u3002\u4e3a\u4e0b\u6587\u53d9\u8ff0\u65b9\u4fbf\u8d77\u89c1\uff0c\u8f6c\u5316\u5b8c\u6210\u540e\uff0c\u6211\u4eec\u4ee4 $a=a',m=m',x=x'$\uff0c\u5373\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u628a $a$ \u548c $m$ \u90fd\u9664\u4ee5\u4e86 $g$\u3002\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u5c31\u662f\u5df2\u77e5 $a\\perp m$\uff0c\u60f3\u6c42\u6ee1\u8db3 $(a+x)\\perp m,0\\le x<m$ \u7684\u6574\u6570 $x$ \u7684\u4e2a\u6570\u3002\n\n#### \u65b9\u6cd5 1\uff1a\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\n\n\u770b\u5230\u201c\u4e92\u8d28\u201d\uff0c\u901a\u5e38\u5c31\u53ef\u4ee5\u7528\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u8fdb\u884c\u8f6c\u5316\u4e86\u3002\n\n$$\\begin{aligned}&\\sum^{m-1}_{x=0}[(a+x)\\perp m]\\\\=&\\sum^{m-1}_{x=0}\\sum_{d\\mid (a+x)\\ \\land\\  d\\mid m}\\mu(d)\\\\=&\\sum_{d\\mid m}\\mu(d)\\sum^{m-1}_{x=0}[d\\mid (a+x)]\\\\=&\\sum_{d\\mid m}\\mu(d)\\left (\\left \\lfloor \\frac{a+m-1}{d} \\right\\rfloor-\\left\\lfloor \\frac{a-1}{d} \\right\\rfloor\\right )\\end{aligned}$$\n\n\u7b2c\u4e00\u884c\u662f\u539f\u59cb\u7edf\u8ba1\u91cf\uff0c\u7b2c\u4e8c\u884c\u7528\u4e86 $\\sum_{d\\mid x}\\mu(d)=[x=1]$ \u7684\u5e38\u89c1\u8f6c\u5316\uff0c\u7b2c\u4e09\u884c\u4ea4\u6362\u4e86 $x,d$ \u4e24\u5c42\u6c42\u548c\u7684\u987a\u5e8f\uff0c\u7b2c\u56db\u884c\u628a\u5185\u5c42\u6c42\u548c\u7528\u5f0f\u5b50\u7b80\u5316\u4e86\u3002\n\n\u4e8e\u662f\u73b0\u5728\u6211\u4eec\u53ea\u9700\u5bf9 $m$ \u7684\u6bcf\u4e00\u4e2a\u7ea6\u6570\u8fdb\u884c\u4e0a\u8ff0\u6c42\u548c\u5373\u53ef\u3002\u90a3\u4e48\u6211\u4eec\u9700\u8981\u627e\u51fa $m$ \u7684\u6bcf\u4e00\u4e2a\u7ea6\u6570\uff0c\u8fd8\u8981\u7b97\u51fa\u5b83\u6bcf\u4e00\u4e2a\u7ea6\u6570\u7684 $\\mu$ \u503c\u3002\n\n\u627e\u7ea6\u6570\u81ea\u7136\u53ef\u4ee5 $\\mathrm{O}(\\sqrt{m})$ \u627e\uff0c\u90a3 $\\mu$ \u503c\u600e\u4e48\u7b97\u5462\uff1f\n\n\u8bbe $m$ \u6709 $t$ \u4e2a\u4e0d\u540c\u7684\u8d28\u56e0\u5b50\uff0c\u90a3\u4e48\u5b9e\u9645\u4e0a $m$ \u53ea\u6709 $2^t$ \u4e2a\u7ea6\u6570\u7684 $\\mu$ \u975e\u96f6\uff0c\u800c\u901a\u8fc7\u8ba1\u7b97\u53d1\u73b0 $m\\le 10^{10}$ \u65f6 $t\\le 10$\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u628a $m$ \u8d28\u56e0\u6570\u5206\u89e3\uff0c\u518d\u679a\u4e3e $m$ \u8d28\u56e0\u5b50\u96c6\u5408\u7684\u5b50\u96c6\uff0c\u8ba1\u7b97\u51fa\u76f8\u5e94\u7684\u65e0\u5e73\u65b9\u56e0\u5b50\u7ea6\u6570\uff0c\u66f4\u65b0\u7b54\u6848\u5373\u53ef\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathrm{O}(\\sqrt{m}+2^t)=\\mathrm{O}(\\sqrt{m})$\u3002\n\n#### \u65b9\u6cd5 2\uff1a\u6b27\u62c9\u51fd\u6570\n\n\u8d5b\u65f6\u6211\u4e5f\u4e00\u5ea6\u731c\u60f3\u7b54\u6848\u5c31\u662f $\\varphi(m)$\uff0c\u4f46\u662f\u56e0\u4e3a\u4e00\u65f6\u65e0\u6cd5\u8bc1\u660e\uff0c\u5e76\u4e14\u65b9\u6cd5 1 \u4e5f\u80fd\u60f3\u51fa\u6765\uff0c\u56e0\u6b64\u5c31\u6ca1\u6709\u66f4\u6df1\u5165\u5730\u63a2\u7a76\u3002\u8d5b\u540e\u770b\u5230\u8ba8\u8bba\u533a\u6709\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u5c31\u4ed4\u7ec6\u60f3\u4e86\u60f3\uff0c\u8fd8\u662f\u6bd4\u8f83\u5999\u7684\u3002\n\n\u65e2\u7136\u6211\u4eec\u60f3\u8981\u8bc1\u660e\u7b54\u6848\u662f $\\varphi(m)$\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u8981\u628a \u201c\u6240\u6709\u4e0e $m$ \u4e92\u8d28\u7684\uff08\u4e0b\u6587\u79f0\u4e3a\u5408\u6cd5\u7684\uff09$a+x$\u201d \u548c \u201c$[1,m]$ \u4e2d\u6240\u6709\u4e0e $m$ \u4e92\u8d28\u7684\u6574\u6570\u201d \u4e00\u4e00\u5bf9\u5e94\u8d77\u6765\u3002\u4e0b\u9762\u6784\u9020\u4e00\u4e2a\u8fd9\u6837\u7684\u4e00\u4e00\u5bf9\u5e94\u3002\n\n1. \u82e5 $0\\le x\\le m-a$\uff0c\u5219 $a\\le a+x\\le m$\uff0c\u5408\u6cd5\u7684 $a+x$ \u4e00\u4e00\u5bf9\u5e94 $[a,m]$ \u4e2d\u4e0e $m$ \u4e92\u8d28\u7684\u6570\u3002\n\n2. \u82e5 $m-a+1\\le x< m$\uff0c\u5219 $m+1\\le a+x\\le m+a-1$\u3002\u56e0\u4e3a $\\gcd(u+v,v)=\\gcd(u,v)$\uff0c\u6240\u4ee5 $u\\perp v \\Leftrightarrow (u+v)\\perp v$\uff0c\u4e8e\u662f\u6211\u4eec\u5f97\u5230 $(a+x)\\perp m\\Leftrightarrow (a+x-m)\\perp m$\u3002\u56e0\u6b64\u5408\u6cd5\u7684 $a+x$ \u4e00\u4e00\u5bf9\u5e94 $[1,a-1]$ \u4e2d\u4e0e $m$ \u4e92\u8d28\u7684\u6570\u3002\n\n\u7efc\u4e0a\uff0c\u6240\u6709\u4e0e $m$ \u4e92\u8d28\u7684 $a+x$ \u4e00\u4e00\u5bf9\u5e94 $[1,m]$ \u4e2d\u6240\u6709\u4e0e $m$ \u4e92\u8d28\u7684\u6574\u6570\uff0c\u6709 $\\varphi(m)$ \u4e2a\u3002\u4e8e\u662f\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa $\\varphi(m)$ \u4f5c\u4e3a\u7b54\u6848\u5373\u53ef\u3002\n\n\u8fd9\u79cd\u65b9\u6cd5\u53ea\u9700\u8981\u6c42 $\\varphi(m)$\uff0c\u9700\u8981\u5bf9 $m$ \u8fdb\u884c\u8d28\u56e0\u6570\u5206\u89e3\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathrm{O}(\\sqrt{m})$\u3002\n\n#### \u62d3\u5c55\n\n\u4e8b\u5b9e\u4e0a\uff0c\u4efb\u610f $m$ \u4e2a\u8fde\u7eed\u6b63\u6574\u6570\u4e2d\u4e0e $m$ \u4e92\u8d28\u7684\u6570\u7684\u4e2a\u6570\u6070\u4e3a $\\varphi(m)$\uff1b\u6216\u8005\u8bf4\uff0c\u628a\u8fd9\u9053\u9898\u4e2d $a<m$ \u7684\u6761\u4ef6\u53bb\u9664\uff0c\u7b54\u6848\u4e0d\u53d8\u3002\u8fd9\u4e2a\u7ed3\u8bba\u53ef\u4ee5\u7528\u4e0a\u8ff0\u4e24\u79cd\u65b9\u6cd5\u6765\u8bc1\u660e\u3002\n\n**\u7528 $\\mu$ \u8bc1\u660e\u3002** \u8bbe $a=qm+r\\ (q,r\\in \\mathbb{N},0\\le r<m)$\uff0c\u5219\u7b54\u6848\u5f0f\u53ef\u4ee5\u8fdb\u884c\u5982\u4e0b\u5316\u7b80\uff1a\n\n$$\\begin{aligned}&\\sum_{d\\mid m}\\mu(d)\\left (\\left \\lfloor \\frac{a+m-1}{d} \\right\\rfloor-\\left\\lfloor \\frac{a-1}{d} \\right\\rfloor\\right )\\\\=&\\sum_{d\\mid m}\\mu(d)\\left (\\left \\lfloor \\frac{qm+r+m-1}{d} \\right\\rfloor-\\left\\lfloor \\frac{qm+r-1}{d} \\right\\rfloor\\right )\\\\=&\\sum_{d\\mid m}\\mu(d)\\left (\\frac{qm}{d}+\\left \\lfloor\\frac{r+m-1}{d} \\right\\rfloor-\\frac{qm}{d}-\\left\\lfloor \\frac{r-1}{d} \\right\\rfloor\\right )\\\\=&\\sum_{d\\mid m}\\mu(d)\\left (\\left \\lfloor\\frac{r+m-1}{d} \\right\\rfloor-\\left\\lfloor \\frac{r-1}{d} \\right\\rfloor\\right )\\\\=&\\varphi(m)\\end{aligned}$$\n\n\u7b2c\u4e00\u884c\u5e26\u5165\u4e86\u65b9\u6cd5\u4e00\u7684\u7b54\u6848\u5f0f\u5b50\uff0c\u7b2c\u4e8c\u884c\u628a $a$ \u4ee3\u6362\u4e3a $qm+r$\uff0c\u7b2c\u4e09\u884c\u5229\u7528\u4e86\u6574\u6570\u53ef\u4ee5\u81ea\u7531\u79fb\u51fa\u53d6\u6574\u7b26\u53f7\u7684\u6027\u8d28\uff0c\u7b2c\u56db\u884c\u628a $\\frac{qm}{d}$ \u53bb\u9664\uff0c\u7b2c\u4e94\u884c\u8fd0\u7528\u4e86\u9898\u76ee\u4e2d\u7b54\u6848\u7684\u6027\u8d28\u3002\n\n**\u7528\u6620\u5c04\u65b9\u6cd5\u8bc1\u660e\u3002** \u53d6\u8fd9\u8fde\u7eed $m$ \u4e2a\u6b63\u6574\u6570\u6a21 $m$ \u7684\u4f59\u6570\uff0c\u4e00\u5b9a\u5206\u522b\u662f $0,1,\\cdots,m-1$\u3002\u6211\u4eec\u628a\u8fd9\u4e9b\u6b63\u6574\u6570\u6839\u636e\u6a21 $m$ \u7684\u4f59\u6570\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u5206\u522b\u8bb0\u4e3a $n_0,n_1,\\cdots,n_k,\\cdots,n_{m-1}$\uff1b\u4e5f\u5c31\u662f\u8bf4\uff0c$n_k\\equiv k\\pmod{m}$\u3002\u7531\u4e8e $\\gcd(a,b)=\\gcd(b,a\\%b)$\uff0c\u56e0\u6b64 $\\gcd(n_k,m)=\\gcd(m,k)$\uff0c\u4e8e\u662f\u6211\u4eec\u5f97\u5230 $n_k\\perp m\\Leftrightarrow k\\perp m$\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u5efa\u7acb\u4e86\u201c$n_0,\\cdots,n_{m-1}$ \u5f53\u4e2d\u4e0e $m$ \u4e92\u8d28\u7684\u6574\u6570\u201d\u548c\u201c$[0,m-1]$ \u4e2d\u4e0e $m$ \u4e92\u8d28\u7684\u6574\u6570\u201d\u7684\u4e00\u4e00\u5bf9\u5e94\uff08\u5047\u8bbe $0$ \u4e0d\u4e0e\u4efb\u4f55\u6570\u4e92\u8d28\uff1b$m=1$ \u7684\u60c5\u51b5\u7279\u6b8a\uff0c\u53ef\u4ee5\u5355\u72ec\u62ff\u51fa\u6765\u8ba8\u8bba\uff09\u3002\u56e0\u6b64\uff0c\u4efb\u610f\u8fde\u7eed $m$ \u4e2a\u6b63\u6574\u6570\u5f53\u4e2d\uff0c\u4e0e $m$ \u4e92\u8d28\u7684\u6570\u4e00\u5171\u6709 $\\varphi(m)$ \u4e2a\u3002\n\n\u540c\u65f6\u901a\u8fc7\u8fd9\u9053\u9898\u7684\u63a8\u5bfc\uff0c\u6211\u4eec\u4e5f\u5f97\u5230\u4e86 $\\varphi$ \u51fd\u6570\u7528\u7ea6\u6570\u7684 $\\mu$ \u51fd\u6570\u8868\u8fbe\u7684\u5f0f\u5b50 $\\varphi(n)=\\sum_{d\\mid n} \\mu(d)\\frac{n}{d}$\uff0c\u4e5f\u5c31\u662f $\\varphi=\\mu*\\mathrm{id}$\u3002\n\n#### \u4ee3\u7801\n\n\u63d0\u4f9b $\\mu$ \u7248\u672c\u548c $\\varphi$ \u7248\u672c\u7684\u4ee3\u7801\u3002\n\n$\\mu$ \u7248\u672c\uff1a\n\n```cpp\n//Submitted on luogu, mu version\n#include <cstdio>\n#include <cctype>\n#include <algorithm>\n#include <cmath>\n#define MAXIOLG 25\nusing namespace std;\n\n//Constant area\n#define MAXN 109005\n\ntypedef long long ll;\ntypedef ll io_t;\nio_t shin[MAXIOLG];\nio_t seto(void); //\u5feb\u8bfb\uff0c\u5b9e\u73b0\u7565\u53bb\nvoid ayano(io_t x,char spliter='\\n'); //\u5feb\u5199\uff0c\u5b9e\u73b0\u7565\u53bb\n\nll prs[MAXN]; //\u5b58\u50a8\u8d28\u56e0\u5b50\n\nll gcd(ll a,ll b);\n\nint main(void){\n    int testcases=seto();\n    while (testcases--){\n        ll a,m,g;\n        ll ans=0;\n        a=seto(),m=seto(),g=gcd(a,m),a/=g,m/=g;\n        if (m==1){\n            ayano(1);\n            continue;\n        }\n        ll sqrm=sqrt(m)+2;\n        ll mm=m;\n        int prcnt=0;\n        for (int i=2;i<=sqrm;i++){\n            if (m/i*i!=m)\n                continue;\n            prcnt++,prs[prcnt]=i;\n            while (m/i*i==m)\n                m/=i;\n        }\n        if (m>1)\n            prcnt++,prs[prcnt]=m;\n        m=mm;\n        //\u679a\u4e3e\u65e0\u5e73\u65b9\u56e0\u5b50\u7684\u7ea6\u6570\n        int ful=1<<prcnt;\n        for (int i=0;i<ful;i++){\n            ll res=1;\n            int tmu=1;\n            int j=i;\n            for (int k=1;k<=prcnt;k++){\n                if (j&1)\n                    res*=prs[k],tmu=-tmu;\n                j>>=1;\n            }\n            ans+=1ll*tmu*((a+m-1)/res-(a-1)/res);\n        }\n        ayano(ans);\n    }\n    return 0;\n}\n\nll gcd(ll a,ll b){\n    ll t;\n    while (b)\n        t=a,a=b,b=t%b;\n    return a;\n}\n```\n\n$\\varphi$ \u7248\u672c\uff1a\n\n```cpp\n//Submitted on luogu, phi version\n#include <cstdio>\n#include <cctype>\n#include <algorithm>\n#include <cmath>\n#define MAXIOLG 25\nusing namespace std;\n\n//Constant area\n#define MAXN 109005\n\ntypedef long long ll;\ntypedef ll io_t;\nio_t shin[MAXIOLG];\nio_t seto(void); //\u5feb\u8bfb\uff0c\u5b9e\u73b0\u7565\u53bb\nvoid ayano(io_t x,char spliter='\\n'); //\u5feb\u5199\uff0c\u5b9e\u73b0\u7565\u53bb\n\nll gcd(ll a,ll b);\n\nint main(void){\n    int testcases=seto();\n    while (testcases--){\n        ll a,m,g;\n        a=seto(),m=seto(),g=gcd(a,m),a/=g,m/=g;\n        ll sqrm=sqrt(m)+2;\n        ll ans=m;\n        for (int i=2;i<=sqrm;i++){\n            if (m/i*i!=m)\n                continue;\n            ans/=i,ans*=(i-1);\n            while (m/i*i==m)\n                m/=i;\n        }\n        if (m>1)\n            ans/=m,ans*=(m-1);\n        ayano(ans);\n    }\n    return 0;\n}\n\nll gcd(ll a,ll b){\n    ll t;\n    while (b)\n        t=a,a=b,b=t%b;\n    return a;\n}\n```",
        "postTime": 1580401138,
        "uid": 25008,
        "name": "Sweetlemon",
        "ccfLevel": 9,
        "title": "\u5408\u7406\u8fd0\u7528\u6570\u8bba\u51fd\u6570\u2014\u2014CF1295D Same GCDs"
    },
    {
        "content": "\u524d\u7f6e\u77e5\u8bc6\uff1a\n- \u8f97\u8f6c\u76f8\u9664\u6cd5\n- \u6b27\u62c9\u51fd\u6570\n\n\u9996\u5148\uff0c\u6839\u636e\u8f97\u8f6c\u76f8\u9664\u6cd5\u6c42 $\\gcd$ \u7684\u516c\u5f0f\uff0c\u53ef\u5f97 $\\gcd(a+x,m)=\\gcd((a+x)\\mod m,m)$\u3002  \n\u5219\u9898\u76ee\u53ef\u4ee5\u8f6c\u5316\u4e3a\uff1a\u6c42\u6709\u591a\u5c11 $x$ \u6ee1\u8db3 $\\gcd(x,m)=\\gcd(a,m)$\uff0c\u8bbe $\\gcd(a,m)$ \u7b49\u4e8e\u5b9a\u503c $k$\u3002  \n\u7b49\u5f0f\u4e24\u8fb9\u540c\u65f6\u9664\u4ee5 $k$\uff0c\u5f97 $\\gcd(\\dfrac{x}{k},\\dfrac{m}{k})=1$\u3002\u5373\u6c42\u4e0e $\\dfrac{m}{k}$ \u4e92\u8d28\u7684\u6570\u7684\u4e2a\u6570\uff0c\u6839\u636e\u6b27\u62c9\u51fd\u6570\u7684\u5b9a\u4e49\u77e5\u7b54\u6848\u4e3a $\\varphi(\\dfrac{m}{k})$\u3002\n\ncode:\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint T,a,m;\nsigned main()\n{\n\tscanf(\"%lld\",&T);\n\twhile(T--)\n\t{\n\t\tscanf(\"%lld%lld\",&a,&m);\n\t\tint n=m/__gcd(a,m);\n\t\tint ans=n;\n\t\tfor(int i=2;i*i<=n;i++)\n\t\t{\n\t\t\tif(n%i==0) ans=ans/i*(i-1);\n\t\t\twhile(n%i==0) n/=i;\n\t\t}\n\t\tif(n>1) ans=ans/n*(n-1);\n\t\tcout<<ans<<endl;\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1657887542,
        "uid": 234074,
        "name": "\u6a31\u96ea\u55b5",
        "ccfLevel": 7,
        "title": "CF1295D Same GCDs"
    },
    {
        "content": "[\u535a\u5ba2\u98df\u7528\u66f4\u4f73](https://www.luogu.com.cn/blog/Sham-Devour/solution-cf1295d)\n\n[\u524d\u7f6e\u829d\u58eb\uff1a\u6b27\u62c9\u51fd\u6570](https://oi-wiki.org/math/euler/)\n\n# $\\texttt{Step 0 \u9898\u610f}$\n\n\u89c1\u9898\u9762\u3002\n\n# $\\texttt{Step 1 \u6b63\u89e3}$\n\n\u7531\u8f97\u8f6c\u76f8\u9664\u6cd5\u5f97\uff1a\n\n$$\\gcd(a+x,m)=\\gcd((a+x)\\mod m,m)$$\n\n\u663e\u7136\uff0c\u5f53 $x$ \u7684\u503c\u57df\u4e3a $[0,m)$ \u65f6\uff0c$(a+x)\\mod m$ \u7684\u503c\u57df\u4e5f\u4e3a $[0,m)$\uff0c\u5219\uff1a\n\n$$\\sum\\limits_{x=0}^{m-1}[\\gcd(a,m)=\\gcd(a+x,m)]=\\sum\\limits_{x=0}^{m-1}[\\gcd(a,m)=\\gcd(x,m)]$$\n\n\u8bbe $\\gcd(a,m)=\\gcd(x,m)=d$\uff0c\u5bb9\u6613\u53d1\u73b0\uff1a\n\n$$\\gcd(\\frac{x}{d},\\frac{m}{d})=1$$\n\n\u4e8e\u662f\u95ee\u9898\u8f6c\u5316\u4e3a\u6bd4 $\\frac{m}{d}$ \u5c0f\u4e14\u4e0e\u5176\u4e92\u8d28\u7684\u6570\u7684\u4e2a\u6570\uff0c\u6240\u4ee5\u7b54\u6848\u4e3a\uff1a\n\n$$\\phi(\\frac{m}{\\gcd(a,m)})$$\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(\\sqrt{\\frac{m}{\\gcd(a,m)}})$\n\n# $\\texttt{Step 2 \u4ee3\u7801}$\n\n```cpp\n#include <cstdio>\n#include <iostream>\n\nusing namespace std;\n\ntypedef long long ll;\nll gcd (ll x, ll y) {return y == 0 ? x : gcd(y, x % y);}\n\nll phi (ll n) {\n\tll ans = n;\n\tfor (ll i = 2; i * i <= n; i++)\n\t\tif (n % i == 0) {\n\t\t\tans = ans / i * (i - 1);\n\t\t\twhile (n % i == 0)\n\t\t\t\tn /= i;\n\t\t}\n\tif (n > 1)\n\t\tans = ans / n * (n - 1);\n\treturn ans;\n}\n\nint main () {\n\tint T;\n\tscanf(\"%d\", &T);\n\twhile (T--) {\n\t\tll a, m;\n\t\tscanf(\"%lld %lld\", &a, &m);\n\t\tprintf(\"%lld\\n\", phi(m / gcd(a, m)));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1612502097,
        "uid": 365542,
        "name": "SDqwq",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1295D \u3010Same GCDs\u3011"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u79cd\u7406\u8bba\u590d\u6742\u5ea6\u66f4\u4f18\u7684\u505a\u6cd5\u3002\n\n\u7531\u8f97\u8f6c\u76f8\u9664\u6cd5\u53ef\u5f97 $ \\gcd(a+x,m)=\\gcd((a+x) \\bmod m,m) $\n\n\u5219\u8f6c\u5316\u4e3a\u6c42 $ m-1 $ \u4ee5\u5185\u6ee1\u8db3 $ \\gcd(x,m)=\\gcd(a,m) $ \u7684 $ x $ \u7684\u4e2a\u6570\u3002\n\n\u4e0d\u59a8\u628a $ x $ \u9664\u4ee5 $ \\gcd(a,m) $ \uff0c\u5219\u95ee\u9898\u8f6c\u5316\u4e3a\u6c42\u5c0f\u4e8e $ \\frac{m}{\\gcd(a,m)} $ \u5e76\u4e0e\u5176\u4e92\u8d28\u7684\u6570\u7684\u6570\u91cf\uff0c\u5373 $ \\varphi(\\frac{m}{\\gcd(a,m)}) $\u3002\n\n\u63a5\u4e0b\u6765\u662f\u91cd\u70b9\u3002\n\n\u56e0\u4e3a\u9898\u76ee\u53ea\u8981\u6c42\u5355\u6b21\u8be2\u95ee\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528 Pollard-rho \u5feb\u901f\u5206\u89e3\u8d28\u56e0\u6570\u7684\u65b9\u6cd5\u5728 $ \\mathcal{O}(n^{1/4}) $ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u6c42\u51fa $ \\varphi(n) $ \u7684\u503c\u3002\n\n\u5177\u4f53\u65b9\u6cd5\u662f\u6c42\u51fa\u6240\u6709\u8d28\u56e0\u5b50\u4e4b\u540e\uff0c\u8bbe\u5f53\u524d\u8d28\u56e0\u5b50\u4e3a $ d $ \uff0c\u8ba1\u7b97\u6bcf\u4e2a\u8d28\u56e0\u5b50\u540e\u6bcf\u6b21\u4e58\u4e0a $ \\frac{d-1}{d} $ \u5373\u53ef\u3002\n\n\u5b9e\u73b0\u4e0a\u6ce8\u610f\u4e24\u4e2a $ 10^{10} $ \u7ea7\u522b\u7684\u6570\u76f8\u4e58\u9700\u8981\u7528\u5feb\u901f\u4e58\u6216\u8005\u5f00 int128 \u4e58\u6cd5\u5373\u53ef\u3002\n\n\u5b9e\u9645\u4e0a\u8dd1\u5f97\u5f88\u5feb\uff0c\u4f46\u6ca1\u8dd1\u8fc7\u6700\u4f18\u89e3\u3002\n\n\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $ \\mathcal{O}(Tn^{\\frac{1}{4}}) $\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define gc c=getchar()\n#define r(x) read(x)\n#define ll long long\n#define int long long\ntemplate<typename T>\ninline void read(T&x)\n{\n    x=0;T k=1;char gc;\n    while(!isdigit(c)){if(c=='-')k=-1;gc;}\n    while(isdigit(c)){x=x*10+c-'0';gc;}x*=k;\n}\n#define li inline\n#define re register\ninline int add(int a,int b,int p)\n{\n\ta+=b;\n\tif(a>=p)\n    a-=p;\n\treturn a;\n}\ninline int mul(int a,int b,int mod)\n{\nreturn (a*b-(int)((long double)a/mod*b)*mod+mod)%mod;\n}\nll pow(ll a, ll b, ll m) \n{\n  ll ans = 1;\n  for (a %= m; b; b >>= 1, a = mul(a, a, m))\n    if (b & 1) \n    ans = mul(ans, a, m);\n  return ans;\n}\nll gcd(ll a,ll b)\n{\n\treturn b?gcd(b,a%b):a;\n}\nll lcm(ll a,ll b)\n{\n\treturn a/gcd(a,b)*b;\n}\nbool MR_check(ll a, ll p, ll s, int d) \n{\n  ll k = pow(a, s, p);\n  if (k == 1) return true;\n  for (; d; --d, k = mul(k, k, p)) \n  {\n    if (k == p - 1) \n    return true;\n    if (k == 1) \n    return false;\n  }\n  return k == 1;\n}\nbool MR(ll x) \n{\n  static const int cnt = 12;\n  static const int p[cnt] = { 2, 3, 5, 7, 11, 13, 17, 19, 61, 2333, 4567, 24251 };\n  if (x == 1) \n  return false;\n  ll s = x - 1; \n  int d = 0;\n  while (!(s & 1)) \n  ++d, s >>= 1;\n  for (int i = 0; i < cnt; ++i) \n  {\n    if (x % p[i] == 0) \n    return x == p[i];\n    if (!MR_check(p[i], x, s, d)) \n    return false;\n  }\n  return true;\n}\nnamespace Pollard_Rho \n{\nll PR_check(ll c, ll p) \n{\n  ll y = rand() % p, z = y;\n  int k = 1, j = 0;\n  while(1145141919810) \n  {\n    z = (mul(z, z, p) + c) % p;\n    ll t = gcd(p, std::abs(z - y));\n    if (t > 1) \n    return t;\n    if (++j == k) \n    y = z, k <<= 1;\n  }\n}\nvoid factor_(ll x, std::vector<ll> &v) \n{\n  if (x == 1) return;\n  if (MR(x)) { v.push_back(x); return; }\n  ll y = x;\n  while (y == x) y = PR_check(rand() % x, x);\n  factor_(y, v);\n  factor_(x / y, v);\n}\nvoid factor(ll x, std::vector<ll> &v) \n{\n  v.clear();\n  if (!(x & 1)) { v.push_back(2); x /= (x & -x); }\n  factor_(x, v);\n  std::sort(v.begin(), v.end());\n  v.erase(std::unique(v.begin(), v.end()), v.end());\n}\n}\nusing Pollard_Rho::factor;\nstruct fib \n{\n  ll a, b; \n  fib(ll a, ll b) : a(a), b(b) {}\n};\nfib mul(const fib &u, const fib &v, ll m) \n{\n  ll x = mul(u.a, v.a, m), y = mul(u.b, v.b, m),\n     z = mul(u.a + u.b, v.a + v.b, m);\n  return fib((x + y) % m, (z - x + m) % m);\n}\nbool check_period(ll d, ll m) \n{\n  fib ans(1, 0), a(0, 1);\n  for (; d; d >>= 1, a = mul(a, a, m))\n    if (d & 1) ans = mul(ans, a, m);\n  return ans.a == 1 && ans.b == 0;\n}\ninline int query(int x)\n{\n\tif(x==2)\n    return 3;\n\tif(x==3)\n    return 8;\n\tif(x==5)\n    return 20;\n\tll t = (x % 10 == 1 || x % 10 == 9) ? x - 1 : 2 * (x + 1);\n  vector<ll> d;\n  factor(t, d);\n  for (auto g : d)\n    while (!(t % g) && check_period(t / g, x))\n      t /= g;\n  return t;\n}\ninline ll solve(int n)\n{\n\tll ans=1;\n    vector<int>d;\n    factor(n, d);\n    for(auto res:d)\n    {\n    int p=1;\n    while(n%res==0)\n    n/=res,p*=res;\n    ans=lcm(ans,p/res*query(res));\n    }\n\treturn ans;\n}\nsigned main()\n{\n    int T;\n    for(r(T);T;--T)\n    {\n    \tint a,n;\n        r(a),r(n);\n        n=n/gcd(a,n);\n        vector<int>d;\n    \tPollard_Rho::factor(n,d);\n        for(auto x:d)\n        n/=x,n*=(x-1);\n        printf(\"%lld\\n\",n);\n    }\n}\n```\n",
        "postTime": 1661433998,
        "uid": 714821,
        "name": "loser_seele",
        "ccfLevel": 4,
        "title": "CF1295D\u9898\u89e3"
    },
    {
        "content": "\u4e00\u773c\u770b\u4e0a\u53bb\u8fd8\u662f\u6709\u70b9\u96be\u5ea6\u7684\u3002\n\n## \u601d\u8def\n\n\u9996\u5148\u770b\u5230\u4e86 $x$ \u662f $[0,m-1]$\uff0c\u6b63\u597d\u5bf9\u5e94\u4e86 $m$ \u6240\u6709\u7684 mod \u503c\u3002\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u7a0d\u4f5c\u63a8\u5bfc\uff1a\n\n$\\gcd(a+x,m) = \\gcd((a+x) \\% m,m)$\u3002\n\n\u53c8\u56e0\u4e3a $x$ \u662f $[0,m-1]$ \u7684\uff0c\u6240\u4ee5\u5f97\u51fa\uff1a\n\n$$\\sum\\limits_{x=0}^{m-1} (a+x)\\%m = \\sum_{x=0}^{m-1} x \\% m$$\n\n\u56e0\u4e3a\uff0c\u65e0\u8bba $a\\%m$ \u53d6\u4f55\u503c\uff0c\u603b\u4f1a\u201c\u7ed5\u4e00\u5708\u201d\u56de\u6765\u3002\u6bd4\u5982\uff1a\u5bf9 5 \u53d6\u6a21\u4f1a\u5f97\u5230 ```0 1 2 3 4``` \u8fd9 5 \u79cd\u4e0d\u540c\u7684\u503c\uff0c\u628a\u8fd9\u4e2a\u503c\u7684\u4e32\u9996\u5c3e\u76f8\u8fde\u7ec4\u6210\u4e00\u4e2a\u73af\uff0c\u65e0\u8bba\u4ece\u54ea\u4e2a\u70b9\u5f00\u59cb\u8d70 $m-1$ \u6b21\u603b\u4f1a\u904d\u5386\u6240\u6709\u7684\u70b9\u3002\n\n\u90a3\u4e48\u539f\u5f0f\u5c31\u8f6c\u5316\u6210\uff1a\n\n$$\\sum\\limits_{x=0}^{m-1}[\\gcd(a,m) = \\gcd(x,m)]$$\n\n\u90a3\u4e48\u6211\u4eec\u4ee4 $p = \\gcd(a,m)$\u3002\u4e8e\u662f\u5f97\u5230\u8fd9\u4e2a\u5f0f\u5b50\uff1a\n\n$$\\sum\\limits_{x=0}^{m-1}[\\frac{\\gcd(a,m)}{p} = \\frac{\\gcd(x,m)}{p}]$$\n\n\u4e5f\u5c31\u662f\uff1a\n\n$$\\sum\\limits_{x=0}^{m-1}[1 = \\frac{\\gcd(x,m)}{p}]$$\n\n\u5373\u6c42\uff1a\n\n$$\\phi(\\frac{\\gcd(x,m)}{p})$$\n\n\u8fd9\u4e2a\u663e\u7136\u53ef\u4ee5 $O(\\sqrt{n})$ \u6c42\u51fa\u3002\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(T \\sqrt{n})$\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define ll long long\nll phi(ll x)\n{\n\tll ans=x;\n\tfor(ll i=2;i*i<=x;i++)\n\t\tif(x%i==0)\n\t\t{\n\t\t\tans=ans/i*(i-1);\n\t\t\twhile(x%i==0) x/=i;\n\t\t}\n\tif(x>1) ans=ans/x*(x-1);\n\treturn ans;\n}\nint main()\n{\n\tint T; cin>>T;\n\twhile(T--)\n\t{\n\t\tll a,b; cin>>a>>b;\n\t\tll qwq=__gcd(a,b);\n\t\tprintf(\"%lld\\n\",phi(b/qwq));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1652671162,
        "uid": 195198,
        "name": "E1_de5truct0r",
        "ccfLevel": 7,
        "title": "CF1295D \u9898\u89e3"
    },
    {
        "content": "\u8c14\u8c14\uff0c\u7b2c\u4e00\u7bc7\u9898\u89e3\u6709\u70b9\u8fc7\u4e8e\u7b80\u7565\u4e86\u5427(\n\n\u8fdb\u5165\u6b63\u9898\uff0c\u9898\u76ee\u8bf4\u8981\u6c42\u4f7f\u5f97$gcd(a+x,m)=gcd(a,m)$\u6210\u7acb\u7684$x$\u7684\u4e2a\u6570\n\n\u90a3\u4e48\u8fd9\u9053\u9898\u663e\u7136\u53ef\u4ee5\u7528\u83ab\u53cd\uff0c\u4f46\u662f\u4e0d\u5fc5\u90a3\u4e48\u9ebb\u70e6\u3002\u4f17\u6240\u5468\u77e5\uff0c$gcd(a,b)=gcd(a-b,b)$\uff0c\u90a3\u4e48\u8fd9\u4e2a\u9898\u76ee\u5c31\u6210\u4e86\u6c42\u591a\u5c11\u4e2a$x$\u6ee1\u8db3$gcd(a,m)=gcd(x,m)$\u3002\u6240\u4ee5\u7b54\u6848\u5c31\u662f$\\varphi(\\frac{m}{gcd(a,m)})$\u4e86\uff01~~\uff08\u4f60\u770b\u591a\u660e\u4e86\u7b80\u6d01\u7684\u5f0f\u5b50\uff09~~\n\n\u5f88\u597d\u5199\uff0c\u56e0\u4e3a\u53ea\u6c42\u4e00\u6b21\uff0c\u6240\u4ee5\u5e76\u4e0d\u7528\u5904\u7406\u51fa\u6240\u6709\u7684$\\varphi$\uff0c\u90a3\u4e48\u5c31\u662f\u8fd9\u4e2a\u6837\u5b50\u7684\u4e86\u3002\n\n### $ACcode$: \n```\n#include<bits/stdc++.h>\n#define F(i,l,r) for(register int i=l;i<=r;i++)\n#define D(i,r,l) for(register int i=r;i>=l;i--)\n#define ll long long\n#define mem(a,b) memset(a,b,sizeof(a))\n#define p_b push_back\n#define m_p make_pair\n#define il inline\nconst int INF=0x3f3f3f3f;\nusing namespace std;\nll a,m;\nint T;\nll phi(ll x) {//\u5f00ll\u554a\u5582\n\tll ans=x;\n\tF(i,2,sqrt(x)) {\n\t\tif(x%i==0) {\n\t\t\tans=ans/i*(i-1);\n\t\t\twhile(x%i==0) x/=i;\n\t\t}\n\t}\n\tif(x>1) ans=ans/x*(x-1);//\u6839\u636ephi\u7684\u5b9a\u4e49\u6765\u6c42\u89e3\n\treturn ans;\n}\nint main() {\n\tscanf(\"%d\",&T);\n\twhile(T--) {\n\t\tscanf(\"%lld%lld\",&a,&m);\n\t\tprintf(\"%lld\\n\",phi(m/(__gcd(a,m))));//\u7b80\u5355\u7684\u5f0f\u5b50\n\t}\n\treturn 0;\n}\n```\n\n~~\u6c42\u53cd\u624b\u7559\u8d5eQAQ~~",
        "postTime": 1601802463,
        "uid": 117648,
        "name": "tuzhewen",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 CF1295D \u3010Same GCDs\u3011"
    },
    {
        "content": "\u597d\u50cf\u6ca1\u6709\u770b\u5230\u4ec0\u4e48\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u89e3\u6cd5\uff0c\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e0b\u3002\n\n\u8981\u4ee4 $gcd(a,m)=gcd(a+k,m)$\uff0c\u4ec0\u4e48\u4e5f\u770b\u4e0d\u51fa\u6765\uff0c\u90a3\u5c31\u5148\u6c42\u51fa $d=gcd(a,m)$ \u518d\u8bf4\u5427\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u662f\u8981\u6c42 $|\\{k|a\\leq k\\leq a+m-1,gcd(k,m)=d\\}|$\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u5bb9\u65a5\u4e00\u4e0b\uff0c\u4ee4 $f(x)=|\\{k|k\\leq x,gcd(k,m)=d\\}|$\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f $f(a+m-1)-f(a-1)$\u3002\n\n\u4e0b\u9762\u5c31\u662f\u4e00\u4e2a\u5f88\u7b80\u5355\u7684\u63a8\u5bfc\u3002\n\n$$f(n)=\\sum\\limits_{i=1}^n [gcd(i,m)=d]$$\n\n$$f(n)=\\sum\\limits_{i=1}^{n/d} [gcd(i,m/d)=1]$$\n\n$$f(n)=\\sum\\limits_{i=1}^{n/d} \\sum\\limits_{p|i,p|\\frac{m}{d}} \\mu(p)$$\n\n$$f(n)=\\sum\\limits_{p|\\frac{m}{d}}\\mu(p) \\dfrac{n}{pd}$$\n\n\u4e8e\u662f\u679a\u4e3e $\\dfrac{m}{d}$ \u7684\u56e0\u6570\u7b97 $\\mu$ \u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u8fd9\u91cc\u6211\u91c7\u7528\u4e86\u5206\u89e3\u7d20\u56e0\u6570\u540e DFS \u7b97 $\\mu$\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\nusing namespace std;\nll t,a,m,tot;\npair<ll,ll> p[30];\nll gcd (ll a,ll b) {return (b==0?a:gcd(b,a%b));}\nll dfs (ll a,ll ly,ll prod,ll n) {\n\tif (ly==tot+1) {return a*(n/prod);}\n\tll res=0;\n\tfor (int i=0;i<=1;i++) {\n\t\tres+=dfs(a,ly+1,prod,n);\n\t\tprod*=p[ly].first;\n\t\tif (i==0) {a*=-1;}\n\t}\n\treturn res;\n}\nint main () {\n\tscanf(\"%lld\",&t);\n\tfor (int ii=1;ii<=t;ii++) {\n\t\tscanf(\"%lld%lld\",&a,&m);\n\t\tll cpy=m,tmp=gcd(a,m);\n\t\tm/=tmp;\n\t\ttot=0;\n\t\tfor (ll i=2;i*i<=m;i++) {\n\t\t\tif (m%i==0) {\n\t\t\t\ttot++;\n\t\t\t\tll sum=0;\n\t\t\t\twhile (m%i==0) {sum++,m/=i;}\n\t\t\t\tp[tot]=make_pair(i,sum);\n\t\t\t}\n\t\t}\n\t\tif (m>1) {p[++tot]=make_pair(m,1);}\n\t\tprintf(\"%lld\\n\",dfs(1,1,1,(a+cpy-1)/tmp)-dfs(1,1,1,(a-1)/tmp));\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1580363105,
        "uid": 113546,
        "name": "ix35",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1295D \u3010Same GCDs\u3011"
    },
    {
        "content": "[\u6211\u7684blog](https://www.cnblogs.com/wangjunrui/p/12242400.html)\n> > \u9898\u76ee\u94fe\u63a5\uff1a[CF1295D Same GCDs](https://www.luogu.com.cn/problem/CF1295D)\n\n$$description$$\n\n\u7ed9\u5b9a$a,m$\uff0c\u6c42\u51fa\u6709\u591a\u5c11\u4e2a$x$\u6ee1\u8db3$0\\leq x<m$\u4e14\n$$gcd(a,m)=gcd(a+x,m)$$\n\n$gcd(x,y)$\u8868\u793a$x$\u548c$y$\u7684\u6700\u5927\u516c\u56e0\u6570\n\n$$solution$$\n\n\u6570\u8bba\u9898\n\n\u8003\u8651\u8bbe$d=gcd(a,m)$\n\n\u80af\u5b9a\u6ee1\u8db3$d|a,d|m,d|(a+x)$\n\n$\\therefore d|x$\n\n### \u7ed3\u8bba1\uff1a\n$$gcd(\\frac{a+x}{d},\\frac{m}{d})=1$$\n### \u8bc1\u660e\uff1a\n\u5047\u8bbe$gcd(\\frac{a+x}{d},\\frac{m}{d})\\neq 1$\n\n\u5373$gcd(\\frac{a+x}{d},\\frac{m}{d})> 1$\n\n\u6b64\u65f6\n$$gcd(a+x,m)=gcd(\\frac{a+x}{d}\\times d,\\frac{m}{d}\\times d)>d$$\n\n\u5373$gcd(a+x,m)\\neq gcd(a,m)$\n\n\u4e92\u76f8\u77db\u76fe\n\n\u7efc\u4e0a\u6240\u8ff0\uff1a$gcd(\\frac{a+x}{d},\\frac{m}{d})=1$\u6210\u7acb\n\n### \u7ed3\u8bba2\uff1a\n\u7b54\u6848\u662f\n$$\\varphi(\\frac{m}{d})$$\n\n\u663e\u7136\u5bf9\u4e0e\u4efb\u610f\u4e0em\u4e92\u8d28\u7684\u6570$p$\u548c\u4efb\u610f\u6b63\u6574\u6570$k$\n\u6ee1\u8db3\uff1a\n$$gcd(p+\\frac {km}{d},\\frac{m}{d})=gcd((p+k\\frac{m}{d})\\ mod\\ \\frac{m}{d},\\frac{m}{d})=gcd(p,\\frac{m}{d})=1$$\n\n\u663e\u7136$p+\\frac {km}{d}$\u4e0e$\\frac{m}{d}$\u4e92\u8d28\n\n\u5bf9\u4e8e\u5f53$a+x\\leq m$\uff0c\u7b54\u6848\u662f$\\frac{a}{d}\\leq x\\leq \\frac{m}{d}$\u7684\u4e0e$\\frac{m}{d}$\u4e92\u8d28\u7684\u4e2a\u6570\n\n\u5bf9\u4e8e\u4e0e$m<a+x<a+m$\uff0c\u7b54\u6848\u662f$x<\\frac{a}{d}$\u7684\u4e0e$\\frac{m}{d}$\u4e92\u8d28\u7684\u4e2a\u6570\n\n\u4e24\u4e2a\u7b54\u6848\u533a\u95f4\u5408\u5e76\u5373\u662f$\\varphi(\\frac{m}{d})$\n\n### \u6b27\u62c9\u51fd\u6570:\n\u5176\u4e2d$p_1, p_2\u2026\u2026p_k$\u4e3a$n$\u7684\u6240\u6709\u8d28\u56e0\u6570\uff0c$n$\u662f\u4e0d\u4e3a$0$\u7684\u6574\u6570\u3002$\\varphi(1)=1$\uff08\u552f\u4e00\u548c$1$\u4e92\u8d28\u7684\u6570\u5c31\u662f$1$\u672c\u8eab\uff09\u3002\n\n$$\\varphi(n)=n\\prod _ {i=1}^{k}(1-\\frac{1}{p_i})$$ \n\n\u56e0\u4e3an\u6700\u591a\u6709\u4e00\u4e2a\u5927\u4e8e$\\sqrt{n}$\u7684\u8d28\u56e0\u6570\n\n\u6240\u4ee5\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u4ee3\u7801\n```cpp\ninline long long Eular(long long n)\n{\n\tlong long ans=n;\n\tfor(re int i=2; 1ll*i*i<= n; i++)\n\t{\n\t\tif(n%i==0)\n\t\t{\n\t\t\tans-=ans/i;\n\t\t\twhile(n%i==0)\n\t\t\t\tn/=i;\n\t\t}\n\t}\n\tif(n>1)\n\t\tans-=ans/n;\n\treturn ans;\n}\n```\n\u6b27\u62c9\u51fd\u6570\u590d\u6742\u5ea6$O(\\sqrt n)$\n\n\u7b97\u6cd5\u603b\u590d\u6742\u5ea6$O(T\\sqrt n)$\n\n$$code$$\n\n```cpp\n#include<cstdio>\n#define re register\n#define ll long long\nusing namespace std;\ntemplate<typename T>\ninline void read(T&x)\n{\n\tx=0;\n\tchar s=(char)getchar();\n\tbool flag=false;\n\twhile(!(s>='0'&&s<='9'))\n\t{\n\t\tif(s=='-')\n\t\t\tflag=true;\n\t\ts=(char)getchar();\n\t}\n\twhile(s>='0'&&s<='9')\n\t{\n\t\tx=(x<<1)+(x<<3)+s-'0';\n\t\ts=(char)getchar();\n\t}\n\tif(flag)\n\t\tx=(~x)+1;\n\treturn;\n}\ninline ll gcd(ll a,ll b)\n{\n\treturn b==0?a:gcd(b,a%b);\n}\n \ninline long long Eular(long long n)\n{\n\tlong long ans=n;\n\tfor(re int i=2; 1ll*i*i<= n; i++)\n\t{\n\t\tif(n%i==0)\n\t\t{\n\t\t\tans-=ans/i;\n\t\t\twhile(n%i==0)\n\t\t\t\tn/=i;\n\t\t}\n\t}\n\tif(n>1)\n\t\tans-=ans/n;\n\treturn ans;\n}\nint T;\nint main()\n{\n\tread(T);\n\twhile(T--)\n\t{\n\t\tll a,m;\n\t\tread(a),read(m);\n\t\tprintf(\"%lld\\n\",Eular(m/gcd(a,m)));\n\t}\n \n\treturn 0;\n}\n\n\n\n```",
        "postTime": 1580356212,
        "uid": 133322,
        "name": "QwQ\u849f\u84bbwjr",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1295D \u3010Same GCDs\u3011"
    },
    {
        "content": "## \u9898\u76ee\u63cf\u8ff0\n\n\u95ee\u5b58\u5728\u591a\u5c11\u4e2a $x$ \u6ee1\u8db3 $0\\le x<m$ \uff0c\u4f7f\u5f97 $\\gcd(a,m)=\\gcd(a+x,m)$\n\n---\n\n\u6211\u4eec\u5c06\u9898\u76ee\u5f62\u5f0f\u5316\uff1a\n\n$$\n\\sum\\limits_{x=0}^{m-1}[\\gcd(a,m)=\\gcd(a+x,m)]\n$$\n\n\u6211\u4eec\u628a\u53ef\u4ee5\u5feb\u901f\u6c42\u5f97\u5e38\u6570\u66ff\u6362\u6389\u3002\u8bbe $k=\\gcd(a,m)$\uff0c\u6c42\n\n$$\n\\sum\\limits_{x=0}^{m-1}[\\gcd(a+x,m)=k]\n$$\n\n\u4e3a\u4e86\u770b\u5f97\u8212\u670d\u4e00\u70b9\uff0c\u6211\u4eec\u5c06\u5f0f\u5b50\u6539\u4e3a\n\n$$\n\\sum\\limits_{x=a}^{m+a-1}[\\gcd(x,m)=k]\n$$\n\n\u7136\u540e\u89c2\u5bdf\u5f0f\u5b50\uff0c\u6211\u4eec\u53d1\u73b0 $\\sum\\limits_{x=a}^{m+a-1}$ \u8fd9\u79cd\u5f62\u5f0f\u7684\u7d2f\u52a0\u7c7b\u4f3c\u6c42\u4e00\u4e2a\u533a\u95f4\u5185\u7684\u548c\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5bb9\u65a5\uff0c\u8bbe\n\n$$\nf(n)=\\sum\\limits_{i=0}^{n}[\\gcd(i,m)=k]\n$$\n\n\u90a3\u4e48\u539f\u5f0f\u7b49\u4e8e $f(m+a-1)-f(a-1)$\u3002\n\n\u663e\u7136 $f(n)$ \u7684\u5f62\u5f0f\u662f\u6211\u4eec\u6240\u559c\u6b22\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u66b4\u529b\u4e0a\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u3002\n\n$$\n\\begin{aligned}\nf(n)&=\\sum\\limits_{i=0}^{n}[\\gcd(i,m)=k]\\\\\n&=\\sum\\limits_{i=0}^{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}[\\gcd(i,\\frac{m}{k})=1]\\\\\n&=\\sum\\limits_{i=0}^{\\left\\lfloor\\frac{n}{k}\\right\\rfloor}\\sum\\limits_{d\\mid i,d\\mid \\frac{m}{k}}\\mu(d)\\\\\n&=\\sum\\limits_{d\\mid \\frac{m}\n{k}}\\mu(d)\\sum\\limits_{i=0}^{\\left\\lfloor\\frac{n}{dk}\\right\\rfloor}1\\\\\n&=\\sum\\limits_{d\\mid \\frac{m}{k}}\\mu(d)\\left\\lfloor\\dfrac{n}{dk}\\right\\rfloor\n\\end{aligned}\n$$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u7684\u590d\u6742\u5ea6\u5c5e\u4e8e\u6211\u4eec\u53ef\u63a5\u53d7\u7684\u8303\u56f4\uff0c\u76f4\u63a5\u8ba1\u7b97\u5373\u53ef\u3002\n\n## CODE\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nint t,a,m,k;\nint mu(int x)\n{\n\tint res=1;\n\tfor(int i=2;i*i<=x;i++)\n\t{\n\t\tif(x%i!=0) continue;\n\t\tint cnt=0;\n\t\twhile(x%i==0) x/=i,cnt++;\n\t\tif(cnt>1) return 0;\n\t\tres*=(-1);\n\t}\n\tif(x!=1) res*=(-1);\n\treturn res;\n}\nint f(int n)\n{\n\tint res=0;\n\tfor(int i=1;i*i<=m;i++)\n\t{\n\t\tif(m%i!=0) continue;\n\t\tres+=(mu(i)*n/i);\n\t\tif(m/i==i) continue;\n\t\tres+=(mu(m/i)*n/(m/i));\t\n\t}\n\treturn res;\n}\nsigned main()\n{\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\tcout.tie(0);\n\tcin>>t;\n\twhile(t)\n\t{\n\t\tt--;\n\t\tcin>>a>>m;\n\t\tk=__gcd(a,m);\n\t\tm/=k;\n\t\tcout<<f((m*k+a-1)/k)-f((a-1)/k)<<'\\n';\n\t}\n\treturn 0;\n}\n```\n## \u66f4\u4f18\u7684\u65b9\u6cd5\n\n\u66b4\u529b\u63a8\u5f0f\u5b50\u786e\u5b9e\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\u4f46\u662f\u5982\u679c\u6211\u4eec\u4ed4\u7ec6\u89c2\u5bdf\u9898\u76ee\u4e2d\u7684\u6761\u4ef6\uff0c\u5c31\u80fd\u5f97\u5230\u4e00\u79cd\u66f4\u52a0\u7b80\u6d01\u7684\u89e3\u9898\u601d\u8def\u3002\n\n\u8003\u8651\u66f4\u76f8\u51cf\u635f\u6cd5\uff0c\u663e\u7136\u6709 $\\gcd(a,b)=gcd(a-b,b)$\uff0c\u56e0\u6b64 $\\gcd(a+x,m)=\\gcd( a+x-a,m)=\\gcd(x,m)$\uff0c\u56e0\u6b64\u539f\u9898\u53d8\u4e3a\u6c42\u6709\u591a\u5c11\u4e2a $x$ \u4f7f\u5f97 $\\gcd(x,m)=\\gcd(a,m)$\uff0c\u81ea\u7136\u4e5f\u5c31\u662f $\\varphi\\left(\\dfrac{m}{\\gcd(a,m)}\\right)$\u3002",
        "postTime": 1660208324,
        "uid": 488775,
        "name": "_SAI_",
        "ccfLevel": 5,
        "title": "CF1295D Same GCDs   \u9898\u89e3"
    },
    {
        "content": "\u4ee4 $d=\\gcd(a,m)$\uff0c\u5219\u6709 $\\gcd(a/d,m/d)=1$\uff0c\u6240\u4ee5\u9898\u610f\u5c31\u662f\u6c42 $\\sum_{i=1}^{m/d} [\\gcd(i,m/d)=1]=phi(m/d)$\u3002\n\n\u8bd5\u9664\u6cd5\u6c42 $\\phi(m/d)$\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(T*\\sqrt{m})$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint T,a,m;\nint gcd(int a,int b){return b?gcd(b,a%b):a;}\ninline int phi(int x){\n\tint ans=x;\n\tfor(int i=2;i<=sqrt(x);i++){\n\t\tif(x%i==0){\n\t\t\tans=ans/i*(i-1);\n\t\t\twhile(x%i==0)x/=i;\n\t\t}\n\t}\n\tif(x>1)ans=ans/x*(x-1);\n\treturn ans;\n}\nsigned main(){\n\tscanf(\"%lld\",&T);\n\twhile(T--){\n\t\tscanf(\"%lld%lld\",&a,&m);\n\t\tint d=gcd(a,m);\n\t\tprintf(\"%lld\\n\",phi(m/d));\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1622467204,
        "uid": 128269,
        "name": "\u5b57\u5982\u5176\u4eba",
        "ccfLevel": 7,
        "title": "CF1295D\u9898\u89e3"
    },
    {
        "content": "## 1.\u524d\u7f6e\u77e5\u8bc6\n[\u6b27\u62c9\u51fd\u6570](https://oi-wiki.org/math/euler/)&[gcd](https://oi-wiki.org/math/gcd/)\n\n## 2.\u63a8\u67ff\u5b50\n\u8bbe $d = \\gcd(a,m)$ \n\n$$\n\\therefore \\gcd(\\frac{a}{d},\\frac{m}{d})=\\gcd(\\frac{a+x}{d},\\frac{m}{d})=1\n$$\n\u6240\u4ee5\u7b54\u6848\u5373\u4e3a$\\varphi(\\dfrac md)$,\u6c42\u4e00\u4e0b\u5c31\u597d\u5566\uff01\n\n## 3.\u65f6\u95f4\u590d\u6742\u5ea6\n\n$$\n\\mathcal O(\\sqrt\\frac{m}{\\gcd(a,m)})\n$$\n",
        "postTime": 1615284946,
        "uid": 313249,
        "name": "Energy_Making",
        "ccfLevel": 0,
        "title": "CF1295D\u9898\u89e3"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u79cd\u5bb9\u65a5\u505a\u6cd5, \u5176\u5b9e\u548c\u6b27\u62c9\u51fd\u6570\u505a\u6cd5\u672c\u8d28\u6ca1\u4ec0\u4e48\u533a\u522b, ~~\u6bd5\u7adf\u90fd\u662f\u5bb9\u65a5~~\n\n\u9996\u5148\u8981\u6c42\u7684\u662f\u8fd9\u4e2a\u4e1c\u897f\n\n$$\\sum_{i=0}^{m-1} [\\ \\gcd(a, m) = \\gcd(a + i, m)\\ ]$$\n\n\u8bbe $b = \\gcd(a, m)$, \u4ee4 $a = p \\cdot b,\\ m = q \\cdot b$, \u539f\u5f0f\u53ef\u5316\u4e3a\n\n$$\\sum_{i=0}^{m-1} [\\ \\gcd(pb + \\frac{i}{b}, qb) = b \\ ]$$\n\n$$\\sum_{i=0}^{m-1} [\\ \\gcd(p + \\frac{i}{b}, q) = 1 \\ ]$$\n\n\u5373 $[ p,\\ p + \\lfloor \\dfrac{m-1}{b} \\rfloor ]$ \u540c $q$ \u4e92\u8d28\u4e2a\u6570.\n\n\u91c7\u7528 [HDU-4135](https://vjudge.net/problem/HDU-4135) \u540c\u6837\u7684\u65b9\u6cd5, \u5bf9 $q$ \u5206\u89e3\u8d28\u56e0\u6570\u540e\u5bb9\u65a5\u8ba1\u7b97\u5373\u53ef.\n\n\u8be6\u60c5\u53ef\u641c\u7d22: \u533a\u95f4\u4e92\u8d28\u4e2a\u6570, \u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\n\n```cpp\n// D\n// DeP\n#include <iostream>\nusing namespace std;\n\ntypedef long long LL;\nconst int MAXN = 1e5+5;\n\nLL gcd(LL a, LL b) { return !b? a: gcd(b, a % b); }\n\nLL fact[MAXN], tot;\n\nvoid prime(LL n) {\n    tot = 0;\n    for (LL i = 2; i*i <= n; ++i) if (n % i == 0) {\n        fact[++tot] = i;\n        while (n % i == 0) n /= i;\n    }\n    if (n > 1) fact[++tot] = n;\n}\n\nLL calc(LL m) {\n    static LL stk[MAXN], top, ret;\n    stk[top = 1] = -1, ret = 0;\n    for (int i = 1; i <= tot; ++i) {\n        int z = top;\n        for (int j = 1; j <= z; ++j) stk[++top] = -1LL * stk[j] * fact[i];\n    }\n    for (int i = 2; i <= top; ++i) ret += m / stk[i];\n    return ret;\n}\n\nint main() {\n    int Ti;\n    cin >> Ti;\n    while (Ti--) {\n        LL a, m, b;\n        cin >> a >> m;\n        b = gcd(a, m);\n        LL q = m / b, p = a / b;\n        LL L = p, R = p + (m-1) / b;\n        prime(q);\n        cout << R - calc(R) - (L-1) + calc(L-1) << endl;\n    }\n    return 0;\n}\n```",
        "postTime": 1580446775,
        "uid": 109751,
        "name": "DepletedPrism",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1295D \u3010Same GCDs\u3011"
    },
    {
        "content": "\u9898\u76ee\u662f\u8ba9\u6211\u4eec\u6c42\u8fd9\u4e2a\u5f0f\u5b50:\n\n$$ \\sum_{x = 0}^{m - 1} [\\gcd(a, m) = \\gcd(a + x, m)] $$\n\n\u7136\u540e\uff0c\u6839\u636e\u8f97\u8f6c\u76f8\u9664\u6cd5\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u8f6c\u5316\u4e3a\uff1a\n\n$$ \\sum_{x = 0}^{m - 1} [\\gcd(a, m) = \\gcd((a + x) \\bmod m, m)] $$\n\n\u53f3\u8fb9\u5c31\u662f\u628a $[0, m)$ \u7684\u533a\u95f4\u5411\u53f3\u5e73\u79fb\u4e86 $a$ \u4e2a\u5355\u4f4d\uff0c\u53d6\u6a21\u4e86\u4ee5\u540e\u663e\u7136\u8fd8\u662f $[0, m)$ \u7684\u533a\u95f4\u3002\n\n\u4e8e\u662f\uff1a\n\n$$\\sum_{i = 0}^{m -1} [\\gcd(i, m) = \\gcd(a, m)]$$\n\n\u4ee4 $g = \\gcd(a, m)$\uff0c\u5c31\u662f\u6c42\uff1a\n\n$$\\sum_{i = 0}^{m-1} [\\gcd(i, m) = g]$$\n$$ \\sum_{0 \\le i <m}^{g|i}\\left[ \\gcd\\left(\\dfrac i g , \\dfrac m g \\right) = 1 \\right]$$\n\n\u7136\u540e\uff0c\u5de6\u8fb9\u7684\u5c31\u662f $\\left[1 , \\dfrac m g \\right)$ \u7684\u4e00\u6bb5\u6570\uff0c\u6240\u4ee5\uff0c\u8fd9\u4e2a\u5c31\u662f\uff1a\n\n$$ \\sum_{i = 1}^{\\frac m g - 1} \\left[\\gcd \\left(i, \\dfrac m g \\right) = 1\\right] $$\n\n\u7136\u540e\u8fd9\u4e2a\u5c31\u662f $\\varphi\\left(\\dfrac m g \\right) = \\varphi\\left(\\dfrac m {\\gcd(a, m)} \\right)$ \u4e86\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\nLL gcd(LL a, LL b) { if(!b) return a; return gcd(b, a % b); }\nLL phi(LL x)\n{\n\tLL res = 1;\n\tfor(LL i = 2; i * i <= x; i++)\n\t{\n\t\tif(x % i) continue;\n\t\tres *= i - 1; x /= i;\n\t\twhile(x % i == 0) res *= i, x /= i;\n\t}\n\tif(x > 1) res *= x - 1;\n\treturn res;\n}\nint main()\n{\n\tios::sync_with_stdio(false);\n\tLL T;\n\tcin >> T;\n\twhile(T--)\n\t{\n\t\tLL a, m;\n\t\tcin >> a >> m;\n\t\tcout << phi(m / gcd(a, m)) << endl;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1580433985,
        "uid": 51971,
        "name": "syksykCCC",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1295D \u3010Same GCDs\u3011"
    }
]
[
    {
        "content": "### P.S.\n\u6765\u4e2a\u6bd4\u8f83\u6b63\u5e38\u7684\u9898\u89e3\n\n### Description.\n\u7565\n\n### Solution.\n\u8d21\u732e\u62c6\u5f00\uff0c\u8ba1\u7b97\u6bcf\u6bb5 $\\forall i\\in[1,n],[i-1,i]$ \u7684\u8d21\u732e\u3002  \n\u8111\u8865\u4e00\u4e0b\u6bcf\u4e00\u65f6\u523b $[i-1,i]$ \u4e2d\u56fe\u5f62\u6784\u6210\u4e86\u4ec0\u4e48\u5f62\u72b6\u3002  \n\u80af\u5b9a\u662f\u4e00\u4e2a\u4e0b\u51f8\u58f3\u4e0b\u9762\u7684\u9762\u79ef\u3002  \n\u6240\u4ee5\u6211\u4eec\u6bcf\u6b21\u6c42\u4e00\u4e2a\u4e0b\u51f8\u58f3\uff0c\u7136\u540e\u5dee\u5206\u5c31\u662f\u591a\u51fa\u6765\u7684\u9762\u79ef\u3002  \n\u6c42\u4e0b\u51f8\u58f3\u7684\u8bdd\u53ef\u4ee5\u53c2\u8003 [\u8fd9\u9898](https://www.luogu.com.cn/problem/P3194)\uff0c\u5c31\u76f4\u63a5\u7b97\u4e24\u4e24\u4ea4\u70b9\u5373\u53ef\u3002  \n\u6ce8\u610f\u8fd9\u9898\u662f\u6c42\u533a\u95f4\u7684\u4e0b\u51f8\u58f3\uff0c\u6240\u4ee5\u9700\u8981\u52a0\u4e00\u70b9\u7279\u5224\u3002  \n\n\u5982\u679c\u7528 `set` \u7b49\u52a8\u6001\u7ef4\u62a4\u51f8\u5305\uff0c\u590d\u6742\u5ea6\u5e94\u8be5\u80fd\u505a\u5230 $O(nk\\log n)$\u3002  \n$k$ \u662f\u679a\u4e3e $[i-1,i]$ \u7684 $i$\uff0c$n$ \u662f\u4ece\u4e0a\u5f80\u4e0b\u6bcf\u6b21\u63d2\u5165\u4e00\u6761\u7ebf\u3002  \n\n\u4f46\u662f\u7b14\u8005\u5f88\u61d2\uff0c\u5c31\u5199\u4e86\u4e2a $O(n^2k)$\uff0c\u5c31\u662f\u6bcf\u6b21\u66b4\u529b\u91cd\u65b0\u6c42\u4e00\u904d\u4e0b\u51f8\u58f3\u3002  \n\n### Coding.\n```cpp\n//\u662f\u554a\uff0c\u4f60\u5c31\u662f\u90a3\u53ea\u9b3c\u4e86\uff0c\u6240\u4ee5\u88ab\u4f60\u78b0\u5230\u4ee5\u540e\uff0c\u5c31\u8f6e\u5230\u6211\u53d8\u6210\u9b3c\u4e86{{{\n#include<bits/stdc++.h>\nusing namespace std;typedef long long ll;\ntemplate<typename T>inline void read(T &x)\n{\n\tx=0;char c=getchar(),f=0;\n\tfor(;c<48||c>57;c=getchar()) if(!(c^45)) f=1;\n\tfor(;c>=48&&c<=57;c=getchar()) x=(x<<1)+(x<<3)+(c^48);\n\tf?x=-x:x;\n}\ntemplate<typename T,typename...L>inline void read(T &x,L&...l) {read(x),read(l...);}//}}}\ntypedef long double ld;const ld eps=1e-9;\nconst int N=305;int n,K,a[N][N],lt;\nstruct ${int a,b;}l[N];ld rs[N],cf[N],pos[N];\ninline ld slop($ a,$ b) {return (b.a-a.a)*1.0/(b.a-b.b-a.a+a.b);}\ninline char chk($ a,$ b,$ c)\n{\n\tif(c.a>=b.a&&c.b>=b.b) return 1;\n\tld s1=slop(a,b),s2=slop(b,c);if(s2>1+eps) return 0;\n\tif(s2<-eps||s1>=s2-eps) return 1;else return 0;\n}\nint main()\n{\n\tread(K,n);for(int i=1;i<=K;i++) for(int j=0;j<=n;j++) read(a[i][j]);\n\tfor(int q=1;q<=n;q++)\n\t{\n\t\tfor(int p=1;p<=K;p++)\n\t\t{\n\t\t\tlt=p;for(int i=1;i<=p;i++) l[i]=($){a[i][q-1],a[i][q]};\n\t\t\tsort(l+1,l+lt+1,[]($ a,$ b){return a.b-a.a==b.b-b.a?a.a<b.a:a.b-a.a<b.b-b.a;});\n\t\t\tint tl=1;for(int i=2;i<=lt;i++) if(l[i].a-l[i].b==l[i-1].a-l[i-1].b) l[tl]=l[i];else l[++tl]=l[i];\n\t\t\tlt=tl,tl=0;for(int i=1;i<=lt;i++)\n\t\t\t{\n\t\t\t\twhile(tl>1&&chk(l[tl-1],l[tl],l[i])) tl--;\n\t\t\t\twhile(tl>0&&l[i].a>=l[tl].a&&l[i].b>=l[tl].b) tl--;\n\t\t\t\tif(!tl||l[i].b>l[tl].b) l[++tl]=l[i];\n\t\t\t}pos[0]=0,pos[tl]=1;ld &rs=cf[p];rs=0;\n\t\t\tfor(int i=1;i<tl;i++) pos[i]=(l[i].a-l[i+1].a)*1.0/(l[i+1].b-l[i].b+l[i].a-l[i+1].a);\n\t\t\tfor(int i=1;i<=tl;i++)\n\t\t\t{\n\t\t\t\tld k1=pos[i-1],k2=pos[i];\n\t\t\t\trs+=(k2-k1)*((2-k1-k2)*l[i].a+(k1+k2)*l[i].b)/2;\n\t\t\t}\n\t\t}\n\t\tfor(int p=1;p<=K;p++) rs[p]+=cf[p]-cf[p-1];\n\t}\n\tfor(int i=1;i<=K;i++) printf(\"%.10Lf\\n\",rs[i]);\n\treturn 0;\n}\n```",
        "postTime": 1634105972,
        "uid": 44805,
        "name": "Leap_Frog",
        "ccfLevel": 7,
        "title": "CF379E New Year Tree Decorations \u9898\u89e3"
    },
    {
        "content": "\n## Description\n\n\u7ed9\u5b9a\u4e8c\u7ef4\u5e73\u9762\u5750\u6807\u7cfb\u4e0a\u7684 $n$ \u4e2a\u4e92\u76f8\u8986\u76d6\u7684\u591a\u8fb9\u5f62\uff0c\u6c42\u6bcf\u4e2a\u591a\u8fb9\u5f62\u9732\u51fa\u7684\u9762\u79ef\u3002\n\n\n\n\n\n## Solution\n\n\u4e00\u9053\u601d\u8def\u975e\u5e38\u795e\u5947\u7684\u51e0\u4f55\u9898\u76ee\u3002\n\n\u6b64\u9898\u7684\u8ba1\u7b97\u51e0\u4f55\u505a\u6cd5\u8fc7\u4e8e\u96be\u5199\u3002\u89c2\u5bdf\u5230\u9898\u76ee\u4e2d\u5bf9\u7cbe\u5ea6\u8981\u6c42\u975e\u5e38\u5c0f\uff0c\u53ef\u4ee5\u8003\u8651\u7c7b\u4f3c\u6c42\u79ef\u5206\u7684\u65b9\u5f0f\u89e3\u51b3\u95ee\u9898\u3002\n\n\u7c7b\u4f3c\u6c42\u79ef\u5206\u7684\u65b9\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6240\u6709\u7684\u591a\u8fb9\u5f62\u62c6\u5206\u6210\u5bbd\u5ea6\u5f88\u5c0f\u7684\u6bb5\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u6bb5\u591a\u8fb9\u5f62\u53ef\u4ee5\u7528\u77e9\u5f62\u8fd1\u4f3c\u6c42\u51fa\u9762\u79ef\u3002\u6bcf\u6b21\u8bb0\u5f55\u4e0b\u5148\u524d\u8986\u76d6\u5728\u76f8\u540c\u4f4d\u7f6e\u7684\u6700\u957f\u7684\u77e9\u5f62\uff0c\u7531\u4e8e\u6bcf\u6bb5\u957f\u5ea6\u56fa\u5b9a\uff0c\u6c42\u51fa\u73b0\u6709\u77e9\u5f62\u957f\u5ea6\u4e0e\u5148\u524d\u7684\u5dee\u503c\u548c\u5373\u4e3a\u591a\u8fb9\u5f62\u9732\u51fa\u7684\u9762\u79ef\u3002\n\n\u8fd9\u79cd\u505a\u6cd5\u5bf9\u7cbe\u5ea6\u6709\u4e00\u5b9a\u8981\u6c42\uff0c\u56e0\u6b64\u9700\u8981\u4f7f\u7528`long double` \uff0c\u5e76\u4e14\u5c06\u6a2a\u5750\u6807\u6620\u5c04\u8fdb\u66f4\u5927\u7684\u8303\u56f4\u5185\u6765\u5361\u7cbe\u5ea6\u3002\u8f93\u51fa\u7b54\u6848\u65f6\u5efa\u8bae\u4f7f\u7528 `cout` \uff0c\u6b64\u65f6\u4f7f\u7528 `printf` \u7cbe\u5ea6\u53ef\u80fd\u4f1a\u51fa\u9505\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\ninline int read()\n{\n    int x=0,f=1,c=getchar();\n    while(c<48) c=='-'&&(f=-1),c=getchar();\n    while(c>47) x=x*10+c-'0',c=getchar();\n    return x*f;\n}\n\ntypedef long double ld;\nconst int MAXN = 1000005;\nld val[MAXN],ans,slp,cur;\nint n,k,lim;\n\nint main(int argc, char const *argv[])\n{\n    n=read(); k=read(); lim=1e6/k;\n    int x,y;\n    for(int t=1; t<=n; ++t)\n    {\n        x=read(); ans=0;\n        for(int i=0; i<k; ++i)\n        {\n            y=read(); slp=(ld)(y-x)/lim;\n            for(int j=0; j<=lim; ++j)\n            {\n                cur=(ld)x+slp*j;\n                if(cur>val[i*lim+j])\n                    ans+=cur-val[i*lim+j],val[i*lim+j]=cur;\n            }\n            x=y;\n        }\n        cout<<ans/lim<<endl;\n    }\n    return 0;\n}\n```\n\n",
        "postTime": 1593351606,
        "uid": 107735,
        "name": "shiroi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF379E \u3010New Year Tree Decorations\u3011"
    }
]
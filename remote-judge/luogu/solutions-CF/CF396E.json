[
    {
        "content": "\u6211\u4eec\u8003\u8651\u6b27\u62c9\u51fd\u6570\u548c\u8d28\u56e0\u6570\u5206\u89e3\u7684\u5173\u7cfb\uff0c\u6709\uff1a$\\varphi(n)=n\\prod\\limits_{i=1}^m\\dfrac{p_i-1}{p_i}$\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u5c06 $n$ \u53d8\u6210 $\\varphi(n)$ \u4e4b\u540e\uff0c\u9700\u8981\u5c06 $n$ \u542b\u6709\u7684\u6240\u6709\u8d28\u56e0\u5b50\u7684\u6307\u6570\u51cf $1$\uff0c\u540c\u65f6\u4e58\u4e0a $\\prod\\limits_{i=1}^m(p_i-1)$\uff1b\u5047\u8bbe\u6240\u6709\u7684 $a_i$ \u5747\u5927\u4e8e\u7b49\u4e8e $k$\uff0c\u5c31\u76f8\u5f53\u4e8e\u662f\u5bf9\u6240\u6709\u6307\u6570\u51cf\u53bb\u4e86 $k$\uff0c\u518d\u4e58\u4e0a $\\prod\\limits_{i=1}^m(p_i-1)^k$\u3002\n\n\u8fd9\u662f\uff0c\u6211\u4eec\u5c31\u6709\u4e86\u4e00\u4e2a\u8f83\u4e3a\u76f4\u89c2\u7684\u505a\u6cd5\uff1a\u4ece\u5927\u5230\u5c0f\u904d\u5386 $10^6$ \u4ee5\u5185\u6240\u6709\u8d28\u6570\uff0c\u5982\u679c\u6709\uff0c\u8bbe\u5176\u6307\u6570\u4e3a $a_i$\uff0c\u5219\u6307\u6570\u5e94\u8be5\u4f1a\u51cf\u5c11 $\\min(a_i,k)$\uff0c\u540c\u65f6 $n$ \u4f1a\u4e58\u4e0a $(p_i-1)^{\\min(a_i,k)}$\uff0c\u9884\u5904\u7406\u51fa $p_i-1$ \u7684\u8d28\u56e0\u6570\u5206\u89e3\u5f62\u5f0f\u5373\u53ef\u3002\n\n\u4f46\u5982\u679c\u4f60\u5b9e\u73b0\u4e86\u8fd9\u4e2a\u505a\u6cd5\uff0c\u4f60\u4f1a\u53d1\u73b0\u4e00\u4e2a\u5f88\u4e25\u91cd\u7684\u95ee\u9898\uff0c\u4f60\u6d4b\u8bd5\u7b2c\u4e00\u6837\u4f8b\u7684\u65f6\u5019\uff0c\u5f88\u6709\u53ef\u80fd\u4f1a\u5f97\u5230\u8fd9\u6837\u7684\u7b54\u6848\uff1a\n```\n1\n2 1\n```\n\u6211\u4eec\u5927\u6982\u6a21\u62df\u4e00\u4e0b\u4ee3\u7801\u8fc7\u7a0b\uff1a$7\\rightarrow 6=2\\times 3$\uff0c$3\\rightarrow 2=2$\uff0c$2\\rightarrow 1$\uff0c\u6211\u4eec\u76f8\u6bd4\u4e8e\u5b9e\u9645\u60c5\u51b5\u591a\u6d88\u8017\u4e86\u4e00\u4e2a $2$ \u548c $3$\u3002\n\n\u7a76\u5176\u539f\u56e0\uff0c\u5728\u53ea\u505a\u4e86\u4e00\u5c42 $\\varphi(n)$ \u7684\u60c5\u51b5\u4e0b\uff0c\u8d28\u6570 $2$ \u548c $3$ \u5176\u5b9e\u662f\u5728\u5b8c\u6210\u4e86\u8fd9\u6b21 $\\varphi(n)$ \u4e4b\u540e\u51fa\u73b0\u7684\uff0c\u4e0d\u5e94\u8be5\u5728\u8fd9\u4e00\u6b21\u7684\u8fc7\u7a0b\u4e2d\u8fdb\u884c\u5904\u7406\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8003\u8651\u5728\u7ef4\u62a4\u6307\u6570\u7684\u540c\u65f6\u7ef4\u62a4\u4e00\u4e0b\u5b83\u51fa\u73b0\u7684\u65f6\u95f4\u523b\u3002\u6ce8\u610f\u5bf9\u4e8e\u67d0\u4e00\u6279\u6b21\u4e00\u6b21\u4e58\u4e0a\u7684 $p_i^{a_i}$ \u53ef\u4ee5\u7b97\u4f5c\u540c\u4e00\u65f6\u523b\uff0c\u56e0\u4e3a\u5bf9\u5b83\u8fdb\u884c\u7684\u64cd\u4f5c\u548c\u5bf9\u8fde\u7eed $a_i$ \u4e2a\u65f6\u523b\u90fd\u6709\u503c\u662f\u7b49\u4ef7\u7684\u3002\n\n\u56e0\u4e3a\u5728 $p_i\\geqslant 5$ \u7684\u60c5\u51b5\u4e0b\uff0c$p_i-1$ \u4e3a\u5076\u6570\uff0c\u6240\u4ee5\u5176\u8d28\u56e0\u5b50\u5747\u5c0f\u4e8e $\\dfrac{p_i}{2}$ \u7684\uff0c\u4e5f\u5c31\u610f\u5473\u7740\u6bcf\u4e00\u6b21\u64cd\u4f5c\u8d28\u6570\u5927\u5c0f\u4f1a\u51cf\u534a\uff0c\u6240\u4ee5\u6709\u610f\u4e49\u7684\u65f6\u95f4\u523b\u53ea\u4f1a\u6709 $O(\\log p_i)$ \u4e2a\u3002\n\n$p_i-1$ \u7684\u8d28\u6570\u4e2a\u6570\u4e5f\u662f $\\leqslant O(\\log p_i)$ \u7684\uff0c\u6240\u4ee5\u6574\u4f53\u590d\u6742\u5ea6\u4e3a $O(P\\log^2P)$ \u7684\uff08$P$ \u4e3a\u6700\u5927\u7684\u8d28\u6570\uff0c\u4e5f\u5c31\u662f $10^6$ \u91cf\u7ea7\u7684\u4e00\u4e2a\u6570\uff09\uff0c\u4f46\u5b9e\u9645\u4e0a\u5f88\u96be\u5361\u6ee1\u3002\n\n\u6211\u4eec\u8003\u8651 $n$ \u6700\u5927\u662f $10^{6\\times10^{23}}$ \u91cf\u7ea7\u7684\uff0c\u6240\u4ee5\u6709\u53ef\u80fd\u7206 `long long`\uff0c\u6240\u4ee5\u4ee3\u7801\u4e2d\u5b9e\u73b0\u4e86\u4e00\u4e2a\u5c0f\u7684\u9ad8\u7cbe\u5ea6\uff08\u4f46\u5b9e\u9645\u4e0a\u4e5f\u662f\u5361\u4e0d\u5230\u7684\uff09\u3002\n\nCode:\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nlong long Qread()\n{\n\tlong long x=0;char ch=getchar();\n\twhile(ch<'0'||ch>'9') ch=getchar();\n\twhile(ch>='0'&&ch<='9') x=x*10+(ch^48),ch=getchar();\n\treturn x;\n}\nconst long long Mod=1e12;\nstruct JG{\n\tlong long a,b,c,d;\n\tJG(){a=b=c=d=0;}\n\tJG(long long num){a=b=0,c=num/Mod,d=num%Mod;}\n\tbool hv(){return a||b||c||d;}\n\tvoid show()\n\t{\n\t\t\n\t\tif(a) printf(\"%lld%012lld%012lld%012lld\",a,b,c,d);\n\t\telse if(b) printf(\"%lld%012lld%012lld\",b,c,d);\n\t\telse if(c) printf(\"%lld%012lld\",c,d);\n\t\telse printf(\"%lld\",d);\n\t}\n};\nJG operator+(JG A,JG B)\n{\n\tJG ret;\n\tret.d=A.d+B.d;\n\tret.c=A.c+B.c+ret.d/Mod;ret.d%=Mod;\n\tret.b=A.b+B.b+ret.c/Mod;ret.c%=Mod;\n\tret.a=A.a+B.a+ret.b/Mod;ret.b%=Mod;\n\treturn ret;\n}\nJG operator-(JG A,JG B)\n{\n\tJG ret;\n\tret.d=A.d-B.d;\n\tret.c=A.c-B.c;if(ret.d<0) ret.d+=Mod,ret.c--;\n\tret.b=A.b-B.b;if(ret.c<0) ret.c+=Mod,ret.b--;\n\tret.a=A.a-B.a;if(ret.b<0) ret.b+=Mod,ret.a--;\n\treturn ret;\n}\nJG operator*(JG A,int B)\n{\n\tJG ret;\n\tret.d=A.d*B;\n\tret.c=A.c*B+ret.d/Mod;ret.d%=Mod;\n\tret.b=A.b*B+ret.c/Mod;ret.c%=Mod;\n\tret.a=A.a*B+ret.b/Mod;ret.b%=Mod;\n\treturn ret;\n}\nbool operator<(JG A,JG B)\n{\n\tif(A.a!=B.a) return A.a<B.a;\n\tif(A.b!=B.b) return A.b<B.b;\n\tif(A.c!=B.c) return A.c<B.c;\n\treturn A.d<B.d;\n}\nint m,p,cnt;\nlong long a,k;\nint prim[80010],top,f1;\nbool vis[1000010];\ntypedef pair<int,int> pr;\nvector<pr> fj[80010];\nJG hav[80010][21],ned,emp,ph,tot;\nint main()\n{\n\tfor(int i=2;i<=1000000;i++)\n\t{\n\t\tif(!vis[i]) prim[++top]=i;\n\t\tfor(int j=1;j<=top&&1ll*i*prim[j]<=1000000;j++)\n\t\t{\n\t\t\tvis[i*prim[j]]=true;\n\t\t\tif(i%prim[j]==0) break;\n\t\t}\n\t}\n\tfor(int i=1;i<=top;i++)\n\t{\n\t\tint rem=prim[i]-1;\n\t\tfor(int j=1;1ll*prim[j]*prim[j]<=rem;j++)\n\t\t{\n\t\t\tif(rem%prim[j]==0)\n\t\t\t{\n\t\t\t\tint cnt=0;\n\t\t\t\twhile(rem%prim[j]==0) rem/=prim[j],cnt++;\n\t\t\t\tfj[i].push_back(make_pair(j,cnt));\n\t\t\t}\n\t\t}\n\t\tif(rem!=1) fj[i].push_back(make_pair((int)(lower_bound(prim+1,prim+top+1,rem)-prim),1));\n\t}\n\tm=Qread();\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tp=Qread(),a=Qread();\n\t\twhile(prim[f1]!=p) f1++;\n\t\thav[f1][0]=JG(a);\n\t}\n\tk=Qread();\n\tfor(int i=top;i;i--)\n\t{\n\t\ttot=emp;\n\t\tned=JG(k);\n\t\tfor(int j=0;j<=20&&ned.hv();j++)\n\t\t{\n\t\t\tif(hav[i][j].hv())\n\t\t\t{\n\t\t\t\tif(ned<hav[i][j])\n\t\t\t\t{\n\t\t\t\t\tph=ned;\n\t\t\t\t\thav[i][j]=hav[i][j]-ned;\n\t\t\t\t\tned=emp;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tph=hav[i][j];\n\t\t\t\t\tned=ned-hav[i][j];\n\t\t\t\t\thav[i][j]=emp;\n\t\t\t\t}\n\t\t\t\ttot=tot+ph;\n\t\t\t\tfor(pr g:fj[i])\n\t\t\t\t\thav[g.first][j+1]=hav[g.first][j+1]+ph*g.second;\n\t\t\t}\n\t\t\tif(ned.hv()&&tot<JG(j+1)) ned=ned-JG(1),tot=tot+JG(1);\n\t\t}\n\t}\n\tfor(int i=1;i<=top;i++) for(int j=1;j<=20;j++) hav[i][0]=hav[i][0]+hav[i][j];\n\tfor(int i=1;i<=top;i++) if(hav[i][0].hv()) cnt++;\n\tprintf(\"%d\\n\",cnt);\n\tfor(int i=1;i<=top;i++)\n\t\tif(hav[i][0].hv())\n\t\t{\n\t\t\tprintf(\"%d \",prim[i]);\n\t\t\thav[i][0].show();\n\t\t\tprintf(\"\\n\");\n\t\t}\n\treturn 0;\n}\n```",
        "postTime": 1677487503,
        "uid": 263594,
        "name": "\u5bfb\u900d\u90652006",
        "ccfLevel": 8,
        "title": "CF396E \u9898\u89e3"
    }
]
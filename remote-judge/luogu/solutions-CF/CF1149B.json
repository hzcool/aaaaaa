[
    {
        "content": "\u7ed9\u51fa\u4e00\u4e2a\u66f4\u4e3a\u7b80\u6d01\u7684\u4ee3\u7801\n\n---\n\n\u4e00\u9053\u65b0\u9896\u7684dp\u597d\u9898\n\n---\n\n### \u9898\u89e3\uff1a\n\n\n\u8bbef[i][j][k]\u8868\u793aA\u4e32\u5339\u914d\u5230\u7b2ci\u4e2a\u5b57\u7b26\uff0cB\u4e32\u5339\u914d\u5230\u7b2cj\u4e2a\u5b57\u7b26\uff0cC\u4e32\u5339\u914d\u5230\u7b2ck\u4e2a\u5b57\u7b26\u65f6\uff0c\u5728\u6a21\u5f0f\u4e32\u4e2d\u7684\u6700\u77ed\u8ddd\u79bb\uff0c\u5373\u6700\u5de6\u70b9\uff08\u4e32\u7684\u4e0b\u6807\u90fd\u4ece1\u5f00\u59cb\uff09\n\n\u9884\u5904\u7406\u51fanxt[i][c]\uff0c\u8868\u793a\u6a21\u5f0f\u4e32\u4e2d\uff0c[i,n]\u533a\u95f4\u5185\uff0cc\u5b57\u7b26\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\n\n\u4e0b\u9762\u662f\u4e00\u5f20cf\u5b98\u65b9\u7684\u89e3\u91canxt\u6570\u7ec4\u7684\u56fe\uff0c\u5b83\u7684\u4e0b\u6807\u4ece0\u5f00\u59cb\uff0c\u4e5f\u8bb8\u53ef\u4ee5\u65b9\u4fbf\u7406\u89e3\n\n![](https://s2.ax1x.com/2019/11/29/QkcqyV.png)\n\n\u521d\u59cb\u5316$f[i][j][k]=n+1,f[0][0][0]=0$\uff0c\u610f\u601d\u662f\u5047\u8bbe\u600e\u6837\u90fd\u5339\u914d\u5931\u8d25\uff0c\u90fd\u4e0d\u53bb\u5339\u914d\u624d\u80fd\u6210\u529f\n\n\u8f6c\u79fb\u65b9\u7a0b\u5982\u4e0b\uff1a\n\n$\\small{f[i][j][k]=\\min\\left \\{nxt[f[i-1][j][k]+1][s[1][i]],nxt[f[i][j-1][k]+1][s[2][j]],nxt[f[i][j][k-1]+1][s[3][k]] \\right \\}}$\n\n\u610f\u601d\u662f\uff0c\u5c1d\u8bd5\u4eceA\u4e32\u4e2d\u52a0\u4e2a\u5b57\u7b26\u627e\u540e\u7eed\u4f4d\u7f6e\uff0c\u4eceB\u4e32\u4e2d\u52a0\u4e2a\u5b57\u7b26\u627e\u540e\u7eed\u4f4d\u7f6e,\u4eceC\u4e32\u4e2d\u52a0\u4e2a\u5b57\u7b26\u627e\u540e\u7eed\u4f4d\u7f6e\uff0c\u4ece\u8fd9\u4e09\u4e2a\u4f4d\u7f6e\u4e2d\u7684\u6700\u5de6\u8fb9\u7684\u4e00\u4e2a\u90a3\u8f6c\u79fb\n\n\u5bf9\u4e8e\u63d2\u5165\u64cd\u4f5c\uff0c\u6ce8\u610f\u5230\u65b0\u589e\u52a0\u7684\u72b6\u6001\u53ea\u6709 \u65b0\u5b57\u7b26\u4e0e\u53e6\u5916\u4e24\u4e2a\u4e32\u7684\u6bcf\u4e2a\u4f4d\u7f6e \u8fd9\u81f3\u591a250*250\u79cd\u72b6\u6001\uff0c\u5bf9\u4e8e\u8fd9\u4e9b\u65b0\u72b6\u6001\u91cd\u65b0\u8dd1\u4e00\u904ddp\u5373\u53ef\n\n\u5bf9\u4e8e\u5220\u9664\u64cd\u4f5c\uff0c\u76f4\u63a5\u51cf\u5c0f\u76f8\u5e94\u4e32\u957f\u5373\u53ef\n\n\u5bf9\u4e8e\u7b54\u6848ans=f[len[1]][len[2]][len[3]]\uff0c\u610f\u601d\u5c31\u662f\u4e09\u4e2a\u4e32\u5168\u90e8\u5339\u914d\u5b8c\u540e\uff0c\u5728\u6a21\u5f0f\u4e32\u4e2d\u7684\u6700\u5de6\u70b9\n\t\n\u5f53ans<=n\u65f6\uff0c\u8bf4\u660e\u662f\u53ef\u4ee5\u5728\u6a21\u5f0f\u4e32\u4e2d\u88ab\u5339\u914d\u5b8c\u7684\uff0c\u8f93\u51faYES\n\n\u5426\u5219ans=n+1\u5c31\u8f93\u51faNO\n\t\n\n\u7279\u522b\u6ce8\u610f\u5904\u7406nxt\u6570\u7ec4\u65f6\uff0cnxt[n+1][]\u548cnxt[n+2][]\u90fd\u8981\u8d4b\u4e3an+1\n\n---\n\n### \u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntemplate<class t> inline t read(t &x){\n\tx=0;char c=getchar();bool f=0;\n\twhile(!isdigit(c)) f|=c=='-',c=getchar();\n\twhile(isdigit(c)) x=(x<<1)+(x<<3)+(c^48),c=getchar();\n\tif(f) x=-x;return  x;\n}\ntemplate<class t> inline void write(t x){\n\tif(x<0){putchar('-'),write(-x);}\n\telse{if(x>9)write(x/10);putchar('0'+x%10);}\n}\n\nconst int N=1e5+5,M=255;\nchar p[N];\nint s[4][M],nxt[N][28],f[M][M][M],n,q,len[4];\n/*\u9884\u5904\u7406\u51fanxt[][]\u6570\u7ec4*/\nvoid init(){\n\tfor(int i=0;i<26;i++) nxt[n+1][i]=nxt[n+2][i]=n+1; //\u6ce8\u610f\u8fd9\u8fb9\u7684[n+2]\n\tfor(int i=n;i;i--)\n\t\tfor(int j=0;j<26;j++){\n\t\t\tif(p[i]==j+'a') nxt[i][j]=i;\n\t\t\telse nxt[i][j]=nxt[i+1][j];\n\t\t}\n}\n\nvoid doit(){\n\tchar ch;cin>>ch;\n\tint id;read(id);\n\tif(ch=='+'){\n\t\tcin>>ch;\n\t\ts[id][++len[id]]=ch-'a';\n\t\tfor(int i=(id==1?len[1]:0);i<=len[1];i++) //\u4e09\u76ee\u8868\u8fbe\u5f0f\u90e8\u5206\u610f\u601d\u662f\uff0c\u5982\u679c\u662f\u8fd9\u4e2a\u4e32\u88ab\u4fee\u6539\uff0c\u90a3\u5b83\u53ea\u8981\u8ba1\u7b97\u65b0\u7684\u4e00\u4f4d\uff0c\u5426\u5219\u5c31\u90fd\u8981\u4ece\u5934\u5f00\u59cb\n\t\t\tfor(int j=(id==2?len[2]:0);j<=len[2];j++)\n\t\t\t\tfor(int k=(id==3?len[3]:0);k<=len[3];k++){\n\t\t\t\t\tint &now=f[i][j][k];\n\t\t\t\t\tnow=n+1; //\u90fd\u5148\u5047\u8bbe\u4e0d\u53ef\u80fd\n\t\t\t\t\tif(i) now=min(now,nxt[f[i-1][j][k]+1][s[1][i]]); //A\u4e32\u8f6c\u79fb\n\t\t\t\t\tif(j) now=min(now,nxt[f[i][j-1][k]+1][s[2][j]]); //B\u4e32\u8f6c\u79fb\n\t\t\t\t\tif(k) now=min(now,nxt[f[i][j][k-1]+1][s[3][k]]); //C\u4e32\u8f6c\u79fb\n\t\t\t\t}\n\t}\n\telse{\n\t\tlen[id]--; //\u76f4\u63a5\u5220\u957f\u5ea6\n\t}\n\tif(f[len[1]][len[2]][len[3]]<=n) puts(\"YES\"); //\u6700\u5de6\u70b9\u5728n\u4ee5\u5185\u5c31\u53ef\u884c\n\telse puts(\"NO\");\n}\n\nsigned main(){\n\tread(n);read(q);\n\tscanf(\"%s\",p+1);\n\tinit();\n\twhile(q--) doit();\n}\n```",
        "postTime": 1575002592,
        "uid": 65735,
        "name": "yuzhechuan",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1149B \u3010Three Religions\u3011"
    },
    {
        "content": "##  \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ ($1 \\le n \\le 10^5$) \u7684\u5b57\u7b26\u4e32 $t$ \u548c $q$ ($1 \\le q \\le 10^3$) \u6b21\u64cd\u4f5c\u3002\u521d\u59cb\u65f6\u6709 $3$ \u4e2a\u7a7a\u7684\u5b57\u7b26\u4e32 $s_1, s_2, s_3$\uff0c\u6bcf\u6b21\u64cd\u4f5c\u4f1a\u5728 $s_1, s_2, s_3$ \u4e2d $1$ \u4e2a\u5b57\u7b26\u4e32\u7684\u672b\u5c3e\u6dfb\u52a0\u6216\u5220\u9664 $1$ \u4e2a\u5b57\u7b26\uff0c\u4fdd\u8bc1\u5b83\u4eec\u7684\u957f\u5ea6\u5c0f\u4e8e $250$\u3002\u5728\u6bcf\u6b21\u64cd\u4f5c\u540e\uff0c\u4f60\u9700\u8981\u56de\u7b54\u80fd\u5426\u628a\u5b57\u7b26\u4e32 $t$ \u5206\u6210\u82e5\u5e72\u4e2a\u5b50\u5e8f\u5217\uff0c\u4f7f\u5f97\u8fd9\u4e9b\u5b50\u5e8f\u5217\u4e2d\u6709 $3$ \u4e2a\u6070\u597d\u4e0e $s_1, s_2, s_3$ \u5206\u522b\u76f8\u7b49\u3002\u8bf7\u6ce8\u610f\uff0c $t$ \u4e2d\u7684\u6bcf $1$ \u4e2a\u5b57\u7b26\u53ea\u80fd\u51fa\u73b0\u5728 $1$ \u4e2a\u5b50\u5e8f\u5217\u4e2d\u3002\n\n## \u601d\u8def\n\n\u8bbe $dp_{i,j,k}$ \u8868\u793a\u5206\u51fa $s_1$ \u7684\u524d $i$ \u4e2a\u5b57\u7b26\u3001$s_2$ \u7684\u524d $j$ \u4e2a\u5b57\u7b26\u3001$s_3$ \u7684\u524d $k$ \u4e2a\u5b57\u7b26\u9700\u8981\u7684\u6700\u77ed\u7684 $t$ \u7684\u524d\u7f00\u7684\u957f\u5ea6\uff0c$nxt_{i,j}$ \u8868\u793a\u5b57\u7b26\u4e32 $t$ \u4e2d\u7b2c $i$ \u4e2a\u5b57\u7b26\u540e\u7b2c\u4e00\u4e2a\u5b57\u7b26 $j$ \u7684\u4f4d\u7f6e\uff0c$len1,len2,len3$ \u5206\u522b\u8868\u793a $s_1,s_2,s_3$ \u7684\u957f\u5ea6\u3002\u6211\u4eec\u53ef\u4ee5\u5148\u9884\u5904\u7406\u51fa $nxt$ \u6570\u7ec4\u7684\u503c\uff0c\u5982\u679c\u7b2c $i$ \u4e2a\u5b57\u7b26\u540e\u6ca1\u6709\u5b57\u7b26 $j$\uff0c\u5c31\u4ee4 $nxt_{i,j}=n+1$\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651 $dp$ \u8f6c\u79fb\uff0c$dp_{i,j,k}=min(nxt_{dp_{i-1,j,k},s1_i},min(nxt_{dp_{i,j-1,k},s2_j},nxt_{dp_{i,j,k-1},s3_k}))$\u3002\u5bf9\u4e8e\u52a0\u5165 $1$ \u4e2a\u5b57\u7b26\u7684\u64cd\u4f5c\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8f6c\u79fb\u65b9\u7a0b\u5728 $O(len^2)$ \u5185\u6c42\u51fa\u65b0\u589e\u7684 $len^2$ \u4e2a $dp$ \u72b6\u6001\u7684\u503c\u3002\u5bf9\u4e8e\u51cf\u53bb $1$ \u4e2a\u5b57\u7b26\u7684\u64cd\u4f5c\uff0c\u76f4\u63a5\u4ee4\u5220\u9664\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\u51cf $1$\u3002\u6700\u540e\u5728\u6bcf\u6b21\u64cd\u4f5c\u540e\u5224\u65ad $dp_{len1,len2,len3}$ \u7684\u503c\u662f\u5426\u4e0d\u5927\u4e8e $n$ \u5373\u53ef\u3002\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(26 \\times n + q \\times len^2)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ninline int read()\n{\n\tint read_result=0,is_below_0=0;\n\tchar now_ch=0;\n\twhile(!isdigit(now_ch))\n\t{\n\t\tis_below_0|=now_ch=='-';\n\t\tnow_ch=getchar();\n\t}\n\twhile(isdigit(now_ch))\n\t{\n\t\tread_result=(read_result<<3)+(read_result<<1)+(now_ch^48);\n\t\tnow_ch=getchar();\n\t}\n\treturn is_below_0?-read_result:read_result;\n}\ninline void write(int x)\n{\n\tif(x<0)\n\t{\n\t\tputchar('-');\n\t\tx=-x;\n\t}\n\tif(x>9) write(x/10);\n\tputchar(x%10+'0');\n}\nint n,q,nxt[100005][26],len[4],dp[255][255][255];\nstring s;\nchar str[4][255];\nint main()\n{\n\tn=read();\n\tq=read();\n\tcin>>s;\n\tfor(int i=0;i<26;++i) nxt[n][i]=n+1;\n\tfor(int i=n-1;i>=0;--i)\n\t{\n\t\tfor(int j=0;j<26;++j)\n\t\t{\n\t\t\tif(s[i]-'a'==j) nxt[i][j]=i+1;\n\t\t\telse nxt[i][j]=nxt[i+1][j];\n\t\t}\n\t}\n\twhile(q--)\n\t{\n\t\tchar op;\n\t\tcin>>op;\n\t\tint x=read();\n\t\tif(op=='+')\n\t\t{\n\t\t\tstr[x][len[x]++]=getchar();\n\t\t\tfor(int i=(x==1?len[1]:0);i<=len[1];++i)\n\t\t\t{\n\t\t\t\tfor(int j=(x==2?len[2]:0);j<=len[2];++j)\n\t\t\t\t{\n\t\t\t\t\tfor(int k=(x==3?len[3]:0);k<=len[3];++k)\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[i][j][k]=n+1;\n\t\t\t\t\t\tif(i&&dp[i-1][j][k]<n) dp[i][j][k]=min(dp[i][j][k],nxt[dp[i-1][j][k]][str[1][i-1]-'a']);\n\t\t\t\t\t\tif(j&&dp[i][j-1][k]<n) dp[i][j][k]=min(dp[i][j][k],nxt[dp[i][j-1][k]][str[2][j-1]-'a']);\n\t\t\t\t\t\tif(k&&dp[i][j][k-1]<n) dp[i][j][k]=min(dp[i][j][k],nxt[dp[i][j][k-1]][str[3][k-1]-'a']);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse --len[x];\n\t\tif(dp[len[1]][len[2]][len[3]]<=n) puts(\"YES\");\n\t\telse puts(\"NO\");\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1663837278,
        "uid": 488734,
        "name": "wrzSama",
        "ccfLevel": 7,
        "title": "CF1149B Three Religions \u9898\u89e3"
    },
    {
        "content": "\u6709\u4e09\u4e2a\u5b57\u7b26\u4e32$s_1,s_2,s_3$\u548c\u4e00\u4e2a\u4e3b\u4e32$s$\uff0c\u6bcf\u6b21\u64cd\u4f5c\u6539\u53d8\u4e00\u4e2a$s_i$\uff08\u63d2\u5165\u6216\u5220\u9664\u5b57\u7b26\uff09\uff0c\u6bcf\u6b21\u64cd\u4f5c\u5b8c\u4e4b\u540e\u95ee$s$\u662f\u5426\u53ef\u4ee5\u5206\u6210$3$\u4e2a\u5b50\u5e8f\u5217\u6b63\u597d\u662f$s_1,s_2,s_3$\u3002\u4efb\u610f\u65f6\u5019$|s_i|\\leq 250$\u3002\n\n\u8bbe$nxt[x][i]$\u8868\u793a\u4e3b\u4e32\u4e0a\u5b57\u7b26$i$\u5728$>x$\u4e0a\u7b2c\u4e00\u4e2a\u51fa\u73b0\u7684\u4f4d\u7f6e\u3002\n\n\u8bbe$f[x][y][z]$\u8868\u793a\u4e09\u4e2a\u4e32\u5206\u522b\u5339\u914d\u5230$x,y,z$\u9700\u8981\u4e3b\u4e32\u7684\u6700\u77ed\u957f\u5ea6\u3002\n\n\u90a3\u4e48\u8fd9\u4e2a\u53ef\u4ee5$O(1)$\u8f6c\u79fb\uff0c\u53ea\u8981\u679a\u4e3e\u62fc\u8d77\u6765\u7684\u6700\u540e\u4e00\u4e2a\u5b57\u7b26\u5c31\u884c\u4e86\u3002\n\n\u63d2\u5165\u6700\u591a\u6539\u53d8$251^2$\u4e2a$f$\u503c\uff0c\u6bcf\u6b21\u63d2\u5165dp\u4e00\u904d\u591a\u51fa\u6765\u7684$f$\u5c31\u884c\u4e86\u3002\n\nhttps://www.cnblogs.com/xzz_233/p/10798276.html",
        "postTime": 1556674745,
        "uid": 23118,
        "name": "\u03bb\u1d09\u028d",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1149B \u3010Three Religions\u3011"
    },
    {
        "content": "\u8003\u8651dp\u3002\n\n\u8bbe$f[i][j][k]$\u8868\u793a\u7b2c\u4e00\u4e2a\u4e32\u5339\u914d\u5230$i$\uff0c\u7b2c\u4e8c\u4e2a\u4e32\u5339\u914d\u5230$j$\uff0c\u7b2c\u4e09\u4e2a\u4e32\u5339\u914d\u5230$k$\u7684\u5728\u539f\u4e32\u4e0a\u7684\u6700\u5de6\u7aef\u70b9\u3002\n\n\u4e3a\u4e86\u8f6c\u79fb\u6211\u4eec\u6c42\u4e00\u4e2a\u6570\u7ec4$nxt$\uff0c$nxt[i][j]$\u8868\u793a\u5728\u539f\u4e32\u4e0a\u7684$i$\u4f4d\u7f6e\u7684\u4e0b\u4e00\u4e2a$j$\u5b57\u7b26\u7684\u6700\u5de6\u4f4d\u7f6e\u3002\n\n\u8f6c\u79fb\u8003\u8651\u6700\u540e\u4e00\u4e2a\u586b\u54ea\u4e2a\uff0c\u663e\u7136\u6709\u8f6c\u79fb\uff1a\n$f[i][j][k] = min(nxt[f[i-1][j][k]][s1[i]], nxt[f[i][j - 1][k]][ s2[j]], nxt[f[i][j][k - 1]][s3[k]])$\n\n\u8fd9\u6837\u6709\u4e00\u4e2a$O(q*250^3)$\u7684\u505a\u6cd5\u3002\n\n\u8003\u8651\u6bcf\u6b21\u65b0\u52a0\u4e00\u4e2a\u5b57\u7b26\uff0c\u53d1\u73b0\u5b9e\u9645\u4e0a\u6539\u53d8\u7684\u72b6\u6001\u4e2a\u6570\u53ea\u6709$O(250^2)$\u7ea7\u522b\u7684\uff0c\u6211\u4eec\u5bf9\u8fd9\u90e8\u5206\u72b6\u6001\u76f4\u63a5\u66b4\u529b\u4fee\u6539\uff0c\u5220\u9664\u4e00\u4e2a\u5b57\u7b26\u5c31\u76f4\u63a5\u56de\u9000\u72b6\u6001\uff0c\u628a\u65e0\u7528\u72b6\u6001\u6e05\u96f6\uff0c\u8fd9\u6837\u590d\u6742\u5ea6\u53d8\u4e3a$O(q*250^2)$\uff0c\u53ef\u8fc7\u3002\n\n```cpp\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n#include <bitset>\n#include <set>\n#include <map>\n#include <queue>\n#include <iostream>\n#include <cmath>\n#include <vector>\n\nusing namespace std;\n\ntypedef long long LL;\ntypedef unsigned long long ULL;\ntypedef unsigned int uint;\ntypedef double db;\ntypedef pair <int, int> pii;\ntypedef vector <int> vi;\n\n#ifndef ONLINE_JUDGE\n#define DEBUG\n#endif\n\n#define Fi first\n#define Se second\n#define pb push_back\n#define mp make_pair\n#define rep(x, a, b) for(int x = (a); x <= (b); ++ x)\n#define per(x, a, b) for(int x = (a); x >= (b); -- x)\n#define rop(x, a, b) for(int x = (a); x < (b); ++ x)\n#define por(x, a, b) for(int x = (a); x > (b); -- x)\n#define forE(x, a) for(int x = head[a]; x; x = nxt[x])\n\n#ifdef DEBUG\n#define debug(x) cerr << #x << \": \" << x << '\\n'\n#else\n#define debug(x)\n#endif\n\nvoid open(const char *s){\n    #ifdef DEBUG\n    char str[100];\n    sprintf(str,\"%s.in\",s);\n    freopen(str,\"r\",stdin);\n    sprintf(str,\"%s.my\",s);\n    freopen(str,\"w\",stdout);\n    #endif\n}\n\nconst db eps = 1e-8;\nconst int inf = 0x3f3f3f3f;\nconst int Minf = 0x7f7f7f7f;\nconst LL INF = 0x3f3f3f3f3f3f3f3fll;\nconst LL MINF = 0x7f7f7f7f7f7f7f7fll;\n\nconst int N = 5e5 + 50;\n\nchar s[N], p[10], opt[10];\nvector <int> S[4];\n\nint nxt[N][26];\nint f[255][255][255];\n\n\nint main() {\n    ios::sync_with_stdio(0);\n    cin.tie(0); cout.tie(0);\n    int n, q; cin >> n >> q;\n    cin >> (s + 1);\n    rep(i, 0, 25) nxt[n][i] = n + 1, nxt[n + 1][i] = n + 1;\n    per(i, n - 1, 0) {\n        rep(j, 0, 25) nxt[i][j] = nxt[i + 1][j];\n        nxt[i][s[i + 1] - 'a'] = i + 1;\n    }\n    rep(i, 0, 254) rep(j, 0, 254) rep(k, 0, 254) f[i][j][k] = n + 1;\n    int L1 = 0, L2 = 0, L3 = 0;\n    f[0][0][0] = 0;\n    while(q --) {\n        int x; cin >> opt >> x;\n        if(opt[0] == '+') {\n            cin >> p;\n            S[x].push_back(p[0] - 'a');\n            if(x == 1) {\n                ++ L1;\n                int i = L1;\n                for(int j = 0; j <= L2; ++ j) {\n                    for(int k = 0; k <= L3; ++ k) {\n                        if(i > 0) f[i][j][k] = min(f[i][j][k], nxt[f[i - 1][j][k]][S[1][i - 1]]);\n                        if(j > 0) f[i][j][k] = min(f[i][j][k], nxt[f[i][j - 1][k]][S[2][j - 1]]);\n                        if(k > 0) f[i][j][k] = min(f[i][j][k], nxt[f[i][j][k - 1]][S[3][k - 1]]);\n                    }\n                }\n            }\n            else if(x == 2) {\n                ++ L2;\n                for(int i = 0; i <= L1; ++ i) {\n                    int j = L2;\n                    for(int k = 0; k <= L3; ++ k) {\n                        if(i > 0) f[i][j][k] = min(f[i][j][k], nxt[f[i - 1][j][k]][S[1][i - 1]]);\n                        if(j > 0) f[i][j][k] = min(f[i][j][k], nxt[f[i][j - 1][k]][S[2][j - 1]]);\n                        if(k > 0) f[i][j][k] = min(f[i][j][k], nxt[f[i][j][k - 1]][S[3][k - 1]]);\n                    }\n                }\n            }\n            else {\n                ++ L3;\n                for(int i = 0; i <= L1; ++ i) {\n                    for(int j = 0; j <= L2; ++ j) {\n                        int k = L3;\n                        if(i > 0) f[i][j][k] = min(f[i][j][k], nxt[f[i - 1][j][k]][S[1][i - 1]]);\n                        if(j > 0) f[i][j][k] = min(f[i][j][k], nxt[f[i][j - 1][k]][S[2][j - 1]]);\n                        if(k > 0) f[i][j][k] = min(f[i][j][k], nxt[f[i][j][k - 1]][S[3][k - 1]]);\n                    }\n                }\n            }\n        }\n        else {\n            S[x].pop_back();\n            if(x == 1) {\n                int i = L1; rep(j, 0, L2) rep(k, 0, L3) f[i][j][k] = n + 1;\n                -- L1;\n            }\n            else if(x == 2) {\n                int j = L2; rep(i, 0, L1) rep(k, 0, L3) f[i][j][k] = n + 1;\n                -- L2;\n            }\n            else {\n                int k = L3; rep(i, 0, L1) rep(j, 0, L2) f[i][j][k] = n + 1;\n                -- L3;\n            }\n        }\n        if(f[L1][L2][L3] > n) puts(\"NO\");\n        else puts(\"YES\");\n    }\n    return 0;\n}\n```",
        "postTime": 1556670053,
        "uid": 44777,
        "name": "djh123",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1149B \u3010Three Religions\u3011"
    }
]
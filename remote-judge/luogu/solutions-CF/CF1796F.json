[
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](/problem/CF1796F)\n\n\u5f88\u9ad8\u5999\u7684\u6570\u8bba\u9898\u554a\uff0c\u573a\u4e0a\u6ca1\u4e00\u4e2a\u4eba\u8fc7\u3002\u77aa\u4e86\u597d\u4e45\u5b98 sol \u7ec8\u4e8e\u5f04\u61c2\u4e86\u3002\n\n*\u672c\u6587\u90e8\u5206\u53c2\u8003\u4e86[\u5b98 sol](//codeforces.com/blog/entry/113408)\u3002*\n\n\u51ed\u501f\u4eba\u7c7b\u667a\u6167\u53ef\u4ee5\u5f97\u51fa\uff0c\u5408\u6cd5\u7684\u4e09\u5143\u7ec4 $(a,b,n)$ \u5f88\u5c11\uff0c\u8003\u8651\u76f4\u63a5\u679a\u4e3e\u3002\u91cd\u70b9\u5728\u4e8e\u5982\u4f55\u51cf\u5c11\u679a\u4e3e\u91cf\u3002\n\n\u5148\u8fdb\u884c\u4e00\u4e2a\u5f0f\u5b50\u7684\u63a8\u3002\n\n\u8bbe $\\operatorname{len}(x)=\\lfloor\\log_{10}x\\rfloor+1$\uff0c\u5373 $x$ \u5728\u5341\u8fdb\u5236\u4e0b\u7684\u7684\u957f\u5ea6\uff0c\u5219\u9898\u76ee\u8981\u6c42\u5373\u4e3a\uff1a\n\n$$\\dfrac{a\\cdot10^{\\operatorname{len}(n)}+n}{n\\cdot10^{\\operatorname{len}(b)}+b}=\\dfrac ab$$\n\n$$ab\\cdot10^{\\operatorname{len}(n)}+nb=an\\cdot10^{\\operatorname{len}(b)}+ab$$\n\n\u4ee4 $g=\\gcd(a,b)$\uff0c$a=a'g$\uff0c$b=b'g$ \u5219\uff1a\n\n$$a'b\\cdot10^{\\operatorname{len}(n)}+nb'=a'n\\cdot10^{\\operatorname{len}(b)}+a'b$$\n\n\u5bb9\u6613\u53d1\u73b0 $n$ \u662f $a'$ \u7684\u500d\u6570\u3002\u518d\u4ee4 $n=a'n'$\uff1a\n\n$$b\\cdot10^{\\operatorname{len}(n)}+n'b'=a'n'\\cdot10^{\\operatorname{len}(b)}+b$$\n\n$$b'=a'\\cdot10^{\\operatorname{len}(b)}-\\dfrac{b\\cdot(10^{\\operatorname{len}(n)}-1)}{n'}$$\n\n\u663e\u7136\u7684\uff0c$n'$ \u662f $b\\cdot(10^{\\operatorname{len}(n)}-1)$ \u7684\u56e0\u6570\u3002\n\n\u8bbe $n'=k_1k_2$\uff0c\u5176\u4e2d $k_1$ \u662f $b$ \u7684\u56e0\u6570\uff0c$k_2$ \u662f $10^{\\operatorname{len}(n)}-1$ \u7684\u56e0\u6570\uff0c\u4e14 $k_1$ \u5c3d\u53ef\u80fd\u5c0f\u3002\n\n\u4ee4 $d=\\dfrac b{k_1}$\uff0c$r=\\dfrac{10^{\\operatorname{len}(n)}-1}{k_2}$\uff0c\u90a3\u4e48\uff1a\n\n$$b'=a'\\cdot10^{\\operatorname{len}(b)}-dr$$\n\n\u8fd9\u6837\u62c6\u5f00\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u679a\u4e3e $\\operatorname{len}(n)$ \u548c $10^{\\operatorname{len}(n)}-1$ \u7684\u56e0\u6570 $k_2$\uff0c\u6c42\u51fa $r$\u3002\n\n\u4f46\u662f\u73b0\u5728\u5f0f\u5b50\u91cc\u8fd8\u6709 $d$ \u548c $\\operatorname{len}(b)$\uff0c\u53ef\u4ee5\u628a\u5b83\u4eec\u4e5f\u679a\u4e3e\u6389\u3002\u56e0\u4e3a $d\\le b<10^5$\uff0c\u6240\u4ee5\u679a\u4e3e\u91cf\u662f\u53ef\u63a5\u53d7\u7684\u3002\n\n\u63a5\u4e0b\u6765\u628a\u4e0a\u9762\u90a3\u4e2a\u5f0f\u5b50\u4e24\u8fb9\u540c\u65f6\u5bf9 $10^{\\operatorname{len}(b)}$ \u53d6\u6a21\uff1a\n\n$$b'\\bmod{10^{\\operatorname{len}(b)}}=10^{\\operatorname{len}(b)}-dr\\bmod{10^{\\operatorname{len}(b)}}$$\n\n\u53c8\u56e0\u4e3a $b'\\le b<10^{\\operatorname{len}(b)}$\uff0c\u6240\u4ee5\u7b49\u5f0f\u5de6\u8fb9\u7684 $\\bmod$ \u53ef\u4ee5\u6254\u4e86\uff1a\n\n$$b'=10^{\\operatorname{len}(b)}-dr\\bmod{10^{\\operatorname{len}(b)}}$$\n\n\u90a3\u4e48\u6211\u4eec\u77e5\u9053\u4e86 $b'$ \u548c $\\operatorname{len}(b)$\uff0c\u63a5\u4e0b\u6765\u53ea\u8981\u628a $g$ \u641e\u51fa\u6765\u5c31\u597d\u4e86\u3002\u663e\u7136\u7684\uff0c\u6709\uff1a\n\n$$10^{\\operatorname{len}(b)-1}\\le b=b'g<10^{\\operatorname{len}(b)}$$\n\n$$\\left\\lceil\\dfrac{10^{\\operatorname{len}(b)-1}}{b'}\\right\\rceil\\le g\\le\\left\\lfloor\\dfrac{10^{\\operatorname{len}(b)}-1}{b'}\\right\\rfloor$$\n\n\u6709\u4e86\u4e0a\u4e0b\u754c\uff0c\u4f46\u76f4\u63a5\u679a\u4e3e\u8fd8\u662f\u4e0d\u592a\u53ef\u884c\u3002\u6ce8\u610f\u5230 $b=b'g=dk_1$\uff0c\u90a3\u4e48\n\n$$g=k_1\\cdot\\dfrac d{b'}$$\n\n\u4ee4 $d'=\\gcd(d,b')$\uff0c\u5219 $g$ \u4e00\u5b9a\u662f $d'$ \u7684\u500d\u6570\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u53ea\u679a\u4e3e\u4e0a\u9762\u8303\u56f4\u5185 $d'$ \u7684\u500d\u6570\uff0c\u8fd9\u6837\u7684\u679a\u4e3e\u91cf\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\u3002\n\n\u8fd9\u6837\u4f60\u5c31\u53ef\u4ee5\u8fd8\u539f\u539f\u6765\u7684\u4e09\u5143\u7ec4\u4e86\u3002\n\n\u5148\u8fd8\u539f $a'=\\dfrac{b'+dr}{10^{\\operatorname{len}(b)}}$ \u548c $k_1=\\dfrac bd$\uff0c\u7136\u540e\u4ee3\u5165\uff0c\u6700\u7ec8\u6c42\u51fa\uff1a\n\n$$\\begin{cases}a=a'g\\\\b=b'g\\\\n=k_1k_2a'\\end{cases}$$\n\n\u6700\u540e\u8fd8\u8981\u8fdb\u884c\u4e00\u4e9b\u68c0\u67e5\uff0c\u628a\u4e0d\u5408\u6cd5\u7684\u6392\u9664\u6389\u3002\n\n- $a,b,n$ \u662f\u5426\u771f\u7684\u5728\u9898\u76ee\u4e2d\u6240\u7ed9\u7684 $[1,A),[1,B),[1,N)$ \u8303\u56f4\u5185\uff1b\n- $\\gcd(a',b')$ \u662f\u5426\u4e3a $1$\uff1b\n- $\\gcd(k_1,r)$ \u662f\u5426\u4e3a $1$\uff0c\u56e0\u4e3a\u4e0a\u9762\u8981\u6c42\u4e86 $k_1$ \u5c3d\u53ef\u80fd\u5c0f\uff1b\n  - \u5982\u679c $\\gcd(k_1,r)>1$\uff0c\u90a3\u5b8c\u5168\u53ef\u4ee5\u5c06 $k_1\\gets\\dfrac{k_1}{\\gcd(k_1,r)}$\uff0c\u5f97\u5230\u4e00\u4e2a\u66f4\u5c0f\u7684 $k_1$\u3002\n- $n$ \u7684\u957f\u5ea6\u662f\u5426\u548c\u6211\u4eec\u679a\u4e3e\u7684\u4e00\u6837\uff1b\n- \u4e09\u5143\u7ec4 $(a,b,n)$ \u662f\u5426\u6ee1\u8db3\u9898\u76ee\u4e2d\u7684\u6761\u4ef6\u3002\n\n\u4e8e\u662f\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u590d\u6742\u5ea6\u5f88\u96be\u7b97\uff0c\u5927\u6982\u662f\u5e26\u4e00\u4e2a $200$ \u5de6\u53f3\u7684\u5e38\u6570\u7684 $O(B\\log B)$\uff0c\u4f46\u662f\u8db3\u4ee5\u63a5\u53d7\u3002\n\n\u8fd9\u6b21\u4e0d\u8d34\u4ee3\u7801\u4e86\uff0c~~\u56e0\u4e3a\u6211\u5199\u7684\u5f88\u4e11~~\u3002",
        "postTime": 1677719223,
        "uid": 127949,
        "name": "cmk666",
        "ccfLevel": 7,
        "title": "CF1796F \u9898\u89e3"
    }
]
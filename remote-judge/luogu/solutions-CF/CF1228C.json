[
    {
        "content": "## \u5e7f\u544a\n\u60f3\u8981\u66f4\u4f73\u7684\u98df\u7528\u4f53\u9a8c\uff0c\u8bf7\u524d\u5f80[\u849f\u84bb\u306eBlog](https://stevenmhy.tk/archives/9b983113.html)\n\n## $Pro3$\n\n[\u4f20\u9001\u95e8](https://codeforces.com/contest/1228/problem/C)\n\n\u5b9a\u4e49$prime(x)$\u4e3a$x$\u7684\u8d28\u56e0\u5b50\u7684\u96c6\u5408\uff0c\u6bd4\u5982\u8bf4$prime(140)=\\{2,5,7\\}$\n\n\u8bbe$g(x,p)$\u662f\u80fd\u591f\u6574\u9664$x$\u7684\u6700\u5927\u7684$p^k$\uff0c\u6bd4\u5982\u8bf4$g(45,3)=9$\n\n\u8bbe$f(x,y)$\u4e3a$\\prod _{p \\in prime(x)} g(y,p)$\uff0c\u6bd4\u5982\u8bf4$f(30, 70) = g(70, 2) \\cdot g(70, 3) \\cdot g(70, 5) = 2^1 \\cdot 3^0 \\cdot 5^1 = 10$\n\n\u7ed9\u4f60$x,n$\uff0c\u8ba1\u7b97$\\prod _{i=1}^n f(x,i)$\n\n## $Sol3$\n\n~~\u6570\u8bba\u4e0d\u4f1a\u5148\u6253\u8868~~\n\n\u5148\u8ba1\u7b97\u4e00\u4e0b$x=10,n=10$\u7684\u60c5\u51b5\uff1a\n\n$f(10,1)=1$ $f(10,2)=2$ $f(10,3)=1$ $f(10,4)=4$ $f(10,5)=5$\n\n$f(10,6)=2$ $f(10,7)=1$ $f(10,8)=8$ $f(10,9)=1$ $f(10,10)=10$\n\n\u5982\u4f55\u8003\u8651\uff0c\u4e0d\u59a8\u5bf9$prime(x)$\u4e2d\u7684\u5143\u7d20\u5206\u522b\u8003\u8651\uff0c\u8003\u8651\u8d28\u56e0\u5b50$2$\u5bf9\u7b54\u6848\u7684\u8d21\u732e\uff0c\u4ed6\u4f1a\u5206\u522b\u5bf9$f(x,2 \\times i)$\u505a\u51fa\u4e00\u4e2a$2$\u7684\u8d21\u732e\uff0c\u540c\u65f6\u5bf9$f(x,2^2 \\times i)$\u505a\u51fa\u4e00\u4e2a$2$\u7684\u8d21\u732e\uff0c\u5bf9$f(x,2^3 \\times i)$\u505a\u51fa\u4e00\u4e2a$2$\u7684\u8d21\u732e\u3002\n\n\u4e8e\u662f\u603b\u7684\u8d21\u732e\u662f$2^ {[n/2]} \\times 2 ^ {[n/2^2]} \\times 2^{[n/2^3]} ...$\n\n\u8fd8\u8981\u7ee7\u7eed\u8003\u8651$5$\u5bf9\u7b54\u6848\u7684\u8d21\u732e\uff0c\u8fd9\u91cc\u7701\u7565\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u6838\u5fc3\u4ee3\u7801\uff1a\n\n```cpp\ninline int Calc(int x,int n){\n\twhile (n){\n\t\tans=(ans*ksm(x,n/x,MOD))%MOD;\n\t\tn/=x;\n\t}\n\treturn 0;\n}\n```\n\n\u5c31\u662f\u8ba1\u7b97\u6bcf\u4e00\u4e2a\u8d28\u56e0\u5b50$x$\u5bf9\u4e8e\u7b54\u6848\u7684\u8d21\u732e\u3002\n\n## $Code3$\n\n```cpp\n#include <bits/stdc++.h>\n#define MAXN 200005\n#define int long long\n#define MOD 1000000007\nusing namespace std;\ninline int read(){\n    int x=0,f=1;\n    char ch=getchar();\n    while (ch<'0'||ch>'9'){\n        if (ch=='-') f=-1;\n        ch=getchar();\n    }\n    while (ch>='0'&&ch<='9'){\n        x=(x<<3)+(x<<1)+(ch^'0');\n        ch=getchar();\n    }\n    return x*f;\n}\nint ans=1;\ninline int ksm(int b,int p,int k){\n    int ans=1;\n    while (p>0){\n        if (p&1ll){\n            ans=(b*ans)%k;\n        }\n        b=(b*b)%k;\n        p>>=1ll;\n    }\n    return ans%MOD;\n}\ninline int Calc(int x,int n){\n\twhile (n){\n\t\tans=(ans*ksm(x,n/x,MOD))%MOD;\n\t\tn/=x;\n\t}\n\treturn 0;\n}\nint cnt,primes[MAXN];\ninline void Sieve(int x){//\u627e\u51fax\u7684\u8d28\u56e0\u6570\n\tint bd=sqrt(x);\n\tfor (register int i=2;i<=bd;++i){\n\t\tif (x%i==0){\n\t\t\tprimes[++cnt]=i;\n\t\t\twhile (x%i==0) x/=i;\n\t\t}\n\t}\n\tif (x>1) primes[++cnt]=x;//x\u662f\u8d28\u6570\n}\n#undef int\nint main(){\n#define int long long\n\tint x,n;\n\tcin>>x>>n;\n\tSieve(x);//\u627e\u51fax\u7684\u6240\u6709\u8d28\u56e0\u5b50\n\tfor (register int i=1;i<=cnt;++i){\n\t\tCalc(primes[i],n);\n\t}\n\tcout<<ans;\n}\n```\n\u539f\u8c05`define int long long`\uff0cqwq",
        "postTime": 1569848610,
        "uid": 45109,
        "name": "Steven_Meng",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1228C \u3010Primes and Multiplication\u3011"
    },
    {
        "content": "### \u9898\u610f\n\n\u5b9a\u4e49$prime(x)$\u4e3a\u7531$x$\u7684\u6240\u6709\u8d28\u56e0\u5b50\u6784\u6210\u7684\u96c6\u5408\uff0c$g(x,p)$\u4e3a\u6ee1\u8db3$p^k\\mid x$\u5e76\u4e14$p^{k+1}\\nmid x$\u7684$k$\uff0c$f(x,y)=\\prod\\limits_{p\\in prime(x)}g(y,p)$\u3002\n\n\u7ed9\u5b9a$x,n$\uff0c\u6c42$\\prod\\limits_{i=1}^{n}f(x,i)\\bmod10^9+7$\u3002\n\n$\\texttt{Data Range:}1\\leq x\\leq 10^9,1\\leq n\\leq 10^{18}$\n\n### \u9898\u89e3\n\n\u8fd8\u662f\u4e00\u9053\u633a\u6e05\u65b0\u7684$\\texttt{C}$\u9898\u3002~~\u4e0a\u6b21`1195C`\u90a3\u9898\u8bfb\u9519\u9898\u7136\u540e\u5c31\u6389\u5206\u5566qwq~~\n\n\u6211\u4eec\u9996\u5148\u6765\u63a8\u4e00\u4e0b\u67ff\u5b50\uff1a\n\n$$\\prod\\limits_{i=1}^{n}f(x,i)=\\prod\\limits_{i=1}^{n}\\prod\\limits_{p\\in prime(x)}g(i,p)$$\n\n$$\\prod\\limits_{i=1}^{n}\\prod\\limits_{p\\in prime(x)}g(i,p)=\\prod\\limits_{p\\in prime(x)}\\prod\\limits_{i=1}^{n}g(i,p)$$\n\n\u73b0\u5728\u6211\u4eec\u7684\u76ee\u6807\u662f\u5bf9\u67d0\u4e00\u4e2a\u7279\u5b9a\u7684\u8d28\u6570$p$\uff0c\u6c42$\\prod\\limits_{i=1}^{n}g(i,p)$\n\n~~\u8fd9\u4e0d\u968f\u4fbf\u505a\u554aqwq~~\n\n\u9996\u5148\u8003\u8651$1$\u5230$n$\u4e2d\u53ea\u6709$\\lfloor\\frac{n}{p}\\rfloor$\u4e2a\u6570\u6574\u9664$p$\uff0c\u4e8e\u662f\u5269\u4e0b$n-\\lfloor\\frac{n}{p}\\rfloor$\u7684\u8d21\u732e\u4e3a$1^{n-\\lfloor\\frac{n}{p}\\rfloor}$\n\n\u7136\u540e\u5269\u4e0b\u7684\u6570\u6211\u4eec\u8868\u793a\u6210$p,2p\\cdots$\uff0c\u6bcf\u4e2a\u6570\u7684\u8d21\u732e\u4e3a$p$\u7684\u500d\u6570\uff0c\u4e8e\u662f\u6211\u4eec\u5148\u628a\u7b54\u6848\u4e58\u4e0a$p^{\\lfloor\\frac{n}{p}\\rfloor}$\uff0c\u8fd9\u4e9b\u6570\u53d8\u6210$1,2,\\cdots\\lfloor\\frac{n}{p}\\rfloor$\uff0c\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u9012\u5f52\u505a\u4e86qwq\n\n\u8fd9\u91cc\u4e3e\u4e2a\u6817\u5b50\u5427qwq\n\n\u6bd4\u5982\u8bf4\u6211\u4eec\u8981\u6c42$\\prod\\limits_{i=1}^{8}g(i,2)$\n\n\u9996\u5148\u6211\u4eec\u77e5\u9053\u6709$8-\\lfloor\\frac{8}{2}\\rfloor=4$\u4e2a\u6570\u7684\u8d21\u732e\u4e3a$1$\uff0c\u6240\u4ee5\u8fd9$4$\u4e2a\u6570\u7684\u8d21\u732e\u4e3a$1^4$\u3002\n\n\u7136\u540e\u7ee7\u7eed\u9012\u5f52\u5269\u4e0b$4$\u4e2a\u6570\uff0c\u6709$4-\\lfloor\\frac{4}{2}\\rfloor=2$\u4e2a\u6570\u8d21\u732e\u4e3a$2$\uff0c\u8fd9\u4e24\u4e2a\u6570\u8d21\u732e\u4e3a$2^2$\u3002\n\n\u5269\u4e0b$2$\u4e2a\u6570\u4e2d\u6709$2-\\lfloor\\frac{2}{2}\\rfloor=1$\u4e2a\u6570\u8d21\u732e\u4e3a$2^2=4$\uff0c\u8d21\u732e\u4e3a$4^1$\u3002\n\n\u5269\u4e0b\u4e00\u4e2a\u6570\u4e2d\u6709$1-\\lfloor\\frac{1}{2}\\rfloor=1$\u4e2a\u6570\u8d21\u732e\u4e3a$2^3=8$\uff0c\u8d21\u732e\u4e3a$8^1$\u3002\n\n\u5269\u4e0b\u6ca1\u6709\u6570\u4e86\uff0c\u7b54\u6848\u4e3a$1^4\\times 2^2\\times 4^1\\times 8^1$\u3002\n\n\u8fd9\u6837\u505a\u662f$O(\\log n)$\u7684\u3002\n\n\u6240\u4ee5\u603b\u590d\u6742\u5ea6\u662f$O(\\log x\\log n)$\u7684\uff0c\u800c\u5b9e\u9645\u4e0a\u6ca1\u6709\u8fbe\u5230\u8fd9\u4e2a\u4e0a\u754c\uff0c\u56e0\u4e3a$x$\u7684\u8d28\u56e0\u5b50\u4e2a\u6570\u6ca1\u8fbe\u5230$\\ln x$\u554aqwq~~\u6211\u4eec\u673a\u623f\u5927\u4f6c\u8bf4\u7684~~\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long int ll;\nconst ll MAXN=1e4+51,MOD=1e9+7;\nll x,cnt,tot,res;\nll factor[MAXN];\ninline ll read()\n{\n    register ll num=0,neg=1;\n    register char ch=getchar();\n    while(!isdigit(ch)&&ch!='-')\n    {\n        ch=getchar();\n    }\n    if(ch=='-')\n    {\n        neg=-1;\n        ch=getchar();\n    }\n    while(isdigit(ch))\n    {\n        num=(num<<3)+(num<<1)+(ch-'0');\n        ch=getchar();\n    }\n    return num*neg;\n} \ninline void getFact(ll x)\n{\n\tfor(register int i=2;i<=sqrt(x);i++)\n\t{\n\t\tif(!(x%i))\n\t\t{\n\t\t\tfactor[++tot]=i;\n\t\t\twhile(!(x%i))\n\t\t\t{\n\t\t\t\tx/=i;\n\t\t\t}\n\t\t}\n\t}\n\tif(x!=1)\n\t{\n\t\tfactor[++tot]=x;\n\t}\n}\ninline ll qpow(ll base,ll exponent)\n{\n\tll res=1;\n\twhile(exponent)\n\t{\n\t\tif(exponent&1)\n\t\t{\n\t\t\tres=res*base%MOD;\n\t\t}\n\t\tbase=base*base%MOD,exponent>>=1;\n\t}\n\treturn res;\n}\ninline ll calc(ll cnt,ll x,ll p)\n{\n\tif(cnt==0)\n\t{\n\t\treturn 1;\n\t}\n\treturn qpow(p,(cnt-cnt/x)%(MOD-1))*calc(cnt/x,x,p*x%MOD)%MOD;\n}\nint main()\n{\n\tx=read(),cnt=read(),getFact(x),res=1;\n\tfor(register int i=1;i<=tot;i++)\n\t{\n\t\tres=res*calc(cnt,factor[i],1)%MOD;\n\t}\n\tcout<<res<<endl;\n}\n```",
        "postTime": 1569803998,
        "uid": 60990,
        "name": "Karry5307",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1228C \u3010Primes and Multiplication\u3011"
    },
    {
        "content": "* \u6c42 $\\prod\\limits_{i=1}^nf(x,i)\\bmod(10^9+7)$ \u7684\u503c\u3002\uff08$f$ \u7684\u5b9a\u4e49\u5982\u9898\uff09\n* $2\\le x\\le10^9,1\\le n\\le10^{18}$\u3002\n\n\u9996\u5148\uff0c\u628a\u5f0f\u5b50\u62c6\u5f00\uff0c\u5f97\u5230 $\\prod\\limits_{i=1}^n\\prod\\limits_{p\\in prime(x)}g(i,p)$\u3002  \n\u89c2\u5bdf\u4e00\u4e0b $g$ \u7684\u6027\u8d28\uff0c\u53d1\u73b0 $g(a,p)\\cdot g(b,p)=g(ab,p)$\uff0c\u4e8e\u662f\u5316\u7b80\u5f0f\u5b50\u4e3a $\\prod\\limits_{p\\in prime(x)}g(n!,p)$\u3002  \n\u63a8\u5bfc\u53d1\u73b0\uff1a\n$$\n\\begin{aligned}\n\\log_p(g(n!,p))&=(0,n]\\text{ \u91cc\u80fd\u88ab }p\\text{ \u6574\u9664\u7684\u6570\u7684\u4e2a\u6570 }+\\ (0,n]\\text{ \u91cc\u80fd\u88ab }p^2\\text{ \u6574\u9664\u7684\u6570\u7684\u4e2a\u6570 }+ \\ (0,n]\\text{ \u91cc\u80fd\u88ab }p^3\\text{ \u6574\u9664\u7684\u6570\u7684\u4e2a\u6570 }+\\ \\ldots\\\\\n&=\\left\\lfloor\\frac{n}{p}\\right\\rfloor+\\left\\lfloor\\frac{n}{p^2}\\right\\rfloor+\\left\\lfloor\\frac{n}{p^3}\\right\\rfloor+\\ \\ldots\\\\\n&=\\left\\lfloor\\frac{n}{p}\\right\\rfloor+\\left\\lfloor\\frac{\\left\\lfloor\\frac{n}{p}\\right\\rfloor}{p}\\right\\rfloor+\\left\\lfloor\\frac{\\left\\lfloor\\frac{\\left\\lfloor\\frac{n}{p}\\right\\rfloor}{p}\\right\\rfloor}{p}\\right\\rfloor+\\ \\ldots\n\\end{aligned}\n$$\n\u6240\u4ee5\u53ea\u9700 $O(\\log n)$ \u9012\u63a8\u7b97\u51fa\u6307\u6570\u518d\u5feb\u901f\u5e42\u6c42\u89e3\u5373\u53ef\u3002\u5bf9\u4e8e\u6bcf\u4e2a $p\\in prime(x)$\uff0c\u628a\u7ed3\u679c\u4e58\u8d77\u6765\u5c31\u80fd\u5f97\u51fa\u7b54\u6848\u3002  \n\u603b\u5171\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\sqrt x +\\log x\\log n)$\u3002\n\n\u4ee3\u7801\uff1a\n```c++\n#include <iostream>\n#include <vector>\n\nusing namespace std;\n\ntypedef long long LL;\n\nconst int MOD = 1e9 + 7;\n\nint x;\nLL n;\n\nbool is_prime(int x) // \u5224\u65ad x \u662f\u5426\u4e3a\u8d28\u6570\n{\n\tif (x < 2) return false;\n    for (int i = 2; i <= x / i; i ++ )\n        if (!(x % i))\n            return false;\n    return true;\n}\n\nvector<int> prime_divisors(int x) // \u6c42\u51fa prime(x)\n{\n    vector<int> res;\n    for (int i = 1; i <= x / i; i ++ ) // \u6ce8\u610f\uff0c\u8981\u4ece 1 \u5f00\u59cb\uff0c\u56e0\u4e3a\u53ef\u80fd x \u672c\u8eab\u5c31\u662f\u8d28\u6570\n        if (!(x % i))\n        {\n            if (is_prime(i)) res.push_back(i);\n            if (i ^ x / i && is_prime(x / i)) res.push_back(x / i);\n        }\n    return res;\n}\n\nint qpow(int a, LL b) // \u5feb\u901f\u5e42\uff0c\u6c42\u51fa a^b mod 1000000007\n{\n    int res = 1;\n    while (b)\n    {\n        if (b & 1) res = (LL)res * a % MOD;\n        a = (LL)a * a % MOD, b >>= 1;\n    }\n    return res;\n}\n\nint main()\n{\n    cin >> x >> n;\n    \n    vector<int> primes = prime_divisors(x);\n    \n    int res = 1; // \u7ed3\u679c\n    for (int i = 0; i < primes.size(); i ++ ) // \u679a\u4e3e\u6bcf\u4e2a\u8d28\u6570\n    {\n    \tint prime = primes[i];\n//    \tcout << prime << '\\n'; \u8c03\u8bd5\u7528\uff0c\u5982\u679c\u4e00\u4e2a\u8d28\u6570\u90fd\u6ca1\u8f93\u51fa\uff0c\u90a3\u4e00\u822c\u662f prime(x) \u7684\u8ba1\u7b97\u51fa\u4e86\u95ee\u9898\n        LL cnt = 0, tmp = n;\n        do tmp /= prime, cnt += tmp; // \u4e0b\u9762\u4e24\u884c\u6c42 prime \u5728 n! \u4e2d\u7684\u6307\u6570\n        while (tmp);\n        res = (LL)res * qpow(prime, cnt) % MOD;\n    }\n    \n    cout << res;\n    \n    return 0;\n}\n```",
        "postTime": 1665060299,
        "uid": 714562,
        "name": "blue_ice",
        "ccfLevel": 0,
        "title": "CF1228C \u9898\u89e3"
    },
    {
        "content": "### 1.\u9898\u89e3\n\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u628a$x$\u8d28\u56e0\u6570\u5206\u89e3 \u7136\u540e\u8003\u8651$x$\u7684\u56e0\u5b50$p$ \n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$p$ \u6211\u4eec\u90fd\u8981\u6c42\u51fa$g(1,p)\\cdot g(2,p)\\cdots g(n,p)$ \u800c$g(x,p)$\u7684\u542b\u4e49\u5176\u5b9e\u5c31\u662f\u5bf9\u4e8e$x$\u8d28\u56e0\u6570\u5206\u89e3\u540e\u7684$p^k$\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u6309\u9636\u4e58\u5206\u89e3\u90a3\u4e48\u8003\u8651 \u8003\u8651\u6bcf\u4e2a\u56e0\u5b50$p$\u5bf9\u4e8e\u7b54\u6848\u7684\u8d21\u732e \n\n\u9996\u5148\u8003\u8651$p$ \u663e\u7136\u6709$\\lfloor \\frac{n}{p} \\rfloor$\u4e2a\u6570\u81f3\u5c11\u5305\u542b\u4e00\u4e2a$p$ \u90a3\u4e48\u8d21\u732e\u5c31\u662f$p^{\\lfloor \\frac{n}{p} \\rfloor}$\n\n\u4e4b\u540e\u518d\u8003\u8651$p^2$ \u6709$\\lfloor \\frac{n}{p^2} \\rfloor$\u4e2a\u6570\u53ef\u4ee5\u5206\u89e3\u51fa$p^2$ \u4f46\u7531\u4e8e\u4e4b\u524d\u6211\u4eec\u5728\u7edf\u8ba1$p$\u65f6\u5df2\u7ecf\u52a0\u4e86\u4e00\u904d \u6240\u4ee5\u8fd9\u65f6\u5019\u7684\u8d21\u732e\u4e0d\u9700\u8981\u4e582 \u53ea\u9700\u8981\u518d\u52a0\u4e0a$\\lfloor \\frac{n}{p^2} \\rfloor$\u5c31\u597d\u4e86\n\n\u4ee5\u6b64\u7c7b\u63a8 \u603b\u5171\u9700\u8981\u7edf\u8ba1$\\log_{p}{n}$\u6b21 \u8bb0\u8d21\u732e\u603b\u6570\u4e3a$t$ \u90a3\u4e48\u8be5$p$\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4fbf\u662f$p^t$ \u4e4b\u540e\u5feb\u901f\u5e42\u7edf\u8ba1\u5373\u53ef \u8981\u6ce8\u610f\u7684\u662f\u5728\u7edf\u8ba1\u8d21\u732e\u6570\u65f6\u6709\u53ef\u80fd\u4f1a\u7206long long\uff08\u5b9e\u9645\u4e0a\u4e0d\u4f1a\uff09\u6211\u4eec\u4e0d\u7528\u8003\u8651\u90a3\u4e48\u591a \u56e0\u4e3a$t$\u662f\u6b21\u5e42\u4e0d\u80fd\u76f4\n\u63a5%mod \u4f46\u662f\u6211\u4eec\u6709\u6b27\u62c9\u5b9a\u7406 \u6211\u4eec\u628a\u6b21\u5e42\u6a21$\\phi(mod)$\u7b54\u6848\u662f\u4e0d\u53d8\u7684 \u56e0\u4e3a\u9898\u76ee\u7ed9\u7684mod\u662f$1e9+7$\u662f\u4e00\u4e2a\u8d28\u6570\u6240\u4ee5\u76f4\u63a5\u6a21(mod-1)\u5373\u53ef\n### 2.AC\u4ee3\u7801\uff1a\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cstring>\n#include<vector>\n#define ll long long\nusing namespace std;\nconst ll mod=1e9+7;\nll x,n;\nvector<ll> prime;\nll ksm(ll a,ll b)\n{\n\tll res=1;\n\twhile(b)\n\t{\n\t\tif(b&1) res=res*a%mod;\n\t\ta=a*a%mod;\n\t\tb>>=1;\n\t}\n\treturn res;\n}\nint main()\n{\n\tcin>>x>>n;\n\tfor(ll i=2;i<=x/i;i++)\n\t{\n\t\tif(x%i==0)\n\t\t{\n\t\t\tprime.push_back(i);\n\t\t\twhile(x%i==0) x/=i;\n\t\t}\n\t}\n\tif(x>1) prime.push_back(x);\n\tll l=prime.size();\n\tll ans=1;\n\tfor(int i=0;i<l;i++)\n\t{\n\t\tll p=prime[i];\n\t\tll t=n,t1=0;\n\t\twhile(t)\n\t\t{\n\t\t\tt1=(t1+t/p)%(mod-1);\n\t\t\tt/=p;\n\t\t}\n\t\tans=(ans%mod*ksm(p,t1)%mod)%mod;\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1571028986,
        "uid": 50976,
        "name": "songhn",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1228C \u3010Primes and Multiplication\u3011"
    },
    {
        "content": "~~\u8fd9\u9053\u9898\u4e0d\u96be,\u5b66\u8fc7\u5c0f\u5b66\u5965\u6570\u90fd\u80fd\u505a\u51fa\u6765~~\n\n\u9898\u610f,\u8ba9\u4f60\u6c42 $\\sum_{i=1}^n f(x,i)$\n\n\u7531\u4e8ef\u51fd\u6570\u7684\u6027\u8d28,\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5c06x\u7684\u7d20\u56e0\u5b50\u62c6\u51fa\u6765,\u518d\u8fdb\u884c\u5904\u7406.\n\n\u6211\u4eec\u5c06x\u7684\u7d20\u56e0\u5b50\u62c6\u51fa\u6765\u548c,\u8fd9\u9053\u9898\u53d8\u4e3a\u6c42\n\n$\\sum_ {i=1}^{n} \\sum_ {p \\in prime(x)}  g(i,p) $\n\n\u6211\u4eec\u7a0d\u52a0\u89c2\u5bdf\u5c31\u53ef\u4ee5\u53d1\u73b0.\u6211\u4eec\u53ea\u9700\u8981\u77e5\u9053\u6bcf\u4e2a\u8d28\u56e0\u6570\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5373\u53ef.\n\n\u90a3\u600e\u4e48\u6c42\u6bcf\u4e2a\u8d28\u56e0\u6570\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5462? \n\n~~\u5f53\u7136\u662f\u7528\u5c0f\u5b66\u5965\u6570.~~\n\n\u6211\u4eec\u6839\u636e\u4e4b\u524d\u6240\u5b66\u7684\u77e5\u8bc6. \u5047\u8bbe\u8fd9\u4e2a\u8d28\u56e0\u6570\u4e3a2,\u90a3\u4e482\u4e00\u5b9a\u51fa\u73b0\u8fc7$n/2$\u6b21, 4\u4e00\u5b9a\u51fa\u73b0\u8fc7 $n/4$\u6b21,\u5982\u6b64\u5faa\u73af\u4e0b\u53bb,\u76f4\u81f3\u8fd9\u4e2a\u6570\u5927\u4e8en.\n\n\u8fd9\u6837\u5c31\u65b9\u4fbf\u7b97\u8d21\u732e\u4e86.\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$sqrt(xlogx)$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mod=1e9+7;\n \nlong long ksm(long long a,long long b)\n{\n\tlong long ans=1,base=a;\n\twhile(b)\n\t{\n\t\tif(b&1) ans*=base,ans%=mod;\n\t\tbase*=base, base%=mod;\n\t\tb>>=1;\n\t}\n\treturn ans%=mod;\n}\nlong long x,n,pd;\nlong long ans=1,cnt[100005];\nlong long p[200005];\nbool vis[1000005];\nvoid get_pri(int n)\n{\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tif(!vis[i])\n\t\t{\n\t\t\tp[++p[0]]=i;\n\t\t}\n\t\tfor(int j=1;i*p[j]<=n&&j<=p[0];j++)\n\t\t{\n\t\t\tvis[i*p[j]]=1;\n\t\t\tif(i%p[j]==0) break;\n\t\t}\n\t}\n\t\n}\nint main()\n{\n\tscanf(\"%I64d%I64d\",&x,&n);\n \n\tint len=sqrt(x);\n\tget_pri(len);\n\tp[++p[0]]=1e9;\t\n\tfor(int i=1;p[i]<=len;i++)\n\t{\n\t\tif(x%p[i]==0)\n\t\t{\n\t\t\tcnt[++cnt[0]]=p[i];\n\t\t\twhile(x%p[i]==0)\n\t\t\t{\n\t\t\t\tx/=p[i];\n\t\t\t}\n\t\t}\n\t}\n\tif(x!=1)\n\t{\n\t\tcnt[++cnt[0]]=x;\n\t}//\u5904\u7406\u51fax\u7684\u7d20\u56e0\u5b50.\n\tfor(int i=1;i<=cnt[0];i++)\n\t{\n\t\tlong long c=n;\n\t\twhile(c)//\u6bcf\u4e2a\u6570\u7684\u8d21\u732e\u4e3a\u5b83\u7684\u51fa\u73b0\u6b21\u6570*\u7d20\u56e0\u5b50\n\t\t{\n\t\t\tans*=ksm(cnt[i],c/cnt[i]);\n\t\t\tc/=cnt[i];\n\t\t\tans%=mod;\n\t\t}\n\t}\n\tcout<<ans;\n\treturn 0;\n}\n```\n",
        "postTime": 1569908388,
        "uid": 53852,
        "name": "\u5f26\u5dfb\u3053\u3053\u308d",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1228C \u3010Primes and Multiplication\u3011"
    }
]
[
    {
        "content": "## Description\n\n\u6709 $n$ \u4e2a\u70b9\uff0c\u5728\u65f6\u523b $t_i$ \u65f6\u51fa\u73b0\u5728 $a_i$ \u4f4d\u7f6e\u4e0a\u3002\n\n\u4f60\u7684\u6700\u5927\u901f\u5ea6\u4e3a $v$ \u3002\u65f6\u523b $0$ \u65f6\u7684\u4f4d\u7f6e\u5728 $0$\u3002\n\n\u6c42\u6700\u591a\u6709\u51e0\u4e2a\u70b9\u80fd\u5728\u51fa\u73b0\u65f6\u5904\u5728\u5176\u4f4d\u7f6e\u4e0a\u3002\n\n## Solution\n\n\u8bbe $f_i$ \u4e3a\u7b2c $i$ \u70b9\u51fa\u73b0\u65f6\u5728 $a_i$ \u4e0a\u65f6\u7684\u6700\u591a\u7b54\u6848\u3002\n\n$f_i=\\max\\limits_{j=0}^{i-1} \\{f_j(|a_i-a_j|\\le v(t_i-t_j)\\}$\n\n\u8003\u8651\u4f18\u5316\u3002\n\n$|a_i-a_j|\\le v(t_i-t_j)$ \u7b49\u4ef7\u4e8e $v(t_j-t_i)\\le a_i-a_j\\le v(t_i-t_j)$\n\n\u6574\u7406\u5f97\n\n$$\\begin{cases}v\\cdot t_j+a_j\\le v\\cdot t_i+a_i\\\\v\\cdot t_j-a_j\\le v\\cdot t_i-a_i\\\\t_j<t_i\\end{cases}$$\n\n\u4e09\u7ef4\u6570\u70b9\u3002\n\n\u8003\u8651\u5230\u5982\u679c\u7b2c\u4e00\u4e2a\u7b2c\u4e8c\u4e2a\u6761\u4ef6\u6210\u7acb\uff0c\u90a3\u4e48\u7b2c\u4e09\u4e2a\u6761\u4ef6\u4e5f\u540c\u6837\u6210\u7acb\u3002\u6240\u4ee5\u53ea\u9700\u8981\u4e8c\u4f4d\u6570\u70b9\u3002\u6811\u72b6\u6570\u7ec4\u89e3\u51b3\u5373\u53ef\u3002\n\n#### code\n\n```cpp\n#include<bits/stdc++.h>\n#define maxn 400005\n#define int long long\n#define put() putchar('\\n')\nusing namespace std;\ninline void read(int &x){\n\tint f=1;x=0;char c=getchar();\n\twhile (c<'0'||c>'9') {if (c=='-') f=-1;c=getchar();}\n\twhile (c>='0'&&c<='9') {x=x*10+c-'0';c=getchar();}\n\tx*=f;\n}\nint n,v,t[maxn],a[maxn],tot,dp[maxn];\nstruct yyy{\n\tint x,y,id;\n}h[maxn];\nint g[maxn*2];\ninline bool cmp(yyy x,yyy y){return x.x==y.x?x.y<y.y:x.x<y.x;}\nstruct BIT{\n\t#define lowbit(x) ((x)&(-x))\n\tint f[maxn];\n\tBIT(void) {memset(f,-0x3f,sizeof(f));}\n\tinline void add(int x,int y) {for (;x<=tot;x+=lowbit(x)) f[x]=max(f[x],y);}\n\tinline int query(int x) {int ans=-1e9;for (;x;x-=lowbit(x)) ans=max(f[x],ans);return ans;}\n}tr;\nsigned main(void){\n\tint i,ans=0,flag=0;\n\tread(n);read(v);\n\tfor (i=1;i<=n;i++) read(t[i]);t[0]=0;\n\tfor (i=1;i<=n;i++) read(a[i]);a[0]=0;\n\tfor (i=0;i<=n;i++) h[i].x=a[i]+1ll*v*t[i],h[i].y=1ll*v*t[i]-a[i],g[++tot]=h[i].y;\n\tsort(g+1,g+1+tot);tot=unique(g+1,g+1+tot)-g-1;\n\tfor (i=0;i<=n;i++) h[i].id=i,h[i].y=lower_bound(g+1,g+1+tot,h[i].y)-g;\n\tsort(h,h+1+n,cmp);\n    for (i=0;i<=n;i++) {\n    \tdp[i]=tr.query(h[i].y)+1;\n    \tif (h[i].x==0&&g[h[i].y]==0) dp[i]=0,tr.add(h[i].y,dp[i]);\n\t\ttr.add(h[i].y,dp[i]);\n\t\tans=max(ans,dp[i]);\n\t}\n\tprintf(\"%lld \",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1650978367,
        "uid": 51569,
        "name": "\u8fdd\u89c4\u7528\u6237\u540dFkZyA0!2",
        "ccfLevel": 0,
        "title": "CF1662L"
    },
    {
        "content": "\u5c06\u6bcf\u4e00\u4e2a Kick \u770b\u4f5c\u4e8c\u7ef4\u5e73\u9762\u4e0a\u7684\u70b9\u3002\u82e5\u4e00\u4e2a Kick \u5728\u65f6\u95f4 $t$\uff0c\u5728\u4f4d\u7f6e $x$\uff0c\u4eba\u7684\u901f\u5ea6\u4e3a $v$\uff0c\u5219 Kick \u7684\u5750\u6807\u4e3a\n\n$$\n(v\\cdot t,x)\n$$\n\n\u8fd9\u6837\uff0c\u5f53\u4eba\u73b0\u5728\u5728\u5750\u6807 $(x,y)$\uff08\u5f53\u7136\u4eba\u521d\u59cb\u5750\u6807\u4e3a $(0,0)$\uff09\uff0c\u5979\u80fd\u591f\u8d76\u5230\u7684 Kick \u5728\u5979\u7684\u53f3\u4e0a $45^{\\circ}$ \u5230\u53f3\u4e0b  $45^{\\circ}$ \u7684\u534a\u5e73\u9762\u4ea4\u91cc\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/yzfdwk0w.png)\n\n\uff08\u2191\u6837\u4f8b\u4e2d\u7684\u4e09\u4e2a Kick \u5750\u6807\uff09\n\n\u5f53\u7136\uff0c\u8fd9\u6837\u8fd8\u662f\u96be\u4e8e\u8ba1\u7b97\uff0c\u6211\u4eec\u5c06\u6240\u6709\u70b9\u6309\u539f\u70b9\u987a\u65f6\u9488\u65cb\u8f6c $45^{\\circ}$\u3002\u5177\u4f53\u5730\uff0c\u6211\u4eec\u5c06\u6bcf\u4e00\u4e2a\u5750\u6807\n\n$$\n(x,y)\\to (x+y,-x+y)\n$$\n\n\uff08\u8fd9\u6837\u6bcf\u4e2a\u70b9\u5230\u539f\u70b9\u7684\u8ddd\u79bb\u4f1a\u6269\u5927\u81f3\u539f\u6765\u7684 $\\sqrt2$ \u500d\uff0c\u4f46\u662f\u65e0\u4f24\u5927\u96c5\u4e0d\u5f71\u54cd\u8ba1\u7b97\uff09\n\n\u8fd9\u6837\u6bcf\u4e2a\u5e73\u9762\u4e0a\u7684\u70b9\u80fd\u5230\u8fbe\u7684\u533a\u57df\u4e3a\u53f3\u4e0b\u89d2 $90^{\\circ}$ \u7684\u534a\u5e73\u9762\u4ea4\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/04krnyjd.png)\n\n\uff08\u2191\u4e09\u4e2a Kick \u5750\u6807\u8fdb\u884c\u53d8\u6362\uff09\n\n\u6211\u4eec\u5c06 Kick \u6309\u7167\u5f53\u524d\u5750\u6807\u6392\u5e8f\uff0c\u5148\u6309 $x$ \u5347\u5e8f\uff0c\u6b21\u6309 $y$ \u964d\u5e8f\u3002\n\n\u8fd9\u6837\u6392\u5e8f\u5728\u540e\u7684 Kick \u4e0d\u53ef\u80fd\u8d76\u5230\u6392\u5e8f\u5728\u524d\u7684 Kick\uff0c\u6ee1\u8db3\u4e86 DP \u7684**\u65e0\u540e\u6548\u6027**\u3002\n\n\u8bbe $f_i$ \u8868\u793a\u5f53\u524d\u5728\u6392\u5e8f\u540e\u7b2c $i$ \u4e2a Kick \u7684\u4f4d\u7f6e\u4e0a\uff0c\u6700\u591a\u80fd\u770b\u51e0\u4e2a Kick\uff08\u5305\u62ec $i$ \u672c\u8eab\uff09\u3002\n\n\u7136\u540e\u4ece\u540e\u5f80\u524d $n\\to1$ \u679a\u4e3e Kick\uff0c\u5176\n\n$$\nf_i=\\max_{j\\in[i+1,n],y_j\\le y_i}f_j+1\n$$\n\n\u6211\u4eec\u7528 BIT\uff08\u6811\u72b6\u6570\u7ec4\uff09\u7ef4\u62a4\u6bcf\u4e2a $y$\uff0c$f_j(\\text{s.t.}\\ y_j=y)$ \u7684\u6700\u5927\u503c\uff08\u5f53\u7136 $y$ \u5750\u6807\u8981\u79bb\u6563\u5316\uff09\u3002\n\n\u5373\u53ef $O(n\\log n)$ \u6c42\u89e3\u6240\u6709 $f$\u3002\u6700\u540e $O(n)$ \u679a\u4e3e\u7b2c\u4e00\u4e2a\u770b\u7684 Kick \u6c42\u7b54\u6848\u5373\u53ef\u3002 \n\n### Code\n\n```cpp\n//Said no more counting dollars. We'll be counting stars.\n#pragma GCC optimize(\"Ofast\")\n//#pragma GCC optimize(\"unroll-loops\")//DONT use rashly,I have suffered\n//#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,avx2,tune=native\")//DONT use rashly,I have suffered\n#include<bits/stdc++.h>\nusing namespace std;\n#define IOS ios::sync_with_stdio(0);cin.tie(0);cout.tie(0)\n#define fir first\n#define sec second\n#define mkp make_pair\n#define pb emplace_back\n#define mem(x,y) memset(x,y,sizeof(x))\n#define For(i,j,k) for(int i=j;i<=k;i++)\n#define Rof(i,j,k) for(int i=j;i>=k;i--)\n#define Fe(x,y) for(int x=head[y];x;x=e[x].nxt)\n#define ckmx(a,b) a=max(a,b)\n#define ckmn(a,b) a=min(a,b)\n#define fin(s) freopen(s,\"r\",stdin)\n#define fout(s) freopen(s,\"w\",stdout)\n#define file(s) fin(s\".in\");fout(s\".out\")\n#define cerr cerr<<'_'\n#define debug cerr<<\"Passed line #\"<<__LINE__<<endl\ntemplate<typename T>T ov(T x){cerr<<\"Value: \"<<x<<endl;return x;}\n#define ll long long\nconst ll mod=1000000007;\ninline ll pw(ll x,ll y){ll r=1;while(y){if(y&1)r=r*x%mod;x=x*x%mod;y>>=1;}return r;}\ninline void mad(ll &a,ll b){a=(a+b)%mod;while(a<0)a+=mod;}\ninline void mmu(ll &a,ll b){a=a*b%mod;while(a<0)a+=mod;}\n#define inv(a) pw(a,mod-2)\n#define int long long\n#define N 200010\n#define Pos pair<int,int>\n#define low (x&(-x))\nint n,lim,b[N],c[N];\nPos a[N];\nvoid add(int x,int y){\n\twhile(x<=lim){\n\t\tckmx(c[x],y);\n\t\tx+=low;\n\t}\n}\nint que(int x){\n\tint res=0;\n\twhile(x){\n\t\tckmx(res,c[x]);\n\t\tx-=low;\n\t}\n\treturn res;\n}\nbool cmp(Pos x,Pos y){\n\tif(x.fir!=y.fir) return x.fir<y.fir;\n\telse return x.sec>y.sec;\n}\nsigned main(){IOS;\n\tint x,y;\n\tcin>>n>>x;\n\tFor(i,1,n) cin>>a[i].fir;\n\tFor(i,1,n) cin>>a[i].sec;\n\ta[0]=mkp(0,0);\n//\tFor(i,0,n) cout<<i<<\":\"<<a[i].fir<<\" \"<<a[i].sec<<endl; cout<<endl;\n\tFor(i,0,n) a[i].fir*=x;\n\tFor(i,0,n){\n\t\tx=a[i].fir+a[i].sec;\n\t\ty=a[i].sec-a[i].fir;\n\t\ta[i]=mkp(x,y);//rotate 45 clockwise\n\t}\n\tFor(i,0,n) b[i+1]=a[i].sec;\n\tsort(b+1,b+2+n);\n\tlim=unique(b+1,b+2+n)-b-1;\n\tFor(i,0,n) a[i].sec=lower_bound(b+1,b+1+lim,a[i].sec)-b;\n\tint qx=a[0].fir,qy=a[0].sec;\n\tsort(a,a+1+n,cmp);\n\tRof(i,n,0){\n\t\tx=que(a[i].sec);\n\t\tif(a[i].fir==qx && a[i].sec==qy){\n\t\t\tcout<<x<<endl;\n\t\t\treturn 0;\n\t\t}\n\t\tadd(a[i].sec,x+1);\n\t}\nreturn 0;}\n```\n\n",
        "postTime": 1650948412,
        "uid": 101868,
        "name": "I_am_Accepted",
        "ccfLevel": 0,
        "title": "CF1662L Il Derby della Madonnina\uff08\u8f6c\u4e8c\u7ef4\u5e73\u9762\u95ee\u9898\uff09"
    }
]
[
    {
        "content": "~~\uff08\u54c7\uff0c\u5c45\u7136\u6ca1\u6709\u9898\u89e3\uff1f\u8d76\u7d27\u6c34\u4e00\u53d1\uff09~~\n\n\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u6211\u4eec\u9996\u5148\u53ef\u4ee5\u5c06\u4e00\u4e2a\u5b57\u7b26\u4e32\u901a\u8fc7 $b_i$ **\u5212\u5206\u6210\u51e0\u4e2a\u6bb5**\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/39069.png)\n\n\u7136\u540e\u6211\u4eec\u518d\u8003\u8651\u5176\u4ed6\u4e8b\u60c5\u3002\n\n\u9996\u5148\u5bf9\u4e8e\u4efb\u610f $b_i$ \u5230 $b_{i+1}$ \u8fd9\u4e00\u6bb5\uff08\u4e5f\u5305\u62ec\u4ece $0$ \u5230 $b_{i-1}$\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u9009\u62e9 $i$ \u548c $i+1$ \u6765\u5b9e\u73b0\u5c06\u8fd9\u4e00\u6bb5\u4e0e\u53f3\u8fb9\u5bf9\u5e94\u7684\u4e00\u6bb5\u7ffb\u8f6c\u3002\n\n\u5176\u6b21\uff0c\u5bf9\u4e8e $b_m$ \u4ee5\u53ca\u5b83\u4e0e\u4e2d\u70b9\u5bf9\u79f0\u7684\u4f4d\u7f6e\u7ec4\u6210\u7684\u4e00\u6bb5\uff0c\u6211\u4eec\u662f\u65e0\u6cd5\u8fdb\u884c\u7ffb\u8f6c\u7684\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u6bcf\u4e00\u6bb5\u5206\u5f00\u8003\u8651\u3002\n\n\u5bf9\u4e8e\u524d\u9762\u7684\uff08\u8fd9\u91cc\u6307 $i < m$\uff09\u6bcf\u4e00\u6bb5\uff0c\u6211\u4eec\u8bbe $len$ \u4e3a\u8fd9\u4e00\u6bb5\u7684\u957f\u5ea6\uff08\u5373 $b_i-b_{i-1}$\uff09\uff0c\u90a3\u4e48\u8003\u8651\u4e24\u79cd\u60c5\u51b5\uff1a\n\n1.\u5c06\u8fd9\u4e00\u6bb5\u7ffb\u5230\u53f3\u8fb9\u53bb\u6240\u5f97\u5230\u7684\u5b57\u7b26\u4e32\u4e0e\u539f\u4e32\u4e0d\u76f8\u540c\uff0c\u90a3\u4e48\u5bf9\u4e8e\u5de6\u8fb9\u7684\u90e8\u5206\uff0c\u6709 $|A|^{len}$ \u79cd\u53ef\u80fd\uff0c\u800c\u5bf9\u4e8e\u6bcf\u79cd\u53ef\u80fd\uff0c\u53f3\u8fb9\u90fd\u6709 $|A|^{len}-1$ \u79cd\u65b9\u5f0f\u4e0e\u4e4b\u5bf9\u5e94\uff0c\u4f7f\u5f97\u7ffb\u8f6c\u540e\u4e0e\u539f\u4e32\u4e0d\u76f8\u540c\u3002\u56e0\u6b64\uff0c\u8fd9\u79cd\u60c5\u51b5\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5c31\u662f $ \\frac{|A|^{len} * (|A|^{len}-1)}{2}$\uff0c\u5176\u4e2d\u9664\u4ee5 $2$ \u7684\u539f\u56e0\u662f\u56e0\u4e3a\u6211\u4eec\u5c06\u6b63\u53cd\u4e24\u79cd\u60c5\u51b5\u90fd\u7b97\u4e86\u4e00\u904d\uff0c\u800c\u8fd9\u4e24\u79cd\u60c5\u51b5\u5b9e\u9645\u4e0a\u662f\u7b49\u4ef7\u7684\uff08\u6bd4\u5982\u5de6\u8fb9\u662f \"ab\"\u3001\u53f3\u8fb9\u662f \"cd\" \u548c\u5de6\u8fb9\u662f \"dc\"\uff0c\u53f3\u8fb9\u662f \"ba\" \u7684\u60c5\u51b5\uff09\uff1b\n\n2.\u5c06\u8fd9\u4e00\u6bb5\u7ffb\u5230\u53f3\u8fb9\u53bb\u6240\u5f97\u5230\u7684\u5b57\u7b26\u4e32\u4e0e\u539f\u4e32\u76f8\u540c\uff0c\u6613\u77e5\u5bf9\u4e8e\u5de6\u8fb9\u7684 $|A|^{len}$ \u79cd\u53ef\u80fd\uff0c\u53f3\u8fb9\u90fd\u53ea\u6709\u4e00\u79cd\u60c5\u51b5\u4e0e\u4e4b\u5bf9\u5e94\uff0c\u4f7f\u5f97\u7ffb\u8f6c\u540e\u65b0\u4e32\u4e0e\u539f\u4e32\u76f8\u540c\u3002\u90a3\u4e48\u8fd9\u79cd\u60c5\u51b5\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5c31\u662f $|A|^{len}$\u3002\n\n\u7efc\u4e0a\uff0c\u5bf9\u4e8e\u8fd9\u4e24\u79cd\u60c5\u51b5\uff0c\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5c31\u662f $\\frac{|A|^{len} * (|A|^{len}-1)}{2}+|A|^{len}$\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e\u4e2d\u95f4\u7684 $n-2 * b_m$ \u4e2a\u5b57\u7b26\uff0c\u5b83\u4eec\u662f\u65e0\u6cd5\u7ffb\u8f6c\u7684\uff0c\u56e0\u6b64\u5b83\u4eec\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5c31\u662f $|A|^{n-2 * b_m}$\u3002\n\n\u90a3\u4e48\uff0c\u6700\u7ec8\u7b54\u6848\u5c31\u662f\u8bb2\u6bcf\u4e00\u5757\u7684\u8d21\u732e\u4e58\u8d77\u6765\u7684\u5230\u7684\u7ed3\u679c\u3002\n\n~~\uff08\u6211\u8bb2\u7684\u597d\u4e0d\u597d\uff0c\u5feb\u5938\u5938\u6211\uff09~~\n\n## \u8d34\u4ee3\u7801\u5566~~~\n\n```\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#define Mod 998244353\nusing namespace std;\nlong long fpow(long long a,long long b)\n{\n\tlong long ans=1,t=a;\n\twhile(b)\n\t{\n\t\tif(b&1)ans=ans*t%Mod;\n\t\tt=t*t%Mod;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\nint n,m,A;\nint b[200010];\nint main()\n{\n\tscanf(\"%d %d %d\",&n,&m,&A);\n\tfor(int i=1;i<=m;i++)\n\t\tscanf(\"%d\",&b[i]);\n\tlong long ans=1;\n\tfor(int i=1;i<=m;i++)//\u6bcf\u4e2a\u5c0f\u6bb5\u7684\u8d21\u732e\n\t\tans=(ans*((long long)fpow(A,b[i]-b[i-1])\n        +(long long)fpow(A,b[i]-b[i-1])\n        *(fpow(A,b[i]-b[i-1])-1)%Mod\n        *fpow(2,Mod-2)%Mod)%Mod+Mod)%Mod;\n\tans=ans*fpow(A,n-b[m]-b[m])%Mod;//\u4e2d\u95f4\u6bb5\u7684\u8d21\u732e\n\tprintf(\"%I64d\\n\",ans);\n\treturn ~~(0-0);//\u65e5\u5e38\u5356\u840c\n}\n```\n\n~~\uff08~\u6240\u4ee5\u8981\u4e0d\u8981\u70b9\u4e2a\u8d5e\u554a~\uff09~~",
        "postTime": 1540167631,
        "uid": 54475,
        "name": "\u732a\u8111\u5b50",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1065E \u3010Side Transmutations\u3011"
    },
    {
        "content": "[$\\Huge{\\color{#e0a920}{\\tt My~Cnblogs}}$](https://www.cnblogs.com/Wendigo/p/12976171.html)\n\n---\n> [CF1065E Side Transmutations](https://www.luogu.com.cn/problem/CF1065E)\n\n> $n$ \u548c $m$ \u548c $k$ \u548c\u5e8f\u5217 $b_i(1\\le i\\le m,1\\le b_i\\le b_{i+1}\\le \\frac n2)$\u3002\u5bf9\u4e8e\u5b57\u7b26\u4e32 $s$\uff0c\u5982\u679c\u9009\u5176 $b_i$ \u524d\u7f00\u548c $b_i$ \u540e\u7f00\u7ffb\u8f6c\u5e76\u4ea4\u6362\u80fd\u53d8\u6210\u5b57\u7b26\u4e32 $s'$\uff0c\u5219 $s,s'$ \u662f\u76f8\u7b49\u7684\u3002\u6c42\u6709\u591a\u5c11\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5b57\u7b26\u4e32\uff0c\u5b57\u7b26\u96c6\u5927\u5c0f\u4e3a $k$\uff0c\u4e92\u4e0d\u76f8\u7b49\u3002\u7b54\u6848 $\\bmod 998244353$\u3002\n\n> \u6570\u636e\u8303\u56f4\uff1a$2\\le n\\le 10^9$\uff0c$1\\le m\\le \\min(\\frac n2,2\\cdot 10^5)$\uff0c$1\\le k\\le 10^9$\u3002\n\n---\n\u542c\u795e\u4ed9\u8bf4\u8fd9\u662f\u7fa4\u8bba\uff0c\u662f $\\tt Polya$\uff0c\u5c0f\u849f\u84bb\u6ca1\u6709\u542c\u8bf4\u8fc7\uff0c\u4f46\u662f\u624b\u63a8\u51fa\u6765\u8fd9\u9898\u4e86\u3002\n\n\u65e2\u7136**\u849f\u84bb\u5565\u90fd\u4e0d\u4f1a**\uff0c\u90a3\u4e48\u5c31\u6162\u6162\u505a\u8fd9\u9898\u3002\n\n---\n\u628a\u5b57\u7b26\u4e32\u5206\u6210 $2m+1$ \u6bb5\u3002\n\n\u5982 $m=2$ \u5b57\u7b26\u4e32\u5c31\u662f $\\overrightarrow{A}\\overrightarrow{B}\\overrightarrow{C}\\overrightarrow{D}\\overrightarrow{E}$\uff1a\n\n> $\\overrightarrow{S}$ \u6307\u7684\u662f\u4e00\u4e2a\u6709\u987a\u5e8f\u7684\u5b57\u7b26\u4e32\u3002\n\n$\\overrightarrow{A}$ \u8868\u793a $s_{1\\to b_1}$\u3002\n\n$\\overrightarrow{B}$ \u8868\u793a $s_{b_1+1\\to b_2}$\u3002\n\n$\\overrightarrow{C}$ \u8868\u793a $s_{b_2+1\\to n-b_2}$\u3002\n\n$\\overrightarrow{D}$ \u8868\u793a $s_{n-b_2+1\\to n-b_1}$\u3002\n\n$\\overrightarrow{E}$ \u8868\u793a $s_{n-b_1+1\\to n}$\u3002\n\n---\n- **\u89e3\u51b3 $m=1$ \u7684\u60c5\u51b5\uff1a**\n\n$$\\overrightarrow{A}\\overrightarrow{B}\\overrightarrow{C}=\\overleftarrow{C}\\overrightarrow{B}\\overleftarrow{A}$$\n\n\u5982\u679c $\\overrightarrow{A}=\\overleftarrow{C}$\uff1a$k^{n-b_1}$ \u79cd\u3002\n\n\u5982\u679c $\\overrightarrow{A}\\not=\\overleftarrow{C}$\uff1a$(k^n-k^{n-b_1})\\cdot 2^{-1}$ \u79cd\u3002\n\n**\u7b54\u6848\u4e3a $k^{n-b_1}+(k^n-k^{n-b_1})\\cdot 2^{-1}=(k^n+k^{n-b_1})\\cdot 2^{-1}$ \u79cd\u3002**\n\n---\n- **\u89e3\u51b3 $m=2$ \u7684\u60c5\u51b5\uff1a**\n\n$$\\overrightarrow{A}\\overrightarrow{B}\\overrightarrow{C}\\overrightarrow{D}\\overrightarrow{E}=\\overleftarrow{E}\\overrightarrow{B}\\overrightarrow{C}\\overrightarrow{D}\\overleftarrow{A}=\\overrightarrow{A}\\overleftarrow{D}\\overrightarrow{C}\\overleftarrow{B}\\overrightarrow{E}=\\overleftarrow{E}\\overleftarrow{D}\\overrightarrow{C}\\overleftarrow{B}\\overleftarrow{A}$$\n\n\u5982\u679c $\\overrightarrow{A}=\\overleftarrow{E}\\&\\overrightarrow{B}=\\overleftarrow{D}$\uff1a$k^{n-b_2}$ \u79cd\u3002\n\n\u5982\u679c $\\overrightarrow{A}\\not=\\overleftarrow{E}\\&\\overrightarrow{B}=\\overleftarrow{D}$\uff1a$(k^{n-b_2+b_1}-k^{n-b_2})\\cdot 2^{-1}$ \u79cd\u3002\n\n\u5982\u679c $\\overrightarrow{A}=\\overleftarrow{E}\\&\\overrightarrow{B}\\not=\\overleftarrow{D}$\uff1a$(k^{n-b_1}-k^{n-b_2})\\cdot 2^{-1}$ \u79cd\u3002\n\n\u5982\u679c $\\overrightarrow{A}\\not=\\overleftarrow{E}\\&\\overrightarrow{B}\\not=\\overleftarrow{D}$\uff1a$(k^n-k^{n-b_1}-k^{n-b_2+b_1}+k^{n-b_2})\\cdot 2^{-2}$ \u79cd\u3002\n\n**\u7b54\u6848\u4e3a $(k^n+k^{n-b_1}+k^{n-b_2+b_1}+k^{n-b_2})\\cdot 2^{-2}$ \u79cd\u3002**\n\n--- \n**\u5c0f\u849f\u84bb\u4e8e\u662f\u5c31\u53d1\u73b0\u89c4\u5f8b\u4e86\uff1a**\n\n\u4ee4\u96c6\u5408 $st=\\{b_1,b_2-b_1,...,b_m-b_{m-1}\\}$\u3002\n\n$$Ans=2^{-m}\\sum_{sub\\in st}k^{n-\\sum_{x\\in sub}x}$$ \n\n\u770b\u4f3c\u8be1\u5f02\uff0c\u4f46\u662f\u5176\u5b9e\u8fd9\u4e2a\u4e00\u628a\u8fd9\u4e2a\u5f0f\u5b50\u88c2\u5f00\u5c31\u53d1\u73b0\u662f\u53ef\u4ee5\u5408\u5e76\u7684\uff1a\n\n![\u5982\u679c\u56fe\u70b8\u4e86\u5728\u8bc4\u8bba\u533a\u4e2dD\u849f\u84bb](https://i.loli.net/2020/05/28/aDFbRkqwN6VcLS7.jpg)\n\n\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\u3002\u56e0\u4e3a\u8fd8\u8981 $\\bmod 998244353$\uff0c\u6240\u4ee5**\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\Theta(m\\log mod)$**\u3002\n\n---\n- **\u4ee3\u7801**\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n//Start\ntypedef long long ll;\ntypedef double db;\n#define mp(a,b) make_pair(a,b)\n#define x first\n#define y second\n#define b(a) a.begin()\n#define e(a) a.end()\n#define sz(a) int((a).size())\n#define pb(a) push_back(a)\nconst int inf=0x3f3f3f3f;\nconst ll INF=0x3f3f3f3f3f3f3f3f;\n\n//Data\nconst int N=2e5;\nconst int mod=998244353;\nint n,m,k,b[N+7];\n\n//Pow\nint Pow(int a,int x){\n\tif(!a) return 0; int res=1;\n\tfor(;x;a=(ll)a*a%mod,x>>=1)if(x&1) res=(ll)res*a%mod;\n\treturn res;\n}\n\n//Main\nint main(){\n\tscanf(\"%d%d%d\",&n,&m,&k),k%=mod; //\u8fd9\u53e5\u4e0d\u52a0 Wrong on test 11\n\tfor(int i=1;i<=m;i++) scanf(\"%d\",&b[i]);\n\tint res=1;\n\tfor(int i=1;i<=m;i++) res=(ll)res*(Pow(k,b[i]-b[i-1])+1)%mod;\n\tres=(ll)res*Pow(k,n-b[m])%mod;\n\tres=(ll)res*Pow(Pow(2,m),mod-2)%mod;\n\tprintf(\"%d\\n\",res);\n\treturn 0;\n}\n```\n---\n**\u795d\u5927\u5bb6\u5b66\u4e60\u6109\u5feb\uff01**",
        "postTime": 1590646103,
        "uid": 118365,
        "name": "George1123",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1065E \u3010Side Transmutations\u3011"
    },
    {
        "content": "$\\mathcal Desciption:$\n\n$\\quad$ [\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF1065E)\n\n$\\mathcal Solution:$\n\n$\\quad$ \u61a8\u61a8\u9898\uff0c\u4e00\u773c\u5c31\u662f $\\mathrm{Burnside}$ \u88f8\u9898\uff0c\u5e0c\u671b\u7ba1\u7406\u5e2e\u5fd9\u6253\u4e2a $\\mathrm{tag}$ ~~\uff08\u8fd9\u9898\u89e3\u533a\u91cc\u5199\u7684\u90fd\u662f\u5565\uff09~~\u3002\n\n$\\quad$ \u9996\u5148\uff0c\u4e00\u4e2a\u64cd\u4f5c\u4e0d\u53ef\u80fd\u7528\u4e24\u6b21\uff0c\u4e0d\u7136\u5c31\u662f\u767d\u7ed9\u3002\u90a3\u4e48\u663e\u7136\u7f6e\u6362\u7fa4\u7684\u5927\u5c0f\u4e3a $2^m$\uff0c\u4e5f\u5c31\u662f\u6bcf\u4e2a $b$ \u7528\u6216\u8005\u4e0d\u7528\u3002\n\n$\\quad$ \u5bf9\u4e8e\u4e00\u4e2a $y = b$ \u7684\u64cd\u4f5c\uff0c\u5176\u5b9e\u662f\u5bf9\u5e94\u4e8c\u5143\u7ec4\u4f4d\u7f6e\u7684\u4ea4\u6362\uff1a\n\n$$\n(1,n) \\ \\ (2,n-1) \\ \\ (3,n-3) \\ \\  \\cdot\\cdot\\cdot \\ \\ (b,n-b+1) \n$$\n\n$\\quad$ \u5bf9\u4e8e\u5355\u4e2a\u7f6e\u6362\u7684\u4e0d\u52a8\u70b9\u5f88\u597d\u7b97\uff0c\u4f46\u662f\u82e5\u5e72\u7f6e\u6362\u7ec4\u5408\u8d77\u6765\u5c31\u5f88\u5c34\u5c2c\u3002\n\n$\\quad$ \u8fd9\u542f\u53d1\u6211\u4eec\u5bf9 $b$ \u6570\u7ec4\u8fdb\u884c\u5dee\u5206\uff1a$b_i-b_{i-1} \\to b_i$ \u3002\u4e0d\u59a8\u8bb0\u5f55\u4e3a $c$\uff0c\u663e\u7136 $b,c$ \u662f\u7b49\u4ef7\u7684\u7f6e\u6362\u7fa4\u3002\n\n$\\quad$ \u90a3\u4e48\u6700\u540e\u7684\u7b54\u6848\u4e3a\uff1a\n\n$$\nans = \\frac{1}{2^m}\\sum\\limits_{C}t^{n-\\sum c}\n$$\n\n$\\quad$ \u6309\u7167\u4e0a\u9762\u5f0f\u5b50\u5229\u7528\u4e00\u5b9a\u7684\u6280\u5de7\u8ba1\u7b97\u5373\u53ef\u3002\n\n```\n#include <bits/stdc++.h>\nusing namespace std ;\nconst int mod = 998244353,N = 2e5+10 ;\ninline int add(int a,int b){ return a+b >= mod ? a+b-mod : a+b ; }\ninline int sub(int a,int b){ return a >= b ? a-b : a-b+mod ; }\ninline int mul(int a,int b){ return 1ll*a*b%mod ; }\ninline int power(int a,int b){\n\tint res = 1 ;\n\tfor( ; b ; b >>= 1){\n\t\tif(b&1) res = mul(res,a) ;\n\t\ta = mul(a,a) ; \n\t}\n\treturn res ;\n}\nint n,m,t,ans,a[N] ; \nint main(){\n\t//freopen(\"in.txt\",\"r\",stdin) ;\n\tios::sync_with_stdio(false) ; \n\tcin >> n >> m >> t ;\n\tfor(int i = 1 ; i <= m ; i++) cin >> a[i] ;\n\tans = power(t,n-a[m]) ;\n\tfor(int i = m ; i >= 1 ; i--) a[i] -= a[i-1] ;\n\tans = mul(ans,power(power(2,m),mod-2)) ;\n\tfor(int i = 1 ; i <= m ; i++) ans = mul(ans,add(1,power(t,a[i]))) ;\n\tcout << ans << endl ; \n\treturn 0 ; \n}\n```",
        "postTime": 1608105134,
        "uid": 206488,
        "name": "\u849f\u84bbtyy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1065E \u3010Side Transmutations\u3011"
    }
]
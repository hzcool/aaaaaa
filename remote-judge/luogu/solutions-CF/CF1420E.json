[
    {
        "content": "[\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u8d85\u723d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/dysyn1314/p/13729196.html)\n\n## \u9898\u76ee\u5927\u610f\n\n[\u9898\u76ee\u94fe\u63a5](https://codeforces.com/contest/1420/problem/E)\n\n\u6709\u4e00\u6392 $n$ \u4e2a[\u6797\u6a8e\u5b9e]\uff0c\u6709\u4e9b[\u6797\u6a8e\u5b9e]\u62ff\u7740\u76fe\u724c\uff0c\u6709\u4e9b\u6ca1\u6709\u3002\u6211\u4eec\u79f0\u4e00\u5bf9[\u6797\u6a8e\u5b9e]\u662f**\u88ab\u4fdd\u62a4\u7684**\uff0c\u5f53\u4e14\u4ec5\u5f53\u5b83\u4eec\u90fd**\u6ca1\u6709**\u62ff\u76fe\u724c\uff0c\u4e14\u5728\u4ed6\u4eec\u4e4b\u95f4\u6709\u6709\u4eba\u62ff\u7740\u76fe\u724c\u3002\n\n\u4f60\u53ef\u4ee5\u8fdb\u884c\u82e5\u5e72\u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u64cd\u4f5c\u662f\u5982\u4e0b\u4e24\u79cd\u4e4b\u4e00\uff1a\n\n- \u9009\u62e9\u4e00\u4e2a\u62ff\u7740\u76fe\u724c\uff0c\u4e14\u4ed6**\u5de6\u8fb9**\u7684\u4eba\u6ca1\u76fe\u724c\u7684[\u6797\u6a8e\u5b9e] $i$ ($1< i\\leq n$)\uff0c\u5c06\u7b2c $i$ \u4e2a[\u6797\u6a8e\u5b9e]\u7684\u76fe\u724c\u7ed9\u4ed6\u5de6\u8fb9\u7684\u4eba\u3002\n- \u9009\u62e9\u4e00\u4e2a\u62ff\u7740\u76fe\u724c\uff0c\u4e14\u4ed6**\u53f3\u8fb9**\u7684\u4eba\u6ca1\u76fe\u724c\u7684[\u6797\u6a8e\u5b9e] $j$ ($1\\leq j<n$)\uff0c\u5c06\u7b2c $j$ \u4e2a[\u6797\u6a8e\u5b9e]\u7684\u76fe\u724c\u7ed9\u4ed6\u53f3\u8fb9\u7684\u4eba\u3002\n\n\u73b0\u5728\uff0c\u7ed9\u4f60\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684 $01$ \u5e8f\u5217\uff0c\u8868\u793a\u521d\u59cb\u65f6\u6bcf\u4e2a[\u6797\u6a8e\u5b9e]\u662f\u5426\u62ff\u7740\u76fe\u724c\u3002\n\n[\u6797\u6a8e\u5b9e]\u7684\u59b9\u5b50\u968f\u65f6\u4f1a\u8fc7\u6765\u627e\u4ed6\u7ea6\u4f1a\uff0c\u6240\u4ee5\u4ed6\u4e5f\u4e0d\u77e5\u9053\u4ed6\u8fd8\u80fd\u8fdb\u884c\u51e0\u6b21\u64cd\u4f5c\u3002\u56e0\u6b64\uff0c\u5bf9\u4e8e\u6240\u6709 $k\\in[0,\\frac{n(n-1)}{2}]$\uff0c\u8bf7\u7b97\u51fa\u505a**\u4e0d\u8d85\u8fc7** $k$ \u6b21\u64cd\u4f5c\u65f6\uff0c\u6700\u591a\u80fd\u6709\u591a\u5c11\u5bf9\u88ab\u4fdd\u62a4\u7684[\u6797\u6a8e\u5b9e]\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u4f60\u9700\u8981\u8f93\u51fa $\\frac{n(n-1)}{2}$ \u4e2a\u6570\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\leq n\\leq 80$\u3002\n\n## \u672c\u9898\u9898\u89e3\n\n\u8bbe\u6ca1\u62ff\u76fe\u724c\u7684\u70b9\u6570\u91cf\u4e3a $c_0$\uff0c\u62ff\u7740\u76fe\u724c\u7684\u70b9\u6570\u91cf\u4e3a $c_1$\u3002\n\n\u521d\u6b65\u8f6c\u5316 1\uff1a\u8003\u8651\u4e24\u4e2a $0$ **\u4e0d\u662f**\u88ab\u4fdd\u62a4\u7684\uff0c\u5f53\u4e14\u4ec5\u5f53\u5b83\u4eec\u4e4b\u95f4\u6ca1\u6709 $1$\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u88ab\u4fdd\u62a4\u7684\u5bf9\u6570 = \u603b\u5bf9\u6570 - \u5728\u540c\u4e00\u6bb5\u91cc\u7684 $0$ \u7684\u5bf9\u6570\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u8bbe\u6709 $k$ \u6bb5\u6781\u957f\u3001\u8fde\u7eed\u7684 $0$\uff0c\u957f\u5ea6\u5206\u522b\u4e3a $l_1,l_2,\\dots,l_k$\uff0c\u5219\u88ab\u4fdd\u62a4\u7684\u5bf9\u6570 $=\\frac{c_0(c_0-1)}{2}-\\sum_{i=1}^{k}\\frac{l_i(l_i-1)}{2}$\u3002\u4e8e\u662f\u6211\u4eec\u53ea\u8981\u6700\u5c0f\u5316 $\\sum_{i=1}^{k}\\frac{l_i(l_i-1)}{2}$ \u5373\u53ef\u3002\n\n\u521d\u6b65\u8f6c\u5316 2\uff1a\u8003\u8651\u5df2\u77e5\u4e00\u4e2a\u76ee\u6807\u5c40\u9762\uff08\u4e5f\u5c31\u662f\u4e00\u4e2a $01$ \u5e8f\u5217\uff09\uff0c\u90a3\u4e48\u4ece\u521d\u59cb\u5c40\u9762\u5230\u8fd9\u4e2a\u76ee\u6807\u5c40\u9762\u7684\u6700\u5c11\u64cd\u4f5c\u6b21\u6570\uff0c\u663e\u7136\u5c31\u662f\u4e24\u4e2a\u5c40\u9762\u91cc \u7b2c\u4e00\u4e2a $1$\u3001\u7b2c\u4e8c\u4e2a $1$\u3001...\u3001\u7b2c $c_1$ \u4e2a $1$ \u5206\u522b\u7684\u5750\u6807\u5dee\u4e4b\u548c\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u521d\u59cb\u5c40\u9762\u7684\u6bcf\u4e2a $1$ \u548c\u76ee\u6807\u5c40\u9762\u7684\u6bcf\u4e2a $1$\uff0c\u6309\u987a\u5e8f\u4f9d\u6b21\u5bf9\u5e94\uff0c\u53ef\u4ee5\u8bc1\u660e\u8fd9\u6837\u64cd\u4f5c\u662f\u6700\u4f18\u7684\uff08\u8c03\u6574\u6cd5\uff09\u3002\u8bb0\u521d\u59cb\u5c40\u9762\u91cc\u6bcf\u4e2a $1$ \u7684\u4f4d\u7f6e\u5206\u522b\u4e3a $p_1,p_2,\\dots,p_{c_1}$\u3002\n\n\u6709\u4e86\u4e0a\u8ff0\u4e24\u4e2a\u7ed3\u8bba\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 DP \u6765\u786e\u5b9a\u76ee\u6807\u5e8f\u5217\uff0c\u987a\u4fbf\u6c42\u51fa**\u672a\u88ab\u4fdd\u62a4\u7684\u5bf9\u6570**\uff08$\\sum_{i=1}^{k}\\frac{l_i(l_i-1)}{2}$\uff09\u548c**\u64cd\u4f5c\u6b21\u6570**\u3002\n\n\u8bbe $dp[i][x][y][z]$ \u8868\u793a\u8003\u8651\u4e86\u524d $i$ \u4f4d\uff0c\u7528\u4e86 $x$ \u6b21\u64cd\u4f5c\uff0c\u524d $i$ \u4f4d\u91cc\u603b\u5171\u6709 $y$ \u4e2a $1$\uff0c\u4ece\u6700\u540e\u4e00\u4e2a $1$ \u5230 $i$ \u4e4b\u95f4\u8fd9\u6700\u540e\u4e00\u6bb5 $0$ \u7684\u957f\u5ea6\u4e3a $z$\uff0c\u8fd9\u4e2a\u5c40\u9762\u4e0b\u672a\u88ab\u4fdd\u62a4\u7684\u5bf9\u6570\u7684\u6700\u5c0f\u503c\u3002\u8f6c\u79fb\u65f6\u8003\u8651\u7b2c $i+1$ \u4f4d\u662f\u586b $0$ \u8fd8\u662f\u586b $1$ \u5373\u53ef\u3002\u65f6\u95f4\u3001\u7a7a\u95f4\u590d\u6742\u5ea6\u90fd\u662f $O(n^5)$\uff08\u56e0\u4e3a $x$ \u8fd9\u4e00\u7ef4\u5927\u5c0f\u662f $\\frac{n(n-1)}{2}=O(n^2)$ \u7684\uff0c\u4e0d\u8981\u5fd8\u4e86\uff09\u3002\u53ef\u4ee5\u7528\u6eda\u52a8\u6570\u7ec4\u4f18\u5316\u7a7a\u95f4\uff0c\u4e0d\u8fc7\u8fd9\u79cd\u505a\u6cd5\u65f6\u95f4\u3001\u7a7a\u95f4\u5e38\u6570\u90fd\u8f83\u5927\u3002\n\n\u8003\u8651\u7b80\u5316\u72b6\u6001\u5b9a\u4e49\u3002\u8bbe $dp[i][x][y]$ \u8868\u793a\u8003\u8651\u4e86\u524d $i$ \u4f4d\uff0c**\u7b2c $i$ \u4f4d\u4e0a\u586b $1$**\uff0c\u7528\u4e86 $x$ \u6b21\u64cd\u4f5c\uff0c\u524d $i$ \u4f4d\u91cc\u603b\u5171\u6709 $y$ \u4e2a $1$\uff0c\u8fd9\u4e2a\u5c40\u9762\u4e0b\u672a\u88ab\u4fdd\u62a4\u7684\u5bf9\u6570\u7684\u6700\u5c0f\u503c\u3002\u8f6c\u79fb\u65f6\u679a\u4e3e\u4e0b\u4e00\u4e2a $1$ \u5728\u54ea\u91cc\u3002\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u4f9d\u7136\u662f $O(n^5)$\uff0c\u4f46\u7a7a\u95f4\u590d\u6742\u5ea6\u4f18\u5316\u5230\u4e86 $O(n^4)$\u3002\u672c\u505a\u6cd5\u7684 AC \u4ee3\u7801\u8bf7\u89c1\u3010\u53c2\u8003\u4ee3\u78011\u3011\u3002\n\n\u7ee7\u7eed\u4f18\u5316\u3002\u8003\u8651\u5148\u679a\u4e3e $x,y$\uff0c\u518d\u679a\u4e3e $i$\u3002\u6b64\u65f6\u80fd\u8f6c\u79fb\u5230 $dp[i][x][y]$ \u7684\uff0c\u4e00\u5b9a\u662f $x'=x-|p_y -i|$\uff0c$y'=y-1$\u3002\u4e5f\u5c31\u662f\u8bf4 $x'$ \u548c $y'$ \u90fd\u662f\u786e\u5b9a\u7684\uff0c\u6211\u4eec\u53ea\u9700\u8981\u627e\u5230\u6700\u4f18\u7684 $j$ ($j<i$)\uff0c\u7136\u540e\u7528 $dp[j][x'][y']$ \u66f4\u65b0 $dp[i][x][y]$ \u5373\u53ef\u3002$O(n^5)$ \u7684\u505a\u6cd5\u76f8\u5f53\u4e8e\u662f\u679a\u4e3e\u4e86 $j$\u3002\u8003\u8651\u5982\u4f55\u4e0d\u679a\u4e3e\uff0c\u5feb\u901f\u6c42\u51fa\u6700\u4f18\u7684 $j$\u3002\n\n\u5177\u4f53\u6765\u8bf4\uff0c\u6211\u4eec\u5148\u89c2\u5bdf\u4e00\u4e0b\u8f6c\u79fb\u5f0f\uff1a\n$$\ndp[i][x][y] = \\min_{j<i}\\{dp[j][x'][y'] + \\frac{(i - j - 1)(i - j - 2)}{2}\\}\n$$\n\u9996\u5148\u53ef\u4ee5\u53bb\u6389\u201c\u9664\u4ee5 $2$\u201d\uff0c\u5728\u6c42\u7b54\u6848\u7684\u65f6\u5019\u4e00\u8d77\u9664\u3002\u53e6\u5916\uff0c\u56e0\u4e3a $x,y,x',y'$ \u90fd\u662f\u5e38\u6570\uff0c\u4e0d\u59a8\u5c06\u5b83\u4eec\u5199\u5728\u524d\u9762\u3002\u4e8e\u662f\u6211\u4eec\u91cd\u65b0\u5b9a\u4e49\u72b6\u6001\uff1a$f_{x,y}(i) = dp[i][x][y]\\times2$\u3002\u7136\u540e\u628a\u4e0a\u5f0f\u4e2d\u7684 $(i - j - 1)\\cdot (i - j - 2)$ \u62c6\u5f00\uff0c\u5f97\u5230\uff1a\n$$\nf_{x,y}(i) = \\min_{j<i}\\{f_{x',y'}(j)+i^2-3i+j^2+3j-2ij+2\\}\n$$\n\u5176\u4e2d $i^2$, $-3i$, $2$ \u90fd\u662f\u5e38\u6570\uff0c\u53ef\u4ee5\u63d0\u51fa\u6765\u3002\u5173\u952e\u7684\u90e8\u5206\u662f $-2ij$\uff0c\u53ef\u4ee5\u7528**\u659c\u7387\u4f18\u5316**\u641e\u5b9a\u5b83\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u628a\u6bcf\u4e2a $j$ \u770b\u6210\u4e8c\u7ef4\u5e73\u9762\u4e0a\u4e00\u4e2a\u5750\u6807\u4e3a $(j,f_{x',y'}(j)+j^2+3j)$ \u7684\u70b9\uff0c\u8f6c\u79fb\u770b\u6210\u4e00\u6761\u659c\u7387\u4e3a $2i$ \u7684\u76f4\u7ebf\uff0c\u6211\u4eec\u8981\u6700\u5c0f\u5316\u76f4\u7ebf\u7684**\u622a\u8ddd**\uff08\u4e5f\u5c31\u662f $f_{x,y}(i)$ \u52a0\u4e0a\u4e00\u5806\u5173\u4e8e $i$ \u7684\u5e38\u6570\uff09\u3002\u5199\u6210\u5f0f\u5b50\u5c31\u662f\uff1a\n$$\nf_{x',y'}(j)+j^2+3j=2ij+f_{x,y}(i)-i^2+3i-2\n$$\n\u5bf9\u6bcf\u4e2a $(x',y')$ \u5206\u522b\u7ef4\u62a4\u4e00\u4e2a**\u4e0b\u51f8\u58f3**\uff0c\u7136\u540e\u5728\u51f8\u58f3\u4e0a\u4e8c\u5206\u51fa\u7b2c\u4e00\u6bb5\u659c\u7387\u5927\u4e8e $2i$ \u7684\u4f4d\u7f6e\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^4\\log n)$\u3002\u7a7a\u95f4\u590d\u6742\u5ea6 $O(n^4)$\u3002\u672c\u505a\u6cd5\u7684 AC \u4ee3\u7801\u8bf7\u89c1\u3010\u53c2\u8003\u4ee3\u78012\u3011\u3002\n\n## \u53c2\u8003\u4ee3\u7801\n\n\u53c2\u8003\u4ee3\u78011\uff1a\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^5)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $O(n^4)$\u3002\n\n```cpp\n// problem: CF1420E\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb push_back\n#define mk make_pair\n#define lob lower_bound\n#define upb upper_bound\n#define fi first\n#define se second\n#define SZ(x) ((int)(x).size())\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\n\ntemplate<typename T> inline void ckmax(T& x, T y) { x = (y > x ? y : x); }\ntemplate<typename T> inline void ckmin(T& x, T y) { x = (y < x ? y : x); }\n\nconst int MAXN = 80;\nconst int INF = 0x3f3f3f3f;\nint n, a[MAXN + 5], cnt[2], pos[MAXN + 5];\nint total, max_op;\nint dp[MAXN + 5][MAXN * (MAXN - 1) / 2 + 5][MAXN + 5];\nint calc(int len) { return len * (len - 1) / 2; }\n\nint main() {\n\tcin >> n;\n\tfor(int i = 1; i <= n; ++i) {\n\t\tcin >> a[i];\n\t\tcnt[a[i]]++;\n\t\tif(a[i] == 1) {\n\t\t\tpos[cnt[1]] = i;\n\t\t}\n\t}\n\ttotal = calc(cnt[0]);\n\tmax_op = calc(n);\n\tif(!cnt[1]) {\n\t\tfor(int i = 0; i <= max_op; ++i) cout << 0 << \" \"; cout << endl;\n\t\treturn 0;\n\t}\n\t\n\tmemset(dp, 0x3f, sizeof(dp));\n\tfor(int i = 1; i < n; ++i) {\n\t\tdp[i][abs(pos[1] - i)][1] = calc(i - 1);\n\t\tfor(int j = 0; j <= max_op; ++j) {\n\t\t\tfor(int k = 1; k <= i && k < cnt[1]; ++k) if(dp[i][j][k] != INF) {\n\t\t\t\tint rest = cnt[1] - k;\n\t\t\t\tfor(int l = i + 1; l <= n - rest + 1; ++l) {\n\t\t\t\t\tint newj = j + abs(pos[k + 1] - l);\n\t\t\t\t\tif(newj <= max_op)\n\t\t\t\t\t\tckmin(dp[l][newj][k + 1], dp[i][j][k] + calc(l - i - 1));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint res = total;\n\tfor(int j = 0; j <= max_op; ++j) {\n\t\tfor(int i = cnt[1]; i <= n; ++i) if(dp[i][j][cnt[1]] != INF) {\n\t\t\tckmin(res, dp[i][j][cnt[1]] + calc(n - i));\n\t\t}\n\t\tcout << total - res << \" \";\n\t}\n\tcout << endl;\n\treturn 0;\n}\n```\n\n\u53c2\u8003\u4ee3\u78012\uff1a\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^4\\log n)$ \u659c\u7387\u4f18\u5316\u505a\u6cd5\u3002\n\n```cpp\n// problem: CF1420E\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb push_back\n#define mk make_pair\n#define lob lower_bound\n#define upb upper_bound\n#define fi first\n#define se second\n#define SZ(x) ((int)(x).size())\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\n\ntemplate<typename T> inline void ckmax(T& x, T y) { x = (y > x ? y : x); }\ntemplate<typename T> inline void ckmin(T& x, T y) { x = (y < x ? y : x); }\n\nconst int MAXN = 80, MAXOP = MAXN * (MAXN - 1) / 2;\nconst int INF = 0x3f3f3f3f;\nint n, a[MAXN + 5], cnt[2], pos[MAXN + 5];\nint total, max_op;\nint dp[MAXOP + 5][MAXN + 5][MAXN + 5];\nstruct Queue {\n\tint a[MAXN + 5];\n\tint ql, qr;\n\tint size() { return qr - ql + 1; }\n\tbool empty() { return ql > qr; }\n\tint front() { return a[ql]; }\n\tint back() { return a[qr]; }\n\tint back2() { return a[qr - 1]; }\n\tvoid push_back(int e) { a[++qr] = e; }\n\tvoid pop_back() { --qr; }\n\tvoid init() { ql = 1; qr = 0; }\n}que[MAXOP + 5][MAXN + 5];\n\nint calc(int len) { return len * (len - 1) / 2; }\nint calc2(int len) { return len * (len - 1); }\n\nint main() {\n\tcin >> n;\n\tfor(int i = 1; i <= n; ++i) {\n\t\tcin >> a[i];\n\t\tcnt[a[i]]++;\n\t\tif(a[i] == 1) {\n\t\t\tpos[cnt[1]] = i;\n\t\t}\n\t}\n\ttotal = calc(cnt[0]);\n\tmax_op = calc(n);\n\tif(!cnt[1]) {\n\t\tfor(int i = 0; i <= max_op; ++i) cout << 0 << \" \"; cout << endl;\n\t\treturn 0;\n\t}\n\t\n\tmemset(dp, 0x3f, sizeof(dp));\n\tfor(int j = 0; j <= max_op; ++j) {\n\t\tfor(int k = 1; k <= cnt[1]; ++k) {\n\t\t\tque[j][k].init();\n\t\t}\n\t}\n\tfor(int i = 1; i <= n; ++i) {\n\t\t#define Q que[abs(pos[1] - i)][1]\n\t\t#define F dp[abs(pos[1] - i)][1]\n\t\t#define Y(p) (F[(p)] + (p) * (p) + 3 * (p))\n\t\t\n\t\tF[i] = calc2(i - 1);\n\t\twhile(Q.size() >= 2 && (Y(Q.back()) - Y(Q.back2())) * (i - Q.back()) > (Y(i) - Y(Q.back())) * (Q.back() - Q.back2()))\n\t\t\tQ.pop_back();\n\t\tQ.push_back(i);\n\t\t\n\t\t#undef Q\n\t\t#undef F\n\t\t#undef Y\n\t}\n\tfor(int j = 0; j <= max_op; ++j) {\n\t\tfor(int k = 2; k <= cnt[1]; ++k) {\n\t\t\tfor(int i = k; i <= n - (cnt[1] - k); ++i) {\n\t\t\t\tif(j < abs(pos[k] - i)) continue;\n\t\t\t\tint last_j = j - abs(pos[k] - i);\n\t\t\t\t#define Q que[last_j][k - 1]\n\t\t\t\t#define F dp[last_j][k - 1]\n\t\t\t\t#define Y(p) (F[(p)] + (p) * (p) + 3 * (p))\n\t\t\t\tif(Q.empty()) continue;\n\t\t\t\tif(Q.front() >= i) continue;\n\t\t\t\tint l = Q.ql;\n\t\t\t\tint r = Q.qr;\n\t\t\t\twhile(l < r) {\n\t\t\t\t\tint mid = (l + r + 1) >> 1;\n\t\t\t\t\tif(Q.a[mid] < i) {\n\t\t\t\t\t\tl = mid;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tr = mid - 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tl = Q.ql;\n\t\t\t\twhile(l < r) {\n\t\t\t\t\tint mid = (l + r) >> 1;\n\t\t\t\t\tint p1 = Q.a[mid], p2 = Q.a[mid + 1];\n\t\t\t\t\tif(Y(p2) - Y(p1) > 2 * i * (p2 - p1)) {\n\t\t\t\t\t\tr = mid;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tl = mid + 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tckmin(dp[j][k][i], F[Q.a[l]] + calc2(i - Q.a[l] - 1));\n\t\t\t\t#undef Q\n\t\t\t\t#undef F\n\t\t\t\t\n\t\t\t\t#define Q que[j][k]\n\t\t\t\t#define F dp[j][k]\n\t\t\t\twhile(Q.size() >= 2 && (Y(Q.back()) - Y(Q.back2())) * (i - Q.back()) > (Y(i) - Y(Q.back())) * (Q.back() - Q.back2()))\n\t\t\t\t\tQ.pop_back();\n\t\t\t\tQ.push_back(i);\n\t\t\t\t\n\t\t\t\t#undef Q\n\t\t\t\t#undef F\n\t\t\t\t#undef Y\n\t\t\t}\n\t\t}\n\t}\n\tint res = total;\n\tfor(int j = 0; j <= max_op; ++j) {\n\t\tfor(int i = cnt[1]; i <= n; ++i) if(dp[j][cnt[1]][i] != INF) {\n\t\t\tckmin(res, (dp[j][cnt[1]][i] + calc2(n - i)) / 2);\n\t\t}\n\t\tcout << total - res << \" \";\n\t}\n\tcout << endl;\n\treturn 0;\n}\n```\n\n\n# \u521b\u4f5c\u4e0d\u6613\uff0c\u70b9\u4e2a\u8d5e\u5427\uff01\n\n\n\n\n",
        "postTime": 1601102940,
        "uid": 100674,
        "name": "duyi",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1420E \u3010Battle Lemmings\u3011"
    },
    {
        "content": "### \u9898\u610f\n\n\u7565\u3002\n\n$\\texttt{Data Range:}1\\leq n\\leq 80$\n\n### \u9898\u89e3\n\n[\u4e0d\u4e00\u5b9a\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/Karry5307/p/13766422.html)\n\n\u9996\u5148\u8003\u8651\u521d\u59cb\u72b6\u6001\u600e\u4e48\u7b97\u7b54\u6848\u3002\u5f88\u660e\u663e\u76f4\u63a5\u6570\u6ee1\u8db3\u7684\u4e0d\u597d\u6570\uff0c\u7528\u603b\u7684\u51cf\u53bb\u4e0d\u6ee1\u8db3\u7684\u8fd8\u6bd4\u8f83\u597d\u505a\u3002\u6ce8\u610f\u5230\u6240\u6709\u4e0d\u6ee1\u8db3\u7684\u662f\u4e00\u6bb5 $0$\uff0c\u6240\u4ee5\u5c31\u6ca1\u4e86\u3002\n\n\u7136\u540e\u8003\u8651\u600e\u4e48\u7b97\u4ece\u4e00\u4e2a\u521d\u59cb\u72b6\u6001\u8f6c\u79fb\u5230\u4e00\u4e2a\u76ee\u6807\u72b6\u6001\u7684\u6b65\u6570\u3002\u8003\u8651\u90bb\u9879\u4ea4\u6362\uff0c\u53d1\u73b0\u80af\u5b9a\u662f\u8d2a\u5fc3\u5339\u914d\u6700\u4f18\u3002\n\n\u6240\u4ee5\u8bf4\u5982\u679c\u6709\u4e00\u4e2a\u76ee\u6807\u5e8f\u5217\u7684\u8bdd\u90a3\u4e48\u5c31\u53ef\u4ee5\u7b97\u51fa\u521d\u59cb\u5e8f\u5217\u5230\u8fd9\u4e2a\u5e8f\u5217\u7684\u6b65\u6570\u548c\u8fd9\u4e2a\u5e8f\u5217\u7684\u7b54\u6848\uff0c\u4e8e\u662f\u5c31\u53ef\u4ee5\u76f4\u63a5 DP \u76ee\u6807\u5e8f\u5217\u3002\uff08\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec DP \u672a\u88ab\u4fdd\u62a4\u7684\u5bf9\u6570\u7684\u6700\u5c0f\u503c\uff09\n\n\u8bbe $f_{i,j,k}$ \u8868\u793a\u5f53\u524d\u8003\u8651\u5230\u7b2c $i$ \u4f4d\u5e76\u4e14\u94a6\u5b9a\u8fd9\u4e00\u4f4d\u586b $1$\uff0c\u79fb\u52a8\u4e86 $j$ \u6b21\u5e76\u4e14\u8fd9\u4e00\u6bb5\u524d\u7f00\u4e2d\u6709 $k$ \u4e2a $1$ \u65f6\u672a\u88ab\u4fdd\u62a4\u5bf9\u6570\u7684\u6700\u5c0f\u503c\u3002\u5b9e\u9645\u4e0a\u8f6c\u79fb\u7684\u8bdd\u8003\u8651\u679a\u4e3e\u4e0b\u4e00\u4e2a $1$ \u5728\u54ea\u91cc\uff0c\u8fd9\u4e2a\u65f6\u5019\u53ef\u4ee5\u7b97\u51fa\u4e2d\u95f4\u4e00\u6bb5 $0$ \u5bf9\u7b54\u6848\u7684\u8d21\u732e\u548c\u9700\u8981\u79fb\u52a8\u7684\u6b65\u6570\uff0c\u5c31\u80fd\u591f\u8f6c\u79fb\u4e86\u3002\n\n\u6700\u540e\u5904\u7406\u7684\u65f6\u5019\u679a\u4e3e\u4e00\u4e0b\u6700\u7ec8\u5e8f\u5217\u4e2d\u6700\u540e\u4e00\u4e2a $1$ \u586b\u7684\u54ea\u91cc\u5c31\u597d\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^5)$\u3002\u7531\u4e8e\u6211\u6bd4\u8f83\u83dc\u6240\u4ee5\u4e0d\u4f1a\u659c\u7387\u4f18\u5316\u505a\u6cd5\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef int ll;\ntypedef long long int li;\nconst ll MAXN=85;\nll n,tot,res,m,r,c;\nll x[MAXN],cnt[2],pos[MAXN],f[MAXN][MAXN*MAXN][MAXN];\ninline ll read()\n{\n    register ll num=0,neg=1;\n    register char ch=getchar();\n    while(!isdigit(ch)&&ch!='-')\n    {\n        ch=getchar();\n    }\n    if(ch=='-')\n    {\n        neg=-1;\n        ch=getchar();\n    }\n    while(isdigit(ch))\n    {\n        num=(num<<3)+(num<<1)+(ch-'0');\n        ch=getchar();\n    }\n    return num*neg;\n}\ninline void chkmin(ll &x,ll y)\n{\n\tx=x<y?x:y;\n}\ninline ll binom(ll n)\n{\n\treturn n*(n-1)/2;\n}\nint main()\n{\n\tm=binom(n=read());\n\tfor(register int i=1;i<=n;i++)\n\t{\n\t\tcnt[x[i]=read()]++;\n\t\tx[i]?pos[cnt[1]]=i:1;\n\t}\n\tif(!cnt[0])\n\t{\n\t\tfor(register int i=0;i<=m;i++)\n\t\t{\n\t\t\tprintf(\"%d \",0);\n\t\t}\n\t\treturn 0;\n\t}\n\tres=tot=binom(cnt[0]),memset(f,0x3f,sizeof(f));\n\tfor(register int i=1;i<=n;i++)\n\t{\n\t\tf[i][abs(pos[1]-i)][1]=binom(i-1);\n\t\tfor(register int j=0;j<=m;j++)\n\t\t{\n\t\t\tfor(register int k=1;k<=i&&k<cnt[1];k++)\n\t\t\t{\n\t\t\t\tr=cnt[1]-k;\n\t\t\t\tif(f[i][j][k]!=0x3f3f3f3f)\n\t\t\t\t{\n\t\t\t\t\tfor(register int l=i+1;l<=n-r+1;l++)\n\t\t\t\t\t{\n\t\t\t\t\t\tc=j+abs(pos[k+1]-l);\n\t\t\t\t\t\tif(c<=m)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tchkmin(f[l][c][k+1],f[i][j][k]+binom(l-i-1));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor(register int j=0;j<=binom(n);j++)\n\t{\n\t\tfor(register int i=cnt[1];i<=n;i++)\n\t\t{\n\t\t\tif(f[i][j][cnt[1]]!=0x3f3f3f3f)\n\t\t\t{\n\t\t\t\tchkmin(res,f[i][j][cnt[1]]+binom(n-i));\n\t\t\t}\n\t\t}\n\t\tprintf(\"%d \",tot-res);\n\t}\n}\n```",
        "postTime": 1601462181,
        "uid": 60990,
        "name": "Karry5307",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1420E \u3010Battle Lemmings\u3011"
    },
    {
        "content": "#### [\u53ef\u80fd\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/tommy0103/p/13744726.html)\n\n\u62ff\u5230\u8fd9\u9053\u9898\uff0c\u8003\u8651\u5148\u7b80\u5316\u95ee\u9898\uff0c\u6211\u4eec\u53d1\u73b0\u53ef\u4ee5\u628a $0/1$ \u4e32\u7f29\u6210\u4e00\u4e2a\u6570\u5217 $a$ \uff0c$a_i$ \u8868\u793a\u7b2c $i$ \u4e2a $1$ \u4e0e\u7b2c $i-1$ \u4e2a $1$ \u6709 $a_i$ \u4e2a $0$\uff0c\u8bb0\u5e8f\u5217 $a$ \u7684\u957f\u5ea6\u4e3a $m$\u3002\n\n\u90a3\u4e48\u79fb\u52a8\u76fe\u724c\u8fd9\u4e00\u64cd\u4f5c\u5c31\u53d8\u4e3a\u5c06 $a_x$ \u52a0 $1$\uff0c$a_{x+1}$ \u51cf $1$ \u6216\u662f\u5c06 $a_x$ \u51cf $1$ \uff0c$a_{x+1}$ \u52a0 $1$\u3002\u800c $ans=\\sum\\limits_{i=1}^m\\sum\\limits_{j=i+1}^m a_ia_j=\\frac{1}{2}\\left(\\sum\\limits_{i=1}^m\\sum\\limits_{j=1}^ma_ia_j-\\sum\\limits_{i=1}^ma_i^2\\right)$\u3002\u4e8e\u662f\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa\u8fdb\u884c\u4e86 $i$ \u6b21\u64cd\u4f5c\u540e\uff0c$\\min \\left\\{\\sum\\limits_{i=1}^ma_i^2\\right\\}$ \u7684\u503c\u5373\u53ef\u3002\n\n\u8fd9\u4e2a\u503c\u663e\u7136\u65e0\u6cd5\u8d2a\u5fc3\u6c42\u51fa\uff0c\u4e8e\u662f\u8003\u8651 $\\text{DP}$\u3002\u8bbe $f_{i,j,k}$ \u4e3a\u5e8f\u5217\u4e2d\u524d $i$ \u4e2a\u6570\uff0c\u8fdb\u884c\u4e86 $k$ \u6b21\u64cd\u4f5c\u540e\uff0c\u5f53\u524d $\\sum\\limits_{x=1}^ia_x=j$\uff0c\u6240\u80fd\u591f\u5f97\u5230\u7684 $\\min\\left\\{\\sum\\limits_{x=1}^i a_x^2\\right\\}$\u3002\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u9884\u5904\u7406\u51fa $s_i=\\sum\\limits_{j=1}^ia_j$\u3002\n\n\u4e8e\u662f\u6709\u8f6c\u79fb\u5f0f\uff1a\n\n$$\nf_{i+1,l,|l-s_{i+1}|+k}=\\min\\{f_{i,j,k}+(l-j)^2\\}\n$$\n\n\u6b64\u5904\u8f6c\u79fb\u5f0f\u7684 $|l-s_{i+1}|+k$\uff0c\u5176\u5b9e\u662f\u4e00\u4e2a\u7ed3\u8bba\uff1a\u5bf9\u4e8e\u4e24\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217 $a,b$\uff0c\u53ef\u4ee5\u5bf9\u5e8f\u5217 $a$ \u7684\u76f8\u90bb\u4e24\u6570 $+1,-1$\uff0c\u7ecf\u8fc7\u64cd\u4f5c\u7531 $a$ \u5f97\u5230\u5e8f\u5217 $b$ \u7684\u6700\u5c0f\u64cd\u4f5c\u6570\u4e3a $\\sum_{i=1}^n \\left|\\sum\\limits_{j=1}^i a_j-\\sum\\limits_{j=1}^i b_j\\right|$\u3002\u524d\u63d0\u662f\u5e8f\u5217 $a$ \u7ecf\u8fc7\u64cd\u4f5c\u80fd\u591f\u5f97\u5230\u5e8f\u5217 $b$ \uff0c\u4e5f\u5c31\u662f $\\sum_ia_i=\\sum_i b_i$\u3002\u611f\u6027\u7406\u89e3\u8fd9\u4e2a\u7ed3\u8bba\u662f\u975e\u5e38\u5bb9\u6613\u7684\uff0c\u5bf9\u5f53\u524d\u6570 $a_i$ \u8fdb\u884c\u64cd\u4f5c\u5c06\u5b83\u53d8\u4e3a $b_i$\uff0c\u4f1a\u5bf9\u4ee5\u540e\u7684\u6570\u4ea7\u751f\u5f71\u54cd\uff1a\u5982\u679c\u5bf9 $a_i$ \u52a0\uff0c\u5c31\u662f\u5bf9 $a_{i+1}$ \u51cf\uff1b\u5982\u679c\u5bf9 $a_i$ \u51cf\uff0c\u5c31\u662f\u5bf9 $a_{i+1}$ \u52a0\u3002\u800c\u8f6c\u79fb\u5f0f\u4e2d\u7684 $|l-s_{i+1}|+k$ \u5176\u5b9e\u5c31\u662f $\\left|\\sum\\limits_{j=1}^i a_j-\\sum\\limits_{j=1}^i b_j\\right|$ \u7684\u4f53\u73b0\u3002\n\n\u6b64\u5904\u9644\u4e0a\u4e00\u6bb5\u66f4\u4e3a\u4e25\u8c28\u7684\u8bc1\u660e\uff1a\n\n> \u53ef\u4ee5\u770b\u4f5c\u6bcf\u4e2a\u4f4d\u7f6e\u6709\u4e00\u4e2a\u4e1c\u897f\uff0c\u521d\u59cb\u65f6 $a_i<b_i$ \u8fd9\u4e2a\u4f4d\u7f6e\u4e0a\u662f\u8d1f\u503c\uff0c$a_i>b_i$ \uff0c\u8fd9\u4e2a\u4f4d\u7f6e\u4e0a\u662f\u6b63\u503c\uff0c\u6bcf\u6b21\u53ef\u4ee5\u628a\u4e00\u4e2a\u6b63\u7684\u79fb\u52a8\u4e00\u4e0b\uff0c\u90a3\u5c31\u662f\u6309\u987a\u5e8f\u5339\u914d\u4e00\u4e0b\uff0c\u8003\u8651\u6bcf\u6761\u8fb9\u7684\u8d21\u732e\u5c31\u662f\u524d\u7f00\u548c\u7684\u7edd\u5bf9\u503c\u4e4b\u548c \u2014\u2014myh \u795e\u4ed9\n\n\u8fd9\u6837\u76f4\u63a5\u679a\u4e3e\u6bcf\u4e2a\u91cf\u5237\u8868\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n^5)$ \u7684\uff0c\u7136\u800c\u7531\u4e8e $j$ \u8fd9\u4e00\u7ef4\u7684\u7279\u6b8a\u6027\uff0c\u6709\u6548\u7684 $j$ \u5f88\u5c11\uff0c\u6240\u4ee5\u5b9e\u9645\u65f6\u95f4\u590d\u6742\u5ea6\u8fdc\u4f4e\u4e8e $O(n^5)$\u3002\u5f53\u7136\uff0c\u4f60\u4e5f\u53ef\u4ee5\u9009\u62e9\u5bf9\u8fd9\u4e2a\u65b9\u7a0b\u8fdb\u884c\u659c\u7387\u4f18\u5316\uff0c\u53ef\u4ee5\u505a\u5230\u7a33\u5b9a\u7684 $O(n^4 \\log n)$\u3002\n\n**Show the Code**\n```cpp\n#include<cstdio>\n#include<cstring>\nconst int inf=0x3f3f3f3f;\nint a[85],b[85],s[85],f[85][85][3205];\ninline int read() {\n\tregister int x=0,f=1;register char s=getchar();\n\twhile(s>'9'||s<'0') {if(s=='-') f=-1;s=getchar();}\n\twhile(s>='0'&&s<='9') {x=x*10+s-'0';s=getchar();}\n\treturn x*f;\n}\ninline int min(const int &x,const int &y) {return x<y? x:y;}\ninline int max(const int &x,const int &y) {return x>y? x:y;}\ninline int abs(const int &x) {return x<0? -x:x;}\nint main() {\n\tint n=read(),m=1,sum=0;\n\tfor(register int i=1;i<=n;++i) a[i]=read();\n\tfor(register int i=1;i<=n;++i) {if(a[i]==0) ++b[m]; else ++m;}\n\tfor(register int i=1;i<=m;++i) {s[i]=s[i-1]+b[i];}\n\tmemset(f,0x3f,sizeof(f)); f[0][0][0]=0;\n\tfor(register int i=0;i<m;++i) {\n\t\tfor(register int j=0;j<=s[m];++j) {\n\t\t\tfor(register int k=0;k<=n*(n-1)/2;++k) {\n\t\t\t\tif(f[i][j][k]==inf) continue;\n\t\t\t\tfor(register int x=j;x<=s[m];++x) {\n\t\t\t\t\tif(k+abs(x-s[i+1])>n*(n-1)/2) continue;\n\t\t\t\t\tint &tmp=f[i+1][x][k+abs(x-s[i+1])];\n\t\t\t\t\ttmp=min(tmp,f[i][j][k]+(x-j)*(x-j));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\t\n\tint mn=inf;\n\tfor(register int i=0;i<=n*(n-1)/2;++i) {mn=min(mn,f[m][s[m]][i]);printf(\"%d \",(s[m]*s[m]-mn)>>1);}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1601276456,
        "uid": 95244,
        "name": "tommymio",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF1420E \u3010Battle Lemmings\u3011"
    },
    {
        "content": "\u6bd4\u8d5b\u7684\u65f6\u5019\u5207\u4e86\u8fd9\u9053\u9898\uff0c\u4f46\u662f\u4ee3\u7801\u597d\u50cf\u5199\u7684\u6709\u70b9\u4ed3\u4fc3\uff0c\u540e\u6765\u91cd\u65b0\u4fee\u4e86\u4e00\u4e0b\u3002\n\n\u8bb2\u4e0b\u505a\u8fd9\u9898\u7684\u5386\u7a0b\u5427\n\n\u62ff\u9053\u8fd9\u9053\u9898\u6700\u521d\u7684\u601d\u60f3\u662f\u611f\u89c9\u82b1\u7684\u6b65\u6570\u4e0d\u4f1a\u592a\u591a\uff0c\u7136\u540e\u5230\u6700\u4f18\u7684\u65f6\u5019\u6211\u4eec\u53d8\u5316\u7684dat\u4f1a\u8d8a\u6765\u8d8a\u5c0f\uff0c\u611f\u89c9\u53ef\u4ee5\u7528\u4e2abfs\u6765\u6a21\u62df\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u7136\u540e\u6211\u4eec\u53ea\u9700\u8981\u8bb0\u5f55\u6700\u4f18\u7684\u5c31\u53ef\u4ee5\u4e86\uff0c\u7136\u540e\u82b1\u4e8620min\u5199\u4e86\u4e2abfs\uff0c\u53d1\u73b0\u8dd1\u7684\u5f88\u6162\uff0c\u4f46\u662f\u8fd9\u4e2a\u4ee3\u7801\u6709\u52a9\u4e8e\u6211\u4eec\u540e\u9762\u6d4b\u8bd5\u5c0f\u6570\u636e\u7684\u8c03\u8bd5\u3002\n\n\u4e8e\u662f\u770b\u523080\u7684\u8303\u56f4\uff0c\u89c9\u5f97\u8fd8\u662f\u53ef\u4ee5\u6709\u4e9b\u5176\u4ed6\u7684\u505a\u6cd5\u7684\uff0c\u5199\u4e86\u4e2a\u611f\u89c9\u590d\u6742\u5ea6\u4e0d\u5bf9\u7684dp\uff0c\u60f3\u7740\u5148\u5199\u4e2a\u66b4\u529b\uff0c\u7136\u540e\u7528\u4e00\u4e9b\u7c7b\u4f3c\u4e8e\u5355\u8c03\u6027\u6216\u8005\u659c\u7387\u4f18\u5316\u7684\u65b9\u6cd5\u4f18\u5316\u4e00\u4e0b\uff0c\u4f46\u662f\u540e\u6765\u52a0\u4e86\u51e0\u4e2a\u526a\u679d\uff0c\u7136\u540e\u8dd1\u4e86\u4e0b\u6781\u9650\u6570\u636e\uff0c\u53d1\u73b0\u98de\u5feb\uff0c\u4e8e\u662f\u5c31\u80fd\u8fc7\u8fd9\u9898\u4e86\uff0c\u5927\u6982\u4e00\u5171\u82b1\u4e8645min\u3002\n\n\u6765\u8bb2\u4e0b\u600e\u4e48dp\uff1a\n\n\u6211\u4eec\u5c31\u5047\u8bbev\u662f\u9898\u76ee\u4e2d\u8981\u6c42\u7684\u5bf9\u6570\uff0c\u65b9\u4fbf\u540e\u9762\u7684\u8868\u8ff0\u3002\n\n\u9996\u5148\u6211\u4eec\u8bb0\u5f55dp[i][j][k]\u4ee3\u8868\u5f53\u524ddp\u5230\u7b2ci\u4e3a\uff0c\u7136\u540e\u9009\u4e86j\u4e2a1\uff0c\u5f53\u524d\u79fb\u52a8\u4e86k\u6b65\u7684\u80fd\u4f7f\u9898\u76ee\u4e2d\u8981\u6c42\u7684v\u7684max\u503c\n\n\u7136\u540e\u7531\u4e8e\u6211\u4eec\u53d1\u73b01\u662f\u4e0d\u80fd\u4ea4\u53c9\u79fb\u52a8\u7684\uff0c\u6211\u4eec\u5f88\u5feb\u7684\u7b97\u51fa\u9700\u8981\u79fb\u52a8\u7684\u6b21\u6570\uff0c\u5c31\u662f\u6211\u4eec\u628atot\u4e2a1\u4e00\u4e00\u5bf9\u5e94\uff0c\u7136\u540e\u7b97\u4e00\u4e0b\u7edd\u5bf9\u503c\u3002\n\n\u56e0\u4e3a\u6211\u4eec\u5df2\u7ecf\u8bb0\u5f55\u4e86\u5f53\u524d\u9009\u5230\u7b2cj\u4e2a1\uff0c\u6240\u4ee5\u8fd9\u90e8\u5206\u7684\u8f6c\u79fb\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u7b97\u51fa\uff0c\u8f6c\u79fb\u4e86\u4ee5\u540e\u6211\u4eec\u53d1\u73b0\u8f6c\u79fb\u4e4b\u95f4\u7684v\u4f1a\u53d1\u751f\u4ec0\u4e48\u7684\u53d8\u5316?\n\n\u6211\u4eec\u8003\u8651\u7b97\u8d21\u732e\uff0c\u5c31\u662f\u5f53\u524ddp\u5230\u7b2cj\u4e2a1\u7684\u8d21\u732e\uff0c\u6211\u4eec\u7b97\u4e0b\u5de6\u53f3\u76840\u4e2a\u4e2a\u6570\u76f8\u4e58\u5c31\u53ef\u4ee5\uff0c\u8fd9\u4e2a\u56e0\u4e3a\u6211\u4eec\u76841\u7684\u4e2a\u6570\u5df2\u7ecf\u6709\u4e86\uff0c0\u7684\u4e2a\u6570\u51cf\u4e00\u4e0b\u4e5f\u77e5\u9053\u4e86\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u6210\u529f\u5904\u7406\u4e86\u8f6c\u79fb\u7684\u65b9\u5f0f\uff0c\u4ee5\u53ca\u8f6c\u79fb\u4e4b\u95f4\u7684v\u5982\u4f55\u8f6c\u79fb\u3002\n\n\u6700\u540e\u6211\u4eec\u66f4\u65b0\u7b54\u6848\u7684\u65f6\u5019\u53d6\u4e2a\u524d\u7f00\u7684max\u3002\n\n\u8fd9\u4e2adp\u7684\u72b6\u6001\u662fO(n^4)\u7684\uff0c\u6211\u4eec\u56e0\u4e3a\u524d\u4e24\u7ef4i,j\u662fO(n)\uff0c\u7136\u540e\u6700\u540e\u4e00\u7ef4\u7684\u8ddd\u79bb\u662fO(n^2)\u7684\uff0c\u4f46\u662f\u6211\u4eec\u8f6c\u79fb\u8fd8\u8981\u679a\u4e3e\uff0c\u6240\u4ee5\u4e5f\u662fO(n)\u7684\uff0c\u603b\u590d\u6742\u5ea6\u7406\u8bba\u662fO(n^5)\uff0c\u6700\u574f\u60c5\u51b5\u4e0b\u7684\u3002\n\n\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u4e25\u91cd\u8dd1\u4e0d\u6ee1\uff0c\u6211\u4eec\u5f53\u4e14\u4ec5\u5f53\u8fd9\u4e2a\u72b6\u6001\u51fa\u73b0\u624d\u4f1a\u5f80\u4e0b\u8f6c\u79fb\uff0c\u5e76\u4e14\u672c\u6765dp\u7684\u72b6\u6001\u5c31\u4f1a\u6709\u5f88\u591a\u8ddd\u79bb\u662f\u4e0d\u53ef\u80fd\u51fa\u73b0\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u6d4b\u4e00\u4e0b\u6781\u9650\u6570\u636e\uff08\u51680\uff0c\u51681\uff0c\u4e00\u534a0\u4e00\u534a1\uff09\uff0c\u975e\u5e38\u5feb\uff0c\u5b9e\u9645\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5e94\u8be5\u8fd8\u6ca1\u6709O(n^4)\uff0c\u6240\u4ee5O(~~\u7384\u5b66->\u80fd\u8fc7~~) \n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define LL long long\nusing namespace std;\nconst int N=85,S=4e3+5;\nint n,a[N],lv[N],tot,dp[N][N][S],ans;\nvoid rel(int &x,int y){x=x>y?x:y;}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%d\",&a[i]);\n\t\tif(a[i])tot++,lv[tot]=i;\n\t}\n\tmemset(dp,-0x3f,sizeof(dp));\n\tdp[0][0][0]=0;\n\tfor(int i=0,lim;i<n;i++){\n\t\tlim=min(i,tot-1);\n\t\tfor(int j=0;j<=lim;j++)for(int k=0;k<S;k++)if(dp[i][j][k]>=0){\n\t\t\tfor(int p=i+1;p<=n;p++)rel(dp[p][j+1][k+abs(p-lv[j+1])],dp[i][j][k]+(i-j)*(p-i-1));\n\t\t}\n\t}\n\tint len=(n*(n-1))>>1;\n\tfor(int t=0;t<=len;t++){\n\t\tfor(int i=1;i<=n;i++)rel(ans,dp[i][tot][t]+(i-tot)*(n-i));\n\t\tprintf(\"%d%c\",ans,\" \\n\"[t==len]);\n\t}\n\treturn 0;\n}\n```\n\n\n",
        "postTime": 1601093320,
        "uid": 203968,
        "name": "ConorGallagher23",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1420E \u3010Battle Lemmings\u3011"
    },
    {
        "content": "\u53ef\u4ee5\u5148\u8003\u8651\u4e00\u4e0b\u5982\u4f55\u7b80\u5316\u95ee\u9898\u3002\n\n---\n\n\u9996\u5148\u53ef\u4ee5\u7b80\u5316\u4e00\u4e0b\u9898\u76ee\u4e2d\u7684 01 \u4e32\u3002\n\n\u53d1\u73b0\u8fde\u7eed\u7684 0 \u5bf9\u7b54\u6848\u7684\u8d21\u732e\u53ef\u4ee5\u7528\u4e58\u79ef\u8ba1\u7b97\uff08\u5982`100101`\u8d21\u732e\u5c31\u662f $2\\times 1=2$\uff09\uff0c\u6240\u4ee5\u7528\u8fde\u7eed 0 \u7684\u4e2a\u6570\u6765\u8868\u793a\u6574\u4e2a\u5e8f\u5217\uff08\u5982`100101`\u8868\u793a\u4e3a $\\{0,2,1,0\\}$\uff09\uff08\u65b0\u8868\u793a\u6cd5\u5143\u7d20\u4e2a\u6570\u4e3a\u539f\u5e8f\u5217 1 \u7684\u4e2a\u6570\u52a0\u4e00\uff09\u3002\u4e8e\u662f\u6574\u4e2a\u5e8f\u5217\u7684\u8d21\u732e\u5c31\u53ef\u4ee5\u7528 \u4efb\u610f\u4e24\u4e2a\u6570\u4e58\u79ef \u7684\u548c\u6765\u8868\u793a\u3002\n\n---\n\n\u6539\u53d8\u4e86\u8868\u793a\u6cd5\uff0c\u518d\u8003\u8651\u5728\u4e00\u6b21\u64cd\u4f5c\u8fc7\u540e\u4f1a\u5bf9\u65b0\u7684\u8868\u793a\u6cd5\u5e8f\u5217\u9020\u6210\u4ec0\u4e48\u5f71\u54cd\u3002\n\n\u5982`100101`\u4ea4\u6362\u7b2c\u4e00\u4e2a 1 \u548c\u7b2c\u4e00\u4e2a 0\uff0c\u6210\u4e3a`010101`\uff0c\u8868\u793a\u6cd5\u53d8\u4e3a $\\{1,1,1,0\\}$\u3002\u5176\u6539\u53d8\u5c31\u662f\u5728\u76f8\u90bb\u4e24\u4e2a\u5143\u7d20\u505a\u66f4\u6539\uff0c\u4e00\u4e2a\u52a0\u4e00\uff0c\u4e00\u4e2a\u51cf\u4e00\u3002\n\n\u8bbe $S$ \u4e3a\u8f6c\u5316\u540e\u7684\u5e8f\u5217\uff0c\u5143\u7d20\u4e3a $s_i$\uff0c\u5143\u7d20\u4e2a\u6570 $k$\uff0c\u7b54\u6848 $ans$ \u4e3a\uff1a\n$$\n\\begin{aligned}\nans&=\\sum_{i=1}^k\\sum_{j=1}^{i-1}s_is_j \\\\\n&=\\frac12\\left(\\sum_{i=1}^k\\sum_{j=1}^ks_is_j[i\\neq j]\\right)\\\\\n&=\\frac12\\left(\\sum_{i=1}^ks_i\\sum_{j=1}^ks_j[i\\neq j]\\right)\\\\\n&=\\frac12\\left(\\left(\\sum_{i=1}^ks_i\\right)^2-\\sum_{i=1}^ks_i^2\\right)\n\\end{aligned}\n$$\n\u89c2\u5bdf $\\displaystyle \\sum_{i=1}^ks_i$ \u8fd9\u4e2a\u5f0f\u5b50\u7684\u610f\u4e49\u662f\u4ec0\u4e48\u3002\u7531 $S$ \u7684\u5b9a\u4e49\u4e0d\u96be\u63a8\u51fa\u5b83\u4ee3\u8868\u539f\u5e8f\u5217\u4e2d 0 \u7684\u6570\u91cf\u3002\u6240\u4ee5\u6211\u4eec\u60f3\u8981\u6700\u5927\u5316\u7b54\u6848\uff0c\u5c31\u8981\u6700\u5c0f\u5316 $\\displaystyle \\sum_{i=1}^ks_i^2$\u3002\n\n---\n\n\u7136\u540e\u6211\u4eec\u8fd8\u9700\u8981\u8003\u8651\u4ece $A$ \u72b6\u6001\u8f6c\u79fb\u5230 $B$ \u72b6\u6001\u6240\u9700\u8981\u7684\u6700\u5c11\u6b65\u6570\uff08\u56e0\u4e3a\u8981\u679a\u4e3e\u72b6\u6001\u65b9\u4fbf\u8f6c\u79fb\uff09\u3002\u6bcf\u6b21\u64cd\u4f5c\u6700\u591a\u53ea\u80fd\u8ba9\u76f8\u90bb\u5143\u7d20\u4e00\u4e2a\u52a0\u4e00\u4e00\u4e2a\u51cf\u4e00\u3002\u8bbe $g_{A,B}(i)$ \u4e3a\u8ba9 $A$ \u4e2d\u7684\u524d $i$ \u4e2a\u6570\u548c $B$ \u4e2d\u524d $i$ \u4e2a\u76f8\u540c\u7684\u6700\u5c0f\u6b65\u6570\uff0c\u5bf9 $i=1$ \u663e\u7136\u4e3a $\\vert a_1-b_1\\vert$\uff0c\u800c\u6269\u5c55\u5230 $i$ \u66f4\u5927\u7684\u60c5\u51b5\uff0c\u5c31\u4f1a\u6709 $\\displaystyle g_{A,B}(i)=\\left\\vert\\sum_{j=1}^ia_j-\\sum_{j=1}^ib_j \\right\\vert$\u3002\u800c\u60f3\u8981\u5c06 $A$ \u53d8\u6210 $B$\uff0c\u603b\u7684\u9700\u8981\u7684\u6b65\u6570\u4e3a $\\displaystyle \\sum_{i=1}^{k-1}g_{A,B}(i)$\uff08$A$ \u548c $B$ \u5747\u6709 $k$ \u4e2a\u5143\u7d20\uff09\u3002\n\n\u5982\u679c\u4e0d\u592a\u7406\u89e3\u4e0a\u5f0f\u7684\u540c\u5b66\u53ef\u4ee5\u770b\u4e0b\u8fd9\u91cc\uff0c\u4e3e\u4e2a\u4f8b\u5b50\u8bf4\u660e\u4e00\u4e0b\uff1a\n\n\u6bd4\u5982 $A=\\{5,8\\},B=\\{8,5\\}$\uff0c\u60f3\u8981\u8ba9 $A$ \u53d8\u6210 $B$\uff0c\u9700\u8981\u7684\u64cd\u4f5c\u6b21\u6570\u5c31\u662f $\\vert5-8\\vert=3$\uff1b\n\n\u6bd4\u5982 $A=\\{5,9,3\\},B=\\{8,3,6\\}$\uff0c\u9996\u5148\u8981\u628a $A$ \u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u53d8\u6210 $8$\uff0c\u8fd9\u6837\u9700\u8981\u7684\u6b21\u6570\u662f $\\vert5-8\\vert=3$\uff0c\u7136\u540e\u8fd9\u65f6\u5c31\u76f8\u5f53\u4e8e $A^\\prime=\\{6,3\\},B^\\prime=\\{3,6\\}$\uff0c\u9700\u8981\u7684\u6b21\u6570\u662f $\\vert6-3\\vert=3$\uff0c\u4e3a\u5565\u4e0d\u662f $\\vert9-3\\vert=6$ \u5462\uff1f\u56e0\u4e3a $5$ \u5df2\u7ecf\u5e2e\u5fd9\u628a $9$ \u51cf\u5c11 $3$ \u4e86\uff0c\u4e5f\u5c31\u662f\u8fd9\u4e2a $9$ \u8fd8\u8981\u52a0\u4e0a\u4e00\u4e2a $5-8$\uff0c\u4e5f\u5c31\u662f $a_1-b_1$\u3002\u90a3\u4e2a\u5927\u6c42\u548c\u5f0f\u5c31\u53ef\u4ee5\u7528\u8fd9\u79cd\u65b9\u6cd5\u4e00\u6b65\u4e00\u6b65\u5206\u89e3\u6389\u3002\n\n---\n\n\u505a\u597d\u4e86\u51c6\u5907\u5de5\u4f5c\uff0c\u5c31\u53ef\u4ee5\u5f00\u59cb\u51c6\u5907 DP \u4e86\u3002\u6211\u4eec\u60f3\u8981\u5f97\u5230\u7b54\u6848\u7684\u8bdd\u53ef\u4ee5\u8003\u8651 DP\uff0c\u8bbe $f_{i,sum,op}$ \u4e3a\u8003\u8651\u5230\u524d $i$ \u4e2a $S$ \u4e2d\u7684\u5143\u7d20\uff08$i\\le k$\uff09\uff0c\u5df2\u7ecf\u5b8c\u6210\u4e86 $op$ \u6b21\u64cd\u4f5c\uff0c\u7ecf\u8fc7 $op$ \u6b21\u64cd\u4f5c\u540e $\\displaystyle \\sum_{x=1}^{i}s_x=sum$\uff0c\u8fd9\u65f6\u6700\u5c0f\u7684 $\\displaystyle \\sum_{x=1}^{i}s_x^2$\u3002\n\n\u6700\u7ec8\u7b54\u6848\u5c31\u662f $\\displaystyle \\frac12\\left(cnt_0^2-f_{k,cnt_0,op}\\right)$\uff0c$cnt_0$ \u662f\u539f\u5e8f\u5217\u4e2d $0$ \u7684\u6570\u91cf\uff0c\u6216\u8005\u8bf4\u662f $\\displaystyle \\sum_{i=1}^ks_i$\u3002\n\n\u8bbe $\\displaystyle z_i=\\sum_{j=1}^is_j$\uff0c\u4e5f\u5c31\u662f\u539f\u5e8f\u5217\u65b0\u8868\u793a\u6cd5\u7684\u524d\u7f00\u548c\uff08\u7528\u4e8e\u72b6\u6001\u4e4b\u95f4\u7684\u8f6c\u79fb\uff09\u3002\n\n\u90a3\u4e48\u8f6c\u79fb\u5c31\u53ef\u4ee5\u5148\u679a\u4e3e $i$ \u4ece $0$ \u5230 $k-1$\uff0c\u7136\u540e\u679a\u4e3e $sum$ \u4ece $0$ \u5230 $z_k$\uff0c\u518d\u679a\u4e3e $op$ \u4ece $0$ \u5230 $\\displaystyle \\frac{n\\cdot (n-1)}2$\uff0c\u6700\u540e\u4e00\u5c42\u679a\u4e3e\u662f $q$ \u4ecb\u4e8e $sum$ \u548c $z_k$ \u4e4b\u95f4\uff0c\u8868\u793a\u8981\u8f6c\u79fb\u5230\u7684 $sum^\\prime$\uff0c\u90a3\u4e48\u6211\u4eec\u8f6c\u79fb\u5c31\u76f8\u5f53\u4e8e\u5728\u8868\u793a\u6cd5\u672b\u5c3e\u53c8\u6dfb\u52a0\u4e86\u4e00\u4e2a\u5143\u7d20 $h=q-sum$\u3002\u5219 $f_{i+1,q,op+\\vert q-z_{i+1}\\vert}=f_{i,sum,op}+h^2$\uff0c\u9ed8\u8ba4\u662f\u548c\u81ea\u5df1\u53d6 $\\min$\u3002\n\n\u8fd9\u6837\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal{O}(n^5)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n^4)$\u3002\u4f46\u7531\u4e8e\u6709\u5f88\u591a\u72b6\u6001\u6839\u672c\u4e0d\u5b58\u5728\uff0c\u6240\u4ee5\u5f88\u591a $q$ \u7684\u679a\u4e3e\u662f\u65e0\u6cd5\u8fdb\u884c\u7684\u3002\u800c\u4e14 DP \u5e38\u6570\u8f83\u5c0f\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\nconst int N = 80 + 6, inf = 0x3f3f3f3f;\n\ninline void min(int &x, const int &y) { x = x < y ? x : y; } // \u8282\u7701\u4ee3\u7801\u957f\u5ea6\n\nint n, k, s[N], z[N], f[N][N][N * N];\ninline void main() {\n    read(n);\n\n    /* \u6c42\u51fa\u65b0\u8868\u793a\u6cd5\u53ca\u5176\u524d\u7f00\u548c */\n    int a, cnt = 0;\n    for (int i = 1; i <= n; ++i) {\n        read(a);\n        if (a) {\n            s[++k] = cnt, cnt = 0;\n        } else {\n            ++cnt;\n        }\n    }\n    s[++k] = cnt;\n    for (int i = 1; i <= k; ++i) z[i] = z[i - 1] + s[i];\n\n    /* DP\u8fc7\u7a0b */\n    memset(f, 0x3f, sizeof(f)), f[0][0][0] = 0;\n    int top = n * (n - 1) / 2, maxx = z[k];\n    for (int i = 0; i < k; ++i) {\n        for (int sum = 0; sum <= maxx; ++sum) {\n            for (int op = 0; op <= top; ++op) {\n                if (f[i][sum][op] == inf) continue; // \u72b6\u6001\u4e0d\u5b58\u5728\u4e0d\u9700\u8981\u8f6c\u79fb\n                for (int q = sum, tmp, h; q <= maxx; ++q) {\n                    if ((tmp = op + abs(q - z[i + 1])) > top) continue; // \u8d85\u8fc7\u6240\u9700\u6b21\u6570\u6ca1\u5fc5\u8981\u8f6c\u79fb\n                    h = q - sum;\n                    min(f[i + 1][q][tmp], f[i][sum][op] + h * h);\n                }\n            }\n        }\n    }\n\n    int minn = inf;\n    for (int i = 0; i <= top; ++i) {\n        min(minn, f[k][maxx][i]); // \u53d6\u6700\u4f18\u503c\n        write((maxx * maxx - minn) / 2), putchar(' ');\n    }\n}\n```\n\n# ",
        "postTime": 1601175125,
        "uid": 135631,
        "name": "STDquantum",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1420E \u3010Battle Lemmings\u3011"
    }
]
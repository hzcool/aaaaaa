[
    {
        "content": "\u6211\u4e00\u770b\u53ef\u9ad8\u5174\u4e86,\u89c9\u5f97\u6b64\u9898\u975e\u5e38\u53ef\u505a.   \n\u9996\u5148\u6211\u4eec\u8003\u8651\u6590\u6ce2\u90a3\u5951\u6570\u5217$F(n)$ \u7684\u4e00\u4e2a\u6027\u8d28:  \n$gcd(F(a),F(b))=F(gcd(a,b))$  \n\u6211\u8bb0\u5f97\u8fd9\u4e2a\u6027\u8d28\u662f\u6211\u4ece\u54ea\u91cc\u77e5\u9053\u7684\u6765\u7740?  \n[luogu p1306 \u6590\u6ce2\u90a3\u5951\u516c\u7ea6\u6570](https://www.luogu.org/problemnew/show/P1306)  \n\u7136\u540e\u53ea\u8981\u627e\u5230\u6700\u5927\u7684$x$\u4f7f\u5f97$x$\u7684\u500d\u6570\u5728$[l,r]$\u91cc\u5927\u4e8e\u6216\u8005\u7b49\u4e8e$k$\u4e2a\u5373\u53ef.  \n\u731c\u731c\u8fd9\u4e2a$x$\u80fd\u4e0d\u80fd\u4e8c\u5206?  \n\u8fd9\u91cc\u6211\u4e0d\u5f97\u4e0d\u628a\u6211\u81ea\u5df1\u6279\u4e00\u987f.  \n`\u6211\u7adf\u7136\u5bf9\u4e0d\u80fd\u4e8c\u5206\u7684\u4e1c\u897f\u5199\u4e86\u4e8c\u5206,\u800c\u4e14\u4e00\u5f00\u59cb\u4ee5\u4e3a\u81ea\u5df1\u4e8c\u5206\u840e\u4e86\u540e\u6765\u624d\u53d1\u73b0\u6839\u672c\u4e0d\u80fd\u4e8c\u5206,\u8c03\u4e865\u4e2a\u5c0f\u65f6!`  \n\u6839\u636e\u6570\u636e\u8303\u56f4\u6211\u4eec\u7528$\\sqrt n$ \u7684\u679a\u4e3e.\n\u5047\u8bbe\u5b58\u5728\u4e00\u4e2a\u6570\u5b57$q$,\u5bf9\u4e8e$q-1$\u6765\u8bf4,\u5b83\u5728$[l,r]$\u5185\u7684\u500d\u6570\u7684\u4e2a\u6570\u53d8\u5316\u4e86,\u8fd9\u6837\u7684$q$\u5b58\u5728$\\sqrt(r)$\u4e2a.  \n\u7531\u4e8e\u6211\u4eec\u8981\u6c42\u7684\u53ea\u662f\u6700\u5927\u503c,\u6211\u4eec\u53ea\u9700\u8981\u5bf9\u4e8e$\\sqrt r$\u4e4b\u5185\u7684\u6bcf\u4e00\u4e2a$i$\u5224\u65ad$i$\u548c$r/i$ \u7684\u500d\u6570\u5728$[l,r]$\u662f\u4e0d\u662f\u5927\u4e8e\u6216\u8005\u7b49\u4e8e$k$\u4e2a\u5373\u53ef.  \n\u8fd9\u6837\u53ef\u4ee5\u6c42\u51fa$ans$,\u7b54\u6848\u5c31\u662f\u7b2c$ans$\u4e2a\u6590\u6ce2\u90a3\u5951\u6570,\u7528\u77e9\u9635\u5feb\u901f\u5e42\u5373\u53ef.  \n```cpp\n#include<bits/stdc++.h> //Ithea Myse Valgulious\nnamespace chtholly{\ntypedef long long ll;\n#define re0 register int\n#define rec register char\n#define rel register ll\n#define gc getchar\n#define pc putchar\n#define p32 pc(' ')\n#define pl puts(\"\")\n/*By Citrus*/\ninline int read(){\n  int x=0,f=1;char c=gc();\n  for (;!isdigit(c);c=gc()) f^=c=='-';\n  for (;isdigit(c);c=gc()) x=(x<<3)+(x<<1)+(c^'0');\n  return f?x:-x;\n  }\ntemplate <typename mitsuha>\ninline bool read(mitsuha &x){\n  x=0;int f=1;char c=gc();\n  for (;!isdigit(c)&&~c;c=gc()) f^=c=='-';\n  if (!~c) return 0;\n  for (;isdigit(c);c=gc()) x=(x<<3)+(x<<1)+(c^'0');\n  return x=f?x:-x,1;\n  }\ntemplate <typename mitsuha>\ninline int write(mitsuha x){\n  if (!x) return 0&pc(48);\n  if (x<0) x=-x,pc('-');\n  int bit[20],i,p=0;\n  for (;x;x/=10) bit[++p]=x%10;\n  for (i=p;i;--i) pc(bit[i]+48);\n  return 0;\n  }\ninline char fuhao(){\n  char c=gc();\n  for (;isspace(c);c=gc());\n  return c;\n  }\n}using namespace chtholly;\nusing namespace std;\nconst int mod=read();\nll l,r,k;\n\nbool judge(ll x){\nreturn r/x-(l-1)/x>=k;\n}\n\nstruct juzhen{\nll m[3][3];\nvoid clearit(){\n  memset(m,0,sizeof m);\n  m[1][1]=m[2][2]=1;\n  }\nvoid clear(){memset(m,0,sizeof m);}\njuzhen operator *(const juzhen &b) const{\n  int i,j,k;\n  juzhen ans;ans.clear();\n  for (i=1;i<3;++i){\n    for (j=1;j<3;++j){\n      for (k=1;k<3;++k){\n        ans.m[i][j]=(ans.m[i][j]+m[i][k]*b.m[k][j])%mod;\n        } \n      }\n    }return ans;\n  }\n};\n\njuzhen operator ^(juzhen a,ll b){\njuzhen c;c.clearit();\nfor (;b;b>>=1,a=a*a) if (b&1) c=c*a;\nreturn c;\n}\n\nint main(){\nread(l),read(r),read(k);\nll ans=0;\nfor (ll i=1;i*i<=r;++i){\n  if (judge(i)) ans=max(ans,i);\n  if (judge(r/i)) ans=max(ans,r/i); \n  }\njuzhen tmp;\ntmp.clear();\ntmp.m[1][1]=tmp.m[1][2]=tmp.m[2][1]=1;\ntmp=tmp^ans-1;\nwrite((tmp.m[1][1]+mod)%mod);\n}\n/*\ngcd(F(a),F(b))=F(gcd(a,b));\n*/\n```\n\u8c22\u8c22\u5927\u5bb6.",
        "postTime": 1532773124,
        "uid": 49371,
        "name": "Fuko_Ibuki",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF226C \u3010Anniversary\u3011"
    },
    {
        "content": "\u989d\u670b\u53cb\u4eec\u597d \u6211\u662f\u4e00\u4e2a\u770b\u9519\u9898\u53f7\u6765\u505a\u8fd9\u9898\u7684\u4eba\n\n\u9996\u5148\u6709\u4e00\u4e2a\u5e7f\u4e3a\u4eba\u77e5\u7684\u7ed3\u8bba $\\gcd(fibo_x,fibo_y)=fibo_{\\gcd(x,y)}$\uff0c\u8fd9\u6211\u8fd8\u4e0d\u4f1a\u8bc1\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u627e\u51fa $[l,r]$ \u4e2d\u9009 $k$ \u4e2a\u6570\u7684 $\\gcd$ \u7684\u6700\u5927\u503c\u5373\u53ef\uff0c\u7136\u540e\u77e9\u9635\u5feb\u901f\u5e42\u5373\u53ef\u6c42\u51fa\u5bf9\u5e94 $fibo$\u3002\n\n$x$ \u53ef\u4ee5\u4f5c\u4e3a\u4e00\u4e2a\u5408\u6cd5\u7684 $\\gcd$ \u663e\u7136\u5f53\u4e14\u4ec5\u5f53 $[l,r]$ \u5185 $x$ \u500d\u6570\u4e2a\u6570 $\\geq k$\u3002\u8fd0\u7528\u524d\u7f00\u548c\u6709 $\\left\\lfloor\\dfrac rx\\right\\rfloor-\\left\\lfloor\\dfrac{l-1}x\\right\\rfloor\\geq k$\u3002\u6211\u4eec\u8003\u8651\u6839\u53f7\u5206\u6cbb\u679a\u4e3e $\\left\\lfloor\\dfrac rx\\right\\rfloor$\uff1a\u66b4\u529b\u7684\u90e8\u5206\u5c31\u4e0d\u8bf4\u4e86\uff1b\u5bf9\u4e8e\u679a\u4e3e\u503c\u7684\u90e8\u5206\uff0c\u7b97\u51fa\u6765\u53ef\u9009\u7684\u533a\u95f4\u662f $[L,R]$\uff0c\u90a3\u4e48\u663e\u7136 $R$ \u8d8a\u5927\uff0c\u4e0a\u5f0f\u7684\u503c\u8d8a\u5927\uff0c\u5e76\u4e14\u9009\u62e9\u7684\u8d8a\u4f18\uff0c\u4e8e\u662f\u6211\u4eec\u76f4\u63a5\u770b $R$ \u662f\u5426\u6ee1\u8db3\u5e76\u4e14\u677e\u5f1b\u5373\u53ef\u3002",
        "postTime": 1610628964,
        "uid": 138400,
        "name": "chenxia25",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF226C \u3010Anniversary\u3011"
    },
    {
        "content": "\u9996\u5148\u6709\u4e2a\u663e\u7136\u7684\u6027\u8d28\uff1a$\\gcd(F_a,F_b)=F_{\\gcd(a, b)}$\uff0c\u5176\u4e2d $F$ \u6307\u6590\u6ce2\u90a3\u5951\u6570\u5217\u3002\n\n\u90a3\u4e48\u95ee\u9898\u5c31\u8f6c\u5316\u6210\u5728\u533a\u95f4 $[l,r]$ \u4e2d\u627e $k$ \u4e2a\u4e0d\u540c\u7684\u6570\u5b57\u4f7f\u5f97\u8fd9\u4e9b\u6570\u5b57\u7684\u6700\u5927\u516c\u7ea6\u6570\u6700\u5927\u3002\n\n\u90a3\u4e48\u5728\u4e00\u4e2a\u533a\u95f4 $[l,r]$ \u4e2d\uff0c\u6709\u56e0\u5b50 $x$ \u7684\u6570\u7684\u6570\u91cf\u662f $r/x-(l-1)/x$ \u4e2a\uff0c\u6211\u4eec\u5728 $\\sqrt{r}$ \u4e2d\u5bfb\u627e $i$ \u548c $r/i$ \u7684\u6709\u56e0\u5b50 $x$ \u7684\u6570\u7684\u6570\u91cf\u662f\u5426\u5927\u4e8e\u7b49\u4e8e $k$\uff0c\u8bb0\u5f55\u4e0b\u6700\u5927\u7684\u4e00\u4e2a\u56e0\u5b50 $id$\uff0c\u90a3\u4e48\u6700\u540e\u7684\u7b54\u6848\u5c31\u662f $F_{id}$\u3002\n\n\u6ce8\u610f\u8981\u968f\u65f6\u53d6\u6a21\uff0c\u6a21\u6570\u662f\u6570\u636e\u7ed9\u51fa\u7684\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define reg register\n#define ll long long\n#define int long long\n#define ull unsigned long long\n#define db double\n#define pi pair<int, int>\n#define pl pair<ll, ll>\n#define vi vector<int>\n#define vl vector<ll>\n#define vpi vector<pi>\n#define vpl vector<pl>\n#define pb push_back\n#define er erase\n#define SZ(x) (int) x.size()\n#define lb lower_bound\n#define ub upper_bound\n#define all(x) x.begin(), x.end()\n#define rall(x) x.rbegin(), x.rend()\n#define mkp make_pair\n#define dmin(x, y) ((x) < (y) ? (x) : (y))\n#define dmax(x, y) ((x) > (y) ? (x) : (y))\n#define checkmax(x, y) ((x) < (y) ? ((x) = (y)) : (x))\n#define checkmin(x, y) ((x) > (y) ? ((x) = (y)) : (x))\n#define ms(data_name) memset(data_name, 0, sizeof(data_name))\n#define msn(data_name, num) memset(data_name, num, sizeof(data_name))\n#define pls(x, y) ((x) + (y) >= m ? (x) + (y) - m : (x) + (y))\n#define mul(x, y) (1ll * (x) * (y) % m)\n#define For(i, j) for(reg int (i) = 1; (i) <= (j); ++(i))\n#define For0(i, j) for(reg int (i) = 0; (i) < (j); ++(i))\n#define Forx(i, j, k) for(reg int (i) = (j); (i) <= (k); ++(i))\n#define Forstep(i , j, k, st) for(reg int (i) = (j); (i) <= (k); (i) += (st))\n#define fOR(i, j) for(reg int (i) = (j); (i) >= 1; (i)--)\n#define fOR0(i, j) for(reg int (i) = (j) - 1; (i) >= 0; (i)--)\n#define fORx(i, j, k) for(reg int (i) = (k); (i) >= (j); (i)--)\n#define tour(i, u) for(reg int (i) = head[(u)]; (i) != -1; (i) = nxt[(i)])\nusing namespace std;\nchar ch, B[1 << 20], *S = B, *T = B;\n#define getc() (S == T && (T = (S = B) + fread(B, 1, 1 << 20, stdin), S == T) ? 0 : *S++)\n#define isd(c) (c >= '0' && c <= '9')\nint rdint() {\n  int aa, bb;\n  while(ch = getc(), !isd(ch) && ch != '-');\n  ch == '-' ? aa = bb = 0 : (aa = ch - '0', bb = 1);\n  while(ch = getc(), isd(ch))\n    aa = aa * 10 + ch - '0';\n  return bb ? aa : -aa;\n}\nll rdll() {\n  ll aa, bb;\n  while(ch = getc(), !isd(ch) && ch != '-');\n  ch == '-' ? aa = bb = 0 : (aa = ch - '0', bb = 1);\n  while(ch = getc(), isd(ch))\n    aa = aa * 10 + ch - '0';\n  return bb ? aa : -aa;\n}\nll mod, l, r, k;\nstruct Matrix {\n  ll a[3][3];\n  Matrix() { memset(a, 0, sizeof a); }\n  Matrix operator*(const Matrix &b) const {\n    Matrix res;\n    for (int i = 1; i <= 2; ++i)\n      for (int j = 1; j <= 2; ++j)\n        for (int k = 1; k <= 2; ++k)\n          res.a[i][j] = (res.a[i][j] + 1ll * a[i][k] * b.a[k][j] % mod) % mod;\n    return res;\n  }\n} ans, base;\nvoid init() {\n  base.a[1][1] = base.a[1][2] = base.a[2][1] = 1;\n  ans.a[1][1] = ans.a[1][2] = 1;\n}\nvoid qpow(int b) {\n  while (b) {\n    if (b & 1) ans = ans * base;\n    base = base * base;\n    b >>= 1;\n  }\n}\ninline void work() {\n  mod = rdll();\n  l = rdll();\n  r = rdll();\n  k = rdll();\n  int id = 0;\n  for(reg ll i = 1; i * i <= r; ++i) {\n    if(r / i - (l - 1) / i >= k) {\n      checkmax(id, i);\n    }\n    if(r / (r / i) - (l - 1) / (r / i) >= k) {\n      checkmax(id, r / i);\n    }\n  }\n  // cout << id << endl;\n  if(id <= 2) {\n    id = 1 % mod;\n    printf(\"%lld\\n\", id);\n  } else {\n    init();\n    qpow(id - 2);\n    printf(\"%lld\\n\", ans.a[1][1] % mod);\n  }\n}\nsigned main() {\n  // freopen(\"input.txt\", \"r\", stdin);\n  work();\n  return 0;\n}\n```",
        "postTime": 1585183902,
        "uid": 157411,
        "name": "Nylch",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF226C \u3010Anniversary\u3011"
    }
]
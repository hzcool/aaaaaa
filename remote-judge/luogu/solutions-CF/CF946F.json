[
    {
        "content": "#### \u6b63\u9898\n\n\u5bb9\u6613\u60f3\u5230\u8bbe $f_{i,j,k}$ \u8868\u793a\u5728\u4e32 $F(i)$ \u7684\u5b50\u5e8f\u5217\u4e2d\uff0c\u539f\u4e32\u4e2d\u533a\u95f4 $[j,k]$ \u4f5c\u4e3a\u5b50\u4e32\u51fa\u73b0\u7684\u6b21\u6570\u4e4b\u548c\u3002\n\n\u5219 $f_{i,j,k}$ \u53ef\u80fd\u5305\u542b\u4e24\u79cd\u60c5\u51b5\uff1a\u4e00\u79cd\u662f\u5b50\u5e8f\u5217\u5168\u90e8\u5728 $F(i-1)$ \u6216 $F(i-2)$ \u4e2d\uff0c\u4e00\u79cd\u662f\u5b50\u5e8f\u5217\u8de8\u8d8a\u4e24\u7aef\u3002\n\n\u5148\u8ba8\u8bba\u540e\u4e00\u79cd\u60c5\u51b5\uff0c\u53ef\u4ee5\u5f97\u51fa\u8f6c\u79fb\uff1a\n\n$$f_{i,j,k}=\\sum_{l=j}^{k-1}f_{i-1,j,l}\\times f_{i-2,l+1,k}$$\n\n\u7136\u540e\u8ba8\u8bba\u524d\u4e00\u79cd\u60c5\u51b5\u3002\u5148\u8ba8\u8bba\u5b50\u5e8f\u5217\u5168\u90e8\u4f4d\u4e8e $F(i-1)$ \u4e2d\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u53d1\u73b0\u5f53 $k=n$ \u65f6\u7531\u4e8e $[j,n]$ \u5df2\u7ecf\u88ab\u5168\u90e8\u5305\u542b\uff0c\u56e0\u6b64\u5728 $F(i-2)$ \u4e2d\u7684\u5b57\u7b26\u53ef\u4ee5\u968f\u4fbf\u9009\u3002\u5426\u5219\u4e0d\u80fd\u9009\uff0c\u4e0d\u7136\u53ef\u80fd\u4f1a\u7b97\u91cd\u3002\u8bbe $len_i$ \u8868\u793a $F(i)$ \u7684\u957f\u5ea6\uff0c\u5219\u6709\uff1a\n\n$$f_{i,j,k}=\n\\begin{cases} \nf_{i-1,j,k}\\times 2^{len_{i-2}}&k=n\\\\\nf_{i-1,j,k}&k\\ne n\n\\end{cases}$$\n\n\u5bf9\u4e8e\u5b50\u5e8f\u5217\u5168\u90e8\u4f4d\u4e8e $F(i-2)$ \u7684\u60c5\u51b5\uff0c\u540c\u7406\u53ef\u5f97\uff1a\n\n$$f_{i,j,k}=\n\\begin{cases} \nf_{i-2,j,k}\\times 2^{len_{i-1}}&j=1\\\\\nf_{i-2,j,k}&j\\ne 1\n\\end{cases}$$\n\n\u521d\u503c\uff1a$f_{0,i,i}=[s_i=0]$\uff0c$f_{1,i,i}=[s_i=1]$\u3002\n\n\u6700\u7ec8\u7b54\u6848\u5373\u4e3a $f_{x,1,n}$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(xn^3)$\u3002\n\nCode\uff1a\n```cpp\n#include <cstdio>\n#include <cstring>\nusing namespace std ;\nconst int MAXN = 110 , mod = 1e9 + 7 ;\ntypedef long long ll ;\nll f[MAXN][MAXN][MAXN] , fib[MAXN] , pw[MAXN] ;\nint n , m ;\nchar s[MAXN] ;\nll qpow (ll x , ll p) {\n\tll ret = 1 ;\n\tfor (; p ; p >>= 1 , x = x * x % mod)\n\t\tif (p & 1) ret = ret * x % mod ;\n\treturn ret ;\n}\nint main () {\n\tscanf (\"%d%d\" , &n , &m) ;\n\tscanf (\"%s\" , s + 1) ;\n\tfib[0] = fib[1] = 1 ; pw[0] = pw[1] = 2 ;\n\tfor (int i = 2 ; i <= m ; i++)\n\t\tfib[i] = (fib[i - 1] + fib[i - 2]) % (mod - 1) , pw[i] = qpow (2 , fib[i]) ;\n\tfor (int i = 1 ; i <= n ; i++)\n\t\tf[0][i][i] = (s[i] == '0') , f[1][i][i] = (s[i] == '1') ;\n\tfor (int i = 2 ; i <= m ; i++) {\n\t\tfor (int j = 1 ; j <= n ; j++)\n\t\t\tfor (int k = j ; k <= n ; k++) {\n\t\t\t\tf[i][j][k] = (f[i][j][k] + f[i - 1][j][k] * ((k == n) ? pw[i - 2] : 1) % mod) % mod ;\n\t\t\t\tf[i][j][k] = (f[i][j][k] + f[i - 2][j][k] * ((j == 1) ? pw[i - 1] : 1) % mod) % mod ;\n\t\t\t\tfor (int l = j ; l < k ; l++)\n\t\t\t\t\tf[i][j][k] = (f[i][j][k] + f[i - 1][j][l] * f[i - 2][l + 1][k] % mod) % mod ;\n\t\t\t}\n\t}\n\tprintf (\"%lld\\n\" , f[m][1][n]) ;\n\treturn 0 ;\n}\n```",
        "postTime": 1647588372,
        "uid": 122641,
        "name": "GIFBMP",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF946F \u3010Fibonacci String Subsequences\u3011"
    },
    {
        "content": "\u5206\u6790\u9898\u610f\uff0c\u8be2\u95ee\u5b57\u7b26\u4e32s\u51fa\u73b0\u5728F(X)\u6b21\u6570\uff0c\u800c\u6211\u4eec\u90fd\u77e5\u9053\u5b50\u5e8f\u5217\u53ef\u4ee5\u662f\u4e0d\u8fde\u7eed\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u62fc\u63a5\u4e32\u4e32\u6765\u505a\n\n\u8bbedp[i][l][r]\uff0ci\u4ee3\u8868\u662fF(i)\uff0cl\u548cr\u5206\u522b\u662f\u5b57\u7b26\u4e32\u7684\u5b50\u4e32S1 l~r\n\u90a3\u4e48\u6613\u5f97dp[i][l][r]\u80af\u5b9a\u6709\u4e00\u90e8\u5206\u53ef\u4ee5dp[i-1][l][r]\u548cdp[i-2][l][r]\u4e2d\u83b7\u5f97\n\u6b63\u5e38\u76f4\u63a5dp[i][l][r]+=dp[i-1][l][r]\u4ee5\u53cadp[i-2][l][r]\u5373\u53ef\n\u4f46\u9700\u8981\u7279\u52242\u79cd\u60c5\u51b5\uff0c\u7b2c\u4e00\u79cdl==1\uff0c\u4e5f\u5c31\u662f\u5728dp[i-2][l][r]\u5305\u542b\u7684\u5c31\u662f\u5b50\u4e32S1 l~r\u7684\u5168\u90e8\u4e86\uff0c\u524d\u9762\u7684\u968f\u4fbf\u53d6\u591a\u5c11\u4e2a\u90fd\u4e0d\u5f71\u54cd\u540e\u9762\u7684\n\n\u6240\u4ee5\u8fd9\u4e2a\u65f6\u5019\u5c31\u662fdp[i] [l] [r]+= dp[i-2] [l] [r] * (2 ^ lenth[i-1])\uff0c\u540c\u7406\uff0c\u5047\u5982r==n\uff0c\u4e5f\u5c31\u662f\u5728dp[i-1]\u9636\u6bb5\u5c31\u5df2\u7ecf\u6709\u5b50\u4e32S1 l~r\u7684\u5168\u90e8\u4e86\uff0c\u540e\u9762\u7684\u968f\u4fbf\u53d6\ndp[i][l][r]+=dp[i-1] [l] [r] * (2^lenth[i-2])\n\n2^lenth\u8fd9\u6b65\u6bcf\u6b21\u90fd\u8981\u4e58\uff0c\u5e76\u4e14lenth\u4e0d\u77ed\uff0c\u5047\u5982\u6bcf\u6b21\u90fd\u91cd\u65b0\u7b97\uff0c\u8981\u7528\u5feb\u901f\u5e42\u4f18\u5316\n\u6240\u4ee5\u6211\u4eec\u5b8c\u5168\u53ef\u4ee5\u9884\u5904\u7406\u4e00\u4e0b\uff0c\u628a2^lenth\u653e\u5728len\u6570\u7ec4\u91cc\uff0c\u7528\u7684\u65f6\u5019\u76f4\u63a5\u62ff\n\n\u7136\u540e\u5c31\u662f\u53ef\u4ee5\u628a\u4e00\u4e2a\u5b50\u4e32\u62c6\u5206\u62102\u4e2a\u5206\u5b50\u4e32\n\n\u6240\u4ee5dp[i][l][r]+=dp[i-1][l][k]+dp[i-1][k+1][r]\uff0ck\u7684\u8303\u56f4\u662f[ l , r )\uff0c\u8bb0\u5f97\u53d6\u4f59\n\u8fd9\u9898\u5c31\u505a\u5b8c\u4e86\uff0c\u5177\u4f53\u7684\u53ef\u4ee5\u770b\u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define rep(i,a,n) for(int i=a;i<n;i++)\n#define per(i,a,n) for(int i=n-1;i>=a;i--)\ntypedef long long ll;\ntypedef double db;\ntypedef pair<int,int> PII;\ntypedef vector<int> VI;\nconst ll mod=1000000007;\nconst int maxn=200;\nconst int inf=0x3f3f3f3f;\nconst int INF=0x7f7f7f7f;\nll gcd(ll a,ll b){ return b?gcd(b,a%b):a;}\n#define ms(a) memset(a,0,sizeof(a))\n#define mss(a) memset(a,-1,sizeof(a))\n#define msi(a) memset(a,inf,sizeof(a))\n#define iossync ios::sync_with_stdio(false);cin.tie(0);cout.tie(0);\n// head\nll pow_(ll x,ll y)\n{\n    ll rt=1;\n    while (y){\n        if (y&1) rt=rt*x%mod;\n        x=x*x%mod; y>>=1;\n    }\n    return rt;\n}\n//unsigned \nll dp[maxn][maxn][maxn],n,m,len[maxn];\nstring s1;\nvoid init()\n{\n\t#define num len\n\tnum[0]=2;\n\tnum[1]=2;\n\trep(i,2,m+1)\n\tnum[i]=num[i-1]*num[i-2]%mod;\n\t#undef num\n}\nint main()\n{\n\t\n\tcin>>n>>m;\n\tinit();//\u9884\u5904\u74062^len \n\tcin>>s1;\n\trep(i,1,n+1)\n\t{//l==r\n\t\tdp[s1[i-1]-'0'][i][i]=1;\n\t\t//\u5148\u786e\u5b9a1\u548c0\u7684\u4f4d\u7f6e \n\t}\n\trep(i,2,m+1)\n\t{\n\t\trep(l,1,n+1)\n\t\t{\n\t\t\trep(r,l,n+1)\n\t\t\t{\n\t\t\t\t//\u4e00\u822c\u60c5\u51b5\u76f4\u63a5\u52a0\u5c31\u597d \n//\t\t\t\tdp[i][l][r]+=dp[i-1][l][r]+dp[i-2][l][r];\n\t\t\t\tif(r==n)//\u7279\u5224r \n\t\t\t\t(dp[i][l][r]+=dp[i-1][l][r]*len[i-2]%mod)%=mod;\n\t\t\t\telse\n\t\t\t\t(dp[i][l][r]+=dp[i-1][l][r])%=mod;\n\t\t\t\tif(l==1)//\u7279\u5224l \n\t\t\t\t(dp[i][l][r]+=dp[i-2][l][r]*len[i-1])%=mod;\n\t\t\t\telse\n\t\t\t\t(dp[i][l][r]+=dp[i-2][l][r])%=mod;\n\t\t\t\trep(k,l,r)\n\t\t\t\t{\n\t\t\t\t\t(dp[i][l][r]+=dp[i-1][l][k]*dp[i-2][k+1][r])%=mod;\n\t\t\t\t } \n\t\t\t}\n\t\t}\n\t}\n\tcout<<dp[m][1][n]<<\"\\n\";\n\treturn 0;\n}\n```\n",
        "postTime": 1595684597,
        "uid": 251466,
        "name": "wwldx",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF946F \u3010Fibonacci String Subsequences\u3011"
    },
    {
        "content": "## CF946F Fibonacci String Subsequences\n\u60f3\u8981\u66f4\u4f18\u8d28\u7684\u9605\u8bfb\u4f53\u9a8c\uff0c\u5c31\u6765[\u8fd9\u91cc](https://www.cnblogs.com/linyihdfj/p/16893607.html)\u5427\u3002\n### \u9898\u76ee\u5206\u6790\uff1a\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u6211\u4eec\u5176\u5b9e\u53ef\u4ee5\u4f7f\u7528\u5408\u5e76\u7684\u601d\u60f3\u53bb\u770b\u8fd9\u4e2a\u9898\uff0c\u5c31\u662f\u5565\u610f\u601d\u5462\u3002\n\n\u6211\u4eec\u5728 $F(i)$ \u5185\u7684\u65b9\u6848\u6570\uff0c\u5176\u5b9e\u5c31\u662f\u5728 $F(i-1)$ \u91cc\u7684\u65b9\u6848\u6570\u52a0\u5728 $F(i-2)$ \u91cc\u7684\u65b9\u6848\u6570\u52a0\u6a2a\u8de8 $F(i-1)$ \u548c $F(i-2)$ \u7684\u65b9\u6848\u6570\u3002\n\u5c31\u8003\u8651\u600e\u4e48\u505a\u53ef\u4ee5\u505a\u5230\u5904\u7406\u6a2a\u8de8\u7684\u8fd9\u79cd\u60c5\u51b5\u3002\n\n\u663e\u7136\u53ef\u4ee5\u60f3\u5230\u4e00\u4e2a $dp$\uff0c\u5c31\u662f\u8bbe $f[i][j][k]$ \u8868\u793a\u5728 $F(i)$ \u4e2d $[j,k]$ \u8fd9\u4e2a\u5b50\u4e32\u4f5c\u4e3a\u5176\u67d0\u4e00\u4e2a\u5b50\u5e8f\u5217\u7684\u5b50\u4e32\u7684\u6b21\u6570\u3002\n\n\u8ba8\u8bba\u8f6c\u79fb\u4e5f\u662f\u4e0a\u9762\u8fd9\u4e2a\u60f3\u6cd5\u3002\n\n\u8003\u8651\u5168\u5728 $F(i-1)$ \u4e2d\u7684\u600e\u4e48\u7b97\uff0c\u76f4\u63a5\u5c31\u662f $f[i-1][j][k]$ \u5417\uff1f\u663e\u7136\u4e0d\u662f\u3002\n\n\u56e0\u4e3a\u591a\u52a0\u4e86\u4e00\u4e2a $F(i-2)$\uff0c\u6240\u4ee5\u5176\u5b9e\u5bf9\u4e8e\u8fd9\u91cc\u9762\u7684\u6570\u6211\u4eec\u53ef\u4ee5\u968f\u4fbf\u9009\uff0c\u6240\u4ee5\u662f $f[i-1][j][k] \\times 2^{len_{i-2}}$\uff08\u8fd9\u91cc\u8bbe $len_i$ \u4ee3\u8868 $F(i)$ \u7684\u957f\u5ea6\uff09\u5417\uff1f\n\n\u56e0\u4e3a\u53ea\u6709\u5f53 $k=n$ \u7684\u65f6\u5019\u6211\u4eec\u5bf9\u4e8e $F(i-2)$ \u624d\u6ca1\u6709\u4ec0\u4e48\u9650\u5236\uff0c\u5426\u5219\u662f\u6709\u9650\u5236\uff0c\u6240\u4ee5\u7efc\u5408\u5c31\u662f\u8fd9\u4e2a\u5f0f\u5b50\uff1a\n\n$$\nf[i][j][k] = \n\\begin{cases}\nf[i-1][j][k] \\times 2^{len_{i-2}} &k = n \\\\\nf[i-1][j][k] & k \\not= n\n\\end{cases}\n$$\n\n\u800c\u5bf9\u4e8e\u5168\u90e8\u5728 $F(i-2)$ \u4e2d\u4e5f\u662f\u540c\u7406\uff0c\u5c31\u4e0d\u591a\u5206\u6790\u4e86\uff0c\u76f4\u63a5\u7ed9\u51fa\u7ed3\u8bba\uff1a\n\n$$\nf[i][j][k] = \n\\begin{cases}\nf[i-2][j][k] \\times 2^{len_{i-1}} &j = 1\\\\\nf[i-1][j][k] &j \\not= 1\n\\end{cases}\n$$\n\n\u7136\u540e\u5c31\u662f\u8003\u8651\u8de8\u533a\u95f4\u7684\u60c5\u51b5\uff0c\u5176\u5b9e\u4e5f\u662f\u5f88\u7b80\u5355\u7684\uff1a\n\n$$\nf[i][j][k] = \\sum_{p = j}^{k-1} f[i-1][j][p] \\times f[i-2][p+1][k]\n$$\n\n\u521d\u503c\u4e5f\u975e\u5e38\u7b80\u5355\u5566\uff0c$f[0][i][i] = [s[i] = 0],f[1][i][i] = [s[i] = 1]$\n### \u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int MOD = 1e9+7;\nconst int N = 205;\nint f[N][N][N],len[N],pw[N];\nchar s[N];\nint mod(int x){\n\treturn x % MOD;\n}\nvoid add(int &x,int y){\n\ty = mod(y);\n\tx = mod(x + y);\n}\nint power(int a,int b){\n\tint res = 1;\n\twhile(b){\n\t\tif(b & 1)\tres = mod(res * a);\n\t\ta = mod(a * a);\n\t\tb >>= 1;\n\t}\n\treturn res;\n}\nsigned main(){\n\tint n,x;\n\tscanf(\"%lld%lld\",&n,&x);\n\tscanf(\"%s\",s+1);\n\tlen[0] = len[1] = 1;\n\tpw[0] = 2,pw[1] = 2;   //pw \u76f4\u63a5\u8bb0\u5f55\u5bf9\u5e94\u7684\u7b54\u6848 \n\tfor(int i=2; i<=x; i++){\n\t\tlen[i] = (len[i-1] + len[i-2]) % (MOD - 1);   //\u5367\u69fd\uff1f\uff1f\u6b27\u62c9\u5b9a\u7406 \n\t\tpw[i] = power(2,len[i]);\n\t}\n\tfor(int i=1; i<=n; i++){\n\t\tf[0][i][i] = (s[i] == '0');\n\t\tf[1][i][i] = (s[i] == '1');\n\t}\n\tfor(int i=2; i<=x; i++){\n\t\tfor(int j=1; j<=n; j++){\n\t\t\tfor(int k=j; k<=n; k++){\n\t\t\t\tadd(f[i][j][k],f[i-1][j][k] * (k == n ? pw[i-2] : 1));\n\t\t\t\tadd(f[i][j][k],f[i-2][j][k] * (j == 1 ? pw[i-1] : 1));\n\t\t\t\tfor(int p = j; p < k; p++){\n\t\t\t\t\tadd(f[i][j][k],f[i-1][j][p] * f[i-2][p+1][k]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",f[x][1][n]);\n\treturn 0;\n}\n```",
        "postTime": 1669098874,
        "uid": 544860,
        "name": "linyihdfj",
        "ccfLevel": 5,
        "title": "\u3010\u9898\u89e3\u3011CF946F Fibonacci String Subsequences"
    }
]
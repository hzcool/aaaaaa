[
    {
        "content": "## \u4e00\u70b9\u5e9f\u8bdd\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF54C)\n\n[My blog](https://www.luogu.com.cn/blog/128433/#)\n\n## \u601d\u8def\n\n\u5047\u8bbe\u7b2c $i$ \u4f4d\u662f\u4ee5 $1$ \u5f00\u5934\u7684\u6570\u5b57\u6982\u7387\u4e3a $p_i$\uff0c\u4e14\u524d $i$ \u4f4d\u5171\u6709 $j$ \u4e2a\u6570\u5f00\u5934\u4e3a $1$ \u7684\u6982\u7387\u4e3a $f_{i,j}$\uff0c\u663e\u7136\u53ef\u4ee5\u8f6c\u79fb\uff1a\n\n$$\nf_{i,j}=\\begin{cases}(1-p_i) \\cdot f_{i-1,0}&x=0\\\\(1-p_i) \\cdot f_{i-1,j-1} + p_i \\cdot f_{i-1,j}&x>3\\end{cases}\n$$\n\n\u600e\u4e48\u6c42 $p_i$ \u5462\uff1f\n\n\u8003\u8651 $1$ \u5230 $a_i$ \u4e2d\u6709\u591a\u5c11\u4e2a\u5f00\u5934\u4e3a $1$ \u7684\u6570\uff0c\u5047\u8bbe $a_i$ \u7684\u4f4d\u6570\u4e3a $x+1$\u3002\n\n\u90a3\u4e48\u5728 $1$ \u5230 $10^x-1$ \u4e2d\u4e00\u5171\u6709 $\\begin{matrix}\\underbrace{11\\dots1}\\\\x-1\\text{\u4e2a}\\end{matrix}$ \u4e2a\u5f00\u5934\u4e3a $1$ \u7684\u6570\uff1b\u82e5 $a_i$\u5f00\u5934\u4e3a $1$\uff0c\u5219\u5728 $10^x-1$ \u5230 $a_i$ \u4e2d\u4e00\u5171\u6709 $a_i \\% 10^x$ \u4e2a\u5f00\u5934\u4e3a $1$ \u7684\u6570\uff1b\u82e5 $a_i$ \u5f00\u5934\u4e0d\u4e3a $1$\uff0c\u5219\u5728 $10^x$ \u5230 $a_i$ \u4e2d\u4e00\u5171\u6709 $10^x$ \u4e2a\u5f00\u5934\u4e3a $1$ \u7684\u6570\u3002\n\n\u6ce8\u610f\u4e00\u4e0b\u53ef\u80fd\u7206 long long \u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2)$\uff0c\u59a5\u59a5\u80fd\u8fc7\u3002\n\n## \u4ee3\u7801\n\n```cpp\n__int128 f[105][105][105];\nll n,k;\nint main()\n{\n\tf[0][0][0]=1;\n\tfor (int i=0;i<100;++i)\n\t\tfor (int j=0;j<=i;++j)\n\t\t\tfor (int k=0;k<=i;++k)\n\t\t\t\tf[i+1][j+1][max(k,j+1)]+=f[i][j][k],f[i+1][0][k]+=f[i][j][k];\n\twhile (~scanf(\"%lld%lld\",&n,&k))\n\t{\n\t\t__int128 ans=0;\n\t\tfor (int i=0;i<=n;++i)\n\t\t\tfor (int j=k;j<=n;++j)\n\t\t\t\tans+=f[n][i][j];\n\t\twrite(ans,'\\n');\n\t}\n\treturn 0;\n}\n\n```\n",
        "postTime": 1650983552,
        "uid": 128433,
        "name": "C6H14",
        "ccfLevel": 7,
        "title": "\u3010\u9898\u89e3\u3011CF54C"
    },
    {
        "content": "#### \u601d\u8def\n\n\u9996\u5148\u5bf9\u4e8e\u8fd9\u4e2a\u533a\u95f4 $[l, r]$ \u4e4b\u95f4\u7684\u6570\u6211\u4eec\u53ef\u4ee5\u7528\u5dee\u5206\u7684\u65b9\u5f0f\u5c06\u5b83\u4eec\u5f00\u5934\u662f$1$\u7684\u6982\u7387\u6c42\u51fa\u6765\n\n\u4ee4 $dp[i]$ \u8868\u793a\u6709 $i$ \u4e2a\u6570\u7684\u7b2c$1$\u4f4d\u662f$1$\u7684\u6982\u7387\n\n\u7136\u540e\u5462\u518d\u7528\u4e00\u4e2a\u6982\u7387 $dp$ \uff0c\u8003\u8651\u6bcf\u4e2a\u533a\u95f4\u7684\u8d21\u732e\uff0c\u5c06\u5176\u6982\u7387\u6c42\u51fa\u6765\n\n\u6700\u540e\u518d\u66b4\u529b\u679a\u4e3e $[1, n]$ \u7d2f\u52a0\u6ee1\u8db3\u6761\u4ef6\u7684\u6982\u7387\u5373\u53ef\n#### \u4ee3\u7801\n\u5177\u4f53\u5b9e\u73b0\u89c1\u4ee3\u7801\n~~~cpp\ntypedef long long ll;\nll count(ll n)\n{\n    ll ans = 0, x = 1, cnt = 0, high = 0, num = n;\n    while (num)\n    {\n        high = num % 10;\n        num /= 10;\n        cnt++;\n    }\n    cnt--;\n    for (int i = 1; i <= cnt; i++, x *= 10)\n        ans += x;\n    if (high > 1)\n        ans += x;\n    else if (high == 1)\n        ans += n - x + 1;\n    return ans;\n}\nconst int N = 1005;\ndouble p[N], dp[N], ans;\nint n, k;\nll l, r;\nint main()\n{\n    ios :: sync_with_stdio(0);\n    cin >> n;\n    for (int i = 1; i <= n; i++)\n    {\n        cin >> l >> r;\n        ll tmp = count(r) - count(l - 1);\n        p[i] = 1.0 * tmp / (r - l + 1);\n    }\n    cin >> k;\n    dp[0] = 1;\n    for (int i = 1; i <= n; i++)\n        for (int j = n; j >= 0; j--)\n        {\n            dp[j] = dp[j] * (1 - p[i]);//\u5f53\u5b83\u4e0d\u8d21\u732e\u65f6\n            if (j > 0)\n                dp[j] += dp[j - 1] * p[i];\n        }\n    for (int i = 0; i <= n; i++)\n        if (i * 100 >= n * k)\n            ans += dp[i];\n    printf (\"%.15f\", ans);\n    return 0;\n}\n~~~\n[\u6700\u540e\u5b89\u5229\u4e00\u4e0b\u6211\u7684\u535a\u5ba2](https://blog.csdn.net/qq_43537070/article/details/107928701)",
        "postTime": 1597111166,
        "uid": 212040,
        "name": "smoothset",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 CF54C \u3010First Digit Law\u3011"
    },
    {
        "content": "- [CF54C First Digit Law](https://www.luogu.com.cn/problem/CF54C)\n\n\u6982\u7387 $dp$ \u5165\u95e8\u9898\u3002\n\n\u8bbe $f(x)$ \u662f $[1,x]$ \u4e2d $1$ \u5f00\u5934\u6570\u5b57\u7684\u4e2a\u6570\uff0c\u663e\u7136\u9700\u8981\u6c42\u7684 $[l_i,r_i]$ \u4e2d $1$ \u5f00\u5934\u6570\u5b57\u7684\u4e2a\u6570 $g(l_i,r_i)$ \u5c31\u53ef\u4ee5\u901a\u8fc7\u5dee\u5206\u5f97\u5230\uff0c\u800c $f(x)$ \u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u6570\u4f4d dp \u5f97\u5230\u3002\n\n\u663e\u7136\u5bf9\u4e8e\u7b2c $i$ \u4e2a\u6570\u5b57\u6765\u8bf4\uff0c\u5b83\u4e3a $1$ \u5f00\u5934\u7684\u6570\u5b57\u7684\u6982\u7387 \n\n$$p_i =\\frac {g(l_i,r_i)}{r-l+1}$$\n\n\u53ef\u4ee5 $O(n\\lg V)$ \u5f97\u5230\uff0c\u90a3\u4e48\u5269\u4e0b\u7684\u90e8\u5206\u5373\u4e3a\u6211\u4eec\u4f7f\u7528\u8fd9\u4e2a\u6982\u7387\u505a\u80cc\u5305\u3002\n\n> $f_{i,j}$ \u4e3a\u8003\u8651\u4e86\u524d $i$ \u4e2a\u6570\uff0c\u5176\u4e2d\u6709 $j$ \u4e2a $1$ \u5f00\u5934\u7684\u6570\u5b57\u7684\u6982\u7387\uff0c\u90a3\u4e48\u7b2c $i$ \u4f4d\u53ea\u6709\u4e24\u79cd\u53ef\u80fd\uff1a\u662f\u6216\u8005\u4e0d\u662f\u3002\u6613\u63a8\u5f97\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n> $$f_{i,j}=p_if_{i-1,j-1}+(1-p_i)f_{i-1,j}$$\n\n> \u662f $1$ \u5f00\u5934\u6570\u5b57\u7684\u6982\u7387\u662f $p_i$\uff0c\u4e0d\u662f\u7684\u6982\u7387\u662f $1-p_i$\uff0c\u4e0e\u524d\u9762\u7684\u6982\u7387\u7528\u4e58\u6cd5\u6cd5\u5219\u4e58\u5f97\uff0c\u800c\u4e24\u4e2a\u4e8b\u4ef6\u76f8\u4e92\u72ec\u7acb\uff0c\u7528\u52a0\u6cd5\u6cd5\u5219\u52a0\u8d77\u3002\n\n**Code**\n\n```cpp\n#include <bits/stdc++.h>\n#define Maxn 1005\n#define Nep(i, l, r) for(int i = l; i != r; ++ i)\n#define Rep(i, l, r) for(int i = l; i <= r; ++ i)\n#define rep(i, l, r) for(int i = l; i < r; ++ i)\n#define Lep(i, l, r) for(int i = l; i >= r; -- i)\n#define lep(i, l, r) for(int i = l; i > r; -- i)\n#define Max(a, b) a = std :: max(a, b)\n#define ll long long\n#define ull unsigned long long\n#define int long long\n\nint read() {\n\tint x = 1, res = 0, ch = getchar();\n\twhile(ch < '0' || ch > '9') { if(ch == '-') x = -1; ch = getchar(); }\n\twhile(ch >= '0' && ch <= '9') res = (res << 3) + (res << 1) + (ch ^ 48), ch = getchar();\n\treturn x * res;\n}\n\ndouble a[Maxn], f[Maxn];\nint p[Maxn];\n\nint calc(int x) {\n    if(x == 0) return 0;\n    p[0] = 1; Rep(i, 1, 18) p[i] = p[i - 1] * 10; int xx = x; \n    std :: vector <int> g; while(x) g.push_back(x % 10), x /= 10;\n    int l = g.size() - 1; int ans = 0;\n    rep(i, 0, l) ans += p[i]; if(g[l] == 1) ans += xx - p[l] + 1; \n    else ans += p[l]; return ans;\n}\n\ndouble solve(int x, int y) {\n    return (calc(x) - calc(y - 1)) * 1.0 / (x - y + 1);\n}\n\nsigned main() {\n    int n = read(), m, l, r; \n    Rep(i, 1, n) l = read(), r = read(), a[i] = solve(r, l);\n    m = ceil(read() * n * 1.0 / 100); f[0] = 1;\n    Rep(i, 1, n) Lep(j, n, 0) f[j] = f[j] * (1 - a[i]) + (j > 0) * f[j - 1] * a[i];\n    double ans = 0; Rep(i, m, n) ans += f[i]; printf(\"%.9g\", ans);\n}\n```",
        "postTime": 1661246685,
        "uid": 486187,
        "name": "2000VOLT",
        "ccfLevel": 0,
        "title": "CF54C"
    },
    {
        "content": "## $\\text{Description}$\n\u7ed9\u51fa $n$ \u4e2a\u6570\uff0c\u7136\u540e\u7ed9\u51fa $n$ \u884c\uff0c\u6bcf\u884c $l_i,r_i$\uff0c\u4ee3\u8868\u7b2c $i$ \u4e2a\u6570\u5728\u533a\u95f4 $[l_i,r_i]$ \u4e2d\uff0c\u6c42\u4e00\u4e2a\u6982\u7387\u4f7f\u5f97\u8fd9 $n$ \u4e2a\u6570\u4e2d\u6709 $k\\%$ \u7684\u6570\u662f $1$ \u5f00\u5934\u7684.  \n$n\\le1000,1\\le l_i\\le r_i\\le10^{18}$.\n## $\\text{Solution}$\n\u8bbe $f_x$ \u4e3a $[1,x]$ \u7b26\u5408\u6761\u4ef6\u7684\u6570\u7684\u4e2a\u6570\uff0c$sum_x=\\sum_{x=0}^x 10^i$\uff0c$w_x$ \u4e3a\u6ee1\u8db3 $10^i\\le x$ \u7684\u6700\u5927\u7684 $i$.  \n\u5c31\u6709\uff1a\n$$f_x=\\min(2\\times10^{w_x}-1,x)-10^{w_x}+1+sum_{w_x-1}$$\n\n\u90a3\u4e48\u7b2c $i$  \u4e2a\u6570\u7b26\u5408\u6761\u4ef6\u7684\u6982\u7387\u5c31\u662f $\\dfrac{f_{r_i}-f_{l_i-1}}{r_i-l_i+1}$.  \n\u6c42\u51fa\u6bcf\u4e2a\u53d8\u91cf\u7684\u6982\u7387\u4e4b\u540e\uff0c\u7b80\u5355 $n^2$ dp\u5373\u53ef.  \n\u7ec6\u8282\u4e0a\uff0c\u6ce8\u610f $10^{18}$ \u4e58 $10$ \u4f1a\u7206 longlong\uff0c\u6240\u4ee5\u6c42 $w_x$ \u5224\u65ad\u65f6\u8981\u4e58\u8f6c\u9664.  \n## $\\text{Code}$\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define ull unsigned long long\n//#define double long double\n#define debug(...) fprintf(stderr,__VA_ARGS__)\nconst int N=1050;\nconst int mod=1e9+7;\ninline ll read(){\n  ll x(0),f(1);char c=getchar();\n  while(!isdigit(c)){if(c=='-')f=-1;c=getchar();}\n  while(isdigit(c)){x=(x<<1)+(x<<3)+c-'0';c=getchar();}\n  return x*f;\n}\n\nint n,m,k;\nll sum[20],mi[20];\ndouble dp[N][N],p[N];\nll calc(ll x){\n  if(x==0) return 0;\n  int o=0;\n  while(x/mi[o]>=10) ++o;\n  return (o?sum[o-1]:0)+min(x,2*mi[o]-1)-mi[o]+1;\n}\nsigned main(){\n  #ifndef ONLINE_JUDGE\n  freopen(\"a.in\",\"r\",stdin);\n  freopen(\"a.out\",\"w\",stdout);\n  #endif\n  mi[0]=sum[0]=1;\n  for(int i=1;i<=18;i++){\n    mi[i]=mi[i-1]*10;sum[i]=sum[i-1]+mi[i];\n  }\n  n=read();\n  for(int i=1;i<=n;i++){\n    ll l=read(),r=read();\n    p[i]=1.0*(calc(r)-calc(l-1))/(r-l+1);\n    //printf(\"i=%d p=%lf\\n\",i,p[i]);\n  }\n  dp[0][0]=1;\n  for(int i=0;i<n;i++){\n    for(int j=0;j<=i;j++){\n      dp[i+1][j+1]+=dp[i][j]*p[i+1];\n      dp[i+1][j]+=dp[i][j]*(1-p[i+1]);\n    }\n  }\n  int k=read();\n  double res=0.0;\n  for(int i=(n*k+99)/100;i<=n;i++) res+=dp[n][i];\n  printf(\"%.10lf\",res);\n  return 0;\n}\n/*\n\n*/\n\n```\n",
        "postTime": 1639979185,
        "uid": 449265,
        "name": "wind_whisper",
        "ccfLevel": 10,
        "title": "CF54C First Digit Law"
    },
    {
        "content": "# \u9898\u76ee\n\n[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF54C)\n\n\u4eba\u8bdd\u8868\u8ff0\uff1a\n\n\u7ed9\u4f60\u4e00\u4e2a $n$ \u8868\u793a\u6570\u5217 $a$ \u6709\u591a\u5c11\u4e2a\u6570\uff1b\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u6570\uff0c\u7ed9\u51fa $l_i,r_i$ \u8868\u793a\u6570 $a_i\\in [l_i,r_i]$\uff1b\n\n\u7ed9\u51fa $k$\uff0c\u8ba9\u4f60\u6c42\u6570\u5217 $a$ \u4e2d\u6709\u81f3\u5c11 $\\frac{n\\times k}{100}$ \u4e2a\u6570\u6700\u9ad8\u4f4d\u4e3a $1$ \u7684\u6982\u7387\u5e76\u8f93\u51fa\uff1b\n\n# \u9898\u89e3\n\n\u5de7\u5999\u7684\u6570\u4f4d $DP$ + \u6982\u7387 $DP$ + \u80cc\u5305\uff08\u867d\u7136\u8bf4\u9898\u76ee\u8868\u8ff0\u4e0d\u6e05\u5c31\u662f\u4e86\n\n\u53ef\u4ee5\u5229\u7528 $l_i,r_i$ \u6c42\u51fa $a_i$ \u6700\u9ad8\u4f4d\u4e3a $1$ \u7684\u6982\u7387 $p_i$.\n\n\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u6709\u4e86\u6bcf\u4e00\u4f4d\u51fa\u73b0\u5408\u6cd5\u6570\u5b57\u7684\u6982\u7387\uff0c\u8003\u8651\u600e\u4e48\u62fc\u51d1\u51fa\u7b54\u6848\n\n\u5173\u6ce8\u9898\u76ee\uff0c\u201c\u6c42\u5728 $n$ \u4e2a\u6570\u4e2d\uff0c\u81f3\u5c11\u6709 $k$ \u4e2a\u6570\u6700\u9ad8\u4f4d\u4e3a $1$ \u7684\u6982\u7387\u201d\uff0c\u53d1\u73b0\u6709\u70b9\u50cf\u80cc\u5305\n\n\u8003\u8651\u5b9a\u4e49\u72b6\u6001 $f[i][j]$ \u8868\u793a\u524d $i$ \u4e2a\u6570\u4e2d\uff0c\u6709 $j$ \u4e2a\u6570\u7684\u6700\u9ad8\u4f4d\u4e3a $1$ \u7684\u6982\u7387\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u8f6c\u79fb\uff1a\n\n\u5bf9\u4e8e $j=0$\uff0c\u5b9e\u9645\u4e0a\u53ea\u53ef\u80fd\u7531 $f[i-1][0]$ \u4e00\u79cd\u60c5\u51b5\u8f6c\u79fb\u8fc7\u6765\uff0c\u800c\u8fd9\u4e00\u4f4d\u4e5f\u53ea\u80fd\u9009\u62e9 $0$\uff0c\u90a3\u4e48\u5c31\u6709\u72b6\u8f6c\n$$\nf[i][0]=f[i-1][0]\\times (1-p[i])\n$$\n\u5bf9\u4e8e $j>0$\uff0c\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\n\n- \u8fd9\u4e00\u4f4d\u9009\u975e $1$ \u5f00\u5934\u7684\u6570\u5b57\uff0c\u7531 $f[i-1][j]$ \u8f6c\u79fb\uff1b\n- \u8fd9\u4e00\u4f4d\u9009\u62e9 $1$ \u5f00\u5934\u7684\u6570\u5b57\uff0c\u7531 $f[i-1][j-1]$ \u8f6c\u79fb\uff1b\n\n\u8fd9\u4e24\u79cd\u60c5\u51b5\u76f8\u4e92\u72ec\u7acb\uff0c\u7528\u52a0\u6cd5\u8fde\u63a5\uff0c\u90a3\u4e48\u6709\u8f6c\u79fb\n$$\nf[i][j]=f[i-1][j]\\times (1-p[i])+f[i-1][j-1]\\times p[i]\n$$\n\u6700\u540e\u7edf\u8ba1\u7b54\u6848\uff0c\u7531\u4e8e\u90fd\u662f\u72ec\u7acb\uff0c\u4e5f\u76f4\u63a5\u76f8\u52a0\u5373\u53ef\n\n```cpp\nhttps://www.cnblogs.com/Arextre/p/13473866.html\n```\n",
        "postTime": 1597111322,
        "uid": 125355,
        "name": "Vladilena",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF54C \u3010First Digit Law\u3011"
    }
]
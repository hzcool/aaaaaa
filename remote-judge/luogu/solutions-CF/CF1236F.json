[
    {
        "content": "\u5148%\u4e00\u53d1zyk\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/p6sdawv6.png)\n\n\u5148\u8003\u8651\u628a\u65b9\u5dee\u62c6\u5f00\n$$D(X)=\\sum_{i}(x_i-E(X))^2\\times p_i$$\n$$D(X)=\\sum_{i}x_i^2\\times p_i-2\\times \\sum_{i}x_i\\times E(X)\\times p_i+\\sum_{i}E(X)^2\\times p_i$$\n$$D(X)=E(X^2)-2\\times E(X)^2+E(X)^2\\times \\sum_{i}p_i$$\n$$\\sum_ip_i=1$$\n$$D(X)=E(X^2)-E(X)^2$$\n\n\u8bbe$X$\u4e3a\u8054\u901a\u5757\u4e2a\u6570\uff0c$a$\u4e3a\u70b9\u6570\uff0c$b$\u4e3a\u8fb9\u6570\uff0c$c$\u4e3a\u73af\u6570\n\u5219\u6709\n$$X=a-b+c$$\n\u5373\u8054\u901a\u5757\u4e2a\u6570\u7b49\u4e8e\u70b9\u6570-\u8fb9\u6570+\u73af\u6570\n\n\u6839\u636e\u671f\u671b\u7684\u7ebf\u6027\u6027\n\n$$E(X^2)=E((a-b+c)^2)$$\n$$=E(a^2+b^2+c^2+2ac-2ab-2bc)$$\n$$=E(a^2)+E(b^2)+E(c^2)+2E(ac)-2E(ab)-2E(bc)$$\n\n\u7136\u540e\u8003\u8651\u6bcf\u4e2a\u671f\u671b\u600e\u4e48\u6c42\n### $E(a^2)$\n#### \u89e3\u6cd5\u4e00\n\u76f4\u63a5\u5199\u51fa\u5f0f\u5b50$E(a^2)=\\frac{\\sum_{i=0}^{n}i^2\\times C_{n}^{i}}{2^n}$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u5df2\u7ecf\u53ef\u4ee5$O(n)$\u7b97\u4e86\n\n\u4e0d\u8fc7\u518d\u4f18\u5316\u4e00\u4e0b\uff0c\u6839\u636e$mC_{m}^{n}=nC_{m-1}^{n-1}$,\u4e0a\u5f0f\u663e\u7136\u7b49\u4e8e$\\frac{n\\times (n+1)}{4}$\n#### \u89e3\u6cd5\u4e8c\n$E(a^2)$\u7b49\u4e8e\u679a\u4e3e\u4e24\u4e2a\u70b9\uff0c\u53ef\u4ee5\u91cd\u590d\uff0c\u6c42\u4ed6\u4eec\u540c\u65f6\u5b58\u5728\u7684\u6982\u7387\u7684\u548c\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u70b9$i$,\u8003\u8651\u53e6\u5916\u4e00\u4e2a\u70b9$j$\n\n- \u82e5$i=j$,\u6982\u7387\u4e3a$\\frac{1}{2}$\n- \u82e5$i\\not=j$,\u6982\u7387\u4e3a$\\frac{1}{4}$\n\n\u6700\u540e\u7684\u671f\u671b\u4e3a$\\frac{n\\times(n+1)}{4}$\n\n### $E(b^2)$\n$E(b^2)$\u7b49\u4e8e\u679a\u4e3e\u4e24\u6761\u8fb9\uff0c\u53ef\u4ee5\u91cd\u590d\uff0c\u6c42\u4ed6\u4eec\u540c\u65f6\u5b58\u5728\u7684\u6982\u7387\u7684\u548c\n\n\u5bf9\u4e8e\u6bcf\u6761\u8fb9$i$,\u8003\u8651\u53e6\u4e00\u6761\u8fb9$i$\n\n- \u82e5$i=j$\uff0c\u6982\u7387\u4e3a$\\frac{1}{4}$\n- \u82e5$i$\u548c$j$\u76f8\u8fde\uff0c\u6982\u7387\u4e3a$\\frac{1}{8}$\n- \u82e5$i$\u548c$j$\u6ca1\u6709\u4ec0\u4e48\u5173\u7cfb\uff0c\u6982\u7387\u4e3a$\\frac{1}{16}$\n\n\u8003\u8651\u8bb0\u5f55\u6bcf\u4e2a\u70b9\u7684\u5ea6\u6570\uff0c\u56e0\u4e3a\u6ca1\u6709\u91cd\u8fb9\uff0c\u663e\u7136\u4e0d\u4f1a\u91cd\u590d\u8ba1\u6570\n\n### $E(c^2)$\n$E(c^2)$\u7b49\u4e8e\u679a\u4e3e\u4e24\u4e2a\u73af\uff0c\u53ef\u4ee5\u91cd\u590d\uff0c\u6c42\u4ed6\u4eec\u540c\u65f6\u5b58\u5728\u7684\u6982\u7387\u7684\u548c\n\n\u8003\u8651\u5148\u7b97\u51fa\u6bcf\u4e2a\u73af$i$\u7684\u5927\u5c0f$size_i$,\u5171$cnt$\u4e2a\u73af\n\n\u90a3\u4e48\u7b2c$i$\u4e2a\u73af\u5b58\u5728\u7684\u6982\u7387$P_i=\\frac{1}{2^{size_i}}$\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u73af$i$,\u8003\u8651\u53e6\u4e00\u4e2a\u73af$i$\n\n- \u82e5$i=j$\uff0c\u6982\u7387\u4e3a$P_i$\n- \u82e5$i$\u4e0e$j$\u6709\u4e00\u4e2a\u70b9\u76f8\u540c\uff0c\u6982\u7387\u4e3a$P_i\\times P_j\\times 2$\n- \u82e5$i$\u4e0e$j$\u6ca1\u6709\u4ec0\u4e48\u5173\u7cfb\uff0c\u6982\u7387\u4e3a$P_i\\times P_j$\n\n### $E(ab)$\n$E(b^2)$\u7b49\u4e8e\u679a\u4e3e\u4e00\u4e2a\u70b9\u548c\u4e00\u6761\u8fb9\uff0c\u6c42\u4ed6\u4eec\u540c\u65f6\u5b58\u5728\u7684\u6982\u7387\u7684\u548c\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u70b9$i$,\u8003\u8651\u6bcf\u4e00\u6761\u8fb9$i$\n\n- \u82e5$i$\u662f$j$\u7684\u4e00\u4e2a\u9876\u70b9\uff0c\u6982\u7387\u4e3a$\\frac{1}{4}$\n- \u82e5$i$\u548c$j$\u6ca1\u6709\u4ec0\u4e48\u5173\u7cfb\uff0c\u6982\u7387\u4e3a$\\frac{1}{8}$\n\n### $E(ac)$\n$E(b^2)$\u7b49\u4e8e\u679a\u4e3e\u4e00\u4e2a\u70b9\u548c\u4e00\u4e2a\u73af\uff0c\u6c42\u4ed6\u4eec\u540c\u65f6\u5b58\u5728\u7684\u6982\u7387\u7684\u548c\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u70b9$i$,\u8003\u8651\u6bcf\u4e00\u4e2a\u73af$i$\n\n- \u82e5$i$\u5728$j$\u4e0a\uff0c\u6982\u7387\u4e3a$P_j$\n- \u82e5$i$\u548c$j$\u6ca1\u6709\u4ec0\u4e48\u5173\u7cfb\uff0c\u6982\u7387\u4e3a$P_j\\times \\frac{1}{2}$\n### $E(bc)$\n$E(b^2)$\u7b49\u4e8e\u679a\u4e3e\u4e00\u6761\u8fb9\u548c\u4e00\u4e2a\u73af\uff0c\u6c42\u4ed6\u4eec\u540c\u65f6\u5b58\u5728\u7684\u6982\u7387\u7684\u548c\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u73af$i$,\u8003\u8651\u6bcf\u4e00\u6761\u8fb9$i$\n\n- \u82e5$j$\u5728$i$\u4e0a\uff0c\u6982\u7387\u4e3a$P_i$\n- \u82e5$j$\u6709\u4e00\u4e2a\u70b9\u5728$i$\u4e0a\uff0c\u6982\u7387\u4e3a$P_i\\times \\frac{1}{2}$\n- \u82e5$i$\u548c$j$\u6ca1\u6709\u4ec0\u4e48\u5173\u7cfb\uff0c\u6982\u7387\u4e3a$P_i\\times \\frac{1}{4}$\n\n### $E(X)$\n$$E(a)=\\frac{n}{2}$$\n$$E(b)=\\frac{m}{4}$$\n$$E(c)=\\sum_{i=1}^{cnt}P_i$$\n$$E(X)=E(a)-E(b)+E(c)$$\n\n[\u4ee3\u7801\u5728\u8fd9\u91cc](https://www.luogu.com.cn/paste/1pt1bpz1)",
        "postTime": 1589875649,
        "uid": 114409,
        "name": "9AC8E2",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1236F \u3010Alice and the Cactus\u3011"
    },
    {
        "content": "\u795e\u4ed9\u9898\u7adf\u7136\u6ca1\u9898\u89e3\uff1f\u4f5c\u4e3a\u51fa\u9898\u4eba\u7684\u597d$(xi\u01ceo)$\u670b$(f\u011bn)$\u53cb$(s\u012b)$\u5199\u4e2a\u9898\u89e3\u3002\n\n\u5148\u8003\u8651\u5982\u4f55\u8ba1\u7b97\u8fde\u901a\u5757\u4e2a\u6570\uff1a\u70b9\u6570-\u8fb9\u6570+\u73af\u6570\u3002\n\n\u518d\u8003\u8651\u628a\u671f\u671b\u62c6\u5f00\uff1a\n\n$E([x-E(x)]^2)=E(x^2-2xE(x)+E(x)^2)=E(x^2)-E(x)^2$\n\n\u8003\u8651\u62c6\u5f00$x^2$\uff1a\u8bbe\u70b9\u6570\u4e3a$a$\uff0c\u8fb9\u6570\u4e3a$b$\uff0c\u73af\u6570\u4e3a$c$\uff0c\u90a3\u4e48$x=a-b+c  => x^2=a^2+b^2+c^2-2ab-2bc+2ac$ \u3002\n\n\u7136\u540e\u8ba8\u8bba\u70b9\u5728\u73af\u4e0a\uff0c\u8fb9\u5728\u73af\u4e0a\uff0c\u8fb9\u7684\u4e00\u4e2a\u70b9\u5728\u73af\u4e0a\uff0c\u73af\u76f8\u4ea4\u8fd9\u4e9b\u60c5\u51b5\u3002\n\n\u7406\u8bba\u4e0a\u8003\u8651\u6240\u6709\u76f8\u4ea4\u548c\u4e0d\u76f8\u4ea4\u7684\u60c5\u51b5\u5e94\u8be5\u662f\u7ebf\u6027\u7684\uff0c\u5b98\u65b9\u9898\u89e3\u7ed9\u51fa\u6c42\u9006\u5143\u8981$O(nlogn)$\uff0c\u5b9e\u9645\u4e0a\u53ef\u4ee5\u7ebf\u6027\u9884\u5904\u7406\uff0c\u6240\u4ee5\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u7ebf\u6027\u7684\u3002\n\n$PS:$ \u7279\u522b\u9e23\u8c22 @\u53cc\u7ba1\u8367\u5149\u706f @iostream \u4e24\u4f4d\u795e\u4ed9\u7684\u6307\u5bfc\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<stdio.h>\n#include<vector>\n#define it register int\n#define il inline\n#define P 1000000007\nusing namespace std;\nconst int N=1000005; \nint d[N],fa[N],i2[N],h[N],nxt[N],adj[N],n,m,rd[N],u,v,t,tot,siz[N],sum[N],sum2[N],sd[N];\nbool vs[N];\nvector<int> vec[N];\nil void add(){nxt[++t]=h[u],h[u]=t,adj[t]=v,nxt[++t]=h[v],h[v]=t,adj[t]=u;}\nvoid dfs(it x){\n\tvs[x]=1;\n\tfor(it i=h[x],j,k;i;i=nxt[i])\n\t\tif((j=adj[i])^fa[x]){\n\t\t\tif(vs[j]){\n\t\t\t\tif(d[x]>d[j]){\n\t\t\t\t\t++tot;\n\t\t\t\t\tfor(k=x;k^j;k=fa[k]) vec[tot].push_back(k);\n\t\t\t\t\tvec[tot].push_back(j),siz[tot]=vec[tot].size();\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tfa[j]=x,d[j]=d[x]+1,dfs(j);\n\t\t}\n} \nil int mo(it x){while(x<0) x+=P;while(x>=P) x-=P;return x;}\nil int pf(it x){return 1ll*x*x%P;}\nil int E(){\n\tit ans=0;\n\tfor(it i=1;i<=tot;++i) ans=mo(ans+i2[siz[i]]);\n\treturn mo(ans+1ll*n*i2[1]%P-1ll*m*i2[2]%P);\n}\nil int vv(){return (pf(n)+n+0ll)*i2[2]%P;}  \nil int cc(){\n\tit ans=0,i;\n\tfor(i=1;i<=tot;++i) ans=mo(ans+i2[siz[i]]);\n\tans=mo(ans+1ll*ans*ans%P);\n\tfor(i=1;i<=tot;++i) ans=mo(ans-i2[siz[i]<<1]);\n\tfor(i=1;i<=n;++i) ans=mo(ans+pf(sum[i])-sum2[i]);\n\treturn ans;\n} \nil int ee(){\n\tit ans=mo(pf(m)+m);\n\tfor(it i=1;i<=n;++i) ans=mo(ans+pf(rd[i]));\n\treturn 1ll*ans*i2[4]%P;\n}\nil int vc(){\n\tit ans=0;\n\tfor(it i=1;i<=tot;++i) ans=mo(ans+1ll*(siz[i]+n)*i2[siz[i]+1]%P);\n\treturn ans;\n}  \nil int ve(){return (2ll+n)*m%P*i2[3]%P;} \nil int ce(){\n\tit ans=0;\n\tfor(it i=1;i<=tot;++i)\n\t\tans=mo(ans+1ll*i2[siz[i]]*(siz[i]+1ll*sd[i]*i2[1]%P+1ll*(m-siz[i]-sd[i])*i2[2]%P)%P);\n\treturn ans;\n}\nint main(){\n\tscanf(\"%d%d\",&n,&m);it i,j,x=(n>m?n:m);\n\ti2[0]=1,i2[1]=P+1>>1;\n\tfor(i=2,x=x<20?20:x;i<=x;++i) i2[i]=1ll*i2[i-1]*i2[1]%P;\n\tfor(i=1;i<=m;++i) scanf(\"%d%d\",&u,&v),++rd[u],++rd[v],add();\n\tdfs(1);\n\tfor(i=1;i<=tot;++i){\n\t\tfor(j=0;j<siz[i];++j)\n\t\t\tx=vec[i][j],sd[i]+=rd[x],sum[x]=mo(sum[x]+i2[siz[i]]),sum2[x]=mo(sum2[x]+pf(i2[siz[i]]));\n\t\tsd[i]-=(siz[i]<<1);\n\t} \n\tprintf(\"%lld\",((vv()+cc()+ee()+(vc()-ve()-ce())*2ll%P-pf(E()))%P+P)%P);\n\treturn 0;\n}\n",
        "postTime": 1581162839,
        "uid": 31040,
        "name": "\u96ea\u989c",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1236F \u3010Alice and the Cactus\u3011"
    }
]
[
    {
        "content": "## $\\mathrm{Problem}$\n- $n$ \u4e2a\u70b9\u7684\u6709\u5411\u5b8c\u5168\u56fe\u3002\n- $i \\to j$ \u7684\u8fb9\u6bcf\u5929\u51fa\u73b0\u7684\u6982\u7387\u5747\u4e3a $p_{i,j}$\uff0c\u82e5 $i = j$\uff0c\u6709 $p_{i,j} = 1$\u3002\n- \u6bcf\u5929\u9009\u62e9\u4e00\u6761\u5b58\u5728\u7684\u51fa\u8fb9\u8d70\u8fc7\u53bb\u3002\n- \u6c42\u6700\u4f18\u7b56\u7565\u4e0b\u4ece $1$ \u5230 $n$ \u7684\u671f\u671b\u5929\u6570\u3002\n- $n \\le 10^3$\u3002\n\n---\n## $\\mathrm{Solution}$\n~~\u641e\u4e86\u4e00\u5929\u7684\u671f\u671b\u795e\u9898~~ \n\n\u6211\u4eec\u8bbe $E_x$ \u8868\u793a\u8282\u70b9 $x$ \u63a5\u4e0b\u6765\u8981\u5230\u8282\u70b9 $n$ \u7684\u671f\u671b\u5929\u6570\u3002\n\n\u6709\u4e00\u4e9b\u663e\u7136\u4f46\u5f88\u91cd\u8981\u7684\u7ed3\u8bba\uff0c\u5c31\u662f\uff1a\n- \u8282\u70b9 $x$ \u63a5\u4e0b\u6765\u8f6c\u79fb\u7684\u70b9\u4e00\u5b9a\u662f\u5f53\u524d\u5f00\u653e\u7684\u51fa\u8fb9\u4e2d $E$ \u503c\u6700\u5c0f\u7684\u4e00\u4e2a\u70b9\u3002\n- \u5bf9\u4e8e\u82e5\u5b58\u5728 $x,y$ \u6ee1\u8db3 $E_x<E_y$\uff0c\u5219 $x$ \u7684\u671f\u671b\u51b3\u7b56\u70b9\u4e00\u5b9a\u4e0d\u5305\u542b$y$\u3002\n\n\u5bf9\u4e8e\u7ed3\u8bba2\uff1a\u5f53 $x$ \u5df2\u7ecf\u88ab\u82e5\u5e72\u70b9\u66f4\u65b0\u8fc7\u4e86\uff0c\u6b64\u65f6\u679a\u4e3e\u5230 $y$ \u4e86\uff0c\u5982\u679c\u4f60\u8ba1\u7b97\u4e86 $y$ \u7684\u8d21\u732e\u90a3\u4e48\u4e00\u5b9a\u4f1a\u4f7f\u5f53\u524d\u8282\u70b9 $x$ \u7684\u671f\u671b\u503c\u589e\u52a0\uff0c\u56e0\u6b64 $x$ \u4e00\u5b9a\u4e0d\u4f1a\u88ab $y$ \u66f4\u65b0\u5230\u3002\n\n\u56e0\u6b64\u6211\u4eec\u4fbf\u6709\u4e86\u7b97\u6cd5\u7684\u5927\u81f4\u601d\u8def\uff1a\u6bcf\u4e00\u6b21\u90fd\u5bfb\u627e\u4e00\u4e2a\u671f\u671b\u503c\u6700\u5c0f\u7684\u70b9\uff0c\u5e76\u56fa\u5b9a\u8fd9\u4e2a\u70b9\u7684\u671f\u671b\u503c\uff1b\u540c\u65f6\u4e5f\u7528\u8fd9\u4e2a\u70b9\u7684\u671f\u671b\u503c\u53bb\u66f4\u65b0\u672a\u88ab\u66f4\u65b0\u7684\u671f\u671b\u503c\u3002\n\n\u8be5\u7b97\u6cd5\u7684\u601d\u8def\u4e0eDijkstra\u7b97\u6cd5\u7c7b\u4f3c\u3002\n\n\u8003\u8651\u5982\u4f55\u8f6c\u79fb\uff1a\u6211\u4eec\u53d1\u73b0\u82e5\u6211\u4eec\u8981\u8f6c\u79fb\u8282\u70b9 $i$\uff0c\u9700\u8981\u4fdd\u8bc1 $\\forall j$ \u5728$E_j<E_i$\u7684\u60c5\u51b5\u4e0b\u901a\u9053\u662f\u5173\u95ed\u7684\uff0c\u56e0\u4e3a\u4e0a\u9762\u63d0\u5230\u8d2a\u5fc3\u7684\u539f\u5219\u662f\u9009\u53d6\u671f\u671b\u503c\u6700\u5c0f\u7684\u8282\u70b9\uff0c\u4e14 $i$ \u7684\u901a\u9053\u662f\u5f00\u7684\u3002\u56e0\u6b64\u5047\u8bbe\u5df2\u7ecf\u5b8c\u6210\u8f6c\u79fb\u7684\u70b9\u4e3a$a_1,a_2,...,a_m$\u4e14\u6ee1\u8db3$E_1<E_2<...<E_m$\u3002\n\n$$E_i=\\sum_{j=1}^{m} E_{a_j}\\times p_{i,a_j} \\prod_{k=1}^{j-1} (1-p_{i,a_k})$$\n\n\u89c2\u5bdf\u5230\u6211\u4eec\u6b64\u65f6\u8ba1\u7b97\u7684 $E_i$ \u4ec5\u4ec5\u662f\u4e0e $i$ \u76f8\u8fde\u7684\u901a\u9053\u4e2d\u81f3\u5c11\u4e00\u6761\u5f00\u542f\u65f6\u7684\u8d21\u732e\uff0c\u53ef\u80fd\u5b58\u5728\u901a\u9053\u4e00\u6761\u90fd\u4e0d\u5f00\u542f\u7684\u60c5\u51b5\u3002\u6211\u4eec\u53d1\u73b0\uff0c\u901a\u9053\u6bcf\u6761\u90fd\u4e0d\u5f00\u542f\u7684\u6982\u7387\u4e3a$\\sum p_{i,j}$,\u5219\u901a\u9053\u81f3\u5c11\u5f00\u542f\u7684\u6982\u7387\u4e3a$1-\\sum p_{i,j}$\uff0c\u5219\u81f3\u5c11\u4e00\u6761\u5f00\u542f\u7684\u5929\u6570\u662f\uff1a$\\frac{1}{1-\\sum p_{i,j}}$\u3002\n\n\u56e0\u6b64\u6211\u4eec\u7684\u671f\u671b\u5929\u6570\u5c31\u53d8\u6210\u4e86$E_x/(1-\\prod_{y}^{E_y<E_x}p_{x,y})$\u3002\n\n\u5219\u4e0a\u8ff0\u8f6c\u79fb\u65b9\u7a0b\u5c31\u53d8\u6210\u4e86\uff1a\n$$E_i=\\sum_{j=1}^{m}[E_{a_j}/(1-\\prod_{k}^{E_{a_k}<E_{a_j}}p_{a_j,a_k})]\\times p_{i,a_j} \\prod_{k=1}^{j-1} (1-p_{i,a_k})$$\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u6109\u5feb\u7684\u8f6c\u79fb\u8fa3\n\n---\n## $\\mathrm{Code}$\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\nconst int N = 2000;\n\nint n;\nint vis[N];\ndouble s[N], P[N][N], E[N];\n\nint read(void)\n{\n\tint s = 0, w = 0; char c = getchar();\n\twhile (!isdigit(c)) w |= c == '-', c = getchar();\n\twhile (isdigit(c)) s = s*10+c-48, c = getchar();\n\treturn w ? -s : s;\n}\n\nint main(void)\n{\n\tn = read();\n\tfor(int i=1;i<=n;++i)\n\t\tfor (int j=1;j<=n;++j)\n\t\t\tP[i][j] = 1.0 * read() / 100.0;\n\tif (n == 1) return puts(\"0\"), 0;\n\tvis[n] = 1, E[n] = 0;\n\tfor (int i=1;i<=n;++i) {\n\t\tE[i] = 1;\n\t\ts[i] = 1 - P[i][n];\n\t}\n\tfor (int i=1;i<=n;++i)\n\t{\n\t\tint p = 0;\n\t\tdouble Min = 1e18;\n\t\tfor (int j=1;j<=n;++j) \n\t\t\tif (vis[j] == 0 && 1.0 * E[j] / (1 - s[j]) < Min) \n\t\t\t\tMin = 1.0 * E[j] / (1 - s[j]), p = j;\n\t\tvis[p] = 1;\n\t\tif (p == 1) return printf(\"%.15lf\\n\", Min) * 0;\n\t\tfor (int j=1;j<=n;++j)\n\t\t\tE[j] += 1.0 * E[p] / (1 - s[p]) * P[j][p] * s[j], s[j] *= 1.0 - P[j][p];\n\t}\n\treturn 0;\n} \n```\n",
        "postTime": 1600686164,
        "uid": 33243,
        "name": "\u5c0f\u5468\u732a\u732a",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF605E \u3010Intergalaxy Trips\u3011"
    },
    {
        "content": "## CF605E Intergalaxy Trips \u9898\u89e3\n\n**\u671f\u671b\u597d\u9898\uff08\u786e\u4fe1\uff09**\n\n\u603b\u4e4b\u5c31\u662f\uff0c\u671f\u671b\u505a\u5f97\u592a\u5c11\uff0c\u4eba\u592a\u83dc\uff0c\u4e00\u4e0a\u5348\u505a\u4e0d\u51fa\u6765\u3002\n\n#### \u9898\u610f\u4e0d\u518d\u8d58\u8ff0\u5566\n\n[CF605E Intergalaxy Trips](https://www.luogu.com.cn/problem/CF605E)\n\n#### \u6734\u7d20\u5206\u6790\n\n\u9996\u5148\u6709\u4e2a\u601d\u8def\uff0c\u5982\u679c\u6211\u4eec\u8bbe $f_i$ \u4e3a $i\\to n$ \u7684\u671f\u671b\u8017\u65f6\uff0c\u90a3\u4e48\u5f53\u6211\u4eec\u8f6c\u79fb\u65f6\uff0c\u6211\u4eec**\u4e00\u5b9a\u4e0d\u4f1a\u627e\u6bd4\u5f53\u524d\u70b9\u66f4\u52a3\u7684\u70b9\u8f6c\u79fb**\u3002\u56e0\u4e3a\u90a3\u6837\u5c31\u662f\u8dd1\u4e2a\u81ea\u73af\u4e5f\u6bd4\u8dd1\u90a3\u4e2a\u52a3\u7684\u70b9\u5212\u7b97\uff0c\u6240\u4ee5\u8f6c\u79fb\u7684\u65f6\u5019\u53ea\u8003\u8651\u6bd4\u5f53\u524d\u70b9\u4f18\u7684\u70b9\u5373\u53ef\u3002\n\n\u95ee\u9898\u662f\u81ea\u5df1\u4e0d\u77e5\u9053\uff0c\u522b\u7684\u4e5f\u4e0d\u77e5\u9053\uff0c\u600e\u4e48\u5224\u65ad\uff1f\u8fd9\u4e2a\u5c31\u8981\u770b\u8f6c\u79fb\u65b9\u7a0b\u4e86\u3002\n\n#### \u72b6\u6001\u8f6c\u79fb\n\n\u56e0\u4e3a\u4f1a\u9009\u62e9\u6700\u4f18\u7b56\u7565\uff0c\u6240\u4ee5\u5230\u4e86\u67d0\u4e2a\u70b9\uff0c\u91c7\u53d6\u67d0\u4e2a\u72b6\u6001\u7684\u552f\u4e00\u53ef\u80fd\u5c31\u662f**\u6bd4\u81ea\u5df1\u4f18\u7684\u72b6\u6001\u53d6\u4e0d\u5230\u4e86**\uff0c\u8fd9\u4e2a\u4e1c\u897f\u662f\u53ef\u4ee5\u63cf\u8ff0\u51fa\u6765\u7684\u3002\u800c\u4e14\u5982\u679c\u6240\u6709\u72b6\u6001\u90fd\u53d6\u4e0d\u5230\u90a3\u5c31\u81ea\u73af\uff0c\u8fd9\u662f\u6700\u52a3\u7684\u8f6c\u79fb\uff0c\u4e0d\u8fc7\u4e5f\u8981\u8003\u8651\u3002\u4e8e\u662f\u6211\u4eec\u7684\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$\nf_i=\\sum_{j}^{f_j<f_i}p_{i,j}f_j\\prod_k^{f_k<f_j}(1-p_{i,k})+f_i\\prod_{j}^{f_j<f_i}(1-p_{i,j})+1\n$$\n\u79fb\u9879\u7136\u540e\u9664\u4e00\u4e0b\u53ef\u4ee5\u5f97\u5230\uff1a\n$$\nf_i=\\frac{\\sum_{j}^{f_j<f_i}p_{i,j}f_j\\prod_k^{f_k<f_j}(1-p_{i,k})+1}{1-\\prod_{j}^{f_j<f_i}(1-p_{i,j})}\n$$\n\n#### \u5b9e\u73b0\u601d\u8def\n\n\u9996\u5148\uff0c\u5bf9\u4e8e\u4e0a\u5f0f\u4e2d\u7684\u66f4\u65b0 $i$ \u7684 $j$\uff0c\u663e\u7136\u662f\u8003\u8651\u7684\u8d8a\u591a**\u503c\u662f\u5355\u8c03\u4e0d\u589e\u7684**\uff0c\u4e0d\u7136\u4f60\u4e5f\u4e0d\u4f1a\u7528\u90a3\u4e2a\u70b9\u53bb\u8f6c\u79fb\u3002\u7136\u540e\u6ce8\u610f\uff0c**\u4e00\u4e2a\u70b9\u662f\u4e0d\u53ef\u80fd\u6bd4\u5c06\u5b83\u8f6c\u79fb\u7684\u70b9\u66f4\u4f18**\u7684\uff0c\u56e0\u4e3a\u8981\u591a\u8d70\u4e00\u6b65\u3002\n\n\u8fd9\u8bf4\u660e\u4e86\u4ec0\u4e48\uff1f\u5f53\u4e00\u4e2a\u70b9\u662f\u6240\u6709\u5df2\u77e5\u72b6\u6001\u4e2d\u6700\u5c0f\u7684\uff0c\u90a3\u4e48\u5b83\u5c31\u4e0d\u4f1a\u518d\u88ab\u522b\u7684\u72b6\u6001\u8f6c\u79fb\u4e86\uff0c\u8fd9\u4e2a\u6027\u8d28\u5f88\u7c7b\u4f3c Dijkstra \uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u6bcf\u4e00\u8f6e\u9009\u62e9\u6700\u5c0f\u7684\u90a3\u4e2a\u6ca1\u6709\u8fdb\u884c\u8fc7\u8f6c\u79fb\u7684\u70b9\uff0c\u5c06\u5176\u5b83\u6ca1\u6709\u8fdb\u884c\u8fc7\u8f6c\u79fb\u7684\u70b9\u66f4\u65b0\u4e00\u4e0b\uff0c\u7c7b\u4f3c\u6734\u7d20\u7684 $O(n^2)$ \u7684 Dijkstra \uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u80fd\u5f97\u5230\u7b54\u6848\u3002\n\n\u6ce8\u610f\u8fd9\u91cc\u201c\u8f6c\u79fb\u201d\u6307\u7684\u662f**\u7528\u5f53\u524d\u70b9\u53bb\u66f4\u65b0\u522b\u7684\u70b9\u7684\u7b54\u6848**\uff0c\u5373\u5bf9\u4e8e\u522b\u7684\u70b9 $i$ \u6765\u8bf4\uff0c\u5b83\u76f8\u5f53\u4e8e\u516c\u5f0f\u91cc\u9762\u7684 $j$\u3002 \n\n#### \u5b9e\u73b0\u7ec6\u8282\n\n\u6211\u4eec\u53ef\u4ee5\u5206\u522b\u7ef4\u62a4\u6bcf\u4e2a\u70b9\u7684 $f_i,g_i,h_i$\uff0c$f_i$ \u4e0e\u4e0a\u6587\u542b\u4e49\u76f8\u540c\uff0c\u4e09\u8005\u5173\u7cfb\u53ef\u8868\u793a\u4e3a\uff1a\n$$\nf_i=\\frac{g_i}{1-h_i}\n$$\n\u800c\u4e14\u66f4\u6709\u8da3\u7684\u662f\uff0c\u5f53\u6211\u4eec**\u7528 $j$ \u66f4\u65b0 $i$ \u65f6**\uff08\u6ce8\u610f\u4e0d\u662f\u4efb\u610f\u65f6\u523b\uff09\uff0c\u8fd8\u6ca1\u88ab $j$ \u66f4\u65b0\u8fc7\u7684 $h_i$ \u6070\u597d\u7b49\u4e8e $\\prod_k^{f_k<f_j}(1-p_{i,k})$\uff0c\u4e5f\u5c31\u662f\u6bcf\u4e00\u8f6e\u66f4\u65b0\u6211\u4eec\u53ef\u4ee5\u8fd9\u4e48\u5199\uff1a\n\n$g_i+=p_{i,j}f_jh_i$\uff0c$h_i*=1-p_{i,j}$\uff0c$f_i=\\frac{g_i}{1-h_i}$ \n\n\u8981\u6ce8\u610f\u8f6c\u79fb\u987a\u5e8f\u3002\n\n#### \u8d34\u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define lint long long\n#define rint register int\nusing namespace std;\ninline int read(){\n\tchar c;int f=1,res=0;\n\twhile(c=getchar(),!isdigit(c))if(c=='-')f*=-1;\n\twhile(isdigit(c))res=res*10+c-'0',c=getchar();\n\treturn res*f;\n}\nconst int N=1e3+5,inf=1e9;\ndouble p[N][N],f[N],g[N],h[N];\n//\u6700\u540e\u7684f\u624d\u662f\u7b54\u6848,\u5176\u4e3ag/(1-h) \nint q[N],tot,n;//q\u5b9e\u8d28\u4e0a\u662f\u62d3\u6251\u5e8f\u6392\u5217\nbool vis[N];//\u5224\u65ad\u662f\u5426\u5728\u961f\u5217\u91cc\u9762 \ninline void upd(){//\u7528\u961f\u5934\u6765\u66f4\u65b0 \n\tint j=q[tot];\n\tfor(rint i=1;i<=n;++i){\n\t\tif(vis[i])continue;\n\t\tg[i]+=f[j]*p[i][j]*h[i];\n\t\th[i]*=1-p[i][j];\n\t\tf[i]=g[i]/(1-h[i]);\n\t}\n}\ninline void solve(){\n\tfor(rint i=1;i<n;++i)\n\t\tf[i]=g[i]=h[i]=1;\n\tf[n]=0;h[n]=1;\n\t//\u6070\u597d\u90fd\u662f1 \n\tvis[n]=true;\n\tq[++tot]=n;upd();\n\twhile(tot<n){\n\t\tint id;double v=inf;\n\t\tfor(rint i=1;i<=n;++i)\n\t\t\tif(!vis[i]&&f[i]<v)\n\t\t\t\tv=f[i],id=i;\n\t\tvis[id]=true;\n\t\tq[++tot]=id;upd();\n\t}\n}\nint main(){\n\tn=read();\n\tif(n==1){return puts(\"0\"),0;}\n\tfor(rint i=1;i<=n;++i)\n\t\tfor(rint j=1;j<=n;++j)\n\t\t\tp[i][j]=read()/100.0;\n\tsolve();\n\tprintf(\"%.8lf\",f[1]);\n\treturn 0;\n}\n\n\n```\n",
        "postTime": 1632987702,
        "uid": 206258,
        "name": "SDNetFriend",
        "ccfLevel": 7,
        "title": "CF605E Intergalaxy Trips \u9898\u89e3"
    },
    {
        "content": "## \u9898\u89e3\n\n\u968f\u4fbf\u8bb2\u8bb2\u8fd9\u9898\u7684\u4e00\u79cd\u5947\u602a\u7684\u505a\u6cd5\uff08\u662f `CF` \u4e0a\u7684\u6700\u52a3\u89e3\uff09\uff1a\n\n\u9996\u5148\u5f0f\u5b50\u4ec0\u4e48\u7684\u524d\u4eba\u4e4b\u8ff0\u5907\u77e3\u3002\n\n\u5982\u679c\u5df2\u7ecf\u6c42\u51fa\u4e86 $E_u$ \u5e8f\u5217\u7684\u5927\u5c0f\u5173\u7cfb\uff0c\u90a3\u4e48\u7b97\u4e00\u904d\u53ef\u4ee5\u8f7b\u677e $\\Theta(n^2)$\u3002\n\n\u8003\u8651\u7528\u4e00\u79cd\u7c7b\u4f3c\u722c\u5c71\u7b97\u6cd5\u7684\u505a\u6cd5\u6c42\u5f97\u8d8a\u6765\u8d8a\u7cbe\u786e\u7684\u62d3\u6251\u5e8f\uff1a\u5148\u968f\u4fbf\u5b9a\u4e00\u4e2a\u521d\u59cb $E_0(u)$\uff0c\u7136\u540e\u6bcf\u6b21\u628a\u524d\u4e00\u6b21\u7684 $E_{i-1}(u)$ \u7684\u987a\u5e8f\u5f53\u4f5c\u771f\u5b9e\u62d3\u6251\u5e8f\uff0c\u6c42\u65b0\u7684\u4e00\u4ee3 $E_i(u)$\u3002\n\n\u8fd9\u6837\u505a $n$ \u6b21\u80af\u5b9a\u662f\u5bf9\u7684\uff0c\u4f46\u662f\u7531\u4e8e\u540e\u4e00\u6b21\u7684\u7ed3\u679c\u53ea\u4f9d\u8d56\u4e8e\u524d\u4e00\u6b21\u7684\u5927\u5c0f\u5173\u7cfb\uff0c\u6240\u4ee5\u5176\u5b9e\u771f\u5b9e\u4e2d\u4e0d\u9700\u8981 $n$ \u6b21\u5c31\u53ef\u4ee5\u5f97\u5230\u6b63\u786e\u7684\u62d3\u6251\u5e8f\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u4e00\u76f4\u8dd1\uff0c\u76f4\u5230\u5feb\u8981 `TLE` \u4e3a\u6b62\u3002\n\n---\n\n## \u4ee3\u7801\n\n\n```cpp\n//George1123\n#include <bits/stdc++.h>\nusing namespace std;\n \ntypedef long long i64;\ntypedef unsigned int u32;\ntypedef unsigned long long u64;\ntypedef vector<int> vi;\ntypedef pair<int,int> pii;\n \n#define x first\n#define y second\n#define sz(a) (int)((a).size())\n#define all(a) (a).begin(),(a).end()\n#define R(i,n) for(int i=0;i<(n);++i)\n#define L(i,n) for(int i=(n)-1;i>=0;--i)\n \nconstexpr int inf32=0x3f3f3f3f;\nconstexpr i64 inf64=0x3f3f3f3f3f3f3f3f;\n\nconst double eps=1e-15;\n\nint main(){\n    ios::sync_with_stdio(false);\n    cin.tie(0),cout.tie(0);\n\tcout.precision(12),cout<<fixed;\n    \n    clock_t s=clock();\n    \n    int n;\n    cin>>n;\n    if(n==1) return !(cout<<0<<'\\n');\n    vector<vector<double>> \n    p(n,vector<double>(n,0));\n    R(i,n)R(j,n){\n    \tint x;\n    \tcin>>x;\n        p[i][j]=x/100.;\n    }\n \n    vi o(n);\n    iota(all(o),0);\n    vector<double> d(n,inf64);\n    d[n-1]=0;\n    while(1.*(clock()-s)/CLOCKS_PER_SEC<1.95){\n        sort(all(o),[&]\n        (const int &i,const int &j){\n            return d[i]<d[j];\n        });\n        \n        vector<double> f(n,0);\n        for(const int &u:o){\n            if(u==n-1) continue;\n            double now=1;\n            for(const int &v:o){\n                if(d[v]>=d[u]) break;                \n                f[u]+=now*p[u][v]*(f[v]+1);\n                now*=(1-p[u][v]);\n            }\n            f[u]=(f[u]+now)/(1-now+eps);\n        }\n        \n        swap(f,d);\n    } \n    \n    cout<<d[0]<<'\\n';\n \n    return 0;\n}\n \n/* stuff you should look for\n    * int overflow, array bounds\n    * special cases (n=1?)\n    * do smth instead of nothing and stay organized\n    * WRITE STUFF DOWN\n    * DON'T GET STUCK ON ONE APPROACH\n*/ \n```\n\n---\n\n**\u795d\u5927\u5bb6\u5b66\u4e60\u6109\u5feb\uff01**",
        "postTime": 1612230636,
        "uid": 118365,
        "name": "George1123",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF605E \u3010Intergalaxy Trips\u3011"
    },
    {
        "content": "**description**\n\n\u73b0\u5728\u6709 $n$ \u4e2a\u70b9\u7684\u6709\u5411\u5b8c\u5168\u56fe\uff0c\u8fb9 $(i,j)$ \u51fa\u73b0\u7684\u6982\u7387\u662f $p_{i,j}$\uff0c$p_{i,i}=1$\uff0c\u95ee\u4ece $1$ \u5230 $n$ \u7684\u6700\u77ed\u8def\u7684\u671f\u671b\u957f\u5ea6\n\n\u5047\u8bbe\u8fd9\u4e2a\u4eba\u8db3\u591f\u806a\u660e\n\n$n\\leq 1000$\n\n**solution**\n\n\u8fd9\u9053\u9898\u56e0\u4e3a\u8fd9\u4e2a\u4eba\u8db3\u591f\u806a\u660e\uff0c\u6240\u4ee5\u4ed6\u53ef\u4ee5\u5bf9\u4e8e\u4e00\u4e2a\u60c5\u51b5\u52a8\u6001\u7684\u505a\u51fa\u51b3\u5b9a\n\n\u56e0\u4e3a\u6b63\u7740\u63a8\u4e0d\u592a\u597d\u786e\u5b9a\u8fd8\u9700\u8981\u51e0\u6b65\u80fd\u5230\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u4ece $n$ \u5012\u7740\u63a8\uff0c\u8bbe $E_i$ \u8868\u793a\u4ece $i$ \u8d70\u5230 $n$ \u7684\u7b54\u6848\n\n\u8003\u8651 $E_i$ \u7684\u8ba1\u7b97\uff0c\u5bf9\u4e8e $E_i$ \u7684\u6240\u6709\u51fa\u8fb9 $j$ \uff0c\u663e\u7136\u53ea\u6709\u5f53\u6240\u6709\u7684 $E_k<E_j$ \u7684 $(i,k)$ \u90fd\u6ca1\u6709\u51fa\u73b0\u7684\u65f6\u5019\uff0c\u6211\u4eec\u624d\u4f1a\u8003\u8651\u5f80 $j$ \u8d70\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u63a8\u51fa\u4e00\u4e2a\u8f6c\u79fb\n\n$$E_i=\\sum_{j=1}^nE_j\\times p_{i,j}\\times \\prod_{k}^{E_k<E_j}(1-p_{i,k})$$\n\n\u4f46\u662f\u8fd9\u4e2a\u8f6c\u79fb\u662f\u6709\u95ee\u9898\u7684\u3002\n\n\u56e0\u4e3a\u53ef\u80fd\u5b58\u5728\u4e00\u4e2a\u60c5\u51b5\uff0c\u4f7f\u5f97\u8fd9\u4e2a\u65f6\u5019 $i$ \u6ca1\u6cd5\u8d70\u5230\u5176\u4ed6\u7684\u5730\u65b9\uff0c\u8fd9\u6837\u7684\u60c5\u51b5\u51fa\u73b0\u7684\u6982\u7387\u662f $\\prod_{j}(1-p_{i,j})$\uff0c\u4f46\u662f\u8fd9\u4e2a\u65f6\u5019\u56e0\u4e3a $E_i$ \u53ea\u8ba1\u7b97\u7684\u662f\u975e\u81ea\u73af\u4e0a\u7684\u671f\u671b\uff0c\u6240\u4ee5\u8f6c\u79fb\u5e94\u8be5\u5199\u6210\n\n$$E_i=\\sum_{j=1}^n\\dfrac{E_j}{1-\\prod_{k=1}^n (1-p_{j,k})}\\times  p_{i,j}\\times \\prod_{k}^{E_k<E_j}(1-p_{i,k})$$\n\n\u8003\u8651\u8f6c\u79fb\u7684\u987a\u5e8f\uff0c\u663e\u7136\u5728\u66f4\u65b0\u7684\u65f6\u5019\uff0c\u5982\u679c\u5b58\u5728\u4e00\u4e2a $E_k<E_j$\uff0c\u5e76\u4e14\u8fd8\u6ca1\u6709\u5411\u90a3\u91cc\u8d70\u8fc7\uff0c\u90a3\u4e48\u6211\u4eec\u5e94\u8be5\u4f18\u5148\u4ece $i$ \u5f80 $k$ \u8d70\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u6bcf\u6b21\u679a\u4e3e\u6700\u5c0f\u7684\u4e4b\u524d\u6ca1\u6709\u66f4\u65b0\u8fc7\u7684 $E_j$ \u66f4\u65b0\n\n\u8fd9\u4e2a\u505a\u6cd5\u548c\u6734\u7d20\u7684 $\\mathcal O(n^2)$ dijkstra \u7c7b\u4f3c\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n# define Rep(i,a,b) for(int i=a;i<=b;i++)\n# define _Rep(i,a,b) for(int i=a;i>=b;i--)\n# define RepG(i,u) for(int i=head[u];~i;i=e[i].next)\n\ntypedef long long ll;\n\nconst int N=1005;\n\ntemplate<typename T> void read(T &x){\n   x=0;int f=1;\n   char c=getchar();\n   for(;!isdigit(c);c=getchar())if(c=='-')f=-1;\n   for(;isdigit(c);c=getchar())x=(x<<1)+(x<<3)+c-'0';\n    x*=f;\n}\n\nint n;\ndouble g[N][N];\ndouble E[N],prod[N];\nbool vis[N];\n\nint main()\n{\n\tread(n);\n\tRep(i,1,n)\n\t\tRep(j,1,n){\n\t\t\tint x;\n\t\t\tread(x);\n\t\t\tg[i][j]=1.*x/100;\n\t\t}\n\tif(n==1)return puts(\"0\"),0;\n\tvis[n]=true;\n\tfor(int i=1;i<n;i++){\n\t\tE[i]=1;\n\t\tprod[i]=1-g[i][n];\t\n\t}\n\tRep(i,1,n){\n\t\tdouble low=1e18;\n\t\tint pos=0;\n\t\tRep(j,1,n)\n\t\t\tif(!vis[j]&&E[j]/(1-prod[j])<low)\n\t\t\t\tlow=E[j]/(1-prod[j]),pos=j;\n\t\tif(pos==1)return printf(\"%.10lf\\n\",E[1]/(1-prod[1])),0;\n\t\tvis[pos]=true;\n\t\tRep(j,1,n)\n\t\t\tE[j]+=E[pos]/(1-prod[pos])*g[j][pos]*prod[j],prod[j]*=(1-g[j][pos]);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1609560252,
        "uid": 97344,
        "name": "devout",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF605E \u3010Intergalaxy Trips\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u539f\u6709\u7684\u9898\u89e3\u771f\u7684\u597d\u7b80\u7565\u554a\u3002\u3002\u3002\n\n\u9996\u5148\u8bbe\u51fa\u4e00\u4e2a\u503c $E_u$ \u8868\u793a $u$ \u8d70\u5230 $n$ \u6240\u9700\u8981\u7684\u671f\u671b\u65f6\u95f4\u3002\n\n\u6211\u4eec\u4ece\u7ed3\u679c\u51fa\u53d1\uff0c\u53d1\u73b0\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $E_u<E_v$\uff0c\u5982\u679c\u5f53\u524d\u5728 $u$ \u90a3\u4e0b\u4e00\u6b65\u4e00\u5b9a\u4e0d\u53ef\u80fd\u8d70\u5230 $v$\uff0c\u56e0\u4e3a\u8fd9\u6837\u8d70\u8fd8\u4e0d\u5982\u8d70\u4e00\u6b21\u81ea\u73af\u3002\u90a3\u4e48\u8fd9\u4e2a\u8f6c\u79fb\u56fe\u5c31\u4e00\u5b9a\u662f\u4e00\u4e2a DAG\u3002\n\n\u56e0\u4e3a\u6709\u81ea\u73af\uff0c\u6240\u4ee5\u6709 $E_u=p_u(E_u+1)+dp_u$\uff0c\u5176\u4e2d $p_u$ \u8868\u793a\u5bf9\u4e8e\u6240\u6709 $E_u<E_v$ \u90fd\u6709 $(u,v)$ \u8fd9\u6761\u8fb9\u88ab\u5220\u53bb\u7684\u6982\u7387\uff0c$dp_u$ \u8868\u793a\u6240\u6709 $E_u<E_v$ \u7684 $v$ \u5bf9 $u$ \u7684\u8d21\u732e\u4e4b\u548c\u3002\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5f97\u51fa $E_u=\\dfrac{dp_u+p_u}{1-p_u}$\u3002\n\n\u6211\u4eec\u8003\u8651\u8fd9\u4e2a DAG \u7684\u62d3\u6251\u5e8f\u3002\u5047\u8bbe\u5f53\u524d\u62d3\u6251\u5e8f\u524d $i-1$ \u4e2a\u70b9\u90fd\u5df2\u7ecf\u5bf9\u5176\u4ed6\u70b9\u8d21\u732e\u8fc7\u4e86\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u6b64\u65f6\u7b2c\u62d3\u6251\u5e8f\u7b2c $i$ \u4e2a\u70b9\u7684 $E$ \u503c\u5df2\u7ecf\u662f\u5b83\u6700\u7ec8\u7684\u7b54\u6848\u4e86\uff0c\u5373\u6ca1\u6709\u5176\u5b83\u70b9\u80fd\u5bf9\u5b83\u518d\u6b21\u4ea7\u751f\u8d21\u732e\u3002\u90a3\u4e48\u73b0\u5728\u9700\u8981\u89e3\u51b3\u7684\u95ee\u9898\u5c31\u662f\u5982\u4f55\u627e\u5230\u62d3\u6251\u5e8f\u7b2c $i$ \u4e2a\u70b9\u3002\n\n\u5bb9\u6613\u53d1\u73b0\uff0c\u5f53\u524d $E$ \u503c\u6700\u5c0f\u7684\u70b9\u5c31\u662f\u5f53\u524d\u8981\u9009\u7684\u70b9\u3002\n\n\u5176\u5b9e\u8fd9\u4e2a\u4e1c\u897f\u5f88\u50cf Dijkstra \u7b97\u6cd5\u7684\u601d\u60f3\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define N 1005\n#define LIM 1000000\n#define db double\n#define gc() (P1==P2 && (P2=(P1=buf)+fread(buf,1,LIM,stdin),P1==P2)?EOF:*P1++)\nchar buf[LIM],*P1,*P2;\nint n;db dp[N],nw[N],a[N][N];bool vs[N]; \nint rd()\n{\n\tint res=0;char c=0;while(!isdigit(c)) c=gc();\n\twhile(isdigit(c)) res=res*10+c-48,c=gc();return res;\n}\ndb calc(int u) {return (dp[u]+nw[u])/(1-nw[u]);}\nvoid release(int u)\n{\n\tvs[u]=1;\n\tfor(int i=1;i<=n;++i) if(!vs[i])\n\t\tdp[i]+=(calc(u)+1)*a[i][u]*nw[i],nw[i]*=1-a[i][u];\n}\nint main()\n{\n\tn=rd();for(int i=1;i<n;++i) nw[i]=1;\n\tfor(int i=1,x;i<=n;++i) for(int j=1;j<=n;++j)\n\t\tx=rd(),a[i][j]=0.01*x;release(n);\n\tfor(int i=1,t=0;i<n;++i,t=0)\n\t{\n\t\tfor(int j=1;j<=n;++j)\n\t\t\tif(!vs[j] && (!t || calc(j)<calc(t))) t=j;\n\t\tif(t==1) break;release(t);\n\t}printf(\"%.10lf\\n\",calc(1));return 0;\n}\n```",
        "postTime": 1600268108,
        "uid": 119621,
        "name": "Kubic",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF605E \u3010Intergalaxy Trips\u3011"
    },
    {
        "content": "### CF605E\n#### Solution\n\u8bbe$E(u)$\u8868\u793a\u4ece$u$\u5230$n$\u7684\u671f\u671b\u6b65\u6570\uff0c\u8003\u8651\u4e0b\u4e00\u6b65\uff0c\u5982\u679c\u662f\u8d70\u5230$v$\u4e14$E(v)\\geq E(u)$\uff0c\u90a3\u4e48\u5f53\u524d\u8fd9\u4e00\u6b65\u7684\u6700\u4f18\u7b56\u7565\u80af\u5b9a\u662f\u505c\u5728\u539f\u5730\u3002\n\n\u6240\u4ee5\u6211\u4eec\u6c38\u8fdc\u4e0d\u4f1a\u8d70\u5230\u4e00\u4e2a\u6bd4\u5f53\u524d\u671f\u671b\u6b65\u6570\u5927\u7684\u70b9\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5c06\u6240\u6709\u7b54\u6848\u6309\u4ece\u5c0f\u5230\u5927\u7684\u987a\u5e8f\u7b97\u51fa\uff0c\u5e76\u4ee5\u6b64\u6269\u5c55\u3002\n\n\u8bbe$u$\u7684\u540e\u7ee7\u5206\u522b\u4e3a$v_i$\u4e14$E$\u975e\u964d\uff0c\u90a3\u4e48\n$$\nE(u)=\\sum_i \\dfrac{E(v_i)}{1-\\prod_{j=1}^n(1-p_{v_i,j})}p_{u,v_i}\\prod_{j=1}^{i-1} (1-p_{u,v_j})+1\n$$\n\u540e\u9762\u7684$\\prod_{j=1}^{i-1} (1-p_{u,v_j})$\u8868\u793a$v_i$\u53ef\u4ee5\u8d70\u4e14\u6240\u6709\u671f\u671b\u6b65\u6570\u5c0f\u4e8e$v_i$\u7684\u90fd\u4e0d\u80fd\u8d70\uff0c\u800c\u524d\u9762\u9664\u4ee5$1-\\prod_{j=1}^n(1-p_{v_i,j})$\u7684\u539f\u56e0\u662f\u8981\u53bb\u6389$v_i$\u6ca1\u6cd5\u8d70\u5230\u5176\u4ed6\u5730\u65b9\u7684\u6982\u7387\uff0c\u56e0\u4e3a$E_i$\u8ba1\u7b97\u7684\u662f\u4e0d\u8003\u8651\u81ea\u73af\u7684\u6982\u7387\uff0c\u6700\u540e\u518d\u52a0\u4e0a\u5f53\u524d\u8fd9\u4e00\u6b65\u7684\u8d21\u732e$1$\u5373\u53ef\u3002\n\n\u7528\u7c7b\u4f3c $\\mathrm{dijkstra}$ \u7684\u65b9\u5f0f\u6bcf\u6b21\u53d6\u6700\u5c0f\u7684\u8f6c\u79fb\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n^2)$\n\n#### Code\n```cpp\nint n;\nint vis[MAXN],a[MAXN];\ndouble p[MAXN][MAXN],E[MAXN],prod[MAXN];\n\nint main(){\n    scanf(\"%d\",&n);\n    for(int i = 1;i <= n;i++)\n        for(int j = 1;j <= n;j++)\n            scanf(\"%lf\",&p[i][j]), p[i][j] /= 100;\n    if(n == 1) {printf(\"0\\n\"); return 0;}\n    for(int i = 1;i <= n;i++) E[i] = 1, prod[i] = 1 - p[i][n];\n    vis[n] = 1; a[1] = n;\n    for(int i = 1;i <= n;i++){\n        double minval = llINF; int pos = 0;\n        for(int j = 1;j <= n;j++){\n            if(!vis[j] && E[j] / (1 - prod[j]) < minval){\n                pos = j;\n                minval = E[j] / (1 - prod[j]);\n            }\n        }\n        vis[pos] = 1;\n        for(int j = 1;j <= n;j++)\n            E[j] += E[pos] / (1 - prod[pos]) * p[j][pos] * prod[j], prod[j] *= (1 - p[j][pos]);\n    }\n    printf(\"%.8f\\n\",E[1] / (1 - prod[1]));\n    return 0;\n}\n```\n\n",
        "postTime": 1611760474,
        "uid": 108894,
        "name": "\u5173\u6000\u4ed6\u4eba",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF605E \u3010Intergalaxy Trips\u3011"
    },
    {
        "content": "#### \u9898\u76ee\u5927\u610f\n\n- $n$ \u4e2a\u70b9\u7684\u6709\u5411\u5b8c\u5168\u56fe\u3002\n- $i \\to j$\u7684\u8fb9\u6bcf\u5929\u51fa\u73b0\u7684\u6982\u7387\u5747\u4e3a $p_{i,j} = 1$,\u82e5 $i = j$\uff0c\u6709 $p_{i,j} = 1$\n- \u6bcf\u5929\u9009\u62e9\u4e00\u6761\u5b58\u5728\u7684\u51fa\u8fb9\u8d70\u8fc7\u53bb\u3002\n- \u6c42\u6700\u4f18\u7b56\u7565\u4e0b\u4ece $1$ \u5230 $n$\u7684\u671f\u671b\u7b49\u5f85\u5929\u6570\u3002\n- $n \\le 10^3$\n\n\u5206\u6790\uff1a\n\n\u671f\u671b\u795e\u9898\n\n\u9996\u5148\u8003\u8651$DP$,\u8bbe$E_x$\u8868\u793a$x$\u5230$n$\u7684\u671f\u671b\u7b49\u5f85\u5929\u6570\n\n\u8003\u8651$E_x$\u7684\u8f6c\u79fb\uff0c\u8003\u8651\u4e00\u6761\u51fa\u8fb9$(x,v)$\uff0c\u7531\u4e8e\u4ed6\u8db3\u591f\u806a\u660e\uff0c\u56e0\u6b64\u4ec5\u5f53\u6240\u6709$E_y\\leq E_v$\u7684\u70b9\u5728\u5f53\u524d\u90fd\u6ca1\u51fa\u73b0\uff0c\u800c\u8fd9\u6761\u8fb9\u51fa\u73b0\u4e86\u3002\n\n\u6240\u4ee5\u5bb9\u6613\u5f97\u5230\u4e00\u4e2a\u8f6c\u79fb\u662f\u8fd9\u4e2a\u6837\u5b50\u7684\uff1a\n\n$E_x=\\sum{E_v*p_{x,v}*\\prod^{E_v<E_y}p_{i,y}}$\n\n\u4f46\u662f\u8fd9\u662f\u4e0d\u5bf9\u7684\u56e0\u4e3a\u6ca1\u6709\u8003\u8651\u81ea\u73af\uff0c\u5bfc\u81f4\u8fd9\u4e2a\u73a9\u610f\u72d7\u5c41\u4e0d\u662f\u3002\n\n\u8003\u8651\u8d70\u7684\u8fc7\u7a0b\u5b9e\u9645\u4e0a\u662f\u80af\u5b9a\u662f\u80fd\u4e0d\u8d70\u81ea\u73af\u5c31\u4e0d\u8d70\u81ea\u73af\uff0c\u5148\u8d70\u81ea\u73af\u8d70\u975e\u81ea\u73af\u3002\n\n\u56e0\u6b64\u5b9e\u9645\u4e0a\u7684\u8f6c\u79fb\u5e94\u8be5\u662f\u8fd9\u6837\u5b50\u7684\uff1a\n\n$E_x=\\sum{\\frac{E_v}{1-\\prod{p_{i,y}}}p_{x,v}*\\prod^{E_v<E_y}p_{i,y}}$\n\n\u4e4b\u6240\u4ee5\u9664$\\prod^{E_v<E_y}p_{i,y}$\u662f\u56e0\u4e3a\u8fd9\u662f\u5206\u6b65\u505a\uff0c\u4e58\u6cd5\u539f\u7406\u544a\u8bc9\u6211\u4eec\u5206\u6b65\u505a\u8981\u7528\u4e58\u6cd5\u3002\n\n\u800c$\\frac{1}{\\prod{p_{x,v}}}$\u7684\u73b0\u5b9e\u610f\u4e49\u662f\uff1a\u5728\u9009\u62e9\u8fd9\u6761\u51fa\u8fb9\u8d70\u51fa\u53bb\u4e4b\u524d\u8981\u7b49\u5f85\u51e0\u5929\u3002\n\n\u7531\u4e8e\u671f\u671b\u7684\u53ef\u4e58\u6027\uff0c\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5\u4e58\u4e0a\u9700\u8981\u7b49\u5f85\u51e0\u5929\n\n\u8fd9\u9898\u6211**\u60f3\u4e86\u597d\u51e0\u5929\u90fd\u662f\u56e0\u4e3a\u8fd9\u4e2a\uff0c\u611f\u8c22czd\u3001cjx\u3001glq\u7b49\u4e00\u4f17\u5927\u4f6c\uff08\uff08\uff08\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#define N 1005\nusing namespace std;\nint read()\n{\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+(ch^48);ch=getchar();}\n\treturn x*f;\n}\nint n,vis[N];\ndouble E[N],a[N][N],prod[N];\nint main()\n{\n\tn=read();\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tint x=read();\n\t\t\ta[i][j]=1.0*x/100;\t\t\t\n\t\t}\n\t}\n\tif(n==1)return puts(\"0\"),0;\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tE[i]=1;\n\t\tprod[i]=1-a[i][n];\n\t}\n\tvis[n]=1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tdouble minn=1e18;\n\t\tint pos=0;\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tif(E[j]/(1-prod[j])<minn&&!vis[j])\n\t\t\t{\n\t\t\t\tminn=E[j]/(1-prod[j]);\n\t\t\t\tpos=j;\n\t\t\t}\n\t\t}\n\t\tvis[pos]=1;\n\t\tif(pos==1)return printf(\"%.12lf\\n\",E[pos]/(1-prod[pos])),0;\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tE[j]+=E[pos]/(1-prod[pos])*a[j][pos]*prod[j];\n\t\t\tprod[j]*=(1-a[j][pos]);\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1609835725,
        "uid": 179600,
        "name": "shao0320",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF605E \u3010Intergalaxy Trips\u3011"
    },
    {
        "content": "### \u9898\u76ee\u5927\u610f\n\n\u6709\u4e00\u4e2a\u6709$n$\u4e2a\u70b9\u7684\u6709\u5411\u5b8c\u5168\u56fe\uff0c\u6bcf\u6761\u8fb9\u6bcf\u5929\u6709\u4e00\u4e2a\u5f00\u653e\u51e0\u7387$p[i][j]$\uff0c\u7ed9\u5b9a$p$\uff0c\u4f60\u9700\u8981\u6c42\u51fa\u4ece$1$\u5230$n$\u7684\u671f\u671b\u5929\u6570\n\n$n \\leq 10^3$\n\n### \u5206\u6790\n\n\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5012\u7740\u505a\uff0c\u7c7b\u4f3c$\\texttt{dijkstra}$\u7684\u601d\u8def\uff0c\u6bcf\u6b21\u627e\u5230\u5f53\u524d\u8d70\u5230$1$\u671f\u671b\u5929\u6570\u6700\u5c0f\u7684\uff0c\u5e76\u7528\u5b83\u66f4\u65b0\u6240\u6709\u70b9\u7684\u671f\u671b\u5929\u6570\u548c\u8def\u5f84\u6982\u7387\uff0c\u76f4\u5230\u8d70\u5230$n$\u4e3a\u6b62\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$\\mathcal{O}(n^2)$\n\n### \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n\n#define R register\n#define ll long long\n#define sum(a, b, mod) (((a) + (b)) % mod)\n\nconst int MaxN = 1e3 + 10;\n\nint n, vis[MaxN], a[MaxN];\ndouble p[MaxN][MaxN], d[MaxN], sum[MaxN], pr[MaxN];\n\nint main()\n{\n    scanf(\"%d\", &n);\n    for (int i = 1; i <= n; i++)\n    {\n        int now = 0;\n        sum[i] = pr[i] = 1.0;\n        for (int j = 1; j <= n; j++)\n            scanf(\"%d\", &now), p[i][j] = now * 0.01L;\n    }\n    vis[n] = 1, a[1] = n, d[0] = 1e18;\n    for (int i = 2; i <= n; i++)\n    {\n        for (int j = 1; j <= n; j++)\n        {\n            if (vis[j]) continue;\n            sum[j] += d[a[i - 1]] * p[j][a[i - 1]] * pr[j];\n            pr[j] *= (1 - p[j][a[i - 1]]), d[j] = sum[j] / (1 - pr[j]);\n        }\n        int pos = 0;\n        for (int j = 1; j <= n; j++)\n            if (!vis[j] && d[pos] > d[j])\n                pos = j;\n        vis[pos] = 1, a[i] = pos;\n    }\n    printf(\"%.10lf\\n\", d[1]);\n    std::cerr << \"tiger0132 /qq\";\n    return 0;\n}\n```\n\n",
        "postTime": 1584278752,
        "uid": 61966,
        "name": "little_sun",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF605E \u3010Intergalaxy Trips\u3011"
    },
    {
        "content": "## \u89e3\u6790\n\n### Part 1\n\n\u8bbe $E(x)$ \u8868\u793a\u7ed3\u70b9 $x$ \u5230 $n$ \u7684\u671f\u671b\u6b65\u6570\n\n\u9996\u5148\u53ef\u4ee5\u60f3\u5230\u6700\u4f18\u7b56\u7565\u4e0b\uff0c\u6bcf\u4e00\u6b65\u53ea\u4f1a\u8d70\u5411\u671f\u671b\u5c0f\u4e8e\u5f53\u524d\u7ed3\u70b9\u7684\u7ed3\u70b9\uff08\u6700\u574f\u60c5\u51b5\u4e0b\u5373\u8d70\u81ea\u73af\uff09\n\n\u518d\u5c06\u7ed3\u70b9\u6309 $E(x)$ \u7684\u5927\u5c0f\u5173\u7cfb\u5347\u5e8f\u6392\u5e8f\uff0c\u7f6e\u4e8e\u6570\u7ec4 $v[0..n-1]$ \u4e2d\u3002\u63a5\u7740\u53ef\u4ee5\u5f97\u5230 $E(x)$ \u4e4b\u95f4\u7684\u5173\u7cfb\u5f0f\uff1a\n\n$E(v[i])=\\sum\\limits_{j=0}^{i-1}((E(v[j])+1)\\cdot p(v[i], v[j])\\cdot\\prod\\limits_{k=0}^{j-1}(1-p(v[i], v[k])))+(E(v[i])+1)\\cdot\\prod\\limits_{j =0}^{i-1}(1-p(v[i], v[j]))$\n\n### Part 2-1\n\n\u5982\u679c\u5bf9 $i\\in [0, n-1]$ \u90fd\u5217\u51fa\u8fd9\u6837\u4e00\u4e2a\u5f0f\u5b50\uff0c\u6211\u4eec\u5c31\u5f97\u5230\u4e86 $n$ \u4e2a\u4e92\u76f8\u4e0d\u6210\u7ebf\u6027\u5173\u7cfb\u7684\u65b9\u7a0b\uff08\u4e0d\u8fc7\u5f53 $i=0$ \u65f6\u53ef\u80fd\u4f1a\u6709\u4e9b\u77db\u76fe\uff0c\u8fd9\u53ea\u9700\u53e6\u5916\u5b9a\u4e49\u5373\u53ef\uff09\uff1b\u5982\u679c\u80fd\u5f97\u5230\u6570\u7ec4 $v[0..n-1]$\uff0c\u663e\u7136\u5c31\u53ef\u4ee5\u76f4\u63a5\u89e3\u51fa\u6240\u6709 $E(x)$ \u4e86\n\n\u4f46\u6211\u4eec\u8fd8\u6ca1\u6cd5\u5f97\u77e5 $v[0..n-1]$\u3002\u8003\u8651\u5df2\u6709\u7684\u4fe1\u606f\uff0c\u5373 $E(n)=0$\uff0c$v[0]=n$\uff0c\u5e76\u5c06\u5176\u5e26\u5165\u65b9\u7a0b\uff1b\u518d\u89c2\u5bdf\u5f0f\u5b50\uff0c\u53d1\u73b0\u82e5\u6211\u4eec\u5f97\u77e5 $v[1]$ \u7684\u503c\uff0c\u4fbf\u53ef\u76f4\u63a5\u8ba1\u7b97\u51fa $E(v[1])$\u3002\u63a5\u7740\u4e0d\u59a8\u679a\u4e3e $v[1]$\uff0c\u53d6\u4f7f\u8ba1\u7b97\u5f97\u5230\u7684 $E(v[1])$ \u6700\u5c0f\u7684\u4f5c\u4e3a $v[1]$ \u7684\u503c\uff08\u6700\u4f18/\u6b63\u786e\u6027\u53ef\u8003\u8651\u76f4\u63a5\u53cd\u8bc1\uff09\u3002\u518d\u5982\u6b64\u53cd\u590d\uff0c\u4fbf\u53ef\u5f97\u5230\u6240\u6709 $E(x)$ \u7684\u503c\n\n### Part 2-2\n\n\u6216\u8005\u53ef\u4ee5\u8003\u8651\u4e00\u79cd\u7c7b\u4f3c dijkstra \u7684\u505a\u6cd5\n\n\u8bbe\u5df2\u786e\u5b9a $E(x)$ \u7684\u7ed3\u70b9\u96c6\u5408 $S$\uff0c\u4e14\u4fdd\u8bc1\u4efb\u610f\u4e0d\u5728 $S$ \u4e2d\u7684\u7ed3\u70b9\u7684\u671f\u671b\u5747\u4e0d\u5c0f\u4e8e $S$ \u4e2d\u7ed3\u70b9\u7684\u671f\u671b\u3002\u6bcf\u6b21\u6211\u4eec\u679a\u4e3e\u6240\u6709\u4e0d\u5728 $S$ \u4e2d\u7684\u7ed3\u70b9\uff0c\u5c06\u5176\u4f5c\u4e3a\u6240\u6709\u4e0d\u5728 $S$ \u4e2d\u7684\u7ed3\u70b9\u4e2d\u671f\u671b\u6700\u5c0f\u7684\u7ed3\u70b9\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97\u51fa\u5b83\u7684 $E(x)$\uff0c\u540c\u6837\u4e5f\u53d6\u8ba1\u7b97\u5f97\u5230\u7684\u671f\u671b\u6700\u5c0f\u7684\u7ed3\u70b9\u52a0\u5165 $S$\u3002\u5982\u6b64\u91cd\u590d\u5373\u53ef\u5f97\u5230\u6240\u6709 $E(x)$ \u7684\u503c\n\n\u8fd9\u79cd\u505a\u6cd5\u7684\u8bc1\u660e\u4e5f\u7c7b\u4f3c dijkstra\n\n## Part 3\n\n\u4e24\u79cd\u7b97\u6cd5\u8981\u5b9e\u73b0\u7684\u4e1c\u897f\u5176\u5b9e\u5dee\u4e0d\u591a\n\n\u5148\u5c06\u521a\u624d\u7684\u5f0f\u5b50\u5316\u7b80\u4e00\u4e0b\uff1a\n\n\u7531\u4e8e\u6bcf\u4e00\u6b65\u65e0\u8bba\u5f80\u54ea\u4e2a\u7ed3\u70b9\u8d70\u90fd\u4f1a\u5bfc\u81f4\u8d21\u732e\u52a0\u4e00\uff0c\u6211\u4eec\u4e0d\u59a8\u628a\u8fd9\u90e8\u5206\u7684\u8d21\u732e\u62c6\u51fa\u6765\u3002\u5373\u521a\u624d\u7684\u5f0f\u5b50\u5176\u5b9e\u53ef\u4ee5\u5199\u6210\uff1a\n\n$E(v[i])=\\sum\\limits_{j=0}^{i-1}(E(j)\\cdot p(v[i], v[j])\\cdot\\prod\\limits_{k=0}^{j-1}(1-p(v[i], v[k])))+E(v[i])\\cdot\\prod\\limits_{j =0}^{i-1}(1-p(v[i], v[j]))+1$\n\n\uff08\u5f53\u7136\u76f4\u63a5\u7eaf\u4ee3\u6570\u8fc7\u7a0b\u4e5f\u53ef\u4ee5\u5f97\u5230\u8fd9\u4e2a\u5f0f\u5b50\uff0c[\u53ef\u89c1](https://www.luogu.com.cn/paste/2srm0avp)\uff09\n\n\u63a5\u7740\u518d\u5c06 $E(i)$ \u5168\u90e8\u79fb\u5230\u5de6\u8fb9\uff0c\u5f97\u5230\uff1a\n\n$E(i)=\\frac {\\sum\\limits_{j=0}^{i-1}E(j)\\cdot p(i, j)\\cdot\\prod\\limits_{k=0}^{j-1}(1-p(i, k))+1} {1-\\prod\\limits_{j =0}^{i-1}(1-p(i, j))}$\n\n\u5bf9\u6bcf\u4e2a\u7ed3\u70b9\u6211\u4eec\u53ea\u9700\u7ef4\u62a4\u8fd9\u4e2a\u5f0f\u5b50\u5373\u53ef\n\n\u9996\u5148\u5206\u5b50\u5206\u6bcd\u53ef\u4ee5\u5206\u5f00\u7ef4\u62a4\u3002\u63a5\u7740\u5173\u4e8e $\\prod$\uff08\u8fde\u4e58\uff09\u90e8\u5206\uff0c\u6bcf\u6b21\u7528\u5230\u90fd\u66b4\u529b\u7b97\u4e00\u904d\u663e\u7136\u4e0d\u884c\uff0c\u6211\u4eec\u5176\u5b9e\u53ef\u4ee5\u5728\u6bcf\u786e\u5b9a\u4e00\u4e2a $v[i]$ \u7684\u503c\uff08\u6bcf\u6dfb\u52a0\u4e00\u4e2a\u7ed3\u70b9\u5230 $S$\uff09\u65f6\uff0c\u5c31\u4e3a\u6240\u6709\u5269\u4e0b\u7684\u5143\u7d20\u6dfb\u52a0\u5bf9\u5e94\u7684\u8d21\u732e\n\n\u5982\u679c\u5bf9\u7ec6\u8282\u90e8\u5206\u8fd8\u6709\u7591\u95ee\u53ef\u4ee5\u53c2\u8003\u4ee3\u7801\n\n## \u4ee3\u7801\n\n\u4e24\u79cd\u601d\u8def\u6700\u540e\u5f97\u5230\u7684\u4ee3\u7801\u5176\u5b9e\u90fd\u5dee\u4e0d\u591a\n\n```cpp\n#include <cstdio>\n\nnamespace IO_number{\n\tint read(){\n\t\tint x =0; char c =getchar(); bool f =0;\n\t\twhile(c < '0' || c > '9') (c == '-') ? f =1, c =getchar() : c =getchar();\n\t\twhile(c >= '0' && c <= '9') x =(x<<1)+(x<<3)+(48^c), c =getchar();\n\t\treturn (f) ? -x : x;\n\t}\n\t\n\tvoid write(const int &x){\n\t\tif(x < 0){\n\t\t\tputchar('-');\n\t\t\twrite(-x);\n\t\t}\n\t\telse{\n\t\t\tif(x/10)\n\t\t\t\twrite(x/10);\n\t\t\tputchar('0'+x%10);\n\t\t}\n\t}\n}\nusing namespace IO_number;\n\nconst int MAXN =1e3+20;\n\ndouble p[MAXN][MAXN];\ndouble num[MAXN], den[MAXN]; // Ans\uff1bnum \u5206\u5b50 den \u5206\u6bcd //\n\nbool vis[MAXN];\n\nint main(){\n\tconst int n =read();\n\tfor(int i =0; i < n; ++i)\n\t\tfor(int j =0; j < n; ++j)\n\t\t\tp[i][j] =read()/100.0;\n\t\n\tnum[n-1] =0, den[n-1] =1;\n\tfor(int i =0; i < n-1; ++i)\n\t\tnum[i] =(num[n-1]/den[n-1])*p[i][n-1]+1, den[i] =1-(1-p[i][n-1]);\n\tvis[n-1] =1;\n\tif(n == 1)\n\t\treturn printf(\"%lf\", 0.0) && 0;\n\tfor(int _i =1; _i < n; ++_i){\n\t\tint mn_i =-1;\n\t\tdouble mn =1e18;\n\t\tfor(int i =0; i < n; ++i)\n\t\t\tif(!vis[i] && num[i]/den[i] < mn)\n\t\t\t\tmn =num[i]/den[i], mn_i =i;\n\t\tvis[mn_i] =1;\n\t\tif(mn_i == 0)\n\t\t\treturn printf(\"%lf\", num[mn_i]/den[mn_i]) && 0;\n\t\tfor(int i =0; i < n; ++i)\n\t\t\tif(!vis[i]){\n\t\t\t\tnum[i] +=(num[mn_i]/den[mn_i])*p[i][mn_i]*(-(den[i]-1));\n\t\t\t\t--den[i], den[i] *=(1-p[i][mn_i]), ++den[i];\n\t\t\t}\n\t}\n}\n```",
        "postTime": 1626311096,
        "uid": 105254,
        "name": "Piwry",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF605E Intergalaxy Trips"
    },
    {
        "content": "> [CF605E Intergalaxy Trips](https://codeforces.com/contest/605/problem/E)\n\n## \u9898\u610f\n\n- $n$ \u4e2a\u70b9\u7684\u6709\u5411\u5b8c\u5168\u56fe\u3002\n- $i \\to j$ \u7684\u8fb9\u6bcf\u5929\u51fa\u73b0\u7684\u6982\u7387\u5747\u4e3a $p_{i,j}$\uff0c\u82e5 $i = j$\uff0c\u6709 $p_{i,j} = 1$\u3002\n- \u6bcf\u5929\u9009\u62e9\u4e00\u6761\u5b58\u5728\u7684\u51fa\u8fb9\u8d70\u8fc7\u53bb\u3002\n- \u6c42\u6700\u4f18\u7b56\u7565\u4e0b\u4ece $1$ \u5230 $n$ \u7684\u671f\u671b\u5929\u6570\u3002\n- $n \\le 10^3$\u3002\n\n## \u9898\u89e3\n\n\u6700\u4f18\u7b56\u7565\u663e\u7136\u5e94\u8be5\u662f\u8d2a\u5fc3\u7684\u627e\u51fa\u8fb9\u4e2d\u671f\u671b\u5929\u6570\u5c3d\u91cf\u5c0f\u7684\u8d70\u8fc7\u53bb\uff0c\u90a3\u4e48\u53cd\u5411\u63a8\u4e00\u6b21\uff0c\u6bcf\u6b21\u627e\u5f53\u524d\u671f\u671b\u5929\u6570\u6700\u5c0f\u7684\u70b9\uff0c\u7136\u540e\u52a8\u6001\u7ef4\u62a4\u671f\u671b\u5929\u6570\u548c\u5269\u4f59\u6982\u7387\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n^2)$\u3002\n\n## \u4ee3\u7801\n\n```cpp\nconst int N = 1e3 + 7;\nint n, v[N];\nld p[N][N], a[N], d[N];\n\ninline bool work() {\n\tint o;\n\tld x = 1e100L;\n\tfor (int i = 1; i <= n; i++)\n\t\tif (!v[i] && (d[i] + a[i]) / (1 - a[i]) <= x) x = (d[i] + a[i]) / (1 - a[i]), o = i;\n\tv[o] = 1, d[o] = (d[o] + a[o]) / (1 - a[o]);\n\tif (o == 1) return 1;\n\tfor (int i = 1; i <= n; i++)\n\t\tif (!v[i]) d[i] += a[i] * p[i][o] * (d[o] + 1), a[i] *= 1 - p[i][o];\n\treturn 0;\n}\n\nint main() {\n\trd(n);\n\tfor (int i = 1, x; i <= n; i++) {\n\t\tfor (int j = 1; j <= n; j++) rd(x), p[i][j] = 0.01L * x;\n\t\ta[i] = 1;\n\t}\n\ta[n] = 0;\n\tfor (int i = 1; i <= n; i++)\n\t\tif (work()) return cout << fixed << setprecision(15) << d[1] << endl, 0;\n\treturn 0;\n}\n\n```",
        "postTime": 1575093401,
        "uid": 100544,
        "name": "xht",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF605E \u3010Intergalaxy Trips\u3011"
    },
    {
        "content": "\u8bbe$E_x$\u4e3a$x$\u5230$n$\u7684\u671f\u671b\u65f6\u95f4\n\n$E_x = \\sum_i E_i \\times p_{xi}\\prod_{j=1}^{i-1}(1-p_{xj})$\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u7c7b\u4f3c`dij`\u7684\u601d\u60f3\u6765\u66f4\u65b0\n\n\u6bcf\u6b21\u53d6\u51fa$E_x$\u6700\u5c0f\u7684$x$\u6765\u66f4\u65b0\n\n\u8981\u6ce8\u610f\u6211\u4eec\u73b0\u5728\u6c42\u51fa\u6765\u7684\u8fd8\u6ca1\u7b97\u4e0a$1$\u9700\u8981\u5148\u505c\u7559\u5728\u539f\u5730\u7684\u6982\u7387,\n\n\u9664\u6389\u4e00\u4e2a$1-\\prod p$\u624d\u662f\u6700\u7ec8\u7684\u671f\u671b\n\n\u4e0a\u4ee3\u7801:\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 1011\nint n;\ndb g[N][N],p[N],E[N];\nbool v[N];\nint main(){\n    in(n);\n    int x;\n    Fur(i,1,n)Fur(j,1,n)in(x),g[i][j]=x/100.0;\n    if(n==1)return puts(\"0\"),0;\n    Fur(i,1,n)E[i]=1,p[i]=1-g[i][n];\n    E[n]=0;v[n]=1;\n    Fur(i,1,n){\n        x=0;db mx=1e18;\n        Fur(j,1,n)\n        if(!v[j]&&E[j]/(1-p[j])<mx)\n            mx=E[j]/(1-p[j]),x=j;\n        v[x]=1;\n        if(x==1)return printf(\"%.10f\\n\",E[1]/(1-p[1])),0;\n        Fur(j,1,n)\n            E[j]+=(E[x]/(1-p[x]))*g[j][x]*p[j],p[j]*=(1-g[j][x]);\n    }\n}\n```",
        "postTime": 1574921211,
        "uid": 36532,
        "name": "localhost",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF605E \u3010Intergalaxy Trips\u3011"
    }
]
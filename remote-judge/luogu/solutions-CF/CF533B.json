[
    {
        "content": "[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/CF533B)\n\n\u8fd8\u7b97\u6734\u7d20\u7684\u6811\u5f62dp\u9898(?)\n\n\u4e00\u53e5\u8bdd\u9898\u610f\uff1a\u7ed9\u5b9a\u4e00\u68f5\u6811\uff0c\u8981\u6c42\u9009\u5b9a\u4e00\u4e9b\u70b9\u52a0\u5165\u70b9\u96c6\uff0c\u4f7f\u5f97\u8fd9\u4e9b\u70b9\u7684\u6743\u503c\u548c\u6700\u5927\uff0c\u4e14\u5bf9\u4e8e\u70b9\u96c6\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u70b9\uff0c\u5176\u5b50\u6811\u4e2d\u6070\u6709\u5947\u6570\u4e2a\u70b9\u88ab\u9009\u4e2d\u3002\n\n-----------------------\n\n\u6211\u4eec\u53ef\u4ee5\u4ee4 $f[x][0/1]$ \u8868\u793a\u5728\u5b50\u6811 $x$ \u4e2d\u6709\u5076\u6570/\u5947\u6570\u4e2a\u5728\u70b9\u96c6\u4e2d\u7684\u70b9\u65f6\u6700\u5927\u7684\u6743\u503c\u548c\u3002\n\n\u663e\u7136\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5076\u6570\uff0c\u4ec5\u53ef\u80fd\u7531\u4e24\u4e2a\u5076\u6570\u6216\u4e24\u4e2a\u5947\u6570\u7ec4\u6210\uff1b\n\n\u540c\u7406\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5947\u6570\uff0c\u4ec5\u53ef\u80fd\u7531\u4e00\u4e2a\u5947\u6570\u548c\u4e00\u4e2a\u5076\u6570\u7ec4\u6210\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u6709\uff1a\n\n$\\begin{cases}f[u][0]=max(f[v][0]+f[u][0],f[v][1]+f[u][1])\\\\f[u][1]=max(f[v][0]+f[u][1],f[v][1]+f[u][0])\\end{cases}$\n\n\u4e3a\u4ec0\u4e48\u5462\uff1f\n\n\u6839\u636e\u5b9a\u4e49\uff0c$f[u][0]$ \u8868\u793a\u5b50\u6811 $u$ \u4e2d\u6709\u5076\u6570\u4e2a\u8282\u70b9\uff0c\u6240\u4ee5\u53ea\u80fd\u7531\u4e24\u4e2a\u5076\u6570\u6216\u4e24\u4e2a\u5947\u6570\u7ec4\u6210\u3002\n\n\u540c\u7406\u53ef\u5f97\uff0c$f[u][1]$ \u8868\u793a\u5b50\u6811 $u$ \u4e2d\u6709\u5947\u6570\u4e2a\u8282\u70b9\uff0c\u6240\u4ee5\u53ea\u80fd\u7531\u4e00\u4e2a\u5947\u6570\u548c\u4e00\u4e2a\u5076\u6570\u7ec4\u6210\u3002\n\n------------------------\n\n\u540c\u65f6\uff0c\u6839\u636e\u9898\u610f\uff0c\u4e00\u4e2a\u7ed3\u70b9\u53ef\u4ee5\u88ab\u9009\u5165\u70b9\u96c6\u5f53\u4e14\u4ec5\u5f53\u8fd9\u4e2a\u8282\u70b9\u7684\u5b50\u6811\u5728\u70b9\u96c6\u7684\u70b9\u4e3a\u5947\u6570\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$f[u][1]=max(f[u][1],f[u][0]+a[u])$\n\n------------------------\n\n\u5949\u4e0a\u4e11\u964b\u7684\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\n#include<vector>\nusing namespace std;\ntypedef long long ll;\nvector<vector<ll> >tree(250001);\nll a[250001],f[250001][2];\nvoid dfs(ll u)\n{\n\tf[u][1]=-1145141919810;\n\tfor(int i=0;i<tree[u].size();i++)\n\t{\n\t\tll v=tree[u][i];\n\t\tdfs(v);\n\t\tll x=f[u][0],y=f[u][1];\n\t\tf[u][0]=max(f[v][0]+x,f[v][1]+y);\n\t\tf[u][1]=max(f[v][1]+x,f[v][0]+y);\n\t}\n\tf[u][1]=max(f[u][1],f[u][0]+a[u]);\n}\nint main()\n{\n\tll n;\n\tcin>>n;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tll x,y;\n\t\tcin>>x>>y;\n\t\tif(x!=-1)\n\t\t{\n\t\t\ttree[x].push_back(i);\n\t\t}\n\t\ta[i]=y;\n\t}\n\tdfs(1);\n\tcout<<max(f[1][0],f[1][1])<<endl;\n\treturn 0;\n}\n```\n",
        "postTime": 1623248065,
        "uid": 195338,
        "name": "bunH2O",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF533B \u3010Work Group\u3011"
    },
    {
        "content": "#### \u6700\u8fd1\u5728\u590d\u4e60\u6811\u5f62DP\uff0c\u7136\u540e\u5c31\u53d1\u73b0\u4e86\u8fd9\u6837\u4e00\u9053\u9898\u3002\u3002\u3002\n#### solution\uff1a\n   \u6211\u4eec\u53ef\u4ee5\u6bd4\u8f83\u5bb9\u6613\u7684\u53d1\u73b0\uff0c\u5bf9\u4e8eup[u][1/0]\u8868\u793a\u4ee5\u70b9u\u4e3a\u6839\u8282\u70b9\u7684\u5b50\u6811\u4e2d\u9009\u53d6\u7684\u70b9\u7684\u4e2a\u6570\u662f\u5947\u6570\u6216\u5076\u6570\u4e14\u5408\u6cd5\u7684\u6700\u5927\u7684\u6743\u503c\u548c\u3002\n   \n   \u8f6c\u79fb\u65b9\u7a0b\u5982\u4e0b\uff1a\n   \ndp[u][0]=\u2211max(dp[v][1]+dp[u][1],dp[v][0]+dp[u][0]) //\u5947\u52a0\u5947 \u5076\u52a0\u5076\n   \ndp[u][1]=max{dp[u][0]+v[u],\u2211max(dp[v][1]+dp[u][0],dp[v][0]+dp[u][1])}//\u5b50\u6811\u548c\u5947+\u81ea\u5df1 \u5947\u52a0\u5076 \u5076\u52a0\u5947 \n  \n  \u67e5\u770bcode\u81ea\u884c~~\u611f\u6027\u7406\u89e3~~\n ```cpp\n#include<cstdio>\n#include<algorithm>\n#define ll long long \nusing namespace std;\nconst int N=1e5+10;\nint h[N<<1],cnt,n,root,p;\nll dp[N<<1][2],v[N<<1];\nstruct edge{\n\tint v,nxt;\n}e[N<<2];\ninline void add(int a,int b)\n{\n\te[++cnt].v=b;\n\te[cnt].nxt=h[a];\n\th[a]=cnt;\n} \ntemplate <typename e> inline void read(e &x)\n{\n\tx=0;int f=1;char ch=getchar();\n\twhile(ch<'0' || ch>'9') {if(ch=='-') f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9') {x=(x<<1)+(x<<3)+(ch^48);ch=getchar();}\n\tx*=f;\n}\nvoid dfs(int u,int fa)\n{\n\tdp[u][1]=-1ll<<62;\n\tfor(int i=h[u];i;i=e[i].nxt)\n\t{\n\t\tint v=e[i].v;\n\t\tif(v==fa) continue;\n\t\tdfs(v,u);\n\t\tll x1=dp[u][1],x0=dp[u][0];\n\t\tdp[u][0]=max(dp[v][1]+x1,dp[v][0]+x0);\n\t\tdp[u][1]=max(dp[v][1]+x0,dp[v][0]+x1);\n\t}\n\tdp[u][1]=max(dp[u][1],dp[u][0]+v[u]);\n}\nint main()\n{\n\tread(n);register int i;\n\tfor(i=1;i<=n;++i)\n\t{\n\t\tread(p);read(v[i]); \n\t\tif(p==-1) root=i;\n\t\tadd(i,p);add(p,i);\n\t}\n\tdfs(root,-1);\n\tprintf(\"%lld\",max(dp[root][0],dp[root][1]));\n\treturn 0;\n}\n```\n\n",
        "postTime": 1571733919,
        "uid": 88588,
        "name": "Hello\uff0cyearning",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF533B \u3010Work Group\u3011"
    },
    {
        "content": "#### \u9898\u610f\u7b80\u8ff0:\n\u7ed9\u51fa\u4e00\u68f5\u8282\u70b9\u6570\u4e3a $n$ \u7684\u6811\uff0c\u9009\u51fa\u70b9\u6743\u6700\u5927\u7684\u4e00\u4e2a\u70b9\u96c6\uff0c\u6ee1\u8db3\u6bcf\u4e2a\u70b9\u7684\u540e\u4ee3\u6709\u5076\u6570\u4e2a\u4e5f\u5728\u96c6\u5408\u4e2d\uff08\u5373\u6240\u6709\u4e00\u5171\u5947\u6570\u4e2a\uff09\u3002\n\n#### \u5206\u6790:\n\n\u8003\u8651\u6811\u5f62 dp,\u4ece\u5947\u5076\u4e2a\u6570\u4e0b\u624b\uff0c\u8bbe $dp_{root}{1}$ \u8868\u793a\u4ee5 $root$ \u4e3a\u6839\u7684\u5b50\u6811\u9009\u5947\u6570\u4e2a\u8282\u70b9\uff0c$dp_{root}{2}$ \u8868\u793a\u4ee5 $root$ \u4e3a\u6839\u7684\u5b50\u6811\u9009\u5076\u6570\u4e2a\u8282\u70b9\u3002\n\n\u56e0\u4e3a\u5947\u6570 $+$ \u5947\u6570 $=$ \u5076\u6570 $+$ \u5076\u6570 $=$ \u5076\u6570\uff0c\u6240\u4ee5\u5bf9\u4e8e\u9009\u5076\u6570\u4e2a\u7684\u60c5\u51b5\u9700\u8981\u8003\u8651\u5947\u6570\u548c\u5947\u6570\uff0c\u5076\u6570\u548c\u5076\u6570\u3002\n\n\u56e0\u4e3a\u5947\u6570 $+$ \u5076\u6570 $=$ \u5076\u6570 $+$ \u5947\u6570 $=$ \u5947\u6570\uff0c\u6240\u4ee5\u5bf9\u4e8e\u9009\u5947\u6570\u4e2a\u7684\u60c5\u51b5\u9700\u8981\u8003\u8651\u5947\u6570\u548c\u5076\u6570\uff0c\u5076\u6570\u548c\u5947\u6570\u3002\n\n\u6700\u540e\u4e3a\u4e86\u4fdd\u8bc1\u6240\u6709\u7684\u8282\u70b9\u6570\u4e3a\u5947\u6570\uff0c\u6bd4\u8f83\u65f6\u4e5f\u8981\u52a0\u4e0a\u539f\u8282\u70b9\u3002\n\n\u5177\u4f53\u7684\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u89c1 treedp \u90e8\u5206\u3002\n\n\n### \u4ee3\u7801:\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<cstring>\n#include<vector>\n#include<set>\n#include<stack>\n#include<map>\n#include<queue>\n#include<cstdlib>\n#include<iomanip>\n#include<utility>\n#define endl '\\n'\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> pai;\nconst double eps = 1e-10;\nconst int base = 13331;\nconst ll mod = 998242353;\nll maxn = -2147483647-1,minn = 0x7f7f7f7f;\nll n,a[200005],op,root = 1,dp[200005][2];\nvector<ll> edge[200005];\nvoid treedp(ll root){\n\tdp[root][0] = 0,dp[root][1] = maxn;\n\tfor(ll y:edge[root]){\n\t\tll vj = dp[root][0],vo = dp[root][1];\n\t\ttreedp(y);\n\t\tdp[root][0] = max(dp[y][0]+vj,dp[y][1]+vo);\n\t\tdp[root][1] = max(dp[y][1]+vj,dp[y][0]+vo);\n\t}\t\n\tdp[root][1] = max(dp[root][1],dp[root][0]+a[root]);\n}\nint main(){\n\t//freopen(\"filename.in\",\"r\",stdin);\n\t//freopen(\"filename.out\",\"w\",stdout);\n\tios::sync_with_stdio(false);\n\tcin.tie(0),cout.tie(0);\n\tcin>>n;\n\tfor(int i=1;i<=n;++i){\n\t\tcin>>op>>a[i];\n\t\tif(op==-1){\n\t\t\tcontinue;\n\t\t}\n\t\tedge[op].push_back(i);\n\t}\n\ttreedp(root);\n\tcout<<dp[root][1]<<endl;\n\t//fclose(stdin);\n\t//fclose(stdout);\n\treturn 0;\n}\n\n```\n\n#### \u603b\u7ed3:\n\u663e\u7136\u7684\u6811\u5f62 dp\uff0c\u611f\u89c9\u8bc4\u84dd\u8fc7\u9ad8\u4e86\u3002\n",
        "postTime": 1674921291,
        "uid": 550372,
        "name": "Lib_Zhang",
        "ccfLevel": 0,
        "title": "CF533B Work Group"
    },
    {
        "content": "### \u5206\u6790\n\u6811\u5f62$DP$\n\n\u6211\u4eec\u8bbe$f[x][0][0]$\u4e3a\u4ee5$x$\u4e3a\u6839\u7684\u5b50\u6811\u9009\u62e9\u4e86\u5076\u6570\u4e2a\u8282\u70b9\uff0c\u5176\u4e2d\u7f16\u53f7\u4e3a$x$\u7684\u8282\u70b9\u4e0d\u9009\u6240\u5f97\u5230\u7684\u6700\u5927\u6743\u503c\n\n\u6211\u4eec\u8bbe$f[x][1][0]$\u4e3a\u4ee5$x$\u4e3a\u6839\u7684\u5b50\u6811\u9009\u62e9\u4e86\u5076\u6570\u4e2a\u8282\u70b9\uff0c\u5176\u4e2d\u7f16\u53f7\u4e3a$x$\u7684\u8282\u70b9\u9009\u62e9\u6240\u5f97\u5230\u7684\u6700\u5927\u6743\u503c\n\n\u6211\u4eec\u8bbe$f[x][0][1]$\u4e3a\u4ee5$x$\u4e3a\u6839\u7684\u5b50\u6811\u9009\u62e9\u4e86\u5947\u6570\u4e2a\u8282\u70b9\uff0c\u5176\u4e2d\u7f16\u53f7\u4e3a$x$\u7684\u8282\u70b9\u4e0d\u9009\u6240\u5f97\u5230\u7684\u6700\u5927\u6743\u503c\n\n\u6211\u4eec\u8bbe$f[x][1][1]$\u4e3a\u4ee5$x$\u4e3a\u6839\u7684\u5b50\u6811\u9009\u62e9\u4e86\u5947\u6570\u4e2a\u8282\u70b9\uff0c\u5176\u4e2d\u7f16\u53f7\u4e3a$x$\u7684\u8282\u70b9\u9009\u62e9\u6240\u5f97\u5230\u7684\u6700\u5927\u6743\u503c\n\n\u6bcf\u6b21\u8f6c\u79fb\u65f6\uff0c\u6211\u4eec\u8bb0\u5f55\u5728$x$\u7684\u513f\u5b50\u8282\u70b9\u4e2d\u9009\u62e9\u5947\u6570\u4e2a\u8282\u70b9\u7684\u6700\u5927\u503c$maxj$\uff0c\u9009\u62e9\u5076\u6570\u4e2a\u8282\u70b9\u7684\u6700\u5927\u503c$maxo$,\u6700\u540e\u66f4\u65b0$x$\u7684$f$\u503c\u5373\u53ef\n### \u4ee3\u7801\n``` cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=1e6+5;\ntypedef long long ll;\nll f[maxn][2][2],a[maxn];\nvector<ll> g[maxn];\nvoid dfs(ll now){\n    if(g[now].size()==0){\n        f[now][0][0]=0;\n        f[now][1][0]=a[now];\n        f[now][0][1]=f[now][1][1]=-0x3f3f3f3f;\n        return;\n    }\n    ll maxj=0,maxo=0;\n    for(ll i=0;i<g[now].size();i++){\n        ll u=g[now][i];\n        dfs(u);\n        ll aa=maxj,bb=maxo;\n        if(aa!=0) maxj=max(aa+max(f[u][0][0],f[u][1][1]),bb+max(f[u][0][1],f[u][1][0]));\n        else maxj+=(bb+max(f[u][0][1],f[u][1][0]));\n        if(aa!=0) maxo=max(aa+max(f[u][0][1],f[u][1][0]),bb+max(f[u][0][0],f[u][1][1]));\n        else maxo+=max(f[u][0][0],f[u][1][1]);\n    }\n    f[now][0][0]=maxo;\n    f[now][1][0]=maxo+a[now];\n    f[now][0][1]=maxj;\n}\nint main(){\n    ll n;\n    scanf(\"%lld\",&n);\n    ll rt;\n    for(ll i=1;i<=n;i++){\n        ll aa,bb;\n        scanf(\"%lld%lld\",&aa,&bb);\n        if(aa==-1) rt=i;\n        else g[aa].push_back(i);\n        a[i]=bb;\n    }                                                                               \n    dfs(rt);\n    printf(\"%lld\\n\",max(max(f[rt][0][1],f[rt][0][0]),f[rt][1][0]));\n    return 0;\n}\n```",
        "postTime": 1596375391,
        "uid": 316322,
        "name": "hzoi_liuchang",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF533B \u3010Work Group\u3011"
    }
]
[
    {
        "content": "\u8fd9\u4e2a\u65b9\u6cd5\u53ef\u80fd\u6bd4\u8f83\u597d\u7406\u89e3\u4e00\u4e9b\uff0c\u4f46\u5c31\u662f\u8fd0\u884c\u65f6\u95f4\u6709\u70b9\u957f\uff08\n\n\u6211\u4eec\u5148\u901a\u8fc7\u5206\u89e3 $m1$\uff0c$m2$ \u7684\u56e0\u6570\u6765\u6c42\u51fa $m$ \u7684\u6240\u6709\u56e0\u6570\u3002\n\n\u5bf9\u4e8e $m$ \u7684\u7b2c $i$ \u4e2a\u56e0\u6570 $c_i$\uff0c$c_i$ \u6240\u5728\u7684\u884c\u53f7\u4e00\u5b9a\u662f $c_i$ \u7684\u56e0\u6570\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4e8c\u5206\u627e\u5230\u6700\u5c0f\u7684 $k$\uff0c\u4f7f\u5f97 $\\lceil \\frac{c_i}{c_k} \\rceil \u2264 n$\uff0c\u7136\u540e\u4ece $k$ \u5f00\u59cb\u679a\u4e3e $j$\uff08$k\u2264j\u2264n$\uff09\uff0c\u76f4\u5230 $\\left. c_j \\middle| c_i\\right.$ \u4e3a\u6b62\uff0c\u90a3\u4e48 $c_i$ \u6240\u5bf9\u5e94\u7684\u6700\u5c0f\u884c\u53f7\u5c31\u662f $c_j$\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <vector>\n\nusing namespace std;\n\n#define int long long\n\nint t, n, m1, m2;\nvector<int> a, b, c;\n\nsigned main()\n{\n\tscanf(\"%lld\", &t);\n\twhile (t -- )\n\t{\n\t\tint cnt = 0, ans = 0;\n\t\ta.clear();\n\t\tb.clear();\n\t\tc.clear();\n\t\t\n\t\tscanf(\"%lld%lld%lld\", &n, &m1, &m2);\n\t\tfor (int i = 1; i <= m1 / i; i ++ )\n\t\t{\n\t\t\tif(m1 % i == 0)\n\t\t\t{\n\t\t\t\ta.push_back(i);\n\t\t\t\tif(m1 / i != i) a.push_back(m1 / i); \n\t\t\t}\n\t\t}\n\t\tfor (int i = 1; i <= m2 / i; i ++ )\n\t\t{\n\t\t\tif(m2 % i == 0)\n\t\t\t{\n\t\t\t\tb.push_back(i);\n\t\t\t\tif(m2 / i != i) b.push_back(m2 / i);\n\t\t\t}\n\t\t}\n\t\tsort(a.begin(), a.end());\n\t\tsort(b.begin(), b.end());\n\t\t\n\t\tfor (int i = 0; i < a.size(); i ++ )\n\t\t\tfor (int j = 0; j < b.size(); j ++ )\n\t\t\t\tc.push_back(a[i] * b[j]);\n\t\t\t\t\n\t\tsort(c.begin(), c.end());\n\t\tc.erase(unique(c.begin(), c.end()), c.end());\n\t\t\n\t\tfor (int i = 0; i < c.size(); i ++ )\n\t\t{\n\t\t\tint l = 0, r = i;\n\t\t\twhile (l <= r)\n\t\t\t{\n\t\t\t\tint mid = l + r >> 1;\n\t\t\t\tif ((c[i] + c[mid] - 1) / c[mid] <= n) r = mid - 1;\n\t\t\t\telse l = mid + 1;\n\t\t\t}\n\t\t\tfor (int j = l; j < c.size(); j ++ )\n\t\t\t{\n\t\t\t\tif(c[j] > n) break;\n\t\t\t\tif(c[i] % c[j] == 0)\n\t\t\t\t{\n\t\t\t\t\tans ^= c[j];\n\t\t\t\t\tcnt ++;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tprintf(\"%lld %lld\\n\", cnt, ans);\n\t}\n}\n```",
        "postTime": 1675064817,
        "uid": 314625,
        "name": "\u4fe1\u606f\u5411\u9633\u82b1\u6728",
        "ccfLevel": 4,
        "title": "CF1792E Divisors and Table \u9898\u89e3"
    },
    {
        "content": "\u5b9e\u9645\u4e0a\u6211\u4eec\u53ef\u4ee5\u7528 Pollard-rho \u76f4\u63a5\u66b4\u529b\u5206\u89e3\u51fa $ m $ \u7684\u56e0\u6570\uff0c\u800c\u4e0d\u9700\u8981\u5206\u522b\u5206\u89e3\u4e24\u4e2a\u56e0\u5b50\u4e4b\u540e\u518d\u5408\u5e76\u3002\n\n\u7136\u540e\u6211\u4eec\u5f97\u5230\u8d28\u56e0\u5b50\u5206\u89e3\u540e dfs \u679a\u4e3e\u6bcf\u4e2a\u8d28\u56e0\u5b50\u7684\u51fa\u73b0\u6b21\u6570\uff0c\u4e0d\u96be\u53d1\u73b0\u8fd9\u6837\u505a\u7531\u552f\u4e00\u5206\u89e3\u5b9a\u7406\u6240\u4ee5\u6bcf\u4e2a\u56e0\u5b50\u53ea\u4f1a\u88ab\u679a\u4e3e\u4e00\u6b21\u3002\n\n\u5f97\u5230\u6240\u6709\u56e0\u5b50\u540e\u53d1\u73b0\u884c\u53f7\u5fc5\u987b\u8981\u662f\u5176\u7ea6\u6570\uff0c\u53ef\u4ee5\u4e8c\u5206\u51fa\u6700\u5c0f\u7684\u4ee4\u5176\u5728\u8868\u683c\u8303\u56f4\u5185\u7684\u6570\uff0c\u7136\u540e\u4ece\u8fd9\u4e2a\u6570\u5f80\u4e0a\u66b4\u529b\u8df3\u5f97\u5230\u80fd\u6574\u9664\u8fd9\u4e2a\u56e0\u5b50\u7684\u6700\u5c0f\u7ea6\u6570\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e0d\u4f1a\u7b97\uff0c\u4f46\u662f\u8dd1\u4e0d\u6ee1\u53ef\u4ee5\u8fc7\u3002\u5b9e\u73b0\u90e8\u5206\u53c2\u7167\u4e86\u7b2c\u4e00\u7bc7\u9898\u89e3\u3002\n\n\u6ce8\u610f\u8ba1\u7b97\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u4f1a\u51fa\u73b0\u7684\u6ea2\u51fa\u95ee\u9898\u3002\n\n\u4ee3\u7801\uff1a\uff08\u6a21\u677f\u8fc7\u957f\u8d34\u4e91\u526a\u8d34\u677f\uff09\n\n[\u6a21\u677f](https://www.luogu.com.cn/paste/cpc2see7)\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\n/*\u6a21\u677f*/\nvector<pair<int,int> >p;\nvector<uint64_t>tmp,c;\nint ksm(int a,int b) \n{\n\tint res=1;\n\twhile(b) \n    {\n\t\tif(b&1)\n\t\tres=res*a;\n\t\ta=a*a;\n\t\tb>>=1;\n\t}\n\treturn res;\n}\nvoid dfs1(int step,int now) \n{\n\tif(step==p.size()) \n    {\n\t\ttmp.push_back(now);\n\t\treturn;\n\t}\n\tfor (int i=0;i<=p[step].second;i++)\n\tdfs1(step+1,now*ksm(p[step].first,i));\n}\nmain() \n{\n\tint T;\n\tcin>>T;\n\twhile(T--) \n    {\n\t\tuint64_t n,a,b,res;\n\t\tcin>>n>>a>>b;\n\t\tres=a*b;\n\t\tauto map1=OY::Pollard_Rho::decomposite(res);\n\t\tp.clear();\n\t\tfor (auto x:map1) \n        {\n\t\t\tpair<int,int> a= {x.prime,x.count};\n\t\t\tp.push_back(a);\n\t\t}\n\t\ttmp.clear();\n\t\tdfs1(0,1);\n\t\tint cnt=0,ans=0;\n\t\tc=tmp;\n\t\tsort(c.begin(),c.end());\n\t\tfor (int i = 0; i < c.size(); i ++ ) \n        {\n\t\t\tint l = 0, r = i;\n\t\t\twhile (l <= r) \n            {\n\t\t\t\tint mid = l + r >> 1;\n\t\t\t\tif ((c[i] + c[mid] - 1) / c[mid] <= n) \n\t\t\t\t        r = mid - 1; \n                        else \n\t\t\t\t        l = mid + 1;\n\t\t\t}\n\t\t\tfor (int j = l; j < c.size(); j ++ ) \n            {\n\t\t\t\tif(c[j] > n) \n\t\t\t\t        break;\n\t\t\t\tif(c[i] % c[j] == 0) \n                {\n\t\t\t\t\tans ^= c[j];\n\t\t\t\t\tcnt ++;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcout<<cnt<<' '<<ans<<'\\n';\n\t}\n}\n```\n",
        "postTime": 1675725334,
        "uid": 714821,
        "name": "loser_seele",
        "ccfLevel": 4,
        "title": "CF1792E\u9898\u89e3"
    },
    {
        "content": "\u9996\u5148\u53ef\u4ee5\u5bf9 $m_1 m_2$ \u5206\u89e3\u8d28\u56e0\u6570\uff0c\u8fdb\u800c\u6293\u51fa\u5176\u6240\u6709\u56e0\u6570\u3002\n\n\u63a5\u4e0b\u6765\u76f4\u63a5\u8003\u8651 $\\min$ \u6bd4\u8f83\u9ebb\u70e6\uff0c\u6211\u8d5b\u65f6\u7684\u601d\u8def\u662f\u7528\u53ef\u6301\u4e45\u5316\u53ef\u5e76\u5806\u7ef4\u62a4\u4e00\u4e2a\u6570\u5728\u8fd9\u5f20\u8868\u4e0a\u7684\u6240\u6709\u51fa\u73b0\u4f4d\u7f6e\u7684\u5217\uff0c\u4ece\u5c0f\u5230\u5927\u5904\u7406\uff0c\u6bcf\u6b21\u5728\u5408\u5e76\u5b8c\u6210\u540e\u5f39\u51fa\u6240\u6709\u5df2\u7ecf\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684\u90a3\u4e9b\u8fc7\u5c0f\u7684\u6570\u2014\u2014\u663e\u7136\u5b83\u4eec\u5bf9\u4e8e\u66f4\u5927\u7684\u6570\u4e5f\u4e0d\u5408\u6cd5\uff0c\u5224\u65ad\u65f6\u770b\u770b\u5806\u9876\u662f\u5426 $\\leq n$ \u5373\u53ef\u3002\n\n\u4f46\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u4f2a\u7684\u2026\u2026\u6cbf\u7740\u76f4\u63a5\u6c42 $\\min$ \u8fd9\u6761\u8def\u5df2\u7ecf\u5f88\u96be\u8d70\u4e0b\u53bb\u4e86\u3002\n\n\u8003\u8651\u53cd\u8fc7\u6765\uff0c\u5c1d\u8bd5\u6c42\u51fa\u6700\u5927\u7684\u884c\uff0c\u8fdb\u800c\u53ef\u4ee5\u5f97\u77e5\u6700\u5c0f\u7684\u5217\u3002\n\n\u8003\u8651 dp\u3002\u8bbe $dp_x$ \u8868\u793a $x$ \u7684\u56e0\u6570\u4e2d\u6700\u5927\u4e14\u4e0d\u5927\u4e8e $n$ \u8005\u3002\n\n\u521d\u503c\uff1a$dp_x = [x \\leq n] x$\u3002\n\n\u8f6c\u79fb\uff1a$dp_x \\leftarrow \\max(dp_x, dp_{\\frac{x}{p}})$\uff0c\u5176\u4e2d $p$ \u4e3a $x$ \u7684\u4e00\u4e2a\u8d28\u56e0\u6570\u3002\n\n\u7b54\u6848\uff1a$\\displaystyle\\sum_{x \\mid m_1 m_2} [dp_x \\neq 0 \\operatorname{and} \\frac{x}{dp_x} \\leq n]$ \u548c $\\operatorname{xor}_{x \\mid m_1 m_2} [dp_x \\neq 0 \\operatorname{and} \\frac{x}{dp_x} \\leq n] \\frac{x}{dp_x}$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(t(\\sqrt{m_1} + \\sqrt{m_2} + \\tau(m_1 m_2) \\omega(m_1 m_2) \\log \\tau(m_1 m_2)))$\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <iostream>\n#include <algorithm>\n#include <map>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint prime[17], power[17];\nll bucket[103687], dp[103687];\nmap<int, int> mp;\n\ninline void decompound(int n){\n\tfor (int i = 2; i * i <= n; i++){\n\t\twhile (n % i == 0){\n\t\t\tn /= i;\n\t\t\tmp[i]++;\n\t\t}\n\t}\n\tif (n > 1) mp[n]++;\n}\n\nvoid dfs(int cur, ll val, int cnt1, int &cnt2){\n\tif (cur > cnt1){\n\t\tbucket[++cnt2] = val;\n\t\treturn;\n\t}\n\tfor (int i = 0; i <= power[cur]; i++){\n\t\tdfs(cur + 1, val, cnt1, cnt2);\n\t\tval *= prime[cur];\n\t}\n}\n\nint main(){\n\tint t;\n\tcin >> t;\n\tfor (int i = 1; i <= t; i++){\n\t\tint n, m1, m2, cnt1 = 0, cnt2 = 0, ansa = 0;\n\t\tll ansb = 0;\n\t\tcin >> n >> m1 >> m2;\n\t\tmp.clear();\n\t\tdecompound(m1);\n\t\tdecompound(m2);\n\t\tfor (map<int, int>::iterator j = mp.begin(); j != mp.end(); j++){\n\t\t\tcnt1++;\n\t\t\tprime[cnt1] = j->first;\n\t\t\tpower[cnt1] = j->second;\n\t\t}\n\t\tdfs(1, 1, cnt1, cnt2);\n\t\tsort(bucket + 1, bucket + cnt2 + 1);\n\t\tfor (int j = 1; j <= cnt2; j++){\n\t\t\tll t;\n\t\t\tif (bucket[j] <= n){\n\t\t\t\tdp[j] = bucket[j];\n\t\t\t} else {\n\t\t\t\tdp[j] = 0;\n\t\t\t}\n\t\t\tfor (int k = 1; k <= cnt1; k++){\n\t\t\t\tif (bucket[j] % prime[k] == 0) dp[j] = max(dp[j], dp[lower_bound(bucket + 1, bucket + cnt2 + 1, bucket[j] / prime[k]) - bucket]);\n\t\t\t}\n\t\t\tt = bucket[j] / dp[j];\n\t\t\tif (dp[j] != 0 && t <= n){\n\t\t\t\tansa++;\n\t\t\t\tansb ^= t;\n\t\t\t}\n\t\t}\n\t\tcout << ansa << \" \" << ansb << endl;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1674697979,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1792E \u3010Divisors and Table\u3011"
    },
    {
        "content": "\u4e0d\u4f1a\u8bc1\u590d\u6742\u5ea6\u3002CF [1653ms](https://codeforces.com/contest/1792/submission/190984079) \u6c42\u53c9/\u8bc1\u3002\n\n---\n\n## \u9898\u610f\n\n\u7ed9\u5b9a $m = m1\\times m2$ \u548c $n$\u3002\u5b9a\u4e49 $g(x, n)$ \u4e3a\u662f\u5426\u5b58\u5728\u4e00\u4e2a $x$ \u7684\u56e0\u5b50 $t$ \u4f7f\u5f97 $t\\leq n, \\frac{x}{t}\\leq n$\uff0c$f(x, n)$ \u662f\u6700\u5c0f\u7684 $x$ \u56e0\u5b50 $t$\uff0c\u4f7f\u5f97 $t\\leq n, \\frac{x}{t}\\leq n$\u3002\n\n\u6c42 $\\sum\\limits_{d|m} g(d, n)$ \u548c $\\oplus_{d|m, g(d, n)= 1} f(d, n)$\u3002\n\n$n, m1, m2\\leq 10^9$.\n\n## \u89e3\u6cd5\n\n$m$ \u7684\u56e0\u5b50\u4e00\u5b9a\u662f\u4e00\u4e2a $m1$ \u7684\u56e0\u5b50 $x$ \u548c\u4e00\u4e2a $m2$ \u7684\u56e0\u5b50 $y$ \u7684\u4e58\u79ef\u3002\u8fd9\u4e0d\u80fd\u8ba9\u6211\u4eec\u907f\u514d\u91cd\u590d\u8ba1\u6570\uff0c\u56e0\u800c\u6211\u4eec\u8981\u6c42 $x$ \u662f\u6240\u6709\u6ee1\u8db3 $x_0y_0 = m, x_0 | m1, y_0|m2$ \u4e2d $x_0$ \u6700\u5c0f\u7684\u90a3\u4e2a $x_0$\u3002\u8fd9\u4e5f\u5c31\u662f\u5728\u8bf4\uff0c\u4e0d\u5b58\u5728 $t | y, tx | m1$\uff0c\u4e5f\u5373 $\\gcd(y, \\frac{m1}{x}) = 1$\u3002\u79f0\u8fd9\u6837\u7684\u4e8c\u5143\u7ec4\u4e3a\u53ef\u7231\u7684\u3002\n\n[oeis](http://oeis.org/A066150) \u5f97\u5230 $m1, m2$ \u5728 1e9 \u7ea7\u522b\u65f6\uff0c\u53ef\u7231\u7684\u4e8c\u5143\u7ec4 $(x, y)$ \u7684\u7ea7\u522b\u5728 1e5 \u5de6\u53f3\u3002\n\n\u8981\u5224\u65ad\u4e00\u4e2a\u4e8c\u5143\u7ec4 $(x, y)$ \u662f\u5426\u5408\u6cd5\u5e76\u6c42\u51fa\u5176 $f(xy, n)$\uff0c\u6700\u76f4\u89c2\u7684\u60f3\u6cd5\u5c31\u662f\u679a\u4e3e $i|x, j|y$\uff0c\u5224\u65ad\u662f\u5426\u6709 $ij\\leq n, \\frac{x}{i}\\frac{y}{j}\\leq n$\uff0c\u4f46\u662f\u8fd9\u6837\u663e\u7136\u662f\u4e0d\u884c\u7684\u3002\u6211\u4eec\u8003\u8651\u53ea\u679a\u4e3e $i$\uff0c\u90a3\u4e48\u8981\u6c42\u5c31\u662f $\\frac{ni}{xy}\\leq j \\leq \\frac{n}{i}, j|y$\u3002\u5927\u4e8e\u53f7\u90a3\u8fb9\u6709 $y$ \u4e0d\u597d\u5904\u7406\uff0c\u4f46\u662f\u5c0f\u4e8e\u53f7\u6ca1\u6709\u3002\u4e0d\u59a8\u6539\u4e3a\u6c42 $h(xy, n)$ \u4e3a**\u6700\u5927\u7684** $xy$ \u7684\u56e0\u5b50 $t$\uff0c\u4f7f\u5f97 $t\\leq n, \\frac{xy}{t}\\leq n$\u3002\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa\u6700\u5927\u7684 $j|y$ \u4e14 $j\\leq \\frac{n}{i}$\uff0c\u7136\u540e\u7b80\u5355\u7684\u5224\u5b9a\u662f\u5426\u6709 $j\\ge \\frac{ni}{xy}$ \u5373\u53ef\u3002\n\n\u679a\u4e3e\u6240\u6709\u53ef\u7231\u7684\u4e8c\u5143\u7ec4 $(x, y)$ \u548c $x$ \u7684\u56e0\u5b50 $i$\uff0c\u5c06\u5176\u62bd\u8c61\u4e3a\u4e00\u4e2a\u8be2\u95ee\u4e09\u5143\u7ec4 $(y, \\frac{n}{i}, x)$ \u5b58\u50a8\u4e0b\u6765\u3002\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a $y$ \u4f9d\u636e $\\frac{n}{i}$ \u4e0a\u5347\u4f9d\u6b21\u5904\u7406\u8be2\u95ee\u3002$\\frac{n}{i}$ \u76f8\u540c\u7684\u8be2\u95ee\uff0c\u8981\u6c42\u51fa\u7684 $j$ \u662f\u76f8\u540c\u7684\u3002\n\n\u7206\u641c\u5f97\u5230\uff0c\u5bf9\u4e8e\u4e00\u4e2a $m1$\uff0c\u4e8c\u5143\u7ec4 $(i, x)$ \u6ee1\u8db3 $i|x, x|m1$ \u7684\u6570\u91cf\uff0c\u5728 $m1\\leq 10^9$ \u7684\u65f6\u5019\u4e3a 136080\u3002\n\n\u6574\u4f53\u590d\u6742\u5ea6\u4e3a $\\sum\\limits_{y|m2} \\sum\\limits_{x|m1} [(\\frac{m1}{x}, y) = 1] d(x)$\uff0c\u6211\u4e0d\u4f1a\u7b97\u4f46\u662f\u8dd1\u7684\u98de\u5feb\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define f(i,x,y) for(int i=x, i##end=y; i<=i##end; ++i)\n#define d(i,x,y) for(int i=y, i##end=x; i>=i##end; --i)\n#define uf(i,x,y) for(int i=x, i##end=y; i<i##end; ++i)\n#define ll long long\n#define pir pair<int, int>\n#define fir first\n#define sec second\n#define mp make_pair\n#define pb push_back \nchar ch;\nint rd() {\n\tint f=1, x=0; ch=getchar();\n\twhile(!isdigit(ch)) { f=((ch=='-')?-1:f); ch=getchar(); }\n\twhile(isdigit(ch)) { x=x*10+ch-'0'; ch=getchar(); }\n\treturn x*f;\n}\nvoid rd(int& x) { x=rd(); }\nusing namespace std;\nconst int _ = 2000, inf = -1;\nint fac[2][_], tot[2];\nint okf[_][_], okc[_];\nint facf[_][_], ffc[_];\nint facy[_][_], fyc[_];\nint qat[_][_], qc[_];\nint ans[_][_];\nvoid upd(int a, int b, int c) {\n\tans[a][b] = max(ans[a][b], c);\n}\nvoid solve() {\n\tint aal = 0, s = 0;\n\tint C = rd(); int m[2]; m[0] = rd(), m[1] = rd(); tot[0] = tot[1] = 0;\n\tf(t,0,1) {\n\t\tfor(int i=1; i*i <= m[t]; ++i) {\n\t\t\tif(m[t] % i) continue ;\n\t\t\tfac[t][++tot[t]] = i;\n\t\t\tif(i*i != m[t]) fac[t][++tot[t]] = m[t]/i;\n\t\t}\n\t}\n\tf(t,0,1) sort(fac[t] + 1, fac[t] + tot[t] + 1);\n\tf(j,1,tot[1]) {\n\t\tint y = fac[1][j]; okc[j] = 0;\n\t\tf(i,1,tot[0]) {\n\t\t\tint X = m[0] / fac[0][i];\n\t\t\tif(gcd(X, y) == 1) {\n\t\t\t\tokf[j][++okc[j]] = i, ans[j][i] = inf;\n\t\t\t}\n\t\t}\n\t}\n\tf(i,1,tot[0]) {\n\t\tffc[i] = 0;\n\t\tf(j,1,i) {\n\t\t\tif(fac[0][i] % fac[0][j] == 0) {\n\t\t\t\tfacf[i][++ffc[i]] = j;\n\t\t\t}\n\t\t}\n\t}\n\tf(i,1,tot[1]) {\n\t\tfyc[i] = 0;\n\t\tf(j,1,i) {\n\t\t\tif(fac[1][i] % fac[1][j] == 0) facy[i][++fyc[i]] = j;\n\t\t}\n\t}\n\tf(j,1,tot[1]) {\n\t\tint y = fac[1][j];\n\t\tf(i,1,okc[j]) {\n\t\t\tint x = fac[0][okf[j][i]], I = okf[j][i];\n\t\t\tf(k,1,ffc[I]) {\n\t\t\t\tint t = facf[I][k];\n\t\t\t\tqat[t][++qc[t]] = I;\n\t\t\t}\n\t\t}\n\t\tint nowp = 0;\n\t\td(i,1,tot[0]) {\n\t\t\tint nl = C/fac[0][i];\n\t\t\twhile(nowp + 1 <= fyc[j] && fac[1][facy[j][nowp + 1]] <= nl) ++nowp;\n\t\t\tif(!nowp) { qc[i] = 0; continue ; }\n\t\t\tf(q,1,qc[i]) {\n\t\t\t\tint Qxid = qat[i][q], Qx = fac[0][Qxid];\n\t\t\t\tif(1LL * (Qx/fac[0][i]) * (y/fac[1][facy[j][nowp]]) <= C) upd(j, Qxid, fac[0][i] * fac[1][facy[j][nowp]]);\n\t\t\t}\n\t\t\tqc[i] = 0;\n\t\t}\n\t\tf(i,1,okc[j]) {\n\t\t\tif(ans[j][okf[j][i]] == inf) continue;\n\t\t\tint rans = 1LL * fac[1][j] * fac[0][okf[j][i]] / ans[j][okf[j][i]];\n\t\t\taal ^= rans;\n\t\t\t++s;\n\t\t}\n\t}\n\tcout << s << ' ' << aal << endl;\n}\nint main() {\n\tint T=rd(); while(T--) solve();\n\treturn 0;\n}\n```",
        "postTime": 1674915602,
        "uid": 133345,
        "name": "lightup37",
        "ccfLevel": 6,
        "title": "CF1792E \u9898\u89e3"
    },
    {
        "content": "## \u505a\u6cd5\n\n\u9996\u5148\u7b5b\u51fa $m1,m2$ \u7684\u56e0\u6570\uff0c\u4ea4\u53c9\u76f8\u4e58\u5f97\u5230 $m$ \u7684\u56e0\u6570\u3002\n\n\u7136\u540e\u8003\u8651\u80fd\u6574\u9664 $m$ \u56e0\u6570\u7684\u6570\u4e00\u5b9a\u8fd8\u662f $m$ \u56e0\u6570\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e $m$ \u7684\u56e0\u6570\u8fdb\u884c\u7b5b\u9664\u3002\n\n\u8bbe\u679a\u4e3e\u5230\u5f53\u524d\u884c\u662f $x$ ,\u5f53\u524d\u56e0\u6570\u662f $y$\uff0c\u5f53 $x\\times n<y$ \u65f6\u5c31\u53ef\u4ee5\u9000\u51fa\u5faa\u73af\u4e86\u3002\n\n\u591a\u6b21\u7b5b\u9664\u5df2\u7ecf\u88ab\u7b5b\u9664\u8fc7\u7684\u6570\u662f\u5f88\u6d6a\u8d39\u65f6\u95f4\u7684\uff0c\u56e0\u6b64\u7528\u7528\u94fe\u8868\u7ef4\u62a4\u8fd8\u6ca1\u6709\u88ab\u7b5b\u9664\u7684\u56e0\u6570\uff0c\u5220\u9664\u662f $O(1)$ \u7684\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(d(k)^2)$ \u7684\uff0c\u5176\u4e2d $d(k)$ \u6307\u7684\u662f $k$ \u7684\u56e0\u6570\u4e2a\u6570\u3002\n\n$10^{18}$ \u4ee5\u5185\u7684\u6570 $d(k)$ \u6700\u591a\u4e3a 103680\u3002\u4f46\u662f\u7531\u4e8e\u6bcf\u6b21\u4ece\u5c0f\u5230\u5927\u679a\u4e3e\u884c\u6570\u65f6\u4f1a\u5feb\u901f\u7b5b\u6389\u5927\u91cf\u7684\u6570\uff0c\u5e76\u4e14\u5927\u4e8e $10^9$ \u7684\u56e0\u6570\u4e0d\u4f1a\u88ab\u7528\u4f5c\u9664\u6570\uff0c\u56e0\u6b64\u65f6\u95f4\u662f\u5b8c\u5168\u53ef\u4ee5\u901a\u8fc7\u7684\u3002\n\n## \u4ee3\u7801\n\n\n```cpp\nusing namespace std;\ninline ll read(){\n\tll x=0,f=1;\n\tchar c=getchar();\n\twhile(c<'0'||c>'9'){\n\t\tif(c=='-') f=-1;\n\t\tc=getchar();\n\t}\n\twhile(c>='0'&&c<='9'){\n\t\tx=x*10+c-48;\n\t\tc=getchar();\n\t}\n\treturn x*f;\n}\nconst ll N=1e7+5;\nll t,n,m1,m2,k,num,ans;\nvector<ll> v,v1,v2;\ninline void get_p(ll x,vector<ll> &v){\n\tv.clear();\n\tfor(ll i=1;i*i<=x;i++){\n\t\tif(x%i==0){\n\t\t\tv.push_back(i);\n\t\t\tif(i*i!=x) v.push_back(x/i);\n\t\t}\n\t}\n}\nll pre[N],nxt[N],val[N];\ninline void get_ans(){\n\tfor(ll x:v){\n\t\tif(x>k) break;\n\t\tfor(ll i=nxt[0];i!=n+1;i=nxt[i]){\n\t\t\tif(val[i]%x==0&&val[i]/x<=k){\n\t\t\t\tnum++;ans^=x;\n\t\t\t\tpre[nxt[i]]=pre[i];\n\t\t\t\tnxt[pre[i]]=nxt[i];\n\t\t\t}else if(val[i]%x==0) break;\n\t\t}\n\t}\n}\nint main(){\n\tt=read();\n\twhile(t--){\n\t\tk=read();m1=read();m2=read();\n\t\tnum=0;ans=0;\n\t\tget_p(m1,v1);get_p(m2,v2);\n\t\tfor(ll x:v1) for(ll y:v2) v.push_back(x*y);\n\t\tsort(v.begin(),v.end());\n\t\tv.resize(unique(v.begin(),v.end())-v.begin());\n\t\tn=v.size();\n\t\tnxt[0]=1;\n\t\tfor(ll i=1;i<=n;i++){\n\t\t\tpre[i]=i-1;nxt[i]=i+1;\n\t\t\tval[i]=v[i-1];\n\t\t}\n\t\tget_ans();\n\t\tprintf(\"%lld %lld\\n\",num,ans);\n\t\tv.clear();\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1679215046,
        "uid": 406832,
        "name": "Mikefeng",
        "ccfLevel": 7,
        "title": "CF1792E"
    },
    {
        "content": "\u9996\u5148\u5bf9 $m_1,m_2$ \u5206\u89e3\u8d28\u56e0\u6570\uff0c\u7136\u540e\u7ec4\u5408\u8d77\u6765\u66b4\u529b\u641c\u51fa $m$ \u7684\u6240\u6709\u56e0\u6570\uff0c\u56e0\u6570\u6570\u91cf\u5927\u7ea6\u662f $O(m^{\\frac{1}{3}})$\uff0c\u5bf9\u4e8e $m\\le 10^8$ \u6700\u591a\u4e3a $105000$ \u4e2a\u3002\n\n\u5c06 $m$ \u7684\u56e0\u6570\u6309\u4ece\u5c0f\u5230\u5927\u5b58\u5728 $d_1,d_2,\\dots,d_l$ \u4e2d\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $d_i$\uff0c\u6211\u4eec\u8981\u6c42\u4e00\u4e2a\u6700\u5c0f\u7684 $x$ \u6ee1\u8db3 $x$ \u662f $d_i$ \u7684\u56e0\u6570\u4e14 $\\dfrac{d_i}{x}\\le n$\u3002\n\n$\\therefore x\\ge \\left\\lceil\\dfrac{d_i}{n}\\right\\rceil$\n\n\u4e8e\u662f\u5148\u4e8c\u5206\u51fa\u4e00\u4e2a $d_j$ \u6ee1\u8db3 $d_j\\ge \\left\\lceil\\dfrac{d_i}{n}\\right\\rceil$ \u7136\u540e\u5411\u540e\u904d\u5386\u76f4\u5230 $d_j$ \u4e3a $d_i$ \u7684\u4e00\u4e2a\u56e0\u6570\u6216 $d_j>\\min(n,d_i)$\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nvector<long long> a;\nmap<long long, long long> mp;\nlong long t, n, m, m2, cnt, ans;\nvector<pair<long long, long long> > v;\nvoid dfs(long long x, long long s) {\n    if(x == v.size()) {\n        a.push_back(s);\n        return;\n    }\n    auto j = v[x];\n    for(long long i = 0; i <= j.second; i++) {\n        dfs(x + 1, s);\n        if(i != j.second)\n            s *= j.first;\n    }\n    return;\n}\nvoid init() {\n    v.clear();\n    for(long long i = 2; i < 100001; i++)\n        if(!(m % i))\n            while(!(m % i))\n                mp[i]++, m /= i;\n    if(m > 1)\n        mp[m]++;\n    for(long long i = 2; i < 100001; i++)\n        if(!(m2 % i))\n        while(!(m2 % i))\n            mp[i]++, m2 /= i;\n    if(m2 > 1)\n        mp[m2]++;\n    for(auto i : mp)\n        v.push_back(i);\n    dfs(0, 1);\n    return;\n}\nint main() {\n    ios::sync_with_stdio(0);\n    cin.tie(0);\n    cout.tie(0);\n    cin >> t;\n    while(t--) {\n        cin >> n >> m >> m2, mp.clear(), a.clear(), init(), sort(a.begin(), a.end()), ans = cnt = 0;\n        for(long long i : a) {\n            auto it = lower_bound(a.begin(), a.end(), (i - 1) / n + 1);\n            if(*it <= n) {\n                while(it != a.end() && i % *it) {\n                    it++;\n                    if(it != a.end() && *it > n)\n                        break;\n                }\n                if(it != a.end() && *it <= n)\n                    cnt++, ans ^= *it;\n            }\n        }\n        cout << cnt << ' ' << ans << '\\n';\n    }\n    return 0;\n}\n\n```",
        "postTime": 1674895982,
        "uid": 374330,
        "name": "ACACACACACACACACACAC",
        "ccfLevel": 6,
        "title": "CF1792E\u9898\u89e3"
    }
]
[
    {
        "content": "\u5bb9\u6613\u53d1\u73b0\u56fe\u4e2d\u6240\u6709\u7b80\u5355\u56de\u8def\u90fd\u662f\u4e00\u4e2a\u5bbd\uff08\u4e0e $y$ \u8f74\u5e73\u884c\u7684\u8fb9\uff09\u4e3a $y$ \u7684\u77e9\u5f62\u3002\n\n\u90a3\u4e48\u6240\u6709\u6ee1\u8db3\u9898\u610f\u7684\u957f\u5ea6\u90fd\u5f62\u5982 $2(a_i-a_j+y)$\uff0c\u5176\u4e2d $i>j$\u3002\n\n\u5f88\u5bb9\u6613\u60f3\u5230\u76f4\u63a5 $\\mathcal{O}(n^2)$ \u679a\u4e3e $i,j$ \u66b4\u529b\u6c42\u51fa\u6240\u6709\u5408\u6cd5\u957f\u5ea6\uff0c\u7136\u540e\u679a\u4e3e\u500d\u6570 $\\mathcal{O}(x\\log x)$ \u9884\u5904\u7406\u51fa\u6240\u6709\u7b54\u6848\uff0c\u8fd9\u6837\u5c31\u80fd $\\mathcal{O}(1)$ \u56de\u7b54\u5355\u4e2a\u8be2\u95ee\u3002\n\n\u9700\u8981\u4f18\u5316 $\\mathcal{O}(n^2)$ \u7684\u90e8\u5206\u3002\n\n---\n\n## Sol 1\uff1a\n\n\u4f7f\u7528 `bitset` \u6765\u4f18\u5316\u3002\n\n\u5177\u4f53\u505a\u6cd5\u5c31\u662f\u5148\u641e\u4e00\u4e2a\u521d\u59cb bitset\uff0c\u5bf9\u4e8e\u6240\u6709\u7684 $i$\uff0c\u628a\u6240\u6709\u7b2c $a_i$ \u4f4d\u8bbe\u6210 $1$\uff0c\u5176\u4ed6\u4f4d\u8bbe\u6210 $0$\u3002\n\n\u628a\u6240\u6709\u5de6\u79fb $a_i$ \u4f4d\u7684\u521d\u59cb\u7684 bitset \u6216\u8d77\u6765\u5f97\u5230\u6700\u7ec8\u8981\u6c42\u7684 bitset\uff0c\u6ee1\u8db3\u82e5\u7b2c $k$ \u4f4d $1$ \u5219\u81f3\u5c11\u4e00\u7ec4 $(i,j)$ \u6ee1\u8db3 $a_i-a_j=k$\u3002\n\n\u8fd9\u6837\u5c31\u5728 $\\mathcal{O}(\\frac{n^2}{\\omega})$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u6c42\u51fa\u4e86\u6240\u6709\u5408\u6cd5\u957f\u5ea6\u3002\n\n\u867d\u7136\u7406\u8bba\u4e0a\u8fc7\u4e0d\u53bb\uff0c\u4f46\u6211\u6ca1\u5361\u5e38\u5c31\u8fc7\u4e86\uff0c\u4e0d\u8fc7\u6700\u6162\u70b9\u8dd1\u4e86 $1825ms$\u3002\u3002\n\n\u7ec6\u8282\u770b\u4ee3\u7801\u3002\n\n***code:***\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<bitset>\nusing namespace std;\n#define N 200002\nconst int mx=200000;\nbitset<N> p,myh;\nint n,x,y,a[N],ans[N<<2],Q;\nint main(){\n\tn=read(),x=read(),y=read();\n\tfor(int i=0;i<=n;++i){\n\t\ta[i]=read();\n\t\tp[a[i]]=1;\n\t}\n\tfor(int i=0;i<=n;++i){\n\t\tmyh|=p>>a[i];\n\t}\n\tfor(int i=1;i<=x;++i){\n\t\tif(myh[i]){\n\t\t\tint gu=i+y;\n\t\t\tfor(int j=gu;j<=500000;j+=gu){\n\t\t\t\tans[j]=max(ans[j],gu);\n\t\t\t}\n\t\t}\n\t}\n\tQ=read();\n\twhile(Q--){\n\t\tint L=read();\n\t\tprintf(\"%d \",L&1||!ans[L>>1]?-1:ans[L>>1]<<1);\n\t}\n\treturn 0;\n}\n\n```\n\n## Sol 2\uff1a\n\n\u641e\u51fa\u751f\u6210\u51fd\u6570\uff1a $A(x)=\\sum_{i=0}^nx^{a_i}$\u3002\n\n\u8fd9\u4e0d\u5c31\u662f\u4e2a\u51cf\u6cd5\u5377\u79ef\u4e48\uff1f\uff01\n\nFFT/NTT \u62ac\u8d70\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(x\\log x)$\u3002\n\n\u6700\u6162\u70b9\u53ea\u8dd1\u4e86 $300ms$ \u5de6\u53f3\u3002\n\n***code:***\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<vector>\n#include<algorithm>\nusing namespace std;\n#define N 600002\nconst int mx=200000;\nconst int mod=998244353;\nconst int G=3;\ntypedef vector<int> poly;\nint n,x,y,tr[N],ans[N],Q;\ninline int qpow(int a,int b){\n\tint ans=1;\n\twhile(b){\n\t\tif(b&1)ans=1LL*ans*a%mod;\n\t\ta=1LL*a*a%mod;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\nconst int invG=qpow(G,mod-2);\nint NTT_init(int n){\n\tint lim=1;\n\twhile(lim<n)lim<<=1;\n\tfor(int i=0;i<lim;++i){\n\t\ttr[i]=(tr[i>>1]>>1)|((i&1)?lim>>1:0);\n\t}\n\treturn lim;\n}\n#define ck(x) (x>=mod?x-mod:x)\nvoid NTT(poly &f,bool flag,int n){\n\tf.resize(n);\n\tfor(int i=0;i<n;++i){\n\t\tif(i<tr[i])swap(f[i],f[tr[i]]);\n\t}\n\tfor(int p=2;p<=n;p<<=1){\n\t\tint len=p>>1;\n\t\tint wn=qpow(flag?G:invG,(mod-1)/p);\n\t\tfor(int k=0;k<n;k+=p){\n\t\t\tint buf=1;\n\t\t\tfor(int i=k;i<k+len;++i){\n\t\t\t\tint t=1LL*buf*f[i+len]%mod;\n\t\t\t\tf[i+len]=ck(f[i]-t+mod);\n\t\t\t\tf[i]=ck(f[i]+t);\n\t\t\t\tbuf=1LL*buf*wn%mod;\n\t\t\t}\n\t\t}\n\t}\n\tif(!flag){\n\t\tint invn=qpow(n,mod-2);\n\t\tfor(int i=0;i<n;++i){\n\t\t\tf[i]=1LL*f[i]*invn%mod;\n\t\t}\n\t}\n}\t\npoly Mul(poly A,poly B){\n\tint n=A.size()+B.size()-1;\n\tint lim=NTT_init(n);\n\tpoly P(lim);\n\tNTT(A,1,lim),NTT(B,1,lim);\n\tfor(int i=0;i<lim;++i){\n\t\tP[i]=1LL*A[i]*B[i]%mod;\n\t}\n\tNTT(P,0,lim);\n\tP.resize(n);\n\treturn P;\n}\nint main(){\n\tn=read(),x=read(),y=read();\n\tpoly A(x+1),B(x+1);\n\tfor(int i=0;i<=n;++i){\n\t\tA[read()]=1;\n\t}\n\tB=A;\n\treverse(B.begin(),B.end());\n\tpoly C=Mul(A,B);\n\tfor(int i=1;i<=x;++i){\n\t\tif(C[i+x]){\n\t\t\tint gu=i+y;\n\t\t\tfor(int j=gu;j<=500000;j+=gu){\n\t\t\t\tans[j]=max(ans[j],gu);\n\t\t\t}\n\t\t}\n\t}\n\tQ=read();\n\twhile(Q--){\n\t\tint L=read();\n\t\tprintf(\"%d \",L&1||!ans[L>>1]?-1:ans[L>>1]<<1);\n\t}\n\treturn 0;\n}\n```\n\n---\n\n[*Froggy's blog*](https://www.luogu.org/blog/1445353309froggy/)\n\n#### \u5471!!",
        "postTime": 1598863160,
        "uid": 100285,
        "name": "Froggy",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1398G \u3010Running Competition\u3011"
    }
]
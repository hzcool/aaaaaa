[
    {
        "content": "\u6253\u9000\u5f79\u72d7 $\\to$ [`George1123`](https://www.cnblogs.com/George1123/p/14202324.html)\u3002\n\n---\n\n## \u9898\u9762\n\n> [CF360D Levko and Sets](https://www.luogu.com.cn/problem/CF360D)\n\n> \u7ed9\u5b9a $a\\{n\\}$ \u548c $b\\{m\\}$ \u548c\u8d28\u6570 $p$\u3002\u5bf9\u4e8e\u6bcf\u4e2a $a_i$\uff0c\u751f\u6210\u4e00\u4e2a\u96c6\u5408\uff0c\u521a\u5f00\u59cb\u53ea\u6709 $1$\uff0c\u6bcf\u6b21\u4ece\u96c6\u5408\u4e2d\u9009\u4e00\u4e2a\u5143\u7d20 $c$\uff0c\u5bf9\u4e8e\u6240\u6709\u7684 $j$\uff0c\u5982\u679c\u6ee1\u8db3 $c\\times a_i^{b_j}\\bmod p$ \u4e0d\u5728\u5f53\u524d\u96c6\u5408\uff0c\u5c31\u628a\u5b83\u52a0\u5165\u96c6\u5408\u3002\u6c42 $n$ \u4e2a\u96c6\u5408\u5e76\u7684\u5927\u5c0f\u3002\n\n> \u6570\u636e\u8303\u56f4\uff1a$1\\le n\\le 10^4$\uff0c$1\\le m\\le 10^5$\uff0c$2\\le p\\le 10^9$\u3002\n\n---\n\n## \u9898\u89e3\n\n\u4e4b\u524d `VP` \u573a\u4e0a\u6ca1\u505a\u51fa\u6765\u540e\u6765\u5b66\u4e86 `zhouyuyang` \u7684\u505a\u6cd5\uff0c\u7136\u540e\u53d1\u73b0\u5b66\u4e86\u4e2a\u5047\u505a\u6cd5\u3002\n\n**Hack**\uff1a`2 1 13 3 5 1`\uff1b\u7b54\u6848\uff1a`6`\uff1b\u9519\u8bef\u8f93\u51fa\uff1a`7`\u3002\n\n\u8bbe $\\varphi=p-1$\uff0c$g=\\gcd(\\varphi,\\gcd_{i=1}^m b_i)$\uff0c$G$ \u662f $p$ \u4efb\u610f\u4e00\u4e2a\u539f\u6839\u3002\n\n\u5f88\u660e\u663e\u6bcf\u4e2a\u96c6\u5408\u5143\u7d20\u5c31\u662f $\\{a_i^{gk}\\bmod p|k\\in N\\}$\u3002\n\n$u^{x}\\equiv u^{x\\bmod \\varphi}\\pmod p$\u3002$x\\in[0,\\varphi)$ \u4e0e $f(x)=G^{x}\\in [1,p)$ \u4e00\u4e00\u5bf9\u5e94\u3002\n\n\u6240\u4ee5\u641e\u51fa\u6240\u6709 $\\varphi$ \u7684\u56e0\u6570\uff0c\u53ef\u4ee5\u5f97\u5230\u5bf9\u4e8e\u6240\u6709\u7684 $i$\uff0c\u6700\u5c0f\u7684 $c_i$ \u6ee1\u8db3 ${a_i}^{gc_i}\\equiv 1\\pmod p$\u3002\u90a3\u4e48\u8fd9\u4e2a\u96c6\u5408\u6709 $c_i$ \u4e2a\u5143\u7d20\u3002\n\n\u8003\u8651\u662f\u54ea $c_i$ \u4e2a\u5143\u7d20\uff1a$\\{a^{g},a^{2g},...,a^{(c_i-1)g}\\}$\uff08$\\bmod p$\uff0c\u4e0b\u540c\uff09\u3002\n\n\u6216\u8005\u8bf4\uff1a$\\{G^{0},G^{\\varphi/c_i},G^{2\\varphi/c_i},...,G^{(c_i-1)\\varphi/c_i}\\}$\u3002\u8fd9\u4e24\u4e2a\u96c6\u5408\u662f\u7b49\u4ef7\u7684\u3002\n\n\u8bbe $s_i=\\frac{\\varphi}{c_i}$\uff0c\u6c42 $n$ \u4e2a\u96c6\u5408\u7684\u5e76\u96c6\uff0c\u95ee\u9898\u8f6c\u5316\u4e3a\uff1a\u6709\u591a\u5c11\u4e2a $1\\le x\\le \\varphi$ \u6ee1\u8db3 $\\exists s_i|x$\u3002\n\n\u5f88\u591a\u4eba\u8fd9\u91cc\u5199\u9519\u4e86\uff0c\u53ef\u662f `Codeforces` \u7684\u6570\u636e\u4e0d\u5f3a\uff0c\u8bef\u5bfc\u4e86\u597d\u591a\u4eba\u3002\n\n\u8bbe $d|\\varphi:f(d)$ \u8868\u793a $d$ \u7684\u500d\u6570\u4e2d\u53ea\u88ab $d$ \u6807\u8bb0\u4e0d\u88ab $d$ \u7684\u5176\u4ed6\u662f $\\varphi$ \u7684\u56e0\u6570\u7684\u500d\u6570\u6807\u8bb0\u7684\u6570\u7684\u4e2a\u6570\u3002\n\n\u5982\u679c $\\exists s_i|d$\uff0c$f(d)=\\frac{\\varphi}{d}-\\sum_{dk|\\varphi}f(dk)$\uff1b\u5426\u5219 $f(d)=0$\u3002\n\n\u7136\u540e\u7b54\u6848\u662f $\\sum_{d|\\varphi} f(d)$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta((n+m)\\log p+d(\\varphi)(n+d(\\varphi)))$\u3002\n\n---\n\n## \u4ee3\u7801\n\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef double db;\n#define x first\n#define y second\n#define bg begin()\n#define ed end()\n#define pb push_back\n#define mp make_pair\n#define sz(a) int((a).size())\n#define R(i,n) for(int i(0);i<(n);++i)\n#define L(i,n) for(int i((n)-1);i>=0;--i)\nconst int iinf=0x3f3f3f3f;\nconst ll linf=0x3f3f3f3f3f3f3f3f;\n\n//Data\nconst int N=1e4,M=1e5,d_N=4e4;\nint n,m,p,a[N],b[M],c[N];\nint d_n,pd[d_N],f[d_N];\n\n//Math\nint gcd(int a,int b){return a?gcd(b%a,a):b;}\nint mypow(int a,int x=p-2,int res=1){\n    for(;x;x>>=1,a=1ll*a*a%p)\n        (x&1)&&(res=1ll*res*a%p);\n    return res;\n}\n\n//Main\nint main(){\n    ios::sync_with_stdio(false);\n    cin.tie(0),cout.tie(0);\n    cin>>n>>m>>p;\n    int phi=p-1,g=phi;\n    R(i,n) cin>>a[i];\n    R(i,m) cin>>b[i],g=gcd(g,b[i]);\n    for(int d=1;d*d<=phi;++d)if(phi%d==0)\n        pd[d_n++]=d,d*d<phi?pd[d_n++]=phi/d:0;\n    sort(pd,pd+d_n);\n    R(i,n){\n        int t=mypow(a[i],g);\n        R(j,d_n)if(mypow(t,pd[j])==1)\n            {c[i]=phi/pd[j]; break;}\n    }\n    int ns=0;\n    L(i,d_n){\n        bool mark=false;\n        R(j,n)if(pd[i]%c[j]==0){mark=true; break;}\n        if(mark){\n            f[i]=phi/pd[i];\n            for(int j=i+1;j<d_n;++j)\n                if(pd[j]%pd[i]==0) f[i]-=f[j];\n            ns+=f[i];\n        }\n    }\n    cout<<ns<<'\\n';\n    return 0;\n}\n```\n\n---\n\n**\u795d\u5927\u5bb6\u5b66\u4e60\u6109\u5feb\uff01**",
        "postTime": 1609145474,
        "uid": 118365,
        "name": "George1123",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF360D \u3010Levko and Sets\u3011"
    },
    {
        "content": "## $\\text{Description}$\n\u6709\u4e24\u4e2a\u6574\u6570\u6570\u7ec4 $a_1,a_2......a_n$ \u548c $b_1,b_2......b_m$\uff0c\u4e0e\u4e00\u4e2a\u8d28\u6570 $p$ \uff0c\u73b0\u5728\u8981\u751f\u6210 $n$ \u4e2a\u96c6\u5408\uff0c\u7b2c $i$ \u4e2a\u96c6\u5408\u751f\u6210\u65b9\u5f0f\u5982\u4e0b\uff1a  \n1. \u5f00\u59cb\uff0c\u96c6\u5408\u53ea\u6709\u5143\u7d20 $1$.  \n2. \u4ece\u96c6\u5408\u4e2d\u9009\u4e00\u4e2a\u5143\u7d20 $c$ \uff0c\u5bf9\u4e8e\u6240\u6709\u7684 $j$ \uff0c\u5982\u679c\u6ee1\u8db3 $(c\\times a_i^{b_j})\\bmod p$ \u4e0d\u5728\u5f53\u524d\u96c6\u5408\uff0c\u5c31\u628a\u5b83\u52a0\u5165\u96c6\u5408.  \n3. \u91cd\u590d\u4ee5\u4e0a\u6b65\u9aa4.  \n\n\u6c42 $n$ \u4e2a\u96c6\u5408\u7684\u5e76\u7684\u5927\u5c0f.  \n$n\\le 10^4,m\\le 10^5,p\\le 10^9$  \n$a_i\\le p,b_i\\le10^9$\n## $\\text{Solution}$\n\u9898\u610f\u7b80\u5316\u4e00\u4e0b\u5c31\u662f\u96c6\u5408\u91cc\u7684\u5143\u7d20\u662f $a_i$ \u7684\uff08$b_i$\u7ec4\u5408\u76f8\u52a0\uff09\u6b21\u5e42\u6a21 $p$ \u7684\u7ed3\u679c.  \n\u8bbe $\\phi=p-1,g=\\gcd(\\phi,\\gcd_{i=1}^m b_i)$\uff0c\u90a3\u4e48\u7b2c $i$ \u4e2a\u96c6\u5408\u53ef\u4ee5\u7b49\u4ef7\u4e3a\uff1a\n$$\\{a_i^{kg}(\\bmod\\space p)|k\\in N\\}$$\n\u8bbe $c_i$ \u4e3a\u6700\u5c0f\u7684 $k$\uff0c\u6ee1\u8db3 $a_i^{gc_i}=1(mod\\space p)$\uff0c$c_i$ \u5fc5\u7136\u662f $\\phi$ \u7684\u56e0\u5b50\uff0c\u53ef\u4ee5\u9884\u5904\u7406\u51fa $\\phi$ \u7684\u56e0\u5b50\u540e\u66b4\u529b\u6c42\u51fa.  \n\u90a3\u4e48\u8fd9\u4e2a\u96c6\u5408\u53ef\u4ee5\u7b49\u4ef7\u4e3a\uff1a\n$$\\{1,a_i^{g},a_i^{2g},...,a_i^{(c_i-1)g}\\}$$\n\u8bbe $R$ \u4e3a $p$ \u7684\u539f\u6839\uff0c\u90a3\u4e48\u4e0a\u9762\u7684\u96c6\u5408\u7b49\u4ef7\u4e8e\uff1a\n$$\n\\large\n\\{R^0,R^{\\frac{\\phi}{c_i}},R^{2\\times \\frac{\\phi}{c_i}},...,R^{(c_i-1)\\times \\frac{\\phi}{c_i}}\\}$$\n\u90a3\u4e48\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a\u4e86\u7ed9\u51fa\u4e00\u4e2a\u6570\u5217 $c_{1...n}$ \uff0c\u6c42 $[1,\\phi]$ \u4e4b\u95f4\u7531 $c$ \u6570\u5217\u7b5b\u51fa\u7684\u6570\u7684\u4e2a\u6570\uff0c\u5176\u4e2d $c_i$  \u5747\u662f $\\phi$ \u7684\u56e0\u5b50.  \n\u8bbe $f_x$ \u4e3a**\u53ea**\u88ab $x$ \u7b5b\u6389\u7684\u6570\u7684\u4e2a\u6570.  \n\u5c31\u6709 \n$$f_x=\\frac{\\phi}{x}-\\sum f_{kx}$$  \n\u7531\u4e8e\u6240\u6709\u7684 $c_i$ \u90fd\u662f $\\phi$ \u7684\u56e0\u6570\uff0c\u6240\u4ee5\u4e5f\u53ea\u679a\u4e3e $\\phi$ \u7684\u56e0\u6570\u5373\u53ef.  \n\u6700\u540e\u7684\u7b54\u6848\u5c31\u662f\u628a\u6240\u6709\u662f $c_i$ \u500d\u6570\u7684 $x$ \u7684 $f_x$ \u52a0\u8d77\u6765. \n## $\\text{Code}$\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define debug(...) fprintf(stderr,__VA_ARGS__)\nconst int N=2e5+100;\ninline ll read(){\n  ll x(0),f(1);char c=getchar();\n  while(!isdigit(c)){if(c=='-')f=-1;c=getchar();}\n  while(isdigit(c)){x=(x<<1)+(x<<3)+c-'0';c=getchar();}\n  return x*f;\n}\nint n,m;\nint mod;\ninline ll ksm(ll x,ll k){\n  ll res(1);\n  while(k){\n    if(k&1) res=res*x%mod;\n    x=x*x%mod;k>>=1;\n  }\n  return res;\n}\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nint a[N],b[N],c[N],g;\nint pd[N],tot;\nint f[N];\nint main(){\n  #ifndef ONLINE_JUDGE\n  freopen(\"a.in\",\"r\",stdin);\n  freopen(\"a.out\",\"w\",stdout);\n#endif\n  n=read();m=read();mod=read();\n  int phi=mod-1;g=phi;\n  for(int i=1;i<=n;i++) a[i]=read();\n  for(int i=1;i<=m;i++) b[i]=read(),g=gcd(g,b[i]);  \n  for(int i=1;i*i<=phi;i++){\n    if(phi%i) continue;\n    pd[++tot]=i;if(i*i<phi) pd[++tot]=phi/i;\n  }\n  sort(pd+1,pd+1+tot);\n  for(int i=1;i<=n;i++){\n    int d=ksm(a[i],g);\n    for(int j=1;j<=tot;j++){\n      if(ksm(d,pd[j])==1){\n\tc[i]=phi/pd[j];break;\n      }\n    }\n    //printf(\"i=%d c=%d\\n\",i,c[i]);\n  }\n  int res(0);\n  for(int i=tot;i>=1;i--){\n    bool flag=0;\n    for(int j=1;j<=n;j++){\n      if(pd[i]%c[j]==0){flag=1;break;}\n    }\n    if(!flag) continue;\n    f[i]=phi/pd[i];\n    for(int j=i+1;j<=tot;j++){\n      if(pd[j]%pd[i]==0) f[i]-=f[j];\n    }\n    res+=f[i];\n  }\n  printf(\"%d\\n\",res);\n  return 0;\n}\n/*\n3 3\ntsy\n*/\n\n```\n",
        "postTime": 1639642944,
        "uid": 449265,
        "name": "wind_whisper",
        "ccfLevel": 10,
        "title": "CF360D Levko and Sets"
    },
    {
        "content": "2600* \u7684\u6570\u8bba\u9898\uff0c\u5bb3\u6015\u3002\n\n\u9996\u5148\u7814\u7a76\u5355\u4e2a\u96c6\u5408\uff0c\u53d1\u73b0\u6307\u6570\u662f $b$ \u6570\u7ec4\u7684\u7ebf\u6027\u7ec4\u5408\u3002\n\n\u53c8\u56e0\u4e3a\u662f\u5728\u6a21 $p$ \u610f\u4e49\u4e0b\uff0c\u5b9e\u8d28\u4e0a\u662f $b$ \u6570\u7ec4\u7684\u7ebf\u6027\u7ec4\u5408\u6a21 $(p-1)$\u3002\n\n\u770b\u4e0a\u53bb\u591a\u4e86\u4e2a\u6a21\u96be\u53d7\u4e86\uff0c\u5b9e\u9645\u4e0a\u7b80\u5355\u4e86\uff0c\u53ef\u4ee5\u76f4\u63a5\u5957\u7528\u88f4\u8700\u5b9a\u7406\uff0c\u4ee4 $g$ \u4e3a $b$ \u6570\u7ec4\u548c $(p-1)$ \u7684 $\\gcd$\uff0c\u90a3\u4e48\u6307\u6570\u662f\u4efb\u610f $\\gcd$ \u7684\u500d\u6570\uff08\u6a21 $(p-1$ \u610f\u4e49\u4e0b\uff09\u3002\n\n\u4e4b\u6240\u4ee5\u8bf4\u7b80\u5355\u4e86\uff0c\u662f\u56e0\u4e3a\u5982\u679c\u6ca1\u6709\u8fd9\u4e2a\u6a21\u6570\uff0c\u6211 $b$ \u6570\u7ec4\u7684\u7ebf\u6027\u7ec4\u5408\u7684\u7cfb\u6570\u53ea\u80fd\u662f\u6b63\u7684\uff0c\u88f4\u8700\u5b9a\u7406\u4e0d\u7ba1\u7528\u3002\u800c\u591a\u4e86\u4e2a\u53d6\u6a21\uff0c\u4e5f\u5c31\u662f\u4f60\u7684\u7ebf\u6027\u7ec4\u5408\u591a\u4e86\u4e2a $a(p-1)$\uff0c\u800c\u8fd9\u4e2a $a$ \u662f\u53ef\u4ee5\u4e3a\u8d1f\u7684\uff0c\u53ea\u8981\u7ebf\u6027\u7ec4\u5408\u91cc\u4e00\u4e2a\u7cfb\u6570\u4e3a\u8d1f\u5c31\u591f\u7528\u4e86\u3002\n\n\u4f46\u662f\u8fd9\u6837\uff0c$n$ \u4e2a\u96c6\u5408\u7684\u5e95\u6570\u8fd8\u662f\u4e0d\u7edf\u4e00\uff0c\u5f88\u96be\u53d6\u5e76\u3002\n\n\u6211\u4eec\u8981\u7edf\u4e00\u5e95\u6570\uff0c\u5bb9\u6613\u60f3\u5230\u968f\u4fbf\u6c42\u4e00\u4e2a\u539f\u6839 $g$\u3002\u7136\u540e\u6211\u4eec\u89c2\u5bdf\u539f\u6765\u7684\u96c6\u5408\uff0c\u5e94\u8be5\u662f\u6c42\u51fa $a^g$ \u7684\u9636 $c$ \u4ee5\u540e\uff0c\u662f\u8fd9\u6837\u7684\uff1a\n\n$$\\{a^{0g},a^{1g},a^{2g},....,a^{(c-1)g}\\}$$\n\n\u6211\u4eec\u77e5\u9053\uff0c\u8fd9 $c$ \u4e2a\u6570\u6a21 $p$ \u4e24\u4e24\u4e0d\u540c\uff0c\u8fd9\u662f\u9636\u7684\u5b9a\u4e49\u544a\u8bc9\u6211\u4eec\u7684\u3002\u8fd8\u6709\u4e00\u4e2a\u5f88\u91cd\u8981\u7684\u4e8b\u60c5\uff0c\u5c31\u662f\u8fd9 $c$ \u4e2a\u6570\uff0c\u662f $x^{c}\\equiv 1(\\bmod \\,p)$ \u7684\u6240\u6709\u89e3\u3002\u8fd9\u662f\u62c9\u683c\u6717\u65e5\u5b9a\u7406\u544a\u8bc9\u6211\u4eec\u7684\u3002\n\n\u6211\u4eec\u60f3\u641e\u4e00\u4e2a $g$ \u4e3a\u5e95\u7684\u96c6\u5408\uff0c\u5927\u5c0f\u4e5f\u662f $c$\uff0c\u6240\u4ee5\u6211\u4eec\u4e5f\u8981\u641e\u51fa\u4e00\u4e2a $c$ \u6b21\u65b9\u4e3a $1$ \u7684\u6240\u6709\u6570\u7684\u96c6\u5408\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5bb9\u6613\u6784\u9020\u51fa\uff1a\n\n$$\\{g^{0\\frac{p-1}{c}},g^{1\\frac{p-1}{c}},...,g^{(c-1)\\frac{p-1}{c}} \\}$$\n\n\u8fd9 $c$ \u4e2a\u6570\u4e5f\u662f\u6a21 $p$ \u4e92\u4e0d\u76f8\u540c\u7684\uff0c\u8fd9\u91cc\u53ef\u4ee5\u53cd\u8bc1\u3002\u540c\u65f6\u4e5f\u6784\u6210 $c$ \u6b21\u65b9\u4e3a $1$ \u7684\u6570\u7684\u6240\u6709\u89e3\uff0c\u6240\u4ee5\u4e0a\u4e0b\u4e24\u4e2a\u96c6\u5408\u7b49\u4ef7\u3002\n\n\u4ee4 $s=\\frac{p-1}{c}$\uff0c$n$ \u4e2a $s$ \u6784\u6210\u4e00\u4e2a\u96c6\u5408 $S$\u3002\u73b0\u5728\u8981\u627e\u5230 $[1,p)$ \u4e2d\u6709\u591a\u5c11\u4e2a\u6570\uff0c\u662f $S$ \u4e2d\u67d0\u4e2a\u6570\u7684\u500d\u6570\u3002\n\n\u9996\u5148\u6ce8\u610f\u5230 $s\\mid (p-1)$\uff0c\u800c $10^9$ \u8303\u56f4\u5185\u56e0\u6570\u6700\u591a\u7684\u6570\u7684\u56e0\u6570\u4e2a\u6570\uff0c\u5373 $\\max\\{d(n)\\}=1344$\uff0c\u8bb0\u8fd9\u4e2a\u5e38\u6570\u4e3a $\\omega$\uff0c\u90a3\u4e48 $|S|\\le \\omega$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u8bbe\u8ba1\u4e00\u4e2a $O(\\omega^2)$ \u7684\u7b97\u6cd5\uff0c\u5b83\u662f\u6ee1\u8db3\u8981\u6c42\u7684\u3002\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u628a $(p-1)$ \u7684\u6240\u6709\u56e0\u6570\u62c9\u51fa\u6765\uff0c\u5ffd\u7565\u6389\u4e0d\u80fd\u88ab $S$ \u4e2d\u4efb\u4f55\u4e00\u4e2a\u6570\u6574\u9664\u7684\u6570\uff0c\u7136\u540e\u964d\u5e8f\u5730\u5bb9\u65a5\u3002\n\n\u8bbe $f(d)$ \u662f $[1,p)$ \u4e2d $d$ \u7684\u500d\u6570\u4e2a\u6570\uff0c\u4e00\u4e2a\u7ecf\u5178\u7684\u5957\u8def\u662f $f(d)=\\frac{p-1}{d}-\\sum{f(dk)}$\n\n\u6ce8\u610f\u5f53 $d\\nmid (p-1)$ \u65f6 $f(d)=0$\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u6bcf\u6b21\u66b4\u529b\u679a\u4e3e\u6bd4\u5f53\u524d $d$ \u5927\u7684 $(p-1)$ \u7684\u7ea6\u6570\uff0c\u770b\u662f\u4e0d\u662f\u6784\u6210\u500d\u6570\u5173\u7cfb\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\omega n\\log n+\\omega^2)$\uff0c\u5176\u4e2d $\\omega=1344$\u3002\n\n\u7b2c\u4e00\u90e8\u5206\u662f\u5bf9 $n$ \u4e2a\u6570\u6c42\u9636\u7684\u590d\u6742\u5ea6\uff0c\u7b2c\u4e8c\u90e8\u5206\u5c31\u662f\u5bb9\u65a5\u7684\u590d\u6742\u5ea6\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=(a);i<=(b);i++)\n#define per(i,a,b) for(int i=(a);i>=(b);i--)\n#define op(x) ((x&1)?x+1:x-1)\n#define odd(x) (x&1)\n#define even(x) (!odd(x))\n#define lc(x) (x<<1)\n#define rc(x) (lc(x)|1)\n#define lowbit(x) (x&-x)\n#define Max(a,b) (a>b?a:b)\n#define Min(a,b) (a<b?a:b)\n#define next Cry_For_theMoon\n#define il inline\n#define pb(x) push_back(x)\n#define is(x) insert(x)\n#define sit set<int>::iterator\n#define mapit map<int,int>::iterator\n#define pi pair<int,int>\n#define ppi pair<int,pi>\n#define pp pair<pi,pi>\n#define fr first\n#define se second\n#define vit vector<int>::iterator\n#define mp(x,y) make_pair(x,y)\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef unsigned int uint;\ntypedef double db;\nusing namespace std;\nconst int MAXN=1e4+10,MAXM=1e5+10;\nint mypow(int a,int n,int mod=998244353){\n    if(!n)return 1;\n    int tmp=mypow(a,n/2,mod);tmp=1ll*tmp*tmp%mod;\n    if(n&1)tmp=1ll*tmp*a%mod;return tmp;\n}\nint gcd(int a,int b){\n    if(!b)return a;\n    return gcd(b,a%b);\n}\nint n,m,p,g;\nint a[MAXN],b[MAXM];\nint s[MAXN],tot,tag[MAXN],f[MAXN],ans;\nvector<int>d;\nint main(){\n    scanf(\"%d%d%d\",&n,&m,&p);g=(p-1);\n    rep(i,1,n)scanf(\"%d\",&a[i]);\n    rep(i,1,m)scanf(\"%d\",&b[i]),g=gcd(g,b[i]);\n    rep(i,1,(p-1)){\n        if(i*i>(p-1))break;\n        if(i*i==(p-1)){\n            if((p-1)%i==0)d.pb(i);\n        }else{\n            if((p-1)%i==0)d.pb(i),d.pb((p-1)/i);\n        }\n    }\n    sort(d.begin(),d.end());\n    rep(i,1,n){\n        a[i]=mypow(a[i],g,p);\n        //\u6c42a[i]\u7684\u9636\n        int c=0;\n        for(auto u:d){\n            if(mypow(a[i],u,p)==1){\n                c=u;break;\n            }\n        }\n        if(a[i]==1)c=1;\n        s[i]=(p-1)/c;\n    }\n    sort(s+1,s+1+n);\n    tot=unique(s+1,s+1+n)-s-1;\n    int sz=d.size();\n    rep(i,0,sz-1){\n        rep(j,1,tot){\n            if(d[i]%s[j]==0){\n                tag[i]=1;break;\n            }\n        }\n    }\n    per(i,sz-1,0){\n        if(!tag[i])continue;\n        f[i]=(p-1)/d[i];\n        rep(j,i+1,sz-1){\n            if(d[j]%d[i]==0){\n                f[i]-=f[j];\n            }\n        }\n        ans+=f[i];\n    }\n    printf(\"%d\",ans);\n    return 0;\n}\n```",
        "postTime": 1642648120,
        "uid": 340632,
        "name": "Cry_For_theMoon",
        "ccfLevel": 8,
        "title": "\u3010CF360D\u3011Levko and Sets"
    }
]
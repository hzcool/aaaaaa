[
    {
        "content": "# \u9898\u76ee\u94fe\u63a5\n\n[cf1155E](http://codeforces.com/problemset/problem/1155/E)\n\n# sol\n\n**\u601d\u8def**\n\n\u4f17\u6240\u5468\u77e5\uff0cn\u4e2a\u70b9\u53ef\u4ee5\u786e\u5b9a\u4e00\u4e2an-1\u6b21\u591a\u9879\u5f0f\uff0c\u6240\u4ee5\u6211\u4eec\u95ee11\u6b21\u5c31\u53ef\u786e\u5b9a\u8fd9\u4e2a\u591a\u9879\u5f0f\u3002\u95ee11\u6b21\u540e\u53ef\u4ee5[\u9ad8\u65af\u6d88\u5143](https://www.luogu.org/problemnew/solution/P3389)\u6216[\u62c9\u683c\u6717\u65e5\u63d2\u503c](https://www.luogu.org/problemnew/solution/P4781)\uff0c\u4e4b\u540e\u66b4\u529b\u5e26\u51650\u52301e6-3\u4e4b\u95f4\u7684\u6570\u68c0\u9a8c\u3002\n\n\u53ef\u80fd\u4f1a\u6709\u5206\u6570\uff0c\u9700\u8981\u9006\u5143\uff0c\u4f7f\u7528\u62c9\u683c\u6717\u65e5\u63d2\u503c\u4f1a\u66f4\u7b80\u5355\u3002\n\n**code**\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mod=1e6+3;\ninline int powmod(int a,int b) {\n\tint ans=1;\n\twhile(b) {\n\t\tif(b&1)ans=1ll*ans*a%mod;\n\t\ta=1ll*a*a%mod;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\nint p[11];\nint qry(int a) {//\u4ea4\u4e92\u8be2\u95ee\n\tprintf(\"? %d\\n\",a);fflush(stdout);\n\tint t;\n\tcin>>t;\n\treturn t;\n}\nvoid write(int i) {//\u4ea4\u4e92\u8f93\u51fa\n\tprintf(\"! %d\\n\",i);fflush(stdout);\n\texit(0);\n}\nint main() {\n\tfor(int i=0;i<=10;i++) {//\u5148\u95ee11\u6b21\n\t\tp[i]=qry(i);\n\t\tif(!p[i])write(i);\n\t\tfor(int j=0;j<=10;j++) {\n\t\t\tif(i==j)continue;\n\t\t\tp[i]=1ll*p[i]*powmod(i-j,mod-2)%mod;//\u62c9\u683c\u6717\u65e5\u63d2\u503c\uff0c\u987a\u4fbf\u8003\u8651\u9006\u5143\u3002\n\t\t}\n\t}\n\tfor(int i=11;i<mod;i++) {//\u66b4\u529b\u4ee3\u5165\n\t\tint v=0;\n\t\tfor(int j=0;j<=10;j++) {\n\t\t\tint val=1;\n\t\t\tfor(int k=0;k<=10;k++) {\n\t\t\t\tif(j==k)continue;\n\t\t\t\tval=1ll*val*(i-k)%mod;\n\t\t\t}\n\t\t\tv=(v+1ll*val*p[j])%mod;\n\t\t}\n\t\tif(v==0)write(i);\n\t}\n\twrite(-1);\n\treturn 0;\n}\n```",
        "postTime": 1573740101,
        "uid": 151722,
        "name": "hht2005",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1155E \u3010Guess the Root\u3011"
    },
    {
        "content": "$$\\texttt{Foreword}$$\n\n~~\u611f\u89c9\u8fd9\u9053\u4ea4\u4e92\u9898\u597d\u7b80\u5355\u2026\u2026~~\n\n\u6211\u8fd9\u79cd\u4ea4\u4e92\u9ec4\u9898\u90fd\u505a\u4e0d\u51fa\u6765\u7684\u849f\u84bb\u5c3d\u7136\u80fd\u5728 Virtual participation \u4e2d\u8fc7\u4e86\u8fd9\u9898\u3002\n\n$$\\texttt{Description}$$\n\n[CF1155E Guess the Root](https://www.luogu.com.cn/problem/CF1155E)\n\n$$\\texttt{Solution}$$\n\n\u7531\u4e8e\u591a\u9879\u5f0f\u7684\u6b21\u6570\u4e0d\u8d85\u8fc7 $10$\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u8be2\u95ee $11$ \u6b21\u5c31\u53ef\u4ee5\u628a\u591a\u9879\u5f0f\u786e\u5b9a\u4e0b\u6765\u3002\n\n\u5177\u4f53\u5c31\u662f\u89e3\u4e00\u4e2a**\u5341\u4e00\u5143\u4e00\u6b21\u65b9\u7a0b\u7ec4**\uff0c\u660e\u663e\u53ef\u4ee5\u7528 [\u9ad8\u65af\u6d88\u5143](https://www.luogu.com.cn/problem/P3389) \u505a\u3002\n\n~~\u522b\u7684\u5927\u4f6c\u597d\u50cf\u7528\u7684\u90fd\u662f\u62c9\u683c\u6717\u65e5\u63d2\u503c\uff0c\u4ec0\u4e48\u90fd\u4e0d\u4f1a\u7684\u849f\u84bb\u745f\u745f\u53d1\u6296\u3002~~\n\n\u8fd9\u9053\u9898\u7531\u4e8e\u662f\u5728 $\\mod (10^6 + 3)$ \u4e0b\uff0c\u6211\u4eec\u9664\u6cd5\u5c31\u53ef\u4ee5\u6539\u6210\u9006\u5143\uff08\u4e0d\u7528\u8003\u8651\u7cbe\u5ea6\u95ee\u9898\u5566\uff09\uff0c\u5e76\u4e14\u6c42\u96f6\u70b9\u65f6\u53ea\u9700\u8981 $0 \\sim 10^6 + 2$ \u66b4\u529b\u679a\u4e3e\u5c31\u884c\u4e86\u3002\n\n$$\\texttt{Code}$$\n\n```cpp\n#include \"bits/stdc++.h\"\n\nint main() {\n\tstd :: ios_base :: sync_with_stdio(false);\n\tstd :: cin.tie(nullptr);\n\t\n\ttypedef long long ll;\n\tconst int mod = 1e6 + 3;\n\t\n\tstd :: vector < std :: vector <ll> > a(20, std :: vector <ll> (20));\n\t\n\tauto qpow = [&] (ll x, int p) {\n\t\tll ans = 1;\n\t\twhile (p) {\n\t\t\tif (p & 1) ans = ans * x % mod;\n\t\t\tx = x * x % mod;\n\t\t\tp >>= 1;\n\t\t}\n\t\treturn ans;\n\t};\n\t\n\tfor (int i = 1; i <= 11; i++) {\n\t\tstd :: cout << \"? \" << i - 1 << std :: endl;\n\t\tint y; std :: cin >> y;\n\t\tll P = 1ll;\n\t\tfor (int j = 1; j <= 11; j++) {\n\t\t\ta[i][j] = P;\n\t\t\tP = P * 1ll * (i - 1) % mod;\n\t\t}\n\t\ta[i][12] = y;\n\t}\n\t\n\tfor (int i = 1; i <= 11; i++) {\n\t\tfor (int j = i + 1; j <= 12; j++) {\n\t\t\ta[i][j] = a[i][j] * qpow(a[i][i], mod - 2) % mod;\n\t\t}\n\t\ta[i][i] = 1ll;\n\t\tfor (int j = 1; j <= 11; j++) {\n\t\t\tif (i != j) {\n\t\t\t\tfor (int k = i + 1; k <= 12; k++) {\n\t\t\t\t\ta[j][k] = (a[j][k] - a[j][i] * a[i][k] % mod + mod) % mod;\n\t\t\t\t}\n\t\t\t\ta[j][i] = 0;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfor (int i = 0; i < mod; i++) {\n\t\tll sum = 0, P = 1ll;\n\t\tfor (int j = 1; j <= 11; j++) {\n\t\t\tsum = (sum + P * a[j][12]) % mod;\n\t\t\tP = P * 1ll * i % mod;\n\t\t}\n\t\tif (sum == 0) {\n\t\t\tstd :: cout << \"! \" << i << std :: endl;\n\t\t\treturn 0;\n\t\t}\n\t}\n\t\n\tstd :: cout << \"! -1\" << std :: endl;\n\t\n\treturn 0;\n}\n```\n\n$$\\texttt{Thanks for watching!}$$",
        "postTime": 1661741170,
        "uid": 355448,
        "name": "Fido_Puppy",
        "ccfLevel": 0,
        "title": "CF1155E Guess the Root"
    },
    {
        "content": "\u9996\u5148\u770b\u5230\u6a21\u6570\u53ea\u6709$10^6+3$,\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u901a\u8fc7\u67d0\u4e9b\u624b\u6bb5\u641e\u51fa\u6765\u8fd9\u4e2a\u591a\u9879\u5f0f\u7136\u540e\u66b4\u529b\u679a\u4e3e\u6240\u6709\u6570\u5e26\u8fdb\u53bb\u68c0\u9a8c\u662f\u5426\u662f\u6839\u3002\n\n\u81f3\u4e8e\u5982\u4f55\u641e\u51fa\u6765\u8fd9\u4e2a\u591a\u9879\u5f0f\uff1f\n\n\u5047\u8bbe\u591a\u9879\u5f0f\u7684\u6b21\u6570\u4e3ak,\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u641e\u51fa\u6765k\u4e2a\u70b9\u503c\u7136\u540e\u9ad8\u65af\u6d88\u5143\\\u62c9\u683c\u6717\u65e5\u63d2\u503c\u3002\n\n\u5173\u4e8e\u786e\u5b9a\u591a\u9879\u5f0f\u7684\u6b21\u6570\uff1fk\u6b21\u591a\u9879\u5f0f\u5728\u8fde\u7eed\u503c\u57df\u4e0a\u7684k+1\u9636\u5dee\u5206\u5168\u90fd\u662f0.\n\n\u6240\u4ee5\u628a1-50\u7684\u503c\u6c42\u51fa\u6765\u540e\u5dee\u5206\u68c0\u9a8c\u4e00\u4e0b\u591a\u9879\u5f0f\u6b21\u6570\u5373\u53ef\u3002\n\n```cpp\n#include <algorithm>\n#include <cstring>\n#include <iostream>\n#include <tuple>\n#include <utility>\n#include <vector>\nusing int_t = long long int;\nusing pair_t = std::pair<int_t, int_t>;\nusing std::cin;\nusing std::cout;\nusing std::endl;\n\nconst int_t mod = 1e6 + 3;\nconst int_t LARGE = 1e5;\nint_t power(int_t base, int_t index) {\n    const int_t phi = mod - 1;\n    index = (index % phi + phi) % phi;\n    int_t result = 1;\n    while (index) {\n        if (index & 1) result = result * base % mod;\n        index >>= 1;\n        base = base * base % mod;\n    }\n    return result;\n}\n\nvoid poly_mul(const int_t* A, int_t n, const int_t* B, int_t m, int_t* C) {\n    static int_t Cx[LARGE];\n    std::fill(Cx, Cx + 1 + n + m, 0);\n    for (int_t i = 0; i <= n; i++) {\n        for (int_t j = 0; j <= m; j++) {\n            Cx[i + j] = (Cx[i + j] + A[i] * B[j] % mod) % mod;\n        }\n    }\n    std::copy(Cx, Cx + 1 + n + m, C);\n}\nvoid poly_div(const int_t* A, int_t n, const int_t* B, int_t m, int_t* Q) {\n    static int_t R[LARGE];\n    std::copy(A, A + 1 + n, R);\n    for (int_t i = n - m; i >= 0; i--) {\n        int_t Qx = R[i + m] * power(B[m], -1) % mod;\n        Q[i] = Qx;\n        for (int_t j = m; j >= 0; j--) {\n            R[i + j] = (R[i + j] - B[j] * Qx % mod + 2 * mod) % mod;\n        }\n    }\n}\nint main() {\n    std::vector<pair_t> vtxs;\n    std::vector<int_t> vec;\n    for (int_t i = 1; i <= 50; i++) {\n        cout << \"? \" << i << endl;\n        cout.flush();\n        int_t x;\n        cin >> x;\n        vec.push_back(x);\n        vtxs.push_back(pair_t(i, x));\n    }\n    //\u5dee\u5206\n    int_t count = 0;\n    while (true) {\n        for (int_t i = 0; i < vec.size() - 1; i++)\n            vec[i] = (vec[i + 1] - vec[i] + mod) % mod;\n        vec.pop_back();\n        count++;\n#ifdef DEBUG\n        cout << \"diff \" << count << \" ok \";\n        for (int_t x : vec) cout << x << \" \";\n        cout << endl;\n\n#endif\n        if (std::count(vec.begin(), vec.end(), 0) == vec.size()) {\n            break;\n        }\n    }\n\n    while (vtxs.size() > count) vtxs.pop_back();\n#ifdef DEBUG\n    cout << \"count = \" << count << endl;\n    for (auto x : vtxs) cout << x.first << \" \" << x.second << endl;\n#endif\n    static int_t prod[LARGE];\n    prod[0] = 1;\n    for (const auto& kvp : vtxs) {\n        int_t B[] = {mod - kvp.first, 1};\n        poly_mul(prod, vtxs.size(), B, 1, prod);\n    }\n    static int_t result_poly[LARGE];\n    for (const auto& kvp : vtxs) {\n        int_t x, y;\n        std::tie(x, y) = kvp;\n        int_t coef = y;\n        int_t prod2 = 1;\n        for (int_t i = 0; i < vtxs.size(); i++) {\n            if (vtxs[i].first != x) {\n                prod2 = prod2 * (x - vtxs[i].first + mod) % mod;\n            }\n        }\n        coef = coef * power(prod2, -1) % mod;\n        static int_t curr[LARGE];\n        int_t B[] = {mod - x, 1};\n        poly_div(prod, vtxs.size(), B, 1, curr);\n        for (int_t i = 0; i <= vtxs.size(); i++) {\n            result_poly[i] = (result_poly[i] + coef * curr[i] % mod) % mod;\n        }\n    }\n    // for (int_t i = 0; i <= vtxs.size(); i++) cout << result_poly[i] << \" \";\n    // cout << endl;\n    const auto subs = [&](int_t x) {\n        int_t result = 0, pow = 1;\n        for (int_t i = 0; i <= vtxs.size() - 1; i++) {\n            result = (result + pow * result_poly[i] % mod) % mod;\n            pow = pow * x % mod;\n        }\n        return result;\n    };\n    for (int_t i = 0; i < mod; i++) {\n        if (subs(i) == 0) {\n            cout << \"! \" << i << endl;\n            cout.flush();\n            return 0;\n        }\n    }\n    cout << \"! -1\" << endl;\n\n    return 0;\n}\n```",
        "postTime": 1555989265,
        "uid": 56891,
        "name": "officeyutong",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1155E \u3010Guess the Root\u3011"
    },
    {
        "content": "## Solution:\n\n\u8003\u8651\u62c9\u683c\u6717\u65e5\u63d2\u503c\u591a\u9879\u5f0f\u7684\u5f0f\u5b50\uff1a\n$$\nF(x)=\\sum_{i=0}^n(\\prod_{0\\le j\\le n,i\\not =j}\\frac{x-x_i}{x_i-x_j})y_i\n$$\n\u56e0\u4e3a\u81f3\u591a11\u9879\uff0c\u6240\u4ee5\u6211\u4eec\u8be2\u95ee11\u6b21\u5373\u53ef\u5f97\u5230\u8fd9\u4e2a\u591a\u9879\u5f0f\n\n\u7531\u4e8e$x<1e6+3$\uff0c\u5f97\u5230\u591a\u9879\u5f0f\u540e\u6211\u4eec\u66b4\u529b\u679a\u4e3e$x$\u8ba1\u7b97$F(x)$\u5373\u53ef\n\n## Code:\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int mod=1e6+3;\nint p[11];\nint read(){\n    int x=0,f=1;char ch=getchar();\n    while(!isdigit(ch)){if(ch=='-')f=-f;ch=getchar();}\n    while(isdigit(ch)){x=x*10+ch-48;ch=getchar();}\n    return x*f;\n}\nint qpow(int a,int b){\n    int re=1;\n    while(b){\n        if(b&1) re=(re*1ll*a)%mod;\n        b>>=1;a=(a*1ll*a)%mod;\n    }return re%mod;\n}\nint query(int x){\n    printf(\"? %d\\n\",x);fflush(stdout);\n    int val=read();return val;\n}\nvoid write(int x){\n    printf(\"! %d\\n\",x);fflush(stdout);\n    exit(0);\n}\nsigned main(){\n    for(int i=0;i<=10;i++){\n        p[i]=query(i);\n        if(p[i]==0) write(i);\n    }\n    for(int i=0;i<=10;i++){\n        int v=1;\n        for(int j=0;j<=10;j++){\n            if(i==j) continue;\n            v=((i-j+mod)%mod*1ll*v)%mod;\n        }\n        p[i]=(p[i]*1ll*qpow(v,mod-2))%mod;\n    }\n    for(int i=11;i<mod;i++){\n        int v=0;\n        for(int j=0;j<=10;j++){\n            int val=1;\n            for(int k=0;k<=10;k++){\n                if(j==k) continue;\n                val=((i-k+mod)%mod*1ll*val)%mod;\n            }val=(val*1ll*p[j])%mod;\n            v=(v+val)%mod;\n        }\n        if(!v) write(i);\n    }write(-1);\n    return 0;\n}\n\n```\n",
        "postTime": 1573738907,
        "uid": 73702,
        "name": "DQYdqy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1155E \u3010Guess the Root\u3011"
    }
]
[
    {
        "content": "~~\u8fd9\u5927\u6982\u8fd9\u9898\u4e2d\u6587\u7684\u7b2c\u4e00\u7bc7\u9898\u89e3~~\n\n\u6807\u7b7e\uff1a\u671f\u671b\uff0c$\\rm dp$\u3002\uff08\u505a\u7684\u4eba\u592a\u5c11cf\u4e0a\u90fd\u6ca1\u6807\u7b7e\uff09\n\n\u9898\u76ee\u5927\u610f\uff1a\n\n\u6709 $n$ \u4e2a\u7403\uff0c\u5305\u542b\u9ed1\u7403\u548c\u7ea2\u7403\uff0c\u7ed9\u51fa $p_i (0 \\leq i \\leq n)$ \u8868\u793a\u521d\u59cb\u6709 $i$ \u4e2a\u7ea2\u7403\u7684\u6982\u7387 \u548c $c$ \u53d6\u51fa\u4e00\u4e2a\u7403\u7684\u82b1\u8d39\u3002\u82e5\u53d6\u51fa\u7ea2\u7403\u53ef\u4ee5\u83b7\u5f97 $1$ \u7684\u6536\u76ca\uff0c\u90a3\u4e48\u6700\u4f18\u7b56\u7565\u4e0b\u671f\u671b\u53ef\u4ee5\u5f97\u5230\u591a\u5c11\u7684\u6536\u76ca\u3002\uff08$n \\leq 10000$\uff09\u3002\n\n---\n\n\u5728cf\u4e2d\uff0c\u5e38\u6570\u504f\u5c0f\u7684 $O(n^2)$ \u7684\u7b97\u6cd5\u53ef\u4ee5\u5728 $\\rm 250ms$ \u4e0d\u5230\u8dd1\u5b8c\uff0c\u66f4\u4f55\u51b5\u9898\u76ee\u4e2d\u5f00\u4e86 $\\rm 2s$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u8bbe $dp_{i,j}$ \u8868\u793a\u603b\u5171\u53d6\u4e86 $i$ \u4e2a\u7403\uff0c\u5df2\u7ecf\u53d6\u4e86 $j$ \u4e2a\u7ea2\u7403\u65f6\u4ee5\u540e\u7684\u6700\u5927\u6536\u76ca\uff0c\u90a3\u4e48\u7b54\u6848\u4e3a $dp_{0,0}$ \u4e14\u7b2c\u4e00\u7ef4\u53ef\u4ee5\u6eda\u5b58\u3002\n\n\u5728\u8fd9\u4e2a\u5c40\u9762\u4e0b\u6211\u4eec\u8003\u8651\u7b56\u7565\uff08\u53d6\u6216\u8005\u4e0d\u53d6\uff09\uff0c\u6709\u5982\u4e0b\u7684\u8f6c\u79fb\uff1a\n\n$$dp_{i,j}=\\max(0,P_{i,j}\\times(dp_{i+1,j+1}+1)+(1-P_{i,j})\\times dp_{i+1,j} - c)$$\n\n\u5176\u4e2d $P_{i,j}$ \u4e3a\u5728\u5171\u53d6\u4e86 $i$ \u4e2a\u7403\uff0c\u5df2\u7ecf\u53d6\u4e86 $j$ \u4e2a\u7ea2\u7403\u65f6\u4e0b\u4e00\u4e2a\u7403\u662f\u7ea2\u7403\u7684\u6982\u7387\u3002\n\n\n\n$$P_{i,j}=\\sum_{k\\leq j}^{n-i+j} \\dfrac{P(\\text{\u603b\u5171\u6709 k \u4e2a\u7ea2\u7403 | \u53d6 i \u4e2a\u7403\u4e2d\u6709 j \u4e2a\u7ea2\u7403 })\\times (k-j) }{n-i}$$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u6bd4\u8f83\u597d\u61c2\uff0c\u53ef\u4ee5\u81ea\u884c\u7406\u89e3\u3002\u5176\u4e2d $P(A|B)$ \u8868\u793a\u5728\u53d1\u751f $B$ \u7684\u6761\u4ef6\u4e0b $A$ \u53d1\u751f\u7684\u6982\u7387\uff0c\u90a3\u4e48\u6839\u636e\u8d1d\u53f6\u65af\u516c\u5f0f\u6709\n\n$$P(A|B)=P(A) \\frac{P(B|A)}{P(B)}$$\n\n\n\u628a\u5206\u5b50\u4e0a\u7684 $P$ \u5c55\u5f00\u5c31\u53ef\u4ee5\u641e\u5230\u4e00\u4e2a $O(n^3)$ \u7684\u7b97\u6cd5\u4e86\u3002\n\n\u6211\u4eec\u8981\u83b7\u5f97\u66f4\u597d\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5fc5\u987b\u4f18\u5316\u8ba1\u7b97 $P_{i,j}$ \u7684\u8fc7\u7a0b\u3002\n\n\u8fd9\u4e2a $\\Sigma$ \u770b\u8d77\u6765\u5f88\u574f\uff0c\u6211\u4eec\u628a\u5b83\u641e\u6389\uff08\u672c\u8d28\u4e0a\u5c31\u662f\u51cf\u5c11\u91cd\u590d\u8ba1\u7b97\uff09\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u5f53 $i=n-1$ \u65f6\u5019 $k$ \u53ea\u6709 $j+1$ \u548c $j$ \u4e24\u79cd\u53d6\u6cd5\u3002\n\n\u90a3\u4e48 $P_{n-1,j}=P(\\text{\u603b\u5171\u6709 j+1 \u4e2a\u7ea2\u7403 | \u53d6 n-1 \u4e2a\u7403\u4e2d\u6709 j \u4e2a\u7ea2\u7403})$\n\n$=P(\\text{\u603b\u5171\u6709 j+1 \u4e2a\u7ea2\u7403}) \\dfrac{P(\\text{\u53d6 n-1 \u4e2a\u7403\u4e2d\u6709 j \u4e2a\u7ea2\u7403 | \u603b\u5171\u6709 j+1 \u4e2a\u7ea2\u7403})}{P(\\text{\u53d6 n-1 \u4e2a\u7403\u4e2d\u6709 j \u4e2a\u7ea2\u7403})}$\n\n\n$=\\dfrac{P(\\text{\u603b\u5171\u6709 j+1 \u4e2a\u7ea2\u7403})}{P(\\text{\u53d6 n-1 \u4e2a\u7403\u4e2d\u6709 j \u4e2a\u7ea2\u7403})} \\times \\dfrac{j+1}{n}$\n\n\u90a3\u5982\u679c $i \\not = n-1$  \u53c8\u5982\u4f55\uff1f\n\n\u6839\u636e\u4e0a\u9762\u6240\u63a8\u53ef\u4ee5\u5f97\u77e5 $P_{i,j}=\\dfrac{P(\\text{ i+1 \u4e2a\u7403\u4e2d\u6709 j+1 \u4e2a\u7ea2\u7403})}{P(\\text{ i \u4e2a\u7403\u4e2d\u6709 j \u4e2a\u7ea2\u7403})} \\times \\dfrac{j+1}{i+1}$\n\n\u8fd9\u91cc\u5e94\u8be5\u5df2\u7ecf\u53ef\u4ee5\u770b\u51fa\u505a\u6cd5\u4e86\uff0c\u8bbe\u4e00\u4e2a $q_{i,j}$ \u8868\u793a\u5728 $i$ \u4e2a\u7403\u4e2d\u6709 $j $ \u4e2a\u7ea2\u7403\u7684\u6982\u7387\uff0c\u5176\u4e2d $q_{n,i}=p_i$ \u3002\n\n\u90a3\u4e48\u8fd9\u4e2a $q_{i,j}$ \u7684\u8f6c\u79fb\u5c31\u662f \n\n$$q_{i,j}=\\frac{j+1}{i+1}q_{i+1,j+1}+\\frac{i+1-j}{i+1}q_{i+1,j}$$\n\n\u6700\u540e\u6eda\u6389 $q,dp$ \u7684\u7b2c\u4e00\u4f4d\u5c31\u597d\u4e86\u3002\n\n---\n\n\u6838\u5fc3\u4ee3\u7801\uff1a\n\n```cpp\n#define u (i&1)\nscanf(\"%d%lf\",&n,&c);c/=1e6;\nfor(int i=0;i<=n;i++)scanf(\"%lf\",&q[n%2][i]),q[n%2][i]/=1e6;\nfor(int i=n-1;i>=0;i--)\nfor(int j=0;j<=i;j++){D p;\n\t//i\u603b\u53d6\u4e86\u591a\u5c11,j\u8868\u793a\u53d6\u4e86\u591a\u5c11\u7ea2\u7403 \n\tq[u][j]=1.0*(j+1  )/(i+1)*q[u^1][j+1]+\n\t\t\t1.0*(i+1-j)/(i+1)*q[u^1][j  ];\n\tif(q[u][j]<1e-18) continue;//\u9632\u6b62div0 \n\tp=q[u^1][j+1]*(j+1)/q[u][j]/(i+1);\n\tdp[u][j]=max(0.0,dp[u^1][j]*(1-p)+(dp[u^1][j+1]+1)*p-c);\n}\nprintf(\"%.10f\",dp[0][0]);\n\n```\n\n\n\n\n",
        "postTime": 1612059728,
        "uid": 220857,
        "name": "\u7d20\u8d28\u73a9\u5bb6\u5b591\u8d85",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF838F \u3010Expected Earnings\u3011"
    }
]
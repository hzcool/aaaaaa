[
    {
        "content": "\u5728\u6211\u7684\u535a\u5ba2\u770b\u6548\u679c\u66f4\u4f73\uff1a[\u70b9\u8fd9\u91cc](https://www.cnblogs.com/1000Suns/p/11073185.html)\n\n\u5999\u554a\uff0c\u771f\u7684\u592a\u5999\u4e86\u3002\n\n\u6709\u4ee5\u4e0b\u51e0\u4e2a\u7ed3\u8bba\uff1a\uff08\u4ee5\u4e0b\u79f0\u8fb9\u6743\u4e3a $a$ \u7684\u53eb\u8f7b\u8fb9\uff0c\u8fb9\u6743\u4e3a $b$ \u7684\u53eb\u91cd\u8fb9\uff09\n\n\u7ed3\u8bba 1\uff1a\u5982\u679c\u539f\u56fe\u4e24\u4e2a\u70b9\u4e2d\u5b58\u5728\u4e00\u6761\u8def\u5f84\u53ea\u6709\u8f7b\u8fb9\uff0c\u90a3\u4e48\u8fd9\u4e24\u70b9\u5728\u6240\u6709\u7684\u6700\u5c0f\u751f\u6210\u6811\u7684\u8def\u5f84\u4e0a\u90fd\u4e0d\u4f1a\u6709\u91cd\u8fb9\u3002\u6839\u636e\u6700\u5c0f\u751f\u6210\u6811\u7684\u6027\u8d28\uff0c\u663e\u7136\u6b63\u786e\u3002\n\n\u7ed3\u8bba 2\uff1a\u5982\u679c\u628a\u539f\u56fe\u4e2d\u6240\u6709\u91cd\u8fb9\u5220\u6389\uff0c\u4f1a\u5269\u4e0b\u4e00\u4e9b\u8054\u901a\u5757\u3002\u4e00\u6761\u8def\u5f84\u53ef\u80fd\u5728\u6700\u5c0f\u751f\u6210\u6811\u4e0a\uff0c\u5f53\u4e14\u4ec5\u5f53\u5b83\u6ca1\u6709\u79bb\u5f00\u4e00\u4e2a\u8054\u901a\u5757\u540e\u518d\u56de\u5230\u539f\u6765\u90a3\u4e2a\u8054\u901a\u5757\u4e2d\u3002\u6839\u636e\u7ed3\u8bba 1 \u8fd9\u4e5f\u662f\u5bf9\u7684\u3002\uff08\u6ce8\u610f\uff0c\u5982\u679c\u4e24\u4e2a\u70b9\u5c5e\u4e8e\u4e00\u4e2a\u8054\u901a\u5757\uff0c\u4f46\u662f\u8fd9\u4e24\u4e2a\u70b9\u6709\u91cd\u8fb9\u76f8\u8fde\uff0c\u90a3\u8fd9\u4e2a\u91cd\u8fb9\u4e5f\u662f\u4e0d\u80fd\u8d70\u7684\uff09\n\n\u90a3\u4e48\u53ef\u4ee5\u8bbe\u8ba1\u72b6\u6001 $f[S][u]$\uff0c$S$ \u662f\u5df2\u7ecf\u79bb\u5f00\u8fc7\u7684\u8054\u901a\u5757\u96c6\u5408\uff0c$u$ \u662f\u76ee\u524d\u6240\u5728\u7684\u70b9\u3002\n\n\u7531\u4e8e $f[S][u]$ \u53ef\u4ee5\u8f6c\u79fb\u5230 $f[S][v]$ \u65f6\uff0c$f[S][v]$ \u4e5f\u53ef\u4ee5\u8f6c\u79fb\u5230 $f[S][u]$\uff0c\u6240\u4ee5\u8981\u7528\u6700\u77ed\u8def\u7684\u65b9\u5f0f\u66f4\u65b0\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(2^nm\\log(2^nm))$\u3002\u5176\u5b9e\u7531\u4e8e\u8fb9\u6743\u53ea\u6709\u4e24\u79cd\uff0c\u53ef\u4ee5\u5f00\u4e24\u4e2a\u961f\u5217\uff0c\u4e00\u4e2a\u70b9\u6700\u591a\u88ab\u66f4\u65b0\u4e24\u6b21\uff0c\u590d\u6742\u5ea6\u662f $O(2^nm)$\u3002\n\n\u7136\u800c\u8fd8\u6709\u53e6\u4e00\u4e2a\u7ed3\u8bba\uff1a\n\n\u7ed3\u8bba 3\uff1a\u5982\u679c\u4e00\u4e2a\u8054\u901a\u5757\u5927\u5c0f $\\le 3$\uff0c\u90a3\u4e48\u5728 $S$ \u4e2d\u4e0d\u9700\u8981\u8003\u8651\u8fd9\u4e2a\u8054\u901a\u5757\u3002\u8bc1\u660e\uff0c\u7531\u4e8e\u79bb\u5f00\u518d\u56de\u5230\u4e00\u4e2a\u8054\u901a\u5757\u81f3\u5c11\u8981\u4e24\u6761\u91cd\u8fb9\uff08\u9664\u4e86\u4e0a\u9762\u63d0\u5230\u7684\u76f4\u63a5\u4e00\u6761\u91cd\u8fb9\u76f8\u8fde\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u5224\u6389\uff09\uff0c\u800c\u5f53\u8054\u901a\u5757\u5927\u5c0f $\\le 3$ \u65f6\u5185\u90e8\u53ef\u4ee5\u901a\u8fc7\u4e0d\u8d85\u8fc7\u4e24\u6761\u8f7b\u8fb9\u4e92\u8fbe\u3002\u6240\u4ee5\u5373\u4f7f\u4e0d\u8bb0\u5f55\uff0c\u6700\u4f18\u7b56\u7565\u4e5f\u4e0d\u4f1a\u79bb\u5f00\u518d\u56de\u5230\u8fd9\u4e2a\u8054\u901a\u5757\u3002\n\n\u90a3\u4e48\u53ea\u7528\u8bb0\u5f55\u5927\u5c0f $\\ge 4$ \u7684\u8054\u901a\u5757\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(2^{n/4}m)$\u3002\n\n\u7ec6\u8282\u6709\u70b9\u591a\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define FOR(i,a,b) for(int i=(a);i<=(b);i++)\n#define ROF(i,a,b) for(int i=(a);i>=(b);i--)\n#define MEM(x,v) memset(x,v,sizeof(x))\ninline int read(){\n\tchar ch=getchar();int x=0,f=0;\n\twhile(ch<'0' || ch>'9') f|=ch=='-',ch=getchar();\n\twhile(ch>='0' && ch<='9') x=x*10+ch-'0',ch=getchar();\n\treturn f?-x:x;\n}\nint n,m,a,b,w[77][77],id[18],cnt,tmp,f[20000000],q1[20000000],q2[20000000],h1,r1,h2,r2;\nbool vis1[77],vis2[77];\nint dfs1(int u){\n\tvis1[u]=true;\n\tint s=1;\n\tFOR(i,1,n) if(w[u][i]==a && !vis1[i]) s+=dfs1(i);\n\treturn s;\n}\nvoid dfs2(int u,int c){\n\tvis2[u]=true;\n\tid[u]=c;\n\tFOR(i,1,n) if(w[u][i]==a && !vis2[i]) dfs2(i,c);\n}\ninline int at(int x,int y){return x*n+y-1;}\nint main(){\n\tn=read();m=read();a=read();b=read();\n\tFOR(i,1,m){\n\t\tint u=read(),v=read();\n\t\tw[u][v]=w[v][u]=read();\n\t}\n\tFOR(i,1,n) if(!vis1[i]) if(dfs1(i)>=4) dfs2(i,++cnt);\n\ttmp=cnt;\n\tMEM(vis1,0);\n\tFOR(i,1,n) if(!vis1[i]) if(dfs1(i)<4) dfs2(i,++cnt);\n\tMEM(f,0x7f);\n\tf[at(0,1)]=0;\n\tq1[h1=r1=1]=at(0,1);q2[h2=r2=1]=at(0,1);\n\twhile(h1<=r1 || h2<=r2){\n\t\tint u;\n\t\tif(h1>r1) u=q2[h2++];\n\t\telse if(h2>r2) u=q1[h1++];\n\t\telse if(f[q1[h1]]<f[q2[h2]]) u=q1[h1++];\n\t\telse u=q2[h2++];\n\t\tint x=u/n,y=u%n+1;\n\t\tFOR(i,1,n){\n\t\t\tif(!w[y][i] || (id[i]<=tmp && (x&(1<<(id[i]-1)))) || (id[i]==id[y] && w[y][i]==b)) continue;\n\t\t\tint v;\n\t\t\tif(id[y]<=tmp && id[y]!=id[i]) v=at(x|(1<<(id[y]-1)),i);\n\t\t\telse v=at(x,i);\n\t\t\tif(f[v]>f[u]+w[y][i]){\n\t\t\t\tf[v]=f[u]+w[y][i];\n\t\t\t\tif(w[y][i]==a) q1[++r1]=v;\n\t\t\t\telse q2[++r2]=v;\n\t\t\t}\n\t\t}\n\t}\n\tFOR(i,1,n){\n\t\tint ans=2e9;\n\t\tFOR(j,0,(1<<tmp)-1) ans=min(ans,f[at(j,i)]);\n\t\tprintf(\"%d \",ans);\n\t}\n}\n```",
        "postTime": 1561787834,
        "uid": 72118,
        "name": "AThousandSuns",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1149D \u3010Abandoning Roads\u3011"
    },
    {
        "content": "~~\u770b\u5230 $n\\le 70$\uff0c\u60f3\u5230\u72b6\u538b DP\u3002~~\n\n\u9996\u5148\uff0c\u663e\u7136\u5bf9\u4e8e\u4e00\u68f5\u6700\u5c0f\u751f\u6210\u6811\uff0c\u6bcf\u4e2a\u8f7b\u8fb9\u8fde\u901a\u5757\u5185\u90e8\u90fd\u662f\u4e00\u68f5\u6811\uff0c\u8f7b\u8fb9\u8fde\u901a\u5757\u7f29\u70b9\u540e\u70b9\u4e4b\u95f4\u7684\u91cd\u8fb9\u4e5f\u662f\u4e00\u68f5\u6811\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u7f29\u70b9\u540e\u4e0d\u5b58\u5728\u91cd\u8fb9\u7ec4\u6210\u7684\u73af\uff08\u5305\u62ec\u81ea\u73af\uff09\uff0c\u8def\u5f84\u4e00\u65e6\u79bb\u5f00\u4e86\u4e00\u4e2a\u8f7b\u8fb9\u8fde\u901a\u5757\u5c31\u518d\u4e5f\u4e0d\u4f1a\u56de\u6765\u4e86\u3002\n\n\u4e8e\u662f\u5148\u6d2a\u6c34\u586b\u5145\u6c42\u51fa\u8fde\u901a\u5757\uff0c\u8bbe\u5171\u6709 $k$ \u4e2a\u8fde\u901a\u5757\u3002\u8bbe $dp_{S,u}$ \u8868\u793a\u5df2\u7ecf\u79bb\u5f00\uff08\u4e0d\u80fd\u518d\u56de\u5230\uff09\u7684\u8fde\u901a\u5757\u96c6\u5408\u4e3a $S$ \u65f6\uff0c$1\\sim u$ \u7684\u6700\u77ed\u8def\u5f84\u3002\u521d\u59cb\u65f6 $dp_{\\varnothing,1}=0$\uff0c\u5c06\u8f6c\u79fb\u5173\u7cfb\u7684\u56fe\u5efa\u51fa\u6765\u4e4b\u540e\uff0c\u6bcf\u4e2a $dp_{S,u}$ \u90fd\u89c6\u4e3a\u4e00\u4e2a\u8282\u70b9\uff0c\u539f\u56fe\u4e0a\u7684\u6bcf\u6761\u8fb9\u88ab\u62c6\u4e3a $2^k$ \u6761\u8fb9\uff0c\u4ece\u6e90\u70b9 $dp_{\\varnothing,1}$ \u51fa\u53d1\u7684\u5355\u6e90\u6700\u77ed\u8def\u5373\u4e3a $dp$ \u6570\u7ec4\u7684\u503c\u3002\n\n\u56e0\u6b64\uff0c\u590d\u6742\u5ea6\u662f\u5728 $2^kn$ \u4e2a\u70b9\u3001$2^km$ \u6761\u8fb9\u7684\u56fe\u4e0a\u8dd1 Dijkstra \u7b97\u6cd5\u7684\u590d\u6742\u5ea6\uff0c\u6700\u574f $k=n$ \u65f6\u4e3a $\\mathcal O(2^nm\\log(2^nn))=\\mathcal O(2^nmn)$\u3002\n\n\u6ce8\u610f\u5230\u5f53\u8fde\u901a\u5757\u5927\u5c0f\u4e0d\u8d85\u8fc7 $3$ \u65f6\uff0c\u5185\u90e8\u4e00\u5b9a\u53ef\u4ee5\u901a\u8fc7\u4e0d\u8d85\u8fc7 $2$ \u6761\u8f7b\u8fb9\u5230\u8fbe\uff0c\u800c\u51fa\u8fde\u901a\u5757\u518d\u56de\u6765\u81f3\u5c11\u8981\u8d70 $2$ \u6761\u91cd\u8fb9\uff0c\u8fd9\u79cd\u60c5\u51b5\u81ea\u7136\u4e0d\u4f18\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0d\u7528\u5904\u7406\u6240\u6709\u5927\u5c0f\u4e0d\u8d85\u8fc7 $3$ \u7684\u8fde\u901a\u5757\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u8981\u5904\u7406\u7684\u8fde\u901a\u5757\u6570 $k\\le\\lfloor\\frac{n}{4}\\rfloor$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u53d8\u4e3a $\\mathcal O(2^{\\frac{n}{4}}m\\log(2^{\\frac{n}{4}}n))=\\mathcal O(2^{\\frac{n}{4}}mn)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\u4ee3\u7801\u60f3\u6e05\u695a\u8fd8\u662f\u633a\u597d\u5199\u7684\u3002\n\n\u8fb9\u6743\u53ea\u6709\u4e24\u79cd\uff0c\u53ef\u4ee5\u5f00\u4e24\u4e2a\u961f\u5217\u8fdb\u884c BFS \u4f18\u5316\u6210 $\\mathcal O(2^{\\frac{n}{4}}m)$\uff0c\u4f46\u6211\u6ca1\u6709\u5199\u3002\u751a\u81f3\u8fd8\u6709 $\\mathcal O(2^{\\sqrt{n\\log n}}\\operatorname{poly}(n,m))$ \u7684[\u89e3\u6cd5](https://codeforces.com/blog/entry/66783?#comment-508667)\u3002\n\n```cpp\n//By: OIer rui_er\n#include <bits/stdc++.h>\n#define rep(x,y,z) for(int x=(y);x<=(z);x++)\n#define per(x,y,z) for(int x=(y);x>=(z);x--)\n#define debug(format...) fprintf(stderr, format)\n#define fileIO(s) do{freopen(s\".in\",\"r\",stdin);freopen(s\".out\",\"w\",stdout);}while(false)\nusing namespace std;\ntypedef long long ll;\n\nmt19937 rnd(std::chrono::duration_cast<std::chrono::nanoseconds>(std::chrono::system_clock::now().time_since_epoch()).count());\nint randint(int L, int R) {\n\tuniform_int_distribution<int> dist(L, R);\n\treturn dist(rnd);\n}\n\ntemplate<typename T> void chkmin(T& x, T y) {if(x > y) x = y;}\ntemplate<typename T> void chkmax(T& x, T y) {if(x < y) x = y;}\n\nconst int N = 75, M = 205, K = 18;\n\nint n, m, a, b, e[N][N], vis1[N], vis2[N], id[N], sz[N], cnt, dim, dp[N][1<<K], vis[N][1<<K];\n\nint dfs1(int u) {\n\tvis1[u] = 1;\n\tint sz = 1;\n\trep(v, 1, n) if(e[u][v] == a && !vis1[v]) sz += dfs1(v);\n\treturn sz;\n}\n\nvoid dfs2(int u, int cnt) {\n\tvis2[u] = 1;\n\tid[u] = cnt;\n\t++sz[cnt];\n\trep(v, 1, n) if(e[u][v] == a && !vis2[v]) dfs2(v, cnt);\n}\n\nint main() {\n\tscanf(\"%d%d%d%d\", &n, &m, &a, &b);\n\trep(i, 1, m) {\n\t\tint u, v, w;\n\t\tscanf(\"%d%d%d\", &u, &v, &w);\n\t\te[u][v] = e[v][u] = w;\n\t}\n\trep(i, 1, n) if(!vis1[i]) if(dfs1(i) >= 4) dfs2(i, cnt++);\n\tdim = cnt;\n\tmemset(vis1, 0, sizeof(vis1));\n\trep(i, 1, n) if(!vis1[i]) if(dfs1(i) < 4) dfs2(i, cnt++);\n\tmemset(dp, 0x3f, sizeof(dp));\n\tpriority_queue<tuple<int, int, int>> q;\n\tdp[1][0] = 0;\n\tq.emplace(0, 1, 0);\n\twhile(!q.empty()) {\n\t\tint _, u, S;\n\t\ttie(_, u, S) = q.top(); q.pop();\n\t\tif(vis[u][S]) continue;\n\t\tvis[u][S] = 1;\n\t\trep(v, 1, n) {\n\t\t\tif(!e[u][v]) continue;\n\t\t\tint Sn = S;\n\t\t\tif(e[u][v] == b) {\n\t\t\t\tif(id[u] == id[v] || id[v] < dim && ((S >> id[v]) & 1)) continue;\n\t\t\t\tif(id[u] < dim) Sn |= 1 << id[u];\n\t\t\t}\n\t\t\tif(dp[v][Sn] > dp[u][S] + e[u][v]) {\n\t\t\t\tdp[v][Sn] = dp[u][S] + e[u][v];\n\t\t\t\tq.emplace(-dp[v][Sn], v, Sn);\n\t\t\t}\n\t\t}\n\t}\n\trep(i, 1, n) {\n\t\tprintf(\"%d%c\", *min_element(dp[i], dp[i]+(1<<dim)), \" \\n\"[i==n]);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1679541838,
        "uid": 122461,
        "name": "rui_er",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1149D\u3010Abandoning Roads\u3011"
    },
    {
        "content": "\u6709\u4e00\u5f20\u56fe\u53ea\u5305\u542b\u8fb9\u6743\u4e3a$a,b(a<b)$\u7684\u8fb9\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u70b9$p$\u6c42\u4e00\u4e2a\u6700\u5c0f\u751f\u6210\u6811\u6ee1\u8db3$1$\u5230$p$\u8ddd\u79bb\u6700\u5c0f\u3002\n\n\u663e\u7136\u6700\u5c0f\u751f\u6210\u6811\u4f1a\u5148\u53d6\u5b8c$a$\uff0c\u90a3\u4e48\u5148\u9884\u5904\u7406\u51fa$a$\u8fb9\u7ec4\u6210\u7684\u8054\u901a\u5757\u3002$1$\u5230$p$\u7684\u6700\u77ed\u8def\u8fb9\u6743\u4e3a$b$\u7684\u8fb9\u4e00\u5b9a\u8fde\u63a5\u4e24\u4e2a\u4e0d\u540c\u7684\u8054\u901a\u5757\uff0c\u800c\u4e14\u90fd\u4f1a\u8d70\u5230\u4e00\u4e2a\u4e4b\u524d\u6ca1\u8d70\u8fc7\u7684\u8054\u901a\u5757\u3002\u90a3\u4e48\u53ef\u4ee5\u72b6\u538b\u6240\u6709\u8054\u901a\u5757\uff0c\u6700\u77ed\u8def\u7684\u540c\u65f6\u8bb0\u4e00\u4e0b\u8d70\u8fc7\u54ea\u4e9b\u8054\u901a\u5757\u4e86\uff0c\u8d70$b$\u8fb9\u65f6\u5224\u4e00\u4e0b\u65b0\u7684\u8054\u901a\u5757\u6709\u6ca1\u6709\u8d70\u8fc7\u3002\u70b9\u6570\u662f$O(2^nn)$\u7ea7\u522b\u7684\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u5982\u679c\u4e00\u4e2a\u8054\u901a\u5757\u70b9\u6570$\\leq 3$\uff0c\u90a3\u4e48\u5728\u8fd9\u4e2a\u8054\u901a\u5757\u5148\u8d70$b$\u8fb9\u51fa\u53bb\u518d\u8d70$b$\u8fb9\u56de\u6765\u662f\u6ca1\u6709\u610f\u4e49\u7684\uff0c\u56e0\u4e3a\u8fd9\u6837\u81f3\u5c11\u8d70$2b$\uff0c\u800c\u8fd9\u4e2a\u8054\u901a\u5757\u5185\u90e8\u6700\u957f\u4e5f\u5c31\u6700\u591a$2a$\u3002\u6240\u4ee5\u4e0d\u9700\u8981\u8bb0\u8fd9\u4e9b\u8054\u901a\u5757\uff0c\u70b9\u6570\u964d\u5230$O(2^{n/4}n)$\u5c31\u53ef\u4ee5\u76f4\u63a5\u505a\u4e86\u3002\n\nhttps://www.cnblogs.com/xzz_233/p/10798276.html",
        "postTime": 1556674787,
        "uid": 23118,
        "name": "\u03bb\u1d09\u028d",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1149D \u3010Abandoning Roads\u3011"
    },
    {
        "content": "## \u9898\u89e3\r\n\r\n~~\u611f\u89c9\u8fd9\u9053\u9898\u6709\u4e00\u70b9\u4e71\u641e~~\r\n\r\n\u8003\u8651 Kruskal \u6c42\u6700\u5c0f\u751f\u6210\u6811\u7684\u8fc7\u7a0b\uff0c\u628a\u8fb9\u6309\u4ece\u5c0f\u5230\u5927\u7684\u987a\u5e8f\u5c1d\u8bd5\u52a0\u5165\u3002\r\n\r\n\u8fd9\u9053\u9898\u53ea\u6709\u4e24\u79cd\u8fb9\u6743\uff0c\u6240\u4ee5\u4e00\u5b9a\u662f\u5148\u7528\u8fb9\u6743\u4e3a $a$ \u7684\u8fb9\u6784\u6210\u4e00\u4e2a\u68ee\u6797\uff0c\u518d\u7528\u8fb9\u6743\u4e3a $b$ \u7684\u8fb9\u8fde\u63a5\u8fd9\u4e9b\u68ee\u6797\u3002\r\n\r\n#### \u4e00\u4e2a\u6700\u77ed\u8def\u6ee1\u8db3\u4ec0\u4e48\u6761\u4ef6\u65f6\u4e0d\u5408\u6cd5\uff1f\r\n\r\n\u7a0d\u5fae\u52a8\u624b\u753b\u4e00\u753b\uff0c\u53d1\u73b0\u8fb9\u6743\u4e3a $a$ \u7684\u8fb9\u5e76\u4e0d\u4f1a\u5f71\u54cd\u5408\u6cd5\u6027\uff08\u53ef\u4ee5\u901a\u8fc7\u7834\u5708\u6cd5\u8bc1\u660e\u4e00\u6761\u7b80\u5355\u8def\u5f84\u4e0a\u7684 $a$ \u8fb9\u53ef\u4ee5\u540c\u65f6\u5b58\u5728\u4e8e\u6700\u5c0f\u751f\u6210\u6811\u4e4b\u4e2d\uff09\u3002\r\n\u4e0d\u5408\u6cd5\u7684\u60c5\u51b5\u53ea\u53ef\u80fd\u56e0\u4e3a\u6709\u4e9b\u8fb9\u6743\u4e3a $b$ \u7684\u8fb9\u4e0d\u80fd\u540c\u65f6\u5171\u5b58\u4e8e\u6700\u5c0f\u751f\u6210\u6811\u4e2d\u3002\r\n\r\n#### \u4ec0\u4e48\u65f6\u5019\u8fb9\u6743\u4e3a $b$ \u7684\u8fb9\u4e0d\u80fd\u540c\u65f6\u5171\u5b58\uff1f\r\n\r\n\u518d\u8054\u7cfb\u5230\u6211\u4eec Kruskal \u7684\u8fc7\u7a0b\uff0c\u5047\u5982\u5c06 $a$ \u8fb9\u8fde\u63a5\u7684\u8fde\u901a\u5757\u7f29\u70b9\uff0c\u8fd9\u4e9b $b$ \u8fb9\u5982\u679c\u5728\u7f29\u70b9\u540e\u7684\u56fe\u4e0a\u5f62\u6210\u4e86\u73af\u5c31\u4e0d\u5408\u6cd5\u3002\r\n\u5373\u6211\u4eec\u8d70 $b$ \u8fb9\u4e0d\u80fd\u5728\u4ee5\u524d\u7ecf\u8fc7\u7684\u7ed3\u70b9\u3002\r\n\r\n#### \u72b6\u538b\uff1f\r\n\r\n\u4f46\u662f\u8fd9\u662f $2^{70}$ \u554a\u3002\r\n\r\n\u6ce8\u610f\u5230\u5355\u4e2a\u7ed3\u70b9\u7528\u4e0d\u7740\u72b6\u538b\uff0c\u90a3\u4e48\u590d\u6742\u5ea6\u964d\u5230 $2^{35}$\u3002\r\n\u518d\u6b21\u7b80\u5316\uff0c$2$ \u4e2a\u7ed3\u70b9\u4e0e $3$ \u4e2a\u7ed3\u70b9\u4e5f\u4e0d\u9700\u8981\u72b6\u538b\uff0c\u5047\u5982\u5f62\u6210\u4e86\u73af\uff0c\u5219\u53ef\u4ee5\u7ecf\u8fc7 $2$ \u6761 $b$ \u8fb9\u4ece $u \\to p \\to v$\u3002\r\n\r\n\u7136\u800c\u6211\u4eec\u5185\u90e8\u7684 $a$ \u8fb9 $\\le 2$ \u6761\uff0c\u8d70\u8fd9\u4e2a\u5185\u90e8\u7684 $a$ \u8fb9\u80af\u5b9a\u6bd4\u7ed5\u5916\u90e8\u7684 $b$ \u8fb9\u77ed\uff0c\u6240\u4ee5\u6700\u77ed\u8def\u4e0d\u4f1a\u7ed5\u5916\u9762\u3002\r\n\u53ea\u6709 $\\ge 4$ \u7684\u8fde\u901a\u5757\u9700\u8981\u72b6\u538b\uff0c\u72b6\u538b\u90e8\u5206\u7684\u590d\u6742\u5ea6\u964d\u6210 $2^{17}$\uff0c\u591f\u4e86\u3002\r\n\r\n\u90a3\u4e48\u518d\u5957\u4e00\u4e2a Dijkstra \u7684\u590d\u6742\u5ea6\uff0c\u603b\u590d\u6742\u5ea6\u4e3a $O(2^{(n/4)}\\times m\\times \\log(m))$\u3002\r\n\r\n\r\n\u5b98\u65b9\u9898\u89e3\u597d\u50cf\u53ef\u4ee5\u66f4\u5feb\u6765\u7740\uff0c\u4e0d\u8fc7\u8fd9\u4e2a\u590d\u6742\u5ea6\u8db3\u591f\u901a\u8fc7\u672c\u9898\u4e86\u3002\r\n\r\n## \u4ee3\u7801\r\n```cpp\r\n#include <cstdio>\r\n#include <queue>\r\nusing namespace std;\r\nconst int MAXN = 70;\r\nconst int MAXM = 200;\r\nconst int INF = int(1E9);\r\nstruct edge{\r\n\tint to, dis;\r\n\tedge *nxt;\r\n}edges[2*MAXM + 5], *adj[MAXN + 5], *ecnt = edges;\r\nvoid addedge(int u, int v, int w) {\r\n\tedge *p = (++ecnt);\r\n\tp->to = v, p->dis = w, p->nxt = adj[u], adj[u] = p;\r\n\tp = (++ecnt);\r\n\tp->to = u, p->dis = w, p->nxt = adj[v], adj[v] = p;\r\n}\r\nstruct node{\r\n\tint d, s, x;\r\n\tnode(int _d=0, int _s=0, int _x=0) : d(_d), s(_s), x(_x) {}\r\n\tfriend bool operator < (node a, node b) {\r\n\t\treturn a.d > b.d;\r\n\t}\r\n};\r\nbool vis[MAXN][1<<17];\r\nint d[MAXN][1<<17];\r\npriority_queue<node>que;\r\nint dis[MAXN + 5], fa[MAXN + 5], siz[MAXN + 5];\r\nint find(int x) {\r\n\treturn fa[x] = (fa[x] == x ? x : find(fa[x]));\r\n}\r\nvoid unite(int x, int y) {\r\n\tint fx = find(x), fy = find(y);\r\n\tif( fx != fy ) fa[fx] = fy, siz[fy] += siz[fx];\r\n}\r\nint id[MAXN + 5], cnt, tot;\r\nint u[MAXM + 5], v[MAXM + 5], w[MAXM + 5];\r\nint n, m, a, b;\r\nint main() {\r\n\tscanf(\"%d%d%d%d\", &n, &m, &a, &b);\r\n\tfor(int i=0;i<n;i++) fa[i] = i, siz[i] = 1;\r\n\tfor(int i=1;i<=m;i++) {\r\n\t\tscanf(\"%d%d%d\", &u[i], &v[i], &w[i]), u[i]--, v[i]--;\r\n\t\tif( w[i] == a )\r\n\t\t\taddedge(u[i], v[i], w[i]), unite(u[i], v[i]);\r\n\t}\r\n\tfor(int i=0;i<n;i++)\r\n\t\tif( find(i) == i ) {\r\n\t\t\tif( siz[i] >= 4 ) id[i] = (cnt++);\r\n\t\t\telse id[i] = -1;\r\n\t\t}\r\n\tfor(int i=0;i<n;i++)\r\n\t\tid[i] = id[find(i)];\r\n\ttot = (1<<cnt);\r\n\tfor(int i=0;i<n;i++) {\r\n\t\tfor(int s=0;s<tot;s++)\r\n\t\t\td[i][s] = INF;\r\n\t\tdis[i] = INF;\r\n\t}\r\n\tfor(int i=1;i<=m;i++)\r\n\t\tif( w[i] == b && find(u[i]) != find(v[i]) )\r\n\t\t\taddedge(u[i], v[i], w[i]);\r\n\tque.push(node(0, 0, 0));\r\n\twhile( !que.empty() ) {\r\n\t\tnode x = que.top(); que.pop();\r\n\t\tif( vis[x.x][x.s] ) continue;\r\n\t\tdis[x.x] = min(dis[x.x], x.d);\r\n\t\tvis[x.x][x.s] = true;\r\n\t\tfor(edge *p=adj[x.x];p;p=p->nxt) {\r\n\t\t\tif( p->dis == a && x.d + p->dis < d[p->to][x.s] )\r\n\t\t\t\tque.push(node(d[p->to][x.s]=x.d+p->dis, x.s, p->to));\r\n\t\t\telse if( id[p->to] == -1 || !((x.s >> id[p->to]) & 1) ) {\r\n\t\t\t\tint s = (x.s | (id[x.x] == -1 ? 0 : (1<<id[x.x])));\r\n\t\t\t\tif( x.d + p->dis < d[p->to][s] )\r\n\t\t\t\t\tque.push(node(d[p->to][s]=x.d+p->dis, s, p->to));\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tfor(int i=0;i<n;i++)\r\n\t\tprintf(\"%d%c\", dis[i], (i == n - 1 ? '\\n' : ' '));\r\n}\r\n\r\n```\r\n",
        "postTime": 1674566324,
        "uid": 932291,
        "name": "Tiw_Air_qwq",
        "ccfLevel": 0,
        "title": "CF1149D \u9898\u89e3"
    },
    {
        "content": "## Preface\n\n\u8fd9\u79cd\u590d\u6742\u5ea6\u4e0d\u662f\u4eba\u80fd\u60f3\u51fa\u6765\u7684\u3002\n\n## Analysis\n\n\u9996\u5148\u53ea\u4fdd\u7559\u8fb9\u6743\u4e3a $a$ \u7684\u8fb9\uff0c\u6c42\u51fa\u6240\u6709\u8fde\u901a\u5757\u3002\u663e\u7136\u6839\u636e\u6700\u5c0f\u751f\u6210\u6811\u6027\u8d28\uff0c\u540c\u4e00\u8fde\u901a\u5757\u95f4\u4e0d\u53ef\u80fd\u9009\u8fb9\u6743\u4e3a $b$ \u7684\u8fb9\u4f5c\u4e3a\u6700\u5c0f\u751f\u6210\u6811\u4e0a\u7684\u8fb9\u3002\u6240\u4ee5\u4e00\u9897\u6700\u5c0f\u751f\u6210\u6811\u4e00\u5b9a\u662f\u6bcf\u4e2a\u8fb9\u6743\u4e3a $a$ \u7684\u8fde\u901a\u5757\u5185\u901a\u8fc7\u8fb9\u6743\u4e3a $a$ \u7684\u8fb9\u6784\u6210\u751f\u6210\u6811\uff0c\u518d\u901a\u8fc7\u8fb9\u6743\u4e3a $b$ \u6784\u6210\u6700\u5c0f\u751f\u6210\u6811\u3002\n\n\u663e\u7136\u6709\u5982\u4e0b\u6027\u8d28\uff1a\u5bf9\u4e8e\u65e0\u5411\u56fe\u4e0a\u7684\u8fd9\u4e00\u6761\u7b80\u5355\u8def\u5f84\uff0c\u5fc5\u7136\u6709\u4e00\u68f5**\u751f\u6210\u6811**\uff08\u975e\u6700\u5c0f\uff09\u662f\u5305\u542b\u8fd9\u6761\u8def\u5f84\u7684\u3002\u6784\u9020\u53ea\u8981\u7531\u8fd9\u6761\u8def\u5f84\u4e0a\u7684\u70b9\u5411\u5916 dfs \u5373\u53ef\u3002\n\n\u6211\u4eec\u628a\u6240\u6709\u8fb9\u6743\u4e3a $a$ \u7684\u8fb9\u6784\u6210\u7684\u8fde\u901a\u5757\u7f29\u6210\u4e00\u4e2a\u70b9\uff0c\u53ea\u8981\u7528\u8fb9\u6743\u4e3a $b$ \u7684\u8fb9\u8fde\u7ed3\u6240\u6709\u7f29\u5b8c\u7684\u70b9\uff08\u7f29\u6210\u7684\u70b9\u5185\u4e0d\u80fd\u8fde\uff09\uff0c\u4e14\u4e0d\u6784\u6210\u73af\uff0c\u5c31\u4e00\u5b9a\u5b58\u5728\u4e00\u4e2a\u5408\u6cd5\u7684\u6700\u5c0f\u751f\u6210\u6811\u3002\u4e5f\u5c31\u662f\u8bf4\u4e0d\u80fd\u56de\u5230\u5df2\u7ecf\u79bb\u5f00\u7684\u8fde\u901a\u5757\u3002\u6211\u4eec\u7528 $f_{S,u}$ \u8868\u793a\u5df2\u7ecf\u79bb\u5f00\u7684\u8fde\u901a\u5757\u96c6\u5408\u4e3a $S$\uff0c\u5230\u70b9 $u$ \u7684\u6700\u77ed\u8def\u5f84\u3002\u53ef\u4ee5\u7528\u7c7b\u4f3c dijkstra \u7684\u65b9\u5f0f\u8ba1\u7b97\u3002\u590d\u6742\u5ea6 $O(2^nm\\log(2^nm))$\u3002\n\n\u89c2\u5bdf\u6027\u8d28\u53d1\u73b0\uff0c\u5982\u679c\u4e00\u4e2a\u8fde\u901a\u5757\u7684\u5927\u5c0f $\\le 3$\uff0c\u90a3\u4e48\u5757\u5185\u70b9\u7684\u6700\u77ed\u8def\u53ea\u6709 $2a$\uff0c\u5982\u679c\u51fa\u5757\u518d\u56de\u5757\uff0c\u8def\u5f84\u957f\u5ea6\u5df2\u7ecf\u5230\u8fbe\u4e86 $2b$\uff0c\u7531\u4e8e $b>a$\uff0c\u6545\u5728\u8dd1\u6700\u77ed\u8def\u65f6\uff0c\u6839\u636e\u6700\u77ed\u8def\u6027\u8d28\u5c31\u4e0d\u4f1a\u51fa\u8be5\u5757\u518d\u56de\u5230\u8be5\u5757\uff0c\u6240\u4ee5\u8fd9\u4e00\u7c7b\u8fde\u901a\u5757\u53ef\u4ee5\u4e0d\u8ba1\u5165 $S$ \u7684\u72b6\u6001\u3002\u56e0\u6b64\uff0c\u9700\u8981\u8bb0\u5f55\u7684\u8fde\u901a\u5757\u4e2a\u6570\u6700\u591a\u53ea\u6709 $\\frac{n}{4}$ \u4e2a\u3002\u6700\u7ec8\u590d\u6742\u5ea6 $2^{\\frac{n}{4}}m\\log(2^\\frac{n}{4}m)$\u3002\n\n## Code\n\n[Codeforces Status](https://codeforces.com/contest/1149/submission/174462216)",
        "postTime": 1664887473,
        "uid": 169574,
        "name": "Enucai",
        "ccfLevel": 7,
        "title": "CF1149D Abandoning Roads"
    },
    {
        "content": "## \u9898\u610f\uff1a\n\u4e00\u5f20 $n$ \u4e2a\u70b9 $m$ \u6761\u8fb9\u7684\u65e0\u5411\u56fe\uff0c\u53ea\u6709 $a,b$ \u4e24\u79cd\u8fb9\u6743 $(a<b)$\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $i$\uff0c\u6c42\u56fe\u4e2d\u6240\u6709\u7684\u6700\u5c0f\u751f\u6210\u6811\u4e2d\uff0c\u4ece $1$ \u5230 $i$ \u8ddd\u79bb\u7684\u6700\u5c0f\u503c\u3002\n## \u9898\u89e3\uff1a\n\u9996\u5148\uff0c\u6839\u636e\u6700\u5c0f\u751f\u6210\u6811\u7684\u6c42\u6cd5\uff0c\u53ef\u4ee5\u77e5\u9053\uff0c\u4e00\u5f00\u59cb\u6211\u4eec\u4f1a\u5148\u53bb\u9009\u6240\u6709\u7684 $a$ \u8fb9\uff0c\u7136\u540e\u518d\u53bb\u518d\u53bb\u9009 $b$ \u8fb9\uff0c\u5728\u6ca1\u6709 $b$ \u8fb9\u7684\u65f6\u5019\uff0c\u6211\u4eec\u4f1a\u5f97\u5230\u4e00\u4e9b\u8fde\u901a\u5757\u3002\u539f\u56fe\u6700\u5c0f\u751f\u6210\u6811\u7684\u5f62\u6001\u4e00\u5b9a\u662f\u6bcf\u4e2a\u8fde\u901a\u5757\u5185\u9009\u4e00\u4e9b\u8fb9\u5f62\u6210\u4e00\u4e2a\u751f\u6210\u6811\uff0c\u7136\u540e\u518d\u5c06\u5404\u4e2a\u8054\u901a\u5757\u901a\u8fc7 $b$ \u8fb9\u5f62\u6210\u4e00\u68f5\u65b0\u7684\u751f\u6210\u6811\u3002\n\n\u6b64\u65f6\u6211\u4eec\u518d\u53bb\u6c42 $1$ \u5230\u6bcf\u4e2a\u70b9\u7684\u6700\u77ed\u8def\u3002\u7531\u4e8e\u8fde\u901a\u5757\u6784\u6210\u4e86\u4e00\u68f5\u5927\u751f\u6210\u6811\uff0c\u6240\u4ee5\uff0c\u4e0d\u4f1a\u6709\u79bb\u5f00\u4e86\u4e00\u4e2a\u8fde\u901a\u5757\u53c8\u56de\u5230\u8be5\u8fde\u901a\u5757\u7684\u60c5\u51b5\uff08\u56e0\u4e3a\u8fd9\u662f\u4e00\u68f5\u6811\uff0c\u6ca1\u6709\u73af\uff0c\u4e14\u6811\u4e0a\u6700\u77ed\u8def\u4e0d\u4f1a\u7ecf\u8fc7\u540c\u4e00\u6761\u8fb9\u4e24\u904d\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u81ea\u7136\u7684\u60f3\u5230\u4e00\u4e2a DP\uff0c\u4ee4 $dp[S][u]$ \u8868\u793a\u5f53\u524d\u5df2\u7ecf\u79bb\u5f00\u7684\u8fde\u901a\u5757\u7f16\u53f7\u7684\u96c6\u5408\u4e3a $S$\uff0c\u5230 $u$ \u7684\u6700\u77ed\u8def\u4e3a\u591a\u5c11\u3002\u8fd9\u4e2a\u53ef\u4ee5\u7528\u6700\u77ed\u8def\u7b97\u6cd5\u6c42\u89e3\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}(2^n(n+m)\\log 2^n(n+m))$ \u7684\u7b97\u6cd5\uff0c\u53d1\u73b0\u8fd9\u4e2a\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u8fd8\u4e0d\u8db3\u4ee5\u901a\u8fc7\u672c\u9898\uff0c\u8003\u8651\u601d\u8003\u4e00\u4e9b\u6027\u8d28\u3002\n\n\u5bf9\u4e8e\u4e00\u6761\u4ece\u67d0\u4e2a\u8fde\u901a\u5757\u51fa\u53bb\u53c8\u56de\u6765\u7684\u8def\u5f84\uff0c\u957f\u5ea6\u81f3\u5c11\u4e3a $2b$\uff0c\u800c\u4e00\u4e2a\u5927\u5c0f\u5c0f\u4e8e\u7b49\u4e8e $3$ \u7684\u8fde\u901a\u5757\u4e2d\uff0c\u6700\u8fdc\u7684\u4e24\u4e2a\u70b9\u7684\u8ddd\u79bb\u4e5f\u6709 $2a$\uff0c\u6240\u4ee5\u8fd9\u79cd\u60c5\u51b5\u4f1a\u76f4\u63a5\u88ab\u6700\u77ed\u8def\u6210\u7acb\u7684\u6761\u4ef6\u7ed9\u5426\u51b3\u6389\uff0c\u53ef\u4ee5\u4e0d\u7528\u8bb0\u5f55\u5728 $S$ \u7684\u72b6\u6001\u4e2d\uff0c\u4e8e\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u53ea\u7528\u8bb0\u5f55\u5927\u5c0f\u5927\u4e8e\u7b49\u4e8e $4$ \u7684\u8fde\u901a\u5757\uff0c\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u4e3a $O(2^{\\frac{n}{4}}(n+m)\\log2^{\\frac{n}{4}}(n+m))$\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n$\\mathcal{View\\ Code}$\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 75, M = 405, SIZE = (1 << 17) + 5;\nint n, m, a, b, col[N], cnt, t, used[N], cc, vis[SIZE][N], dp[SIZE][N];\nint tot, ver[M], nxt[M], edge[M], h[N];\nvoid add(int x, int y, int z) {ver[++tot] = y, edge[tot] = z, nxt[tot] = h[x], h[x] = tot;}\nstruct node {int S, u, val;};\nbool operator < (node a, node b) {return a.val > b.val;}\npriority_queue <node> pq;\nvoid dfs(int u) {\n\tused[u] = 1, cc++; \n\tfor(int i = h[u]; i; i = nxt[i])\n\t\tif(!used[ver[i]] && edge[i] == a) dfs(ver[i]);\n}\nvoid dfs2(int u, int c) {\n\tcol[u] = c;\n\tfor(int i = h[u]; i; i = nxt[i])\n\t\tif(col[ver[i]] == -1 && edge[i] == a) dfs2(ver[i], c);\n}\n\nint main() {\n\tmemset(col, -1, sizeof(col));\n\tscanf(\"%d%d%d%d\", &n, &m, &a, &b);\n\tfor(int i = 1, x, y, z; i <= m; i++) {\n\t\tscanf(\"%d%d%d\", &x, &y, &z), x--, y--;\n\t\tadd(x, y, z), add(y, x, z);\n\t}\n\tfor(int i = 0; i < n; i++)\n\t\tif(!used[i]) {\n\t\t\tcc = 0; dfs(i);\n\t\t\tif(cc >= 4) dfs2(i, cnt++);\n\t\t}\n\tt = cnt;\n\tmemset(used, 0, sizeof(used));\n\tfor(int i = 0; i < n; i++)\n\t\tif(!used[i]) {\n\t\t\tcc = 0; dfs(i);\n\t\t\tif(cc < 4) dfs2(i, cnt++);\n\t\t}\n\tmemset(dp, 0x3f, sizeof(dp));\n\tpq.push({0, 0, 0});\n\tdp[0][0] = 0;\n\twhile(pq.size()) {\n\t\tint u = pq.top().u, S = pq.top().S; pq.pop();\n\t\tif(vis[S][u]) continue; vis[S][u] = 1;\n\t\tfor(int i = h[u]; i; i = nxt[i]) {\n\t\t\tint v = ver[i], w = edge[i];\n\t\t\tif(col[u] == col[v] && w == b) continue;\n\t\t\tif(col[v] < t && (S & (1 << col[v]))) continue;\n\t\t\tint cur = S;\n\t\t\tif(col[u] < t && col[v] != col[u]) cur |= (1 << col[u]);\n\t\t\tif(dp[cur][v] > dp[S][u] + w) {\n\t\t\t\tdp[cur][v] = dp[S][u] + w;\n\t\t\t\tif(!vis[cur][v]) pq.push({cur, v, dp[cur][v]});\n\t\t\t}\n\t\t} \n\t}\n\tfor(int i = 0; i < n; i++) {\n\t\tint res = 0x7fffffff;\n\t\tfor(int j = 0; j < (1 << t); j++)\n\t\t\tres = min(res, dp[j][i]);\n\t\tprintf(\"%d \", res);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1632132849,
        "uid": 108610,
        "name": "Dzhao",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1149D Abandoning Roads"
    },
    {
        "content": "[CF1149D Abandoning Roads](https://www.luogu.com.cn/problem/CF1149D)\u89e3\u9898\u62a5\u544a\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://zybuluo.com/xiaoziyao/note/1795667)\n\n## \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a $n$ \u4e2a\u70b9 $m$ \u6761\u8fb9\u7684\u65e0\u5411\u8fde\u901a\u56fe\uff0c\u8fb9\u6743\u53ea\u6709 $a$ \u548c $b$ \u4e24\u79cd\uff0c\u6c42\u5bf9\u4e8e\u6bcf\u4e2a $i$ \uff0c\u6240\u6709\u6700\u5c0f\u751f\u6210\u6811\u4e2d $1$ \u5230 $i$ \u7684\u8ddd\u79bb\u6700\u5c0f\u503c\u3002\n\n$2\\leqslant n\\leqslant 70,n-1\\leqslant m\\leqslant 200,1\\leqslant a<b\\leqslant 10^7$\n\n## \u5206\u6790\n\n\u795e\u5fc5\u9898\u3002\n\n\u8bbe\u8fb9\u6743\u4e3a $a$ \u7684\u8fb9\u4e3a\u8f7b\u8fb9\uff0c\u8fb9\u6743\u4e3a $b$ \u7684\u8fb9\u4e3a\u91cd\u8fb9\u3002\n\n\u663e\u7136\u6700\u5c0f\u751f\u6210\u6811\u4f1a\u5148\u53d6\u8f7b\u8fb9\uff0c\u90a3\u4e48\u4f1a\u5f62\u6210\u82e5\u5e72\u4e2a\u8f7b\u8fde\u901a\u5757\uff0c\u7136\u540e\u8003\u8651\u91cd\u8fb9\u7684\u8fde\u63a5\uff1a\n\n\u6211\u4eec\u4e0d\u77e5\u9053\u6309\u4ec0\u4e48\u987a\u5e8f\u66f4\u65b0\uff0c\u4e5f\u4e0d\u77e5\u9053\u66f4\u65b0\u591a\u5c11\u6b21\uff0c\u6b64\u65f6\u6211\u4eec\u8981\u731c\u4e00\u4e2a\u7ed3\u8bba\uff1a\u4e00\u6761\u8def\u5f84\uff08\u53ef\u4ee5\u5305\u62ec\u91cd\u8fb9\uff09\u5728\u751f\u6210\u6811\u4e0a\u5f53\u4e14\u4ec5\u5f53\u6ca1\u6709\u79bb\u5f00\u4e00\u4e2a\u8f7b\u8fde\u901a\u5757\u518d\u8fdb\u5165\u90a3\u4e2a\u8f7b\u8fde\u901a\u5757\u3002\uff08\u5305\u62ec\u4e00\u6761\u8fb9\u7684\u60c5\u51b5\uff0c\u8fd9\u91cc\u9700\u8981\u7279\u5224\uff09\n\n\u90a3\u4e48\u8bbe $f_{S,x}$ \u4e3a\u7ecf\u8fc7\u8fde\u901a\u5757\u7684\u72b6\u6001\u4e3a $S$ \uff0c\u5f53\u524d\u4f4d\u7f6e\u4e3a $x$ \u7684\u6700\u77ed\u8ddd\u79bb\uff0c\u5c31\u53ef\u4ee5\u7528\u4e00\u4e2a\u6700\u77ed\u8def\u66f4\u65b0 $f_{S,x}$ \u3002\u7531\u4e8e\u8fb9\u6743\u53ea\u6709 $a/b$ \u4e24\u79cd\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u7528\u4e24\u4e2a\u961f\u5217\u7ef4\u62a4\u6700\u77ed\u8def\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(2^nm)$ \u3002\uff08\u4e24\u4e2a\u961f\u5217\u7ef4\u62a4\u6700\u77ed\u8def\u5176\u5b9e\u7c7b\u4f3cBFS\u6c42\u6700\u77ed\u8def\uff09\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4ecd\u7136\u5f88\u9ad8\uff0c\u4e0d\u96be\u53d1\u73b0\u74f6\u9888\u5728 $2^n$ \u4e0a\uff0c\u8003\u8651\u51cf\u5c0f\u9700\u8981\u8bb0\u5f55\u7684\u8fde\u901a\u5757\u7684\u4fe1\u606f\u3002\n\n\u8003\u8651\u731c\u4e00\u4e2a\u7ed3\u8bba\uff0c\u5bf9\u4e8e\u5927\u5c0f $<4$ \u7684\u8fde\u901a\u5757\uff0c\u4e0d\u9700\u8981\u8003\u8651\u91cd\u8fb9\u6709\u6ca1\u6709\u591a\u6b21\u5230\u8fbe\u8fd9\u4e2a\u8fde\u901a\u5757\u3002\n\n\u8bc1\u660e\u5f88\u7b80\u5355\uff0c\u7531\u4e8e\u7279\u5224\u4e86\u4e0a\u9762\u4e00\u6761\u8fb9\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u4e24\u6b21\u5230\u8fbe\u8fd9\u4e2a\u8fde\u901a\u5757\u8d77\u7801\u9700\u8981 $2$ \u6761\u91cd\u8fb9\uff0c\u800c\u8fd9\u4e2a\u8fde\u901a\u5757\u5185\u90e8\u6700\u8fdc\u7684\u4e24\u4e2a\u70b9\u6700\u8fdc\u4e5f\u53ea\u9700\u8981\u7ecf\u8fc7 $2$ \u6761\u8f7b\u8fb9\u3002\n\n\u8fd9\u6837\u6211\u4eec $S$ \u53ea\u9700\u8981\u4fdd\u5b58 $\\frac{n}{4}$ \u4e2a\u96c6\u5408\u7684\u4fe1\u606f\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(2^{\\frac{n}{4}}m)$ \uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n## \u4ee3\u7801\n\n\u6ce8\u610f\u7ec6\u8282\u3002\n```\n#include<stdio.h>\n#include<queue>\n#define inf 1000000000\nusing namespace std;\nconst int maxn=75,maxm=405,maxS=(1<<18)+1;\nint n,m,a,b,e,big,tmp,tot;\nint start[maxn],to[maxm],then[maxm],worth[maxm],f[maxS][maxn],col[maxn],flag[maxn];\nqueue< pair<int,int> >q1,q2;\ninline void add(int x,int y,int z){\n\tthen[++e]=start[x],start[x]=e,to[e]=y,worth[e]=z;\n}\nvoid dfs(int x,int c){\n\ttmp++,col[x]=c;\n\tfor(int i=start[x];i;i=then[i])\n\t\tif(col[to[i]]==0&&worth[i]==a)\n\t\t\tdfs(to[i],c);\n}\nint main(){\n\tscanf(\"%d%d%d%d\",&n,&m,&a,&b);\n\tfor(int i=1;i<=m;i++){\n\t\tint x,y,z;\n\t\tscanf(\"%d%d%d\",&x,&y,&z);\n\t\tadd(x,y,z),add(y,x,z);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tif(col[i]==0)\n\t\t\ttmp=0,tot++,dfs(i,tot),flag[tot]=(tmp<4)? 0:(++big);\n\tfor(int i=0;i<(1<<big);i++)\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tf[i][j]=inf;\n\tf[0][1]=0,q1.push(make_pair(0,1)),q2.push(make_pair(0,1));\n\twhile(!q1.empty()||!q2.empty()){\n\t\tpair<int,int>now;\n\t\tif(q2.empty()||(!q1.empty()&&f[q1.front().first][q1.front().second]<f[q2.front().first][q2.front().second]))\n\t\t\tnow=q1.front(),q1.pop();\n\t\telse now=q2.front(),q2.pop();\n\t\tint x=now.second,S=now.first;\n\t\tfor(int i=start[x];i;i=then[i]){\n\t\t\tint y=to[i],z=worth[i];\n\t\t\tif((col[x]==col[y]&&z==b)||(flag[col[y]]&&(S>>(flag[col[y]]-1))&1))\n\t\t\t\tcontinue;\n\t\t\tint nxt=(col[x]==col[y]||flag[col[x]]==0)? S:(S|(1<<(flag[col[x]]-1)));\n\t\t\tif(f[nxt][y]>f[S][x]+z){\n\t\t\t\tf[nxt][y]=f[S][x]+z;\n\t\t\t\tif(z==a)\n\t\t\t\t\tq1.push(make_pair(nxt,y));\n\t\t\t\tif(z==b)\n\t\t\t\t\tq2.push(make_pair(nxt,y));\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tint res=inf;\n\t\tfor(int j=0;j<(1<<big);j++)\n\t\t\tres=min(res,f[j][i]);\n\t\tprintf(\"%d%c\",res,i==n? '\\n':' ');\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1620790746,
        "uid": 35754,
        "name": "Verdandi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1149D\u3010Abandoning Roads\u3011"
    }
]
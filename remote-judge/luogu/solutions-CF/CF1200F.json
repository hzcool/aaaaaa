[
    {
        "content": "### \u8fd9\u5e94\u8be5\u7b97\u662fCFdiv2\u6700\u540e\u4e00\u9898\u4e2d\u8f83\u4e3a\u7b80\u5355\u7684\u9898\u4e86\u3002\uff08\u4ee5\u524d\u7684\u6700\u540e\u4e00\u9898\u6211\u6839\u672c\u60f3\u4e0d\u51fa\u6765\uff09\n\n~~\u771f\u662f\u53ef\u60dc\uff0c\u7adf\u7136\u6ca1\u6709\u53bb\u6253\u2026\u2026~~\n\n\u4e4d\u4e00\u773c\u770b\u8fc7\u53bb\u597d\u50cf\u5e76\u4e0d\u53ef\u505a\uff0c\u5982\u679c\u53ea\u6709\u4e00\u4e2a\u8be2\u95ee\u76f4\u63a5\u5904\u7406\u5c31\u597d\u4e86\u3002\n\n\u6211\u4eec\u80af\u5b9a\u4e0d\u80fd\u5728\u7ebf\u5904\u7406\u6bcf\u4e00\u4e2a\u8be2\u95ee\uff0c\u56e0\u4e3a\u8981\u627e\u51fa\u6709\u591a\u5c11\u4e2a\u70b9\u4f1a\u88ab\u7ecf\u8fc7\u65e0\u6570\u6b21\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u8d77\u7801\u8981$O(n)$\uff0c\u627f\u53d7\u4e0d\u4f4f\u3002\n\n\u90a3\u4e48\uff0c\u6211\u4eec\u6362\u4e00\u4e2a\u601d\u8def\uff1a\u80fd\u5426\u9884\u5904\u7406\u51fa\u6240\u6709\u7b54\u6848\uff0c$O(1)$\u56de\u7b54\u5462\uff1f\n\n\u770b\u770b\u6570\u636e\u8303\u56f4\u597d\u50cf\u4e5f\u4e0d\u884c\uff0c$|y|\u226410^9$\uff0c\u4f46\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$y$\uff0c\u80fd\u5426\u627e\u5230\u4e00\u4e2a\u7b49\u6548\u7684$y'$\uff0c\u4f7f\u5f97\u7b54\u6848\u4e0d\u53d8\u5462\uff1f\n\n\u6ce8\u610f\u5230$1\u2264m_i\u226410$\uff0c\u4ece\u8fd9\u91cc\u5165\u624b\uff0c\u89c2\u5bdf\u9898\u76ee\u4e2d\u6240\u7ed9\u7684\u540c\u4f59\u5f0f\uff0c\u53d1\u73b0\u53ea\u8981\u4f7f$y\\equiv y'(\\mod lcm(1..10))$\uff0c\u5373\u53ef\u4f7f\u6bcf\u4e00\u4e2a\u540c\u4f59\u5f0f\u7684\u7b54\u6848\u4e0d\u53d8\u3002\n\n\u6211\u4eec\u628a\u6bcf\u4e00\u4e2a\u8be2\u95ee\u8bbe\u6210\u72b6\u6001$(x,y)$\uff0c\u90a3\u4e48\u72b6\u6001\u53ea\u5269\u4e0b\u4e86$2520n$\u4e2a\uff01\uff08$lcm(1..10)=2520$\uff09\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u8003\u8651\u80fd\u5426\u9884\u5904\u7406\u51fa\u6bcf\u4e00\u4e2a\u72b6\u6001$(x,y)$\u7684\u7b54\u6848\uff0c\u8be2\u95ee\u4f7f\u76f4\u63a5\u8c03\u7528\u3002\n\n\u5148\u9884\u5904\u7406\u51fa\u6bcf\u4e00\u4e2a\u72b6\u6001\u7684\u540e\u7ee7\u72b6\u6001\uff0c\u5c31\u662f\u63a5\u4e0b\u6765\u4f1a\u5230\u8fbe\u54ea\u4e2a\u70b9\u548c\u5230\u4e86\u90a3\u4e2a\u70b9\u4e4b\u540e\u5269\u4f59\u7684\u70b9\u6743\u3002\n\n\u4ece\u72b6\u6001$(1,0)$\u5f00\u59cb\u641c\u7d22\uff0c\u5206\u4e24\u79cd\u60c5\u51b5\uff1a\n\n1\u3001\u5f53\u524d\u72b6\u6001\u6ca1\u6709\u88ab\u641c\u5230\u8fc7\uff1a\u8fd9\u79cd\u60c5\u51b5\u76f4\u63a5\u7ee7\u7eed\u641c\u7d22\uff0c\u5e76\u7ee7\u627f\u5b83\u7684\u540e\u7ee7\u72b6\u6001\u7684\u7b54\u6848\u5373\u53ef\u3002\n\n2\u3001\u5f53\u524d\u72b6\u6001\u88ab\u641c\u5230\u8fc7\u4e86\uff1a\u8bf4\u660e\u6b64\u65f6\u6784\u6210\u4e86\u4e00\u4e2a\u73af\uff0c\u90a3\u4e48\u6240\u6709\u73af\u4e0a\u7684\u70b9\u5c31\u90fd\u662f\u53ef\u4ee5\u88ab\u7ecf\u8fc7\u65e0\u9650\u6b21\u7684\uff0c\u7c7b\u4f3c\u4e8e\u627e\u73af\u7684\u65b9\u6cd5\uff0c\u628a\u73af\u4e0a\u7684\u70b9\u5f04\u51fa\u6765\u53bb\u91cd\uff0c\u52a0\u5165\u7b54\u6848\u5373\u53ef\u3002\n\n\u7531\u4e8e\u6bcf\u4e2a\u72b6\u6001\u53ea\u4f1a\u88ab\u641c\u5230\u4e00\u6b21\uff0c\u800c\u7edf\u8ba1\u7b54\u6848\u65f6\u53ea\u4f1a\u7edf\u8ba1\u6ca1\u6709\u88ab\u7edf\u8ba1\u8fc7\u7684\u72b6\u6001\uff0c\u6240\u4ee5\u6700\u7ec8\u65f6\u95f4\u590d\u6742\u5ea6\u662f$O(2520n+q)$\u3002\n\n### \u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<cctype>\n#include<utility>\n#include<algorithm>\n#include<cmath>\nusing namespace std;\n#define res register int\n#define ll long long\n//#define cccgift\n#define getchar()(p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\nchar buf[1<<21],*p1=buf,*p2=buf;\nnamespace wode{\n    template<typename T>\n    inline void read(T &x)\n    {\n        static char ch;bool f=1;\n        for(x=0,ch=getchar();!isdigit(ch);ch=getchar()) if(ch=='-') f=0;\n        for(;isdigit(ch);x=(x<<1)+(x<<3)+(ch^48),ch=getchar());x=f?x:-x;\n    }\n    template<typename T>\n    void print(T x)\n    {\n        if (x<0) putchar('-'),x=-x;\n        if (x>=10) print(x/10);\n        putchar(x%10+'0');\n    }\n    template<typename T>\n    inline void print(T x,char ap) {print(x);if (ap) putchar(ap);}\n    template<typename T>\n    inline T max(T x,T y) {return x<y?y:x;}\n    template<typename T>\n    inline T min(T x,T y) {return x<y?x:y;}\n    template<typename T>\n    inline void chkmax(T &x,T y) {x=x<y?y:x;}\n    template<typename T>\n    inline void chkmin(T &x,T y) {x=x<y?x:y;}\n}\nusing wode::read;using wode::chkmin;using wode::chkmax;using wode::print;\n#define lcm 2520\nint n,m,a[1001],b[10],nxt[2520001],f[2520001],sum,col[2520001],stack[1001],top,x,y;\nbool vis[1001];\nvoid dfs(int x,int bel) {\n\tcol[x]=bel;\n\tif(!col[nxt[x]]) dfs(nxt[x],bel),f[x]=f[nxt[x]];\n\telse if(col[nxt[x]]==bel) { //\u5f53\u524d\u72b6\u6001\u5df2\u7ecf\u88ab\u641c\u5230\u8fc7\u4e86\n\t\tint now=nxt[x],tot=1;vis[x/lcm]=true,stack[top=1]=x/lcm;\n\t\tfor(;now!=x;now=nxt[now]) if(!vis[now/lcm]) vis[now/lcm]=true,stack[++top]=now/lcm,++tot;\n\t\tf[x]=tot;\n\t\tfor(res i=1;i<=top;++i) vis[stack[i]]=false; //\u9632\u6b62\u590d\u6742\u5ea6\u9000\u5316\n\t}\n\telse f[x]=f[nxt[x]]; //\u8fdb\u5165\u4e86\u4e4b\u524d\u5c31\u6709\u7684\u5faa\u73af\uff0c\u76f4\u63a5\u7ee7\u627f\uff0c\u4fdd\u8bc1\u590d\u6742\u5ea6\u3002\n}\nint main()\n{\n\tread(n);\n\tfor(res i=1;i<=n;++i) read(a[i]),a[i]=(a[i]%lcm+lcm)%lcm;\n\tfor(res i=1;i<=n;++i) {\n\t\tread(m);\n\t\tfor(res j=0;j<m;++j) read(b[j]);\n\t\tfor(res j=0;j<lcm;++j) {\n\t\t\tint s=(a[i]+j)%lcm;int now=s%m;\n\t\t\tnxt[(i-1)*lcm+j]=s+(b[now]-1)*lcm; //nxt\u8868\u793a\u6bcf\u4e00\u4e2a\u72b6\u6001\u7684\u540e\u7ee7\u72b6\u6001\n\t\t}\n\t}\n\tfor(res i=0;i<n*lcm;++i) if(!col[i]) dfs(i,++sum); //\u6ca1\u6709\u88ab\u641c\u5230\u8fc7\u518d\u641c\n\tread(m);\n\twhile(m--) read(x),read(y),y=(y%lcm+lcm)%lcm,print(f[(x-1)*lcm+y],'\\n'); //\u6ce8\u610f\uff01\u53d6\u6a21\u6709\u53ef\u80fd\u51fa\u73b0\u8d1f\u6570\u3002\n    return 0;\n}\n```",
        "postTime": 1565616136,
        "uid": 43697,
        "name": "chenyewei_1234",
        "ccfLevel": 7,
        "title": "CF1200F Graph Traveler"
    },
    {
        "content": "\u7b2c\u4e00\u6b21\u6bd4\u8d5b\u7684\u65f6\u5019AK div 2 \u6bd5\u7adf\u6700\u540e\u4e00\u9898\u8fd8\u7b97\u662f\u6bd4\u8f83\u7b80\u5355\u7684\n\n\u9996\u5148\u4f60\u89c2\u5bdf\u5230$m_i$\u8303\u56f4\u5c31\u53ea\u67091\u523010\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u5c06\u6bcf\u4e00\u4e2a\u70b9\u62c6\u62102520(1--10\u7684lcm)\u4e2a\u70b9\uff0c\u7136\u540e\u5728\u62c6\u5b8c\u70b9\u4e4b\u540e\u7684\u56fe\u4e2d\u8dd1\u4e00\u904ddfs\u5373\u53ef\u3002\n\n\u6700\u8fd1cf\u597d\u559c\u6b22\u8003\u62c6\u70b9\u554a\uff0c\u6700\u8fd1\u4e00\u573adiv1+div2\u4e2d\u7684F\u9898\u4e5f\u8003\u5230\u4e86\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int mod = 2520;\nint n;\nint insta[1010][2530], ans[1010][2530];\nint w[1010];\nint dep[1010][2530];\nint son[1010][12], len[1010];\nint sta[2530000];\nint cnt[1010];\ninline int dfs(int x, int y) {\n    insta[x][y] = 1;\n    if(ans[x][y]) return ans[x][y];\n    sta[dep[x][y]] = x;\n    int newx = son[x][y % len[x]], newy = (y + w[newx]) % mod;\n    if(insta[newx][newy]) {\n        if(ans[newx][newy]) return ans[x][y] = ans[newx][newy];\n        int l = dep[newx][newy], r = dep[x][y];\n        for(int i = l; i <= r; i++) cnt[sta[i]] = 0;\n        for(int i = l; i <= r; i++) if(cnt[sta[i]] == 0) cnt[sta[i]] = 1, ans[x][y]++;\n        return ans[x][y];\n    }\n    dep[newx][newy] = dep[x][y] + 1;\n    ans[x][y] = dfs(newx, newy);\n    return ans[x][y];\n}\nint main() {\n    ios :: sync_with_stdio(false);\n    cin >> n;\n    for(int i = 1; i <= n; i++) cin >> w[i], w[i] = (w[i] % mod + mod) % mod;\n    for(int i = 1; i <= n; i++) {\n        cin >> len[i];\n        for(int j = 0; j < len[i]; j++) cin >> son[i][j];\n    }\n    int q;\n    cin >> q;\n    while(q--) {\n        int x, c;\n        cin >> x >> c;\n        c = (c % mod + mod) % mod;\n        cout << dfs(x, (c + w[x]) % mod) << endl;\n    }\n    return 0;\n}\n```\n",
        "postTime": 1568723683,
        "uid": 26937,
        "name": "_soul_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1200F \u3010Graph Traveler\u3011"
    }
]
[
    {
        "content": "\u53cd\u6b63\u53ef\u4ee5\u76f4\u63a5\u5f53 $k=3$ \u53bb\u505a\uff0c\u7136\u540e\u8003\u8651\u76f4\u63a5\u53bb\u6784\u9020\u3002\n\n\u9996\u5148\u4efb\u610f\u7ed9\u6811\u627e\u4e00\u4e2a\u6839\uff0c\u7136\u540e\u5c06\u6574\u68f5\u6811\u62c6\u6210\u51e0\u4e2a\u5927\u5c0f\u4e3a $\\sqrt n$ \u7684\u5b50\u6811\uff0c\u5c06\u6240\u6709\u8fd9\u4e9b\u5b50\u6811\u7684\u6839 $u$ \u585e\u5230\u4e00\u4e2a\u70b9\u96c6 $a$ \uff0c\u7136\u540e\u5c06 $a$ \u4e2d\u7684\u70b9\u76f8\u4e92\u8fde\u63a5\uff0c\u8fb9\u7684\u6570\u91cf\u4e3a $\\mathcal O(n)$\u3002\n\n\u63a5\u7740\uff0c\u5bf9\u4e8e\u70b9\u96c6 $a$ \u4e2d\u7684\u6bcf\u4e2a\u70b9 $u$\uff0c\u5c06 $u$ \u4e0e\u5176\u5b50\u6811\u4e2d\u7684\u6bcf\u4e2a\u70b9\u8fde\u63a5\uff0c\u663e\u7136\u8fb9\u6570\u4ecd\u7136\u4e3a $\\mathcal O(n)$\u3002\n\n\u6700\u540e\uff0c\u518d\u5bf9\u6240\u6709\u5b50\u6811\u9012\u5f52\u8fd9\u4e2a\u8fc7\u7a0b\u5373\u53ef\u3002\u7531\u4e8e\u6700\u591a\u6709 $\\mathcal O(\\log \\log n)$ \u6b21\u9012\u5f52\uff0c\u6bcf\u6b21\u8fb9\u6570\u90fd\u662f $\\mathcal O(n)$\uff0c\u56e0\u6b64\u603b\u8fb9\u6570\u662f $\\mathcal O(n\\log \\log n)$ \u7684\u3002\n\n\u7136\u540e\u6765\u8bc1\u660e\u4e00\u4e0b\u4e3a\u4ec0\u4e48\u8fd9\u6837\u6700\u957f\u8def\u5f84\u4e3a $3$\uff0c\u8003\u8651\u4e24\u4e2a\u9876\u70b9 $u,v$ \u4ee5\u53ca\u5b83\u4eec\u5728\u540c\u4e00\u5b50\u6811\u65f6\u7684\u6700\u540e\u4e00\u6b21\u9012\u5f52\u3002\u4ee4 $c(x)$ \u4e3a\u4e0e\u5b50\u6811 $x$ \u76f8\u90bb\u4e14\u5c5e\u4e8e $a$ \u4e2d\u7684\u70b9\uff0c\u663e\u7136\u5728\u4e0a\u8ff0\u6784\u9020\u4e0b\uff0c\u82e5 $c(u)\\ne c(v)$\uff0c\u5219 $c(u)$ \u4e0e $c(v)$ \u4e00\u5b9a\u6709\u8fb9\u76f4\u63a5\u76f8\u8fde\u3002\u82e5 $c(u)=c(v)$ \u5219\u8def\u5f84\u66f4\u77ed\u3002\u56e0\u6b64\u6700\u957f\u8def\u5f84\u4e3a $3$\u3002\n\n```cpp\nint n,k;\nint vis[11111],viss[11111],siz[11111];\nvector<int>e[11111],st,at;\nvector<pair<int,int> >ans;\nvoid dfs3(int u,int n)\n{\n\tvis[u]=1;\n\tfor(int v:e[u]) if(!vis[v]&&!viss[v])\n\t{\n\t\tdfs3(v,n);\n\t\tsiz[u]+=siz[v];\n\t}\n\tif(siz[u]>=n)\n\t{\n\t\tviss[u]=1;\n\t\tsiz[u]=0;\n\t\tat.emplace_back(u);\n\t}\n}\nvoid dfs2(int u)\n{\n\tst.emplace_back(u);\n\tvis[u]=1;\n\tfor(int v:e[u]) if(!vis[v]&&!viss[v]) dfs2(v);\n}\nvoid dfs1(int u)\n{\n\tst.clear();\n\tdfs2(u);\n\tint sz=st.size();\n\tint sz2=floor(sqrt(sz));\n\tfor(int x:st) vis[x]=0,siz[x]=1;\n\tif(sz<=4) \n\t{\n\t\tfor(int x:st) viss[x]=1;\n\t\treturn;\n\t}\n\tat.clear();\n\tdfs3(u,sz2);\n\tfor(int x:st) vis[x]=0;\n\tfor(int x:at) for(int y:at) if(x<y)\n\t{\n\t\tans.emplace_back(x,y);\n\t} \n\tvector<int>st2=st;\n\tfor(int x:at)\n\t{\n\t\tst.clear();\n\t\tdfs2(x);\n\t\tfor(int y:st)\n\t\t{\n\t\t\tif(x!=y) ans.emplace_back(x,y);\n\t\t\tvis[y]=0;\n\t\t}\n\t}\n\tfor(int x:st2) if(!viss[x]) dfs1(x);\n}\nsigned main()\n{\n\tios::sync_with_stdio(false);\n\tcin.tie(NULL);\n\tcin>>n>>k;\n\tR(i,1,n-1)\n\t{\n\t\tint x,y;\n\t\tcin>>x>>y;\n\t\te[x].emplace_back(y);\n\t\te[y].emplace_back(x);\n\t}\n\tdfs1(1);\n\tcout<<ans.size()<<'\\n';\n\tfor(auto [x,y]:ans) cout<<x<<\" \"<<y<<'\\n';\n}\t\n```",
        "postTime": 1652460101,
        "uid": 115779,
        "name": "\u6781\u5bd2\u795e\u51b0",
        "ccfLevel": 0,
        "title": "cf1423c"
    },
    {
        "content": "\u4e00\u9053\u770b\u8d77\u6765\u50cf\u6784\u9020\u7684\u6570\u636e\u7ed3\u6784\u9898\u3002lxl \u5df2\u7ecf\u51fa\u8fc7\u82e5\u5e72\u9053\u52a0\u5f3a\u52a0\u5f3a\u52a0\u5f3a\u52a0\u5f3a\u52a0\u5f3a\u7248\u3002\n\n\u9996\u5148\u53ef\u4ee5\u53d1\u73b0 $k$ \u5c0f\u7684\u65f6\u5019\u4e25\u683c\u5f3a\u4e8e $k$ \u5927\u7684\u65f6\u5019\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u505a $k=3$ \u5373\u53ef\u3002\n\n\u8003\u8651\u8fd9\u4e2a\u52a0\u8fb9\u64cd\u4f5c\u7684\u6570\u636e\u7ed3\u6784\u610f\u4e49\u3002\u5b9e\u9645\u4e0a\u5c31\u76f8\u5f53\u4e8e\u6211\u4eec\u9700\u8981\u6784\u9020\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\uff0c\u4f7f\u5f97\u4efb\u610f\u4e00\u6761\u8def\u5f84\u90fd\u80fd\u5728\u8fd9\u4e2a\u6570\u636e\u7ed3\u6784\u4e0a\u88ab\u62c6\u6210 $3$ \u6bb5\u8def\u5f84\u7684\u548c\uff0c\u5e76\u4e14\u4e0d\u91cd\u4e0d\u6f0f\u5730\u8986\u76d6\u8def\u5f84\u4e0a\u7684\u8fb9\u3002\n\n\u5148\u8003\u8651\u4e00\u6761\u94fe\u600e\u4e48\u505a\u3002\n\n\u4e00\u4e2a\u5f88\u81ea\u7136\u7684\u60f3\u6cd5\u662f\u5bf9\u5e8f\u5217\u5206\u6cbb\uff0c\u4e5f\u5c31\u662f\u5927\u5bb6\u559c\u6b22\u79f0\u4e3a\u201c\u732b\u6811\u201d\u7684\u6570\u636e\u7ed3\u6784\u3002\u8fd9\u6837\u6211\u4eec\u53ea\u9700\u8981\u8fde $O(n\\log n)$ \u6761\u8fb9\uff0c\u6bcf\u6b21\u8be2\u95ee\u53ea\u4f1a\u88ab\u62c6\u6210\u4e0d\u8d85\u8fc7 $2$ \u6bb5\u3002\u4f46\u8fd9\u6837\u505a\u5f88\u53ef\u80fd\u8fc7\u4e0d\u53bb\u3002\n\n\u4f46\u6211\u4eec\u5e76\u6ca1\u6709\u5229\u7528\u597d $3$ \u6b21\u8fd9\u4e2a\u9650\u5236\u3002\n\n\u8003\u8651\u8bbe\u5b9a\u4e00\u4e2a $B$ \u8868\u793a\u628a\u5f53\u524d\u5e8f\u5217\u5206\u4e3a\u82e5\u5e72\u957f\u5ea6\u4e3a $B$ \u7684\u5757\uff0c\u5bf9\u6bcf\u4e2a\u5757\u5185\u8fde\u4e0a\u6240\u6709\u4ee3\u8868\u524d\u7f00\u548c\u540e\u7f00\u548c\u7684\u8fb9\uff0c\u603b\u5171 $O(n)$ \u6761\u3002\n\n\u5bf9\u4e8e\u7ecf\u8fc7\u81f3\u5c11\u4e00\u4e2a\u65ad\u70b9\u7684\u533a\u95f4\uff0c\u5b83\u53ef\u4ee5\u8868\u793a\u4e3a\u67d0\u4e2a\u5757\u5185\u7684\u540e\u7f00\u548c+\u82e5\u5e72\u4e2a\u5757\u7684\u548c+\u67d0\u4e2a\u5757\u5185\u7684\u524d\u7f00\u548c\u3002\u56e0\u6b64\u5bf9\u4e8e\u5206\u51fa\u6765\u7684 $\\dfrac{n}{B}$ \u4e2a\u5757\uff0c\u6211\u4eec\u9700\u8981\u8fde\u4e0a\u6240\u6709\u4ee3\u8868\u5757\u95f4\u7684\u533a\u95f4\u548c\u7684\u8fb9\uff0c\u5171 $O(\\dfrac{n^2}{B^2})$ \u6761\u3002\n\n\u5bf9\u4e8e\u4e0d\u7ecf\u8fc7\u4efb\u4f55\u65ad\u70b9\u7684\u533a\u95f4\uff0c\u53ef\u4ee5\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5757\u9012\u5f52\u5230\u5b50\u95ee\u9898\u3002\n\n\u8bbe $T(n)$ \u4e3a\u8fd9\u6837\u8fde\u51fa\u7684\u8fb9\u6570\uff0c\u53ef\u4ee5\u5f97\u5230\n\n$T(n)=\\dfrac{n}{B}T(B)+O(n+\\dfrac{n^2}{B^2})$\n\n\u5982\u679c\u6bcf\u6b21\u90fd\u53d6 $B=\\sqrt{n}$\uff0c\u5219 $T(n)=n\\log\\log n$\u3002\u5b9e\u9645\u4e0a\u6700\u4f18\u51b3\u7b56\u603b\u662f\u4f1a\u7565\u5927\u4e8e $\\sqrt{n}$\u3002\u4f46\u662f\u7531\u4e8e\u6811\u5206\u5757\u5e76\u4e0d\u50cf\u5e8f\u5217\u5206\u5757\u4e00\u6837\u4e25\u683c\uff0c\u5e76\u4e14\u8fd9\u9898\u9650\u5236\u4e5f\u4e0d\u7d27\uff0c\u56e0\u6b64\u57fa\u672c\u53ef\u4ee5\u5ffd\u7565\u8fd9\u4e2a\u5dee\u5f02\u3002\n\n\u7136\u540e\u5c31\u628a\u8fd9\u4e2a\u505a\u6cd5\u5957\u4e0a\u6811\u5206\u5757\u5373\u53ef\uff0c\u8fde\u8fb9\u7684\u65f6\u5019\u8981\u6ce8\u610f\u7ec6\u8282\u3002\u6211\u5199\u7684\u662f\u968f\u673a\u6492\u70b9\u7136\u540e\u6c42\u865a\u6811\uff0c\u4e5f\u53ef\u4ee5\u5199\u4e0d\u9700\u8981\u968f\u673a\u5316\u7684\u505a\u6cd5\uff0c\u53ea\u8981\u4e0d\u592a\u79bb\u8c31\u5e94\u8be5\u90fd\u80fd\u8fc7\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log\\log n)$\u3002\n\n\u53c2\u8003\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define N 10005\n#define M 1000005\n#define pb push_back\nmt19937 rand1(time(0));\nint n,m,B,fa[N],vs[N],st[N],q[N];vector<int> e[N];\nint tp;struct Node {int u,v;}ans[M];\nvoid dfs1(int u,int f)\n{fa[u]=f;for(auto v:e[u]) if(v!=f) dfs1(v,u);}\nvoid dfs2(int u,int f)\n{\n\tif(vs[u]==1) return;st[++st[0]]=u;\n\tfor(auto v:e[u]) if(v!=f) dfs2(v,u);\n}\nbool dfs3(int u,int f)\n{\n\tif(vs[u]==1) return 0;int cnt=0;\n\tfor(auto v:e[u]) if(v!=f && dfs3(v,u)) ++cnt;\n\tif(cnt>1) vs[u]=2;return cnt || vs[u];\n}\nvoid dfs4(int u,int f,int x)\n{\n\tif(!u || vs[u]) return;ans[++tp]=(Node) {u,x};\n\tfor(auto v:e[u]) if(v!=f) dfs4(v,u,x);\n}\nvoid dfs5(int u,int f,int x)\n{\n\tif(vs[u]==1) return;\n\tif(vs[u]) x=u,vs[u]=1,st[++st[0]]=u,dfs4(f,0,u);\n\telse if(x!=f) ans[++tp]=(Node) {u,x};\n\tfor(auto v:e[u]) if(v!=f) dfs5(v,u,x);\n}\nvoid slv()\n{\n\tq[0]=2;q[1]=1;q[++q[1]]=1;\n\twhile(q[0]<=q[1])\n\t{\n\t\tint u=q[q[0]++];st[0]=0;dfs2(u,0);\n\t\tif(st[0]<5) continue;shuffle(st+2,st+st[0]+1,rand1);\n\t\tB=sqrt(st[0]);for(int i=1;i<=B;++i) vs[st[i]]=2;\n\t\tst[0]=0;dfs3(u,0);dfs5(u,0,0);\n\t\tfor(int i=1;i<=st[0];++i) for(int j=1;j<i;++j)\n\t\t\tif(st[i]!=fa[st[j]] && st[j]!=fa[st[i]])\n\t\t\t\tans[++tp]=(Node) {st[i],st[j]};\n\t\tfor(int i=1;i<=st[0];++i) for(auto j:e[st[i]])\n\t\t\tif(st[i]==fa[j] && !vs[j]) q[++q[1]]=j;\n\t}\n}\nint main()\n{\n\tscanf(\"%d %d\",&n,&m);\n\tfor(int i=1,u,v;i<n;++i)\n\t\tscanf(\"%d %d\",&u,&v),e[u].pb(v),e[v].pb(u);\n\tdfs1(1,0);slv();printf(\"%d\\n\",tp);\n\tfor(int i=1;i<=tp;++i)\n\t\tprintf(\"%d %d\\n\",ans[i].u,ans[i].v);return 0;\n}\n```",
        "postTime": 1656944720,
        "uid": 119621,
        "name": "Kubic",
        "ccfLevel": 10,
        "title": "CF1423C Du\u0161an's Railway"
    },
    {
        "content": "\u9996\u5148 $k>3$ \u5f53 $k=3$ \u505a\uff0c\u4e5f\u5c31\u662f\u8bf4\u9898\u76ee\u7b49\u4ef7\u4e8e\u627e\u4e0d\u8d85\u8fc7 $10n$ \u6761\u8def\u5f84\u4f7f\u5f97\u4efb\u610f\u4e24\u70b9\u95f4\u7684\u8def\u5f84\u90fd\u53ef\u4ee5\u8868\u793a\u4e3a\u9009\u5b9a\u7684\u8fd9\u4e9b\u8def\u5f84\u4e2d\u4e0d\u76f8\u4ea4\u7684\u4e09\u8005\u7684\u5e76\u3002\n\n\u5148\u8003\u8651\u94fe\u600e\u4e48\u505a\uff0c\u5173\u4e8e\u8fd9\u4e2a $3$\uff0c\u5f88\u81ea\u7136\u7684\u60f3\u6cd5\u662f\u53d6\u82e5\u5e72\u5173\u952e\u70b9\uff0c\u5173\u952e\u70b9\u4e4b\u95f4\u4e24\u4e24\u8fde\u8fb9\uff0c\u5176\u4f59\u70b9\u518d\u50cf\u76f8\u90bb\u4e24\u5173\u952e\u70b9\u8fde\u8fb9\uff0c\u56e0\u6b64\u8003\u8651\u5206\u5757\uff0c\u6bcf $B$ \u4e2a\u70b9\u8bbe\u4e2a\u5173\u952e\u70b9\uff0c\u8fd9\u6837\u4e0d\u540c\u5757\u5185\u7684\u70b9\u5c31 ok \u4e86\uff0c\u4f46\u662f\u540c\u4e00\u5757\u5185\u7684\u70b9\u8fd8\u4e0d\u7b26\u5408\u6761\u4ef6\u3002\u6bd4\u8f83\u8822\u7684\u60f3\u6cd5\u662f\u4ee4 $B=n^{1/3}$ \u7136\u540e\u5757\u5185\u4e24\u4e24\u8fde\u8fb9\uff0c\u8fd9\u6837\u8fb9\u6570\u5927\u6982\u662f $n^{4/3}$\u3002\u4f46\u662f\u5176\u5b9e\u5757\u5185\u4e5f\u662f\u4e00\u4e2a\u7ed3\u6784\u7c7b\u4f3c\u7684\u5b50\u95ee\u9898\uff0c\u53ef\u4ee5\u9012\u5f52\u5904\u7406\u3002\u7531\u4e8e\u4e00\u4e2a\u6570\u6700\u591a\u5f00\u65b9 $\\log\\log n$ \u6b21\u5c31\u4f1a\u53d8\u6210 $1$\uff0c\u56e0\u6b64\u76f4\u63a5\u4ee4 $B=\\sqrt{n}$ \u7136\u540e\u9012\u5f52\u5904\u7406\u590d\u6742\u5ea6\u5927\u6982\u53ef\u4ee5\u8fbe\u5230 $n\\log\\log n$\u3002\n\n\u6811\u7684\u60c5\u51b5\u4e5f\u662f\u7c7b\u4f3c\u7684\uff0c\u76f4\u63a5\u4e0a\u6811\u5206\u5757\u5373\u53ef\u3002\u6211\u662f\u6309\u7167 Kubic \u9898\u89e3\u91cc\u968f\u673a\u6492\u70b9\u7136\u540e\u5efa\u865a\u6811\u7684\u505a\u6cd5\u6765\u5199\u7684\uff0c\u5176\u5b9e\u4e00\u76f4\u4e0d\u592a\u7406\u89e3\u8fd9\u4e2a\u5199\u6cd5\u4e3a\u5565\u4e0d\u4f1a\u88ab\u5361\u6389\uff0c\u6240\u4ee5\u524d\u51e0\u5929\u7279\u5730\u53bb u \u7fa4\u95ee\u4e86\u4e00\u5708\uff0c\u7136\u540e skip2004 \u8bf4\u4e86\u4e00\u4e9b\u6211\u542c\u4e0d\u61c2\u7684\u4e1c\u897f\uff0c\u8bf4\u5212\u5206\u51fa\u6765\u7684\u8fde\u901a\u5757\u5927\u5c0f\u7684 $\\max$ \u671f\u671b\u662f sqrt log \u7684\uff0c\u56e0\u6b64\u5b9e\u9645\u4e0a\u6492\u7684\u70b9\u6570\u8981\u7565\u591a\u4f59 $\\sqrt{n}$\u3002\u4e0d\u8fc7\u4f5c\u4e3a oier\uff0c\u5176\u5b9e\u6211\u4eec\u4e0d\u5fc5\u7279\u522b\u5728\u610f\u8fd9\u4e2a\u5dee\u5f02\uff0c\u4e00\u822c\u51fa\u9898\u4eba\u4e5f\u4e0d\u4f1a\u53ef\u4ee5\u9020\u51fa\u5361\u5230\u671f\u671b\u4e0a\u754c\u7684\u6570\u636e\u3002\n\n```cpp\nconst int MAXN=10000;\nmt19937 rng(114514);\nint n,k,hd[MAXN+5],to[MAXN*2+5],nxt[MAXN*2+5],ec;\nvoid adde(int u,int v){to[++ec]=v;nxt[ec]=hd[u];hd[u]=ec;}\nvector<pii>res;\nint typ[MAXN+5],vis[MAXN+5];\nqueue<vector<int> >q;\npair<vector<int>,int>dfs(int x,int f){\n\tvector<pair<vector<int>,int> >v;int sum=0;\n\tfor(int e=hd[x];e;e=nxt[e]){\n\t\tint y=to[e];if(y==f||!typ[y])continue;\n\t\tv.pb(dfs(y,x));sum+=(v.back().se>0);\n\t}\n\tif(typ[x]==2||sum>=2){\n\t\tfor(auto t:v){\n\t\t\tq.push(t.fi);\n\t\t\tfor(int z:t.fi){\n\t\t\t\tif(t.se)res.pb(mp(z,t.se));\n\t\t\t\tres.pb(mp(z,x));\n\t\t\t}\n\t\t}typ[x]=2;return mp(vector<int>{},x);\n\t}else{\n\t\tint pt=0;vector<int>tot;for(auto t:v)pt|=t.se;\n\t\tfor(auto t:v)for(int y:t.fi)tot.pb(y);tot.pb(x);\n\t\treturn mp(tot,pt);\n\t}\n}\nvoid work(vector<int>v){\n\tif(v.size()<=1)return;\n\tmemset(typ,0,sizeof(typ));memset(vis,0,sizeof(vis));\n\tfor(int x:v)typ[x]=1;shuffle(v.begin(),v.end(),rng);\n\tint lim=(int)sqrt(v.size());for(int i=0;i<lim;i++)typ[v[i]]=2;\n//\tprintf(\"work {\");for(int i=0;i<v.size();i++)printf(\"%d%c\",v[i],\",}\"[i+1==v.size()]);printf(\"\\n\");\n//\tfor(int i=0;i<lim;i++)printf(\"%d \",v[i]);printf(\"\\n\");\n\twhile(!q.empty())q.pop();dfs(v[0],0);vector<int>nd;\n\tfor(int x:v)if(typ[x]==2)nd.pb(x);\n\tfor(int i=0;i<nd.size();i++)for(int j=i+1;j<nd.size();j++)\n\t\tres.pb(mp(nd[i],nd[j])); \n\tvector<vector<int> >tmp;\n\twhile(!q.empty())tmp.pb(q.front()),q.pop();\n\tfor(vector<int>vv:tmp)work(vv);\n}\nint main(){\n\tscanf(\"%d%d\",&n,&k);\n\tfor(int i=1,u,v;i<n;i++)scanf(\"%d%d\",&u,&v),adde(u,v),adde(v,u);\n\tvector<int>vec;for(int i=1;i<=n;i++)vec.pb(i);work(vec);\n\tprintf(\"%d\\n\",(int)res.size());\n\tfor(pii p:res)printf(\"%d %d\\n\",p.fi,p.se);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1684222949,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1423C Du\u0161an's Railway"
    }
]
[
    {
        "content": "\u5bf9\u4e8e\u4efb\u610f\u4e00\u7ec4\u7684\u5408\u6cd5\u67d3\u8272\u89e3\uff0c\u4e00\u5b9a\u5b58\u5728\u4e00\u79cd\u5206\u5272\u65b9\u6848 $cut(idx)$ \uff08\u6211\u4eec\u7528 $cut(idx)$ \u8868\u793a\u4e00\u79cd\u5206\u5272\u77e9\u5f62\u7684\u65b9\u6848\uff0c\u610f\u4e3a\u5c06\u77e9\u9635\u5206\u5272\u6210 $1\\sim idx$ \u5217,$idx+1\\sim m$ \u5217\u7684\u5206\u5272\u65b9\u6848\uff09\uff0c\u6ee1\u8db3\u9898\u76ee\u7684\u5173\u4e8e\u989c\u8272\u683c\u5b50\u6743\u503c\u5927\u5c0f\u5173\u7cfb\u7684\u9650\u5236\u3002\n\n\u56e0\u6b64\u8003\u8651\u679a\u4e3e\u5206\u5272\u65b9\u6848 $cut(idx)$ \uff0c\u5bf9\u6bcf\u79cd\u5206\u5272\u65b9\u6848\u5c1d\u8bd5\u6784\u9020\u4e00\u79cd\u67d3\u8272\u65b9\u6848\u4f7f\u5176\u6ee1\u8db3\u9898\u76ee\u8981\u6c42\u3002\n\n\u8003\u8651\u9898\u76ee\u5bf9\u4e8e\u5207\u5272\u51fa\u7684\u5de6\u8fb9\u7684\u77e9\u9635\u7684\u9650\u5236\uff1a\n\n* \u5de6\u77e9\u9635\u4e2d\u6240\u6709\u7ea2\u8272\u5143\u7d20\u6bd4\u6240\u6709\u84dd\u8272\u5143\u7d20\u5927\u3002\n\n\u5bf9\u8be5\u9650\u5236\u505a\u4e00\u4e2a\u7b49\u4ef7\u7684\u8f6c\u6362\uff1a\n\n* \u5de6\u77e9\u9635\u4e2d\u7ea2\u8272\u5143\u7d20\u7684\u6700\u5c0f\u503c\u5927\u4e8e\u84dd\u8272\u5143\u7d20\u7684\u6700\u5927\u503c\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u5b9e\u9645\u53ea\u5728\u610f\u5207\u5272\u51fa\u7684\u77e9\u9635\u6bcf\u884c\u7684\u6700\u5c0f\u503c\u4e0e\u6700\u5927\u503c\uff0c\u7b49\u4ef7\u4e8e\u5bf9\u95ee\u9898\u8fdb\u884c\u4e86\u4e00\u4e2a\u964d\u7ef4\u3002\n\n\u8f6c\u5316\u540e\u7684\u9650\u5236\u5373\uff1a\n\n* $n$ \u4e2a\u4e8c\u5143\u7ec4 $(Mn,Mx)$ \uff0c \u8981\u6c42\u4ece\u4e2d\u9009\u51fa\u82e5\u5e72\u4e2a\uff0c\u4f7f\u5f97\u9009\u51fa\u7684\u6bcf\u4e2a\u4e8c\u5143\u7ec4\u6ee1\u8db3 $\\forall (Mn_i,Mx_i),Mn_i$ \u5927\u4e8e\u4efb\u610f\u4e00\u4e2a\u4e0d\u5728\u96c6\u5408\u4e2d\u4e8c\u5143\u7ec4\u7684 $Mx'$ \u3002\n\n\u56e0\u4e3a\u5bf9\u4e8e\u4efb\u610f\u4e8c\u5143\u7ec4 $(Mn,Mx)$ \u6709 $Mn > Mx$ \uff0c\u6240\u4ee5\u9009\u51fa\u7684\u6bcf\u4e2a\u4e8c\u5143\u7ec4\u6ee1\u8db3 $\\forall (Mn_i,Mx_i),Mn_i$ \u5927\u4e8e\u4efb\u610f\u4e00\u4e2a\u4e0d\u5728\u96c6\u5408\u4e2d\u4e8c\u5143\u7ec4\u7684 $Mn'$ \u3002\n\n\uff08\u5c06\u4e8c\u7ef4\u4e0d\u5bb9\u6613\u786e\u5b9a\u70b9\u5bf9\u76f8\u5bf9\u5173\u7cfb\u7684\u9650\u5236\u8f6c\u5316\u5230\u4e00\u7ef4\u5bb9\u6613\u786e\u5b9a\u76f8\u5bf9\u5173\u7cfb\u7684\u9650\u5236\u4e0a\u3002\uff09\n\n\u56e0\u6b64\u5982\u679c\u6211\u4eec\u9009\u4e86\u4e00\u4e2a\u4e8c\u5143\u7ec4 $(Mn_k,Mx_k)$ \u90a3\u4e48\u6240\u6709 $(Mn_i,Mx_i),Mn_i \\ge Mn_k$ \u7684\u662f\u5fc5\u9009\u7684\u3002\n\n\u56e0\u6b64\u6211\u4eec\u5c06\u6240\u6709\u7684\u4e8c\u5143\u7ec4\u6309 $Mn$ \u5347\u5e8f\u6392\u5e8f\uff0c\u5bf9\u4e8e\u4efb\u4e00\u5408\u6cd5\u7684\u6d82\u8272\u65b9\u6848\u6d82\u7ea2\u8272\u7684\u884c\u4e00\u5b9a\u662f\u6392\u5e8f\u540e\u7684\u4e00\u4e2a\u540e\u7f00\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u51fa\u4ee5\u4e0b\u7684\u505a\u6cd5\uff1a\n\n* \u679a\u4e3e $cut(idx)$ \u3002\n\n* \u5bf9\u4e8e\u6bcf\u4e2a\u56fa\u5b9a\u7684 $cut(idx)$ \u5c06\u6240\u6709\u884c\u6309\u5206\u5272\u51fa\u7684\u5de6\u8fb9\u77e9\u9635\u6bcf\u884c\u7684 $(Mn,Mx)$ \u6309 $Mn$ \u6392\u5e8f\u3002\n\n* \u679a\u4e3e\u540e\u7f00 $O(1)$ check \u65b9\u6848\u5408\u6cd5\u6027\u3002\n\n\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u5728 $O(1)$ \u7684\u65f6\u95f4\u5185 check \u65b9\u6848\u7684\u5408\u6cd5\u6027\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5728 $O(nm\\log n)$ \u7684\u65f6\u95f4\u5185\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u5b9e\u8d28\u4e0a\u5728\u5c06\u6240\u6709\u884c\u6392\u5217\u540e\uff0c\u76f8\u5f53\u4e8e\u679a\u4e3e\u4e24\u6761\u76f4\u7ebf\u5c06\u77e9\u9635\u5206\u6210\u56db\u4e2a\u90e8\u5206\uff0c\u6211\u4eec\u7684\u9650\u5236\u4e3a $\\min(C) > \\max(A),\\min(B) > \\max(D)$ \uff0c\u5728\u679a\u4e3e\u7684\u8fc7\u7a0b\u7ef4\u62a4\u524d\u7f00 $\\min,\\max$ \u5373\u53ef\u3002\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5f1u6rnm.png)\n\n\n\n\u6211\u4eec\u8003\u8651\u4e0a\u8ff0\u505a\u6cd5\u6b63\u786e\u7684\u6839\u672c\u6027\u539f\u56e0\u3002\n\n\u4e00\u4e2a\u5f88\u91cd\u8981\u7684\u8f6c\u5316\u662f\uff0c\u6211\u4eec\u7528\u6bcf\u4e00\u884c\u7684\u524d\u7f00 $\\min$ \u4ee3\u8868\u51fa\u6bcf\u884c\u7684\u76f8\u5bf9\u5173\u7cfb\uff0c\u5373\u9009\u4e86 xx \u884c\uff0c\u4e00\u5b9a\u9009 yy \u884c\u3002\n\n\u4f46\u5b9e\u9645\u4e0a\uff0c\u56de\u5f52\u9898\u76ee\u9650\u5236\uff0c\u6211\u4eec\u4ece\u6bcf\u4e00\u884c\u7684\u524d\u7f00\u4e2d\u968f\u4fbf\u9009\u4e00\u4e2a\u4ee3\u8868\u5143\u7d20 $d_i$ \uff0c\u5982\u679c\u6211\u4eec\u9009\u4e86\u7b2c $k$ \u884c\uff0c\u90a3\u4e48\u6240\u6709 $d_i\\ge d_k$ \u7684\u884c $i$ \u4e5f\u4e00\u5b9a\u5fc5\u9009\u3002\n\n\u56e0\u4e3a\u6bcf\u4e2a\u524d\u7f00\u90fd\u5305\u542b\u7b2c\u4e00\u5217\u7684\u5143\u7d20\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u53ea\u6309\u7b2c\u4e00\u5217\u5143\u7d20\u6392\u5e8f\u4e00\u6b21\uff0c\u53ef\u4ee5\u505a\u5230 $O(n\\log n + nm)$ \u7684\u590d\u6742\u5ea6\u3002\n\n```cpp\n#include <bits/stdc++.h>\n\n#define rep(i,l,r) for (int i = l; i <= r; i++)\n#define per(i,r,l) for (int i = r; i >= l; i--)\n#define fi first\n#define se second\n#define prt std::cout\n#define gin std::cin\n#define edl std::endl\n\nnamespace wxy{\n\nconst int N = 5e5 + 50;\n\nstd::vector<int> a[N],rmax[N],rmin[N];\n\nint p[N],lmin[N],lmax[N],ll[N],rr[N];\n\nint col[N];\n\nvoid solve(){\n\tint n,m; gin >> n >> m;\n\trep(i,1,n) a[i].resize(m+1),rmin[i].resize(m+1),rmax[i].resize(m+1);\n\trep(i,1,n){\n\t\trep(j,1,m) gin >> a[i][j];\n\t\trmin[i][m] = rmax[i][m] = a[i][m];\n\t\tper(j,m-1,1) rmin[i][j] = std::min(rmin[i][j+1],a[i][j]),rmax[i][j] = std::max(rmax[i][j+1],a[i][j]);\n\t}\n\trep(i,1,n) p[i] = i;\n\tstd::sort(p+1,p+1+n,[](int x,int y){return a[x][1] > a[y][1];});\n\trep(k,1,m-1) {\n\t\tif (k == 1) rep(i,1,n) lmin[i] = lmax[i] = a[p[i]][1];\n\t\telse rep(i,1,n) lmin[i] = std::min(lmin[i],a[p[i]][k]),lmax[i] = std::max(lmax[i],a[p[i]][k]);\n\t\tll[n] = lmax[n],rr[n] = rmin[p[n]][k+1];\n\t\tper(i,n-1,1) ll[i] = std::max(ll[i+1],lmax[i]),rr[i] = std::min(rr[i+1],rmin[p[i]][k+1]);\n\t\tint lm = lmin[1],rm = rmax[p[1]][k+1];\n\t\trep(i,1,n-1) {\n\t\t\tlm = std::min(lm,lmin[i]),rm = std::max(rm,rmax[p[i]][k+1]);\n\t\t\tif (lm > ll[i+1] && rm < rr[i+1]) {\n\t\t\t\tputs(\"YES\");\n\t\t\t\trep(j,1,i) col[p[j]] = 1;\n\t\t\t\trep(j,i+1,n) col[p[j]] = 0;\n\t\t\t\trep(j,1,n) if (col[j]==1) prt << \"R\"; else prt << \"B\"; prt << \" \" << k << edl;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t} puts(\"NO\");\n}\n\ninline void main(){\n    #ifndef ONLINE_JUDGE\n        freopen(\"in.in\",\"r\",stdin);\n        freopen(\"out.out\",\"w\",stdout);\n    #endif\n    int t; gin >> t; while (t--) solve();\n}\n\n}signed main(){wxy::main(); return 0;}\n```\n\n",
        "postTime": 1635739582,
        "uid": 317459,
        "name": "RyexAwl",
        "ccfLevel": 6,
        "title": "\u3010\u9898\u89e3\u3011CF1606D Red-Blue Matrix \u8d2a\u5fc3"
    },
    {
        "content": "\u5f88\u5957\u8def\u7684\u4e00\u4e2a\u9898\u3002\n\n\u663e\u7136\uff0c\u7eb5\u5217\u7684\u5207\u5272\u53ea\u6709 $m-1$ \u79cd\u65b9\u6848\u3002\n\n\u7531\u9898\u610f\uff0c\u7ecf\u5207\u5272\u540e\uff0c\u5de6\u8fb9\u77e9\u9635\u84dd\u8272\u90e8\u5206\u7684\u6700\u5927\u503c\u4e00\u5b9a\u5c0f\u4e8e\u5de6\u8fb9\u77e9\u9635\u7ea2\u8272\u90e8\u5206\u7684\u6700\u5c0f\u503c\u3002\u5f31\u5316\u8fd9\u4e2a\u6761\u4ef6\uff0c\u53ea\u8003\u8651\u7b2c\u4e00\u5217\uff0c\u5c06\u7b2c\u4e00\u5217\u7684\u6570\u5b57\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u4ee5\u6b64\u91cd\u7ec4\u77e9\u9635\u4e2d\u6bcf\u4e00\u884c\u7684\u987a\u5e8f\u3002\u6b64\u65f6\u5982\u679c\u7b2c $i$ \u884c\u7b2c\u4e00\u683c\u4e3a\u84dd\u8272\uff0c\u7b2c $i+1$ \u884c\u7b2c\u4e00\u683c\u4e3a\u7ea2\u8272\uff0c\u90a3\u4e48 $1 \\sim i$ \u884c\u7b2c\u4e00\u5217\u5747\u4e3a\u84dd\u8272\uff0c$(i+1) \\sim n$ \u884c\u7b2c\u4e00\u683c\u5747\u4e3a\u7ea2\u8272\u3002\u4e8e\u662f\u679a\u4e3e\u8fd9\u4e2a $i$\uff0c\u7531\u4e8e $i$ \u6700\u591a\u53ea\u80fd\u53d6 $n-1$\u3002\u6240\u4ee5\u9700\u8981\u679a\u4e3e\u7684\u60c5\u51b5\u603b\u6570\u4e3a $(n-1)(m-1)$\uff0c\u63a5\u4e0b\u6765\u53ea\u9700 $O(1)$ \u9a8c\u8bc1\u5373\u53ef\u3002\n\n\u663e\u7136\uff0c\u82e5\u5207\u5272\u524d $i$ \u884c\uff0c\u524d $j$ \u5217\uff0c\u53ea\u9700\u4fdd\u8bc1\u5207\u5272\u540e\u7684\u5de6\u4e0a\u90e8\u6700\u5927\u503c\u5c0f\u4e8e\u5de6\u4e0b\u90e8\u6700\u5c0f\u503c\u5e76\u4e14\u53f3\u4e0a\u90e8\u6700\u5c0f\u503c\u5927\u4e8e\u53f3\u4e0b\u90e8\u6700\u5927\u503c\uff0c\u5373\u53ef\u5f97\u5230\u4e00\u7ec4\u5408\u6cd5\u89e3\u3002\u8fd9\u56db\u4e2a\u91cf\u53ef\u4ee5\u7528\u524d\u7f00\u548c\u4e0e\u540e\u7f00\u548c\u8ba1\u7b97\u3002\n\n```\n#include<iostream>\n#include<cstdio>\n#include<vector>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nconst int N=5e5+5;\nint T,n,m,p[N];char ans[N];\nvector<int>a[N],fmn[N],fmx[N],gmn[N],gmx[N],zsmx[N],zxmn[N],ysmn[N],yxmx[N];\n//p[i]\u8868\u793a\u6392\u5b8c\u5e8f\u540e\u7684\u7b2ci\u4e2a\u662f\u7b2c\u51e0\u884c\n//fmn\u8868\u793a\u6bcf\u884c\u7684\u524d\u7f00\u6700\u5c0f\uff0c\u540c\u7406fmx\uff08\u8fd9\u91cc\u7684\u524d\u7f00\u4ee5\u6392\u5b8c\u5e8f\u540e\u7684\u77e9\u9635\u6765\u7b97\uff0c\u4e00\u4e0b\u540c\u7406\uff09\n//gmn\u8868\u793a\u6bcf\u884c\u7684\u540e\u7f00\u6700\u5c0f\uff0c\u540c\u7406gmx\n//zxmn\u8868\u793a\u4f4d\u7f6e(i,j)\u5de6\u4e0b\u90e8\u7684\u6700\u5c0f\u503c\n//zsmx\u8868\u793a\u4f4d\u7f6e(i,j)\u5de6\u4e0a\u90e8\u7684\u6700\u5927\u503c\n//ysmn\u8868\u793a\u4f4d\u7f6e(i,j)\u53f3\u4e0a\u90e8\u7684\u6700\u5c0f\u503c\n//yxmx\u8868\u793a\u4f4d\u7f6e(i,j)\u53f3\u4e0b\u90e8\u7684\u6700\u5927\u503c\nbool cmp(int x,int y){\n\treturn a[x][1]<a[y][1];\n}\nint main(){\n\tfor(cin>>T;T;T--){\n\t\tcin>>n>>m;\n\t\tfor(int i=0;i<=n+1;i++)\n\t\t\tfor(int j=0;j<=m+1;j++){\n\t\t\t\ta[i].push_back(0);\n\t\t\t\tfmn[i].push_back(1e6+5);\n\t\t\t\tgmn[i].push_back(1e6+5);\n\t\t\t\tfmx[i].push_back(0);\n\t\t\t\tgmx[i].push_back(0);\n\t\t\t\tzsmx[i].push_back(0);\n\t\t\t\tzxmn[i].push_back(1e6+5);\n\t\t\t\tysmn[i].push_back(1e6+5);\n\t\t\t\tyxmx[i].push_back(0);\n\t\t\t}\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tfor(int j=1;j<=m;j++)\n\t\t\t\tscanf(\"%d\",&a[i][j]);\n\t\tfor(int i=1;i<=n+1;i++)\n\t\t\tp[i]=i;\n\t\tsort(p+1,p+n+1,cmp);\n\t\tfor(int j=1;j<=m;j++){\n\t\t\tfor(int i=1;i<=n;i++){\n\t\t\t\tfmx[p[i]][j]=max(a[p[i]][j],fmx[p[i-1]][j]);\n\t\t\t\tfmn[p[i]][j]=min(a[p[i]][j],fmn[p[i-1]][j]);\n\t\t\t}\n\t\t\tfor(int i=n;i>=1;i--){\n\t\t\t\tgmx[p[i]][j]=max(a[p[i]][j],gmx[p[i+1]][j]);\n\t\t\t\tgmn[p[i]][j]=min(a[p[i]][j],gmn[p[i+1]][j]);\n\t\t\t}\n\t\t}\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tfor(int j=1;j<=m;j++)\n\t\t\t\tzsmx[p[i]][j]=max(zsmx[p[i]][j-1],fmx[p[i]][j]);\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tfor(int j=m;j>=1;j--)\n\t\t\t\tysmn[p[i]][j]=min(ysmn[p[i]][j+1],fmn[p[i]][j]);\n\t\tfor(int i=n;i>=1;i--)\n\t\t\tfor(int j=1;j<=m;j++)\n\t\t\t\tzxmn[p[i]][j]=min(zxmn[p[i]][j-1],gmn[p[i]][j]);\n\t\tfor(int i=n;i>=1;i--)\n\t\t\tfor(int j=m;j>=1;j--)\n\t\t\t\tyxmx[p[i]][j]=max(yxmx[p[i]][j+1],gmx[p[i]][j]);\n\t\tint t1=-1,t2=-1;\n\t\tfor(int i=1;i<n;i++)\n\t\t\tfor(int j=1;j<m;j++)\n\t\t\t\tif(zsmx[p[i]][j]<zxmn[p[i+1]][j]&&ysmn[p[i]][j+1]>yxmx[p[i+1]][j+1]){\n\t\t\t\t\tt1=i,t2=j;break;\n\t\t\t\t}\n\t\tif(t1==-1)puts(\"NO\");\n\t\telse{\n\t\t\tputs(\"YES\");\n\t\t\tfor(int i=1;i<=t1;i++)ans[p[i]]='B';\n\t\t\tfor(int i=t1+1;i<=n;i++)ans[p[i]]='R';\n\t\t\tfor(int i=1;i<=n;i++)putchar(ans[i]);\n\t\t\tprintf(\" %d\\n\",t2);\n\t\t}\n\t\tfor(int i=0;i<=n+1;i++){\n\t\t\ta[i].clear();\n\t\t\tfmn[i].clear(),gmn[i].clear(),fmx[i].clear(),gmx[i].clear();\n\t\t\tzsmx[i].clear(),zxmn[i].clear(),ysmn[i].clear(),yxmx[i].clear();\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1635692208,
        "uid": 115668,
        "name": "y0y68",
        "ccfLevel": 0,
        "title": "\u9898\u89e3\u3010CF1606D\u3011"
    },
    {
        "content": "## \u601d\u8def\uff1a\u524d\u7f00\u548c + \u66b4\u529b\n\n### \u9898\u610f\n\n\u9898\u76ee\u5927\u610f\u4e3a\u5728\u7ed9\u5b9a\u7684 $n \\cdot m$ \u7684\u77e9\u5f62\u4e2d\u9009\u51fa\u82e5\u5e72\u884c\u6d82\u6210\u7ea2\u8272\uff0c\u5269\u4e0b\u90e8\u5206\u4e3a\u84dd\u8272\uff0c\u82e5\u6d82\u8272\u4e4b\u540e\u80fd\u591f\u9009\u5b9a\u4e00\u4e2a\u5206\u754c\u7ebf $k$ \u4f7f\u5f97\u5de6\u8fb9 $k$ \u5217\u4e2d\u7ea2\u8272\u683c\u5b50\u5185\u7684\u6570\u90fd\u5927\u4e8e\u84dd\u8272\u683c\u5b50\u5185\u7684\u6570\uff0c\u53f3\u8fb9 $m - k$ \u5217\u4e2d\u84dd\u8272\u683c\u5b50\u5185\u7684\u6570\u90fd\u5927\u4e8e\u7ea2\u8272\u683c\u5b50\u5185\u7684\u6570\uff0c\u5c31\u79f0\u4e3a\u4e00\u4e2a\u5408\u6cd5\u7684\u5212\u5206\u3002\u95ee\u7ed9\u5b9a\u77e9\u9635\u662f\u5426\u5b58\u5728\u4e00\u4e2a\u5408\u6cd5\u7684\u5212\u5206\u3002\n\n### \u601d\u8def\n\n\u4e0d\u59a8\u5047\u5b9a $k = 1$ \uff0c\u82e5\u7b2c\u4e00\u5217\u5408\u6cd5\uff0c\u5219\u7b2c\u4e00\u5217\u4e2d\u7ea2\u8272\u7684\u65b9\u5757\u4e00\u5b9a\u662f\u53d6\u6700\u5927\u7684\u8fde\u7eed\u82e5\u5e72\u4e2a\uff0c\u6240\u4ee5\u53ef\u4ee5\u6839\u636e\u7b2c\u4e00\u5217\u7684\u6570 $a_{i,1}$ \u5bf9\u884c\u8fdb\u884c\u6392\u5e8f\uff0c\u6392\u5b8c\u5e8f\u4e4b\u540e\u7ea2\u8272\u7684\u683c\u5b50\u4e00\u5b9a\u53ea\u80fd\u53d6\u7b2c $i$ \u5230 $n$ \u884c\uff0c\u5176\u4e2d $i \\geq 2$ \u3002\u90a3\u4e48\u518d\u679a\u4e3e\u5217\u8fdb\u884c\u5224\u65ad\u5c31\u53ef\u4ee5\u4e86\uff0c\u6309\u7167\u4e0b\u56fe\u8fd9\u6837\u5224\u65ad\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vzdkfkjn.png)\n\n\u7528 4 \u4e2a\u524d\u7f00\u548c\u9884\u5904\u7406\u4e00\u4e0b 4 \u4e2a\u89d2\u7684 $\\max$ \u548c $\\min$ \u540e\u679a\u4e3e\u4e2d\u95f4\u70b9\u5224\u65ad\u5373\u53ef\u3002\n\n### \u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\nusing ll=long long;\n\nconst int N=(int)5e5+5;\nint _;\n\nvector<int> a[N];\nvector<int> p1[N],p2[N],p3[N],p4[N];\nint n,m;\nint p[N];\nchar ans[N];\n\nvoid work(){\n    scanf(\"%d%d\",&n,&m);\n    for(int i=0;i<=n+1;i++){\n        p1[i].clear();\n        p2[i].clear();\n        p3[i].clear();\n        p4[i].clear();\n        a[i].clear();\n        p1[i].resize(m+5,0);\n        p2[i].resize(m+5,(int)1e6);\n        p3[i].resize(m+5,(int)1e6);\n        p4[i].resize(m+5,0);\n        a[i].resize(m+5,0);\n    }\n    for(int i=1;i<=n;i++)\n        for(int j=1,x;j<=m;j++) scanf(\"%d\",&a[i][j]);\n    iota(p,p+2+n,0);\n    sort(p+1,p+1+n,[](const int& x,const int& y){\n        return a[x][1]<a[y][1];//\u6392\u5e8f\u53e6\u7528\u4e00\u4e2a\u6570\u7ec4\u6392\u4e0b\u8868\uff0c\u53ef\u4ee5\u4e0d\u7528\u76f4\u63a5\u4ea4\u6362vector\n    });\n    for(int i=1;i<=n;i++)\n        for(int j=1;j<=m;j++){\n            p1[p[i]][j]=a[p[i]][j];\n            p1[p[i]][j]=max(p1[p[i]][j],p1[p[i-1]][j]);\n            p1[p[i]][j]=max(p1[p[i]][j],p1[p[i]][j-1]);\n        }\n    for(int i=1;i<=n;i++)\n        for(int j=m;j>=1;j--){\n            p2[p[i]][j]=a[p[i]][j];\n            p2[p[i]][j]=min(p2[p[i]][j],p2[p[i-1]][j]);\n            p2[p[i]][j]=min(p2[p[i]][j],p2[p[i]][j+1]);\n        }\n    for(int i=n;i>=1;i--)\n        for(int j=1;j<=m;j++){\n            p3[p[i]][j]=a[p[i]][j];\n            p3[p[i]][j]=min(p3[p[i]][j],p3[p[i+1]][j]);\n            p3[p[i]][j]=min(p3[p[i]][j],p3[p[i]][j-1]);\n        }\n    for(int i=n;i>=1;i--)\n        for(int j=m;j>=1;j--){\n            p4[p[i]][j]=a[p[i]][j];\n            p4[p[i]][j]=max(p4[p[i]][j],p4[p[i+1]][j]);\n            p4[p[i]][j]=max(p4[p[i]][j],p4[p[i]][j+1]);\n        }\n    for(int i=n;i>=2;i--){\n        for(int j=1;j<=m-1;j++){\n            if(p3[p[i]][j]>p1[p[i-1]][j]&&p2[p[i-1]][j+1]>p4[p[i]][j+1]){\n                for(int k=1;k<=n;k++) ans[k]='B';\n                for(int k=n;k>=i;k--) ans[p[k]]='R';\n                printf(\"YES\\n\");\n                for(int k=1;k<=n;k++) printf(\"%c\",ans[k]);\n                printf(\" %d\\n\",j);\n                return;\n            }\n        }\n    }\n    printf(\"NO\\n\");\n}\n\nint main(){\n    _=1;\n    scanf(\"%d\",&_);\n    while(_--){\n        work();\n    }\n    return 0;\n}\n```",
        "postTime": 1635578728,
        "uid": 96720,
        "name": "Cupids_Bow",
        "ccfLevel": 0,
        "title": "\u9898\u89e3CF1606D Red-Blue Matrix"
    }
]
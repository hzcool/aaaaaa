[
    {
        "content": "\u548c[[TJOI2015]\u5f26\u8bba](https://www.luogu.org/problem/P3975)\u8fd9\u4e2a\u4e00\u6837\n\n\u663e\u7136**\u540e\u7f00\u81ea\u52a8\u673a**\n\n$size[p]$\u8868\u793a\u8282\u70b9p\u80fd\u8868\u793a\u7684\u6bcf\u4e2a\u5b50\u4e32\u5728\u539f\u4e32\u4e2d\u7684\u51fa\u73b0\u6b21\u6570\n\n\u8fd9\u4e2a\u73a9\u610f\u53ea\u662f\u5bf9\u5355\u4e2a\u8282\u70b9\u7684\uff0c\u7c7b\u4f3c\u5e73\u8861\u6811\u627ekth\uff0c\u6211\u4eec\u9700\u8981\u77e5\u9053\u6bcf\u4e2a\u5b50\u6811\u7684\u5927\u5c0f\n\n\u6240\u4ee5\u6211\u4eec\u8fd8\u8981\u628a26\u6761\u8f6c\u79fb\u8fb9\u7684$size$\u90fd\u7d2f\u52a0\u8d77\u6765\u8bb0\u4f5c$tot$\n\n```cpp\n#include<cstdio>\n#include<cstring>\ntypedef long long ll;\nconst int N=1e5+10;\ntemplate<int maxn,int maxc>class Suffix_Automaton\n{\n\tprivate:\n\t\tstatic const int maxs=maxn<<1;\n\t\tll tot[maxs];\n\t\tint last,cnt,n,son[maxs][26],fa[maxs],len[maxs],size[maxs],sum[maxn],rnk[maxs];\n\t\tinline const void extend(int c)\n\t\t{\n\t\t\tint p=last,np=++cnt;\n\t\t\tlen[last=np]=len[p]+(size[np]=1);\n\t\t\tfor (;p&&!son[p][c];p=fa[p])son[p][c]=np;\n\t\t\tif (!p)return fa[np]=1,void();\n\t\t\tint q=son[p][c];\n\t\t\tif (len[q]==len[p]+1)return fa[np]=q,void();\n\t\t\tint nq=++cnt;len[nq]=len[p]+1;\n\t\t\tmemcpy(son[nq],son[q],sizeof(son[q]));\n\t\t\tfa[nq]=fa[q];fa[q]=fa[np]=nq;\n\t\t\tfor (;son[p][c]==q;p=fa[p])son[p][c]=nq;\n\t\t}\n\t\tinline const void radixsort()\n\t\t{\n\t\t\tfor (int i=1;i<=cnt;i++)sum[len[i]]++;\n\t\t\tfor (int i=1;i<=n;i++)sum[i]+=sum[i-1];\n\t\t\tfor (int i=1;i<=cnt;i++)rnk[sum[len[i]]--]=i;\n\t\t}\n\tpublic:\n\t\tinline const void build(char *s)\n\t\t{\n\t\t\tlast=cnt=1;\n\t\t\tn=strlen(s+1);\n\t\t\tfor (int i=1;i<=n;i++)extend(s[i]-'a');\n\t\t\tradixsort();\n\t\t\tfor (int i=cnt;i;i--)size[fa[rnk[i]]]+=size[rnk[i]];\n\t\t\tsize[1]=0;\n\t\t\tfor (int i=cnt;i;i--)\n\t\t\t{\n\t\t\t\tint p=rnk[i];\n\t\t\t\ttot[p]=size[p];\n\t\t\t\tfor (int j=0;j<26;j++)tot[p]+=tot[son[p][j]];\n\t\t\t}\n\t\t}\n\t\tinline const void query(int k)\n\t\t{\n\t\t\tif (k>tot[1])return puts(\"No such line.\"),void();\n\t\t\tint p=1;\n\t\t\twhile ((k-=size[p])>0)\n\t\t\t{\n\t\t\t\tint i=0;\n\t\t\t\tfor (;k>tot[son[p][i]]&&i<26;i++)k-=tot[son[p][i]];\n\t\t\t\tp=son[p][i];\n\t\t\t\tputchar(i+'a');\n\t\t\t}\n\t\t}\n};\nSuffix_Automaton<N,26>sam;\nchar s[N];\nint k;\nint main()\n{\n\tscanf(\"%s\",s+1);\n\tscanf(\"%d\",&k);\n\tsam.build(s);\n\tsam.query(k);\n\treturn 0;\n}\n```",
        "postTime": 1571032789,
        "uid": 14374,
        "name": "zhengrunzhe",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF128B \u3010String\u3011"
    },
    {
        "content": "# $\\text{Describe}$\n\n\u6a21\u62df\u8d5b $\\text C$ \u9898\uff0c\u4e0d\u7b80\u5355\u9898\u3002\u3002\u3002\n\n[\u6d1b\u8c37link](https://www.luogu.com.cn/problem/CF128B)\n\n[Codeforces link](https://codeforces.com/contest/128/problem/B)\n\n\u7b80\u8981\u9898\u610f\uff08\u6d1b\u8c37\u7ffb\u8bd1\uff09\uff1a\u6c42\u7ed9\u5b9a\u5b57\u7b26\u4e32\u7684\u5b57\u5178\u5e8f\u7b2c $k$ \u5c0f\u5b50\u4e32\uff08\u5141\u8bb8\u91cd\u590d\uff09\u3002\n\n# $\\text{Solution}$\n\n\u673a\u623f\u51e0\u4e2a\u5927\u4f6c\u7528 SAM ``prioryty_queue`` \u628a\u8fd9\u9053\u9898\u8fc7\u4e86\uff0c\u90fd\u8584\u7eb1\u6211\u3002\n\n\u9996\u5148\u6211\u4eec\u60f3\u5230\u5b50\u4e32\u4e00\u5b9a\u53ef\u4ee5\u8868\u793a\u4e3a\u67d0\u4e2a\u540e\u7f00\u7684\u524d\u7f00\uff0c\u8fd9\u542f\u53d1\u6211\u4eec\u7528\u540e\u7f00\u6570\u7ec4\u505a\u8fd9\u9053\u9898\u3002\n\n\u6309\u5b57\u5178\u5e8f\u5c06\u6240\u6709\u540e\u7f00\u4ece\u5c0f\u5230\u5927\u6392\u597d\uff0c\u7b2c $i$ \u4e2a\u7684\u6240\u6709\u524d\u7f00\u7684\u5b57\u5178\u5e8f\u4e00\u5b9a\u662f\u5c0f\u4e8e\u7b2c $i+1$ \u4e2a\u540e\u7f00\u7684\u3002\n\n\u8fd9\u662f\u663e\u7136\u7684\uff0c\u5927\u5bb6\u7a0d\u4f5c\u601d\u8003\u904d\u80fd\u5f97\u51fa\u8fd9\u4e2a\u7ed3\u8bba\uff08\u4e0d\u4f1a\u7684\u53ef\u4ee5\u5728\u8bc4\u8bba\u91cc\u8bf4\u4e00\u4e0b\uff09\u3002\n\n\u6240\u4ee5\u6211\u4eec\u4ece $\\mathrm{lcp}(i-1,i)+1$ \u5f00\u59cb\u5411\u540e\u679a\u4e3e\u524d\u7f00\uff0c\u7edf\u8ba1\u4ed6\u4eec\u51fa\u73b0\u7684\u4e2a\u6570\u3002\n\n\u4ece $\\mathrm{lcp}(i-1,i)+1$ \u679a\u4e3e\u524d\u7f00\u662f\u4e3a\u4ec0\u4e48\u5462\uff0c\u56e0\u4e3a\u524d $\\mathrm{lcp}(i-1,i)$ \u4e2a\u5143\u7d20\u7ec4\u6210\u7684\u5b50\u4e32\u4e00\u5b9a\u88ab\u7edf\u8ba1\u8fc7\u4e86\u3002\n\n\u90a3\u6211\u4eec\u5982\u4f55\u7edf\u8ba1\u51fa\u73b0\u6b21\u6570\u5462\uff0c\u56e0\u4e3a\u6240\u6709\u540e\u7f00\u7684\u524d\u7f00\u672c\u8d28\u4e0a\u4e00\u5b9a\u662f\u4e0d\u540c\u7684\uff08\u56e0\u4e3a\u5f00\u5934\u5c31\u4e0d\u540c\u4e86\uff09\u3002\n\n\u800c\u4e14\u6211\u4eec\u5df2\u7ecf\u5c06\u5b83\u4eec\u6309\u7167\u5b57\u5178\u5e8f\u6392\u597d\u5e8f\u4e86\u6240\u4ee5\u5f53\u524d\u540e\u7f00 $i$ \u4e0e\u540e\u9762\u7684 $i+1 \\sim n$ \u7684 $\\mathrm{lcp}$ \u4e00\u5b9a\u662f\u5355\u8c03\u4e0d\u5347\u7684\u3002\n\n\u6ee1\u8db3\u5355\u8c03\u6027\u5c31\u53ef\u4ee5\u4e8c\u5206\u7edf\u8ba1\u6b21\u6570\u4e86\u3002\n\n\u7136\u540e\u6211\u4eec\u518d\u7ef4\u62a4\u4e00\u4e2a\u5f53\u524d $rank$ \u8868\u793a\u76ee\u524d\u7684\u6392\u540d\u662f\u591a\u5c11\uff0c\u6bcf\u6b21 $rank$ \u52a0\u4e0a\u5b50\u4e32\u51fa\u73b0\u7684\u4e2a\u6570\uff0c\u5982\u679c\u6ee1\u8db3\u8981\u6c42\uff08\u8fbe\u5230 $k$\uff09\uff0c\u90a3\u5f53\u524d\u5b57\u4e32\u5c31\u662f\u7b54\u6848\u3002\n\n# $\\text{Code}$\n\n```cpp\n//SA and Binary_Search\n#include<bits.stdc++.h>\n#define ll long long\n#define N 100005\nusing namespace std;\nint read(){\n\tint x=0,f=1,ch=getchar();\n\tfor(;!isdigit(ch);ch=getchar()) f=(ch=='-')?-1:1;\n\tfor(;isdigit(ch);ch=getchar()) x=(x<<3)+(x<<1)+(ch^48);\n\treturn x*f;\n}\nint n,m=256,k,w,p,Rank;\nint sa[N],rk[N],height[N];\nint id[N],ork[N<<1],lcp[N][25],cnt[N],key[N];\nchar a[N];\nnamespace SA{\n\tint Lcp(int x,int y){\n\t\tint p=log(y-x+1)/log(2);\n\t\treturn min(lcp[x][p],lcp[y-(1<<p)+1][p]);\n\t}\n\tint LCP(int l,int r){\n\t\tif(l>r) swap(l,r);\n\t\treturn Lcp(min(rk[l],rk[r])+1,max(rk[l],rk[r]));\n\t}\n\tbool cmp(int x,int y,int w){return ork[x]==ork[y] && ork[x+w]==ork[y+w];}\n\tvoid Get_SA(){\n\t\tfor(int i=1;i<=n;++i) ++cnt[rk[i]=a[i]];\n\t\tfor(int i=1;i<=m;++i) cnt[i]+=cnt[i-1];\n\t\tfor(int i=n;i>=1;--i) sa[cnt[rk[i]]--]=i;\n\t\tfor(w=1;;w<<=1,m=p){\n\t\t\tp=0;\n\t\t\tfor(int i=n;i>n-w;--i) id[++p]=i;\n\t\t\tfor(int i=1;i<=n;++i){\n\t\t\t\tif(sa[i]>w){\n\t\t\t\t\tid[++p]=sa[i]-w;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemset(cnt,0,sizeof(cnt));\n\t\t\tfor(int i=1;i<=n;++i) ++cnt[key[i]=rk[id[i]]];\n\t\t\tfor(int i=1;i<=m;++i) cnt[i]+=cnt[i-1];\n\t\t\tfor(int i=n;i>=1;--i) sa[cnt[key[i]]--]=id[i];\n\t\t\tfor(int i=1;i<=n;++i) ork[i]=rk[i];\n\t\t\tp=0;\n\t\t\tfor(int i=1;i<=n;++i) rk[sa[i]]=cmp(sa[i],sa[i-1],w)?p:++p;\n\t\t\tif(p==n){\n\t\t\t\tfor(int i=1;i<=n;++i) sa[rk[i]]=i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tvoid Get_LCP(){\n\t\tfor(int i=1;i<=n;++i) lcp[i][0]=height[i];\n\t\tfor(int j=1;j<=20;++j){\n\t\t\tfor(int i=1;i<=(n-(1<<j)+1);++i){\n\t\t\t\tlcp[i][j]=min(lcp[i][j-1],lcp[i+(1<<j-1)][j-1]);\n\t\t\t}\n\t\t}\n\t}\n\tvoid Get_Height(){\n\t\tfor(int i=1,k=0;i<=n;++i){\n\t\t\tif(k) --k;\n\t\t\twhile(a[i+k]==a[sa[rk[i]-1]+k]) ++k;\n\t\t\theight[rk[i]]=k;\n\t\t}\n\t}\n\tvoid init(){\n\t\tGet_SA();\n\t\tGet_Height();\n\t\tGet_LCP();\n\t}\n}\nint main(){\n\tscanf(\"%s\",a+1);n=strlen(a+1);k=read();\n\tSA::init();\n\tif((ll)n*(n+1)/2<(ll)k){\n\t\tputs(\"No such line.\");\n\t\treturn 0;\n\t}\n\tfor(int i=1;i<=n;++i){\n\t\tfor(int j=height[i]+sa[i]+1;j<=n+1;++j){\n\t\t\tint l=i+1,r=n,res=i;\n\t\t\twhile(l<=r){\n\t\t\t\tint mid=(l+r)>>1;\n\t\t\t\tif(SA::Lcp(i+1,mid)>=j-sa[i]) l=mid+1,res=mid;\n\t\t\t\telse r=mid-1;\n\t\t\t}\n\t\t\tRank+=res-i+1;\n\t\t\tif(Rank>=k){\n\t\t\t\tfor(int t=sa[i];t<j;++t) printf(\"%c\",a[t]);\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1680074622,
        "uid": 780168,
        "name": "WSXZCLXS",
        "ccfLevel": 0,
        "title": "CF128B-solution"
    },
    {
        "content": "\u4e3a\u4ec0\u4e48\u8981\u4eba\u4e91\u4ea6\u4e91\uff1f\n\n\u8c01\u8bf4\u8fd9\u9898\u53ea\u80fd\u540e\u7f00\u81ea\u52a8\u673a\uff1f\n\n\u8d2a\u5fc3\u5176\u5b9e\u4e5f\u53ef\u4ee5\u3002\n\n\u9996\u5148\u60f3\u5230\u7684\u601d\u8def\u5c31\u662f\u5c06\u5b57\u7b26\u4e32\u7684\u6240\u6709\u5b50\u4e32\u4e00\u4e00\u52a0\u5230\u4f18\u5148\u961f\u5217\u4e2d\uff0c\u4e0d\u8fc7\u5f88\u663e\u7136\uff0c\u8fd9\u79cd\u65b9\u6cd5\u4e0d\u8bba\u662f\u65f6\u95f4\u8fd8\u662f\u7a7a\u95f4\u90fd\u4f1a\u70b8\u3002\u6240\u4ee5\u5c31\u76f4\u63a5\u6392\u9664\u8fd9\u79cd\u5199\u6cd5\u3002\n\n### \u89e3\u9898\u601d\u8def\uff1a\n\n\u5176\u5b9e\u8d2a\u5fc3\u7b56\u7565\u5f88\u597d\u60f3\uff0c\u5982\u4e0b\u6240\u793a\u3002\n\n\u6b65\u9aa4\u4e00\uff1a\u5c06\u5b57\u7b26\u4e32\u4e2d\u7684\u5b57\u7b26\u4f9d\u6b21\u52a0\u5165\u4f18\u5148\u961f\u5217\u4e2d\u3002\n\n\u6b65\u9aa4\u4e8c\uff08\u4e4b\u540e\u4e00\u76f4\u91cd\u590d\u6b64\u6b65\u9aa4\u76f4\u81f3\u8fbe\u5230\u7b2c $k$ \u5c0f\u5b57\u4e32\uff09\uff1a\u4ece\u4f18\u5148\u961f\u5217\u4e2d\u53d6\u51fa\u5b57\u5178\u5e8f\u6700\u5c0f\u7684\u5b57\u7b26\u4e32\uff0c\u7136\u540e\u5c06\u5176\u52a0\u4e0a\u5176\u540e\u9762\u7684\u5b57\u7b26\uff0c\u653e\u5165\u4f18\u5148\u961f\u5217\u4e2d\uff0c\u8fd9\u6837\u53ef\u4ee5\u7701\u53bb\u5f88\u591a\u7684\u65e0\u7528\u7684\u52a0\u5165\uff0c\u4e0d\u7528\u5c06\u6240\u6709\u7684\u5b57\u4e32\u653e\u5165\u4f18\u5148\u961f\u5217\uff0c\u4e0d\u4f1a $\\texttt{MLE}$\u3002\n\n\u4e0d\u8fc7\u6211\u5374\u9519\u4e86\uff0c\u539f\u56e0\u662f\u5b57\u7b26\u6709\u53ef\u80fd\u91cd\u590d\uff0c\u6240\u4ee5\u4fbf\u9700\u8981\u4e00\u4e2a\u8bb0\u5f55\u4f4d\u7f6e\u7684\u53c2\u6570\u3002\n\n\u7136\u540e\u6211\u5c31\u8fd9\u6837\u53bb\u5199\u4e86\uff0c\u4e0d\u8fc7\u4ee3\u7801\u5728\u7b2c $16$ \u4e2a\u70b9\u8d85\u65f6\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h> //TLE \u4ee3\u7801\nusing namespace std;\ntypedef pair<string,int> psi;\npriority_queue<psi,vector<psi>,greater<psi>> q;\nstring ss;\nint k;\nint main()\n{\n    cin>>ss>>k;\n    for(int i=0;i<ss.length();i++)\n    {\n        string tmp=\"\";\n        tmp+=ss[i];\n        q.push(make_pair(tmp,i));\n    }\n    for(int i=1;i<k;i++)\n    {\n        psi u=q.top();\n        q.pop();\n        if(u.second<ss.length()-1)\n        {\n            string tmp=u.first;\n            tmp+=ss[u.second+1];\n            q.push(make_pair(tmp,u.second+1));\n        }\n        if(q.empty())\n\t\t{\n            printf(\"No such line.\");\n            return 0;\n        }\n    }\n    cout<<q.top().first;\n    return 0;\n}\n```\n\n\u7ecf\u8fc7\u5206\u6790\uff0c\u53d1\u73b0 $\\texttt{TLE}$ \u539f\u56e0\u662f\u6bcf\u6b21\u653e\u5165\u4f18\u5148\u961f\u5217\u7684\u90fd\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\u52a0\u4e0b\u6807\uff0c\u5176\u5b9e\u5b8c\u5168\u6ca1\u5fc5\u8981\u8fd9\u6837\u3002\n\n\u4e8e\u662f\uff0c\u6211\u5c06\u53c2\u6570\u6539\u6210\u4e86\u53ea\u8bb0\u5f55\u5f00\u59cb\u4f4d\u7f6e\u548c\u7ed3\u675f\u4f4d\u7f6e\u7684\u4e24\u4e2a $\\texttt{int}$ \u503c\uff0c\u7136\u540e\u5c31\u5bf9\u4e86\u3002\n\n\u5f53\u7136\u8fd9\u6837\u5c31\u9700\u8981\u91cd\u8f7d\u8fd0\u7b97\u7b26\u4e86\u3002\n\n\u4ee5\u4e0b\u662f\u5b8c\u6574\u4ee3\u7801\uff08\u6bd4\u540e\u7f00\u81ea\u52a8\u673a\u662f\u4e0d\u662f\u597d\u4e9b\u5f88\u591a\uff09\uff1a\n\n```cpp\n#include<bits/stdc++.h> //AK \u4ee3\u7801\nusing namespace std;\nstring ss;\nstruct Substring\n{\n    int l,r;\n    Substring(int l,int r):l(l),r(r){}\n    Substring(){}\n    bool operator<(const Substring &y)//>\n    const\n    {\n        for(int k=0;k<=r-l;k++)\n        {\n            int i=l+k,j=y.l+k;\n            if(j>y.r) return 1;\n            if(ss[i]!=ss[j]) return ss[i]>ss[j];\n        }\n        return 0;\n    }\n};\npriority_queue<Substring> q;\nint k;\nint main()\n{\n    cin>>ss>>k;\n    for(int i=0;i<ss.length();i++)\n    {\n        q.push(Substring(i,i));\n    }\n    for(int i=1;i<k;i++)\n    {\n        Substring u=q.top();\n        q.pop();\n        if(u.r<ss.length()-1)\n        {\n            ++u.r;\n            q.push(u);\n        }\n        if(q.empty())\n     \t{\n            printf(\"No such line.\");\n            return 0;\n        }\n    }\n    for(int i=q.top().l;i<=q.top().r;i++) printf(\"%c\",ss[i]);\n    return 0;\n}\n```\n\n#### \u9e23\u8c22\uff1a\n\n[$\\color{black} \\texttt{\u5434\u96e8\u822a323}$](https://www.luogu.com.cn/user/378693)",
        "postTime": 1639814711,
        "uid": 326452,
        "name": "Fearliciz",
        "ccfLevel": 0,
        "title": "CF128B String"
    },
    {
        "content": "\u636e\u8bf4\u8fd9\u9898\u6b63\u89e3\u662f SAM\uff1f\u4f46\u662f\u6211\u4e0d\u4f1a\u8fd9\u4e1c\u897f\uff0c\u548b\u529e\uff0c\u6b38\u6709\u4e00\u79cd\u795e\u5947\u7684\u4e71\u641e\u505a\u6cd5\u3002\n\n**\u672c\u9898\u89e3\u4e0d\u80fd\u4fdd\u8bc1\u8be5\u7b97\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u5426\u6b63\u786e\uff0c\u5982\u679c\u6709 dalao \u80fd\u8bc1\u660e\u8bf7\u79c1\u4fe1\u6211\u3002**\n\n\u9996\u5148\u4e00\u4e2a\u975e\u5e38\u660e\u663e\u7684\u8d2a\u5fc3\u60f3\u6cd5\u5c31\u662f\u628a\u9996\u5b57\u6bcd\u4e3a $a$ \u7684\u62ff\u51fa\u6765\uff0c\u7136\u540e\u770b\u770b\u5b83\u80fd\u6784\u6210\u591a\u5c11\u4e2a\u5b50\u4e32\uff0c\u7136\u540e\u5982\u679c $k$ \u5927\u4e8e\u7b49\u4e8e\u5b83\u5219\u610f\u5473\u7740\u9996\u5b57\u6bcd\u4e0d\u662f $a$\uff0c\u7136\u540e\u6362\u4e0b\u4e00\u4e2a\u8dd1\uff0c\u6ce8\u610f\u8fd9\u91cc $k$ \u8981\u51cf\u53bb $a$ \u80fd\u6784\u6210\u7684\u5b50\u4e32\u6570\u91cf\uff0c\u5982\u679c\u627e\u5230\u4e86\u5408\u6cd5\u7684\uff0c\u5c31\u628a\u5b83\u52a0\u8fdb\u7b54\u6848\u91cc\u9762\uff0c\u7136\u540e\u5bf9\u4e8e\u5b83\u540e\u9762\u7684\u4f4d\u7f6e\u90fd\u52a0\u5230\u4e00\u4e2a\u5730\u65b9\u3002\n\n\u5bf9\u4e8e\u5faa\u73af\u5f80\u590d\u8fd9\u6837\u64cd\u4f5c\uff0c\u7136\u540e\u5c31\u5bf9\u4e86\u3002\n\n\u66f4\u52a0\u5177\u4f53\u7684\u5b9e\u73b0\uff0c\u5c31\u662f\u628a\u9700\u8981\u52a0\u7684\u4f4d\u7f6e\u6254\u5230\u4e00\u4e2a vector \u91cc\u9762\uff0c\u6bcf\u6b21\u4ece\u91cc\u9762\u53d6\u51fa\u6570\uff0c\u7136\u540e\u7b97\u4e00\u4e0b\u4ee5\u4ed6\u4e3a\u9996\u5b57\u6bcd\u7ec4\u6210\u7684\u5b50\u4e32\u6709\u591a\u5c11\u4e2a\u3002\n\n\u5982\u679c\u4f60\u5b66\u8fc7\u7c7b\u4f3c\u4e8e\u7ebf\u6bb5\u6811\u4e0a\u4e8c\u5206\u7684\u64cd\u4f5c\uff0c\u8fd9\u4e2a\u5e94\u8be5\u4e0d\u96be\u7406\u89e3\u3002\n\n\u4f46\u662f\u4ee4\u4eba\u65e0\u6cd5\u7406\u89e3\u7684\u662f\uff0c\u5b83\u7684\u590d\u6742\u5ea6\u5c45\u7136\u975e\u5e38\u7684\u5947\u602a\uff0c\u800c\u4e14\u5728\u6570\u636e\u4e0b\u8fd8\u8dd1\u7684\u98de\u5feb\u3002\n\n\u53e6\u5916\uff0c\u5bf9\u4e8e\u9898\u89e3\u533a\u6709\u51e0\u79cd priority_queue \u548c set \u4e71\u641e\u641e\u8fc7\u6389\u7684\uff0c\u6211\u8ba4\u4e3a\u4ed6\u4eec\u7684\u590d\u6742\u5ea6\u90fd\u6709\u95ee\u9898\uff0c\u56e0\u4e3a\u5185\u90e8\u4ed6\u4eec\u9700\u8981 $O(len)$ \u7684\u590d\u6742\u5ea6\u53bb\u6bd4\u8f83\u3002\n\n\u80fd\u8fc7\u7eaf\u5c5e\u662f\u8fdc\u53e4\u9898\u7684\u539f\u56e0\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <vector>\n#define pb push_back\nusing namespace std;\nvector <int> v,x[35];\nstring s1,ans;\nint k;\nsigned main()\n{\n\tios::sync_with_stdio(false);\n\tcin>>s1>>k;long long len=s1.size();\n\tif (k>len*(len+1)/2) {cout<<\"No such line.\\n\";return 0;}\n\tfor (int i=0;i<len;i++) v.pb(i);\n\twhile (1) {\n\t\tfor (int i=0;i<26;i++) x[i].clear();\n\t\tint len=v.size();\n\t\tfor (int i=0;i<len;i++) x[s1[v[i]]-'a'].pb(v[i]);\n\t\tfor (int i=0;i<26;i++) {\n\t\t\tif (x[i].size()==0) continue;\n\t\t\tif (k<=x[i].size()) {cout<<(ans+(char)(i+'a'))<<\"\\n\";return 0;}\n\t\t\tk-=x[i].size();\n\t\t\tint sum=0,len=x[i].size();\n\t\t\tfor (int j=0;j<len;j++) \n\t\t\t\tsum+=s1.size()-x[i][j]-1;\n\t\t\tif (sum>=k) {\n\t\t\t\tans+=(char)(i+'a');\n\t\t\t\tv.clear();\n\t\t\t\tfor (int j=0;j<len;j++)\n\t\t\t\t\tif (x[i][j]!=s1.size()-1) \n\t\t\t\t\t\tv.pb(x[i][j]+1);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse k-=sum;\n\t\t}\n//\t\tcout<<k<<\" yiw\\n\";\n\t}\n\t\n\treturn 0;\n}\n```\n",
        "postTime": 1664548322,
        "uid": 208653,
        "name": "_edge_",
        "ccfLevel": 0,
        "title": "CF128B"
    },
    {
        "content": "## CF128B \u9898\u89e3\n\n### \u524d\u8a00\n\n~~\u672c\u4eba\u8ba4\u4e3a\u8fd9\u9898\u6ca1\u90a3\u4e48\u96be\uff0c\u5176\u5b9e\u53ea\u6709 \u666e\u53ca+/\u63d0\u9ad8 \u5de6\u53f3~~\n\n~~\u770b\u5230\u5176\u4ed6\u4eba\u5199\u7684\u9898\u89e3\uff0c\u4ee3\u7801\u957f\u5ea6\u5413\u6b7b\u6211\u4e86\uff0c\u6211\u53ea\u5199\u4e86540B\u5c31\u8fc7\u4e86~~\n\n### \u601d\u8def\n\n\u5f88\u663e\u7136\uff0c\u5982\u679c\u6211\u4eec\u6240\u6709\u7684\u5b57\u4e32\u90fd\u6c42\u51fa\u6765\uff0c\u6392\u5e8f\u540e\u518d\u8f93\u51fa\u7b2c$k$\u4e2a\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4f1a\u662f $O(n^2)$\uff0c\u4f1a\u8d85\u65f6\u3002\u4f46\u662f\uff0c$k$ \u53ea\u6709 $10^5$\uff0c\u6240\u4ee5\u53ef\u4ee5\u679a\u4e3e\u6392\u5728\u524d $k$ \u4e2a\u7684\u5b57\u4e32\u3002\u8981\u679a\u4e3e\u6392\u5728\u524d$k$\u4e2a\u7684\u5b57\u4e32\uff0c\u53ef\u4ee5\u81ea\u7136\u60f3\u5230\uff0c\u8981\u7528 $\\text {priority queue} $\u3002\n\n### \u7a0b\u5e8f\n\n\u7a0b\u5e8f\u5f88\u597d\u5199\uff0c\u53ef\u4ee5\u9996\u5148\u5b9a\u4e49\u4e00\u4e2a $\\text {priority queue} $\uff0c\u5148\u628a\u7ed9\u5b9a\u5b57\u7b26\u4e32\u7684\u6bcf\u4e00\u4e2a\u5b57\u7b26 $\\text {push} $\u8fdb\u53bb\u3002\u7136\u540e\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $\\text {push} $\u8fdb\u53bb\u4e86\u7684\u5b57\u7b26\u4e32\uff0c\u6bcf\u4e00\u6b21\u5ef6\u7533\u4e00\u4f4d\u5c31\u884c\u4e86\u3002\u56e0\u4e3a\u6211\u4eec\u77e5\u9053\u5982\u679c $a$ \u662f $b$ \u7684\u524d\u7f00\uff0c $b$ \u5b57\u5178\u5e8f\u4e00\u5b9a\u6bd4$a$\u5927\uff0c\u6240\u4ee5\u53ef\u4ee5\u786e\u4fdd\u6700\u540e\u5f97\u5230\u7684\u662f\u7b2c $k$ \u5927\u7684\uff0c\u4e0d\u4f1a\u6709\u5b57\u5178\u5e8f\u5927\u7684\u6bd4\u5b57\u5178\u5e8f\u5c0f\u7684\u5148\u51fa\u73b0\u3002\n\n${\\color{LimeGreen}\\colorbox{white}{AC}}$ \u4e86\u7684\u4ee3\u7801\uff1a\n\n```\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define forn(i,a,n) for (int i=a; i<n; i++)\n#define p pair<string,int>\n\npriority_queue<string, vector<p>, greater<p> > q;\nstring s,a;\nint k,b;\n\nint main(){\n    cin>>s>>k;\n\tlong long n=s.size();\n\tif (k>n*(n+1)/2)\n\t\treturn cout<<\"No such line.\"<<endl,0;\n\tint c=1;\n\tforn(i,0,n) q.push(make_pair((a=s[i]),(i+1)));\n\twhile (c!=k){\n\t\ta=q.top().first;\n\t\tb=q.top().second;\n\t\tq.pop();\n\t\tc++;\n\t\tif (b==n) continue;\n\t\tq.push(p(a+s[b],b+1));\n\t}\n\tcout<<q.top().first<<endl;\n\treturn 0;\n}\n\n```\n\n\u795d\u5927\u5bb6 ${\\color{LimeGreen}\\colorbox{white}{AC}}$ \u6109\u5feb\uff01",
        "postTime": 1639745441,
        "uid": 489890,
        "name": "SFlyer",
        "ccfLevel": 7,
        "title": "CF128B-String \u9898\u89e3"
    },
    {
        "content": "\u9996\u5148\u6709\u4e00\u4e2a\u5f88\u663e\u7136\u7684\u60f3\u6cd5\uff0c\u5806\u3002\u4e0e\u8d85\u7ea7\u94a2\u7434\u548c\u5f02\u6216\u7cbd\u5b50\u7c7b\u4f3c\uff0c\u6bcf\u6b21\u627e\u5230\u6700\u5c0f\u503c\u540e\u5f80\u540e\u5ef6\u7533\u4e00\u4f4d\u3002\u4f46\u662f\u8fd9\u4f1a TLE on Test 16\u3002\n\n\u6240\u4ee5\u53ea\u80fd\u6362\u79cd\u65b9\u6cd5\u3002\u8003\u8651\u540e\u7f00\u6570\u7ec4\uff0c\u6bcf\u4e00\u4e2a\u540e\u7f00\u7684\u6240\u6709\u524d\u7f00\u5c31\u662f\u539f\u4e32\u7684\u6240\u6709\u5b50\u4e32\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u5728\u540e\u7f00\u4e2d\u627e\u524d\u7f00\u5373\u53ef\u3002\n\n\u6c42\u51fa $sa[]$ \u548c $ht[]$ \u540e\uff0c\u540e\u7f00\u90fd\u662f\u6309\u5b57\u5178\u5e8f\u6392\u597d\u7684\uff0c\u6211\u4eec\u5148\u6765\u8003\u8651\u76f8\u90bb\u4e24\u4e2a\u540e\u7f00\u7684\u524d\u7f00\uff0c\u8be5\u5982\u4f55\u6392\u5e8f\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/uujjt4mh.png)\n\n\u7ea2\u8272\u662f\u76f8\u540c\u7684\u90e8\u5206\uff0c\u663e\u7136\u957f\u5ea6\u4e3a $ht$\u3002\u90a3\u4e48\uff0c\u6392\u5e8f\u7684\u987a\u5e8f\u4e00\u5b9a\u662f \u201c\u7ea2$\\times2+$\u7d2b$+$\u7c89\u201d\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u76f8\u540c\u90e8\u5206\u4f18\u5148\uff0c\u5269\u4e0b\u7684\u6309\u987a\u5e8f\u6392\u3002\n\n\u6240\u4ee5\u8fd9\u5c31\u7ed9\u6211\u4eec\u542f\u53d1\u3002\u6211\u4eec\u53ef\u4ee5\u4ece\u524d\u5f80\u540e\u7684\u770b\u540e\u7f00\uff0c\u679a\u4e3e\u524d\u7f00\u7684\u957f\u5ea6\u3002\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u957f\u5ea6\uff0c\u6211\u4eec\u53ef\u4ee5\u4e8c\u5206\u5728\u6c42\u51fa\u5728\u4e4b\u540e\u6709\u591a\u5c11\u76f8\u540c\u7684\u524d\u7f00\uff0c\u6392\u8fdb\u5e8f\u5217\u4e2d\u3002\u53ea\u662f\u8981\u8bb0\u4f4f\u7528\u7ebf\u6bb5\u6811\u66f4\u65b0\u4e00\u4e0b\u540e\u9762\u7684\u540e\u7f00\u7684\u679a\u4e3e\u8d77\u70b9\uff0c\u56e0\u4e3a\u6709\u4e9b\u524d\u7f00\u5df2\u7ecf\u8ddf\u524d\u9762\u76f8\u540c\u7684\u524d\u7f00\u4e00\u5e76\u8ba1\u7b97\u8fc7\u4e86\u3002\n\n\u4e0b\u9762\u662f AC \u4ee3\u7801\u3002\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n#define lson o<<1\n#define rson o<<1|1\n#define mid (l+r>>1)\n\nint n,m,k;\nint sa[100005],ht[100005],rk[100005],rk2[100005];\nint mn[100005][20];\nchar str[100005];\nstruct segtree{\n\tint mx,laz;\n}t[100005<<2];\n\nbool cmp(int i,int j)\n{\n\tif(rk[i]!=rk[j])\n\t\treturn rk[i]<rk[j];\n\tint ri=(i+k<=n ? rk[i+k] : -1);\n\tint rj=(j+k<=n ? rk[j+k] : -1);\n\treturn ri<rj;\n}\n\nvoid getsa(int n,char *str)\n{\n\tfor(int i=1;i<=n;i++)\n\t\tsa[i] = i, rk[i] = str[i];\n\tfor(k=1;k<=n;k*=2)\n\t{\n\t\tsort(sa+1,sa+1+n,cmp);\n\t\trk2[sa[1]] = 1;\n\t\tfor(int i=2;i<=n;i++)\n\t\t\trk2[sa[i]] = rk2[sa[i-1]]+cmp(sa[i-1],sa[i]);\n\t\tfor(int i=1;i<=n;i++)\n\t\t\trk[i] = rk2[i];\n\t}\n}\n\nvoid getht(int n,char *str)\n{\n\tfor(int i=1;i<=n;i++)\n\t\trk[sa[i]] = i;\n\tint h=0;\n\tht[1] = 0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint j=sa[rk[i]-1];\n\t\tif(h>0)\n\t\t\th--;\n\t\tfor(;j+h<=n&&i+h<=n;h++)\n\t\t\tif(str[j+h]!=str[i+h])\n\t\t\t\tbreak;\n\t\tht[rk[i]] = h;\n\t}\n}\n\nvoid pushdown(int o)\n{\n\tif(t[o].laz)\n\t{\n\t\tt[lson].mx = t[lson].laz = t[o].laz;\n\t\tt[rson].mx = t[rson].laz = t[o].laz;\n\t}\n\tt[o].laz = 0;\n}\n\nvoid modify(int o,int l,int r,int ql,int qr,int v)\n{\n\tif(l>=ql && r<=qr)\n\t{\n\t\tt[o].mx = t[o].laz = v;\n\t\treturn;\n\t}\n\tpushdown(o);\n\tif(ql<=mid)\n\t\tmodify(lson,l,mid,ql,qr,v);\n\tif(qr>mid)\n\t\tmodify(rson,mid+1,r,ql,qr,v);\n}\n\nint query(int o,int l,int r,int x)\n{\n\tif(l==x && r==x)\n\t\treturn t[o].mx;\n\tpushdown(o);\n\tif(x<=mid)\n\t\treturn query(lson,l,mid,x);\n\telse\n\t\treturn query(rson,mid+1,r,x);\n}\n\nint ask(int l,int r)\n{\n\tint k=log2(r-l+1);\n\treturn min(mn[l][k],mn[r-(1<<k)+1][k]);\n}\n\nint getp(int lef,int rht,int lim)\n{\n\tint l=lef,r=rht,pos=lef-1;\n\twhile(l<=r)\n\t{\n\t\tif(ask(lef,mid)>=lim)\n\t\t\tpos = mid, l = mid+1;\n\t\telse\n\t\t\tr = mid-1;\n\t}\n\treturn pos;\n}\n\nvoid print(int st,int len)\n{\n\tfor(int i=st;i<=st+len-1;i++)\n\t\tcout<<str[i];\n\tputs(\"\");\n}\n\nsigned main()\n{\n\tscanf(\"%s%lld\",str+1,&m);\n\tn = strlen(str+1);\n\tif(m>n*(n+1)/2)\n\t\treturn puts(\"No such line.\"), 0;\n\tgetsa(n,str), getht(n,str);\n\tfor(int i=1;i<=n;i++)\n\t\tmn[i][0] = ht[i];\n\tfor(int j=1;j<20;j++)\n\t\tfor(int i=1;i+(1<<j-1)<=n;i++)\n\t\t\tmn[i][j] = min(mn[i][j-1],mn[i+(1<<j-1)][j-1]);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint st=sa[i],len=n-sa[i]+1,bot=query(1,1,n,i);\n\t\tfor(int j=bot+1;j<=len;j++)\n\t\t{\n\t\t\tif(j<=ht[i+1])\n\t\t\t{\n\t\t\t\tint p=getp(i+1,n,j);\n\t\t\t\tint cnt=p-i+1;\n\t\t\t\tmodify(1,1,n,i,p,j);\n\t\t\t\tif(m<=cnt)\n\t\t\t\t\treturn print(sa[i],j), 0;\n\t\t\t\tm -= cnt;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tm--;\n\t\t\t\tif(m==0)\n\t\t\t\t\treturn print(sa[i],j), 0;\n\t\t\t}\n\t\t}\n\t}\n\t\n\treturn 0;\n}\n```\n\n\u795d\u5927\u5bb6 AC \u6109\u5feb\uff01",
        "postTime": 1624868102,
        "uid": 123298,
        "name": "kouylty",
        "ccfLevel": 7,
        "title": "\u9898\u89e3\u3010CF128B string\u3011"
    },
    {
        "content": "### \u9898\u76ee\u5206\u6790\uff1a\n\n\u9996\u5148\uff0c[\u539f\u9898](https://www.luogu.com.cn/problem/P3975)\u3002\n\n\u505a\u6cd5\u7c7b\u4f3c\uff0c\u6211\u4eec\u5efa\u4e00\u68f5 SAM\uff0c\u6211\u4eec\u53ef\u4ee5\u8bb0\u5f55\u6bcf\u4e2a\u7ed3\u70b9\u53ef\u4ee5\u8fbe\u5230\u591a\u5c11\u7684\u5b50\u4e32\uff0c\u4e5f\u8bb0\u5f55\u6bcf\u4e2a\u7ed3\u70b9\u51fa\u73b0\u591a\u5c11\u6b21\u3002\u663e\u7136\uff0c\u5728\u6bcf\u6b21\u9012\u5f52\u65f6\uff0c\u6211\u4eec\u4ece `a` \u4e00\u76f4\u679a\u4e3e\u5230 `z`\uff0c\u6bcf\u6b21\u51cf\u6389\u5b50\u4e32\u6570\uff0c\u76f4\u5230\u5bf9\u4e8e $x$ \u53f7\u8282\u70b9\u80fd\u591f\u5230\u8fbe\u7684\u5b50\u4e32\u6570\u8981\u5927\u4e8e\u7b49\u4e8e\u5269\u4e0b\u7684 $k$\u3002\n\n\u4ee3\u7801\u662f\u4ece\u90a3\u4e2a\u539f\u9898\u90a3\u91cc\u590d\u5236\u8fc7\u6765\u7684\uff0c\u6ca1\u7528\u7684\u90e8\u5206\u6211\u6ce8\u91ca\u6216\u5220\u9664\u4e86\u3002\n\n### \u4ee3\u7801\u5982\u4e0b\uff1a\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1e6+10;\ntypedef long long ll;\nll f[N],tr[N][26],len[N];\nll cnt[N];\nint tot=1,P1=1;\nll sum[N],to[N],lar[N];\nint opt;\nchar c[N];\nvoid SAM(int c){\n\tint P2=P1;P1=++tot;\n\tlen[P1]=len[P2]+1;cnt[P1]=1;\n\tint wh;\n\tfor(;P2&&!tr[P2][c];P2=f[P2])tr[P2][c]=P1;\n\tif(!P2){f[P1]=1;return;}\n\tint P3=tr[P2][c];\n\tif(len[P3]==len[P2]+1){f[P1]=P3;return;}\n\tint P4=++tot;len[P4]=len[P2]+1;\n\tf[P4]=f[P3];f[P3]=P4;f[P1]=P4;\n\tfor(;P2&&tr[P2][c]==P3;P2=f[P2])tr[P2][c]=P4;\n\tmemcpy(tr[P4],tr[P3],sizeof(tr[P3]));\n}void topu(){\n\tfor(int i=1;i<=tot;i++) sum[len[i]]++;\n\tfor(int i=1;i<=tot;i++) sum[i]+=sum[i-1];\n\tfor(int i=1;i<=tot;i++) to[sum[len[i]]--]=i;\n\tfor(int i=tot;i;i--) cnt[f[to[i]]]+=cnt[to[i]];\n\tfor(int i=1;i<=tot;i++){\n\t\tif(opt) lar[i]=cnt[i];\n\t//\tlar[i]=cnt[i]=1;\n\t}cnt[1]=lar[1]=0;\n\tfor(int i=tot;i;i--)\n\t\tfor(int j=0;j<26;j++)\n\t\t\tlar[to[i]]+=lar[tr[to[i]][j]];\n}void dfs(int x,int y){\n\tif(y<=cnt[x]) return;;\n\ty-=cnt[x];\n\tfor(int i=0;i<26;i++)\n\t\tif(tr[x][i]){\n\t\t\tif(y>lar[tr[x][i]]) y-=lar[tr[x][i]];\n\t\t\telse{putchar('a'+i);return dfs(tr[x][i],y);}}\n}int main(){\n\tint wh;\n\tscanf(\"%s%d\",c+1,&wh);int n=strlen(c+1);opt=1;\n\tfor(int i=1;i<=n;i++) SAM(c[i]-'a');topu();\n\tif(lar[1]>=wh) dfs(1,wh);\n\telse puts(\"No such line.\");\n\treturn 0;\n}\n\n```\n",
        "postTime": 1681995008,
        "uid": 511271,
        "name": "\u30c0\u6708",
        "ccfLevel": 5,
        "title": "String"
    }
]
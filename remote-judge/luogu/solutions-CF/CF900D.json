[
    {
        "content": "[$$\\Large\\texttt{My Blog}$$](https://hydingsy.github.io/articles/problem-Codeforces-900D-Unusual-Sequences/)\n\n---\n\n## Description\n\n> \u9898\u76ee\u94fe\u63a5\uff1a[Codeforces 900D](https://codeforces.com/contest/900/problem/D)\n\n\u6c42\u6ee1\u8db3\u4e0b\u9762\u4e24\u4e2a\u6761\u4ef6\u7684\u6570\u5217 $a_1,a_2,\\dots,a_n(1\\le a_i)$ \u7684\u4e2a\u6570\uff08\u7b54\u6848\u5bf9 $10^9+7$ \u53d6\u6a21\uff09\uff1a\n\n1. $\\gcd(a_1,a_2,\\dots,a_n)=x$\n2. $\\sum_{i=1}^n a_i=y$\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\le x.y\\le 10^9$\n\n------\n\n## Solution\n\n\u5982\u679c\u5728 $x\\nmid y$ \u7684\u60c5\u51b5\u4e0b\uff0c\u663e\u7136\u65e0\u89e3\u3002\n\n\u6211\u4eec\u4ee4 $m=\\frac{y}{x}$\uff0c\u90a3\u4e48\u95ee\u9898\u8f6c\u5316\u4e3a\uff1a\u6c42\u6ee1\u8db3 $\\gcd(a_1,a_2,\\dots,a_n)=1$ \u4e14 $\\sum_{i=1}^n a_i=m$ \u7684\u6570\u5217\u4e2a\u6570\u3002\n\n\u6211\u4eec\u5148\u4e0d\u8003\u8651 $\\gcd=1$ \u7684\u9650\u5236\uff0c\u8bbe $g(x)$ \u8868\u793a $\\sum_{i=1}^n a_i=x$ \u7684\u6570\u5217\u4e2a\u6570\u3002\n\n\u5bf9\u4e8e $g(x)$ \u7684\u503c\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528**\u9694\u677f\u6cd5**\u6c42\u89e3\uff1a\n$$g(x)=\\sum_{i=1}^x \\binom{x-1}{i-1}=2^{x-1}$$\n\u6211\u4eec\u53d1\u73b0\uff0c$g(x)$ \u7684\u503c\u53c8\u53ef\u4ee5\u901a\u8fc7 $f(x)$ \u6c42\u5f97\uff1a\n$$g(x)=\\sum_{d\\mid x} f(d)$$\n\u63a5\u4e0b\u6765\u4ecb\u7ecd\u4e24\u79cd\u505a\u6cd5\uff1a\n\n### \u9012\u63a8\n\n\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5bb9\u65a5\u539f\u7406\uff1a**\u6240\u6709\u5e8f\u5217\u6570\u91cf**\u51cf\u53bb**\u4e0d\u5408\u6cd5\u7684\u5e8f\u5217\u6570\u91cf**\u3002\u6211\u4eec\u679a\u4e3e\u4e0d\u5408\u6cd5\u7684\u5e8f\u5217\u7684 $\\gcd$ \u8bb0\u4e3a $d$\uff0c\u663e\u7136 $d$ \u5fc5\u987b\u6ee1\u8db3 $d\\mid x,d>1$\uff0c\u8fd9\u6837\u7684\u5e8f\u5217\u6570\u91cf\u4e3a $f\\left(\\frac{x}{d}\\right)$\uff08\u5f53\u7136\u4e5f\u53ef\u4ee5\u901a\u8fc7 $g$ \u548c $f$ \u7684\u5173\u7cfb\u5f97\u5230\uff09\u3002\n$$\\begin{aligned}f(x)&=g(x)-\\sum_{d\\mid x,d>1} f\\left(\\frac{x}{d}\\right) \\\\&=2^{x-1}-\\sum_{d\\mid x,d>1} f\\left(\\frac{x}{d}\\right)\\end{aligned}$$\n\u7531\u4e8e\u4e00\u4e2a\u6570\u7684\u56e0\u5b50\u7684\u56e0\u5b50\u4e5f\u4e00\u5b9a\u662f\u8fd9\u4e2a\u6570\u7684\u56e0\u5b50\uff0c\u6240\u4ee5\u6211\u4eec\u53d1\u73b0\u9700\u8981\u7684 $x$ \u4e3a $d(m)$ \u4e2a\uff0c\u5373\u4e0d\u8d85\u8fc7 $O(\\sqrt m)$ \u4e2a\uff0c\u53ef\u4ee5\u76f4\u63a5\u9012\u5f52\u6c42\u89e3\u3002\n\n**\u65f6\u95f4\u590d\u6742\u5ea6**\uff1a$O(d(m)\\sqrt m\\log m)$\n\n### \u53cd\u6f14\n\n\u6211\u4eec\u53d1\u73b0\uff1a\n$$g(x)=\\sum_{d\\mid x} f(d)$$\n\u8fd9\u4e2a\u5f0f\u5b50\u7684\u672c\u8d28\u662f $g=f\\ast 1$\uff0c\u901a\u8fc7**\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14**\u53ef\u4ee5\u5f97\u5230\uff1a\n$$f(x)=\\sum_{d\\mid x} \\mu\\left(\\frac{x}{d}\\right)g(d)$$\n\u8fd9\u6837\u4e00\u6765\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u66b4\u529b\u6c42\u89e3\u4e86\u3002\n\n**\u65f6\u95f4\u590d\u6742\u5ea6**\uff1a$O\\left(\\frac{m}{\\log m}\\right)$\n\n------\n\n## Code\n\n### \u9012\u63a8\n\n```cpp\n#include <cstdio>\n#include <map>\n\nconst int mod=1e9+7;\nstd::map<int,int> mp;\n\nint pow(int x,int p) {\n\tint ret=1;\n\tfor(;p;p>>=1,x=1LL*x*x%mod) if(p&1) ret=1LL*ret*x%mod;\n\treturn ret;\n}\nvoid upd(int &x,int y) {\n\t(x+=y)>=mod&&(x-=mod);\n}\nint solve(int n) {\n\tif(n==1) return 1;\n\tif(mp.count(n)) return mp[n];\n\tint ans=0;\n\tfor(int i=2;i*i<=n;++i) {\n\t\tif(n%i==0) {\n\t\t\tupd(ans,solve(i));\n\t\t\tif(i*i!=n) upd(ans,solve(n/i));\n\t\t}\n\t}\n\tupd(ans,solve(1));\n\tans=(pow(2,n-1)-ans+mod)%mod;\n\treturn mp[n]=ans;\n}\nint main() {\n\tint x,y;\n\tscanf(\"%d%d\",&x,&y);\n\tif(y%x) return puts(\"0\"),0;\n\tprintf(\"%d\\n\",solve(y/x));\n\treturn 0;\n}\n```\n\n### \u53cd\u6f14\n\n```cpp\n#include <cstdio>\n\nconst int N=1e5+5;\nconst int mod=1e9+7;\nint x,y,tot,p[N];\nbool flg[N];\n\nvoid sieve(int n) {\n\tfor(int i=2;i<=n;++i) {\n\t\tif(!flg[i]) p[++tot]=i;\n\t\tfor(int j=1;j<=tot&&i*p[j]<=n;++j) {\n\t\t\tflg[i*p[j]]=1;\n\t\t\tif(i%p[j]==0) break;\n\t\t}\n\t}\n}\nint mu(int n) {\n\tint cnt=0;\n\tfor(int i=1;i<=tot&&1LL*p[i]*p[i]<=n;++i) {\n\t\tif(n%p[i]) continue;\n\t\tint now=0;\n\t\twhile(n%p[i]==0) n/=p[i],++now;\n\t\tif(now>1) return 0;\n\t\t++cnt;\n\t}\n\tif(n>1) ++cnt;\n\treturn cnt%2==0?1:mod-1;\n}\nint pow(int x,int p) {\n\tint ret=1;\n\tfor(;p;p>>=1,x=1LL*x*x%mod) if(p&1) ret=1LL*ret*x%mod;\n\treturn ret;\n}\nvoid upd(int &x,int y) {\n\t(x+=y)>=mod&&(x-=mod);\n}\nint main() {\n\tsieve(N-5);\n\tscanf(\"%d%d\",&x,&y);\n\tif(y%x) return puts(\"0\"),0;\n\tint n=y/x,ans=0;\n\tfor(int i=1;1LL*i*i<=n;++i) {\n\t\tif(n%i==0) {\n\t\t\tupd(ans,1LL*mu(n/i)*pow(2,i-1)%mod);\n\t\t\tif(i*i!=n) upd(ans,1LL*mu(i)*pow(2,n/i-1)%mod);\n\t\t}\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1549593762,
        "uid": 49725,
        "name": "Siyuan",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF900D \u3010Unusual Sequences\u3011"
    },
    {
        "content": "[blog](https://big-news.cn/2020/07/08/%E3%80%90%E9%A2%98%E8%A7%A3%E3%80%91Unusual%20Sequences/)\n\n\u63d0\u4f9b\u4e00\u4e2a\u4e0d\u4f7f\u7528\u53cd\u6f14\u7684\u6e05\u5947\u601d\u8def\u3002\n\n\u8bbe $f(s,g)$ \u8868\u793a\u548c\u4e3a $s$ ,gcd\u4e3a $g$ \u7684\u6570\u5217\u7684\u6570\u91cf\uff0c\u5bb9\u6613\u53d1\u73b0\u4ee5\u4e0b\u6027\u8d28\uff1a\n\n$$ f(s,g)=0, \\text{ }g\\nmid s $$\n$$ f(s,g)=f(s/g,1), \\text{ } g|s $$\n\n\u6211\u4eec\u77e5\u9053\u548c\u4e3a $s$ \u7684\u6570\u5217\u5e94\u5f53\u6709 $2^{s - 1}$ \u4e2a\uff0c\u5373\u628a $s$ \u770b\u6210 $s$ \u4e2a1\uff0c\u7136\u540e\u63d2\u4e0a $s - 1$ \u4e2a\u9694\u677f\u3002\u90a3\u4e48\u6709\uff1a\n\n$$\\begin{aligned} 2^{s - 1} &= \\sum\\limits_{g=1}^s f(s,g)\n\\\\ &=\\sum\\limits_{g | s}f(s,g)\n\\\\ &=\\sum\\limits_{g | s}f(s/g,1)\n\\end{aligned}$$\n\n\u79fb\u4e00\u4e0b\u9879\uff0c\u5f97\u5230\uff1a\n$$ f(s,1)=2^{s - 1}-\\sum\\limits_{g|s,g>1}f(s / g,1) $$\n\n\u8bbe $f[s]$ \u8868\u793a $f(s, 1)$ \uff0c\u5f97\u5230\u9012\u63a8\u65b9\u7a0b\uff1a\n$$ f[s] =  2^{s - 1}-\\sum\\limits_{g|s,g>1}f[s/g]$$\n\n\u76f4\u63a5\u505a\u662f $O(n\\log n)$ \u7684\uff0c\u4f46\u662f\u5bb9\u6613\u77e5\u9053\u6709\u4e9b\u4f4d\u7f6e\u7684\u503c\u662f\u7528\u4e0d\u5230\u7684\u3002\u5f00\u4e00\u4e2a `map` \u50a8\u5b58 $f[]$ \u6570\u7ec4\uff0c\u5927\u529b\u9012\u63a8\u8ba1\u7b97\uff0c\u53c2\u8003\u675c\u6559\u7b5b\u7684\u590d\u6742\u5ea6\uff0c\u5927\u7ea6\u662f $O(n^{\\frac{3}{4}})$\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u8dd1\u5f97\u51fa\u5947\u7684\u5feb\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<string>\n#include<map>\nusing namespace std;\n\n#define LL long long\nconst int P = 1e9+7;\n\nint x,y;\n\nint qp(int a,int b){\n    int r = 1;\n    while(b){\n        if(b & 1) r = (1ll * a * r) % P;\n        a = (1ll * a * a) % P; b >>= 1;\n    }\n    return r;\n}\nmap<int, int> f;\nint dfs(int s){\n    if(s == 1) return 1;\n    if(f.count(s)) return f[s];\n    int r = qp(2, s - 1);\n    for(int g = 2;g * g <= s;g++){\n        if(s % g) continue;\n        if(g * g == s) r = (r - dfs(g) + P) % P;\n        else r = ((r - dfs(s / g) - dfs(g)) % P + P) % P;\n    }\n    return f[s] = (r - 1 + P) % P;\n}\n\nint main()\n{\n    // freopen(\"_in.in\", \"r\", stdin);\n\n    scanf(\"%d%d\", &x, &y);\n    if(y % x) puts(\"0\");\n    else printf(\"%d\", dfs(y / x));\n}\n```",
        "postTime": 1594218873,
        "uid": 70177,
        "name": "big_news",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF900D \u3010Unusual Sequences\u3011"
    },
    {
        "content": "\u95ee\u591a\u5c11\u4e2a\u5e8f\u5217 $sum = x$  $gcd = y$\n\n\u663e\u7136\u5982\u679c $x$ \u4e0d\u662f $y$ \u7684\u500d\u6570\u5c31\u662f 0 \u4e86\u3002\n\n\u7136\u540e $sum = x/y$, $gcd = 1$ \u5c31\u51fa\u6765\u4e86\u3002\n\n\u9694\u677f\u6cd5\u53ef\u4ee5\u6c42\u51fa\u6765\u6709\u591a\u5c11\u79cd\u65b9\u6848\u6570 $sum = x/y$\u3002\n\n$g_{sum} = 2^{sum} - 1$\n\n\u8fd9\u4e2a\u91cc\u9762\u4f1a\u6709 $gcd > 1$ \u7684\u60c5\u51b5\u3002\n\n\u8bbe $f_{sum}$ \u662f $gcd = 1$ \u7684\u65b9\u6848\u6570\u3002\n\n\u90a3\u4e48\u5176\u5b9e $g_x = \\sum_{d|x} f_x$\n\n\u6839\u636e\u53cd\u6f14\u3002\n\n$f_x = \\sum_{d|x} g(\\frac{x}{d}) \\mu_d$\n\n\u5c31\u505a\u5b8c\u4e86\u3002",
        "postTime": 1598507519,
        "uid": 96580,
        "name": "SXNhdW5veWE",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF900D \u3010Unusual Sequences\u3011"
    },
    {
        "content": "\u770b\u4e86\u4e0b\u9762\u90a3\u4e48\u591a $dalao$ \u7684\u9ad8\u7aef\u6570\u5b66\u65b9\u6cd5\uff0c\u849f\u84bb\u51b3\u5b9a\u8d21\u732e\u4e00\u79cd\u7b80\u5355\u6613\u884c\u7684\u65b9\u6cd5\uff1a\n\n\u6211\u4eec\u5148\u6765\u8003\u8651\u8fd9\u4e2a\u95ee\u9898\u7684**\u9000\u5316\u7248**\uff1a\u7ed9\u5b9a\u4f60\u4e00\u4e2a\u603b\u548c\u4e3a $y$ \u7684\u6570\u5217\uff0c\u95ee\u4f60\u628a\u5b83\u5206\u5272\u6210 $gcd$ \u4e3a $x$ \u7684\u500d\u6570\u6709\u591a\u5c11\u79cd\u4e0d\u540c\u7684\u65b9\u6cd5\u3002\n\n\u8fd9\u4e2a\u505a\u6cd5\u662f\u5f88\u660e\u663e\u7684\uff1a\u9694\u677f\u6cd5\u3002\u76f8\u5f53\u4e8e\u4e00\u5171\u6709 $y$ \u4e2a\u6570\uff0c\u6bcf $x$ \u4e2a\u53ef\u4ee5\u63d2\u4e00\u4e2a\u677f\uff0c\u603b\u65b9\u6cd5\u6570\u5f53\u7136\u5c31\u662f $2^{y/x-1}-1$ \u3002\n\n\u73b0\u5728\u8ba9\u6211\u4eec\u56de\u5f52\u539f\u6765\u7684\u95ee\u9898\uff1a$gcd$ \u4e3a $x$ \u548c $gcd$ \u4e3a $x$ \u7684\u500d\u6570\u5230\u5e95\u6709\u4ec0\u4e48\u533a\u522b\u5462\uff1f\u663e\u7136\u524d\u8005\u7684\u7b54\u6848\u7b49\u4e8e $gcd$ \u4e3a $x$ \u7684\u500d\u6570\u7684\u7b54\u6848\u51cf\u53bb $gcd$ \u4e3a $x$ \u7684 $2$\u500d\u3001$3$ \u500d\u2026 $n$ \u500d\u7684\u7b54\u6848\u3002\n\n\u7b49\u7b49\uff0c\u8fd9\u4e0d\u5c31\u662f\u4e00\u4e2a\u5bb9\u65a5\u5417\uff1f\u63a8\u5230\u8fd9\u91cc\uff0c\u6b63\u89e3\u7684\u505a\u6cd5\u5c31\u547c\u4e4b\u6b32\u51fa\u4e86\uff1a\u679a\u4e3e $y\\div x$ \u7684\u6240\u6709\u8d28\u56e0\u5b50\u7ec4\u5408\uff0c\u7136\u540e\u6839\u636e\u6240\u542b\u7684\u56e0\u5b50\u6570\u91cf\u51b3\u5b9a\u662f\u52a0\u4e0a\u8fd8\u662f\u51cf\u53bb\uff0c\u6700\u540e\u7edf\u8ba1\u7b54\u6848\u5373\u53ef\u3002\n\n\u7ec6\u8282\u7684\u8bdd\uff0c\u8c8c\u4f3c\u6ca1\u4ec0\u4e48\uff0c\u6ce8\u610f\u522b\u5199\u6302\u5c31\u884c\u4e86\u5427\uff08\u4e56\u5de7\u3002\u3002\u3002\n\n\u5269\u4e0b\u5c31\u662f\u4ee3\u7801\u4e86\uff1a\n\n```cpp\n#include<vector>\n#include<iostream>\n#define mod 1000000007\nusing namespace std;\nint ans,prime[100005],num[100005],cnt=0;\nvector<int> q,p;\nlong long qpow(long long x,int mi) {\n\tlong long sum=1;\n\twhile(mi) {\n\t\tif(mi&1)\tsum=sum*x%mod;\n\t\tx=x*x%mod,mi>>=1;\n\t}\n\treturn sum;\n}\nvoid shuffle(int N) {\n\tprime[0]=prime[1]=1;\n\tfor(int i=2;i*i<=N;i++)\n\t\tif(prime[i])\n\t\t\tfor(int j=i*2;j*j<=N;j++)\n\t\t\t\tprime[j]=1;\n\tfor(int i=2;i*i<=N;i++)\n\t\tif(!prime[i])\n\t\t\tq.push_back(i);\n}\nint deal(int x)\t//\u4e0d\u8981\u7ba1\u4ed6\n{\n\tint sum=0;\n\tfor(int i=0;i<q.size();i++)\n\t\twhile(x%q[i]==0)\n\t\t\tx/=q[i],sum++;\n\tif(x!=1)\tsum++;\n\treturn (sum%2)?-1:1;\n}\nvoid work(int x)\t//\u627e\u8d28\u56e0\u5b50\n{\n\tfor(int i=0;i<q.size();i++)\n\t\tif(x%q[i]==0) {\n\t\t\tp.push_back(q[i]);\n\t\t\twhile(x%q[i]==0)\n\t\t\t\tx/=q[i];\n\t\t}\n\tif(x!=1)\tp.push_back(x);\n}\nint xx(int x)\t//\u7528\u8d28\u56e0\u5b50\u4e2a\u6570\u51b3\u5b9a\u662f\u52a0\u8fd8\u662f\u51cf\n{\n\tint sum=0,las;\n\tfor(int i=0;i<q.size();i++)\n\t\tif(x%q[i]==0) {\n\t\t\tsum++,las=q[i];\n\t\t\twhile(x%q[i]==0)\n\t\t\t\tx/=q[i];\n\t\t}\n\tif(x!=1)\tsum++;\n\treturn sum==1?las:-1;\n}\nvoid dfs(int now,int x,int y)\t//dfs \u679a\u4e3e\u8d28\u56e0\u5b50\u7ec4\u5408\n{\n\tif(now==p.size()) {\n\t\tint sum=x;\n\t\tfor(int i=1;i<=cnt;i++)\n\t\t\tsum*=num[i];\n\t\tint k=deal(sum/x);\n\t\tans=(ans+k*(qpow(2,(y/sum-1))-1)+mod)%mod;\n\t\treturn;\n\t}\n\tnum[++cnt]=p[now];\n\tdfs(now+1,x,y);\n\tnum[cnt--]=0;\n\tdfs(now+1,x,y);\n}\nint main()\n{\n\tshuffle(1000000000);\n\tint x,y;\n\tcin>>x>>y;\n\tif(y%x!=0) {\n\t\tcout<<0;\n\t\treturn 0;\n\t}\n\telse if(y==2*x || y==x) {\n\t\tcout<<1;\n\t\treturn 0;\n\t}\n\tint gg=xx(y);\n\tif(gg!=-1 && x==1) { //\u7279\u5224\u8981\u6ce8\u610f\n\t\tans=(ans+(qpow(2,y/x-1)-1)+mod)%mod;\n\t\tans=(ans-(qpow(2,y/gg-1)-1)+mod)%mod;\n\t\tcout<<ans;\n\t\treturn 0;\n\t}\n\tif(y/x<=1e6) { //\u4e0d\u7528\u7ba1\u8fd9\u4e2a if\n\t\tfor(int i=x;i*2<=y;i+=x)\n\t\t{\n\t\t\tif(y%i==0)\n\t\t\t{\n\t\t\t\tint k=deal(i/x);\n\t\t\t\tans=(ans+k*(qpow(2,(y/i-1))-1)+mod)%mod;\n\t\t\t}\n\t\t}\n\t}\n\telse {\t//\u8fd9\u624d\u662f\u6b63\u513f\u516b\u7ecf\u7684\u5bb9\u65a5\u505a\u6cd5\n\t\tint now=y/x;\n\t\twork(now);\n\t\tdfs(0,x,y);\n\t}\n\tcout<<ans;\n\treturn 0;\n}\n```\n\n",
        "postTime": 1563842828,
        "uid": 41262,
        "name": "SSHhh",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF900D \u3010Unusual Sequences\u3011"
    },
    {
        "content": "# \u9898\u89e3 CF900D \u3010Unusual Sequences\u3011\n\u53ef\u4ee5\u53d1\u73b0\u5982\u679c$x$\u4e0d\u6574\u9664$y$\u90a3\u4e48\u80af\u5b9a\u65e0\u89e3\n\n\u4e0d\u7136\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5176\u5b9e\u6c42\u7684\u5c31\u662f\u548c\u4e3a$y/x$\u4e14$gcd(a_1,a_2,\\cdots,a_n)=1$\u7684\u5e8f\u5217\u4e2a\u6570\n\n\u5bb9\u6613\u53d1\u73b0\u6240\u6709\u548c\u4e3a$y$\u7684\u5e8f\u5217\u4e2a\u6570\u4e3a$2^{n-1}$\n\n\u800c\u6240\u6709$gcd$\u4e0d\u4e3a$1$\u7684\u5e8f\u5217\uff0c\u628a\u6bcf\u4e2a\u6570\u9664\u4ee5$gcd$,\u5c31\u53c8\u56de\u5230\u539f\u9898\u4e86\n\n\u6240\u4ee5\u679a\u4e3e\u6bcf\u4e2a\u53ef\u80fd\u7684$gcd$(\u7ea6\u6570)\uff0c\u9012\u5f52\u8ba1\u7b97\u5373\u53ef\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\nconst ll mod = 1e9 + 7;\nstd::map<int, int> m;\nstd::vector<int> v, vec;\nint fast_pow(ll a, ll n)\n{\n    int ret = 1;\n    while (n)\n    {\n        if (n & 1)\n            ret = (1ll * ret * a) % mod;\n        a = (1ll * a * a) % mod;\n        n >>= 1;\n    }\n    return ret;\n}\nint solve(int x)\n{\n    if (m[x])\n        return m[x];\n    if (x == 1)\n    {\n        m[x] = 1;\n        return x;\n    }\n    int sum = 0;\n    int s = sqrt(x);\n    for (int i = 1; i <= s; i++)\n    {\n        if (x % i == 0)\n        {\n            if (i == 1 || i * i == x)\n                sum = (sum + solve(i)) % mod;\n            else\n                sum = (sum + solve(i) % mod + solve(x / i) % mod) % mod;\n        }\n    }\n    sum = (fast_pow(2, x - 1) - sum + mod) % mod;\n    m[x] = sum;\n    return sum;\n}\nint main()\n{\n    ll x, y;\n    std::cin >> x >> y;\n    if (y % x != 0)\n        return 0 * printf(\"0\");\n    y /= x;\n    std::cout << solve(y);\n    return 0;\n}\n```",
        "postTime": 1548818228,
        "uid": 61966,
        "name": "little_sun",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF900D \u3010Unusual Sequences\u3011"
    },
    {
        "content": "- [CF900D Unusual Sequences](https://www.luogu.com.cn/problem/CF900D)\n\n\u6570\u8bba\u5957\u8def\u9898\uff0c\u8003\u8651\u9898\u610f\u53ef\u8f6c\u5316\u4e3a\uff1a\n\n> \u6c42\u4e00\u4e2a\u548c\u4e3a $\\frac y x$ \u7684\u5e8f\u5217\uff0c\u4f7f\u5f97\u5176 $\\gcd$ \u4e3a $1$\n\n\u76f8\u5f53\u4e8e\u628a\u6574\u4f53\u9664\u4ee5 $\\gcd$\uff0c\u627e\u5230\u4e00\u4e2a\u66f4\u597d\u5904\u7406\u7b49\u4ef7\u95ee\u9898\u3002\n\n\u5982\u679c\u4e0d\u8003\u8651 $gcd$ \u7684\u9650\u5236\u7684\u8bdd\uff0c\u548c\u4e3a $k$ \u7684\u5e8f\u5217\u5171\u6709 $2^{k-1}$ \u79cd\uff0c\u8bbe\u548c\u4e3a $k$ \u4e14 $\\gcd = 1$ \u5e8f\u5217\u6709 $f(k)$ \u79cd\uff0c\u53d7\u4e0a\u6b65\u8f6c\u5316\u7684\u542f\u53d1\u53ef\u5f97\u5230\u548c\u4e3a $k$ \u4e14 $\\gcd = d$ \u7684\u5e8f\u5217\u6709 $f(\\frac k d)$ \u79cd\uff0c\u4e14 $d$ \u53ea\u80fd\u4e3a $k$ \u7684\u56e0\u6570\uff0c\u5219\u53ef\u4ee5\u5199\u51fa\uff1a\n\n$$\\sum_{d\\mid k} f(\\frac k d) = 2 ^{k - 1}$$\n\n\u8003\u8651\u4e00\u4e2a\u5bb9\u65a5\uff1a\n\n$$f(k) = 2^{k-1} - \\sum_{d\\mid k, d\\neq 1} f(\\frac k d)$$\n\n\u9012\u5f52\u7684\u6c42 $f$ \u5373\u53ef\uff0c\u663e\u7136\u53ea\u6709 $k$ \u7684\u56e0\u6570\u4f1a\u88ab\u8ba1\u7b97\u5230\uff0c\u4e14\u5355\u6b21\u6c42\u548c\u590d\u6742\u5ea6\u662f\u6839\u53f7\u7684\uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u6b63\u786e\u3002\n\n**code**\n \n```cpp\n#include <bits/stdc++.h>\n#define int long long\n#define Add(x, y) x = add(x, y)\n#define Mul(x, y) x = mul(x, y)\n\nstd :: map <int, int> ans;\nint x, y; const int mod = 1e9 + 7;\nint mul(int x, int y) { return x * y % mod; }\nint add(int x, int y) { return (x + y) % mod; }\n\nint qpow(int x, int y) {\n\tint ans = 1;  while(y) {\n\t\tif(y & 1) ans = mul(ans, x);\n\t\tx = mul(x, x), y >>= 1;\n\t} return ans;\n}\n\nint calc(int o) {\n    if(o == 1) return 1;\n    if(ans[o]) return ans[o];\n    int res = calc(1); \n    for(int i = 2; i * i <= o; ++ i) {\n        if(o % i) continue;\n        Add(res, add(calc(i), (i * i != o) * calc(o / i))); \n    } return ans[o] = add(qpow(2, o - 1), -res);\n}\n\nsigned main() {\n    scanf(\"%lld%lld\", &x, &y);\n    if(y % x) return puts(\"0\"); \n    printf(\"%lld\", add(mod, calc(y / x)));\n}\n```\n",
        "postTime": 1661363583,
        "uid": 486187,
        "name": "2000VOLT",
        "ccfLevel": 0,
        "title": "CF900D \u9898\u89e3"
    },
    {
        "content": "### \u9898\u610f\n\n- \u7ed9\u5b9a $x,y$\uff0c\u6ee1\u8db3 $\\sum\\limits_{i=1}^n a_i=y,\\gcd\\left(a_1,a_2,\\dots,a_n\\right)=x,1\\le a_i$ \u7684\u6570\u5217 $\\left\\{a_i\\right\\}$ \u7684\u4e2a\u6570\u3002\n- $1\\le x,y\\le 10^9$\u3002\n\n### \u505a\u6cd5\n\n\n\u5bb9\u6613\u53d1\u73b0\uff0c\u6240\u6709\u7684 $a_i$ \u90fd\u6709\u4e00\u4e2a\u56e0\u6570 $x$\uff0c\u6240\u4ee5\u539f\u95ee\u9898\u7b49\u4ef7\u4e8e\u6c42\u6ee1\u8db3 $\\sum\\limits_{i=1}^n a_i=\\dfrac yx,\\gcd\\left(a_1,a_2,\\dots,a_n\\right)=1$ \u7684\u6570\u5217\u4e2a\u6570\u3002\u4e0d\u59a8\u4ee4 $k=\\dfrac yx$\u3002\n\n\u8fd9\u6837\u6709\u4ec0\u4e48\u597d\u5904\u5462\uff1f$\\gcd$ \u53d8\u6210 $1$ \u4e86\uff01\n\n\u4ee4 $g\\left(x\\right)$ \u8868\u793a $\\gcd\\left(a_1,a_2,\\dots,a_n\\right)=x$ \u7684\u65b9\u6848\u6570\u3002\u6b64\u65f6\u7b54\u6848\u5c31\u662f $g(1)$\u3002\n\u600e\u4e48\u53bb\u7b97 $g$ \u5462\uff1f\n\n\u8003\u8651\u8fd9\u4e2a\u95ee\u9898\u7684\u9000\u5316\u7248\uff1a\u7ed9\u5b9a $x,y$\uff0c\u6ee1\u8db3 $\\sum\\limits_{i=1}^n a_i=y,x\\mid \\gcd\\left(a_1,a_2,\\dots,a_n\\right)$ \u7684\u6570\u5217 $\\left\\{a_i\\right\\}$ \u7684\u4e2a\u6570\u3002\n\n\u76f8\u5f53\u4e8e\u5bf9\u4e8e $1$ \u5230 $y$ \u8fd9\u4e9b\u6570\u5b57\u4e2d\uff0c\u9009\u62e9\u4e00\u4e9b $x$ \u7684\u500d\u6570\u3002\u56e0\u4e3a $1$ \u5230 $y$ \u4e2d\u4e00\u5171\u6709 $\\frac {y}{x}$ \u4e2a\u6570\u662f $x$ \u7684\u500d\u6570\u3002\u90a3\u4e48\u7b54\u6848\u5f88\u663e\u7136\u5c31\u662f $2^{\\frac {y}{x} -1}$\uff08\u81f3\u5c11\u8981\u9009\u4e00\u4e2a\uff09\u3002\n\n\u6211\u4eec\u4ee4 $f(x)$ \u8868\u793a $x\\mid \\gcd\\left(a_1,a_2,\\dots,a_n\\right)$ \u7684\u65b9\u6848\u6570\uff0c\u6839\u636e\u4e0a\u9762\u7684\u95ee\u9898\uff0c\u6211\u4eec\u77e5\u9053 $f(x)=2^{\\frac kx-1}$\u3002\n\n$$f(x)=\\sum_{x\\mid d}g(d)$$\n\n\u4f3c\u4e4e\u53ef\u4ee5\u770b\u51fa\u4e00\u70b9\u53cd\u6f14\u7684\u7aef\u502a\u3002\u6211\u4eec\u53ea\u8981\u7a0d\u5fae\u53d8\u4e00\u53d8\u5c31\u53ef\u4ee5\u3002\n\n\u4ee4 $f'\\left(x\\right)=f\\left(\\dfrac kx\\right),g'\\left(x\\right)=g\\left(\\dfrac kx\\right)$\u3002\n\n\u56e0\u4e3a $x\\mid d \\Longleftrightarrow {\\dfrac kd} \\mid {\\dfrac kx}$\uff0c\u6240\u4ee5 $\\displaystyle f(x)=\\sum_{\\frac kd \\mid \\frac kx}g\\left(\\dfrac {k}{\\frac kd}\\right)$\u3002$d \\gets\\frac kd,x\\gets \\frac kx$\uff0c\u5219\u6709 $f'\\left(x\\right)=\\sum\\limits_{d\\mid x}g'(x)$\u3002\n\n\u6240\u4ee5\n\n$$g'(x)=\\sum_{d\\mid x}\\mu\\left(d\\right)f'\\left(\\dfrac xd\\right)$$\n\n\u7b54\u6848\u5c31\u662f $ g(1)=g'(k)=\\sum\\limits_{d\\mid k}\\mu\\left(d\\right)f'\\left(\\dfrac kd\\right)=\\sum\\limits_{d\\mid k}\\mu(d)f(d)$\u3002\n\n\u6ce8\u610f\uff1a\u8fd9\u91cc C\u3000C\u3000A \u795e\u4ed9\u7684\u9898\u89e3\u6709\u4e00\u70b9\u5c0f\u95ee\u9898\uff0c\u53ea\u6709\u7b97 $g'(k)$ \u65f6 $f'\\left(\\dfrac kd\\right)$ \u624d\u80fd\u8f6c\u5316\u6210 $f\\left(d\\right)$\uff0c\u5176\u4ed6\u65f6\u5019 $f'\\left(\\dfrac xd\\right)$ \u662f\u4e0d\u80fd\u7684\u3002~~\u867d\u7136\u8fd9\u4e0d\u5f71\u54cd\u6700\u7ec8\u7b54\u6848\u3002~~\n\n\u600e\u4e48\u7b97 $g'(k)$\uff1f\n\n\u5148\u5bf9 $k$ \u8fdb\u884c\u6807\u51c6\u5206\u89e3\uff0c $k=p_1^{\\alpha_1}p_2{^{\\alpha_2}}\\cdots p_t^{\\alpha_t}$\u3002\u5f53 $d$ \u5b58\u5728\u5e73\u65b9\u56e0\u5b50\u65f6\uff0c $\\mu(d)=0$\uff0c\u76f4\u63a5\u5bf9 $k$ \u7684\u8d28\u56e0\u6570\u8fdb\u884c dfs \u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6\u5927\u6982\u662f $O\\left(\\sqrt k +\\frac{\\sqrt k}{\\log k}+k^{\\frac 13}\\log k\\right)$\u3002\n\n$O\\left(\\sqrt k\\right)$ \u662f\u7ebf\u6027\u7b5b\uff0c\u5982\u679c\u591a\u6d4b\u7684\u8bdd\uff0c\u5e94\u8be5\u4f1a\u8dd1\u7684\u6bd4\u8f83\u5feb\u4e00\u70b9\u3002\n\n\u5982\u679c\u4e0d\u662f\u591a\u6d4b\uff0c\u4f46 $n$ \u7279\u522b\u5927\uff0c\u53ef\u4ee5\u5c1d\u8bd5 Pollard-Rho\uff0c\u4f46\u662f\u8fd9\u90fd\u4e0d\u662f\u672c\u9898\u7684\u6838\u5fc3\u4e86\u3002\n\n**\u4e0d\u540c\u4e8e\u5176\u4ed6\u83ab\u53cd\u9898\uff0c\u90fd\u662f\u5316\u51fa $\\left[x=1\\right]$ \u518d Mobius inverse \u7684\uff0c\u672c\u9898\u662f\u5728\u4e00\u4e2a\u5927\u5f0f\u5b50\u4e0a\u8fd0\u7528\u4e86\u83ab\u53cd\u7684\u7ed3\u8bba\u3002**\n\n### \u4ee3\u7801\n\n\n```cpp\n#include<bits/stdc++.h>\n#define mod 1000000007\nusing namespace std;\nbitset<31625> used;\nint prime[31625],cnt;\nint p[15],pn;\ninline int read()\n{\n\tint x=0,f=1;char c=getchar();\n\twhile(c<'0'||c>'9'){if(c=='-')f=-f;c=getchar();}\n\twhile(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n\treturn x*f;\n}\ninline void sieve(int n)\n{\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tif(!used[i])\tprime[++cnt]=i;\n\t\tfor(int j=1;j<=cnt&&1ll*i*prime[j]<=n;j++)\n\t\t{\n\t\t\tused[prime[j]*i]=1;\n\t\t\tif(!(i%prime[j]))\tbreak;\n\t\t}\n\t}\n}\ninline int f(int x,int y)\n{\n\tint p=x,res=1;\n\twhile(y)\n\t{\n\t\tif(y&1)\tres=1ll*res*p%mod;\n\t\tp=1ll*p*p%mod;y>>=1;\n\t}\n\treturn res;\n}\ninline int add(int x)\n{\n\treturn x>=mod?x-mod:x;\n}\nint dfs(int u,int mu,int k)\n{\n\tif(!u)\treturn 1ll*mu*f(2,k-1)%mod;\n\treturn add(dfs(u-1,mu,k)+dfs(u-1,mod-mu,k/p[u]));\n}\nint main()\n{\n\tint x=read(),y=read();\n\tif(y%x)\treturn puts(\"0\"),0;\n\ty/=x;\n\tsieve(31623);\n\tint tmp=y;\n\tfor(int i=1;prime[i]*prime[i]<=y;i++)\n\t\tif(!(y%prime[i]))\n\t\t{\n\t\t\tp[++pn]=prime[i];\n\t\t\twhile(!(y%prime[i]))\ty/=prime[i];\n\t\t}\n\tif(y!=1)\tp[++pn]=y;\n\tint ans=dfs(pn,1,tmp);\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1638284189,
        "uid": 181775,
        "name": "_Fontainebleau_",
        "ccfLevel": 0,
        "title": "\u300cCF900D Unusual Sequences\u300d"
    },
    {
        "content": "$$\\Large \\rm [CF900D]Unusual~Sequences$$\n\n$\\quad$\u6613\u77e5\uff0c\u6240\u6709\u7684\u6570\u90fd\u5305\u542b\u4e00\u4e2a\u56e0\u6570 $x$\uff0c\u6545\u95ee\u9898\u7b49\u4ef7\u4e8e\uff0c\u6c42\u6709\u591a\u5c11\u4e2a\u6570\u5217\u6ee1\u8db3 $\\gcd(a_1,a_2,a_3,\\cdots)=1$ \u548c $\\sum a_i=\\frac{y}{x}$\uff0c\u6b64\u5904\u4e3a\u65b9\u4fbf\u540e\u7eed\u8868\u8fbe\uff0c\u4ee4 $n=\\frac{y}{x}$.\n\n$\\quad$\u4ee4 $f(x)$ \u8868\u793a $x|\\gcd(a_1,a_2,a_3,\\cdots)$ \u7684\u65b9\u6848\u6570\uff0c\u5219\u4f7f\u7528\u9694\u677f\u6cd5\u53ef\u5f97 $f(x)=2^{\\frac{n}{x}-1}$.\n\n$\\quad$\u4ee4 $g(x)$ \u8868\u793a $\\gcd(a_1,a_2,a_3,\\cdots)=x$ \u7684\u65b9\u6848\u6570\uff0c\u7531 $g$ \u7684\u5b9a\u4e49\u6613\u77e5 \uff1a\n\n$$f(x)=\\sum_{x~|~k}g(k)$$\n\n$\\quad$\u8003\u8651\u5c06\u5176\u53d8\u6362\u6210\u53ef\u4ee5\u4f7f\u7528\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u5f62\u5f0f\uff0c\u4ee4 $f'(x)=f(\\frac{n}{x})~,~g'(x)=g(\\frac{n}{x})$.\n\n$$\\because x~|~k\\Longleftrightarrow \\frac{n}{k}~\\big|~\\frac{n}{x}$$\n\n$$\\therefore f(x)=\\sum_{\\frac{n}{k}~|~\\frac{n}{x}}g\\left(\\dfrac{n}{\\frac{n}{k}}\\right)$$\n\n$$\\therefore f'(x)=\\sum_{d~|~x}g'(d)$$\n\n$\\quad$\u6839\u636e\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u7ed3\u8bba \uff1a\n\n$$g'(x)=\\sum_{d~|~x}\\mu(d)f'\\left(\\frac{x}{d}\\right)=\\sum_{d~|~x}\\mu(d)f(d)$$\n\n$\\quad$\u7b54\u6848\u5373\u4e3a $g(1)=g'(n)=\\sum_{d~|~n}\\mu(d)f(d)$\uff0c\u73b0\u5728\u8003\u8651\u5982\u4f55\u8ba1\u7b97 $g'(n)$.\n\n$\\quad$\u9996\u5148\u5bf9 $n$ \u8fdb\u884c\u8d28\u56e0\u6570\u5206\u89e3\uff0c\u5f97\u5230 $n=p_1^{q_1}\\times p_2^{q_2}\\times \\cdots \\times p_{\\omega(n)}^{q_{\\omega(n)}}$\uff0c\u8003\u8651\u5230\u5f53 $d$ \u5b58\u5728\u4e00\u4e2a\u5e73\u65b9\u56e0\u5b50\u65f6 $\\mu(d)=0$\uff0c\u6545\u5bf9 $n$ \u7684\u8d28\u56e0\u6570\u8fdb\u884c $\\rm dfs$\uff0c\u6240\u6709\u6307\u6570\u7684\u679a\u4e3e\u4e0a\u754c\u5747\u4e3a $1$\uff0c\u800c\u5bf9\u4e8e $f(d)$ \u76f4\u63a5\u5feb\u901f\u5e42\u8ba1\u7b97\u5373\u53ef\u3002\n\n$\\quad$\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(\\sqrt{n}+2^{\\omega(n)}\\log n)$.\n\n$\\quad PS:stO$ \u4ed9 $Achtoria$\uff0c\u672c\u9898\u6570\u636e\u8303\u56f4\u53ef\u4ee5\u5f00\u5230 $n\\leqslant 10^{14}$\uff0c\u53e6\u5916\uff0c\u5982\u679c\u4f7f\u7528 $\\Theta(n^{\\frac{1}{4}})$ \u7684\u5206\u89e3\u8d28\u56e0\u6570\u7b97\u6cd5\uff0c\u5219\u6570\u636e\u8303\u56f4\u53ef\u4ee5\u5f00\u5230 $n\\leqslant 10^{18}$.\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\n#define rep(i, l, r) for (int i = l; i <= r; ++i)\n#define dep(i, r, l) for (int i = r; i >= l; --i)\n\nconst int mod = 1e9 + 7;\n\nint n, x, y, p[20], cnt, ans;\n\nint Pow (int a, int k) {\n\tif (k == 0) return 1;\n\tif (k == 1) return a;\n\tint S = Pow(a, k >> 1);\n\tif (k & 1) return 1ll * S * S % mod * a % mod;\n\telse return 1ll * S * S % mod;\n}\n\nint main () {\n\n\tscanf(\"%d%d\", &x, &y), n = y / x;\n\tif (y % x) return puts(\"0\"), 0;\n\tfor (int i = 2; i * i <= n; i++)\n\t\tif (n % i == 0) {\n\t\t\tp[++cnt] = i;\n\t\t\twhile(n % i == 0) n /= i;\n\t\t}\n\tif (n > 1) p[++cnt] = n;\n\tn = y / x;\n\t\n\tdep(S, (1 << cnt) - 1, 0) {\n\t\tint mu = 1, d = 1;\n\t\trep(i, 0, cnt - 1) if ((S >> i) & 1)\n\t\t\tmu = -mu, d *= p[i + 1];\n\t\tans = (ans + mu * Pow(2, n / d - 1)) % mod;\n\t}\n\tprintf(\"%d\", (ans + mod) % mod);\n\n\treturn 0;\n}\n```",
        "postTime": 1624344685,
        "uid": 78645,
        "name": "C\u3000C\u3000A",
        "ccfLevel": 6,
        "title": "The Solution of [CF900D]Unusual Sequences"
    },
    {
        "content": "\u601d\u8def\u662f\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u628a\u5f0f\u5b50\u4e2d\u7684 $[\\gcd(x_i)=1]$ \u62c6\u6210 $\\mu(d)[d|\\gcd(x_i)]$\u3002\n\n\u53ea\u662f\u60f3\u8bf4\u660e\u4e00\u4e0b\u5728\u8ba1\u7b97\u4e00\u4e2a\u6570\u7684\u6240\u6709\u56e0\u5b50\u7684 $\\mu$ \u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u76f4\u63a5 dfs\u3002\u5728 dfs \u7684\u8fc7\u7a0b\u4e2d\u53ea\u9700\u8981\u679a\u4e3e\u6bcf\u4e2a\u53ef\u80fd\u7684\u8d28\u6570\u53d6\u6216\u4e0d\u53d6\uff0c\u5982\u679c\u53d6\u4e24\u4e2a\u53ca\u4ee5\u4e0a\u7684\u8bdd\u7cfb\u6570\u80af\u5b9a\u4e3a 0\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u7ea6\u4e3a $\\Theta(\\sqrt{y}+\\frac{\\sqrt{y}}{\\log y}+y^{\\frac 13}\\log y)$\uff0c\u8dd1\u4e0d\u6ee1\u3002$\\sqrt{y}$ \u7684\u590d\u6742\u5ea6\u6765\u6e90\u4e8e\u7ebf\u6027\u7b5b\uff0c\u6240\u4ee5\u53ef\u80fd\u4f1a\u5728\u591a\u7ec4\u6570\u636e\u4e0a\u8868\u73b0\u66f4\u4f18\u79c0\u3002\n\n\u5e38\u6570\u5927\u5927\u51cf\u5c0f\u7684\u540c\u65f6\u4ee3\u7801\u96be\u5ea6\u4e5f\u5f88\u5c0f\uff08\u62c6\u51fa\u6240\u6709\u8d28\u56e0\u6570\u4e4b\u540e dfs \u8fc7\u7a0b\u53ea\u6709\u4e24\u884c\uff09\u3002\n\n\u9644 AC \u4ee3\u7801\uff1a\n\n```cpp\n#include <cstdio>\nusing namespace std;\n\n#define mod 1000000007\n\nint pfix(int x) { return x>=mod ? x-mod : x; }\n\nint qpow(int a,int b)\n{\n\tint res = 1;\n\tfor(; b; b>>=1)\n\t{\n\t\tif(b&1) res = 1LL*res*a%mod;\n\t\ta = 1LL*a*a%mod;\n\t}\n\treturn res;\n}\n\nint isprime[32005];\nint primes[32005];\nint primen;\n\nvoid liner_seive(int n)\n{\n\tfor(int i=2; i<=n; ++i)\n\t{\n\t\tisprime[i] = 1;\n\t}\n\tfor(int i=2; i<=n; ++i)\n\t{\n\t\tif(isprime[i])\n\t\t{\n\t\t\tprimes[++primen] = i;\n\t\t}\n\t\tfor(int j=1; i*primes[j]<=n; ++j)\n\t\t{\n\t\t\tisprime[i*primes[j]] = 0;\n\t\t\tif(!(i%primes[j])) break;\n\t\t}\n\t}\n}\n\nint pi[15];\n\nint dfs(int c,int xs,int val)\n{\n\tif(!c) return 1LL*xs*qpow(2,val-1) %mod;\n\treturn pfix(dfs(c-1,xs,val) + dfs(c-1,mod-xs,val/pi[c]));\n}\n\nint main()\n{\n\tint x,y;\n\tscanf(\"%d%d\",&x,&y);\n\tif(y%x) return printf(\"0\\n\"),0;\n\ty /= x;\n\n\tliner_seive(31999);\n\n\tint pn = 0;\n\tint cury = y;\n\tfor(int i=1; primes[i]*primes[i]<=y; ++i)\n\t{\n\t\tif(!(y%primes[i]))\n\t\t{\n\t\t\tpi[++pn] = primes[i];\n\t\t\twhile(!(y%primes[i])) y/=primes[i];\n\t\t}\n\t}\n\tif(y!=1) pi[++pn] = y;\n\n\tprintf(\"%d\\n\",dfs(pn,1,cury));\n}\n```",
        "postTime": 1607053663,
        "uid": 49458,
        "name": "\u6728\u6728\uff01",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF900D \u3010Unusual Sequences\u3011"
    },
    {
        "content": "\u9996\u5148\u53d1\u73b0\u5982\u679c$x \\nmid y$ \u80af\u5b9a\u65e0\u89e3\n\n\u4ee4$f(x)$\u4e3a$gcd=x$,\u548c$=y$\u7684\u6570\u5217\u4e2a\u6570\n\n\u90a3\u4e48\u76f4\u63a5\u6c42$f(x)$\u4e0d\u597d\u6c42\n\n\u8bbe$g(x)$\u4e3a$x|gcd$,\u548c$=y$\u7684\u6570\u5217\u4e2a\u6570\n\n\u53ef\u4ee5\u7531\u63d2\u677f\u6cd5\u5f97\u5230\n\n\u90a3\u4e48$g(x)=2^{\\frac yx-1}$\n\n$$f(x)=\\displaystyle\\sum_{x|k,k|y}g(k)\\mu(\\frac kx)$$\n\n$$=\\displaystyle\\sum_{k\\mid\\frac yx}\\mu(k)2^{\\frac{y}{ix}-1}$$\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u7b97\u4e86\n\n```cpp\n#include <cstdio>\n#include <vector>\nint x, y;\nconst int mod = 1000000007;\ntypedef long long LL;\nint pow(int x, int y) {\n    int ans = 1;\n    for (; y; y >>= 1, x = static_cast<LL> (x) * x % mod)\n        if (y & 1) ans = static_cast<LL> (ans) * x % mod;\n    return ans;\n}\ntypedef std::pair<int, int> PII;\ntypedef std::vector<PII> VPII;\ntypedef std::vector<int> VI;\nVPII d;\nVI p;\nvoid up(int &x, int y) { if ((x += y) >= mod) x -= mod; }\nvoid dfs(int dep, int val, int miu) {\n    if (dep == p.size()) return d.push_back(std::make_pair(val, miu));\t\n    dfs(dep + 1, val, miu);\n    dfs(dep + 1, val * p[dep], mod - miu);\n}\nvoid solve() {\n    int k = y / x, tmp = k;\n    for (int i = 2; i * i <= tmp; i++) if (tmp % i == 0) {\n        int cnt = 0;\n        while (tmp % i == 0) ++cnt, tmp /= i;\n        p.push_back(i);\n    }\n    if (tmp > 1) p.push_back(tmp);\n    dfs(0, 1, 1);\n    int ans = 0;\n    for (VPII::iterator it = d.begin(); it != d.end(); ++it) {\n        up(ans, static_cast<LL> (it->second) * pow(2, k / it->first - 1) % mod);\n    }\n    std::printf(\"%d\\n\", ans);\n}\nint main() {\n    std::scanf(\"%d%d\", &x, &y);\n    if (y % x) std::printf(\"%d\\n\", 0);\n    else solve();\n    return 0;\n}\n```",
        "postTime": 1541492471,
        "uid": 26127,
        "name": "Weng_Weijie",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF900D \u3010Unusual Sequences\u3011"
    },
    {
        "content": "\u8fd9\u9898\u7528 dp \u7684\u601d\u60f3\u4e5f\u53ef\u4ee5\u5f15\u51fa\u6b63\u89e3\u3002\n\n\u9996\u5148\u5f88\u663e\u7136\u5730\uff0c$\\text{gcd}$ \u4e3a $x$ \u7684\u6570\u5217\u548c\u4e00\u5b9a\u662f $y$ \u7684\u56e0\u5b50\uff0c\u6240\u4ee5 $x$ \u4e0d\u6574\u9664 $y$ \u7684\u8bdd\u7b54\u6848\u5c31\u662f $0$\u3002\n\n\u53cd\u4e4b\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6570\u5217\u91cc\u7684\u6bcf\u4e2a\u6570\u90fd\u9664\u4ee5 $x$\uff0c\u5219\u603b\u548c\u53d8\u4e3a $\\frac{y}{x}$\uff0c\u516c\u7ea6\u6570\u53d8\u4e3a $1$\u3002\u4ee4 $S=\\frac y x$\uff0c\u5219\u95ee\u9898\u8f6c\u5316\u4e3a\uff1a\u6c42\u6570\u5217\u603b\u548c\u4e3a $S$ \u4e14\u516c\u7ea6\u6570\u4e3a $1$ \u7684\u6570\u5217\u7684\u6570\u91cf\u3002\n\n\u4e00\u4e2a\u6bd4\u8f83\u5957\u8def\u7684\u601d\u8def\uff0c\u8003\u8651\u5bb9\u65a5\u3002\n\n\u6839\u636e\u4e0a\u9762\u7684\u7ed3\u8bba\uff0c\u5982\u679c\u5bf9\u4e8e\u4e00\u4e2a $j$  \u5b58\u5728 $i=j\\times k$\uff0c\u90a3\u4e48\u628a\u6ee1\u8db3\u548c\u4e3a $j$ \u7684\u6570\u5217\u90fd\u4e58\u4e0a $k$ \u5373\u53ef\u5f97\u5230\u548c\u4e3a $i$ \u7684\u6570\u5217\u3002\n\n\u8bbe $f[i]$ \u8868\u793a\u603b\u548c\u4e3a $i$ \u7684\u516c\u7ea6\u6570\u4e3a $1$ \u7684\u6570\u5217\u4e2a\u6570\u3002\u5219\u6709\uff1a\n\n$$f[i]=2^{i-1}-\\sum_{d|i}f[\\frac{x}{d}]$$\n\n\u8fb9\u754c\uff1a$f[1]=1$\u3002\n\n\u610f\u4e49\u663e\u7136\uff1a$2^{i-1}$ \u662f\u4e0d\u8003\u8651\u516c\u7ea6\u6570\u7684\u5212\u5206\u603b\u6570\uff08\u53ef\u81ea\u884c\u63a8\u5bfc\uff09\uff0c\u56e0\u4e3a\u5982\u679c $i$ \u662f $d$ \u7684\u500d\u6570\uff0c\u90a3\u4e48 $f[\\frac{x}{d}]$ \u7684\u516c\u7ea6\u6570\u5c31\u4f1a\u662f $d$ \u800c\u4e0d\u662f $1$\u3002\u56e0\u6b64\u8981\u51cf\u53bb\u3002\n\n\u6ce8\u610f\u5230 $x,y \\leq 10^9$\uff0c\u6570\u7ec4\u5f00\u4e0d\u4e0b\uff0c\u8981\u5f00\u4e00\u4e2a `map` \u6765\u4fdd\u5b58\u3002\u8fd9\u4e2a\u7b97\u6cd5\u6548\u7387\u5927\u7ea6\u662f $O(V\\log V)$ \u7684\u3002\n\n\u636e\u8bf4\u53ef\u4ee5\u53cd\u6f14\u7b97\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u4f46\u662f dp \u6548\u7387\u4e5f\u4e0d\u4f4e\uff08\uff1f\uff09\u3002\n\n\u53e6\u5916\uff0c\u4e0d\u5f97\u4e0d\u63d0\u7684\u662f\uff1a\u5173\u4e8e\u8bb0\u5fc6\u5316\u641c\u7d22\u548c\u9012\u63a8\u8ba1\u7b97 dp \u8f6c\u79fb\u5f0f\u6548\u7387\u4e0a\u7684\u5dee\u5f02\uff0c\u9012\u63a8\u8ba1\u7b97\u7684\u6548\u7387\u74f6\u9888\u4e4b\u4e00\u662f\u9891\u7e41\u5b58\u53d6\u72b6\u6001\uff0c\u56e0\u6b64\u5982\u679c\u4f7f\u7528 `map`\uff08\u5b58\u53d6\u72b6\u6001\u4ee3\u4ef7\u9ad8\uff09\uff0c\u90a3\u4e48\u8fd8\u662f\u5efa\u8bae\u4f7f\u7528\u8bb0\u5fc6\u5316\u641c\u7d22\u3002\n\n\u4ee3\u7801\u4e2d\u63d0\u4f9b\u4e86\u8bb0\u5fc6\u5316\u641c\u7d22\u548c\u9012\u63a8\u8ba1\u7b97\u7684\u4e24\u4e2a\u7248\u672c\uff0c\u53ef\u81ea\u884c\u6bd4\u8f83\u6548\u7387\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mod=1e9+7;\ninline int qpow(int x,int y){\n\tint ans=1;\n\tfor(;y;y>>=1,x=1ll*x*x%mod)if(y&1)ans=1ll*ans*x%mod;\n\treturn ans;\n}\nmap<int,int>f;\nint dp2(int x){\n\tif(x==1)return 1;\n\tif(f[x])return f[x];\n\tint lim=sqrt(x);\n\tint t=qpow(2,x-1);\n\tfor(int i=1;i<=lim;i++){\n\t\tif(x%i==0){\n\t\t\tt=(t-dp2(i))%mod;\n\t\t\tif(i!=1&&i*i!=x)t=(t-dp2(x/i))%mod;\n\t\t}\n\t}\n\treturn f[x]=(t%mod+mod)%mod;\n}\nvoid dp(int v){\n\tf[1]=1;\n\tfor(int x=2;x<=v;x++){\n\t\tint lim=sqrt(x);\n\t\tint t=qpow(2,x-1);\n\t\tfor(int i=1;i<=lim;i++){\n\t\t\tif(x%i==0){\n\t\t\t\tt=(t-f[i])%mod;\n\t\t\t\tif(i!=1&&i*i!=x)t=(t-f[x/i])%mod;\n\t\t\t}\n\t\t}\n\t\tf[x]=(t%mod+mod)%mod;\n\t}\n\tcout<<f[v]<<endl;\n}\nint main(){\n\tint x,y;cin>>x>>y;\n\tif(y%x)return puts(\"0\"),0;\n\tcout<<dp2(y/x)<<endl;\n//\tdp(y/x);\n\treturn 0;\n}\n```\n",
        "postTime": 1666968435,
        "uid": 188950,
        "name": "UruhaRushia",
        "ccfLevel": 6,
        "title": "CF900D \u9898\u89e3"
    },
    {
        "content": "\u840c\u65b0\u7684\u5bb9\u65a5\u5165\u95e8\u9898\u3002\n\n\u6613\u4e8e\u53d1\u73b0\u9898\u76ee\u53ef\u4ee5\u8f6c\u5316\u4e3a\u6c42\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u7684\u6b63\u6574\u6570\u5e8f\u5217\u4e2a\u6570\uff1a\n\n- $\\sum \\limits_{i=1} ^{n} a_i = \\frac {y}{x} \\mid \\gcd \\limits_{i=1} ^{n} a_i = 1$\n\n\u8bb0 $f(x)$ \u8868\u793a\u548c\u4e3a $x$\uff0cgcd \u4e3a 1 \u7684\u6b63\u6574\u6570\u5e8f\u5217\u4e2a\u6570\uff0c\u53d1\u73b0\u4e0d\u597d\u76f4\u63a5\u6c42\u51fa\uff0c\u8003\u8651\u8865\u96c6\u8f6c\u5316\u3002\n\n\u8bb0 $g(x)$ \u8868\u793a\u548c\u4e3a $x$ \u7684\u6b63\u6574\u6570\u5e8f\u5217\u4e2a\u6570\uff0c\u5219\u679a\u4e3e\u5212\u5206\u7684\u4e2a\u6570 $n$\uff0c\u8f6c\u5316\u4e3a\u4e0d\u5b9a\u65b9\u7a0b\u7684\u6b63\u6574\u6570\u89e3\u7684\u4e2a\u6570\uff0c\u6613\u5f97 $g(x) = \\sum \\limits_{i=1} ^{n} {n - 1 \\choose i} = 2^{n - 1}$\u3002\n\n\u90a3\u4e48\u679a\u4e3e\u4e0d\u5408\u6cd5\u7684\u5e8f\u5217\uff08\u516c\u7ea6\u6570 d \u6ee1\u8db3 $1 < d \\leq x$\uff0c\u5219\u8fd9\u79cd\u5e8f\u5217\u7684\u4e2a\u6570\u4e3a $f(\\frac{x}{d})$\uff09\uff0c\u5219\uff1a\n\n$$f(x) = g(x) - \\sum \\limits_{d | x,d > 1}f(\\frac{x}{d})$$\n\n\u590d\u6742\u5ea6\u7684\u8bdd\uff0c\u6bcf\u4e2a\u6570\u80fd\u9012\u5f52\u8c03\u7528\u7684\u53c2\u6570\u5c31\u662f\u5b83\u7684\u6240\u6709\u7ea6\u6570\uff0c\u4e0d\u4f1a\u8d85\u8fc7 30 \u4e2a\u3002\n\n\u7528 map \u8bb0\u5fc6\u8ba1\u7b97\u8fc7\u7684\u4f4d\u7f6e\u7684\u7b54\u6848\u5373\u53ef\u3002\n\n$O(30 \\times \\sqrt n \\times \\log^2 n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\ninline void read(int &x)\n{\n\tx = 0;\n\tint f = 0;\n\tchar ch = getchar();\n\twhile(ch < '0' || ch > '9')\n\t{\n\t\tf |= ch == '-';\n\t\tch = getchar();\n\t}\n\twhile(ch >= '0' && ch <= '9')\n\t{\n\t\tx = x * 10 + ch - 48;\n\t\tch = getchar();\n\t}\n\tx = f ? -x : x;\n\treturn;\n}\nconst int mod = 1e9 + 7;\nint qpow(int a, int b)\n{\n\tint ans = 1;\n\twhile(b)\n\t{\n\t\tif(b & 1)\n\t\t{\n\t\t\tans = 1ll * ans * a % mod;\n\t\t}\n\t\ta = 1ll * a * a % mod;\n\t\tb >>= 1;\n\t}\n\treturn ans;\n}\nmap<int, int> mem;\nint solve(int x)\n{\n\tif(mem.count(x))\n\t{\n\t\treturn mem[x];\n\t}\n\tint ans = qpow(2, x - 1);\n\tfor(int i = 2; i * i <= x; i++)\n\t{\n\t\tif(x % i == 0)\n\t\t{\n\t\t\tans = (ans - solve(x / i) + mod) % mod;\n\t\t\tif(x / i != i)\n\t\t\t{\n\t\t\t\tans = (ans - solve(i) + mod) % mod;\n\t\t\t}\n\t\t}\n\t}\n\tans = (ans - 1 + mod) % mod;\n\treturn mem[x] = ans;\n}\nsigned main()\n{\n\tint x, y;\n\tread(x), read(y);\n\tif(y % x)\n\t{\n\t\tprintf(\"0\");\n\t\treturn 0;\n\t}\n\tmem[1] = 1;\n\tprintf(\"%d\", solve(y / x));\n\treturn 0;\n}\n```",
        "postTime": 1638114142,
        "uid": 90027,
        "name": "GG_jok_er",
        "ccfLevel": 0,
        "title": "CF900D Unusual Sequences \u9898\u89e3"
    },
    {
        "content": "\u840c\u840c\u9898\u3002\u9996\u5148\u5982\u679c $y$ \u4e0d\u662f $x$ \u7684\u500d\u6570\uff0c\u7b54\u6848\u663e\u7136\u4e3a $0$\u3002\u4e8e\u662f $y \\gets \\dfrac{y}{x}$\uff0c\u95ee\u9898\u53d8\u6210\u4e86\u6709\u591a\u5c11\u4e2a\u5e8f\u5217\uff0c\u5e8f\u5217\u7684 $\\gcd$ \u4e3a $1$\uff0c\u5e76\u4e14\u5e8f\u5217\u548c\u4e3a $y$\u3002\n\n\u5148\u6254\u6389 $\\gcd$ \u4e3a $1$ \u7684\u9650\u5236\u6761\u4ef6\u8003\u8651\u600e\u4e48\u505a\u3002\u9694\u677f\u6cd5\u5f97\u5230\uff1a\n\n$$\n\\sum_{i=0}^{y-1} \\dbinom{y-1}{i} = 2^{y-1}\n$$\n\n\u7136\u540e\u679a\u4e3e $\\gcd$\uff0c\u76f4\u63a5\u5bb9\u65a5\uff0c\u6839\u636e\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u5bb9\u65a5\u7cfb\u6570\u663e\u7136\u662f $\\mu$\u3002\u4e8e\u662f\u66b4\u529b\u679a\u4e3e $y$ \u7684\u56e0\u6570\uff0c\u66b4\u529b\u8ba1\u7b97 $\\mu$ \u51fd\u6570\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^{\\frac{3}{4}})$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\nconst LL MOD=1e9+7;\nLL QuickPow(LL x,LL p)\n{\n\tif(x==0)\treturn 0;\n\tif(p<0)\treturn 0;\n\tLL ans=1,base=x;\n\twhile(p)\n\t{\n\t\tif(p&1)\tans=ans*base%MOD;\n\t\tbase=base*base%MOD;\n\t\tp>>=1;\n\t}\n\treturn ans;\n}\nLL mu(LL x)\n{\n\tLL st=1;\n\tfor(LL i=2;i*i<=x;++i)\n\t{\n\t\tif(x%i==0)\n\t\t{\n\t\t\tx/=i;\n\t\t\tst=MOD-st;\n\t\t\tif(x%i==0)\treturn 0;\n\t\t}\n\t}\n\tif(x!=1)\tst=MOD-st;\n\treturn st;\n}\nLL calc(LL sum){return QuickPow(2,sum-1);}\nLL x,y;\nint main(){\n\tscanf(\"%lld %lld\",&x,&y);\n\tif(y%x)\treturn puts(\"0\")&0;\n\ty/=x;\n\tLL ans=0\n\tfor(LL i=1;i*i<=y;++i)\n\t{\n\t\tif(y%i==0)\n\t\t{\n\t\t\tans=(ans+mu(i)*calc(y/i)%MOD)%MOD;\n\t\t\tif(i*i!=y)\tans=(ans+mu(y/i)*calc(i)%MOD)%MOD;\n\t\t}\n\t}\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1629378192,
        "uid": 184977,
        "name": "pomelo_nene",
        "ccfLevel": 9,
        "title": "\u8c14\u8c143"
    },
    {
        "content": "\u5efa\u8bae\u5148\u505a [CF439E](https://www.luogu.com.cn/problem/CF439E)\u3002\n\n$$\\sum_{n=1}^y\\sum_{i_1=1}^y\\sum_{i_2=1}^y...\\sum_{i_n=1}^y [\\sum{a_i}=y][\\gcd{a_i}=x]$$\n\n$$\\sum_{n=1}^y\\sum_{i_1=1}^{\\frac{y}{x}}\\sum_{i_2=1}^\\frac{y}{x}...\\sum_{i_n=1}^\\frac{y}{x} [\\sum{a_i}=\\frac{y}{x}][\\gcd{a_i}=1]$$\n\n$$\\sum_{n=1}^y\\sum_{d|\\frac{y}{x}} \\mu(d) \\sum_{i_1=1}^{\\frac{y}{xd}}\\sum_{i_2=1}^{\\frac{y}{xd} }...\\sum_{i_f=1}^{\\frac{y}{xd}} [\\sum{a_i}=\\frac{y}{xd}]$$\n\n\u540e\u9762\u679a\u4e3e $i$ \u7684\u8fc7\u7a0b\u53ef\u4ee5\u770b\u4f5c\u5c06 $\\frac{y}{xd}$ \u4e2a\u76f8\u540c\u7684\u7403\u653e\u8fdb $n$ \u4e2a\u4e0d\u540c\u7684\u76d2\u5b50\uff0c\u4e14\u4e0d\u80fd\u6709\u7a7a\u76d2\u7684\u65b9\u6848\u6570\uff0c\u5229\u7528\u63d2\u677f\u6cd5\u53ef\u5f97\uff1a $\\binom{\\frac{y}{xd}-1}{n-1}$\n\n\u90a3\u4e48\u539f\u5f0f\u5373\u4e3a\uff1a\n\n$$\\sum_{n=1}^y\\sum_{d|\\frac{y}{x}} \\mu(d) \\binom{\\frac{y}{xd} - 1 }{n-1}$$\n\n$$\\sum_{d|\\frac{y}{x}}\\mu(d)  \\sum_{n=1}^y\\binom{\\frac{y}{xd} - 1 }{n-1}$$\n\n$$\\sum_{d|\\frac{y}{x}}\\mu(d)  \\sum_{n=1}^{\\frac{y}{xd}}\\binom{\\frac{y}{xd} - 1 }{n-1}$$\n\n$$\\sum_{d|\\frac{y}{x}}\\mu(d)  \\sum_{n=1}^{\\frac{y}{xd}}\\binom{\\frac{y}{xd} - 1 }{n-1}$$\n\n$$\\sum_{d|\\frac{y}{x}}\\mu(d)  2^{\\frac{y}{xd}-1}$$\n\n\n```cpp\n#include <cstdio>\n\nconst int MAXN = 1e5 , Mod = 1e9 + 7;\n\nint Quick_pow( int x , int po ) { int p = 1; for( ; po ; po >>= 1 , x = 1ll * x * x % Mod ) if( po & 1 ) p = 1ll * p * x % Mod; return p; }\nint Inv( int x ) { return Quick_pow( x , Mod - 2 ); }\n\nint mu( int n ) {\n\tint Ans = 1;\n\tfor( int i = 2 ; i * i <= n ; i ++ )\n\t\tif( n % i == 0 ) {\n\t\t\tint p = 0; for( ; n % i == 0 ; n /= i ) p ++;\n\t\t\tif( p > 1 ) return 0;\n\t\t\tAns *= -1;\n\t\t}\n\tif( n > 1 ) Ans *= -1;\n\treturn Ans;\n}\n\nint x , y;\nint main( ) {\n\tscanf(\"%d %d\",&x,&y);\n\tif( y % x != 0 || y < x ) return printf(\"0\\n\") & 0;\n\n\tint Ans = 0;\n\tfor( int d = 1 ; d * d <= y / x ; d ++ )\n\t\tif( y / x % d == 0 ) {\n\t\t\tAns = ( Ans + mu( d ) * Quick_pow( 2 , y / x / d - 1 ) % Mod ) % Mod;\n\t\t\tif( d * d != y / x )\n\t\t\t\tAns = ( Ans + mu( y / x / d ) * Quick_pow( 2 , d - 1 ) % Mod ) % Mod;\n\t\t}\n\tprintf(\"%d\\n\", ( Ans + Mod ) % Mod );\n\treturn 0;\n}\n```",
        "postTime": 1612151727,
        "uid": 123802,
        "name": "chihik",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF900D \u3010Unusual Sequences\u3011"
    },
    {
        "content": "\u5bf9\u4e8e $\\gcd(a_1, a_2, \\cdots, a_n) = x$, \u5fc5\u6709 $\\gcd(\\frac{a_1}{x}, \\frac{a_2}{x}, \\cdots, \\frac{a_n}{x}) = 1$.  \n\u6b64\u65f6 $a_1 + a_2 + \\cdots + a_n = \\frac{y}{x}$ .  \n\u5bf9\u4e8e $x \\nmid y$ \u7684\u60c5\u51b5\u663e\u7136\u4e0d\u5b58\u5728\u5408\u6cd5\u65b9\u6848\u3002  \n\u5bf9\u4e8e $x \\mid y$ : \u6839\u636e\u4e0a\u9762\u8bf4\u7684\u53ef\u4ee5\u7b49\u4ef7\u5230 $\\gcd(a_1, a_2, \\cdots, a_n) = 1$ , $a_1 + a_2 + \\cdots + a_n = \\frac{y}{x}$\u3002\u6211\u4eec\u8bbe\u8fd9\u4e2a\u7b54\u6848\u4e3a $f(\\frac{y}{x})$\u3002  \n\u8003\u8651\u6c42 $f(\\frac{y}{x})$\u3002  \n\u5c06 $\\frac{y}{x}$ \u7684\u6570\u503c\u5212\u5206\u4e3a\u82e5\u5e72($1, 2, \\cdots, n-1$)\u4e2a\u6b63\u6570\u7684\u5408\u662f\u4e00\u4e2a\u7ecf\u5178\u7684\u7ec4\u5408\u95ee\u9898, \u603b\u7684\u65b9\u6848\u6570\u4e3a $\\sum_{i=1}^{\\frac{y}{x}-1}\\binom{\\frac{y}{x}-1}{i} = 2^{\\frac{y}{x}-1}$ \u3002 \u8fd9\u4e9b\u533a\u95f4\u5305\u542b $\\gcd(a_1, a_2, \\cdots, a_n) = d$ \u7684\u6240\u6709\u60c5\u51b5, \u5176\u4e2d $d \\mid \\frac{y}{x}$ \u3002\u800c\u8fd9\u4e9b\u60c5\u51b5\u7684\u65b9\u6848\u6570\u53c8\u53ef\u4ee5\u7b49\u4ef7\u4e8e $f(\\frac{y}{dx})$ \u3002  \n\u4e8e\u662f\u6709  \n$$\n\\sum_{d \\mid \\frac{y}{x}} f(d) = 2^{\\frac{y}{x}-1}\n$$\n\u8bbe $g(x) = 2^{x-1}$ , \u6709  \n$$\nf * 1 = g\n$$\n\u8fd0\u7528\u83ab\u53cd\u516c\u5f0f\n$$\nf*1*\\mu = g*\\mu \\to f = g* u\n$$\n\u4e8e\u662f\u53ef\u4ee5\u8f6c\u4e3a\u6c42\u5355\u70b9\u7684\u503c\u3002  \n$f(\\frac{y}{x}) = \\sum_{d \\mid \\frac{y}{x}}{\\mu(d)2^{\\frac{y}{x}-1}}$  \n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int N = 100010, Mod = 1000000007;\ninline int Inc(int x, int y) { return (x+=y) < Mod ? x : x - Mod; }\ninline int Dec(int x, int y) { return (x-=y) < 0 ? x + Mod : x; }\ninline int Mul(int x, int y) { return 1ll * x * y % Mod; }\ninline int Power(int x, int y) {\n\tint ret = 1;\n\tfor(; y; y >>= 1) {\n\t\tif(y&1) ret = Mul(ret, x);\n\t\tx = Mul(x, x);\n\t}\n\treturn ret;\n}\nint Prime[N], vp[N], tot;\nvoid seive(int n) {\n\tfor(int i = 2; i <= n; ++i) {\n\t\tif(!vp[i]) Prime[++tot] = i;\n\t\tfor(int j = 1; j <= tot && i * Prime[j] <= n; ++j) {\n\t\t\tvp[i*Prime[j]] = 1;\n\t\t\tif(i % Prime[j] == 0) break;\n\t\t}\n\t}\n}\n\nint mu(int n) {\n\tif(n == 1) return 1;\n\tint ret = 1;\n\tfor(int i = 1, j = Prime[i]; i <= tot && 1ll * j * j <= n; j = Prime[++i]) {\n\t\tif(n % (j*j) == 0) return 0;\n\t\tif(n % j == 0) ret = -ret, n /= j;\n\t}\n\tret = n == 1 ? ret : -ret;\n\treturn ret < 0 ? ret + Mod : ret;\n}\n\nint main() {\n\tseive(N - 10);\n\tint x, y;\n\tcin >> x >> y;\n\tif(y % x != 0) {\n\t\tcout << 0 << endl;\n\t\treturn 0;\t\n\t}\n\tint ans = 0, n = y / x;\n\tfor(int i = 1; 1ll * i * i <= n; ++i) if(n % i == 0) {\n\t\tans = Inc(ans, Mul(mu(i), Power(2, n/i-1)));\n\t\tif(i * i != n) ans = Inc(ans, Mul(mu(n/i), Power(2, i-1)));\n\t}\n\tcout << ans << endl;\n\treturn 0;\n}\n```",
        "postTime": 1607091851,
        "uid": 88735,
        "name": "\u5bd2\u9e3d\u513f",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF900D \u3010Unusual Sequences\u3011"
    }
]
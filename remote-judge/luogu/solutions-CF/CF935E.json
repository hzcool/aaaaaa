[
    {
        "content": "\u524d\u8a00\uff1a~~\u53d1\u73b0\u6700\u8fd1\u8d8a\u6765\u8d8a\u770b\u4e0d\u61c2 cf \u8bc4\u5206\u4e86~~\n\n$\\text{Problem}$\uff1a[\u9898\u76ee\u94fe\u63a5](https://codeforces.com/problemset/problem/935/E)\n\n$\\text{Solution}$\uff1a\n\n\u6b64\u9898\u96be\u70b9\u5176\u5b9e\u5728\u4e8e\u5efa\u6811\u3002\n\n\u76f4\u63a5\u5efa\u7acb\u8868\u8fbe\u5f0f\u6811\u5373\u53ef\u3002\u5177\u4f53\u7684\u65b9\u6cd5\u662f\uff0c\u5bf9\u4e8e\u67d0\u4e2a $?$\uff0c\u5c06\u5b83\u7684\u5de6\u8fb9\u4ee5 $($ \u548c $number$ \u7684\u60c5\u51b5\u5206\u522b\u8ba8\u8bba\uff0c\u53f3\u8fb9\u4e5f\u540c\u7406\u3002\u6ce8\u610f\u5230\u6700\u53f3\u8fb9\u7684\u53f3\u62ec\u53f7\u9700\u8981\u7279\u5224\u540e\u8df3\u51fa\uff0c\u5426\u5219\u5c06\u4f1a\u5efa\u4e00\u4e2a\u6839\u8282\u70b9\u7684\u53f3\u7aef\u70b9\u7684\u7f16\u53f7\u7b49\u4e8e\u672c\u8eab\u7684\u6811\uff0c\u5bfc\u81f4\u6b7b\u5faa\u73af\u3002\u5efa\u6210\u7684\u4e8c\u53c9\u6811\u5177\u6709\u826f\u597d\u7684\u6027\u8d28\uff1a\u6240\u6709\u7684\u53f6\u5b50\u8282\u70b9\u4e0a\u90fd\u6709\u4e00\u4e2a\u503c\uff1b\u6240\u6709\u7684\u975e\u53f6\u5b50\u8282\u70b9\u4e0a\u90fd\u662f\u4e00\u4e2a $?$\uff1b\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u975e\u53f6\u5b50\u7ed3\u70b9\uff0c\u5b83\u7684\u8d21\u732e\u53ea\u7531\u5b83\u7684\u5de6\u5b50\u6811\u548c\u53f3\u5b50\u6811\u7684\u8d21\u732e\u8f6c\u79fb\u800c\u6765\u3002\n\n\u8003\u8651\u5728\u8fd9\u68f5\u4e8c\u53c9\u6811\u4e0a $dp$\u3002\u53d1\u73b0 $min\\{P,M\\}$ \u975e\u5e38\u5c0f\uff0c\u8003\u8651\u5bf9\u4e8e $P<M$ \u548c $M\\leq P$ \u7684\u60c5\u51b5\u5206\u5f00\u8ba8\u8bba\uff0c\u6b64\u5904\u4ee5 $P<M$ \u4e3a\u4f8b\uff0c\u8bbe $F_{x,i}$ \u8868\u793a\u7f16\u53f7\u4e3a $x$ \u7684\u8282\u70b9\u9009\u4e86 $i$ \u4e2a $+$ \u53f7\u65f6\u7684\u6700\u5927\u8d21\u732e\uff0c$G_{x,i}$ \u8868\u793a\u7f16\u53f7\u4e3a $x$ \u7684\u8282\u70b9\u9009\u4e86 $i$ \u4e2a $+$ \u53f7\u65f6\u7684\u6700\u5c0f\u8d21\u732e\uff0c\u5219\u6613\u5f97\uff08\u8bb0 $lc,rc$ \u5206\u522b\u4e3a $x$ \u7684\u5de6\u5b69\u5b50\uff0c\u53f3\u5b69\u5b50\uff09\uff1a\n\n$$F_{x,i}=max\\{F_{lc,j}+F_{rc,i-j-1},F_{lc,k}-G_{rc,i-k}\\}$$\n\n$$G_{x,i}=min\\{G_{lc,j}+G_{rc,i-j-1},G_{lc,k}-F_{rc,i-k}\\}$$\n\n\u8fb9\u754c\u6761\u4ef6\u5373 $j,k$ \u53d6\u503c\u8303\u56f4\u6839\u636e\u5b9a\u4e49\u53ef\u4ee5\u5f97\u51fa\u3002\u6700\u540e\u7684\u7b54\u6848\u4e3a $F_{root,P}$\u3002\n\n\u5bf9\u4e8e $M\\leq P$ \u7684\u60c5\u51b5\u540c\u7406\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\times min(P,M)^{2})$\uff0c\u53ef\u8fc7\u3002\n\n$\\text{Code}$\uff1a\n\n```cpp\n//hoho! xtwakioi! xtwddYnoi(\u53cc\u91cd\u542b\u4e49)!\n#include <bits/stdc++.h>\n#define ri register\n//#define int long long\n#define E (100001)\n#define mk make_pair\nusing namespace std; const int N=10010, M=105;\ninline int read()\n{\n    int s=0, w=1; ri char ch=getchar();\n    while(ch<'0'||ch>'9') { if(ch=='-') w=-1; ch=getchar(); }\n    while(ch>='0'&&ch<='9') s=(s<<3)+(s<<1)+(ch^48), ch=getchar();\n    return s*w;\n}\nint Len,cnt,root,now=1,ch[N][2],a[N],res=-2e9;\nchar s[N];\nint F[N][M],G[N][M],p,m;\nint Get();\nint DFS();\nint Get()\n{\n    int x=cnt;\n    if(isdigit(s[now]))\n    {\n        int ans=0;\n        for(;isdigit(s[now]);now++) ans=ans*10+s[now]-'0';\n        a[++cnt]=ans, x=cnt;\n    }\n    else if(s[now]=='(') now++, x=DFS(), now++;\n    return x;\n}\nint DFS()\n{\n    int L=Get();\n    if(now>Len)\n    {\n        return L;\n    }\n    int x=++cnt;\n    now++;\n    ch[x][0]=L, ch[x][1]=Get();\n    return x;\n}\nvoid Poit(int x)\n{\n    if(!x) return;\n    if(!ch[x][0] && !ch[x][1])\n    {\n        F[x][0]=G[x][0]=a[x];\n        return;\n    }\n    Poit(ch[x][0]), Poit(ch[x][1]);\n    for(ri int i=0;i<=p;i++)\n    {\n        if(i)\n        {\n            for(ri int j=0;j<i;j++)\n            F[x][i]=max(F[x][i],F[ch[x][0]][j]+F[ch[x][1]][i-1-j]),\n            G[x][i]=min(G[x][i],G[ch[x][0]][j]+G[ch[x][1]][i-1-j]);\n        }\n        for(ri int j=0;j<=i;j++)\n        F[x][i]=max(F[x][i],F[ch[x][0]][j]-G[ch[x][1]][i-j]),\n        G[x][i]=min(G[x][i],G[ch[x][0]][j]-F[ch[x][1]][i-j]);\n    }\n}\nvoid Moit(int x)\n{\n    if(!x) return;\n    if(!ch[x][0] && !ch[x][1])\n    {\n        F[x][0]=G[x][0]=a[x];\n        return;\n    }\n    Moit(ch[x][0]), Moit(ch[x][1]);\n    for(ri int i=0;i<=m;i++)\n    {\n        if(i)\n        {\n            for(ri int j=0;j<i;j++)\n            F[x][i]=max(F[x][i],F[ch[x][0]][j]-G[ch[x][1]][i-j-1]),\n            G[x][i]=min(G[x][i],G[ch[x][0]][j]-F[ch[x][1]][i-j-1]);\n        }\n        for(ri int j=0;j<=i;j++)\n        F[x][i]=max(F[x][i],F[ch[x][0]][j]+F[ch[x][1]][i-j]),\n        G[x][i]=min(G[x][i],G[ch[x][0]][j]+G[ch[x][1]][i-j]);\n    }\n}\nsigned main()\n{\n    scanf(\"%s\",s+1);\n    Len=strlen(s+1);\n    root=DFS();\n    p=read(), m=read();\n    memset(F,-0x3f,sizeof(F)), memset(G,0x3f,sizeof(G));\n    if(p<m) Poit(root), res=F[root][p];\n    else Moit(root), res=F[root][m];\n    printf(\"%d\\n\",res);\n    return 0;\n}\n```\n",
        "postTime": 1603807514,
        "uid": 98618,
        "name": "Provicy",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF935E"
    }
]
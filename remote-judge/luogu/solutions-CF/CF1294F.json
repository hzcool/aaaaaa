[
    {
        "content": "\u4ecb\u7ecd\u4e00\u79cd\u81ea\u5df1\u7684\u4e71\u641e\u505a\u6cd5\u3002\n\n\u9996\u5148\u8bbe\u9009\u53d6\u7684\u4e09\u4e2a\u70b9\u5206\u522b\u4e3a $du, dv, dw$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u4e09\u6761\u8def\u5f84\u7684\u5e76\u96c6\u53ef\u4ee5\u770b\u4f5c\u662f\u6709\u552f\u4e00\u7684\u4e00\u4e2a\u4ea4\u70b9\uff0c\u4f8b\u5982\u6837\u4f8b\uff1a\n\n![image.png](https://i.loli.net/2020/01/26/cV27jt4s6IOTCxm.png)\n\n\u4ea4\u70b9\u4e3a $4$\u3002\n\n\u90a3\u4e48\uff0c\u95ee\u9898\u5c31\u53d8\u6210\u4e86\uff0c\u627e\u5230\u4e00\u4e2a $u$  \u4f5c\u4e3a\u4ea4\u70b9\uff0c$du, dv, dw$ \u4e00\u5b9a\u662f\u5230 $u$ \u8ddd\u79bb\u6700\u8fdc\u7684\uff0c**\u4e14\u4e0d\u5728\u540c\u4e00\u68f5\u5b50\u6811\u91cc** \u7684\u4e09\u4e2a\u70b9\u3002\n\n\u4e3a\u4ec0\u4e48\u4e0d\u5728\u540c\u4e00\u68f5\u5b50\u6811\u91cc\uff1f\n\n\u56e0\u4e3a\u5982\u679c $du, dv$ \u5728\u4e00\u68f5\u5b50\u6811\u91cc\uff0c\u663e\u7136\uff0c\u6211\u4eec\u53ef\u4ee5\u627e\u5230\u5b83\u4eec\u5206\u53c9\u7684\u5730\u65b9\uff0c\u6bd4\u5982\u53eb\u505a $v$\uff0c\u90a3 $u \\to v \\to du$ \u548c $u \\to v \\to dv$ \u4e24\u6761\u8def\u5f84\u5c31\u6709 $u \\to v$ \u8fd9\u4e00\u6bb5\u76f8\u4ea4\u7684\u5730\u65b9\uff0c\u90a3\u4e48\u4ea4\u70b9\u5c31\u5927\u53ef\u4ee5\u8bbe\u6210 $v$ \u4e86\u3002\n\n\u4e8e\u662f $\\mathcal O(n^2)$ \u7684\u505a\u6cd5\u4e0d\u96be\u60f3\u5230\uff1a\u679a\u4e3e $u$\uff0c$n$ \u6b21 BFS\uff0c\u66b4\u529b\u6c42\u51fa\u6700\u8fdc\u70b9\u66f4\u65b0\u7b54\u6848\u3002\n\n\u8fd9\u4e2a\u505a\u6cd5\u663e\u7136\u662f\u4f1a TLE \u7684\uff0c\u6b63\u89e3\u9700\u8981\u4e0b\u9762\u8fd9\u4e2a\u7ed3\u8bba\uff1a\n\n> $du, dv$ \u4e00\u5b9a\u662f\u6811\u7684\u76f4\u5f84\u7684\u4e24\u4e2a\u7aef\u70b9\u3002\n\n\u4e3a\u4ec0\u4e48\u5462\uff1f\n\n\u6bd4\u5982\u6211\u4eec\u6709\u8fd9\u4e48\u4e00\u68f5\u6811\uff0c\u5b83\u7684\u76f4\u5f84\u7528\u7ea2\u8272\u6807\u51fa\u3002\n\n![image.png](https://i.loli.net/2020/01/26/HBsaVyfD4bkZeEG.png)\n\n\u5206\u4e24\u79cd\u60c5\u51b5\uff1a\n\n* \u679a\u4e3e\u5230\u7684 $u$ \u5728\u76f4\u5f84\u4e0a\u3002\n\n\u90a3\u4e48\u6211\u4eec\u8981\u8bc1\u660e\u7684\u5c31\u662f\u6700\u8fdc\u7684\u4e24\u6761\u94fe $du, dv$ \u4e00\u5b9a\u662f\u6811\u7684\u76f4\u5f84\u7684\u7aef\u70b9\u3002\n\n![image.png](https://i.loli.net/2020/01/26/tpsJc5EeOjnBdzY.png)\n\n\u6bd4\u5982\u6211\u4eec\u679a\u4e3e\u5230\u4e86\u8fd9\u6837\u7684 $u$\uff0c\u6211\u4eec\u53d1\u73b0 $u$ \u9664\u4e86\u76f4\u5f84\u8fd8\u6709\u4e00\u68f5\u5b50\u6811\uff0c\u8fd9\u4e2a\u91cc\u9762\u79bb $u$ \u6700\u8fdc\u7684\u53eb\u505a $w$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u6709\uff1a\n\n$$ dis(u, a) \\ge dis(u, w) \\cdots \\cdots (1)$$\n$$ dis(u, b) \\ge dis(u, w) \\cdots \\cdots (2) $$\n\n![image.png](https://i.loli.net/2020/01/26/c1vCHywILkZ48fp.png)\n\n$(1)$ \u662f\u56e0\u4e3a\uff0c\u5982\u679c\u6709 $dis(u, w) > dis(u, b)$ \u4e86\uff0c\u90a3\u4e48\u6811\u7684\u76f4\u5f84\u5c31\u4e0d\u53ef\u80fd\u662f $a \\to b$\uff0c\u800c\u662f $a \\to w$ \u4e86\uff1b$(2)$ \u4e5f\u540c\u7406\u53ef\u8bc1\u3002\n\n\u90a3\u4e48\uff0c$u$ \u9664\u4e86\u5b50\u6811\u91cc\u9762\u7684\u70b9\uff0c\u4e5f\u5c31 $a, b$ \u4e24\u4e2a\u9009\u62e9\u4e86\uff0c\u6240\u4ee5 $du = a$\uff0c$dv = b$\u3002\n\n* \u679a\u4e3e\u5230\u7684 $u$ \u4e0d\u5728\u76f4\u5f84\u4e0a\u3002\n\n![image.png](https://i.loli.net/2020/01/26/tFBTa3VHPOseoj2.png)\n\n\u6211\u4eec\u8fd8\u662f\u8bbe $u$ \u7684\u5b50\u6811\uff08\u8fd9\u6b21\u6709\u4e24\u68f5\uff09\u79bb $u$ \u6700\u8fdc\u7684\u70b9\u4e3a $w$\u3002\u518d\u8bbe $u$ \u4e0d\u65ad\u6cbf\u7740\u7236\u4eb2\u8ffd\u6eaf\u5230\u76f4\u5f84\u4e0a\u7684\u70b9\u4e3a $v$\u3002\n\n\u540c\u4e0a\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$ dis(v, a) \\ge dis(v, w) = dis(u, v) + dis(u, w) $$\n$$ dis(v, b) \\ge dis(v, w) = dis(u, v) + dis(u, w) $$\n\n![image.png](https://i.loli.net/2020/01/26/sxE7qrlVRITZ1jd.png)\n\n\u53f3\u8fb9\u53bb\u6389\u4e00\u4e2a $dis(u, v)$ \u4e0d\u5f71\u54cd\u4e0d\u7b49\u5f0f\uff0c\u6240\u4ee5\uff1a\n\n$$ dis(v, a) \\ge dis(u, w) $$\n$$ dis(v, b) \\ge dis(u, w) $$\n\n\u5de6\u8fb9\u518d\u52a0\u4e0a\u4e00\u4e2a $dis(u, v)$ \u4e5f\u4e0d\u5f71\u54cd\u4e0d\u7b49\u5f0f\uff0c\u6240\u4ee5\uff1a\n\n$$ dis(v, a) + dis(u, v) = dis(u, a) \\ge dis(u, w) $$\n$$ dis(v, b) + dis(u, v) = dis(u, b) \\ge dis(u, w) $$\n\n\u6240\u4ee5\u6211\u4eec\u8fd8\u662f\u4f1a\u5148\u9009 $du = a$\uff0c$dv = b$\uff01\n\n\u7136\u540e\u65e2\u7136\u8fd9\u6837\u4e86\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5148\u627e\u5230\u76f4\u5f84\uff0c\u4e8e\u662f $du, dv$ \u5c31\u51fa\u6765\u4e86\u3002\n\n\u7136\u540e\u8bb0\u5f55\u76f4\u5f84\u4e0a\u7684\u70b9\u4e3a $\\text{path}$\uff0c\u5728 $\\text{path}$ \u4e0a\u679a\u4e3e $u$\uff0c\u627e\u5230\u300c\u4e0d\u5728\u76f4\u5f84\u4e0a\u300d\u4e14 \u300c\u8ddd\u79bb $u$ \u6700\u8fdc\u300d\u7684\u70b9 $w$\uff0c\u7528\u6765\u66f4\u65b0\u7b54\u6848\u3002\n\n\u5177\u4f53\u600e\u4e48\u5b9e\u73b0\u5462\uff1f\u6211\u4eec\u53ef\u4ee5\u628a\u76f4\u5f84\u62c9\u51fa\u6765\uff0c\u6bd4\u5982\u6837\u4f8b\uff0c$1 \\to 5$ \u662f\u76f4\u5f84\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\uff1a\n\n![image.png](https://i.loli.net/2020/01/26/fwQXGCT8a6xY2Ov.png)\n\n\u628a\u76f4\u5f84\u62c9\u51fa\u6765\uff0c\u7136\u540e\u6211\u4eec\u4ece\u4e0a\u81f3\u4e0b\u8bb0\u5f55\u4e3a $\\text{path}_{1 \\to len}$\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u53ea\u8981 $\\text{path}_i$ \u7684\u513f\u5b50\u4e0d\u662f $\\text{path}_{i + 1}$\uff0c\u5c31\u662f\u53ef\u4ee5\u66f4\u65b0\u7684\u3002\n\n\u5bb9\u6613\u8bbe\u8ba1\u51fa\u4e00\u4e2a\u6811\u5f62 DP\uff0c$f_{u}$ \u8868\u793a $u$ \u6700\u4f73\u7684\u957f\u5ea6\uff0c$g_{u}$ \u8868\u793a\u6765\u6e90\uff0c\u663e\u7136\uff1a\n\n$\\textbf{if } u \\not \\in \\text{path } \\textbf{then } f_u = \\max\\limits_{v \\in \\text{sons(u)}} \\{f_v +1\\}$   \n$\\textbf{else } \\text{let } u \\text{ be path}_i, f_u = \\max\\limits_{v \\in \\text{sons(u)}, v \\text{ isn't path}_{i + 1} }\\{ f_v +1\\}$\n\n$g_u$ \u76f8\u5e94\u66f4\u65b0\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n)$\uff0c\u4ee3\u7801\u5982\u4e0b\uff0c\u4ec5\u4f9b\u53c2\u8003\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 2e5 + 5;\nint n, dep[N], fa[N], du, dv, dlen;\nvector<int> G[N];\nvoid dfs(int u) // \u9884\u5904\u7406\n{\n\tfor(int v : G[u]) if(v ^ fa[u])\n\t{\n\t\tdep[v] = dep[u] + 1;\n\t\tfa[v] = u;\n\t\tdfs(v);\n\t}\n}\nint tmp[N], cur, path[N];\nvoid find_path(int u) // \u62c9\u51fa\u76f4\u5f84\n{\n\ttmp[++cur] = u;\n\tif(u == dv)\n\t{\n\t\tfor(int i = 1; i <= cur; i++) path[i] = tmp[i];\n\t\treturn;\n\t}\n\tfor(int v : G[u]) if(v ^ fa[u]) find_path(v);\n\tcur--;\n}\nint f[N], g[N], maxl = -1, dw;\nvoid solve(int u, int pos) // DP\n{\n\tif(u ^ path[pos])\n\t{\n\t\tfor(int v : G[u]) if(v ^ fa[u])\n\t\t{\n\t\t\tsolve(v, pos);\n\t\t\tif(f[u] < f[v] + 1)\n\t\t\t\tf[u] = f[v] + 1, g[u] = g[v];\n\t\t}\n\t}\n\telse\n\t{\n\t\tfor(int v : G[u]) if(v ^ fa[u])\n\t\t{\n\t\t\tsolve(v, pos + 1);\n\t\t\tif(v ^ path[pos + 1] && f[u] < f[v] + 1)\n\t\t\t\tf[u] = f[v] + 1, g[u] = g[v];\n\t\t}\n\t}\n\tif(f[u] > maxl && g[u] != du && g[u] != dv) // \u6ce8\u610f\uff0c\u5982\u679c\u6765\u6e90\u662f du \u6216 dv \u5c31\u91cd\u590d\u4e86\uff0c\u6240\u4ee5\u4e0d\u884c\n\t\tmaxl = f[u], dw = g[u];\n}\nint main()\n{\n\tios::sync_with_stdio(false);\n\tcin >> n;\n\tfor(int i = 1; i < n; i++)\n\t{\n\t\tint u, v;\n\t\tcin >> u >> v;\n\t\tG[u].push_back(v);\n\t\tG[v].push_back(u);\n\t}\n\tdep[1] = fa[1] = 0;\n\tdfs(1);\n\tfor(int i = 1; i <= n; i++) if(dep[i] > dep[du]) du = i;\n\tdep[du] = fa[du] = 0;\n\tdfs(du);\n\tfor(int i = 1; i <= n; i++) if(dep[i] > dep[dv]) dv = i;\n\tdlen = dep[dv];\n\tfind_path(du);\n\tcur = n;\n\tfor(int u = 1; u <= n; u++) g[u] = u;\n\tsolve(du, 1);\n\tcout << maxl + dlen << endl;\n\tcout << du << ' ' << dv << ' ' << dw << endl;\n\treturn 0;\n}\n```",
        "postTime": 1580042718,
        "uid": 51971,
        "name": "syksykCCC",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1294F \u3010Three Paths on a Tree\u3011"
    },
    {
        "content": "\u6c42\u8def\u5f84\u5e76\u96c6\u957f\u5ea6\u6700\u5927\uff0c\u5fc5\u7136\u4f18\u5148\u9009\u4e00\u6761\u6700\u957f\u7684\uff0c\u4e5f\u5c31\u662f\u6811\u7684\u76f4\u5f84\uff0c\u8bb0\u4e24\u7aef\u70b9\u4e3a $u,v$\u3002\u7136\u540e\u8003\u8651\u4ece\u76f4\u5f84\u4e0a\u5ef6\u4f38\u4e00\u6761\u8def\u5f84\uff0c\u8fd9\u6761\u8def\u5f84\u65e0\u8bba\u4e0e\u76f4\u5f84\u4ea4\u96c6\u5927\u5c0f\u4e3a\u4f55\u503c\u90fd\u6ca1\u6709\u610f\u4e49\uff0c\u53ea\u8981\u4ea4\u96c6\u5927\u5c0f\u4e0d\u5c0f\u4e8e $1$ \u5373\u53ef\u3002\u4e0d\u59a8\u8ba4\u4e3a\u5b83\u548c\u76f4\u5f84\u7684\u4ea4\u96c6\u53ea\u6709\u4e00\u4e2a\u70b9\u3002\u90a3\u4e48\u4e24\u904d $\\text{dfs}$ \u540e\u4ece\u76f4\u5f84\u5f00\u59cb $\\text{bfs}$\uff0c\u5728 $\\text{bfs}$ \u8fc7\u7a0b\u4e2d\u627e\u5230\u8fd9\u6761\u80fd\u591f\u5ef6\u4f38\u51fa\u53bb\u7684\u6700\u957f\u8def\u5f84\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n)$\u3002\n\n\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u53ef\u80fd\u5b58\u5728\u627e\u4e0d\u5230\u8fd9\u6761\u5ef6\u4f38\u51fa\u53bb\u7684\u8def\u5f84\uff0c\u8fd9\u65f6\u5728\u76f4\u5f84\u4e0a\u4efb\u610f\u53d6\u4e0d\u4e3a\u76f4\u5f84\u4e24\u7aef\u70b9\u7684\u70b9\u5373\u53ef\u3002\n\n```cpp\n#include<cstdio>\n#include<queue>\nstd::queue<std::pair<int,int> > Q;\nint cnt=0,pos;\nint vis[200005],sum[200005],pre[200005];\nint h[200005],to[400005],ver[400005];\ninline int read() {\n\tregister int x=0,f=1;register char s=getchar();\n\twhile(s>'9'||s<'0') {if(s=='-') f=-1;s=getchar();}\n\twhile(s>='0'&&s<='9') {x=x*10+s-'0';s=getchar();}\n\treturn x*f;\n}\ninline int max(const int &x,const int &y) {return x>y? x:y;} \ninline void add(int x,int y) {to[++cnt]=y;ver[cnt]=h[x];h[x]=cnt;}\ninline void dfs(int x,int fa) {pos=sum[x]>sum[pos]? x:pos;  for(register int i=h[x];i;i=ver[i]) {int y=to[i]; if(y==pre[x]) continue; pre[y]=x; sum[y]=sum[x]+1; dfs(y,x);}}\nint main() {\n\tint n=read(),mx=0,st,ed,p=0;\n\tfor(register int i=1;i<n;++i) {int x=read(),y=read();add(x,y);add(y,x);}\n\tsum[1]=0; dfs(1,-1); st=pos; pre[st]=-1; sum[st]=0; dfs(st,-1); ed=pos; //printf(\"Never\\n\");\n\tint cur=ed; p=pre[ed]; while(cur!=-1) {Q.push(std::make_pair(cur,0)); vis[cur]=1; cur=pre[cur];} //printf(\"\\n\");\n\twhile(Q.size()) {\n\t\tint x=Q.front().first,step=Q.front().second; Q.pop(); if(mx<step) mx=step,p=x;\n\t\tfor(register int i=h[x],y;i;i=ver[i]) if(!vis[y=to[i]]) Q.push(std::make_pair(y,step+1)),vis[y]=1; \n\t}\n\tprintf(\"%d\\n%d %d %d\",sum[ed]+mx,st,ed,p);\n\treturn 0;\n}\n```",
        "postTime": 1602836229,
        "uid": 95244,
        "name": "tommymio",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF1294F \u3010Three Paths on a Tree\u3011"
    },
    {
        "content": "\u9898\u610f\uff1a\u627e\u51fa\u4e09\u4e2a\u70b9\uff0c\u4f7f\u5f97\u4e24\u4e24\u70b9\u4e4b\u95f4\u8def\u5f84\u4e2d\u8fb9\u7684\u5e76\u7684\u96c6\u5408\u5c3d\u91cf\u5927\u3002\n\n\u628a\u5176\u4e2d\u4e00\u4e2a\u70b9\u770b\u6210\u6839\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u53d1\u73b0\uff0c\u5176\u4e2d\u4e00\u4e2a\u70b9\u4e00\u5b9a\u662f\u4e00\u6761\u76f4\u5f84\u3002\n\n\u4e3a\u4ec0\u4e48?\n\n\u7531\u4e8e\u662f\u5e76\u7684\u5173\u7cfb\uff0c\u6211\u4eec\u4e0d\u7528\u518d\u8003\u8651\u94fe\u53e0\u4e00\u8d77\u7684\u60c5\u51b5\uff0c\u76f8\u53cd\uff0c\u957f\u7684\u94fe\u8d21\u732e\u4e00\u5b9a\u5927\uff0c\u6240\u4ee5\u6211\u4eec\u4f1a\u5148\u9009\u76f4\u5f84\u3002\n\n\u7136\u540e\u628a\u76f4\u5f84\u4e0a\u7684\u70b9\u90fd\u6807\u8bb0\u51fa\u6765\uff0c\u53bb\u6389\u8fd9\u4e9b\u70b9\u7684\u8d21\u732e\uff0c\u4ee5\u76f4\u5f84\u5176\u4e2d\u4e00\u4e2a\u70b9\u4e3a\u6839\uff0c\u518d\u627e\u51fa\u79bb\u76f4\u5f84\u8fd9\u6761\u94fe\u6700\u8fdc\u7684\u70b9\uff0c\u6ca1\u4e86\u3002\n\n\n\n```\n#include<bits/stdc++.h>\n#define pr putchar\n#define kong putchar(' ')\n#define huan putchar('\\n')\nusing namespace std;\n\nvoid read(int &x)\n{\n\tx=0;register char ch=getchar();int pd=1;\n\twhile(ch<'0'||ch>'9'){if(ch=='-')pd=-pd;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();}\n\tx*=pd;\n}\n\nvoid write(int x)\n{\n\tif(x<0)x=-x,putchar('-');\n\tif(x<10)pr(x+'0');\n\telse write(x/10),pr(x%10+'0');\n}\n\nvoid wrl(int x)\n{\n\twrite(x);\n\thuan;\n}\n\nvoid wrs(int x)\n{\n\twrite(x);\n\tkong;\n}\n\nconst int N=1e6+233;\nint n;\nint h[N],vis[N],deep[N],k,mx;\nint ans,t,f[N],a,b;\nstruct dd\n{\n\tint end,nt;\n}e[1<<21];\ninline void add(int begin,int end)\n{\n\t++t;\n\te[t].end=end;\n\te[t].nt=h[begin];\n\th[begin]=t;\n}\n\nvoid dfs(int x,int fa)\n{\n\tif(vis[x])deep[x]=1;\n\tif(deep[x]>deep[k]&&x!=a&&x!=b)k=x,mx=deep[x];\n\tfor(register int i=h[x];i;i=e[i].nt)\n\t{\n\t\tint u=e[i].end;\n\t\tif(u==fa)continue;\n\t\tf[u]=x;\n\t\tdeep[u]=deep[x]+1;\n\t\tdfs(u,x);\n\t}\n}\nint main()\n{\n\tint x,y;\n\tread(n);\n\tfor(register int i=1;i<n;++i)\n\t{\n\t\tread(x);\n\t\tread(y);\n\t\tadd(x,y);\n\t\tadd(y,x);\n\t}\n\tfor(register int i=1;i<=n;++i)f[i]=0;\n\tdfs(1,0);\n\ta=k;\n\tvis[a]=1;\n\tk=0;\n\tfor(register int i=1;i<=n;++i)f[i]=0;\n\tdfs(a,0);\n\tb=k;\n\tint now=b;\n\tans=mx-1;\n\twhile(now)\n\t{\n\t\tvis[now]=1;\n\t\tnow=f[now];\n\t}\n\tk=0;\n\tdfs(a,0);\n\tans+=mx-1;\n\t\n\tcout<<ans<<endl<<a<<\" \"<<b<<\" \"<<k<<endl;\n\treturn 0;\n}\n\n\n```\n\n",
        "postTime": 1579737323,
        "uid": 87026,
        "name": "\u4e24\u5e74\u6253\u94c1",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1294F \u3010Three Paths on a Tree\u3011"
    },
    {
        "content": "[\u4f20\u9001\u95e8\uff08\u6d1b\u8c37\uff09](https://www.luogu.com.cn/problem/CF1294F)\n\n\u770b\u5230\u5927\u4f6c\u4eec\u90fd\u662f\u7528\u7684 $O(n)$ \u7684\u505a\u6cd5\uff0c\u672c\u849f\u84bb\u4e0d\u4f1a\uff0c\u5c31\u6309\u5408\u60c5\u5408\u7406\u7684\u601d\u8def\u5199\u4e86\u4e00\u4e2a $O(n\\log n)$ \u7684\u505a\u6cd5\u3002\n\n\u9996\u5148\u53ef\u4ee5\u786e\u5b9a\uff0c\u5176\u4e2d\u7684\u4e24\u4e2a\u70b9\u80af\u5b9a\u662f\u76f4\u5f84\u7684\u4e24\u4e2a\u7aef\u70b9\u3002\u611f\u6027\u7406\u89e3\u4e00\u4e0b\uff0c\u5982\u679c\u4e0d\u662f\u7684\u8bdd\uff0c\u90a3\u4e48\u628a\u5176\u4e2d\u7684\u70b9\u6362\u6210\u76f4\u5f84\u7684\u4e00\u4e2a\u7aef\u70b9\uff0c\u7b54\u6848\u4e00\u5b9a\u4e0d\u4f1a\u66f4\u5dee\uff0c\u56e0\u4e3a\u76f4\u5f84\u5df2\u7ecf\u662f\u6811\u4e0a\u7684\u6700\u957f\u8def\u5f84\u4e86\u3002\u7136\u540e\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u5728\u6811\u4e0a\u627e\u5230\u4e00\u4e2a\u70b9\uff0c\u4f7f\u5b83\u5230\u76f4\u5f84\u7684\u4e24\u4e2a\u7aef\u70b9\u7684\u8def\u5f84\u548c\u76f4\u5f84\u7684\u5e76\u6240\u7ecf\u8fc7\u7684\u8fb9\u6570\u6700\u591a\u3002\u6211\u4eec\u8003\u8651\u4e00\u4e2a\u7b80\u5355\u7684\u4e0d\u80fd\u7b97\u5bb9\u65a5\u7684\u5bb9\u65a5\u3002\n\n![\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0](https://img-blog.csdnimg.cn/6fd4ceeca3044eb796ef84ecca964a85.png)\n\u62ff\u8fd9\u68f5\u6811\u6765\u8bf4\uff0c\u5047\u5982\u76f4\u5f84\u7684\u4e24\u4e2a\u7aef\u70b9\u662f $1$ \u548c $6$\uff0c\u6211\u4eec\u8981\u627e $5$ \u8fd9\u4e2a\u70b9\uff0c\u90a3\u4e48\u5206\u522b\u8bb0\u5f55\u4e0b\u6765\u76f4\u5f84\u7684\u4e24\u4e2a\u7aef\u70b9\u5230\u5176\u4f59\u70b9\u7684\u8ddd\u79bb\uff0c\u7136\u540e\u6211\u4eec\u5c06\u5176\u4e2d\u7684\u4e00\u4e2a\u7aef\u70b9\u8bbe\u4e3a\u6839\uff0c\u628a\u5176\u4f59\u70b9\u7684\u6df1\u5ea6\u548c\u6c42 $lca$ \u7528\u7684\u6570\u7ec4\u9884\u5904\u7406\u51fa\u6765\u3002\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u6c42\u51fa $5$ \u548c\u6df1\u5ea6\u8f83\u6df1\u7684\u90a3\u4e2a\u7aef\u70b9\u7684 $lca$\uff0c\u7136\u540e\u5c31\u662f\u4e00\u4e2a\u5c0f\u7684\u5bb9\u65a5\uff0c\u5047\u8bbe\u4e24\u4e2a\u7aef\u70b9\u5230 $5$ \u7684\u8ddd\u79bb\u5206\u522b\u4e3a $dis1$ \u548c $dis2$\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f $dis1+dis2+dep[5]-dep[lca]$\u3002\u6240\u4ee5\u8fd9\u9053\u9898\u7684\u8fc7\u7a0b\u5c31\u53d8\u6210\u4e86\u6c42\u51fa\u6811\u7684\u76f4\u5f84\uff0c\u7136\u540e\u5bf9\u4e8e\u4e24\u4e2a\u7aef\u70b9\u5206\u522b\u6c42\u51fa\u5230\u5176\u4f59\u70b9\u7684\u8ddd\u79bb\uff0c\u7136\u540e\u6839\u636e\u4e0a\u9762\u7684\u90a3\u4e2a\u5f0f\u5b50\u6c42\u51fa\u6bcf\u4e00\u4e2a\u70b9\u7684\u7b54\u6848\uff0c\u6700\u540e\u7684\u7b54\u6848\u5c31\u662f\u6700\u5927\u503c\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define re register\n#define ll long long\n#define rep(a,b,c)  for(re int a(b) ; a<=c ; ++a)\n#define drep(a,b,c) for(re int a(b) ; a>=c ; --a)\nusing namespace std;\ninline int read(){\n    int x=0,f=1;char ch=getchar();\n    while(ch<'0'||ch>'9'){if(ch == '-') f=-1 ; ch=getchar();}\n    while(ch>='0'&&ch<='9'){x=(x<<1)+(x<<3)+(ch^48) ; ch=getchar();}\n    return x*f;\n}\nconst int M = 2e5+10;\nint head[M],dep[M],f[M][25],dis1[M],dis2[M];\nint n,cnt,rt1,rt2,po,maxlen,ans;\nstruct edge{\n\tint to,nxt;\n}e[M<<1];\ninline void add(int u,int v){\n\te[++cnt].to = v;\n\te[cnt].nxt = head[u];\n\thead[u] = cnt;\n}\nvoid dfs(int u,int fa){\n\tdep[u] = dep[fa] + 1;\n\tf[u][0] = fa;\n\trep(i,1,20) f[u][i] = f[f[u][i-1]][i-1];\n\tfor(re int i(head[u]) ; i ; i=e[i].nxt){\n\t\tint v = e[i].to;\n\t\tif(v == fa) continue;\n\t\tdfs(v,u);\n\t}\n}\ninline int getlca(int x,int y){\n\tif(dep[x] < dep[y]) swap(x,y);\n\tdrep(i,20,0) if(dep[f[x][i]] >= dep[y]) x = f[x][i];\n\tif(x == y) return x;\n\tdrep(i,20,0) if(f[x][i] != f[y][i]) x = f[x][i],y = f[y][i];\n\treturn f[x][0];\n}\nvoid dfs1(int u,int fa){\n\tif(dis1[u] > maxlen){\n\t\tmaxlen = dis1[u];\n\t\trt1 = u;\n\t}\n\tfor(re int i(head[u]) ; i ; i=e[i].nxt){\n\t\tint v = e[i].to;\n\t\tif(v == fa) continue;\n\t\tdis1[v] = dis1[u] + 1;\n\t\tdfs1(v,u);\n\t}\n}\nvoid dfs2(int u,int fa){\n\tif(dis1[u] > maxlen){\n\t\tmaxlen = dis1[u];\n\t\trt2 = u;\n\t}\n\tfor(re int i(head[u]) ; i ; i=e[i].nxt){\n\t\tint v = e[i].to;\n\t\tif(v == fa) continue;\n\t\tdis1[v] = dis1[u] + 1;\n\t\tdfs2(v,u);\n\t}\n}\nvoid dfs3(int u,int fa){\n\tfor(re int i(head[u]) ; i ; i=e[i].nxt){\n\t\tint v = e[i].to;\n\t\tif(v == fa) continue;\n\t\tdis2[v] = dis2[u] + 1;\n\t\tdfs3(v,u);\n\t}\n}\nsigned main(){\n\tn = read();\n\trep(i,1,n-1){\n\t\tint u = read(),v = read();\n\t\tadd(u,v),add(v,u);\n\t}\n\tdfs1(1,0);\n\tmemset(dis1,0,sizeof(dis1));\n\tmaxlen = 0;\n\tdfs2(rt1,0);\n\tdfs3(rt2,0);\n\tdfs(rt1,0);\n\trep(i,1,n){\n\t\tif(i == rt1 || i == rt2) continue;\n\t\tint s1 = getlca(i,rt1),s2 = getlca(i,rt2);\n\t\tint lca = (dep[s1] > dep[s2] ? s1 : s2);\n\t\tif(dis1[i]+dis2[i]+dep[lca]-dep[i] > ans){\n\t\t\tans = dis1[i]+dis2[i]-abs(dep[i]-dep[lca]);\n\t\t\tpo = i;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",ans);\n\tprintf(\"%d %d %d\\n\",rt1,rt2,po);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1667388679,
        "uid": 226367,
        "name": "glorious_dream",
        "ccfLevel": 4,
        "title": "CF1294F \u9898\u89e3"
    },
    {
        "content": "# \u9898\u610f\n\n\u7ed9\u51fa\u4e00\u68f5\u6811\uff0c\u8ba9\u4f60\u627e\u51fa\u6811\u4e0a\u7684 $3$ \u4e2a\u70b9\uff0c\u4f7f\u5f97\u8fd9\u4e09\u4e2a\u70b9\u7684\u8def\u5f84\u4e4b\u5e76\u6240\u5305\u542b\u7684\u8fb9\u6700\u5927\u3002\n\n# \u601d\u8def\n\n\u8bfb\u61c2\u9898\u610f\u540e\u5f88\u81ea\u7136\u7684\u4e00\u4e2a\u60f3\u6cd5\u5c31\u662f\u627e\u51fa\u6811\u7684\u4e00\u6761\u76f4\u5f84\uff0c\u9009\u53d6\u76f4\u5f84\u7684\u4e24\u4e2a\u7aef\u70b9\uff0c\u7136\u540e\u518d\u8d2a\u5fc3\u7684\u9009\u62e9\u7b2c\u4e09\u4e2a\u70b9\uff0c\u8fd9\u6837\u5c31\u80fd\u6700\u5927\u5316\u7b54\u6848\u4e86\u3002\n\n\u8003\u8651\u611f\u6027\u7406\u89e3\uff0c\u7531\u4e8e\u4e09\u4e2a\u70b9\u7684\u8def\u5f84\u4e4b\u5e76\u5176\u5b9e\u5c31\u662f\u4e00\u6761\u94fe\u52a0\u4e0a\u94fe\u4e0a\u7684\u67d0\u4e00\u4e2a\u70b9\u5f80\u5916\u5ef6\u4f38\u51fa\u53bb\u7684\u4e00\u6761\u94fe\uff0c\u6240\u4ee5\u60f3\u8981\u6700\u5927\u5316\u7b54\u6848\uff0c\u4f7f\u8fd9\u4e2a\u94fe\u6700\u957f\u4e00\u5b9a\u4f1a\u66f4\u4f18\u3002\n\n\u4e0b\u9762\u662f\u8bc1\u660e\uff08\u4e25\u4e0d\u4e25\u8c28\u6211\u4e0d\u77e5\u9053\uff09\uff0c\u5047\u8bbe\u94fe\u7684\u4e24\u4e2a\u7aef\u70b9\u4e3a $u,v$ \uff0c\u8bb0\u94fe\u7684\u957f\u5ea6\u4e3a $\\operatorname{dis}(u,v)$\uff0c\u6211\u4eec\u5047\u8bbe\u4ece\u94fe\u4e0a\u4e00\u70b9 $x$ \u5411\u5916\u5ef6\u4f38\u51fa\u4e00\u6761\u94fe\uff0c\u53e6\u4e00\u4e2a\u7aef\u70b9\u662f $w$\uff0c\u5219\u7b54\u6848\u5c31\u662f$\\operatorname{dis}(u,v)+\\operatorname{dis}(x,w)$\u3002\n\n\u8003\u8651\u53cd\u8bc1\u6cd5\uff0c\u6211\u4eec\u5047\u8bbe $u$ \u5230 $v$ \u7684\u94fe\u662f\u6811\u7684\u4e00\u6761\u76f4\u5f84\uff0c\u4e14 $\\operatorname{dis}(x,w)$ \u4e3a\u5728\u6ee1\u8db3 $x$ \u5728 $u$ \u5230 $v$ \u7684\u94fe\u4e0a\u7684\u6700\u5927\u503c\uff0c\u5982\u679c\u8fd9\u4e2a\u7b54\u6848\u4e0d\u662f\u6700\u5927\u7684\uff0c\u5219\u4e00\u5b9a\u4f1a\u51fa\u73b0\u53e6\u5916\u4e00\u6761\u94fe\uff0c\u4f7f\u5f97$\\operatorname{dis}(x',w')>\\operatorname{dis}(x,w)$\uff08$x',w'$ \u542b\u4e49\u540c\u4e0a\uff09\u3002 \n\u56e0\u4e3a\u6211\u4eec\u5df2\u7ecf\u627e\u51fa\u76f4\u5f84\u4e86\uff0c\u5176\u4ed6\u94fe\u4e00\u5b9a\u4e0d\u4f1a\u6bd4\u76f4\u5f84\u957f\uff0c\u8981\u60f3\u7b54\u6848\u66f4\u5927\uff0c\u8fd9\u4e2a\u5ef6\u4f38\u51fa\u53bb\u7684\u94fe\u4e00\u5b9a\u8981\u66f4\u957f\u3002\n\n\u540c\u65f6\uff0c\u7531\u4e8e\u7b54\u6848\u66f4\u4f18\uff0c\u6240\u4ee5\u6709\uff1a\n\n$$\\operatorname{dis}(x',w')+\\operatorname{dis}(x',u')+\\operatorname{dis}(x',v')>\\operatorname{dis}(x,w)+\\operatorname{dis}(x,u)+\\operatorname{dis}(x,v)$$\n\n\u8fd9\u65f6\u6211\u4eec\u53ef\u4ee5\u4e0d\u59a8\u8bbe $\\operatorname{dis}(x,w)\\le\\operatorname{dis}(x,u)\\le \\operatorname{dis}(x,v)$(\u4e0d\u6ee1\u8db3\u7684\u8bdd\u4ea4\u6362\u4e00\u4e0b\u5373\u53ef)\u3002\u8fd9\u65f6\u6d4f\u89c8\u4e0a\u9762\u4e09\u4e2a\u6761\u4ef6\uff0c\n\u6211\u4eec\u4f1a\u53d1\u73b0 \uff1a$\\operatorname{dis}(x',w')+\\operatorname{dis}(x',u')> \\operatorname{dis}(u,v)$\uff0c\u8fd9\u4e0e\u9898\u8bbe\u77db\u76fe\uff0c\u6240\u4ee5\u5f97\u51fa\u4e00\u5b9a\u662f\u53d6\u76f4\u5f84\u6700\u4f18\u3002\n\n# \u4ee3\u7801\n\nwa 39 \u7684\u8bdd\u8bb0\u5f97\u5224\u4e00\u4e0b\u6811\u662f\u4e00\u4e2a\u94fe\u7684\u60c5\u51b5\u3002\n\n```cpp\n#include<iostream>\n#include<cstring>\n#include<algorithm>\n#include<cstdio>\n#include<vector>\n#include<set>\n#include<functional>\n#include<map>\n#include<queue>\n#include<bitset>\n#include<cmath>\n#include<unordered_map>\n#include<array>\n#include<iomanip>\n#include<numeric>\nusing namespace std;\ntemplate<typename T>\ninline bool cmax(T& a,const T& b){return a<b?a=b,1:0;}\ntemplate<typename T>\ninline bool cmin(T& a,const T& b){return b<a?a=b,1:0;}\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef unsigned long long ull;\ntypedef unsigned int ui;\ntypedef vector<int> vi;\ntypedef vector<vector<int> > vii;\n#define X first\n#define Y second\nconst int mod=998244353;\nconst ll INF=0x3f3f3f3f3f3f3f3f;\nint main()\n{\n\tios_base::sync_with_stdio(0),cin.tie(0),cout.tie(0);\n\tint n;\n\tcin>>n;\n\tvii e(n+1);\n\tint u,v;\n\tfor(int i=1;i<n;i++)cin>>u>>v,e[u].emplace_back(v),e[v].emplace_back(u);\n\tfunction<void(int,int)>dfs,dfs2;\n\tvi d(n+1),pa(n+1);\n\tint k1,k2=0,id=0;\n\tdfs=[&](int u,int  fa)\n\t{\n\t\tif(d[id]<d[u])id=u;\n\t\tpa[u]=fa;\n\t\tfor(const int& v:e[u])\n\t\t{\n\t\t\tif(v==fa)continue;\n\t\t\td[v]=d[u]+1;\n\t\t\tdfs(v,u);\n\t\t}\n\t};\n\tvector<bool>book(n+1);\n\tdfs(1,0),k1=id,d[k1]=0,dfs(k1,0),k2=id;\n\tint len=d[k2];\n\tfor(int u=k2;u;u=pa[u])\n\t{\n\t\tbook[u]=1;\n\t}\n\tfill(d.begin(),d.end(),0);\n\tdfs2=[&](int u,int  fa)\n\t{\n\t\tfor(const int& v:e[u])\n\t\t{\n\t\t\tif(v==fa||book[v])continue;\n\t\t\td[v]=d[u]+1;\n\t\t\tdfs2(v,u);\n\t\t}\n\t};\n\tfor(int u=k2;u;u=pa[u])\n\t{\n\t\tdfs2(u,0);\n\t}\n\tint w=max_element(d.begin(),d.end())-d.begin();\n\t//cout<<len<<' '<<w<<'\\n';\n\tint ans=len+d[w];\n\tif(w==0)w=pa[k2];\n\tcout<<ans<<'\\n';\n\tcout<<k1<<' '<<k2<<' '<<w;\n\treturn 0;\n}\n\n```\n",
        "postTime": 1659100836,
        "uid": 571229,
        "name": "__stick",
        "ccfLevel": 7,
        "title": "CF1294F"
    },
    {
        "content": "## \u9898\u610f\n\n\u5c31\u662f\u8ba9\u4f60\u6c42\u4e09\u4e2a\u70b9\uff0c\u4ed6\u4eec\u7684\u8ddd\u79bb\u5e76\u6700\u5927\u3002\n\n## \u601d\u8def\n\n\u5982\u679c\u5c06\u4e00\u4e2a\u70b9\u89c4\u5b9a\u4e3a\u6839\u7684\u8bdd\uff0c\u5176\u4e2d\u4e00\u4e2a\u8981\u9009\u7684\u70b9\u4e00\u5b9a\u662f\u76f4\u5f84\u3002\n\n\u56e0\u4e3a\u662f\u6c42\u5e76\uff0c\u957f\u7684\u94fe\u8d21\u732e\u4e00\u5b9a\u5927\uff0c\u5c31\u80af\u5b9a\u4f1a\u9009\u76f4\u5f84\u3002\n\n\u8fd9\u5c31\u662f\u4e24\u4e2a\u70b9\u4e86\uff0c\u8fd8\u6709\u4e00\u4e2a\u70b9\u5c31\u4ece\u8fd9\u6761\u94fe\u627e\u4e00\u4e2a\u6700\u8fdc\u7684\u70b9\u5c31\u53ef\u4ee5\u4e86\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>//\u795d\u5927\u5bb6\u5b66\u4e60\u6109\u5feb\uff01\n\nusing namespace std;\n\nconst int maxn=2e5+10;\nstruct edge{\n\tint to,nxt;\n}e[maxn<<1];\nint head[maxn];\nbool vis[maxn];\nint dep[maxn],fa[maxn];\nint k,mx,s,t,cnt,ans=0;\n\ninline void init(){//\u4e2a\u4eba\u4e60\u60ef\u95ee\u9898\n\tmemset(head,-1,sizeof(head));\n\tcnt=0;\n}\nvoid add(int u,int v){\n\te[++cnt].to=v;\n\te[cnt].nxt=head[u];\n\thead[u]=cnt;\n}\n\nvoid dfs(int u,int f){\n\tif(vis[u]) dep[u]=1;\n\tif(dep[u]>dep[k]&&u!=s&&u!=t){\n\t\tk=u;\n\t\tmx=dep[u];\n\t}\n\tfor(int i=head[u];i!=-1;i=e[i].nxt){\n\t\tint v=e[i].to;\n\t\tif(v==f) continue;\n\t\tfa[v]=u;\n\t\tdep[v]=dep[u]+1;\n\t\tdfs(v,u);\n\t}\n}\n\nvoid solve(){\n\tfor(int i=1;i<=n;i++) fa[i]=0;\n\tdfs(1,0);\n\ts=k;\n\tvis[s]=1;\n\tfor(int i=1;i<=n;i++) fa[i]=0;\n\tk=0;\n\tdfs(s,0);\n\tt=k;\n\tint now=t;\n   ans=mx-1;\n\twhile(now){\n\t\tvis[now]=1;\n\t\tnow=fa[now];\n\t}\n\t\n\tk=0;\n\tdfs(s,0);\n\tans+=mx-1;\n}\n\nint main(){\n\t\n\tinit();\n\t\n\tint n;\n\t\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<n;i++){\n\t\tint u,v;\n\t\tscanf(\"%d %d\",&u,&v);\n\t\tadd(u,v);\n\t\tadd(v,u);\n\t}\n\t\n   solve();\n\t\n\tprintf(\"%d\\n%d %d %d\",ans,s,t,k);\n\t\n\treturn 0;\n}\n\n\n```\n",
        "postTime": 1639553122,
        "uid": 234469,
        "name": "hxyqwq",
        "ccfLevel": 6,
        "title": "CF1294F"
    },
    {
        "content": "\u5ba3\u4f20\u535a\u5ba2 $\\to$ [link](https://blog.csdn.net/BWzhuzehao/article/details/118368428)\n\n\u8fd9\u662f\u4e00\u9053\u601d\u7ef4\u9898\u3002\n\n\u672c\u6587\u7ea6\u5b9a\uff1a$u \\to v$ \u8868\u793a\u4ece $u$ \u5230 $v$ \u7684\u8def\u5f84\u3002\n\n---------\n\n\u9996\u5148\u7b80\u5316\u4e00\u4e0b\u9898\u610f\uff1a\u7ed9\u51fa\u4e00\u68f5\u6811\uff0c\u6c42\u51fa\u4e09\u4e2a\u70b9\u4f7f\u5f97\u4e09\u4e2a\u70b9\u4e4b\u95f4\u4e24\u4e24\u8def\u5f84\u5e76\u7684\u957f\u5ea6\u6700\u5927\u3002\n\n\u663e\u7136\u6211\u4eec\u4e0d\u80fd\u679a\u4e3e\u8fd9\u4e09\u4e2a\u70b9\uff0c\u590d\u6742\u5ea6 $O(n^3)$ \u8fc7\u5927\uff0c\u4e0d\u80fd\u63a5\u53d7\u3002\n\n\u505a\u8fd9\u9053\u9898\u9700\u8981\u4e00\u4e2a\u91cd\u8981\u7ed3\u8bba\uff1a\u6811\u7684\u76f4\u5f84\u7684\u4e24\u4e2a\u7aef\u70b9\u4e00\u5b9a\u662f\u8981\u88ab\u9009\u4e2d\u7684\u3002\n\n\u7b80\u5355\u8bc1\u660e\uff1a\n\n\u5047\u8bbe\u6811\u7684\u76f4\u5f84\u7684\u4e24\u4e2a\u7aef\u70b9\u662f $u_1,v_1$\uff0c\u9009\u7684\u662f $u,v,w$ \u4e09\u4e2a\u70b9\uff0c$u \\to v$ \u5e76\u4e0d\u662f\u6811\u7684\u76f4\u5f84\u3002\n\n\u8bbe $u \\to v$ \u548c $u \\to w$ \u4ea4\u4e8e $P$ \u70b9\uff0c\u5982\u679c $u_1 \\to v_1$ \u4e5f\u7ecf\u8fc7 $P$ \u70b9\uff0c\u90a3\u4e48\u663e\u7136\u5c06 $u,v,w$ \u4e2d\u7684\u5176\u4e2d\u4e24\u4e2a\u70b9\u6362\u6210\u76f4\u5f84\u4e00\u5b9a\u66f4\u4f18\u3002\n\n\u5982\u679c $u_1 \\to v_1$ \u4e0d\u7ecf\u8fc7 $P$ \u70b9\uff0c\u90a3\u4e48\u5c31\u4f1a\u51fa\u73b0\u5982\u4e0b\u56fe\u51e0\u79cd\u60c5\u51b5\uff1a\n\n1. \u6811\u7684\u76f4\u5f84\u5728 $P$ \u7684\u7b2c\u56db\u68f5\u5b50\u6811\u4e0a\uff1a\n\n\u60c5\u51b5 1\uff1a\n\n![\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0](https://img-blog.csdnimg.cn/20210630200859924.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JXemh1emVoYW8=,size_16,color_FFFFFF,t_70)\n\n\u4f46\u663e\u7136\u8fd9\u4e2a\u65f6\u5019 $u_1 \\to v_1$ \u6839\u672c\u5c31\u4e0d\u662f\u76f4\u5f84\u3002\n\n\u60c5\u51b5 2\uff1a\n\n![\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0](https://img-blog.csdnimg.cn/20210630201324937.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JXemh1emVoYW8=,size_16,color_FFFFFF,t_70)\n\n\u5bf9\u4e8e\u8fd9\u4e00\u79cd\u60c5\u51b5\uff0c\u5927\u53ef\u4ee5\u628a $u,v,w$ \u4e2d\u7684\u5176\u4e2d\u4e00\u4e2a\u70b9\u6362\u6210 $u_1,v_1$\uff0c\u56e0\u4e3a\u8fd9\u4e48\u505a\u4e00\u5b9a\u80fd\u591f\u589e\u52a0\u8def\u5f84\u957f\u5ea6\u3002\n\n\u65e2\u7136\u6362\u4e86\u4e00\u4e2a\u70b9\u80fd\u591f\u589e\u52a0\u8def\u5f84\u957f\u5ea6\uff0c\u5047\u8bbe\u73b0\u5728\u7684\u70b9\u662f $u_1,v,w$\uff0c\u90a3\u4e48\u5982\u679c\u628a $v$ \u6362\u6210 $v_1$ \u4e5f\u80fd\u591f\u589e\u52a0\u8def\u5f84\u957f\u5ea6\uff08\u5426\u5219\u5c31\u4e0d\u662f\u6811\u7684\u76f4\u5f84\u4e86\uff09\n\n\u7efc\u4e0a\uff0c\u539f\u547d\u9898\u6210\u7acb\u3002\n\n---------\n\n\u5728\u8bc1\u660e\u4e86\u8fd9\u4e2a\u7ed3\u8bba\u4e4b\u540e\uff0c\u90a3\u4e48 $u \\to v$ \u5c31\u4e00\u5b9a\u662f\u76f4\u5f84\u4e86\u3002\n\n\u600e\u4e48\u786e\u5b9a $w$ \u5462\uff1f\u770b\u56fe\uff1a\n\n![\u5728\u8fd9\u91cc\u63d2\u5165\u56fe\u7247\u63cf\u8ff0](https://img-blog.csdnimg.cn/2021063020165413.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L0JXemh1emVoYW8=,size_16,color_FFFFFF,t_70)\n\n\u5bf9\u4e8e $u \\to v$ \u4e0a\u7684\u6bcf\u4e00\u4e2a\u70b9 $P$ \u800c\u8a00\uff08\u9664\u53bb $u,v$\uff09\uff0c\u6211\u4eec\u5c06\u5176\u65c1\u8fb9\u7684\u51e0\u68f5\u5b50\u6811\u62ce\u51fa\u6765\uff0c\u76f4\u63a5\u5728\u8fd9\u51e0\u68f5\u5b50\u6811\u4e0a\u9762\u627e\u51fa\u79bb $P$ \u6700\u8fdc\u7684\u70b9\u5c31\u53ef\u4ee5\u4e86\u3002\n\n---------\n\n\u4ee3\u7801\u91cc\u9762\u9700\u8981\u6ce8\u610f\u7684\u7ec6\u8282\uff1a\n\n- \u5c0f\u5fc3\u94fe\u7684\u6570\u636e\uff0c\u7ec6\u8282\u5904\u7406\u4e0d\u5f53\u4e00\u6761\u94fe\u5c31\u4f1a\u628a\u4f60\u5361\u6210 $w=v$ \u6216\u8005 $w=u$\u3002\n\nCode\uff1a[GitHub CodeBase-of-Plozia CF1294F Three Paths on a Tree.cpp](https://github.com/Plozia/CodeBase-of-Plozia/blob/main/Codeforces%20%E5%88%B7%E9%A2%98%E5%90%88%E9%9B%86/CF1294F%20Three%20Paths%20on%20a%20Tree.cpp)\n\n```cpp\n/*\n========= Plozia =========\n    Author:Plozia\n    Problem:CF1294F Three Paths on a Tree\n    Date:2021/6/30\n========= Plozia =========\n*/\n\n#include <bits/stdc++.h>\n\ntypedef long long LL;\nconst int MAXN = 2e5 + 5;\nint n, dep[MAXN], u, v, w, Head[MAXN], cnt_Edge = 1, f[MAXN], Root = 0, ans, fa[MAXN];\nint Path[MAXN], cnt;\nbool book[MAXN];\nstruct node { int to, Next; } Edge[MAXN * 2 + 1];\n\nint Read()\n{\n    int sum = 0, fh = 1; char ch = getchar();\n    for (; ch < '0' || ch > '9'; ch = getchar()) fh -= (ch == '-') << 1;\n    for (; ch >= '0' && ch <= '9'; ch = getchar()) sum = sum * 10 + (ch ^ 48);\n    return sum * fh;\n}\nint Max(int fir, int sec) { return (fir > sec) ? fir : sec; }\nint Min(int fir, int sec) { return (fir < sec) ? fir : sec; }\nvoid add_Edge(int x, int y) { ++cnt_Edge; Edge[cnt_Edge] = (node){y, Head[x]}; Head[x] = cnt_Edge; }\n\nvoid dfs(int now, int father, int Tag)\n{\n    if (f[now] > ans) { Root = now; ans = f[now]; }\n    if (Tag) fa[now] = father;\n    for (int i = Head[now]; i; i = Edge[i].Next)\n    {\n        int u = Edge[i].to;\n        if (u == father) continue ;\n        f[u] = f[now] + 1;\n        dfs(u, now, Tag);\n    }\n}\n\nvoid dfs2(int now, int father, int depth)\n{\n    dep[now] = depth;\n    for (int i = Head[now]; i; i = Edge[i].Next)\n    {\n        int u = Edge[i].to;\n        if (u == father || book[u]) continue ;\n        dfs2(u, now, depth + 1);\n    }\n}\n\nint main()\n{\n    n = Read();\n    for (int i = 1; i < n; ++i)\n    {\n        int x = Read(), y = Read();\n        add_Edge(x, y); add_Edge(y, x);\n    }\n    f[Root = 1] = 0; dfs(1, 0, 0); ans = 0; u = Root;\n    f[Root] = 0; dfs(Root, 0, 1); v = Root;\n    for (int i = v; i != u; i = fa[i]) book[i] = 1, dep[i] = -1;\n    book[u] = 1, dep[u] = -1;\n    for (int i = fa[v]; i != u; i = fa[i]) { dep[i] = 0; dfs2(i, 0, 0); }\n    int t = -1;\n    for (int i = 1; i <= n; ++i)\n        if (dep[i] > t) { t = dep[i]; w = i; }\n    printf(\"%d\\n%d %d %d\\n\", ans + t, u, v, w); return 0;\n}\n```",
        "postTime": 1632748157,
        "uid": 134000,
        "name": "Plozia",
        "ccfLevel": 7,
        "title": "CF1294F Three Paths on a Tree \u9898\u89e3"
    },
    {
        "content": "~~\u8fd9\u9898\u597d\u50cf\u4e0d\u6c42\u76f4\u5f84\u4e5f\u53ef\u4ee5\u505a...~~\n___\n\u5982\u679c\u9898\u76ee\u6c42\u7684\u662f\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u6700\u957f\u8def\u5f84\uff0c\u90a3\u5c31\u53ef\u4ee5\u76f4\u63a5\u6c42\u76f4\u5f84(~~\u5e9f\u8bdd~~)\u3002\u4e09\u4e2a\u70b9\u53ea\u9700\u8981\u6539\u4e00\u70b9\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u9898\u610f\u53ef\u4ee5\u8f6c\u5316\u6210\u6c42\u4e09\u6761\u6709\u4e00\u5171\u540c\u7aef\u70b9\u94fe\u7684\u957f\u5ea6\u7684\u548c\u6700\u5927\u503c\u548c\u6b64\u65f6\u7684\u53e6\u5916\u4e09\u4e2a\u7aef\u70b9\uff0c\u4e8e\u662f\u53ef\u4ee5\u7167\u642c $DP$ \u6c42\u76f4\u5f84\u7684\u65b9\u6cd5~~\u6211\u4ee3\u7801\u5c31\u662f\u4ece[SP1437](https://www.luogu.com.cn/problem/SP1437)\u590d\u5236\u6765\u6539\u7684~~\uff0c\u8bb0\u5f55\u6700\u957f\u94fe\u3001\u6b21\u957f\u94fe\u548c\u6b21\u6b21\u957f\u94fe\u7684\u957f\u5ea6\u5e76\u7ef4\u62a4\u548c\u7684\u6700\u5927\u503c~~\u7136\u800c\u8fde\u6837\u4f8b\u90fd\u8fc7\u4e0d\u4e86...~~\u3002\n\n\u4f1a $WA$ \u662f\u56e0\u4e3a\u8fd9\u4e09\u6761\u94fe\u4e2d\u53ef\u80fd\u6709\u4e00\u6761\u662f\u4ece\u7236\u8282\u70b9\u8fde\u8fc7\u6765\u7684\uff0c\u53ea\u8981\u518d\u52a0\u4e00\u904d $DFS$ \u5c31\u80fd\u8fc7\u4e86\uff0c\u6700\u540e\u6ce8\u610f\u5bf9\u4e00\u6761\u94fe\u7684\u60c5\u51b5\u7684\u7279\u5224\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,answ[3],a[400001],a1[400001],a2[200001],u,v,ans,ans1[200001],ans2[200001],ans3[200001],ansn1[200001],ansn2[200001],ansn3[200001];\nint ansa1[200001];\nbool a4[200001],vis[200001];\t\t//\u6781\u5ea6\u90aa\u6559\u7684\u8ff7\u4e4b\u53d8\u91cf\u540d\nvoid abc(int i)\t\t\t\t//\u7b2c\u4e00\u904dDFS\n{\n\ta4[i]=1;\n\tint a3=a2[i];\n\tif(a1[a3]==0)ansn1[i]=i;\n\twhile(a3)\t\t\t//\u90aa\u6559DFS\n\t{\n\t\tif(a4[a[a3]])\n\t\t{\n\t\t\ta3=a1[a3];\n\t\t\tcontinue;\n\t\t}\n\t\tabc(a[a3]);\n\t\tif(ans1[a[a3]]>=ans1[i])//\u5176\u5b9e\u662f\u53ef\u4ee5\u7528\u4f18\u5148\u961f\u5217\u7684\n\t\t{\n\t\t\tans3[i]=ans2[i];\n\t\t\tans2[i]=ans1[i];\n\t\t\tans1[i]=ans1[a[a3]]+1;\n\t\t\tansn3[i]=ansn2[i];\n\t\t\tansn2[i]=ansn1[i];\n\t\t\tansn1[i]=ansn1[a[a3]];\n//\t\t\tansa3[i]=ansa2[i];\n//\t\t\tansa2[i]=ansa1[i];\n\t\t\tansa1[i]=a[a3];\n\t\t}\n\t\telse if(ans1[a[a3]]>=ans2[i])\n\t\t{\n\t\t\tans3[i]=ans2[i];\n\t\t\tans2[i]=ans1[a[a3]]+1;\n\t\t\tansn3[i]=ansn2[i];\n\t\t\tansn2[i]=ansn1[a[a3]];\n//\t\t\tansa3[i]=ansa2[i];\n//\t\t\tansa2[i]=a[a3];\n\t\t}\n\t\telse if(ans1[a[a3]]>=ans3[i])\n\t\t{\n\t\t\tans3[i]=ans1[a[a3]]+1;\n\t\t\tansn3[i]=ansn1[a[a3]];\n//\t\t\tansa3[i]=a[a3];\n\t\t}\n\t\ta3=a1[a3];\n\t}\n}\nvoid dfs(int i,int fa)\t\t\t//\u7b2c\u4e8c\u904dDFS\n{\n\tvis[i]=1;\n\tif(ansa1[fa]!=i)\t\t\t//\u653e\u5728DFS\u524d\u9762\uff0c\u4e0d\u7136\u4f1aWA\n\t{\n\t\tif(ans1[fa]>=ans1[i])\n\t\t{\n\t\t\tans3[i]=ans2[i];\n\t\t\tans2[i]=ans1[i];\n\t\t\tans1[i]=ans1[fa]+1;\n\t\t\tansn3[i]=ansn2[i];\n\t\t\tansn2[i]=ansn1[i];\n\t\t\tansn1[i]=ansn1[fa];\n//\t\t\tansa3[i]=ansa2[i];\n//\t\t\tansa2[i]=ansa1[i];\n\t\t\tansa1[i]=fa;\n\t\t}\n\t\telse if(ans1[fa]>=ans2[i])\n\t\t{\n\t\t\tans3[i]=ans2[i];\n\t\t\tans2[i]=ans1[fa]+1;\n\t\t\tansn3[i]=ansn2[i];\n\t\t\tansn2[i]=ansn1[fa];\n//\t\t\tansa3[i]=ansa2[i];\n//\t\t\tansa2[i]=a[a3];\n\t\t}\n\t\telse if(ans1[fa]>=ans3[i])\n\t\t{\n\t\t\tans3[i]=ans1[fa]+1;\n\t\t\tansn3[i]=ansn1[fa];\n//\t\t\tansa3[i]=a[a3];\n\t\t}\n\t}\n\telse\n\t{\n\t\tif(ans2[fa]>=ans1[i])\n\t\t{\n\t\t\tans3[i]=ans2[i];\n\t\t\tans2[i]=ans1[i];\n\t\t\tans1[i]=ans2[fa]+1;\n\t\t\tansn3[i]=ansn2[i];\n\t\t\tansn2[i]=ansn1[i];\n\t\t\tansn1[i]=ansn2[fa];\n//\t\t\tansa3[i]=ansa2[i];\n//\t\t\tansa2[i]=ansa1[i];\n\t\t\tansa1[i]=fa;\n\t\t}\n\t\telse if(ans2[fa]>=ans2[i])\n\t\t{\n\t\t\tans3[i]=ans2[i];\n\t\t\tans2[i]=ans2[fa]+1;\n\t\t\tansn3[i]=ansn2[i];\n\t\t\tansn2[i]=ansn2[fa];\n//\t\t\tansa3[i]=ansa2[i];\n//\t\t\tansa2[i]=a[a3];\n\t\t}\n\t\telse if(ans2[fa]>=ans3[i])\n\t\t{\n\t\t\tans3[i]=ans2[fa]+1;\n\t\t\tansn3[i]=ansn2[fa];\n//\t\t\tansa3[i]=a[a3];\n\t\t}\n\t}\n\tif(ans1[i]+ans2[i]+ans3[i]>ans)\n\t{\n\t\tans=ans1[i]+ans2[i]+ans3[i];\n\t\tansw[0]=ansn1[i];\n\t\tansw[1]=ansn2[i];\n\t\tansw[2]=ansn3[i];\n\t}\n\tint a3=a2[i];\n\twhile(a3)\t\t\t//\u90aa\u6559DFS*2\n\t{\n\t\tif(vis[a[a3]])\n\t\t{\n\t\t\ta3=a1[a3];\n\t\t\tcontinue;\n\t\t}\n\t\tdfs(a[a3],i);\n\t\ta3=a1[a3];\n\t}\n}\nint main()\n{\n\tans1[0]=-1;\t\t\t//\u9884\u5904\u7406\uff0c\u4e0d\u52a0\u4f1aWA on test 16\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tscanf(\"%d%d\",&u,&v);\n\t\ta[(i<<1)-1]=v;\t\t//\u90aa\u6559\u5b58\u56fe\n\t\ta1[(i<<1)-1]=a2[u];\n\t\ta2[u]=(i<<1)-1;\n\t\ta[i<<1]=u;\t\t//\u90aa\u6559\u5b58\u56fe*2\n\t\ta1[i<<1]=a2[v];\n\t\ta2[v]=i<<1;\n\t}\n\tabc(1);\t\t\t\t//DFS1\n//\tfor(int i=1;i<=n;i++)printf(\"%d %d %d\\n\",ansn1[i],ansn2[i],ansn3[i]);\n\tdfs(1,0);\t\t\t//DFS2\n//\tfor(int i=1;i<=n;i++)printf(\"%d %d %d\\n\",ansn1[i],ansn2[i],ansn3[i]);\n\tif(answ[2]==0)\t\t\t//\u8ff7\u4e4b\u7279\u5224\n\t{\n\t\tif(answ[0]!=1&&answ[1]!=1)answ[2]=1;\n\t\telse if(answ[0]!=2&&answ[1]!=2)answ[2]=2;\n\t\telse answ[2]=3;\n\t}\n\tsort(answ,answ+3);\t\t//\u4e0d\u52a0\u4e5f\u884c\n\tif(answ[0]==0)\t\t\t//\u8ff7\u4e4b\u7279\u5224*2\n\t{\n\t\tansw[0]=1;\n\t\tif(answ[1]==1)\n\t\t{\n\t\t\tif(answ[2]==2)answ[2]=3,answ[1]=2;\n\t\t\telse answ[1]=2;\n\t\t}\n\t}\n\tprintf(\"%d\",ans);\n\tprintf(\"\\n%d %d %d\",answ[0],answ[1],answ[2]);\n\treturn 0;\t\t\t//\u72060\n}\n```",
        "postTime": 1579960541,
        "uid": 44840,
        "name": "123456zmy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1294F \u3010Three Paths on a Tree\u3011"
    },
    {
        "content": "## \u9898\u89e3\uff1a\n\n\u8d2a\u5fc3+\u6811\u3002\n\n\u9996\u5148\u7b80\u5355\u60f3\u4e00\u60f3\u80fd\u53d1\u73b0\uff1a\u7b54\u6848\u5e94\u8be5\u662f\u6811\u7684\u76f4\u5f84\u52a0\u4e0a\u6240\u6709\u4e0d\u5728\u76f4\u5f84\u4e0a\u7684\u8282\u70b9\u4e2d\uff0c\u8ddd\u79bb\u76f4\u5f84\u6700\u957f\u7684\u8ddd\u79bb\u3002\n\n\u90a3\u4e48\u53ea\u9700\u8981\u6a21\u62df\u8fd9\u4e2a\u8fc7\u7a0b\u5c31\u53ef\u4ee5\uff1a\n\n\u5148\u4e24\u6b21DFS\u6c42\u51fa\u6811\u7684\u76f4\u5f84\uff08\u8bb0\u5f55\u8def\u5f84\u957f\u548c\u4e24\u4e2a\u7aef\u70b9\uff09\uff0c\u7136\u540e\u628a\u76f4\u5f84\u4e0a\u6240\u6709\u8282\u70b9\u6253\u4e0a\u6807\u8bb0\uff0c\u7136\u540e\u679a\u4e3e\u6240\u6709\u975e\u76f4\u5f84\u4e0a\u7684\u8282\u70b9\uff0c\u66f4\u65b0\u6700\u5927\u8ddd\u79bb\uff0c\u5c31\u53ef\u4ee5\u8fc7\u4e86\u3002\n\n\u590d\u6742\u5ea6\u662f$O(n)$\u7ea7\u522b\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\nusing namespace std;\nconst int maxn=2e5+5;\nint n;\nint tot,head[maxn],nxt[maxn<<1],to[maxn<<1];\nint maxx,pos[4],ans;\nint deep[maxn],fa[maxn];\nbool v[maxn];\nvoid add(int x,int y)\n{\n\tto[++tot]=y;\n\tnxt[tot]=head[x];\n\thead[x]=tot;\n}\nvoid dfs(int x,int f,int p)\n{\n\tif(p==2)\n\t\tfa[x]=f;\n\tdeep[x]=deep[f]+1;\n\tif(deep[x]>maxx)\n\t{\n\t\tmaxx=deep[x];\n\t\tpos[p]=x;\n\t}\n\tfor(int i=head[x];i;i=nxt[i])\n\t{\n\t\tint y=to[i];\n\t\tif(y==f)\n\t\t\tcontinue;\n\t\tdfs(y,x,p);\n\t}\n}\nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tint x,y;\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tadd(x,y);\n\t\tadd(y,x);\n\t}\n\tdeep[0]=-1;\n\tdfs(1,0,1);\n\tmaxx=0;\n\tdfs(pos[1],0,2);\n\tint x=pos[2];\n\twhile(x)\n\t{\n\t\tv[x]=1;\n\t\tx=fa[x];\n\t}\n\tans+=maxx;\n\tmaxx=0;\n\tint tmp=0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(v[i])\n\t\t\tcontinue;\n\t\telse\n\t\t{\n\t\t\tx=i;\n\t\t\ttmp=0;\n\t\t\twhile(!v[x])\n\t\t\t{\n\t\t\t\tx=fa[x];\n\t\t\t\ttmp++;\n\t\t\t}\n\t\t\tif(maxx<tmp)\n\t\t\t{\n\t\t\t\tmaxx=tmp;\n\t\t\t\tpos[3]=i;\n\t\t\t}\n\t\t}\n\t}\n\tif(!maxx)\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tif(v[i]&&i!=pos[1]&&i!=pos[2])\n\t\t\t{\n\t\t\t\tpos[3]=i;\n\t\t\t\tbreak;\n\t\t\t}\n\tans+=maxx;\n\tprintf(\"%d\\n%d %d %d\\n\",ans,pos[1],pos[2],pos[3]);\n\treturn 0;\n}\n```\n\n\n",
        "postTime": 1607066165,
        "uid": 175131,
        "name": "\u5085\u601d\u7ef4666",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1294F \u3010Three Paths on a Tree\u3011"
    },
    {
        "content": "### \u524d\u8a00\n\n\u6839\u636e dp/trees \u7684 tag \u5237 Codeforces \uff0c\u9047\u5230\u7684\u4e00\u4e2a\u9898\u3002\n\n\u505a\u6cd5\u7c7b\u4f3c\u4e8e\u4e71\u641e\uff1f\n\n---\n\n### \u9898\u610f\u7b80\u8ff0\n\n\u8981\u6c42\u9009\u53d6\u4e09\u4e2a\u70b9\uff0c\u4f7f\u5f97\u8fd9\u4e09\u4e2a\u70b9\u7b80\u5355\u8def\u5f84\u4e0a\u5305\u542b\u7684\u8fb9\u6570\u6700\u591a\u3002\n\n---\n\n### \u9898\u89e3\n\n\u770b\u5230\u9898\u76ee\uff0c\u5f88\u5bb9\u6613\u8054\u60f3\u5230\u6811\u7684\u76f4\u5f84\u2014\u2014\u8fd9\u4e2a\u95ee\u9898\u7b80\u5316\u4e3a\u4e24\u4e2a\u70b9\u7684\u7248\u672c\u3002\n\n\u8003\u8651\u80fd\u5426\u62d3\u5c55\u5230\u4e09\u4e2a\u70b9\u4e0a\uff0c\u5728\u6811\u4e0a\u518d\u5bfb\u627e\u4e00\u4e2a\u5230\u76f4\u5f84\u8ddd\u79bb\u6700\u5927\u7684\u70b9\uff0c\u8f93\u51fa\u5373\u53ef\u3002\n\n---\n\n### $\\mathrm{Code}$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\ntemplate <typename Tp>\nvoid read(Tp &x) {\n\tx=0;char ch=1;int fh=1;\n\twhile(ch!='-'&&(ch>'9'||ch<'0'))ch=getchar();\n\tif(ch=='-')fh=-1,ch=getchar();\n\twhile(ch>='0'&&ch<='9')x=x*10+ch-'0',ch=getchar();\n\tx*=fh;\n}\n\nconst int maxn=200007;\nconst int maxm=400007;\n\nint n;\nint Head[maxn],to[maxm],Next[maxm],tot;\n\nvoid addedge(int x,int y) {\n\tto[++tot]=y,Next[tot]=Head[x],Head[x]=tot;\n}\nvoid add(int x,int y) {\n\taddedge(x,y);addedge(y,x);\n}\n\nint maximum,pos,cnt;\n\nvoid dfs1(int x,int f,int dp) {\n\tif(dp>maximum) maximum=dp,pos=x;\n\tfor(int i=Head[x];i;i=Next[i]) {\n\t\tint y=to[i];\n\t\tif(y==f) continue;\n\t\tdfs1(y,x,dp+1);\n\t}\n}\n\nint tag[maxn];\n\nvoid mark(int x,int f) {\n\tif(x==pos) {\n\t\ttag[x]=1;\n\t\treturn;\n\t}\n\tfor(int i=Head[x];i;i=Next[i]){\n\t\tint y=to[i];\n\t\tif(y==f) continue;\n\t\tmark(y,x);\n\t\tif(tag[y]) tag[x]=1;\n\t}\n}\n\nvoid Init(void) {\n\tread(n);\n\tfor(int i=1,x,y;i<n;i++) {\n\t\tread(x);read(y);\n\t\tadd(x,y);\n\t}\n}\n\nvoid search(int x,int f,int dp){\n\tif(tag[x]&&dp) return;\n\tif(dp>maximum) maximum=dp,cnt=x;\n\tfor(int i=Head[x];i;i=Next[i]){\n\t\tint y=to[i];\n\t\tif(y==f) continue;\n\t\tsearch(y,x,dp+1);\n\t}\n}\n\n\n\nvoid Work(void) {\n\tdfs1(1,0,1);\n\tmaximum=0; int p=pos; pos=0;\n\tdfs1(p,0,1);\n\tmark(p,0);\n\tmaximum=0;\n\tint ans=0;\n\tfor(int i=1;i<=n;i++){\n\t\tif(tag[i]==1) {\n\t\t\tsearch(i,0,0);\n\t\t\t++ans;\n\t\t}\n\t}\n\t--ans;\n\tif(ans==n-1) {\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tif(i!=p&&i!=pos) {\n\t\t\t\tcnt=i;break;\n\t\t\t}\n\t\t}\n\t}\n\tans+=maximum;\n\tprintf(\"%d\\n%d %d %d\\n\",ans,p,pos,cnt);\n//\tint ans=\n}\n\nint main(void) {\n\tInit();\n\tWork();\n\treturn 0;\n}\n```\n\n---\n\n### \u8ba8\u8bba\n\n\u662f\u5426\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u505a\u6cd5\u62d3\u5c55\u5230\u5728 $n$ \u4e2a\u70b9\u4e2d\u9009\u53d6 $k$ \u4e2a\u70b9\u7684\u60c5\u51b5\uff1f\u53ef\u4ee5\u79c1\u4fe1\u6211\u8ba8\u8bba\u3002",
        "postTime": 1599558258,
        "uid": 28910,
        "name": "\u89c8\u904d\u5343\u79cb",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF1294F \u3010Three Paths on a Tree\u3011"
    }
]
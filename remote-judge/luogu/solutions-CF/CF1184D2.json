[
    {
        "content": "### \u3010CF1184D2\u3011Parallel Universes \u89e3\u9898\u62a5\u544a\n\n#### \u9898\u76ee\u5927\u610f\n\n\u6709\u4e00\u4e2a\u4eba\uff0c\u521a\u5f00\u59cb\u6709 $n$ \u4e2a\u5b87\u5b99\uff0c\u4ed6\u5728\u7b2c $k$ \u4e2a\u5b87\u5b99\u91cc\uff0c\u5b87\u5b99\u7684\u6700\u5927\u6570\u91cf\u4e0d\u4f1a\u8d85\u8fc7 $m$\u3002\n\n\u8bbe\u5f53\u524d\u7684\u5b87\u5b99\u603b\u6570\u4e3a $l$\uff0c\u5219\u8fd9\u4e2a\u4eba\u6709 $1-\\dfrac{l}{m}$ \u7684\u6982\u7387\u5728\u4efb\u610f\u4e24\u4e2a\u5b87\u5b99\u4e4b\u95f4\u6216\u8005\u6240\u6709\u5b87\u5b99\u7684\u4e24\u7aef\u63d2\u5165\u4e00\u4e2a\u65b0\u7684\u5b87\u5b99\uff0c\u800c\u6bcf\u4e2a\u4f4d\u7f6e\u63d2\u5165\u5b87\u5b99\u7684\u6982\u7387\u76f8\u7b49\uff1b\u8fd8\u6709 $\\dfrac{l}{m}$ \u7684\u6982\u7387\u5c06\u8fd9\u4e2a\u5b87\u5b99\u5e8f\u5217\u5212\u5206\u4e3a\u4e24\u90e8\u5206\uff0c\u6bcf\u4e2a\u90e8\u5206\u975e\u7a7a\uff0c\u7136\u540e\u53bb\u6389\u4e0d\u5305\u542b\u81ea\u5df1\u7684\u90a3\u4e00\u90e8\u5206\u3002\n\n\u6bcf\u5f53\u8fd9\u4e2a\u4eba\u53d1\u73b0\u81ea\u5df1\u5904\u4e8e\u6700\u5de6\u7aef\u6216\u8005\u6700\u53f3\u7aef\u7684\u5b87\u5b99\u65f6\uff0c\u4ed6\u5c31\u4f1a\u7ed3\u675f\u8fd9\u4e9b\u64cd\u4f5c\u3002\n\n\u6c42\u6700\u540e\u7ed3\u675f\u64cd\u4f5c\u65f6\u5b87\u5b99\u7684\u6570\u91cf\u7684\u671f\u671b\uff0c\u5bf9 $10^9+7$ \u53d6\u6a21\u3002\n\n$n,k,m\\leq 250$\u3002\n\n#### Solution\n\n\u9996\u5148\u7279\u5224\uff0c$k=1$ \u548c $k=n$ \u65f6\uff0c\u7b54\u6848\u5747\u4e3a $n$\u3002\n\n\u5176\u6b21\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u8bbe $x_{i,j}$ \u4e3a\u521d\u59cb\u60c5\u51b5\u4e0b\u5b87\u5b99\u6570\u91cf\u4e3a $i$\uff0c\u800c\u8fd9\u4e2a\u4eba\u5728\u7b2c $j$ \u4e2a\u5b87\u5b99\u7684\u7b54\u6848\uff0c\u90a3\u4e48\u4e0d\u96be\u7528 $O(m^6)$ \u7684\u9ad8\u65af\u6d88\u5143\u6c42\u89e3\uff0c\u5177\u4f53\u5982\u4e0b\uff1a\n\n- \u548c\u7279\u5224\u7c7b\u4f3c\u5730\uff0c$x_{i,1}=x_{i,i}=i$\u3002\n- \u5728\u5b87\u5b99 $j$ \u540e\u9762\u63d2\u5165\u4e00\u4e2a\u65b0\u7684\u5b87\u5b99\u3002\u5219\u6b64\u90e8\u5206\u8d21\u732e\u5e94\u4e3a $(1-\\dfrac{i}{m})\\dfrac{i+1-j}{i+1}x_{i+1,j}$\u3002\n- \u5728\u5b87\u5b99 $j$ \u524d\u9762\u63d2\u5165\u4e00\u4e2a\u65b0\u7684\u5b87\u5b99\uff0c\u5219\u6b64\u90e8\u5206\u8d21\u732e\u5e94\u4e3a $(1-\\dfrac{i}{m})\\dfrac{j}{i+1}x_{i+1,j+1}$\u3002\n- \u5728\u5b87\u5b99 $j$ \u540e\u9762\u8fdb\u884c\u4e00\u6b21\u5212\u5206\uff0c\u5219\u6b64\u90e8\u5206\u8d21\u732e\u5e94\u4e3a $\\dfrac{i}{m(i-1)}x_{nxt,j},nxt\u2208[j,i-1]$\u3002\n- \u5728\u5b87\u5b99 $j$ \u524d\u9762\u8fdb\u884c\u4e00\u6b21\u5212\u5206\uff0c\u5219\u6b64\u90e8\u5206\u8d21\u732e\u5e94\u4e3a$\\dfrac{i}{m(i-1)}x_{i-t,j-t},t\u2208[1,j-1]$\u3002\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u83b7\u5f97\u4e86\u4e00\u4e2a\u6109\u5feb\u7684 $O(m^6)$ \u9ad8\u65af\u6d88\u5143\u3002\u63a5\u4e0b\u6765\u8003\u8651\u4f18\u5316\u3002\n\n\u4e0a\u9762\u7684\u5f0f\u5b50\u5927\u6982\u53ef\u4ee5\u5199\u6210\uff1a\n$$\nx_{i,j}=\\dfrac{(m-i)(i+1-j)}{(i+1)m}x_{i+1,j}+\\dfrac{(m-i)j}{m(i+1)}x_{i+1,j+1}+\\dfrac{i}{m(i-1)}x_{[j,i-1],j}+\\dfrac{i}{m(i-1)}x_{[i-j+1,i-1],[1,j-1]}\n$$\n\u79fb\u4e00\u4e0b\u9879\uff1a\n$$\n\\dfrac{(m-i)j}{m(i+1)}x_{i+1,j+1}=-\\dfrac{(m-i)(i+1-j)}{(i+1)m}x_{i+1,j}+x_{i,j}-\\dfrac{i}{m(i-1)}x_{[j,i-1],j}-\\dfrac{i}{m(i-1)}x_{[i-j+1,i-1],[1,j-1]}\n$$\n\u6211\u4eec\u53d1\u73b0\uff0c\u6bcf\u5217\uff08$j$ \u76f8\u540c\uff09\u7684\u6570\u7684\u8f6c\u79fb\u5176\u5b9e\u662f\u4e92\u4e0d\u5e72\u6270\u7684\uff01\u4e8e\u662f\uff0c\u6211\u4eec\u8003\u8651\u6309\u7167 $j$ \u9012\u589e\u7684\u987a\u5e8f\uff0c\u5c06\u6bcf\u4e2a\u6570\u90fd\u7528\u540c\u4e00\u5217\u7684\u7ebf\u6027\u7ec4\u5408\u8868\u793a\u51fa\u6765\uff0c\u7136\u540e\u9ad8\u65af\u6d88\u5143\u89e3\u4e00\u4e0b\u65b9\u7a0b\u5373\u53ef\uff08\u53ef\u4ee5\u5229\u7528 $x_{m+1,k},k\u2208N^{+}$ \u7684\u7cfb\u6570\u4e3a $0$ \u6765\u505a\uff09\u3002\u7b54\u6848\u5373\u4e3a $x_{n,k}$ \u5bf9\u5e94\u7684\u7ebf\u6027\u7ec4\u5408\u7b97\u51fa\u6765\u7684\u503c\u3002",
        "postTime": 1633956492,
        "uid": 108510,
        "name": "Terminus_Est",
        "ccfLevel": 0,
        "title": "\u3010CF1184D2\u3011Parallel Universes \u89e3\u9898\u62a5\u544a"
    },
    {
        "content": "\u5199\u4e00\u7bc7\u9898\u89e3\u7eaa\u5ff5\u8fd9\u9053\u6211\u8c03\u4e86\u4e00\u5929\u7684\u9898\u3002\n### \u7b80\u8981\u9898\u610f\n\u6709\u4e00\u6392\u957f\u5ea6\u4e3a $n$ \u7684\u68cb\u5b50\uff0c\u4e00\u5f00\u59cb\u7b2c $k$ \u4e2a\u662f\u7ea2\u8272\u7684\uff0c\u5176\u4ed6\u90fd\u662f\u84dd\u8272\u7684\u3002\u68cb\u5b50\u6700\u591a\u6709 $m$ \u4e2a\u3002\n\n\u5982\u679c\u5f53\u524d\u7684\u68cb\u5b50\u6570\u4e3a $n'$\uff0c\u5219\u6709 $\\frac{n'}{m}$ \u7684\u6982\u7387\u5728\u603b\u5171 $n'-1$ \u4e2a\u7a7a\u4f4d\u4e2d\u5747\u5300\u968f\u673a\u4e00\u4e2a\uff0c\u5c06\u68cb\u5b50\u4ece\u8fd9\u4e2a\u7a7a\u4f4d\u65ad\u5f00\u5e76\u7559\u4e0b\u5305\u542b\u7ea2\u8272\u68cb\u5b50\u7684\u90a3\u4e00\u6bb5\u3002\u6709 $1-\\frac{n'}{m}$ \u7684\u6982\u7387\u5728\u7a7a\u4f4d\u548c\u6700\u5de6\u7684\u68cb\u5b50\u5de6\u8fb9\uff0c\u6700\u53f3\u7684\u68cb\u5b50\u53f3\u8fb9\u5171 $n'+1$ \u4e2a\u4f4d\u7f6e\u4e2d\u968f\u673a\u9009\u62e9\u4e00\u4e2a\uff0c\u5728\u5176\u4e2d\u653e\u4e0a\u4e00\u4e2a\u84dd\u8272\u68cb\u5b50\u3002\n\n\u5f53\u67d0\u4e2a\u65f6\u523b\u6ee1\u8db3\u7ea2\u8272\u68cb\u5b50\u5728\u6700\u5de6\u8fb9\u6216\u6700\u53f3\u8fb9\uff0c\u64cd\u4f5c\u7ed3\u675f\u3002\u95ee\u64cd\u4f5c\u7ed3\u675f\u65f6\u68cb\u5b50\u6570\u91cf\u7684\u671f\u671b\u3002\n\n$1 \\le n,k,m \\le 250$\u3002\n### \u9898\u89e3\n\u5bb9\u6613\u60f3\u5230\u4e00\u4e2a\u66b4\u529b DP \u505a\u6cd5\uff1a\u8bb0 $f_{i,j}$ \u8868\u793a\u5171\u6709 $i$ \u4e2a\u68cb\u5b50\uff0c\u4ece\u5de6\u5230\u53f3\u7b2c $j$ \u4e2a\u662f\u7ea2\u8272\u8fd9\u4e2a\u72b6\u6001\u7684\u671f\u671b\u7ecf\u8fc7\u6b21\u6570\uff0c\u5219\u6709\u5982\u4e0b\u7684\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n- \u6b64\u6b21\u64cd\u4f5c\u662f\u65ad\u88c2\uff1a\n    - \u5728 $j$ \u7684\u4e24\u7aef\u65ad\u88c2\uff1a$f_{i,j} \\times \\frac{i}{m} \\times \\frac{1}{i-1} \\times (i+1) = f_{i,j} \\times \\frac{i(i+1)}{m(i-1)} \\rightarrow \\operatorname{Ans}$\u3002\n    - \u5728 $j$ \u5de6\u8fb9\u7684\u7b2c $x$ \u4e2a\u4f4d\u7f6e\u65ad\u88c2\uff0c\u6ee1\u8db3 $x < j-1$\uff1a$f_{i,j} \\times \\frac{i}{m} \\times \\frac{1}{i-1} = f_{i,j} \\times \\frac{i}{m(i-1)} \\rightarrow f_{i-x,j-x}$\u3002\n    - \u5728 $j$ \u53f3\u8fb9\u7684\u7b2c $x$ \u4e2a\u4f4d\u7f6e\u65ad\u88c2\uff0c\u6ee1\u8db3 $x \\ge j+1$\uff1a$f_{i,j} \\times \\frac{i}{m} \\times \\frac{1}{i-1} = f_{i,j} \\times \\frac{i}{m(i-1)} \\rightarrow f_{x,j}$\u3002\n- \u6b64\u6b21\u64cd\u4f5c\u662f\u6dfb\u52a0\uff1a\n    - \u5728 $j$ \u7684\u5de6\u8fb9\u52a0\u5165\uff1a$f_{i,j} \\times (1-\\frac{i}{m}) \\times \\frac{j}{i+1} = f_{i,j} \\times \\frac{j(m-i)}{m(i+1)} \\rightarrow f_{i+1,j+1}$\u3002\n    - \u5728 $j$ \u7684\u53f3\u8fb9\u52a0\u5165\uff1a$f_{i,j} \\times (1-\\frac{i}{m}) \\times \\frac{i-j+1}{i+1} = f_{i,j} \\times \\frac{(i-j+1)(m-i)}{m(i+1)} \\rightarrow f_{i+1,j}$\u3002\n\n\u8fd9\u5c31\u662f\u6240\u6709\u7684\u8f6c\u79fb\u60c5\u51b5\u4e86\u3002\u8fd8\u6709\u521d\u59cb\u6761\u4ef6 $f_{n,k} \\leftarrow  1$\u3002\u8bb0\u6a2a\u8f74\u4ece\u5de6\u5230\u53f3\u4e3a $i$\uff0c\u7eb5\u8f74\u4ece\u4e0a\u5230\u4e0b\u4e3a $j$\uff0c\u5219\u7eff\u8272\u683c\u5b50\u53ef\u4ee5\u8f6c\u79fb\u5230\u84dd\u8272\u683c\u5b50\u7684 $f$\u3002\u7070\u8272\u683c\u5b50\u8868\u793a\u5c06\u8981\u8ba1\u5165\u7b54\u6848\u7684\u683c\u5b50\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/3nyf6a9g.png)\n\n\u4e0d\u96be\u53d1\u73b0\u8fd9\u4e2a\u4e1c\u897f\u8f6c\u79fb\u6709\u73af\uff0c\u53ea\u80fd\u9ad8\u65af\u6d88\u5143\uff0c\u590d\u6742\u5ea6 $\\mathcal{O}(n^6)$\uff0c\u65e0\u6cd5\u901a\u8fc7\u3002\u8003\u8651\u662f\u5426\u53ef\u4ee5\u79fb\u9879\u7136\u540e\u4e3b\u5143\u6cd5\uff1a\n$$\n\\begin{aligned}\nf_{i,j} = & \n[i=n,j=k] + \\sum_{x=1}^{n-i} f_{i+x,j+x} \\times \\frac{i+x}{m(i+x-1)} + \\sum_{x=1}^{n-i} f_{i+x,j} \\times \\frac{i+x}{m(i+x-1)} \\\\ \n& + f_{i-1,j} \\times \\frac{(i-j)(m-i+1)}{m \\times i} + f_{i-1,j-1} \\times \\frac{(j-1)(m-i+1)}{m \\times i}\n\\end{aligned}\n$$\n\u8fd9\u6837\u53ef\u4ee5\u8868\u793a\u51fa $f_{i-1,j-1}$\u3002\n$$\n\\begin{aligned}\nf_{i-1,j-1} = & \\left( f_{i,j} - [i=n,j=k] - \\sum_{x=1}^{n-i} f_{i+x,j+x} \\times \\frac{i+x}{m(i+x-1)} - \\sum_{x=1}^{n-i} f_{i+x,j} \\times \\frac{i+x}{m(i+x-1)} - f_{i-1,j} \\times \\frac{(i-j)(m-i+1)}{m \\times i}  \\right) \\\\\n& \\times \\frac{m \\times i}{(j-1)(m-i+1)}\n\\end{aligned}\n$$\n![](https://cdn.luogu.com.cn/upload/image_hosting/h0iey8no.png)\n\n\u5982\u56fe\uff0c\u6a59\u8272\u683c\u5b50\u53ef\u4ee5\u88ab\u7eff\u8272\u53ca\u84dd\u8272\u683c\u5b50\u8868\u793a\u51fa\uff0c\u4f7f\u7528\u7eff\u8272\u683c\u5b50\u7684\u65b9\u7a0b\u3002\u56e0\u6b64\u6bcf\u4e2a\u683c\u5b50\u90fd\u53ef\u4ee5\u88ab\u5176\u4e0b\u65b9\u7684\u683c\u5b50\u8868\u793a\u51fa\u3002\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5\u8bbe\u4e3b\u5143\u9012\u63a8\u3002\u4e3b\u5143\u8bbe\u7f6e\u4e3a\u6700\u53f3\u65b9\u4e00\u5217\u9664\u53bb\u7070\u8272\u683c\u5b50\u4ee5\u53ca\u5de6\u4e0a\u89d2\u7684\u683c\u5b50\u5373\u53ef\uff0c\u5171 $m-2$ \u4e2a\uff0c\u5373\u56fe\u4e2d\u7684\u7c89\u8272\u683c\u5b50\u3002\u6700\u540e\u4f7f\u7528\u6700\u4e0a\u65b9\u9664\u53bb\u7070\u8272\u683c\u5b50\u548c\u5de6\u4e0a\u89d2\u7684\u683c\u5b50\u5171 $m-2$ \u4e2a\u683c\u5b50\u7684\u65b9\u7a0b\u89e3\u5373\u53ef\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n^3)$\uff0c\u8db3\u4ee5\u901a\u8fc7\u3002",
        "postTime": 1660127548,
        "uid": 175590,
        "name": "Zxx200611",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011CF1184D2 Parallel Universes"
    }
]
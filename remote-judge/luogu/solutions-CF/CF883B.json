[
    {
        "content": "http://codeforces.com/problemset/problem/883/B  \n\n\u7ed9\u6709\u5411\u56fe\uff0c\u67d0\u4e9b\u70b9\u70b9\u6743\u5df2\u77e5\uff0c\u786e\u5b9a\u5176\u4ed6\u672a\u77e5\u70b9\u6743\uff0c\u4f7f\u5f97\uff1a  \n\n1. \u6240\u6709\u70b9\u6743\u5728 $[1,k]$ \u4e4b\u95f4\uff1b\n2. \u5bf9\u4e8e\u8fb9 $x\\rightarrow y$\uff0c$x$ \u7684\u70b9\u6743\u5927\u4e8e $y$ \u7684\uff1b\n3. \u5bf9\u4e8e\u6240\u6709\u7684 $i\\in [1,k]$\uff0c\u90fd\u6709\u81f3\u5c11\u4e00\u4e2a\u70b9\u70b9\u6743\u4e3a $i$\u3002\n\n----------------------------  \n\n\u8003\u8651\u5148\u6b63\u53cd\u4e24\u8fb9\u627e\u5230\u6bcf\u4e00\u4e2a\u70b9\u7684\u6700\u5927\u3001\u6700\u5c0f\u70b9\u6743\uff0c\u8bb0\u4e3a $[l_u,r_u]$\u3002\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a $i$ \u786e\u5b9a\u54ea\u4e9b\u70b9\u7684\u70b9\u6743\u4e3a $i$\uff0c\u4f7f\u5f97\u5728\u4e0d\u8fdd\u53cd\u6761\u4ef6 2 \u7684\u60c5\u51b5\u4e0b\u5c3d\u91cf\u53bb\u6ee1\u8db3\u6761\u4ef6 3\u3002  \n\u6b64\u65f6\u70b9\u6743 $[1,i-1]$ \u5fc5\u7136\u5df2\u7ecf\u88ab\u5206\u914d\u5b8c\uff0c\u8bb0 $S$ \u4e3a\u6240\u6709 $l_u\\le i$ \u7684 $u$ \u7684\u96c6\u5408\u3002  \n\u90a3\u4e48\u5bf9\u4e8e\u6240\u6709\u7684 $r_u=i$ \u7684 $u$\uff0c\u90fd\u8981\u5206\u914d\u70b9\u6743\u4e3a $i$\u3002\u56e0\u4e3a\u5982\u679c\u5206\u914d\u6210 $j<i$ \u7684\u8bdd\uff0c\u7531\u4e8e\u5b58\u5728\u5df2\u7ecf\u88ab\u5206\u914d\u6210 $j$ \u7684\u70b9\uff0c\u53ef\u80fd\u4f1a\u4ea7\u751f\u51b2\u7a81\u8fdd\u53cd\u6761\u4ef6 2\u3002\u800c\u663e\u7136\u628a\u4ed6\u4eec\u5206\u914d\u4e3a $i$ \u4e5f\u66f4\u7b26\u5408\u6761\u4ef6 3\u3002  \n\u82e5\u4e0d\u5b58\u5728 $r_u=i$ \u7684\u70b9\uff0c\u5219\u9700\u8981\u53d6\u4e00\u4e2a $r_u>i$ \u7684\u70b9\u5206\u914d\u4e3a $i$\u3002\u6b64\u65f6\u5bf9\u4e8e\u6761\u4ef6 3\uff0c\u663e\u7136\u53d6 $r_u$ \u6700\u5c0f\u7684\u6700\u4f18\u3002  \n\u5982\u679c\u6b64\u65f6\u4ecd\u7136\u6ca1\u6709 $r_u>i$ \u7684\u70b9\uff0c\u5219\u4e3a\u65e0\u89e3\u3002  \n\n```cpp  \n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<cstring>\n#include<utility>\n#include<set>\n#define reg register\n#define EN puts(\"\")\n#define INT_INF ((int)0x3f3f3f3f)\n#define LL_INF ((long long)0x3f3f3f3f3f3f3f3f)\ninline int read(){\n\tregister int x=0;register int y=1;\n\tregister char c=std::getchar();\n\twhile(c<'0'||c>'9'){if(c=='-') y=0;c=getchar();}\n\twhile(c>='0'&&c<='9'){x=x*10+(c^48);c=getchar();}\n\treturn y?x:-x;\n}\n#define N 200006\n#define M 200006\nstruct Graph{\n\tint fir[N],nex[M],to[M],tot;\n\tinline void add(int u,int v){\n\t\tto[++tot]=v;\n\t\tnex[tot]=fir[u];fir[u]=tot;\n\t}\n};\nGraph G,T;\nint n,m,k;\nint val[N];\nint in[N],out[N];\nint min[N],max[N],id[N];\nint left,right,que[N];\ninline int topo1(){\n\tleft=0;right=-1;\n\tfor(reg int i=1;i<=n;i++)if(!out[i]) min[i]=val[i]?val[i]:1,que[++right]=i;\n\treg int u,i,v;while(left<=right){\n\t\tu=que[left++];\n\t\tfor(i=T.fir[u];i;i=T.nex[i]){\n\t\t\tv=T.to[i];\n\t\t\tmin[v]=std::max(min[v],min[u]+1);\n\t\t\tif(!--out[v]){\n\t\t\t\tif(val[v]&&val[v]<min[v]) return 1;\n\t\t\t\tmin[v]=std::max(min[v],val[v]);\n\t\t\t\tque[++right]=v;\n\t\t\t}\n\t\t}\n\t}\n\tfor(reg int i=1;i<=n;i++)if(out[i]) return 1;\n\treturn 0;\n}\ninline int topo2(){\n\tleft=0;right=-1;\n\tfor(reg int i=1;i<=n;i++){\n\t\tif(!in[i]) max[i]=val[i]?val[i]:k,que[++right]=i;\n\t\telse max[i]=k;\n\t}\n\treg int u,i,v;while(left<=right){\n\t\tu=que[left++];\n\t\tfor(i=G.fir[u];i;i=G.nex[i]){\n\t\t\tv=G.to[i];\n\t\t\tmax[v]=std::min(max[v],max[u]-1);\n\t\t\tif(!--in[v]){\n\t\t\t\tif(val[v]&&val[v]>max[v]) return 1;\n\t\t\t\tif(val[v]) max[v]=std::min(max[v],val[v]);\n\t\t\t\tque[++right]=v;\n\t\t\t}\n\t\t}\n\t}\n\tfor(reg int i=1;i<=n;i++)if(in[i]) return 1;\n\treturn 0;\n}\nint ans[N];\nstd::set<std::pair<int,int> >set;\nint main(){\n\tn=read();m=read();k=read();\n\tfor(reg int i=1;i<=n;i++) val[i]=read();\n\tfor(reg int u,v,i=1;i<=m;i++){\n\t\tu=read();v=read();\n\t\tin[v]++;out[u]++;\n\t\tG.add(u,v);T.add(v,u);\n\t}\n\tif(topo1()||topo2()) return puts(\"-1\"),0;\n\tfor(reg int i=1;i<=n;i++)if(min[i]>max[i]) return puts(\"-1\"),0;\n//\t\tfor(reg int i=1;i<=n;i++) printf(\"%d : [%d %d]\\n\",i,min[i],max[i]);\n\tfor(reg int i=1;i<=n;i++) id[i]=i;\n\tstd::sort(id+1,id+1+n,[](reg int a,reg int b){return min[a]==min[b]?max[a]<max[b]:min[a]<min[b];});\n\tfor(reg int now=1,i=1;i<=k;i++){\n\t\twhile(now<=n&&min[id[now]]<=i) set.insert(std::make_pair(max[id[now]],id[now])),now++;\n\t\tint have=0;\n\t\twhile(!set.empty()){\n\t\t\tint id=(*set.begin()).second;\n\t\t\tif(have&&max[id]>i) break;\n\t\t\tans[id]=i;have=1;\n\t\t\tset.erase(set.begin());\n\t\t}\n\t\tif(!have) return puts(\"-1\"),0;\n\t}\n\tfor(reg int i=1;i<=n;i++) printf(\"%d \",ans[i]);\n\treturn 0;\n}\n```",
        "postTime": 1625963315,
        "uid": 164432,
        "name": "suxxsfe",
        "ccfLevel": 9,
        "title": "CF883B Berland Army"
    }
]
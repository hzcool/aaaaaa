[
    {
        "content": "## \u5199\u5728\u524d\u9762\n\u770b\u4e86\u4e00\u4e9b\u5de8\u4f6c\u7684\u89e3\u6cd5\uff0c\u5927\u5bb6\u7684\u89e3\u6cd5\u90fd\u5dee\u4e0d\u591a\uff0c\u4f46\u662f\u7531\u4e8e\u6211\u6bd4\u8f83\u83dc\u2026\u2026\u6240\u4ee5\u7528\u4e86\u53e6\u4e00\u79cd\u66f4\u4fbf\u4e8e\u7406\u89e3\u7684\u89e3\u6cd5\u63a8\u51fa\u4e86\u4e0d\u540c\u7684\u5f0f\u5b50\uff0c\u5e0c\u671b\u5bf9\u5404\u4f4d\u6709\u6240\u5e2e\u52a9\u3002\n\n\u672c\u9898\u89e3\u5047\u8bbe\u60a8\u76ee\u524d\u8fd8\u4e0d\u4f1a\u6392\u5217\u7ec4\u5408\uff0c\u4f46\u4f1a\u52a0\u6cd5\u4e58\u6cd5\u539f\u7406\uff0c\u82e5\u89c9\u5f97\u8fc7\u4e8e\u7b80\u5355\u53ef\u4ee5\u76f4\u63a5\u8df3\u8fc7\u3002\n\n## \u8981\u5e72\u4ec0\u4e48\n\u9898\u610f\u5df2\u7ecf\u8bf4\u7684\u5f88\u660e\u767d\u4e86\uff0c\u5c31\u662f\u6c42\u957f\u5ea6\u4e3a$n$\u7684$1-n$\u7684\u5e8f\u5217\u7684\u6240\u6709\u5168\u6392\u5217\u4e2d\u5171\u6709\u51e0\u6bb5\u6392\u5e8f\u540e\u6570\u5b57\u4e3a\u8fde\u7eed\u7684\u533a\u95f4\u3002  \n\u539f\u56e0\u663e\u7136\uff1a\u5e8f\u5217\u4e2d\u9664\u53bb\u6700\u5927\u503c\u6700\u5c0f\u503c\u540e\u5171\u6709$l-r-1$\u4e2a\u6570\u5b57\uff0c\u4e3a\u4fdd\u8bc1\u8fd9\u4e9b\u6570\u5b57$>p_{min}$\u4e14$< p_{max}$\uff0c\u90a3\u53ea\u6709\u4ed6\u4eec\u662f\u8fde\u7eed\u7684\u65f6\u5019\u624d\u53ef\u4ee5\u6ee1\u8db3\u3002\n\n\u90a3\u5177\u4f53\u600e\u4e48\u8ba1\u7b97\u5462\uff1f\u4e0b\u9762\u5c06\u8be6\u7ec6\u8bf4\u660e\u3002\n\n## \u8ba1\u7b97\n\n\u4e00\u5f00\u59cb\u80af\u5b9a\u6ca1\u6709\u4efb\u4f55\u5934\u7eea\uff0c\u90a3\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u52a0\u6cd5\u539f\u7406\u5bf9\u533a\u95f4**\u6309\u7167\u957f\u5ea6**\u5148\u5206\u4e3a$n$\u7c7b\uff0c\u518d\u9010\u4e00\u8ba1\u7b97\u3002  \n\u5bf9\u4e8e\u6bcf\u79cd\u957f\u5ea6\u4e3a$i$\u7684\u533a\u95f4\uff0c\u6211\u4eec\u5e72\u7684\u4e8b\u60c5\u65e0\u975e\u56db\u6b65\uff1a\n\n1. \u9009\u6570\u2014\u2014\u5728$l=1$\u65f6\u4ece1\u5f00\u59cb\u9009\u51fa$i$\u4e2a\u8fde\u7eed\u7684\u6570\uff0c\u751f\u6210\u4e00\u4e2a\u57fa\u672c\u533a\u95f4\n2. \u6253\u4e71\u2014\u2014\u53ef\u4ee5\u628a\u57fa\u672c\u533a\u95f4\u4e2d\u7684\u5143\u7d20\u6253\u4e71\u6765\u4ea7\u751f\u5176\u4ed6\u65b0\u7684\u533a\u95f4\n3. \u6362\u6570\u2014\u2014\u6211\u4eec\u53ef\u4ee5\u628a\u57fa\u672c\u533a\u95f4\u4e2d\u7684\u6570\u7edf\u4e00\u52a0\u4e0a\u4e00\u4e2a$\\le n-i$\u7684**\u81ea\u7136\u6570**\u4ea7\u751f\u5176\u4ed6\u65b0\u7684\u533a\u95f4\n4. \u6362\u5e8f\u2014\u2014\u6211\u4eec\u53ef\u4ee5\u628a\u57fa\u672c\u533a\u95f4\u5728\u6392\u5217\u4e2d\u5411\u53f3\u79fb\u52a8$\\le n-i$\u7684**\u81ea\u7136\u6570**\u4e2a\u5355\u4f4d\u751f\u6210\u65b0\u7684\u533a\u95f4\n\n\u53ef\u4ee5\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u5206\u6b65\u6267\u884c\u7684\u8fc7\u7a0b\uff0c\u6240\u4ee5\u5e94\u8be5\u7528\u4e58\u6cd5\u539f\u7406\u8ba1\u6570\u3002\n\n### Step1.\u9009\u6570\n\n\u8003\u8651\u5c0f\u5b66\u6982\u7387\u3002\n\n\u4f17\u6240\u5468\u77e5\uff0c\u957f\u5ea6\u4e3a$n$\u7684\u5e8f\u5217\u7684\u5168\u6392\u5217\u5171\u6709$n!$\u79cd\u3002\u6211\u4eec\u8981\u4ece\u4e2d\u9009$i$\u4e2a\u6570\u3002\u6709$n$\u79cd\u6570\u6709\u53ef\u80fd\u4f5c\u4e3a$p_1$\uff0c\u7136\u800c\u6211\u4eec\u53ea\u89811\uff0c\u90a3\u4e48$p_1$\u6709$\\frac{1}{n}$\u79cd\u9009\u6cd5\u3002\u540c\u7406\u53ef\u5f97\u5728$p_1$\u786e\u5b9a\u7684\u60c5\u51b5\u4e0b$p_2$\u6709$\\frac{1}{n-1}$\u79cd\u9009\u6cd5\uff0c\u4ee5\u6b64\u7c7b\u63a8\uff0c$p_q$\u6709$\\frac{1}{n-i+1}$\u79cd\u9009\u6cd5\u3002\u663e\u800c\u6613\u89c1\uff0c\u8fd9\u53c8\u662f\u4e00\u4e2a\u4e58\u6cd5\u539f\u7406\u8ba1\u6570\uff0c\u6240\u4ee5\u6700\u540e\u7684\u7ed3\u679c\u5c31\u662f\uff1a\n\n$$\\frac{n!}{n \\times (n-1) \\times (n-2) \\times ... \\times (n-i+1)}= \\frac{n!}{\\frac{n!}{(n-i)!}}=(n-i)!$$\n\n### Step2.\u6253\u4e71\n\n\u4f17\u6240\u5468\u77e5\uff0c\u957f\u5ea6\u4e3a$n$\u7684\u5e8f\u5217\u7684\u5168\u6392\u5217\u5171\u6709$n!$\u79cd\u3002\u6240\u4ee5\u5bf9\u4e8e\u57fa\u672c\u533a\u95f4\u5171\u6709$i!$\u79cd\u6362\u5e8f\u65b9\u5f0f\u3002\n\n### Step3.\u6362\u6570\n\n\u73b0\u5728\u8981\u628a\u57fa\u672c\u533a\u95f4\u4e2d\u7684\u6bcf\u4e2a\u6570\u52a0\u4e0a\u4efb\u610f\u4e00\u4e2a$\\le n-i$\u7684\u81ea\u7136\u6570\uff0c\u8003\u8651\u52a0\u6cd5\u539f\u7406\uff0c\u5bf9\u4e8e\u8fd9\u4e2a\u81ea\u7136\u6570\u6709$(n-i+1)$\u4e2d\u9009\u6cd5\u3002\uff08\u4ec0\u4e48\uff1f+1\u4ece\u54ea\u6765\u7684\uff1f\u8fd9\u4e2a\u81ea\u7136\u6570\u53ef\u4ee5\u4e3a0\u554a\uff01\uff09\n\n### Step4.\u6362\u5e8f\n\n\u540cStep3\u3002\n\n\n\n\u6211\u4eec\u628a\u4e0a\u9762\u56db\u6b65\u5168\u90e8\u7b97\u5b8c\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u5f00\u5fc3\u76f8\u4e58\u51fa\u7ed3\u679c\u4e86\uff01\u6700\u540e\u6211\u4eec\u5c31\u5f97\u5230\u5728\u533a\u95f4\u957f\u5ea6\u4e3a$i$\u7684\u60c5\u51b5\u4e0b\u533a\u95f4\u4e2a\u6570$r_i=(n-i)!+i!+(n-i+1)^2$  \n\u90a3\u4e48\u6700\u540e\u52a0\u6cd5\u539f\u7406\u52a0\u548c\u4e00\u4e0b\u5c31\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$r=\\sum^{n}_{i=1} \\quad (n-i)!+i!+(n-i+1)^2$$\n\n\u8ba1\u7b97\u5373\u53ef\u3002\n\n## Code\n\n\u6211\u4e5f\u4e0d\u77e5\u9053\u6211\u4e3a\u4ec0\u4e48\u8981\u7528\u9f9f\u901f\u4e58\u548cull\u2026\u2026\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ninline int read() \n{\n    register int x = 0 , ch = getchar(); \n    while( !isdigit( ch ) ) ch = getchar(); \n    while( isdigit( ch ) ) x = x * 10 + ch - '0' , ch = getchar();\n    return x; \n}\nunsigned long long quick_power(unsigned long long a,unsigned long long b,unsigned long long p)\n{\n    unsigned long long ans=1;\n    while(b)\n    {\n        if(b%2)\n        {\n            ans=ans*a%p;        \n        }\n        a=a*a%p;\n        b=(b>>1);\n    }\n    return ans;\n}\nunsigned long long turtle_muti(unsigned long long ain,unsigned long long bin,unsigned long long modn)\n{\n    unsigned long long res=0;\n    for(;bin;bin>>=1) \n    {\n        if(bin&1)\n            res=(res+ain)%modn;\n        ain=(ain<<1)%modn;\n    }\n    return res;\n}\n \nint n,m;\nunsigned long long nfac[250010];\nunsigned long long ans;\nint main()\n{\n    n=read(),m=read();\n    nfac[0]=1,nfac[1]=1;\n    for(int i=2;i<=n;i++)\n        nfac[i]=turtle_muti(nfac[i-1],i,m);\n    for(int i=1;i<=n;i++)\n    {\n        unsigned long long qwq=1;\n        qwq=turtle_muti(qwq,nfac[n-i],m);\n        qwq=turtle_muti(qwq,nfac[i],m);\n        qwq=turtle_muti(qwq,quick_power(n-i+1,2,m),m);\n        ans+=qwq;\n        ans%=m;\n    }\n    cout<<ans<<endl;\n    return 0;\n}\n```\n\n",
        "postTime": 1578937144,
        "uid": 109988,
        "name": "34ytw8ew7ft",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1284C \u3010New Year and Permutation\u3011"
    },
    {
        "content": "\u9996\u5148\u6709\u975e\u5e38\u91cd\u8981\u7684\u4e00\u70b9\uff0c\u4e5f\u662f\u975e\u5e38\u663e\u7136\u7684\u4e00\u70b9\u3002\u5982\u679c\u6392\u5217\u7684\u4e00\u4e2a\u5b50\u4e32 $b=[p_l,p_{l+1},...,p_r]$ \u5bf9\u7b54\u6848\u6709\u8d21\u732e\uff0c\u90a3\u4e48 $[l,r]$ \u7684\u6570\u5b57\u4e00\u5b9a\u662f\u8fde\u7eed\u7684\u3002\n\n\u8ba9\u6211\u4eec\u6765\u5355\u72ec\u8003\u8651\u6bcf\u4e00\u4e2a\u957f\u5ea6\u7684\u533a\u95f4\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u957f\u5ea6\u4e3a $i$ \u7684\u533a\u95f4\u4e14\u5b83\u5bf9\u7b54\u6848\u6709\u8d21\u732e\uff0c\u90a3\u4e48\u6709\u591a\u5c11\u79cd\u6392\u5217\u4f7f\u5f97\u8fd9\u4e2a\u533a\u95f4\u5b58\u5728\u5462\uff1f\n\n\u7ec4\u5408\u6570\u57fa\u672c\u5957\u8def\uff0c\u56e0\u4e3a\u533a\u95f4\u4e0d\u80fd\u5206\u5272\uff0c\u6240\u4ee5\u628a\u8fd9\u4e2a\u957f\u5ea6\u4e3a $i$ \u7684\u533a\u95f4\u770b\u4f5c\u4e00\u4e2a\u6574\u4f53\uff0c\u518d\u8ba1\u7b97\u6392\u5217\u6570\u3002\u4e8e\u662f\u6709 $A_{n-i+1}^{n-i+1}=(n-i+1)!$ \u79cd\u6392\u5217\u5b58\u5728\u8fd9\u4e2a\u533a\u95f4\u3002\n\n\u957f\u5ea6\u4e3a $i$ \u7684\u533a\u95f4\u91cc\u53ef\u4ee5\u662f $1,2,...,i$\uff0c\u4e5f\u53ef\u4ee5\u662f $2,3,...,i+1$\uff0c\u7b49\u7b49\uff0c\u53ea\u8981\u5b83\u4eec\u662f\u8fde\u7eed\u7684\u5c31\u884c\u3002\u4e8e\u662f\u53c8\u53ef\u4ee5\u4e58\u4e0a\u4e00\u4e2a $n-i+1$\u3002\n\n\u6570\u5b57\u786e\u5b9a\u7684\u533a\u95f4\uff0c\u987a\u5e8f\u662f\u65e0\u6240\u8c13\u7684\uff0c\u6240\u4ee5\u8fd8\u8981\u4e58\u4e0a $A_{i}^{i}=i!$\u3002\n\n\u4e8e\u662f\u7b54\u6848\u5c31\u547c\u4e4b\u6b32\u51fa\u4e86\uff1a\n\n$$\\sum _{i=1}^{n} \\ \\ \\ \\ (n-i+1)! \\times i!\\times (n-i+1)$$\n\n\u9636\u4e58\u8981\u9884\u5904\u7406\u4e00\u4e0b\uff0c\u8282\u7701\u65f6\u95f4\u3002\u6700\u597d\u5f00\u4e2a `long long`\uff0c\u4fdd\u8bc1\u4f60\u4e0d\u4f1a\u56e0\u4e3a\u53d6\u6a21\u9891\u7387\u4f4e\u4e86\u800c WA \u6389\u3002\n\n```cpp\n# include <bits/stdc++.h>\n# define rr register\n# define int long long\nconst int N=250010;\nint MOD;\nint n;\nint sum;\nint seque[N];\nsigned main(void){\n\tscanf(\"%I64d%I64d\",&n,&MOD);//\u662f Codeforces \u3002\u5343\u4e07\u4e0d\u80fd\u7528 %lld\n\tseque[0]=1;\n\tfor(rr int i=1;i<=n;++i){\n\t\tseque[i]=(seque[i-1]*i)%MOD;\n\t}\n\tfor(rr int i=1;i<=n;++i){\n\t\tsum=(sum+((n-i+1)%MOD*(seque[i])%MOD)%MOD*(seque[n-i+1])%MOD);\n\t}\n\tprintf(\"%I64d\",sum%MOD);\n\treturn 0;\n}\n```",
        "postTime": 1578192117,
        "uid": 108949,
        "name": "Meatherm",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1284C \u3010New Year and Permutation\u3011"
    },
    {
        "content": "$n$\u8fc7\u5927\uff0c\u8003\u8651\u7b97\u8d21\u732e\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u957f\u5ea6\u4e3a$len$\u7684\u5408\u6cd5\u533a\u95f4\uff0c\u5b83\u7684\u6700\u5c0f\u503c\u6709$(n-len+1)$\u79cd\u65b9\u6848\uff0c\u7136\u540e\u8be5\u533a\u95f4\u5185\u90e8\u6709$len!$\u79cd\u6446\u653e\u65b9\u6848\uff0c\u5916\u90e8\u6709$(n-len)!$\u79cd\u6446\u653e\u65b9\u6848\uff0c\u800c\u957f\u5ea6\u4e3a$len$\u7684\u533a\u95f4\u6709$(n-len)+1$\u4e2a\uff0c\u6240\u4ee5\u6700\u7ec8\u7b54\u6848\u5373\u4e3a$\u2211le n!*(n-len)!*(n-len+1)^2$\n\n\u4ee3\u7801\u5982\u4e0b(\u548c\u7b2c\u4e00\u9898\u5dee\u4e0d\u591a\u957f):\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define re register\ninline int read(){\n\tre int t=0;\n\tre char v=getchar();\n\twhile(v<'0'||v>'9')v=getchar();\n\twhile(v>='0'&&v<='9'){\n\t\tt=(t<<3)+(t<<1)+(v^48);\n\t\tv=getchar();\n\t}\n\treturn t;\n}\nlong long n,m,jc[250002];\nlong long ans;\nint main(){\nn=read();\nm=read();\njc[0]=1;\nfor(re int i=1;i<=n;++i)jc[i]=jc[i-1]*i%m;\nfor(re int i=1;i<=n;++i){\n\tans+=(n-i+1)*jc[i]%m*(n-i+1)%m*jc[n-i]%m;\n\tans%=m;\n}\nprintf(\"%lld\",ans);\n}\n```\n",
        "postTime": 1578194923,
        "uid": 41476,
        "name": "gyh20",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1284C \u3010New Year and Permutation\u3011"
    },
    {
        "content": "\u6392\u5217\u6570\u91cf\u592a\u591a\uff0c\u5bb9\u6613\u60f3\u5230\u6c42\u89e3\u6bcf\u4e2a\u533a\u95f4\u7684\u8d21\u732e\uff1b\u53c8\u56e0\u4e3a\u6240\u6709\u957f\u5ea6\u76f8\u7b49\u7684\u533a\u95f4\u7b49\u4ef7\uff0c\u6240\u4ee5\u5bb9\u6613\u60f3\u5230\u679a\u4e3e\u533a\u95f4\u7684\u957f\u5ea6\uff0c\u7136\u540e\u4e58\u4e0a\u8fd9\u4e2a\u957f\u5ea6\u7684\u6570\u91cf\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u533a\u95f4 $[l,r]$\uff0c\u957f\u5ea6\u4e3a $r-l+1$\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230 $\\max\\limits_{i=l}^ra_i-\\min\\limits_{i=l}^ra_i=r-l$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5148\u786e\u5b9a $\\min\\limits_{i=l}^ra_i$\uff0c\u7136\u540e\u5c31\u80fd\u786e\u5b9a $\\max\\limits_{i=l}^ra_i$\uff0c\u4e8e\u662f $[l,r]$ \u4e2d\u7684\u5143\u7d20\u5c31\u5728 $[\\min\\limits_{i=l}^ra_i,\\max\\limits_{i=l}^ra_i]$ \u4e2d\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u5bf9\u4e8e $[l,r]$ \u4e2d\u7684\u5143\u7d20\uff0c\u53ea\u80fd\u9009\u62e9 $[\\min\\limits_{i=l}^ra_i,\\max\\limits_{i=l}^ra_i]$ \u4e2d\u7684 $r-l+1$ \u4e2a\u5143\u7d20\uff0c\u90a3\u4e48\u5c31\u662f $A_{r-l+1}^{r-l+1}$\u3002\n\n\u5bf9\u4e8e $\\min\\limits_{i=l}^ra_i$\uff0c\u53ef\u4ee5\u5f97\u5230 $\\min\\limits_{i=l}^ra_i+r-l\\le n$\uff0c\u53ef\u4ee5\u5f97\u5230\u4e00\u5171\u6709 $n-r+l=n-(r-l+1)+1$ \u79cd\u53ef\u80fd\u3002\n\n\u5269\u4e0b\u7684\u5143\u7d20\u968f\u4fbf\u7ec4\u5408\uff0c\u7b54\u6848\u5c31\u662f $A_{n-(r-l+1)}^{n-(r-l+1)}$\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u5bf9\u4e8e $[l,r]$\uff0c\u7b54\u6848\u5c31\u662f $A_{r-l+1}^{r-l+1}\\times(n-r+l)\\times A_{n-(r-l+1)}^{n-(r-l+1)}$\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a\u957f\u5ea6 $x$\uff0c\u7531 $l+x-1\\le n$ \u5f97\u3002\u4e00\u5171\u6709 $n-x+1$ \u4e2a $l$\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $l$\uff0c\u7b54\u6848\u662f $A_x^x\\times(n-x+1)\\times A_{n-x}^{n-x}$\u3002\n\n\u90a3\u4e48 $x$ \u7684\u7b54\u6848\u5c31\u662f $A_x^x\\times A_{n-x}^{n-x}\\times(n-x+1)^2$\u3002\n\n$x$ \u53ef\u4ee5\u53d6\u7684\u8303\u56f4\u662f $[1,n]$\uff0c\u6240\u4ee5\u7b54\u6848\u5c31\u662f $\\sum\\limits_{x=1}^nA_x^x\\times A_{n-x}^{n-x}\\times(n-x+1)^2$\uff0c\u6ce8\u610f\u5168\u6392\u5217\u8981\u5148\u521d\u59cb\u5316\u9636\u4e58\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$\u3002",
        "postTime": 1660031704,
        "uid": 556362,
        "name": "UnnamedOrNamed",
        "ccfLevel": 5,
        "title": "CF1284C New Year and Permutation \u9898\u89e3"
    },
    {
        "content": "\u7b97\u4e00\u4e2a\u5e8f\u5217\u4e2d\u6709\u591a\u5c11\u4e2a\u5408\u6cd5\u6570\u5bf9\u662f\u5f88\u9ebb\u70e6\u7684\uff0c\u90a3\u4e48\u4e0d\u59a8\u6362\u4e2a\u89d2\u5ea6\u60f3\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u6570\u5bf9\uff0c\u8ba1\u7b97\u80fd\u88ab\u591a\u5c11\u4e2a\u5e8f\u5217\u5305\u542b\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u5bf9\u4e8e $[l, r]$\uff0c\u8bbe\u6700\u5c0f\u503c\u4e3a $l + v$\uff0c\u6700\u5927\u503c\u4e3a $r + v$\uff0c\u90a3\u4e48\u5269\u4f59\u7684 $r-l-1$ \u4e2a\u6570\u65e2\u4e0d\u80fd\u6bd4 $l+v$ \u5c0f\uff0c\u4e5f\u4e0d\u80fd\u6bd4 $r+v$ \u5927\uff0c\u8fd8\u4e0d\u80fd\u91cd\u590d\uff0c\u90a3\u4e48\u5c31\u4e0e $(l+v,r+v)$ \u5bf9\u5e94\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5de6\u7aef\u70b9\u7684\u503c\u786e\u5b9a\u540e\uff0c\u533a\u95f4\u5305\u542b\u5143\u7d20\u552f\u4e00\u786e\u5b9a\u3002\n\n\u5bf9\u4e8e\u6240\u6709\u957f\u5ea6\u4e3a $i$ \u7684\u533a\u95f4\uff0c\u5de6\u7aef\u70b9\u6709 $n-i+1$ \u79cd\u9009\u62e9\uff0c\u533a\u95f4\u6240\u5728\u7684\u4f4d\u7f6e\u6709 $n-i+1$ \u79cd\u9009\u62e9\uff0c\u533a\u95f4\u53ef\u4efb\u610f\u6392\u5217\uff0c\u4e0d\u5f71\u54cd\u6781\u5dee\uff0c\u6240\u4ee5\u6709 $A_i^i$ \u79cd\u6392\u5217\u65b9\u5f0f\uff0c\u9664\u8be5\u533a\u95f4\u4ee5\u5916\u7684\u6570\u6709 $A_{n-i}^{n-i}$ \u79cd\u6392\u5217\u65b9\u5f0f\uff08\u8fd9\u4e00\u6b65\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u6570\u5217\u7684\u6bcf\u4e2a\u5408\u6cd5\u533a\u95f4\u90fd\u8981\u8ba1\u7b97\uff0c\u6240\u4ee5\u4e0d\u7528\u5bf9\u8be5\u533a\u95f4\u4e4b\u5916\u7684\u5408\u6cd5\u533a\u95f4\u53bb\u91cd\uff09\u3002\n\n\u4e58\u6cd5\u539f\u7406\uff0c\u5168\u90e8\u76f8\u4e58\u5373\u53ef\u5f97\u5230\u957f\u5ea6\u4e3a $i$ \u7684\u6240\u6709\u533a\u95f4\u7684\u7b54\u6848\uff0c\u679a\u4e3e $i$\uff0c\u76f8\u52a0\u5373\u53ef\u3002\n\n\u7279\u522b\u5730\uff0c\u5bf9\u4e8e\u957f\u5ea6\u4e3a $1$ \u7684\u533a\u95f4\uff0c\u6bcf\u4e2a\u533a\u95f4\u90fd\u88ab $A_n^n$ \u4e2a\u533a\u95f4\u5305\u542b\uff0c\u5171\u6709 $n\\times A_n^n$ \u4e2a\u3002\n\n\n```cpp\nnamespace XSC062 {\nusing namespace fastIO;\nconst int maxn = 2.5e5 + 15;\nint n, mod, ans;\nint u[maxn], inv[maxn];\ninline int qkp(int x, int y) {\n\tint res = 1;\n\twhile (y) {\n\t\tif (y & 1)\n\t\t\t(res *= x) %= mod;\n\t\t(x *= x) %= mod;\n\t\ty >>= 1;\n\t}\n\treturn res;\n}\ninline void Init(int n) {\n\tu[0] = 1;\n\tinv[0] = 1;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tu[i] = (u[i - 1] * i) % mod;\n\t\tinv[i] = qkp(u[i], mod - 2);\n\t}\n\treturn;\n}\ninline int A(int n, int m) {\n\treturn (u[n] * inv[n - m]) % mod;\n}\nint main() {\n\tread(n);\n\tread(mod);\n\tInit(n + 5);\n\tans = (A(n, n) * n) % mod;\n\tfor (int i = 2; i <= n; ++i) {\n\t\t(ans += (((n - i + 1) * (n - i + 1)) % mod\n\t\t\t\t* A(i, i)) % mod * A(n - i, n - i)\n\t\t\t\t% mod) %= mod;\n\t}\n\tprintf(\"%lld\", ans);\n\treturn 0;\n}\n} // namespace XSC062\n```",
        "postTime": 1659972746,
        "uid": 245052,
        "name": "ollll62",
        "ccfLevel": 7,
        "title": "CF1284C New Year and Permutation"
    },
    {
        "content": "\u6709\u4efb\u4f55\u5173\u4e8e\u6b64\u7bc7\u9898\u89e3\u7684\u95ee\u9898\u7686\u53ef\u79c1\u4fe1[\u6211](https://www.luogu.com.cn/user/101868)\u3002\n\n### \u9898\u76ee\u5206\u6790\n\n\u5176\u5b9e\u4e5f\u5c31\u662f **$p_l$ \u5230 $p_r$ \u5185\u662f\u4e00\u7ec4\u8fde\u7eed\u7684\u6570\u7684\u96c6\u5408**\u5457\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u6765\u7b97\u8d21\u732e\uff0c\u8003\u8651\u6bcf\u4e00\u4e2a\u957f\u5ea6\u7684\u533a\u95f4\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u3002\n\n\u5bf9\u4e00\u4e2a\u957f\u5ea6\u4e3a $k$ \u7684\u8fde\u7eed\u533a\u95f4\uff0c\u6211\u4eec\u9009\u8fd9\u4e2a\u533a\u95f4**\u5728\u539f\u5e8f\u5217\u7684\u4f4d\u7f6e\u6709 $n-k+1$ \u79cd\u9009\u6cd5**\uff0c\u5c06\u8fd9 $k$ \u4e2a\u6570**\u6253\u4e71\u6709 $k!$ \u79cd\u65b9\u6cd5**\u3002\n\n\u7136\u540e\u5408\u6cd5\u7684\u65b9\u6848\u8981\u6c42\u9009\u62e9\u7684\u533a\u95f4\u5185\u5143\u7d20\u8fde\u7eed\uff0c\u6240\u4ee5**\u628a\u8fd9\u4e2a\u533a\u95f4\u770b\u6210\u4e00\u4e2a\u6574\u4f53\u5143\u7d20**\uff0c\u548c\u5176\u4ed6 $n-k$ \u4e2a\u6570\u505a\u4e2a\u6392\u5217\uff0c\u6709 $(n-k+1)!$ \u79cd\u65b9\u6cd5\u3002\n\n\u4f8b\u5982\uff1a\n\n![](https://i.loli.net/2021/07/25/qkofHQxUzw8jECc.png)\n\n\u7edf\u8ba1\u6bcf\u79cd\u957f\u5ea6\u7684\u533a\u95f4\uff0c\u6240\u4ee5**\u7b54\u6848\u5c31\u662f $\\sum_{k=1}^n(n-k+1)!k!(n-k+1)$**\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$\n\n### Details\n\n\u5199\u7ed9\u50cf\u6211\u4e00\u6837\u7684\u6570\u8bba\u65b0\u624b\uff1a**\u9884\u5904\u7406**\u51fa\u6bcf\u4e2a\u6570\u7684\u9636\u4e58\u7684\u6a21\u6570\u3002\n\n### ACcode\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define FOR(i,j,k) for(register int i=j;(j<k)?(i<=k):(i>=k);i+=(j<k)?1:(-1))\n#define IO ios::sync_with_stdio(0),cin.tie(0),cout.tie(0)\n#define N 255000\n\nll n,mod;\nll f[N];//\u5e26\u6a21\u9636\u4e58 \nll sum=0;//ans\u6c42\u548c \nvoid init(){\n\tf[0]=1;\n\tFOR(i,1,n) f[i]=f[i-1]*i%mod;\n}\nsigned main(){\n    IO;\n    cin>>n>>mod;\n    init();\n    FOR(i,1,n) sum=(sum+f[n-i+1]*f[i]%mod*(n-i+1)%mod)%mod;\n\tcout<<sum<<endl;\n    return 0;\n}\n```",
        "postTime": 1627207499,
        "uid": 101868,
        "name": "I_am_Accepted",
        "ccfLevel": 0,
        "title": "CF1284C\u9898\u89e3"
    },
    {
        "content": "# \u9898\u89e3 CF1284C \u3010New Year and Permutation\u3011\n\n[\u672c\u573a\u6bd4\u8d5b\u7684\u9898\u89e3](https://www.cnblogs.com/nblyz2003/p/12151883.html)\n\n\u9898\u76ee\u5927\u610f\uff1a\u8fd9\u9898\u7684\u7ffb\u8bd1\u5c31\u662f\u6211\u63d0\u4f9b\u7684\uff0c\u5220\u6389\u4e86\u3002\n\n\u8fd9\u9053\u9898\u4e00\u5f00\u59cb\u770b\u7684\u65f6\u5019\u6709\u70b9\u614c\uff0c\u6d6a\u8d39\u4e86\u597d\u591a\u65f6\u95f4\u3002\n\n\u540e\u6765\u4e00\u60f3\uff0c\u4e0d\u5c31\u5206\u522b\u7edf\u8ba1\u957f\u5ea6\u4e3ai\u7684\u5b50\u6bb5\u6ee1\u8db3\u6761\u4ef6\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5f88\u8f7b\u677e\u7684\u6c42\u51fa\u4e0d\u540c\u5b50\u6bb5\u51fa\u73b0\u6b21\u6570\uff0c\u6240\u6709\u8be5\u957f\u5ea6\u7684\u5b50\u6bb5\u51fa\u73b0\u6b21\u6570\u4e3a:\n\n    \u6392\u5217\u4e2a\u6570\u00d7\u6bcf\u4e2a\u6392\u5217\u4e2d\u51fa\u73b0\u7684\u6b21\u6570 = n\uff01\u00d7\uff08n - i +1\uff09\n\n\u7136\u540e\u8be5\u957f\u5ea6\u4e0d\u540c\u5b50\u6bb5\u7684\u4e2a\u6570\u4e3an\uff01/ (n - i)\uff01\uff0c\u7a0d\u5fae\u8bc1\u660e\u4e00\u4e0b\u6216\u8005\u5217\u4e3e\u51e0\u4e2a\u4fbf\u53ef\u4ee5\u5f97\u51fa\u3002\n\n\u7136\u540e\u6c42\u6240\u6709\u7b26\u5408\u6761\u4ef6\u7684\u5b57\u6bb5\u4e2a\u6570\uff0c(1\uff0c2\uff0c\u2026\uff0ci ) \u5230\uff08n - i + 1\uff0cn - i + 2\uff0c\u2026\uff0c n \uff09\u4e00\u5171\u6709n - i + 1\u79cd\uff0c\u7136\u540e\u6bcf\u79cd\u7684\u6392\u5217\u6709i\uff01\u4e2a\u3002\n\n    \u6240\u6709\u957f\u5ea6\u4e3ai\u7684\u5b57\u6bb5\u5bf9\u7b54\u6848\u7684\u8d21\u732e = \u4e0d\u540c\u5b50\u6bb5\u7684\u51fa\u73b0\u4e2a\u6570 \u00d7 \u7b26\u5408\u7684\u957f\u5ea6\u4e3ai\u5b50\u6bb5\u7684\u4e2a\u6570\n\n    = n\uff01\u00d7 (n - i + 1) / ( n\uff01/ ( n - i )\uff01) \u00d7 ( n - i + 1 ) \u00d7 i\uff01\n\n    = ( n - i )\uff01 \u00d7 ( n - i + 1) \u00d7 ( n - i +1 ) \u00d7 i\uff01\n\n\u8fd9\u4e2a\u5f0f\u5b50\u770b\u4e0a\u53bb\u633a\u597d\u770b\u7684\uff0c\u7136\u540e\u6c42\u4e2a\u603b\u548c\u5c31\u597d\u3002\n\n\u4ee3\u7801\u7279\u522b\u77ed\uff1a\n\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n#include <vector>\n#define rep(x, l, r) for(int x = l; x <= r; x++)\n#define repd(x, r, l) for(int x = r; x >= l; x--)\n#define clr(x, y) memset(x, y, sizeof(x))\n#define all(x) x.begin(), x.end()\n#define pb push_back\n#define mp make_pair\n#define MAXN 250005\n#define fi first\n#define se second\n#define SZ(x) ((int)x.size())\nusing namespace std;\ntypedef long long ll;\ntypedef vector<int> vi;\ntypedef pair<int, int> pii;\nconst int INF = 1 << 30;\nint p;\nint lowbit(int x){ return x & (-x);}\nint fast_power(int a, int b){ int x; for(x = 1; b; b >>= 1){ if(b & 1) x = 1ll * x * a % p; a = 1ll * a * a % p;} return x % p;}\n\nint pow[MAXN];\n\nint main(){\n\tint n;\n\tscanf(\"%d%d\", &n, &p);\n\tpow[0] = 1;\n\trep(i, 1, n){\n\t\tpow[i] = 1ll * pow[i - 1] * i % p;\n\t}\n\tint ans = 0;\n\trep(i, 1, n){\n\t\tint s = 1ll * pow[n - i] * (n - i + 1) % p * (n - i + 1) % p * pow[i] % p;\n\t\tans = (ans + s) % p;\n\t}\n\tprintf(\"%d\\n\", ans);\n    return 0;\n}\n\n```\n",
        "postTime": 1578198270,
        "uid": 149312,
        "name": "wze\u63cd\u6241\u4e86nm",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1284C \u3010New Year and Permutation\u3011"
    },
    {
        "content": "\n\u76f4\u63a5\u8003\u8651\u4e00\u4e2a\u6392\u5217\u7684\u8d21\u732e\u662f\u4e0d\u73b0\u5b9e\u7684\uff0c\u5e94\u5206\u79bb\u7b97\u8d21\u732e\uff0c\u8003\u8651\u6bcf\u4e2a\u8fde\u7eed\u7684\u6bb5\u51fa\u73b0\u7684\u6b21\u6570\u3002\n\n\u679a\u4e3e\u6bb5\u957f $l$ \u548c\u6bb5\u4e2d\u6700\u5927\u503c $x$ \uff0c\u90a3\u4e48\u8fd9\u6bb5\u5c31\u662f\u7531 $x - l + 1$ \u5230 $x$ \u6784\u6210\u7684\u4e00\u4e2a\u8fde\u7eed\u533a\u95f4\u3002\n\n\u8fd9\u4e2a\u533a\u95f4\u5728\u6240\u6709\u6392\u5217\u7684\u51fa\u73b0\u6b21\u6570\u662f\u5f88\u597d\u7edf\u8ba1\u7684\uff0c\u9996\u5148\u5728 $n$ \u4e2a\u4f4d\u7f6e\u9009\u51fa\u957f\u4e3a $l$ \u7684\u533a\u95f4\u7684\u65b9\u6848\u4e3a $n - l + 1$ \uff0c  \n\u7136\u540e\u6bb5\u5185\u968f\u610f\u6392\u5217\uff0c\u65b9\u6848\u4e3a $l!$ \uff0c\u6bb5\u5916\u968f\u610f\u6392\u5217\uff0c\u65b9\u6848\u4e3a $(n - l)!$ \u3002\n\n\u7136\u800c\u679a\u4e3e $l, x$ \u662f $O(n^2)$ \u7684\uff0c\u4f46\u662f\u4ece\u4e0a\u9762\u7684\u5206\u6790\u4e0d\u96be\u770b\u51fa\u4e00\u4e2a\u957f\u4e3a $l$ \u7684\u533a\u95f4\u7684\u51fa\u73b0\u6b21\u6570\u4e0e $x$ \u65e0\u5173\u3002\n\n\u90a3\u4e48\u53ea\u9700\u8981 $O(n)$ \u679a\u4e3e $l$ \uff0c\u5176\u5bf9\u5e94\u7684 $x$ \u6709 $(n - l + 1)$ \u4e2a\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\u7b54\u6848\u4e3a $\\sum_{l=1}^n l! (n-l)! (n-l+1)^2$ \u3002\n\n\u53c2\u8003\u5b9e\u73b0\uff1a\n\n```cpp\n#include <cstdio>\n#include <algorithm>\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n\ntypedef long long ll;\n\nstruct {\n\tinline operator int () { int x; return scanf(\"%d\", &x), x; }\n\tinline operator ll () { ll x; return scanf(\"%lld\", &x), x; }\n\ttemplate<class T> inline void operator () (T &x) { x = *this; }\n\ttemplate<class T, class ...A> inline void operator () (T &x, A &...a)\n\t{ x = *this; this -> operator ()(a...); }\n} read;\n\nconst int maxn = 250005;\nll fac[maxn];\n\nint main() {\n\tint n = read, mod = read;\n\n\tfac[0] = 1;\n\tfor(int i = 1; i <= n; i ++)\n\t\tfac[i] = fac[i - 1] * i % mod;\n\n\tll ans = 0;\n\tfor(int l = 1; l <= n; l ++)\n\t\t(ans += fac[l] * fac[n - l] % mod * (n - l + 1) % mod * (n - l + 1)) %= mod;\n\tprintf(\"%lld\\n\", ans);\n}\n\n```",
        "postTime": 1578193450,
        "uid": 52232,
        "name": "Kewth",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1284C \u3010New Year and Permutation\u3011"
    }
]
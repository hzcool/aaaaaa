[
    {
        "content": "\u4ee4 $v_p(n)$\uff08$p$ \u662f\u8d28\u6570\uff0c$n$ \u662f\u6b63\u6574\u6570\uff09\u8868\u793a $n$ \u7684\u6807\u51c6\u5206\u89e3\u5f0f\u4e2d\u7684 $p$ \u7684\u5e42\u6b21\u3002\n\n\u53ef\u4ee5\u53d1\u73b0 $\\displaystyle v_p \\!\\left( \\binom{a + b}{a} \\right) = v_p( (a + b)! ) - v_p(a!) - v_p(b!)$\u3002\n\n\u5c06 $a, b$ \u8868\u793a\u4e3a $p$ \u8fdb\u5236\u6570\u540e\uff0c\u4e0d\u96be\u53d1\u73b0\uff0c\u5728 $p$ \u8fdb\u5236\u4e0b\u8fdb\u884c $a$ \u548c $b$ \u7684\u52a0\u6cd5\u8fd0\u7b97\u65f6\uff0c\u8fdb\u4f4d\u7684\u6b21\u6570\u6070\u597d\u7b49\u4e8e $\\displaystyle v_p \\!\\left( \\binom{a + b}{a} \\right)$\u3002\n\n\u6240\u4ee5\u5c06 $A$ \u8f6c\u4e3a $p$ \u8fdb\u5236\u6570\uff08\u6734\u7d20\u5b9e\u73b0\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal O (\\log A \\cdot \\log_p A)$\uff09\u540e\u8fdb\u884c\u6570\u4f4d DP \u5373\u53ef\u3002\n\n\u4ee4 $f(i, j, 0/1, 0/1)$ \u8868\u793a\u5f53\u4f4d\u6570\u4ece\u9ad8\u5230\u4f4e\u8003\u8651\u5230 $A$ \u7684\u7b2c $i$ \u4f4d\uff0c\u603b\u5171\u8fdb\u4f4d\u4e86 $j$ \u6b21\uff0c$a + b$\uff08\u5c0f\u4e8e / \u7b49\u4e8e\uff09$A$ \u4e14\uff08\u4e0d\u63a5\u53d7 / \u63a5\u53d7\uff09\u4f4e\u4e00\u4f4d\u7684\u8fdb\u4f4d\u65f6\u7684 $a, b$ \u7684\u53d6\u503c\u65b9\u6848\u6570\u3002\u4ee5 $i$ \u4f5c\u4e3a\u9636\u6bb5\uff0c\u4ece\u5927\u5230\u5c0f\u8fdb\u884c\u8f6c\u79fb\u3002\u5219\u7b54\u6848\u4e3a $\\displaystyle \\sum_{j \\ge \\alpha} f(0, j, 0, 0) + f(0, j, 1, 0)$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal O \\!\\left( \\log_p A \\!\\left( \\log A + \\log_p A \\right) \\right)$\uff0c[\u8bc4\u6d4b\u94fe\u63a5](https://codeforces.com/contest/582/submission/65943994)\u3002",
        "postTime": 1583442542,
        "uid": 10703,
        "name": "\u5c0f\u7c89\u5154",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF582D \u3010Number of Binominal Coefficients\u3011"
    },
    {
        "content": "[\u5e93\u9ed8\u5c14\u5b9a\u7406](https://baike.baidu.com/item/%E5%BA%93%E9%BB%98%E5%B0%94%E5%AE%9A%E7%90%86/16849129?fr=aladdin)\n\n\u5b9a\u7406\uff1a$\\binom{n+m}{m}$ \u4e2d\u8d28\u6570 $p$ \u7684\u5e42\u6b21\u4e3a $n$ \u4e0e $m$ \u7684 $p$ \u8fdb\u5236\u8868\u793a\u76f8\u52a0\u7684\u8fdb\u4f4d\u6b21\u6570\u3002\n\n\u6709\u4e86\u8fd9\u4e2a\u5b9a\u7406\u4ee5\u540e\uff0c\u9898\u610f\u5c31\u53ef\u4ee5\u8f6c\u5316\u6210\u6c42\u6709\u591a\u5c11\u5bf9 $n,m$ \u76f8\u52a0\u5c0f\u4e8e $A$\uff0c\u4e14\u5728 $p$ \u8fdb\u5236\u4e0b\u76f8\u52a0\u7684\u8fdb\u4f4d\u6b21\u6570 $\\geq \\alpha$\u3002\u8bbe\u8ba1\u4e00\u4e2a\u6570\u4f4d dp\u3002\n\n$dp_{i,j,0/1,0/1}$ \u8868\u793a $p$ \u8fdb\u5236\u4e0b\u524d $i$ \u4f4d\uff0c\u8fdb\u4f4d $j$ \u6b21\uff08\u5305\u62ec\u8fdb\u5230\u5f53\u524d\u4f4d\uff09\uff0c\u662f\u5426\u5c0f\u4e8e\u4e0a\u754c\uff0c\u540e\u4e00\u4f4d\u662f\u5426\u5411\u524d\u8fdb\u4f4d\u7684\u60c5\u51b5\u4e0b\u7684\u65b9\u6848\u6570\u3002\u6bcf\u6b21\u67e5\u770b\u4e0b\u4e00\u4f4d\u4e24\u6570\u6570\u7801\u548c\u7684\u53d6\u503c\u8303\u56f4\u6765\u6c42\u89e3\u8f6c\u79fb\u7cfb\u6570\uff0c\u4ee5\u4e0b\u7528\u5b9e\u9645\u503c\u8868\u793a\u3002\n\n$dp_{i,j,0,0} \\rightarrow dp_{i+1,j,0/1,0}$\uff1a\u7b49\u4e8e\u4e0a\u754c $x$\uff080\uff09\uff0c\u5b9e\u9645\u503c $x$\uff0c\u7cfb\u6570\u4e3a $x+1$\uff1b\u5c0f\u4e8e\u4e0a\u754c $x$\uff081\uff09\uff0c\u5b9e\u9645\u503c $0$ \u5230 $x-1$\uff0c\u7cfb\u6570\u4e3a $\\frac{x(x+1)}{2}$\n\n$dp_{i,j,0,0} \\rightarrow dp_{i+1,j+1,0/1,1}$\uff1a\u7b49\u4e8e\u4e0a\u754c $x$\uff080\uff09\uff0c\u5b9e\u9645\u503c $x-1$\uff0c\u7cfb\u6570\u4e3a $x$\uff1b\u5c0f\u4e8e\u4e0a\u754c $x$\uff081\uff09\uff0c\u5b9e\u9645\u503c $0$ \u5230 $x-2$\uff0c\u7cfb\u6570\u4e3a $\\frac{(x-1)x}{2}$\n\n$dp_{i,j,0,1} \\rightarrow dp_{i+1,j,0/1,0}$\uff1a\u7b49\u4e8e\u4e0a\u754c $x$\uff080\uff09\uff0c\u5b9e\u9645\u503c $p+x$\uff0c\u7cfb\u6570\u4e3a $p-1-x$\uff1b\u5c0f\u4e8e\u4e0a\u754c $x$\uff081\uff09\uff0c\u5b9e\u9645\u503c $p$ \u5230 $p+x-1$\uff0c\u7cfb\u6570\u4e3a $\\frac{x(2p-1-x)}{2}$\n\n$ dp_{i,j,0,1} \\rightarrow dp_{i+1,j+1,0/1,1}$\uff1a\u7b49\u4e8e\u4e0a\u754c $x$\uff080\uff09\uff0c\u5b9e\u9645\u503c $p-1+x$\uff0c\u7cfb\u6570\u4e3a $p+1-x$\uff1b\u5c0f\u4e8e\u4e0a\u754c $x$\uff081\uff09\uff0c\u5b9e\u9645\u503c $p-1$ \u5230 $p-1+x-1$\uff0c\u7cfb\u6570\u4e3a $\\frac{x(2p+1-x)}{2}$\n\n$dp_{i,j,1,0} \\rightarrow dp_{i+1,j,1,0}$\uff1a\u4efb\u53d6\uff0c\u548c $< p$\u3002\u7cfb\u6570\u4e3a $\\frac{p(p+1)}{2}$\u3002\n\n$dp_{i,j,1,0} \\rightarrow dp_{i+1,j+1,1,1}$\uff1a\u4efb\u53d6\uff0c\u548c $< p-1$\u3002\u7cfb\u6570\u4e3a $\\frac{(p-1)p}{2}$\u3002\n\n$dp_{i,j,1,1} \\rightarrow dp_{i+1,j,1,0}$\uff1a\u4efb\u53d6\uff0c\u548c $\\geq p$\u3002\u7cfb\u6570\u4e3a $\\frac{(p-1)p}{2}$\u3002\n\n$dp_{i,j,1,1} \\rightarrow dp_{i+1,j+1,1,1}$\uff1a\u4efb\u53d6\uff0c\u548c $\\geq p-1$\u3002\u7cfb\u6570\u4e3a $\\frac{p(p+1)}{2}$\u3002\n\n```c++\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\nconst int N=3505,MOD=1e9+7;\nchar s[N];\nlong long lim[N];\nint lc=1,dp[N][N][2][2];\nint main()\n{\n    int p,a,n,i,j;\n    scanf(\"%d%d%s\",&p,&a,s+1);n=strlen(s+1);\n    for(i=1;i<=n;i++)\n    {\n    \tfor(j=1;j<=lc;j++) lim[j]=10ll*lim[j];\n    \tlim[1]+=s[i]-'0';\n    \tfor(j=1;j<=lc;j++)\n    \t{\n    \t\tlim[j+1]+=lim[j]/p;\n    \t\tlim[j]%=p;\n    \t\tif(lim[lc+1]) lc++;\n    \t}\n    }\n    for(i=1;i<=lc/2;i++) swap(lim[i],lim[lc-i+1]);\n    dp[0][0][0][0]=1;\n    for(i=0;i<lc;i++)\n    {\n    \tint x=lim[i+1];\n    \tfor(j=0;j<=i;j++)\n    \t{\n    \t\tdp[i+1][j][0][0]=(dp[i+1][j][0][0]+1ll*(x+1)*dp[i][j][0][0])%MOD;\n    \t\tdp[i+1][j][1][0]=(dp[i+1][j][1][0]+1ll*(1ll*x*(x+1)/2%MOD)*dp[i][j][0][0])%MOD;\n    \t\tdp[i+1][j+1][0][1]=(dp[i+1][j+1][0][1]+1ll*x*dp[i][j][0][0])%MOD;\n    \t\tdp[i+1][j+1][1][1]=(dp[i+1][j+1][1][1]+1ll*(1ll*(x-1)*x/2%MOD)*dp[i][j][0][0])%MOD;\n    \t\tdp[i+1][j][0][0]=(dp[i+1][j][0][0]+1ll*(p-1-x)*dp[i][j][0][1])%MOD;\n    \t\tdp[i+1][j][1][0]=(dp[i+1][j][1][0]+1ll*(1ll*x*(p*2-1-x)/2%MOD)*dp[i][j][0][1])%MOD;\n    \t\tdp[i+1][j+1][0][1]=(dp[i+1][j+1][0][1]+1ll*(p-x)*dp[i][j][0][1])%MOD;\n    \t\tdp[i+1][j+1][1][1]=(dp[i+1][j+1][1][1]+1ll*(1ll*x*(p*2+1-x)/2%MOD)*dp[i][j][0][1])%MOD;\n    \t\tdp[i+1][j][1][0]=(dp[i+1][j][1][0]+1ll*(1ll*p*(p+1)/2%MOD)*dp[i][j][1][0])%MOD;\n    \t\tdp[i+1][j+1][1][1]=(dp[i+1][j+1][1][1]+1ll*(1ll*(p-1)*p/2%MOD)*dp[i][j][1][0])%MOD;\n    \t\tdp[i+1][j][1][0]=(dp[i+1][j][1][0]+1ll*(1ll*(p-1)*p/2%MOD)*dp[i][j][1][1])%MOD;\n    \t\tdp[i+1][j+1][1][1]=(dp[i+1][j+1][1][1]+1ll*(1ll*p*(p+1)/2%MOD)*dp[i][j][1][1])%MOD;\n    \t}\n    }\n    int ans=0;\n    for(i=a;i<=lc;i++) ans=(0ll+ans+dp[lc][i][0][0]+dp[lc][i][1][0])%MOD;\n    printf(\"%d\",ans);\n    return 0;\n}\n```",
        "postTime": 1608911959,
        "uid": 103732,
        "name": "smarthehe",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF582D \u3010Number of Binominal Coefficients\u3011"
    },
    {
        "content": "\u601d\u8def\u4e0d\u5c11\u9898\u89e3\u5df2\u7ecf\u8bb2\u5f97\u591f\u6e05\u695a\u4e86\uff0c\u4f46\u73b0\u6709\u9898\u89e3\u7f3a\u5c11\u5bf9\u8fd9\u4e2a\u7e41\u7410\u7684DP\u8f6c\u79fb\u7684\u8be6\u7ec6\u5206\u6790\u3002  \n\u8fd9\u7bc7\u9898\u89e3\u662f\u7ed9 @Kinandra \u7684\u9898\u89e3\u7684\u4ee3\u7801\u4f5c**\u6ce8\u89e3**\u7684\u3002  \n\u5148\u5f15\u7528 @Kinandra \u4ee3\u7801\u7684DP\u90e8\u5206\u3002 \n```cpp\nvoid work() {\n        f[len + 1][0][0][1] = 1;\n        for (int i = len, c1, c2, c3, c4, c5, c6; i >= 1; --i) {\n            c1 = 1ll * (p + 1) * p / 2 % mod,\n            c2 = 1ll * (x[i] + 1) * x[i] / 2 % mod,\n            c3 = 1ll * p * (p - 1) / 2 % mod,\n            c4 = 1ll * x[i] * ((p << 1) - x[i] - 1) / 2 % mod,\n            c5 = 1ll * x[i] * (x[i] - 1) / 2 % mod,\n            c6 = 1ll * x[i] * ((p << 1) - x[i] + 1) / 2 % mod;\n\n            for (int j = 0, f0, f1, f2, f3; j <= len - i + 1; ++j) {\n                f0 = f[i + 1][j][0][0], f1 = f[i + 1][j][0][1],\n                f2 = f[i + 1][j][1][0], f3 = f[i + 1][j][1][1];\n                if (!f0 && !f1 && !f2 && !f3) continue;\n                f[i][j][0][0] = (1ll * c1 * f0 % mod + 1ll * c2 * f1 % mod +\n                                 1ll * c3 * f2 % mod + 1ll * c4 * f3 % mod) %\n                                mod;\n                f[i][j][0][1] = M(1ll * (x[i] + 1) * f1 % mod +\n                                  1ll * (p - x[i] - 1) * f3 % mod);\n                f[i][j + 1][1][0] =\n                    (1ll * c3 * f0 % mod + 1ll * c5 * f1 % mod +\n                     1ll * c1 * f2 % mod + 1ll * c6 * f3 % mod) %\n                    mod;\n                f[i][j + 1][1][1] =\n                    M(1ll * x[i] * f1 % mod + 1ll * (p - x[i]) * f3 % mod);\n            }\n        }\n        int res = 0;\n        for (int i = alpha; i <= len; ++i)\n            res = M(res + M(f[1][i][0][0] + f[1][i][0][1]));\n        printf(\"%d\\n\", res);\n    }\n```\n\u53ef\u80fd\u6709\u70b9\u6655\uff0c\u522b\u7740\u6025\uff0c\u6211\u4eec\u6162\u6162\u5206\u6790\u3002  \n\u5148\u7ea6\u5b9a\u6700\u4f4e\u4f4d\u4e3a\u7b2c $1$ \u4f4d\u3002\n1. \u4ee4 $a=k,b=n-k$\uff0c\u90a3\u4e48\u6211\u4eec\u8981\u89e3\u51b3\u7684\u95ee\u9898\u662f\uff0c\u6c42 $p$ \u8fdb\u5236\u4e0b\u6ee1\u8db3 $0\\le a,0\\le b,a+b \\le A$ \u4e14 $a+b$ \u8fdb\u4f4d\u6b21\u6570\u5927\u4e8e\u7b49\u4e8e $\\alpha$ \u7684 $(a,b)$ \u7684\u5bf9\u6570\u3002\n2. $f_{i,j,0/1,0/1}$ \u8868\u793a\u8003\u8651\u4e86\u6700\u9ad8\u4f4d\u5230\u7b2c $i$ \u4f4d\uff0c\u6709 $j$ \u6b21\u8fdb\u4f4d\uff0c\u7b2c $i$ \u4f4d\u5426/\u662f\u63a5\u53d7\u4e86\u7b2c $i-1$ \u4f4d\u7684\u8fdb\u4f4d\uff0c\u6700\u9ad8\u4f4d\u5230\u7b2c $i$ \u4f4d\u5426/\u662f\u8fbe\u5230\u4e0a\u754c $A$ \u7684 $(a,b)$ \u5bf9\u6570\u3002\n3. \u7b2c4~9\u70b9\u5c06\u4f9d\u6b21\u89e3\u91ca\u4ee3\u7801\u4e2d\u7684 $c1,c2,c3,c4,c5,c6$ \u7684\u610f\u601d\uff0c\u4ed6\u4eec\u5206\u522b\u8868\u793a\u4e00\u4e2a\u5173\u4e8e $a',b'$ \u7684\u4e0d\u7b49\u5f0f\u7684\u7684\u89e3\u7684\u4e2a\u6570\uff0c\u8be5\u5904\u7684 $a',b'$ \u5206\u522b\u8868\u793a $a,b$ \u7684\u7b2c $i$ \u4f4d\uff0c\u56e0\u6b64 $0\\le a',b'\\le p-1$\u3002\n\n4. $c1$ \u8868\u793a $a'+b'<p$ \u7684\u89e3\u7684\u4e2a\u6570\uff0c\u5373**\u4e0d\u8fdb\u4f4d**\u4e14**\u4e0d\u53d7 $A$ \u9650\u5236**\u3002\n5. $c2$ \u8868\u793a $a'+b'<x_i$ \u7684\u89e3\u7684\u4e2a\u6570\uff0c\u5373**\u4e0d\u8fdb\u4f4d**\u4e14**\u53d7 $A$ \u9650\u5236**\u4f46**\u4e0d\u7b49\u4e8e$A$**\u3002\n6. $c3$ \u8868\u793a $a'+b'\\ge p$ \u7684\u89e3\u7684\u4e2a\u6570\uff0c\u5373**\u8fdb\u4f4d**\u4e14**\u4e0d\u53d7 $A$ \u9650\u5236**\u3002\n7. $c4$ \u8868\u793a $ p\\le a'+b'< p+x_i$ \u7684\u89e3\u7684\u4e2a\u6570\uff0c\u5373**\u8fdb\u4f4d**\u4e14**\u53d7 $A$ \u9650\u5236**\u4f46**\u4e0d\u7b49\u4e8e$A$**\u3002\u8fd9\u91cc\u7a0d\u5fae\u89e3\u91ca\u4e00\u4e0b $x_i\u00b7(2p-x_i-1)/2$ \u662f\u600e\u4e48\u6765\u7684\u3002\u679a\u4e3e $a'+b'$ \u7684\u503c\uff0c\u6709\n$$\\sum_{i=p}^{p+x_i-1}\\sum_{0\\le a'}^{p-1}\\sum_{0\\le b'}^{p-1}[a'+b'=i]$$\n$$\\sum_{i=p}^{p+x_i-1}\\sum_{0\\le a'}^{p-1}[0\\le i-a'\\le p-1]$$\n$$\\sum_{i=p}^{p+x_i-1}\\sum_{0\\le a'}^{p-1}[i-p+1\\le a'\\le i]$$\n$$\\sum_{i=p}^{p+x_i-1}\\sum_{a'}[\\max(0,i-p+1)\\le a'\\le \\min(p-1,i)]$$\n\u7531\u4e8e $i-p+1>0,i>p-1$ \u6240\u4ee5\u5176\u5b9e\u662f\n$$\\sum_{i=p}^{p+x_i-1}2p-i-1=x_i\u00b7(2p-x_i-1)/2$$\n8. $c5$ \u8868\u793a $a'+b'+1<x_i$ \u5373**\u63a5\u53d7\u4e86\u8fdb\u4f4d**\u4e14**\u4e0d\u8fdb\u4f4d**\u4e14**\u53d7 $A$ \u9650\u5236**\u4f46**\u4e0d\u7b49\u4e8e $A$**\u3002\n9. $c6$ \u8868\u793a $p\\le a'+b'+1< p+x_i$ \u5373**\u63a5\u53d7\u4e86\u8fdb\u4f4d**\u4e14**\u8fdb\u4f4d**\u4e14**\u53d7 $A$ \u9650\u5236**\u4f46**\u4e0d\u7b49\u4e8e $A$**\u3002\n10. \u73b0\u5728 $f_{i,j,0/1,0}$ \u7684\u8f6c\u79fb\u5e94\u8be5\u80fd\u770b\u61c2\u4e86\uff0c\u7b2c11~12\u70b9\u5c06\u89e3\u91ca $f_{i,j,0/1,1}$\u7684\u8f6c\u79fb\uff0c\u5b83\u4eec\u90fd\u8868\u793a\u94a6\u5b9a\u5728\u7b2c $i$ \u4f4d\u4e0a\u7b49\u4e8e $x_i$\uff0c\u533a\u522b\u662f\u662f\u5426\u63a5\u53d7\u4e86\u8fdb\u4f4d\u3002\n11. \u5bf9\u4e8e $f_{i,j,0,1}$\uff0c$x[i]+1$ \u5373 $a'+b'=x_i$ \u7684\u89e3\u7684\u6570\u91cf\uff0c$p-x_i-1$ \u5373 $a'+b'=p+x_i$ \u7684\u89e3\u7684\u6570\u91cf\u3002\n12. \u5bf9\u4e8e $f_{i,j,1,1}$\uff0c$x[i]$ \u5373 $a'+b'+1=x_i$ \u7684\u89e3\u7684\u6570\u91cf\uff0c$p-x_i$ \u5373 $a'+b'+1=p+x_i$ \u7684\u89e3\u7684\u6570\u91cf\u3002\n\n\u6700\u540e\u5410\u69fd\u4e00\u53e5\uff0ccf3300\u7684dp\u5728\u4f60\u8c37\u7adf\u7136\u662f\u7d2b\u9898\uff0c\u8fd9\u5c31\u662f\u4f60\u8c37\u5e73\u5747\u6c34\u5e73\u5417\uff0c\u7231\u4e86\u7231\u4e86\u3002",
        "postTime": 1598347790,
        "uid": 118092,
        "name": "\u9752\u541b",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF582D \u3010Number of Binominal Coefficients\u3011"
    },
    {
        "content": "\u7ec8\u4e8e\u8fc7\u4e86\uff0c\u53d1\u7bc7\u9898\u89e3\u7eaa\u5ff5\u4e00\u4e0b\uff0c\u987a\u4fbf\u75db\u6279 @\\_lxy_ \u5728 NOIP \u6a21\u62df\u8d5b T4 \u51fa\u8fd9\u9053\u7801\u91cf\u9898\uff0c\u800c\u4e14\u81ea\u5df1\u8fd8\u4e0d\u5199\u6807\u7a0b\u76f4\u63a5\u642c\u9898\u89e3\u7684 \\fn\u3002\n\n\u8fd9\u4e2a 3300 \u7684\u8bc4\u7ea7\u81f3\u5c11\u6709 1000 \u662f\u7801\u91cf\u5206\uff0c\u8fd9\u9898\u80fd\u51fa\u5728\u4e24\u4e2a\u5c0f\u65f6\u7684 CF \u91cc\u4e5f\u771f\u662f\u7f55\u89c1\u3002\n\n\u6a21\u62df\u8d5b\u642c\u4e86\u8fd9\u9898\uff0c\u5199\u5b8c\u522b\u7684\u9898\u540e\u5f00\u59cb\u72c2\u5e72\uff0c\u6700\u540e\u8fd8\u662f\u6ca1\u5e72\u5b8c\uff0c\u53c8\u8c03\u4e86\u4e00\u4e0b\u5348\u624d\u8c03\u8fc7\u53bb\uff0c\u5b8c\u7f8e\u590d\u523b\u4e86 CSP2022\u3002\n\n\u9996\u5148\uff0c\u6709\u4e00\u4e2a\u5e7f\u4e3a\u4eba\u77e5\u7684\u7ed3\u8bba\uff1a$n!$ \u4e2d\u7684\u8d28\u56e0\u6570 $p$ \u7684\u4e2a\u6570\u4e3a $\\sum\\limits_{i=1}^\\infty \\lfloor \\dfrac n{p^i} \\rfloor$\u3002\u90a3\u4e48 $C_n^k = \\dfrac{n!}{k!(n-k)!}$ \u7684\u8d28\u56e0\u6570\u4e2a\u6570\u5c31\u662f $\\sum\\limits_{i=1}^\\infty \\lfloor \\dfrac n{p^i} \\rfloor - \\lfloor \\dfrac k{p^i} \\rfloor - \\lfloor \\dfrac {n-k}{p^i} \\rfloor$\u3002\u90a3\u4e48\u8fd9\u4e2a\u5f0f\u5b50\u7684\u67d0\u4e00\u9879\u4e3a 1 \u5f53\u4e14\u4ec5\u5f53 $k \\mod p^i + (n-k) \\bmod p^i \\ge p^i$\u3002\n\n\u90a3\u4e48\u539f\u95ee\u9898\u53ef\u4ee5\u8f6c\u6362\u4e3a\uff1a\u5728 $p$ \u8fdb\u5236\u4e0b $k$ \u52a0 $n-k$ \u9700\u8981\u6709\u81f3\u5c11 $\\alpha$ \u4e2a\u8fdb\u4f4d\uff0c\u90a3\u4e48\u6570\u4f4d DP \u5c31\u662f\u663e\u800c\u6613\u89c1\u7684\u4e86\u3002\n\n\u6211\u7684\u505a\u6cd5\u4e0d\u592a\u4e00\u6837\uff0c\u56e0\u4e3a\u8981\u8003\u8651\u8fdb\u4f4d\uff0c\u6240\u4ee5\u6211\u662f\u4ece\u4f4e\u4f4d\u5411\u9ad8\u4f4d\u8003\u8651\u7684\uff0c\u6211\u7528 $dp_{i,j,0/1,0/1/2}$ \u8868\u793a\u6700\u4f4e\u7684 $i$ \u4f4d\u6709 $j$ \u4e2a\u8fdb\u4f4d\uff08\u4ee3\u7801\u5b9e\u73b0\u4e2d\u4e0d\u7b97\u7b2c $i$ \u4f4d\u8fdb\u7684\uff09\uff0c\u7b2c $i$ \u4f4d\u662f\u5426\u8fdb\u4f4d\uff0c\u5f53\u524d\u7684 $n$ \u7684\u524d $i$ \u4f4d\uff08\u4e0d\u7b97\u7b2c $i$ \u4f4d\u7684\u8fdb\u4f4d\uff09\u4e0e $n$ \u7684\u524d $i$ \u4f4d\u7684\u5927\u5c0f\u5173\u7cfb\uff080 \u8868\u793a\u5c0f\u4e8e\uff0c1 \u8868\u793a\u7b49\u4e8e\uff0c2 \u8868\u793a\u5927\u4e8e\uff09\u3002\n\n\u7136\u540e\u5c31\u7801\u5c31\u884c\u4e86\uff0c\u6211\u7801\u4e86\u8fd1 4K\uff0c\u800c\u4e14\u6ce8\u610f 6 \u500d\u7684\u5e38\u6570\u7a7a\u95f4\u52a0 long long \u53ef\u80fd\u4f1a MLE\uff0c\u6240\u4ee5\u9700\u8981\u6eda\u52a8\u6570\u7ec4\u3002\n\n\u4e00\u4e2a\u4e0b\u5348\u4ece```3 1 9```\u8c03\u5230```3 1 18```\uff0c\u63a5\u7740\u53c8\u8c03\u5230```3 1 42```\uff0c\u7801\u91cf DP \u4e00\u751f\u4e4b\u654c\u3002\n\n\u4ee3\u7801\n```\n#include<cstdio>\n#define TY ll\n#define MAXN 1002\n#define MAXM 3400\n#define debug if( 1 &&putchar('>'))\n#define FOR(i,a,b) for(TY i=(a);i<=(b);i=-~i)\n#define fOR(i,a,b) for(TY i=(a);i<(b);i=-~i)\n#define ROF(i,a,b) for(TY i=(a);i>=(b);i=~-i)\n#define rOF(i,a,b) for(TY i=(a);i>(b);i=~-i)\nusing namespace std;\ntypedef long long ll;\nconst TY M=1e9+7;\ntypedef unsigned long long ull;\nTY _abs(TY a){return a<0?-a:a;}\nTY maxn(TY a,TY b){return a>b?a:b;}\nTY minn(TY a,TY b){return a<b?a:b;}\nTY gcd(TY a,TY b){return b?gcd(b,a%b):a;}\nTY qp(TY a,TY b){TY ans=1;do{if(1&b)ans=ans*a%M;a=a*a%M;}while(b>>=1);return ans;}\nchar getc(){char ch=getchar();while(ch==' '||ch=='\\n'||ch=='\\r')ch=getchar();return ch;}\nTY qr(){\n\tchar ch=getchar();TY s=0,x=1;\n\tfor(;ch<'0'||ch>'9';ch=getchar())if(ch=='-')x=-1;\n\tfor(;ch>='0'&&ch<='9';ch=getchar())s=s*10+ch-'0';return x*s;\n}void qw1(TY a){if(a>9)qw1(a/10);putchar(a%10+'0');}\nvoid qw(TY a,char ch){\n\tif(a<0){a=-a;putchar('-');}\n\tif(a>9)qw1(a/10);putchar(a%10+'0');\n\tif(ch)putchar(ch);\n}TY n,m,k,x,y,z,tmp,val,a[MAXN],b[MAXM],cnt,ans;\nTY dp[MAXM][2][3],lst[MAXM][2][3];char s[MAXN];\ninline TY js(TY x){\n\tif(x<n)return ((x+2)*(x+1)>>1)%M;\n\tx=(n<<1)-1-x;x=z-(x*(x-1)>>1)%M;\n\treturn x<0?x+M:x;\n}int main(){\n\tn=qr();k=qr();scanf(\"%s\",s+1);\n\twhile(s[m+1])m=-~m;FOR(i,1,m)a[m-i+1]=s[i]^48;\n\twhile(m){\n\t\tx=0;ROF(i,m,1){\n\t\t\ta[i]+=x*10;x=a[i]%n;a[i]/=n;\n\t\t}b[cnt=-~cnt]=x;while(m&&!a[m])m=~-m;\n\t}if(k>=cnt){putchar('0');return 0;}//\u8f6c n \u8fdb\u5236 + \u5224\u65e0\u89e3 \n\tz=n*n%M;x=js(n-2);y=js(n-1);\n\tFOR(i,lst[0][0][1]=1,cnt){\n\t\ttmp=js(n+b[i]-1);val=js(b[i]-1);\n\t\tfOR(j,0,i){//\u5927\u81f4\u6309\u987a\u5e8f\u662f(0,0),(0,1),(0,2),(1,0),(1,1),(1,2)\u7684\u8f6c\u79fb \n\t\t\tdp[j][0][0]=lst[j][0][0]*js(b[i])%M;\n\t\t\tif(b[i]){\n\t\t\t\tdp[j][0][0]=(dp[j][0][0]+lst[j][0][1]*val)%M;\n\t\t\t\tdp[j][0][0]=(dp[j][0][0]+lst[j][0][2]*val)%M;\n\t\t\t\tif(j){\n\t\t\t\t\tif(b[i]>1){\n\t\t\t\t\t\tdp[j][0][0]=(dp[j][0][0]+lst[j-1][1][1]*js(b[i]-2))%M;\n\t\t\t\t\t\tdp[j][0][0]=(dp[j][0][0]+lst[j-1][1][2]*js(b[i]-2))%M;\n\t\t\t\t\t}dp[j][0][0]=(dp[j][0][0]+lst[j-1][1][0]*val)%M;\n\t\t\t\t}\n\t\t\t}if(!b[i])dp[j][0][1]=lst[j][0][1];\n\t\t\telse dp[j][0][1]=lst[j][0][1]*(js(b[i])-val+M)%M;\n\t\t\tif(j&&b[i]){\n\t\t\t\tif(b[i]==1)dp[j][0][1]=(dp[j][0][1]+lst[j-1][1][1])%M;\n\t\t\t\telse dp[j][0][1]=(dp[j][0][1]+lst[j-1][1][1]*(val-js(b[i]-2)+M))%M;\n\t\t\t}if(!b[i])dp[j][0][2]=lst[j][0][2]*y%M;\n\t\t\telse dp[j][0][2]=lst[j][0][2]*(y-val+M)%M;\n\t\t\tif(j){\n\t\t\t\tif(b[i]){\n\t\t\t\t\tdp[j][0][2]=(dp[j][0][2]+lst[j-1][1][1]*(x-val+M))%M;\n\t\t\t\t\tdp[j][0][2]=(dp[j][0][2]+lst[j-1][1][0]*(x-val+M))%M;\n\t\t\t\t}else{\n\t\t\t\t\tdp[j][0][2]=(dp[j][0][2]+lst[j-1][1][1]*x)%M;\n\t\t\t\t\tdp[j][0][2]=(dp[j][0][2]+lst[j-1][1][0]*x)%M;\n\t\t\t\t}if(b[i]<=1)dp[j][0][2]=(dp[j][0][2]+lst[j-1][1][2]*x)%M;\n\t\t\t\telse dp[j][0][2]=(dp[j][0][2]+lst[j-1][1][2]*(x-js(b[i]-2)+M))%M;\n\t\t\t}dp[j][0][2]=(dp[j][0][2]+lst[j][0][1]*(y-js(b[i])+M))%M;\n\t\t\tdp[j][0][2]=(dp[j][0][2]+lst[j][0][0]*(y-js(b[i])+M))%M;\n\t\t\tdp[j][1][0]=lst[j][0][0]*(js(n+b[i])-y+M)%M;\n\t\t\tif(b[i]){\n\t\t\t\tdp[j][1][0]=(dp[j][1][0]+lst[j][0][1]*(tmp-y+M))%M;\n\t\t\t\tdp[j][1][0]=(dp[j][1][0]+lst[j][0][2]*(tmp-y+M))%M;\n\t\t\t\tif(j){\n\t\t\t\t\tdp[j][1][0]=(dp[j][1][0]+lst[j-1][1][1]*(js(n+b[i]-2)-x+M))%M;\n\t\t\t\t\tdp[j][1][0]=(dp[j][1][0]+lst[j-1][1][2]*(js(n+b[i]-2)-x+M))%M;\n\t\t\t\t}\n\t\t\t}dp[j][1][1]=lst[j][0][1]*(js(n+b[i])-tmp+M)%M;\n\t\t\tif(j){\n\t\t\t\tdp[j][1][1]=(dp[j][1][1]+lst[j-1][1][1]*(tmp-js(n+b[i]-2)+M))%M;\n\t\t\t\tdp[j][1][0]=(dp[j][1][0]+lst[j-1][1][0]*(tmp-x+M))%M;\n\t\t\t}dp[j][1][2]=lst[j][0][2]*(z-tmp+M)%M;\n\t\t\tif(j){\n\t\t\t\tdp[j][1][2]=(dp[j][1][2]+lst[j-1][1][1]*(z-tmp+M))%M;\n\t\t\t\tdp[j][1][2]=(dp[j][1][2]+lst[j-1][1][0]*(z-tmp+M))%M;\n\t\t\t\tdp[j][1][2]=(dp[j][1][2]+lst[j-1][1][2]*(z-js(n+b[i]-2)+M))%M;\n\t\t\t}dp[j][1][2]=(dp[j][1][2]+lst[j][0][1]*(z-js(n+b[i])+M))%M;\n\t\t\tdp[j][1][2]=(dp[j][1][2]+lst[j][0][0]*(z-js(n+b[i])+M))%M;\n\t\t}fOR(j,0,i)fOR(p,0,2)fOR(q,0,3)lst[j][p][q]=dp[j][p][q];\n\t}fOR(i,k,cnt){\n\t\tif((ans+=dp[i][0][0])>=M)ans-=M;\n\t\tif((ans+=dp[i][0][1])>=M)ans-=M;\n\t}qw(ans,0);return 0;\n}\n```",
        "postTime": 1667986668,
        "uid": 184168,
        "name": "xuanxuan001",
        "ccfLevel": 8,
        "title": "\u9898\u89e3CF582D\u3010Number of Binominal Coefficients\u3011"
    },
    {
        "content": "$p^\\alpha \\mid \\binom{n}{k}$ \u5373\u4e3a $\\binom{n}{k}$ \u8d28\u56e0\u6570\u5206\u89e3\u540e $p$ \u7684\u5e42\u6b21 $\\geqslant \\alpha$\u3002\u6839\u636e\u5e93\u9ed8\u5c14\u5b9a\u7406\uff0c$\\binom{n}{k}$ \u4e2d $p$ \u7684\u5e42\u6b21\u5373\u4e3a $n-k$ \u52a0\u4e0a $k$ \u5728 $p$ \u8fdb\u5236\u4e0b\u7684\u8fdb\u4f4d\u6b21\u6570\u3002\n\n\u90a3\u4e48\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a\u4e86\u8ba1\u7b97\u6709\u591a\u5c11\u5bf9 $p$ \u8fdb\u5236\u975e\u8d1f\u6570\u5bf9 $(a,b)$\uff0c\u6ee1\u8db3 $a+b \\leqslant A$ \u4e14 $a+b$ \u7684\u8fdb\u4f4d\u6b21\u6570 $\\geqslant \\alpha$\u3002\n\n\u8003\u8651\u7528\u6570\u4f4d $DP$ \u6765\u8ba1\u7b97\uff0c \u8bbe $f_{i,j,0/1,0/1}$ \u8868\u793a\u4ece\u6700\u9ad8\u4f4d\u8003\u8651\u5230\u7b2c $i$ \u4f4d\uff0c\u5df2\u6709 $j$ \u6b21\u8fdb\u4f4d\uff0c\u662f\u5426\u6709\u6700\u9ad8\u4f4d\u7684\u9650\u5236\uff0c\u662f\u5426\u6709\u4e0b\u4e00\u4f4d\u5411\u4e0a\u8fdb\u4f4d\u7684\u65b9\u6848\u6570\uff0c$lim_i$ \u4e3a\u7b2c $i$ \u4f4d\u6700\u9ad8\u4f4d\u3002\n\n\u4e3a\u65b9\u4fbf\u8f6c\u79fb\uff0c\u53ef\u4ee5\u5c06\u8f6c\u79fb\u8fc7\u7a0b\u4e2d\u7684\u4e00\u4e9b\u91cf\u8868\u793a\u51fa\u6765\u3002\n\n$v_1=\\frac{(p+1)p}{2}$\uff0c\u5176\u4e3a\u5f53\u524d\u4f4d\u6ca1\u6709\u6700\u9ad8\u4f4d\u9650\u5236\uff0c\u6ca1\u6709\u4f4e\u4f4d\u8fdb\u4f4d\uff0c\u4e0d\u5411\u9ad8\u4f4d\u8fdb\u4f4d\u7684\u65b9\u6848\u6570\uff0c\u540c\u65f6\u4e5f\u662f\u5f53\u524d\u4f4d\u6ca1\u6709\u6700\u9ad8\u4f4d\u9650\u5236\uff0c\u6ca1\u6709\u4f4e\u4f4d\u8fdb\u4f4d\uff0c\u5411\u9ad8\u4f4d\u8fdb\u4f4d\u7684\u65b9\u6848\u6570\u3002\n\n$v_2=\\frac{(lim_i+1)lim_i}{2}$\uff0c\u5176\u4e3a\u5f53\u524d\u4f4d\u6709\u6700\u9ad8\u4f4d\u9650\u5236\u4f46\u4e0d\u7b49\u4e8e $lim_i$\uff0c\u6ca1\u6709\u4f4e\u4f4d\u8fdb\u4f4d\uff0c\u4e0d\u5411\u9ad8\u4f4d\u8fdb\u4f4d\u7684\u65b9\u6848\u6570\u3002\n\n$v_3=\\frac{p(p-1)}{2}$\uff0c\u5176\u4e3a\u5f53\u524d\u4f4d\u6ca1\u6709\u6700\u9ad8\u4f4d\u9650\u5236\uff0c\u6ca1\u6709\u4f4e\u4f4d\u8fdb\u4f4d\uff0c\u5411\u9ad8\u4f4d\u8fdb\u4f4d\u7684\u65b9\u6848\u6570\u3002\n\n$v_4=\\frac{lim_i(2p-lim_i-1)}{2}$\uff0c\u5176\u4e3a\u5f53\u524d\u4f4d\u6709\u6700\u9ad8\u4f4d\u9650\u5236\u4f46\u4e0d\u7b49\u4e8e $lim_i$\uff0c\u6ca1\u6709\u4f4e\u4f4d\u8fdb\u4f4d\uff0c\u5411\u9ad8\u4f4d\u8fdb\u4f4d\u7684\u65b9\u6848\u6570\u3002\n\n$v_5=\\frac{lim_i(lim_i-1)}{2}$\uff0c\u5176\u4e3a\u5f53\u524d\u4f4d\u6709\u6700\u9ad8\u4f4d\u9650\u5236\u4f46\u4e0d\u7b49\u4e8e $lim_i$\uff0c\u6709\u4f4e\u4f4d\u8fdb\u4f4d\uff0c\u4e0d\u5411\u9ad8\u4f4d\u8fdb\u4f4d\u7684\u65b9\u6848\u6570\u3002\n\n$v_6=\\frac{lim_i(2p-lim_i+1)}{2}$\uff0c\u5176\u4e3a\u5f53\u524d\u4f4d\u6709\u6700\u9ad8\u4f4d\u9650\u5236\u4f46\u4e0d\u7b49\u4e8e $lim_i$\uff0c\u6709\u4f4e\u4f4d\u8fdb\u4f4d\uff0c\u5411\u9ad8\u4f4d\u8fdb\u4f4d\u7684\u65b9\u6848\u6570\u3002\n\n\u8fd9\u4e9b\u65b9\u6848\u6570\u90fd\u53ef\u4ee5\u5148\u679a\u4e3e\u4e00\u4e2a\u503c\uff0c\u7136\u540e\u8003\u8651\u53e6\u4e00\u4e2a\u503c\u7684\u5408\u6cd5\u8303\u56f4\uff0c\u7528\u7b49\u5dee\u6570\u5217\u6c42\u548c\u5373\u53ef\u3002\u5f53\u524d\u4f4d\u7f6e\u4e3a $lim_i$ \u4e14\u6709\u6700\u9ad8\u4f4d\u9650\u5236\u65f6\uff0c\u8f6c\u79fb\u65f6\u7684\u8d21\u732e\u5373\u4e3a\u5408\u6cd5\u8303\u56f4\u5927\u5c0f\uff0c\u56e0\u4e3a\u4e00\u4e2a\u503c\u786e\u5b9a\u540e\uff0c\u53e6\u4e00\u4e2a\u503c\u4e5f\u5c31\u786e\u5b9a\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define maxn 3510\n#define P 1000000007\nusing namespace std;\ntypedef long long ll;\ntemplate<typename T> inline void read(T &x)\n{\n    x=0;char c=getchar();bool flag=false;\n    while(!isdigit(c)){if(c=='-')flag=true;c=getchar();}\n    while(isdigit(c)){x=(x<<1)+(x<<3)+(c^48);c=getchar();}\n    if(flag)x=-x;\n}\nll n,p,a,len,ans;\nint t[maxn],f[maxn][maxn][2][2];\nll lim[maxn];\nchar s[maxn];\nint main()\n{\n    read(p),read(a),scanf(\"%s\",s+1),len=strlen(s+1);\n    for(int i=1;i<=len;++i) t[i]=s[len-i+1]-'0';\n    while(len)\n    {\n        ll v=0;\n        for(int i=len;i>=1;--i)\n        {\n            v=v*10+t[i],t[i]=v/p,v%=p;\n            if(!t[i]&&i==len) len--;\n        }\n        lim[++n]=v;\n    }\n    f[n+1][0][1][0]=1;\n    for(int i=n;i>=1;--i)\n    {\n        ll v1=(p+1)*p/2%P;\n        ll v2=(lim[i]+1)*lim[i]/2%P;\n        ll v3=p*(p-1)/2%P;\n        ll v4=lim[i]*(2*p-lim[i]-1)/2%P;\n        ll v5=lim[i]*(lim[i]-1)/2%P;\n        ll v6=lim[i]*(2*p-lim[i]+1)/2%P;\n        for(int j=0;j<=n-i;++j)\n        {\n            ll f1=f[i+1][j][0][0],f2=f[i+1][j][1][0],f3=f[i+1][j][0][1],f4=f[i+1][j][1][1];\n            f[i][j][0][0]=(f1*v1%P+f2*v2%P+f3*v3%P+f4*v4%P)%P;\n            f[i][j][1][0]=(f2*(lim[i]+1)%P+f4*(p-1-lim[i])%P)%P;\n            f[i][j+1][0][1]=(f1*v3%P+f2*v5%P+f3*v1%P+f4*v6%P)%P;\n            f[i][j+1][1][1]=(f2*lim[i]%P+f4*(p-lim[i])%P)%P;\n        }\n    }\n    for(int i=a;i<=n;++i) ans=(ans+f[1][i][0][0]+f[1][i][1][0])%P;\n    printf(\"%lld\",ans);\n    return 0;\n}\n```",
        "postTime": 1601215537,
        "uid": 172489,
        "name": "lhm_",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF582D \u3010Number of Binominal Coefficients\u3011"
    },
    {
        "content": "\u6807\u7b7e: \u6570\u5b66, \u6570\u4f4dDP.\n\n#### Part 1\n\n${n\\choose k}=\\frac{n!}{k!(n-k)!}$ , \u5b9a\u4e49 $f(x)$ \u8868\u793a\u6700\u5927\u7684\u6574\u6570 $\\alpha$ \u4f7f\u5f97 $p^\\alpha|x$ , \u5373\u5c06 $x$ \u5206\u89e3\u8d28\u56e0\u6570\u540e $p$ \u7684\u6307\u6570.\n\n\u90a3\u4e48\u6211\u4eec\u8981\u6c42\u7684\u5c31\u662f\u6ee1\u8db3 $f({n\\choose k})=f(n!)-f(k!)-f((n-k)!)\\geqslant\\alpha$ \u7684 $(n,k)$ \u7684\u4e2a\u6570, \u5bb9\u6613\u5f97\u51fa $f(x!)=\\sum_{i=1}^{+\\infin}\\lfloor\\frac{x}{p^i}\\rfloor$ . \u8fd9\u4e2a\u5f0f\u5b50\u4f3c\u4e4e\u4e0d\u662f\u5f88\u76f4\u89c2, \u4f46\u662f\u6211\u4eec\u5c06 $x$ \u5199\u6210 $p$ \u8fdb\u5236(\u8bb0\u4e3a $x'$)\u53ef\u4ee5\u53d1\u73b0: $f(x!)$ \u7b49\u4e8e $x'$ \u7684\u6bcf\u4e00\u4e2a\u524d\u7f00(\u4e0d\u5305\u62ec\u672c\u8eab)\u7684\u548c.\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u5f88\u663e\u7136\u7684\u7ed3\u8bba\u4e86: $f({n\\choose k})$ \u7b49\u4e8e $p$ \u8fdb\u5236\u4e0b, $k$ \u52a0\u4e0a $n-k$ \u8fdb\u4f4d\u7684\u6b21\u6570(\u53e6\u5916\u4e00\u7bc7\u9898\u89e3\u4e2d\u63d0\u5230\u4e86\u662f `\u5e93\u9ed8\u5c14\u5b9a\u7406`).\n\n#### Part 2\n\n\u6839\u636e `Part 1` \u4e2d\u7684\u7ed3\u8bba\u6211\u4eec\u5c31\u53ef\u4ee5\u8bbe\u8ba1\u4e00\u4e2a\u6570\u4f4dDP\u6765\u89e3\u51b3\u95ee\u9898\u4e86.\n\n\u5177\u4f53\u5730, \u6211\u4eec\u8bbe\u8ba1DP\u72b6\u6001 $f[i][j][s][t]$ \u8868\u793aDP\u81f3\u524d $i$ \u4f4d, \u524d $i+1$ \u4e2a\u4f4d\u7f6e $k$ \u52a0 $n-k$ \u6709 $j$ \u4e2a\u4f4d\u7f6e\u8fdb\u4f4d, $s$ \u53d6 $0/1$ \u8868\u793a $k$ \u52a0 $n-k$ \u7b2c $i+1$ \u4f4d\u662f\u5426\u8fdb\u4f4d, $t$ \u53d6 $0/1$ \u8868\u793a\u524d $i$ \u4f4d $n$ \u662f\u5426\u8fbe\u5230\u4e86\u4e0a\u754c $A$ \u7684\u5408\u6cd5 $(n,k)$ \u7684\u65b9\u6848\u6570. \n\n\u8f6c\u79fb\u6bd4\u8f83\u7e41\u7410, \u5206\u7c7b\u8ba8\u8bba\u5373\u53ef.\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(\\log^2A)$.\n\n```cpp\n#include <bits/stdc++.h>\n#define mod 1000000007\nusing namespace std;\nint p, alpha, a[2003], len;\nchar A[2003];\n\nint M(int x) { return x >= mod ? x - mod : x; }\n\nstruct Big_based_p {\n    int len, x[4003];\n    void init() {\n        while (::len) {\n            long long t = 0;\n            for (int i = ::len; i >= 1; --i) {\n                t = t * 10 + a[i], a[i] = t / p, t %= p;\n                if (!a[i] && i == ::len) --::len;\n            }\n            x[++len] = t;\n        }\n    }\n    int f[3503][3503][2][2];\n    void work() {\n        f[len + 1][0][0][1] = 1;\n        for (int i = len, c1, c2, c3, c4, c5, c6; i >= 1; --i) {\n            c1 = 1ll * (p + 1) * p / 2 % mod,\n            c2 = 1ll * (x[i] + 1) * x[i] / 2 % mod,\n            c3 = 1ll * p * (p - 1) / 2 % mod,\n            c4 = 1ll * x[i] * ((p << 1) - x[i] - 1) / 2 % mod,\n            c5 = 1ll * x[i] * (x[i] - 1) / 2 % mod,\n            c6 = 1ll * x[i] * ((p << 1) - x[i] + 1) / 2 % mod;\n\n            for (int j = 0, f0, f1, f2, f3; j <= len - i + 1; ++j) {\n                f0 = f[i + 1][j][0][0], f1 = f[i + 1][j][0][1],\n                f2 = f[i + 1][j][1][0], f3 = f[i + 1][j][1][1];\n                if (!f0 && !f1 && !f2 && !f3) continue;\n                f[i][j][0][0] = (1ll * c1 * f0 % mod + 1ll * c2 * f1 % mod +\n                                 1ll * c3 * f2 % mod + 1ll * c4 * f3 % mod) %\n                                mod;\n                f[i][j][0][1] = M(1ll * (x[i] + 1) * f1 % mod +\n                                  1ll * (p - x[i] - 1) * f3 % mod);\n                f[i][j + 1][1][0] =\n                    (1ll * c3 * f0 % mod + 1ll * c5 * f1 % mod +\n                     1ll * c1 * f2 % mod + 1ll * c6 * f3 % mod) %\n                    mod;\n                f[i][j + 1][1][1] =\n                    M(1ll * x[i] * f1 % mod + 1ll * (p - x[i]) * f3 % mod);\n            }\n        }\n        int res = 0;\n        for (int i = alpha; i <= len; ++i)\n            res = M(res + M(f[1][i][0][0] + f[1][i][0][1]));\n        printf(\"%d\\n\", res);\n    }\n} lim;\n\nint main() {\n    scanf(\"%d%d%s\", &p, &alpha, A + 1), len = strlen(A + 1);\n    if (alpha > 4000) return puts(\"0\"), 0;\n    for (int i = 1; i <= len; ++i) a[i] = A[len - i + 1] - '0';\n    lim.init(), lim.work();\n    return 0;\n}\n```\n",
        "postTime": 1580370572,
        "uid": 51237,
        "name": "Kinandra",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF582D \u3010Number of Binominal Coefficients\u3011"
    },
    {
        "content": "### Sol\n\n\u5982\u4f55\u5224\u65ad $p^\\alpha \\mid \\binom{n}{k}$ \u662f\u5426\u6210\u7acb\uff1a\u53ea\u9700\u8981\u77e5\u9053 $\\binom{n}{k}$ \u4e2d $p$ \u7684\u6b21\u6570\u662f\u5426\u5927\u4e8e\u7b49\u4e8e $\\alpha$ \u3002\n\n\u8bbe $f(n)$ \u4e3a $n!$ \u4e2d $p$ \u7684\u6b21\u6570\uff0c\u663e\u7136\u6709 $f(n) = \\sum_{i=1}^\\infty \\lfloor \\frac{n}{p^i} \\rfloor$\u3002\u800c\u6211\u4eec\u8981\u505a\u7684\u5c31\u662f\u68c0\u67e5 $f(n)-f(k)-f(n-k)$ \u662f\u5426\u6210\u7acb\u3002\n\n$f(n)$ \u5b9e\u9645\u4e0a\u76f8\u5f53\u4e8e\uff1a$n$ \u7684 $p$ \u8fdb\u5236\u8868\u793a\u53bb\u6389\u6700\u540e\u4e00\u4f4d\u540e\u7684\u503c + $n$ \u7684 $p$ \u8fdb\u5236\u8868\u793a\u53bb\u6389\u6700\u540e\u4e24\u4f4d\u540e\u7684\u503c + $n$ \u7684 $p$ \u8fdb\u5236\u8868\u793a\u53bb\u6389\u6700\u540e\u4e09\u4f4d\u540e\u7684\u503c \u2026\u2026\n\n\u8003\u8651 $f(a+b)$ \u548c $f(a)+f(b)$ \u7684\u533a\u522b\uff1a\u5982\u679c $a+b$ \u5728 $p$ \u8fdb\u5236\u4e0b\u6ca1\u6709\u8fdb\u4f4d\uff0c\u90a3\u4e48\u4e24\u8005\u663e\u7136\u76f8\u540c\uff1b\u8003\u8651\u5982\u679c $a+b$ \u5728 $p^k$ \u8fd9\u4e00\u4f4d\u8fdb\u4f4d\u4e86\uff0c\u90a3\u4e48\u76f8\u8f83\u4e8e $f(a)+f(b)$ \uff0c$f(a+b)$ \u5728 $i\\le k$ \u7684\u65f6\u5019\u7684\u8d21\u732e\u662f\u4e0d\u53d8\u7684\uff0c\u4f46\u662f\u5728 $i=k+1$ \u7684\u65f6\u5019\u5c31\u4f1a\u591a\u8d21\u732e $1$ \u3002\u53c8\u56e0\u4e3a\u8fd9\u662f\u4e24\u4e2a\u6570\u7684\u52a0\u6cd5\uff0c\u6bcf\u4e00\u4f4d\u81f3\u591a\u8fdb\u4f4d\u4e00\u6b21\uff0c\u6240\u4ee5\u4e0d\u4f1a\u51fa\u73b0\u5728\u7b2c $k$ \u4f4d\u7684\u8fdb\u4f4d\u8d21\u732e\u5230\u7b2c $k+2$ \u4f4d\u7684\u60c5\u51b5\u3002\u6240\u4ee5 $f(a+b)-(f(a)+f(b))$ \u5c31\u662f $a+b$ \u5728 $p$ \u8fdb\u5236\u52a0\u6cd5\u4e2d\u8fdb\u4f4d\u7684\u6b21\u6570\u3002\n\n\u4ee4 $a=k,b=n-k$ \uff0c\u6211\u4eec\u76f8\u5f53\u4e8e\u8981\u7edf\u8ba1\u6ee1\u8db3 $0\\le a,0\\le b, a+b\\le A$ \u4e14 $a+b$ \u8fdb\u4f4d\u6b21\u6570\u4e0d\u5c0f\u4e8e $\\alpha$ \u7684 $(a,b)$ \u7684\u6570\u91cf\u3002\u8fd9\u662f\u4e00\u4e2a\u57fa\u7840\u7684\u6570\u4f4d dp \u95ee\u9898\u3002\n\n### Code\n\n[link](https://codeforces.com/contest/582/submission/72292629)",
        "postTime": 1583247654,
        "uid": 40534,
        "name": "zhongyuwei",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF582D \u3010Number of Binominal Coefficients\u3011"
    },
    {
        "content": "[Codeforces \u9898\u76ee\u4f20\u9001\u95e8](https://codeforces.com/contest/582/problem/D) & [\u6d1b\u8c37\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF582D)\n\n\u4e00\u9053\u6570\u8bba\u4e0e\u6570\u4f4d dp \u7ed3\u5408\u7684\u795e\u9898 %%%\n\n\u9996\u5148\u5728\u505a\u8fd9\u9053\u9898\u4e4b\u524d\u4f60\u9700\u8981\u77e5\u9053\u4e00\u4e2a\u5b9a\u7406\uff1a\u5bf9\u4e8e\u8d28\u6570 $p$ \u53ca $n,k$\uff0c\u6700\u5927\u7684\u6ee1\u8db3 $p^{\\alpha}\\mid\\dbinom{n}{k}$ \u7684 $\\alpha$ \u4e3a $k$ \u4e0e $n-k$ \u5728 $p$ \u8fdb\u5236\u4e0b\u76f8\u52a0\u7684\u8fdb\u4f4d\u6b21\u6570\u3002\u8bc1\u660e\u5c31\u8003\u8651\u6269\u5c55 Lucas \u5b9a\u7406\uff0c\u8bb0 $f(x)$ \u4e3a\u6700\u5927\u7684\u6ee1\u8db3 $p^{\\alpha}\\mid x$ \u7684 $\\alpha$\uff0c\u90a3\u4e48\u7531 $\\dbinom{n}{k}=\\dfrac{n!}{k!(n-k)!}$ \u53ef\u77e5 $f(\\dbinom{n}{k})=f(n!)-f(k!)-f((n-k)!)$\uff0c\u6211\u4eec\u8003\u8651\u5c06 $k,n-k$ \u90fd\u5728 $k$ \u8fdb\u5236\u4e0b\u8868\u793a\uff0c\u6211\u4eec\u8bbe\u5b83\u4eec\u4ece\u9ad8\u5230\u4f4e\u5206\u522b\u662f $k=(a_{m-1}a_{m-2}\\cdots a_1a_0)_p,n-k=(b_{m-1}b_{m-2}\\cdots b_1b_0)_p,n=(c_{m-1}c_{m-2}\\cdots c_1c_0)_p$\uff08\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u4e0d\u59a8\u5047\u8bbe $n<p^m$\uff0c\u5373 $n+k$ \u5728 $p^m$ \u4f4d\u4e0d\u4f1a\u4ea7\u751f\u8fdb\u4f4d\uff09\uff0c\u90a3\u4e48\u6839\u636e\u6269\u5c55 Lucas \u5b9a\u7406 $f(k!)$ \u5e94\u5f53\u4e3a $\\sum\\limits_{i=1}^{m-1}(a_{m-1}a_{m-2}\\cdots a_i)_p$\uff0c\u5373 $k$ \u5728 $p$ \u8fdb\u5236\u8868\u793a\u4e0b\u6240\u6709\u524d\u7f00\uff08\u4e0d\u5305\u62ec\u672c\u8eab\uff09\u8868\u793a\u7684\u6570\u4e4b\u548c\u3002\u5f88\u663e\u7136\u7684\u4e00\u70b9\u662f\u5bf9\u4e8e\u4efb\u610f $i\\in[1,m-1]$\uff0c$(a_{m-1}a_{m-2}\\cdots a_i)_p+(b_{m-1}b_{m-2}\\cdots b_i)_p\\le(c_{m-1}c_{m-2}\\cdots c_i)_p$\uff0c\u90a3\u4e48\u4ec0\u4e48\u65f6\u5019 $(a_{m-1}a_{m-2}\\cdots a_i)_p+(b_{m-1}b_{m-2}\\cdots b_i)_p<(c_{m-1}c_{m-2}\\cdots c_i)_p$ \u5462\uff1f\u663e\u7136\u5982\u679c\u524d\u9762\u6ca1\u6709\u8fdb\u4f4d\u90a3\u5c31\u4e0d\u53ef\u80fd\u5b58\u5728\u8fd9\u79cd\u60c5\u51b5\uff0c\u5426\u5219\uff0c\u7531\u4e8e\u53ea\u6709\u4e24\u6570\u76f8\u52a0\uff0c\u56e0\u6b64\u6700\u591a\u8fdb\u4e0a\u6765\u4e00\u4f4d\uff0c\u800c\u8fdb\u4e0a\u6765\u4e00\u4f4d\u4ee5\u540e\u663e\u7136\u5c31\u6709 $(a_{m-1}a_{m-2}\\cdots a_i)_p+(b_{m-1}b_{m-2}\\cdots b_i)_p+1=(c_{m-1}c_{m-2}\\cdots c_i)_p$\uff0c\u4f1a\u5bf9\u7b54\u6848\u4ea7\u751f $1$ \u7684\u8d21\u732e\uff0c\u56e0\u6b64\u8be5\u7ed3\u8bba\u6210\u7acb\u3002\u636e\u8bf4\u8be5\u7ed3\u8bba\u6709\u4e00\u4e2a\u540d\u5b57\u53eb\u4ec0\u4e48\u5e93\u9ed8\u5c14\uff08Kummer\uff09\u5b9a\u7406\uff0c\u4e0d\u8fc7\u540d\u5b57\u5565\u7684\u4e0d\u91cd\u8981\u5566\uff08\uff08\n\n\u77e5\u9053\u8fd9\u4e2a\u7ed3\u8bba\u4e4b\u548c\u5c31\u53ef\u4ee5\u6570\u4f4d dp \u4e86\u3002\u9898\u76ee\u4e2d $\\alpha\\le 10^9$ \u662f\u5047\u7684\uff0c\u5982\u679c $\\alpha>\\log_pA$ \u90a3\u7b54\u6848\u663e\u7136\u4e3a $0$\u3002\u6211\u4eec\u9996\u5148\u5c06\u9898\u76ee\u7ed9\u51fa\u7684\u90a3\u4e2a\u6570\u7528 $p$ \u8fdb\u5236\u8868\u793a\uff0c\u6211\u4eec\u8bbe $dp_{i,j,0/1,0/1}$ \u8868\u793a\u8003\u8651\u4e86\u6700\u9ad8\u7684 $i$ \u4f4d\uff0c\u5f53\u524d\u8fdb\u4f4d\u4e86 $j$ \u6b21\uff0c\u4e0a\u4e00\u4f4d\uff08\u7b2c $i+1$  \u9ad8\u7684\u4f4d\uff09\u662f\u5426\u4ea7\u751f\u8fdb\u4f4d\uff0c\u5f53\u524d\u662f\u5426\u8fbe\u5230\u4e0a\u754c\uff0c\u8003\u8651\u8f6c\u79fb\uff0c\u5047\u8bbe $A$ \u7684\u7b2c $i+1$ \u4f4d\u7684\u503c\u4e3a $c$\uff0c\u6211\u4eec\u8981\u51b3\u7b56 $k$ \u7684\u7b2c $i+1$ \u4f4d\u7684\u503c $a$ \u4e0e $n-k$ \u7684\u7b2c $i+1$ \u4f4d\u7684\u503c $b$\uff0c\u90a3\u4e48\u6709\u8f6c\u79fb\uff1a\n\n- $dp_{i+1,j,0,0}$\uff1a\n  - \u5982\u679c\u4ece $dp_{i,j,0,0}$ \u8f6c\u79fb\u6765\u90a3\u4e48\u9700\u6ee1\u8db3 $a+b<p$\uff0c\u65b9\u6848\u6570 $\\dfrac{p(p+1)}{2}$\n  - \u5982\u679c\u4ece $dp_{i,j,0,1}$ \u8f6c\u79fb\u6765\u90a3\u4e48\u9700\u6ee1\u8db3 $a+b<c$\uff0c\u65b9\u6848\u6570 $\\dfrac{c(c+1)}{2}$\n  - \u5982\u679c\u4ece $dp_{i,j,1,0}$ \u8f6c\u79fb\u6765\u90a3\u4e48\u9700\u6ee1\u8db3 $a+b\\ge p$\uff0c\u65b9\u6848\u6570 $\\dfrac{p(p-1)}{2}$\n  - \u5982\u679c\u4ece $dp_{i,j,1,1}$ \u8f6c\u79fb\u6765\u90a3\u4e48\u9700\u6ee1\u8db3 $p\\le a+b<p+c$\uff0c\u65b9\u6848\u6570 $\\dfrac{(p+c)(p+c+1)}{2}-\\dfrac{p(p+1)}{2}=\\dfrac{c(2n-c-1)}{2}$\n- $dp_{i+1,j,0,1}$\uff1a\n  - \u5982\u679c\u4ece $dp_{i,j,0,1}$ \u8f6c\u79fb\u6765\u90a3\u4e48\u9700\u6ee1\u8db3 $a+b=c$\uff0c\u65b9\u6848\u6570 $c+1$\n  - \u5982\u679c\u4ece $dp_{i,j,1,1}$ \u8f6c\u79fb\u6765\u90a3\u4e48\u9700\u6ee1\u8db3 $a+b=p+c$\uff0c\u65b9\u6848\u6570 $p-c-1$\n- $dp_{i+1,j,1,0}$\uff1a\n  - \u5982\u679c\u4ece $dp_{i,j,0,0}$ \u8f6c\u79fb\u6765\u90a3\u4e48\u9700\u6ee1\u8db3 $a+b<p-1$\uff0c\u65b9\u6848\u6570 $\\dfrac{p(p-1)}{2}$\n  - \u5982\u679c\u4ece $dp_{i,j,0,1}$ \u8f6c\u79fb\u6765\u90a3\u4e48\u9700\u6ee1\u8db3 $a+b<c-1$\uff0c\u65b9\u6848\u6570 $\\dfrac{c(c-1)}{2}$\n  - \u5982\u679c\u4ece $dp_{i,j,1,0}$ \u8f6c\u79fb\u6765\u90a3\u4e48\u9700\u6ee1\u8db3 $a+b\\ge p-1$\uff0c\u65b9\u6848\u6570 $\\dfrac{p(p+1)}{2}$\n  - \u5982\u679c\u4ece $dp_{i,j,1,1}$ \u8f6c\u79fb\u6765\u90a3\u4e48\u9700\u6ee1\u8db3 $p\\le a+b+1<p+c$\uff0c\u65b9\u6848\u6570 $\\dfrac{(p+c)(p+c-1)}{2}-\\dfrac{p(p-1)}{2}=\\dfrac{c(2n-c+1)}{2}$\n- $dp_{i+1,j,1,1}$\uff1a\n  - \u5982\u679c\u4ece $dp_{i,j,0,1}$ \u8f6c\u79fb\u6765\u90a3\u4e48\u9700\u6ee1\u8db3 $a+b+1=c$\uff0c\u65b9\u6848\u6570 $c$\n  - \u5982\u679c\u4ece $dp_{i,j,1,1}$ \u8f6c\u79fb\u6765\u90a3\u4e48\u9700\u6ee1\u8db3 $a+b+1=p+c$\uff0c\u65b9\u6848\u6570 $p-c$\n\n\u7b97\u4e0b\u8d21\u732e\u8f6c\u79fb\u4e00\u4e0b\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(\\log^2_kA)$\u3002\n\n\u6700\u597d\u4f7f\u7528\u6eda\u52a8\u6570\u7ec4\u4f18\u5316\u3002\n\n```cpp\nconst int MAXL=4000;\nconst int MOD=1e9+7;\nint n,alpha,len,m=0,a[MAXL+5],x[MAXL+5];\nchar A[MAXL+5];int dp[2][MAXL+5][2][2];\nint main(){\n\tscanf(\"%d%d%s\",&n,&alpha,A+1);len=strlen(A+1);\n\tif(alpha>MAXL) return puts(\"0\"),0;\n\tfor(int i=1;i<=len;i++) a[len-i+1]=A[i]-'0';\n\twhile(len){\n\t\tll cur=0;\n\t\tfor(int i=len;i;i--){\n\t\t\tcur=cur*10+a[i];a[i]=cur/n;cur%=n;\n\t\t} x[++m]=cur;if(!a[len]) len--;\n\t} int cur=1,pre=0;\n\tdp[cur][0][0][1]=1;\n\tfor(int i=m;i;i--){\n\t\tcur^=pre^=cur^=pre;\n\t\tmemset(dp[cur],0,sizeof(dp[cur]));\n\t\tint c1=1ll*(n+1)*n/2%MOD;\n\t\tint c2=1ll*(x[i]+1)*x[i]/2%MOD;\n\t\tint c3=1ll*(n-1)*n/2%MOD;\n\t\tint c4=1ll*x[i]*(n*2-x[i]-1)/2%MOD;\n\t\tint c5=1ll*(x[i]-1)*x[i]/2%MOD;\n\t\tint c6=1ll*x[i]*(n*2-x[i]+1)/2%MOD;\n\t\tfor(int j=0;j<=m-i+1;j++){\n\t\t\tint f0=dp[pre][j][0][0],f1=dp[pre][j][0][1];\n\t\t\tint f2=dp[pre][j][1][0],f3=dp[pre][j][1][1];\n\t\t\tdp[cur][j][0][0]=(1ll*f0*c1+1ll*f1*c2+1ll*f2*c3+1ll*f3*c4)%MOD;\n\t\t\tdp[cur][j][0][1]=(1ll*(x[i]+1)*f1+1ll*(n-x[i]-1)*f3)%MOD;\n\t\t\tdp[cur][j+1][1][0]=(1ll*f0*c3+1ll*f1*c5+1ll*f2*c1+1ll*f3*c6)%MOD;\n\t\t\tdp[cur][j+1][1][1]=(1ll*x[i]*f1+1ll*(n-x[i])*f3)%MOD;\n\t\t}\n\t} int ans=0;\n\tfor(int i=alpha;i<=m;i++){\n\t\tans=(ans+dp[cur][i][0][0])%MOD;\n\t\tans=(ans+dp[cur][i][0][1])%MOD;\n\t} printf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1617885464,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF582D Number of Binominal Coefficients"
    },
    {
        "content": "> [CF582D Number of Binominal Coefficients](https://codeforces.com/contest/582/problem/D)\n\n## \u9898\u610f\n\n- \u7ed9\u5b9a\u8d28\u6570 $p$ \u548c\u6574\u6570 $c,s$\uff0c\u6c42\u6ee1\u8db3 $0 \\le k \\le n \\le A$ \u4e14 $p^a|\\binom nk$ \u7684\u6570\u5bf9 $(n,k)$ \u7684\u4e2a\u6570\u3002\n- $p,a \\le 10^9$\uff0c$A < 10^{1000}$\uff0c\u7b54\u6848\u5bf9 $10^9+7$ \u53d6\u6a21\u3002\n\n## \u9898\u89e3\n\n\u5e93\u9ed8\u5c14\u5b9a\u7406\uff1a\u8d28\u6570 $p$ \u8fdb\u5236\u4e0b $a+b$ \u7684\u8fdb\u4f4d\u6b21\u6570\u7b49\u4e8e $\\binom{a+b}a$ \u7684\u6807\u51c6\u5206\u89e3\u5f0f\u4e2d $p$ \u7684\u6b21\u6570\u3002\n\n\u56e0\u6b64\u9898\u610f\u53d8\u6210\u6c42 $0 \\le a + b \\le s$ \u4e14 $a + b$ \u5728 $p$ \u8fdb\u5236\u4e0b\u7684\u8fdb\u4f4d\u6b21\u6570\u81f3\u5c11\u4e3a\u4e3a $c$ \u7684\u975e\u8d1f\u6574\u6570\u5bf9 $(a, b)$ \u7684\u4e2a\u6570\u3002\n\n\u6570\u4f4d dp \u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(\\log_{p} s (\\log s + \\log_{p} s))$\u3002\n\n## \u4ee3\u7801\n\n```cpp\nconst int N = 4e3 + 7;\nint p, c, n, a[N];\nchar s[N];\nll b[N];\nmodint f[2][2][N], g[2][2][N], ans;\n\nint main() {\n\trd(p), rd(c), rds(s, n);\n\tfor (int i = 1; i <= n; i++) a[i] = s[n+1-i] - '0';\n\tfor (int i = n; i; i--) {\n\t\tfor (int j = 1; j < N - 1; j++) b[j] *= 10;\n\t\tb[1] += a[i];\n\t\tfor (int j = 1; j < N - 1; j++)\n\t\t\tif (b[j] >= p) b[j+1] += b[j] / p, b[j] %= p;\n\t}\n\tfor (int i = 1; i <= N; ++i) a[i] = b[i];\n\tn = N - 1;\n\twhile (n && !a[n]) --n;\n\tif (!n) return print(0), 0;\n\tf[1][0][0] = 1;\n\tfor (int i = n; i; i--) {\n\t\tmodint a0 = 1ll * p * (p + 1) / 2 % P;\n\t\tmodint a1 = 1ll * p * (p - 1) / 2 % P;\n\t\tmodint a2 = 1ll * a[i] * (a[i] + 1) / 2 % P;\n\t\tmodint a3 = 1ll * a[i] * (a[i] - 1) / 2 % P;\n\t\tmodint a4 = 1ll * a[i] * (p + p - a[i] - 1) / 2 % P;\n\t\tmodint a5 = 1ll * a[i] * (p + p - a[i] + 1) / 2 % P;\n\t\tfor (int j = 0; j <= n + 1 - i; j++) g[0][0][j] = g[0][1][j] = g[1][0][j] = g[1][1][j] = 0;\n\t\tfor (int j = 0; j <= n - i; j++) {\n\t\t\tmodint f0 = f[0][0][j], f1 = f[0][1][j], f2 = f[1][0][j], f3 = f[1][1][j];\n\t\t\tg[0][0][j] += f0 * a0 + f2 * a2;\n\t\t\tg[0][1][j] += f0 * a1 + f2 * a3;\n\t\t\tg[1][0][j] += f2 * (a[i] + 1);\n\t\t\tg[1][1][j] += f2 * a[i];\n\t\t\tg[0][0][j+1] += f1 * a1 + f3 * a4;\n\t\t\tg[0][1][j+1] += f1 * a0 + f3 * a5;\n\t\t\tg[1][0][j+1] += f3 * (p - a[i] - 1);\n\t\t\tg[1][1][j+1] += f3 * (p - a[i]);\n\t\t}\n\t\tswap(f, g);\n\t}\n\tfor (int i = c; i <= n; i++) ans += f[0][0][i] + f[1][0][i];\n\tprint(ans);\n\treturn 0;\n}\n```",
        "postTime": 1576521491,
        "uid": 100544,
        "name": "xht",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF582D \u3010Number of Binominal Coefficients\u3011"
    }
]
[
    {
        "content": "\u9898\u610f\uff1a\n\n\u6bcf\u6b21\u53ef\u4ee5\u5bf9\u4e00\u4e2a\u6811\u7ecf\u884c\u6700\u591a $2n$ \u6b21\u64cd\u4f5c  $(x,y,y')$ \u8868\u793a\u5c06 $(x,y)$ \u5220\u9664\uff0c\u540c\u65f6\u52a0\u5165\u4e00\u6761\u8fb9 $(x,y')$ \u3002\n\n\u6bcf\u6b21\u64cd\u4f5c\u8981\u6c42 \uff1a\n\n1. \u6bcf\u6b21\u64cd\u4f5c\u4e2d $(x,y)$ \u5b58\u5728\u3002\n\n1. \u64cd\u4f5c\u540e\u4ecd\u7136\u662f\u6811\u3002\n\n1. \u6bcf\u6b21\u5220\u4e86 $(x,y)$ \u65f6\uff0c\u5fc5\u987b\u4fdd\u8bc1\u5305\u542b $x$ \u7684\u5b50\u6811\u4e2d\u7684\u8282\u70b9\u6570\u6bd4\u5305\u542b $y$ \u7684\u8282\u70b9\u6570\u5927\u3002\n\n\u6700\u540e\u4f7f\u5f97\u6240\u6709\u70b9\u8ddd\u79bb\u7684\u5e73\u65b9\u548c\u6700\u5c0f\u3002\u8f93\u51fa\u4e00\u79cd\u64cd\u4f5c\u7684\u65b9\u6848\u3002$n\\leq 2\\times 10^5$\u3002\n\n---\n\n\u76f4\u63a5\u83bd\uff1a\u5bf9\u4e8e\u4e00\u6b21\u64cd\u4f5c \u8d21\u732e\u662f\uff1a (\u80fd\u60f3\u5230\u8fd9\u79cd\u64cd\u4f5c\u7684\u4e5f\u53ea\u6709\u7b14\u8005\u8fd9\u6837\u7684\u83dc\u903c\u4e86)\n\n$$\\sum_{u\\in V_x}\\sum_{v\\in V_y} \\big( dis\\left(u,x\\right)+dis\\left(y',v\\right)\\big)^2 -\\sum_{u\\in V_x}\\sum_{v\\in V_y} \\big(  dis\\left(u,x\\right)+dis\\left(y,v\\right))\\big)^2$$\n\n$$=V_x \\sum_{v\\in V_y} \\big(dis(y',v)^2-dis(y,v)^2\\big)+ \\sum_{u \\in V_x} \\sum_{v\\in V_y}{2\\times dis(u,x)\\times(dis(y',v)-dis(y,v))}$$\n\n\n$$=\u2026=\\text{\u4e0d\u4f1a}$$ \n\n\n---\n\n\u8003\u8651\u64cd\u4f5c\u7684\u7279\u6b8a\u6027\uff0c\u4e5f\u5c31\u662f\u7b2c\u4e09\u70b9\uff0c\u5bf9\u4e8e\u5b50\u6811\u8282\u70b9\u7684\u9650\u5236\u53ef\u4ee5\u63a8\u51fa\u5728\u6bcf\u4e00\u6b21\u64cd\u4f5c\u4e4b\u540e\u6811\u7684\u91cd\u5fc3\u90fd\u4e0d\u4f1a\u53d8\uff08\u6839\u636e\u91cd\u5fc3\u7684\u5b9a\u4e49\u53ef\u77e5\uff0c\u4e24\u4e2a\u91cd\u5fc3\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u8fd9\u4e2a\u7ed3\u8bba\uff09\u3002\n\n\u8003\u8651\u64cd\u4f5c\u7684\u5c40\u9650\u6027\uff1a\u65e0\u6cd5\u589e\u52a0\u548c\u51cf\u5c11\u4e0e\u91cd\u5fc3\u7684\u5ea6\u6570\uff08\u5982\u679c\u662f\u4e24\u4e2a\u91cd\u5fc3\uff0c\u90a3\u4e48\u8fd9\u4fe9\u4e2a\u91cd\u5fc3\u7684\u8fde\u8fd9\u7684\u8fb9\u4e0d\u4f1a\u6539\u53d8\uff0c\u5176\u5b9e\u4e24\u4e2a\u91cd\u5fc3\u7684\u60c5\u51b5\u53ef\u4ee5\u628a\u8fd9\u4e24\u4e2a\u91cd\u5fc3\u7f29\u6210\u4e00\u4e2a\uff09\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u7ed9\u6211\u4eec\u7684 $2n$ \u6b21\u64cd\u4f5c\uff0c\u9996\u5148\u7528\u6700\u591a $n$ \u6b21\u7684\u64cd\u4f5c\u6765\u628a\u91cd\u5fc3\u8fde\u51fa\u53bb\u7684\u5b50\u6811\u53d8\u6210\u4e00\u6761\u6761\u94fe\u3002\n\n\u7136\u540e\u518d\u7528\u6700\u591a $n$ \u6b21\u628a\u91cd\u5fc3\u8fde\u51fa\u53bb\u7684\u5b50\u6811\u53d8\u6210\u83ca\u82b1\u56fe\uff08\u611f\u6027\u601d\u8003\u4e00\u4e0b\uff0c\u83ca\u82b1\u56fe\u7684\u65f6\u5019\u663e\u7136\u7b54\u6848\u66f4\u4f18\uff09\u3002\n\n\n\n----\n\n\u90e8\u5206\u4ee3\u7801\uff1a\n\n```cpp\n\nvoid add(int x,int y){e[++tot]=(edge){y,head[x]};head[x]=tot;}\nvoid dfs(int x,int fa){\n\tsz[x]=1; mx[x]=0;\n\tfor (int i=head[x];i;i=e[i].next)\n\t\tif (e[i].to!=fa){\n\t\t\tdfs(e[i].to,x);\n\t\t\tsz[x]+=sz[e[i].to];\n\t\t\tmx[x]=max(mx[x],sz[e[i].to]);\n\t\t}\n\tif (sz[x]*2>=n&&mx[x]*2<=n) rt[x]=1;\n}\nvoid change(int x,int y,int z){ans[++cnt][0]=x;ans[cnt][1]=y;ans[cnt][2]=z;}\nvoid solve(int x){\n\tfor (int i=head[x];i;i=e[i].next)\n\tif (e[i].to!=fa[x])fa[e[i].to]=x,solve(e[i].to);\n\tsta[++top]=x;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor (int i=1;i<n;i++){\n\t\tint x,y; scanf(\"%d%d\",&x,&y);\n\t\tadd(x,y); add(y,x);\n\t}\n\tdfs(1,0);\n\tfor (int v=1;v<=n;v++){\n\t\tif (!rt[v]) continue;//rt\u8868\u793a\u662f\u91cd\u5fc3 \n\t\tfor (int i=head[v];i;i=e[i].next) \n\t\tif (!rt[e[i].to]){\n\t\t\tfa[e[i].to]=v; sta[top=1]=v;\n\t\t\tsolve(e[i].to);\n\t\t\tchange(v,e[i].to,sta[2]);\n\t\t\tfor (int i=2;i<top;i++)if (sta[i+1]!=fa[sta[i]])\n\t\t\tchange(sta[i],fa[sta[i]],sta[i+1]);\n\t\t\tfor (int i=top-3;i>=1;i--) change(sta[i],sta[i+1],sta[top-1]);\n\t\t}\n\t}\n\tprintf(\"%d\\n\",cnt);\n\tfor(int i=1;i<=cnt;i++)printf(\"%d %d %d\\n\",ans[i][0],ans[i][1],ans[i][2]);\n}\n```\n\n\n\n\n",
        "postTime": 1613380635,
        "uid": 288460,
        "name": "xzggzh1",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF843C \u3010Upgrading Tree\u3011"
    }
]
[
    {
        "content": "\u8003\u8651 $\\text{dp}$ \u72b6\u6001\u3002\n\n$dp[pre][len]$ \u8003\u8651\u5230 $s$ \u7684\u524d\u7f00\u4e3a $pre$\uff0c\u5176\u4e0e $t$ \u7684\u6700\u5927\u516c\u5171\u5b50\u5e8f\u5217\u4e3a $len$ \u7684\u6700\u5c0f\u524d\u7f00\u3002\n\n\u8003\u8651\u8f6c\u79fb\u3002\n\n$dp[pre][len]=\\min(dp[pre-1][len]$\uff0c\u5728 $dp[pre-1][len-1]$ \u53f3\u9762\u6700\u9760\u5de6\u7684\u548c $s[pre]$ \u76f8\u540c\u7684\u4f4d\u7f6e\uff09\u3002\n\n\u4e3a\u4e86 $O(1)$ \u8f6c\u79fb\u8003\u8651\u9884\u5904\u7406\u4e24\u4e2a\u6570\u7ec4\u3002\n\n$dp1[i][j][k]$ \u8868\u793a\u5728 $b[i]$ \u5b57\u7b26\u4e32\u4e0a\u7684\u7b2c $j$ \u4e2a\u4f4d\u7f6e\u53f3\u9762\u6700\u9760\u5de6\u7684\u5b57\u7b26\u4e3a $k$ \u7684\u4f4d\u7f6e\u3002\n\n$dp2[i][k]$ \u8868\u793a\u5728 $t[i]$ \u53f3\u9762\u542b\u6709\u5b57\u7b26 $k$ \u7684\u6700\u9760\u5de6\u7684\u4f4d\u7f6e\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u901a\u8fc7\u8fd9\u9053\u9898\u4e86\u3002\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<vector>\n#include<set>\n#include<algorithm>\n#define er -'a'+1\n#define inf 0x3f3f3f3f\n#define maxn 2010\nusing namespace std;\nnamespace lin\n{\n\tstring s;\n\tstring t[maxn];\n\tstruct linlin\n\t{\n\t\tint lin[30];\n\t};\n\tstruct jialin\n\t{\n\t\tint num,id;\n\t\tjialin(){}\n\t\tjialin(int _num,int _id){\n\t\t\tnum=_num,id=_id;\n\t\t}\n\t\tfriend bool operator < (jialin xx,jialin yy)\n\t\t{\n\t\t\treturn xx.num>yy.num;\n\t\t}\n\t};\n\tset<jialin>st;\n\tset<jialin>::iterator it;\n\tvector<linlin> dp1[maxn];\n\tint wjll[maxn][30];\n\tint dp2[maxn][30];\n\tint dp[maxn][maxn];//dp[pre][len]\u8003\u8651\u5230s\u7684\u524d\u7f00\u4e3apre,\u5176\u4e0et\u7684\u6700\u5927\u516c\u5171\u5b50\u5e8f\u5217\u4e3alen\u7684\u6700\u5c0f\u524d\u7f00 \n\tint vist[40];\n\tint vis[30];\n\tint a[maxn],sum[maxn];\n\tint query(int x,int op)\n\t{\n\t\tif(x==inf) return inf;\n\t\tit=st.lower_bound(jialin(x,20060913));\n\t\tjialin tmp=*it;\n\t\tint tt=tmp.id;\n\t\tif(sum[tt]==x)\n\t\t\ttt--;\n\t\tint sw=x-sum[tt<0?0:tt];\n\t\tif(sw>0)\n\t\t\tif(dp1[a[tt+1]][sw-1].lin[op])\n\t\t\t{\n\t\t\t\treturn sum[tt]+dp1[a[tt+1]][sw-1].lin[op];\n\t\t\t}\n\t\ttt=dp2[tt+1][op];\n\t\tif((int)(t[a[tt]][0] er)==op)\n\t\t\treturn sum[tt-1]+1;\n\t\tif(dp1[a[tt]][0].lin[op])\n\t\t{\n\t\t\treturn sum[tt-1]+dp1[a[tt]][0].lin[op];\n\t\t}\n\t\treturn inf;\n\t}\n\tint love(int wjl)\n\t{\n\t\tint n,m;\n\t\tios::sync_with_stdio(false);\n    \tcin.tie(NULL);\n\t\tcin>>n;\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tcin>>t[i];\n\t\t\tint siz=t[i].size();\n\t\t\tfor(int j=0;j<siz;j++)\n\t\t\t\twjll[i][t[i][j] er]=1;\n\t\t}\n\t\tcin>>m;\n\t\tst.insert(jialin(0,0));\n\t\tfor(int i=1;i<=m;i++)\n\t\t{\n\t\t\tcin>>a[i];\n\t\t\tsum[i]=sum[i-1]+(int)t[a[i]].size();\n\t\t\tst.insert(jialin(sum[i],i));\n\t\t}\n\t\tfor(int i=m;i>=0;i--)\n\t\t{\n\t\t\tfor(int j=1;j<=26;j++)\n\t\t\t\tdp2[i][j]=vist[j];\n\t\t\tfor(int j=1;j<=26;j++)\n\t\t\t\tif(wjll[a[i]][j])\n\t\t\t\t\tvist[j]=i;\n\t\t}\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tint siz=t[i].size();\n\t\t\tmemset(vis,0,sizeof(vis));\n\t\t\tfor(int j=siz-1;j>=0;j--)\n\t\t\t{\n\t\t\t\tlinlin tmp;\n\t\t\t\tfor(int z=1;z<=26;z++)\n\t\t\t\t\ttmp.lin[z]=vis[z];\n\t\t\t\tdp1[i].push_back(tmp);\n\t\t\t\tvis[t[i][j] er]=j+1;\n\t\t\t}\n\t\t\treverse(dp1[i].begin(),dp1[i].end());\n\t\t}\n\t\tcin>>s;\n\t\tint nn=s.size();\n\t\tmemset(dp,0x3f,sizeof(dp));\n\t\tdp[0][0]=0; \n\t\tlinlin tmp;\n\t\tmemset(tmp.lin,0,sizeof(tmp.lin)); \n\t\tdp1[0].push_back(tmp);\n\t\tfor(int i=1;i<=nn;i++)\n\t\t{\n\t\t\tfor(int j=0;j<=nn;j++)\n\t\t\t{\n\t\t\t\tif(i==3&&j==3)\n\t\t\t\t\ti++,i--;\n\t\t\t\tdp[i][j]=dp[i-1][j];\n\t\t\t\tif(j!=0)\n\t\t\t\t\tdp[i][j]=min(dp[i][j],query(dp[i-1][j-1],s[i-1] er));\n\t\t\t}\n\t\t}\n\t\tfor(int i=nn;i>=0;i--)\n\t\t{\n\t\t\tif(dp[nn][i]!=inf)\n\t\t\t{\n\t\t\t\tcout<<i;\n\t\t\t\treturn wjl;\n\t\t\t}\n\t\t}\n\t\treturn wjl;\n\t}\n}\nsigned main()\n{\n\treturn lin::love(0);\n}\n```\n",
        "postTime": 1660290780,
        "uid": 545730,
        "name": "tong2324919503jl",
        "ccfLevel": 6,
        "title": "CF176D Hyper String \u9898\u89e3"
    },
    {
        "content": "[o](https://www.luogu.com.cn/problem/CF176D) [rz](https://codeforces.com/problemset/problem/176/D)\n\n\u9898\u610f\uff1a\u6709 $n$ \u4e2a\u5b57\u7b26\u4e32 $a_1...a_n$\uff0c\u603b\u957f\u5ea6\u4e0d\u8d85\u8fc7 $10^6$\u3002\u73b0\u5728\u7ed9\u51fa\u957f\u5ea6\u4e3a $m$ \u7684\u6570\u5217 $id_1...id_m$\uff0c\u6784\u9020\u5b57\u7b26\u4e32 $A=a_{id_1}+a_{id_2}+...+a_{id_m}$\uff0c\u5176\u4e2d $+$ \u8868\u793a\u4e24\u4e2a\u5b57\u7b26\u4e32\u76f8\u8fde\u3002\u7ed9\u51fa\u5b57\u7b26\u4e32 $B$\uff0c\u6c42 $\\operatorname{LCS}(A,B)$\u3002$|B|,n,m\\le2000$\n\n\u5206\u6790\uff1a\n\n\u6700\u76f4\u63a5\u6700\u7b80\u5355\u7684\u65b9\u6cd5\u5c31\u662f\u8bbe $f_{i,j}$ \u8868\u793a $A$ \u4e2d\u524d $i$ \u4e2a\u5b57\u7b26\u548c $B$ \u4e2d\u524d $j$ \u4e2a\u5b57\u7b26\u7684 $\\operatorname{LCS}$\uff0c\u4f46\u662f\u5bb9\u6613 T\u3002\n\n\u53d1\u73b0\u7b54\u6848\u4e0d\u8d85\u8fc7 $|B|$~~\uff08q~~\uff0c\u4e8e\u662f\u5229\u7528\u8d2a\u5fc3\uff0c\u5373 **\u6362\u91cf\u4f18\u5316DP**~~\uff08\u522b\u67e5\u4e86\uff0c\u81ea\u5df1\u8d77\u7684\u540d\uff09~~\uff0c\u8fd9\u4e2a\u6280\u5de7\u4e5f\u662f\u975e\u5e38\u5e38\u89c1\u7684\u3002\n\n\u4ea4\u6362\u6570\u503c\uff0c\u8bbe $f_{i,j}$ \u8868\u793a\u6574\u4e2a $A$ \u5b57\u7b26\u4e32\u548c $B$ \u4e2d\u524d $i$ \u4e2a\u5b57\u7b26\uff0c\u5171\u5339\u914d\u4e86 $j$ \u4e2a\u5b57\u7b26\uff08LCS\uff09\uff0c\u6b64\u65f6 $A$ \u4e2d\u6700\u540e\u4e00\u4e2a\u5339\u914d\u7684\u5b57\u7b26\u4f4d\u7f6e\u662f\u591a\u5c11\u3002\n\n\u8fd9\u65f6\u53ef\u4ee5\u5229\u7528 $f_{i,j}$ \u66f4\u65b0 $i+1$ \u9636\u6bb5\u7684\u72b6\u6001\u3002\u9996\u5148 $B_j$ \u53ef\u4ee5\u4e0d\u9009\uff1a$f_{i+1,j}\\leftarrow f_{i,j}$\n\n\u5982\u679c\u9009\u62e9 $B_j$ \u5339\u914d\uff0c\u5c31\u9700\u8981\u5728 $A$ \u4e2d $f_{i,j}$ \u7684\u4f4d\u7f6e\u4e4b\u540e\u627e\u4e00\u4e2a\u7b49\u4e8e $B_j$ \u7684\u5b57\u7b26 $A_p$\uff1a$f_{i+1,j+1}\\leftarrow p$\u3002\n\n\u67e5\u627e\u53ef\u4ee5\u9884\u5904\u7406\u81ea\u52a8\u673a\u3002\n\n\u7531\u4e8e\u6211 ~~\uff08lgj\uff09~~ \u7684 $f_{i,j}$ \u5b58\u7684\u662f**\u6574\u4e2a $A$ \u7684\u4f4d\u7f6e**\n\uff0c\u6240\u4ee5\u8fd8\u8981\u4e8c\u5206\u4e00\u4e0b\u8fd9\u4e2a\u4f4d\u7f6e\u5c5e\u4e8e\u54ea\u4e2a\u5b57\u7b26\u4e32\uff0c\u4f1a\u52a0\u4e00\u4e2a $\\log$\u3002\n\n\u603b\u65f6\u95f4 $O(|B|^2\\log m+26(10^6+m))$\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int maxn=2010;\nll n,m,len[maxn],id[maxn],P[26][maxn],f[maxn][maxn],sum[maxn];\nchar s[maxn*500];\nvector<ll>p[26][maxn];\nll Next(ll i,ll j,ll c)\n{\n\t++j;\n\tif(j>len[id[i]]) j=1,++i;\n\tif(i>m) return 0;\n\tif(p[c][id[i]][j]) return sum[i-1]+p[c][id[i]][j];\n\t++i;\n\tif(P[c][i]) return sum[P[c][i]-1]+p[c][id[P[c][i]]][1];\n\treturn 0;\n}\nll belong(ll x)\n{\n\treturn lower_bound(sum,sum+1+m,x)-sum;\n}\nint main()\n{\n\tscanf(\"%lld\",&n);\n\tfor(ll i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%s\",s+1);\n\t\tlen[i]=strlen(s+1);\n\t\tfor(ll j=0;j<26;j++) p[j][i].resize(len[i]+1);\n\t\tfor(ll j=len[i];j;j--)\n\t\t{\n\t\t\tfor(ll k=0;k<26;k++) p[k][i][j]=(j==len[i]?0:p[k][i][j+1]);\n\t\t\tp[s[j]-'a'][i][j]=j;\n\t\t}\n\t\tsum[i]=sum[i-1]+len[i];\n\t}\n\tscanf(\"%lld\",&m);\n\tfor(ll i=1;i<=m;i++)\n\t{\n\t\tscanf(\"%lld\",&id[i]);\n\t\tsum[i]=sum[i-1]+len[id[i]];\n\t}\n\tscanf(\"%s\",s+1);\n\tll L=strlen(s+1);\n\tfor(ll i=m;i;i--)\n\t{\n\t\tfor(ll j=0;j<26;j++)\n\t\t\tif(p[j][id[i]][1]) P[j][i]=i;\n\t\t\telse P[j][i]=P[j][i+1];\n\t}\n\tfor(ll i=0;i<26;i++) P[i][0]=P[i][1];\n\tmemset(f,0x3f,sizeof f);\n\tf[0][0]=0;\n\tfor(ll i=0;i<L;i++)\n\t{\n\t\tfor(ll j=0;j<=i;j++)\n\t\t{\n\t\t\tif(f[i][j]>1e15) break;\n\t\t\tf[i+1][j]=min(f[i+1][j],f[i][j]);\n\t\t\tll x=belong(f[i][j]),y=f[i][j]-sum[x-1];\n\t\t\tll p=Next(x,y,s[i+1]-'a');\n\t\t\tif(p) f[i+1][j+1]=min(f[i+1][j+1],p);\n\t\t}\n\t}\n\tfor(ll i=L;~i;i--)\n\t\tif(f[L][i]<1e15)\n\t\t{\n\t\t\tprintf(\"%lld\",i);\n\t\t\tbreak;\n\t\t}\n\treturn 0;\n}\n```",
        "postTime": 1673328661,
        "uid": 375953,
        "name": "Sktn0089",
        "ccfLevel": 7,
        "title": "\u3010\u9898\u89e3CF176D\u3011Hyper String"
    },
    {
        "content": "\n## \u9898\u610f\n\u76f4\u63a5\u7c98\u7684\u7ffb\u8bd1\u3002\n\n\u7ed9\u5b9a $n(n \\le 2000)$ \u4e2a\u5c0f\u5199\u82f1\u6587\u5b57\u6bcd\u7ec4\u6210\u7684\u5b57\u7b26\u4e32 ${a_i}$\uff0c\u603b\u957f\u5ea6\u4e0d\u8d85\u8fc7 $10 ^ 6$\u3002\u518d\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $m(m \\le 2000)$ \u7684\u6b63\u6574\u6570\u5e8f\u5217 ${b_i}(1 \\le b_i \\le n)$\uff0c\u5b9a\u4e49 $A = a_{b_1} + a_{b_2} + ... + a_{b_M}$\uff0c\u5176\u4e2d$+$\u8868\u793a\u5b57\u7b26\u4e32\u7684\u8fde\u63a5\u3002\u6700\u540e\u7ed9\u5b9a\u4e00\u4e2a\u5c0f\u5199\u82f1\u6587\u5b57\u6bcd\u7ec4\u6210\u7684\u5b57\u7b26\u4e32 $B(|B| \\le 2000)$\uff0c\u6c42 $A$ \u548c $B$ \u7684\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\u957f\u5ea6\u3002\n\n## \u601d\u8def                                              \n\n\u9996\u5148\u610f\u8bc6\u5230 A \u7684\u957f\u5ea6\u4f1a\u8fbe\u5230 $10^9$ \u7ea7\u522b\uff08\u4e0d\u4fdd\u8bc1 b \u4e2d\u5143\u7d20\u4e92\u4e0d\u76f8\u540c\uff09\uff0c\u4e0d\u53ef\u80fd\u5b58\u5230\u72b6\u6001\u91cc\u66b4\u529b\u5efa\u51fa\u6765\u8dd1 dp\uff0c\u6240\u4ee5\u53ea\u80fd\u5206\u522b\u5904\u7406\u5f62\u6210  A \u7684\u6bcf\u4e00\u4e2a\u5b50\u4e32\uff0c\u4f46\u5728\u72b6\u6001\u4e2d\u8bb0\u5f55\u5728 A \u7684\u4f4d\u7f6e\u5c31\u5df2\u7ecf\u4e0d\u591f\u7528\u4e86\uff0c\u800c\u8fd9\u53c8\u662f\u6211\u4eec\u8f6c\u79fb\u6240\u5fc5\u987b\u7684\u3002\u8fd9\u91cc\u6709\u4e2a\u80cc\u5305\u4e2d\u7ecf\u5e38\u4f7f\u7528\u7684\u6280\u5de7\uff0c\u65e2\u7136\u8fd9\u4e2a\u9898\u7b54\u6848\u4e0d\u5927\uff0c\u90a3\u5c31\u53ef\u4ee5\u5c06\u7b54\u6848\u5b58\u5230\u72b6\u6001\u91cc\uff0c\u5c06\u5728 A \u4e2d\u7684\u4f4d\u7f6e\u5b58\u5230 dp \u6570\u7ec4\u4e2d\uff0c\u6240\u4ee5\u72b6\u6001\u5c31\u53d8\u6210\u4e86 $F[i][j]$ \u8868\u793a\u8003\u8651\u5230 B \u7684\u7b2c $i$ \u4f4d\uff0c\u7b54\u6848\u662f $j$ \uff0c\u5728A \u4e2d\u7684\u4f4d\u7f6e\u6700\u5c0f\u662f\u591a\u5c11\uff08\u7528\u4e00\u4e2a pair \u8868\u793a \u662f\u5f62\u6210 A \u7684\u7b2c\u51e0\u4e2a\u5b57\u7b26\u4e32\uff0c\u4ee5\u53ca\u5728\u5f53\u524d\u8fd9\u4e2a\u4e2d\u7684\u4f4d\u7f6e\uff09\u3002\n\n\u7136\u540e\u5c31\u8003\u8651\u8f6c\u79fb\u7684\u95ee\u9898\uff0c\u53ef\u4ee5\u770b\u5230\u5373\u4f7f\u6211\u4eec\u505a\u4e86\u8f6c\u5316\uff0c\u72b6\u6001\u6570\u4e5f\u5df2\u7ecf\u5230\u4e86  $10^6$  \u7ea7\u522b\uff0c\u6240\u4ee5\u8f6c\u79fb\u5fc5\u987b\u662f\u7684 $O(1)/O(\\log n)$\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u72b6\u6001    $F[i][j]$\uff0c\u6709\u4e24\u79cd\u60c5\u51b5\uff0c\u8981\u4e0d\u5411 $F[i+1][j]$ \u8f6c\u79fb\uff0c\u6b64\u65f6\u4e0d\u9009 B \u8fd9\u4e00\u4f4d\u7684\u5b57\u7b26\uff0c\u6240\u4ee5\u76f4\u63a5\u8f6c\u79fb\uff0c\u7b2c\u4e8c\u79cd\u662f\u9009 B \u8fd9\u4e00\u4f4d\u7684\u5b57\u7b26\uff0c\u8fd9\u65f6\u5019\u5c31\u8981\u5728 A \u4e2d\u627e\u5230\u9664\u4e86\u5df2\u7ecf\u5339\u914d\u90e8\u5206\u7b2c\u4e00\u4e2a\u4e0e $B_{i+1}$  \u76f8\u7b49\u7684\u4f4d\u7f6e\u4e86\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u6bcf\u4e2a\u5b50\u4e32\u4e2d\u5404\u4e2a\u5b57\u7b26\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u4e8c\u5206\u7b2c\u4e00\u4e2a\u5927\u4e8e\u5f53 \u524d\u4f4d\u7f6e\u7684\u4f4d\u7f6e\uff0c\u5982\u679c\u5728\u8fd9\u4e2a\u4e32\u4e2d\u6ca1\u6709\u5c31\u53bb\u4e0b\u4e00\u4e2a\u4e32\u4e2d\u63a5\u7740\u4e8c\u5206\uff0c\u590d\u6742\u5ea6\u53ef\u80fd\u4f1a\u9000\u5316\u6210 $O(m)$\uff0c\u6240\u4ee5\u9884\u5904\u7406\u4e00\u4e2a $nxt[i][ch]$  \u6570\u7ec4\uff0c\u8868\u793a\u5f53\u524d  \u540e\u7b2c\u4e00\u4e2a ch \u5b57\u7b26\u7684\u4f4d\u7f6e\uff0c\u8fd9\u6837\u5728\u5f53\u524d\u4e2d\u6ca1\u627e\u5230\uff0c\u5c31\u53ef\u4ee5\u53bb\u4e0b\u4e00\u4e2a\u4e2d\u627e\uff0c\u6700\u591a\u627e\u4e24\u4e2a\uff0c\u590d\u6742\u5ea6\u5c31\u5f97\u5230\u4e86\u4fdd\u8bc1\u3002\n\n\u7136\u540e\u8f93\u51fa\u7684\u65f6\u5019\u5c31\u770b\u6700\u5927\u7684 $F[|B|][j]$ \u4e0d\u662f\u6b63\u65e0\u7a77\u7684 $j$ \u5c31\u884c\u4e86\u3002\n\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntemplate<typename T>\ninline bool cmax(T& a,const T& b){return a<b?a=b,1:0;}\ntemplate<typename T>\ninline bool cmin(T& a,const T& b){return b<a?a=b,1:0;}\ntypedef long long ll;\ntypedef pair<int,int> pii;\ntypedef unsigned long long ull;\ntypedef unsigned int ui;\ntypedef vector<int> vi;\ntypedef vector<vector<int> > vii;\nconst int MAXN=2006;\nconst int mod=1e9+7;\nconst int INF=mod;\nstring s[MAXN];\nint b[MAXN];\nchar t[MAXN];\npii F[MAXN][MAXN];\nvi pos[MAXN][26];\nint nxt[MAXN][26];\ninline pii getnxt(pii u,char c)\n{\n\tint p=u.first,x=u.second;\n\tvi& uvi=pos[b[p]][c];\n\tauto ii=upper_bound(uvi.begin(),uvi.end(),x);\n\tif(ii==uvi.end())\n\t{\n\t\t//cerr<<\"!!!\";\n\t\tvi& vvi=pos[b[nxt[p+1][c]]][c];\n\t\tif(vvi.empty())return {INF,INF};\n\t\telse return {nxt[p+1][c],vvi.front()};\n\t}\n\telse return {p,*ii};ii};//\u6ce8\u610f\u8fd9\u91cc\u8fd4\u56de\u7684\u4e0d\u662f\u5728\u7ed9\u51fa\u7684\u7b2c\u51e0\u4e2a\u4e32\u4e2d\uff0c\u800c\u662f\u5728\u7ed9\u51fa\u5e8f\u5217 b \u7684\u54ea\u4e00\u4e2a\n}\nint main()\n{\n\tios_base::sync_with_stdio(0),cin.tie(0),cout.tie(0);cout<<fixed<<setprecision(20);\n\tint n;cin>>n;\n\ts[0]=\" \";\n\tfor(int i=1;i<=n;i++)cin>>s[i],s[i]=' '+s[i];\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<s[i].size();j++)\n\t\t\tpos[i][s[i][j]-'a'].push_back(j);\n\tint m;cin>>m;\n\tfor(int i=1;i<=m;i++)cin>>b[i];\n\tfor(int j=0;j<26;j++)nxt[m+1][j]=m+1;\n\tfor(int i=m;i;i--)\n\t\tfor(int j=0;j<26;j++)\n\t\tif(pos[b[i]][j].size())nxt[i][j]=i;\n\t\telse nxt[i][j]=nxt[i+1][j];\n\tcin>>t+1;\n\tint len=strlen(t+1);\n\tfor(int i=0;i<=len;i++)\n\t\tfor(int j=0;j<=len;j++)\n\t\t\tF[i][j]=make_pair(INF,INF);\n\tfor(int i=0;i<=len;i++)F[i][0]={0,0};\n\tauto u=getnxt({3,1},'a');\n\t\n\tfor(int i=0;i<len;i++)\n\t\tfor(int j=0;j<=i;j++)\n\t\t{\n\t\t\tif(F[i][j]!=(pii){INF,INF})\n\t\t\t{//\tcerr<<i<<' '<<j<<'\\n';\n\t\t\t\tcmin(F[i+1][j],F[i][j]);\n\t\t\t\tpii u=F[i][j];\n\t\t\t\tif(u.first==m&&u.second+1==s[b[m]].size())continue;\n\t\t\t\n\t\t\t//\tcerr<<u.first<<' '<<u.second<<'\\n';\n\t\t\t\tauto v=getnxt(u,t[i+1]-'a');\n\t\t\t//\tcerr<<\"!\\n\";\n\t\t\t//\tcerr<<u.first<<' '<<u.second<<'\\n';\n\t\t\t//\tcerr<<v.first<<' '<<v.second<<'\\n';\n\t\t\t\tcmin(F[i+1][j+1],v);\n\t\t\t}\n\t\t}\n\t\n\tint ans=len;\n\twhile(ans>0&&F[len][ans]==(pii){INF,INF})ans--;\n\tcout<<ans;\n\treturn 0;\n}\n```\n",
        "postTime": 1662455602,
        "uid": 571229,
        "name": "__stick",
        "ccfLevel": 7,
        "title": "CF176D"
    }
]
[
    {
        "content": "\u7b80\u8981\u9898\u610f\uff1a\n\n\u5b9a\u4e49\u4e09\u7ef4\u7a7a\u95f4\u4e2d\u7684\u4e00\u4e2a lattice \u662f\u6ee1\u8db3\u4e0b\u5217\u6761\u4ef6\u7684\u4e09\u7ef4\u6574\u70b9\u7684\u96c6\u5408\uff1a\n\n$$\nL=\\{u\\cdot \\overrightarrow{r_1}+v\\cdot \\overrightarrow{r_2}+w\\cdot \\overrightarrow{r_3} \\}_{u,v,w\\in \\mathbb Z}\n$$\n\n\u5176\u4e2d $\\overrightarrow{r_1},\\overrightarrow{r_2},\\overrightarrow{r_3}$ \u4e3a\u4e09\u7ef4\u7a7a\u95f4\u4e2d\u7684\u6574\u7cfb\u6570\u5750\u6807\u5411\u91cf\uff0c\u6ee1\u8db3\uff1a\n\n1. $\\overrightarrow{r_1},\\overrightarrow{r_2},\\overrightarrow{r_3}$ \u4e24\u4e24\u6b63\u4ea4\uff0c\u5373\n\n$$\n\\overrightarrow{r_1}\\cdot \\overrightarrow{r_2}=\\overrightarrow{r_1}\\cdot \\overrightarrow{r_3} =\\overrightarrow{r_2}\\cdot \\overrightarrow{r_3}=0\n$$\n\n2. $\\overrightarrow{r_1},\\overrightarrow{r_2},\\overrightarrow{r_3}$ \u957f\u5ea6\u76f8\u7b49\uff0c\u5373\n\n$$\n|\\overrightarrow{r_1}|=|\\overrightarrow{r_2}|=|\\overrightarrow{r_3}|\n$$\n\n\u73b0\u5728\u7531\u6709 $n$ \u4e2a\u4e09\u7ef4\u6574\u70b9\u6784\u6210\u7684\u7684\u96c6\u5408 $A=\\{\\overrightarrow{a_1},\\overrightarrow{a_2},\\cdots,\\overrightarrow{a_n} \\}$ \uff0c\u5176\u4e2d $\\overrightarrow{a_i}=(x_i,y_i,z_i)$\u3002\n\n\u4f60\u9700\u8981\u627e\u5230\u4e00\u4e2a lattice L \u6ee1\u8db3 $A\u2282 L$ \u4e14\u7ec4\u6210 $L$ \u7684\u4e09\u4e2a\u57fa\u5411\u91cf\u5c3d\u53ef\u80fd\u5927\u3002\n\nsol\uff1a\n\n\u4e8c\u7ef4\u5e73\u9762\u4e0a\u7684\u53d8\u6362\u4e00\u822c\u4f7f\u7528\u590d\u6570\u6765\u523b\u753b\uff0c\u5176\u4e2d\u76f8\u5f53\u4e8e\u6574\u6570\u5728\u5b9e\u6570\u4e2d\u5730\u4f4d\u7684\uff0c\u88ab\u79f0\u4e3a Gauss \u6574\u6570\uff08\u5373 $a+b\\text{i}$ \u5176\u4e2d $a,b\\in \\mathbb Z$\uff09\u3002\u6240\u6709 Gauss \u6574\u6570\u5173\u4e8e $+$ \u548c $\\times$ \u7684\u7b97\u6784\u6210\u4e00\u4e2a Euclid \u6574\u73af\u3002\n\n\u5148\u8003\u8651\u4e00\u4e2a\u7b80\u5316\u7684\u4e8c\u7ef4\u7248\u672c\uff1a\n\n\u53ef\u4ee5\u53d1\u73b0\u6240\u6709 $a_i$ \u53ef\u4ee5\u88ab\u62c6\u6210\u4e24\u4e2a\u9ad8\u65af\u6574\u6570\u7684\u4e58\u79ef\uff0c\u5373 $a_i=b_i\\cdot g$\uff0c\u5176\u4e2d $g=(\\overrightarrow{r_1},\\overrightarrow{r_2})$\u3002\u800c\u8981\u627e\u5230\u6700\u5927\u7684 $g$ \u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7 Euclid \u7b97\u6cd5\u5b8c\u6210\u3002\n\n\u7136\u540e\u6765\u8003\u8651\u4e09\u7ef4\u7a7a\u95f4\uff1a\n\n\u6839\u636e\u7b2c\u4e00\u4e2a\u6761\u4ef6\uff0c\u53ef\u4ee5\u53d1\u73b0  $\\overrightarrow{r_3}$ \u4e0e $\\overrightarrow{r_1}\\times \\overrightarrow{r_2}$ \u662f\u5171\u7ebf\u5411\u91cf\u3002\n\n\u800c\u53c8\u56e0\u4e3a $|\\overrightarrow{r_1}\\times \\overrightarrow{r_2}|=r^2,|\\overrightarrow{r_3}|=r$\uff0c\u8bf4\u660e $\\overrightarrow{r_1}\\times \\overrightarrow{r_2}=\\pm r\\cdot \\overrightarrow{r_3}\u21d2 r\\in \\mathbb N^{*}$ \u3002\n\n\uff08\u5373 $\\overrightarrow{r_3}$ \u53ef\u4ee5\u7528 $\\overrightarrow{r_3}=\\pm \\frac{\\overrightarrow{r_1}\\cdot \\overrightarrow{r_2}}{|r_1|} $ \u8868\u793a\uff09\n\n\u5e76\u4e14\uff0c\u7531\u4e8e $\\overrightarrow{a}=u\\cdot \\overrightarrow{r_1}+v\\cdot \\overrightarrow{r_2}+w\\cdot \\overrightarrow{r_3}$\uff0c\u5219 $|\\overrightarrow{a}|^2=(u^2+v^2+w^2)\\cdot r^2\u21d2r^2 |(|\\overrightarrow{a}|^2)$\n\n\u5373 $r$ \u9700\u8981\u6ee1\u8db3 $r^2|\\gcd(x_1^2+y_1^2+z_1^2,x_2^2+y_2^2+z_2^2,\\cdots ,x_n^2+y_n^2+z_n^2)$\u3002\n\n\u5e76\u4e14\u56e0\u4e3a\u6ee1\u8db3\u8fd9\u4e2a\u6761\u4ef6\u7684 $r$ \u6570\u91cf\u4e0d\u591a\uff0c\u6240\u4ee5\u53ef\u4ee5\u5bf9 $r$ \u4ece\u5927\u5230\u5c0f\u9010\u4e2a\u68c0\u9a8c\u662f\u5426\u5408\u6cd5\u3002\n\n\u800c\u5728\u4e09\u7ef4\u7a7a\u95f4\u4e2d\u7684\u53d8\u6362\uff0c\u4e00\u822c\u4f7f\u7528\u56db\u5143\u6570 $a+b\\text{i}+c\\text{j}+d\\text{k}$ \u6765\u523b\u753b\uff0c\u800c\u5728\u56db\u5143\u6570\u4e2d\u6709\u6574\u6570\u5730\u4f4d\u7684\uff0c\u88ab\u79f0\u4e3a Lipschitz \u56db\u5143\u6570\u3002\uff08\u56db\u5143\u6570\u7684\u8fd0\u7b97\u6ee1\u8db3\u7ed3\u5408\u5f8b\uff0c\u4e0d\u6ee1\u8db3\u4ea4\u6362\u5f8b\uff0c$\\text i^2=\\text j ^2 =\\text k ^2=ijk=-1$\n\n\u4f46\u662f\u8fd9\u6837\u5b9a\u4e49\u51fa\u6765\u7684\u56db\u5143\u6570\u96c6\u5408\u4e0d\u6784\u6210 Euclid \u6574\u73af\uff0c\u800c\u8fd9\u9053\u9898\u4e2d\u7684\u64cd\u4f5c\u7c7b\u4f3c\u4e8e $\\gcd$ \u7684\u8fc7\u7a0b\uff0c\u56e0\u6b64\u9700\u8981\u6269\u5145\u4e00\u4e0b\u5b9a\u4e49\uff0c\u8003\u8651\u589e\u52a0\u90e8\u5206\u6709\u7406\u56db\u5143\u6570\u3002\n\n\u5728\u590d\u6570\u4e2d\uff0c$|a+b\\text i|=\\sqrt{a^2+b^2}$\uff0c\u4f1a\u6709\u4e00\u4e9b\u6ee1\u8db3 $a^2+b^2\\in\\mathbb Z$\uff0c\u8fd9\u6837\u5c31\u4f1a\u6709\u4e00\u4e9b\u5f62\u5982 $\\frac 4 5+\\frac 3 5 \\text i$ \u7684\u4e1c\u897f\uff0c\u867d\u7136\u6a21\u957f\u4e3a\u6574\u6570\uff0c\u4f46\u662f\u53ef\u4ee5\u548c $1,\\text i$ \u6574\u7cfb\u6570\u8868\u793a\u51fa $\\frac{1+\\text i}{5}$\uff0c\u6a21\u957f\u5c31\u4e0d\u4e3a\u6574\u6570\u3002\n\n\u4e8e\u662f\u5728 $\\mathbb C$ \u4e2d\uff0c\u5982\u679c\u80fd\u6269\u5145\u7684\u8bdd\uff0c\u80af\u5b9a\u8981\u8003\u8651 $a+b\\text i$\uff0c\u5176\u4e2d $\\frac 1 a,\\frac 1 b\\in{\\mathbb Z}$\u3002\u90a3\u4e48\u5728\u8fd9\u79cd\u60c5\u51b5\u60c5\u51b5\u4e0b\uff0c\u9664\u4e86 $a=b=1$\uff0c\u5176\u4f59\u6240\u6709\u7684\u6709\u7406\u590d\u6570\u6a21\u957f\u5747\u4e0d\u7b49\u4e8e $1$\uff0c\u56e0\u6b64\u4e0d\u80fd\u6269\u5145\u3002\n\n\u4f46\u662f\uff0c\u8fd9\u4ef6\u4e8b\u642c\u5230\u56db\u5143\u6570 $\\mathbb H$ \u4e2d\u5c31\u4e0d\u4e00\u6837\u4e86\uff0c\u53ef\u4ee5\u53d1\u73b0 $a=b=c=d=2$ \u65f6\uff0c$|\\frac{1+\\text i +\\text j +\\text k}2|=1$\u3002\n\n\u56e0\u6b64\uff0c\u5982\u679c\u5c06 $\\omega=\\frac{1+\\text i+\\text j+\\text k}2$ \u52a0\u5165 Lipschitz \u56db\u5143\u6570\u96c6\u5408\uff0c\u5e76\u53d6\u6b63\u7cfb\u6570\u8868\u793a\uff0c\u5c31\u5f97\u5230\u4e86Hurwitz \u56db\u5143\u6570\uff1a\n\n$$\nH=\\{a+b\\text i+c\\text j+d\\text k|a,b,c,d\\in \\mathbb{Z}\\vee a,b,c,d\\in\\mathbb Z+\\frac 1 2 \\}\n$$\n\n\u53ef\u4ee5\u8bc1\u660e\uff0c\u867d\u7136\u6ca1\u6709\u4ea4\u6362\u5f8b\uff0c\u4f46\u662f $H$ \u4e2d\u4f9d\u7136\u6709\u7c7b\u4f3c\u5730\u552f\u4e00\u5206\u89e3\u5b9a\u7406\uff0c\u53ef\u4ee5\u505a Euclid \u7b97\u6cd5\u3002\n\n\u5177\u4f53\u5730\uff0c\u5728 $H$ \u4e2d\uff0c\u5bf9\u4e8e\u4e24\u4e2a\u6570 $A,B$\uff0c\u53ef\u4ee5\u5b9a\u4e49\u5b83\u7684\u5de6\u5546\u3001\u5de6\u4f59\u6570\uff0c\u53f3\u5546\u3001\u53f3\u4f59\u6570\uff0c\u4ee5\u53ca\u5de6 $\\gcd$ \u548c\u53f3 $\\gcd$\u3002\u5982\uff0c\u5de6\u5546\u548c\u5de6\u4f59\u6570\u5bf9\u5e94\u8868\u8fbe\u5f0f $A=qB+r$\uff0c\u800c\u5de6 $\\gcd $ \u5c31\u8868\u793a\u6a21\u6700\u5927\u7684 $d$ \u6ee1\u8db3 $A=du,B=dv$\u3002\n\n\u6709\u4e86 Hurwitz \u56db\u5143\u6570\u540e\uff0c\u6574\u4e2a\u95ee\u9898\u5c31\u6e05\u6670\u4e86\u5f88\u591a\uff1a\n\n\u9996\u5148\u5bf9\u4e8e\u4e09\u7ef4\u7a7a\u95f4\u4e2d\u7684\u5411\u91cf $\\overrightarrow a=(x,y,z)$ \uff0c\u5bf9\u5e94\u5230\u56db\u5143\u6570 $A=x\\text i+y\\text j+z\\text k$\u3002\u90a3\u4e48\u4e09\u7ef4\u7a7a\u95f4\u4e2d\u5176\u4e2d\u4e00\u7ec4\u6807\u51c6\u7684\u6b63\u4ea4\u57fa\u5c31\u53ef\u4ee5\u8868\u793a\u4e3a $\\text{i,j,k}$\u3002\n\n\u6839\u636e\u7acb\u4f53\u51e0\u4f55\uff0c\u4e09\u7ef4\u7a7a\u95f4\u4e2d\u7684\u65cb\u8f6c\u53d8\u6362\u53ef\u4ee5\u8fd9\u6837\u8868\u793a\uff1a\n\n$$\n\\overrightarrow{v}\u21a6k\\cdot \\frac{q\\cdot \\overrightarrow v\\cdot \\overline q}{q\\cdot \\overline q}=k\\cdot \\frac{q\\cdot \\overrightarrow v\\cdot \\overline q}{|q|^2}\n$$\n\n\u5176\u4e2d $\\overrightarrow v$ \u8868\u793a\u5b9e\u90e8\u4e3a $0$ \u7684\u56db\u5143\u6570\uff0c$q=a+b\\text i+c\\text j+d\\text k$ \u4e3a\u4e00\u4e2a\u7279\u5b9a\u7684\u56db\u5143\u6570\uff0c$\\overline q$ \u4e3a $q$ \u7684\u5171\u8f6d $\\overline q=a-b\\text i -c\\text j-d\\text k$\u3002\n\n\u4e8e\u662f\uff0c$\\overrightarrow{r_1},\\overrightarrow{r_2},\\overrightarrow{r_3}$ \u90fd\u53ef\u4ee5\u770b\u6210\u6807\u51c6\u6b63\u4ea4\u57fa\u7ecf\u8fc7\u67d0\u4e2a\u65cb\u8f6c\u5e76\u7f29\u653e\u540e\u7684\u7ed3\u679c\uff0c\u56e0\u6b64\u6709\uff1a\n\n$$\n\\begin{cases} \n\\overrightarrow{r_1} =r\\cdot \\frac{q\\cdot \\text i\\cdot \\overline{q}}{|q|^2}\\\\\n\\overrightarrow{r_2} =r\\cdot \\frac{q\\cdot \\text j\\cdot \\overline{q}}{|q|^2}\\\\\n\\overrightarrow{r_3} =r\\cdot \\frac{q\\cdot \\text k\\cdot \\overline{q}}{|q|^2}\\\\\n\\end{cases}\n\n$$\n\n\n\n\u7136\u540e\u53ef\u4ee5\u53d1\u73b0 $x=\\frac{k}{|q|^2}=\\frac{k}{a^2+b^2+c^2+d^2}$ \u7684\u5206\u6bcd\u662f $4$ \u7684\u7ea6\u6570\u3002\n\n\u5177\u4f53\u8bc1\u660e\uff1a\n\n\u9996\u5148\u8fd8\u662f\u8fd9\u4e2a\u5f0f\u5b50 $\\overrightarrow{v}\u21a6k\\cdot \\frac{q\\cdot \\overrightarrow v\\cdot \\overline q}{q\\cdot \\overline q}$\u3002\n\n\u8003\u8651\u5199\u6210\u77e9\u9635\u5f62\u5f0f\uff1a\n\n$$\n\\frac{k}{a^2+b^2+c^2+d^2}\\cdot \n\\begin{pmatrix} \na^2+b^2-c^2-d^2 & 2cb-2ad & 2ac+2bd\\\\ \n2ad+2bc & a^2-b^2+c^2-d^2 & 2cd-2ab\\\\\n2bd-2ac & 2ab+2cd & a^2-b^2-c^2+d^2\\\\\n\\end{pmatrix}\n$$\n\n\u663e\u7136\u77e9\u9635\u4e2d\u6240\u6709\u5143\u7d20\u5747\u4e3a\u6574\u6570\u3002\u56e0\u6b64\u5206\u6570 $\\frac{k}{a^2+b^2+c^2+d^2}$ \u5e94\u8be5\u6574\u9664\u4e8e\u6240\u6709\u77e9\u9635\u5143\u7d20\u3002\u4e0d\u5931\u4e00\u822c\u6027\uff0c\u53ef\u4ee5\u5047\u8bbe $\\gcd(a,b,c,d)=1$\uff08\u5426\u5219\u53ef\u4ee5\u8ba9 $a,b,c,d$ \u9664\u4ee5\u8fd9\u4e2a\u6570\u4f7f\u56db\u5143\u6570\u5750\u6807\u51cf\u5c0f\uff0c\u5e76\u4e14\u77e9\u9635\u5143\u7d20\u4e0d\u53d8\uff09\u3002\u5047\u8bbe $\\frac{k}{a^2+b^2+c^2+d^2}=\\frac{P}{Q}$\uff0c\u5219 $Q$ \u8981\u6574\u9664\u4e8e\u6240\u6709\u77e9\u9635\u5143\u7d20\uff0c \u5e76\u4e14\u6574\u9664\u4e8e $a^2 +b^2+c^2+d^2$\uff0c\u5373\u6574\u9664\u4e8e\uff1a\n\n$$\n\\gcd \n\\begin{pmatrix} \na^2+b^2+c^2+d^2\\\\ \na^2+b^2-c^2-d^2 \\\\\na^2-b^2+c^2-d^2 \\\\\na^2-b^2-c^2+d^2\n\\end{pmatrix}\n=\\gcd\n\\begin{pmatrix} \na^2+b^2+c^2+d^2\\\\ \n2(c^2+d^2) \\\\\n2(b^2+d^2) \\\\\n2(b^2+c^2)\n\\end{pmatrix}\n=\\gcd\n\\begin{pmatrix} \na^2+b^2+c^2+d^2\\\\ \n2(c^2+d^2) \\\\\n2(b^2+d^2) \\\\\n4d^2\n\\end{pmatrix}\n$$\n\n\uff08$\\gcd(a\\pm b,b)=\\gcd(a,b)=\\gcd(-a,b)$\uff09\n\n\u5e76\u4e14\u7531\u4e8e $\\gcd(a,b)$ \u6574\u9664\u4e8e $\\gcd(k\\cdot a,b)$\uff0c\u56e0\u6b64 $Q$ \u6574\u9664\u4e8e\uff1a\n\n$$\n\\gcd\n\\begin{pmatrix} \n4(a^2+b^2+c^2+d^2)\\\\ \n4(c^2+d^2) \\\\\n2(b^2+d^2) \\\\\n4d^2\n\\end{pmatrix}\n=4\\gcd (a^2,b^2,c^2,d^2)=4\n$$\n\n\u56e0\u6b64 $\\overrightarrow{v}\u21a6k\\cdot \\frac{q\\cdot \\overrightarrow v\\cdot \\overline q}{4}$\u3002\n\n\u5982\u679c\u653e\u5bbd\u6761\u4ef6 $x\\in H$\uff0c\u5219\u8fdb\u4e00\u6b65\u53ef\u8bf4\u660e $x$ \u7684\u5206\u6bcd\u662f $2$ \u7684\u7ea6\u6570\uff0c\u5373 $2x\\in\\mathbb Z$\u3002\u901a\u8fc7\u9002\u5f53\u8c03\u6574\u4f7f\u5f97 $q$ \u4e3a Lipschitz \u56db\u5143\u6570 \uff0c\u6839\u636e\u9898\u76ee\u6761\u4ef6\u53ef\u5f97\u5230 $x=1$\u3002\n\n\u5b9a\u4e49 $f(v)=q\\cdot v\\cdot \\overline{q}$\uff0c\u90a3\u4e48\u5b58\u5728\u4e00\u7ec4\u5411\u91cf  $\\overrightarrow{b_1},\\overrightarrow{b_2},\\cdots,\\overrightarrow{b_n}$ \u6ee1\u8db3\n\n$$\n\\overrightarrow{a_i}=f(\\overrightarrow{b_i})=q\\cdot \\overrightarrow{b_i} \\cdot \\overline{q}\n$$\n\n\u4e8e\u662f\uff0c\u6b64\u65f6\u6709 $q|\\overrightarrow{a_i}$ \uff0c\u56e0\u6b64 $q|\\gcd(\\overrightarrow{a_1},\\overrightarrow{a_2},\\cdots,\\overrightarrow{a_n})$\u3002\n\n\u5e76\u4e14\u8fd8\u679a\u4e3e\u4e86 $r$\uff0c\u56e0\u6b64\u5fc5\u987b\u6709 $|q|^2=r$\uff0c\u7531\u552f\u4e00\u5206\u89e3\u5b9a\u7406\u53ef\u5f97\u5230 $q|r$\u3002\n\n\u4e8e\u662f $q|\\gcd(\\overrightarrow{a_1},\\overrightarrow{a_2},\\cdots,\\overrightarrow{a_n},r)$\u3002\u4e8b\u5b9e\u4e0a\uff0c\u8bbe $q_0=\\gcd(\\overrightarrow{a_1},\\overrightarrow{a_2},\\cdots,\\overrightarrow{a_n},r)$ \uff0c\u5219 $|q_0|^2|r$\uff0c\u56e0\u6b64\u53ea\u6709\u5f53 $|q_0|^2=r$ \u65f6\u624d\u6709\u5fc5\u8981\u9a8c\u8bc1\u4e0b\u53bb\u3002\n\n\u4e4b\u540e\u5c31\u53ea\u9700\u8981\u53cd\u89e3\u51fa $\\overrightarrow{b_i}=\\frac{q\\cdot \\overrightarrow{a_i}\\cdot \\overline q}{r^2}$ \u5e76\u68c0\u9a8c\u662f\u5426\u662f\u6574\u6570\u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define ll long long\n#define ld long double\n#define R(i,a,b) for(int i=(a),i##E=(b);i<=i##E;i++)\n#define L(i,a,b) for(int i=(b),i##E=(a);i>=i##E;i--)\nconst ld eps=1e-10l;\nusing namespace std;\n\nstruct qua\n{\n\tld a,b,c,d;\n\tinline qua(ld A=0,ld B=0,ld C=0,ld D=0):a(A),b(B),c(C),d(D) {}\n\tinline qua operator + (qua A) \n\t{\n\t\treturn qua(a+A.a,b+A.b,c+A.c,d+A.d);\n\t}\n\tinline qua operator - (qua A)\n\t{\n\t\treturn qua(a-A.a,b-A.b,c-A.c,d-A.d);\n\t}\n\tinline qua operator * (qua A)\n\t{\n\t\treturn qua(\n\t\t\ta*A.a-b*A.b-c*A.c-d*A.d,\n\t\t\ta*A.b+b*A.a+c*A.d-d*A.c,\n\t\t\ta*A.c-b*A.d+c*A.a+d*A.b,\n\t\t\ta*A.d+b*A.c-c*A.b+d*A.a\n\t\t);\n\t}\n\tinline qua conj()//\u5171\u8f6d\n\t{\n\t\treturn qua(a,-b,-c,-d);\n\t}\n\tinline ld norm()//|q|^2\n\t{\n\t\treturn a*a+b*b+c*c+d*d;\n\t}\n\tinline qua inv()\n\t{\n\t\treturn conj()*qua(1.l/norm());\n\t}\n\tinline int check_int()\n\t{\n\t\treturn fabsl(roundl(a)-a)<eps&&fabsl(roundl(b)-b)<eps&&fabsl(roundl(c)-c)<eps&&fabsl(roundl(d)-d)<eps;\n\t}\n\tinline qua qround()\n\t{\n\t\tqua q1=qua(roundl(a),roundl(b),roundl(c),roundl(d));\n\t\tqua q2=qua(floorl(a)+.5l,floorl(b)+.5l,floorl(c)+.5l,floorl(d)+.5l);\n\t\treturn (q1-*this).norm()<(q2-*this).norm()?q1:q2;\n\t}\n\tinline qua operator / (qua A)\n\t{\n\t\treturn A.inv() * *this;\n\t}\n\tinline qua operator % (qua A)\n\t{\n\t\tqua ret=(*this/A).qround();\n\t\treturn *this-A*ret;\n\t}\n\tinline void printf()\n\t{\n\t\tcout<<b<<\" \"<<c<<\" \"<<d<<'\\n';\n\t}\n\tinline void print()\n\t{\n\t\tcout<<llroundl(b)<<\" \"<<llroundl(c)<<\" \"<<llroundl(d)<<'\\n';\n\t}\n}a[11111],g;\nqua gcd(qua a,qua b)\n{\n\treturn b.norm()<eps?a:gcd(b,a%b);\n}\nll gcd(ll a,ll b)\n{\n\treturn !b?a:gcd(b,a%b);\n}\n\nint n;\nll G;\nvector<ll>v;\nsigned main()\n{\n\tios::sync_with_stdio(false);\n\tcin.tie(NULL);\n\tcin>>n;\n\tR(i,1,n)\n\t{\n\t\tcin>>a[i].b>>a[i].c>>a[i].d;\n\n\t\tg=gcd(g,a[i]);\n\t\tG=gcd(G,(ll)a[i].norm());\n\t}\n\tfor(ll i=1;i*i<=G;i++) if(G%(i*i)==0) v.emplace_back(i);\n\treverse(v.begin(),v.end());\n\tfor(auto x:v)\n\t{\n\t\tqua q=gcd(g,qua(x));\n\t\tll r=(ll)q.norm();\n\t\tif(r!=x) continue;\n\t\tqua q0=q.conj() / qua(r * r);\n\t\tint ok=1;\n\t\tR(i,1,n) if((q0*a[i]*q).check_int()==0)\n\t\t{\n\t\t\tok=0;\n\t\t\tbreak;\n\t\t}\n\t\tif(ok)\n\t\t{\n\t\t\tcout<<r*r<<'\\n';\n\t\t\t(q*qua(0,1)*q.conj()).print();\n\t\t\t(q*qua(0,0,1)*q.conj()).print();\n\t\t\t(q*qua(0,0,0,1)*q.conj()).print();\n\t\t\treturn 0;\n\t\t} \n\t}\n}\n```",
        "postTime": 1651336230,
        "uid": 115779,
        "name": "\u6781\u5bd2\u795e\u51b0",
        "ccfLevel": 0,
        "title": "cf1375i"
    }
]
[
    {
        "content": "### \u9898\u76ee\u5927\u610f\n\n$t$ \u7ec4\u6570\u636e\uff0c\u6bcf\u7ec4\u7ed9\u5b9a\u4e00\u4e2a $n$ \u4e2a\u7ed3\u70b9\u7684\u6811\uff0c **\u6839\u4e3a $1$** \uff0c\u7ed9\u5b9a $2,3,\\ldots ,n$ \u7684\u7236\u7ed3\u70b9 $p_2,p_3,\\ldots ,p_n$ \u3002\u518d\u7ed9\u51fa\u6bcf\u4e2a\u70b9\u6743\u503c $a_i$ \u7684\u8303\u56f4 $[l_i,r_i]$ \u3002\n\n\u521d\u59cb\u6bcf\u4e2a\u70b9\u7684\u6743\u503c\u5747\u4e3a $0$ \u3002\u6bcf\u6b21\u64cd\u4f5c\u53ef\u4ee5\u9009\u62e9\u4ece $1$ \u5f00\u59cb\u7684\u6811\u4e0a\u8def\u5f84 $b_1,b_2,\\ldots,b_k$ \uff08\u4e0d\u4e00\u5b9a\u8981\u5728\u53f6\u5b50\u5904\u7ed3\u675f\uff09\uff0c\u5c06 $a_{b_i}$ \u52a0\u4e0a $c_i$ \uff0c\u5176\u4e2d $\\{c_i\\}$ \u662f\u4e00\u4e2a **\u975e\u8d1f\u5355\u8c03\u975e\u51cf** \u7684 **\u6574\u6570** \u6570\u5217\u3002\n\n\u95ee\u81f3\u5c11\u591a\u5c11\u6b21\u64cd\u4f5c\uff0c\u53ef\u4ee5\u4ee4\u6240\u6709\u70b9\u70b9\u6743\u5747\u5728 $[l_i,r_i]$ \u8303\u56f4\u5185\u3002\n\n$1\\le t\\le 1000,2\\le n\\le 2\\times 10^5,\\sum n\\le 2\\times 10^5,1\\le p_i<i,1\\le l_i\\le r_i\\le 10^9$\n\n### \u89e3\u9898\u601d\u8def\n\n\u8003\u8651\u5bf9\u4e00\u7ec4\u7279\u5b9a\u7684\u6700\u7ec8\u70b9\u6743 $a_i$ \uff0c\u5982\u4f55\u8ba1\u7b97\u6700\u5c0f\u64cd\u4f5c\u6570\u3002\n\n\u5bf9\u4e8e\u53f6\u5b50\u7ed3\u70b9\uff0c\u4e00\u5b9a\u53ef\u4ee5\u4e00\u6b21\u64cd\u4f5c\u5c06 $0$ \u53d8\u4e3a $a_i$ \u3002\u5c06\u8fc7\u4e00\u4e2a\u70b9 $i$ \u7684\u6240\u6709\u64cd\u4f5c\u6574\u5408\u8d77\u6765\uff0c\u6ee1\u8db3\u52a0\u4e0a\u7684\u6570\u4e4b\u548c\u7b49\u4e8e $a_i$ \uff0c\u4e14\u5176\u7236\u4eb2\u52a0\u4e0a\u7684\u6570\u4e3a $[0,a_i]$ \u4e2d\u7684\u4e00\u4e2a\u6574\u6570\u503c\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u70b9 $i$ \uff0c\u8bbe\u5176\u5b50\u7ed3\u70b9\u4e3a $son$ \uff0c\u82e5\u6709 $a_i>\\sum a_{son}$ \uff0c\u5219\u5fc5\u987b\u6709\u4e00\u6b21\u64cd\u4f5c\u4ee5\u8be5\u70b9\u4e3a\u7ec8\u70b9\uff0c\u53cd\u4e4b\u53ef\u4ee5\u4ece\u4ee5\u5176\u5b50\u5b59\u4e3a\u7ec8\u70b9\u7684\u64cd\u4f5c\u4e2d\u5c06\u8be5\u70b9\u70b9\u6743\u51cf\u4e3a $0$ \u3002\n\n\u63a5\u4e0b\u6765\u662f\u786e\u5b9a\u6700\u7ec8\u70b9\u6743\u7684\u6700\u4f18\u503c $a_i$ \u3002\u5e94\u7528\u8d2a\u5fc3\u601d\u60f3\uff0c\u5bf9\u4e8e\u5b50\u7ed3\u70b9\uff0c\u6211\u4eec\u5e0c\u671b\u5176 $a_i$ \u5c3d\u91cf\u5927\uff0c\u8fd9\u6837\u5176\u7236\u4eb2\u66f4\u4e0d\u5bb9\u6613\u5360\u7528\u4e00\u6b21\u64cd\u4f5c\u3002\u4ece\u53f6\u5b50\u5411\u6839\uff0c\u5bf9\u53f6\u5b50\u7ed3\u70b9 $i$ \uff0c\u6211\u4eec\u5c06\u5176\u70b9\u6743\u8d4b\u503c\u4e3a $r_i$ \uff1b\u5bf9\u975e\u53f6\u5b50\u7ed3\u70b9 $x$ \uff0c\u82e5 $\\sum a_{son}>l_x$ \uff0c\u5219\u5c06\u8be5\u70b9\u8d4b\u503c\u4e3a $\\operatorname{max}\\{r_x,\\sum a_{son}\\}$ \uff0c\u4e0d\u4f1a\u589e\u52a0\u64cd\u4f5c\u4e14\u5bf9\u540e\u7eed\u5f71\u54cd\u6700\u4f18\uff1b\u82e5 $\\sum a_{son}\\le l_x$ \uff0c\u5219\u8be5\u70b9\u5fc5\u5c06\u5360\u7528\u4e00\u6b21\u64cd\u4f5c\uff0c\u5c06\u70b9\u6743\u8d4b\u503c\u4e3a $r_x$ \uff0c\u540e\u7eed\u6700\u4f18\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$ \u3002\n\n### \u53c2\u8003\u4ee3\u7801\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nconst int maxn=4200010;\n#define int long long\nint T,n,fa[maxn],l[maxn],r[maxn],a[maxn],ans;\nint cur,h[maxn],nxt[maxn],p[maxn];\nvoid add_edge(int x,int y){cur++;nxt[cur]=h[x];p[cur]=y;h[x]=cur;}\nvoid dfs(int x)\n{\n\tint sum=0;\n\tfor(int j=h[x];j;j=nxt[j])dfs(p[j]),sum+=a[p[j]];\n\tif(l[x]>sum)ans++,a[x]=r[x];\n\telse a[x]=min(r[x],sum);\n}\nsigned main()\n{\n\tscanf(\"%lld\",&T);\n\twhile(T--)\n\t{\n\t\tscanf(\"%lld\",&n);\n\t\tcur=0;for(int i=1;i<=n;i++)h[i]=0;\n\t\tfor(int i=2;i<=n;i++)scanf(\"%lld\",fa+i),add_edge(fa[i],i);\n\t\tfor(int i=1;i<=n;i++)scanf(\"%lld%lld\",l+i,r+i);\n\t\tans=0;dfs(1);\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1655909562,
        "uid": 43486,
        "name": "hsfzLZH1",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1693B\u3010Fake Plastic Trees\u3011"
    },
    {
        "content": "\u663e\u7136\u662f\u6811\u5f62 DP\uff08\u5176\u5b9e\u7c7b\u4f3c\u8d2a\u5fc3\uff09\u3002\n\n\u8bbe $f_x$ \u8868\u793a\u6ee1\u8db3 $x$ \u4e3a\u6839\u7684\u5b50\u6811\u90fd\u6ee1\u8db3\u6761\u4ef6\u7684\u6240\u9700\u6700\u5c11\u64cd\u4f5c\u6570\uff0c$g_x$ \u8868\u793a\u6ee1\u8db3\u6761\u4ef6\u540e $x$ \u8282\u70b9\u7684\u6700\u5927\u53ef\u80fd\u6743\u503c\uff08\u4e3a\u4f55\u6700\u5927\uff1a\u7ed9\u7956\u5148\u7559\u503c\u57df\uff09\u3002\n\n\u5bf9\u4e8e\u53f6\u5b50 $x$\uff1a$f_x=1,g_x=r_x$\u3002\n\n\u5bf9\u4e8e\u975e\u53f6\u5b50 $x$\uff0c\u8bbe\u513f\u5b50\u7684 $f$ \u548c\u4e3a $F$\uff0c$g$ \u548c\u4e3a $G$\uff1a\n\n* $G\\ge l_x$\uff0c\u53ef\u4ee5\u4e0d\u7528\u52a8\uff0c$f_x=F,g_x=\\min(r_x,G)$\u3002\n\n* $G< l_x$\uff0c\u5fc5\u987b\u8981\u5728\u6b64\u8282\u70b9\u64cd\u4f5c\uff0c$f_x=F+1,g_x=r_x$\u3002\n\n```cpp\n//We'll be counting stars.\n#pragma GCC optimize(\"Ofast\")\n#include<bits/stdc++.h>\nusing namespace std;\n#define fir first\n#define sec second\n#define mkp make_pair\n#define pb emplace_back\n#define For(i,j,k) for(int i=(j),i##_=(k);i<=i##_;i++)\n#define Rof(i,j,k) for(int i=(j),i##_=(k);i>=i##_;i--)\n#define ckmx(a,b) a=max(a,b)\n#define ckmn(a,b) a=min(a,b)\n#define Fi(s) freopen(s,\"r\",stdin)\n#define Fo(s) freopen(s,\"w\",stdout)\n#define Fre(s) Fi(s\".in\"),Fo(s\".out\")\n#define debug cerr<<\"Line#\"<<__LINE__<<endl\n#define ll long long\nconst ll mod=1;\ninline ll pw(ll x,ll y){ll r=1;while(y){if(y&1)r=r*x%mod;x=x*x%mod;y>>=1;}return r;}\n#define int long long\n#define N 200010\n#define pi pair<int,int>\nint n,f[N],g[N]; \npi a[N];\nvector<int> e[N];\nvoid work(){\n\tcin>>n;\n\tFor(i,1,n) e[i].clear();\n\tint x,y; \n\tFor(i,2,n){\n\t\tcin>>x;\n\t\te[x].pb(i);\n\t}\n\tFor(i,1,n) cin>>a[i].fir>>a[i].sec; \n\tRof(i,n,1){\n\t\tif(e[i].empty()){\n\t\t\tf[i]=1;\n\t\t\tg[i]=a[i].sec;\n\t\t}else{\n\t\t\tx=0;y=0;\n\t\t\tfor(int j:e[i]){\n\t\t\t\tx+=f[j];\n\t\t\t\ty+=g[j];\n\t\t\t}\n\t\t\tif(y>=a[i].fir){\n\t\t\t\tf[i]=x;\n\t\t\t\tg[i]=min(a[i].sec,y);\n\t\t\t}else{\n\t\t\t\tf[i]=x+1;\n\t\t\t\tg[i]=a[i].sec;\n\t\t\t}\n\t\t}\n\t}\n\tcout<<f[1]<<endl;\n}\nint32_t main(){\n\tios::sync_with_stdio(false);\n\tcin.tie(nullptr);\n\tint T;cin>>T;\n\twhile(T--)work();\nreturn 0;}\n```",
        "postTime": 1656577611,
        "uid": 101868,
        "name": "I_am_Accepted",
        "ccfLevel": 0,
        "title": "CF1693B Fake Plastic Trees"
    },
    {
        "content": "\u8fd9\u9053\u9898\u5f88\u660e\u663e\u662f\u4e00\u9053\u6811\u5f62 DP\u3002\n\n\u8bbe $x$ \u4e3a\u5f53\u524d\u8282\u70b9, $sum$ \u4e3a $x$ \u7684\u6240\u6709\u5b50\u8282\u70b9\u6743\u503c\u548c\u3002\n\n\u8003\u8651\u5c06\u5f53\u524d $a_x$ \u6700\u5927\u5316\uff0c\u4f7f\u5f97\u5176\u7236\u8282\u70b9\u5c3d\u91cf\u51cf\u5c11\u64cd\u4f5c\u6b21\u6570\u3002\n\n\u5219\u5f53\u5de6\u533a\u95f4 $l_x>sum$ \u65f6\uff0c\u5c06\u70b9\u6743\u8d4b\u503c\u4e3a $r_x$\uff0c\u6b64\u65f6\u5fc5\u987b\u5b8c\u6210\u4e00\u6b21\u64cd\u4f5c\uff0c\u4e14\u540e\u7eed\u4e3a\u6700\u4f18\u3002\n\n\u5426\u5219\u5c06\u70b9\u6743\u8d4b\u503c\u4e3a $\\min(r_x,sum)$\uff0c\u4e0d\u4f1a\u589e\u52a0\u64cd\u4f5c\u4e14\u4e3a\u6700\u4f18\u3002\n\nDP \u4ee3\u7801\uff1a\n```cpp\nvoid dfs(int x){\n\tll sum=0;\n\tfor(int i=head[x];i;i=e[i].next){\n\t\tint y=e[i].to;\n\t\tdfs(y);\n\t\tsum+=p[y].a;\n\t}\n\tif(p[x].l>sum){\n\t\tans++;\n\t\tp[x].a=p[x].r;\n\t}else{\n\t\tp[x].a=min(p[x].r,sum);\n\t}\n}\n```\n\nAC\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include <bits/stdc++.h>\n#define rd read()\nusing namespace std;\nusing ll=long long;//\u5c06long long \u91cd\u5b9a\u4e49\u4e3all\uff0c\u4e0edefine\u540c\u4f5c\u7528\ninline ll read() {\n\tll x = 0, f = 1;\n\tchar ch = getchar();\n\twhile (ch < '0' || ch > '9') {\n\t\tif (ch == '-') f = -1;\n\t\tch = getchar();\n\t}\n\twhile (ch >= '0' && ch <= '9') {\n\t\tx = x * 10 + ch - 48;\n\t\tch = getchar();\n\t}\n\treturn x * f;\n}\nll T,n,fa[2000010],ans;\nstruct node{\n\tll a;\n\tll l;\n\tll r;\n}p[2000010];\nll tot,head[2000010];\nstruct edge{\n\tll to;\n\tll next;\n}e[2000010];\nvoid add(int x,int y){\n\ttot++;\n\te[tot].to=y;\n\te[tot].next=head[x];\n\thead[x]=tot;\n}\n//dfs\u51fd\u6570\u89c1\u4e0a\nint main(){\n\tT=rd;\n\twhile(T--){\n\t\tn=rd;\n\t\ttot=0,ans=0;\n\t\tmemset(head,0,sizeof(head));\n\t\tfor(int i=2;i<=n;i++){\n\t\t\tfa[i]=rd;\n\t\t\tadd(fa[i],i);\n\t\t}\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tp[i].l=rd;\n\t\t\tp[i].r=rd;\n\t\t}\n\t\tdfs(1);\n\t\tcout<<ans<<\"\\n\";\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1666010328,
        "uid": 548209,
        "name": "Purple_Circle",
        "ccfLevel": 0,
        "title": "CF1693B-DP\u722c\u4e0a\u6811\uff01"
    },
    {
        "content": "* **\u3010\u9898\u76ee\u94fe\u63a5\u3011**\n\n[Link:CF1693B](https://www.luogu.com.cn/problem/CF1693B)\n\n* **\u3010\u89e3\u9898\u601d\u8def\u3011**\n\n\u8003\u8651\u54ea\u4e9b\u70b9\u4e00\u5b9a\u8981\u8fdb\u884c\u4e00\u6b21\u5230\u5b83\u7684\u64cd\u4f5c\u3002\u6211\u4eec\u5047\u8bbe\u6bcf\u4e00\u4e2a\u70b9\u5df2\u7ecf\u5b9a\u597d\u4e86\u76ee\u6807\u6743\u503c\u3002\n\n\u663e\u7136\uff0c\u5f53\u4e00\u4e2a\u70b9\u7684\u6240\u6709\u513f\u5b50\u7684\u6743\u503c\u548c\u5927\u4e8e\u7b49\u4e8e\u8be5\u70b9\u6743\u503c\uff0c\u90a3\u4e48\u5c31\u6ca1\u6709\u5fc5\u8981\u5bf9\u5b83\u8fdb\u884c\u4e00\u6b21\u64cd\u4f5c\uff0c\u5426\u5219\u5c31\u8981\u591a\u4f7f\u7528\u4e00\u6b21\u64cd\u4f5c\u3002\n\n\u6211\u4eec\u8003\u8651\u4ece\u513f\u5b50\u5230\u7236\u4eb2\u4f9d\u6b21\u5904\u7406\u51fa\u6240\u6709\u70b9\u7684\u6743\u503c\uff0c\u4e0e\u6240\u6709\u513f\u5b50\u7684\u6743\u503c\u4e4b\u548c\uff08\u663e\u7136\u7236\u4eb2\u7684\u6743\u503c\u4e0d\u80fd\u5927\u4e8e\u6240\u6709\u513f\u5b50\u7684\u6743\u503c\u4e4b\u548c\uff0c\u5426\u5219\u9700\u8981\u989d\u5916\u64cd\u4f5c\uff09\u3002\u5e76\u4e14\u65e0\u8bba\u5982\u4f55\uff0c\u8fd9\u4e2a\u70b9\u7684\u6743\u503c\u53d6\u5f97\u8d8a\u5927\u8d8a\u597d\u3002\n\n\u4e8e\u662f\uff0c\u5f53\u8fd9\u4e2a\u70b9\u65e0\u8bba\u5982\u4f55\u90fd\u8981\u8fdb\u884c\u4e00\u6b21\u64cd\u4f5c\uff08\u5373\u513f\u5b50\u6743\u503c\u548c\u5c0f\u4e8e\u8be5\u70b9\u6743\u503c\u4e0b\u9650\uff09\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u76f4\u63a5\u8ba9\u8fd9\u4e2a\u70b9\u7684\u6743\u503c\u4e3a\u4e0a\u9650\uff0c\u5e76\u589e\u52a0\u7b54\u6848\uff1b\u5426\u5219\uff0c\u6211\u4eec\u5c31\u8ba9\u8fd9\u4e2a\u70b9\u7684\u6743\u503c\u4e3a\u6743\u503c\u4e0a\u9650\u4e0e\u513f\u5b50\u6743\u503c\u548c\u4e2d\u7684\u8f83\u5c0f\u503c\u3002\n\n\u8fb9\u754c\u6761\u4ef6\uff1a\u53f6\u5b50\u8282\u70b9\u513f\u5b50\u6743\u503c\u548c\u4e3a $0$\u3002\n\n* **\u3010\u4ee3\u7801\u5b9e\u73b0\u3011**\n\n```cpp\n#include <iostream>\n#include <array>\n\nusing namespace std;\n\narray<int,200001>\t\t\tfather;\narray<long long,200001>\t\tsubt_sum;\narray<pair<int,int>,200001>\ttarget;\n\nint main(int argc,char* argv[],char* envp[])\n{\n\tios::sync_with_stdio(false);\n\tcin.tie(nullptr);\n\tint testcnt;\n\tcin>>testcnt;\n\twhile(testcnt--)\n\t{\n\t\tint cnt,ans=0;\n\t\tcin>>cnt;\n\t\tsubt_sum[1]=0;\n\t\tfor(int i=2;i<=cnt;i++)\n\t\t\tcin>>father[i],subt_sum[i]=0;\n\t\tfor(int i=1;i<=cnt;i++)\n\t\t\tcin>>target[i].first>>target[i].second;\n\t\tfor(int i=cnt;i;i--)\n\t\t\tif(subt_sum[i]>=target[i].first)\n\t\t\t\tsubt_sum[father[i]]+=min<long long>(target[i].second,subt_sum[i]);\n\t\t\telse\n\t\t\t\t++ans,subt_sum[father[i]]+=target[i].second;\n\t\tcout<<ans<<'\\n';\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1656126817,
        "uid": 372983,
        "name": "Antarctic_Cube",
        "ccfLevel": 6,
        "title": "Solution:CF1693B(Fake Plastic Trees)"
    }
]
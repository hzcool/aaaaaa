[
    {
        "content": "### \u9898\u76ee\u5927\u610f\n\u6709\u4e00\u6392\u6811\uff0c\u6bcf\u68f5\u6811\u6709\u53ef\u80fd\u5f80\u5de6\u5012\uff0c\u6709\u53ef\u80fd\u5f80\u53f3\u5012\uff0c\u5012\u4e0b\u540e\u4f1a\u8986\u76d6\u4e00\u4e9b\u533a\u95f4\uff0c\u7ed9\u5b9a\u4e00\u4e9b\u8611\u83c7\uff0c\u5df2\u77e5\u6bcf\u4e2a\u8611\u83c7\u7684\u4ef7\u503c\u548c\u4f4d\u7f6e\uff0c\u6c42\u5bf9\u4ef7\u503c\u603b\u548c\u7684\u671f\u671b\n\n\n------------\n\n### \u5206\u6790\n\u8f6c\u5316\u7684\u4e00\u4e0b\u9898\u76ee\n\n\u6bcf\u68f5\u6811\u7684\u503e\u5012\u8303\u56f4\u90fd\u53ef\u4ee5\u770b\u62102\u4e2a\u533a\u95f4\uff0c\u6bcf\u4e2a\u533a\u95f4\u5185\u4ef7\u503c\u7684\u671f\u671b\u90fd\u8981\u4e58\u4e0a\u8fd9\u68f5\u6811\u503e\u5012\u5728\u8fd9\u4e2a\u533a\u95f4\u7684\u6982\u7387\uff0c\u81ea\u7136\u800c\u7136\u5c31\u60f3\u5230\u4e86**\u7ebf\u6bb5\u6811**\u7684\u533a\u95f4\u4fee\u6539\u3002\n\n\u540c\u6837\u7684\uff0c\u6bcf\u4e2a\u8611\u83c7\u8611\u83c7\u53ef\u4ee5\u770b\u6210\u662f\u4e00\u4e2a\u70b9\uff0c\u8fd9\u4e2a\u70b9\u4e0d\u88ab\u7838\u7684\u6982\u7387\u4e58\u4e0a\u8611\u83c7\u7684\u4ef7\u503c\u5c31\u662f\u8fd9\u4e2a\u8611\u83c7\u7684\u4ef7\u503c\u671f\u671b\uff0c\u4f9d\u7136\u53ef\u4ee5\u5229\u7528**\u7ebf\u6bb5\u6811**\u7684\u5355\u70b9\u67e5\u8be2\u5b8c\u6210\u3002\n\n\u4f46\u662f\u6570\u636e\u8303\u56f4\u8fbe\u5230\u4e8610^9\uff0c\u76f4\u63a5\u5957\u6a21\u677f\u4e0d\u884c\u3002\u7ee7\u7eed\u601d\u8003\uff0c\u6bcf\u68f5\u6811\u5f62\u6210\u76842\u4e2a\u533a\u95f4\u4ec5\u4ec5\u5305\u62ec4\u4e2a\u9876\u70b9\uff0c\u6bcf\u4e2a\u8611\u83c7\u53601\u4e2a\u70b9\u3002\n\n\u663e\u7136\uff0c\u9664\u4e86\u8fd94*n+m\u4e2a\u70b9\uff0c\u5176\u5b83\u70b9\u5bf9\u8fc7\u7a0b\u548c\u7b54\u6848\u90fd\u6ca1\u6709\u5f71\u54cd\uff0c\u90a3\u4e48\uff0c\u53ea\u9700\u5bf9\u6570\u636e\u8fdb\u884c**\u79bb\u6563**\u5c31\u884c\u4e86\u3002\n\n\n------------\n### \u89e3\u6cd5\n\u79bb\u6563+\u7ebf\u6bb5\u6811\u533a\u95f4\u4fee\u6539\u5355\u70b9\u67e5\u8be2\n\n\n------------\n### \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n#define DB double\nusing namespace std;\nconst int maxn=1e5+5,maxm=1e4+5,maxe=maxn*4+maxm,maxp=4*maxe;\nint n,m,b[maxe],id[maxe],tot,cnt,d;\n//b\u6570\u7ec4\u5b58\u6240\u6709\u6570\u636e\uff0cid\u8bb0\u5f55\u7b2ci\u5927\u7684\u6570\u662f\u591a\u5c11\nDB p[maxp],ans;//p\u662f\u61d2\u6807\u8bb0\nint read(){\n\tint ret=0,f=1;char ch=getchar();\n\twhile(ch>'9'||ch<'0'){if(ch=='-')f=-f;ch=getchar();}\n\twhile(ch>='0'&&ch<='9') ret=ret*10+ch-'0',ch=getchar();\n\treturn ret*f;\n}\nstruct tree{\n\tint x,h,l,r;\n}a[maxn];\n//a\u6570\u7ec4\u5b58\u6811\nstruct mogu{\n\tint x,v;\n}c[maxn];\n//c\u6570\u7ec4\u5b58\u8611\u83c7\nint find(int x){//\u4e8c\u5206\u67e5\u627ex\u79bb\u6563\u4e4b\u540e\u7684\u7ed3\u679c\n\tint L=1,R=cnt,mid;\n\twhile(L<=R){\n\t\tmid=L+R>>1;\n\t\tif(id[mid]==x) return mid;\n\t\tid[mid]<x?L=mid+1:R=mid-1; \n\t}\n}\nvoid build(int l,int r,int k){//\u5efa\u6811\uff0c\u521d\u59cb\u4fdd\u7559\u6982\u7387\u4e3a1\n\tp[k]=1,d++;\n\tif(l==r) return;\n\tint mid=l+r>>1;\n\tbuild(l,mid,k<<1),build(mid+1,r,k<<1|1); \n}\nvoid change(int L,int R,int k,int l,int r,DB x){//\u7ebf\u6bb5\u6811\u57fa\u672c\u64cd\u4f5c\uff0c\u533a\u95f4\u4fee\u6539\n\tif(L>r||R<l) return;//\u5206\u79bb\u76f4\u63a5\u8df3\u8fc7\n\tif(l<=L&&R<=r){ p[k]*=x/100.0;return;}//\u5305\u542b\u5173\u7cfb\uff0c\u76f4\u63a5\u8ba9\u61d2\u6807\u8bb0\u4e58\u4e0a\u6982\u7387\n\tif(L==R) return;\n\tint mid=L+R>>1;\n\tchange(L,mid,k<<1,l,r,x),change(mid+1,R,k<<1|1,l,r,x);//\u7ee7\u7eed\u9012\u5f52\n}\nDB ask(int l,int r,int k,int x){//\u7ebf\u6bb5\u6811\u57fa\u672c\u64cd\u4f5c\uff0c\u5355\u70b9\u67e5\u8be2\n\tif(l==r) return p[k];//\u627e\u5230\u5373\u505c\u6b62\n\tint mid=l+r>>1;\n\tif(mid>=x) return ask(l,mid,k<<1,x)*p[k];\n\telse return ask(mid+1,r,k<<1|1,x)*p[k];\n    //\u9012\u5f52\u7ed3\u679c\u4e58\u5f53\u524d\u61d2\u6807\u8bb0\n}\nint main(){\n// \tfreopen(\"CF138C.in\",\"r\",stdin);\n// \tfreopen(\"CF138C.out\",\"w\",stdout);\n\tn=read(),m=read();\n\tfor(int i=1;i<=n;i++){\n\t\ta[i].x=read(),a[i].h=read(),a[i].l=read(),a[i].r=read();\n\t\tb[++tot]=a[i].x-a[i].h,b[++tot]=a[i].x-1,b[++tot]=a[i].x+1,b[++tot]=a[i].x+a[i].h;\n        //\u4e00\u68f5\u6811\u5f62\u6210\u7684\u9876\u70b9\u5206\u522b\u662fxi-hi\uff0cxi-1\uff0cxi+1\uff0cxi+hi\n        //\u5148\u5b58\u8fdbb\u6570\u7ec4\n\t}\n\tfor(int i=1;i<=m;i++){\n\t\tc[i].x=read(),c[i].v=read();\n\t\tb[++tot]=c[i].x;\n        //\u628a\u8611\u83c7\u4e5f\u5b58\u8fdb\u53bb\n\t}\n\tsort(b+1,b+1+tot);//\u7531\u5c0f\u5230\u5927\u6392\u5e8f\n\tfor(int i=1;i<=tot;i++) if(b[i]!=b[i+1]) id[++cnt]=b[i];//id\u5b58\u7b2ci\u5927\u7684\u6570\u7684\u6570\u503c\n\tbuild(1,cnt,1);//\u5efa\u4e00\u68f5\u7ebf\u6bb5\u6811\n\tfor(int i=1;i<=n;i++){\n\t\tint L=find(a[i].x-a[i].h),midl=find(a[i].x-1),midr=find(a[i].x+1),R=find(a[i].x+a[i].h);\n        //\u5206\u522b\u7528\u4e8c\u5206\u67e5\u627e\u51fa\u79bb\u6563\u4e4b\u540e\u7684\u6570\u503c\n\t\tchange(1,cnt,1,L,midl,(DB)100.0-a[i].l),change(1,cnt,1,midr,R,(DB)100.0-a[i].r);\n        //\u628a\u8fd9\u4e9b\u533a\u95f4\u90fd\u4e58\u4e0a\u4e0d\u88ab\u7838\u7684\u6982\u7387\n\t}\n\tfor(int i=1;i<=m;i++){\n\t\tint x=find(c[i].x);\n\t\tans+=(DB)ask(1,cnt,1,x)*c[i].v;//\u4e0d\u88ab\u7838\u7684\u6982\u7387\u4e58\u4ef7\u503c\u5373\u671f\u671b\n\t}\n\tprintf(\"%.10lf\\n\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1559057449,
        "uid": 116251,
        "name": "\u7834\u5fc6",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF138C \u3010Mushroom Gnomes - 2\u3011"
    },
    {
        "content": "\u5728[\u8fd9\u91cc](https://www.luogu.com.cn/training/16003)\u66f4\u65b0\u3002\u6709\u4e0d\u61c2\u7684\u53ef\u4ee5\u5728\u8bc4\u8bba\u533a\u63d0\u51fa,\u6211\u5c06\u4f1a\u79c1\u4fe1\u56de\u7b54\u3002~~(\u5728\u6211\u6ca1\u9000\u5f79\u4e4b\u524d)~~\n\n# \u9898\u76ee\n(\u8bfb\u4e86\u7ffb\u8bd1\u53d1\u73b0\u6ca1\u770b\u61c2,\u6700\u540e\u770b\u4e86\u82f1\u8bed\u539f\u6587+\u8bf7\u6559\u6559\u7ec3\u624d\u770b\u61c2,\u6240\u4ee5\u7ed9\u5927\u5bb6\u89e3\u91ca\u4e00\u4e0b\u9898\u76ee\u5927\u610f(\u4e0d\u9010\u5b57\u5bf9\u5e94,\u53ea\u89e3\u91ca\u5927\u610f))\n## \u9898\u76ee\u5927\u610f\n\u4e00\u6761\u76f4\u7ebf\u4e0a\u6709n\u68f5\u6811\u548cm\u4e2a\u8611\u83c7\u3002\u7b2ci\u68f5\u6811\u6240\u5728\u4f4d\u7f6e\u4e3aa[i]\u6709l[i]\u7684\u6982\u7387\u5f80\u5de6\u5012,r[i]\u7684\u6982\u7387\u5f80\u53f3\u5012,\u4e5f\u53ef\u4ee5\u4e0d\u5012,\u5012\u5730\u53ef\u4ee5\u6467\u6bc1h[i]\u957f\u5ea6\u7684\u5730\u9762(\u5f80\u5de6\u5012\u53ef\u4ee5\u6467\u6bc1$a[i]-h[i]<=x<a[i]$\u7684\u5730\u9762,\u5f80\u53f3\u5012\u53ef\u6467\u6bc1$a[i]<x<=a[i]+h$\u7684\u5730\u9762,**a[i]\u4e0d\u4f1a\u88ab\u6467\u6bc1**)\u3002\u5982\u679c\u8611\u83c7\u6240\u5728\u7684\u5730\u9762\u88ab\u6467\u6bc1\u90a3\u4e48\u8611\u83c7\u4e5f\u6ca1\u4e86\u3002 $\\color{red}\\text{\u6ce8\u610f\u4e0d\u7b49\u5f0f\u7684\u7b26\u53f7\u6709\u6ca1\u6709\u53d6\u5230\u7b49\u53f7\u3002}$\n\n\u7b2ci\u4e2a\u8611\u83c7\u7684\u4f4d\u7f6e\u4f4d\u4e8eb[i],\u6743\u503c\u4e3az[i],\u6c42\u6467\u6bc1\u540e\u5269\u4e0b\u7684\u8611\u83c7\u7684\u671f\u671b\u6743\u503c\u548c\u3002\n\n## \u8f93\u5165\n\n\u7b2c1\u884c1\u4e2a\u6574\u6570n,m,\u5206\u522b\u8868\u793a\u6811\u548c\u8611\u83c7\u7684\u4e2a\u6570\u3002\n\n\u63a5\u4e0b\u6765n\u884c,\u6bcf\u884c4\u4e2a\u6574\u6570,a[i],h[i],l[i],r[i],\u5206\u522b\u8868\u793a\u4f4d\u7f6e,\u6467\u6bc1\u7684\u957f\u5ea6,\u5f80\u5de6\u548c\u53f3\u5012\u7684\u6982\u7387**\u767e\u5206\u6bd4**(50\u8868\u793a50%\u53730.5) $\\color{red}\\text{\u6ce8\u610f\u6982\u7387\u662f\u767e\u5206\u6bd4!}$\n\n## \u8f93\u51fa\n\n\u4e00\u4e2a\u5c0f(\u5206)\u6570,\u4ee3\u8868\u671f\u671b\u6743\u503c\u548c\u3002\u8981\u6c42\u8bef\u5dee(\u5373\u7b54\u6848\u4e0e\u8f93\u51fa\u5dee\u7684\u7edd\u5bf9\u503c)<=0.0001\u3002\n\n## \u6837\u4f8b\u89e3\u91ca\u5373\u8bf4\u660e\n\n### \\#1\n\n\u7b2c1\u68f5\u6811\u670950%\u7684\u6982\u7387\u5f80\u5de6\u5012(\u5373\u8986\u76d60<=x<2\u7684\u533a\u95f4),\u8611\u83c7\u5728\u4f4d\u7f6e1,\u6743\u503c\u4e3a1\u3002\u6240\u4ee5\u671f\u671b\u6743\u503c\u548c\u4e3a1\u00d70.5=0.5\u3002\n\n### \\#2\n\n\u7b2c1\u68f5\u6811\u670950%\u7684\u6982\u7387\u5f80\u53f3\u5012,\u7b2c2\u68f5\u670950%\u7684\u6982\u7387\u5f80\u5de6\u5012,\u6240\u4ee5\u6982\u7387\u4e3a1\u00d70.5\u00d70.5=0.25\u3002\n\n### \u8bf4\u660e\n\n\u6d4b\u8bd5\u70b9#12\u662f\u4e00\u4e2a\u6709$10^{5}$\u68f5\u6811,1\u4e2a\u8611\u83c7\u7684\u5927\u6d4b\u8bd5\u70b9\u3002\n\n\u6ce8:\u6240\u6709\u53d8\u91cf\u548c\u6570\u7ec4\u5747\u4e0e\u539f\u9898\u89c4\u5b9a\u5f97\u4e00\u6837,\u6570\u636e\u8303\u56f4\u81ea\u884c\u770b\u539f\u9898\u3002\n\n# \u66b4\u529b\n\n\u679a\u4e3e\u6bcf\u68f5\u6811,\u8ba1\u7b97\u6bcf\u4e2a\u70b9\u4e0d\u88ab\u6467\u6bc1\u7684\u6982\u7387\u3002\n\n\u5bf9\u4e8e\u6bcf\u68f5\u6811,\u6211\u4eec\u5206\u522b\u5904\u7406\u5f80\u5de6\u5012\u548c\u5f80\u53f3\u5012,\u8fd9\u6837\u5c31\u62c6\u6210\u4e862\u4e2a\u533a\u95f4\u5206\u522b\u5904\u7406\u3002\n\n\u6982\u7387\u8ba1\u7b97\u65b9\u6cd5\u4e3a\u5728\u6240\u6709\u6811\u5012\u4e0b\u65f6,\u4e0d\u88ab\u6467\u6bc1\u7684\u6982\u7387\u79ef\u3002\u66b4\u529b\u628a\u6bcf\u4e2a\u70b9\u90fd\u00d7l[i]\u6216r[i],\u6700\u540e\u5c06sum\u52a0\u4e0a\u6240\u6709\u8611\u83c7\u6240\u5728\u7684\u70b9\u7684\u6982\u7387\u00d7\u6743\u503c\u3002\n\n\u5982\u679c\u5bf9\u8ba1\u7b97\u65b9\u6cd5\u6709\u7591\u95ee,\u53ef\u4ee5\u770b\u6837\u4f8b\u89e3\u91ca\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(sum{h[i]\u00d72}),-10^{9}<=h[i]<=10^{9},n<=10^{5}$,\u6240\u4ee5\u6700\u574f\u590d\u6742\u5ea6\u7ea6$2\u00d710^{14}$\u3002\n\n# \u4f18\u53161\n\n\u7531\u4e8e\u6211\u4eec\u662f\u533a\u95f4\u4fee\u6539,\u4fee\u6539\u5b8c\u4e4b\u540e\u5168\u90e8\u6c42,\u6240\u4ee5\u53ef\u4ee5\u5229\u7528\u524d\u7f00\u548c\u7684\u601d\u60f3\u3002(\u5f53\u7136\u8fd9\u91cc\u662f\u6c42\u79ef)\n\n\u8bbe\u4e00\u4e2as\u6570\u7ec4,\u5bf9\u4e8e\u5de6\u7aef\u70b9,\u6807\u8bb0\u00d7l[i],(\u53f3\u7aef\u70b9+1)\u6807\u8bb0\u4e3a\u00f7l[i],\u6700\u540e\u8dd1\u4e00\u8fb9\u524d\u7f00\u548c(\u5373```s[i]*=s[i-1]```)\u7136\u540e\u5c31\u53ef\u4ee5\u6c42\u51fa\u6bcf\u4e2a\u70b9\u7684\u6982\u7387,\u6700\u540e\u5728\u679a\u4e3e\u8611\u83c7\u6c42\u7b54\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(max{h[i]}-min{h[i]}),\u6700\u574f\u60c5\u51b5\u6709$2\\times 10^{9}$\u3002\n\n# \u4f18\u53162(\u6b63\u89e3)\n\n\u89c2\u5bdf\u4f18\u53161\u7684\u8fc7\u7a0b,\u6211\u4eec\u53d1\u73b0\u5f53h\u5dee\u522b\u5f88\u5927\u65f6,\u4e2d\u95f4\u6709\u4e00\u5806\u5143\u7d20\u7684\u503c\u65f6\u4e00\u6837\u7684,\u6240\u4ee5\u5bf9\u8fd9\u4e9b\u4e00\u6837\u7684\u5143\u7d20\u8fdb\u884c\u64cd\u4f5c,\u5b8c\u5168\u662f\u6d6a\u8d39\u65f6\u95f4\u548c\u7a7a\u95f4\u3002\u6211\u4eec\u600e\u4e48\u6837\u907f\u514d\u64cd\u4f5c\u91cd\u590d\u7684\u5143\u7d20\u5462?\n\n\u4ec0\u4e48\u5143\u7d20\u624d\u4f1a\u6709\u4e00\u6bb5\u91cd\u590d?\n\n\u5728\u4e24\u4e2a\u7aef\u70b9\u4e4b\u95f4,\u4e0d\u4f1a\u6709\u4efb\u4f55\u7684\u6807\u8bb0,\u8fd9\u4e24\u4e2a\u7aef\u70b9\u4e4b\u95f4\u7684\u503c\u80af\u5b9a\u662f\u4e00\u6837\u7684\u3002\n\n\u600e\u4e48\u529e?\n\n\u90a3\u6211\u4eec\u53ef\u4ee5\u5c06\u5de6\u7aef\u70b9\u53f3\u7aef\u70b9\u90fd\u653e\u5165\u4e00\u4e2a\u6570\u7ec4\u4e2d,\u6392\u4e00\u904d\u5e8f,\u7136\u540e\u7aef\u70b9\u4e2d\u95f4\u7684\u5c31\u53ef\u4ee5\u4e0d\u7ba1\u5b83\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(4n\\times log_{2}(4n)+2n+n+m)$ (\u52a0\u53f74\u8fb9\u5206\u522b\u4e3a\u6392\u5e8f,\u6807\u8bb0,\u524d\u7f00\u548c\u7684\u65f6\u95f4)\n\n\u4f46\u662f\u6b64\u65f6\u7a7a\u95f4\u590d\u6742\u5ea6\u8fd8\u662f\u6ca1\u6709\u4f18\u5316,\u6240\u4ee5\u5c31\u7b97\u4e0dtle,\u7a7a\u95f4\u4e5f\u4f1a\u8ba9\u4f60mle\u6216ce(\u4e0d\u80fd\u5f00\u90a3\u4e48\u5927\u7684\u6570\u7ec4)\u3002\n\n\u6211\u4eec\u4f18\u5316\u4e86\u65f6\u95f4,\u5c31\u6709\u4e2d\u95f4\u7684\u4e00\u5927\u6bb5\u7a7a\u95f4\u7a7a\u5728\u90a3\u91cc,\u6211\u4eec\u53ef\u4ee5\u7701\u53bb\u4e2d\u95f4\u7684\u7a7a\u95f4,\u53ef\u4ee5\u7406\u89e3\u4e3a\u628a\u6570\u7ec4\u4e0b\u6807\u91cd\u65b0\u7f16\u53f7,\u4f7f\u5176\u8df3\u8fc7\u4e2d\u95f4\u7a7a\u7740\u7684\u7a7a\u95f4,\u53ea\u7ba1\u7aef\u70b9\u3002\n\n\u6b64\u65f6\u6211\u4eec\u628a\u6570\u7ec4\u91cd\u65b0\u7f16\u53f7\u4e86,\u8611\u83c7\u5c31\u4e0d\u597d\u627e\u4e86,\u6240\u4ee5\u6211\u4eec\u8981\u628a\u8611\u83c7\u4e5f\u653e\u5165\u6570\u7ec4\u6392\u5e8f\u3002\n\n\u6709\u70b9\u7c7b\u4f3c\u4e8e\u79bb\u6563\u5316,\u4e0d\u540c\u7684\u662f\u4e0d\u7528\u628a\u6570\u7ec4\u91cc\u7684\u5143\u7d20\u91cd\u65b0\u6539,\u4ec5\u628as\u6570\u7ec4\u91cd\u65b0\u7f16\u53f7\u3002\n\n# \u7b97\u6cd5\u793a\u4f8b\n\n\u8bb2\u4e86\u8fd9\u4e48\u591a,\u611f\u89c9\u81ea\u5df1\u8bb2\u5f97\u4e0d\u597d,\u5927\u5bb6\u53ef\u80fd\u6ca1\u542c\u61c2,\u90a3\u5c31\u62ff\u4e00\u4e2a\u6570\u636e\u6765\u6f14\u793a\u4f18\u53162\u3002\n\n```\n2 1\n200 200 50 50\n400 200 50 50\n300 100\n```\n\n\u4e3a\u65b9\u4fbf,\u7528a~b\u8868\u793aa<=x<=b\n\n\u67094\u4e2a\u533a\u95f4:0~100,300~400,200~300,500~600\n\n\u5c06\u6240\u4ee5\u6570\u653e\u5165\u4e00\u4e2a\u6570\u7ec4\u6392\u5e8f\u3002\u6392\u5e8f\u5b8c\u7684\u7ed3\u679c:0,100,100,200,300,300,400,500,600\n\n\u7136\u540e\u653e\u5165s\u6570\u7ec4\u5e76\u8dd1\u524d\u7f00\u548c:\n|  |0|1|2|3|4|5|6|7|8|9|10|  |  |  |\n| -----------: | -----------: | -----------: | -----------: | -----------: | -----------: | -----------: | -----------: | -----------: | -----------: | -----------: | -----------: | -----------: | -----------: | -----------: |\n|\u6570\u7ec4\u91cc\u7684\u6570|0|100|100|200|300|300|400|500|600|  |  |  |  ||\n|\u6807\u8bb0|\u00d70.5||\u00f70.5|\u00d70.5|\u00d70.5||\u00f70.5|\u00f70.5\u00d70.5||\u00f70.5||  |  |  |\n\n## \u7ec6\u8282\n\u8bb2\u89e3\u4e00\u4e9b\u6211wa\u8fc7\u7684\u70b9\u4e3a\u4ec0\u4e48WA\u3002\n\n\\#3:\u5fc5\u987b\u7528(1-\u8f93\u5165\u00f7100)\u624d\u662f\u4e0d\u88ab\u6467\u6bc1\u7684\u6982\u7387\u3002\n\n\\#5:\u7279\u5224\u9664\u6570\u4e3a0\u7684\u60c5\u51b5\u3002\n\n\\#6:\u6392\u5e8f\u6570\u503c\u4e00\u6837\u65f6\u7684\u987a\u5e8f\u95ee\u9898,\u5728\u4ee3\u7801\u91cc\u8bb2\u89e3\u3002\n\n\\#9:\u7b2c\u4e00\u4e2a\u662f\u8611\u83c7\u65f6\u6ca1\u6709\u8ba1\u7b97\u3002\n\n\\#12:\n\n\u7cbe\u5ea6\u95ee\u9898\u3002double\u53ea\u80fd\u5b58\u5c0f\u6570300\u591a\u4f4d\u3002\u6240\u4ee5\u5982\u679c\u6709\u6570\u636e\u8ba9\u4f60\u524d\u9762\u4e00\u76f4\u00f7,\u5c31\u4f1a\u7206\u7cbe\u5ea6\u3002\u63d0\u4f9b\u4e00\u4e2a\u6570\u636e\u8ba9\u4f60\u7206\u7cbe\u5ea6\u3002(\u592a\u5927\u4e86,\u7528c++\u7a0b\u5e8f\u751f\u6210,\u5728iakioi.in\u4e2d\u6253\u5f00)\n\n```cpp\n#include<iostream>\nusing namespace std;\nint main(){\n\tfreopen(\"iakioi.in\",\"w\",stdout);\n\tint i;\n\tcout<<\"100000 1\"<<endl;\n\tfor(i=0;i<100000;i++){\n\t\tcout<<0<<\" \"<<i<<\" \"<<100<<\" \"<<0<<endl;\n\t}\n\tcout<<\"0 1\";\n\treturn 0;\n}\n```\n\u6240\u4ee5\u8981\u6ea2\u51fa\u65f6\u00d7\u4e00\u4e2a\u6570,\u8ba9\u5b83\u6062\u590d\u6210\u63a5\u8fd11\u3002\u5f53\u7136\u8981\u8bb0\u5f55\u6ea2\u51fa\u4e86\u51e0\u6b21\u3002\u56e0\u4e3a\u5728\u5411\u4e0a\u00f7\u7684\u65f6\u5019\u53ef\u80fd\u4f1a\u5411\u4e0a\u6ea2\u51fa,\u6240\u4ee5\u8fd9\u65f6\u628a\u6ea2\u51fa\u7684\u6b21\u6570-1(\u76f8\u5f53\u4e8e\u53cd\u6ea2\u51fa\u4e00\u6b21)\u3002\u8bbe\u8fd9\u4e2a\u6570\u662fc,eps=$10^{-250}$\u6700\u540e\u7b54\u6848\u5c31\u662f$ans \\times eps^c$\n\n\\#12:\n\n\u4f46\u662ftle\u4e86,\u6240\u4ee5\u8981\u5361\u5e38,\u5c31\u628acin\u6539\u4e3ascanf\u5c31AC\u4e86\u3002\n\n# \u4ee3\u7801\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<cmath>\nusing namespace std;\nlong long a[1000005],h[1000005];\ndouble l[1000005],r[1000005];\nlong long b[1000005],w[1000005];\nstruct xyq{ //\u6ce8:id\u597d\u50cf\u6ca1\u7528,\u61d2\u5f97\u5220\u4e86\u3002\n\tlong long a,id,left; //left\u8868\u793a\u662f\u54ea\u4e00\u79cd1\u5de6\u7aef\u70b93\u53f3\u7aef\u70b92\u8611\u83c7\u3002\u8fd9\u4e48\u7f16\u53f7\u7684\u539f\u56e0\u662f\u6392\u5e8f\u65f6\u6570\u503c\u4e00\u6837\u6309left\u7684\u7f16\u53f7\u6392\u5e8f,\u51481\u518d2\u540e3,\u4e3a\u4ec0\u4e48\u8981\u600e\u4e48\u505a,\u5efa\u8bae\u81ea\u5df1\u6253\u4e00\u4e0b\u8349\u7a3f\u6a21\u62df\u4e00\u4e0b\u5c31\u77e5\u9053\u4e86\u3002\u6211\u4e5f\u89e3\u91ca\u4e0d\u6e05\u3002\n\tdouble ykb; //ykb\u8868\u793a\u6982\u7387(left=1,3)\u6216\u6743\u503c(left=2)\n}_[1000005];\nstruct rule{\n\tbool operator()(const xyq &s1,const xyq &s2){\n\t\treturn s1.a<s2.a||(s1.a==s2.a&&s1.left<s2.left);\n\t}\n};\ndouble s[1000005];\n#define eps 0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001 //\u5927\u7ea6\u6709250\u4f4d\u5c0f\u6570,double\u6700\u591a\u53ef\u4ee5\u5b58300\u591a\u4f4d\u3002\nint main(){\n\tlong long n,m,i,N,tot=0,kkksc03=0;\n\tdouble sum=0;\n\tcin>>n>>m;\n\tfor(i=0;i<n;i++){\n\t\tscanf(\"%lld %lld %lf %lf\",a+i,h+i,l+i,r+i);\n\t\t_[i<<2].a=a[i]-h[i];\n\t\t_[i<<2].id=(i<<1);\n\t\t_[i<<2].left=1; \n\t\t_[i<<2].ykb=1.0-l[i]/100.0;\n\t\t_[i<<2|1].a=a[i]-1;\n\t\t_[i<<2|1].id=(i<<1);\n\t\t_[i<<2|1].left=3;\n\t\t_[i<<2|1].ykb=1.0-l[i]/100.0;\n\t\t_[i<<2|2].a=a[i]+1;\n\t\t_[i<<2|2].id=(i<<1|1);\n\t\t_[i<<2|2].left=1;\n\t\t_[i<<2|2].ykb=1.0-r[i]/100.0;\n\t\t_[i<<2|3].a=a[i]+h[i];\n\t\t_[i<<2|3].id=(i<<1|1);\n\t\t_[i<<2|3].left=3;\n\t\t_[i<<2|3].ykb=1.0-r[i]/100.0;\n\t}\n\tfor(i=0;i<m;i++){\n\t\tscanf(\"%lld %lld\",b+i,w+i);\n\t\t_[(n<<2)+i].a=b[i];\n\t\t_[(n<<2)+i].id=i;\n\t\t_[(n<<2)+i].left=2;\n\t\t_[(n<<2)+i].ykb=w[i];\n\t}\n\tN=(n<<2)+m; //\u66f4\u65b0\u6570\u7ec4\u5927\u5c0f\u3002\u8fd9\u6837\u4e0d\u8981\u6ca1\u7528\u4e00\u6b21\u90fd\u8981\u8ba1\u7b97\u3002\n\tsort(_,_+N,rule());\n\tfor(i=0;i<N;i++){\n\t\ts[i]=1; //\u521d\u59cb\u503c\u662f\u4ec0\u4e48\u90fd\u4e0d\u505a\u3002\u4e00\u5b9a\u662f1,\u56e0\u4e3a\u00d71\u624d\u7b49\u4e8e\u539f\u6765\u7684\u6570\u3002\n\t}\n\tfor(i=0;i<N;i++){\n\t\tif(_[i].ykb==0){\n\t\t\t_[i].ykb=0.00001; //\u8bef\u5dee\u57280.0001\u4e4b\u5185\u3002\u8fd9\u6837\u907f\u514d\u9664\u6570\u4e3a0\u3002\n\t\t}\n\t\tif(_[i].left==1){\n\t\t\ts[i]*=_[i].ykb;\n\t\t}\n\t\tif(_[i].left==3){\n\t\t\ts[i+1]/=_[i].ykb;\n\t\t}\n\t}\n\tfor(i=1;i<N;i++){\n\t\ts[i]*=s[i-1];\n\t\tif(s[i]<eps){\n\t\t\ts[i]*=(1.0/eps); //\u6062\u590d\u62101\u5de6\u53f3\u3002\n\t\t\tkkksc03++;\n\t\t}\n\t\tif(s[i]>(1.0/eps)){\n\t\t\ts[i]*=eps; //\u53cd\u6062\u590d\u3002\n\t\t\tkkksc03--;\n\t\t}\n\t\tif(_[i].left==2){\n\t\t\tsum+=_[i].ykb*s[i]*pow(eps,kkksc03);\n\t\t}\n\t}\n\tprintf(\"%.10f\",sum+_[0].ykb*s[0]*(_[0].left==2));  //\u8ba1\u7b97\u7b2c1\u4e2a\u8611\u83c7,\u56e0\u4e3a\u6211\u6570\u7ec4\u4e0b\u6807\u559c\u6b22\u4ece0\u5f00\u59cb,\u7b2c1\u4e2a\u6ca1\u6709\u5faa\u73af\u5230\u3002\n\treturn 0;\n}\n```",
        "postTime": 1596285221,
        "uid": 87799,
        "name": "xh39",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF138C \u3010Mushroom Gnomes - 2\u3011"
    },
    {
        "content": "[\u9898\u9762](https://www.luogu.com.cn/problem/CF138C)\n\n~~\u8c03\u4e86\u5f88\u4e45\u53d1\u73b0\u662f\u611a\u8822\u7684\u9519\u8bef\uff0c\u9ebb\u4e86\u3002~~\n\n\u4ef7\u503c\u603b\u548c\u671f\u671b\uff0c\u8003\u8651\u6bcf\u4e00\u4e2a\u8611\u83c7\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u3002\n\n\u5355\u4e00\u8611\u83c7\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e3a\n$$\nz_i\\prod(1-p_j)\n$$\n\u5176\u4e2d $p_j$ \u8868\u793a\u80fd\u7838\u5230\u8be5\u8611\u83c7\u7684\u6811\u7684\u5012\u4e0b\u6982\u7387\u3002\n\n\u53ef\u4ee5\u5c06\u8611\u83c7\u7684\u4f4d\u7f6e\u79bb\u6563\u5316\u540e\uff0c\u7528\u6570\u636e\u7ed3\u6784\u8fdb\u884c\u533a\u95f4\u4e58 $1-p_j$\uff0c\u5728\u7edf\u8ba1\u8611\u83c7\u4ef7\u503c\u65f6\u4f7f\u7528\u5355\u70b9\u67e5\u8be2\u3002\n\n\u53ef\u4ee5\u7528\u7ebf\u6bb5\u6811\u3002\n\n\u4f46\u6811\u72b6\u6570\u7ec4\u5176\u5b9e\u4e5f\u53ef\u4ee5\uff0c\u6211\u7684\u8001\u5e08\u63d0\u4f9b\u4e86\u4e00\u4e2a\u65b9\u6848\uff0c\u8003\u8651\u5c06\u6982\u7387\u6362\u7b97\u4e3a\u81ea\u7136\u5bf9\u6570\u503c\uff0c\u8fd9\u6837\u533a\u95f4\u4e58\u6cd5\u5c31\u53d8\u6210\u52a0\u6cd5\u4e86\uff0c\u4e0d\u6015\u7cbe\u5ea6\u95ee\u9898\u3002\u6982\u7387\u4e3a $0$ \u65f6\u7279\u5224\u4e00\u4e0b\uff0c\u628a\u533a\u95f4\u6807\u8bb0\u4e3a\u975e\u6cd5\u3002\u5f88\u5999\u3002\n\nCode:\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\nusing namespace std;\n\nconst int maxn=1e5+5;\nint n,m,p;\nll vec[maxn*6],cnt,val[maxn*6];\nll a[maxn],b[maxn],l[maxn],r[maxn],h[maxn],z[maxn];\nlong double C[maxn*6];ll A[maxn*6];\n\nvoid add(int x,int k){\n\twhile(x<=p){\n\t\tA[x]+=k;\n\t\tx+=-x&x;\n\t}\n}\nvoid update(int x,long double k){\n\twhile(x<=p){\n\t\tC[x]+=k;\n\t\tx+=x&-x;\n\t}\n}\nlong double query(int x){\n\tlong double ret=0.0;\n\twhile(x){\n\t\tret+=C[x];\n\t\tx-=x&-x;\n\t}\n\treturn ret;\n}\nbool check(int x){\n\tll ret=0;\n\twhile(x){\n\t\tret+=A[x];\n\t\tx-=x&-x;\n\t}\n\treturn ret>0;\n}\n\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%lld%lld%lld%lld\",&a[i],&h[i],&l[i],&r[i]);\n\t\tvec[++cnt]=a[i]-h[i];\n\t\tvec[++cnt]=a[i];\n\t\tvec[++cnt]=a[i]+h[i];\n\t}\n\tfor(int i=1;i<=m;i++){\n\t\tscanf(\"%lld%lld\",&b[i],&z[i]);\n\t\tvec[++cnt]=b[i];\n\t}\n\tfor(int i=1;i<=cnt;i++){\n\t\tval[i]=vec[i];\n\t}\n\tsort(val+1,val+cnt+1);\n\tp=unique(val+1,val+cnt+1)-val-1;\n\tfor(int i=1;i<=n;i++){\n\t\tint L=lower_bound(val+1,val+p+1,a[i]-h[i])-val;\n\t\tint mid=lower_bound(val+1,val+p+1,a[i])-val;\n\t\tint R=lower_bound(val+1,val+p+1,a[i]+h[i])-val;\n\t\tif(!l[i]);\n\t\telse if(100-l[i]) update(L,log(1.00-l[i]/100.0)),update(mid,-log(1.00-l[i]/100.0));\n\t\telse add(L,1LL),add(mid,-1LL);\n\t\tif(!r[i]);\n\t\telse if(100-r[i]) update(mid+1,log(1.00-r[i]/100.0)),update(R+1,-log(1.00-r[i]/100.0));\n\t\telse add(mid+1,1LL),add(R+1,-1LL);\n\t}\n\tlong double ans=0.0;\n\tfor(int i=1;i<=m;i++){\n\t\tint x=lower_bound(val+1,val+p+1,b[i])-val;\n\t\tif(check(x)||!z[i]) continue;\n\t\tans+=exp(query(x))*z[i];\n\t}\n\tcout<<fixed<<setprecision(10)<<ans<<endl;\n}\n```\n\n",
        "postTime": 1640432078,
        "uid": 134623,
        "name": "HyperSQ",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF138C Mushroom Gnomes - 2"
    },
    {
        "content": "## CF138C Mushroom Gnomes - 2\n\n\u5148\u5410\u69fd\u4e24\u53e5\uff0c\u7ffb\u8bd1\u6709\u8bef\uff0c\u4e0d\u5e94\u8be5\u662f\u95ed\u533a\u95f4\uff0c\u800c\u662f\u534a\u5f00\u533a\u95f4\n\n\u5176\u5b9e\u672c\u9898\u53ef\u4ee5\u4e0d\u7528\u7ebf\u6bb5\u6811\uff0c\u8fd9\u91cc\u7ed9\u4e00\u4e2a\u53ea\u7528\u4f18\u5148\u961f\u5217(\u5806)\u7684\u505a\u6cd5\n\n\u7531\u4e8e\u662f\u8ba1\u7b97\u671f\u671b\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5bf9\u6bcf\u4e2a\u8611\u83c7\u5206\u522b\u7b97\u671f\u671b\u518d\u6c42\u548c\n\n\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e2a\u8611\u83c7\u5206\u522b\u8003\u8651\u6c42\u51fa\u5de6\u53f3\u8fb9\u7684\u6811\u5747\u4e0d\u7838\u4e2d\u5b83\u7684\u6982\u7387\n\n\u5148\u8003\u8651\u5de6\u8fb9\u7684\u6811\n\n\u8fd9\u65f6\u5c31\u5148\u5c06\u8611\u83c7\u548c\u6811\u6309x\u8f74\u6392\u5e8f\uff0c\u6bcf\u6b21\u5c06\u4e00\u4e2a\u8611\u83c7\u524d\u7684\u6811\u4e0d\u5012\u5411\u53f3(\u7acb\u7740\u6216\u5411\u5de6)\u7684\u6982\u7387\u4e58\u8d77\u6765\uff0c\u518d\u7528\u4f18\u5148\u961f\u5217\u6309\u6811\u5411\u53f3\u5012\u7684\u53f3\u7aef\u70b9\u6392\u5e8f\uff0c\u6bcf\u6b21\u5c06\u4e0d\u53ef\u80fd\u7838\u4e2d\u8611\u83c7\u7684\u6811\u9664\u53bb\uff0c\u7c7b\u4f3c\u4e8e$\\tt two-point$.\u53f3\u8fb9\u7684\u60c5\u51b5\u4e00\u6837\n\n\u5982\u679c\u76f4\u63a5\u4e58\u548c\u9664\u94c1\u5b9a\u51fa\u95ee\u9898\uff0c\u54ea\u6015\u8003\u8651\u4e860\u7684\u60c5\u51b5\uff0c\u5982\u679c\u4e00\u76f4$*1\\%*1\\%...$ \u518d$\\div1\\%\\div1\\%...$,\u8fd9\u6837\u7cbe\u5ea6\u5c31\u7206\u4e86(WA\u5728test21)\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u76f4\u63a5\u5c06\u6bcf\u4e2a\u8981\u4e58\u7684\u6570\u5b58\u4e0b\uff0c\u5728\u6570\u7ec4\u5185\u52a0\u52a0\u51cf\u51cf\u5373\u53ef\uff0c\u8981\u6c42\u503c\u5f97\u65f6\u5019\u518d\u73b0\u7b97\u5373\u53ef\n\n\u7531\u4e8e\u6982\u7387\u4e3a\u767e\u5206\u6570\uff0c\u6240\u4ee5\u4e0d\u4f1a\u8d85\u8fc7101\u79cd\u60c5\u51b5\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(100m\\log n+n\\log n)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6$O(n+m)$\uff0c765ms,\u6700\u6162\u7684\u4e00\u7ec493ms\u76ee\u524d\u5168\u6d1b\u8c37rk1(\u6211\u4e5f\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u8dd1\u8fd9\u4e48\u5feb\uff0c\u662f\u56e0\u4e3a\u4f18\u5148\u961f\u5217\u5e38\u6570\u5c0f\uff1f)\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n# define ll long long\n# define read read1<ll>()\n# define Type template<typename T>\nType T read1(){\n\tT t=0;\n\tchar k;\n\tbool vis=0;\n\tdo (k=getchar())=='-'&&(vis=1);while('0'>k||k>'9');\n\twhile('0'<=k&&k<='9')t=(t<<3)+(t<<1)+(k^'0'),k=getchar();\n\treturn vis?-t:t;\n}\n# define fre(k) freopen(k\".in\",\"r\",stdin);freopen(k\".out\",\"w\",stdout)\ndouble a[100005];\nint s,m;\npair<int,int>w[100005];\npriority_queue<pair<int,int> >q;\nstruct A{int x,h;double l,r;bool operator <(const A &b)const{return x<b.x;};}x[100005];\nint T;\nmap<double,int>ma;\nvoid mul(double v){++ma[v];}\nvoid div(double v){--ma[v];}\ndouble qkpow(double n,int m){\n\tdouble w=1;\n\tfor(;m;m>>=1,n*=n)\n\t\tif(m&1)w*=n;\n\treturn w;\n}\nint main(){\n\ts=read;m=read;\n\tfor(int i=1;i<=s;++i)x[i].x=read,x[i].h=read,x[i].l=read/100.0,x[i].r=read/100.0;\n\tfor(int i=1;i<=m;++i)a[i]=1,w[i].first=read,w[i].second=read;\n\tsort(x+1,x+s+1);sort(w+1,w+m+1);\n\tdouble t=1;\n\tfor(int i=1,j=1;i<=m;++i){\n\t\twhile(j<=s&&x[j].x<w[i].first)mul(1-x[j].r),q.push(make_pair(-x[j].x-x[j].h,j)),++j;\n\t\twhile(q.size()&&-q.top().first<w[i].first)div(1-x[q.top().second].r),q.pop();\n\t\tif(ma[0])a[i]=0;\n\t\telse for(auto v:ma)a[i]*=qkpow(v.first,v.second);\n\t}while(q.size())q.pop();ma.clear();\n\tfor(int i=m,j=s;i;--i){\n\t\twhile(j&&x[j].x>w[i].first)mul(1-x[j].l),q.push(make_pair(x[j].x-x[j].h,j)),--j;\n\t\twhile(q.size()&&q.top().first>w[i].first)div(1-x[q.top().second].l),q.pop();\n\t\tif(a[i]==0||ma[0])a[i]=0;\n\t\telse for(auto v:ma)a[i]*=qkpow(v.first,v.second);\n\t}double ans=0;\n\tfor(int i=1;i<=m;++i)ans+=a[i]*w[i].second;\n\tprintf(\"%.5f\",ans);\n\treturn 0;\n}\n\n```",
        "postTime": 1621434151,
        "uid": 108067,
        "name": "\u4e1b\u96e8",
        "ccfLevel": 0,
        "title": "CF138C Mushroom Gnomes - 2"
    }
]
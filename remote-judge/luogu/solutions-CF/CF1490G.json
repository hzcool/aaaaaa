[
    {
        "content": "\u9898\u76ee\u7528\u8717\u725b\u722c\u4e95\u89e3\u91ca\u66f4\u597d\u7406\u89e3\u4e00\u70b9\u3002\n\n---\n\n### \u9898\u76ee\u5927\u610f\n\n\u6709\u4e00\u53ea\u8717\u725b\u5728\u4ece\u4e00\u4e2a\u4e95\u91cc\u5f80\u4e0a\u722c\u3002\u521d\u59cb\u65f6\u5b83\u6240\u5728\u9ad8\u5ea6\u4e3a $0$\u3002\n\n\u4ed6\u6309\u7167\u5e8f\u5217 $a$ \u4e0d\u505c\u7684\u722c\u7740\uff08\u5e8f\u5217 $a$ \u957f\u5ea6\u4e3a $n$\uff09\uff0c\u6bcf\u6b21\u722c\u7684\u65f6\u5019\uff0c\u4ed6\u6240\u5728\u9ad8\u5ea6\u90fd $+a_i$\uff08$a_i$ \u53ef\u80fd\u4e3a\u8d1f\uff09\u3002\u722c\u5b8c $n$ \u6b21\u4e4b\u540e\u53c8\u4ece $a_1$ \u7ee7\u7eed\u722c\u3002\n\n\u6709 $m$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u95ee\u8717\u725b\u722c\u5230\u9ad8\u5ea6 $x$ \u6700\u5c11\u9700\u8981\u722c\u591a\u5c11\u6b21\uff0c\u5982\u679c\u8717\u725b\u4f1a\u4e00\u76f4\u722c\u4e0b\u53bb\u4e0d\u505c\u4e0b\uff0c\u8f93\u51fa `-1`\u3002\n\n---\n\n### \u9898\u89e3\n\n\u8003\u8651\u628a\u8717\u725b\u5728\u4e00\u6b21\u5faa\u73af\u5185\u80fd\u5230\u8fbe\u7684\u6b63\u6570\u6240\u9700\u7684\u6700\u77ed\u65f6\u95f4\u6254\u8fdb\u4e00\u4e2a `map` \u5185\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u6211\u4eec\u60f3\u77e5\u9053\u8717\u725b\u5728\u4e00\u6b21\u5faa\u73af\u4e2d\u5230\u8fbe $x$ \u6700\u5c11\u9700\u8981\u722c\u591a\u5c11\u6b21\uff0c\u53ea\u9700\u5728\u8fd9\u4e2a `map` \u4e0a `lower_bound` \u4e00\u4e0b $x$ \u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u7136\u540e\u663e\u7136\u8fd8\u9700\u8981\u5b58\u4e00\u6b21\u5faa\u73af\u603b\u5171\u8717\u725b\u4f1a\u79fb\u52a8\u591a\u5c11\uff0c\u8bb0\u4e3a $k$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\uff0c\u5148\u5728 `map` \u4e2d\u627e\u4e00\u4e0b\u7b2c\u4e00\u8f6e\u80fd\u4e0d\u80fd\u5230\u3002\n\n\u80fd\u5c31\u76f4\u63a5\u8f93\u51fa\uff0c\u4e0d\u80fd\u7684\u8bdd\u5206\u4e24\u79cd\u60c5\u51b5\uff1a\n\n1. \u5982\u679c $k\\le0$\uff0c\u90a3\u4e48\u8717\u725b\u4e00\u5b9a\u4f1a\u6c38\u65e0\u505c\u606f\u5730\u722c\uff0c\u8f93\u51fa `-1`\u3002\n\n1. \u5982\u679c $k>0$\uff0c\u6211\u4eec\u53ef\u4ee5\u627e\u5230\u4e00\u4e2a\u5faa\u73af\u7684\u6b21\u6570 $w$ \u4f7f\u5f97 `map` \u4e2d\u6700\u9ad8\u7684 `key` $+w\\times k\\ge x$ \u3002\u8fd9\u4e2a\u65f6\u5019\u5c31\u662f $x$ \u7b2c\u4e00\u6b21\u88ab\u8fbe\u5230\u7684\u65f6\u5019\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\n#define rep(i,a,b) for(int i=(a);i<=(b);++i)\n#define per(i,a,b) for(int i=(a);i>=(b);--i)\nusing namespace std;\nint _,n,m;\nint a[200005];\nmap<int,int> tim;\nsigned main() {\n    for(scanf(\"%lld\",&_);_;--_) {\n        tim.clear();\n        scanf(\"%lld%lld\",&n,&m);\n        int row=0,mx=0,mxid=0;\n        rep(i,1,n) {\n            scanf(\"%lld\",&a[i]);\n            row+=a[i];\n            if(row>mx) mx=row,mxid=i,tim[mx]=i;\n        }\n        rep(i,1,m) {\n            int x;\n            scanf(\"%lld\",&x);\n            map<int,int>::iterator ii=tim.lower_bound(x);\n            if(ii==tim.end()&&row<=0) {printf(\"-1 \");continue;}\n            else if(ii==tim.end()){\n                map<int,int>::iterator lst=tim.end();--lst;\n                int ned=(x-lst->first+row-1)/row;\n                ii=tim.lower_bound(x-ned*row);\n                printf(\"%lld \",ii->second+ned*n-1);\n            } else {\n                printf(\"%lld \",ii->second-1);\n            }\n        }\n        puts(\"\");\n    }\n    return 0;\n}\n```",
        "postTime": 1613561346,
        "uid": 76156,
        "name": "henrytb",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1490G \u3010Old Floppy Drive\u3011"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF1490G)\n## \u601d\u8def\n\u611f\u89c9\u5176\u5b83\u9898\u89e3\u8bb2\u7684\u6bd4\u8f83\u590d\u6742\uff0c\u6211\u8fd9\u91cc\u7b80\u5355\u5730\u8bb2\u4e00\u4e0b\u3002\n\n\u9996\u5148\u6211\u4eec\u80af\u5b9a\u8981\u6c42\u4e00\u4e2a\u524d\u7f00\u548c\uff0c\u56e0\u4e3a\u95ee\u9898\u4e2d\u6709\u524d\u7f00\u548c\uff0c\u5e76\u4e14\u6211\u4eec\u8981\u5bf9\u8fd9\u4e2a\u524d\u7f00\u548c\u6570\u7ec4\u6c42\u4e00\u4e2a\u524d\u7f00 $\\max$\uff0c\u56e0\u4e3a\u53ef\u4ee5\u53d1\u73b0\uff0c\u82e5 $sum_i<sum_{i-1}$\uff0c\u8fd9\u4e2a $sum_i$ \u662f\u6ca1\u7528\u7684\uff0c\u56e0\u4e3a\u5728\u6211\u4eec\u67e5\u627e\u7684\u65f6\u5019\u4e00\u5b9a\u627e\u5230 $i-1$\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u59a8\u628a $sum_i$ \u8986\u76d6\u6389\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u5c31\u76f4\u63a5\u5728\u524d\u7f00\u548c\u6570\u7ec4\u4e0a\u4e8c\u5206\uff0c\u5148\u8ba9 $x$ \u5bf9\u539f\u5e8f\u5217\u7684\u603b\u548c\u53d6\u4f59\uff0c\u4f46\u662f\u8fd9\u91cc\u6709\u4e00\u4e2a\u5751\u70b9\uff0c\u4e0d\u4e00\u5b9a\u4e00\u5b9a\u8981\u5faa\u73af $x/sum_{a_i}$ \u6b21\uff0c\u6709\u53ef\u80fd\u4e2d\u9014\u5c31\u9000\u51fa\u4e86\u3002\n## \u4ee3\u7801\n```cpp\n//A tree without skin will surely die. \n//A man without face is invincible.\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define rint register int\nint const N=2e5+10;\nint a[N],qsum[N];\nsigned main(){\n    ios::sync_with_stdio(false);\n    cin.tie(0),cout.tie(0);\n    int T;cin>>T;\n    while (T--){\n    \tint n,m,sum=0;cin>>n>>m;\n    \tfor (int i=1;i<=n;++i){\n    \t\tcin>>a[i],sum+=a[i];\n\t    \tqsum[i]=qsum[i-1]+a[i];\n\t    }\n\t    for (int i=2;i<=n;++i) qsum[i]=max(qsum[i],qsum[i-1]);\n\t    while (m--){\n\t    \tint x;cin>>x;\n            if (qsum[n]>=x){\n\t    \t\tcout<<lower_bound(qsum+1,qsum+n+1,x)-qsum-1<<' ';\n\t\t\t}else if (sum<=0) cout<<\"-1 \";\n            else{\n\t\t\t\tint xun=x/sum;\n\t\t\t\txun*=n;--xun;\n\t\t\t\tx%=sum;\n                if (xun<0) cout<<\"-1 \";\n                else if (!x){\n                    int delta=qsum[n]-x;\n                    delta/=sum;\n                    xun-=(delta*n);\n                    x+=(delta*sum);\n                    cout<<lower_bound(qsum+1,qsum+n+1,x)-qsum+xun<<' ';\n                    //cout<<xun-n+lower_bound(qsum+1,qsum+n+1,sum)-qsum<<' ';\n\t\t\t\t}else if (qsum[n]<x) cout<<\"-1 \";\n\t\t\t    else{\n                    int delta=qsum[n]-x;\n                    delta/=sum;\n                    xun-=(delta*n);\n                    x+=(delta*sum);\n                    cout<<lower_bound(qsum+1,qsum+n+1,x)-qsum+xun<<' ';\n                }\n            }\n\t\t}\n        cout<<'\\n';\n\t}\n    return 0;\n}\n```\n",
        "postTime": 1661992368,
        "uid": 253608,
        "name": "Tx_Lcy",
        "ccfLevel": 7,
        "title": "CF1490G Old Floppy Drive"
    },
    {
        "content": "### \u9898\u76ee\u5927\u610f\n\n\u6709\u4e00\u4e2a\u957f\u4e3a $n$ \u7684\u6570\u7ec4 $a_i$\uff0c\u628a $a_i$ \u590d\u5236\u6210\u4e00\u4e2a\u65e0\u9650\u5e8f\u5217\u3002\n\n\u7ed9 $m$ \u4e2a\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u7ed9\u5b9a\u4e00\u4e2a\u6574\u6570 $x$ \uff0c\u95ee\u8fd9\u4e2a\u5e8f\u5217\u7b2c\u4e00\u4e2a\u524d\u7f00\u548c $ \\geq x$ \u7684\u4e0b\u6807\u662f\u4ec0\u4e48\u3002\n\n$ 1 \\leq n, m \\leq 2 \\times 10 ^ 5, -10^9 \\leq a_i \\leq 10^9, 1 \\leq x \\leq 10 ^ 9$\n\n### \u9898\u76ee\u5206\u6790\n\n\u9996\u5148\u5148\u5224\u65ad\u4e00\u4e0b\u6709\u6ca1\u53ef\u80fd\u5728\u4e00\u6b21\u5faa\u73af\u4e4b\u5185\u7ed3\u675f\uff0c\u8fd9\u53ef\u4ee5\u7528\u4e00\u6b21\u53cc\u6307\u9488\u89e3\u51b3\u3002\n\n\u63a5\u4e0b\u6765\u5bf9\u4e8e\u8fd8\u6ca1\u6709\u6c42\u51fa\u7b54\u6848\u7684 $x$ \uff0c\u5982\u679c\u5168\u90e8 $n$ \u4e2a\u6570\u7684\u548c $s_n \\leq 0$ \uff0c\u5219\u663e\u7136\u4e0d\u53ef\u80fd\u4f7f\u524d\u7f00\u548c\u8fbe\u5230 $x$\u3002\n\n\u5426\u5219\u6211\u4eec\u5c06 $x$ \u53cd\u590d\u51cf\u53bb $s_n$ \u4f7f\u5f97 $x' \\leq \\max s_i$ \uff0c\u4e4b\u540e\u5c31\u53ef\u4ee5\u901a\u8fc7\u4e00\u6b21\u4e8c\u5206\u6c42\u51fa\u7b2c\u4e00\u4e2a\u524d\u7f00\u548c $ \\geq x'$ \u7684\u4e0b\u6807\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $ \\Theta((n + m) \\log n)$ \u3002\n\n### \u4ee3\u7801\n\n``` cpp\n#include <bits/stdc++.h>\n\n#define R register\n#define ll long long\n#define pair std::pair<ll, ll>\n#define mp(i, j) std::make_pair(i, j)\n#define sum(a, b, mod) (((a) + (b)) % mod)\n#define meow(cat...) fprintf(stderr, cat)\n\nconst ll MaxN = 2e5 + 10;\n\npair q[MaxN];\nstd::map<ll, ll> mp;\nstd::vector<pair> v;\nll n, m, now, a[MaxN], s[MaxN], ans[MaxN];\n\nvoid init()\n{\n    v.clear(), mp.clear(), now = 0;\n    for(ll i = 0; i < m + 10; i++)\n        ans[i] = -1;\n    for(ll i = 0; i < n + 10; i++)\n        a[i] = s[i] = 0;\n}\n\ninline ll read()\n{\n    ll x = 0, f = 1;\n    char ch = getchar();\n    while(ch > '9' || ch < '0')\n    {\n        if(ch == '-')\n            f = 0;\n        ch = getchar();\n    }\n    while(ch <= '9' && ch >= '0') \n        x = (x << 1) + (x << 3) + (ch ^ 48), ch = getchar();\n    return f ? x : (-x);\n}\n\nsigned main()\n{   \n    ll T = read();\n    while(T--)\n    {\n        n = read(), m = read(), init();\n        for(ll i = 1; i <= n; i++)\n        {\n            a[i] = read(), s[i] = a[i] + s[i - 1];\n            if(s[i] > 0 && !mp[s[i]]) \n                mp[s[i]] = i, v.push_back(mp(s[i], i));\n        }\n        for(ll i = 1; i <= m; i++)\n            q[i].first = read(), q[i].second = i;\n        std::sort(q + 1, q + m + 1), std::sort(v.begin(), v.end());\n        if(v.size() >= 2)\n        {\n            for(ll i = v.size() - 2; i >= 0; i--)\n            {\n                ll x = mp[v[i].first];\n                x = std::min(x, mp.upper_bound(v[i].first)->second);\n                mp[v[i].first] = x, v[i].second = x;\n            }\n        }\n        // for(auto x : mp)\n        //     meow(\"# %lld %lld\\n\", x.first, x.second);\n        for(ll i = 0; i < v.size(); i++)\n        {\n            while(now < m && q[now + 1].first <= v[i].first)\n                ++now, ans[q[now].second] = v[i].second - 1;\n        }\n        // meow(\"ok\");\n        for(ll i = now + 1; i <= m; i++)\n        {\n            if(s[n] <= 0) continue;\n            ans[q[i].second] = n * ((q[i].first - v.back().first + s[n] - 1) / s[n]);\n            q[i].first -= s[n] *((q[i].first - v.back().first + s[n] - 1) / s[n]), \n            ans[q[i].second] += mp.lower_bound(q[i].first)->second - 1;\n            // meow(\"$ %lld %lld %lld\\n\", ans[q[i].second], q[i].first, s[n]);\n        }\n        for(ll i = 1; i <= m; i++)\n            printf(\"%lld%c\", ans[i], \" \\n\"[i == m]);\n    }\n    return 0;\n}\n```\n\n",
        "postTime": 1632581447,
        "uid": 61966,
        "name": "little_sun",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1490G Old Floppy Drive"
    },
    {
        "content": "\u6302\u4e00\u4e0b [My Blog](https://imyangty.com/oi/1309)\n## \u9898\u610f\n\u6709\u4e00\u4e2a\u5149\u76d8\u4e0a\u9762\u4f9d\u6b21\u8bb0\u5f55\u4e86\u4e00\u4e9b\u6570\uff0c\u6709\u4e00\u4e2a\u9a71\u52a8\u5668\u6309\u7167\u5982\u4e0b\u7b97\u6cd5\u8fd0\u884c\uff1a\n\n- \u63a5\u53d7\u8f93\u5165 $x$ \u5e76\u5f00\u4e00\u4e2a\u53d8\u91cf $s$\n- \u4ece\u5149\u76d8\u7684\u7b2c\u4e00\u4e2a\u6570\u8003\u8651\u8d77\uff08\u6b64\u65f6\u8fd0\u884c\u65f6\u95f4\u4e3a $0$\uff09\uff0c\u5982\u679c\u8fd9\u4e2a\u6570\u5c0f\u4e8e $x$ \u5219\u628a\u8fd9\u4e2a\u6570\u52a0\u5230 $s$ \u4e2d\u53bb\uff0c\u5982\u679c\u5927\u4e8e\u7b49\u4e8e $x$ \u5c31\u8fd4\u56de\u8fd0\u884c\u65f6\u95f4 $t$\u3002\u6bcf\u4e00\u79d2\u8003\u8651\u4e0b\u4e00\u4e2a\u6570\uff0c\u5faa\u73af\u3002\n\n\u7ed9\u5b9a\u5149\u76d8\u4e0a\u7684\u6570\uff0c\u5e76\u7ed9\u5b9a $m$ \u4e2a $x$\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $x$ \u6c42\u8fd0\u884c\u65f6\u95f4 $t$\u3002\n\n## \u9898\u89e3\n**\u5149\u76d8\u4e0a\u7684\u6570\u6709\u6b63\u6709\u8d1f**\uff0c\u8fd9\u662f\u672c\u9898\u7684\u4e00\u4e2a\u91cd\u96be\u70b9\u3002\n\n\u9996\u5148\u5904\u7406\u4e00\u4e0b\u8fd9\u4e9b\u6570\u7684\u524d\u7f00\u548c\uff0c\u8bb0\u4e3a $s_i$\uff0c\u4e0d\u96be\u53d1\u73b0\u5982\u4e0b\u6027\u8d28\uff1a\u5982\u679c $x < \\max_{1\\le i\\le n}\\lbrace s_i\\rbrace$\uff0c\u8bf4\u660e\u5149\u76d8\u8981\u88ab\u5faa\u73af\u4e0d\u6b62\u4e00\u6b21\uff0c\u5982\u679c $s_n \\le 0$ \u90a3\u4e48\u7d2f\u52a0\u7684\u548c\u4e00\u8f88\u5b50\u90fd\u8fbe\u4e0d\u5230 $x$\uff0c\u76f4\u63a5\u8f93\u51fa $-1$\u3002\n\n\u5bf9\u4e8e\u9700\u8981\u5faa\u73af\u591a\u6b21\u7684\uff0c\u5904\u7406\u51fa\u5faa\u73af\u7684\u6b21\u6570\uff0c\u5373\u4e3a\n\n$$\nr = \\left\\lceil\\frac{x - \\max_{1\\le i\\le n}\\lbrace s_i\\rbrace}{s_n}\\right\\rceil\n$$\n\n\u600e\u4e48\u6765\u7684\u5462\uff1f\u6211\u4eec\u5fc5\u7136\u6709 $r\\times s_n + \\max_{1\\le i\\le n}\\lbrace s_i\\rbrace \\ge x$\uff0c\u5316\u7b80\u4fbf\u77e5\u8981\u5411\u4e0a\u53d6\u6574\u3002\u4ee3\u7801\u4e2d\u5373\u4e3a `r = (x - val[tot] + sum[n] - 1) / sum[n];`\n\n\u628a\u5faa\u73af\u7684\u8fd9\u4e9b\u6b21\u6570\u53bb\u6389\uff0c\u5373 $x:=x - r\\times s_n$\uff0c\u73b0\u5728\u95ee\u9898\u5c31\u53d8\u4e3a**\u627e\u5230\u6700\u5c0f\u7684\u6ee1\u8db3 $s_i \\ge x$ \u7684 $i$**\u3002\n\n\u8d5b\u65f6\u6211\u5c31\u662f\u5728\u8fd9\u91cc\u5361\u4f4f\u4e86\u3002\u56e0\u4e3a $s_i$ \u662f\u4e0d\u6ee1\u8db3\u5355\u8c03\u6027\u7684\uff0c\u6240\u4ee5\u6ca1\u529e\u6cd5\u4f7f\u7528\u4e8c\u5206\u67e5\u627e\uff0c\u4e8e\u662f\u5c31 GG \u4e86\u3002\n\n\u600e\u4e48\u529e\u5462\uff1f\u6ce8\u610f\u5230\u6211\u4eec\u8981\u7684\u662f**\u6700\u5c0f\u4e0b\u6807**\uff0c\u6240\u4ee5\u4e0d\u6ee1\u8db3\u5355\u8c03\u6027\u7684\u90e8\u5206\u6211\u4eec\u53ef\u4ee5**\u76f4\u63a5\u820d\u5f03**\u3002\u5373\u628a $s_i$ \u5355\u8c03\u9012\u589e\u7684\u90e8\u5206\u53d6\u51fa\u6765\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e8c\u5206\u4e86\u3002\n\n**\u5f00 `long long`**\n\n```cpp\nint sum[maxn], val[maxn], id[maxn];\n\nsigned main()\n{\n    int T = read();\n    while (T--)\n    {\n        int n = read(), m = read();\n        FOR(i, 1, n) sum[i] = sum[i - 1] + read();\n        int tot = 0;\n        FOR(i, 1, n)\n        {\n            if (!tot || sum[i] > val[tot])\n                val[++tot] = sum[i], id[tot] = i;//\u5904\u7406\u51fa\u90a3\u4e9b\u5355\u8c03\u9012\u589e\u7684\u524d\u7f00\u548c\u4ee5\u53ca\u5bf9\u5e94\u7684\u4e0b\u6807\n        }\n        while (m--)\n        {\n            int x = read();\n            if (x > val[tot] && sum[n] <= 0)\n                printf(\"-1 \");\n            else\n            {\n                int r = 0;\n                if (val[tot] < x)\n                    r = (x - val[tot] + sum[n] - 1) / sum[n];//\u5904\u7406\u51fa\u8981\u8f6c\u591a\u5708\u7684\u60c5\u51b5\n                x -= r * sum[n];\n                printf(\"%lld \", r * n + id[std::lower_bound(val + 1, val + tot +1, x) - val] - 1);\n            }\n        }\n        puts(\"\");\n    }\n    return 0;\n}\n```",
        "postTime": 1613562160,
        "uid": 212488,
        "name": "\u6e05\u70db",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1490G Old Floppy Drive"
    },
    {
        "content": "\u663e\u7136\u6bcf\u8d70\u4e00\u5708\u8d21\u732e\u662f\u4e00\u5b9a\u7684\uff0c\u8ba1\u7b97\u4e00\u4e0b\u524d\u7f00\u548c\u5373\u53ef\u3002\n\n\u8bb0\u524d\u7f00\u548c\u4e3a $sum[i]$\uff0c$maxn[i]$ \u4e3a $a[1]\\sim a[i]$ \u7684\u8d77\u70b9\u4e3a 1 \u7684\u5b50\u4e32\u6743\u503c\u6700\u5927\u503c\uff0c\u663e\u7136\u6709 $maxn[i]=\\max(maxn[i-1],sum[i])$\u3002\n\n\u7b2c\u4e00\u5708\u5c31\u6ee1\u8db3\u8981\u6c42\u7684\uff08$maxn[n]\\geq x$\uff09\u53ef\u4ee5\u7279\u6b8a\u5904\u7406\u4e00\u4e0b\uff0c\u8fd9\u6837\u7279\u5224\u7684\u65f6\u5019\u4e0d\u5bb9\u6613\u51fa\u9519\u3002\n\n\u7136\u540e\u7279\u5224\u65e0\u89e3\uff0c\u5145\u8981\u6761\u4ef6 $sum[n]\\leq0$ \u4e14 $x>0$\u3002\n\n\u5269\u4e0b\u6765\u7684\u5c31\u662f\u8d70\u4e86\u4e0d\u6b62 1 \u5708\u7684\u60c5\u51b5\u3002\u6211\u4eec\u53ef\u4ee5\u4e8c\u5206\u5708\u6570\uff0c\u6bcf\u6b21 check \u8d70 $mid+1$ \u5708\u540e\u80fd\u5426\u6ee1\u8db3\u6761\u4ef6\uff0c\u5373 $sum[n]\\times mid+maxn[n]\\geq x$\uff08\u56e0\u4e3a\u7b2c $mid+1$ \u5708\u53ef\u80fd\u8d70\u5230\u56fe\u4e2d\u5c31\u6ee1\u8db3\u6761\u4ef6\u6240\u4ee5\u6700\u540e\u4e00\u5708\u8d21\u732e\u5e76\u4e0d\u662f $sum[n]$ \u800c\u662f $maxn[n]$\uff09\u3002\n\n\u7136\u540e\u4e8c\u5206\u5f97\u5230\u5708\u6570 $ans+1$\uff0c\u90a3\u4e48\u663e\u7136\u524d $ans$ \u5708\u662f\u8d70\u5b8c\u6574\u7684\uff0c\u800c\u6700\u540e\u4e00\u5708\u4e0d\u4e00\u5b9a\uff0c\u4e8e\u662f\u5728 $maxn[]$ \u6570\u7ec4\u4e0a\u4e8c\u5206\u5c31\u597d\u4e86\uff0c\u7b54\u6848\u4e3a$ans\\times n+lower\\_bound(maxn+1,maxn+n+1,x-ans\\times sum[n])-maxn-1$\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#define int long long\nint t,n,m,a[200001],sum[200001],maxn[200001];\nsigned main()\n{\n    scanf(\"%lld\",&t);\n    while(t--)\n    {\n        scanf(\"%lld%lld\",&n,&m);\n        maxn[0]=-1e18;\n        sum[0]=0;\n        for(register int i=1;i<=n;++i)\n        {\n            scanf(\"%lld\",&a[i]);\n            sum[i]=sum[i-1]+a[i];\n            maxn[i]=-1e18;\n            maxn[i]=max(maxn[i-1],sum[i]);\n        }\n        while(m--)\n        {\n            int x;\n            scanf(\"%lld\",&x);\n            if(maxn[n]>=x)\n            {\n                printf(\"%lld \",(long long)(lower_bound(maxn+1,maxn+n+1,x)-maxn-1));\n                continue;\n            }\n            if(sum[n]<=0&&x>0)\n            {\n                printf(\"-1 \");\n                continue;\n            }\n            int l=0,r=1e9,mid,ans=1e9;\n            while(l<r)\n            {\n                mid=(l+r)>>1;\n                if(mid*sum[n]+maxn[n]>=x)\n                {\n                    r=mid;\n                    ans=mid;\n                }\n                else\n                    l=mid+1;\n            }\n            printf(\"%lld \",(long long)(ans*n+(long long)(lower_bound(maxn+1,maxn+n+1,x-ans*sum[n])-maxn-1)));\n        }\n        puts(\"\");\n    }\n    return 0;\n}\n```\n",
        "postTime": 1613543507,
        "uid": 85682,
        "name": "\u7edd\u9876\u6211\u4e3a\u5cf0",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1490G \u3010Old Floppy Drive\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u4e0d\u5c31\u662f NOIP T4 $40$ \u5206\u7684\u52a0\u5f3a\u7248\u5417\uff08\n\n\u9996\u5148\u6211\u4eec\u9700\u8981\u5bf9 $a$ \u6570\u5217\u8fdb\u884c\u524d\u7f00\u548c\u5904\u7406\uff0c\u8bb0\u4e3a $sum$ \u6570\u5217\u3002\n\n\u6211\u4eec\u77e5\u9053\uff0c\u5b58\u5728\u4e00\u4e2a $i$ \u4f7f\u5f97 $x\\le sum_i$\u3002\u5219\u5fc5\u8981\u5728\u8fd9\u4e2a\u5faa\u73af\u4e2d\u505c\u6b62\u3002\n\n\n\n\u4e0d\u59a8\u6211\u4eec\u8bbe $maxn=\\max\\{sum_i\\}$ \u73b0\u5c06 $x\\rightarrow x-sum_i$\u3002\n\n\u6bcf\u7ecf\u8fc7\u4e00\u4e2a\u5faa\u73af\uff0c\u6211\u4eec\u5c31\u8981\u5c06 $x\\rightarrow x-sum_n$\n\n\u7531\u6b64\u53ef\u5f97\uff0c\u5f53 $x>0$ \u65f6\uff0c\u53ef\u4ee5\u7ecf\u8fc7\u4e00\u6b21\u8fd9\u6837\u7684\u5faa\u73af\uff1b\u53cd\u4e4b\uff0c\u5219\u5fc5\u987b\u5728\u8fd9\u4e2a\u5faa\u73af\u7ec8\u6b62\u3002\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u51fa\u4e00\u79cd\u505a\u6cd5\uff0c\u8bbe $y=\\dfrac{x-1}{sum_n}+1$\u3002\u7136\u540e\u5c06 $x\\rightarrow x-y\\times sum_n+sum_n$\u3002\u5176\u4e2d $y$ \u4ee3\u8868\u9700\u8981\u7ecf\u8fc7\u7684\u5faa\u73af\u6570\u3002\n\n\u90a3\u4e48\u95ee\u9898\u5c31\u8f6c\u5316\u6210\u4e86\u7ed9\u4f60\u4e00\u4e2a\u6570 $x$ $(x\\le maxn)$\uff0c\u8981\u6c42\u4f60\u627e\u5230\u6700\u5c0f\u7684 $i$ \u4f7f\u5f97 $x\\le sum_i$\u3002\n\n\u56e0\u4e3a\u4e71\u5e8f\u6570\u5217\u4e0d\u597d\u5904\u7406\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5c06 $sum$ \u6392\u5e8f\uff0c\u90a3\u4e48\u4e00\u5b9a\u4f1a\u627e\u5230\u4e00\u4e2a $k$\u3002\u4f7f\u5f97\u5bf9\u4e8e\u4efb\u610f\u7684 $j$ $(k\\le j\\le n)$\uff0c$x\\le sum_j$\u3002\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u5c06 $k$ \u4e8c\u5206\u5373\u53ef\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5f88\u8f7b\u677e\u5730\u5f97\u5230\u6700\u5c0f\u7684 $i=\\min\\{id_j\\}$\uff08$id_j$ \u4e3a\u6392\u5e8f\u524d $sum_j$ \u6240\u5bf9\u5e94\u7684\u7f16\u53f7\uff09\u3002\n\n$\\min\\{id_j\\}$ \u4e5f\u5f88\u597d\u6c42\uff0c\u53ea\u9700\u8981\u5728\u6392\u5e8f\u540e\u5012\u5e8f\u9884\u5904\u7406\u5373\u53ef\u3002\n\n\u8fd9\u6837\u7b54\u6848\u4e3a $ny+i-1$\u3002\n\n\u82e5 $sum_n\\le0$\uff0c\u5c31\u8bf4\u660e\u5fc5\u987b\u5728\u7b2c\u4e00\u4e2a\u5faa\u73af\u4e2d\u505c\u6b62\uff0c\u5373 $x\\le sum_n$\u3002\u90a3\u4e48\u5bf9\u6b64\u60c5\u51b5\uff0c\u76f4\u63a5\u4e8c\u5206\u5373\u53ef\u3002\u53cd\u4e4b\uff0c\u5c31\u8bf4\u660e\u6c38\u8fdc\u4e0d\u80fd\u505c\u6b62\u5faa\u73af\uff0c\u8f93\u51fa `-1` \u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(\\sum(n+m)\\log n)$\n# AC code:\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nint a[200005],minn[200005],n;\npair<long long,int> sum[200005];\nbool cmp(pair<long long,int> x,pair<long long,int> y){\n\tif(x.first==y.first){\n\t\treturn x.second>y.second;\n\t}\n\treturn x.first<y.first;\n}\nlong long ef(int x){\n\tint l=1,r=n,ans=-1;\n\twhile(l<=r){\n\t\tint mid=l+r>>1;\n\t\tif(sum[mid].first>=x){\n\t\t\tans=mid;\n\t\t\tr=mid-1;\n\t\t}\n\t\telse{\n\t\t\tl=mid+1;\n\t\t}\n\t}\n\treturn (long long)minn[ans];\n}\nint main(){\n\tint t;\n\tscanf(\"%d\",&t);\n\twhile(t--){\n\t\tint m,i;\n\t\tlong long xh;\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tfor(i=1;i<=n;i++){\n\t\t\tminn[i]=2147483647;\n\t\t\tscanf(\"%d\",&a[i]);\n\t\t\tsum[i].first=sum[i-1].first+a[i];\n\t\t\tsum[i].second=i;\n\t\t}\n\t\tminn[n+1]=2147483647; \n\t\txh=sum[n].first;\n\t\tsort(sum+1,sum+n+1,cmp);\n\t\tfor(i=n;i;i--){\n\t\t\tminn[i]=min(minn[i+1],sum[i].second);\n\t\t}\n\t\tfor(i=1;i<=m;i++){\n\t\t\tlong long x;\n\t\t\tlong long ans=0;\n\t\t\tscanf(\"%lld\",&x);\n\t\t\tif(xh<=0&&x>sum[n].first){\n\t\t\t\tprintf(\"-1 \");\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tx-=sum[n].first;\n\t\t\tif(xh>0){\n\t\t\t\tif(x>0){\n\t\t\t\t\tans=(x+xh-1)/xh*n;\n\t\t\t\t    x-=(x+xh-1)/xh*xh;\n\t\t\t\t}\n\t\t\t\tx+=sum[n].first; \n\t\t\t\tprintf(\"%lld \",ef(x)+ans-1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tx+=sum[n].first;\n\t\t\t\tprintf(\"%lld \",ef(x)-1);\n\t\t\t}\n\t\t}\n\t\tprintf(\"\\n\");\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1613720658,
        "uid": 80614,
        "name": "ZCPB",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1490G \u3010Old Floppy Drive\u3011"
    },
    {
        "content": "\u56e0\u4e3a\u8fd9\u573a\u9898\u8c8c\u4f3c\u6bd4\u8f83\u9001\uff1f\uff1f\uff1f\u6240\u4ee5\u5c31\u7ed9\u4e00\u9053 $G$ \u7684\u9898\u89e3\u3002        \n\n\u5927\u81f4\u9898\u610f\u5c31\u662f\u4e00\u4e2a\u53ef\u5faa\u73af\u6570\u7ec4 $a$ \u73b0\u5728\u67e5\u8be2 $m$ \u4e2a\u6570 $x$ \u8981\u6c42\u4f60\u627e\u5230\u7b2c\u4e00\u4e2a\u4f4d\u7f6e $idx$ \u4f7f\u5f97 $x \\leq sum_{idx}$ \u3002      \n\n\u5f88\u663e\u7136\u7684\u5c31\u662f\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u5148\u770b\u80fd\u4e0d\u80fd\u5728 $a$ \u6570\u7ec4\u91cc\u9762\u627e\uff0c\u5982\u679c\u4e0d\u884c\u6211\u4eec\u5c31\u76f4\u63a5\u66b4\u529b\u628a $a$ \u6570\u7ec4\u5f53\u6210\u4e00\u4e2a\u6570\u5faa\u73af\u7136\u540e\u4e00\u76f4\u7f29\u5c0f $x$ \u6700\u540e\u518d\u627e\u4e00\u6b21\u3002     \n\n\u4e8e\u662f\u9996\u5148\u7279\u5224\u4e00\u4e0b\u5f53\u524d\u80fd\u4e0d\u80fd\u627e\u5230\u8fd9\u4e2a\u6570\uff0c\u63a5\u7740\u6211\u4eec\u770b\u5f53\u524d\u53ef\u4e0d\u53ef\u4ee5\u5728\u7b2c\u4e00\u8f6e\u91cc\u9762\u5c31\u627e\u5230\u8fd9\u4e2a\u6570\uff0c\u5426\u5219\u7684\u8bdd\u5c31\u66b4\u529b\u51cf\u76f4\u5230 $x$ \u53ef\u4ee5\u5728\u539f\u6570\u7ec4\u91cc\u9762\u88ab\u627e\u5230\u4e3a\u6b62\u3002         \n\n\u5f88\u660e\u663e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e0d\u7b49\u5f0f\u4f18\u5316\u66b4\u529b\u51cf\u7684\u8fc7\u7a0b\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5728 $O(tmlog_n)$ \u7684\u65f6\u95f4\u5185\u641e\u5b9a\u3002         \n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\nusing namespace std;\n#define int long long\nconst int Len = 2e5 + 5;\nint n,m,maxn[Len],a[Len],sum,x,Print;\nsigned main()\n{\n\tint t;scanf(\"%lld\",&t);\n\twhile(t --)\n\t{\n\t\tsum = 0;\n\t\tscanf(\"%lld %lld\",&n,&m);\n\t\tfor(int i = 1 ; i <= n ; i ++) scanf(\"%lld\",&a[i]);\n\t\tfor(int i = 1 ; i <= n ; i ++)\n\t\t{\n\t\t\tsum += a[i];\n\t\t\tmaxn[i] = max(maxn[i - 1] , sum);\n\t\t}\n\t\twhile(m --)\n\t\t{\n\t\t\tPrint = 0;\n\t\t\tscanf(\"%lld\",&x);\n\t\t\tif(maxn[n] < x && sum <= 0)//\n\t\t\t{\n\t\t\t\tprintf(\"-1 \");\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(maxn[n] < x)\n\t\t\t{\n\t\t\t\tint Round = ((x - maxn[n]) % sum) ? (x - maxn[n]) / sum + 1 : (x - maxn[n]) / sum;\n\t\t\t\tPrint = Round * n;\n\t\t\t\tx -= Round * sum;\n\t\t\t}\n\t\t\tint l = 1 , r = n;\n\t\t\twhile(l < r)\n\t\t\t{\n\t\t\t\tint mid = (l + r) >> 1;\n\t\t\t\tif(maxn[mid] >= x) r = mid;\n\t\t\t\telse l = mid + 1; \n\t\t\t}\n\t\t\tprintf(\"%lld \",Print + l - 1);\n\t\t}\n\t\tputs(\"\");\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1613526682,
        "uid": 132533,
        "name": "Hakuoro",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1490G Old Floppy Drive"
    }
]
[
    {
        "content": "\u8003\u8651\u5230\u56db\u79cd\u65b9\u5411\u662f\u5bf9\u79f0\u7684\uff0c\u6211\u4eec\u53ea\u8003\u8651\u5176\u4e2d\u4e00\u79cd\u60c5\u51b5\uff0c\u6bd4\u5982\u8bf4\u76f4\u89d2\u9876\u70b9\u5728\u5de6\u4e0b\u89d2\u7684\u60c5\u51b5\uff0c\u4ee4\u4e09\u4e2a\u9876\u70b9\u4e3a $(x,y), (x+l,y), (x,y+l)$\u3002\n\t\n\u9996\u5148\u6211\u4eec\u53d1\u73b0\u9700\u8981\u52a0\u7684\u6240\u6709\u70b9 $(x',y')$\uff0c\u90fd\u6ee1\u8db3 $x+y\\le x'+y'\\le x+y+l$\uff0c\u8fd9\u4e2a\u4e1c\u897f\u7528\u4e00\u68f5\u6811\u72b6\u6570\u7ec4\u5c31\u53ef\u4ee5\u7ef4\u62a4\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/adnnjqlf.png)\n\n\u7136\u540e\u6211\u4eec\u5c31\u662f\u8981\u51cf\u53bb\u8fd9\u4e24\u5757\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vb0lzid2.png)\n\n\u6211\u4eec\u8003\u8651\u5982\u4f55\u51cf\u53bb\uff0c\u89c2\u5bdf\u8fd9\u4e9b\u70b9\u7684\u6027\u8d28\uff0c\u9996\u5148\u5747\u6ee1\u8db3 $x'+y'\\in [x+y,x+y+l]$\uff0c\u7136\u540e\u5176\u8fd8\u6ee1\u8db3 $x'<x$ \u6216 $y'<y$\u3002\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5f00\u4e24\u68f5\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\uff0c\u4e00\u68f5\u7ef4\u62a4\u4e0b\u6807 $(x+y,x)$\uff0c\u53e6\u4e00\u68f5\u7ef4\u62a4\u4e0b\u6807 $(x+y,y)$\uff0c\u7136\u540e\u5728\u8fd9\u4e24\u68f5\u6811\u72b6\u6570\u7ec4\u4e0a\u77e9\u9635\u52a0\u5373\u53ef\u3002\n\t\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(q\\log^2n)$\uff0c\u7a7a\u95f4 $\\mathcal{O}(n^2)$\u3002",
        "postTime": 1581400932,
        "uid": 84088,
        "name": "pufanyi",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF575I \u3010Robots protection\u3011"
    },
    {
        "content": "### CF 575I\n#### Solution\n\u7531\u4e8e\u56db\u79cd\u65b9\u5411\u662f\u5bf9\u79f0\u7684\uff0c\u6211\u4eec\u53ea\u8003\u8651$dir=1$\u7684\u60c5\u51b5\u3002\n\n\u70b9$(x,y)$\u5728\u4e09\u89d2\u5f62$(x_0,y_0,len)$\u5185\u90e8\u6216\u8fb9\u754c\u7684\u5145\u8981\u6761\u4ef6\u4e3a$x\\geq x_0$\uff0c$y\\geq y_0$\u4e14$x+y\\leq x_0+y_0+len$\u76f4\u63a5\u505a\u662f\u4e00\u4e2a\u56db\u7ef4\u504f\u5e8f\uff08\u8fd8\u6709\u4e00\u7ef4\u65f6\u95f4\uff09\uff0c\u65e0\u6cd5\u901a\u8fc7\u3002\u8003\u8651\u5bf9$x\\geq x_0$\u548c$y\\geq y_0$\u5bb9\u65a5\uff0c\u90a3\u4e48\u9664\u4e86$x<x_0,y<y_0,x+y\\leq x_0+y_0+len$\u8fd9\u79cd\u60c5\u51b5\u5916\u90fd\u662f\u4e09\u7ef4\u504f\u5e8f\u3002\u5bf9\u4e8e\u8fd9\u79cd\u7279\u6b8a\u7684\u60c5\u51b5\uff0c\u4e0d\u96be\u53d1\u73b0\u82e5$x<x_0,y<y_0$\uff0c\u7531\u4e8e$len>0$\u7684\uff0c\u6240\u4ee5$x+y$\u4e00\u5b9a\u662f\u5c0f\u4e8e$x_0+y_0+len$\u7684\u3002\u4e8e\u662f\u8fd9\u8fd8\u662f\u4e00\u4e2a\u4e09\u7ef4\u504f\u5e8f\u4e3a\u9898\u3002\u6700\u540e\u53ea\u9700\u8981\u5904\u7406\u51e0\u4e2a\u4e09\u7ef4\u504f\u5e8f\u5373\u53ef\u3002\n\n\u7531\u4e8e$n\\leq 5000$\uff0c\u4f7f\u7528\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$\\mathcal O(q\\log^2n)$\n\n#### Code\n```cpp\nint n,Q;\nint x[MAXM],y[MAXM],len[MAXM],dir[MAXM],ans[MAXM];\n\nstruct BIT{\n    int n, m;\n    int c[MAXN][MAXN];\n\n    void clear() {memset(c,0,sizeof(c));}\n    void resize(int x,int y) {n = x; m = y;}\n\n    void modify(int x,int y,int v){\n        for(int i = x;i <= n;i += i & -i)\n            for(int j = y;j <= m;j += j & -j)\n                c[i][j] += v;\n    }\n\n    int query(int x,int y){\n        int res = 0;\n        for(int i = x;i >= 1;i -= i & -i)\n            for(int j = y;j >= 1;j -= j & -j)\n                res += c[i][j];\n        return res;\n    }\n} bit;\n\nint main(){\n    scanf(\"%d%d\",&n,&Q);\n    for(int i = 1,op;i <= Q;i++){\n        scanf(\"%d\",&op);\n        if(op == 1) scanf(\"%d%d%d%d\",&dir[i],&x[i],&y[i],&len[i]);\n        else scanf(\"%d%d\",&x[i],&y[i]), dir[i] = 5;\n    }\n    bit.resize(n,n);\n    for(int i = 1;i <= Q;i++){\n        if(dir[i] == 1) bit.modify(x[i],y[i],1), bit.modify(x[i],y[i] + len[i] + 1,-1);\n        else if(dir[i] == 2) bit.modify(x[i],y[i] - len[i],1), bit.modify(x[i],y[i] + 1,-1);\n        else if(dir[i] == 3) bit.modify(x[i] + 1,y[i] + len[i] + 1,1), bit.modify(x[i] + 1,y[i],-1);\n        else if(dir[i] == 4) bit.modify(x[i] + 1,y[i] + 1,1), bit.modify(x[i] + 1,y[i] - len[i],-1);\n        else if(dir[i] == 5) ans[i] += bit.query(x[i],y[i]);\n    }\n    bit.clear(); bit.resize(n + n,n);\n    for(int i = 1;i <= Q;i++){\n        if(dir[i] == 2){\n            bit.modify(x[i] - y[i] + len[i] + n + 2,y[i] + 1,1);\n            bit.modify(x[i] - y[i] + len[i] + n + 2,y[i] - len[i],-1);\n        }else if(dir[i] == 3){\n            bit.modify(x[i] - y[i] - len[i] + n + 1,y[i],1);\n            bit.modify(x[i] - y[i] - len[i] + n + 1,y[i] + len[i] + 1,-1);\n        }else if(dir[i] == 5)\n            ans[i] += bit.query(x[i] - y[i] + n + 1,y[i]);\n    }\n    bit.clear(); bit.resize(n + n,n);\n    for(int i = 1;i <= Q;i++){\n        if(dir[i] == 1){\n            bit.modify(x[i] + y[i] + len[i] + 1,n - y[i] + 2,1);\n            bit.modify(x[i] + y[i] + len[i] + 1,n - y[i] - len[i] + 1,-1);\n        }else if(dir[i] == 4){\n            bit.modify(x[i] + y[i] - len[i],n - y[i] + 1,1);\n            bit.modify(x[i] + y[i] - len[i],n - y[i] + len[i] + 2,-1);\n        }else if(dir[i] == 5)\n            ans[i] += bit.query(x[i] + y[i],n - y[i] + 1);\n    }\n    for(int i = 1;i <= Q;i++)\n        if(dir[i] == 5) printf(\"%d\\n\",ans[i]);\n    return 0;\n}",
        "postTime": 1611201819,
        "uid": 108894,
        "name": "\u5173\u6000\u4ed6\u4eba",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF575I \u3010Robots protection\u3011"
    },
    {
        "content": "## \u9898\u610f\n\u8fdb\u884c $q$ \u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u64cd\u4f5c\u6709\u4e24\u79cd\uff0c\u8981\u4e48\u653e\u7f6e\u4e00\u4e2a\u7b49\u8170\u76f4\u89d2\u4e09\u89d2\u5f62\uff0c\u8981\u4e48\u67e5\u8be2\u67d0\u4e00\u4e2a\u70b9\u88ab\u591a\u5c11\u4e2a\u4e09\u89d2\u5f62\u8986\u76d6\u3002\n\n\u6bcf\u4e2a\u7b49\u8170\u76f4\u89d2\u4e09\u89d2\u5f62\u53ef\u4ee5\u7528\u56db\u4e2a\u53c2\u6570 $dir,x,y,len$ \u786e\u5b9a\uff0c\u5176\u4e2d $dir \\in [1,4]$ \u8868\u793a\u4e09\u89d2\u5f62\u7684\u65b9\u5411\uff0c$(x,y)$ \u8868\u793a\u76f4\u89d2\u7684\u9876\u70b9\u5750\u6807\uff0c$len$ \u8868\u793a\u76f4\u89d2\u8fb9\u7684\u957f\u5ea6\u3002\n\n$x,y\\in [1,n]$\n\n$n\u22645\u00d710^3,q\\le 10^5$\n\n## \u9898\u89e3\n~~\u6210\u529f\u62a2\u5230\u6700\u52a3\u89e3~~\n\n~~\u5982\u679c\u60f3\u5f53\u505a\u601d\u7ef4\u9898\u505a\uff0c\u90a3\u4e48\u8bf7\u4e0d\u8981\u770b\u8fd9\u7bc7\u9898\u89e3\u3002~~\n\n\u4ee5\u4e0b\u4e3a\u5957\u8def\u89e3\u6cd5\u3002\n\n\u6211\u4eec\u5148\u8003\u8651\u65b9\u5411\u5f80\u53f3\u4e0a\u7684\u4e09\u89d2\u5f62\uff0c\u5c31\u662f\u4e0b\u9762\u4e00\u79cd\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/kym6pvyq.png)\n\n\u5982\u679c\u9876\u70b9\u4e3a$(a,b)$\uff0c\u8fb9\u957f\u4e3a$r$\uff0c\u90a3\u4e48\u5b83\u4e0a\u9762\u4e00\u6761\u76f4\u7ebf\u7684\u89e3\u6790\u5f0f\u663e\u7136\u4e3a$y=-x+a+b+r$\n\n\u90a3\u4e48\u4e00\u4e2a\u70b9$x,y$\u5728\u4e09\u89d2\u5f62\u5185\uff0c\u5219\u5fc5\u7136\u6709\uff1a\n$$\\begin{cases}a\\le x\\\\ b\\le y\\\\ a+b+r\u2265 x+y\\end{cases}$$\n\u90a3\u5982\u679c\u5728\u52a0\u5165\u4e00\u4e2a\u65f6\u95f4\u6233$t$\uff0c\u5c31\u53d8\u6210\u4e86\n$$\\begin{cases}t_1\\le t_2\\\\ a\\le x\\\\ b\\le y\\\\ a+b+r\u2265 x+y\\end{cases}$$\n\u6b64\u65f6\u5c31\u53d8\u6210\u4e00\u4e2a~~\u7b80\u5355\u7684\u56db\u4f4d\u504f\u5e8f~~\uff0c\u4f46\u662f$\\mathcal{O}(n\\times\\log^3n)$\u4e0d\u592a\u53ef\u8fc7\u7684\u6837\u5b50\uff0c\u4e8e\u662f\u53ef\u4ee5\u7528\u4e00\u4e9b\u5947\u5947\u602a\u602a\u7684\u65b9\u6cd5\u964d\u4f4e\u5e38\u6570\u3002\n\n\u4e8e\u662f\u6211\u4eec\u8003\u8651\u5408\u5e76$[l,mid]$\u4e0e$[mid+1,r]$\u4e24\u4e2a\u533a\u95f4\uff0c\u90a3\u4e48\u533a\u95f4\u5185\u90e8\u7684\u8d21\u732e\u5df2\u7ecf\u7edf\u8ba1\u5b8c\u4e86\uff0c\u90a3\u4e48\u5bf9\u4e8e$a\\in [mid+1,r]$\uff0c\u5c31\u662f\u5728$[l,mid]$\u627e\u5230\u7b2c\u4e00\u4e2a$x_b>x_a$\uff0c\u5728$[1,b)$ \u4e2d\u8ba1\u7b97\n$$\\begin{cases}y\\le y_a\n\\\\ x+y+r\u2265x_a+y_a\\end{cases}$$\n\n\u7531\u4e8e$y\\le 5000,x+y+r\\le 5000\\times 2$\u76f4\u63a5\u4e0a\u6811\u72b6\u6570\u7ec4\u7edf\u8ba1\u5373\u53ef\u3002\n\n\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u7edf\u8ba1\u5b8c\u4e86\u4e00\u79cd\u65b9\u5411\u7684\u7b54\u6848\uff0c\u90a3\u4e48\u5269\u4e0b\u4e09\u79cd\u7684\u7b54\u6848\u3002\u5f53\u7136\u53ef\u4ee5\u91cd\u65b0\u8ba8\u8bba\uff0c\u4f46\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u65cb\u8f6c\u53d8\u6210\u4e0a\u9762\u7684\u5f62\u5f0f\u3002\n\n~~\u4e8e\u662f\u6700\u52a3\u89e3\u5c31\u88ab\u53e3\u80e1\u51fa\u6765\u4e86~~\n\n\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(n\\times\\log_2n\\times\\log_25000\\times\\log_210000)$\n## ~~\u4e11\u964b\u7684~~\u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n//#define fast\nnamespace in{\n\t#ifdef fast\n\tchar buf[1<<21],*p1=buf,*p2=buf;\n\tinline int getc(){return p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++;}\n\t#else\n\tinline int getc(){return getchar();}\n\t#endif\n\ttemplate <typename T>inline void read(T& t){\n\t\tt=0;int f=0;char ch=getc();while (!isdigit(ch)){if(ch=='-')f = 1;ch=getc();}\n\t    while(isdigit(ch)){t=t*10+ch-48;ch = getc();}if(f)t=-t;\n\t}\n\ttemplate <typename T,typename... Args> inline void read(T& t, Args&... args){read(t);read(args...);}\n}\nnamespace out{\n\tchar buffer[1<<21];int p1=-1;const int p2 = (1<<21)-1;\n\tinline void flush(){fwrite(buffer,1,p1+1,stdout),p1=-1;}\n\tinline void putc(const char &x) {if(p1==p2)flush();buffer[++p1]=x;}\n\ttemplate <typename T>void write(T x) {\n\t\tstatic char buf[15];static int len=-1;if(x>=0){do{buf[++len]=x%10+48,x/=10;}while (x);}else{putc('-');do {buf[++len]=-(x%10)+48,x/=10;}while(x);}\n\t\twhile (len>=0)putc(buf[len]),--len;\n\t}\n}\nusing namespace std;\nconst int N=5e3+1;\nint lowbit(int x){return x&-x;}\nstruct TREE{\n\tint tree[N*2+1];\n\tvoid ins(int x){\n\t\tfor(int i=x;i<=2*N;i+=lowbit(i))\n\t\t\ttree[i]++;\n\t}\n\tvoid clear(int x){\n\t\tfor(int i=x;i<=2*N;i+=lowbit(i))\n\t\t\ttree[i]=0;\n\t}\n\tint qry(int x){\n\t\tint res=0;\n\t\tfor(int i=x;i;i-=lowbit(i))\n\t\t\tres+=tree[i];\n\t\treturn res;\n\t}\n\tint val(int x){\n\t\treturn qry(2*N)-qry(x-1);\n\t}\n};\nTREE tree[N+1];\nvoid upd(int x,int val){\n\tfor(int i=x;i<=N;i+=lowbit(i))\n\t\ttree[i].ins(val);\n}\nint qry(int x,int val){\n\tint res=0;\n\tfor(int i=x;i;i-=lowbit(i))\n\t\tres+=tree[i].val(val);\n\treturn res;\n}\nvoid clear(int x,int val){\n\tfor(int i=x;i<N;i+=lowbit(i))\n\t\ttree[i].clear(val);\n}\nconst int Q=1e5+100;\nint n,q,ans[Q];\nint op[Q],dir[Q],x[Q],y[Q],r[Q];\nnamespace CDQ{\n\tstruct node{\n\t\tint op;\n\t\tint id;\n\t\tint x,y,r;\n\t}a[Q];\n\tint cnt=0;\n\t#define mid (l+r>>1)\n\tvoid cdq(int l,int r){\n\t\t//printf(\"%d %d\\n\",l,r);\n\t\tif(l>=r)return;\n\t\tcdq(l,mid);cdq(mid+1,r);\n\t\tsort(&a[l],&a[mid+1],[&](node a,node b){return a.x!=b.x?a.x<b.x:(a.y!=b.y?a.y<b.y:a.op<b.op);});\n\t\tsort(&a[mid+1],&a[r+1],[&](node a,node b){return a.x!=b.x?a.x<b.x:(a.y!=b.y?a.y<b.y:a.op<b.op);});\n\t\tint now=l;//\u4e0b\u4e00\u4e2a\u9009\u7684\n\t\tfor(int i=mid+1;i<=r;i++)\n\t\t\tif(a[i].op==2){\n\t\t\t\t//\u7edf\u8ba1\u8de8\u5757\u7684\u8d21\u732e\n\t\t\t\twhile(now<=mid&&a[now].x<=a[i].x){\n\t\t\t\t\tif(a[now].op==2){now++;continue;}\n\t\t\t\t\tupd(a[now].y,a[now].x+a[now].y+a[now].r);now++;\n\t\t\t\t}\n\t\t\t\tans[a[i].id]+=qry(a[i].y,a[i].x+a[i].y);\n\t\t\t} \n\t\tfor(int i=l;i<now;i++)\n\t\t\tclear(a[i].y,a[i].x+a[i].y+a[i].r);\n\t}\n\tvoid init(){cnt=0;}\n\tvoid run(){cdq(1,cnt);}\n}\nsigned main(){\n\tin::read(n,q);\n\tfor(int i=1;i<=q;i++){\n\t\tin::read(op[i]);\n\t\tif(op[i]==1)in::read(dir[i],x[i],y[i],r[i]);\n\t\telse in::read(x[i],y[i]);\n\t}\n\tCDQ::init();\n\tfor(int i=1;i<=q;i++)\n\t\tif(op[i]==1&&dir[i]==1)CDQ::a[++CDQ::cnt]=(CDQ::node){1,i,x[i],y[i],r[i]};\n\t\telse if(op[i]==2)      CDQ::a[++CDQ::cnt]=(CDQ::node){2,i,x[i],y[i],r[i]};\n\tCDQ::run();\n\tCDQ::init();\n\tfor(int i=1;i<=q;i++)\n\t\tif(op[i]==1&&dir[i]==2)CDQ::a[++CDQ::cnt]=(CDQ::node){1,i,N-y[i],x[i],r[i]};\n\t\telse if(op[i]==2)      CDQ::a[++CDQ::cnt]=(CDQ::node){2,i,N-y[i],x[i],r[i]};\n\tCDQ::run();\n\tCDQ::init();\n\tfor(int i=1;i<=q;i++)\n\t\tif(op[i]==1&&dir[i]==4)CDQ::a[++CDQ::cnt]=(CDQ::node){1,i,N-x[i],N-y[i],r[i]};\n\t\telse if(op[i]==2)      CDQ::a[++CDQ::cnt]=(CDQ::node){2,i,N-x[i],N-y[i],r[i]};\n\tCDQ::run();\n\tCDQ::init();\n\tfor(int i=1;i<=q;i++)\n\t\tif(op[i]==1&&dir[i]==3)CDQ::a[++CDQ::cnt]=(CDQ::node){1,i,y[i],N-x[i],r[i]};\n\t\telse if(op[i]==2)      CDQ::a[++CDQ::cnt]=(CDQ::node){2,i,y[i],N-x[i],r[i]};\n\tCDQ::run();\n\t\n\tfor(int i=1;i<=q;i++)\n\t\tif(op[i]==2)out::write(ans[i]),out::putc('\\n');\n\tout::flush();\n\treturn 0;\n}\n```",
        "postTime": 1605703977,
        "uid": 174304,
        "name": "jun\u5934\u5409\u5409",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF575I \u3010Robots protection\u3011"
    },
    {
        "content": "## CF 575I / \u706b\u529b\u89c4\u5212\n----\n\n### \u9898\u76ee\u7b80\u8ff0\n\n\u4f20\u9001\u95e8 [[Link](https://codeforces.com/problemset/problem/575/I)] \u3002\n\n\u4e24\u79cd\u64cd\u4f5c\uff0c\u5f53 $op = 1$ \u65f6\uff0c\u8f93\u5165 $dir , x , y , r$ \u4ee3\u8868 \uff0c\u65b9\u5411\u3001\u6a2a\u7eb5\u5750\u6807$(x , y)$ \u3001\u534a\u5f84 $r$ \u7684\u66fc\u54c8\u987f\u6247\u5f62\u3002\n\n $dir$ \u6709\u56db\u79cd\u53ef\u80fd\u7684\u53d6\u503c\uff0c\u5bf9\u4e8e $(x,y)$ \u7684 $dir$ \u65b9\u5411\u7684\u70b9 $(x',y')$ \u5b9a\u4e49\u4e3a \uff1a\n\n$\\bullet$  $dir = 1$ \u65f6 $x' \\geqslant x$ \u4e14 $y' \\geqslant y$ \uff1b\n\n$\\bullet$  $dir = 2$ \u65f6 $x' \\geqslant x$ \u4e14 $y' \\leqslant y$ \uff1b\n\n$\\bullet$  $dir = 3$ \u65f6 $x' \\leqslant x$ \u4e14 $y' \\geqslant y$ \uff1b\n\n$\\bullet$  $dir = 4$ \u65f6 $x' \\leqslant x$ \u4e14 $y' \\leqslant y$ \u3002\n\n\u5f53$op = 2$ \u65f6\uff0c\u8f93\u5165 $x , y$ \u4ee3\u8868\u8be2\u95ee $(x , y)$ \u88ab\u51e0\u4e2a\u66fc\u54c8\u987f\u6247\u5f62\u8986\u76d6\u3002\n\n$1 \\leqslant n \\leqslant 5000$  \uff0c$1 \\leqslant q \\leqslant 10^5$ \u3002\n\n\u6ce8\uff1a\u5bf9\u4e8e $(x', y')$ \u548c $(x , y)$ \uff0c\u66fc\u54c8\u987f\u8ddd\u79bb\u6307 $ \\mid x - x'\\mid + \\mid y - y'\\mid $ , \u66fc\u54c8\u987f\u6247\u5f62\u6307 \u77e9\u9635\u4e2d\u6240\u6709\u5230\u70b9 $O$ \u8ddd\u79bb\u7b49\u4e8e\u5b9a\u957f\u7684\u70b9\u7684\u96c6\u5408\uff0c\u53ca\u5bf9\u4e8e\u534a\u5f84\u4e3a $r$ \u7684\u6247\u5f62 \u662f\u6240\u6709 $ \\mid x - x'\\mid + \\mid y - y'\\mid  \\leqslant r$ \u7684\u96c6\u5408\u3002  \n\n----\n\n### \u89e3\u9898\u601d\u8def\n\n\u4e8c\u7ef4\u5e73\u9762\u89c4\u5219\u56fe\u5f62\u8986\u76d6\uff0c~~\u663e\u7136~~ \u6307\u5411\u4e8c\u7ef4\u5dee\u5206\u3002\u7531\u4e8e\u672c\u9898 $1 \\leqslant n \\leqslant 5000$ \uff0c$1 \\leqslant q \\leqslant 10^5$ \u8003\u8651\u6811\u72b6\u6570\u7ec4\u6c42\u524d\u7f00\u548c\u4f18\u5316\u3002\n\n\u4e3e\u4e2a\u4f8b\u5b50 \u5bf9\u4e8e\u56fe\u5f62 1 4 3 4 2 \u3002\n\n\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/8u2s78j2.png)\n\n\n\n\u8003\u8651\u7528 $y =-x + b$ \u4e3a\u7ebf\u5b58\u5dee\u5206\u503c\uff0c\u7531\u4e8e\u662f\u66fc\u54c8\u987f\u8ddd\u79bb\u6211\u4eec\u5c31\u53ef\u4ee5 ~~\u663e\u7136~~ \u7684\u89c2\u5bdf\u5230\u9876\u70b9\u4e3a $(x,y)$ \u534a\u5f84\u4e3a 2 \u7684\u56fe\u5f62\u82e5\u8981\u8986\u76d6 $(x',y')$ \u5c31\u8981\u6ee1\u8db3 $x'+ y' \\leqslant x + y \\leqslant x'+ y'+ r$ \u3002\n\n\u5bf9\u4e8e\u672c\u4f8b\u5b50\u800c\u8a00\u662f\u5982\u4e0b\u56fe\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dfvnyn35.png)\n\n\n\n\u8ba9 $y = -x + 6(x \\geqslant 1)$ \u7684\u5dee\u5206 $+1$ ; $y = -x + 9(x \\geqslant 4)$ \u7684\u5dee\u5206 $-1$ ;\n\n\u4f46\u8fd9\u65f6\u5019\u6211\u4eec\u4f1a\u53d1\u73b0 \u6709\u4e9b\u70b9\u591a\u7b97\u4e86\uff0c\u4f8b\u5982  $(2 , 8)$  \u53ea\u7b97\u5230\u4e86 $+$ \u6ca1\u6709 $-$   \u3002\n\n\u8003\u8651\u518d\u5efa\u7acb\u4e00\u4e2a\u5e73\u884c\u4e8e\u5750\u6807\u7cfb\u7684\u5dee\u5206\u5c06\u591a\u7b97\u7684\u90e8\u5206\u5220\u6389\uff0c\u6548\u679c\u5982\u4e0b\uff08\u6ce8\uff1a \u5de6\u8fb9\u7eff\u70b9 $-1$ \u53f3\u8fb9 $+1$ \uff09\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/1haizzob.png)\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u5904\u7406\u597d\u4e86 $dir = 4$ \uff08\u5f00\u53e3\u5de6\u4e0b\u89d2\uff09\u7684\u60c5\u51b5\uff1b\n\n\u8003\u8651\u6bcf\u6b21\u5c06\u6574\u5f20\u56fe\u65cb\u8f6c 90\u00b0 \u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8be2\u95ee\u5904\u7406\u3002\n```cpp\nswap(ask[i].x , ask[i].y) , ask[i].x = n - ask[i].x + 1;\n```\n\n\u7edf\u8ba1\u56db\u6b21\u7b54\u6848\u5373\u53ef\u3002\n\n----\n\n\n\n### \u9898\u89e3\n\n\n\n\u4f20\u9001\u95e8[[Link](https://www.luogu.com.cn/paste/g09cwq34)] \u3002",
        "postTime": 1678246180,
        "uid": 97287,
        "name": "\u5c0f\u80d6\u540c\u5b66",
        "ccfLevel": 5,
        "title": "CF 575 I"
    },
    {
        "content": "> [CF575I Robots protection](https://codeforces.com/contest/575/problem/I)\n\n## \u9898\u610f\n\n- \u4f60\u9700\u8981\u5728\u5e73\u9762\u76f4\u89d2\u5750\u6807\u7cfb\u4e0a\u8fdb\u884c $q$ \u6b21\u64cd\u4f5c\u3002\n- \u6bcf\u6b21\u64cd\u4f5c\u6709\u4e24\u79cd\uff0c\u8981\u4e48\u653e\u7f6e\u4e00\u4e2a\u4e24\u6761\u76f4\u89d2\u8fb9\u5e73\u884c\u4e8e\u5750\u6807\u8f74\u7684\u7b49\u8170\u76f4\u89d2\u4e09\u89d2\u5f62\uff0c\u8981\u4e48\u67e5\u8be2\u67d0\u4e00\u4e2a\u70b9\u88ab\u591a\u5c11\u4e2a\u4e09\u89d2\u5f62\u8986\u76d6\u3002\n- \u6bcf\u4e2a\u7b49\u8170\u76f4\u89d2\u4e09\u89d2\u5f62\u53ef\u4ee5\u7528\u56db\u4e2a\u53c2\u6570 $dir,x,y,len$ \u786e\u5b9a\uff0c\u5176\u4e2d $dir \\in [1,4]$ \u8868\u793a\u4e09\u89d2\u5f62\u7684\u65b9\u5411\uff0c$(x,y)$ \u8868\u793a\u76f4\u89d2\u7684\u9876\u70b9\u5750\u6807\uff0c$len$ \u8868\u793a\u76f4\u89d2\u8fb9\u7684\u957f\u5ea6\u3002\n- \u4fdd\u8bc1\u6240\u6709\u70b9\u7684\u5750\u6807\u90fd\u662f\u6574\u6570\u4e14 $\\in [1,n]$\u3002\n- $n \\le 5 \\times 10^3$\uff0c$q \\le 10^5$\u3002\n\n## \u9898\u89e3\n\n$n$ \u5f88\u5c0f\uff0c\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\u5373\u53ef\u3002\n\n\u6ce8\u610f\u5230\u8981\u5206\u4e94\u7c7b\u8003\u8651\uff0c\u6240\u4ee5\u8981\u5728\u65f6\u95f4\u548c\u7a7a\u95f4\u5361\u4e00\u4e0b\u5e38\u6570\u3002\n\n![](http://www.xht37.com/wp-content/uploads/2020/01/1126418-20200108213332804-1585535723.png)\n\n\uff08\u56fe\u6765\u81ea\u5154\uff09\n\n## \u4ee3\u7801\n\n```cpp\nconst int N = 1e4 + 7, M = 1e5 + 7;\nint n, m, op[M], dir[M], x[M], y[M], c[M], ans[M];\nint X, Y, bit[N][N], stx[M], sty[M], stz[M], top;\n\ninline void add(int x, int y, int z) {\n\tstx[++top] = x, sty[top] = y, stz[top] = z;\n\tfor (int i = x; i <= X; i += i & -i)\n\t\tfor (int j = y; j <= Y; j += j & -j)\n\t\t\tbit[i][j] += z;\n}\n\ninline int ask(int x, int y) {\n\tint z = 0;\n\tfor (int i = x; i; i -= i & -i)\n\t\tfor (int j = y; j; j -= j & -j)\n\t\t\tz += bit[i][j];\n\treturn z;\n}\n\ninline void clear() {\n\twhile (top) add(stx[top], sty[top], -stz[top]), top -= 2;\n}\n\nint main() {\n\trd(n), rd(m);\n\tfor (int i = 1; i <= m; i++) {\n\t\trd(op[i]);\n\t\tif (op[i] == 1) rd(dir[i]), rd(x[i]), rd(y[i]), rd(c[i]);\n\t\telse rd(x[i]), rd(y[i]);\n\t}\n\n\tX = n, Y = n;\n\tfor (int i = 1; i <= m; i++)\n\t\tif (op[i] == 1) {\n\t\t\tif (dir[i] == 1) add(x[i], y[i], 1);\n\t\t\tif (dir[i] == 2) add(x[i], y[i] + 1, -1);\n\t\t\tif (dir[i] == 3) add(x[i] + 1, y[i], -1);\n\t\t\tif (dir[i] == 4) add(x[i] + 1, y[i] + 1, 1);\n\t\t} else ans[i] += ask(x[i], y[i]);\n\tclear();\n\n\tX = n + n, Y = n;\n\tfor (int i = 1; i <= m; i++)\n\t\tif (op[i] == 1) {\n\t\t\tif (dir[i] == 1)\n\t\t\t\tadd(x[i] + y[i] + c[i] + 1, y[i], -1);\n\t\t\tif (dir[i] == 4)\n\t\t\t\tadd(x[i] + y[i] - c[i], y[i] + 1, -1);\n\t\t} else ans[i] += ask(x[i] + y[i], y[i]);\n\tclear();\n\t\n\tX = n, Y = n + n;\n\tfor (int i = 1; i <= m; i++)\n\t\tif (op[i] == 1) {\n\t\t\tif (dir[i] == 1)\n\t\t\t\tadd(n - x[i] + 2, x[i] + y[i] + c[i] + 1, 1);\n\t\t\tif (dir[i] == 4)\n\t\t\t\tadd(n - x[i] + 1, x[i] + y[i] - c[i], 1);\n\t\t} else ans[i] += ask(n - x[i] + 1, x[i] + y[i]);\n\tclear();\n\n\tX = n + n, Y = n;\n\tfor (int i = 1; i <= m; i++)\n\t\tif (op[i] == 1) {\n\t\t\tif (dir[i] == 2)\n\t\t\t\tadd(n + x[i] - y[i] + c[i] + 2, y[i] + 1, 1);\n\t\t\tif (dir[i] == 3)\n\t\t\t\tadd(n + x[i] - y[i] - c[i] + 1, y[i], 1);\n\t\t} else ans[i] += ask(n + x[i] - y[i] + 1, y[i]);\n\tclear();\n\n\tX = n, Y = n + n;\n\tfor (int i = 1; i <= m; i++)\n\t\tif (op[i] == 1) {\n\t\t\tif (dir[i] == 2)\n\t\t\t\tadd(x[i], n - x[i] + y[i] - c[i] + 1, 1);\n\t\t\tif (dir[i] == 3)\n\t\t\t\tadd(x[i] + 1, n - x[i] + y[i] + c[i] + 2, 1);\n\t\t} else ans[i] += ask(x[i], n - x[i] + y[i] + 1);\n\tclear();\n\n\tfor (int i = 1; i <= m; i++)\n\t\tif (op[i] == 2) printf(\"%d\\n\", ans[i]);\n\treturn 0;\n}\n```",
        "postTime": 1579200742,
        "uid": 100544,
        "name": "xht",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF575I \u3010Robots protection\u3011"
    }
]
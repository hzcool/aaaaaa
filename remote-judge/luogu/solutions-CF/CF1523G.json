[
    {
        "content": "\u6bd4\u8f83\u6e05\u65b0\u7684\u6570\u636e\u7ed3\u6784\u4f53\u3002\n\n\u9996\u5148\u89c2\u5bdf\u5230 $n$ \u6bd4\u8f83\u5c0f\uff0c\u8003\u8651\u591a\u4e2a $\\log $ \u6216 \u6839\u53f7\u7b97\u6cd5\u3002\n\n\u5148\u8003\u8651\u56fa\u5b9a $x$ \u600e\u4e48\u505a\uff0c\u6211\u4eec\u53ef\u4ee5\u5199\u4e00\u4e2a ``calc(l,r)`` \u51fd\u6570\u8868\u793a\u65f6\u95f4\u533a\u95f4\u5728 $[l,r]$ \u5185\u7684\u4ee3\u4ef7\u662f\u591a\u5c11\uff0c\u6bcf\u6b21\u6c42\u51fa\u533a\u95f4 $[l,r]$ \u4e2d\u7f16\u53f7\u6700\u5c0f\u7684\u65e5\u7a0b\u5b89\u6392 $(x,y)$\uff0c\u52a0\u4e0a\u5b83\u7684\u8d21\u732e\uff0c\u7136\u540e\u9012\u5f52\u8ba1\u7b97 ``calc(l,x-1)`` \u548c ``calc(y+1,r)``\u3002\n\n\u624b\u7b97\u4e00\u4e0b\u53d1\u73b0\u5f53 $x$ \u9012\u51cf\u65f6\uff0c\u76f8\u5f53\u4e8e\u52a8\u6001\u52a0\u5165\u65b0\u7684\u533a\u95f4\u3002\n\n\u76f8\u5f53\u4e8e\u6211\u4eec\u53ea\u9700\u8981\u652f\u6301\u63d2\u5165\u533a\u95f4\uff0c\u5728\u7ebf\u67e5\u8be2 $l\\le (x,y) \\le r$ \u4e2d\u7f16\u53f7\u6700\u5c0f\u7684\u65e5\u7a0b\u5b89\u6392 $(x,y)$ \u3002\u8fd9\u662f\u4e2a\u4e8c\u7ef4\u95ee\u9898\uff0c\u76f4\u63a5\u6811\u72b6\u6570\u7ec4\u5957\u52a8\u6001\u5f00\u70b9\u7ebf\u6bb5\u6811\u7ef4\u62a4\uff0c\u63d2\u5165\u548c\u67e5\u8be2\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u662f $\\mathcal{O}(\\log ^2 n)$ \u3002\n\n\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a $x$ \uff0c\u8c03\u7528 ``calc(1,n)`` \u51fd\u6570\u8ba1\u7b97\u7b54\u6848\u5373\u53ef\u3002\n\n\u4ee5\u4e0b\u662f\u65f6\u95f4\u590d\u6742\u5ea6\u5206\u6790\u3002\n\n\u5df2\u77e5 $x$ \uff0c\u5219 ``calc(l,r)`` \u5411\u4e0b\u9012\u5f52\u7684\u533a\u95f4\u81f3\u5c11\u51cf\u5c11 $x$ \uff0c\u6211\u4eec\u5c06\u6bcf\u6b21\u8c03\u7528\u7684 ``calc(l,r)`` \u6302\u5728\u8fd9\u6b21\u8c03\u7528\u52a0\u5165\u8d21\u732e\u7684\u65e5\u7a0b\u5b89\u6392\u4e0a\uff0c\u53d1\u73b0\u8c03\u7528\u6b21\u6570\u662f $\\mathcal{O}(\\dfrac{n}{x})$ \u7ea7\u522b\u7684\u3002\n\n\u6240\u4ee5\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal{O}(n\\log^2 n\\ln n+m\\log^2 n)$ \uff0c$300ms$ \u7a33\u8fc7\u3002\u8fd9\u6837\u6211\u4eec\u5c31\u89e3\u51b3\u4e86\u8fd9\u9053 3200 \u7684 DS \u9898\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<=b;i++)\n#define pre(i,a,b) for(int i=a;i>=b;i--)\n#define N 100005\n#define inf 0x3f3f3f3f\nusing namespace std;\nint n,m,ll[N],rr[N],rt[N],tot,p[N],ans[N];\nstruct node{\n\tint l,r,mn;\n}a[N*200];\n#define ls a[x].l\n#define rs a[x].r\n#define S a[x].mn\nvoid ins(int &x,int l,int r,int pos,int val){\n\tif(!x)x=++tot,S=val;\n\telse S=min(S,val);\n\tif(l==r)return;\n\tint mid=(l+r)>>1;\n\tif(mid>=pos)ins(ls,l,mid,pos,val);\n\telse ins(rs,mid+1,r,pos,val);\n}\nint ask(int x,int l,int r,int L,int R){\n\tif(!x)return inf;\n\tif(L>=l&&R<=r)return S;\n\tint mid=(L+R)>>1,cur=inf;\n\tif(mid>=l)cur=min(cur,ask(ls,l,r,L,mid));\n\tif(mid<r)cur=min(cur,ask(rs,l,r,mid+1,R));\n\treturn cur;\n}\ninline void add(int l,int r,int val){for(;r<=n;r+=r&-r)ins(rt[r],1,n,l,val);}\nvoid dfs(int x,int l,int r){\n\tif(!x)return;\n\tint mid=(l+r)>>1;\n\tdfs(ls,l,mid);dfs(rs,mid+1,r);\n}\ninline int qry(int l,int r){\n\tint cur=inf;\n\tfor(;r>=l;r-=r&-r)\n\t\tcur=min(cur,ask(rt[r],l,n,1,n));\n\treturn cur;\n}\nint solve(int l,int r){\n\tif(l>r)return 0;\n\tint cur=qry(l,r);\n\tif(cur==inf)return 0;\n\treturn rr[cur]-ll[cur]+1+solve(l,ll[cur]-1)+solve(rr[cur]+1,r);\n}\nbool cmp(int x,int y){return rr[x]-ll[x]>rr[y]-ll[y];}\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\trep(i,1,m)scanf(\"%d%d\",&ll[i],&rr[i]),p[i]=i;\n\tsort(p+1,p+m+1,cmp);int j=1;puts(\"No Copy\");\n\tpre(i,n,1){\n\t\twhile(j<=m&&rr[p[j]]-ll[p[j]]+1==i)add(ll[p[j]],rr[p[j]],p[j]),j++;\n\t\tans[i]=solve(1,n);\n\t}\n\trep(i,1,n)printf(\"%d\\n\",ans[i]);\n\treturn 0;\n}\n```",
        "postTime": 1622472867,
        "uid": 119261,
        "name": "7KByte",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011CF1523G Try Booking"
    },
    {
        "content": "[\u4e0d\u77e5\u9053\u66f4\u597d\u8fd8\u662f\u66f4\u574f\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/Illusory-dimes/p/15888311.html)\n\n\u590d\u76d8 ntf \u8bb2\u7684\u9898\uff0c\u5199\u7bc7\u9898\u89e3\u6765~~\u7978\u5bb3\u793e\u4f1a~~\n\n## Description\n\n\u7ed9\u5b9a $m$ \u4e2a\u8bf7\u6c42\u548c\u7a7a\u95f2\u7684 $n$ \u5929\uff0c\u6bcf\u4e2a\u8bf7\u6c42\u5305\u542b\u4e24\u4e2a\u6574\u6570 $l$ \u548c $r$ \u8868\u793a\u7b2c $i$ \u4e2a\u8bf7\u6c42\u60f3\u5360\u7528 $l$ \u5230 $r$ \u8fd9\u51e0\u5929\u3002\n\n\u7136\u540e\u4f60\u81ea\u5df1\u6709\u4e00\u4e2a\u9650\u5236 $x$ \uff0c\u5f53\u76ee\u524d\u8fd9\u4e2a\u8bf7\u6c42\u60f3\u5360\u7528\u7684\u5929\u6570\u4e0d\u5c0f\u4e8e $x$ \u65f6\uff0c\u4f60\u624d\u4f1a\u8003\u8651\u662f\u5426\u5b89\u6392\uff0c\u5e76\u4e14\u8be5\u8bf7\u6c42\u751f\u6548\u7684\u6761\u4ef6\u662f\u5728 $l$ \u5230 $r$ \u4e2d\u7684\u6240\u6709\u5929\u76ee\u524d\u5747\u65e0\u4eba\u5360\u7528\u3002\n\n\u95ee $x \\in [1,\\ n]$ \u7684\u6240\u6709\u9650\u5236\u4e0b\u80fd\u5b89\u6392\u7684\u5929\u6570\u3002\n\n$n \\leq 5 \\cdot 10 ^ 4,\\ m \\leq 10 ^ 5$\n\n## Solution\n\n\u56e0\u4e3a\u6bcf\u4e00\u5929\u53ea\u80fd\u81f3\u591a\u6709\u4e00\u4e2a\u4eba\u80fd\u591f\u5360\u7528\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5206\u6cbb\uff0c\u56e0\u4e3a\u6bcf\u6b21\u6700\u5c11\u51cf\u5c11 $x$ \u5929\uff0c\u6240\u4ee5\u5206\u652f\u8fd9\u4e00\u6bb5\u7684\u65f6\u95f4\u662f\uff1a$\\sum_{i = 1} ^ n {\\large \\frac{n}{i}} = n\\ln n$ \u3002\n\n\u56e0\u4e3a\u8981\u5148\u6765\u540e\u5230\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u8981\u8003\u8651\u7ef4\u62a4\u88ab\u5305\u542b\u5728\u533a\u95f4\u5185\u7684\u8bf7\u6c42\u7684\u6700\u5c0f\u5e8f\u53f7\u3002\u867d\u7136\u663e\u7136\u7ebf\u6bb5\u6811\uff0c\u4f46\u662f\u6211\u4eec\u4f3c\u4e4e\u5e76\u4e0d\u80fd\u76f4\u63a5\u538b\u7f29\u72b6\u6001\uff0c\u6211\u4eec\u60f3\u60f3\u5728\u4ec0\u4e48\u60c5\u51b5\u4e0b\u80fd\u591f\u8868\u8fbe\u51fa\u6765\u3002\n\n\u6211\u4eec\u60f3\u8c61\u4e00\u4e2a\u4e8c\u7ef4\u5e73\u9762\uff0c\u53f3\u4e0a\u89d2\u662f $(0, 0)$ \uff0c\u7136\u540e\u5047\u8bbe\u6211\u4eec\u8981\u7684\u533a\u95f4\u662f $(l, r)$ \uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7abwy72n.png)\n\n\u56fe\u4e2d\u4e5f\u5c31\u53ea\u6709\u7d2b\u8272\u7684\u70b9\u662f\u6ee1\u8db3\u8981\u6c42\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u5f53\u4e14\u4ec5\u5f53\u6ee1\u8db3 $L_i \\geq l,\\ R_i \\leq r$ \u65f6\u624d\u6ee1\u8db3\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5206\u5f00\u7ef4\u62a4 $l$ \u548c $r$ \uff0c\u91c7\u7528\u6811\u5957\u6811\u7ef4\u62a4\uff0c\u6bcf\u6b21\u67e5\u8be2\u4e00\u6b21\uff0c\u7136\u540e\u9012\u5f52\u5230 $[limL, L - 1]$ \u548c $[R + 1, limR]$ \u7ee7\u7eed\u67e5\u8be2\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\ln n\\log^ 2 n + m \\log ^ 2 n)$ \u3002\n\n## Code\n\n```cpp\n/*\n\n*/\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N = 6e6 + 10, INF = 2e9;\nint n, m, l[N], r[N], pt[N], ans[N];\nint rt[N], cnt, tr[N], ls[N], rs[N];\nvector<int> lth[N];\nconst int Mxdt = 100000;\ninline char gc() {\n\tstatic char buf[Mxdt], *p1 = buf, *p2 = buf;\n\treturn p1 == p2 && (p2 = (p1 = buf) + fread(buf, 1, Mxdt, stdin), p1 == p2) ? EOF : *p1++;\n}\ninline int read() {\n\tchar ch = getchar();\n\tint s = 0, w = 1;\n\twhile (!isdigit(ch)) {if (ch == '-') w = -1; ch = getchar();}\n\twhile (isdigit(ch)) {s = (s << 3) + (s << 1) + (ch ^ 48); ch = getchar();}\n\treturn s * w;\n}\ninline void pushup(int now) {\n\ttr[now] = min(tr[ls[now]], tr[rs[now]]);\n}\ninline void modify(int &now, int lt, int rt, int k, int it) {\n\tif (!now) tr[now = ++cnt] = INF;\n\tif (lt == rt) {\n\t\ttr[now] = min(tr[now], it); return ;\n\t}\n\tint mid = (lt + rt) >> 1;\n\tif (k <= mid) modify(ls[now], lt, mid, k, it);\n\telse modify(rs[now], mid + 1, rt, k, it);\n\tpushup(now);\n}\ninline int query(int now, int lt, int rt, int L, int R) {\n\tif (!now) return INF;\n\tif (L <= lt && rt <= R) return tr[now];\n\tint mid = (lt + rt) >> 1, res = INF, ret = INF;\n\tif (L <= mid) res = query(ls[now], lt, mid, L, R);\n\tif (R > mid) ret = query(rs[now], mid + 1, rt, L, R);\n\treturn min(res, ret);\n}\ninline int lowbit(int x) {return x & (-x);}\ninline void modify(int l, int r, int it) {\n\tfor (int i = r; i <= n; i += lowbit(i)) modify(rt[i], 1, n, l, it);\n}\ninline int query(int l, int r) {\n\tint res = INF;\n\tfor (int i = r; i; i -= lowbit(i)) res = min(res, query(rt[i], 1, n, l, r));\n\treturn res;\n}\ninline int calc(int lt, int rt, int it) {\n\tif (rt - lt + 1 < it) return 0;\n\tint res = query(lt, rt);\n\tif (res > m) return 0;\n\treturn calc(lt, l[res] - 1, it) + pt[res] + calc(r[res] + 1, rt, it);\n}\nint main() {\n\tn = read(); m = read(); tr[0] = INF;\n\tfor (int i = 1; i <= m; ++i) {\n\t\tl[i] = read(); r[i] = read();\n\t\tpt[i] = r[i] - l[i] + 1;\n\t\tlth[pt[i]].push_back(i);\n\t}\n\tfor (int i = n; i >= 1; --i) {\n\t\tfor (int j : lth[i]) modify(l[j], r[j], j);\n\t\tans[i] = calc(1, n, i);\n\t}\n\tfor (int i = 1; i <= n; ++i) printf(\"%d\\n\", ans[i]);\n\treturn 0;\n\n```",
        "postTime": 1644720623,
        "uid": 206024,
        "name": "Illusory_dimes",
        "ccfLevel": 7,
        "title": "CF1523G Try Booking \u9898\u89e3"
    },
    {
        "content": "**\u9898\u610f**\n- [\u94fe\u63a5](https://www.luogu.com.cn/problem/CF1523G)\u3002\n- \u6309\u987a\u5e8f\u7ed9\u51fa\u4e00\u4e9b\u533a\u95f4\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $x$\uff0c\u8f93\u51fa\u9009\u51fa\u957f\u5ea6\u4e0d\u5c0f\u4e8e $x$ \u7684\u533a\u95f4\uff0c\u987a\u6b21\u52a0\u5165\uff0c\u6700\u591a\u53ef\u4ee5\u8ba9\u51e0\u4e2a\u533a\u95f4\u4e0d\u91cd\u53e0\uff1f\n\n\n**\u5206\u6790**\n- \u9996\u5148\u4e0e[\u8fd9\u9898](https://www.luogu.com.cn/blog/luo1gu1zui1bang1/hao-ti)\u7c7b\u4f3c\uff0c\u5982\u679c\u6211\u4eec\u66b4\u529b\u679a\u4e3e $x$\uff0c\u88ab\u52a0\u5165\u7684\u533a\u95f4\u603b\u6570\u76ee\u662f $O(n\\log n)$ \u7684\uff0c\u6240\u4ee5\u6211\u4eec\u5c1d\u8bd5\u8003\u8651\u5bf9\u4e8e\u6bcf\u4e2a $x$ \u5982\u4f55\u5904\u7406\u3002\n- \u5bf9\u4e8e\u6bcf\u4e2a $x$\uff0c\u628a\u80fd\u653e\u5165\u7684\u6700\u524d\u7684\u6bb5\u4f18\u5148\u653e\u5165\uff0c\u5bb9\u6613\u53d1\u73b0\u5b83\u5206\u6210\u4e86\u4e24\u4e2a\u5de8\u5927\u7684\u7a7a\u6bb5\uff0c\u5206\u522b\u7edf\u8ba1\u5373\u53ef\uff0c\u5bb9\u6613\u53d1\u73b0\u5206\u6cbb\u65f6\u67e5\u8be2\u6700\u524d\u7684\u6bb5\u7684\u6b21\u6570\u662f $O(n/x)$\u3002\n- \u63a5\u4e0b\u6765\u54b1\u4eec\u5206\u6790\u67e5\u8be2\u7684\u590d\u6742\u5ea6\uff0c\u67e5\u8be2\u8981\u6c42\u6211\u4eec\u67e5\u5728\u533a\u95f4 $[l,r]$ \u5185\uff0c\u957f\u5ea6\u8d85\u8fc7 $x$ \u7684\uff0c\u65f6\u95f4\u6700\u524d\u7684\u6bb5\u3002\n- \u6211\u4eec\u5c06 $x$ \u4ece\u5927\u5230\u5c0f\u679a\u4e3e\u53ef\u4ee5\u6d88\u6389\u5176\u4e2d\u7684\u4e00\u4e2a\u9650\u5236\uff08\u5f53\u7136\uff0c\u540c\u65f6\u9650\u5236\u6211\u4eec\u5728\u7ebf\uff09\uff0c\u5982\u679c\u6211\u4eec\u628a\u533a\u95f4\u8868\u793a\u6210 $(x,y)$ \u7684\u5f62\u5f0f\uff0c\u90a3\u4e48\u6211\u4eec\u8981\u627e\u7684\u5c31\u662f $x\\ge l$ \u4e14 $y\\le r$ \u5185\u7684\u6700\u5c0f\u503c\uff0c\u6811\u5957\u6811\u6ee1\u8db3\u8fd9\u4e2a\u8981\u6c42\u3002\n- \u6240\u4ee5\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log^3n+m\\log^2n)$\u7a7a\u95f4\u590d\u6742\u5ea6 $O(n\\log^2 n)$ \u7684\u4f18\u79c0\uff08\uff1f\uff09\u7b97\u6cd5\u3002\n- \u867d\u7136\u8fd9\u4e2a\u4fe1\u606f\u4e0d\u53ef\u5dee\u5206\uff0c\u4f46\u662f\u5b83\u662f\u524d\u7f00\u67e5\u8be2\u7684\u5f62\u5f0f\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5feb\u4e50\u5730\u7528\u6211\u4eec\u7684\u6811\u72b6\u6570\u7ec4\u51cf\u5c0f\u5e38\u6570\u548c\u4ee3\u7801\u590d\u6742\u5ea6\u3002\n- [\u4ee3\u7801\u5b9e\u73b0](https://www.luogu.com.cn/paste/gm0taf9i)\u3002",
        "postTime": 1647046310,
        "uid": 260884,
        "name": "WeLikeStudying",
        "ccfLevel": 0,
        "title": "\u3010\u65e7\u4e8b\u91cd\u63d0\u3011Try Booking"
    }
]
[
    {
        "content": "# CF1221F \u3010Choose a Square\u3011\n[$\\color{red}\\Large{\\text{\u5ba3}}\\color{black}\\small\\text{\u4f20}^{blog}$](https://chen-jia-liang.gitee.io/blog/2020/10/03/%E9%A2%98%E8%A7%A3-CF1221F-%E3%80%90Choose-a-Square%E3%80%91/)\n## \u9898\u610f\n\u5e73\u9762\u4e0a\u6709$n$\u4e2a\u70b9$(x_i,y_i)$\uff0c\u6bcf\u4e2a\u70b9\u6709\u4e00\u4e2a\u6743\u503c$c_i$\uff0c\u8bf7\u6784\u9020\u4e00\u4e2a\u5de6\u4e0b\u89d2\u4e0e\u53f3\u4e0a\u89d2\u5728$y=x$\u4e0a\u7684\u6b63\u65b9\u5f62\uff0c\u4f7f\u5f97\u6b63\u65b9\u5f62\u5185\u7684\u70b9\u7684\u6743\u503c\u548c\u51cf\u53bb\u6b63\u65b9\u5f62\u7684\u8fb9\u6743\u6700\u5927\u3002\n\n> $p.s.$\u8fd9\u91cc\u7684`\u8fb9\u6743`\u53ef\u80fd\u7ffb\u8bd1\u6210`\u8fb9\u957f`\u66f4\u5408\u9002\n\n> \u8fb9\u957f\u53ef\u4ee5\u4e3a$0$\n\n> $1\\le n\\le 5\\cdot 10^5,0\\le x_i,y_i\\le 10^9,-10^6\\le c_i\\le 10^6$\n\n## \u9898\u89e3\n\n\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u5389\u5bb3\u7684\u9898\u76ee\u3002\n\n~~\u9996\u5148\u6211\u4eec\u8981\u660e\u660e\u786e\u4e00\u4e2a\u57fa\u672c\u4e8b\u5b9e\uff08\u96fe\uff1aCF\u9053\u9053\u7ed3\u8bba\u9898~~\n \n\u5047\u8bbe\u6211\u4eec\u6709\u4e00\u4e2a\u6b63\u65b9\u5f62$(L,L)\\to (R,R)$\uff0c\u90a3\u4e48\u6211\u4eec\u6765\u8003\u8651$(x,y)$\u5728\u5176\u5185\u90e8\u7684\u6761\u4ef6\u662f\u4ec0\u4e48\uff1a\n\n$$\\begin{cases}L\\le x\\\\ x\\le R\\\\ L\\le y\\\\ y\\le R\\end{cases}$$\n\n\u6574\u7406\u5f97\u5230$L\\le \\min(x,y),\\max(x,y)\\le R$\uff0c\u56e0\u6b64$x,y$\u7684\u987a\u5e8f\u5e76\u6ca1\u6709\u5173\u7cfb\uff08\u4ece\u6b63\u65b9\u5f62\u7684\u5bf9\u79f0\u6027\u4e5f\u540c\u6837\u53ef\u4ee5\u5f97\u5230\u76f8\u540c\u7684\u7ed3\u8bba\uff09\u3002\n\n\u6240\u4ee5\u6211\u4eec\u628a\u4e00\u4e2a\u70b9$(x,y)$\u770b\u4f5c\u662f\u4e00\u6761\u6743\u503c\u4e3a$c$\uff0c$\\min(x,y)\\to \\max(x,y)$\u7684\u7ebf\u6bb5\u3002\u8bb0$l_i=\\min(x_i,y_i),r_i=\\max(x_i,y_i)$\u90a3\u4e48\u53ea\u6709$[L,R]$\u5b8c\u5168\u5305\u542b$[l_i,r_i]$\uff0c\u624d\u80fd\u7edf\u8ba1$c_i$\u7684\u6743\u503c\u3002\n\n\u9996\u5148\u6839\u636e\u56fd\u9645\u60ef\u4f8b\uff0c\u5bf9$x_i,y_i$\uff0c\u8fdb\u884c\u79bb\u6563\u3002~~\u7531\u4e8e\u662f`CF`\u9898\uff0c\u6211\u4eec\u8981\u591a\u7528\u7528STL~~\n\n\u8fdb\u884c\u79bb\u6563\u8fc7\u540e\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u6240\u6709\u8fb9\u754c\u7684\u79bb\u6563\u503c\u3002\u5f88\u663e\u7136\uff0c\u6b63\u65b9\u5f62\u5728\u82e5\u4e0d\u5728\u8fb9\u754c\u4e0a\uff0c\u6743\u503c\u548c\u5728\u8fb9\u754c\u4e0a\u76f8\u540c\uff0c\u8fb9\u957f\u66f4\u5927\uff0c\u4e0d\u662f\u6700\u4f18\u89e3\u3002\uff08\u53ea\u6709\u4e00\u79cd\u60c5\u51b5\u4e0d\u6ee1\u8db3\uff0c\u7b49\u4e0b\u4f1a\u8bf4\uff09\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8003\u8651\u8fb9\u754c\u3002\n\n\u5047\u8bbe\u6211\u4eec\u6709\u4e00\u4e2a\u7aef\u70b9$L$\uff0c\u90a3\u4e48$L$\u7684\u6700\u5927\u7b54\u6848\u5e94\u8be5\u662f\u591a\u5c11\u5462\uff1f\n\n\u9996\u5148\uff0c\u82e5\u4e00\u6761\u7ebf\u6bb5$[l_i,r_i]$\u53ef\u80fd\u6709\u8d21\u732e\uff0c\u5219\u5fc5\u7136\u6709$L\\le l_i$\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u4ece\u5927\u5f80\u5c0f\u5904\u7406\u3002\n\n\u8bb0$f(R)=\\sum_{L\\le l_i\\land r_i\\le R}c_i$\uff0c\u5219\u663e\u7136$L\\to R$\u7684\u7b54\u6848\u4e3a\n\n$$f(R)-(R-L)=f(R)-R+L$$\n\n\u6211\u4eec\u5e0c\u671b\u8fd9\u4e2a\u67ff\u5b50\u6700\u5927\uff0c\u6b64\u65f6$L$\u5df2\u7ecf\u5b9a\u4f4f\u4e86\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u8981\u6c42$f(R)-R$\u7684\u6700\u5927\u503c\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u3002\u8bb0\u79bb\u6563\u5316\u540e\u4e00\u5171\u6709$siz$\u4e2a\u70b9\uff0c\u8fa3\u4e48\u5148\u628a$i$\u7684\u521d\u503c\u8d4b\u4e3a$-\\text{\u5bf9\u5e94\u7684\u503c}$\uff0c\u5373\u539f\u5f0f\u4e2d\u7684$-R$\uff0c\u56e0\u4e3a\u5f53\u4e00\u6761\u7ebf\u90fd\u6ca1\u6709\u7684\u65f6\u5019\uff0c$f(x)=0$\u3002\n\n\u7136\u540e\u8003\u8651\u52a0\u7ebf\u3002\u4ece\u540e\u5f80\u524d\u52a0\uff0c\u5219$L\\le l$\u5fc5\u7136\u6210\u7acb\uff0c\u53ea\u9700\u8003\u8651$r\\le R$\u7684\u6210\u7acb\u5373\u53ef\u3002\u5f88\u5bb9\u6613\u5f97\u5230\uff0c\u5c31\u662f\u7ed9$[r,siz]$\u5168\u90e8$+=c$\n\n\u518d\u7ef4\u62a4\u4e00\u4e0b\u6700\u5927\u503c\u4ee5\u53ca\u4f4d\u7f6e\u5c31\u597d\u4e86\u3002\n\n\u503c\u5f97\u6ce8\u610f\u7684\u4e00\u70b9\uff0c\u56e0\u4e3a\u8fb9\u957f\u53ef\u4ee5\u7b49\u4e8e\u96f6\uff0c\u6240\u4ee5\u5f53\u6240\u6709\u70b9\u6743\u90fd\u5c0f\u4e8e\u96f6\u65f6\uff0c\u6700\u5927\u503c\u5fc5\u7136\u662f$0$\u3002\u6b64\u65f6\u4e0d\u518d\u8fb9\u754c\u65f6\u53bb\u5230\uff0c\u4e00\u5f00\u59cb\u8d4b\u521d\u503c\u5373\u53ef\u3002\n\n## \u4ee3\u7801\n~~\u7528iPad\u6253\u7684\u5f88\u4e11\u4e0d\u8981\u4ecb\u610f~~\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=5e5+10;\nstruct Point{\n    int l,r,w;\n}P[N];\nstruct node{\n    pair<long long,int>ans;\n    long long tag;\n    int l,r;\n}T[N*8];\n#define lson (x<<1)\n#define rson (x<<1|1)\nvoid pushup(int x){\n    T[x].ans=max(T[lson].ans,T[rson].ans);\n}\nvoid pushdown(int x){\n    if(T[x].tag){\n        T[lson].tag+=T[x].tag;T[lson].ans.first+=T[x].tag;\n        T[rson].tag+=T[x].tag;T[rson].ans.first+=T[x].tag;\n        T[x].tag=0;\n    }\n}\nvector<int>num;\nvoid build(int x,int l,int r){\n    T[x].l=l,T[x].r=r;\n    if(l==r){T[x].ans={-num[l],l};return;}\n    int mid=l+r>>1;\n    build(lson,l,mid);build(rson,mid+1,r);\n    pushup(x);\n}\npair<long long,int>query(int x,int l,int r){\n    if(l<=T[x].l&&T[x].r<=r)return T[x].ans;\n    pushdown(x);\n\tint mid=T[x].l+T[x].r>>1;\n    if(r<=mid)return query(lson,l,r);\n    if(mid<l)return query(rson,l,r);\n    return max(query(lson,l,r),query(rson,l,r));\n}\nvoid upd(int x,int l,int r,int val){\n    if(l<=T[x].l&&T[x].r<=r){T[x].ans.first+=val;T[x].tag+=val;return;}\n    pushdown(x);\n    int mid=T[x].l+T[x].r>>1;\n    if(l<=mid)upd(lson,l,r,val);\n    if(mid<r)upd(rson,l,r,val);\n    pushup(x);\n}\nint n;\n#define pb push_back\nvector<pair<int,int>>v[N*2];\nsigned main(){\n    scanf(\"%d\",&n);\n    for(int i=1,x,y,w;i<=n;i++)\n        scanf(\"%d%d%d\",&x,&y,&w),\n        num.pb(x),num.pb(y),\n        P[i]=(Point){min(x,y),max(x,y),w};\n    sort(num.begin(),num.end());\n    num.resize(unique(num.begin(),num.end())-num.begin());\n    for(int i=1;i<=n;i++){\n        int l=lower_bound(num.begin(),num.end(),P[i].l)-num.begin();\n        int r=lower_bound(num.begin(),num.end(),P[i].r)-num.begin();\n        v[l].pb({r,P[i].w});\n    }\n    build(1,0,num.size()-1);\n    long long ans=0,ansl=2e9,ansr=2e9;\n    for(int i=num.size()-1;i>=0;i--){\n        for(auto to:v[i])\n            upd(1,to.first,num.size()-1,to.second);\n        auto ret=query(1,i,num.size()-1);\n        ret.first+=num[i];\n        if(ret.first>ans)\n            ans=ret.first,\n            ansl=num[i],ansr=num[ret.second];\n    }\n    cout<<ans<<\"\\n\"<<ansl<<\" \"<<ansl<<\" \"<<ansr<<\" \"<<ansr;\n}\n```",
        "postTime": 1601736921,
        "uid": 174304,
        "name": "jun\u5934\u5409\u5409",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1221F \u3010Choose a Square\u3011"
    },
    {
        "content": "\u9996\u5148\u8bbe\u6b63\u65b9\u5f62\u5de6\u4e0b\u89d2\u5750\u6807\u4e3a$(l,l)$\uff0c\u53f3\u4e0a\u89d2\u5750\u6807\u662f$(r,r)$,\n\n\u90a3\u4e48\u5bf9\u4e8e\u6240\u6709\u6ee1\u8db3$l \\leq a,b \\leq r $\u7684\u70b9$(a,b)$\uff0c\u90fd\u5728\u8fd9\u4e2a\u6b63\u65b9\u5f62\u5185\u90e8\u3002\n\n\u5373$min(a,b) \\geq l , max(a,b) \\leq r$\u540c\u65f6\u6210\u7acb\u3002\n\n\u6240\u4ee5\uff0c\u4e00\u4e2a\u70b9\u5c31\u53d8\u6210\u4e00\u6bb5$[min(a,b) , max(a,b)]$\u7684\u533a\u95f4\u3002\n\n\u539f\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a\n\n> \u5728\u7ebf\u6bb5\u4e0a\u627e\u5230\u4e00\u4e2a\u533a\u95f4$[L,R]$\u4f7f\u5f97\u8fd9\u4e2a\u533a\u95f4\u5185\u6240\u6709\u7ebf\u6bb5\u6743\u503c\u548c\u52a0\u4e0a$R-L$\u7684\u503c\u6700\u5c0f\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u5148\u4e0d\u7ba1$R-L$\u8fd9\u90e8\u5206\u8d21\u732e\uff0c\u5176\u4ed6\u7684\u4e1c\u897f\u90fd\u53ef\u4ee5\u79bb\u6563\u5316\u540e\u4ece\u672b\u5c3e\u626b\u5230$1$\uff0c\u6bcf\u4e2a\u9047\u5230\u533a\u95f4\u5f00\u5934$l$\uff0c\u5c31\u5c06\u533a\u95f4\u7ed3\u5c3e$r$ \u5230\u672b\u5c3e\u533a\u95f4 $+w_i$\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u9700\u8981\u7ef4\u62a4\u4e00\u68f5\u7ebf\u6bb5\u6811\u8bb0\u5f55\u6700\u5927\u503c\u53ca\u5176\u6240\u5728\u7f16\u53f7\u3002\n\n\u5bf9\u4e8e\u4e00\u6bb5\u786e\u5b9a\u7684\u533a\u95f4\u7684\u5de6\u7aef\u70b9\u56fa\u5b9a\uff0c\u53f3\u7aef\u70b9\u53ea\u9700\u8981\u5728\u7ebf\u6bb5\u6811\u91cc\u4e00\u5f00\u59cb\u52a0\u4e0a$-R$\u7684\u8d21\u732e\u5373\u53ef\uff0c\u63a5\u4e0b\u53bb\u7684\u65b9\u6cd5\u5c31\u540c\u4e0a\u4e86\u3002\n\n\u6bd4\u8f83\u5751\u7684\u5730\u65b9\u662f\uff0c\u79bb\u6563\u5316\u540e\u5143\u7d20\u4e2a\u6570\u4f1a\u5230$2n$\u7ea7\u522b\uff0c\u6240\u4ee5\u9700\u8981\u5f00$10^6$\u7ea7\u522b\u7684\u6570\u7ec4\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u662f$O(n log_2 n)$\n\n\n```cpp\n# include <bits/stdc++.h>\n# define int long long\n# define inf (1e14)\nusing namespace std;\nconst int N=1e6+10;\nint n;\nvector< pair<int,int> >v[N];\nvector< int >tmp;\nstruct Seg {\n\tint ret,id,tag;\n\tSeg() { ret=-inf;}\n}tr[N<<2];\nstruct node{ int l,r,w; }a[N];\n# define lson ls,l,mid\n# define rson rs,mid+1,r\n# define mid (l+r>>1)\n# define ls (x<<1)\n# define rs (x<<1|1)\nvoid up(int x) {\n\ttr[x].ret = max(tr[ls].ret,tr[rs].ret);\n\tif (tr[ls].ret < tr[rs].ret) tr[x].id = tr[rs].id;\n\telse tr[x].id = tr[ls].id;\n}\nvoid down(int x) {\n\tif (!tr[x].tag) return;\n\ttr[ls].tag+=tr[x].tag; tr[ls].ret+=tr[x].tag;\n\ttr[rs].tag+=tr[x].tag; tr[rs].ret+=tr[x].tag;\n\ttr[x].tag=0;\n}\nvoid build(int x,int l,int r) {\n\tif (l==r) { tr[x].ret = -tmp[l-1],tr[x].id=l; return;}\n\tbuild(lson); build(rson);\n\tup(x);\n}\nvoid update(int x,int l,int r,int opl,int opr,int d) {\n\tif (opl<=l&&r<=opr) {\n\t\ttr[x].tag+=d; tr[x].ret+=d;\n\t\treturn;\n\t}\n\tdown(x);\n\tif (opl<=mid) update(lson,opl,opr,d);\n\tif (opr>mid) update(rson,opl,opr,d);\n\tup(x);\n}\npair<int,int> query(int x,int l,int r,int opl,int opr) {\n\tif (opl<=l && r<=opr) {\n\t\treturn make_pair(tr[x].ret,tr[x].id);\n\t}\n\tdown(x);\n\tpair<int,int> ret = make_pair(-inf,-1);\n\tif (opl<=mid) ret = max(ret,query(lson,opl,opr));\n\tif (opr>mid) ret= max(ret,query(rson,opl,opr));\n\treturn ret;\n}\nsigned main() {\n\tscanf(\"%lld\",&n);\n\tfor (int i=1;i<=n;i++) {\n\t\tint x,y,c; scanf(\"%lld%lld%lld\",&x,&y,&c);\n\t\ttmp.push_back(x); tmp.push_back(y);\n\t\ta[i] = (node) {min(x,y),max(x,y),c};\n\t}\n\tint T = 0;\n\tsort(tmp.begin(),tmp.end());\n\ttmp.erase(unique(tmp.begin(),tmp.end()),tmp.end());\n\tfor (int i=1;i<=n;i++) {\n\t\tint l = lower_bound(tmp.begin(),tmp.end(),a[i].l) - tmp.begin() + 1;\n\t\tint r = lower_bound(tmp.begin(),tmp.end(),a[i].r) - tmp.begin() + 1;\n\t\tT=max(T,r);\n\t\tv[l].push_back(make_pair(r,a[i].w));\n\t}\n\tbuild(1,1,T);\n\tint ans = -inf,ansl,ansr;\n\tfor (int i=T;i>=1;i--) {\n\t\tfor (int j=0;j<v[i].size();j++) {\n\t\t\tpair<int,int> to = v[i][j];\n\t\t\tupdate(1,1,T,to.first,T,to.second);\n\t\t}\n\t\tpair<int,int>ret = query(1,1,T,i,T);\n\t\tret.first +=tmp[i-1];\n\t\tif (ret.first > ans) {\n\t\t\tans  = ret.first;\n\t\t\tansl = tmp[i-1]; ansr = tmp[ret.second-1];\n\t\t}\n\t}\n\tif (ans < 0) {\n\t\tans = 0; ansl=ansr=tmp[T-1]+1;\n\t}\n\tprintf(\"%lld\\n%lld %lld %lld %lld\\n\",ans,ansl,ansl,ansr,ansr);\n\treturn 0;\n}\n```",
        "postTime": 1570114052,
        "uid": 16456,
        "name": "ljc20020730",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1221F \u3010Choose a Square\u3011"
    },
    {
        "content": "[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/CF1221F)  \n\n[\u535a\u5ba2\u98df\u7528\u66f4\u4f73\u54e6](https://www.cnblogs.com/windseekerblog/p/16556342.html)\n\n\u849f\u84bb\u771f\u7684\u662f\u83dc\u5566\uff0c\u82b1\u4e00\u5929\u65f6\u95f4\u624d\u8fc7\u8fd9\u9053\u9898\u3002\n\n\u5982\u679c\u60a8\u662f\u5de8\u4f6c\uff0c\u8fd8\u8bf7\u79fb\u6b65\u81f3\u697c\u4e0a@jun\u5934\u5409\u5409\u7684\u9898\u89e3\u3002\n\n### \u9898\u76ee\u5927\u610f\n\n\u6709 $n$ \u4e2a\u70b9\u6c42\u6784\u9020\u4e00\u4e2a\u5185\u90e8\u70b9\u6743\uff08\u5305\u542b\u8fb9\u754c\uff09\u51cf\u53bb\u8fb9\u957f\u6700\u5927\u7684\uff0c\u5bf9\u89d2\u7ebf\u5728 $y=x$ \u4e0a\u7684\u6b63\u65b9\u5f62\u3002\u8f93\u51fa\u5185\u90e8\u70b9\u6743\u51cf\u53bb\u8fb9\u957f\u7684\u503c\uff0c\u4ee5\u53ca\u6b63\u65b9\u5f62\u5de6\u4e0b\u89d2\u548c\u53f3\u4e0a\u89d2\u7684\u5750\u6807\u3002\n\n### \u6838\u5fc3\u601d\u8def\n\n\u6b63\u65b9\u5f62\u9700\u8981\u8003\u8651\u76f4\u7ebf $y=x$ \u4e24\u8fb9\u7684\u64cd\u4f5c\uff0c\u65b9\u4fbf\u8d77\u89c1\uff0c\u6839\u636e\u6b63\u65b9\u5f62\u7684\u5bf9\u79f0\u6027\uff0c\u6211\u4eec\u76f4\u63a5\u628a\u5728\u76f4\u7ebf\u4e0b\u65b9\u7684\u70b9\u5173\u4e8e\u76f4\u7ebf\u5bf9\u79f0\u5230\u76f4\u7ebf\u4e0a\u65b9\uff08\u5c06\u6a2a\u7eb5\u5750\u6807\u4ea4\u6362\u5373\u53ef\uff09\uff0c\u90a3\u4e48\u8fd9\u9053\u9898\u5c31\u53d8\u6210\u4e86\u6c42\u4e00\u4e2a\u7b49\u8170\u76f4\u89d2\u4e09\u89d2\u5f62\u3002\n\n\u8003\u8651\u5230\u5982\u679c\u4e09\u89d2\u5f62\u7684\u8fb9\u754c\u4e0a\u6ca1\u6709\u70b9\u7684\u8bdd\uff0c\u76f8\u5f53\u4e8e\u5728\u4e00\u4e2a\u8fb9\u754c\u6709\u70b9\u7684\u4e09\u89d2\u5f62\u7684\u57fa\u7840\u4e0a\u8fdb\u884c\u6269\u5927\uff0c\u8fb9\u6743\u53d8\u5927\uff0c\u663e\u7136\u8f83\u52a3\uff0c\u6240\u4ee5\u6bcf\u6b21\u90fd\u8003\u8651\u8fb9\u4e0a\u6709\u70b9\u7684\u60c5\u51b5\u3002\n\n\u7531\u4e8e\u8fb9\u90fd\u662f\u5e73\u884c\u4e8e $x$ \u8f74\u548c $y$ \u8f74\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u60f3\u5230\u7528\u7ebf\u6bb5\u6811\u5bb6\u626b\u63cf\u7ebf\u7684\u65b9\u6cd5\u6c42\u89e3\u3002\n\n### \u5177\u4f53\u64cd\u4f5c\n\n\u6211\u4eec\u6309\u7167 $y$ \u4e3a\u7b2c\u4e00\u5173\u952e\u5b57\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u3002\n\n\u5bf9 $x$ \u548c $y$ \u5206\u522b\u8fdb\u884c\u79bb\u6563\u64cd\u4f5c\uff0c\u4ee5\u79bb\u6563\u540e\u7684 $x$ \u5e8f\u5217\u7684\u4e0b\u6807\u4e3a\u53f6\u5b50\u8282\u70b9\u5efa\u7acb\u7ebf\u6bb5\u6811\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u4e24\u79cd\u64cd\u4f5c\uff1a\n\n1. \u5728\u5f53\u524d\u626b\u63cf\u7ebf\u4e0a\u52a0\u70b9\u3002\n\n\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0c\u7531\u4e8e\u65b0\u52a0\u70b9\u53ea\u4f1a\u88ab\u4e09\u89d2\u5f62\u9876\u70b9\u7684 $x$ \u5750\u6807\u66f4\u5c0f\u7684\u5305\u542b\uff0c\u6240\u4ee5\u6211\u4eec\u8fdb\u884c\u533a\u95f4\u52a0\uff0c\u4ece $1$ \u5230 $idx$ \u52a0 $w$\u3002\uff08$idx$ \u8868\u793a\u79bb\u6563\u540e\u7684\u4f4d\u7f6e\uff09\n\n2. \u626b\u63cf\u7ebf\u4e0a\u79fb\uff0c\u5e76\u65b0\u52a0\u70b9\u3002\n\n\u8fd9\u79cd\u60c5\u51b5\u5c31\u6bd4\u8f83\u9ebb\u70e6\u4e86\u3002\n\n- \u7531\u4e8e\u4e0a\u4e00\u6761\u7ebf\u5df2\u7ecf\u5904\u7406\u5b8c\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u5bf9\u5176\u8be2\u95ee\u53d6 $\\max$ \uff0c\u53d6\u4ece $1$ \u5230 $x$ \u7684\u6700\u5927\u503c\u3002\n\n- \u626b\u63cf\u7ebf\u4e0a\u79fb\uff0c\u610f\u5473\u7740\u6bcf\u4e00\u4e2a $x$ \u4e0a\u5efa\u7acb\u4e09\u89d2\u5f62\u7684\u8fb9\u957f\u4f1a\u589e\u52a0\uff0c\u6211\u4eec\u5206\u4e24\u90e8\u5206\u5904\u7406\uff0c\u4e00\u90e8\u5206\u662f\u4e0a\u4e00\u6b21\u7ebf\u4e0a\u5305\u542b\u7684 $x$ ,\u53e6\u4e00\u90e8\u5206\u662f\u65b0\u52a0\u7684 $x$ ,\u5206\u522b\u4e3a\u56fe\u4e2d\u6807\u84dd\u548c\u6807\u7ea2\u7684\u533a\u57df\u3002\u84dd\u8272\u533a\u95f4\u52a0\uff0c\u7ea2\u8272\u66b4\u529b\u679a\u4e3e\u4fee\u6539\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6tsnod55.png)\n\n\u8fd8\u8981\u8bb0\u5f97\u9884\u5904\u7406\u7b2c\u4e00\u6839\u7ebf\u3002\n\n### code\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define mp make_pair\n#define fi first\n#define se second\n#define ls rt<<1\n#define rs rt<<1|1\n#define lson ls,l,mid\n#define rson rs,mid+1,r\nusing namespace std;\nconst int N=5e5+1e4,Inf=1e15+7;\n\nint read(){\n\tint res=0,f=1;char c;\n\tfor(;!isdigit(c);c=getchar()) if(c=='-') f=-1;\n\tfor(;isdigit(c);c=getchar()) res=(res<<1)+(res<<3)+(c^48);\n\treturn res*f;\n}\n\nint n,Px[N],cntx,Py[N],cnty,last=-1;\nstruct node{\n\tint x,y,w;\n\tbool operator < (const node &b)const{return y==b.y?x<b.x:y<b.y;}\n}a[N];\n\nstruct TREE{\n\tint sum,id,lazy;\n}t[N<<2];\nvoid push_up(int rt){\n\tt[rt].sum=max(t[ls].sum,t[rs].sum);\n\tt[rt].id=t[ls].sum>t[rs].sum?t[ls].id:t[rs].id;\n}\nvoid push_down(int rt,int l,int r){\n\tif(t[rt].lazy){\n\t\tint k=t[rt].lazy,mid=(l+r)>>1,Len=mid-l+1,Ren=r-mid;\n\t\tt[ls].sum+=k,t[rs].sum+=k,t[ls].lazy+=k,t[rs].lazy+=k,t[rt].lazy=0; \n\t}\n}\nvoid build(int rt,int l,int r){\n\tif(l==r) return t[rt].id=l,void();\n\tint mid=(l+r)>>1;build(lson),build(rson),push_up(rt);\n}\nvoid update(int rt,int l,int r,int ul,int ur,int k){\n\tif(ul<=l&&r<=ur) return t[rt].sum+=k,t[rt].lazy+=k,void();\n\tpush_down(rt,l,r);int mid=(l+r)>>1;\n\tif(ul<=mid) update(lson,ul,ur,k);\n\tif(mid<ur) update(rson,ul,ur,k);\n\tpush_up(rt);\n}\nvoid update(int rt,int l,int r,int ul,int ur){\n\t\n}\npair<int,int> query(int rt,int l,int r,int ql,int qr){\n\tif(ql>r||l>qr) return mp(0ll,-1ll);\n\tif(ql<=l&&r<=qr) return mp(t[rt].sum,t[rt].id);\n\tint mid=(l+r)>>1;\n\treturn max(query(lson,ql,qr),query(rson,ql,qr));\n}\n\npair<int,int> ans;\nint upup;\n\nsigned main(){\n\tn=read();upup=1e9+1,ans.se=1e9+1;//\u849f\u84bb\u6bd4\u8f83\u83dc\uff0c\u521d\u59cb\u5316\u8fd8\u8bf7\u53c2\u8003\u5176\u4ed6\u5de8\u4f6c\uff0c\u8fd9\u6837\u5361\u6570\u636e\u4e0a\u754c\u4e5f\u53ef\u4ee5\u8fc7\n\tfor(int i=1;i<=n;i++){\n\t\ta[i].x=read(),a[i].y=read(),a[i].w=read();\n\t\tif(a[i].x>a[i].y) swap(a[i].x,a[i].y);\n\t\tPx[++cntx]=a[i].x;Py[++cnty]=a[i].y;\n\t}\n\tsort(a+1,a+n+1);sort(Px+1,Px+n+1);sort(Py+1,Py+n+1);\n\tcntx=unique(Px+1,Px+n+1)-Px-1;\n\tcnty=unique(Py+1,Py+n+1)-Py-1;\n\tbuild(1,1,cntx);//\u4ee5\u79bb\u6563\u540e\u7684x\u4e3a\u53f6\u5b50\u8282\u70b9\u5efa\u6811 \n\tint ur1=upper_bound(Px+1,Px+cntx+1,a[1].y)-Px-1;\n\tfor(int i=1;i<=ur1;i++) update(1,1,cntx,i,i,Px[i]-a[1].y);\n\tint idx,_idx,idy,_idy;\n\tfor(int i=1;i<=n+1;i++){\n\t\tif(i<=n) idx=lower_bound(Px+1,Px+cntx+1,a[i].x)-Px,idy=lower_bound(Py+1,Py+cnty+1,a[i].y)-Py;\n\t\tif((i!=1&&idy!=_idy)||i==n+1){//\u626b\u63cf\u7ebf\u4e0a\u79fb\n\t\t\tlast=a[i-1].y;\n\t\t\tpair<int,int> sum=query(1,1,cntx,1,_idx);\n\t\t\tif(sum.fi>ans.fi) ans.fi=sum.fi,ans.se=Px[sum.se],upup=a[i-1].y;\n\t\t\tif(i==n+1) break;\n\t\t\tint ur=upper_bound(Px+1,Px+cntx+1,a[i-1].y)-Px-1,uR=upper_bound(Px+1,Px+cntx+1,a[i].y)-Px-1;\n\t\t\t//ur,uR\u5206\u522b\u8868\u793a\u4e24\u6761\u7ebf\u4e0a\u6700\u9760\u53f3\u7684\u5b58\u5728\u7684x\n\t\t\tupdate(1,1,cntx,1,ur,a[i-1].y-a[i].y);//\u84dd\u8272\u90e8\u5206\n\t\t\tfor(int j=ur+1;j<=uR;j++) update(1,1,cntx,j,j,Px[j]-a[i].y);//\u7ea2\u8272\u90e8\u5206\n\t\t}\n\t\tif(i<=n) update(1,1,cntx,1,idx,a[i].w);\n\t\t_idx=idx,_idy=idy;\n\t}\n\tprintf(\"%lld\\n%lld %lld %lld %lld\\n\",ans.fi,ans.se,ans.se,upup,upup);\n\treturn 0;\n}\n/*\n7\n5461255 4302067 16\n1325913 2652299 15\n1735 2640383 11\n5293204 2140683 29\n3729701 5526121 14\n2769558 6182111 22\n4396749 3148205 17\n*/\n/*\n0\n500000 500000 500000 500000\n*/\n```",
        "postTime": 1659754113,
        "uid": 557385,
        "name": "cjlak1o1",
        "ccfLevel": 0,
        "title": "CF1221F Choose a Square \u9898\u89e3"
    },
    {
        "content": "\u9996\u5148\uff0c\u6211\u4eec\u628a\u6240\u6709 $y<x$ \u7684\u70b9\u6309\u76f4\u7ebf $y=x$ \u5bf9\u79f0\uff0c\u8fd9\u6837\u663e\u7136\u4e0d\u4f1a\u5f71\u54cd\u7b54\u6848\u7684\u8ba1\u7b97\u3002\n\n\u7136\u540e\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u753b\u4e00\u4e2a\u7b49\u8170\u76f4\u89d2\u4e09\u89d2\u5f62\uff0c\u4f7f\u5f97\u5176\u5185\u90e8\u7684\u70b9\u7684\u6743\u503c\u548c\u51cf\u76f4\u89d2\u8fb9\u6700\u5927\u3002\n\n\n\u6211\u4eec\u628a\u4e0ex\u8f74\u5e73\u884c\u7684\u90a3\u6761\u4e09\u89d2\u5f62\u7684\u8fb9\u53eb\u505a\u6a2a\u8fb9\uff0c\u53e6\u4e00\u6761\u53eb\u505a\u7ad6\u8fb9\u3002\n\n\n\u8003\u8651\u6211\u4eec\u5df2\u7ecf\u786e\u5b9a\u4e86\u4e09\u89d2\u5f62\u7684\u7ad6\u8fb9\u6240\u5728\u7684 $x$ \u503c\uff0c\u73b0\u5728\u8981\u622a\u4e00\u6761\u6a2a\u8fb9\uff0c\u4f7f\u5f97\u5176\u5185\u90e8\u7684\u70b9\u7684\u6743\u503c\u548c\u51cf\u53bb ( (\u6a2a\u8fb9\u548c\u7ad6\u8fb9\u7684\u4ea4\u70b9\u7684 $x$ \u503c) \u548c (\u7ad6\u8fb9\u7684\u6240\u5728\u7684 $x$ \u503c) \u7684\u5dee)\u6700\u5927\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vy50wchl.png)\n\n\u7eff\u8272\u7684\u662f\u7ad6\u8fb9\uff0c\u9ec4\u8272\u7684\u662f\u6a2a\u8fb9\uff0c\u84dd\u8272\u7684\u662f\u70b9\u3002\n\n\u7136\u540e\u6709\u4e00\u4e2a\u975e\u5e38\u663e\u7136\u7684\u7ed3\u8bba\u662f\u6211\u4eec\u7684\u8fd9\u4e24\u6761\u8fb9\u90fd\u662f\u622a\u5728\u70b9\u4e0a\u7684\u3002\n\n\u4e8e\u662f\u6211\u4eec\u626b\u63cf\u7ebf\u4e00\u4e0b\u4ece\u5927\u5230\u5c0f\u679a\u4e3e\u6240\u6709\u70b9\u7684 $x$ \u503c,\u5c1d\u8bd5\u628a\u7ad6\u8fb9\u653e\u5728\u8fd9\u91cc\uff0c\u7136\u540e\u6211\u4eec\u9700\u8981\u77e5\u9053\u6a2a\u8fb9\u622a\u5728\u54ea\u91cc\u53ef\u4ee5\u4f7f\u5f97\u7b54\u6848\u6700\u5927\u3002\n\n\u6211\u4eec\u8003\u8651\u76f4\u63a5\u7528\u6570\u7ec4\u7ef4\u62a4\u622a\u5728\u6bcf\u4e00\u4e2a $y$ \u7684\u65f6\u5019\u7684\u7b54\u6848\uff0c\u6bcf\u6b21\u5bf9\u4e8e\u73b0\u5728\u7684\u7ad6\u8fb9\u6240\u5728\u7684  $x$ \u503c\u627e\u51fa\u7b2c\u4e00\u4e2a\u6bd4\u5b83\u5927\u7684\u70b9\u7684 $y$ \u503c\uff0c\u7136\u540e\u5c31\u662f\u5bf9\u4e8e\u6bcf\u4e2a\u540e\u7f00\u67e5\u8be2\u6700\u5927\u503c\u3002\n\n\u8003\u8651\u600e\u4e48\u5728\u7ad6\u8fb9\u79fb\u52a8\u65f6\u7ef4\u62a4\u8fd9\u4e2a\u6570\u7ec4\uff0c\u6211\u4eec\u4f7f\u7528\u7ebf\u6bb5\u6811\uff0c\u6bcf\u6b21\u628a\u73b0\u5728\u7ad6\u7ebf\u4e0a\u7684\u70b9\u5bf9\u5e94 $y$ \u503c\u52a0\u4e0a\u5176\u6743\u503c\uff0c\u7136\u540e\u8003\u8651\u8fd8\u8981\u51cf\u53bb\u6bcf\u4e2a $y$ \u503c\u548c\u5f53\u524d $x$ \u7684\u5dee\uff0c\u4e0d\u597d\u7ef4\u62a4\uff0c\u6211\u4eec\u628a\u5b83\u5dee\u5206\u4e00\u4e0b\uff0c\u53d8\u6210\u5bf9\u4e8e\u6bcf\u4e2a\u540e\u7f00\u67e5\u8be2\u6700\u5927\u524d\u7f00\u548c\uff0c\u4e0d\u4f1a\u7684\u53ef\u4ee5\u5148\u5b66\u4e00\u5b66\u533a\u95f4\u6700\u5927\u5b50\u6bb5\u548c\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u53ef\u4ee5\u770b\u4ee3\u7801\uff0c\u5c31\u662f\u5199\u7684\u6bd4\u8f83\u5c4e\uff0c\u4e0d\u591f\u4f18\u7f8e\uff08\u867d\u7136\u662f 114514 \u500d\u5e38\u6570\u7684\u7ebf\u6bb5\u6811\uff0c\u4f46\u662f\u6700\u6162\u7684\u70b9\u8fd8\u662f 1.5s \u5de6\u53f3\uff09\n\n\u8fd8\u6709\u4e00\u4e2a\u611f\u89c9\u6bd4\u8f83\u6709\u8da3\u7684\u5185\u5bb9\u662f\u7b54\u6848\u7684\u521d\u59cb\u5316\uff0c\u53ef\u4ee5\u770b\u770b\u4ee3\u7801\uff08\uff08\uff08\n\n\n\n\u867d\u7136\u662f\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define mid ((l+r)>>1)\n#define ls p<<1\n#define rs p<<1|1\n#define hor(i,l,r) for(register int i=l;i<=r;i++)\n#define lor(i,l,r) for(register int i=l;i>=r;i--)\nusing namespace std;\nconst int N=5e5+10;\nint a[N],n,cnt,ans,mp[N],_x,_y;\nstruct node{\n\tint lsum,sum,pos;\n\tvoid out(){printf(\"%lld %lld %lld\\n\",lsum,sum,pos);}\n};struct sgt{\n\tnode t[4*N];\n\tnode merge(node a,node b){node rt;\n\t\tif(a.lsum>(a.sum+b.lsum)) rt=(node){a.lsum,a.sum+b.sum,a.pos};\n\t\telse rt=(node){a.sum+b.lsum,a.sum+b.sum,b.pos};return rt;\n\t}void build(int p,int l,int r){\n\t\tif(l==r){\n\t\t\tt[p].lsum=t[p].sum=-(a[l]-a[l-1]);\n\t\t//\tprintf(\"%lld %lld\\n\",l,t[p].sum);\n\t\t\treturn (void)(t[p].pos=l);\n\t\t}build(ls,l,mid);build(rs,mid+1,r);\n\t\tt[p]=merge(t[ls],t[rs]);\n\t}void update(int p,int l,int r,int pos,int v){\n\t\tif(l==r) return (void)(t[p].lsum=t[p].sum=v);\n\t\tif(pos<=mid) update(ls,l,mid,pos,v);\n\t\tif(pos>mid) update(rs,mid+1,r,pos,v);\n\t\tt[p]=merge(t[ls],t[rs]);\n\t}void add(int p,int l,int r,int pos,int v){\n\t\tif(l==r){\n\t\t\tt[p].lsum+=v;\n\t\t\tt[p].sum+=v;\n\t\t\t//printf(\"!!!!%d %d %d\\n\",t[p].sum,l,v);\n\t\t\treturn;\n\t\t}if(pos<=mid) add(ls,l,mid,pos,v);\n\t\telse add(rs,mid+1,r,pos,v);\n\t\tt[p]=merge(t[ls],t[rs]);\n\t//\tprintf(\"!!%d %d %d %d %d\\n\",p,l,r,pos,v);\n\t}node query(int p,int l,int r,int L,int R){\n\t//\tprintf(\"%d %d %d %d %d %d\\n\",p,l,r,L,R,t[p].sum);\n\t\tif(L<=l&&r<=R) return t[p];\n\t\tif(R<=mid) return query(ls,l,mid,L,R); \n\t\tif(mid<L) return query(rs,mid+1,r,L,R);\n\t\treturn merge(query(ls,l,mid,L,R),query(rs,mid+1,r,L,R));\n\t}\n}T;\nstruct point{\n\tint x,y,c;\n}p[N];\nbool cmp(point a,point b){return a.x>b.x;}\nsigned main(){\n\tscanf(\"%lld\",&n);\n\thor(i,1,n){\n\t\tscanf(\"%lld%lld%lld\",&p[i].x,&p[i].y,&p[i].c);\n\t\tif(p[i].x<=n+1&&p[i].y<=n+1&&p[i].x==p[i].y) mp[i]=1;\n\t\tif(p[i].y<p[i].x) swap(p[i].x,p[i].y);a[i]=p[i].y;\n\t}sort(a+1,a+n+1);cnt=unique(a+1,a+1+n)-a-1;\n\tT.build(1,1,cnt);\n\tint lst=0;sort(p+1,p+n+1,cmp);\n\thor(i,1,n+1) if(!mp[i]) _x=_y=i;\n//\thor(j,1,cnt) printf(\"%d\\n\",T.query(1,1,cnt,j,j).sum);\n\thor(i,1,n){\n\t\tif(i!=n&&p[i+1].x==p[i].x) continue;\n\t\thor(j,lst+1,i){\n\t\t\tint ad=lower_bound(a+1,a+cnt+1,p[j].y)-a;\n\t\t\tT.add(1,1,cnt,ad,p[j].c);\n\t\t//\tprintf(\"%d %d\\n\",p[j].c,ad);\n\t\t}\n\t\tlst=i;\n\t\tint pos=lower_bound(a+1,a+cnt+1,p[i].x)-a;if(pos>cnt) break;\n\t//\thor(j,1,cnt) printf(\"%d \",T.query(1,1,cnt,j,j).sum);printf(\"\\n\");\n\t\tT.add(1,1,cnt,pos,a[pos]-a[pos-1]);\n\t\tT.add(1,1,cnt,pos,-(a[pos]-p[i].x));\n\t\tnode pp=T.query(1,1,cnt,pos,cnt); \n\t//\thor(j,1,cnt) printf(\"%d \",T.query(1,1,cnt,j,j).sum);printf(\"\\n\");\n\t\tT.add(1,1,cnt,pos,(a[pos]-p[i].x));\n\t\tT.add(1,1,cnt,pos,-(a[pos]-a[pos-1]));\n\t\t//printf(\"%d %d %d\\n\",pp.sum,pp.lsum,pp.pos);\n\t\tif(pp.lsum>ans) _x=p[i].x,_y=a[pp.pos],ans=pp.lsum;\n\t}printf(\"%lld\\n\",ans);\n\tprintf(\"%lld %lld %lld %lld\",_x,_x,_y,_y);\n\treturn (0-0);\n}\n\n\n\n```\n",
        "postTime": 1683511924,
        "uid": 498526,
        "name": "htssm",
        "ccfLevel": 4,
        "title": "CF1221F"
    },
    {
        "content": "upd\uff1a\u53e5\u672b\u52a0\u4e86\u53e5\u53f7\uff08\u3002\n\n\u6bd2\u7624\u626b\u63cf\u7ebf/tuu\u3002\n\n\u9898\u610f\u8bf4\u7684\u5f88\u6e05\u695a\u4e86\uff0c\u7136\u540e\u6ce8\u610f\u4e00\u4e0b **\u6b63\u65b9\u5f62\u8fb9\u957f\u53ef\u4ee5\u662f 0**\u3002\n\n\u6211\u4eec\u77e5\u9053\u4e00\u4e2a\u70b9 $(x,y)$ \u5728\u6b63\u65b9\u5f62 $(l,l)\\rightarrow(r,r)$ \u5185\u65f6\u6709 $l\\leq x,y\\leq r$\u3002\n\n\u7136\u540e\u8003\u8651\u4e00\u6761\u76f4\u7ebf $y=x$\uff0c\u6211\u4eec\u5c06\u5176\u4e0b\u7684\u70b9\u5168\u90e8\u6cbf\u5b83\u5bf9\u79f0\u7ffb\u5230\u4e0a\u9762\u53bb\u8fd9\u6837\u5c31\u6709 $x\\leq y$\uff0c\u8fde\u63a5 $(x,y)$ \u548c $(y,x)$ \u5f97\u5230\u4e00\u6761\u6743\u503c\u4e3a $c$ \u7684\u7ebf\u6bb5\uff0c\u8fd9\u6837\u5c31\u5c06\u9898\u610f\u5316\u4e3a\u88ab\u6b63\u65b9\u5f62\u5305\u542b\u7684\u8fb9\u7684\u8fb9\u6743\u548c\u4e0e\u6b63\u65b9\u5f62\u8fb9\u957f\u7684\u5dee\u3002\n\n\u5177\u4f53\u6765\u8bf4\uff0c\u5c31\u662f\u6c42\n$$\\sum\\limits_{i\\in[1,n],l\\leq l_i,r_i\\leq r}c_i-r+l$$\n\n\u7684\u6700\u5927\u503c\u3002\n\n$l$ \u4e0d\u53d8\uff0c\u5c31\u53ea\u7528\u6c42\u524d\u9762\u90a3\u4e00\u5768\u7684\u6700\u5927\u503c\u4e86\u3002\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u626b\u63cf\u7ebf\u4e86\uff0c\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u3002\n\n\u8bbe\u79bb\u6563\u5316\u540e\u6709 $m$ \u4e2a\u70b9\uff0c\u4ece\u540e\u5f80\u524d\u628a\u7ebf\u52a0\u8fdb\u53bb\uff0c\u663e\u7136\u6709  $l_i>l$\uff0c\u90a3\u4e48\u53ea\u8981\u8ba9 $r_i<r$ \u5373\u53ef\uff0c\u5c06 $[r_i,m]+c$\uff0c\u67e5\u8be2 $[i,m]$\u3002\n\n\u7136\u540e\u7ef4\u62a4\u4e00\u4e0b\u6700\u5927\u503c\uff0c\u4f4d\u7f6e\u5373\u53ef\uff0c\u6ce8\u610f\u6700\u5927\u503c\u5c0f\u4e8e 0 \u65f6\u8981\u7279\u5224\u4e00\u4e0b\u5373\u53ef\u3002\n\ncode:\n\n```cpp\n// Problem: CF1221F Choose a Square\n// Contest: Luogu\n// URL: https://www.luogu.com.cn/problem/CF1221F\n// Memory Limit: 250 MB\n// Time Limit: 6000 ms\n// \n// Powered by CP Editor (https://cpeditor.org)\n\n#include <bits/stdc++.h>\n#define int long long\n#define inl inline\n#define rep(i,a,b) for(int i=(a),i##end=(b);i<=i##end;++i)\n#define pre(i,a,b) for(int i=(a),i##end=(b);i>=i##end;--i)\n#define pii pair<int,int>\nusing namespace std;\nconst int N=1e6+10,inf=1e13;\nint n,tag[N<<2];\n#define s first\n#define id second\npii t[N<<2];\nstruct Node{\n\tint x,y,c;\n}a[N];\nvector<int>v;\nvector<pii>g[N];\nnamespace tree{\n\t#define ls k<<1\n\t#define rs k<<1|1\n\t#define mid ((l+r)>>1)\n\t#define pushup(k)t[k]=make_pair(max(t[ls].s,t[rs].s),t[ls].s<t[rs].s?t[rs].id:t[ls].id)\n\tinl void pushdown(int k,int l,int r){\n\t\tif(!tag[k])return ;\n\t\ttag[ls]+=tag[k];tag[rs]+=tag[k];\n\t\tt[ls].s+=tag[k];t[rs].s+=tag[k];\n\t\ttag[k]=0;\n\t}\n\tinl void build(int k,int l,int r){\n\t\tif(l==r){t[k]=make_pair(-v[l-1],l);return;}\n\t\tbuild(ls,l,mid);build(rs,mid+1,r);pushup(k);\n\t}\n\tinl void update(int k,int l,int r,int x,int y,int v){\n\t\tif(x>r||y<l)return ;\n\t\tif(x<=l&&y>=r){tag[k]+=v;t[k].s+=v;return ;}\n\t\tpushdown(k,l,r);update(ls,l,mid,x,y,v);update(rs,mid+1,r,x,y,v);pushup(k);\n\t}\n\tpii query(int k,int l,int r,int x,int y){\n\t\tif(x>r||y<l)return make_pair(-inf,-inf);\n\t\tif(x<=l&&y>=r)return t[k];\n\t\tpushdown(k,l,r);\n\t\treturn max(query(ls,l,mid,x,y),query(rs,mid+1,r,x,y));\n\t}\n}\nusing namespace tree;\nsigned main(void){\n\tios::sync_with_stdio(false);cin.tie(0);cout.tie(0);\n\tcin>>n;\n\trep(i,1,n){\n\t\tint x,y,c;cin>>x>>y>>c;\n\t\tv.push_back(x);v.push_back(y);a[i]=(Node){min(x,y),max(x,y),c};\n\t}\n\tint m=0;\n\tsort(v.begin(),v.end());\n\tv.erase(unique(v.begin(),v.end()),v.end());\n\trep(i,1,n){\n\t\tint x=lower_bound(v.begin(),v.end(),a[i].x)-v.begin()+1,y=lower_bound(v.begin(),v.end(),a[i].y)-v.begin()+1;\n\t\tm=max(m,y);\n\t\tg[x].push_back(make_pair(y,a[i].c));\n\t}\n\tbuild(1,1,m);\n\tint ans=-inf,l,r;\n\tpre(i,m,1){\n\t\trep(j,0,g[i].size()-1){\n\t\t\tpii tmp=g[i][j];\n\t\t\tupdate(1,1,m,tmp.first,m,tmp.second);\n\t\t}\n\t\tpii tmp=query(1,1,m,i,m);\n\t\ttmp.first+=v[i-1];\n\t\tif(tmp.first>ans){\n\t\t\tans=tmp.first;\n\t\t\tl=v[i-1],r=v[tmp.second-1];\n\t\t}\n\t}\n\tif(ans<0)ans=0,l=r=v[m-1]+1;\n\tcout<<ans<<'\\n'<<l<<' '<<l<<' '<<r<<' '<<r;\n}\n\n```",
        "postTime": 1658223364,
        "uid": 555059,
        "name": "Stannum7507",
        "ccfLevel": 4,
        "title": "CF1221F Choose a Square"
    }
]
[
    {
        "content": "\u6839\u636e $c_i-c_{i-1}\\le c_{i+1}-c_i$ \u548c $p_i-p_{i-1}\\ge p_{i+1}-p_i$ \u4e0d\u96be\u53d1\u73b0\u6700\u7ec8\u7684\u5e8f\u5217\u4e00\u5b9a\u662f\u8fd9\u6837\u7684\uff1a\n\n```plain\n(C/P) + CCC...CCCC + PCPCPC...PCPCPC + PPP...PPPP + (C/P)\n```\n\n\u6216\u8005\u662f\u8fd9\u6837\u7684\uff1a\n\n```plain\nPPP...PPPP + CCC...CCCC\n```\n\n\u5927\u529b\u5206\u7c7b\u8ba8\u8bba\uff0c\u7136\u540e\u53cc\u6307\u9488\u5c31\u597d\u4e86\uff0c\u6211\u8fd9\u91cc\u5199\u4e86\u4e8c\u5206\uff0c$\\mathcal O(n\\log n)$\u3002\n\n\u6ce8\u610f $n$ \u6bd4\u8f83\u5c0f\u7684\u65f6\u5019\u907f\u514d\u9ebb\u70e6\u7684\u7ec6\u8282\u5904\u7406\u53ef\u4ee5\u76f4\u63a5\u8dd1\u6307\u6570\u7ea7\u66b4\u529b\u3002\n\n```cpp\n// This code wrote by chtholly_micromaker(MicroMaker)\n#include <bits/stdc++.h>\n#define reg register\n#define int long long\n#define mem(x,y) memset(x,y,sizeof x)\n#define ln std::puts(\"\")\n#define lsp std::putchar(32)\n#define pb push_back\nconst int MaxN=2e5+50;\nconst int p=998244353;\ntemplate <class t> inline void read(t &s){s=0;\nreg int f=1;reg char c=getchar();while(!isdigit(c)){if(c=='-')f=-1;c=getchar();}\nwhile(isdigit(c))s=(s<<3)+(s<<1)+(c^48),c=getchar();s*=f;return;}\ntemplate<class t,class ...A> inline void read(t &x,A &...a){read(x);read(a...);}\ntemplate <class t> inline void write(t x){if(x<0)putchar('-'),x=-x;\nint buf[21],top=0;while(x)buf[++top]=x%10,x/=10;if(!top)buf[++top]=0;\nwhile(top)putchar(buf[top--]^'0');return;}\ninline int lowbit(int x){return x&(-x);}\nint a[MaxN],b[MaxN],n,lim,pst,ced,ped;\nint tr[2][MaxN];\ninline int ask(int *a,int l,int r)\n{\n\tif(l>r)return 0;\n\treturn a[r]-a[l-1];\n}\ninline int calc(int n,int st)\n{\n\tlim-=st;\n\tstd::memset(tr[0],0,sizeof(int)*(n+5));\n\tstd::memset(tr[1],0,sizeof(int)*(n+5));\n\tfor(int i=1;i<=n;++i)tr[i&1][i]+=b[i];\n\tfor(int i=1;i<=n;++i)tr[0][i]+=tr[0][i-1],tr[1][i]+=tr[1][i-1];\n\treg int ans=0,s=0;\n\t{\n\t\treg int pos=0;\n\t\twhile(pos+2<=n&&s+b[pos+2]<lim)pos+=2,s+=b[pos];\n\t\tif(pos==n&&ced)pos-=2;\n\t\tif(!pst)\n\t\t\tans+=pos/2;\n\t\telse if(pos==2&&n<=2&&!ped)\n\t\t\t++ans;\n\t}\n\ts=0;\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\ts+=b[i];\n\t\treg int l=i,r=n,mid,res=i-2;\n\t\twhile(l<=r)\n\t\t{\n\t\t\tmid=(l+r)>>1;\n\t\t\tif(s+ask(tr[i&1],i+2,mid)<lim)\n\t\t\t\tres=mid,l=mid+1;\n\t\t\telse\n\t\t\t\tr=mid-1;\n\t\t}\n\t\tif((res+i)&1)--res;\n\t\tif(ced&&res==n)res-=2;\n\t\tif(res>=i)ans+=(res-i+2)/2;\n\t}\n\tif(pst&&ced)\n\t{\n\t\ts=0;\n\t\tif(s<lim)++ans;\n\t\treg int ccnt=0;\n\t\tfor(int i=n;i;--i)\n\t\t{\n\t\t\ts+=b[i];\n\t\t\tif(s<lim)++ccnt;\n\t\t}\n\t\tans+=ccnt;\n\t}\n\tlim+=st;\n\tif(!(pst&&ced)&&st<lim)++ans;\n\treturn ans;\n}\ninline void solve()\n{\n\treg int ans=0;\n\tfor(int m=0;m<(1<<n);++m)\n\t{\n\t\tstd::vector<int> C,P;\n\t\tfor(int i=0;i<n;++i)\n\t\t\tif(m&(1<<i))\n\t\t\t\tC.pb(i);\n\t\t\telse\n\t\t\t\tP.pb(i);\n\t\tint flg=1;\n\t\tfor(int i=0;i<(int)C.size()-2;++i)\n\t\t\tif(C[i+1]-C[i]>C[i+2]-C[i+1])\n\t\t\t\tflg=0;\n\t\tfor(int i=0;i<(int)P.size()-2;++i)\n\t\t\tif(P[i+1]-P[i]<P[i+2]-P[i+1])\n\t\t\t\tflg=0;\n\t\treg int s=0;\n\t\tfor(int i=0;i<n;++i)\n\t\t\tif(m&(1<<i))\n\t\t\t\ts+=a[i+1];\n\t\tif(s>=lim)\n\t\t\tflg=0;\n\t\tans+=flg;\n\t}\n\twrite(ans),ln;\n}\ninline void work()\n{\n\tlim=0;\n\tread(n);\n\tfor(int i=1;i<=n;++i)\n\t\tread(a[i]),lim+=a[i];\n\tlim=(lim+1)/2;\n\tif(n<=6)\n\t\treturn solve();\n\treg int ans=0;\n\tfor(int i=2;i<n;++i)\n\t\tb[i-1]=a[i];\n\tpst=ped=1,(ans+=calc(n-2,0)%p)%=p,pst=ped=0;\n\tped=1,(ans+=calc(n-2,a[1])%p)%=p,ped=0;\n\tpst=ced=1,(ans+=calc(n-2,a[n])%p)%=p,pst=ced=0;\n\tced=1,(ans+=calc(n-2,a[1]+a[n])%p)%=p,ced=0;\n\twrite(ans),ln;\n}\nsigned main(void)\n{\n\tint t;read(t);\n\twhile(t--)\n\t\twork();\n\treturn 0;\n}\n```\n\n",
        "postTime": 1619393838,
        "uid": 51376,
        "name": "MyukiyoMekya",
        "ccfLevel": 9,
        "title": "CF1517E Group Photo \u9898\u89e3"
    },
    {
        "content": "\u9996\u5148\u7ed9\u51fa\u4e00\u4e2a\u663e\u7136\u7684\u7ed3\u8bba\uff1a\u5408\u6cd5\u65b9\u6848\u57fa\u672c\u4e0a\u5168\u662f `PC...CPC...PCP...PC` \u5f62\u5f0f\u3002\u63a5\u4e0b\u6765\u662f\u96be\u70b9\uff1a\u4e0d\u91cd\u590d\u679a\u4e3e\u3002\n\n\u5206\u4e24\u7c7b\uff1a\n\n 1. `P...PC...C`\uff08regex `P+C+`\uff09\n 2. `PC...CPC...PCP...PC`\uff08regex `P?C+(PC)*P+C?`\uff09\n\n\u6ce8\u610f 2 \u7c7b\u7684\u4e2d\u95f4 `C...C` \u548c `P...P` \u5fc5\u987b\u81f3\u5c11\u542b\u6709\u4e00\u4e2a `C` \u548c\u4e00\u4e2a `P`\uff0c\u5426\u5219\u53ef\u80fd\u9000\u5316\u4e3a `PC`\uff0c\u5c5e\u4e8e\u7b2c\u4e00\u7c7b\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u8bc1\u660e\u5982\u679c\u5fc5\u987b\u6709 `C+` \u548c `P+`\uff0c\u8fd9\u4e24\u7c7b `P?C+(PC)*P+C?` \u548c `P+C+` \u8986\u76d6\u6240\u6709\u53ef\u884c\u65b9\u6848\u3002\u5148\u8bc1\u660e\u4efb\u4f55\u4e0d\u6ee1\u8db3\u8be5\u6b63ce\u8868\u8fbe\u5f0f\u7684\u65b9\u6848\u5747\u4e0d\u5408\u6cd5\uff1a\n\n1. \u5047\u8bbe\u4e2d\u95f4\u5b58\u5728 `PC` \u957f\u5ea6\u5927\u4e8e 1 \u7684\u6df7\u5408\u6bb5 `PCPCPC...PCPCPC`\u3002\u7b2c\u4e00\u7c7b\u80af\u5b9a\u4e0d\u4f1a\u5305\u542b\u8fd9\u6837\u7684\u65b9\u6848\u3002\u63a5\u4e0b\u6765\u8bc1\u660e\u5982\u679c\u7b2c\u4e8c\u7c7b\u5305\u542b\u5f53\u4e14\u4ec5\u5f53\u8fd9\u4e2a\u65b9\u6848\u5408\u6cd5\u3002\n    - \u5047\u8bbe\u5de6\u4fa7\u6709\u4e0d\u6ee1\u8db3 `P?C+` \u5f62\u5f0f\u7684\u90e8\u5206\u3002\u8fd9\u610f\u5473\u7740\uff1a\n        1. \u5b58\u5728 `P` \u4f46\u662f\u5b83\u4e0d\u5728\u5de6\u8fb9\uff0c\u4e5f\u5c31\u662f\u610f\u5473\u7740\u4e24\u4e2a `C` \u5939\u7740\u4e00\u4e2a `P`\uff1a\n            1. \u5982\u679c\u8be5 `P` \u53f3\u8fb9\u4ec5\u6709\u4e00\u4e2a `C`\uff0c\u5219\u4ecd\u7136\u4e3a `PC`+`PCPC...PCPC` \u5f62\u5f0f\uff0c\u5e76\u6ca1\u8fdd\u89c4\u6b63ce\u8868\u8fbe\u5f0f $\\boxed{}$\n            2. \u5426\u5219 `P` \u5de6\u8fb9\u6709\u4e00\u4e2a `C`\uff0c`P` \u53f3\u8fb9\u6709\u4e24\u4e2a `C`\uff0c\u4e3a `CPCC` \u4e4b\u7c7b\u7684\uff0c\u4e0d\u6ee1\u8db3 `C` \u95f4\u8ddd\u9012\u589e\u6761\u4ef6 $\\boxed{}$\n        2. \u5b58\u5728\u591a\u4e2a\u5728\u6700\u5de6\u8fb9\u7684 `P`\uff0c\u4e3a `PP..PCPC` \u4e4b\u7c7b\u7684\uff0c\u4e0d\u6ee1\u8db3 `P` \u95f4\u8ddd\u9012\u51cf\u6761\u4ef6 $\\boxed{}$\n        3. \u4e0d\u5b58\u5728 `C`\uff0c\u53d8\u6210 `PPCPC` \u4e4b\u7c7b\u7684\uff0c\u4e5f\u4e0d\u6ee1\u8db3 `P` \u95f4\u8ddd\u9012\u51cf\u6761\u4ef6 $\\boxed{}$\n    - \u53f3\u8fb9\u540c\u7406 $\\boxed{}$\n2. \u5047\u8bbe\u6709\u6070\u597d\u4e00\u4e2a `PC`\n    - \u5047\u8bbe\u5de6\u4fa7\u4e0d\u6ee1\u8db3 `P?C+` \u5f62\u5f0f\u7684\u90e8\u5206\uff0c\u8fd9\u610f\u5473\u7740\uff1a\n        1. \u53c2\u89c1\u4e0a\u8ff0\n        2. \u53c2\u89c1\u4e0a\u8ff0\n        3. \u4e0d\u5b58\u5728 `C`\uff1a\n            - \u5982\u679c\u53f3\u4fa7\u6709 `P`\uff0c\u53d8\u4e3a `PPC***P**`\uff0c\u4e0d\u6ee1\u8db3 `P` \u95f4\u8ddd\u9012\u51cf\u8981\u6c42 $\\boxed{}$ (prop A)\n            - \u5982\u679c\u53f3\u4fa7\u6ca1\u6709 `P`\uff0c\u53d8\u4e3a `PPCC..CC`\uff0c\u9000\u5316\u4e3a\u7b2c\u4e00\u7c7b $\\boxed{}$\n    - \u53f3\u4fa7\u540c\u7406 $\\boxed{}$\n3. \u5047\u8bbe\u6ca1\u6709 `PC`\n    - \u5047\u8bbe\u53f3\u8fb9\u4e0d\u6ee1\u8db3 `P?C+` \u5f62\u5f0f\u7684\u90e8\u5206\uff0c\u8fd9\u610f\u5473\u7740\uff1a\n        1. \u5b58\u5728 `P` \u4f46\u662f\u5b83\u4e0d\u5728\u6700\u5de6\u8fb9\uff0c\u4e5f\u5c31\u662f\u4e24\u4e2a `C` \u5939\u7740\u4e00\u4e2a `P`\uff1a\n            1. \u5982\u679c\u8be5 `P` \u53f3\u8fb9\u4ec5\u6709\u4e00\u4e2a `C`\uff0c\u4ea7\u751f `PC`\uff0c\u4e0e\u4e0a\u8ff0\u6761\u4ef6\u77db\u76fe\uff1b$\\boxed{}$\n            2. \u5219\u5fc5\u987b\u4e3a `PPPPP`\uff0c`CPPPP`\uff0c`PCPPP` \u5f62\u5f0f\uff1a\n                1. `PPPPP`\n                    1. \u5982\u679c\u53f3\u4fa7\u6709 `P`\uff0c\u53c2\u89c1\u4e0a\u8ff0 prop A $\\boxed{}$\n                    2. \u5426\u5219\u5f62\u6210 `PPCC..CC`\uff0c\u9000\u5316\u4e3a\u7b2c\u4e00\u7c7b $\\boxed{}$\n                2. `CPPPP`\n                    1. \u5982\u679c\u53f3\u4fa7\u6709 `C`\uff0c\u548c prop A \u540c\u7406 $\\boxed{}$\n                    2. `CPP...PP` \u5e76\u6ca1\u8fdd\u89c4\u6b63ce\u8868\u8fbe\u5f0f $\\boxed{}$\n                3. `PCPPP` \u76f4\u63a5\u8fdd\u89c4 `P` \u95f4\u8ddd\u9012\u51cf\u6761\u4ef6 $\\boxed{}$\n        2. \u5de6\u8fb9\u6709\u4e00\u8f66 `P`\uff0c\u9000\u5316\u4e3a\u7b2c\u4e00\u7c7b $\\boxed{}$\n        3. \u4e0d\u5b58\u5728 `C`\uff0c\u5e76\u6ca1\u8fdd\u89c4\u6b63ce\u8868\u8fbe\u5f0f $\\boxed{}$\n\n\u8bc1\u660e\u4efb\u4f55\u6ee1\u8db3\u6b63ce\u8868\u8fbe\u5f0f\u7684\u65b9\u6848\u4e5f\u5408\u6cd5\u5f88\u7b80\u5355\uff0c\u76f4\u63a5\u67e5\u8ddd\u79bb\u5373\u53ef\u3002\n\n\u4e8e\u662f\u679a\u4e3e `(LR)*` \u5de6\u7aef\u70b9\uff0c\u4e8c\u5206\u53f3\u65ad\u7535\u5373\u53ef\u3002\u4ee3\u7801\uff1a\n\n```cpp\n#pragma GCC target(\"avx2\")\n#pragma GCC optimize(\"Ofast\")\n// writer: w33z8kqrqk8zzzx33\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define iter(i, a, b) for(int i=(a); i<(b); i++)\n#define rep(i, a) iter(i, 0, a)\n#define rep1(i, a) iter(i, 1, (a)+1)\n#define log(a) cerr<<\"\\033[32m[DEBUG] \"<<#a<<'='<<(a)<<\" @ line \"<<__LINE__<<\"\\033[0m\"<<endl\n#define all(a) a.begin(), a.end()\n#define fi first\n#define se second\n#define pb push_back\n#define mp make_pair\n \nusing ll=long long;\nusing pii=pair<int, int>;\n//#define int ll\nconst int MOD = 1000000007;\n\nint ar[200005];\nll sfx[200015],pfx[200015],sfp[200015];\ntemplate<typename T>int flas(T f){\n\tif(!f(0))return -1;\n\tint ans=0;\n\tfor(int i=17;i>=0;i--)if(f(ans|(1<<i)))ans|=(1<<i);\n\treturn ans;\n}\nll gud(int n){\n\trep(i,n){\n\t\tsfx[i]=ar[i];\n\t\tpfx[i]=ar[i];if(i)pfx[i]+=pfx[i-1];\n\t\tif(i!=n-1)sfp[i]=ar[i]-ar[i+1];\n\t}\n\trep(i,10)sfx[n+i]=sfp[n-1+i]=0;\n\tfor(int i=n-1;i>=0;i--){\n\t\tsfx[i]+=sfx[i+1];\n\t\tsfp[i]+=sfp[i+2];\n\t}\n\tll ans=0;\n\tfor(int i=n;i>=0;i--){\n\t\tll a=-sfx[i];if(i)a+=pfx[i-1];\n\t\tans+=(a>0);\n\t}\n\titer(l,1,n)ans+=flas([&](int i){return (l+2*i<n)&&(-pfx[l-1]+sfp[l]-sfp[l+2*i]+sfx[l+2*i]>0);})+1;\n\titer(l,2,n)ans+=flas([&](int i){return (l+2*i<n)&&(-pfx[l-1]+sfp[l]-sfp[l+2*i]+sfx[l+2*i]+2*ar[0]>0);})+1;\n\titer(l,1,n)ans+=flas([&](int i){return (l+2*i<n-1)&&(-pfx[l-1]+sfp[l]-sfp[l+2*i]+sfx[l+2*i]-2*ar[n-1]>0);})+1;\n\titer(l,2,n)ans+=flas([&](int i){return (l+2*i<n-1)&&(-pfx[l-1]+sfp[l]-sfp[l+2*i]+sfx[l+2*i]+2*ar[0]-2*ar[n-1]>0);})+1;\n\treturn ans%998244353;\n}\nsigned main() {\n    ios_base::sync_with_stdio(false); cin.tie(0);\n    int t;cin>>t;\n\twhile(t--){\n\t\tint n;cin>>n;\n\t\trep(i,n)cin>>ar[i];\n\t\tcout<<gud(n)<<endl;\n\t}\n}\n```",
        "postTime": 1619268600,
        "uid": 220037,
        "name": "w33z8kqrqk8zzzx33",
        "ccfLevel": 7,
        "title": "\u5410\u4e86\uff08CF1517E\uff09"
    },
    {
        "content": "\u521d\u6b65\u89c2\u5bdf\u53ef\u4ee5\u770b\u51fa\u4e0d\u5b58\u5728 $\\texttt{CCPCC}$ \u6216 $\\texttt{PPCPP}$ \u8fd9\u6837\u7684\u5b50\u4e32\u3002\n\n\u4f46\u662f\u53ef\u4ee5\u5b58\u5728 $\\texttt{PCPCPC}\\cdots$ \u8fd9\u6837\u7684\u5b50\u4e32\u3002\n\n\u6211\u4eec\u628a $\\texttt{PCPC}\\cdots\\texttt{PCPC}$ \u4f5c\u4e3a\u4e2d\u5fc3\uff0c\u53d1\u73b0\u5de6\u8fb9\u53ef\u4ee5\u518d\u63a5\u4e00\u6bb5$\\texttt{C}$\uff0c\u53f3\u7aef\u53ef\u4ee5\u518d\u63a5\u4e00\u6bb5 $\\texttt{P}$\u3002\u5176\u4e2d\u5de6\u8fb9\u53ef\u4ee5\u4e0d\u63a5$\\texttt{C}$\uff0c\u53f3\u8fb9\u53ef\u4ee5\u4e0d\u63a5$\\texttt{P}$\uff0c\u4e5f\u53ef\u4ee5\u53ea\u5b58\u5728$\\texttt{CCC}\\cdots\\texttt{PPP}$\u3002\u6211\u4eec\u79f0\u8fd9\u6837\u5f62\u5f0f\u7684\u4e32\u4e3a\u6807\u51c6\u4e32\u3002\n\n\u5982\u679c\u4e0d\u4ee5$\\texttt{PCPC}\\cdots\\texttt{PCPC}$ \u4f5c\u4e3a\u4e2d\u5fc3\uff0c\u4e5f\u5c31\u662f\u4e0d\u5b58\u5728\u8fd9\u6837\u7684\u5b50\u4e32\uff0c\u4e0d\u96be\u53d1\u73b0\u4e00\u5b9a\u662f$\\texttt{PPP}\\cdots\\texttt{CCC}$\u8fd9\u6837\u7684\u5f62\u5f0f\u3002\n\n\u4f46\u662f\u624b\u76d8\u6837\u4f8b\u53d1\u73b0\u8fc7\u4e0d\u53bb\u3002\u56e0\u4e3a\u6211\u4eec\u53ef\u4ee5\u5728\u6807\u51c6\u4e32\u5de6\u8fb9\u518d\u63a5\u4e00\u4e2a$\\texttt{P}$\uff0c\u53f3\u8fb9\u518d\u63a5\u4e00\u4e2a$\\texttt{C}$\u3002\n\n\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u56fa\u5b9a\u7b2c\u4e00\u4e2a\u4e3a$\\texttt{C/P}$\uff0c\u6700\u540e\u4e00\u4e2a\u4e3a$\\texttt{C/P}$\u3002\n\n\u4f46\u662f\u56fa\u5b9a\u9996\u5c3e\u540e\u5e76\u4e0d\u662f\u6240\u6709\u7684\u6807\u51c6\u4e32\u90fd\u53ef\u4ee5\u586b\u8fdb\u53bb\uff0c\u6bd4\u5982$\\texttt{PCP}$\u662f\u4e00\u4e2a\u6807\u51c6\u4e32\uff0c\u4f46\u662f\u52a0\u4e0a\u9996\u5c3e\u4e4b\u540e$\\texttt{PPCPP}$\u5e76\u4e0d\u6ee1\u8db3\u6761\u4ef6\u3002\n\n\u56e0\u4e3a\u6211\u4eec\u8fd8\u6709\u8fd8\u6709\u4e00\u4e2a\u9650\u5236\u6761\u4ef6\uff0c\u56fa\u5b9a\u7b2c\u4e00\u4f4d\u4e3a$\\texttt{P}$\uff0c\u5219\u7b2c\u4e8c\u4f4d\u4e00\u5b9a\u662f$\\texttt{C}$\uff0c\u56fa\u5b9a\u6700\u540e\u4e00\u4f4d\u662f$C$\uff0c\u5219\u5012\u6570\u7b2c\u4e8c\u4f4d\u4e00\u5b9a\u662f$\\texttt{P}$\u3002\n\n\u7136\u540e\u518d\u7edf\u8ba1\u6ca1\u6709\u56fa\u5b9a\u7684\u4f4d\u7f6e\u6709\u591a\u5c11\u6ee1\u8db3\u6761\u4ef6\u7684\u6807\u51c6\u4e32\u3002\n\n\u90a3\u4e48\u5982\u4f55\u6c42\u51fa\u6807\u51c6\u4e32\u4e2a\u6570\u5462\uff1f\n\n\u9996\u5148 $\\sum C< \\sum P$ \u7b49\u4ef7\u4e8e $2\\times \\sum C < \\sum a_i$ \u3002\n\n\u5f97\u5230\u5f62\u5f0f $\\sum C \\le lim$\uff0c\u5176\u4e2d $lim$ \u662f\u4e00\u4e2a\u5e38\u6570\u3002\n\n\u7136\u540e\u6211\u4eec\u679a\u4e3e $\\texttt{PCPC}\\cdots$ \u548c $\\texttt{PP}\\cdots$ \u7684\u65ad\u70b9\uff0c\u7136\u540e\u53d1\u73b0 $\\texttt{CC} \\cdots$ \u548c $\\texttt{PCPC}\\cdots $\u7684\u65ad\u70b9\u5177\u6709\u5355\u8c03\u6027\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u4e8c\u5206\u6216\u53cc\u6307\u9488\u89e3\u51b3\u3002\n\n\u518d\u6b21\u5f3a\u8c03\uff0c\u5f62\u5982 $\\texttt{P}\\cdots\\texttt{P}$ \u548c$\\texttt{C}\\cdots \\texttt{C}$ \u548c $\\texttt{PC}\\cdots\\texttt{PC}$\n \u7684\u4e32\u4e5f\u662f\u6807\u51c6\u4e32\u3002\n \n\u7ec6\u8282\u7279\u522b\u6076\u5fc3\uff0c\u53ef\u80fd\u662f\u6211\u60f3\u590d\u6742\u4e86\uff1f\n\n```cpp\n//By SharpnessV\n//no copy\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<=b;i++)\n#define pre(i,a,b) for(int i=a;i>=b;i--)\n#define N 200005\n#define int long long \nusing namespace std;\nint n,a[N],s[N],u[N];\nint g(int l,int r){\n\tif((l&1)!=(r&1))return u[r]-u[l-1];\n\treturn u[r]-u[max(l-2,0LL)];\n}\nint calc(int lim,int L,int R){\n\tint ans=0;\n\tif(L>R+1)return 0;\n\tif(lim>=0)ans++;\n\trep(i,L,R){\n\t\tif(i&1){\n\t\t\tif(g(L,i)<=lim)ans++;\n\t\t\tint l=2,r=i/2,ed=1;\n\t\t\tif(L==2)l=1,ed=0;\n\t\t\twhile(l<=r){\n\t\t\t\tint mid=(l+r)>>1;\n\t\t\t\tif(u[i]-u[mid*2+1]+s[mid*2+1]-s[L-1]<=lim)ed=mid,l=mid+1;\n\t\t\t\telse r=mid-1;\n\t\t\t}\n\t\t\tans+=ed-1+(L!=2);\n\t\t}\n\t\telse{\n\t\t\tif(g(L,i)<=lim)ans++;\n\t\t\tint l=2,r=i/2,ed=1;\n\t\t\twhile(l<=r){\n\t\t\t\tint mid=(l+r)>>1;\n\t\t\t\tif(u[i]-u[mid*2]+s[mid*2]-s[L-1]<=lim)ed=mid,l=mid+1;\n\t\t\t\telse r=mid-1;\n\t\t\t}\n\t\t\tans+=ed-1;\n\t\t}\n\t}\n\treturn ans;\n}\nvoid solve(){\n\tscanf(\"%lld\",&n);\n\trep(i,1,n)scanf(\"%lld\",&a[i]),s[i]=s[i-1]+a[i];\n\tif(n==1){puts(\"1\");return;}\n\tif(n==2){printf(\"%lld\\n\",(a[1]!=a[2])+1LL);return;}\n\tu[1]=a[1];rep(i,2,n)u[i]=u[i-2]+a[i];\n\tint ans=0,lim=(s[n]+1)/2-1;\n\trep(i,1,n)ans+=(s[n]-s[i])<=lim;\n\tans+=calc(lim-a[2],3,n-1);\n\tans+=calc(lim-a[1],2,n-1);\n\tans+=calc(lim-a[1]-a[n],2,n-2);\n\tans+=calc(lim-a[2]-a[n],3,n-2);\n\tprintf(\"%lld\\n\",ans%998244353);\n}\nsigned main(){\n\tint T;scanf(\"%lld\",&T);\n\twhile(T--)solve();\n\treturn 0;\n}\n```",
        "postTime": 1619429333,
        "uid": 119261,
        "name": "7KByte",
        "ccfLevel": 0,
        "title": "CF1517E Group Photo\u9898\u89e3"
    }
]
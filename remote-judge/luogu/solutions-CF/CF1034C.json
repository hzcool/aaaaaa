[
    {
        "content": "### CF1034C Region Separation\n\n\u4e3a\u9632\u6b62 $\\LaTeX$ \u7206\u70b8\u5efa\u8bae\u5728 luogu \u535a\u5ba2\u6216\u8005 [\u8fd9\u91cc](https://www.yijan.co/cf1034c-region-separation/) \u9605\u8bfb\n\n---\n\n\u597d\u9898\u554a\n\n\u6211\u4eec\u5148\u8003\u8651\u53ea\u8fdb\u884c\u4e00\u6b21\u64cd\u4f5c\uff0c\u53ef\u4ee5\u53d1\u73b0\u5982\u679c\u8fd9\u6b21\u64cd\u4f5c\u5e0c\u671b\u628a\u6574\u4e2a\u6811\u5206\u6210 $k$ \u4efd\uff0c\u90a3\u4e48\u8981\u4e48\u4e0d\u53ef\u5206\uff0c\u8981\u4e48\u53ea\u6709\u4e00\u79cd\u65b9\u6848\u3002\n\n\u600e\u4e48\u8bc1\u660e\uff1f\u9996\u5148\u53ef\u4ee5\u94a6\u5b9a 1 \u4e3a\u6839\u3002\u5982\u679c\u5e0c\u671b\u628a\u6574\u4e2a\u6811\u5206\u6210 $k$ \u4efd\uff0c\u90a3\u4e48\u6bcf\u4e2a\u8054\u901a\u5757\u7684\u5927\u5c0f\u5fc5\u7136\u662f $\\frac S k$\uff0c\u5176\u4e2d $S$ \u662f\u6574\u4e2a\u6811\u7684\u6743\u503c\u7684\u548c\u3002\u7136\u540e\u5f88\u663e\u7136\u7684\uff0c\u6bcf\u4e2a\u65ad\u5f00\u5f53\u524d\u70b9\u548c\u5b83\u7236\u4eb2\u7684\u8fb9\u7684\u5fc5\u8981\u6761\u4ef6\u662f $s_u \\equiv 0 \\pmod {\\frac S k}$ \u3002\u4f46\u662f\uff0c\u5047\u8bbe\u5b83\u7684\u5b50\u6811\u5185\u5df2\u7ecf\u6709\u5f88\u591a\u70b9\u88ab\u65ad\u5f00\u4e86\uff0c\u90a3\u4e48\u5bf9\u4e8e\u8fd9\u4e2a\u70b9\u6240\u5728\u7684\u8054\u901a\u5757\u5927\u5c0f\uff0c\u5fc5\u7136\u6ee1\u8db3 $\\frac S k | x$ \u5176\u4e2d $x$ \u662f\u8fd9\u4e2a\u70b9\u6240\u5728\u7684\u8054\u901a\u5757\u5927\u5c0f\u3002\u65e2\u7136\u5982\u6b64\uff0c\u6211\u4eec\u6709 $x \\ge \\frac S k$ \u3002\u7531\u6b64\u53ef\u4ee5\u770b\u51fa\u6ee1\u8db3 $s_u \\equiv 0 \\pmod {\\frac S k}$ \u7684\u70b9\u7684\u4e2a\u6570\u662f\u4e0d\u8d85\u8fc7 $k$ \u4e2a\u7684\u3002\u5982\u679c\u8d85\u8fc7\u4e86  $k$ \u4e2a\uff0c\u5fc5\u7136\u5728\u5206\u67d0\u4e2a\u70b9\u7684\u65f6\u5019\u6ca1\u6709 $x \\ge \\frac S k$\u3002\uff08\u5176\u5b9e\u53ef\u4ee5\u611f\u6027\u7406\u89e3\u4e00\u4e0bw\uff09\n\n\u6211\u4eec\u8bbe\n$$\nf[k] = \\displaystyle \\sum_{x=1}^n [s_x\\equiv 0 \\pmod {\\frac{S}{k}}]\n$$\n\u90a3\u4e48\u5982\u679c $f[k] = k$ \u5219\u8868\u793a\u7b2c\u4e00\u6b21\u64cd\u4f5c\u5206\u6210 $k$ \u662f\u5408\u6cd5\u7684\u3002\u6211\u4eec\u53ea\u9700\u8981\u7ed9\u6240\u6709\u6ee1\u8db3\u6761\u4ef6\u7684\u70b9\u5230\u7236\u4eb2\u7684\u8fb9 cut \u6389\u5c31\u884c\u4e86\u3002\n\n\u5982\u4f55\u8ba1\u7b97 $f$ \uff1f\u8003\u8651\u5982\u679c\u4e00\u4e2a $s_i$ \u4f1a\u5bf9 $f[k]$ \u9020\u6210\u8d21\u732e\uff0c\u90a3\u4e48\u6709\n$$\ns_i \\equiv 0 \\pmod {\\frac S k}\n$$\n$$\ns_i = a \\frac{S}{k} ,a\\in N\n$$\n$$\nk = a\\frac{S}{s_i}\n$$\n\u6211\u4eec\u8bbe $t = \\frac{S}{k}$ \uff0c\u90a3\u4e48\n$$\ns_i = at,k = \\frac{S}{t}\n$$\n\u4e5f\u5c31\u662f\u8bf4\u5982\u679c\u6709 $t | s_i , t|S$\uff0c\u5373 $t|\\gcd(s_i,S)$\uff0c \u90a3\u4e48 $s_i$ \u5c31\u4f1a\u5bf9 $\\frac S t$ \u9020\u6210\u8d21\u732e\u3002\n\n\u5373\u82e5 $\\frac{S}{k}|\\gcd(s_i,S)$ \uff0c\u5373 $\\frac{S}{\\gcd(s_i,S)} | k$ \uff0c\u5219 $s_i$ \u4f1a\u5bf9 $k$ \u9020\u6210\u8d21\u732e\u3002\u4e8e\u662f\u53ea\u9700\u8981\u5bf9\u4e8e $s_i$ \u626b\u4e00\u904d $\\frac S {\\gcd(s_i,S)}$ \u7684\u500d\u6570\u5c31\u597d\u8fa3\u3002\u4e5f\u5c31\u662f\u8bf4\u6c42\u51fa $f$ \u7684\u590d\u6742\u5ea6\u662f $O(n\\ln n)$\u3002\n\n\u6211\u4eec\u8bbe\u6700\u540e\u4e00\u6b21\u5256\u5206\u65f6\u5256\u5206\u4e3a $k$ \u4efd\u7684\u65b9\u6848\u6570\u91cf\u662f $F[k]$ \uff0c \u663e\u7136\uff0c\u5982\u679c\u4e0a\u4e00\u6b21\u5256\u5206\u4e3a $k_{i-1}$ \u4efd\uff0c\u8fd9\u6b21\u662f $k_i$ \u4efd\uff0c\u90a3\u4e48\u5fc5\u987b\u6ee1\u8db3 $k_{i-1} | k_i$ \u3002 \u800c\u65b9\u6848\u53c8\u8981\u4e48\u662f 1 \u8981\u4e48\u662f 0 \uff0c\u6240\u4ee5\u6709\n$$\nF[k] = f[k]\\sum_{k|t} F[t]\n$$\n\u7136\u540e\u5c31\u4e00\u4e2a $\\log$ \u505a\u5b8c\u4e86\u3002\n\n```cpp\n#include \"iostream\"\n#include \"cstring\"\n#include \"cstring\"\n#include \"cstdio\"\nusing namespace std;\n#define MAXN 1000006\n#define P 1000000007\ntypedef long long ll;\nint n;\nint A[MAXN] , fa[MAXN] , num[MAXN] , f[MAXN]; ll S[MAXN];\nll gcd( ll a , ll b ) { return !b ? a : gcd( b , a % b ); }\nint main() {\n    cin >> n;\n    for( int i = 1 ; i <= n ; ++ i ) scanf(\"%d\",&A[i]);\n    for( int i = 2 ; i <= n ; ++ i ) scanf(\"%d\",&fa[i]);\n    for( int i = n ; i ; -- i ) S[i] += A[i] , S[fa[i]] += S[i];\n    ll s = S[1];\n    for( int i = 1 ; i <= n ; ++ i ) if( s / gcd( S[i] , s ) <= n ) ++ num[s / gcd( S[i] , s )];\n    for( int i = 1 ; i <= n ; ++ i ) if( num[i] )\n        for( int j = i ; j <= n ; j += i )\n            f[j] += num[i];\n    for( int i = 1 ; i <= n ; ++ i ) f[i] = ( f[i] == i );\n    ll ans = 0;\n    for( int i = n ; i > 1 ; -- i ) if( f[i] ) {\n        for (int j = i + i; j <= n; j += i) ( f[i] += f[j] ) %= P;\n        ( ans += f[i] ) %= P;\n    }\n    cout << ans + 1 << endl;\n}\n```\n\n",
        "postTime": 1584717535,
        "uid": 63398,
        "name": "yijan",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1034C \u3010Region Separation\u3011"
    },
    {
        "content": "# Region Separation(CF1034C)\n\n---\n\n### \u660e\u786e\u9898\u610f\uff1a\n\n1.\u6bcf\u6b21\u780d\u5b8c\u4e4b\u540e\uff0c\u6240\u6709\u8054\u901a\u5feb\u7684\u6743\u503c\u548c\u76f8\u7b49\u3002\n\n2.\u6bcf\u6b21\u4e00\u4e2a\u8fb9\u96c6\u7684\u8fb9\u540c\u65f6\u65ad\uff0c\u53ef\u4ee5\u65ad\u591a\u6b21\u8fb9\u96c6\u3002\n\n---\n\n## \u9898\u89e3\uff1a\n\n\n\u9996\u5148\u53ef\u4ee5\u60f3\u5230\u8ba1\u7b97\u51fa\u6bcf\u4e2a\u5b50\u6811\u7684\u6743\u503c\u548c\u2014\u2014$siz$(\u4ee5 $1$ \u4e3a\u6839)\u3002\n\n\u8bbe\u5207\u5230\u6700\u540e\u6bcf\u4e2a\u8054\u901a\u5757\u7684\u6743\u503c\u548c\u4e3a $k$\uff0c\u90a3\u4e48\u5408\u6cd5\u7684 $k$ \u6ee1\u8db3 $k|siz_1$\u3002\n\n\u8bb0 $cnt_k=\\sum_{i=1}^n{[siz_i \\equiv 0 (\\bmod \\ k)]}$\uff0c\u5408\u6cd5\u7684 $k$ \u5c31\u8fd8\u8981\u6ee1\u8db3 $cnt_k=\\frac{siz_1}{k}$\u3002\n\n\u8bc1\u660e\uff1a\n\n$cnt_k$ \u5b9e\u9645\u4e0a\u662f\u6ee1\u8db3 $siz_i\\equiv 0(\\bmod \\ k)$ \u7684\u8282\u70b9\u4e2a\u6570\u3002\n\n\u8fd9\u4e9b\u8282\u70b9\u8981\u9009\u62e9\u65ad\u5f00\u4e0e\u7236\u8282\u70b9\u76f8\u8fde\u7684\u8fb9\uff0c\u5982\u679c\u6211\u4eec\u6ca1\u6709\u65ad\u5f00 $\\frac{siz_1}{k}-1$ \u6761\u8fb9\uff08\u8003\u8651\u5230\u6839\u8282\u70b9\u4e0d\u7528\u65ad\uff0c\u5b9e\u9645\u4e0a\u65ad\u5f00\u4e86 $\\frac{siz_1}{k}-1$ \u6761\u8fb9\uff09\uff0c\u4e5f\u5c31\u6ca1\u6709\u628a\u8fd9\u68f5\u6811\u5206\u6210 $\\frac{siz_1}{k}$ \u4e2a\u90e8\u5206\uff0c\u90a3\u4e0d\u53ef\u80fd\u6bcf\u4e2a\u90e8\u5206\u7684\u6743\u503c\u548c\u4e3a $k$\u3002\n\n$\\text{Q.E.D.}$\n\n\u4f46\u662f\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff1a$k$ \u7684\u8303\u56f4\u8fbe\u5230\u4e86 $10^6\\times 10^9$\uff0c\u5f00\u6876\u5b58\u5b8c\u5168\u662f\u4e0d\u73b0\u5b9e\u7684\u3002\n\n\u4e8e\u662f\u8003\u8651\u8f6c\u53d8\u4e00\u4e0b $cnt$ \u7684\u5b9a\u4e49\u3002\n\n**\u65b0\u5b9a\u4e49**\uff1a$cnt_s$ \u4e3a\u6ee1\u8db3\u6700\u540e\u5269\u4e0b\u4e86 $s$ \u4e2a\u8054\u901a\u5757\uff0c\u8981\u65ad\u5f00\u4e0e\u7956\u5148\u76f8\u8fde\u7684\u8fb9\u7684\u70b9\u7684\u4e2a\u6570\u3002\uff08\u53ef\u80fd\u8bf4\u4e0d\u592a\u6e05\u695a\uff0c\u770b\u5f0f\u5b50\u5427\uff0c\u5b9e\u9645\u4e0a\u662f $s=\\frac{siz_1}{k}$\uff0c\u4ee3\u6362\u4e86\u4e00\u4e0b\uff0c\u8fd9\u6837\u6876\u5b58\u7684\u8303\u56f4\u53d8\u6210\u4e86 $10^6$\uff09\n\n\u5373\u8981\u6ee1\u8db3\uff1a\n\n$$\ncnt_s=\\sum_{i=1}^{n}[siz_i\\equiv 0(\\bmod\\ \\frac{siz_1}{s})]((1<s\\le n)\\land(s|siz_1))\n$$\n\u5408\u6cd5\u6761\u4ef6\u662f $cnt_s=s$\u3002\n\n\n\u8ba1\u7b97 $cnt$\uff1a\n\n\u66b4\u529b\u679a\u4e3e $s$\u3001$i$ \u590d\u6742\u5ea6\u4e3a $O(n^2)$\u3002\n\n\u53d1\u73b0\uff1a\u5bf9\u4e8e\u4e00\u9897\u6743\u503c\u548c\u4e3a $siz_i$ \u7684\u5b50\u6811\u6765\u8bf4\uff0c\u5b83\u5982\u679c\u80fd\u5bf9 $s$ \u505a\u8d21\u732e\uff0c\u8981\u6ee1\u8db3\uff1a\n\n$$\nsiz_i\\equiv 0(\\bmod\\ \\frac{siz_1}{s})\n$$\n\n$$\nsiz_i=t\\times \\frac{siz_1}{s}\n$$\n\n$$\ns=t\\times \\frac{siz_1}{siz_i}\n$$\n\n\u8bbe $d=\\gcd(siz_1,siz_i)$\uff0c$siz_1=a\\times d$\uff0c$siz_i=b\\times d$\uff0c\u5219 $\\gcd(a,b)=1$\u3002\n\n\u6240\u4ee5\n$$\ns=t\\times \\frac{a}{b}\n$$\n\n\u53d1\u73b0\uff1a\u5f53 $b|t$ \u65f6\uff0c$s$ \u624d\u4e3a\u6574\u6570\uff0c\u5373\u5bf9 $s$ \u6709\u8d21\u732e\uff0c\u6240\u4ee5 $s=g\\times a(g=\\frac{t}{b})$\u3002\n\n\u5f97\u51fa\u7ed3\u8bba\uff1a\u5f53 $\\frac{siz_1}{\\gcd(siz_1,siz_i)}|s$ \u65f6\uff0c$siz_i$ \u4f1a\u5728 $cnt_s$ \u4e2d\u505a\u8d21\u732e\u3002\n\n\u8fd9\u91cc\u7684\u8ba1\u7b97\u662f\u679a\u4e3e $\\frac{siz_1}{\\gcd(siz_1,siz_i)}$ \u7684\u500d\u6570\uff0c\u8c03\u548c\u7ea7\u6570\uff0c\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n\u8fd9\u53ea\u662f\u7b2c\u4e00\u6b65\uff1a\u5224\u65ad\u90a3\u4e9b\u72b6\u6001\u5408\u6cd5\uff0c\u63a5\u4e0b\u6765\u8fd8\u8981\u8ba1\u7b97\u65b9\u6848\u6570\u3002\n\n\u8bbe $f_s$ \u4e3a\u6700\u540e\u5269\u4e0b\u4e86 $s$ \u4e2a\u8054\u901a\u5757\u7684\u65b9\u6848\u6570\u3002\n\n\u521d\u59cb\u5316\uff1a$f_s=[cnt_s = s]$\u3002\n\n\u8003\u8651\u8f6c\u79fb\uff1a$f_s=\\sum_{s|s_1}f_{s_1}$\uff08\u5207\u4e00\u4e0b\u6210\u500d\u589e\u52a0\uff09\u3002\n\n\u6ce8\u610f\uff1a$f_1=1$ \u9700\u8981\u7279\u6b8a\u5224\u4e00\u4e0b\u3002\n\n\u6700\u540e\u8fd9\u90e8\u5206\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n---\n\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define re register int\n#define pc_ putchar(' ')\n#define pc_n putchar('\\n')\n#define Bessie signed\ninline int read()\n{\n    int A = 0, FL = 1;\n    char CH = getchar();\n    while(CH < '0' || CH > '9') FL = CH == '-' ? -1 : 1, CH = getchar();\n    while(CH >= '0' && CH <= '9') A = (A << 3) + (A << 1) + (CH ^ '0'), CH = getchar();\n    return A * FL;\n}\ninline void ot(int x)\n{\n    if(x < 0) putchar('-'), x = -x;\n    if(x >= 10) ot(x / 10); \n    putchar(x % 10 | '0');\n}\nconst int CTR = 1e6 + 7, MOD = 1e9 + 7;\nint n;\nint a[CTR], fa[CTR];\nint siz[CTR];\nint gcd(int x, int y)\n{\n    return !y ? x : gcd(y, x % y);\n}\nint cnt[CTR], f[CTR], S[CTR];\nint ans;\nBessie main()\n{\n    n = read();\n    for(re i = 1; i <= n; ++i)\n        a[i] = read();\n    for(re i = 2; i <= n; ++i)\n        fa[i] = read();\n    for(re i = n; i; --i)\n    {\n        siz[i] += a[i];\n        siz[fa[i]] += siz[i];\n    }\n    for(re i = 1; i <= n; ++i)\n        if(siz[1] / gcd(siz[1], siz[i]) <= n)\n            ++cnt[siz[1] / gcd(siz[1], siz[i])];\n    for(re i = 1; i <= n; ++i)\n        if(cnt[i])\n            for(re j = i; j <= n; j += i)\n                f[j] += cnt[i];\n    for(re i = 1; i <= n; ++i)\n        f[i] = (f[i] == i);\n    for(re i = n; i > 1; --i)\n    {\n        if(f[i])\n        {\n            for(re j = i + i; j <= n; j += i)\n                (f[i] += f[j]) %= MOD;\n            (ans += f[i]) %= MOD;\n        }\n    }\n    ot(ans + 1),pc_n;\n    return 0;\n}\n```\n",
        "postTime": 1665752678,
        "uid": 352970,
        "name": "Creator_157",
        "ccfLevel": 4,
        "title": "CF1034C Region Separation"
    },
    {
        "content": "**\u6d1b\u8c37\u7684 latex \u6709 bug\uff0c\u8bf7\u52a1\u5fc5\u524d\u5f80\u6211\u7684\u535a\u5ba2\u67e5\u770b\u672c\u6587**\uff1a[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/dysyn1314/p/14402312.html)\n\n# CF1034C Region Separation\n\n## \u9898\u76ee\u5927\u610f\n\n[\u9898\u76ee\u94fe\u63a5](https://codeforces.com/contest/1034/problem/C)\n\n\u7ed9\u5b9a\u4e00\u68f5 $n$ \u4e2a\u70b9\u7684\u6811\u3002\u6bcf\u4e2a\u70b9\u6709\u6743\u503c\uff0c\u8bb0\u4e3a $a_{1\\dots n}$\u3002\n\n\u4f60\u60f3\u780d\u6811\u3002\u4f60\u53ef\u4ee5\u780d\u4efb\u610f\u8f6e\uff0c\u6bcf\u8f6e\u4f60\u9009\u62e9\u4e00\u4e9b\u8fb9\uff08\u81f3\u5c11\u4e00\u6761\uff09\u65ad\u5f00\uff0c\u9700\u8981\u6ee1\u8db3\u6bcf\u8f6e\u7ed3\u675f\u540e\u6bcf\u4e2a\u8fde\u901a\u5757\u7684\u6743\u503c\u548c\u662f\u76f8\u7b49\u7684\u3002\n\n\u6c42\u6709\u591a\u5c11\u79cd\u780d\u6811\u65b9\u6848\u3002\u4e24\u79cd\u65b9\u6848\u4e0d\u540c\uff0c\u5f53\u4e14\u4ec5\u5f53\u8f6e\u6570\u4e0d\u540c\u6216\u8005\u67d0\u4e00\u8f6e\u780d\u7684\u8fb9\u4e0d\u540c\u3002\u7b54\u6848\u5bf9 $10^9 + 7$ \u53d6\u6a21\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\leq n\\leq 10^6$\uff0c$1\\leq a_i\\leq 10^9$\u3002\n\n## \u672c\u9898\u9898\u89e3\n\n\u53d6\u4efb\u610f\u70b9\u4e3a\u6839\uff08\u4e0d\u59a8\u53d6 $1$\uff09\uff0c\u628a\u6811\u53d8\u6210\u6709\u6839\u6811\u3002\u8bbe $S$ \u4e3a\u6240\u6709\u8282\u70b9\u7684\u70b9\u6743\u548c\uff0c$s_i$ \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u5185\u7684\u70b9\u6743\u548c\u3002\n\n\u8003\u8651\u53ea\u8fdb\u884c\u4e00\u8f6e\u5212\u5206\uff0c\u6709\u591a\u5c11\u79cd\u65b9\u6848\u3002\u8bbe\u628a\u6811\u5212\u5206\u4e3a\u4e86 $k$ \u5757\uff0c\u90a3\u4e48\u5b58\u5728\u65b9\u6848\u7684\u4e00\u4e2a\u5fc5\u8981\u6761\u4ef6\u662f\uff1a$k$ \u662f $S$ \u7684\u7ea6\u6570\u3002\u6b64\u65f6\u6bcf\u5757\u5185\u7684\u70b9\u6743\u548c\u662f $\\frac{S}{k}$\u3002\n\n\u6211\u4eec\u4ece\u53f6\u5b50\u5f00\u59cb\uff0c\u7c7b\u4f3c\u6811\u5f62 DP \u7684\u8fc7\u7a0b\uff0c\u6bcf\u5f53\u5f53\u524d\u8fde\u901a\u5757\u7684\u548c\u8fbe\u5230 $\\frac{S}{k}$\uff0c\u5c31\u628a\u5f53\u524d\u8fde\u901a\u5757\u5272\u4e0b\u6765\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u5bf9\u6240\u6709 $i = 2\\dots n$\uff0c\u5982\u679c $s_{i} \\bmod \\frac{S}{k} = 0$\uff0c\u5c31\u5207\u65ad $i$ \u548c $\\mathrm{fa}(i)$ \u4e4b\u95f4\u7684\u8fb9\u3002\u5bb9\u6613\u53d1\u73b0\uff0c**\u5982\u679c\u6709\u89e3\uff0c\u6211\u4eec\u8fd9\u6837\u4f1a\u6c42\u51fa\u552f\u4e00\u7684\u4e00\u7ec4\u89e3**\u3002**\u5982\u679c\u65e0\u89e3\uff0c\u6309\u6b64\u65b9\u6cd5\u6700\u7ec8\u5f97\u5230\u7684\u8fde\u901a\u5757\u6570\u4f1a\u5c0f\u4e8e $k$**\u3002\n\n\u901a\u8fc7\u5982\u4e0a\u8ba8\u8bba\uff0c\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u56de\u7b54\u3010\u53ea\u8fdb\u884c\u4e00\u8f6e\u5212\u5206\uff0c\u628a\u6811\u5212\u5206\u4e3a $k$ \u5757\u7684\u65b9\u6848\u6570\u3011\uff0c\u8bbe\u4e3a $f(k)$\uff0c\u5219\uff1a\n$$\nf(k) = \\begin{cases}\n0 && S\\bmod k\\neq 0\\\\\n\\displaystyle \\left[\\left(\\sum_{i = 1}^{n} \\left[s_i \\bmod \\frac{S}{k} = 0\\right]\\right) = k\\right]&& \\text{otherwise}\n\\end{cases}\n$$\n\u4e5f\u5c31\u662f\u8bf4\uff0c$f(k)$ \u53ea\u80fd\u7b49\u4e8e $0$ \u6216 $1$\uff0c\u5e76\u4e14\u5b83\u4e3a $1$ \u5f53\u4e14\u4ec5\u5f53\uff1a$k$ \u662f $S$ \u7684\u7ea6\u6570\uff0c\u4e14\u6070\u6709 $k$ \u4e2a $i$ \u6ee1\u8db3 $s_i \\bmod \\frac{S}{k} = 0$\u3002\n\n\u66b4\u529b\u6c42\u51fa $f(1)\\dots f(n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal{O}(n^2)$ \u7684\uff0c\u6211\u4eec\u60f3\u8981\u66f4\u5feb\u3002\n\n\u8003\u8651 $s_i \\bmod \\frac{S}{k} = 0$ \u8fd9\u4e2a\u8981\u6c42\u3002\u8f6c\u5316\u4e00\u4e0b\uff1a\n$$\n\\begin{align}\n&s_i = t\\cdot \\frac{S}{k}\\\\\n\\rArr & s_i \\cdot k = t \\cdot S\\\\\n\\rArr & S \\mid s_i \\cdot k\\\\\n\\rArr & \\frac{S}{\\gcd(S, s_i)}\\mid k\n\\end{align}\n$$\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u8fd9\u4e2a\u8981\u6c42\u7b49\u4ef7\u4e8e $k$ \u662f $\\frac{S}{\\gcd(S, s_i)}$ \u7684\u500d\u6570\u3002\n\n\u90a3\u4e48\u5bf9\u6bcf\u4e2a $s_i$\uff0c\u8bbe $v = \\frac{S}{\\gcd(S, s_i)}$\uff0c\u5b83\u53ef\u4ee5\u5bf9 $k = v, 2v, 3v, \\dots $ \u4ea7\u751f\u8d21\u732e\uff0c\u53e6\u5916\u6ce8\u610f $k \\leq n$\u3002\u4e8e\u662f\u6211\u4eec\u7528\u6876\u5b58\u4e00\u4e0b\uff0c\u7136\u540e\u7d2f\u52a0\u4e00\u904d\uff0c\u5c31\u80fd\u5728\u8c03\u548c\u7ea7\u6570\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\uff0c\u6c42\u51fa\u6240\u6709 $f(k)$ \u4e86\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n\\log n)$\u3002\n\n\u7136\u540e\u8003\u8651\u4e0d\u6b62\u5212\u5206\u4e00\u8f6e\u7684\u95ee\u9898\u3002\u8bbe $\\mathrm{dp}(k)$ \u8868\u793a\u5212\u5206\u4e86\u82e5\u5e72\u8f6e\uff0c\u5f97\u5230 $k$ \u4e2a\u8fde\u901a\u5757\u7684\u65b9\u6848\u6570\u3002\u6839\u636e\u5212\u5206\u65b9\u6848\u7684\u552f\u4e00\u6027\uff0c\u5b83\u4e0a\u4e00\u8f6e\u5212\u5206\u51fa\u7684\u8fde\u901a\u5757\u6570\uff0c\u80fd\u4e14\u4ec5\u80fd\u662f $k$ \u7684\u7ea6\u6570\u3002\u4e8e\u662f\u53ef\u4ee5\u5199\u51fa\u8f6c\u79fb\uff1a\n$$\n\\mathrm{dp}(k) = f(k)\\cdot \\sum_{ i | k } \\mathrm{dp}(i)\n$$\n\u7b54\u6848\u5c31\u662f $\\sum_{k = 1}^{n} \\mathrm{dp}(k)$\u3002\u8fd9\u4e2a DP \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u662f\u8c03\u548c\u7ea7\u6570\uff1a $\\mathcal{O}(n\\log n)$ \u7684\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n(\\log n + \\log a))$\uff0c\u5176\u4e2d $\\log a$ \u6765\u81ea\u6c42 $\\gcd$\u3002\n\n## \u53c2\u8003\u4ee3\u7801\n\n\u7247\u6bb5\uff1a\n\n```cpp\nconst int MAXN = 1e6;\nconst int MOD = 1e9 + 7;\n\nint n, a[MAXN + 5], fa[MAXN + 5];\nll s[MAXN + 5], S;\nint f[MAXN + 5], dp[MAXN + 5];\n\nll gcd(ll x, ll y) { return (!y) ? x : gcd(y, x % y); }\n\nint main() {\n\tcin >> n;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tcin >> a[i];\n\t\ts[i] = a[i];\n\t\tS += a[i];\n\t}\n\tfor (int i = 2; i <= n; ++i) {\n\t\tcin >> fa[i];\n\t}\n\tfor (int i = n; i >= 2; --i) {\n\t\ts[fa[i]] += s[i];\n\t}\n\tassert(s[1] == S);\n\t\n\tfor (int i = 1; i <= n; ++i) {\n\t\tll v = S / gcd(S, s[i]);\n\t\tif (v <= n) {\n\t\t\tf[v]++;\n\t\t}\n\t}\n\tfor (int i = n; i >= 1; --i) {\n\t\tfor (int j = i + i; j <= n; j += i) {\n\t\t\tf[j] += f[i];\n\t\t}\n\t}\n\t\n\tfor (int i = 1; i <= n; ++i) {\n\t\tf[i] = (f[i] == i); // \u6070\u597d\u80fd\u5212\u5206\u4e3a i \u5757\n\t}\n\t\n\tdp[1] = 1;\n\tint ans = 0;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tif (!f[i]) {\n\t\t\tdp[i] = 0;\n\t\t\tcontinue;\n\t\t}\n\t\tfor (int j = i + i; j <= n; j += i) {\n\t\t\tdp[j] = (dp[j] + dp[i]) % MOD;\n\t\t}\n\t\tans = (ans + dp[i]) % MOD;\n\t}\n\t\n\tcout << ans << endl;\n\treturn 0;\n}\n```\n\n\n\n",
        "postTime": 1613296291,
        "uid": 100674,
        "name": "duyi",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1034C \u3010Region Separation\u3011"
    },
    {
        "content": "\u8fd9\u91cc\u8bb2\u4e00\u4e2a\u975e\u6b63\u89e3\u7684\u5947\u602a\u505a\u6cd5\u3002\n\n\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u6c42\u51fa\u6743\u503c\u548c $m = \\displaystyle\\sum_{i = 1}^n a_i$\uff0c\u5219\u5355\u8fde\u901a\u5757\u6743\u503c\u548c**\u4e00\u5b9a\u4e3a $m$ \u7684\u56e0\u6570**\u3002\n\n\u8fd9\u91cc\u6211\u4eec\u8003\u8651\u679a\u4e3e\u4e00\u4e2a\u56e0\u6570 $d$\u3002\u6211\u4eec\u600e\u4e48\u5224\u65ad\uff1a\u662f\u5426\u5b58\u5728\u4e00\u79cd\u65b9\u6848\uff0c\u4f7f\u5f97\u5206\u51fa\u7684\u5355\u4e2a\u8fde\u901a\u5757\u548c\u4e3a $d$\uff1f\n\n\u8fd9\u91cc\u8003\u8651\u81ea\u4e0b\u800c\u4e0a\u5730\u6784\u9020\u3002\u4e0d\u59a8\u9009\u62e9 $1$ \u4e3a\u6839\uff0c\u5219\u780d\u6811\u8fc7\u7a0b\u53ef\u4ee5\u8868\u8ff0\u4e3a\uff1a\n\n- \u5c06\u780d\u53bb\u7684\u6bcf\u6761\u8fb9\u6309\u8f83\u6d45 / \u6df1\u7aef\u70b9\u7684\u6df1\u5ea6\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\u3002**\u8fd9\u91cc\u5f3a\u5236\u52a0\u4e0a $0 \\to 1$**\u3002\n- \u904d\u5386\u6392\u5e8f\u540e\u7684\u6240\u6709\u8fb9 $u \\to v$\u3002\n- \u5c06\u5f53\u524d $v$ \u5b50\u6811\u4f5c\u4e3a\u4e00\u4e2a\u8fde\u901a\u5757\u5e76\u5220\u53bb\u5f53\u524d\u7684 $v$ \u5b50\u6811\u3002\n\n\u6ce8\u610f\u5230\u4e00\u4ef6\u4e8b\uff1a\u8f83\u6d45 / \u6df1\u7aef\u70b9\u6df1\u5ea6\u6700\u5927\u7684\u5b50\u6811\u4e00\u5b9a\u662f\u539f\u6811\u7684\u4e00\u68f5\u5b50\u6811\uff0c\u4e14\u8fd9\u68f5\u5b50\u6811\u662f\u56fa\u5b9a\u7684\u2014\u2014\u6216\u8005\u8bf4\u867d\u7136\u6709\u51e0\u4e2a\u9009\u9879\uff0c\u4f46\u5b83\u4eec\u4e92\u4e0d\u5f71\u54cd\uff0c\u8fd9\u91cc\u6211\u4eec\u968f\u4fbf\u94a6\u5b9a\u4e00\u4e2a\u5c31\u884c\u3002\n\n\u4e8e\u662f\u5220\u53bb\u5b83\u4ee5\u540e\u7684\u6811\u7684\u5f62\u6001\u56fa\u5b9a\uff0c\u8fdb\u800c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u6bcf\u4e00\u6b65\u90fd\u56fa\u5b9a\u3002\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u5982\u4e0b\u7ed3\u8bba\uff1a\n\n- \u5bf9\u4e8e\u4efb\u610f $d$\uff0c**\u5047\u5982 $d$ \u6709\u89e3\uff0c\u5219\u89e3\u552f\u4e00**\u3002\n\n\u8003\u8651\u6293\u51fa\u6240\u6709 $m$ \u7684\u56e0\u6570\u8fdb\u884c\u4e0a\u8ff0\u5224\u65ad\u3002\n\n\u73b0\u5728\u8003\u8651\u5982\u4f55\u8ba1\u6570\u3002\u6ce8\u610f\u5230\u9898\u76ee\u63cf\u8ff0\u4e2d\u8bf4\uff0c**\u6211\u4eec\u53ef\u4ee5\u591a\u6b21\u780d\u6811\u4f46\u6bcf\u6b21\u90fd\u5fc5\u987b\u6ee1\u8db3\u6761\u4ef6**\u3002\n\n\u8003\u8651 dp\uff0c\u8bbe $dp_d$ \u8868\u793a\u4f7f\u5f97\u5176\u5f53\u524d\u6bcf\u4e2a\u8fde\u901a\u5757\u548c\u4e3a $d$ \u7684\u65b9\u6848\u6570\u3002**\u8fd9\u91cc\u6211\u4eec\u53ea\u8ba8\u8bba $d$ \u6709\u89e3\u7684\u60c5\u51b5\u3002**\n\n\u9996\u5148\u4f60\u53ef\u4ee5\u76f4\u63a5\u780d\u6389\u6240\u6709\u9700\u8981\u7684\u8fb9\uff0c\u8fd9\u91cc\u7684\u8d21\u732e\u4e3a $1$\u3002\n\n\u4f46\u4f60\u4e5f\u53ef\u4ee5\u4ece\u67d0\u4e2a $d \\mid d' \\mid m$ \u4e14 $d < d' < m$ \u8f6c\u79fb\u8fc7\u6765\u2014\u2014\u5047\u5982 $d'$ \u6240\u9700\u8981\u780d\u7684\u8fb9\u662f $d$ \u7684\u5b50\u96c6\u3002\n\n\u600e\u4e48\u5224\u5b9a\u5462\uff1f\u6253\u8868\u53d1\u73b0\uff1a**\u5f53 $d'$ \u6709\u89e3\uff0c\u59cb\u7ec8\u6210\u7acb**\u3002\n\n\u4e3a\u4ec0\u4e48\u5462\uff1f\u611f\u6027\u7406\u89e3\u7684\u8bdd\uff0c\u4f60\u53ef\u4ee5\u628a $d$ \u4e2d\u780d\u6389\u7684\u6ee1\u8db3 $v_1$ \u4e3a $u_2$ \u7684\u7956\u5148\u7684 $u_1 \\to v_1$ \u548c $u_2 \\to v_2$\uff0c\u901a\u8fc7\u5220\u6389 $u_2 \\to v_2$ \u4f7f\u4e4b\u53d8\u6210\u4e00\u4e2a\u65b0\u7684\u6743\u503c\u4e3a\u539f\u6765\u4e24\u8005\u6743\u503c\u548c\u7684\u8fde\u901a\u5757\uff0c\u8fd9\u6837\u9010\u6b65\u5408\u5e76\u5373\u53ef\u5f97\u5230\u65b0\u7684\u6743\u503c\u548c\u4e3a $d'$ \u7684\u8fde\u901a\u5757\u3002\n\n\u76f4\u63a5\u8f6c\u79fb\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\tau(m)(n + \\tau(m)))$\uff0c\u663e\u7136\u4e0d\u80fd\u901a\u8fc7\u3002\n\n\u73b0\u5728\u6211\u4eec\u6765\u526a\u679d\u2014\u2014\u53ea\u8003\u8651 $\\geq \\max a_i$ \u7684\u56e0\u6570\uff0c\u4f46\u8fd8\u662f\u4e0d\u80fd\u901a\u8fc7\u3002\n\n\u8003\u8651\u52a0\u4e0a\u66f4\u591a\u526a\u679d\u2014\u2014\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u53ef\u80fd\u6709\u89e3\u7684 $d$\uff0c**\u4e00\u5b9a $\\exists 1 \\leq u \\leq n$ \u4f7f\u5f97 $d$ \u4e3a $u$ \u5b50\u6811\u5185\u7684\u6743\u503c\u548c**\u3002\n\n\u7136\u540e\u5c31\u80fd\u8fc7\u4e86\uff0c\u5c3d\u7ba1\u6211\u4e0d\u4f1a\u7b97\u73b0\u5728\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff08\n\n~~\u6ce8\u610f\u5728 CF \u4e0a\u8981\u5f00 C++20\uff08~~\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <iostream>\n#include <algorithm>\n#include <cstdio>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint a[1000007], f[1000007], dp[26887];\nll divisor[1000007], sum[1000007];\n\ninline int read(){\n\tint ans = 0;\n\tchar ch = getchar();\n\twhile (ch < '0' || ch > '9'){\n\t\tch = getchar();\n\t}\n\twhile (ch >= '0' && ch <= '9'){\n\t\tans = ans * 10 + (ch ^ 48);\n\t\tch = getchar();\n\t}\n\treturn ans;\n}\n\ninline ll check(int n, ll m){\n\tfor (register int i = 0; i <= n; i++){\n\t\tsum[i] = a[i];\n\t}\n\tfor (register int i = n; i >= 1; i--){\n\t\tif (sum[i] == m) sum[i] = 0;\n\t\tsum[f[i]] += sum[i];\n\t\tif (sum[f[i]] > m) return false;\n\t}\n\treturn true;\n}\n\nint main(){\n\tint n = read(), max_val = 0, cnt = 0, ans = 0;\n\tfor (register int i = 1; i <= n; i++){\n\t\ta[i] = read();\n\t\tmax_val = max(max_val, a[i]);\n\t}\n\tfor (register int i = 2; i <= n; i++){\n\t\tf[i] = read();\n\t}\n\tfor (register int i = n; i >= 1; i--){\n\t\tsum[i] += a[i];\n\t\tsum[f[i]] += sum[i];\n\t}\n\tfor (register int i = 1; i <= n; i++){\n\t\tif (sum[i] >= max_val && sum[1] % sum[i] == 0) divisor[++cnt] = sum[i];\n\t}\n\tsort(divisor + 1, divisor + cnt + 1);\n\tcnt = unique(divisor + 1, divisor + cnt + 1) - divisor - 1;\n\tfor (register int i = cnt; i >= 1; i--){\n\t\tif (check(n, divisor[i])){\n\t\t\tdp[i] = 1;\n\t\t\tfor (register int j = i + 1; j < cnt; j++){\n\t\t\t\tif (divisor[j] % divisor[i] == 0) dp[i] += dp[j];\n\t\t\t}\n\t\t\tans += dp[i];\n\t\t}\n\t}\n\tcout << ans;\n\treturn 0;\n}\n```",
        "postTime": 1668585976,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1034C \u3010Region Separation\u3011"
    },
    {
        "content": "\u6211\u89c9\u5f97\u8fd9\u6837\u4e00\u9053\u9898\u80fd\u72ec\u7acb\u505a\u51fa\u6765\u5e94\u8be5\u662f\u4f1a\u5f88\u6709\u6210\u5c31\u611f\u7684\u3002\n\n\u600e\u4e48\u56de\u4e8b\u5462\uff0c\u4e3a\u4ec0\u4e48\u53ea\u6709 2700 \u5462\uff0c\u4e0d\u5e94\u8be5\u554a\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u4ee4 $s_u$ \u8868\u793a $u$ \u7684\u5b50\u6811\u7684\u6743\u503c\u548c\uff0c\u4ee4 $S$ \u8868\u793a\u6574\u68f5\u6811\u7684\u6743\u503c\u548c\u3002\n\n\u8003\u8651\u679a\u4e3e\u6bcf\u4e00\u6bb5\u7684\u6743\u503c\u548c $x$\uff0c\u4e00\u4e2a\u5f88\u91cd\u8981\u7684\u7ed3\u8bba\u662f\u5982\u679c\u6709\u65b9\u6848\uff0c\u90a3\u4e48\u53ea\u6709\u4e00\u4e2a\u65b9\u6848\u3002\n\n\u7c97\u7565\u5730\u8bb2\u4e00\u4e0b\u8bc1\u660e\uff0c\u5927\u6982\u5c31\u662f\u4f60\u5728\u9009\u65b9\u6848\u7684\u65f6\u5019\uff0c\u4e00\u5b9a\u662f\u9009\u4e00\u4e2a\u6743\u503c\u548c\u4e3a $x$ \u7684\u5b50\u6811\uff0c\u7136\u540e\u5220\u6389\u8fd9\u4e2a\u5b50\u6811\uff0c\u91cd\u590d\u8fd9\u4e2a\u6b65\u9aa4\u3002\u56e0\u4e3a\u539f\u56fe\u662f\u68f5\u6709\u6839\u6811\uff0c\u6240\u4ee5\u6309\u8fd9\u4e2a\u6b65\u9aa4\u5206\u51fa\u7684\u65b9\u6848\u662f\u552f\u4e00\u7684\u3002\n\n\u8fdb\u4e00\u6b65\u5730\uff0c\u600e\u4e48\u5224\u65ad\u6709\u65b9\u6848\u5462\uff1f\u53ea\u8981\u6ee1\u8db3 $s_u$ \u662f $x$ \u7684\u500d\u6570\u7684 $u$ \u521a\u597d\u6709 $\\frac{S}{x}$ \u4e2a\u5373\u53ef\u3002\n\n\u8fd9\u4e2a\u8bc1\u660e\u4e5f\u662f\u7b80\u5355\u7684\uff0c\u8003\u8651\u5bf9\u4e8e\u4e00\u4e2a $u$\uff0c\u9664\u53bb\u5b83\u6240\u6709\u7684\u53ef\u4ee5\u62c6\u5206\u7684\u540e\u8f88\u7684\u5b50\u6811\uff0c\u90a3\u4e48\u5269\u4e0b\u7684\u8fd9\u4e2a\u96c6\u5408\u4e00\u5b9a\u4ecd\u7136\u662f $x$ \u7684\u500d\u6570\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u5047\u8bbe\u6ee1\u8db3\u6761\u4ef6\u7684 $u$ \u6709 $cnt$ \u4e2a\u3002\n\n\u90a3\u4e48\u8bf4\u660e\u53ef\u4ee5\u62c6\u5206\u51fa $cnt$ \u4e2a\u96c6\u5408\uff0c\u6bcf\u4e2a\u96c6\u5408\u90fd\u662f $x$ \u7684\u500d\u6570\u3002\u56e0\u4e3a $a_i>0$\uff0c\u6240\u4ee5\u6bcf\u4e2a\u96c6\u5408\u7684\u5927\u5c0f\u90fd\u662f\u6b63\u6574\u6570\u3002\u90a3\u4e48\u663e\u7136\u6ca1\u6709 $cnt>\\frac{S}{x}$\uff0c\u8fdb\u4e00\u6b65\u5730\uff0c\u5f53 $cnt=\\frac{S}{x}$ \u65f6\uff0c\u552f\u4e00\u7684\u5206\u914d\u65b9\u6848\u5c31\u662f\u6bcf\u4e2a\u96c6\u5408\u521a\u597d\u4e3a $x$\u3002\n\n\u90a3\u4e48\u73b0\u5728\u628a\u5f0f\u5b50\u5217\u51fa\u6765\uff0c\u8981\u6c42 $s_u=px$\u3002\n\n\u8fd9\u91cc\u6709\u4e00\u4e2a\u95ee\u9898\u5728\u4e8e $x$ \u662f\u4efb\u4e00 $S$ \u7684\u56e0\u6570\uff0c\u8fd9\u73a9\u610f\u5f88\u591a\uff0c\u4e5f\u5f88\u5927\uff0c\u4e0d\u597d\u5904\u7406\u3002\n\n\u4f46\u662f\u53d1\u73b0 $\\frac{S}{x}$ \u5f88\u5c0f\uff0c\u56e0\u4e3a\u4f60\u6700\u591a\u53ea\u80fd\u5206\u6210 $n$ \u6bb5\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u6362\u4e2a\u8bbe $x$ \u7684\u65b9\u6cd5\uff0c\u4ee4 $x$ \u8868\u793a\u5206\u6210 $x$ \u6bb5\uff0c\u6bcf\u6bb5\u7684\u5927\u5c0f\u4e3a $\\frac{S}{x}$\u3002\n\n\u90a3\u4e48\u6709 $s_u=p\\times\\frac{S}{x}$\u3002\n\n\u8003\u8651\u79fb\u9879\uff0c\u6709 $x=p\\times\\frac{S}{s_u}$\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e00\u4e2a\u70b9 $u$ \u7684\u5b50\u6811\u5bf9\u6240\u6709\u7684\u6ee1\u8db3\u662f $\\frac{S}{\\gcd(S,s_u)}$ \u7684\u500d\u6570\u7684 $x$ \u6ee1\u8db3\u6761\u4ef6\u3002\n\n\u500d\u6570\u662f\u597d\u5904\u7406\u7684\uff0c\u5148\u5b58\u5728 $\\frac{S}{\\gcd(S,s_u)}$\uff0c\u6700\u540e\u8c03\u548c\u7ea7\u6570\u626b\u4e00\u904d\u5c31\u884c\u4e86\u3002\n\n\u90a3\u4e48\u73b0\u5728\u5f97\u5230\u4e86 $g_i$ \u8868\u793a\u5206\u6210 $i$ \u6bb5\u662f\u5426\u53ef\u884c\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u628a\u539f\u9898\u5206\u88c2\u7684\u8fc7\u7a0b\u53cd\u8fc7\u6765\uff0c\u6539\u4e3a\u5408\u5e76\u7684\u8fc7\u7a0b\uff0c\u73b0\u5728\u8981\u6c42 $f_i$ \u8868\u793a\u4ece\u82e5\u5e72\u6bb5\u5f00\u59cb\uff0c\u6700\u7ec8\u5408\u5e76\u5230\u53ea\u6709 $i$ \u6bb5\u7684\u65b9\u6848\u6570\uff0c\u663e\u7136\u7b54\u6848\u6c42 $f_1$\u3002\n\n\u8f6c\u79fb\u662f\u7b80\u5355\u7684\u3002\n\n$$f_i=(\\sum_{i\\mid j}f_j+1)\\times g_i$$\n\n\u603b\u590d\u6742\u5ea6\u4e3a $O(n\\ln n+n\\log a)$\u3002\n\nhttps://codeforces.com/contest/1034/submission/172629101",
        "postTime": 1663574435,
        "uid": 115936,
        "name": "\u6cf7\u6cfd\u4e09\u6708",
        "ccfLevel": 0,
        "title": "CF1034C"
    }
]
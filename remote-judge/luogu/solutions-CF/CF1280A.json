[
    {
        "content": "[\u672c\u573a\u6bd4\u8d5b\u5b8c\u6574\u9898\u89e3](https://www.luogu.com.cn/blog/c2522943959/cf1281round-607-div-2-ti-xie)\n\n### C - Cut and Paste\n\u7ed9\u4e00\u4e2a\u4e32$s$(\u4e0b\u6807\u4ece1\u5230$n)$,\u548c\u4e00\u4e2a\u53d8\u91cf$it$,\u521d\u59cb\u4e3a$0$.\u8981\u4f60\u6267\u884c$x$\u6b21\u64cd\u4f5c,\u6c42\u6700\u540e\u7684\u4e32\u957f\u5ea6\u5bf9$10^9+7$\u53d6\u6a21\u7684\u7ed3\u679c.  \n\u64cd\u4f5c\u5982\u4e0b:  \n1. \u5c06$it+1$  \n2. \u5c06\u526a\u8d34\u677f\u7684\u5185\u5bb9\u66ff\u6362\u4e3a$[it,n]$($n$\u662f\u5f53\u524d\u7684\u4e32\u7684\u957f\u5ea6),\u5e76\u5728\u539f\u4e32\u4e2d\u5220\u9664$[it,n]$\n3. \u5728\u4e32\u7684\u672b\u5c3e\u628a\u526a\u8d34\u677f\u5185\u5bb9\u7c98\u8d34$s_{it}$\u6b21\n\n$x\\le 10^6$,\u539f\u4e32\u957f\u5ea6$\\le 500$  \n\n\u8fd9\u9898\u7684\u505a\u6cd5\u662f\u975e\u5e38\u663e\u7136\u7684:  \n\u56e0\u4e3a$it$\u4e0d\u4f1a\u79fb\u52a8\u5230$x$\u4e4b\u540e,\u4e5f\u5c31\u662f\u5bf9\u4e8e$x$\u4e4b\u540e\u7684\u90e8\u5206,\u6211\u4eec\u53ea\u9700\u8981\u5173\u5fc3\u957f\u5ea6,\u800c\u4e0d\u9700\u8981\u5173\u5fc3\u5177\u4f53\u7684$s_i$\n\n\u957f\u5ea6\u5982\u4f55\u7b97?\u8bbe\u5f53\u524d\u7684\u4e32\u957f\u662f$ans$,\u5219\n$$ans=(ans+((ans-it-1+mod)\\%mod)*(s[i]-'1'))\\%mod$$\n\n~~\u597d\u50cf\u6709\u70b9\u4e11~~\u5199\u6210\u4ee3\u7801\u5c31\u662f`ans=(ans+((ans-i-1+mod)%mod)*(s[i]-'1'))%mod;`\n\u5c31\u662f\u628a\u540e\u9762\u7684\u90e8\u5206\u590d\u5236`s[i]-'1'`\u6b21.\n\n\u5982\u679c\u5728$x$\u4e4b\u524d,\u76f4\u63a5\u66b4\u529b,\u56e0\u4e3a$x\\le 10^6$\u6240\u4ee5\u8fd9\u6837\u505a\u65f6\u95f4\u590d\u6742\u5ea6$O(x)$\u662f\u4e0d\u4f1aTLE\u7684.\n```cpp\n/**********/\nstr s;\nconst ll mod=ll(1e9+7);\nint main()\n{\n\tll task=read();\n\twhile(task--)\n\t{\n\t\tll x=read(),ans=0;\n\t\tstd::cin>>s;\n\t\tans=s.size();\n\t\tfor(ll i=0;i<x;++i)\n\t\t{\n\t\t\tif(s.size()>=x)//\u8fd9\u91cc\u4e0d\u80fd\u5199ans,\u56e0\u4e3aans\u53d6\u6a21\u4e4b\u540e\u53ef\u80fd\u53d8\u5c0f\u4e86\n\t\t\t{\n\t\t\t\tans=(ans+((ans-i-1+mod)%mod)*(s[i]-'1'))%mod;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(s[i]=='2')s+=s.substr(i+1);\n\t\t\t\tif(s[i]=='3')s+=s.substr(i+1)+s.substr(i+1);//\u66b4\u529b\n\t\t\t\tans=s.size();\n\t\t\t}\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1576475673,
        "uid": 73142,
        "name": "\u4e07\u5f18",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1280A \u3010Cut and Paste\u3011"
    },
    {
        "content": "## \u601d\u8def\n\n\u4e00\u770b\u5230\u8fd9\u9053\u9898\uff0c\u53c8\u4ee5\u4e3a\u662f\u4e2a~~\u66b4\u529b~~\u56f0\u96be\u7684\u8981\u52a0\u5947\u602a\u7684\u4f18\u5316\u7684\u9898\u3002\n\n\u7136\u540e\u770b\u5230\u4e86\u6570\u636e\u8303\u56f4\uff1a$x \\leq 10^6$\uff01\n\n\u90a3\u8fd9\u4e0d\u662f\u5927\u6c34\u9898\u5417\uff01\u505a\u6cd5\u4e5f\u5c31\u4e86\u7136\u4e86\uff1a\u6bcf\u6b21\u770b\u4e00\u4e0b\u590d\u5236\u7684\u64cd\u4f5c\uff0c\u56e0\u4e3a\u8981\u7528\u5230\u524d $x$ \u4e2a\u5b57\u7b26\uff0c\u6240\u4ee5\u6bcf\u6b21\u5224\u65ad\uff0c\u5982\u679c\u590d\u5236\u4e4b\u540e $|s| \\leq x$\uff0c\u5c31\u590d\u5236\uff1b\u5426\u5219\u8bb0\u5f55\u5b83\u5c06\u6765\u4e5f\u4e0d\u4f1a\u66f4\u65b0\uff0c\u662f\u6ca1\u7528\u7684\u3002\n\n\u8fd9\u6837\u7684\u8bdd\u65f6\u95f4\u590d\u6742\u5ea6\u5927\u6982\u662f $O(nk)$\uff0c\u5176\u4e2d $k$ \u4e3a\u7384\u5b66\u5e38\u6570\uff0c\u56e0\u4e3a string \u592a\u6162\u4e86\uff0c\u6240\u4ee5\u4f1a\u5728\u6781\u9650\u6570\u636e T \u4e0a\u5929\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u8981\u4f18\u5316\u4e00\u4e0b\u3002\u53d1\u73b0\u5f53 $s_i = 1$ \u7684\u65f6\u5019\uff0c\u76f8\u5f53\u4e8e\u505a\u65e0\u7528\u529f\uff0c\u53ea\u8981\u8df3\u8fc7\u5373\u53ef\u3002\u7136\u540e\u5c31\u6109\u5feb\u7684 AC \u4e86\u6b64\u9898\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst ll mod=1e9+7;\nstring s;\nint main()\n{\n\tint T,x; scanf(\"%d\",&T);\n\twhile(T--)\n\t{\n\t\tscanf(\"%d\",&x); cin>>s;\n\t\ts=' '+s;\n\t\tint it=1;\n\t\tll nowlen=s.size();\n\t\tfor(register int i=1;i<=x;i++)\n\t\t{\n\t\t\tit++;\n\t\t\tint t=s[it-1]-48;\n\t\t\tif(t==1) continue;\n\t\t\tif(s.size()<=x+1)\n\t\t\t{\n\t\t\t\tstring s1=\"\";\n\t\t\t\tfor(register int j=it;j<s.size();j++) s1+=s[j];\n\t\t\t\tfor(register int i=1;i<t;i++)\n\t\t\t\t{\n\t\t\t\t\ts+=s1;\n\t\t\t\t\tif(s.size()>x+1) break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tll tmp=nowlen-(ll)it;\n\t\t\tnowlen=(nowlen+tmp*(ll)(t-1)%mod)%mod;\n\t\t}\n\t\tprintf(\"%lld\\n\",(nowlen-1ll+mod)%mod);\n\t}\n\t\n\treturn 0;\n}\n```",
        "postTime": 1651231925,
        "uid": 195198,
        "name": "E1_de5truct0r",
        "ccfLevel": 7,
        "title": "CF1280A \u9898\u89e3"
    },
    {
        "content": "\u6211\u4eec\u4e0d\u59a8\u8003\u8651\u8f6c\u5316\u601d\u8def\u3002\n\n\u663e\u7136\uff0c\u5982\u679c\u5b8c\u5168\u66b4\u529b\u679a\u4e3e\uff0c\u4e32\u7684\u957f\u5ea6\u6210\u6307\u6570\u7ea7\u589e\u957f\u3002\n\n\u4f46\u56e0\u4e3a\u6211\u4eec\u53ea\u8981\u5bf9\u524d $x$ \u4e2a\u6570\u64cd\u4f5c\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u53ea\u66b4\u529b\u51fa\u524d $x$ \u4e2a\u6570\uff0c\u590d\u6742\u5ea6$O(x)$\u3002\u5bf9\u4e8e\u5269\u4e0b\u7684\u76f4\u63a5\u6269\u5c55\u957f\u5ea6\uff0c\u800c\u4e0d\u7528\u7ef4\u62a4\u51fa\u6269\u5c55\u4e86\u591a\u5c11\u3002\n\n\u6ce8\u610f\u4e00\u4e0b\u7a7a\u95f4\u95ee\u9898\uff0c\u6700\u597d\u4f7f\u7528$vector$\u6216\u8005$string$\uff0c\u7701\u5f97RE\n\n\u518d\u6ce8\u610f\u4e00\u4e0b\u8d1f\u6570\u53d6\u6a21\u95ee\u9898\u5c31\u53ef\u4ee5AC\u4e86\n\n```cpp\n#pragma GCC optimize(3)\n#pragma GCC optimize(2)\n#include<bits/stdc++.h>\n#define ll long long\n#define int long long\n#define reaD() read()\n#define pb push_back\n#define mkp make_pair\n#define mst(a,b) memset(a,b,sizeof(a))\n#define foR(i, k, j) for(register int i = (k); i >= (j); i--)\n#define For(i, k, j) for(register int i = (k); i <= (j); i++)\n#define DEBUG fprintf(stderr, \"***IAKIOI***\\n\")\n#define CDEBUG cerr << \"***IAKIOI***\" << endl;\n#define IOS ios::sync_with_stdio(0), cin.tie(0), cout.tie(0)\nconst int MOD = 1000000007; //\nusing namespace std;\ninline void ckmax(int &a, int b) {a = max(a, b);}\ninline void ckmin(int &a, int b) {a = min(a, b);}\ninline void addmod(int &a, int b) {int t = a + b; a = (t >= MOD ? t - MOD : t); }\ninline int read() {\n    int num=0,flag=1;char c=' ';\n    for(;c>'9'||c<'0';c=getchar()) if(c=='-') flag=-1;\n    for(;c>='0'&&c<='9';num=num*10+c-48,c=getchar());\n    return num*flag;\n}\nint x;\nstring s;\nsigned main()\n{\n\tIOS;\n\tint T; cin >> T; \n\twhile(T--) {\n\t\tcin >> x >> s; s = ' ' + s;\n\t\tint n = s.size()-1, i = 1;\n\t\tfor(; i <= x; i++) {\n\t\t\tif(n > x) break;\n\t\t\tif(s[i] - '0' == 2) {\n\t\t\t\tstring t = s.substr(i+1);\n\t\t\t\ts += t;\n\t\t\t} else if(s[i] - '0' == 3) {\n\t\t\t\tstring t = s.substr(i+1);\n\t\t\t\ts += t; s += t;\n\t\t\t}\n\t\t\tn = s.size()-1;\n\t\t}\n\t\tfor(; i <= x; i++) {\n\t\t\tif(s[i] - '0' == 2) {\n\t\t\t\tn += (n - i);\n\t\t\t} else if(s[i] - '0' == 3) {\n\t\t\t\tn += (n - i) * 2;\n\t\t\t}\n\t\t\tn %= MOD;\n\t\t\tn = (n + MOD) % MOD; \n\t\t}\n\t\tcout << (n % MOD + MOD) % MOD << endl;\n\t} \n    return 0;\n}\n```",
        "postTime": 1576645408,
        "uid": 55078,
        "name": "YLWang",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1280A \u3010Cut and Paste\u3011"
    }
]
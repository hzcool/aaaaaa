[
    {
        "content": "$\\large\\text{Solution}$\n\n\u6211\u4eec\u628a\u6574\u4e2a\u884c\u8d70\u8fc7\u7a0b\u5206\u4e3a $2$ \u6bb5\uff1a\n\n1. $(m,0)\\to(0,0)$\n2. $(0,n)\\to(0,0)$\n\n\u4ee5\u4e0b\u8bbe\u5750\u6807 $P(x,y)$ \u4e3a\u672a\u77e5\u4fe1\u6807\u7684\u4f4d\u7f6e\u3002\n\n\u5148\u8003\u8651\u7b2c\u4e00\u6bb5\u3002\n\n\u4e09\u89d2\u5f62\u9762\u79ef\u53ef\u4ee5\u901a\u8fc7\u5411\u91cf $\\overrightarrow {PN}\\times\\overrightarrow{PM}$ \u7684\u6a21\u9664\u4ee5 $2$ \u5f97\u5230\uff08[\u5982\u679c\u4f60\u4e0d\u77e5\u9053\u53c9\u79ef](https://baike.baidu.com/item/%E5%90%91%E9%87%8F%E7%A7%AF/4601007?fromtitle=%E5%8F%89%E4%B9%98&fromid=8251892&fr=aladdin)\uff09\uff0c\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u901a\u8fc7\u66b4\u529b\u5206\u7c7b\u8ba8\u8bba\u3002\n\n\u6839\u636e\u9762\u79ef $=s$ \u5f97\u5230 $|nx+my-mn|=2s$\uff0c\u6839\u636e\u88f4\u8700\u5b9a\u7406\uff0c\u5982\u679c\u5b58\u5728 $\\gcd(n,m)\\mid2s$ \u5219\u6709\u6574\u6570\u89e3\u3002\n\n\u95ee\u9898\u8f6c\u5316\u4e3a\u6c42\u6709\u591a\u5c11 $k$ \u6ee1\u8db3 $k\\in[1,m],\\gcd(n,k)\\mid 2s$\u3002\n\n\u8003\u8651\u6c42\u6709\u591a\u5c11 $k$ \u6ee1\u8db3 $k\\in[1,m],\\gcd(n,k)\\nmid 2s$\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff1a\u628a $n$ \u5206\u89e3\u8d28\u56e0\u6570\u6210 $\\prod\\limits_{i=1}^{cnt_n}pn_i^{kn_i}$\uff0c\u628a $s$ \u5206\u89e3\u8d28\u56e0\u6570\u6210 $\\prod\\limits_{i=1}^{cnt_s}ps_i^{ks_i}$\uff08$cnt_x$ \u8868\u793a $x$ \u7684\u8d28\u56e0\u6570\u79cd\u6570\uff0c$ps_i,pn_i$ \u662f\u8d28\u6570\uff09\uff0c\n\n\u5982\u679c\u5bf9\u4e8e\u4e00\u4e2a $pn_i=ps_j$\uff0c\u6709 $kn_i\\le ks_j$\uff0c\u90a3\u4e48 $\\gcd(n,k)$ \u4e2d $pn_i(ps_j)$ \u8fd9\u4e2a\u8d28\u56e0\u6570\u7684\u6b21\u6570\u4e00\u5b9a\u5c0f\u4e8e $s$ \u4e2d\u7684\u6b21\u6570\uff0c\u4e0d\u4f1a\u56e0\u8fd9\u4e2a\u8d28\u56e0\u6570\u4e0d\u6574\u9664\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u627e\u51fa\u5bf9\u4e8e $pn_i=ps_j$\uff0c\u6709 $kn_i> ks_j$ \u7684\u6570\uff0c\u628a $pn_i^{ks_j+1}$ \u52a0\u5165\u96c6\u5408 $P$\uff0c\u6c42 $k\\in[1,m]$\uff0c\u6ee1\u8db3\u5b58\u5728 $q\\in P,q\\mid k$ \u7684 $k$ \u7684\u6570\u91cf\uff08\u5982\u679c $k$ \u6709\u56e0\u6570 $pn_i^{ks_j+1}$\uff0c\u90a3\u4e48 $gcd(n,k)$ \u4e2d\u5b9a\u6709\u56e0\u6570 $pn_i^{ks_j+1}$\uff0c\u5b9a\u4e0d\u6574\u9664\uff09\u3002\n\n\u7136\u540e\u6211\u4eec\u5728 $[1,m]$ \u8303\u56f4\u4e2d\u8fdb\u884c\u5bb9\u65a5\u5373\u53ef\uff0c\u5bb9\u65a5\u7684\u67ff\u5b50\uff1a\n\n$\\frac{m}{q_1}+\\frac{m}{q_2}+\\dots+\\frac{m}{q_{size}}-\\frac{m}{q_1q_2}-\\frac{m}{q_1q_3}-\\dots-\\frac{m}{q_{size-1}q_{size}}+\\frac{m}{q_1q_2q_3}\\dots\\dots$\u3002\n\n$size$ \u8868\u793a\u96c6\u5408\u5927\u5c0f\u3002\n\n\u5bb9\u65a5\u672c\u8eab\u96be\u5ea6\u4e0d\u5927\uff0c\u76f8\u4fe1\u5927\u5bb6\u90fd\u80fd\u7406\u89e3\u3002\n\n\u4e0e\u4ee3\u7801\u91cc\u6709\u533a\u522b\u7684\u662f\uff1a\u4ee3\u7801\u91cc\u76f4\u63a5\u7528 $m$ \u51cf\u53bb\u4ee5\u4e0a\u67ff\u5b50\u3002\n\n------------\n\n\u7136\u540e\u8003\u8651\u7b2c\u4e8c\u6bb5\n\n\u7b2c\u4e8c\u6bb5 $M$ \u5728 $(0,0)$ \uff0c\u6240\u4ee5\u4e09\u89d2\u5f62\u9762\u79ef\u4e3a $\\frac{nx}{2}$.\n\n\u6240\u4ee5\u5c31\u662f\u8981\u6c42\u51fa $[1,n]$ \u4e2d $2s$ \u7684\u7ea6\u6570\u4e2a\u6570\u3002\n\n\u8fd9\u4e00\u90e8\u5206\u53ef\u4ee5\u5206\u89e3\u8d28\u56e0\u6570\u4e4b\u540e\u66b4\u529b\u679a\u4e3e\u6240\u6709\u7ea6\u6570\uff0c\u5224\u65ad\u662f\u5426\u5c0f\u4e8e $n$\uff0c\u7ea6\u6570\u4e2a\u6570\u5927\u7ea6\u53ea\u6709 $10^5$ \u7ea7\u522b\uff0c\u5177\u4f53\u7684\uff0c\u4f60\u53ef\u4ee5\u770b\u4ee3\u7801\u3002\n\n\n```cpp\n\nll a[3],b[3],c[3],ans,n,m,s,GG;\nvector<N>res,res1;\nvoid dfs(int stp,ll u){//\u8fc7\u7a0b\u4e8c\uff0c\u4e3b\u8981\u601d\u8def\uff1a\u679a\u4e3e\u6bcf\u4e00\u4e2a\u8d28\u56e0\u6570\u7684\u6b21\u6570\uff0c\u4ece\u800c\u679a\u4e3e\u7ea6\u6570\u3002\n\t//u \u8868\u793a\u5f53\u524d\u503c\uff0cstp \u8868\u793a\u641c\u5230\u54ea\u4e2a\u8d28\u6570\u3002\n\tif(u>GG)return;//\u5982\u679c\u5927\u4e8e\u6839\u53f7 s\uff0c\u90a3\u4e48\u5c31\u8fd4\u56de\u3002\n\tif(stp==-1){ans+=(u<=n)+(u!=s/u&&s/u<=n);return;}//\u5224\u65ad\u4e00\u4e2a\u5c0f\u4e8e\u6839\u53f7 s \u7684\u7ea6\u6570\uff0c\u53ca s \u9664\u4ee5\u8fd9\u4e2a\u7ea6\u6570\u662f\u5426\u7b26\u5408\u6761\u4ef6\u3002\n\tfor(int i=0;i<=res[stp].s;i++){\n\t\tdfs(stp-1,u);\n\t\tu*=res[stp].p;\n\t\tif(u>GG)break;\n\t}\n}\nint bit[150005];//bit\u662f\u4e8c\u8fdb\u5236\u4e0b\u7684\u4f4d\u6570\uff0c\u7528\u4e8e\u5bb9\u65a5\u3002\nvoid work(){\n\tfor(int i=0;i<(1<<17);i++)bit[i]=bit[i>>1]+(i&1);\n\tfor(int T=read();T;T--){\n\t\tans=0;\n\t\tfor(int i=0;i<3;i++)a[i]=read();\n\t\tfor(int i=0;i<3;i++)b[i]=read();\n\t\tfor(int i=0;i<3;i++)c[i]=read();\n\t\tn=a[0]*a[1]*a[2],m=b[0]*b[1]*b[2],s=c[0]*c[1]*(c[2]<<1);\n\t\tres1=Pollard_Rho::work(a[0],a[1],a[2]);//\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u8fd4\u56de\u6570\u7ec4\u6bcf\u4e2a\u5143\u7d20\u6709\u4e24\u4e2a\u53c2\u6570\uff0c.p\u8868\u793a\u8d28\u6570\uff0c.s\u8868\u793a\u6b21\u6570\u3002\n\t\tvector<ll>r;\n\t\tfor(auto I:res1){//\u8fd9\u662f\u627e\u96c6\u5408 P \u7684\u8fc7\u7a0b\n\t\t\tll cnt=I.p;\n\t\t\tfor(int J=1;J<=I.s;J++){//\u5982\u679c\u4e00\u4e2a n \u7684\u8d28\u56e0\u6570\u7684 J \u6b21\u4e0d\u662f s \u7684\u7ea6\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u627e\u5230\u4e00\u4e2a\u76ee\u6807\u5143\u7d20\n\t\t\t\tif(s%cnt){r.push_back(cnt);break;}//\u8fd9\u91cc\u53ca\u65f6 break \u6389\uff0c\u5bfc\u81f4\u4e0d\u53ef\u80fd\u52a0\u5165 p^{ks_j+2} \u8fd9\u79cd\u5143\u7d20\u3002\n\t\t\t\tcnt*=I.p;\n\t\t\t}\n\t\t}\n\t\tint gg=r.size(),ggg=(1<<r.size());\n\t\tfor(int I=0;I<ggg;I++){//\u8fd9\u662f\u5bb9\u65a5\u7684\u90e8\u5206\n\t\t\tint t=(bit[I]&1?-1:1);ll cnt=1;\n\t\t\tfor(int i=0;i<gg;i++)\n\t\t\t\tif((I>>i)&1)cnt*=r[i];\n\t\t\tans+=t*m/cnt;\n\t\t}\n\t\tsort(c,c+3);\n\t\tres=Pollard_Rho::work(c[0]<<1,c[1],c[2]);\n\t\tGG=(int)sqrt((long long)s);dfs(res.size()-1,1);\n\t\twrite(ans,'\\n');\n\t}\n}\n```\n",
        "postTime": 1642821338,
        "uid": 185864,
        "name": "TOBapNw",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 \u3010CF819C Mister B and Beacons on Field\u3011"
    }
]
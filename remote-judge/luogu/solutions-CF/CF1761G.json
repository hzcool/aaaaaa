[
    {
        "content": "\u8fd9\u91cc\u662f\u5b98\u65b9\u9898\u89e3\uff0cCF \u5b98\u65b9\u82f1\u6587\u9898\u89e3\u7531\u6b64\u9898\u89e3\u7ffb\u8bd1\u5f97\u5230\u3002\n\n\u5047\u8bbe\u6211\u4eec\u73b0\u5728\u786e\u5b9a\u4e86\u6811\u7684\u91cd\u5fc3\u5728 $u$ \u5230 $v$ \u7684\u94fe\u4e0a\uff0c\u8003\u8651\u5982\u4f55\u627e\u5230\u5b83\u3002\n\n\u8bbe $u$ \u5230 $v$ \u7684\u94fe\u7ecf\u8fc7\u7684\u6240\u6709\u70b9\u4f9d\u6b21\u4e3a $c_1,c_2,\\dots,c_k$\uff0c\u6211\u4eec\u628a\u7531\u94fe\u4e0a\u4e00\u70b9 $c_i$ \u51fa\u53d1\u4e0d\u7ecf\u8fc7\u94fe\u4e0a\u5176\u4ed6\u70b9\u53ef\u5230\u8fbe\u7684\u70b9\u7684\u96c6\u5408\u79f0\u4e3a $A_i$\uff0c\u663e\u7136 $A_1,A_2,\\dots,A_k$ \u8fd9 $k$ \u4e2a\u96c6\u5408\u4e0d\u91cd\u4e0d\u6f0f\u5730\u5305\u542b\u4e86\u6811\u4e0a\u6240\u6709\u7684 $n$ \u4e2a\u70b9\u3002\n\n\u8bbe\u96c6\u5408 $A_i$ \u7684\u5927\u5c0f\u4e3a $s_i$\uff0c\u94fe\u4e0a\u663e\u7136\u5b58\u5728\u6070\u597d\u4e00\u4e2a\u70b9 $c_x$ \u6ee1\u8db3 $\\max\\{\\sum\\limits_{i=1}^{x-1}s_i,\\sum\\limits_{i=x+1}^ks_i\\}\\le\\lfloor\\frac{n}{2}\\rfloor$\uff0c\u6ce8\u610f\u5230\u4e0d\u6ee1\u8db3\u8be5\u6761\u4ef6\u7684\u94fe\u4e0a\u7684\u70b9\u4e00\u5b9a\u4e0d\u662f\u91cd\u5fc3\uff0c\u800c\u76ee\u524d\u5df2\u7ecf\u786e\u5b9a\u91cd\u5fc3\u5728\u94fe\u4e0a\uff0c\u6240\u4ee5\u6b64\u65f6 $c_x$ \u5c31\u662f\u6811\u7684\u91cd\u5fc3\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u901a\u8fc7 $2n$ \u6b21\u8be2\u95ee\u5f97\u5230\u6811\u4e0a\u6bcf\u4e2a\u70b9\u6240\u5c5e\u96c6\u5408\uff0c\u8fdb\u800c\u6c42\u51fa $s$\u3002\u5bf9\u4e8e\u4e00\u4e2a\u70b9 $x$\uff0c\u8be2\u95ee $dis_{u,x}$ \u548c $dis_{v,x}$\uff0c\u5bb9\u6613\u53d1\u73b0\u5bf9\u4e8e\u540c\u4e2a\u96c6\u5408\u4e2d\u7684\u70b9\uff0c$dis_{u,x}-dis_{v,x}$ \u7684\u503c\u5168\u76f8\u540c\uff0c\u82e5 $dis_{u,x}-dis_{v,x}=t_1$\uff0c$dis_{u,v}=t_2$\uff0c\u5219 $x\\in A_{(t_1+t_2)/2+1}$\u3002\u4e8e\u662f\u6211\u4eec\u6c42\u51fa\u4e86\u6811\u4e0a\u6bcf\u4e2a\u70b9\u6240\u5c5e\u96c6\u5408\uff0c\u4e5f\u6c42\u51fa\u4e86 $s$\uff0c\u627e\u5230\u4e86\u91cd\u5fc3\u3002\u8fd9\u6700\u591a\u9700\u8981\u6d88\u8017 $7.5\\cdot10^4\\times2=1.5\\cdot10^5$ \u6b21\u8be2\u95ee\u3002\n\n\u73b0\u5728\u95ee\u9898\u662f\u627e\u5230\u70b9\u5bf9 $u,v$\uff0c\u4f7f\u5f97\u6811\u7684\u91cd\u5fc3\u5728 $u$ \u5230 $v$ \u7684\u94fe\u4e0a\u3002\n\n\u6211\u4eec\u53d6\u4e00\u4e2a\u5e38\u6570 $M$\uff0c\u4f7f\u5f97 $\\frac{M(M-1)}{2}\\le5\\cdot10^4$\uff0c\u7136\u540e\u5728\u6811\u4e0a\u968f\u673a\u9009\u53d6 $M$ \u4e2a\u70b9\uff0c\u5e76\u8be2\u95ee\u4e24\u4e24\u95f4\u8ddd\u79bb\uff0c\u8fd9\u9700\u8981\u6d88\u8017 $\\frac{M(M-1)}{2}\\le5\\cdot10^4$ \u6b21\u8be2\u95ee\u3002\n\n\u8bbe\u8fd9 $M$ \u4e2a\u70b9\u5206\u522b\u4e3a $p_1,p_2,\\dots,p_M$\uff0c\u6211\u4eec\u5efa\u51fa\u5305\u542b LCA \u7684\u4ee5 $p_1$ \u4e3a\u6839\u7684\u865a\u6811\u3002\u5bb9\u6613\u53d1\u73b0 $dis_{x,y}+dis_{y,z}=dis_{x,z}$\uff0c\u5f53\u4e14\u4ec5\u5f53 $y$ \u5728 $x$ \u5230 $z$ \u7684\u94fe\u4e0a\u3002\u5bf9\u4e8e\u4e00\u4e2a\u70b9 $p_x$\uff0c\u6211\u4eec\u53ef\u4ee5\u627e\u5230 $p_1$ \u5230 $p_x$ \u7684\u94fe\u4e0a\u7684\u6240\u6709\u70b9\uff0c\u627e\u5230\u8fd9\u4e9b\u70b9\u4e2d\u9664\u81ea\u5df1\u5916\u4e0e $p_x$ \u6700\u8fd1\u7684\u70b9\u4e0e $p_x$ \u8fde\u8fb9\uff0c\u5b83\u5c31\u662f\u70b9\u96c6\u4e2d $p_x$ \u7684\u6df1\u5ea6\u6700\u5927\u7684\u7956\u5148\u3002\n\n\u6b64\u65f6\u6211\u4eec\u6c42\u51fa\u4e86\u4e0d\u5305\u542b LCA \u7684\u4ee5 $p_1$ \u4e3a\u6839\u7684\u865a\u6811\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u6dfb\u52a0 LCA \u81f3\u865a\u6811\u4e2d\u3002\u8bbe\u5305\u542b LCA \u7684\u865a\u6811\u4e3a $T$\u3002\n\n\u6211\u4eec\u4ece $p_1$ \u5f00\u59cb dfs\uff0c\u8bbe\u5f53\u524d\u8282\u70b9\u4e3a $u$\uff0c\u663e\u7136 $u$ \u7684\u513f\u5b50\u4e4b\u95f4\u4e0d\u6784\u6210\u7956\u5148\u540e\u4ee3\u5173\u7cfb\uff0c\u6211\u4eec\u679a\u4e3e $u$ \u7684\u513f\u5b50 $v$\uff0c\u82e5\u53e6\u4e00\u4e2a\u513f\u5b50 $x$ \u6ee1\u8db3 $u$ \u4e0d\u5728\u539f\u6811\u4e2d $x$ \u5230 $v$ \u7684\u94fe\u4e0a\uff0c\u5219\u5728 $T$ \u4e2d $v$ \u4e0e $x$ \u5728 $u$ \u7684\u540c\u4e00\u4e2a\u5b50\u6811\u5185\uff0c\u627e\u5230\u6240\u6709\u5728 $T$ \u4e2d\u4e0e $v$ \u5728 $u$ \u7684\u540c\u4e00\u4e2a\u5b50\u6811\u5185\u7684\u70b9\u540e\uff0c\u5bb9\u6613\u8ba1\u7b97\u5b83\u4eec LCA \u7684\u6df1\u5ea6\uff0c\u5e76\u5904\u7406\u51fa LCA \u5230\u5f53\u524d\u865a\u6811\u6240\u6709\u70b9\u7684\u8ddd\u79bb\uff0c\u63a5\u7740\u65ad\u5f00\u539f\u6765\u7684\u8fb9\uff0c\u4ece LCA \u5411 $T$ \u4e2d\u4e0e $v$ \u5728 $u$ \u7684\u540c\u4e00\u4e2a\u5b50\u6811\u5185\u7684\u70b9\u8fde\u8fb9\uff0c\u7136\u540e\u4ece $u$ \u5411 LCA \u8fde\u8fb9\uff0c\u7136\u540e\u5bf9 $u$ \u91cd\u590d\u4e0a\u8ff0\u8fc7\u7a0b\uff0c\u76f4\u5230 $u$ \u7684\u513f\u5b50\u4e2d\u4efb\u610f\u4e24\u4e2a\u70b9\u90fd\u4e0d\u5728 $T$ \u4e2d $u$ \u7684\u540c\u4e00\u4e2a\u5b50\u6811\u5185\uff0c\u7136\u540e\u5411\u76ee\u524d $u$ \u7684\u513f\u5b50 dfs\u3002\u4e0d\u96be\u53d1\u73b0\uff0c\u5b8c\u6210 dfs \u540e\uff0c\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u5b8c\u6574\u7684\u865a\u6811\u3002\n\n\u4ec5\u4ec5\u5bf9\u4e8e\u539f\u59cb\u968f\u673a\u5230\u7684 $M$ \u4e2a\u70b9\uff0c\u6211\u4eec\u8ba4\u4e3a\u5b83\u7684\u70b9\u6743\u662f $1$\uff0c\u865a\u6811\u4e2d\u5176\u4ed6\u70b9\u70b9\u6743\u5747\u4e3a $0$\uff0c\u6211\u4eec\u627e\u5230\u865a\u6811\u7684\u5e26\u6743\u91cd\u5fc3\uff08\u6709\u591a\u4e2a\u65f6\u53ef\u4efb\u610f\u53d6\u5176\u4e2d\u4e00\u4e2a\uff09\uff0c\u5e76\u4ee5\u5b83\u4f5c\u4e3a\u865a\u6811\u7684\u6839\uff0c\u9009\u53d6\u5b83\u6700\u5927\u7684\u4e24\u4e2a\u5b50\u6811\u8fdb\u884c dfs\uff0c\u6bcf\u6b21\u90fd\u8d70\u6700\u5927\u7684\u5b50\u6811\uff0c\u8fd9\u6837\u5f97\u5230\u4e24\u4e2a\u53f6\u5b50\uff0c\u79f0\u5176\u4e3a $u,v$\uff0c\u539f\u6811\u7684\u91cd\u5fc3\u6709\u6781\u9ad8\u7684\u51e0\u7387\u5728 $u$ \u5230 $v$ \u7684\u94fe\u4e0a\u3002\u7136\u540e\u5957\u7528\u4e4b\u524d\u7684\u7b97\u6cd5\u5373\u53ef\u6c42\u5f97\u91cd\u5fc3\u3002\u4e24\u90e8\u5206\u603b\u8be2\u95ee\u6b21\u6570\u76f8\u52a0\u4e0d\u8d85\u8fc7 $2\\cdot10^5$\n\n\u6b63\u786e\u6027\u8bc1\u660e\uff1a\n\n\u82e5\u539f\u6811\u7684\u91cd\u5fc3\u4e0d\u5728 $u$ \u5230 $v$ \u7684\u94fe\u4e0a\uff0c\u90a3\u4e48\u8bbe\u865a\u6811\u7684\u91cd\u5fc3\u5728\u539f\u6811\u91cd\u5fc3\u7684\u5b50\u6811 $E$ \u4e2d\uff0c\u82e5\u9664\u53bb $E$ \u5916\uff0c\u539f\u6811\u7684\u91cd\u5fc3\u7684\u5176\u4ed6\u5b50\u6811\u5305\u542b\u4e86\u81f3\u5c11 $1/3$ \u7684\u6211\u4eec\u968f\u673a\u51fa\u6765\u7684\u8282\u70b9\uff0c\u90a3\u4e48\u539f\u6811\u91cd\u5fc3\u5fc5\u5728 $u$ \u5230 $v$ \u7684\u94fe\u4e0a\uff0c\u4e5f\u5c31\u662f\u8bf4 $E$ \u4e2d\u81f3\u5c11\u5305\u542b\u4e86 $2/3$ \u7684\u6211\u4eec\u968f\u673a\u51fa\u6765\u7684\u8282\u70b9\uff0c\u53c8\u7531\u4e8e $E$ \u7684\u5927\u5c0f\u4e0d\u8d85\u8fc7 $\\lfloor\\frac{n}{2}\\rfloor$\uff0c\u6240\u4ee5\u968f\u673a\u4e00\u4e2a\u70b9\u4e0d\u5728 $E$ \u4e2d\u7684\u6982\u7387\u81f3\u5c11\u4e3a $\\frac{1}{2}$\uff0c\u968f\u673a $M$ \u4e2a\u70b9\uff0c\u81f3\u591a\u6709 $1/3$ \u7684\u4e0d\u5728 $E$ \u4e2d\uff0c$E$ \u624d\u80fd\u5305\u542b $2/3$ \u7684\u6211\u4eec\u968f\u673a\u51fa\u6765\u7684\u8282\u70b9\uff0c\u4e5f\u5c31\u662f\uff0c\u968f\u673a $M$ \u4e2a\u70b9\uff0c\u6bcf\u4e2a\u70b9\u8d85\u8fc7 $1/2$ \u7684\u6982\u7387\u4e0d\u5408\u6cd5\uff0c\u81f3\u591a\u53ea\u80fd\u6709 $1/3$ \u7684\u70b9\u4e0d\u5408\u6cd5\u3002\u53ea\u6709\u8fd9\u6837\u624d\u4f1a\u4f7f\u5f97\u8be5\u7b97\u6cd5\u51fa\u9519\u3002\u8fd9\u4e2a\u6982\u7387\u4e0d\u9ad8\u4e8e $\\sum\\limits_{i=0}^{M/3}C_M^i/2^M$\uff0c\u53d6 $M=316$\uff0c\u7ea6\u4e3a $6\\cdot10^{-10}$\u3002\n\nfun fact\uff1a\n\n- \u8fd9\u4e2a\u9898\u672c\u6765\u6709 Easy \u7248\u672c\uff0c\u4f46\u662f\u8d5b\u524d\u4e00\u4e2a\u661f\u671f\u53d1\u73b0 Easy \u7248\u672c\u53ef\u4ee5\u7528\u4e00\u4e2a\u96c6\u8bad\u961f\u4e92\u6d4b\u9898\u7684\u505a\u6cd5\u89e3\u51b3\uff0c\u4e8e\u662f\u5c31\u5220\u6389\u4e86\u3002\n\n- \u8fd9\u4e2a\u9898\u5728\u9a8c\u9898\u7684\u65f6\u5019\u88ab Um_nik \u7528\u9519\u8bef\u7387\u7ea6\u4e3a $0.85\\%$ \u7684\u505a\u6cd5\u8fc7\u4e86\uff0c\u4e8e\u662f\u9020\u4e86 $500$ \u7ec4\u6570\u636e\uff0c\u6b64\u5916\u8fd8\u6709\u4e0d\u6b62\u4e00\u4e2a\u9519\u8bef\u7387\u6781\u4f4e\u7684\u505a\u6cd5\u3002\n\n\u4ee5\u4e0b\u662f std\uff08Main Correct Solution\uff09\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define N 75005\n#define S 316\n#define M 640\nint read(){\n\tint w=0;\n\tchar c=getchar();\n\twhile(c<'0'||c>'9')c=getchar();\n\twhile(c>='0'&&c<='9')w=w*10+c-48,c=getchar();\n\treturn w;\n}\nvoid report(int x){\n\tprintf(\"! %d\\n\",x);\n\texit(0);\n}\nconst int lim=2e5;\nint n,m,p[N],dis[M][M],fa[M],dep[M],d1[N],d2[N],siz[M],maxsiz[M],r[N],w[N],du,dv,idx;\nbool vis[M];\nvector<int>e[M],g[M];\nmt19937 rnd(time(NULL)^(unsigned long long)(new char));\nint rad(int x,int y){\n\treturn rnd()%(y-x+1)+x;\n}\nbool in(int x,int y,int z){\n\treturn dis[x][y]+dis[y][z]==dis[x][z];\n}\nvoid get(int u){\n\tvis[u]=1;\n\tfor(auto v:e[u])\n\t\tget(v);\n}\nbool work(int u){\n\tfor(auto v1:e[u]){\n\t\tint l=0;\n\t\tfor(auto v2:e[u])\n\t\t\tif(!in(v1,u,v2))l=max(l,(dis[v1][u]+dis[v1][v2]-dis[u][v2])/2);\n\t\tif(!l)continue;\n\t\tl=dis[u][v1]-l;\n\t\tfor(auto v2:e[u])\n\t\t\tif(!in(v1,u,v2))get(v2);\n\t\tidx++;\n\t\tfor(int i=1;i<idx;i++)\n\t\t\tdis[i][idx]=dis[idx][i]=dis[u][i]+(vis[i]?-l:l);\n\t\tmemset(vis+1,0,sizeof(bool)*idx);\n\t\tvector<int>x;\n\t\tfor(auto v2:e[u])\n\t\t\tif(!in(v1,u,v2))e[idx].push_back(v2);\n\t\t\telse x.push_back(v2);\n\t\treturn e[u]=x,e[u].push_back(idx),1;\n\t}\n\treturn 0;\n}\nvoid dfs1(int u){\n\twhile(work(u));\n\tfor(auto v:e[u])\n\t\tdfs1(v),g[v].push_back(u);\n}\nvoid dfs2(int u,int ft){\n\tsiz[u]=u<=m?1:0;\n\tfor(auto v:e[u])\n\t\tif(v!=ft)dfs2(v,u),siz[u]+=siz[v],maxsiz[u]=max(maxsiz[u],siz[v]);\n\tmaxsiz[u]=max(maxsiz[u],m-siz[u]);\n}\nvoid dfs3(int u,int ft){\n\tint sn=0;\n\tfor(auto v:e[u])\n\t\tif(v!=ft&&siz[v]>siz[sn])sn=v;\n\tif(sn)dfs3(sn,u);\n\telse dv=du?p[u]:0,du=du?du:p[u];\n}\nsigned main(){\n\tn=read(),m=min(n,S),idx=m;\n\tfor(int i=1;i<=n;i++)\n\t\tp[i]=i,swap(p[i],p[rad(1,i)]);\n\tfor(int i=1;i<=m;i++)\n\t\tfor(int j=i+1;j<=m;j++)\n\t\t\tprintf(\"? %d %d\\n\",p[i],p[j]);\n\tfflush(stdout);\n\tfor(int i=1;i<=m;i++)\n\t\tfor(int j=i+1;j<=m;j++)\n\t\t\tdis[i][j]=dis[j][i]=read();\n\tfor(int i=2;i<=m;i++){\n\t\tint maxn=0,maxid=1;\n\t\tfor(int j=2;j<=m;j++)\n\t\t\tif(i!=j&&in(1,j,i)&&dis[1][j]>maxn)maxn=dis[1][j],maxid=j;\n\t\te[maxid].push_back(i);\n\t}\n\tdfs1(1);\n\tfor(int i=1;i<=idx;i++)\n\t\tfor(auto j:g[i])\n\t\t\te[i].push_back(j);\n\tdfs2(1,0);\n\tint minn=m+1,minid=0;\n\tfor(int i=1;i<=idx;i++)\n\t\tif(maxsiz[i]<minn)minn=maxsiz[i],minid=i;\n\tdfs2(minid,0);\n\tsort(e[minid].begin(),e[minid].end(),[&](int x,int y){return siz[x]>siz[y];});\n\tdfs3(e[minid][0],minid),dfs3(e[minid][1],minid);\n\tfor(int i=1;i<=n;i++){\n\t\tif(du!=i)printf(\"? %d %d\\n\",du,i);\n\t\tif(dv!=i)printf(\"? %d %d\\n\",dv,i);\n\t}\n\tfflush(stdout);\n\tfor(int i=1;i<=n;i++)\n\t\td1[i]=du==i?0:read(),d2[i]=dv==i?0:read();\n\tint len=d1[dv];\n\tfor(int i=1;i<=n;i++)\n\t\tif(d1[i]+d2[i]==len)r[d1[i]]=i;\n\tfor(int i=1;i<=n;i++)\n\t\tw[(d1[i]-d2[i]+len)>>1]++;\n\tfor(int i=0,now=0;;i++)\n\t\tnow+=w[i],now*2>n?report(r[i]):void();\n\treturn 0;\n}\n```",
        "postTime": 1669817457,
        "uid": 101800,
        "name": "Forever_Pursuit",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1761G \u3010Centroid Guess\u3011"
    },
    {
        "content": "[-->CF\u5b98\u65b9\u9898\u89e3](https://codeforces.com/blog/entry/109256)\n## \u9898\u610f\u7b80\u8ff0\n\u4ea4\u4e92\u9898\u3002\u7ed9\u4e00\u68f5 $n\\ (n\\leq75000)$ \u4e2a\u8282\u70b9\u7684\u6811\uff0c\u6bcf\u6b21\u53ef\u4ee5\u8be2\u95ee\u4e24\u4e2a\u8282\u70b9 $u,v$ \u4e4b\u95f4\u7684\u8ddd\u79bb\uff0c\u8981\u6c42\u5728 $2\\cdot 10^5$ \u6b21\u8be2\u95ee\u5185\u627e\u51fa\u8fd9\u68f5\u6811\u7684\u91cd\u5fc3\u3002[\u201c\u6811\u7684\u91cd\u5fc3\u201d\u7684\u5b9a\u4e49-OI Wiki](https://oi-wiki.org/graph/tree-centroid/)\n\n## \u9898\u76ee\u5206\u6790\n\u6ce8\u610f\u5230\u53ef\u4ee5\u8be2\u95ee\u7684\u6b21\u6570\u5f88\u5c11\uff0c\u800c\u4e14\u9898\u76ee\u7279\u522b\u8bf4\u660e\u4e86\u4ea4\u4e92\u5e93**\u4e0d\u662f**\u81ea\u9002\u5e94\u7684\uff0c\u8fd9\u63d0\u793a\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e0d\u4fdd\u8bc1\u5b8c\u5168\u6b63\u786e\u7684\u968f\u673a\u5316\u505a\u6cd5\u3002  \n\n\u6211\u4eec\u8003\u8651\u5148\u627e\u51fa\u91cd\u5fc3\u6240\u5728\u7684\u4e00\u4e2a\u8303\u56f4\uff0c\u6bd4\u5982\u67d0\u4e2a\u5b50\u6811\u91cc\u6216\u8005\u67d0\u6761\u8def\u5f84\u91cc\u3002\u53ef\u4ee5\u53d1\u73b0\u540e\u8005\u662f\u6bd4\u8f83\u65b9\u4fbf\u786e\u5b9a\u91cd\u5fc3\u5177\u4f53\u4f4d\u7f6e\u7684\u3002\u56e0\u4e3a\u5982\u679c\u786e\u5b9a\u4e86\u91cd\u5fc3\u5728 $x$ \u5230 $y$ \u7684\u8def\u5f84\u91cc\uff0c\u90a3\u53ea\u9700\u8981\u627e\u51fa\u8def\u5f84\u4e0a\u6bcf\u4e2a\u8282\u70b9\u8fde\u63a5\u4e86\u54ea\u4e9b\u70b9\u5c31\u597d\u4e86\u3002  \n\n![](https://cdn.luogu.com.cn/upload/image_hosting/nt32f6zd.png)  \n\n\u6bd4\u5982\u8fd9\u6837\uff0c\u6211\u4eec\u628a\u6240\u6709\u8282\u70b9\u5206\u7c7b\uff0c\u8bb0\u5f55\u6bcf\u4e00\u7c7b\u8282\u70b9\u7684\u4e2a\u6570\uff0c\u7136\u540e\u4ece $x$ \u626b\u5230 $y$, \u770b\u5230\u54ea\u91cc\u65f6\u8282\u70b9\u4e2a\u6570\u8d85\u8fc7\u4e86 $n\\over2$ \u5c31\u80fd\u627e\u5230\u91cd\u5fc3\u3002  \n\n\u800c\u8fd9\u9700\u8981\u6211\u4eec\u5bf9\u6bcf\u4e2a\u8282\u70b9\u8be2\u95ee $dis(x,i)$ \u548c $dis(y,i)$, \u5982\u679c $dis(x,i)+dis(y,i)=dis(x,y)$ \u5219\u8bf4\u660e\u8fd9\u4e2a\u70b9\u5728\u8def\u5f84\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5b83\u7f16\u53f7\u4e3a\u8def\u5f84\u4e0a\u7684 $dis(x,i)$ \u53f7\u8282\u70b9\u3002\u5bf9\u4e8e\u5176\u5b83\u8282\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5b83\u63a5\u5728\u4e86\u8def\u5f84\u7684 ${dis(x,i)-dis(y,i)+dis(x,y)}\\over2$ \u53f7\u8282\u70b9\u4e0a\uff0c\u8bb0\u5f55\u6bcf\u4e00\u7c7b\u8282\u70b9\u7684\u4e2a\u6570\u5c31\u53ef\u4ee5\u627e\u5230\u7b54\u6848\u3002  \n\n\u4e0a\u9762\u7684\u64cd\u4f5c\u5df2\u7ecf\u8017\u8d39\u4e86\u6700\u591a $74999\\times2=149998$ \u6b21\u64cd\u4f5c\uff0c\u4e8e\u662f\u5269\u4e0b\u7684\u64cd\u4f5c\u6570\u91cf\u6700\u591a\u53ea\u80fd\u591f\u518d\u95ee $316$ \u4e2a\u8282\u70b9\u4e24\u4e24\u4e4b\u95f4\u7684\u8ddd\u79bb\u3002\u5728\u968f\u673a\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u60f3\u60f3\u5982\u679c\u77e5\u9053\u4e86\u5b8c\u6574\u7684\u6811\uff0c\u8be5\u5982\u4f55\u627e\u91cd\u5fc3\u6240\u5728\u7684\u8def\u5f84\u3002\u663e\u7136\uff0c\u6839\u636e\u6811\u7684\u91cd\u5fc3\u7684\u5b9a\u4e49\uff0c\u6211\u4eec\u4ece\u4efb\u610f\u4e00\u4e2a\u70b9 $p$ \u51fa\u53d1\uff0c\u9012\u5f52\u5730\u627e\u5b83\u6700\u5927\u7684\u5b50\u6811\u76f4\u5230\u627e\u5230\u53f6\u8282\u70b9 $q$, \u91cd\u5fc3\u5c31\u4e00\u5b9a\u5728 $p$ \u5230 $q$ \u7684\u8def\u5f84\u4e0a\u3002  \n\n\u90a3\u4e48\u6211\u4eec\u968f\u673a\u51fa $316$ \u4e2a\u70b9\u6784\u6210\u4e00\u9897\u65b0\u6811\uff0c\u6839\u636e\u8fd9\u68f5\u6811\u4e0a\u70b9\u7684\u5206\u5e03\u627e\u51fa\u6700\u53ef\u80fd\u7684\u91cd\u5fc3\u3002\u4e3a\u4e86\u4f7f\u51c6\u786e\u7387\u63d0\u9ad8\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u7684\u65b9\u6cd5\u3002  \n\n1. \u4ece\u65b0\u6811\u4e0a\u7684\u70b9 $p$ \u51fa\u53d1\u540e\uff0c\u4e0d\u6b62\u8981\u627e\u5b83\u6700\u5927\u7684\u5b50\u6811\uff0c\u8fd8\u8981\u4ece\u5b83\u7b2c\u4e8c\u5927\u7684\u5b50\u6811\u5f00\u59cb\u4e0d\u65ad\u627e\u6700\u5927\u7684\u5b50\u6811\uff0c\u4ece\u800c\u627e\u5230\u4e24\u4e2a\u53f6\u8282\u70b9 $q_1,q_2$\u3002\u5bb9\u6613\u53d1\u73b0\u53ea\u8981\u5728\u771f\u5b9e\u7684\u6811\u4e2d\uff0c\u91cd\u5fc3\u6240\u5728\u7684\u5b50\u6811\uff08\u5b83\u5305\u542b\u4e86\u591a\u4e8e $1\\over2$ \u7684\u8282\u70b9\uff09\u91cc\u5305\u542b\u4e86\u81f3\u5c11 ${1\\over3}$ \u7684\u968f\u673a\u70b9\uff0c\u7b2c\u4e00\u6b65\u5c31\u4e0d\u53ef\u80fd\u8fdb\u9519\u5b50\u6811\u3002\n\n2. \u4e0d\u4efb\u610f\u9009\u70b9\uff0c\u800c\u662f\u4ece\u65b0\u6811\u7684\u91cd\u5fc3\u51fa\u53d1\u9012\u5f52\uff0c\u8fd9\u6837\u80fd\u8ba9\u6bcf\u4e2a\u5b50\u6811\u5185\u5305\u542b\u7684\u968f\u673a\u70b9\u5c3d\u53ef\u80fd\u5747\u8861\u3002  \n\n\u6ce8\u610f\uff0c\u6211\u4eec\u5728\u5c06\u968f\u673a\u70b9\u8fde\u6210\u65b0\u6811\u7684\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u4f1a\u6539\u53d8\u6811\u7684\u7ed3\u6784\uff08\u53ef\u80fd\u5c06\u7236\u8282\u70b9\u4e00\u68f5\u5b50\u6811\u4e2d\u7684\u4e24\u4e2a\u70b9\uff0c\u8bef\u8ba4\u4e3a\u6210\u4e86\u7236\u8282\u70b9\u4e24\u68f5\u5b50\u6811\u4e2d\u7684\u70b9\uff09\uff0c\u6240\u4ee5\u8003\u8651\u52a0\u5165\u865a\u62df $lca$ \u8282\u70b9\u6765\u8c03\u6574\u7ed3\u6784\uff0c\u5728\u627e\u65b0\u6811\u91cd\u5fc3\u7684\u65f6\u5019\u5219\u8981\u8ba4\u4e3a\u8fd9\u4e9b\u865a\u62df\u8282\u70b9\u6ca1\u6709\u91cd\u91cf\u3002\u5177\u4f53\u64cd\u4f5c\u89c1\u4ee3\u7801\u3002  \n\n## \u4ee3\u7801\n```cpp\n#include <iostream>\n#include <cstring>\n#include <algorithm>\n#include <ctime>\n#include <stdlib.h>\n#include <vector>\nusing namespace std;\nint n,m,cntd,bh[75005],dis[705][705],u,v,siz[705],anssz[705],disu[75005],disv[75005],dpath[75005],szpath[75005],minsiz,mindn,ans;\nbool vis[705];\nvector <int> edge[705];\nvector <int> fa[705];//\u8ba9\u6dfb\u52a0lca\u8282\u70b9\u7684\u64cd\u4f5c\u66f4\u65b9\u4fbf \ninline int read()\n{\n\tint now=0,nev=1; char c=getchar();\n\twhile(c<'0' || c>'9') { if(c=='-') nev=-1; c=getchar();}\n\twhile(c>='0' && c<='9') { now=(now<<1)+(now<<3)+(c&15); c=getchar(); }\n\treturn now*nev;\n}\nbool check(int l,int mid,int r)//\u5224\u65ad\u65b0\u6811\u4e2d\u7684\u7236\u5b50\u5173\u7cfb \n{\n\tif(dis[l][mid]+dis[mid][r]==dis[l][r])\n\t{\n\t\treturn 1;\n\t}\n\treturn 0;\n}\nint getrd(int l,int r)\n{\n\treturn l+rand()%(r-l+1);\n}\nint getans(int x,int y)//\u8be2\u95ee \n{\n\tprintf(\"? %d %d\\n\",x,y);\n\tfflush(stdout);\n\tans=read();\n\treturn ans;\n}\nvoid putans(int x)\n{\n\tprintf(\"! %d\\n\",x);\n\tfflush(stdout);\n\treturn;\n}\nvoid dfsvis(int now)//\u5224\u65ad\u65b0\u6811\u4e2d\u865a\u62dflca\u8282\u70b9\u4e0e\u5176\u5b83\u8282\u70b9\u7684\u4f4d\u7f6e\u5173\u7cfb \n{\n\tvis[now]=1;\n\tfor(int i=0;i<edge[now].size();i++)\n\t{\n\t\tdfsvis(edge[now][i]);\n\t}\n}\nbool ycl(int now)//\u6dfb\u52a0lca\u8282\u70b9 \n{\n\tfor(int i=0;i<edge[now].size();i++)\n\t{\n\t\tint da=edge[now][i];\n\t\tint deplca=1000000000;\n\t\tfor(int j=0;j<edge[now].size();j++)\n\t\t{\n\t\t\tint db=edge[now][j];\n\t\t\tif(da==db||check(da,now,db))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tdeplca=min(deplca,(dis[da][now]+dis[db][now]-dis[da][db])/2);\n\t\t}\n\t\tif(deplca==1000000000)\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\t\tmemset(vis,0,sizeof(vis));\n\t\tfor(int j=0;j<edge[now].size();j++)\n\t\t{\n\t\t\tint db=edge[now][j];\n\t\t\tif(!check(da,now,db))\n\t\t\t{\n\t\t\t\tdfsvis(db);\n\t\t\t}\n\t\t}\n\t\tcntd++;\n\t\tfor(int j=1;j<=cntd-1;j++)\n\t\t{\n\t\t\tif(vis[j])\n\t\t\t{\n\t\t\t\tdis[j][cntd]=dis[j][now]-deplca;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdis[j][cntd]=dis[j][now]+deplca;\n\t\t\t}\n\t\t\tdis[cntd][j]=dis[j][cntd];\n\t\t}\n\t\tint lastd[705],cntlst=edge[now].size();\n\t\tfor(int j=1;j<=cntlst;j++)\n\t\t{\n\t\t\tlastd[j]=edge[now][j-1];\n\t\t}\n\t\tedge[now].clear();\n\t\tedge[now].push_back(cntd);\n\t\tfor(int j=1;j<=cntlst;j++)\n\t\t{\n\t\t\tif(check(da,now,lastd[j]))\n\t\t\t{\n\t\t\t\tedge[now].push_back(lastd[j]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tedge[cntd].push_back(lastd[j]);\n\t\t\t}\n\t\t}\n\t\treturn 1;\n\t}\n\treturn 0;\n}\nvoid dfslca(int now)//\u5efa\u65b0\u6811 \n{\n\twhile(1)\n\t{\n\t\tif(!ycl(now))\n\t\t{\n\t\t\tbreak;\n\t\t}\n\t}\n\tfor(int i=0;i<edge[now].size();i++)\n\t{\n\t\tdfslca(edge[now][i]);\n\t\tfa[edge[now][i]].push_back(now);\n\t}\n}\nvoid dfssiz(int now,int fat)//\u627e\u65b0\u6811\u91cd\u5fc3 \n{\n\tif(now<=m)\n\t{\n\t\tsiz[now]=1;\n\t}\n\tfor(int i=0;i<edge[now].size();i++)\n\t{\n\t\tif(edge[now][i]==fat)\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\t\tdfssiz(edge[now][i],now);\n\t\tanssz[now]=max(anssz[now],siz[edge[now][i]]);\n\t\tsiz[now]+=siz[edge[now][i]];\n\t}\n\tanssz[now]=max(anssz[now],cntd-siz[now]);\n}\nvoid dfspath(int now,int fat)//\u9012\u5f52\u5730\u627e\u91cd\u5fc3\u6240\u5728\u8def\u5f84 \n{\n\tint dn=0,mxsiz=0;\n\tbool flag=0;\n\tfor(int i=0;i<edge[now].size();i++)\n\t{\n\t\tif(edge[now][i]==fat)\n\t\t{\n\t\t\tcontinue;\n\t\t}\n\t\tif(siz[edge[now][i]]>mxsiz)\n\t\t{\n\t\t\tmxsiz=siz[edge[now][i]];\n\t\t\tdn=edge[now][i];\n\t\t\tflag=1;\n\t\t}\n\t}\n\tif(flag)\n\t{\n\t\tdfspath(dn,now);\n\t}\n\telse\n\t{\n\t\tu=bh[now];\n\t\treturn;\n\t}\n}\nint main()\n{\n\tsrand(time(0));\n\tn=read();\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tbh[i]=i;\n\t}\n\trandom_shuffle(bh+1,bh+n+1);\n\tm=min(n,316);\n\tcntd=m;\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tfor(int j=i+1;j<=m;j++)\n\t\t{\n\t\t\tdis[i][j]=getans(bh[i],bh[j]);\n\t\t\tdis[j][i]=dis[i][j];\n\t\t}\n\t}\n\tfor(int i=2;i<=m;i++)\n\t{\n\t\tint fat=1,disfa=100000000;\n\t\tfor(int j=2;j<=m;j++)\n\t\t{\n\t\t\tif(i==j)\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(check(1,j,i))\n\t\t\t{\n\t\t\t\tif(dis[i][j]<disfa)\n\t\t\t\t{\n\t\t\t\t\tdisfa=dis[i][j];\n\t\t\t\t\tfat=j;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tedge[fat].push_back(i);\n\t}\n\tdfslca(1);\n\tfor(int i=1;i<=cntd;i++)\n\t{\n\t\tfor(int j=0;j<fa[i].size();j++)\n\t\t{\n\t\t\tedge[i].push_back(fa[i][j]);//\u4e0b\u9762\u7684\u64cd\u4f5c\u6839\u8282\u70b9\u4e0d\u56fa\u5b9a\uff0c\u628a\u8fde\u5411\u7236\u8282\u70b9\u7684\u8fb9\u52a0\u8fdb\u6765 \n\t\t}\n\t}\n\tdfssiz(1,1);\n\tminsiz=1000000000;\n\tfor(int i=1;i<=cntd;i++)\n\t{\n\t\t//cout<<i<<\" \"<<anssz[i]<<endl;\n\t\tif(anssz[i]<minsiz)\n\t\t{\n\t\t\tminsiz=anssz[i];\n\t\t\tmindn=i;\n\t\t}\n\t}\n\tdfssiz(mindn,mindn);\n\tint maxa=0,maxb=0,dna=0,dnb=0;\n\tfor(int i=0;i<edge[mindn].size();i++)//\u4ece\u65b0\u6811\u91cd\u5fc3\u5f00\u59cbdfs \n\t{\n\t\tif(siz[edge[mindn][i]]>maxa)\n\t\t{\n\t\t\tmaxb=maxa;\n\t\t\tdnb=dna;\n\t\t\tmaxa=siz[edge[mindn][i]];\n\t\t\tdna=edge[mindn][i];\n\t\t}\n\t\telse if(siz[edge[mindn][i]]>maxb)\n\t\t{\n\t\t\tmaxb=siz[edge[mindn][i]];\n\t\t\tdnb=edge[mindn][i];\n\t\t}\n\t}\n\tdfspath(dna,mindn);\n\tv=u; \n\tdfspath(dnb,mindn);\n\t//cout<<u<<\" \"<<v<<endl;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(i!=u)\n\t\t{\n\t\t\tdisu[i]=getans(u,i);\n\t\t}\n\t\tif(i!=v)\n\t\t{\n\t\t\tdisv[i]=getans(v,i);\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(disu[i]+disv[i]==disu[v])\n\t\t{\n\t\t\tdpath[disu[i]]=i;\n\t\t}\n\t\tszpath[(disu[i]-disv[i]+disu[v])/2]++;//\u6807\u8bb0\u8282\u70b9\u6240\u5c5e\u7c7b\u522b \n\t}\n\tint nowsiz=0;\n\tfor(int i=0;i<=disu[v];i++)\n\t{\n\t\tnowsiz+=szpath[i];\n\t\tif(nowsiz>n/2)\n\t\t{\n\t\t\tputans(dpath[i]);\n\t\t\treturn 0;\n\t\t}\n\t}\n}\n```\n\u4e0a\u9762\u7684\u4ee3\u7801\u6709\u4e2a\u63d0\u901f\u7684\u4f18\u5316\u5fd8\u5199\u4e86\uff0c\u5f53\u6211\u4eec\u7684\u8be2\u95ee\u4e0d\u4f9d\u8d56\u4e8e\u4e0a\u4e00\u6b21\u7684\u56de\u7b54\u65f6\uff0c\u53ef\u4ee5\u4e00\u6b21\u95ee\u5f88\u591a\u95ee\u9898\u518d\u5237\u65b0\u3002",
        "postTime": 1669441824,
        "uid": 529697,
        "name": "PEKKA_l",
        "ccfLevel": 6,
        "title": "CF1761G\u9898\u89e3"
    },
    {
        "content": "\u6ce8\uff1a\u8be5\u9898\u89e3\u6e90\u81ea https://codeforces.com/blog/entry/109256?#comment-974593\u3002\n\n\u5229\u7528\u8be2\u95ee\uff0c\u6211\u4eec\u5e0c\u671b\u8fd8\u539f\u51fa\u7ed3\u70b9\u95f4\u7684\u4e00\u90e8\u5206\u4f4d\u7f6e\u5173\u7cfb\uff0c\u7ee7\u800c\u6c42\u51fa\u91cd\u5fc3\u7684\u6807\u53f7\u3002\n\n\u8003\u8651\u67d0\u4e00\u6761\u94fe $S\\sim T$ \u548c\u4e00\u4e2a\u7ed3\u70b9 $u$\u3002\u901a\u8fc7\u8be2\u95ee $\\text{dis}(S,T),\\text{dis}(S,u)$ \u4ee5\u53ca $\\text{dis}(u,T)$\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u77e5 $u$ \u76f8\u5bf9\u4e8e $S\\sim T$ \u7684\u4f4d\u7f6e\u5173\u7cfb\u3002\u5177\u4f53\u5730\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053 $u$ \u5728 $S\\sim T$ \u94fe\u4e0a\u7684\u6295\u5f71\u3002\u6211\u4eec\u5c06 $S\\sim T$ \u94fe\u4e0a\u7684\u7ed3\u70b9\u4f9d\u6b21\u7528 $0,1,\\cdots,\\text{dis}(S,T)$ \u7f16\u53f7\uff0c\u90a3\u4e48 $u$ \u5728 $S\\sim T$ \u4e0a\u7684\u6295\u5f71\u7f16\u53f7\u5c31\u662f $\\dfrac{\\text{dis}(S,T)+\\text{dis}(S,u)-\\text{dis}(u,T)}2$\u3002\u6839\u636e\u6295\u5f71\u7684\u7f16\u53f7\uff0c\u53ef\u4ee5\u5c06 $u$ \u5212\u5206\u4e3a $\\text{dis}(S,T)+1$ \u7c7b\u3002\n\n\u6ce8\u610f\u5230\u5982\u679c\u6211\u4eec\u638c\u63e1\u4e86\u4efb\u610f\u4e00\u6761\u91cd\u5fc3\u6240\u5728\u7684\u94fe $S\\sim T$\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5728 $2n$ \u6b21\u8be2\u95ee\u5185\u786e\u5207\u5730\u6c42\u51fa\u91cd\u5fc3\uff1a\u5229\u7528\u521a\u624d\u7684\u65b9\u6cd5\uff0c\u5c06\u6240\u6709\u7ed3\u70b9\u5212\u5206\u4e3a $\\text{dis}(S,T)+1$ \u7c7b\u3002\u4ee5\u7c7b\u522b\u7684\u5927\u5c0f\u4e3a\u6743\u503c\uff0c\u91cd\u5fc3\u5c31\u662f\u8fd9\u6761\u94fe\u7684\u5e26\u6743\u4e2d\u4f4d\u6570\u3002\u5bf9\u4e8e\u4e00\u4e2a $u$ \u6765\u8bf4\uff0c\u82e5 $\\text{dis}(S,u)+\\text{dis}(u,T)=\\text{dis}(S,T)$ \u5219\u8bf4\u660e $u$ \u5c31\u5728 $S\\sim T$ \u4e0a\u3002\u8fd4\u56de\u5e26\u6743\u4e2d\u4f4d\u6570\u90a3\u4e2a\u94fe\u4e0a\u7ed3\u70b9\u5373\u53ef\u3002\n\n\u56e0\u6b64\u6211\u4eec\u9700\u8981\u7528 $\\leq5\\times10^4$ \u6b21\u8be2\u95ee\u786e\u5b9a\u4e00\u6761\u91cd\u5fc3\u6240\u5728\u7684\u94fe $S\\sim T$\u3002\u82e5\u91cd\u5fc3\u4e0d\u5728 $S\\sim T$ \u4e0a\uff0c\u6211\u4eec\u786c\u8981\u5bf9 $S\\sim T$ \u8dd1\u521a\u624d\u7684\u7b97\u6cd5\uff0c\u4f1a\u53d1\u73b0\u6709\u4e00\u4e2a\u7c7b\u7279\u522b\u5730\u5927\u3002\u5177\u4f53\u5730\uff0c\u7531\u4e8e\u91cd\u5fc3\u6240\u5728\u7684\u5b50\u6811\u81f3\u5c11\u6709 $\\dfrac n2$ \u4e2a\u7ed3\u70b9\uff0c\u56e0\u6b64\u91cd\u5fc3\u6240\u5728\u7684\u7c7b\u5c06\u81f3\u5c11\u5305\u542b $\\dfrac n2+1$ \u4e2a\u7ed3\u70b9\u3002\u4ece\u8be5\u7c7b\u4e2d\u968f\u673a\u6311\u51fa\u4e00\u4e2a\u7ed3\u70b9 $u$\uff0c\u5219 $u$ \u6709 $\\geq\\dfrac12$ \u6982\u7387\u5904\u5728\u91cd\u5fc3\u7684\u5b50\u6811\u91cc\u3002\u8fd9\u8bf4\u660e $S\\sim u$ \u5305\u542b\u91cd\u5fc3\u7684\u6982\u7387 $\\geq\\dfrac12$\u3002\u56e0\u6b64\uff0c\u5c06 $S\\sim T$ \u8c03\u6574\u6210 $S\\sim u$\uff0c\u6709 $\\geq\\dfrac12$ \u6982\u7387\u5f97\u5230\u4e00\u6761\u91cd\u5fc3\u6240\u5728\u7684\u94fe\u3002\n\n\u6211\u4eec\u5e0c\u671b\u91cd\u590d\u4ee5\u4e0a\u6d41\u7a0b\uff0c\u76f4\u5230\u627e\u5230\u4e00\u6761\u7b26\u5408\u8981\u6c42\u7684\u94fe\u4e3a\u6b62\u3002\u7136\u800c\u4e0a\u8ff0\u8fc7\u7a0b\u592a\u8fc7\u6602\u8d35\u4e86\uff01\u5229\u7528\u968f\u673a\u5316\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u4e0a\u8ff0\u8fc7\u7a0b\u53d8\u5f97\u66f4\u4fbf\u5b9c\u3002\u5177\u4f53\u5730\uff0c\u6211\u4eec\u53ef\u4ee5\u968f\u673a\u91c7\u6837 $157$ \u4e2a\u70b9\u5e76\u786e\u5b9a\u5176\u5206\u7c7b\uff0c\u7559\u610f\u5305\u542b $\\geq79$\uff08\u800c\u4e0d\u662f\u539f\u5148\u7684 $\\dfrac n2+1$\uff09\u4e2a\u91c7\u6837\u70b9\u7684\u7c7b\u3002\u82e5\u91cd\u5fc3\u4e0d\u5728 $S\\sim T$ \u4e0a\uff0c\u8fd9\u6837\u7684\u7c7b\u6709 $\\geq\\dfrac12$ \u6982\u7387\u4f1a\u51fa\u73b0\u3002\u53ea\u8981\u51fa\u73b0\uff0c\u5c31\u4ece\u8be5\u7c7b\u4e2d\u968f\u673a\u6311\u51fa\u4e00\u4e2a\u91c7\u6837\u70b9 $u$\uff0c\u5219 $u$ \u6709 $\\geq\\dfrac12$ \u6982\u7387\u5904\u5728\u91cd\u5fc3\u7684\u5b50\u6811\u91cc\u3002\u90a3\u4e48\uff0c\u5c06 $S\\sim T$ \u8c03\u6574\u6210 $S\\sim u$\uff0c\u6709 $\\geq\\dfrac14$ \u6982\u7387\u5f97\u5230\u4e00\u6761\u91cd\u5fc3\u6240\u5728\u7684\u94fe\u3002\u591a\u6b21\u91cd\u590d\u4ee5\u4e0a\u6d41\u7a0b\uff0c\u51e0\u4e4e\u4e00\u5b9a\u80fd\u591f\u5f97\u5230\u4e00\u6761\u91cd\u5fc3\u6240\u5728\u7684\u94fe\u3002\n\n\u7136\u800c\u8be5\u6d41\u7a0b\u7684\u524d\u63d0\u662f\u91cd\u5fc3\u4e0d\u5728 $S\\sim T$ \u4e0a\u3002\u82e5\u91cd\u5fc3\u672c\u5c31\u5728 $S\\sim T$ \u4e0a\uff0c\u4e0a\u8ff0\u6d41\u7a0b\u53ef\u80fd\u4f1a\u5c06\u597d\u7aef\u7aef\u7684 $S\\sim T$ \u7ed9\u4e22\u6389\uff01\u6240\u5e78\u8fd9\u4e2a\u95ee\u9898\u6709\u529e\u6cd5\u89e3\u51b3\u3002\u89e3\u51b3\u65b9\u6848\u662f\u5229\u7528\u5c06 $S\\sim T$ \u66ff\u6362\u4e3a $S\\sim u$ \u8fd8\u662f $u\\sim T$ \u7684\u81ea\u7531\u5ea6\u3002\u4e3a\u4e86\u5c3d\u53ef\u80fd\u5730\u7559\u4f4f\u91cd\u5fc3\uff0c\u6211\u4eec\u8003\u5bdf $u$ \u7684\u6295\u5f71\u5de6\u4fa7\u548c\u53f3\u4fa7\u7684\u91c7\u6837\u70b9\u54ea\u4e2a\u66f4\u591a\u3002\u82e5\u5de6\u4fa7\u66f4\u591a\u5c31\u5c06 $S\\sim T$ \u66ff\u6362\u4e3a $S\\sim u$\uff0c\u53f3\u4fa7\u5219\u662f $u\\sim T$\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u53ea\u8981\u91cd\u5fc3\u6240\u5728\u7684\u5b50\u6811\u91cc\u6709 $\\geq40$ \u4e2a\u91c7\u6837\u70b9\u5c31\u4e00\u5b9a\u80fd\u88ab\u7559\u4f4f\uff08\u8fd9\u5927\u7ea6\u6709 $1-\\dfrac1{5\\times10^9}$ \u7684\u6982\u7387\uff09\u3002\n\n\u7efc\u4e0a\u6240\u8ff0\uff0c\u4ee5\u4efb\u610f $S\\sim T$ \u4e3a\u521d\u503c\u91cd\u590d\u4ee5\u4e0a\u6d41\u7a0b $157$ \u6b21\uff0c\u7ecf\u8fc7\u8fed\u4ee3\u4e4b\u540e\u51e0\u4e4e\u4e00\u5b9a\u80fd\u591f\u5f97\u5230\u4e00\u6761\u91cd\u5fc3\u6240\u5728\u7684\u94fe\u3002\n\n\u8bbe\u5141\u8bb8\u7684\u9519\u8bef\u7387\u4e3a $\\varepsilon$\uff0c\u5219\u8be5\u7b97\u6cd5\u6240\u9700\u8981\u7684\u8be2\u95ee\u6b21\u6570\u662f $2n+\\mathcal{O}(\\log^2\\dfrac1\\varepsilon)$\u3002\n\n\u9644\u4ee3\u7801\uff1ahttps://www.luogu.com.cn/paste/5sg8vyoi\u3002",
        "postTime": 1669901983,
        "uid": 130897,
        "name": "\u7480\u74a8\u661f\u7a7a1",
        "ccfLevel": 9,
        "title": "CF1761G \u9898\u89e3"
    }
]
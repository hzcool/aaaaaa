[
    {
        "content": "### \u524d\u8a00\n\n\u964d\u667a\u6784\u9020\u9898\u3002\n\n![\u8dcb\u5c71\u6d89\u6c34AC\u8def.jpg](https://cdn.luogu.com.cn/upload/image_hosting/6ocanxpm.png)\n\n### \u6b63\u6587\n\n\u8bb0\u539f\u6765\u7684\u6c34\u69fd\u96c6\u5408\u4e3a $S_0$ \u3002\n\n\u8003\u8651\u627e\u5230\u4e00\u4e2a\u6c34\u69fd\u96c6\u5408 $S'$ ,\u4f7f\u5f97 $\\sum S'_i \\equiv V(\\mod k)$ \u3002\n\n\u6211\u4eec\u5c06\u8fd9\u4e9b\u6c34\u69fd\u7684\u6c34\u5012\u5165\u8fd9\u4e2a\u96c6\u5408\u7684\u7b2c\u4e00\u4e2a\u6c34\u69fd\u4e2d\uff0c\u8bb0\u8fd9\u4e2a\u6c34\u69fd\u4e3a $S'_1$\u3002\u663e\u7136 $S'_1\\equiv V(\\mod k)$\n\n\u6211\u4eec\u5c06 $S_0 \\setminus S$ \u4e2d\u6240\u6709\u6c34\u69fd\u4e2d\u7684\u6c34\u5012\u5165\u8fd9\u4e2a\u96c6\u5408\u7684\u7b2c\u4e00\u4e2a\u6c34\u69fd\u4e2d,\u8bb0\u8fd9\u4e2a\u6c34\u69fd\u4e3a $S''_1$\u3002\n\n- \u5982\u679c $S'_1\\ge V$ :\u53ef\u4ee5\u4ece\u8fd9\u4e2a\u6c34\u69fd\u4e2d\u5411\u5916\u5012\u6c34 $\\dfrac{S'_1-V}{k}$ \u6b21\u3002\n\n- \u5982\u679c $S'_1<V$:\u53ef\u4ee5\u4ece $S''_1$ \u4e2d\u5411\u8fd9\u4e2a\u6c34\u69fd\u5012\u6c34 $\\dfrac{V-S'_1}{k}$ \u6b21\u3002\n\n\u4f46\u662f\u5982\u679c $S'_1+S''_1<V$\uff0c(\u6362\u8a00\u4e4b\uff0c\u5bf9\u4e8e\u6700\u521d\u72b6\u6001\u7684 $S_0$, $\\sum S_{0_i}<V$) \u663e\u7136\u4e0d\u5b58\u5728\u89e3\u3002\n\n\u90a3\u4e48\uff0c\u627e\u4e0d\u5230\u5408\u6cd5\u7684 $S'$ \u600e\u4e48\u529e\uff1f\n\n\u8fd9\u79cd\u60c5\u51b5\u53ef\u4ee5\u8bc1\u660e\u4e3a\u65e0\u89e3\u3002\u56e0\u4e3a\u65e2\u7136\u4e0d\u5b58\u5728\u8fd9\u6837\u4e00\u4e2a $S'$ \uff0c\u663e\u7136\u4e5f\u4e0d\u5b58\u5728\u5176\u4ed6\u7684\u96c6\u5408\uff0c\u4f7f\u5f97\u5176\u603b\u6c34\u91cf $sum$ \u6ee1\u8db3 $sum\\equiv V(\\mod k)$ \uff0c\u90a3\u4e48\u663e\u7136\u4e0d\u5b58\u5728\u7b54\u6848\u4e86\u3002\n\n\u6b64\u65f6\u53ef\u4ee5\u7528\u80cc\u5305\u95ee\u9898\u7684\u89e3\u6cd5\u627e\u5230\u5408\u6cd5\u7684 $S'$\u3002\uff08\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651\u603b\u4ef7\u503c\u5bf9\u4e8e $k$ \u53d6\u6a21\u7684\u7ed3\u679c\u3002\u56e0\u4e3a $k$ \u6bd4\u8f83\u5c0f\uff0c\u6240\u4ee5\u6570\u7ec4\u53ef\u4ee5\u5f00\u7684\u4e0b\u3002\uff09\n\n### Code\n\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<stdio.h>\nusing namespace std;\n#define il inline \n#define rei register int\nil void readln(int &I){\n    I=0;char C=getchar();\n    while(!isdigit(C))C=getchar();\n    while( isdigit(C))I=I*10+C-'0',C=getchar();\n}\nconst int size=5005;\nint n,k,v,a[size],u[size],su,f1,f2;\nbool f[size]={1,0},g[size],all0=1;\nint l[size][size];\n#define mer(x,y) ((a[x])?(printf(\"%d %d %d\\n\",a[x]/k+bool(a[x]%k),x,y),a[y]+=a[x],a[x]=0):0)\nint main(){\n\treadln(n),readln(k),readln(v);\n\tfor(rei i=1;i<=n;i++)readln(a[i]),u[i]=a[i]%k,a[0]+=a[i];\n\tif(a[0]<v)return puts(\"NO\"),0;\n\tfor(rei i=1;i<=n;i++){\n\t\tfor(rei j=0;j<=k;j++)\n\t\t\tif(f[j])g[j]=g[(j+u[i])%k]=1,l[i][j]=l[i][(j+u[i])%k]=j;\n\t\tfor(rei j=0;j<=k;j++)f[j]=g[j];\n\t}\n\tif(v%k==0){\n\t\tputs(\"YES\");\n\t\tfor(rei i=2;i<=n;i++)mer(i,1);if(v/k)printf(\"%d 1 2\",v/k);\n\t}\n\telse if(f[su=v%k]){\n\t\tputs(\"YES\");\n\t\tfor(rei i=n;i>0;i--)u[i]=(su!=l[i][su]),su=l[i][su];\n\t\tfor(rei i=1;i<=n;i++)if(a[i])u[i]?(f1?mer(i,f1):(f1=i)):(f2?mer(i,f2):(f2=i));\n\t\tif(f1==0)return 0;\n\t\tif(a[f1]>v)printf(\"%d %d %d\",(a[f1]-v)/k,f1,f1%n+1);\n\t\telse if(a[f1]<v)printf(\"%d %d %d\",(v-a[f1])/k,f2,f1);\n\t}\n\telse return puts(\"NO\"),0;\n}\n```\n",
        "postTime": 1619235889,
        "uid": 217300,
        "name": "Error_Eric",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF920D \u3010Tanks\u3011"
    },
    {
        "content": "\u6069\n\n\u8fd9\u9898\u6709\u6bd2\n\n$CF$\u6bd4\u8d5b\u7684\u65f6\u5019\u53ea\u6709$30$\u591a\u4e2a\u4eba\u5207\n\n\u8003\u5b8c\u6211\u81ea\u5df1\u6539\u5df2\u7ecf\u5199\u6b7b\u4e86\u6211\u81ea\u5df1\u3002\u3002\u3002\u7ec6\u8282\u5f88\u591a\n\n\u5927\u81f4\u601d\u8def\u4e0d\u662f\u5f88\u96be\u55f7\u3002\u3002\n\n\u9996\u5148\u8003\u8651\u6240\u6709\u7684\u548c\u662f\u5426\u80fd\u591f\u6ee1\u8db3\u6761\u4ef6\n\n\u5982\u679c\u6240\u6709\u7684\u548c\u90fd\u5c0f\u4e8e\u8981\u6c42\uff0c\u4e00\u5b9a\u4e0d\u53ef\u884c\n\n\u63a5\u4e0b\u6765\u8003\u8651\u5173\u4e8e$K$\u7684\u4f59\u6570\n\n\u505a\u4e00\u4e2a\u80cc\u5305\n\n\u7b97\u51fa\u54ea\u4e9b\u5173\u4e8e$K$\u7684\u4f59\u6570\u7684\u4f53\u79ef\u662f\u80fd\u591f\u5f97\u5230\u7684\n\n\u5982\u679c$V\\%K$\u53ef\u884c\uff0c\u5728\u4e0a\u9762\u7684\u7684\u57fa\u7840\u4e0a\u4e00\u5b9a\u80fd\u591f\u6784\u5efa\u51fa\u89e3\n\n\u6240\u4ee5\uff0c\u5148\u8ba1\u7b97\u51fa\u9009\u54ea\u4e9b\u6c34\u69fd\u6784\u5efa\u51fa$V\\%K$\n\n\u7136\u540e\u628a\u8fd9\u4e9b\u6c34\u69fd\u7684\u6c34\u5168\u90e8\u5012\u5728\u4e00\u8d77\n\n\u628a\u5269\u4e0b\u7684\u6c34\u69fd\u7684\u6c34\u5168\u90e8\u5012\u5728\u4e00\u8d77\n\n\u73b0\u5728\u5269\u4e0b\u7684\u5c31\u662f$K$\u7684\u82e5\u5e72\u500d\u4e86\n\n\u679a\u4e3e\u4e4b\u540e\u770b\u662f\u5012\u8fdb\u6765\u8fd8\u662f\u5012\u51fa\u53bb\u5c31\u597d\u4e86\n\n\u8bb0\u4f4f\uff0c\u5982\u679c\u5bb9\u91cf\u4e3a$0$\u5c31\u4e0d\u8981\u5012\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<vector>\n#include<queue>\nusing namespace std;\n#define ll long long\n#define RG register\n#define MAX 5010\ninline int read()\n{\n    RG int x=0,t=1;RG char ch=getchar();\n    while((ch<'0'||ch>'9')&&ch!='-')ch=getchar();\n    if(ch=='-')t=-1,ch=getchar();\n    while(ch<='9'&&ch>='0')x=x*10+ch-48,ch=getchar();\n    return x*t;\n}\nll sum;\nint n,K,V,a[MAX],b[MAX];\nbool f[MAX][MAX];\nint g[MAX][MAX],gg[MAX][MAX];\nbool vis[MAX];\nint main()\n{\n\tn=read();K=read();V=read();\n\tfor(int i=1;i<=n;++i)sum+=a[i]=read();\n\tif(sum<V){puts(\"NO\");return 0;}\n\tfor(int i=1;i<=n;++i)b[i]=a[i]%K;\n\tf[0][0]=1;\n\tmemset(g,-1,sizeof(g));\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tf[i][b[i]]=1;g[i][b[i]]=0;gg[i][b[i]]=1;\n\t\tfor(int j=0;j<K;++j)\n\t\t{\n\t\t\tif(i!=1||j!=0)if(f[i-1][j])f[i][j]=1;\n\t\t\tif(f[i-1][j])\n\t\t\t{\n\t\t\t\tf[i][(j+b[i])%K]=1;\n\t\t\t\tg[i][(j+b[i])%K]=j;\n\t\t\t}\n\t\t}\n\t}\n\tif(V%K==0)\n\t{\n\t\tputs(\"YES\");\n\t\tfor(int i=2;i<=n;++i)if(a[i])printf(\"%d %d %d\\n\",(a[i]-1)/K+1,i,1);\n\t\tif(V!=0)printf(\"%d %d %d\\n\",V/K,1,2);\n\t\treturn 0;\n\t}\n\tif(!f[n][V%K]){puts(\"NO\");return 0;}\n\tputs(\"YES\");\n\tint now=V%K,fst,ns;\n\tfor(int i=n;i>=1;--i)\n\t\tif(g[i][now]!=-1)vis[i]=true,now=g[i][now],fst=i;\n\t\telse ns=i;\n\tfor(int i=1;i<=n;++i)\n\t\tif(i!=fst)\n\t\t{\n\t\t\tif(!a[i])continue;\n\t\t\tif(vis[i])printf(\"%d %d %d\\n\",(a[i]-1)/K+1,i,fst);\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(i!=ns)printf(\"%d %d %d\\n\",(a[i]-1)/K+1,i,ns);\n\t\t\t\tsum-=a[i];\n\t\t\t}\n\t\t}\n\tint nt=fst+1;if(nt==n+1)nt=fst-1;\n\tif(sum-V>=K)cout<<(sum-V)/K<<' '<<fst<<' '<<nt<<endl;\n\telse if(sum<V)\n\t{\n\t\tint tt=(V-sum)/K;\n\t\tcout<<tt<<' '<<ns<<' '<<fst<<endl;\n\t}\n\treturn 0;\n}\n\n```\n",
        "postTime": 1517709634,
        "uid": 21283,
        "name": "yybyyb",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF920D \u3010Tanks\u3011"
    }
]
[
    {
        "content": "- [CF925F Parametric Circulation](https://www.luogu.com.cn/problem/CF925F)\n\n---\n\n\n\u524d\u7f6e\u77e5\u8bc6\uff1a[\u65e0\u6e90\u6c47\u4e0a\u4e0b\u754c\u53ef\u884c\u6d41](https://www.xht37.com/%E4%BA%8C%E5%88%86%E5%9B%BE%E4%B8%8E%E7%BD%91%E7%BB%9C%E6%B5%81-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/#lwptoc53) \u7684\u6c42\u6cd5\u3002\uff08\u94fe\u63a5\u600e\u4e48\u6302\u4e86\uff0c\u4e5f\u53ef\u4ee5\u770b [\u8fd9\u91cc](https://www.luogu.com.cn/blog/xht37/er-fen-tu-yu-wang-lao-liu)\uff09\n\n\u9996\u5148\u8981\u731c\u51fa\u4e00\u4e2a\u7ed3\u8bba\uff1a\u7b26\u5408\u6761\u4ef6\u7684 $t$ \u662f\u8fde\u7eed\u4e00\u6bb5\uff0c\u53ea\u9700\u8981\u627e\u51fa\u7aef\u70b9\u3002\n\n\u8bbe $gap=\\sum_{d_i>0} d_i-\\text{maxflow}$ \uff0c\u6839\u636e\u65e0\u6e90\u6c47\u4e0a\u4e0b\u754c\u53ef\u884c\u6d41\u7684\u77e5\u8bc6\uff0c\u5f53 $gap=0$ \u65f6\uff0c\u6709\u53ef\u884c\u6d41\u3002\n\n\u8bbe $suml=\\sum_{d_i>0} d_i$ \u3002\n\n[\u6253\u8868](https://www.luogu.com.cn/paste/uml890g3) \u4e00\u4e0b\u53d1\u73b0\uff0c$suml$ \u4e0e $maxflow$ \u5173\u4e8e $t$ \u7684\u51fd\u6570\u662f\u8fd9\u6837\u7684\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/jgv907hr.png)\n\n\u56e0\u4e3a\u6700\u5927\u6d41\u7b49\u4e8e\u6700\u5c0f\u5272\uff0c\u800c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5272\u5173\u4e8e $t$ \u7684\u51fd\u6570\u90fd\u662f\u4e00\u6761\u76f4\u7ebf\uff08\u4e00\u6b21\u51fd\u6570\uff09\uff0c\u6700\u5c0f\u5272\u4e3a\u4e00\u5bf9\u76f4\u7ebf\u6c42\u6700\u5c0f\u503c\u3002\u56e0\u6b64\u6700\u5927\u6d41 = \u6700\u5c0f\u5272\u5173\u4e8e $t$ \u7684\u51fd\u6570\u662f\u4e00\u4e2a\u4e0a\u51f8\u58f3\u3002\n\n\u7531\u4e8e $suml=\\sum_{d_i>0} d_i$\uff0c\u8fd9\u4e2a $suml$ \u4e3a\u4e00\u6761\u76f4\u7ebf\uff0c\u800c $gap=suml-\\text{maxflow}=suml-\\text{mincut}$ \u5c31\u662f\u4e00\u4e2a\u4e0b\u51f8\u58f3\u3002\n\n\u56e0\u6b64\u53ef\u4ee5\u5728 $gap$ \u51fd\u6570\u4e0a\u4e09\u5206\u5f97\u5230\u6700\u5c0f\u503c\u70b9\uff0c\u82e5\u6700\u5c0f\u65f6 $gap=0$ \u5219\u4e24\u8fb9\u4e8c\u5206\u51fa $gap=0$ \u7684\u8fb9\u754c\u3002\n\n\u53ef\u4ee5\u5c06\u6574\u4f53\u503c\u57df\u4e58\u4e0a $10^8$ \u907f\u514d double \u8fd0\u7b97\u3002\n\nCode :\n```cpp\n#include<bits/stdc++.h>\n#define For(i,a,b) for(register int i=(a);i<=(b);++i)\n#define Rep(i,a,b) for(register int i=(a);i>=(b);--i)\n#define int long long\nusing namespace std;\ninline int read()\n{\n    char c=getchar();int x=0;bool f=0;\n    for(;!isdigit(c);c=getchar())f^=!(c^45);\n    for(;isdigit(c);c=getchar())x=(x<<1)+(x<<3)+(c^48);\n    if(f)x=-x;return x;\n}\nconst int maxn=2007,maxm=4007,inf=0x3f3f3f3f3f3f3f3f;\nint n,m,s,t,maxflow;\nint dep[maxn],cur[maxn],de[maxn];\nint tot=1,head[maxn];\nstruct edge{\n\tint to,nxt,w;\n}e[maxm<<1];\ninline void adde(int u,int v,int w){\n\te[++tot]=(edge){v,head[u],w};\n\thead[u]=tot;\n}\ninline void add(int u,int v,int w){\n\tadde(u,v,w);\n\tadde(v,u,0);\n}\ninline void ins(int u,int v,int l,int r){\n\tadd(u,v,r-l),de[u]-=l,de[v]+=l;\n}\nbool bfs(int s,int t)\n{\n\tqueue<int>q;\n\tmemcpy(cur,head,sizeof cur);\n\tmemset(dep,63,sizeof dep);\n\tdep[s]=0;q.push(s);\n\twhile(!q.empty())\n\t{\n\t\tint u=q.front();q.pop();\n\t\tfor(int i=head[u];i;i=e[i].nxt)\n\t\t{\n\t\t\tint v=e[i].to;\n\t\t\tif(dep[v]==inf&&e[i].w){\n\t\t\t\tdep[v]=dep[u]+1;\n\t\t\t\tq.push(v);\n\t\t\t}\n\t\t}\n\t}return dep[t]<inf;\n}\nint dfs(int u,int t,int minn)\n{\n\tif(!minn||u==t)return minn;\n\tint res=0;\n\tfor(int i=cur[u];i;i=e[i].nxt)\n\t{\n\t\tint v=e[i].to;\n\t\tcur[u]=i;\n\t\tif(dep[v]!=dep[u]+1)continue;\n\t\tint flow=dfs(v,t,min(minn,e[i].w));\n\t\tif(!flow)continue;\n\t\tres+=flow,minn-=flow;\n\t\te[i].w-=flow,e[i^1].w+=flow;\n\t\tif(!minn)break;\n\t}\n    if(!res) dep[u]=0;\n    return res;\n}\ninline int dinic(int s,int t)\n{\n\tint maxflow=0;\n\twhile(bfs(s,t))maxflow+=dfs(s,t,inf);\n\treturn maxflow;\n}\nint a[maxn],b[maxn],c[maxn],d[maxn],uu[maxn],vv[maxn],lim=100000000;\nmap<int,int>mp;\nint func(int v)\n{\n\tif(mp.count(v))return mp[v];\n\tFor(i,1,n+2)head[i]=de[i]=0;\n\ts=n+1,t=n+2;tot=1;\n\tFor(i,1,m){\n\t\tint l=a[i]*v+b[i]*lim,r=c[i]*v+d[i]*lim;\n\t\tins(uu[i],vv[i],l,r);\n\t}\n\tint res=0;\n\tFor(i,1,n)\n\t\tif(de[i]>0)add(s,i,de[i]),res+=de[i];\n\t\telse add(i,t,-de[i]);\n\treturn mp[v]=res-dinic(s,t);\n}\n#define mkp make_pair\n#define fi first\n#define se second\nsigned main()\n{\n\tn=read(),m=read();\n\tFor(i,1,m){\n\t\tuu[i]=read(),vv[i]=read();\n\t\ta[i]=read(),b[i]=read(),c[i]=read(),d[i]=read();\n\t}\n\tfunc(75000004);//exit(0);\n\tint l=0,r=lim;\n\twhile(r-l>=5){\n\t\tint m1=l+(r-l)/3,m2=r-(r-l)/3;\n\t\tif(func(m1)<func(m2))r=m2;\n\t\telse l=m1;\n\t}\n\t\n\tpair<int,int>mg=mkp(inf,inf);\n\tFor(i,l,r)mg=min(mg,mkp(func(i),i));\n\tif(mg.first){\n\t\tputs(\"0\");\n\t\treturn 0;\n\t}\n\tl=mg.se+1,r=lim;\n\tint resl=mg.se,resr=mg.se;\n\twhile(l<=r){\n\t\tint mid=l+r>>1;\n\t\tif(!func(mid))resr=mid,l=mid+1;\n\t\telse r=mid-1;\n\t}//exit(0);\n\tl=0,r=mg.se-1;\n\twhile(l<=r){\n\t\tint mid=l+r>>1;\n\t\tif(!func(mid))resl=mid,r=mid-1;\n\t\telse l=mid+1;\n\t}\n\tprintf(\"%.8lf\",1.0*(resr-resl)/lim);\n    return 0;\n}\n```",
        "postTime": 1613972913,
        "uid": 151935,
        "name": "Rainbow_qwq",
        "ccfLevel": 0,
        "title": "CF925F Parametric Circulation"
    }
]
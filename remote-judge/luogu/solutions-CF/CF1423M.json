[
    {
        "content": "APIO2021 \u8bb2\u8bfe $\\color{black}{I}\\red{tst}$ \u8bb2\u7684\u4e00\u4e2a\u795e\u4ed9\u7b97\u6cd5\u3002\n\n\u6b64\u9898\u5927\u81f4\u9898\u610f\u662f\uff0c\u7ed9\u5b9a\u4e00\u4e2a $n\\times m$ \u77e9\u9635 $A$ \u6ee1\u8db3 $1\\leq x<y \\leq n,min_x(A)\\leq min_y(A)$\u3002 $min_k(A)$ \u6307 $A$ \u4e2d\u7b2c $k$ \u884c\u6700\u5c0f\u503c\u7684\u4f4d\u7f6e\u3002\u8981\u901a\u8fc7\u4e0d\u8d85\u8fc7 $4\\times(n+m)$ \u6b21\u67e5\u8be2\u5355\u4e2a\u5143\u7d20\u7684\u503c\u6c42\u51fa\u77e9\u9635\u4e2d\u7684\u6700\u5c0f\u503c\u3002\n\n\u8fd9\u91cc\u76f4\u63a5\u5f15\u5165 SMAWK \u7b97\u6cd5\u3002\n\n\u9996\u5148\u4ecb\u7ecd SMAWK \u7b97\u6cd5\u7684\u4e00\u4e2a\u91cd\u8981\u8fc7\u7a0b\uff1a$reduce$ \u8fc7\u7a0b\u3002\n\n\u9996\u5148\u6211\u4eec\u5b9a\u4e49\uff0c\u5f53\u4e00\u4e2a\u4f4d\u7f6e\u4e0d\u53ef\u80fd\u662f\u5f53\u524d\u884c\u7684\u6700\u5c0f\u503c\u4f4d\u7f6e\uff0c\u90a3\u4e48\u79f0\u5176\u4e3a\u5197\u4f59\u4f4d\u7f6e\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53d1\u73b0\u6bcf\u4e00\u5217\u4e0a\u9762\u5197\u4f59\u4f4d\u7f6e\u4e00\u5b9a\u5305\u62ec\u4e86\u4e00\u4e2a\u5217\u4e0a\u7684\u524d\u7f00\u3002\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651\u5982\u4f55\u5220\u9664\u5197\u4f59\u7684\u5217\u6765\u5f97\u5230 $n\\times \\min(n,m)$ \u7684\u77e9\u9635\u3002\n\n\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u6307\u9488 $k$ \u521d\u59cb\u4e3a $1$ \uff0c\u7136\u540e\u8fdb\u884c\u5982\u4e0b\u64cd\u4f5c\uff1a\n\n1:\u5f53 $n \u2265 m$ \u65f6\u7ed3\u675f\uff0c\u5426\u5219\u6bd4\u8f83 $a_{k,k}$ \u548c $a_{k,k+1}$\u3002\n \n2:\u82e5 $a_{k,k}  \u2265 a_{k,k+1}$\uff0c\u5220\u9664\u7b2c $k$ \u5217\uff0c$k = \\max(k-1,1) $\uff0c\u56de\u5230\u6b65\u9aa4 1\uff1b\n\n3:\u82e5 $a_{k,k}  < a_{k,k+1}$ \u4e14 $k=n$ \uff0c\u5220\u9664\u7b2c $n+1$ \u5217\uff0c\u56de\u5230\u6b65\u9aa4 1\uff1b\n\n4:\u82e5 $a_{k,k}  < a_{k,k+1}$ \u4e14 $k < n$ \uff0c$k=k+1$\uff0c\u56de\u5230\u6b65\u9aa4 1\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651\u8fd9\u4e48\u505a\u4e3a\u4ec0\u4e48\u662f\u5bf9\u7684\uff1a\n![](https://cdn.luogu.com.cn/upload/image_hosting/89nv804r.png)\n\n\u6211\u4eec\u76ee\u524d\u7ef4\u62a4\u7684\u77e9\u9635 $k\\times k$ \u663e\u7136\u5728\u5bf9\u89d2\u7ebf\u4ee5\u4e0a\uff08\u6ce8\u610f\u4e0d\u5305\u62ec\u5bf9\u89d2\u7ebf\uff09\u7684\u5fc5\u5b9a\u662f\u5197\u4f59\u4f4d\u7f6e\uff0c\u5426\u5219\u4e2d\u95f4\u4e00\u5b9a\u6709\u5197\u4f59\u5217\u3002\n\n\u82e5 $a_{k,k}  \u2265 a_{k,k+1}$ \u90a3\u4e48\u663e\u7136\u7b2c $k$ \u6574\u5217\u90fd\u662f\u5197\u4f59\u5217\uff0c\u56e0\u4e3a $a_{k,1\u2026\u2026k-1}$ \u90e8\u5206\u5df2\u7ecf\u786e\u5b9a\u4e3a\u5197\u4f59\u4f4d\u7f6e\uff0c\u800c $a_{k,k}$ \u4e5f\u88ab\u786e\u5b9a\u4e3a\u5197\u4f59\u4f4d\u7f6e\u4e5f\u76f4\u63a5\u5bfc\u81f4\u6574\u5217\u88ab\u786e\u5b9a\u4e3a\u5197\u4f59\u5217\uff0c\u4e8e\u662f\u5220\u9664\u6b64\u5217\u3002\n\n\u5426\u5219\u6211\u4eec\u8003\u8651\uff0c\u82e5 $a_{k,k}  < a_{k,k+1}$ \u4e14 $k=n$ \u90a3\u4e48\u663e\u7136\u4e0b\u4e00\u5217\u5fc5\u5b9a\u662f\u5197\u4f59\u5217\uff0c\u5220\u9664\u5373\u53ef\uff0c\u5426\u5219\u6211\u4eec\u8fd8\u4e0d\u80fd\u786e\u5b9a\u4e0b\u4e00\u5217\u662f\u5426\u4e3a\u5197\u4f59\u5217\uff0c\u5c06 $k++$ \u5373\u53ef\u3002\n\n\u4e8e\u662f $reduce$ \u8fc7\u7a0b\u7ed3\u675f\u4e86\uff0c\u8fd4\u56de\u4e00\u4e2a $n\\times \\min(n,m)$ \u7684\u77e9\u9635 $b$ \u3002\n\n\u8003\u8651\u4e00\u6b21 $reduce$ \u4f1a\u67e5\u8be2\u51e0\u4e2a\u503c\uff0c\u6bcf\u6b21\u6211\u4eec\u4f1a\u53d1\u73b0 $k$ \u8981\u4e48\u52a0 $1$ \u6216\u51cf $1$ \u4e14\u5220\u9664\u4e00\u5217\uff0c\u67e5\u8be2\u7684\u503c\u5dee\u4e0d\u591a\u662f $O(n+m)$ \u4e2a\u3002  \n\n\u63a5\u4e0b\u6765\u5f15\u5165 SMAWK \u7684\u4e3b\u4f53 $SMAWK(a)$ \n\n\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651\u5c06 $b$ \u5206\u6210\u4e24\u90e8\u5206\uff0c\u5947\u6570\u884c\u4e0e\u5076\u6570\u884c\u5206\u5f00\uff0c\u8fd9\u6837\u5b50\u6211\u4eec\u5c31\u628a\u8fd9\u4e2a\u77e9\u9635\u5206\u6210\u4e86\u4e24\u4e2a\u96c6\u5408 $a,c$ \uff0c\u6211\u4eec\u5148\u8fd0\u884c $SMAWK(c)$\uff0c\u6c42\u51fa\u5076\u6570\u884c\u6bcf\u884c\u7684\u6700\u5c0f\u503c\u4f4d\u7f6e\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/w5uy90oi.png)\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u6839\u636e\u8fd9\u4e2a\u77e9\u9635\u7684\u6027\u8d28\uff0c\u53ef\u4ee5\u5f97\u51fa\u7b2c\u4e00\u884c\u6700\u5c0f\u503c\u6240\u5728\u7684\u4f4d\u7f6e $p_1$ \u4e00\u5b9a\u5728 $1$ ~ $p_2$ \u4e4b\u95f4 $p_3$ \u4e00\u5b9a\u5728 $p_2$ ~ $p_4$ \u4e4b\u95f4\u2026\u2026\u4ee5\u6b64\u7c7b\u63a8\u3002\n\n\u7136\u540e\u6211\u4eec\u8fd9\u90e8\u5206\u66b4\u529b\u67e5\u8be2\u5c31\u5f97\u5230\u4e86 $a$ \u4e2d\u6bcf\u4e00\u884c\u7684\u6700\u5c0f\u503c\u7684\u4f4d\u7f6e\uff0c\u4e00\u6b21\u67e5\u8be2\u4e86 $O(n+m)$ \u4e2a\u503c\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u5206\u6790\u4e00\u4e0b\u603b\u4f53\u7684\u590d\u6742\u5ea6\uff1a\n\n\u8bbe $f(n,m)$ \u662f $n\\times m$ \u7684\u77e9\u9635\u8fdb\u884c SMAWK \u7684\u590d\u6742\u5ea6\uff0c\u90a3\u4e48\u53ef\u4ee5\u5f97\u5230\u5f53 $n\\leq m$ \u65f6\u6709 $f(n,m)=f(\\frac{n}{2},n))+n+m$\uff0c$n>m$ \u65f6\u4e3a $f(n,m)=f(\\frac{n}{2},m)+n+m$ \u5e76\u4e14 $n>m$ \u7684\u60c5\u51b5\u9012\u5f52 $\\log\\frac{n}{m}$ \u5c42\u540e\u53d8\u4e3a\u4e86 $n\\leq m$ \u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u603b\u4f53\u590d\u6742\u5ea6\u662f $O(m(1 + \\log\\frac{n}{m}) + n)$\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u6211\u7528\u7684\u662f\u94fe\u8868\u8fdb\u884c\u5220\u9664\u5217\u7684\u64cd\u4f5c\uff0c\u5b50\u77e9\u9635\u7528\u7ef4\u62a4\u5217\u4e0e\u884c\u7684\u96c6\u5408\u64cd\u4f5c\u3002\n\n```c++\n//QwQcOrZ yyds!!!\n#include<bits/stdc++.h>\n#define ll long long\n#define F(i,a,b) for (int i=(a);i<=(b);i++)\n#define R(i,a,b) for (int i=(a);i<(b);i++)\n#define D(i,a,b) for (int i=(a);i>=(b);i--)\n#define go(i,x) for (int i=head[x];i;i=e[i].nx)\n#define mp make_pair\n#define pb push_back\n#define pa pair < int,int >\n#define fi first\n#define se second\n#define re register\n#define be begin()\n#define en end()\n#define sqr(x) ((x)*(x))\n//#define ret return puts(\"-1\"),0;\n#define put putchar('\\n')\n#define inf 1e18\n#define mod 998244353\n//#define int ll\n#define N 1000005\nusing namespace std;\ninline char gc(){static char buf[100000],*p1=buf,*p2=buf;return p1==p2&&(p2=(p1=buf)+fread(buf,1,100000,stdin),p1==p2)?EOF:*p1++;}\n#define gc getchar\ninline ll read(){char c=gc();ll su=0,f=1;for (;c<'0'||c>'9';c=gc()) if (c=='-') f=-1;for (;c>='0'&&c<='9';c=gc()) su=su*10+c-'0';return su*f;}\ninline void write(ll x){if (x<0){putchar('-');write(-x);return;}if (x>=10) write(x/10);putchar(x%10+'0');}\ninline void writesp(ll x){write(x),putchar(' ');}\ninline void writeln(ll x){write(x);putchar('\\n');}\nint pre[N],suf[N],M[N],n,m,ans=1e18,P=0;\nvector<int>L,H;\nmap<int,int>Mp[N];\nint query(int x,int y,int z)\n{\n\tif (Mp[x][y]) return Mp[x][y];\n\tcout<<\"? \"<<x<<\" \"<<y<<endl;\n\tint p;\n\tcin>>p;\n\tMp[x][y]=p;\n\treturn p;\n}\nvoid del(int x)\n{\n\tif (pre[x]!=-1)\n\t\tsuf[pre[x]]=suf[x]; else P=suf[x];\n\tpre[suf[x]]=pre[x];\n}\nvector<int> reduce(vector<int>X,vector<int>Y)\n{\n\tfor (int i=0;i<Y.size();i++) pre[i]=i-1,suf[i]=i+1;\n\tint x=0,y=0;\n\tP=0;\n\tfor (int nmsl=Y.size()-X.size();nmsl>0;nmsl--)\n\t{\n\t\tif (query(X[x],Y[y],0)>query(X[x],Y[suf[y]],0))\n\t\t{\n\t\t\ty=suf[y];\n\t\t\tdel(pre[y]);\n\t\t\tif (x) y=pre[y],x--;\n\t\t} else\n\t\t{\n\t\t\tif (x==X.size()-1) del(suf[y]);\n\t\t\telse\n\t\t\t{\n\t\t\t\ty=suf[y];\n\t\t\t\tx++;\n\t\t\t}\n\t\t}\n\t}\n\tvector<int>ret;\n\tfor (int i=P;i!=Y.size();i=suf[i])\tret.push_back(Y[i]);\n\treturn ret;\n}\nvoid Solve(vector<int>X,vector<int>Y)\n{\n\tY=reduce(X,Y);\n\tif (X.size()==1)\n\t{\n\t\tM[X[0]]=Y[0];\n\t\treturn;\n\t}\n\tvector<int>Z;\n\tfor (int i=0;i<X.size();i++)\n\t\tif (!(i%2)) Z.push_back(X[i]);\n\tSolve(Z,Y);\n\tfor (int i=0;i<X.size();i++)\n\t{\n\t\tif (!(i%2)) continue;\n\t\tint l=lower_bound(Y.begin(),Y.end(),M[X[i-1]])-Y.begin();\n\t\tint r=0;\n\t\tif (i==X.size()-1) r=Y.size()-1;\n\t\telse \n\t\t{\n\t\t\tr=lower_bound(Y.begin(),Y.end(),M[X[i+1]])-Y.begin();\n\t\t}\n\t\tM[X[i]]=Y[l];\n\t\twhile (l<r)\n\t\t{\n\t\t\tl++;\n\t\t\tif (query(X[i],Y[l],1)<query(X[i],M[X[i]],1)) M[X[i]]=Y[l];\n\t\t}\n\t}\n}\nsigned main()\n{\n\tcin>>n>>m;\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tH.push_back(i);\n\t}\n\tfor (int i=1;i<=m;i++) L.push_back(i);\n\tSolve(H,L);\n\tfor (int i=1;i<=n;i++)\n\t\tans=min(ans,query(i,M[i],1));\n\tcout<<\"! \"<<ans<<endl;\n\t \n}\n/*\n\n*/\n\n\n",
        "postTime": 1621519206,
        "uid": 120911,
        "name": "Lynkcat",
        "ccfLevel": 9,
        "title": "SMAWK \u5b66\u4e60\u7b14\u8bb0"
    },
    {
        "content": "## \u4e00\u4e9b\u5b9a\u4e49\n\n1D/1D \u65b9\u7a0b\uff1a$f_i=\\min_{j<i}g_j+w_{j,i}$\n\n\u6700\u4f18\u51b3\u7b56\uff1a\u4e0d\u59a8\u8bbe\u4e3a $ps_i<i$\uff0c\u6ee1\u8db3 $f_i=g_{ps_i}+w_{ps_i,i}$\u3002\n\n\u51b3\u7b56\u5355\u8c03\u6027\uff1a$\\forall i<n,ps_i\\le ps_{i+1}$\u3002\n\n~~\u4ee5\u4e0a\u548c\u672c\u9898\u6ca1\u6709\u592a\u5927\u5173\u7cfb\u3002~~\n\n\u5bf9\u4e8e\u77e9\u9635 $A$ \u5b9a\u4e49 $pos_i=\\{j|\\forall p,A_{j,i}\\le A_{p,i}\\}$\u3002\n\n\u5355\u8c03\u77e9\u9635\uff1a\u6ee1\u8db3 $\\forall i<j,pos_i\\le pos_j$ \u7684\u77e9\u9635 $A$\u3002\n\n\u5b8c\u5168\u5355\u8c03\u77e9\u9635\uff1a\u6ee1\u8db3\u4efb\u610f\u4e00\u4e2a\u5b50\u77e9\u9635\u5747\u4e3a\u5355\u8c03\u77e9\u9635\u7684\u77e9\u9635 $A$\u3002\n\n\u5b50\u77e9\u9635\uff1a\u5bf9\u4e8e\u884c\u96c6\u5408 $i_1,i_2,\\cdots,i_n$ \u548c\u5217\u96c6\u5408 $j_1,j_2,\\cdots,j_m$\uff0c\u4ec5\u4fdd\u7559 $x\\in\\{i\\},y\\in\\{j\\}$ \u7684\u5143\u7d20 $A_{x,y}$ \u6240\u5f62\u6210\u7684\u77e9\u9635\u3002\n\n\u6027\u8d28\uff1a\u5b8c\u5168\u5355\u8c03\u77e9\u9635\u7684\u5b50\u77e9\u9635\u8fd8\u662f\u5b8c\u5168\u5355\u8c03\u77e9\u9635\u3002\n\n## \u53ef\u80fd\u662f\u6b63\u6587\n\n\u4e00\u822c\u7684 1D/1D \u53ef\u4ee5\u901a\u8fc7\u4ee4 $A_{i,j}=g_j+w_{j,i}$\uff0c$f_i=A_{pos_i,i}$ \u4ece\u800c\u5957\u7528\u4e0b\u8ff0\u7b97\u6cd5\u3002\n\n\u4e0d\u96be\u53d1\u73b0\u9898\u76ee\u7ed9\u51fa\u6761\u4ef6\u5373\u4e3a\u5b8c\u5168\u5355\u8c03\u77e9\u9635\u7684\u5b9a\u4e49\uff0c\u6211\u4eec\u53ea\u8981\u6c42\u51fa $\\{pos\\}$ \u5373\u53ef\u5728 $n$ \u6b21\u8be2\u95ee\u5185\u7ed9\u51fa\u56de\u7b54\uff0c\u4e8b\u5b9e\u4e0a\uff0c\u5728\u6c42\u51fa $pos$ \u7684\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u8bb0\u5f55\u4e0b\u672c\u9898\u7684\u7b54\u6848\u3002\n\n\u6c42\u51fa\u4e00\u4e2a\u5b8c\u5168\u5355\u8c03\u77e9\u9635\u7684 $pos$ \u6570\u7ec4\uff0c\u53ef\u4ee5\u4f7f\u7528 SMAWK \u7b97\u6cd5\u3002\uff08\u8bfb\u97f3\u540c\uff1asmoke \u7b97\u6cd5\uff09\n\n## \u7b80\u5355\u5206\u6cbb\n\n\u6211\u4eec\u53d6\u51fa\u5947\u6570\u5217\uff0c\u9012\u5f52\u6c42\u51fa\u5b83\u4eec\u7684 $pos$\uff0c\u9012\u5f52\u5230\u5e95\u5c42\u53ea\u6709\u4e00\u884c\u65f6\u66b4\u529b\u6c42\u51fa $pos$ \u5e76\u8fd4\u56de\u3002\n\n\u5219\u5bf9\u4e8e\u5076\u6570\u5217\u7684\u51b3\u7b56 $pos_{2k}$ \u53ef\u4ee5\u901a\u8fc7\u904d\u5386 $i\\in[pos_{2k-1},pos_{2k+1}]$ \u6765\u89e3\u51b3\uff0c\u590d\u6742\u5ea6\u662f $O(t\\times(pos_{n+1}-pos_0)=tn)$\uff0c\u5176\u4e2d $t$ \u4e3a\u9012\u5f52\u5c42\u6570\uff0c\u663e\u7136\u4e3a $\\log_2n$\u3002\n\n## \u4f18\u5316\n\n\u6bcf\u5217\u53ea\u9700\u8981\u4e00\u4e2a $pos$\uff0c\u82e5\u6211\u4eec\u5c06 $n\\times n\\to \\frac n2\\times n\\to\\frac n4\\times n\\to\\cdots$ \u7684\u77e9\u9635\u4f20\u4e0b\u53bb\uff0c\u53d1\u73b0\u7b2c\u4e8c\u7ef4\u6709\u8bb8\u591a\u5143\u7d20\u65e0\u7528\u3002\n\n\u5229\u7528\u5b8c\u5168\u5355\u8c03\u77e9\u9635\u7684\u6027\u8d28\uff0c\u6211\u4eec\u6709\u5982\u4e0b\u7ed3\u8bba\uff1a\n\n$A_{i_1,j}<A_{i_2,j}\\to pos_{i_2}\\neq\\{A_{i_2,c}|1\\le c\\le j\\}$\n\n$A_{i_1,j}\\ge A_{i_2,j}\\to pos_{i_1}\\neq\\{A_{i_1,c}|j\\le c\\le n\\}$\n\n\u8fd9\u91cc $\\neq$ \u975e\u4e25\u8c28\u7684\u5b9a\u4e49\u4e3a\u9664\u53bb\u540e\u8fd8\u5b58\u5728\u4f4d\u7f6e\u6ee1\u8db3 $pos$ \u7684\u5b9a\u4e49\u3002\n\n\u6839\u636e\u6b64\u6027\u8d28\u6211\u4eec\u8bbe\u8ba1\u5982\u4e0b\u8fc7\u7a0b\uff0c\u5b9a\u4e49 $Del(i)$ \u4e3a\u53bb\u9664\u7b2c $i$ \u884c\uff1a\n\n- \u521d\u59cb\u4f4d\u7f6e\u5728 $(1,1)$\uff0c\u5f53\u524d\u4f4d\u7f6e\u5728 $(i,i)$\u3002\n- \u6bd4\u8f83 $A_{i,i},A_{i,i+1}$\uff1a\n  - \u82e5 $A_{i,i}\\ge A_{i,i+1}$\uff0c\u5219 $Del(i)$\u3002\n    - \u82e5 $i\\neq 1$\uff0c\u5219 $i-1\\to i$\u3002\n  - \u82e5 $A_{i,i}<A_{i,i+1}$\uff1a\n    - \u82e5 $i=n$\uff0c\u5219 $Del(n+1)$\u3002\n    - \u82e5 $i\\neq n$\uff0c\u5219 $i+1\\to i$\u3002\n    \n\u8fd9\u4e2a\u8fc7\u7a0b\u88ab\u79f0\u4e4b\u4e3a $Reduce$ \u64cd\u4f5c\uff0c\u5c06\u5176\u5728\u6bcf\u6b21\u9012\u5f52\u53d6\u5947\u6570\u884c\u524d\u8c03\u7528\u5373\u5f97\u5230\u4e86 SMAWK \u7b97\u6cd5\u3002\n\n## \u5b9e\u73b0\n\n~~\u6211\u600e\u4e48\u80fd\u516c\u7136\u8bf4\u6211\u7684\u5b9e\u73b0\u597d\u5462\uff1f~~\n\n\u6211\u7684\u5b9e\u73b0\u548c\u5176\u4ed6\u4eba\u4e0d\u4e00\u6837\uff0c**\u4e3b\u8981**\u4f53\u73b0\u5728\uff1a\n\n- \u975e\u9012\u5f52\u3002\n- \u65e0\u94fe\u8868\uff0c\u4e5f\u65e0 `vector` \u4e00\u7c7b\u3002\n\n~~\u7531\u4e8e\u672c\u9898\u5361\u4ea4\u4e92\u6b21\u6570\u4ee3\u7801\u5df2\u7ecf\u88ab\u6539\u7684\u9762\u76ee\u5168\u975e\uff0c\u6709\u9700\u8981\u7684\u627e\u6211\uff0c\u6211\u53ef\u4ee5\u636e\u60c5\u51b5\u53cb\u60c5\u63d0\u4f9b\u5e2e\u52a9\u3002~~\n\n\u63d0\u4f9b[\u4ee3\u7801](https://www.luogu.com.cn/paste/tn5u639f)\uff0c\u542b\u6ce8\u91ca\u3002\n\n\u5b9e\u9645\u4e0a\uff0c\u53ea\u8981 $Reduce$ \u64cd\u4f5c\u5bf9\u4e86\uff0c\u5220\u9664\u771f\u7684\u5220\u6389\u4e86\uff0c\u904d\u5386 $[pos_{2k-1},pos_{2k+1}]$ \u4e5f\u6ca1\u5199\u9519\uff0c\u8fd9\u7b97\u6cd5\u5fc5\u5b9a\u662f\u7ebf\u6027\u7684\u3002\n\n\u5269\u4e0b\u7684\u5c31\u662f\u5361\u6b21\u6570\uff0c\u7ed9\u51fa\u4e24\u70b9\u9700\u8981\u6ce8\u610f\u7684\u5730\u65b9\uff1a\n\n- $Reduce$ \u8be2\u95ee\u8fc7\u7684\u5730\u65b9\u53ef\u4ee5\u5b58\u4e0b\u6765\uff0c\u5728 $A_{i,i}\\ge A_{i,i+1},i\\neq 1$ \u7684\u56de\u9000\u65f6\u4e0d\u8981\u91cd\u65b0\u8be2\u95ee\uff0c\u5c11\u4e00\u500d\u6b21\u6570\u3002\n- \u6700\u540e\u7684 $pos$ \u4e0d\u7528\u91cd\u65b0\u8be2\u95ee\uff0c\u5728\u5904\u7406\u8fc7\u7a0b\u4e2d\u65f6\u523b\u66f4\u65b0\u7b54\u6848\uff0c\u5c11\u4e00\u500d\u6b21\u6570\u3002\n\n\u6b63\u7740 $Reduce$ \u4e24\u500d\u6b21\u6570\uff0c\u53cd\u7740\u5904\u7406\u5076\u6570\u5217\u4e00\u500d\u6b21\u6570\uff0c\u5269\u4e0b\u7684\u4e00\u500d\u6b21\u6570\u6211\u7528\u6765\u91cd\u65b0\u8be2\u95ee\uff08\u8fd9\u5927\u6982\u5c31\u662f\u6211 nt \u7684\u5730\u65b9\n\nCF \u8bc4\u6d4b\u7cfb\u7edf\u4e0a\u8d85\u8fc7\u6b21\u6570\u4e3a TLE\uff0c\u9664\u975e\u624b\u52a8\u8fd4\u56de\uff0c\u5426\u5219\u4e0d\u7ed9\u63d0\u793a\u4fe1\u606f\uff0c\u8fd9\u662f\u6211\u6ca1\u60f3\u5230\u7684\u3002",
        "postTime": 1649332157,
        "uid": 158948,
        "name": "\u7ea6\u745f\u592b\u7528\u8111\u73a9",
        "ccfLevel": 0,
        "title": "CF1423M Milutin's Plums"
    },
    {
        "content": "# \u9898\u610f\n\u7ed9\u5b9a\u4e00\u4e2a $n\\times m$ \u77e9\u9635\uff0c\u5176\u6240\u6709\u5b50\u77e9\u9635\u6ee1\u8db3\uff1a\n- \u4ee4 $L(i)$ \u4e3a\u77e9\u9635\u7b2c $i$ \u884c\u7684\u6700\u5de6\u8fb9\u7684\u53d6\u5230\u6700\u5c0f\u503c\u7684\u4f4d\u7f6e\uff0c\u5219\u6709$L(i)<=L(i+1)$\n\n\u4f60\u9700\u8981\u5728 $4(n+m)$ \u6b21\u8be2\u95ee\u77e9\u9635\u5355\u70b9\u503c\u7684\u64cd\u4f5c\u5185\u5f97\u51fa\u77e9\u9635\u7684\u6700\u5c0f\u5143\u7d20\u7684\u503c\u3002\n\n# SMAWK\u7b97\u6cd5\n\u529f\u80fd\uff1a\u5bf9\u4e8e\u4e00\u4e2a**\u5b8c\u5168\u5355\u8c03\u77e9\u9635**\uff08\u5373\u9898\u4e2d\u7684\u77e9\u9635\uff09\uff0c\u53ef\u4ee5\u5728 $O(n + m(1 + max(0, log \\frac nm)))$ \u6b21\u6c42\u77e9\u9635\u4e2d\u67d0\u70b9\u7684\u503c\u7684\u64cd\u4f5c\u4e2d\u6c42\u51fa\u6bcf\u884c\u7684\u6700\u5c0f\u503c\u53ca\u5176\u6240\u5728\u4f4d\u7f6e\u3002\n\n\u4ee5\u4e0b\u5185\u5bb9\u4e3b\u8981\u6539\u81ea$\\tt I\\color{red}tst$\u7684APIO\u8bfe\u4ef6\u3002\n\n\u672c\u9898\u548c\u8bfe\u4ef6\u7684\u4e0d\u540c\u4e4b\u5904\u5728\u4e8e\uff1a\u672c\u9898\u5b9a\u4e49\u7684\u5b8c\u5168\u5355\u8c03\u77e9\u9635\u662f\u6700\u5de6\u8fb9\u7684\u53d6\u5230\u6700\u5c0f\u503c\u7684\u5e97\uff0c\u800c\u8bfe\u4ef6\u4e2d\u662f\u6700\u53f3\u8fb9\u7684\u53d6\u5230\u6700\u5c0f\u503c\u7684\u70b9\u3002\u8fd9\u53ef\u80fd\u9700\u8981\u4f60\u6539\u53d8\u4e00\u4e9b $\\ge$ \u548c $>$ \uff08\u4e0d\u8fc7\u4e0d\u6539\u4e5f\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\uff09\u3002\u4ee5\u4e0b\u5185\u5bb9\u6309\u7167\u672c\u9898\u8003\u8651\u3002\n\n## \u5b50\u8fc7\u7a0b reduce\n\u6c42\u89e3\u884c\u6700\u5c0f\u503c\u7684\u77e9\u9635\u884c\u6570\u5c11\u800c\u5217\u6570\u591a\u65f6\uff0c\u6709\u5f88\u591a\u5217\u5197\u4f59\uff0c\u5220\u9664\u5b83\u4eec\u5bf9\u7b54\u6848\u4e0d\u4ea7\u751f\u5f71\u54cd\u3002\u6545\u8003\u8651\u5b50\u8fc7\u7a0b $\\tt reduce(A)$\uff0c$A$ \u662f $ n \\times m$ \u7684\u5b8c\u5168\u5355\u8c03\u77e9\u9635\u3002\u5176\u8fd4\u56de\u4e00\u4e2a $n \\times \\min(n, m)$ \u7684\u77e9\u9635\uff0c\u7ed3\u679c\u4e3a $A$ \u5220\u9664\u82e5\u5e72\u5197\u4f59\u7684\u5217\u5f97\u5230\u7684\u77e9\u9635\u3002\u5176\u7b97\u6cd5\u6d41\u7a0b\u5982\u4e0b\uff1a\n\n1. \u5b9a\u4e49 $k=1$ ;\n2. \u5f53 $n \\ge m$ \u65f6\u7ed3\u675f\uff0c\u5426\u5219\u6bd4\u8f83 $A_{k,k}$ \u548c$A_{k,k+1}$ \u3002\n3. \u82e5 $A_{k,k}>A_{k,k+1}$ \uff0c\u5220\u9664\u7b2c $k$ \u5217\uff0c$k \\larr \\max{k-1,1}$ \uff1b\n\n4. \u82e5 $A_{k,k}\\le A_{k,k+1}$ \u4e14 $k=n$ \uff0c\u5220\u9664\u7b2c $n+1$ \u5217\uff0c\u56de\u5230\u6b65\u9aa4 $2$ \uff1b\n5. \u82e5 $A_{k,k}\\le A_{k,k+1}$ \u4e14 $k\\ne n$ \uff0c $k\\larr k+1$ \uff0c\u56de\u5230\u6b65\u9aa4 $2$ \u3002\n\n\u53ef\u4ee5\u7406\u89e3\u4e3a\u7ef4\u62a4\u4e00\u4e2a\u5bf9\u89d2\u7ebf\u3002reduce \u4e00\u5171\u4f1a\u5220\u9664 $m-n$ \u5217\uff0c\u6bcf\u6b21\u8981\u4e48 $k$ \u52a0\u4e00\uff0c\u8981\u4e48\u5220\u4e00\u5217\uff08\u540c\u65f6 $k$ \u6700\u591a\u51cf\u4e00\uff09\u6545\u590d\u6742\u5ea6\u4e3a $O(m+n)$\u3002\n\n## SMAWK \u7b97\u6cd5\u6d41\u7a0b\n\nSMAWK \u7b97\u6cd5\u662f\u4e00\u4e2a\u9012\u5f52\u7b97\u6cd5\uff0c\u501f\u7528 reduce \u4f5c\u4e3a\u5b50\u8fc7\u7a0b\u3002\u8fc7\u7a0b $\\tt SMAWK(A)$ \u8868\u793a\u8ba1\u7b97 $n \\times m$ \u7684\u5b8c\u5168\u5355\u8c03\u77e9\u9635 $A$ \u7684\u6bcf\u884c\u6700\u5c0f\u503c\u6240\u5728\u5217\u3002\u7b97\u6cd5\u6d41\u7a0b\u5982\u4e0b\uff1a\n\n1. \u82e5 $\\min(n, m) = 1$ \u76f4\u63a5\u8ba1\u7b97\u7b54\u6848\uff1b \n2. \u8bbe $B = \\tt reduce(A), $ $C$ \u4e3a $B$ \u7684\u5b50\u77e9\u9635\uff0c $C = B_{[2,4,\u00b7\u00b7\u00b7 ,2\u230a n 2 \u230b],[1,2,\u00b7\u00b7\u00b7 ,min(n,m)]}$\uff1b \n3. \u9012\u5f52\u8ba1\u7b97 $\\tt SMAWK(C)$ \u5f97\u5230\u5076\u6570\u884c\u6700\u5c0f\u503c\u6240\u5728\u5217\uff1b \n4. \u5bf9\u4e8e B \u4e2d\u7684\u5947\u6570\u884c\uff0c\u5728\u5176\u76f8\u90bb\u4e24\u884c\u7684\u6700\u5c0f\u503c\u6240\u5728\u5217\u4e4b\u95f4\u66b4\u529b\u679a\u4e3e\u8ba1\u7b97\u51fa\u5176\u6700\u5c0f\u503c\u6240\u5728\u5217\u3002\n\n\u6b65\u9aa44\u7684\u590d\u6742\u5ea6\u4e3a $O(m)$\uff0c\u5f53$m\\ge n$\u65f6\u590d\u6742\u5ea6\u4e3a $O(m+n)$ \uff08\u7531\u4e8e\u6709reduce\uff09\uff0c\u5f53 $m<n$ \u65f6\u9012\u5f52 $\\log \\frac nm$ \u5c42\u4e4b\u540e\u8fdb\u5165 $n \\le m$ \u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u4e3a $O(m(1+\\max(0,\\log \\frac nm))+n)$ \n\n\n\n\u5b9e\u73b0\u65f6\u9700\u8981\u7528\u94fe\u8868\u8868\u793a\u5b50\u77e9\u9635 ~~\u7136\u800cItst\u7528\u4e86vector~~ \u4ee5\u4fdd\u8bc1\u590d\u6742\u5ea6\u6b63\u786e\u3002\n\n\u4ee3\u7801\uff1a\n\n[Itst\u7684\u4ee3\u7801](https://codeforces.ml/contest/1423/submission/94775385)\n\n\u6211\u7684\u4ee3\u7801\uff1a\uff08\u56e0\u4e3a\u4e0d\u4f1a\u641e\u94fe\u8868\u6240\u4ee5\u5199\u5f97\u7279\u522b\u62c9\uff09\n\n```cpp\n#include<bits/stdc++.h>\n#define N 1000005\n#define INF 0x3f3f3f3f\nusing namespace std;\nint n,m,ans[N],Ans;\nunordered_map<int,int> mp[N];\nint get(int i,int j){\n\tif(mp[i].find(j)!=mp[i].end())return mp[i][j];\n\tprintf(\"? %d %d\\n\",i,j);\n\tfflush(stdout);int res;\n\tscanf(\"%d\",&res);mp[i][j]=res;\n\treturn res;\n}\nstruct node{\n\tint val;char opt;\n\tnode *lst,*nxt;\n\tnode(){val=opt=0;lst=nxt=NULL;}\n};\nstruct List{\n\tint len;\n\tnode *s,*e;\n\tList(){\n\t\tlen=0;\n\t\ts=new node();s->opt=1;\n\t\te=new node();e->opt=-1;\n\t\ts->nxt=e;e->lst=s;\n\t}\n\tvoid append(int x){\n\t\tnode *n=new node();n->val=x;\n\t\tnode *a=e->lst;\n\t\ta->nxt=n;n->lst=a;\n\t\tn->nxt=e;e->lst=n;\n\t\t++len;\n\t}\n\tList(const List &a){\n\t\tlen=0;\n\t\ts=new node();s->opt=1;\n\t\te=new node();e->opt=-1;\n\t\ts->nxt=e;e->lst=s;\n\t\tnode *n=a.s->nxt;\n\t\twhile(n->opt!=-1)append(n->val),n=n->nxt;\n\t}\n\tnode* del(node *n){\n\t\t--len;\n\t\tnode *a=n->lst,*b=n->nxt;\n\t\ta->nxt=b;b->lst=a;\n\t\tdelete(n);\n\t\treturn a;\n\t}\n};\nstruct submat{\n\tList r,c;\n}A;\nsubmat reduce(const submat&A){\n\tsubmat B;\n\tB.r=List(A.r);B.c=List(A.c);\n\tint n=A.r.len,m=A.c.len;\n\tif(n>=m)return B;\n\tnode *nr=B.r.s->nxt,*nc=B.c.s->nxt;\n\tint k=1;\n\twhile(n<m){\n\t\t//\u4e09\u79cd\u60c5\u51b5 \n\t\tif(get(nr->val,nc->val)>get(nr->val,nc->nxt->val)){\n\t\t\tnc=B.c.del(nc);--m;\n\t\t\tif(k>1){\n\t\t\t\t--k;\n\t\t\t\tnr=nr->lst;\n\t\t\t}else{\n\t\t\t\tnr=B.r.s->nxt,nc=B.c.s->nxt;\n\t\t\t}\n\t\t}else if(k==n){\n\t\t\tB.c.del(nc->nxt);--m;\n\t\t}else{\n\t\t\tk=k+1;\n\t\t\tnr=nr->nxt,nc=nc->nxt;\n\t\t}\n\t}\n\treturn B;\n}\nvoid SMAWK(submat A){\n\tint n=A.r.len,m=A.c.len;\n\tif(n==1){\n\t\tint x=A.r.s->nxt->val,minp=0,minv=INF;\n\t\tnode *nc=A.c.s->nxt;\n\t\twhile(nc->opt!=-1){\n\t\t\tif(get(x,nc->val)<minv)minp=nc->val,minv=get(x,nc->val);\n\t\t\tnc=nc->nxt;\n\t\t}\n\t\tans[x]=minp;Ans=min(minv,Ans);\n\t\treturn;\n\t}\n\tif(m==1){\n\t\tint y=A.c.s->nxt->val;\n\t\tnode *nr=A.r.s->nxt;\n\t\twhile(nr->opt!=-1){\n\t\t\tans[nr->val]=y;\n\t\t\tnr=nr->nxt;\n\t\t}\n\t\treturn;\n\t}\n\tsubmat B=reduce(A);\n\tsubmat C;\n\tC.c=List(B.c);\n\tnode *nr=B.r.s->nxt;bool o=0;\n\twhile(nr->opt!=-1){\n\t\tif(o)C.r.append(nr->val);\n\t\tnr=nr->nxt;\n\t\to^=1;\n\t}\n\tSMAWK(C);\n\tnr=B.r.s->nxt;o=0;\n\tnode *nc=B.c.s->nxt;\n\twhile(nr->opt!=-1){\n\t\tif(!o){\n\t\t\tint z=ans[nr->nxt->val],x=nr->val,minp=0,minv=INF;\n\t\t\tif(z==0)z=INF;\n\t\t\twhile(nc->opt!=-1&&nc->val<=z){\n\t\t\t\tif(get(x,nc->val)<minv)minp=nc->val,minv=get(x,nc->val);\n\t\t\t\tnc=nc->nxt;\n\t\t\t}\n\t\t\tif(nc->lst->val==z)nc=nc->lst;\n\t\t\tans[x]=minp;Ans=min(Ans,minv);\n\t\t}\n\t\tnr=nr->nxt;\n\t\to^=1;\n\t}\n}\nint main(){\n\tAns=INF;\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n;++i)A.r.append(i);\n\tfor(int i=1;i<=m;++i)A.c.append(i);//A\u4e3a\u6574\u4e2a\u77e9\u9635 \n\tSMAWK(A);\n\tprintf(\"! %d\\n\",Ans);\n\treturn 0;\n}\n```\n\n\n\n",
        "postTime": 1621496693,
        "uid": 68875,
        "name": "\u6ed1\u7a3d\u751f\u7269",
        "ccfLevel": 8,
        "title": "CF1423M \u9898\u89e3 | [\u6a21\u677f]SMAWK\u7b97\u6cd5"
    }
]
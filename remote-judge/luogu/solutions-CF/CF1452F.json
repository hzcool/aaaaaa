[
    {
        "content": "\u5206\u6790\u4e00\u4e0b\uff0c\u6211\u4eec\u4e00\u5171\u6709\u4e09\u79cd\u64cd\u4f5c\uff1a\n\n- $\\forall i\\in [0,x]$\uff0c\u64cd\u4f5c $2^i-1$ \u6b21\u5f97\u5230 $2^i$ \u4e2a $1$\u3002\n- $\\forall i\\in(x,n)$\uff0c\u64cd\u4f5c $2^{i-x}-1$ \u6b21\u5f97\u5230 $2^{i-x}$ \u4e2a $2^x$\u3002\n- $\\forall i\\in (x,n)$\uff0c\u64cd\u4f5c $X$ \u6b21\u5f97\u5230 $y$ \u4e2a $\\leq 2^x$ \u7684\u6570\uff0c$y\\in[2,2^{i-x}]$\n\n\u5bf9\u4e8e\u8fd9\u4e00\u7c7b\u6c42\u6700\u5c0f\u64cd\u4f5c\u6b21\u6570\u7684\u9898\uff0c\u53ef\u4ee5\u5148\u8003\u8651\u64cd\u4f5c\u5e26\u6765\u7684\u6536\u76ca\u548c\u64cd\u4f5c\u4ee3\u4ef7\u7684\u6bd4\u7387\u3002\u7b2c\u4e00\u4e2a\u64cd\u4f5c\u6bcf\u6b21\u589e\u52a0 $2^i-1$ \u4e2a $\\leq 2^x$ \u7684\u6570\uff0c\u6bd4\u7387\u4e3a $1$\uff0c\u7b2c\u4e09\u4e2a\u64cd\u4f5c\u6bd4\u7387\u4e0d\u8d85\u8fc7 $1$\uff0c\u800c\u7b2c\u4e8c\u4e2a\u64cd\u4f5c\u6bd4\u7387\u5927\u4e8e $1$\u3002\u6ce8\u610f\uff0c\u6211\u4eec\u4e0a\u8ff0\u63d0\u5230\u7684\u64cd\u4f5c\u4e8b\u5b9e\u4e0a\u662f\u4e00\u4e32\u5c06 $2^i$ \u5206\u4e3a $2^{i-1}$ \u7684\u7ec4\u5408\uff0c\u4e5f\u5c31\u662f\u8bf4\u64cd\u4f5c\u7684\u4ee3\u4ef7\u4e8b\u5b9e\u4e0a\u662f\u76f8\u540c\u7684\u3002\u6211\u4eec\u81ea\u7136\u8003\u8651\u5148\u5c3d\u53ef\u80fd\u9009\u62e9\u6bd4\u7387\u5927\u7684\u64cd\u4f5c\uff0c\u5373 $2$ \u64cd\u4f5c\u3002\n\n\u9009\u5b8c $2$ \u64cd\u4f5c\u4ee5\u540e\uff0c\u5982\u679c $\\leq 2^x$ \u7684\u6570\u4ecd\u7136\u5c0f\u4e8e $k$ \u4e2a\uff0c\u6211\u4eec\u5c31\u8981\u8003\u8651\u9009\u62e9 $1$ \u64cd\u4f5c\u6216\u8005 $3$ \u64cd\u4f5c\u3002\u8bb0\u6b64\u65f6\u8ddd $k$ \u4e2a $\\leq 2^x$ \u8fd9\u4e00\u6807\u51c6\u76f8\u5dee\u7684\u4e2a\u6570\u4e3a $now$\uff0c\u5373\u8fd8\u8981\u518d\u6709 $now$ \u4e2a $\\leq 2^x$ \u7684\u6570\u624d\u80fd\u8fbe\u5230\u81f3\u5c11 $k$ \u4e2a\u7684\u8981\u6c42\u3002\u6211\u4eec\u53d1\u73b0 $1$ \u64cd\u4f5c\u4e8b\u5b9e\u4e0a\u662f $3$ \u64cd\u4f5c\u7684\u7279\u6b8a\u60c5\u51b5\uff0c\u6240\u4ee5\u6211\u4eec\u5728 $now\\geq 2^{i-x}$ \u65f6\uff0c\u4e00\u5b9a\u4f1a\u9009\u7528 $1$ \u64cd\u4f5c\u3002\u73b0\u5728\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651 $now<2^{i-x}$ \u7684\u60c5\u51b5\u3002\n\n\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c \u6211\u4eec\u4e00\u5b9a\u4f7f\u7528 $3$ \u64cd\u4f5c\u548c\u4e00\u90e8\u5206 $1$ \u64cd\u4f5c\uff0c\u4f46\u662f $3$ \u64cd\u4f5c\u7684\u6b21\u6570\u6211\u4eec\u5c1a\u4e0d\u77e5\u9053\uff0c\u5e76\u4e14\u5728\u4f55\u65f6\u4f7f\u7528 $1$ \u64cd\u4f5c\u4e5f\u5c1a\u672a\u53ef\u77e5\uff0c\u4e0d\u59a8\u4f7f\u7528\u5206\u6cbb\u6765\u5904\u7406\u8fd9\u4e00\u90e8\u5206\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(nq)$\uff0c$n$ \u975e\u5e38\u5c0f\uff0c\u4e0d\u8d85\u8fc7 $30$\uff0c\u56e0\u6b64\u53ef\u4ee5\u628a $n$ \u770b\u4f5c\u5e38\u6570\u3002\n\n```cpp\n#include<cstdio>\n#define int ll\ntypedef long long ll;\nint n,a[35];\ninline int read() {\n\tregister int x=0,f=1;register char s=getchar();\n\twhile(s>'9'||s<'0') {if(s=='-') f=-1;s=getchar();}\n\twhile(s>='0'&&s<='9') {x=x*10+s-'0';s=getchar();}\n\treturn x*f;\n}\ninline int min(const int &x,const int &y) {return x<y? x:y;}\ninline int solve(int x,int k) {\n\tint enable_sum=0,big_sum=0,res=0,tmp=0,ans=1e15;\n\tfor(register int i=0;i<=x;++i) {enable_sum+=a[i]*((1ll<<i)-1); tmp+=a[i];}\n\tif(tmp>=k) return 0; //tmp<k \\to k>tmp\n\tk-=tmp; int cur=x+1;\n\twhile(cur<n) {\n\t\ttmp=(1ll<<(cur-x)); int need=min(k/tmp,a[cur]); \n\t\tk-=need*tmp; res+=need*(tmp-1); enable_sum+=need*tmp*((1ll<<x)-1);\n\t\tif(need<a[cur]) {break;}\n\t\t++cur;\n\t} \n\tif(k==0) return res;\n\tif(cur==n) {\n\t\tif(enable_sum>=k) return res+k;\n\t\telse return -1;\n\t}\n\t//\u4e4b\u524d\u9009\u5230\u67d0\u4e00\u4e2a cur \u505c\u4e0b\u6765\u4e0d\u9009\uff0c\u56e0\u4e3a\u4e0d\u4f18\u3002\n    \t//\u73b0\u5728\u8003\u8651\u628a\u8fd9\u4e2a 2^cur \u5206\u6389 \n\twhile(cur>x) {\n\t\tif(enable_sum>=k) {ans=min(ans,res+k);}\n\t\t++res; --cur; //Warning\n\t\ttmp=(1ll<<(cur-x));\n\t\tif(k>=tmp) {res+=tmp-1; k-=tmp; enable_sum+=tmp*((1ll<<x)-1);}\n\t}  \n\treturn min(res,ans); \n}\nsigned main() {\n\tn=read(); int Q=read();\n\tfor(register int i=0;i<n;++i) a[i]=read();  \n\twhile(Q--) {\n\t\tint op=read(),x=read(),y=read();\n\t\tif(op==1) {a[x]=y;}\n\t\telse {printf(\"%lld\\n\",solve(x,y));}\n\t}\n\treturn 0;\n} \n```\n\n",
        "postTime": 1606649192,
        "uid": 95244,
        "name": "tommymio",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF1452F \u3010Divide Powers\u3011"
    },
    {
        "content": "# CF1452F Divide Powers\n\n[\u9898\u76ee\u94fe\u63a5](https://codeforces.com/contest/1452/problem/F)\n\n> \u6ce8\uff1a$a$ \u5c31\u662f\u9898\u9762\u91cc\u7684 $cnt$\u3002\n\n\u9996\u5148\uff0c\u5f53 $k\\leq \\sum_{j=0}^{x}a_j$ \u65f6\u4e0d\u9700\u8981\u64cd\u4f5c\u3002\u4ee5\u4e0b\u53ea\u8ba8\u8bba $k > \\sum_{j=0}^{x}a_j$ \u7684\u60c5\u51b5\u3002\n\n\u8003\u8651\u6211\u4eec\u53ef\u4ee5\u600e\u4e48\u5229\u7528\u8fd9\u4e9b\u64cd\u4f5c\u3002\n\n1. \u628a $x$ \u540e\u9762\u7684\u4e1c\u897f\uff0c\u5b8c\u6574\u5730\u63a8\u5230 $x$ \u4f4d\u7f6e\u4e0a\u3002\u5bf9\u4e8e\u7b2c $i$ ($i>x$) \u4f4d\u800c\u8a00\uff0c\u9700\u8981 $2^{i-x}-1$ \u6b21\u64cd\u4f5c\uff0c\u53ef\u4ee5\u5f97\u5230 $2^{i-x}$ \u4e2a\u5143\u7d20\u3002\n2. \u628a\u524d $1\\dots x$ \u4e0a\u7684\u4e1c\u897f\uff0c\u5411\u524d\u63a8\u4e00\u4f4d\u3002\u6bcf\u63a8 $1$ \u6b21\uff0c\u53ef\u4ee5\u65b0\u589e $1$ \u4e2a\u5143\u7d20\u3002\n3. \u628a $x$ \u540e\u9762\u7684\u4e1c\u897f\uff0c\u4e0d\u5b8c\u6574\u5730\u63a8\u5230 $x$ \u4e0a\u3002\u4f8b\u5982\uff0c\u5728\u7b2c $i$ ($i>x$) \u4f4d\u4e0a\u6709\u4e00\u4e2a\u5143\u7d20\uff0c\u73b0\u5728\u6211\u4eec\u9700\u8981\u5728\u5c0f\u4e8e\u7b49\u4e8e $x$ \u7684\u4f4d\u7f6e\u4e0a\uff0c\u518d\u589e\u52a0 $k$ ($k<2^{i-x}$) \u4e2a\u5143\u7d20\u3002\u8fd9\u65f6\u5c31\u662f\u628a\u7b2c $i$ \u4f4d\u4e0a\u7684\u5143\u7d20\uff0c\u4e0d\u5b8c\u6574\u5730\u63a8\u5230 $x$ \u4e0a\u3002\u64cd\u4f5c\u6570\u4e3a\uff1a$\\sum_{j=x+1}^{i}\\lceil\\frac{k}{2^{j-x}}\\rceil$\u3002\u5e76\u4e14\u663e\u7136\uff0c$k\\leq \\sum_{j=x+1}^{i}\\lceil\\frac{k}{2^{j-x}}\\rceil < 2^{i-x}-1$\u3002\n\n\u663e\u7136\uff0c\u5c3d\u91cf\u4f18\u5148\u7528\u7b2c $1$ \u79cd\u64cd\u4f5c\u662f\u6700\u4f18\u7684\u3002\u56e0\u4e3a\u53ea\u6709\u5b83\u7684\u3010\u64cd\u4f5c\u6b21\u6570\u3011\u662f\u4e25\u683c\u5c0f\u4e8e\u3010\u589e\u52a0\u7684\u5143\u7d20\u6570\u91cf\u3011\u7684\u3002\n\n\u5e76\u4e14\uff0c\u6309\u7167 $i$ \u4ece\u5c0f\u5230\u5927\u4f7f\u7528\u7b2c $1$ \u79cd\u64cd\u4f5c\u4e3a\u6700\u4f18\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u4ece\u5c0f\u5230\u5927\u626b\u63cf\u6240\u6709 $i$\uff0c\u5bf9 $1$ \u64cd\u4f5c\u80fd\u7528\u5c31\u7528\uff1a\u6bcf\u4e2a $i$ \u7684\u7528\u91cf\u662f $\\min(a_i,\\lfloor\\frac{\\text{rest}}{2^{i-x}}\\rfloor)$\uff0c\u7136\u540e\u4ee4 $\\text{rest}$ \u51cf\u53bb\u8fd9\u4e2a\u7528\u91cf\uff0c\u8003\u8651 $i+1$\u3002$\\text{rest}$ \u521d\u59cb\u65f6\u7b49\u4e8e $k-\\sum_{j=0}^{x}a_j$\u3002\n\n> \u8bc1\u660e\uff1a\u8003\u8651\u4e00\u79cd\u65b9\u6848\uff0c\u4e0d\u662f\u6309 $i$ \u4ece\u5c0f\u5230\u5927\u6765\u4f7f\u7528\u7684\uff0c\u90a3\u4e48\u4e00\u5b9a\u5b58\u5728\u4e00\u4e2a\u8f83\u5c0f\u7684 $i_1$ \u53ef\u4ee5\u7528\u800c\u6ca1\u7528\uff0c\u5e76\u4e14\u6709\u53e6\u4e00\u4e2a\u8f83\u5927\u7684 $i_2$ \u88ab\u7528\u4e86\u3002\u73b0\u5728\u6211\u4eec\u628a\u90a3\u4e2a $i_1$ \u7528\u6389\u3002\u6b64\u65f6\u8981\u4e48 $i_2$ \u5c31\u4e0d\u9700\u8981\u62c6\u4e86\uff08\u64cd\u4f5c\u6b21\u6570\u51cf\u5c11\uff09\uff0c\u8981\u4e48 $i_2$ \u4ecd\u7136\u9700\u8981\u62c6\uff0c\u4f46\u62c6\u5b8c\u6b63\u597d\u628a\u7528\u6389\u7684 $i_1$ \u8865\u4e0a\uff08\u64cd\u4f5c\u6b21\u6570\u4e0d\u53d8\uff09\u3002\n\n\u73b0\u5728\u6211\u4eec\u5df2\u7ecf\u5c3d\u53ef\u80fd\u591a\u5730\u4f7f\u7528\u4e86\u7b2c $1$ \u79cd\u64cd\u4f5c\u3002\u5982\u679c\u5728 $x$ \u4f4d\u7f6e\u6070\u597d\u65b0\u589e\u4e86 $k-\\sum_{j=0}^{x}a_j$ \u4e2a\u5143\u7d20\uff0c\u90a3\u4e48\u7686\u5927\u6b22\u559c\uff0c\u76f4\u63a5\u8f93\u51fa\u64cd\u4f5c\u6b21\u6570\u3002\u5426\u5219\u8bb0\u8fd8\u9700\u8981\u589e\u52a0\u7684\u5143\u7d20\u6570\u91cf\u4e3a $\\text{rest}$\u3002\n\n\u6211\u4eec\u8003\u8651\u540e\u4e24\u79cd\u64cd\u4f5c\u3002\n\n\u7b2c $3$ \u79cd\u64cd\u4f5c\u7684\u3010\u64cd\u4f5c\u6b21\u6570\u3011\u5927\u4e8e\u7b49\u4e8e\u3010\u589e\u52a0\u7684\u5143\u7d20\u6570\u91cf\u3011\uff0c\u800c\u7b2c $2$ \u79cd\u64cd\u4f5c\u5219\u662f\u4e25\u683c\u7b49\u4e8e\u3002\u6240\u4ee5\u4f18\u5148\u8003\u8651\u7b2c $2$ \u79cd\u64cd\u4f5c\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u5728 $i$ ($1\\leq i\\leq x$) \u4f4d\u7f6e\u4e0a\u7684\u5143\u7d20\uff0c\u5b83\u53ef\u4ee5\u8fdb\u884c $2^i-1$ \u6b21\u7b2c $2$ \u79cd\u64cd\u4f5c\u3002\u8bbe\u603b\u5171\u53ef\u4ee5\u8fdb\u884c $\\text{tot}$ \u6b21\u7b2c $2$ \u79cd\u64cd\u4f5c\uff0c\u82e5 $\\text{tot}\\geq \\text{rest}$\uff0c\u5219\u76f4\u63a5\u505a $\\text{rest}$ \u6b21\u64cd\u4f5c\uff0c\u7136\u540e\u8f93\u51fa\u7b54\u6848\u3002\n\n\u5426\u5219\uff0c\u4e0d\u8bba\u505a\u4e0d\u505a\u7b2c $2$ \u79cd\u64cd\u4f5c\uff0c\u6211\u4eec\u5fc5\u987b\u7528\u7b2c $3$ \u79cd\u64cd\u4f5c\u628a\u81f3\u5c11 $1$ \u4e2a\u5143\u7d20\u63a8\u5230 $x$\u3002\u8fd9\u4e2a\u5143\u7d20\u539f\u6765\u7684\u4f4d\u7f6e\u663e\u7136\u662f\u8d8a\u5c0f\u8d8a\u597d\uff0c\u8bb0\u8fd9\u4e2a\u4f4d\u7f6e\u4e3a $i$\u3002\u6211\u4eec\u5148\u7528 $i-x$ \u6b21\u64cd\u4f5c\uff0c\u628a\u8fd9\u4e2a\u5143\u7d20\u63a8\u5230 $x$\u3002\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\uff0c\u63a5\u4e0b\u6765\u6bcf\u518d\u589e\u52a0\u4e00\u4e2a\u5143\u7d20\uff0c\u7528\u7b2c $2$ \u79cd\u64cd\u4f5c\u662f\u5426\u6bd4\u7528\u7b2c $3$ \u79cd\u64cd\u4f5c\u5212\u7b97\uff0c\u662f\u4e0d\u4e00\u5b9a\u7684\u3002\u4f8b\u5982\uff0c\u5982\u679c\u628a $2$ \u4e2a\u5143\u7d20\u63a8\u5230 $x$\uff0c\u6240\u82b1\u7684\u4ee3\u4ef7\u548c\u628a $1$ \u4e2a\u5143\u7d20\u63a8\u5230 $x$ \u662f\u4e00\u6837\u7684\u3002\u6b64\u65f6\u53ef\u4ee5\u8ba4\u4e3a\uff0c\u7b2c $2$ \u4e2a\u5143\u7d20\u65b0\u589e\u7684\u4ee3\u4ef7\u4e3a $0$\uff0c\u90a3\u663e\u7136\u6bd4\u7528\u7b2c $2$ \u79cd\u64cd\u4f5c\uff08\u4ee3\u4ef7\u4e3a $1$\uff09\u5212\u7b97\u3002\u6240\u4ee5\u6211\u4eec\u4ece $i$ \u5230 $x$\uff0c\u4e00\u4f4d\u4e00\u4f4d\u63a8\uff0c\u6bcf\u6b21\u63a8\u4e4b\u524d\u51b3\u7b56\u4e00\u4e0b\uff0c\u662f\u7528\u7b2c $3$ \u79cd\u64cd\u4f5c\u5212\u7b97\u8fd8\u662f\u7528\u7b2c $2$ \u79cd\u64cd\u4f5c\u5212\u7b97\u3002\u5177\u4f53\u53ef\u4ee5\u89c1\u4ee3\u7801\u3002\n\n\u53c2\u8003\u4ee3\u7801\uff1a\n\n```cpp\n// problem: CF1452F\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb push_back\n#define mk make_pair\n#define lob lower_bound\n#define upb upper_bound\n#define fi first\n#define se second\n#define SZ(x) ((int)(x).size())\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\n\ntemplate<typename T> inline void ckmax(T& x, T y) { x = (y > x ? y : x); }\ntemplate<typename T> inline void ckmin(T& x, T y) { x = (y < x ? y : x); }\n\nconst int MAXN = 30;\nint n, q;\nll a[MAXN], ta[MAXN];\nvoid solve(int x, ll K) {\n\tfor (int i = 0; i < n; ++i) ta[i] = a[i];\n\t\n\tll cnt_leq = 0;\n\tfor (int i = 0; i <= x; ++i) {\n\t\tcnt_leq += ta[i];\n\t}\n\tif (cnt_leq >= K) {\n\t\tcout << 0 << endl;\n\t\treturn;\n\t}\n\tll sum = cnt_leq;\n\tll cost = 0;\n\tfor (int i = x + 1; i < n; ++i) {\n\t\tll w = (1LL << (i - x));\n\t\tll buy = min(ta[i], (K - sum) / w);\n\t\tta[i] -= buy;\n\t\tta[x] += buy * w;\n\t\tsum += buy * w;\n\t\tcost += buy * ((1LL << (i - x)) - 1);\n\t}\n\tassert(sum <= K);\n\tll cansale = 0;\n\tfor (int i = 1; i <= x; ++i) {\n\t\tcansale += ta[i] * ((1LL << i) - 1);\n\t}\n\tif (sum + cansale >= K) {\n\t\tcost += K - sum;\n\t\tcout << cost << endl;\n\t\treturn;\n\t}\n\tfor (int i = x + 1; i < n; ++i) {\n\t\tll w = (1LL << (i - x));\n\t\tif (ta[i]) {\n\t\t\tassert(sum + w > K);\n\t\t\tfor (int j = i; j > x; --j) {\n\t\t\t\tll w = (1LL << (j - x));\n\t\t\t\tll push = (K - sum) / w + ((K - sum) % w != 0);\n\t\t\t\tif (x != 0 && push > 1 && (K - sum) % w != 0) {\n\t\t\t\t\tpush--;\n\t\t\t\t\tll r = (K - sum) % w;\n\t\t\t\t\tcost += r;\n\t\t\t\t\tsum += r;\n\t\t\t\t}\n\t\t\t\tcost += push;\n\t\t\t}\n\t\t\tcout << cost << endl;\n\t\t\treturn;\n\t\t}\n\t}\n\tcout << -1 << endl;\n}\nint main() {\n\tcin >> n >> q;\n\tfor (int i = 0; i < n; ++i) {\n\t\tcin >> a[i];\n\t}\n\tfor (int tq = 1; tq <= q; ++tq) {\n\t\tint op;\n\t\tcin >> op;\n\t\tif (op == 1) {\n\t\t\tint p;\n\t\t\tll v;\n\t\t\tcin >> p >> v;\n\t\t\ta[p] = v;\n\t\t} else {\n\t\t\tint x;\n\t\t\tll K;\n\t\t\tcin >> x >> K;\n\t\t\tsolve(x, K);\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1605959754,
        "uid": 100674,
        "name": "duyi",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1452F \u3010Divide Powers\u3011"
    }
]
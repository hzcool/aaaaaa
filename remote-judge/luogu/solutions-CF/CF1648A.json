[
    {
        "content": "## Description\n\n\u7ed9\u5b9a\u4e00\u4e2a $n \\times m$ \u7684\u6b63\u6574\u6570\u77e9\u9635\uff0c\u6c42\u8fd9\u4e2a\u77e9\u9635\u4e2d\u6240\u6709\u76f8\u540c\u6570\u5b57\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u4e4b\u548c\u7684\u548c\u3002$1 \u2264 n,m,n \\cdot m \u2264 10^5$\u3002\n\n## Solution\n\n\u4ee4\u5e8f\u5217 $x_{i,j}$\u3001$y_{i,j}$ \u5206\u522b\u8868\u793a\u7f16\u53f7\u4e3a $i$ \u7684\u6570\u5b57\u7b2c $j$ \u6b21\u51fa\u73b0\u7684\u884c\u6570\u4e0e\u5217\u6570\uff0c\u663e\u7136\u56e0\u4e3a\u8f93\u5165\u4ece\u4e0a\u81f3\u4e0b\uff0c\u884c\u6570\u662f\u975e\u5355\u8c03\u9012\u51cf\u7684\uff0c\u6240\u4ee5\u540c\u4e00\u4e2a\u6570\u5b57 $a$ \u7684\u884c\u6570\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u4e4b\u548c\u53ef\u4ee5\u8868\u793a\u4e3a \n$$\n\\sum_{i=1}^{n-1}\\sum_{j=i+1}^{n}x_{a,j}-x_{a,i}\n$$\n\u76f8\u5e94\u5730\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 `sort` \u5c06\u5217\u6570\u5e8f\u5217\u6392\u5e8f\u4e3a\u975e\u5355\u8c03\u9012\u51cf\u7684\uff0c\u6240\u4ee5\u5728\u6700\u7ec8\u540c\u4e00\u4e2a\u6570\u5b57\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u4e4b\u548c\u53ef\u4ee5\u8fd9\u6837\u8868\u793a\uff1a\n$$\n\\sum_{i=1}^{n-1}\\sum_{j=i+1}^{n}\\left(x_{a,j}-x_{a,i}\\right) + \\sum_{i=1}^{n-1}\\sum_{j=i+1}^{n}\\left(y_{a,j}-y_{a,i}\\right)\n$$\n\u6240\u4ee5\uff0c\u5f53\u5e8f\u5217 $x_{i,j}$\u3001$y_{i,j}$ \u5747\u975e\u5355\u8c03\u9012\u51cf\uff0c\u4ee4 $cnt$ \u8868\u793a\u603b\u5171\u51fa\u73b0\u7684\u6570\u5b57\u4e2a\u6570\uff0c\u6700\u7ec8\u7684\u7b54\u6848\u5373\u4e3a\uff1a\n$$\nans=\\sum^{cnt}_{a=1}\\left[\\sum_{i=1}^{n-1}\\sum_{j=i+1}^{n}\\left(x_{a,j}-x_{a,i}\\right) + \\sum_{i=1}^{n-1}\\sum_{j=i+1}^{n}\\left(y_{a,j}-y_{a,i}\\right)\\right]\n$$\n\n## Code\n\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<vector>\n#define int long long //\u8bb0\u5f97\u5f00 long long\n#define maxn 100005\nusing namespace std;\nint n, m, cnt[maxn];\nint ans;\nstruct node {\n    int x, y;\n    bool operator < (const node & a) const {\n        return a.y < y;\n    }\n};\nvector<node> v[maxn];\nsigned main() {\n    cin >> n >> m;\n    for(int i = 1, a; i <= n; ++ i) {\n        for(int j = 1; j <= m; ++ j) {\n            cin >> a; ++ cnt[a];\n            v[a].push_back((node){i, j});\n        }\n    }\n    for(int i = 1; i < maxn; ++ i) {\n        if(v[i].empty()) continue;\n        for(int j = cnt[i] - 1; j >= 0; -- j) {\n            ans -= (cnt[i] - j - 1) * v[i][j].x;\n            ans += j * v[i][j].x;\n        }\n        sort(v[i].begin(), v[i].end());\n        for(int j = 0; j < cnt[i]; ++ j) {\n            ans += (cnt[i] - j - 1) * v[i][j].y;\n            ans -= j * v[i][j].y;\n        }\n    }\n    cout << ans;\n    return 0;\n}\n```\n\n\n\n",
        "postTime": 1646989020,
        "uid": 305121,
        "name": "8atemak1r",
        "ccfLevel": 6,
        "title": "CF1648A \u9898\u89e3"
    },
    {
        "content": "# CF1648\u9898\u89e3\n\n**\u9898\u76ee\u4f20\u9001\u95e8\uff1a[CF1648A Weird Sum](https://www.luogu.com.cn/problem/CF1648A)**\n\n\u8fd9\u9053\u9898\u8981\u60f3\u66b4\u529b\u5f88\u7b80\u5355\uff0c\u679a\u4e3e\u6bcf\u4e00\u4e2a\u70b9\u5bf9\u5373\u53ef\uff0c\u4e0d\u8fc7\u590d\u6742\u5ea6\u8fc7\u4e0d\u53bb\u3002\n\n\u6211\u7528\u7684\u662f\u6743\u503c\u6811\u72b6\u6570\u7ec4\uff0c\u4ee5\u524d\u78b0\u5230\u8fc7\u7c7b\u4f3c\u7684\u3002\n\n\u56e0\u4e3a\u66fc\u54c8\u987f\u8ddd\u79bb\u662f $x$ \u8f74\u548c $y$ \u8f74\u7684\u7edd\u5bf9\u503c\uff0c\u6240\u4ee5\u4e0eUSACO\u4e00\u9053\u9898\u5f88\u50cf\uff0c\u5efa\u8bae\u53ef\u4ee5\u5148\u505a\u8fd9\u9053\u3002\n\n**[\u7c7b\u4f3c\u9898\u76ee](https://www.luogu.com.cn/problem/P5094)**\n\n\u5b58\u4e0b\u6bcf\u4e2a\u6570\u503c\u7684\u51fa\u73b0\u6b21\u6570\u4e0e\u603b\u548c\uff0c\u8fd9\u6837\u53ef\u4ee5\u66f4\u5feb\u7684\u7b97\u51fa\u8ddd\u79bb\u3002\n\n\n\u7ec6\u8282\u89c1\u4ee3\u7801\u3002\n\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<vector>\n#include<cstring>\nusing namespace std;\n#define ll long long\nint n, m;\nll c[100005][2] = {{0}};\nll d[100005][2] = {{0}};\nstruct Node{\n\tint x, y;\n};\nint lowbit(int x){\n\treturn x & -x;\n}\nvoid modify1(int i, int x, int t){\n\twhile(i <= 100000){\n\t\tc[i][t] += x;\n\t\ti += lowbit(i);\n\t}\n}\nll query1(int i, int t){\n\tll ans = 0;\n\twhile(i > 0){\n\t\tans += c[i][t];\n\t\ti -= lowbit(i);\n\t}\n\treturn ans;\n}\nvoid modify2(int i, int x, int t){\n\twhile(i <= 100000){\n\t\td[i][t] += x;\n\t\ti += lowbit(i);\n\t}\n}\nll query2(int i, int t){\n\tll ans = 0;\n\twhile(i > 0){\n\t\tans += d[i][t];\n\t\ti -= lowbit(i);\n\t}\n\treturn ans;\n}\nNode abc(int a, int b){\n\tNode tmp;\n\ttmp.x = a, tmp.y = b;\n\treturn tmp;\n}\nvector<Node> v[100005];\nbool f[100005] = {0};\nint main(){\n\tscanf(\"%d%d\", &n, &m);\n\tint maxn = 0, minn = 2e9;\n\tfor(int i = 1; i <= n; i++)\n\t\tfor(int j = 1; j <= m; j++){\n\t\t\tint x;\n\t\t\tscanf(\"%d\", &x);\n\t\t\tmaxn = max(x, maxn);\n\t\t\tminn = min(x, minn);\n\t\t//\tf[x] = true;\n\t\t\tv[x].push_back(abc(i, j));\n\t\t}\n\tll sum = 0;\n\tfor(int i = minn; i <= maxn; i++){\n\t\tif(v[i].size() <= 1)continue;\n\t\tll sx = 0, sy = 0;\n\t\tint fr = 0; \n\t\tfor(int j = 0; j < v[i].size(); j++){\n\t\t\tNode a = v[i][j];\n\t\t\tint x = a.x, y = a.y;\n\t\t\t//\u6bd4\u4ed6\u5c0f \n\t\t\tll cnt1x = query1(x, 1), sum1x = query2(x, 1);\n\t\t\t\n\t\t\tll cnt1y = query1(y, 2), sum1y = query2(y, 2);\n\t\t\t//\u6bd4\u4ed6\u5927\n\t\t\tll cnt2x = fr - cnt1x, sum2x = sx - sum1x;\n\t\t\t\n\t\t\tll cnt2y = fr - cnt1y, sum2y = sy - sum1y;\n\t\t\t//\u8ba1\u7b97 \n\t\t\tsum += (x * cnt1x - sum1x + sum2x - x * cnt2x);\n\t\t\t\n\t\t\tsum += (y * cnt1y - sum1y + sum2y - y * cnt2y);\n\t\t\t//\u4fee\u6539\n\t\t\tmodify1(x, 1, 1), modify1(y, 1, 2);\n\t\t\tmodify2(x, x, 1), modify2(y, y, 2); \n\t\t\t\n\t\t\tsx += x, sy += y;\n\t\t\tfr++;\n\t\t}\n\t\tfor(int j = 0; j < v[i].size(); j++){\n\t\t\tNode a = v[i][j];\n\t\t\tint x = a.x, y = a.y;\n\t\t\tmodify1(x, -1, 1), modify1(y, -1, 2);\n\t\t\tmodify2(x, -x, 1), modify2(y, -y, 2); \n\t\t}\n\t}\n\tcout << sum;\n\treturn 0;\n}\n```\n\n\n",
        "postTime": 1647356072,
        "uid": 529794,
        "name": "rlc202204",
        "ccfLevel": 6,
        "title": "CF1648A\u9898\u89e3"
    },
    {
        "content": "### \u9898\u610f\u7b80\u8ff0\n\n+ \u7ed9\u5b9a\u4e00\u4e2a\u5927\u5c0f\u4e3a $n\\times{m}$ \u7684\u684c\u5b50\uff0c$n$ \u884c $m$ \u5217\u3002\n+ \u6bcf\u4e2a\u4f4d\u7f6e\u90fd\u6709\u4e00\u4e2a\u989c\u8272\u70b9 $(i,j)$ \u7684\u989c\u8272\u4e3a $c_{ij}$\u3002\n+ \u4f60\u9700\u8981\u6c42\u51fa\u6bcf\u79cd\u989c\u8272\u6240\u5305\u542b\u7684\u70b9\u4e4b\u95f4\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u4e4b\u548c\u3002\u70b9 $(r_1,c_1),(r_2,c_2)$ \u4e4b\u95f4\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u662f $|r_1-r_2|+|c_1-c_2|$\u3002\n+ $1\\le{n}\\le{m},nm\\le{10^5},1\\le{c_{ij}}\\le10^5$ \u5e76\u4e14\u6240\u6709\u6570\u636e\u90fd\u662f\u6574\u6570\u3002\n\n### \u9898\u76ee\u5206\u6790\n\n\u9996\u5148\u53d1\u73b0\u989c\u8272\u7684\u8303\u56f4\u5e76\u4e0d\u662f\u7279\u522b\u5927\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5bf9\u6bcf\u4e2a\u989c\u8272\u5206\u522b\u8fdb\u884c\u8003\u8651\u3002\u63a8\u8350\u5148\u601d\u8003 [P6067[USACO05JAN]Moo Volume S](https://www.luogu.com.cn/problem/P6067) \u518d\u6765\u901a\u8fc7\u6b64\u9898\uff0c\u4f1a\u6709\u5f88\u5927\u5e2e\u52a9\u3002\n\n\u5f88\u5bb9\u6613\u60f3\u5230\u4e00\u79cd\u66b4\u529b\u7684\u505a\u6cd5\uff0c\u679a\u4e3e\u540c\u79cd\u989c\u8272\u7684\u70b9 $i,j$\uff0c\u628a\u7b54\u6848\u589e\u52a0 $\\dfrac{|r_i-r_j|+|c_i-c_j|}{2}$\u3002\n\n\u63a5\u7740\u8003\u8651\u4f18\u5316\uff0c\u6211\u4eec\u53d1\u73b0\u5bf9 $r,c$ \u5206\u5f00\u8fdb\u884c\u8ba1\u7b97\u662f\u4e0d\u4f1a\u5f71\u54cd\u7ed3\u679c\u7684\uff0c\u6240\u4ee5\u5bf9\u4e8e\u6bcf\u79cd\u989c\u8272\u7684 $r,c$ \u6211\u4eec\u90fd\u5148\u8fdb\u884c\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u3002\u7136\u540e\u679a\u4e3e $i,j(j<i)$\uff0c\u628a\u7b54\u6848\u589e\u52a0 $r_i-r_j$\uff08$c$ \u540c\u7406\uff09\u3002\u4f46\u662f\u8fd9\u6837\u53ea\u662f\u505a\u4e86\u4e00\u4e9b\u5e38\u6570\u4e0a\u7684\u4f18\u5316\uff0c\u4ecd\u7136\u4f1a\u8d85\u65f6\u3002\n\n\u7136\u540e\uff0c\u6211\u4eec\u53c8\u53d1\u73b0\uff0c\u5bf9\u4e8e $i$\uff0c\u5b83\u8d21\u732e\u7684\u7b54\u6848\u4e3a $r_i-r_1+r_i-r_2+\\cdots+r_i-r_{i-1}=r_i(i-1)-(r_1+r_2+...+r_{i-1})$\uff08$c$ \u540c\u7406\uff09\u3002\u4e8e\u662f\uff0c\u81ea\u7136\u800c\u7136\u5730\u60f3\u5230\u4e86\u7528\u524d\u7f00\u548c\u4f18\u5316\u3002\u7136\u540e\u5c31\u505a\u51fa\u6765\u4e86\u3002\n\n\n```cpp\narray<vector<long long>, 100001> a, b; //\u9632\u6b62\u7206\u7a7a\u95f4\uff0c\u4f7f\u7528 vector\u3002\n//\u540c\u65f6\u6ce8\u610f\u4e0d\u5f00 long long \u89c1\u7956\u5b97\u3002\nfor(int i = 1; i <= n; ++ i)\n    for(int j = 1; j <= m; ++ j)\n    {\n        cin >> c;\n        a[c].push_back(i); //\u8fd9\u9898\u4e0b\u6807\u5efa\u8bae\u4ece 0 \u5f00\u59cb\uff0c\u4f1a\u6709\u4e00\u4e9b\u5e2e\u52a9\u3002\n        b[c].push_back(j);\n    }\nfor(int i = 1; i < 100001; ++ i)\n{\n    sort(a[i].begin(), a[i].end());\n    sort(b[i].begin(), b[i].end());\n    partial_sum(a[i].begin(), a[i].end(), sum.begin()); //STL \u7684\u524d\u7f00\u548c\u51fd\u6570\u3002\n    for(int j = 1; j < a[i].size(); ++ j) //\u9632\u6b62 RE\uff0c\u7b2c\u4e00\u4e2a\u70b9\u6ca1\u6709\u8d21\u732e\u3002\n    {\n        ans += a[i][j] * j; //\u4e0b\u6807\u4ece 0 \u5f00\u59cb\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u51cf 1\u3002\n        ans -= sum[j - 1];\n    }\n    partial_sum(b[i].begin(), b[i].end(), sum.begin());\n    for(int j = 1; j < b[i].size(); ++ j)\n    {\n        ans += b[i][j] * j;\n        ans -= sum[j - 1];\n    }\n}\n```",
        "postTime": 1647010982,
        "uid": 366455,
        "name": "\u897f\u6e56\u6c34\u5996",
        "ccfLevel": 5,
        "title": "CF1648A Weird Sum \u9898\u89e3"
    },
    {
        "content": "### \u9898\u76ee\u7ffb\u8bd1\n\n\u4e00\u4e2a $n\\times m$ \u7684\u7f51\u683c\uff0c\u6bcf\u4e2a\u683c\u5b50\u91cc\u6709 $1$ \u4e2a\u6570\uff0c\u95ee\u5bf9\u4e8e\u6240\u6709\u76f8\u540c\u7684\u6570\uff0c\u66fc\u54c8\u987f\u8ddd\u79bb\u603b\u548c\u662f\u591a\u5c11\uff1f\n\n\u66fc\u54c8\u987f\u8ddd\u79bb\uff1a$a_{i_1,j_1}$ \u4e0e $a_{i_2,j_2}$ \u8ddd\u79bb\u4e3a $\\left|i_1-i_2\\right|+\\left|j_1-j_2\\right|$\u3002\n\n### \u9898\u76ee\u601d\u8def\n\n\u66b4\u529b\u641c\u4e00\u904d\uff0c\u80af\u5b9a\u6302\u6389\uff0c$n\\times m$ \u6709 $100000$\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u5bf9\u6bcf\u79cd\u6570\u8fdb\u884c\u5206\u7c7b\uff0c\u6bcf\u4e00\u7c7b\u518d\u5206\u6210 $x$ \u8f74\u7684\u603b\u8ddd\u79bb\u6c42\u548c\u52a0\u4e0a $y$ \u8f74\u7684\u603b\u8ddd\u79bb\u6c42\u548c\u3002\n\n\u8fd9\u662f\u849f\u84bb\u6211\u80fd\u60f3\u5230\u7684\u6700\u4f18\u89e3\u4e86\u3002\n\n### \u5206\u6790\u601d\u8def\n\n\u90a3\u4e48\u603b\u8ddd\u79bb\u6c42\u548c\u8be5\u600e\u4e48\u505a\u5462\uff0c\u4f8b\u5982\u4e0a\u6587\u7684 $x$ \u8f74\u7684\u603b\u8ddd\u79bb\u6c42\u548c\u3002\n\n\u6211\u4eec\u8003\u8651\u628a\u5b83\u4eec\u6392\u5e8f\uff0c\u653e\u5728\u4e00\u6839\u6570\u8f74\u4e0a\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/4x536hgp.png?x-oss-process=image/resize,m_lfit,h_170,w_225)\n\n\u6211\u4eec\u4ee5\u7aef\u70b9\u4e3a $i_2$ \u548c $i_3$ \u7684\u7ebf\u6bb5\u505a\u4f8b\u5b50\uff1a\n\n\u672c\u8eab\u957f\u5ea6 $2$\u3002\n\n\u5f80\u53f3\u8fb9\u8d70\uff0c\u6709 $i_3,i_4,i_5$\uff0c\u4ea7\u751f $3$ \u6b21\u8d21\u732e\u3002\n\n\u5de6\u8fb9\u6bcf\u4e2a\u70b9\u90fd\u53ef\u4ee5\u4e0e\u4e0a\u9762 $3$ \u4e2a\u70b9\u4ea7\u751f\u8fde\u63a5\uff0c\u5de6\u8fb9\u6709 $2$ \u4e2a\u70b9\uff0c$i_1$ \u548c $i_2$\u3002\n\n\u6ce8\u610f\uff0c\u7ebf\u6bb5\u7684\u4e24\u4e2a\u7aef\u70b9\u4e5f\u7b97\u8fdb\u53bb\u3002\n\n\u90a3\u4e48\u8fd9\u4e2a\u7ebf\u6bb5\u4ea7\u751f**\u5de6\u8fb9\u7aef\u70b9\u4e2a\u6570 $\\times$ \u7ebf\u6bb5\u957f\u5ea6 $\\times$ \u53f3\u8fb9\u7aef\u70b9\u4e2a\u6570**\u8fd9\u4e48\u591a\u8d21\u732e\u3002\n\n\u540c\u7406\uff0c\u6bcf\u4e2a\u7ebf\u6bb5\u4e5f\u4ea7\u751f\u4e0a\u8ff0\u8d21\u732e\u3002\n\n### AC \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nstruct node\n{\n\tint x,y;//\u8bb0\u5f55x\u8f74\u548cy\u8f74\n};\nvector<node>a[100020];//\u5bf9\u6570\u5b57\u5206\u7c7b\nll s(vector<int>a)//\u6c42\u548c\n{\n\tll sum=0;\n\tfor(int i=1;i<a.size();i++)\n\t{\n\t\tsum+=i*(a[i]-a[i-1])*(a.size()-i);\n\t}\n\treturn sum;\n}\nvoid solve()\n{\n\tint n,m,maxx=INT_MIN;\n\tcin>>n>>m;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=m;j++)\n\t\t{\n\t\t\tint z;\n\t\t\tcin>>z;\n\t\t\tnode zz;\n\t\t\tzz.x=i;\n\t\t\tzz.y=j;\n\t\t\ta[z].push_back(zz);//\u63d2\u5165\u8fd9\u4e2a\u70b9\u4fe1\u606f\n\t\t\tmaxx=max(z,maxx);//\u627e\u51fa\u6700\u5927\u503c\n\t\t}\n\t}\n\tll sum=0;\n\tfor(int i=1;i<=maxx;i++)\n\t{\n\t\tvector<int>xx;//\u8bb0\u5f55x\u8f74\n\t\tvector<int>yy;//\u8bb0\u5f55y\u8f74\n\t\tfor(auto j:a[i])//\u63d2\u5165\u70b9\u7684\u4fe1\u606f\n\t\t{\n\t\t\txx.push_back(j.x);\n\t\t\tyy.push_back(j.y);\n\t\t}\n        //\u6392\u5e8f\n\t\tsort(xx.begin(),xx.end());\n\t\tsort(yy.begin(),yy.end());\n\t\tll sx=s(xx);\n\t\tll sy=s(yy);\n\t\tsum+=sx+sy;//\u6c42\u548c\n\t}\n\tcout<<sum<<endl;\n}\nint main()\n{\n\tint t=1;\n\twhile(t--)\n\t{\n\t\tsolve();\n\t}\n    return 0;\n}\n```",
        "postTime": 1646921441,
        "uid": 516346,
        "name": "_YXJS_",
        "ccfLevel": 4,
        "title": "CF1648A"
    },
    {
        "content": "## \u601d\u8def\n\n\u8003\u8651\u6211\u4eec\u5c06\u884c\u8ddd\u79bb\u548c\u5217\u8ddd\u79bb\u5206\u5f00\u8003\u8651\uff0c\u9996\u5148\u6211\u4eec\u5148\u8003\u8651\u884c\uff08\u4ee5\u884c\u4e3a\u4f8b\uff09\uff0c\u5c06\u6bcf\u79cd\u989c\u8272\u5206\u9694\u51fa\u6765\u5206\u522b\u653e\u7f6e\u4e8e\u82e5\u5e72\u5411\u91cf\u4e2d\uff0c\u5bf9\u4ed6\u4eec\u8fdb\u884c\u6392\u5e8f\uff0c\u7136\u540e\u4f7f\u7528\u524d\u7f00\u548c\uff0c\u8bb0\u5f55\u8fd9\u79cd\u989c\u8272\u5230\u73b0\u5728\u4e3a\u6b62\u6240\u6709\u70b9\u7684\u6a2a\u5750\u6807\u4e4b\u548c $tot$ \u4e0e\u524d\u9762\u70b9\u7684\u6570\u91cf $cnt$\uff0c\u6bcf\u6b21\u770b\u5230\u4e00\u4e2a\u70b9\uff0c\u4ed6\u7684\u8d21\u732e\u503c\u4e3a $x\\times cnt-tot$\uff0c\u5c06\u8fd9\u4e2a\u503c\u52a0\u5165 $ans$\uff0c\u5217\u540c\u7406\uff0c\u6700\u540e\u8f93\u51fa\u5373\u53ef\u3002\u590d\u6742\u5ea6 $O(nm\\log nm)$\uff0c\u5373\u53ef\u901a\u8fc7\u6b64\u9898\u3002\n\n## Code\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nvector<int> r[100005],c[100005];\nsigned main(){\n\tint n,m;\n\tcin>>n>>m;\n\tint ans=0,a[n+1][m+1];\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=m;j++){\n\t\t\tcin>>a[i][j];\n\t\t\tr[a[i][j]].push_back(i);\n\t\t\tc[a[i][j]].push_back(j);\n\t\t}\n\t}\n\tfor(int i=1;i<=100000;i++){\n\t\tsort(r[i].begin(),r[i].end());\n\t\tint tot=0,cnt=0;\n\t\tfor(auto j:r[i]){\n\t\t\tans+=(j*cnt-tot);\n\t\t\ttot+=j;\n\t\t\tcnt++;\n\t\t}\n\t}\n\tfor(int i=1;i<=100000;i++){\n\t\tsort(c[i].begin(),c[i].end());\n\t\tint tot=0,cnt=0;\n\t\tfor(auto j:c[i]){\n\t\t\tans+=(j*cnt-tot);\n\t\t\ttot+=j;\n\t\t\tcnt++;\n\t\t}\n\t}\n\tcout<<ans;\n}\n```",
        "postTime": 1646560242,
        "uid": 116664,
        "name": "Daniel_lele",
        "ccfLevel": 8,
        "title": "CF1648A\u9898\u89e3"
    },
    {
        "content": "# A. Weird Sum\n\n> \u7ed9\u51fa\u4e24\u4e2a\u6574\u6570 $n,m$\uff0c\u548c\u4e00\u4e2a $n \\times m$ \u7684\u77e9\u9635\u3002\u82e5\u8be5\u77e9\u9635\u4e2d\u4e24\u5143\u7d20\u76f8\u540c\uff0c$sum$ \u5c31\u52a0\u4e0a\u5b83\u4eec\u6240\u5728\u4f4d\u7f6e\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u3002\u6c42 $sum$ \u7684\u503c\u3002\n> \n>  $1 \\leq n \\le m, n \\cdot m \\leq 100000$ \n\n## \u601d\u8def\n\n\u9996\u5148\u7ed9\u51fa\u66fc\u54c8\u987f\u8ddd\u79bb\u7684\u5b9a\u4e49\u5f0f\uff1a\n\n$$\ndis_{i,j} = |x_i - x_j| + |y_i - y_j|\n$$\n\n\u662f\u4e24\u4e2a\u7edd\u5bf9\u503c\u7684\u52a0\u548c\uff0c\u800c\u9898\u76ee\u4e2d\u6240\u8ba9\u6211\u4eec\u6c42\u7684\u540c\u79cd\u989c\u8272\u7684\u4e24\u4e24\u4e4b\u95f4\u66fc\u54c8\u987f\u8ddd\u79bb\uff0c\u53ef\u4ee5\u8868\u793a\u4e3a\u5982\u4e0b\u5f0f\uff1a\n\n$$\n\\sum\\limits_{col_{x_i,y_i} = k} \\sum\\limits_{col_{x_j,y_j} = k,i\\not ={j}} |x_i - x_j| + |y_i - y_j| \n$$\n\n\u663e\u7136\uff0c\u6211\u4eec\u53ef\u4ee5\u628a $x,y$ \u62c6\u5f00\u6765\u8ba1\u7b97\uff0c\u4ee5\u4e0b\u5148\u8003\u8651 $x$ \u7684\u90e8\u5206\u5982\u4f55\u8ba1\u7b97\uff0c$y$ \u7684\u90e8\u5206\u540c\u7406\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u628a $x_i$ \u8fdb\u884c\u6392\u5e8f\uff0c\u8bb0\u5f53\u524d\u989c\u8272\u6709 $p$ \u4e2a\u70b9\uff0c\u90a3\u4e48 $x$ \u90e8\u5206\u7684\u8d21\u732e\u53ef\u4ee5\u5982\u4e0b\u8868\u793a\n\n$$\n\\begin{aligned}\n    &\\sum\\limits_{i =1}^p \\sum\\limits_{j = 1}^{i-1} |x_j - x_i| \\\\\n    = &\\sum\\limits_{i =1}^p \\sum\\limits_{j = 1}^{i-1} x_i - x_j\\\\\n    = &\\sum\\limits_{i =1}^p (i-1)\\times x_i - \\sum\\limits_{j = 1}^{i-1} x_j\n\\end{aligned}\n$$\n\n\u663e\u7136\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u91cc\u7684 $(i-1)\\times x_i$ \u6211\u4eec\u53ef\u4ee5\u5728 $\\mathcal{O}(1)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u7b97\u51fa\uff0c\u800c $\\sum\\limits_{j = 1}^{i-1} x_j$ \u53ef\u4ee5\u5728\u4e00\u4e2a\u7ef4\u62a4\u524d\u7f00\u548c\u7684\u8fc7\u7a0b\u4e2d\u7b97\u51fa\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}(p)$.\n\n\u5bf9\u6bcf\u79cd\u989c\u8272\u505a\u4e00\u904d\u4e0a\u9762\u7684\u8ba1\u7b97\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}(\\sum p ) = \\mathcal{O}(n\\times m)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002$y$ \u7684\u8ba1\u7b97\u540c\u7406\uff0c\u6b64\u5904\u4e0d\u518d\u8d58\u8ff0\u3002\n\n## \u4ee3\u7801\n\n```cpp\nconst int N = 1e5 + 10;\n\nint n,m;\nvector <int> c1[N],c2[N];\n\nvoid solve() {\n    for (int i = 1;i <= 100000;++i) c1[i].clear(),c2[i].clear();\n    read(n,m);\n    for (int i = 0;i < n;++i) {\n        for (int j = 0;j < m;++j) {\n            int col;read(col);\n            c1[col].push_back(i);\n            c2[col].push_back(j);\n        }\n    }\n    int ans = 0;\n    for (int i = 1;i <= 100000;++i) {\n        if (c1[i].empty()) continue;\n        sort(c1[i].begin(),c1[i].end());\n        int pre = 0;\n        for (int j = 0;j < c1[i].size();++j) {\n            ans += j * c1[i][j] - pre;\n            pre += c1[i][j];\n        }\n    }\n    for (int i = 1;i <= 100000;++i) {\n        if (c2[i].empty()) continue;\n        sort(c2[i].begin(),c2[i].end());\n        int pre = 0;\n        for (int j = 0;j < c2[i].size();++j) {\n            ans += j * c2[i][j] - pre;\n            pre += c2[i][j];\n        }\n    }\n\n    printf(\"%lld\\n\",ans);\n}\n\nsigned main() {\n    solve();\n\treturn 0;\n}\n```",
        "postTime": 1655518517,
        "uid": 105230,
        "name": "Retired_Doubeecat",
        "ccfLevel": 6,
        "title": "CF1648A"
    },
    {
        "content": "## \u9898\u610f\n\u7ed9\u5b9a\u4e00\u4e2a\u77e9\u9635\u7684\u6bcf\u4e2a\u65b9\u683c\u7684\u989c\u8272\uff0c\u6c42\u51fa\u6bcf\u4e2a\u989c\u8272\u4e24\u4e24\u95f4\u7684\u8ddd\u79bb\u4e4b\u548c\u3002\n\n## \u89e3\u6cd5\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u989c\u8272\uff0c\u53ef\u4ee5\u5355\u72ec\u8003\u8651\uff0c\u5219\u4e24\u4e24\u95f4\u8ddd\u79bb\u4e4b\u548c\u4e3a\uff1a\n$$\n\\sum_{i=1}^k\\sum_{j=i}^k(|x_i-x_j|+|y_i-y_j|)\n$$\n\u663e\u7136\uff0c$x,y$ \u53ef\u4ee5\u5355\u72ec\u8003\u8651\u3002\u90a3\u4e48\uff0c\u5c31\u662f\u6c42\n$$\n\\sum_{i=1}^k\\sum_{j=i}^k|a_i-a_j|\n$$\n\u8003\u8651\u8fd9\u4e2a\u5f0f\u5b50\u4e2d\u6bcf\u4e2a $a_i$ \u7684\u8d21\u732e\u3002$a_i$ \u8d8a\u5927\uff0c\u90a3\u4e48\u8d77\u5230\u52a0\u7684\u8d21\u732e\u5c31\u8d8a\u5927\uff0c\u8d77\u5230\u51cf\u7684\u8d21\u732e\u8d8a\u5c0f\u3002\u90a3\u4e48\uff0c\u53ef\u4ee5\u5bf9 $a_i$ \u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u7136\u540e\u6c42\u4e0b\u5217\u5f0f\u5b50\uff1a\n$$\n\\sum_{i=1}^ki\\times a_i-(k-i+1)\\times a_i\n$$\n\u8fd9\u5c31\u5b8c\u6210\u4e86\u3002\n```cpp\n#include<ctime>\n#include<cctype>\n#include<cstdio>\n#include<vector>\n#include<algorithm>\n#define ll long long\nusing namespace std;\nconst int N=1e5+7;\nll read(){\n\tchar c;\n\tll x=0,f=1;\n\twhile(!isdigit(c=getchar()))\n\t\tf-=2*(c=='-');\n\twhile(isdigit(c)){\n\t\tx=x*10+f*(c^48);\n\t\tc=getchar();\n\t}\n\treturn x;\n}\nint n,m,c,mx;\nvector<int>a[N],b[N];\nll sum;\nint main(){\n\tn=read();\n\tm=read();\n\tfor(int i=1;i<=n;++i)\n\tfor(int j=1;j<=m;++j){\n\t\tc=read();\n\t\tif(mx<c)\n\t\t\tmx=c;//\u6c42\u51fa\u6700\u5927\u7684\u989c\u8272\u7f16\u53f7\n\t\ta[c].push_back(i);\n\t\tb[c].push_back(j);\n\t}\n\tfor(int i=1;i<=mx;++i){\n\t\tsort(a[i].begin(),a[i].end());//\u5bf9x,y\u5206\u522b\u6392\u5e8f\u5373\u53ef\n\t\tsort(b[i].begin(),b[i].end());\n\t\tll cnt;\n\t\tcnt=0;\n\t\tfor(auto x:a[i]){\n\t\t\t++cnt;\n\t\t\tsum+=x*cnt;\n\t\t}\n\t\tcnt=0;\n\t\tfor(auto y:b[i]){\n\t\t\t++cnt;\n\t\t\tsum+=y*cnt;\n\t\t}\n\t\treverse(a[i].begin(),a[i].end());//\u6211\u8fd9\u91cc\u7528\u7684\u662f\u7ffb\u8f6c\n\t\treverse(b[i].begin(),b[i].end());\n\t\tcnt=0;\n\t\tfor(auto x:a[i]){\n\t\t\t++cnt;\n\t\t\tsum-=x*cnt;\n\t\t}\n\t\tcnt=0;\n\t\tfor(auto y:b[i]){\n\t\t\t++cnt;\n\t\t\tsum-=y*cnt;\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",sum);\n\treturn 0;\n}\n```",
        "postTime": 1646985270,
        "uid": 181378,
        "name": "Alarm5854",
        "ccfLevel": 7,
        "title": "CF1648A\u9898\u89e3"
    },
    {
        "content": "### \u601d\u8def\n\n\u9996\u5148\u8003\u8651\u6309\u989c\u8272\u5206\u5f00\u5904\u7406\uff0c\u5bf9\u4e8e\u540c\u4e00\u4e2a\u989c\u8272\uff0c\u53d1\u73b0 $|x_i-x_j|+|y_i-y_j|$ \u7684 $x$ \u90e8\u5206\u548c $y$ \u90e8\u5206\u662f\u76f8\u4e92\u72ec\u7acb\u7684\uff0c\u53ef\u4ee5\u5206\u5f00\u5904\u7406\uff0c\u8f6c\u5316\u4e3a\u5982\u4f55\u6c42\u89e3\u4e00\u4e2a\u5e8f\u5217\u4e2d\u4e24\u4e24\u6570\u5b57\u4e4b\u5dee\u7684\u7edd\u5bf9\u503c\u4e4b\u548c\uff0c\u7531\u4e8e\u7edd\u5bf9\u503c\u4e0d\u5bb9\u6613\u76f4\u63a5\u5904\u7406\uff0c\u6240\u4ee5\u76f4\u63a5\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\u8fd9\u4e2a\u5e8f\u5217\uff0c\u5dee\u5c31\u4e0d\u4f1a\u4ea7\u751f\u8d1f\u6570\uff0c\u8003\u8651\u5230 $x_i$ \u4f5c\u4e3a\u88ab\u51cf\u6570\u4f1a\u8d21\u732e $n-i$ \u6b21\uff0c\u5e76\u51cf\u53bb\u4e00\u4e2a\u540e\u7f00\u548c\uff0c\u9884\u5904\u7406\u5373\u53ef\uff0c\u5c06\u6bcf\u4e00\u4e2a\u989c\u8272\u7684\u7b54\u6848\u76f8\u52a0\u5c31\u662f\u603b\u548c\u3002\u6b64\u9898\u51fa\u9898\u4eba\u7ed9\u7684\u662f $n\\times m $ \u7684\u6570\u636e\u8303\u56f4\uff0c\u6240\u4ee5\u9700\u8981\u52a8\u6001\u5f00\u7a7a\u95f4\u3002\n\n### \u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint n,m;\nvector<int>mp[100005];\nvector<int>x[100005],y[100005];\nint t[100005],top=0,q[100005],g[100005],f[100005];\nint tot=0;\nint cmp(int a,int b)\n{\n\treturn a>b;\n}\nsigned main()\n{\n\tint n,m;cin>>n>>m;\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tfor(int j=1;j<=m;j++)\n\t\t{\n\t\t\tint k;cin>>k;\n\t\t\tt[++top]=k;\n\t\t\tq[top]=k;\n\t\t}\n\t}\n\tsort(q+1,q+top+1);\n\tint k=unique(q+1,q+top+1)-q-1;\n\tfor(int i=1;i<=top;i++)\n\t{\n\t\tt[i]=lower_bound(q+1,q+k+1,t[i])-q;\n\t}\n\tint now=0;\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tfor(int j=0;j<m;j++)\n\t\t{\n\t\t\tmp[i].push_back(t[++now]);\n\t\t\ttot=max(tot,t[now]);\n\t\t\tx[mp[i][j]].push_back(i);\n\t\t\ty[mp[i][j]].push_back(j);\n\t\t}\n\t}\n\tint ans=0;\n\tfor(int i=1;i<=tot;i++)\n\t{\n\t\tsort(x[i].begin(),x[i].end(),cmp);\n\t\tsort(y[i].begin(),y[i].end(),cmp);\n\t\t// for(int j=0;j<x[i].size();j++)\n\t\t// {\n\t\t// \tcout<<x[i][j]<<\" \";\n\t\t// }\n\t\t// puts(\"\");\n\t\t// for(int j=0;j<y[i].size();j++)\n\t\t// {\n\t\t// \tcout<<y[i][j]<<\" \";\n\t\t// }\n\t\t// puts(\"\");\n\t\tg[0]=x[i][0],f[0]=y[i][0];\n\t\tfor(int j=1;j<x[i].size();j++)\n\t\t{\n\t\t\tg[j]=g[j-1]+x[i][j];\n\t\t}\n\t\tfor(int j=1;j<y[i].size();j++)\n\t\t{\n\t\t\tf[j]=f[j-1]+y[i][j];\n\t\t}\n\t\tfor(int j=0;j<x[i].size();j++)\n\t\t{\n\t\t\tans+=(x[i].size()-j-1)*x[i][j]-(g[x[i].size()-1]-g[j]);\n\t\t}\n\t\tfor(int j=0;j<y[i].size();j++)\n\t\t{\n\t\t\tans+=(y[i].size()-j-1)*y[i][j]-(f[y[i].size()-1]-f[j]);\n\t\t}\n\t}\n\tcout<<ans<<\"\\n\";\n\tsystem(\"pause > null\");\n}//\n```",
        "postTime": 1646916773,
        "uid": 413777,
        "name": "npqenqpve",
        "ccfLevel": 0,
        "title": "CF1648A"
    }
]
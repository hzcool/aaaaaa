[
    {
        "content": "## \u9898\u610f\n\n\u7ed9\u4e00\u68f5\u6811\uff0c\u8282\u70b9\u4e2a\u6570\u4e3a $n$\uff08$1 \\le n \\le 2 \\times 10^5$\uff09\uff0c\u6709 $q$\uff08$1 \\le q \\le 5$\uff09\u6b21\u8be2\u95ee\uff0c\u6bcf\u4e00\u6b21\u7ed9\u51fa\u4e00\u4e2a\u8282\u70b9\u96c6\u5408\uff08\u6ee1\u8db3\u8282\u70b9\u96c6\u5408\u5927\u5c0f\u603b\u548c $\\le 2 \\times 10^5$\uff09\uff0c\u5224\u65ad\u662f\u5426\u6709\u4e00\u6761\u8def\u5f84\uff0c\u7ecf\u8fc7\u4e86\u96c6\u5408\u91cc\u6240\u6709\u7684\u8282\u70b9\uff08\u53ef\u4ee5\u7ecf\u8fc7\u975e\u96c6\u5408\u91cc\u7684\u8282\u70b9\uff09\u3002\n\n## \u601d\u8def\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u5b58\u5728\u6ee1\u8db3\u6761\u4ef6\u7684\u8def\u5f84\uff0c\u5219\u4e00\u5b9a\u6709\u4e00\u6761\u6ee1\u8db3\u6761\u4ef6\u7684\u8def\u5f84\u7684\u8d77\u70b9\u4e3a\u6700\u6df1\u7684\u70b9\uff08\u8bb0\u4e3a $ax1$\uff09\u3002\u56e0\u4e3a\u4e00\u6761\u6ee1\u8db3\u6761\u4ef6\u7684\u8def\u5f84\u5fc5\u7136\u7ecf\u8fc7 $ax1$\uff0c\u800c\u5982\u679c\u8fd9\u6761\u8def\u5f84\u7ee7\u7eed\u5f80\u4e0b\u4f38\u5c55\uff0c\u4e0b\u9762\u6ca1\u6709\u96c6\u5408\u91cc\u7684\u70b9\u4e86\uff08\u56e0\u4e3a $ax1$ \u6700\u6df1\uff09\uff0c\u5219\u53ef\u4ee5\u780d\u6389\u4e0b\u9762\u7684\u8def\u5f84\uff0c\u53d8\u6210\u8d77\u70b9\u4e3a $ax1$ \u7684\u8def\u5f84\u3002\n\n\u8bbe\u96c6\u5408\u4e2d\u4e0d\u662f $ax1$ \u7684\u7956\u5148\u4e2d\u7684\u70b9\u6700\u6df1\u7684\u70b9 $ax2$\u3002\u540c\u7406\u53ef\u5f97\uff1a\u5982\u679c\u5b58\u5728\u6ee1\u8db3\u6761\u4ef6\u7684\u8def\u5f84\uff0c\u5219\u4e00\u5b9a\u6709\u4e00\u6761\u6ee1\u8db3\u6761\u4ef6\u7684\u8def\u5f84\u7684\u7ec8\u70b9\u4e3a $ax2$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u6c42\u51fa\u6765 $ax1,ax2$ \u540e\uff0c\u53ea\u9700\u8981\u5224\u65ad $ax1 \\to ax2$ \u8fd9\u6761\u8def\u5f84\u662f\u5426\u8986\u76d6\u96c6\u5408\u4e2d\u6240\u6709\u70b9\u5373\u53ef\u3002\n\n\u4e00\u4e9b\u7ec6\u8282\u7684\u5b9e\u73b0\uff1a\n\n* \u5982\u679c\u4e0d\u5b58\u5728 $ax2$\uff0c\u5219\u96c6\u5408\u4e2d\u6240\u6709\u70b9\u5747\u4e3a $ax1$ \u7684\u7956\u5148\u6216\u8005\u5176\u81ea\u5df1\uff0c$ax1 \\to root$ \u8fd9\u6761\u8def\u5f84\u5373\u6ee1\u8db3\u4e86\uff0c\u8f93\u51fa `YES`\u3002\n\n* \u5224\u65ad\u4e00\u4e2a\u70b9\u662f\u5426\u4e3a\u53e6\u4e00\u4e2a\u70b9\u7684\u7956\u5148\u65f6\uff0c\u53ef\u4ee5\u6c42\u51fa\u5b83\u4eec\u7684\u6df1\u5ea6\u4e4b\u5dee\uff0c\u7136\u540e\u901a\u8fc7\u500d\u589e\u5c06\u66f4\u6df1\u7684\u70b9\u8df3\u4e0a\u53bb\uff0c\u770b\u662f\u5426\u662f\u4e00\u4e2a\u70b9\u3002\n\n* \u56e0\u4e3a\u8be2\u95ee\u6b21\u6570\u5c11\uff0c\u6240\u4ee5\u5224\u65ad $ax1 \\to ax2$ \u662f\u5426\u8986\u76d6\u96c6\u5408\u4e2d\u6240\u6709\u70b9\u65f6\u53ef\u4ee5\u76f4\u63a5\u66b4\u529b\u8df3\u3002\n\n## \u53c2\u8003\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\nint n,q;\n\nint tot=0,var[400010],nxt[400010],head[200010];\n\nvoid add(int u,int v)\n{\n\tvar[++tot]=v;\n\tnxt[tot]=head[u];\n\thead[u]=tot;\n}\n\nint dep[200010],fa[200010][20];\n\nvoid dfs(int u,int fat)\n{\n\tdep[u]=dep[fat]+1;\n\tfa[u][0]=fat;\n\tfor(int i=1; i<=19; ++i) fa[u][i]=fa[fa[u][i-1]][i-1];\n\tfor(int i=head[u]; i; i=nxt[i])\n\t{\n\t\tint v=var[i];\n\t\tif(v==fat) continue;\n\t\tdfs(v,u);\n\t}\n}\n\nint qs[200010];\n\nbool cmp(int x,int y)\n{\n\treturn dep[x]>dep[y];\n}\n\nbool is_fa(int u,int v) // u \u662f\u5426\u662f v \u7684\u7956\u5148\n{\n\tint cj=dep[v]-dep[u];\n\tfor(int i=0; i<=19; ++i)\n\t{\n\t\tif(cj>>i&1) v=fa[v][i];\n\t}\n\treturn u==v;\n}\n\nbool vis[200010];\n\nint main()\n{\n\tios::sync_with_stdio(false),cin.tie(0);\n\tint u,v,k;\n\tcin>>n;\n\tfor(int i=1; i<=n-1; ++i)\n\t{\n\t\tcin>>u>>v;\n\t\tadd(u,v),add(v,u);\n\t}\n\tdfs(1,0);\n\tcin>>q;\n\twhile(q--)\n\t{\n\t\tcin>>k;\n\t\tfor(int i=1; i<=k; ++i)\n\t\t{\n\t\t\tcin>>qs[i];\n\t\t}\n\t\tsort(qs+1,qs+k+1,cmp);\n\t\tint ax1=qs[1],ax2=0;\n\t\tfor(int i=2; i<k; ++i)\n\t\t{\n\t\t\tif(!is_fa(qs[i],ax1))\n\t\t\t{\n\t\t\t\tax2=qs[i];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(!ax2)\n\t\t{\n\t\t\tputs(\"Yes\");\n\t\t\tcontinue;\n\t\t}\n\t\tmemset(vis,0,sizeof(vis));\n\t\tint nowx=ax1,nowy=ax2;\n\t\twhile(nowx!=nowy)\n\t\t{\n\t\t\tif(dep[nowx]<dep[nowy]) swap(nowx,nowy);\n\t\t\tvis[nowx]=1,nowx=fa[nowx][0];\n\t\t}\n\t\tvis[nowx]=1;\n\t\tbool flag=1;\n\t\tfor(int i=1; i<=k; ++i)\n\t\t{\n\t\t\tif(!vis[qs[i]])\n\t\t\t{\n\t\t\t\tflag=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tputs(flag?\"Yes\":\"No\");\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1657878830,
        "uid": 353688,
        "name": "\u738b\u7199\u6587",
        "ccfLevel": 0,
        "title": "CF1702G1 \u9898\u89e3"
    },
    {
        "content": "### Update\n\n2022.7.13 \u52a0\u5165\u4e86\u5b9e\u73b0\u65b9\u6cd5\n\n\u62ff\u5230\u9898\u76ee\uff0c\u56e0\u4e3a\u8981\u4e00\u6b21\u8d70\u5b8c\uff0c\u6240\u4ee5\u6240\u6709\u7684\u70b9\u5728\u540c\u4e00\u6761\u94fe\u4e0a\u3002\n\n\u770b\u5230 $q$ \u5f88\u5c0f\uff0c\u6240\u4ee5\u8003\u8651 $O(qn)$ \u7684\u641c\u7d22\u3002\n\n\u6ce8\u610f\u4e0d\u80fd\u4ece\u4e2d\u95f4\u5f00\u59cb\u641c\uff0c\u6240\u4ee5\u8003\u8651\u4ece\u6df1\u5ea6\u6700\u5927\u7684\u5f00\u59cb\uff0c\u56e0\u4e3a\u5b83\u4e0b\u9762\u6ca1\u6709\u70b9\uff0c\u6240\u4ee5\u5b83\u4e00\u5b9a\u662f\u94fe\u7684\u7aef\u70b9\uff0c\u7136\u540e\u5c31\u662f\u4e00\u4e2a\u666e\u901a\u7684 `dfs`\u3002\n\n\u53ef\u4ee5\u4f7f\u7528\u4e00\u4e2a\u6811\u5f62 dp \u6c42\u51fa\u6bcf\u4e2a\u8282\u70b9\u7684\u6df1\u5ea6\uff0c\u7136\u540e\u4ece\u6df1\u5ea6\u6700\u5927\u7684\u8282\u70b9\u641c\u7d22\uff0c\u5982\u679c\u5f97\u5230\u4e86\u4e00\u6761\u94fe\uff0c\u5c31\u662f `YES`\uff1b\u5426\u5219\u5c31\u662f `NO`\u3002",
        "postTime": 1657594683,
        "uid": 556362,
        "name": "UnnamedOrNamed",
        "ccfLevel": 5,
        "title": "CF1702G1 Passable Paths (easy version) \u9898\u89e3"
    },
    {
        "content": "## \u524d\u8a00\n\n\u5982\u4f55\u8bc4\u4ef7\u6211\u505a G1 \u7ed3\u679c\u505a\u51fa\u6765\u7684\u89e3\u6cd5 G2 \u4e5f\u80fd\u8fc7\u3002\u3002\u3002\n\n## \u9898\u76ee\u63cf\u8ff0\n\n\u7ed9\u5b9a\u4e00\u68f5\u6811\uff0c\u95ee\u662f\u5426\u80fd\u901a\u8fc7\u4e00\u6761\u7b80\u5355\u8def\u5f84\uff08\u5373\u5728\u6811\u4e0a\u627e\u4e00\u6761\u8def\u5f84\u4e14\u4e0d\u91cd\u590d\u8d70\u4e00\u6761\u8fb9\uff09\uff0c\u4f7f\u5176\u7ecf\u8fc7\u7ed9\u5b9a\u70b9\u96c6\u4e2d\u7684\u6240\u6709\u70b9\u3002\n\n## \u5206\u6790\n\n\u663e\u7136\u8981\u5148\u8f6c\u5316\u4e3a\u6709\u6839\u6811\uff0c\u4e0d\u59a8\u4ee5 $1$ \u505a\u6839\uff0c\u7136\u540e\u904d\u5386\u6811\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u5bf9\u4e8e\u6811\u4e0a\u7684\u4e00\u6761\u7b80\u5355\u8def\u5f84\uff0c\u8bbe\u5176\u5de6\u53f3\u7aef\u70b9\u4e3a $x,y$\uff0c\u8fd9\u4e24\u4e2a\u7aef\u70b9\u7684\u6700\u8fd1\u516c\u5171\u7956\u5148\u4e3a $f$\uff0c\u5219\u5b83\u80af\u5b9a\u7531 $p(x,f)$ \u4e0e $p(f,y)$ \u62fc\u63a5\u800c\u6210\uff0c\u5176\u4e2d $p$ \u8868\u793a\u4e24\u70b9\u95f4\u7684\u6700\u77ed\u8def\u5f84\uff0c\u6b64\u5904\u7684\u8def\u5f84\u4e0a\u7684\u70b9\u90fd\u662f\u6df1\u5ea6\u9012\u589e\u7684\u3002\u4e0d\u7406\u89e3\u53ef\u4ee5\u770b\u56fe\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/n5cn1sym.png)\n\n\u90a3\u4e48\uff0c\u5982\u4f55\u627e\u5230\u5bf9\u5e94\u7684 $x,y$ \u5462\uff1f\u5176\u5b9e\u4e5f\u4e0d\u96be\uff0c\u56e0\u4e3a\u663e\u7136 $x,y$ \u4e2d\u6709\u4e00\u4e2a\u662f\u6574\u6761\u94fe\u7684\u6df1\u5ea6\u6700\u5927\u7684\u70b9\uff0c\u4e0d\u59a8\u8bbe $x$ \u66f4\u6df1\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u8981\u5728\u70b9\u96c6\u4e2d\u627e\u5230\u9664\u4e86 $x$ \u7684\u7956\u5148\u4ee5\u5916\u7684\u6df1\u5ea6\u6700\u5927\u7684\u70b9\uff0c\u5b83\u5c31\u662f $y$\u3002\u6211\u4eec\u53ef\u4ee5\u5c06\u70b9\u96c6\u6309\u6df1\u5ea6\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\uff0c\u7136\u540e\u904d\u5386\u5373\u53ef\u3002\n\n\u663e\u7136\u5982\u679c\u4e0d\u5b58\u5728 $y$\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u5c31\u662f\u4e00\u6761\u5782\u76f4\u7684\u94fe\uff0c\u90a3\u4e48\u662f\u5408\u6cd5\u7684\uff0c\u7279\u5224\u8f93\u51fa\u3002\n\n\u800c\u4e00\u4e2a\u70b9\u60f3\u8981\u5728\u94fe\u4e0a\u7684\u5145\u8981\u6761\u4ef6\u5b83\u662f $x,y$ \u4e2d\u4e00\u4e2a\u7684\u7956\u5148\u4e14\u6df1\u5ea6 $\\le f$ \u7684\u6df1\u5ea6\u3002\u540e\u8005\u6211\u4eec\u53ea\u8981\u9650\u5236\u6df1\u5ea6\u6700\u5927\u7684\u70b9\uff0c\u5224\u65ad\u5b83\u662f\u5426\u6ee1\u8db3\u5373\u53ef\u3002\u524d\u8005\u4ee5\u53ca\u524d\u6587\u4e2d\u63d0\u5230\u7684\u7956\u5148\u5224\u65ad\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u6c42\u4e24\u70b9\u7684 lca \u5224\u65ad\u662f\u5426\u662f\u5b83\u672c\u8eab\u3002\n\nlca \u53ef\u4ee5\u7528\u6811\u5256\u5b9e\u73b0\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n## AC Code\n```\n#include<bits/stdc++.h>\n#define maxn 1000001\nusing namespace std;\nint n,m,cnt,q,a[maxn],sz[maxn],top[maxn],hson[maxn],dep[maxn],f[maxn];\nint head[maxn];\nbool vis[maxn];\nstruct edge{\n\tint nxt,to;\n}e[maxn];\nint cmp(int x,int y){return dep[x]>dep[y];}//\u6df1\u5ea6\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\nvoid add(int u,int v){\n\te[++cnt].to=v;\n\te[cnt].nxt=head[u];\n\thead[u]=cnt;\n}\nvoid dfs(int x,int fa,int _dep){\n\tint maxx=0;\n\tf[x]=fa;\n\tsz[x]=1;\n\tdep[x]=_dep;\n\tfor(int i=head[x];i;i=e[i].nxt){\n\t\tint v=e[i].to;\n\t\tif(v!=fa){\n\t\t\tdfs(v,x,_dep+1);\n\t\t\tsz[x]+=sz[v];\n\t\t\tif(sz[v]>maxx)\n\t\t\t maxx=sz[v],hson[x]=v;\n\t\t}\n\t}//\u8bb0\u5f55\u6df1\u5ea6\u548c\u91cd\u513f\u5b50\u7b49\u4fe1\u606f\n}\nvoid dfss(int x,int fa){\n\tfor(int i=head[x];i;i=e[i].nxt){\n\t\tint v=e[i].to;\n\t\tif(v!=fa&&!top[v]){\n\t\t\tif(hson[x]==v) top[v]=top[x];\n\t\t\telse top[v]=v;\n\t\t\tdfss(v,x);\n\t\t}\n\t}//\u6811\u5256\n}\nint lca(int x,int y){\n\tif(!x||!y) return -1;//\u4e0d\u77e5\u9053\u6709\u6ca1\u6709\u7528\u7684\u7279\u5224\n\twhile(top[x]!=top[y]){\n\t\tif(dep[top[x]]>dep[top[y]]) x=f[top[x]];\n\t\telse y=f[top[y]];\n\t}\n\treturn (dep[x]>dep[y]?y:x);\n}\nvoid solve(){\n\tint x=1,y=0;\n\tscanf(\"%d\",&m);\n\tfor(int i=1;i<=m;i++) scanf(\"%d\",&a[i]);\n\tif(m==2) return void(puts(\"YES\"));//\u7279\u5224\u4e24\u70b9\uff0c\u5fc5\u7136\u6210\u7acb\n\tsort(a+1,a+m+1,cmp);//\u6392\u5e8f\n\tfor(int i=2;i<=m;i++)\n\t if(lca(a[x],a[i])!=a[i]){\n\t \ty=i;//\u8bb0\u5f55\u53e6\u4e00\u4e2a\u7aef\u70b9\n\t \tbreak;\n\t }\n\tif(!y) return void(puts(\"YES\"));//\u7279\u5224\n\tif(dep[a[m]]<dep[lca(a[x],a[y])]) return void(puts(\"NO\"));//\u7279\u5224\u6700\u9ad8\u70b9\n\tfor(int i=1;i<=m;i++)\n\t if(lca(a[i],a[x])!=a[i]&&lca(a[i],a[y])!=a[i])//\u662f\u5426\u4e3a\u7956\u5148\n\t  return void(puts(\"NO\"));\n\tputs(\"YES\");\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<n;i++){\n\t\tint u,v;\n\t\tscanf(\"%d%d\",&u,&v);\n\t\tadd(u,v),add(v,u);\n\t}\n\tcnt=0,dfs(1,0,1);\n\ttop[1]=1,dfss(1,0);//\u6811\u5256\u6c42\u89e3lca\u677f\u5b50\n\tscanf(\"%d\",&q);\n\twhile(q--) solve();\n\treturn 0;\n}\n```",
        "postTime": 1681121449,
        "uid": 310639,
        "name": "yingkeqian9217",
        "ccfLevel": 5,
        "title": "CF1702G1"
    },
    {
        "content": "\u601d\u8def\uff1a\n\n\u5982\u679c\u5b58\u5728\u7b54\u6848,\u5219\u6df1\u5ea6\u6700\u6df1\u7684\u70b9\u4e00\u5b9a\u4e3a\u4e00\u4e2a\u7aef\u70b9,\u53e6\u4e00\u4e2a\u7aef\u70b9\u5219\u4e3a\u4e0e\u8be5\u70b9\u8ddd\u79bb\u6700\u8fdc\u7684\u70b9,\u6240\u4ee5\u5148\u627e\u5230\u4e24\u4e2a\u7aef\u70b9,\u4e4b\u540e\u5728\u5224\u65ad\u5176\u4ed6\u70b9\u662f\u5426\u5728\u4e24\u70b9\u7684\u7b80\u5355\u8def\u5f84\u5373\u53ef\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ninline int read(){\n\tchar ch=getchar();int s=0,f=1;\n\twhile((ch<'0'||ch>'9')&&ch!='-') ch=getchar();\n\tif(ch=='-') ch=getchar(),f=-1;\n\twhile(ch>='0'&&ch<='9') s=s*10+ch-'0',ch=getchar();\n\treturn f*s;\n}\nint n,q,a[200010],dep[200010],f[200010][21];\nvector<int>e[200010];\nvoid dfs(int now,int fa){\n\tdep[now]=dep[fa]+1;\n\tf[now][0]=fa;\n\tfor(int i=0;i<e[now].size();i++)\n\t\tif(e[now][i]!=fa)\n\t\t\tdfs(e[now][i],now);\n}\nint lca(int x,int y){//\u500d\u589e\u6c42lca\n\tif(dep[x]<dep[y])\n\t\tswap(x,y);\n\tfor(int i=20;i>=0;i--)\n\t\tif(dep[f[x][i]]>=dep[y])\n\t\t\tx=f[x][i];\n\tif(x==y)\n\t\treturn x;\n\tfor(int i=20;i>=0;i--)\n\t\tif(f[x][i]!=f[y][i])\n\t\t\tx=f[x][i],y=f[y][i];\n\treturn f[x][0]; \n}\nint main(){\n\tn=read();\n\tfor(int i=1;i<n;i++){\n\t\tint u=read(),v=read();\n\t\te[u].push_back(v);\n\t\te[v].push_back(u);\n\t}\n\tdfs(1,0);\n\tfor(int j=1;j<=20;j++)\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tf[i][j]=f[f[i][j-1]][j-1];\n\tq=read();\n\twhile(q--){\n\t\tmemset(a,0,sizeof(a));\n\t\tint m=read();\n\t\tfor(int i=1;i<=m;i++)\n\t\t\ta[i]=read();\n\t\tint x=0,maxnx=-1e9,y=0,maxny=-1e9;\n\t\tfor(int i=1;i<=m;i++)\n\t\t\tif(dep[a[i]]>maxnx) maxnx=dep[a[i]],x=a[i];//\u53d6\u6df1\u5ea6\u6700\u6df1\u7684\u70b9\n\t\tfor(int i=1;i<=m;i++)\n\t\t\tif(dep[x]+dep[a[i]]-2*dep[lca(x,a[i])]+1>maxny&&a[i]!=x) maxny=dep[x]+dep[a[i]]-2*dep[lca(x,a[i])]+1,y=a[i];//\u53d6\u79bb\u6df1\u5ea6\u6700\u6df1\u7684\u70b9\u6700\u8fdc\u7684\u70b9\n\t\tbool flag=0;\n\t\tfor(int i=1;i<=m;i++){\n\t\t\tif(a[i]==x||a[i]==y||lca(x,y)==a[i]||(lca(lca(x,y),a[i])==lca(x,y)&&lca(a[i],x)==a[i])||(lca(lca(x,y),a[i])==lca(x,y)&&lca(a[i],y)==a[i]))//\u5728\u4e24\u70b9\u8def\u5f84\u4e0a\n\t\t\t\tcontinue;\n\t\t\tflag=1;//\u4e0d\u5728\n\t\t\tbreak;\n\t\t}\n\t\tcout<<(flag?\"NO\":\"YES\")<<endl;\n\t}\n}\n```",
        "postTime": 1660392308,
        "uid": 304534,
        "name": "qnqfff",
        "ccfLevel": 6,
        "title": "CF1702G1 Passable Paths (easy version)"
    }
]
[
    {
        "content": "\u9996\u5148\u6709\u4e2a\u5f88\u663e\u7136\u7684\u7ed3\u8bba\n\n\u82e5$(l, r)$\u6ee1\u8db3\u6761\u4ef6\uff0c\u90a3\u4e48$(l, r + 1), (l, r + 2)\u2026\u2026(l, n)$\u90fd\u6ee1\u8db3\u6761\u4ef6\n\n\u7c7b\u4f3c\u5c3a\u53d6\u6cd5\n\n\u6211\u4eec\u8003\u8651\u6bcf\u4e00\u4e2a$l$\uff0c\u53ea\u9700\u8981\u627e\u5230\u6700\u5c0f\u7684\u4e00\u4e2a\u6ee1\u8db3\u6761\u4ef6\u7684$r$\u7edf\u8ba1\u7b54\u6848$ans += n - r + 1$\u5373\u53ef\n\n\u663e\u7136\u5bf9\u4e8e$1 <= l <= n$\uff0c$r$\u662f\u5355\u8c03\u4e0d\u51cf\u7684\n\n\u56e0\u4e3a\u6570\u5b57\u8d8a\u591a\u9006\u5e8f\u5bf9\u4e5f\u4f1a\u591a\n\n\u7136\u540e\u6211\u4eec\u8003\u8651\u5982\u4f55\u8f6c\u79fb$l$\u548c$r$\n\n\u5bf9\u4e8e\u4e00\u4e2a$a_l$,\u589e\u52a0\u7684\u9006\u5e8f\u5bf9\u4e2a\u6570\u5c31\u662f\u524d\u9762$[1, l - 1]$\u6bd4\u5b83\u5927\u7684\u548c\u540e\u9762[r, n]\u6bd4\u5b83\u5c0f\u7684\n\n\u5bf9\u4e8e\u4e00\u4e2a$a_r$,\u51cf\u5c11\u7684\u9006\u5e8f\u5bf9\u4e2a\u6570\u5c31\u662f\u524d\u9762$[1, l]$\u6bd4\u5b83\u5927\u7684\u548c\u540e\u9762$[r + 1, n]$\u6bd4\u5b83\u5c0f\u7684\n\n\u6ce8\u610f\u8981\u5148\u79bb\u6563\u5316\n\n```cpp\nconst int N = 1e5 + 10;\n\nint n, k, now, ans;\nint a[N], lsh[N], qaq;\n\nstruct node\n{\n\tint num;\n\tint tree[N];\n\tinline void add(int x, int val)\n\t{\n\t\tnum += val;\n\t\tfor(; x <= 100000; x += x & -x) tree[x] += val; \n\t}\n\tinline int ask(int x)\n\t{\n\t\tint res = 0;\n\t\tfor(; x; x -= x & -x) res += tree[x];\n\t\treturn res;\n\t}\n}t1, t2;\n\nsigned main()\n{\n\tinto();\n\tread(n); read(k);\n    //\u79bb\u6563\u5316\n\tfor(R int i = 1; i <= n; i++) read(a[i]), lsh[i] = a[i];\n\tsort(lsh + 1, lsh + n + 1);\n\tqaq = unique(lsh + 1, lsh + n + 1) - lsh - 1;\n\tfor(R int i = 1; i <= n; i++) a[i] = lower_bound(lsh + 1, lsh + qaq + 1, a[i]) - lsh;\n    //\u5148\u5904\u7406r\uff0c\u7edf\u8ba1\u4e00\u5f00\u59cb\u7684\u9006\u5e8f\u5bf9\u6570\n\tfor(R int i = 1; i <= n; i++)\n\t{\n\t\tnow += t2.num - t2.ask(a[i]);\n\t\tt2.add(a[i], 1);\n\t}\n    \n\tR int l, r = 1;\n\tfor(l = 1; l < n && r <= n; l++)\n\t{\n\t\tif(l == r)//l == r\u4e0d\u5408\u6cd5\n\t\t{\n\t\t\tnow -= t1.num - t1.ask(a[r]);\n\t\t\tnow -= t2.ask(a[r] - 1);\n\t\t\tt2.add(a[r], -1);\n\t\t\tr++;\n\t\t}\n\t\tnow += t1.num - t1.ask(a[l]);\n\t\tnow += t2.ask(a[l] - 1);\n\t\tt1.add(a[l], 1);\n\t\twhile(now > k && r <= n)\n\t\t{\n\t\t\tnow -= t1.num - t1.ask(a[r]);\n\t\t\tnow -= t2.ask(a[r] - 1);\n\t\t\tt2.add(a[r], -1);\n\t\t\tr++;\n\t\t}\n\t\tans += (n - r + 1);\n\t}\n\twriteln(ans);\n\treturn 0;\n}\n```",
        "postTime": 1605220531,
        "uid": 103023,
        "name": "AvA_sleeper",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF220E \u3010Little Elephant and Inversions\u3011"
    },
    {
        "content": "\u7b80\u8981\u9898\u610f\uff1a\u6c42\u6709\u591a\u5c11\u5bf9 $(l,r)$ \u6ee1\u8db3 $a_1,a_2,\\cdots,a_l,a_r,a_{r+1},\\cdots,a_n$ \u7684\u9006\u5e8f\u5bf9\u4e0d\u8d85\u8fc7 $k$ \u4e2a\uff0c$n\\le 10^5$\u3002\n\n\u53d1\u73b0\u5982\u679c $(l,r)$ \u6ee1\u8db3\u6761\u4ef6\uff0c\u5982\u679c $x\\le l,r\\le y$\uff0c\u90a3\u4e48 $(x,y)$ \u4e00\u5b9a\u6ee1\u8db3\u6761\u4ef6\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u627e\u51fa\u5bf9\u4e8e\u56fa\u5b9a\u7684 $l$\uff0c\u7b26\u5408\u6761\u4ef6\u6700\u5c0f\u7684 $r$ \u5728\u54ea\u91cc\u5c31\u53ef\u4ee5\u3002\n\n\u8fd9\u4e0d\u5c31\u662f\u53cc\u6307\u9488\u561b\u3002\u3002\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53cc\u6307\u9488\u626b\u4e00\u904d\uff0c\u628a $a_1,a_2,\\cdots,a_l$ \u5f00\u4e00\u4e2a\u6811\u72b6\u6570\u7ec4\uff0c\u518d\u5bf9 $,a_r,a_{r+1},\\cdots,a_n$ \u5f00\u4e00\u4e2a\u6811\u72b6\u6570\u7ec4\uff1b\u8fd9\u6837\u5c31\u53ef\u4ee5\u5feb\u901f\u77e5\u9053\u63d2\u5165/\u5220\u9664\u4e00\u4e2a\u6570\u5bf9\u4e8e\u9006\u5e8f\u5bf9\u6570\u7684\u8d21\u732e\u4e86\u3002\n\n\u53cc\u6307\u9488\uff0c$O(n\\log n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int NR=1e5+10;\n#define int long long\nint n,k,a[NR],v[NR],len,ans;\n\nstruct BIT{\n\tint c[NR];\n\tvoid init(){\n\t\tmemset(c,0,sizeof(c));\n\t}\n\tint lowbit(int x){\n\t\treturn x&(-x);\n\t}\n\tvoid add(int x,int y){\n\t\twhile(x<=len){\n\t\t\tc[x]+=y;\n\t\t\tx+=lowbit(x);\n\t\t}\n\t}\n\tint sum(int x){\n\t\tint res=0;\n\t\twhile(x){\n\t\t\tres+=c[x];\n\t\t\tx-=lowbit(x);\n\t\t}\n\t\treturn res;\n\t}\n\tint calc(int l,int r){return sum(r)-sum(l-1);}\n}T1,T2;\n\t\n\nsigned main(){\n\tcin>>n>>k;\n\tfor(int i=1;i<=n;i++)\n\t\tscanf(\"%lld\",&a[i]),v[++len]=a[i];\n\tsort(v+1,v+1+len);\n\tlen=unique(v+1,v+1+len)-v-1;\n\tfor(int i=1;i<=n;i++)a[i]=lower_bound(v+1,v+1+len,a[i])-v;\n\tint now=1,cnt=0;\n\tfor(int i=1;i<=n;i++)cnt+=T2.calc(a[i]+1,len),T2.add(a[i],1);\n\tfor(int i=1;i<=n;i++){\n\t\tcnt+=T1.calc(a[i]+1,len)+T2.calc(1,a[i]-1);\n\t\tT1.add(a[i],1);\n\t\twhile(now<=i||(cnt>k&&now<=n))cnt-=T1.calc(a[now]+1,len)+T2.calc(1,a[now]-1),T2.add(a[now],-1),now++;\n\t\tans+=n-now+1;\n\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1655022153,
        "uid": 117771,
        "name": "intel_core",
        "ccfLevel": 7,
        "title": "CF220E \u9898\u89e3"
    },
    {
        "content": "\u524d\u7f6e\u77e5\u8bc6\uff1a\n\n\u6811\u72b6\u6570\u7ec4\n\n\u79bb\u6563\u5316\n\n\u6700\u597d\u4f1a\u6811\u72b6\u6570\u7ec4\u6c42\u9006\u5e8f\u5bf9\n\n------------\n\n\u9996\u5148\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u7b26\u5408\u6761\u4ef6\u7684\uff08l\uff0cr\uff09\uff1a\n\n\t\t\uff08l\uff0cr+1\uff09\uff0c\uff08l\uff0cr+2\uff09...\u90fd\u7b26\u5408\u6761\u4ef6\u3002\n        \n\t\t\t\uff08\u6570\u8d8a\u5c11\uff0c\u9006\u5e8f\u5bf9\u8d8a\u5c11\n        \n\u56e0\u6b64\uff0c\u53ea\u9700\u5bf9\u6bcf\u4e2a l \uff0c\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u6700\u5c0f\u7684 r \u3002\n\n\u7136\u800c\u8fd8\u53ef\u53d1\u73b0\uff0c\u968f\u7740 l \u7684\u53f3\u79fb\uff0c\u6700\u5c0f\u7684 r \u4e5f\u4f1a\u53f3\u79fb\uff01\n\uff08two-pointer? !\uff09\n\n\u8fd9\u6837\u53ea\u9700\u6c42\u79fb\u52a8 l \u548c r \u65f6\u9006\u5e8f\u5bf9\u7684\u53d8\u5316\uff01\n\n------------\n\nl \u6bcf\u5411\u53f3\u6269\u5c55\uff0c\u9006\u5e8f\u5bf9\u6570\u91cf\u589e\u957f \n\na[ 1 ~ l-1]\u4e2d\u5927\u4e8ea[ l ]\u7684\u5143\u7d20\u7684\u6570\u91cf\uff0ca[r~n]\u4e2d\u5c0f\u4e8ea[ l ]\u7684\u5143\u7d20\u7684\u6570\u91cf\n\nr \u6bcf\u5411\u53f3\u6269\u5c55\uff0c\u9006\u5e8f\u5bf9\u6570\u91cf\u51cf\u5c11 \n\na[ 1 ~ l-1]\u4e2d\u5927\u4e8ea[ r ]\u7684\u5143\u7d20\u7684\u6570\u91cf\uff0ca[r~n]\u4e2d\u5c0f\u4e8ea[ r ]\u7684\u5143\u7d20\u7684\u6570\u91cf\n\n\u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u3002\n\n------------\n\n\u505a\u6cd5\u662f\uff1a\n\u5148\u5c06\u6570\u7ec4\u79bb\u6563\u5316\uff0c\u5bf9\u4e8e[ 1 , l ]\u7ef4\u62a4\u6811\u72b6\u6570\u7ec4S\uff0c\n\n\u5bf9\u4e8e[ r , n ]\u7ef4\u62a4\u6811\u72b6\u6570\u7ec4T\uff0c\n\nS[i]\u8868\u793aa[ 1 , l ]\u4e2d\u7b49\u4e8ei\u7684\u6570\u7684\u6570\u91cf\uff08a\u8868\u793a\u79bb\u6563\u5316\u540e\u6570\u7ec4\uff09\n\nT[i]\u8868\u793aa[ r , n ]\u4e2d\u7b49\u4e8ei\u7684\u6570\u7684\u6570\u91cf\uff08a\u8868\u793a\u79bb\u6563\u5316\u540e\u6570\u7ec4\uff09\n\n\u79fb\u52a8 l \u548c r \u3002\n\n------------\n\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<algorithm>\nusing namespace std;\n#define N 500050\n#define lowbit(i) ((i)&(-(i)))\nstruct TreeArray{\n\tint tree[N],n;\n\tinline void add(int a,int b)\n\t\t{for(;a<N;a+=lowbit(a))tree[a]+=b;}\n\tinline int sum(int l,int r){\n\t\tif(l>r)return 0;\n\t\tint res=0;l--;\n\t\twhile(r>l)res+=tree[r],r-=lowbit(r);\n\t\twhile(l>r)res-=tree[l],l-=lowbit(l);\n\t\treturn res;\n\t}\n}S,T;//\u6811\u72b6\u6570\u7ec4\u7684struct \nstruct node{int id,d,t;}data[N];\ninline bool cmp1(node a,node b){return a.d<b.d;}\ninline bool cmp2(node a,node b){return a.id<b.id;}\nsigned main(){\n\tint n;long long k,ans=0;\n\tscanf(\"%d%I64d\",&n,&k);//\u9898\u9762\u8ba9\u7528I64D\uff0clld\u597d\u50cf\u4e5f\u53ef\u4ee5\uff1f \n\tfor(int i=1;i<=n;i++)scanf(\"%d\",&data[i].d),data[i].id=i;\n\tsort(data+1,data+n+1,cmp1);data[n+1].t=-1;\n\tfor(int i=1,j=1;i<=n;i++,j++){\n\t\tdata[i].t=j;\n\t\twhile(data[i+1].d==data[i].d)i++,data[i].t=j;//\u76f8\u540c\u7684\u6578\u8981\u79bb\u6563\u5316\u6210\u76f8\u540c\u7684\u6570 \n\t}\n\tsort(data+1,data+n+1,cmp2);\n\t//==\u79bb\u6563\u5316== \n\t\n\tint l=0,r=1;long long num=0;\n\tfor(int i=r;i<=n;i++)num+=T.sum(data[i].t+1,N),T.add(data[i].t,1);\n\twhile(l<n){\n\t\tl++;\n\t\tnum+=S.sum(data[l].t+1,N),num+=T.sum(1,data[l].t-1);\n\t\tS.add(data[l].t,1);\n\t\twhile(num>k||l==r){//l==r\u65f6\u4e0d\u5408\u6cd5 \n\t\t\tnum-=S.sum(data[r].t+1,N),num-=T.sum(1,data[r].t-1);\n\t\t\tT.add(data[r].t,-1);\n\t\t\tr++;\n\t\t\tif(r>n)goto End;//\u7528goto\u5077\u4e2a\u61d2 \n\t\t}\n\t\tans+=n-r+1;//\u4ecer\u5f80\u540e\u5168\u662f\u7b54\u6848\uff0c\u90fd\u8981\u52a0\u4e0a \n\t}\n\tEnd:\n\tprintf(\"%I64d\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1580032857,
        "uid": 157677,
        "name": "maruize",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF220E \u3010Little Elephant and Inversions\u3011"
    }
]
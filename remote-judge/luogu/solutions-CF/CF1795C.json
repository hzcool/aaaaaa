[
    {
        "content": "# \u9898\u89e3\u3010CF1795C Tea Tasting\u3011\n\n## \u7b80\u8981\u9898\u610f\n\n\u5171\u6709 $n$ \u4e2a\u4eba\u548c $n$ \u79cd\u8336\uff0c\u7b2c $i$ \u4e2a\u4eba\u6bcf\u6b21\u53ef\u4ee5\u559d $b_i$ \u5355\u4f4d\u7684\u8336\uff0c\u800c\u7b2c $j$ \u79cd\u8336\u6709 $a_i$ \u5355\u4f4d\u3002\u7b2c $t$ \u5468\u671f\u65f6\uff0c\u7b2c $i(i\\geq t)$ \u4eba\u5c06\u54c1\u5c1d\u7b2c $(i-t+1)$ \u79cd\u8336\uff0c\u800c\u53e6\u5916\u7684\u4eba\u5c06\u4e0d\u54c1\u5c1d\u4efb\u4f55\u8336\u3002\u6700\u540e\uff0c\u6c42\u51fa\u6bcf\u4e2a\u4eba\u5c06\u559d\u5230\u8336\u7684\u5355\u4f4d\u6570\u3002\u8fd9\u91cc\uff0c\u54c1\u5c1d\u7684\u5b9a\u4e49\u4e3a\uff1a\u7b2c $i$ \u4eba\u54c1\u5c1d\u7b2c $j$ \u79cd\u8336\uff0c\u5219\u7b2c $i$ \u4eba\u559d\u5230 $\\min (b_i, a_j)$ \u5355\u4f4d\u7684\u8336\uff0c\u6b64\u540e\uff0c$a_j \\gets a_j-\\min (b_i, a_j)$\u3002\n\n## \u601d\u8def\n\n\u76f4\u63a5\u8fd9\u4e48\u505a\u7684\u8bdd\u662f $O(n^2)$ \u7684\uff0c\u4e0d\u80fd\u901a\u8fc7\u3002\u6362\u4e00\u79cd\u60f3\u6cd5\uff0c\u8003\u8651\u6bcf\u79cd\u8336\u80fd\u591f\u201c\u6d3b\u201d\u5230\u4ec0\u4e48\u65f6\u5019\uff0c\u6362\u53e5\u8bdd\u8bf4\u5c31\u662f\u5b83\u5728\u7b2c\u51e0\u4e2a\u5468\u671f\u88ab\u559d\u5b8c\uff08\u4f7f\u5f97 $a_i=0$\uff09\u3002\n\n\u770b\u4e00\u4e0b\u6837\u4f8b\u7ed9\u7684\u56fe\uff0c\u6211\u4eec\u80fd\u591f\u53d1\u73b0\uff0c\u7b2c $i$ \u79cd\u8336\u6700\u591a\u80fd\u88ab $i\\sim n$ \u8fd9\u4e9b\u4eba\u54c1\u5c1d\uff0c\u800c\u524d $(i-1)$ \u4eba\u54c1\u5c1d\u4e0d\u5230\u8fd9\u79cd\u8336\u3002\n\n\u5219\uff0c\u6211\u4eec\u9700\u8981\u67e5\u8be2\u7b2c $i$ \u79cd\u8336\u7684\u6570\u91cf\u652f\u6301\u5b83\u4ece\u7b2c $i$ \u4eba\u5f00\u59cb\uff0c\u6700\u591a\u80fd\u591f\u88ab\u7b2c $x$ \u4eba\u54c1\u5c1d\u3002\u8bb0 `ps[i][j]` \u4e3a\u4ece $i$ \u5f00\u59cb\u7684\u5bf9 $b$ \u8fdb\u884c\u524d\u7f00\u548c\u7684\u6570\u7ec4\uff0c\u90a3\u4e48\u6211\u4eec\u8981\u67e5\u8be2\u7684\u5185\u5bb9\u5c31\u76f8\u5f53\u4e8e\uff1a\n\n```cpp\nx = lower_bound(ps[i] + i, ps[i] + 1 + n, a[i]) - ps[i];\n```\n\n\u8fd9\u6837\u505a\u867d\u7136\u5c06\u8ba1\u7b97\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u964d\u5230\u4e86 $O(n\\log n)$\uff0c\u4f46\u662f\u9884\u5904\u7406\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u548c\u7a7a\u95f4\u590d\u6742\u5ea6\u4ecd\u7136\u662f $O(n^2)$ \u7684\u3002\u8fd8\u9700\u8981\u4f18\u5316\u3002\n\n\u53d1\u73b0 `ps[i][j]` \u8fd9\u6837\u5199\u6709\u4e9b\u591a\u4f59\uff0c\u8003\u8651\u8bb0 `PS[i] = ps[1][i]`\uff1a\n\n$$ps_{i,x} \\geq a_i \\iff PS_x-PS_{i-1}\\geq a_i \\iff PS_x\\geq a_i+PS_{i-1}$$\n\n`lower_bound` \u7684\u5b9a\u4e49\u5c31\u662f\u5bf9\u4e8e\u5f85\u67e5\u8be2\u7684 $k$\uff0c\u627e\u5230\u7b2c\u4e00\u4e2a\u6570\u503c $x$ \u4f7f\u5f97 $x\\geq k$\u3002\u56e0\u6b64\u5229\u7528\u4ee5\u4e0a\u63a8\u8bba\uff0c\u4e4b\u524d\u7684\u4ee3\u7801\u53ef\u4ee5\u4fee\u6539\u6210\uff1a\n\n```cpp\nx = lower_bound(PS + i, PS + 1 + n, PS[i - 1] + a[i]) - PS;\n```\n\n\u8fd9\u6837\uff0c\u9884\u5904\u7406\u7684\u65f6\u7a7a\u590d\u6742\u5ea6\u90fd\u88ab\u4f18\u5316\u6210\u4e86 $O(n)$\u3002\n\n\u67e5\u8be2\u7684\u65b9\u5f0f\u5c31\u662f\u8fd9\u6837\u3002\u4e4b\u540e\uff0c\u8003\u8651\u5982\u4f55\u6c42\u51fa\u7b2c $i$ \u79cd\u8336\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u3002\n\n> \u6211\u4eec\u9700\u8981\u67e5\u8be2\u7b2c $i$ \u79cd\u8336\u7684\u6570\u91cf\u652f\u6301\u5b83\u4ece\u7b2c $i$ \u4eba\u5f00\u59cb\uff0c\u6700\u591a\u80fd\u591f\u88ab\u7b2c $x$ \u4eba\u54c1\u5c1d\u3002\n\n\u90a3\u4e48\uff0c\u7b2c $x$ \u4eba\u4e0d\u4e00\u5b9a\u80fd\u54c1\u5c1d\u5230 $b_x$ \u5355\u4f4d\uff0c\u56e0\u4e3a\u8336\u5728\u6b64\u523b\u53ef\u80fd\u5e76\u4e0d\u8db3\u591f\u3002\u4ed6\u5b9e\u9645\u80fd\u54c1\u5c1d\u5230\u591a\u5c11\u5355\u4f4d\u5462\uff1f\u8bbe\u4ed6\u80fd\u54c1\u5c1d\u5230 $y$ \u5355\u4f4d\uff0c\u5219\uff1a\n\n$$y + ps_{i,x-1} = a_i \\iff y + PS_{x-1} - PS_{i-1} = a_i \\iff y = a_i - PS_{x-1} + PS_{i-1}$$\n\n\u6839\u636e\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u7b2c $x$ \u4eba\u54c1\u5c1d\u7684\u5355\u4f4d\u6570\u5c31\u53ef\u4ee5\u8ba1\u7b97\u4e86\u3002\u5f53\u7136\uff0c\u5bf9\u4e8e\u7b2c $j(j\\in [i, x-1])$ \u4e2a\u4eba\uff0c\u4ed6\u6240\u80fd\u54c1\u5c1d\u5230\u7684\u5355\u4f4d\u6570\u5373\u4e3a $b_j$\u3002\n\n\u6700\u540e\uff0c\u5982\u4f55\u628a\u8d21\u732e\u5408\u5e76\u5462\uff1f\n\n\u6211\u7684\u505a\u6cd5\u662f\uff0c\u5206\u6574\u5757\u548c\u6563\u70b9\u8ba1\u7b97\u3002\u5bf9\u4e8e\u7b2c $i$ \u4e2a\u4eba\uff0c\u201c\u6574\u5757\u201d\u5373\u4e3a\u4f7f\u5f97\u4ed6\u80fd\u54c1\u5c1d\u5230 $b_i$ \u5355\u4f4d\u7684\u8336\uff0c\u201c\u6563\u70b9\u201d\u76f8\u5bf9\u6574\u5757\uff0c\u5373\u4e3a\u9664\u6574\u5757\u5916\uff0c\u80fd\u591f\u8ba9\u4ed6\u54c1\u5c1d\u5230\u7684\u8336\u3002\n\n\u6bcf\u79cd\u8336\u6700\u591a\u4ea7\u751f\u4e00\u4e2a\u6563\u70b9\uff0c\u53ef\u4ee5\u66b4\u529b\u5b58\u50a8\u6563\u70b9\u4e4b\u548c\u3002\n\n\u6bcf\u79cd\u8336\u4f1a\u4ea7\u751f\u591a\u4e2a\u6574\u5757\uff0c\u4f46\u8fd9\u4e9b\u6574\u5757\u5fc5\u7136\u662f\u8fde\u7eed\u7684\u3002\u6240\u4ee5\u8fd9\u76f8\u5f53\u4e8e\u533a\u95f4\u52a0\u3001\u5355\u70b9\u67e5\u8be2\u7684\u64cd\u4f5c\uff0c\u6211\u8d5b\u65f6\u662f\u5229\u7528\u5dee\u5206\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u7684\u3002\uff08\u663e\u7136\u4e0d\u7528\u8fd9\u4e48\u9ebb\u70e6\uff0c\u56e0\u4e3a\u5168\u90e8\u4fee\u6539\u5b8c\u624d\u4f1a\u67e5\u8be2\uff0c\u53ef\u4ee5\u5148\u5bf9\u5dee\u5206\u6570\u7ec4\u4fee\u6539\uff0c\u518d $O(n)$ \u6c42\u51fa\u5dee\u5206\u7684\u524d\u7f00\u548c\u5373\u539f\u6570\u7ec4\uff09\n\n\u8bbe\u7b2c $i$ \u4e2a\u4eba\u7684\u6574\u5757\u4e2a\u6570\u4e3a $k$\uff0c\u6563\u70b9\u4e4b\u548c\u4e3a $l$\uff0c\u4ed6\u7684\u7b54\u6848\u5373\u4e3a $k b_i + l$\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\nint T, n, a[200005], b[200005], s[200005], ful[200005], ex[200005];\nint lowbit(int u) { return u & (-u); }\nvoid update(int u, int w)\n{\n  for (int i = u; i <= n; i += lowbit(i))\n    ful[i] += w;\n}\nint query(int u)\n{\n  int w = 0;\n  for (int i = u; i; i -= lowbit(i))\n    w += ful[i];\n  return w;\n}\nsigned main()\n{\n  ios::sync_with_stdio(false);\n  cin.tie(0);\n  cout.tie(0);\n  cin >> T;\n  while (T--)\n  {\n    cin >> n;\n    for (int i = 1; i <= n; ++i)\n      cin >> a[i];\n    for (int i = 1; i <= n; ++i)\n      cin >> b[i], ful[i] = 0, ex[i] = 0, s[i] = s[i - 1] + b[i];\n    s[n + 1] = s[n];\n    for (int i = 1; i <= n; ++i)\n    {\n      int k = lower_bound(s + 1, s + 1 + n, s[i - 1] + a[i]) - s; // \u9898\u89e3\u4e2d\u7684 x\n      int x = a[i] + s[i - 1] - s[k - 1]; // \u9898\u89e3\u4e2d\u7684 y\n      update(i, 1);\n      if (k <= n) // \u6709\u53ef\u80fd\u4e00\u79cd\u8336\u80fd\u652f\u6301\u6240\u6709\u4eba\u54c1\u5c1d\uff0c\u6b64\u65f6\u4e0d\u9700\u8981\u628a\u5dee\u5206\u51cf\u56de\u6765\uff0c\u4e5f\u4e0d\u9700\u8981\u5904\u7406\u6563\u70b9\n      {\n        update(k, -1);\n        ex[k] += x;\n      }\n    }\n    for (int i = 1; i <= n; ++i)\n    {\n      cout << b[i] * query(i) + ex[i] << ' ';\n    }\n    cout << '\\n';\n  }\n  cout.flush();\n  return 0;\n}\n```\n",
        "postTime": 1677025650,
        "uid": 371468,
        "name": "qidirj",
        "ccfLevel": 0,
        "title": "\u9898\u89e3\u3010CF1795C Tea Tasting\u3011"
    },
    {
        "content": "# Solution\n\n\u8003\u8651\u6bcf\u676f\u8336\u5bf9\u4eba\u7684\u8d21\u732e\u3002\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u7b2c $i$ \u676f\u8336\u4f1a\u5bf9\u4ece\u7b2c $i$ \u4eba\u5f00\u59cb\u7684\u82e5\u5e72\u4e2a\u4eba\u4ea7\u751f\u8d21\u732e\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u7ef4\u62a4\u4e24\u4e2a\u6570\u7ec4:\n\n- $cnt_i$ \u8868\u793a\u5bf9\u7b2c $i$ \u4eba\u4ea7\u751f\u5b8c\u6574\u8d21\u732e\u7684\u6b21\u6570\u3002\n\n- $ex_i$ \u8868\u793a\u5bf9\u7b2c $i$ \u4eba\u4ea7\u751f\u7684\u4e0d\u5b8c\u6574\u8d21\u732e\u3002\n\n\u4e8e\u662f\u6700\u7ec8\u7b2c $i$ \u4eba\u7684\u7b54\u6848\u5c31\u662f $cnt_i \\times b_i + ex_i$\u3002\n\n\u5148\u6c42\u51fa $a_i$ \u7684\u524d\u7f00\u548c $s_i$\u3002\u5bf9\u4e8e\u6bcf\u4e00\u676f\u8336\uff0c\u6211\u4eec\u53ef\u4ee5\u4e8c\u5206\u627e\u5230\u5b83\u7684\u8d21\u732e\u7ec8\u6b62\u7684\u5730\u65b9\uff08\u5177\u4f53\u89c1\u4ee3\u7801\uff09\u3002\u8bbe\u6700\u540e\u4e00\u4e2a\u5f97\u5230\u5b8c\u6574\u8d21\u732e\u7684\u4eba\u4e0b\u6807\u4e3a $j$\uff0c\u5219 $cnt_i$ \u5230 $cnt_j$ \u6574\u4f53\u52a0 $1$\u3002$ex_{j+1}$ \u8981\u52a0\u4e0a\u5269\u4f59\u7684\u8336 $a_i - (s_j - s_{i-1})$\u3002\n\n\u7531\u4e8e $cnt$ \u53ea\u9700\u533a\u95f4\u52a0\u548c\u4e00\u6b21\u67e5\u8be2\uff0c\u5dee\u5206\u5373\u53ef\u3002\n\n# Code\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define N 200005\nusing namespace std;\nint T,n;\nll a[N];\nll b[N];\nll s[N];\nll cnt[N];\nll ex[N];\nint main(){\n\tscanf(\"%d\",&T);\n\twhile(T--){\n\t\tmemset(cnt,0,sizeof(cnt));\n\t\tmemset(ex,0,sizeof(ex));\n\t\tscanf(\"%d\",&n);\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tscanf(\"%lld\",&a[i]);\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tscanf(\"%lld\",&b[i]);\n\t\tfor(int i=1;i<=n;i++)\n\t\t\ts[i]=s[i-1]+b[i];\n\t\tfor(int i=1,l,r,mid;i<=n;i++){\n\t\t\tif(s[n]-s[i-1]<=a[i]){\n\t\t\t\tcnt[i]++;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tl=i; r=n;\n\t\t\twhile(l<r){\n\t\t\t\tmid=l+r>>1;\n\t\t\t\tif(s[mid]-s[i-1]<=a[i]) l=mid+1;\n\t\t\t\telse r=mid;\n\t\t\t}\n\t\t\tl--;\n\t\t\tcnt[i]++; cnt[l+1]--;\n\t\t\tex[l+1]+=a[i]-(s[l]-s[i-1]);\n\t\t}\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tcnt[i]+=cnt[i-1];\n\t\t\tprintf(\"%lld \",cnt[i]*b[i]+ex[i]);\n\t\t}\n\t\tprintf(\"\\n\");\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1676735910,
        "uid": 473071,
        "name": "ztlh",
        "ccfLevel": 5,
        "title": "CF1795C Tea Tasting"
    },
    {
        "content": "# Tea Tasting\n\n[Luogu CF1795C](https://www.luogu.com.cn/problem/CF1795C)\n\n## \u7b80\u8981\u9898\u610f\n\n> \u6709 $n$ \u676f\u8336\u548c $n$ \u4e2a\u8bc4\u59d4\uff0c$i$ \u676f\u8336\u6709 $a_i$ \u7684\u91cf\uff0c\u8bc4\u59d4 $i$ \u6bcf\u6b21\u6700\u591a\u559d $b_i$ \u7684\u8336\u3002\u5f00\u59cb\u7684\u65f6\u5019\u8bc4\u59d4 $i$ \u5bf9\u5e94\u8336 $i$\uff0c\u559d\u5b8c\u4e00\u6b21\u8fc7\u540e\u8bc4\u59d4 $i$ \u79fb\u5230 $i-1$ \u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u7ee7\u7eed\u4e0a\u8ff0\u64cd\u4f5c\uff0c\u76f4\u5230\u8bc4\u59d4 $n$ \u559d\u5b8c\u4e86\u6240\u6709\u7684\u8336\u3002\u6c42\u6bcf\u4e2a\u8bc4\u59d4\u559d\u4e86\u591a\u5c11\u8336\u3002\n\n## Solution\n\n\u53ef\u4ee5\u8003\u8651\u7b97\u51fa\u8bc4\u59d4\u559d\u8336\u91cf\u7684\u524d\u7f00\u548c\uff0c\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e00\u676f\u8336\uff0c\u90fd\u53ef\u4ee5\u4e8c\u5206\u627e\u5230\u662f\u88ab\u54ea\u4e00\u4e2a\u8bc4\u59d4\u559d\u5b8c\u7684\uff0c\u8bb0\u8336 $i$ \u88ab\u559d\u5b8c\u7684\u4f4d\u7f6e\u662f $\\text{pos}_i$\uff0c\u90a3\u4e48\u5bf9\u4e8e $j\\in[i,\\text{pos}_i)$ \u7684\u8bc4\u59d4 $j$\uff0c\u559d\u8fd9\u676f\u8336\u7684\u91cf\u90fd\u4f1a\u662f $b_j$\u3002\n\n\u90a3\u4e48\u5f97\u5230\u4e00\u4e2a\u505a\u6cd5\uff0c\u4ece $1\\sim n$ \u5730\u52a0\u5165\u6bcf\u4e00\u676f\u8336\u548c\u6bcf\u4e00\u4e2a\u8bc4\u59d4\uff0c\u5bf9\u4e8e\u8bc4\u59d4 $j$\uff0c\u80fd\u5bf9\u8fd9\u4e2a\u8bc4\u59d4\u4ea7\u751f $b_j$ \u8d21\u732e\u7684\u8336 $i$\uff0c\u4e00\u5b9a\u6ee1\u8db3 $\\text{pos}_i>j$ \u4e14 $i\\le j$\uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a\u4e8c\u7ef4\u6570\u70b9\u95ee\u9898\uff0c\u7528\u6811\u72b6\u6570\u7ec4\u89e3\u51b3\u5373\u53ef\u3002\n\n### Code\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n\nusing namespace std;\n\nconstexpr int _SIZE = 2e5;\nint n, a[_SIZE + 5], b[_SIZE + 5], sum[_SIZE + 5]; \nint ans[_SIZE + 5], pos[_SIZE + 5];\nint s[_SIZE + 5];\n\n#define lowbit(_) (_ & -_)\n#define Sum(l, r) (sum[r] - sum[l - 1])\n\nvoid Modify(int x, int v) {\n\tfor (; x <= n + 1; x += lowbit(x)) s[x] += v;\n}\n\nint Query(int x) {\n\tint res = 0;\n\t\n\tfor (; x; x -= lowbit(x)) res += s[x];\n\t\n\treturn res;\n}\n\nvoid Solve() {\n\tcin >> n;\n\t\n\tfor (int i = 1; i <= n; ++i) ans[i] = s[i] = 0;\n\t\n\tfor (int i = 1; i <= n; ++i)\n\t\tcin >> a[i];\n\t\n\tfor (int i = 1; i <= n; ++i)\n\t\tcin >> b[i], sum[i] = sum[i - 1] + b[i];\n\t\n\tfor (int i = 1; i <= n; ++i) {\n\t\tint l = i, r = n;\n\t\t\n\t\twhile (l <= r) {\n\t\t\tint mid = (l + r) >> 1;\n\t\t\t\n\t\t\tif (Sum(i, mid) < a[i]) l = mid + 1;\n\t\t\telse r = mid - 1;\n\t\t}\n\t\t\n\t\tans[r + 1] += a[i] - Sum(i, r); // \u4f1a\u5bf9\u8bc4\u59d4 r + 1 \u4ea7\u751f\u7684\u8d21\u732e\n\t\tpos[i] = r + 1;\n\t}\n\t\n\tfor (int i = 1; i <= n; ++i) {\n\t\tModify(pos[i], 1); // \u8336 i \u4f1a\u5bf9\u8bc4\u59d4 i \u4ea7\u751f\u8d21\u732e\n\t\tint tmp = i - Query(i); // \u5bf9\u8bc4\u59d4 i \u4ea7\u751f b_i \u8d21\u732e\u7684\u6570\u91cf\n\t\tcout << tmp * b[i] + ans[i] << ' ';\n\t}\n\t\n\tcout << '\\n';\n}\n\nsigned main() {\n\tios::sync_with_stdio(0);\n\tcin.tie(0); cout.tie(0);\n\tint T; cin >> T;\n\t\n\twhile (T--) Solve();\n}\n```",
        "postTime": 1676680075,
        "uid": 345225,
        "name": "Hanx16QwQ",
        "ccfLevel": 0,
        "title": "CF1795C Tea Tasting"
    },
    {
        "content": "\u7a0d\u5fae\u5199\u4e00\u4e0b\u3002\n\n\u7531\u4e8e\u672c\u4eba\u6bd4\u8f83\u7b28\uff0c\u6240\u4ee5\u5199\u7684\u65b9\u6cd5\u6bd4\u8f83\u66b4\u529b\u3002\n\n\u8003\u8651\u6bcf\u6b21\u5220\u9664\u6240\u6709\u5c0f\u4e8e $x_i$ \u7684\u8336\u3002\n\n\u7ef4\u62a4\u4e00\u4e2a $dx$ \u8868\u793a\u5f53\u524d $x_1+x_2+...+x_i$\u3002\u6bcf\u4e2a $b_j \\leq dx$ \u90fd\u4f1a\u5728\u672c\u8f6e\u88ab\u559d\u5149\uff0c\u6240\u4ee5\u8fd9\u4e00\u90e8\u5206\u7684\u8d21\u732e\u662f $sum-num \\times dx$\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $b_j \\geq dx$\uff0c\u4f1a\u88ab\u559d $x_i$ \u6240\u4ee5\u8d21\u732e\u4e3a $num \\times x_i$\u3002\n\n\u5bf9\u4e8e\u65b0\u52a0\u5165\u7684\u4e00\u676f\u8336\uff0c\u5927\u5c0f\u5e94\u4e3a $b_i+dx$ \u3002\n\n\u7528\u5e73\u8861\u6811\u7ef4\u62a4\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n \\log n)$ \u3002\n\ncode:\n```cpp\n#include<iostream>\n#include<cstring>\nusing namespace std;\n#define int long long\nconst int MX=3e5+7;\nint a[MX],b[MX],ans[MX];\nstruct node{\n\tint l,r,v,t,sum,h;\n}s[MX*2];\nint tNode=0,root=0;\nint new_node(int x){\n\ts[++tNode].v=x;\n\ts[tNode].l=s[tNode].r=0;\n\ts[tNode].t=1;\n\ts[tNode].sum=x;\n\ts[tNode].h=rand();\n\treturn tNode;\n}\nvoid upd(int x){\n\ts[x].t=s[s[x].l].t+s[s[x].r].t+1;\n\ts[x].sum=s[s[x].l].sum+s[s[x].r].sum+s[x].v;\n}\nint merge(int x,int y){\n\tif(x==0||y==0)return x|y;\n\tif(s[x].h<s[y].h){\n\t\ts[x].r=merge(s[x].r,y);\n\t\tupd(x);\n\t\treturn x;\n\t}\n\telse{\n\t\ts[y].l=merge(x,s[y].l);\n\t\tupd(y);\n\t\treturn y;\n\t}\n}\nvoid split(int root,int k,int &x,int &y){\n\tif(root==0)x=y=0;\n\telse{\n\t\tif(s[root].v<=k)\t\n\t\t\tx=root,split(s[root].r,k,s[root].r,y);\n\t\telse\n\t\t\ty=root,split(s[root].l,k,x,s[root].l);\n\t\tupd(root);\n\t}\n}\nint kth(int root,int k){\n\tif(root==0||k==0)return 0;\n\twhile(1){\n\t\tif(s[s[root].l].t+1==k)return root;\n\t\tif(k<=s[s[root].l].t)root=s[root].l;\n\t\telse k-=s[s[root].l].t+1,root=s[root].r;\n\t}\n}\nsigned main(){\n\tint T;\n\tcin>>T;\n\twhile(T--){\n\t\tint n,k,l,r,x,y,z;\n\t\tcin>>n;\n\t\tfor(int i=1;i<=n;i++)cin>>a[i];\n\t\tfor(int i=1;i<=n;i++)cin>>b[i];\n\t\tint dx=0;\n\t\troot=tNode=s[0].sum=s[0].v=0;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tsplit(root,a[i]+dx,x,y);\n\t\t\troot=merge(x,merge(new_node(a[i]+dx),y));\n\t\t\tsplit(root,b[i]+dx,x,y);\n\t\t\tans[i]=s[x].sum-s[x].t*dx+s[y].t*b[i];\n\t\t//\tcout<<\"i: \"<<i<<\" dx: \"<<dx<<\" s[x].sum \"<<s[x].sum<<\" s[y].t: \"<<s[y].t<<endl;\n\t\t\troot=y;\n\t\t\tdx+=b[i]; \n\t\t}\n\t\tfor(int i=1;i<=n;i++)cout<<ans[i]<<' ';\n\t\tcout<<endl;\n\t}\n\treturn 0;\n}\n\n\n```",
        "postTime": 1676857740,
        "uid": 236873,
        "name": "HJY202three",
        "ccfLevel": 7,
        "title": "CF1795C\u9898\u89e3"
    },
    {
        "content": "[\u6d1b\u8c37](https://www.luogu.com.cn/problem/CF1795C)\n\n[CF](http://codeforces.com/problemset/problem/1795/C)\n\n## \u5206\u6790\n\n\u6570\u636e\u8303\u56f4\u663e\u7136\u9700\u8981\u590d\u6742\u5ea6\u4e3a $O(n)$\u3002\n\n\u8003\u8651\u5bf9\u4e8e\u6bcf\u4e2a\u8336\u8003\u8651\u3002\u5b83\u4e00\u5b9a\u4f1a\u4ece\u4ed6\u5f00\u59cb\u5f80\u540e\u4e00\u6bb5\u4eba\u505a\u51fa\u5b8c\u6574\u8d21\u732e\uff08\u559d\u5230 $b_i$\uff09\uff0c\u7136\u540e\u4e3a\u4e00\u4e2a\u4eba\u505a\u51fa\u4e0d\u5b8c\u6574\u8d21\u732e\uff0c\u6700\u540e\u51e0\u4e2a\u4eba\u4e0d\u505a\u51fa\u8d21\u732e\u3002\n\n\u5bf9\u559d\u8336\u91cf\u524d\u7f00\u548c\uff0c\u4e8c\u5206\u7b2c\u4e00\u6bb5\u8d21\u732e\u7684\u7ec8\u6b62\u70b9\uff0c\u53ef\u4ee5\u8ba1\u7b97\u7b2c\u4e8c\u6bb5\u8d21\u732e\u7684\u91cf\u3002\u4f46\u662f\u6211\u4eec\u4e0d\u80fd\u5b9e\u65f6\u66f4\u6539\u7b54\u6848\u3002\n\n\u53d1\u73b0 $b_i$ \u662f\u56fa\u5b9a\u7684\u3002\u6211\u4eec\u9700\u8981\u77e5\u9053\u7684\u53ea\u662f\u4e00\u4e2a\u70b9\u53d7\u5230\u591a\u5c11\u6b21\u5b8c\u6574\u8d21\u732e\uff0c\u53ef\u4ee5\u4f7f\u7528\u5dee\u5206\u524d\u7f00\u548c\u3002\u800c\u7b2c\u4e8c\u6bb5\u7684\u8d21\u732e\u53ea\u4f1a\u6709 $n$ \u4e2a\uff0c\u76f4\u63a5\u4fee\u6539\u5373\u53ef\u3002\n\n## \u4ee3\u7801\n\n\u5173\u952e\u90e8\u5206\n\n```cpp\nfor(int i=1;i<=n;i++)\n{\n\tif(s[n]<=a[i]+s[i-1]) continue;\n\tint w=lower_bound(s+1,s+n+1,a[i]+s[i-1])-s;\n\tjian[w]++;\n\tex[w]+=a[i]-s[w-1]+s[i-1]; \n}\nfor(int i=1;i<=n;i++)\n{\n\tjian[i]+=jian[i-1];\n\tprintf(\"%lld \",b[i]*(i-jian[i])+ex[i]);\n}\n```",
        "postTime": 1676682023,
        "uid": 477954,
        "name": "lizhous",
        "ccfLevel": 0,
        "title": "CF1795C Tea Tasting \u9898\u89e3"
    },
    {
        "content": "### \u524d\u7f6e\u77e5\u8bc6\uff1a\r\n\r\n\u4e8c\u5206\u67e5\u627e\uff0c\u524d\u7f00\u548c\uff0c\u5dee\u5206\u3002\r\n\r\n### \u9898\u76ee\u5206\u6790\uff1a\r\n\r\n\u8003\u8651\u66b4\u529b\u7684\u8bdd\uff0c\u5c31\u662f\u6a21\u62df\u9898\u610f\u3002\u4f46\u662f\u8fd9\u662f CF\uff0c\u4f60\u5f97\u4e0d\u4e86\u5206\u6570\u3002\u8003\u8651\u4f18\u5316\u3002\r\n\r\n\u6211\u4eec\u53ef\u4ee5\u6ce8\u610f\u5230\uff0c\u6bcf\u4e2a $a_i$ \u53ef\u4ee5\u5bf9\u5b83\u6240\u5728\u7684\u4e0b\u6807\u540e\u9762\u7684\u6570\u4ea7\u751f\u8d21\u732e\uff0c\u5176\u4e2d\u4e00\u90e8\u5206\u8d21\u732e\u662f\u5b8c\u6574\u7684 $b_i$\uff0c\u4e00\u90e8\u5206\u662f\u5269\u4f59\u7684\u3002\u6211\u4eec\u5bf9 $b_i$ \u505a\u524d\u7f00\u548c\uff0c\u7136\u540e\u7528\u4e8c\u5206\u67e5\u627e\u627e\u5230\u5b8c\u6574\u4e0e\u5269\u4f59\u7684\u5206\u754c\u7ebf\u3002\u5bf9\u4e8e\u5b8c\u6574\u7684\u8d21\u732e\uff0c\u6211\u4eec\u7528\u5dee\u5206\u8bb0\u5f55\u6b21\u6570\uff0c\u975e\u5b8c\u6574\u7684\u8d21\u732e\uff0c\u8bb0\u5f55\u4e00\u4e2a\u6570\u7ec4\u3002\u6700\u540e\u7b54\u6848\u5c31\u662f\u4e00\u4e2a\u6570\u7684\u5b8c\u6574\u8d21\u732e\u6b21\u6570\u4e58\u4e0a $b_i$\uff0c\u52a0\u4e0a\u975e\u5b8c\u6574\u8d21\u732e\u3002\r\n\r\n### \u4ee3\u7801\u5982\u4e0b\uff1a\r\n\r\n```\r\n#include<bits/stdc++.h>\r\nusing namespace std;\r\nint T;\r\nint n;\r\ntypedef long long ll;\r\nconst int N=2e5+10;\r\nll a[N];\r\nll k[N];\r\nll s[N];\r\nll b[N];\r\nll ans[N];\r\nint main(){\r\n\tscanf(\"%d\",&T);\r\n\twhile(T--){\r\n\t\tscanf(\"%d\",&n);\r\n\t\tfor(int i=1;i<=n;i++){\r\n\t\t\tscanf(\"%lld\",&a[i]);\r\n\t\t\tb[i]=s[i]=ans[i]=0;\r\n\t\t}\r\n\t\tfor(int i=1;i<=n;i++) scanf(\"%d\",&k[i]);\r\n\t\tfor(int i=1;i<=n;i++) s[i]=s[i-1]+k[i];\r\n\t\tfor(int i=1;i<=n;i++){\r\n\t\t\tint pos=lower_bound(s+i,s+n+1,a[i]+s[i-1])-s;\r\n\t\t\tb[pos]--;b[i]++;ans[pos]+=a[i]-(s[pos-1]-s[i-1]);\r\n\t\t}for(int i=1;i<=n;i++) b[i]+=b[i-1];\r\n\t\tfor(int i=1;i<=n;i++)\r\n\t\t\tprintf(\"%lld \",ans[i]+b[i]*k[i]);\r\n\t\tputs(\"\");\r\n\t}return 0;\r\n} \r\n```\r\n\r\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(n\\log n)$\u3002\r\n\r\n\u6ce8\u610f\uff1a\u7b54\u6848\u5f88\u5927\uff0c\u8981\u5f00 ```long long```\u3002\r\n",
        "postTime": 1676896793,
        "uid": 511271,
        "name": "\u30c0\u6708",
        "ccfLevel": 5,
        "title": "Tea Tasting"
    },
    {
        "content": "[\u9898\u76ee](https://codeforces.com/contest/1795/problem/C)\n\n### \u5927\u610f\n\n\u6709 $n$ \u4e2a\u4eba\u548c $n$ \u676f\u8336\uff0c\u7b2c $i$ \u676f\u8336\u7684\u4f53\u79ef\u4e3a $a_i$\uff0c\u7b2c $i$ \u4e2a\u4eba\u4e00\u6b21\u6700\u591a\u80fd\u559d $b_i$ \u5355\u4f4d\u4f53\u79ef\u7684\u8336\u3002\u521d\u59cb\u7b2c $i$ \u4e2a\u4eba\u7ad9\u5728\u7b2c $i$ \u676f\u8336\u524d\u3002\u4e4b\u540e\u6bcf\u4e2a\u4eba\u4f1a\u559d\u9762\u524d\u7684\u8336 $\\min(a_i,b_i)$ \u5355\u4f4d\u4f53\u79ef\uff0c\u7136\u540e\u6bcf\u4e2a\u4eba\u5411\u524d\u79fb\u4e00\u4f4d\uff0c\u79fb\u51fa\u53bb\u7684\u4eba\u5c31\u7ed3\u675f\u54c1\u8336\uff0c\u95ee\u6bcf\u4e2a\u4eba\u80fd\u559d\u5230\u591a\u5c11\u4f53\u79ef\u7684\u8336\u3002\n\n### \u601d\u8def\n\n\u66b4\u529b\u663e\u7136\u662f $\\mathcal{O}(n^2)$ \u7684\uff0c\u679a\u4e3e\u6bcf\u676f\u8336\u4e0d\u65ad\u5f80\u540e\u88ab\u559d\uff0c\u76f4\u5230\u7ed3\u675f\u3002\n\n\u66b4\u529b\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u5bf9\u4e8e\u7b2c $i$ \u676f\u8336\uff0c\u5b83\u4e00\u5b9a\u88ab\u7b2c $i$ \u4e2a\u4eba\u559d $b_i$ \u4f53\u79ef\uff0c\u518d\u88ab\u7b2c $i+1$ \u4e2a\u4eba\u559d $b_{i+1}$ \u4f53\u79ef\uff0c\u2026\u2026\uff0c\u88ab\u7b2c $j-1$ \u4e2a\u4eba\u559d $b_{j+1}$ \u4f53\u79ef\uff0c\u5269\u4e0b\u7684\u5168\u88ab\u7b2c $j$ \u4e2a\u4eba\u559d\u4e86\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u628a $a_i$ \u5206\u89e3\u4e3a $b_{i}+b_{i+1}+\\ldots+b_{j-1}+res$\uff08$res < b_{j}$\uff09\u3002\u6240\u4ee5\uff0c\u7b2c $i$ \u676f\u8336\u5bf9\u5176\u4e4b\u540e\u8fde\u7eed\u7684\u4e00\u6bb5\u4eba $i\\sim (j-1)$ \u6709\u7740\u76f8\u5e94\u7684\u201c\u5b8c\u6574\u7684\u201d $b$ \u7684\u8d21\u732e\uff0c\u5bf9\u7b2c $j$ \u4e2a\u4eba\u6709\u7740\u201c\u96f6\u6563\u7684\u201d\u8d21\u732e\u3002\n\n---\n\n\u5bf9\u4e8e\u5982\u4f55\u5904\u7406 $j$\uff0c\u6211\u4eec\u53ef\u4ee5\u9884\u5904\u7406\u51fa $b$ \u7684\u524d\u7f00\u548c $B$\uff0c\u5728\u5176\u4e2d\u641c\u6700\u5c0f\u7684\u5927\u4e8e $a_i + b_{i-1}$ \u7684 $B_j$\u3002\uff08\u5173\u4e8e\u4e3a\u4ec0\u4e48\u8981\u52a0 $b_{i-1}$\uff0c\u662f\u56e0\u4e3a\u6211\u4eec\u8981\u627e\u7b2c\u4e00\u4e2a\u6ee1\u8db3 $\\sum\\limits_{p=i}^{j} > a_i$\uff0c\u4e5f\u5c31\u662f $B_j = \\sum\\limits_{p=1}^j > a_i + \\sum\\limits_{p=1}^{i-1} = a_i + B_{i-1}$\uff09\u3002\u8fd9\u4e00\u70b9\u6211\u4eec\u53ef\u4ee5\u7528\u4e8c\u5206\u6216\u8005 `lower_bound` \u51fd\u6570\u6765\u5b9e\u73b0\u3002\n\n\u5bf9\u4e8e\u5982\u4f55\u7edf\u8ba1\u7b54\u6848\uff0c\u6211\u4eec\u5f00\u4e24\u4e2a\u6570\u7ec4 $r$ \u548c $ans$ \u5206\u522b\u7edf\u8ba1\u201c\u5b8c\u6574\u7684\u201d\u548c\u201c\u96f6\u6563\u7684\u201d\u7b54\u6848\u3002\u5bf9 $a_i$ \u641c\u5230 $j$ \u65f6\uff0c\u5c06 $ans_j$ \u52a0\u4e0a $a_i - \\sum\\limits_{p=i}^{j-1} = a_i - (B_{j-1} - B_{i-1})$\uff1b\u8fd8\u9700\u8981\u5c06 $r_i\\sim r_{j-1}$ \u52a0\u4e0a $1$\uff0c\u90a3\u4e48\u8fd9\u6837\u5c31\u9700\u8981\u7ef4\u62a4\u533a\u95f4\u548c\u7684\u6570\u636e\u7ed3\u6784\u4f8b\u5982\u6811\u72b6\u6570\u7ec4\uff0c\u5229\u7528\u5dee\u5206\u601d\u60f3\uff0c\u7528 $res$ \u8868\u793a $r$ \u7684\u5dee\u5206\u6570\u7ec4\uff0c$r$ \u5c31\u662f $res$ \u7684\u524d\u7f00\u548c\uff0c\u8fd9\u6837\u5c06 $res_i$ \u52a0\u4e00\uff0c$res_j$ \u51cf\u4e00\u5373\u53ef\u3002\n\n\u6700\u540e\u7b2c $i$ \u4e2a\u4eba\u7684\u7b54\u6848\u81ea\u7136\u5c31\u662f $r_i\\times b_i + ans_i = \\sum\\limits_{p=1}^i res_p\\times b_i + ans_i$ \u4e86\u3002\n\n---\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#define maxn 200005\n#define ll long long\nusing namespace std;\nint T,n,a[maxn],res[maxn]; ll b[maxn],ans[maxn];\nint main(){\n    scanf(\"%d\",&T); while(T--){\n        scanf(\"%d\",&n); for(int i=1;i<=n;i++){scanf(\"%d\",&a[i]); res[i]=ans[i]=0;}\n        for(int i=1;i<=n;i++){scanf(\"%lld\",&b[i]); b[i]+=b[i-1];}\n        for(int i=1;i<=n;i++){\n            int pos=lower_bound(b+1,b+1+n,a[i]+b[i-1])-b;\n            res[i]++; res[pos]--; ans[pos]+=a[i]-(b[pos-1]-b[i-1]);\n        } ll sum=0LL; for(int i=1;i<=n;i++){sum+=res[i]; printf(\"%lld \",sum*(b[i]-b[i-1])+ans[i]);} printf(\"\\n\");\n    } return 0;\n}\n```",
        "postTime": 1676811015,
        "uid": 294382,
        "name": "qzhwlzy",
        "ccfLevel": 5,
        "title": "CF1795C Tea Tasting \u9898\u89e3"
    },
    {
        "content": "## \u3010\u9898\u610f\u7b80\u8ff0\u3011\n  \u6709 $n$ \u676f\u8336 $\\{a_n\\}$ \u548c $n$ \u4e2a\u4eba\u559d\u8336\uff0c\u7b2c $i$ \u4e2a\u4eba\u4ece\u7b2c $i$ \u676f\u8336\u5411\u524d\u559d\uff0c\u6bcf\u6b21\u53ef\u4ee5\u559d $b_i$ \uff0c\u6c42\u6bcf\u4e2a\u4eba\u6700\u591a\u559d\u591a\u5c11\u3002\n## \u3010\u601d\u8def\u3011\n  \u8bb0\u5f55\u6bcf\u4e2a\u4eba\u7684\u676f\u6570 $c_i$ \u548c\u56e0\u4e3a\u5404\u79cd\u56e0\u7d20\u5c11\u559d\u7684\u6beb\u5347\u6570 $d_k$ \u3002\u663e\u7136\uff0c\u5728\u6bcf\u676f\u8336\u90fd\u591f\u7684\u60c5\u51b5\u4e0b\u7b2c $i$ \u4e2a\u4eba\u80fd\u559d $i$ \u676f\u3002\n  \n  \n  \u5bf9\u4e8e\u6bcf\u4e00\u676f\u8336 $a_i$ \uff0c\u5982\u679c\u5b83\u8db3\u591f\u591a\uff0c\u90a3\u4e48\u540e\u9762\u6bcf\u4e2a\u4eba\u90fd\u80fd\u559d\u6ee1 $b_i$ \uff0c\u4e0d\u4f1a\u5bf9\u6211\u4eec\u7684\u7ed3\u679c\u6709\u5f71\u54cd\uff0c\u8df3\u8fc7\uff1b\u53cd\u4e4b\u5fc5\u7136\u6709\u4e00\u4e2a\u4eba $k$ \uff0c\u4ed6\u521a\u597d\u559d\u5b8c\uff0c\u90a3\u4e48\u540e\u9762\u7684\u4eba\u5c11\u559d\u4e00\u676f\uff0c\u5373 $c_j,j \\in [k+1,n]$ \u51cf1\uff0c\u4ed6\u81ea\u5df1\u676f\u6570\u4e0d\u53d8\uff0c\u4f46\u5c11\u559d $b_k-a_i'$ \uff08 $a_i'$ \u4e3a\u8f6e\u5230\u4ed6\u65f6\u5269\u4e0b\u7684\u6570\u91cf\uff09\uff0c\u8bb0\u5f55\u5230 $d_k$ \u4e2d\u3002\n  \n  \u7531\u4e8e $b_i$ \u4e3a\u6b63\uff0c\u6240\u4ee5\u5176\u524d\u7f00\u548c\u5355\u589e\uff0c\u4e8e\u662f\u53ef\u4ee5\u5229\u7528\u524d\u7f00\u548c\u4e8c\u5206\u8fdb\u884c\u67e5\u627e $k$ \u3002\u7528\u6811\u72b6\u6570\u7ec4\u6216\u8005\u7ebf\u6bb5\u6811\u7ef4\u62a4 $c_i$ \uff0c\u6700\u540e\u8f93\u51fa $b_i \\times c_i - d_i$ \u3002\u603b\u590d\u6742\u5ea6 $O(nlogn)$ \u3002\n  \n  Code:\n\n```cpp\n#include<bits/stdc++.h>\n#define MAXN 200005\ntypedef long long _ll;\nusing namespace std;\n \nclass Seg_Tree\n{\n    private:\n        struct node { _ll plt,sum; } a[MAXN<<2];\n    public:\n        void build(int i, int l, int r);\n        inline void pushdown(int i, int l, int r);\n        inline void pushup(int i) { a[i].sum = a[i<<1].sum+a[i<<1^1].sum; }\n        void add(int i, int l, int r, int x, int y, _ll k);\n        _ll query(int i, int l, int r, int x, int y);\n};\nvoid Seg_Tree::build(int i, int l, int r)\n{\n    a[i].plt = 0;\n    if(l==r) { a[i].sum = l; return; }\n    int mid = l + r >> 1;\n    build(i<<1,l,mid); build(i<<1^1,mid+1,r);\n    pushup(i);\n}\ninline void Seg_Tree::pushdown(int i, int l, int r)\n{\n    int p = a[i].plt, mid = l + r >> 1;\n    a[i<<1].sum += p*(mid-l+1); a[i<<1^1].sum += p*(r-mid);\n    a[i<<1].plt += p; a[i<<1^1].plt += p;\n    a[i].plt = 0;\n}\nvoid Seg_Tree::add(int i, int l, int r, int x, int y, _ll k)\n{\n    if(x<=l && r<=y) { a[i].sum += k*(r-l+1); a[i].plt += k; return; }\n    int mid = l + r >> 1; pushdown(i,l,r);\n    if(x <= mid) add(i<<1,l,mid,x,y,k);\n    if(y >  mid) add(i<<1^1,mid+1,r,x,y,k);\n    pushup(i);\n}\n_ll Seg_Tree::query(int i, int l, int r, int x, int y)\n{\n    if(x<=l && r<=y) return a[i].sum;\n    int mid = l + r >> 1; pushdown(i,l,r);\n    _ll res = 0ll;\n    if(x <= mid) res += query(i<<1,l,mid,x,y);\n    if(y >  mid) res += query(i<<1^1,mid+1,r,x,y);\n    return res;\n}\n \n_ll t,n,pos,a[MAXN],b[MAXN],d[MAXN],s[MAXN];\n_ll find(int i)\n{\n    int l = i, r = n, mid;\n    while(l < r)\n    {\n        mid = l + r >> 1;\n        if(s[mid]-s[i-1] ==a[i]) return mid;\n        if(s[mid]-s[i-1] > a[i])  r = mid;\n        else l = mid + 1;\n    }\n    return l;\n}\nvoid solve()\n{\n    cin >> n; Seg_Tree st; memset(d,0,sizeof(d));\n    for(int i = 1; i <= n; ++i)\n        scanf(\"%lld\",a+i);\n    for(int i = 1; i <= n; ++i)\n        scanf(\"%lld\",b+i),s[i]=b[i]+s[i-1];\n    st.build(1,1,n);\n    for(int i = 1; i <= n; ++i)\n    {\n        if(a[i] >= s[n]-s[i-1]) continue;\n        pos = find(i);\n        if(pos < n) st.add(1,1,n,pos+1,n,-1);\n        d[pos] += b[pos]-(a[i]-(s[pos-1]-s[i-1]));\n    }\n    for(int i = 1; i <= n; ++i)\n        printf(\"%lld \",st.query(1,1,n,i,i)*b[i]-d[i]);\n    cout << endl;\n}\n \nint main()\n{\n    cin >> t;\n    while(t--) solve();\n    return 0;\n}\n```\n",
        "postTime": 1676721505,
        "uid": 241935,
        "name": "kjhhjki",
        "ccfLevel": 0,
        "title": "CF1795C Tea Tasting \u9898\u89e3"
    },
    {
        "content": "\n## \u5206\u6790\n\n\n\u6b63\u9762\u60f3\u6bcf\u4e2a\u4eba\u80fd\u559d\u591a\u5c11\u6709\u70b9\u56f0\u96be\uff0c\u4f46\u662f\u53ef\u4ee5\u4ece\u53e6\u4e00\u4e2a\u65b9\u9762\u60f3\u4e00\u676f\u8336\u80fd\u7ed9\u591a\u5c11\u4eba\u559d\u5c31\u505a\u51fa\u6765\u4e86\u3002\n\n\u4e0d\u96be\u7406\u89e3\uff0c\u56fa\u5b9a $l$\uff0c$l$ \u5230 $r$ \u7684\u4eba\u559d\u7684\u603b\u91cf\u968f\u7740 $r$ \u7684\u589e\u5927\u800c\u589e\u5927\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u4e8c\u5206\u4e00\u676f\u8336\u53ef\u4ee5\u63d0\u4f9b\u7ed9\u591a\u5c11\u4eba\u559d\uff0c\u5269\u4e0b\u7684\u52a0\u5230\u540e\u9762\u7b2c\u4e00\u4e2a\u6ca1\u559d\u5230\u7684\u4eba\u5934\u4e0a\u3002\n\n\u8981\u7528\u524d\u7f00\u548c\u548c\u5dee\u5206\u4f18\u5316\u65f6\u95f4\u590d\u6742\u5ea6\u3002\n\n\u603b\u4f53\u590d\u6742\u5ea6 $O(n\\log{n})$\uff0c\u8be6\u60c5\u89c1\u4ee3\u7801\u6ce8\u91ca\u3002\n\n## \u4ee3\u7801\n``` cpp\n#include<iostream>\n#define int long long\nusing namespace std;\nint a[500005],s[500005],n,T,d[500005],f[500005],ans[500005];\nsigned main()\n{\n    scanf(\"%lld\",&T);\n    while(T--)\n    {\n        \n        scanf(\"%lld\",&n);\n        for(int i=1;i<=n;i++)scanf(\"%lld\",&a[i]),f[i]=ans[i]=0;\n        for(int i=1;i<=n;i++)scanf(\"%lld\",&s[i]);\n        for(int i=1;i<=n;i++)d[i]=d[i-1]+s[i];//\u524d\u7f00\u548c\u4f18\u5316\n        for(int i=1;i<=n;i++)\n        {\n            int l=i,r=n,mid,cnt=-1;//\u4e8c\u5206\u4e3b\u4f53\n            while(l<=r)\n            {\n                mid=(l+r)>>1;\n                if(d[mid]-d[i-1]<=a[i])\n                {\n                    l=mid+1;\n                    cnt=mid;\n                }\n                else r=mid-1;\n            }\n            if(cnt!=-1)//\u8bb0\u5f97\u7279\u5224\u4e00\u4e2a\u4eba\u4e5f\u4e0d\u591f\n            {\n                f[i]++;\n                f[cnt+1]--;//\u5dee\u5206\u4f18\u5316\n                ans[cnt+1]+=a[i]-d[cnt]+d[i-1];\n            }\n            else ans[i]+=a[i];\n        }\n        for(int i=1;i<=n;i++)f[i]+=f[i-1];//\u8f93\u51fa\n        for(int i=1;i<=n;i++)printf(\"%lld \",ans[i]+f[i]*s[i]);\n        puts(\"\");\n    }\n}\n```",
        "postTime": 1676691845,
        "uid": 329177,
        "name": "FatOldEight",
        "ccfLevel": 0,
        "title": "\u9898\u89e3  CF1795C Tea Tasting"
    }
]
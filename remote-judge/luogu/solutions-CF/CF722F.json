[
    {
        "content": "1. \u8003\u8651\u5bf9\u6bcf\u4e2a $i$ \u5206\u522b\u6c42\u89e3. \u4e00\u4e2a\u56fa\u5b9a\u7684 $i$ \u5728\u67d0\u4e2a\u6570\u5217\u4e2d\u53ea\u51fa\u73b0\u4e00\u6b21, \u4ed6\u51fa\u73b0\u7684\u65f6\u95f4\u53ef\u4ee5\u8868\u793a\u6210 $kx+b$ \u7684\u5f62\u5f0f.\n2. \u8003\u8651\u7528\u5c3a\u53d6\u6cd5\u6c42\u7b54\u6848, \u6613\u77e5 $k1\\times x1-k2\\times x2=b2-b1$\u6709\u89e3$\\Leftrightarrow(b1-b2)\\equiv 0\\pmod {gcd(k1, k2)} $\u3002\u8bb0\u5f55\u5c3a\u53d6\u65f6\u5f53\u524d\u533a\u95f4\u6bcf\u4e00\u4e2a $k$ \u5bf9\u5e94\u7684 $b$ (\u5f53 $k1=k2$\u65f6\uff0c$b1$ \u663e\u7136\u5fc5\u987b\u7b49\u4e8e $b2$)\uff0c\u52a0\u5165\u65b0\u7684\u4e00\u7ec4 $(k,b)$ \u65f6\u53ea\u9700\u8981\u7528 $\\mathcal O(maxk)$ \u7684\u590d\u6742\u5ea6\u6765\u66f4\u65b0\u533a\u95f4\u5c31\u597d\u4e86.\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <vector>\nusing namespace std;\nstruct P {\n    int i, k, b;\n} st[200005];\nvector<P> v[200005];\n\nint read();\n\nint gcd(int a, int b) {\n    while (b ^= a ^= b ^= a %= b)\n        ;\n    return a;\n}\n\nbool check(int k1, int b1, int k2, int b2) {\n    if (k1 == k2) return b1 == b2;\n    return (b2 - b1) % gcd(k1, k2) == 0;\n}\n\nint main() {\n    int n = read(), m = read();\n    for (int i = 1; i <= n; ++i) {\n        int k = read();\n        for (int j = 1; j <= k; ++j) {\n            int x = read();\n            v[x].push_back((P){i, k, j - 1});\n        }\n    }\n    for (int x = 1; x <= m; ++x) {\n        int sz = v[x].size();\n        int l = 0, res = 0;\n        for (int i = 1; i <= 40; ++i) st[i].k = 0;\n        for (int i = 0; i < sz; ++i) {\n            if (i && v[x][i].i != v[x][i - 1].i + 1)\n                while (l < i) st[v[x][l++].k].k--;\n            for (int j = 1; j <= 40; ++j) {\n                if (!st[j].k) continue;\n                if (!check(j, st[j].b, v[x][i].k, v[x][i].b)) {\n                    while (l <= st[j].i) st[v[x][l++].k].k--;\n                }\n            }\n            st[v[x][i].k].k++, st[v[x][i].k].b = v[x][i].b, st[v[x][i].k].i = i;\n            res = max(res, i - l + 1);\n        }\n        printf(\"%d\\n\", res);\n    }\n    return 0;\n}\n\nint read() {\n    int x = 0, f = 1;\n    char c = getchar();\n    while (c < '0' || c > '9') f = (c == '-') ? -1 : f, c = getchar();\n    while (c >= '0' && c <= '9') x = x * 10 + c - '0', c = getchar();\n    return x * f;\n}\n\n```\n",
        "postTime": 1568014023,
        "uid": 51237,
        "name": "Kinandra",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF722F \u3010Cyclic Cipher\u3011"
    }
]
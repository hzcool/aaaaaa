[
    {
        "content": "\u5148\u5bf9 $b$ \u8dd1\u4e00\u904d KMP\uff0c\u5efa\u51fa\u5b83\u7684 KMP \u81ea\u52a8\u673a\u3002\u63a5\u4e0b\u6765\u8003\u8651 DP\u3002\u6211\u4eec\u5b9a\u4e49 $dp[i][j][k]$ \u8868\u793a\u5728 $a$ \u4e32\u4e2d\u505a\u5230\u4f4d\u7f6e $i$\uff0c$b$ \u4e32\u4e2d\u5339\u914d\u5230\u4f4d\u7f6e $j$\uff08\u4e5f\u662f KMP \u81ea\u52a8\u673a\u4e0a\u7684\u4f4d\u7f6e\uff09\uff0c\u76ee\u524d\u5df2\u7ecf\u5339\u914d\u4e86 $k$ \u4e2a\u5b57\u7b26\u4e32 $b$\uff0c\u6b64\u65f6\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n\u8f6c\u79fb\u7684\u65f6\u5019\uff0c\u679a\u4e3e $a_i$ \u8fd9\u4f4d\u586b\u4e86\u4ec0\u4e48\uff0c\u5728 KMP \u81ea\u52a8\u673a\u4e0a\u627e\u5230\u4e0b\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u8fdb\u884c\u8f6c\u79fb\u3002\u5f53\u4f4d\u7f6e\u5230 $m$ \u7684\u65f6\u5019\uff0c\u7ed9 $k$ \u52a0\u4e0a $1$\uff0c\u8868\u793a\u6b64\u65f6\u5b8c\u6210\u4e86\u4e00\u6b21\u5339\u914d\u3002\u8fd9\u6837\u8f6c\u79fb\u662f $O(1)$ \u7684\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6\u53ef\u4ee5\u901a\u8fc7\u6eda\u52a8\u6570\u7ec4\u964d\u5230 $O(n^2)$\uff0c\u4e0d\u8fc7\u8fd9\u9898\u4e5f\u4e0d\u5fc5\u8981\u3002\n\n```cpp\nconst int N=505;\nint n,m; \nint a[N],b[N],kmp[N],tran[N][2],dp[N][N][N];\nvoid prefix_function()\n{\n\tkmp[0]=-1;\n\tif (b[1]==0) tran[0][0]=1;\n\telse tran[0][1]=1;\n\tfor (int i=1;i<=m;i++)\n\t{\n\t\tint j=kmp[i-1];\n\t\twhile (j!=-1&&b[j+1]!=b[i]) j=kmp[j];\n\t\tkmp[i]=j+1;\n\t\tif (b[i+1]==0) tran[i][0]=i+1;\n\t\telse tran[i][0]=tran[kmp[i]][0];\n\t\tif (b[i+1]==1) tran[i][1]=i+1;\n\t\telse tran[i][1]=tran[kmp[i]][1];\n\t}\n}\n\nint main()\n{\n\tn=read(),m=read();\n\tfor (int i=1;i<=n;i++) a[i]=readchar()-'0';\n\tfor (int i=1;i<=m;i++) b[i]=readchar()-'0';\n\tb[m+1]=2;\n\tprefix_function();\n\tmemset(dp,20,sizeof(dp));\n\tdp[0][0][0]=0;\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tfor (int j=0;j<=m;j++)\n\t\t{\n\t\t\tfor (int k=0;k<=n-m;k++)\n\t\t\t{\n\t\t\t\tfor (int t=0;t<=1;t++)\n\t\t\t\t{\n\t\t\t\t\tint u=tran[j][t],v=k+(u==m);\n\t\t\t\t\tdp[i][u][v]=min(dp[i][u][v],dp[i-1][j][k]+(a[i]!=t));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i=0;i<=n-m+1;i++)\n\t{\n\t\tint ans=n+1;\n\t\tfor (int j=0;j<=m;j++) ans=min(ans,dp[n][j][i]);\n\t\tif (ans==n+1) ans=-1;\n\t\tprintf(\"%d \",ans);\n\t}\n\treturn 0;\n}\n\n```\n",
        "postTime": 1659406884,
        "uid": 151475,
        "name": "Little09",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1575H Holiday Wall Ornaments"
    },
    {
        "content": "vp \u65f6\u8fd9\u79cd\u9898\u6ca1\u505a\u51fa\u6765\uff0c\u6709\u88ab\u83dc\u5230\u3002\n\n\n\n------------\n\n\u8981\u8fdb\u884c\u5339\u914d\uff0c\u6761\u4ef6\u53cd\u5c04\u5efa\u51fa\u81ea\u52a8\u673a\u3002\u5728\u8fd9\u91cc\u9009\u62e9\u7684\u662f KMP \u81ea\u52a8\u673a\uff08\u5c31\u662f\u53ea\u6709\u4e00\u4e2a\u4e32\u7684 AC \u81ea\u52a8\u673a\u5566\uff09\u3002\n\n\u601d\u8003\u6240\u8c13\u53d8\u6362\u7684\u672c\u8d28\uff0c\u5c31\u662f\u5728\u81ea\u52a8\u673a\u4e0a\u4f60\u53ef\u4ee5\u76f4\u63a5\u6cbf\u7740\u5f53\u524d\u5b57\u7b26\u8d70\u5230\u4e0b\u4e00\u4e2a\u72b6\u6001\uff0c\u6216\u8005\u4f60\u53ef\u4ee5\u7528 $1$ \u7684\u4ee3\u4ef7\u6cbf\u7740\u76f8\u53cd\u7684\u5b57\u7b26\u8d70\u5230\u4e0b\u4e00\u4e2a\u72b6\u6001\u3002\u8fd9\u4e0d\u662f\u4e00\u773c\u52a8\u6001\u89c4\u5212\uff0c\u8f6c\u79fb\u90fd\u7ed9\u4f60\u51c6\u5907\u597d\u4e86\u3002\n\n\u6211\u4eec\u5efa\u51fa $f_{i,j,k}$ \u8868\u793a $a$ \u4e32\u5339\u914d\u5230 $i$\uff0c$b$ \u4e32\u5339\u914d\u5230 $j$\uff0c\u4e14\u5df2\u7ecf\u5339\u914d\u4e86 $k$ \u4e2a $b$ \u4e32\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\u6309\u4e0a\u9762\u7684\u65b9\u6cd5 $O(n^3)$ \u5927\u529b\u8f6c\u79fb\u5373\u53ef\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define forp(i, a, b) for (int i = (a);i <= (b);i ++)\n#define ll long long\nusing namespace std;\nconst ll mod = 1e9 + 7;\nconst ll maxn = 200005, maxk = 2;\nint n, m;\nint f[505][505][505];\nclass KMPAM{\n\tprivate:\n\t\tint cnt, to[maxn][maxk], link[maxn];\n\tpublic:\n\t\tvoid add(string s){\n\t\t\tint n = s.size();\n\t\t\tint u = 0;\n\t\t\tforp(i, 0, n - 1){\n\t\t\t\tint p = s[i] - '0';\n\t\t\t\tif(!to[u][p]) to[u][p] = ++ cnt;\n\t\t\t\tu = to[u][p];\n\t\t\t}\n\t\t}\n\t\tvoid build(){\n\t\t\tqueue<int> q;\n\t\t\tforp(i, 0, 1) if(to[0][i]) q.push(to[0][i]);\n\t\t\twhile(!q.empty()){\n\t\t\t\tint u = q.front();\n\t\t\t\tq.pop();\n\t\t\t\tforp(i, 0, 1){\n\t\t\t\t\tif(!to[u][i]) to[u][i] = to[link[u]][i];\n\t\t\t\t\telse link[to[u][i]] = to[link[u]][i],q.push(to[u][i]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tvoid dp(int n, string a, int m){\n\t\t\tforp(i, 0, n)\n\t\t\t\tforp(j, 0, m)\n\t\t\t\t\tforp(k, 0, n - m + 1)\n\t\t\t\t\t\tf[i][j][k] = 114514;\n\t\t\tf[0][0][0] = 0;\n\t\t\tforp(i, 1, n)\n\t\t\t\tforp(j, 0, m)\n\t\t\t\t\tforp(k, 0, n - m)\n\t\t\t\t\t\tforp(t, 0, 1){\n\t\t\t\t\t\t\tint x = a[i - 1] - '0';\n\t\t\t\t\t\t\tint u = to[j][t],v = k;\n\t\t\t\t\t\t\tif(u == m) v ++;\n\t\t\t\t\t\t\tif(x == t) f[i][u][v] = min(f[i][u][v], f[i - 1][j][k]);\n\t\t\t\t\t\t\telse f[i][u][v] = min(f[i][u][v], f[i - 1][j][k] + 1);\n\t\t\t\t\t\t}\n\t\t}\n}A;\nvoid print(int n, int m){\n\tforp(k, 0, n - m + 1){\n\t\tint ans = 114514;\n\t\tforp(j, 0, m) ans = min(ans, f[n][j][k]);\n\t\tif(ans == 114514) cout << -1 << ' ';\n\t\telse cout << ans << ' '; \n\t}\n\tcout << endl;\n}\nsigned main(){\n\tios::sync_with_stdio(false);\n\tcin.tie(0);cout.tie(0);\n\tcin >> n >> m;\n\tstring a, b;\n\tcin >> a >> b;\n\tA.add(b);A.build();\n\tA.dp(n, a, m);\n\tprint(n, m);\n\treturn 0;\n}\n\n\n```\n",
        "postTime": 1677568066,
        "uid": 149219,
        "name": "_maze",
        "ccfLevel": 6,
        "title": "CF1575H \u9898\u89e3"
    }
]
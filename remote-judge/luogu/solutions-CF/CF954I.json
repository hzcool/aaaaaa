[
    {
        "content": "- [CF954I Yet Another String Matching Problem](https://www.luogu.com.cn/problem/CF954I)\n\n### \u9898\u76ee\u63cf\u8ff0\n\n\u7ed9\u5b9a\u4e24\u4e2a\u5b57\u7b26\u4e32 $S$, $T$, $len_S \\ge len_T$, \u5b57\u7b26\u96c6\u5927\u5c0f\u4e3a $[a, f]$\u3002\n\n\u6bcf\u6b21\u64cd\u4f5c\u53ef\u4ee5\u5c06\u4e00\u79cd\u5b57\u7b26\u53d8\u6210\u53e6\u5916\u4e00\u79cd\u5b57\u7b26\uff0c\u5bf9\u4e8e $S$ \u7684\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u8be2\u95ee\u6700\u5c11\u8fdb\u884c\u591a\u5c11\u6b21\u64cd\u4f5c\uff0c\u53ef\u4ee5\u53d8\u6210 $T$\u3002\n\n### \u6b63\u89e3\n\n\u53ef\u4ee5\u66b4\u529b\u679a\u4e3e\u96c6\u5408\u5212\u5206\uff08\u5373\u54ea\u4e9b\u5b57\u7b26\u8981\u53d8\u6210\u76f8\u540c\u7684\uff09\uff0c\u7136\u540e\u7528\u54c8\u5e0c\u6216\u8005 KMP \u505a\u5230 $O(n)$ \u5224\u65ad\u662f\u5426\u53ef\u884c\u3002\n\n\u4e4b\u524d\u6709\u4e9b\u9898\u89e3\u8bf4\u7684\u590d\u6742\u5ea6\u4e0d\u592a\u5bf9\uff0c\u96c6\u5408\u5212\u5206\u7684\u590d\u6742\u5ea6\u662f $O(Bell(n))$ \u7684\u800c\u4e0d\u662f $O(n!)$ \u7684\uff0c\u800c $B_6$ \u53ea\u6709 $203$\uff0c\u6240\u4ee5\u8db3\u77e3\u901a\u8fc7\u6b64\u9898\u3002\n\n---\n\n\u8bb2\u4e00\u4e0b\u600e\u4e48\u641c\u96c6\u5408\u5212\u5206\u5427\u3002\n\n\u5176\u5b9e\u96c6\u5408\u5212\u5206\u7684\u5199\u6cd5\u5c31\u8ddf\u751f\u6210\u68ee\u6797\u7684\u65b9\u6cd5\u5dee\u4e0d\u591a\u3002\n\n\u4ece\u5c0f\u5f80\u5927\u679a\u4e3e\u5143\u7d20\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5143\u7d20\uff0c\u5b83\u6709\u4e24\u79cd\u64cd\u4f5c :\n\n1. \u4f5c\u4e3a\u65b0\u7684\u68ee\u6797\u7684\u6839\u3002\n\n2. \u52a0\u5165\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u68ee\u6797\u3002\n\n#### \u7ed9\u51fa\u4ee3\u7801 :\n\n```cpp\nint fa[N];\nint blk[N], cb;\n\nvoid divSet(int dep) {\n\tif(dep > maxDep) {\n\t\tsolve();\n\t\treturn void();\n\t}\n\t\n\tfa[dep] = dep;\n\tblk[++cb] = dep;\n\tdivSet(dep + 1);\n\t\n\tblk[cb--] = 0;\n\tfor(int i = 1; i <= cb; ++i) {\n\t\tfa[dep] = blk[i];\n\t\tdivSet(dep + 1);\n\t}\n}\n```\n\n---\n\n\u8bdd\u8bf4\u8fd9\u9898 $O(Bell(|\\Sigma|)\\times n)$ \u7684\u590d\u6742\u5ea6\u5176\u5b9e\u53ef\u4ee5\u8dd1 $|\\Sigma| = 8$\uff0c\u4f46 $|\\Sigma|$ \u66f4\u5927\u7684\u60c5\u51b5\u5c31\u4e0d\u80fd\u8fd9\u4e48\u505a\u4e86\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int N = 125005;\n\nint ans[N];\nint fail[N];\nint lenS, lenT;\nchar s[N], t[N];\n\nint fa[N];\nint blk[N], cb;\n\ninline int tr(char ch) { return ch - 'a'; }\n\nvoid solve(int res) {\n\tint cur(0);\n\tfail[1] = 0;\n\tfor(int i = 2; i <= lenT; ++i) {\n\t\twhile(cur && fa[tr(t[i])] != fa[tr(t[cur + 1])])\n\t\t\tcur = fail[cur];\n\t\tif(fa[tr(t[i])] == fa[tr(t[cur + 1])])\n\t\t\t++cur;\n\t\tfail[i] = cur;\n\t}\n\tcur = 0;\n\tfor(int i = 1; i <= lenS; ++i) {\n\t\twhile(cur && fa[tr(s[i])] != fa[tr(t[cur + 1])])\n\t\t\tcur = fail[cur];\n\t\tif(fa[tr(s[i])] == fa[tr(t[cur + 1])])\n\t\t\t++cur;\n\t\tif(cur == lenT) {\n\t\t\tans[i] = min(ans[i], res);\n\t\t\tcur = fail[cur];\n\t\t}\n\t}\n}\n\nvoid divSet(int dep) {\n\tif(dep > tr('f')) {\n\t\t++cnt;\n\t\tsolve(6 - cb);\n\t\treturn void();\n\t}\n\t\n\tfa[dep] = dep;\n\tblk[++cb] = dep;\n\tdivSet(dep + 1);\n\t\n\tblk[cb--] = 0;\n\tfor(int i = 1; i <= cb; ++i) {\n\t\tfa[dep] = blk[i];\n\t\tdivSet(dep + 1);\n\t}\n}\n\nint main() {\n\tscanf(\"%s %s\", s + 1, t + 1);\n\tlenS = strlen(s + 1);\n\tlenT = strlen(t + 1);\n\t\n\tfor(int i =lenT; i <= lenS; ++i)\n\t\tans[i] = 233;\n\tdivSet(0);\n\tfor(int i = lenT; i <= lenS; ++i)\n\t\tprintf(\"%d%c\", ans[i], \" \\n\"[i == lenS]);\n\treturn 0;\n}\n```",
        "postTime": 1588504213,
        "uid": 88471,
        "name": "Lskkkno1",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 [CF954I] Yet Another String Matching Problem"
    },
    {
        "content": "\u9898\u89e3\u4e3a\u4ec0\u4e48\u90fd\u662f$FFT$~~~\n\n\u601d\u8def\u6765\u81ea\u4e8e [$\\color{black}\\textbf{F}\\color{red}\\textbf{rame}$](https://www.luogu.org/space/show?uid=81844) \u5de8\u4f6c\n\n---\n\u9898\u9762\u7ffb\u8bd1\uff1a\u5bf9\u4e8e\u4e24\u4e2a\u7b49\u957f\u7684\u5b57\u7b26\u4e32$s,t$\uff0c\u6bcf\u6b21\u53ef\u4ee5\u82b1\u8d39$1$\u7684\u4ee3\u4ef7\uff0c\u5c06\u67d0\u4e00\u79cd\u5b57\u7b26\u5168\u90fd\u66ff\u6362\u6210\u53e6\u4e00\u79cd\u5b57\u7b26\u3002\n\n\u8bbe$f(s,t)$\u4e3a\u6700\u5c11\u82b1\u8d39\u591a\u5c11\u4ee3\u4ef7\uff0c\u4f7f\u5f97$s=t$\u3002\n\n\u7ed9\u5b9a\u5b57\u7b26\u4e32$s,t$\uff0c\u6c42$s$\u6bcf\u4e2a\u4e0e$t$\u957f\u5ea6\u76f8\u540c\u7684\u5b57\u4e32$s'$\u7684$f(s',t)$\u3002\n\n---\n\u5bb9\u6613\u53d1\u73b0\uff0c\u5c06\u5b57\u7b26$i$\u6539\u6210\u5b57\u7b26$j$\uff0c\u4e0e\u5c06\u5b57\u7b26$j$\u6539\u6210\u5b57\u7b26$i$\u6548\u679c\u76f8\u540c\uff0c\u6240\u4ee5\u5f53\u6211\u4eec\u4fee\u6539\u65f6\uff0c\u4f7f$i\\le j$\u3002\n\n\u8fd8\u80fd\u53d1\u73b0\uff0c\u5c06$i$\u4fee\u6539\u4e3a$j$\uff0c\u518d\u5c06\u6240\u6709\u7684$j$\u4fee\u6539\u4e3a$k$\uff0c\u4e0e$i,j$\u90fd\u4fee\u6539\u4e3a$k$\u6548\u679c\u76f8\u540c\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5$O(6!)$\u679a\u4e3e\u6bcf\u4e2a\u5b57\u7b26$i$\u5c06\u8981\u4fee\u6539\u4e3a\u7684\u5b57\u7b26$j(i\\le j)$\uff0c\u5e76\u5bf9$s,t$\u4e32\u8fdb\u884c$O(n)$\u7684$KMP$\u3002\u5bf9\u4e8e\u80fd\u591f\u5339\u914d\u7684\u5b57\u4e32\uff0c\u66f4\u65b0\u7b54\u6848\u3002\n\nCode:\n\n```cpp\n#include<stdio.h>\n#include<string.h>\nint rd(){\n\tint k=0;char c=getchar();\n\twhile(c>'9'||c<'0')c=getchar();\n\twhile(c>='0'&&c<='9')k=k*10+c-'0',c=getchar();\n\treturn k;\n}\nconst int N=500001;\nint Min(int x,int y){return x<y?x:y;}\nint n,m,a[N],b[N],ans[N],kmp[N],i[7];char s[N],t[N];\nvoid KMP(int C){\n\tfor(int i=2,j=0;i<=m;++i){\n\t\twhile(j&&b[i]!=b[j+1])j=kmp[j];\n\t\tif(b[i]==b[j+1])++j;\n\t\tkmp[i]=j;\n\t}\n\tfor(int i=1,j=0;i<=n;++i){\n\t\twhile(j&&a[i]!=b[j+1])j=kmp[j];\n\t\tif(a[i]==b[j+1])++j;\n\t\tif(j==m)ans[i]=Min(ans[i],C),j=kmp[j];\n\t}\n}\nint main(){\n\tfreopen(\"data.in\",\"r\",stdin);\n\tfreopen(\"data.out\",\"w\",stdout);\n\tmemset(ans,0x3f,sizeof(ans));//\u7b54\u6848\u521d\u59cb\u5316\u4e3aINF\n\tscanf(\"%s%s\",s+1,t+1),n=strlen(s+1),m=strlen(t+1);\n\ti[5]=5;\n\tfor(i[0]=0;i[0]<6;++i[0])for(i[1]=1;i[1]<6;++i[1])for(i[2]=2;i[2]<6;++i[2])for(i[3]=3;i[3]<6;++i[3])\n\tfor(i[4]=4;i[4]<6;++i[4]){\n    \t//\u679a\u4e3e\u6bcf\u4e2a\u5b57\u7b26\u5c06\u8981\u4fee\u6539\u4e3a\u7684\u5b57\u7b26\u3002\u6ce8\u610fi<=j\n\t\tfor(int j=1;j<=n;++j)a[j]=i[s[j]-'a'];\n        for(int j=1;j<=m;++j)b[j]=i[t[j]-'a'];\n        //s\u4fee\u6539\u540e\u4e3aa\uff0ct\u4fee\u6539\u540e\u4e3ab\n\t\tKMP((i[0]>0)+(i[1]>1)+(i[2]>2)+(i[3]>3)+(i[4]>4));\n        //\u82e5i[x]=x\uff0c\u5219\u4e0d\u9700\u8981\u4fee\u6539\uff0c\u5426\u5219\u4ee3\u4ef7\u4e3a1\n\t}\n\tfor(int i=m;i<=n;++i)printf(\"%d \",ans[i]);puts(\"\");\n\treturn 0;\n}\n```",
        "postTime": 1570851152,
        "uid": 68467,
        "name": "xcxcli",
        "ccfLevel": 0,
        "title": "CF954I Yet Another String Matching Problem"
    },
    {
        "content": "\u5bf9\u4e8e s \u7684\u67d0\u4e2a\u5b50\u4e32\u548c t\uff0c\u53ef\u4ee5\u8fd9\u6837\u6c42\uff1a\u5047\u5982 6 \u4e2a\u70b9\u8868\u793a\u8fd9 6 \u79cd\u5b57\u6bcd\uff0c\u90a3\u4e48 s \u548c t \u540c\u4e00\u4f4d\u7f6e\u7684\u5b57\u7b26\u8fde\u8fb9\uff0c\u7136\u540e\u540c\u4e00\u8fde\u901a\u5757\u5fc5\u987b\u67d3\u6210\u4e00\u79cd\u5b57\u7b26\uff08\u5b58\u5728\u4e00\u6761\u8fb9\u8fde\u7740\u4e24\u4e2a\u4e0d\u540c\u7684\u5b57\u7b26\u5c31\u4e0d\u5408\u6cd5\u4e86\uff09\u3002\n\n\u8003\u8651\u600e\u4e48\u5feb\u901f\u6c42\u51fa s \u6240\u6709\u5b50\u4e32\u4e0e t \u7684\u8fde\u8fb9\u3002\u53cd\u8f6c\u5b57\u7b26\u4e32 t \u4ee5\u540e\uff0c\u5bf9\u4e8e\u5b57\u7b26 a, b\uff1a**\u5bf9\u4e8e p \u7ed3\u5c3e\u7684 s \u5b50\u4e32**\uff0c\u8fd9\u4e24\u4e2a\u5b57\u7b26\u8fde\u8fb9\u5f53\u4e14\u4ec5\u5f53 pos[a] + pos[b] = p\u3002\u8fd9\u53ef\u4ee5\u7528 FFT \u6216 NTT \u5377 a \u51fa\u73b0\u4f4d\u7f6e\u548c b \u51fa\u73b0\u4f4d\u7f6e\u3002\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\nusing std::swap;\ntypedef long long LL; const int N = 5e5 + 10;\nconst LL P = 998244353, G = 3, invG = (P + 1) / G;\nchar s[N], t[N]; LL a[N], b[N]; int slen, tlen,\n logn = 0, n, invn, rev[N];\nint atbit(int x) { return 1 << (x - 1); }\nLL pow(LL x, LL p) {\n  LL res = 1; while (p) {\n    if (p & 1) res = res * x % P;\n    x = x * x % P, p >>= 1;\n  } return res;\n} LL inv(LL x) { return pow(x, P - 2); }\nLL mod(LL x) { return (x % P + P) % P; }\nvoid NTT(LL* a, int typ) {\n  for (int i = 0; i <= n - 1; ++i)\n    if (i < rev[i]) swap(a[i], a[rev[i]]);\n  for (int len = 2; len <= n; len *= 2) {\n    int mid = len / 2;\n    LL wunit = pow((typ == 1) ? G : invG, (P - 1) / len);\n    for (int s = 0; s <= n - 1; s += len) {\n      LL wcur = 1;\n      for (int pos = 0; pos <= mid - 1; ++pos) {\n        LL h = a[s + pos], g = a[s + mid + pos];\n        a[s + pos] = mod(h + wcur * g);\n        a[s + mid + pos] = mod(h - wcur * g);\n        wcur = mod(wcur * wunit);\n      }\n    }\n  } if (typ == -1) for (int i = 0; i <= n - 1; ++i)\n    a[i] = mod(a[i] * invn);\n} int g[N][7][7]; int vis[7];\nvoid dfs(int u, int gnum) {\n  vis[u] = 1;\n  for (int v = 1; v <= 6; ++v)\n    if (g[gnum][u][v] and not vis[v]) dfs(v, gnum);\n}\nint main() {\n  scanf(\"%s%s\", s + 1, t + 1);\n  slen = strlen(s + 1), tlen = strlen(t + 1);\n  for (int i = 1; i <= tlen / 2; ++i) swap(t[i], t[tlen - i + 1]);\n  for (int i = 1; i <= slen; ++i) s[i] = s[i] - 'a' + 1;\n  for (int i = 1; i <= tlen; ++i) t[i] = t[i] - 'a' + 1;\n  while ((n = 1 << logn) and n - 1 < slen + tlen + 1) ++logn; invn = inv(n);\n  for (int i = 0; i <= n - 1; ++i) {\n    rev[i] = rev[i >> 1] >> 1;\n    if (i & 1) rev[i] |= atbit(logn);\n  }\n  for (int u = 1; u <= 6; ++u)\n    for (int v = 1; v <= 6; ++v) {\n      if (u == v) continue;\n      for (int i = 0; i <= n - 1; ++i) a[i] = s[i] == u;\n      for (int i = 0; i <= n - 1; ++i) b[i] = t[i] == v;\n      NTT(a, 1), NTT(b, 1); for (int i = 0; i <= n - 1; ++i)\n       a[i] = mod(a[i] * b[i]); NTT(a, -1);\n      for (int i = tlen + 1; i <= slen + 1; ++i) g[i][u][v] |= a[i] > 0,\n       g[i][v][u] |= a[i] > 0;\n    }\n  \n  for (int i = tlen; i <= slen; ++i) {\n    for (int u = 1; u <= 6; ++u) vis[u] = 0; int ans = 0;\n    for (int u = 1; u <= 6; ++u) if (not vis[u]) dfs(u, i + 1), ++ans;\n    printf(\"%d\", 6 - ans), putchar(i == slen ? '\\n' : ' ');\n  }\n  return 0;\n}\n```",
        "postTime": 1571046986,
        "uid": 49474,
        "name": "\u5b66\u59d4",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF954I \u3010Yet Another String Matching Problem\u3011"
    },
    {
        "content": "\u8003\u8651\u66b4\u529b\u5339\u914d\u4e24\u4e2a\u5b57\u7b26\u4e32 $s,t$ \u662f\u600e\u6837\u7684\u8fc7\u7a0b\uff1a\u5bf9\u4e8e\u6bcf\u4e2a $i$\uff0c\u6211\u4eec\u5728 $s_i$ \u4e0e $t_i$ \u4e4b\u95f4\u8fde\u4e00\u6761\u8fb9\uff0c\u8868\u793a $s_i$ \u9700\u8981\u53d8\u5230 $t_i$\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u5efa\u597d\u7684\u56fe\u4e2d\u7684\u6bcf\u4e2a\u8fde\u901a\u5757\uff0c\u663e\u7136\u6211\u4eec\u90fd\u53ef\u4ee5\u5e76\u4e14\u5fc5\u987b\u9009\u62e9\u67d0\u4e2a\u70b9\u5e76\u5c06\u8fde\u901a\u5757\u4e2d\u5176\u4f59\u7684\u70b9\u5168\u90e8\u53d8\u6210\u8fd9\u4e2a\u503c\u3002\u8fd9\u6837\u9700\u8981 $\\text{\u8fde\u901a\u5757\u5927\u5c0f}-1$ \u6b21\u64cd\u4f5c\u3002\u6545\u4ece $s$ \u5230 $t$ \u7684\u6700\u5c0f\u64cd\u4f5c\u6b21\u6570\u5c31\u662f $\\sum\\text{\u8fde\u901a\u5757\u5927\u5c0f}-1$\u3002\n\n\u4e8e\u662f\u672c\u9898\u601d\u8def\u5c31\u6765\u4e86\uff0c\u8bbe $f_{i,c1,c2}$ \u8868\u793a\uff0c\u5bf9\u4e8e $s$ \u4e2d\u4ee5 $i$ \u5f00\u5934\u7684\u957f\u5ea6\u4e3a $|t|$ \u7684\u5b50\u4e32 $s'$\uff0c\u6ee1\u8db3 $s'_i=c1,t_i=c2$ \u7684 $i$ \u7684\u4e2a\u6570\u3002\n\n\u600e\u6837\u6c42 $f_{i,c1,c2}$\uff1f\u8fd9\u53c8\u56de\u5230\u4e86\u6211\u4eec\u524d\u51e0\u9898\u7684\u5957\u8def\uff0c\u4ee4 $a_i$ \u8868\u793a $s_i$ \u662f\u5426\u7b49\u4e8e $c1$\uff0c$b_i$ \u8868\u793a $t_i$ \u662f\u5426\u7b49\u4e8e $c2$\u3002\u6545 $f_{i,c1,c2}=\\sum\\limits_{j=0}^{|t|}a_{i+j-1}b_j$\uff0c\u628a $b$ \u7ffb\u8f6c\u4e00\u4e0b\u6c42\u4e2a\u5377\u79ef\u5c31\u884c\u4e86\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a $i$\uff0c\u679a\u4e3e $f_{i,c1,c2}>0$ \u7684 $c1,c2$\uff0c\u7136\u540e\u8dd1\u4e0a\u8ff0\u64cd\u4f5c\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(6^2n\\log n)$\uff0c\u867d\u7136\u53ef\u4ee5\u8fc7\uff0c\u4f46\u662f\u663e\u7136\u5e38\u6570\u4e0a\u5929\u4e86\u3002\u8fd9\u4e2a\u505a\u6cd5\u9700\u8981\u8dd1 $3\\times 6^2=108$ \u6b21 DFT+IDFT\u3002\u4e0d\u8fc7\u6211\u4eec\u53d1\u73b0\uff0c\u53ef\u80fd\u7684 $a,b$ \u6700\u591a\u53ea\u6709 $6$ \u79cd\uff0c\u6240\u4ee5\u53ef\u4ee5\u5bf9\u6bcf\u4e2a $c1$ \u5355\u72ec\u6c42\u4e00\u904d $a_i$\uff0c\u5e76\u5bf9\u8fd9\u4e2a $a_i$ \u8dd1\u4e00\u904d DFT\u3002$b_i$ \u4e5f\u662f\u5982\u6b64\u3002\u8fd9\u6837\u5171\u9700 $6\\times 2=12$ \u6b21 DFT \u548c $6^2=36$ \u6b21 IDFT\u3002\u8fd8\u6709\u4e00\u4e2a\u5c0f\u4f18\u5316\uff0c\u5c31\u662f\u5bf9\u4e8e $c1=c2$\uff0c$f_{i,c1,c2}$ \u663e\u7136\u4e0d\u4f1a\u5bf9\u7b54\u6848\u4ea7\u751f\u4efb\u4f55\u5f71\u54cd\uff0c\u8fd9\u6837\u53ef\u4ee5\u518d\u5c11\u8dd1 $6$ \u6b21 IDFT\uff0c\u8fd9\u6837\u5c31\u53ea\u7528\u8dd1 $42$ \u6b21 DFT+IDFT \u4e86\u3002\n\n\u8fd8\u6709\u4e3a\u5565\u8fd9\u9898 difficulty \u624d 2200 \u554a\uff0c\u4e0e\u5b83\u96be\u5ea6\u76f8\u5f53\u7684 CF1334G \u90fd\u6709 2900 \u4e86\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi first\n#define se second\n#define fz(i,a,b) for(int i=a;i<=b;i++)\n#define fd(i,a,b) for(int i=a;i>=b;i--)\n#define ffe(it,v) for(__typeof(v.begin()) it=v.begin();it!=v.end();it++)\n#define fill0(a) memset(a,0,sizeof(a))\n#define fill1(a) memset(a,-1,sizeof(a))\n#define fillbig(a) memset(a,63,sizeof(a))\n#define pb push_back\n#define ppb pop_back\n#define mp make_pair\ntemplate<typename T1,typename T2> void chkmin(T1 &x,T2 y){if(x>y) x=y;}\ntemplate<typename T1,typename T2> void chkmax(T1 &x,T2 y){if(x<y) x=y;}\ntypedef pair<int,int> pii;\ntypedef long long ll;\ntemplate<typename T> void read(T &x){\n\tx=0;char c=getchar();T neg=1;\n\twhile(!isdigit(c)){if(c=='-') neg=-1;c=getchar();}\n\twhile(isdigit(c)) x=x*10+c-'0',c=getchar();\n\tx*=neg;\n}\nconst int MAXN=1.25e5;\nconst int MAXP=1<<19;\nconst int AS=6;\nconst double Pi=acos(-1);\nint n,m;char s[MAXN+5],t[MAXN+5];\nstruct comp{\n\tdouble x,y;\n\tcomp(){x=y=0;}\n\tcomp(double _x,double _y){x=_x;y=_y;}\n\tfriend comp operator +(comp lhs,comp rhs){return comp(lhs.x+rhs.x,lhs.y+rhs.y);}\n\tfriend comp operator -(comp lhs,comp rhs){return comp(lhs.x-rhs.x,lhs.y-rhs.y);}\n\tfriend comp operator *(comp lhs,comp rhs){return comp(lhs.x*rhs.x-lhs.y*rhs.y,lhs.x*rhs.y+lhs.y*rhs.x);}\n} A[AS+1][MAXP+5],B[AS+1][MAXP+5],C[MAXP+5];\nint LEN=1,LOG=0,rev[MAXP+5];\nvoid FFT(comp *a,int len,int type){\n\tint lg=log2(len);\n\tfor(int i=0;i<len;i++) rev[i]=(rev[i>>1]>>1)|((i&1)<<(lg-1));\n\tfor(int i=0;i<len;i++) if(i<rev[i]) swap(a[i],a[rev[i]]);\n\tfor(int i=2;i<=len;i<<=1){\n\t\tcomp W=comp(cos(2*Pi/i),type*sin(2*Pi/i));\n\t\tfor(int j=0;j<len;j+=i){\n\t\t\tcomp w=comp(1,0);\n\t\t\tfor(int k=0;k<(i>>1);k++,w=w*W){\n\t\t\t\tcomp X=a[j+k],Y=a[(i>>1)+j+k]*w;\n\t\t\t\ta[j+k]=X+Y;a[(i>>1)+j+k]=X-Y;\n\t\t\t}\n\t\t}\n\t}\n\tif(type==-1) for(int i=0;i<len;i++) a[i].x=(int)(a[i].x/len+0.5);\n}\nbool hav[MAXN+5][AS+1][AS+1];\nvoid solve(char c1,char c2){\n\tfor(int i=0;i<LEN;i++) C[i]=comp(0,0);\n\tfor(int i=0;i<LEN;i++) C[i]=A[c1-'a'][i]*B[c2-'a'][i];\n\tFFT(C,LEN,-1);\n\tfor(int i=1;i<=n-m+1;i++) if(C[m+i-1].x) hav[i][c1-'a'][c2-'a']=1;\n}\nint f[AS+1];\nint find(int x){return (f[x]==x)?x:f[x]=find(f[x]);}\nint main(){\n\tscanf(\"%s%s\",s+1,t+1);n=strlen(s+1);m=strlen(t+1);\n\twhile(LEN<=n+m) LEN<<=1,LOG++;\n    for(int c='a';c<='f';c++){\n        for(int i=1;i<=n;i++) A[c-'a'][i].x=(s[i]==c);\n        FFT(A[c-'a'],LEN,1);\n    }\n    for(int c='a';c<='f';c++){\n        for(int i=0;i<m;i++) B[c-'a'][i].x=(t[m-i]==c);\n        FFT(B[c-'a'],LEN,1);\n    }\n\tfor(char c1='a';c1<='f';c1++) for(char c2='a';c2<='f';c2++) if(c1!=c2) solve(c1,c2);\n\tfor(int i=1;i<=n-m+1;i++){\n\t\tfor(int j=0;j<AS;j++) f[j]=j;\n\t\tint sum=0;\n\t\tfor(int j=0;j<AS;j++) for(int k=0;k<AS;k++) if(j!=k&&hav[i][j][k]){\n\t\t\tint fj=find(j),fk=find(k);if(fj!=fk) sum++,f[fj]=fk;\n\t\t}\n\t\tprintf(\"%d \",sum);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1609845906,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF954I \u3010Yet Another String Matching Problem\u3011"
    },
    {
        "content": "\u697c\u4e0b\u7684$FFT$\u9898\u89e3\u597d\u6050\u6016\u2026\u2026\u6211\u81ea\u5df1\u7cca\u4e86\u4e00\u79cd**\u4ec5\u9002\u5408\u672c\u9898**\u7684\u505a\u6cd5\uff08\u5b57\u7b26\u96c6\u518d\u5927\u4e00\u70b9\u70b9\u5c31\u5e9f\u4e86\uff0c$f$\u521a\u597d\u53ef\u4ee5\uff09\u3002\n\n\u9996\u5148\u6211\u4eec\u601d\u8003\u4e00\u4e0b\u53d8\u6362\u7684\u6027\u8d28\u3002\u65b9\u4fbf\u8d77\u89c1\uff0c\u6211\u4eec\u8bb0\u4ee5\u4e0b\u5199\u6cd5$(X,Y$\u5747\u4e3a\u67d0\u4e00\u4e2a\u5b57\u7b26$)$\uff1a\n\n$1. X<Y$\u8868\u793a$X$\u7684\u5b57\u5178\u5e8f\u5c0f\u4e8e$Y$\u7684\u5b57\u5178\u5e8f\uff0c\u5982$a<b$\n\n$2. X-Y$\u8868\u793a\u7531\u5b57\u7b26$X$\u53d8\u6362\u5230\u5b57\u7b26$Y$\u3002\n\n\u7ecf\u8fc7\u4e00\u7cfb\u5217\u601d\u8003\u540e\u53ef\u4ee5\u53d1\u73b0\u4ee5\u4e0b\u6027\u8d28\uff08\u5f53\u7136\u662f\u731c\u60f3\uff0c\u5e76\u4e0d\u4f1a\u4e25\u683c\u8bc1\u660e$QwQ$\uff09\n\n$1.$\u6700\u4f18\u65b9\u6848\u91cc\u4e0d\u5b58\u5728$(X_i-Y_i)(X_i-Y'_i)$\u3002\n\n\u7b80\u5355\u5730\u8bf4\u5c31\u662f\uff0c\u4e00\u4e2a\u5b57\u7b26\u4e0d\u53ef\u80fd\u88ab\u53d8\u6210\u4e24\u4e2a\u4e0d\u540c\u7684\u5b57\u7b26\u3002\u8fd9\u5f88\u663e\u7136\u3002\n\n$2.$\u4e00\u5b9a\u5b58\u5728\u67d0\u4e00\u79cd\u6700\u4f18\u65b9\u6848\uff0c\u4f7f\u5f97\u539f\u5b57\u7b26\u4e32$S$\u5230\u65b0\u5b57\u7b26\u4e32$T$\u7684\u5b57\u7b26\u53d8\u6362\u65b9\u6848\u4e3a$(X_1-Y_1),(X_2-Y_2)...(X_k-Y_k)$\uff0c\u4e14\u5bf9\u4efb\u610f$i\u2208[1,k],X_i<Y_i$\n\n\u7b80\u5355\u5730\u8bf4\u5c31\u662f\uff0c\u6211\u4eec\u53ea\u9700\u8981\u628a\u5c0f\u7684\u5b57\u7b26\u5f80\u5927\u7684\u53d8\uff0c\u4e00\u5b9a\u80fd\u627e\u5230\u4e00\u4e2a\u6700\u4f18\u89e3\u3002\uff08\u5e94\u8be5\u80fd\u611f\u6027\u7406\u89e3\uff09\n\n$3.$\u82e5\u5b58\u5728\u53d8\u6362$(X_i-Y_i)$\uff0c\u5219\u4e00\u5b9a\u5b58\u5728\u67d0\u4e00\u79cd\u6700\u4f18\u65b9\u6848\uff0c\u4f7f\u5f97$(Y_i-Y'_i)$\u4e0d\u5728\u65b9\u6848\u4e4b\u4e2d\u3002\n\n\u7b80\u5355\u5730\u8bf4\u5c31\u662f\uff0c\u5b58\u5728\u4e00\u79cd\u6700\u4f18\u65b9\u6848\uff0c\u4f7f\u5f97\u6ca1\u6709\u4e2d\u4ecb\u5b57\u7b26\uff0c\u4e5f\u5c31\u662f\u88ab\u53d8\u6210\u8fc7\u7684\u5b57\u7b26\u4e0d\u4f1a\u518d\u7ee7\u7eed\u53d8\u6362\u6210\u53e6\u4e00\u79cd\u5b57\u7b26\u3002\n\n\u8fd9\u4e00\u6761\u5176\u5b9e\u5f88\u597d\u8bc1\u660e\uff0c\u56e0\u4e3a$(X_i-Y_i)(Y_i-Y'_i)$\u4e0e$(X_i-Y'_i)(Y_i-Y'_i)$\u7b49\u4ef7\u3002\u9047\u5230\u524d\u9762\u4e00\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u8f6c\u6362\u4e3a\u540e\u9762\u4e00\u79cd\u60c5\u51b5\u3002\n\n$4.$\u4e00\u5b9a\u5b58\u5728\u67d0\u4e00\u79cd\u6700\u4f18\u65b9\u6848\uff0c\u4f7f\u5f97\u539f\u5b57\u7b26\u4e32$S$\u5230\u65b0\u5b57\u7b26\u4e32$T$\u7684\u5b57\u7b26\u53d8\u6362\u65b9\u6848\u4e3a$(X_1-Y_1),(X_2-Y_2)...(X_k-Y_k)$\uff0c\u4e14\u5bf9\u4efb\u610f$i\u2208[1,k-1],X_i<X_{i+1}$\n\n\u7b80\u5355\u5730\u8bf4\u5c31\u662f\uff0c\u5148\u53d8\u5c0f\u7684\u5b57\u7b26\uff0c\u518d\u53d8\u5927\u7684\u5b57\u7b26\u3002\n\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c$dfs$\uff0c\u6765\u66b4\u529b\u679a\u4e3e\u53d8\u6362\u65b9\u6848\u3002\u7531\u4e8e\u6709\u4ee5\u4e0a\u4e09\u79cd\u6027\u8d28\uff0c\u5e76\u4e14\u5b57\u7b26\u96c6\u5927\u5c0f\u53ea\u6709$6$\uff0c\u56e0\u6b64\u60c5\u51b5\u4e0d\u4f1a\u5f88\u591a\uff0c\u5dee\u4e0d\u591a\u6709$300$\u591a\u79cd\u3002\n\n----------------------------------------\n\u7136\u540e\u6211\u4eec\u8003\u8651\u600e\u4e48\u7edf\u8ba1\u7b54\u6848\u3002\u6211\u4eec\u5047\u8bbe\u73b0\u5728\u7684\u53d8\u6362\u65b9\u6848\u4e3a$(X_1,Y_1),(X_2,Y_2)...(X_k,Y_k)$\uff0c\u663e\u7136$k\u22645$\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u5b57\u7b26\u4e32\u54c8\u5e0c\u7684\u65b9\u6cd5\u6765\u5339\u914d\u3002\u6bcf\u8fdb\u884c\u4e00\u6b21\u53d8\u6362\uff0c\u6211\u4eec\u4fee\u6539\u4e00\u904d$S$\u7684\u54c8\u5e0c\u503c\u548c$T$\u7684\u54c8\u5e0c\u503c\uff0c\u7136\u540e\u5faa\u73af\u4e00\u904d\u8fdb\u884c\u5224\u65ad\uff0c\u4e0e\u5f53\u524d\u8fd9\u4f4d\u7684\u7b54\u6848\u53d6\u4e2a$min$\u5373\u53ef\u3002\u8fd9\u4e00\u90e8\u5206\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(n)$\uff0c \u4f46\u5e38\u6570\u6709\u70b9\u5927\u3002\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(Tn)$\uff0c\u5176\u4e2d$T$\u4e3a\u53d8\u6362\u7684\u65b9\u6848\u6570\u3002\n\n\u7136\u800c\u6211\u4eec\u53d1\u73b0\uff0c\u968f\u7740\u5b57\u7b26\u96c6\u589e\u5927\uff0c$T$\u4e5f\u4f1a\u589e\u5927\uff0c\u56e0\u6b64\u6b64\u505a\u6cd5\u4ec5\u9002\u5408\u672c\u9898\u7684\u6570\u636e\u8303\u56f4$QwQ$\uff08\u6211\u679c\u7136\u592a\u83dc\u4e86\uff09\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ull unsigned long long\nconst int N=2e5,p=233;\n\nchar s[N],t[N],to[10];\nbool vis[10];\nint ans,lens,lent,S[N],T[N],Ans[N];\null Pow[N],Hash[N];\n\null getS(int l,int r)\n{\n\treturn Hash[r]-Hash[l-1]*Pow[r-l+1];\n}\n\nvoid Calc()\n{\n\tint w=0;\n\tfor (int i=1;i<=lens;i++) S[i]=s[i-1]-'a';\n\tfor (int i=1;i<=lent;i++) T[i]=t[i-1]-'a';\n\tHash[1]=S[1];ull sum=T[1];\n\tfor (int i=2;i<=lens;i++) Hash[i]=Hash[i-1]*p+S[i];\n\tfor (int i=2;i<=lent;i++) sum=sum*p+T[i];\n\tfor (int i=1;i<=lens-lent+1;i++)\n\t\tif (getS(i,i+lent-1)==sum) Ans[i]=0; //\u522b\u5fd8\u4e86\u539f\u6570\u7ec4\n\tfor (char ch='a';ch<='e';ch++)\n\t\tif (to[ch-'a']>-1)\n\t\t{\n\t\t\t++w;\n\t\t\tfor (int i=1;i<=lens;i++) if (S[i]==ch-'a') S[i]=to[S[i]];\n\t\t\tfor (int i=1;i<=lent;i++) if (T[i]==ch-'a') T[i]=to[T[i]];\n\t\t\tHash[1]=S[1];sum=T[1];\n\t\t\tfor (int i=2;i<=lens;i++) Hash[i]=Hash[i-1]*p+S[i];\n\t\t\tfor (int i=2;i<=lent;i++) sum=sum*p+T[i];\n\t\t\tfor (int i=1;i<=lens-lent+1;i++)\n\t\t\t\tif (getS(i,i+lent-1)==sum) Ans[i]=min(Ans[i],w);\n\t\t} //\u6bcf\u4e00\u6b21\u53d8\u6362\u90fd\u8981\u54c8\u5e0c\u4e00\u904d\n}\n\nvoid dfs(char c)\n{\n\tif (c=='f') {Calc();return;}\n\tto[c-'a']=-1;dfs(c+1);\n\tif (vis[c-'a']) return;\n\tfor (char ch=c+1;ch<='f';ch++)\n\t{\n\t\tvis[ch-'a']=true;to[c-'a']=ch-'a';\n\t\tdfs(c+1);vis[ch-'a']=false;to[c-'a']=-1;\n\t}\n} //\u679a\u4e3e\u65b9\u6848\n\nint main()\n{\n\tfreopen(\"a.in\",\"r\",stdin);\n\tfreopen(\"a.out\",\"w\",stdout);\n\tscanf(\"%s\",&s);lens=strlen(s);\n\tmemset(Ans,1,sizeof(Ans));\n\tPow[0]=1;\n\tfor (int i=1;i<=lens;i++) Pow[i]=Pow[i-1]*p;\n\tscanf(\"%s\",&t);lent=strlen(t);\n\tdfs('a');\n\tfor (int i=1;i<=lens-lent+1;i++) printf(\"%d \",Ans[i]);\n}\n```\n",
        "postTime": 1570852016,
        "uid": 29575,
        "name": "Holy_Push",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF954I \u3010Yet Another String Matching Problem\u3011"
    },
    {
        "content": "\u8003\u8651\u5982\u679c\u53ea\u6709\u4e24\u4e2a\u4e32\u600e\u4e48\u505a\uff0c\u80af\u5b9a\u662f\u4ece\u5de6\u5230\u53f3\u626b\u4e00\u904d\uff0c\u5982\u679c\u67d0\u4e24\u4e2a\u5b57\u7b26\u4e0d\u76f8\u540c\uff0c\u5219\u7528\u5e76\u67e5\u96c6\u5224\u65ad\u662f\u5426\u5728\u540c\u4e00\u4e2a\u96c6\u5408\u91cc\uff0c\u5982\u679c\u4e0d\u5728\u5219\u52a0\u5165\u540c\u4e00\u4e2a\u96c6\u5408\u5e76\u4e14\u7b54\u6848\u52a0$1$\u3002\n\n\u8003\u8651\u679a\u4e3e\u4e24\u4e2a\u4e0d\u540c\u7684\u5b57\u7b26\u770b\u5b83\u4eec\u662f\u5426\u8fde\u8fb9\u3002\u679a\u4e3e\u4e24\u4e2a\u4e0d\u540c\u7684\u5b57\u7b26\uff0c\u5c06$S$\u4e2d$x$\u5b57\u7b26\u51fa\u73b0\u7684\u4f4d\u7f6e\u8bbe\u4e3a$1$\uff0c$T$\u4e2d$y$\u5b57\u7b26\u51fa\u73b0\u7684\u4f4d\u7f6e\u8bbe\u4e3a$1$\u3002\n\n\u5047\u8bbe\u5728$S$\u7684\u4f4d\u7f6e$a$\u4e0e$T$\u7684\u4f4d\u7f6e$b$\u5747\u4e3a$1$\u3002\u90a3\u4e48\u610f\u5473\u7740\u5728\u4e24\u4e32\u672b\u5c3e\u5339\u914d\u5230$a+|T|-b$\u65f6\uff0c\u5b57\u7b26$x$\u5411$y$\u8fde\u4e86\u4e00\u6761\u8fb9\uff0c\u5c06$T$\u53cd\u8f6c\uff0c\u4e0a\u5f0f\u8f6c\u5316\u4e3a\u5377\u79ef\u7684\u5f62\u5f0f\uff0cFFT\u5373\u53ef\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int maxn = 125005 * 5;\n\nint n, m;\nchar s[maxn], t[maxn];\nint v1[maxn], v2[maxn], f[maxn][6], ans[maxn];\n\ninline int gi()\n{\n\tchar c = getchar();\n\twhile (c < '0' || c > '9') c = getchar();\n\tint sum = 0;\n\twhile ('0' <= c && c <= '9') sum = sum * 10 + c - 48, c = getchar();\n\treturn sum;\n}\n\nnamespace FFT\n{\n\n\tconst double pi = acos(-1);\n\ttypedef complex<double> cpx;\n\t\n\tint n, len, L, R[maxn];\n\tcpx A[maxn], B[maxn];\n\n\tvoid FFT(cpx *a, int f)\n\t{\n\t\tfor (int i = 0; i < n; ++i) if (i < R[i]) swap(a[i], a[R[i]]);\n\t\tfor (int i = 1; i < n; i <<= 1) {\n\t\t\tcpx wn(cos(pi / i), sin(f * pi / i)), t;\n\t\t\tfor (int j = 0; j < n; j += (i << 1)) {\n\t\t\t\tcpx w(1, 0);\n\t\t\t\tfor (int k = 0; k < i; ++k, w = w * wn) {\n\t\t\t\t\tt = a[j + i + k] * w;\n\t\t\t\t\ta[j + i + k] = a[j + k] - t;\n\t\t\t\t\ta[j + k] = a[j + k] + t;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\tvoid mul(int *a, int *b, int len1, int len2, int *c)\n\t{\n\t\tL = 0;\n\t\tfor (n = 1, len = len1 + len2 - 1; n < len; n <<= 1) ++L;\n\t\t--L;\n\t\tfor (int i = 0; i < n; ++i) R[i] = (R[i >> 1] >> 1) | ((i & 1) << L);\n\n\t\tfill(A, A + n, 0); fill(B, B + n, 0);\n\t\tfor (int i = 0; i < len1; ++i) A[i] = a[i];\n\t\tfor (int i = 0; i < len2; ++i) B[i] = b[i];\n\t\tFFT(A, 1); FFT(B, 1);\n\t\tfor (int i = 0; i < n; ++i) A[i] *= B[i];\n\t\tFFT(A, -1);\n\n\t\tfor (int i = 0; i < len1; ++i) c[i] = (int)(A[i].real() / n + 0.5);\n\t}\n\n}\n\ninline int find(int *f, int x)\n{\n\tif (f[x] == x) return x;\n\treturn f[x] = find(f, f[x]);\n}\n\nvoid solve(int c1, int c2)\n{\n\tfor (int i = 0; i < n; ++i) v1[i] = s[i] == 'a' + c1;\n\tfor (int i = 0; i < m; ++i) v2[i] = t[i] == 'a' + c2;\n\treverse(v2, v2 + m);\n\n\tFFT::mul(v1, v2, n, m, v1);\n\n\tfor (int i = 0; i < n; ++i) {\n\t\tif (!v1[i]) continue;\n\t\tif (find(f[i], c1) != find(f[i], c2)) f[i][f[i][c1]] = f[i][c2], ++ans[i];\n\t}\n}\n\nint main()\n{\n\tfreopen(\"string.in\", \"r\", stdin);\n\tfreopen(\"string.out\", \"w\", stdout);\n\n\tscanf(\"%s\\n\", s); n = strlen(s);\n\tscanf(\"%s\\n\", t); m = strlen(t);\n\t\n\tfor (int i = 0; i < n; ++i)\n\t\tfor (int j = 0; j < 6; ++j) f[i][j] = j;\n\n\tfor (int i = 0; i < 6; ++i)\n\t\tfor (int j = 0; j < 6; ++j) {\n\t\t\tif (i == j) continue;\n\t\t\tsolve(i, j);\n\t\t}\n\t\t\t\n\tfor (int i = m - 1; i < n; ++i) printf(\"%d \", ans[i]);\n\tputs(\"\");\n\t\n\treturn 0;\n}\n```",
        "postTime": 1545115816,
        "uid": 119899,
        "name": "dsidsi",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF954I \u3010Yet Another String Matching Problem\u3011"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF954I)\n\n[\u53ef\u80fd\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://chenyu-w.github.io./2023/02/12/CF954I%20Yet%20Another%20String%20Matching%20Problem/)\n\n\u4f60\u7ba1\u8fd9\u53eb *2200\uff1f\n\n\n## \u524d\u8a00\n\n\u9996\u5148\u8003\u8651\u7b54\u6848\u5b9e\u8d28\u4e0a\u662f\u4ec0\u4e48\uff0c\u5bf9\u6bcf\u79cd\u5b57\u7b26\u5206\u522b\u5efa\u4e00\u4e2a\u70b9\uff0c\u7136\u540e\u5728\u6709\u51b2\u7a81(\u5373\u76f8\u540c\u4f4d\u7f6e)\u7684\u5b57\u7b26\u4e4b\u95f4\u8fde\u8fb9\uff0c\u90a3\u4e48\u6211\u4eec\u6539\u53d8\u4e00\u4e2a\u8fde\u901a\u5757\u8981\u53d8\u6362\u8fde\u901a\u5757\u5927\u5c0f $-1$ \u6b21\uff0c\u7136\u540e\u6211\u4eec\u628a\u6240\u6709\u8fde\u901a\u5757\u6c42\u548c\u5373\u53ef\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u6b21\u6570\u7b49\u4e8e\u5e76\u67e5\u96c6\u7684\u5408\u5e76\u6b21\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa\u90a3\u4e9b\u5b57\u7b26\u4e4b\u95f4\u6709\u8fb9\u5373\u53ef\u3002\n\n\u8bb0 $g_{i, j, k}$ \u8868\u793a\u5728\u533a\u95f4 $[i, i + |t| - 1]$ \u5b57\u7b26 $j, k$ \u662f\u5426\u4ea7\u751f\u51b2\u7a81\uff0c\u5373 $\\exists x \\in [1, |t|], s_{i + x - 1} = j, t_x = k$\uff0c\u7136\u540e\u6211\u4eec\u8bb0 $a_i$ \u8868\u793a $s_i$ \u662f\u5426\u4e3a $j$\uff0c$b_i$ \u4e3a $t_i$ \u662f\u5426\u4e3a $k$\uff0c\u6734\u7d20\u8f6c\u79fb\u5f97\u5230 $g_{i, j, k} = \\sum_{x = 1}^{|t|} a_{i + x - 1}b_{x}$\uff0c\u7136\u540e\u6211\u4eec\u8ba9 $b_i \\leftarrow b_{|t| - i + 1}$\uff0c\u8fd9\u6837\u5c31\u539f\u5f0f\u5c31\u53d8\u4e3a\u4e86\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e $j, k$ \u7136\u540e\u7528 $O(n \\log n)$ \u7684\u590d\u6742\u5ea6\u8ba1\u7b97 $g_{i, j, k}$\uff0c\u6700\u540e\u7528\u5e76\u67e5\u96c6\u7edf\u8ba1\u4e00\u4e0b\u7b54\u6848\u5373\u53ef\u3002\n\n## \u4ee3\u7801\n\n```c++\n#include <bits/stdc++.h>\n#define L(i, j, k) for(int i = (j); i <= (k); i++)\n#define R(i, j, k) for(int i = (j); i >= (k); i--)\n#define G(i, u) for (int i = h[(u)]; ~i; i = ne[i])\n#define ll long long\n#define ld long double\n#define ull unsigned long long\n\nusing namespace std;\nconst int N = 7e5 + 10, mod = 998244353, G = 3;\nchar s[N], t[N];\nint rev[N], a[N], b[N];\nbool has[N][6][6];\nint p[6];\n\ninline int read() {\n    int x = 0, y = 1; char c = getchar();\n    while (c < '0' || c > '9') {if (c == '-') y = -1; c = getchar();}\n    while (c >= '0' && c <= '9') x = x * 10 + c - '0', c = getchar();\n    return x * y;\n}\n\ninline int qpow(int a, int b) {\n    int res = 1;\n    while (b) {\n        if (b & 1) res = 1ll * res * a % mod;\n        a = 1ll * a * a % mod;\n        b >>= 1;\n    }\n    return res;\n}\n\ninline void ntt(int a[], int n, int flg) {\n    L(i, 0, n - 1) if (i < rev[i]) swap(a[i], a[rev[i]]);\n    for (int mid = 1; mid < n; mid <<= 1) {\n        int W = qpow(G, (mod - 1) / (mid << 1));\n        if (flg == -1) W = qpow(W, mod - 2);\n        for (int i = 0; i < n; i += (mid << 1)) {\n            int w = 1;\n            L(j, i, i + mid - 1) {\n                int x = a[j], y = 1ll * w * a[j + mid] % mod;\n                a[j] = (x + y) % mod, a[j + mid] = (x - y + mod) % mod;\n                w = 1ll * w * W % mod;\n            }\n        }\n    } \n}\n\ninline void NTT(int n, int m, int a[], int b[]) {\n    int k = 1, l = 0;\n    while (k <= n + m) k <<= 1, l++;\n    L(i, 0, k - 1) rev[i] = (rev[i >> 1] >> 1) | ((i & 1) << (l - 1));\n    ntt(a, k, 1), ntt(b, k, 1);\n    L(i, 0, k - 1) a[i] = 1ll * a[i] * b[i] % mod;\n    ntt(a, k, -1);\n    int invk = qpow(k, mod - 2);\n    L(i, 0, n + m) a[i] = 1ll * a[i] * invk % mod; \n}\n\ninline int find(int x) {\n    return x == p[x] ? x : p[x] = find(p[x]);\n}\n\nint main() {\n    scanf(\"%s%s\", s + 1, t + 1);\n    int n = strlen(s + 1), m = strlen(t + 1);\n    L(i, 0, 5) L(j, 0, 5) {\n        if (i == j) continue;\n        memset(a, 0, sizeof a);\n        memset(b, 0, sizeof b);\n        L(k, 1, n) a[k] = s[k] - 'a' == i;\n        L(k, 1, m) b[m - k + 1] = t[k] - 'a' == j;\n        NTT(n, m, a, b);\n        L(k, 1, n - m + 1) has[k][i][j] = a[k + m];\n    }\n    L(i, 1, n - m + 1) {\n        int res = 0;\n        L(j, 0, 5) p[j] = j;\n        L(j, 0, 5) L(k, 0, 5) {\n            if (j == k || !has[i][j][k]) continue;\n            int pj = find(j), pk = find(k);\n            if (pj == pk) continue;\n            res++, p[pj] = pk;\n        }\n        printf(\"%d \", res);\n    }\n    return 0;\n}\n```",
        "postTime": 1676209064,
        "uid": 587248,
        "name": "wcywcywcywcy",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011CF954I"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u4e2a\u7a0d\u5fae\u7b80\u5355\u7684\u601d\u8def\uff1a\n\n\u7531\u4e8e\u5b57\u7b26\u96c6\u5927\u5c0f\u5f88\u5c0f\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u5c06\u54ea\u4e9b\u5b57\u7b26\u89c6\u4e3a\u540c\u4e00\u79cd\u3002\n\n\u8fd9\u76f8\u5f53\u4e8e**\u679a\u4e3e\u5b50\u96c6**\uff0c\u65b9\u6848\u6570\u4e0a\u9650\u4e3a3^6=729\uff0c\u5b9e\u6d4b\u4e3a\u5171203\u79cd\u5408\u6cd5\u5b50\u96c6\u3002\n\n\u4e4b\u540e\u5c06\u5b57\u7b26\u4e32\u4e2d\u89c6\u4e3a\u540c\u4e00\u79cd\u7684\u5b57\u7b26\u6574\u4f53\u66ff\u6362\u5e76\u7528KMP\u6216\u8005\u86e4\u5e0c\u66f4\u65b0\u7b54\u6848\u3002\n\n\u590d\u6742\u5ea6\u4e3a203\u6b21KMP\u6216Hash\u7684\u5355\u6a21\u5f0f\u4e32\u5339\u914d\uff0c\u5373O(203*(|S|+|T|))\uff0c\u5927\u7ea6\u4e3aO(3e7)\u3002\n\n\u5b9e\u6d4b\u76ee\u524d\u8c37\u5185\u6700\u5feb\uff08\u5355\u70b9156ms\uff09\u3002\n\n~~\u4e0d\u7528\u5199FFT\u4e86QaQ~~\n\n\u4ee5\u4e0b\u4e3a\u4ee3\u7801\uff1a\n```cpp\n#include<cstdio>\ntypedef unsigned long long ull;\nconst ull bas=283476131;\null hash[222222],k[222222];\nchar str[222222],ttt[222222];               //S\u3001T\nchar ref[2222];                             //ref[c]\u8868\u793a\u5b57\u7b26c\u88ab\u66ff\u6362\u6210\u7684\u5b57\u7b26\nint best[222222];   \ninline ull gethash(int l,int r)             //Hash\n{return hash[r]-hash[l-1]*k[r-l+1];}\nint a[11];\nint cnt,l,ls;\ninline void exec(int dep)\n{\n\tint k=7-dep;\n\tregister int i;\n\tfor(i=1;i<=6;i++)ref[i+96]=a[i]+96;\n\tfor(i=1;str[i];i++)\n\t\thash[i]=hash[i-1]*bas+ref[str[i]];  //\u66ff\u6362\u540e\u7684\u5b57\u7b26\u4e32S (\u5373ref[str[i]])\n\tl=i-1;\n\tull key=0;\n\tfor(i=1;ttt[i];i++)\n\t\t(key*=bas)+=ref[ttt[i]];            //\u66ff\u6362\u540e\u7684\u5b57\u7b26\u4e32T (\u5373ref[ttt[i]])\n\tls=i-1;\n\tfor(i=1;i+ls-1<=l;i++)\n\t\tif(key==gethash(i,i+ls-1))\n\t\t\tif(best[i]>k)best[i]=k;         //\u66f4\u65b0\u7b54\u6848\uff08\u5982\u679c\u66ff\u6362\u540e\u5339\u914d\uff09\n\t\t\t\n}\nvoid dfs(int dep=1,int beg=1)               //\u679a\u4e3e\u5b50\u96c6\uff08\u5199\u5f97\u5f88\u4e11\uff09\n{\n\tif(beg>6)\n\t{exec(dep);return;}\n\ta[beg]=dep;\n\tint b[11];\n\tregister int i,ii;\n\tfor(i=1;i<=6;i++)b[i]=a[i];\n\tfor(i=0;i<(1<<6);i++)\n\t{\n\t\tfor(ii=1;ii<=beg;ii++)\n\t\t\tif(i&(1<<(ii-1)))goto T;\n\t\tfor(ii=beg+1;ii<=6;ii++)\n\t\t\tif(i&(1<<(ii-1)))\n\t\t\t\tif(a[ii])goto T;\n\t\tfor(ii=beg+1;ii<=6;ii++)\n\t\t\tif(i&(1<<(ii-1)))\n\t\t\t\ta[ii]=dep;\n\t\tfor(ii=beg+1;ii<=7;ii++)\n\t\t\tif(!a[ii])break;\n\t\tdfs(dep+1,ii);\n\t\tfor(ii=1;ii<=6;ii++)a[ii]=b[ii];\n\t\tT:;\n\t}\n}\nint main()\n{\n\tscanf(\"%s%s\",str+1,ttt+1);\n\tregister int i;\n\tfor(i=1;i<=125555;i++)best[i]=5;\n\tk[0]=1;\n\tfor(i=1;i<=125555;i++)k[i]=k[i-1]*bas;\n\tdfs();\n\tfor(i=1;i+ls-1<=l;i++)\n\t\tprintf(\"%d%c\",best[i],(l^(i+ls-1))?' ':'\\n');\n}\n```",
        "postTime": 1570361723,
        "uid": 85053,
        "name": "namespace_std",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF954I \u3010Yet Another String Matching Problem\u3011"
    },
    {
        "content": "\u5148\u5047\u88c5\u8bc1\u660e\u4e00\u4e0b\u8d2a\u5fc3\u7684\u6b63\u786e\u6027\uff0c\u5982\u679c\u4e00\u4e2a\u4f4d\u7f6e\u4e24\u4e2a\u4e32\u989c\u8272\u4e0d\u4e00\u6837\uff0c\u90a3\u4e48\u6211\u4eec\u8fdf\u65e9\u8981\u6709\u4e00\u4e2a\u64cd\u4f5c\u628a\u8fd9\u4e24\u79cd\u5b57\u7b26\u53d8\u6210\u540c\u4e00\u79cd\u3002\u4e0d\u7136\u5c31\u8981\u501f\u52a9\u7b2c\u4e09\u79cd\u989c\u8272\u53d8\u4e24\u6b21\uff0c\u6240\u4ee5\u4e00\u5b9a\u6ca1\u6709\u6bd4\u8fd9\u79cd\u8d2a\u5fc3\u66f4\u4f18\u7684\u65b9\u6cd5\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u4f4d\u7f6e\u5c5e\u4e8e$x\\in [0,n-m]$\uff0c\u6211\u53ea\u8981\u77e5\u9053\u5b83\u540e\u9762m\u4e2a\u5b57\u7b26\u4e2d\u6709\u6ca1\u6709\u989c\u8272p\uff0cq\u5bf9\u5e94\uff08\u5373\u6709\u4e00\u4e2a\u4f4d\u7f6ei\uff0c$a_i=p,b_{i+x-1}=q$\uff09\uff0c\u5c31\u53ef\u4ee5\u786e\u5b9a\u8981\u4e0d\u8981\u628a\u989c\u8272p,q\u5408\u5e76\u8d77\u6765\uff08\u5982\u679cp\u548cq\u4e4b\u524d\u6ca1\u6709\u88ab\u5408\u5e76\u7684\u8bdd\uff0c\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u4e00\u4e0b\uff09\uff0c\u8fdb\u800c\u4e5f\u53ef\u4ee5\u7b97\u51fa\u5728x\u4f4d\u7f6e\u7684\u7b54\u6848\u3002\n\n\u90a3\u4e48\u6211\u53ea\u8981\u6c42\u51fa$[x,x+m-1]$\u4e2d\u6709\u6ca1\u6709\u989c\u8272p\uff0cq\u7684\u5bf9\u5e94\u5c31\u597d\u4e86\u3002\n\n\u8fd9\u4e2a\u53ef\u4ee5\u7528\u591a\u9879\u5f0f\u4e58\u6cd5\u505a\uff0c\u679a\u4e3ep\uff0cq\uff0c\u5c06a\u4e2dp\u51fa\u73b0\u7684\u4f4d\u7f6e\u8d4b\u62101\uff08\u591a\u9879\u5f0fa\uff09\uff0cb\u4e2dq\u51fa\u73b0\u7684\u4f4d\u7f6e\u8d4b\u62101\uff08\u591a\u9879\u5f0fb\uff09\uff0c\u5c06\u591a\u9879\u5f0fa\u7ffb\u8f6c\u540e\u548c\u591a\u9879\u5f0fb\u4e58\u8d77\u6765\u5373\u53ef\uff0c\u8fd9\u662fFFT\u89e3\u51b3\u5b57\u7b26\u4e32\u5339\u914d\u95ee\u9898\u7684\u5957\u8def\u3002\n\n```c++\n#include<cmath>\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#define maxn 500000\nusing namespace std;\nconst double Pi=acos(-1.0);\nstruct complex{\n\tdouble x,y;\n\tcomplex (double xx=0,double yy=0){x=xx,y=yy;}\n}a[maxn],b[maxn],c[maxn];\nint fa[7],n,m,lim,r[maxn],e[maxn][6][6],l,ans;\nchar ch1[maxn],ch2[maxn];\ncomplex operator + (complex a,complex b){return complex(a.x+b.x,a.y+b.y);}\ncomplex operator - (complex a,complex b){return complex(a.x-b.x,a.y-b.y);}\ncomplex operator * (complex a,complex b){return complex(a.x*b.x-a.y*b.y,a.x*b.y+a.y*b.x);}\ninline void FFT(complex *a,int inv){\n\tfor (int i=0; i<lim; i++)\n\t\tif (i<r[i]) swap(a[i],a[r[i]]);\n\tfor (int i=1; i<lim; i<<=1){\n\t\tcomplex wn(cos(Pi/i),inv*sin(Pi/i));\n\t\tfor (int j=0; j<lim; j+=(i<<1)){\n\t\t\tcomplex w(1,0);\n\t\t\tfor (int k=0; k<i; k++,w=w*wn){\n\t\t\t\tcomplex x=a[j+k],y=w*a[j+i+k];\n\t\t\t\ta[j+k]=x+y; a[i+j+k]=x-y;\n\t\t\t}\n\t\t}\n\t}\n}\nint find(int x){\n\tif (fa[x]!=x) fa[x]=find(fa[x]);\n\treturn fa[x];\n}\nint main(){\n\tscanf(\"%s\",ch1); n=strlen(ch1);\n\tscanf(\"%s\",ch2); m=strlen(ch2);\n\tlim=1; while (lim<=n+m) lim<<=1,l++;\n\tfor (int i=0; i<lim; i++)\n\t\tr[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\tfor (int p=0; p<6; p++)\n\tfor (int q=0; q<6; q++){\n\t\tif (p==q) continue;\n\t\tfor (int i=0; i<lim; i++) a[i]=b[i]=complex(0,0);\n\t\tfor (int i=0; i<m; i++) a[m-1-i].x=(ch2[i]==p+'a');\n\t\tfor (int i=0; i<n; i++) b[i].x=(ch1[i]==q+'a');\n\t\tFFT(a,1); FFT(b,1);\n\t\tfor (int i=0; i<=lim; i++) c[i]=a[i]*b[i];\n\t\tFFT(c,-1);\n//\t\tprintf(\"\\n%d %d\\n\",p,q);\n\t\tfor (int i=m-1; i<n; i++){\n\t\t\te[i-m+1][p][q]=(int)(c[i].x/lim+0.5);\n//\t\t\tprintf(\"%d \",e[i-m+1][p][q]);\n\t\t}\n\t}\n\tfor (int k=0; k<=n-m; k++){\n\t\tfor (int i=0; i<6; i++) fa[i]=i;\n\t\tans=0;\n\t\tfor (int p=0; p<6; p++)\n\t\t\tfor (int q=0; q<6; q++){\n\t\t\t\tif (p==q) continue;\n\t\t\t\t// printf(\"k:%d p:%d q:%d %d\\n\",k,p,q,e[k][p][q]);\n\t\t\t\tif (!e[k][p][q]) continue;\n\t\t\t\tint x=find(p),y=find(q);\n\t\t\t\tif (x!=y) fa[x]=y,ans++;\n\t\t\t}\n\t\t// for (int i=0; i<6; i++)\n\t\t\t// if (find(i)!=i) ans++;\n\t\tprintf(\"%d \",ans);\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1559397286,
        "uid": 63661,
        "name": "Taduro",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF954I \u3010Yet Another String Matching Problem\u3011"
    }
]
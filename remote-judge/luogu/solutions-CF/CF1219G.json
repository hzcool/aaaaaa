[
    {
        "content": "[Harvester\u9898\u9762](https://www.luogu.com.cn/problem/CF1219G)\n\n\u4e2a\u4eba\u611f\u89c9\u8fd9\u9898\u5728\u7eff\u9898\u8303\u56f4\n\n## \u9898\u9762\u63cf\u8ff0\n\nn * m\u7684\u7f51\u683c\u4e2d\uff0c\u5728\u7b2ci\u884cj\u5217\u6709a[i][j]\u4e2a\u6ce1\u6ce1\uff0c\u6bcf\u6b21\u53ef\u4ee5\u6536\u5272\u4e00\u884c\u6216\u4e00\u5217\u7684\u6ce1\u6ce1\uff0c\u6700\u591a\u53ef\u4ee5\u6536\u52724\u6b21\uff0c\u95ee\u6700\u591a\u53ef\u4ee5\u6536\u5272\u5230\u591a\u5c11\u6ce1\u6ce1\u3002\n\n## \u5206\u6790\n\n#### 1.\u9519\u8bef\u7684\u60f3\u6cd5\u2460\n\n\u62ff\u5230\u9898\u9762\uff0c\u6211\u9996\u5148\u7684\u601d\u8def\u662f\u4e00\u4e2a\u7b80\u6613\u7684\u6a21\u62df\uff1a\n\n\u76f4\u63a5\u8bfb\u5165\u4e8c\u7ef4\u6570\u7ec4\uff0c\u9996\u5148\u7528\u524d\u7f00\u548c\u7edf\u8ba1\u6bcf\u4e00\u884c\u548c\u6bcf\u4e00\u5217\u7684\u603b\u548c\n\n```cpp\nfor(ll i=1;i<=n;i++)\n{\n\tfor(ll j=1;j<=m;j++)\n\t{\n\t\tcin>>a[i][j];\n\t\txx[i]+=a[i][j];\n\t\tyy[j]+=a[i][j];\n\t}\n}\n```\n\n\u518d\u5728\u884c\u548c\u5217\u4e2d\u627e\u5230\u5f53\u524d\u6536\u5272\u8d70\u6b64\u884c/\u5217\u540e\u53ef\u4ee5\u5f97\u5230\u6700\u591a\u6ce1\u6ce1\u7684\u884c/\u5217\uff0c\u6bcf\u6b21\u6536\u5272\u8d70\u5c31\u628a\u5b83\u4f1a\u5f71\u54cd\u5230\u7684\u884c/\u5217\u5904\u7406\u4e00\u4e0b\n\n\u5177\u4f53\u4f8b\u5b50\u5982\u7b2c\u4e8c\u4e2a\u6837\u4f8b\n\n5 5\n\n0 9 2 7 0\n\n9 0 3 0 5\n\n0 8 0 3 1\n\n6 7 4 3 9\n\n3 6 4 1 0\n\n\u7b2c\u4e00\u6b21\u6211\u4eec\u62ff\u4e86\u7b2c\u56db\u884c(xx[4])\uff0c\u6240\u4ee5\u8981\u628a\u6240\u6709\u5217\u7684\u524d\u7f00\u548c\u90fd\u51cf\u53bba[4][j],\u4ee5\u9632\u91cd\u590d\u6dfb\u52a0\u3002\n\n\u7136\u540e\u518d\u91cd\u590d\u56db\u6b21\u3002\n\n\u63d0\u4ea4\u540e\uff0c\u60ca\u5947\u5730\u53d1\u73b0\uff0c\u7b2c\u56db\u4e2a\u70b9\u5c31WA\u4e86\uff0cwhy\uff1f\n\n\u8fd9\u79cd\u60f3\u6cd5\u5f88\u663e\u7136\u662f\u9519\u8bef\u7684\uff0c\u5f53\u6211\u4eec\u53d1\u73b0\u67d0\u884c\u53d6\u8d70\u80fd\u5f97\u5230\u5f53\u524d\u7684\u6700\u5927\u503c\uff0c\u7136\u540e\u53d6\u4e86\u8fd9\u884c\u4e4b\u540e\u4f1a\u628a\u6240\u6709\u5217\u90fd\u51cf\u5c0f\uff0c\u4f46\u662f\u6709\u53ef\u80fd\u6b64\u65f6\u53d6\u8981\u591a\u4e2a\u5217\u66f4\u4f18\u3002\u5373\u8fd9\u79cd\u6a21\u62df\u505a\u6cd5\u53ef\u80fd\u4f1a\u5931\u53bb\u6700\u5927\u7684\u7ed3\u679c\n\n#### 2.\u9519\u8bef\u7684\u60f3\u6cd5\u2461\n\n\u65e2\u7136\u4f1a\u5931\u53bb\u67d0\u4e9b\u7ed3\u679c\uff0c\u90a3\u8981\u4e0d\u5c31\u5728\u4e0a\u4e00\u79cd\u4ee3\u7801\u7684\u601d\u8def\u4e0adfs\u628a\u6240\u6709\u80fd\u53d6\u7684\u65b9\u6cd5\u8d70\u4e00\u904d\n\n\u4f46\u662f\uff0c\u663e\u800c\u6613\u89c1\u8fd9\u79cd$O(C_{n+m}^4)$\u7684\u590d\u6742\u5ea6\u4f1a\u70b8\u6389\uff08\u63d0\u4ea4\u540e\u7b2c4\u4e2a\u70b9\u5c31TLE\u4e86\uff09\n\n#### 3.\u6b63\u89e3\n\n\u90a3\u4e48\u8fd9\u6761\u8def\u770b\u8d77\u6765\u5df2\u7ecf\u8d70\u5230\u5934\u4e86\uff0c\u6240\u4ee5\u6b63\u89e3\u8981\u600e\u4e48\u641e\uff01\uff1f\n\n\u4e0d\u59a8\u6362\u4e00\u79cd\u601d\u8def,\u65e2\u7136\u53ea\u6709\u56db\u6b21\u53d6\u6ce1\u6ce1\u7684\u673a\u4f1a\uff0c\u90a3\u53d6\u7684\u65b9\u6848\u5e94\u8be5\u53ea\u67095\u79cd\uff1a\n\n1.\u53d6\u56db\u884c\n\n2.\u53d6\u56db\u5217\n\n3.\u53d6\u4e00\u884c\u4e09\u5217\n\n4.\u53d6\u4e00\u5217\u4e09\u884c\n\n5.\u53d6\u4e24\u884c\u4e24\u5217\n\n\u90a3\u4e48\u6211\u4eec\u53ea\u8981\u77e9\u9635\u4e2d\u5206\u522b\u4ee5\u4ee5\u4e0a5\u79cd\u65b9\u6cd5\u8ba1\u7b97\u4e00\u904d\u53d6\u6700\u5927\u503c\u5c31\u53ef\u4ee5\u4e86\uff01\n\n\u5bf9\u4e8e\u7b2c1\u79cd\u65b9\u6848\uff0c\u53ea\u9700\u628a\u6240\u6709\u884c\u6392\u5e8f\u4e00\u4e0b\u5e76\u628a\u6700\u5927\u7684\u56db\u884c\u52a0\u8d77\u6765\u5c31\u884c\uff08\u5f53\u7136\u4e0d\u6392\u5e8f\u76f4\u63a5\u627e\u6700\u5927\u56db\u884c\u4e5f\u662f\u53ef\u4ee5\u7684\uff09\uff0c\u590d\u6742\u5ea6$O(NlogN)$\u3002\n\n```cpp\nfor(ll i=1;i<=n;i++) xxx[i]=xx[i];\nsort(xxx+1,xxx+n+1,cmp);\nfor(ll i=1;i<=4;i++) sum+=xxx[i];\nll maxx=sum\n```\n\n\u5bf9\u4e8e\u7b2c2\u79cd\u65b9\u6848\uff0c\u540c\u4e0a\u3002\n\n```cpp\nfor(ll i=1;i<=m;i++) yyy[i]=yy[i];\nsort(yyy+1,yyy+m+1,cmp);\nfor(ll i=1;i<=4;i++) sum+=yyy[i];\nmaxx=max(maxx,sum);\n```\n\n\n\u5bf9\u4e8e\u7b2c3\u79cd\u65b9\u6848\uff0c\u5148\u9009\u62e9\u4e00\u884c\uff0c\u518d\u5728\u6240\u6709\u5217\u91cc\u9762\u627e\u6700\u5927\u7684\u4e09\u5217\uff0c\u590d\u6742\u5ea6$O(NM)$\u3002\n\n```cpp\nfor(ll i=1;i<=n;i++)\n\t{\n\t\tll max1=0,max2=0,max3=0;\n\t\tfor(ll j=1;j<=m;j++)\n\t\t{\n\t\t\tyyy[j]=yy[j]-a[(i-1)*m+j];\n\t\t\tif(yyy[j]>=max1) max3=max2,max2=max1,max1=yyy[j]; else \n\t\t\tif(yyy[j]>=max2) max3=max2,max2=yyy[j]; else\n\t\t\tif(yyy[j]>=max3) max3=yyy[j];\n\t\t} \n\t\tsum=max1+max2+max3+xx[i];\n\t\tmaxx=max(maxx,sum);\n\t}\n```\n\n\n\u5bf9\u4e8e\u7b2c4\u79cd\u65b9\u6848\uff0c\u540c\u4e0a\u3002\n\n```cpp\nfor(ll i=1;i<=m;i++)\n\t{\n\t\tll max1=0,max2=0,max3=0;\n\t\tfor(ll j=1;j<=n;j++)\n\t\t{\n\t\t\txxx[j]=xx[j]-a[(j-1)*m+i];\n\t\t\tif(xxx[j]>=max1) max3=max2,max2=max1,max1=xxx[j]; else \n\t\t\tif(xxx[j]>=max2) max3=max2,max2=xxx[j]; else\n\t\t\tif(xxx[j]>=max3) max3=xxx[j];\n\t\t} \n\t\tsum=max1+max2+max3+yy[i];\n\t\tmaxx=max(maxx,sum);\n\t}\n```\n\n\n\u5bf9\u4e8e\u7b2c5\u79cd\u65b9\u6848\uff0c\u5148\u7528\u4e24\u4e2a\u5faa\u73af\u56fa\u5b9a\u4e24\u884c\uff0c\u518d\u5728\u6240\u6709\u5217\u91cc\u9762\u627e\u6700\u5927\u7684\u4e24\u5217\uff0c\u590d\u6742\u5ea6$O(N^2M)$\n\n```cpp\nfor(ll i=1;i<n;i++)\n \t{\n \t\tfor(ll j=i+1;j<=n;j++)\n \t\t{\n \t\t\tll max1=0,max2=0;\n \t\t\tfor(ll k=1;k<=m;k++)\n \t\t\t{\n \t\t\t\tyyy[k]=yy[k]-a[(i-1)*m+k]-a[(j-1)*m+k];\n\t\t\t\tif(yyy[k]>=max1) max2=max1,max1=yyy[k]; else \n\t\t\t\tif(yyy[k]>=max2) max2=yyy[k]; \n\t\t\t}\n\t\t\tsum=max1+max2+xx[i]+xx[j];\n\t\t\tmaxx=max(maxx,sum);\n\t\t}\n\t}\n```\n\n\n\u5728\u4e0a\u9762\u4e94\u79cd\u65b9\u6848\u91cc\u9009\u6700\u5927\u7684\u90a3\u4e2a\u5c31\u662f\u7b54\u6848\u4e86\n\n## \u672c\u9898\u6ce8\u610f\u70b9\n\n1.\u56e0\u4e3a$n*m<=10^5$ \uff0c\u6240\u4ee5\u8fd9\u91cc\u53ef\u4ee5\u628a\u4e8c\u7ef4\u6570\u7ec4\u538b\u6210\u4e00\u7ef4\u6765\u50a8\u5b58\uff0c\u628a\u539f\u6765\u7684$a[i][j]$\u50a8\u5b58\u5728$a[(i-1)*m+j]$\u4e2d\n\n```cpp\nfor(ll i=1;i<=n;i++)\n\tfor(ll j=1;j<=m;j++)\n\t{\n\t\tcin>>a[(i-1)*m+j];\n\t\txx[i]+=a[(i-1)*m+j];\n\t\tyy[j]+=a[(i-1)*m+j];\n\t}\n```\n2.\u5bf9\u4e8e\u7b2c\u4e94\u79cd\u65b9\u6848$O(N*N*M)$\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u5f88\u53ef\u80fd\u4f1a\u8d85\u65f6\uff08\u5b9e\u6d4b\u7b2c6\u4e2a\u70b9TLE\u4e86\uff09\u3002\n\n\u6240\u4ee5\u5728n>m \u65f6\uff0c\u6211\u4eec\u628a\u6574\u4e2a\u6570\u7ec4\u65cb\u8f6c90\u00b0\uff0c\u5373\u628anm\u4e92\u6362\u3002\n\n\n```cpp\nif(n>m)\n\t{ \n\t\tfor(ll i=1;i<=n;i++)\n\t\t\tfor(ll j=1;j<=m;j++)\n\t\t\t\tb[(j-1)*n+i]=a[(i-1)*m+j];\n\t\tswap(n,m);\n\t\tfor(ll i=1;i<=n;i++)\n\t\t\tfor(ll j=1;j<=m;j++)\n\t\t\t\ta[(i-1)*m+j]=b[(i-1)*m+j];\n\t}\n```\n\n## \u5b8c\u6574\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll maxn=100010;\nunsigned long long ans,anss;\nll n,m;\nll xx[maxn],yy[maxn],xxx[maxn],yyy[maxn],a[maxn],b[maxn];\nll tt[5],rt[5];\nbool cmp(ll x,ll y) {return x>y;}\nll work()\n{\n\tll sum=0;\n\tfor(ll i=1;i<=n;i++) xxx[i]=xx[i];\n\tsort(xxx+1,xxx+n+1,cmp);\n\tfor(ll i=1;i<=4;i++) sum+=xxx[i];\n\tll maxx=sum;\n\tsum=0;\n//\tcout<<maxx<<endl;\n\t\n\tfor(ll i=1;i<=m;i++) yyy[i]=yy[i];\n\tsort(yyy+1,yyy+m+1,cmp);\n\tfor(ll i=1;i<=4;i++) sum+=yyy[i];\n\tmaxx=max(maxx,sum);\n\tsum=0;\n//\tcout<<maxx<<endl;\n\t\n\tfor(ll i=1;i<=n;i++)\n\t{\n\t\tll max1=0,max2=0,max3=0;\n\t\tfor(ll j=1;j<=m;j++)\n\t\t{\n\t\t\tyyy[j]=yy[j]-a[(i-1)*m+j];\n\t\t\tif(yyy[j]>=max1) max3=max2,max2=max1,max1=yyy[j]; else \n\t\t\tif(yyy[j]>=max2) max3=max2,max2=yyy[j]; else\n\t\t\tif(yyy[j]>=max3) max3=yyy[j];\n\t\t} \n\t\tsum=max1+max2+max3+xx[i];\n\t\tmaxx=max(maxx,sum);\n\t}\n\tsum=0;\n//\tcout<<maxx<<endl;\n\t\n\tfor(ll i=1;i<=m;i++)\n\t{\n\t\tll max1=0,max2=0,max3=0;\n\t\tfor(ll j=1;j<=n;j++)\n\t\t{\n\t\t\txxx[j]=xx[j]-a[(j-1)*m+i];\n\t\t\tif(xxx[j]>=max1) max3=max2,max2=max1,max1=xxx[j]; else \n\t\t\tif(xxx[j]>=max2) max3=max2,max2=xxx[j]; else\n\t\t\tif(xxx[j]>=max3) max3=xxx[j];\n\t\t} \n\t\tsum=max1+max2+max3+yy[i];\n\t\tmaxx=max(maxx,sum);\n\t}\n\tsum=0;\n//\tcout<<maxx<<endl;\n\t\n\tif(n>m)\n\t{ \n\t\tfor(ll i=1;i<=n;i++)\n\t\t\tfor(ll j=1;j<=m;j++)\n\t\t\t\tb[(j-1)*n+i]=a[(i-1)*m+j];\n\t\tswap(n,m);\n\t\tfor(ll i=1;i<=n;i++)\n\t\t\tfor(ll j=1;j<=m;j++)\n\t\t\t\ta[(i-1)*m+j]=b[(i-1)*m+j];\n\t}\n \tfor(ll i=1;i<n;i++)\n \t{\n \t\tfor(ll j=i+1;j<=n;j++)\n \t\t{\n \t\t\tll max1=0,max2=0;\n \t\t\tfor(ll k=1;k<=m;k++)\n \t\t\t{\n \t\t\t\tyyy[k]=yy[k]-a[(i-1)*m+k]-a[(j-1)*m+k];\n\t\t\t\tif(yyy[k]>=max1) max2=max1,max1=yyy[k]; else \n\t\t\t\tif(yyy[k]>=max2) max2=yyy[k]; \n\t\t\t}\n//\t\t\tcout<<max1<<' '<<max2<<' '<<xx[i]<<' '<<xx[j]<<endl;\n\t\t\tsum=max1+max2+xx[i]+xx[j];\n\t\t\tmaxx=max(maxx,sum);\n\t\t}\n\t}\n\treturn maxx;\n}\nint main()\n{\n\tios::sync_with_stdio(false);\n\tcin>>n>>m;\n\tfor(ll i=1;i<=n;i++)\n\t{\n\t\tfor(ll j=1;j<=m;j++)\n\t\t{\n\t\t\tcin>>a[(i-1)*m+j];\n\t\t\txx[i]+=a[(i-1)*m+j];\n\t\t\tyy[j]+=a[(i-1)*m+j];\n\t\t}\n\t}\n\tcout<<work()<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1590237564,
        "uid": 78331,
        "name": "Melon_Musk",
        "ccfLevel": 5,
        "title": "CF1219G Harvester \u9898\u89e3"
    },
    {
        "content": "## \u9898\u610f\n\u7ed9\u51fa\u4e00\u4e2a$n*m$\u7684\u77e9\u9635\uff0c\u77e9\u9635\u4e0a\u6bcf\u4e2a\u70b9\u90fd\u6709\u4e00\u4e2a\u6743\u503c\uff0c\u6211\u4eec\u9700\u8981\u4ece\u4e2d\u6536\u52724\u6b21\uff0c\u6bcf\u6b21\u6536\u5272\u90fd\u53ef\u4ee5\u6536\u53d6\u4e00\u884c\u6216\u4e00\u5217\u7684\u6743\u503c\uff0c\u6bcf\u4e2a\u70b9\u6700\u591a\u53ea\u80fd\u6c42$1$\u6b21\uff0c\u6c42\u51fa\u6700\u5927\u6743\u503c\u548c\u3002\n\n## \u5206\u6790\n* \u9996\u5148\u89c2\u5bdf\u6570\u636e\uff0c\u6211\u4eec\u53d1\u73b0\u662f$n*m<=10^5$\uff0c\u800c\u4e0d\u662f\u5355\u72ec\u7684$n$\u6216$m$\u7684\u53d6\u503c\uff0c\u6240\u4ee5\u6709\u53ef\u80fd\u6709\u8fd9\u6837\u7684\u51e0\u7ec4\u6570\u636e\uff1a$n=1,m=10^5;n=10^5,m=1$\uff0c\u8fd9\u65f6\u6211\u4eec\u53d1\u73b0\u5355\u7eaf\u5730\u5f00\u4e8c\u7ef4\u6570\u7ec4\u662f\u4e0d\u80fd\u540c\u65f6\u5904\u7406\u8fd9\u6837\u7684\u6570\u636e\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u9700\u8981\u538b\u7ef4\uff0c\u5c06\u4e24\u7ef4\u538b\u6210\u4e00\u7ef4\uff0c\u6765\u5904\u7406\u6570\u636e\u3002\u5c31\u50cf\u8fd9\u4e2a\u51fd\u6570:\n```cpp\nint ya(int x,int y)\n{\n    return (x-1)*m+y;\n}\n```\n* \u5bf9\u4e8e\u8981\u53d6\u7684\u56db\u6b21\uff0c\u6211\u4eec\u6765\u679a\u4e3e\u8981\u53d6\u7684\u54ea\u79cd\u60c5\u51b5\uff0c\u603b\u5171\u6709\u4e94\u79cd\u60c5\u51b5\uff0c\u5206\u522b\u662f\u53d6\u56db\u884c\uff0c\u4e09\u884c\u4e00\u5217\uff0c\u4e24\u884c\u4e24\u5217\uff0c\u4e00\u884c\u4e09\u5217\uff0c\u56db\u5217\u3002\u6211\u4eec\u5148\u6c42\u51fa\u6bcf\u884c\u6bcf\u5217\u7684\u524d\u7f00\u548c\uff0c\u7136\u540e\u6765\u5206\u60c5\u51b5\u8ba8\u8bba\u3002\u5bf9\u4e8e\u7b2c\u4e00\u79cd\u7b2c\u4e94\u79cd\u53ef\u4ee5\u4e00\u8d77\u8003\u8651\uff0c\u6211\u4eec\u7528\u4e00\u4e2a\u5c0f\u6839\u5806\u6765\u5b58\u6700\u5927\u7684\u524d\u56db\u884c\uff0c\u7136\u540e\u66b4\u529b\u6c42\u51fa\u7b54\u6848\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$O(n)$\u3002\u5bf9\u4e8e\u7b2c\u4e8c\u79cd\u7b2c\u56db\u79cd\u53ef\u4ee5\u4e00\u8d77\u8003\u8651\uff0c\u5148\u9501\u5b9a\u597d\u4e00\u5217\uff0c\u518d\u7528\u8ddf\u524d\u9762\u4e00\u6837\u7684\u65b9\u6cd5\u66b4\u529b\u6c42\u51fa\u5269\u4e0b\u4e09\u884c\u7684\u7b54\u6848\uff0c\u4f46\u8981\u6ce8\u610f\u91cd\u53e0\u7684\u6570\u53ea\u80fd\u7b97\u4e00\u6b21\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$O(nm)$\u3002\u5bf9\u4e8e\u7b2c\u4e09\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u5148\u9501\u5b9a\u597d\u4e24\u5217\uff0c\u518d\u7528\u8ddf\u524d\u9762\u4e00\u6837\u7684\u65b9\u6cd5\u66b4\u529b\u6c42\u51fa\u5269\u4e0b\u4e24\u884c\u7684\u7b54\u6848\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$O(n^2m)$\uff0c\u8fd9\u4e2a\u65f6\u95f4\u590d\u6742\u5ea6\u5176\u5b9e\u633a\u5371\u9669\u7684\uff0c\u5982\u679cn\u6070\u597d\u4e3a\u5927\u7684\u90a3\u4e2a\u6570\u5c31\u6709\u53ef\u80fd\u8d85\u65f6\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u5148\u8fdb\u884c\u5224\u65ad\uff0c\u5982\u679c$n>m$\u5c31\u5c06\u6570\u7ec4\u65cb\u8f6c$90\u00b0$\uff0c\u4f7f\u5f97$n$\u66f4\u5c0f\u3002\u8fd9\u6837\u6700\u574f\u60c5\u51b5\u65f6\uff0c\u65f6\u95f4\u4e5f\u53ea\u6709$\\sqrt [\\frac{3}{2}]{10^5}\u22483*10^6$\uff0c\u5c31\u53ef\u4ee5\u8f7b\u677e\u8fc7\u8fd9\u9053\u9898\u5566\u3002\n\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nconst int N=1e5+5;\nll n,m,a[N],b[N],row[N],column[N],ans;\nint ya(int x,int y)\n{\n\treturn (x-1)*m+y;\n}\npriority_queue<ll,vector<ll>,greater<ll> > q;\nvoid solve1()\n{\n\tll sum=0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tll val=row[i];\n\t\tif(q.size()<4)\tq.push(val);\n\t\telse\n\t\t{\n\t\t\tif(val>q.top())\n\t\t\t{\n\t\t\t\tq.pop();\n\t\t\t\tq.push(val);\n\t\t\t}\n\t\t}\n\t}\n\twhile(q.size())\n\t{\n\t\tsum+=q.top();\n\t\tq.pop();\n\t}\n\tans=max(ans,sum);\n}\nvoid solve2()\n{\n\tll sum=0;\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tll val=column[i];\n\t\tif(q.size()<4)\tq.push(val);\n\t\telse\n\t\t{\n\t\t\tif(val>q.top())\n\t\t\t{\n\t\t\t\tq.pop();\n\t\t\t\tq.push(val);\n\t\t\t}\n\t\t}\n\t}\n\twhile(q.size())\n\t{\n\t\tsum+=q.top();\n\t\tq.pop();\n\t}\n\tans=max(ans,sum);\n}\nvoid solve3()\n{\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tll sum=row[i];\n\t\tfor(int j=1;j<=m;j++)\n\t\t{\n\t\t\tll val=column[j]-a[ya(i,j)];\n\t\t\tif(q.size()<3) q.push(val);\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(val>q.top())\n\t\t\t\t{\n\t\t\t\t\tq.pop();\n\t\t\t\t\tq.push(val);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\twhile(q.size())\n\t\t{\n\t\t\tsum+=q.top();\n\t\t\tq.pop();\n\t\t}\n\t\tans=max(ans,sum);\n\t}\n}\nvoid solve4()\n{\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tll sum=column[i];\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tll val=row[j]-a[ya(j,i)];\n\t\t\tif(q.size()<3) q.push(val);\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(val>q.top())\n\t\t\t\t{\n\t\t\t\t\tq.pop();\n\t\t\t\t\tq.push(val);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\twhile(q.size())\n\t\t{\n\t\t\tsum+=q.top();\n\t\t\tq.pop();\n\t\t}\n\t\tans=max(ans,sum);\n\t}\n}\nvoid solve5()\n{\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=i+1;j<=n;j++)\n\t\t{\n\t\t\tll sum=row[i]+row[j];\n\t\t\tfor(int k=1;k<=m;k++)\n\t\t\t{\n\t\t\t\tll val=column[k]-a[ya(i,k)]-a[ya(j,k)];\n\t\t\t\tif(q.size()<2) q.push(val);\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif(q.top()<val)\n\t\t\t\t\t{\n\t\t\t\t\t\tq.pop();\n\t\t\t\t\t\tq.push(val);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\twhile(q.size())\n\t\t\t{\n\t\t\t\tsum+=q.top();\n\t\t\t\tq.pop();\n\t\t\t}\n\t\t\tans=max(ans,sum);\n\t\t}\n\t}\n}\nint main()\n{\n\tscanf(\"%lld%lld\",&n,&m);\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tscanf(\"%lld\",&b[ya(i,j)]);\n\tif(n>m)\n\t{\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tfor(int j=1;j<=m;j++)\n\t\t\t\ta[(j-1)*n+i]=b[ya(i,j)];\n\t\tswap(n,m);\n\t}\n\telse\n\t{\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tfor(int j=1;j<=m;j++)\n\t\t\t\ta[ya(i,j)]=b[ya(i,j)];\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t{\n\t\t\tint x=a[ya(i,j)];\n\t\t\trow[i]+=x;\n\t\t\tcolumn[j]+=x;\n\t\t}\n\tsolve1();\n\tsolve2();\n\tsolve3();\n\tsolve4();\n\tsolve5();\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1590229897,
        "uid": 72043,
        "name": "jdsb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1219G \u3010Harvester\u3011"
    },
    {
        "content": "## \u524d\u8a00\n\n\u5206\u7c7b\u8ba8\u8bba\u597d\u9898 & 100 \u84dd AC \u796d\u3002\n\n## \u89e3\u6cd5\n\n\u9996\u5148\uff0c\u56e0\u4e3a\u6211\u4eec\u53ea\u80fd\u786e\u5b9a $N\\times M$ \u7684\u8303\u56f4\uff0c\u6240\u4ee5\u6570\u7ec4\u9700\u8981\u4f7f\u7528 `std::vector` \u5b58\u50a8\u3002\n\n\u5176\u6b21\uff0c\u7528\u6570\u7ec4 $s_1,s_2$ \u5206\u522b\u7ef4\u62a4\u6bcf\u4e00\u884c\u3001\u6bcf\u4e00\u5217\u7684\u6ce1\u6ce1\u7684\u6570\u91cf\u603b\u548c\uff1b\n\n\u63a5\u7740\uff0c\u5bb9\u6613\u89c2\u5bdf\u5230\uff0c\u672c\u9898\u7684\u6700\u5927\u503c\u53ef\u80fd\u6709 $5$ \u79cd\u60c5\u51b5\uff1a\n\n- \u9009\u62e9 $4$ \u884c\uff1b\n\n- \u9009\u62e9 $4$ \u5217\uff1b\n\n- \u9009\u62e9 $3$ \u884c $1$ \u5217\uff1b\n\n- \u9009\u62e9 $3$ \u5217 $1$ \u884c\uff1b\n\n- \u9009\u62e9 $2$ \u884c $2$ \u5217\u3002\n\n\u5bf9\u4e8e\u524d\u4e24\u79cd\u60c5\u51b5\uff0c\u53ea\u9700\u8981\u4ece\u9884\u5904\u7406\u51fa\u7684 $s_1,s_2$ \u4e2d\u5206\u522b\u9009\u62e9\u51fa\u6700\u5927\u7684\u56db\u4e2a\u76f8\u52a0\u5c31\u53ef\u4ee5\u4e86\uff1b\n\n\u5bf9\u4e8e\u4e09\u3001\u56db\u79cd\u60c5\u51b5\uff0c\u786e\u5b9a\u90a3\u552f\u4e00\u7684 $1$ \u884c / $1$ \u5217\uff0c\u518d\u4ece\u5269\u4e0b\u7684\u5217 / \u884c\u4e2d\u9009\u62e9\u51fa**\u51cf\u53bb\u5b83\u4e0e\u90a3\u552f\u4e00\u7684 $1$ \u884c / $1$ \u5217\u4ea4\u754c\u5904\u7684\u6ce1\u6ce1**\uff08\u5bb9\u65a5\u539f\u7406\uff09\u7684\u4e09\u4e2a\u6700\u5927\u7684\u76f8\u52a0\uff1b\n\n\u5bf9\u4e8e\u7b2c\u4e94\u79cd\u60c5\u51b5\uff0c\u5224\u65ad\u4e00\u4e0b $N$ \u548c $M$ \u7684\u5927\u5c0f\u5173\u7cfb\uff1a\n\n- \u82e5 $N>M$\uff0c\u6211\u4eec\u5c31\u679a\u4e3e\u90a3\u4e24\u4e2a\u5217\uff0c\u63a5\u7740\u6309\u7167\u7c7b\u4f3c\u4e09\u3001\u56db\u4e2d\u7684\u65b9\u6cd5\u9009\u51fa\u53bb\u9664\u4ea4\u70b9\u540e\u603b\u548c\u6700\u5927\u7684\u4e24\u5217\u76f8\u52a0\uff1b\n\n- \u5426\u5219\uff0c\u679a\u4e3e\u4e24\u4e2a\u884c\uff0c\u7136\u540e\u518d\u9009\u51fa\u4e24\u4e2a\u53bb\u9664\u4ea4\u70b9\u540e\u603b\u548c\u6700\u5927\u7684\u4e24\u884c\u76f8\u52a0\uff1b\n\n\u4e94\u79cd\u60c5\u51b5\u53d6\u6700\u5927\u503c\u5373\u53ef\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u79cd\u60c5\u51b5\uff0c\u4e2d\u95f4\u53d6\u6700\u5927\u7684\u82e5\u5e72\u4e2a\u503c\u53ef\u4ee5\u4f7f\u7528\u4f18\u5148\u961f\u5217\u7ef4\u62a4\u3002\n\n\u653e\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nmain(){\n  int n,m; cin>>n>>m;\n  vector<vector<int> > a(n,vector<int>(m));\n  vector<int> s(n),s2(m),r(8);\n  for(auto &i:a)for(auto &j:i)cin>>j;\n  for(int i=0;i<n;i++)\n    for(int j=0;j<m;j++)\n      s[i]+=a[i][j],s2[j]+=a[i][j];\n  priority_queue<int> q[2];\n  for(auto &i:s)q[0].emplace(i);\n  for(int i=1;i<=4&&!q[0].empty();i++)\n    r[0]+=q[0].top(),q[0].pop();\n  for(auto &i:s2)q[1].emplace(i);\n  for(int i=1;i<=4&&!q[1].empty();i++)\n    r[1]+=q[1].top(),q[1].pop();\n  for(int i=0;i<n;i++){\n    priority_queue<int> p;\n    for(int j=0;j<m;j++)\n      p.emplace(s2[j]-a[i][j]);\n    r[5]=s[i]; for(int i=1;i<=3&&!p.empty();i++)\n      r[5]+=p.top(),p.pop();\n    r[2]=max(r[2],r[5]);\n  }\n  for(int i=0;i<m;i++){\n    priority_queue<int> p;\n    for(int j=0;j<n;j++)\n      p.emplace(s[j]-a[j][i]);\n    r[5]=s2[i]; for(int i=1;i<=3&&!p.empty();i++)\n      r[5]+=p.top(),p.pop();\n    r[3]=max(r[3],r[5]);\n  }\n  if(n>m){\n    for(int i=0;i<m-1;i++)\n      for(int j=i+1;j<m;j++){\n        priority_queue<int> p;\n        for(int k=r[5]=0;k<n;k++)\n          p.emplace(s[k]-a[k][i]-a[k][j]);\n        for(int i=1;i<=2&&!p.empty();i++)\n          r[5]+=p.top(),p.pop();\n        r[4]=max(r[4],r[5]+s2[i]+s2[j]);\n      }\n  }\n  else{\n    for(int i=0;i<n-1;i++)\n      for(int j=i+1;j<n;j++){\n        priority_queue<int> p;\n        for(int k=r[5]=0;k<m;k++)\n          p.emplace(s2[k]-a[i][k]-a[j][k]);\n        for(int i=1;i<=2&&!p.empty();i++)\n          r[5]+=p.top(),p.pop();\n        r[4]=max(r[4],r[5]+s[i]+s[j]);\n      }\n  }\n  cout<<*max_element(r.begin(),r.end())<<endl;\n  return 0;\n}\n```",
        "postTime": 1670335725,
        "uid": 556366,
        "name": "zyc212303",
        "ccfLevel": 5,
        "title": "CF1219G Harvester \u9898\u89e3"
    },
    {
        "content": "\u5206\u7c7b\u8ba8\u8bba\u9898\uff0c\u8981\u6709\u70b9\u8010\u5fc3\u8c03\u9898\u548c\u5206\u7c7b\u3002\n\n\u53ef\u4ee5\u5206\u6210\u597d\u51e0\u79cd\u60c5\u51b5\uff0c\u8fd9\u91cc\u53ea\u5bf9\u884c\u8fdb\u884c\u8ba8\u8bba\uff0c\u5217\u7684\u8bdd\u5c31\u7ffb\u8f6c\u4e00\u4e0b\u5373\u53ef\u3002\n\n\u8bf7\u770b\u6e05\u695a\u9898\u76ee\u7684\u6570\u636e\u8303\u56f4\uff0c\u53ef\u4ee5\u8ba4\u4e3a $n,m \\le 300$\u3002(\u96fe\n\n1. \u9009\u56db\u4e2a\u884c\n\n\u90a3\u60f3\u90fd\u4e0d\u7528\u60f3\u9009\u56db\u4e2a\u6700\u5927\u603b\u548c\u7684\u884c\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u590d\u6742\u5ea6 $O(n \\log n)$\u3002\n\n1. \u9009\u4e00\u4e2a\u884c\u4e09\u4e2a\u5217\n\n\u8fd9\u4e2a\u65f6\u5019\uff0c\u6211\u4eec\u9700\u8981\u53bb\u679a\u4e3e\u8fd9\u4e2a\u884c\uff0c\u7136\u540e\u5bf9\u4e8e\u5217\u7684\u603b\u548c\u8fdb\u884c\u7ef4\u62a4\uff0c\u6700\u540e\u53d6\u51fa\u4e09\u4e2a\u6700\u5927\u7684\u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6 $O(nm \\log m)$\u3002\n\n1. \u9009\u4e24\u4e2a\u884c\u4e24\u4e2a\u5217\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u4e2a\u65f6\u5019\u66b4\u529b\u679a\u4e3e\u597d\u50cf\u4f1a TLE\uff0c\u4f46\u4e8b\u5b9e\u4e0a\u5e76\u6ca1\u6709\uff0c\u56e0\u4e3a $n$ \u548c $m$ \u6700\u5c0f\u7684\u90a3\u4e2a\u80af\u5b9a\u662f\u4e0d\u8d85\u8fc7 $\\sqrt n$ \u7684\uff0c\u56e0\u6b64\uff0c\u5982\u679c\u9047\u5230\u4e86 $n>m$ \u7684\u60c5\u51b5\uff0c\u5c31\u4ea4\u6362\u4e00\u4e0b\uff0c\u7136\u540e\u679a\u4e3e\u4e24\u4e2a\u884c\uff0c\u53bb\u786e\u5b9a\u4e00\u4e0b\u90a3\u4e24\u4e2a\u5217\u3002\n\n\u5982\u679c\u5b9e\u73b0\u4e0d\u597d\u7684\u8bdd\u5c31\u4f1a\u53d8\u6210 $O(n^2m \\log m)$\uff0c\u8fd9\u4e2a\u590d\u6742\u5ea6\u662f\u901a\u8fc7\u4e0d\u4e86\u8fd9\u9053\u9898\u76ee\u7684\uff0c\u8003\u8651\u6211\u4eec\u672c\u8d28\u4e0a\u5c31\u662f\u5bfb\u627e\u6700\u5927\u503c\u548c\u6b21\u5927\u503c\uff0c\u53ef\u4ee5 $O(1)$ \u8fdb\u884c\u7ef4\u62a4\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <set>\n#include <vector>\n#include <algorithm>\n#define int long long \n#define pb push_back \n#define getchar()(p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\nchar buf[1<<21],*p1=buf,*p2=buf;\ninline int read()\n{\n    char c=getchar();int x=0;bool f=0;\n    for(;!isdigit(c);c=getchar())f^=!(c^45);\n    for(;isdigit(c);c=getchar())x=(x<<1)+(x<<3)+(c^48);\n    if(f)x=-x;return x;\n}\nusing namespace std;\nconst int INF=1e5+5;\nint n,m,ans[INF],ans1;\nvector <int> a[INF],sum[INF],sum1[INF];\nbool cmp(int x,int y) {return x>y;}\nsigned main()\n{\n\tn=read();m=read();\n\tfor (int i=0;i<=n;i++) \n\t\tfor (int j=0;j<=m+1;j++) \n\t\t\ta[i].pb(0),sum[i].pb(0),sum1[i].pb(0);\n//\tcout<<sum[1]<<\" jaier\\n\"; \n\tfor (int i=1;i<=n;i++)\n\t\tfor (int j=1;j<=m;j++) {\n\t\t\ta[i][j]=read();\n\t\t\tsum1[i][j]=sum1[i-1][j]+a[i][j];\n\t\t\tsum[i][j]=sum[i][j-1]+a[i][j];\n\t\t\t\n\t\t}\n\tfor (int i=1;i<=m;i++) \n\t\tans[i]=sum1[n][i];\n\tsort(ans+1,ans+1+m,cmp);\n\tint res=0;\n\tfor (int i=1;i<=min(m,4ll);i++)\n\t\tres+=ans[i];\n\tans1=max(ans1,res);\n\t// \u56db\u884c\n\tfor (int i=1;i<=n;i++) \n\t\tans[i]=sum[i][m];\n\tsort(ans+1,ans+1+n,cmp);\n\tres=0;\n\tfor (int i=1;i<=min(n,4ll);i++)\n\t\tres+=ans[i];\n\tans1=max(ans1,res);\n\t// \u56db\u5217\n\t\n\t// \u4e00\u884c\u4e09\u5217\n\tfor (int i=1;i<=n;i++) {\n\t\tint res=0;\n\t\tfor (int j=1;j<=m;j++) { \n\t\t\tsum1[n][j]-=a[i][j],res+=a[i][j];\n\t\t} \n\t\tfor (int j=1;j<=m;j++) {\n\t\t\tans[j]=sum1[n][j];\n\t\t}\n\t\tsort(ans+1,ans+1+m,cmp);\n\t\tfor (int j=1;j<=min(m,3ll);j++)\n\t\t\tres+=ans[j];\n\t\tans1=max(ans1,res);\n\t\tfor (int j=1;j<=m;j++)\n\t\t\tsum1[n][j]+=a[i][j];\n//\t\tcout<<res<<\" \"<<i<<\" \"<<<\"\\n\";\n\t}\n\t\n\t// \u4e00\u5217\u4e09\u884c \n\tfor (int i=1;i<=m;i++) {\n\t\tint res=0;\n\t\tfor (int j=1;j<=n;j++)\n\t\t\tsum[j][m]-=a[j][i],res+=a[j][i];\n\t\tfor (int j=1;j<=n;j++) \n\t\t\tans[j]=sum[j][m];\n\t\tsort(ans+1,ans+1+n,cmp);\n\t\tfor (int j=1;j<=min(n,3ll);j++)\n\t\t\tres+=ans[j];\n\t\tans1=max(ans1,res);\n\t\tfor (int j=1;j<=n;j++)\n\t\t\tsum[j][m]+=a[j][i];\n\t}\n\t// \u4e24\u884c\u4e24\u5217\n\tif (n<=m) {\n\t\tfor (int i=1;i<=n;i++)\n\t\t\tfor (int j=1;j<=n;j++) {\n\t\t\t\tif (i==j) continue;\n\t\t\t\tint res=0;\n\t\t\t\tfor (int k=1;k<=m;k++)\n\t\t\t\t\tsum1[n][k]-=a[i][k]+a[j][k],res+=a[i][k]+a[j][k];\n\t\t\t\tint Max=0,Max1=0;\n\t\t\t\tfor (int k=1;k<=m;k++) { \n\t\t\t\t\tans[k]=sum1[n][k];\n\t\t\t\t\tif (ans[k]>Max) Max1=Max,Max=ans[k];\n\t\t\t\t\telse if (ans[k]>Max1) Max1=ans[k];\n\t\t\t\t}\n\t\t\t\tif (m>=2) res+=Max+Max1;\n\t\t\t\telse res+=Max;\n\t\t\t\tans1=max(ans1,res);\n\t\t\t\tfor (int k=1;k<=m;k++)\n\t\t\t\t\tsum1[n][k]+=a[i][k]+a[j][k];\n\t\t\t}\n\t}\n\telse {\n\t\tfor (int i=1;i<=m;i++)\n\t\t\tfor (int j=1;j<=m;j++) {\n\t\t\t\tif (i==j) continue;\n\t\t\t\tint res=0;\n\t\t\t\tfor (int k=1;k<=n;k++)\n\t\t\t\t\tsum[k][m]-=a[k][i]+a[k][j],res+=a[k][i]+a[k][j];\n\t\t\t\tint Max=0,Max1=0;\n\t\t\t\tfor (int k=1;k<=n;k++) {\n\t\t\t\t\tans[k]=sum[k][m];\n\t\t\t\t\tif (ans[k]>Max) Max1=Max,Max=ans[k];\n\t\t\t\t\telse if (ans[k]>Max1) Max1=ans[k];\n\t\t\t\t}\n\t\t\t\tif (n>=2) res+=Max+Max1;\n\t\t\t\telse res+=Max;\n\t\t\t\tans1=max(ans1,res);\n\t\t\t\tfor (int k=1;k<=n;k++)\n\t\t\t\t\tsum[k][m]+=a[k][i]+a[k][j];\n\t\t\t}\n\t}\n\tcout<<ans1<<\"\\n\";\n\treturn 0;\n}\n```\n",
        "postTime": 1662340111,
        "uid": 208653,
        "name": "_edge_",
        "ccfLevel": 0,
        "title": "CF1219G"
    }
]
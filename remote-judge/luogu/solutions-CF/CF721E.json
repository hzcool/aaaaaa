[
    {
        "content": "# 0.\u524d\u8a00\n[\u6211\u7684AC\u8bb0\u5f55](https://www.luogu.com.cn/record/56708790)\n\n\u9898\u76ee\u94fe\u63a5\uff1a[CF\u94fe\u63a5](http://codeforces.com/contest/721/problem/E)\n \n\u9898\u76ee\u5927\u610f\uff1a\n\u5728\u4e00\u6761\u6570\u8f74\u4e0a\uff0cBob\u8981\u5b66\u6821\uff08\u70b9 $0$\uff09\u8d70\u5230\u5bb6\uff08\u70b9 $L$\uff09\uff0c\u5176\u4e2d\u6709 $n$ \u4e2a\u8def\u706f\uff0c\u8def\u706f\u7167\u8000\u7684\u8303\u56f4\u662f $(l[i], r[i])$ \uff08\u8def\u706f\u7684\u8303\u56f4\u4e0d\u4f1a\u91cd\u53e0\uff09\uff1bBob\u4f1a\u5728\u706f\u4eae\u7684\u7684\u8303\u56f4\u5185\u5531\u6b4c\uff0c\u6bcf\u6b21\u5531\u7684\u8ddd\u79bb\u4e3a $p$\uff1b\uff08\u5fc5\u987b\u5531\u5b8c\uff0c\u4e2d\u95f4\u5fc5\u987b\u5168\u90e8\u662f\u5728\u8def\u706f\u7167\u8000\u8303\u56f4\u5185\uff09\n\n\u5f53Bob\u5531\u5b8c\u4e00\u6b21\u7684\u65f6\u5019\uff0c\u4e0b\u4e00\u6b21\u5531\u7684\u5730\u70b9\u5fc5\u987b\u6ee1\u8db3\u4ee5\u4e0b\u5176\u4e2d\u4e00\u70b9\uff1a\n1. \u5f00\u59cb\u5531\u7684\u5730\u70b9\u548c\u4e0a\u4e00\u6b21\u5531\u7ed3\u675f\u7684\u5730\u70b9\u91cd\u5408\uff1b\n2. \u5f00\u59cb\u5531\u7684\u5730\u70b9\u548c\u4e0a\u4e00\u6b21\u5531\u7ed3\u675f\u7684\u5730\u70b9\u8ddd\u79bb>=t;\n \n\u95ee\u6700\u591a\uff0c\u80fd\u5531\u51e0\u6b21\u3002\n \n\n# 1.\u89e3\u6790\n\n - \u9898\u76ee\u306e\u91cd\u70b9\uff1a\n\n\u8def\u706f $(l[i], r[i])$ \u4e0d\u4f1a\u91cd\u53e0\uff0c\u5e76\u4e14\u5728\u7167\u8000\u8303\u56f4\u5185\uff0c\u90a3\u4e48\u8ddd\u79bb\u95f4\u9694\u8981\u4e48\u4e3a $0$\uff0c\u8981\u4e48 $\\geq t$\uff1b\n\u90a3\u4e48\u5bf9\u4e8e bob \u6765\u8bf4\uff0c\u6bcf\u5230\u4e00\u4e2a\u8def\u706f\u4ed6\u90fd\u987b\u4f5c\u51fa\u6289\u62e9\uff1a\n\n1. \u5531\u6b4c\u3002\u9700\u8981\u770b\u5f53\u524d\u662f\u5426\u6ee1\u8db3\u5531\u6b4c\u7684\u6761\u4ef6\uff1a\u5269\u4e0b\u7684\u8def\u706f\u8ddd\u79bb\u662f\u5426\u8db3\u591f $p$\uff0c\u5f53\u524d\u4f4d\u7f6e\u548c\u4e0a\u6b21\u5531\u6b4c\u7684\u4f4d\u7f6e\u662f\u5426\u6ee1\u8db3\u5531\u6b4c\u7684\u8ddd\u79bb\u6761\u4ef6\uff1b\n2. \u4e0d\u5531\u6b4c\u3002\u5bf9\u524d\u9762\u6ca1\u6709\u8981\u6c42\u3002\n\n\u90a3\u4e48\u6211\u4eec\u9996\u5148\u60f3\u5230\u7684\u5c31\u662f dp\u3002\n\n - \u6700\u4f18\u5b50\u7ed3\u6784\uff1a\n\n\u5047\u8bbe $dp[i]$ \u4e3a\u5230\u8ddd\u79bb $i$ \u80fd\u5531\u7684\u6700\u591a\u6b21\u6570\uff08\u5e76\u4e14\u8981\u6c42\u662f\u4ee5\u5531\u6b4c\u7ed3\u5c3e\uff09\uff0c\u4e14\u533a\u95f4 $[i-p, i]$ \u662f\u5728\u8def\u706f\u8303\u56f4\u5185\uff0c\u90a3\u4e48 $dp[i]$ \u53ef\u4ee5\u7531 $dp[i-p]$ \u8f6c\u79fb\u8fc7\u6765\u3002\n\n$dp[i]\\to \\max(dp[0~(i-t-p)])+1$\uff1b\n\u8fd9\u6837\u7684\u72b6\u6001\u6570\u4e3a $L$\uff08\u8ddd\u79bb\u7684\u8303\u56f4\uff09\u3002\n\u72b6\u6001\u8f6c\u79fb\u7684\u590d\u6742\u5ea6\u4e3a $O(L)$\u3002\n\n\u5176\u4e2d\u7684 $\\max(dp[0]\\to dp[i-t-p])$\uff0c\u53ef\u4ee5\u7528 $dmax[i]$ \u6765\u8868\u793a\u524d $i$ \u4e2a\u4f4d\u7f6e\u7684\u6700\u4f18\u89e3\uff0c\u8fd9\u6837 $\\max(dp[0]\\to dp[i-t-p])$ \u5c31\u7b49\u4e8e $dmax[i-t-p]$;\n\u8fd9\u6837\u72b6\u6001\u8f6c\u79fb\u7684\u590d\u6742\u5ea6\u5c31\u5c06\u4e3a $O(1)$\uff08\u5f53 $L$ \u975e\u5e38\u5927\u65f6\uff0c\u4ecd\u4e3a $O(L)$\uff09\u3002\n\n - \u72b6\u6001\u8f6c\u79fb\n \n\u56e0\u4e3a\u533a\u95f4\u6027\uff0c$dp[i]$ \u6539\u6210\u5230\u8ddd\u79bb $r[i]$ \u80fd\u5531\u7684\u6700\u591a\u6b21\u6570\uff0c\u6ce8\u610f**\u4e0d\u80fd\u8981\u6c42\u5230 $r[i]$ \u6765\u7ed3\u5c3e**\uff0c\u56e0\u4e3a\u4e0d\u6ee1\u8db3\u6700\u4f18\u89e3\u3002\n\n\u8fd9\u6837\u7684\u8bdd\uff0c\u5047\u8bbe\u662f\u4ece $dp[k]$ \u8f6c\u79fb\u5230 $dp[i]$\uff0c\u4ece $g[k]$ \u5f00\u59cb\uff0c\u8fde\u7eed $t$ \u7684\u8ddd\u79bb\u4e0d\u5531\u6b4c\uff0c\u7136\u540e $\\min(r[i]-l[i], r[i]-g[k]-t)$ \u7684\u8ddd\u79bb\u7528\u4e8e\u5531\u6b4c\uff0c\u8fd9\u91cc\u6211\u4eec\u7528 $count(L)$ \u8868\u793a\u8ddd\u79bb $L$ \u80fd\u5531\u7684\u6b21\u6570\uff0c\u6700\u540e $dp[i]$ \u53d6\u6700\u4f18\u89e3\u7684\u65f6\u5019 $g[i]=\\max(l[i], g[k]+t) + count(L)\\times p$;\n \n\u5bf9\u4e8e $g[k] + t \\leq r[i]$ \u7684 $k$\uff0c\u90fd\u53ef\u4ee5\u8fd9\u6837\uff1a\n\n$dp[i] = \\max(dp[i], dp[k] + count(L))$;\n\n$g[i] = g[k] + count(L) * p + t$\n\n$L=min(r[i]-l[i], r[i]-g[k]-t)$\n\n - \u518d\u6b21\u4f18\u5316\uff01\uff01\uff01\n \n\u76ee\u524d\u72b6\u6001\u6570\uff1a$O(N)$, \u76ee\u524d\u8f6c\u79fb\u590d\u6742\u5ea6\uff1a$O(N)$\uff0c\u603b\u590d\u6742\u5ea6\uff1a$O(N^2)$ \u3002\n\n\u5bf9\u4e8e $dp[k]$ \u662f\u56fa\u5b9a\u503c\uff0c$count(L)$ \u4e2d\u7684 $L$ \u4f1a\u968f\u7740 $i$ \u7684\u589e\u52a0\u800c\u589e\u52a0\uff0c\u800c\u5f53 $L$ \u5f88\u5927\u4e4b\u540e\uff0c$dp[k]$ \u8f83\u5c0f\u7684\u72b6\u6001\u518d\u8fdb\u884c\u6700\u4f18\u5316\u8f6c\u79fb\u662f\u65e0\u6548\u7684\u8fc7\u7a0b\uff0c\u56e0\u4e3a $dp[k+1]$ \u662f\u66f4\u5408\u9002\u7684\u89e3\u3002\n\n\u72b6\u6001\u7684\u51b3\u7b56\u56e0\u7d20\u6709\u4e24\u4e2a,$dp[k]$ \u548c $g[k]$\uff1a\n1. $dp[k]$ \u5c0f\uff0c$g[k]$ \u5c0f\u7684\u89e3\uff0c\u4e0d\u80fd\u820d\u5f03\uff0c\u56e0\u4e3a $g[k]$ \u5c0f\u5b58\u5728\u8f6c\u79fb\u7684\u53ef\u80fd\uff1b\n2. $dp[k]$ \u5927\uff0c$g[k]$ \u5927\u7684\u89e3\uff0c\u4e0d\u80fd\u820d\u5f03\uff0c\u56e0\u4e3a $dp[k]$ \u5927\u5b58\u5728\u8f6c\u79fb\u7684\u53ef\u80fd\uff1b\n3. $dp[k]$ \u5c0f\uff0c$g[k]$ \u5927\u7684\u89e3\uff0c\u820d\u5f03\uff1b\n4. $dp[k]$ \u5927\uff0c$g[k]$ \u5c0f\u7684\u89e3\uff0c\u4e0d\u80fd\u820d\u5f03\uff0c\u56e0\u4e3a $g[k]$ \u5c0f\u548c $dp[k]$ \u5927\u5747\u5b58\u5728\u8f6c\u79fb\u7684\u53ef\u80fd\u3002\n\n\u56e0\u4e3a $i<j$\uff0c$r[i] < l[j]$ , \u5fc5\u7136\u6709 $g[i] \\leq g[j]$\uff0c$count(L[i]) < count(L[j])$\u3002$dp[k]+count(L)$ \u5177\u6709\u51b3\u7b56\u5355\u8c03\u6027\uff0c\u540c\u65f6\u6709\u6548\u533a\u95f4\u4ece $r[i]-g[k]-t\\geq 0$ \u5f00\u59cb\uff1b\n \n\u7ef4\u62a4\u51b3\u7b56\u7684\u961f\u5217\uff0c\u6839\u636e $dp[k]+count(L)$ \u53ef\u4ee5\u7b97\u51fa\u5f53\u524d\u6240\u6709\u7684\u6709\u6548\u51b3\u7b56\u4e2d\u7684\u6700\u4f18\u89e3\u3002\n\n\u968f\u7740 $r[i]$ \u7684\u4e0d\u65ad\u589e\u52a0\uff0c\u4ece $r[i]-g[k]-t\\geq0$ \u7684\u961f\u5217\u65b9\u6848\u4e2d\uff0c\u4e00\u76f4\u66f4\u65b0 $dp[k]+count(L)$\uff1b\n\n# 2.code\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 114514;\nint l[N], r[N];\nint dp[N];\nint g[N];\nint main() {\n    int n, L, p, t;\n    cin >> L >> n >> p >> t;\n    for (int i = 1; i <= n; ++i) {\n        scanf(\"%d%d\", &l[i], &r[i]);\n    }\n    deque<int> q;\n    q.push_back(0);\n    g[0] = -t;\n    int ans = 0;\n    for (int i = 1; i <= n; ++i) {\n        int k = -1;\n        while (!q.empty() && g[q.front()] + t <= r[i]) {\n            int nl = max(l[i], g[q.front()] + t), nr = r[i];\n            if (dp[q.front()] + (nr - nl) / p > dp[i]) {\n                dp[i] = dp[q.front()] + (nr - nl) / p;\n                g[i] = nl + (nr - nl) / p * p;\n            } else if (dp[q.front()] + (nr - nl) / p == dp[i]) {\n                g[i] = min(g[i], nl + (nr - nl) / p * p);\n            }\n            k = q.front();\n            q.pop_front();\n        }\n        if (k != -1) {\n            q.push_front(k);\n        }\n        if (dp[i] > ans) {\n            ans = dp[i];\n            q.push_back(i);\n        }\n\n        ans = max(ans, dp[i]);\n    }\n    cout << ans << endl;\n    return 0;\n}\n```\n\n\u6c42\u5173\u6ce8qwq",
        "postTime": 1630118695,
        "uid": 554872,
        "name": "Deirdre",
        "ccfLevel": 0,
        "title": "[CF721E]\u9898\u89e3"
    },
    {
        "content": "## \u9898\u89e3 CF721E Road to Home\n\n\u9996\u5148\u89c2\u5bdf\u53d1\u73b0\u2f00\u6bb5\u4eae\u7684\u8def\u5982\u679c\u5f00\u59cb\u5531\u6b4c\uff0c\u90a3\u4e48\u5c31\u4f1a\u2f00\u76f4\u5531\u5230\u4e0d\u80fd\u518d\u5531\u4e0b\u53bb\u4e3a\u6b62\u3002\u5426\u5219\u53ef\u4ee5\u5c06\u4e0b\u4e00\u6bb5\u8981\u5531\u7684\u6b4c\u63d0\u524d\u5230\u8fd9\u4e00\u6bb5\uff0c\u4e00\u5b9a\u4e0d\u4f1a\u53d8\u5dee\u3002\u6240\u4ee5\u2f00\u6bb5\u4eae\u7684\u8def\u6709\u4e24\u79cd\u9009\u62e9\uff1a\u4e0d\u5531\u6b4c\uff1b\u5c3d\u53ef\u80fd\u591a\u5531\u6b4c\u3002\n\n\u8003\u8651DP\u3002\u8bbe$f[i]$\u8868\u793a\u53ea\u8003\u8651\u524d$i$\u6bb5\u4eae\u7684\u8def\uff0c\u6700\u591a\u80fd\u5531\u51e0\u904d\u5b8c\u6574\u7684\u6b4c\u3002\u8bbe$g[i]$\u8868\u793a\u5728\u5531\u7684\u6b4c\u7684\u6570\u91cf\u8fbe\u5230$f[i]$\u7684\u524d\u63d0\u4e0b\uff0c\u6700\u540e\u4e00\u9996\u6b4c\u6700\u65e9\u4ec0\u4e48\u65f6\u5019\u7ed3\u675f\u3002\n\n\u8f6c\u79fb\u65f6\uff0c\u5148\u8003\u8651\u7b2c$i$\u6bb5\u4e0d\u5531\u6b4c\u7684\u60c5\u51b5\u3002\u5373$f[i]=f[i-1]$\uff0c$g[i]=g[i-1]$\u3002\n\n\u5982\u679c\u7b2c$i$\u6bb5\u5531\u6b4c\u3002\u8003\u8651\u66b4\u529b\u7684\u8f6c\u79fb\uff1a\u679a\u4e3e\u4e00\u4e2a\u8f6c\u79fb\u70b9$j$\u3002\u8bbe$s=\\max(l_i,g[j]+t)$\uff0c\u8868\u793a\u7b2c$i$\u6bb5\u5f00\u59cb\u5531\u6b4c\u7684\u65f6\u95f4\u3002\u5219\u8f6c\u79fb\u4e3a\uff1a\n$$\n(f[i],g[i])\\leftarrow (f[j]+\\lfloor\\frac{r_i-s}{p}\\rfloor,s+\\lfloor\\frac{r_i-s}{p}\\rfloor\\cdot p)\n$$\n\u5176\u4e2d$\\leftarrow$\u8868\u793a\u7528\u53f3\u8fb9\u7684\u53bb\u66f4\u65b0\u5de6\u8fb9\u7684\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u66f4\u65b0\u7684\u65b9\u5f0f\u662f\uff0c\u5982\u679c$f$\u66f4\u5927\u5219\u66f4\u4f18\uff0c\u5982\u679c$f$\u76f8\u7b49\u5219$g$\u66f4\u5c0f\u7684\u66f4\u4f18\u3002\n\n\u66b4\u529b\u8f6c\u79fb\u65f6\u95f4\u590d\u6742\u5ea6$O(n^2)$\u3002\n\n\u8003\u8651\u5f53$g[j]+t\\leq l_i$\u7684\u65f6\u5019\uff0c\u8f6c\u79fb\u4e2d\u9664\u4e86$f[j]$\u4ee5\u5916\uff0c\u5176\u4ed6\u90fd\u662f\u4e00\u6837\u7684\u3002\u800c\u56e0\u4e3a\u521d\u59cb\u65f6\u4ee4$f[i]=f[i-1]$\uff0c\u6240\u4ee5$f$\u662f\u5355\u8c03\u4e0d\u964d\u7684\uff0c\u76f4\u63a5\u627e\u5230\u6700\u540e\u4e00\u4e2a\u8fd9\u6837\u7684$j$\u8f6c\u79fb\u5373\u53ef\u3002\u76f4\u63a5\u7528\u4e00\u4e2a\u6307\u9488\u7ef4\u62a4\u3002\n\n\u5f53$l_i<g[j]+t\\leq r_i$\u3002\u53ef\u4ee5\u66b4\u529b\u626b\u63cf\u8fd9\u6bb5$j$\u3002\u663e\u7136\uff0c\u6bcf\u4e2a$j$\u53ea\u4f1a\u88ab\u4e00\u4e2a$(l_i,r_i]$\u7684\u533a\u95f4\u626b\u63cf\u5230\u3002\u6240\u4ee5\u65f6\u95f4\u590d\u6742\u5ea6$O(n)$\u3002\n\n\u53c2\u8003\u4ee3\u7801\uff1a\n\n```cpp\n//problem:CF721E\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define pb push_back\n#define mk make_pair\n#define lob lower_bound\n#define upb upper_bound\n#define fi first\n#define se second\n#define SZ(x) ((int)(x).size())\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> pii;\n\nconst int MAXN=1e5;\nint L,n,p,t;\nstruct Seg_t{int l,r;};\nSeg_t a[MAXN+5];\npii dp[MAXN+5];\nbool cmp(pii a,pii b){return a.fi>b.fi||(a.fi==b.fi&&a.se<b.se);}//a\u6bd4b\u4f18\nvoid ck(pii& x,pii y){if(cmp(y,x))x=y;}\nint main() {\n\tcin>>L>>n>>p>>t;\n\tfor(int i=1;i<=n;++i)cin>>a[i].l>>a[i].r;\n\tdp[0]=mk(0,-t);\n\tint p1=0,p2=0;\n\t//p1:\u6700\u540e\u4e00\u4e2a dp[j].se+t<=l[i] \u7684 j\n\t//p2:\u6700\u540e\u4e00\u4e2a dp[j].se+t<=r[i] \u7684 j\n\tfor(int i=1;i<=n;++i){\n\t\tdp[i]=dp[i-1];//\u7b2c\u4e00\u79cd\u8f6c\u79fb:\u7b2ci\u6bb5\u5b8c\u5168\u4e0d\u9009\n\t\tint st;\n\t\twhile(p1+1<i && dp[p1+1].se+t<=a[i].l)++p1;\n\t\twhile(p2+1<i && dp[p2+1].se+t<=a[i].r){\n\t\t\t++p2;\n\t\t\tif(p2>p1)st=dp[p2].se+t,ck(dp[i],mk(dp[p2].fi+(a[i].r-st)/p,st+(a[i].r-st)/p*p));\n\t\t}\n\t\tst=a[i].l;\n\t\tck(dp[i],mk(dp[p1].fi+(a[i].r-st)/p,st+(a[i].r-st)/p*p));\n\t}\n\tcout<<dp[n].fi<<endl;\n\treturn 0;\n}\n```\n\n",
        "postTime": 1600351270,
        "uid": 100674,
        "name": "duyi",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF721E \u3010Road to Home\u3011"
    },
    {
        "content": "\u9996\u5148\uff0c\u6211\u4eec\u5b9a\u4e49\u4e24\u4e2a\u6570\u7ec4f[i],g[i]\n\nf[i]\u8868\u793a\u8d70\u5230\u7b2ci\u4e2a\u533a\u95f4\u80fd\u5531\u6b4c\u7684\u6700\u5927\u6b21\u6570\uff0cg[i]\u8868\u793af[i]\u6700\u5927\u65f6\uff0c\u6700\u540e\u4e00\u6b21\u5531\u6b4c\u65f6\u7684\uff0c\u6700\u9760\u5de6\u4f4d\u7f6e\n\n\u660e\u663e\u6709\uff1a\n\n**f[i]=max(f[j]+(r[i]-max(g[j]+t,l))/p)**\n\n**g[j]=max(r[i]-(r[i]-max(g[j]+t,l))%p)**\n\n**(1<=j<i)**\n\n\u89e3\u91ca\uff1amax(g[j]+t,l)\u4e3a\u672c\u533a\u95f4\u5f00\u59cb\u5531\u6b4c\u7684\u4f4d\u7f6e\uff0c\u8981\u4e48\u4e0a\u4e00\u4e2a\u533a\u95f4\u8fc7t\u5728\u5531\u6b4c\uff0c\u8981\u4e48\u4e00\u76f4\u4e0d\u5531\uff0c\u4e00\u521a\u8fdb\u5165\u5c31\u5531\n\n\u7531\u4e8ej\u662f\u8fde\u7eed\u533a\u95f4\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u4f18\u5316\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#define ll long long\nusing namespace std;\nint L,x,p,t,n;\nint f[100010],g[100010];\nint l,r,q[100010],head=1,tail=1;\nint main()\n{\n\tscanf(\"%d%d%d%d\",&L,&n,&p,&t);\n\tg[0]=-t;//\u8fb9\u754c\u6761\u4ef6\uff0c\u4ece0\u5f00\u59cb\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d%d\",&l,&r);\n\t\tg[i]=g[i-1];f[i]=f[i-1];//\u9ed8\u8ba4\u4e3a\u4e0a\u4e00\u4e2a\n\t\thead--;//\u7ec6\u8282\uff0c\u53ef\u4ee5\u6162\u6162\u4f53\u4f1a\n\t\twhile(head<=tail&&g[head]+t<=r)//\u5982\u679c\u53ef\u4ee5\u8df3\u5230\u5f53\u524d\u533a\u95f4\n\t\t{\n\t\t\tint x=max(g[head]+t,l);\n\t\t\tint y=f[head]+(r-x)/p;\n\t\t\tint z=r-(r-x)%p;\n\t\t\tif(y>f[i]||y==f[i]&&z<g[i])\n\t\t\t{\n\t\t\t\tf[i]=y;\n\t\t\t\tg[i]=z;\n\t\t\t}\n\t\t\thead++;//\u961f\u9996\u51fa\u961f\n\t\t}\n\t\ttail++;//\u961f\u5c3e\u5165\u961f\n\t}\n\tprintf(\"%d\",f[n]);\n\treturn 0;\n}\n```\n",
        "postTime": 1564147035,
        "uid": 103029,
        "name": "James_Brady",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF721E \u3010Road to Home\u3011"
    }
]
[
    {
        "content": "\u9996\u5148\u63a8\u4e00\u4e0b\u672c\u849f\u84bb\u7684\u535a\u5ba2[\u4f20\u9001\u95e8](blog.csdn.net/dhdhdhx)\n\n\u8fd9\u4e2a\u9898\u662f\u6211\u4eec\u8003\u524d\u96c6\u8bad\u7684\u9898 \u60f3\u770b\u5b8c\u6574\u4e09\u9053\u9898\u7684\u8bf7\u70b9\u53f3\u8fb9[\u4f20\u9001\u95e8](blog.csdn.net/dhdhdhx/article/details/102875877)\n\n\u5e7f\u544a\u690d\u5165\u5b8c\u6bd5 ~~(\u9003~~\n\n\u672c\u9898\u7531\u4e8e$s$\u662f\u5faa\u73af\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u4ece\u5faa\u73af\u5165\u624b\n\n\u6ce8\u610f\u5230\u5f53\u4e0b\u6807$i$\u5bf9\u4e8e$k$\u7684\u4f59\u6570\u662f\u4e00\u6837\u7684\u65f6\u5019\uff0c$s$\u6570\u7ec4\u7684\u503c\u4e5f\u662f\u4e00\u6837\u7684\uff0c\u5e76\u4e14\u4e8c\u8005\u4e4b\u95f4\u76f8\u5dee$(\\frac{b}{a})^k$\u500d\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u7528\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u6765\u505a\u3002\n\n\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u516c\u5f0f:\n>\u6570\u5217\u5171\u6709$n$\u9879\uff0c\u9996\u9879\u4e3a$a_1$\uff0c\u516c\u6bd4\u4e3a$q$\uff0c\u90a3\u4e48\u7b49\u6bd4\u6570\u5217\u7684\u548c\u4e3a$S_n=a_1\\frac{1-q^n}{1-q}$\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u679a\u4e3e$0-k$\u4e2d\u7684\u6570\u5c31\u884c\u4e86\uff0c\u590d\u6742\u5ea6$O(klog_n)$\n\n\u6ce8\u610f:\n\n$1.$\u6211\u5c0f\u5b66\u4ece\u5b66\u8fd9\u4e2a\u516c\u5f0f\u5230\u73b0\u5728\u90fd\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u8981\u628a$1$\u653e\u524d\u9762..\u5199\u516c\u5f0f\u65f6\u5019\u8fd9\u4e48\u5199\u884c\uff0c\u4f46\u662f\u5199\u4ee3\u7801\u54b1\u522b\u4e0a\u5934\u3002\n\n$2.$\u8fd9\u4e2a\u6570\u5217\u4e4b\u548c\u662f$s_i$\u500d\u7684\u7b49\u6bd4\u6570\u5217\u548c\uff0c\u4e0d\u8981\u628a$s_i$\u4e58\u5230$a_1$\u91cc\uff01\uff01\uff01\uff01\uff01\uff01\u7f51\u7ad9\u4e0a\u8fd9\u4e2a\u53ef\u4ee5\u8fc7\u4f46\u662f$cf$\u4e0a\u4e0d\u884c\uff01\uff01\uff01\uff01\n\n$3.$\u516c\u6bd4\u4e3a$1$\u7684\u65f6\u5019\u516c\u5f0f\u70b8\u4e86\uff0c\u6240\u4ee5\u516c\u6bd4\u4e3a$1$\u65f6\u5f97\u76f4\u63a5\u7b97\uff0c\u5c31\u662f$s_i\u00d7a^n$\n\n\u4e0a\u4ee3\u7801:\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define N int(1e5+10)\ntypedef long long ll;\nconst ll mod=1e9+9;\ninline ll quickpow(ll x, ll y){\n\twhile(x<0)x+=mod;\n\tll ret=1;\n\twhile(y){\n\t\tif(y&1)(ret*=x)%=mod;\n\t\t(x*=x)%=mod,y>>=1;\n\t}\n\treturn ret;\n}\nll n,a,b,k,ans,sum[N],s[N];\nchar ch;\nint main(){\n\tscanf(\"%lld%lld%lld%lld\",&n,&a,&b,&k);\n\tfor(ll i=1;i<=k;i++){\n\t\tch=getchar();\n\t\twhile(ch!='+'&&ch!='-')ch=getchar();\n\t\tif(ch=='+')s[i-1]=1;\n\t\telse s[i-1]=mod-1;\n\t}\n\tfor(ll i=0;i<k;i++){\n\t\tll a1=quickpow(a,n-i)%mod*quickpow(b,i)%mod;\n\t\tll q=quickpow(b,k)*quickpow(quickpow(a,k),mod-2)%mod;\n\t\tll nown=(n+1)/k;\n\t\tif(q==1)(ans+=s[i]*a1%mod*((n+1)/k)%mod)%=mod;\n\t\telse (ans+=s[i]*(a1*(quickpow(q,nown)-1)%mod*quickpow(q-1,mod-2)%mod)%mod)%=mod;\n\t}\n\tprintf(\"%lld\\n\",ans);\n}\n```\n",
        "postTime": 1572784744,
        "uid": 95366,
        "name": "Dawn_cx",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF963A \u3010Alternating Sum\u3011"
    },
    {
        "content": "\u524d\u7f6e\u77e5\u8bc6\uff1a\u9006\u5143&\u5feb\u901f\u5e42\n\n\u9898\u610f\uff1a\u6c42 \n$$\\sum_{i=0}^{n}s_ia^{n-i}b^i$$\n\n\u5176\u4e2d $s_{i+xk}=s_i~~(0\\le x < \\frac{n+1}{k})$\n\n\u8bb0 $\\frac{b^k}{a^k}$ \u4e3a $S$\uff0c$s_ia^{n-i}b^i=f(i)$\u3002\n\n\u5bf9\u4e8e\u672c\u9898\uff0c\u663e\u7136\u6709 $f(i+xk)=f(i)\\times S^x$\n\n\u6545\u539f\u5f0f\u7b49\u4e8e \n\n$$\\sum^{k-1}_{i=0}\\sum_{j=0}^{\\frac{n+1}{k}}f(i)S^j$$\n\n\u63d0\u53d6\u51fa $f(i)$\uff1a\n\n$$\\sum^{k-1}_{i=0}f(i)\\sum_{j=0}^{\\frac{n+1}{k}}S^j$$\n\n\u6b64\u65f6\u53f3\u4fa7\u662f\u4e00\u4e2a\u7b49\u6bd4\u6570\u5217\u6c42\u548c\uff1a\n\n$$\\sum^{k-1}_{i=0}f(i)\\frac{S^{\\frac{n+1}{k}}-1}{S-1}$$\n\n\u663e\u7136\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u53f3\u4fa7\u7684\u503c\uff0c\u679a\u4e3e $i$ \u7684\u503c\u5feb\u901f\u5e42\u7b97 $f(i)$ \u5373\u53ef\u3002\n\n\u6ce8\u610f\u7279\u5224 $S\\bmod p=1$ \u7684\u60c5\u51b5\uff0c\u6b64\u65f6\u5c31\u662f\u5bf9\u4e8e\u6bcf\u4e2a $f(i)$ \u90fd\u662f\u53d6 $\\frac{n+1}{k}$ \u6b21\uff0c\u7528\u540c\u6837\u65b9\u6cd5\u8ba1\u7b97\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(k\\log n)$\u3002\n\n\u6ce8\u610f\u5f00 long long \u548c\u53d6\u6a21\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define mod 1000000009\nusing namespace std;\nint n,a,b,k;\nchar s[100005];\n\nint fpow(int a,int b){\n\tif (!b) return 1;\n\tint tmp=fpow(a,b>>1);\n\tif (b&1) return (tmp*tmp%mod*a%mod+mod)%mod;\n\treturn (tmp*tmp%mod+mod)%mod;\n}\n\nsigned main(){\n\tscanf(\"%lld %lld %lld %lld\",&n,&a,&b,&k);\n\tint S=fpow(fpow(a,mod-2),k)*fpow(b,k)%mod;\n\tint num=(fpow(S,(n+1)/k)-1)*fpow(S-1,mod-2)%mod;\n\tif (!num) num=(n+1)/k;\n\tint ans=0;\n\tscanf(\"%s\",s+1);\n\tfor (int i=1;i<=k;i++)\n\t\tans=(ans+(s[i]=='+'?1:-1)*fpow(a,n-i+1)*fpow(b,i-1)%mod*num%mod)%mod;\n\tprintf(\"%lld\",(ans%mod+mod)%mod);\n} \n```\n",
        "postTime": 1658497551,
        "uid": 306050,
        "name": "\u72c2\u98ce\u4e4b\u606f",
        "ccfLevel": 7,
        "title": "CF963A \u9898\u89e3"
    }
]
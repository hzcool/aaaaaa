[
    {
        "content": "> [\u535a\u5ba2\u94fe\u63a5](http://bubbleioa.top/archives/780)\n## \u9898\u89e3\n$f[i][j]$ \u8868\u793a \u5f53\u524d\u4e32\u4e3a\u7b2cj\u4e2a\u4f4d\u7f6e\u5230\u7b2ci\u4e2a\u4f4d\u7f6e\u7684\u4e32\u7684\u65b9\u6848\u6570\n\n$O(n^3)$ \u505a\u6cd5  \n$ f[i][j]=\\sum_{j-k< i-j}f[j][k]$   \n\n\u82e5 $s(k+1,j)< s(j+1,i),j-k=i-j$ \u5219 $f[i][j]+=f[j][k]$\n\n$O(n^2)$ \u505a\u6cd5  \n\u8003\u8651 $O(1)$ check $s(k+1,j)<s(j+1,i)$   \n\n\n~~\u9017\u903c~~\u795e\u4ed9\u505a\u6cd5\uff1aSA  \n\u7b80\u5355\u505a\u6cd5\uff1a\u6c42 $lcp(I,j)$ \u5373$s[i],s[j]$ \u7684\u6700\u957f\u516c\u5171\u524d\u7f00\n\u82e5 $lcp(k,j)<j-k-1 $ \u5e76\u4e14  $s[k+ lcp(k,j)+1]< s[j+ lcp(k,j)+1]$ \u5219\u5408\u6cd5\n\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int MAXN=5010,MOD=1e9+7;\nchar str[MAXN];\nll f[MAXN][MAXN],sum[MAXN][MAXN];\nint lcp[MAXN][MAXN];\nint n,a[MAXN];\n\nint check(int x,int y){\n\tif(lcp[x][y]>=y-x)return false;//y-x\u5c31\u662f\u533a\u95f4\u957f\u5ea6\n\tif(a[x+lcp[x][y]]<a[y+lcp[x][y]])return true;\n\tif(a[x+lcp[x][y]]>a[y+lcp[x][y]])return false;\n\treturn 0;\n}\n/*sum[i][j]\u4fdd\u5b58\u7684\u662ff[i][1]+f[i][2]+...+f[i][j]*/\nint main(){\n    cin>>n;\n    scanf(\"%s\",str+1);\n    for(int i=1;i<=n;i++){\n        a[i]=str[i]-'0';\n    }\n    for(int i=n;i>=1;i--){//\u9884\u5904\u7406\u6700\u957f\u516c\u5171\u524d\u7f00\n        for(int j=n;j>=1;j--){\n            if(a[i]==a[j])lcp[i][j]=lcp[i+1][j+1]+1;\n        }\n    }\n    for(int i=1;i<=n;i++)f[i][1]=1;//\u521d\u59cb\u5316\n    for(int i=1;i<=n;i++){\n        for(int j=1;j<=i;j++){\n            if(a[j]==0)continue;//\u4e0d\u80fd\u6709\u524d\u5bfc0\n            int k=2*j-i;k=max(1,k);//\u5de6\u7aef\u70b9\n            f[i][j]=(f[i][j]+sum[j-1][j-1]-sum[j-1][k-1]+MOD)%MOD;\n            k--;\n            if(k>=0&&check(k,j))f[i][j]=(f[i][j]+f[j-1][k])%MOD;\n        }\n        for(int j=1;j<=i;j++)sum[i][j]=(sum[i][j-1]+f[i][j])%MOD;\n    }\n    ll ans=0;\n    for(int i=1;i<=n;i++)ans=(ans+f[n][i])%MOD;\n    cout<<ans<<endl;\n    return 0;\n}\n```",
        "postTime": 1554556063,
        "uid": 61150,
        "name": "\u5192\u6ce1ioa",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 CF611D \u3010New Year and Ancient Prophecy\u3011"
    },
    {
        "content": "\u4e3a\u4ec0\u4e48\u6211\u603b\u5728\u60f3\u7740\u7528 sam \u5904\u7406 lcp \u5462\u3002\u3002\u3002\n\n\u8fd9\u9053\u9898\u652f\u6301 $n^2$ lcp \u7684\u554a\uff0c\u4e3a\u4ec0\u4e48\u8981\u8d39\u4e00\u5806\u7801\u91cf\u53bb\u5199\u4e2a\u90a3\u4e48\u957f\u7684 lcp \u5462\uff08\u867d\u8bf4\u4f1a\u5feb\u4e00\u4e22\uff09\n\n\u4e8e\u662f\u5c31\u7528\u6734\u7d20\u7684\u5199\u6cd5\u597d\u4e86\n\n# noteskey\n\n\n\u548c\u697c\u4e0a\u5927\u4f6c\u8bb2\u7684\u4e00\u6837\uff0c dp \u72b6\u6001\u8bbe\u8ba1\u5c31\u662f\uff1a\n\n\u8bbe $f[i][j]$  \u4e3a\u5f53\u524d\u4e32\u4e3a $s[j]...s[i]$ \u7684\u65b9\u6848\u6570\n\n\u8f6c\u79fb\u5c31\u662f\uff1a\n\n$$f[i][j]=\\sum_{k=2\u00b7j-i}^{j-1}f[j-1][k]+[s[2j-1...j-1]<=s[j...i]]f[j-1][2j-i-1]$$\n\n\u540e\u9762\u90a3\u4e00\u4e32\u5c31\u662f\u8bf4\u957f\u5ea6\u76f8\u7b49\u8981\u6bd4\u8f83\u4e24\u4e2a\u5b57\u7b26\u4e32\u5927\u5c0f\n\n\u7136\u540e\u6bd4\u8f83\u5b57\u7b26\u4e32\u5927\u5c0f\u81ea\u7136\u5c31\u662f\u6c42\u4e2alcp \u7136\u540e\u6bd4\u8f83 lcp \u540e\u9762\u90a3\u4f4d\u5927\u5c0f\u4e86\n\n\u6240\u4ee5\u5173\u952e\u8fd8\u662f\u6c42\u4e24\u4e2a\u5b57\u7b26\u4e32 lcp \u957f\u5ea6\n\n\u8fd9\u65f6\u5019\u53ef\u4ee5\u7528\u5230\u6211\u4eec\u4e07\u80fd\u7684 sam \uff0c\u4f46\u662f\u90a3\u4e2a\u7801\u91cf\u554a\u3002\u3002\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8fd8\u662f\u7528\u4e2a $n^2$ \u7684 lcp \u6c42\u6cd5\u5427...\n\n\u5c31\u662f\u6211\u4eec\u5012\u7740\u626b\u63cf\u5b57\u7b26\u4e32\uff0c\u4ee4 $lcp[x][y]$ \u8868\u793a x\u3001y \u5f00\u5934\u7684\u4e24\u4e2a\u5b57\u7b26\u4e32\u7684 lcp \u957f\u5ea6\uff0c\u7136\u540e\u5982\u679c $s[x]==s[y]$ \u6211\u4eec \u5c31\u53ef\u4ee5\u8ba9 $lcp[x][y]=lcp[x+1][y+1]+1$ \u4e86\n\n\n\n# code\n\n```\n//by Judge\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#define Rg register\n#define fp(i,a,b) for(Rg int i=(a),I=(b)+1;i<I;++i)\n#define fd(i,a,b) for(Rg int i=(a),I=(b)-1;i>I;--i)\n#define go(G,u) for(Rg int i=G.head[u],v=G.e[i].to;i;v=G.e[i=G.e[i].nxt].to)\n#define ll long long\nusing namespace std;\nconst int mod=1e9+7;\nconst int M=5003;\ntypedef int arr[M][M];\n#ifndef Judge\n#define getchar() (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\n#endif\nchar buf[1<<21],*p1=buf,*p2=buf;\ninline int Max(int x,int y){return x>y?x:y;}\ninline int inc(int x,int y){return x+y>=mod?x+y-mod:x+y;}\ninline int read(){ int x=0,f=1; char c=getchar();\n\tfor(;!isdigit(c);c=getchar()) if(c=='-') f=-1;\n\tfor(;isdigit(c);c=getchar()) x=x*10+c-'0'; return x*f;\n} inline void reads(string& s){ char c=getchar();\n\tfor(;!isdigit(c);c=getchar()); s=\" \";\n\tfor(;isdigit(c);c=getchar()) s+=c;\n} int n,ans; string s; arr lcp,f,sum;\ninline bool check(int x,int y){\n\tif(lcp[x][y]>=y-x) return 0;\n\treturn s[x+lcp[x][y]]<s[y+lcp[x][y]];\n}\nint main(){ n=read(),reads(s);\n\tfd(i,n,1) fd(j,n,1) if(s[i]==s[j])\n\t\tlcp[i][j]=lcp[i+1][j+1]+1;\n\tfp(i,1,n) f[i][1]=1;\n\tfp(i,1,n){\n\t\tfp(j,1,i) if(s[j]>48){\n\t\t\tint k=Max(1,2*j-i);\n\t\t\tf[i][j]=inc(f[i][j],inc(sum[j-1][j-1],mod-sum[j-1][k-1]));\n\t\t\tif(--k>=0&&check(k,j)) f[i][j]=inc(f[i][j],f[j-1][k]);\n\t\t}\n\t\tfp(j,1,i) sum[i][j]=inc(sum[i][j-1],f[i][j]);\n\t}\n\tfp(i,1,n) ans=inc(ans,f[n][i]);\n\treturn !printf(\"%d\\n\",ans);\n}\n```\n\n\n\n",
        "postTime": 1554681713,
        "uid": 38576,
        "name": "J\u03bcdge",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF611D \u3010New Year and Ancient Prophecy\u3011"
    },
    {
        "content": "**\u4e00\u9053\u7a0d\u5fae\u9700\u8981\u60f3\u4e00\u60f3\u7684\u7b80\u5355DP\u9898\u3002**\n\n\u5728[Soviet Union](http://175.24.116.241/index.php/2020/07/16/cf611d-nyaap/)\u89c2\u770b\uff01\n\n\u4e00\u773c\u770b\u51fa\u662f\u4e2aDP\uff0c\u5207\u4e86\uff0c\u72b6\u6001$dp_{i,j}$\u662f\u6700\u540e\u4e00\u4e2a\u6570\u5b57\u7684\u8303\u56f4\u662f$[i,j]$\u7684\u65b9\u6cd5\u6570\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u72b6\u6001\uff0c\u66b4\u529b\u679a\u4e3e\u4e4b\u524d\u7684\u7ed3\u5c3e\u662f$i-1$\u7684\u72b6\u6001\uff0c\u5982\u679c\u90a3\u4e2a\u72b6\u6001\u957f\u5ea6\u5c0f\u4e8e\u6216\u8005\u957f\u5ea6\u7b49\u4e8e\u4f46\u662f$substr(k,i-1)<substr(i,j)$\uff0c\u90a3\u4e48\u5c31\u8ba9\u5f53\u524d\u8fd9\u4e2a\u72b6\u6001\u52a0\u4e0a\u90a3\u4e2a\u72b6\u6001\u3002\u7136\u540eT\u4e86\u3002\n\n\u663e\u7136\u7684\uff0c\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u4e25\u683c$O(n^3)$\uff0c\u6beb\u65e0\u7591\u95ee\u5730\u4f1aT\uff0c\u90a3\u4e48\u6709\u6ca1\u6709\u4f18\u5316\u7684\u65b9\u6cd5\uff1f\u6709\uff0c\u5176\u4ed6\u9898\u89e3\u5199\u7684\u90fd\u4ec0\u4e48\u9b3c\uff1f\u5e73\u6c11\u4f18\u5316\u65b9\u6cd5\u662f\u524d\u7f00\u548c\u3002\u6211\u4eec\u6ce8\u610f\u5230\u5f53\u524d\u9762\u7684\u72b6\u6001\u7684\u957f\u5ea6\u5c0f\u4e8e\u5f53\u524d\u72b6\u6001\u7684\u65f6\u5019\u5141\u8bb8\u8df3\u8fc7\u5b57\u7b26\u4e32\u6bd4\u8f83\u76f4\u63a5\u52a0\u4e0a\u53bb\uff0c\u53ea\u6709\u5f53\u4e24\u4e2a\u72b6\u6001\u7684\u957f\u5ea6\u76f8\u540c\u7684\u65f6\u5019\u624d\u9700\u8981\u5b57\u7b26\u4e32\u6bd4\u8f83\u3002 \u90a3\u4e48\u663e\u7136\u7684\uff0c\u53ea\u8981\u5728\u72b6\u6001\u8f6c\u79fb\u7684\u65f6\u5019\u76f4\u63a5\u52a0\u4e0a\u7ed3\u5c3e\u662f$i-1$\u7684\uff0c\u957f\u5ea6\u5c0f\u4e8e\u7b49\u4e8e$j-i$\u7684\u72b6\u6001\u7684\u548c\uff0c\u7136\u540e\u518d\u770b\u548c\u5f53\u524d\u72b6\u6001\u957f\u5ea6\u76f8\u540c\u7684\u72b6\u6001\u5728\u4e4b\u524d\u6709\u6ca1\u6709\u53ef\u80fd\u51fa\u73b0\uff0c\u5982\u679c\u6709\uff0c\u5c1d\u8bd5\u6bd4\u8f83\u5b57\u7b26\u4e32\u5e76\u4e14\u52a0\u4e0a\uff08\u5982\u679c\u6bd4\u8f83\u901a\u8fc7\u53d1\u73b0\u4e4b\u524d\u72b6\u6001\u7b26\u5408\u8981\u6c42\uff09\u90a3\u4e2a\u72b6\u6001\u3002\n\n\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u4e0d\u4e25\u683c$O(n^3)$\uff0c\u56e0\u4e3a\u4ecd\u7136\u5b58\u5728\u4e00\u4e2a\u5b57\u7b26\u4e32\u6bd4\u8f83\u7684\u8fc7\u7a0b\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u662f$O(n)$\u7684\uff0c\u4e8b\u5b9e\u4e0a\uff0c\u5728\u6211\u7684[\u8bb0\u5f55](https://www.luogu.com.cn/record/35228613)\u91cc\u6709\u5f88\u591a\u4e2a\u70b9\u662f\u63a5\u8fd1\u65f6\u9650\u7684\uff0c\u5982#19,#20,#52\u7b49\uff0c\u4f46\u662f\u5929\u4f51CF\uff0c\u6211\u8fc7\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst long long Mod=1e9+7;\nlong long n,dp[5005][5005],sum[5005][5005];\nstring x;\nint main(){\n    cin>>n>>x;\n    x=\"+\"+x;\n    for(int i=1;i<=n;i++)\n        dp[1][i]=1;\n    for(int i=1;i<=n;i++){//\u5c3e\n        for(int j=i;j>=1;j--){//\u5934\n            if(x[j]=='0')\n                dp[j][i]=0;//\u524d\u5bfc\u96f6\u7279\u5224\n            else {\n                dp[j][i]=(dp[j][i]+sum[j-1][min(i-j,j-1)])%Mod;//\u76f4\u63a5\u52a0\u4e0a\u524d\u7f00\u548c\n                if(2*j-i-1>0&&x.substr(j,i-j+1)>x.substr(2*j-i-1,i-j+1))\n                    dp[j][i]=(dp[j][i]+dp[2*j-i-1][j-1])%Mod;\n            }\n            sum[i][i-j+1]=(sum[i][i-j]+dp[j][i])%Mod;//\u66f4\u65b0\u524d\u7f00\u548c\n        }\n    }\n    long long ans=0;\n    for(int i=1;i<=n;i++)\n        ans=(ans+dp[i][n])%Mod;\n    cout<<ans;\n}\n```\n\nI'm Schwarzkopf Henkal.",
        "postTime": 1594889638,
        "uid": 251723,
        "name": "Schwarzkopf_Henkal",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF611D \u3010New Year and Ancient Prophecy\u3011"
    }
]
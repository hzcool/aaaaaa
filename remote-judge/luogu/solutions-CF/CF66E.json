[
    {
        "content": "\u597d\u9898\uff01\n\n\u6211\u4eec\u5148\u6765\u8003\u8651\u4e00\u4e0b\u66b4\u529b\u641e\u8fd9\u4e2a\u4e1c\u897f\u3002\n\n\u9996\u5148\u679a\u4e3e\u4e00\u4e0b\u8981\u5224\u5b9a\u7684\u70b9\uff0c\u90a3\u4e2a\u70b9\u987a\u65f6\u9488\u9006\u65f6\u9488\u6a21\u62df\u4e00\u904d\u3002\n\n\u4e3a\u4e86\u4e0b\u9762\u4f18\u5316\u65b9\u4fbf\u4e00\u70b9\uff0c\u6211\u4eec\u8fd9\u91cc\u7edf\u4e00\u5c06\u5b83\u65ad\u73af\u4e3a\u94fe\uff0c\u5c31\u662f\u628a\u73af\u590d\u5236\u4e00\u904d\uff0c\u4ece\u4e00\u4e2a\u7aef\u70b9\u5f00\u59cb\u5230\u53e6\u5916\u4e00\u4e2a\u76f8\u540c\u7684\u7aef\u70b9\u8fd9\u6837\u4e00\u4e2a\u533a\u95f4\u3002\n\n\u66b4\u529b\u6a21\u62df\u4e00\u4e0b\u8fd9\u4e2a\u8fc7\u7a0b\uff0c\u5927\u6982\u5c31\u662f\u641e\u4e00\u4e2a $sum$ \u5b58\u4e00\u4e0b\u6bcf\u4e00\u4e2a $a_i-b_i$\u3002\n\n\u5f53\u7136\u8fd9\u91cc\u987a\u65f6\u9488\u548c\u9006\u65f6\u9488\u8981\u7a0d\u5fae\u6ce8\u610f\u4e00\u4e0b\u7ec6\u8282\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\nusing namespace std;\nconst int INF=5e5+5; \nint n,a[INF],b[INF],ans[INF];\nbool check1(int x) {\n\tint sum=0;\n\tfor (int i=x;i<n+x;i++) {\n\t\tsum+=a[i]-b[i];\n\t\tif (sum<0) return false;\n\t}\n\treturn true;\n}\n \nbool check2(int x) {\n\tint sum=0;\n\tfor (int i=x+n;i>x;i--) {\n\t\tint p=i-1;if (p==0) p=n;\n\t\tsum+=a[i]-b[p];\n\t\tif (sum<0) return false;\n\t}\n//\tfor (int i=n;i>x;i--) {\n//\t\tsum+=a[i]-b[i-1];\n//\t\tif (sum<0) return false;\n//\t}\n\treturn true;\n}\nsigned main()\n{\n\tios::sync_with_stdio(false);\n\tcin>>n;\n\tfor (int i=1;i<=n;i++) cin>>a[i];\n\tfor (int i=1;i<=n;i++) cin>>b[i];\n\t\n\tfor (int i=n+1;i<=n*2;i++) a[i]=a[i-n];\n\tfor (int i=n+1;i<=n*2;i++) b[i]=b[i-n];\n\t\n\tfor (int i=1;i<=n;i++) {\n\t\t\n\t\tint l=check1(i);\n\t\t\n\t\tint k=check2(i);\n\t\t\n\t\tif (l || k) ans[++ans[0]]=i;\n\t}\n\tcout<<ans[0]<<\"\\n\";\n\tfor (int i=1;i<=ans[0];i++)\n\t\tcout<<ans[i]<<\" \";\n\treturn 0;\n}\n```\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n^2)$\u3002\n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u4e1c\u897f\u597d\u50cf\u4e0d\u592a\u597d\u4f18\u5316\uff0c\u56e0\u4e3a\u5b83\u5173\u4e8e\u7684\u662f $a$ \u548c $b$ \u4e24\u4e2a\u5e8f\u5217\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u4ee5\u4e0b\u7684\u63cf\u8ff0\u90fd\u5728\u987a\u65f6\u9488\u4e0b\u3002\n\n\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u5176\u5b9e\u5728 check \u7684\u65f6\u5019\u53ea\u548c $a_i - b_i$ \u6709\u5173\uff0c\u4e0d\u59a8\u628a\u4ed6\u4eec\u53d8\u6210\u4e00\u4e2a\u524d\u7f00\u548c\u7684\u6837\u5b50\u3002\n\n\u7136\u540e\u4f60\u4f1a\u53d1\u73b0\u5b83\u53ef\u4ee5\u53d8\u6210 $sum_{i \\le j < i+n}-sum_{i-1} >0$ \u7684\u5f62\u5f0f\u3002\n\n\u6211\u4eec\u53d1\u73b0\u5176\u5b9e\u53f3\u8fb9\u90a3\u4e2a\u4e1c\u897f\uff0c\u5728\u786e\u5b9a $i$ \u4e4b\u540e\u662f\u4e00\u4e2a\u5b9a\u503c\u3002\n\n\u7136\u540e\u6211\u4eec\u53c8\u8981\u627e\u51fa\u4e0d\u7b26\u5408\u6761\u4ef6\u7684\uff0c\u663e\u7136\u5f53\u524d\u9762\u90a3\u4e2a\u53d6\u6700\u5c0f\u503c\u7684\u65f6\u5019\uff0c\u5982\u679c\u7b26\u5408\u6761\u4ef6\uff0c\u90a3\u4e48\u5176\u4ed6\u7684\u90fd\u7b26\u5408\u6761\u4ef6\u3002\n\n\u95ee\u9898\u8f6c\u5316\u6210\u7ef4\u62a4 $sum_{i \\le j < i+n}$ \u7684\u6700\u5c0f\u503c\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u7528\u5355\u8c03\u961f\u5217\uff0c\u7ebf\u6bb5\u6811\uff0c\u5404\u79cd\u5404\u6837\u7684\u6570\u636e\u7ed3\u6784\u90fd\u53ef\u4ee5\u7ef4\u62a4\u3002\n\n\u7136\u540e\u8fd9\u4e2a\u95ee\u9898\u5c31\u89e3\u51b3\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n)$ \u6216\u8005 $O(n \\log n)$\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\nusing namespace std;\nconst int INF=5e5+5; \nint n,a[INF],b[INF],ans[INF],sum1[INF],q1[INF],l1,r1,sum2[INF];\nint q2[INF],l2,r2;\nbool check1(int x) {\n\tint sum=-sum1[x-1];\n\t// 1 ~ n\n\t// 2 ~ n+1\n\t\n\twhile (l1<=r1 && q1[l1]<x) l1++;\n\twhile (l1<=r1 && sum1[q1[r1]]>=sum1[n+x-1]) r1--;\n\tq1[++r1]=n+x-1;\n\t\n//\tfor (int i=x;i<n+x;i++) {\n//\t\tint kk=sum+sum1[i];\n//\t\tif (kk<0) return false;\n//\t}\n\t\n\tif (sum+sum1[q1[l1]]<0) return false;\n\t\n\t// ... a[x]-b[x]\n\t// ... a[x]-b[x]+a[x+1]-b[x+1]\n\t// \n\treturn true;\n}\n\nbool check2(int x) {\n\tint sum=sum2[x+n];\n\t// 1~n\n\t// 2~n+1\n\t\n\twhile (l2<=r2 && q2[l2]<x) l2++;\n\twhile (l2<=r2 && sum2[q2[r2]]<=sum2[n+x-1]) r2--;\n\tq2[++r2]=n+x-1;\n\t\n//\tfor (int i=x+n;i>=x+1;i--) {\n//\t\tint kk=sum-sum2[i-1];\n//\t\tif (kk<0) return false;\n//\t}\n\tint kk=sum-sum2[q2[l2]];\n\tif (kk<0) return false;\n\treturn true;\n}\nsigned main()\n{\n\tios::sync_with_stdio(false);\n\tcin>>n;\n\tfor (int i=1;i<=n;i++) cin>>a[i];\n\tfor (int i=1;i<=n;i++) cin>>b[i];\n\t\n\tfor (int i=n+1;i<=n*2;i++) a[i]=a[i-n];\n\tfor (int i=n+1;i<=n*2;i++) b[i]=b[i-n];\n\t\n\tfor (int i=1;i<=n*2;i++) sum1[i]=sum1[i-1]+a[i]-b[i];l1=1;\n\tfor (int i=1;i<=n*2;i++) sum2[i]=sum2[i-1]+a[i]-b[i-1];l2=1;\n\t\n\t\n\tfor (int i=1;i<n;i++) {\n\t\twhile (l1<=r1 && sum1[q1[r1]]>=sum1[i]) r1--;\n\t\tq1[++r1]=i;\n\t}\n\t\n\tfor (int i=1;i<n;i++) {\n\t\twhile (l2<=r2 && sum2[q2[r2]]<=sum2[i]) r2--;\n\t\tq2[++r2]=i;\n\t}\n\t\n\tfor (int i=1;i<=n;i++) {\n\t\tint l=check1(i);\n\t\tint k=check2(i);\n\t\tif (l || k) ans[++ans[0]]=i;\n\t}\n\tcout<<ans[0]<<\"\\n\";\n\tfor (int i=1;i<=ans[0];i++)\n\t\tcout<<ans[i]<<\" \";\n\treturn 0;\n}\n```\n",
        "postTime": 1655132418,
        "uid": 208653,
        "name": "_edge_",
        "ccfLevel": 0,
        "title": "CF66E"
    },
    {
        "content": "## \u9898\u610f\n\u6c42\u95ee\u4e00\u4e2a\u73af\u4e2d\u6ee1\u8db3\u9006\u65f6\u9488\u8d70\u6216\u8005\u987a\u65f6\u9488\u8d70\uff0c\u53ef\u4ee5\u5230\u8fbe\u8d77\u70b9\u7684\u70b9\u7684\u4e2a\u6570\u548c\u7f16\u53f7\u3002\n## \u5206\u6790\n\u6839\u636e\u9898\u610f\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u6734\u7d20\u7684 $O(n^3)$ \u7684\u66b4\u529b\u3002\n$$\nans = \\sum_i^n[\\sum_j^{i+n}\\sum_{k=i}^{j}(A[k]-B[k]) >0]\n$$\n\u53ef\u4ee5\u8fd0\u7528\u524d\u7f00\u548c\u53ef\u4ee5\u4f18\u5316\u4e3a $O(n^2)$ \u3002\n$$\nans = \\sum_i^n[\\sum_j^{i+n} sum[j] - sum[i-1]>0] \n$$\n\u53d1\u73b0\u7b97\u6cd5\u7684\u74f6\u9888\u5728\u4e8e\u6c42\u51fa\u4e00\u4e2a\u6700\u5c0f\u503c\uff0c\u90a3\u4e48\u6211\u4eec\u8fd0\u7528\u7ebf\u6bb5\u6811\u6216\u8005 $st$ \u8868\u7ef4\u62a4\u3002\u590d\u6742\u5ea6\u4e3a $O(n\\log n)$ \u3002\n$$\nans = \\sum_i^n[sum_{min} - sum_{i-1} >0] \n$$\n\u4ee3\u7801\u5c31\u7b80\u5355\u4e86\u3002\u5176\u5b9e\u597d\u50cf\u53ef\u4ee5\u7528\u5355\u8c03\u961f\u5217\u4f18\u5316\u5230 $O(n)$ \uff0c\u5176\u4e2d\u6709\u4e2a\u7834\u73af\u6210\u94fe\u7684\u5c0f\u6280\u5de7\u3002\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ninline int read()\n{\n    int x=0,f=1;\n    char ch=getchar();\n    while(ch<'0'||ch>'9')\n    {\n        if(ch=='-')\n            f=-1;\n        ch=getchar();\n    }\n    while(ch>='0'&&ch<='9')\n    {\n        x=x*10+ch-'0';\n        ch=getchar();\n    }\n    return x*f;\n}\nconst int N = 2e5+10;\nint sum[N],st[N][23],n,ans;\nint Query(int l,int r)\n{\n    int k=log2(r-l+1); \n    return min(st[l][k],st[r-(1<<k)+1][k]);\n}\nbool vis[N];\nvoid work(int A[],int B[],int p)\n{\n\tmemset(sum,0,sizeof(sum));\n\tmemset(st,0,sizeof(st));\n\tfor(int i = 1;i <= n*2;i++)\n\t{\n\t\tif(i <= n)\n\t\tsum[i] = sum[i-1] + (A[i] - B[i]);\n\t\telse \n\t\tsum[i] = sum[i-1] + (A[i-n] - B[i-n]);\n\t\tst[i][0] = sum[i];\n\t}\n\tfor(int j=1;j<=21;j++)\n    for(int i=1;i+(1<<j)-1<=2*n;i++)\n        st[i][j]=min(st[i][j-1],st[i+(1<<(j-1))][j-1]);\n    for(int i = 1;i <= n;i++)\n    {\n    \tif(Query(i,i+n-1) - sum[i-1] < 0) continue;\n    \tif(!vis[i] && !p) \n    \t{\n    \t\tvis[i] = 1;\n    \t\tans++;\n\t\t}\n\t\tif(!vis[n-i+1] && p)\n\t\t{\n\t\t\tvis[n-i+1] = 1;\n\t\t\tans++;\n\t\t}\n\t}\n}\nint A[N],B[N],C[N],D[N];\nint main()\n{\n\tn = read();\n\tfor(int i = 1;i <= n;i++) A[i] = read();\n\tfor(int i = 1;i <= n;i++) B[i] = read();\n\twork(A,B,0);\n\tfor(int i = 1;i <= n/2;i++) \n\tB[0] = B[n];\n\tfor(int i = 1;i <= n;i++)\n\tC[i] = B[i-1],D[i] = A[i];\n\tfor(int i = 1;i <= n;i++)\n\tB[i] = C[n-i+1];\n\tfor(int i = 1;i <= n;i++)\n\tA[i] = D[n-i+1];\n\twork(A,B,1);\n\tcout<<ans<<endl;\n\tfor(int i = 1;i <= n;i++)\n\tif(vis[i]) cout<<i<<\" \";\n}\n\n\n```\n[\u5730\u5740](https://www.luogu.com.cn/blog/xzc/solution-cf66e)\n",
        "postTime": 1591586646,
        "uid": 227824,
        "name": "JK_LOVER",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF66E \u3010Petya and Post\u3011"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF66E)\n## \u601d\u8def\n\u7ed9\u51fa\u4e00\u79cd\u6bd4\u8f83\u66b4\u529b\u7684\u505a\u6cd5\u3002\n\n\u5148\u8003\u8651\u641e\u51fa\u6b63\u5411\u7684\u7b54\u6848\u3002\n\n\u663e\u7136\uff0c\u82e5\u4ece $1$ \u5f00\u59cb\uff0c\u5219\u5230\u8fbe\u6bcf\u4e00\u4e2a\u52a0\u6cb9\u7ad9\u7684\u65f6\u7684\u548c\u4e3a $a_1-b_1,a_1-b_1+a_2-b_2,a_1-b_1+a_2-b_2+a_3-b_3,...$\n\n\u82e5\u8fd9\u4e9b\u6570\u4e2d\u6709\u4e00\u4e2a $<0$\uff0c\u90a3\u4e48\u8fd9\u4e2a\u4f4d\u7f6e\u5c31\u4e0d\u7b26\u5408\u3002\n\n\u6211\u4eec\u53d1\u73b0\u76f4\u63a5\u5904\u7406\u662f $O(n^2)$ \u7684\u3002\n\n\u8003\u8651\u7528\u6570\u636e\u7ed3\u6784\u4f18\u5316\u3002\n\n\u5148\u5217\u51fa\u4ece $2,3$ \u5f00\u59cb\u7684\u548c\uff1a\n\n+ $2:$ $a_2-b_2,a_2-b_2+a_3-b_3,a_2-b_2+a_3-b_3+a_4-b_4,...$\n+ $3:$ $a_3-b_3,a_3-b_3+a_4-b_4,a_3-b_3+a_4-b_4+a_5-b_5,...$\n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u4e9b\u67ff\u5b50\u5927\u90e8\u5206\u90fd\u662f\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u8003\u8651\u7ebf\u6bb5\u6811\u4e71\u641e\u3002\n\n\u8bbe $d_i$ \u8868\u793a\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u7684\u548c\u3002\n\n\u5047\u8bbe\u5f53\u524d\u662f\u4ece $i$ \u5f00\u59cb\uff0c\u90a3\u4e48\u6211\u4eec\u8be5\u5982\u4f55\u8f6c\u5230\u4ece $i+1$ \u5f00\u59cb\u5462\uff1f\u5c31\u76f4\u63a5\u7ed9\u9664 $i$ \u4ee5\u5916\u7684\u70b9 $\\verb!update!$ \u4e00\u4e2a $-(a_i-b_i)$\uff0c\u7136\u540e\u628a $i$ \u6539\u6210 $d_n$ \u5373\u53ef\u3002\n\n\u8fd9\u4e2a\u8bf7\u8bfb\u8005\u81ea\u884c\u7406\u89e3\uff0c\u6bd4\u8f83\u7b80\u5355\u3002\n\n\u5012\u5411\u7684\u76f4\u63a5 $\\verb!reverse!$ \u5373\u53ef\uff0c\u6ce8\u610f\u8981\u6e05\u7a7a\u7ebf\u6bb5\u6811\u7684 $\\verb!lazy!$ \u6807\u8bb0\uff0c~~\u6211\u5c31\u662f\u56e0\u4e3a\u8fd9\u4e2a\u8c03\u4e86\u4e00\u4e2a\u5c0f\u65f6~~\u3002\n\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint const N=1e5+10;\nint d[N];\nstruct Segment_Tree{\n    #define ls (x<<1)\n    #define rs (x<<1|1)\n    #define mid ((l+r)>>1)\n    int c[N<<2],lazy[N<<2];\n    inline void build(int x,int l,int r){\n        if (l==r){c[x]=d[l];return;}\n        build(ls,l,mid);build(rs,mid+1,r);\n        c[x]=min(c[ls],c[rs]);\n    }\n    inline void pushdown(int x){\n        c[ls]-=lazy[x];c[rs]-=lazy[x];\n        lazy[ls]+=lazy[x];lazy[rs]+=lazy[x];\n        lazy[x]=0;\n    }\n    inline void update(int x,int l,int r,int ll,int rr,int v){\n        if (ll<=l && r<=rr){lazy[x]+=v;c[x]-=v;return;}\n        pushdown(x);\n        if (ll<=mid) update(ls,l,mid,ll,rr,v);\n        if (mid<rr) update(rs,mid+1,r,ll,rr,v);\n        c[x]=min(c[ls],c[rs]);\n    }\n}T;\nint a[N],b[N],cc[N];\nint main(){\n    int n;\n    //\u8bfb\u5165\n    int num=0;vector<int>ans;\n    for (int i=1;i<=n;++i) d[i]=d[i-1]+a[i]-b[i];\n    num=d[n];\n    T.build(1,1,n);\n    for (int i=1;i<=n;++i){\n        if (T.c[1]>=0) ans.push_back(i);\n        if (i!=1) T.update(1,1,n,1,i-1,a[i]-b[i]);\n        if (i!=n) T.update(1,1,n,i+1,n,a[i]-b[i]);\n        int now=num-(a[i]-b[i]);\n        T.update(1,1,n,i,i,-now);\n    }\n    for (int i=1;i<=n;++i) cc[i]=b[i];\n    int now=b[n];\n    for (int i=1;i<n;++i) b[i+1]=cc[i];\n    b[1]=now;//\u56e0\u4e3a b[i] \u8868\u793a i \u5230 i+1 \u7684 dis\uff0c\u6240\u4ee5\u5012\u7f6e\u7684\u65f6\u5019\u4f1a\u51fa\u73b0\u4e00\u70b9\u95ee\u9898\uff0c\u9700\u8981\u6574\u4f53\u4f4d\u79fb\n    reverse(a+1,a+n+1);\n    reverse(b+1,b+n+1);\n    memset(T.c,0,sizeof(T.c));\n    memset(T.lazy,0,sizeof(T.lazy));\n    memset(d,0,sizeof(d));\n    num=0;\n    for (int i=1;i<=n;++i) d[i]=d[i-1]+a[i]-b[i];\n    num=d[n];\n    T.build(1,1,n);\n    for (int i=1;i<=n;++i){\n        if (T.c[1]>=0) ans.push_back(n-i+1);\n        if (i!=1) T.update(1,1,n,1,i-1,a[i]-b[i]);\n        if (i!=n) T.update(1,1,n,i+1,n,a[i]-b[i]);\n        int now=num-(a[i]-b[i]);\n        T.update(1,1,n,i,i,-now);\n    }\n    sort(ans.begin(),ans.end());\n    ans.erase(unique(ans.begin(),ans.end()),ans.end());\n    io.writeln(ans.size());\n    for (auto i:ans) io.write(i),io.push(' ');\n    io.push('\\n');\n    return 0;\n}\n```\n",
        "postTime": 1665450675,
        "uid": 253608,
        "name": "Tx_Lcy",
        "ccfLevel": 7,
        "title": "CF66E Petya and Post"
    }
]
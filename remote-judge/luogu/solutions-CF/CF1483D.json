[
    {
        "content": "\u672c\u9898\u7ffb\u8bd1\u6765\u4ea4\u9898\u89e3\u62c9\uff01\n\n\u9996\u5148\u8fd9\u4e2a\u9898\u76ee\u8981\u6c42\u6211\u4eec\u6c42\uff1a\u6709\u7528\u8fb9\u7684\u6570\u91cf\u3002\u6211\u4eec\u6839\u636e\u9898\u610f\u53ef\u77e5\uff0c\u5982\u679c\u4e00\u6761\u8fb9 $x,y,c$ \u4e0e\u4e09\u5143\u7ec4 $(u,v,l)$ \u5408\u6cd5\uff0c\u90a3\u4e48\u80af\u5b9a\u8981\u5177\u5907\u4ee5\u4e0b\u7684\u6027\u8d28\uff1a\n\n$$dis_{u,x}+dis_{v,y}+c\u2264l$$\n\n\u9996\u5148\u8003\u8651\u66b4\u529b\u3002\u66b4\u529b\u679a\u4e3e\u8fb9+\u4e09\u5143\u7ec4\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^4)$ \uff0c\u663e\u7136\uff0c\u5c31\u7b97 `wys` \u90fd\u6551\u4e0d\u4e86\u8fd9\u4e2a\u7684\u590d\u6742\u5ea6\u3002\uff08\u8feb\u5bb3\n\n\u4f46\u6211\u4eec\u771f\u7684\u6709\u5fc5\u8981\u679a\u4e3e\u56db\u4e2a\u5417\uff1f\n\n\u4e8e\u662f\u6211\u4eec\u6362\u4e2a\u601d\u8def\u3002\u679a\u4e3e\u5bf9\u89d2\u7ebf\u4e0a\u7684\u70b9\u3002\u8fd9\u6837\u53ef\u4ee5\u5c06\u679a\u4e3e\u62c6\u6210\u4e24\u4e2a\u4e0d\u76f8\u5e72\u7684\u90e8\u5206\u3002\n\n\u8fd9\u6837\uff0c\u4e0a\u9762\u7684\u8fd9\u4e2a\u4e0d\u7b49\u5f0f\u53ef\u4ee5\u6539\u4e3a\u4e0b\u9762\u8fd9\u4e2a\uff1a$dis[v][y]+c\u2264l-dis[u][x]$\u3002\n\n\u60f3\u8ba9\u8fd9\u4e2a\u5f0f\u5408\u6cd5\uff0c\u800c\u4e24\u8fb9\u90fd\u4e0d\u76f8\u5173\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u627e\u53f3\u8fb9\u7684\u6700\u5927\u503c\uff08\u679a\u4e3e $u$\uff09\uff0c\u7136\u540e\u679a\u4e3e $y$ \u5c31\u53ef\u4ee5\u5224\u65ad\u8fd9\u4e2a\u5f0f\u662f\u5426\u6210\u7acb\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3)$\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <iostream> //\u4e3a\u4e86 max \u4e0e min \u51fd\u6570\u3002\u5f53\u7136\u4f60\u53ef\u4ee5\u81ea\u5df1\u5199\u4e00\u4e2a\u3002\nusing namespace std;\n#define int long long\nconst int MAXN = 605;\nconst int N = MAXN * MAXN;\nconst int inf = 1e18;\nint read()\n{\n\tint x = 0, f = 1; char c;\n\twhile ((c = getchar()) < '0' || c > '9') { if (c == '-') f = -1; }\n\twhile (c >= '0' && c <= '9') { x = (x << 3) + (x << 1) + (c ^ 48); c = getchar(); }\n\treturn x * f;\n}\nint n, m, q, ans, a[N], b[N], c[MAXN][MAXN], d[MAXN][MAXN], l[MAXN][MAXN], ok[MAXN][MAXN];\nsigned main()\n{\n\tn = read(); m = read();\n\tmemset(d, 0x3f, sizeof d);\n\tmemset(c, 0x3f, sizeof c);\n\t//\u8fd9\u91cc\u5fc5\u987b\u8981\u662f 0x3f\n\tfor (int i = 1; i <= n; i++)\n\t\td[i][i] = 0;\n\tfor (int i = 1; i <= m; i++)\n\t{\n\t\ta[i] = read(); b[i] = read();\n\t\tc[a[i]][b[i]] = c[b[i]][a[i]] =\n\t\t\td[a[i]][b[i]] = d[b[i]][a[i]] = read();\n\t}\n\tfor (int k = 1; k <= n; k++)\n\t\tfor (int i = 1; i <= n; i++)\n\t\t\tfor (int j = 1; j <= n; j++)\n\t\t\t\td[i][j] = min(d[i][j], d[i][k] + d[k][j]);\n\tq = read();\n\twhile (q--)\n\t{\n\t\tint u = read(), v = read(), c = read();\n\t\tl[u][v] = l[v][u] = c;\n\t}\n\tfor (int v = 1; v <= n; v++)\n\t\tfor (int x = 1; x <= n; x++)\n\t\t{\n\t\t\tint mr = 0;\n\t\t\tfor (int u = 1; u <= n; u++)\n\t\t\t\tmr = max(mr, l[u][v] - d[u][x]);\n\t\t\tfor (int y = 1; y <= n; y++)\n\t\t\t\tif (d[v][y] + c[x][y] <= mr)\n\t\t\t\t\tok[x][y] = ok[y][x] = 1;\n\t\t}\n\tfor (int i = 1; i <= m; i++)\n\t\tif (ok[a[i]][b[i]]) ans++;\n\tprintf(\"%lld\\n\", ans);\n}\n```\n\u7801\u5b57+\u7ffb\u8bd1\u4e0d\u6613 \u6c42\u5ba1\u6838\u901a\u8fc7~\n\nUpd7.18:\u66f4\u65b0\u4e86\u8bf4\u660e",
        "postTime": 1621603465,
        "uid": 427623,
        "name": "XiaoQuQu",
        "ccfLevel": 4,
        "title": "CF1483D\u9898\u89e3"
    },
    {
        "content": "# \u58f9\u3001\u9898\u76ee\u63cf\u8ff0 &para;\n\n[\u4f20\u9001\u95e8 to Luogu](https://www.luogu.com.cn/problem/CF1483D).\n\n# \u8d30\u3001\u9898\u89e3 &para;\n\n\u8bb0 $\\text{dis}(a,b)$ \u8868\u793a\u56fe\u4e2d\u7531 $a$ \u5230 $b$ \u7684\u6700\u77ed\u8ddd\u79bb\u3002\n\n\u8003\u8651\u4e00\u5bf9\u4e09\u5143\u7ec4 $\\lang u_i,v_i,l_i\\rang$\uff0c\u5bf9\u4e8e\u4e00\u6761\u8fb9 $\\lang a,b,w\\rang$\uff0c\u5982\u679c\u5b83\u662f \u201c\u6709\u7528\u7684\u201d\uff0c\u90a3\u4e48\u5fc5\u987b\u6ee1\u8db3\uff1a\n$$\n\\text{dis}(u_i,a)+w+\\text{dis}(b,v_i)\\le l_i\n$$\n\u663e\u7136\uff0c\u6211\u4eec\u66b4\u529b\u53bb\u5339\u914d\u4e00\u4e2a\u4e09\u5143\u7ec4\u548c\u4e00\u6761\u8fb9\uff0c\u590d\u6742\u5ea6\u8fbe\u5230\u4e86 $\\mathcal O(n^4)$\uff0c\u8fd9\u662f\u4e0d\u53ef\u63a5\u53d7\u7684\u3002\n\n\u8003\u8651\u679a\u4e3e\u7684\u91cd\u590d\u70b9\uff0c\u4f3c\u4e4e\u5bf9\u4e8e\u6bcf\u4e00\u6761\u8fb9\u6211\u4eec\u90fd\u91cd\u590d\u8bbf\u95ee\u4e86\u8bb8\u591a\u6b21\uff0c\u6211\u4eec\u80fd\u5426\u56fa\u5b9a\u4e00\u4e2a\u4e09\u5143\u7ec4\u7684\u5176\u4e2d\u4e00\u4e2a\u70b9\uff0c\u7528\u8fd9\u4e2a\u70b9\u53bb\u5339\u914d\u8fb9\uff1f\u5982\u679c\u6211\u4eec\u5c06\u4e09\u5143\u7ec4\u7684 $u_i$ \u56fa\u5b9a\uff0c\u5373\u6211\u4eec\u9009\u62e9\u679a\u4e3e $u$\uff0c\u90a3\u4e48\u6211\u4eec\u7684\u4e0d\u7b49\u5f0f\u53d8\u6210\u4e86\uff1a\n$$\n\\begin{aligned}\n&\\text{dis}(u,a)+w+\\text{dis}(b,v_i)\\le l_i \\\\\n\\Rightarrow &\\text{dis}(u,a)+w\\le l_i-\\text{dis}(b,v_i)\n\\end{aligned}\n$$\n\u62ec\u53f7\u5de6\u8fb9\uff0c\u5c31\u662f\u6211\u4eec\u679a\u4e3e\u65f6\u7684\u56fa\u5b9a\u503c\uff0c\u5bf9\u4e8e\u53f3\u8fb9\uff0c\u6211\u4eec\u53d1\u73b0\u5b83\u5b9e\u9645\u4e0a\u548c\u72ec\u7acb\u7684 $b$ \u6709\u5173\uff0c\u6211\u4eec\u80fd\u5426\u5c06 $l_i-\\text{dis}(b,v_i)$ \u9884\u5904\u7406\u51fa\u6765\uff1f\n\n\u82e5\n$$\n\\text{cei}(u,b)\\overset\\Delta=\\min\\{l-\\text{dis}(b,v)\\mid \\lang u,v,l\\rang\\in T\\}\n$$\n\u5176\u4e2d $T$ \u662f\u4e09\u5143\u7ec4\u96c6\u5408\u3002\n\n\u90a3\u4e48\uff0c\u6211\u4eec\u7684\u4e0d\u7b49\u5f0f\u5c31\u662f\n$$\n\\text{dis}(u,a)+w\\le \\text{cei}(u,b)\n$$\n\u8003\u8651 $\\text{cei}(u,b)$ \u5982\u4f55\u5feb\u901f\u5904\u7406\uff1f\u53ea\u9700\u8981\u679a\u4e3e\u6bcf\u4e00\u4e2a\u4e09\u5143\u7ec4\uff0c\u518d\u679a\u4e3e\u4e00\u4e2a\u70b9\u5373\u53ef\u3002\n\n\u9884\u5904\u7406\u590d\u6742\u5ea6 $\\mathcal O(n^3)$\uff0c\u8dd1 $\\tt floyd$ \u7684\u590d\u6742\u5ea6\u662f $\\mathcal O(n^3)$\uff0c\u8ba1\u7b97\u7b54\u6848\u7684\u590d\u6742\u5ea6\u662f $\\mathcal O(n^3)$\uff0c\u90a3\u4e48\u603b\u590d\u6742\u5ea6\u5c31\u662f $\\mathcal O(n^3)$ \u4e86\u3002\n\n# \u53c1\u3001\u53c2\u8003\u4ee3\u7801 &para;\n\n```cpp\n#include<cstdio>\n#include<vector>\n#include<cmath>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\n\n#define NDEBUG\n#include<cassert>\n\n#define Endl putchar('\\n')\n#define mp(a, b) make_pair(a, b)\n#define rep(i, l, r) for(int i=(l), i##_end_=(r); i<=i##_end_; ++i)\n#define fep(i, l, r) for(int i=(l), i##_end_=(r); i>=i##_end_; --i)\n#define fi first\n#define se second\ntypedef long long ll;\ntypedef pair<int, int> pii;\ntemplate<class T>inline T fab(T x){ return x<0? -x: x; }\ntemplate<class T>inline T readin(T x){\n\tx=0; int f=0; char c;\n\twhile((c=getchar())<'0' || '9'<c) if(c=='-') f=1;\n\tfor(x=(c^48); '0'<=(c=getchar()) && c<='9'; x=(x<<1)+(x<<3)+(c^48));\n\treturn f? -x: x;\n}\n\nconst int maxn=600;\nconst int maxm=maxn*maxn;\n\nstruct edge{\n    int u, v, w;\n    edge(){}\n    edge(int U, int V, int W): u(U), v(V), w(W){}\n}e[maxm+5];\n\nstruct trituple{\n    int u, v, l;\n    trituple(){}\n    trituple(int U, int V, int L): u(U), v(V), l(L){}\n}tri[maxm+5];\n\nll f[maxn+5][maxn+5];\nint n, m, q;\n\ninline void input(){\n    n=readin(1), m=readin(1);\n    memset(f, 0x3f, sizeof f);\n    int u, v, w;\n    rep(i, 1, m){\n        u=readin(1), v=readin(1), w=readin(1);\n        f[u][v]=f[v][u]=w;\n        e[i]=edge(u, v, w);\n    }\n}\n\ninline void floyd(){\n    rep(i, 1, n) f[i][i]=0;\n    rep(k, 1, n) rep(i, 1, n) if(i!=k)\n        rep(j, 1, n) if(j!=i && j!=k)\n            f[i][j]=min(f[i][j], f[i][k]+f[k][j]);\n}\n\ninline void gettuple(){\n    q=readin(1);\n    int u, v, l;\n    rep(i, 1, q){\n        u=readin(1), v=readin(1), l=readin(1);\n        tri[i]=trituple(u, v, l);\n    }\n}\n\nll cei[maxn+5][maxn+5];\n\ninline void getminn(){\n    memset(cei, -0x3f, sizeof cei);\n    int u, v, l;\n    rep(i, 1, q){\n        u=tri[i].u, v=tri[i].v, l=tri[i].l;\n        rep(i, 1, n){\n            cei[u][i]=max(l-f[i][v], cei[u][i]);\n            cei[v][i]=max(l-f[i][u], cei[v][i]);\n        }\n    }\n}\n\nint vis[maxm+5];\ninline void getans(){\n    int ans=0, a, b, w;\n    rep(u, 1, n){\n        rep(i, 1, m) if(!vis[i]){\n            a=e[i].u, b=e[i].v, w=e[i].w;\n            if(f[u][a]+w<=cei[u][b] || f[u][b]+w<=cei[u][a])\n                vis[i]=1, ++ans;\n        }\n    }\n    printf(\"%d\\n\", ans);\n}\n\nsigned main(){\n    input();\n    floyd();\n    gettuple();\n    getminn();\n    getans();\n    return 0;\n}\n```\n\n# \u8086\u3001\u7528\u5230 \u306e Trick\n\n\u5f53\u5339\u914d\u592a\u4e71\u65f6\uff0c\u56fa\u5b9a\u4e00\u4e2a\u53c2\u6570\u5427\uff0c\u4ed6\u4f1a\u8ba9\u4f60\u7684\u679a\u4e3e\u53d8\u5f97\u6709\u5e8f\uff0c\u91cd\u590d\u679a\u4e3e\u7684\u90e8\u5206\u4e5f\u4f1a\u53d8\u5c11\u3002",
        "postTime": 1621045147,
        "uid": 125355,
        "name": "Vladilena",
        "ccfLevel": 0,
        "title": "CF1483D Useful Edges"
    },
    {
        "content": "\u9996\u5148\u53d1\u73b0\u66b4\u529b\u662f $O(m)$ \u679a\u4e3e\u8fb9\u518d\u679a\u4e3e $q$ \u4e2d\u7684\u4e09\u5143\u7ec4\u5224\u65ad\u8be5\u8fb9\u53ef\u4e0d\u53ef\u884c\u3002\u8fd9\u6837\u505a\u662f $O(n^4)$ \u7684\uff0c\u8003\u8651\u4f18\u5316\u3002\n\n\u53d1\u73b0\u679a\u4e3e\u8fb9\u7684\u8fc7\u7a0b\u4e0d\u597d\u4f18\u5316\uff0c\u4e8e\u662f\u8003\u8651\u4f18\u5316\u679a\u4e3e\u4e09\u5143\u7ec4\u7684\u8fc7\u7a0b\uff0c\u5c06\u5176\u7b80\u5316\u5230 $O(n)$\u3002\n\n\u5047\u8bbe\u679a\u4e3e\u4e00\u6761\u8fb9 $(v,u)$\uff0c\u518d\u679a\u4e3e $q$ \u4e2d\u4e00\u4e2a\u7aef\u70b9 $i$\uff0c\u82e5\u8fd9\u6761\u8fb9\u5408\u6cd5\uff0c\u5219\u5b58\u5728\u4e00\u4e2a $j$ \u4f7f\u5f97 $l_{(i,j)}\\ge dis(i,v)+dis(v,u)+dis(u,j)$\uff0c\u5c06\u56fa\u5b9a\u7684\u503c\u653e\u5728\u53f3\u8fb9\uff0c\u6709 $l_{(i,j)}-dis(u,j)\\ge dis(i,v)+dis(v,u)$\u3002\n\n\u6240\u4ee5\u53ea\u8981\u80fd\u9884\u5904\u7406 $\\max(l_{(i,j)}-dis(u,j))$ \u5c31\u80fd $O(m)$ \u679a\u4e3e\u8fb9\u518d $O(n)$ \u679a\u4e3e\u4e00\u4e2a\u7aef\u70b9\u53bb\u5224\u65ad\u4e86\uff0c\u8bb0\u5176\u4e3a  $pre[i][u]$\u3002\n\n\u8fd9\u4e2a\u9884\u5904\u7406\u8fc7\u7a0b\u53ef\u4ee5\u901a\u8fc7\u7c7b\u4f3c\u7684 $O(q)$ \u679a\u4e3e\u6240\u6709\u4e09\u5143\u7ec4\uff0c$O(n)$ \u679a\u4e3e\u4e00\u4e2a\u70b9\u6765\u5904\u7406\u3002\n\n\u590d\u6742\u5ea6 $O(n^3)$.\n\ncode\uff1a\n\n```cpp\n#define ll long long\n#define ri register int\n#define pb push_back\n#define mp make_pair\n#define inf 1000000000000000000\n#define N 605\nint x,y,z,n,m,ok[N*N],q;\nll dis[N][N],pre[N][N];\nvector<pair<int,int> > l[N*N];\ninline void floyd(){\n    for(ri k=1;k<=n;++k){\n        for(ri i=1;i<=n;++i){\n            if(i==k) continue;\n            for(ri j=1;j<=n;++j){\n                if(j==i||j==k) continue;\n                dis[i][j]=min(dis[i][j],dis[i][k]+dis[k][j]);\n            }\n        }\n    }\n}\nstruct node{\n    int from,to;\n    ll val;\n}star[(N*N)<<1];\nint wl=0;\nint main()\n{\n\tn=rd(),m=rd();\n\tmemset(dis,0x3f,sizeof(dis));\n\tfor(ri i=1;i<=n;++i) dis[i][i]=0;\n\tfor(ri i=1;i<=m;++i){\n        x=rd(),y=rd(),z=rd();\n        dis[x][y]=dis[y][x]=z;\n        star[++wl].from=x,star[wl].to=y,star[wl].val=z;\n        star[++wl].from=y,star[wl].to=x,star[wl].val=z;\n    }\n    q=rd();\n    for(ri i=1;i<=q;++i){\n        x=rd(),y=rd(),z=rd();\n        l[x].pb(mp(y,z));\n    }\n    floyd();\n    for(ri u=1;u<=n;++u){\n        for(ri i=1;i<=n;++i){\n            pre[i][u]=-inf;\n            for(ri k=0;k<(int)l[i].size();++k){\n                int j=l[i][k].first;\n                ll len=l[i][k].second;\n                pre[i][u]=max(pre[i][u],len-dis[u][j]);\n            }\n        }\n    }\n    for(ri e=1;e<=wl;++e){\n        int v=star[e].from,u=star[e].to;\n        ll val=star[e].val;\n        for(ri i=1;i<=n;++i) if(pre[i][u]>=dis[i][v]+val) ok[(e+1)/2]=1;\n    }\n    int ans=0;\n    for(ri i=1;i<=wl/2;++i) if(ok[i]) ans++;\n    cout<<ans;\n    return 0;\n}\n\n```\n",
        "postTime": 1616484971,
        "uid": 135839,
        "name": "Fairicle",
        "ccfLevel": 6,
        "title": "CF1483D"
    }
]
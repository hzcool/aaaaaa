[
    {
        "content": "\u679a\u4e3e\u4e09\u89d2\u5f62\u7684\u4e00\u4e2a\u9876\u70b9$(x,y)$\uff0c\u5e76\u8bb0\u53e6\u5916\u4e24\u4e2a\u9876\u70b9\u4e3a$(x_1,y_1)$\u548c$(x_2,y_2)$\n\n\u6839\u636e\u53c9\u79ef\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u8fd9\u4e2a\u4e09\u89d2\u5f62\u9762\u79ef\u7684\u4e24\u500d\u4e3a$|(x_1-x)(y_2-y)+(x_2-x)(y_1-y)|$.\n\n\u6240\u4ee5\u8fd9\u4e2a\u4e09\u89d2\u5f62\u9762\u79ef\u662f\u5426\u4e3a\u6574\u6570\u4ec5\u53d6\u51b3\u4e8e$x,y,x_1,y_1,x_2,y_2$\u7684\u5947\u5076\u6027\uff08parity\uff09\uff0c\u53ea\u9700\u679a\u4e3e$2^6$\u79cd\u60c5\u51b5\u5373\u53ef\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u51cf\u53bb\u9000\u5316\u4e09\u89d2\u5f62\u7684\u8d21\u732e\uff0c\u679a\u4e3e\u4e00\u6761\u7ebf\u6bb5\u7684\u6c34\u5e73\u5bbd\u4e0e\u94c5\u5782\u9ad8$i,j$\uff08\u5f53$i=0$\u4e14$j=0$\u65f6\u7ebf\u6bb5\u9000\u5316\u6210\u4e00\u4e2a\u70b9\uff09\u3002\u6ee1\u8db3\u6761\u4ef6\u7684\u7ebf\u6bb5\u4e2a\u6570\u4e3a$(n-i+1)(m-j+1)$\uff0c\u4e14\u6bcf\u4e00\u6761\u8fd9\u6837\u7684\u7ebf\u6bb5\u4e0a\u603b\u5171\u6709$\\gcd(i,j)+1$\u4e2a\u6574\u70b9\u3002\n\n\u90a3\u4e48\u65e0\u975e\u662f\u8981\u6c42\n$$\\sum_{i=1}^n\\sum_{j=1}^m\\gcd(i,j)=\\sum_{d=1}^{\\min(n,m)}\\varphi(d)\\left\\lfloor\\frac{n}{d}\\right\\rfloor\\left\\lfloor\n\\frac{m}{d}\\right\\rfloor$$\n$$\\sum_{i=1}^n\\sum_{j=1}^mi\\gcd(i,j)=\\sum_{d=1}^{\\min(n,m)}d\\varphi(d)S\\left(\\left\\lfloor\\frac{n}{d}\\right\\rfloor\\right)\\left\\lfloor\\frac{m}{d}\\right\\rfloor$$\n$$\\sum_{i=1}^n\\sum_{j=1}^mij\\gcd(i,j)=\\sum_{d=1}^{\\min(n,m)}d^2\\varphi(d)S\\left(\\left\\lfloor\\frac{n}{d}\\right\\rfloor\\right)S\\left(\\left\\lfloor\\frac{m}{d}\\right\\rfloor\\right)$$\n\u8fd9\u51e0\u7c7b\u5f0f\u5b50\u7684\u503c\u3002\n\n\u672c\u9898\u6570\u636e\u6bd4\u8f83\u5c0f\uff0c$O(n)$\u548c$O(n^2)$\u7686\u53ef\u8fc7\u3002",
        "postTime": 1607068003,
        "uid": 139340,
        "name": "Gauss0320",
        "ccfLevel": 0,
        "title": "Solution\u300cCodeForces  220D\u300d"
    }
]
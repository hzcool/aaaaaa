[
    {
        "content": "\u65b9\u6cd51\uff1a\u6734\u7d20\u533a\u95f4dp\uff08\u975e\u6807\u7b97\uff09\n\n\u770b\u5230\u8fd9\u9053\u9898\uff0c\u8bb8\u591a\u4eba\u7684\u7b2c\u4e00\u53cd\u5e94\u5c31\u662f\u533a\u95f4dp\u3002dp(i,j)\u8868\u793a\u5904\u7406\u5b8ci-j\u8fd9\u4e2a\u533a\u95f4\u7684\u65b9\u6848\u6570\u3002\n\n\u770b\u4e0b\u6570\u636e\u8303\u56f4n<=2000\u3002\u533a\u95f4dp\u65f6\u95f4\u590d\u6742\u5ea6n^3\uff0c\u4e5f\u5c31\u662f8e9\u3002\n\n\u5982\u679c\u76f4\u63a5\u5199\u5c31\u4f1aTLE\uff0c\u56e0\u4e3a\u6709\u5f88\u591a\u65e0\u6548\u72b6\u6001\u3002\u5982\u679c\u63d0\u524d\u5904\u7406\u6389\uff0c\u4f1a\u4f7f\u7a0b\u5e8f\u5feb\u4e0d\u5c11\uff0c\u518d\u52a0\u4e0a\u4e00\u4e9b\u5361\u5e38\uff0c\u5c31\u53ef\u4ee5\u8fc7\u4e86\u3002\n\ncode:\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int md=1000003;\nint f[2222][2222];\nint a[2222],x[2222],y[2222],st[2222];\nint main()\n{\n\tios::sync_with_stdio(false);\n\tstring s;\n\tcin>>s;\n\tint n=s.length();\n\tfor(int i=0;i<n-1;i++)\n\t{\n\t\tif(s[i]<'0'||s[i]>'9')\n\t\t{\n\t\t\tif(s[i+1]=='*'||s[i+1]=='/')\n\t\t\t{\n\t\t\t\tcout<<0<<endl;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t}\n\tif(s[0]=='*'||s[0]=='/')\n\t{\n\t\tcout<<0<<endl;\n\t\treturn 0;\n\t}\n\tint m=0,t=0;\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tif(s[i]<'0'||s[i]>'9')\n\t\t\tt++;\n\t\telse if(t||i==0)\n\t\t{\n\t\t\ta[m]=t-1;\n\t\t\tm++;\n\t\t\tt=0;\n\t\t}\n\t}\n\ta[0]++;\n\tif(t)\n\t{\n\t\tcout<<0<<endl;\n\t\treturn 0;\n\t}\n\tn=0;\n\tfor(int i=0;i<m;i++)\n\t{\n\t\tst[i]=n;\n\t\tfor(int j=a[i];j>=0;j--)\n\t\t{\n\t\t\tx[n]=i;\n\t\t\ty[n]=j;\n\t\t\tn++;\n\t\t}\n\t}\n\tlong long g;\n\tfor(int i=n-1;i>=0;i--)\n\t{\n\t\tf[i][x[i]]=1;\n\t\tfor(int j=x[i]+1;j<m;j++)\n\t\t{\n\t\t\tif(y[i]>0)\n\t\t\t\tf[i][j]=f[i+1][j];\n\t\t\telse\n\t\t\t\tf[i][j]=0;\n\t\t\tg=0;\n\t\t\tfor(int k=x[i];k<j;k++)\n\t\t\t\tg+=(long long)f[i][k]*f[st[k+1]][j];\n\t\t\tf[i][j]=(f[i][j]+g)%md;\n\t\t}\n\t}\n\tcout<<f[0][m-1]<<endl;\n\treturn 0;\n}\n\n```\n\n\u65b9\u6cd52\uff1a\u66f4\u6539dp\u72b6\u6001\uff08\u6807\u7b97\uff09\n\ndp1(i,j)\u8868\u793a\u8003\u8651\u5230\u7b2ci\u4e2a\u7a7a\u4f4d\u8fd8\u6709j\u4e2a\u5de6\u62ec\u53f7\u6ca1\u5339\u914d\uff0c\u4e14\u6700\u540e\u4e00\u4e2a\u62ec\u53f7\u4e3a\u5de6\u62ec\u53f7\u3002\n\ndp2(i,j)\u8868\u793a\u8003\u8651\u5230\u7b2ci\u4e2a\u7a7a\u4f4d\u8fd8\u6709j\u4e2a\u5de6\u62ec\u53f7\u6ca1\u5339\u914d\uff0c\u4e14\u6700\u540e\u4e00\u4e2a\u62ec\u53f7\u4e3a\u53f3\u62ec\u53f7\u3002\n\n\u5177\u4f53\u8f6c\u79fb\u53c2\u89c1\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=2100;\nchar txt[N];\nstring presolve(string s)\n{\n\tstring res;\n\tint n=s.size();\n\tint i=0;\n\twhile(i<n)\n\t{\n\t\tif(s[i]=='+'||s[i]=='-')\n\t\t{\n\t\t\tres+='+';\n\t\t\ti++;\n\t\t\tcontinue;\n\t\t}\n\t\tif(s[i]=='*'||s[i]=='/')\n\t\t{\n\t\t\tres+='*';\n\t\t\ti++;\n\t\t\tcontinue;\n\t\t}\n\t\tres+='x';\n\t\twhile(i<n&&isdigit(s[i]))\n\t\t\ti++;\n\t}\n\treturn res;\n}\nconst int mod=1000003;\nint dp1[N][N],dp2[N][N];\nint main()\n{\n\tscanf(\"%s\",txt);\n\tstring s=presolve(txt);\n\tif(s==\"x\")\n\t{\n\t\tcout<<1<<endl;\n\t\treturn 0;\n\t}\n\tdp1[0][0]=1;\n\tint n=s.size();\n\tfor(int i=0;i<=n;i++)\n\t{\n\t\tfor(int j=N-1;j>=0;j--)\n\t\t{\n\t\t\tif(dp2[i][j])\n\t\t\t{\n\t\t\t\tdp1[i+1][j+1]=(dp1[i+1][j+1]+dp2[i][j])%mod;\n\t\t\t\tif(j>0)\n\t\t\t\t\tdp2[i][j-1]=(dp2[i][j-1]+dp2[i][j])%mod;\n\t\t\t}\n\t\t}\n\t\tfor(int j=0;j<N;j++)\n\t\t{\n\t\t\tif(dp1[i][j])\n\t\t\t{\n\t\t\t\tif(s[i]=='+')\n\t\t\t\t\tdp1[i+1][j+1]=(dp1[i+1][j+1]+dp1[i][j])%mod;\n\t\t\t\tif(s[i]=='x')\n\t\t\t\t\tdp1[i+2][j+1]=(dp1[i+2][j+1]+dp1[i][j])%mod;\n\t\t\t\tif(s[i]=='x'&&j>0)\n\t\t\t\t\tdp2[i+1][j-1]=(dp2[i+1][j-1]+dp1[i][j])%mod;\n\t\t\t}\n\t\t}\n\t}\n\tcout<<dp2[n][0]<<endl;\n\treturn 0;\n}\n\n\n```\n\n",
        "postTime": 1553781807,
        "uid": 183821,
        "name": "Vn_nV",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF115D \u3010Unambiguous Arithmetic Expression\u3011"
    }
]
[
    {
        "content": "\u8d5b\u65f6\u6570\u636e\u9505\u4e86\uff0c\u5bfc\u81f4\u8fd9\u9898\u7684\u96be\u5ea6\u5230\u4e86 $2500$\uff0c\u5b9e\u9645\u4e0a\u662f\u7b80\u5355\u7684\u3002\n\n\u5982\u679c\u8981\u4f7f\u7b54\u6848 $<n$\uff0c\u90a3\u5fc5\u7136\u8981\u8ba9\u4e00\u4e9b\u67aa\u7684\u653b\u51fb\u529b\u4e0d\u53d8\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5c06\u67aa\u6309\u7167\u653b\u51fb\u529b\u6392\u5e8f\uff0c\u90a3\u4e48\u6211\u4eec\u4fdd\u7559\u653b\u51fb\u529b\u7684\u67aa\u5fc5\u7136\u662f\u4e00\u4e2a\u533a\u95f4\u3002\n\n\u7136\u540e\u8003\u8651\u5c3a\u53d6\u6cd5\uff0c\u95ee\u9898\u53d8\u4e3a\u5224\u5b9a\u4e00\u4e2a\u4fdd\u7559\u4e00\u4e2a\u533a\u95f4\u7684\u67aa\u7684\u653b\u51fb\u529b\u662f\u5426\u53ef\u884c\u3002\n\n\u5047\u8bbe\u9009\u53d6\u7684\u67aa\u653b\u51fb\u529b\u5206\u522b\u4e3a $[p_L, p_R]$ \u90a3\u4e48\u5bf9\u4e8e\u533a\u95f4\u5916\u7684\u67aa $x$\uff0c\u60c5\u51b5\u5206\u4e3a $2$ \u79cd\uff1a\n\n1. \u5b58\u5728 $k$ \u4f7f\u5f97 $kf_x\\in [p_L,p_R]$\uff0c\u6b64\u65f6\u8fd9\u628a\u67aa\u7ecf\u8fc7\u8c03\u6574 $d_x = k$ \u5373\u53ef\u7b26\u5408\u8981\u6c42\uff1b\n2. \u5426\u5219\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u628a\u67aa\u7684\u8c03\u6574\u540e\u7684\u653b\u51fb\u529b\u8981\u5c3d\u53ef\u80fd\u9760\u8fd1 $[p_L,p_R]$\uff0c\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u961f\u5217\uff0c\u961f\u5217\u4e2d\u5b58\u4e8c\u5143\u7ec4 $(v, x)$\uff0c\u8868\u793a\u53ef\u4ee5\u5c06 $p_x$ \u53d6\u5230 $v$\u3002\u6211\u4eec\u5c06\u6700\u5927\u7684 $k$ \u4f7f\u5f97 $kf_x < p_L$\uff0c\u5efa\u7acb\u4e8c\u5143\u7ec4 $(kf_x,x)$ \u653e\u5165\u961f\u5217 \u548c \u6700\u5c0f\u7684 $k$ \u4f7f\u5f97 $kf_x > p_R$ \u5efa\u7acb\u4e8c\u5143\u7ec4 $(kf_x,x)$ \u653e\u5165\u961f\u5217\u3002\u7136\u540e\u5bf9\u4e8e\u8fd9\u4e2a\u961f\u5217\uff0c\u6211\u4eec\u5bf9\u7b2c\u4e00\u952e\u503c\u6392\u5e8f\u540e\u5c3a\u53d6\u5224\u5b9a\u662f\u5426\u5b58\u5728\u4e00\u4e2a\u72b6\u6001\u4f7f\u5f97 \u989c\u8272\u6570 $=$ \u653e\u5165\u961f\u5217 \u7684\u989c\u8272\u6570\u5373\u53ef\u3002\n\n\u6ce8\u610f\u8c03\u6574\u540e\u67aa\u7684\u653b\u51fb\u529b $> 0$\uff0c\u4e0d\u80fd\u53d6\u5230 $0$\uff0c\u53ef\u80fd\u9700\u8981\u7279\u5224\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2 \\log n)$\uff0c\u4f46\u662f\u5e38\u6570\u5f88\u5c0f\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n```cpp\nconst int N = 3e3 + 10;\nint T, n, k;\nstruct Gun {\n    ll d, f, p;\n    inline void read() { ::read(d), ::read(f), p = d * f; }\n    inline bool operator<(const Gun &b) const { return p < b.p; }\n} a[N];\nint col[N], top;\npair<ll, int> st[N << 1];\ninline bool check(int reward, ll l, ll r) {\n    if (!reward) return 1;\n    int nr = 0, ccnt = 0, pl = 1;\n    memset(col, 0, sizeof(col));\n    sort(st + 1, st + top + 1);\n    for (int i = 1; i <= top; i++)\n        if (st[i].first + k >= r && st[i].first <= l + k) {\n            while (nr < i) ccnt += !(col[st[++nr].second]++);\n            while (nr < top && st[nr + 1].first <= min(l, st[i].first) + k)\n                ccnt += !(col[st[++nr].second]++);\n            while (pl < i) ccnt -= !(--col[st[pl++].second]);\n            if (ccnt == reward) return 1;\n        }\n    return 0;\n}\ninline bool check(int l, int r) {\n    if (r > n) return 0;\n    if (a[r].p - a[l].p > k) return 0;\n    ll lf = a[l].p, rf = a[r].p;\n    ll ans = 0;\n    top = 0;\n    int reward = 0;\n    for (int i = 1; i < l; i++) {\n        if (a[i].p >= lf && a[i].p <= rf) continue;\n        ll L = (lf / a[i].f) * a[i].f,\n           R = ((rf + a[i].f - 1) / a[i].f) * a[i].f;\n        if (!L) L += a[i].f;\n        if (L + a[i].f <= rf || R - a[i].f >= lf) continue;\n        st[++top] = {L, i}, st[++top] = {R, i}, ++reward;\n    }\n    for (int i = r + 1; i <= n; i++) {\n        if (a[i].p >= lf && a[i].p <= rf) continue;\n        ll L = (lf / a[i].f) * a[i].f,\n           R = ((rf + a[i].f - 1) / a[i].f) * a[i].f;\n        if (!L) L += a[i].f;\n        if (L + a[i].f <= rf || R - a[i].f >= lf) continue;\n        st[++top] = {L, i}, st[++top] = {R, i}, ++reward;\n    }\n    return check(reward, a[l].p, a[r].p);\n}\nint main() {\n    read(T);\n    for (int _ = 1; _ <= T; _++) {\n        read(n), read(k);\n        for (int i = 1; i <= n; i++) read(a[i].f);\n        for (int i = 1; i <= n; i++) read(a[i].d), a[i].p = a[i].f * a[i].d;\n        int ans = n;\n        sort(a + 1, a + n + 1);\n        int r = 0;\n        for (int i = 1; i <= n; i++) {\n            if (r < i) {\n                r = i;\n                if (!check(i, r)) continue;\n            }\n            while (check(i, ++r))\n                ;\n            --r;\n            ans = min(ans, n - (r - i + 1));\n        }\n        write(ans), putc('\\n');\n    }\n    do_flush();\n    return 0;\n}\n```",
        "postTime": 1681699334,
        "uid": 615348,
        "name": "zhouershan",
        "ccfLevel": 7,
        "title": "CF1814D Balancing Weapons sol"
    },
    {
        "content": "## [CF1814D](https://www.luogu.com.cn/problem/CF1814D)     \n\u4e0d\u96be\u53d1\u73b0 $ans$ \u7684\u4e0a\u754c\u662f $n$\uff0c\u56e0\u4e3a\u4f60\u53ef\u4ee5\u628a\u6240\u6709\u7684 $p_i$ \u90fd\u8c03\u5230 $f_i$ \u7684\u516c\u500d\u6570\u5927\u5c0f\u3002   \n\u4e5f\u5c31\u662f\u8bf4\u5bf9\u4e8e\u5176\u4ed6\u7684\u66f4\u4f18\u89e3\uff0c\u4e00\u5b9a\u662f\u5b58\u5728\u81f3\u5c11\u4e00\u652f\u67aa\u662f\u4e0d\u4fee\u6539\u53c2\u6570\u7684\uff0c\u56e0\u4e3a $n$ \u5728 $3000$ \u4ee5\u5185\uff0c\u6240\u4ee5\u4e0d\u59a8\u679a\u4e3e\u8fd9\u4e00\u652f\u67aa\u7684\u7f16\u53f7\u3002  \n\u518d\u8003\u8651\u5982\u679c\u56fa\u5b9a\u4e86\u4e00\u652f\u67aa $i$\uff0c\u5176\u4ed6\u67aa\u6709\u4e09\u79cd\u9009\u62e9\uff1a\u4e0d\u6539\u53d8\uff0c\u6539\u53d8\u5230\u521a\u597d\u6bd4 $p_i$ \u5c0f\u4e00\u70b9\uff0c\u6216\u8005\u521a\u597d\u6bd4 $p_i$ \u5927\u4e00\u70b9\u3002\u8fd9\u662f\u5f88\u660e\u663e\u7684\u3002    \n\u90a3\u4e48\u5bf9\u4e8e\u4e0d\u540c\u7684\u9009\u62e9\uff0c\u5bf9\u4fee\u6539\u6b21\u6570\u7684\u8d21\u732e\u4e5f\u662f\u4e0d\u540c\u7684\u3002\u7b2c\u4e00\u79cd\u7684\u8d21\u732e\u662f $0$\uff0c\u4e8c\u4e09\u79cd\u9009\u62e9\u7684\u8d21\u732e\u90fd\u662f $1$\u3002\u6240\u4ee5\u8003\u8651\u628a\u8fd9 $3n$ \u4e2a\u9009\u9879\u5217\u51fa\u6765\uff0c\u53cc\u6307\u9488\u8fdb\u884c\u626b\u63cf\u5373\u53ef\u3002\u590d\u6742\u5ea6 $\\Theta(n^2\\log n)$\uff0c\u5f53\u7136\u8fd9\u9898\u4e5f\u6709 $\\Theta(nk)$ \u7684\u505a\u6cd5\uff0c\u4e0d\u8fc7\u5185\u5bb9\u5dee\u4e0d\u591a\u3002   \n\n\u4ee3\u7801\uff1a   \n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint t,n,k,f[3003],d[3003],ans,sum,mn,cz;\nint v1[3003],v2[30003],l,r;\nint tot,k1,k2,k3,k4,apr[30003][2];\nstruct pr{\n    int val;\n    int num;\n    int jz;\n}stk[300003];\nbool comp(pr X,pr Y){\n    return X.val<Y.val;\n}\nvoid add(int X){\n    if(stk[X].jz==0){\n        if(apr[stk[X].num][0]==0)cz++;\n        else mn--;\n        apr[stk[X].num][1]=1;\n        return;\n    }\n    if(apr[stk[X].num][1]!=0){\n        apr[stk[X].num][0]++;\n        return;\n    }\n    if(apr[stk[X].num][0]==0){\n        cz++;\n        mn++;\n    }\n    apr[stk[X].num][0]++;\n    return;\n}\nvoid nadd(int X){\n    if(stk[X].jz==0){\n        if(apr[stk[X].num][0]==0)cz--;\n        else mn++;\n        apr[stk[X].num][1]=0;\n        return;\n    }\n    if(apr[stk[X].num][1]!=0){\n        apr[stk[X].num][0]--;\n        return;\n    }\n    if(apr[stk[X].num][0]==1){\n        cz--;\n        mn--;\n    }\n    apr[stk[X].num][0]--;\n    return;\n}\nsigned main(){\n    scanf(\"%lld\",&t);\n    while(t--){\n        scanf(\"%lld%lld\",&n,&k);\n        for(int i=1;i<=n;i++)scanf(\"%lld\",&f[i]);\n        for(int i=1;i<=n;i++)scanf(\"%lld\",&d[i]);\n        ans=n;\n        for(int i=1;i<=n;i++){\n            tot=0;\n            mn=0;\n            cz=0;\n            for(int j=1;j<=n;j++){\n                apr[j][0]=0;\n                apr[j][1]=0;\n                v1[j]=(f[i]*d[i])/f[j];\n                v2[j]=v1[j]+1;\n                stk[++tot].val=v1[j]*f[j];\n                stk[tot].num=j;\n                stk[tot].jz=1;\n                stk[++tot].val=v2[j]*f[j];\n                stk[tot].num=j;\n                stk[tot].jz=1;\n                stk[++tot].val=d[j]*f[j];\n                stk[tot].num=j;\n                stk[tot].jz=0;\n            }\n            sort(stk+1,stk+tot+1,comp);\n            l=1;\n            r=1;\n            add(1);\n            while(r<tot){\n                while(r<tot&&stk[r+1].val-stk[l].val<=k){\n                    add(r+1);\n                    r++;\n                }\n                if(stk[l].val==0||stk[r].val-stk[l].val>k){\n                    l++;\n                    nadd(l-1);\n                    continue;\n                }\n                if(cz==n)ans=min(ans,mn);\n                l++;\n                nadd(l-1);\n            }\n        }\n        printf(\"%lld\\n\",ans);\n    }\n    return 0;\n}\n```\n",
        "postTime": 1684810598,
        "uid": 340819,
        "name": "cwfxlh",
        "ccfLevel": 5,
        "title": "CF1814D"
    },
    {
        "content": "2500![](//\u56fe.tk/1)\n\n\u4e0b\u6587\u4ee4\u9898\u4e2d\u7684 $k$ \u4e3a $m$\u3002\n\n\u663e\u7136\u6bcf\u4e2a $d_i$ \u90fd\u4fee\u6539\uff0c\u6b21\u6570\u5c31\u4e3a $n$\u3002\n\n\u8003\u8651\u679a\u4e3e $i$\uff0c\u94a6\u5b9a $d_i$ \u4e0d\u4fee\u6539\uff0c\u7136\u540e\u679a\u4e3e $[l, l + m - 1], l \\in [f_i \\times d_i - m, f_i \\times d_i]$ \u4e3a\u6700\u540e\u6240\u6709 $p_k$ \u7684\u53d6\u503c\u8303\u56f4\uff08\u4ee4 $r = l + m - 1$\uff09\uff0c\u90a3\u4e48 $[l, r]$ \u5408\u6cd5\u5f53\u4e14\u4ec5\u5f53 $\\forall k \\in [1, n], \\exists x \\in [l, r], a_k \\mid x$\uff0c\u4e5f\u5c31\u662f $\\forall k \\in [1, n], \\left\\lfloor\\frac{r}{a_k}\\right\\rfloor \\ne \\left\\lfloor\\frac{l-1}{a_k}\\right\\rfloor$\u3002\u5728\u6b64\u57fa\u7840\u4e0a\u4fee\u6539\u6b21\u6570\u4e3a $\\sum\\limits_{k=1}^n [f_k \\times d_k \\notin [l,r]]$\u3002\u66b4\u529b\u679a\u4e3e\uff0c\u590d\u6742\u5ea6 $O(n^2m)$\u3002\n\n\u8003\u8651\u628a\u5224\u5b9a\u662f\u5426\u5408\u6cd5\u548c\u7edf\u8ba1\u7b54\u6848\u7684 $n$ \u53d8\u6210 $\\log$\u3002\u6839\u636e\u62bd\u5c49\u539f\u7406\uff0c\u82e5 $a_k \\le m$\uff0c$[l, l + m - 1]$ \u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u6570\u662f $a_k$ \u7684\u500d\u6570\u3002\u82e5 $a_k > m$\uff0c$[f_i \\times d_i - m, f_i \\times d_i + m]$ \u4e2d $a_k$ \u500d\u6570\u7684\u6570\u662f $O(1)$ \u4e2a\u3002\u627e\u5230\u8fd9\u4e9b\u6570\uff0c\u6807\u8bb0\uff0c\u8fd9\u6837\u5224\u5b9a\u5c31\u53ea\u7528\u67e5\u524d\u7f00\u548c\u4e86\uff1b\u4fee\u6539\u6b21\u6570\u4e3a $\\sum\\limits_{k=1}^n [f_k \\times d_k \\notin [l,r]]$\uff0c\u5f88\u5bb9\u6613\u53d1\u73b0\u4e5f\u53ef\u4ee5\u79bb\u6563\u5316\u540e\u524d\u7f00\u548c\u4f18\u5316\u3002\u590d\u6742\u5ea6\u5c31\u53d8\u6210 $O(nm \\log (n + m))$ \u4e86\u3002\n\n[code](https://codeforces.com/contest/1814/submission/205506607)",
        "postTime": 1683880336,
        "uid": 275273,
        "name": "zltqwq",
        "ccfLevel": 0,
        "title": "CF1814D \u9898\u89e3"
    },
    {
        "content": "## [CF1814D](https://codeforces.com/contest/1814/problem/D)\n\n### \u89e3\u9898\u601d\u8def\uff1a\n\n\u5982\u679c\u5168\u90fd\u6539\uff0c\u90a3\u4e48\u7b54\u6848\u662f $n$\u3002\n\n\u5426\u5219\uff0c\u679a\u4e3e\u6ca1\u6709\u6539\u7684\u4f4d\u7f6e\uff0c\u5047\u8bbe\u4e3a $i$\uff0c\u90a3\u4e48\u5bf9\u4e8e\u4efb\u610f\u7684 $j$\uff0c\u5982\u679c\u6539\uff0c\u6700\u4f18\u60c5\u51b5\u4e0b\uff0c$p'_j$ \u662f\u5927\u4e8e $p_i$ \u4e14\u662f $f_j$ \u500d\u6570\u7684\u6700\u5c0f\u6570\u6216\u8005\u5c0f\u4e8e\u7b49\u4e8e $p_i$ \u4e14\u662f $f_j$ \u500d\u6570\u7684\u6700\u5927\u6570\uff0c\u8fd9\u6837\u6bcf\u4e2a\u6570\u7684\u53d6\u503c\u5c31\u53ea\u6709 $O(n)$ \u79cd\u3002\n\n\u5c06\u6240\u6709\u53ef\u80fd\u5f97\u53d6\u503c\u6392\u5e8f\uff0c\u4ece\u5c0f\u5230\u5927\u679a\u4e3e\u6700\u5c0f\u503c\uff0c\u53cc\u6307\u9488\u626b\u53f3\u7aef\u70b9\uff0c\u5982\u679c\u533a\u95f4\u4e2d\u6bcf\u4e2a\u4f4d\u7f6e\u90fd\u51fa\u73b0\u4e86\uff0c\u90a3\u4e48\u53ef\u4ee5\u66f4\u65b0\u7b54\u6848\u3002\n\n### Code\uff1a\n\n```c++\nconst int N=3e3+10;\n\nint f[N],d[N],cnt[N],res,n,k,tot;\nLL p[N];\n\nstruct node\n{\n\tLL val;\n\tint id,type;\n};\n\nvoid add(node i)\n{\n\tres-=i.type;\n\tcnt[i.id]++;\n\tif(cnt[i.id]==1) tot++;\n}\n\nvoid del(node i)\n{\n\tres+=i.type;\n\tcnt[i.id]--;\n\tif(!cnt[i.id]) tot--;\n}\n\nint work(LL x)\n{\n\tvector<node>vi;\n\trep(i,1,n)\n\t{\n\t\tcnt[i]=0;\n\t\tvi.push_back({p[i],i,1});\n\t\tLL y=x/f[i]*f[i];\n\t\tif(y>0) vi.push_back({y,i,0});\n\t\tvi.push_back({y+f[i],i,0});\n\t}\n\tsort(vi.begin(),vi.end(),[](node &P,node &Q) {return P.val<Q.val;});\n\tint r=0,ans=n;\n\tres=n;\n\ttot=0;\n\trep(ni,0,(int) vi.size()-1)\n\t{\n\t\tnode i=vi[ni];\n\t\twhile(r<vi.size()&&vi[r].val<=i.val+k) add(vi[r++]);\n\t\tif(ni) del(vi[ni-1]);\n\t\tif(tot==n) ans=min(ans,res);\n\t}\n\treturn ans;\n}\n\nvoid work()\n{\n\tint ans;\n\tcin>>n>>k;\n\tans=n;\n\trep(i,1,n) cin>>f[i];\n\trep(i,1,n) cin>>d[i];\n\trep(i,1,n) p[i]=1ll*f[i]*d[i];\n\trep(i,1,n) ans=min(ans,work(p[i]));\n\tcout<<ans<<endl;\n}\n\nint main()\n{\n\tios::sync_with_stdio(false);\n\tcin.tie(0),cout.tie(0);\n\tint T;\n\tcin>>T;\n\twhile(T--) work();\n\treturn 0;\n}\n```\n\n",
        "postTime": 1680877749,
        "uid": 571634,
        "name": "hgzxwzf",
        "ccfLevel": 7,
        "title": "CF1814D"
    }
]
[
    {
        "content": "\u4ece$(x1,y1)$\u5230$(x2,y2)$\u53ea\u6709\u4e24\u79cd\u65b9\u6cd5\uff1a\u76f4\u63a5\u8d70\u8fc7\u53bb\uff0c\u6216**\u81f3\u5c11\u4f7f\u7528\u4e00\u6b21\u4f20\u9001\u3002**  \n\n\u5148\u9884\u5904\u7406$dis(k,x,y)$\u8868\u793a\u4ece$(x,y)$\u8d70\u5230\u4efb\u4f55\u989c\u8272\u4e3a$k$\u7684\u683c\u5b50\u7684\u6700\u5c0f\u4ee3\u4ef7\uff08\u6ce8\u610f\uff0c\u53ef\u4ee5\u4f7f\u7528\u4f20\u9001\uff0c\u53ef\u89c1\u6837\u4f8b2\uff09\uff0c\u663e\u7136\u8fd9\u7b49\u4ef7\u4e8e\u4ece\u989c\u8272\u4e3a$k$\u7684\u683c\u5b50\u5f00\u59cb\u8d70\u5230$(x,y)$\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\u5c06\u6240\u6709\u989c\u8272\u4e3a$k$\u7684\u70b9\u5165\u961f\uff0c\u8fdb\u884c\u591a\u6e90bfs\u5373\u53ef\u3002  \n\u6ce8\u610f\uff0cbfs\u65f6\u8f6c\u79fb\u7684\u5f62\u5f0f\u6709\u4e24\u79cd\uff1a1.\u8d70\u76f8\u90bb\u7684\u683c\u5b50\uff1b2.\u4f20\u9001\u5230\u989c\u8272\u76f8\u540c\u7684\u683c\u5b50\uff08\u6ce8\u610f\u5230\u4e00\u79cd\u989c\u8272\u53ea\u9700\u8981\u5904\u7406\u4e00\u6b21\uff0c\u8fd9\u6837\u624d\u80fd\u4fdd\u8bc1\u6bcf\u6b21bfs\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$\\mathcal O(nm)$\uff0c\u53ef\u89c1\u4ee3\u7801\uff09\u3002\n\n\u5904\u7406\u8be2\u95ee\uff1a\u9996\u5148\u7b54\u6848\u4e0d\u53ef\u80fd\u5927\u4e8e\u4e24\u70b9\u95f4\u66fc\u54c8\u987f\u8ddd\u79bb\uff0c\u5373\u76f4\u63a5\u8d70\u7684\u4ee3\u4ef7\u3002\u7136\u540e\u679a\u4e3e\u4e2d\u8f6c\u989c\u8272$k$,\u5219\n$$ans=\\min_{k=1}^{col}dis(k,x1,y1)+dis(k,x2,y2)+1$$\n\n\u663e\u7136\u5355\u6b21\u8be2\u95ee\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$\\mathcal O(k),$\u603b\u65f6\u95f4\u590d\u6742\u5ea6$\\mathcal O(nmk+Qk)$\n```cpp\n/**********/\n#define MAXN 1011\n#define MAXK 41\nstd::vector<pll>g[MAXK];//\u989c\u8272\u4e3ak\u7684\u70b9\u96c6\nll a[MAXN][MAXN],dis[MAXK][MAXN][MAXN];//\u989c\u8272\u548c\u8ddd\u79bb\nll n,m,col;\nbool viscol[MAXK];//\u989c\u8272\u662f\u5426\u5df2\u5904\u7406\u8fc7\nstd::queue<pll>q;//bfs\u7684\u961f\u5217\nconst ll mx[4]={1,0,-1,0},my[4]={0,1,0,-1};//\u79fb\u52a8\nvoid bfs(ll k)//bfs\u6c42dis[k][x][y]\n{\n\tmemset(viscol,0,sizeof viscol);\n\tfor(ll i=0;i<g[k].size();++i)\n\t{\n\t\tll x=g[k][i].first,y=g[k][i].second;\n\t\tdis[k][x][y]=0;\n\t\tq.push(pll(x,y));//\u989c\u8272\u4e3ak\u7684\u6240\u6709\u70b9\u5165\u961f\n\t}\n\tviscol[k]=1;\n\twhile(!q.empty())\n\t{\n\t\tll x=q.front().first,y=q.front().second;q.pop();\n\t\tll c=a[x][y],cur=dis[k][x][y];\n\t\tif(!viscol[c])//\u989c\u8272c\u672a\u88ab\u5904\u7406\u5219\u5904\u7406\n\t\t{\n\t\t\tviscol[c]=1;\n\t\t\tfor(ll i=0;i<g[c].size();++i)\n\t\t\t{\n\t\t\t\tll vx=g[c][i].first,vy=g[c][i].second;\n\t\t\t\tif(dis[k][vx][vy]<0)//\u521d\u59cb\u5316\u4e3a-1\uff0c\u6240\u4ee5<0\u8868\u793a\u4e4b\u524d\u672a\u5230\u8fbe\u8fc7\n\t\t\t\t{\n\t\t\t\t\tdis[k][vx][vy]=cur+1;//\u4f20\u9001\n\t\t\t\t\tq.push(pll(vx,vy));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(ll i=0;i<4;++i)\n\t\t{\n\t\t\tll vx=x+mx[i],vy=y+my[i];//\u76f4\u63a5\u8d70\n\t\t\tif(vx>0&&vx<=n&&vy>0&&vy<=m&&dis[k][vx][vy]<0)\n\t\t\t{\n\t\t\t\tdis[k][vx][vy]=cur+1;\n\t\t\t\tq.push(pll(vx,vy));\n\t\t\t}\n\t\t}\n\t}\n}\nint main()\n{\n\tmemset(dis,-1,sizeof dis);\n\tn=read(),m=read(),col=read();\n\tfor(ll i=1;i<=n;++i)\n\t\tfor(ll j=1;j<=m;++j)\n\t\t{\n\t\t\tll x=read();\n\t\t\ta[i][j]=x;\n\t\t\tg[x].push_back(pll(i,j));\n\t\t}\n\tfor(ll i=1;i<=col;++i)\n\t{\n\t\tbfs(i);\n\t\t/*\n\t\tprintf(\"col %d:\\n\",i);\n\t\tfor(ll x=1;x<=n;++x)\n\t\t{\n\t\t\tfor(ll y=1;y<=m;++y)\n\t\t\t\tprintf(\"%d \",dis[i][x][y]);\n\t\t\tputchar('\\n');\n\t\t}\n\t\t*/\n\t}\n\tll task=read();\n\twhile(task--)\n\t{\n\t\tll x1=read(),y1=read(),x2=read(),y2=read();\n\t\tll ans=abs(x1-x2)+abs(y1-y2);\n\t\tfor(ll i=1;i<=col;++i)\n\t\t\tumin(ans,dis[i][x1][y1]+dis[i][x2][y2]+1);\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1581949440,
        "uid": 73142,
        "name": "\u4e07\u5f18",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1301F \u3010Super Jaber\u3011"
    },
    {
        "content": "\u5355\u8bcd\u8be2\u95ee\u7684\u8bdd\u660e\u663e\u76f4\u63a5\u505a\u6700\u77ed\u8def\u3002\n\n\u4f46\u662f\u6709\u591a\u6b21\u8be2\u95ee\uff0c\u53d1\u73b0 k \u5f88\u5c0f\u540e\u8003\u8651\u4f7f\u7528\u4f20\u7edf\u827a\u80fd\u9884\u5904\u7406\u3002\n\n\u4f7f\u7528\u4e00\u4e2a $f(k,x,y)$ \uff0c\u8868\u793a\u4ece $(x,y)$ \u8d70\u5230 k \u989c\u8272\u7684\u6700\u77ed\u6b65\u6570\uff0c\u56e0\u4e3a\u8fb9\u662f\u53cc\u5411\u7684\uff0c\u6240\u4ee5 $f(k,x,y)$ \u4e5f\u8868\u793a\u4ece k \u989c\u8272\u8d70\u5230 $(x,y)$ \u7684\u6700\u77ed\u6b65\u6570\u3002\n\n\u5176\u4e2d\u6211\u4eec\u77ac\u79fb\u7b97 $0$ \u6b65\uff0c\u6700\u540e\u52a0\u4e0a $1$ \u5c31\u884c\u4e86\uff0c\u8fd9\u6837\u53ef\u4ee5\u5ffd\u7565\u5728 $k$ \u989c\u8272\u4e0a\u53cd\u590d\u6a2a\u8df3\u7684\u9505\uff0c\u6700\u540e\u518d\u5c06\u7b54\u6848\u4e0e\u66fc\u54c8\u987f\u8ddd\u79bb\u53d6 $\\min$ \u5373\u53ef\u3002\n\n\u5bf9\u4e8e\u8be2\u95ee\u679a\u4e3e k \u5373\u53ef\u3002\n\n\u4e8e\u662f\u4f60\u5c31\u6574\u51fa\u6765\u4e00\u4e2a $O(nmk+Qk)$ \u7684\u505a\u6cd5\n\n\u73b0\u5728\u662f $13:45$\uff0c\u770b\u6211\u4ec0\u4e48\u65f6\u5019\u5199\u5b8c\n\n\u73b0\u5728\u662f $14:37$\uff0c\u6211\u5199\u5b8c\u4e86\n\n```cpp\n#define maxn 1010\nint n,m,k;\nint a[maxn][maxn];\nint f[45][maxn][maxn];\nstruct pos{\n\tint x,y;\n\tpos(int xx=0,int yy=0):x(xx),y(yy){}\n}q[maxn*maxn];\nint l,r;\nvector<pos>g[45];\nconst int dx[4]={0,0,1,-1};\nconst int dy[4]={1,-1,0,0};\nbool col[45];\nvoid bfs(int k){\n\tmemset(col,0,sizeof col);\n\tl=r=0;\n\tfor(pos o:g[k])q[++r]=o,f[k][o.x][o.y]=0;\n\tcol[k]=1;\n\twhile(l<=r){\n\t\tpos x=q[l++];\n\t\tif(!col[a[x.x][x.y]]){\n\t\t\tcol[a[x.x][x.y]]=1;\n\t\t\tfor(pos o:g[a[x.x][x.y]])\n\t\t\t\tif(f[k][o.x][o.y]>f[k][x.x][x.y]+1){\n\t\t\t\t\tf[k][o.x][o.y]=f[k][x.x][x.y]+1;\n\t\t\t\t\tq[++r]=o;\n\t\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<4;i++){\n\t\t\tint xx=x.x+dx[i],yy=x.y+dy[i];\n\t\t\tif(xx<1||yy<1||xx>n||yy>m)continue;\n\t\t\tif(f[k][xx][yy]>f[k][x.x][x.y]+1){\n\t\t\t\tf[k][xx][yy]=f[k][x.x][x.y]+1;\n\t\t\t\tq[++r]=pos(xx,yy);\n\t\t\t}\n\t\t}\n\t}\n}\nint T,x1,x2,y1,y2;\nsigned main(){\n#ifndef ONLINE_JUDGE\n\tfreopen(\"testdata.in\",\"r\",stdin);\n#endif\n\tcin>>n>>m>>k;\n\tmemset(f,0x3f,sizeof f);\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++){\n\t\t\tcin>>a[i][j];\n\t\t\tg[a[i][j]].push_back(pos(i,j));\n\t\t}\n\tfor(int i=1;i<=k;i++)bfs(i);\n\tfor(cin>>T;T;T--){\n\t\tcin>>x1>>y1>>x2>>y2;\n\t\tint ans=abs(x1-x2)+abs(y1-y2);\n\t\tfor(int i=1;i<=k;i++)ans=min(ans,f[i][x1][y1]+f[i][x2][y2]+1);\n\t\tcout<<ans<<endl;\n\t}\n#ifndef ONLINE_JUDGE\n\tcerr<<endl<<(double)clock()/CLOCKS_PER_SEC;\n#endif\n}\n```\n\u88ab\u5361\u4e86\u4e00\u4f1a\u513f\u7a7a\u95f4\u624d\u53d1\u73b0\u6211\u7684\u8d85\u5feb\u8bfb\u7adf\u7136\u5728CF\u91cc\u662f\u5360\u7a7a\u95f4\u7684\uff01",
        "postTime": 1630993567,
        "uid": 100325,
        "name": "peterwuyihong",
        "ccfLevel": 7,
        "title": "CF1301F Super Jaber \u8bb0\u5f55"
    },
    {
        "content": "## Sol:\n- \u8003\u8651\u8fd9\u4e2a\u4eba\u7684\u884c\u7a0b\u662f\u5426\u4f20\u9001\u4e86\u81f3\u5c11\u4e00\u6b21\u3002\n- \u5982\u679c\u6ca1\u6709\u4f20\u9001\u8fc7\uff0c\u663e\u7136\u8ddd\u79bb\u5c31\u662f\u66fc\u54c8\u987f\u8ddd\u79bb\u3002\n- \u5426\u5219\uff0c\u6211\u4eec\u5c31\u679a\u4e3e\u4ed6\u4f20\u9001\u7684\u989c\u8272 c\uff0c\u7b54\u6848\u7b49\u4e8e\u4efb\u4f55\u4e00\u4e2a\u5305\u542b\u5143\u7d20 c \u7684\u683c\u5b50\u5230 $(x_1,y_1)$ \u7684\u6700\u77ed\u8def+\u4efb\u4f55\u4e00\u4e2a\u5305\u542b\u5143\u7d20 c \u7684\u683c\u5b50\u5230 $(x_2,y_2)$ \u7684\u6700\u77ed\u8def+1\u3002\n- \u56e0\u6b64\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u5143\u7d20\uff0c\u6211\u4eec\u53ea\u9700\u8981\u9884\u5904\u7406\u51fa\u5305\u542b\u8fd9\u4e2a\u5143\u7d20\u7684\u4efb\u4f55\u4e00\u4e2a\u683c\u5b50\u5230\u6bcf\u4e2a\u5750\u6807\u7684\u6700\u77ed\u8def\u3002\n- \u679a\u4e3e\u5143\u7d20\u7684\u503c\uff0c\u5c06\u5305\u542b\u8fd9\u4e2a\u5143\u7d20\u7684\u6240\u6709\u683c\u5b50\u4e00\u8d77\u4e22\u8fdb\u961f\u5217\u91cc\u8fdb\u884c bfs \u5373\u53ef\u3002\n- bfs \u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u8f6c\u79fb\u548c\u79fb\u52a8\u3002\n\n## code\uff1a\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<cstring>\n#include<queue>\n\nusing namespace std;\n\nint n,m,k,q,map[1010][1010],dis[45][1010][1010];\nint dx[5]={0,1,0,-1,0};\nint dy[5]={0,0,-1,0,1};\nbool v[1000010],vv[1010][1010];\n\nstruct Node{\n\tint x,y;\n};\n\nvoid bfs(int x){\n\tqueue<Node> q;\n\tmemset(v,0,sizeof(v));\n\tmemset(vv,0,sizeof(vv));\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=m;j++){\n\t\t\tif(map[i][j]==x){\n\t\t\t\tNode tmp;\n\t\t\t\ttmp.x=i;tmp.y=j;\n\t\t\t\tq.push(tmp); \n\t\t\t\tvv[i][j]=1;\n\t\t\t\tdis[x][i][j]=0;\n\t\t\t}\n\t\t}\n\t}\n\tv[x]=1;\n\twhile(q.size()){\n\t\tNode u = q.front();q.pop();\n\t//\u8f6c\u79fb\n\t\tif(!v[map[u.x][u.y]]){\n\t\t\tv[map[u.x][u.y]]=1;\n\t\t\tfor(int i=1;i<=n;i++){\n\t\t\t\tfor(int j=1;j<=m;j++){\n\t\t\t\t\tif(map[i][j]==map[u.x][u.y]){\n\t\t\t\t\t\tNode t;\n\t\t\t\t\t\tt.x=i;t.y=j;\n\t\t\t\t\t\tif(vv[t.x][t.y]) continue;\n\t\t\t\t\t\tq.push(t);\n\t\t\t\t\t\tvv[t.x][t.y]=1;\n\t\t\t\t\t\tdis[x][t.x][t.y] = dis[x][u.x][u.y] + 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t//\u79fb\u52a8\n\t\tfor(int i=1;i<=4;i++){\n\t\t\tNode t;\n\t\t\tt.x = u.x + dx[i];\n\t\t\tt.y = u.y + dy[i];\n\t\t\tif(t.x<1 || t.y<1 || t.x>n || t.y>m || vv[t.x][t.y]) continue;\n\t\t\tdis[x][t.x][t.y] = dis[x][u.x][u.y] + 1;\n\t\t\tvv[t.x][t.y]=1;\n\t\t\tq.push(t);\n\t\t}\n\t}\n}\n\nint main(){\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=m;j++){\n\t\t\tscanf(\"%d\",&map[i][j]);\n\t\t}\n\t}\n\tfor(int i=1;i<=k;i++) bfs(i);\t\n\tscanf(\"%d\",&q);\n\tfor(int i=1;i<=q;i++){\n\t\tint a,b,c,d;\n\t\tscanf(\"%d%d%d%d\",&a,&b,&c,&d);\n\t\tint ans = abs(c - a) + abs(d - b);\n\t\tfor(int j=1;j<=k;j++){\n\t\t\tans = min(ans , dis[j][a][b] + dis[j][c][d] + 1);\n\t\t}\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}\n\n```\n\n\n",
        "postTime": 1629640668,
        "uid": 304723,
        "name": "Microperson",
        "ccfLevel": 4,
        "title": "CF1301F Super Jaber"
    },
    {
        "content": "\u611f\u89c9\u6709\u5f88\u591a\u7c7b\u4f3c\u7684\u9898\u76ee\u3002   \n\u8bb0 $dis(i,j,col)$ \u8868\u793a\u4ece $(i,j)$ \u8d70\u5230\u4efb\u610f\u989c\u8272\u4e3a $col$ \u7684\u683c\u5b50\u7684\u6700\u5c0f\u6b65\u6570\uff08\u53ef\u4ee5\u4f7f\u7528\u987a\u79fb\uff09\u3002\u663e\u7136\u7b49\u4ef7\u4e8e\u4ece\u989c\u8272\u4e3a $col$ \u7684\u683c\u5b50\u8d70\u5230 $(i,j)$ \u7684\u6700\u5c0f\u6b65\u6570\uff08\u53ef\u7528\u77ac\u79fb\uff09\u3002   \n\u6240\u4ee5\u53ef\u4ee5\u8fdb\u884c\u591a\u6e90 $bfs$\uff0c\u590d\u6742\u5ea6 $\\mathcal{O}(nmk)$\u3002    \n\u90a3\u4e48\u5bf9\u4e8e $(r1,c1)$ \u8d70\u5230 $(r2,c2)$ \u7684\u6700\u5c0f\u6b65\u6570\u5c31\u662f $\\text{min}(|r1-r2|+|c1-c2|,min\\{ col_{i=1}^k dis(r1,c1,i)+1+dis(r2,c2,i) \\})$   \n\u7b2c\u4e00\u90e8\u5206\u662f\u66fc\u54c8\u987f\u8ddd\u79bb\uff0c\u8868\u793a\u76f4\u63a5\u8d70\u3002  \n\u5269\u4e0b\u90a3\u90e8\u5206\u4e2d $1$ \u4e00\u5b9a\u662f\u8981\u52a0\u7684\uff0c\u8868\u793a\u540c\u989c\u8272\u4e2d\u8df3\u7684\u90a3\u4e00\u4e0b\uff0c\u5982\u679c\u8ddd\u79bb\u6700\u8fd1\u7684\u540c\u8272\u683c\u5b50\u662f\u540c\u4e00\u4e2a\u90a3\u4e48\u8d70\u7684\u5c31\u662f\u66fc\u54c8\u987f\u8ddd\u79bb\uff0c\u4e00\u5b9a\u4f1a\u88ab\u53e6\u4e00\u4e2a\u989c\u8272\u6240\u7edf\u8ba1\u5230\uff0c\u4e0d\u7528\u7ba1\u3002  \n\u603b\u590d\u6742\u5ea6 $\\mathcal{O((nm+q)k)}$\u3002   \n\u8fd9\u4e2a\u5783\u573e\u9898\u8fd8\u5361\u7a7a\u95f4\u3002    \n```cpp\n#include <bits/stdc++.h>\n\nusing pii = std::pair<int, int>;  \nconst int N = 1010;\nconst int dir[4][2] = {{0, -1}, {0, 1}, {-1, 0}, {1, 0}};  \n\nint n, m, i, j, k;\nint col[N][N]; \nbool usecol[45];   \nint dis[N * N][45];\nstd::vector<int> colE[45];  \n\ninline int id(int x, int y) {\n  return 1ll * (x - 1) * m + 1ll * y;    \n}\ninline pii unid(int x) {\n  return std::make_pair((x - (x % m == 0 ? m : x % m)) / m + 1, x % m == 0 ? m : x % m);\n}\ninline void bfs(int c) {\n  std::queue<int> q;  \n  for (int pos : colE[c]) {\n    dis[pos][c] = 0;       \n    q.push(pos);      \n  }   \n  usecol[c] = 1;     \n  while (!q.empty()) {\n    int pos = q.front(); q.pop();    \n    pii P = unid(pos);  \n    int x = P.first, y = P.second, nowc = col[x][y];    \n    if (!usecol[nowc]) {\n      usecol[nowc] = 1;\n      for (int nxt : colE[nowc]) {\n        if (dis[pos][c] + 1 < dis[nxt][c]) {\n          dis[nxt][c] = dis[pos][c] + 1;\n          q.push(nxt);  \n        }\n      }\n    }\n    for (int i = 0; i < 4; i++) {\n      int nxtx = x + dir[i][0], nxty = y + dir[i][1], nxt = id(nxtx, nxty);   \n      if (nxtx < 1 || nxtx > n || nxty < 1 || nxty > m) {\n        continue;\n      }\n      if (dis[pos][c] + 1 < dis[nxt][c]) {\n        dis[nxt][c] = dis[pos][c] + 1;\n        q.push(nxt);\n      }\n    }\n  }\n}\n\nint main() {\n  scanf(\"%d %d %d\", &n, &m, &k);\n  for (int i = 1; i <= n; i++) {\n    for (int j = 1; j <= m; j++) {\n      scanf(\"%d\", &col[i][j]);\n      colE[col[i][j]].push_back(id(i, j));\n    }\n  }\n  memset(dis, 0x3f, sizeof(dis));\n  for (int i = 1; i <= k; i++) {\n    memset(usecol, 0, sizeof(usecol));     \n    bfs(i);\n  }\n  int q; scanf(\"%d\", &q);\n  while (q--) {\n    int r1, c1, r2, c2;\n    scanf(\"%d %d %d %d\", &r1, &c1, &r2, &c2); \n    int ans = std::abs(r1 - r2) + std::abs(c1 - c2), idS = id(r1, c1), idT = id(r2, c2);   \n    for (int i = 1; i <= k; i++) {   \n      ans = std::min(ans, dis[idS][i] + dis[idT][i] + 1);\n    }\n    printf(\"%d\\n\", ans);\n  }\n  return 0;  \n}\n\n```",
        "postTime": 1595658156,
        "uid": 114320,
        "name": "\u843d\u6c50",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1301F \u3010Super Jaber\u3011"
    },
    {
        "content": "### \u601d\u8def\uff1a\n\n\u7531\u4e8eq\u6b21\u8be2\u95ee,\u90a3\u4e48\u81f3\u5c11\u5fc5\u987bO(1) ~ log(n)\u89e3\u51b3\u3002\n\u6709\u4e0e\u56fe\u4e2d\u65e0\u969c\u788d\uff0c\u90a3\u4e48\u5982\u679c\u4e0d\u4f7f\u7528\u8df3\u8dc3\u7684\u8bdd\uff0c\u8d77\u70b9\u5230\u7ec8\u70b9\u7684\u8ddd\u79bb\u5c31\u662f\u66fc\u54c8\u987f\u8ddd\u79bb\u3002\n\u63a5\u4e0b\u6765\u8003\u8651\u8df3\u8dc3\u3002\u53ef\u4ee5\u7528d[k][i][j] \u4ee3\u8868(i, j)\u8fd9\u4e2a\u70b9\u5230\u8fbe\u989c\u8272\u4e3ak\u7684\u683c\u5b50\u7684\u6700\u5c0f\u8ddd\u79bb\u3002 \u90a3\u4e48\u4f7f\u7528\u8df3\u8dc3\u7684\u5230\u8fbe\u7ec8\u70b9\u7684\u6700\u5c11\u8ddd\u79bb\u5c31\u662f\uff1a\u8d77\u70b9\u5230\u8fbe\u989c\u8272k\u7684\u6700\u77ed\u8ddd\u79bb + 1\uff08\u4ece\u8fd9\u4e2a\u683c\u5b50\u8df3\u5230\u53e6\u5916\u4e00\u4e2a\u989c\u8272\u76f8\u540c\u7684\uff09+ \u7ec8\u70b9\u5230\u8fbe\u8fd9\u4e2a\u989c\u8272\u76f8\u540c\u7684\u683c\u5b50\u7684\u6700\u77ed\u8ddd\u79bb\u3002\n\u7b54\u6848\u5c31\u662f2\u8005\u53d6\u4e2a\u6700\u5c0f\u503c\u5c31\u662f\u3002 \u6ce8\u610f\u52a0\u4e0a\u76841\u662f\u56e0\u4e3a\u6211\u5fc5\u987b\u8981\u8df3\u4e00\u6b21\uff0c\u5982\u679c\u4e0d\u8df3\u7684\u8bdd\u90a3\u4e48\u5c31\u662f\u66fc\u54c8\u987f\u8ddd\u79bb\u4e86\u3002\u56e0\u4e3a\u67d0\u70b9\u5230\u8fbe\u67d0\u4e2a\u989c\u8272\u6700\u540e\u4e00\u6b65\u80af\u5b9a\u662f\u901a\u8fc7\u8d70\u7684\uff0c\u90a3\u4e48\u8d77\u70b9\u548c\u7ec8\u70b9\u90fd\u662f\u901a\u8fc7\u8d70\u7684\u5230\u8fbe\u8fd9\u4e2a\u989c\u8272\uff0c\u90a3\u4e48\u5982\u679c\u989c\u8272\u4f4d\u7f6e\u76f8\u540c\u7684\u90a3\u4e48\u5c31\u7b49\u4e8e\u662f\u66fc\u54c8\u987f\u8ddd\u79bb\u4e86\uff0c\u5982\u679c\u4e0d\u76f8\u540c\u7684\u8bdd\u90a3\u4e48\u5c31\u8981\u8df3\u4e00\u6b21\uff0c\u8df3\u5230\u7ec8\u70b9\u7684\u90a3\u4e2a\u76f8\u540c\u989c\u8272\u7684\u4f4d\u7f6e\u51fa\u3002\n\n### Code\uff1a\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <cmath>\n#include <queue>\n#include <iostream>\nusing namespace std;\nconst int N = 1005, M = 45;\nstruct Node {\n\tint x, y;\n\tNode(int x, int y): x(x), y(y){}\n};\nint n, m, q, k, g[N][N], d[M][N][N];\nbool vis[M];\nvector<Node> c[M];\nint dx[4] = {1, 0, 0, -1};\nint dy[4] = {0, -1, 1, 0};\nvoid bfs(int k) {\n\tqueue<Node> q;\n\tmemset(vis, false, sizeof(vis));\n\tfor (int i = 0; i < c[k].size(); i++) {\n\t\tint x = c[k][i].x, y = c[k][i].y;\n\t\td[k][x][y] = 0; q.push(Node(x, y));\n\t}\n\tvis[k] = true;\n\twhile (!q.empty()) {\n\t\tNode t = q.front(); q.pop();\n\t\tint tx = t.x, ty = t.y, td = d[k][t.x][t.y], tc = g[t.x][t.y];\n\t\t//\u4ee3\u8868\u53ef\u4ee5\u8fd9\u4e2a\u989c\u8272\u53ef\u4ee5\u8df3\n\t\tif (!vis[tc]) {\n\t\t\tvis[tc] = true;\n\t\t\tfor (int i = 0; i < c[tc].size(); i++) {\n\t\t\t\tint x = c[tc][i].x ,y = c[tc][i].y;\n\t\t\t\tif (d[k][x][y] != -1) continue;\n\t\t\t\td[k][x][y] = td + 1; q.push(Node(x, y)); \n\t\t\t} \n\t\t}\n\t\tfor (int i = 0; i < 4; i++) {\n\t\t\tint x = tx + dx[i]; \n\t\t\tint y = ty + dy[i]; \n\t\t\tif (x <= 0 || y <= 0 || x > n || y > m || d[k][x][y] != -1) continue;\n\t\t\td[k][x][y] = td + 1; q.push(Node(x, y));\n\t\t} \n\t}\n}\nint main() {\n\tscanf(\"%d%d%d\", &n, &m, &k);\n\tfor (int i = 1; i <= n; i++) {\n\t\tfor (int j = 1; j <= m; j++) {\n\t\t\tscanf(\"%d\", &g[i][j]); c[g[i][j]].push_back(Node(i, j));\n\t\t}\n\t}\n\tmemset(d, -1, sizeof(d));\n\tfor (int i = 1; i <= k; i++) bfs(i);\n\tscanf(\"%d\", &q);\n\twhile (q--) {\n\t\tint x1, x2, y1, y2;\n\t\tscanf(\"%d%d%d%d\", &x1, &y1, &x2, &y2);\n\t\tint ans = abs(x1 - x2) + abs(y1 - y2); //\u66fc\u54c8\u987f\u8ddd\u79bb\n\t\tfor (int i = 1; i <= k; i++) ans = min(ans, d[i][x1][y1] + d[i][x2][y2] + 1); //1\u4ee3\u8868\u5fc5\u987b\u8df3\u4e00\u6b21 \n\t\tprintf(\"%d\\n\", ans); \n\t} \n\treturn 0;\n}",
        "postTime": 1583998937,
        "uid": 225990,
        "name": "\u67e0\u6aac\u8349\u82cf\u6253\u6c34",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 CF1301F \u3010Super Jaber\u3011"
    },
    {
        "content": "## \u9898\u76ee\u5927\u610f\uff1a\n\u7ed9\u51fa\u4e00\u4e2a $ n $ * $ m $ \u7684\u7f51\u683c\uff0c\u6bcf\u4e2a\u5355\u5143\u683c\u90fd\u6709\u4e00\u4e2a\u989c\u8272\uff0c\u989c\u8272\u7684\u79cd\u7c7b\u4e0d\u8d85\u8fc7$ 40 $\u79cd\uff0c\u5982\u679c\u60f3\u4ece\u4e00\u4e2a\u5355\u5143\u683c\u5230\u8fbe\u53e6\u4e00\u4e2a\u5355\u5143\u683c\uff0c\u6709\u4e24\u79cd\u65b9\u6cd5\uff1a\n\n- \u6d88\u8017\u4e00\u4e2a\u5355\u4f4d\u7684\u65f6\u95f4\u4ece\u67d0\u79cd\u989c\u8272\u79fb\u52a8\u5230\u76f8\u540c\u7684\u989c\u8272\n\n- \u6d88\u8017\u4e00\u4e2a\u5355\u4f4d\u7684\u65f6\u95f4\u8d70\u5230\u76f8\u90bb\u7684\u683c\u5b50\u4e2d\n\n- \u73b0\u5728\u7ed9\u51fa $ q $ \u4e2a\u4efb\u52a1\uff0c\u6bcf\u6b21\u4efb\u52a1\u8ba1\u7b97\u4ece\u8d77\u70b9\u5230\u7ec8\u70b9\u7684\u6700\u77ed\u65f6\u95f4\n\n## \u9898\u76ee\u5206\u6790\uff1a\n\n $ q $ \u7684\u8303\u56f4\u4e3a $ 1 - 10^{5} $ \uff0c\u6240\u4ee5\u5fc5\u987b\u8fdb\u884c\u9884\u5904\u7406\uff1a\n \n$ Firstly $ \u6211\u4eec\u9700\u8981\u9884\u5904\u7406\u51fa $ dsu[color][x][y] $ \u6570\u7ec4\uff0c\u4ee3\u8868\u7684\u662f\u4ece\u70b9 $ ( x , y  )$ \u5230 $ color $ \u989c\u8272\u7684**\u6700\u77ed\u8def\u5f84**\n\n$ Secondly $ \u5bf9\u4e8e\u6bcf\u4e2a\u4efb\u52a1\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4ee5\u6bcf\u4e2a\u989c\u8272\u4e3a\u4e2d\u8f6c\u70b9q\u6c42\u89e3\u6700\u5c0f\u503c\u4e86\uff0c\u5728\u9884\u5904\u7406\u65f6\u548c\u901a\u5e38\u7684 $ bfs $ \u5199\u6cd5\u5927\u540c\u5c0f\u5f02\uff0c\u5728\u6bcf\u6b21\u66f4\u65b0\u65f6\u53ef\u80fd\u52a0\u5165\u591a\u4e2a\u8d77\u70b9\uff0c\u540c\u65f6\u8fdb\u884c\u591a\u4e2a\u72b6\u6001\u6c42\u89e3\u51fa\u6700\u5c0f\u503c\u3002\n\n## \u5b9e\u73b0\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\ntypedef long long LL;\ntypedef unsigned long long ull;\n\nconst int N = 1e3+100;\nconst int b[4][2] = {0, 1, 0, -1, 1, 0, -1, 0};\n//\u4e0a\u4e0b\u5de6\u53f3\u56db\u4e2a\u65b9\u5411\u7684\u6570\u7ec4\n\nstruct stu {\n\tint x, y;\n\tstu(int x,int y):x(x), y(y) {};\n};\n// \u7ed3\u6784\u4f53\u5b58\u50a8\u6bcf\u4e2a\u5355\u5143\u683c\u53ca\u5176\u989c\u8272\nint w[N][N], n, m, k;\n\nvector<stu>color[45];//\u989c\u8272\u503c\u6570\u7ec4\n\nint dsu[45][N][N];//\u4ece\u70b9 ( x , y  )\u5230 color \u989c\u8272\u7684\u6700\u77ed\u8def\u5f84\n\nbool visit[N][N], visit_color[45];\n\nvoid read(int &x) {//\u5feb\u901f\u8bfb\u5165 \n\tchar ch = getchar();\n\tint flag = 0;\n\tx = 0;\n\twhile (ch < '0' || ch > '9')\n\t\tflag |= (ch == '-'), ch = getchar();\n\twhile (ch >= '0' && ch <= '9')\n\t\t x = (x << 1) + (x << 3) + (ch ^ 48), ch = getchar();\n\tif (flag)\n\t\tx = -x;\n}\n\nvoid print(int x)//\u5feb\u901f\u8f93\u51fa \n{\n    if(x < 0) {\n        putchar('-');\n        x = -x;\n    }\n    if(x > 9) print(x / 10);\n    putchar(x % 10 + '0');\n}\n//\u5e38\u89c4\u7684bfs\nvoid bfs(int id) {\n\tmemset(visit, false, sizeof(visit));\n\tmemset(visit_color, false, sizeof(visit_color));\n\tqueue<stu>q;\n\tfor(int i = 0; i < color[id].size(); i++) {\n\t\tint x = color[id][i].x, y = color[id][i].y;\n\t\tq.push(stu(x, y));\n\t\tvisit[x][y] = true;\n\t\tdsu[id][x][y] = 0;\n\t}\n\tvisit_color[id] = true;\n\twhile(q.size()) {\n\t\tstu cur = q.front();\n\t\tq.pop();\n\t\tint x = cur.x, y = cur.y;\n\t\tif(!visit_color[w[x][y]]) { //\u79fb\u52a8\n\t\t\tvisit_color[w[x][y]] = true;\n\t\t\tfor(int i = 0; i < color[w[x][y]].size(); i++) {\n\t\t\t\tint xx = color[w[x][y]][i].x, yy = color[w[x][y]][i].y;\n\t\t\t\tif(visit[xx][yy])\n\t\t\t\t\tcontinue;\n\t\t\t\tq.push(stu(xx,yy));\n\t\t\t\tvisit[xx][yy] = true;\n\t\t\t\tdsu[id][xx][yy] = dsu[id][x][y] + 1;\n\t\t\t}\n\t\t}\n\t\tfor(int i = 0; i < 4; i++) { //\u4e0d\u79fb\u52a8\n\t\t\tint xx = x + b[i][0];\n\t\t\tint yy = y + b[i][1];\n\t\t\tif(xx <= 0 || xx > n || yy <= 0 || yy > m)\n\t\t\t\tcontinue;\n\t\t\tif(visit[xx][yy])\n\t\t\t\tcontinue;\n\t\t\tvisit[xx][yy] = true;\n\t\t\tq.push(stu(xx,yy));\n\t\t\tdsu[id][xx][yy] = dsu[id][x][y] + 1;\n\t\t}\n\t}\n}\n\nint main() {\n\tint q;//\u4efb\u52a1\u6570\n\tread(n);\n\tread(m);\n\tread(k);\n\t//\u8f93\u5165\u884c\u6570\u548c\u5217\u6570\u4ee5\u53ca\u989c\u8272\u6570\n\tfor(int i = 1; i <= n; i++)\n\t\tfor(int j = 1; j <= m; j++) {\n\t\t\tcin >> w[i][j];\n\t\t\tcolor[w[i][j]].push_back(stu(i,j));//\u52a0\u5165\u989c\u8272\u503c\n\t\t}\n\tfor(int i = 1; i <= k; i++)//\u9884\u5904\u7406\n\t\tbfs(i);\n\tread(q);//\u8f93\u5165\u603b\u7684\u4efb\u52a1\u6570\n\twhile(q--) {\n\t\tint x1, y1, x2, y2;\n\t\tcin >> x1 >> y1 >> x2 >> y2;//\u8f93\u5165\u8d77\u70b9\u57ce\u5e02\u548c\u7ec8\u70b9\u57ce\u5e02\u5750\u6807\n\t\tint ans = abs(x1 - x2) + abs(y1 - y2);\n\t\tfor(int i = 1; i <= k; i++)\n\t\t\tans = min(ans, dsu[i][x1][y1] + dsu[i][x2][y2] + 1);\n\t\tprint(ans); \n\t\tcout << endl;\n\t}\n\treturn 0;\n}\n\n```\n\u672c\u849f\u84bb\u53d1\u5e03\u7684\u7b2c\u4e00\u7bc7\u9898\u89e3\uff0c~~\u672c\u849f\u84bb\u592a\u849f\u84bb\u4e86~~\u3002\n",
        "postTime": 1581829290,
        "uid": 194716,
        "name": "miracle0609",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1301F \u3010Super Jaber\u3011"
    }
]
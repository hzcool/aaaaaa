[
    {
        "content": "\u7531\u4e8e\u9898\u89e3\u91cc dalao \u4eec\u8bb2\u7684\u90fd\u5f88\u7b80\u77ed\uff0c\u4ee3\u7801\u53c8\u6ca1\u6709\u6ce8\u91ca\uff0c\u6240\u4ee5\u6765\u5199\u4e00\u7bc7\u8be6\u7ec6\u4e00\u70b9\u7684\uff0c\u6211\u8fd9\u79cd\u840c\u65b0\u90fd\u80fd\u770b\u5f97\u61c2\u7684\u9898\u89e3\uff0cdalao \u5c31\u53ef\u4ee5\u4e0d\u7528\u770b\u4e86\n\n#### \u524d\u7f6e\u77e5\u8bc61\uff1a\u591a\u6e90bfs\n\n\u5728 bfs \u65f6\uff0c\u5728```while(!q.empty())```\u4e4b\u524d\uff0c\u5c06\u591a\u4e2a\u800c\u975e\u4e00\u4e2a\u70b9\u52a0\u5165\u961f\u5217\uff0c\u6700\u540e\u5f97\u5230\u7684\u7ed3\u679c\u5c31\u662f\u4ece\u8fd9\u4e9b\u70b9\u540c\u65f6\u51fa\u53d1\u7684\u6700\u77ed\u8def\uff0c\u4e5f\u53ef\u4ee5\u770b\u6210\u662f\u5c06\u8fd9\u4e9b\u70b9\u4e0e\u4e00\u4e2a\u865a\u62df\u8282\u70b9\u8fde\u8fb9\uff08\u8fb9\u6743\u4e3a0\uff09\uff0c\u4ece\u8fd9\u4e2a\u865a\u62df\u7ed3\u70b9\u51fa\u53d1\u8ba1\u7b97\u6700\u77ed\u8def\n\n#### \u524d\u7f6e\u77e5\u8bc62\uff1a\u77e9\u9635\u5728\u56fe\u8bba\u4e2d\u7684\u5e94\u7528\n\n\u77e9\u9635\u4e0e\u56fe\u8bba\u5173\u7cfb\u5bc6\u5207\uff0c\u8fd9\u70b9\u4ece\u90bb\u63a5\u77e9\u9635\u7684\u540d\u5b57\u548c floyd \u7684\u8fc7\u7a0b\u4e2d\u5c31\u53ef\u4ee5\u770b\u51fa\u3002\u800c\u77e9\u9635\u5728\u56fe\u8bba\u4e2d\u7684\u5e94\u7528\u672c\u8d28\u4e0a\u662f\u5bf9 dp \u7684\u4f18\u5316\n\n\u6bd4\u5982\u8ba1\u7b97\u8d70 $k$ \u6b65\u4ece $s$ \u8d70\u5230 $t$ \u7684\u65b9\u6848\u6570\uff0c\u8bbe $f(i,j,k)$ \u4e3a\u4ece $i$ \u8d70 $k$ \u6b65\u5230 $j$ \u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u6709\u8fd9\u6837\u7684\u4e00\u4e2a\u65b9\u7a0b $f(i,j,p+q) =  \\sum_{1 \\leq k \\leq n} f(i,k,p) * f(k,j,q)$\uff0c\u8fd9\u4e0e\u77e9\u4e58\u7684\u8fc7\u7a0b\u662f\u5f88\u50cf\u7684\u3002\u6211\u4eec\u8bbe\u7f6e\u8fd9\u6837\u4e00\u4e2a\u77e9\u9635 $A$\uff0c$A[i][j] = f(i,j,1)$\uff0c\u90a3\u4e48 $A^k[i][j] = f(i,j,k)$\n\n\u540c\u7406\uff0c\u901a\u8fc7\u91cd\u8f7d\u77e9\u4e58\u7684\u8fd0\u7b97\u548c\u66f4\u6539\u521d\u59cb\u77e9\u9635\u7684\u503c\uff0c\u8fd8\u53ef\u4ee5\u7ef4\u62a4\u66f4\u591a\u56fe\u4e0a\u7684\u4fe1\u606f\uff0c\u6bd4\u5982\u7ecf\u8fc7 $k$ \u6b65\u7684\u6700\u77ed\u8def\uff0c[[USACO07NOV]Cow Relays G](https://www.luogu.com.cn/problem/P2886)\uff0c[[NOI Online #3 \u63d0\u9ad8\u7ec4]\u9b54\u6cd5\u503c](https://www.luogu.com.cn/problem/P6569)\u548c[NOI2020\u7f8e\u98df\u5bb6](https://www.luogu.com.cn/problem/P6772)\u4e5f\u7528\u5230\u4e86\u8fd9\u79cd\u65b9\u6cd5\n\n#### \u524d\u7f6e\u77e5\u8bc63\uff1abitset\u4f18\u5316\n\n\u6709\u5982\u4e0b\u77e9\u4e58\u8fc7\u7a0b\uff0c\u5176\u77e9\u9635\u4e2d\u7684\u91cf\u53ea\u67090\u548c1\u4e24\u79cd\uff0c\u6211\u4eec\u53ef\u4ee5\u7528 bitset \u4f18\u5316\u5b83\u7684\u901f\u5ea6\n\n```\nbitset<MAXN> res[MAXN], a[MAXN], b[MAXN];\nfor(int i = 1; i <= n; ++i)\n\tfor(int j = 1; j <= n; ++j)\n\t\tfor(int k = 1; k <= n; ++k)\n\t\t\tres[i][j] |= a[i][k] & b[k][j];\n```\n\n\u8fd9\u4e0e\u4e0b\u9762\u7684\u4ee3\u7801\u662f\u7b49\u4ef7\u7684\n\n```\nbitset<MAXN> res[MAXN], a[MAXN], b[MAXN];\nfor(int i = 1; i <= n; ++i)\n\tfor(int k = 1; k <= n; ++k)\n\t\tfor(int j = 1; j <= n; ++j)\n\t\t\tif(a[i][k])\n\t\t\t\tres[i][j] |= b[k][j];\n```\n\n\u6211\u4eec\u53d1\u73b0\u6700\u540e\u4e00\u884c\u7684\u8fd0\u7b97\u4e2d```res```\u4e0e```b```\u7684\u7b2c\u4e8c\u7ef4```[j]```\u5bf9\u9f50\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u8fd9\u4e00\u7ef4\u4f18\u5316\u6389\uff0c\u4ea4\u7ed9 STL \u53bb\u8ba1\u7b97\n\n```\nbitset<MAXN> res[MAXN], a[MAXN], b[MAXN];\nfor(int i = 1; i <= n; ++i)\n\tfor(int k = 1; k <= n; ++k)\n\t\tif(a[i][k])\n\t\t\tres[i] |= b[k];\n```\n\n#### \u6b63\u5f0f\u9898\u89e3\n\n\u6211\u4eec\u56de\u5230\u8fd9\u9053\u9898\uff0c\u8003\u8651\u5728\u8fd9\u5f20\u56fe\u4e0a\u6e38\u8d70\uff0c\u6240\u6709\u7684\u8fb9\u4e00\u5b9a\u662f\u6309 $d_i$ \u4ece\u5c0f\u5230\u5927\u7684\u987a\u5e8f\u89e3\u9501\u3002\n\n\u6240\u4ee5\u6211\u4eec\u5bf9\u8fb9\u6392\u5e8f\uff0c\u7136\u540e\u679a\u4e3e\u6bcf\u4e00\u6761\u904d\uff0c\u5047\u8bbe\u6b64\u65f6\u5df2\u7ecf\u8d70\u8fc7\u4e86 $t$ \u6761\u8fb9\uff0c\u90a3\u4ee5\u8d70\u8fc7 $t$ \u6761\u8fb9\u540e\u6240\u5728\u7684\u6bcf\u4e00\u4e2a\u53ef\u80fd\u4f4d\u7f6e\u4e3a\u8d77\u70b9\uff0c\u5728\u53ea\u6709\u524d $i$ \u6761\u8fb9\u7684\u56fe\u4e0a\u8dd1\u4e00\u904d \u591a\u6e90bfs\uff0c\u518d\u5c06\u6bcf\u4e00\u4e2a $d[j]$ \u52a0\u4e0a $t$ \u5373\u53ef\u5f97\u5230\u89e3\u9501\u524d $i$ \u6761\u8fb9\u540e\u7684\u6700\u77ed\u8def\uff08\u5982\u679c\u8def\u5f84\u957f\u5ea6\u5df2\u7ecf\u8d85\u8fc7\u4e86\u4e0b\u4e00\u6761\u8fb9\u7684\u89e3\u9501\u6761\u4ef6\uff0c\u90a3\u4e48\u7b97\u51fa\u6765\u7684\u7b54\u6848\u6709\u53ef\u80fd\u662f\u4e0d\u51c6\u786e\u7684\uff0c\u4f46\u8fd9\u5e76\u6ca1\u6709\u5f71\u54cd\uff0c\u56e0\u4e3a\u5728\u679a\u4e3e\u5230\u4e0b\u4e00\u6761\u8fb9\u65f6\u8fd8\u4f1a\u88ab\u8ba1\u7b97\u4e00\u6b21\uff09\n\n\u81f3\u4e8e\u8d70\u8fc7 $t$ \u6761\u8fb9\u4e4b\u540e\u7684\u53ef\u80fd\u4f4d\u7f6e\uff0c\u53ef\u4ee5\u7528\u77e9\u9635\u6765\u7ef4\u62a4\uff0c\u5e76\u7528\u77e9\u9635\u5feb\u901f\u5e42\u6765\u52a0\u901f\u3002\u4e0d\u8fc7\u6ce8\u610f\uff0c\u6bcf\u89e3\u9501\u4e00\u6761\u65b0\u7684\u8fb9\u540e\u8f6c\u79fb\u77e9\u9635\u90fd\u4f1a\u6539\u53d8\u3002\u7531\u4e8e\u65f6\u95f4\u590d\u6742\u5ea6\u8fd8\u662f\u4e0d\u591f\u4f18\u79c0\uff0c\u6211\u4eec\u7528 bitset \u6765\u4f18\u5316\u77e9\u4e58\u7684\u8fc7\u7a0b\uff0c\u8fd9\u9053\u9898\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u601d\u8def\u8fd8\u662f\u6bd4\u8f83\u6e05\u6670\u7684\uff0c\u4f46\u6211\u7531\u4e8e\u628a\u6709\u5411\u56fe\u5f53\u6210\u4e86\u65e0\u5411\u56fe\uff0c\u5361\u4e86\u597d\u4e45...\n\n$\\text{CODE}\\downarrow$\n\n```c++\n#include<bitset>\n#include<stdio.h>\n#include<algorithm>\nusing namespace std;\n \ntypedef long long ll;\nconst int MAXN = 155;\nconst ll INF = 1000000000000000;\nll d[MAXN], t, dt, ans = INF;\nint q[1000], l, r, n;\n\ninline int read()\n{\n    int x = 0;\n    char ch = getchar();\n    while(ch < '0' || ch > '9')\n        ch = getchar();\n    while(ch >= '0' && ch <= '9')\n    {\n        x = x * 10 + ch - 48;\n        ch = getchar();\n    }\n    return x;\n}\n\ninline ll llread()\n{\n    ll x = 0;\n    char ch = getchar();\n    while(ch < '0' || ch > '9')\n        ch = getchar();\n    while(ch >= '0' && ch <= '9')\n    {\n        x = x * 10 + ch - 48;\n        ch = getchar();\n    }\n    return x;\n}\n\nstruct edge//\u5b58\u8fb9\uff0c\u65b9\u4fbf\u6392\u5e8f\u548c\u679a\u4e3e\uff0cw\u8868\u793a\u89e3\u9501\u6761\u4ef6\n{\n    int u, v; ll w;\n    friend bool operator<(edge a, edge b) { return a.w < b.w; }\n    void get() { u = read(), v = read(), w = llread(); }\n} e[MAXN];\n \nstruct mrx\n{\n    bitset<MAXN> v[MAXN];\n \n    mrx()\n    {\n        for (int i = 1; i <= n; ++i)\n            for (int j = 1; j <= n; ++j)\n                v[i][j] = 0;\n    }\n \n    void one()\n    {\n        for (int i = 1; i <= n; ++i)\n            v[i][i] = 1;\n    }\n \n    friend mrx operator * (mrx a, mrx b)\n    {\n        mrx res;\n        for (int i = 1; i <= n; ++i)\n            for (int k = 1; k <= n; ++k)\n                if(a.v[i][k])\n                    res.v[i] |= b.v[k];\n        return res;\n    }\n\n    /*\n    \u4e0d\u7528bitset\u4f18\u5316\u7684\u77e9\u9635\u4e58\u6cd5\uff0c\u4fbf\u4e8e\u7406\u89e3\n    friend mrx operator * (mrx a, mrx b)\n    {\n        mrx res;\n        for (int i = 1; i <= n; ++i)\n            for(int j = 1; j <= n; ++j)\n                for (int k = 1; k <= n; ++k)\n                    res.v[i][j] |= a.v[i][k] & b.v[k][j];\n        return res;\n    }\n    */\n} a, g;\n/*\n\u77e9\u9635a\u7ef4\u62a4\u53ef\u8fbe\u6027\u4fe1\u606f\na.v[i][j]\u8868\u793a\u7ecf\u8fc7\u7279\u5b9a\u8fb9\u6570\u540e\u4ecei\u662f\u5426\u80fd\u5230j\n\u77e9\u9635g\u7ef4\u62a4\u9014\u4e2d\u8fb9\u7684\u4fe1\u606f\ng.v[i][j]\u8868\u793a\u56fe\u4e2d\u662f\u5426\u5b58\u5728\u4ecei\u5230j\u7684\u8fb9\n*/\n\nmrx pow(mrx x, ll y)\n{\n    mrx res;\n    res.one();\n    while(y)\n    {\n        if(y&1) res = res * x;\n        x = x * x;\n        y >>= 1;\n    }\n    return res;\n}\n \nvoid bfs() //\u591a\u6e90bfs\uff0c\u5c06\u7ed3\u679c\u5b58\u5728\u6570\u7ec4d\u4e2d\n{\n    int x;\n    l = r = 1;\n    for (int i = 1; i <= n; ++i)\n        d[i] = INF; //\u8bb0\u5f97\u521d\u59cb\u5316\n    for (int i = 1; i <= n; ++i)\n        if (a.v[1][i])\n            q[r++] = i, d[i] = 0;//\u4ece\u8d77\u70b9\u51fa\u53d1\u7ecf\u8fc7t\u6b65\u540e\u5230\u7684\u70b9\u4f5c\u4e3a\u8d77\u70b9\n    while(r > l)//\u6b63\u5e38\u7684bfs\u8fc7\u7a0b\n    {\n        x = q[l++];\n        for (int y = 1; y <= n; ++y)\n            if(g.v[x][y] && d[y] == INF)\n                d[y] = d[x] + 1, q[r++] = y;\n    }\n}\n \nint main()\n{\n    int m;\n    n = read(), m = read();\n    for (int i = 1; i <= m; ++i)\n        e[i].get();\n    sort(e + 1, e + m + 1);\n    a.v[1][1] = 1; d[n] = INF;\n    for (int i = 1; i <= m; ++i)//\u679a\u4e3e\n    {\n        if(ans < e[i].w)\n            break;\n        dt = e[i].w - t;//dt->delta_t\uff0c\u8fc7\u53bb\u7684\u65f6\u95f4/\u8fb9\u6570\n        t = e[i].w;\n        a = a * pow(g, dt);//\u7528\u77e9\u9635\u5feb\u901f\u5e42\u7ef4\u62a4t\u65f6\u523b\u53ef\u4ee5\u5728\u7684\u4f4d\u7f6e\n        g.v[e[i].u][e[i].v] = 1;//\u89e3\u9501\u65b0\u8fb9\uff0c\u4f1a\u5bf9\u63a5\u4e0b\u6765\u7684bfs\u548c\u77e9\u9635a\u7684\u7ef4\u62a4\u90fd\u4ea7\u751f\u5f71\u54cd\n        if(i == m || e[i+1].w != e[i].w) bfs();\n        ans = min(ans, t + d[n]);\n    }\n    if(ans == INF) puts(\"Impossible\");\n    else printf(\"%lld\\n\", ans);\n    return 0;\n}\n```\n\nP.S.\u6211\u5728\u505a\u56fe\u8bba\u9898\u65f6\u4f1a\u628a\u7ecf\u8fc7\u7684\u8def\u7a0b\u4e0e\u65f6\u95f4\u6df7\u8d77\u6765\uff0c\u8fd9\u4e24\u8005\u662f\u7b49\u4ef7\u7684\uff0c\u800c\u4e14\u6211\u8ba4\u4e3a\u628a\u8ddd\u79bb\u770b\u6210\u65f6\u95f4\u4f1a\u66f4\u5bb9\u6613\u7406\u89e3\u56fe\u8bba\u7b97\u6cd5\uff0c\u6240\u4ee5\u5728\u4ee3\u7801\u6ce8\u91ca\u91cc\u7684\u65f6\u95f4\u6307\u7684\u5c31\u662f\u8ddd\u79bb",
        "postTime": 1602209014,
        "uid": 56501,
        "name": "\u26a1current\u26a1",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 CF576D \u3010Flights for Regular Customers\u3011"
    },
    {
        "content": "> [CF576D Flights for Regular Customers](https://codeforc.es/contest/576/problem/D)\n\n## \u9898\u610f\n\n- \u7ed9\u5b9a\u4e00\u5f20 $n$ \u4e2a\u70b9 $m$ \u6761\u8fb9\u7684\u6709\u5411\u56fe\u3002\n- \u4e00\u5f00\u59cb\u4f60\u5728 $1$ \u53f7\u8282\u70b9\uff0c\u4f60\u8981\u8d70\u5230 $n$ \u53f7\u8282\u70b9\u53bb\u3002\n- \u53ea\u6709\u5f53\u4f60\u5df2\u7ecf\u8d70\u8fc7\u4e86\u81f3\u5c11 $d_i$ \u6761\u8fb9\u65f6\uff0c\u4f60\u624d\u80fd\u8d70\u7b2c $i$ \u6761\u8fb9\u3002\n- \u95ee\u6700\u5c11\u8981\u8d70\u591a\u5c11\u6761\u8fb9\uff0c\u6216\u5224\u65ad\u65e0\u6cd5\u5230\u8fbe\u3002\n- $n,m \\le 150$\uff0c$d_i \\le 10^9$\u3002\n\n## \u9898\u89e3\n\n\u9996\u5148\u5bf9\u8fb9\u6392\u5e8f\uff0c\u7136\u540e\u4ece\u5c0f\u5230\u5927\u4f9d\u6b21\u52a0\u5165\u6bcf\u6761\u8fb9\u3002\n\n\u8003\u8651\u53ea\u6709\u5f53\u524d\u5b58\u5728\u7684\u8fb9\u65f6\uff0c\u7b54\u6848\u600e\u4e48\u6c42\u3002\n\n\u5047\u8bbe\u6b64\u65f6\u52a0\u5165\u7684\u8fb9\u7684 $d$ \u503c\u4e3a $t$\uff0c\u9996\u5148\u8981\u6c42\u7684\u662f\u7ecf\u8fc7\u6070\u597d $t$ \u6761\u8fb9\u65f6\u53ef\u4ee5\u5230\u8fbe\u54ea\u4e9b\u70b9\u3002\n\n\u8fd9\u4e2a\u53ef\u4ee5\u4ece\u52a0\u5165\u4e0a\u4e00\u6761\u8fb9\u65f6\u7684\u7b54\u6848\u9012\u63a8\u8fc7\u6765\uff0c\u8fd9\u4e2a\u9012\u63a8\u5f0f\u53ef\u4ee5\u77e9\u9635\u52a0\u901f\u3002\n\n\u6c42\u51fa\u6070\u597d $t$ \u6761\u8fb9\u65f6\u53ef\u4ee5\u5230\u8fbe\u54ea\u4e9b\u70b9\u540e\uff0c\u5bf9\u6574\u4e2a\u56fe\u8fdb\u884c\u4e00\u6b21 bfs \u5373\u53ef\u6c42\u51fa\u5f53\u524d\u7684\u7b54\u6848\u3002\n\n\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal O(n^3m \\log d)$ \u7684\uff0c\u65e0\u6cd5\u901a\u8fc7\u3002\n\n\u6ce8\u610f\u5230\u6bcf\u4e2a\u70b9\u7684\u72b6\u6001\u53ea\u6709 $0/1$ \u4e24\u79cd\uff0c\u5206\u522b\u5bf9\u5e94\u7740\u65e0\u6cd5\u5230\u8fbe\u548c\u53ef\u4ee5\u5230\u8fbe\u3002\n\n\u56e0\u6b64\u53ef\u4ee5 bitset \u4f18\u5316\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(\\frac{n^3m \\log d}w)$\u3002\n\n## \u4ee3\u7801\n\n```cpp\nconst int N = 150;\nconst ll inf = 1e18;\nint n, m;\nstruct E {\n\tint x, y, z;\n\tinline void input() { rd(x), rd(y), rd(z), --x, --y; }\n\tinline friend bool operator < (E a, E b) { return a.z < b.z; }\n} e[N];\nll d[N], ans;\n#define bt bitset<N>\nbt v;\nstruct mt {\n\tbt a[N];\n\tinline friend bt operator * (bt x, mt y) {\n\t\tbt z;\n\t\tfor (int i = 0; i < n; i++) z[i] = (x & y.a[i]).any();\n\t\treturn z;\n\t}\n\tinline friend mt operator * (mt x, mt y) {\n\t\tmt z;\n\t\tfor (int i = 0; i < n; i++)\n\t\t\tfor (int j = 0; j < n; j++)\n\t\t\t\tif (x.a[i][j]) z.a[i] |= y.a[j];\n\t\treturn z;\n\t}\n} a;\n\ninline void ksm(mt x, int y, bt &z) {\n\twhile (y) {\n\t\tif (y & 1) z = z * x;\n\t\tx = x * x, y >>= 1;\n\t}\n}\n\nint main() {\n\trd(n), rd(m);\n\tfor (int i = 0; i < m; i++) e[i].input();\n\tsort(e, e + m);\n\tv[0] = 1;\n\tans = inf;\n\tfor (int i = 0, t = 0; i < m; i++) {\n\t\tif (e[i].z >= ans) break;\n\t\tint o = e[i].z - t;\n\t\tksm(a, o, v);\n\t\ta.a[e[i].y][e[i].x] = 1;\n\t\tt = e[i].z;\n\t\tqueue<int> q;\n\t\tfor (int x = 0; x < n; x++)\n\t\t\tif (v[x]) q.push(x), d[x] = 0;\n\t\t\telse d[x] = inf;\n\t\twhile (q.size()) {\n\t\t\tint x = q.front();\n\t\t\tq.pop();\n\t\t\tfor (int y = 0; y < n; y++)\n\t\t\t\tif (a.a[y][x] && d[y] == inf)\n\t\t\t\t\td[y] = d[x] + 1, q.push(y);\n\t\t}\n\t\tans = min(ans, t + d[n-1]);\n\t}\n\tif (ans == inf) prints(\"Impossible\");\n\telse print(ans);\n\treturn 0;\n}\n```",
        "postTime": 1575473417,
        "uid": 100544,
        "name": "xht",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF576D \u3010Flights for Regular Customers\u3011"
    },
    {
        "content": "\u770b\u4e86\u4e00\u4e0b\uff0c\u9898\u89e3\u533a\u90fd\u662f\u4f7f\u7528 ```bitset``` \u4f18\u5316\u7684\u77e9\u9635\u4e58\u6cd5\uff0c\u590d\u6742\u5ea6  $O(n^3mlog_2d/\\omega)$ \u3002\n\n\u8fd9\u91cc\u6709\u4e00\u4e2a $O((n^3+n^2m)\u00b7log_2d)$ \u7684\u505a\u6cd5\uff1a\n\n\u6211\u4eec\u9996\u5148\u5c06\u8fb9\u6309\u7167 $d_i$ \u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u8fd9\u6837\u6392\u5728\u524d\u9762\u7684\u8fb9\u4e00\u5b9a\u5728\u6392\u5728\u540e\u9762\u7684\u8fb9\u4e4b\u524d\u52a0\u5165\u3002\n\n\u4e4b\u540e\uff0c\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e2a $d_i$ \uff0c\u6c42\u51fa\u4ece $1$ \u51fa\u53d1\u8d70\u8fc7\u6070\u597d $d_i$ \u6761\u8fb9\u540e\u80fd\u5230\u8fbe\u54ea\u4e9b\u70b9\u3002\n\n\u663e\u7136\u6c42\u51fa\u8fd9\u4e2a\u70b9\u96c6\u4e4b\u540e\u53ef\u4ee5\u4ece\u8fd9\u4e9b\u70b9\u51fa\u53d1\u5404\u505a\u4e00\u6b21bfs\uff08\u6216\u8005\u591a\u8d77\u70b9bfs\uff0c\u4f46\u662f\u6b64\u5904\u4e0d\u5f71\u54cd\u74f6\u9888\u590d\u6742\u5ea6\uff0c\u56e0\u6b64\u6548\u7387\u76f8\u5dee\u4e0d\u5927\uff09\uff0c\u4e4b\u540e\u5f97\u5230\u8d70 $d_i$ \u6b65\u4e4b\u540e\u5f97\u5230\u7684\u56fe\u4e0a\u518d\u8d70\u591a\u5c11\u6b65\u53ef\u4ee5\u5230\u8fbe $n$ \u3002\u5c06\u6240\u6709 $d_i$ \u4ea7\u751f\u7684\u7b54\u6848\u6bd4\u8f83\uff0c\u53d6\u6700\u4f18\u7684\u4f5c\u4e3a\u7b54\u6848\u3002\u5982\u679c\u65e0\u8bba\u54ea\u4e00\u4e2a $d_i$ \u90fd\u5230\u8fbe\u4e0d\u4e86 $n$ \uff0c\u90a3\u7b54\u6848\u5c31\u662f ```Impossible``` \u3002\n\n\u73b0\u5728\u4e3b\u8981\u7684\u95ee\u9898\u5c31\u662f\u5982\u4f55\u66f4\u9ad8\u6548\u7387\u5730\u6c42\u51fa\u8fd9\u4e2a\u70b9\u96c6\u3002\n\n\u7528\u90bb\u63a5\u77e9\u9635\u505a\u77e9\u9635\u4e58\u6cd5\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a $O(n^3mlog_2d/\\omega)$ \u7684\u7b97\u6cd5\uff0c\u4f46\u662f\u8fd8\u4e0d\u591f\u4f18\u3002\u8003\u8651\u4f18\u5316\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u6211\u4eec\u53ef\u4ee5 $O(n^2)$ \u5730\u901a\u8fc7\u4e00\u4e2a\u90bb\u63a5\u77e9\u9635\u548c\u4e00\u4e2a\u53ef\u5230\u8fbe\u70b9\u96c6 $S$ \u63a8\u51fa $S$ \u5728\u7ecf\u8fc7\u4e00\u6b21\u90bb\u63a5\u77e9\u9635\u4e0a\u7684\u8fb9\u4e4b\u540e\u7684\u751f\u6210\u53ef\u5230\u8fbe\u70b9\u96c6 $T$\u3002\uff08\u679a\u4e3e\u8d77\u70b9\u548c\u51fa\u8fb9\u76f4\u63a5\u66b4\u529b\u8f6c\u79fb\u5373\u53ef\uff09\n\n\u5bf9\u4e8e\u90bb\u63a5\u77e9\u9635\u7684 $2^k$ \u6b21\u65b9\u4e5f\u540c\u7406\uff1a\u6211\u4eec\u53ef\u4ee5 $O(n^2)$ \u5730\u901a\u8fc7\u4e00\u4e2a\u90bb\u63a5\u77e9\u9635\u7684 $f$ \u6b21\u65b9\u548c\u4e00\u4e2a\u53ef\u5230\u8fbe\u70b9\u96c6 $S$ \u63a8\u51fa $S$ \u5728\u7ecf\u8fc7 $f$ \u6b21\u90bb\u63a5\u77e9\u9635\u4e0a\u7684\u8fb9\u4e4b\u540e\u7684\u751f\u6210\u53ef\u5230\u8fbe\u70b9\u96c6 $T$\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u52a8\u6001\u52a0\u8fb9\u7684\u8fc7\u7a0b\u4e2d\u7ef4\u62a4\u8fd9\u4e2a\u90bb\u63a5\u77e9\u9635\u7684 $2^k$ \u6b21\u65b9\u3002\n\n\u76f4\u63a5\u77e9\u9635\u4e58\u6cd5\u7ef4\u62a4\u663e\u7136\u8fd8\u662f $O(n^3mlog_2d)$ \u7684\uff0c\u65e0\u6cd5\u53d6\u5f97\u672c\u8d28\u4f18\u5316\u3002\n\n\u6211\u4eec\u8bb0\u90bb\u63a5\u77e9\u9635\u7684 $k$ \u6b21\u65b9\u4e3a $M[k][x][y]$\u3002\n\n\u8003\u8651\u52a0\u4e00\u6761\u8fb9\u7684\u5f71\u54cd\u3002\n\n\u6211\u4eec\u8bbe\u52a0\u7684\u4e00\u6761\u8fb9\u4e3a $(u,v)$ \u3002\u663e\u7136\u8fd9\u4e00\u6b65\u64cd\u4f5c\u4f1a\u628a $M[0][u][v]$ \u7f6e\u4e3a $1$ \u3002\u63a5\u4e0b\u6765\u8981\u8003\u8651\u8fd9\u6b21\u52a0\u8fb9\u5bf9 $M[1,2,...,k][x][y]$ \u7684\u5f71\u54cd\u3002\n\n\u6211\u4eec\u5047\u8bbe\u73b0\u5728\u5c06 $M[k][s][t]$ \u7531 $0$ \u66f4\u65b0\u4e3a $1$ \u3002\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u679a\u4e3e\u53ef\u4ee5\u7ecf\u8fc7 $2^k$ \u6b65\u8d70\u5230 $s$ \u7684\u70b9 $p$ \u548c $t$ \u7ecf\u8fc7 $2^k$ \u6b65\u53ef\u4ee5\u8d70\u5230\u7684\u70b9 $q$ \u3002\n\n\u6709\u8f6c\u79fb $M[k+1][p][t]|=M[k][p][s]\\&\\&M[k][s][t]$ \u548c $M[k+1][s][q]|=M[k][s][t]\\&\\&M[k][t][q]$ \u3002\n\n\u5982\u679c\u6210\u529f\u5730\u5c06 $M[k+1][s][t]$ \u7531 $0$ \u66f4\u65b0\u4e3a $1$ \uff0c\u5c31\u53ef\u4ee5\u7ee7\u7eed\u7528 $M[k+1][s][t]$ \u66f4\u65b0 $M[k+2][x][y]$ \u7684\u7b54\u6848\u3002\n\n\u8fd9\u4e2a\u8fc7\u7a0b\u4e0d\u592a\u5bb9\u6613\u8fed\u4ee3\u8fdb\u884c\uff0c\u4f46\u662f\u53ef\u4ee5\u7528\u9012\u5f52\u5f88\u5bb9\u6613\u5b9e\u73b0\u3002\n\n\u590d\u6742\u5ea6\u8bc1\u660e\uff1a\n\nbfs\u7684\u590d\u6742\u5ea6\uff1a$nmlog_2d$ \u6216 $mlog_2d$ \u6b21bfs\uff0c\u6bcf\u6b21 $O(n)$\n\n\u590d\u6742\u5ea6 $O(n^2mlog_2d)$ \u6216\u8005 $O(nmlog_2d)$ \u3002\n\n\uff08\u53d6\u51b3\u4e8e\u662f\u5426\u662f\u591a\u6e90\u70b9bfs\uff09\n\n\u8f6c\u79fb \u7ecf\u8fc7\u6070\u597d $d_i$ \u6b65\uff0c\u53ef\u5230\u8fbe\u70b9\u96c6\u7684\u590d\u6742\u5ea6\uff1a$m$ \u6b21\u8f6c\u79fb\uff0c\u6bcf\u6b21\u8f6c\u79fb\u590d\u6742\u5ea6 $O(n^2log_2d)$ \uff0c\u603b\u590d\u6742\u5ea6 $O(n^2mlog_2d)$\u3002\n\n\u52a8\u6001\u7ef4\u62a4\u90bb\u63a5\u77e9\u9635\u7684 $2^k$ \u6b21\u65b9\u7684\u590d\u6742\u5ea6\uff1a\n\n\u6bcf\u4e2a\u72b6\u6001 $M[k][x][y]$ \u81f3\u591a\u88ab\u66f4\u65b0\u4e3a $1$ \u4e00\u6b21\uff0c\u4e14\u5b83\u679a\u4e3e\u5176\u4ed6\u72b6\u6001\u8fdb\u884c\u8f6c\u79fb\u7684\u590d\u6742\u5ea6\u4e3a $O(n)$ \uff0c\u56e0\u6b64\u590d\u6742\u5ea6\u4e0a\u9650\u4e3a \u72b6\u6001\u6570 * \u5355\u6b21\u8f6c\u79fb\u590d\u6742\u5ea6\uff0c\u5373 $O(n^2k*n)=O(n^3k)=O(n^3log_2d)$ \u3002\n\n\u4e8e\u662f\u6211\u4eec\u5728 $O((n^3+n^2m)\u00b7log_2d)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u89e3\u51b3\u4e86\u672c\u9898\u3002\n\nCode:\n```cpp\n#include<cstdio>\n#include<cstring>\n#define inlien inline\n#define retrun return\n#define cpnst const\nbool valid[33][166][166];\nbool enl[166][166];\nbool can[166];\nint n,m;\nvoid upd(int x,int y,int dep=0)\n{\n\tif(valid[dep][x][y])return;\n\tvalid[dep][x][y]=1;\n\tif(dep==30)return;\n\tregister int i;\n\tfor(i=1;i<=n;i++)\n\t{\n\t\tif(valid[dep][y][i])\n\t\t\tupd(x,i,dep+1);\n\t\tif(valid[dep][i][x])\n\t\t\tupd(i,y,dep+1);\n\t}\n\t\t\n}\nbool tmp[166];\nvoid jump(bool*x,int lev)\n{\n\tregister int i,ii;\n\tfor(i=1;i<=n;i++)tmp[i]=0;\n\tfor(i=1;i<=n;i++)\n\t\tif(x[i])\n\t\t\tfor(ii=1;ii<=n;ii++)\n\t\t\t\tif(valid[lev][i][ii])tmp[ii]=1;\n\tfor(i=1;i<=n;i++)x[i]=tmp[i];\n}\nvoid trans(bool*x,int tim)\n{\n\tregister int i;\n\tfor(i=30;~i;i--)\n\t\tif(tim&(1<<i))jump(x,i);\n}\nint dis[166];\n#include<queue>\nstd::queue<int>q;\nint bfs(int f)\n{\n\tregister int i;\n\tfor(i=1;i<=n;i++)dis[i]=2e9;\n\tdis[f]=0,q.push(f);\n\twhile(q.size())\n\t{\n\t\tint t=q.front();q.pop();\n\t\tfor(i=1;i<=n;i++)\n\t\t\tif(enl[t][i])\n\t\t\t\tif(dis[i]>1.9e9)\n\t\t\t\t\tdis[i]=dis[t]+1,q.push(i);\t\n\t}return dis[n];\n}\nint solve(int t)\n{\n\tint ret=2e9;\n\tregister int i;\n\tfor(i=1;i<=n;i++)\n\t\tif(can[i])\n\t\t{\n\t\t\tint rm=bfs(i);\n\t\t\t\n\t\t\tif(rm<ret)ret=rm;\n\t\t}\n\tif(ret<1.9e9)ret+=t;\n\treturn ret;\n}\nstruct pii\n{\n\tint x,y,d;\n}p[11111];\nbool operator<(cpnst pii x,cpnst pii y)\n{return x.d<y.d;}\n#include<algorithm>\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\tregister int i;\n\tfor(i=1;i<=m;i++)\n\t\tscanf(\"%d%d%d\",&p[i].x,&p[i].y,&p[i].d);\n\tstd::sort(p+1,p+m+1);\n\tint ans=2e9;\n\tcan[1]=1;\n\tfor(i=1;i<=m;i++)\n\t{\n\t\ttrans(can,p[i].d-p[i-1].d);\n\t\tenl[p[i].x][p[i].y]=1,upd(p[i].x,p[i].y);\n\t\tint t=solve(p[i].d);\n\t\tif(t<ans)ans=t;\n\t}(ans>1.9e9)?puts(\"Impossible\"):printf(\"%d\\n\",ans);\n}\n```",
        "postTime": 1589898594,
        "uid": 85053,
        "name": "namespace_std",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF576D \u3010Flights for Regular Customers\u3011"
    },
    {
        "content": "\u5f00\u59cb\u6316 tzc \u9057\u4ea7\uff08\uff1f\n\n\u8fd9\u597d\u50cf\u662f\u4e0a\u4e2a\u8d5b\u5b63\u7684\u4e00\u4e2a jxd \u4f5c\u4e1a\u3002\n\n---\n\n\u9996\u5148\u76f4\u63a5 BFS \u80af\u5b9a\u662f\u4e0d\u884c\u7684\uff0c\u56e0\u4e3a\u4f60\u4f1a\u4e00\u8fb9\u8d70\u8fb9\u4f1a\u4e00\u8fb9\u589e\u52a0\uff0c\u90a3\u5c31\u8981\u52a0\u4e00\u7ef4\u6b65\u6570\uff0c\u90a3\u80af\u5b9a\u5403\u4e0d\u6d88\u7684\u3002\n\n\u663e\u7136\uff0c\u8fb9\u96c6\u53ea\u6709 $\\mathrm O(m)$ \u79cd\uff0c\u800c\u4e14\u5bf9\u5e94\u7740\u82e5\u5e72\u4e2a\u8fde\u7eed\u7684\u65f6\u95f4\u6bb5\u3002\u6211\u4eec\u4e0d\u59a8\u679a\u4e3e\u6700\u4f18\u7b54\u6848\u7684\u6700\u540e\u4e00\u6b65\u662f\u5728\u54ea\u4e2a\u65f6\u95f4\u6bb5\u91cc\u9762\u3002\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u65f6\u95f4\u6bb5\uff0c\u5b83\u7684\u8fb9\u96c6\u663e\u7136\u662f\u56fa\u5b9a\u7684\u4e86\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u76f4\u63a5 BFS \u4e86\u3002\n\n\u90a3\u4e48\u73b0\u5728\u74f6\u9888\u5728\u4e8e\uff0c\u8be5\u65f6\u95f4\u6bb5\u5de6\u7aef\u70b9\u7684\u65f6\u5019\u54ea\u4e9b\u70b9\u662f\u53ef\u4ee5\u4ece $1$ \u51fa\u53d1\u8d70\u5230\u7684\uff0c\u8fd9\u4e2a\u600e\u4e48\u6c42\uff0c\u6c42\u51fa\u6765\u5c31 BFS \u5c31\u884c\u4e86\u3002\n\n\u8fd9\u4e2a\u5c31\u662f\u6bd4\u8f83\u5957\u8def\u7684\u4e1c\u897f\u4e86\u3002\u67d0\u4e9b\u840c\u65b0\u53ef\u80fd\u8ff7\u60d1\u90bb\u63a5\u77e9\u9635\u5230\u5e95\u6709\u4ec0\u4e48\u7528\uff0c\u5b83\u660e\u660e\u80fd\u88ab\u90bb\u63a5\u8868\u4ee3\u66ff\u3002\u5b83\u7ec8\u7a76\u662f\u4e00\u4e2a\u77e9\u9635\uff0c\u6ee1\u8db3\u8fd9\u6837\u4e00\u4e2a\u6027\u8d28\uff1a\u4e24\u4e2a\u90bb\u63a5\u77e9\u9635\u76f8\u4e58\uff0c\u6240\u5f97\u79ef\u7684 $(i,j)$ \u8868\u793a\u82e5\u5148\u8d70\u524d\u8005\u4ee3\u8868\u7684\u8fb9\u96c6\uff0c\u540e\u8d70\u540e\u8005\u4ee3\u8868\u7684\u8fb9\u96c6\uff0c\u90a3\u4e48 $i\\to j$ \u7684\u8def\u5f84\u6570\u3002\u8fd9\u4e5f\u592a\u5bb9\u6613\u7406\u89e3\u4e86\uff0c\u5c31\u662f\u77e9\u4e58\u7684\u5b9a\u4e49\u3002\u7136\u540e\u5982\u679c\u7528 `bool` \u578b\u5b58\u7684\u8bdd\u5c31\u8868\u793a\u53ef\u8fbe\u6027\uff0c\u5b83\u76f8\u5f53\u4e8e\u662f\u4e00\u4e2a\u5e7f\u4e49\u77e9\u4e58\uff0c\u4e5f\u662f\u6ee1\u8db3\u6027\u8d28\u7684\u3002\n\n\u90a3\u4e48\u6bcf\u4e2a\u65f6\u95f4\u6bb5\u7684\u521d\u59cb\u70b9\u96c6\u5c31\u662f\u4e4b\u524d\u7684\u82e5\u5e72\u4e2a\u90bb\u63a5\u77e9\u9635\u76f8\u4e58\u770b\u7b2c\u4e00\u884c\u5c31\u53ef\u4ee5\u4e86\u3002\u8fd9\u4e2a\u53ef\u4ee5\u4ece\u524d\u5f80\u540e\u626b\u7684\u8fc7\u7a0b\u4e2d\u4e00\u8def\u4e58\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u65f6\u95f4\u6bb5\u4e58\u5feb\u901f\u5e42\u3002\u90a3\u590d\u6742\u5ea6\u5c31\u662f $\\mathrm O\\!\\left(n^3m\\log\\right)$\uff0c\u8fc7\u4e0d\u53bb\u3002\u7136\u540e\u662f\u53e6\u4e00\u4e2a trick\uff1a\u77e9\u9635\u91cc\u90fd\u662f `bool`\uff0c\u4e8e\u662f\u53ef\u4ee5\u641e\u51fa\u4e58\u6cd5\u4e2d\u524d\u8005\u7684\u884c\u548c\u540e\u8005\u7684\u5217\u7684 `bitset`\uff0c\u7136\u540e\u67e5\u8be2\u7684\u8bdd\u590d\u6742\u5ea6\u5c31\u9664\u4ee5\u4e86\u4e00\u4e2a  $w$\u3002\n\n**_[code](https://www.luogu.com.cn/paste/73bdavqv)_**\n\n---\n\nupd. 2020.12.16\uff1a\n\n\u4e4b\u524d\u5c31\u770b\u5230\u9898\u89e3\u533a\u91cc\u9762\u6709\u590d\u6742\u5ea6\u66f4\u4f18\u7684\u7b97\u6cd5\uff0c\u4e00\u76f4\u9e3d\u5230\u73b0\u5728\u3002\n\n\u590d\u6742\u5ea6\u7684\u74f6\u9888\u663e\u7136\u5728\u4e8e\u300c\u90a3\u4e48\u73b0\u5728\u74f6\u9888\u5728\u4e8e\uff0c\u8be5\u65f6\u95f4\u6bb5\u5de6\u7aef\u70b9\u7684\u65f6\u5019\u54ea\u4e9b\u70b9\u662f\u53ef\u4ee5\u4ece $1$ \u51fa\u53d1\u8d70\u5230\u7684\uff0c\u8fd9\u4e2a\u600e\u4e48\u6c42\u300d\u3002\u6211\u4eec\u5e0c\u671b\u641e\u51fa\u4e0d\u9700\u8981 `bitset` \u4f18\u5316\u7684\u65b9\u6cd5\u3002\u6ce8\u610f\u5230\u6211\u4eec\u867d\u7136\u7ef4\u62a4\u4e86\u90bb\u63a5\u77e9\u9635\u7684\u79ef\uff0c\u4f46\u662f\u6700\u7ec8\u6211\u4eec\u60f3\u8981\u7684\u7b54\u6848\u786e\u662f $[1\\ 0\\ 0\\ \\cdots\\ 0]$ \u4e58\u4ee5\u8fd9\u4e2a\u77e9\u9635\u3002\u90a3\u4e48\u6211\u4eec\u5f88\u5957\u8def\u7684\u8054\u60f3\u5230 NOI D1T1\uff0c\u901a\u8fc7\u5411\u91cf\u4e58\u77e9\u9635\u662f $\\mathrm O\\!\\left(n^2\\right)$ \u7684\u8fd9\u4e2a\u6027\u8d28\u6765\u4f18\u5316\u3002\n\n\u5957\u8def\u7684\u65b9\u6cd5\u662f\u8003\u8651\u4e8c\u8fdb\u5236\u5149\u901f\u5e42\uff0c\u9884\u5904\u7406\u51fa\u77e9\u9635\u7684 $2$ \u7684\u6574\u6b21\u5e42\u7684\u5e42\u3002\u90a3\u4e48\u73b0\u5728\u5982\u679c\u4efb\u610f\u65f6\u523b\uff0c\u8fd9\u4e2a\u7ef4\u62a4\u7684\u4e1c\u897f\u90fd\u662f\u6b63\u786e\u7684\u8bdd\uff0c\u90a3\u4e48\u590d\u6742\u5ea6\u663e\u7136\u662f $\\mathrm O\\!\\left(n^2m\\log\\right)$ \u4e86\u3002\u90a3\u4e48\u5982\u4f55\u5728\u52a0\u8fb9\u7684\u8fc7\u7a0b\u4e2d\u5b9e\u65f6\u66f4\u65b0\u8fd9\u4e2a\u7ef4\u62a4\u7684\u4e1c\u897f\u5462\uff1f\u5148\u4ece\u6700\u5e95\u5c42\u8003\u8651\uff0c\u52a0\u4e00\u6761\u8fb9 $(i,j)$ \u5bf9 $0$ \u6b21\u65b9\u7684\u5f71\u54cd\u663e\u7136\u5c31\u662f $(i,j)$ \u53d8\u6210 `true`\u3002\u7136\u540e\u5982\u679c\u6210\u529f\u6539\u53d8\u5b83\u4e86\uff0c\u90a3\u4e48\u5bf9 $1$ \u6b21\u65b9\u5f71\u54cd\u662f\u5565\u5462\uff1f\u56de\u60f3\u77e9\u9635\u4e58\u6cd5\u516c\u5f0f $C_{i,j}=\\bigvee\\limits_{k}A_{i,k}\\land B_{k,j}$\uff0c\u90a3\u4e48\u5206\u4e3a\u4e24\u79cd\u60c5\u51b5\uff0c$(i,j)$ \u5145\u5f53 $\\bigvee$ \u540e\u9762\u5f0f\u5b50\u7684\u5de6\u9879\u8fd8\u662f\u53f3\u9879\u3002\u524d\u8005\u901a\u8fc7\u4e0e $(j,k)$ \u914d\u5408\u5f71\u54cd $1$ \u6b21\u65b9\u7684 $(i,k)$\uff0c\u540e\u8005\u901a\u8fc7\u4e0e $(k,i)$ \u7684\u914d\u5408\u5f71\u54cd $(k,j)$\u3002\u7136\u540e\u8003\u8651 $1$ \u6b21\u65b9\u5982\u4f55\u5f71\u54cd $2$ \u6b21\u65b9\uff0c\u5176\u5b9e\u5c31\u662f\u5bf9\u4e8e\u6bcf\u6b21\u6210\u529f\u4fee\u6539\u50cf $0\\to 1$ \u90a3\u6837\u5957\u5a03\u5c31\u53ef\u4ee5\u4e86\uff0c\u53ef\u4ee5\u9012\u5f52\u5199\u3002\n\n\u5982\u4f55\u8bc1\u660e\u590d\u6742\u5ea6\u662f\u5bf9\u7684\u5462\u3002\u611f\u89c9\u4e0a\u89c9\u5f97\u5f88\u5bf9\uff0c\u4e5f\u5f88\u597d\u8bc1\u3002\u5b83\u7684\u590d\u6742\u5ea6\u7531\u4e24\u90e8\u5206\u6784\u6210\uff1a\u6bcf\u6b21\u5faa\u73af\u5bfb\u627e\u6210\u529f\u4fee\u6539\u5bf9\u8c61\u7684\u65f6\u95f4\uff0c\u548c\u6210\u529f\u4fee\u6539\u6b21\u6570\u3002\u540e\u8005\u6765\u8bf4\u7684\u8bdd\uff0c\u663e\u7136\u6ee1\u6253\u6ee1\u7b97\u4e5f\u662f\u603b\u7684\u662f\u5e73\u65b9\u5bf9\u6570\u4e86\uff0c\u90a3\u4e48\u524d\u8005\u5c31\u662f\u6bcf\u6b21\u6210\u529f\u4fee\u6539\uff08\u6ce8\u610f\u53ea\u6709\u6210\u529f\u4fee\u6539\u624d\u4f1a\u5c1d\u8bd5\u5f71\u54cd\u4e0b\u4e00\u4e2a\u6b21\u65b9\uff0c\u5426\u5219 wyy\uff09\u90fd\u82b1 $\\mathrm O(n)$\uff0c\u603b\u7684\u5c31\u662f\u4e09\u65b9\u5bf9\u6570\u4e86\u3002\n\n\u662f\u4e0d\u662f\u300c\u601d\u7ef4\u5171\u5957\u8def\u4e00\u8272\u300d\uff1f\n\n**_[code](https://www.luogu.com.cn/paste/vl8vcj7o)_**",
        "postTime": 1607840881,
        "uid": 138400,
        "name": "chenxia25",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF576D \u3010Flights for Regular Customers\u3011"
    },
    {
        "content": "#### CF 576D\n#### Lemma\n\u4e00\u4e2a\u6709\u5411\u56fe\u4e2d\u4ece$u$\u8d70\u5230$v$\u7ecf\u8fc7\u6070\u597d$k$\u6b65\u7684\u65b9\u6848\u6570\u662f\u90bb\u63a5\u77e9\u9635$G$\u7684$k$\u6b21\u65b9\u4e2d$G^k[u][v]$\u7684\u503c\uff0c\u56e0\u4e3a\u77e9\u9635\u4e58\u6cd5\u672c\u8d28\u4e0a\u7b49\u4e8e\u8f6c\u79fb\u7684\u8fc7\u7a0b\u3002\n#### Solution\n\u9996\u5148\u5b9a\u4e49\u4e24\u4e2a\u77e9\u9635\uff0c\u77e9\u9635$A$\u4e2d$A[i][j]$\u8868\u793a\u5f53\u524d\u8d70$d$\u6b65\u80fd\u5426\u4ece$i$\u5230\u8fbe$j$\uff0c\u77e9\u9635$B$\u4e2d$B[i][j]$\u8868\u793a\u5f53\u524d$i\\to j$\u7684\u8fd9\u6761\u8fb9\u5df2\u7ecf\u88ab\u89e3\u9501\u3002\n\n\u5148\u5c06\u6240\u6709\u8fb9\u6309\u7167$d_i$\u4ece\u5c0f\u5230\u8fbe\u6392\u5e8f\uff0c\u7136\u540e\u8003\u8651\u6bcf\u6b21\u52a0\u5165\u4e00\u6761\u8fb9\u65f6\uff0c\u8ba9$A$\u4e58\u4e0a$B^{d_i-d_{i-1}}$\uff0c\u76f8\u5f53\u4e8e\u5f97\u51fa\u4e86\u5728\u7b2c$i$\u6761\u8fb9\u89e3\u9501\u4e4b\u524d\u4e24\u70b9\u4e4b\u95f4\u7ecf\u8fc7$d$\u6b65\u7684\u72b6\u6001\u3002\u7136\u540e\u5bf9\u6574\u4e2a\u56fe\u8fdb\u884c\u4e00\u6b21$bfs/floyd$\u5373\u53ef\u6c42\u51fa\u5f53\u524d$1$\u5230$n$\u7684\u6700\u77ed\u8def\u6765\u66f4\u65b0\u7b54\u6848\u3002\n\n\u8fd9\u6837\u505a\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f$\\mathcal O(n^4\\log d)$\uff0c\u65e0\u6cd5\u901a\u8fc7\u672c\u9898\u3002\n\n\u6ce8\u610f\u5230\u77e9\u9635\u4e2d\u6bcf\u4e2a\u70b9\u7684\u503c\u53ea\u53ef\u80fd\u4e3a$0$\u6216\u8005$1$\uff0c\u6240\u4ee5\u7528$bitset$\u4f18\u5316\u77e9\u9635\u4e58\u6cd5\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$\\mathcal O(\\frac{n^4\\log d}{\\omega})$\n#### Code\n```cpp\nint n,m,ans = INF;\nint dis[MAXN][MAXN];\n\nstruct Edge{\n    int u,v,d;\n\n    bool operator < (const Edge &rhs) const{\n        return d < rhs.d;\n    }\n} e[MAXN];\n\nstruct Matrix{\n    bitset<MAXN> a[MAXN];\n\n    Matrix(){\n        for(int i = 1;i <= n;i++)\n            a[i].reset();\n    }\n\n    friend Matrix operator * (const Matrix &x,const Matrix &y){\n        Matrix res;\n        for(int i = 1;i <= n;i++){\n            for(int j = 1;j <= n;j++){\n                if(x.a[i][j])\n                    res.a[i] |= y.a[j];\n            }\n        }\n        return res;\n    }\n} A;\n\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    for(int i = 1;i <= m;i++)\n        scanf(\"%d%d%d\",&e[i].u,&e[i].v,&e[i].d);\n    sort(e + 1,e + 1 + m);\n    for(int i = 1;i <= n;i++)\n        A.a[i][i] = 1;\n    for(int x = 1;x <= m;x++){\n        Matrix B;\n        for(int i = 1;i < x;i++)\n            B.a[e[i].u][e[i].v] = 1;\n        int y = e[x].d - e[x - 1].d;\n        while(y){\n            if(y & 1) A = A * B;\n            B = B * B;\n            y >>= 1;\n        }\n        for(int i = 1;i <= n;i++){\n            for(int j = 1;j <= n;j++)\n                dis[i][j] = INF;\n            dis[i][i] = 0;\n        }\n        for(int i = 1;i <= x;i++)\n            dis[e[i].u][e[i].v] = 1;\n        for(int k = 1;k <= n;k++){\n            for(int i = 1;i <= n;i++){\n                for(int j = 1;j <= n;j++)\n                    dis[i][j] = min(dis[i][j],dis[i][k] + dis[k][j]);\n            }\n        }\n        for(int i = 1;i <= n;i++){\n            if(A.a[1][i])\n                ans = min(ans,e[x].d + dis[i][n]);\n        }\n    }\n    if(ans < INF) printf(\"%d\\n\",ans);\n    else printf(\"Impossible\\n\");\n    return 0;\n}\n```",
        "postTime": 1607788262,
        "uid": 108894,
        "name": "\u5173\u6000\u4ed6\u4eba",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF576D \u3010Flights for Regular Customers\u3011"
    },
    {
        "content": "\u5bf9\u6bcf\u6761\u8fb9\u6765\u8bf4\uff0c\u53ef\u4ee5\u8d70\u8fd9\u6761\u8fb9\u7684\u9650\u5236\u89e3\u9664\u662f\u6309$d$\u7684\u987a\u5e8f\uff0c\u6240\u4ee5\u5148\u5bf9\u6bcf\u6761\u8fb9\u6309$d$\u6392\u5e8f\u3002\n\n\u7136\u540e\u8003\u8651\u6bcf\u4e24\u6761\u8fb9\u4e4b\u95f4\u7684\u5904\u7406\uff0c\u7528\u4e00\u4e2a\u77e9\u9635\u8868\u793a\u5f53\u524d\u8d70$d$\u6b65\u662f\u5426\u53ef\u4ee5\u4ece\u4e00\u4e2a\u70b9\u5230\u53e6\u4e00\u4e2a\u70b9\uff0c\u79f0\u5176\u4e3a\u72b6\u6001\u77e9\u9635\uff0c\u7528\u53e6\u4e00\u4e2a\u77e9\u9635\u8868\u793a\u5f53\u524d\u89e3\u9664\u4e86\u9650\u5236\u7684\u8fb9\uff0c\u79f0\u5176\u4e3a\u8fb9\u77e9\u9635\u3002\n\n\u6bcf\u6b21\u65b0\u52a0\u5165\u4e00\u6761\u8fb9\u65f6\uff0c\u8ba9\u72b6\u6001\u77e9\u9635\u4e58\u4e0a\u5f53\u524d\u8fb9\u77e9\u9635\u7684$d_i-d_{i-1}$\u6b21\u65b9\uff0c\u5373\u53ef\u66f4\u65b0\u8d70\u5f53\u524d\u6b65\u6570$d$\u6b65\u70b9\u4e0e\u70b9\u4e4b\u95f4\u5230\u8fbe\u7684\u72b6\u6001\uff0c\u8fd9\u4e00\u8fc7\u7a0b\u53ef\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u548c$bitset$\u8fdb\u884c\u4f18\u5316\u3002\n\n\u7136\u540e\u7528$floyd$\u5904\u7406\u51fa\u4ee5\u5f53\u524d\u89e3\u9664\u9650\u5236\u7684\u8fb9\u7684\u6700\u77ed\u8def\uff0c\u82e5\u8d77\u70b9\u80fd\u901a\u8fc7$d$\u6b65\u5230\u8fbe\u4e00\u4e2a\u70b9\uff0c\u90a3\u4e48\u5c31\u7528\u8fd9\u4e2a\u70b9\u5230\u7ec8\u70b9\u7684\u6700\u77ed\u8def\u5f84\u52a0\u4e0a$d$\u6765\u66f4\u65b0\u7b54\u6848\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u770b\u4ee3\u7801\u5427\u3002\n\n$code:$\n\n```cpp\n#include<bits/stdc++.h>\n#define maxn 200\n#define all 150\n#define inf 200000000000\nusing namespace std;\ntypedef long long ll;\ntemplate<typename T> inline void read(T &x)\n{\n    x=0;char c=getchar();bool flag=false;\n    while(!isdigit(c)){if(c=='-')flag=true;c=getchar();}\n    while(isdigit(c)){x=(x<<1)+(x<<3)+(c^48);c=getchar();}\n    if(flag)x=-x;\n}\nll n,m,ans=inf;\nll f[maxn][maxn];\nstruct edge\n{\n    int x,y,d;\n}ed[maxn];\nbool cmp(const edge &x,const edge &y)\n{\n    return x.d<y.d;\n}\nstruct matrix\n{\n\tbitset<maxn> a[maxn];\n\tmatrix()\n\t{\n        for(int i=1;i<=all;++i) a[i].reset();\n\t}\n}t;\nmatrix operator *(const matrix &x,const matrix &y)\n{\n    matrix z;\n    for(int k=1;k<=n;++k)\n    \tfor(int i=1;i<=n;++i)\n        \tif(x.a[i][k])\n        \t\tz.a[i]|=y.a[k];\n\treturn z;\n}\nint main()\n{\n    read(n),read(m);\n    for(int i=1;i<=m;++i)\n        read(ed[i].x),read(ed[i].y),read(ed[i].d);\n    sort(ed+1,ed+m+1,cmp);\n    for(int i=1;i<=n;++i) t.a[i][i]=1;\n    for(int p=1;p<=m;++p)\n    {\n        matrix e;\n        for(int i=1;i<p;++i) e.a[ed[i].x][ed[i].y]=1;\n        ll k=ed[p].d-ed[p-1].d;\n        while(k)\n        {\n            if(k&1) t=t*e;\n            e=e*e,k>>=1;\n        }\n        for(int i=1;i<=n;++i)\n        {\n            for(int j=1;j<=n;++j)\n            {\n                if(i==j) f[i][j]=0;\n                else f[i][j]=inf;\n            }\n        }\n        for(int i=1;i<=p;++i) f[ed[i].x][ed[i].y]=1;\n        for(int k=1;k<=n;++k)\n            for(int i=1;i<=n;++i)\n                for(int j=1;j<=n;++j)\n                    f[i][j]=min(f[i][j],f[i][k]+f[k][j]);\n        for(int i=1;i<=n;++i)\n            if(t.a[1][i])\n                ans=min(ans,ed[p].d+f[i][n]);\n    }\n    if(ans==inf) puts(\"Impossible\");\n    else printf(\"%lld\",ans);\n    return 0;\n}\n```\n",
        "postTime": 1586794976,
        "uid": 172489,
        "name": "lhm_",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF576D \u3010Flights for Regular Customers\u3011"
    },
    {
        "content": "\u9898\u76ee\u5173\u5fc3\u7684\u53ea\u6709\u8d70\u8fc7\u7684\u8fb9\u6570\uff0c\u76f8\u5f53\u4e8e\u6bcf\u6761\u8fb9\u7684\u8fb9\u6743\u90fd\u4e3a $1$\u3002\u5f88\u719f\u6089\u7684\u611f\u89c9\u3002\n\n\u53c8\u89c2\u5bdf\u5230\u6570\u636e\u8303\u56f4\u3002\u66f4\u719f\u6089\u4e86\u3002\u77e9\u9635\u52a0\u901f\u7684\u5473\u9053\u5341\u5206\u6d53\u91cd\u3002\n\n\u5982\u679c\u5c06\u5f53\u524d\u8d70\u8fc7\u7684\u8fb9\u6570\u770b\u4f5c\u65f6\u95f4\u6233\uff0c\u53ef\u4ee5\u5148\u601d\u8003\u4e00\u4e0b\u82e5\u6bcf\u6761\u8fb9\u7684\u65f6\u95f4\u6233\u90fd\u4e3a $0$\uff0c\u5373\u6bcf\u6761\u8fb9\u4e00\u5f00\u59cb\u5c31\u5b58\u5728\u65f6\uff0c\u8be5\u5982\u4f55\u505a\u3002\n\n\u663e\u7136\uff0c\u8dd1\u4e00\u8fb9 bfs \u5373\u53ef\u89e3\u51b3\u3002\u65e0\u89e3\u7684\u60c5\u51b5\u5f88\u597d\u5224\u65ad\uff0c\u53ea\u8981 $1$ \u53f7\u8282\u70b9\u5728\u8fb9\u5168\u90fd\u5b58\u5728\u7684\u60c5\u51b5\u4e0b\u4e0d\u80fd\u5230\u8fbe $n$ \u53f7\u8282\u70b9\uff0c\u5219\u5728\u4efb\u610f\u65f6\u95f4\u6233\u4e0a\u7686\u65e0\u6cd5\u8fbe\u5230\u3002\n\n\u90a3\u4e48\u6709\u89e3\u7684\u65f6\u5019\u5462\uff1f\u6211\u4eec\u8bbe $dp_{i,j}$ \u8868\u793a\u8d70\u5230\u8282\u70b9 $j$ \u65f6\uff0c\u957f\u5ea6\u4e3a $i$ \u7684\u8def\u5f84\u662f\u5426\u5b58\u5728\uff0c\u5219\u663e\u7136 $dp_{i,j}$ \u53ef\u4ee5\u901a\u8fc7 $j$ \u53f7\u8282\u70b9\u7684\u6240\u6709\u76f8\u90bb\u8282\u70b9 $k$ \u7684 $dp_{i-1,k}$ \u6216\u8fd0\u7b97\u8fc7\u6765\u3002\u7531\u4e8e\u9012\u63a8\u5f0f\u5b50\u6052\u5b9a\uff0c\u6240\u4ee5\u53ef\u4ee5\u8003\u8651\u77e9\u9635\u4e58\u6cd5\uff0c\u5e76\u4e14\u7528 \u4e0e\u548c\u6216 \u4ee3\u66ff \u4e58\u548c\u52a0\u3002\n\n\u90a3\u6709 $d_i$ \u8be5\u600e\u4e48\u505a\u5462\uff1f\u8003\u8651\u5230\u5c06\u6240\u6709\u7684 $d_i$ \u6392\u5e8f\uff0c\u5219\u4e24\u4e2a $d_i$ \u4e4b\u95f4\u7684\u8f6c\u79fb\u65b9\u7a0b\u663e\u7136\u662f\u4e0d\u53d8\u7684\uff0c\u6211\u4eec\u5728\u6bcf\u5230\u4e00\u4e2a\u65f6\u95f4\u6233\u7684\u65f6\u5019\u505c\u6b62\u8f6c\u79fb\uff0c\u7136\u540e\u4ece\u76ee\u524d\u6240\u6709\u80fd\u5230\u7684\u5730\u65b9\u8dd1\u4e00\u8fb9\u5411\u7ec8\u70b9\u8dd1\u4e00\u8fb9\u591a\u6e90 bfs\uff0c\u5c06 bfs \u5230\u7684\u6700\u77ed\u8ddd\u79bb\u4e0e\u76ee\u524d\u5df2\u7ecf\u8d70\u8fc7\u7684\u8fb9\u6570\u76f8\u52a0\u5373\u4e3a\u5f53\u524d\u7684\u7b54\u6848\uff0c\u4fee\u6539\u8f6c\u79fb\u77e9\u9635\u4e4b\u540e\u518d\u7ee7\u7eed\u8f6c\u79fb\u5373\u53ef\u3002\u6ce8\u610f\u7531\u4e8e\u6bcf\u4e2a\u65f6\u95f4\u6233\u8fb9\u6570\u4e0d\u540c\uff0c\u6240\u4ee5\u5148\u5230\u8fbe\u7ec8\u70b9\u65f6\u7684\u7b54\u6848\u4e0d\u4e00\u5b9a\u6700\u4f18\uff0c\u9700\u8981\u5c06\u6bcf\u4e2a\u65f6\u95f4\u6233\u4e0a\u7684\u7b54\u6848\u5168\u90e8\u7b97\u51fa\u6765\uff0c\u53d6\u6700\u5c0f\u503c\u5c31\u662f\u7b54\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3\\log |d|\\times m)$\uff0c\u597d\u50cf\u8fc7\u4e0d\u4e86\u3002\n\n\u89c2\u5bdf\u5230 $dp$ \u503c\u53ea\u6709 $0$ \u548c $1$\uff0c\u6240\u4ee5\u7528 bitset \u4f18\u5316\u8f6c\u79fb\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4f1a\u4e58\u4e0a $\\frac{1}{w}=\\frac{1}{32}$\uff0c\u5dee\u4e0d\u591a\u80fd\u8fc7\u3002\n\n\u6ce8\u610f\u7528 bitset \u7684\u5199\u6cd5\u9700\u8981\u5c06\u4e24\u4e2a\u77e9\u9635\u5bf9\u9f50\uff0c\u5927\u6982\u53ef\u4ee5\u8fd9\u4e48\u5199\uff1a\n\n```cpp\nnode operator *(const node&x,const node&y){\n\tnode z;\n\tfor (int k=1;k<=n;k++)\n\t\tfor (int i=1;i<=n;i++)\n\t\t\tif (x.a[i][k]) z.a[i]|=y.a[k];\n\treturn z; \n}\n```\n\n\u603b\u4f53\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include <bits/stdc++.h> \nusing namespace std;\ntypedef long long ll;\nconst int N=155;\nconst ll INF=1e16;\nint n,m;\nll ans=INF,dis[N];\nstruct node{\n\tbitset<N> a[N];\n\tnode(){\n\t\tmemset(a,0,sizeof(a));\n\t}\n\tvoid init(){\n\t\tfor (int i=1;i<=n;i++) a[i][i]=1;\n\t}\n}P,F;\nstruct node1{\n\tint u,v,ti;\n}e[N];\nstruct node2{\n\tint head[N],to[N<<1],next[N<<1],tot;\n\tvoid adde(int u,int v){\n\t\tto[++tot]=v,next[tot]=head[u],head[u]=tot;\n\t}\n}S;\nnode operator *(const node&x,const node&y){\n\tnode z;\n\tfor (int k=1;k<=n;k++)\n\t\tfor (int i=1;i<=n;i++)\n\t\t\tif (x.a[i][k]) z.a[i]|=y.a[k];\n\treturn z; \n}\nll read(){\n\tll w=0,f=1;\n\tchar c=getchar();\n\twhile (c>'9'||c<'0'){\n\t\tif (c=='-') f=-1;\n\t\tc=getchar();\n\t}\n\twhile (c>='0'&&c<='9'){\n\t\tw=(w<<3)+(w<<1)+(c^48);\n\t\tc=getchar();\n\t}\n\treturn w*f;\n}\nbool cmp(node1 x,node1 y){\n\treturn x.ti<y.ti;\n}\nnode ksm(node H,int k){\n\tnode P;\n\tP.init();\n\twhile (k){\n\t\tif (k&1) P=P*H;\n\t\tH=H*H;\n\t\tk>>=1;\n\t}\n\treturn P;\n}\nll bfs(){\n\tqueue<int> q;\n\tfor (int i=1;i<=n;i++)\n\t\tif (F.a[1][i]==1) q.push(i),dis[i]=0;\n\t\telse dis[i]=INF;\n\twhile (!q.empty()){\n\t\tint u=q.front();\n\t\tq.pop();\n\t\tfor (int i=S.head[u];i;i=S.next[i]){\n\t\t\tint v=S.to[i];\n\t\t\tif (dis[v]==INF) dis[v]=dis[u]+1,q.push(v);\n\t\t}\n\t}\n\treturn dis[n];\n}\nint main(){\n\tn=read(),m=read();\n\tfor (int i=1;i<=m;i++){\n\t\te[i].u=read(),e[i].v=read(),e[i].ti=read();\n\t}\n\tsort(e+1,e+1+m,cmp);\n\tF.a[1][1]=1;\n\tll now=1,nowt=0,lat=0;\n\twhile (now<=m){\n\t\tF=F*ksm(P,nowt-lat);\n\t\twhile (now<=m&&e[now].ti==nowt){\n\t\t\tS.adde(e[now].u,e[now].v);\n\t\t\tP.a[e[now].u][e[now].v]=1;\n\t\t\t++now;\n\t\t}\n\t\tlat=nowt,nowt=e[now].ti;\n\t\tans=min(ans,bfs()+lat);\n//\t\tfor (int j=1;j<=n;j++){\n//\t\t\tfor (int k=1;k<=n;k++)\n//\t\t\t\tcout<<F.a[j][k]<<\" \";\n//\t\t\tputs(\"ok\");\n//\t\t}\n\t}\n\tif (ans!=INF) cout<<ans<<'\\n';\n\telse puts(\"Impossible\");\n\treturn 0;\n}\n\n```",
        "postTime": 1665040867,
        "uid": 257621,
        "name": "\u7ffc\u5fb7\u5929\u5c0a",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 CF576D Flights for Regular Customers"
    },
    {
        "content": "# T1 CF576D Flights for Regular Customers\n\n- \u7ed9\u5b9a\u4e00\u5f20 n \u4e2a\u70b9 m\u6761\u8fb9\u7684\u6709\u5411\u56fe\u3002\n- \u4e00\u5f00\u59cb\u4f60\u5728 1 \u53f7\u8282\u70b9\uff0c\u4f60\u8981\u8d70\u5230 n \u53f7\u8282\u70b9\u53bb\u3002\n- \u53ea\u6709\u5f53\u4f60\u5df2\u7ecf\u8d70\u8fc7\u4e86\u81f3\u5c11 d_i \u6761\u8fb9\u65f6\uff0c\u4f60\u624d\u80fd\u8d70\u7b2c i \u6761\u8fb9\u3002\n- \u95ee\u6700\u5c11\u8981\u8d70\u591a\u5c11\u6761\u8fb9\uff0c\u6216\u5224\u65ad\u65e0\u6cd5\u5230\u8fbe\u3002\n- $n , m \\le 150 \\ \\ d_i \\le 10^9$\u3002\n\n**solution**\n\n\u7b80\u5355\u6765\u8bf4\u5c31\u662f\uff0c\n\n- \u5c06\u8fb9\u6309\u7167\u9650\u5236\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u4f9d\u6b21\u52a0\u5165\n\n- \u7528\u77e9\u9635\u5feb\u901f\u5e42\u7ef4\u62a4\u53ef\u8fbe\u6027\uff0c\u518d\u7528\u4e00\u4e2abitset\u7ef4\u62a41\u53f7\u70b9\u53ef\u4ee5\u5230\u8fbe\u7684\u70b9\u3002\n- \u4f46\u662f\u77e9\u4e58\u590d\u6742\u5ea6\u6709\u70b9\u9ad8\uff0c\u53c8\u56e0\u4e3a\u77e9\u4e58\u53ea\u7528\u7ef4\u62a40 / 1 \uff0c \u6240\u4ee5\u53ef\u4ee5\u7528bitset\u4f18\u5316\u3002\n- \u6bcf\u52a0\u5165\u4e00\u4e2a\u8fb9\u4e4b\u540e\uff0c\u7528bfs\u6c42\u4e00\u904dans\uff0c\u66f4\u65b0\u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N = 155;\ninline int read()\n{\n\tregister int x = 0 , f = 0; register char c = getchar();\n\twhile(c < '0' || c > '9') f |= c == '-' , c = getchar();\n\twhile(c >= '0' && c <= '9') x = (x << 3) + (x << 1) + (c ^ 48) , c = getchar();\n\treturn f ? -x : x;\n}\nint n , m;\nint dis[N];\nstruct edge{ int u , v , c; }e[N];\nbitset<N> to;\nqueue<int> q;\nstruct Matrix\n{\n\tbitset<N> a[N];\n\tbitset<N> friend operator * (const bitset<N> &A , const Matrix &B)\n\t{\n\t\tbitset<N> C;\n\t\tfor(int i = 0 ; i < n ; ++i) C[i] = (A & B.a[i]).any();\n\t\treturn C;\n\t}\n\tMatrix friend operator * (const Matrix &A , const Matrix &B)\n\t{\n\t\tMatrix C;\n\t\tfor(int i = 0 ; i < n ; ++i)\n\t\t\tfor(int j = 0 ; j < n ; ++j)\n\t\t\t\tif(A.a[i][j]) C.a[i] |= B.a[j];\n\t\treturn C;\n\t}\n}mp;\n\nvoid ksm(Matrix A , int k , bitset<N> &to)\n{\n\tfor( ; k ; k >>= 1 , A = A * A)\n\t\tif(k & 1) to = to * A;\n}\n\nint main()\n{\n\tn = read(); m = read();\n\tfor(int i = 1 ; i <= m ; ++i) e[i].u = read() - 1 , e[i].v = read() - 1 , e[i].c = read();\n\tsort(e + 1 , e + 1 + m , [&](const edge &A , const edge &B) { return A.c < B.c; });\n\tto[0] = 1; int ans = 2e9 , lst = 0;\n\tfor(int i = 1 ; i <= m ; ++i)\n\t{\n\t\tif(e[i].c >= ans) break; ksm(mp , e[i].c - lst , to); lst = e[i].c;\n\t\tmp.a[e[i].v][e[i].u] = 1;\n\t\tfor(int j = 0 ; j < n ; ++j) if(to[j]) dis[j] = 0 , q.push(j); else dis[j] = 2e9;\n\t\twhile(q.size())\n\t\t{\n\t\t\tint x = q.front(); q.pop();\n\t\t\tfor(int i = 0 ; i < n ; ++i) if(mp.a[i][x] && dis[i] == 2e9) dis[i] = dis[x] + 1 , q.push(i);\n\t\t}\n\t\tif(dis[n - 1] < 2e9) ans = min(ans , lst + dis[n - 1]);\n\t}\n\tif(ans == 2e9) puts(\"Impossible\"); else cout << ans << '\\n';\n\treturn 0;\t\n}\n```\n\n",
        "postTime": 1592278384,
        "uid": 153897,
        "name": "RQ\u3002\u3002\u3002",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF576D \u3010Flights for Regular Customers\u3011"
    },
    {
        "content": "## \u9898\u76ee\u5927\u610f:\n\u7ed9\u51fa\u4e00\u5f20\u6709\u5411\u56fe\uff0c\u73b0\u5728\u5728\u70b9$1$\uff0c\u8981\u53bb\u70b9$n$\u3002\n\n\u6bcf\u6761\u8def\u5982\u679c\u4f60\u8981\u8d70\u5fc5\u987b\u5728\u4e4b\u524d\u8d70\u8fc7$d_i$\u6761\u8def\u3002\n\n\u95ee\u81f3\u5c11\u9700\u8981\u8d70\u8fc7\u591a\u5c11\u6761\u8def\u4f60\u624d\u80fd\u5230\u8fbe\u76ee\u7684\u5730\u3002\n## \u89e3\u9898\u601d\u8def\uff1a\n\u7531\u4e8e\u90bb\u63a5\u77e9\u9635\u7684\u6027\u8d28\uff0c\u90bb\u63a5\u77e9\u9635$A^k$\u4e2d\u7b2c$i$\u884c\u7b2c$j$\u5217\u7684\u5143\u7d20\u8868\u793a\u662f\u5426\u80fd\u591f\u6070\u597d\u7ecf\u8fc7$k$\u6b65\u4ece$i$\u8d70\u5230$j$\n\n\u90a3\u6211\u4eec\u9996\u5148\u8ba9\u8def\u5bf9$d_i$\u6392\u5e8f\uff0c\u8fd9\u6837\u5c31\u80fd\u5bf9\u90bb\u63a5\u77e9\u9635\u4e00\u4e2a\u4e00\u4e2a\u5f80\u4e0a\u52a0\u4e86\u3002\n\n\u56e0\u4e3a\u5bf9\u4e8e\u6bcf\u4e00\u79cd\u53ef\u4ee5\u8d70\u7684\u8def\u7684\u60c5\u51b5\uff0c\u6700\u591a\u53ea\u9700\u8981\u8d70$n$\u6761\u8def\u5c31\u80fd\u591f\u8d70\u5230\u76ee\u7684\u5730\u4e86\u3002\u6240\u4ee5\uff1a\n\n- \u5982\u679c\u4e24\u4e2a\u6392\u5e8f\u540e\u76f8\u90bb\u7684\u8def\u7684$d$\u503c\u4e4b\u5dee\u5c0f\u4e8e$n$\uff0c\u90a3\u6211\u4eec\u5c31\u66b4\u529b\u4f5c\u77e9\u9635\u4e58\u6cd5\u3002\n\n- \u5982\u679c\u4e24\u4e2a\u6392\u5e8f\u540e\u76f8\u90bb\u7684\u8def\u7684$d$\u503c\u4e4b\u5dee\u5927\u4e8e$n$\uff0c\u6211\u4eec\u5148\u66b4\u529b\u4f5c$n$\u6b21\u77e9\u9635\u4e58\u6cd5\uff0c\u7136\u540e\u5269\u4e0b\u7684\u5c31\u4ea4\u7ed9\u77e9\u9635\u5feb\u901f\u5e42\n\n\u8fd9\u6837\u7684\u590d\u6742\u5ea6\u662f$O(n^3mlogd)$\u7684\uff0c\u4e0d\u591f\u4f18\u79c0\u3002\n\n\u5bf9\u4e8e\u77e9\u9635\u4e58\u6cd5\u6211\u4eec\u53ef\u4ee5\u7528$bitset$\u5b9e\u73b0\u3002\u590d\u6742\u5ea6\u5c31\u53d8\u6210\u4e86$O(\\frac{n^3mlogd}{w})$\n# Code:\n```cpp\n#include<cstdio>\n#include<bitset>\n#include<algorithm>\nusing std::sort;\nusing std::bitset;\nint n,m;\nbitset<160>a[160],b[160],T[160];\nstruct Edge{\n\tint from,to,w;\n\tbool operator<(Edge x)const{\n\t\treturn w<x.w;\n\t}\n}edge[160];\nvoid times(bitset<160>*a,bitset<160> *b){\n\tbitset<160>res[160];\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tif(a[i][j])res[i]|=b[j];\n\tfor(int i=1;i<=n;i++)a[i]=res[i];\n}\nvoid quickpow(bitset<160>*a,int b){\n\tbitset<160>res[160];\n\tfor(int i=1;i<=n;i++)res[i][i]=1;\n\twhile(b){\n\t\tif(b&1)times(res,a);\n\t\ttimes(a,a);\n\t\tb>>=1;\t\t\n\t}\n\tfor(int i=1;i<=n;i++)a[i]=res[i];\n}\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=m;i++)\n\t\tscanf(\"%d%d%d\",&edge[i].from,&edge[i].to,&edge[i].w);\n\tsort(edge+1,edge+m+1);\n\tfor(int i=1;i<=n;i++)\n\t\ta[i][i]=1;\n\tint now=0;\n\tif(edge[1].w>0)return puts(\"Impossible\"),0;\n\tfor(int i=1;i<m;i++){\n\t\tT[edge[i].from][edge[i].to]=1;\n\t\tif(edge[i].w==edge[i+1].w)continue;\n\t\tfor(int j=1;j<=n+1&&now<edge[i+1].w;j++,now++){\n\t\t\ttimes(a,T);\n\t\t\tif(a[1][n]==1)return printf(\"%d\\n\",now+1),0;\n\t\t}\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tb[j]=T[j];\n\t\tquickpow(b,edge[i+1].w-now);\n\t\ttimes(a,b);\n\t\tnow=edge[i+1].w;\n\t}\n\tT[edge[m].from][edge[m].to]=1;\n\tfor(int j=1;j<=n+1;j++,now++){\n\t\ttimes(a,T);\n\t\tif(a[1][n]==1)return printf(\"%d\\n\",now+1),0;\n\t}\n\treturn puts(\"Impossible\"),0;\n}\n```",
        "postTime": 1571657895,
        "uid": 13237,
        "name": "\u60c5\u975e\u6614\u6bd4",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF576D \u3010Flights for Regular Customers\u3011"
    },
    {
        "content": "\u6bcf\u6761\u8fb9\u89e3\u9501\u7684\u65f6\u523b\u662f\u4e0d\u540c\u7684\uff0c\u6240\u4ee5\u8981\u628a\u4f1a\u51fa\u73b0\u7684 $m$ \u5f20\u56fe\u5206\u5f00\u8003\u8651\u3002\n\n\u7ef4\u62a4\u4e00\u4e2a $f_{1,2,\\cdots,n}$ \u8868\u793a\u5f53\u524d\u65f6\u523b\u80fd\u8d70\u5230\u54ea\u4e9b\u8282\u70b9\u3002\n\n\u5982\u679c\u6211\u4eec\u5904\u7406\u51fa\u6765\u4e86\u5f53\u524d\u65f6\u523b\u56fe\u7684\u90bb\u63a5\u77e9\u9635\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u505a\u4e00\u6b21\u77e9\u9635\u4e58\u6cd5\u5c31\u80fd\u63a8\u51fa\u4e0b\u4e00\u65f6\u523b\u6240\u6709\u8282\u70b9\u7684\u53ef\u8fbe\u6027\u3002\n\n\u4f46\u5982\u679c\u6211\u4eec\u6bcf\u6b21\u5f80\u540e\u4e00\u4e2a\u65f6\u523b\uff0c\u90fd\u9700\u8981\u4e00\u6b21\u77e9\u9635\u4e58\u6cd5\u7684\u8bdd\uff0c\u90a3\u663e\u7136\u5c31\u5bc4\u4e86\u3002\n\n> \u7ed3\u8bba\uff1a\u5047\u8bbe\u521a\u89e3\u9501\u8fd9\u6761\u8fb9\u5728 $l$ \u65f6\u523b\u89e3\u9501\uff0c\u4e0b\u4e00\u6761\u8fb9\u8981\u5230 $r$ \u65f6\u523b\u624d\u80fd\u89e3\u9501\uff1b\u5982\u679c $r-l>n$\uff0c\u4e14\u5728 $l,l+1,\\cdots,l+n $ \u65f6\u523b\u65f6\u90fd\u65e0\u6cd5\u8d70\u5230 $n$ \u8282\u70b9\uff0c\u90a3\u4e48 $l+n+1,\\cdots,r$ \u65f6\u523b\u4e5f\u4e0d\u884c\u3002\n\n> \u8bc1\u660e\uff1a\u82e5\u4e0d\u7136\uff0c\u8bbe\u5b58\u5728\u4e00\u79cd\u8d70\u6cd5\uff0c\u5728 $l$ \u65f6\u523b\u65f6\u5728 $x$\uff0c$t$ \u65f6\u523b\u65f6\u8d70\u5230\u4e86 $n(t \\ge l+n+1)$\uff0c\u4e14\u5728 $1,2,\\cdots,t-1$ \u65f6\u523b\u91cc $n$ \u8282\u70b9\u90fd\u4e0d\u53ef\u8fbe\u3002\n\n> \u90a3\u4e48\u5728 $l,l+1,\\cdots,t$ \u65f6\u523b\u91cc\u7ecf\u8fc7\u7684\u70b9\u91cc\uff0c\u4e00\u5b9a\u6709\u4e24\u4e2a\u662f\u91cd\u590d\u7684\uff0c\u628a\u4e24\u6b21\u8d70\u5230\u91cd\u590d\u7684\u70b9\u95f4\u7684\u70b9\u4ece\u8def\u5f84\u4e2d\u5220\u6389\uff0c\u53ef\u4ee5\u5728\u66f4\u65e9\u7684\u65f6\u523b\u5230\u8fbe $n$ \u8282\u70b9\uff0c\u4e0e\u6700\u5c0f\u6027\u77db\u76fe\uff01\n\n> \u6545\u7ed3\u8bba\u6210\u7acb\u3002\n\n\u6709\u4e86\u8fd9\u4e2a\u7ed3\u8bba\uff0c\u6211\u4eec\u6bcf\u6b21\u52a0\u4e00\u6761\u8fb9\u4e4b\u540e\uff0c\u53ea\u9700\u8981\u6700\u591a $n$ \u6b21\u77e9\u9635\u4e58\u6cd5\uff0c\u5269\u4e0b\u7684\u4ea4\u7ed9\u77e9\u9635\u5feb\u901f\u5e42\u5c31\u884c\u3002\n\n\u8fd9\u65f6\u590d\u6742\u5ea6 $O(n^3m \\log T)$\uff0c\u4f1a $\\text{TLE on 10}$\u3002\n\n\u77e9\u9635\u4e58\u6cd5\u7ef4\u62a4\u7684\u662f\u524d\u5f80\u6bcf\u4e2a\u70b9\u7684\u65b9\u6848\u6570\uff0c\u4f46\u4f60\u5e76\u4e0d\u7528\u77e5\u9053\u65b9\u6848\u6570\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u7528 `bitset` \u4f18\u5316\u77e9\u9635\u4e58\u6cd5\uff0c\u590d\u6742\u5ea6 $O(\\frac{n^3m \\log T}{w})$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int NR=200;\nint n,m;\nstruct edge{\n\tint x,y,t;\n\tbool operator <(const edge &T)const{\n\t\treturn t<T.t;\n\t}\n}g[NR];\n\nstruct mat{\n\tint H,W;\n\tbitset<NR>a[NR];\n\tvoid clear(int x=0,int y=0){\n\t\tH=x;W=y;\n\t\tfor(int i=1;i<=H;i++)a[i].reset();\n\t}\n\tvoid init(){\n\t\tclear(n,n);\n\t\tfor(int i=1;i<=n;i++)a[i][i]=1;\n\t}\n};\nmat times(mat r1,mat r2){\n\t//bitset \u4f18\u5316\u77e9\u9635\u4e58\u6cd5\n\tmat res;res.clear(r1.H,r2.W);\n\tfor(int i=1;i<=r1.H;i++)\n\t\tfor(int k=1;k<=r2.W;k++)\n\t\t\tif(r1.a[i][k])\n\t\t\t\tres.a[i]|=r2.a[k];\n\treturn res;\n}\nmat quickpow(mat x,int y){\n\tmat res;res.init();\n\twhile(y){\n\t\tif(y&1)res=times(res,x);\n\t\tx=times(x,x);\n\t\ty>>=1;\n\t}\n\treturn res;\n}\n\nint main(){\n\tcin>>n>>m;\n\tfor(int i=1;i<=m;i++)\n\t\tscanf(\"%d%d%d\",&g[i].x,&g[i].y,&g[i].t);\n\tsort(g+1,g+1+m);\n\tmat now,W;W.clear(n,n);now.clear(1,n);now.a[1][1]=1;\n\tif(g[1].t){\n\t\tputs(\"Impossible\");\n\t\treturn 0;\n\t}\n\tg[m+1].t=2e9;\n\tfor(int i=1;i<=m;i++){\n\t\tW.a[g[i].x][g[i].y]=1;\n\t\tfor(int j=1;j<=min(n,g[i+1].t-g[i].t);j++){\n\t\t\tnow=times(now,W);\n\t\t\tbool flag=0;\n\t\t\tfor(int k=1;k<=n;k++)flag|=now.a[1][k];\n\t\t\tif(!flag){\n\t\t\t\tputs(\"Impossible\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif(now.a[1][n]){\n\t\t\t\tcout<<g[i].t+j<<endl;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t\tnow=times(now,quickpow(W,max(0,g[i+1].t-g[i].t-n)));\n\t\tbool flag=0;\n\t\tfor(int k=1;k<=n;k++)flag|=now.a[1][k];\n\t\tif(!flag){\n\t\t\tputs(\"Impossible\");\n\t\t\treturn 0;\n\t\t}\n\t}\n\tputs(\"Impossible\");\n\treturn 0;\n}\n```",
        "postTime": 1655648105,
        "uid": 117771,
        "name": "intel_core",
        "ccfLevel": 7,
        "title": "CF576D \u9898\u89e3"
    },
    {
        "content": "[\u66f4\u597d\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/YouthRhythms/p/13307435.html)\n# \u9898\u76ee\u94fe\u63a5\n\n[\u70b9\u51fb\u6253\u5f00\u94fe\u63a5](https://codeforces.com/problemset/problem/576/D)\n\n# \u9898\u76ee\u89e3\u6cd5\n\n\u8003\u8651\u679a\u4e3e\u6700\u4f18\u72b6\u6001\u662f\u54ea\u4e9b\u8fb9\u89e3\u9501\u4e86\uff0c\u54ea\u4e9b\u8fb9\u6ca1\u6709\u3002\u8fd9\u6837\u771f\u7684\u6709 $2^n$ \u79cd\u60c5\u51b5\u5417\uff1f\u5e76\u4e0d\u662f\u7684\u3002\u5c06\u6240\u6709\u8fb9\u6309\u7167\u89e3\u9501\u9700\u8981\u8d70\u8fc7\u8fb9\u7684\u6570\u91cf\u6392\u5e8f\u3002\u89e3\u9501\u8fb9\u7684\u987a\u5e8f\u5fc5\u7136\u662f\u6392\u597d\u5e8f\u7684\u8fd9\u6837\u3002\u6240\u4ee5\u8003\u8651\u53ea\u89e3\u9501\u524d $i$ \u6761\u8fb9\uff0c\u8d70\u5230 $n$ \u7684\u6700\u77ed\u8ddd\u79bb\u662f\u591a\u5c11\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\uff1a\u6bcf\u6b21\u679a\u4e3e\u65b0\u89e3\u9501\u4e86\u54ea\u4e00\u6761\u8fb9\uff0c\u5982\u679c\u5f53\u524d\u8fb9\u9700\u8981\u8d70 $i$ \u6b65\u624d\u80fd\u89e3\u9501\uff0c\u90a3\u4e48\u770b\u8d70 $i$ \u6761\u8fb9\u5e76\u89e3\u9501\u8fd9\u4e2a\u8fb9\u540e\u53ef\u4ee5\u5230\u54ea\u4e9b\u70b9\uff0c\u7528\u90a3\u4e9b\u70b9\u8dd1\u4e00\u8fb9\u591a\u6e90 `dfs` \u5bfb\u627e\u5230\u7ec8\u70b9\u7684\u6700\u77ed\u8def\uff0c\u66f4\u65b0\u7b54\u6848\u5373\u53ef\u3002\n\n\u7136\u800c\u8fd9\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n^3m\\log n)$ \u5e76\u4e0d\u80fd\u8fc7\u53bb\u3002\u74f6\u9888\u662f\u77e9\u9635\u5feb\u901f\u5e42\u3002\u7531\u4e8e\u77e9\u9635\u662f`0/1` \u77e9\u9635\uff0c\u6240\u4ee5\u4f7f\u7528`bitset`\u4f18\u5316\u5373\u53ef\u3002\u6bd4\u8f83\u65e0\u8111\u7684`bitset`\u53ef\u4ee5\u7ef4\u62a4\u77e9\u9635\u7684\u884c\u548c\u5217\uff0c\u7ef4\u62a4\u4e24\u4e2a`bitset`\u6570\u7ec4\uff0c\u8fd9\u6837\u6bd4\u8f83\u65b9\u4fbf\u5199\u3002\u5f53\u7136\u4e5f\u53ef\u4ee5\u53ea\u7ef4\u62a4\u4e00\u4e2a`bitset`\uff0c\u8fd9\u6837\u96be\u7406\u89e3\uff0c\u800c\u4e14\u975e\u5e38\u975e\u5e38\u6ca1\u5fc5\u8981\u3002\n\n# \u603b\u7ed3\n\n+ `bitset` \u4f18\u5316`0/1`\u77e9\u9635\u7684\u4e58\u6cd5\u3002\n+ \u89e3\u9501\u987a\u5e8f\u53ef\u4ee5\u53bb\u6389\u4e00\u4e9b\u8fb9\u7684\u89e3\u9501\u72b6\u6001\u3002\n\n# \u4ee3\u7801\n\n```cpp\n#include <cstdio>\n#include <bitset>\n#include <queue>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\nconst int NM = 155;\nconst ll infll = 0x3f3f3f3f3f3f3f3fll;\ntypedef bitset<150> bt;\nint n, m;\nstruct Edge {\n\tint u, v, w;\n\tinline bool operator < (const Edge &d) const { return w < d.w; }\n} eg[NM];\nstruct Mat {\n\tbt A[150];\n\tinline bt & operator [] (const int i) { return A[i]; }\n\tinline const bt & operator [] (const int i) const { return A[i]; }\n\t//\u56e0\u4e3a Mat * \u4e0d\u80fd\u4fdd\u5b58 const Mat * \u7684\u4e1c\u897f\n\t//\u6240\u4ee5\u5fc5\u987b\u6709\u4e00\u79cd\u8fd4\u56de const Mat * \u7684\u8c03\u7528\u65b9\u6cd5 \n} A;\nbt operator * (const Mat &A, const bt &B) {\n\tstatic bt ret;\n\tfor (int i = 0; i < n; ++i) ret[i] = (A[i] & B).any();\n\treturn ret;\n}\nMat operator * (const Mat &A, const Mat &B) {\n\tstatic Mat ret;\n\tfor (int i = 0; i < n; ++i) ret[i].reset();\n\tfor (int i = 0; i < n; ++i)\n\t\tfor (int j = 0; j < n; ++j)\n\t\t\tif (A[i][j]) ret[i] |= B[j];\n\treturn ret;\n}\nvoid ksm(bt &A, Mat B, int c) {\n\tfor (; c; c >>= 1, B = B * B)\n\t\tif (c & 1) A = B * A;\n}\nbt go;\nqueue<int> Q;\nll dis[NM];\nint main() {\n\tscanf(\"%d%d\", &n, &m);\n\tfor (int i = 1; i <= m; ++i) {\n\t\tscanf(\"%d%d%d\", &eg[i].u, &eg[i].v, &eg[i].w);\n\t\t--eg[i].u, --eg[i].v;\n\t}\n\tsort(eg + 1, eg + m + 1);\n\tgo[0] = 1;\n\tll ans = infll;\n\tfor (int i = 1, t = 0; i <= m; ++i) {\n\t\tif (eg[i].w >= ans) break ;\n\t\tif (eg[i].w != t) ksm(go, A, eg[i].w - t);\n\t\tt = eg[i].w;\n\t\tA[eg[i].v][eg[i].u] = 1;\n\t\tfor (int j = 0; j < n; ++j)\n\t\t\tif (go[j]) Q.push(j), dis[j] = 0;\n\t\t\telse dis[j] = infll;\n\t\twhile (Q.size()) {\n\t\t\tint u = Q.front();\n\t\t\tQ.pop();\n\t\t\tfor (int j = 0; j < n; ++j)\n\t\t\t\tif (A[j][u] && dis[j] == infll) {\n\t\t\t\t\tdis[j] = dis[u] + 1;\n\t\t\t\t\tQ.push(j);\n\t\t\t\t}\n\t\t}\n\t\tans = min(ans, t + dis[n - 1]);\n\t}\n\tif (ans == infll) printf(\"Impossible\\n\");\n\telse printf(\"%lld\\n\", ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1594987957,
        "uid": 75715,
        "name": "KokiNiwa",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF576D \u3010Flights for Regular Customers\u3011"
    },
    {
        "content": "\u9898\u610f\uff1a\n\n\u4e00\u5f20$n$\u4e2a\u70b9\uff0c$m$\u6761\u8fb9\u7684\u6709\u5411\u56fe\uff0c\u6bcf\u6761\u8fb9\u6709\u4e00\u4e2a\u6743\u503c$d_i$\uff0c\u4e00\u6761\u8fb9\u53ea\u6709\u5728\u8d70\u8fc7\u7684\u8fb9\u6570\u4e0d\u5c0f\u4e8e$d_i$\u65f6\u624d\u80fd\u88ab\u7ecf\u8fc7\uff0c\u6c42\u4ece$1$\u5230$n$\u7684\u6700\u5c0f\u6b65\u6570\u3002\n\n\u8fd9\u4e2a\u9898\u4e00\u773c\u5c31\u5f88\u77e9\u9635\u5feb\u901f\u5e42\u3002\n\n\u6211\u4eec\u5c06\u8fb9\u6309$d_i$\u6392\u5e8f\uff0c\u5f00\u4e34\u63a5\u77e9\u9635\uff0c\u6309\u5927\u5c0f\u904d\u5386\u6bcf\u6761\u8fb9\uff1b\n\n\u628a\u904d\u5386\u5230\u7684\u8fb9\u52a0\u5165\u90bb\u63a5\u77e9\u9635\u3002\n\n\u8fd0\u7528\u4e00\u4e2a\u7ed3\u8bba:\n\n\u5bf9\u90bb\u63a5\u77e9\u9635$X$\uff0c$X^ki,j$\u8868\u793a\u662f\u5426\u80fd\u4ece$i$\u7ecf\u8fc7$k$\u6b65\u5230$j$\u3002\n\n\u76f4\u63a5\u77e9\u9635\u5feb\u901f\u5e42\u5373\u53ef\u3002\n\n```cpp\nfor(int i = 1; i < m; i++) {\n\tT[e[i].u][e[i].v] = 1;//\u52a0\u5165\u4e00\u6761\u8fb9\n\t\tfor(int j = 1; j < n + 2 && ans < e[i + 1].w; j++ , ans++){\n\t\t\ttim(x , T);\n\t\t\tif(x[1][n] == 1) {\n\t\t\t\tcout << ans + 1;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}//\u5bf9\u524dn\u6b65\u66b4\u529b\u4e58\n\t\tfor(int j = 1 ; j <= n; j++)\n\t\t\ty[j] = T[j];\n\t\tqpow(y , e[i + 1].w - ans);\n\t\ttim(x , y);\n\t\tnow = e[i + 1].w;\n\t}\n```\n",
        "postTime": 1584438129,
        "uid": 145078,
        "name": "RainSong",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF576D \u3010Flights for Regular Customers\u3011"
    }
]
[
    {
        "content": "\u9996\u5148\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $s_i$\uff0c\u6211\u4eec\u53ea\u7528\u4fdd\u7559\u5176\u6700\u5c0f\u5468\u671f\uff0c\u8bc1\u660e\u663e\u7136\u3002\n\n\u540c\u65f6\u4ee5\u591a\u4e2a\u5149\u7535\u95e8\u4e3a\u7814\u7a76\u5bf9\u8c61\u663e\u7136\u72b6\u6001\u6570\u8fc7\u591a\uff0c\u4e0d\u65b9\u4fbf\u7edf\u8ba1\u3002\u8003\u8651\u4e00\u4e0b\u8fde\u63a5\u4e0d\u540c\u5149\u7535\u95e8\u7684\u7ebd\u5e26\u662f\u4ec0\u4e48\uff1a\u663e\u7136\u662f\u76f8\u90bb\u5149\u7535\u95e8\u4e4b\u95f4\u7684\u7a7a\u9699\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u5149\u7535\u95e8 $i$\uff0c\u5982\u679c\u6211\u4eec\u53ea\u4fdd\u7559 $i$ \u4f5c\u4e3a\u552f\u4e00\u7684\u5149\u7535\u95e8\uff0c\u90a3\u4e48\u663e\u7136\u6709 $0\\to 1$ \u548c $1\\to 2$ \u4e24\u4e2a\u95f4\u9699\uff0c\u6211\u4eec\u901a\u8fc7\u6a21\u62df\u6c42\u51fa\u5728\u53ea\u4fdd\u7559\u8fd9\u4e00\u4e2a\u5149\u7535\u95e8\u7684\u524d\u63d0\u4e0b $0\\to 1$ \u548c $1\\to 2$ \u7684\u6b21\u6570 $a_i,b_i$\uff0c\u90a3\u4e48\u6211\u4eec\u60ca\u5947\u5730\u53d1\u73b0\uff0c\u5728\u6574\u4e2a\u8fc7\u7a0b\u4e2d\uff0c$i-1\\to i$ \u7684\u6b21\u6570\u548c $i\\to i+1$ \u7684\u6b21\u6570\u4e4b\u6bd4\u5c31\u662f $a_i:b_i$\u3002\n\n\u6211\u4eec\u5047\u8bbe $i\\to i+1$ \u7684\u7ecf\u8fc7\u6b21\u6570\u4e3a $f_i$\uff0c\u90a3\u4e48\u5f62\u5f0f\u5316\u5730\u8bf4\uff0c\u5c31\u662f $\\forall i\\in[1,n],\\exists k_i,s.t.f_{i-1}=a_ik_i,f_{i}=b_ik_i$\uff0c\u76f4\u63a5\u66b4\u529b\u5bf9\u4e8e\u6bcf\u4e2a\u8d28\u6570\u6c42\u51fa\u8fd9\u4e2a\u8d28\u6570\u5728 $f_0$ \u4e2d\u51fa\u73b0\u6b21\u6570\u7684\u6700\u5c0f\u503c\uff0c\u7136\u540e\u4e58\u8d77\u6765\u5c31\u5f97\u5230\u6700\u5c0f\u5468\u671f\u4e2d\u7684 $f_0$ \u4e86\u3002\u8fd9\u6837\u5c31\u80fd\u6c42\u51fa\u5b8c\u6574\u7684 $f$ \u6570\u7ec4\uff0c\u7b54\u6848\u5373\u4e3a $2\\sum f_i$\u3002\n\n```cpp\nconst int MAXN=2e6;\nconst int MOD=998244353;\nint qpow(int x,int e){int ret=1;for(;e;e>>=1,x=1ll*x*x%MOD)if(e&1)ret=1ll*ret*x%MOD;return ret;}\nint n,a[MAXN+5],b[MAXN+5],kmp[MAXN+5];char buf[MAXN+5];\nint pr[MAXN+5],prcnt,vis[MAXN+5],mnp[MAXN+5];\nvoid sieve(int n){\n\tfor(int i=2;i<=n;i++){\n\t\tif(!vis[i])pr[++prcnt]=i,mnp[i]=i;\n\t\tfor(int j=1;j<=prcnt&&pr[j]*i<=n;j++){\n\t\t\tvis[pr[j]*i]=1;mnp[i*pr[j]]=pr[j];\n\t\t\tif(i%pr[j]==0)break;\n\t\t}\n\t}\n}\nvector<pii>vec[MAXN+5];\nint prd=1;\nint main(){\n\tscanf(\"%d\",&n);sieve(MAXN);\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%s\",buf+1);int len=strlen(buf+1);\n\t\tfor(int j=1;j<=len;j++)kmp[j]=0;\n\t\tfor(int j=2,k=0;j<=len;j++){\n\t\t\twhile(k&&buf[j]!=buf[k+1])k=kmp[k];\n\t\t\tif(buf[j]==buf[k+1])++k;kmp[j]=k;\n\t\t}\n\t\tint nl=((len%(len-kmp[len])==0)?(len-kmp[len]):len),cur=0,dir=1,pt=1;\n\t\tdo{\n\t\t\tif((cur==0&&dir==-1)||(cur==2&&dir==1))dir=-dir;\n\t\t\tif(dir==1)((!cur)?a[i]:b[i])++;\n\t\t\tcur+=dir;\n\t\t\tif(cur==1){\n\t\t\t\tif(buf[pt]=='1')dir=-dir;\n\t\t\t\tpt=pt%nl+1;\n\t\t\t}\n\t\t}while(cur!=0||pt!=1);\n//\t\tprintf(\"! %d %d\\n\",a[i],b[i]);\n\t}\n\tint lim=n;\n\tfor(int i=1;i<=n;i++)if(!b[i]){lim=i-1;break;}\n\tfor(int i=1;i<=lim;i++){\n\t\tint tmp=b[i];\n\t\twhile(tmp!=1){\n\t\t\tint p=mnp[tmp],cnt=0;\n\t\t\twhile(tmp%p==0)tmp/=p,cnt++;\n\t\t\tvec[p].pb(mp(cnt,1));\n\t\t}\n\t\ttmp=a[i];\n\t\twhile(tmp!=1){\n\t\t\tint p=mnp[tmp],cnt=0;\n\t\t\twhile(tmp%p==0)tmp/=p,cnt++;\n\t\t\tvec[p].pb(mp(-cnt,1));\n\t\t}\n\t\ttmp=b[i];\n\t\twhile(tmp!=1){\n\t\t\tint p=mnp[tmp],cnt=0;\n\t\t\twhile(tmp%p==0)tmp/=p,cnt++;\n\t\t\tvec[p].pb(mp(cnt,2));\n\t\t}\n\t}\n\tfor(int i=1;i<=prcnt;i++){\n\t\tint mx=0,cur=0;\n\t\tfor(pii p:vec[pr[i]]){\n\t\t\tif(p.se==1)cur+=p.fi,chkmax(mx,-cur);\n\t\t\telse chkmax(mx,p.fi-cur);\n\t\t}\n\t\tprd=1ll*prd*qpow(pr[i],mx)%MOD;\n\t}\n\tint sum=prd;\n\tfor(int i=1;i<=lim;i++){\n\t\tprd=1ll*prd*qpow(a[i],MOD-2)%MOD*b[i]%MOD;\n\t\tsum=(sum+prd)%MOD;\n\t}printf(\"%d\\n\",2*sum%MOD);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1682771062,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1815E Bosco and Particle"
    },
    {
        "content": "\u82e5\u4e00\u4e2a\u5b57\u7b26\u4e32\u53ef\u4ee5\u8868\u793a\u4e3a\u53e6\u4e00\u4e2a\u5b57\u7b26\u4e32\u91cd\u590d\u82e5\u5e72\u6b21\uff0c\u663e\u7136\u53ef\u4ee5\u5c06\u5b83\u66ff\u6362\u4e3a\u540e\u8005\u3002\u8fd9\u53ef\u4ee5\u901a\u8fc7 kmp \u5b9e\u73b0\u3002\n\n\u5bf9 $i=1...n$\uff0c\u8003\u8651 $n'=1$\uff0c\u4e14\u552f\u4e00\u7684\u4e32 $s'_1=s_i$ \u65f6\u7684\u95ee\u9898\u3002\u53ef\u4ee5\u6a21\u62df\u5f97\u51fa\uff0c\u8fd9\u4e2a\u65b0\u95ee\u9898\u7684\u4e00\u4e2a\u5468\u671f\u4e2d\uff0c$0\\sim1$ \u88ab\u8d70\u4e86\u51e0\u6b21\uff08\u6ce8\u610f $0\\rightarrow 1$ \u548c $1\\rightarrow 0$ \u6b21\u6570\u76f8\u540c\uff09\uff0c $1\\sim 2$ \u88ab\u8d70\u4e86\u51e0\u6b21\uff0c\u5206\u522b\u8bbe\u4e3a $a_i,b_i$\u3002\n\n\u56de\u5230\u539f\u95ee\u9898\uff0c\u8bbe\u4e00\u4e2a\u5468\u671f\u5185 $t\\sim t+1$ \u88ab\u8d70\u4e86 $f_t$ \u6b21\u3002\u90a3\u4e48\u5fc5\u7136\u6709 $\\frac{f_{t-1}}{f_t}=\\frac{a_t}{b_t}$\u3002\u8fd9\u662f\u5fc5\u8981\u6761\u4ef6\uff0c\u4e5f\u662f\u5145\u8981\u6761\u4ef6\u3002\u5373\u5bf9\u6ee1\u8db3\u6761\u4ef6\u7684\u6700\u5c0f\u975e\u8d1f\u6574\u6570\u89e3 $(f_0...f_n)$ \u6709 $ans=2(f_0+...+f_n)$\uff0c\u5176\u4e2d $ans$ \u662f\u539f\u95ee\u9898\u7684\u7b54\u6848\u3002\n\n\u5c06 $f_0$ \u8bbe\u4e3a\u4e3b\u5143\uff0c\u5219 $f_i = \\frac{b_1...b_i}{a_1...a_i}f_0$\u3002\u7531\u4e8e\u9700\u8981\u6ee1\u8db3\u6bcf\u4e2a $f_i$ \u90fd\u662f\u6574\u6570\uff0c\u56e0\u6b64\u5bf9\u4e8e\u6bcf\u4e2a\u8d28\u56e0\u5b50 $p$\uff0c$V_p(f_0)=\\max\\limits_{i=1}^n( -V_p(\\frac{b_1...b_i}{a_1...a_i}))$\u3002\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u52a8\u6001\u7ef4\u62a4 $\\frac{b_1...b_i}{a_1...a_i}$ \u7684\u8d28\u56e0\u6570\u5206\u89e3\u5f62\u5f0f\uff0c\u6c42\u51fa $f_0$\u3002",
        "postTime": 1681097757,
        "uid": 46817,
        "name": "xcyle",
        "ccfLevel": 10,
        "title": "CF1815E \u9898\u89e3"
    },
    {
        "content": "## \u9898\u610f\n\n\u6709\u4e2a\u7c92\u5b50\u521d\u59cb\u5728 $0$ \u4f4d\u7f6e\uff0c$1\\cdots n$ \u4f4d\u7f6e\u5206\u522b\u4e3a\u6709\u4e00\u4e2a\u5bf9\u649e\u5668\uff0c\u5982\u679c\u5728 $0$ \u4f4d\u7f6e\u5219\u5411\u53f3\uff0c\u5982\u679c\u5728 $n + 1$ \u4f4d\u7f6e\u5219\u5411\u5de6\u3002\u6bcf\u4e2a\u5bf9\u649e\u5668\u6709\u4e00\u4e2a $01$ \u4e32\uff0c\u521d\u59cb\u6240\u6709\u5bf9\u649e\u5668\u7684\u6307\u9488\u90fd\u5728\u5f00\u5934\uff0c\u5f53\u7c92\u5b50\u8d70\u5230 $i$ \u4f4d\u7f6e\u65f6\uff0c\u5bf9\u649e\u5668\u6240\u6307\u7684\u503c\u4e3a $0$ \u5219\u4e0d\u6539\u53d8\u65b9\u5411\uff0c\u5426\u5219\u53cd\u5411\uff0c\u6307\u9488\u6307\u5411\u4e0b\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u5982\u679c\u5728\u4e32\u7684\u672b\u5c3e\u5219\u6307\u5411\u5f00\u5934\u3002\u6c42\u6700\u5c0f\u7684\u5468\u671f\u957f\u5ea6 $c$ \u6ee1\u8db3\u4efb\u610f $t$ \u65f6\u95f4\u548c $t + c$ \u65f6\u95f4\u7c92\u5b50\u5728\u540c\u4e00\u4f4d\u7f6e\u3002\n\n$1\\le n \\le 10^6, \\sum |s_i|\\le 10^6$\u3002\n\n## \u601d\u8def\n\n\u9996\u5148\u53ef\u4ee5\u53d1\u73b0\u6bcf\u4e2a\u4e32\u90fd\u53ef\u4ee5\u7528\u5b83\u7684\u6700\u5c0f\u5faa\u73af\u8282\u66ff\u4ee3\uff0c\u4f7f\u7528 Z \u51fd\u6570\u89e3\u51b3\u3002\n\n\u53d1\u73b0\u539f\u9898\u610f\u8f6c\u6362\u6210\u6c42\u6700\u5c0f\u7684\u65f6\u95f4\u8d70\u56de\u5230 $0$ \u5e76\u4e14\u6240\u6709\u4e32\u7684\u6307\u9488\u90fd\u6307\u5411 $0$\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i$ \u8003\u8651 $n = 1$ \u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u66b4\u529b\u6a21\u62df\u51fa $0\\to 1$ \u548c $1\\to 2$ \u7684\u6b21\u6570\uff0c\u8bb0\u4e3a $a_i, b_i$\u3002\u8bb0 $f_i$ \u8868\u793a\u539f\u56fe\u4e0a $i\\to i + 1$ \u7684\u6b21\u6570\uff0c\u53ef\u4ee5\u53d1\u73b0 $f_{i - 1} = k_i a_i, f_i = k_ib_i$\uff0c\u8be5\u5f62\u5f0f\u7b49\u4ef7\u4e8e $b_i | f_{i} \\land a_i f_i = b_if_{i - 1}$\uff08\u6ce8\u610f\u5230 corner case \u4e3a\u5f53\u524d\u5b57\u7b26\u4e32\u4e3a $1$\uff0c\u8d70\u4e0d\u5230\u53f3\u8fb9\uff09\u3002\n\n\u4ee5 $f_0$ \u4e3a\u672a\u77e5\u6570\uff0c$f_i = \\prod_{j = 1}^i\\frac{b_i}{a_i}f_0$\uff0c\u5206\u89e3\u8d28\u56e0\u6570\u4ece\u5de6\u5f80\u53f3\u626b\u8d2a\u5fc3\u6c42\u6700\u5c0f\u5373\u53ef\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, alpha, iee) for(auto gs##i = (iee), i = (alpha); i <= gs##i; ++i)\n#define per(i, alpha, iee) for(auto gs##i = (iee), i = (alpha); i >= gs##i; --i)\n#define let const auto\n#define debug(...) fprintf(stderr, __VA_ARGS__)\nusing i64 = long long;\n\nconstexpr int mod = 998244353;\nint qp(int a, int b = mod - 2){\n    int res = 1;\n    while(b){\n        if(b & 1) res = 1ll * res * a % mod;\n        a = 1ll * a * a % mod;\n        b >>= 1;\n    }\n    return res;\n}\n\nstruct Primes{\n    int m;\n    std::vector<int> v, p;\n    void init(int n){\n        m = 0;\n        v.assign(n + 1, 0), p.assign(n + 1, 0);\n        rep(i, 2, n){\n            if(!v[i]) v[i] = i, p[++m] = i;\n            for(int j = 1; j <= m && 1ll * p[j] * i <= n; ++j){\n                v[p[j] * i] = p[j];\n                if(i % p[j] == 0) break;\n            }\n        }\n    }\n};\n\nvoid doit(std::string &s){\n    int n = s.size();\n    std::vector<int> z(n);\n    z[0] = n;\n    int l = 0, r = 0;\n    rep(i, 1, n - 1){\n        if(i <= r && z[i - l] < r - i + 1) z[i] = z[i - l];\n        else{\n            z[i] = std::max(0, r - i + 1);\n            while(i + z[i] < n && s[i + z[i]] == s[z[i]]) z[i]++;\n            if(i + z[i] - 1 > r){\n                l = i, r = i + z[i] - 1;\n            }\n        }   \n    }\n    rep(i, 1, n - 1){\n        if(z[i] == n - i && (n - i) * 2 >= n && n % i == 0){\n            s = s.substr(0, i);\n            return;\n        }\n    }\n}\n\nint main(){\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr);\n\n    int n;\n    std::cin >> n;\n\n    std::vector<int> a(n + 1), b(n + 1);\n    auto work = [&](int id, std::string &s){\n        int cur = 0, pos = 0, dir = 1, m = s.size();\n        do{\n            if(pos == 0 && dir == 1) a[id]++;\n            if(pos == 2 && dir == 0) b[id]++;\n            pos += !dir ? -1 : 1;\n            if(pos == 1){\n                if(s[cur] == '1') dir ^= 1;\n                (++cur) %= m;\n            }\n            if(pos == 0) dir = 1;\n            if(pos == 2) dir = 0;\n        } while(cur != 0 || pos != 0);\n    };\n\n    rep(i, 1, n){\n        std::string s;\n        std::cin >> s;\n        doit(s);\n        work(i, s);\n    }\n\n\n    static Primes P;\n    P.init(2e6);\n\n    int f0 = 1;\n    std::vector<int> tt(2e6 + 5);\n    rep(i, 1, n){\n        int x = a[i];\n        while(x != 1){\n            int v = P.v[x];\n            x /= v;\n            if(!tt[v]) f0 = 1ll * f0 * v % mod;\n            else tt[v]--;\n        }\n        x = b[i];\n        if(!x) break;\n        while(x != 1){\n            int v = P.v[x];\n            x /= v;\n            tt[v]++;\n        }\n    }\n    int ans = 0;\n    rep(i, 0, n){\n        (ans += f0) %= mod;\n        if(i != n){\n            if(!b[i + 1]) break;\n            f0 = 1ll * f0 * b[i + 1] % mod * qp(a[i + 1]) % mod;\n        }\n    }\n    std::cout << (ans * 2ll % mod) << \"\\n\";\n\n    return 0;\n}\n/*\ng++ -o a a.cpp -std=c++14 -O2\n*/\n```",
        "postTime": 1681988821,
        "uid": 86576,
        "name": "zlxFTH",
        "ccfLevel": 7,
        "title": "CF1815E"
    }
]
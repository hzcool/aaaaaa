[
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://blog.aor.sd.cn/archives/1416/)\n\n\u53d1\u73b0\u4e00\u4e2a\u7ed3\u8bba\uff1a\u5bf9\u4e8e\u4efb\u4f55\u4e00\u5bf9 $x_1y_1 = x_2y_2(x_1 < x_2)$\uff0c\u90fd\u5b58\u5728\u4e00\u5bf9\u6b63\u6574\u6570 $a < b$\uff0c\u6ee1\u8db3 $x_2 = \\frac{x_1}{a}b,y_2 = \\frac{y_1}{b}a$\u3002\n\n\u8bc1\u660e\uff1a\u8bbe $g=\\gcd(x_1,x_2)$\uff0c\u6211\u4eec\u6784\u9020 $a=\\frac{x_1}{g},b = \\frac{x_2}{g}$\uff0c\u4e0d\u96be\u53d1\u73b0 $\\frac{x_1}{a}b = x_2$\uff0c\u63a5\u4e0b\u6765\u53ea\u9700\u8981\u8bc1\u660e $b|y_1$\u5373\u53ef\u3002\u6ce8\u610f\u5230 $b=\\frac{x_2}{g} | \\frac{x_2y_2}{g} = \\frac{x_1y_1}{g}$\uff0c\u53c8\u56e0\u4e3a\u6709 $(b,\\frac{x_1}{g}) = 1$\uff0c\u6240\u4ee5\u5f97\u5230 $b|y_1$\u3002\n\n\n\u56e0\u4e3a $a|x_1,b|y_1$\uff0c\u6240\u4ee5\u6709\u6548\u7684 $(a,x_1)$ \u53ea\u6709 $O(n \\log n)$ \u5bf9\u3002\n\n\u73b0\u5728\u6211\u4eec\u53bb\u56fa\u5b9a $x_1$\uff0c\u8003\u8651 $y_1$ \u7684\u79cd\u79cd\u9650\u5236\uff1a\u9996\u5148\u8981\u4fdd\u8bc1 $y_1 \\leq m$\uff0c\u5176\u6b21\u8fd8\u8981\u4fdd\u8bc1 $\\lceil \\frac{L}{x_1}\\rceil  \\leq y_1 \\leq \\lfloor \\frac{R}{x_1} \\rfloor$\u3002\n\n\u6211\u4eec\u8003\u8651\u679a\u4e3e\u4e00\u5bf9 $(a,x_1)$\uff0c\u73b0\u5728\u76f8\u5f53\u4e8e\u8981\u6c42\u5feb\u901f\u8be2\u95ee\u662f\u5426\u5b58\u5728\u4e00\u5bf9 $(b,y_1)$ \u6ee1\u8db3\u5982\u4e0b\u6761\u4ef6\uff1a\n$$\n\\begin{aligned}\ny_1 \\leq m\\\\\n\\lceil \\frac{L}{x_1}\\rceil  \\leq y_1 \\leq \\lfloor \\frac{R}{x_1} \\rfloor\\\\\n\\frac{x_1}{a}b \\leq n\\\\\na < b\n\\end{aligned}\n$$\n\u663e\u7136\u6211\u4eec\u4f1a\u8d2a\u5fc3\u9009\u62e9\u80fd\u9009\u62e9\u7684 $b$ \u4e2d\u6700\u5c0f\u7684\u53bb\u5224\u65ad\u7b2c\u4e09\u4e2a\u9650\u5236\u662f\u5426\u6210\u7acb\u3002\n\n\u7b2c\u4e00\u4e2a\u548c\u7b2c\u4e8c\u4e2a\u9650\u5236\u53ef\u4ee5\u901a\u8fc7\u4ece\u5c0f\u5230\u5927\u679a\u4e3e $x$ \u53cc\u6307\u9488\u89e3\u51b3\uff0c\u7b2c\u56db\u4e2a\u9650\u5236\u53ef\u4ee5\u7ef4\u62a4\u5f53\u524d\u6240\u6709\u53ef\u9009\u503c\u7684 set \u89e3\u51b3\uff0c\u590d\u6742\u5ea6 $O(n \\log^2 n)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\n\n#define fi first\n#define se second\n#define db double\n#define U unsigned\n#define P std::pair<int,int>\n#define LL long long\n#define pb push_back\n#define MP std::make_pair\n#define all(x) x.begin(),x.end()\n#define CLR(i,a) memset(i,a,sizeof(i))\n#define FOR(i,a,b) for(int i = a;i <= b;++i)\n#define ROF(i,a,b) for(int i = a;i >= b;--i)\n#define DEBUG(x) std::cerr << #x << '=' << x << std::endl\n\nconst int MAXN = 2e5 + 5;\nstd::vector<int> G[MAXN];\n\ninline void prework(){\n\tFOR(i,1,200000) for(int j = i;j <= 200000;j += i) G[j].pb(i);\n}\n\nLL L,R;\nint n,m;\nstd::set<P> S;\n\nint main(){\n\tprework();\n\tscanf(\"%d%d%lld%lld\",&n,&m,&L,&R);\n\tint nowl=m+1,nowr=m;\n\tFOR(x,1,n){\n\t\tLL l=L/x,r=R/x;\n\t\tif(1ll*x*l < L) ++l;\n\t\tr = std::min(r,(LL)m);\n\t\tif(l > r){\n\t\t\tputs(\"-1\");\n\t\t\tcontinue;\n\t\t}\n\t\twhile(l < nowl){\n\t\t\tnowl--;\n\t\t\tfor(auto x:G[nowl]) S.insert(MP(x,nowl));\n\t\t}\n\t\twhile(nowr > r){\n\t\t\tfor(auto x:G[nowr]) S.erase(MP(x,nowr));\n\t\t\tnowr--;\n\t\t}\n\t\tbool flag = 0;\n\t\tfor(auto a:G[x]){\n\t\t\tauto it = S.upper_bound(MP(a,1e9));\n\t\t\tif(it == S.end()) break;\n\t\t\tint b = it->fi,y = it->se;\n\t\t\tif(1ll*(x/a)*b <= n){\n\t\t\t\tflag = 1;\n\t\t\t\tprintf(\"%d %d %d %d\\n\",x,y,x/a*b,y/b*a);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(!flag){\n\t\t\tputs(\"-1\");\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1600300407,
        "uid": 50075,
        "name": "RainAir",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1418F \u3010Equal Product\u3011"
    },
    {
        "content": "\u672c\u9898\u521d\u770b\u597d\u50cf\u4e24\u5bf9 $(x,y)$ \u4e2d\u9664\u4e86\u4e58\u79ef\u76f8\u7b49\u4e4b\u5916\u597d\u50cf\u5e76\u65e0\u5176\u4ed6\u8054\u7cfb\uff0c\u90a3\u4e48\u5982\u679c\u679a\u4e3e\u4e58\u79ef\u7684\u8bdd\u590d\u6742\u5ea6\u5c06\u5728 $n^3$ \u5de6\u53f3\uff0c\u662f\u6211\u4eec\u65e0\u6cd5\u63a5\u53d7\u7684\uff0c\u90a3\u6211\u4eec\u63a5\u4e0b\u6765\u8003\u8651\u6784\u9020\uff0c\u5c06\u5176\u8054\u7cfb\u8d77\u6765\u3002\n\n\u9996\u5148\u6211\u4eec\u6784\u9020\u4e24\u4e2a\u6570 $a$ \u548c $b$ \uff0c$a<b$ ,\u90a3\u4e48\u4e00\u5b9a\u5b58\u5728\u8fd9\u4e00\u5bf9\u6570\u4f7f\u5f97 $x_2=\\frac{x_1}{a}b $ \uff0c $y_2=\\frac{y_1}{b}a$ \u5e76\u4e14 $b\\mid y_1$ , $a \\mid x_1$ \u3002\u90a3\u4e48\u5982\u4f55\u8bc1\u660e\u5462\uff0c\u4ee4 $a=\\frac{x_1}{g}$ \uff0c$b= \\frac{x_2}{g}$ \uff0c\u90a3\u4e48\u7531\u5b9a\u4e49\u53ef\u5f97 $a \\mid x_1$ \u6210\u7acb\u3002\u56e0\u4e3a\u7531\u5b9a\u4e49\u53ef\u5f97 $b \\mid \\frac{x_2y_2}{g}$ \u4e14 $x_1y_1=x_2y_2$ \uff0c\u6545 $b \\mid \\frac{x_1y_1}{g}$ \uff0c\u53c8\u56e0\u4e3a $b$ \u4e0e $\\frac{x_1}{g}$ \u4e92\u8d28\uff0c\u5219\u6709 $b \\mid y_1$  \u6210\u7acb\u3002\n\n\u4e8e\u662f\u63a5\u4e0b\u6765\u6211\u4eec\u53ea\u9700\u8003\u8651\u6570\u5bf9 $(a,x_1)$ \u5373\u53ef\uff0c\u5b83\u53ea\u6709 $n\\log n$ \u5bf9\u5408\u6cd5\u6570\u5bf9\uff0c\u5373\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $x_1$ \u6211\u4eec\u53ea\u9700\u8981\u8003\u8651\u5b83\u7684\u7ea6\u6570\uff08\u6ce8\u610f\u8981\u5148\u679a\u4e3e\u7ea6\u6570\u8fdb\u884c\u9884\u5904\u7406\u5426\u5219\u590d\u6742\u5ea6\u5c31\u5047\u4e86\uff0c\u4f1a\u53d8\u6210\u6839\u53f7)\u3002\n\n\u7136\u540e\u6211\u4eec\u518d\u6765\u770b\u6570\u5bf9 $(b,y_1)$ \uff0c\u8be5\u6570\u5bf9\u7684\u9650\u5236\u6709\u56db\u4e2a\uff1a\n\n1.  $a < b$\n2.  $\\left\\lceil\\frac{L}{x_1}\\right\\rceil\\le y_1\\le\\left\\lfloor\\frac{R}{x_1}\\right\\rfloor$\n3.  $y_1\\le m$\n4.  $\\frac{x_1}{a}b\\le n$\n\n\u9996\u5148\u4e3a\u4e86\u6ee1\u8db3\u9650\u5236\u4e00\u548c\u56db\uff0c\u6211\u4eec\u53ea\u9700\u8d2a\u5fc3\u7684\u9009\u51fa\u5927\u4e8e $a$ \u7684\u6700\u5c0f\u7684 $b$ \u5373\u53ef\u3002\u5176\u6b21\uff0c\u6211\u4eec\u53d1\u73b0\u968f\u7740 $x_1$ \u7684\u589e\u5927\uff0c $y_1$ \u7684\u8303\u56f4\u662f\u4e00\u76f4\u7f29\u5c0f\u4e0d\u6269\u5927\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u53cc\u6307\u9488\u52a0 $set$ \u7ef4\u62a4 $y_1$ \u5408\u6cd5\u7684\u533a\u95f4\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $a$ \u76f4\u63a5\u67e5\u8be2\u5176\u540e\u7ee7\u5373\u53ef\u3002\u8fd9\u91cc\u9700\u8981\u6ce8\u610f\u4e00\u4e0b\uff0c\u5982\u679c\u4f60\u5f80 $set$ \u91cc\u88c5\u7684\u662f\u6570\u5bf9\u7684\u8bdd\u4f1a\u88ab\u6700\u540e\u4e00\u4e2a\u70b9\u5361\u6389\uff0c\u56e0\u4e3a\u6211\u4eec\u53ea\u9700\u8981\u4e00\u4e2a\u5408\u6cd5\u89e3\uff0c\u800c\u5bf9\u4e8e\u4e00\u4e2a\u76f8\u540c\u7684 $b$ \u4f1a\u6709\u591a\u4e2a\u76f8\u5bf9\u5e94\u7684 $y_1$ \uff0c\u5bfc\u81f4\u540c\u4e00\u4e2a $b$ \u4f1a\u51fa\u5165\u591a\u8fb9\uff0c\u4f46\u5176\u5b9e\u6211\u4eec\u53ea\u9700\u8981\u7528 $set$ \u7ef4\u62a4\u4e00\u4e0b\u5408\u6cd5\u7684 $b$ \uff0c\u7528\u5b83\u5728 $y_1$  \u7684\u5408\u6cd5\u8303\u56f4\u5185\u7b97\u51fa\u4e00\u4e2a\u5408\u6cd5\u89e3\u5c31\u884c\uff08\u8fd9\u91cc\u6211\u89c9\u5f97\u7528\u5230\u4e86\u4e00\u70b9\u70b9\u83ab\u961f\u7684\u601d\u60f3\uff09\uff0c\u590d\u6742\u5ea6 $O(n \\log^2n)$ \u3002\n\n```\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int N=2e5+5;\nint n,m,L,R;\nvector<int>g[N];\nset<int>s;\nint num[N];\ninline void pre(){\n    for(register int i=1;i<=200000;i++){\n        for(register int j=i;j<=200000;j+=i){\n            g[j].push_back(i);\n        }\n    }\n}\nsigned main(){\n    pre();\n    scanf(\"%lld%lld%lld%lld\",&n,&m,&L,&R);\n    int nl=m+1,nr=m;\n    for(register int x=1;x<=n;x++){\n        int l=(L+x-1)/x,r=R/x;\n        r=min(r,m);\n        if(l>r){\n            puts(\"-1\");\n            continue;\n        }\n        while(nl>l){\n            nl--;\n            for(auto v:g[nl]){\n                if(!num[v])s.insert(v);\n                num[v]++;\n            }\n        }\n        while(nr>r){\n            for(auto v:g[nr]){\n                --num[v];\n                if(!num[v])s.erase(v);\n            }\n            nr--;\n        }\n        bool f=1;\n        for(auto a:g[x]){\n            auto t=s.upper_bound(a);\n            if(t==s.end())break;\n            int b=*t;\n            if(x/a*b>n)continue;\n            int y=r/b*b;\n            printf(\"%lld %lld %lld %lld\\n\",x,y,x/a*b,y/b*a);\n            f=0;\n            break;\n        }\n        if(f){\n            puts(\"-1\");\n        }\n    }\n    return 0;\n}\n```\n\n",
        "postTime": 1657459540,
        "uid": 574890,
        "name": "zfy2006",
        "ccfLevel": 0,
        "title": "CF1418F Equal Product"
    }
]
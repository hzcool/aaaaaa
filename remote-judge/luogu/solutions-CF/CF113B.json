[
    {
        "content": "\u4e4b\u524d\u6a21\u62df\u8d5b\u7684\u9898\uff0c\u8d5b\u4e0a\u5199\u4e86\u4e00\u4e2a\u53c8\u81ed\u53c8\u957f\u7684\u4ee3\u7801\u88ab hack \u5230 $90$ \u5206\uff0c\u4eca\u5929\u627e\u51fa\u9519\u6765\u4e86\uff0c\u4e8e\u662f\u53d1\u7bc7\u9898\u89e3\u8b66\u793a\u540e\u4eba\u3002\n\n---\n\n\u601d\u8def\u4e5f\u662f\u54c8\u5e0c+\u53bb\u91cd\uff0c\u56e0\u4e3a $n$ \u7684\u8303\u56f4\u975e\u5e38\u5c0f\u6240\u4ee5\u5728\u539f\u4e32\u4e2d\u5339\u914d\u524d\u7f00\u6216\u540e\u7f00\uff0c\u8fde kmp \u90fd\u4e0d\u7528\u3002\u627e\u51fa\u6240\u6709\u5728\u539f\u5e8f\u5217\u4e2d\u5b58\u5728\u7684\u524d\u7f00\u5f00\u5934\u548c\u540e\u7f00\u7ed3\u5c3e\uff0c\u7136\u540e\u4e24\u7ec4\u7684\u6307\u9488\u8fdb\u884c\u66b4\u529b\u5339\u914d\uff0c\u518d\u53bb\u91cd\u5373\u53ef\u3002\n\n\u54c8\u5e0c\u6570\u5f53\u7136\u53ef\u4ee5\u7528 $O(n)$ \u9884\u5904\u7406\uff0c\u6211\u8d5b\u573a\u4e0a\u6253\u7684\u5c31\u662f\u8fd9\u79cd\uff0c\u50cf\u8fd9\u6837\uff1a\n\n```cpp\nfor(int i=1;i<=n;i++)\n\tsum[i]=(sum[i-1]*p+s[i]-'a'+1)%MOD;\npm[0]=inv[0]=1;ll invp=ksm(p,MOD-2);\nfor(int i=1;i<=n;i++)\n\tpm[i]=pm[i-1]*p%MOD,inv[i]=inv[i-1]*invp%MOD;\n```\n\n\u7136\u540e\u67e5\u8be2\u7684\u65f6\u5019\u5c31\n\n```cpp\ninline ll getnum(int l,int r){return (sum[r]-sum[l-1]+MOD)*inv[l-1]%MOD;}\n```\n\n~~\u4f46\u662f\u8fd9\u6837\u5199\u53ef\u80fd\u5bb9\u6613\u51fa\u9519~~ \u9519\u8bef\u7684\uff0c\u56e0\u4e3a\u6211\u592a\u83dc\u4e86\u3002\u6240\u4ee5\u540e\u6765\u6539\u7684\u65f6\u5019\u5c31\u7528 $n^2$ \u7684\u533a\u95f4 dp \u9884\u5904\u7406\uff0c$dp[i][j]$ \u8868\u793a\u539f\u5b57\u7b26\u4e32\u4e2d $i\\sim j$ \u7684\u54c8\u5e0c\u503c\uff0c\u90a3\u4e48\u6709\u8f6c\u79fb\u5f0f $dp[i][j]=dp[i][j-1]\\times p+\\operatorname{hash}(s[i])$\u3002\n\n\u8fd9\u6837\u5c31\u4e0d\u9700\u8981\u9006\u5143\uff0c\u4e8e\u662f\u53ef\u76f4\u63a5\u7528 unsigned long long \u81ea\u7136\u6ea2\u51fa\u3002\n\n\u8fd8\u6709\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6bd4\u5982\u6240\u6c42\u524d\u7f00\u4e3a `bxsto` \u540e\u7f00\u4e3a `orzbx`\uff0c\u90a3\u4e48\u82e5\u539f\u5e8f\u5217\u4e2d\u6709\u4e00\u4e2a `orzbxsto` \u7684\u5b50\u4e32\uff0c\u524d\u7f00\u7684\u6570\u7ec4\u4e2d\u5bf9\u5e94\u7684 $l$ \u6307\u5411\u7684\u662f `b` \u7684\u4f4d\u7f6e\uff0c\u540e\u7f00\u7684\u6570\u7ec4\u4e2d\u5bf9\u5e94\u7684 $r$ \u6307\u5411\u7684\u662f `x` \u7684\u4f4d\u7f6e\uff0c\u90a3\u4e48 \u6b64\u65f6 $l<r$ \u770b\u8d77\u6765\u662f\u4e00\u4e2a\u5408\u6cd5\u7684\u533a\u95f4\uff0c\u4f46\u5b9e\u5219\u4e0d\u7136\uff0c\u56e0\u4e3a $l\\sim r$ \u4e3a `bx`\uff0c\u5e76\u4e0d\u4ee5 `bxsto` \u5f00\u5934\u6216\u4ee5 `orzbx` \u7ed3\u5c3e\u3002\u6240\u4ee5\u5bf9\u4e8e\u6240\u6709\u7684 $(l,r)$\uff0c\u5224\u65ad\u5408\u6cd5\u65f6\u4e0d\u662f $l\\le r$ \u800c\u662f $r-l+1$ \u5927\u4e8e\u524d\u7f00\u957f\u5ea6\u548c\u540e\u7f00\u957f\u5ea6\u7684\u6700\u5927\u503c\u3002\n\n\u56e0\u4e3a\u8fd9\u4e2a\u60f3\u5f53\u7136\uff0c\u5728\u8d5b\u4e0a\u88ab\u5361\u4e86\u3002\u3002\n\n```cpp\n#include<algorithm>\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\n\ntypedef unsigned long long ull;\nconst int MAXN=2e3+5,p=31;\nint n,prel,sufl,l[MAXN],r[MAXN];ull num[MAXN][MAXN],ans[MAXN*MAXN];\nchar s[MAXN],pre[MAXN],suf[MAXN];\n\nbool checkp(int l,int r){\t// \u66b4\u529b\u5339\u914d\u524d\u7f00\n\tfor(int i=l,j=1;i<=r;i++,j++)\n\t\tif(s[i]!=pre[j])return false;\n\treturn true;\n}\nbool checks(int l,int r){\t// \u66b4\u529b\u5339\u914d\u540e\u7f00\n\tfor(int i=l,j=1;i<=r;i++,j++)\n\t\tif(s[i]!=suf[j])return false;\n\treturn true;\n}\nint main(){\n\tscanf(\"%s\",s+1);n=strlen(s+1);\n\tscanf(\"%s\",pre+1);prel=strlen(pre+1);\n\tscanf(\"%s\",suf+1);sufl=strlen(suf+1);\n\tfor(int i=1;i<=n;i++)num[i][i]=s[i]-'a'+1;\n\tfor(int l=2;l<=n;l++)\t// \u533a\u95f4 dp \u8ba1\u7b97\u5904\u7406\u533a\u95f4\u54c8\u5e0c\u503c\n\t\tfor(int i=1,j=l;j<=n;i++,j++)\n\t\t\tnum[i][j]=num[i][j-1]*p+s[j]-'a'+1;\n\tint totp=0,tots=0,tot=0;\n\tfor(int i=1,j=prel;j<=n;i++,j++)if(checkp(i,j))l[++totp]=i;\n\tfor(int i=1,j=sufl;j<=n;i++,j++)if(checks(i,j))r[++tots]=j;\n\tint lim=max(prel,sufl);\t// \u957f\u5ea6\u9650\u5236\n\tfor(int i=1;i<=totp;i++)\n\t\tfor(int j=1;j<=tots;j++)\n\t\t\tif(r[j]-l[i]+1>=lim)ans[++tot]=num[l[i]][r[j]];\n\tsort(ans+1,ans+tot+1);\t// \u6392\u5e8f\u3001\u53bb\u91cd\n\tint m=unique(ans+1,ans+tot+1)-ans-1;\n\tprintf(\"%d\\n\",m);\n\treturn 0;\n}\n```",
        "postTime": 1673876613,
        "uid": 350297,
        "name": "_maojun_",
        "ccfLevel": 6,
        "title": "CF113B \u9898\u89e3"
    },
    {
        "content": "\u7ed9\u5b9a\u5b57\u7b26\u4e32 $s$\uff0c\u95ee\u8be5\u5b57\u7b26\u4e32\u4ee5 $x$ \u5f00\u5934\uff0c$y$ \u7ed3\u5c3e\u7684\u8fde\u7eed\u5b50\u4e32\u6709\u591a\u5c11\u4e2a\u3002  \n\u53ef\u4ee5\u901a\u8fc7\u679a\u4e3e $x$ \u548c $y$ \u7684\u4e2d\u95f4\u90e8\u5206\u5e76\u7528\u5b57\u7b26\u4e32\u54c8\u5e0c\u5224\u65ad\u5de6\u53f3\u662f\u5426\u5206\u522b\u4e3a $x$ \u548c $y$ \u6765\u679a\u4e3e\u8fd9\u6837\u7684\u5b50\u4e32\uff0c\u7136\u540e\u4f7f\u7528 `std::set` \u5bf9\u8fd9\u6837\u5b50\u4e32\u7684\u54c8\u5e0c\u503c\u53bb\u91cd\u3002  \n\n```cpp\nint main() {\n    dR(std::string, s, x, y);\n    RollingHash h;\n    auto S = h.build(s), X = h.build(x), Y = h.build(y);\n    auto hx = h.query(X), hy = h.query(Y);\n    gp<u64, bool> a;\n    for (int r = 0; r <= len(s); r++)\n        for (int l = 0; l < r; l++)\n            if (r - l >= len(x) && r - l >= len(y))\n                if (h.query(S, l, l + len(x)) == hx && h.query(S, r - len(y), r) == hy)\n                    a[h.query(S, l, r)] = true;\n    writeln(len(a));\n    return 0;\n}\n```",
        "postTime": 1679117515,
        "uid": 84282,
        "name": "andyli",
        "ccfLevel": 7,
        "title": "CF113B Petr# \u9898\u89e3"
    },
    {
        "content": "## \u601d\u8def\n\u7528\u54c8\u5e0c\u503c\u5feb\u901f\u5224\u65ad\u51fa\u6240\u6709\u7684\u524d\u540e\u7f00\u7684\u8d77\u59cb\u4f4d\u7f6e\uff0c\u5206\u522b\u5b58\u5165 $t1$ \u6570\u7ec4\u548c $t2$ \u6570\u7ec4\uff0c\u7136\u540e\u679a\u4e3e\u4e24\u4e2a\u6570\u7ec4\uff0c\u5728\u786e\u4fdd\u524d\u7f00\u7684\u7ed3\u5c3e\u5728\u540e\u7f00\u7684\u7ed3\u5c3e\u4e4b\u524d\u65f6\u5c06\u6574\u4e2a\u5b57\u4e32\u7684\u54c8\u5e0c\u503c\u5b58\u5165 $ans$ \u6570\u7ec4\u4e2d\uff0c\u7136\u540e\u6392\u5e8f\uff0c\u524d\u540e\u7f00\u4e0d\u77db\u76fe\u65f6\u5c31 ``ans++``\u3002\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n#define int unsigned long long\nusing namespace std;\nchar s[4005],s1[4005],s2[4005];\nint db[4005],ha[4005],ans;\nvector<int> t1,t2;\nint ans1[4000005],top;\nsigned main()\n{\n\tscanf(\"%s%s%s\",(s+1),(s1+1),(s2+1));\n\tint l=strlen(s+1),l1=strlen(s1+1),l2=strlen(s2+1);\n\tdb[0]=1;\n\tfor(int i=1;i<=l;i++) db[i]=db[i-1]*27;\n\tfor(int i=1;i<=l;i++) ha[i]=ha[i-1]*27+s[i]-'a'+1;\n\tint h1=0,h2=0;\n\tfor(int i=1;i<=l1;i++) h1=h1*27+s1[i]-'a'+1;\n\tfor(int i=1;i<=l2;i++) h2=h2*27+s2[i]-'a'+1;\n\tfor(int i=1;i+l1-1<=l;i++)//\u524d\u7f00\u7684\u8d77\u59cb\u4f4d\u7f6e\n\t\tif(h1==ha[i+l1-1]-ha[i-1]*db[l1]) t1.push_back(i);\n\tfor(int i=1;i+l2-1<=l;i++)//\u540e\u7f00\u7684\u8d77\u59cb\u4f4d\u7f6e\n\t\tif(h2==ha[i+l2-1]-ha[i-1]*db[l2]) t2.push_back(i);\n\tfor(int i=0;i<t1.size();i++)\n\t{\n\t\tfor(int j=0;j<t2.size();j++)\n\t\t{\n\t\t\tif(t1[i]>t2[j]||t1[i]+l1-1>t2[j]+l2-1) continue;\n\t\t\tint sum=ha[t2[j]+l2-1]-ha[t1[i]-1]*db[(t2[j]+l2-t1[i])];\n\t\t\tans1[++top]=sum;//\u5b58\u5165hash\u503c\n\t\t}\n\t}\n\tsort(ans1+1,ans1+1+top);\n\tfor(int i=1;i<=top;i++) if(ans1[i]!=ans1[i-1]) ans++;//\u53bb\u91cd\n\tprintf(\"%u\",ans);\n    return 0;\n}\n```",
        "postTime": 1651397706,
        "uid": 406947,
        "name": "Allanljx",
        "ccfLevel": 5,
        "title": "CF113B\u9898\u89e3"
    },
    {
        "content": "### \u524d\u8a00\n\n\u5e94\u8be5\u7b97\u662f\u8fdc\u53e4\u65f6\u671f\u7684\u4e00\u9053\u9898\u4e86\u5427\uff0c\u4e0d\u8fc7\u611f\u89c9\u633a\u7ecf\u5178\u7684\u3002\n\n\u9898\u610f\u662f\u7ed9\u51fa\u4e09\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u6c42\u4ee5 $a$ \u5f00\u5934 $b$ \u7ed3\u5c3e\u7684\u672c\u8d28\u4e0d\u540c\u7684\u5b57\u7b26\u4e32\u6570\u3002\n\n## \u8bb2\u89e3\n\n\u5b57\u7b26\u4e32\u5339\u914d\u52a0\u4e00\u4e2a\u5b57\u7b26\u4e32\u54c8\u5e0c\u5224\u91cd\u3002\n\n\u5b57\u7b26\u4e32\u54c8\u5e0c\u5c31\u662f\u628a\u5b57\u7b26\u4e32\u8f6c\u6210\u4e00\u4e2a $p$ \u8fdb\u5236\u7684\u6570\uff0c\u6bcf\u4e00\u6bb5\u5b57\u7b26\u4e32\u90fd\u6709\u4e00\u4e2a\u5bf9\u5e94\u7684\u54c8\u5e0c\u503c\u3002 $p$ \u5c3d\u91cf\u53d6\u8d28\u6570\n\n\n###  ACcode:\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ull unsigned long long\nconst int N=2005;\nconst int pr=131;\null power[N],h[N],b,e;\nchar t[N],sb[N],se[N];\nint tx,ty,x[N],y[N],lt,lb,le,ans;\nvoid pre() {\n    power[0]=1;\n    for(int i=1; i<=lt; ++i)\n        power[i]=power[i-1]*pr,h[i]=h[i-1]*pr+t[i]-'a'+1;\n    for(int i=1; i<=lb; ++i)b=b*pr+sb[i]-'a'+1;\n    for(int i=1; i<=le; ++i)e=e*pr+se[i]-'a'+1;\n}\null has(int l,int r) {\n    return h[r]-h[l-1]*power[r-l+1];\n}\nunordered_map<ull,bool>mp;\nint main() {\n    scanf(\"%s%s%s\",t+1,sb+1,se+1);\n    lt=strlen(t+1);\n    lb=strlen(sb+1);\n    le=strlen(se+1);\n    pre();\n    for(int i=1; i<=lt-lb+1; ++i) \n        if(has(i,i+lb-1)==b)x[++tx]=i;\n    for(int i=le; i<=lt; ++i)\n        if(has(i-le+1,i)==e)y[++ty]=i;\n    for(int i=1; i<=tx; ++i)\n        for(int j=1; j<=ty; ++j)\n            if(x[i]<=y[j]&&y[j]-x[i]+1>=max(le,lb))\n            {\n                ull ha=has(x[i],y[j]);\n                if(!mp[ha])++ans,mp[ha]=true;\n            }\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1637331301,
        "uid": 559502,
        "name": "TsH_GD",
        "ccfLevel": 4,
        "title": "CF113B Petr#"
    },
    {
        "content": "# \u5927\u5bb6\u597d\uff0c\u6211\u53eb$ Peter $\n\u8fd9\u9053\u9898\u6211$K$\u4e86\u597d\u4e45\u597d\u4e45\u5c31\u662f\u5c11\u52a0\u4e86\u4e00\u53e5\u8bdd$orz$\\\n\u6211\u662f\u8fd9\u4e48\u505a\u7684$\u2193$\\\n\u5148\u7528\u5b57\u7b26\u4e32$Hash$\u5224\u65ad\u51fa\u4e24\u4e2a\u5b50\u4e32\u7684\u51fa\u73b0\u4f4d\u7f6e\uff0c\u653e\u5728\u4e24\u4e2a\u6570\u7ec4$C,P$\u91cc\\\n\u5728\u66b4\u529b\u679a\u4e3e\u8fd9\u4e24\u4e2a\u6570\u7ec4\u5224\u65ad\u4e00\u4e0b\\\n\u56e0\u4e3a\u8981\u53bb\u91cd\uff0c\u6240\u4ee5\u8981\u628a$Hash$\u503c\u4e22\u5230\u4e00\u4e2a\u6876\u91cc\uff0c\u6392\u5e8f\uff0c\u53bb\u91cd\u5373\u53ef\n## \u6ce8\u610f\n\u6bd4\u5982\u8bf4\u8fd9\u79cd\u6570\u636e\uff1a\n```latex\nabcde\ncde\nabc\n```\n## \u8d3c\u5751\n\u4f60\u7684\u4e24\u4e2a\u6570\u7ec4\u662f\u8fd9\u6837\u7684$C: \\{  3 \\} $ $P:\\{ 3 \\}$ \\\n\u6b64\u65f6\u662f\u5408\u6cd5\u7684\uff0c\u4f46\u662f\u8fd9\u5e76\u4e0d\u7b26\u5408\u8981\u6c42\uff0c\u8fde\u4e0d\u8d77\u6765\\\n\u6240\u4ee5\u8981\u52a0\u4e0a\u8fd9\u6837\u4e00\u53e5\u8bdd\n```cpp\nif(pos[i]<=POS[j]&&POS[j]-pos[i]+1>=max(lenc,lenp))\n```\n\u5176\u4ed6\u90fd\u6ca1\u6709\u95ee\u9898\uff0c\u53ef\u4ee5\u770b\u770b\u8fd9\u4e2a$Hash$[Hash](https://blog.csdn.net/pengwill97/article/details/80879387)\n## \u8d34\u4e0a\u4ee3\u7801\u4e00\u679a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ULL unsigned long long\n#define maxn 5000\n#define base 131\nULL f[maxn],t[maxn];\nchar c[maxn],p[maxn],a[maxn];\nULL C,P;\nint pos[maxn],POS[maxn],Cindy,Peter;\nint lena,lenc,lenp;\nvoid work(ULL&x,char *s)\n{\n\tx=0;\n\tfor(int i=1;i<=strlen(s+1);i++)\n\tx=x*base+s[i]-'a'+1;\n}\nvoid init()\n{\n\tscanf(\"%s\",a+1);\n\tscanf(\"%s\",c+1);\n\tscanf(\"%s\",p+1);\n\tlena=strlen(a+1);\n\tlenc=strlen(c+1);\n\tlenp=strlen(p+1);\n\tt[0]=1;\n\tfor(int i=1;i<=lena;i++)\n\tt[i]=t[i-1]*base,f[i]=f[i-1]*base+a[i]-'a'+1;\n\twork(C,c),work(P,p);\n}\nULL H(int l,int r)\n{\n\treturn f[r]-f[l-1]*t[r-l+1];\n}\nULL Love[maxn*maxn];int tot;\nint main()\n{\n\tinit();\n\tfor(int i=1;i<=lena-lenc+1;i++)\n\tif(H(i,i+lenc-1)==C)pos[++Cindy]=i;\n\tfor(int i=lenp;i<=lena;i++)\n\tif(H(i-lenp+1,i)==P)POS[++Peter]=i;\n\tfor(int i=1;i<=Cindy;i++)\n\tfor(int j=1;j<=Peter;j++)\n\tif(pos[i]<=POS[j]&&POS[j]-pos[i]+1>=max(lenc,lenp))\n\tLove[++tot]=H(pos[i],POS[j]);\n\tsort(Love+1,Love+tot+1);\n\tprintf(\"%d\",unique(Love+1,Love+tot+1)-Love-1);\n}\n```\n###### \u795d$ Cindy $\u5728$ 6 $\u73ed\u8d8a\u6765\u8d8a\u597d",
        "postTime": 1577436581,
        "uid": 100325,
        "name": "peterwuyihong",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF113B \u3010Petr#\u3011"
    }
]
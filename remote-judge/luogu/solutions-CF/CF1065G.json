[
    {
        "content": "[\u6d1b\u8c37\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF1065G)\t[CF\u4f20\u9001\u95e8](http://codeforces.com/problemset/problem/1065/G)\n\n~~\u5f04\u8fd9\u4e2a\u9898\uff0c\u5f04\u4e86\u4e00\u5929\u534a\uff0c\u624d\u5f04\u5b8c\u3002~~\n\n### Solution\n\n\u9996\u5148\u66b4\u529b\u7684\u60f3\u6cd5\u662f\u76f4\u63a5\u5408\u5e76\u4e32\uff0c\u518d\u5c06 $F(n)$ \u7684\u6240\u6709\u540e\u7f00\u8fdb\u884c\u5b57\u5178\u5e8f\u7684\u6392\u5e8f\uff0c\u6700\u540e\u5c06\u524d $\\min(m,|suf_k|)$ \u4f4d\u8f93\u51fa\u3002\n\n\u4f46\u662f\u53d1\u73b0\uff1a\n\n1. \u5b58\u4e0d\u4e0b\u8fd9\u4e48\u957f\u7684\u540e\u7f00\uff0c\u6211\u4eec\u53d1\u73b0 $F$ \u7684\u957f\u5ea6\u5c31\u662f\u6590\u6ce2\u90a3\u5951\u6570\u5217\uff0c\u90a3\u4e48\u5f53 $n$ \u7a0d\u5fae\u5927\u4e00\u70b9\u7684\u65f6\u5019\uff0c\u957f\u5ea6\u662f\u4f1a\u8d85\u8fc7 $10^{10}$ \u7684\u3002\u4f8b\u5982\uff1a $F(50)$ \u7684\u957f\u5ea6\u662f $20365011074$ \u3002\n\n2. \u5b58\u4e0d\u4e86\u8fd9\u4e48\u591a\u7684\u540e\u7f00\u3002\n\n\u4f46\u662f~~\u56e0\u4e3a\u61d2~~\u4e3a\u4e86\u66f4\u597d\u7684\u4f53\u73b0\u90e8\u5206\u5206\uff0c\u6211\u4eec\u9009\u62e9\u5c06\u524d $15$ \u4e2a\u4e32\u9884\u5904\u7406\u51fa\u6765\uff0c\u5f53 $n\\leq 15$ \u65f6\uff0c\u53ef\u4ee5\u66b4\u529b\u627e\u3002\n\n\u56e0\u4e3a $F(12)$ \u7684\u957f\u5ea6\u5c31\u5df2\u7ecf\u8d85\u8fc7 $200$ \u4e86\uff0c\u5373 $m$ \u7684\u4e0a\u754c\uff0c\u6240\u4ee5\u5728\u5904\u7406\u66f4\u5927\u66f4\u591a\u7684\u60c5\u51b5\u65f6\u5c31\u53ef\u4ee5\u4e0d\u7528\u7279\u5224\u5c0f\u7684\u60c5\u51b5\u4e86\u3002\n\n---\n\n\u73b0\u5728\u8003\u8651\u6b63\u89e3\u3002\n\n\u56e0\u4e3a\u8fd9\u4e2a\u4e32\u53ea\u7531 $0,1$ \u7ec4\u6210\uff0c\u800c\u4e14 $m\\leq 200$ \uff0c\u6240\u4ee5\u53ef\u4ee5\u5224\u65ad\u524d $m$ \u4f4d\u4e0a\u5206\u522b\u586b\u4ec0\u4e48\u3002\n\n\u90a3\u4e48\u73b0\u5728\u5c31\u8981\u627e\u5230\u4e00\u79cd\u65b9\u6cd5\uff1a\u53ef\u4ee5\u627e\u51fa**\u5982\u679c\u7b2c $i$ \u4f4d\u662f $1$ \uff0c\u6709\u591a\u5c11\u6bd4\u5df2\u7ecf\u586b\u51fa\u7684\u524d $i-1$ \u4f4d $ans$ \u7684\u5b57\u5178\u5e8f\u5c0f\u7684\u540e\u7f00**\u3002\uff08\u4ee5\u4e0b \u2018\u5df2\u7ecf\u586b\u51fa\u7684\u524d $i-1$ \u4f4d $ans$ \u2019 \u5747\u7528 \u2018 $ans$ \u2019 \u4ee3\u66ff\uff09\n\n\u8bbe $f_i$ \u8868\u793a $F(i)$ \u7684\u540e\u7f00\u4e2d\u6709\u591a\u5c11\u5c0f\u4e8e $ans$\uff0c\u90a3\u4e48\u8f6c\u79fb\u5c31\u662f\uff1a\n$$\nf_i=f_{i-1}+f_{i-2}+mg_{i-2,i-1}\n$$\n\u5176\u4e2d $mg_{i,j}$ \u8868\u793a\u5c06 $F(i)$ \u548c $F(j)$ \u62fc\u8d77\u6765\u6240\u589e\u52a0\u7684\u6bd4 $ans$ \u5c0f\u7684\u540e\u7f00\u4e2a\u6570\u3002\n\n\u4f46\u662f $mg$ \u4e5f\u4e0d\u80fd\u66b4\u529b\u6c42\uff0c\u56e0\u4e3a\u957f\u5ea6\u8fd8\u662f\u592a\u5927\u4e86\uff0c\u600e\u4e48\u529e\u5462\uff1f\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u5bf9\u4e8e $mg_{i-2,i-1}$ \uff0c\u5b83\u8868\u793a\u7684\u7684\u5176\u5b9e\u662f $F(i-2)$ \u957f\u4e3a $|ans|-1$ \u7684\u540e\u7f00\u5230 $F(i-1)$ \u957f\u4e3a $|ans|-1$ \u7684\u524d\u7f00\u5408\u5e76\u6240\u589e\u52a0\u7684\uff0c\u522b\u7684\u5728 $f_{i-1},f_{i-2}$ \u4e2d\u5c31\u5df2\u7ecf\u7b97\u5230\u4e86\u3002\n\n\u7b49\u7b49\uff0c $F(i-2)$ \u7684\u8fd9\u4e2a\u540e\u7f00\u662f\u54ea\u6765\u7684\uff0c\u4e0d\u5c31\u662f $F(i-3)$ \u7684\u540e\u7f00\u5417\uff01\uff01\uff01\n\n $F(i-1)$ \u7684\u90a3\u4e2a\u524d\u7f00\u540c\u7406\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u8fd9\u4e48\u9012\u5f52\u5230 $F(15)$ \u548c $F(14)$ \u3002\n\n\u5565\uff1f\u4e3a\u4ec0\u4e48\u662f $F(15)$ \uff1f\u56e0\u4e3a\u6211\u5728\u6700\u4e0a\u9762\u7684\u65f6\u5019\uff0c\u628a\u524d $15$ \u4e2a\u4e32\u5904\u7406\u51fa\u6765\u4e86(o\uff9fv\uff9f)\u30ce\n\n\u56e0\u4e3a\u53ea\u4f1a\u7528\u5230 $F(15),F(14)$ \u7684\u524d\u7f00\u548c\u540e\u7f00\uff0c\u6240\u4ee5\u53ef\u4ee5\u5c06 $mg_{14,15}$  \u8868\u793a\u4e3a $mg_{d_{14},h_{15}}$ \uff0c\u5728\u8f6c\u79fb\u7684\u65f6\u5019\u4e5f\u8f6c\u79fb $d,h$ \u5373\u53ef\uff1a $d_i=d_{i-2},h_i=h_{i-1},d_{14}=h_{14}=0,d_{15}=h_{15}=1$ \u3002\n\n\u90a3\u4e48\u5c06 $f_{15},f_{14},mg_{0/1,0/1}$ \u9884\u5904\u7406\u5373\u53ef\u3002\n\n\u86e4\uff1f\u600e\u4e48\u5904\u7406\uff1f\u4e00\u4f4d\u4e00\u4f4d\u66b4\u529b\u914d\u5bf9\u5457\n\n---\n\n\u5230\u6b64\u4e3a\u6b62\uff0c\u8fd9\u4e2a\u9898\u5c31\u5b8c\u4e86\u3002o(\\*\uffe3\u25bd\uffe3*)o\n\n\u6ce8\u610f\uff1a\u5f53 $n>15$ \u65f6\uff0c\u8f93\u51fa\u7684\u7b54\u6848\u7684\u957f\u5ea6\u53ef\u80fd\u8fd8\u662f $<m$ \u7684\uff0c\u56e0\u4e3a\u5728\u786e\u5b9a\u4e86\u67d0\u4e9b\u4f4d\u7f6e\u540e\uff0c $k=0$ \uff0c\u90a3\u4e48\u73b0\u5728\u8fd9\u4e2a\u786e\u5b9a\u4e86\u67d0\u4e9b\u4f4d\u7f6e\u7684\u7b54\u6848\u5176\u5b9e\u5df2\u7ecf\u662f\u6700\u540e\u7b54\u6848\u3002\uff08\u4f60\u54c1\uff0c\u4f60\u7ec6\u54c1\uff09\n\n\u5269\u4e0b\u7ec6\u8282\u770b\u4ee3\u7801\u5427\n\n### Code\n\n```c++\n#include<bits/stdc++.h>\n#define ll long long\n\nusing namespace std;\nconst int N=210;\nint n,m;\nll k,f[N],d[N],h[N],mg[2][2];\nstring pre[2],nxt[2],str[17],suf[N*10],ans;\n\ninline bool cmp(string a,string b){\n    for(int i=0;i<min(a.length(),b.length());i++){\n        if(a[i]==b[i]) continue;\n        if(a[i]<b[i]) return 1;\n        else return 0;\n    }\n    return a.length()<b.length();\n}\n\nint count(string a){    //\u6570\u51fa\u6765\u6709\u51e0\u4e2a\u6bd4\u73b0\u5728\u7684ans\u5c0f\u7684\n    int res=0;\n    for(int i=0;i<a.length();i++){\n        if(i+ans.length()-1>=a.length()) break;\n        bool flag=1;\n        for(int j=0;j<ans.length();j++)\n            if(a[i+j]!=ans[j]) flag=0;\n        res+=flag;\n    }\n    return res;\n}\n\nll solve(){\n    int len=ans.length();\n    pre[0].clear();pre[1].clear();nxt[0].clear();nxt[1].clear();    //\u8bb0\u5f97\u6e05\u96f6\n    d[14]=h[14]=0; d[15]=h[15]=1;   //\u8f6c\u79fbf\u7684\u65f6\u5019\u7528\n    for(int i=0;i<len-1;i++) pre[0].push_back(str[14][i]),pre[1].push_back(str[15][i]);\n    for(int i=1;i<=len-1;i++) nxt[0].push_back(str[14][str[14].length()-len+i]);\n    for(int i=1;i<=len-1;i++) nxt[1].push_back(str[15][str[15].length()-len+i]);\n    //\u5c06\u7b2c14,15\u4e2a\u4e32\u5bf9\u4e8eans\u7684\u524d\u7f00\u548c\u540e\u7f00\u5904\u7406\u51fa\u6765\n    for(int i=0;i<2;i++)\n        for(int j=0;j<2;j++)\n            mg[j][i]=count(nxt[j]+pre[i]);  //\u5408\u5e76\u65f6\u591a\u51fa\u7684\u540e\u7f00\u60c5\u51b5\n    f[14]=count(str[14]); f[15]=count(str[15]);\n    for(int i=16;i<=n;i++){\n        h[i]=h[i-1];\n        d[i]=d[i-2];\n        f[i]=f[i-1]+f[i-2];\n        f[i]+=mg[d[i]][h[i]];\n        if(f[i]>1e18) return f[i];  //\u56e0\u4e3ak\u5c0f\u4e8e1e18,\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u5224\u65ad\n    }\n    //\u5927\u529b\u8f6c\u79fb\n    return f[n];\n}\n\nint main(){\n    scanf(\"%d%lld%d\",&n,&k,&m);\n    str[0]=\"0\"; str[1]=\"1\";\n    for(int i=2;i<=15;i++) str[i]=str[i-2]+str[i-1];    //\u5c06\u524d15\u4e2a\u4e32\u9884\u5904\u7406\u51fa\u6765\n    if(n<=15){  //\u66b4\u529b\u90e8\u5206\n        for(int i=0;i<str[n].length();i++)\n            for(int j=i;j<str[n].length();j++)\n                suf[i+1].push_back(str[n][j]);\n        sort(suf+1,suf+str[n].length()+1,cmp);\n        for(int i=0;i<min(m,(int)suf[k].length());i++) printf(\"%c\",suf[k][i]);\n        return 0;\n    }\n    for(int i=1;i<=m;i++){  //\u6309\u4f4d\u8003\u8651\n        ans.push_back('0');\n        ll z=solve();       //\u5224\u65ad\u73b0\u5728\u8fd9\u51e0\u4f4dans\u60c5\u51b5\u4e0b\uff0c\u6709\u591a\u5c11\u6bd4ans\u5c0f\n        if(z<k){\n            k-=z;           //\u51cf\u53bb\u5c0f\u4e8e\u7684\n            ans.pop_back(); ans.push_back('1');//\u5c06\u8fd9\u4e00\u4f4d\u6539\u4e3a1\n        }\n        if(k==0){   //\u6ee1\u8db3\u5c31\u76f4\u63a5\u8f93\u51fa,\u53ef\u80fd\u5c0f\u4e8em\u4f4d\n            for(int i=0;i<ans.length();i++) printf(\"%c\",ans[i]);\n            return 0;\n        }\n    }\n    for(int i=0;i<ans.length();i++)\n        printf(\"%c\",ans[i]);\n    return 0;\n}\n```\n\n",
        "postTime": 1605844129,
        "uid": 272143,
        "name": "\u662f\u4e2a\u6c49\u5b50",
        "ccfLevel": 4,
        "title": "CF1065G Fibonacci Suffix"
    }
]
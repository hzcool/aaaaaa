[
    {
        "content": "\u56e0\u4e3a\u6bcf\u4e2a\u4eba\u90fd\u53ea\u80fd\u5339\u914d\u4e0e\u5176\u4ec5\u6709\u4e00\u4e2a\u89c2\u70b9\u4e0d\u540c\u7684\u4eba\uff0c\u6240\u4ee5\u540c\u610f\u6570\u4e3a\u5947\u6570\u7684\u4eba\u53ea\u80fd\u5339\u914d\u540c\u610f\u6570\u4e3a\u5076\u6570\u7684\u4eba\u3002\u4e8e\u662f\u5c06\u540c\u610f\u6570\u4e3a\u5947\u6570\u7684\u4eba\u653e\u4e00\u8fb9\uff0c\u540c\u610f\u6570\u4e3a\u5076\u6570\u7684\u8fb9\u653e\u4e00\u8fb9\uff0c\u8dd1\u5e26\u6743\u4e8c\u5206\u56fe\u5339\u914d\u5373\u53ef\u3002\n\n\u4e0d\u8fc7\u8fd9\u6837\u70b9\u6570\u662f $O(2^n)$ \u7ea7\u522b\uff0c\u8fb9\u6570\u662f $O(n\\times2^n)$ \u7ea7\u522b\uff0c \u6240\u4ee5\u6211\u4eec\u770b\u80fd\u4e0d\u80fd\u4f18\u5316\u5efa\u56fe\u6765\u51cf\u5c11\u70b9\u6570\u548c\u8fb9\u6570\u3002\n\n\u6211\u4eec\u53d1\u73b0\u6bcf\u4e2a\u70b9\u4f1a\u4e0e $n$ \u4e2a\u4eba\u76f8\u8fde\uff0c\u90a3\u4e48\u6bcf\u5339\u914d\u4e00\u5bf9\u5c31\u4f1a\u8ba9\u5269\u4e0b\u5339\u914d\u7684\u65b9\u6848\u6570\u6700\u591a\u51cf\u5c11 $2\\times(n-1)$ \uff08\u8fd9\u4e24\u4e2a\u4eba\u90fd\u4e0d\u80fd\u4e0e\u4ed6\u53e6\u5916 $n-1$ \u4e2a\u4e0e\u5176\u4ec5\u6709\u4e00\u4e2a\u89c2\u70b9\u4e0d\u540c\u7684\u4eba\u5339\u914d\uff09\uff0c\u52a0\u4e0a\u8fd9\u4e24\u4e2a\u4eba\u5339\u914d\u7684\u8fd9\u6761\u8fb9\u603b\u5171\u51cf\u5c11$2\\times n-1$\uff0c\u6240\u4ee5\u8bf4\u5047\u5982\u5339\u914d $k$ \u6b21\u6700\u591a\u53ea\u4f1a\u51cf\u5c11 $k\\times(2\\times n-1)$ \u79cd\u5339\u914d\u65b9\u5f0f\uff0c\u4e5f\u5c31\u662f\u5047\u5982\u9009\u62e9 $k\\times(2\\times n-1)$ \u4e2a\u5339\u914d\u90a3\u4e48\u81f3\u5c11\u4f1a\u5b58\u5728 $k$ \u79cd\u5339\u914d\u65b9\u5f0f\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c06\u6bcf\u4e2a\u5339\u914d\u7684\u6743\u503c\u8bbe\u4e3a\u5176\u5bf9\u5e94\u7684\u4e24\u4e2a\u4eba\u7684\u6743\u503c\u548c\uff0c\u5e76\u9009\u53d6\u6743\u503c\u6700\u5927\u7684 $k\\times(2\\times n-1)$ \u79cd\u5339\u914d\uff0c\u90a3\u4e48\u5b83\u9996\u5148\u4e00\u5b9a\u5b58\u5728 $k$ \u79cd\u5339\u914d\uff0c\u5176\u6b21\u6700\u5927\u6743\u503c\u7684\u5339\u914d\u4e00\u5b9a\u53ea\u9700\u8981\u8fd9\u4e9b\u5339\u914d\u3002\u56e0\u4e3a\u5047\u5982\u6709 $d$ \u4e2a\u5339\u914d\u4e0d\u5728\u8fd9\u4e9b\u6743\u503c\u8f83\u5927\u5339\u914d\u91cc\u9762\uff0c\u90a3\u4e48\u5148\u4e0d\u9009\u8fd9 $d$ \u4e2a\u5339\u914d\uff0c\u7136\u540e\u5269\u4f59\u9009\u62e9 $k-d$ \u4e2a\u6743\u503c\u8f83\u5927\u7684\u5339\u914d\u6700\u591a\u4f1a\u51cf\u5c11 $(k-d)\\times (2\\times n - 1)$ \u79cd\u5339\u914d\uff0c\u5269\u4f59 $d\\times (2\\times n - 1)$ \u79cd\u6743\u503c\u8f83\u5927\u7684\u5339\u914d\u65e2\u80fd\u7ec4\u6210 $d$ \u4e2a\u5339\u914d\uff0c\u800c\u4e14\u91cc\u9762\u7684\u5339\u914d\u6743\u503c\u80af\u5b9a\u6bd4\u5148\u524d\u7684\u5339\u914d\u6743\u503c\u66f4\u5927\u3002\n\n\u8fd9\u6837\u70b9\u6570\u548c\u8fb9\u6570\u90fd\u53d8\u6210\u4e86 $O(nk)$ \u7ea7\u522b\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <queue>\n#include <cstring>\n#include <queue>\nusing namespace std;\nconst int N = (1 << 20) + 10;\nconst int M = N << 2;\nint n;\nstruct bian\n{\n    int from, to;\n    long long w, val;\n}eg[M << 1];\nint front[N], num;\nvoid add(int x, int y, long long w, long long val)\n{\n    eg[++ num].to = y;\n    eg[num].from = front[x];\n    front[x] = num;\n    eg[num].w = w;\n    eg[num].val = val;\n\n    eg[++ num].to = x;\n    eg[num].from = front[y];\n    front[y] = num;\n    eg[num].val = -val;\n}\nlong long dis[N];\nint _front[N];\nint s, t;\nint dy[N], tt;\nint vis[N];\nbool bfs()\n{\n    queue<int>q;\n    q.push(s);\n    for (int i = 1; i <= tt; ++ i)\n    {\n        dis[i] = -1e18;\n    }\n    dis[s] = 0;\n    while (!q.empty())\n    {\n        int o = q.front();\n        q.pop();\n        vis[o] = 0;\n        for (int i = front[o]; i; i = eg[i].from)\n        {\n            int to = eg[i].to;\n            if(eg[i].w && dis[to] < dis[o] + eg[i].val)\n            {\n                dis[to] = dis[o] + eg[i].val;\n                if(vis[to] == 0)\n                {\n                    vis[to] = 1;\n                    q.push(to);\n                }\n            }\n        }\n    }\n    // for (int i = 1; i <= n; ++ i)\n    // {\n    //     printf(\"dis : %d %lld\\n\", i, dis[i]);\n    // }\n    return dis[t] != -1e18;\n}\nlong long cost;\nlong long dfs(int o, long long lim)\n{\n    // printf(\"%d %lld\\n\", o, lim);\n    if(o == t)\n    return lim;\n    vis[o] = 1;\n    long long mins = 0;\n    for (int &i = _front[o]; i; i = eg[i].from)\n    {\n        int to = eg[i].to;\n        // printf(\"%d\\n\", to);\n        if(vis[to] == 1 || dis[to] != dis[o] + eg[i].val || eg[i].w == 0)continue;\n        long long now = dfs(to, min(lim - mins, eg[i].w));\n        if(now)\n        {\n            cost += now * eg[i].val;\n            eg[i].w -= now;\n            eg[((i - 1) ^ 1) + 1].w += now;\n            mins += now;\n            if(mins == lim)break;\n        }\n    }\n    vis[o] = 0;\n    return mins;\n}\nlong long dinic()\n{\n    long long re = 0;\n    while(bfs())\n    {\n        memcpy(_front, front, sizeof(front));\n        long long gu;\n        while(gu = dfs(s, 1e18))\n        {\n\t        re += gu;\n\t\t}\n        //printf(\"%lld %lld\\n\", re, cost);\n    }\n    return re;\n}\nint m, k, w[(1 << 20) + 10];\nint popcnt[(1 << 20) + 10];\nbool us[(1 << 20) + 10][20], adds[(1 << 20) + 10];\npriority_queue<pair<int, pair<int, int> > >q;\nint main()\n{\n\tscanf(\"%d%d\", &n, &k);\n\tfor (int i = 0; i < (1 << n); ++ i)\n\tscanf(\"%d\", &w[i]);\n\tfor (int i = 0; i < (1 << n); ++ i)\n\tpopcnt[i] = popcnt[i >> 1] + (i & 1);\n\ts = 1;\n\tt = 2;\n\tadd(s, 3, k, 0);\n\ttt = 3;\n\tfor (int i = 0; i < (1 << n); ++ i)\n\t{\n\t\tif(popcnt[i] & 1)\n\t\t{\n\t\t\tint maxs = 0, to = 0, ids = 0;\n\t\t\tfor (int j = 0; j < n; ++ j)\n\t\t\tif(w[i] + w[(i ^ (1 << j))] > maxs)\n\t\t\tmaxs = w[i] + w[(i ^ (1 << j))], to = (i ^ (1 << j)) + 1, ids = j;\n\t\t\tus[i][ids] = 1;\n\t\t\tq.push(make_pair(maxs, make_pair(i + 1, to)));\n\t\t}\n\t}\n\tfor (int i = 1; i <= (2 * n - 1) * k; ++ i)\n\t{\n\t\tint o = q.top().second.first;\n\t\tif(dy[q.top().second.first] == 0)\n\t\tdy[q.top().second.first] = ++ tt, add(3, tt, 1, 0);\n\t\tif(dy[q.top().second.second] == 0)\n\t\tdy[q.top().second.second] = ++ tt, add(tt, t, 1, 0);\n\t\tadd(dy[q.top().second.first], dy[q.top().second.second], 1, q.top().first);\n\t\tq.pop();\n\t\t-- o;\n\t\t\tint maxs = 0, to = 0, ids = 0;\n\t\t\tfor (int j = 0; j < n; ++ j)\n\t\t\tif(us[o][j] == 0 && w[o] + w[(o ^ (1 << j))] > maxs)\n\t\t\tmaxs = w[o] + w[(o ^ (1 << j))], to = (o ^ (1 << j)) + 1, ids = j;\n\t\t\tus[o][ids] = 1;\n\t\t\tq.push(make_pair(maxs, make_pair(o + 1, to)));\n\t}\n\tdinic();\n\tprintf(\"%d\", cost);\n}\n```\n",
        "postTime": 1632723341,
        "uid": 111728,
        "name": "\u5e7b\u5f71\u661f\u575a\u5f3a",
        "ccfLevel": 7,
        "title": "CF1572D"
    },
    {
        "content": "## Description\n\u95ee $n$ \u7ef4\u8d85\u7acb\u65b9\u4f53\uff0c\u9009 $k$ \u6761\u8fb9\u7684\u6700\u5927\u6743\u5339\u914d\u3002$1\\le n\\le 20$\uff0c$1\\le k\\le 200$\u3002\n\n## Solution\n\u663e\u7136\uff0c\u56fe\u4e3a\u4e8c\u5206\u56fe\uff0c\u6309\u7167\u4e8c\u8fdb\u5236\u8868\u793a\u4e0b $1$ \u7684\u4e2a\u6570\u5373\u53ef\u5206\u4e3a\u5de6\u90e8\u548c\u53f3\u90e8\uff0c\u4e2d\u95f4\u8fde\u6743\u4e3a $a_i + a_j$ \u7684\u8fb9\u3002\n\n\u4f46\u662f\u76f4\u63a5\u8d39\u7528\u6d41\u6216\u8005 KM \u90fd\u4f1a\u6b7b\u6389\uff0c\u56e0\u4e3a\u70b9\u6570\u4e3a $O(2^n)$ \u7ea7\u522b\uff0c\u8fb9\u6570\u4e3a $O(n2^n)$ \u7ea7\u522b\uff0c\u5fc5\u6b7b\u65e0\u7591\u3002\u4f46\u662f\u6ce8\u610f\u5230\u8fd9\u4e2a $k$ \u662f\u5f88\u5c0f\u7684\uff0c\u6211\u4eec\u9700\u8981\u4ece $k$ \u4e0a\u4e0b\u624b\u3002\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u6bcf\u4e2a\u70b9\u4f1a\u8fde\u51fa\u53bb $n$ \u6761\u8fb9\uff0c\u5982\u679c\u6211\u4eec\u9009\u62e9\u4e86\u4e00\u4e2a\u5339\u914d\uff0c\u90a3\u4e48\u5269\u4e0b\u80fd\u5339\u914d\u7684\u65b9\u6848\u6570\u5c31\u4f1a\u51cf\u5c11 $2(n - 1)$\uff0c\u6240\u4ee5\u6211\u4eec\u9009\u4e86 $k$ \u4e2a\u5339\u914d\u540e\u6700\u591a\u53ea\u4f1a\u51cf\u5c11 $k(2n - 1)$ \u4e2a\u5339\u914d\u65b9\u5f0f\uff0c\u5373\u6211\u4eec\u9009\u4e86 $k(2n - 1)$ \u4e2a\u5339\u914d\u5c31\u4f1a\u81f3\u5c11\u5b58\u5728 $k$ \u4e2a\u5339\u914d\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u9009\u51fa\u6700\u5927\u7684 $k(2n - 1)$ \u6761\u8fb9\uff0c\u7136\u540e\u8dd1\u8d39\u7528\u6d41\u5c31\u884c\u4e86\uff0c\u4e0d\u96be\u53d1\u73b0\u4e00\u5b9a\u6709\u6700\u4f18\u7684\u65b9\u6848\u5b58\u5728\u5728\u8fd9\u6700\u5927\u7684 $k(2n - 1)$ \u6761\u8fb9\u91cc\u9762\uff0c\u8bc1\u660e\u53ef\u7528\u53cd\u8bc1\u6cd5\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u4e2d\uff0c\u9009\u51fa\u6700\u5927\u7684 $k(2n - 1)$ \u6761\u8fb9\u6211\u4eec\u4f7f\u7528 STL \u7684 `nth_element()` \u51fd\u6570\uff0c\u5176\u590d\u6742\u5ea6\u4e3a $O(\\text{length of the seq})$\uff0c\u672c\u9898\u4e2d\u4e3a $n2^n$\uff0c\u7136\u540e\u6ce8\u610f\u52a0\u8fb9\u7684\u65f6\u5019\u4e0d\u8981\u7ed9\u6bcf\u4e2a $[0, 2^n - 1]$ \u7684\u7403\u5458\u90fd\u52a0\u8fb9\uff0c\u5426\u5219\u4f1a TLE\u3002\n\n## Implementation\n\n\u76f4\u63a5\u7c98\u7684 SPFA \u8d39\u7528\u6d41\uff0c\u597d\u6162\u554a\uff08\uff08\uff08\n\n[\u8bc4\u6d4b\u8bb0\u5f55](https://codeforces.com/contest/1572/submission/131155272)\u3002",
        "postTime": 1633699272,
        "uid": 212488,
        "name": "\u6e05\u70db",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1572D Bridge Club"
    }
]
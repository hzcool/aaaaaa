[
    {
        "content": "[\u9898\u76ee](https://www.luogu.org/problemnew/show/CF95D)\n\n~~\u4f5c\u4e3a\u5168\u673a\u623f\u6700\u83dc\u7684\u4eba\u5c45\u7136\u505a\u51fa\u4e86\u4e00\u9053\u6ca1\u6709\u4eba\u505a\u51fa\u7684\u9898\u76ee~~\n\n\u5f88\u660e\u663e\u8fd9\u662f\u4e00\u9053\u6570\u4f4ddp\uff0cl\u548cr\u7684\u8303\u56f4\u8868\u660e\u5148\u8981\u7528\u5b57\u7b26\u8bfb\u8fdb\u6765\u3002\n\n\u800c\u6240\u6c42 $ans=sum_r-sum_{l-1}$\n\n\u56e0\u4e3a $l-1$ \u6d89\u53ca\u5230\u9ad8\u7cbe\u51cf ~~\u6211\u5e76\u4e0d\u60f3\u6253~~\n\n\u6240\u4ee5\u6211\u6253\u7b97\u5bf9 $l$ \u52a0\u4e2a\u7279\u5224\n\n\u6539\u6210 $ans=sum_r-sum_l+check_l$ (\u5982\u679c $l$ \u7b26\u5408\u8981\u6c42\uff0c\u90a3\u4e48 $check_l$ \u4e3a1)\n\n\u7528\u8bb0\u5fc6\u5316\u641c\u7d22\n\n```cpp\n#include<bits/stdc++.h>\n#define Mod 1000000007\nusing namespace std;\nchar s[1007];\nint t,k,f[1007][1007][2],a[1007],l;\nint dfs(int pos,int d,int q,int m)\n//pos\u8868\u793a\u5f53\u524d\u4f4d\u7f6e\n//d\u8868\u793ak+1\u51cf\u53bb\u4e0e\u524d\u4e00\u4e2a\u5e78\u8fd0\u6570\u5b57\u7684\u8ddd\u79bb\n//\u90a3\u4e48\u5f53d\u964d\u52300\u65f6\uff0c\u5b83\u4e0e\u524d\u9762\u7684\u5e78\u8fd0\u6570\u5b57\u7684\u8ddd\u79bb\u5c31\u8d85\u8fc7k\u4e86\n//q\u8868\u793a\u4e4b\u524d\u662f\u5426\u7b26\u5408\u8981\u6c42\uff0c\u7b26\u5408\u8981\u6c42\u4e3a1\uff0c\u4e0d\u7b26\u5408\u4e3a0\n//m\u8868\u793a\u5f53\u524d\u4f4d\u80fd\u5426\u53d6\u52309\uff0c\u5373\u4e4b\u524d\u662f\u5426\u8fbe\u5230\u4e0a\u754c\uff0c\u8fbe\u5230\u4e0a\u754c\u5c31\u4e3a1\uff0c\u6ca1\u6709\u5c31\u4e3a0\n{\n\tif (!pos) return q;\n\tif (!m&&f[pos][d][q]!=-1) return f[pos][d][q];\n\tint ans=0,MAX=m?a[pos]:9;\n\tfor (int i=0;i<=MAX;i++)\n\t{\n\t\tif (i!=4&&i!=7)\n\t\t\tans=(ans+dfs(pos-1,max(d-1,0),q,m&&i==MAX))%Mod;\n\t\telse ans=(ans+dfs(pos-1,k,q||d,m&&i==MAX))%Mod;\n\t}\n\tif (!m) f[pos][d][q]=ans;\n\treturn ans;\n}\nint check()\n{\n\tint LAST=2007;\n\tfor (int i=l;i;i--)\n\t{\n\t\tif (a[i]==4||a[i]==7)\n\t\t{\n\t\t\tif (LAST-i<=k) return 1;\n\t\t\tLAST=i;\n\t\t}\n\t}\n\treturn 0;\n}\nint main()\n{\n\tscanf(\"%d%d\",&t,&k);\n\tmemset(f,-1,sizeof(f));\n\twhile (t--)\n\t{\n\t\tscanf(\"%s\",s);\n\t\tl=strlen(s);\n\t\tfor (int i=l-1;i>=0;i--)\n\t\t\ta[l-i]=s[i]-'0';\n\t\tint ans=(dfs(l,0,0,1)-check()+Mod)%Mod;\n\t\tscanf(\"%s\",s);\n\t\tl=strlen(s);\n\t\tfor (int i=l-1;i>=0;i--)\n\t\t\ta[l-i]=s[i]-'0';\n\t\tans=(dfs(l,0,0,1)+Mod-ans)%Mod;\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1560431485,
        "uid": 25001,
        "name": "Pro_Rexxar",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF95D \u3010Horse Races\u3011"
    },
    {
        "content": "### \u3010\u89e3\u9898\u601d\u8def\u3011\n\n\n------------\n\n\u4e00\u9053\u6bd4\u8f83~~\u57fa\u7840~~\u7684\u6570\u4f4dDP\u3002\n\n\u7b54\u6848\u660e\u663e\u53ef\u4ee5\u5dee\u5206\u51fa\u6765\uff0c$\\large ans=calc(r)-calc(l-1)$ \uff0c\u4f46\u662f\u7531\u4e8e\u6570\u636e\u8303\u56f4\u592a\u5927 $\\large 1\\leq l\\leq r\\leq 10^{1000}$\uff0c\u6240\u4ee5\u6211\u4eec\u5fc5\u987b\u5c06 $\\large l$ \u5355\u72ec\u62ff\u51fa\u6765\u5224\u65ad\u4e00\u4e0b\u3002\n\n\u81f3\u4e8e $\\large calc(x)$ \uff0c\u53ef\u4ee5\u7528\u6570\u4f4ddp\u6765\u8fdb\u884c\u6c42\u89e3\uff0c\u5b9a\u4e49 $\\large dp_{i,j,k}$ \u4e3a\u5728\u7b2c $\\large i$ \u4f4d\u8ddd\u4e0a\u4e00\u4e2a\u5e78\u8fd0\u6570\u5b57\u8ddd\u79bb\u4e3a $\\large j$ \u4e14\u662f\u5426\u6ee1\u8db3\u6761\u4ef6\u7684\u6570\u7684\u6570\u91cf\u3002\n\n\u72b6\u6001\u8f6c\u79fb\u7684\u8fc7\u7a0b\u53ef\u4ee5\u7528\u8bb0\u5fc6\u5316\u641c\u7d22\u6765\u5b9e\u73b0\u3002\u4e4b\u540e\u5c31\u53ef\u4ee5\u5f88\u7b80\u5355\u7684\u89e3\u51b3\u4e86\u3002\n\n**Code** (\u6700\u8fd1\u5b66\u574f\u4e86\uff0c\u538b\u884c\u7684\u6709\u4e9b\u5389\u5bb3)\n\n\n------------\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mod = 1e9 + 7;\nint dp[1005][1005][2];\nint bits[1005];\nint t,k;\nlong long dfs(int len,int lpos,int fg,bool border)\n{\n    if(!len) return fg == 1;\n    if(!border && dp[len][lpos][fg]!=-1) return dp[len][lpos][fg];\n    int up=border? bits[len]:9;\n    long long res=0 ;\n    for (int i=0; i<=up; i++)\n    {\n        if(i==4||i==7)\n        {\n            res += dfs(len-1,len,(lpos && lpos-len<=k)|fg,border&&i==up);\n        }\n        else res += dfs(len - 1, lpos, fg, border && i == up);\n    }\n    res %= mod;\n    if(!border) dp[len][lpos][fg] = res;\n    return res;\n}\nlong long f(string s)\n{\n    int len=0;\n    for (int i=s.size()-1; i>=0; i--)\n    {\n        bits[++ len] = s[i] - '0';\n    }\n    return dfs(len,0,0,1);\n}\nbool check(string &s)\n{\n    int p = 0;\n    for (int i=1; i<=s.size(); i++)\n    {\n        if (s[i-1]=='4'||s[i-1]=='7')\n        {\n            if(!p||i-p>k) p=i;\n            else if(i-p<=k) return true;\n        }\n    }\n    return false;\n}\n\nint main()\n{\n    cin>>t>>k;\n    string l,r;\n    memset(dp, -1, sizeof(dp));\n    for (int i=0; i<t; i++)\n    {\n        cin>>l>>r;\n        long long ans=f(r)-f(l)+(check(l)?1:0);\n        cout<<(ans%mod+mod)%mod<< endl;\n    }\n    return 0;\n}\n\n```\n",
        "postTime": 1603546585,
        "uid": 316896,
        "name": "Dimly_dust",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF95D \u3010Horse Races\u3011"
    }
]
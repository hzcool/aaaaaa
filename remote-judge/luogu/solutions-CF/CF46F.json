[
    {
        "content": "~~\u4e00\u770b\u5c31\u662f\u9053\u641c\u7d22\u9898\uff0c\u7136\u800c\u672c\u849f\u84bb\u5e76\u4e0d\u4f1a\u641c\u7d22~~\n\n\u5982\u679c\u76f4\u63a5\u641c\u7d22\uff0c\u8981\u8bb0\u5f55\u7684\u72b6\u6001\u5f88\u591a\uff0c\u8981\u8bb0\u5f55\u4eba\u7684\u4f4d\u7f6e\uff0c\u94a5\u5319\u7684\u4f4d\u7f6e\uff0c\u6bcf\u6247\u95e8\u7684\u72b6\u6001......\u800c\u4e14\u4ee3\u7801\u4e5f\u5f88\u96be\u6253\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u6362\u4e00\u79cd\u641c\u7d22\u65b9\u6cd5\uff1a\n\n\u663e\u7136\uff0c\u9898\u76ee\u4e2d\u7ed9\u7684\u64cd\u4f5c\u90fd\u662f\u53ef\u9006\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u5b9a\u4e49\u4e00\u79cd\u4e2d\u95f4\u72b6\u6001\uff1a\u80fd\u5f00\u7684\u95e8\u90fd\u5f00\u4e86\uff0c\u80fd\u5728\u4e00\u8d77\u7684\u4eba\u90fd\u805a\u5728\u4e00\u8d77\u3002\u5982\u679c\u5f00\u59cb\u548c\u7ed3\u679c\u90fd\u80fd\u8f6c\u79fb\u5230\u4e2d\u95f4\u72b6\u6001\uff0c\u5c31\u662fYES\uff0c\u5426\u5219\u5c31\u662fNO\u3002\n\n\u4ee5\u4e3an<=1000\u6240\u4ee5\u53ef\u4ee5\u5199n^2\u7684\u4ee3\u7801\n\n\u7528\u6211\u4eec\u53ef\u7231\u7684\u5e76\u67e5\u96c6\u6765\u5904\u7406\u8fde\u901a\u5757\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1005;\nint parent[N],rnk[N];\nstruct UnionFind\n{\n\tUnionFind(int n)\n\t{\n\t\tfor(int i=0;i<n;i++)\n\t\t{\n\t\t\tparent[i]=i;\n\t\t\trnk[i]=1;\n\t\t}\n\t}\n\tint root(int x)\n\t{\n\t\tif(parent[x]!=x)\n\t\t\tparent[x]=root(parent[x]);\n\t\treturn parent[x];\n\t}\n\tvoid connect(int x,int y)\n\t{\n\t\tint rx=root(x),ry=root(y);\n\t\tif(rx==ry)\n\t\t\treturn;\n\t\tif(rx>ry)\n\t\t{\n\t\t\tparent[ry]=rx;\n\t\t\trnk[rx]+=rnk[ry];\t\n\t\t} \n\t\tif(rx<=ry)\n\t\t{\n\t\t\tparent[rx]=ry;\n\t\t\trnk[ry]+=rnk[rx];\n\t\t}\n\t}\n};\nmap<string,int>mp;\nint n,m,k;\nint key[2][N],people[2][N];\nbool connected[2][N][N];\nint s[N],t[N];\nchar buf[100];\nvoid func(int id)\n{\n\tUnionFind uf(n);\n\tfor(int iter=0;iter<n+10;iter++)\n\t{\n\t\tfor(int i=0;i<m;i++)\n\t\t{\n\t\t\tint room=uf.root(key[id][i]);\n\t\t\tif(uf.root(s[i])==room||uf.root(t[i])==room)\n\t\t\t\tuf.connect(s[i],t[i]);\n\t\t}\n\t}\n\tfor(int i=0;i<n;i++)\n\t\tfor(int j=0;j<n;j++)\n\t\t\tconnected[id][i][j]=(uf.root(i)==uf.root(j));\n}\nbool can()\n{\n\tfor(int i=0;i<n;i++)\n\t\tfor(int j=0;j<n;j++)\n\t\t\tif(connected[0][i][j]!=connected[1][i][j])\n\t\t\t\treturn false;\n\tfor(int i=0;i<m;i++)\n\t\tif(!connected[0][key[0][i]][key[1][i]])\n\t\t\treturn false;\n\tfor(int i=0;i<k;i++)\n\t\tif(!connected[0][people[0][i]][people[1][i]])\n\t\t\treturn false;\n\treturn true;\n}\nint main()\n{\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tfor(int i=0;i<m;i++)\n\t{\n\t\tscanf(\"%d%d\",&s[i],&t[i]);\n\t\ts[i]--;\n\t\tt[i]--;\n\t}\n\tfor(int i=0;i<k;i++)\n\t{\n\t\tscanf(\"%s\",buf);\n\t\tstring str=buf;\n\t\tmp[str]=i;\n\t\tint room;\n\t\tscanf(\"%d\",&room);\n\t\troom--;\n\t\tpeople[0][i]=room;\n\t\tint c;\n\t\tscanf(\"%d\",&c);\n\t\tfor(int j=0;j<c;j++)\n\t\t{\n\t\t\tint e;\n\t\t\tscanf(\"%d\",&e);\n\t\t\te--;\n\t\t\tkey[0][e]=room;\n\t\t}\n\t} \n\tfor(int i=0;i<k;i++)\n\t{\n\t\tscanf(\"%s\",buf);\n\t\tstring str=buf;\n\t\tint p=mp[buf];\n\t\tint room;\n\t\tscanf(\"%d\",&room);\n\t\troom--;\n\t\tpeople[1][p]=room;\n\t\tint c;\n\t\tscanf(\"%d\",&c);\n\t\tfor(int j=0;j<c;j++)\n\t\t{\n\t\t\tint e;\n\t\t\tscanf(\"%d\",&e);\n\t\t\te--;\n\t\t\tkey[1][e]=room;\n\t\t}\n\t}\n\tfunc(0);\n\tfunc(1);\n\tbool ans=can();\n\tcout<<(ans?\"YES\":\"NO\")<<endl;\n\treturn 0;\n}\n\n```",
        "postTime": 1545569021,
        "uid": 67896,
        "name": "AllureLove",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF46F \u3010Hercule Poirot Problem\u3011"
    },
    {
        "content": "upd 2022.05.17\uff1a\u5220\u6389\u4e86\u4e00\u5f20\u65e0\u7528\u7684\u56fe\n\n[\u9898\u9762](https://www.luogu.com.cn/problem/CF46F)\n\n\u70b9\u6570\uff1a2300\n\n##### \u5206\u6790\uff1a\n\n$n \\leq 1000$ \u6240\u4ee5\u8bf4\u8fd9\u9898\u590d\u6742\u5ea6\u76f4\u63a5\u80af\u5b9a $O(n^2)$ \u5de6\u53f3\u3002\n\n\u5f88\u660e\u663e\u8fd9\u9898\u975e\u5e38\u56fe\u8bba(\u56e0\u4e3a\u5176\u4ed6\u7b97\u6cd5\u505a\u4e0d\u4e86\u554a)\uff0c\u95e8\u5c31\u662f\u8fb9\uff0c\u4f46\u80fd\u4e0d\u80fd\u8d70\u67d0\u4e00\u6761\u8fb9\u662f\u6709\u6761\u4ef6\u7684\uff0c\u5c31\u662f\u94a5\u5319\u7684\u95ee\u9898\u3002\n\n\u6309\u7167\u8fd9\u4e2a\u601d\u8def\u80fd\u8d70\u5230\u7684\u5730\u65b9\u5c31\u662f\u4e00\u4e2a\u8fde\u901a\u5757\u3002\n\n\u6ce8\u610f\u5230\u9898\u76ee\u4e2d\u7ed9\u51fa\u4e86\u8d77\u59cb\u548c\u7ed3\u675f\u7684\u623f\u95f4\u548c\u94a5\u5319\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u53cc\u5411\u7684\u641c\u4e00\u4e0b\u3002\n\n\u8fd9\u662f\u6211\u4eec\u52a0\u5165\u5e76\u67e5\u96c6\u7ef4\u62a4\u8fde\u901a\u5757\uff0c\u8fd9\u6837\u62ff\u5230\u53e6\u4e00\u628a\u94a5\u5319\u5c31\u662f\u5408\u5e76\u8fde\u901a\u5757\u3002\n\n\u8dd1\u4e00\u904d\u5408\u5e76\u4e00\u4e0b\u80fd\u5408\u5e76\u7684\u3002\n\n\u6700\u540e\u9a8c\u8bc1\u4e00\u4e0b\u6240\u6709\u7684\u4eba\u7684\u8d77\u59cb\u623f\u95f4\u548c\u7ed3\u675f\u623f\u95f4\u3001\u8fd8\u6709\u94a5\u5319\u7684\u8d77\u59cb\u623f\u95f4\u548c\u7ed3\u675f\u623f\u95f4\uff0c\u662f\u4e0d\u662f\u90fd\u5728\u540c\u4e00\u4e2a\u8fde\u901a\u5757\u5185\u5c31\u884c\u4e86\u3002\n\n\u603b\u590d\u6742\u5ea6\uff1a$O(nm)$\n\n\u5b8c\u6574\u4ee3\u7801\uff1a\n\n\n```cpp\n#include<bits/stdc++.h>\n#define mem(a,b) memset(a,b,sizeof(a));\n#define pc putchar\n#define fast_iostream ios::sync_with_stdio(0),cin.tie(0),cout.tie(0)\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double ld;\ntypedef double db;\nconst ld EPS=1e-8;\nconst ll INF=ll(1e9+7);\nconst ll LLINF=ll(1e18+7);\nconst ld LDEPS=1e-18;\ninline ll max(ll x,ll y){return x>y?x:y;}\ninline ll min(ll x,ll y){return x<y?x:y;}\ninline ld dmax(ld x,ld y){return x>y?x:y;}\ninline ld dmin(ld x,ld y){return x<y?x:y;}\ninline ll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\ninline ll lcm(ll a,ll b){return a*b/gcd(a,b);}\ninline ll lowbit(ll x){return x&(-x);}\ninline ll read(){ll read_result=0,is_below_0=0;char now_ch=0;while(!isdigit(now_ch)){is_below_0|=now_ch=='-';now_ch=getchar();}while(isdigit(now_ch)){read_result=(read_result<<3)+(read_result<<1)+(now_ch^48);now_ch=getchar();}return is_below_0?-read_result:read_result;}\ninline ld dread(){ld x=0,d=0.1;char f=0,ch=getchar();while(!isdigit(ch))f|=(ch=='-'),ch=getchar();while(isdigit(ch)) x=x*10+ch-48,ch=getchar();if(ch=='.'){ch=getchar();while(isdigit(ch))x+=d*(ch^48),d*=0.1,ch=getchar();}return f?-x:x;}\ninline void write(ll x){if(x<0){putchar('-');x=-x;}if(x>9){write(x/10);}putchar(x%10+'0');}\nconst ll MAXN=2007;\nll n,m,k;\nstruct node\n{\n\tll u,v;\n}a[MAXN];\nll in[2][MAXN],key[2][MAXN];\nbool con[2][MAXN][MAXN];\nll fa[MAXN],siz[MAXN];\nmap<string,ll>mp;\nvoid initset(ll fa_size)\n{\n\tfor(ll i=0;i<fa_size;i++)fa[i]=i,siz[i]=1;\n}\nll find(ll x)\n{\n\tif(x!=fa[x])fa[x]=find(fa[x]);\n\treturn fa[x];\n}\nvoid us(ll x,ll y)\n{\n\tll xx=find(x),yy=find(y);\n\tif(xx==yy)return ;\n\tif(xx>yy)\n\t{\n\t\tfa[yy]=xx;\n\t\tsiz[xx]+=siz[yy];\n\t}\n\telse\n\t{\n\t\tfa[xx]=yy;\n\t\tsiz[yy]+=siz[xx];\n\t}\n}\nstring str;\nvoid solve(ll id)\n{\n\tinitset(n+1);\n\tfor(ll t=1;t<=n+1;t++)\n\t{\n\t\tfor(ll i=1;i<=m;i++)\n\t\t{\n\t\t\tll root=find(key[id][i]);\n\t\t\tif(find(a[i].u)==root||find(a[i].v)==root)us(a[i].u,a[i].v);\n\t\t}\n\t}\n\tfor(ll i=1;i<=n;i++)\n\t{\n\t\tfor(ll j=1;j<=n;j++)\n\t\t{\n\t\t\tcon[id][i][j]=(find(i)==find(j));\n\t\t}\n\t}\n}\nbool check()\n{\n\tfor(ll i=1;i<=n;i++)\n\t{\n\t\tfor(ll j=1;j<=n;j++)\n\t\t{\n\t\t\tif(con[0][i][j]!=con[1][i][j])return 0;\n\t\t}\n\t}\n\tfor(ll i=1;i<=m;i++)\n\t{\n\t\tif(!con[0][key[0][i]][key[1][i]])return 0;\n\t}\n\tfor(ll i=1;i<=k;i++)\n\t{\n\t\tif(!con[0][in[0][i]][in[1][i]])return 0;\n\t}\n\treturn 1;\n}\nint main()\n{\n \t//freopen(\".in\",\"r\",stdin);\n    //freopen(\".out\",\"w\",stdout);\n\tn=read(),m=read(),k=read();\n\tfor(ll i=1;i<=m;i++)\n\t{\n\t\ta[i].u=read(),a[i].v=read();\n\t}\n\tfor(ll i=1;i<=k;i++)\n\t{\n\t\tcin>>str;\n\t\tmp[str]=i;\n\t\tin[0][i]=read();\n\t\tll num=read();\n\t\tfor(ll j=1;j<=num;j++)\n\t\t{\n\t\t\tkey[0][read()]=in[0][i];\n\t\t}\n\t}\n\tfor(ll i=1;i<=k;i++)\n\t{\n\t\tcin>>str;\n\t\tll pos=mp[str];\n\t\tin[1][i]=read();\n\t\tll num=read();\n\t\tfor(ll j=1;j<=num;j++)\n\t\t{\n\t\t\tkey[1][read()]=in[1][i];\n\t\t}\n\t}\n\tsolve(0),solve(1);\n\tif(check())puts(\"YES\");\n\telse puts(\"NO\");\n\treturn 0;\n}\n```\n\n",
        "postTime": 1638598278,
        "uid": 395288,
        "name": "Yuby",
        "ccfLevel": 6,
        "title": "CF46F\u9898\u89e3"
    }
]
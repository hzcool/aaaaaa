[
    {
        "content": "\u8003\u8651\u76f4\u63a5\u90fd\u586b\u65b0\u7684\u6570\uff0c\u8fd9\u6837\u4f1a\u628a 0 \u6bb5\u7684\u7aef\u70b9\u6d6a\u8d39\u6389\u3002\n\n\u8003\u8651\u5947\u6570\u957f\u5ea6\u7684\u5168 0 \u6bb5\u548c\u5076\u6570\u957f\u5ea6\u7684\u5168 0 \u6bb5\u3002\u8bbe\u7aef\u70b9\u7684\u989c\u8272\u4e3a $u,v$\u3002\n\n- \u5947\u6570\u957f\u5ea6\uff1a\u53ef\u4ee5\u5339\u914d $u$ \u6216\u5339\u914d $v$\uff0c\u4f7f\u5f97\u7b54\u6848\u6bd4\u76f4\u63a5\u586b +1.\n- \u5076\u6570\u957f\u5ea6\uff1a\u53ea\u6709\u540c\u65f6\u5339\u914d $u,v$ \u624d\u4f7f\u5f97\u7b54\u6848\u6bd4\u76f4\u63a5\u586b +1.\n\n\u53ef\u4ee5\u5efa\u7acb\u4e00\u822c\u56fe\u6700\u5927\u5339\u914d\u7684\u6a21\u578b\uff1a\u5947\u6570\u957f\u5ea6\u5efa\u865a\u70b9 $t$\uff0c\u8fde\u8fb9 $(u,t),(v,t)$\uff1b\u5076\u6570\u957f\u5ea6\u8fde\u8fb9 $(u,v)$\uff1b\u8dd1\u4e00\u822c\u56fe\u6700\u5927\u5339\u914d\u3002\n\n\u4f46\u8fd9\u6837\u6709\u5927\u91cf\u865a\u70b9\uff0c\u590d\u6742\u5ea6\u7206\u70b8\u3002\n\n\u6211\u4eec\u8003\u8651\u4e00\u4e0b\u5947\u6570\u957f\u5ea6\u5148\u63d0\u524d\u9884\u5904\u7406\u597d\u5339\u914d\u3002\n\n\u5efa\u4e00\u5f20\u65b0\u56fe\uff0c\u5bf9\u4e8e\u5947\u6570\u957f\u5ea6\u7684\u8fde\u5728\u56fe\u4e2d\u8fb9 $(u,v)$\uff0c\u8003\u5bdf\u56fe\u4e2d\u7684\u6bcf\u4e2a\u8fde\u901a\u5757\uff0c\u8bbe\u70b9\u6570\u3001\u8fb9\u6570\u4e3a $n,m$\uff1a\n\n- $m=n-1$\uff1a\u6b64\u65f6\u4e3a\u751f\u6210\u6811\u3002\u53ef\u4ee5\u9009\u4e00\u4e2a\u6839\u8282\u70b9\uff0cdfs \u6574\u4e2a\u6811\uff0c\u6bcf\u4e2a\u975e\u6839\u8282\u70b9\u90fd\u53ef\u4ee5\u88ab\u7236\u8fb9\u5339\u914d\u6389\uff0c\u53ea\u5269\u6839\u8282\u70b9\u6ca1\u5339\u914d\u3002\u6839\u8282\u70b9\u662f\u4efb\u610f\u9009\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u505a\u5230\u201c\u9009\u4efb\u610f $n-1$ \u4e2a\u8282\u70b9\u5339\u914d\u6389\u201d\u3002\n- $m\\ge n$\uff1a\u6b64\u65f6\u53ef\u4ee5\u770b\u505a\u751f\u6210\u6811\u4e0a\u518d\u52a0\u4e00\u6761\u8fb9 $(x,y)$\uff0c\u53ef\u4ee5\u62ff $x$ \u5f53\u6839\u628a\u5176\u4ed6\u70b9\u90fd\u5339\u914d\u6389\uff0c\u518d\u7528 $(x,y)$ \u5339\u914d\u6389 $x$\u3002\u4e8e\u662f\u6574\u4e2a\u8fde\u901a\u5757\u90fd\u53ef\u4ee5\u5339\u914d\u3002\n\n\u63a5\u4e0b\u6765\u518d\u5904\u7406\u5076\u6570\u957f\u5ea6\uff08\u540c\u65f6\u5339\u914d $u,v$ \u5219\u7b54\u6848 +1\uff09:\n\n\u5982\u679c $u,v$ \u5728\u4e0d\u540c\u7684\u4e24\u68f5\u6811\u4e2d\u5219\u53ef\u4ee5\u5339\u914d\u6389 $u,v$\uff0c\u7136\u540e\u4ee5 $u,v$ \u5f53\u6839\u628a\u6811\u91cc\u5176\u4ed6\u7684\u70b9\u90fd\u5339\u914d\u6389\u3002\n\n\u4e8e\u662f\u5bf9\u6bcf\u4e2a\u6811\u5efa\u4e00\u4e2a\u70b9\uff0c\u628a\u8fd9\u4e24\u68f5\u6811\u7684\u70b9\u8fde\u4e00\u6761\u8fb9\uff0c\u8dd1\u4e00\u822c\u56fe\u6700\u5927\u5339\u914d\uff0c\u6b64\u65f6\u70b9\u6570\u6700\u591a 600 \u53ef\u4ee5\u63a5\u53d7\u3002\n\n\u53ef\u4ee5\u7528\u5e76\u67e5\u96c6\u548c dfs \u7b80\u5355\u5b9e\u73b0\u8fd9\u4e2a\u8fc7\u7a0b\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define For(i,a,b) for( int i=(a);i<=(b);++i)\n#define Rep(i,a,b) for( int i=(a);i>=(b);--i)\nusing namespace std;\ninline int read()\n{\n    char c=getchar();int x=0;bool f=0;\n    for(;!isdigit(c);c=getchar())f^=!(c^45);\n    for(;isdigit(c);c=getchar())x=(x<<1)+(x<<3)+(c^48);\n    if(f)x=-x;return x;\n}\n\n#define fi first\n#define se second\n#define pb push_back\n#define mkp make_pair\ntypedef pair<int,int>pii;\ntypedef vector<int>vi;\n \n#define maxn 300005\n#define inf 0x3f3f3f3f\n\nnamespace wk{\n\nint n;\nvi e[maxn];\nvoid adde(int u,int v){e[u].pb(v),e[v].pb(u);}\nint q[maxn],hd,tl;\nint col[maxn],bel[maxn],pre[maxn],fa[maxn];\ninline int getf(int x){\n\twhile(x^fa[x])x=fa[x]=fa[fa[x]];\n\treturn x;\n}\n\nint tim,vis[maxn];\nint lca(int x,int y){\n\t++tim;\n\tx=getf(x),y=getf(y);\n\twhile(vis[x]!=tim){\n\t\tvis[x]=tim,x=getf(pre[bel[x]]);\n\t\tif(y)swap(x,y);\n\t}\n\treturn x;\n}\nvoid shrink(int x,int y,int p){\n\twhile(getf(x)!=p){\n\t\tpre[x]=y,y=bel[x];\n\t\tfa[x]=fa[y]=p;\n\t\tif(col[y]==2) col[y]=1,q[++tl]=y;\n\t\tx=pre[y];\n\t}\n}\nvoid link(int u,int v){bel[u]=v,bel[v]=u;}\nvoid pushr(int u){if(u)pushr(bel[pre[u]]),link(u,pre[u]);}\nbool work(int u)\n{\n\tFor(i,1,n)pre[i]=col[i]=0,fa[i]=i;\n\tcol[u]=1,q[hd=tl=1]=u; int p;\n\twhile(hd<=tl){\n\t\tint u=q[hd++];\n\t\tfor(auto v:e[u])\n\t\t\tif(col[v]==1)shrink(u,v,p=lca(u,v)),shrink(v,u,p);\n\t\t\telse if(col[v]==0){\n\t\t\t\tpre[v]=u,col[v]=2;\n\t\t\t\tif(!bel[v])return pushr(v),1;\n\t\t\t\tcol[bel[v]]=1,q[++tl]=bel[v];\n\t\t\t}\n\t}\n\treturn 0;\n}\nint run(){\n\tint res=0;\n\tFor(i,1,n)res+=(!bel[i]&&work(i));\n\treturn res;\n}\n\n}\n\nint n,tot,a[maxn],vis[maxn];\npii t[maxn]; int len;\n\nint fa[605],hav[605];\nint getf(int x){\n\twhile(x^fa[x])x=fa[x]=fa[fa[x]];\n\treturn x;\n}\nint id[605][605];\nvector<pii>e[605];\n\nvoid make(int i,int nd){\n\tint l=t[i].fi,r=t[i].se; vis[nd]=1;\n\tif(nd==a[l-1])a[l]=nd;\n\telse a[r]=nd;\n}\nvoid dfs(int u){\n\tfor(auto t:e[u]){\n\t\tint v=t.fi;\n\t\tif(!vis[v])make(t.se,v),dfs(v);\n\t}\n}\n\nbool use[maxn];\nsigned main()\n{\n\tn=read();\n\tbool hav=0;\n\tFor(i,1,n)a[i]=read(),hav|=(a[i]>0);\n\tif(!hav){\n\t\tFor(i,1,n)cout<<((i-1)/2)+1<<' ';\n\t\treturn 0;\n\t}\n\tFor(i,2,n)if(a[i]==a[i-1])vis[a[i]]=1;\n\tFor(i,1,n)\n\t\tif(!a[i]&&(i==1||a[i-1])){\n\t\t\tint l=i,r=i;\n\t\t\twhile(r<n&&!a[r+1])++r;\n\t\t\ti=r;\n\t\t\tif(l==1){if((r-l+1)&1)a[r]=a[r+1],vis[a[r]]=1;continue;}\n\t\t\tif(r==n){if((r-l+1)&1)a[l]=a[l-1],vis[a[l]]=1;continue;}\n\t\t\tt[++len]=mkp(l,r);\n\t\t}\n\tFor(i,1,600)fa[i]=i;\n\tFor(i,1,len){\n\t\tint l=t[i].fi,r=t[i].se;\n\t\tint u=a[l-1],v=a[r+1];\n\t\tif((r-l+1)%2!=0){\n\t\t\tif(vis[u])make(i,v),dfs(v);\n\t\t\telse if(vis[v])make(i,u),dfs(u);\n\t\t\telse if(getf(u)==getf(v))make(i,u),dfs(u);\n\t\t\telse e[u].pb(mkp(v,i)),e[v].pb(mkp(u,i)),fa[getf(u)]=getf(v);//cout<<\"merge \"<<u<<\" \"<<v<<endl;\n\t\t}\n\t}\n\tFor(i,1,len){\n\t\tint l=t[i].fi,r=t[i].se;\n\t\tint u=a[l-1],v=a[r+1];\n//\t\tcout<<\"l,r,u,v \"<<l<<\" \"<<r<<\" \"<<u<<\" \"<<v<<endl;\n\t\tif((r-l+1)%2==0){\n\t\t\tu=getf(u),v=getf(v);\n//\t\t\tcout<<\"U,V \"<<u<<\" \"<<v<<endl; \n\t\t\tif(u!=v&&!vis[u]&&!vis[v]&&!id[u][v])id[u][v]=id[v][u]=i,wk::adde(u,v);\n\t\t}\n\t}\n\twk::n=600,wk::run();\n\tFor(u,1,600)\n\t\tif(wk::bel[u]){\n\t\t//\tcout<<\"bel \"<<u<<\" \"<<wk::bel[u]<<endl;\n\t\t\tint v=wk::bel[u],tmp=id[u][v];\n\t\t\twk::bel[u]=wk::bel[v]=0;\n\t\t\tint x=a[t[tmp].fi-1],y=a[t[tmp].se+1];\n\t\t\tif(getf(x)!=u)swap(x,y);\n\t\t\tmake(tmp,x),make(tmp,y),dfs(x),dfs(y);\n\t\t}\n\tFor(u,1,600)\n\t\tif(!vis[u])vis[u]=1,dfs(u);\n\tFor(i,1,n)if(a[i])use[a[i]]=1;\n\tint now=1;\n\tFor(i,1,n){\n\t\tif(!a[i]){\n\t\t\twhile(use[now])++now;\n\t\t\ta[i]=now; if(!a[i+1])a[i+1]=now;\n\t\t\t++now;\n\t\t}\n\t\tprintf(\"%d \",a[i]);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1660820238,
        "uid": 151935,
        "name": "Rainbow_qwq",
        "ccfLevel": 0,
        "title": "CF1615G"
    },
    {
        "content": "# CF1615G Maximum Adjacent Pairs\n\n\u7ed9\u51fa $a_{1\\cdots n}$\uff0c\u8981\u628a\u5176\u4e2d\u6240\u6709\u7684 $0$ \u586b\u6210\u4e00\u4e2a $1\\sim n$ \u7684\u6574\u6570\uff0c\u6700\u5927\u5316\u4e0d\u540c\u76f8\u90bb\u76f8\u7b49\u7684\u5143\u7d20\u5bf9\u6570\n\n$0\\le a_i\\le \\min(n,600),2\\le n\\le 3\u00b710^5$\n\n---\n\n\u795e\u9898\uff0c\u8bbe $S=\\{a_i|a_i\\not=0\\}$\u3002\n\n#### fact 1\uff1a\n\n\u5bf9\u4e8e\u4e00\u6bb5\u957f\u5ea6\u4e3a $L$ \u7684\u6781\u957f\u8fde\u7eed\u7684 $0$\uff0c\u53ef\u4ee5\u5728\u5176\u4e2d\u586b\u6570\uff0c\u4f7f\u5f97\u8fd9\u4e00\u6bb5\u7684\u7b54\u6848\u4e3a $\\left\\lfloor \\dfrac{L}{2}\\right\\rfloor$\uff0c\u8fd9\u540c\u65f6\u4e5f\u53d6\u5230\u4e86\u4e0a\u754c\u3002\u540c\u65f6\uff0c\u5982\u679c\u6709\u591a\u6bb5\u6781\u957f\u7684 $0$ \u7684\u8bdd\uff0c\u5b83\u4eec\u5e76\u8d77\u6765\u7684\u7b54\u6848\u4e3a\u5b83\u4eec\u5404\u81ea\u7b54\u6848\u7684\u548c\u3002\n\n#### fact 2\uff1a\n\n\u6211\u4eec\u4e00\u5b9a\u53ea\u4f1a\u5728\u6781\u957f\u8fde\u7eed $0$ \u6bb5\u7684\u5de6\u53f3\u4e24\u4e2a\u7aef\u70b9\u5c06 $a_i$ \u5b9a\u6210\u4e00\u4e2a $S$ \u4e2d\u7684\u6570\uff0c\u5176\u4ed6\u5747\u4e0d\u4f1a\u3002\n\n\u5e76\u628a\u6781\u957f\u8fde\u7eed $0$ \u6bb5\u7684\u4e00\u4e2a\u7aef\u70b9\u5b9a\u6210\u4e00\u4e2a $S$ \u4e2d\u7684\u6570\u4ee5\u4ea7\u751f\u4e00\u4e2a \u76f8\u90bb\u76f8\u7b49\u5bf9 \u79f0\u4e3a \u5339\u914d\u8fd9\u4e2a\u7aef\u70b9\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u82e5 $[l,r]$ \u662f\u4e00\u4e2a\u6781\u957f\u8fde\u7eed $0$ \u6bb5\uff0c\u90a3\u4e48\u5339\u914d\u5b83\u7684\u7aef\u70b9\uff0c\u4e3a $a_l:=a_{l-1}$ \u6216 $a_r:=a_{r+1}$\u3002\n\n#### fact 3\uff1a\n\n\u5bf9\u4e8e\u4e00\u6bb5\u957f\u5ea6\u4e3a\u5076\u6570\u7684\u6781\u957f\u8fde\u7eed $0$ \u6bb5\uff0c\u8981\u4e48\u4e24\u7aef\u540c\u65f6\u5339\u914d\u4e0a\uff0c\u8981\u4e48\u4e24\u7aef\u90fd\u4e0d\u5339\u914d\u3002\n\n\u5bf9\u4e8e\u4e00\u6bb5\u957f\u5ea6\u4e3a\u5947\u6570\u7684\u6781\u957f\u8fde\u7eed $0$ \u6bb5\uff0c\u6070\u597d\u53ea\u4f1a\u5728\u4e00\u4e2a\u7aef\u70b9\u5339\u914d\u4e0a\u3002\n\n\u901a\u8fc7\u4e00\u6bb5\u6781\u957f\u8fde\u7eed $0$ \u6bb5\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5bb9\u6613\u8bf4\u660e\u3002\n\n\n\n\u63a5\u4e0b\u6765\u5f15\u51fa\u5efa\u56fe\u65b9\u6cd5\uff1a\n\n\u5148\u5bf9\u4e8e $S$ \u4e2d\u7684\u6bcf\u4e00\u79cd\u6570\u5b57\u5efa\u51fa\u4e00\u4e2a\u70b9\u8868\u793a\u8fd9\u79cd\u6570\u3002\n\n- 1\u3001\u5bf9\u4e8e\u4e00\u4e2a\u6570 $k(k\\not=0)$\uff0c\u82e5\u5df2\u6709\u4e00\u4e2a $i\\in[1,n)$ \u6ee1\u8db3 $a_i=a_{i+1}=k$\uff0c\u5219\u6dfb\u52a0\u4e00\u4e2a\u9644\u52a0\u70b9\uff0c\u4e0e $k$ \u5bf9\u5e94\u7684\u70b9\u8fde\u4e00\u6761\u65e0\u5411\u8fb9\u3002\n\n- 2\u3001\u5bf9\u4e8e\u4e00\u4e2a\u957f\u5ea6\u4e3a\u5076\u6570\u7684\u6781\u957f\u8fde\u7eed $0$ \u6bb5 $[l,r]$\uff0c\u5982\u679c $l\\not=1,r\\not=n,a_{l-1}\\not=a_{r+1}$\uff0c\u90a3\u4e48\u5728 $a_{l-1}$ \u4e0e $a_{r+1}$ \u5bf9\u5e94\u7684\u70b9\u95f4\u8fde\u4e00\u6761\u65e0\u5411\u8fb9\u3002\n\n- 3\u3001\u5bf9\u4e8e\u4e00\u4e2a\u957f\u5ea6\u4e3a\u5947\u6570\u7684\u6781\u957f\u8fde\u7eed $0$ \u6bb5 $[l,r]$\uff0c\u6dfb\u52a0\u4e00\u4e2a\u9644\u52a0\u70b9\uff0c\u82e5 $l\\not=1$\uff0c\u90a3\u4e48\u5728\u9644\u52a0\u70b9\u4e0e $a_{l-1}$ \u95f4\u8fde\u4e00\u6761\u65e0\u5411\u8fb9\uff0c\u82e5 $r\\not=n$\uff0c\u90a3\u4e48\u5728\u9644\u52a0\u70b9\u4e0e $a_{r+1}$ \u95f4\u8fde\u4e00\u6761\u65e0\u5411\u8fb9\u3002\n\n\n\n\u5728\u8fd9\u4e2a\u56fe\u4e0a\u6c42\u51fa\u6700\u5927\u5339\u914d\u5373\u53ef\u5f97\u5230\u6240\u6709\u6781\u957f\u8fde\u7eed $0$ \u6bb5\u4e24\u4e2a\u7aef\u70b9\u7684\u786e\u5b9a\u60c5\u51b5\uff0c\u518d\u586b\u4e0a\u5269\u4e0b\u7684 $0$\uff08\u4e24\u4e2a\u4e00\u7ec4\u5730\u586b\uff09\u5373\u53ef\u5f97\u5230\u7b54\u6848\u3002\n\n\u5728\u8fd9\u4e2a\u56fe\u4e0a\u6c42\u6700\u5927\u5339\u914d\u7684\u610f\u4e49\u4e3a\uff1a\n\n\u82e5\u5339\u914d\u4e0a\u4e86\u4e00\u6761 $1$ \u7c7b\u8fb9\uff0c\u90a3\u4e48\u5c06\u4e0d\u4f1a\u5bf9\u4efb\u4f55\u6781\u957f\u8fde\u7eed $0$ \u6bb5\u7684\u7aef\u70b9\u4ea7\u751f\u5f71\u54cd\u3002\n\n\u82e5\u5339\u914d\u4e0a\u4e86\u4e00\u6761 $2$ \u7c7b\u8fb9\uff0c\u90a3\u4e48\u5c06\u5bf9\u8fd9\u6bb5 $0$ \u7684\u5de6\u53f3\u4e24\u4e2a\u7aef\u70b9\u8d4b\u503c\uff0c\u4f1a\u5bf9\u7b54\u6848\u4ea7\u751f $(a_{l-1},a_l)$ \u4e0e $(a_{r},a_{r+1})$ \u4e24\u5bf9\u7684\u8d21\u732e\uff0c\u540c\u65f6\u7531\u4e8e\u8fd9\u6bb5 $0$ \u7684\u5de6\u53f3\u4e24\u4e2a\u7aef\u70b9\u88ab\u5360\u53bb\u4e86\uff0c\u56e0\u6b64\u672c\u8eab\u7684 $\\left\\lfloor \\dfrac{L}{2}\\right\\rfloor$ \u5c06\u4f1a\u51cf\u5c11 $1$\uff0c\u4e00\u6765\u4e00\u53bb\u4f1a\u5bf9\u7b54\u6848\u591a\u51fa $1$ \u7684\u8d21\u732e\uff0c\u5bf9\u5e94\u7740\u6700\u5927\u5339\u914d\u4e2d\u8fd9\u6761\u8fb9\u7684\u8d21\u732e\u3002\n\n\u5bf9\u4e8e $3$ \u7684\u60c5\u51b5\uff0c\u65e0\u975e\u662f\u6709 $3$ \u79cd\uff1a\n\n- \u9644\u52a0\u70b9\u548c\u5de6\u53f3\u4e24\u8fb9\u90fd\u6ca1\u6709\u5339\u914d\uff0c\u8fd9\u662f\u4e0d\u4f1a\u5bf9\u8fd9\u6bb5\u6781\u957f\u8fde\u7eed $0$ \u6bb5\u7684\u7aef\u70b9\u4ea7\u751f\u5f71\u54cd\u3002\n- \u9644\u52a0\u70b9\u548c $a_{l-1}$ \u5339\u914d\uff0c\u8868\u793a\u5c06\u8fd9\u6bb5 $0$ \u7684\u5de6\u7aef\u70b9\u8d4b\u503c\u3002\n- \u9644\u52a0\u70b9\u548c $a_{r+1}$ \u5339\u914d\uff0c\u8868\u793a\u5c06\u8fd9\u6bb5 $0$ \u7684\u53f3\u7aef\u70b9\u8d4b\u503c\n\n\u540c\u7406\uff0c\u8fd9\u6bb5 $0$ \u7684\u672c\u8eab $\\left\\lfloor \\dfrac{L}{2}\\right\\rfloor$ \u7684\u503c\u5c06\u4e0d\u4f1a\u53d8\u5316\uff08$L$ \u4e3a\u5947\u6570\uff0c\u51cf\u53bb $1$ \u4e4b\u540e\u503c\u4e0d\u53d8\uff09\uff0c\u591a\u4e86\u5de6\u7aef\u70b9\u6216\u53f3\u7aef\u70b9\u7684\u4e00\u5bf9\uff0c\u5bf9\u7b54\u6848\u589e\u52a0\u4e86 $1$ \u7684\u8d21\u732e\uff0c\u5bf9\u5e94\u7740\u6700\u5927\u5339\u914d\u4e2d\u8fd9\u6761\u8fb9\u7684\u8d21\u732e\u3002\n\n\n\n\u7136\u540e\u662f\u8981\u6c42\u51fa\u8fd9\u4e2a\u56fe\u7684\u6700\u5927\u5339\u914d\uff0c\u6807\u51c6\u7b97\u6cd5\u662f\u5e26\u82b1\u6811\uff0c\u4f46\u4f7f\u7528\u8d77\u6765\u6709\u70b9\u95ee\u9898\uff1a\n\n\u8fd9\u4e2a\u56fe\u7684\u70b9\u6570\u662f\u53ef\u4ee5\u8fbe\u5230 $O(n+\\max\\{a_i\\})$ \u7684\uff0c\u56e0\u4e3a\u957f\u4e3a\u5947\u6570\u7684\u6781\u957f\u8fde\u7eed $0$ \u6bb5\u4f1a\u52a0\u4e00\u4e2a\u9644\u52a0\u70b9\u3002\n\n~~\u7136\u540e\u6709\u4e2a\u8001\u54e5\u76f4\u63a5\u5728\u8fd9\u4e2a\u56fe\u4e0a\u8dd1\u968f\u673a\u5316\u5308\u7259\u5229\u7b97\u6cd5\u8fc7\u4e86~~\uff0c\u968f\u673a\u5316\u5308\u7259\u5229\u7b97\u6cd5\u53c2\u89c1 [https://bzoj.blog.uoj.ac/blog/2427](https://bzoj.blog.uoj.ac/blog/2427)\uff0c\u6211\u8868\u793a\u4e0d\u662f\u5f88\u7406\u89e3\u4e3a\u4ec0\u4e48\u4ed6\u4e0d\u4f1a TLE\u3002\n\n\u56e0\u6b64\u6211\u4eec\u9700\u8981\u51cf\u5c11\u8fd9\u4e2a\u56fe\u7684\u8282\u70b9\u4e2a\u6570\u89c4\u6a21\u3002\n\n\u5bb9\u6613\u53d1\u73b0\uff0c\u7531\u4e8e $a_i$ \u672c\u8eab\u662f\u975e\u5e38\u5c0f\u7684\uff0c\u56e0\u6b64\u5bf9\u4e8e\u9644\u52a0\u70b9\u6765\u8bf4\uff0c\u6709\u76f8\u5f53\u591a\u662f\u6ca1\u6709\u7528\u7684\uff0c\u4e8e\u662f\u5f15\u51fa\u4e86\u5982\u4e0b\u7f29\u51cf\u7b97\u6cd5\uff1a\n\n- \u5ffd\u7565\u6240\u6709\u7684 $2$ \u7c7b\u8fb9\uff0c\u8fd9\u4e9b\u8fb9\u662f $a_i$ \u5185\u90e8\u8fde\u8fb9\uff0c\u5219\u5269\u4e0b\u8fd9\u4e2a\u56fe\u53ef\u4ee5\u5206\u6210 $S$ \u4e2d\u7684\u70b9\u4e0e\u9644\u52a0\u70b9\u4e24\u4e2a\u90e8\u5206\uff0c\u5f62\u6210\u4e00\u4e2a\u4e8c\u5206\u56fe\uff0c\u5728\u8fd9\u4e2a\u4e8c\u5206\u56fe\u4e0a\u8dd1\u6700\u5927\u5339\u914d\uff0c\u62ff\u51fa\u5339\u914d\u4e0a\u7684\u9644\u52a0\u70b9\uff0c\u628a\u8fd9\u4e9b\u70b9\u548c $S$ \u4e2d\u7684\u70b9\u653e\u4e00\u8d77\uff0c\u52a0\u4e0a $2$ \u7c7b\u8fb9\u8dd1\u4e00\u822c\u56fe\u6700\u5927\u5339\u914d\u5373\u53ef\u3002\u8fd9\u6837\u505a\u7684\u6b63\u786e\u6027\u662f\u56e0\u4e3a\u4e0d\u53ef\u80fd\u6709\u589e\u5e7f\u8def\u4ece\u672a\u5728\u4e8c\u5206\u56fe\u6700\u5927\u5339\u914d\u4e2d\u51fa\u73b0\u7684\u8282\u70b9\u51fa\u53d1\u3002\u4e8e\u662f\u8fd9\u6837\u56fe\u7684\u89c4\u6a21\u5c31\u88ab\u7f29\u51cf\u5230 $O(\\max\\{a_i\\})$ \u4e86\u3002\n\n\u7136\u540e\u5728\u8fd9\u4e2a\u56fe\u4e0a\u8dd1\u5e26\u82b1\u6811\u5c31\u53ef\u4ee5\u4e86\uff0c\u590d\u6742\u5ea6\u4e3a $O(\\max\\{a_i\\}^3)$\u3002\n\n~~\u7136\u540e\u6211\u4e0d\u4f1a\u5e26\u82b1\u6811\u4e8e\u662f\u4e5f\u7528\u968f\u673a\u5316\u5308\u7259\u5229\u8fc7\u4e86\uff0c\u8dd1\u5f97\u8fd8\u6bd4\u4e0a\u9762\u90a3\u8001\u54e5\u5feb~~\u3002\n\n```cpp\nbool dfs1(int u){\n\tfor (int v:G1[u])\n\t\tif (!used[v]){\n\t\t\tused[v]=1;\n\t\t\tif (!match[v] || dfs1(match[v])) return match[v]=u,1;\n\t\t}\n\treturn 0;\n}\nbool dfs2(int u){\n\tused[u]=1;\n\trandom_shuffle(G2[u].begin(),G2[u].end());\n\tfor (int v:G2[u]){\n\t\tint x=cor[v];\n\t\tif (used[x]) continue;\n\t\tcor[u]=v; cor[v]=u; cor[x]=0;\n\t\tif (!x || dfs2(x)) return 1;\n\t\tcor[v]=x; cor[x]=v; cor[u]=0;\n\t}\n\treturn 0;\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor (int i=1; i<=n; i++){\n\t\tscanf(\"%d\",&a[i]); B=max(B,a[i]); vis[a[i]]=1;\n\t\tif (i>1 && a[i]==a[i-1] && a[i]) vld[a[i]]=1;\n\t}\n\tif (!B){\n\t\tfor (int i=1; i<=n; i++) printf(\"%d \",(i+1)/2);\n\t\treturn puts(\"\"),0;\n\t}\n\tfor (int i=1; i<=n; i++)\n\t\tif (!vis[i]) sp[++len]=i;\n\tsiz=tot=B; int lst=0;\n\tfor (int i=1; i<=B; i++)\n\t\tif (vld[i]) siz++,G1[i].push_back(siz),G1[siz].push_back(i);\n\twhile (lst<=n){\n\t\tint now=lst+1;\n\t\twhile (now<=n && a[now]) now++; lst=now;\n\t\twhile (lst+1<=n && !a[lst+1]) lst++;\n\t\tif (now<=n && lst<=n){\n\t\t\tif ((lst-now+1)%2==0){\n\t\t\t\tif (lst==n || now==1 || a[lst+1]==a[now-1]) continue;\n\t\t\t\tcntL++; L[cntL]=now,R[cntL]=lst;\n\t\t\t} else {\n\t\t\t\tsiz++; cntL++; fir[cntL]=siz; L[cntL]=now,R[cntL]=lst;\n\t\t\t\tif (now!=1) G1[a[now-1]].push_back(siz),G1[siz].push_back(a[now-1]);\n\t\t\t\tif (lst!=n) G1[a[lst+1]].push_back(siz),G1[siz].push_back(a[lst+1]);\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i=1; i<=B; i++)\n\t\tmemset(used,0,sizeof(used)),dfs1(i);\n\tfor (int i=B+1; i<=siz; i++)\n\t\tif (match[i]){\n\t\t\tsec[i]=++tot;\n\t\t\tfor (int u:G1[i]) G2[u].push_back(tot),G2[tot].push_back(u);\n\t\t}\n\tfor (int i=1; i<=cntL; i++){\n\t\tif ((R[i]-L[i]+1)&1) continue;\n\t\tint mn=min(a[L[i]-1],a[R[i]+1]),mx=max(a[L[i]-1],a[R[i]+1]);\n\t\tif (!rec[mn][mx]) rec[mn][mx]=i,G2[mn].push_back(mx),G2[mx].push_back(mn);\n\t}\n\tfor (int o=1; o<=4; o++){\n\t\tfor (int i=1; i<=tot; i++)\n\t\t\tif (!cor[i]){\n\t\t\t\tfor (int j=1; j<=tot; j++) used[j]=0;\n\t\t\t\tdfs2(i);\n\t\t\t}\n\t\tint k=0;\n\t\tfor (int i=1; i<=tot; i++) k+=(cor[i]!=0);\n\t\tif (k>res){\n\t\t\tres=k;\n\t\t\tfor (int i=1; i<=tot; i++) ans[i]=cor[i];\n\t\t}\n\t}\n\tfor (int i=1; i<=B; i++)\n\t\tif (i+1<=ans[i] && ans[i]<=B){\n\t\t\tint k=rec[i][ans[i]];\n\t\t\ta[L[k]]=a[L[k]-1],a[R[k]]=a[R[k]+1];\n\t\t}\n\tfor (int i=1; i<=cntL; i++){\n\t\tif ((R[i]-L[i]+1)%2==0) continue;\n\t\tint p=sec[fir[i]];\n\t\tif (!p) continue;\n\t\tif (L[i]!=1 && ans[p]==a[L[i]-1]) a[L[i]]=a[L[i]-1];\n\t\telse if (R[i]!=n && ans[p]==a[R[i]+1]) a[R[i]]=a[R[i]+1];\n\t}\n\tint cur=0;\n\tfor (int i=1; i<=n; i++)\n\t\tif (i!=n && !a[i] && !a[i+1]) a[i]=a[i+1]=sp[++cur];\n\t\telse if (!a[i]) a[i]=1;\n\tfor (int i=1; i<=n; i++) printf(\"%d \",a[i]);\n\treturn puts(\"\"),0;\n}\n```\n",
        "postTime": 1646445228,
        "uid": 44599,
        "name": "wishapig",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1615G Maximum Adjacent Pairs"
    },
    {
        "content": "\u4e00\u79cd\u4e71\u641e\u505a\u6cd5\u3002\n\n\u5982\u679c\u6709\u4e00\u79cd\u6743\u503c\u5df2\u7ecf\u5728\u539f\u5e8f\u5217\u4e2d\u51fa\u73b0\u76f8\u90bb\u5bf9\u4e86\uff0c\u76f4\u63a5\u5ffd\u7565\u5b83\u5e76\u628a\u5b83\u51fa\u73b0\u7684\u6240\u6709\u4f4d\u7f6e\u8bbe\u4e3a -1\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u8003\u5bdf\u6240\u6709\u6781\u957f\u7684\u5168 0 \u6bb5\u3002\u5047\u8bbe\u67d0\u4e00\u6bb5\u957f\u5ea6\u4e3a $L$\uff0c\u5b83\u4e24\u7aef\u7684 0 \u90fd\u53ef\u4ee5\u4e0e\u4e24\u8fb9\u63a5\u58e4\u7684\u975e 0 \u6570\u5339\u914d\uff08\u5982\u679c\u4e0d\u662f -1 \u7684\u8bdd\uff09\u3002\u8fd9\u5f15\u5bfc\u6211\u4eec\uff0c\u628a\u95ee\u9898\u770b\u6210\u662f\u4f4d\u7f6e\u548c\u6743\u503c\u5339\u914d\uff0c\u7528\u56fe\u7684\u5339\u914d\u7b97\u6cd5\u89e3\u51b3\u8be5\u9898\u3002\n\n\u5982\u679c\u67d0\u4e00\u6bb5\u5339\u914d\u4e86 $k\\ (0\\le k\\le 2)$ \u4e2a\u7aef\u70b9\uff0c\u5b83\u5185\u90e8\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u663e\u7136\u662f $\\dfrac{L-k}{2}$ \u4e0b\u53d6\u6574\u3002\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n- $L$ \u662f\u5947\u6570\uff0c\u5219\u5982\u679c\u4e24\u4e2a\u7aef\u70b9\u90fd\u914d\uff0c\u81ea\u5df1\u7684\u5185\u90e8\u8d21\u732e\u4f1a\u51cf\u5c11 1\uff0c\u5426\u5219\u4e0d\u4f1a\u51cf\u5c11\u3002\n- $L$ \u662f\u5076\u6570\uff0c\u53ea\u8981\u81f3\u5c11\u914d\u4e86\u4e00\u4e2a\u7aef\u70b9\uff0c\u5185\u90e8\u8d21\u732e\u5c31\u4f1a\u51cf\u5c11 1\u3002\n\n\u8003\u8651\u628a\u201c\u5185\u90e8\u8d21\u732e\u80fd\u4e0d\u80fd**\u4e0d**\u51cf\u5c11 1\uff1f\u201d\u4e5f\u653e\u5230\u56fe\u4e0a\u6765\uff1a\u5982\u679c\u53ef\u4ee5\u4e0d\u51cf\u5c11 1\uff0c\u6211\u4eec\u5c31\u8ba9\u56fe\u4e0a\u591a\u4e00\u4e2a\u5339\u914d\u3002\u636e\u6b64\u5f97\u51fa\u5efa\u56fe\u3002\n\n- \u5bf9\u6bcf\u4e2a\u989c\u8272\u5efa\u70b9\uff0c\u5bf9\u6bcf\u4e2a\u5168 0 \u6bb5\u7684\u5de6\u53f3\u7aef\u70b9\u4f4d\u7f6e\u5efa\u70b9\u3002\n- \u5bf9\u6bcf\u4e2a\u5168 0 \u6bb5\uff0c\u5047\u8bbe\u5de6\u53f3\u63a5\u58e4\u7684\u989c\u8272\u5206\u522b\u4e3a $x,y$\uff0c\u5de6\u53f3\u7aef\u70b9\u7684\u4f4d\u7f6e\u5206\u522b\u4e3a $l,r$\uff0c\u5728 $x,l$\uff0c$y,r$ \u4e4b\u95f4\u8fde\u8fb9\u3002\n- \u5bf9\u6bcf\u4e2a\u957f\u5ea6\u4e3a\u5947\u6570\u7684\u5168 0 \u6bb5\uff0c\u5efa\u865a\u70b9 $p$\uff0c\u5728 $p,l$\uff0c$p,r$ \u4e4b\u95f4\u8fde\u8fb9\uff08\u53ea\u8981 $l,r$ \u6709\u4e00\u4e2a\u6ca1\u5339\u914d\uff0c\u8fd9\u4e00\u6bb5\u5185\u90e8\u8d21\u732e\u5c31\u53ef\u4ee5\u4e0d\u51cf\u5c11\uff09\n- \u5bf9\u6bcf\u4e2a\u957f\u5ea6\u4e3a\u5076\u6570\u7684\u5168 0 \u6bb5\uff0c\u5728 $l,r$ \u4e4b\u95f4\u8fde\u8fb9\uff08\u53ea\u8981 $l,r$ \u5b58\u5728\u4e00\u4e2a\u5339\u914d\uff0c\u8fd9\u4e00\u6bb5\u5185\u90e8\u8d21\u732e\u5c31\u5fc5\u987b\u51cf\u5c11\uff09\n\n\u7136\u800c\uff0c\u8fd9\u6837\u5efa\u56fe\u6709 $O(n)$ \u6761\u8fb9\u3001$O(n)$ \u4e2a\u70b9\uff0c\u5e26\u82b1\u6811\u590d\u6742\u5ea6\u662f $O(nm)$\uff0c\u4e0d\u80fd\u901a\u8fc7\u3002\n\n~~\u542c\u8bf4\u5b9e\u9645\u4e0a\u968f\u673a\u5308\u7259\u5229\u76f4\u63a5\u8279\u8fc7\u53bb\u4e86~~\n\n\u8003\u8651\u4e00\u79cd\u4e71\u641e\uff0c\u5bf9\u4e8e\u6bcf\u79cd\u989c\u8272\uff0c\u53ea\u4fdd\u7559\u4e0e\u5176\u63a5\u58e4\u7684\u5168 0 \u5076\u6bb5\u548c\u5168 0 \u5947\u6bb5\u5404 $B$ \u4e2a\uff0c\u56e0\u4e3a\u5982\u679c\u6bcf\u79cd\u989c\u8272\u90fd\u4e0e\u5f88\u591a\u6bb5\u63a5\u58e4\uff0c\u90a3\u5f88\u591a\u6bb5\u90fd\u7528\u4e0d\u5230\uff0c\u5f88\u96be\u5bf9\u7b54\u6848\u9020\u6210\u8d21\u732e\u3002\n\n\u52a0\u5165\u8be5\u526a\u679d\u540e\uff0c\u8bbe\u989c\u8272\u6570\u4e3a $c$\uff0c\u53ea\u5269\u4e0b $O(cB)$ \u6761\u8fb9\u3001$O(cB)$ \u4e2a\u70b9\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O((cB)^2)$\u3002\n\n\u7ecf\u8fc7\u8bd5\u9a8c\uff0c\u53d6 $B=4$ \u53ef\u4ee5\u901a\u8fc7\u3002\n\n\u4ee3\u7801\uff08\u4ee3\u7801\u91cc\u7684 $B$ \u662f\u771f\u5b9e\u7684 $B$ \u51cf\u4e00\uff09\uff1ahttps://codeforces.ml/problemset/submission/1615/150703648",
        "postTime": 1648122627,
        "uid": 42156,
        "name": "feecle6418",
        "ccfLevel": 0,
        "title": "CF1615G Maximum Adjacent Pairs \u4e71\u641e\u505a\u6cd5"
    }
]
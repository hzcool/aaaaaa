[
    {
        "content": "> [CF566C Logistical Questions](https://codeforces.com/contest/566/problem/C)\n\n## \u9898\u610f\n\n- \u4e00\u68f5 $n$ \u4e2a\u8282\u70b9\u7684\u6811\uff0c\u70b9\u6709\u70b9\u6743\uff0c\u8fb9\u6709\u8fb9\u6743\u3002\n- \u4e24\u70b9\u95f4\u7684\u8ddd\u79bb\u5b9a\u4e49\u4e3a\u4e24\u70b9\u95f4\u8fb9\u6743\u548c\u7684 $\\frac 32$ \u6b21\u65b9\u3002\n- \u6c42\u8fd9\u68f5\u6811\u7684\u5e26\u6743\u91cd\u5fc3\u3002\n- $n \\le 2 \\times 10^5$\u3002\n\n## \u9898\u89e3\n\n\u8bbe $d(x,y)$ \u4e3a $x,y$ \u7684\u8ddd\u79bb\uff0c\u5373 $\\text{dist}(x,y)^{\\frac 32}$\uff0c**\u5728\u8fd9\u91cc\uff0c\u6211\u4eec\u4e0d\u8981\u6c42 $x,y$ \u4e3a\u6811\u4e2d\u7684\u8282\u70b9\uff0c\u5373 $x,y$ \u4e5f\u53ef\u4ee5\u4e3a\u67d0\u6761\u8fb9\u4e2d\u7684\u70b9**\u3002\n\n\u9996\u5148\u53ef\u4ee5\u6ce8\u610f\u5230\uff0c\u5bf9\u4e8e\u6811\u4e0a\u7684\u4efb\u610f\u4e00\u6761\u8def\u5f84 $[a,b]$\uff0c\u82e5\u70b9 $x \\in [a,b]$\uff0c\u5219\u5bf9\u4e8e\u4e00\u4e2a\u70b9 $i$\uff0c$d(x,i)$ \u662f\u4e00\u4e2a\u4e0b\u51f8\u51fd\u6570\u3002\n\n\u8bbe $f(x) = \\sum_{i=1}^n d(x,i)$\uff0c\u7531\u4e8e\u51f8\u51fd\u6570\u4e4b\u548c\u4ecd\u4e3a\u51f8\u51fd\u6570\uff0c\u56e0\u6b64 $f(x)$ \u4ecd\u662f\u4e00\u4e2a\u4e0b\u51f8\u51fd\u6570\u3002\n\n\u56e0\u6b64\uff0c**\u6574\u68f5\u6811\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a\u70b9 $x$ \u80fd\u53d6\u5230 $f(x)$ \u7684\u6700\u5c0f\u503c\uff0c\u4e14\u4ece\u8fd9\u4e2a\u70b9\u5411\u5916 $f(x)$ \u9010\u6e10\u53d8\u5927**\u3002\n\n\u5982\u679c\u6811\u9000\u5316\u4e3a\u4e00\u6761\u94fe\uff0c\u5219\u53ef\u4ee5\u4e8c\u5206 $x$\u3002\u5f53\u8fd8\u539f\u5230\u6811\u4e0a\uff0c\u540c\u7406\u53ef\u4ee5**\u70b9\u5206\u6cbb**\u627e\u5230 $x$\u3002\n\n\u70b9\u5206\u6cbb\u5230\u67d0\u4e2a\u70b9 $x$ \u65f6\uff0c\u9996\u5148\u7528 $x$ \u66f4\u65b0\u7b54\u6848\uff0c\u7136\u540e\u627e\u5230\u80fd\u4f7f $f(x)$ \u53d8\u5c0f\u7684\u5b50\u6811\u7ee7\u7eed\u70b9\u5206\u3002\u6839\u636e\u521a\u624d\u7684\u8ba8\u8bba\uff0c\u8fd9\u6837\u7684\u5b50\u6811\u6700\u591a\u53ea\u6709\u4e00\u4e2a\u3002\n\n\u5982\u4f55\u627e\u5230\u8fd9\u4e2a\u5b50\u6811\u5462\uff1f\u5982\u679c\u6bcf\u4e2a\u5b50\u6811\u66b4\u529b\u8ba1\u7b97\u4e00\u904d $f(x)$ \u80af\u5b9a\u4e0d\u884c\u3002\n\n\u8003\u8651**\u6c42\u5bfc**\u3002\u8bbe $x$ \u5171\u6709 $k$ \u4e2a\u5b50\u6811\uff0c\u7b2c $i$ \u4e2a\u5b50\u6811\u7684\u6839\uff08\u5373 $x$ \u7684\u7b2c $i$ \u4e2a\u513f\u5b50\uff09\u4e3a $t_i$\uff0c\u8fd9\u4e2a\u5b50\u6811\u4e2d\u6240\u6709\u9879\u7684\u5bfc\u6570\u548c\u4e3a $p_i$\u3002\n\n\u5219\u4ece $x$ \u5411 $t_i$ \u79fb\u52a8\u65f6 $f(x)$ \u7684\u5bfc\u6570\u4e3a $\\sum_{j=1}^k p_j - 2p_i$\uff0c\u627e\u5230\u8fd9\u4e2a\u503c\u4e3a\u8d1f\u6570\u7684\u5b50\u6811\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n \\log n)$\u3002\n\n## \u4ee3\u7801\n\n```cpp\nconst int N = 2e5 + 7;\nint n, w[N], s[N], rt, v[N], ans1;\nvector< pi > e[N];\ndouble sum, sd, d[N], ans2 = 1e20;\n\nvoid dfs(int x, int f, int S) {\n\ts[x] = 1;\n\tint o = 0;\n\tfor (ui i = 0; i < e[x].size(); i++) {\n\t\tint y = e[x][i].fi;\n\t\tif (v[y] || y == f) continue;\n\t\tdfs(y, x, S), s[x] += s[y], o = max(o, s[y]);\n\t}\n\to = max(o, S - s[x]);\n\tif (o <= (S >> 1)) rt = x;\n}\n\nvoid calc(int x, int f, int o, int z) {\n\tsum += pow(z, 1.5) * w[x], d[o] += pow(z, 0.5) * 1.5 * w[x];\n\tfor (ui i = 0; i < e[x].size(); i++) {\n\t\tint y = e[x][i].fi;\n\t\tif (y == f) continue;\n\t\tcalc(y, x, o, z + e[x][i].se);\n\t}\n}\n\nvoid dfs(int x, int S) {\n\tdfs(x, 0, S), x = rt, dfs(x, 0, S);\n\tif (v[x]) return;\n\tv[x] = 1, sum = sd = 0;\n\tfor (ui i = 0; i < e[x].size(); i++) {\n\t\tint y = e[x][i].fi;\n\t\td[y] = 0, calc(y, x, y, e[x][i].se), sd += d[y];\n\t}\n\tif (sum < ans2) ans1 = x, ans2 = sum;\n\tfor (ui i = 0; i < e[x].size(); i++) {\n\t\tint y = e[x][i].fi;\n\t\tif (sd - d[y] * 2 >= 0) continue;\n\t\tdfs(y, s[y]);\n\t\tbreak;\n\t}\n}\n\nint main() {\n\trd(n);\n\tfor (int i = 1; i <= n; i++) rd(w[i]);\n\tfor (int i = 1, x, y, z; i < n; i++) rd(x), rd(y), rd(z), e[x].pb(mp(y, z)), e[y].pb(mp(x, z));\n\tdfs(1, n);\n\tprintf(\"%d %.10f\\n\", ans1, ans2);\n\treturn 0;\n}\n```",
        "postTime": 1575093067,
        "uid": 100544,
        "name": "xht",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF566C \u3010Logistical Questions\u3011"
    },
    {
        "content": "### CF 566C\n#### Solution\n\u5047\u8bbe\u73b0\u5728\u91cd\u5fc3\u4e3a$u$\uff0c\u8003\u8651\u5411$v$\u79fb\u52a8\u4f1a\u4e0d\u4f1a\u66f4\u4f18\u3002\n\n\u8bbe\u73b0\u5728\u91cd\u5fc3\u5728$(u,v)$\u8fd9\u6761\u8fb9\u4e0a\uff0c\u79bb$u$\u7684\u8ddd\u79bb\u4e3a$x$\uff0c\u90a3\u4e48\u6743\u503c\u4e3a\n$$\n\\begin{aligned}\n\\sum_{i\\notin tree_v} a_i(d_i+x)^{3\\over 2}+\\sum_{i\\in tree_v} a_i(d_i-x)^{3\\over 2}\n\\end{aligned}\n$$\n\u6c42\u5bfc\u4e4b\u540e\u53ef\u5f97\n$$\n\\begin{aligned}\n\\sum_{i\\notin tree_v} {3\\over 2}a_i(d_i+x)^{1\\over 2}-\\sum_{i\\in tree_v} {3\\over 2}a_i(d_i-x)^{1\\over 2}\n\\end{aligned}\n$$\n\u53ea\u9700\u5224\u65ad\u4e00\u4e0b\u6b64\u65f6\u662f\u5426\u6709$v$\u6ee1\u8db3\u5bfc\u6570\u5927\u4e8e$0$\u5373\u53ef\uff0c\u82e5\u6709\u5219\u5f80$v$\u79fb\u52a8\uff0c\u4f46\u8fd9\u6837\u505a\u7684\u590d\u6742\u5ea6\u662f$\\mathcal O(n^2)$\u7684\uff0c\u65e0\u6cd5\u901a\u8fc7\u3002\n\n\u4e0d\u96be\u53d1\u73b0\u6211\u4eec\u6bcf\u6b21\u53ef\u4ee5\u4ee5\u70b9\u5206\u6cbb\u7684\u91cd\u5fc3\u4f5c\u4e3a$u$\u6765\u8fdb\u884c\u4e0a\u9762\u7684\u8fc7\u7a0b\uff0c\u8fd9\u6837\u6700\u591a\u53ea\u4f1a\u79fb\u52a8$\\mathcal O(\\log)$\u6b21\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$\\mathcal O(n\\log n)$\n\n#### Code\n```cpp\nint n,rt,totsize,root;\nint size[MAXN],maxpart[MAXN],a[MAXN],vis[MAXN];\ndouble sum1,sum2,ans = 1e20;\ndouble f[MAXN];\nvector<pii> G[MAXN];\n\nvoid GetRoot(int u,int fa){\n    size[u] = 1; maxpart[u] = 0;\n    for(auto p : G[u]){\n        int v = p.first; \n        if(v == fa || vis[v]) continue;\n        GetRoot(v,u); size[u] += size[v];\n        checkMax(maxpart[u],size[v]);\n    }\n    checkMax(maxpart[u],totsize - maxpart[u]);\n    if(maxpart[u] < maxpart[rt]) rt = u;\n}\n\nvoid calc(int u,int fa,int x,int dep){\n    sum1 += (double)a[u] * dep * sqrt(dep); \n    sum2 += (double)a[u] * sqrt(dep) * 3 / 2;\n    f[x] += (double)a[u] * sqrt(dep) * 3 / 2;\n    for(auto p : G[u]){\n        int v = p.first; \n        if(v == fa) continue;\n        calc(v,u,x,dep + p.second);\n    }\n}\n\nvoid dfs(int u){\n    if(vis[u]) return;\n    vis[u] = 1; sum1 = sum2 = 0;\n    for(auto p : G[u]){\n        int v = p.first; f[v] = 0;\n        calc(v,u,v,p.second);\n    }\n    if(sum1 < ans) ans = sum1, root = u;\n    for(auto p : G[u]){\n        int v = p.first;\n        if(sum2 - f[v] * 2 < 0){\n            totsize = size[v]; rt = 0;\n            GetRoot(v,u); dfs(rt); break;\n        }\n    }\n}\n\nvoid add_edge(int u,int v,int w) {G[u].push_back(make_pair(v,w));}\n\nint main(){\n    scanf(\"%d\",&n);\n    for(int i = 1;i <= n;i++) scanf(\"%d\",&a[i]);\n    for(int i = 1,u,v,w;i < n;i++){\n        scanf(\"%d%d%d\",&u,&v,&w);\n        add_edge(u,v,w); add_edge(v,u,w);\n    }\n    maxpart[0] = INF; totsize = n; GetRoot(1,0); dfs(rt);\n    printf(\"%d %.10f\\n\",root,ans);\n    return 0;\n}\n```",
        "postTime": 1612282004,
        "uid": 108894,
        "name": "\u5173\u6000\u4ed6\u4eba",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF566C \u3010Logistical Questions\u3011"
    },
    {
        "content": "[Codeforces \u9898\u76ee\u4f20\u9001\u95e8](https://codeforces.com/contest/566/problem/C) & [\u6d1b\u8c37\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF566C)\n\n\u795e\u4ed9\u9898 %%%\n\n\u9996\u5148\u8003\u8651\u5bf9\u8fd9\u4e2a\u5947\u5947\u602a\u602a\u7684 $t^{3/2}$ \u8fdb\u884c\u4e00\u756a\u89c2\u5bdf\u3002\u8003\u8651\u6784\u9020\u51fd\u6570 $f(x)=ax^{3/2}+b(d-x)^{3/2}$\uff0c\u5176\u4e2d $a,b,d$ \u4e3a\u53c2\u6570\uff0c\u5c06\u5176\u6c42\u4e2a\u5bfc $f'(x)=\\dfrac{3}{2}(ax^{1/2}-b(d-x)^{1/2})$\uff0c\u4e0d\u96be\u53d1\u73b0 $f'(0)=-\\dfrac{3}{2}b\\sqrt{d}<0,f'(d)=\\dfrac{3}{2}a\\sqrt{d}>0$\uff0c\u800c\u5728 $[0,d]$ \u4e2d\u968f\u7740 $x$ \u7684\u589e\u5927\uff0c$ax^{1/2}$ \u968f\u4e4b\u589e\u5927\uff0c$b(d-x)^{1/2}$ \u968f\u4e4b\u51cf\u5c0f\uff0c\u6545 $f'(x)$ \u5728 $[0,d]$ \u4e2d\u4e3a\u4e25\u683c\u589e\u51fd\u6570\uff0c\u5373 $\\exist x_0\\in[0,d],f'(x_0)=0$\uff0c\u6545 $f(x)$ \u5728 $[0,d]$ \u4e2d\u4e3a**\u4e25\u683c\u4e0b\u51f8\u51fd\u6570**\u3002\n\n\u8fd9\u80fd\u7ed9\u6211\u4eec\u4ec0\u4e48\u542f\u793a\u5462\uff1f\u8003\u8651\u5c06\u8fd9\u4e1c\u897f\u4e0e\u6811\u8054\u7cfb\u8d77\u6765\uff0c\u5bf9\u4e8e\u6811\u4e0a\u4efb\u610f\u4e00\u6761\u8fb9 $(u,v)$\uff0c\u5047\u8bbe $w_u=a,w_v=b$\uff0c\u8fb9\u7684\u8ddd\u79bb\u4e3a $d$\uff0c\u5e76\u4e14\u6211\u4eec\u8fd9\u4e2a\u5e26\u6743\u91cd\u5fc3\u4e0d\u4e00\u5b9a\u521a\u597d\u843d\u5728\u9876\u70b9\u4e0a\u2014\u2014\u5b83\u53ef\u4ee5\u843d\u5728\u4efb\u610f\u4e00\u6761\u8fb9\u7684\u4efb\u610f\u4e00\u70b9\uff0c\u90a3\u4e48\u5047\u8bbe\u6211\u4eec\u53d6\u4e86 $(u,v)$ \u8fb9\u4e0a\u4e00\u70b9\uff0c\u8ddd\u79bb $u$ \u4e3a $x$\uff0c\u8fd9\u6837 $u,v$ \u4e24\u70b9\u7684\u6743\u503c\u4e4b\u548c\u6070\u597d\u5c31\u662f\u4e0a\u6587\u4e2d\u63d0\u5230\u7684\u51fd\u6570 $f(x)$\uff0c\u800c $f(x)$ \u4e3a\u4e25\u683c\u4e0b\u51f8\u51fd\u6570\u53ef\u77e5**\u5fc5\u5b9a\u5b58\u5728 $(u,v)$ \u4e0a\u4e00\u70b9 $t$\uff0c\u4f7f\u5f97\u5f53\u6211\u4eec\u5c06\u91cd\u5fc3\u5b9a\u5728 $t$ \u65f6\u5019\uff0c$u,v$ \u4e24\u70b9\u8d21\u732e\u7684\u6743\u503c\u4e4b\u548c\u6700\u5c0f\uff0c\u5e76\u4e14\u79bb $t$ \u8d8a\u8fdc\uff0c$u,v$ \u4e24\u70b9\u8d21\u732e\u7684\u6743\u503c\u4e4b\u548c\u6700\u5927**\u3002\n\n\u5c06\u8fd9\u4e2a\u7ed3\u8bba\u6269\u5c55\u5230\u6574\u68f5\u6811\u4f9d\u65e7\u6210\u7acb\uff0c\u6211\u4eec\u8fd8\u662f\u5047\u8bbe\u91cd\u5fc3\u53ef\u4ee5\u843d\u5728\u4efb\u610f\u4e00\u6761\u8fb9\u7684\u4efb\u610f\u4e00\u70b9\uff0c\u90a3\u4e48\u5bf9\u4e8e\u91cd\u5fc3 $G$\uff0c\u6211\u4eec\u5728\u4e0d\u65ad\u8fdc\u79bb $G$ \u7684\u8fc7\u7a0b\u4e2d\uff0c\u6240\u6709\u70b9\u8d21\u732e\u6743\u503c\u4e4b\u548c\u5fc5\u7136\u662f\u4e0d\u65ad\u589e\u5927\u7684\uff1b\u53cd\u4e4b\u5f53\u6211\u4eec\u4e0d\u65ad\u9760\u8fd1 $G$ \u7684\u8fc7\u7a0b\u4e2d\u6240\u6709\u70b9\u8d21\u732e\u7684\u6743\u503c\u4e4b\u548c\u5fc5\u7136\u662f\u4e0d\u65ad\u51cf\u5c0f\u7684\u3002\u6216\u8005\u8bf4\u5f97\u66f4\u901a\u4fd7\u4e9b\uff0c\u73b0\u5728\u6709\u4e00\u679a\u68cb\u5b50\uff0c\u6446\u653e\u5728\u6811\u7684\u4efb\u610f\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u6211\u4eec\u73b0\u5728\u8981\u6cbf\u7740\u6811\u4e0a\u7684\u8fb9\u79fb\u52a8\u8fd9\u679a\u68cb\u5b50\uff0c\u90a3\u4e48\u4e0a\u8ff0\u7ed3\u8bba\u8bf4\u7684\u662f\u8fd9\u6837\u4e00\u4ef6\u4e8b\uff1a\u5982\u679c\u6211\u4eec\u6b63\u5728\u5c06\u8fd9\u679a\u68cb\u5b50\u5411 $G$ \u7684\u65b9\u5411\u79fb\u52a8\uff0c\u90a3\u4e48\u6743\u503c\u4e4b\u548c\u662f\u5904\u4e8e\u4e0d\u65ad\u51cf\u5c0f\u7684\u8fc7\u7a0b\u4e2d\uff0c\u5426\u5219\u6743\u503c\u4e4b\u548c\u662f\u5904\u4e8e\u4e0d\u65ad\u589e\u5927\u7684\u8fc7\u7a0b\u4e2d\u3002\n\n\u6211\u4eec\u5c31\u8003\u8651\u6839\u636e\u8fd9\u4e2a\u201c\u79fb\u52a8\u68cb\u5b50\u201d\u7684\u601d\u60f3\u89e3\u51b3\u8fd9\u9053\u9898\u3002\u6211\u4eec\u5047\u8bbe\u73b0\u5728\u6709\u4e00\u679a\u68cb\u5b50\u6446\u653e\u5728 $u$ \u53f7\u8282\u70b9\uff0c\u5bf9\u4e8e $u$ \u7684\u4efb\u610f\u4e00\u4e2a\u90bb\u5c45 $v$\uff0c\u6211\u4eec\u8003\u8651\u5c06 $u$ \u6cbf\u7740 $v$ \u7684\u65b9\u5411\u79fb\u52a8\u4f1a\u4ea7\u751f\u4ec0\u4e48\u5f71\u54cd\uff0c\u6211\u4eec\u5047\u8bbe $u$ \u6cbf\u7740 $v$ \u65b9\u5411\u79fb\u52a8\u4e86 $x$ \u7684\u8ddd\u79bb\uff0c$u$ \u5230\u6bcf\u4e2a\u8282\u70b9 $v$ \u7684\u8ddd\u79bb\u4e3a $d_v$\uff0c\u90a3\u4e48\u663e\u7136\u79fb\u52a8\u5b8c\u4e4b\u548c\u6743\u503c\u4e4b\u548c $g_v(x)=\\sum\\limits_{t\\in\\text{subtree}(v)}a_t(d_t-x)^{3/2}+\\sum\\limits_{t\\notin\\text{subtree}(v)}a_t(d_t+x)^{3/2}$\u3002\u6211\u4eec\u8fd8\u53ef\u4ee5\u6ce8\u610f\u5230 $x=0$ \u65f6 $g_v(x)$ \u7684\u503c\u5c31\u662f\u5c06\u91cd\u5fc3\u5b9a\u5728 $u$ \u70b9\u65f6\u7684\u6743\u503c\uff0c\u800c\u5047\u8bbe\u91cd\u5fc3 $G$ \u5c31\u5728 $v$ \u7684\u5b50\u6811\uff08\u542b $(u,v)$ \u7684\u8fb9\u4e0a\uff09\uff0c\u6839\u636e\u4e0a\u9762\u7684\u7ed3\u8bba\u6709\u6211\u4eec\u5c06 $u$ \u79fb\u52a8\u5230 $v$ \u7684\u8fc7\u7a0b\u4e2d\u6743\u503c\u5448\u73b0\u51cf\u5c0f\u7684\u8d8b\u52bf\uff0c\u90a3\u4e48\u5fc5\u7136\u6709 $g_v(0)$ \u7684**\u77ac\u65f6\u53d8\u5316\u91cf**\u4e3a\u8d1f\uff0c\u5c06 $g_v(x)$ \u6c42\u4e2a\u5bfc\u53ef\u5f97 $g_v'(x)=-\\sum\\limits_{t\\in\\text{subtree}(v)}\\dfrac{3}{2}a_t(d_t-x)^{1/2}-\\sum\\limits_{t\\notin\\text{subtree}(v)}\\dfrac{3}{2}a_t(d_t+x)^{1/2}$\uff0c\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e2a $v$ \u8fdb\u884c\u4e00\u904d DFS \u6c42\u51fa $g'_v(0)$ \u7684\u503c\uff0c\u7136\u540e\u627e\u5230 $g_v'(0)<0$ \u7684 $v$ \u5e76\u5c06\u68cb\u5b50\u79fb\u52a8\u5230 $v$ \u5373\u53ef\uff0c\u6839\u636e\u4e4b\u524d\u7684\u63a8\u8bba\u8fd9\u6837\u7684 $v$ \u662f\u552f\u4e00\u7684\u3002\n\n\u8fd9\u6837\u590d\u6742\u5ea6\u662f\u5e73\u65b9\u7684\uff0c\u8fc7\u4e0d\u53bb\uff0c~~\u7b49\u540c\u4e8e\u66b4\u529b~~\u3002\u4e0d\u8fc7\u8003\u8651\u6709\u4e2a\u4e1c\u897f\u53eb\u70b9\u5206\u6cbb\uff0c\u5047\u8bbe\u6211\u4eec\u9884\u671f\u5c06\u68cb\u5b50\u79fb\u52a8\u5230 $v$ \u7684\u4f4d\u7f6e\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u786e\u5b9a\u91cd\u5fc3\u4e00\u5b9a\u5728 $v$ \u7684\u5b50\u6811\uff08\u5305\u62ec $(u,v)$ \u7684\u8fb9\u4e0a\uff09\uff0c\u6211\u4eec\u5c31\u6bcf\u6b21\u627e\u51fa $v$ \u5b50\u6811\u7684\u91cd\u5fc3 $G$\uff08\u8fd9\u91cc\u7684\u91cd\u5fc3\u5c31\u662f\u666e\u901a\u7684\u91cd\u5fc3\u5206\u6cbb\u91cc\u7684\u91cd\u5fc3\uff09\uff0c\u5c06\u68cb\u5b50\u79fb\u52a8\u5230 $G$ \u5373\u53ef\uff0c\u6839\u636e\u91cd\u5fc3\u5206\u6cbb\u7684\u590d\u6742\u5ea6\u53ef\u77e5\u8fd9\u6837\u662f $n\\log n$ \u7684\u3002\n\n\u6700\u540e\u6ce8\u610f\u8981\u6bcf\u79fb\u52a8\u4e00\u6b21\u66f4\u65b0\u4e00\u6b21\u7b54\u6848\uff0c\u4e0d\u8981\u76f4\u63a5\u8f93\u51fa\u6700\u540e\u4e00\u6b21\u5230\u8fbe\u7684\u4f4d\u7f6e\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi first\n#define se second\n#define fill0(a) memset(a,0,sizeof(a))\n#define fill1(a) memset(a,-1,sizeof(a))\n#define fillbig(a) memset(a,63,sizeof(a))\n#define pb push_back\n#define ppb pop_back\n#define mp make_pair\ntemplate<typename T1,typename T2> void chkmin(T1 &x,T2 y){if(x>y) x=y;}\ntemplate<typename T1,typename T2> void chkmax(T1 &x,T2 y){if(x<y) x=y;}\ntypedef pair<int,int> pii;\ntypedef long long ll;\ntypedef unsigned int u32;\ntypedef unsigned long long u64;\nnamespace fastio{\n\t#define FILE_SIZE 1<<23\n\tchar rbuf[FILE_SIZE],*p1=rbuf,*p2=rbuf,wbuf[FILE_SIZE],*p3=wbuf;\n\tinline char getc(){return p1==p2&&(p2=(p1=rbuf)+fread(rbuf,1,FILE_SIZE,stdin),p1==p2)?-1:*p1++;}\n\tinline void putc(char x){(*p3++=x);}\n\ttemplate<typename T> void read(T &x){\n\t\tx=0;char c=getchar();T neg=0;\n\t\twhile(!isdigit(c)) neg|=!(c^'-'),c=getchar();\n\t\twhile(isdigit(c)) x=(x<<3)+(x<<1)+(c^48),c=getchar();\n\t\tif(neg) x=(~x)+1;\n\t}\n\ttemplate<typename T> void recursive_print(T x){if(!x) return;recursive_print(x/10);putc(x%10^48);}\n\ttemplate<typename T> void print(T x){if(!x) putc('0');if(x<0) putc('-'),x=~x+1;recursive_print(x);}\n\tvoid print_final(){fwrite(wbuf,1,p3-wbuf,stdout);}\n}\nconst int MAXN=2e5;\nconst int INF=0x3f3f3f3f;\nint n,a[MAXN+5],hd[MAXN+5],to[MAXN*2+5],nxt[MAXN*2+5],val[MAXN*2+5],ec=0;\nvoid adde(int u,int v,int w){to[++ec]=v;val[ec]=w;nxt[ec]=hd[u];hd[u]=ec;}\nbool vis[MAXN+5];int siz[MAXN+5],mx[MAXN+5],cent=0;\nint ans=0;double mn=1e25,sum[MAXN+5],sum1=0,sum2=0;\nvoid findcent(int x,int f,int totsiz){\n\tmx[x]=0;siz[x]=1;\n\tfor(int e=hd[x];e;e=nxt[e]){\n\t\tint y=to[e];if(y==f||vis[y]) continue;\n\t\tfindcent(y,x,totsiz);siz[x]+=siz[y];\n\t\tchkmax(mx[x],siz[y]);\n\t} chkmax(mx[x],totsiz-siz[x]);\n\tif(mx[x]<mx[cent]) cent=x;\n}\nvoid calc(int x,int f,int rt,int dep){\n\tsum1+=1.0*a[x]*dep*sqrt(dep);\n\tsum2+=1.0*a[x]*sqrt(dep)*3/2;\n\tsum[rt]+=1.0*a[x]*sqrt(dep)*3/2;\n\tfor(int e=hd[x];e;e=nxt[e]){\n\t\tint y=to[e],z=val[e];if(y==f) continue;\n\t\tcalc(y,x,rt,dep+z);\n\t}\n}\nvoid divcent(int x){\n\tif(vis[x]) return;vis[x]=1;sum1=sum2=0;\n\tfor(int e=hd[x];e;e=nxt[e]){\n\t\tint y=to[e],z=val[e];sum[y]=0;calc(y,x,y,z);\n\t}\n\tif(sum1<mn) mn=sum1,ans=x;\n\tfor(int e=hd[x];e;e=nxt[e]){\n\t\tint y=to[e],z=val[e];\n\t\tif(sum2-sum[y]*2.0<0){\n\t\t\tcent=0;findcent(y,x,siz[y]);divcent(cent);\n\t\t\treturn;\n\t\t}\n\t}\n}\nint main(){\n\tscanf(\"%d\",&n);for(int i=1;i<=n;i++) scanf(\"%d\",&a[i]);\n\tfor(int i=1,u,v,w;i<n;i++) scanf(\"%d%d%d\",&u,&v,&w),adde(u,v,w),adde(v,u,w);\n\tmx[0]=INF;cent=0;findcent(1,0,n);divcent(cent);\n\tprintf(\"%d %.15lf\\n\",ans,mn);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1616250305,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF566C Logistical Questions"
    },
    {
        "content": "# Description\n\n\u7ed9\u51fa\u4e00\u68f5 $n$ \u4e2a\u8282\u70b9\u7684\u6811\uff0c\u70b9\u6709\u70b9\u6743\uff0c\u8fb9\u6709\u8fb9\u6743\uff0c\u5b9a\u4e49\u4e24\u70b9\u95f4\u8ddd\u79bb\u4e3a\u4e24\u70b9\u95f4\u8fb9\u6743\u548c\u7684 $1.5$ \u6b21\u65b9\uff0c\u6c42\u6811\u7684\u5e26\u6743\u91cd\u5fc3\u3002\n\n$n \\le 2 \\times 10^5, V \\le 10^8$\uff0c\u65f6\u9650 2s\u3002\n\n# Solution\n\n\u8fd9\u662f\u4e00\u7c7b\u6811\u4e0a\u6309\u91cd\u5fc3\u79fb\u52a8\u7684\u6700\u4f18\u5316\u95ee\u9898\u3002\n\n\u5c06\u9898\u76ee\u6240\u7ed9\u95ee\u9898\u8f6c\u79fb\u5230\u5e8f\u5217\u4e0a\uff0c\u7531\u4e8e $f(x)=x^{1.5}$ \u662f\u51f8\u51fd\u6570\uff0c\u4ee5\u53ca\u51f8\u51fd\u6570\u4e4b\u548c\u4ecd\u7136\u662f\u51f8\u51fd\u6570\u7684\u6027\u8d28\uff0c\u4e0d\u96be\u53d1\u73b0\u7b54\u6848\u51fd\u6570\u5fc5\u7136\u671d\u67d0\u4e00\u4e2d\u5fc3\u5355\u8c03\u4e0b\u964d\u3002\n\n\u56e0\u6b64\u6211\u4eec\u8003\u8651\u5bf9\u539f\u6811\u8fdb\u884c\u70b9\u5206\u6cbb\uff0c\u6bcf\u6b21\u671d\u53d6\u66f4\u4f18\u503c\u7684\u65b9\u5411\u7684\u5b50\u6811\u8d70\uff0c\u8df3\u8dc3\u6027\u5730\u6309\u91cd\u5fc3\u79fb\u52a8\u3002\n\n\u8003\u8651\u66b4\u7b97\u51fa\u6bcf\u4e00\u4e2a\u5b50\u6811\u7684\u7b54\u6848\uff0c\u4ece\u800c\u627e\u5230\u6b63\u786e\u7684\u65b9\u5411\u3002\u4f46\u662f\u8fd9\u6837\u5728\u5206\u6cbb\u4e2d\u5fc3\u5ea6\u6570\u8f83\u5927\u65f6\uff0c\u590d\u6742\u5ea6\u5c31\u4f1a\u9000\u5316\u3002\n\n\u6211\u4eec\u8003\u8651\u66f4\u9ad8\u660e\u7684\u505a\u6cd5\u3002\u5bf9\u6bcf\u4e2a\u5b50\u6811\u4e2d\u7684\u51fd\u6570\u9879\u6c42\u5bfc\uff0c\u679a\u4e3e\u6bcf\u4e00\u68f5\u5b50\u6811\uff0c\u67e5\u770b\u5176\u4ed6\u5b50\u6811\u7684\u5bfc\u6570\u548c\u51cf\u53bb\u8be5\u5b50\u6811\u7684\u5bfc\u6570\u548c\uff0c\u82e5\u4e3a\u8d1f\u6570\uff0c\u5219\u8bf4\u660e\u8fd9\u4e2a\u65b9\u5411\u662f\u6700\u4f18\u7684\u3002\n\n\u5177\u4f53\u6c42\u5bfc\uff0c\u4e5f\u5c31\u662f $(d^{1.5}v)'=1.5d^{0.5}v$\uff08\u7ea6\u5b9a $d$ \u4e3a\u4e24\u70b9\u95f4\u8fb9\u6743\u548c\uff0c$v$ \u4e3a\u70b9\u6743\uff09\u3002\n\n\u6700\u540e\u6ce8\u610f\u7531\u4e8e\u8fb9\u6709\u8fb9\u6743\uff0c\u6240\u4ee5\u7406\u8bba\u4e0a\u7684\u6700\u4f18\u89e3\u4e0d\u4e00\u5b9a\u6070\u597d\u5728\u70b9\u4e0a\uff0c\u6709\u53ef\u80fd\u5728\u8fb9\u4e0a\u3002\u56e0\u6b64\u5b9e\u9645\u4e0a\u7684\u51fd\u6570\u5177\u6709\u4e0d\u8fde\u7eed\u6027\uff0c\u6240\u4ee5\u8981\u8fb9\u79fb\u52a8\u8fb9\u53d6\u6700\u4f18\u503c\u3002\n\n\u81f3\u6b64\u6211\u4eec\u5c31\u5728 $\\mathcal O(n \\log n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e0b\u5b8c\u6210\u4e86\u672c\u9898\u3002\n\n# Code\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\nconst int N=4e5+5;\nint n,v[N],rt,Sum,sl[N],sz[N],NumE,Fir[N];\nLL dis[N];\ndouble psm,p[N],md[N];\nint ans1;\ndouble ans2=1e20,t2;\nbool vis[N];\nstruct Edge {\n\tint v,w,nxt;\n}E[N];\nvoid AddE(int u,int v,int w) {\n\tE[++NumE]=(Edge){v,w,Fir[u]};\n\tFir[u]=NumE;\n}\nvoid GetR(int x,int fa) {\n\tsl[x]=0,sz[x]=1;\n\tfor (int i=Fir[x];i;i=E[i].nxt) {\n\t\tif (!vis[E[i].v] && E[i].v!=fa) {\n\t\t\tGetR(E[i].v,x);\n\t\t\tsl[x]=max(sl[x],sz[E[i].v]);\n\t\t\tsz[x]+=sz[E[i].v];\n\t\t}\n\t}\n\tsl[x]=max(sl[x],Sum-sz[x]);\n\tif (sl[x]<sl[rt]) rt=x;\n}\nvoid GetD(int x,int fa,int gua) {\n\tp[x]=1.5*pow(dis[x],0.5)*v[x];\n\tmd[gua]+=p[x],psm+=p[x];\n\tt2+=1.0*pow(dis[x],1.5)*v[x];\n\tfor (int i=Fir[x];i;i=E[i].nxt)\n\t\tif (E[i].v!=fa) {\n\t\t\tdis[E[i].v]=dis[x]+E[i].w;\n\t\t\tGetD(E[i].v,x,gua);\n\t\t}\n}\nvoid Dfs(int u) {\n\tvis[u]=true;\n\tdis[u]=0,psm=0,t2=0;\n\tfor (int i=Fir[u];i;i=E[i].nxt) {\n\t\tdis[E[i].v]=dis[u]+E[i].w;\n\t\tmd[E[i].v]=0;\n\t\tGetD(E[i].v,u,E[i].v);\n\t}\n\tif (t2<ans2) {\n\t\tans1=u,ans2=t2;\n\t}\n\tGetR(u,0);\n\tfor (int i=Fir[u];i;i=E[i].nxt)\n\t\tif (!vis[E[i].v] && psm-md[E[i].v]*2.0<0) {\n\t\t\tsl[0]=n,rt=0,Sum=sz[E[i].v];\n\t\t\tGetR(E[i].v,u),Dfs(rt);\n\t\t\tbreak;\n\t\t}\n}\nint main() {\n\tscanf(\"%d\",&n);\n\tfor (int i=1;i<=n;i++) scanf(\"%d\",&v[i]);\n\tfor (int i=1;i<n;i++) {\n\t\tint x,y,z;\n\t\tscanf(\"%d%d%d\",&x,&y,&z);\n\t\tAddE(x,y,z),AddE(y,x,z);\n\t}\n\tsl[0]=Sum=n;\n\tGetR(1,0),Dfs(rt);\n\tprintf(\"%d %.10lf\\n\",ans1,ans2);\n\treturn 0;\n}\n```\n",
        "postTime": 1657460630,
        "uid": 283913,
        "name": "ZillionX",
        "ccfLevel": 6,
        "title": "\u3010\u70b9\u5206\u6cbb\uff0c\u6309\u91cd\u5fc3\u79fb\u52a8\u4f18\u5316\u3011CF566C Logistical Questions"
    },
    {
        "content": "[CF566C Logistical Questions](https://www.luogu.com.cn/problem/CF566C)\u89e3\u9898\u62a5\u544a\uff1a\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://zybuluo.com/xiaoziyao/note/1814214)\n\n## \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u9897 $n$ \u4e2a\u70b9\uff0c\u5e26\u70b9\u6743\u548c\u8fb9\u6743\u7684\u6811\uff0c\u8bbe\u4e00\u6761\u8def\u5f84\u7684\u6743\u503c\u4e3a\u8fb9\u6743\u7684 $1.5$ \u6b21\u65b9\uff0c\u6c42\u6811\u7684\u5e26\u6743\u91cd\u5fc3\u3002\n\n## \u5206\u6790\n\n\u5927\u6e05\u65b0\u9898\u3002\n\n\u6211\u4eec\u53d1\u73b0\u771f\u6b63\u7684\u5e26\u6743\u91cd\u5fc3\u4e0d\u4e00\u5b9a\u5728\u7ed3\u70b9\u4e0a\uff08\u867d\u7136\u7b54\u6848\u5728\u7ed3\u70b9\u4e0a\uff09\uff0c\u53ef\u80fd\u5728\u4e00\u6761\u8fb9\u7684\u67d0\u4e2a\u4f4d\u7f6e\uff0c\u8bbe\u5176\u4e3a $G$\u3002\u5982\u679c\u91cd\u5fc3\u6070\u597d\u5728\u4e00\u4e2a\u7ed3\u70b9\u4e0a\uff0c\u6211\u4eec\u94a6\u5b9a\u5b83\u5728\u8fd9\u4e2a\u70b9\u76f8\u8fde\u7684\u4e00\u6761\u8fb9\u65e0\u9650\u63a5\u8fd1\u7aef\u70b9\u7684\u4e00\u4e2a\u4f4d\u7f6e\u3002\n\n\u5148\u8003\u8651\u6811\u53ea\u6709\u4e24\u4e2a\u70b9\u7684\u60c5\u51b5\uff0c\u8bbe\u552f\u4e00\u7684\u4e00\u6761\u8fb9\u4e3a $(x,y,z)$\uff0c\u90a3\u4e48\u5982\u679c\u5f53\u524d\u5728\u8fb9\u4e0a\u4e0e $x$ \u7684\u8ddd\u79bb\u4e3a $p$ \u7684\u4f4d\u7f6e\uff0c\u90a3\u4e48\u6743\u503c\u548c\u4e3a\uff1a\n\n$$f(p)=v_xp^{1.5}+v_y(z-p)^{1.5}$$\n\n\u6211\u4eec\u5bf9\u5176\u6c42\u5bfc\uff0c\u5f97\u5230 $f'(p)=1.5(v_x\\sqrt p-v_y\\sqrt{z-p})$\u3002\n\n\u5e26\u5165\u8fb9\u7684\u4e24\u4e2a\u7aef\u70b9 $0$ \u548c $z$ \u5f97\u5230 $f'(0)=-1.5v_y\\sqrt{z}$\uff0c$f'(z)=1.5v_x\\sqrt{z}$\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53d1\u73b0\u70b9\u5728\u8fb9\u4e0a\u79fb\u52a8\u65f6\uff0c\u9760\u8fd1\u5e26\u6743\u91cd\u5fc3\u65f6\u6743\u503c\u548c\u51cf\u5c0f\uff0c\u8fdc\u79bb\u5e26\u6743\u91cd\u5fc3\u662f\u6743\u503c\u548c\u589e\u52a0\uff0c\u4e5f\u5c31\u662f\u8fd9\u4e2a\u51fd\u6570\u662f\u4e25\u683c\u4e0b\u51f8\u7684\u3002\n\n\u6211\u4eec\u5c06\u60c5\u51b5\u6269\u5c55\u5230\u6811\u4e0a\uff0c\u5728\u4e00\u6761\u8fb9\u4e0a\u8fd0\u52a8\u65f6\uff0c\u65b0\u7684\u8ddd\u79bb\u548c $g(p)$ \u53ef\u4ee5\u770b\u505a\u82e5\u5e72\u4e2a $f$ \u7684\u548c\uff0c\u4e8e\u662f\u5b83\u4ecd\u7136\u662f\u4e25\u683c\u4e0b\u51f8\u7684\u3002\n\n\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u597d\u7684\u6027\u8d28\uff0c\u5b83\u544a\u8bc9\u6211\u4eec\u5982\u679c\u4e00\u4e2a\u70b9\u9760\u8fd1\u91cd\u5fc3\uff0c\u6743\u503c\u548c\u4e00\u5b9a\u51cf\u5c0f\uff0c\u5426\u5219\u4e00\u5b9a\u589e\u52a0\u3002\n\n\u6211\u4eec\u4ece\u4efb\u610f\u4e00\u4e2a\u70b9\u5f00\u59cb\uff0c\u6bcf\u6b21\u901a\u8fc7\u5b83\u5b50\u6811\u4e2d\u6240\u6709\u70b9\u6765\u8ba1\u7b97\u6bcf\u4e00\u6761\u8fb9\u7684\u5bfc\u6570\uff0c\u53d6\u8d1f\u6570\u7684\u90a3\u4e00\u6761\u8fb9\u3002\u8fd9\u6837\u505a\u7684\u590d\u6742\u5ea6\u662f $O(n^2)$ \u7684\u3002\n\n\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u53ef\u4ee5\u5728\u70b9\u5206\u6cbb\u4e2d\u505a\u8fd9\u6837\u7684\u64cd\u4f5c\uff0c\u5177\u4f53\u5c31\u6bcf\u6b21\u8d70\u4e00\u6761\u8fb9\u540e\u5c31\u76f4\u63a5\u8df3\u5230\u8fd9\u4e2a\u5b50\u6811\u91cd\u5fc3\uff0c\u8fd9\u6837\u590d\u6742\u5ea6\u5c31\u662f $O(n\\log n)$ \u4e86\u3002\n\n## \u4ee3\u7801\n```\n#include<stdio.h>\n#include<math.h>\n#define inf 1000000000\nconst int maxn=200005,maxm=maxn<<1;\nint n,e,stp,minn,pos,ans;\nint v[maxn],start[maxn],to[maxm],then[maxm],worth[maxm],vis[maxn],size[maxn],fin[maxn];\ndouble val,all,now;\ndouble tot[maxn];\ninline int max(int a,int b){\n\treturn a>b? a:b;\n}\ninline void add(int x,int y,int z){\n\tthen[++e]=start[x],start[x]=e,to[e]=y,worth[e]=z;\n}\nvoid find(int x,int sum){\n\tint maxx=0;\n\tvis[x]=stp,size[x]=1;\n\tfor(int i=start[x];i;i=then[i])\n\t\tif(fin[to[i]]==0&&vis[to[i]]!=stp)\n\t\t\tfind(to[i],sum),size[x]+=size[to[i]],maxx=max(maxx,size[to[i]]);\n\tmaxx=max(maxx,sum-size[x]);\n\tif(maxx<minn)\n\t\tminn=maxx,pos=x;\n}\nvoid dfs(int x,int last,int dis,int top){\n\tnow+=1.0*v[x]*dis*sqrt(dis),all+=1.5*v[x]*sqrt(dis),tot[top]+=1.5*v[x]*sqrt(dis);\n\tfor(int i=start[x];i;i=then[i])\n\t\tif(to[i]!=last)\n\t\t\tdfs(to[i],x,dis+worth[i],top);\n}\nvoid solve(int x,int sum){\n\tstp++,minn=inf,find(x,sum),x=pos,fin[x]=1;\n\tall=now=0;\n\tfor(int i=start[x];i;i=then[i])\n\t\ttot[to[i]]=0,dfs(to[i],x,worth[i],to[i]);\n\tif(now<val)\n\t\tval=now,ans=x;\n\tfind(x,sum);\n\tfor(int i=start[x];i;i=then[i])\n\t\tif(fin[to[i]]==0&&all-2*tot[to[i]]<0){\n\t\t\tsolve(to[i],size[to[i]]);\n\t\t\tbreak;\n\t\t}\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)\n\t\tscanf(\"%d\",&v[i]);\n\tfor(int i=1;i<n;i++){\n\t\tint x,y,z;\n\t\tscanf(\"%d%d%d\",&x,&y,&z);\n\t\tadd(x,y,z),add(y,x,z);\n\t}\n\tval=1e30,solve(1,n);\n\tprintf(\"%d %.10lf\\n\",ans,val);\n\treturn 0;\n}\n```",
        "postTime": 1628418187,
        "uid": 35754,
        "name": "Verdandi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF566C\u3010Logistical Questions\u3011"
    }
]
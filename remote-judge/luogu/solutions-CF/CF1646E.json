[
    {
        "content": "[\u9898\u9762](https://www.luogu.com.cn/problem/CF1646E)\n\n#### \u9898\u610f\uff1a\n\n\u8f93\u5165\u4e24\u4e2a\u6574\u6570 $n,m$ \u4fdd\u8bc1 $n,m\\leq 10^6$\u3002\u4f60\u6709\u4e00\u4e2a\u77e9\u9635 $a$\uff0c\u5176\u4e2d $a_{ij}=i^j$\u3002\u6c42\u8be5\u77e9\u9635\u4e2d\u6709\u591a\u5c11\u4e0d\u540c\u7684\u6574\u6570\u3002 \n\n\u70b9\u6570\uff1a2200\n\n\u6807\u7b7e\uff1a\u7d20\u6570\u7b5b\uff0c\u6570\u8bba\n\n#### \u5206\u6790\uff1a\n\n\u5bf9\u4e8e $n,m\\leq 10^6$ \u663e\u7136\u9700\u8981 $O(n\\log n)$ \u5de6\u53f3\u7684\u590d\u6742\u5ea6\u3002\n\n\u6211\u4eec\u4ed4\u7ec6\u89c2\u5bdf\u4e00\u4e0b\u8fd9\u4e2a\u77e9\u9635\u3002\u7136\u540e\u53d1\u73b0\u5176\u4e2d\u6709\u51fa\u73b0\u5df2\u7ecf\u51fa\u73b0\u8fc7\u7684\u6570\u7684\u884c\u4f3c\u4e4e\u662f\u6709\u89c4\u5f8b\u7684\u3002\u4e0d\u96be\u53d1\u73b0\u4efb\u4f55\u4e00\u884c\u7684 $k$ \u6b21\u65b9\u4e2d\u90fd\u4f1a\u51fa\u73b0\u5df2\u7ecf\u51fa\u73b0\u8fc7\u7684\u6570\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5f97\u5230\u7b2c\u4e00\u4e2a\u7ed3\u8bba\uff0c\u5982\u679c\u5f53\u524d\u7684\u7b2c $i$ \u884c\u53ef\u4ee5\u8868\u793a\u4e3a $b^x$ \u90a3\u4e48\u8fd9\u4e00\u884c\u662f\u6709\u91cd\u590d\u7684\u3002\n\n\u90a3\u6211\u4eec\u4e0d\u59a8\u5bf9\u4e8e\u4e00\u4e2a $b$ \u4e00\u6b21\u6027\u8ba1\u7b97\u5b8c\u6240\u6709\u7684 $b^x\\leq n$ \u4f46\u5176\u5b9e\u6b64\u65f6\u590d\u6742\u5ea6\u4ecd\u7136\u4e3a\u66b4\u529b\u7684 $O(nm)$\uff0c\u56e0\u4e3a\u4f60\u9700\u8981\u8003\u8651\u6bcf\u4e00\u4e2a\u4f7f\u5f97 $x$ \u6ee1\u8db3 $b^x\\leq n$\u3002\u8003\u8651\u600e\u4e48\u4f18\u5316\u8fd9\u4e2a\u65b9\u6cd5\u3002\u4e0b\u6587\u5747\u53ea\u8003\u8651\u4e0d\u5b58\u5728 $x,y$ \u4f7f\u5f97 $y^x=b$ \u7684\u884c $b$\u3002\n\n\u8fd9\u65f6\u6211\u4eec\u53d1\u73b0\u8fd9\u9898\u7684\u4e00\u4e2a\u5173\u952e\u7684\u70b9\u3002\n\n\u5bf9\u4e8e\u7b2c $b$ \u884c\uff0c\u6211\u4eec\u4e0d\u59a8\u8bbe $f(b)=x$ \u8868\u793a\u6700\u5927\u7684 $x$ \u4f7f\u5f97 $b^x\\leq n$ \u6216\u8005\u8bf4 $f(b)=\\left\\lfloor\\ \\log_b n\\right\\rfloor$\u3002\u90a3\u4e48\u5bf9\u4e8e\u6240\u6709\u7684\u884c $y$ \u4f7f\u5f97 $f(y)=f(b)$ \u4ed6\u4eec\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u662f\u76f8\u540c\u7684\u3002\u800c\u4e14 $f(b)$ \u6700\u591a\u53ea\u6709 $\\log_2 n$ \u79cd\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u79cd $f(b)$ \u8fdb\u884c\u66b4\u529b\u8ba1\u7b97\u7684\u590d\u6742\u5ea6\u4e3a $O(m)$ \u90a3\u4e48\u590d\u6742\u5ea6\u964d\u4e3a\u4e86 $O(m\\log n)$\u3002\n\n\u8fd9\u65f6\u9700\u8981\u518d\u5904\u7406\u4e00\u4e2a\u95ee\u9898\uff1a$O(n^m)$ \u7684\u7a7a\u95f4\u662f\u4e0d\u80fd\u63a5\u53d7\u7684\u3002\n\n\u6211\u4eec\u7ed3\u5408\u4e0a\u9762\u7684\u72b6\u6001\uff0c\u53ea\u8003\u8651 $f(x)$ \u7684\u503c\u800c\u4e0d\u662f $x$ \u7684\u503c\u3002\u4e0d\u96be\u53d1\u73b0\u5bf9\u4e8e\u7b2c $b$ \u884c\u548c\u5176\u4ed6\u4e0e\u4ed6\u4e00\u8d77\u8003\u8651\u7684\u884c $b^x$ \u6211\u4eec\u53ea\u53bb\u8bb0\u5f55\u4ed6\u7684\u6307\u6570\uff0c\u4e5f\u5c31\u662f $x^j$\u3002\u6b63\u786e\u6027\u7531 $b^{xy}=(b^x)^y$ \u663e\u7136\u3002\n\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\u3002\n\n#### \u603b\u590d\u6742\u5ea6\uff1a\n\n\u65f6\u95f4\uff1a$O(m\\log n+n)$\n\n\u7a7a\u95f4\uff1a$O(m\\log n)$\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n\u622a\u6b62\u9898\u89e3\u63d0\u4ea4\u65e5\u4e3a\u6d1b\u8c37\u6700\u4f18\u89e3\u3002\n\n```cpp\n#include<bits/stdc++.h>//author:Yuby163\n#define pc putchar//\u65f6\u95f4\uff1a2.67s \u7a7a\u95f4\uff1a12.41MB \u4ee3\u7801\u957f\u5ea6\uff1a1.06KB\nusing namespace std;//\u8bed\u8a00\uff1aC++20 O2\ntypedef long long ll;\ninline ll read(){ll read_result=0,is_below_0=0;char now_ch=0;while(!isdigit(now_ch)){is_below_0|=now_ch=='-';now_ch=getchar();}while(isdigit(now_ch)){read_result=(read_result<<3)+(read_result<<1)+(now_ch^48);now_ch=getchar();}return is_below_0?-read_result:read_result;}\ninline void write(ll x){if(x<0){putchar('-');x=-x;}if(x>9){write(x/10);}putchar(x%10+'0');}\nconst ll MAXN=1e6+7,MAXM=2e7+1;\nll n,m,dp[27],p[MAXN],cnt;\nbitset<MAXM>mp,book;\nint main()\n{\n \t//freopen(\".in\",\"r\",stdin);\n    //freopen(\".out\",\"w\",stdout);\n    n=read(),m=read();\n    ll maxn=ceil(log2(n*1.0));\n    ll res=0;\n    for(ll i=1;i<=maxn;i++)\n    {\n    \tfor(ll j=1;j<=m;j++)\n    \t{\n    \t\tif(mp[i*j])continue;\n    \t\tmp[i*j]=1;\n    \t\tres++;\n\t\t}\n\t\tdp[i]=res;\n\t}\n\tfor(ll i=2;i<=n;i++)book[i]=1;\n    ll ans=1;\n    for(ll i=2;i<=n;i++)\n    {\n    \tif(!book[i])continue;\n    \tfor(ll j=i;j<=n;j*=i)book[j]=0;\n    \tll num=(log2(n*1.0)/log2(i*1.0));\n\t\tans+=dp[num];\n\t}\n\twrite(ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1647256209,
        "uid": 395288,
        "name": "Yuby",
        "ccfLevel": 6,
        "title": "CF1646E\u9898\u89e3"
    },
    {
        "content": "# CF1646E Power Board\n\n\u7ed9\u4e00\u4e2a\u590d\u6742\u5ea6\u4e0e $m$ \u65e0\u5173\u7684\u505a\u6cd5\u3002\n\n\u8003\u8651\u4ec0\u4e48\u65f6\u5019\u6570\u5b57\u51fa\u73b0\u91cd\u590d\u3002\n\n\u89c2\u5bdf\u6bcf\u4e00\u884c\u3002\n\n\u53d1\u73b0\u5f53\u5b58\u5728 $i,j$ \u6ee1\u8db3 $i,j\\le n$ \u4e14 $j=i^k$ \u7684\u65f6\u5019\u7b2c $i$ \u884c\u548c\u7b2c $j$ \u884c\u4f1a\u51fa\u73b0\u91cd\u590d\u7684\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5206\u6bb5\u5904\u7406\u3002\n\n\u6211\u4eec\u627e\u5230\u6700\u5c0f\u7684 $i$ \u6ee1\u8db3\u4e0d\u5b58\u5728 $j$ \u4f7f\u5f97 $j^k=i$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c06 $i,i^2,\\dots ,i^k$ \u8fd9\u51e0\u884c\u7684\u6570\u653e\u5728\u4e00\u8d77\u5904\u7406\u3002\n\n\u6ce8\u610f\u5230\u4e0e\u8fd9\u51e0\u884c\u7684\u5305\u62ec\u6570\u662f $i,i^2,\\dots,i^m \\cup i^2,i^4,\\dots,i^{2m}\\cup i^3,i^6,\\dots i^{3m}\\cup\\dots$\u3002\n\n\u53d1\u73b0\u8fd9\u4e9b\u6570\u4e2d\u5982\u679c\u6307\u6570\u4e0d\u4e00\u6837\u90a3\u4e48\u6570\u5c31\u4e0d\u4e00\u6837\u3002\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u628a\u6307\u6570\u62ff\u4e0b\u6765\u53bb\u91cd\u5c31\u884c\u3002\n\n\u95ee\u9898\u5c31\u53d8\u6210\uff1a\n\n$1,2,\\dots ,m \\cup2,4,\\dots,2m\\cup3,6,\\dots,3m\\cup\\dots$ \n\n\u8fd9\u4e9b\u6570\u4e2d\u6709\u591a\u5c11\u4e2a\u4e0d\u91cd\u590d\u7684\u6570\u3002\n\n\u53d1\u73b0\u662f\u6240\u6709 $[1,k\\times m]$ \u4e2d $k$ \u7684\u500d\u6570\u7684\u5e76\u96c6\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5927\u529b\u5bb9\u65a5\u53bb\u505a\u3002\n\n\u590d\u6742\u5ea6\u4e0e $m$ \u65e0\u5173\uff0c\u4f46\u662f\u5177\u4f53\u662f\u591a\u5c11\u6211\u5e76\u4e0d\u4f1a\u8bc1\uff0c\u8f93\u51fa\u4e86\u4e0b\u6b21\u6570\u5927\u6982\u662f $n\\log n$ \u7ea7\u522b\u7684\u3002\uff08$10^6$ \u8dd1\u4e86 $2\\times10^7$ \u6b21\uff09\u3002\n\n~~\u6240\u4ee5\u8fd9\u9898\u7684 $m$ \u53ef\u4ee5\u88ab\u5f3a\u5316\u5230 $1e18$ \u54e9\uff01~~\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int MAXN = 1e6+5;\nint n,m,lg[MAXN];\nbool vis[MAXN];\nll gcd(ll x,ll y){return y==0?x:gcd(y,x%y);}\nll lcm(ll x,ll y){return x/gcd(x,y)*y;}\nint main()\n{\n\tfor(int i=2;i<=1000000;++i) lg[i]=lg[i>>1]+1;\n\tscanf(\"%d %d\",&n,&m);\n\tll Ans=1;\n\tfor(ll i=2;i<=n;++i)\n\t{\n\t\tif(vis[i]) continue;\n\t\tint siz=1;\n\t\tfor(ll j=i*i;j<=n;j=j*i) vis[j]=1,++siz;\n\t\tfor(int s=1;s<(1<<siz);++s)\n\t\t{\n\t\t\tint c=__builtin_popcount(s);\n\t\t\tll g=lg[(s&(-s))]+1,v=1;\n\t\t\tfor(int j=0;j<siz;++j) if((1<<j)&s) v=lcm(v,j+1);\n\t\t\tif(c&1) Ans+=g*m/v;\n\t\t\telse Ans-=g*m/v;\n            //\u6ce8\u610f\u8fd9\u91cc\u5bb9\u65a5\u7684\u65f6\u5019\u4ea4\u96c6\u4e00\u5b9a\u662f\u5728 1\u5230\u6700\u5c0f\u7684km \u4e4b\u95f4 \n\t\t}\n\t}\n\tprintf(\"%lld\\n\",Ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1649945825,
        "uid": 141485,
        "name": "A_Sunny_Day",
        "ccfLevel": 0,
        "title": "CF1646E Power Board"
    },
    {
        "content": "\u6ce8\u610f\u5230\u7b2c $d,d^2,d^3,\\cdots,d^k(k=\\lfloor \\log_d n\\rfloor )$ \u884c\u53ef\u4ee5\u4e00\u8d77\u8003\u8651\u3002\n\n\u5bf9\u6240\u6709\u7b2c $d,d^2,d^3,\\cdots,d^k$ \u884c\u7684\u6570\u5bf9 $d$ \u53d6\u5bf9\u6570\uff0c\u4e0d\u96be\u53d1\u73b0\u8d21\u732e\u662f $1\\times 1,1\\times 2,\\cdots,1\\times m,\\cdots,k\\times 1,k\\times 2,\\cdots,k\\times m$ \u4e2d\u4e0d\u540c\u6570\u7684\u4e2a\u6570\u3002\n\n\u4e0a\u8ff0\u8d21\u732e\u53ef\u4ee5\u8f7b\u677e $O(m\\log n)$ \u8f7b\u677e\u6c42\u51fa\u3002\n\n\u603b\u590d\u6742\u5ea6 $O(m\\log n+n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nconst int NR=1e6+10;\nint n,m,ans=1,a[30],vis[NR],now;\nbool buc[NR*20]; \nunordered_map<int,int>mp;\n\nsigned main(){\n\tcin>>n>>m;\n\tfor(int i=1;i<=20;i++){\n\t\tfor(int j=1;j<=m;j++)now+=buc[i*j]^1,buc[i*j]=1;\n\t\ta[i]=now;\n\t}\n\tfor(int i=2;i<=n;i++)\n\t\tif(!vis[i]){\n\t\t\tint x=i,cnt=0;\n\t\t\twhile(x<=n)cnt++,vis[x]=1,x*=i;\n\t\t\tans+=a[cnt];\n\t\t}\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1661000049,
        "uid": 117771,
        "name": "intel_core",
        "ccfLevel": 7,
        "title": "CF1646E \u9898\u89e3"
    },
    {
        "content": "## CF1646E Power Board\n\n### \u5927\u610f\n\n\u6709\u4e00\u4e2a $ n \\times m  $ \u7684\u77e9\u9635\uff0c\u7b2c $ i $ \u884c\u7b2c $ j $ \u5217\u4e0a\u5199\u7740 $ i^j $ \uff0c\u95ee\u77e9\u9635\u4e2d\u6709\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u6570\u3002\n\n### \u601d\u8def\n\n\u9996\u5148\uff0c\u628a\u7b2c\u4e00\u884c\u7279\u6b8a\u5904\u7406\u3002\n\n\u6211\u4eec\u628a $ i $ \u5206\u89e3\u4e3a $ j^k $ \uff0c\u6ee1\u8db3 $ j $ \u6700\u5c0f\u3002\n\n\u53d1\u73b0\u5bf9\u4e8e\u4e0d\u540c\u7684 $ i $ \uff0c\u5f53\u4e14\u4ec5\u5f53 $ j $ \u5411\u7b49\u65f6\u8be5\u884c\u624d\u53ef\u80fd\u91cd\u3002\n\n\u5bf9\u4e8e\u76f8\u540c\u7684 $ j $ \u7684 $ k $ \u7ec4\u6210\u7684\u96c6\u5408\u53d1\u73b0\u4e00\u5b9a\u7531 $ [1,log_{j}n] $ \u4e2d\u7684\u6574\u6570\u7ec4\u6210\u3002\n\n\u5bf9\u4e8e $ j $ \u7684\u53ef\u884c $ k $ \u7ec4\u6210\u7684\u96c6\u5408\uff0c\u4e0d\u91cd\u7684\u6570\u5b57\u4e2a\u6570\u4ec5\u4e0e\u96c6\u5408\u5927\u5c0f\u6709\u5173\u3002\n\n\u53d1\u73b0 $ log_{2}10^{6} < 20 $ \uff0c\u4e5f\u5c31\u662f\u96c6\u5408\u5927\u5c0f\u4e0d\u8d85\u8fc7 $ 19 $ \uff0c\u53ef\u4ee5\u9010\u4e2a\u5904\u7406\u3002\n\n\u95ee\u9898\u53d8\u6210\u4e86\u5bf9\u4e8e $ 1 \\leq x \\leq 19 $ \uff0c\u6c42\u6ee1\u8db3 $ 1 \\leq y \\leq x $ \uff0c $ 1 \\leq z \\leq m $ \uff0c\u4e0d\u540c\u7684 $ y \\times z $ \u7684\u6570\u91cf\u3002\n\n\u5f00\u4e2a\u6570\u7ec4\u66b4\u529b\u7edf\u8ba1\u5373\u53ef\u3002\n\n\u6240\u4ee5\u5148\u679a\u4e3e $ j $ \uff0c\u5c06\u5176\u8d21\u732e\u7d2f\u52a0\u5373\u7b54\u6848\u3002\n\n### \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define f(i,j,k) for(register int i=j;i<=k;++i)\n#define g(i,j,k) for(register int i=j;i>=k;--i)\nint n,m,s,l;\nlong long ans;\nint a[1010101];\nint v[1010101];\nint p[20202020];\nint main(){\n    cin>>n>>m;\n    f(i,1,20){\n        f(j,1,m)if(!p[i*j])l+=(p[i*j]=1);\n        a[i]=l;\n    }\n    f(i,2,n)if(!v[i]){\n        s=1;l=0;\n        while(1ll*s*i<=1ll*n)l+=(v[s*=i]=1);\n        ans+=a[l];\n    }\n    printf(\"%lld\\n\",ans+1);\n    return 0;\n}\n```",
        "postTime": 1650697468,
        "uid": 218376,
        "name": "IloveSurtr",
        "ccfLevel": 7,
        "title": "CF1646E"
    },
    {
        "content": "~~\u56e0\u4e3a\u6211\u592a\u83dc\u4e86\uff0c\u6240\u4ee5\u5c0f\u9898\u5927\u505a\u4e86\u3002~~\n\n\u8003\u8651\u884c $j$ \u4f1a\u628a\u884c $i$ \u90e8\u5206\u8986\u76d6\uff08$i<j$\uff09\uff0c\u5982\u679c\u5b58\u5728\u4e00\u4e2a**\u6700\u5c0f**\u7684 $x$ \u4f7f\u5f97 $i=x^a,j=x^b$\uff0c\u90a3\u4e48\u884c $i$ \u6709\u4e14\u4ec5\u6709\u6ee1\u8db3 $\\dfrac{b}{\\gcd(a,b)}k\\,(k\\in\\mathbb N)$ \u7684\u4f4d\u7f6e\u90fd\u4f1a\u88ab\u8986\u76d6\u3002\u5bf9\u4e8e\u7b2c $i$ \u884c\uff0c$x,a$ \u662f\u786e\u5b9a\u7684\uff0c\u6240\u4ee5\u8981\u5148\u7528 $\\mathcal O(\\log n)$ \u627e\u51fa\u6240\u6709 $b$\uff0c\u518d\u7528 $\\mathcal O(\\log\\log n)$ \u6c42\u51fa $d=\\dfrac{b}{\\gcd(a,b)}$\u3002\u6839\u636e\u5bb9\u65a5\u539f\u7406\uff0c\u5bf9\u4e8e**\u6ca1\u6709**\u88ab\u8986\u76d6\u4f4d\u7f6e\u6570\uff0c\u5947\u6570\u4e2a $d$ \u7684\u8d21\u732e\u662f $-\\dfrac{m}{\\rm lcm}$\uff0c\u5076\u6570\u4e2a $d$ \u7684\u8d21\u732e\u662f $\\dfrac{m}{\\rm lcm}$\uff0c\u53ef\u4ee5\u628a\u6240\u6709\u53ef\u80fd\u7684 $d$ \u7684\u96c6\u5408\u7684\u603b\u8d21\u732e\u8fdb\u884c\u9884\u5904\u7406\uff0c\u901a\u8fc7 `FWT` \u4f18\u5316\u9ad8\u7ef4\u524d\u7f00\u548c\uff0c\u6700\u7ec8\u590d\u6742\u5ea6\u662f $\\mathcal O(n\\log n\\log\\log n+n\\log n)$\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#define ll long long\nusing namespace std;\nint c[1<<20],vi[1000005];\nint gcd(int x,int y){\n\treturn y?gcd(y,x%y):x;\n}\nvoid FWT(int n){\n\tfor(int i=1;i<n;i<<=1){\n\t\tfor(int j=0;j<n;j+=(i<<1)){\n\t\t\tfor(int k=j;k<i+j;k+=1){\n\t\t\t\tc[k+i]+=c[k];\n\t\t\t}\n\t\t}\n\t}\n\treturn;\n}\nvoid init(int n,int m){\n\tfor(int i=0;i<(1<<n);i+=1){\n\t\tint now=1,pc=0;\n\t\tfor(int j=0;j<n;j+=1){\n\t\t\tif(i>>j&1){\n\t\t\t\tnow/=gcd(now,j+1);\n\t\t\t\tif(now>m/(j+1)){\n\t\t\t\t\tpc=-1; break;\n\t\t\t\t}\n\t\t\t\tnow*=(j+1); pc+=1;\n\t\t\t}\n\t\t}\n\t\tif(~pc){\n\t\t\tif(pc&1) c[i]=-m/now;\n\t\t\telse c[i]=m/now;\n\t\t}\n\t}\n\tFWT(1<<20);\n\treturn;\n}\nint main(){\n\tint n,m; ll ans=1;\n\tscanf(\"%d%d\",&n,&m); init(20,m);\n\tfor(int i=2,j;i<=n;i+=1){\n\t\tif(vi[i]) continue;\n\t\tj=1;\n\t\tfor(int k=i;k<=n/i;){\n\t\t\tk*=i; vi[k]=1; j+=1;\n\t\t}\n\t\tfor(int k=1;k<=j;k+=1){\n\t\t\tint s=0;\n\t\t\tfor(int l=k+1;l<=j;l+=1){\n\t\t\t\ts|=(1<<(l/gcd(l,k)-1));\n\t\t\t}\n\t\t\tans+=1ll*c[s];\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n\nThanks~",
        "postTime": 1662625941,
        "uid": 189682,
        "name": "QQ82272760",
        "ccfLevel": 7,
        "title": "CF1646E Power Board \u9898\u89e3"
    },
    {
        "content": "\u5148\u8003\u8651\u54ea\u4e9b\u6570\u53ef\u80fd\u4f1a\u4ea7\u751f\u91cd\u590d\u3002\n\n\u5bf9\u4e8e\u7b2c $x$ \u884c\uff0c\u663e\u7136\u53ea\u6709\u7b2c $x^2,x^3...x^k$ \u884c\u4e0a\u7684\u6570\u53ef\u80fd\u4e0e\u5b83\u6709\u91cd\u590d\u3002\n\n\u8003\u8651\u53bb\u8ba1\u7b97\u8fd9\u4e2a\u4e1c\u897f\uff0c\u8bbe $f_k$ \u8868\u793a\u5bf9\u5e94\u7684\u7b54\u6848\u3002\n\n\u95ee\u9898\u8f6c\u5316\u4e3a $i\\in [1,k],j\\in [1,m]$\uff0c\u6c42 $ij$ \u6709\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u53d6\u503c\u3002\n\n\u7531\u4e8e $k$ \u662f $\\log n$ \u7ea7\u522b\u7684\uff0c\u53ef\u4ee5\u76f4\u63a5\u66b4\u529b\u679a\u4e3e\uff0c\u7136\u540e\u679a\u4e3e $x$ \u5c31\u505a\u5b8c\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(m\\log n+n)$\u3002",
        "postTime": 1647300355,
        "uid": 98490,
        "name": "houzhiyuan",
        "ccfLevel": 7,
        "title": "CF1646E"
    },
    {
        "content": "### Preface\n\n\u300c\u8fd9\u4e0d\u662f\u7b80\u5355\u7684\u6570\u8bba\u9898\u5417\uff1f\u300d\n\n\u300c\u662f\u554a\u3002\u300d\n\n\u300c\u90a3\u4e3a\u5565\u8fd9\u6709\u4e00\u4e2a\u2191\u2193\u660e\u660e\u4f1a\u6b63\u89e3\u5374\u6ca1\u5199\u51fa\u6765\u2026\u2026\u300d\n\n### Analysis\n\n\u7b2c\u4e00\u884c\u5355\u72ec\u7b97\uff0c\u76f4\u63a5\u5224\u6389\u4e0d\u518d\u8003\u8651\u3002\n\n\u8bbe\u6bcf\u884c\u9996\u4e2a\u4e3a**\u4ee3\u8868\u5143**\u3002\u7531\u4e8e $2^{20}>10^6$\uff0c\u4e5f\u5c31\u662f\u8bf4\u4efb\u610f\u4e24\u4e2a\u4ee3\u8868\u5143 $x,y$ \u6709 $\\log_xy<20$\n\n\u8bbe $f(x)$ \u4e3a\u6700\u5c0f\u7684\u6b63\u6574\u6570 $y$ \u4f7f\u5f97 $\\log_y x\\in\\mathbb{N}$\u3002\u6211\u4eec\u79f0\u4e00\u4e9b\u4ee3\u8868\u5143\u4e3a**\u4e00\u65cf**\uff08\u5143\u7d20\u5468\u671f\u8868\u4e71\u5165\uff09\uff0c\u5f53\u4e14\u4ec5\u5f53\u5979\u4eec\u7684 $f$ \u76f8\u540c\u3002\u663e\u7136\u5355\u4e2a\u65cf\u7684\u5927\u5c0f\u4e0d\u8d85\u8fc7 $20$\u3002\n\n\u53d1\u73b0**\u4e0d\u540c\u65cf\u4e4b\u95f4\u4e0d\u53ef\u80fd\u6709\u6570\u76f8\u540c**\uff0c\u6211\u4eec\u5c06\u6bcf\u4e2a\u7ec4\u5206\u5f00\u8003\u8651\u3002\n\n\u53d1\u73b0**\u53ea\u8981\u65cf\u7684\u5927\u5c0f\u76f8\u7b49\uff0c\u6240\u542b\u4e0d\u540c\u5143\u7d20\u4e2a\u6570\u5fc5\u7136\u76f8\u540c**\uff0c\u6211\u4eec\u9884\u5904\u7406\u51fa\u4e0d\u540c\u5927\u5c0f\u65cf\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5373\u53ef\u3002\n\n\u65f6\u95f4 $O(20m)$ \u9884\u5904\u7406 \u548c $O(n)$ \u8ba1\u7b97\u3002\n\n### Code\n\n[Link](https://codeforces.com/contest/1646/submission/149199155)",
        "postTime": 1647182715,
        "uid": 101868,
        "name": "I_am_Accepted",
        "ccfLevel": 0,
        "title": "CF1646E Power Board"
    },
    {
        "content": "[\u4f20\u9001\u95e8](https://codeforces.com/contest/1646/problem/E)  \n\n## \u9898\u610f  \n\u7ed9\u4e00\u4e2a $n\\times m$ \u7684\u77e9\u9635\uff0c\u77e9\u9635\u7684 $(i,j)$ \u4f4d\u7f6e\u7684\u6570\u4e3a $i^j$\u3002  \n\u6c42\u603b\u5171\u6709\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u6570\u3002  \n$n,m\\leq 10^6$  \n\n## Solution  \n\u9996\u5148\u7b2c\u4e00\u884c\u5168\u662f 1\uff0c\u6700\u4e3a\u7279\u6b8a\uff0c\u7279\u5224\u6389\u3002  \n\u6765\u8003\u8651\u4e00\u4e0b\u54ea\u4e9b\u884c\u4f1a\u9020\u6210\u91cd\u590d\u3002  \u5f53 $i$ \u80fd\u8868\u793a\u6210 $x^k$ \u4e14 $k>1$ \u7684\u65f6\u5019\uff0c\u624d\u4f1a\u53d1\u751f\u91cd\u590d\u3002  \n\u5f53\u524d\u9762\u6709 $i'$ \u80fd\u8868\u793a\u4e3a $x^{k'}$ \u7684\u65f6\u5019\uff0c\u5728 $j\\times k=j'\\times k'$ \u7684\u65f6\u5019\uff0c\u5c31\u4f1a\u53d1\u751f\u91cd\u590d\u3002  \n\u56e0\u6b64\u6211\u4eec\u9884\u5904\u7406\u54ea\u4e9b\u6570\u53ef\u4ee5\u8868\u793a\u4e3a\u6b21\u5e42\u6570\uff0c\u5e76\u6c42\u51fa\u662f\u591a\u5c11\u6b21\u5e42\u3002\u5176\u6b21\u6211\u4eec\u53d1\u73b0 $x$ \u662f\u591a\u5c11\u5e76\u4e0d\u5f71\u54cd\u91cd\u590d\u7684\u6570\u91cf\uff0c\u4e8e\u662f\u90fd\u5f53\u4f5c $2$ \u6765\u505a\uff0c\u7528\u7b5b\u6cd5\u7b5b\u4e00\u904d\u5373\u53ef\u3002  \n\n## Code  \n```cpp\n#include<bits/stdc++.h>\n#define forn(i,a,b)for(int i=(a),_b=(b);i<=_b;i++)\n#define fore(i,b,a)for(int i=(b),_a=(a);i>=_a;i--)\n#define rep(i,n)for(int i=0,_n=n;i<n;i++)\n#define ll long long\n#define pii pair<int,int>\n#define m_p make_pair\n#define pb push_back\n#define fi first\n#define se second\n#define int ll\n#define foreach(i,c) for(__typeof(c.begin())i=(c.begin());i!=(c).end();i++)\nusing namespace std;\nconst int N=1000010;\nint n,m;\nint b[N];\nint r[33];\nbool used[N*25];\nsigned main(){\n   cin.tie(0);\n\tios::sync_with_stdio(0);\n\tforn(i,2,1002){\n\t\tif(b[i])continue;\n\t\tint cnt=1;\n\t\tfor(int j=i*i;j<=1000500ll;j*=i){\n\t\t\tb[j]=++cnt;\n\t\t}\n\t}\n\tcin>>n>>m;\n\tforn(j,1,m)used[j]=1;\n\tforn(i,2,20){\n\t\tr[i]=m;\n\t\tforn(j,1,m){\n\t\t\tif(used[j*i]){\n\t\t\t\tr[i]--;\t\n\t\t\t}\n\t\t\telse{\n\t\t\t\tused[j*i]=1;\n\t\t\t}\n\t\t}\n\t}\n\tint ans=1; \n\tforn(i,2,n){\n\t\tif(!b[i])ans+=m;\n\t\telse{\n\t\t\tans+=r[b[i]];\n\t\t}\n\t}\n\tcout<<ans<<\"\\n\";\n\treturn 0;\n}",
        "postTime": 1646919497,
        "uid": 257565,
        "name": "BlabaDouble",
        "ccfLevel": 0,
        "title": "CF1646E\u9898\u89e3"
    },
    {
        "content": "\u7ed9\u4e00\u4e2a\u8d85\u7ea7\u66b4\u529b\u505a\u6cd5\u3002\n\n\u5b9a\u4e49\u4e24\u884c\u662f **\u51b2\u7a81** \u7684\uff0c\u5f53\u4e14\u4ec5\u5f53\u8fd9\u4e24\u884c\u5728 $m\\to\\infty$ \u65f6\u6709\u91cd\u590d\u5143\u7d20\u3002\uff08\u5b9a\u4e49\u4e25\u8c28\u4e9b\uff0c\u56e0\u4e3a $m$ \u5f88\u5c0f\u7684\u65f6\u5019\u51b2\u7a81\u7684\u4e24\u884c\u4e0d\u4e00\u5b9a\u6709\u91cd\u590d\u5143\u7d20\uff09\n\n\u8003\u8651\u67d0\u4e00\u884c $i$\uff0c\u6ee1\u8db3\u6574\u4e2a\u8868\u4e2d\u6709\u4e14\u4ec5\u6709\u53e6\u4e00\u884c\u4e0e\u5b83\u51b2\u7a81\uff0c\u5373 $\\sqrt[3]{n} < i \\le \\sqrt{n}$ \u3002\u628a\u8fd9\u4e24\u884c\u653e\u5728\u4e00\u8d77\u770b\uff0c\u6240\u6709\u5143\u7d20\u5373\u4e3a $i^1,i^2,\\cdots i^m,i^2,i^4,\\cdots i^{2m}$\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u770b\u51fa\u8fd9\u91cc\u9762\u4e0d\u540c\u5143\u7d20\u7684\u4e2a\u6570\u5c31\u662f $m+\\left\\lceil\\frac{m}{2}\\right\\rceil$\uff08\u56e0\u4e3a\u540e\u9762 $m$ \u4e2a\u5143\u7d20\u53ea\u6709\u4e00\u534a\u662f\u6709\u8d21\u732e\u7684\uff09\u3002\n\n\u4f46\u662f\u5982\u679c\u5bf9\u4e8e\u66f4\u5c0f\u7684 $i$\uff0c\u4e0d\u592a\u5bb9\u6613\u5728 $O(1)$ \u65f6\u95f4\u5185\u8ba1\u7b97\u6240\u6709\u8ddf $i$ \u51b2\u7a81\u7684\u884c\uff0c\u5982\u679c\u540c\u4e0a\u9762\u7684\u8fc7\u7a0b\u4f60\u4f1a\u53d1\u73b0\u6709\u91cd\u590d\u8ba1\u7b97\u7684\uff0c\u8fd8\u53ef\u80fd\u6709\u6f0f\u8ba1\u7b97\u7684\u3002\n\n\u65e2\u7136\u4e09\u884c\u53ca\u4ee5\u4e0a\u76f8\u4e92\u51b2\u7a81\u7684\u60c5\u51b5\u4e0d\u597d\u7b97\uff0c\u90a3\u6211\u4eec\u7d22\u6027\u66b4\u529b\u3002\u53d1\u73b0\u8fd9\u6837\u7684 $i \\le \\sqrt[3]{n}$\uff0c\u90a3\u4e48\u76f4\u63a5\u4ece $1$ \u679a\u4e3e\u5230 $\\sqrt[3]{n}$\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u7ec4\u4e92\u76f8\u51b2\u7a81\u7684\u884c\uff0c\u5f00\u4e00\u4e2a\u6876\u7528\u4e8e\u8ba1\u6570\u3002\u7136\u540e\u5bf9\u4e8e\u5927\u4e8e $\\sqrt[3]{n}$ \u7684\u884c\uff0c\u6309\u4e00\u5f00\u59cb\u63a8\u7684\u65b9\u6cd5\u8ba1\u7b97\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(m\\sqrt[3]{n}\\log n+n)$\uff0c\u56e0\u4e3a\u524d\u9762\u90a3\u4e00\u5768\u4e1c\u897f\u6839\u672c\u8dd1\u4e0d\u6ee1\uff0c\u6240\u4ee5\u80fd\u8fc7\u3002\u5177\u4f53\u7ec6\u8282\u89c1\u4ee3\u7801\u3002\n\n```c++\n#include<bits/stdc++.h>\nusing namespace std;\n#define N 1000003\n#define LL long long\n#define INF 0x3f3f3f3f\nLL n,m;\nbool vis[N],b[N*32];\nint main(){\n    scanf(\"%lld%lld\",&n,&m);\n    LL res=1;\n    int lim=pow(n,1.0/3)+0.5;\n    LL i=2;\n    for(;i<=lim;++i){  //\u524dlim\u884c\u76f4\u63a5\u679a\u4e3e\n        if(vis[i]) continue;\n        LL nw=i;\n        int cnt=1,ctt=0;\n        while(nw<=n){\n            vis[nw]=true;\n            for(int j=1;j<=m;++j)\n                if(!b[cnt*j]) b[cnt*j]=true,ctt++;\n            nw*=i,cnt++;\n        }\n        nw=i,cnt=1;\n        while(nw<=n){\n            for(int j=1;j<=m;++j)\n                b[cnt*j]=false;\n            nw*=i,cnt++;\n        }\n        res+=ctt;\n    }\n    for(;i<=n;++i){  //\u540e\u9762\u7684\u884c\u516c\u5f0f\u8ba1\u7b97\n        if(vis[i]) continue;\n        res+=m;\n        if(i*i<=n) vis[i*i]=true,res+=(m+1)/2;\n    }\n    printf(\"%lld\\n\",res);\n    return 0;\n}\n```",
        "postTime": 1661166997,
        "uid": 239895,
        "name": "Yusani_huh",
        "ccfLevel": 7,
        "title": "CF1646E \u9898\u89e3"
    }
]
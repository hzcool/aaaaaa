[
    {
        "content": "\u545c\u545c\u545c\uff0c\u8c03\u4e86\u6211\u4e00\u4e0b\u5348\u7684\u77e9\u9635\u5feb\u901f\u5e42\u3002(\uff1b\u2032\u2312`)\n\n### Solution\n\n\u9996\u5148\uff0c\u6211\u4eec\u5c06\u9898\u76ee\u7684\u610f\u601d\u6a21\u62df\u4e00\u4e0b\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n$$\ndx_i=dx_{i-1}+sx_{i-1}+sy_{i-1}+i-1,\\\\dy_i=dy_{i-1}+sx_{i-1}+sy_{i-1}+i-1,\\\\sx_i=sx_{i-1}+dx_i,sy_i=sy_{i-1}+dy_i\n$$\n\u4f46\u662f\u56e0\u4e3a\u8981 $\\%n$ \uff0c\u6240\u4ee5\u5750\u6807\u4ece $1\\sim n$ \u5230\u4e86 $0\\sim n-1$ \uff0c\u90a3\u4e48\u6211\u4eec\u7684\u901f\u5ea6\u6b64\u65f6\u4f1a\u5c112\uff0c\u56e0\u6b64\u518d\u52a0\u4e0a\u4e00\u4e2a2\u3002\n\n\u4e8e\u662f\u5c31\u6709\uff1a\n$$\ndx_i=dx_{i-1}+sx_{i-1}+sy_{i-1}+(i-1)+2\\\\dy_i=dy_{i-1}+sx_{i-1}+sy_{i-1}+(i-1)+2\\\\sx_i=sx_{i-1}+dx_i=2\\times sx_{i-1}+dx_{i-1}+sy_{i-1}+(i-1)+2,\\\\sy_i=sy_{i-1}+dy_i=2\\times sy_{i-1}+dy_{i-1}+sx_{i-1}+(i-1)+2\n$$\n\u4e0b\u4e00\u6b65\uff0c\u6211\u53d1\u73b0 $0\\le t\\le 10^{18}$ \uff0c\u4e8e\u662f\u60f3\u5230\u4e86**\u77e9\u9635\u5feb\u901f\u5e42**\uff0c\u53d1\u73b0\u7684\u786e $sx,sy,dx,dy,i$ \u90fd\u548c\u4e0a\u4e00\u6b65\u6709\u5173\u7cfb\uff0c\u90a3\u4e48\u8f6c\u79fb\u77e9\u9635\u5c31\u51fa\u6765\u4e86\uff1a\n$$\n\\begin{bmatrix}2~~~1~~~1~~~0~~~1~~~2\\\\1~~~2~~~0~~~1~~~1~~~2\\\\1~~~1~~~1~~~0~~~1~~~2\\\\1~~~1~~~0~~~1~~~1~~~2\\\\0~~~0~~~0~~~0~~~1~~~1\\\\0~~~0~~~0~~~0~~~0~~~1\\end{bmatrix}\n$$\n\n\u521d\u59cb\u77e9\u9635\u4e5f\u6709\uff1a\n$$\n\\begin{bmatrix}sx_0\\\\sy_0\\\\dx_0\\\\dy_0\\\\0\\\\1\\end{bmatrix}\n$$\n\u7136\u540e\u5c31\u662f\uff1a\n$$\n\\begin{bmatrix}sx_n\\\\sy_n\\\\dx_n\\\\dy_n\\\\t\\\\1\\end{bmatrix}=\\begin{bmatrix}2~~~1~~~1~~~0~~~1~~~2\\\\1~~~2~~~0~~~1~~~1~~~2\\\\1~~~1~~~1~~~0~~~1~~~2\\\\1~~~1~~~0~~~1~~~1~~~2\\\\0~~~0~~~0~~~0~~~1~~~1\\\\0~~~0~~~0~~~0~~~0~~~1\\end{bmatrix}^t\\begin{bmatrix}sx\\\\sy\\\\dx\\\\dy\\\\0\\\\1\\end{bmatrix}\n$$\n\u5176\u5b9e\u6700\u540e\u53ea\u9700\u8981 $sx_n,sy_n$ \uff0c\u6240\u4ee5\u8f6c\u79fb\u5b8c\u53ea\u9700\u8981\u5355\u72ec\u7b97\u4e00\u4e0b\u524d\u4e24\u4e2a\u5c31\u884c\u4e86\u3002\n\n### \u4ee3\u7801\n\n```C++\n#include<bits/stdc++.h>\n#define int long long\n\nusing namespace std;\nconst int N=15;\nint n,sx,sy,dx,dy,t,mod,y[N];\n\ninline int read(){\n    int x=0,f=1;\n    char ch=getchar();\n    while(!isdigit(ch)){if(ch=='-') f=-1;ch=getchar();}\n    while(isdigit(ch)){x=x*10+(ch^48);ch=getchar();}\n    return x*f;\n}\n\ninline int add(int a,int b){return a+b<mod?a+b:a+b-mod;}\ninline int sub(int a,int b){return a<b?a-b+mod:a-b;}\ninline int mul(int a,int b){return 1ll*a*b%mod;}\n\ninline fpow(int a,int b){\n    int res=1;\n    while(b){   \n        if(b&1) res=mul(res,a);\n        a=mul(a,a);\n        b>>=1;\n    }\n    return res;\n}\n\nstruct matrix{\n    int a[N][N];\n    matrix(){memset(a,0,sizeof(a));}\n    matrix operator * (const matrix &x) const {\n        matrix ans;\n        for(int i=1;i<=6;i++)\n            for(int j=1;j<=6;j++)\n                for(int k=1;k<=6;k++)\n                    ans.a[i][j]=add(ans.a[i][j],mul(a[i][k],x.a[k][j]));\n        return ans;\n    }\n}I;\n\nmatrix Fpow(matrix a,int b){\n    matrix res;\n    for(int i=1;i<=6;i++) res.a[i][i]=1;\n    while(b){\n        if(b&1) res=res*a;\n        a=a*a;\n        b>>=1;\n    }\n    return res;\n}\n\ninline void init(){\n    y[1]=sx-1,y[2]=sy-1,y[3]=dx,y[4]=dy,y[5]=0,y[6]=1;\n    I.a[1][1]=I.a[2][2]=I.a[1][6]=I.a[2][6]=I.a[3][6]=I.a[4][6]=2;\n    I.a[1][2]=I.a[1][3]=I.a[1][5]=I.a[2][1]=I.a[2][4]=I.a[2][5]=I.a[3][1]=I.a[3][2]=I.a[3][3]=\n    I.a[3][5]=I.a[4][1]=I.a[4][2]=I.a[4][4]=I.a[4][5]=I.a[5][5]=I.a[5][6]=I.a[6][6]=1;\n}\n\nsigned main(){\n    scanf(\"%lld%lld%lld%lld%lld%lld\",&n,&sx,&sy,&dx,&dy,&t);\n    if(t==0){\n        printf(\"%lld %lld\",sx,sy);\n        return 0;\n    }\n    mod=n;\n    init();\n    I=Fpow(I,t);\n    int ex=0,ey=0;\n    for(int i=1;i<=6;i++)\n        ex=((ex+I.a[1][i]*y[i])%mod+mod)%mod;\n    for(int i=1;i<=6;i++)\n        ey=((ey+I.a[2][i]*y[i])%mod+mod)%mod;\n    printf(\"%lld %lld\",ex+1,ey+1);\n    return 0;\n}\n```\n\n",
        "postTime": 1600947851,
        "uid": 272143,
        "name": "\u662f\u4e2a\u6c49\u5b50",
        "ccfLevel": 4,
        "title": "CF385E Bear in the Field"
    },
    {
        "content": "Upd:\u8f6c\u79fb\u77e9\u9635\u4e2d\u6700\u540e\u4e00\u4e2a\u6570\u6253\u9519\u4e86\uff0c\u5df2\u4fee\u6539\u3002\u5341\u5206\u62b1\u6b49QAQ\n\n\u597d\u4e45\u6ca1\u6709\u5199\u77e9\u9635\u4e86\uff0c\u5199\u6302\u4e86\u597d\u51e0\u6b21QAQ\u3002\u51e0\u4e4e\u6240\u6709\u7684\u5751\u90fd\u8df3\u4e86\u4e00\u904d\u2026\u2026\n\n\u9898\u76ee\u5927\u610f\uff1a\u7ed9\u5b9a\u4e00\u4e2a$n \\times n$\u7684\u77e9\u9635\uff0c\u5750\u6807\u4e3a$(x,y)$\u7684\u683c\u5b50\u7684\u6743\u503c\u4e3a$x+y$\u3002\u4e00\u4e2a\u4eba\u521d\u59cb\u5728$(sx,sy)$\u5904\uff0c\u521d\u59cb\u901f\u5ea6\u4e3a$(dx,dy)$\uff0c\u4ed6\u4e0b\u4e00\u79d2\u80fd\u5230\u8fbe\u7684\u5730\u65b9\u4e3a$((x+dx-1)\\mod n+1,(y+dy-1)\\mod n+1)$\u3002\u5f53\u4eba\u5230\u8fbe\u4e00\u4e2a\u5730\u65b9$(x,y)$\u65f6\uff0c\u4ed6\u7684\u901f\u5ea6\u5c06\u4f1a\u53d8\u4e3a$(dx+x+y,dy+x+y)$\u3002\u6bcf\u79d2\u949f\u6240\u6709\u683c\u5b50\u5185\u7684\u6743\u503c\u90fd\u4f1a\u52a0$1$\u3002\u95ee$t$\u79d2\u540e\u4eba\u6240\u5728\u7684\u4f4d\u7f6e\u3002\n\n\u6b63\u89e3\uff1a\u77e9\u9635\u5feb\u901f\u5e42\u3002\n\n\u8bbe$sx(i)$\u8868\u793a\u7b2c$i$\u79d2\u65f6\u4eba\u6240\u5728\u683c\u5b50\u7684\u6a2a\u5750\u6807\uff0c$sy(i)$\u8868\u793a\u6240\u5728\u683c\u5b50\u7684\u7eb5\u5750\u6807\uff1b$dx(i)$\u8868\u793a\u7b2c$i$\u79d2\u65f6\u4eba\u7684\u6a2a\u5411\u901f\u5ea6\uff0c$dy(i)$\u8868\u793a\u7b2c$i$\u79d2\u65f6\u7684\u7eb5\u5411\u901f\u5ea6\u3002\u6839\u636e\u9898\u610f\u6709\uff1a\n$dx(t)=dx(t-1)+sx(t-1)+sy(t-1)+t-1$\n\n$dy(t)=dy(t-1)+sx(t-1)+sy(t-1)+t-1$\n\n\uff08\u522b\u5fd8\u4e86\u6bcf\u79d2\u949f\u683c\u5b50\u7684\u6743\u503c\u4f1a\u52a0$1$\uff09\n\n\u540c\u65f6\u6839\u636e\u9898\u610f\u6709\uff1a\n\n$sx(t)=sx(t-1)+dx(t)$\n\n$sy(t)=sy(t-1)+dy(t)$\n\n\u8003\u8651\u53d6\u4f59\u64cd\u4f5c\uff0c\u8fd9\u4f7f\u5f97$\\mod n$\u540e\u7684\u503c\u53ea\u53ef\u80fd\u5728$[0,n-1]$\u4e2d\u3002\u6240\u4ee5\u6211\u4eec\u4e0d\u59a8\u5e73\u79fb\u4eba\uff0c\u5c06\u4eba\u7684\u4f4d\u7f6e\u5206\u522b\u5f80\u4e0a\uff0c\u5f80\u5de6\u79fb\u52a8\u4e00\u683c\u3002\u8fd9\u6837\u5750\u6807\u5c31\u53d8\u4e3a\u4e86$(sx-1,sy-1)$\u3002\u4f46\u8fd9\u6837\u4f1a\u5bfc\u81f4\u901f\u5ea6\u6bd4\u539f\u6765\u7684\u901f\u5ea6\u5c11$2$\uff0c\u6240\u4ee5\u8981\u5728\u539f\u6765\u7684\u5f0f\u5b50\u4e2d\u52a0\u4e0a$2$\u3002\u8fd9\u6837\u6211\u4eec\u6709\uff1a\n\n$dx(t)=dx(t-1)+sx(t-1)+sy(t-1)+t-1+2$\n\n$dy(t)=dy(t-1)+sx(t-1)+sy(t-1)+t-1+2$\n\n\u5c06$dx(t),dy(t)$\u4ee3\u5165$sx(t),sy(t)$\u4e2d\uff0c\u5f97\u5230\uff1a\n\n$sx(t)=2\\times sx(t-1)+dx(t-1)+sy(t-1)+t+1$\n\n$sy(t)=2\\times sy(t-1)+dy(t-1)+sx(t-1)+t+1$\n\n\u8003\u8651\u6784\u9020\u8f6c\u79fb\u77e9\u9635\uff0c\u6211\u4eec\u6709\uff1a\n\n$\\begin{bmatrix} sx(t-1) \\\\ sy(t-1)\\\\dx(t-1)\\\\dy(t-1)\\\\t-1\\\\1 \\end{bmatrix}$ $\\times$ $\\begin{bmatrix} 2&1&1&0&1&2  \\\\ 1&2&0&1&1&2\\\\1&1&1&0&1&2\\\\1&1&0&1&1&2\\\\0&0&0&0&1&1\\\\0&0&0&0&0&1\\end{bmatrix}$ $=$ $\\begin{bmatrix} sx(t) \\\\ sy(t)\\\\dx(t)\\\\dy(t)\\\\t\\\\1 \\end{bmatrix}$\n\n\u77e9\u9635\u5feb\u901f\u5e42\u5904\u7406\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6$O(216\\log_2t)$\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<iostream>\n#include<cstring>\n#define int long long\nusing namespace std;\nint n,sx,sy,dx,dy,t,y[10],p;\nstruct node\n{\n\tint a[10][10];\n\tnode(){\n\t\tmemset(a,0,sizeof(a));\n\t}\n\tinline void build(){\n\t\tfor (int i=1;i<=6;i++) a[i][i]=1;\n\t}\n}x;\ninline int read()\n{\n\tint x=0,f=1;char ch=getchar();\n\twhile(!isdigit(ch)){if (ch=='-') f=-1;ch=getchar();}\n\twhile(isdigit(ch)){x=x*10+ch-'0';ch=getchar();}\n\treturn x*f;\n}\ninline void init()\n{\n\tx.a[1][1]=2;x.a[1][2]=1;x.a[1][3]=1;x.a[1][4]=0;x.a[1][5]=1;x.a[1][6]=2;\n\tx.a[2][1]=1;x.a[2][2]=2;x.a[2][3]=0;x.a[2][4]=1;x.a[2][5]=1;x.a[2][6]=2;\n\tx.a[3][1]=1;x.a[3][2]=1;x.a[3][3]=1;x.a[3][4]=0;x.a[3][5]=1;x.a[3][6]=2;\n\tx.a[4][1]=1;x.a[4][2]=1;x.a[4][3]=0;x.a[4][4]=1;x.a[4][5]=1;x.a[4][6]=2;\n\tx.a[5][1]=0;x.a[5][2]=0;x.a[5][3]=0;x.a[5][4]=0;x.a[5][5]=1;x.a[5][6]=1;\n\tx.a[6][1]=0;x.a[6][2]=0;x.a[6][3]=0;x.a[6][4]=0;x.a[6][5]=0;x.a[6][6]=1;\n\ty[1]=sx-1;y[2]=sy-1;y[3]=dx;y[4]=dy;y[5]=0;y[6]=1;\n}\nnode operator * (const node x,const node y)\n{\n\tnode z;\n\tfor (int i=1;i<=6;i++)\n\t\tfor (int j=1;j<=6;j++)\n\t\t\tfor (int k=1;k<=6;k++)\n\t\t\t\tz.a[i][j]=(z.a[i][j]+x.a[i][k]*y.a[k][j]%p+p)%p;\n\treturn z;\n}\nsigned main()\n{\n\t//freopen(\"data.in\",\"r\",stdin);\n\t//freopen(\"ans.out\",\"w\",stdout); \n\tn=read(),sx=read(),sy=read(),dx=read(),dy=read(),t=read();p=n;\n\tif (t==0)\n\t{\n\t\tprintf(\"%lld %lld\",sx,sy);\n\t\treturn 0;\n\t}\n\tinit();\n\tnode ans;ans.build(); \n\twhile(t)\n\t{\n\t\tif (t&1) ans=ans*x;\n\t\tx=x*x;\n\t\tt>>=1;\n\t}\n\tint tx=0,ty=0;\n\tfor(int i=1;i<=6;i++)\n\t\ttx=(tx+y[i]*ans.a[1][i]%p+p)%p,\n\t\tty=(ty+y[i]*ans.a[2][i]%p+p)%p;\n\tprintf(\"%lld %lld\",tx+1,ty+1);\n\treturn 0;\n}\n```\n",
        "postTime": 1600954719,
        "uid": 235013,
        "name": "OceanLiu",
        "ccfLevel": 0,
        "title": "CF385E Bear in the Field \u9898\u89e3\uff08\u77e9\u9635\u5feb\u901f\u5e42\uff09"
    }
]
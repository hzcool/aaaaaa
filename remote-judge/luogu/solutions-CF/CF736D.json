[
    {
        "content": "## \u9898\u76ee\u7ffb\u8bd1\n\n\u73b0\u5728\uff0c\u4f60\u6709\u4e00\u4e2a\u4e8c\u5206\u56fe\uff0c\u70b9\u6570\u4e3a $2n$\u3002\n\n\u5df2\u77e5\u8fd9\u4e2a\u4e8c\u5206\u56fe\u7684\u5b8c\u5907\u5339\u914d\u7684\u4e2a\u6570\u662f\u5947\u6570\u3002\n\n\u73b0\u5728\u4f60\u8981\u77e5\u9053\uff0c\u5220\u9664\u6bcf\u6761\u8fb9\u540e\uff0c\u5b8c\u5907\u5339\u914d\u4e2a\u6570\u662f\u5947\u6570\u8fd8\u662f\u5076\u6570\u3002\n\n$1 \\leq n \\leq 2000$\u3002\n\n## \u5982\u4f55\u89e3\u51b3\u5b83\uff1f\n\n\u5148\u628a\u90bb\u63a5\u77e9\u9635\u641e\u51fa\u6765\uff0c\u628a\u5b83\u53eb\u505a $G$\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u9650\u5236 $(a_i, b_i)$\uff0c\u8ba9 $G_{a_i, b_i} = 1$\u3002\n\n\u53ef\u4ee5\u770b\u51fa\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u5408\u6cd5\u7684\u6392\u5217 $p_1, \\dots , p_n$\uff0c\u90a3\u4e48 $G_{i, p_i}$ \u90fd\u662f $1$\u3002\n\n\u6709\u60f3\u5230\u4ec0\u4e48\u5417\uff1f\n\n\u8fd8\u8bb0\u5f97\u884c\u5217\u5f0f\u7684\u5f0f\u5b50\u5417\uff1f\n\n\u4f60\u95ee\u6211\u884c\u5217\u5f0f\u524d\u9762 $(-1)^{???}$ \u7684\u7cfb\u6570\u600e\u4e48\u529e\uff1f\u6211\u4eec\u53ea\u5173\u5fc3\u5947\u5076\u6027\uff08\u5bf9 $2$ \u53d6\u6a21\uff09\uff0c$1$ \u548c $-1$ \u5bf9\u6211\u4eec\u6765\u8bf4\u662f\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u53ef\u4ee5\u4e0d\u7ba1\u5b83\u4e86\u3002\uff08\u5176\u5b9e\u8fd9\u4e2a\u4e1c\u897f\u53eb\u505a\u79ef\u548c\u5f0f\uff09\n\n\u6240\u4ee5\uff0c\u5f53\u90bb\u63a5\u77e9\u9635 $G$ \u7684\u884c\u5217\u5f0f\u662f\u5947\u6570\u7684\u65f6\u5019\uff0c\u5408\u6cd5\u7684\u6392\u5217\u6570\u91cf\u4e5f\u662f\u5947\u6570\u3002\n\n\u95ee\u9898\u5230\u73b0\u5728\uff0c\u53ef\u4ee5\u53d8\u6210\uff1a\u628a\u6bcf\u4e2a\u4f4d\u7f6e\u53d8\u6210 $0$ \u540e\uff0c\u884c\u5217\u5f0f\u662f\u5947\u6570\u8fd8\u662f\u5076\u6570\u3002\n\n\u51cf\u53bb\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u884c\u5217\u5f0f\u7684\u53d8\u5316\u600e\u4e48\u7b97\uff1f\n\n\u5927\u5bb6\u5e94\u8be5\u90fd\u77e5\u9053\uff0c\u6709\u4e00\u4e2a\u4e1c\u897f\u53eb\u505a\u4ee3\u6570\u4f59\u5b50\u5f0f\u3002$(-1)^{???}$ \u7684\u7cfb\u6570\u6254\u6389\u4e4b\u540e\uff0c\u53ea\u8981\u770b\u5b83\u7684\u5947\u5076\u6027\u5c31\u53ef\u4ee5\u4e86\u3002\n\n$n$ \u6709 2000 \u8bf6\uff0c\u600e\u4e48\u628a\u5b83\u4eec\u5feb\u901f\u7b97\u51fa\u6765\uff1f\n\n\u5927\u5bb6\u5e94\u8be5\u90fd\u77e5\u9053\uff0c\u6709\u4e00\u4e2a\u4e1c\u897f\u53eb\u505a\u4f34\u968f\u77e9\u9635\u3002\u6c42\u51fa\u4f34\u968f\u77e9\u9635\uff0c\u5c31\u76f8\u5f53\u4e8e\u6c42\u51fa\u6240\u6709\u4f4d\u7f6e\u7684\u4ee3\u6570\u4f59\u5b50\u5f0f\u3002\n\n\u56e0\u4e3a $G^{*} = G^{-1} |G|$\uff0c$|G|$ \u662f\u5947\u6570\uff08\u9898\u9762\u91cc\u9762\u5df2\u7ecf\u8bf4\u4e86\uff09\uff0c\u90a3\u4e48\u53ea\u8981\u6c42 $G^{-1}$ \u5c31\u5b8c\u4e8b\u4e86\uff01!1\n\n$n$ \u6709 2000 \u8bf6\uff0c\u600e\u4e48\u628a\u5b83\u5feb\u901f\u7b97\u51fa\u6765\uff1f\n\n\u5355\u8d70\u4e00\u4e2a~~\u641e\u6b7b\u4e54\u4e39\u7b97\u6cd5~~\u9ad8\u65af\u7ea6\u5f53\u7b97\u6cd5\u6c42\u4e2a\u77e9\u9635\u9006\uff0c\u5c31\u53ef\u4ee5\u7528\u795e\u5fc5\u6280\u5de7\u505a\u5230 $O(n^3 / 64)$\uff08\u7528 bitset \u4f18\u5316\u4e00\u4e0b\uff09\u751a\u81f3 $O(n^3)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\ntypedef long long lint;\ntypedef long double louble;\n\ntemplate<typename T1, typename T2> inline T1 max(T1 a, T2 b)\n{\n\treturn a < b ? b : a;\n}\ntemplate<typename T1, typename T2> inline T1 min(T1 a, T2 b)\n{\n\treturn a < b ? a : b;\n}\n\nconst char lf = '\\n';\n\nnamespace ae86\n{\n\tconst int bufl = 1 << 15;\n\n\tchar buf[bufl], *s = buf, *t = buf;\n\n\tinline int fetch()\n\t{\n\t\tif (s == t)\n\t\t{\n\t\t\tt = (s = buf) + fread(buf, 1, bufl, stdin);\n\t\t\tif (s == t)return EOF;\n\t\t}\n\t\treturn *s++;\n\t}\n\n\tinline int ty()\n\t{\n\t\tint a = 0, b = 1, c = fetch();\n\t\twhile (!isdigit(c))b ^= c == '-', c = fetch();\n\t\twhile (isdigit(c))a = a * 10 + c - 48, c = fetch();\n\t\treturn b ? a : -a;\n\t}\n}\nusing ae86::ty;\n\nconst int _ = 2007, __ = _ + _, _e = 500007;\n\nint n, m, ea[_e], eb[_e];\nbitset<__> f[_];\n\nint main()\n{\n\tios::sync_with_stdio(0), cout.tie(nullptr);\n\n\tn = ty(), m = ty();\n\tfor (int i = 1; i <= m; i++)ea[i] = ty(), eb[i] = ty(), f[ea[i]][eb[i]] = 1;\n\tfor (int i = 1; i <= n; i++)f[i][n + i] = 1;\n\tfor (int i = 1; i <= n; i++)\n\t{\n\t\tint a = i;\n\t\twhile (a < n && !f[a][i])a++;\n\t\tif (!f[a][i])throw \"c**a b***t\";\n\t\tswap(f[i], f[a]);\n\t\tfor (int j = 1; j <= n; j++)if (j != i && f[j][i])f[j] ^= f[i];\n\t}\n\tfor (int i = 1; i <= m; i++)\n\t\tcout << (f[eb[i]][ea[i] + n] ? \"NO\" : \"YES\") << lf;\n\n\treturn 0;\n}\n```\n\n\u4ee3\u7801\u91cc\u548c\u8c10\u4e86\u4e00\u4e9b\u4e0d\u597d\u7684\u8bcd\u8bed\u3002",
        "postTime": 1579004048,
        "uid": 44176,
        "name": "iotang",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF736D \u3010Permutations\u3011"
    },
    {
        "content": "[$\\mathfrak{View\\space it\\space on\\space my\\space Blog}$](https://blog.seniorious.cc/2020/CF-736D/)\n\n## \u9898\u610f\n\n\u5de6\u53f3\u5404 $n$ \u4e2a\u70b9\uff0c$m$ \u6761\u8fb9\u7684\u4e8c\u5206\u56fe\uff0c\u6ee1\u8db3\u5b8c\u7f8e\u5339\u914d\u6570\u4e3a\u5947\u6570\u4e2a\uff0c\u95ee\u5206\u522b\u53bb\u6389\u6bcf\u4e00\u6761\u8fb9\u540e\uff0c\u5b8c\u7f8e\u5339\u914d\u6570\u662f\u5426\u4ecd\u4e3a\u5947\u6570\u4e2a\n\n$n\\le2000$\uff0c$m\\le5\\times10^5$\n\n## \u5206\u6790\n\n\u9996\u5148\u53d1\u73b0\u5b8c\u7f8e\u5339\u914d\u6570\u4e3a $\\sum\\limits_{\\sigma\\in S_n}\\prod\\limits_{i=1}^n\\left[M_{i,\\sigma(i)}=1\\right]$\uff0c\u5176\u4e2d $M$ \u4e3a\u90bb\u63a5\u77e9\u9635\uff0c$S_n$ \u4e3a\u6240\u6709 $1\\sim n$ \u7684\u7f6e\u6362\u6784\u6210\u7684\u96c6\u5408\n\n\u7531\u4e8e\u662f $\\bmod2$ \u610f\u4e49\u4e0b\u7684\uff0c\u4e14 $-1\\equiv1\\pmod2$ \u6545\u6709 $Ans\\equiv\\sum\\limits_{\\sigma\\in S_n}\\operatorname{sgn}(\\sigma)\\prod\\limits_{i=1}^n\\left[M_{i,\\sigma(i)}=1\\right]=\\det(M)\\pmod2$\n\n\u8003\u8651\u5bb9\u65a5\uff0c\u53bb\u6389\u4e00\u6761\u8fb9\u7684\u5b8c\u7f8e\u5339\u914d\u6570\u4e3a\u5947\u6570\u7b49\u4ef7\u4e8e\u5305\u542b\u4e00\u6761\u8fb9\u7684\u5b8c\u7f8e\u5339\u914d\u6570\u4e3a\u5076\u6570\uff0c\u5fc5\u987b\u5305\u542b\u4e00\u6761\u8fb9\u5373\u4e3a\u5220\u6389\u4e00\u884c\u4e00\u5217\uff0c\u4e8e\u662f\u7b49\u4ef7\u4e8e\u5b83\u7684\u4f59\u5b50\u5f0f\u4e3a\u5076\u6570\uff0c\u540c\u6837\u7684\uff0c\u7531\u4e8e $(-1)^{i+j}$ \u4e0d\u5f71\u54cd\u7b54\u6848\u76f4\u63a5\u6c42\u4ee3\u6570\u4f59\u5b50\u5f0f\u5373\u53ef\uff0c\u53c8\u6709\u77e9\u9635 $M$ \u5728 $i$ \u884c $j$ \u5217\u7684\u4ee3\u6570\u4f59\u5b50\u5f0f\u7b49\u4e8e\u4f34\u968f\u77e9\u9635 $M^{*}$ \u7684 $j$ \u884c $i$ \u5217\uff0c\u4e8e\u662f\u53ef\u4ee5\u6c42\u4f34\u968f\u77e9\u9635 $M^{*}=\\det(M)M^{-1}$ \u76f4\u63a5\u9ad8\u65af\u6d88\u5143\u5c31\u597d\u4e86\uff0c$\\det(M)$ \u4e00\u5b9a\u4e3a\u5947\u6570\n\n\u6ce8\u610f\u5230\u8fd0\u7b97\u5728 $\\bmod2$ \u610f\u4e49\u4e0b\u8fdb\u884c\uff0c\u52a0\u51cf\u548c\u5f02\u6216\u8fd0\u7b97\u7b49\u4ef7\uff0c\u76f4\u63a5\u4f7f\u7528 bitset \u8fdb\u884c\u4f18\u5316\u5373\u53ef\uff0c\u590d\u6742\u5ea6 $\\operatorname{O}(\\frac{n^3}{\\omega})$\n\n## \u4ee3\u7801\n```cpp\nconstexpr int N = 2001;\nconstexpr int S = 4001;\nconstexpr int M = 500001;\n\nvoid Gauss(int n);\n\nstd::bitset<S> a[N];\nint u[M], v[M];\nint n, m;\n\nint main() {\n  read(n), read(m);\n  for (int i = 1; i <= m; ++i) {\n    read(u[i]), read(v[i]);\n    a[u[i]][v[i]] = true;\n  }\n  for (int i = 1; i <= n; ++i) {\n    a[i][i + n] = true;\n  }\n  Gauss(n);\n  for (int i = 1; i <= m; ++i) {\n    if (a[v[i]][u[i] + n]) {\n      puts(\"NO\");\n    } else {\n      puts(\"YES\");\n    }\n  }\n  return 0;\n}\n\nvoid Gauss(int n) {\n  for (int i = 1; i <= n; ++i) {\n    int now = 0;\n    for (int j = i; j <= n; ++j) {\n      if (a[j][i]) {\n        now = j;\n      }\n    }\n    if (now != i) {\n      std::swap(a[i], a[now]);\n    }\n    for (int j = 1; j <= n; ++j) {\n      if (i != j && a[j][i]) {\n        a[j] ^= a[i];\n      }\n    }\n  }\n}\n```\n",
        "postTime": 1605196337,
        "uid": 25251,
        "name": "moongazer",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF736D \u3010Permutations\u3011"
    },
    {
        "content": "\u540c\u6b65\u4e8e\u6211\u7684\u535a\u5ba2\uff0c\u5730\u5740\u7565\u3002\n\n---\n\u9996\u5148\u5bf9\u4e8e\u4e00\u4e2a\u6392\u5217\uff0c\u5982\u4f55\u68c0\u67e5\u662f\u5426\u5408\u6cd5\uff1f\u53ef\u4ee5\u628a\u7ed9\u5b9a\u7684 $m$ \u4e2a\u9650\u5236\u5199\u6210\u4e00\u4e2a $n\\times n$ \u7684\u77e9\u9635 $A$\uff0c$A_{i,l}=1$ \u8868\u793a\u7b2c $i$ \u4e2a\u6570\u53ef\u4ee5\u662f $l$\u3002\u90a3\u4e48\u4e00\u4e2a\u5408\u6cd5\u7684\u6392\u5217 $p$ \u5fc5\u987b\u6ee1\u8db3 $A_{1,p_1}=A_{2,p_2}=A_{3,p_3}=\\dots=A_{n,p_n}=1$\u3002\u8003\u8651\u5982\u4f55\u5feb\u901f\u7b97\u51fa\u5408\u6cd5\u6392\u5217\u7684\u4e2a\u6570\u6a21 $2$ \u7684\u7ed3\u679c\u3002\n\n---\n\n## \u79ef\u548c\u5f0f\n\n\u4e00\u4e2a $n\\times n$ \u7684\u77e9\u9635\u7684\u79ef\u548c\u5f0f\u5b9a\u4e49\u4e3a\uff1a\n$$\n\\operatorname {prem}(A)=\\sum_{\\sigma \\in S_n} \\prod_{i=1}^n A_{i,\\sigma_i}\n$$\n\u5176\u4e2d $\\sigma$ \u8868\u793a\u4e00\u4e2a\u6392\u5217\uff0c$S_n$ \u8868\u793a\u957f\u5ea6\u4e3a $n$ \u7684\u6240\u6709\u6392\u5217\u3002\n\n\u6839\u636e\u5b9a\u4e49\uff0c$\\operatorname {prem}(A)$ \u5c31\u662f\u5408\u6cd5\u6392\u5217\u7684\u4e2a\u6570\uff0c\u56e0\u4e3a\u5f53\u4e14\u4ec5\u5f53 $\\sigma$ \u662f\u4e00\u4e2a\u5408\u6cd5\u6392\u5217\u65f6\uff0c$\\prod_{i=1}^n A_{i,\\sigma_i}$ \u624d\u4f1a\u5bf9\u7b54\u6848\u9020\u6210 $1$ \u7684\u8d21\u732e\u3002\n\n\u4f46\u662f\u79ef\u548c\u5f0f\u7684\u8ba1\u7b97\u88ab\u8bc1\u660e\u662f\u4e00\u4e2a $\\#P$ \u5b8c\u5168\u95ee\u9898\uff0c\u8ba1\u7b97\u96be\u5ea6\u8fd8\u5728 $NP$ \u95ee\u9898\u4e4b\u4e0a\uff0c\u56e0\u6b64\u9700\u8981\u8003\u8651\u7528\u522b\u7684\u601d\u8def\u8fdb\u884c\u4f18\u5316\u3002**\u4e4b\u6240\u4ee5\u4f1a\u5b58\u5728\u66f4\u4f18\u7684\u505a\u6cd5\uff0c\u662f\u56e0\u4e3a\u53ea\u9700\u8981\u6c42\u539f\u5f0f\u6a21 $2$ \u7684\u503c\u3002** \u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u6c42\u4e00\u4e9b\u5176\u4ed6\u4e1c\u897f\u3002\n\n## \u884c\u5217\u5f0f\n\n\u8fd9\u5e94\u8be5\u662f\u5927\u5bb6\u66f4\u719f\u6089\u7684\u4e1c\u897f\u3002\u4e00\u4e2a $n\\times n$ \u7684\u77e9\u9635\u7684\u884c\u5217\u5f0f\u5f0f\u5b9a\u4e49\u4e3a\uff1a\n$$\n\\operatorname {det}(A)=\\sum_{\\sigma \\in S_n} \\operatorname {sgn}(\\sigma)\\prod_{i=1}^n A_{i,\\sigma_i}\n$$\n\u5176\u4e2d $\\operatorname{sgn}(\\sigma)$ \u8868\u793a $\\sigma$ \u7684\u7b26\u53f7\u5dee\uff0c\u5982\u679c $\\sigma$ \u6709\u5947\u6570\u4e2a\u9006\u5e8f\u5bf9\u4e3a $-1$\uff0c\u5426\u5219\u4e3a $1$\u3002\n\n\u884c\u5217\u5f0f\u548c\u79ef\u548c\u5f0f\u7684\u5f62\u5f0f\u975e\u5e38\u76f8\u4f3c\uff0c\u5bb9\u6613\u53d1\u73b0\uff0c$\\operatorname {prem}(A)\\equiv\\operatorname {det}(A)(\\bmod 2)$\u3002\u800c\u884c\u5217\u5f0f\u663e\u7136\u662f\u53ef\u4ee5\u7528\u591a\u9879\u5f0f\u590d\u6742\u5ea6\u6c42\u5f97\u7684\u3002\n\n\uff08\u6211\u8ba4\u4e3a\u68c0\u67e5 hack \u6570\u636e\u7684 validator \u5927\u6982\u5c31\u662f\u8fd9\u6837\u5b9e\u73b0\u7684\uff0c\u56e0\u4e3a\u539f\u77e9\u9635 $A$ \u6709\u5947\u6570\u4e2a\u5408\u6cd5\u6392\u5217\u7b49\u4ef7\u4e8e\u884c\u5217\u5f0f\u6a21 $2$ \u4f59 $1$\uff09\n\n\u56e0\u6b64\u95ee\u9898\u53d8\u6210\u4e86\uff0c\u7ed9\u5b9a\u4e00\u4e2a $n\\times n$ \u7684\u77e9\u9635\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $1$\uff0c\u6c42\u628a $1$ \u53d8\u6210 $0$ \u540e\uff0c\u884c\u5217\u5f0f\u662f\u5426\u80fd\u88ab $2$ \u6574\u9664\u3002\n\n\u679a\u4e3e $m$ \u6b21\u662f\u4e0d\u884c\u7684\u3002\n\n## \u4ee3\u6570\u4f59\u5b50\u5f0f\u548c\u4f34\u968f\u77e9\u9635\n\n\u5982\u4f55\u4e00\u6b21\u6027\u6c42\u51fa\u6240\u6709\u7684\u884c\u5217\u5f0f\uff1f\n\n\u5bf9\u4e8e\u4e00\u4e2a $n\\times m$ \u7684\u77e9\u9635 $A$\uff0c\u5b9a\u4e49\u77e9\u9635 $A$ \u7684 $(i,j)$ \u4ee3\u6570\u4f59\u5b50\u5f0f\u4e3a $(-1)^{i+j}M_{i,j}$\uff0c\u5176\u4e2d $M_{i,j}$ \u8868\u793a\u539f\u77e9\u9635\u53bb\u6389\u7b2c $i$ \u884c\u548c\u7b2c $j$ \u5217\u540e\uff0c\u5269\u4e0b\u4e00\u4e2a $(n-1)\\times(m-1)$ \u7684\u77e9\u9635\u7684\u884c\u5217\u5f0f\u3002\u5c06\u77e9\u9635\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u7684\u4ee3\u6570\u4f59\u5b50\u5f0f\u7ec4\u5408\u6210\u4e00\u4e2a\u65b0\u7684 $m\\times n$ \u7684\u77e9\u9635 $A^*$\uff0c\u79f0\u4e3a\u4f34\u968f\u77e9\u9635\uff0c\u5373 $A^*_{i,j}=C_{j,i}$\u3002\n\n\u5047\u5982 $A_{i,j}=1$\uff0c\u90a3\u4e48\u6839\u636e\u5b9a\u4e49\uff0c$C_{i,j}$ \u6a21 $2$ \u7684\u503c\u5c31\u662f\u94a6\u5b9a\u6392\u5217\u7684\u7b2c $i$ \u4e2a\u6570\u662f $j$\uff0c\u5408\u6cd5\u6392\u5217\u7684\u4e2a\u6570\u6a21 $2$ \u7684\u503c\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5c31\u662f\u5982\u679c\u628a $A_{i,j}$  \u53d8\u6210 $0$\uff0c\u5408\u6cd5\u6392\u5217\u7684\u4e2a\u6570\u4f1a\u51cf\u5c11\u5947\u6570\u4e2a\u8fd8\u662f\u51cf\u5c11\u5076\u6570\u4e2a\u3002\u7531\u4e8e\u77e5\u9053\u521d\u59cb\u6709\u5947\u6570\u4e2a\u5408\u6cd5\u7684\u6392\u5217\uff0c\u53ef\u4ee5\u501f\u6b64\u5224\u65ad\u628a $A_{i,j}$ \u53d8\u6210 $0$ \u540e\uff0c\u5269\u4e0b\u7684\u5408\u6cd5\u6392\u5217\u7684\u5947\u5076\u6027\u3002**\u56e0\u6b64\u5982\u679c\u80fd\u6c42\u51fa $A^*$\uff0c\u5c31\u80fd\u77e5\u9053\u6bcf\u4e00\u4e2a\u6ee1\u8db3 $A_{i,j}=1$ \u7684\u4f4d\u7f6e\u7684\u4ee3\u6570\u4f59\u5b50\u5f0f $M_{i,j}$\uff0c\u8fdb\u800c\u4e00\u6b21\u6027\u6c42\u51fa\u6240\u6709\u7b54\u6848\u3002**\n\n\u4f34\u968f\u77e9\u9635\u548c\u77e9\u9635\u9006\u6709\u5bc6\u4e0d\u53ef\u5206\u7684\u8054\u7cfb\uff0c\u5177\u4f53\u6765\u8bf4\uff0c\u5982\u679c\u539f\u77e9\u9635 $A$ \u6709\u9006\uff0c\u90a3\u4e48\uff1a\n$$\nA^{-1}={A^*\\over |A|}\n$$\n\u5176\u4e2d $A^{-1}$ \u4e3a\u77e9\u9635 $A$ \u7684\u9006\uff0c$A^*$ \u8868\u793a\u77e9\u9635 $A$ \u7684\u4f34\u968f\u77e9\u9635\uff0c$|A|$ \u8868\u793a\u77e9\u9635 $A$ \u7684\u884c\u5217\u5f0f\u3002\n\n\u73b0\u5728\u8981\u6c42\u7684\u662f $A^*$ \uff0c\u6240\u4ee5\u6709 $A^*=A^{-1}|A|$\uff0c\u800c $|A|$ \u6a21 $2$ \u4f59 $1$\uff0c\u56e0\u6b64 $A^*\\equiv A^{-1}(\\bmod 2)$\u3002\n\n\u73b0\u5728\u95ee\u9898\u53d8\u6210\u4e86\u6c42 $A^{-1}$\u3002\n\n## \u77e9\u9635\u6c42\u9006\n\n\u5410\u4e86\uff0c\u5199\u4e0d\u52a8\u4e86\u3002\n\n\u8be6\u89c1 [P4783 \u9898\u89e3](https://www.luogu.com.cn/blog/_post/306195)\uff0c\u4f1a\u4e00\u70b9\u7ebf\u4ee3\u7684\u5e94\u8be5\u90fd\u80fd\u770b\u61c2\uff0c\u770b\u4e0d\u61c2\u7684\u4e5f\u80fd\u611f\u6027\u7406\u89e3\uff0c\u5c31\u4e0d\u642c\u8bc1\u660e\u4e86\u3002\n\n\u5177\u4f53\u505a\u6cd5\u5c31\u662f\u5148\u628a $A$ \u548c $I_n$ \u7f6e\u4e8e\u540c\u4e00\u77e9\u9635\u4e2d\uff0c\u7136\u540e\u901a\u8fc7\u6d88\u5143\u628a\u5de6\u534a\u8fb9 $A$ \u53d8\u6210 $I_n$\uff0c\u90a3\u4e48\u53f3\u534a\u8fb9\u5c31\u4f1a\u81ea\u52a8\u53d8\u6210 $A^{-1}$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\Theta(n^3)$\u3002\u65e0\u6cd5\u901a\u8fc7 $n\\le2000$ \u7684\u9650\u5236\uff0c\u4f46\u662f\u5df2\u7ecf\u65e0\u6cd5\u5728\u590d\u6742\u5ea6\u4e0a\u53d8\u5f97\u66f4\u4f18\u4e86\uff0c\u56e0\u6b64\u8003\u8651\u4e00\u4e9b\u5e38\u6570\uff08\uff1f\uff09\u4f18\u5316\u3002\n\n\u7531\u4e8e\u6240\u6709\u64cd\u4f5c\u90fd\u5728\u6a21 $2$ \u610f\u4e49\u4e0b\u8fdb\u884c\uff0c\u56e0\u6b64\u53ea\u4f1a\u6d89\u53ca\u5230\u4e24\u884c\u7684\u52a0\uff08\u4e0d\u4f1a\u4e58\u53c2\u6570\uff09\uff0c\u53c8\u56e0\u4e3a\u5f02\u6216\u53ef\u4ee5\u770b\u4f5c\u6a21 $2$ \u610f\u4e49\u4e0b\u7684\u52a0\u6cd5\uff0c\u56e0\u6b64\u53ef\u4ee5\u7528 bitset \u5b58\u50a8\u6bcf\u4e2a\u77e9\u9635\u8fdb\u884c\u6d88\u5143\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$\\Theta(\\frac {n^3} \\omega)$\n\n\u53c2\u8003\u4ee3\u7801\uff1a\n\n```c++\n#pragma GCC optimize(\"Ofast\")\n#include<bits/stdc++.h>\n#define int long long\n#define elif else if\n#define ALL(x) x.begin(),x.end()\n#define lowbit(x) (x&(-x))\nusing namespace std;\nvoid fileio(const string &s)\n{\n\tfreopen((s+\".in\").c_str(),\"r\",stdin);\n\tfreopen((s+\".out\").c_str(),\"w\",stdout);\n}\nconst int INF=4e18;\ninline int read()\n{\n\tint x=0;\n\tbool flag=1;\n\tchar c=getchar();\n\twhile(c<'0'||c>'9')\n\t{\n\t\tif(c=='-')\n\t\t\tflag=0;\n\t\tc=getchar();\n\t}\n\twhile(c>='0'&&c<='9')\n\t{\n\t\tx=(x<<1)+(x<<3)+c-'0';\n\t\tc=getchar();\n\t}\n\treturn (flag?x:~(x-1));\n}\nint n,m;\nbitset<4000> f[2000];\narray<int,2> a[500000];\nsigned main()\n{\n\tn=read();\n\tm=read();\n\tfor(int i=0;i<m;i++)\n\t{\n\t\tint x=read()-1,y=read()-1;\n\t\ta[i]={x,y};\n\t\tf[x][y]=1;\n\t}\n\tfor(int i=0;i<n;i++)\n\t\tf[i][n+i]=1;\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tint now=0;\n\t\tfor(int l=i;l<n;l++)\n\t\t\tif(f[l][i])\n\t\t\t\tnow=l;\n\t\tif(i!=now)\n\t\t\tswap(f[i],f[now]);\n\t\tfor(int l=0;l<n;l++)\n\t\t\tif(i!=l&&f[l][i])\n\t\t\t\tf[l]^=f[i];\n\t}\n\tfor(int i=0;i<m;i++)\n\t\tif(f[a[i][1]][a[i][0]+n])\n\t\t\tputs(\"NO\");\n\t\telse\n\t\t\tputs(\"YES\");\n\treturn 0;\n}\n```\n## \u53c2\u8003\u8d44\u6599\n\n- [\u79ef\u548c\u5f0f - \u7ef4\u57fa\u767e\u79d1\uff0c\u81ea\u7531\u7684\u767e\u79d1\u5168\u4e66](https://zh.wikipedia.org/zh-hans/%E7%A7%AF%E5%92%8C%E5%BC%8F)\n- [\u884c\u5217\u5f0f - \u7ef4\u57fa\u767e\u79d1\uff0c\u81ea\u7531\u7684\u767e\u79d1\u5168\u4e66](https://zh.wikipedia.org/zh/%E8%A1%8C%E5%88%97%E5%BC%8F)\n- [\u5b50\u5f0f\u548c\u4f59\u5b50\u5f0f - \u7ef4\u57fa\u767e\u79d1\uff0c\u81ea\u7531\u7684\u767e\u79d1\u5168\u4e66](https://zh.wikipedia.org/wiki/%E5%AD%90%E5%BC%8F%E5%92%8C%E4%BD%99%E5%AD%90%E5%BC%8F)\n\n- [\u9898\u89e3 P4783 \u3010\u6a21\u677f\u3011\u77e9\u9635\u6c42\u9006](https://www.luogu.com.cn/blog/_post/306195)\n\n",
        "postTime": 1662776300,
        "uid": 240812,
        "name": "45dino",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 \u3010CF736D Permutations\u3011"
    }
]
[
    {
        "content": "## \u9898\u610f:\n\u7ed9\u51fa\u4e00\u4e2a\u4ed9\u4eba\u638c\uff0c\u6700\u591a **42** \u4e2a\u73af\uff0c\u5728\u56fe\u4e2d\u9009\u53d6\u4e00\u4e9b\u8fb9\uff0c\u4f7f\u5f97\u53ea\u7559\u4e0b\u8fd9\u4e9b\u8fb9\u65f6\uff0c\u6574\u5f20\u56fe\u4ecd\u8054\u901a\uff0c\u4e14\u6240\u6709\u9009\u53d6\u7684\u8fb9\u7684\u8fb9\u6743\u7684\u5f02\u6216\u503c\u6700\u5c0f\u3002\u6c42\u6700\u5c0f\u503c&\u65b9\u6848\u6570\u3002\n\n\n\u770b\u5230\u65b9\u6848\u6570\uff0c\u4e00\u5b9a\u4f1a\u60f3\u5230\u4e00\u4e2a\u4e1c\u897f\u53eb\u505a\u591a\u9879\u5f0f\uff08\n\n\u6211\u4eec\u53d1\u73b0\u4ed9\u4eba\u638c\u6709\u4e00\u4e2a\u5f88\u663e\u7136\u7684\u6027\u8d28\uff0c\u73af\u7684\u4efb\u610f\u4e00\u6761\u8fb9\u53ea\u4f1a\u51fa\u73b0\u5728\u4e00\u4e2a\u73af\u91cc\uff0c\u90a3\u4e48\u8bf4\u660e\u4e86\u4f60\u6bcf\u4e2a\u73af\uff0c\u6700\u591a\u5220\u6389\u4e00\u6761\u8fb9\uff0c\u624d\u80fd\u4f7f\u5b83\u8fde\u901a\uff0c\u6240\u4ee5\u679a\u4e3e\u65ad\u8fb9\uff0c\u7136\u540e\u5bf9\u6240\u6709\u7684\u73af\u66b4\u529b FWT \u5373\u53ef\u3002\n\n```cpp\n#include <bits/stdc++.h>\n\nconst int maxn = 1e5 + 51;\nconst int mod1 = 1e9 + 7;\nconst int mod2 = 1e9 + 9;\nstd::vector <std::pair<int, int>> g[maxn];\n\nint dfn[maxn], idx = 0;\nint f[maxn], fw[maxn];\nint xr;\nstd::vector<std::vector<int>> V;\n\nvoid dfs(int u, int fa) {\n\tdfn[u] = ++idx;\n\tfor(auto x: g[u]) {\n\t\tint v = x.first, w = x.second;\n\t\tif(v == fa) continue;\n\t\tif(!dfn[v]) {\n\t\t\tf[v] = u, fw[v] = w;\n\t\t\tdfs(v, u);\n\t\t}\n\t\telse if(dfn[v] > dfn[u]) {\n\t\t\tstd::vector <int> vec;\n\t\t\tint cur = w;\n\t\t\tfor(int now = v; now ^ u; now = f[now])\n\t\t\t\tcur ^= fw[now];\n\t\t\tvec.push_back(cur ^ w);\n\t\t\tfor(int now = v; now ^ u; now = f[now])\n\t\t\t\tvec.push_back(cur ^ fw[now]);\n\t\t\txr ^= cur;\n\t\t\tV.push_back(vec);\n\t\t}\n\t}\n}\n\nint add(int x, int y, const int&mod) { x += y; return (x >= mod) ? x - mod: x; }\nint dec(int x, int y, const int&mod) { x -= y; return (x < 0) ? x + mod: x; }\n\nint n, m;\nint main() {\n\tstd::ios::sync_with_stdio(false);\n\tstd::cin.tie(nullptr);\n\tstd::cout.tie(nullptr);\n\tstd::cin >> n >> m;\n\tfor(int i = 1; i <= m; i++) {\n\t\tint u, v, w;\n\t\tstd::cin >> u >> v >> w;\n\t\tg[u].push_back({v, w});\n\t\tg[v].push_back({u, w});\n\t\txr ^= w;\n\t}\n\tdfs(1, 0);\n\tstatic int a[1 << 17 | 3], b[1 << 17 | 3];\n\t\n\tauto fwt = [&](int*f, int lim, const int&inv, const int&mod) {\n\t\tfor(int len = 1; len < lim; len <<= 1) {\n\t\t\tfor(int i = 0; i < lim; i += len << 1) {\n\t\t\t\tfor(int j = 0; j < len; j++) {\n\t\t\t\t\tint x = f[i + j], y = f[i + j + len];\n\t\t\t\t\tf[i + j] = add(x, y, mod);\n\t\t\t\t\tf[i + j + len] = dec(x, y, mod);\n\t\t\t\t\tif(inv > 1) f[i + j] = 1ll * f[i + j] * inv % mod, f[i + j + len] = 1ll * f[i + j + len] * inv % mod;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\t\n\ta[xr] = 1, b[xr] = 1;\n\t\n\tfwt(a, 1 << 17, 1, mod1);\n\tfwt(b, 1 << 17, 1, mod2);\n\t\n\tstatic int c[1 << 17 | 3], d[1 << 17 | 3];\n\tfor(auto v: V) {\n\t\tmemset(c, 0, sizeof(c));\n\t\tmemset(d, 0, sizeof(d));\n\t\tfor(auto x : v) c[x]++, d[x]++;\n\t\tfwt(c, 1 << 17, 1, mod1);\n\t\tfwt(d, 1 << 17, 1, mod2);\n\t\tfor(int i = 0; i < (1 << 17); i++) {\n\t\t\ta[i] = 1ll * a[i] * c[i] % mod1;\n\t\t\tb[i] = 1ll * b[i] * d[i] % mod2;\n\t\t}\n\t}\n\t\n\tfwt(a, 1 << 17, (mod1 + 1) >> 1, mod1);\n\tfwt(b, 1 << 17, (mod2 + 1) >> 1, mod2);\n\t\n\tfor(int i = 0; i < (1 << 17); i++)\n\t\tif(a[i] || b[i]) {\n\t\t\tstd::cout << i << ' ' << a[i] << '\\n';\n\t\t\treturn 0;\n\t\t}\n\treturn 0;\n}\n```",
        "postTime": 1588940751,
        "uid": 96580,
        "name": "SXNhdW5veWE",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1218D \u3010Xor Spanning Tree\u3011"
    }
]
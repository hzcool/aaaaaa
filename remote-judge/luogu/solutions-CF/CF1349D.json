[
    {
        "content": "### Slime and Biscuits \u4e2d\u6587\u9898\u89e3\n\n\u8bbe $E_x$ \u4e3a\u5728\u6240\u6709\u6e38\u620f\u7ed3\u675f\u65f6\u6240\u6709\u5c0f\u997c\u5e72\u5728 $x$ \u624b\u91cc\u7684\u60c5\u51b5\uff0c\u6982\u7387\u4e58\u65f6\u95f4\u7684\u548c\uff08\u6ce8\u610f\u6b64\u65f6\u6240\u6709\u60c5\u51b5\u7684\u6982\u7387\u52a0\u8d77\u6765\u5e76\u4e0d\u662f $1$ \uff0c\u6240\u6709 $E_i$ \u4e2d\u6982\u7387\u7684\u548c\u624d\u662f $1$ \uff09\u3002\u5219\u7b54\u6848\u5373\u4e3a $\\sum\\limits_{i=1}^n E_i$\u3002\n\n\u8bbe $E'_x$ \u4e3a\u5982\u679c\u6e38\u620f\u53ea\u5728\u6240\u6709\u5c0f\u997c\u5e72\u90fd\u5728 $x$ \u624b\u91cc\u624d\u7ed3\u675f\u65f6\u6e38\u620f\u7684\u671f\u671b\u8fdb\u884c\u65f6\u95f4\u3002\n\n\u8bbe $P_x$ \u4e3a\u6700\u7ec8\u6e38\u620f\u7ed3\u675f\u65f6\u6240\u6709\u5c0f\u997c\u5e72\u5728 $x$ \u624b\u91cc\u7684\u6982\u7387\uff0c\u5373 $E_x$ \u8fd9\u4e00\u90e8\u5206\u5bf9\u5e94\u7684\u603b\u6982\u7387\u3002\u4e0d\u96be\u53d1\u73b0$\\sum\\limits_{i=1}^n P_i = 1$\u3002\n\n\u518d\u8bbe\u5e38\u6570$C$\u8868\u793a\u6240\u6709\u5c0f\u997c\u5e72\u4ece $i$ \u624b\u91cc\u8f6c\u79fb\u5230 $j$ \u624b\u91cc\u7684\u671f\u671b\u65f6\u95f4\uff08\u6b64\u65f6\u6e38\u620f\u7ed3\u675f\u6761\u4ef6\u662f\u5168\u96c6\u4e2d\u5728 $j$ \u624b\u91cc\uff0c\u4e0e $E'_j$ \u7684\u7ed3\u675f\u6761\u4ef6\u76f8\u540c\uff0c\u4e14 $C$ \u7684\u503c\u5bf9\u6240\u6709 $i,j$ \u5747\u76f8\u7b49\uff09\uff0c\u5219\u4e0d\u96be\u53d1\u73b0\u6211\u4eec\u6709\u6052\u7b49\u5f0f\uff1a\n\n$$E_x = E'_x-\\sum\\limits_{i=1}^n[i\\neq x]( P_i\\cdot C+E_i)$$ \n\n\u8fd9\u4e2a\u7b49\u5f0f\u5373\u4e3a\u8003\u8651 $E'_x$ \u4e2d\u7684\u6240\u6709\u60c5\u51b5\u4e2d\u6e38\u620f\u5206\u522b\u5728\u6700\u540e\u997c\u5e72\u5728\u8c01\u624b\u91cc\u65f6\u7ed3\u675f\u3002\n\n\u5c06\u7b49\u5f0f\u79fb\u9879\u53ef\u5f97 \uff1a\n\n$$\\sum\\limits_{i=1}^n E_i=E'_x-C\\cdot \\sum\\limits_{i=1}^n[i\\neq x]P_i$$ \n\n\u5c06\u7b49\u5f0f\u5bf9 $x=1,2,\\cdots,n$ \u6c42\u548c\uff0c\u53ef\u4ee5\u5f97\u5230 \uff1a\n\n$$n\\sum\\limits_{i=1}^nE_i=\\sum\\limits_{i=1}^nE'_i-C(n-1)\\sum\\limits_{i=1}^nP_i$$ \n\n\u6ce8\u610f\u5230 $ans=\\sum\\limits_{i=1}^nE_i$ \u4e14 $\\sum\\limits_{i=1}^nP_i=1$ \uff0c\u5219\u5f97\u51fa\uff1a\n\n$$n\\cdot ans=\\sum\\limits_{i=1}^nE'_i-C(n-1)$$ \n\n\u5728\u6c42 $E'_x$ \u548c $C$ \u65f6\u6211\u4eec\u53ef\u4ee5\u6ce8\u610f\u5230\u53ea\u5173\u5fc3\u6240\u6709\u997c\u5e72\u662f\u5426\u5728\u76ee\u6807\u4eba\u624b\u4e2d\uff0c\u6240\u4ee5\u8bbe $f_m$ \u4e3a\u6b64\u65f6\u6709 $m$ \u4e2a\u5c0f\u997c\u5e72\u5728\u76ee\u6807\u4eba\u624b\u4e2d\u65f6\u6700\u540e\u5168\u5230\u76ee\u6807\u4eba\u624b\u4e2d\u7684\u671f\u671b\u65f6\u95f4\uff0c\u5219\u4e0d\u96be\u5f97\u5230 $f_m,f_{m+1},f_{m-1}$ \u7684\u7b49\u5f0f\u5173\u7cfb\uff1a\n\n$$\nf_m = \\left\\{\n\\begin{array}{lcl}\n1 + \\frac{(\\sum a_i) - m}{\\sum a_i}\\left(\\frac{1}{n-1}f_{m+1} + \\frac{n-2}{n-1}f_m\\right) + \\frac{m}{\\sum a_i}f_{m-1} & 0<m<\\sum a_i \\\\\n1 + \\frac{1}{n-1}f_{m+1} + \\frac{n-2}{n-1}f_m & m=0 \\\\\n0 & m=\\sum a_i \\\\\n\\end{array}  \\right.\n$$\n\u4e0d\u96be\u5728 $O(\\sum\\limits_{i=1}^na_i)$ \u65f6\u95f4\u5185\uff0c\u901a\u8fc7\u6d88\u5143\u7684\u65b9\u6cd5\u6c42\u51fa\u6240\u6709 $f_n$ \uff0c\u4ece\u800c\u6c42\u51fa $E'_x$ \u548c $C$ \uff0c\u5f97\u51fa\u7b54\u6848\u3002\n\n\u603b\u590d\u6742\u5ea6\u4e3a $O(n+\\sum\\limits_{i=1}^na_i)$ \u3002\n\nP.S. \u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u79cd\u505a\u6cd5\u53ef\u80fd\u5728\u6d88\u5143\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u9664\u4ee5 $0$ \u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u6211\u4eec\u5b89\u6392\u4e86\u4e00\u7ec4 hack \u6570\u636e\u3002\u53e6\u4e00\u79cd\u66f4\u4e3a\u59a5\u5e16\u7684\u505a\u6cd5\u662f\uff0c\u5c06 $g_i = f_i - f_{i+1}$ \u8bbe\u4e3a\u672a\u77e5\u6570\u5217\u65b9\u7a0b\u6c42\u89e3\uff0c\u53ef\u4ee5\u8bc1\u660e\u4e0d\u4f1a\u51fa\u73b0\u95ee\u9898\u3002\u6807\u7a0b\u4e2d\u4f7f\u7528\u4e86\u8fd9\u79cd\u505a\u6cd5\u3002\u8fd9\u79cd\u505a\u6cd5\u7531 Elegia \u63d0\u4f9b\u3002\n\nProblem and Tutorial by he_____he\n\n```cpp\n#include<bits/stdc++.h>\n\n#define pb push_back\n#define mp make_pair\n#define fi first\n#define se second\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int> pii;\ntypedef pair<ll,ll> pll;\n\ntemplate <typename T> bool chkmax(T &x,T y){return x<y?x=y,true:false;}\ntemplate <typename T> bool chkmin(T &x,T y){return x>y?x=y,true:false;}\n\nint readint(){\n\tint x=0,f=1; char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();}\n\treturn x*f;\n}\n\nconst int cys=998244353;\nint n,m;\nll a[100005],ans[300005];\n\nll qpow(ll x,ll p){\n\tll ret=1;\n\tfor(;p;p>>=1,x=x*x%cys) if(p&1) ret=ret*x%cys;\n\treturn ret;\n}\n\nint main(){\n\tn=readint();\n\tfor(int i=1;i<=n;i++) a[i]=readint(),m+=a[i];\n\tll invm=qpow(m,cys-2),invn1=qpow(n-1,cys-2);\n\tfor(int i=m;i>=1;i--){\n\t\tll k1=i*invm%cys*invn1%cys,k2=(m-i)*invm%cys;\n\t\tans[i]=(k2*ans[i+1]+1)%cys*qpow(k1,cys-2)%cys;\n\t}\n\tfor(int i=1;i<=m;i++) ans[i]=(ans[i]+ans[i-1])%cys;\n\tll res=0;\n\tfor(int i=1;i<=n;i++) res=(res+ans[m-a[i]])%cys;\n\tres=(res+cys-ans[m]*(n-1)%cys)%cys;\n\tprintf(\"%lld\\n\",res*qpow(n,cys-2)%cys);\n\treturn 0;\n}\n```\n",
        "postTime": 1588177844,
        "uid": 31098,
        "name": "Caro23333",
        "ccfLevel": 8,
        "title": "Codeforces Round #641 Div1.D Slime and Biscuits \u4e2d\u6587\u9898\u89e3"
    },
    {
        "content": "# Solution\n\n\u8bbe $m = \\sum_{i=1}^na_i$ \u3002\n\n\u8bbe $E(x)$ \u4e3a\u7ed3\u675f\u65f6\u997c\u5e72\u5168\u5728 $x$ \u624b\u91cc\u7684\u671f\u671b\u6b65\u6570\u3002\n\n\u8bbe $P(x)$ \u4e3a\u7ed3\u675f\u65f6\u997c\u5e72\u5168\u5728 $x$ \u624b\u91cc\u7684\u6982\u7387\u3002\n\n\u8bbe $Ex(x)$ \u4e3a\uff0c\u6e38\u620f\u7ed3\u675f\u5f53\u4e14\u4ec5\u5f53\u997c\u5e72\u5168\u5728 $x$ \u624b\u91cc\u8fd9\u6837\u60c5\u51b5\u4e0b\u7684\u671f\u671b\u6b65\u6570\u3002\n\n\u8bbe $C$ \u4e3a\u5f53\u6240\u6709\u997c\u5e72\u90fd\u5728\u67d0\u4e00\u4e2a\u4eba\u624b\u91cc\u65f6\uff0c\u5168\u90e8\u8f6c\u79fb\u5230\u53e6\u4e00\u4e2a\u4eba\u624b\u91cc\u7684\u671f\u671b\u6b65\u6570\u3002\n\n\u5219\u6211\u4eec\u6709\uff1a\n\n$$\nE(x)=Ex(x) - \\sum_{i\\ne x}^n P(i) * C + E(i)\n$$\n$$\n\\sum_{i=1}^n E(i)=Ex(x) - C * \\sum_{i\\ne x}^n P(i)\n$$\n$$\nans=Ex(x) - C * \\sum_{i\\ne x}^n P(i)\n$$\n\n\u628a\u6240\u6709 $x$ \u90fd\u679a\u4e3e\u4e00\u904d\uff0c\u5219\u6709\uff1a\n\n$$\nn\\times ans=\\sum_{i=1}^nEx(i) - C(n-1)\\sum_{i=1}^nP(i)\n$$\n$$\nn\\times ans=\\sum_{i=1}^nEx(i) - C(n-1)\n$$\n\n\u53ea\u9700\u8981\u8003\u8651\u6c42\u51fa $Ex$ \u548c $C$ \u5373\u53ef\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5176\u5b9e\u53ea\u7528\u6c42\u51fa $f_i$ \u8868\u793a\u5f53\u4e00\u4e2a\u4eba\u624b\u4e0a\u6709 $i$ \u5757\u997c\u5e72\u65f6\uff0c\u624b\u4e0a\u5206\u5230\u6240\u6709\u997c\u5e72\u7684\u671f\u671b\u6b65\u6570\uff0c\u5219\u6709 $Ex(i)=f_{a_i},C=f_0$ \u3002\n\n\u5219\u53ef\u5217\u51fa\u9012\u63a8\u5f0f\uff1a\n\n$$\nf_i=\n\\begin{cases}\n1+\\frac{m-i}{m}(\\frac{1}{n-1}f_{i+1}+\\frac{n-2}{n-1}f_i)+\\frac{i}{m}f_{i-1} & 0<i<m\\\\\n1+\\frac{n-2}{n-1}f_0+\\frac{1}{n-1}f_1 & i=0\\\\\n0 & i=m\\\\\n\\end{cases}\n$$\n\n\u7531\u4e8e\u4e3b\u5143\u6cd5\u662f\u53ef\u4ee5\u901a\u8fc7\u6784\u9020\uff0c\u4f7f\u4e3b\u5143\u7cfb\u6570\u53d8\u6210 $0$ \u7684\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u53e6\u5bfb\u51fa\u8def\u3002\n\n\u6211\u4eec\u53d1\u73b0\u5f0f\u5b50\u91cc\u7684\u7cfb\u6570\u548c\u5176\u5b9e\u90fd\u4e3a $1$ \uff0c\u8003\u8651\u641e\u70b9\u4e8b\u60c5\u3002\n\n\u8bbe $g_i=f_i-f_{i+1}, g_m=0$ \uff0c\u5219\u6709 $f_i=\\sum_{j=i}^m g_j$\u3002\n\n\u628a\u4e00\u822c\u5f0f\u5b50\u62ff\u51fa\u6765\uff1a\n\n$$\n\\sum_{j=i}^m g_j=1+\\frac{m-i}{m}(\\frac{1}{n-1}\\sum_{j=i+1}^mg_j+\\frac{n-2}{n-1}\\sum_{j=i}^mg_j) + \\frac{i}{m} \\sum_{j=i-1}^mg_j\n$$\n\n\u7136\u540e\u5de6\u8fb9\u7684 $g$ \u7cfb\u6570\u90fd\u4e3a\u4e00\uff0c\u53f3\u8fb9\u7684\u7cfb\u6570\u548c\u4e3a\u4e00\uff0c\u90a3\u4e48 $g_{i+1}\\dots g_m$ \u5c31\u90fd\u53ef\u4ee5\u6d88\u6389\u4e86\u3002\n\n$$\ng_i=1+\\frac{(m-i)(n-2)}{m(n-1)} g_i+\\frac{i}{m} (g_i+g_{i-1})\n$$\n$$\n\\frac{m-i}{m(n-1)} g_i=1+\\frac{i}{m}g_{i-1}\n$$\n$$\ng_i=\\frac{m(n-1)+i(n-1)g_{i-1}}{m-i}\n$$\n\n\u8fd9\u6837\u53ef\u4ee5\u76f4\u63a5\u4ece\u524d\u5f80\u540e\u9012\u63a8\uff0c\u5c31\u4e0d\u7528\u62c5\u5fc3\u7cfb\u6570\u95ee\u9898\u4e86\u3002\n\n\u81f3\u4e8e $g_0$ \uff0c\u540c\u7406\u53ef\u4ee5\u63a8\u5f97 $g_0=n-1$ \u3002\n\n# Code\n\n```cpp\n#include <cstdio>\n#include <iostream>\nusing namespace std;\n#define LL long long\n#define go(G, x, i, v) \\\n  for (int i = G.hd[x], v = G.to[i]; i; v = G.to[i = G.nx[i]])\n\nchar read_str[1 << 25], *CH = read_str;\n#define getchar() (*CH++)\nLL read() {\n  char ch = getchar();\n  int fl = 0;\n  LL x = 0;\n  while (!isdigit(ch)) {\n    if (ch == '-') fl = 1;\n    ch = getchar();\n  }\n  while (isdigit(ch)) x = (x << 1) + (x << 3) + ch - '0', ch = getchar();\n  return fl ? -x : x;\n}\nvoid rstr(char *s) {\n  char *x = s;\n  char ch = getchar();\n  while (ch == ' ' || ch == '\\n' || ch == '\\r') ch = getchar();\n  while (ch != ' ' && ch != '\\n' && ch != '\\r') {\n    *x++ = ch;\n    ch = getchar();\n  }\n}\n\nconst int Max_n = 3e5 + 5, mod = 998244353;\nint n, m, a[Max_n];\nint f[Max_n];\n\nint ksm(int a, int b = mod - 2) {\n  int res = 1;\n  for (; b; b >>= 1, a = (LL)a * a % mod)\n    if (b & 1) res = (LL)res * a % mod;\n  return res;\n}\n\nnamespace Input {\nvoid main() {\n  fread(read_str, 1, 1 << 25, stdin); \n  n = read();\n  for (int i = 1; i <= n; i++) m += a[i] = read();\n}\n}  // namespace Input\n\nnamespace Solve {\nvoid main() {\n  f[0] = n - 1;\n  int t = (LL)m * (n - 1) % mod;\n  for (int i = 1; i < m; i++)\n    f[i] = ((LL)i * (n - 1) % mod * f[i - 1] % mod + t) * ksm(m - i) % mod;\n  for (int i = m - 1; ~i; i--) (f[i] += f[i + 1]) %= mod;\n  int ans = 0;\n  for (int i = 1; i <= n; i++) (ans += f[a[i]]) %= mod;\n  (ans += mod - (LL)(n - 1) * f[0] % mod) %= mod;\n  ans = (LL)ans * ksm(n) % mod;\n  cout << ans << endl;\n}\n}  // namespace Solve\n\nint main() {\n#ifndef ONLINE_JUDGE\n  freopen(\"D.in\", \"r\", stdin);\n  freopen(\"D.out\", \"w\", stdout);\n#endif\n  Input::main();\n  Solve::main();\n}\n```\n",
        "postTime": 1591672225,
        "uid": 39954,
        "name": "\u6d1b\u6c34\u00b7\u9526\u4f9d\u536b",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1349D \u3010Slime and Biscuits\u3011"
    },
    {
        "content": "[\u9785\u4e0e\u505c\u65f6\u5b9a\u7406\u5b66\u4e60\u7b14\u8bb0](https://www.luogu.com.cn/blog/gxy001/yang-yu-ting-shi-ding-li-xue-xi-bi-ji)\n\n\u7528 $m$ \u8868\u793a\u997c\u5e72\u603b\u6570\u3002\n\n\u8bbe $a_{n,i}$ \u4e3a $n$ \u6b65\u540e\u7b2c $i$ \u4e2a\u4eba\u7684\u997c\u5e72\u6570\u91cf\u3002\n\n\u8bbe $f(x)$ \u4e3a\u6709 $x$ \u4e2a\u997c\u5e72\u7684\u4eba\u7684\u52bf\u80fd\u51fd\u6570\uff0c\u6574\u4e2a\u5c40\u9762\u7684\u52bf\u80fd\u51fd\u6570\u4e3a $\\Phi(A)=\\sum f(a_{i})$\u3002\n\n\u6ce8\u610f\u5230 $E(\\Phi(A_{n+1})\\mid A_0,A_1,\\cdots,A_n)=E(\\Phi(A_{n+1})\\mid A_n)$\u3002\n\n\n$$\nE(\\Phi(A_{n+1})\\mid A_n)=\\sum\\limits_i\\sum\\limits_{j\\ne i}\\frac{a_{n,i}}{m(n-1)}\\left(f(a_{n,i}-1)+f(a_{n,j}+1)+\\sum\\limits_{k\\ne i,k\\ne j}f(a_{n,k})\\right)\\\\\n$$\n\n\n\u4e3a\u6ee1\u8db3 $E(\\Phi(A_{n+1})-\\Phi(A_n)\\mid A_0,A_1,\\cdots,A_n)=-1$\uff0c\u6709\n\n\n$$\n\\begin{aligned}\n\\sum\\limits_{k}f(a_{n,k})-1&=\\sum\\limits_i\\sum\\limits_{j\\ne i}\\frac{a_{n,i}}{m(n-1)}\\left(f(a_{n,i}-1)+f(a_{n,j}+1)+\\sum\\limits_{k\\ne i,k\\ne j}f(a_{n,k})\\right)\\\\\n\\sum\\limits_{k}f(a_{n,k})-1&=\\sum_i\\left(\\frac{a_{n,i}}{m}f(a_{n,i}-1)+\\frac{m-a_{n,i}}{m(n-1)}f(a_{n,i}+1)+\\frac{(m-a_{n,i})(n-2)}{m(n-1)}f(a_{n,i})\\right)\\\\\nf(x)-\\frac{x}{m}&=\\frac{x}{m}f(x-1)+\\frac{m-x}{m(n-1)}f(x+1)+\\frac{(m-x)(n-2)}{m(n-1)}f(x)\\\\\nf(x+1)&=\\left(\\frac{m(n-1)}{m-x}-(n-2)\\right)f(x)-\\frac{(n-1)x}{m-x}f(x-1)-\\frac{(n-1)x}{m-x}\n\\end{aligned}\n$$\n\n\n\u5c06 $x=0$ \u4ee3\u5165\u53ef\u5f97 $f(1)=f(0)$\uff0c\u6211\u4eec\u53d6 $f(0)=f(1)=0$\u3002\n\n\u8bbe\u505c\u65f6\u4e3a $t$\uff0c\u5219 $\\Phi(A_t)=f(m)+(n-1)f(0)$\uff0c\u4e3a\u5e38\u6570\uff0c\u6240\u4ee5 $E(t)=\\Phi(A_0)-\\Phi(A_t)$\u3002\n\n```cpp\n#include<cstdio>\nint const mod=998244353;\nint pow(int x,int y){\n\tint res=1;\n\twhile(y){\n\t\tif(y&1)res=1ll*res*x%mod;\n\t\tx=1ll*x*x%mod,y>>=1;\n\t}\n\treturn res;\n}\nint f[300010],n,m,a[100010],ans;\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",a+i),m+=a[i];\n\tfor(int i=1;i<300000;i++){\n\t\tf[i+1]=(1ll*m*(n-1)%mod*pow(m-i,mod-2)%mod-n+2ll+mod)%mod*f[i]%mod;\n\t\tf[i+1]=(f[i+1]-1ll*(n-1)*i%mod*pow(m-i,mod-2)%mod*(f[i-1]+1)%mod+mod)%mod;\n\t}\n\tfor(int i=1;i<=n;i++)ans=(ans+f[a[i]])%mod;\n\tans=(ans-f[m]+mod)%mod;\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1615981324,
        "uid": 55707,
        "name": "gxy001",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1349D Slime and Biscuits"
    },
    {
        "content": "## \u9785\n\n\u9785\u662f\u4e00\u79cd\u968f\u673a\u53d8\u91cf\u5e8f\u5217 $\\{X_n\\}_{n\\ge0}$\uff0c\u6ee1\u8db3\n$$\n\\mathrm E(X_{n+1} - X_n | X_0,X_1,X_2,\\cdots,X_n) =0\n$$\n\u5373\uff1a\u4e0d\u7ba1\u4e4b\u524d\u7684\u5e8f\u5217\u5982\u4f55\uff0c\u6bcf\u4e2a\u4f4d\u7f6e\u4e0b\u4e00\u4f4d\u7684\u503c\u671f\u671b\u4e0d\u53d8\u3002\n\n\u6ce8\u610f\u5230 $|$ \u8868\u793a\u6761\u4ef6\u671f\u671b\uff1a\u5bf9\u6240\u6709\u53ef\u80fd\u7684 $X_i(1\\le i\\le n)$ \u6c42\u6761\u4ef6\u6982\u7387\u52a0\u6743\u3002\n\n\u5e76\u4e14\u4e0d\u80fd\u7b80\u5355\u8ba4\u4e3a $\\mathrm E(X_{n+1}-X_n|X_0,\\cdots,X_n)=\\mathrm E(X_{n+1}-X_n)$ \u5bf9\u4e8e\u4efb\u610f\u60c5\u51b5\u6210\u7acb\uff08\u4f46\u662f\u5bf9\u4e8e\u9785\u663e\u7136\u6210\u7acb\uff09\u3002\n\n\u5b9a\u4e49\u4e00\u4e2a\u79bb\u6563\u968f\u673a\u53d8\u91cf\uff0c\u5f53 $X_i$ \u7b2c\u4e00\u6b21\u51fa\u73b0 $1$ \u4e4b\u540e\u90fd\u4e00\u5b9a\u662f $1$\u3002\n\n\u90a3\u4e48\u8fd9\u4e2a\u671f\u671b\u5c31\u4e0d\u5bf9\u4e4b\u524d\u7684\u7ed3\u679c\u72ec\u7acb\u3002\n\n## \u505c\u65f6\u5b9a\u7406\n\n\u6211\u4eec\u77e5\u9053\u5bf9\u4e8e\u9785 $X_n$\uff0c$\\forall n\\in \\mathbb N,\\mathrm E(X_n) = \\mathrm E(X_{n-1})=\\cdots=\\mathrm E(X_0)$\u3002\u5bf9\u4e8e\u6211\u4eec\u7684\u7814\u7a76\u5bf9\u8c61\uff0c\u521d\u59cb\u503c\u4e00\u822c\u4e00\u5b9a\u3002\n\n\u53c8\u6709\u4e00\u4e2a\u968f\u673a\u53d8\u91cf\uff08\u53ef\u80fd\u4e0e $X$ \u6709\u5173\uff09$T$ \u53d6 $T\\in \\mathbb N$\uff0c\u79f0 $T$ \u4e3a\u8be5\u9785\u7684\u505c\u65f6\u3002\n\n\u6211\u4eec\u5c1d\u8bd5\u56de\u7b54\u662f\u5426 $\\mathrm E(X_T) = \\mathrm E(X_0)$\uff1a\u5e76\u4e0d\u4e00\u5b9a\u3002\n\n\u4f46\u662f\u5bf9\u4e8e\u4ee5\u4e0b\u4e09\u79cd\u60c5\u51b5\u4e4b\u4e00\u6210\u7acb\u7684 $T$ \uff0c\u4e0a\u5f0f\u6210\u7acb\uff1a\n\n1. $T$ \u6709\u754c\u7684\u6982\u7387\u4e3a $1$\u3002\n2. $|X_n - X_{n-1}|$ \u4e00\u81f4\u6709\u754c\uff0c\u6216\uff08\u66f4\u5f3a\u7684\uff09$\\mathrm E(X_n)$ \u7ebf\u6027\u76f8\u5173\u4e8e $n$\uff0c\u4e14 $T$ \u7684\u671f\u671b\u6709\u9650\u3002\n3. $X_n$ \u4e00\u81f4\u6709\u754c\uff0c\u4e14 $T$ \u6709\u9650\u7684\u6982\u7387\u4e3a $1$\u3002\n\n\u4e00\u81f4\u6709\u754c\uff1a\u6709\u4e0e $X$ \u548c $n$ \u65e0\u5173\u7684\u4e0a\u754c\u3002\n\n\u6211\u4eec\u5b9a\u4e49\u6709\u9650\u4e3a\u4e00\u5b9a\u5728 $\\mathbb R$ \u4e2d\uff1b\u6709\u754c\u662f\u6709\u5e38\u6570\u4e0a\u754c\uff0c\u663e\u7136\u5f3a\u4e8e\u6709\u9650\u3002\u6bd4\u5982 $\\dfrac 1x(x\\in (0,1))$\uff0c\u5b83\u6709\u9650\uff0c\u65e0\u754c\u3002\n\n\u81f3\u4e8e\u65e0\u9650\uff1a\u5b9e\u8df5\u4e2d\u5e94\u8be5\u9047\u4e0d\u5230\u3002\u6240\u4ee5\u7b2c $2,3$ \u4e2d\u540e\u534a\u6bb5\u53ef\u4ee5\u8ba4\u4e3a\u6052\u771f\u3002\n\n## \u52bf\u80fd\u51fd\u6570\u6cd5\n\n\u5bf9\u4e8e\u4e00\u4e2a\u968f\u673a\u8fc7\u7a0b $A_n$\uff08\u4e0d\u5fc5\u8981\u662f\u5b9e\u6570\uff09\uff0c\u6211\u4eec\u6784\u9020\u52bf\u80fd\u51fd\u6570 $\\varphi(A_n)$ \u4f7f\n$$\n\\mathrm E(\\varphi(A_{n+1}) - \\varphi(A_n)|A_n,A_{n-1},\\cdots A_n) = 1\n$$\n\u53e6\u4e00\u4e2a\u968f\u673a\u8fc7\u7a0b $X_n = \\varphi(A_n) - n$\uff0c\u5219\n$$\n\\mathrm E(X_n - X_{n-1}|\\cdots) = \\mathrm E(\\varphi(A_n) - \\varphi(A_{n-1})|\\cdots) - 1 = 0\n$$\n$X_n$ \u4e3a\u9785\u3002\n\n\u6240\u4ee5\u6211\u4eec\u77e5\u9053\u5047\u5982 $X_n$ \u6ee1\u8db3\u505c\u65f6\u5b9a\u7406\u6761\u4ef6\uff0c\u5219\n$$\n\\mathrm E(X_T) = \\mathrm E(\\varphi(A_T)) - \\mathrm E(T) = \\mathrm E(X_{0}) = \\mathrm E(\\varphi(A_0)) = \\varphi(A_0)\n$$\n\n$$\n\\mathrm E(T) = \\mathrm E(\\varphi(A_T)) - \\varphi(A_0)\n$$\n\n\u8fd9\u91cc\u7684 $\\mathrm E(\\varphi(A_T))$ \u4ecd\u7136\u4e0d\u592a\u5bb9\u6613\u8003\u8651\uff1b\u4f46\u662f**\u5047\u5982 $T$ \u53d6\u503c $S$\uff0c\u4e14\u5bf9\u4e8e\u505c\u65f6\u72b6\u6001 $A_t(t\\in S)$\uff0c$\\varphi(A_t)$ \u76f8\u540c\uff0c\u800c\u4e14\u5bf9\u4e8e\u5176\u5b83\u72b6\u6001\u90fd\u4e0d\u53d6 $\\varphi(A_T)$\uff0c$\\mathrm E(\\varphi(A_T))$ \u5c31\u662f $\\varphi(A_T)$\u3002\u8fd9\u4e00\u4e2a\u6761\u4ef6\u5f80\u5f80\u5f52\u5316\u6210 $\\varphi(A_T)$ $\\min/\\max$ \u503c**\u3002\n\n\u53ef\u4ee5\u6c42\u51fa\u505c\u65f6\u7684\u671f\u671b\u3002\n\n### $\\text{CF1349D Slime and Biscuits}$\n\n\u5bb9\u6613\u53d1\u73b0\u8be5\u968f\u673a\u72b6\u6001\u4e3a\u4e00\u4e2a\u53ef\u91cd\u96c6 $A = \\{a_i\\}_{i=1}^n$\uff1b\u4e14\u53d8\u5316\u53ea\u548c\u6700\u540e\u7684\u72b6\u6001\u6709\u5173\u3002\n\n\u6240\u4ee5\u6784\u9020 $\\varphi(A_n) = \\sum\\limits_{i=1}^nf(a_{n,i})$\uff0c\u8bb0 $S = \\sum\\limits_{i=1}^na_i$ \u4f7f\n$$\n\\begin{aligned}\n\\mathrm E(\\varphi(A_{n+1}) - \\varphi(A_n)|A_n) &= \\sum_{i=1}^n\\mathrm E(f(a_{n+1,i})|A_n)) - f(a_{n,i}) = 1 \\\\\n&= \\sum_{i=1}^n f(a_{n,i} - 1)\\times \\frac{a_{n,i}}S + f(a_{n,i} + 1)\\times (1 - \\frac{a_{n,i}}S)\\frac 1{n-1}+f(a_{n,i})\\times(1-\\frac{a_{n,i}}S)(1-\\frac 1{n-1}) - f(a_{n,i}) \\\\\n&= \\sum_{i=1}^n f(a_{n,i} - 1)\\times \\frac{a_{n,i}}S + f(a_{n,i} + 1)\\times (1 - \\frac{a_{n,i}}S)\\frac 1{n-1} - f(a_{n,i})\\times(\\frac{a_{n,i}}S+\\frac1{n-1}-\\frac{a_{n,i}}{S(n-1)}) \\\\ \n\\end{aligned}\n$$\n\u53ef\u4ee5\u8fdb\u4e00\u6b65\u5f3a\u5316\u6027\u8d28\uff1a\u4f7f\u548c\u5f0f\u4e2d\u6bcf\u4e00\u9879\u6709\u786e\u5b9a\u503c\u3002\n\n$$\nf(a_{n,i} - 1)\\times \\frac{a_{n,i}}S + f(a_{n,i} + 1)\\times (1 - \\frac{a_{n,i}}S)\\frac 1{n-1} - f(a_{n,i})\\times(\\frac{a_{n,i}}S+\\frac1{n-1}-\\frac{a_{n,i}}{S(n-1)}) = \\frac{a_{n,i}}S\n$$\n$$\nf(a_{n,i} - 1)\\times a_{n,i} + f(a_{n,i} + 1)\\times\\frac {S - a_{n,i}}{n-1} - f(a_{n,i})\\times(a_{n,i} + \\frac S{n-1}-\\frac {a_{n,i}}{n-1}) = a_{n,i}\n$$\n\n\u53ef\u5f97\u5230\u9012\u63a8\u5f0f\uff1a\n$$\nf(x+1) = f(x)\\times(\\frac{x(n-1)}{S-x}+1)+(1-f(x-1))\\times \\frac{x(n-1)}{S-x}\n$$\n\u6211\u4eec\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e2a\u521d\u503c\uff0c\u4f7f\u8be5\u51fd\u6570\u53ef\u4ee5\u76f4\u63a5\u6c42\u3002\n\n\u6700\u540e\u9700\u8981\u6ee1\u8db3\u7684\u6761\u4ef6\u662f $\\varphi(A_n) = \\varphi(A_T)$ \u5f53\u4e14\u4ec5\u5f53 $A_n$ \u662f\u7ec8\u6b62\u72b6\u6001\uff0c\u4ee5\u53ca $\\varphi(A_n)-n$ \u6709\u754c\uff08\u6761\u4ef6 $3$\uff09\u3002\n\n\u6211\u4eec\u518d\u4ee4 $\\varphi(A_T)$ \u4e3a\u6700\u5927\u503c\uff0c\u8fd9\u6837\u4e24\u4e2a\u6761\u4ef6\u5c31\u90fd\u6ee1\u8db3\u4e86\u3002\n\n $\\varphi(A_T) = f(S)+(n-1)f(0)$\u3002\n\n~~\u7ee7\u7eed\u5206\u6790\uff1a~~ \u5206\u6790\u4e0d\u51fa\uff0c\u4e0b\u9762\u5ffd\u7565\u3002\n\n~~\u8003\u8651\u6700\u7ec8\u72b6\u6001\u662f\u300c\u6700\u96c6\u4e2d\u300d\u7684\u72b6\u6001\uff0c\u5c1d\u8bd5\u8bc1\u660e $\\forall x_1\\le x_2$\uff0c~~\n$$\nf(x_1) + f(x_2) < f(x_1-1) + f(x_2+1)\n$$\n~~\u63a5\u7740\u8fdb\u884c\u5f52\u7eb3\u5373\u53ef\u8bc1\u660e\u4e0d\u65ad\u5c06\u5c0f $x$ \u5e76\u5165\u5927 $x$ \u4e2d\u4f1a\u53d6\u5f97\u6700\u5927\u3002~~\n\n~~\u5bb9\u6613\u53d1\u73b0\u8fd9\u4e5f\u5c31\u662f\u51fd\u6570\u7684\u4e0b\u51f8\u6027\u3002\u4ee4 $g(x) = \\dfrac{x(n-1)}{S-x}$\uff0c\u53d8\u5f62\u9012\u63a8\u5f0f\uff1a~~\n$$\nf(x + 1) - f(x) = (f(x) - f(x - 1))g(x) + g(x)\n$$\n\n$$\n\\Delta f(x) - \\Delta f(x-1) = (\\Delta f(x-1)+1)(g(x) - 1) + 1> 0\n$$\n\n~~\u8003\u8651 $g(x) - 1 < 0$ \u7684\u60c5\u51b5\u3002\u4e0d\u59a8\u4ee4 $n = 2$\uff0c\u6709 $-1< g(x) - 1 < 0$\uff0c\u89e3\u5f97 $x < \\dfrac 12S$\uff0c\u6b64\u65f6\u4ee4 $\\Delta f(x-1)\\le -1$\u3002~~\n\n~~$g(x) - 1\\ge 0$ \u7684\u60c5\u51b5\u4e0b\uff0c\u4ee4 $\\Delta f(x-1)\\ge -1$ \u5373\u53ef\u3002~~\n\n---\n\n$\\text{upd:}$ \u770b\u5230\u6709\u4eba\u8bc1\u4e86\uff0c\u53d1\u73b0\u4e0a\u9762\u8bc1\u660e\u8fc7\u4e8e\u5f3a\u4e86\u3002\u6211\u4eec\u53ea\u9700\u8bc1\u660e $\\forall x_1,x_2>0,f(x_1+x_2)+f(0) > f(x_1) + f(x_2)$\u3002\n\n\u5373\uff1a\u6bcf\u6b21\u5c06\u4e00\u4e24\u5806\u5b8c\u5168\u5408\u5e76\u4e00\u5b9a\u66f4\u4f18\u3002\n\n\u56e0\u4e3a $x\\in \\mathbb N$\uff0c\u6240\u4ee5\u7b49\u4ef7\u4e8e $f(x+1)+f(0) > f(x) + f(1)$\u3002\u5f53\u6211\u4eec\u4ee4 $f(0) = 0$ \u65f6\u53ef\u4ee5\u89e3\u5f97 $f(1) = 0$\uff0c\u6240\u4ee5\u5c31\u7b49\u4ef7\u4e8e $f(x)$ \u4e25\u683c\u9012\u589e\u3002\n\n\u7531\u4e0a\u9762\u7684\u5f0f\u5b50\n$$\nf(x + 1) - f(x) = (f(x) - f(x - 1) + 1)g(x)\n$$\n\u4e14 $f(1) - f(0) = 0$\uff0c\u4e14 $x > 0$ \u65f6 $g(x) > 0$ \u53ef\u4ee5\u5f52\u7eb3\u5f97\u8bc1\u3002\n\n\u672c\u9898\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u7b54\u6848\u4e3a $f(S) - \\sum\\limits_{i=1}^nf(a_{0,i})$\u3002\u65f6\u95f4 $\\mathcal O(\\sum\\limits_{i=1}^n a)$\u3002\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#include <cmath>\n#include <algorithm>\n#include <queue>\n#include <vector>\n\nconst int N = 100001;\nconst int M = 300001;\nconst int p = 998244353;\n\nchar buf[1 << 25] ,*p1 = buf ,*p2 = buf;\n#define getchar() (p1 == p2 && (p2 = (p1 = buf) + fread(buf ,1 ,1 << 21 ,stdin) ,p1 == p2) ? EOF : *p1++)\ninline int read() {\n    int x = 0, f = 1; char ch = getchar();\n    while(ch > '9' || ch < '0') { if(ch == '-') f = -1; ch = getchar(); }\n    while(ch >= '0' && ch <= '9') x = x * 10 + ch - 48, ch = getchar();\n    return x * f;\n}\n\ninline int fastpow(int a,int b) {\n    int r = 1;\n    while(b) {\n        if(b & 1) r = 1ll * r * a % p;\n        a = 1ll * a * a % p;\n        b >>= 1;\n    }\n    return r;\n}\n\nint n,a[N],f[M];\n\nint main() {\n    n = read();\n    int A = 0;\n    for(int i = 1;i <= n;i++) a[i] = read(), A += a[i];\n    f[0] = f[1] = 0;\n    for(int x = 1;x < A;x++) {\n        int g = 1ll * x * (n - 1) % p * fastpow(A - x,p - 2) % p;\n        f[x + 1] = (f[x + 1] + 1ll * f[x] * (g + 1)) % p;\n        f[x + 1] = (f[x + 1] + 1ll * (1 - f[x - 1] + p) * g) % p;\n    }\n    int ans = f[A];\n    for(int i = 1;i <= n;i++) ans = (ans - f[a[i]] + p) % p;\n    std::printf(\"%d\\n\",ans);\n    return 0;\n}\n\n```\n\n### \u6b4c\u5531\u738b\u56fd\n\n\u8fd9\u4e2a\u7ecf\u5178 PGF \u95ee\u9898\u4e5f\u5177\u6709\u505c\u65f6\u7684\u5f62\u5f0f\u3002\n\n\u4e0d\u59a8\u6682\u65f6\u79bb\u5f00\u52bf\u80fd\u51fd\u6570\u7684\u5f62\u5f0f\uff0c\u518d\u6765\u5206\u6790\u4e00\u4e0b\uff08\u5f53\u7136\u5f62\u5f0f\u5316\u5730\u6784\u9020\u51fd\u6570\u81ea\u7136\u662f\u53ef\u884c\u7684\uff09\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u8d4c\u573a\uff0c\u6211\u4eec\u9996\u5148\u660e\u786e\u5b83\u5728\u671f\u671b\u4e0b\u662f\u4e0d\u8d5a\u4e0d\u8d54\u7684\u3002\u5c06\u4ee3\u4ef7\uff08\u94b1\u5e01\uff09\u5206\u914d\u5230\u6bcf\u4e2a\u8d4c\u5f92\u8eab\u4e0a\uff0c\u81ea\u7136\u9700\u8981\u4f7f\u6bcf\u4e2a\u4eba\u671f\u671b\u4e5f\u662f\u4e0d\u8d5a\u4e0d\u8d54\u7684\u3002\n\n\u90a3\u4e48\uff0c\u786e\u5b9a\u4e00\u4e2a\u505c\u65f6\u6761\u4ef6\uff0c\u8fd9\u5bb6\u8d4c\u573a\u7684\u8001\u677f\u4f1a\u5728\u8fbe\u6210\u6761\u4ef6\u540e\u7acb\u523b\u7ec8\u6b62\u6240\u6709\u6d3b\u52a8\u3002\n\n\u6b64\u65f6\u60f3\u8981\u5206\u6790\u8d4c\u573a\u7684\u671f\u671b\u6536\u76ca\uff0c\u663e\u7136\uff0c\u5c31\u662f\u9700\u8981\u6ee1\u8db3\u505c\u65f6\u5b9a\u7406\uff1a\u5982\u679c\u6ee1\u8db3\uff0c\u90a3\u4e48\u671f\u671b\u6536\u76ca\u4e3a $0$\u3002\n\n\u6211\u4eec\u5728\u6b64\u65f6\u82e5\u80fd\u591f\u5f97\u77e5\u8d4c\u5f92\u4eec\u7684\u8d44\u4ea7\u4ee3\u6570\u548c\u4e3a\u5e38\u91cf\uff0c\u4e14\u6bcf\u5929\u8fdb\u5165\u8d4c\u573a\u7684\u94b1\u5e01\u6570\u90fd\u662f $1$\u2014\u2014\u90a3\u4e48\uff0c\u8fd9\u4e2a\u8d44\u4ea7\u548c\u5c31\u662f\u671f\u671b\u505c\u65f6\u3002\n\n\u611f\u89c9\u8fd9\u4e2a\u63cf\u8ff0\u4e0d\u5982\u76f4\u63a5\u52bf\u80fd\u51fd\u6570\uff1f\u54c8\u54c8\uff0c\u5176\u5b9e\u552f\u4e00\u7565\u6709\u4e0d\u540c\u7684\u4e00\u6b65\u5c31\u662f\u5c06\u671f\u671b\u4e0d\u53d8\u7684\u9785\u62c6\u6210\u4e86\u82e5\u5e72\u4e2a\u9785\u7684\u603b\u548c\u7f62\u4e86\u3002\n\n\u4ee3\u5165\u8fd9\u4e2a\u95ee\u9898\uff0c\u600e\u4e48\u5206\u6790\u5462\uff1f\n\n\u5047\u8bbe\u8d4c\u5c40\u662f\u8fd9\u6837\u8fdb\u884c\u7684\u2014\u2014\u6bcf\u5929\u6709\u4e00\u4e2a\u65b0\u7684\u8d4c\u5f92\u8fdb\u5165\u8d4c\u573a\uff0c\u5e26\u6765\u4e86 $1$ \u4e2a\u94b1\u5e01\u3002\n\n\u56e0\u4e3a\u6211\u4eec\u60f3\u8981\u4ece\u7ec8\u6b62\u6761\u4ef6\uff08\u5531\u51fa\u5b57\u7b26\u4e32\u6070\u662f $a_1\\cdots a_m$\uff09\u5bf9\u5e94\u5230\u4e00\u4e2a\u552f\u4e00\u7684\u8d4c\u5f92\u6536\u76ca\u60c5\u51b5\uff0c\u6240\u4ee5\u5fc5\u7136\u8981\u6709\u6240\u8054\u7cfb\u3002\n\n\u67d0\u4e2a\u62e5\u6709 $x$ \u94b1\u5e01\u7684\u8d4c\u5f92\u5728\u8fdb\u5165\u8d4c\u573a\u7684\u7b2c $i$ \u5929\uff0c\u9996\u5148\u4f1a\u5c06\u6240\u6709 $x$ \u94b1\u5e01\u8d4c\u4e0a\u5f53\u5929\u5531\u51fa\u7684\u662f $a_i$\uff0c\u5931\u8d25\u5219\u5931\u53bb\u6240\u6709\u94b1\u5e01\uff0c\u6210\u529f\u5219\u4f1a\u5f97\u5230 $(n-1)x$ \u7684\u94b1\u5e01\u3002\n\n\u663e\u7136\u8fd9\u6837\u662f\u516c\u5e73\u7684\u3002\n\n\u5728\u7ec8\u6b62\u65f6\uff0c\u5f88\u5bb9\u6613\u53d1\u73b0\uff0c\u53ea\u6709\u8fd8\u5269 $x$ \u5929\u5165\u573a\u7684\u6240\u6709\u8d4c\u5f92\u6ca1\u6709\u5931\u53bb\u6240\u6709\u94b1\u5e01\uff0c\u5176\u4e2d $x$ \u8fd8\u8981\u6ee1\u8db3\u662f $a$ \u7684 border\uff1b\u4ed6\u7684\u8d44\u4ea7\u662f $n^x$\u3002\n\n\u8fd9\u4e9b\u8d4c\u5f92\u5e26\u8d70\u4e86\u6240\u6709\u94b1\u5e01\uff0c\u8fd9\u4e9b\u94b1\u5e01\u671f\u671b\u4e0b\u662f\u6240\u6709\u8d4c\u5f92\u5e26\u6765\u7684\u94b1\u5e01\u6570\u3002\n\n\u6839\u636e\u7ed3\u8bba\uff0c\u505c\u65f6\u5c31\u662f $\\sum_{x\\in \\mathrm{Border}(a)}n^x$\u3002\n\n\u81f3\u4e8e\u505c\u65f6\u5b9a\u7406\uff0c\u540e\u4e24\u79cd\u60c5\u51b5\u597d\u50cf\u4e0d\u6ee1\u8db3\uff0c\u56e0\u4e3a\u662f\u6307\u6570\u589e\u957f\u7684\u3002\u4f46\u662f\u518d\u770b\u7ec6\u60f3\u4e00\u4e0b\uff0c\u53d1\u73b0\u53d8\u91cf\u6709\u660e\u786e\u4e0a\u754c $n^m$\uff0c\u56e0\u4e3a\u81f3\u591a\u4ece\u5934\u731c\u5bf9\u5230\u5c3e\uff0c\u90a3\u4e48\u82e5\u5e72\u4e2a\u53d8\u91cf\u4e4b\u548c\u5c31\u5bf9\u4e8e\u65f6\u95f4\u5448\u7ebf\u6027\u4e86\u3002\n\n\u671f\u671b\u6709\u9650\uff1f......\u9898\u76ee\u662f\u8fd9\u6837\u4fdd\u8bc1\u7684\uff0c\u90a3\u4e48\u5c31\u662f\u5bf9\u7684\u4e86\u3002\u5e94\u8be5\u80fd\u8bc1\uff0c\u5c31\u662f\u4e00\u4e2a\u6536\u655b\u95ee\u9898\u3002",
        "postTime": 1639799548,
        "uid": 219595,
        "name": "Vocalise",
        "ccfLevel": 9,
        "title": "\u9785\u548c\u505c\u65f6\u5b9a\u7406\u89e3\u51b3\u671f\u671b\u505c\u65f6\u95ee\u9898"
    },
    {
        "content": "\u65e0\u9650sto dls\n\n### \u9898\u610f\u7b80\u8ff0\n\u7b2c $i$ \u4e2a\u4eba\u521d\u59cb\u6709 $a_i$ \u4e2a\u997c\u5e72\uff0c\u73b0\u5728\u8fdb\u884c\u82e5\u5e72\u6b21\u64cd\u4f5c\uff0c\u6bcf\u4e00\u6b21\u64cd\u4f5c\u4f1a\u4ece\u6240\u6709\u997c\u5e72\u4e2d\u968f\u673a\u4e00\u5757\uff0c\u7136\u540e\u628a\u8fd9\u5757\u997c\u5e72\u968f\u673a\u5206\u7ed9\u9664\u4e86\u539f\u4e3b\u4eba\u4ee5\u5916\u7684\u67d0\u4e2a\u4eba\u3002\u5f53\u6240\u6709\u997c\u5e72\u96c6\u4e2d\u5728\u4e00\u4e2a\u4eba\u624b\u91cc\u65f6\uff0c\u7ed3\u675f\u64cd\u4f5c\u3002\u95ee\u64cd\u4f5c\u7684\u671f\u671b\u6b21\u6570\uff0c\u5bf9 $998244353$ \u53d6\u6a21\u3002\n\n$2\\le n\\le 100000\\ ,\\ 0\\le a_i\\le 300000$\n\n### \u7b97\u6cd5\u5206\u6790\n\u8fd9\u91cc\u4ecb\u7ecd\u4e00\u4e0bdls\u53d1\u660e\u7684\u52bf\u80fd\u6cd5\uff0c\u60f3\u6cd5\u66f4\u81ea\u7136\uff0c\u4e14\u53ef\u4ee5\u4f5c\u4e3a\u89e3\u51b3\u8fd9\u4e00\u7c7b\u95ee\u9898\u7684\u901a\u6cd5\u3002\n\n\u6211\u4eec\u8003\u8651\u6784\u9020\u4e00\u4e2a\u51fd\u6570 $f$ \uff0c\u6ee1\u8db3\u8fdb\u884c\u4e00\u6b65\u64cd\u4f5c\u4e4b\u540e $\\sum\\limits_{i=1}^nf(a_i)$ \u4f1a $-1$ \uff0c\u5219\u64cd\u4f5c\u7684\u671f\u671b\u6b21\u6570\u5c31\u662f **\u521d\u72b6\u6001\u52bf\u51fd\u6570\u548c-\u672b\u72b6\u6001\u52bf\u51fd\u6570\u548c** \uff0c\u672c\u9898\u5373\u4e3a\uff1a\n$$\\sum\\limits_{i=1}^nf(a_i)-(n-1)f(0)-f(m)$$\n\n\u8003\u8651\u6bcf\u4e00\u6b21\u64cd\u4f5c\uff0c\u6211\u4eec\u679a\u4e3e\u9009\u5230\u7684\u997c\u5e72\u662f\u54ea\u4e00\u4e2a\u4eba\u7684\uff0c\u518d\u679a\u4e3e\u8fd9\u4e2a\u997c\u5e72\u540e\u6765\u5206\u7ed9\u4e86\u8c01\uff0c\u5373\uff1a\n$$\\sum\\limits_{i=1}^nf(a_i)=1+\\sum\\limits_{i=1}^n\\frac{a_i}{m}\\left(f(a_i-1)+\\sum\\limits_{j\\neq i}\\frac{1}{n-1}f(a_j+1)+\\frac{n-2}{n-1}f(a_j)\\right)$$\n\n\u524d\u9762\u7684 $1$ \u662f\u6211\u4eec\u5bf9\u52bf\u51fd\u6570\u7684\u8981\u6c42\uff0c\u540e\u9762\u7b2c $i$ \u4e2a\u4eba\u7684\u997c\u5e72\u88ab\u9009\u4e2d\u7684\u6982\u7387\u662f $\\frac{a_i}{m}$\uff0c\u5728\u8fd9\u6b21\u64cd\u4f5c\u540e\uff0c\u7b2c $i$ \u4e2a\u4eba\u7684\u997c\u5e72\u4e2a\u6570\u4f1a\u53d8\u6210 $a_i-1$ \uff0c\u518d\u679a\u4e3e\u8fd9\u4e2a\u997c\u5e72\u7ed9\u4e86\u8c01\uff0c\u5269\u4e0b\u7684 $n-1$ \u4e2a\u4eba\u6bcf\u4e00\u4e2a\u4eba\u90fd\u6709 $\\frac{1}{n-1}$ \u7684\u6982\u7387\u62ff\u5230\u8fd9\u4e00\u5757\u997c\u5e72\uff0c\u53d8\u6210 $a_j+1$ \uff0c\u5176\u4f59\u60c5\u51b5\u4e0d\u53d8\u3002\n\n\u6211\u4eec\u7a0d\u5fae\u5316\u4e00\u4e0b\u8fd9\u4e2a\u5f0f\u5b50\uff1a\n\n$$\\sum\\limits_{i=1}^nf(a_i)=\\sum\\limits_{i=1}^n\\frac{a_i}{m}(f(a_i-1)+1)+\\frac{m-a_i}{m(n-1)}f(a_i+1)+\\frac{(m-a_i)(n-2)}{m(n-1)}f(a_i)$$\n\n\u8fd9\u91cc\u6211\u4eec\u628a\u524d\u9762\u7684 $+1$ \u653e\u5230\u4e86 $\\sum\\limits_{i=1}^n\\frac{a_i}{m}(f(a_i-1)+\\color{red}1)$ \uff0c\u4e0d\u96be\u8bc1\u660e\u8fd9\u4e2a\u662f\u7b49\u4ef7\u7684\u3002\n\n\u8fd9\u4e2a\u65b9\u7a0b\u770b\u4e0a\u53bb\u6ca1\u5565\u7528\uff0c\u4f46\u662f\u56e0\u4e3a\u6211\u4eec\u53ea\u8981**\u80fd\u6784\u9020\u51fa\u4e00\u4e2a\u8fd9\u6837\u7684\u52bf\u51fd\u6570\u5c31\u53ef\u4ee5**\uff0c\u56e0\u6b64\u4e0d\u59a8\u7ed9\u5b83\u52a0\u5f3a\u4e00\u4e0b\uff0c**\u8ba9\u6bcf\u4e00\u4e2a $i$ \u524d\u540e\u9879\u90fd\u5bf9\u5e94\u76f8\u7b49**\uff0c\u5373\uff1a\n$$f(a)=\\frac{a}{m}(f(a-1)+1)+\\frac{m-a}{m(n-1)}f(a+1)+\\frac{(m-a)(n-2)}{m(n-1)}f(a)$$\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230 $m+1$ \u4e2a\u8fd9\u6837\u7684\u65b9\u7a0b\uff0c\u4e0b\u9762\u53ef\u4ee5\u7528 ``band-matrix`` \u6216\u8005\u7528 $f(i)=k_if(m)+b_i$ \u7684\u65b9\u6cd5\u89e3\u51fa\u8fd9\u4e2a\u65b9\u7a0b\u7ec4\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n)$ \u6216\u8005 $O(n\\log \\mathrm{MOD})$ \u7684\uff0c\u53d6\u51b3\u4e8e\u6d88\u5143\u8fc7\u7a0b\u4e2d\u7528\u5feb\u901f\u5e42\u6c42\u9006\u5143\u8fd8\u662f\u9884\u5904\u7406\u51fa\u9006\u5143\u3002\n\n### \u4ee3\u7801\u5b9e\u73b0\n\u6211\u5199\u7684\u662f\u7b2c\u4e8c\u79cd\u65b9\u6cd5\uff0c\u4e14\u6ca1\u6709\u9884\u5904\u7406\u9006\u5143\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$ \u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define maxn 1000005\n#define maxm 2000005\n#define inf 0x3f3f3f3f\n#define LL long long\n#define ull unsigned long long\n#define mod 998244353\n#define eps 1e-6\n#define local\nvoid file(string s){freopen((s+\".in\").c_str(),\"r\",stdin);freopen((s+\".out\").c_str(),\"w\",stdout);}\ntemplate <typename Tp> void read(Tp &x){\n\tint fh=1;char c=getchar();x=0;\n\twhile(c>'9'||c<'0'){if(c=='-'){fh=-1;}c=getchar();}\n\twhile(c>='0'&&c<='9'){x=(x<<1)+(x<<3)+(c&15);c=getchar();}x*=fh;\n}\nint ksm(int b,int p,int Mod=mod){int ret=1;while(p){if(p&1)ret=1ll*ret*b%Mod;b=1ll*b*b%Mod;p>>=1;}return ret;}\nint n,m;\nint a[maxn],f[maxn];\nstruct node{//\u7ef4\u62a4kf(m)+b\u7684\u4e00\u4e2a\u7c7b\u578b\n\tint k,b;\n\tnode operator +(node y)const{\n\t\treturn (node){(k+y.k)%mod,(b+y.b)%mod};\n\t}\n\tnode operator -(node y)const{\n\t\treturn (node){(k+mod-y.k)%mod,(b+mod-y.b)%mod};\n\t}\n\tnode operator *(int y)const{\n\t\treturn (node){1ll*k*y%mod,1ll*b*y%mod};\n\t}\n\tnode operator +(int y)const{\n\t\treturn (node){k,(b+y)%mod};\n\t}\n\tnode operator -(int y)const{\n\t\treturn (node){k,(b+mod-y)%mod};\n\t}\n};\nnode ff[maxn];\nsigned main(){\n\tread(n);\n\tfor(int i=1;i<=n;++i)read(a[i]),m+=a[i];\n\tff[m]=(node){1,0};\n\tfor(int i=m-1;i>=1;--i){//\u4ee3\u5165\u6d88\u5143\uff0c\u6c42\u51fa\u6bcf\u4e00\u4e2af(i)\u7684 kf(m)+b \u8868\u793a\n\t\tint di=1ll*(m-i)*ksm(1ll*m*(n-1)%mod,mod-2)%mod;\n\t\tint di1=1ll*i*ksm(m,mod-2)%mod;\n\t\tint di2=1ll*(m-i)*(n-2)%mod*ksm(1ll*m*(n-1)%mod,mod-2)%mod;\n\t\tff[i-1]=ff[i]-ff[i]*di2-ff[i+1]*di;\n\t\tff[i-1]=ff[i-1]-di1;\n\t\tff[i-1]=ff[i-1]*ksm(di1,mod-2);\n\t}//\u8fb9\u754c\uff08\u624b\u7b97\u53ef\u4ee5\u53d1\u73b0\uff09f(0)=f(1)\uff0c\u76f4\u63a5\u89e3\u65b9\u7a0b\n\tint f0=1ll*(ff[0].b-ff[1].b)*ksm(ff[1].k-ff[0].k,mod-2)%mod;\n\tfor(int i=0;i<=m;++i){//\u8fd8\u539ff(i)\n\t\tf[i]=(1ll*f0*ff[i].k%mod+ff[i].b)%mod;\n\t\tf[i]=(f[i]+mod)%mod;\n\t}\n\tint ans=0;//\u6c42\u7b54\u6848\n\tfor(int i=1;i<=n;++i)ans=(ans+f[a[i]])%mod;\n\tans=(ans-1ll*(n-1)*f[0]%mod)%mod;\n\tans=(ans-f[m])%mod;\n\tans=(ans+mod)%mod;\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1615620083,
        "uid": 35871,
        "name": "ZigZagKmp",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1349D \u3010Slime and Biscuits\u3011"
    },
    {
        "content": "\u8bbe $E(x)$ \u8868\u793a\u5230\u7ed3\u675f\u65f6\u7b2c $x$ \u4e2a\u4eba\u62e5\u6709\u5168\u90e8\u997c\u5e72\u7684\u671f\u671b\u6b65\u6570\uff0c\u5219\u6709 $ans=\\sum_{i=1}^n E(i)$\u3002\n\n\u6211\u4eec\u53d1\u73b0\u76f4\u63a5\u6c42 $E(i)$ \u4e0d\u597d\u6c42\uff0c\u4e8e\u662f\u6211\u4eec\u8bbe $E'(x)$ \u8868\u793a\u53ea\u6709\u5f53\u7b2c $x$ \u4e2a\u4eba\u62e5\u6709\u5168\u90e8\u997c\u5e72\u65f6\u6e38\u620f\u624d\u7ed3\u675f\u65f6\uff0c\u7ed3\u675f\u7684\u6b65\u6570\u7684\u671f\u671b\uff1b\u8bbe $P(x)$ \u8868\u793a\u5230\u7ed3\u675f\u65f6\u7b2c $x$ \u4e2a\u4eba\u62e5\u6709\u5168\u90e8\u997c\u5e72\u7684\u6982\u7387\uff1b\u8bbe $C$ \u8868\u793a\u5f53\u4e00\u4e2a\u4eba\u6ca1\u6709\u997c\u5e72\u65f6\uff0c\u83b7\u5f97\u6240\u6709\u997c\u5e72\u7684\u671f\u671b\u6b65\u6570\u3002\u8003\u8651\u5bb9\u65a5\uff0c\u5219\u6709\uff1a\n\n$$E(x)=E'(x)-\\sum_{i=1}^n[i\\ne x](C\\times P(i)+E(i))$$\n\n\u79fb\u9879\u53ef\u5f97\n\n$$ans=\\sum_{i=1}^nE(i)=E'(x)-C\\sum_{i=1}^n [i\\ne x]P(i)$$\n\n\u5c06\u6bcf\u4e00\u4e2a $E'(x)$ \u7d2f\u52a0\uff0c\u53ef\u5f97\uff1a\n\n$$n\\times ans=\\sum_{i=1}^n E'(i)-(n-1)\\times C\\sum_{i=1}^nP(i)$$\n\n\u7531 $\\sum_{i=1}^nP(i)=1$ \u53ef\u5f97\uff1a\n\n$$n\\times ans=\\sum_{i=1}^nE'(i)-(n-1)\\times C$$\n\n$$ans=\\dfrac{\\sum_{i=1}^nE'(i)-(n-1)\\times C}{n}$$\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u5c06\u997c\u5e72\u96c6\u4e2d\u5728\u4e00\u4e2a\u4eba\u8eab\u4e0a\u7684\u671f\u671b\u6b65\u6570\u53ea\u548c\u6709\u591a\u5c11\u997c\u5e72\u5728\u4ed6\u8eab\u4e0a\u6709\u5173\uff0c\u4e8e\u662f\u6211\u4eec\u8bbe $f_i$ \u8868\u793a\u4e00\u4e2a\u4eba\u62e5\u6709 $i$ \u4e2a\u997c\u5e72\u65f6\uff0c\u5c06\u5168\u90e8\u997c\u5e72\u96c6\u4e2d\u5728\u4ed6\u8eab\u4e0a\u7684\u671f\u671b\u6b65\u6570\u3002\u53ef\u4ee5\u5f97\u51fa $C=f_0$\uff0c$E'(x)=f_{a_x}$\u3002\n\n\u8bb0 $m=\\sum_{i=1}^n a_i$\uff0c\u5219\u53ef\u4ee5\u5f97\u51fa\uff1a\n\n$$f_i=\n\\begin{cases}\n\\dfrac{m-i}{m}(\\dfrac{1}{n-1}f_{i+1}+\\dfrac{n-2}{n-1}f_i)+\\dfrac{i}{m}f_{i-1}+1 &0\\le i<m\\\\\n0 &i=m\n\\end{cases}\n$$\n\n\u6211\u4eec\u867d\u7136\u53ef\u4ee5\u901a\u8fc7\u6d88\u5143\u5f97\u51fa\u7b54\u6848\uff0c\u4f46\u7cfb\u6570\u53ef\u80fd\u4e3a $0$\uff0c\u8003\u8651\u8bbe $g_i=f_i-f_{i+1}$\uff0c\u5219\u6709 $f_i=\\sum_{j=i}^m g_j$\uff0c\u4ee3\u5165\u4e0a\u5f0f\u4e2d $0\\le i<m$ \u7684\u60c5\u51b5\uff0c\u53ef\u4ee5\u5f97\u51fa\uff1a\n\n$$\\sum_{j=i}^m g_j=\\dfrac{m-i}{m}(\\dfrac{1}{n-1}\\sum_{j=i+1}^m g_j+\\dfrac{n-2}{n-1}\\sum_{j=i}^m g_j)+\\dfrac{i}{m}\\sum_{j=i-1}^m g_j+1$$\n\n\u79fb\u9879\u53ef\u5f97\uff1a\n\n$$\\sum_{j=i}^m g_j=\\dfrac{m-i}{m}(\\sum_{j=i}^m g_j-\\dfrac{1}{n-1}g_i)+\\dfrac{i}{m}\\sum_{j=i}^m g_j+\\dfrac{i}{m}g_{i-1}+1$$\n\n$$\\sum_{j=i}^m g_j=\\sum_{j=i}^m g_j-\\dfrac{m-i}{m(n-1)}g_i+\\dfrac{i}{m}g_{i-1}+1$$\n\n$$\\dfrac{m-i}{m(n-1)}g_i=\\dfrac{i}{m}g_{i-1}+1$$\n\n$$g_i=\\dfrac{i(n-1)}{m-i}g_{i-1}+\\dfrac{m(n-1)}{m-i}$$\n\n\u5f53 $i=0$ \u65f6\uff0c\u4ee3\u5165\u4e0a\u5f0f\u53ef\u4ee5\u5f97\u51fa $g_0=n-1$\u3002\n\n\u63a5\u7740\u8ba1\u7b97\u51fa $f_i$\uff0c$E'(i)$\uff0c$C$ \u7684\u503c\uff0c\u4ee3\u5165\u4e0a\u8ff0\u5f0f\u5b50\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n+m\\log m)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u9884\u5904\u7406\u9006\u5143\u505a\u5230 $\\Theta(n+m)$\u3002\n\nCode\uff1a\n```cpp\n#include <cstdio>\nusing namespace std ;\ntypedef long long ll ;\nconst int MAXN = 3e5 + 10 , mod = 998244353 ;\nint n , m , a[MAXN] ;\nll f[MAXN] , g[MAXN] , ans ;\nll qpow (ll x , ll p = mod - 2) {\n\tll ret = 1 ;\n\tfor (; p ; p >>= 1 , x = x * x % mod)\n\t\tif (p & 1) ret = ret * x % mod ;\n\treturn ret ;\n}\nint main () {\n\tscanf (\"%d\" , &n) ;\n\tfor (int i = 1 ; i <= n ; i++) scanf (\"%d\" , &a[i]) , m += a[i] ;\n\tg[0] = n - 1 ;\n\tfor (int i = 1 ; i <= m ; i++)\n\t\tg[i] = ((ll)m * (n - 1) % mod * qpow (m - i) % mod + (ll)i * (n - 1) % mod * qpow (m - i) % mod * g[i - 1] % mod) % mod ;\n\tfor (int i = m ; ~i ; i--) f[i] = (f[i + 1] + g[i]) % mod ;\n\tfor (int i = 1 ; i <= n ; i++) ans = (ans + f[a[i]]) % mod ;\n\tans = (ans - f[0] * (n - 1) % mod + mod) % mod * qpow (n) % mod ;\n\tprintf (\"%lld\\n\" , ans) ;\n\treturn 0 ;\n}\n```",
        "postTime": 1649491331,
        "uid": 122641,
        "name": "GIFBMP",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1349D\u3010Slime and Biscuits\u3011"
    },
    {
        "content": "[\u4f20\u9001\u95e8](https://codeforces.com/problemset/problem/1349/D)\n\n\u8003\u8651 $n=2$ \u600e\u4e48\u505a\uff0c\u53ef\u4ee5\u8bbe $f_i$ \u4e3a\u7b2c\u4e00\u4e2a\u4eba\u6709 $i$ \u4e2a\u997c\u5e72\u5230\u7ed3\u675f\u7684\u671f\u671b\u6b65\u6570\uff0c\u867d\u7136\u4e0d\u53ef\u4ee5\u9012\u63a8\u8f6c\u79fb\uff0c\u4f46\u662f\u663e\u7136\u4e0d\u7528\u9ad8\u65af\u6d88\u5143\uff0c\u628a $f_1$ \u8bbe\u6210\u5df2\u77e5\u91cf\u5c31\u53ef\u4ee5\u5728\u7ebf\u6027\u65f6\u95f4\u5185\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\n\n\u8003\u8651\u539f\u95ee\u9898\uff0c\u76f4\u63a5\u7b97\u671f\u671b\u6b65\u6570\u662f\u4e0d\u597d\u7b97\u7684\uff0c\u4f46\u662f\u5982\u679c\u6307\u5b9a\u4e86\u6700\u540e\u997c\u5e72\u96c6\u4e2d\u5728\u4e86\u7b2c $i$ \u4e2a\u4eba\u90a3\u91cc\uff08\u4e2d\u9014\u997c\u5e72\u805a\u96c6\u5728\u4e86\u522b\u7684\u5730\u65b9\u6e38\u620f\u4e5f\u4e0d\u4f1a\u505c\u6b62\uff09\uff0c\u5c31\u53d8\u6210\u4e86\u7c7b\u4f3c $n=2$ \u7684\u95ee\u9898\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u65b9\u4fbf\u5730\u5f97\u51fa $E_i'$\uff0c\u610f\u4e49\u5982\u4e0a\u6587\u3002\n\n\u8bbe $E_x$ \u4e3a\u6700\u540e\u997c\u5e72\u805a\u96c6\u5728 $x$ \u90a3\u91cc\u7684\u90e8\u5206\u5bf9\u7b54\u6848\u7684\u8d21\u732e\uff0c\u4e5f\u53ef\u4ee5\u7406\u89e3\u4e3a\u805a\u96c6\u5728 $x$ \u5904\u7684\u671f\u671b\u6b65\u6570\u4e58\u4e0a\u805a\u96c6\u5728 $x$ \u7684\u6982\u7387\u3002\u6700\u540e\u7684\u7b54\u6848\u5c31\u662f $\\sum E_i$\u3002\u8bbe $P_i$ \u4e3a\u6700\u540e\u77f3\u5b50\u805a\u96c6\u5728 $i$ \u7684\u6982\u7387\u3002\n\n\u53d1\u73b0\u6709\u4ee5\u4e0b\u5173\u7cfb\uff1a\n$$\n\\begin{aligned}\nE_x&=E_x'-\\sum_{i\\not=x}E_i+C\\cdot P_i\\\\\n\\sum_{i=1}^nE_i&=E'_x-C\\sum_{i\\not=x}P_i\n\\end{aligned}\n$$\n\u5176\u4e2d $C$ \u4e3a\u5168\u90e8\u997c\u5e72\u90fd\u5728\u7b2c\u4e00\u4eba\u5904\uff0c\u8981\u5168\u90e8\u8f6c\u79fb\u5230\u7b2c\u4e8c\u4eba\u5904\u7684\u671f\u671b\u6b65\u6570\u3002\u5c1d\u8bd5\u5bf9\u4e8e\u6240\u6709 $x$ \u6c42\u548c\uff1a\n$$\n\\begin{aligned}\nn\\sum_{i=1}^nE_i&=\\sum_{x=1}^nE_x'-(n-1)C\\sum_{i=1}^nP_i\\\\\nn\\cdot ans&=\\sum_{x=1}^nE_x'-(n-1)C\n\\end{aligned}\n$$\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\uff0c$C$ \u7684\u6c42\u6cd5\u4e0e $E'_x$ \u7c7b\u4f3c\u3002\n\n```cpp\n#include<iostream>\n#include<stdio.h>\n#include<ctype.h>\n#define ll long long\n#define ld long double\n#define fi first\n#define se second\n#define pii pair<int,int>\n#define lowbit(x) ((x)&-(x))\n#define popcount(x) __builtin_popcount(x)\n#define inf 0x3f3f3f3f\n#define infll 0x3f3f3f3f3f3f3f3f\n#define umap unordered_map\n#define all(x) x.begin(),x.end()\n#define mk make_pair\n#define pb push_back\n#define ckmax(x,y) x=max(x,y)\n#define ckmin(x,y) x=min(x,y)\n#define rep(i,l,r) for(int i=l;i<=r;++i)\n#define per(i,r,l) for(int i=r;i>=l;--i)\n#define N 100005\n#define M 300005\n#define int long long\nconst int mo=998244353;\nusing namespace std;\ninline int read(){\n\tint x=0,c=0; char ch=getchar();\n\twhile(!isdigit(ch)) c|=(ch==45),ch=getchar();\n\twhile(isdigit(ch)) x=(x<<3)+(x<<1)+(ch^48),ch=getchar();\n\treturn c?-x:x;\n}\ninline int qpow(int x,int b){\n\tint res=1;\n\tfor(;b;x=x*x%mo,b>>=1) if(b&1) res=res*x%mo;\n\treturn res;\n}\nint n,m,a[N],f[M];\npii c[M];\ninline void red(int &x){x>=mo?x-=mo:0;}\nsigned main(){\n\tn=read();\n\tfor(int i=1;i<=n;++i) a[i]=read(),m+=a[i];\n\tc[1]={1,0},c[0]={1,n-1};\n\tfor(int i=1;i<m;++i){\n\t\tint tmp=(m-i)*(n-2)%mo*qpow(m*(n-1)%mo,mo-2)%mo;\n\t\tred(tmp=1-tmp+mo);\n\t\tred(c[i+1].fi=c[i].fi*tmp%mo-c[i-1].fi*i%mo*qpow(m,mo-2)%mo+mo);\n\t\tred(c[i+1].se=c[i].se*tmp%mo-c[i-1].se*i%mo*qpow(m,mo-2)%mo-1+mo);\n\t\ttmp=m*(n-1)%mo*qpow(m-i,mo-2)%mo;\n\t\t(c[i+1].fi*=tmp)%=mo,(c[i+1].se*=tmp)%=mo;\n\t}\n\tf[1]=(mo-c[m].se)*qpow(c[m].fi,mo-2)%mo;\n\tred(f[0]=f[1]+n-1);\n\tfor(int i=2;i<=m;++i) red(f[i]=c[i].fi*f[1]%mo+c[i].se);\n\tint ans=0;\n\tfor(int i=1;i<=n;++i) red(ans+=f[a[i]]);\n\tred(ans=ans-f[0]*(n-1)%mo+mo);\n\tcout<<ans*qpow(n,mo-2)%mo;\n\treturn 0;\n}\n\n```\n\n",
        "postTime": 1671266810,
        "uid": 238861,
        "name": "xzzduang",
        "ccfLevel": 0,
        "title": "CF1349D Slime and Biscuits"
    }
]
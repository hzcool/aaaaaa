[
    {
        "content": "\u5199\u9898\u89e3\u6807\u8bb0\u4e00\u4e0b\u597d\u9898\uff0c\u987a\u4fbf\u7ed9\u4e2a\u4eba\u7c7b\u6bd4\u8f83\u5bb9\u6613\u770b\u61c2\u7684\u9898\u89e3\u3002\u3002\n\n\u4e0d\u59a8\u8003\u8651\u6570 $\\{0,1\\}$ \u7684\u65f6\u5019\u600e\u4e48\u505a\u3002\u5bf9\u4e8e\u521d\u59cb\u7684\u5e8f\u5217\uff0c\u6bcf\u4e00\u5217\u90fd\u6709 $k$ \u4e2a $\\{0,1\\}$ \u4e2d\u7684\u6570\u3002\n\n\u90a3\u4e48\u8fd9 $n$ \u5217\u4e2d\u5b9e\u9645\u4e0a\u53ea\u6709 $2^k$ \u4e2a\u672c\u8d28\u4e0d\u540c\u7684\u5217\u3002\u53ea\u9700\u8981\u7528 bitset \u7ef4\u62a4\u8fd9\u4e9b\u5217\u5373\u53ef\u3002\n\n\u90a3\u4e48\u5982\u4f55\u628a\u4e00\u822c\u7684\u95ee\u9898\u8f6c\u4e3a $\\{0,1\\}$ \u7684\u95ee\u9898\uff1f\u5bf9\u6bcf\u4e00\u5217\u5206\u522b\u79bb\u6563\u5316\uff0c\u4f7f\u5f97\u503c\u57df\u5728 $[1,k]$\u3002\u7136\u540e\u5c06\u8fd9\u4e00\u5217\u4e2d\u7684\u6bcf\u4e2a\u6570 $x$ \u90fd\u62c6\u6210 $k$ \u4e2a $\\{0,1\\}$ \u7684\u6570\uff0c$[1,x]$ \u4e3a $1$\uff0c$[x+1,k]$ \u4e3a $0$\u3002\n\n\u8fd9\u6837\u53d6 $\\max$ \u76f8\u5f53\u4e8e\u6309\u4f4d\u6216\uff0c\u53d6 $\\min$ \u76f8\u5f53\u4e8e\u6309\u4f4d\u4e0e\u3002\n\n\u6bd4\u5982\n\n```\n1\n4\n9\n```\n\n\u79bb\u6563\u5316\u4e3a\n\n```\n1\n2\n3\n```\n\n\u5f97\u5230\u7684\u5e8f\u5217\u662f\n\n```\n100\n110\n111\n```\n\n\u4ee3\u7801\u867d\u7136\u77ed\uff0c\u4f46\u662f\u5b9e\u73b0\u6709\u56f0\u96be\u3002[CF \u8bc4\u6d4b\u8bb0\u5f55](https://codeforces.com/contest/878/submission/173880885)\u3002",
        "postTime": 1664426594,
        "uid": 203623,
        "name": "Ntokisq",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF878D Magic Breeding"
    },
    {
        "content": "\u8fd9\u9898\u5176\u5b9e\u5e76\u4e0d\u7b97\u5f88\u96be\u7406\u89e3\uff0c\u770b\u4e0d\u61c2\u9898\u89e3\u90fd\u5199\u7684\u662f\u5565\uff0c\u6240\u4ee5\u5c31\u6765\u5199\u7bc7\u9898\u89e3\u3002\n\n\u8003\u8651\u503c\u5168\u4e3a 0/1 \u7684\u65f6\u5019\u600e\u4e48\u505a\uff0c\u663e\u7136\u5bf9\u4e8e $n$ \u4e2a\u4e0d\u540c\u7684\u4f4d\uff0c$k$ \u4e2a\u6570\u5b57\u6700\u591a\u6709 $\\min \\{n,2^k\\}$ \u79cd\u4e0d\u540c\u7684\u53d6\u503c\u3002\n\n\u6bd4\u5982\u8f93\u5165\u4e3a\n```\n001\n110\n101\n```\n\u7684\u65f6\u5019\uff0c\u6709 `011`\uff0c`010`\uff0c`101` \u4e09\u4e2a\u4f4d\u4e0a\u7684\u4e0d\u540c\u53d6\u503c\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u53ea\u9700\u8981\u77e5\u9053\u4e0d\u540c\u53d6\u503c\u65f6\u7684\u7b54\u6848\uff0c\u540c\u4e00\u53d6\u503c\u7684\u4f4d\u672c\u8d28\u4e0a\u662f\u4e00\u6837\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u5c31\u4e0d\u9700\u8981\u8003\u8651\u4f4d\u3002\n\n$f_{i,S}$ \u8868\u793a $k$ \u4e2a\u6570\u5b57\u7684\u53d6\u503c\u4e3a $S$ \u65f6\uff0c\u7b2c $i$ \u4e2a\u751f\u7269\u7684\u7b54\u6848\u3002\n\n$\\max / \\min$ \u64cd\u4f5c\u5c31\u53ef\u4ee5\u76f4\u63a5\u770b\u6210\u4e8c\u8fdb\u5236\u7684 \u6216/\u4e0e \u3002\n\n\u503c\u57df\u6269\u5c55\u6210 $10^9$ \u65f6\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e\u7b54\u6848 ans\uff0c\u628a $<$ ans \u7684\u6570\u5b57\u770b\u6210\u662f $0$\uff0c$\\ge $ ans \u7684\u6570\u5b57\u770b\u6210\u662f $1$\uff0c\u7136\u540e\u6839\u636e $f_{i}$ \u6765\u5224\u65ad\u7b54\u6848\u662f\u5426 $\\ge$ ans\u3002\n\n\u4ee5\u4e0a\u8fc7\u7a0b\u53ef\u4ee5\u7528 `bitset` \u6765\u52a0\u901f\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(\\frac{q2^k}{\\omega})$\n\n\u4ee3\u7801\u5f88\u591a\u5176\u4ed6\u9898\u89e3\u90fd\u5199\u4e86\uff0c\u6211\u53ea\u662f\u6765\u89e3\u91ca\u4e00\u756a\u3002",
        "postTime": 1632379917,
        "uid": 344016,
        "name": "wurzang",
        "ccfLevel": 7,
        "title": "CF878D \u9898\u89e3"
    },
    {
        "content": "\u7ed9\u5b9a $k$ \u4e2a\u957f\u4e3a $n$ \u7684\u6570\u7ec4\uff0c\u6709 $q$ \u6b21\u64cd\u4f5c\uff0c\u5206\u522b\u662f\u65b0\u5efa\u4e00\u4e2a\u6570\u7ec4\uff0c\u6bcf\u4e00\u4e2a\u5143\u7d20\u4e3a\u67d0\u4e24\u4e2a\u5df2\u6709\u6570\u7ec4\u7684 $\\max/\\min$\uff0c\u6216\u8005\u67e5\u8be2\u67d0\u4e2a\u6570\u7ec4\u4e0a\u67d0\u4e2a\u6570\u662f\u591a\u5c11\u3002$k\\leqslant 12$\uff0c$n,q\\leqslant 10^5$\u3002\n\n\u672c\u9898\u6700\u6709\u610f\u601d\u4e5f\u662f\u6700\u96be\u7406\u89e3\u7684\u662f\u5982\u4f55\u538b\u7f29\u72b6\u6001\u91cf\u3002\u9996\u5148\u663e\u7136\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u4e0a\u7684\u6570\u662f\u72ec\u7acb\u7684\uff0c\u4f46\u662f\u6211\u4eec\u53c8\u4e0d\u80fd\u76f4\u63a5\u72ec\u7acb\u8003\u8651\uff1a\u56e0\u4e3a\u8fd9\u6837\u4f60\u81f3\u5c11\u9700\u8981\u505a $n$ \u6b21\uff0c\u6211\u4eec\u627f\u53d7\u4e0d\u4e86\u8fd9\u4e2a\u590d\u6742\u5ea6\u3002\u6211\u4eec\u53d1\u73b0\u7531\u4e8e\u4e00\u5f00\u59cb\u53ea\u6709 $k$ \u4e2a\u6570\u7ec4\uff0c\u90a3\u4e48\u6700\u540e\u7684\u7b54\u6848\u4e00\u5b9a\u5728\u8fd9 $k$ \u4e2a\u6570\u7ec4\u7684\u5143\u7d20\u4e2d\u95f4\uff0c\u6211\u4eec\u8003\u8651\u5b9a\u4e49\u4e00\u4e2a\u548c\u8fd9 $k$ \u4e2a\u6570\u5177\u4f53\u662f\u4ec0\u4e48\u65e0\u5173\u7684\u72b6\u6001\uff0c\u8fd9\u6837\u5c31\u80fd\u8d77\u5230\u538b\u7f29\u4fe1\u606f\u7684\u4f5c\u7528\u3002\n\n\u6211\u4eec\u628a\u89c6\u89d2\u653e\u5230\u67d0\u4e00\u4f4d\u4e0a\uff0c\u8fd9\u6837\u6bcf\u4e00\u6b21\u90fd\u751f\u6210\u7684\u662f\u4e00\u4e2a\u5143\u7d20 $a_i$\uff0c\u5b9a\u4e49 $f(i,s)$ \u8868\u793a\u5bf9\u4e8e\u5143\u7d20 $i$\uff0c**\u65e0\u8bba $a_1\\sim a_k$ \u7684\u503c\u662f\u591a\u5c11**\uff0c\u662f\u5426\u4e00\u5b9a\u6ee1\u8db3 $a_i\\geqslant \\min_{j\\in s}(a_j)$\u3002\u90a3\u4e48\u5bf9\u4e8e $i\\in [1,k]$\uff0c\u663e\u7136 $f(i,s)=1$ \u5f53\u4e14\u4ec5\u5f53 $i\\in s$\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651 $\\min/\\max$ \u64cd\u4f5c\uff0c\u7531\u4e8e $\\max(a_x,a_y)\\geqslant \\min_{j\\in s}(a_j)$ \u7b49\u4ef7\u4e8e $a_x\\geqslant \\min_{j\\in s}(a_j)\\lor a_y\\geqslant \\min_{j\\in s}(a_j)$ \uff0c\u6240\u4ee5\u5982\u679c\u662f $\\max$ \u64cd\u4f5c\uff0c\u6709 $f(i,s)=f(x,s)\\lor f(y,s)$\u3002\u7c7b\u4f3c\u5730\u6211\u4eec\u4e5f\u53ef\u4ee5\u628a\u53d6 $\\min$ \u64cd\u4f5c\u548c `and` \u64cd\u4f5c\u5efa\u7acb\u8054\u7cfb\u3002\n\n\u73b0\u5728\u6211\u4eec\u8003\u8651\u8be2\u95ee\uff0c\u6211\u4eec\u5148\u7ed9\u51fa\u6d41\u7a0b\uff0c\u7136\u540e\u518d\u8bc1\u660e\u5b83\u7684\u6b63\u786e\u6027\uff1a\u6211\u4eec\u628a $a_1\\sim a_k$ \u4ece\u5927\u5230\u5c0f\u6392\u5e8f\uff0c\u6bcf\u4e00\u6b21\u5411 $s$ \u4e2d\u52a0\u5165\u5bf9\u5e94\u7684\u4e0b\u6807 $i$\uff0c\u5982\u679c $f(x,s)=1$\uff0c\u5c31\u8f93\u51fa $a_i$\u3002\n\n\u4e0b\u9762\u6765\u8bc1\u660e\u8fd9\u6837\u4e3a\u4ec0\u4e48\u662f\u5bf9\u7684\uff1a\n\n- \u9996\u5148\u5982\u679c $f(x,s)=1$ \u5373\u65e0\u8bba $a$ \u600e\u4e48\u53d6\u90fd\u6210\u7acb\uff0c\u90a3\u4e48\u5bf9\u4e8e $a$ \u7ed9\u5b9a\u7684\u7279\u6b8a\u60c5\u51b5\u4e5f\u4e00\u5b9a\u6210\u7acb\uff0c\u4e5f\u5c31\u662f $ans\\geqslant a_i$\u3002\n- \u5982\u679c $ans>a_i$\uff0c\u4e5f\u5c31\u662f\u8bf4\u5bf9\u4e8e\u6211\u4eec\u52a0\u5165\u8fc7\u7a0b\u7684\u67d0\u4e2a\u524d\u7f00 $a_{b_k}\\rightarrow a_{b_t}$\uff0c\u5047\u8bbe\u8be5\u524d\u7f00\u5bf9\u5e94\u7684\u96c6\u5408\u662f $s'$\uff0c\u5219 $f(x,s')=0$\uff0c\u4f46\u662f\u5728\u8fd9\u7ec4 $a$ \u7684\u60c5\u51b5\u4e0b\u6709 $a_x\\geqslant \\min_{j\\in s'}(a_j)=a_t$\u3002  \n  \u6211\u4eec\u6ce8\u610f\u5230\u5982\u679c\u5b58\u5728\u4e00\u7ec4 $a'$ \u4f7f\u5f97 $a'_x< \\min_{j\\in s'}(a'_j)$\uff0c\u90a3\u5c55\u5f00 $a'_x$ \u7684\u751f\u6210\u8fc7\u7a0b\uff0c\u4e00\u5b9a\u6709\u4e00\u6b65 $\\min$ \u64cd\u4f5c\u4f7f\u5f97\u4e24\u4e2a\u5143\u7d20\u4e00\u4e2a\u5c5e\u4e8e $s'$\uff0c\u53e6\u4e00\u4e2a\u4e0d\u5c5e\u4e8e $s'$\uff0c\u4e4b\u540e\u7684\u64cd\u4f5c\u90fd\u53ea\u5728 $s'$ \u7684\u8865\u96c6\u4e2d\u8fdb\u884c\uff0c\u800c\u5728\u5f53\u524d\u7684 $a$ \u4e0b\uff0c$s'$ \u4e2d\u7684 $a$ \u662f\u6574\u4e2a\u5e8f\u5217\u6700\u5927\u7684\u4e00\u90e8\u5206\uff0c\u6240\u4ee5\u8fd9\u4e2a $\\min$ \u64cd\u4f5c\u4e5f\u4f1a\u4f7f\u5f97 $a_x$ \u5bf9\u5e94\u7684\u4e0b\u6807\u53d8\u4e3a $s'$ \u8865\u96c6\u4e2d\u7684\u5143\u7d20\uff0c\u4e0e\u6761\u4ef6\u4e0d\u7b26\u3002  \n  \u611f\u6027\u7406\u89e3\u5c31\u662f\u7531\u4e8e\u6211\u4eec\u662f\u4ece\u5927\u5230\u5c0f\u679a\u4e3e\u7684\uff0c\u90a3\u4e48\u8fd9\u4e2a\u9650\u5236\u5df2\u7ecf\u662f\u6240\u6709\u9650\u5236\u4e2d\u6700\u7d27\u7684\u90a3\u4e2a\uff0c\u5982\u679c\u6700\u7d27\u7684\u9650\u5236\u6ee1\u8db3\uff0c\u5219\u5176\u5b83\u7684\u4e5f\u4e00\u5b9a\u6ee1\u8db3\u3002\n\n\u6240\u4ee5\u8fd9\u6837\u4e00\u5b9a\u6709 $ans=a_i$\u3002\u81f3\u4e8e\u5b9e\u73b0\uff0c\u6211\u4eec\u53d1\u73b0\u53d6 $\\max/\\min$ \u53ef\u4ee5\u4f7f\u7528 `bitset` \u52a0\u901f\uff0c\u6240\u4ee5\u603b\u590d\u6742\u5ea6 $O\\left((k+\\dfrac{n}{w})2^k\\right)$ \uff08$n,q$ \u540c\u9636\uff09\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nbitset<4096>f[100020];\nint a[13][100005],b[100005][13],now;\nbool cmp(int x,int y){return a[x][now]==a[y][now]?x>y:a[x][now]>a[y][now];}\nint main()\n{\n    int n,q,k,cnt,op,x,y;\n    scanf(\"%d%d%d\",&n,&k,&q);cnt=k;\n    for(int i=1;i<=k;i++)\n        for(int j=1;j<=n;j++)\n            scanf(\"%d\",&a[i][j]),b[j][i]=i;\n    for(int i=1;i<=n;i++)now=i,sort(b[i]+1,b[i]+k+1,cmp);\n    for(int i=1;i<=k;i++)\n        for(int j=0;j<(1<<k);j++)\n            if(j&(1<<(i-1)))f[i][j]=1;\n    while(q--)\n    {\n        scanf(\"%d%d%d\",&op,&x,&y);\n        if(op==1)cnt++,f[cnt]=f[x]|f[y];\n        else if(op==2)cnt++,f[cnt]=f[x]&f[y];\n        else\n            for(int i=1,t=0;i<=k;i++)\n            {\n                t|=(1<<(b[y][i]-1));\n                if(f[x][t]){printf(\"%d\\n\",a[b[y][i]][y]);break;}\n            }\n    }\n    return 0;\n}\n```\n\n",
        "postTime": 1612526885,
        "uid": 96912,
        "name": "AzusaCat",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF878D \u3010Magic Breeding\u3011"
    },
    {
        "content": "### \u7b80\u8981\u9898\u610f\n\n* \u4e00\u5f00\u59cb\u6709 $k$ \u79cd\u751f\u7269\uff0c\u6bcf\u79cd\u751f\u7269\u6709 $n$ \u4e2a\u5c5e\u6027 $a_{k,1}, a_{k,2}, \\cdots, a_{k,n}$\u3002\u73b0\u6709\u4ee5\u4e0b $3$ \u79cd\u64cd\u4f5c\uff1a\n* (1). \u7ed9\u5b9a\u4e24\u4e2a\u6b63\u6574\u6570 $x$\uff0c$y$\u3002\u521b\u5efa\u4e00\u4e2a\u65b0\u751f\u7269\uff0c\u6b64\u751f\u7269\u7684\u7b2c $i$ \u9879\u5c5e\u6027\u4e3a $\\max(a_{x,i}, a_{y,i})$\u3002\n* (2). \u7ed9\u5b9a\u4e24\u4e2a\u6b63\u6574\u6570 $x$\uff0c$y$\u3002\u521b\u5efa\u4e00\u4e2a\u65b0\u751f\u7269\uff0c\u6b64\u751f\u7269\u7684\u7b2c $i$ \u9879\u5c5e\u6027\u4e3a $\\min(a_{x,i}, a_{y,i})$\u3002\n* (3). \u7ed9\u5b9a\u4e24\u4e2a\u6b63\u6574\u6570 $x$\uff0c$y$\u3002\u8f93\u51fa\u7b2c $x$ \u4e2a\u751f\u7269\u7684\u7b2c $y$ \u9879\u5c5e\u6027\u3002\n* \u65b0\u751f\u7269\u7684\u7f16\u53f7\u5373\u4e3a\u6700\u5c0f\u7684\u672a\u4f7f\u7528\u6570\u5b57\u3002\n* \u64cd\u4f5c\u6570 $q \\leq 10^5$\uff0c\u5c5e\u6027\u6570 $n \\leq 10^5$\uff0c$k \\leq 12$\u3002\n\n### \u9898\u89e3\n\n\u6ce8\u610f\u5230 $k$ \u5f88\u5c0f\uff0c\u800c\u4e14\u6700\u7ec8\u7684\u7b54\u6848\u53ea\u4f1a\u5728\u8fd9 $k$ \u4e2a\u751f\u7269\u91cc\u9762\uff0c\u8003\u8651\u628a $k$ \u4f5c\u4e3a\u5207\u5165\u70b9\u3002\n\n\u4ee4 $f_{i,mask}$ \u4e3a \u5982\u679c\u9009\u62e9\u7684\u751f\u7269\u7684\u4e8c\u8fdb\u5236\u538b\u7f29\u4e3a $mask$\uff0c\u5219\u6b64\u65b0\u751f\u7269\u4e2d\uff0c\u662f\u5426\u4e00\u5b9a\u4f1a\u5b58\u5728\u4e00\u4e2a\u5c5e\u6027\u5927\u4e8e\u7b49\u4e8e $i$ \u53f7\u751f\u7269\u7684\u5bf9\u5e94\u5c5e\u6027\uff1f\n\n**\u521d\u59cb\u5316\uff1a** \u679a\u4e3e $mask$\uff0c\u6ce8\u610f\u5230\u5982\u679c $i$ \u53f7\u751f\u7269\u88ab\u9009\uff0c\u5219 $f_{i, mask}$ \u4e00\u5b9a\u4e3a $1$\uff0c\u5426\u5219\u4e0d\u786e\u5b9a\uff0c\u4e3a $0$\u3002\n\n**\u64cd\u4f5c 1\uff08\u53d6 $\\max$\uff09\uff1a** \u6ce8\u610f\u5230\u4e09\u4e2a\u6570 $a, b, c$\uff0c\u5f53\u4e14\u4ec5\u5f53 $c > a$ \u4e14 $c > b$ \u624d\u6709 $c > \\max(a,b)$\uff0c\u6545\u628a $x$\uff0c$y$ \u7684 $f$ \u6570\u7ec4\u770b\u6210\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6570\uff0c\u5219\u65b0\u751f\u7269 $\\overline{f_{new,1} \\cdots f_{new,n}}$ \u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u6570\u5373\u4e3a $\\overline{f_{x,1} \\cdots f_{x,n}} \\; \\text{and} \\; \\overline{f_{y,1} \\cdots f_{y,n}}$ \n\n\u64cd\u4f5c 2 \u63a8\u5bfc\u540c\u7406\uff0c\u6b64\u5904\u4e0d\u518d\u8d58\u8ff0\u3002\n\n**\u64cd\u4f5c 3\uff08\u6c42\u7b54\u6848\uff09\uff1a** \u5148\u6309\u7167\u90a3\u4e00\u4f4d\u539f\u6765\u7684\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u4e4b\u540e\u8003\u8651\u6bcf\u6b21\u52a0\u8fdb\u53bb\u4e00\u4e2a\u6570\u770b\u770b\u662f\u5426\u4e00\u5b9a\u5927\u4e8e\u7b49\u4e8e\u8fd9\u4e2a\u4f4d\u7f6e\u7684\u503c\uff08\u5373 $f_{...,...}=1$\uff09\u3002\u7b2c\u4e00\u4e2a\u5408\u6cd5\u7684\u6570\u5373\u4e3a\u7b54\u6848\u3002\n\n\u53ef\u4ee5\u4f7f\u7528 ``std::bitset`` \u4f18\u5316\u4e0a\u8ff0\u8fc7\u7a0b\u3002\u6ce8\u610f\u5230\u4e0d\u540c\u7684 $mask$ \u53ea\u6709 $2^k$ \u4e2a\uff0c\u6545\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}(\\frac{q2^k}{w})$\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define LL long long\n#define ULL unsigned long long\n#define LD long double\n#define reg register\n#define _rep(i, x, y) for(int i = x; i <= y; i++)\n#define _per(i, x, y) for(int i = x; i >= y; i--)\ntemplate <typename T>\ninline void read(T &x) {\n\tx = 0; T f = (T) 1;\n\tchar c = getchar();\n\tfor(; !isdigit(c); c = getchar()) {if(c == '-') f = -f;}\n\tfor(; isdigit(c); c = getchar()) x = x * 10 + c - 48;\n\tx *= f;\n}\ntemplate <typename T, typename... Args>\ninline void read(T& x, Args&... args) {\n    read(x); read(args...);\n}\ntemplate <typename T>\ninline void write(T x) {\n\tif(x < 0) {x = -x; putchar('-');}\n\tif(x > 9) write(x / 10);\n\tputchar(x % 10 + '0');\n}\ntemplate <typename T>\ninline void writesp(T x, char sp = ' ') {write(x); putchar(sp);}\n\nconst int maxN = 4e5 + 20;\nint n, k, q, c[12][maxN], f[12], tot, x, y, z;\nstd::bitset<4096> F[maxN];\n\nint main() {\n\tread(n, k, q); tot = k;\n    _rep(i, 0, k - 1) {\n        _rep(j, 1, n) read(c[i][j]);\n    }\n    _rep(i, 0, k - 1) {\n        _rep(mask, 0, (1 << k) - 1) if(mask & (1 << i)) F[i + 1][mask] = 1;\n    }\n    while(q--) {\n        read(x, y, z); \n        if(x == 1) F[++tot] = F[y] & F[z];\n        else if(x == 2) F[++tot] = F[y] | F[z];\n        else {\n            _rep(i, 0, k - 1) f[i] = i;\n            std::sort(f, f + k, [](int i, int j) {\n                return c[i][z] < c[j][z];\n            });\n            int mask = 0;\n            _rep(i, 0, k - 1) {\n                mask |= (1 << f[i]);\n                if(F[y][mask]) {\n                    writesp(c[f[i]][z], '\\n');\n                    break;\n                }\n            }\n        }\n    }\n\treturn 0;\n}\n```",
        "postTime": 1604240197,
        "uid": 46824,
        "name": "fsy_juruo",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF878D \u3010Magic Breeding\u3011"
    },
    {
        "content": "\u8fd9\u9898\u771f\u795e\u4ed9\u554a\u2026\u2026\u867d\u7136\u4ee3\u7801\u7279\u522b\u7684\u77ed\uff0c\u4f46\u662f\u601d\u8def\u975e\u5e38\u96be\u4ee5\u7406\u89e3\u2026\u2026\n\n\u9996\u5148\u6211\u4eec\u6ce8\u610f\u5230\u6700\u7ec8\u7b54\u6848\u53ea\u80fd\u662f\u8fd912\u4e2a\u521d\u59cb\u751f\u7269\u91cc\u7684\u67d0\u4e00\u4e2a\uff0c\u90a3\u4e48\u6211\u4eec\u4e0d\u59a8\u4ece**\u6765\u6e90**\u5165\u624b\uff0c\u7136\u540e\u6211\u4eec\u5bf9\u6bcf\u4e2a\u751f\u7269\u8bbe$f[i][S]$\u4e3a$S$\u7684\u4e00\u4e2a\u5b50\u96c6\u662f\u5426\u80fd\u591f\u81f3\u5c11\u4f5c\u4e3ai\u7684\u6240\u6709\u5c5e\u6027\u7684\u5168\u90e8\u6765\u6e90\uff08\u53ef\u80fd\u76f4\u63a5\u89e3\u91ca\u5176\u610f\u4e49\u6bd4\u8f83\u96be\u7406\u89e3\u2026\u2026\u53ef\u4ee5\u5148\u770b\u4e0b\u9762\u7684\u2026\u2026\uff09\u3002\n\n\u5148\u8bf4\u4e00\u4e0b\u5982\u4f55\u7edf\u8ba1\u7b54\u6848\uff0c\u6211\u4eec\u4ece\u5927\u5230\u5c0f\u8003\u8651\u8fd9\u4e2a\u5c5e\u6027\u521d\u59cb\u7684k\u4e2a\u6765\u6e90\uff0c\u5982\u679c\u5b58\u5728\u4e00\u4e2ai\u4f7f\u5f97\u524di\u5927\u7684\u6765\u6e90\u6784\u6210\u7684\u96c6\u5408\u7684\u8d85\u96c6\u5f00\u59cb\u5728$f[i]$\u4e2d\u5b58\u5728\uff0c\u90a3\u4e48i\u5c31\u662f\u7b54\u6848\u4e86\uff0c\u6240\u4ee5\u6bd4\u5b9e\u9645\u5c5e\u6027\u5c0f\u7684\u6211\u4eec\u5e76\u4e0d\u7528\u53bb\u8003\u8651\uff0c\u53ea\u9700\u8981\u53bb\u6389\u6bd4\u4ed6\u5927\u7684\u975e\u6cd5\u96c6\u5408\u5c31\u884c\u4e86\u3002\n\n\u6211\u4eec\u8003\u8651\u5982\u4f55\u5904\u7406$min$\u548c$max$\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u73b0\u5728\u6709$a$\u548c$b$\uff0c\u60f3\u53d6min\u751f\u4e00\u4e2a$c$\uff0c\u8003\u8651\u7b2c$i$\u4e2a\u5c5e\u6027\uff0c\u6211\u4eec\u5047\u8bbe\u5728\u8fd9\u4e2a\u5c5e\u6027\u4e0a$a>b$\uff0c\u90a3\u4e48\u4e5f\u5c31\u662f\u8bf4$a$\u7684\u4e00\u4e9b\u6765\u6e90\u7684\u96c6\u5408\u4e0d\u80fd\u6210\u4e3a$c$\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u5982\u679c\u60f3\u8ba9$S$\u6210\u4e3a$c$\u7684\u6765\u6e90\u96c6\u5408\uff0c\u90a3\u4e48\u5fc5\u987b\u5f53\u4e14\u4ec5\u5f53$f[a][S]=1$\u4e14$f[b][S]=1$\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6b63\u597d\u662f\u4e2a\u6309\u4f4d\u4e0e\u3002\u6216\u8005\u8bf4\uff0c\u8fd9\u662f\u4e2a\u96c6\u5408\u7684\u4ea4\uff0c\u56e0\u4e3a\u6211\u4eec\u7684$S$\u5b9e\u9645\u4e0a\u662f\u8d85\u96c6\uff0c\u6211\u4eec\u53d6\u7684\u662f$a$\u548c$b$\u5185\u90fd\u6709\u7684\u90e8\u5206\u3002\n\n\u540c\u7406$max$\u6309\u4f4d\u6216\u5c31\u884c\u4e86\uff0c\u56e0\u4e3a\u8fd9\u4e00\u5b9a\u80fd\u5305\u542b\u4f4f\u66f4\u5927\u7684\u6765\u6e90\uff0c\u6bd4\u8fd9\u4e2a\u5c0f\u7684\u6765\u6e90\u4e0d\u7528\u8003\u8651\u3002\n\n\uff08\u5982\u679c\u4f60\u5bf9\u6b64\u4ecd\u7136\u4e00\u8138\u61f5\u903c\u7684\u8bdd\uff0c\u5efa\u8bae\u624b\u73a9\u51e0\u4e2a\u4f8b\u5b50\u7684$f[i][S]$\u7136\u540e\u4f60\u5c31\u4f1a\u611f\u6027\u7406\u89e3\u5b83\u662f\u5bf9\u7684\u2026\u2026\uff09\n\n\u4e0a\u4ee3\u7801~\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <vector>\n#define ll unsigned long long\nusing namespace std;\nnamespace ywy {\n\tinline int get() {\n\t    int n = 0;\n\t    char c;\n\t    while ((c = getchar()) || 23333) {\n\t        if (c >= '0' && c <= '9')\n\t            break;\n\t        if (c == '-')\n\t            goto s;\n\t    }\n\t    n = c - '0';\n\t    while ((c = getchar()) || 23333) {\n\t        if (c >= '0' && c <= '9')\n\t            n = n * 10 + c - '0';\n\t        else\n\t            return (n);\n\t    }\n\ts:\n\t    while ((c = getchar()) || 23333) {\n\t        if (c >= '0' && c <= '9')\n\t            n = n * 10 - c + '0';\n\t        else\n\t            return (n);\n\t    }\n\t}\n\tint sz;\n\ttypedef struct _bitset {\n\t    ll data[70];\n\t    _bitset() { memset(data, 0, sizeof(data)); }\n\t    friend _bitset operator|(const _bitset &a, const _bitset &b) {\n\t        _bitset c;\n\t        for (register int i = 0; i <= sz; i++) c.data[i] = a.data[i] | b.data[i];\n\t        return (c);\n\t    }\n\t    friend _bitset operator&(const _bitset &a, const _bitset &b) {\n\t        _bitset c;\n\t        for (register int i = 0; i <= sz; i++) c.data[i] = a.data[i] & b.data[i];\n\t        return (c);\n\t    }\n\t    inline int get(int b) { return ((data[b / 64] & (1ull << (b & 63))) != 0); }\n\t    inline void set(int b) { data[b / 64] |= (1ull << (b & 63)); }\n\t} bitset;\n\ttypedef struct _n {\n\t    int id;\n\t    int val;\n\t    friend bool operator<(const _n &a, const _n &b) { return (a.val > b.val); }\n\t} node;\n\tvector<node> vec[200001];\n\tbitset b[110001];\n\tvoid ywymain() {\n\t    int n = get(), k = get(), q = get();\n\t    sz = (1 << k) / 64 + 1;\n\t    for (register int i = 0; i < k; i++) {\n\t        for (register int j = 1; j <= n; j++) {\n\t            node cjr;\n\t            cjr.id = i;\n\t            cjr.val = get();\n\t            vec[j].push_back(cjr);\n\t        }\n\t        for (register int j = 0; j < (1 << k); j++) {\n\t            if (j & (1 << i))\n\t                b[i + 1].set(j);\n\t        }\n\t    }\n\t    for (register int i = 1; i <= n; i++) sort(vec[i].begin(), vec[i].end());\n\t    int gn = k + 1;\n\t    while (q) {\n\t        q--;\n\t        int op = get();\n\t        if (op == 1) {\n\t            int x = get(), y = get();\n\t            b[gn] = b[x] | b[y];\n\t            gn++;\n\t        }\n\t        if (op == 2) {\n\t            int x = get(), y = get();\n\t            b[gn] = b[x] & b[y];\n\t            gn++;\n\t        }\n\t        if (op == 3) {\n\t            int x = get(), y = get();\n\t            int s = 0;\n\t            for (register int i = 0; i < vec[y].size(); i++) {\n\t                s |= (1 << vec[y][i].id);\n\t                if (b[x].get(s)) {\n\t                    printf(\"%d\\n\", vec[y][i].val);\n\t                    break;\n\t                }\n\t            }\n\t        }\n\t    }\n\t}\n}\nint main() {\n    ywy::ywymain();\n    return (0);\n}\n```",
        "postTime": 1554985654,
        "uid": 125124,
        "name": "ywy_c_asm",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF878D \u3010Magic Breeding\u3011"
    },
    {
        "content": "\u672c\u6587\u540c\u6b65\u4e8e\u6211\u7684 [cnblog](https://www.cnblogs.com/ZigZagKmp/p/14396638.html)\n\n~~\u542c\u8bf4 WC2021 \u7684 T2 \u548c\u8fd9\u9898\u89e3\u6cd5\u7c7b\u4f3c\uff0c\u4e8e\u662f\u5c31\u6765\u505a\u4e00\u53d1\u3002~~\n\n## \u9898\u610f\u7b80\u8ff0\n\u521d\u59cb\u6709 $k$ \u4e2a\u751f\u7269\uff0c\u7f16\u53f7\u5206\u522b\u4e3a $1,2,\\ldots,k$ \uff0c\u6bcf\u4e2a\u751f\u7269\u6709 $n$ \u4e2a\u5c5e\u6027\uff0c\u7b2c $i$ \u4e2a\u751f\u7269\u7684\u7b2c $j$ \u4e2a\u5c5e\u6027\u4e3a $a_{i,j}$ \u3002\n\n\u73b0\u5728\u6709 $q$ \u6b21\u64cd\u4f5c\uff0c\u5f62\u5f0f\u5982\u4e0b\uff1a\n\n- `1 x y` \u8868\u793a\u5c06\u7b2c $x$ \u53f7\u751f\u7269\u7684 $n$ \u4e2a\u5c5e\u6027\u4e0e\u7b2c $y$ \u53f7\u751f\u7269\u7684 $n$ \u4e2a\u5c5e\u6027\u5206\u522b\u53d6 $\\max$ \uff0c\u4f5c\u4e3a\u4e00\u4e2a\u65b0\u751f\u7269\u7684 $n$ \u4e2a\u5c5e\u6027\n- `2 x y` \u8868\u793a\u5c06\u7b2c $x$ \u53f7\u751f\u7269\u7684 $n$ \u4e2a\u5c5e\u6027\u4e0e\u7b2c $y$ \u53f7\u751f\u7269\u7684 $n$ \u4e2a\u5c5e\u6027\u5206\u522b\u53d6 $\\min$ \uff0c\u4f5c\u4e3a\u4e00\u4e2a\u65b0\u751f\u7269\u7684 $n$ \u4e2a\u5c5e\u6027\n- `3 x y` \u8868\u793a\u8be2\u95ee\u7b2c $x$ \u53f7\u751f\u7269\u7684\u7b2c $y$ \u4e2a\u5c5e\u6027\u503c\u662f\u591a\u5c11\n\n\u65b0\u751f\u7269\u7684\u7f16\u53f7\u4f9d\u6b21\u987a\u5ef6\uff0c\u5373\u7b2c $t$ \u4e2a `1/2` \u64cd\u4f5c\u5f97\u5230\u7684\u65b0\u751f\u7269\u7f16\u53f7\u4e3a $t+k$ \u3002\n\n\u4f60\u9700\u8981\u5bf9\u6bcf\u4e00\u4e2a 3 \u64cd\u4f5c\u56de\u7b54\u8be2\u95ee\u3002\n\n$1\\le n,q\\le 10^5,1\\le k\\le 12,1\\le a_{i,j}\\le 10^9$ \u3002\n\n## \u7b97\u6cd5\u5206\u6790\n\n\u5982\u679c\u76f4\u63a5\u66b4\u529b\u505a\u590d\u6742\u5ea6\u662f $\\mathcal O(nq)$ \u7684\uff0c\u65e0\u6cd5\u63a5\u53d7\u3002\n\n\u672c\u9898 $k$ \u5f88\u5c0f\uff0c\u662f\u672c\u9898\u7684\u7a81\u7834\u70b9\u3002\u4e0d\u96be\u53d1\u73b0\u5bf9\u4e8e\u6bcf\u4e00\u79cd\u5c5e\u6027\uff0c\u6211\u4eec\u6700\u540e\u7684\u7b54\u6848\u4e00\u5b9a\u6765\u81ea\u4e8e\u521d\u59cb\u7684 $k$ \u4e2a\u751f\u7269\u7684\u8be5\u5c5e\u6027\u7684\u503c\uff0c\u56e0\u6b64\u8003\u8651**\u679a\u4e3e\u7b54\u6848**\u3002 $\\min,\\max$ **\u672c\u8eab\u4ee3\u8868\u4e00\u79cd\u504f\u5e8f\u5173\u7cfb**\uff0c\u4e0e\u5176\u5177\u4f53\u503c\u65e0\u5173\uff0c\u6240\u6709\u53ef\u80fd\u7684\u60c5\u51b5\u5171\u6709 $2^k$ \u4e2a\u3002\u8fd9\u8bf4\u660e $n$ \u79cd\u5c5e\u6027\u4e2d\u6700\u591a\u6709 $2^k$ \u4e2a**\u672c\u8d28\u4e0d\u540c\u7684\u5c5e\u6027**\uff0c\u8003\u8651\u7ef4\u62a4\u8fd9 $2^k$ \u79cd\u72b6\u6001\u3002\n\n\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u72b6\u6001 $S$ \u5982\u4e0b\uff1a\u82e5 $S$ \u7684\u7b2c $i$ \u4f4d\u4e3a $1$ \uff0c\u8868\u793a\u5f53\u524d\u72b6\u6001\u4e0b $a_i\\ge\\ \\text{\u5bf9\u5e94\u7684\u7b54\u6848}$\uff0c\u5426\u5219 $a_i<\\ \\text{\u5bf9\u5e94\u7684\u7b54\u6848}$\uff0c\u6b64\u65f6\u5f53\u524d\u8282\u70b9\u7684\u771f\u5b9e\u7b54\u6848\u662f\u5426 $\\ge$ \u5f53\u524d\u72b6\u6001\u5bf9\u5e94\u7684\u7b54\u6848\u3002\n\n\u90a3\u4e48\u6211\u4eec\u4e0d\u96be\u53d1\u73b0 $1,2$ \u64cd\u4f5c\u5206\u522b\u5bf9\u5e94\u53d6 $\\mathrm{or}$ \u548c\u53d6 $\\mathrm{and}$ \u3002\u521d\u59cb\u6761\u4ef6\u5bf9\u4e8e\u751f\u7269 $i$ \uff0c$f_i(S)=1\\ \\text{\u5f53\u4e14\u4ec5\u5f53}\\ S_i=1$ \u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u67e5\u8be2\uff0c\u6211\u4eec\u4ece\u5927\u5230\u5c0f\u679a\u4e3e\u6240\u6709\u7684\u53ef\u80fd\u7b54\u6848\uff0c\u4e0d\u96be\u6c42\u51fa\u8fd9\u4e2a\u7b54\u6848\u5bf9\u5e94\u7684\u72b6\u6001 $S$ \u3002\u6839\u636e\u4e0a\u8ff0\u5b9a\u4e49\uff0c\u5f53\u6211\u4eec\u679a\u4e3e\u5230\u7b2c\u4e00\u4e2a\u72b6\u6001\u5bf9\u5e94\u503c\u4e3a $1$ \u7684\u7b54\u6848\u65f6\uff0c\u6b64\u65f6\u7b54\u6848\u5373\u4e3a\u771f\u5b9e\u7b54\u6848\u3002\n\n\u53d1\u73b0\u53ef\u4ee5\u7528 `bitset` \u4f18\u5316\uff0c\u6700\u7ec8\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal O\\left(\\frac{q2^k+qk^2}{\\omega}\\right)$ \u3002\n\n## \u4ee3\u7801\u5b9e\u73b0\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define maxn 100005\n#define maxm 2000005\n#define inf 0x3f3f3f3f\n#define LL long long\n#define mod 1000000007\n#define local\nvoid file(string s){freopen((s+\".in\").c_str(),\"r\",stdin);freopen((s+\".out\").c_str(),\"w\",stdout);}\ntemplate <typename Tp> void read(Tp &x){\n\tint fh=1;char c=getchar();x=0;\n\twhile(c>'9'||c<'0'){if(c=='-'){fh=-1;}c=getchar();}\n\twhile(c>='0'&&c<='9'){x=(x<<1)+(x<<3)+(c&15);c=getchar();}x*=fh;\n}\nint n,m,mm,q;\nint a[13][maxn];\nbitset<4100>f[maxn];\nint tmp[20],ttt;\nvoid solve(int x,int y){\n\tttt=0;\n\tfor(int i=1;i<=m;++i)tmp[++ttt]=a[i][y];\n\tsort(tmp+1,tmp+ttt+1);\n\tttt=unique(tmp+1,tmp+ttt+1)-tmp-1;// \u8fd9\u91cc\u505a\u4e86\u79bb\u6563\u5316\uff0c\u5728\u6700\u4f18\u5316\u95ee\u9898\u4e2d\uff08\u5373\u672c\u9898\uff09\u4e0d\u4e00\u5b9a\u6709\u5fc5\u8981\n\tint S;                            // \u4f46\u5728\u8ba1\u6570\u95ee\u9898\u4e2d\uff08WC2021T2\uff09\u5fc5\u987b\u79bb\u6563\u5316\n\tfor(int i=ttt;i;--i){\n\t\tint xx=tmp[i];S=0;// \u679a\u4e3e\u7b54\u6848xx\uff0c\u6c42\u51fa\u5bf9\u5e94\u72b6\u6001S\n\t\tfor(int j=1;j<=m;++j){\n\t\t\tif(a[j][y]>=xx)S|=(1<<(j-1));\n\t\t}\n\t\tif(f[x][S]){//\u7b2c\u4e00\u4e2a\u503c\u4e3a1\u7684\u72b6\u6001\u5bf9\u5e94\u7b54\u6848\u5373\u4e3a\u771f\u5b9e\u7b54\u6848\n\t\t\tprintf(\"%d\\n\",xx);\n\t\t\tbreak;\n\t\t}\n\t}\n}\nsigned main(){\n\tread(n);read(m);read(q);\n\tfor(int i=1;i<=m;++i){\n\t\tfor(int j=1;j<=n;++j){\n\t\t\tread(a[i][j]);\n\t\t}\n\t\tfor(int S=0;S<(1<<m);++S){//\u521d\u59cb\u72b6\u6001\u6c42\u89e3\n\t\t\tif((S>>(i-1))&1)f[i][S]=1;\n\t\t\telse f[i][S]=0;\n\t\t}\n\t}\n\tmm=m;\n\tfor(int i=1,op,x,y;i<=q;++i){\n\t\tread(op);read(x);read(y);\n\t\tif(op==1){//\u64cd\u4f5c1\u5bf9\u5e94 or\n\t\t\t++mm;\n\t\t\tf[mm]=(f[x]|f[y]);\n\t\t}\n\t\tif(op==2){//\u64cd\u4f5c2\u5bf9\u5e94 and\n\t\t\t++mm;\n\t\t\tf[mm]=(f[x]&f[y]);\n\t\t}\n\t\tif(op==3){\n\t\t\tsolve(x,y);\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1612962853,
        "uid": 35871,
        "name": "ZigZagKmp",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF878D \u3010Magic Breeding\u3011"
    },
    {
        "content": "[CF878D Magic Breeding](https://www.luogu.com.cn/problem/CF878D)\n\n\u6bcf\u4e2a\u751f\u7269\u90fd\u53ef\u4ee5\u5199\u6210 $k$ \u4e2a\u521d\u59cb\u751f\u7269\u7684 $\\min / \\max$ \u8868\u8fbe\u5f0f\uff0c\u4f46\u8868\u8fbe\u5f0f\u957f\u5ea6\u7ea7\u522b\u4e3a $\\mathcal{O}(q)$\uff0c\u65e0\u6cd5\u63a5\u53d7\u3002\n\n\u8003\u8651\u5bf9\u8868\u8fbe\u5f0f\u7684\u5f62\u6001\u505a\u51fa\u4e00\u4e9b\u89c4\u5b9a\u3002\u6211\u4eec\u77e5\u9053 $\\min$ \u548c $\\max$ \u4e92\u76f8\u6709\u5206\u914d\u5f8b\uff0c\u6240\u4ee5\u6211\u4eec\u603b\u53ef\u4ee5\u5c06\u8868\u8fbe\u5f0f\u5199\u6210 **\u82e5\u5e72\u4e2a $\\max$ \u8868\u8fbe\u5f0f\u7684 $\\min$**\uff0c\u7c7b\u4f3c\u7531\u82e5\u5e72\u7b80\u5355\u5408\u53d6\u5f0f\u6784\u6210\u7684\u6790\u53d6\u8303\u5f0f\u3002\n\n\u6211\u4eec\u8bbe\u96c6\u5408 $S$ \u8868\u793a $\\max\\limits_{j\\in S} a_j$\uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u7528\u82e5\u5e72\u96c6\u5408 $S$ \u5f62\u6210\u7684\u96c6\u5408 $T = \\{S_1, S_2, \\cdots,  S_k\\}$ \u63cf\u8ff0\u4e00\u4e2a\u8868\u8fbe\u5f0f\uff0c\u5373\u4e00\u4e2a\u751f\u7269\uff0c\u5176\u542b\u4e49\u4e3a $\\min\\limits_{S_i\\in T}\\left(\\max\\limits_{j\\in S_i} a_j\\right)$\u3002\n\n\u5408\u5e76 $T_i$ \u548c $T_j$ \u5f97\u5230 $T_k$ \u65f6\uff0c\u82e5\u5916\u5c42\u4e3a $\\min$\uff0c\u5219 $T_k = T_i\\cup T_j$\uff0c\u82e5\u5916\u5c42\u4e3a $\\max$\uff0c\u5219 $T_k = \\{X\\cup Y | X\\in T_i, Y\\in T_j\\}$\u3002\u7528 $f_{i, S}$ \u8868\u793a $[S\\in T_i]$\uff0c\u5219\u53d6 $\\max$ \u76f8\u5f53\u4e8e\u6216\u5377\u79ef\uff0c\u7136\u540e\u5c06\u503c\u975e\u96f6\u7684\u4f4d\u7f6e\u8bbe\u4e3a $1$\u3002\u8fd9\u6837\uff0c\u6211\u4eec\u6709\u4e00\u4e2a $q2 ^ kk$ \u7684\u505a\u6cd5\uff0c\u4f46\u4e0d\u591f\u5feb\u3002\n\n\u6ce8\u610f\u5230\u82e5 $X\\in T_i$\uff0c\u5219\u5c06\u6240\u6709 $X$ \u7684\u8d85\u96c6\u52a0\u5165\u4e0d\u5f71\u54cd\u7b54\u6848\u3002\u56e0\u6b64\uff0c\u4e0d\u59a8\u8bbe\u521d\u59cb $f_{i, S} = [i\\in S]$\uff0c\u6b64\u65f6\u6ee1\u8db3\u5bf9\u4e8e\u4efb\u610f $S$\uff0c\u82e5 $f_{i, S} = 1$ \u5219 $f_{i, S'} = 1$\uff0c\u5176\u4e2d $S\\subseteq S$\u3002\u6211\u4eec\u53d1\u73b0 $f_i$ \u548c $f_j$ \u672c\u8eab\u5df2\u7ecf\u662f\u70b9\u503c\u8868\u793a\uff0c\u6240\u4ee5\u5b83\u4eec\u7684\u70b9\u503c\u79ef\uff08\u5bf9\u5e94\u4f4d\u7f6e AND\uff09\u5373\u4e3a\u5b83\u4eec\u505a\u6216\u5377\u79ef\u540e\u7684\u7ed3\u679c\uff0c\u4e14\u540c\u6837\u6ee1\u8db3\u70b9\u503c\u8868\u793a\u3002\n\n\u7528 `bitset` \u7ef4\u62a4\u957f\u4e3a $2 ^ k$ \u7684 $01$ \u5e8f\u5217\u7684\u6309\u4f4d\u4e0e\u548c\u6309\u4f4d\u6216\u3002\u5c06\u8be2\u95ee\u79bb\u7ebf\u5230\u6bcf\u4e2a\u4f4d\u7f6e\u4e0a\uff0c\u6700\u540e\u5bf9\u6bcf\u4e2a\u4f4d\u7f6e $p$ \u8fdb\u884c $2 ^ k$ \u72b6\u538b DP \u5f97\u5230 $f_S = \\max\\limits_{i \\in S} a_{i, p}$\uff0c\u5219\u8be2\u95ee $(x, p)$ \u7684\u7b54\u6848\u4e3a $\\min\\limits_{S\\in T_x} f_S$\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}((n + q)2 ^ k)$\u3002[\u4ee3\u7801](https://codeforces.com/contest/878/submission/180033919)\u3002\n\n\u5229\u7528\u6027\u8d28\uff0c\u5bf9\u4e8e\u6bcf\u6b21\u8be2\u95ee $(x, y)$\uff0c\u6211\u4eec\u53ef\u4ee5\u6309 $a_{i, y}$ \u4ece\u5c0f\u5230\u5927\u7684\u987a\u5e8f\u679a\u4e3e $i$\uff0c\u82e5\u5df2\u7ecf\u88ab\u679a\u4e3e\u8fc7\u7684 $i$ \u5f62\u6210\u7684\u96c6\u5408 $S$ \u5bf9\u5e94\u7684 $f_{x, S}$ \u7b2c\u4e00\u6b21\u4e3a $1$\uff0c\u5219 $a_{i, y}$ \u5373\u4e3a\u6240\u6c42\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}\\left(k 2 ^ k + \\dfrac {q2 ^ k} w + kq + nk\\log k\\right)$\u3002[\u4ee3\u7801](https://codeforces.com/contest/878/submission/180154810)\u3002",
        "postTime": 1667967433,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "CF878D Magic Breeding"
    },
    {
        "content": "CF \u8bc4\u5206\u6709\u6bd2\u5427\uff0c\u66b4\u529b\u9898\u4e0a *2900\u3002\n\n\u5148\u53e3\u80e1\u4e00\u4e0b\uff0c\u4ee3\u7801\u7b49\u4f1a\u518d\u5199\u3002\n\n\u9996\u5148\u8003\u8651 $a_{x,y}\\in \\{0,1\\}$\uff0c\u90a3 $n$ \u4e2a\u5c5e\u6027\u5bf9\u5e94\u7684\u4eba\u7684\u72b6\u6001\u53ea\u6709 $2^k$ \u4e2a\uff0c\u53ef\u4ee5\u628a\u72b6\u6001\u76f8\u540c\u7684\u5c5e\u6027\u90fd\u5408\u5e76\u6210\u4e00\u4e2a\u5c5e\u6027\u3002\n\n\u53d6 $\\max$ \u548c $\\min$ \u64cd\u4f5c\u5c31\u53d8\u6210\u4e86\u4e24\u4e2a\u4eba\u4e0e/\u6216\u8d77\u6765\u3002\u6211\u4eec\u53ef\u4ee5\u5bf9\u6bcf\u4e2a\u5c5e\u6027\u90fd\u5355\u72ec\u8003\u8651\u3002\u4ee4 $f_{i,S}$ \u8868\u793a\u524d $k$ \u4e2a\u4eba\u8be5\u5c5e\u6027\u72b6\u6001\u4e3a $S$\uff0c\u7b2c $i$ \u4e2a\u4eba\u8be5\u5c5e\u6027\u7684\u503c\u3002\u7528 `bitset` \u53ef\u4ee5 $O(\\frac{2^kq}{w})$ \u9884\u5904\u7406\u3002\n\n\u7136\u540e\u8003\u8651 $a_{x,y}\\in \\mathbb{N^*}$\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u8be2\u95ee\uff0c\u79bb\u6563\u5316\u540e $O(k)$ \u679a\u4e3e\u7b54\u6848 $x$ \uff0c$<x$ \u7684\u6743\u503c\u6539\u4e3a $0$\uff0c$\\ge x$ \u7684\u6743\u503c\u6539\u4e3a $1$\u3002\u56e0\u4e3a\u8fd9\u6837\u7684\u8bdd\u53d6 $0$ \u4e0e $0$ \u53d6 $\\max$ \u8fd8\u662f $0$\uff0c\u4ee3\u8868\u5c0f\u4e8e $x$ \u7684\u6570\u548c\u53e6\u4e00\u4e2a\u5c0f\u4e8e $x$ \u7684\u6570\u53d6\u6700\u5927\u8fd8\u662f\u5c0f\u4e8e $x$\uff0c\u53e6\u5916\u4e09\u79cd\u60c5\u51b5\u540c\u7406\u3002\u800c\u6743\u503c\u6539\u53d8\u540e\u7684\u7b54\u6848\u5df2\u7ecf\u9884\u5904\u7406\u51fa\u6765\u4e86\uff0c\u6240\u4ee5\u6bcf\u6b21\u8be2\u95ee $O(k^2)$\u3002\n\n\u590d\u6742\u5ea6 $O(q(\\frac{2^k}{w}+k^2))$\u3002\n\n---\n\nupd : \u8865\u4e0a\u4e86[\u8bc4\u6d4b\u8bb0\u5f55](https://codeforces.com/contest/878/submission/188676454)\u3002\n\n\u5176\u5b9e\u4e0d\u7528\u5e76\u67e5\u96c6\u5408\u5e76\u76f8\u540c\u5c5e\u6027\uff0c\u56e0\u4e3a\u4f60\u5bf9 $2^k$ \u79cd\u60c5\u51b5\u90fd\u9884\u5904\u7406\u4e86\uff0c\u76f4\u63a5\u6c42\u51fa\u5bf9\u5e94\u60c5\u51b5\u7684\u7b54\u6848\u5373\u53ef\u3002",
        "postTime": 1673339361,
        "uid": 306573,
        "name": "Ender32k",
        "ccfLevel": 0,
        "title": "CF878D Magic Breeding \u9898\u89e3"
    },
    {
        "content": "\u55b5\u55b5\u9898\u3002\n\n\u9996\u5148\u6ce8\u610f\u5230 $k$ \u5f88\u5c0f\uff0c\u662f\u4e2a\u5f88\u9002\u5408\u72b6\u6001\u538b\u7f29\u7684\u8303\u56f4\u3002\n\n\u5f88\u663e\u7136\u5217\u4e0e\u5217\u4e4b\u95f4\u662f\u72ec\u7acb\u7684\uff0c\u56e0\u6b64\u5bf9\u6bcf\u4e00\u5217 $k$ \u4e2a\u6570\u5206\u5f00\u8003\u8651\u3002\n\n\u56e0\u4e3a\u6211\u4eec\u8981\u72b6\u538b\uff0c\u663e\u7136\u9700\u8981\u72b6\u6001\u662f\u4e00\u4e2a $k$ \u4f4d\u7684\u4e8c\u8fdb\u5236\u6570\u3002\u8003\u8651 $a_{i,j}$ \u4e3a\u4e8c\u8fdb\u5236\u6570\u7684\u60c5\u51b5\u3002\u53d1\u73b0\u6b64\u65f6\u672c\u8d28\u4e0d\u540c\u7684\u5217\u5f88\u5c11\uff0c\u53ea\u6709 $2^k$ \u79cd\u3002\u56e0\u6b64\u5c06\u5217\u7684\u72b6\u6001\u8bb0\u5230 dp \u72b6\u6001\u4e2d\uff0c\u8bbe $f_{i,S}$ \u8868\u793a\u5217\u7684\u521d\u59cb\u72b6\u6001\u4e3a $S$ \u65f6\uff0c\u7b2c $i$ \u884c\u7684\u8fd9\u4e00\u5217\u7684\u503c\u3002 \n\n\u8003\u8651\u8f6c\u79fb\u3002\u4e0d\u597d\u5904\u7406\u7684 $min$ \u548c $max$ \u5728\u4e8c\u8fdb\u5236\u72b6\u51b5\u4e0b\u53d8\u6210\u4e86 $\\wedge$ \u548c $\\vee$ \u64cd\u4f5c\uff0c\u56e0\u6b64\u6211\u4eec\u4f7f\u7528 bitset \u4f18\u5316 dp\u3002\n\n\u8003\u8651\u5982\u4f55\u5c06\u666e\u901a\u60c5\u51b5\u8f6c\u5316\u4e3a\u4e8c\u8fdb\u5236\u60c5\u51b5\u3002\u6211\u4eec\u53d1\u73b0\u6211\u4eec\u53ea\u5173\u5fc3\u6570\u4e4b\u95f4\u7684\u5927\u5c0f\u5173\u7cfb\uff0c\u4e0d\u5173\u5fc3\u5176\u5177\u4f53\u7684\u503c\u3002\u56e0\u6b64\u53ef\u4ee5\u8003\u8651\u4e00\u79cd\u8f6c\u6362\u65b9\u5f0f\u4f7f\u5176\u53ea\u8bb0\u4f4f\u8be5\u6570\u5728\u5217\u4e2d\u7684\u6392\u540d\uff0c\u5e76\u4e14\u4e5f\u80fd\u5c06 $min$ \u548c $max$ \u64cd\u4f5c\u8f6c\u6362\u4e3a $\\wedge$ \u548c $\\vee$ \u64cd\u4f5c\u3002\n\n\u8bbe\u4e00\u4e2a\u6570\u5728\u6b64\u5217\u4e2d\u7684\u6392\u540d\u4e3a $p$ \uff0c\u6211\u4eec\u5c06\u5176\u8f6c\u6362\u4e3a $p$ \u4e2a $1$ \u540e\u9762\u8ddf\u7740 $k-p$ \u4e2a $0$ \u3002\u5f88\u663e\u7136\uff0c\u6211\u4eec\u53ea\u8981\u6570 $1$ \u7684\u4e2a\u6570\u5c31\u80fd\u77e5\u9053\u8be5\u6570\u5728\u5217\u4e2d\u7684\u6392\u540d\u3002\u6211\u4eec\u5c06\u4e00\u884c\u4e2d\u7684\u6bcf\u4e2a\u6570\u90fd\u8f6c\u6362\u4e3a\u8fd9\u6837\u7684\u4e00\u4e2a $k$ \u4f4d\u4e8c\u8fdb\u5236\u6570\u3002\u6211\u4eec\u5c06\u4e00\u4e2a $k\\times n$  \u7684\u6b63\u6574\u6570\u77e9\u9635\u8f6c\u6362\u4e3a\u4e86\u4e00\u4e2a $k\\times kn$ \u7684 $01$ \u77e9\u9635\u3002\u5728\u8f6c\u6362\u540e\u7684\u77e9\u9635\u4e2d\u4f9d\u65e7\u53ef\u4ee5\u5c06\u6bcf\u4e00\u5217\u5206\u5f00\u6765\u8003\u8651\uff0c\u56e0\u6b64\u6309\u4e4b\u524d\u7684\u505a\u6cd5\u505a\u5373\u53ef\uff0c\u590d\u6742\u5ea6\u4e3a $O(q\\frac{2^k}{w})$\u3002",
        "postTime": 1666885545,
        "uid": 124918,
        "name": "LinkyChristian",
        "ccfLevel": 6,
        "title": "\u3010\u9898\u89e3\u3011CF878D Magic Breeding"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/LaoMang-no-blog/p/16309694.html)\n\n---\n\n[**\u4f60\u8c37 link**](https://www.luogu.com.cn/problem/CF878D)\n\n[**CF link**](https://codeforces.com/problemset/problem/878/D)\n\n\u53c8\u662f\u4e00\u9053 `bitset` \u79d1\u6280\u9898\uff0c\u4f46\u662f\u601d\u7ef4\u96be\u5ea6\u4e5f\u8fd8\u662f\u5f88\u9ad8\u7684\u3002\n\n\u8003\u8651\u5148\u5f31\u5316\u4e00\u4e0b\u9898\u76ee\uff0c\u5982\u679c\u7279\u5f81\u53ea\u6709 $0/1$ \u8be5\u600e\u4e48\u505a\uff0c\u8003\u8651\u5bf9\u4e8e $0/1$ \u6765\u8bf4\uff0c$\\min/\\max$ \u53ef\u4ee5\u770b\u6210 $\\operatorname{bitand}/\\operatorname{bitor}$ \u64cd\u4f5c\uff0c\u90a3\u4e48\u6211\u4eec\u8003\u8651\u5982\u679c\u5c06\u6240\u6709\u751f\u7269\u7684\u4e00\u79cd\u7279\u5f81\u5355\u72ec\u505a\u4f1a\u600e\u4e48\u6837\uff0c\u73b0\u5728\u7684\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u7ed9\u5b9a\u4e00\u4e2a\u6570\u7ec4\uff0c\u6bcf\u6b21\u65b0\u751f\u6210\u4e00\u4e2a\u5143\u7d20\u8868\u793a\u4e3a\u4e4b\u524d\u9009\u53d6\u4e24\u4e2a\u503c\u7684 $\\operatorname{bitand}/\\operatorname{bitor}$\uff0c\u73b0\u5728\u7684\u60c5\u51b5\u662f\u56e0\u4e3a\u6709 $10^5$ \u79cd\u7279\u5f81\uff0c\u6bcf\u4e00\u4f4d\u5355\u72ec\u505a\u65f6\u95f4\u590d\u6742\u5ea6\u65e0\u6cd5\u63a5\u53d7\uff0c\u4f46\u662f\u53d1\u73b0\u56e0\u4e3a\u521d\u59cb\u6570\u7ec4\u53ea\u6709 $12$ \u4e2a\u751f\u7269\uff0c\u6240\u4ee5\u5982\u679c\u7279\u5f81\u53ea\u6709 $0/1$ \u7684\u8bdd\u6700\u591a\u53ea\u6709 $2^{12}=4096$ \u79cd\u60c5\u51b5\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5e76\u4e0d\u662f\u4e0d\u80fd\u63a5\u53d7\uff0c\u800c\u4e14\u53ef\u4ee5\u7528 `bitset` \u7684 `&` \u548c `|` \u64cd\u4f5c\u52a0\u901f\uff0c\u6027\u8d28\u975e\u5e38\u4f18\u79c0\u3002\n\n\u8003\u8651\u5982\u4f55\u5c06 $10^9$ \u7684\u503c\u57df\u8f6c\u5316\u6210 $0/1$\uff0c\u8fd9\u53ef\u4ee5\u8bf4\u662f\u4e00\u4e2a\u7ecf\u5178\u5957\u8def\uff0c\u9996\u5148\u6211\u4eec\u53d1\u73b0\u56e0\u4e3a\u521d\u59cb\u53ea\u6709 $12$ \u4e2a\u503c\uff0c\u800c $\\min/\\max$ \u64cd\u4f5c\u4e0d\u4f1a\u4ea7\u751f\u65b0\u7684\u503c\uff0c\u6240\u4ee5\u503c\u6700\u591a\u53ea\u6709 $12$ \u79cd\uff0c\u5bf9\u4e8e\u5c06\u5927\u503c\u57df\u8f6c\u5316\u6210 $0/1$ \u4e00\u4e2a\u7ecf\u5178\u7684\u624b\u6bb5\u5728\u4e8c\u5206\u65f6\u7ecf\u5e38\u7528\u5230\uff0c\u5c31\u662f\u8bbe\u4e00\u4e2a\u9608\u503c $\\text{limit}$\uff0c\u5982\u679c\u4e00\u4e2a\u503c\u6bd4 $\\text{limit}$ \u5c0f\u5c31\u662f $0$\uff0c\u5426\u5219\u5c31\u662f $1$\uff0c\u8fd9\u91cc\u6211\u4eec\u4e5f\u53ef\u4ee5\u7167\u7528\uff0c\u6211\u4eec\u4e00\u5171\u6709 $12$ \u79cd\u9608\u503c\uff0c\u96be\u9053\u6bcf\u4e2a\u90fd\u7ef4\u62a4\u4e00\u904d\u5417\uff1f\u5b9e\u9645\u4e0a\u4e0d\u7528\u8fd9\u4e48\u9ebb\u70e6\u3002\u8003\u8651\u524d\u9762\u6211\u4eec\u53d1\u73b0\u4e00\u5171\u5c31 $4096$ \u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8bbe\u4efb\u610f\u4e00\u4e2a\u503c\u4e3a $0/1$ \u7684\u60c5\u51b5\uff0c\u5168\u90e8\u8bb0\u5f55\u4e0b\u6765\uff0c\u5373\u8bbe $f_{i,sta}$ \u8868\u793a $sta$ \u5bf9\u5e94\u7684\u6240\u6709\u4f4d\u7f6e\u7684\u503c\u90fd\u4e3a $1$ \u7684\u60c5\u51b5\u4e0b\u7b2c $i$ \u4e2a\u503c\u662f\u4ec0\u4e48\uff0c\u7136\u540e\u53d1\u73b0\u56e0\u4e3a $\\min/\\max$ \u64cd\u4f5c\u5bf9\u5e94 $\\operatorname{bitand}/\\operatorname{bitor}$\uff0c\u4e14\u5728\u751f\u6210 $i$ \u65f6\u8f6c\u79fb\u6bcf\u4e2a $sta$ \u64cd\u4f5c\u7684\u65b9\u6cd5\u662f\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528 `bitset` \u4f18\u5316\uff0c\u7136\u540e\u67e5\u8be2\u64cd\u4f5c\u76f4\u63a5\u4ece\u5927\u5230\u5c0f\u679a\u4e3e\u9608\u503c\u66f4\u65b0 $sta$ \u76f4\u5230\u7b54\u6848\u4e3a $f_{i,sta}=1$\uff0c\u521d\u59cb\u5316\u5c31\u662f $f_{i,sta}=[i\\subseteq sta]$\u3002\n\n[\u4ee3\u7801](https://codeforces.com/contest/878/submission/158359406)\u5e76\u6ca1\u6709\u60f3\u8c61\u4e2d\u90a3\u4e48\u96be\u3002",
        "postTime": 1653466851,
        "uid": 310525,
        "name": "\u8001\u83bd\u83bd\u7a7f\u4e00\u5207",
        "ccfLevel": 0,
        "title": "[CF878D] Magic Breeding \u9898\u89e3"
    },
    {
        "content": "### \u9898\u610f\n\n\u6709 $m$ \u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u521d\u59cb\u6570\u7ec4 $A_1,A_2...A_m$\uff0c\u548c$Q$ \u4e2a\u64cd\u4f5c\uff0c\u6bcf\u4e2a\u64cd\u4f5c\u4e3a\u4ee5\u4e0b $3$ \u4e2a\u64cd\u4f5c\u4e2d\u7684 $1$ \u4e2a\uff1a\n- $\\text{1 x y}$\uff1a\u65b0\u5efa\u4e00\u4e2a\u6570\u7ec4 $A_p$\uff0c\u4ee4 $A_{p,i}=\\max(A_{x,i},A_{y,i})$\u3002\n- $\\text{2 x y}$\uff1a\u65b0\u5efa\u4e00\u4e2a\u6570\u7ec4 $A_p$\uff0c\u4ee4 $A_{p,i}=\\min(A_{x,i},A_{y,i})$\u3002\n- $\\text{3 x y}$\uff1a\u67e5\u8be2\u6570\u7ec4 $A_x$ \u7684\u7b2c $y$ \u4e2a\u5143\u7d20\u3002\n\n$\\texttt{Data Range}:n,Q\\leq 10^5,m\\leq12$\n\n### \u9898\u89e3\n\n\u8003\u8651\u7ef4\u62a4\u90a3\u4e9b\u591a\u6b21\u64cd\u4f5c\u540e\uff0c\u53ef\u80fd\u6210\u4e3a\u6570\u7ec4 $x$ \u7b2c $y$ \u4e2a\u5143\u7d20\u6765\u6e90\u7684\u6570\u7ec4\uff0c\u8fd9\u4e00\u90e8\u5206\u663e\u7136\u53ef\u4ee5\u72b6\u6001\u538b\u7f29\u3002\u8bbe $f_{x,mask}$ \u4e3a\u662f\u5426\u5b58\u5728 $mask$ \u7684\u4e00\u4e2a\u5b50\u96c6 $S$\uff0c\u4ee4 $S$ \u80fd\u591f\u6210\u4e3a\u6570\u7ec4 $A_x$ \u6bcf\u4e2a\u5143\u7d20\u7684\u5168\u90e8\u6765\u6e90\u3002\n\n\u5219\u64cd\u4f5c $1$ \u53ea\u4f1a\u6269\u5927\u6765\u6e90\uff0c\u5f62\u5f0f\u5316\u7684\u8bf4\u5c31\u662f\u5bf9\u4e8e\u4e24\u4e2a\u53ef\u884c\u96c6\u5408\u53d6\u5e76\u3002\u64cd\u4f5c $2$ \u53ea\u4f1a\u7f29\u5c0f\u6765\u6e90\uff0c\u5f62\u5f0f\u5316\u7684\u8bf4\u5c31\u662f\u5bf9\u4e8e\u4e24\u4e2a\u53ef\u884c\u96c6\u5408\u53d6\u4ea4\u3002\u8fd9\u90e8\u5206\u4f7f\u7528 $\\text{bitset}$ \u7ef4\u62a4\u4e00\u4e0b\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(\\frac{2^mQ}{\\omega})$\u3002\n\n\u503c\u5f97\u6ce8\u610f\u7684\u662f\u5b9a\u4e49\u4e2d $mask$ \u662f\u4e2a\u8d85\u96c6\uff0c\u64cd\u4f5c $3$ \u4e2d\u6c42\u89e3\u65f6\u5c06\u6bcf\u4e2a\u521d\u59cb\u6570\u7ec4\u7b2c $y$ \u4e2a\u5143\u7d20\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\u4f9d\u6b21\u53d6\uff0c\u7b2c\u4e00\u6b21\u80fd\u591f\u53d6\u5230\u7684\u5c31\u662f\u6240\u6c42\u4e86\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(2^m(n+\\frac{Q}{\\omega})+Qm\\log n)$\u3002\n\n**Show the Code**\n\n```cpp\n#include<cstdio>\n#include<bitset>\n#include<vector>\n#include<algorithm>\nstd::bitset<1<<12> f[100005];   \nint a[15][100005];\ninline int read() {\n    register int x=0,f=1;register char s=getchar();\n    while(s>'9'||s<'0') {if(s=='-') f=-1;s=getchar();}\n    while(s>='0'&&s<='9') {x=x*10+s-'0';s=getchar();}\n    return x*f;\n}\nint main() {\n    int n=read(),m=read(),Q=read(),num=m-1;\n    for(register int i=0;i<m;++i) {\n        for(register int j=1;j<=n;++j) {\n            a[i][j]=read();\n        }\n    }\n    for(register int mask=1;mask<(1<<m);++mask) {\n        for(register int i=0;i<m;++i) {\n            if(mask>>i&1) f[i].set(mask);\n        }\n    }\n    while(Q--) {\n        int op=read(),x=read()-1,y=read();\n        if(op==1) f[++num]=f[x]|f[y-1];\n        else if(op==2) f[++num]=f[x]&f[y-1];\n        else {\n            std::vector<std::pair<int,int> > t;\n            for(register int i=0;i<m;++i) t.push_back(std::make_pair(-a[i][y],i));\n            std::sort(t.begin(),t.end());//from large to small\n            int mask=0;\n            for(register int i=0;i<m;++i) {\n                mask|=1<<t[i].second;\n                if(f[x][mask]) {printf(\"%d\\n\",-t[i].first);break;} \n            }\n        }\n    }\n    return 0;\n}\n```\n ",
        "postTime": 1612518808,
        "uid": 95244,
        "name": "tommymio",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF878D \u3010Magic Breeding\u3011"
    },
    {
        "content": "\u5b89\u5229\u4e2a\u4eba blog\uff1ahttps://www.cnblogs.com/ET2006/\n\n[\u9898\u9762\u4f20\u9001\u95e8](https://codeforces.ml/contest/878/problem/D)\n\n\u63d0\u4f9b\u4e00\u4e2a\u548c\u5176\u5b83\u9898\u89e3\u4e0d\u592a\u4e00\u6837\u7684\u7406\u89e3\u65b9\u5f0f\uff0c\u53ef\u80fd\u4f1a\u7a0d\u5fae\u597d\u7406\u89e3\u4e00\u4e9b\uff0c\u867d\u7136\u4ee3\u7801\u548c\u5176\u5b83\u9898\u89e3\u5927\u540c\u5c0f\u5f02\u3002\n\n\u5f88\u5bb9\u6613\u53d1\u73b0\u4e00\u4ef6\u4e8b\u60c5\uff0c\u90a3\u5c31\u662f\u6570\u7ec4\u7684\u6bcf\u4e00\u4f4d\u90fd\u662f\u72ec\u7acb\u7684\uff0c\u4f46\u7531\u4e8e\u8fd9\u9898\u6570\u7ec4\u957f\u5ea6 $n$ \u5f88\u5927\uff0c\u6211\u4eec\u4e0d\u80fd\u6bcf\u6b21\u4fee\u6539\u90fd\u679a\u4e3e\u6bcf\u4e00\u4f4d\u66f4\u65b0\u5176\u5bf9\u7b54\u6848\u7684\u8d21\u732e\uff0c\u8fd9\u6837\u590d\u6742\u5ea6\u5fc5\u70b8\u65e0\u7591\u3002\u4f46\u662f\u8fd9\u9898\u6709\u4e2a\u663e\u7136\u7684\u7a81\u7834\u53e3\uff0c\u90a3\u5c31\u662f $k$ \u7684\u53d6\u503c\u8303\u56f4\u5f88\u5c0f\uff0c\u6700\u9ad8\u53ea\u6709 $12$\uff0c\u4e5f\u5c31\u662f\u8bf4\u6bcf\u4e00\u4f4d\u7684\u53d6\u503c\u6700\u591a\u53ea\u6709 $12$ \u79cd\u53ef\u80fd\uff0c\u6211\u4eec\u8003\u8651\u4ee5\u6b64\u4e3a\u7a81\u7834\u53e3\uff0c\u8bbe\u8ba1\u4e00\u4e2a\u4e0e\u8fd9 $k$ \u4e2a\u6570\u7684\u5177\u4f53\u53d6\u503c\u65e0\u5173\u7684\u72b6\u6001\u3002\n\n\u9996\u5148\u6211\u4eec\u77e5\u9053\u6bcf\u4e00\u4f4d\u662f\u72ec\u7acb\u7684\uff0c\u6545\u6211\u4eec\u53ef\u4ee5\u628a\u6bcf\u4e00\u4f4d\u62c6\u5f00\u6765\u8003\u8651\uff0c\u4e8e\u662f\u95ee\u9898\u7531\u4e8c\u7ef4\u53d8\u6210\u4e00\u7ef4\uff1a\u7ed9\u5b9a $k$ \u4e2a\u6570 $a_1,a_2,\\dots,a_k$\uff0c$q$ \u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u64cd\u4f5c\u7ed9\u5b9a\u4e24\u4e2a\u6570 $i,j$\uff0c\u6709\u4e24\u79cd\u7c7b\u578b\uff0c\u8981\u4e48\u65b0\u5efa\u4e00\u4e2a\u6570 $a_n=\\max(a_i,a_j)$\uff0c\u8981\u4e48\u65b0\u5efa\u4e00\u4e2a\u6570 $a_n=\\min(a_i,a_j)$\u3002\n\n\u6211\u4eec\u5148\u6765\u770b\u4e00\u4e2a\u5f31\u5316\u7248\u672c\uff0c\u90a3\u5c31\u662f $\\forall a_i\\in [0,1]$\uff0c\u6211\u4eec\u8bbe\u8ba1\u4e00\u4e2a\u72b6\u6001 $f_{i,S}$\uff0c$f_{i,S}=1$ \u8868\u793a $\\forall j\\in S,a_j=1\\Rightarrow a_i=1$\uff0c\u4e5f\u5c31\u662f\u8bf4\u5982\u679c $S$ \u4e2d\u7684\u5143\u7d20\u90fd\u4e3a $1$ \u90a3\u4e48 $a_i$ \u5c31\u4e00\u5b9a\u4e3a $1$\uff0c\u5426\u5219\u4e0d\u80fd\u786e\u5b9a $a_i$ \u7a76\u7adf\u662f $1$ \u8fd8\u662f $0$\uff0c\u663e\u7136\u6700\u521d\u5bf9\u4e8e $i\\in[1,k]$\uff0c\u6ee1\u8db3 $i\\in S$ \u7684 $f_{i,S}$ \u90fd\u4e3a $1$\uff0c\u5176\u4f59\u7684 $f_{i,S}$ \u90fd\u4e3a $0$\u3002\n\n\u6211\u4eec\u8003\u8651\u65b0\u5efa\u4e00\u4e2a $a_n=\\max(a_i,a_j)$ \u4f1a\u9020\u6210\u4ec0\u4e48\u6837\u7684\u5f71\u54cd\uff0c\u5bf9\u4e8e\u96c6\u5408 $S$\uff0c\u5982\u679c $f_{i,S}=1\\lor f_{j,S}=1$\uff0c\u90a3\u4e48 $a_i,a_j$ \u4e2d\u4e00\u5b9a\u81f3\u5c11\u6709\u4e00\u4e2a\u4e3a $1$\uff0c\u6545 $a_n=\\max(a_i,a_j)$ \u4e00\u5b9a\u4e3a $1$\uff0c\u6545 $f_{n,S}=1$\u3002\u53cd\u4e4b\uff0c$f_{i,S}=f_{j,S}=0$\uff0c\u6211\u4eec\u5c31\u4e0d\u80fd\u786e\u5b9a $a_i,a_j$ \u7684\u503c\uff0c\u4e5f\u5c31\u662f\u8bf4\u6700\u574f\u60c5\u51b5\u4e0b\u4f1a\u51fa\u73b0 $a_i=a_j=0$ \u7684\u60c5\u51b5\uff0c\u6b64\u65f6 $a_n=0$\uff0c\u6545 $f_{n,S}=0$\u3002\u6545\u6211\u4eec\u6709 $f_n=f_i\\lor f_j$\u3002\u540c\u7406\u6211\u4eec\u4e5f\u53ef\u5c06\u53d6 $\\min$ \u7684\u60c5\u51b5\u4e0e $\\land$ \u8054\u7cfb\u5728\u4e00\u8d77\u3002\u81f3\u4e8e\u67e5\u8be2\u2026\u2026\u6bd4\u65b9\u8bf4\u6211\u4eec\u8981\u67e5\u8be2\u7b2c $x$ \u4e2a\u6570\u7ec4\u7b2c $y$ \u5217\u7684\u6570\uff0c\u6211\u4eec\u8bb0 $T=\\{i|a_{i,y}=1,i\\in [1,k]\\}$\uff0c\u5982\u679c $f_{x,T}=1$\uff0c\u6839\u636e $f$ \u6570\u7ec4\u7684\u5b9a\u4e49\u53ef\u77e5 $a_{x,y}=1$\uff0c\u53cd\u4e4b\uff0c\u6839\u636e $f$ \u6570\u7ec4\u7684\u5b9a\u4e49\u77e5\u5728\u5269\u4e0b\u6570\u4e71\u586b\u7684\u60c5\u51b5\u4e0b\uff0c\u6709\u53ef\u80fd\u51fa\u73b0 $a_x=0$ \u7684\u60c5\u51b5\uff0c\u800c\u663e\u7136\u5728\u201c$T$ \u4e4b\u5916\u7684\u6570\u4e71\u586b\u201d\u7684\u60c5\u51b5\u4e0b\uff0c\u8ba9 $a_x$ \u503c\u6700\u5c0f\u7684\u586b\u6cd5\u662f\u5176\u5b83\u6570\u5168\u586b $0$\uff0c\u800c\u6211\u4eec\u6709 $\\forall i\\notin T,a_{i,y}=0$\uff0c\u6545 $a_x=0$\u3002\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ea\u9700\u8f93\u51fa $f_{x,T}$ \u5373\u53ef\uff0c\u590d\u6742\u5ea6 $q2^k+2^k$\uff0c\u4f7f\u7528 `bitset` \u5373\u53ef\u4f18\u5316\u5230 $\\dfrac{q2^k}{w}+k2^k$\n\n\u73b0\u5728\u6211\u4eec\u8003\u8651\u5c06\u66f4\u4e00\u822c\u7684\u60c5\u51b5\u89c4\u7ea6\u5230\u7279\u6b8a\u60c5\u51b5\uff0c\u7531\u4e8e\u6bcf\u4e00\u4f4d\u662f\u72ec\u7acb\u7684\uff0c\u6211\u4eec\u8fd8\u662f\u5c06\u76ee\u5149\u805a\u7126\u5230\u67d0\u4e00\u7279\u5b9a\u7684\u5217\uff08\u5047\u8bbe\u4e3a\u7b2c $i$ \u5217\uff09\u4e0a\uff0c\u5bf9\u4e8e\u521d\u59cb $k$ \u4e2a\u6570\u7ec4\u7b2c $i$ \u5217\u4e0a\u7684\u6570\u6211\u4eec\u5c06\u5176\u4ece\u5927\u5230\u5c0f\u6392\u4e2a\u5e8f\uff0c\u8bbe\u6392\u597d\u5e8f\u7684\u6570\u7ec4\u4e3a $x_{1},x_2,\\dots,x_k$\uff0c\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e2a $a_{t,i}$\uff08\u5305\u62ec\u65b0\u5efa\u7684\u6570\u7ec4\uff09\u65b0\u5efa $k$ \u4e2a 0/1 \u53d8\u91cf $b_{t,1,i},b_{t,2,i},\\dots,b_{t,k,i}$\uff0c\u5176\u4e2d $b_{t,j,i}$ \u4e3a $1$ \u8868\u793a $a_{t,i}\\ge x_j$\uff0c\u53cd\u4e4b $a_{t,i}<x_j$\uff0c\u67e5\u8be2\u5c31\u4ece $1$ \u679a\u4e3e\u5230 $k$ \u76f4\u5230\u9047\u5230\u7b2c\u4e00\u4e2a $b_{x,i,y}=1$ \u5e76\u8f93\u51fa $x_i$ \u5373\u53ef\u3002\u663e\u7136\u8fd9\u4e2a\u5c0f\u5c0f\u7684\u4fee\u6539\u53ea\u4e0d\u8fc7\u662f\u5c06\u6570\u7ec4\u957f\u5ea6\u7531 $n$ \u53d8\u6210\u4e86 $nk$\uff0c\u5728\u5f31\u5316\u7248\u672c\u4e2d\u6211\u4eec $f$ \u6570\u7ec4\u7684\u5b9a\u4e49\u5373\u6c42\u89e3\u65b9\u6cd5\u7167\u6837\u4f7f\u7528\uff0c\u590d\u6742\u5ea6 $\\dfrac{q2^k}{w}+k^22^k$\uff0c\u6709\u70b9\u8111\u5b50\u5c31\u53ef\u4ee5\u4f18\u5316\u5230 $q2^k+k2^k$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi first\n#define se second\n#define fz(i,a,b) for(int i=a;i<=b;i++)\n#define fd(i,a,b) for(int i=a;i>=b;i--)\n#define ffe(it,v) for(__typeof(v.begin()) it=v.begin();it!=v.end();it++)\n#define fill0(a) memset(a,0,sizeof(a))\n#define fill1(a) memset(a,-1,sizeof(a))\n#define fillbig(a) memset(a,63,sizeof(a))\n#define pb push_back\n#define ppb pop_back\n#define mp make_pair\ntemplate<typename T1,typename T2> void chkmin(T1 &x,T2 y){if(x>y) x=y;}\ntemplate<typename T1,typename T2> void chkmax(T1 &x,T2 y){if(x<y) x=y;}\ntypedef pair<int,int> pii;\ntypedef long long ll;\nnamespace fastio{\n\t#define FILE_SIZE 1<<23\n\tchar rbuf[FILE_SIZE],*p1=rbuf,*p2=rbuf,wbuf[FILE_SIZE],*p3=wbuf;\n\tinline char getc(){return p1==p2&&(p2=(p1=rbuf)+fread(rbuf,1,FILE_SIZE,stdin),p1==p2)?-1:*p1++;}\n\tinline void putc(char x){(*p3++=x);}\n\ttemplate<typename T> void read(T &x){\n\t\tx=0;char c=getchar();T neg=0;\n\t\twhile(!isdigit(c)) neg|=!(c^'-'),c=getchar();\n\t\twhile(isdigit(c)) x=(x<<3)+(x<<1)+(c^48),c=getchar();\n\t\tif(neg) x=(~x)+1;\n\t}\n\ttemplate<typename T> void recursive_print(T x){if(!x) return;recursive_print(x/10);putc(x%10^48);}\n\ttemplate<typename T> void print(T x){if(!x) putc('0');if(x<0) putc('-'),x=~x+1;recursive_print(x);}\n\tvoid print_final(){fwrite(wbuf,1,p3-wbuf,stdout);}\n}\nconst int MAXK=12;\nconst int MAXS=1<<MAXK;\nconst int MAXN=1e5;\nint n,k,qu,cnt,a[MAXK+3][MAXN+5];\nbitset<MAXS+4> f[MAXN+MAXK+3];\npii ord[MAXN+5][MAXK+3];\nbool cmp(pii x,pii y){return a[x.fi][x.se]>a[y.fi][y.se];}\nint main(){\n\tscanf(\"%d%d%d\",&n,&k,&qu);cnt=k;\n\tfor(int i=1;i<=k;i++) for(int j=1;j<=n;j++) scanf(\"%d\",&a[i][j]);\n\tfor(int j=1;j<=n;j++) for(int i=1;i<=k;i++) ord[j][i]=mp(i,j);\n\tfor(int j=1;j<=n;j++) sort(ord[j]+1,ord[j]+k+1,cmp);\n\tfor(int i=1;i<=k;i++) for(int j=0;j<(1<<k);j++) if(j>>i-1&1) f[i][j]=1;\n\twhile(qu--){\n\t\tint opt,x,y;scanf(\"%d%d%d\",&opt,&x,&y);\n\t\tif(opt==1) f[++cnt]=f[x]|f[y];\n\t\telse if(opt==2) f[++cnt]=f[x]&f[y];\n\t\telse{\n\t\t\tint msk=0;\n\t\t\tfor(int i=1;i<=k;i++){\n\t\t\t\tmsk|=1<<ord[y][i].fi-1;\n\t\t\t\tif(f[x][msk]){\n\t\t\t\t\tprintf(\"%d\\n\",a[ord[y][i].fi][y]);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1613905307,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF878D\u3010Magic Breeding\u3011"
    },
    {
        "content": "\u6bcf\u4e00\u5217\u4e2d\u53ea\u6709$12$\u79cd\u53d6\u503c\uff0c\u628a\u5176\u6392\u5e8f\u4ee5\u540e\u5c06\u6700\u7ec8\u7b54\u6848\u62c6\u8d21\u732e\u3002\n\n\u5b9a\u4e49$val[i]$\u4e3a\u6392\u597d\u5e8f\u4ee5\u540e\u7684\u5dee\u5206\u6570\u7ec4\uff0c\u90a3\u4e48\u4e00\u5217\u7684\u7b54\u6848\u53ef\u4ee5\u8868\u793a\u4e3a\uff1a\n\n$$ans=\\sum^{i} [ans>=a[i]]*val[i]$$\n\n\u7528\u4e00\u4e2a$dp[mask]=[0,1]$\u8868\u793a\u5f53\u6ee1\u8db3\u5bf9\u4e8e\u6240\u6709$i \\in mask$,$j \\notin mask$\uff0c\u6709$a[i]>a[j]$\u65f6\uff0c$dp$\u503c\u4e3a$1$\u5219\u8868\u793a$ans \\in mask$\uff0c\u53cd\u4e4b\u5219$ans \\notin mask$\uff0c\u90a3\u4e48$ans$\u548c\u8fd9\u4e2a$12$\u4e2a\u5143\u7d20\u7684\u5173\u7cfb\u53ea\u6709$4096$\u79cd\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u6bcf\u4e00\u884c\u7ef4\u62a4\u4e00\u4e2a\u957f\u5ea6\u4e3a$4096$\u7684$01$\u4e32\uff0c\u5982\u679c\u662f\u53d6$max$\u5219\u662f\u53d6\u6216\uff0c\u53d6$min$\u5219\u662f\u53d6\u4ea4\u3002\n\n\u56e0\u4e3a\u6bcf\u4e2a\u5143\u7d20\u53ea\u6709$0,1$\uff0c\u6240\u4ee5\u53ef\u4ee5$bitset$\u4f18\u5316\u3002\n\n\u521d\u59cb\u7b2c$i$\u884c\u7684$dp[mask]=1$\u5f53\u4e14\u4ec5\u5f53$i \\in mask$\n\n\u6700\u540e\u7edf\u8ba1\u7b54\u6848\u7684\u65f6\u5019\uff0c\u5bf9\u8be5\u5217\u5143\u7d20\u4ece\u5c0f\u5230\u5927\u679a\u4e3e\uff0c\u4f9d\u6b21\u628a$mask$\u7684\u6bcf\u4e00\u4f4d\u4ece$1$\u6539\u5230$0$\uff0c\u5982\u679c$mask$\u4e3a$1$\uff0c\u5219$ans \\in mask$\uff0c\u4ee3\u8868$ans>=a[i]$\uff0c\u5176\u4e2d$i$\u662f$\\in mask$\u6240\u6709\u5143\u7d20\u4e2d\u7684\u6700\u5c0f\u503c\uff0c\u90a3\u4e48$ans$\u52a0\u4e0a\u4e4b\u524d\u6240\u8bf4\u7684\u5dee\u5206\u6570\u7ec4\u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6$O(\\frac{4096q}{\\omega})$\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=110020;\ntypedef pair<int,int> pii;\n#define mk make_pair\nstruct QU{\n    int opt,x,y;\n}Q[N];\nint n,k,q;\nbitset<4096> bit[N];\nint a[13][N]; pii b[13];\n \nint main()\n{\n    scanf(\"%d%d%d\",&n,&k,&q);\n    for(int i=1;i<=k;i++)\n        for(int j=1;j<=n;j++) scanf(\"%d\",&a[i][j]);\n    for(int i=1;i<=k;i++){\n        for(int j=0;j<(1<<k);j++)\n            bit[i][j]=((j>>(i-1))&1);\n    }\n    int tot=k;\n    for(int i=1;i<=q;i++){\n        scanf(\"%d%d%d\",&Q[i].opt,&Q[i].x,&Q[i].y);\n        if(Q[i].opt==1) bit[++tot]=bit[Q[i].x]|bit[Q[i].y];\n        else if(Q[i].opt==2) bit[++tot]=bit[Q[i].x]&bit[Q[i].y];\n        else{\n            for(int j=1;j<=k;j++) b[j]=mk(a[j][Q[i].y],j);\n            sort(b+1,b+k+1);\n            for(int j=k;j>=0;j--) b[j].first-=b[j-1].first;\n            int mask=(1<<k)-1,ans=0;\n            for(int j=1;j<=k;j++){\n                if(bit[Q[i].x][mask]) ans+=b[j].first;\n                mask^=(1<<(b[j].second-1)); \n            }\n            printf(\"%d\\n\",ans);\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1613743992,
        "uid": 69107,
        "name": "_tourist_",
        "ccfLevel": 0,
        "title": "CF878D Magic Breeding"
    }
]
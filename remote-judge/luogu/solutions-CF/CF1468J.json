[
    {
        "content": "\u5927\u81f4\u9898\u610f\uff1a\n\n\u7ed9\u4e00\u4e2a $n$ \u4e2a\u70b9\uff0c$m$ \u6761\u65e0\u5411\u5e26\u6743\u8fb9\u7684\u56fe\uff0c\u548c\u53c2\u6570 $k$\uff0c\u7b2c $i$ \u6761\u8fb9\u8fb9\u6743\u4e3a $s_i$\u3002\n\n\u73b0\u5728\u4f60\u8981\u4fdd\u7559 $(n-1)$ \u6761\u8fb9\uff0c\u9700\u6ee1\u8db3\u6784\u6210\u7684\u56fe\u662f\u68f5\u6811\uff0c\u63a5\u4e0b\u6765\u4f60\u53ef\u4ee5\u5bf9\u4efb\u610f\u8fb9\u505a\u82e5\u5e72\u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u64cd\u4f5c\u53ef\u4ee5\u628a\u4fdd\u7559\u7684\u8fb9\u7684\u8fb9\u6743\u589e\u52a0\u4e00\u6216\u51cf\u5c11\u4e00\uff0c\u6c42\u4fdd\u7559\u7684\u6240\u6709\u8fb9\u7684\u65b9\u6848\u4e2d\u4f7f\u8fb9\u6743\u6700\u5927\u503c**\u6b63\u597d\u662f $k$** \u7684\u6700\u5c0f\u64cd\u4f5c\u6570\u3002\n\n---\n\n\u9996\u5148\u5982\u679c\u4fdd\u7559\u7684\u8fb9\u6709\u4e00\u5806\u8fb9\u6ee1\u8db3 $s_i>k$\uff0c\u90a3\u4e48\u6700\u540e\u7edf\u8ba1\u65f6\u8fd8\u8981\u7528\u4e00\u5806\u64cd\u4f5c\u628a\u8fd9\u6761\u8fb9\u518d\u7ed9\u51cf\u5230\u4e0e $k$ \u76f8\u540c\uff0c\u56e0\u6b64\u4e00\u5f00\u59cb\u8981\u5148\u8fde\u6ee1\u8db3 $s_i\\leq k$ \u7684\u8fb9\u3002\n\n\u5982\u679c\u8fde\u5b8c\u6240\u6709\u6ee1\u8db3 $s_i\\leq k$ \u7684\u8fb9\uff0c\u53d1\u73b0\u56fe\u5df2\u7ecf\u6ee1\u8db3\u4efb\u610f\u4e24\u70b9\u4e92\u76f8\u53ef\u8fbe\uff0c\u8bf4\u660e\u8fd9\u5f20\u56fe\u53ef\u4ee5\u5728\u4e0d\u8fde\u63a5\u4efb\u4f55 $s_i>k$ \u7684\u8fb9\u5c31\u80fd\u751f\u6210\u6811\uff0c\u4f46\u662f\u6211\u4eec\u8981\u4f7f $\\max\\{s_i\\}=k$\uff0c\u56e0\u6b64\u8fd8\u8981\u8fde\u4e0a\u4e00\u6761\u4e0e $k$ \u5dee\u8ddd\u6700\u5c0f\u7684\u8fb9\uff0c\u6b64\u65f6\u7b54\u6848\u5c31\u662f $\\min_{i=1}^m\\{|s_i-k|\\}$\u3002\n\n\u5982\u679c\u8fde\u5b8c\u6240\u6709\u6ee1\u8db3 $s_i\\leq k$ \u7684\u8fb9\uff0c\u53d1\u73b0\u56fe\u8fd8\u4e0d\u6ee1\u8db3\u4efb\u610f\u4e24\u70b9\u4e92\u76f8\u53ef\u8fbe\uff0c\u90a3\u4e48\u5c31\u4e0d\u5f97\u4e0d\u8fde\u5165 $s_i>k$ \u7684\u8fb9\uff0c\u6b64\u65f6\u5c31\u6c42\u4e2a\u6700\u5c0f\u751f\u6210\u6811\uff0c\u8bbe\u751f\u6210\u6811\u7684\u8fb9\u96c6\u4e3a $E$\uff0c\u6b64\u65f6\u7b54\u6848\u5c31\u662f $\\sum_{i\\in E}\\max(s_i-k,0)$\u3002\n\n\u6ce8\u610f\u521d\u59cb\u5316\uff0c\u5f00 `long long`\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nconst int N=200020;\nint n,m,k,T,cnt=0,ans=0;\nint head[N],fa[N];\nstruct Save{int u,v,w;}d[N];//\u5b58\u8fb9\nbool cmp(Save a,Save b){return a.w<b.w;}//\u6bd4\u8f83\u8fb9\u7684\u6743\u503c\nstruct Edge{int p,next,v;}edge[N<<1];\nvoid add(int u,int v,int w){\n    cnt++;\n    edge[cnt]=(Edge){v,head[u],w};\n    head[u]=cnt;\n    return;\n}//\u94fe\u5f0f\u524d\u5411\u661f\u5b58\u56fe\nint find(int x){\n    if(fa[x]==x) return x;\n    return fa[x]=find(fa[x]);\n}\nvoid mg(int x,int y){\n    fa[find(x)]=find(y);\n    return;\n}//\u5e76\u67e5\u96c6\u6c42\u6700\u5c0f\u751f\u6210\u6811\nint meet=0;bool vis[N];\nbool fnd(int s){\n    queue<int>q;\n    q.push(s);\n    while(!q.empty()){\n        int cur=q.front();q.pop();\n        if(vis[cur]) continue;\n        meet++;\n        vis[cur]=1;\n        for(int i=head[cur];~i;i=edge[i].next) q.push(edge[i].p);\n    }\n    if(meet==n) return 1;\n    return 0;\n}//\u5224\u65ad\u56fe\u662f\u5426\u6ee1\u8db3\u4efb\u610f\u4e24\u70b9\u4e92\u76f8\u53ef\u8fbe\u3002\nint sav1,sav2,sav3;\nvoid init(){\n    memset(head,-1,sizeof(head));\n    for(int i=1;i<=n;i++) fa[i]=i;\n    cnt=0;\n}//\u521d\u59cb\u5316\nsigned main(){\n    int T;\n    cin>>T;\n    while(T){\n        ans=0;\n        T--;\n        cin>>n>>m>>k;\n        init();\n        for(int i=1;i<=m;i++) cin>>d[i].u>>d[i].v>>d[i].w;\n        sort(d+1,d+1+m,cmp);\n        for(int i=1;i<=m;i++){\n            if(d[i].w>k) break;\n            add(d[i].u,d[i].v,d[i].w);\n            add(d[i].v,d[i].u,d[i].w);\n        }\n        bool bb=fnd(1);\n        if(bb){\n            ans=1e16+20;\n            for(int i=1;i<=m;i++) ans=min(ans,abs(k-d[i].w));\n            cout<<ans<<endl;\n        }\n        else{\n            int st=n;\n            for(int i=1;i<=m;i++){\n                if(st==1) break;\n                if(find(d[i].u)==find(d[i].v)){continue;}\n                mg(d[i].u,d[i].v);\n                st--;\n                ans+=max((int)0,d[i].w-k);\n            }\n            cout<<ans<<endl;\n        }\n    }\n    return 0;\n}\n```\n\n",
        "postTime": 1609396309,
        "uid": 199139,
        "name": "devans",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1468J \u3010Road Reform\u3011"
    }
]
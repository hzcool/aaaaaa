[
    {
        "content": "### P.S.\n\u597d\u6b38\uff0c\u606d\u559c @Leap_Frog \u7ec4\u5408\u6570\u6c42\u9519\u8c03\u4e86\u4e00\u5e74\uff0c\u4e00\u5ea6\u4ee5\u4e3a\u81ea\u5df1\u5f0f\u5b50\u5047\u6389\u54af\uff01\uff01\uff01\uff01![](//xn--9zr.tk/xk)  \n**\u603b\u4e4b\u53cd\u6b63\u4eba\u5747\u65af\u7279\u6797\u6570\u5927\u5e08\uff0c\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e2a \u5f0f\u5b50+dp \u7684\u505a\u6cd5\u3002**  \n\n### Description.\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u4e3a $n\\ (n\\le 10^9)$ \u7684\u6392\u5217\uff0c\u521d\u59cb\u662f $\\{1,2,...,n\\}$\u3002  \n\u73b0\u5728\u8fdb\u884c $j$ \u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u53ef\u4ee5\u4ea4\u6362\u4efb\u610f\u4e24\u4e2a\u4e0d\u76f8\u540c\u7684\u6570\u3002  \n\u73b0\u5728\u8be2\u95ee\u53ef\u4ee5\u5f97\u5230\u51e0\u4e2a\u4e0d\u540c\u7684\u6392\u5217\uff0c\u9700\u8981\u5bf9 $j\\in[0,k]$ \u6c42\u51fa\u7b54\u6848\u3002$(k\\le200)$  \n\n### Solution.\n\u9996\u5148\uff0c\u8fd9\u91cc\u6709\u4e00\u4e2a naive \u7684 dp \u505a\u6cd5\uff08@Leap_Frog \u4f60\u4e2a\u5927\u61a8\u61a8\u8d5b\u573a\u4e0a\u6ca1\u60f3\u5230![](//xn--9zr.tk/jk)  \n\u8bbe $dp_{i,j}$ \u8868\u793a\u5f53\u524d\u6709 $i$ \u4e2a\u6570\uff0c\u7528 $j$ \u6b21\u64cd\u4f5c\u53ef\u4ee5\u5f97\u5230\u591a\u5c11\u4e2a\u672c\u8d28\u4e0d\u540c\u7684\u6392\u5217\u3002  \n\u8fd9\u4e2a\u770b\u4e0a\u53bb\u4f3c\u4e4e\u5f88\u96be\u8f6c\u79fb\uff0c\u4e8e\u662f\u6211\u4eec\u8bbe $dp_{i,j}$ \u8868\u793a\u5f53\u524d $i$ \u4e2a\u6570\uff0c\u4ece $\\{1,2,...,i\\}$ \u8f6c\u79fb\u8fc7\u6765\u7684\u6700\u5c0f\u6b21\u6570\u662f $j$\u3002  \n\u548c\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u7684\u8f6c\u79fb\u7c7b\u4f3c\uff0c\u4e0d\u80fd\u8003\u8651\u65b0\u6765\u4e00\u4e2a\u64cd\u4f5c\u4f1a\u600e\u4e48\u6837\u3002  \n\u8003\u8651\u6700\u540e\u4e00\u4e2a\u6570\uff0c\u5982\u679c\u6ca1\u6709\u4f4d\u79fb\uff0c\u90a3\u7b54\u6848\u5c31\u662f $dp_{i-1,j}$\u3002  \n\u5426\u5219\uff0c\u64cd\u4f5c\u6b21\u6570\u4f1a\u591a\u4e00\u6b21\uff0c\u53ef\u4ee5\u79fb\u52a8\u5230\u4efb\u610f\u4e00\u4e2a\u6570\u540e\u9762\uff0c\u7b54\u6848\u5c31\u662f $dp_{i-1,j-1}\\times(i-1)$\u3002  \n$$\\therefore dp_{i,j}=dp_{i-1,j}+(i-1)\\times dp_{i-1,j-1}$$  \n\u5f53\u7136\uff0c\u56e0\u4e3a\u8fd9\u662f\u6700\u5c0f\u6b21\u6570\u7b49\u4e8e $j$\uff0c\u89c2\u5bdf \u6837\u4f8bI \u53ef\u4ee5\u53d1\u73b0\u53ef\u4ee5\u6d6a\u8d39\u6b65\u6570\u3002  \n$$\\therefore ans_j=\\sum_{i\\equiv j\\pmod2\\land i\\le j}dp_{n,j}$$\n\u590d\u6742\u5ea6 $O(n\\times k)$\uff0c\u548c $n$ \u76f8\u5173\uff0c\u65e0\u6cd5\u901a\u8fc7\u6b64\u9898\u3002  \n\u7ec8\u4e8e\u627e\u5230\u4e00\u4e2a\u6b63\u786e\u505a\u6cd5\u4e86 ![](//xn--9zr.tk/ll)\uff0c\u4f46\u770b\u4e0a\u53bb\u5f88\u6ca1\u6709\u524d\u9014\u7684\u6837\u5b50\u3002  \n\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c\u4ec5\u505a $k$ \u6b21\u64cd\u4f5c\uff0c\u90a3\u88ab\u6d89\u53ca\u5230\u7684\u6570\u81f3\u591a\u53ef\u80fd\u6709 $2k$ \u4e2a\uff0c\u800c $k$ \u5f88\u5c0f\u3002  \n\u6211\u4eec\u8003\u8651\u679a\u4e3e\u5f53\u524d\u6709 $i$ \u4e2a\u6570\u88ab\u4ea4\u6362\u64cd\u4f5c\u6d89\u53ca\u5230\u4e86\uff0c\u8bbe\u5f53\u524d\u679a\u4e3e\u5230\u7684\u6b21\u6570\u662f $j$  \n\u6211\u4eec\u9996\u5148\u9700\u8981\u9009\u51fa $i$ \u4e2a\u6570\uff0c\u6709 $\\dbinom ni$ \u8d21\u732e\uff0c\u7136\u540e\u518d\u5bf9\u5b83\u4eec\u4e71\u6392\uff0c\u6709 $dp_{i,j}$  \n\u6240\u4ee5\u5f53\u524d\u7b54\u6848\u5c31\u662f $\\dbinom ni\\times dp_{i,j}$\u3002  \n\u597d\u6b38\uff01\u6211\u4eec\u627e\u5230\u4e86\u4e2a\u770b\u8d77\u6765\u5f88\u771f\u7684\u5f0f\u5b50\u6b38\uff01\u800c\u4e14\u8fd8\u662f $O(n^2)$ \u7684\u662f\u4e0d\u662f\u78be\u6807\u4e86\u554a![](//xn--9zr.tk/se)  \n\u53ef\u60dc\uff0c\u4f60\u7684\u505a\u6cd5\u5047\u6389\u4e86\u54af\uff01  \n\u8fd9\u6837\u7edf\u8ba1\u662f\u4f1a\u6709\u91cd\u590d\u7684\uff0c\u6bd4\u5982 $\\{1,2,3\\}$ \u53d8\u6210 $\\{2,1,3\\}$\uff0c\u4f1a\u5728 $i=2$ \u65f6\u7edf\u8ba1\u4e00\u6b21\uff0c$i=3$ \u65f6\u7edf\u8ba1\u4e00\u6b21\u3002  \n\u8003\u8651\u91cd\u590d\u53d1\u751f\u7684\u672c\u8d28\u662f\u4ec0\u4e48\uff0c\u662f\u56e0\u4e3a $dp_{i,j}$ \u5e76\u6ca1\u6709\u9650\u5236 $i$ \u4e2a\u6570\u90fd\u9700\u8981\u53d8\uff0c\u8fd9\u6837\u5728 $i+1$ \u65f6\u53ef\u80fd\u91cd\u590d\u3002  \n\u5982\u679c\u60f3\u53bb\u6389\u91cd\u590d\uff0c\u5728 $dp$ \u8fc7\u7a0b\u4e2d\u57fa\u672c\u662f\u4e0d\u53ef\u80fd\u4e86\u3002  \n\u6211\u4eec\u8bbe $g_{i,j}(k)$ \u8868\u793a\u6070\u597d\u6709 $k$ \u4e2a\u4e0d\u53d8\u7684\u65b9\u6848\u6570\uff0c$f_{i,j}(k)$ \u4e3a\u94a6\u5b9a $k$ \u4e2a\u4e0d\u53d8\u5176\u4ed6\u4efb\u610f\u7684\u65b9\u6848\u6570\u3002  \n\uff08\u8fd9\u91cc $i,j$ \u610f\u4e49\u548c\u4e0a\u6587\u4e00\u6837\u3002  \n$$\\therefore f_{i,j}(k)=dp_{i-k,j}$$\n**\u6ce8\u610f\u8fd9\u8fb9\u6ca1\u6709\u7ec4\u5408\u6570\u56e0\u4e3a $dp$ \u5185\u90e8\u5df2\u7ecf\u5305\u542b\u7ec4\u5408\u6570\u4e86\u3002**  \n~~\u4e0d\u4f1a\u771f\u6709 nt xtw \u5728\u8fd9\u4e2a\u95ee\u9898\u4e0a\u770b\u4e86\u81f3\u5c11 30min \u6ca1\u770b\u51fa\u6765\u5427\u4e0d\u4f1a\u5427\u4e0d\u4f1a\u5427~~  \n\u540c\u65f6\u6709 $f_{i,j}(k)=\\sum_{l=k}^{i}\\dbinom il\\times g_{i,j}(l)$  \n\u663e\u7136\u4e8c\u9879\u5f0f\u53cd\u6f14\uff0c\u53cd\u6f14\u4e00\u4e0b\u5c31\u5f97\u5230\u4e86\u3002  \n$$g_{i,j}(k)=\\sum_{l=k}^i(-1)^{l-k}\\times\\dbinom il\\times f_{i,j}(l)$$\n\u6211\u4eec\u9700\u8981\u6c42 $g_{i,j}(0)$\uff0c\u5e26\u5165\u53d1\u73b0\u4e3a\u3002  \n$$g_{i,j}(0)=\\sum_{l=0}^i(-1)^l\\times\\dbinom il\\times dp_{i-l,j}$$\n\u7136\u540e\uff0c\u76f4\u63a5 $O(i)$ \u66b4\u529b\u53cd\u6f14\u5373\u53ef\u3002  \n\u590d\u6742\u5ea6 $O(k^3)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002  \n\n### Coding.\n```cpp\n//\u662f\u554a\u2026\u2026\u4f60\u5c31\u662f\u90a3\u53ea\u9b3c\u4e86\u2026\u2026\u6240\u4ee5\u88ab\u4f60\u78b0\u5230\u4ee5\u540e\uff0c\u5c31\u8f6e\u5230\u6211\u53d8\u6210\u9b3c\u4e86{{{\n#include<bits/stdc++.h>\nusing namespace std;typedef long long ll;\ntemplate<typename T>inline void read(T &x)\n{\n\tx=0;char c=getchar(),f=0;\n\tfor(;c<'0'||c>'9';c=getchar()) if(c=='-') f=1;\n\tfor(;c>='0'&&c<='9';c=getchar()) x=(x<<1)+(x<<3)+(c^48);\n\tif(f) x=-x;\n}/*}}}*/\nconst int P=1e9+7;int n,K,fc[405],fi[405],iv[405],dp[405][405];\ninline int ksm(int x,int q=P-2) {int r=1;for(;q;q>>=1,x=1ll*x*x%P) if(q&1) r=1ll*r*x%P;return r;}\ninline int C(int n,int m)\n{\n\tif(n<0||m<0||n<m) return 0;else if(n<=400) return 1ll*fc[n]*fi[m]%P*fi[n-m]%P;\n\tint r=1;for(int i=1;i<=m;i++) r=1ll*r*iv[i]%P*(n-i+1)%P;return r;\n}\ninline void pinit(int n)\n{\n\tfc[0]=1;for(int i=1;i<=n;i++) fc[i]=1ll*fc[i-1]*i%P;\n\tiv[1]=1;for(int i=2;i<=n;i++) iv[i]=1ll*iv[P%i]*(P-P/i)%P;\n\tfi[0]=1;for(int i=1;i<=n;i++) fi[i]=1ll*fi[i-1]*iv[i]%P;\n}\nint main()\n{\n\tread(n),read(K),pinit(400);for(int i=1;i<=400;i++) dp[i][0]=1;\n\tfor(int i=1;i<=400;i++) for(int j=1;j<=400;j++) dp[i][j]=(dp[i-1][j]+1ll*(i-1)*dp[i-1][j-1])%P;\n\tint rs[2]={1,0};for(int j=1;j<=K;printf(\"%d%c\",rs[j&1],j==K?'\\n':' '),j++)\n\t{\n\t\tfor(int i=1,e=min(j<<1,n),g=0;i<=e;i++,g=0)\n\t\t{\n\t\t\tfor(int l=0;l<=i;l++) g=(g+1ll*((l&1)?P-1:1)*C(i,l)%P*dp[i-l][j])%P;\n\t\t\trs[j&1]+=1ll*C(n,i)*g%P,rs[j&1]>=P?rs[j&1]-=P:0;\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1619053294,
        "uid": 44805,
        "name": "Leap_Frog",
        "ccfLevel": 7,
        "title": "CF1516E Baby Ehab Plays with Permutations\uff08\u9898\u89e3\uff09"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u4e2a\u4e0d\u9700\u8981\u8111\u5b50\u7684\u505a\u6cd5\n\n## \u9898\u610f:\n\n$1,2,\\cdots,n$ \u7684\u6392\u5217 \u5b9a\u4e49 $f(i)$ \u8868\u793a\u505a\u6070\u597d $i$ \u6b21\u64cd\u4f5c \u6bcf\u6b21\u64cd\u4f5c\u4ea4\u6362\u4e24\u4e2a\u6570 \u80fd\u5f97\u5230\u7684\u672c\u8d28\u4e0d\u540c\u7684\u6392\u5217\u6570\u91cf\n\n\u5bf9\u4e8e $1,2,\\cdots,k$ \u6c42 $f(i)$\n\n## solution\n\n\u8003\u8651\u4f60\u901a\u8fc7\u4e24\u6b21\u4ea4\u6362 \u53ef\u4ee5\u628a\u4e00\u4e2a\u5e8f\u5217\u4ece $i-2$ \u53d8\u6210 $i$ \u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5dee\u5206 \u5373\u8bbe $g(i)$ \u8868\u793a\u81f3\u5c11\u9700\u8981 $i$ \u6b21\u64cd\u4f5c\u624d\u80fd\u5f62\u6210\u7684\u5e8f\u5217\u6570\u91cf\n\n\u8003\u8651\u53cd\u8fc7\u6765\u60f3 \u4e5f\u5c31\u662f\u95ee\u591a\u5c11\u4e2a\u6392\u5217\u81f3\u5c11\u9700\u8981 $i$ \u6b21\u4ea4\u6362\u53ef\u4ee5\u53d8\u6210\u9012\u589e\u7684\n\n\u6211\u4eec\u6709\u4e00\u4e2a\u7ed3\u8bba \u5bf9\u4e8e\u4e00\u4e2a\u6392\u5217 \u4ea4\u6362\u4e24\u4e2a\u6570\u8ba9\u4ed6\u4eec\u53d8\u6210\u6709\u5e8f\u7684\u6700\u5c11\u6b21\u6570\u662f $n-x$ \u5176\u4e2d $x$ \u662f\u6392\u5217\u7684\u73af\u6570\u91cf\n\n\u90a3\u4e48\u663e\u7136\u7684\u662f $g(i)=\\left[n\\atop n - i\\right]$\n\n\u7531\u4e8e $n$ \u5f88\u5927 \u6240\u4ee5\u6211\u4eec\u53c8\u60f3\u8d77\u7b2c\u4e8c\u4e2a\u5f0f\u5b50:\n$$\n\\left[n\\atop n - i\\right]=\\sum_{j=0}^i\\left<\\left<i\\atop j\\right>\\right>{n + j\\choose 2i}\n$$\n\u76f4\u63a5 $\\mathcal O(n^2)$ \u9012\u63a8 \u7b2c\u4e8c\u7c7b\u6b27\u62c9\u6570 \u5c31\u53ef\u4ee5\u4e86 \n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\n#define N 405\nusing namespace std;\n\nconst int mod = 1e9 + 7;\nint n,k,f[N][N],ans[N];\n\nint ksm(int a,int b,int mod = mod)\n{\n\tint res = 1;\n\twhile (b)\n\t{\n\t\tif (b & 1) res = res * a % mod;\n\t\ta = a * a % mod;\n\t\tb >>= 1;\n\t}\n\treturn res;\n}\n\nint C(int n,int m)\n{\n\tint ans = 1;\n\tfor (int i = 1; i <= m; i++)\n\t\tans = ans * (n - i + 1) % mod * ksm(i,mod - 2) % mod;\n\treturn ans;\n}\n\nint clac(int n,int k)\n{\n\tint ans = 0;\n\tfor (int i = 0; i <= k; i++)\n\t\tans = (ans + f[k][i] * C(n + i,2 * k)) % mod;\n\treturn ans;\n}\n\nsigned main()\n{\n\tscanf(\"%lld%lld\",&n,&k);\n\tf[0][0] = 1;\n\tfor (int i = 1; i <= k; i++)\n\t{\n\t\tf[i][0] = 1;\n\t\tfor (int j = 1; j <= i; j++)\n\t\t\tf[i][j] = ((2 * i - j - 1) * f[i - 1][j - 1] + (j + 1) * f[i - 1][j]) % mod;\n\t}\n\tans[0] = 1;\n\tfor (int i = 1; i <= k; i++) ans[i] = clac(n,i);\n\tfor (int i = 2; i <= k; i++) ans[i] = (ans[i] + ans[i - 2]) % mod;\n\tfor (int i = 1; i <= k; i++) printf(\"%lld \",ans[i]);\n\tputs(\"\");\n\treturn 0;\n}\n```",
        "postTime": 1619173779,
        "uid": 68030,
        "name": "serverkiller",
        "ccfLevel": 0,
        "title": "CF1516E \u9898\u89e3"
    },
    {
        "content": "\u8003\u8651\u53cd\u7740\u601d\u8003\uff0c\u8bbe $f_{i,j}$ \u8868\u793a\u957f\u5ea6\u4e3a $i$ \u7684\u6240\u6709\u6392\u5217\u4e2d\uff0c\u6700\u5c11\u9700\u8981\u4ea4\u6362 $j$ \u6b21\u53ef\u4ee5\u5f97\u5230\u539f\u6392\u5217\uff08$p_i=i$\uff09\u7684\u6392\u5217\u6570\uff0c\u72b6\u6001\u8f6c\u79fb\u7684\u65f6\u5019\u53ef\u4ee5\u8003\u8651\u5bf9 $p_i$ \u5206\u7c7b\u8ba8\u8bba\uff0c\u5982\u679c $p_i=i$\uff0c\u90a3\u4e48\u4e0d\u7528\u7ba1\u5b83\uff0c$f_{i,j}=f_{i-1,j}$\uff0c\u5426\u5219\uff0c\u5bf9\u4e8e $p_i = 1 \\dots (n-1)$ \u7684\u60c5\u51b5\uff0c\u9700\u8981\u628a $p_i$ \u548c\u524d\u9762\u7684\u6570\u8fdb\u884c\u4e00\u6b21\u4ea4\u6362\uff0c\u6709 $f_{i,j}=(i-1) \\times f_{i-1,j-1}$\uff0c\u603b\u7684\u6765\u8bf4\uff0c\u5f97\u5230 $f_{i,j}=f_{i-1,j}+(i-1)\\times f_{i-1,j-1}$\uff0c\u4e00\u5f00\u59cb\u6240\u6709\u7684 $f_{i,0}=1$\u3002\u56e0\u4e3a\u8fd9\u53ea\u662f\u6700\u5c11\u9700\u8981\u7684\u4ea4\u6362\u6b21\u6570\uff0c\u90a3\u4e48\u4ea4\u6362 $i$ \u6b21\u7684\u7b54\u6848\u5c31\u662f $f_{n,i}+f_{n,i-2}+ \\dots$\u3002\u770b\u4e0a\u53bb\u975e\u5e38\u6b63\u786e\uff0c\u53ea\u53ef\u60dc\u65f6\u95f4\u590d\u6742\u5ea6 $O(n \\times k)$\uff0c\u8fc7\u4e0d\u53bb\u3002\n\n\u6ce8\u610f\u5230\uff0c\u56e0\u4e3a\u6700\u591a\u4ea4\u6362 $k$ \u6b21\uff0c\u90a3\u4e48\u6700\u591a\u6709 $2k$ \u7684\u6570\u4f4d\u7f6e\u4f1a\u53d8\u5316\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u7740\u4ece\u8fd9\u91cc\u5165\u624b\u3002\u4e00\u4e2a\u5f88 naive \u7684\u60f3\u6cd5\u662f\u679a\u4e3e\u6709 $i$ \u4e2a\u4f4d\u7f6e\u53d8\u5316\uff0c\u4f46\u662f\u8fd9\u6837\u5b50\u505a\u4f1a\u7b97\u91cd\u3002\u53ef\u4ee5\u5c1d\u8bd5\u7740\u8bbe $g_{i,j}$ \u8868\u793a\u957f\u5ea6\u4e3a $i$ \u7684\u6240\u6709\u6392\u5217\u4e2d\uff0c\u6ee1\u8db3 $p_l \\ne l$\uff0c\u9700\u8981 $j$ \u6b21\u4ea4\u6362\u7684\u7b54\u6848\uff0c\u90a3\u4e48\u4ea4\u6362 $x$ \u6b21\u7684\u7b54\u6848\u5c31\u662f $\\displaystyle \\sum_{i=0}^{\\min(n,2\\times x)}(\\dbinom{n}{i} \\times  \\sum_{j=0}^{\\frac x 2 } g_{i,x-2\\times j})$\u3002\u8fd9\u6837\u5c31\u4e0d\u4f1a\u7b97\u91cd\u4e86\u3002\n\n\u7136\u800c\u600e\u4e48\u7b97\u51fa $g_{i,j}$ \u5462\uff1f\u53ef\u4ee5\u8003\u8651\u5728\u539f\u6765\u7b97\u51fa\u6765\u7684 $f_{i,j}$ \u4e0a\u505a\u5bb9\u65a5\u3002\u6839\u636e\u5bb9\u65a5\u5b9a\u7406\u5c31\u5f88\u5bb9\u6613\u5f97\u5230\uff1a$\\displaystyle g_{i,j}= \\sum_{x=0}^i (-1)^x \\times f_{i-x,j} \\times \\dbinom{i}{x}$\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5 $O(k^3)$ \u8ba1\u7b97\u51fa $g$ \u7136\u540e\u5f97\u51fa\u7b54\u6848\u4e86\u3002\n\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define pb push_back\n#define WT int T=read();while(T--) \n#define NO puts(\"NO\");\n#define YES puts(\"YES\");\nusing namespace std;\n\ninline int read()\n{\n    char c=getchar();int x=0;bool f=0;\n    for(;!isdigit(c);c=getchar())f^=!(c^45);\n    for(;isdigit(c);c=getchar())x=(x<<1)+(x<<3)+(c^48);\n    if(f)x=-x;return x;\n}\n\nconst int Mod=1e9+7;\nconst int M=410;\nint n,k,f[M][M],g[M][M],fac1[M],ifac[M],fac2[M];\n\nint C(int k){return fac2[k]*ifac[k]%Mod;}\nint C(int m,int n){return fac1[m]*ifac[n]%Mod*ifac[m-n]%Mod;}\n\nint poww(int a,int b)\n{\n\tint res=1;\n\twhile(b)\n\t{\n\t\tif (b&1)res=res*a%Mod;\n\t\ta=a*a%Mod,b>>=1;\n\t}return res;\n}\n\nvoid init(int n,int k)\n{\n\tfac1[0]=ifac[0]=1,fac2[0]=1;\n\tfor (int i=1;i<=min(n,2*k);i++)\n\t\tfac1[i]=fac1[i-1]*i%Mod,\n\t\tifac[i]=poww(fac1[i],Mod-2),\n\t\tfac2[i]=fac2[i-1]*(n-i+1)%Mod;\n}\n\nsigned main()\n{\n\tn=read(),k=read();init(n,k);f[0][0]=1;\n\tfor (int i=1;i<=min(n,2*k);i++)\n\t{\n\t\tf[i][0]=1;\n\t\tfor (int j=1;j<=min(2*k,n);j++)\n\t\t\tf[i][j]=(f[i-1][j]+f[i-1][j-1]*(i-1))%Mod;\n\t}\n\tfor (int i=0;i<=min(n,2*k);i++)\n\t\tfor (int j=0;j<=k;j++)\n\t\t\tfor (int ff=0;ff<=i;ff++)\n\t\t\t\tg[i][j]=(g[i][j]+((ff&1)?-1:1)*f[i-ff][j]*C(i,ff))%Mod;\n//\tfor (int i=0;i<=n;i++)\n//\t\tfor (int j=0;j<=n;j++)\n//\t\t\tcout<<i<<' '<<j<<' '<<g[i][j]<<endl;\n\tfor (int i=1;i<=k;i++)\n\t{\n\t\tint ans=0;\n\t\tfor (int j=min(2*i,n);j>=0;j--)\n\t\t{\n\t\t\tint sum=0;\n\t\t\tfor (int p=i;p>=0;p-=2)\n\t\t\t\tsum=(sum+g[j][p])%Mod;\n\t\t\tsum=sum*C(j)%Mod;ans=(ans+sum)%Mod;\n\t\t}\n\t\tans=(ans+Mod)%Mod;\n\t\tcout<<ans<<' ';\n\t}\n\treturn 0;\n}\n// 2 3\n```",
        "postTime": 1619398721,
        "uid": 141179,
        "name": "pigstd",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1516E Baby Ehab Plays with Permutations"
    },
    {
        "content": "[CF1516E Baby Ehab Plays with Permutations](https://www.luogu.com.cn/problem/CF1516E)\n\n\u53d1\u73b0\u4ea4\u6362 $k$ \u6b21\u610f\u5473\u7740\u81f3\u5c11 $n-k$ \u4e2a\u5faa\u73af\u3002\n\n\u4ea4\u6362\u6b21\u6570\u8fd8\u8981\u548c n-\u5faa\u73af\u6570 $\\bmod 2$ \u540c\u4f59\uff0c\u56e0\u4e3a\u6bcf\u4ea4\u6362\u4e00\u6b21\u8981\u4e48\u5faa\u73af\u6570\u5c11\u4e00\u4e2a\uff0c\u8981\u4e48\u591a\u4e00\u4e2a\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u6ee1\u8db3\u4ee5\u4e0a\u4e24\u4e2a\u6761\u4ef6\u7684\u6392\u5217\u4e00\u5b9a\u53ef\u4ee5\u5f97\u5230\u3002\n\n\u4e8e\u662f\u901a\u8fc7\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u6765\u7edf\u8ba1\uff0c\u7b54\u6848\u5c31\u662f\n$$\nans_k=\\sum_{i=n-k}^{n}[i\\bmod 2 = (n-k)\\bmod 2]S_1(n,i)\n$$\n$S_1$ \u5c31\u662f\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\u8981\u6c42\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u7684\u540e $k$ \u9879\u3002\n\n\u4f17\u6240\u5468\u77e5 \n$$\nx^{\\overline{n}}=\\prod_{i=0}^{n-1}(x+i)=\\sum_{i=0}^{n}\\begin{bmatrix}n\\\\i\\end{bmatrix}x^i\n$$\n\u5982\u679c\u628a\u5e38\u6570 $i$ \u4e58\u5230 $x$ \u4e0a\uff0c\u6211\u4eec\u5c31\u53ea\u9700\u8981\u63d0\u53d6\u524d $k$ \u9879\uff0c\u65b9\u4fbf\u8bb8\u591a\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u8f6c\u800c\u8ba1\u7b97\n$$\n\\prod_{i=0}^{n}(1+ix)\n$$\n\u524d $k$ \u9879\u3002\n$$\nf(x)=\\prod_{i=0}^{n-1}(1+ix)\n$$\n\u5957\u8def\u53d6 $\\ln$ \u518d $\\exp$ \n$$\n\\ln f(x)=\\sum_{i=0}^{n-1}\\ln (1+ix)\n$$\n$$\n=\\sum_{i=0}^{n-1}-\\sum_{j=1}^{k}\\dfrac{(-i)^jx^j}{j}\n$$\n$$\n=\\sum_{j=1}^{k}\\dfrac{(-1)^{j+1}x^j}{j}\\sum_{i=0}^{n-1}i^j\n$$\n\u540e\u9762\u662f\u81ea\u7136\u6570\u5e42\u548c\u524d\u7f00\u548c\u3002\n\n\u53ef\u4ee5\u6784\u9020 EGF \u6765\u8ba1\u7b97\uff1a\n$$\n\\sum_{j=0}^{n-1}\\sum_{i=0}^{n-1}i^j\\dfrac{x^j}{j!}\n=\\sum_{j=0}^{n-1}e^{ix}=\\dfrac{1-e^{nx}}{1-e^x}\n$$\n\u6ce8\u610f\u5206\u6bcd\u5e38\u6570\u9879\u4e3a $0$\uff0c\u8981\u4e0a\u4e0b\u540c\u65f6\u9664\u4ee5 $x$ \u518d\u8ba1\u7b97\u3002\n\n\u5982\u679c\u6362\u6210 MTT \u53ef\u4ee5 $O(k\\log k)$\uff0c\u4f46\u662f\u8fd9\u4e48\u5c0f\u6570\u636e\u8303\u56f4\u4e0d\u662f\u5f88\u5212\u7b97\u3002\u4e8e\u662f\u6211\u53bb\u8865\u4e86\u5957 $O(n^2)$ \u7684\u5168\u5bb6\u6876qwq\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define fi first\n#define se second\n#define mkp make_pair\n#define pb push_back\n#define sz(v) (int)(v).size()\ntypedef long long LL;\ntypedef double db;\ntemplate<class T>bool ckmax(T&x,T y){return x<y?x=y,1:0;}\ntemplate<class T>bool ckmin(T&x,T y){return x>y?x=y,1:0;}\n#define rep(i,x,y) for(int i=x,i##end=y;i<=i##end;++i)\n#define per(i,x,y) for(int i=x,i##end=y;i>=i##end;--i)\ninline int read(){\n\tint x=0,f=1;char ch=getchar();\n\twhile(!isdigit(ch)){if(ch=='-')f=0;ch=getchar();}\n\twhile(isdigit(ch))x=x*10+ch-'0',ch=getchar();\n\treturn f?x:-x;\n}\nconst int N = 205;\n\nnamespace poly {\n#define mod 1000000007\ninline int qpow(int n, int k) {\n\tint res = 1;\n\tfor(; k; k >>= 1, n = 1ll * n * n % mod)\n\t\tif(k & 1) res = 1ll * n * res % mod;\n\treturn res; \n}\nint inv[N], fac[N], ifc[N];\ninline void init(const int &n = N - 1) {\n\tinv[1] = 1;\n\tfor(int i = 2; i <= n; ++i) inv[i] = 1ll * inv[mod % i] * (mod - mod / i) % mod;\n\tfac[0] = 1;\n\tfor(int i = 1; i <= n; ++i) fac[i] = 1ll * i * fac[i - 1] % mod;\n\tifc[n] = qpow(fac[n], mod - 2);\n\tfor(int i = n - 1; i >= 0; --i) ifc[i] = 1ll * ifc[i + 1] * (i + 1) % mod;\n}\nvector <int> operator * (const vector <int> &a, const vector <int> &b) {\n\tint n = a.size(), m = b.size();\n\tvector <int> res(n + m - 1, 0);\n\tfor(int i = 0 ; i < n; ++i)\n\t\tfor(int j = 0; j < m; ++j)\n\t\t\tres[i + j] = (res[i + j] + 1ll * a[i] * b[j]) % mod;\n\treturn res;\n}\nvector <int> poly_inv(const vector <int> &a) {\n\tint n = a.size();\n\tvector <int> res(n);\n\tres[0] = qpow(a[0], mod - 2);\n\tfor(int i = 1; i < n; ++i) {\n\t\tint tmp = 0;\n\t\tfor(int j = 0; j < i; ++j)\n\t\t\ttmp = (tmp + 1ll * res[j] * a[i - j]) % mod;\n\t\tres[i] = 1ll * qpow(a[0], mod - 2) * (mod - tmp) % mod;\n\t}\n\treturn res;\n}\nvector <int> deriv(const vector <int> &a) {\n\tint n = a.size();\n\tvector <int> res;\n\tif(n == 1) return res;\n\tres.resize(n - 1);\n\tfor(int i = 0; i < n - 1; ++i) \n\t\tres[i] = 1ll * a[i + 1] * (i + 1) % mod;\n\treturn res;\n}\n\nvector <int> integ(const vector <int> &a) {\n\tint n = a.size();\n\tvector <int> res(n + 1);\n\tres[0] = 0;\n\tfor(int i = 1; i < n; ++i)\n\t\tres[i] = 1ll * a[i - 1] * inv[i] % mod;\n\treturn res;\n}\nvector <int> poly_ln(const vector <int> &a) {\n\tint n = a.size();\n\tvector <int> res = integ(deriv(a) * poly_inv(a));\n\tres.resize(n);\n\treturn res;\n}\nvector <int> poly_exp(const vector <int> &a) {\n\tint n = a.size();\n\tvector <int> res(n);\n\tres[0] = 1;\n\tfor(int i = 1; i < n; ++i) {\n\t\tint tmp = 0;\n\t\tfor(int j = 0; j < i; ++j)\n\t\t\ttmp = (tmp + 1ll * a[j + 1] * (j + 1) % mod * res[i - 1 - j]) % mod;\n\t\tres[i] = 1ll * tmp * inv[i] % mod;\n\t}\n\treturn res;\n}\n\n}\nusing namespace poly;\n\nint n, k;\nsigned main() {\n\tcin >> n >> k, ++k, init();\n\tvector <int> a(k), b(k), ans(k);\n\tfor(int i = 0, j = n; i < k; ++i, j = 1ll * j * n % mod)\n\t\ta[i] = 1ll * j * ifc[i + 1] % mod, b[i] = ifc[i + 1];\n\ta = a * poly_inv(b), a.resize(k);\n\tfor(int i = 0; i < k; ++i) a[i] = 1ll * fac[i] * a[i] % mod;\n\tb[0] = 0;\n\tfor(int i = 1; i < k; ++i) {\n\t\tint tmp = 1ll * a[i] * inv[i] % mod;\n\t\tb[i] = i & 1 ? tmp : mod - tmp;\n\t}\n\tb = poly_exp(b);\n\tfor(int i = 0; i < k; ++i) {\n\t\tans[i] = b[i];\n\t\tif(i - 2 >= 0) ans[i] = (ans[i] + ans[i - 2]) % mod;\n\t}\n\tfor(int i = 1; i < k; ++i) printf(\"%d \", ans[i]);\n\treturn 0; \n}\n```",
        "postTime": 1619352732,
        "uid": 123384,
        "name": "tommy0221",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1516E Baby Ehab Plays with Permutations"
    },
    {
        "content": "## \u524d\u8a00\n\n\u6b64\u6587\u8bb0\u5f55 @shr_ \u795e\u4ed9\u6559\u6211\u7684\u795e\u4ed9\u505a\u6cd5\uff0c\u4e0d\u7528\u4ec0\u4e48\u4e71\u4e03\u516b\u7cdf\u7684\u6570\uff0c\u4e0d\u7528\u53cd\u6f14\uff0c\u4e5f\u4e0d\u7528\u63d2\u503c\uff01\uff01qaq\u3002\n\n## Solution\n\n\u9996\u5148\u8003\u8651\u94a6\u5b9a $f[i]$ \u4e3a\u6070\u597d\u7528 $i$ \u6b21\u64cd\u4f5c\uff0c\u5f97\u5230\u7684\u6392\u5217\u6570\u3002\u7136\u540e\u53d1\u73b0\u4f60\u53ef\u4ee5\u901a\u8fc7\u4e24\u6b21\u64cd\u4f5c\u4e00\u6b63\u4e00\u53cd\u56de\u5230\u539f\u70b9\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u901a\u8fc7\u8fd9\u6837\u7684\u64cd\u4f5c\u6211\u4eec\u53d1\u73b0 $f[i - 2]$ \u5bf9 $i$ \u7684\u7b54\u6848\u4e5f\u6709\u8d21\u732e\u3002\u90a3\u4e48\u5bf9\u4e8e $i$\uff0c\u7b54\u6848\u5c31\u662f $f[i] + f[i - 2] + f[i - 4].....$ \u56e0\u4e3a\u53ef\u4ee5\u901a\u8fc7\u82e5\u5e72\u5076\u6570\u6b21\u65e0\u7528\u64cd\u4f5c\u5f97\u5230\u3002\u800c\u8fd9\u4e9b\u72b6\u6001\u6ca1\u6709\u4ea4\u96c6\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u600e\u4e48\u6c42 $f[i]$\u3002\n\n\u4e0d\u96be\u60f3\u5230\u6211\u4eec\u679a\u4e3e\u64cd\u4f5c\u4e86\u591a\u5c11\u4e2a\u6570\uff0c\u7528\u4e86\u591a\u5c11\u6b21\u64cd\u4f5c\uff0c\u90a3\u8fd9\u5b9e\u9645\u4e0a\u5c31\u53ef\u4ee5 $dp[i][j]$ \u8868\u793a\u5f71\u54cd\u4e86 $i$ \u4e2a\u6570\uff0c\u7528\u4e86 $j$ \u6b21\u64cd\u4f5c\uff0c\u53ef\u4ee5\u5f97\u5230\u7684\u4e0d\u540c\u5e8f\u5217\u7684\u6570\u3002\n\n\u90a3\u4e48\n\n$$f[i] = \\sum dp[j][i] \\times {n \\choose j}$$\n\n\u63a5\u4e0b\u6765\u6c42 $dp$\u3002\n\n\u8003\u8651\u4ea4\u6362\u64cd\u4f5c\uff0c\u6211\u4eec\u628a\u8fd9\u4e2a\u5f53\u4f5c\u8fde\u4e00\u6761 $(i,j)$ \u7684\u65e0\u5411\u8fb9\uff0c\u90a3\u4e48\u5bf9\u4e8e $x$ \u4e2a\u6570\uff0c\u6211\u4eec\u8981\u5f71\u54cd\u5230\u8fd9 $x$ \u4e2a\u6570\uff0c\u663e\u7136\u8fde\u5b8c\u8fb9\u540e\u5fc5\u7136\u662f\u6811\u7684\u6837\u5b50\uff0c\u5426\u5219\u8981\u4e48\u4e0d\u8fde\u901a\uff0c\u8981\u4e48\u6811\u4e0a\u6709\u73af\u64cd\u4f5c\u5c31\u88ab\u7b49\u4ef7\u6389\u4e86\uff0c\u800c\u8fd9\u6070\u597d\u53ea\u9700\u8981 $x - 1$ \u6b21\u64cd\u4f5c\u3002\n\n\u4f46\u662f\u8981\u8003\u8651\u53bb\u91cd\uff0c\u795e\u4ed9\u6559\u6211\u7684\u4e00\u4e2a\u6280\u5de7\u5c31\u662f\u4f60\u8003\u8651\u94a6\u5b9a\u7ed3\u5c3e\u7684\u4e00\u4e2a\u6570\u6240\u5728\u7684\u4f4d\u7f6e\uff0c\u5269\u4e0b\u518d\u9009 $x - 1$ \u548c\u4ed6\u4e00\u8d77\uff0c\u4e5f\u5c31\u662f ${i - 1}\\choose {x - 1}$ \n\n\u800c\u8fd9 $x$ \u4e2a\u6570\u4f53\u73b0\u5728\u6392\u5217\u4e0a\u662f\u4e00\u4e2a\u7f6e\u6362\u73af\uff0c\u4e5f\u5c31\u662f\u8fde $i \\to p[i]$ \u8fd9\u6761\u8fb9\uff0c\u6700\u7ec8\u662f\u4e00\u4e2a\u73af\u3002\n\n\u6211\u4eec\u6bcf\u6b21\u52a0\u8fdb\u6765\u4e00\u4e2a\u7f6e\u6362\u73af\uff0c\u6211\u4eec\u4e00\u5b9a\u53ef\u4ee5\u6784\u9020\u51fa\u8fd9 $x$ \u4e2a\u6570\u7684\u6bcf\u4e00\u79cd\u6392\u5217\uff0c\u8fd9\u91cc\u5b9e\u9645\u4e0a\u662f\u5706\u6392\u5217\uff0c\u6240\u4ee5\u65b9\u6848\u6570\u8fd8\u8981\u4e58\u4e0a $(x - 1)!$\n\n\u6240\u4ee5\u6211\u4eec\u7684 $dp$ \u8f6c\u79fb\u53ef\u4ee5\u5199\u6210\u8fd9\u6837\uff1a\n \n $$ dp[i][j] = \\sum dp[i - w][j - (w - 1)] \\times {{i - 1}\\choose {w - 1}}\\times (w - 1)!$$\n \n \u8fd9\u91cc\u7684 $w$ \u662f\u6211\u4eec\u679a\u4e3e\u52a0\u8fdb\u6765\u7684\u73af\u7684\u5927\u5c0f\u3002\n \n \u6700\u540e\u6109\u5feb\u5408\u5e76\u7b54\u6848\uff0c\u52a0\u4e00\u52a0\uff0c\u5c31\u505a\u5b8c\u54e9qwq\u3002\n \n \u65f6\u95f4\u590d\u6742\u5ea6 $O(k^3)$\n \n ``` cpp\n #include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=(a);i<=(b);++i)\n#define Rep(i,a,b) for(int i=(a);i<(b);++i)\n#define rrep(i,a,b) for(int i=(a);i>=(b);--i)\nusing namespace std;\ntemplate <typename T>\ninline void read(T &x){\n    x=0;char ch=getchar();bool f=0;\n    while(ch<'0'||ch>'9'){if(ch=='-')f=1;ch=getchar();}\n    while(ch>='0'&&ch<='9')x=(x<<1)+(x<<3)+(ch^48),ch=getchar();\n    if(f)x=-x;\n}\ntemplate <typename T,typename ...Args>\ninline void read(T &tmp,Args &...tmps){read(tmp);read(tmps...);}\nint n,k;\nconst int mod = 1e9 + 7;\ninline int ksm(int x,int y){\n    int res = 1;\n    while(y){\n        if(y & 1)res = 1ll * res * x % mod;\n        x = 1ll * x * x % mod;\n        y >>= 1;\n    }\n    return res;\n}\ninline int Inv(int x){return ksm(x,mod - 2);}\ninline void add(int &x,int y){\n    if((x += y) >= mod)x -= mod;\n}\ntemplate <typename T>\ninline void write(T x){\n    vector<int>s;\n    while(x)s.push_back(x % 10),x /= 10;\n    while(!s.empty())putchar(s.back() + '0'),s.pop_back();\n}\nconst int K = 205;\nint f[K];\nint dp[K * 2][K],c[K * 2][K * 2],fac[K * 2];\nsigned main(){\n    read(n,k);\n    fac[0] = 1;\n    rep(i,1,k * 2)fac[i] = 1ll * fac[i - 1] * i % mod;\n    c[0][0] = 1;\n    rep(i,1,k * 2){\n        c[i][0] = c[i][i] = 1;\n        rep(j,1,i - 1){\n            add(c[i][j],c[i - 1][j - 1]);\n            add(c[i][j],c[i - 1][j]);\n        }\n    }\n    dp[0][0] = 1;\n    rep(i,1,k * 2){\n        rep(j,0,k){\n            rep(w,2,i){\n                if(j - w + 1 >= 0)\n                add(dp[i][j],1ll * dp[i - w][j - w + 1] * fac[w - 1] % mod * c[i - 1][w - 1] % mod);\n            }\n        }\n    }\n    int C = 1;\n    f[0] = 1;\n    rep(i,1,k){\n        C = n;\n        rep(j,2,min(k * 2,n)){\n            C = 1ll * C * (n - j + 1) % mod * Inv(j) % mod;\n            add(f[i],1ll * dp[j][i] * C % mod);\n        }\n    }\n    rep(i,1,k){\n        if(i - 2 >= 0)add(f[i],f[i - 2]);\n        // printf(\"%d \",f[i]);\n        write(f[i]);\n        putchar(' ');\n    }\n}\n```",
        "postTime": 1668768395,
        "uid": 141058,
        "name": "Xu_brezza",
        "ccfLevel": 0,
        "title": "CF1516E"
    },
    {
        "content": "~~\u6211\u4f3c\u4e4e\u7528\u4e86\u4e2a\u6700\u4e0d\u7528\u8111\u5b50\u7684\u505a\u6cd5...~~  \n\n\u9996\u5148\u6700\u57fa\u7840\u7684\uff0c\u53ef\u4ee5\u53cd\u8fc7\u6765\u8003\u8651\uff1a\u4e00\u4e2a\u6392\u5217 $p$ \u5982\u679c\u80fd\u901a\u8fc7 $k$ \u6b21\u4ea4\u6362\u53d8\u56de\u539f\u6392\u5217\uff0c\u539f\u6392\u5217\u901a\u8fc7 $k$ \u6b21\u4ea4\u6362\u4e5f\u80fd\u53d8\u56de\u53bb\u3002  \n\n\u7136\u540e\u5c31\u53ef\u4ee5\u8054\u60f3\u5230\u5706\u6392\u5217\u4e86\uff0c\u5bf9\u4e8e $i$ \u6b21\u53d8\u6362\uff0c\u7b49\u4ef7\u4e8e\u662f\u4e00\u4e2a $n-i$ \u4e2a\u56ed\u6392\u5217\u7684\u65b9\u6848\u6570\uff0c\u8fd9\u4e2a\u73a9\u610f\u662f\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\uff08\u5f53\u7136\u4e0d\u77e5\u9053\u8fd9\u70b9\u4e5f\u53ef\u4ee5\u505a\uff09\u3002  \n\n\u7136\u540e\u53ef\u4ee5\u5217\u51fa $dp$ \u5f0f\u5b50:$s(i,j)=(i-1)s(i-1,j)+s(i-1,j-1)$\u3002  \n\n\u6ce8\u610f\u5230\u6211\u4eec\u53ef\u4ee5\u4ea4\u6362\u4e24\u6b21 $i,j$ \u6765\u6d88\u8017\u4e24\u6b21\u53d8\u6362\uff0c\u6240\u4ee5\u6700\u7ec8 $k$ \u6b21\u53d8\u6362\u5b9e\u9645\u4e0a\u7684\u7b54\u6848\u662f\n$$\n\\sum^{k}_{i=0}[i \\bmod{2} \\equiv k]s(n,n-i)  \n$$  \n\n$n$ \u5f88\u5927\uff0c\u5982\u679c\u76f4\u63a5\u66b4\u529b\u505a\u7684\u8bdd\u590d\u6742\u5ea6\u662f $O(n^2)$ \u7684\uff0c\u4f46\u662f\u53ef\u4ee5\u53d1\u73b0 $k$ \u6bd4\u8f83\u5c0f\uff0c\u540c\u65f6\u6211\u4eec\u9700\u8981\u6c42\u7684\u503c\u5747\u4e3a $s(n,n-k)$ \u7684\u5f62\u5f0f\u3002  \n\n~~\u6253\u8868~~\u53ef\u4ee5\u53d1\u73b0\uff0c $s(n,n-k)$ \u6070\u597d\u662f\u4e00\u4e2a $2k-1$ \u6b21\u7684\u591a\u9879\u5f0f\uff0c\u76f4\u63a5\u7528\u7ebf\u6027\u62c9\u683c\u6717\u65e5\u63d2\u503c\u5373\u53ef\uff0c\u590d\u6742\u5ea6 $O(k^2)$\u3002  \n\n\n_Code_\n--------------\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define il inline\n#define ri register int\n#define ll long long\n#define ui unsigned int\nil ll read(){\n    bool f=true;ll x=0;\n    register char ch=getchar();\n    while(ch<'0'||ch>'9') {if(ch=='-') f=false;ch=getchar();}\n    while(ch>='0'&&ch<='9') x=(x<<3)+(x<<1)+(ch^48),ch=getchar();\n    if(f) return x;\n    return ~(--x);\n}\nil void write(const ll &x){if(x>9) write(x/10);putchar(x%10+'0');}\nil void print(const ll &x) {x<0?putchar('-'),write(~(x-1)):write(x);putchar('\\n');}\nil ll max(const ll &a,const ll &b){return a>b?a:b;}\nil ll min(const ll &a,const ll &b){return a<b?a:b;}\nconst ll mod=1e9+7;\nconst int MAXN=205;\nll ksm(ll d,ll t){\n    ll res=1;\n    for(;t;t>>=1,d=d*d%mod)\n        if(t&1) res=res*d%mod;\n    return res;\n}\nll add(ll x,ll y){return (x+=y)<mod?x:x-mod;}\nll dec(ll x,ll y){return (x-=y)<0?x+mod:x;}\nnamespace Lagrange{\n    ll y[MAXN*2],pre[MAXN*2],suf[MAXN*2],fac[MAXN*2],ifac[MAXN*2];\n    void init(int n=MAXN*2-1){\n        fac[0]=1;\n        for(ri i=1;i<=n;++i) fac[i]=fac[i-1]*i%mod;\n        ifac[n]=ksm(fac[n],mod-2);\n        for(ri i=n-1;~i;--i) ifac[i]=ifac[i+1]*(i+1)%mod;\n    }\n    ll solve(int n,int X){\n        ll ans=0;\n        pre[0]=1,suf[n+1]=1;\n        for(ri i=1;i<=n;++i) pre[i]=pre[i-1]*dec(X,i-1)%mod;\n        for(ri i=n;i;--i) suf[i]=suf[i+1]*dec(X,i-1)%mod;\n        for(ri i=1;i<=n;++i){\n            ll res=y[i]*pre[i-1]%mod*suf[i+1]%mod*ifac[i-1]%mod*ifac[n-i]%mod;\n            if(n-i&1) res=mod-res;\n            ans=add(ans,res);\n        }\n        return ans;\n    }\n}\nint n,k;\nll w[MAXN],ans[2];\nnamespace Sub1{\n    int f[MAXN*3][MAXN*3];\n    void main(){\n        f[1][1]=1;\n        for(ri i=2;i<=3*k;++i) for(ri j=1;j<=i;++j) f[i][j]=add(1ll*f[i-1][j]*(i-1)%mod,f[i-1][j-1]);\n        for(ri i=1;i<=k;++i){\n            for(ri j=0;j<=2*i;++j) Lagrange::y[j+1]=f[i+j][j];\n            w[i]=Lagrange::solve(2*i+1,n-i);\n        }\n    }\n}\nint main(){\n    // freopen(\"rand.in\",\"r\",stdin);\n    // freopen(\"1.out\",\"w\",stdout);\n    n=read(),k=read();\n    Lagrange::init(),Sub1::main();\n    ans[0]=1;\n    for(ri i=1;i<=k;++i){\n        ans[i&1]=add(ans[i&1],w[i]);\n        printf(\"%lld \",ans[i&1]);\n    }\n    fprintf(stderr,\"%lf\",1.0*clock()/CLOCKS_PER_SEC);\n    return 0;\n}\n```",
        "postTime": 1632298680,
        "uid": 206998,
        "name": "Krimson",
        "ccfLevel": 0,
        "title": "CF1516E Baby Ehab Plays with Permutations"
    },
    {
        "content": "\u9006\u5411\u601d\u8003\uff0c\u8003\u8651\u6709\u591a\u5c11\u4e2a\u6392\u5217\u7ecf\u8fc7 $k$ \u6b21\u4ea4\u6362\u53ef\u4ee5\u590d\u539f\u3002\n\n\u6211\u4eec\u53ea\u7528\u8003\u8651\u4e00\u4e2a\u6392\u5217\u6240\u9700\u7684\u6700\u5c0f\u4ea4\u6362\u6b21\u6570\u3002\n\n\u76f4\u63a5 $\\rm DP$ \uff0c\u5b9a\u4e49 $f[i][j]$ \u8868\u793a\u957f\u5ea6\u4e3a $i$ \u7684\u5e8f\u5217\uff0c\u6700\u5c11\u4ea4\u6362\u6b21\u6570\u4e3a $j$ \u7684\u6392\u5217\u6570\uff0c\u53ef\u4ee5\u5f97\u5230 $f[i][j]=(i-1)f[i-1][j-1]+f[i-1][j]$ \u3002\n\n\u5982\u679c\u4e0d\u597d\u7406\u89e3\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u6c42\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\uff0c\u663e\u7136\u6709$f[i][j]=S_1(i,i-j)$ \u3002\n\n\u73b0\u5728 $n$ \u5f88\u5927\uff0c\u65e0\u6cd5\u76f4\u63a5\u9012\u63a8\u3002\u53ef\u4ee5\u7528\u7279\u6b8a\u516c\u5f0f\u76f4\u63a5\u8ba1\u7b97\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u3002\n\n\u4e5f\u53ef\u4ee5\u5206\u6790\u4e00\u4e0b\uff0c\u53d1\u73b0 $i$ \u6b21\u64cd\u4f5c\u6700\u591a\u53ea\u4f1a\u6539\u53d8 $2i$ \u4e2a\u4f4d\u7f6e\uff0c\u6211\u4eec\u8003\u8651\u8ba1\u7b97\u51fa $g[i][j]$ \u8868\u793a\u957f\u5ea6\u4e3a $i$ \u7684\u6392\u5217\uff0c\u4e14$p_i\\neq i$\uff0c\u6700\u5c11\u9700\u8981$j$\u6b21\u590d\u539f\u7684\u65b9\u6848\u6570\u3002\n\n\u4e0d\u96be\u5f97\u5230\u7b49\u5f0f\n\n$$f[i][j]=\\sum\\limits_{k=0}^{i}\\binom{i}{k}g[k][j]$$\n\n\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e2a$j$\u5206\u5f00\u8ba1\u7b97\uff0c\u53d1\u73b0\u8fd9\u5c31\u662f\u4e8c\u9879\u5f0f\u53cd\u6f14\uff0c\u800c\u4e8c\u9879\u5f0f\u53cd\u6f14\u7684\u672c\u8d28\u5c31\u662f\u5bb9\u65a5\u539f\u7406\uff01\n\n$$g[i][j]=\\sum\\limits_{k=0}^{i}(-1)^{i-k}\\binom{i}{k}f[k][j]$$\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u7531\u6700\u591a $i$ \u4e2a\u4f4d\u7f6e $p_i\\neq i$ \u5bb9\u65a5\u51fa\u4e86**\u6070\u597d** $i$ \u4e2a\u4f4d\u7f6e $p_i \\neq i$\u3002\n\n\u6700\u540e\u5f97\u5230\n\n$$Ans_m=\\sum\\limits_{i=1}^{\\min\\{n,2m\\}}\\binom{n}{i}\\sum\\limits_{2\\mid (m-j)}g[i][j]$$\n\n\u9700\u8981\u7279\u522b\u6ce8\u610f\u5f53 $j=0$ \u65f6\u4ee5\u4e0a\u4e09\u4e2a\u7b49\u5f0f\u90fd\u4e0d\u6210\u7acb\uff0c\u4f46\u662f $f[i][0]=1$\uff0c\u76f4\u63a5\u7279\u5224\u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=a;i<=b;i++)\n#define pre(i,a,b) for(int i=a;i>=b;i--)\n#define N 405\n#define P 1000000007\nusing namespace std;\nconst int m = 400;\nint n,k,inv[N],fac[N],c[N][N],f[N][N],g[N][N],op[N];\nint Pow(int x,int y){int now=1;for(;y;y>>=1,x=1LL*x*x%P)if(y&1)now=1LL*now*x%P;return now;}\nint main(){\n\trep(i,0,m){c[i][0]=1;rep(j,1,i)c[i][j]=(c[i-1][j]+c[i-1][j-1])%P;}\n\tfac[0]=inv[0]=1;rep(i,1,m)fac[i]=1LL*i*fac[i-1]%P,inv[i]=Pow(fac[i],P-2);\n\trep(i,0,m){f[i][0]=1;rep(j,1,i-1)f[i][j]=(1LL*(i-1)*f[i-1][j-1]+f[i-1][j])%P;}\n\top[0]=1;rep(i,1,m)op[i]=op[i-1]*-1;\n\trep(i,1,m){\n\t\trep(j,1,i-1)rep(k,0,i)(g[i][j]+=1LL*op[i-k]*c[i][k]*f[k][j]%P)%=P;\n\t}\n\tscanf(\"%d%d\",&n,&k);\n\trep(i,1,k){\n\t\tint ans=0,cur=1;\n\t\trep(j,1,min(n,i*2)){\n\t\t\tcur=1LL*cur*(n-j+1)%P;\n\t\t\tfor(int w=i;w>0;w-=2)(ans+=1LL*cur*inv[j]%P*g[j][w]%P)%=P;\n\t\t}\n\t\tprintf(\"%d \",(P+ans+((i&1)^1))%P);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1619667959,
        "uid": 119261,
        "name": "7KByte",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011CF1516E Baby Ehab Plays with Permutations"
    },
    {
        "content": "\u6211\u4e0d\u77e5\u9053\u90a3\u4e48\u591a\u795e\u79d8\u7684\u516c\u5f0f\uff0c\u600e\u4e48\u529e\u5462\uff1f  \n\u6211\u53ea\u4f1a\u62c9\u683c\u6717\u65e5\u53cd\u6f14\uff0c\u600e\u4e48\u529e\u5462\uff1f\n\n\u9996\u5148\u5df2\u7ecf\u6709\u5f88\u591a\u4eba\u53d9\u8ff0\u8fc7\u7b2c $k$ \u9879\u7b54\u6848\u7b49\u4e8e\n$$\n\\sum\\limits_{i=0}^k [i\\equiv k \\pmod 2] \\left[\\begin{matrix}n\\\\n-i\\end{matrix}\\right]\n$$\n\n\u74f6\u9888\u5c31\u662f\u6c42\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u7684\u884c\u540e\u7f00\u3002  \n\u6839\u636e\u7ec4\u5408\u610f\u4e49\u5bb9\u6613\u77e5\u9053\n$$\n\\left[\\begin{matrix}n\\\\m\\end{matrix}\\right] = \\frac{n!}{m!} [z^n] \\left(\\ln\\frac1{1-z}\\right)^m\n$$\n\n\u90a3\u4e48\u8003\u8651\u62c9\u683c\u6717\u65e5\u53cd\u6f14\n$$\n\\begin{aligned}\n[z^n] \\left(\\ln\\frac1{1-z}\\right)^{n-k} &= \\frac{n-k}n [z^k] \\left(\\frac{z}{1-\\mathrm e^{-z}}\\right)^n \\\\\n\\left[\\begin{matrix}n\\\\n-k\\end{matrix}\\right] &= \\frac{(n-1)!}{(n-k-1)!} [z^k] \\left(\\frac{z}{1-\\mathrm e^{-z}}\\right)^n\n\\end{aligned}\n$$\n\n\u6a21\u6570\u5e76\u4e0d\u662f NTT \u6a21\u6570\uff0c\u4f46\u53ef\u4ee5\u5229\u7528 $F=u^{-n}$ \u6ee1\u8db3 $F'u = -nFu'$ $O(n^2)$ \u8ba1\u7b97\u3002\n\n\u5f53\u7136\uff0c\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u7684\u884c\u540e\u7f00\u4e5f\u53ef\u4ee5\u8fd9\u6837\u8ba1\u7b97\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <cstdio>\nusing namespace std;\nconst int N = 200;\nconst int mod = 1e9 + 7;\ninline int fpow(int a,int b)\n{\n\tint ret = 1;\n\tfor(;b;b >>= 1)\n\t\t(b & 1) && (ret = (long long)ret * a % mod),a = (long long)a * a % mod;\n\treturn ret;\n}\nint n,k;\nint fac[N + 5],ifac[N + 5],inv[N + 5];\nint f[N + 5],g[N + 5];\nint main()\n{\n\tscanf(\"%d%d\",&n,&k);\n\tfac[0] = 1;\n\tfor(int i = 1;i <= k + 1;++i)\n\t\tfac[i] = (long long)fac[i - 1] * i % mod;\n\tifac[k + 1] = fpow(fac[k + 1],mod - 2);\n\tfor(int i = k + 1;i;--i)\n\t\tifac[i - 1] = (long long)ifac[i] * i % mod;\n\tfor(int i = 1;i <= k + 1;++i)\n\t\tinv[i] = (long long)ifac[i] * fac[i - 1] % mod;\n\tf[0] = g[0] = 1;\n\tfor(int i = 1;i <= k;++i)\n\t{\n\t\tg[i] = i & 1 ? mod - ifac[i + 1] : ifac[i + 1];\n\t\tfor(int j = 1;j <= i;++j)\n\t\t\tf[i] = (f[i] + (long long)j * g[j] % mod * f[i - j]) % mod;\n\t\tf[i] = (long long)f[i] * n % mod;\n\t\tfor(int j = 1;j < i;++j)\n\t\t\tf[i] = (f[i] + (long long)j * f[j] % mod * g[i - j]) % mod;\n\t\tf[i] = (long long)(mod - f[i]) * inv[i] % mod;\n\t}\n\tfor(int i = 0,prod = 1;i <= k;++i)\n\t\tf[i] = (long long)f[i] * prod % mod,\n\t\tprod = (long long)prod * (n - 1 - i) % mod;\n\tfor(int i = 2;i <= k;++i)\n\t\tf[i] = (f[i] + f[i - 2]) % mod;\n\tfor(int i = 1;i <= k;++i)\n\t\tprintf(\"%d%c\",f[i],\" \\n\"[i == k]);\n}\n```",
        "postTime": 1629196930,
        "uid": 75840,
        "name": "deserter",
        "ccfLevel": 0,
        "title": "CF1516E"
    },
    {
        "content": "# CF1516E. Baby Ehab Plays with Permutations\n\n## Solution\n\n\u56e0\u4e3a\u7ec4\u5408\u6c34\u5e73\u4e0d\u884c\u6240\u4ee5\u53ea\u5f04\u51fa\u6765\u4e00\u4e2a$O(k^4)$\u7684\u505a\u6cd5\uff08\u867d\u7136\u968f\u4fbf\u6539\u6539\u53ef\u80fd\u5c31$O(k^3\\log k)$\u6216\u8005$O(k^3)$\u4e86\uff09\u800c\u4e14\u56e0\u4e3a\u6ca1\u60f3\u6e05\u695a\u800c\u81ea\u95ed\u4e86\u5f88\u4e45\uff0c~~\u4ece\u800c\u5bfc\u81f4\u6478yu\u65f6\u95f4\u88ab\u9609\u5272~~\u3002\n\n\u9996\u5148\u5927\u6982\u6709\u4e2a\u663e\u7136\u7684\u6027\u8d28\uff1a\u8bbe\u4e00\u4e2a\u4efb\u610f\u7684\u64cd\u4f5c\u65b9\u6848\u5f62\u6210\u7684\u6700\u7ec8\u5e8f\u5217\u4e3a$a_1,a_2...a_n$\uff0c\u628a$i$\u548c$a_i$\u8fde\u8fb9\uff0c\u4f1a\u5f62\u6210\u82e5\u5e72\u4e2a\u73af\uff0c\u6709\u4e2a\u663e\u7136\u7684\u7ed3\u8bba\u662f\u5230\u8fbe\u8be5\u72b6\u6001\u7684\u6700\u5c11\u64cd\u4f5c\u6b21\u6570\u662f\u6240\u6709\u73af\u957f\u5ea6\u51cf\u4e00\u7684\u548c\uff0c\u800c\u4e00\u4e2a\u4efb\u610f\u65b9\u6848\u53ef\u4ee5\u8868\u793a\u4e3a\u6700\u5c11\u64cd\u4f5c\u65b9\u6848\u52a0\u4e0a\u82e5\u5e72\u65e0\u7528\u64cd\u4f5c\uff0c\u663e\u7136\u65e0\u7528\u64cd\u4f5c\u4e2a\u6570\u4e3a\u5076\u6570\uff08\u7531\u9006\u5e8f\u5bf9\u4e2a\u6570\u5947\u5076\u6027\u53ef\u5f97\uff09\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u8ba1\u7b97\u6700\u5c11$i$\u6b65\u80fd\u5230\u8fbe\u7684\u72b6\u6001\u4e2a\u6570$Ans_i$\uff0c\u518d\u8ba9$Ans'_i=\\sum_{k=0}^{\\lfloor\\frac{i}{2}\\rfloor}Ans_{i-2k}$\u5373\u4e3a\u6700\u7ec8\u7684\u7b54\u6848\u3002\n\n\u56e0\u6b64\u6211\u4eec\u8981\u5bf9\u6bcf\u4e00\u4e2a$i$\uff0c\u6c42\u51fa\u6700\u5c11$i$\u6b65\u80fd\u5230\u8fbe\u7684\u72b6\u6001\u4e2a\u6570\u3002\n\n\u8fd9\u5c31\u76f8\u5f53\u4e8e\u53d6\u82e5\u5e72\u4e2a\u73af\uff0c\u4f7f\u5f97\u6240\u6709\u73af\u7684\u957f\u5ea6\u51cf\u4e00\u7684\u548c\u4e3a$i$\uff0c\u4e5f\u5c31\u7c7b\u4f3c\u4e8e\u505a\u4e00\u4e2a\u5b8c\u5168\u80cc\u5305\uff0c\u53d6$j$\u4e2a\u6570\u5f62\u6210\u73af\u7684\u65b9\u6848\u6570\u5c31\u662f\u73af\u6392\u5217\u4e2a\u6570$(j-1)!$\uff0c\u56e0\u6b64\u679a\u4e3e\u679a\u4e3e\u73af\u957f$i$\uff0c\u679a\u4e3e\u8be5\u79cd\u73af\u7684\u4e2a\u6570$p$\uff0c\u518d\u679a\u4e3e\u73af\u5305\u542b\u7684\u70b9\u6570$j$\u548c\u64cd\u4f5c\u6b21\u6570$k$\uff0c\u53ef\u5f97\uff1a\n$$\nf_{j,k}=\\sum_{p}f_{j-ip,k-(i-1)p} (i-1)^p\\binom{j}{ip}\\prod_{t=0}^{p-1}\\binom{ip-it-1}{i-1}\n$$\n\n$$\nAns_{i} = \\sum_{j} f_{j,i}\\binom{n}{j}\n$$\n\n\u9884\u5904\u7406\u4e00\u4e9b\u4e1c\u897f\u5373\u53ef\u8ba1\u7b97\u3002\n\n## Code\n```cpp\nint fac[405], Inv[405], C[405][405], f[405][205], Ans[405], tmp[405][205], inv[405], Mul[405];\nint quick_pow(int x, int y) {\n\tint ret = 1;\n\tfor (; y ; y >>= 1) {\n\t\tif (y & 1) ret = 1ll * ret * x % mods;\n\t\tx = 1ll * x * x % mods;\n\t}\n\treturn ret;\n}\nsigned main() {\n#ifndef ONLINE_JUDGE\n\tfreopen(\"a.in\", \"r\", stdin);\n#endif\n\tint n, k;\n\tread(n), read(k);\n\tfac[0] = inv[0] = Inv[0] = 1;\n\tfor (int i = 1; i <= k + k ; ++ i) Inv[i] = quick_pow(i, mods - 2);\n\tfor (int i = 1; i <= k + k ; ++ i) fac[i] = 1ll * fac[i - 1] * i % mods, inv[i] = quick_pow(fac[i], mods - 2);\n\tfor (int i = 0; i <= k + k ; ++ i) C[i][i] = C[i][0] = 1;\n\tfor (int i = 1; i <= k + k ; ++ i)\n\t\tfor (int j = 1; j < i ; ++ j) C[i][j] = (C[i - 1][j] + C[i - 1][j - 1]) % mods;\n\tf[0][0] = 1;\n\tfor (int i = 2; i <= min(n, k + 1) ; ++ i) {\n\t\tfor (int j = 0; j <= k + k ; ++ j)\n\t\t\tfor (int t = 0; t <= k ; ++ t) tmp[j][t] = f[j][t], f[j][t] = 0;\n\t\tfor (int j = 0; j <= k + k ; ++ j) Mul[j] = 1;\n\t\tfor (int p = 0, mul = 1; p <= k ; ++ p) {\n\t\t\tfor (int j = i * p ; j <= k + k ; ++ j) {\n\t\t\t\tfor (int t = (i - 1) * p ; t <= k ; ++ t)\n\t\t\t\t\tf[j][t] = (f[j][t] + 1ll * tmp[j - i * p][t - (i - 1) * p] * Mul[i * p] % mods * mul % mods * C[j][i * p] % mods) % mods;\n\t\t\t}\t\n\t\t\tfor (int j = k + k; j >= 0 ; -- j)\n\t\t\t\tif (j >= i) Mul[j] = 1ll * Mul[j - i] * C[j - 1][i - 1] % mods;\n\t\t\t\telse Mul[j] = 0;\n\t\t\tmul = 1ll * mul * fac[i - 1] % mods;\n\t\t}\n\t}\n\tfor (int i = 0, mul = 1; i <= min(k + k, n) ; ++ i) {\n\t\tfor (int j = 0; j <= k ; ++ j) \n\t\t\tAns[j] = (Ans[j] + 1ll * f[i][j] * mul % mods * inv[i] % mods) % mods;\n\t\tmul = 1ll * mul * (n - i) % mods;\n\t}\n\tfor (int i = 2; i <= k ; ++ i) Ans[i] = (Ans[i] + Ans[i - 2]) % mods;\n\tfor (int i = 1; i <= k ; ++ i) print(Ans[i]), putc(' ');\n\treturn 0;\n}\n```\n",
        "postTime": 1619092499,
        "uid": 32063,
        "name": "fade_away",
        "ccfLevel": 0,
        "title": "CF1516E. Baby Ehab Plays with Permutations"
    },
    {
        "content": "UPD: \u539f\u6765\u8d34\u9519\u4e86\u4ee3\u7801 QAQ\n\n---\n\n\u9006\u5411\u8003\u8651\u95ee\u9898\u3002\u9996\u5148\uff0c\u8003\u8651\u8ba1\u7b97\u6709\u591a\u5c11\u4e2a\u6392\u5217\u5b83**\u6070\u597d**\u9700\u8981 $j$ \u6b21 swap \u6765\u6392\u5e8f\u3002\n\n\u8003\u8651\u4e00\u4e2a\u6392\u5217\u5b83\u81f3\u5c11\u9700\u8981\u591a\u5c11\u6b21 swap \u624d\u80fd\u6392\u5e8f\u5462\uff1f\u6211\u4eec\u5c06\u8fd9\u4e2a\u6392\u5217\u8fdb\u884c\u5faa\u73af\u5206\u89e3\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5927\u5c0f\u4e3a $k$ \u7684\u5faa\u73af\uff0c\u663e\u7136\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4f9d\u6b21\u4ea4\u6362\u76f8\u90bb\u4e24\u9879\u7684\u65b9\u5f0f\uff0c\u5728 $k - 1$ \u6b65\u8fd8\u539f\u8fd9\u4e2a\u5faa\u73af\u3002\n\n\u6240\u4ee5\uff0c\u5982\u679c\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6392\u5217 $p$ \u4e2d\u6709 $c$ \u4e2a\u5faa\u73af\uff0c\u5b83\u5c31\u9700\u8981 $n - c$ \u6b65\u6765\u8fd8\u539f\u3002\n\n\u800c\uff0c\u9700\u8981 $j$ \u6b21 swap \u7684\u6392\u5217\u6570\u91cf\uff0c\u4e5f\u5c31\u662f $n - c = j \\Rightarrow c = n - j$ \u7684\u90a3\u4e9b\u6392\u5217\u3002\n\n\u90a3\u4e48\uff0c\u6839\u636e**\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570**\u7684\u5b9a\u4e49\uff0c\u6211\u4eec\u5f97\u51fa\u4e86\u4e00\u4e2a\u91cd\u8981\u7684\u7ed3\u8bba\uff1a\u9700\u8981 $j$ \u6b65\u6765\u8fd8\u539f\u7684\u6392\u5217\u6570\u91cf\u4e3a $\\begin{bmatrix} n \\\\ n - j \\end{bmatrix}$\uff01\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u9898\u76ee\u7684\u7b54\u6848\u4f9d\u6b21\u662f \n$$\n\\begin{bmatrix} n \\\\ n - 1 \\end{bmatrix}, \\begin{bmatrix} n \\\\ n \\end{bmatrix} + \\begin{bmatrix} n \\\\ n - 2 \\end{bmatrix}, \\begin{bmatrix} n \\\\ n - 1 \\end{bmatrix} + \\begin{bmatrix} n \\\\ n - 3 \\end{bmatrix} \\cdots\n$$\n\u4f46\u6b63\u5e38\u6839\u636e\u9012\u63a8\u5f0f\u6765\u6c42\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u662f $O(n^2)$ \u7684\uff0c\u6709\u6ca1\u6709\u66f4\u5feb\u7684\u65b9\u6cd5\u5462\uff1f\n\n\u6ce8\u610f\u5230\u867d\u7136 $n$ \u5f88\u5927\uff0c\u4f46\u662f $k \\le 200$\uff0c\u8003\u8651\u5229\u7528\u8fd9\u4e2a\u6027\u8d28\u3002\n\n\u5176\u5b9e\u5f53 $n - m$ \u5f88\u5c0f\u7684\u65f6\u5019\uff0c\u6709\u4e00\u79cd\u6bd4\u8f83\u5feb\u7684\u6c42\u503c\u516c\u5f0f\uff1a\n\n> $$ (-1)^{n-m}\\begin{bmatrix} n \\\\ m \\end{bmatrix} = \\sum_{k = 0}^{n - m} (-1)^k \\binom{n - 1 + k}{m - 1} \\binom{(n - m) + n}{(n - m) - k} \\begin{Bmatrix} (n - m) + k \\\\ k \\end{Bmatrix} $$\n> <https://mathworld.wolfram.com/StirlingNumberoftheFirstKind.html> \u4e2d\u7684 (21) \u5f0f\uff0c\u505a\u4e86\u4e00\u4e9b~~\u4f18\u7f8e\u7684~~\u53d8\u5f62\u3002\n>\n> \u5176\u5b9e\uff0c\u5982\u679c\u628a\u7b49\u53f7\u5de6\u8fb9\u7684\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u6539\u4e3a\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\uff0c\u7b49\u53f7\u53f3\u8fb9\u7684\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u6539\u4e3a\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\uff0c\u7b49\u5f0f\u4ecd\u7136\u6210\u7acb\u3002\n\n\u4e8e\u662f $O(k^2)$ \u9012\u63a8\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\uff0c\u6309\u7167\u8fd9\u4e2a\u5f0f\u5b50\u5373\u53ef\u6c42\u89e3\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(k^3)$\u3002\u8981\u7ebf\u6027\u9884\u5904\u7406\u9006\u5143\u3002\n\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long \nusing namespace std;\nconst int MOD = 1e9 + 7, K = 405;\nint S[K][K], ans[K], inv[K];\nint C(int n, int m)\n{\n\tif(n < m || n < 0 || m < 0) return 0;\n\tif(m > n - m) m = n - m;\n\tint res = 1;\n\tfor(int i = 1; i <= m; i++)\n\t\tres = res * (n - i + 1) % MOD * inv[i] % MOD;\n\treturn res;\n}\nint s(int n, int m)\n{\n\tif(m < 0) return 0;\n\tint res = 0;\n\tfor(int k = 0; k <= n - m; k++)\n\t{\n\t\tint val = C(n - 1 + k, m - 1) * C(n - m + n, n - m - k) % MOD * S[n - m + k][k] % MOD;\n\t\tif(k & 1) res = (res - val + MOD) % MOD;\n\t\telse res = (res + val) % MOD;\n\t}\n\treturn res;\n}\nint n, k;\nsigned main()\n{\n\tcin >> n >> k;\n\tinv[1] = 1;\n\tfor(int i = 2; i < K; i++)\n\t    inv[i] = (MOD - MOD / i) * inv[MOD % i] % MOD;\n\tS[0][0] = 1;\n\tfor(int i = 1; i <= k * 2; i++)\n\t\tfor(int j = 1; j <= i; j++)\n\t\t\tS[i][j] = (S[i - 1][j - 1] + j * S[i - 1][j] % MOD) % MOD;\n\tfor(int i = 0; i <= min(n, k); i++) \n\t\tif(i & 1) ans[i] = MOD - s(n, n - i);\n\t\telse ans[i] = s(n, n - i);\n\tfor(int i = 1; i <= k; i++)\n\t{\n\t\tif(i - 2 >= 0) ans[i] = (ans[i] + ans[i - 2]) % MOD;\n\t\tprintf(\"%lld \", ans[i]);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1619257067,
        "uid": 51971,
        "name": "syksykCCC",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1516E \u3010Baby Ehab Plays with Permutations\u3011"
    },
    {
        "content": "# CF1516E Baby Ehab Plays with Permutations \u9898\u89e3\n\n**\u94fe\u63a5**\uff1a[CF1516E](https://codeforces.com/contest/1516/problem/E)\n\n**\u9898\u610f**\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u521d\u59cb\u4e3a $1,2,3,\\cdots,n$ \u7684\u6392\u5217\uff0c\u4f60\u53ef\u4ee5\u8fdb\u884c $j$ \u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u64cd\u4f5c\u53ef\u4ee5\u4ea4\u6362\u6392\u5217\u4e2d\u4efb\u610f\u4e24\u4e2a\u6570\uff0c\u8be2\u95ee $j$ \u6b21\u64cd\u4f5c\u540e\u6709\u51e0\u79cd\u4e0d\u540c\u7684\u6392\u5217\u3002\u6c42\u51fa $j=1,2,3,\\cdots,k$ \u7684\u6240\u6709\u7ed3\u679c\u3002\n\n**\u9898\u89e3**\uff1a\u521d\u59cb\u72b6\u6001\u4e0b\uff0c\u4e00\u4e2a $1$ \u5230 $n$ \u7684\u6392\u5217\u4e2d\u7684\u6240\u6709\u5143\u7d20\u90fd\u53ef\u4ee5\u770b\u4f5c\u662f $n$ \u4e2a\u5927\u5c0f\u4e3a $1$ \u7684\u5706\u6392\u5217\uff08\u5b9e\u9645\u4e0a\u5c31\u662f $n$ \u4e2a\u6307\u5411\u81ea\u5df1\u7684\u73af\uff09\u3002\n\n\u7136\u540e\u8003\u8651\u4ea4\u6362 $1$ \u6b21\u5bf9\u4e8e\u8fd9\u4e9b\u5706\u6392\u5217\u7684\u5f71\u54cd\uff0c\u6bd4\u5982 $[1,2,3,4]$ \u4ea4\u6362 $1$ \u6b21\u540e\u53ef\u80fd\u5f97\u5230 $[2,1,3,4]$ \uff0c\u8fd9\u4e2a\u65f6\u5019\u65b0\u7684\u6392\u5217\u5b9e\u9645\u4e0a\u7531 $3$ \u4e2a\u5706\u6392\u5217\uff08\u73af\uff09\u6784\u6210\uff1a$[2,1],[3],[4]$ \uff0c\u5176\u4ed6\u60c5\u51b5\u540c\u7406\u3002\u8fd9\u610f\u5473\u7740\uff0c\u4ea4\u6362 $1$ \u6b21\u540e\uff0c$n$ \u4e2a\u5706\u6392\u5217\u53ea\u5269\u4e0b $n-1$ \u4e2a\u3002\u7136\u540e\uff0c\u6211\u4eec\u8003\u8651\u4ea4\u6362 $2$ \u6b21\uff0c\u7ecf\u8fc7\u6d4b\u8bd5\u4e0d\u96be\u53d1\u73b0\u4ea4\u6362 $2$ \u6b21\u540e\u5706\u6392\u5217\u8981\u4e48\u6709 $n-2$ \u4e2a\uff0c\u8981\u4e48\u6709 $n$ \u4e2a\uff0c\u8fd9\u63d0\u793a\u6211\u4eec\u6bcf\u4e00\u6b21\u7684\u4ea4\u6362\uff0c\u6211\u4eec\u90fd\u53ef\u4ee5\u8ba9\u5706\u6392\u5217\u7684\u6570\u91cf\u51cf\u5c11 $1$ \uff08\u6700\u5c11\u4e3a $1$\uff09\u6216\u8005\u64a4\u9500\u524d\u4e00\u6b21\u7684\u4ea4\u6362\u3002\n\n\u56e0\u6b64\u5982\u679c\u6211\u4eec\u8bbe\u5927\u5c0f\u4e3a $n$ \u7684\u6392\u5217\u6784\u6210 $k$ \u4e2a\u5706\u6392\u5217\u7684\u65b9\u6848\u6570\u4e3a $s(n,k)$ \uff0c\u90a3\u4e48\u672c\u9898\u7684\u7b54\u6848\u5c31\u662f\uff1a$s(n,n-1),s(n,n)+s(n,n-2),s(n,n-1)+s(n,n-3),\\cdots$ \u3002\n\n\u8fd9\u91cc\u7684 $s(n,k)$ \u5b9e\u9645\u4e0a\u5c31\u662f\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u7684\u5b9a\u4e49\uff0c\u6211\u4eec\u76f4\u63a5\u6c42\u503c\u5c31\u53ef\u4ee5\u89e3\u51b3\u4e86\u3002\u3002\u3002\u7b49\u7b49 $n\\leq10^9,k\\leq 10^2$ \uff0c\u4f46\u6211\u53ea\u4f1a $O(n^2)$ \u9012\u63a8\u554a\uff01\u4e0d\u8981\u614c\uff0c\u6253\u5f00\u65e0\u654c\u7684wiki\uff0c\u5728 [Stirling Numbers of the First Kind](https://en.wikipedia.org/wiki/Stirling_numbers_of_the_first_kind) \u4e2d\u6211\u4eec\u53d1\u73b0\u4e86\u8fd9\u4e2a\u5f0f\u5b50\uff1a\n$$\n\\begin{aligned}\ns(n,n-i) = \\sum^i_{j=0}(-1)^j\\binom{n-1+j}{i+j} \\binom{n+i}{i-j}S(i+j, j)\n\\end{aligned}\n$$\n\u4e0a\u5f0f\u4e2d $S(i+j,j)$ \u8868\u793a\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u9884\u5904\u7406\u4e00\u4e0b\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\uff0c\u5c31\u53ef\u4ee5\u5728 $O(k^3)$ \u7684\u590d\u6742\u5ea6\u4e0b\u89e3\u51b3\u672c\u9898\u4e86\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconstexpr int md = (int)1e9 + 7;\nconstexpr int N = 666;\nint s[N], S[N][N], iv[N];\ninline int add(int a, int b) {\n    a += b;\n    if (a >= md) a -= md;\n    return a;\n}\n\ninline int sub(int a, int b) {\n    a -= b;\n    if (a < 0) a += md;\n    return a;\n}\n\ninline int mul(int a, int b) {\n    return (int)((long long)a * b % md);\n}\n\ninline int powmod(int a, long long b) {\n    int res = 1;\n    while (b > 0) {\n        if (b & 1) res = mul(res, a);\n        a = mul(a, a);\n        b >>= 1;\n    }\n    return res;\n}\n\ninline int inv(int a) {\n    a %= md;\n    if (a < 0) a += md;\n    int b = md, u = 0, v = 1;\n    while (a) {\n        int t = b / a;\n        b -= t * a; swap(a, b);\n        u -= t * v; swap(u, v);\n    }\n    assert(b == 1);\n    if (u < 0) u += md;\n    return u;\n}\n\nint binom(int n, int m) {\n    if (n < m || n < 0 || m < 0) return 0;\n    int res = 1;\n    for (int i = n - m + 1; i <= n; i++) {\n        res = mul(res, i);\n    }\n    for (int i = 1; i <= m; i++) {\n        res = mul(res, iv[i]);\n    }\n    return res;\n}\n\nint main() {\n    ios::sync_with_stdio(false);\n    cin.tie(nullptr);\n    cout.tie(nullptr);\n    int n, k;\n    cin >> n >> k;\n    S[0][0] = 1;\n    for (int i = 1; i < N; i++) {\n        iv[i] = inv(i);\n        for (int j = 1; j < N; j++) {\n            S[i][j] = add(S[i - 1][j - 1], mul(j, S[i - 1][j]));\n        }\n    }\n    for (int i = 0; i <= 200; i++) {\n        for (int j = 0; j <= i; j++) {\n            if (j & 1) {\n                s[i] = sub(s[i], mul(binom(n - 1 + j, i + j), mul(binom(n + i, i - j), S[i + j][j])));\n            } else {\n                s[i] = add(s[i], mul(binom(n - 1 + j, i + j), mul(binom(n + i, i - j), S[i + j][j])));\n            }\n        }\n        if (i & 1) {\n            s[i] = sub(md, s[i]) % md;\n        }\n    }\n    int s1 = s[1], s0 = s[0];\n    vector<int> res = { s1 };\n    for (int i = 2; i <= min(n - 1, k); i++) {\n        if (i & 1) {\n            s1 = add(s1, s[i]);\n            res.push_back(s1);\n        } else {\n            s0 = add(s0, s[i]);\n            res.push_back(s0);\n        }\n    }\n    while (res.size() < k) {\n        res.push_back(res.back());\n    }\n    for (int i = 0; i < k; i++) {\n        cout << res[i] << \" \\n\"[i == k - 1];\n    }\n    return 0;\n}\n```\n\n",
        "postTime": 1619173072,
        "uid": 229064,
        "name": "st1vdy",
        "ccfLevel": 0,
        "title": "CF1516E Baby Ehab Plays with Permutations \u9898\u89e3"
    }
]
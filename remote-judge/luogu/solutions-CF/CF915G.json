[
    {
        "content": "\u7b54\u6848\u8f93\u51fa\u4e2d\u6709\u5f02\u6216\uff0c\u4f46\u662f\u5f02\u6216\u4e0e\u6570\u8bba\u548c\u6c42\u548c\u5f0f\u7ed3\u5408\u662f\u5f88\u96be\u5229\u7528\u7684\uff0c\u6240\u4ee5\u8fd9\u9053\u9898\u53ef\u4ee5\u5224\u65ad\uff0c\u6211\u4eec\u5fc5\u987b\u628a\u6bcf\u4e2a $b_i$ \u90fd\u6c42\u51fa\u6765\u3002\n\n\u975e\u5e38\u5957\u8def\uff0c\u9996\u5148\u5217\u51fa $b_m$ \u7684\u539f\u59cb\u5f0f\u5b50\n\n$ b_m = \\sum_{a_1 = 1}^{m} \\cdots \\sum_{a_k = 1}^{m} \\delta_1 \\left( \\gcd_{i = 1}^{k} a_i \\right) $\n\n\u5957\u8def\u5730\u8fdb\u884c\u83ab\u6bd4\u4e4c\u65af\u53d8\u6362\uff1a\n\n$ b_m = \\sum_{a_1 = 1}^{m} \\cdots \\sum_{a_k = 1}^{m} \\sum_{d | \\forall a_i} \\mu(d) $\n\n$ b_m = \\sum_{d=1}^m\\mu(d) \\left\\lfloor\\frac{m}{d}\\right\\rfloor ^ k $\n\n\u4f60\u53ef\u80fd\u8ba4\u4e3a\u8fd9\u91cc\u8981\u8fdb\u884c\u9664\u6cd5\u5206\u5757\uff0c\u4f46\u5176\u5b9e\u4e0d\u662f\uff0c\u56e0\u4e3a\u8fd9\u6837\u590d\u6742\u5ea6\u5c31\u662f $ \\sum_{d = 1}^{n} \\sqrt d \\log k = \\mathcal O (n\\sqrt n \\log k) $ \u4e86\u3002\n\n\u8fd9\u6837\u505a\u5c31\u5ffd\u7565\u7684\u4e00\u4e2a\u6027\u8d28\uff0c\u90a3\u5c31\u662f\u6211\u4eec\u8981\u5bf9\u8fde\u7eed\u4e00\u6bb5\u533a\u95f4\u5185\u7684 $b_m$ \u6c42\u503c\uff0c\u4e4b\u524d\u7684\u505a\u6cd5\u6839\u672c\u662f\u72ec\u7acb\u7684\u3002\n\n\u4e00\u4e2a\u60f3\u6cd5\u662f\u56e0\u5b50 $d$ \u4f1a\u53c2\u4e0e\u5728 $m \\ge d$ \u7684\u6bcf\u4e00\u4e2a $b_m$ \u4e2d\uff0c\u4f46\u5b83\u7684\u8d21\u732e\u662f\u6210\u6bb5\u6539\u53d8\u7684\uff0c\u90a3\u662f\u56e0\u4e3a $\\mu(d)$ \u53d6\u503c\u4e0d\u53d8\uff0c\u800c $\\left\\lfloor\\frac{m}{d}\\right\\rfloor$ \u7684\u53d6\u6574\u6027\u8d28\u4f7f $m$ \u6bcf\u589e\u52a0 $d$ \u624d\u4f1a\u6539\u53d8\u3002\n\n\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e $d$ \uff0c\u7ef4\u62a4 $b_m$ \u7684\u5dee\u5206\u6570\u7ec4 $\\Delta b_m$ \uff0c\u6700\u540e\u8fdb\u884c\u524d\u7f00\u548c\u3002\n\n$d$ \u5728 $\\Delta b_{xd} = \\mu(d) \\cdot (x^n - (x - 1)^n)$\n\n\u628a\u5e42\u9884\u5904\u7406\uff0c\u590d\u6742\u5ea6 $\\Theta(n \\log k)$ \u3002\n\n\u6bcf\u4e2a $d$ \u5f71\u54cd\u4e86 $\\frac n d$ \u4e2a\u5dee\u5206\u4f4d\u7f6e\uff0c\u5b83\u4eec\u7684\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\sum_{d = 1}^n \\frac n d = \\Theta(n \\log n)$ \u3002\n\n\u7efc\u4e0a\uff0c\u6211\u4eec\u4ee5 $\\Theta \\left(n(\\log n + \\log k)\\right)$ \u65f6\u95f4\u590d\u6742\u5ea6\u89e3\u51b3\u7684\u6b64\u9898\u3002\n\n```cpp\n#include <cstdio>\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst int P = 1e9 + 7;\n\nconst int N = 2e6 + 10;\n\nint n, k, pc;\nint pw[N], mu[N], p[N], b[N * 2];\nbool vis[N];\n\nvoid sieve();\nint pow(int x, int k);\n\nint main() {\n\tscanf(\"%d%d\", &n, &k);\n\tfor (int i = 1; i <= k; ++i)\n\t\tpw[i] = pow(i, n);\n\tsieve();\n\tfor (int x = 1; x <= k; ++x) {\n\t\tfor (int i = 1; i * x <= k; ++i) {\n\t\t\tb[i * x] = (b[i * x] + (ll)pw[i] * (P + mu[x]) % P) % P;\n\t\t\tb[i * x] = (b[i * x] - (ll)pw[i - 1] * (P + mu[x] % P)) % P;\n\t\t\tif (b[i * x] < 0)\n\t\t\t\tb[i * x] += P;\n\t\t}\n\t}\n\tint ans = 0;\n\tfor (int i = 1; i <= k; ++i) {\n\t\tb[i] = (b[i] + b[i - 1]) % P;\n\t\tans = (ans + (b[i] ^ i) % P) % P;\n\t}\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n\nvoid sieve() {\n\tmu[1] = 1;\n\tfor (int x = 2; x <= k; ++x) {\n\t\tif (!vis[x]) {\n\t\t\tp[++pc] = x;\n\t\t\tmu[x] = -1;\n\t\t}\n\t\tfor (int j = 1; x * p[j] <= k; ++j)\n\t\t\tif (x % p[j] == 0) {\n\t\t\t\tmu[x * p[j]] = 0;\n\t\t\t\tvis[x * p[j]] = true;\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tmu[x * p[j]] = -mu[x];\n\t\t\t\tvis[x * p[j]] = true;\n\t\t\t}\n\t}\n}\n\nint pow(int x, int k) {\n\tint ret = 1;\n\twhile (k) {\n\t\tif (k & 1)\n\t\t\tret = (ll)ret * x % P;\n\t\tx = (ll)x * x % P;\n\t\tk >>= 1;\n\t}\n\treturn ret;\n}\n```",
        "postTime": 1518105002,
        "uid": 21423,
        "name": "Elegia",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF915G \u3010Coprime Arrays\u3011"
    },
    {
        "content": "\n\u9996\u5148\u5f0f\u5b50\u975e\u5e38\u7b80\u5355\n\n\u6309\u7167\u5957\u8def\u63a8\u4e00\u63a8\n\n\u8981\u6c42\u7684\u5c31\u662f\n\n\u5bf9\u4e8e\u6bcf\u4e2a$k$\n$$\\large f(k)=\\sum\\limits_{d=1}^{k}\\mu(d)\\lfloor\\frac{k}{d}\\rfloor^n$$\n\u76f4\u63a5\u66b4\u529b\u5bf9\u6bcf\u4e2a$k$\u6574\u9664\u5206\u5757\u65f6\u95f4\u590d\u6742\u5ea6\u662f$k\\sqrt{k}logn$\u663e\u7136\u4e0d\u80fd\u8fc7\n\n\u6ce8\u610f\u5230\n\n$$\\large \\lfloor\\frac{k}{d}\\rfloor\\ne \\lfloor\\frac{k-1}{d}\\rfloor\u21d4d\u2223k$$\n\u663e\u7136\u53ea\u4f1a\u5728$d$\u500d\u6570\u90a3\u91cc\u6539\u53d8\n\n\u6b64\u65f6\u524d\u8005\u4e3a\u540e\u8005$+1$\n\n\u8003\u8651\u5bf9\u7b54\u6848\u5dee\u5206\n$\\large \\Delta f=f(k)-f(k-1)=\\sum\\limits_{d=1}^{k}\\mu(d)\\lfloor\\frac{k}{d}\\rfloor^n-\\sum\\limits_{d=1}^{k-1}\\mu(d)\\lfloor\\frac{k-1}{d}\\rfloor^n$\n\n$\\large \\Delta f=\\sum\\limits_{d=1}^{k}\\mu(d)(\\lfloor\\frac{k}{d}\\rfloor^n-\\lfloor\\frac{k-1}{d}\\rfloor^n)$\n\n\u8003\u8651\u4e0a\u9762\u8bf4\u7684\uff0c$\\lfloor\\frac{k}{d}\\rfloor^n-\\lfloor\\frac{k-1}{d}\\rfloor^n$\n\u4e0d\u4e3a$0$\u5f53\u4e14\u4ec5\u5f53$d|k$\n\n\u6240\u4ee5\n\n$\\large \\Delta f=\\sum\\limits_{d|k}^{k}\\mu(d)(\\lfloor\\frac{k}{d}\\rfloor^n-\\lfloor\\frac{k-1}{d}\\rfloor^n)$\n\n$g(x)=x^n$\u53ef\u4ee5\u76f4\u63a5\u7ebf\u6027\u7b5b(\u4e5f\u53ef\u4ee5\u76f4\u63a5log\u7b97)\n\n$\\large \\Delta f$\u5c31\u53ef\u4ee5\u7c7b\u4f3c\u5bf9\u4e8e\u6bcf\u4e2a$d$\u628a\u7b54\u6848\u8d21\u732e\u5230\u5b83\u7684\u500d\u6570\u90a3\u91cc\n\n$ans$\u4e00\u8def$+\\Delta f$\u5c31\u884c\u4e86\n\n\u5177\u4f53\u5b9e\u73b0\u770b\u4ee3\u7801\u5427\n\ncode:\n```cpp\n#include<bits/stdc++.h>\n#define N 2000050\n#define mod 1000000007\n#define ll long long\nusing namespace std;\nconst int lim = N - 5;\nll qpow(ll x, ll y) {\n\tll ret = 1;\n\tfor(; y; y >>= 1, x = x * x % mod) if(y & 1) ret = ret * x % mod;\n\treturn ret;\n}\nint vis[N], prime[N], mu[N], sz;\nvoid init() {//\u7ebf\u6027\u7b5b \n\tmu[1] = 1;\n\tfor(int i = 2; i <= lim; i ++) {\n\t\tif(!vis[i]) {\n\t\t\tprime[++ sz] = i;\n\t\t\tmu[i] = - 1;\n\t\t}\n\t\tfor(int j = 1; j <= sz && prime[j] * i < N; j ++) {\n\t\t\tvis[prime[j] * i] = 1;\n\t\t\tif(i % prime[j] == 0) {\n\t\t\t\tmu[i * prime[j]] = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmu[i * prime[j]] = - mu[i];\n\t\t}\n\t}\n}\nint n, m;\nll pw[N], D[N];\nint main() {\n\tinit();\n\tscanf(\"%d%d\", &n, &m);\t\n\tfor(int i = 1; i <= m; i ++) pw[i] = qpow(i, n);//\u7b97 g(x) = x ^ n \n\tfor(int i = 1; i <= m; i ++)\n\t\tfor(int j = i; j <= m; j += i) {\n\t\t\tD[j] = (D[j] + 1ll * mu[i] * (pw[j / i] - pw[j / i - 1]) + mod) % mod;// \u5bf9\u4e8e\u6bcf\u4e2ad\uff0c\u76f4\u63a5\u8d21\u732e\u5230\u500d\u6570\u90a3\u91cc \n\t\t}\t\t \n\tll ans = 0, s = 0;\n\tfor(int i = 1; i <= m; i ++) {\n\t\ts = (s + D[i]) % mod;//\u5f53\u524d\u7684\u7b54\u6848 \n\t\tans = (ans + (s ^ i)) % mod;//\u6309\u7167\u9898\u76ee\u8981\u6c42\u7684\u5f02\u6216 \n\t}\n\tprintf(\"%lld\", ans);\n\treturn 0;\n}\n\n```\n\n\u5bf9\u4e8e\u8fd9\u79cd\u4e00\u4e2a\u4e2a\u7b97\u6162\u7684\u53ef\u4ee5\u76f4\u63a5\u5148\u5dee\u5206\uff0c\u770b\u89c2\u5bdf\u5f0f\u5b50\u7684\u53d8\u5316\n\u6700\u91cd\u8981\u662f\u8981\u8bb0\u5f97\uff1a\n$$\\large \\lfloor\\frac{k}{d}\\rfloor\\ne \\lfloor\\frac{k-1}{d}\\rfloor\u21d4d\u2223k$$\n",
        "postTime": 1616713630,
        "uid": 31656,
        "name": "lomit",
        "ccfLevel": 8,
        "title": "CF915G Coprime Arrays"
    },
    {
        "content": "\u4e00\u4e2a\u4e0d\u7528 $\\mu$ \u7684\u505a\u6cd5\u3002  \n\n\u5bf9\u4e8e\u4e00\u4e2a\u4e0a\u754c $k$ \u7684\u8ba1\u7b97\u662f\u6bd4\u8f83\u663e\u7136\u7684\uff0c\u66b4\u529b\u505a\u5c31\u662f\u662f\u679a\u4e3e $\\gcd$\uff0c\u8bbe\u5176\u4e3a $g$\uff0c\u5bf9\u4e8e\u6240\u6709 $\\gcd$ \u4e3a $g$ \u7684\u500d\u6570\u7684\u6570\u5217\u6570\u91cf\u5c31\u662f $(\\lfloor\\frac{k}{g} \\rfloor)^n$\uff0c\u7136\u540e\u679a\u4e3e $g$ \u7684\u500d\u6570\u5bb9\u65a5\u7b97\u51fa\u6070\u597d\u4e3a $g$ \u7684\u65b9\u6848\u6570\uff0c\u4f46\u5b9e\u9645\u5e76\u4e0d\u7528\u3002\n\n\u6211\u4eec\u8bbe\u5728\u5f53\u524d\u4e0a\u754c $k$ \u4e0b\uff0c$\\gcd$ \u4e3a $i$ \u7684\u65b9\u6848\u6570\u4e3a $f[i]$\uff0c\u53ef\u4ee5\u53d1\u73b0\uff0c$k$ \u6bcf\u589e $1$\uff0c\u53ea\u6709 $i|k$ \u7684\u4f4d\u7f6e\u4f1a\u53d1\u751f\u53d8\u5316\uff0c\u800c\u4e14\u5bf9\u4e8e\u4e00\u4e2a $f[i]$ \u6765\u8bb2\uff0c\u5b83\u5b9e\u9645\u4e0a\u5c31\u662f\u5728\u4e0a\u754c\u4e3a $\\lfloor\\frac{k}{i}\\rfloor$ \u4e0b\uff0c$\\gcd$ \u4e3a $1$ \u7684\u6570\u5217\u7684\u65b9\u6848\u6570\u3002  \n\n\u53ef\u4ee5\u770b\u51fa\uff0c\u6211\u4eec\u628a\u95ee\u9898\u8f6c\u5316\u6210\u4e86\u4e00\u4e2a\u66f4\u5c0f\u7684\u95ee\u9898\uff0c\u800c\u8fd9\u9898\u6211\u4eec\u9700\u8981\u628a\u6240\u6709\u7684 $k$ \u90fd\u6c42\u4e00\u904d\uff0c\u6240\u4ee5\u66f4\u5c0f\u7684\u95ee\u9898\u7684\u7b54\u6848\u6211\u4eec\u5df2\u7ecf\u6c42\u5f97\u4e86\uff0c\u4e8e\u662f\u76f4\u63a5\u9884\u5904\u7406\u7ea6\u6570\u7136\u540e\u4fee\u6b63\u53d8\u5316\u91cf\u5373\u53ef\u3002\n\n## code\n\n```cpp\n\n#include <bits/stdc++.h>\ntypedef long long ll;typedef unsigned long long ull; typedef double db;typedef long double ldb;\n#define fre(x) freopen(#x \".in\",\"r\",stdin),freopen(#x \".out\",\"w\",stdout)\n#define Rep(i,a,b) for(int i=a;i<=b;++i) \n#define Dwn(i,a,b) for(int i=a;i>=b;--i)\n#define pii pair<int,int>\n#define mair make_pair\n#define fir first\n#define sec second\nusing namespace std;\n\nconst int maxn=2e6+10,Mod=1e9+7;\n\nint pw(int x,int p){int res=1,base=x;while(p){if(p&1)res=1LL*res*base%Mod;base=1LL*base*base%Mod;p>>=1;}return res;}\nint Inv(int x){return pw(x,Mod-2);}\n\nint n,K;\nint f[maxn],p[maxn],ans;\nint res[maxn];\nvector<int>vec[maxn];\n\nvoid solve(){\n\tcin>>n>>K;\n\tRep(i,1,K)res[i]=pw(i,n);\n\tRep(i,2,K)for(int j=1;i*j<=K;++j)vec[i*j].push_back(i);\n\tint sum=0;\n\tRep(i,2,K){\n\t\tfor(auto it : vec[i])sum=(0LL+sum-res[(i-1)/it]+res[i/it]+Mod)%Mod;\n\t\tres[i]=(res[i]-sum+Mod)%Mod;\n\t}\n\tRep(i,1,K)ans=(ans+(res[i]^i))%Mod;\n\tcout<<ans<<\"\\n\";\n}\n\nint main (){ ios::sync_with_stdio(false),cin.tie(0),cout.tie(0);return solve(),0; }\n\n```",
        "postTime": 1663320580,
        "uid": 277792,
        "name": "Delov",
        "ccfLevel": 7,
        "title": "CF915G\u9898\u89e3"
    },
    {
        "content": "# Description\n\n\u82e5 $\\gcd(a_1,\\cdots,a_n)=1$\uff0c\u5219\u79f0\u6570\u5217 $a$ \u662f\u4e92\u8d28\u7684\u3002\n\n\u7ed9\u5b9a $n,k$\uff0c\u4ee4 $f(j)$ \u8868\u793a\u6ee1\u8db3 $\\forall i \\in [1,n],1 \\le a_i \\le j$ \u7684\u4e92\u8d28\u6570\u5217\u7684\u4e2a\u6570\uff0c\u8bd5\u6c42\u51fa $\\sum\\limits_{i=1}^k f(i) \\oplus i$\u3002\u7b54\u6848\u5bf9 $10^9+7$ \u53d6\u6a21\u3002\n\n$n,k \\le 2\\times 10^6$\uff0c\u65f6\u9650 3.5s\u3002\n\n# Solution\n\n\u600e\u4e48\u5168\u7f51\u7684\u505a\u6cd5\u90fd\u662f $\\mathcal O(n \\log n)$ \u7684\u554a\u3002\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e2a $\\mathcal O(n \\log \\log n)$ \u505a\u6cd5\u3002\u76ee\u524d\u5728 CF \u4e0a\u662f\u6700\u4f18\u89e3 rk1\u3002\n\n\u8003\u8651\u76f4\u63a5\u523b\u753b\u51fa $f(m)$ \u7684\u503c\uff0c\u4e0d\u96be\u53d1\u73b0\n\n$$\\begin{aligned}f(m)&=\\sum_{a_1 \\le m, \\cdots, a_n \\le m} [\\gcd(a_1,\\cdots,a_n)=1]\\\\&= \\sum_{d=1} ^m \\mu(d) \\left\\lfloor\\dfrac{m}{d}\\right\\rfloor^n\\end{aligned}$$\n\n\u5957\u8def\u5730\u5bf9\u5176\u8fdb\u884c\u5dee\u5206\u3002\u4f17\u6240\u5468\u77e5\uff0c\u89c2\u5bdf\u76f8\u90bb\u88ab\u9664\u6570\u5728\u5dee\u5206\u65f6\u7684\u8868\u73b0\uff0c\u6709\n\n$$\\left\\lfloor\\frac{n}{d}\\right\\rfloor \\neq \\left\\lfloor\\frac{n-1}{d}\\right\\rfloor \\Longleftrightarrow d | n$$\n\n\u4e14\u6b64\u65f6 $\\left\\lfloor\\dfrac{n-1}{d}\\right\\rfloor = \\left\\lfloor\\dfrac{n}{d}\\right\\rfloor-1$\u3002\n\n\u4e8e\u662f\u8fdb\u4e00\u6b65\u6709\n\n$$\\Delta f(m)=\\sum_{d |m} \\mu(d)S(\\frac{m}{d})$$\n\n\u5176\u4e2d $S(x)=x^n-(x-1)^n$\uff0c\u4f7f\u7528\u7ebf\u6027\u7b5b\u9884\u5904\u7406\u51fa $id_k$ \u51fd\u6570\u540e\u5c31\u53ef\u4ee5\u5feb\u901f\u6c42\u51fa\u3002\n\n\u53ef\u4ee5\u53d1\u73b0 $\\Delta f$ \u662f\u5bf9 $\\mu$ \u548c $S$ \u8fdb\u884c\u72c4\u5229\u514b\u96f7\u5377\u79ef\u5f97\u5230\u7684\u7ed3\u679c\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u6211\u4eec\u4f7f\u7528\u5feb\u901f\u5377\u79ef\u6027\u51fd\u6570\u7684\u5957\u8def\uff0c\u5c06\u79ef\u6027\u51fd\u6570 $\\mu$ \u5206\u89e3\u4e3a\u82e5\u5e72\u4e2a\u53ea\u4e0e\u8d28\u6570 $p$ \u6709\u5173\u7684\u51fd\u6570\u7684\u5377\u79ef\uff0c\u518d\u5c06\u8fd9\u4e9b\u51fd\u6570\u5206\u522b\u5377\u5230 $S$ \u4e0a\u53bb\uff0c\u5c31\u53ef\u4ee5\u5f97\u5230 $\\mathcal O(\\sum\\limits_p\\sum\\limits_{k=1}^{p^k\\le n} \\dfrac{n}{p^k})=\\mathcal O(n \\log \\log n)$ \u7684\u590d\u6742\u5ea6\u3002\n\n# Code\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N=2e6+5,mod=1e9+7;\nint n,K,tot,p[N],mu[N],id[N],f[N],t[N];\nbool vs[N];\nint add(int x,int y) {\n\treturn x+y<mod?x+y:x+y-mod;\n}\nint dec(int x,int y) {\n\treturn add(x,mod-y);\n}\nint Qpow(int x,int y) {\n\tint Mul=1;\n\twhile (y) {\n\t\tif (y&1) Mul=1ll*Mul*x%mod;\n\t\tx=1ll*x*x%mod,y>>=1;\n\t}\n\treturn Mul;\n}\nvoid Init(int n) {\n\tid[1]=mu[1]=1;\n\tfor (int i=2;i<=n;i++) {\n\t\tif (!vs[i]) {\n\t\t\tp[++tot]=i;\n\t\t\tmu[i]=-1;\n\t\t\tid[i]=Qpow(i,K);\n\t\t}\n\t\tfor (int j=1;j<=tot && 1ll*i*p[j]<=n;j++) {\n\t\t\tvs[i*p[j]]=1;\n\t\t\tid[i*p[j]]=1ll*id[i]*id[p[j]]%mod;\n\t\t\tif (!(i%p[j])) {\n\t\t\t\tmu[i*p[j]]=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmu[i*p[j]]=-mu[i];\n\t\t}\n\t}\n\tfor (int i=1;i<=n;i++) f[i]=dec(id[i],id[i-1]);\n}\nint main() {\n\tscanf(\"%d%d\",&K,&n);\n\tInit(n);\n\tfor (int i=1;i<=tot;i++) {\n\t\tfor (int j=1;1ll*p[i]*j<=n;j++) t[j]=f[j];\n\t\tfor (long long j=p[i];j<=n;j*=p[i])\n\t\t\tfor (int k=1;1ll*j*k<=n;k++) {\n\t\t\t\tif (mu[j]==1) f[j*k]=add(f[j*k],t[k]);\n\t\t\t\telse if (mu[j]==-1) f[j*k]=dec(f[j*k],t[k]); \n\t\t\t}\n\t}\n\tint s=0,Ans=0;\n\tfor (int i=1;i<=n;i++) {\n\t\ts=add(s,f[i]);\n\t\tAns=add(Ans,s^i);\n\t}\n\tprintf(\"%d\",Ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1659345682,
        "uid": 283913,
        "name": "ZillionX",
        "ccfLevel": 6,
        "title": "\u3010\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u3011CF915G Coprime Arrays"
    },
    {
        "content": "### \u9898\u610f\n\n- \u79f0\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u5217 $a$ \u662f\u4e92\u8d28\u7684\uff0c\u5f53\u4e14\u4ec5\u5f53 $\\gcd\\left(a_1,\\ldots,a_n\\right)=1$\u3002\n- \u7ed9\u5b9a $n,k$\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $j\\in[1,k]$\uff0c\u6ee1\u8db3 $\\forall i\\in[1,n],1\\le a_i\\le j$ \u7684\u4e92\u8d28\u6570\u5217\u7684\u4e2a\u6570 $b_j$\u3002\u5bf9 $10^9+7$ \u53d6\u6a21\u3002\u6700\u540e\u8f93\u51fa $\\displaystyle \\sum_{i=1}^k{b_i\\oplus{i}}$\uff0c\u518d\u5bf9 $10^9+7$ \u53d6\u6a21\u3002\n- $1\\le{n,k}\\le2\\times10^6$\u3002\n\n\n### \u505a\u6cd5\n\n####  update 2022.7.20\n\n\u63a8\u5f0f\u5b50\u90e8\u5206\u6709\u9519\uff0c\u611f\u8c22 [Alex10086](https://www.luogu.com.cn/user/110484) \u6307\u6b63\u3002\n\n\n------------\n\n\n\u5982\u679c\u60a8\u505a\u8fc7 [AT5310](www.luogu.com.cn/problem/AT5310) \u7684\u8bdd\uff0c\u5e94\u8be5\u5f88\u5feb\u5c31\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u7ed3\u679c\uff1a\n\n$\\begin{aligned}b_m&=\\sum_{a_1=1}^m\\sum_{a_2=1}^m\\cdots\\sum_{a_n=1}^m[\\gcd(a_1,a_2,\\ldots,a_n)=1]\\\\&=\\sum_{a_1=1}^m\\sum_{a_2=1}^m\\cdots\\sum_{a_n=1}^m\\sum_{d\\mid{\\gcd(a_1,a_2,\\ldots,a_n)}}\\mu(d)\\\\&=\\sum_{d=1}^{m}\\mu(d)\\sum_{a_1=1}^{\\left\\lfloor\\frac{m}d\\right\\rfloor}\\sum_{a_2=1}^{\\left\\lfloor\\frac{m}d\\right\\rfloor}\\cdots\\sum_{a_n=1}^{\\left\\lfloor\\frac{m}d\\right\\rfloor}1\\\\&=\\sum_{d=1}^m\\mu(d)\\left\\lfloor\\frac{m}d\\right\\rfloor^n \\end{aligned}$\n\n\u5982\u679c\u4f60\u5728\u8fd9\u91cc\u6574\u9664\u5206\u5757\u7684\u8bdd\uff0c\u4f1a $\\color{darkblue}\\text{TLE}$\u3002\u8fd9\u6837\u76f8\u5f53\u4e8e\u6bcf\u4e2a\u67e5\u8be2\u4e4b\u95f4\u90fd\u662f\u72ec\u7acb\u7684\uff0c\u663e\u7136\u6211\u4eec\u6ca1\u6709\u7528\u5230\u6211\u4eec\u6c42\u7684\u662f\u8fde\u7eed\u7684 $b_i$ \u8fd9\u4e00\u6761\u4ef6\u3002\n\n\u600e\u4e48\u53bb\u505a\u5462\uff1f\u89c2\u5bdf\u4e0a\u5f0f\u4e2d\u7684 $d$\u3002\n\n\u867d\u7136\u4e0d\u80fd\u76f4\u63a5\u6574\u9664\u5206\u5757\uff0c\u4f46\u662f\u5229\u7528\u6574\u9664\u5206\u5757\u7684\u6838\u5fc3\u601d\u60f3\uff0c **$\\left\\lfloor{\\dfrac{m}d}\\right\\rfloor$ \u662f\u4e00\u6bb5\u4e00\u6bb5\u5728\u53d8\u7684**\uff0c\u6240\u4ee5\u6211\u4eec\u6709\u4e00\u4e2a\u60f3\u6cd5\u5c31\u662f\u7528\u4e00\u4e2a\u5dee\u5206\u6570\u7ec4 $\\Delta{b_m}$ \u53bb\u505a\u5dee\u5206\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u56e0\u5b50 $d$\uff0c\u5b83\u53ea\u4f1a $m\\ge{d}$ \u7684 $b_m$ \u4ea7\u751f\u5f71\u54cd\uff0c\u800c\u4e14\u5f53\u4e14\u4ec5\u5f53 $d\\mid{m}$ \u65f6\uff0c\u5373 $m=xd$ \u65f6\uff0c$d$ \u5bf9 $b_m$ \u7684\u8d21\u732e\u624d\u4f1a\u6bd4 $b_{m-1}$ \u591a $\\mu(d)\\left({x^n}-{(x-1)}^n\\right)$\uff0c\u5426\u5219\u4e0d\u53d8\u3002\u6240\u4ee5\u6bcf\u4e00\u4e2a $d$ \u4f1a\u5f71\u54cd $\\dfrac{n}d$ \u4e2a\u4f4d\u7f6e\uff0c\u6211\u4eec\u679a\u4e3e\u6240\u6709\u7684 $d$\uff0c\u5c31\u53ef\u4ee5\u4e86\u3002\u6700\u7ec8\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n\\log{n})$\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define mod 1000000007\nusing namespace std;\nint n,k,cnt,prime[1000006];\nint p[2000006],mu[2000006],d[2000006];\nbitset<2000006>used;\ninline int read()\n{\n\tint x=0,f=1;char c=getchar();\n\twhile(c<'0'||c>'9'){if(c=='-')f=-f;c=getchar();}\n\twhile(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n\treturn x*f;\n}\ninline void sieve(int n)\n{\n\tmu[1]=1;\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tif(!used[i])\tprime[++cnt]=i,mu[i]=-1;\n\t\tfor(int j=1;j<=n&&1ll*i*prime[j]<=n;j++)\n\t\t{\n\t\t\tused[i*prime[j]]=1;\n\t\t\tif(i%prime[j])\tmu[i*prime[j]]=-mu[i];\n\t\t\telse\tbreak;\n\t\t}\n\t}\n} \ninline int f(int x,int y)\n{\n\tint res=1,p=x;\n\twhile(y)\n\t{\n\t\tif(y&1)\tres=1ll*res*p%mod;\n\t\tp=1ll*p*p%mod;y>>=1;\n\t}\n\treturn res;\n}\nint main()\n{\n\tn=read(),k=read();sieve(k);\n\tfor(int i=1;i<=k;i++)\tp[i]=f(i,n);\n\tfor(int i=1;i<=k;i++)\n\t\tfor(int j=i;j<=k;j+=i)\n\t\t\td[j]=(d[j]+1ll*mu[i]*(p[j/i]-p[j/i-1])%mod+mod)%mod;\n\tint ans=0,num=0;\n\tfor(int i=1;i<=k;i++)\tnum=(num+d[i])%mod,ans=(ans+(num^i))%mod;\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n\n```",
        "postTime": 1642762672,
        "uid": 181775,
        "name": "_Fontainebleau_",
        "ccfLevel": 0,
        "title": "\u300cCF915G Coprime Arrays\u300d"
    },
    {
        "content": "(\u4e0b\u6587\u4e2d $m$ \u4ee3\u8868\u539f\u9898\u9762\u4e2d\u7684 $k$ )\n\n\u8003\u8651\u50cf\u6837\u4f8b\u89e3\u91ca\u90a3\u6837\uff0c\u6c42\u51fa\u4e0d\u4e92\u8d28\u6570\u7ec4\u7684\u6570\u91cf\u3002\n\n\u6839\u636e\u9898\u610f\uff0c\u6bcf\u4e00\u4e2a\u4e0d\u4e92\u8d28\u6570\u7ec4\u5fc5\u7136\u6709\u5927\u4e8e $1$ \u7684\u516c\u56e0\u5b50\uff0c\u6240\u4ee5\u53ef\u4ee5\u8003\u8651\u679a\u4e3e\u8d28\u56e0\u5b50\u8ba1\u7b97\u8d21\u732e\u3002\n\n\u5047\u8bbe\u5f53\u524d\u679a\u4e3e\u5230\u4e86 $k$ \u8fd9\u4e2a\u516c\u56e0\u5b50\uff0c\u4e14\u5f53\u524d\u6570\u7ec4\u91cc\u7684\u6570\u6700\u5927\u4e3a $i$\uff0c\n\n\u90a3\u4e48\u6570\u7ec4\u91cc\u53ef\u9009\u7684\u6570\u5c31\u662f $k,2k,...,dk(dk\\leq m)$\uff0c\u5bb9\u6613\u53d1\u73b0 $d=\\lfloor\\frac {i}{k}\\rfloor$\n\n\u90a3\u4e48\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5373\u4e3a $d^n$\n\n\u4f46\u662f\u8981\u6ce8\u610f\u53bb\u91cd\uff0c\u6bd4\u5982\u516c\u56e0\u5b50\u4e3a $6$ \u7684\u65f6\u5019\uff0c\u4ed6\u5df2\u7ecf\u88ab $2$ \u548c $3$ \u7b97\u8fc7\u4e86\uff0c\u8981\u51cf\u53bb\u3002\n\n\u518d\u6bd4\u5982 $8$\uff0c\u4ed6\u5df2\u7ecf\u88ab $2$ \u7b97\u8fc7\u4e86\uff0c\u6240\u4ee5\u4e0d\u7528\u8ba1\u7b97\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u6bcf\u4e2a\u516c\u56e0\u5b50\u7684\u7cfb\u6570\u5c31\u662f\u5b83\u7684\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u503c\u3002\n\n\u4e8e\u662f\u53ef\u4ee5\u5217\u51fa\u5f0f\u5b50$b_i=i^n-\\sum\\limits_{k=1}^{i}\\mu_k\\lfloor\\frac {i}{k}\\rfloor^n$\n\n\u8fd9\u73a9\u610f\u663e\u7136\u4e0d\u80fd\u76f4\u63a5\u7b97\uff0c\u8003\u8651\u8ba1\u7b97\u6bcf\u4e2a $k$ \u5bf9\u6bcf\u4e2a $i$ \u7684\u8d21\u732e\n\n\u5bf9\u4e8e\u6bcf\u4e2a $k$\uff0c\u679a\u4e3e\u5b83\u7684\u6bcf\u4e2a $d$\uff0c\u4ee3\u8868\u5f53\u524d\u53ef\u4ee5\u9009 $k,2k,...,dk$ \u8fd9\u4e9b\u6570\n\n\u8fd9\u6837\u8ba1\u7b97\u51fa\u7684\u8d21\u732e\uff0c\u4ec5\u4ec5\u4f1a\u88ab\u8ba1\u7b97\u5728 $[dk,dk+k-1]$ \u8fd9\u4e2a\u533a\u95f4\n\n\u56e0\u6b64\u53ef\u4ee5\u4f7f\u7528\u5dee\u5206 $O(1)$ \u4fee\u6539\n\n\u9884\u5904\u7406\u5e42\u6b21\u540e\uff0c\u590d\u6742\u5ea6\u662f\u4e00\u4e2a\u8c03\u548c\u7ea7\u6570\uff0c\u4e3a $O(k\\ln k)$\n\nCode:\n```cpp\n#include <bits/stdc++.h>\n\ninline int read( ) {\n\tint x = 0;\n\tchar c = getchar( );\n\twhile ( !isdigit( c ) ) c = getchar( );\n\twhile ( isdigit( c ) ) x = ( x << 3 ) + ( x << 1 ) + ( c ^ 48 ), c = getchar( );\n\treturn x;\n}\nconst int N = 5e6 + 7, mo = 1e9 + 7;\nint n, m, b[ N ], notprime[ N ], prime[ N ], cnt, miu[ N ], cf[ N ];\nvoid mobius( ) {\n\tfor ( int i = 2; i <= 2000000; ++ i ) {\n\t\tif ( !notprime[ i ] ) miu[ i ] = 1, prime[ ++ cnt ] = i;\n\t\tfor ( int j = 1; j <= cnt && i * prime[ j ] <= 2000000; ++ j ) {\n\t\t\tnotprime[ i * prime[ j ] ] = -1;\n\t\t\tif ( i % prime[ j ] == 0 ) {\n\t\t\t\tmiu[ i * prime[ j ] ] = 0;\n\t\t\t\tbreak;\n\t\t\t} else\n\t\t\tmiu[ i * prime[ j ] ] = -miu[ i ];\n\t\t}\n\t}\n}\ninline int qp( int b, int p ) {\n\tint ret = 1;\n\twhile ( p ) {\n\t\tif ( p & 1 ) ret = 1ll * ret * b % mo;\n\t\tb = 1ll * b * b % mo;\n\t\tp >>= 1;\n\t}\n\treturn ret;\n}\ninline int reduce( int x ) { return x >= mo ? x - mo : x; }\nint main( ) {\n\tmobius( );\n\tn = read( ), m = read( );\n\tfor ( int k = 2; k <= m; ++ k ) {\n\t\tif ( miu[ k ] == 0 ) continue;\n\t\tfor ( int i = k; i <= m; i += k ) {\n\t\t\tint val = reduce( miu[ k ] * qp( i / k, n ) + mo );\n\t\t\tcf[ i ] = reduce( cf[ i ] + val );\n\t\t\tcf[ k + i ] = reduce( cf[ k + i ] - val + mo );\n\t\t}\n\t}\n\tfor ( int i = 1; i <= m; ++ i ) cf[ i ] = reduce( cf[ i - 1 ] + cf[ i ] );\n\tb[ 1 ] = 1;\n\tint ans = 0;\n\tfor ( int i = 2; i <= m; ++ i ) {\n\t\tb[ i ] = cf[ i ];\n\t\tans = reduce( ans + ( b[ i ] ^ i ) );\n\t}\n\tprintf( \"%d\\n\", ans );\n\treturn 0;\n}\n```\n",
        "postTime": 1618459673,
        "uid": 93286,
        "name": "Yuno",
        "ccfLevel": 6,
        "title": "CF915G Coprime Arrays"
    }
]
[
    {
        "content": "> \u80fd\u7528\u6811\u72b6\u6570\u7ec4\u4e3a\u4ec0\u4e48\u8fd8\u8981\u7528\u7ebf\u6bb5\u6811\u5462\uff1f\n\n\u8fd9\u662f\u4e00\u7bc7\u4e0d\u9700\u8981\u7ebf\u6bb5\u6811\u7684\u9898\u89e3\u3002\n\n\u8003\u8651\u4f18\u5316\u66b4\u529b\uff0c\u5bf9\u6bcf\u4e00\u4e2a\u6570\u5f00\u6876\uff0c\u5b58\u4e0b\u6765\u5b83\u6bcf\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0c\u628a $x$ \u7b2c\u4e00\u6b21\u548c\u6700\u540e\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\u7528 $l[x]$ \u548c $r[x]$ \u8868\u793a\u3002\n\n\u5f00\u4e00\u4e2a\u6811\u72b6\u6570\u7ec4\u6765\u6807\u8bb0\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u6570\u5b57\u662f\u5426\u8fd8\u5b58\u5728\uff0c\u4e00\u5f00\u59cb\u5168\u90e8\u8d4b\u503c\u4e3a $1$\u3002\n\n\u6309\u503c\u57df\u4ece\u5c0f\u5230\u5927\u904d\u5386\uff0c\u7528\u4e00\u4e2a\u53d8\u91cf $p$ \u6765\u4f5c\u4e3a\u6a21\u62df\u7684\u6307\u9488\uff0c\u5982\u679c\u5bf9\u4e8e\u4e00\u4e2a\u6570 $x$\uff1a\n\n- $p\\le l[x]$\n\n\u8bf4\u660e $p$ \u53ea\u9700\u8981\u63a5\u7740\u5411\u53f3\u79fb\u52a8\u5230 $r[x]$ \u5373\u53ef\uff0c\u8fd9\u4e00\u6b65\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5c31\u662f\u6811\u72b6\u6570\u7ec4\u4e0a\u67e5\u8be2 $p+1\\sim r[x]$\u3002\n\n- $p>l[x]$\n\n\u8bf4\u660e $p$ \u9700\u8981\u5411\u53f3\u4e00\u76f4\u8d70\u5230\u5e8f\u5217\u5c3e\uff0c\u518d\u4ece\u5934\u5f00\u59cb\u8d70\u5230 $x$ \u5728 $p$ \u4e4b\u524d\u51fa\u73b0\u7684\u6700\u540e\u4e00\u4e2a\u4f4d\u7f6e\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4e8c\u5206\u51fa\u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u8bb0\u4e3a $q$\uff0c\u90a3\u4e48 $p$ \u5e94\u8be5\u79fb\u52a8\u5230 $q$\uff0c\u8fd9\u4e00\u6b65\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5c31\u662f\u6811\u72b6\u6570\u7ec4\u4e0a\u67e5\u8be2 $p+1\\sim n$ \u518d\u52a0\u4e0a $1\\sim q$\u3002\n\n\u5904\u7406\u5b8c\u4e00\u4e2a\u6570\u5b57\u4e4b\u540e\uff0c\u5728\u6811\u72b6\u6570\u7ec4\u4e0a\u7ed9\u8fd9\u4e2a\u6570\u5b57\u7684\u6240\u6709\u51fa\u73b0\u4f4d\u7f6e\u90fd\u51cf\u4e00\u3002\n\n\u603b\u590d\u6742\u5ea6\uff08\u5c06\u503c\u57df\u4e0e $n$ \u89c6\u4e3a\u540c\u9636\uff09\uff1a$O(n\\log n)$\u3002\n\n\u6ce8\u610f\u4e00\u4e9b\u5c0f\u7ec6\u8282\uff0c\u5728\u4ee3\u7801\u4e2d\u5df2\u7ecf\u6807\u6ce8\u4e86\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nnamespace Acc{\n#define int long long\n#define id second\n\tconst int N=1e5+10;\n\tpair<int,int>a[N];\n\tint n,z=1,l[N],r[N],p=1,m;//z\u662f\u7b54\u6848\uff0c\u521d\u59cb\u4e3a 1 \u7684\u539f\u56e0\u662f\u6700\u540e\u4e00\u4e2a\u6570\u7684\u8d21\u732e\u6ca1\u6709\u7b97\n\tbasic_string<int>v[N];\n\tstruct BIT{\n\t\tint t[N];\n\t\tvoid add(int x,int k){for(int i=x;i<=n;i+=i&-i)t[i]+=k;}\n\t\tint pre(int x){int r=0;for(int i=x;i;i-=i&-i)r+=t[i];return r;}\n\t\tint ask(int l,int r){return l>r?0:pre(r)-pre(l-1);}\n\t\tvoid bd(){for(int i=1,j;i<=n;i++)if(t[i]++,(j=i+(i&-i))<=n)t[j]+=t[i];}//\u6811\u72b6\u6570\u7ec4O(n)\u5efa\u6811\uff0c\u867d\u7136\u6ca1\u4ec0\u4e48\u7528\n\t}t;\n\tvoid work(){\n\t\tcin>>n,t.bd(),memset(l,0x3f,sizeof l);\n\t\tfor(int i=1,x;i<=n;i++)cin>>x,a[i]={x,i},v[x]+=i,l[x]=min(l[x],i),r[x]=max(r[x],i),m=max(m,x);\n\t\tfor(int i=1,q;i<=m;i++)if(v[i].size()){\n\t\t\tif(sort(v[i].begin(),v[i].end()),p>l[i]){\n\t\t\t\tif((q=lower_bound(v[i].begin(),v[i].end(),p)-v[i].begin()))q--;//\u67e5\u524d\u9a71\u8bb0\u5f97\u7279\u5224\n\t\t\t\tz+=t.ask(p+1,n)+t.ask(1,v[i][q]),p=v[i][q];\n\t\t\t}else z+=t.ask(p+1,r[i]),p=r[i];\n\t\t\tfor(int j:v[i])t.add(j,-1);\n\t\t}\n\t\tcout<<z<<'\\n';\n\t}\n#undef int\n}\nint main(){\n\treturn Acc::work(),0;\n}\n```",
        "postTime": 1624004196,
        "uid": 383079,
        "name": "Acc_Robin",
        "ccfLevel": 6,
        "title": "CF830B Cards Sorting \u9898\u89e3"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://codeforces.com/problemset/problem/830/B)\n### \u9898\u610f\n\u4f60\u6709\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u4e2a\u961f\u5217\uff0c\u4f60\u6bcf\u6b21\u53d6\u51fa\u8fd9\u4e2a\u961f\u5217\u7684\u961f\u9996\uff0c\u5982\u679c\u8fd9\u4e2a\u6570\u662f\u961f\u5217\u4e2d\u6700\u5c0f\u7684\u6570\u90a3\u4e48\u5c31\u628a\u4ed6\u4e22\u6389\uff0c\u5426\u5219\u5c31\u653e\u5728\u961f\u5217\u7684\u961f\u5c3e\u3002\n### \u89e3\u9898\u65b9\u6cd5\n\u6211\u4eec\u9996\u5148\u5c31\u60f3\u5230\u4e86\u66b4\u529b\u7684\u505a\u6cd5\uff0c\u6bcf\u6b21\u679a\u4e3e\u7b2c\u4e00\u4e2a\u7136\u540e\u6254\u5230\u540e\u9762\u53bb\uff0c\u590d\u6742\u5ea6\u662f$o(n^2)$\u7684\uff0c\u53d1\u73b0\u6839\u672c\u8fc7\u4e0d\u4e86\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u8981\u60f3\u5230\u4e00\u4e9b\u4f18\u5316\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u961f\u5217\u5c31\u548c\u4e00\u4e2a\u73af\u4e00\u6837\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u628a\u539f\u6765\u7684$a$\u6570\u7ec4\u590d\u5236\u4e00\u904d\uff0c\u56e0\u4e3a\u6211\u4eec\u6bcf\u6b21\u53d6\u51fa\u4e0b\u4e00\u4e2a\u88ab\u6254\u8d70\u7684\u6570\u4e00\u5b9a\u662f\u5728$[last+1,last+n-1]$\u8fd9\u4e2a\u533a\u95f4\u5185\u7684\uff0c\u6211\u4eec\u5c31\u5c31\u53ef\u4ee5\u76f4\u63a5\u7528\u7ebf\u6bb5\u6811\u6c42\u51fa\u8fd9\u4e2a\u6700\u5c0f\u503c\u5f97\u4f4d\u7f6e\u5c31\u53ef\u4ee5\u4e86\uff0c\u53d6\u51fa\u8fd9\u4e2a\u6570\u4ee5\u540e\u5c31\u628a\u8fd9\u4e2a\u4f4d\u7f6e\u548c\u4f4d\u7f6e$+n$\u7684\u503c\u90fd\u53d8\u6210\u4e00\u4e2a\u5f88\u5927\u6570\uff0c\u7136\u540e\u6211\u4eec\u8be5\u600e\u4e48\u6837\u7edf\u8ba1\u7b54\u6848\u5462\uff1f\u7b54\u6848\u4e0d\u80fd\u662f\u7b80\u5355\u7684\u73b0\u5728\u7684\u4f4d\u7f6e\u51cf\u53bb\u4e0a\u53bb\u7684\u4f4d\u7f6e\uff0c\u56e0\u4e3a\u5f53\u4e2d\u6709\u4e9b\u6570\u5df2\u7ecf\u88ab\u6254\u51fa\u53bb\u4e86\uff0c\u4e0d\u80fd\u518d\u91cd\u590d\u8ba1\u6570\u4e86\uff0c\u6211\u4eec\u5c31\u518d\u5f00\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\uff0c\u67e5\u8be2$[last+1,now-1]$\u4e2d\u6709\u591a\u5c11\u6570\u5df2\u7ecf\u51fa\u53bb\u4e86\uff0c\u5bf9\u4e8e\u6bcf\u6b21\u6254\u51fa\u53bb\u7684\u6570\u6211\u4eec\u5728\u90a3\u4e2a\u4f4d\u7f6e\u548c\u90a3\u4e2a\u4f4d\u7f6e$+n$\u7684\u5730\u65b9\u90fd\u53d8\u62101\uff0c\u5c31\u53ef\u4ee5\u89e3\u51b3\u4e86\u3002\n### \u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nint a[200500];\nint n;\nstruct node\n{\n\tint l,r;\n\tint minn,pos;\n\tfriend node operator + (node x,node y)\n\t{\n\t\tnode lans;\n\t\tif(x.minn<=y.minn)\n\t\t{\n\t\t\tlans.minn=x.minn;\n\t\t\tlans.pos=x.pos;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlans.minn=y.minn;\n\t\t\tlans.pos=y.pos;\n\t\t}\n\t\treturn lans;\n\t} \n}t[200500<<2];\nvoid pushup(int rt)\n{\n\tif(t[rt<<1].minn<=t[rt<<1|1].minn)\n\t{\n\t\tt[rt].minn=t[rt<<1].minn;\n\t\tt[rt].pos=t[rt<<1].pos;\n\t}\n\telse\n\t{\n\t\tt[rt].minn=t[rt<<1|1].minn;\n\t\tt[rt].pos=t[rt<<1|1].pos;\n\t}\n}\nvoid build(int rt,int l,int r)\n{\n\tt[rt].l=l;\n\tt[rt].r=r;\n\tif(l==r)\n\t{\n\t\tt[rt].minn=a[l];\n\t\tt[rt].pos=l;\n\t\treturn;\n\t}\n\tint mid=l+r>>1;\n\tbuild(rt<<1,l,mid);\n\tbuild(rt<<1|1,mid+1,r);\n\tpushup(rt);\n\treturn;\n}\nvoid change(int rt,int x,int d)\n{\n\tif(t[rt].l==t[rt].r&&t[rt].l==x)\n\t{\n\t\tt[rt].minn=d;\n\t\treturn;\n\t}\n\tint mid=t[rt].l+t[rt].r>>1;\n\tif(x<=mid)change(rt<<1,x,d);\n\telse change(rt<<1|1,x,d);\n\tpushup(rt);\n}\nnode query(int rt,int l,int r)\n{\n\tif(t[rt].l>=l&&t[rt].r<=r)\n\t{\n\t\tnode lans;\n\t\tlans.minn=t[rt].minn;\n\t\tlans.pos=t[rt].pos;\n\t\treturn lans;\n\t}\n\tint mid=t[rt].l+t[rt].r>>1;\n\tnode lans;\n\tif(l<=mid)\n\t{\n\t\tlans=query(rt<<1,l,r);\n\t\tif(mid<r)\n\t\t  lans=lans+query(rt<<1|1,l,r);\n\t}\n\telse\n\t{\n\t\tif(mid<r)\n\t\t  lans=query(rt<<1|1,l,r);\n\t}\n\treturn lans;\n}\nint c[1000000];\nint lowbit(int x)\n{\n\treturn x&(-x);\n} \nint update(int x,int v)\n{\n\twhile(x<=2*n)\n\t{\n\t\tc[x]+=v;\n\t\tx+=lowbit(x);\n\t}\n}\nint sum(int x)\n{\n\tint res=0;\n\twhile(x>0)\n\t{\n\t\tres+=c[x];\n\t\tx-=lowbit(x);\n\t}\n\treturn res;\n} \nint main()\n{\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++)\n\t  scanf(\"%d\",&a[i]),a[n+i]=a[i];\n\tbuild(1,1,2*n);\n\tint last=0;\n\tlong long ans=0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tnode lans;\n\t\tif(i==1)\n\t\t{\n\t\t\tlans=query(1,1,n);\n\t\t}\n\t\telse \n\t \t    lans=query(1,last+1,n+last-1);\n\t \tint x=lans.pos;\n\t \tans+=x-last-(sum(x)-sum(last));\n\t \tif(x>n)last=x-n;else last=x;\n\t \tchange(1,last,1e7);change(1,last+n,1e7);\n\t \tupdate(last,1);update(last+n,1);\n\t}\n\tcout<<ans<<'\\n';\n\treturn 0;\n}\n```\n",
        "postTime": 1571980845,
        "uid": 9169,
        "name": "C_Zn",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF830B \u3010Cards Sorting\u3011"
    },
    {
        "content": "\u770b\u5230\u5927\u5bb6\u90fd\u662f\u6570\u636e\u7ed3\u6784\u7684\u505a\u6cd5\uff0c\u90a3\u6211\u5c31\u6765\u7bc7\u4e0d\u4e00\u6837\u7684\u5427\u3002\n\n\u6211\u4eec\u89c2\u5bdf\u5230 $a_i\\leq 10^5$\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e8e\u6240\u6709\u503c\u8bb0\u5f55\u4e0b\u5176\u5728 $a$ \u4e2d\u51fa\u73b0\u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u4ece\u5c0f\u5230\u5927\u679a\u4e3e\u6570\u503c\u8fdb\u884c\u66b4\u529b\u8df3\u4f4d\u7f6e\u4ee5\u53ca\u8fd0\u7b97\u3002\u5177\u4f53\u5b9e\u73b0\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528**\u94fe\u8868**\u6216\u8005 **set**\u3002\u65f6\u95f4\u590d\u6742\u5ea6\uff1a\u91c7\u7528\u94fe\u8868\u7684\u8bdd\u662f $O(n)$ \u7684\uff0c**set** \u662f $O(n\\log n)$ \u7684\u3002\u8fd9\u91cc\u6211\u4eec\u91c7\u7528 **set**\uff08\u6bd5\u7adf\u5199\u5199\u65b9\u4fbf\u4e0d\u662f\u4e48\uff09\u3002\u8be6\u7ec6\u8bf7\u89c1\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,a[100010];\nset<int>S[100010];//\u5f001e5\u4e2aset\u5b58\u4e0b\u6bcf\u4e2a\u503c\u51fa\u73b0\u7684\u4f4d\u7f6e\nset<int>::iterator it;//\u6307\u9488\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%d\",&a[i]);\n\t\tS[a[i]].insert(i);//\u63d2\u5165\u4f4d\u7f6e\n\t}\n\tsort(a+1,a+n+1);//\u5c06\u6570\u503c\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u514d\u53bb\u679a\u4e3e\u65e0\u503c\u7684set\n\tint p=1;long long ans=n;//p\u8bb0\u5f55\u5f53\u524d\u5728a\u4e2d\u7684\u4f4d\u7f6e\n\tfor(int i=1;i<=n;i++){\n\t\tit=S[a[i]].lower_bound(p);//\u4e8c\u5206\u67e5\u627e\u5f53\u524d\u6570\u503c\u7b2c\u4e00\u4e2a\u51fa\u73b0\u5728p\u4e4b\u540e\u7684\u4f4d\u7f6e\n\t\tif(it==S[a[i]].end())ans+=n-i+1,p=1,it=S[a[i]].lower_bound(p);//\u5982\u679c\u5f53\u524d\u6570\u503c\u5df2\u7ecf\u6ca1\u6709\u5728p\u4e4b\u540e\u7684\uff0c\u5c31\u4ece\u5934\u91cd\u65b0\u627e\n\t\tp=*it,S[a[i]].erase(it);\n\t}\n\tprintf(\"%lld\",ans);\n\treturn 0;\n} \n```\n\n\n",
        "postTime": 1629467555,
        "uid": 120010,
        "name": "CaiXY06",
        "ccfLevel": 6,
        "title": "solution-cf830b"
    },
    {
        "content": "\u667a\u5546\u4e0d\u591f\uff0cDS \u6765\u51d1\u3002\n\n\u89c2\u5bdf\u6211\u4eec\u7684\u64cd\u4f5c\uff1a\u82e5\u4e0d\u4e3a\u5168\u5c40\u6700\u5c0f\u503c\uff0c\u90a3\u4e48\u653e\u5230\u5e8f\u5217\u672b\u5c3e\uff1b\u82e5\u4e3a\u5168\u5c40\u6700\u5c0f\u503c\uff0c\u90a3\u4e48\u5220\u53bb\u3002\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u8fd9\u4e2a\u64cd\u4f5c\u53ef\u4ee5\u7b49\u4ef7\u4e8e\u627e\u5230\u7b2c\u4e00\u4e2a\u5168\u5c40\u6700\u5c0f\u503c\uff0c\u5220\u6389\u8fd9\u4e2a\u4f4d\u7f6e\u5e76\u628a\u524d\u9762\u7684\u5e8f\u5217\u653e\u5230\u6700\u540e\uff0c\u4ee3\u4ef7\u4e3a\u8fd9\u4e2a\u6700\u5c0f\u503c\u5728\u5f53\u524d\u5e8f\u5217\u4e2d\u7684\u4e0b\u6807\u3002\n\n\u627e\u6700\u5c0f\u548c\u5220\u9664\u662f\u975e\u5e38\u597d\u641e\u7684\uff0c\u6bd4\u8f83\u96be\u5904\u7406\u7684\u662f\u5e8f\u5217\u79fb\u52a8\u548c\u7edf\u8ba1\u8d21\u732e\u3002\n\n\u6b63\u5e38\u4e00\u70b9\u7684\u505a\u6cd5\u662f\u5e8f\u5217\u590d\u5236\u540e\u7ebf\u6bb5\u6811\u7ef4\u62a4\uff0c\u4f46\u6bd5\u7adf\u8fd8\u662f\u6709\u4e9b\u7ec6\u8282\u7684\uff0c\u8111\u5b50\u4e0d\u591f\u3002\n\n\u53c8\u521a\u597d\u662f\u5e8f\u5217\u64cd\u4f5c\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u59a8 splay \u7ef4\u62a4\u5e8f\u5217\u3002\u5bf9\u6bcf\u4e2a\u70b9\uff0c\u7ef4\u62a4\u5176\u5b50\u6811\u5927\u5c0f\u548c\u5b50\u6811\u4e2d\uff0c\u6700\u5c0f\u503c\u4f4d\u7f6e\u5bf9\u5e94\u7684\u6700\u5c0f\u7684\u8282\u70b9\u7f16\u53f7\u3002\n\n\u8fd9\u6837\u627e\u6700\u5c0f\u3001\u7edf\u8ba1\u8d21\u732e\u5c31\u5f88\u663e\u7136\u4e86\uff0c\u4e00\u4e2a\u662f\u6839\u8282\u70b9\u4fe1\u606f\u4e00\u4e2a\u662f\u6392\u540d\u3002\n\n\u8003\u8651\u79fb\u52a8\u64cd\u4f5c\uff0c\u5047\u8bbe\u6700\u5c0f\u503c\u4f4d\u7f6e\u4e3a $x$\u3002\n\n\u5148\u628a $x$ \u8f6c\u5230\u6839\u8282\u70b9\uff0c\u90a3\u4e48\u6839\u636e\u4e2d\u5e8f\u904d\u5386\u7684\u6027\u8d28\u53ef\u77e5\uff0c\u5de6\u5b50\u6811\u5c31\u662f $x$ \u524d\u7684\u5e8f\u5217\u3002\u4ece\u6839\u4e00\u76f4\u5f80\u53f3\u8df3\u76f4\u81f3\u67d0\u4e2a\u70b9\u53f3\u5b50\u8282\u70b9\u4e3a\u7a7a\uff0c\u76f4\u63a5\u628a\u6574\u4e2a\u6811\u63a5\u5230\u8fd9\u4e2a\u70b9\u7684\u53f3\u513f\u5b50\u4e0a\u5c31\u884c\u3002\n\n\u518d\u8003\u8651\u5220\u9664\uff0c\u6b64\u65f6\u6839\u8282\u70b9\u5df2\u7ecf\u6ca1\u6709\u5de6\u5b50\u6811\u4e86\uff0c\u76f4\u63a5\u628a\u6839\u8282\u70b9\u53d8\u6210\u5b83\u7684\u53f3\u513f\u5b50\u5c31\u884c\u3002\n\n```cpp\n#include<cstdio>\n#define ls(x) tre[x].son[0]\n#define rs(x) tre[x].son[1]\nint n,rt,cnt,a[100001];\nlong long res;\nstruct splay{\n\tint son[2],fa;\n\tint sz,ps;\n}tre[100001];\nbool fx(int x){\n\treturn rs(tre[x].fa)==x;\n}\nvoid pushup(int x){\n\ttre[x].sz=tre[ls(x)].sz+tre[rs(x)].sz+1;\n\ttre[x].ps=x;\n\tif(a[tre[ls(x)].ps]<=a[x])tre[x].ps=tre[ls(x)].ps;\n\tif(a[tre[rs(x)].ps]<a[tre[x].ps])tre[x].ps=tre[rs(x)].ps;\n}\nvoid rotate(int x){\n\tint y=tre[x].fa,z=tre[y].fa,p=fx(x)^1;\n\tif(z)tre[z].son[fx(y)]=x;\n\ttre[tre[x].son[p]].fa=y;\n\ttre[y].fa=x;\n\ttre[x].fa=z;\n\ttre[y].son[p^1]=tre[x].son[p];\n\ttre[x].son[p]=y;\n\tpushup(y);\n\tpushup(x);\n}\nvoid splay(int x,int to){\n\twhile(tre[x].fa!=to){\n\t\tint y=tre[x].fa,z=tre[y].fa;\n\t\tif(z)fx(x)==fx(y)?rotate(y):rotate(x);\n\t\trotate(x);\n\t}\n\tif(!to)rt=x;\n}\nvoid insert(){\n\tif(!rt){\n\t\trt=++cnt;\n\t\ttre[1].sz=1;\n\t\ttre[1].ps=1;\n\t\treturn;\n\t}\n\tint x=rt,k=++cnt;\n\twhile(rs(x))x=rs(x);\n\ttre[k].fa=x;\n\ttre[x].son[1]=k;\n\tpushup(k);pushup(x);\n\tsplay(k,0);\n}\nvoid del(int x){\n\tsplay(x,0);\n\tres+=tre[ls(x)].sz+1;\n\tif(!rs(x)){\n\t\ttre[ls(x)].fa=0;\n\t\trt=ls(x);\n\t\tpushup(rt);\n\t\treturn;\n\t}\n\tint k=x;\n\twhile(rs(k))k=rs(k);\n\trs(k)=ls(x);\n\ttre[ls(x)].fa=k;\n\tpushup(k);\n\ttre[rs(x)].fa=0;\n\trt=tre[rs(x)].fa;\n\tsplay(k,0);\n}\nint main(){\n\tint i,n;\n\tscanf(\"%d\",&n);\n\ta[0]=998244353;\n\tfor(i=1;i<=n;i++)scanf(\"%d\",&a[i]),insert();\n\tfor(i=1;i<=n;i++)del(tre[rt].ps);\n\tprintf(\"%lld\",res);\n}\n```",
        "postTime": 1674218001,
        "uid": 128606,
        "name": "2018ljw",
        "ccfLevel": 7,
        "title": "CF830B \u9898\u89e3"
    }
]
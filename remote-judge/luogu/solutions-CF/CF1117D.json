[
    {
        "content": "\u5c31\u662f\u4e00\u4e9b\u8f6c\u79fb\u5f0f\uff0c\u7528\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u9996\u5148\uff0c\u5b9a\u4e49\u77e9\u9635\u4e58\u6cd5\uff1a\n\n\u5bf9\u4e8e\u4e00\u4e2a $n\\times k$ \u7684\u77e9\u9635 $A$ \u548c\u4e00\u4e2a $k\\times m$ \u7684\u77e9\u9635 $B$ \u8fd8\u6709\u4e00\u4e2a\u77e9\u9635 $C=A\\times B$\u3002\u90a3\u4e48 $C$ \u662f\u4e00\u4e2a $n\\times m$ \u7684\u77e9\u9635\uff0c\u4e14 $C_{ij}=\\sum\\limits_{p=1}^kA_{i,p}\\times B_{p,j}(i=\\overline{1,2,\\cdots,n},j=\\overline{1,2,\\cdots,m})$\u3002\n\n\u7136\u540e\uff0c\u56e0\u4e3a\u77e9\u9635\u4e58\u6cd5\u6ee1\u8db3\u7ed3\u5408\u5f8b\uff0c\u6240\u4ee5\u6211\u4eec\u6709\u4e86\u77e9\u9635\u5feb\u901f\u5e42\u3002\u77e9\u9635\u5feb\u901f\u5e42\u7684\u8bdd\u5c31\u662f\u628a\u5feb\u901f\u5e42\u7684\u677f\u5b50\u5957\u5728\u77e9\u9635\u4e0a\u800c\u5df2\u3002\n\n## \u9898\u76ee\n\n$$f_i=1(i<m)$$\n$$f_i=f_{i-1}+f_{i-m}(m\\le i)$$\n\n\u6c42 $f_n$\u3002\n\n\u7528\u4e00\u4e2a $m\\times m$ \u7684\u77e9\u9635\u5c31\u53ef\u4ee5\u4e86\u3002\n\n$$\\begin{pmatrix}f_{i+1}+f_{i-m+1}\\\\f_{i}\\\\f_{i-1}\\\\\\vdots\\\\f_{i-m+1}\\end{pmatrix}=\\begin{pmatrix}1&0&0&\\cdots&0&0&1\\\\1&0&0&\\cdots&0&0&0\\\\0&1&0&\\cdots&0&0&0\\\\\\vdots&&&\\ddots&&&\\vdots\\\\0&0&0&\\cdots&0&1&0\\end{pmatrix}\\begin{pmatrix}f_i\\\\f_{i-1}\\\\f_{i-2}\\\\\\vdots\\\\f_{i-m}\\end{pmatrix}$$\n\n\u4ee3\u7801\uff1a\n```cpp\n  #include<bits/stdc++.h>\n  #define int long long\n  using namespace std;\n  const int mod=1e9+7;\n  int n,m,sum;\n  struct M{\n      int a[100][100];\n      M operator*(M t){\n          M res;\n          for(int i=0;i<m;i++)for(int j=0;j<m;j++)res.a[i][j]=0;\n          for(int i=0;i<m;i++){\n              for(int j=0;j<m;j++){\n                  for(int k=0;k<m;k++){\n                      res.a[i][j]=((res.a[i][j]+a[i][k]*t.a[k][j]%mod+mod)%mod+mod)%mod;\n                  }\n              }\n          }\n          return res;\n      }\n      M operator^(int x){\n          M res,_=*this;\n          for(int i=0;i<m;i++)for(int j=0;j<m;j++)res.a[i][j]=(i==j);\n          while(x){\n              if(x&1)res=res*_;\n              _=_*_;\n              x>>=1; \n          }\n          return res;\n      }\n  }ans,base;\n  signed main()\n  {\n      scanf(\"%lld%lld\",&n,&m);\n      if(n<m)puts(\"1\");\n      else{\n          for(int i=0;i<m;i++)for(int j=0;j<m;j++)ans.a[i][j]=(!j);\n          for(int i=0;i<m;i++)for(int j=0;j<m;j++)base.a[i][j]=0;//\u8bbe\u7f6e\u77e9\u9635\n          for(int i=1;i<m;i++)base.a[i][i-1]=1;\n          base.a[0][0]=base.a[0][m-1]=1;\n          ans=(base^(n-m+1))*ans;\n          printf(\"%lld\",ans.a[0][0]);\n      }\n      return 0;\n  }\n```",
        "postTime": 1660715781,
        "uid": 428358,
        "name": "cqbztzl",
        "ccfLevel": 5,
        "title": "CF1117D\u9898\u89e3"
    },
    {
        "content": "# CF1117D Magic Gems \u9898\u89e3\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF1117D)\n\n## \u9898\u610f\u7b80\u8ff0\n\n\u7ed9\u5b9a\u6b63\u6574\u6570 $n, m$\uff0c\u5bfb\u627e\u4e00\u4e2a $\\texttt{01}$ \u4e32 $s$\uff0c\u8bb0\u4e32\u4e2d $\\texttt 0$ \u7684\u6570\u76ee\u4e3a $p$\uff0c$\\texttt 1$ \u7684\u6570\u76ee\u4e3a $q$\uff0c\u4f7f\u5f97 $p + mq = n$\u3002\n\n\u6c42\u7b26\u5408\u6761\u4ef6\u7684 $s$ \u7684\u4e2a\u6570\u6a21 $10^9+7$ \u7684\u503c\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1 \\le n \\le 10^{18}$\uff0c$2 \\le m \\le 100$\u3002\n\n## \u524d\u7f6e\u77e5\u8bc6\uff1a\n\n- \u57fa\u7840 DP\n\n- \u77e9\u9635\u5feb\u901f\u5e42\n\n    - \u6a21\u677f\u9898\u76ee\uff1a[P1939 \u3010\u6a21\u677f\u3011\u77e9\u9635\u52a0\u901f\uff08\u6570\u5217\uff09](https://www.luogu.com.cn/problem/P1939)\n\n    - \u7ec3\u4e60\u9898\uff1a[P1349 \u5e7f\u4e49\u6590\u6ce2\u90a3\u5951\u6570\u5217](https://www.luogu.com.cn/problem/P1349)\n\n\u8bf7\u786e\u4fdd\u4f60\u5df2\u7ecf\u7406\u89e3\u4e86**\u77e9\u9635\u4e58\u6cd5\u7684\u5177\u4f53\u539f\u7406**\u4ee5\u53ca**\u9012\u63a8\u77e9\u9635\u7684\u6784\u9020**\u3002\n\n## \u89e3\u6cd5\n\n\u53ef\u4ee5\u7528 DP \u6765\u505a\u3002\n\n\u8bbe $f_i$ \u4e3a\u7b26\u5408 $p + mq = i$ \u7684 $s$ \u7684\u6570\u76ee\u3002\n\n\u56e0\u4e3a\n\n- \u8981\u4e48\u4ece\u5c11\u4e00\u4e2a $\\texttt 0$ \u8f6c\u79fb\u800c\u6765\uff08$f_{i-1}$\uff09\n\n- \u8981\u4e48\u4ece\u5c11\u4e00\u4e2a $\\texttt 1$ \u8f6c\u79fb\u800c\u6765\uff08$f_{i-m}$\uff09\n\n$$\nf_i =\n\\begin{cases}\n1                 & i  <  m \\\\\nf_{i-1} + f_{i-m} & i \\ge m\n\\end{cases}\n$$\n\n\u76f4\u63a5\u505a\u8fd9\u4e2a DP \u7684\u8bdd\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n)$\uff0c\u53d1\u73b0 $n \\le 10^{18}$\uff0c\u8fc7\u4e0d\u53bb\uff08\u60b2\uff09\u3002\n\n\u6ce8\u610f\u5230\u8fd9\u662f\u4e00\u4e2a\u9012\u63a8\u7684 DP\uff0c\u8003\u8651\u4f7f\u7528\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\u3002\n\n\u5bb9\u6613\u6784\u9020\u51fa\u4ee5\u4e0b\u77e9\u9635\uff1a\n\n$$\n\\begin{bmatrix}\nf_i       \\\\\nf_{i-1}   \\\\\n\\vdots    \\\\\nf_{i-m+1} \\\\\nf_{i-m}\n\\end{bmatrix}\n\n=\n\n\\begin{bmatrix}\n1 &   &        &   &   & 1 \\\\\n1 &   &        &   &   &   \\\\\n  & 1 &        &   &   &   \\\\\n  &   & \\ddots &   &   &   \\\\\n  &   &        & 1 &   &   \\\\\n  &   &        &   & 1 &   \\\\\n\\end{bmatrix}\n\n\\begin{bmatrix}\nf_{i-1}   \\\\\nf_{i-2}   \\\\\n\\vdots    \\\\\nf_{i-m}   \\\\\nf_{i-m-1}\n\\end{bmatrix}\n$$\n\n\u5176\u4e2d\u5927\u65b9\u9635\u4e3a $m \\times m$ \u7684\u77e9\u9635\u3002\n\n\u53ef\u4ee5\u505a\u77e9\u9635\u5feb\u901f\u5e42\u3002\u6700\u7ec8\u65f6\u95f4\u590d\u6742\u5ea6 $O(m^3\\log n)$\u3002\n\n\u77e9\u9635\u6784\u9020\uff1a\uff08\u4e0b\u6807\u4ece $1$ \u5f00\u59cb\uff09\n\n```cpp\nA.M[1][1] = 1; A.M[1][m] = 1;\nfor (int i = 2; i <= m; i++)\n    A.M[i][i - 1] = 1;\n```\n\n\u5b8c\u6574\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\n\n// \u7701\u7565\u5feb\u8bfb\u5feb\u5199\u7684\u5b9e\u73b0\n\nconst int MAXN = 105;\nconst int MOD = 1e9 + 7;\nint L;\nstruct Matrix {\n    LL M[MAXN][MAXN];\n    void clear() {\n        memset(M, 0, sizeof(M));\n    }\n    void reset() {\n        clear();\n        for (int i = 1; i <= L; i++)\n            M[i][i] = 1;\n    }\n    Matrix friend operator* (const Matrix &A, const Matrix &B) {\n        Matrix Ans; Ans.clear();\n        for (int i = 1; i <= L; i++)\n            for (int k = 1; k <= L; k++)\n                for (int j = 1; j <= L; j++)\n                    Ans.M[i][j] = (Ans.M[i][j] + A.M[i][k] * B.M[k][j]) % MOD;\n        return Ans;\n    }\n};\nMatrix expow(Matrix T, LL k) {\n    Matrix Ans; Ans.reset();\n    while (k) {\n        if (k & 1)\n            Ans = Ans * T;\n        T = T * T, k >>= 1;\n    }\n    return Ans;\n}\n\nLL n, m, ans;\nint main() {\n    n = read(); m = read();\n\n    if (n < m)\n        ans = 1;\n    else {\n        L = m;\n        Matrix A; A.clear();\n        A.M[1][1] = 1; A.M[1][m] = 1;\n        for (int i = 2; i <= m; i++)\n            A.M[i][i - 1] = 1;\n\n        ans = expow(A, n).M[1][1];\n    }\n\n    write(ans, '\\n');\n    return 0;\n}\n```\n\n## \u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316 DP \u7684\u7ec3\u4e60\u9898\n\n[P4910 \u5e15\u79cb\u8389\u7684\u624b\u73af](https://www.luogu.com.cn/problem/P4910)",
        "postTime": 1681630517,
        "uid": 589916,
        "name": "August_Light",
        "ccfLevel": 0,
        "title": "CF1117D Magic Gems \u9898\u89e3"
    },
    {
        "content": "## \u505a\u6cd5\n\u672c\u9898\u77e9\u9635\u5feb\u901f\u5e42\u52a0\u901f\u597d\u9898\u3002\n\n$n\\leq 10^{18}$ \u663e\u7136\u9700\u8981 $\\log$ \u7ea7\u522b\u7684\u7b97\u6cd5\u3002\u6211\u4eec\u5148\u8003\u8651\u4e00\u4e2a\u6734\u7d20\u7684 DP\uff1a\u8bbe $f_i$ \u4e3a\u521a\u597d\u5360\u636e $i$ \u7a7a\u95f4\u7684\u65b9\u6848\u6570\u3002\n\n\u663e\u7136\uff0c\u8f6c\u79fb\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\u5982\u679c\u662f\u666e\u901a\u5b9d\u77f3\u6216\u672a\u62c6\u5f00\u7684\u9b54\u6cd5\u5b9d\u77f3\uff0c\u5360\u636e\u7a7a\u95f4\u4e3a $1$\uff0c$f_i\\leftarrow f_i+f_{i-1}$\u3002\n\n\u5982\u679c\u662f\u62c6\u5f00\u7684\u9b54\u6cd5\u5b9d\u77f3\uff0c\u5360\u636e\u7a7a\u95f4\u4e3a $m$\uff0c$f_i\\leftarrow f_i+f_{i-m}$\u3002\n\n\u6240\u4ee5\u6700\u540e\u5c31\u662f $f_i=f_{i-1}+f_{i-m}$\u3002\n\n\u4f46\u662f\u8fd9\u4e2a\u662f $O(n)$ \u7684\uff0c\u6211\u4eec\u9700\u8981\u77e9\u9635\u4f18\u5316\u3002\n\n\u6ce8\u610f\u5230\u5b83\u6d89\u53ca\u5230\u524d $m$ \u4e2a\u4f4d\u7f6e\u7684\u5143\u7d20\uff0c\u6240\u4ee5\u6211\u4eec\u5f00\u4e00\u4e2a $m\\times m$ \u7684\u77e9\u9635\u3002\n\n\u4e00\u5f00\u59cb\uff0c\u6211\u4eec\u662f $\\lbrack f_i,f_{i-1},\\cdots,f_{i-m+1} \\rbrack$\u3002\n\n\u8003\u8651\u4e00\u6b21\u4e58\u6cd5\u600e\u4e48\u4e58\u8fc7\u53bb\u3002\u5bb9\u6613\u53d1\u73b0\uff0c\u5f53 $m=2$ \u65f6\uff0c\u77e9\u9635\u662f\uff1a\n\n$\\begin{bmatrix}\n1 & 1\\\\\n1 & 0\n\\end{bmatrix}$\n\n\u5f53 $n=3$ \u65f6\uff0c\u77e9\u9635\u4e3a\uff1a\n\n$\\begin{bmatrix}\n1 & 1 & 0\\\\\n0 & 0 & 1\\\\\n1 & 0 & 0\n\\end{bmatrix}$\n\n\u5f53 $n=4$ \u65f6\uff0c\u77e9\u9635\u4e3a\uff1a\n\n$\\begin{bmatrix}\n1 & 1 & 0 & 0\\\\\n0 & 0 & 1 & 0\\\\\n0 & 0 & 0 & 1\\\\\n1 & 0 & 0 & 0\n\\end{bmatrix}$\n\n\u6ce8\u610f\u8fd9\u79cd\u4e1c\u897f\u5c3d\u91cf\u63a8\u5230 $4$\uff0c\u56e0\u4e3a\u90a3\u4e2a $2\\times 2$ \u7684\u4f60\u5b9e\u5728\u662f\u770b\u4e0d\u51fa\u4ec0\u4e48\u4e1c\u897f\u7684\u3002\n\n\u4ee5\u6b64\u7c7b\u63a8\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u51fa\uff1a$matrix_{i,i+1}=matrix_{m-1,0}=matrix_{0,0}=1$\uff08\u4e0b\u6807\u4ece $0$ \u5f00\u59cb\uff09\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(m^3\\log n)$\uff0c\u56e0\u4e3a $m$ \u5f88\u5c0f\uff0c\u7136\u540e\u5c31\u6ca1\u6709\u7136\u540e\u4e86\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\n\nconst int MOD = 1e9 + 7;\nconst int N = 100 + 10;\nll n, m;\n\nstruct matrix{\n\tint r, c;\n\tll a[N][N];\n\t\n\tmatrix(int R, int C, int p = 0): r(R), c(C){\n\t\tmemset(a, 0, sizeof(a));\n\t\tfor(int i=0;i<min(c,r);i++)\ta[i][i] = p;\n\t}\n\tll* operator [] (int id){return a[id];}\n\t\n\tconst ll* operator [] (int id) const{return a[id];}\n\t\n\tmatrix operator * (const matrix &m) const {\n\t\tmatrix ans(r, m.c);\n\t\tfor(int i=0;i<r;i++) for(int j=0;j<m.c;j++)\tfor(int k=0;k<c;k++) ans[i][j] = (ans[i][j] + (ll)a[i][k] * m[k][j]) % MOD;\n\t\treturn ans;\n\t}\n\t\n\tmatrix exp(ll b){\n\t\tmatrix a = *this, ans(r, r, 1);\n\t\twhile(b){\n\t\t\tif(b & 1)\tans = ans * a;\n\t\t\ta = a * a, b >>= 1;\n\t\t}\n\t\treturn ans;\n\t}\n};\n\nint main(){\n\tscanf(\"%lld%lld\", &n, &m);\n\tmatrix a(m, m), v(1, m);\n\tfor(int i=0;i<m;i++)\ta[i][i + 1] = a[0][0] = a[m - 1][0] = 1;\n\tv[0][0] = 1, v = v * a.exp(n);\n\tprintf(\"%lld\\n\", v[0][0]);\n\treturn 0;\n}\n```\n",
        "postTime": 1661940805,
        "uid": 363036,
        "name": "chlchl",
        "ccfLevel": 5,
        "title": "CF1117D Magic Gems \u9898\u89e3"
    },
    {
        "content": "### \u524d\u8a00\uff1a\u8fd9\u9898\u662f\u590d\u4e60\u77e9\u9635\u52a0\u901f\u7684\u65f6\u5019\u627e\u5230\u7684\n\n\u9996\u5148 \u6211\u4eec\u4ee4 $f_i$ \u4e3a\u53d6 $i$ \u4e2a\u7684\u65b9\u6848\u6570 \u663e\u7136 $f_0=1$ \u7b54\u6848\u4e3a $f_n$ \n\n\u8003\u8651\u8f6c\u79fb  \u6211\u4eec\u8003\u8651\u4e0d\u7528\u9b54\u6cd5 \u5373 $f_i=f_{i-1}$\n\n\u4f7f\u7528\u9b54\u6cd5 \u5219 $[i-m+1,i]$ \u5fc5\u5b9a\u4e3a\u4e0d\u662f\u9b54\u6cd5\u7684 \u76f4\u63a5 $f_i=f_i+f_{i-m}$\n\n\u7136\u800c\u8fd9\u6837\u590d\u6742\u5ea6\u662f $O(n)$ \u7684 \u89c2\u5bdf\u9012\u63a8\u5f0f \u53d1\u73b0\u662f\u4e2a\u7ebf\u6027\u7684\u9012\u63a8\u5f0f \u53c8\u56e0\u4e3a m \u5f88\u5c0f \u8003\u8651\u77e9\u9635\u52a0\u901f\n\n\u521d\u59cb\u77e9\u9635\u4e3a \n\n$ \\begin{bmatrix}\nf_{n-1} \\ f_{n-2} \\ ... \\ f_{n-m-1}\\\\\n\\end{bmatrix}\n$\n\n\u663e\u7136\u8f6c\u79fb\u77e9\u9635\u4e3a(m=3)\n\n$ \\begin{bmatrix}\n0 \\ 0 \\ 1\\\\\n1 \\ 0 \\ 0\\\\\n0 \\ 1 \\ 1\n\\end{bmatrix}\n$\n\n```cpp\n#include <cstdio>\n#include <algorithm>\n#include <iostream>\n#include <cstring>\n\n#define N 200\n#define mod (int)(1e9+7)\n#define int long long\n\nusing namespace std;\n\nint n,m;\n\nstruct node {\n\tint a[N][N];\n\tnode () {\n\t\tmemset(a,0,sizeof(a));\n\t}\n}ans,A;\n\nnode operator * (node x,node y) {\n\tnode ret;\n\tfor(int i=1;i<=m;i++) {\n\t\tfor(int j=1;j<=m;j++) {\n\t\t\tfor(int k=1;k<=m;k++) {\n\t\t\t\tret.a[i][j]=(ret.a[i][j]+x.a[i][k]*y.a[k][j])%mod;\t\n\t\t\t}\n\t\t}\n\t}\n\treturn ret;\n}\n\nint rd() {\n\tint f=1,sum=0; char ch=getchar();\n\twhile(!isdigit(ch)) {if(ch=='-') f=-1;ch=getchar();}\n\twhile(isdigit(ch)) {sum=(sum<<3)+(sum<<1)+ch-'0';ch=getchar();}\n\treturn sum*f;\n}\n\nvoid fpow(int y) {\n\twhile(y) {\n\t\tif(y&1) ans=ans*A;\n\t\ty>>=1; A=A*A;\n\t}\n}\n\nsigned main() {\n\tn=rd(); m=rd();\n\tif(n<m) {\n\t\tputs(\"1\"); return 0;\n\t} \n\tfor(int i=1;i<m;i++) ans.a[1][i]=1;\n\tans.a[1][m]=2;\n\tfor(int i=1;i<m;i++) A.a[i+1][i]=1;\n\tA.a[1][m]=A.a[m][m]=1;\n\tfpow(n-m);\n\tprintf(\"%lld\",ans.a[1][m]%mod);\n\treturn 0;\n}\n```",
        "postTime": 1617418428,
        "uid": 125901,
        "name": "FxorG",
        "ccfLevel": 7,
        "title": "CF1117D Magic Gems"
    },
    {
        "content": "\u77e9\u9635\u52a0\u901f\u9012\u63a8\u5178\u9898\u3002\n\n## $\\tt Solution$\n\n\u5148\u63a8\u6734\u7d20\u9012\u63a8\u65b9\u7a0b\uff0c\u518d\u8003\u8651\u77e9\u9635\u4f18\u5316\u3002\n\n\u8bbe $f(i)$ \u8868\u793a\u5360\u636e\u5355\u4f4d\u4f53\u79ef\u4e3a $i$ \u65f6\u653e\u5b9d\u77f3\u7684\u65b9\u6848\u6570\u3002\n\n\u5f88\u663e\u7136\uff0c$i<m$ \u65f6\u65e0\u6cd5\u5206\u89e3\uff0c\u6545\u6b64\u65f6 $f(i)=1$\u3002\n\n$i \\ge m$ \u65f6\uff0c\u5206\u8ba8\u4e24\u79cd\u60c5\u51b5\uff1a\n\n- \u4e0d\u5c06\u9b54\u6cd5\u5b9d\u77f3\u5206\u89e3\uff0c\u6b64\u65f6\u5360\u636e $1$ \u5355\u4f4d\u4f53\u79ef\u7684\u7a7a\u95f4\u3002\n\n- \u5c06\u9b54\u6cd5\u5b9d\u77f3\u5206\u89e3\u6389\uff0c\u6b64\u65f6\u5360\u636e $m$ \u5355\u4f4d\u4f53\u79ef\u7684\u7a7a\u95f4\u3002\n\n\u6613\u5f97\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$\nf(i)=\\left\\{\n\\begin{aligned}\n& 1 & i<m \\\\\n& f(i-1)+f(i-m) & i \\ge m\n\\end{aligned}\n\\right.\n$$\n\n\u63a5\u4e0b\u6765\u601d\u8003\u5982\u4f55\u6784\u9020\u77e9\u9635\u3002\u7531\u7279\u6b8a\u5230\u4e00\u822c\u3002\n\n$m=2$ \u65f6\uff0c\u663e\u7136\u662f\u6590\u6ce2\u90a3\u5951\u6570\u5217\u3002\u77e9\u9635\u5982\u4e0b\uff1a\n\n$$\n\\begin{pmatrix}\n1 & 1 \\\\\n1 & 0\n\\end{pmatrix}\n$$\n\n$m=3$ \u65f6\uff0c\u6784\u9020\u77e9\u9635\u5982\u4e0b\uff1a\n\n$$\n\\begin{pmatrix}\n1 & 1 & 0 \\\\\n0 & 0 & 1 \\\\\n1 & 0 & 0\n\\end{pmatrix}\n$$\n\n$m=4$ \u65f6\uff0c\u6784\u9020\u77e9\u9635\u5982\u4e0b\uff1a\n\n$$\n\\begin{pmatrix}\n1 & 1 & 0 & 0 \\\\\n0 & 0 & 1 & 0 \\\\\n0 & 0 & 0 & 1 \\\\\n1 & 0 & 0 & 0\n\\end{pmatrix}\n$$\n\n\u53ef\u5f97\u4e00\u822c\u60c5\u51b5\u3002\u8bbe\u6784\u9020\u77e9\u9635\u4e3a $A$\uff0c\u5219\uff08\u4e0b\u6807\u4ece $0$ \u8ba1\u7b97\uff09\uff1a\n\n$$\nA_{ij}=\\left\\{\n\\begin{aligned}\n& 1 & j=i+1,0 \\le i < m-1\\\\\n& 1 & i=0,j=0\\\\\n& 1 & i=m-1,j=0\\\\\n& 0 & \\text{Otherwise}\n\\end{aligned}\n\\right.\n$$\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(m ^ 3 \\log n)$\u3002\n\n## $\\tt Code$\n\n```cpp\n// \u4ee5\u4e0a\u7701\u7565\u5934\u6587\u4ef6\u53ca\u5feb\u8bfb\u5feb\u8f93\u90e8\u5206\u3002\n#define pcs putchar(' ')\n#define pcn putchar('\\n')\n#define for1(i,a,b) for(int i=(a);i<=(b);++i)\n#define for2(i,a,b) for(int i=(a);i>=(b);--i)\nusing namespace std;\ntypedef long long ll;\nconst ll mod=1e9+7;\nconst int N=110;\nll n;\nint m;\nstruct M{\n\tll m[N][N]; // \u6a21\u6570 1e9+7\uff0c\u4e24\u4e2a\u6570\u76f8\u4e58\u53ef\u80fd\u7206 int\uff0c\u6ce8\u610f\u5f00 long long\u3002\n};\nM operator*(const M&A,const M&B) {\n\tM C={0};\n\tfor1(i,0,m-1) for1(k,0,m-1) for1(j,0,m-1)\n\t\t(C.m[i][j]+=A.m[i][k]*B.m[k][j])%=mod;\n\treturn C;\n}\nM qp(M A,ll b) {\n\tM C={0};\n\tfor1(i,0,m-1) C.m[i][i]=1; // \u8bb0\u5f97\u521d\u59cb\u5316\u5355\u4f4d\u77e9\u9635\u3002\n\twhile(b) {if(b&1) C=C*A;A=A*A,b>>=1;}\n\treturn C;\n}\nM A,B;\nint main () {\n\tin(n),in(m);\n\tif(n<m) {out(1);return 0;} // \u7279\u5224\u4e00\u79cd\u7279\u6b8a\u60c5\u51b5\u3002\n\tfor1(i,0,m-2) A.m[i][i+1]=1;\n\tA.m[0][0]=A.m[m-1][0]=B.m[0][0]=1; // \u521d\u59cb\u5316\u3002\n//\tfor1(i,0,m-1)\n//\t\tfor1(j,0,m-1)\n//\t\t\tprintf(\"%d%c\",A.m[i][j],\" \\n\"[j==m-1]);\n\tout((B*qp(A,n)).m[0][0]);\n\treturn 0;\n}\n```",
        "postTime": 1678611218,
        "uid": 566289,
        "name": "RP_INT_MAX",
        "ccfLevel": 0,
        "title": "CF1117D Magic Gems \u9898\u89e3"
    },
    {
        "content": "\u524d\u8a00\uff1a\u8fd9\u4e2a\u9898\u76ee\u539f\u672c\u662f\u7d2b\u9898\uff0c\u6211\u505a\u4e86\u6b64\u9898~~\u540e\u89c9\u5f97\u8fd9\u79cd\u6c34\u6b7b\u7684\u9898\u76ee\u5c45\u7136\u914d\u5f97\u4e0a\u7d2b\uff1f~~\uff0c\u6700\u7ec8\u6b64\u9898\u53d8\u4e3a\u84dd\u9898\u3002\u6b63\u597d\u6c34\u4e2a\u9898\u89e3\uff08\n\n\u56de\u5f52\u6b63\u9898\u3002\u5bf9\u4e8e\u8fd9\u9053\u9898\u76ee\uff0c\u9996\u5148\u4ee4\u6211\u4eec\u5934\u75bc\u7684\u662f $n$ \u7684\u6570\u636e\u8303\u56f4\u3002\n\n\u800c\u5f53 $n$ \u8f83\u5c0f\u65f6\uff0c\u8bfb\u8005\u5e94\u8be5\u53ef\u4ee5\u60f3\u51fa\u4e00\u4e2a\u8f83\u4e3a naive \u7684 dp \u65b9\u7a0b\uff1a$f_i=f_{i-1}+f_{i-m}$\uff0c\u5176\u4e2d $f_i$ \u8868\u793a\u603b\u4f53\u79ef\u4e3a $i$ \u7684\u65b9\u6848\u6570\u3002\u8be5\u8f6c\u79fb\u5f0f\u7684\u542b\u4e49\u662f\uff0c\u5bf9\u4e8e\u4e00\u9897\u5b9d\u77f3\uff0c\u8981\u4e48\u5206\u89e3\u4e86\u53d8\u4e3a $m$ \u4f53\u79ef\uff0c\u8981\u4e48\u4e0d\u5206\u89e3\uff0c\u4f53\u79ef\u4e3a $1$\u3002\u521d\u503c $f_0=1$\uff0c\u76ee\u6807 $f_n$\u3002\n\n\u5f53\u7136\u5566\u8fd9\u4e2a\u65b9\u6cd5\u5728 $n$ \u8fc7\u5927\u65f6\u662f\u80af\u5b9a\u4f1a\u8d85\u65f6\u7684\uff0c\u9700\u8981\u52a0\u4ee5\u4f18\u5316\u3002\u5f53 $m=2$ \u65f6\uff0c\u8be5\u65b9\u7a0b\u662f\u7ecf\u5178\u7684\u6590\u6ce2\u90a3\u5951\u6570\u5217\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u77e9\u9635\u4e58\u6cd5\u52a0\u4ee5\u8ba1\u7b97\uff0c\u521d\u59cb\u77e9\u9635\u4e3a $\\begin{bmatrix}1&0\\end{bmatrix}$\uff0c\u52a0\u901f\u77e9\u9635\u4e3a $\\begin{bmatrix}1&1\\\\1&0\\end{bmatrix}$\u3002\n\n\u8fdb\u4e00\u6b65\uff0c\u5f53 $m>2$ \u65f6\uff0c\u4e5f\u53ef\u4ee5\u7528\u77e9\u9635\u52a0\u901f\u3002\u7531\u4e8e dp \u8f6c\u79fb\u5f0f\u91cc\u6700\u591a\u53ea\u4f1a\u6d89\u53ca\u5230\u4f4d\u7f6e\u5904\u4e8e\u5f80\u524d $m$ \u4e2a\u7684\u5143\u7d20\uff0c\u6240\u4ee5\u53ef\u4ee5\u5c06 $m$ \u4e2a\u6570\u7684\u503c\u90fd\u653e\u5165\u521d\u59cb\u77e9\u9635\u91cc\uff0c\u4e5f\u5c31\u662f $\\begin{bmatrix}f_i&f_{i-1}&\\cdots&f_{i-m+1}\\end{bmatrix}$\uff0c\u6211\u4eec\u5e0c\u671b\u5728\u4e00\u6b21\u8f6c\u79fb\u540e\uff0c\u521d\u59cb\u77e9\u9635\u524d $m-1$ \u4e2a\u6570\u90fd\u5411\u540e\u632a\u4e00\u683c\uff0c\u7b2c\u4e00\u4e2a\u6570\u53d8\u4e3a $f_i+f_{i-m+1}$\uff0c\u4e5f\u5c31\u662f\uff1a\n\n$$\\begin{bmatrix}1&1&0&0&\\cdots&0\\\\0&0&1&0&\\cdots&0\\\\0&0&0&1&\\cdots&0\\\\\\vdots&\\vdots&\\vdots&\\vdots&\\ddots&\\vdots&\\\\0&0&0&0&\\cdots&1\\\\1&0&0&0&0&0\\end{bmatrix}$$\n\n\u4e8e\u662f\u5c31\u987a\u5229\u7684\u89e3\u51b3\u4e86\u8fd9\u9053\u9898\u3002\n```cpp\n#include<iostream>\n#include<vector>\nusing namespace std;\nstruct matrix\n{\n\tint n,m;vector<vector<int>> mat;\n\tmatrix(int _n,int _m){n=_n,m=_m,mat.resize(_n,vector<int>(_m,0));}\n};\nmatrix operator *(matrix a,matrix b)\n{\n\tmatrix c(a.n,b.m);\n\tfor(int i=0;i<a.n;i++)\n\t\tfor(int j=0;j<b.m;j++)\n\t\t\tfor(int k=0;k<a.m;k++)\n\t\t\t\tc.mat[i][j]=(c.mat[i][j]+1ll*a.mat[i][k]*b.mat[k][j])%1000000007;\n\treturn c;\n}\nmatrix operator ^(matrix a,long long p)\n{\n\tmatrix ret(a.n,a.n);\n\tfor(int i=0;i<ret.n;i++)ret.mat[i][i]=1;\n\tfor(;p;a=a*a,p/=2)if(p%2)ret=ret*a;\n\treturn ret;\n}\nint main()\n{\n\tlong long n;int m;cin>>n>>m;\n\tmatrix f(1,m),a(m,m);\n\tfor(int i=0;i<m-1;i++)a.mat[i][i+1]=1;\n\ta.mat[0][0]=a.mat[m-1][0]=f.mat[0][0]=1;\n\tcout<<(f*(a^n)).mat[0][0];\n}\n```",
        "postTime": 1676553709,
        "uid": 487600,
        "name": "markding",
        "ccfLevel": 5,
        "title": "CF1117D\u9898\u89e3"
    },
    {
        "content": "\u5148\u4e0d\u8003\u8651 $n$ \u7684\u8303\u56f4\uff0c\u5c31\u662f\u5f88\u7b80\u5355\u7684dp\u3002\n\n\u8bbe `dp[i]` \u4e3a\u603b\u4f53\u79ef\u4e3a `i` \u7684\u65f6\u5019\u7684\u65b9\u6848\u6570\u3002\n\n\u6709\u4e24\u79cd\u60c5\u51b5\uff0c\u4e00\u79cd\u662f\u4e0d\u5206\u89e3\u6700\u540e\u4e00\u9897\u9b54\u6cd5\u5b9d\u77f3\uff0c`dp[i]=dp[i-1]`\u3002\u53e6\u4e00\u79cd\u60c5\u51b5\uff0c\u5206\u89e3\u6700\u540e\u4e00\u9897\u9b54\u6cd5\u5b9d\u77f3\uff0c`dp[i]=dp[i-m]`\u3002\u4e24\u79cd\u60c5\u51b5\u52a0\u8d77\u6765\u6765\uff0c`dp[i]=dp[i-1]=dp[i-m]`\u3002\n\n\u73b0\u5728\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n)$\u3002**\u8003\u8651\u7528 [\u77e9\u9635\u52a0\u901f](https://oi-wiki.org/math/matrix/#%E7%9F%A9%E9%98%B5%E5%8A%A0%E9%80%9F%E9%80%92%E6%8E%A8)\u4f18\u5316\u3002**\n$$\n\\left[\\begin{matrix}\ndp_i & dp_{i-1} & dp_{i-2} &\\dots dp_{i-m+1}\n\\end{matrix}\\right]\n$$\n\u8bbe\u8fd9\u6837\u4e00\u4e2a\u884c\u6570\u4e3a $1$\uff0c\u5217\u6570\u4e3a $m$ \u7684\u77e9\u9635\u4e3a $s_i$\u3002\n\n\u8bbe\u4ee5 $dp_{i+1}$ \u5f00\u5934\u7684\u7c7b\u4f3c\u7684\u77e9\u9635\u4e3a $s_{i+1}$\u3002\n\n\u73b0\u5728\u8981\u4f7f $s_i$ \u4e58\u4e0a\u4e00\u4e2a\u77e9\u9635 $k$ \u540e\u5f97\u5230 $s_{i+1}$\u3002\n\n\u5148\u4ece\u7b80\u5355\u7684\u5f00\u59cb\u63a8\u3002\n\n\u5f53 $m$ \u4e3a $2$ \u65f6\uff0c$k$ \u4e3a\uff1a\n$$\n\\left[\n\\begin{matrix}\n1 & 1 \\\\\n1 & 0 \\\\ \n\\end{matrix} \\right]\n$$\n\n\u5f53 $m$ \u4e3a $3$ \u65f6\uff0c$k$ \u4e3a\uff1a\n$$\n\\left[\n\\begin{matrix}\n1 & 1 & 0\\\\\n0 & 0 & 1\\\\\n1 & 0 & 0\n\\end{matrix} \\right]\n$$\n\n\u53d1\u73b0\u5bf9\u4e8e\u7b2c\u4e00\u5217\uff1a\u7b2c\u4e00\u884c\uff0c\u7b2c $m$ \u884c\uff0c\u6570\u503c\u662f 1\uff1b\u5bf9\u4e8e\u7b2c\u4e8c\u5217\u4ee5\u53ca\u540e\u9762\u7684\uff0c\u53ea\u6709\u4e00\u4e2a\u6570\u4e3a 1\uff0c\u4e14 1 \u7684\u884c\u6570\u4e3a\u5217\u6570\u51cf\u4e00\u3002\uff08\u5176\u5b9e\u662f\u56e0\u4e3a $s_2$ \u7684\u7b2c\u4e00\u4e2a\u6570\u5bf9\u5e94\u7740 $k$ \u7684\u7b2c\u4e00\u5217\uff0c\u7b2c\u4e8c\u4e2a\u6570\u5bf9\u5e94 $k$ \u7684\u7b2c\u4e8c\u5217......\u8fd9\u91cc\u81ea\u5df1\u5f88\u5bb9\u6613\u63a8\u51fa\u6765\uff0c\u5728\u8349\u7a3f\u672c\u4e0a\u753b\u4e00\u4e0b\u5c31\u884c\uff09\n\n\u6240\u4ee5\u8bf4\u6bcf\u4e00\u6b21\u7528 $s_{i-1} \\times k = s_{i}$ \u4e00\u76f4\u63a8\u5c31\u884c\uff0c\u53c8\u56e0\u4e3a\u662f\u4e00\u76f4\u4e58 $k$ \u8fd9\u540c\u4e00\u4e2a\u77e9\u9635\uff0c\u5c31\u53ef\u4ee5\u7528**\u77e9\u9635\u5feb\u901f\u5e42**\u89e3\u51b3\u3002(\u5176\u5b9e\u8ddf\u6574\u6570\u7684\u5feb\u901f\u5e42\u662f\u5dee\u4e0d\u591a\u7684\uff0c\u53ea\u662f\u91cd\u65b0\u5b9a\u4e49\u4e86\u4e58\u6cd5)\n\n\u6ce8\u610f\u8981\u5f00 longlong\u3002\n\nCode:\n\n```cpp\n//\u4ee3\u7801\u91cc\u9762\u7684\u53d8\u91cf\u540d\u548c\u4e0a\u6587\u7684\u4e0d\u4e00\u6837\uff0c\u6ce8\u610f\u533a\u5206!\n#include<bits/stdc++.h> \nusing namespace std;\ntypedef long long ll;\nconst int mo=1e9+7; \nint m;\nll n;\nstruct Matrix{\n\tll a[105][105];\n\tMatrix(){\n\t\tmemset(a,0,sizeof(a));\n\t}\n}pr,k;\nMatrix operator *(const Matrix &P,const Matrix &Q){\n\tMatrix ans;\n\tfor(int i=1;i<=m;i++){\n\t\tfor(int k=1;k<=m;k++){ \n\t\t\tfor(int j=1;j<=m;j++){\n\t\t\t\tans.a[i][j]=((ans.a[i][j]+P.a[i][k]*Q.a[k][j]%mo)%mo+mo)%mo;\n\t\t\t} \n\t\t}\n\t}\n\treturn ans;\n}\nvoid mpow(ll x){\n\twhile(x){\n\t\tif(x&1)\tk=k*pr;\n\t\tx/=2;\n\t\tpr=pr*pr;\n\t}\n}\nint main(){\n\tcin>>n>>m;\n\tpr.a[1][1]=pr.a[m][1]=1;\n\tfor(int i=2;i<=m;i++)\tpr.a[i-1][i]=1;\n\tfor(int i=1;i<=m;i++)\tk.a[1][i]=1;\n\tif(n<m){ \n\t\tcout<<1;\n\t}else{\n\t\tmpow(n-m+1);\n\t\tcout<<k.a[1][1];\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1660609527,
        "uid": 488090,
        "name": "bwartist",
        "ccfLevel": 0,
        "title": "CF1117D Magic Gems TJ"
    },
    {
        "content": "\u8bbe $dp_i$ \u8868\u793a\u524d $i$ \u4e2a\u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48 $i$ \u53ef\u4ee5\u5355\u72ec\u4e0d\u5206\u88c2\uff0c\u6b64\u65f6\u5c31\u662f $dp_{i-1}$\uff1b\u4e5f\u53ef\u4ee5\u5206\u88c2\u7ec4\u6210 $m$ \u4e2a\u666e\u901a\u7684\uff0c\u6b64\u65f6\u5c31\u662f $dp_{i-m}$\u3002\n\n\u6240\u4ee5 $dp_i\\gets dp_{i-1}+dp_{i-m}$\u3002\n\n\u521d\u59cb\u72b6\u6001 $dp_{i\\in[0,m-1]}\\gets1$\u3002\n\n\u89c2\u5bdf\u5230 $n$ \u5f88\u5927\uff0c\u53ef\u4ee5\u4f7f\u7528\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(m^3\\log n)$\u3002",
        "postTime": 1660570135,
        "uid": 563958,
        "name": "qwqawaqaq",
        "ccfLevel": 0,
        "title": "CF1117D Magic Gems \u9898\u89e3"
    },
    {
        "content": "[$$\\huge\\texttt{\u5728\u672c\u4ebablog\u98df\u7528\u66f4\u4f73}$$](http://dilute.coding.me/2019/03/02/Solutions/Solution-CF1117D/)\n\n## \u6709\u8da3\u7684\u77e9\u9635\u4e58\u6cd5\n\n\uff08\u4e3a\u65b9\u4fbf\uff0c\u4e0b\u6587\u4e2d\u201c\u5927\u53f7\u5b9d\u77f3\u201d\u4ee3\u6307\u8fde\u7eed\u7684$m$\u4e2a\u5206\u88c2\u51fa\u6765\u7684\u5b9d\u77f3\uff0c\u201c\u5c0f\u53f7\u5b9d\u77f3\u201d\u4ee3\u6307\u672a\u5206\u88c2\u7684\u5355\u4e2a\u5b9d\u77f3\uff09\n\n\u9996\u5148\uff0c\u6211\u4eec\u89c2\u5bdf\u8fd9\u9898\uff0c\u8003\u8651$DP$\uff0c\u8bbe\u72b6\u6001$f_i$\u8868\u793a\u5df2\u7ecf\u53d6\u4e86$i$\u4e2a\u5355\u5143\u7684\u65b9\u6848\u6570\u7684\u4e0d\u96be\u63a8\u51fa\u4e00\u4e2a\u6734\u7d20\u7684$O(n^2) DP$\u65b9\u7a0b$f_i = \\displaystyle\\sum_{i - j \\geq m} f_j  +1$\uff08\u53ef\u4ee5\u7406\u89e3\u6210\u4e0a\u4e00\u4e2a\u5927\u53f7\u5b9d\u77f3\u653e\u7684\u4f4d\u7f6e\uff0c\u6700\u540e\u4e00\u4e2a$1$\u5373\u4e3a\u5168\u90e8\u7528\u5c0f\u53f7\u5b9d\u77f3\u586b\u6ee1\u7684\u65b9\u6848\uff09\n\n\u6211\u4eec\u518d\u4ed4\u7ec6\u770b\u770b\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u52a0\u4e2a\u524d\u7f00\u548c\uff0c\u4e0d\u96be\u4f18\u5316\u5230$O(n)$\uff0c\u7136\u800c\u6570\u636e\u8303\u56f4$n \\leq 10^{18}$\uff0c\u8fd9\u8ba9\u6211\u4eec\u8003\u8651$O(\\log n)$\u7ea7\u522b\u7684\u7b97\u6cd5\uff0c\u6211\u4eec\u63a5\u4e0b\u6765\u8003\u8651\u77e9\u9635\u4e58\u6cd5\u4f18\u5316\u8fd9\u4e2a\u5f0f\u5b50\u3002\n\n<!--more-->\n\n\u663e\u7136\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u8ddf\u6ee1\u8db3$i - j \\geq m$\u7684$j$\u6709\u5173\uff0c\u4f46\u662f\u8fd9\u4e9b\u6570\u5b57\u7684\u6570\u91cf\u662f$n$\u7ea7\u522b\u7684\uff0c\u6211\u4eec\u8003\u8651\u5c06$\\displaystyle\\sum_{i - j \\geq m} f_j$\u53d8\u5f62\uff0c\u53d8\u6210$\\displaystyle\\sum_{j = 1}^{i} f_j - \\sum_{j = i - m}^{j < i} f_j$ \u8fd9\u6837\u53ea\u8981\u6211\u4eec\u7ef4\u62a4\u4e00\u4e0b$\\displaystyle\\sum_{j = 1}^{i} f_j$\u5c31\u53ef\u4ee5\u628a\u9700\u8981\u7ef4\u62a4\u7684\u503c\u7684\u6570\u91cf\u964d\u5230$m$\u7ea7\u522b\u3002\n\n\u63a5\u4e0b\u6765\u76f4\u63a5\u5728\u77e9\u9635\u7684\u7b2c\u4e00\u884c\u7684\u7b2c$j (1 \\leq j \\leq m) $ \u4f4d\u653e\u4e0a$f_{i - j}$\uff0c\u7136\u540e\u7b2c$m + 1$\u4f4d\u7ef4\u62a4$\\displaystyle\\sum_{j = 1}^{i} f_j$\uff0c\u7b2c$m + 2$\u4f4d\u518d\u5f04\u4e2a$1$\uff0c\u778e\u6784\u9020\u4e00\u901a\u8f6c\u79fb\u77e9\u9635\uff0c\u5c31\u53ef\u4ee5\u6109\u5feb\u7684\u5957\u77e9\u9635\u5feb\u901f\u5e42\u677f\u5b50\u4e86\uff0c\u6700\u7ec8\u590d\u6742\u5ea6$O(m^3 \\log n)$\u3002\n\n\uff08\u8f6c\u79fb\u7684\u77e9\u9635\u7684\u5177\u4f53\u6784\u9020\u5efa\u8bae\u770b\u4ee3\u7801\uff09\n\n## \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n\n#define ll long long\n#define INF 2147483647\n#define mod 1000000007\n\nll inp(){\n    char c = getchar();\n    while(c < '0' || c > '9')\n        c = getchar();\n    ll sum = 0;\n    while(c >= '0' && c <= '9'){\n        sum = sum * 10 + c - '0';\n        c = getchar();\n    }\n    return sum;\n}\n\nclass Square{\n    public:\n        long long num[110][110];\n        int len;\n        Square operator *(Square b){\n            Square ans;\n            memset(ans.num, 0, sizeof(ans.num));\n            for(int i = 1;i <= len; i++)\n    \t\t\tfor(int j = 1; j <= len; j++)\n        \t\t\tfor(int k = 1; k <= len; k++){\n        \t\t\t    ans.num[i][j] += num[i][k] * b.num[k][j];\n        \t\t\t    ans.num[i][j] %= mod;\n        \t\t\t}\n            ans.len = len;\n            return ans;\n        }\n};\n\nint main(){\n    ll n = inp();\n    int m = inp() - 1;\n    Square a, b;\n    a.len = m + 2;\n    b.len = m + 2;\n    memset(a.num, 0, sizeof(a.num));\n    a.num[1][m + 2] = 1;\n    a.num[1][1] = 1;\n    a.num[1][m + 1] = 1;\n    memset(b.num, 0, sizeof(b.num));\n    for(int i = 1; i <= m; i++)\n        b.num[i][m + 1] = -1;\n    b.num[m + 1][m + 1] = 2;\n    b.num[m + 2][m + 1] = 1;\n    b.num[m + 2][m + 2] = 1;\n    for(int i = 2; i <= m; i++)\n        b.num[i - 1][i] = 1;\n    for(int i = 1; i <= m; i++)\n        b.num[i][1] = -1;\n    b.num[m + 2][1] = b.num[m + 1][1] = 1;\n    // n -= 2;\n    while(n){\n        if(n & 1)\n            a = a * b;\n        b = b * b;\n        n >>= 1;\n        // printf(\"%lld\\n\", a.num[1][1]);\n    }\n    // printf(\"%lld\\n\", (a * (b * b) * b * b).num[1][1]);\n    // for(int i = 1; i <= n; i++){\n    //     printf(\"%lld\\n\", a.num[1][1]);\n    //     a = a * b;\n    // }\n    std::cout << a.num[1][1] << std::endl;\n}\n```\n\n",
        "postTime": 1551532638,
        "uid": 36362,
        "name": "Dilute",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1117D \u3010Magic Gems\u3011"
    }
]
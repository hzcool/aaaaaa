[
    {
        "content": "## Solution\n\u63d0\u4f9b\u4e00\u79cd\u65b0\u601d\u8def\u3002\n\n\u9996\u5148\u8003\u8651\u5982\u4f55\u5224\u65ad\u4e00\u4e2a\u72b6\u6001\u662f\u5426\u5408\u6cd5\u3002\n\n\u8003\u8651\u628a\u6240\u6709\u5341\u8fdb\u5236\u957f\u5ea6\u4e00\u6837\u7684\u6570\u7f29\u6210\u4e00\u4e2a\u70b9\u3002\n\n\u8fd9\u6837\u7684\u70b9\u7684\u4e2a\u6570 $\\le 5$\u3002\n\n\u849f\u84bb\u731c\u4e86\u4e00\u4e2a\u7ed3\u8bba\uff1a\u53ea\u8981\u6ee1\u8db3\u5bf9\u4e8e\u6240\u6709\u7f29\u51fa\u6765\u7684\u70b9\u7684\u5b50\u96c6\u7684\u70b9\u7684\u4e2a\u6570 > \u5b50\u96c6\u5185\u8fb9\u7684\u4e2a\u6570\uff0c\u90a3\u4e48\u5c31\u662f\u6709\u89e3\u7684\u3002\n\n\u8fd9\u65f6 [$\\tt \\color{black}{S}\\color{red}{egmentTree}$](https://www.luogu.com.cn/user/118308) \u4f1a\u4e0b\u51e1\u544a\u8bc9\u4f60\uff1a\u8fd9\u662f\u5bf9\u7684\uff01\u5361\u4e0d\u6389\uff01\n\n\u4f46\u662f\u8fd9\u6837\u53ea\u80fd\u5224\u65ad\u53ef\u4e0d\u53ef\u884c\u554a\uff0c\u4e0d\u80fd\u8f93\u51fa\u65b9\u6848\u554a\u3002\u3002\u3002\n\n\u53d1\u73b0\u8fd9\u4e2a\u4e1c\u897f\u5224\u65ad\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5f88\u5c0f\uff0c\u53ef\u4ee5\u591a\u6b21\u5224\u65ad\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5220\u53f6\u5b50\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u79cd\u8fb9\u5c1d\u8bd5\u4e00\u4e0b\u53ef\u4e0d\u53ef\u4ee5\u5220\uff0c\u7136\u540e\u8fde\u8fb9\uff08\u5728\u539f\u56fe\u4e0a\uff0c\u8ba9\u6700\u540e\u6bcf\u4e00\u4e2a\u957f\u5ea6\u53ea\u5269\u4e0b\u4e00\u4e2a\u70b9\uff0c\u5269\u4e0b\u7684\u7279\u6b8a\u5904\u7406\uff09\u3002\n## Code\n```cpp\n#include<bits/stdc++.h>\n#define L(i, j, k) for(int i = j, i##E = k; i <= i##E; i++)\n#define R(i, j, k) for(int i = j, i##E = k; i >= i##E; i--)\n#define ll long long\n#define db double\n#define pii pair<int, int>\n#define mkp make_pair\nusing namespace std;\nconst int N = 100;\nconst int M = 2e6 + 7;\nconst int inf = 1e9;\nint n, m, mx, p[N], minn[N], D[M][2], sum = 0;\nint a[N][N];\nbool check() {\n\tL(t, 0, (1 << mx) - 1) {\n\t\tint ds = 0, bs = 0;\n\t\tL(i, 1, mx) if(t & (1 << (i - 1))) ds += p[i];\n\t\tif(!ds) continue;\n\t\tL(i, 1, mx) if(t & (1 << (i - 1))) L(j, 1, mx) if(t & (1 << (j - 1))) bs += a[i][j];\n\t\tif(bs >= ds) return 0;\n\t}\n\treturn 1;\n}\nint Cnt(int x) { return x == 0 ? 0 : Cnt(x / 10) + 1; }\nchar sa[N], sb[N];\nbool get() {\n\tL(x, 1, mx) L(i, 1, mx) if(a[x][i]) {\n\t\tif(p[x] > 1) {\n\t\t\ta[x][i] --, p[x] --;\n\t\t\tif(check()) return printf(\"%d %d\\n\", minn[x] + p[x], minn[i]), 1;\n\t\t\ta[x][i] ++, p[x] ++;\n\t\t}\n\t\tif(p[i] > 1) {\t\n\t\t\ta[x][i] --, p[i] --;\n\t\t\tif(check()) return printf(\"%d %d\\n\", minn[x], minn[i] + p[i]), 1;\n\t\t\ta[x][i] ++, p[i] ++;\n\t\t}\n\t}\n\treturn 0;\n}\nint main() {\n\tscanf(\"%d\", &n), mx = Cnt(n);\n\tL(i, 1, n) p[Cnt(i)]++;\n\tminn[1] = 1;\n\tL(i, 2, mx) minn[i] = minn[i - 1] * 10;\n\tL(i, 1, n - 1) scanf(\"%s%s\", sa, sb), D[i][0] = strlen(sa), D[i][1] = strlen(sb), a[D[i][0]][D[i][1]] ++;\n\tif(!check()) return puts(\"-1\"), 0;\n\twhile(get()) sum ++;\n\tL(x, 1, mx) L(i, 1, mx) if(a[x][i]) printf(\"%d %d\\n\", minn[x] + p[x] - 1, minn[i] + p[i] - 1), sum ++ ;\n\tif(sum != n - 1) assert(0);\n\treturn 0;\n}\n```\n**\u795d\u5927\u5bb6\u5b66\u4e60\u6109\u5feb\uff01**\n\n\n---- \n\n\u4e0d\u8fc7\u600e\u4e48\u8bc1\u660e\u90a3\u4e2a\u7ed3\u8bba\u662f\u5bf9\u7684\u554a\uff0c\u849f\u84bb\u601d\u8003\u4e86\u597d\u4e45\u8fd8\u662f\u4e0d\u61c2\uff0c\u6c42\u89e3 /kel",
        "postTime": 1605859971,
        "uid": 173660,
        "name": "zhoukangyang",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF611H \u3010New Year and Forgotten Tree\u3011"
    },
    {
        "content": "> [CF611H New Year and Forgotten Tree](https://codeforces.com/contest/611/problem/H)\r\n\r\n## \u9898\u610f\r\n\r\n- \u6709\u4e00\u68f5 $n$ \u4e2a\u8282\u70b9\u7684\u6811\uff0c\u8282\u70b9\u7f16\u53f7\u4e3a $1 \\sim n$\u3002\r\n- \u8bb0\u5f55\u8fd9\u68f5\u6811\u7684\u65b9\u5f0f\u662f\u8bb0\u5f55\u4e0b\u6bcf\u6761\u8fb9\u8fde\u63a5\u7684\u4e24\u70b9\u7684\u7f16\u53f7\u3002\r\n- \u73b0\u5728\uff0c\u4f60\u4e0d\u77e5\u9053\u8fd9\u4e9b\u7f16\u53f7\u5177\u4f53\u662f\u591a\u5c11\uff0c\u4f60\u53ea\u77e5\u9053\u5b83\u4eec\u5728\u5341\u8fdb\u5236\u4e0b\u7684\u4f4d\u6570\u3002\r\n- \u8bf7\u4f60\u6784\u9020\u51fa\u4e00\u68f5\u6ee1\u8db3\u8981\u6c42\u7684\u6811\uff0c\u6216\u5224\u65ad\u6ca1\u6709\u6ee1\u8db3\u8981\u6c42\u7684\u6811\u3002\r\n- $n \\le 2 \\times 10^5$\u3002\r\n\r\n## \u9898\u89e3\r\n\r\n\u4e0d\u59a8\u628a\u4f4d\u6570\u76f8\u540c\u7684\u70b9\u79f0\u4e3a\u540c\u79cd\u989c\u8272\uff0c\u5219\u663e\u7136\u6709 $m = \\lfloor \\log_{10} n \\rfloor + 1$ \u79cd\u989c\u8272\u3002\r\n\r\n\u5bf9\u4e8e\u6bcf\u79cd\u989c\u8272\u9009\u62e9\u4e00\u4e2a\u5173\u952e\u70b9\uff0c\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u5b58\u5728\u5408\u6cd5\u7684\u6811\uff0c\u4e00\u5b9a\u5b58\u5728\u4e00\u79cd\u60c5\u51b5\uff0c\u4f7f\u5f97\u5173\u952e\u70b9\u8fde\u6210\u4e00\u4e2a\u8fde\u901a\u5757\uff0c\u5176\u4ed6\u70b9\u8fde\u5411\u67d0\u4e00\u4e2a\u5173\u952e\u70b9\u3002\r\n\r\n\u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u4ee5 $\\mathcal O(m^{m-2})$ \u679a\u4e3e Prufer \u5e8f\u5217\u5f97\u5230\u5173\u952e\u70b9\u7684\u8fde\u901a\u65b9\u5f0f\uff0c\u5bf9\u4e8e\u5269\u4e0b\u7684\u989c\u8272\u8fb9 $(x,y)$\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06 $x$ \u63a5\u5230 $y$ \u7684\u5173\u952e\u70b9\u4e0a\uff0c\u4e5f\u53ef\u4ee5\u5c06 $y$ \u63a5\u5230 $x$ \u7684\u5173\u952e\u70b9\u4e0a\u3002\r\n\r\n\u8fd9\u76f8\u5f53\u4e8e\u8981\u505a\u4e00\u4e2a\u4e8c\u5206\u56fe\u591a\u91cd\u5339\u914d\uff1a\r\n\r\n1. \u4e8c\u5206\u56fe\u7684\u5de6\u90e8\u70b9\u4e3a\u6bcf\u79cd\u7c7b\u578b\u7684\u8fb9\uff0c\u4e00\u5171\u6709 $\\frac{m(m+1)}2$ \u4e2a\u70b9\uff0c\u6bcf\u4e2a\u70b9\u7684\u6570\u91cf\u4e3a\u539f\u6811\u5bf9\u5e94\u7684\u8fb9\u7684\u6570\u91cf\u51cf\u53bb\u5173\u952e\u70b9\u4e4b\u95f4\u5bf9\u5e94\u7684\u8fb9\u7684\u6570\u91cf\u3002\r\n2. \u4e8c\u5206\u56fe\u7684\u53f3\u90e8\u70b9\u4e3a\u6bcf\u79cd\u989c\u8272\u7684\u70b9\uff0c\u4e00\u5171\u6709 $m$ \u4e2a\u70b9\uff0c\u6bcf\u4e2a\u70b9\u7684\u6570\u91cf\u4e3a\u539f\u6811\u5bf9\u5e94\u7684\u70b9\u7684\u6570\u91cf\u51cf\u53bb\u5173\u952e\u70b9\u4e2d\u5bf9\u5e94\u7684\u70b9\u7684\u6570\u91cf\u3002\r\n3. \u5bf9\u4e8e\u989c\u8272\u8fb9 $(x,y)$\uff0c\u5c06\u5176\u5bf9\u5e94\u7684\u5de6\u90e8\u70b9\u5206\u522b\u4e0e $x,y$ \u5bf9\u5e94\u7684\u53f3\u90e8\u70b9\u8fde\u8fb9\uff0c\u6570\u91cf\u4e3a $+\\infty$\u3002\r\n\r\n\u5982\u679c\u8fd9\u4e2a\u4e8c\u5206\u56fe\u5b58\u5728\u591a\u91cd\u5b8c\u5907\u5339\u914d\uff0c\u5219\u8bf4\u660e\u6709\u89e3\uff0c\u5426\u5219\u65e0\u89e3\u3002\r\n\r\n\u90a3\u4e48\u8dd1\u4e00\u904d\u7f51\u7edc\u6d41\u5373\u53ef\u5224\u65ad\uff0c\u5982\u679c\u6709\u89e3\u5219\u53ef\u4ee5\u76f4\u63a5\u6839\u636e\u6b8b\u91cf\u7f51\u7edc\u6784\u9020\u3002\r\n\r\n\u7531\u4e8e $m$ \u975e\u5e38\u5c0f\uff0c\u6240\u4ee5\u53ef\u4ee5\u4e0d\u7528\u8003\u8651\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u4fdd\u8bc1\u6b63\u786e\u6027\u5373\u53ef\u3002\r\n\r\n## \u4ee3\u7801\r\n\r\n```cpp\r\nnamespace Dinic {\r\n\tconst int N = 107, M = 1e3 + 7;\r\n\tconst ll inf = 1e18;\r\n\tint n, m, S, T, h[N], hi[N], e[M], t[M], tot = 1, d[N];\r\n\tll mxf, f[M];\r\n\tinline void add(int x, int y, ll z, int o = 1) {\r\n\t\te[++tot] = y, f[tot] = z, t[tot] = h[x], h[x] = tot;\r\n\t\tif (o) add(y, x, 0, 0);\r\n\t}\r\n\tinline bool bfs() {\r\n\t\tfor (int i = 1; i <= n; i++) d[i] = 0;\r\n\t\tqueue<int> q;\r\n\t\tq.push(S), d[S] = 1;\r\n\t\twhile (q.size()) {\r\n\t\t\tint x = q.front();\r\n\t\t\tq.pop();\r\n\t\t\tfor (int i = h[x]; i; i = t[i]) {\r\n\t\t\t\tint y = e[i];\r\n\t\t\t\tll z = f[i];\r\n\t\t\t\tif (d[y] || !z) continue;\r\n\t\t\t\tq.push(y), d[y] = d[x] + 1;\r\n\t\t\t\tif (y == T) return 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn 0;\r\n\t}\r\n\tll dinic(int x, ll nwf) {\r\n\t\tif (x == T) return nwf;\r\n\t\tll rst = nwf;\r\n\t\tfor (int &i = hi[x]; i; i = t[i]) {\r\n\t\t\tint y = e[i];\r\n\t\t\tll z = f[i];\r\n\t\t\tif (d[y] != d[x] + 1 || !z) continue;\r\n\t\t\tll k = dinic(y, min(z, rst));\r\n\t\t\tif (!k) d[y] = 0;\r\n\t\t\telse f[i] -= k, f[i^1] += k, rst -= k;\r\n\t\t\tif (!rst) break;\r\n\t\t}\r\n\t\treturn nwf - rst;\r\n\t}\r\n\tinline void main() {\r\n\t\twhile (bfs()) {\r\n\t\t\tfor (int i = 1; i <= n; i++) hi[i] = h[i];\r\n\t\t\tll now;\r\n\t\t\twhile ((now = dinic(S, inf))) mxf += now; \r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst int N = 2e5 + 7, M = 9;\r\nint n, p[M], q[M], m, a[M], b[M], d[M], g[M];\r\nchar s[M];\r\nmap<pi, int> c, f;\r\n\r\ninline void work() {\r\n\tfor (int i = 1; i <= m; i++) d[i] = 0;\r\n\tfor (int i = 1; i <= m - 2; i++) ++d[a[i]]; a[m-1] = m;\r\n\tmap<pi, int> c = ::c;\r\n\tvector<pi> e;\r\n\tfor (int i = 1, j = 1; i < m; i++, j++) {\r\n\t\twhile (d[j]) ++j; e.pb(mp(j, a[i]));\r\n\t\twhile (i < m && !--d[a[i]] && a[i] < j) e.pb(mp(a[i], a[i+1])), ++i;\r\n\t}\r\n\tfor (pi o : e) {\r\n\t\tif (o.fi > o.se) swap(o.fi, o.se);\r\n\t\tif (!c[o]--) return;\r\n\t}\r\n\tDinic::n = 2 + m + m * (m + 1) / 2;\r\n\tDinic::S = Dinic::n - 1, Dinic::T = Dinic::n;\r\n\tDinic::tot = 1, Dinic::mxf = 0;\r\n\tfor (int i = 1; i <= Dinic::n; i++) Dinic::h[i] = 0;\r\n\tint k = m;\r\n\tvector<pi> ff(Dinic::n);\r\n\tfor (int i = 1; i <= m; i++) {\r\n\t\tDinic::add(i, Dinic::T, b[i]);\r\n\t\tfor (int j = i; j <= m; j++) {\r\n\t\t\tf[mp(i,j)] = ++k, ff[k] = mp(i, j);\r\n\t\t\tDinic::add(Dinic::S, k, c[mp(i,j)]);\r\n\t\t\tDinic::add(k, i, Dinic::inf);\r\n\t\t\tDinic::add(k, j, Dinic::inf);\r\n\t\t}\r\n\t}\r\n\tDinic::main();\r\n\tif (Dinic::mxf != n - m) return;\r\n\tfor (pi o : e) print(p[o.fi], ' '), print(p[o.se]);\r\n\tfor (int x = 1; x <= m; x++) {\r\n\t\tq[x] = p[x];\r\n\t\tfor (int i = Dinic::h[x]; i; i = Dinic::t[i]) {\r\n\t\t\tint y = Dinic::e[i];\r\n\t\t\tif (y <= m || y >= Dinic::S) continue;\r\n\t\t\ty = ff[y].fi == x ? ff[y].se : ff[y].fi;\r\n\t\t\twhile (Dinic::f[i]--) print(++q[x], ' '), print(p[y]);\r\n\t\t}\r\n\t}\r\n\texit(0);\r\n}\r\n\r\nvoid dfs(int o) {\r\n\tif (o == m - 1) return work();\r\n\tfor (int i = 1; i <= m; i++) a[o] = i, dfs(o + 1);\r\n}\r\n\r\nint main() {\r\n\trd(n);\r\n\tfor (int o = 1; o <= n; o *= 10) p[++m] = o;\r\n\tfor (int i = 1; i < m; i++) b[i] = p[i+1] - 1 - p[i];\r\n\tb[m] = n - p[m];\r\n\tfor (int i = 1, x, y; i < n; i++) {\r\n\t\trds(s, x), rds(s, y);\r\n\t\tif (x > y) swap(x, y);\r\n\t\t++c[mp(x,y)];\r\n\t}\r\n\tif (m == 1) {\r\n\t\tif (c[mp(1,1)] != n - 1) return print(-1), 0;\r\n\t\tfor (int i = 1; i < n; i++) print(i, ' '), print(i + 1);\r\n\t\treturn 0;\r\n\t}\r\n\tdfs(1), print(-1);\r\n\treturn 0;\r\n}\r\n```",
        "postTime": 1581447519,
        "uid": 100544,
        "name": "xht",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF611H \u3010New Year and Forgotten Tree\u3011"
    },
    {
        "content": "[Codeforces \u9898\u76ee\u4f20\u9001\u95e8](https://codeforces.com/contest/611/problem/H) & [\u6d1b\u8c37\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF611H)\n\n\u9996\u5148\u6211\u4eec\u5c06\u6240\u6709\u5341\u8fdb\u5236\u4e0b\u4f4d\u6570\u76f8\u540c\u7684\u70b9\u770b\u4f5c\u4e00\u79cd\u989c\u8272\uff0c\u8fd9\u6837\u9898\u76ee\u8f6c\u5316\u4e3a\uff0c\u7ed9\u5b9a $m\\le 6$ \u79cd\u989c\u8272\u3001\u6bcf\u79cd\u989c\u8272\u7684\u70b9\u7684\u4e2a\u6570 $b_i$ \u4ee5\u53ca\u6bcf\u4e24\u79cd\u989c\u8272\u4e4b\u95f4\u8fde\u7684\u8fb9\u7684\u6761\u6570 $c_{i,j}$\uff0c\u8981\u6c42\u6784\u9020\u51fa\u4e00\u68f5\u7b26\u5408\u8981\u6c42\u7684\u6811\u3002\n\n\u8003\u8651\u600e\u6837\u89e3\u51b3\u4e0a\u9762\u7684\u95ee\u9898\uff0c\u8fd9\u91cc\u6709\u4e00\u4e2a\u7ed3\u8bba\uff0c\u5bf9\u4e8e\u6bcf\u79cd\u989c\u8272\u6211\u4eec\u94a6\u5b9a\u4e00\u4e2a\u70b9\u4e3a\u201c\u5173\u952e\u70b9\u201d\uff08\u65b9\u4fbf\u8d77\u89c1\uff0c\u5bf9\u4e8e\u989c\u8272 $i$\uff0c\u6211\u4eec\u94a6\u5b9a $10^{i-1}$ \u4e3a\u7b2c $i$ \u79cd\u989c\u8272\u7684\u5173\u952e\u70b9\uff09\uff0c\u90a3\u4e48\uff0c\u5982\u679c\u5b58\u5728\u5408\u6cd5\u7684\u6811\uff0c\u4e00\u5b9a\u5b58\u5728\u4e00\u79cd\u60c5\u51b5\uff0c\u4f7f\u5f97\u4efb\u610f\u4e00\u6761\u8fb9\u90fd\u6709\u4e00\u4e2a\u70b9\u4e3a\u5173\u952e\u70b9\u3002\u81f3\u4e8e\u8bc1\u660e\uff0c\u4e0d\u592a\u4f1a\u4e25\u8c28\u8bc1\u660e\uff0c\u4e0d\u8fc7\u5927\u6982\u60f3\u60f3\u5e94\u8be5\u53ef\u4ee5\u60f3\u901a\uff0c\u5927\u6982\u5c31\u662f\u5bf9\u4e8e\u6bcf\u6761\u8fb9 $(u,v)$\uff0c\u5982\u679c $u,v$ \u90fd\u4e0d\u662f\u5173\u952e\u70b9\uff0c\u90a3\u4e48\u53ef\u4ee5\u5c06 $u$ \u6539\u63a5\u5230 $v$ \u7684\u989c\u8272\u7684\u5173\u952e\u70b9\uff0c\u6216\u8005\u5c06 $v$ \u6539\u63a5\u5230 $u$ \u7684\u989c\u8272\u7684\u5173\u952e\u70b9\uff0c\u603b\u80fd\u627e\u5230\u4e00\u79cd\u8c03\u6574\u65b9\u6cd5\u4f7f\u5f97\u4e0d\u5b58\u5728 $u,v$ \u90fd\u4e0d\u662f\u5173\u952e\u70b9\u7684\u8fb9 $(u,v)$\u3002\n\n\u4e0d\u96be\u53d1\u73b0\u5bf9\u4e8e\u7b26\u5408\u4e0a\u9762\u7684\u6761\u4ef6\u7684\u56fe\uff0c\u5982\u679c\u53ea\u8003\u8651 $m$ \u4e2a\u5173\u952e\u70b9\uff0c\u90a3\u4e48\u8fd9 $m$ \u4e2a\u70b9\u5f62\u6210\u7684\u56fe\u4e5f\u662f\u4e00\u68f5 $m$ \u4e2a\u70b9\u7684\u6811\uff0c\u7531\u4e8e $m$ \u5f88\u5c0f\uff0c\u56e0\u6b64\u8003\u8651\u6839\u636e prufer \u5e8f\u5217\u5c06\u8fd9 $m^{m-2}$ \u68f5\u6811\u679a\u4e3e\u4e00\u904d\uff0c\u63a5\u4e0b\u6765\u8003\u8651\u600e\u6837\u68c0\u9a8c\u5bf9\u4e8e\u4e00\u68f5\u5173\u952e\u70b9\u7684\u751f\u6210\u6811\uff0c\u662f\u5426\u5b58\u5728\u4e00\u79cd\u5c06\u975e\u5173\u952e\u70b9\u8fde\u5411\u5173\u952e\u70b9\u7684\u65b9\u6848\uff0c\u4f7f\u5f97\u5bf9\u4e8e\u4efb\u610f\u4e24\u79cd\u989c\u8272 $i,j$\uff0c$i,j$ \u4e4b\u95f4\u8fde\u7684\u8fb9\u6570\u6070\u4e3a $c_{i,j}$\uff0c\u6211\u4eec\u4e0d\u59a8\u5c06\u8fd9\u4e2a\u95ee\u9898\u8f6c\u5316\u4e00\u4e0b\uff0c\u53ef\u4ee5\u5f97\u5230\u5982\u4e0b\u7684\u6a21\u578b\uff1a\n\n- \u5bf9\u4e8e\u6bcf\u79cd\u989c\u8272\uff0c\u5171\u6709 $b_i-1$ \u4e2a\u975e\u5173\u952e\u70b9\uff0c\u5bf9\u4e8e\u8fd9 $b_i-1$ \u4e2a\u5173\u952e\u70b9\u4e2d\u7684\u6bcf\u4e00\u4e2a\u70b9 $u$\uff0c\u6211\u4eec\u90fd\u8981\u9009\u62e9\u4e00\u79cd\u989c\u8272 $j$\uff0c\u5e76\u5c06 $u$ \u8fde\u5411 $j$ \u7684\u5173\u952e\u70b9\uff0c\u8fd9\u6837\u4f1a\u4f7f\u5f97 $u,j$ \u95f4\u8fb9\u7684\u4e2a\u6570\u591a $1$\u3002\n- \u5bf9\u4e8e\u6bcf\u4e2a\u989c\u8272\u4e4b\u95f4\u7684\u4e8c\u5143\u7ec4 $(i,j)$ \u90fd\u8fd8\u9700\u8fde $a_{i,j}$ \u6761\u8fb9\uff0c\u5176\u4e2d $a_{i,j}$ \u4e3a $c_{i,j}$ \u51cf\u53bb $i,j$ \u5728\u679a\u4e3e\u7684\u751f\u6210\u6811\u4e0a\u662f\u5426\u5b58\u5728\u8fb9\u3002\n\n\u654f\u611f\u7684\u540c\u5b66\u5e94\u8be5\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u4e0d\u5c31\u4e00\u4e2a\u4e8c\u5206\u56fe\u591a\u91cd\u5339\u914d\u5417\uff1f\u6211\u4eec\u5c06\u6240\u6709\u989c\u8272\u5bf9 $(i,j)$ \u770b\u4f5c\u5de6\u90e8\u70b9\uff0c\u8fde\u4e00\u6761\u4ece\u6e90\u70b9\u50cf\u8fd9\u6837\u7684 $(i,j)$\uff0c\u5bb9\u91cf\u4e3a $a_{i,j}$ \u7684\u8fb9\uff0c\u6240\u6709\u989c\u8272 $i$ \u770b\u4f5c\u53f3\u90e8\u70b9\uff0c\u8fde\u4e00\u6761\u4ece $i$ \u5230\u6c47\u70b9\uff0c\u5bb9\u91cf\u4e3a $b_i-1$ \u7684\u8fb9\uff0c\u7136\u540e\u68c0\u9a8c\u8fd9\u5f20\u56fe\u662f\u5426\u5b58\u5728\u5b8c\u5907\u5339\u914d\u5373\u53ef\u3002\u8f93\u51fa\u65b9\u6848\u5c31 dinic \u8dd1\u904d\u6700\u5927\u6d41\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(\\text{\u80fd\u8fc7})$\u3002\n\n```cpp\nconst int MAXV=30;\nconst int MAXE=300*2;\nconst int INF=0x3f3f3f3f;\nint n,m,p[8],q[8],cnt[8];\nint S=29,T=30,hd[MAXV+5],to[MAXE+5],nxt[MAXE+5],cap[MAXE+5],ec=1;\nvoid init(){memset(hd,0,sizeof(hd));ec=1;}\nvoid adde(int u,int v,int f){\n\tto[++ec]=v;cap[ec]=f;nxt[ec]=hd[u];hd[u]=ec;\n\tto[++ec]=u;cap[ec]=0;nxt[ec]=hd[v];hd[v]=ec;\n} int dep[MAXV+5],now[MAXV+5];\nbool getdep(){\n\tmemset(dep,-1,sizeof(dep));dep[S]=0;\n\tqueue<int> q;q.push(S);now[S]=hd[S];\n\twhile(!q.empty()){\n\t\tint x=q.front();q.pop();\n\t\tfor(int e=hd[x];e;e=nxt[e]){\n\t\t\tint y=to[e],z=cap[e];\n\t\t\tif(!~dep[y]&&z){\n\t\t\t\tdep[y]=dep[x]+1;\n\t\t\t\tq.push(y);now[y]=hd[y];\n\t\t\t}\n\t\t}\n\t} return ~dep[T];\n}\nint getflow(int x,int f){\n\tif(x==T) return f;int ret=0;\n\tfor(int &e=now[x];e;e=nxt[e]){\n\t\tint y=to[e],z=cap[e];\n\t\tif(dep[y]==dep[x]+1&&z){\n\t\t\tint w=getflow(y,min(f-ret,z));\n\t\t\tcap[e]-=w;cap[e^1]+=w;ret+=w;\n\t\t\tif(ret==f) return ret;\n\t\t}\n\t} return ret;\n}\nint dinic(){\n\tint ret=0;\n\twhile(getdep()) ret+=getflow(S,INF);\n\treturn ret;\n}\nint num[8][8],cc[8][8],pru[8],deg[8],vis[8];\nvoid solve(){\n\tmemset(deg,0,sizeof(deg));\n\tmemset(vis,0,sizeof(vis));\n\tmemset(cc,0,sizeof(cc));\n\tfor(int i=1;i<=m-2;i++) deg[pru[i]]++;\n\tfor(int i=1;i<=m-2;i++){\n\t\tint pos=0;\n\t\tfor(int j=1;j<=m;j++){\n\t\t\tif(!deg[j]&&!vis[j]){pos=j;break;}\n\t\t} cc[min(pos,pru[i])][max(pos,pru[i])]++;\n//\t\teprintf(\"%d %d\\n\",pos,pru[i]);\n\t\tdeg[pru[i]]--;vis[pos]=1;\n\t} int u1=1,u2=m;\n\twhile(vis[u1]) u1++;\n\twhile(vis[u2]) u2--;\n\tcc[u1][u2]++;\n//\teprintf(\"%d %d\\n\",u1,u2);\n\tint cur=0;init();\n\tfor(int i=1;i<=m;i++) for(int j=i;j<=m;j++){\n\t\tif(cc[i][j]>num[i][j]) return;cur++;\n\t\tadde(S,cur,num[i][j]-cc[i][j]);\n\t\tadde(cur,m*(m+1)/2+i,INF);\n\t\tadde(cur,m*(m+1)/2+j,INF);\n\t} for(int i=1;i<=m;i++) adde(m*(m+1)/2+i,T,cnt[i]-1);\n\tif(dinic()==n-m){\n\t\tfor(int i=1;i<=m;i++) for(int j=i;j<=m;j++){\n\t\t\tif(cc[i][j]) printf(\"%d %d\\n\",p[i],p[j]);\n\t\t}\n\t\tfor(int i=1;i<=m;i++) q[i]=p[i];cur=0;\n\t\tfor(int i=1;i<=m;i++) for(int j=i;j<=m;j++){\n\t\t\tcur++;\n\t\t\tfor(int e=hd[cur];e;e=nxt[e]){\n\t\t\t\tint y=to[e],z=cap[e^1];\n\t\t\t\tif(y==S) continue;\n\t\t\t\tif(y-m*(m+1)/2==i){\n\t\t\t\t\twhile(z--) printf(\"%d %d\\n\",++q[i],p[j]);\n\t\t\t\t} else {\n\t\t\t\t\twhile(z--) printf(\"%d %d\\n\",++q[j],p[i]);\n\t\t\t\t}\n\t\t\t}\t\n\t\t}\n\t\texit(0);\n\t}\n}\nvoid dfs(int x){\n\tif(x==m-1) return solve();\n\tfor(int i=1;i<=m;i++) pru[x]=i,dfs(x+1);\n}\nint main(){\n\tscanf(\"%d\",&n);for(int cur=1;cur<=n;cur*=10) p[++m]=cur;\n\tfor(int i=1;i<m;i++) cnt[i]=p[i+1]-p[i];cnt[m]=n-p[m]+1;\n\tfor(int i=1;i<n;i++){\n\t\tstatic char s1[9],s2[9];\n\t\tscanf(\"%s%s\",s1+1,s2+1);\n\t\tint l1=strlen(s1+1),l2=strlen(s2+1);\n\t\tif(l1>l2) l1^=l2^=l1^=l2;\n\t\tnum[l1][l2]++;\n\t} if(m==1){\n\t\tif(num[1][1]!=n-1) return puts(\"-1\"),0;\n\t\tfor(int i=1;i<n;i++) printf(\"%d %d\\n\",i,i+1);\n\t\treturn 0;\n\t} dfs(1);puts(\"-1\");\n\treturn 0;\n}\n```\n\n",
        "postTime": 1618636023,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF611H New Year and Forgotten Tree"
    },
    {
        "content": "### CF 611H\n#### Solution\n\u4e3a\u4e86\u4fbf\u4e8e\u4e0b\u6587\u53d9\u8ff0\uff0c\u8003\u8651\u5c06\u6bcf\u4e00\u79cd\u4f4d\u6570\u770b\u6210\u4e00\u79cd\u989c\u8272\uff0c\u4e0d\u96be\u53d1\u73b0\u989c\u8272\u6700\u591a\u53ea\u6709$6$\u79cd\u3002\n\n\u6211\u4eec\u628a$1$\u53f7\u70b9\u5f53\u6210\u6839\uff0c\u90a3\u4e48\u6574\u68f5\u6811\u53ef\u4ee5\u770b\u505a\u6bcf\u6761\u8fb9\u548c\u5176\u513f\u5b50\u7684**\u5b8c\u7f8e\u5339\u914d**\uff0c\u8003\u8651\u5c06\u989c\u8272\u76f8\u540c\u7684\u70b9\u653e\u5728\u4e00\u8d77\u8003\u8651\uff0c\u6bcf\u4e00\u6b21\u53d6\u51fa\u4e24\u4e2a\u989c\u8272\u5224\u65ad\u5728\u8fd9\u4e24\u4e2a\u989c\u8272\u4e4b\u95f4\u8fde\u4e00\u6761\u8fb9\u662f\u5426\u5408\u6cd5\uff0c\u5408\u6cd5\u7684\u8bdd\u5c31\u9009\u62e9\u8fd9\u4e24\u4e2a\u989c\u8272\u7684\u4ee3\u8868\u70b9\u8fde\u8fb9\u3002\u7531\u4e8e\u8fd9\u662f\u4e00\u4e2a\u4e8c\u5206\u56fe\uff0c\u6839\u636e$Hall$\u5b9a\u7406\uff0c\u5982\u679c\u4e8c\u5206\u56fe$(X,Y)$\u5b58\u5728\u5b8c\u7f8e\u5339\u914d\u4e14$|X|\\leq |Y|$\uff0c\u90a3\u4e48\u5bf9\u4e8e$X$\u7684\u6bcf\u4e2a\u5b50\u96c6$S$\uff0c\u5b83\u5411\u53e6\u4e00\u8fb9\u8fde\u63a5\u7684\u70b9\u6570\u90fd\u8981$\\geq |S|$\uff0c\u6bcf\u6b21\u7528$Hall$\u5b9a\u7406\u5224\u65ad\u65b0\u52a0\u5165\u7684\u8fb9\u662f\u5426\u5408\u6cd5\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(\\text{\u80fd\u8fc7})$\n\n#### Code\n```cpp\nint n,m;\nint cnt[MAXM][MAXM],num[MAXM],id[MAXM],vis[MAXM];\nvector<pii> ans;\n\nbool check(){\n    for(int S = 1;S < (1 << m) - 1;S++){\n        int cnta = 0, cntb = 0;\n        for(int i = 1;i <= m;i++)\n            if(S >> (i - 1) & 1) cnta += num[i];\n        for(int i = 1;i <= m;i++)\n            for(int j = i;j <= m;j++)\n                if((S >> (i - 1) & 1) | (S >> (j - 1) & 1)) \n                    cntb += cnt[i][j];\n        if(cnta > cntb) return false;\n    }\n    return true;\n}\n\nint main(){\n    scanf(\"%d\",&n); int t = n; while(t) t /= 10, m += 1;\n    id[1] = 1; for(int i = 2;i <= m;i++) id[i] = id[i - 1] * 10;\n    for(int i = 1;i < m;i++) num[i] = id[i + 1] - id[i]; num[m] = n - id[m] + 1;\n    for(int i = 1;i < n;i++){\n        char a[MAXM],b[MAXM]; scanf(\"%s%s\",a + 1,b + 1);\n        int u = strlen(a + 1), v = strlen(b + 1);\n        cnt[u][v] += 1; if(u != v) cnt[v][u] += 1;\n    }\n    if(!check()) {puts(\"-1\"); return 0;}\n    int c = 0; vis[1] = 1; id[1] += 1; num[1] -= 1;\n    while(c < n - 1){\n        for(int i = 1;i <= m;i++){\n            if(!vis[i]) continue;\n            for(int j = 1;j <= m;j++){\n                if(!cnt[i][j] || !num[j]) continue;\n                cnt[i][j] -= 1; num[j] -= 1;\n                if(i != j) cnt[j][i] -= 1;\n                if(check()){\n                    ans.push_back(make_pair(id[i] - 1,id[j]));\n                    id[j] += 1; vis[j] = 1; c += 1;\n                }else{\n                    cnt[i][j] += 1; num[j] += 1;\n                    if(i != j) cnt[j][i] += 1;\n                }\n            }\n        }\n    }\n    for(auto p : ans) printf(\"%d %d\\n\",p.first,p.second);\n    return 0;\n}\n```",
        "postTime": 1611991281,
        "uid": 108894,
        "name": "\u5173\u6000\u4ed6\u4eba",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF611H \u3010New Year and Forgotten Tree\u3011"
    },
    {
        "content": "\u505a\u6cd5\u4e0d\u518d\u8d58\u8ff0\uff0c\u8865\u5145\u4e00\u4e9b\u7ec6\u8282\u3002\n\n\u8981\u6784\u9020\u4e00\u68f5\u6811\uff0c\u4e00\u79cd\u60f3\u6cd5\u662f\u5c1d\u8bd5\u5220\u53f6\u5b50\u5e76\u5224\u65ad\u662f\u5426\u5408\u6cd5\uff0c\u5373 zhoukangyang \u7684\u505a\u6cd5\u3002\n\n\u53e6\u4e00\u79cd\u662f\u5c1d\u8bd5\u628a\u6811\u8c03\u6574\u4e3a\u6bd4\u8f83\u597d\u7684\u5f62\u6001\u3002\u628a\u5341\u8fdb\u5236\u4e0b\u4f4d\u6570\u76f8\u540c\u7684\u653e\u5230\u4e00\u7ec4\uff0c\u6bcf\u7ec4\u4efb\u9009\u4e00\u4e2a\u70b9\u4f5c\u4e3a\u5173\u952e\u70b9\u3002\u7ed3\u8bba\u662f\u82e5\u6709\u89e3\uff0c\u4e00\u5b9a\u5b58\u5728\u4e00\u79cd\u65b9\u6848\u4f7f\u5f97\u6bcf\u6761\u8fb9\u4e24\u7aef\u81f3\u5c11\u6709\u4e00\u4e2a\u5173\u952e\u70b9\u3002  \n\u8bc1\u660e\u8003\u8651\u4ece\u4e00\u79cd\u65b9\u6848\u8c03\u6574\u3002\u5bf9\u4e8e\u4e24\u7aef\u90fd\u4e0d\u662f\u5173\u952e\u70b9\u7684\u8fb9 $(u,v)$\uff0c\u8bb0\u5176\u6240\u5728\u7ec4\u5173\u952e\u70b9\u4e3a $x,y$\uff0c\u5206\u7c7b\u8ba8\u8bba $(u,v)$ \u662f\u5426\u5728 $x,y$ \u8def\u5f84\u4e0a\u5e76\u636e\u6b64\u8c03\u6574\u5373\u53ef\u3002  \n\u636e\u6b64\u53ef\u4ee5\u5f97\u5230\u5173\u952e\u70b9\u7684\u5bfc\u51fa\u5b50\u56fe\u4ecd\u8fde\u901a\u3002\u8bc1\u660e\u7c7b\u4f3c\u3002\n\n\u5b9e\u73b0\u7ec6\u8282\uff1a\n\n1. \u7279\u5224 $n<10$\u3002\n2. \u5173\u952e\u70b9\u4e4b\u95f4\u7684\u8fb9\u8981\u5360\u7528\u7ec4\u4e4b\u95f4\u7684\u8fb9\u6570\u3002\n3. \u82e5\u65e0\u89e3\uff0cdfs \u56de\u6eaf\u524d\u8981\u6e05\u7a7a\uff0c\u522b\u63d0\u524d `return`\u3002\n\n[code](https://codeforces.com/contest/611/submission/165840056)",
        "postTime": 1658890207,
        "uid": 236866,
        "name": "401rk8",
        "ccfLevel": 9,
        "title": "CF611H New Year and Forgotten Tree \u9898\u89e3"
    }
]
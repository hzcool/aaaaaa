[
    {
        "content": "\u8003\u8651\u5bf9\u4e8e\u6240\u6709\u7684 $x$ \u6c42\u51fa\u7b54\u6848\uff0c\u8003\u8651\u7b54\u6848\u7684\u751f\u6210\u51fd\u6570\u3002\n\n\u663e\u7136 $\\dbinom{3j}{i}=[x^i](1+x)^{3j}$\uff0c\u90a3\u4e48\u6709 $\\displaystyle ans_i=\\sum_{j=1}^n\\dbinom{3j}{i}=[x^i]\\sum_{i=1}^n(1+x)^{3i}=[x^i]\\frac {(x+1)^{3n+3}-(x+1)^3}{(x+1)^3-1}$\u3002\n\n\u597d\u96be\u554a $3\\times 10^6$ \u8dd1 MTT \u8dd1\u4e2a\u9524\u5b50\uff08\u8d5b\u65f6\u771f\u5b9e\u60f3\u6cd5\uff09\u3002\n\n\u5b66\u591a\u9879\u5f0f\u5b66\u9b54\u6014\u4e86\uff0c\u76f4\u63a5\u5927\u9664\u6cd5\u5373\u53ef\u3002\n\n[code](https://codeforces.com/contest/1549/submission/124578681)\u3002",
        "postTime": 1627838294,
        "uid": 141179,
        "name": "pigstd",
        "ccfLevel": 9,
        "title": "CF1548C \u9898\u89e3"
    },
    {
        "content": "> \u7ed9\u5b9a\u4e00\u4e2a $n$ \u548c $q$\uff0c\u6709 $q$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u7ed9\u5b9a\u4e00\u4e2a $x$\u3002\n>\n> \u8981\u6c42\u4f60\u6c42\u51fa $\\sum\\limits_{i =1}^{n} \\binom{3i}{x}$\n>\n> $1 \\leq n \\leq 10^6,1 \\leq q \\leq 2\\times 10^5,x \\leq 3n$\n\n~~\u611f\u8c22\u5b66\u5f1f\u8ba9\u6211\u8fd9\u53ea\u5343\u5e74\u5927\u9e3d\u5b50\u7b2c\u4e00\u6b21\u6709\u5982\u6b64\u70ed\u60c5\u71ac\u591c\u8d76\u5de5~~\n\n\u9996\u5148\u89c2\u5bdf\u9898\u76ee\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u5b9e\u9645\u4e0a\u56e0\u4e3a\u662f  $3i$ \uff0c\u6211\u4eec\u53ef\u4ee5\u5206\u6210\u4e09\u7c7b\u6765\u8ba1\u7b97\uff1a$3i,3i+1,3i+2$ \u8fd9\u6837\u4f1a\u65b9\u4fbf\u6211\u4eec\u7684\u601d\u8003\u3002\n\n\u81ea\u7136\u7684\uff0c\u76f4\u63a5\u6c42\u548c\u5982\u679c\u6ca1\u6709\u4e00\u4e9b\u79d1\u6280\u662f\u4e0d\u592a\u73b0\u5b9e\u7684\uff0c\u6211\u4eec\u8003\u8651 DP\u3002\n\n\u8bbe $f_{i,k}$ \u8868\u793a $\\sum\\limits_{i = 0}^{n-1}\\binom{3i + k}{x}$ \uff0c\u8fd9\u6837\u5b9a\u4e49\u7684\u597d\u5904\u5728\u4e8e\uff0c\u6211\u4eec\u53d1\u73b0\u7b54\u6848\u53ef\u4ee5\u76f4\u63a5\u8868\u793a\u4e3a  $\\binom{3n}{x} + f_{n-1,0}$.\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651\u600e\u4e48\u8ba1\u7b97 $f_{x,k}$\uff0c\u6211\u4eec\u56de\u60f3\u4e00\u4e0b\u6709\u7ec4\u5408\u6052\u7b49\u5f0f \n$$\n\\displaystyle{ \\sum^n_{i=r}{i\\choose r}={n+1\\choose r+1} }\n$$\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6709\n$$\n\\displaystyle{ \\sum^{3n-1}_{i=0}{i\\choose x}= \\sum\\limits_{i = 0}^{n-1}\\binom{3i}{x} + \\sum\\limits_{i = 0}^{n-1}\\binom{3i + 1}{x} + \\sum\\limits_{i = 0}^{n-1}\\binom{3i + 2}{x} = {3n\\choose x+1} }\n$$\n\u53d8\u6210\u6211\u4eec\u521a\u624d\u7684\u5b9a\u4e49\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a\u4f18\u7f8e\u7684\u5f0f\u5b50\n$$\n\\displaystyle{f_{i,0} + f_{i,1} + f_{i,2} = {3i\\choose x+1}}\n$$\n\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u5173\u7cfb\u5f0f\uff0c\u4f46\u662f\u8fd9\u8fdc\u8fdc\u4e0d\u591f\uff0c\u6211\u4eec\u9700\u8981\u53d1\u6398\u66f4\u591a\u6027\u8d28\u3002\n\n\u7531\u5e15\u65af\u5361\u516c\u5f0f $\\binom{n-1}{m}+\\binom{n-1}{m-1} = \\binom{n}{m}$ \u6211\u4eec\u53ef\u4ee5\u5f97\u5230\n$$\n\\sum_{i=0}^{n-1} {3i \\choose x} + \\sum_{i=0}^{n-1} {3i \\choose x-1} = \\sum_{i=0}^{n-1} {3i+1 \\choose x}\n$$\n\u6211\u4eec\u53ef\u4ee5\u5c06 $i = 0,1$ \u5e26\u5165\uff0c\u5f97\u5230\u4e0b\u9762\u4e24\u4e2a\u5f0f\u5b50\n\n$$\nf_{i,1} = f_{i-1,0} + f_{i,0} \\\\\nf_{i,2} = f_{i-1,1} + f_{i,1}\n$$\n\n\u81f3\u6b64\uff0c\u6211\u4eec\u53d1\u73b0\u4e0a\u9762\u7684\u4e09\u4e2a\u5f0f\u5b50\u7ec4\u6210\u4e86\u4e00\u4e2a\u4e09\u5143\u4e00\u6b21\u65b9\u7a0b\u7ec4\uff0c\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u6362\u5143\uff0c\u5c1d\u8bd5\u89e3\u51fa $f_{i,0}$ \u76f4\u63a5\u7684\u9012\u63a8\u5f0f\u3002\n\n\u628a\u540e\u9762\u4e24\u4e2a\u5f0f\u5b50\u90fd\u4ee3\u56de\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u4e2d\u6613\u5f97\n\n$$\n3f_{i,0}={3i\\choose x+1} - 2f_{i-1,0} - f_{i-1,1} \\\\\nf_{i,0} = \\frac{{3i\\choose x+1} - 2f_{i-1,0} - f_{i-1,1}} {3}\n$$\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u603b\u7684\u9012\u63a8\u516c\u5f0f\uff1a\n$$\n\\left\\{\n\t\\begin{aligned} \n\tf_{i,0} &= \\frac{{3i\\choose x+1} - 2f_{i-1,0} - f_{i-1,1}} {3} \\\\\n\tf_{i,1} &= f_{i-1,0} + f_{i,0} \\\\\n\tf_{i,2} &= f_{i-1,1} + f_{i,1}\n\t\\end{aligned}\n\\right.\n$$\n\n\n\u8fb9\u754c\u6761\u4ef6\u4e3a $f_{0,0} = f_{0,1} = f_{0,2} = n$\n\n\u5bf9\u4e8e $1$ \u5230 $3n$ \u7684 $f_{i,0/1/2}$ \u9884\u5904\u7406\u4e00\u904d\uff0c\u6ce8\u610f\u9700\u8981\u4f7f\u7528\u7ebf\u6027\u6c42\u9006\u5143\uff0c\u5426\u5219\u53ef\u80fd\u88ab\u5361\u5e38\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n+q)$",
        "postTime": 1629737646,
        "uid": 105230,
        "name": "Retired_Doubeecat",
        "ccfLevel": 6,
        "title": "CF1548C The Three Little Pigs \u9898\u89e3"
    },
    {
        "content": "\u8bb0 $f_{i, j}\\ (0 \\le j \\le 2)$ \u4e3a $\\sum^{n - 1}_{i = 0} \\binom{3i + m}{x}$ \u7684\u503c\uff0c\u5219\u5bf9\u4e8e\u4e00\u4e2a\u8be2\u95ee $x$\uff0c\u7b54\u6848\u4e3a $f_{x, 0} + \\binom{3n}{x}$\u3002\n\n\u90a3\u4e48\u663e\u7136\u6709\uff1a\n- $f_{i, 0} + f_{i, 1} + f_{i, 2} = \\binom{3n}{i + 1}$\u3002\n- $f_{i, 1} = f_{i, 0} + f_{i - 1, 0}$\u3002\n- $f_{i, 2} = f_{i, 1} + f_{i - 1, 1}$\u3002\n- \u8fb9\u754c\u6761\u4ef6 $f_{0, 0} = f_{0, 1} = f_{0, 2} = n$\u3002\n\n\u6839\u636e\u4e0a\u8ff0\u5f0f\u5b50\u9884\u5904\u7406\u9012\u63a8\u6c42\u51fa $f$ \u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n + q)$\u3002\n\n\u4ee3\u7801\u5f88\u7b80\u5355\u5c31\u4e0d\u653e\u4e86\u3002",
        "postTime": 1628125188,
        "uid": 128141,
        "name": "Aestas16",
        "ccfLevel": 7,
        "title": "\u300c\u9898\u89e3\u300d[CF1548C] The Three Little Pigs"
    },
    {
        "content": "\u6570\u5b66\u597d\u4e45\u6ca1\u78b0\u5df2\u7ecf\u4e0d\u4f1a GF \u54af\uff01\n\n\u5728\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e2a\u5355\u53cd\u505a\u6cd5\u3002\n$$\\sum_{i=0}^{n}\\binom{i}{m}[3\\mid i]$$\n$$\\sum_{i=0}^{n}\\binom{i}{m}\\frac{1}{3}\\sum_{j=0}^{2}w_3^{ij}$$\n$$\\frac{1}{3}\\sum_{j=0}^{2}\\sum_{i=0}^{n}\\binom{i}{m}(w_3^j)^i$$\n$$F_j[m]=\\sum_{i=0}^{n}\\binom{i}{m}(w_3^j)^i$$\n$$F_j[m]=\\sum_{i=0}^{n}(\\binom{i-1}{m}+\\binom{i-1}{m-1})(w_3^j)^i$$\n$$F_j[m]=w_3^j(\\sum_{i=0}^{n-1}\\binom{i}{m}(w_3^j)^i+\\sum_{i=0}^{n-1}\\binom{i}{m-1}(w_3^j)^i)$$\n$$F_j[m]=w_3^j(F_j[m]-\\binom{n}{m}w_3^{nj}+F_j[m-1]-\\binom{n}{m-1}w_3^{nj})$$\n$$F_j[m]=w_3^j(F_j[m]+F_j[m-1]-\\binom{n+1}{m}w_3^{nj})$$\n$$F_j[m]=\\frac{w_3^jF_j[m-1]-\\binom{n+1}{m}w_3^{(n+1)j}}{1-w_3^j}$$\n\u6839\u636e\u9898\u610f\u8fd9\u91cc\u6709 $3\\mid n$\u3002\n$$F_j[m]=\\frac{w_3^jF_j[m-1]-\\binom{n+1}{m}w_3^j}{1-w_3^j}$$\n$$F_j[m]=\\frac{w_3^j}{1-w_3^j}\\times(F_j[m-1]-\\binom{n+1}{m})$$\n\u8bb0 $w_3^0=1,w_3^1=x,w_3^2=x^2$\uff0c\u7136\u540e\u5c06\u5355\u4f4d\u6839\u770b\u505a\u591a\u9879\u5f0f\u505a\u957f\u5ea6\u4e3a $3$ \u7684\u5faa\u73af\u5377\u79ef\u5373\u53ef\u3002\uff08\u8fd9\u91cc $x=\\frac{\\sqrt{3}i-1}{2},x^2=\\frac{-\\sqrt{3}i-1}{2}$\uff09\n\n\u6c42\u9006\u5143\uff1f\n\n\u4f60\u53ef\u4ee5\u624b\u6413\u9006\u5143\uff0c\u4f46\u662f\u5f97\u6839\u636e $x$ \u7684\u610f\u4e49\u6765\u6413\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\u4e0d\u53ef\u80fd\u51d1\u51fa\u6765 $1+0x+0x^2$\uff0c\u53ea\u80fd\u51d1\u51fa\u6765 $a+bx+cx^2$ \u6ee1\u8db3 $a-\\frac{b+c}{2}=1$ \u4e14 $b=c$\u3002\n\n\u8bbe $(1-x)\\times(t_0+t_1x+t_2x^2)=a+bx+bx^2$\u3002\n\n\u5176\u5b9e\u53ea\u9700\u8981\u51d1\u51fa\u6765 $b=c$ \u5c31\u884c\u4e86\u3002\u3002\u3002\u7b2c\u4e00\u4e2a\u9650\u5236\u53ef\u4ee5\u901a\u8fc7\u9664\u4ee5\u4e00\u4e2a\u5e38\u6570\u6765\u89e3\u51b3\u3002\n\n\u90a3\u4e48\u5c31\u662f $a=t_0-t_2,b=t_1-t_0=t_2-t_1$\n\n~~\u53ea\u9700\u8981\u6ee1\u8db3 $2\\times a\\neq b+c$ \u5c31\u884c\u4e86~~\n\n$b+c=t_2-t_0$\uff0c\u4fdd\u8bc1 $t_2\\neq t_0$ \u5c31\u53ef\u4ee5\u4e86\u3002\u3002\u3002\n\n\u53ef\u4ee5\u5f97\u5230\u4e00\u7ec4\u89e3\u662f $t_0=0,t_1=1,t_2=2$\u3002\n\n\u6b64\u65f6 $(1-x)(x+2x^2)=-2+x+x^2,a-\\frac{b+c}{2}=-3$\n\n\u6240\u4ee5\u9006\u5143\u662f $-\\frac{1}{3}x-\\frac{2}{3}x^2$\u3002\n\n\u540c\u7406\u53ef\u5f97 $-\\frac{2}{3}x-\\frac{1}{3}x^2$ \u662f $1-x^2$ \u7684\u9006\u5143\u3002\n\n\u590d\u6742\u5ea6 $O(n3^3)$\uff0c\u5e94\u8be5\u662f\u53ef\u4ee5\u8fc7\u53bb\u7684\u3002~~\u9700\u8981\u6ce8\u610f $j=0$ \u7684\u65f6\u5019 $F$ \u7684\u503c\u662f\u4e00\u4e2a\u7ec4\u5408\u6570~~\n\n\u542c\u8bf4\u597d\u50cf\u6709 $O(n3^2)$ \u7684\u7b80\u5355 GF \u505a\u6cd5\u3002\u679c\u7136\u8fd8\u662f\u6211\u592a\u83dc\u4e86\u3002\n$$ans_x=\\frac{F_0[x]+F_1[x]+F_2[x]}{3}$$\n```cpp\n#include<cstdio>\ntypedef unsigned ui;\ntypedef unsigned long long ull;\nconst ui M=3e6+5,inv3=333333336,mod=1e9+7;\nui n,q,F0[M],fac[M],ifac[M];\nstruct poly{\n\tui f0,f1,f2;\n\tpoly(const ui&f0=0,const ui&f1=0,const ui&f2=0):f0(f0),f1(f1),f2(f2){}\n\tinline ui&operator[](const ui&x){\n\t\treturn x==0?f0:x==1?f1:f2;\n\t}\n\tinline poly operator*(const ui&x)const{\n\t\treturn poly(1ull*f0*x%mod,1ull*f1*x%mod,1ull*f2*x%mod);\n\t}\n\tinline poly operator+(const poly&g)const{\n\t\treturn poly((f0+g.f0)%mod,(f1+g.f1)%mod,(f2+g.f2)%mod);\n\t}\n\tinline poly operator-(const poly&g)const{\n\t\treturn poly((f0+mod-g.f0)%mod,(f1+mod-g.f1)%mod,(f2+mod-g.f2)%mod);\n\t}\n\tinline poly operator*(poly g){\n\t\tull ans[3];ans[0]=ans[1]=ans[2]=0;\n\t\tfor(ui i=0;i^3;++i)for(ui j=0;j^3;++j)ans[i+j>=3?i+j-3:i+j]+=1ull*(*this)[i]*g[j];\n\t\treturn poly(ans[0]%mod,ans[1]%mod,ans[2]%mod);\n\t}\n}c,F1[M],F2[M];\ninline ui C(const ui&n,const ui&m){\n\treturn 1ull*ifac[m]*ifac[n-m]%mod*fac[n]%mod;\n}\ninline poly pow(poly a,ull b){\n\tpoly ans(1);for(;b;b>>=1,a=a*a)if(b&1)ans=ans*a;return ans;\n}\ninline ui pow(ui a,ui b){\n\tui ans(1);for(;b;b>>=1,a=1ull*a*a%mod)if(b&1)ans=1ull*ans*a%mod;return ans;\n}\nsigned main(){\n\tscanf(\"%u%u\",&n,&q);n*=3;fac[0]=fac[1]=ifac[0]=ifac[1]=1;\n\tfor(ui i=2;i<=n+1;++i)fac[i]=1ull*fac[i-1]*i%mod,ifac[i]=1ull*(mod-mod/i)*ifac[mod%i]%mod;\n\tfor(ui i=2;i<=n+1;++i)ifac[i]=1ull*ifac[i]*ifac[i-1]%mod;\n\tfor(ui i=0;i<=n;++i)F0[i]=C(n+1,i+1);\n\tc=poly(0,1,0)*poly(0,mod-inv3,(mod-2ull)*inv3%mod);\n\tF1[0]=poly(1,0,0);for(ui i=1;i<=n;++i)F1[i]=c*(F1[i-1]-C(n+1,i));\n\tc=poly(0,0,1)*poly(0,(mod-2ull)*inv3%mod,mod-inv3);\n\tF2[0]=poly(1,0,0);for(ui i=1;i<=n;++i)F2[i]=c*(F2[i-1]-C(n+1,i));\n\twhile(q--){\n\t\tui x;scanf(\"%u\",&x);\n\t\tpoly ans=poly(F0[x])+F1[x]+F2[x];\n\t\tprintf(\"%u\\n\",(ans.f0+500000003ull*(ans.f1+ans.f2))%mod*inv3%mod);\n\t}\n}\n```",
        "postTime": 1652441832,
        "uid": 160839,
        "name": "Prean",
        "ccfLevel": 7,
        "title": "\u6570\u8bba \u5355\u4f4d\u6839\u53cd\u6f14+\u6269\u57df CF1548C\u9898\u89e3"
    },
    {
        "content": "\u840c\u65b0\u7684\u7b2c\u4e00\u573a div1 \u80af\u5b9a\u8981\u53d1\u7bc7\u9898\u89e3\u7eaa\u5ff5\u4e00\u4e0b\uff08\uff09\n\n\u8c8c\u4f3c\u6211\u7684\u505a\u6cd5\u8ddf\u5b98\u65b9\u9898\u89e3\u4e24\u79cd\u548c\u76ee\u524d\u6240\u6709\u9898\u89e3\u90fd\u4e0d\u4e00\u6837/fad\n\n\u9996\u5148\u89c2\u5bdf\u5230\u9898\u76ee\u663e\u7136\u662f\u8ba9\u6211\u4eec\u6c42 $\\sum\\limits_{i=1}^n\\binom{3i}{x}$\uff0c\u8003\u8651\u80fd\u4e0d\u80fd\u9884\u5904\u7406\u3002\n\n\u6839\u636e\u7ec4\u5408\u6570\u6027\u8d28\u5217\u51fa\u5982\u4e0b\u5f0f\u5b50\uff1a\n\n\u5f53 $x=1$ \u65f6\uff0c\u7b54\u6848\u4e3a $3,6,9,\\cdots$\uff08\u6682\u4e14\u79f0\u4e3a\u5f0f\u5b50 $1-1$\uff09\u3002\n\n\u7c7b\u4f3c\u5730\u5217\u51fa\u4e24\u4e2a\u4e0d\u662f\u7b54\u6848\u7684\u5f0f\u5b50 $2,5,8,\\cdots$\uff08\u5f0f\u5b50 $1-2$\uff09\u548c $1,4,7,\\cdots$\uff08\u5f0f\u5b50 $1-3$\uff09\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f0f\u5b50 $x-1$ \u662f\u7531\u65e0\u7a77\u591a\u4e2a $\\binom{3i}{x}$ \u7ec4\u6210\u7684\uff0c$x-2$ \u548c $x-3$ \u662f\u7531\u65e0\u7a77\u591a\u4e2a $\\binom{3i-1}{x}$ \u548c $\\binom{3i-2}{x}$ \u7ec4\u6210\u7684\u3002\n\n\u7ee7\u7eed\u5199 $x=2,3,\\cdots$ \u53ef\u4ee5\u5f97\u5230\u4e0b\u8868\uff1a\n\n|\u5f0f\u5b50\u7f16\u53f7|\u5f0f\u5b50|\n|:-:|:-:|\n|$1-1$|$3,6,9,\\cdots$|\n|$1-2$|$2,5,8,\\cdots$|\n|$1-3$|$1,4,7,\\cdots$|\n|$2-1$|$3\\times 2,6\\times 5,9\\times 8,\\cdots$|\n|$2-2$|$2\\times 1,5\\times 4,8\\times 7,\\cdots$|\n|$2-3$|$0,4\\times 3,7\\times 6,\\cdots$|\n|$3-1$|$3\\times 2\\times 1,6\\times 5\\times 4,9\\times 8\\times 7,\\cdots$|\n|$3-2$|$0,5\\times 4\\times 3,8\\times 7\\times 6,\\cdots$|\n|$3-3$|$0,4\\times 3\\times 2,7\\times 6\\times 5,\\cdots$|\n\n\u5217\u51fa\u8fd9\u4e48\u591a\u5df2\u7ecf\u8db3\u591f\u4e86\uff0c\u8003\u8651\u5982\u4f55\u8fdb\u884c\u9012\u63a8\u3002\n\n\u6211\u4eec\u5bb9\u6613\u89c2\u5bdf\u5230 $x-1$ \uff08\u662f\u5f0f\u5b50\u7f16\u53f7\uff0c\u4e0b\u540c\uff09\u51cf\u53bb $x-2$ \u7684\u7ed3\u679c\u6070\u597d\u662f $(x-1)-2$ \u7684\u6574\u6570\u500d\uff0c$x-2$ \u51cf\u53bb $x-3$ \u7684\u7ed3\u679c\u6070\u597d\u662f $(x-1)-3$ \u7684\u6574\u6570\u500d\u3002\u524d\u8005\u7684\u6700\u540e\u51e0\u9879\u4e0e\u540e\u8005\u7684\u524d\u51e0\u9879\u662f\u76f8\u540c\u7684\uff0c\u5c06\u5b83\u4eec\u7528\u5206\u914d\u7387\u63d0\u53d6\u51fa\u6765\u53ef\u4ee5\u5f97\u5230\u9012\u63a8\u5f0f\uff0c\u56e0\u6b64\u6240\u6709\u7684 $x-2$ \u548c $x-3$ \u5f0f\u5b50\u90fd\u80fd\u6c42\u4e86\u3002\u518d\u6839\u636e\u4ed6\u4eec\u8ba1\u7b97\u6240\u6709\u7684 $x-1$ \u5f0f\u5b50\u5373\u53ef\u3002\n\n\u521d\u59cb\u72b6\u6001\u663e\u7136\u5728 $i\\in[1,n]$ \u7684\u9650\u5236\u4e0b\uff0c$1-1,1-2,1-3$ \u5f0f\u5b50\u7684\u548c\u5206\u522b\u662f $\\frac{3n+3}{2},\\frac{3n+1}{2},\\frac{3n-1}{2}$\u3002\n\n\u8f93\u51fa\u7b54\u6848\u65f6\u4e0d\u8981\u5fd8\u4e86\u4e58\u4ee5\u4e00\u4e2a $(x!)^{-1}$\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n//By: Luogu@rui_er(122461)\n#include <bits/stdc++.h>\n#define rep(x,y,z) for(int x=y;x<=z;x++)\n#define per(x,y,z) for(int x=y;x>=z;x--)\n#define debug printf(\"Running %s on line %d...\\n\",__FUNCTION__,__LINE__)\nusing namespace std;\ntypedef long long ll;\nconst ll N = 7e6+5, mod = 1e9+7;\n\nll n, q, fac[N], inv[N], facinv[N], ans[N];\ntemplate<typename T> void chkmin(T &x, T y) {if(x > y) x = y;}\ntemplate<typename T> void chkmax(T &x, T y) {if(x < y) x = y;}\nvoid initC(ll lim) {\n\tfac[0] = inv[0] = facinv[0] = 1;\n\tfac[1] = inv[1] = facinv[1] = 1;\n\trep(i, 2, lim) {\n\t\tfac[i] = fac[i-1] * i % mod;\n\t\tinv[i] = (mod - mod / i) * inv[mod%i] % mod;\n\t\tfacinv[i] = (mod - mod / i) * facinv[mod%i] % mod;\n\t}\n\trep(i, 2, lim) facinv[i] = facinv[i-1] * facinv[i] % mod;\n}\n\nint main() {\n\tscanf(\"%lld\", &n);\n\tinitC(3*n+1);\n\tll qwq = 0, qaq = 0;\n\tqwq = (3 * n - 1) % mod * n % mod * inv[2] % mod;\n\tqaq = (3 * n + 1) % mod * n % mod * inv[2] % mod;\n\tans[1] = (3 * n + 3) % mod * n % mod * inv[2] % mod;\n\trep(i, 2, 3*n) {\n\t\tll diff1 = qwq * i % mod;\n\t\tll diff2 = qaq * i % mod;\n\t\tll total = fac[3*n+1] * facinv[3*n-i] % mod * inv[i+1] % mod;\n\t\tll tmp = (2 * diff1 % mod + diff2) % mod;\n\t\tqwq = (total + mod - tmp) % mod * inv[3] % mod;\n\t\tqaq = (qwq + diff1) % mod;\n\t\tans[i] = (qaq + diff2) % mod * facinv[i] % mod;\n\t}\n\tfor(scanf(\"%lld\", &q);q;q--) {\n\t\tll x;\n\t\tscanf(\"%lld\", &x);\n\t\tprintf(\"%lld\\n\", ans[x]);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1628214660,
        "uid": 122461,
        "name": "rui_er",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1548C\u3010The Three Little Pigs\u3011"
    },
    {
        "content": "### $\\text{Difficulty : 2500}$\n---\n### \u89e3\u9898\u601d\u8def\uff1a\n\n\u4e00\u53e5\u8bdd\u9898\u610f\u5c31\u662f\u6c42\uff1a$\\sum_{i=1}^n\\dbinom{3i}{x}$\uff0c\u5176\u4e2d\u4ee4 $3i<x$ \u65f6 $\\dbinom{3i}{x}=0$\u3002\n\n---\n\u5bb9\u6613\u60f3\u5230\u7684\u65b9\u6cd5\u6709\u4e24\u4e2a\uff0c\u76f4\u63a5\u778e\u505a\u5c31\u662f $\\dbinom{3i}{t}=(1+x)^{3i}[x^t]$\uff0c\u6c42\u548c\u5c31\u662f $\\sum_{i=1}^{n}\\dbinom{3i}{t}=\\sum_{i=1}^n(1+x)^{3i}[x^t]=\\dfrac{(1+x)^3-(1+x)^{3n+3}}{1-(1+x)^3}$\u3002\n\n\u8fd9\u4e2a\u5f0f\u5b50\u5206\u6bcd\u6b21\u6570\u4e3a $3$\uff0c\u76f4\u63a5\u66b4\u529b\u5927\u9664\u6cd5 $O(n)$ \u7b97\u3002\n\n---\n\u53e6\u4e00\u79cd\u5c31\u662f\u7528\u7ec4\u5408\u6052\u7b49\u5f0f\u63a8\u3002\n\n\u76f4\u63a5\u6c42 $f_{x,0}=\\sum_{i=1}^n\\dbinom{3i}{x}$ \u4e4b\u95f4\u65ad\u5c42\u592a\u5927\uff0c\u4e0d\u65b9\u4fbf\u76f4\u63a5\u7b97\u51fa\u76f8\u90bb\u7684\u4e24\u9879\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u6240\u4ee5\u5f15\u5165 $f_{x,1}=\\sum_{i=1}^n\\dbinom{3i+1}{x}$ \u548c $f_{x,2}=\\sum_{i=1}^n\\dbinom{3i+2}{x}$\u3002\n\n\u9996\u5148\u6839\u636e\u6700\u57fa\u672c\u7684 $\\dbinom{n}{m}=\\dbinom{n-1}{m-1}+\\dbinom{n-1}{m}$ \u5f97\u5230 $f_{x,2}=f_{x,1}+f_{x-1,1}$ \u548c $f_{x,1}=f_{x,0}+f_{x-1,0}$\u3002\n\n\u4f46\u660e\u663e\uff0c\u53ea\u6709\u8fd9\u4e9b\u662f\u4e0d\u591f\u7684\uff0c\u8003\u8651\u7ec4\u5408\u6052\u7b49\u5f0f $\\sum_{i=1}^n\\dbinom{i}{x}=\\dbinom{n+1}{x+1}$\uff0c\u8be5\u6052\u7b49\u5f0f\u7684\u8bc1\u660e\u53ef\u4ee5\u7528\u5f52\u7eb3\u6cd5\u5f97\u51fa\uff0c\u4e5f\u53ef\u4ee5\u5c06\u6700\u4f4e\u9879 $\\dbinom{x}{x}$ \u7b49\u4ef7\u53d8\u4e3a $\\dbinom{x+1}{x+1}$ \u7136\u540e\u4e00\u5c42\u4e00\u5c42\u5411\u4e0a\u5316\u7b80\u5f97\u5230\u7ed3\u679c\u3002\n\n\u6709\u4e86\u8fd9\u4e2a\u6052\u7b49\u5f0f\uff0c\u5c31\u6709 $f_{x,0}+f_{x,1}+f_{x,2}=\\dbinom{3n+3}{x+1}$\u3002\n\n\u8fd9\u6837\u89e3\u4e00\u4e0b\u65b9\u7a0b\u5c31\u80fd\u5f97\u5230\uff1a$f_{x,0}=\\dfrac{\\dbinom{3n+3}{x+1}-2\\times f_{x-1,0}-f_{x-1,1}}{3}$\uff0c\u800c\u6839\u636e\u4e4b\u524d\u7684  $f_{x,1}=f_{x,0}+f_{x-1,0}$\uff0c\u5c31\u80fd\u76f4\u63a5 $O(n)$ \u9884\u5904\u7406\u51fa\u6240\u6709\u7b54\u6848\u4e86\u3002\n\n---\n### \u4ee3\u7801\uff1a\n\n\u91c7\u7528\u7b2c\u4e00\u79cd\u65b9\u6cd5\u3002\n\n```cpp\n#include<cstdio>\nusing namespace std;\n#define int long long\nconst int MOD=1000000007;\nint n,T,x,f[4000006],F[4000006],a[4000006],ans[4000006],b[4000006];\nint pow(int a,int b){\n\tint ans=1;\n\twhile(b){\n\t\tif(b&1)ans=(ans*a)%MOD;\n\t\ta=(a*a)%MOD;\n\t\tb=b>>1;\n\t}\n\treturn ans;\n}\nint C(int n,int m){\n\tif(n<m)return 0;\n\treturn f[n]*F[m]%MOD*F[n-m]%MOD;\n}\nsigned main(){\n\tscanf(\"%lld%lld\",&n,&T);\n\tf[0]=1;F[0]=1;\n\tfor(int i=1;i<=3*n+5;i++)f[i]=(f[i-1]*i)%MOD;\n\tF[3*n+5]=pow(f[3*n+5],MOD-2);\n\tfor(int i=3*n+4;i>=1;i--)F[i]=F[i+1]*(i+1)%MOD;\n\ta[0]=-1;a[1]=-3;a[2]=-3;a[3]=-1;\n\tfor(int i=0;i<=3*n+3;i++)a[i]+=C(3*n+3,i);\n\tfor(int i=3*n+3;i>=3;i--){\n\t\tans[i-3]=a[i];\n\t\ta[i-1]=((a[i-1]-3*a[i]+MOD)%MOD+MOD)%MOD;\n\t\ta[i-2]=((a[i-2]-3*a[i]+MOD)%MOD+MOD)%MOD;\n\t}\n\twhile(T--){\n\t\tscanf(\"%lld\",&x);\n\t\tprintf(\"%lld\\n\",ans[x]);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1665210678,
        "uid": 223559,
        "name": "qxp101",
        "ccfLevel": 6,
        "title": "CF1548C The Three Little Pigs \u9898\u89e3"
    },
    {
        "content": "[LG CF1548C](https://www.luogu.com.cn/problem/CF1548C)\n\n[CF1548C](https://codeforces.com/problemset/problem/1548/C)\n\n**\u7b80\u8981\u9898\u610f**\n\n- \u7ed9\u5b9a $n,q$\uff0c\u6709 $q$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u7ed9\u5b9a $x$\uff0c\u6c42 $\\sum_{i=1}^n \\binom{3i}{x}$\n\n**Solution 1 \uff08\u751f\u6210\u51fd\u6570\uff09**\n\n- $\\binom{y}{t}=(1+x)^y[x^t]$\uff0c\u90a3\u4e48 $Ans=\\sum_{i=1}^n (1+x)^{3i}[x^t]$ \n\n- \u6839\u636e\u7b49\u6bd4\u6570\u5217\u516c\u5f0f\uff0c$Ans=\\frac{(1+x)^3-(1+x)^{3n+3}}{1-(1+x)^3}$\n- \u8fd9\u4e2a\u53ef\u4ee5\u76f4\u63a5\u66b4\u529b\u9664\uff0c\u5217\u7ad6\u5f0f\u9012\u63a8\n\n**Solution 2 \uff08dp + \u7ec4\u5408\u6570\u5b66\uff09**\n\n- \u8bbe $f_{x,j}=\\sum_{i=0}^n \\binom{3i+j}{x}$\uff0c\u7b54\u6848\u5c31\u662f $f_{x,0}$\n\n- $f_{x,0}+f_{x,1}+f_{x,2}=\\sum_{i=0}^{3n+2} \\binom{i}{x}=\\binom{3n+3}{x+1}$ \n- \u56e0\u4e3a $\\binom{n}{m}=\\binom{n}{m-1}+\\binom{n-1}{m-1}$\uff0c$f_{x,1}=f_{x-1,1}+f_{x-1,0},f_{x,2}=f_{x-1,2}+f_{x-1,1}$\n- \u6839\u636e\u4e0a\u9762\u4e09\u4e2a\u5f0f\u5b50\u5c31\u53ef\u4ee5\u9012\u63a8\u4e0b\u53bb\u4e86\n\n**\u53c2\u8003\u4ee3\u7801\uff08\u751f\u6210\u51fd\u6570\uff09\uff1a**\n\n```cpp\nconst int N=3e6+10;\nint fac[N],ifac[N],ans[N],num[N],n,q;\ninline int C(int x,int y) {\n\tif(x<y) return 0;\n\treturn MOD(MOD(fac[x]*ifac[y])*ifac[x-y]);\n}\n\nsigned main(){\n//start at 20:45\n//end at 20:58\n#ifdef LOCAL\n    Fin(\"1\");\n#endif\n    auto init = [&] (){\n    \tfac[0]=ifac[0]=1;\n    \tFOR(i,1,3*n+3) fac[i]=MOD(fac[i-1]*i);ifac[3*n+3]=ksm(fac[3*n+3],mod-2);\n    \tROF(i,3*n+2,1) ifac[i]=MOD(ifac[i+1]*(i+1));\n    };n=read(),q=read();init();\n    FOR(i,0,3*n+3) num[i]=C(3*n+3,i);\n    num[0]=dec(num[0],1);num[1]=dec(num[1],3);num[2]=dec(num[2],3);num[3]=dec(num[3],1);\n    ROF(i,3*n+3,3) {\n    \tans[i-3]=num[i];\n    \tnum[i-1]=dec(num[i-1],MOD(3*num[i]));\n    \tnum[i-2]=dec(num[i-2],MOD(3*num[i]));\n    }\n    while(q--) printf(\"%d\\n\",ans[read()]);\n#ifdef LOCAL        \n    fprintf(stderr,\"%f\\n\",1.0*clock()/CLOCKS_PER_SEC);\n#endif\n    return 0;\n}\n```\n\n",
        "postTime": 1658322017,
        "uid": 756636,
        "name": "stOqwqOrz",
        "ccfLevel": 0,
        "title": "CF1548C The Three Little Pigs"
    },
    {
        "content": "\u7b80\u5355\u751f\u6210\u51fd\u6570\u7ec3\u4e60\u9898\uff08\uff1f\uff09\u3002\n\n------------\n\u4e3a\u4e86\u65b9\u4fbf\u63cf\u8ff0\uff0c\u6587\u4e2d\u6240\u6709\u7684 $t$ \u8868\u793a\u6bcf\u6b21\u8be2\u95ee\u7684\u6570\uff0c\u4ee5\u9632\u548c\u751f\u6210\u51fd\u6570\u4e2d\u7684 $x$ \u641e\u6df7\u3002\n\n------------\n\n\u9898\u610f\u5373\u5bf9\u4e8e\u6240\u6709\u8be2\u95ee\u7684 $t$\uff0c\u6c42 $\\sum\\limits_{i=1}^n\\dbinom{3i}{t}$\u3002\n\n\u8f6c\u6362\u6210\u751f\u6210\u51fd\u6570\u7684\u5f62\u5f0f\uff0c\u90a3\u4e48\u4e0a\u5f0f\u5c31\u53d8\u6210\u4e86 $\\left[x^t\\right]\\sum\\limits_{i=1}^n\\left(1+x\\right)^{3i}$\u3002\n\n\u8bb0 $F(x)=\\sum\\limits_{i=1}^n\\left(1+x\\right)^{3i}$\uff0c\u7531\u7b49\u6bd4\u6570\u5217\u516c\u5f0f\u6613\u77e5 $F(x)=\\dfrac{(1+x)^3-(1+x)^{3(n+1)}}{1-(1+x)^3}$\u3002\n\n\u5f0f\u5b50\u4e0a\u9762\u76f4\u63a5\u7528\u7ec4\u5408\u6570\u516c\u5f0f\u53ef\u4ee5 $O(n)$ \u7b97\u51fa\uff0c\u4e0b\u9762\u56e0\u4e3a\u6700\u9ad8\u6b21\u9879\u53ea\u6709\u4e09\u6b21\uff0c\u6240\u4ee5\u76f4\u63a5\u66b4\u529b\u505a\u9664\u6cd5\u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6 $O(n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define p 1000000007\nusing namespace std;\nint jc[3000005],ny[3000005];\nint n,q,a[3000005],b[3000005];\nint dr()\n{\n\tint xx=0;char ch=getchar();\n\twhile(ch<'0'||ch>'9')ch=getchar();\n\twhile(ch>='0'&&ch<='9')xx=xx*10+ch-'0',ch=getchar();\n\treturn xx;\n}\nint C(int x,int y){return 1ll*jc[x]*ny[y]%p*ny[x-y]%p;}\nint main()\n{\n\tn=dr(),q=dr();\n\tjc[0]=ny[0]=ny[1]=1;\n\tfor(int i=1;i<=3*n+3;i++)jc[i]=1ll*i*jc[i-1]%p;\n\tfor(int i=2;i<=3*n+3;i++)ny[i]=1ll*(p-p/i)*ny[p%i]%p;\n\tfor(int i=1;i<=3*n+3;i++)ny[i]=1ll*ny[i]*ny[i-1]%p;\n\tfor(int i=0;i<=3*n+3;i++)a[i]=C(3*n+3,i);\n\ta[0]-=1,a[1]-=3,a[2]-=3,a[3]-=1;\n\ta[0]+=a[0]<0?p:0,a[1]+=a[1]<0?p:0,a[2]+=a[2]<0?p:0,a[3]+=a[3]<0?p:0;\n\tfor(int i=1;i<=3*n+3;i++)a[i-1]=a[i];\n\tfor(int i=3*n+2;i>1;i--)\n\t{\n\t\tb[i-2]=a[i];\n\t\ta[i-1]=((a[i-1]-3ll*a[i])%p+p)%p,a[i-2]=((a[i-2]-3ll*a[i])%p+p)%p;\n\t}\n\twhile(q--)printf(\"%d\\n\",b[dr()]);\n}\n```\n",
        "postTime": 1628160800,
        "uid": 104581,
        "name": "kkk\u7684\u5c0f\u8214\u72d7",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1548C \u3010The Three Little Pigs\u3011"
    },
    {
        "content": "\u9898\u76ee\u76f8\u5f53\u4e8e\u8ba9\u6211\u4eec\u6c42\uff1a\n\n$$\\sum_{i=0}^n\\binom{3i}x$$\n\n\u8003\u8651\u7528 dp \u6c42\u51fa\u8fd9\u4e2a\u5f0f\u5b50\u3002\u8bbe\uff1a\n\n$$f_{x,j}=\\sum_{i=0}^n\\binom{3i+j}x,0\\le j\\le 2$$\n\n\u90a3\u4e48\u7b54\u6848\u5c31\u662f $f_{x,0}$\u3002\n\n\u6211\u4eec\u8fd0\u7528\u516c\u5f0f $\\binom nm=\\binom{n-1}m+\\binom{n-1}{m-1}$\uff0c\u53ef\u4ee5\u63a8\u51fa $f_{x,1},f_{x,2}$ \u7684\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$f_{x,j}=\\sum_{i=0}^n\\binom{3i+j}x=\\sum_{i=0}^n\\binom{3i+j-1}x+\\sum_{i=0}^n\\binom{3i+j-1}{x-1}=f_{x,j-1}+f_{x-1,j-1},1\\le j\\le 2$$\n\n\u6211\u4eec\u8fd0\u7528\u516c\u5f0f $\\sum_{i=0}^n\\binom ix=\\binom{n+1}{x+1}$\uff0c\u53ef\u4ee5\u63a8\u51fa $f_{x,0}$ \u7684\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$f_{x,0}=(f_{x,0}+f_{x,1}+f_{x,2})-f_{x,1}-f_{x,2}=\\sum_{i=0}^{3n+2}\\binom ix-f_{x,1}-f_{x,2}=\\binom{3n+3}{x+1}-f_{x,1}-f_{x,2}$$\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u65b9\u7a0b\u7ec4\uff1a\n\n$$\n\\begin{cases}\nf_{x,0}=\\binom{3n+3}{x+1}-f_{x,1}-f_{x,2}\\\\\nf_{x,1}=f_{x,0}+f_{x-1,0}\\\\\nf_{x,2}=f_{x,1}+f_{x-1,1}\n\\end{cases}\n$$\n\n\u89e3\u5f97\uff1a\n\n$$\n\\begin{cases}\nf_{x,0}=\\dfrac{\\binom{3n+3}{x+1}-2f_{x-1,0}-f_{x-1,1}}{3}\\\\\nf_{x,1}=f_{x,0}+f_{x-1,0}\\\\\nf_{x,2}=f_{x,1}+f_{x-1,1}\n\\end{cases}\n$$\n\n\u8fb9\u754c\uff1a$f_{0,0}=f_{0,1}=f_{0,2}=n+1$\u3002\n\n```cpp\ntypedef long long ll;\n\nconst int N=1e6;\nconst int P=1e9+7;\n\nint n,m,f[N*3+10][3];\nint fac[N*3+10],ifac[N*3+10];\n\ninline int qpow(int a,int b,int p){\n\tint res=1;\n\twhile(b){if(b&1)res=1LL*res*a%p;a=1LL*a*a%p;b>>=1;}\n\treturn res;\n}\n\ninline int inv(int a,int p){return qpow(a,p-2,p);}\n\nvoid initComb(int p){\n\tint lim=std::min(n*3+5,p-1);\n\tfac[0]=1;for(int i=1;i<=lim;i++)fac[i]=1LL*fac[i-1]*i%p;\n\tifac[lim]=inv(fac[lim],p);for(int i=lim-1;i>=0;i--)ifac[i]=1LL*ifac[i+1]*(i+1)%p;\n}\n\ninline int C(int a,int b,int p){if(a<b)return 0;else return 1LL*fac[a]*ifac[b]%p*ifac[a-b]%p;}\n\nvoid mian(){\n\tscanf(\"%d%d\",&n,&m);\n\tinitComb(P);\n\tf[0][0]=f[0][1]=f[0][2]=n+1;\n\tint inv3=inv(3,P);\n\tfor(int i=1;i<=n*3;i++){\n\t\tf[i][0]=1LL*(((C(3*n+3,i+1,P)-2*f[i-1][0]%P-f[i-1][1])%P+P)%P)*inv3%P;\n\t\tf[i][1]=(f[i][0]+f[i-1][0])%P;\n\t\tf[i][2]=(f[i][1]+f[i-1][1])%P;\n\t}\n\twhile(m--){\n\t\tint x;scanf(\"%d\",&x);\n\t\tprintf(\"%d\\n\",f[x][0]);\n\t}\n}\n```",
        "postTime": 1628163398,
        "uid": 242702,
        "name": "registerGen",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1548C \u3010The Three Little Pigs\u3011"
    },
    {
        "content": "\u8d5b\u65f6\u6ca1\u60f3\u51fa\u6765\uff0c\u4e8e\u662f\u6765\u5199\u7bc7\u9898\u89e3\u3002\n\n**\u9898\u610f\uff1a**\n\n\u7ed9\u5b9a $ n $\uff0c\u5171 $ q $ \u4e2a\u8be2\u95ee\uff0c\u5bf9\u6bcf\u4e2a\u8be2\u95ee\u8f93\u5165\u4e00\u4e2a $ x $\uff0c\u6c42 $ \\sum_{i=0}^n\\binom{3i}x $\uff0c\u5bf9 $ 10^9+7 $ \u53d6\u6a21\u3002\n\n**\u9898\u89e3\uff1a**\n\n\u770b\u5230\u7ec4\u5408\u6570\uff0c\u4e00\u5f00\u59cb\u80af\u5b9a\u60f3\u63a8\u5f0f\u5b50\uff0c\u7136\u540e\u53d1\u73b0\u63a8\u4e0d\u51fa\uff08\u81f3\u5c11\u6211\u662f\u8fd9\u6837\uff09\u3002\u53ef\u4ee5\u8003\u8651 DP \u6765\u9012\u63a8\u3002\u7528\u4e00\u4e2a\u6570\u7ec4 $ f_{x,k} $ ($ k\\in\\{0,1,2\\} $) \u6765\u8868\u793a $ \\sum_{i=0}^{n}\\binom{3i+k}{x} $\u3002\n\n\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u60f3\u4e00\u60f3\u600e\u4e48\u9012\u63a8\u3002\u9996\u5148\u60f3\u5230\u7684\u80af\u5b9a\u662f\u6211\u4eec\u6700\u5e38\u7528\u7684\u9012\u63a8\u5f0f $ \\binom nm=\\binom {n-1}m+\\binom{n-1}{m-1} $\u3002\u7528\u5b83\u53ef\u4ee5\u5f97\u51fa\u5982\u4e0b\u5f0f\u5b50\uff1a\n$$\n(1)\\ f_{x,0}=\\sum_{i=0}^n\\binom{3i}x=\\sum_{i=0}^{n-1}\\binom{3i+2}x+\\sum_{i=0}^{n-1}\\binom{3i+2}{x-1}=f_{x,2}+f_{x-1,2}-\\binom{3n+2}x-\\binom{3n+2}{x-1}\n$$\n$$\n(2)\\ f_{x,1}=\\sum_{i=0}^n\\binom{3i+1}x=\\sum_{i=0}^n\\binom{3i}x+\\sum_{i=0}^n\\binom{3i}{x-1}=f_{x,0}+f_{x-1,0}\n$$\n$$\n(3)\\ f_{x,2}=\\sum_{i=0}^n\\binom{3i+2}x=\\sum_{i=0}^n\\binom{3i+1}x+\\sum_{i=0}^n\\binom{3i+1}{x-1}=f_{x,1}+f_{x-1,1}\n$$\n\n\u4f60\u4f1a\u53d1\u73b0\u6211\u4eec\u7684\u8f6c\u79fb\u65b9\u7a0b\u4e2d\u5305\u542b\u4e86\u672c\u9636\u6bb5\u7684\u72b6\u6001\uff01\u5e76\u4e14\u5bb9\u6613\u53d1\u73b0\uff0c\u5982\u679c\u628a (2) \u5f0f\u5e26\u5165 (3) \u5f0f\uff0c\u518d\u628a (3) \u5e26\u5165 (1)\uff0c\u6211\u4eec\u5c06\u5f97\u5230\uff1a\n$$\nf_{x,0}=f_{x,0}+f_{x-1,0}+f_{x-1,1}+f_{x-1,2}-\\binom{3n+2}x-\\binom{3n+2}{x-1}\n$$\n$ f_{x,0} $ \u88ab\u6d88\u6389\u4e86\uff0c\u6211\u4eec\u4ec0\u4e48\u4e5f\u6ca1\u5f97\u5230\u3002\u6211\u4eec\u53ea\u597d\u60f3\u5176\u5b83\u529e\u6cd5\u3002\n\n\u7b49\u7b49\uff01$ f_{x,0} $ \u88ab\u6d88\u6389\u4e4b\u540e\u7684\u5f0f\u5b50\u662f\uff1a\n$$\nf_{x-1,0}+f_{x-1,1}+f_{x-1,2}=\\binom{3n+2}x+\\binom{3n+2}{x-1}\n$$\n\u5316\u4e00\u4e0b\uff1a\n$$\nf_{x,0}+f_{x,1}+f_{x,2}=\\binom{3n+2}{x+1}+\\binom{3n+2}{x}=\\binom{3n+3}{x+1}\n$$\n\u7528\u8fd9\u4e2a\u5f0f\u5b50\u66ff\u6362\u6389 (1) \u5f0f\uff0c\u5c31\u5f97\u51fa\u4e86\u4e00\u4e2a\u53ef\u89e3\u7684\u65b9\u7a0b\u7ec4\uff1a\n$$\n(1)\\ f_{x,0}+f_{x,1}+f_{x,2}=\\binom{3n+3}{x+1}\n$$\n$$\n(2)\\ f_{x,1}=f_{x,0}+f_{x-1,0}\n$$\n$$\n(3)\\ f_{x,2}=f_{x,1}+f_{x-1,1}\n$$\n\u89e3\u4e00\u4e0b\uff1a\n$$\nf_{x,0}=\\frac13[\\binom{3n+3}{x+1}-2f_{x-1,0}-f_{x-1,1}]\n$$\n\u6211\u4eec\u6210\u529f\u89e3\u51b3\u4e86\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u3002\u8fb9\u754c\u5f88\u7b80\u5355\uff1a$ f_{0,0}=f_{0,1}=f_{0,2}=n+1 $\u3002\n\n\u6211\u4eec\u9884\u5904\u7406\u51fa $ f $ \u6570\u7ec4\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\uff0c\u7b54\u6848\u5c31\u662f $ f_{x,0} $\u3002\n\n\u901a\u8fc7\u4ee5\u4e0a\u5206\u6790\uff0c\u6211\u4eec\u53d1\u73b0 $ f_{x,2} $ \u5e76\u6ca1\u6709\u4ec0\u4e48\u5375\u7528\uff0c\u6240\u4ee5\u5728\u4ee3\u7801\u4e2d\u53ef\u4ee5\u4e0d\u8ba1\u7b97\u5b83\u3002\n\n\u5982\u679c\u76f4\u63a5\u7528\u5feb\u901f\u5e42\u6c42\u9006\u5143\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $ O(n\\log P+q) $\uff08$ P $ \u8868\u793a\u6a21\u6570\uff09\uff0c\u4f1a\u88ab\u6bd2\u7624\u6570\u636e\u5361\u6389\u3002\u6240\u4ee5\u6211\u4eec\u8981\u53bb\u5b66\u4e60\u4e00\u4e0b[\u7ebf\u6027\u9884\u5904\u7406\u4efb\u610f n \u4e2a\u6570\u7684\u9006\u5143](https://www.luogu.com.cn/problem/P5431)\u3002\u4e8e\u662f\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $ O(n+\\log P+q) $\u3002\u8fd9\u6837\u5c31\u80fd\u901a\u8fc7\u4e86\u3002\n\n**AC Code (C++11, \\#124640483)**\n```cpp\n#include<cctype>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\ntypedef long long ll;\nusing namespace std;\ntemplate<typename T>inline void read(T&x){\n\tregister int c=getchar();x=0;bool f=0;\n\tfor(;!isdigit(c);c=getchar())f^=!(c^45);\n\tfor(;isdigit(c);c=getchar())x=(x<<1)+(x<<3)+(c^48);\n\tif(f)x=-x;\n}\ntemplate<typename T,typename... Args>inline void read(T&x,Args&...args){\n\tread(x);read(args...);\n}\ntemplate<typename T>inline void write(T x){\n\tstatic int sta[35];register int top=0;\n\tif(x<0)x=-x,putchar('-');\n\tdo{sta[top++]=x%10,x/=10;}while(x);\n\twhile(top)putchar(sta[--top]+'0');\n}\ntemplate<typename T>inline void write(T x,const char &c){\n\twrite(x),putchar(c);\n}\nconst int N=1e6+20,P=1e9+7;\ninline ll quickPow(ll a,ll b){\n\tll ret=1;\n\twhile(b){\n\t\tif(b&1)(ret*=a)%=P;\n\t\t(a*=a)%=P;b>>=1;\n\t}\n\treturn ret;\n}\nll fact[N*3],inv[N*3],s[N*3],sv[N*3];\ninline ll C(int n,int m){\n\tif(n<m)return 0;\n\tif(m==0)return 1;\n\treturn fact[n]*inv[m]%P*inv[n-m]%P;\n}\nint n,q;\nll f[N*3][2];\nint main(){\n\tread(n,q);f[0][0]=f[0][1]=n+1;fact[0]=s[0]=1;\n\tfor(register int i=1;i<=3*n+3;i++){\n\t\tfact[i]=fact[i-1]*i%P;\n\t\ts[i]=s[i-1]*fact[i]%P;\n\t}\n\tsv[n*3+3]=quickPow(s[n*3+3],P-2);\n\tfor(register int i=n*3+3;i>=1;i--)sv[i-1]=sv[i]*fact[i]%P;\n\tfor(register int i=1;i<=n*3+3;i++)inv[i]=sv[i]*s[i-1]%P;\n\tll inv3=quickPow(3,P-2);\n\tfor(register int x=1;x<=3*n;x++){\n\t\tf[x][0]=inv3*(((C(3*n+3,x+1)-2*f[x-1][0]+2*P)%P-f[x-1][1]+P)%P)%P;\n\t\tf[x][1]=(f[x][0]+f[x-1][0])%P;\n\t}\n\tint X;\n\twhile(q--){\n\t\tread(X);\n\t\twrite(f[X][0],'\\n');\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1627874692,
        "uid": 311369,
        "name": "hihihi198",
        "ccfLevel": 0,
        "title": "CF1549E/1548C \u9898\u89e3"
    }
]
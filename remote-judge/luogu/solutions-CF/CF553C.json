[
    {
        "content": "[\u4f20\u9001\u95e8](https://codeforces.ml/contest/553/problem/C)\n\n\u548c APIO2011 \u7684\u65b9\u683c\u67d3\u8272\u6709\u70b9\u50cf\uff0c\u53ef\u60dc\u6628\u5929\u6a21\u62df\u8d5b\u4e0a\u628a\u8fb9\u6743\u8f6c\u70b9\u6743\u60f3\u9519\u4e86\u3002\n\n\u5b9a\u4e49\u4e00\u6761\u7231\u8fb9\u8fb9\u6743\u4e3a $1$\uff0c\u6068\u8fb9\u8fb9\u6743\u4e3a $0$\u3002\n\n\u6ce8\u610f\u5230\u9898\u76ee\u91cc\u201d\u4efb\u610f\u4e09\u4e2a\u4eba\u201c\u662f\u4e00\u4e2a\u5f88\u5f3a\u7684\u7ea6\u675f\u3002\u8003\u8651\u4e00\u6761 $1$ \u8fb9 $(u,v)$ \u4ea7\u751f\u7684\u7ea6\u675f\uff1a\u5bf9\u4e8e\u4e00\u4e2a\u5176\u5b83\u7684\u70b9 $w$\uff0c$(u,w)$ \u548c $(v,w)$ \u5e94\u8be5\u8fb9\u6743\u76f8\u540c\u3002\n\n\u518d\u8003\u8651\u4e00\u6761 $0$ \u8fb9 $(u,v)$ \u4ea7\u751f\u7684\u7ea6\u675f\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5176\u5b83\u7684\u70b9 $w$\uff0c$(u,w)$ \u548c $(v,w)$ \u5e94\u8be5\u8fb9\u6743\u4e0d\u540c\u3002\n\n\u7136\u540e\u8003\u8651\u4e00\u4e2a\u6027\u8d28\uff1a\u5bf9\u4e8e $u,v,w$\uff0c\u6211\u4eec\u4efb\u610f\u5b9a\u4e0b\u5176\u4e2d\u4efb\u610f\u4e24\u6761\u8fb9\u7684\u8fb9\u6743\uff0c\u5269\u4e0b\u4e00\u6761\u8fb9\u7684\u5408\u6cd5\u8fb9\u6743\u5e94\u8be5\u552f\u4e00\u786e\u5b9a\u3002\u5373$(1,1)\\rightarrow 1,(1,0)/(0,1)\\rightarrow 0,(0,0)\\rightarrow 1$\u3002\n\n\u4e8e\u662f\u5f97\u5230\u7ed3\u8bba\uff1a\u5982\u679c\u6211\u4eec\u628a\u7ed9\u51fa\u7684\u6240\u6709\u8fb9\uff08\u65e0\u8bba\u8fb9\u6743\uff09\u8fde\u4e0a\u3002\u6700\u540e\uff0c\u5bf9\u4e8e\u4efb\u610f\u4e24\u4e2a\u6781\u5927\u8fde\u901a\u5757\uff0c\u5176\u8fde\u6cd5\u53ea\u6709 $2$ \u79cd\u3002\u8fd9\u662f\u56e0\u4e3a\uff0c\u786e\u5b9a\u4e24\u4e2a\u8fde\u901a\u5757\u4e4b\u95f4\u7684\u4e00\u6761\u8fb9\u7684\u8fb9\u6743\uff0c\u6839\u636e\u4e0a\u9762\u7684\u6027\u8d28\uff0c\u5269\u4e0b\u7684\u8fde\u63a5\u4e24\u4e2a\u8fde\u901a\u5757\u4e4b\u95f4\u7684\u8fb9\u6743\u662f\u552f\u4e00\u786e\u5b9a\u7684\uff0c\u800c\u8fd9\u4e00\u6761\u8fb9\u53c8\u6709 $2$ \u79cd\u4e0d\u540c\u8fb9\u6743\u3002\u66f4\u8fdb\u4e00\u6b65\u5730\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u7f29\u70b9\uff0c\u4e00\u4e2a\u8fde\u901a\u5757\u5c31\u7b49\u4ef7\u4e8e\u4e00\u4e2a\u70b9\u3002\n\n\u5047\u8bbe\u6700\u540e\u5269\u4e0b\u4e86 $m$ \u4e2a\u70b9\u540c\u65f6\u4e0d\u5b58\u5728\u4efb\u4f55\u7ea6\u675f\uff0c\u663e\u7136\u7b54\u6848\u4e3a $2^{m-1}$\u3002 \u786e\u5b9a\u70b9 $2\\sim m$ \u548c\u70b9 $1$ \u4e4b\u95f4\u7684\u8fb9\u6743\uff0c\u7c7b\u4f3c\u5730\u6839\u636e\u4e0a\u9762\u7684\u90a3\u4e2a\u6027\u8d28\uff0c\u5176\u4ed6\u8fb9\u90fd\u552f\u4e00\u786e\u5b9a\u3002\n\n\u4f46\u662f\u7f29\u70b9\u7684\u540c\u65f6\u8fd8\u8981\u5224\u65ad\u662f\u5426\u5408\u6cd5\u3002\u663e\u7136\u8fd9\u662f\u4e2a\u7ecf\u5178\u95ee\u9898\uff0c\u4f7f\u7528\u5e26\u6743\u5e76\u67e5\u96c6\u6216\u8005\u79cd\u7c7b\u5e76\u67e5\u96c6\u90fd\u80fd\u89e3\u51b3\u3002\n\n```c++\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(ll i=(a);i<=(b);i++)\n#define per(i,a,b) for(ll i=(a);i>=(b);i--)\n#define op(x) ((x&1)?x+1:x-1)\n#define odd(x) (x&1)\n#define even(x) (!odd(x))\n#define lc(x) (x<<1)\n#define rc(x) (lc(x)|1)\n#define lowbit(x) (x&-x)\n#define Max(a,b) (a>b?a:b)\n#define Min(a,b) (a<b?a:b)\n#define next Cry_For_theMoon\n#define il inline\n#define pb(x) push_back(x)\n#define is(x) insert(x)\n#define sit set<int>::iterator\n#define mapit map<int,int>::iterator\n#define pi pair<int,int>\n#define ppi pair<int,pi>\n#define pp pair<pi,pi>\n#define fr first\n#define se second\n#define vit vector<int>::iterator\n#define mp(x,y) make_pair(x,y)\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef unsigned int uint;\ntypedef double db;\nusing namespace std;\nconst int MAXN=1e5+10,mod=1e9+7;\nll n,m,u,v,w,cnt;\nll fa[MAXN],d[MAXN],vis[MAXN];\nll power[MAXN];\nint Find(int x){\n\tif(fa[x]==x)return x;\n\tint rt=Find(fa[x]);\n\td[x]^=d[fa[x]];\n\treturn fa[x]=rt;\n}\nint main(){\n\tpower[0]=1;\n\trep(i,1,1e5)power[i]=power[i-1]*2%mod;\n\tcin>>n>>m;\n\trep(i,1,n)fa[i]=i;\n\trep(i,1,m){\n\t\tcin>>u>>v>>w;\n\t\tint ru=Find(u),rv=Find(v);\n\t\tif(ru==rv){\n\t\t\tif(w==1){\n\t\t\t\tif(d[u]!=d[v])return printf(\"0\"),0;\n\t\t\t}else{\n\t\t\t\tif(d[u]==d[v])return printf(\"0\"),0;\n\t\t\t}\n\t\t}else{\n\t\t\tif(w==1){\n\t\t\t\td[ru]=d[u]^d[v]; \n\t\t\t}else{\n\t\t\t\td[ru]=1^d[u]^d[v];\n\t\t\t}\n\t\t\tfa[ru]=rv;\n\t\t}\n\t}\n\trep(i,1,n){\n\t\tif(vis[Find(i)])continue;\n\t\tvis[Find(i)]=1;cnt++;\n\t}\n\tcout<<power[cnt-1];\n\treturn 0;\n}\n```\n\n",
        "postTime": 1626861243,
        "uid": 340632,
        "name": "Cry_For_theMoon",
        "ccfLevel": 8,
        "title": "\u3010CF553C\u3011Love Triangles"
    },
    {
        "content": "\u5df2\u6709\u9898\u89e3\u597d\u50cf\u90fd\u4e0d\u662f\u5f88\u6e05\u6670\uff0c\u6240\u4ee5\u6211\u6765\u53d1\u4e00\u7bc7\u6e05\u6670\u7684\u5427\u3002\n\n\u6211\u4eec\u8bbe\u7231\u8fb9\u4e3a A\uff0c\u6068\u8fb9\u4e3a B\uff0c\u5148\u8003\u8651\u6ca1\u6709\u9650\u5236\u7684\u60c5\u51b5\n\n\u6211\u4eec\u8003\u8651\u6bcf\u4e00\u4e2a A \u7ec4\u6210\u7684\u8fde\u901a\u5757 \u8bbe\u4e3a S\n\nS \u91cc\u9762\u6240\u6709\u4e09\u5143\u73af\u7684\u8fde\u8fb9\u5747\u7b26\u5408\u6761\u4ef6\u4e3a AAA\n\n\u56e0\u4e3a\u5b83\u662f\u5b8c\u5168\u56fe\uff0c\u6240\u4ee5\u53ea\u8981\u8fde\u901a\u5757\u8d85\u8fc7 2 \u4e2a\u5c31\u4f1a\u51fa\u73b0 ABB \u6216 BBB\n\n\u8003\u8651\u6709\u9650\u5236\n\n\u5148\u628a\u5b83\u67d3\u8272\u4e00\u4e0b\uff0c\u770b\u4e00\u4e0b\u54ea\u4e9b\u70b9\u5728\u4e00\u4e2a\u8fde\u901a\u5757\u91cc\uff0c\u90a3\u4e9b\u4e0d\u5728\n\n\u7136\u540e\u5199\u4e2a\u5feb\u901f\u5e42\u8ba1\u6570\u4e00\u4e0b\u5c31\u89e3\u51b3\u4e86\n\n\u96be\u5ea6\u865a\u9ad8\n\n```cpp\nll ksm(ll a,ll base)\n{\n\tll res=1;\n\twhile(base)\n\t{\n\t\tif(base&1)res=res*a%mod;\n\t\ta=a*a%mod;\n\t\tbase>>=1;\n\t}\n\treturn res;\n}\nvoid dfs(ll u,ll ff,ll ty){\n\tif(vis[u])\n\t\tif(cor[u]!=ty)cout<<\"0\"<<endl,exit(0);\n\t\telse return;\n\tvis[u]=1;cor[u]=ty;\n\tfor(int i=first[u];i;i=e[i].nxt){\n\t\tll v=e[i].to;\n\t\tif(v==ff)continue;\n\t\tdfs(v,u,(e[i].w?ty:-ty));\n\t}\n}\nint main()\n{\n\tn=read();m=read();\n\tfor(ll i=1,u,v,ww;i<=m;i++)\n\t\tu=read(),v=read(),ww=read(),add(u,v,ww),add(v,u,ww);\n\tfor(ll i=1;i<=n;i++)if(!vis[i])ans++,dfs(i,0,1);\n\tcout<<ksm(2,ans-1);\n\treturn 0;\n}\n```\n\n\n",
        "postTime": 1606114347,
        "uid": 359952,
        "name": "_lbw_",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF553C \u3010Love Triangles\u3011"
    },
    {
        "content": "### [BLOG](https://www.cnblogs.com/terribleterrible/p/9879191.html)\n \nTyher\u63a8\u7684\u597d\u9898.\n\n\u9898\u610f\u5c31\u662f\u7ed9\u4f60\u4e00\u4e9b\u597d\u8fb9\u4e00\u4e9b\u574f\u8fb9,\u5176\u4ed6\u8fb9\u968f\u610f,\u8ba9\u4f60\u6c42\u7b26\u5408\u597d\u574f\u574f~,\u6216\u8005\u53ea\u5305\u542b\u597d\u597d\u597d\u7684\u4e09\u5143\u73af\u7684\u65e0\u5411\u56fe\u4e2a\u6570.\n\n\u574f\u574f\u7684Tyher\u7684\u9898\u610f\u662f\u8fd9\u6837\u7684.\n\n\u518d\u7ffb\u8bd1\u5f97\u66f4\u52a0\u900f\u5f7b\u4e00\u70b9\u5c31\u662f:\u7ed9\u4f60\u4e00\u4e9b0(\u597d\u8fb9)\u8fb9\u548c1(\u574f\u8fb9)\u8fb9,\u8ba9\u4f60\u6c42\u53ea\u5305\u542b011\u6216\u8005000\u7684\u4e09\u5143\u73af\u7684\u56fe\u7684\u4e2a\u6570.\n\n\u5f3a\u5f3a\u7684zsy\u8bf4:\"Tyher\u4f60\u597d\u574f\u554a!\u8fd9\u4e0d\u5c31\u662f\u6c42\u5408\u6cd5\u7684\u4e8c\u5206\u56fe\u4e2a\u6570\u561b.\"\n\n\u5bb9\u6613\u53d1\u73b0\u6ee1\u8db3\u9898\u76ee\u6761\u4ef6\u7684\u56fe\u4e00\u5b9a\u662f\u53ea\u542b\u6709\u5076\u73af(\u8fd9\u91cc\u662f\u8fb9\u6743\u548c\u4e3a\u5076\u6570)\u7684\u56fe,\u90a3\u4e0d\u5c31\u662f\u4e8c\u5206\u56fe\u561b,\u4e8e\u662f\u53ea\u8981\u7edf\u8ba1\u4e00\u4e0b1\u8fb9\u76f8\u8fde\u7684\u8054\u901a\u5757\u4e2a\u6570k,\u7b54\u6848\u5c31\u662f$2^{k-1}$(\u56e0\u4e3a\u4e8c\u5206\u56fe\u7684\u4e24\u4e2a\u96c6\u5408\u662f\u65e0\u533a\u522b\u7684\u4e24\u4e2a\u96c6\u5408,\u6240\u4ee5\u9664\u4ee52)\n```cpp\n#include<bits/stdc++.h>\n#define mod 1000000007\n#define maxn 100005\n#define ll long long\nusing namespace std;\nint n,m,vis[maxn],ans,cor[maxn];\nint head[maxn],nxt[maxn<<1],to[maxn<<1],w[maxn<<1],cnt;\nvoid add(int u,int v,int ww)\n{\n\tnxt[++cnt]=head[u];head[u]=cnt;\n\tto[cnt]=v;w[cnt]=ww;\n}\nint ksm(int a,int b)\n{\n\tint res=1;\n\twhile(b)\n\t{\n\t\tif(b&1)res=(ll)res*a%mod;\n\t\tb>>=1;a=(ll)a*a%mod;\n\t}\n\treturn res;\n}\nvoid dfs(int u,int ff,int ty)\n{\n\tif(vis[u])\n\t{\n\t\tif(cor[u]!=ty)cout<<\"0\"<<endl,exit(0);\n\t\treturn ;\n\t}\n\tvis[u]=1;cor[u]=ty;\n\tfor(int i=head[u];i;i=nxt[i])\n\t{\n\t\tint v=to[i];if(v==ff)continue;\n\t\tdfs(v,u,(w[i]?ty:-ty));\n\t}\n}\nint main()\n{\n\tcin>>n>>m;\n\tfor(int i=1,u,v,ww;i<=m;i++)\n\t\tscanf(\"%d%d%d\",&u,&v,&ww),add(u,v,ww),add(v,u,ww);\n\tfor(int i=1;i<=n;i++)if(!vis[i])ans++,dfs(i,0,1);\n\tprintf(\"%d\\n\",ksm(2,ans-1));\n\treturn 0;\n}\n\n```\n",
        "postTime": 1540901537,
        "uid": 61672,
        "name": "Brioche",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF553C \u3010Love Triangles\u3011"
    },
    {
        "content": "# Analysis\n\n\u4e0d\u59a8\u8bb0 $\\oplus$ \u4e3a\u5f02\u6216\uff0c\u8bb0 $x\\sim y=0$ \u5f53\u4e14\u4ec5\u5f53 $x$ loves $y$\uff0c\u5426\u5219 $x\\sim y=1$\uff08\u6ce8\u610f\u8fd9\u548c\u8f93\u5165\u683c\u5f0f\u662f\u53cd\u7684\uff09\u3002\u7279\u6b8a\u5730\uff0c\u8bb0 $x\\sim x=0$.\n\n\u4e0d\u96be\u53d1\u73b0\u9898\u76ee\u7684\u8981\u6c42\u76f8\u5f53\u4e8e $x\\sim z=(x\\sim y)\\oplus(y\\sim z)$. \u90a3\u4e48\uff1a\n\n> Lemma. \u53ef\u4ee5\u5c06 $n$ \u4e2a\u4eba\u6bcf\u4e2a\u4eba\u8d4b\u4e88\u4e00\u4e2a\u503c $w_i$ \u4e3a $0$ \u6216 $1$\uff0c\u4f7f\u5f97 $i\\sim j=w_i\\oplus w_j$.\n\n> Proof. \u4e0d\u59a8\u4ee4 $w_i=1\\sim i$. \n> \n> \u663e\u7136\u6709 $i\\sim j=(1\\sim i)\\oplus(1\\sim j)=w_i\\oplus w_j$. \n\n\u8bb0 $S=\\{i|w_i=0\\},T=\\{i|w_i=1\\}$. \u9898\u76ee\u4e2d\u6bcf\u5bf9\u7ed9\u5b9a\u7684\u5173\u7cfb\u76f8\u5f53\u4e8e\u6307\u5b9a $i,j$ \u5728\u540c\u4e00\u4e2a/\u4e0d\u540c\u7684\u96c6\u5408\u4e2d\u3002\u8fd9\u79cd\u5173\u7cfb\u6211\u4eec\u53ef\u4ee5\u7528 **\u6269\u5c55\u5e76\u67e5\u96c6**\uff08\u672c\u4eba\u53e3\u80e1\u7684\u540d\u5b57\uff09\u7ef4\u62a4\u3002\n\n# Extended DSU\n\n\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u5927\u5c0f\u4e3a $2n$ \u7684\u5e76\u67e5\u96c6\u3002\u6211\u4eec\u5b9a\u4e49 $i$ \u4ee3\u8868 $i\\in S$\uff0c\u800c $i+n$ \u4ee3\u8868 $i\\in T$. \n\n\u8fd9\u6837\uff0c\u5982\u679c $x\\sim y=0$\uff0c\u6211\u4eec\u5c31 `merge(x, y), merge(x + n, y + n);`\n\n\u5982\u679c $x\\sim y=1$\uff0c\u6211\u4eec\u5c31 `merge(x, y + n), merge(x + n, y);`\n\n# The Answer\n\n\u8003\u8651\u6240\u6709\u201c\u7231\u201d\u548c\u201c\u6068\u201d\u7684\u5173\u7cfb\u6784\u6210\u7684\u8fde\u901a\u5757\u3002\u8bbe\u4e00\u5171\u6709 $k$ \u4e2a\u8fd9\u6837\u7684\u8fde\u901a\u5757\u3002\u6bcf\u4e2a\u5757\u4e2d\u7684\u5173\u7cfb\u662f\u201c\u76f8\u5bf9\u201d\u56fa\u5b9a\u7684\uff1a\u5982\u679c\u6211\u4eec\u51b3\u5b9a\u4e86\u5176\u4e2d**\u4e00\u4e2a**\u5143\u7d20\u5c5e\u4e8e $S$ \u8fd8\u662f $T$\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u63a8\u51fa\u6574\u4e2a\u5757\u7684\u6bcf\u4e2a\u5143\u7d20\u5c5e\u4e8e $S$ \u8fd8\u662f $T$. \u4ece\u800c\u4e00\u5171\u6709 $2^k$ \u4e2d\u65b9\u6cd5\u2026\u2026\n\n\u4f46\u662f\u6211\u4eec\u4ea4\u6362 $S$ \u548c $T$ \u65f6\uff0c\u6bcf\u5bf9\u4eba\u7684\u7231/\u6068\u5173\u7cfb\u662f\u4e0d\u53d8\u7684\uff0c\u6240\u4ee5\u7b54\u6848\u8981\u9664\u4ee5 $2$.\n\n# When Impossible? \n\n\u6709\u7684\u65f6\u5019\u4e0d\u5b58\u5728\u7b54\u6848\uff0c\u53ef\u4ee5\u5728 Extended DSU \u4e2d\u5224\u65ad\uff1a\n\n- \u82e5\u8f93\u5165 $x\\sim y=0$ \u4f46\u662f $x$ \u4e0e $y+n$ \u5728\u540c\u4e00\u4e2a\u8fde\u901a\u5757\u4e2d\uff08\u6216 $x+n$ \u548c $y$\uff09\u6b64\u65f6\u4e0d\u5b58\u5728\u7b54\u6848\uff1b\n- \u82e5\u8f93\u5165 $x\\sim y=1$ \u4f46\u662f $x$ \u4e0e $y$ \u5728\u540c\u4e00\u4e2a\u8fde\u901a\u5757\u4e2d\uff08\u6216 $x+n$ \u548c $y+n$\uff09\u6b64\u65f6\u4e0d\u5b58\u5728\u7b54\u6848\u3002\n\n# Code\n```cpp#include <stdio.h>\n\nconst int N = 1e5 + 5, MOD = 1e9 + 7;\ntypedef long long ll;\n\nint father[N << 1], bl;\ninline int fa(int x)\n{\n    if (x == father[x]) return x;\n    return father[x] = fa(father[x]);\n}\ninline void merge(int x, int y)\n{\n    x = fa(x), y = fa(y);\n    father[x] = y;\n}\n\ninline int qpow(int x, int k)\n{\n    if (k == 0) return 1;\n    ll t = qpow(x, k >> 1); t = (t * t) % MOD;\n    if (k & 1) t = (t * x) % MOD;\n    return t;\n}\n\nint main()\n{\n    int n, m;\n    scanf(\"%d %d\", &n, &m);\n    bl = n;\n    for (int i = 1; i <= n * 2; i++) father[i] = i;\n\n    while (m--)\n    {\n        int x, y, w;\n        scanf(\"%d %d %d\", &x, &y, &w);\n        if (w == 0)\n        {\n            if (fa(x) == fa(y)) return printf(\"0\"), 0;\n            if (fa(x) != fa(y + n)) bl--;\n            merge(x, y + n); merge(x + n, y);\n        }\n        if (w == 1)\n        {\n            if (fa(x) == fa(y + n)) return printf(\"0\"), 0;\n            if (fa(x) != fa(y)) bl--;\n            merge(x, y); merge(x + n, y + n);\n        }\n    }\n    printf(\"%d\", qpow(2, bl - 1));\n    return 0;\n}\n```",
        "postTime": 1645942853,
        "uid": 384214,
        "name": "esquigybcu",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF553C (dsu)"
    },
    {
        "content": "\u7531\u4e8e\u4f5c\u8005\u5e76\u6ca1\u6709\u5728\u8fd9\u9053\u9898\u4e2d\u770b\u51fa\u4e8c\u5206\u56fe\uff0c\u6240\u4ee5\u5199\u4e00\u4e2a\u5229\u7528\u4e0d\u540c\u65b9\u5f0f\u63a8\u5bfc\u7684\u9898\u89e3\u3002\n\n\u4e0d\u59a8\u628a\u7231\u8fb9\u8bbe\u4e3a $0$\uff0c\u6068\u8fb9\u8bbe\u4e3a $1$\uff0c\u90a3\u4e48\u53ef\u4ee5\u53d1\u73b0\u9898\u76ee\u4e2d\u7684\u9650\u5236\u5373\u4e3a\u4efb\u610f\u4e00\u4e2a\u4e09\u5143\u73af\u4e2d\u8fb9\u7684\u5f02\u6216\u548c\u4e3a $0$\u3002\u6839\u636e\u5f02\u6216\u7684\u6027\u8d28\uff0c\u5982\u679c\u4e09\u5143\u73af\u4e2d\u7684\u4e24\u6761\u8fb9\u5df2\u7ecf\u786e\u5b9a\u4e86\uff0c\u90a3\u4e48\u5269\u4e0b\u7684\u4e00\u6761\u8fb9\u4e5f\u53ef\u4ee5\u786e\u5b9a\u3002\n\n\u63a5\u4e0b\u6765\u89c2\u5bdf\u6574\u4e2a\u5b8c\u5168\u56fe\uff0c\u89c2\u5bdf\u5230\u5982\u679c\u6574\u4e2a\u5b8c\u5168\u56fe\u5916\u56f4\u7684\u8fb9\u786e\u5b9a\u4e86\uff08\u4e5f\u5c31\u662f $1-2,\\ 2-3,\\cdots,\\ n-1$ \u7684\u8fb9\uff09\uff0c\u90a3\u4e48\u6574\u5f20\u5b8c\u5168\u56fe\u7684\u8fb9\u90fd\u53ef\u4ee5\u968f\u4e4b\u786e\u5b9a\u3002\n\n\u66f4\u8fdb\u4e00\u6b65\u53ef\u4ee5\u53d1\u73b0\u5916\u56f4\u8fb9\u7684\u5f02\u6216\u548c\u5fc5\u7136\u4e3a 0\u3002\u6240\u4ee5\u53ea\u9700\u786e\u5b9a $n-1$ \u6761\u8fb9\u5c31\u597d\u4e86\u3002\n\n\u8003\u5bdf\u9650\u5236 $(l,r,id)$\uff0c\u6307\u7684\u662f\u8fb9 $l-r$ \u7684\u6743\u503c\u4e3a $id$\u3002\u4e8b\u5b9e\u4e0a\u8fd9\u7b49\u4ef7\u4e8e\u8fd9\u4e9b\u8fb9 $l-(l+1),\\ (l+1)-(l+2),\\cdots,(r-1)-r$ \u7684\u5f02\u6216\u548c\u4e3a $id$\u3002\u8bbe $sum_i$ \u8868\u793a\u524d $i$ \u6761\u8fb9\u7684\u5f02\u6216\u548c\uff0c\u90a3\u4e48\u5c31\u6709 $sum_{r-1}\\operatorname{xor} sum_{l-1}=id$\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c $sum_{l-1}$ \u7684\u503c\u786e\u5b9a\u4e86\uff0c\u90a3\u4e48 $sum_{r-1}$ \u7684\u503c\u4e5f\u5c31\u4f1a\u968f\u4e4b\u786e\u5b9a\u3002\n\n\u5224\u65ad\u662f\u5426\u80fd\u591f\u6ee1\u8db3\u6240\u6709\u9650\u5236\uff0c\u663e\u7136\u53ef\u4ee5\u7528 2-SAT \u6216\u8005\u79cd\u7c7b\u5e76\u67e5\u96c6\u3002\u8fd9\u91cc\u4f7f\u7528\u7684\u662f 2-SAT\u3002\n\n\u6700\u540e\uff0c\u5982\u679c\u4e00\u4e2a\u8fde\u901a\u5757\u7684\u67d0\u4e2a\u503c\u786e\u5b9a\u4e86\uff0c\u90a3\u4e48\u6574\u4e2a\u8fde\u901a\u5757\u90fd\u53ef\u4ee5\u88ab\u786e\u5b9a\u3002\u8bbe\u8fde\u901a\u5757\u7684\u4e2a\u6570\u4e3a $k$\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f $2^{k-1}$\uff0c\u56e0\u4e3a\u6c38\u8fdc\u6709 $sum_{0}=0$\uff0c$sum_0$ \u6240\u5728\u7684\u8fde\u901a\u5757\u53ef\u4ee5\u88ab\u5b8c\u5168\u786e\u5b9a\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define For(i,a,b) for(int i=(a);i<=(b);++i)\n#define Rof(i,a,b) for(int i=(a);i>=(b);--i)\nusing namespace std;\nconst int Maxn=2e5,Mod=1e9+7;\n\ninline int read()\n{\n    int x=0,f=1;\n    char ch=getchar();\n    while(ch<'0' || ch>'9')\n    {\n        if(ch=='-') f=-1;\n        ch=getchar();\n    }\n    while(ch>='0' && ch<='9')\n    {\n        x=x*10+ch-'0';\n        ch=getchar();\n    }\n    return x*f;\n}\n\nstruct Query{int l,r,id;} qry[Maxn+5];\nint n,m,dfn[Maxn+5],low[Maxn+5],vis[Maxn+5];\nint st[Maxn+5],col[Maxn+5],fa[Maxn+5],cur,tmp,top;\nvector<int> v[Maxn+5];\n\ninline int Find(int x) {return fa[x]==x?x:fa[x]=Find(fa[x]);}\ninline void Tarjan(int x)\n{\n    dfn[x]=low[x]=++cur,st[++top]=x,vis[x]=1;\n    for(auto y:v[x])\n    {\n        if(!dfn[y]) Tarjan(y),low[x]=min(low[x],low[y]);\n        else if(vis[y]) low[x]=min(low[x],dfn[y]);\n    }\n    if(dfn[x]==low[x])\n    {\n        ++tmp;\n        while(1)\n        {\n            int y=st[top--]; vis[y]=0,col[y]=tmp;\n            if(x==y) break;\n        }\n    }\n}\n\nint main()\n{\n    n=read(),m=read();\n    For(i,1,m)\n    {\n        qry[i].l=read(),qry[i].r=read(),qry[i].id=read()^1;\n        if(qry[i].l>qry[i].r) swap(qry[i].l,qry[i].r);\n    }\n    For(i,1,m)\n    {\n        int l=qry[i].l,r=qry[i].r,id=qry[i].id;\n        // sum[r-1]^sum[l-1]=id\n        if(id) v[l].push_back(r+n),v[l+n].push_back(r),\n               v[r].push_back(l+n),v[r+n].push_back(l);\n        else v[l].push_back(r),v[l+n].push_back(r+n),\n             v[r].push_back(l),v[r+n].push_back(l+n);\n    }\n    For(i,1,n*2) if(!dfn[i]) Tarjan(i);\n    For(i,1,n) if(col[i]==col[n+i]) {printf(\"0\\n\"); return 0;}\n    For(i,1,n) fa[i]=i;\n    For(i,1,m)\n    {\n        int l=qry[i].l,r=qry[i].r;\n        if(Find(l)!=Find(r)) fa[Find(l)]=Find(r);\n    }\n    int cnt=0,ans=1;\n    For(i,1,n) if(fa[i]==i) cnt++;\n    For(i,1,cnt-1) ans=ans*2%Mod;\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1665364799,
        "uid": 148913,
        "name": "Graphcity",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF553C\u3010Love Triangles\u3011"
    },
    {
        "content": "\u6211\u4eec\u5148\u7406\u4e00\u4e0b\u9898\u610f\uff1a\n\n> \u6709\u4e00\u4e2a\u65e0\u5411\u56fe\u5b8c\u5168\uff0c\u8fb9\u6709\u7231\u8fb9\u4e0e\u6068\u8fb9\u4e24\u79cd\uff0c\u4e09\u4e2a\u70b9\u7684\u5173\u7cfb\u8981\u4e48\u7531\u7231\u8fb9\u8fde\u901a\uff0c\u8981\u4e48\u6709\u4e14\u4ec5\u6709\u4e00\u6761\u7231\u8fb9\u3002\n\n\u4e0d\u96be\u770b\u51fa\u6700\u540e\u7684\u56fe\u4e2d\u70b9\u5206\u4e3a\u51e0\u4e2a\u96c6\u5408\uff0c\u96c6\u5408\u5185\u90e8\u5168\u90e8\u662f\u7231\u8fb9\uff0c\u96c6\u5408\u4e4b\u95f4\u5168\u90fd\u662f\u6068\u8fb9\u3002\n\n\u7565\u7565\u6df1\u5165\u4e00\u60f3\uff0c\u6700\u591a\u53ea\u80fd\u6709\u4e24\u4e2a\u96c6\u5408\u3002\u4f46\u4e00\u4e2a\u662f\u53ef\u4ee5\u7684\u3002\n\n\u6211\u4eec\u5148\u770b\u4e00\u4e2a\u7b80\u5316\u7248\u7684\u95ee\u9898\uff1a\u56fe\u7684\u8981\u6c42\u4e0e\u539f\u9898\u76f8\u540c\uff0c\u70b9\u6570\u4e3a$n$\uff0c\u4e0d\u7ed9\u51fa\u5df2\u77e5\u8fb9\u3002\u90a3\u4e48\u7b54\u6848\u663e\u7136\u4e3a$2^{n-1}$\u3002\u5148\u56fa\u5b9a\u7b2c\u4e00\u4e2a\u70b9\uff0c\u5176\u4f59\u7684$n-1$\u4e2a\u70b9\u5747\u6709\u4e24\u79cd\u9009\u62e9\uff0c\u52a0\u51651\u53f7\u70b9\u6216\u4e0e1\u53f7\u70b9\u5bf9\u7acb\u3002\n\n\u770b\u56de\u539f\u9898\uff1a\u6211\u4eec\u53ef\u4e0d\u53ef\u4ee5\u5c06\u76f8\u5bf9\u5173\u7cfb\u5df2\u7ecf\u786e\u5b9a\u7684\u82e5\u5e72\u70b9\u538b\u7f29\u4e3a\u4e00\u4e2a\u70b9\uff0c\u628a\u539f\u9898\u53d8\u6210\u4e0a\u9762\u7684\u7b80\u5316\u7248\u5462\uff1f\n\n\u7b54\u6848\u662f\u80af\u5b9a\u7684\u3002\n\n\u4f7f\u7528\u5e76\u67e5\u96c6\u5c06\u7531\u7231\u8fb9\u8fde\u63a5\u7684\u70b9\u5408\u5e76\uff0c\u5e76\u538b\u7f29\u4e3a\u4e00\u4e2a\u70b9\u3002\u5224\u65ad\u539f\u56fe\u662f\u5426\u6ee1\u8db3\u9898\u610f`dfs`\u4e00\u904d\u5373\u53ef\u3002\n\n\u7b54\u6848\u4e3a\u7f29\u70b9\u540e\u96c6\u5408\u7684\u6570\u91cf\u5e26\u5165\u516c\u5f0f\u3002\n\n**\u6ce8\u610f\uff1a\u7531\u6068\u8fb9\u8fde\u63a5\u7684\u70b9\u4e5f\u9700\u8981\u8bb0\u4e3a\u4e00\u4e2a\u96c6\u5408\uff0c\u56e0\u4e3a\u5b83\u4eec\u7684\u76f8\u5bf9\u5173\u7cfb\u5df2\u7ecf\u56fa\u5b9a**\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int nn = 1e5 + 5;\nconst int mod = 1000000007;\nint father[nn], n, m, tot;\npair<int, int>hate[nn];\nint vis[nn]; \nint getfather(int p) {\n\treturn father[p] == p ? p : father[p] = getfather(father[p]);\n}\ninline void merge(int p, int q) {\n\tfather[getfather(p)] = getfather(q);\n}\nint cnt, Begin[nn << 1], End[nn << 1], Last[nn], Prev[nn << 1];\ninline void addedge(int p, int q) {\n\tcnt++;\n\tBegin[cnt] = p;\n\tEnd[cnt] = q;\n\tPrev[cnt] = Last[p];\n\tLast[p] = cnt;\n}\nvoid dfs(int p, int ff) {\n\tvis[p] = ff;\n\tfor (int i = Last[p]; i; i = Prev[i]) {\n\t\tif (vis[End[i]] == 1) {\n\t\t\tdfs(End[i], ~ff);\n\t\t} else {\n\t\t\tif (~ff != vis[End[i]]) {\n\t\t\t\tprintf(\"0\");\n\t\t\t\texit(0);\n\t\t\t}\n\t\t}\n\t}\n}\nint ksm(int a, int n) {\n\tlong long ans = 1;\n\twhile (n) {\n\t\tif (n & 1)\n\t\t\tans = (ans * a) % mod;\n\t\tn >>= 1;\n\t\ta = 1ll * a * a % mod;\n\t}\n\treturn ans;\n}\nint main() {\n\tscanf(\"%d %d\", &n, &m);\n\tint a, b, c;\n\tfor (int i = 1; i <= n; i++)\n\t\tfather[i] = i;\n\twhile (m--) {\n\t\tscanf(\"%d %d %d\", &a, &b, &c);\n\t\tif (c == 1)\n\t\t\tmerge(a, b);\n\t\telse\n\t\t\thate[++tot] = pair<int, int>{a, b};\n\t}\n\tfor (int i = 1; i <= tot; i++) {\n\t\thate[i].first = getfather(hate[i].first);\n\t\thate[i].second = getfather(hate[i].second);\n\t\taddedge(hate[i].first, hate[i].second);\n\t\taddedge(hate[i].second, hate[i].first);\n\t} \n\tfor (int i = 1; i <= n; i++)\n\t\tvis[i] = 1;\n\tint ans = 0;\n\tfor (int i = 1; i <= n; i++)\n\t\tif (vis[getfather(i)] == 1) {\n\t\t\tans++;\n\t\t\tdfs(getfather(i), 0);\n\t\t}\n\tprintf(\"%d\", ksm(2, ans - 1));\n\treturn 0;\n}\n```",
        "postTime": 1581554844,
        "uid": 124683,
        "name": "Krystallos",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF553C \u3010Love Triangles\u3011"
    }
]
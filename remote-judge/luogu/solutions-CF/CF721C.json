[
    {
        "content": "\u9996\u5148\u53ef\u4ee5\u53d1\u73b0\uff0c\u672c\u9898\u5b9e\u9645\u4e0a\u7c7b\u4f3c\u4e00\u4e2a DAG \u4e0a\u7684\u80cc\u5305\u95ee\u9898\u3002\n\n\u90a3\u4e48\u6211\u4eec\u6709\u4e00\u4e2a\u5f88\u663e\u7136\u7684\u505a\u6cd5\uff1a\n\n\u8bbe $f_{v,t}$ \u8868\u793a\u4ece\u70b9 $1$ \u5230\u8fbe\u70b9 $v$\uff0c\u8def\u5f84\u957f\u5ea6\u4e3a $t$ \u7684\u6240\u6709\u65b9\u6848\u4e2d\u7684\u6700\u5927\u70b9\u6570\uff0c\u8f6c\u79fb\u65b9\u7a0b\u5e73\u51e1\uff0c\u8fd9\u91cc\u7565\u53bb\u3002\n\n\u4f46\u662f $T \\le 10^9$\uff0c\u8fd9\u6837\u505a\u7a7a\u95f4\u4f1a\u70b8\u98de\u3002\n\n\u53ef\u559c\u7684\u662f\uff0c\u7b54\u6848\u4e00\u5b9a\u662f\u5c0f\u4e8e\u7b49\u4e8e $n$ \u7684\uff0c\u540c\u65f6 $n \\leq 5000$\uff0c\u8fd9\u542f\u53d1\u6211\u4eec\u53ef\u4ee5\u8003\u8651 $O(n^2)$ \u7a7a\u95f4\u7684\u7b97\u6cd5\u3002\n\n\u6211\u4eec\u6362\u4e2a\u89d2\u5ea6\u601d\u8003\uff1a\u65e2\u7136\u679a\u4e3e\u8ddd\u79bb\u6c42\u70b9\u7684\u6700\u5927\u503c\u4e0d\u884c\uff0c\u90a3\u4e48**\u679a\u4e3e\u70b9\u6570\u6c42\u8ddd\u79bb\u7684\u6700\u5c0f\u503c**\u662f\u5426\u53ef\u884c\uff1f\n\n\u89c2\u5bdf\u6570\u636e\u8303\u56f4\uff0c\u5728\u590d\u6742\u5ea6\u4e0a\u8fd9\u663e\u7136\u662f\u53ef\u884c\u7684\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8bd5\u7740\u8003\u8651\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n\u8bbe $f_{v, t}$ \u8868\u793a\u4ece\u70b9 $1$ \u5230\u8fbe\u70b9 $v$\uff0c\u7ecf\u8fc7\u70b9\u6570\u4e3a $t$ \u7684\u6240\u6709\u65b9\u6848\u4e2d\u7684**\u6700\u77ed\u8def\u5f84**\u3002\n\n\u90a3\u4e48\u6211\u4eec\u6709\u8f6c\u79fb\u65b9\u7a0b\uff1a\uff08\u5176\u4e2d $prefix(v)$ \u8868\u793a\u70b9 $v$ \u7684\u524d\u9a71\uff0c\u5373\u6240\u6709\u80fd\u591f\u5230\u8fbe\u70b9 $v$ \u7684\u70b9\uff0c$w$ \u8868\u793a\u8fb9 $u\\to v$ \u7684\u957f\u5ea6\uff09\n\n$$\nf_{v, t} = \\min_{u \\in prefix(v)} (f_{u,t - 1} + w)[f_{u,t - 1} + w \\le T]\n$$\n\n\u4e3a\u4ec0\u4e48\u662f\u6700\u77ed\u8def\u5f84\u5462\uff1f\u56e0\u4e3a\u6211\u4eec\u5e76\u4e0d\u5173\u5fc3\u8def\u5f84\u7684\u957f\u5ea6\u5230\u5e95\u662f\u591a\u5c11\uff0c\u53ea\u5173\u5fc3\u5b83\u662f\u5426\u4e0d\u8d85\u8fc7 $T$\u3002\u4ece\u8d2a\u5fc3\u7684\u89d2\u5ea6\u8003\u8651\uff0c\u8fd9\u91cc\u9009\u62e9\u6700\u77ed\u8def\u5f84\u663e\u7136\u6700\u4f18\u3002\n\n\u8f6c\u79fb\u7684\u540c\u65f6\uff0c\u6211\u4eec\u8bb0\u5f55\u4e00\u4e2a $g_{v,t}$\uff0c\u8868\u793a $f_{v,t}$ \u662f\u7531\u54ea\u4e2a $u$ \u8f6c\u79fb\u8fc7\u6765\u7684\uff0c\u65b9\u4fbf\u6700\u540e\u8f93\u51fa\u7b54\u6848\u3002\n\n\u4e0d\u8fc7\uff0c\u9700\u8981\u6ce8\u610f\u4e00\u70b9\uff1a\u6570\u636e\u8303\u56f4\u4e2d\u6ca1\u6709\u8bf4 DAG \u7684\u6e90\u70b9\u4e00\u5b9a\u662f\u70b9 $1$\uff01\n\n\u867d\u7136\u70b9 $1$ \u7684\u6240\u6709\u76f4\u63a5\u524d\u9a71\u548c\u95f4\u63a5\u524d\u9a71\u90fd\u4e0d\u4f1a\u5f71\u54cd\u5230\u7b54\u6848\uff0c\u4f46\u662f\u5b83\u4eec\u4f1a\u5f71\u54cd\u62d3\u6251\u6392\u5e8f\u7684\u8fc7\u7a0b\u3002\n\n\u6bd4\u5982\u4e0a\u9762\u7684\u8fb9 $2 \\to 3$\uff0c\u867d\u7136\u70b9 $2$ \u5728\u62d3\u6251\u6392\u5e8f\u4e2d\u6ca1\u6709\u8bbf\u95ee\u5230\uff0c\u4f46\u662f\u8fd9\u6761\u8fb9\u5bf9\u70b9 $3$ \u7684\u5165\u5ea6\u4ecd\u7136\u5b58\u5728 $1$ \u7684\u5f71\u54cd\u3002\n\n\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5148 DFS \u4e00\u904d\uff0c\u628a\u70b9 $1$ \u7684\u6240\u6709\u76f4\u63a5\u524d\u9a71\u548c\u95f4\u63a5\u524d\u9a71\u5bf9\u4e8e\u62d3\u6251\u56fe\u4e2d\u70b9\u7684\u5165\u5ea6\u5f71\u54cd\u53bb\u6389\u3002\u7136\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4ece\u70b9 $1$ \u5f00\u59cb\u8dd1\u8fd9\u4e2a DP \u4e86\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cassert>\n#include<cstring>\n#include<vector>\n#include<queue>\n\n#define MAXN 5005\n\nusing namespace std;\n\nint n, m, k, in[MAXN], f[MAXN][MAXN], g[MAXN][MAXN];\nbool vis[MAXN];\nvector<pair<int, int> > vec[MAXN];\n\ninline void DFS(int u)\n{\n    vis[u] = true;\n    for(register vector<pair<int, int> > :: iterator it = vec[u].begin(); it != vec[u].end(); it++) if(!vis[it -> first]) DFS(it -> first);\n    return;\n}\n\ninline void Toposort()\n{\n    queue<int> q;\n    q.push(1), f[1][1] = 0, g[1][1] = 1;\n    while(!q.empty())\n    {\n        int u = q.front(); q.pop();\n        for(register vector<pair<int, int> > :: iterator it = vec[u].begin(); it != vec[u].end(); it++)\n        {\n            int v = it -> first, w = it -> second;\n            for(register int i = 1; i <= n; i++)\n            {\n                if(g[u][i - 1] && f[u][i - 1] + w <= k && f[u][i - 1] + w < f[v][i])\n                {\n                    f[v][i] = f[u][i - 1] + w;\n                    g[v][i] = u;\n                }\n            }\n            --in[v]; if(!in[v]) q.push(v);\n        }\n    }\n    return;\n}\n\ninline void Output(int u, int k)\n{\n    if(u > 1) Output(g[u][k], k - 1);\n    printf(\"%d \", u);\n    return;\n}\n\nint main()\n{\n    #ifdef FILE\n        freopen(\"Input.in\", \"r\", stdin);\n        freopen(\"Output.out\", \"w\", stdout);\n    #endif\n    scanf(\"%d%d%d\", &n, &m, &k);\n    for(register int i = 1; i <= m; i++)\n    {\n        int u, v, w; scanf(\"%d%d%d\", &u, &v, &w);\n        vec[u].push_back(make_pair(v, w));\n        ++in[v];\n    }\n    memset(f, 0x3F, sizeof f);\n    DFS(1);\n    for(register int i = 1; i <= n; i++) if(!vis[i]) for(register vector<pair<int, int> > :: iterator it = vec[i].begin(); it != vec[i].end(); it++) --in[it -> first];\n    Toposort();\n    int t;\n    for(t = n; t > 1; t--) if(g[n][t]) break;\n    printf(\"%d\\n\", t);\n    Output(n, t);\n    return 0;\n}\n```",
        "postTime": 1641786748,
        "uid": 183562,
        "name": "_ReClouds_",
        "ccfLevel": 7,
        "title": "CF721C Journey \u9898\u89e3"
    },
    {
        "content": "## \u9898\u89e3\uff1a\n\n\u601d\u8def\uff1aDAG\u4e0aDP\u3002\u4e3a\u4e86\u4fdd\u8bc1\u65e0\u540e\u6548\u6027\uff0c\u91c7\u7528\u5148\u62d3\u6251\u6392\u5e8f\uff0c\u518d\u5728\u62d3\u6251\u5e8f\u4e0a\u8fdb\u884c\u62d3\u5c55DP\u7684\u65b9\u5f0f\u3002\n\n\u4e3a\u4ec0\u4e48\u62d3\u6251\u6392\u5e8f\u5c31\u80fd\u4fdd\u8bc1DP\u7684\u65e0\u540e\u6548\u6027\u5462\uff1f\n\n\u56e0\u4e3a\u62d3\u6251\u5e8f\u7684\u6027\u8d28\u662f\uff0c\u5bf9\u4e8eDAG\u4e0a\u7684\u4efb\u610f\u4e00\u4e2a\u70b9\uff0c\u5b83\u7684\u7236\u4eb2\u4eec\u5728\u62d3\u6251\u5e8f\u4e2d\u51fa\u73b0\u7684\u4f4d\u7f6e\u90fd\u5728\u5b83\u4e4b\u524d\u3002\u8fd9\u4e5f\u5c31\u4fdd\u8bc1\u4e86\uff0c\u5904\u7406\u51fa\u62d3\u6251\u5e8f\u540e\u518dDP\uff0c\u80fd\u4f7f\u5f97\u6bcf\u4e2a\u72b6\u6001\u9636\u6bb5\u90fd\u662f\u6b63\u786e\u7684\u7b54\u6848\uff08\u56e0\u4e3a\u8f6c\u79fb\u800c\u6765\u7684\u8282\u70b9\u90fd\u88ab\u5904\u7406\u5b8c\u4e86\uff09\u3002\n\n\u6240\u4ee5\u5c31\u662f\u5148topsort\u518dDP\u3002DP\u8fc7\u7a0b\u4e2d\u9700\u8981\u8bb0\u5f55\u4e00\u4e2a\u524d\u7f00\u5e8f\u5217\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<queue>\n#include<vector>\n#include<stack>\n#include<iostream>\nusing namespace std;\nconst int maxn=5002;\nint n,m,dist,maxx;\nint tot,to[maxn],nxt[maxn],val[maxn],head[maxn];\nint rudu[maxn];\nqueue<int> q;\nvector<int> vec;\nstack<int> st;\nint dp[maxn][maxn];\n//dp[i][j]\u8868\u793a\u4ece1-i\uff0c\u7ecf\u8fc7j\u4e2a\u70b9\u7684\u6700\u77ed\u8ddd\u79bb\nint pre[maxn][maxn],ans[maxn],cnt;\nvoid add(int x,int y,int z)\n{\n\tto[++tot]=y;\n\tnxt[tot]=head[x];\n\tval[tot]=z;\n\thead[x]=tot;\n}\nvoid topsort()\n{\n\tfor(int i=1;i<=n;i++)\n\t\tif(!rudu[i])\n\t\t\tq.push(i);\n\twhile(!q.empty())\n\t{\n\t\tint x=q.front();\n\t\tq.pop();\n\t\tvec.push_back(x);\n\t\tfor(int i=head[x];i;i=nxt[i])\n\t\t{\n\t\t\tint y=to[i];\n\t\t\trudu[y]--;\n\t\t\tif(!rudu[y])\n\t\t\t\tq.push(y);\n\t\t}\n\t}\n}\nint main()\n{\n\tscanf(\"%d%d%d\",&n,&m,&dist);\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint x,y,z;\n\t\tscanf(\"%d%d%d\",&x,&y,&z);\n\t\tadd(x,y,z);\n\t\trudu[y]++;\n\t}\n\ttopsort();\n\tmemset(dp,127,sizeof(dp));\n\tdp[1][1]=0;\n\tfor(int k=0;k<vec.size();k++)\n\t{\n\t\tint x=vec[k];\n\t\tfor(int i=head[x];i;i=nxt[i])\n\t\t\tfor(int j=2;j<=n;j++)\n\t\t\t{\n\t\t\t\tint y=to[i];\n\t\t\t\tif(dp[x][j-1]+val[i]<dp[y][j])\n\t\t\t\t{\n\t\t\t\t\tdp[y][j]=dp[x][j-1]+val[i];\n\t\t\t\t\tpre[y][j]=x;\n\t\t\t\t}\n\t\t\t}\n\t}\n\tfor(int i=n;i>=1;i--)\n\t\tif(dp[n][i]<=dist)\n\t\t{\n\t\t\tmaxx=i;\n\t\t\tprintf(\"%d\\n\",i);\n\t\t\tbreak;\n\t\t}\n\tint pos=n,dep=maxx;\n\twhile(pos)\n\t{\n\t\tst.push(pos);\n\t\tpos=pre[pos][dep];\n\t\tdep--;\n\t}\n\twhile(!st.empty())\n\t{\n\t\tcout<<st.top()<<' ';\n\t\tst.pop();\n\t}\n\tcout<<endl;\n\treturn 0;\n}\n```\n\n",
        "postTime": 1603418748,
        "uid": 175131,
        "name": "\u5085\u601d\u7ef4666",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF721C \u3010Journey\u3011"
    },
    {
        "content": "## Journey\u9898\u89e3\n### \u3010\u9898\u610f\u3011\n\u6709\u4e00\u4e2an\u4e2a\u70b9m\u6761\u6709\u5411\u8fb9\u7684\u65e0\u73af\u56fe\uff0c\u6c42\u4ece1\u5230n\u603b\u957f\u5ea6\u4e0d\u8d85\u8fc7k\uff0c\u4e14\u7ecf\u8fc7\u70b9\u6700\u591a\u7684\u8def\u5f84\u3002\n### \u3010\u5206\u6790\u3011\n### \u5f88\u81ea\u7136\u7684\uff0c\u6211\u4eec\u60f3\u5230\u4e86dp\n1. **dp\u7684\u72b6\u6001\u5982\u4f55\u8bbe\u8ba1\uff1f**\n \n* \u544a\u8bc9\u5927\u5bb6\u4e00\u4e2a\u5c0f\u6280\u5de7\u2014\u2014\u5728\u540c\u4e00\u4e2a\u9898\u76ee\u800c\u4e14dp\u6709\u8bb8\u591a\u65b9\u6cd5\u90fd\u80fd\u8fc7\u7684\u60c5\u51b5\u4e0b\uff0c\u901a\u5e38dp\u7ef4\u6570\u8d8a\u591a\uff0c\u8d8a\u7b80\u5355\u3002\u6240\u4ee5\u770b\u6570\u636e\u8303\u56f4\uff0c$n<=5000$\uff0c\u90a3\u5c31\u8bbe\u8ba1\u4e8c\u7ef4\u7684dp\u3002\n\n* **\u6211\u4eec\u8ba9$f[i][j]$\u8868\u793a\u4ece1\u5230i\u7ecf\u8fc7j\u4e2a\u70b9\u7684\u6700\u77ed\u8def\u5f84**(\u65e0\u89e3\u5c31\u662fINF)\uff0c\u6700\u540e\u53ea\u8981\u6c42$f[n][j]<=k$\u5373\u53ef\n\n* \u8fd8\u6709\u4e00\u4e2a\u5c0f\u70b9\uff0cdp\u8981\u6309\u7167\u62d3\u6251\u5e8f\u7684\u987a\u5e8f(\u800c\u4e0d\u662f\u8282\u70b9\u5e8f)\uff0c\u8fd9\u6837\u624d\u80fd\u4fdd\u8bc1\u6bcf\u4e2a\u70b9\u90fd\u662f\u6700\u5c0f\u503c\uff0c\u53c8\u56e0\u4e3a\u662f\u6709\u5411\u65e0\u73af\u56fe(DAG)\uff0c\u6240\u4ee5\u8fd9\u6837\u505a\u662f\u6210\u7acb\u7684\u3002\n\n2. **\u8def\u5f84\u5982\u4f55\u8bb0\u5f55\uff1f**\n\n* \u76f4\u63a5\u8bb0\u5f55nm\u6761\u8def\u5f84\u4f1aMLE(\u6b64\u65f6\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a$n^2m$)\uff0c\u6240\u4ee5\u7c7b\u4f3c\u4e8edp\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u70b9x\uff0c\u6211\u4eec\u8bb0\u5f55$pre[x][j]$\uff0c\u8868\u793a\u4ece1\u8d70\u5230x\uff0c\u7ecf\u8fc7\u4e86j\u4e2a\u70b9\uff0c\u7684\u4e0a\u4e00\u4e2a\u8282\u70b9\u7f16\u53f7\uff0c\u6c42\u8def\u5f84\u65f6\u76f4\u63a5\u56de\u6eaf\u6216\u8005\u7528stack\u6a21\u62df(\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a$nm$)\u3002\n\n### \u4e0b\u9762\u662fAC\u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int INF = 0x3f3f3f3f;\n\nint n,m,d; // d\u5c31\u662f\u9898\u4e2d\u7684k\nint f[5005][5005],pre[5005][5005],mx; \nint ee,h[5005],nex[5005],to[5005],val[5005]; // \u524d\u5411\u661f\nint rdu[5005];\nvector<int> s; // \u62d3\u6251\u5e8f\nstack<int> path; // \u6700\u7ec8\u8def\u5f84\n\nvoid addedge(int x,int y,int z)\n{\n\tnex[++ee] = h[x];\n\tto[ee] = y;\n\tval[ee] = z;\n\th[x] = ee;\n}\n\nvoid topo() // \u62d3\u6251\u6392\u5e8f\n{\n\tqueue<int> q;\n\tfor(int i=1;i<=n;i++)\n\t\tif(rdu[i]==0)\n\t\t\tq.push(i);\n\twhile(!q.empty())\n\t{\n\t\tint x=q.front();\n\t\tq.pop();\n\t\ts.push_back(x);\n\t\tfor(int i=h[x];i;i=nex[i])\n\t\t\tif((--rdu[to[i]])==0)\n\t\t\t\tq.push(to[i]);\n\t}\n}\n\nsigned main()\n{\n\tmemset(f,INF,sizeof(f));\n\tmemset(pre,-1,sizeof(pre));\n\tcin>>n>>m>>d;\n\tfor(int i=1,x,y,z;i<=m&&cin>>x>>y>>z;i++)\n\t{\n\t\taddedge(x,y,z);\n\t\trdu[y]++;\n\t}\n\ttopo(); // \u786e\u5b9adp\u7684\u987a\u5e8f\n\tf[1][1] = 0; // \u4ece1\u52301\u4e14\u7ecf\u8fc7\u4e00\u4e2a\u70b9\u7684\u8def\u5f84\u957f\u662f0\n\tfor(int k=0;k<s.size();k++)\n\t{\n\t\tint x=s[k];\n\t\tfor(int i=h[x];i;i=nex[i])\n\t\t\tfor(int j=2;j<=n;j++) // \u679a\u4e3e\u7ecf\u8fc7\u70b9\u6570\n\t\t\t\tif(f[x][j-1]+val[i]<f[to[i]][j]) // \u5982\u679c\u5f53\u524d\u8def\u5f84\u548c\u6bd4\u539f\u5148\u7684\u597d\n\t\t\t\t{\n\t\t\t\t\tf[to[i]][j] = f[x][j-1]+val[i]; // \u66f4\u65b0\n\t\t\t\t\tpre[to[i]][j] = x; // \u8bb0\u5f55\u8def\u5f84\u4e2d\u7684\u4e0a\u4e00\u4e2a\u70b9\n\t\t\t\t}\n\t}\n\tfor(int i=n;i>=1;i--)\n\t\tif(f[n][i]<=d)\n\t\t{\n\t\t\tmx = i; // \u6700\u591a\u80fd\u7ecf\u8fc7mx\u4e2a\u70b9\n\t\t\tbreak;\n\t\t}\n\tcout<<mx<<endl;\n\tint pos=n,dep=mx;\n\twhile(pos!=-1)\n\t{\n\t\tpath.push(pos);\n\t\tpos = pre[pos][dep]; // \u7528stack\u56de\u6eaf\u8def\u5f84\n\t\tdep--;\n\t}\n\twhile(!path.empty())\n\t{\n\t\tcout<<path.top()<<' '; // \u8f93\u51fa\u8def\u5f84\n\t\tpath.pop();\n\t}\n\tcout<<endl;\n\t\n\treturn 0;\n}\n```\n\u795d\u5927\u5bb6AC\u6109\u5feb\uff01",
        "postTime": 1568125129,
        "uid": 123298,
        "name": "kouylty",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF721C \u3010Journey\u3011"
    },
    {
        "content": "\u4e0d\u4f1aTopo\uff0c\u53ea\u80fd\u5199SPFA\u4e86\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int MAXN=5000+10;\nint n,m,k;\nstruct Node\n{\n    int to,next;\n    int w;\n}edge[MAXN];//\u94fe\u5f0f\u524d\u5411\u661f\u5b58\u56fe\nint head[MAXN],cnt;\nint d[MAXN][MAXN];//d[i][j]\u8868\u793a\u5f53\u524d\u5728\u7b2ci\u53f7\u7ed3\u70b9\uff0c\u7ecf\u8fc7\u4e86j\u6761\u8fb9\uff0c\u6240\u7ecf\u8fc7\u7684\u6700\u5c0f\u8def\u7a0b\nbool inq[MAXN][MAXN];//\u5224\u65ad\u662f\u5426\u5728\u961f\u5217\u4e2d\nint pre[MAXN][MAXN];//\u8bb0\u5f55\u8def\u5f84\ntypedef pair<int,int>p;\ninline int read()\n{\n    int tot=0;char c=getchar();\n    while(c<'0'||c>'9')c=getchar();\n    while(c>='0'&&c<='9'){tot=(tot<<1)+(tot<<3)+c-'0';c=getchar();}\n    return tot;\n}\ninline void add(int x,int y,int z)\n{\n    edge[++cnt].to=y;\n    edge[cnt].next=head[x];\n    edge[cnt].w=z;\n    head[x]=cnt;\n}\ninline int SPFA()\n{\n    memset(d,0x3f,sizeof(d));\n    queue<p>q;\n    q.push(p(1,0));\n    d[1][0]=0;inq[1][0]=1;//\u521d\u59cb\u5316\n    while(q.size())\n    {\n        p now=q.front();\n        q.pop();\n        int x=now.first,y=now.second;//\u53d6\u51fa\u961f\u9996\u5143\u7d20\n        inq[x][y]=0;\n        for(int i=head[x];i;i=edge[i].next)//\u904d\u5386\u76f8\u90bb\u7ed3\u70b9\n        {\n            int v=edge[i].to;\n            if(d[x][y]+edge[i].w<d[v][y+1]&&d[x][y]+edge[i].w<=k)//\u66f4\u65b0\u5176\u4ed6\u7ed3\u70b9\u7684\u503c\n            {\n                d[v][y+1]=d[x][y]+edge[i].w;\n                pre[v][y+1]=x;//\u8bb0\u5f55\u4e0b\u8def\u5f84\n                if(!inq[v][y+1])//\u907f\u514d\u91cd\u590d\u641c\u7d22\n                {\n                    inq[v][y+1]=1;\n                    q.push(p(v,y+1));\n                }\n            }\n        }\n    }\n}\ninline void print(int now,int t)//\u9012\u5f52\u8f93\u51fa\n{\n    if(pre[now][t]==0){if(now==1)printf(\"%d \",now);return;}\n    print(pre[now][t],t-1);\n    printf(\"%d \",now);\n}\nint main()\n{\n    n=read();m=read();k=read();\n    for(int i=1;i<=m;i++)\n    {\n        int x=read(),y=read(),z=read();\n        add(x,y,z);\n    }\n    SPFA();\n    int i;\n    for(i=n;i>=1;i--)\n        if(d[n][i]<=k)break;//\u627e\u5230\u6700\u4f18\u89e3\n    printf(\"%d\\n\",i+1);//\u7531\u4e8e\u8bb0\u5f55\u7684\u662f\u7ecf\u8fc7\u4e86\u51e0\u6761\u8fb9\uff0c\u6240\u4ee5\u7ed3\u70b9\u6570\u8fd8\u8981+1\n    print(n,i);\n    printf(\"\\n\");\n    return 0;\n}\n```",
        "postTime": 1564145800,
        "uid": 107468,
        "name": "hulean",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF721C \u3010Journey\u3011"
    },
    {
        "content": "\u7b80\u5355\u9898\u3002\n\n\u8bbe\u8ba1 dp \u72b6\u6001\uff0c\u7b2c\u4e00\u7ef4\u663e\u7136\u662f\u4e0b\u6807\u3002\u628a\u6743\u503c\u8bbe\u8fdb\u8f6c\u79fb\u72b6\u6001\u662f\u4e0d\u660e\u667a\u7684\uff0c\u8003\u8651\u8f6c\u5316\u95ee\u9898\uff0c\u7b2c\u4e8c\u7ef4\u662f\u7ecf\u8fc7\u4e86\u591a\u5c11\u4e2a\u70b9\uff0c\u7531\u6b64\u627e\u5230\u6700\u5927\u7684\u6ee1\u8db3\u6700\u77ed\u8def\u4e0d\u5927\u4e8e $T$ \u7684\u5373\u53ef\u3002 \n\ndp \u662f\u9700\u8981\u65e0\u540e\u6548\u6027\u7684\uff0c\u5bf9\u6b64\u8fdb\u884c\u62d3\u6251\u6392\u5e8f\u3002\u7ef4\u62a4\u4e00\u4e2a\u961f\u5217\uff0c\u627e\u5230\u5f53\u524d\u5165\u5ea6\u4e3a $0$ \u7684\u70b9\uff0c\u7136\u540e\u5bf9\u6bcf\u4e2a\u51fa\u8fb9\u679a\u4e3e\u70b9\u6570\u8fdb\u884c\u66b4\u529b\u8f6c\u79fb\u5373\u53ef\u3002\u6ce8\u610f\u521d\u59cb\u503c\u5168\u90e8\u5b9a\u4e3a\u65e0\u7a77\u5927\u3002\n\n\u8bb0\u5f55\u65b9\u6848\u5373\u4e3a\u8bb0\u5f55\u6bcf\u4e2a\u72b6\u6001\u662f\u4ece\u54ea\u4e2a\u72b6\u6001\u8f6c\u79fb\u6765\u7684\u5373\u53ef\u3002\n\n\u56e0\u4e3a\u7a7a\u95f4\u5f88\u7d27\uff0c\u5bf9\u6743\u503c\u548c\u5927\u4e8e\u65e0\u7a77\u5927\u7684\u76f4\u63a5\u53d6\u65e0\u7a77\u5927\uff0c\u8bb0\u5f55\u4ece\u54ea\u91cc\u8f6c\u79fb\u6765\u7684\u6570\u7ec4\u5f00 `short`\uff0c\u53ef\u4ee5\u7701\u7a7a\u95f4\u3002\n\n\u6ce8\u610f\u8fd8\u6709\u53ef\u80fd\u6709\u65e0\u6cd5\u4ece\u8d77\u70b9\u5230\u8fbe\u7684\u70b9\u5411\u666e\u901a\u70b9\u8fde\u8fb9\u7684\u60c5\u51b5\uff0c\u8fd9\u6837\u4f1a\u76f4\u63a5\u7edf\u8ba1\u5165\u5ea6\u4f1a\u51fa\u9519\uff0c\u6240\u4ee5\u8fd8\u9700\u8981\u641c\u4e00\u904d\u6c42\u5165\u5ea6\u3002\n\n```\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<string>\n#include<cstring>\n#include<algorithm>\n#include<queue>\n#include<stack>\n#include<vector>\nusing namespace std;\ninline int read(){\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();}\n\treturn x*f;\n}\nconst int N=5010;\nconst int inf=1e9+1;\nint n,m,k,f[N][N],in[N];\nshort g[N][N],h[N][N];\nbool vis[N][N];\nvector<int>a[N],b[N];\nvoid calc(int x,int y,int u,int v,int w){\n\tint val=min(f[u][v]+w,inf);\n\tif(val>=f[x][y])\n\t\treturn;\n\tf[x][y]=val;\n\tg[x][y]=u;\n\th[x][y]=v;\n}\nvoid dfs(int u){\n\tfor(int v:a[u]){\n\t\tif(vis[u][v])\n\t\t\tcontinue;\n\t\tin[v]++;\n\t\tvis[u][v]=1;\n\t\tdfs(v);\n\t}\n}\nvoid solve(){\n\tqueue<int>q;\n\tq.push(1);\n\tfor(int i=0;i<=n;i++)\n\t\tfor(int j=0;j<=n;j++)\n\t\t\tf[i][j]=inf;\n\tf[1][1]=0;\n\twhile(!q.empty()){\n\t\tint u=q.front();\n\t\tq.pop();\n\t\tfor(int i=0;i<a[u].size();i++){\n\t\t\tint v=a[u][i],w=b[u][i];\n\t\t\tfor(int j=1;j<n;j++)\n\t\t\t\tcalc(v,j+1,u,j,w);\n\t\t\tin[v]--;\n\t\t\tif(!in[v])\n\t\t\t\tq.push(v);\n\t\t}\n\t}\n}\nint main()\n{\n\tn=read(),m=read(),k=read();\n\tfor(int i=1;i<=m;i++){\n\t\tint u=read(),v=read(),w=read();\n\t\ta[u].push_back(v);\n\t\tb[u].push_back(w);\n\t}\n\tdfs(1);\n\tsolve();\n\tint p=0;\n\tfor(int i=n;i>=1;i--)\n\t\tif(f[n][i]<=k){\n\t\t\tp=i;\n\t\t\tbreak;\n\t\t}\n\tcout<<p<<'\\n';\n\tstack<int>st;\n\tint x=n,y=p;\n\twhile(1){\n\t\tst.push(x);\n\t\tif(x==1)\n\t\t\tbreak;\n\t\tint u=g[x][y],v=h[x][y];\n\t\tx=u,y=v;\n\t}\n\twhile(!st.empty()){\n\t\tcout<<st.top()<<' ';\n\t\tst.pop();\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1681296514,
        "uid": 253738,
        "name": "\u542c\u53d6MLE\u58f0\u4e00\u7247",
        "ccfLevel": 7,
        "title": "CF721C\u9898\u89e3"
    },
    {
        "content": "[CF721C  Journey](https://www.luogu.com.cn/problem/CF721C)\n\n2022/8/24 upd : \u4fee\u6539\u4e86\u90e8\u5206 latex \u3002\n\n\n\u9898\u76ee\u7b80\u4ecb\uff1a \u5728 DAG \u4e0a\u627e\u5230\u4e00\u6761\u4ece\u70b9 $1$ \u5230\u70b9 $n$ \u7684\u8def\u5f84\uff0c\u5e76\u4f7f\u5f97\u5728\u603b\u8ddd\u79bb $\\le k$ \u7684\u60c5\u51b5\u4e0b\u7ecf\u8fc7\u5c3d\u53ef\u80fd\u591a\u7684\u70b9\u3002\n\n\n\n\u770b\u5230\u6570\u636e\u8303\u56f4\uff0c $1\\le n\\le 5\\times10^3$ \uff0c\u53ef\u4ee5\u8003\u8651 $O(n^2)$ \u7684 DAG \u4e0a\u52a8\u6001\u89c4\u5212\u3002\n\n\n\n\u8bbe $dp_{i,j}$ \u8868\u793a\u4ece\u70b9 $1$ \u8d70\u5230\u70b9 $i$ \u65f6\u8def\u5f84\u957f\u5ea6\u4e3a $j$ \u7ecf\u8fc7\u7684\u6700\u5927\u70b9\u6570\u3002\u90a3\u4e48\u53ef\u4ee5\u5f97\u5230\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$\ndp_{i,j}=\\max\\{dp_{x,j-w}+1\\}(x\\overset{w}\\to i)\n$$\n\u4f46\u662f\u7531\u4e8e\u672c\u9898\u7684\u6570\u636e\u8303\u56f4\u662f $1\\le T\\le10^9$ \u56e0\u6b64\u5f00\u4e8c\u4f4d\u6570\u7ec4\u7684\u8bdd\u4f1a\u559c\u63d0 MLE \u3002\n\n\n\n\u8003\u8651\u53d8\u5f62 $dp$ \u6a21\u5f0f\uff0c\u5c06 $dp_{i,j}$ \u7684\u610f\u4e49\u6539\u4e3a\u4ece\u70b9 $1$ \u8d70\u5230\u70b9 $i$ \u65f6\u7ecf\u8fc7 $j$ \u4e2a\u70b9\u7684\u6700\u77ed\u957f\u5ea6\u3002\u56e0\u4e3a\u6b64\u65f6\u7684 $i,j\\le n\\le 5\\times10^3$ \uff0c\u6240\u4ee5\u4e0d\u4f1a\u70b8\u7a7a\u95f4\u3002\u53ef\u4ee5\u5f97\u5230\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$\n\\left\\{\n\\begin{aligned}\n&dp_{1,1}=0\\\\\n&dp_{i,j}=\\min\\{dp_{x,j-1}+w\\}(x\\overset{w}\\to i)\\\\\n&ans=\\max\\{j\\}(dp_{n,j}\\le T)\n\\end{aligned}\n\\right.\n$$\n\u4e8e\u662f\u53ea\u8981\u5c06\u6574\u4e2a\u56fe\u8fdb\u884c\u4e00\u904d\u62d3\u6251\u6392\u5e8f\uff0c\u518d\u6309\u7167\u62d3\u8865\u5e8f\u8fdb\u884c $\\text{dp}$ \u5373\u53ef\u3002\n\n\n\n\u5bf9\u4e8e\u5b58\u8def\u5f84\uff0c\u6211\u4eec\u8bb0\u5f55\u4e00\u4e2a\u6570\u7ec4 $pre_{i,j}$ \uff0c\u8868\u793a\u4ece\u70b9 $1$ \u8d70\u5230\u70b9 $i$ \u65f6\u7ecf\u8fc7\u7684\u7b2c $j$ \u4e2a\u70b9\u7684\u524d\u9a71\uff0c\u90a3\u4e48\u5bf9\u4e8e\u7b54\u6848\u6765\u8bf4\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a\u6808\u6765\u6a21\u62df\u8def\u5f84\u3002\n\n\n\n\u4e8e\u662f\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2)$ \uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $O(nm)$ \uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n\n\nAC code\uff1a\n\n```C++\n#include<bits/stdc++.h>\nusing namespace std;\nconst int INF=0x3f3f3f3f;\nconst int maxn=5e3+10;\nint dp[maxn][maxn],pre[maxn][maxn]; \nint to[maxn],vis[maxn],head[maxn],nxt[maxn],cnt;\nint upd[maxn];\nint topology[maxn],tot;\nstack<int>stk;\nqueue<int>q;\nvoid topu(int n)\n{\n\tfor(int i=1;i<=n;i++)\n\t\tif(upd[i]==0)\n\t\t\tq.push(i);\n\twhile(!q.empty())\n\t{\n\t\tint x=q.front();\n\t\tq.pop();\n\t\ttopology[++tot]=x;;\n\t\tfor(int i=head[x];i!=0;i=nxt[i])\n\t\t\tif(!(--upd[to[i]]))\n\t\t\t\tq.push(to[i]);\n\t}\n}\nint main()\n{\n\tint n,m,t;\n\tios::sync_with_stdio(false);\n\tcin>>n>>m>>t;\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint u,v,w;\n\t\tcin>>u>>v>>w;\n\t\tnxt[++cnt]=head[u];\n\t\tto[cnt]=v;\n\t\tvis[cnt]=w;\n\t\thead[u]=cnt;\n\t\tupd[v]++;\n\t}\n\ttopu(n);\n\tmemset(dp,INF,sizeof(dp));\n\tdp[1][1]=0;\n\tfor(int k=1;k<=tot;k++)\n\t{\n\t\tint cur=topology[k];\n\t\tfor(int i=head[cur];i!=0;i=nxt[i])\n\t\t{\n\t\t\tfor(int j=2;j<=n;j++)\n\t\t\t{\n\t\t\t\tif(dp[cur][j-1]+vis[i]<dp[to[i]][j])\n\t\t\t\t{\n\t\t\t\t\tdp[to[i]][j]=dp[cur][j-1]+vis[i];\n\t\t\t\t\tpre[to[i]][j]=cur;\n\t\t\t\t}\n\t\t\t}\n\t\t}\t\t\n\t}\n\tint ans=0;\n\tfor(int k=n;k>=1;k--)\n\t{\n\t\tif(dp[n][k]<=t)\n\t\t{\n\t\t\tans=k;\n\t\t\tbreak;\n\t\t}\n\t}\n\tcout<<ans<<endl;\n\tint pos=n;\n\twhile(pos)\n\t{\n\t\tstk.push(pos);\n\t\tpos=pre[pos][ans];\n\t\tans--;\n\t}\n\twhile(!stk.empty())\n\t{\n\t\tcout<<stk.top()<<\" \";\n\t\tstk.pop();\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1661135985,
        "uid": 263414,
        "name": "Sktic",
        "ccfLevel": 6,
        "title": "CF721C  Journey \u9898\u89e3"
    },
    {
        "content": "\u4f17\u6240\u5468\u77e5\uff0c\u8fd9\u662f\u4e00\u9053\u5178\u578b\u7684 DAG \u4e0a\u7684 DP\u3002\n\n\u9996\u5148\u4e00\u8c08\u5230 DAG \u4e0a\u7684 DP \u6211\u4eec\u4e00\u5b9a\u4f1a\u60f3\u5230\u62d3\u6251\u6392\u5e8f\uff0c\u62d3\u6251\u6392\u5e8f\u5462\u5c31\u662f\u7ed9\u4e00\u4e2a\u56fe\u7684\u6240\u6709\u8282\u70b9\u8fdb\u884c\u6392\u5e8f\uff0c\u8fd9\u521a\u597d\u548c\u6211\u4eec\u8fd9\u9053\u9898\u6709\u90a3\u4e48\u4e00\u4e22\u4e22\u5173\u7cfb\u3002\u4e8e\u662f\u672c\u9898\u5c31\u81ea\u7136\u8f6c\u5316\u6210\u4e86\u62d3\u6251\u6392\u5e8f\u6c42\u6700\u5c0f\u7684\u82b1\u8d39\u3002\n\n\u53ef\u662f\u8fd9\u9053\u9898\u52a0\u4e86\u4e00\u4e2a\u9650\u5236\u6761\u4ef6\uff0c\u4e5f\u5c31\u662f\u9650\u5236\u4e86\u8d70\u7684\u8def\u7a0b\u3002\u5176\u5b9e\u4e5f\u4e0d\u96be\uff0c\u53ea\u7528\u62ff\u6c42\u5230\u7684\u82b1\u8d39\uff0c\u627e\u5230\u5176\u4e2d\u6ee1\u8db3\u6761\u4ef6\u7684\u6700\u5927\u503c\u5c31\u53ef\u4ee5\u4e86\u3002\u800c\u5b58\u8def\u5f84\u66f4\u662f\u8001\u6389\u7259\u7684\u5957\u8def\u4e86\uff0c\u5728\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u548c\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\u4e2d\u6211\u4eec\u90fd\u6709\u7528\u5230\uff0c\u4e5f\u5c31\u662f\u7528\u6570\u7ec4\u8bb0\u5f55\u3002\n\n\u8fd9\u91cc\u6211\u8be6\u7ec6\u8bb2\u4e00\u4e0b\u52a8\u6001\u89c4\u5212\u7684\u8fc7\u7a0b\u3002\n\n\u5b9a\u4e49 $dp_{i,j}$ \u8868\u793a\u4ece\u7b2c\u4e00\u4e2a\u70b9\u5230\u7b2c $i$ \u4e2a\u70b9\u7ecf\u8fc7 $j$ \u4e2a\u70b9\u7684\u6700\u5c0f\u8def\u7a0b\u3002\u6211\u4eec\u679a\u4e3e\u70b9 $t$\uff0c\u8fd9\u4e2a\u70b9 $t$ \u6307\u7684\u662f\u80fd\u591f\u5230\u8fbe\u7b2c $l$ \u4e2a\u8282\u70b9\u7684\u6240\u6709\u8282\u70b9\u4e4b\u4e00\uff0c\u800c $l$ \u4e5f\u662f\u679a\u4e3e\u7684 $2$ \u5230 $n$ \u7684\u7ec8\u6b62\u8282\u70b9\uff0c\u5b9a\u4e49 vector \u6570\u7ec4 $g_{i,j}$\uff0c\u5176\u4f5c\u7528\u5c06\u5728\u540e\u6587\u4ee3\u7801\u5448\u73b0\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$dp[g_{t,i~first}][j]=max(dp[g_{t,i~first}][j],dp[t][j-1]+g_{t,i~second})$$\n\n\u539f\u56e0\u662f\u4ece $1$ \u5230 $i$ \u7684\u8def\u5f84\u662f\u7531\u4ece $1$ \u5230 $i-1$ \u52a0\u4e0a\u4ece $i-1$ \u5230 $i$ \u7684\u8def\u5f84\u76f8\u52a0\u5f97\u5230\u7684\u3002\u4e3a\u4e86\u65b9\u4fbf\u672a\u6765\u8f93\u51fa\u7b54\u6848\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u53e6\u4e00\u4e2a\u4e8c\u7ef4\u6570\u7ec4\u8fdb\u884c\u50a8\u5b58\uff0c\u4f46\u662f\u8fd9\u4e2a\u7b54\u6848\u662f\u9006\u5e8f\u50a8\u5b58\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u8f93\u51fa\u662f\u8981\u518d\u9006\u5e8f\u5904\u7406\u8f93\u51fa\uff0c\u6bd5\u7adf\u8d1f\u8d1f\u5f97\u6b63\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint in[100005];\nint n,m,t;\nvector< pair<int,int> > g[100005];\nint dp[5005][5005];\n//\u5b9a\u4e49\u72b6\u6001\uff1adp[i][j]\u8868\u793a\u4ece\u7b2c\u4e00\u4e2a\u8282\u70b9\u5230\u7b2ci\u4e2a\u8282\u70b9\u7ecf\u8fc7j\u4e2a\u70b9\u7684\u6700\u5c11\u8def\u7a0b \nint pre[5005][5005];\nvector<int> num;\nvoid work()//\u62d3\u6251 \n{\n    queue<int> que;\n    memset(dp,0x3f,sizeof(dp));\n    dp[1][1]=0;//\u521d\u59cb\u5316\uff0c1\u52301\u4e0d\u7528\u8d70\uff0c\u6545\u4e3a0 \n    for(int i=1;i<=n;i++)\n\t{\n        if(!in[i])    que.push(i);\n    }\n    while(!que.empty())\n\t{\n        int t=que.front();\n        que.pop();\n        for(int i=0;i<g[t].size();i++)\n\t\t{\n            in[g[t][i].first]--;//\u5df2\u7ecf\u5224\u65ad\u6b64\u8282\u70b9\uff0c\u4e0d\u7528\u4e8c\u6b21\u64cd\u4f5c\uff0c\u56e0\u6b64\u76f4\u63a5\u51cf\u6389 \n            for(int j=2;j<=n;j++)\n\t\t\t{\n                if(dp[g[t][i].first][j]>dp[t][j-1]+g[t][i].second)//\u7531\u4e8e\u8981\u8bb0\u5f55\uff0c\u4e0d\u80fd\u76f4\u63a5max \n\t\t\t\t{\n                    dp[g[t][i].first][j]=dp[t][j-1]+g[t][i].second;\n                    pre[g[t][i].first][j]=t;//\u8bb0\u5f55\u8282\u70b9\u987a\u5e8f \n                }\n            }\n            if(!in[g[t][i].first])    que.push(g[t][i].first);//\u53d8\u6210\u8d77\u59cb\u8282\u70b9\u7ee7\u7eed\u641c\u7d22 \n        }\n    }\n}\nint main()\n{\n    cin>>n>>m>>t;\n    for(int i=1;i<=m;i++)\n\t{\n        int u,v,c;\n        cin>>u>>v>>c; \n        g[u].push_back(pair<int,int> {v,c});\n        in[v]++;\n    }\n    work();\n    int res=-1;\n    for(int i=n;i>=1;i--)\n    {\n    \tif(dp[n][i]<=t)\n    \t{\n    \t\tres=i;\n    \t\tbreak;\n\t\t}\n\t}\n    cout<<res<<endl;\n    int now=n;\n    while(res)\n\t{\n        num.push_back(now);\n        now=pre[now][res];\n        res--;\n    }\n    for(int i=num.size()-1;i>=0;i--)    cout<<num[i]<<\" \";//\u9006\u5e8f\u8f93\u51fa \n    return 0;\n}\n```",
        "postTime": 1652108387,
        "uid": 439177,
        "name": "Super_Sheep",
        "ccfLevel": 0,
        "title": "CF721C\u9898\u89e3"
    },
    {
        "content": "## Solution\n\n\u663e\u7136 DAG \u4e0a DP . \u8bbe $dp_{i,j}$ \u8868\u793a\u8fb9\u957f\u603b\u548c\u4e3a $j$ , \u5230 $i$ \u7684\u6700\u957f\u8def\u5f84 . \u8f6c\u79fb\u65f6 $dp_{v,j} = \\text{max} \\{dp_{u,j-w} \\} + 1 $ , \u7c7b\u4f3c\u80cc\u5305\u95ee\u9898 .\n\n\u4f46\u662f\u7b2c\u4e8c\u4f4d\u8fc7\u5927 , \u53ef\u662f\u7b54\u6848\u503c\u57df\u6bd4\u8f83\u5c0f . \u8003\u8651\u80cc\u5305\u95ee\u9898\u7684\u4e00\u4e2a\u53d8\u5f62 : [AT4526](https://www.luogu.com.cn/problem/AT4526) . \u91cd\u65b0\u8bbe\u5b9a\u72b6\u6001 : $ dp_{i,j}$ \u8868\u793a\u5230 $i$ , \u7ecf\u8fc7 $j$ \u4e2a\u70b9\u6700\u77ed\u957f\u5ea6 . \u7edf\u8ba1\u7b54\u6848\u65f6\u5728 $dp_n$ \u5012\u53d9\u627e\u5230\u7b2c\u4e00\u4e2a\u5c0f\u4e8e\u7b49\u4e8e $T$ \u7684 $j$ \u5373\u53ef . \n\n\u53ef\u4ee5\u5728\u8f6c\u79fb\u65f6\u8bb0\u5f55\u6bcf\u4e00\u4e2a\u70b9\u7684\u524d\u9a71 . \u6ce8\u610f\u4e0d\u80fd\u5f00 `long long` \u4f1a\u66b4\u7a7a\u95f4 . \u8f6c\u79fb\u65f6\u5982\u679c $dp_{u,i}+w > T$ , \u90a3\u4e48\u76f4\u63a5\u4e0d\u5408\u6cd5 , \u820d\u6389\u5373\u53ef .\n\nDAG \u4e0a DP \u53ef\u4ee5\u8bb0\u5fc6\u5316 , \u4e5f\u53ef\u4ee5\u62d3\u6251\u6392\u5e8f . \u8fd9\u91cc\u4f7f\u7528\u4e86\u62d3\u6251\u6392\u5e8f .\n\n[code](https://codeforces.com/contest/721/submission/149975800) .",
        "postTime": 1647597651,
        "uid": 120947,
        "name": "Purslane",
        "ccfLevel": 7,
        "title": "CF721C"
    },
    {
        "content": "\u770b\u4e00\u773c\u6807\u7b7e\u53ef\u4ee5\u65e0\u8111\u52a8\u89c4\uff0c\u672c\u7bc7\u5c06\u8bb2\u89e3\u5982\u4f55\u52a8\u89c4\u3002\n\n- **\u9898\u610f**\n\n\u5728\u4e00\u4e2a DAG \u4e0a\u8fdb\u884c\u679a\u4e3e\uff0c\u67e5\u627e\u5934\u5230\u5c3e\u7684\u6700\u5927\u70b9\u6570\uff0c\u8ddd\u79bb\u5c0f\u4e8e $T$\u3002\n\n- **\u5206\u6790**\n\n\u9996\u5148\u53ef\u4ee5\u786e\u5b9a\u7b97\u6cd5\u4e3a\u6811\u4e0a\u52a8\u89c4\uff0c\u8003\u8651\u7b2c\u4e00\u7ef4\u4e3a\u8282\u70b9\u7f16\u53f7\uff1a\n\n\u8bbe $g_{u,k}$ \u8868\u793a\u7b2c $u$ \u4e2a\u8282\u70b9\u8ddd\u79bb\u4e3a $k$ \u7684\u6700\u5927\u70b9\u6570\u3002\n\n\u770b\u4e00\u770b\u6570\u636e\u8303\u56f4\uff0c\u660e\u663e\u4f1a\u70b8\u7a7a\u95f4\u3002\n\n\u6240\u4ee5\u53cd\u5411\uff0c\u5728\u4e09\u4e2a\u53d8\u91cf\u4e2d\u53ea\u80fd\u53d6\u70b9\u6570\u548c\u8282\u70b9\u7f16\u53f7\uff1a\n\n\u8bbe $g_{u,k}$ \u8868\u793a\u7b2c $u$ \u4e2a\u8282\u70b9\u70b9\u6570\u4e3a $k$ \u7684\u6700\u5c0f\u8ddd\u79bb\u3002\n\n\u4e8e\u662f\u63a8\u51fa\u6734\u7d20\u7684\u8868\u8fbe\u5f0f\uff1a\n\n$$g_{v, k} = \\min(g_{v, k}, g_{u, k - 1})$$\n\n\u540c\u65f6\u5173\u6ce8\u5230\u8fd8\u9700\u8981\u7ef4\u62a4\u8def\u5f84\uff0c\u4e8e\u662f\u6211\u4eec\u8bbe\u51fa\u4e00\u4e2a\u8bb0\u5f55\u8def\u5f84\u524d\u9a71\u7684\u6570\u7ec4 $pre$\n\n\u5bf9\u4e8e DAG \u56fe\uff0c\u6211\u4eec\u8003\u8651\u76f4\u63a5\u7528\u62d3\u6251\u6392\u5e8f\u6765\u4f18\u5316\u65f6\u95f4\u3002\n\n- **code**\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n//\nnamespace q_wr {\n\tinline int read() {\n\t\tchar c = getchar();\n\t\tint x = 0, f = 1;\n\t\twhile (c < '0' || c > '9') {\n\t\t\tif (c == '-') f = -1;\n\t\t\tc = getchar();\n\t\t}\n\t\twhile (c >= '0' && c <= '9') {\n\t\t\tx = (x << 1) + (x << 3) + c - '0';\n\t\t\tc = getchar();\n\t\t}\n\t\treturn x * f;\n\t}\n\tinline void write(int x) {\n\t\tif (x < 0) {\n\t\t\tx = ~(x - 1);\n\t\t\tputchar('-');\n\t\t}\n\t\tif (x > 9)\n\t\t\twrite(x / 10);\n\t\tputchar(x % 10 + '0');\n\t}\n}\n\nusing namespace q_wr;\n\nconst int maxn = 5005;\n\nstruct edge {\n\tint v, nxt, w;\n} e[maxn];\n\nint n, m, T, g[maxn][maxn], pre[maxn][maxn], ans, tot, head[maxn], in[maxn];\n\nint a[maxn], cnt;\n\nvoid add (int u, int v, int w) {\n\te[++tot] = {v, head[u], w};\n\thead[u] = tot;\n}\n\nvoid topo () {\n\tqueue <int> q;\n\tfor (int i = 1; i <= n; i++) if(!in[i]) q.push(i);\n\twhile (!q.empty()) {\n\t\tint u = q.front();\n\t\tq.pop();\n\t\tfor (int i = head[u]; i; i = e[i].nxt) {\n\t\t\tint v = e[i].v, w = e[i].w;\n\t\t\tfor (int j = 1; j <= n; j++) {\n\t\t\t\tif (g[v][j] > g[u][j - 1] + w && g[u][j - 1] + w <= T) {//\u4f18\u5316\u4e00\u4e0b\uff0c\u53ea\u6709\u5728\u6ee1\u8db3\u65f6\u95f4\u7684\u60c5\u51b5\u4e0b\u624d\u7ee7\u7eed\u66f4\u65b0\n\t\t\t\t\tg[v][j] = g[u][j - 1] + w;\n\t\t\t\t\tpre[v][j] = u;\n\t\t\t\t\tif (v == n && j > ans) ans = j;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!--in[v]) q.push(v);\n\t\t}\n\t}\n}\n\nint main () {\n\tn = read(), m = read(), T = read();\n\tfor (int i = 0, u, v, w; i < m; i++) {\n\t\tu = read(), v = read(), w = read();\n\t\tin[v]++;\n\t\tadd(u, v, w);\n\t}\n\tmemset(g, 0x3f3f3f3f, sizeof(g));\n\tg[1][1] = 0;\n\ttopo();\n\tint pos = n;\n\tfor (int i = ans; i > 0; i--) {\n\t\ta[i] = pos;\n\t\tpos = pre[pos][i];\n\t}//\u524d\u9a71\u7ef4\u62a4\u8def\u5f84\n\twrite(ans), putchar('\\n');\n\tfor (int i = 1; i <= ans; i++) {\n\t\twrite(a[i]), putchar(' ');\n\t}\n}\n```",
        "postTime": 1643076981,
        "uid": 317495,
        "name": "JWRuixi",
        "ccfLevel": 7,
        "title": "Solution CF721C"
    },
    {
        "content": "# \u7b97\u6cd5\n\n~~\u7b80\u5355\u7684~~DP+\u62d3\u6251\u3002\n\n# \u601d\u8def\n\n\u901a\u8fc7\u679a\u4e3e\u4e00\u4e2a\u70b9 $i$ \u5728\u8def\u5f84\u4e0a\u6240\u6709\u53ef\u80fd\u7684\u60c5\u51b5\uff0c\u6700\u540e\u5f97\u51fa\u70b9 $n$ \u6240\u6709\u53ef\u80fd\u60c5\u51b5\u3002\n\n\u5177\u4f53\u7684\uff0c\u5728\u8003\u8651\u70b9 $i$ \u65f6\uff0c\u6211\u4eec\u9700\u8981\u679a\u4e3e\u6240\u6709\u53ef\u4ee5\u76f4\u63a5\u5230\u8fbe $i$ \u7684\u70b9\uff0c\u901a\u8fc7\u8fd9\u4e9b\u70b9\u5df2\u6709\u7684\u72b6\u6001\u63a8\u51fa\u70b9 $i$ \u5728\u8def\u5f84\u4e0a\u6240\u6709\u72b6\u6001\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u5728\u8003\u8651 $i$ \u4e4b\u524d\u5c06\u6240\u6709\u53ef\u4ee5\u76f4\u63a5\u5230\u8fbe $i$ \u7684\u70b9\u5904\u7406\u5b8c\u3002\n\n\u663e\u800c\u6613\u89c1\uff0c\u62d3\u6251\u5e8f\u53ef\u4ee5\u4fdd\u8bc1\u5728\u5904\u7406 $i$ \u4e4b\u524d\u5c06\u6240\u6709\u53ef\u4ee5\u76f4\u63a5\u5230\u8fbe $i$ \u7684\u70b9\u5904\u7406\u5b8c\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/icyflqlz.png)\n\n\u5982\u56fe\u6240\u793a\uff0c\u5728\u5904\u7406 $i$ \u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 $1,2,3$ \u4e09\u6761\u8fb9\u76f4\u63a5\u5230\u8fbe $i$ ,\u5728\u4efb\u610f\u5305\u542b $i$ \u7684\u8def\u5f84\u4e2d\uff0c $a_1,a_2,a_3$  \u5fc5\u6709\u4e00\u4e2a\u6392\u5728 $i$ \u4e4b\u524d\u3002 \n\n\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5728 $i$ \u4e4b\u524d\u5c06 $a_1,a_2,a_3$ \u5904\u7406\u5b8c\u6bd5\u3002\n\n\u6839\u636e\u9700\u6c42\uff0c\u6211\u4eec\u53ea\u8981\u6839\u636e\u62d3\u6251\u5e8f\u904d\u5386\u5373\u53ef\u3002\n\n### \u5b9a\u4e49\uff1a\n\n$f(i,j,1)$ \u7b2c $i$ \u4e2a\u70b9\u4f5c\u4e3a\u8def\u5f84\u4e0a\u7b2c $j$ \u4e2a\u70b9\u65f6\u6700\u5c0f\u8def\u7a0b\u3002\n\n$f(i,j,0)$ \u7b2c $i$ \u4e2a\u70b9\u4f5c\u4e3a\u8def\u5f84\u4e0a\u7b2c $j$ \u4e2a\u70b9\u65f6\u4e0a\u4e00\u4e2a\u70b9\uff08\u8bb0\u5f55\u8def\u5f84\uff09\u3002\n\n### \u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\n\n$f(i,j,1)=\\min(f(i,j,1),f(k,j-1,1)+ed(k,i))$\n\n\u6211\u4eec\u679a\u4e3e $k,j$ \n\n\u6700\u540e\u5373\u53ef\u901a\u8fc7\u679a\u4e3e $f(n,1...n,1)$ \u5f97\u5230\u7b54\u6848\u3002\n\n# \u7a0b\u5e8f\n\n```\n#include<bits/stdc++.h>\nconst int MAX=100000;\nusing namespace std;\nint h[MAX],nex[MAX],v[MAX],ed[MAX],tot,in[MAX];\ninline void add(int x,int y,int z){\n\tnex[++tot]=h[x],h[x]=tot,v[tot]=y,ed[tot]=z;++in[y];//\u5165\u5ea6\u6570\n}\nint n,m,k;\nint dis[MAX],ans[MAX];\nbool used[MAX];\nint f[5010][5010][2];\nqueue<int> q;\ninline void topo(){//\u6839\u636e\u62d3\u6251\u5e8f\n\tfor(int i=1;i<=n;++i) if(!in[i]) q.push(i);//\u5165\u5ea6\u4e3a\u96f6\u76f4\u63a5\u52a0\u5165\n\twhile(!q.empty()){\n\t\tint now=q.front();\n\t\tq.pop();\n\t\tfor(int i=h[now];i;i=nex[i]){//\u679a\u4e3e\u8fb9\n\t\t\tfor(int j=2;j<=n;++j){//\u679a\u4e3e\u4f5c\u4e3a\u7b2c\u51e0\u4e2a\u70b9\n\t\t\t\tif(f[now][j-1][0]){\n\t\t\t\t\tif(f[now][j-1][1]+ed[i]>k)\tcontinue;\n\t\t\t\t\tif(f[v[i]][j][1]>f[now][j-1][1]+ed[i]){\n\t\t\t\t\t\tf[v[i]][j][1]=f[now][j-1][1]+ed[i];\n\t\t\t\t\t\tf[v[i]][j][0]=now;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!--in[v[i]]) q.push(v[i]);//\u62d3\u6251\u64cd\u4f5c\n\t\t}\n\t\tused[now]=1;\n\t}\n}\nint main(){\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tfor(int i=1;i<=m;++i){\n\t\tint x,y,z;\n\t\tscanf(\"%d%d%d\",&x,&y,&z);\n\t\tadd(x,y,z);\n\t}\n\tfor(int i=1;i<=n;++i)\n\t\tdis[i]=0x3f3f3f3f;\n\tfor(int i=1;i<=n;++i){\n\t\tfor(int j=1;j<=n;++j){\n\t\t\tf[i][j][1]=0x3f3f3f3f;\n\t\t}\n\t}\n\tdis[1]=0;\n\tf[1][1][1]=0;\n\tf[1][1][0]=-1;\n\ttopo();\n\tint p,o=0;\n\tfor(int i=n;i>=1;--i){//\u5c06\u7b54\u6848\u8def\u5f84\u53d6\u51fa\n\t\tif(f[n][i][1]<=k){\n\t\t\to=i;\n\t\t\tans[o]=n;\n\t\t\tp=f[n][o][0];\n\t\t\twhile(p!=-1){\n\t\t\t\tans[--o]=p;\n\t\t\t\tp=f[p][o][0];\n\t\t\t}\n\t\t\to=i;\n\t\t\tbreak;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",o);\n\tfor(int i=1;i<=o;++i)\n\t\tprintf(\"%d \",ans[i]);\n\treturn 0;\n} \n```\n",
        "postTime": 1618470231,
        "uid": 202606,
        "name": "\u8f7b\u7ed8",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 \u3010CF721C Journey\u3011"
    },
    {
        "content": "\u5ba3\u4f20\u535a\u5ba2->[link](https://blog.csdn.net/BWzhuzehao/article/details/113508373)\n\n\u9898\u76ee\u7ed9\u4e86\u6211\u4eec\u4e00\u5f20 DAG\uff0c\u5bf9\u4e8e DAG \u5e38\u7528\u7684\u65b9\u6cd5\u5c31\u662f\u62d3\u6251\u6392\u5e8f\u3002\n\n\u9898\u76ee\u8981\u6c42\u4e00\u6761\u4ece 1 \u5230 $n$ \u7684\u8def\u5f84\uff0c \u70b9\u6570\u5c3d\u91cf\u591a\u4f46\u662f\u8ddd\u79bb\u4e0d\u80fd\u8d85\u8fc7 $k$\uff0c\u90a3\u4e48\u6211\u4eec\u8003\u8651 DP \u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\n\n\u8bbe $f_{i,j}$ \u8868\u793a\u4ece 1 \u5f00\u59cb\u7ecf\u8fc7 $i$ \u4e2a\u70b9\uff0c\u5230\u8fbe $j$ \u70b9\u7684\u6700\u77ed\u8def\u5f84\uff0c\u90a3\u4e48\u9996\u5148\u6ee1\u8db3\u6700\u4f18\u6027\u3002\n\n\u800c\u62d3\u6251\u6392\u5e8f\u7684\u4e00\u6761\u91cd\u8981\u6027\u8d28\u5c31\u662f\u53ea\u6709\u5165\u5ea6\u4e3a 0 \u7684\u70b9\u624d\u80fd\u5904\u7406\uff0c\u6070\u597d\u6ee1\u8db3\u65e0\u540e\u6548\u6027\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u8bbe\u8ba1\u51fa\u8fd9\u6837\u7684\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$f_{i+1,v}=\\min\\{f_{i,u}+dis_{u->v}|u \\in S\\}$$\n\n$S$ \u8868\u793a\u6240\u6709\u80fd\u591f\u5230\u8fbe $u$ \u7684\u70b9\u96c6\u3002\n\n\u521d\u59cb\u72b6\u6001\u4e3a $f_{1,1}=0$\uff0c\u5176\u4f59\u4e3a\u6b63\u65e0\u7a77\u3002\n\n\u540c\u65f6\u4e3a\u4e86\u8bb0\u5f55\u65b9\u6848\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u4e00\u4e2a $g_{i,j}$ \u8868\u793a\u5f53\u524d\u72b6\u6001\u662f\u7531\u54ea\u4e2a\u70b9\u8f6c\u79fb\u800c\u6765\u7684\u3002\n\n\u6700\u540e\u8f93\u51fa\u65f6\uff0c\u4ece\u5927\u5230\u5c0f\u679a\u4e3e $i \\in [1,n]$\uff0c\u627e\u5230\u7b2c\u4e00\u4e2a $f_{i,n} \\ne \\inf$ \u5c31\u8f93\u51fa\u7b54\u6848\u4ee5\u53ca\u65b9\u6848\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long LL;\nconst int MAXN = 5000 + 10;\nint n, m, f[MAXN][MAXN], g[MAXN][MAXN], t, cnt[MAXN];\nvector <int> Next[MAXN], Num[MAXN];\n\nint read()\n{\n\tint sum = 0, fh = 1; char ch = getchar();\n\twhile (ch < '0' || ch > '9') {if (ch == '-') fh = -1; ch = getchar();}\n\twhile (ch >= '0' && ch <= '9') {sum = (sum << 3) + (sum << 1) + (ch ^ 48); ch = getchar();}\n\treturn sum * fh;\n}\n\nvoid topsort()\n{\n\tqueue <int> q;\n\tfor (int i = 1; i <= n; ++i)\n\t\tif (!cnt[i]) q.push(i);\n\twhile (!q.empty())\n\t{\n\t\tint x = q.front(); q.pop();\n\t\tfor (int i = 0; i < Next[x].size(); ++i)\n\t\t{\n\t\t\tint u = Next[x][i], w = Num[x][i];\n\t\t\tfor (int j = 1; j <= n; ++j)\n\t\t\t{\n\t\t\t\tif (f[j][x] == 0x3f3f3f3f) continue;\n\t\t\t\tif (f[j][x] + w > t) continue;\n\t\t\t\tif (f[j + 1][u] > f[j][x] + w) {f[j + 1][u] = f[j][x] + w; g[j + 1][u] = x;}\n\t\t\t}\n\t\t\t--cnt[u];\n\t\t\tif (cnt[u] == 0) q.push(u);\n\t\t}\n\t}\n}\n\nvoid print(int last, int now)\n{\n\tif (last > 1) print(last - 1, g[last][now]);\n\tprintf(\"%d \", now);\n}\n\nint main()\n{\n\tn = read(), m = read(), t = read();\n\tfor (int i = 1; i <= m; ++i)\n\t{\n\t\tint x = read(), y = read(), z = read(); cnt[y]++;\n\t\tNext[x].push_back(y), Num[x].push_back(z);\n\t}\n\tmemset(f, 0x3f, sizeof(f));\n\tf[1][1] = 0;\n\ttopsort();\n\tfor (int i = n; i >= 1; --i)\n\t\tif (f[i][n] < 0x3f3f3f3f)\n\t\t{\n\t\t\tprintf(\"%d\\n\", i);\n\t\t\tprint(i, n); printf(\"\\n\");\n\t\t\treturn 0;\n\t\t}\n}\n```",
        "postTime": 1612154315,
        "uid": 134000,
        "name": "Plozia",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF721C \u3010Journey\u3011"
    },
    {
        "content": "\u8fd9\u79cd\u6c42\u6709\u5411\u65e0\u73af\u56fe\u7684\u9898\u76ee\u5f88\u81ea\u7136\u7684\u60f3\u6cd5\u5c31\u662f\u52a8\u6001\u89c4\u5212\uff0c\u518d\u770b\u6570\u636e\u8303\u56f4\uff0c\u53d1\u73b0 $n\\le 5\\times 10^3$ \uff0c\u7a7a\u95f4\u9650\u5236\u4e3a $256\\text{MB}$\uff0c\u4e8e\u662f\uff0c\u53ef\u4ee5\u7528\u4e8c\u7ef4\u7684\u52a8\u6001\u89c4\u5212\u3002\n\n\u8bb0 $f_{i,j}$ \u4e3a\u7ecf\u8fc7 $i$ \u4e2a\u70b9\uff0c\u7ec8\u70b9\u4e3a $j$\uff0c\u80fd\u8d70\u7684\u6700\u77ed\u8def\u5f84\uff0c$g_{i,j}$ \u4e3a\u8f6c\u79fb\u5230 $f_{i,j}$ \u8fd9\u4e2a\u72b6\u6001\u7684\u524d\u4e00\u4e2a\u72b6\u6001\u7684 $j$\u3002\u5229\u7528\u62d3\u6251\u6392\u5e8f\uff0c\u6765\u8f6c\u79fb\u540e\u9762\u7684\u72b6\u6001\uff0c\u8f6c\u79fb\u65b9\u7a0b\u4e3a $f_{i,u}=\\min(f_{i-1,v}+\\text{dis}(u,v))$\uff0c\u540c\u65f6\uff0c\u9047\u5230\u66f4\u5c0f\u7684\u503c\u7684\u65f6\u5019\uff0c\u8981\u66f4\u65b0 $g_{i,u}$\u3002\u521d\u59cb\u72b6\u6001 $f_{1,1}=0$\u3002\n\n\u6700\u540e\uff0c\u5012\u5e8f\u5faa\u73af\uff0c\u627e\u5230\u7b2c\u4e00\u4e2a $i$ \u4f7f\u5f97 $f_{i,j}\\le k$\uff0c\u8f93\u51fa\u65b9\u6848\u5373\u53ef\u3002\n\n```cpp\n#include<ctime>\n#include<queue>\n#include<cctype>\n#include<cstdio>\nconst int N = 5e3 + 7;\nconst int INF = 0x3f3f3f3f;\nusing namespace std;\ninline int read() {\n\tint x = 0, f = 1; char c;\n\twhile (!isdigit(c = getchar())) f -= (c == '-') * 2;\n\twhile (isdigit(c)) x = x * 10 + f * (c - 48), c = getchar();\n\treturn x;\n}\nint n, m, k, tot, in[N], head[N], f[N][N], g[N][N];\nstruct Edge {\n\tint to, val, nxt; Edge(int to = 0, int val = 0, int nxt = 0): to(to), val(val), nxt(nxt){}\n} e[N];\nvoid add(int u, int v, int w) {\n\te[++tot] = Edge(v, w, head[u]);\n\thead[u] = tot, ++in[v];\n}\nvoid out(int x, int p) {\n\tif (x > 1) out(x - 1, g[x][p]);\n\tprintf(\"%d \", p);\n}\nvoid topo() {\n\tqueue<int> q;\n\tfor (int i = 1; i <= n; ++i) if (!in[i]) q.push(i);\n\twhile (!q.empty()) {\n\t\tint u = q.front(); q.pop();\n\t\tfor (int i = head[u]; i; i = e[i].nxt) {\n\t\t\tint v = e[i].to, w = e[i].val;\n\t\t\tfor (int j = 1; j <= n; ++j) {\n\t\t\t\tif (f[j][u] == INF) continue;\n\t\t\t\tif (f[j][u] + w > k) continue;//\u9632\u6b62\u70b8int\uff0c\u4ee5\u8282\u7701\u7a7a\u95f4\uff0c\u5426\u5219\u4f1a\u70b8\n\t\t\t\tif (f[j + 1][v] > f[j][u] + w)\n\t\t\t\t\tf[j + 1][v] = f[j][u] + w, g[j + 1][v] = u;\n\t\t\t}\n\t\t\tif (!--in[v]) q.push(v);\n\t\t}\n\t}\n}\nint main() {\n\tn = read(), m = read(), k = read();\n\tfor (int i = 1; i <= n; ++i)\n\tfor (int j = 1; j <= n; ++j) f[i][j] = INF;\n\tf[1][1] = 0;\n\tfor (int i = 1; i <= m; ++i) {\n\t\tint u = read(), v = read(), w = read();\n\t\tadd(u, v, w);\n\t}\n\ttopo();\n\tfor (int i = n; i; --i)\n\tif (f[i][n] < INF) {//\u6240\u4ee5\uff0c\u8fd9\u91cc\u53ea\u8981\u5c0f\u4e8eINF\uff0c\u5c31\u4e00\u5b9a\u5c0f\u4e8e\u7b49\u4e8ek\uff0c\u8f93\u51fa\u65b9\u6848\n\t\tprintf(\"%d\\n\", i);\n\t\tout(i, n); break;\n\t}\n\treturn 0;\n}\n```\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e0e\u7a7a\u95f4\u590d\u6742\u5ea6\u5747\u4e3a $O(n^2)$\u3002",
        "postTime": 1609988163,
        "uid": 181378,
        "name": "Alarm5854",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF721C \u3010Journey\u3011"
    }
]
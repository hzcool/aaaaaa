[
    {
        "content": "\u552f\u4e00\u7684\u4e00\u7bc7\u9898\u89e3\u6ca1\u6709\u4f7f\u7528$\\LaTeX$\uff0c\u8fd9\u91cc\u7ed9\u51fa\u4e00\u7bc7\u6392\u7248\u8f83\u4e3a\u6574\u9f50\u7684\u9898\u89e3\u3002\n\n\u8003\u8651\u5c06\u8be2\u95ee\u79bb\u7ebf\u4e0b\u6765\u7136\u540e\u6309$x$\u5750\u6807\u5206\u6cbb\u3002\n\n\u6211\u4eec\u4ee4 $mid=\\lfloor\\frac{L+R}{2}\\rfloor$\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8be2\u95ee\uff1a\n\n1. $x_1\\le mid,x_2\\ge mid$ \n\n\u5373\u8d77\u70b9\u5728 $mid$ \u4e0a\u65b9\uff0c\u7ec8\u70b9\u5728$mid$\u4e0b\u65b9\u3002\u7531\u4e8e\u53ea\u80fd\u5411\u4e0b\u6216\u5411\u53f3\u8d70\uff0c\u6240\u4ee5\u4ece $(x_1,y_1)$ \u8d70\u5230 $(x_2,y_2)$ \u5fc5\u5b9a\u7ecf\u8fc7 $mid$ \u8fd9\u4e00\u884c\u3002\n\n\u7528 $f_{i,j,k}$ \u8868\u793a $(i,j)$ \u80fd\u5426\u5230\u8fbe $(mid, k)$\uff0c\u7528 $g_{i,j,k}$ \u8868\u793a $(mid,k)$ \u80fd\u5426\u5230\u8fbe$(i,j)$\u3002\n\n\u5982\u679c\u5b58\u5728 $k$ \u4f7f\u5f97 $f_{x_1,y_1,k} \\land g_{x_2,y_2,k}=1$ \u6210\u7acb\uff0c\u90a3\u4e48\u6b64\u8be2\u95ee\u7684\u7b54\u6848\u4e3a Yes\uff0c\u5426\u5219\u4e3a No\u3002\n\n2. $x_2 < mid$\n\n\u5373\u7ec8\u70b9\u5728 $mid$ \u4e0a\u65b9\uff0c\u628a\u8be5\u8be2\u95ee\u653e\u5230 $[L,mid-1]$ \u7684\u5206\u6cbb\u4e2d\u5904\u7406\u3002\n\n3. $x_1 > mid$\n\n\u5373\u8d77\u70b9\u5728 $mid$ \u4e0b\u65b9\uff0c\u628a\u8be5\u8be2\u95ee\u653e\u5230 $[mid+1,R]$ \u7684\u5206\u6cbb\u4e2d\u5904\u7406\u3002\n\n\u5206\u6790\u8be5\u505a\u6cd5\u590d\u6742\u5ea6\u4e3a $O(nm^2\\log n+q\\log n)$\uff0c\u4e0d\u8db3\u4ee5\u901a\u8fc7\u672c\u9898\uff0c\u8003\u8651\u5728\u6c42 $f,g$ \u65f6\u4f7f\u7528 bitset \u4f18\u5316\uff0c\u4f18\u5316\u540e\u590d\u6742\u5ea6~~\u5e94\u8be5~~\u4e3a $O(\\frac{nm^2\\log n}{32}+q\\log n)$\u3002\n\n```cpp\n#include<cctype>\n#include<cstdio>\n#include<bitset>\nusing namespace std;\ninline int read()\n{\n\tint x = 0;\n\tchar ch = getchar();\n\tfor(;!isdigit(ch);ch = getchar());\n\tfor(;isdigit(ch);ch = getchar())\n\t\tx = x * 10 + (ch ^ 48);\n\treturn x;\n}\n\nconst int N = 501,M = 600010;\nbitset<N> f[N][N],g[N][N];\nint n,m,Q;\nchar s[N][N];\nstruct query\n{\n\tint x1,x2,y1,y2,id;\n}q[M],t[M];\nbool ans[M];\n\nvoid work(int l,int r,int ql,int qr)\n{\n\tif(l > r || ql > qr)\n\t\treturn;\n\tint tl = ql - 1,tr = qr + 1;\n\tint mid = l + r >> 1;\n\t\n\tfor(int i = 1;i <= m;i++)\n\t\tf[mid][i] = g[mid][i] = 0;\n\tfor(int i = m;i;i--)\n\t\tif(s[mid][i] == '.')\n\t\t\tf[mid][i][i] = 1,f[mid][i] |= f[mid][i + 1];\n\tfor(int i = 1;i <= m;i++)\n\t\tif(s[mid][i] == '.')\n\t\t\tg[mid][i][i] = 1,g[mid][i] |= g[mid][i - 1];\n\n\tfor(int i = mid - 1;i >= l;i--)\n\t\tfor(int j = m;j;j--)\n\t\t\tif(s[i][j] == '.')\n\t\t\t\tf[i][j] = f[i + 1][j] | f[i][j + 1];\n\t\t\telse\n\t\t\t\tf[i][j] = 0;\n\tfor(int i = mid + 1;i <= r;i++)\n\t\tfor(int j = 1;j <= m;j++)\n\t\t\tif(s[i][j] == '.')\n\t\t\t\tg[i][j] = g[i - 1][j] | g[i][j - 1];\n\t\t\telse\n\t\t\t\tg[i][j] = 0;\n\n\tfor(int i = ql;i <= qr;i++)\n\t{\n\t\tif(q[i].x2 < mid)\n\t\t{t[++tl] = q[i];continue;}\n\t\tif(q[i].x1 > mid)\n\t\t{t[--tr] = q[i];continue;}\n\t\t\n\t\tans[q[i].id] = (f[q[i].x1][q[i].y1] & g[q[i].x2][q[i].y2]).any();\n\t}\n\tfor(int i = ql;i <= tl;i++)\n\t\tq[i] = t[i];\n\tfor(int i = tr;i <= qr;i++)\n\t\tq[i] = t[i];\n\twork(l,mid - 1,ql,tl);\n\twork(mid + 1,r,tr,qr);\n}\nint main()\n{\n\tn = read(),m = read();\n\tfor(int i = 1;i <= n;i++)\n\t\tscanf(\"%s\",s[i] + 1);\n\tQ = read();\n\tfor(int i = 1;i <= Q;i++)\n\t\tq[i].x1 = read(),q[i].y1 = read(),q[i].x2 = read(),q[i].y2 = read(),q[i].id = i;\n\n\twork(1,n,1,Q);\n\tfor(int i = 1;i <= Q;i++)\n\t\tputs(ans[i] ? \"Yes\" : \"No\");\n}\n```",
        "postTime": 1581603579,
        "uid": 53994,
        "name": "81179332_",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF232E \u3010Quick Tortoise\u3011"
    },
    {
        "content": "\u7eaa\u5ff5\u4e00\u4e0b\u6a21\u62df\u8d5b\u573a\u5207\u8fdc\u53e4\u573a div1 E ![](https://\u5567.tk/jy)\n\n\u89c2\u5bdf\u5230\uff0c\u5982\u679c A \u80fd\u5230\u8fbe B\uff0c\u5219\u5728\u5b83\u4eec\u4e2d\u95f4\u5b58\u5728\u70b9 C \u4f7f\u5f97 A \u80fd\u5230\u8fbe C \u4e14 C \u80fd\u5230\u8fbe B\u3002\u5e76\u4e14\uff0c\u82e5\u5b58\u5728\u4ece A \u8d70\u5230 B \u7684\u4e00\u6761\u8def\u5f84\uff0c\u5219 AB \u4e4b\u95f4\u7684\u4efb\u610f\u4e00\u884c\u90fd\u5b58\u5728\u81f3\u5c11\u4e00\u4e2a\u8fd9\u6837\u7684\u70b9 C\u3002\u53cd\u4e4b\uff0c\u82e5 A \u4e0d\u80fd\u5230\u8fbe B\uff0c\u5219 AB \u4e4b\u95f4\u7684\u4efb\u610f\u4e00\u884c\u90fd\u4e0d\u5b58\u5728\u81f3\u5c11\u4e00\u4e2a\u8fd9\u6837\u7684\u70b9 C\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u53ea\u8981\u53d6\u51fa\u5904\u5728 AB \u4e4b\u95f4\u7684\u4efb\u610f\u4e00\u884c\uff0c\u68c0\u67e5\u662f\u5426\u5b58\u5728\u6ee1\u8db3\u6761\u4ef6\u7684\u70b9 C \u5373\u53ef\u3002\u6362\u79cd\u8bf4\u6cd5\uff1a\u4ee4\u70b9\u96c6 $S1$ \u8868\u793a A \u53ef\u4ee5\u5230\u8fbe\u8fd9\u4e00\u884c\u7684\u54ea\u4e9b\u70b9\uff0c$S2$ \u8868\u793a\u8fd9\u4e00\u884c\u7684\u54ea\u4e9b\u70b9\u53ef\u4ee5\u5230\u8fbe B\uff0c\u5219 $S1 \\cap S2$ \u8868\u793a\u6ee1\u8db3\u6761\u4ef6\u7684 C \u7684\u96c6\u5408\u3002 \n\nsimple \u7684\u60f3\u6cd5\u662f\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\uff0c\u7528 bitset \u7ef4\u62a4\u6bcf\u4e00\u884c\u53ef\u4ee5\u5230\u8fbe\u7684\u70b9\uff0c\u4ee5\u53ca\u80fd\u5230\u8fbe\u5b83\u7684\u70b9\uff0c\u4f46\u662f\u8fd9\u6837\u592a naive\uff0c\u663e\u7136\u65e0\u6cd5\u901a\u8fc7\u6b64\u9898\u3002\n\n\uff08\u4e0b\u6587\u4e2d\u7684\u201c\u5230\u8fbe\u201d\u53ca\u5176\u540c\u4e49\u8bcd\u5747\u4e0d\u8bb2\u987a\u5e8f\uff0c\u5373\u201cA \u53ef\u5230\u8fbe B\u201d\u5728\u201c\u5b58\u5728\u4e00\u6761\u4ece B \u5230 A \u7684\u8def\u5f84\u201d\u4e0b\u6210\u7acb\u3002\uff09\n\n\u8003\u8651\u5230\uff0c\u53ea\u8981\u5728\u4e2d\u95f4\u9009\u62e9\u4efb\u610f\u5305\u542b\u4e8e\u7eb5\u8f74\u8be2\u95ee\u533a\u95f4\u7684\u4e00\u884c\uff0c\u5c31\u53ea\u9700\u8981\u77e5\u9053\u4e0a\u4e0b\u4e24\u4e2a\u70b9\u5bf9\u4e8e\u8fd9\u4e00\u884c\u7684\u53ef\u8fbe\u6027\uff0c\u6309\u4f4d\u6216\u5373\u53ef\u5f97\u51fa\u7b54\u6848\uff0c\u8981\u505a\u7684\u4e8b\u53d8\u6210\u4e86\u5982\u4f55\u627e\u5230\u8fd9\u4e2a\u884c\u3002\n\n> \u7136\u540e\u4f60\u53d1\u73b0\u8fd9\u4e2a\u8fc7\u7a0b\u6781\u5176\u50cf\u732b\u6811\u3002  \n\u4f60\u601d\u8003\u4e86\u4e0b\u5982\u4f55\u7528\u732b\u6811\u7ef4\u62a4\uff0c\u53d1\u73b0\u975e\u5e38\u7b80\u5355\u3002  \n\u4f60\u8fc7\u4e86\u3002\n\n\u5177\u4f53\u800c\u8a00\uff0c\u5bf9\u7eb5\u8f74\u5efa\u7acb\u732b\u6811\uff0c\u8282\u70b9 $[l,r]$ \u4ee3\u8868\u7b2c $l$ \u884c\u5230\u7b2c $r$ \u884c\u7684\u533a\u95f4\uff0c\u6bcf\u4e2a\u8282\u70b9\u7ef4\u62a4\u4e00\u4e2a bitset $b_{i,j,k}=0/1$\uff0c\u8868\u793a $(i,j)$ \u662f\u5426\u53ef\u4ee5\u5230\u8fbe $(mid,k)$\u3002bitset \u628a $k$ \u8fd9\u4e00\u7ef4\u7528\u4f4d\u8fd0\u7b97\u4ee3\u66ff\uff0c\u9884\u5904\u7406\u7684\u590d\u6742\u5ea6\u53d8\u4e3a $O\\left(\\dfrac{n^3\\log n}{\\omega}\\right)$\u3002\u67e5\u8be2\u65f6\u5229\u7528\u7ecf\u5178\u5957\u8def\uff0c\u627e\u5230 $x1,x2$ \u6240\u4ee3\u8868\u8282\u70b9\u7684 LCA\uff0c\u7136\u540e\u7528 $b_{x1,y1}|b_{x2,y2}$ \u6765 $O\\left(\\log n+\\dfrac{n}{\\omega}\\right)$ \u8ba1\u7b97\u7b54\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O\\left(\\dfrac{n^3\\log n}{\\omega}+q\\left(\\log n+\\dfrac{n}{\\omega}\\right)\\right)$\u3002\n\n~~\u672c\u8d28\u662f\u5c06\u79bb\u7ebf\u5206\u6cbb\u7684\u7b97\u6cd5\u7684\u4fe1\u606f\u8bb0\u5f55\u4e0b\u6765\uff0c\u505a\u5230\u4e86\u5728\u7ebf~~\n\n```cpp\n#include<bits/stdc++.h>\n#define rgi register int\n#define mid (l+r>>1)\n#define lc k<<1\n#define rc lc|1\nusing namespace std;\nconst int N=510;\nint n,m,q,dep;\nchar ch[N][N];\nbitset<N>b[11][N][N];\nint id[N],D[N<<2],X1,Y1,X2,Y2;\n#define ok(x,y) ch[x][y]=='.'\nvoid build(int k,int l,int r,int d){\n\tD[k]=d;\n\tfor(rgi i=1;i<=m;++i){\n\t\tif(ch[mid][i]=='.'){\n\t\t\tb[d][mid][i][i]=1;\n\t\t\tif(ok(mid,i-1))b[d][mid][i]|=b[d][mid][i-1];\n\t\t}\n\t}\n\tfor(rgi i=mid+1;i<=r;++i){\n\t\tfor(rgi j=1;j<=m;++j){\n\t\t\tif(ok(i,j))b[d][i][j]=b[d][i-1][j]|b[d][i][j-1];\n\t\t}\n\t}\n\tfor(rgi i=m;i;--i){\n\t\tb[d][mid][i].reset();\n\t\tif(ch[mid][i]=='.'){\n\t\t\tb[d][mid][i][i]=1;\n\t\t\tif(ok(mid,i+1))b[d][mid][i]|=b[d][mid][i+1];\n\t\t}\n\t}\n\tfor(rgi i=mid-1;i>=l;--i){\n\t\tfor(rgi j=m;j;--j){\n\t\t\tif(ok(i,j))b[d][i][j]=b[d][i+1][j]|b[d][i][j+1];\n\t\t}\n\t}\n\tif(l==r)return void(id[l]=k);\n\tbuild(lc,l,mid,d+1),build(rc,mid+1,r,d+1);\n}\nint qry(int k1,int k2){\n\twhile(D[k1]>D[k2])k1>>=1;\n\twhile(D[k1]<D[k2])k2>>=1;\n\twhile(k1!=k2)k1>>=1,k2>>=1;\n\treturn (b[D[k1]][X1][Y1]&b[D[k2]][X2][Y2]).count();\n}\nsigned main(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(rgi i=1;i<=n;++i)scanf(\"%s\",ch[i]+1);\n\tbuild(1,1,n,0),scanf(\"%d\",&q);\n\twhile(q--){\n\t\tscanf(\"%d%d%d%d\",&X1,&Y1,&X2,&Y2);\n\t\tputs(qry(id[X1],id[X2])?\"Yes\":\"No\");\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1623819563,
        "uid": 78372,
        "name": "M4_SOPMODII_JR",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF232E Quick Tortoise"
    },
    {
        "content": "$2994ms$ \u5361\u8fc7\u529b\uff01\n\n\u8003\u8651\u9884\u5904\u7406\u51fa\u4e00\u4e2a\u6570\u7ec4 $f[i][j][k][p]=0/1$ \u8868\u793a\u5750\u6807\u4e3a $(i,j)$ \u7684\u70b9\u662f\u5426\u80fd\u5230\u8fbe\u5750\u6807\u4e3a $(k,p)$ \u7684\u70b9\uff0c\u663e\u7136\u5728\u5904\u7406\u7b2c $j$ \u5217\u7684\u65f6\u5019\u5c06 $i$ \u4ece\u4e0b\u5f80\u4e0a\u626b\uff0c\u52a8\u6001\u7684\u7ef4\u62a4\u4e00\u4e2a $g[k][p]=0/1$ \u8868\u793a\u5f53\u524d\u679a\u4e3e\u5230\u7684\u70b9 $(i,j)$ \u662f\u5426\u80fd\u5230\u8fbe\u5750\u6807\u4e3a $(k,p)$ \u7684\u70b9\u3002\n\n\u663e\u7136\uff0c\u5982\u679c\u5f53\u524d\u679a\u4e3e\u5230\u7684\u70b9\u4e3a\u969c\u788d\u65f6\uff0c\u6e05\u7a7a\u8be5\u6570\u7ec4\uff1b\u5426\u5219\u7528 $f[i][j+1]$ \u53bb\u66f4\u65b0 $g$\uff0c\u5177\u4f53\u6765\u8bf4\u53ef\u4ee5\u5c06 $f[i][j]$ \u548c $g$ \u5f00\u6210 $bitset$\uff0c\u7136\u540e\u76f4\u63a5\u7528 $g|=f[i][j+1]$\uff0c\u6bcf\u6b21\u5f97\u5230\u65b0\u7684 $g$ \u540e\u5f53\u7136\u5c31\u53ef\u4ee5\u76f4\u63a5\u8d4b\u503c\u7ed9\u5f53\u524d\u7684 $f[i][j]$ \u4e86\u3002\n\n\u5f53\u7136\u7531\u4e8e\u7a7a\u95f4\u6240\u9650\uff0c\u53ef\u4ee5\u5c06\u8be2\u95ee\u79bb\u7ebf\uff0c\u7136\u540e\u5c06 $f$ \u7684\u7b2c\u4e00\u7ef4\u6eda\u52a8\u4e00\u4e0b\uff0c\u5c31\u5f97\u5230\u4e86 $\\text{O}(\\frac{n^4}{w}+q)$\u7684\u505a\u6cd5\u4e86\uff0c\u5728\u672c\u673a\u8dd1\u6781\u9650\u6570\u636e\u4e0d\u5230 $2s$\uff0c$cf$\u7684\u5728\u7ebf $\\text{IDE}$ \u4e5f\u8dd1 $2s$ \u5de6\u53f3\uff0c\u4f46\u6211\u4e00\u65e6\u4ea4\u4e0a\u53bb\u5c31 $\\text{T}$ \uff0c\u751a\u81f3\u6211\u628a\u751f\u6210\u6570\u636e\u7684\u4ee3\u7801\u6574\u5408\u8fdb\u53bb\uff0c\u76f4\u63a5\u8dd1\uff0c\u4e5f\u5c31\u662f\u8bf4\u548c\u672c\u673a\u6d4b\u8bd5\u53ca $\\text{IDE}$ \u6570\u636e\u5b8c\u5168\u4e00\u6837\uff0c\u4f46\u4ed6\u5c31\u662f $\\text{T}$\uff0c\u6ca1\u529e\u6cd5\u53ea\u80fd\u624b\u5199 $bitset$\uff0c\u5faa\u73af\u5c55\u5f00\u7b49\u7b49\u7ec8\u4e8e\u5728 $2994ms$ \u901a\u8fc7\u4e86 /ll\uff0c~~\u5982\u679c\u6709\u8c01\u77e5\u9053\u662f\u5565\u539f\u7406\u671b\u544a\u77e5~~\n\n```cpp\nconst int maxm=6e5+10;\n\nchar s[510][510];\null b[2][510][510][8];\null tmp[510][8];\null now[8];\nstruct Req\n{\n\tint x,y,id;\n};\nvector<Req> vec[510][510];\nbool ans[maxm];\n\nint main()\n{\n\tp2=buf+fread(buf,1,1<<24,stdin);\n\trint n=read(),m=read();\n\tfor(rint i=1;i<=n;i++)\n\t{\n\t\trch ch=getchar();\n\t\twhile(ch!='.'&&ch!='#') ch=getchar();\n\t\tfor(rint j=1;j<=m;j++) s[i][j]=ch,ch=getchar();\n\t}\n\trint q=read();\n\tfor(rint i=1;i<=q;i++)\n\t{\n\t\trint x=read(),y=read();\n\t\tvec[x][y].push_back((Req){read(),read(),i});\n\t}\n\tfor(rint i=m,K=0;i;i--,K^=1)\n\t{\n\t\tnow[0]=now[1]=now[2]=now[3]=now[4]=now[5]=now[6]=now[7]=0ull;\n\t\tfor(rint j=n;j;j--)\n\t\t{\n\t\t\tif(s[j][i]=='.') now[j>>6]|=1ull<<(j&63);\n\t\t\telse now[0]=now[1]=now[2]=now[3]=now[4]=now[5]=now[6]=now[7]=0ull;\n\t\t\tb[K][j][0][0]=now[0],b[K][j][0][1]=now[1],b[K][j][0][2]=now[2],b[K][j][0][3]=now[3],b[K][j][0][4]=now[4],b[K][j][0][5]=now[5],b[K][j][0][6]=now[6],b[K][j][0][7]=now[7];\n\t\t}\n\t\tif(i!=1)\n\t\t{\n\t\t\tfor(rint j=m-i;~j;j--) tmp[j][0]=tmp[j][1]=tmp[j][2]=tmp[j][3]=tmp[j][4]=tmp[j][5]=tmp[j][6]=tmp[j][7]=0ull;\n\t\t\tfor(rint j=n;j;j--)\n\t\t\t{\n\t\t\t\tif(s[j][i-1]=='.')\n\t\t\t\t\tfor(rint k=m-i;~k;k--)\n\t\t\t\t\t\ttmp[k][0]|=b[K][j][k][0],tmp[k][1]|=b[K][j][k][1],tmp[k][2]|=b[K][j][k][2],tmp[k][3]|=b[K][j][k][3],tmp[k][4]|=b[K][j][k][4],tmp[k][5]|=b[K][j][k][5],tmp[k][6]|=b[K][j][k][6],tmp[k][7]|=b[K][j][k][7];\n\t\t\t\telse\n\t\t\t\t\tfor(rint k=m-i;~k;k--)\n\t\t\t\t\t\ttmp[k][0]=tmp[k][1]=tmp[k][2]=tmp[k][3]=tmp[k][4]=tmp[k][5]=tmp[k][6]=tmp[k][7]=0ull;\n\t\t\t\tfor(rint k=m-i,K2=K^1,k2=k+1;k2;k--,k2--)\n\t\t\t\t\tb[K2][j][k2][0]=tmp[k][0],b[K2][j][k2][1]=tmp[k][1],b[K2][j][k2][2]=tmp[k][2],b[K2][j][k2][3]=tmp[k][3],b[K2][j][k2][4]=tmp[k][4],b[K2][j][k2][5]=tmp[k][5],b[K2][j][k2][6]=tmp[k][6],b[K2][j][k2][7]=tmp[k][7];\n\t\t\t}\n\t\t}\n\t\tfor(rint j=n;j;j--)\n\t\t\tfor(re auto v:vec[j][i])\n\t\t\t\tans[v.id]=b[K][j][v.y-i][v.x>>6]>>(v.x&63)&1ull;\n\t}\n\tfor(rint i=1;i<=q;i++) ans[i]?({putchar('Y'),putchar('e'),putchar('s');}):({putchar('N'),putchar('o');}),putchar('\\n');\n\treturn 0;\n}};\n\nint main(){return lin4xu::main();}\n\n```",
        "postTime": 1623827782,
        "uid": 50477,
        "name": "linfourxu",
        "ccfLevel": 9,
        "title": "CF232E Quick Tortoise"
    },
    {
        "content": "\u9996\u5148\u5bf9\u6240\u6709\u8be2\u95ee\u8fdb\u884c\u79bb\u7ebf\u5904\u7406\uff0c\u56e0\u4e3a\u662f\u7f51\u683c\u56fe\uff0c\u6240\u4ee5\u8003\u8651\u7528\u5206\u6cbb\u6765\u89e3\u51b3\u3002\n\n\u5bf9 $[1,n]$ \u8fdb\u884c\u5206\u6cbb\uff0c\u5bf9\u4e8e\u533a\u95f4 $[l,r]$\uff0c\u5728 $mid$ \u4e24\u4fa7\u7684\u70b9\u5bf9\u4e92\u76f8\u8981\u5230\u8fbe\u4e00\u5b9a\u4f1a\u7ecf\u8fc7 $mid$ \u6240\u5728\u7684\u76f4\u7ebf\uff0c\u56e0\u6b64\u6bcf\u6b21\u5904\u7406\u51fa $f_{i,j,k}$ \u548c $g_{i,j,k}$\uff0c$f_{i,j,k}$ \u4e3a\u70b9 $(i,j)$ \u662f\u5426\u80fd\u5230\u8fbe\u70b9 $(k,mid)$\uff0c$g_{i,j,k}$ \u4e3a\u70b9 $(k,mid)$ \u662f\u5426\u80fd\u5230\u8fbe\u70b9 $(i,j)$\u3002\n\n\u5bf9\u4e8e\u5206\u522b\u5728 $mid$ \u4e24\u4fa7\u7684\u70b9\u5bf9\uff0c\u76f4\u63a5\u901a\u8fc7 $f,g$  \u53d6\u5e76\u5373\u53ef\u56de\u7b54\u8be2\u95ee\uff0c\u53ea\u5728\u4e00\u4fa7\u7684\u70b9\u5bf9\u5c31\u7ee7\u7eed\u5206\u6cbb\u4e0b\u53bb\u3002\n\n\u5c06 $n,m$ \u770b\u4f5c\u540c\u9636\uff0c\u5f97\u590d\u6742\u5ea6\u4e3a $O((n^3+q)\\log n)$\uff0c\u65e0\u6cd5\u63a5\u53d7\uff0c\u5bf9 $f,g$ \u7528 $bitset$ \u6765\u4f18\u5316\u540e\u590d\u6742\u5ea6\u4e3a $O((\\frac{n^3}{w}+q)\\log n)$\uff0c\u5373\u53ef\u901a\u8fc7\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define maxn 510\n#define maxm 600010\nusing namespace std;\ntemplate<typename T> inline void read(T &x)\n{\n    x=0;char c=getchar();bool flag=false;\n    while(!isdigit(c)){if(c=='-')flag=true;c=getchar();}\n    while(isdigit(c)){x=(x<<1)+(x<<3)+(c^48);c=getchar();}\n    if(flag)x=-x;\n}\nint n,m,t;\nbool ans[maxm];\nchar w[maxn][maxn];\nbitset<maxn> f[maxn][maxn],g[maxn][maxn];\nstruct query\n{\n    int x1,y1,x2,y2,id;\n}q[maxm],q1[maxm],q2[maxm];\nvoid solve(int L,int R,int l,int r)\n{\n    if(L>R||l>r) return;\n    int cnt1=0,cnt2=0,mid=(l+r)>>1;\n    for(int i=mid;i>=l;--i)\n    {\n        for(int j=m;j;--j)\n        {\n            if(w[i][j]=='#') continue;\n            f[i][j].reset(),f[i][j][j]=(i==mid);\n            if(i+1<=mid&&w[i+1][j]=='.') f[i][j]|=f[i+1][j];\n            if(j+1<=m&&w[i][j+1]=='.') f[i][j]|=f[i][j+1];\n        }\n    }\n    for(int i=mid;i<=r;++i)\n    {\n        for(int j=1;j<=m;++j)\n        {\n            if(w[i][j]=='#') continue;\n            g[i][j].reset(),g[i][j][j]=(i==mid);\n            if(i-1>=mid&&w[i-1][j]=='.') g[i][j]|=g[i-1][j];\n            if(j-1>=1&&w[i][j-1]=='.') g[i][j]|=g[i][j-1];\n        }\n    }\n    for(int i=L;i<=R;++i)\n    {\n        if(q[i].x2<mid) q1[++cnt1]=q[i];\n        if(q[i].x1>mid) q2[++cnt2]=q[i];\n        if(q[i].x1<=mid&&q[i].x2>=mid)\n            ans[q[i].id]=(f[q[i].x1][q[i].y1]&g[q[i].x2][q[i].y2]).any();\n    }\n    for(int i=1;i<=cnt1;++i) q[L+i-1]=q1[i];\n    for(int i=1;i<=cnt2;++i) q[L+cnt1+i-1]=q2[i];\n    solve(L,L+cnt1-1,l,mid-1),solve(L+cnt1,L+cnt1+cnt2-1,mid+1,r);\n}\nint main()\n{\n    read(n),read(m);\n    for(int i=1;i<=n;++i) scanf(\"%s\",w[i]+1);\n    read(t);\n    for(int i=1;i<=t;++i)\n        read(q[i].x1),read(q[i].y1),read(q[i].x2),read(q[i].y2),q[i].id=i;\n    solve(1,t,1,n);\n    for(int i=1;i<=t;++i) puts(ans[i]?\"Yes\":\"No\");\n    return 0;\n}\n```",
        "postTime": 1597740059,
        "uid": 172489,
        "name": "lhm_",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF232E \u3010Quick Tortoise\u3011"
    },
    {
        "content": "\u9996\u5148\u8003\u8651\u66b4\u529b\uff0c\u5bf9\u4e8e\u8be2\u95ee\u95f4\u7684\u6bcf\u4e2a \u70b9\u626b\u4e00\u4e0b\u80fd\u4e0d\u80fd\u5230\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n\\times m\\times q)$\u3002\n\n\u8003\u8651\u4f18\u5316\u4e0a\u9762\u7684\u66b4\u529b\u3002\n\n\u6ce8\u610f\u5230\u4e0a\u9762\u7684\u70b9\u5230\u4e0b\u9762\u5fc5\u987b\u7ecf\u8fc7\u67d0\u4e00\u884c\uff0c\u8003\u8651\u79bb\u7ebf\u540e\u5bf9 $x$ \u5750\u6807\u5206\u6cbb\u3002\n\n---\n\n\u8bbe\u5f53\u524d\u5206\u6cbb\u533a\u95f4\u4e3a $[l,r]$\uff0c\u4ee4 $mid=\\lfloor\\frac{l+r}{2}\\rfloor$\u3002\u5bf9\u4e8e\u533a\u95f4\u5185\u6bcf\u4e2a\u8be2\u95ee $(x1,y1,x2,y2)(l\\le x1\\le x2\\le r)$\uff0c\n\n1. \u82e5 $x2\\le mid$\uff0c\u5219\u8be5\u8be2\u95ee\u88ab $[l,mid]$ \u533a\u95f4\u5305\u542b\uff0c\u5206\u6cbb\u5373\u53ef\u3002\n2. \u82e5 $x1>mid$\uff0c\u5219\u8be5\u8be2\u95ee\u88ab $[mid+1,r]$ \u533a\u95f4\u5305\u542b\uff0c\u5206\u6cbb\u5373\u53ef\u3002\n3. \u6b64\u65f6\u4e00\u5b9a\u6709 $l\\le x1 \\le mid \\le x2 \\le r$\uff0c\u5373\u8be2\u95ee\u8de8\u8fc7 $mid$\u3002\n\n\u9700\u8981\u8003\u8651\u7684\u4ec5\u6709\u60c5\u51b5 $3$\u3002\u53ef\u4ee5\u5148\u9884\u5904\u7406\u51fa\u6765 $[l,mid-1]$ \u533a\u95f4\u5230\u8fbe $mid$ \u7ebf\u7684\u60c5\u51b5\uff0c\u9884\u5904\u7406\u51fa\u6765 $mid$ \u7ebf\u5230 $[mid+1,r]$ \u533a\u95f4\u7684\u60c5\u51b5\u3002\u82e5\u8be5\u8be2\u95ee\u7ed3\u679c\u4e3a `Yes` \u5f53\u4e14\u4ec5\u5f53 $(x1,y1)$ \u53ef\u4ee5\u5230\u8fbe $(mid,k)$ \u4e14 $(mid,k)$ \u53ef\u4ee5\u5230\u8fbe $(x2,y2)$\u3002\n\n---\n\n\u66f4\u5177\u4f53\u5730\uff0c\u8bbe $f_{i,j,k,0}$ \u8868\u793a $(i,j)$ \u662f\u5426\u80fd\u591f\u5230\u8fbe $(mid,k)$\uff0c$f_{i,j,k,1}$ \u8868\u793a $(mid,k)$ \u662f\u5426\u80fd\u591f\u5230\u8fbe $(i,j)$\u3002\u5f53 $f_{x1,y1,k,0}=1$ \u5e76\u4e14 $f_{x2,y2,k,1}=1$ \u65f6\u7ed3\u679c\u4e3a `Yes`\u3002\n\n\u5bf9\u4e8e $i=mid$ \u7684\u60c5\u51b5\uff0c\u5373 $mid$ \u8fd9\u6761\u76f4\u7ebf\u4e0a $j,k$ \u4e4b\u95f4\u662f\u5426\u6709\u969c\u788d\u3002\n\n\u82e5 $(i,j)$ \u662f\u969c\u788d\uff0c$f_{i,j,k,0}=f_{i,j,k,1}=0$\n\n\u5426\u5219 $f_{i,j,k,0}$ \u4ece\u540e\u5f80\u524d\u4f20\u9012\u5373\u53ef\uff0c$f_{i,j,k,1}$ \u4ece\u524d\u5f80\u540e\u4f20\u9012\u5373\u53ef\u3002\n\n\u5bf9\u4e8e $l\\le i < mid$ \u7684\u60c5\u51b5\uff0c$f_{i,j,k,0}=f_{i+1,j,k,0}|f_{i,j+1,k,0}$\u3002\n\n\u5bf9\u4e8e $mid<i\\le r$ \u7684\u60c5\u51b5\uff0c$f_{i,j,k,1}=f_{i-1,j,k,1}|f_{i,j-1,k,1}$\u3002 \n\n\u53d1\u73b0 $k$ \u4e00\u7ef4\u53ef\u4ee5\u4f7f\u7528 bitset \u4f18\u5316\u3002\n\n\u5206\u6cbb\u4e2d\u9884\u5904\u7406\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(\\frac{n^2\\log n\\times m}{\\omega})$\uff0c\u67e5\u8be2\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(q\\times (\\log n+\\frac{n}{\\omega}))$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n\u4ee3\u7801\uff1a\n```\n#include<bits/stdc++.h>\n#include<bitset>\nusing namespace std;\nnamespace IO{\n    template<typename T>inline void read(T &x){\n        x=0;\n        char ch=getchar();\n        bool flag=0;\n        while(ch<'0'||ch>'9') flag=flag||(ch=='-'),ch=getchar();\n        while(ch>='0'&&ch<='9') x=x*10+(ch^'0'),ch=getchar();\n        if(ch!='.'){\n            x=flag?-x:x;\n            return;\n        }\n        double Base=0.1;\n        while(ch<'0'||ch>'9') ch=getchar();\n        while(ch>='0'&&ch<='9') x=x+Base*(ch^'0'),Base/=10.0,ch=getchar();\n        x=flag?-x:x;\n    }\n    template<typename T>void prt(T x){\n        if(x>9) prt(x/10);\n        putchar(x%10+'0');\n    }\n    template<typename T>inline void put(char ch,T x){\n        if(x<0) putchar('-'),x=-x;\n        prt(x);\n        putchar(ch);\n    }\n    const int DM[10]={1,10,100,1000,10000,100000,1000000,10000000,100000000,1000000000};\n    inline void putd(char ch,double x,int w){\n        if(x<0) putchar('-'),x=-x;\n        if(!w){\n            put(ch,(int)(x+0.5));\n            return;\n        }\n        int prex=(int)x;\n        x-=(int)x;\n        x*=DM[w];\n        x+=0.5;\n        int nowx=(int)x,now=0;\n        if(nowx>=DM[w]) nowx=0,prex++;\n        put('.',prex);\n        int xx=nowx;\n        if(!xx) now=1;\n        else while(xx) xx/=10,now++;\n        now=w-now;\n        while(now--) putchar('0');\n        put(ch,nowx);\n    }\n    inline void putstr(string s){\n        for(int i=0;i<s.length();i++) putchar(s[i]);\n    }\n    inline bool getch(){\n    \tchar ch=getchar();\n    \twhile(ch!='.'&&ch!='#') ch=getchar();\n    \treturn ch=='.';\n\t}\n}\nusing namespace IO;\n#define N 505\n#define M 600005\nint n,m,q;\nbool mp[N][N],ans[M];\nbitset<501> s[N][N][2];\n/*\ns[i][j][0][k]\u8868\u793a(i,j)\u662f\u5426\u80fd\u5230(mid,k)\ns[i][j][1][k]\u8868\u793a(mid,k)\u662f\u5426\u80fd\u5230(i,j) \n*/ \nstruct query{\n\tint x,y,X,Y,id;\n}que[M],w[M];\ninline void solve(int l,int r,int ql,int qr){\n\tif(l>r||ql>qr) return;\n\tint mid=l+r>>1;\n\tfor(int i=1;i<=m;i++) s[mid][i][0]=s[mid][i][1]=0;//\u521d\u59cb\u5316\n\tfor(int i=m;i;i--) //\u6c42\u51famid\u884c\u7684\u60c5\u51b5\n\t\tif(mp[mid][i]) s[mid][i][0][i]=1,s[mid][i][0]|=s[mid][i+1][0];\n\tfor(int i=1;i<=m;i++)//\u6ce8\u610f\u4e00\u4e2a\u8981\u6b63\u63a8\u4e00\u4e2a\u8981\u53cd\u63a8\n\t\tif(mp[mid][i]) s[mid][i][1][i]=1,s[mid][i][1]|=s[mid][i-1][1];\n\tfor(int i=mid-1;i>=l;i--)//\u5bf9\u4e8el\u5230mid\u884c\u4e0a\u65b9\u7684\u60c5\u51b5\n\t\tfor(int j=m;j;j--)//\u679a\u4e3e\u6bcf\u4e2a\u70b9\uff0c\u67e5\u770b\u662f\u5426\u80fd\u5230\u8fbe\n\t\t\tif(mp[i][j]) s[i][j][0]=s[i+1][j][0]|s[i][j+1][0];\n\t\t\telse s[i][j][0]=0;\n\tfor(int i=mid+1;i<=r;i++)//\u4e0e\u4e0a\u9762\u76f8\u53cd\uff0c\u9012\u63a8mid\u884c\u5230r\u7684\u60c5\u51b5\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tif(mp[i][j]) s[i][j][1]=s[i-1][j][1]|s[i][j-1][1];\n\t\t\telse s[i][j][1]=0;\n\tint nowl=ql-1,nowr=qr+1;\n\tfor(int i=ql;i<=qr;i++){//\u5904\u7406\u5728\u8fd9\u4e2a\u533a\u95f4\u7684\u8be2\u95ee\n\t\tif(que[i].X<mid/*\u4e0b\u7aef\u70b9\u5728\u4e0a\u9762*/) w[++nowl]=que[i];\n\t\telse if(que[i].x>mid/*\u4e0a\u7aef\u70b9\u5728\u4e0b\u9762*/) w[--nowr]=que[i];\n\t\telse ans[que[i].id]=(s[que[i].x][que[i].y][0]&s[que[i].X][que[i].Y][1]).any();\n\t}\n\tfor(int i=ql;i<=nowl;i++) que[i]=w[i];//\u5206\u6cbb\u63a5\u4e0b\u6765\u7684\u533a\u95f4\n\tfor(int i=nowr;i<=qr;i++) que[i]=w[i];\n\tsolve(l,mid,ql,nowl),solve(mid+1,r,nowr,qr);\n}\nint main(){\n\tread(n),read(m);\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tmp[i][j]=getch();\n\tread(q);\n\tfor(int i=1;i<=q;i++) read(que[i].x),read(que[i].y),read(que[i].X),read(que[i].Y),que[i].id=i;\n\tsolve(1,n,1,q);\n\tfor(int i=1;i<=q;i++) putstr(ans[i]?\"Yes\\n\":\"No\\n\");\n\treturn 0;\n}\n```",
        "postTime": 1635996956,
        "uid": 172370,
        "name": "fzj2007",
        "ccfLevel": 0,
        "title": "CF232E Quick Tortoise"
    },
    {
        "content": "\u9898\u76ee\u5927\u81f4\u610f\u601d\uff1a\u7ed9\u4f60\u4e00\u4e2a\u5730\u56fe\uff0c\u53ea\u80fd\u671d\u4e0b\u548c\u53f3\u8d70\uff0c.\u80fd\u8d70\uff0c#\u4e0d\u80fd\u3002\u95ee(a,b)\u80fd\u5426\u8d70\u5230(c,d)\n\n\u7279\u522b\u611f\u8c22\u5df2\u7ecf\u6bd5\u4e1a\u7684CZR\u5927\u4f6c\u7ed9\u6211\u4eec\u7684\u8bb2\u89e3\n\n\u9996\u5148\u60f3\u5230\u66b4\u529b\u505a\u6cd5\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u6b21\u8be2\u95ee\u7528n\u65b9\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u6c42\u89e3\uff0c\u8fd9\u6837\u603b\u5171O(n^2*q)\uff0c\u80af\u5b9a\u8d85\u65f6\n\n\u6b63\u89e3\u8003\u8651\u79bb\u7ebf\u505a\u4e0e\u5206\u6cbb\n\n\n\u6211\u4eec\u4ee4L = 1\uff0cR = n\uff0cmid = L+R>>1\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8be2\u95ee\uff1a\n\n\u2460\n\u5982\u679c\u8d77\u70b9\u5728mid\u4e0a\uff0c\u7ec8\u70b9\u5728mid\u4e0b\uff0c\u5219\u4ece(a,b)->(c,d)\u5fc5\u5c06\u7ecf\u8fc7mid\u8fd9\u4e00\u884c\uff0c\u90a3\u4e48\u8003\u8651\u679a\u4e3emid\u884c\u76841~m\uff0c\u5411\u4e0a\u5411\u4e0b\u6269\u5c55\uff08\u6025\u7528\u66b4\u529b\u7684\u65b9\u6cd5\uff09\u3002\n\n\u8bb0f1[i][j][k]\u4e3a(i,j)\u80fd\u5426\u5230\u8fbe(mid, k) \uff08L <= i < mid\uff09\n\nf2[i][j][k]\u4e3a(i,j)\u80fd\u5426\u5230\u8fbe(mid,k) (mid < i <= R)\n\n\u8fd9\u91cc\u53ef\u4ee5\u7528bitset\u6765\u5b9e\u73b0\u4e24\u4e2a\u6570\u7ec4\uff0c\u5982\u679cf1[a][b] & f2[c][d]\u4efb\u610f\u4ee5\u4e3a\u662f1\u7684\u8bdd\uff0c\u5219\u8fd9\u4e2a\u8be2\u95ee\u7b54\u6848\u4e3aYes\uff0c\u5426\u5219\u4e3aNo\n\n\n\u2461\n\u5982\u679c\u7ec8\u70b9\u5728mid\u4e0a\u65b9\uff0c\u5219\u628a\u8be5\u8be2\u95ee\u653e\u5230[L, mid - 1]\u7684\u5206\u6cbb\u4e2d\u5904\u7406\n\n\u5982\u679c\u8d77\u70b9\u5728mid\u4e0b\u65b9\uff0c\u5219\u628a\u8be5\u8be2\u95ee\u653e\u5230[mid + 1, R]\u7684\u5206\u6cbb\u4e2d\u5904\u7406\n\n\u5177\u4f53\u7684\u505a\u6cd5\u8bf7\u770b\u4ee3\u7801\uff1a\n\n```cpp\n#pragma GCC optimize (2)\n#include <cstdio>\n#include <bitset>\n#include <algorithm>\nusing namespace std;\n\ninline void read (int &s) {\n\ts = 0;\n\tstatic char c = getchar ();\n\twhile (c < '0' || c > '9') c = getchar ();\n\twhile (c >= '0' && c <= '9') {\n\t\ts = (s << 1) + (s << 3) + (c & 15);\n\t\tc = getchar ();\n\t}\n\treturn ;\n}\n\nconst int N = 503;\nbitset <N> f1[N][N], f2[N][N], l; \nint n, m, q;\nchar s[N][N];\nbool ans[600007];\nstruct stu {\n\tint num;\n\tint a, b, c, d;\n}p[600007], t[600007];\n\nvoid work (int L, int R, int wl, int wr) {\n\tif (L > R || wl > wr) return ;\n\tint tl = wl - 1, tr = wr + 1;\n\tint i, j, mid = L + R >> 1;\n\tfor (i = 1; i <= m; ++i) f1[mid][i] = f2[mid][i] = 0;\n\tfor (i = m; i; --i) if (s[mid][i] == '.') {\n\t\tf1[mid][i][i] = 1;\n\t\tf1[mid][i] |= f1[mid][i + 1];\n\t}\n\tfor (i = 1; i <= m; ++i) if (s[mid][i] == '.') {\n\t\tf2[mid][i][i] = 1;\n\t\tf2[mid][i] |= f2[mid][i - 1];\n\t} //\u4ee5\u4e0a\u4e24\u4e2a\u4e3a\u521d\u59cb\u5316mid\u8fd9\u4e00\u884c\u6bcf\u4e2a\u70b9\u662f\u5426\u80fd\u5230\u8fbe\n\tfor (i = mid - 1; i >= L; --i) for (j = m; j; --j) f1[i][j] = (s[i][j] == '.') ? (f1[i + 1][j] | f1[i][j + 1]) : 0;\n\tfor (i = mid + 1; i <= R; ++i) for (j = 1; j <= m; ++j) f2[i][j] = (s[i][j] == '.') ? (f2[i - 1][j] | f2[i][j - 1]) : 0;  //\u6269\u5c55\n\tfor (i = wl; i <= wr; ++i) {\n\t\tif (p[i].c < mid) {t[++tl] = p[i];continue;}\n\t\tif (p[i].a > mid) {t[--tr] = p[i];continue;}\n\t\tl = f1[p[i].a][p[i].b] & f2[p[i].c][p[i].d];\n\t\tif (l.any ()) ans[p[i].num] = 1; //\u53ea\u8981\u4efb\u4f55\u4e00\u4f4d\u662f1\u90a3\u4e48\u5c31\u53ef\u4ee5\n\t\telse ans[p[i].num] = 0;\n\t}\n\tfor (i = wl; i <= tl; ++i) p[i] = t[i]; \n\tfor (i = tr; i <= wr; ++i) p[i] = t[i]; //\u8fd9\u4e24\u884c\u4ee3\u7801\u5bf9\u5e94\u7b2c\u4e8c\u79cd\u60c5\u51b5\n\twork (L, mid - 1, wl, tl);\n\twork (mid + 1, R, tr, wr);\n\treturn ;\n}\n\nint main () {\n\tread (n), read (m);\n\tint i, j;\n\tfor (i = 1; i <= n; ++i) {\n\t\tfor (j = 1; j <= m; ++j) {\n\t\t\ts[i][j] = getchar ();\n\t\t\twhile (s[i][j] != '.' && s[i][j] != '#') s[i][j] = getchar ();\n\t\t}\n\t}\n\tread (q);\n\tfor (i = 1; i <= q; ++i) read (p[i].a), read (p[i].b), read (p[i].c), read (p[i].d), p[i].num = i;\n\twork (1, n, 1, q);\n\tfor (i = 1; i <= q; ++i) puts (ans[i] ? \"Yes\" : \"No\");\n\treturn 0;\n}\n\n```\n\n\u5177\u4f53\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u8ba1\u7b97~~\u6211\u56e0\u4e3a\u592a\u83dc\u5df2\u7ecf\u5fd8\u4e86~~\uff0c\u53cd\u6b63\u4e0d\u4f1a\u8d85\u8fc75*10^7\nQWQ\n\n",
        "postTime": 1562079865,
        "uid": 31193,
        "name": "\u68a7\u6850\u706f",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF232E \u3010Quick Tortoise\u3011"
    },
    {
        "content": "\u4e0b\u9762\u8ba4\u4e3a $m=n$\u3002\n\n\u6709\u4e00\u4e2a\u663e\u7136\u7684\u66b4\u529b\uff1a\u5bf9\u6bcf\u4e2a\u70b9 $(x,y)$\uff0c\u9884\u5904\u7406\u51fa\u53e6\u5916\u6240\u6709\u70b9 $(p,q)$ \u662f\u5426\u80fd\u5230\u8fbe $(x,y)$\uff0c\u8bb0\u4e3a $f_{p,q,x,y}$\u3002\u67e5\u8be2 $O(1)$\uff0c\u4f46\u662f\u9884\u5904\u7406 $O(n^4)$\u3002\u7528 `bitset` \u4f18\u5316\u5373\u53ef\u505a\u5230 $O(q+\\frac{n^4}{\\omega})$\uff0c\u53ef\u60dc\u4ecd\u7136\u8fc7\u4e0d\u4e86\u3002\n\n\u8003\u8651\u628a\u4e00\u4e2a $n$ \u53d8\u6210 $\\log n$\uff0c\u53ef\u4ee5\u8003\u8651\u7c7b\u4f3c**\u732b\u6811\u5206\u6cbb**\u7684\u4e1c\u897f\u3002\u5bf9 $x$ \u8f74\u8fdb\u884c\u5206\u6cbb\uff0c\u5047\u8bbe\u5206\u6cbb\u533a\u95f4\u4e3a $[l,r]$\uff0c\u5904\u7406 $x_0\\le \\text{mid},x_1\\ge \\text{mid}$ \u7684\u8be2\u95ee\u3002\u8bb0\u5f55$f_{x,y,k}$ \u4e3a  $x\\le l$ \u7684 $(x,y)$ \u662f\u5426\u80fd\u8d70\u5230 $(\\text{mid}, k)$\uff0c$g_{x,y,k}$ \u4e3a $x\\ge l$ \u7684 $(x,y)$ \u662f\u5426\u80fd\u4ece $(\\text{mid},k)$ \u8d70\u5230\u3002\u590d\u6742\u5ea6\u662f $O(n^3\\log n+q\\log n)$ \u7684\u3002\n\n\u6b64\u65f6\u518d\u4f7f\u7528 `bitset` \u4f18\u5316\u5373\u53ef\u505a\u5230 $O\\left(\\frac{n^3\\log n}{\\omega}+q\\left(\\log n+\\frac{n}{\\omega}\\right)\\right)$\u3002\n\n~~\u8fd8\u662f\u5f88\u66b4\u529b\u3002~~\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nnamespace vbzIO {\n    char ibuf[(1 << 20) + 1], *iS, *iT;\n//    #if ONLINE_JUDGE\n//    #define gh() (iS == iT ? iT = (iS = ibuf) + fread(ibuf, 1, (1 << 20) + 1, stdin), (iS == iT ? EOF : *iS++) : *iS++)\n//    #else\n    #define gh() getchar()\n//    #endif\n    #define pc putchar\n    #define pi pair<int, int>\n    #define tu3 tuple<int, int, int>\n    #define tu4 tuple<int, int, int, int>\n    #define mp make_pair\n    #define mt make_tuple\n    #define fi first\n    #define se second\n    #define pb push_back\n    #define ins insert\n    #define era erase\n    inline int read () {\n        char ch = gh();\n        int x = 0;\n        bool t = 0;\n        while (ch < '0' || ch > '9') t |= ch == '-', ch = gh();\n        while (ch >= '0' && ch <= '9') x = (x << 1) + (x << 3) + (ch ^ 48), ch = gh();\n        return t ? ~(x - 1) : x;\n    }\n    inline void write(int x) {\n        if (x < 0) {\n            x = ~(x - 1);\n            putchar('-');\n        }\n        if (x > 9)\n            write(x / 10);\n        putchar(x % 10 + '0');\n    }\n}\nusing vbzIO::read;\nusing vbzIO::write;\n\nconst int maxn = 550;\nconst int maxm = 6e5 + 600;\nstruct node { int lx, rx, ly, ry, id; } q[maxm], ql[maxm], qr[maxm];\nint n, m, k, ans[maxm];\nchar c[maxn][maxn];\nbitset<maxn> f[maxn][maxn], g[maxn][maxn];\n\nvoid conq(int l, int r, int s, int t) {\n\tif (l == r || s > t) {\n\t\tfor (int i = 1; i <= m; i++)\n\t\t\tf[l][i].reset();\n\t\tfor (int i = 1; i <= m; i++)  if (c[l][i] == '.') f[l][i][i] = 1;\n\t\tfor (int i = m - 1; i; i--) if (c[l][i] != '#') f[l][i] |= f[l][i + 1];\n\t\tfor (int i = s; i <= t; i++) ans[q[i].id] = (f[l][q[i].ly] & f[l][q[i].ry]).any();\n\t\treturn;\n\t}\n\tint mid = (l + r) >> 1;\n\tfor (int i = l; i <= r; i++) \n\t\tfor (int j = 1; j <= m; j++) \n\t\t\tf[i][j].reset(), g[i][j].reset();\n\tfor (int i = 1; i <= m; i++) \n\t\tif (c[mid][i] == '.') f[mid][i][i] = g[mid][i][i] = 1;\n\tfor (int i = m - 1; i; i--) \n\t\tif (c[mid][i] != '#') f[mid][i] |= f[mid][i + 1];\n\tfor (int i = 2; i <= m; i++)\n\t\tif (c[mid][i] != '#') g[mid][i] |= g[mid][i - 1];\n\tfor (int i = mid - 1; i >= l; i--) {\n\t\tfor (int j = m; j; j--) {\n\t\t\tif (c[i][j] == '#') continue;\n\t\t\tf[i][j] |= f[i + 1][j];\n\t\t\tif (j < m) f[i][j] |= f[i][j + 1];\n\t\t}\n\t} \n\tfor (int i = mid + 1; i <= r; i++) {\n\t\tfor (int j = 1; j <= m; j++) {\n\t\t\tif (c[i][j] == '#') continue;\n\t\t\tg[i][j] |= g[i - 1][j];\n\t\t\tif (j > 1) g[i][j] |= g[i][j - 1];\n\t\t} \n\t}\n\tint cl = 0, cr = 0;\n\tfor (int i = s; i <= t; i++) {\n\t\tif (q[i].lx > mid && q[i].rx > mid) qr[++cr] = q[i];\n\t\telse if (q[i].lx <= mid && q[i].rx <= mid) ql[++cl] = q[i];\n\t\telse ans[q[i].id] = (f[q[i].lx][q[i].ly] & g[q[i].rx][q[i].ry]).any();\n\t}\n\tfor (int i = s; i <= s + cl - 1; i++) q[i] = ql[i - s + 1];\n\tfor (int i = s + cl; i <= s + cl + cr - 1; i++) q[i] = qr[i - s - cl + 1];\n\tconq(l, mid, s, s + cl - 1), conq(mid + 1, r, s + cl, s + cl + cr - 1);\n}\n\nint main() {\n//\tfreopen(\".in\", \"r\", stdin);\n//\tfreopen(\".out\", \"w\", stdout);\n\tn = read(), m = read();\n\tfor (int i = 1; i <= n; i++) scanf(\"%s\", c[i] + 1);\n\tk = read();\n\tfor (int i = 1, a, b, c, d; i <= k; i++) {\n\t\ta = read(), b = read(), c = read(), d = read();\n\t\tq[i] = (node) { a, c, b, d, i };\n\t}\n\tconq(1, n, 1, k);\n\tfor (int i = 1; i <= k; i++)\n\t\tputs(ans[i] ? \"Yes\" : \"No\");\n\treturn 0;\n}\n```",
        "postTime": 1679114912,
        "uid": 306573,
        "name": "Ender32k",
        "ccfLevel": 0,
        "title": "CF232E Quick Tortoise"
    },
    {
        "content": "# \u9898\u89e3 - $\\mathrm{CF232E}$\n\n## \u9898\u76ee\u610f\u601d\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF232E)\n\n\u7ed9\u4f60\u4e00\u5f20 $n\\times m$ \u7684\u56fe\u3002 $Q$ \u6b21\u8be2\u95ee $(x,y,x_1,y_1)$ \u95ee\u4f60\u80fd\u5426\u4ece $(x,y)\\sim(x_1,y_1)$\n\n$n,m\\leq 500,Q\\leq 6e5$\n\n## $\\mathrm{Sol}$\n\n\u5206\u6cbb + $\\mathrm{dp}$ + $\\mathrm{bitset}$ \u505a\u6cd5\n\n\u6211\u4eec\u8003\u8651\u79bb\u7ebf\u505a\u3002\n\n\u8003\u8651\u5982\u4f55\u5224\u5b9a\u80fd\u8d70\u5230\uff0c\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e00\u884c $l$ \u8bbe $f_{i,j,k}$ \u8868\u793a\u54ea\u4e9b $(i,j)(i\u2208[1,l])$ \u80fd\u591f\u8d70\u5230 $(l,k)$ \n\n\u540c\u65f6\u8bbe $g_{i,j,k}$ \u54ea\u4e9b $(i,j)(i\u2208[l,n])$ \u80fd\u591f\u8d70\u5230 $(l,k)$\u3002\u8f6c\u79fb\u5f88\u7b80\u5355\n\n\u6211\u4eec\u8003\u8651\u5206\u6cbb\u6765\u4f18\u5316\u8fd9\u4e2a\u679a\u4e3e $l$ \u7684\u8fc7\u7a0b\u3002\u6211\u4eec\u4ee5 $x$ \u5750\u6807\u8fdb\u884c\u5206\u6cbb\uff0c\u6bcf\u6b21\u5206\u6cbb\u4e00\u8fb9\u505a\u6389\u4e00\u5bf9\u8d77\u70b9\u7ec8\u70b9\u5728\u4e24\u7aef\u7684\u8be2\u95ee\u3002\u5bf9\u4e8e\u90a3\u4e9b\u5168\u90e8\u5728\u4e00\u6bb5\u7684\u8be2\u95ee\u7ee7\u7eed\u5206\u6cbb\u5373\u53ef\u3002\n\n\u4ee5\u53ca\u6211\u4eec\u53ef\u4ee5\u628a dp \u7528 $\\mathrm{bitset}$ \u6765\u4f18\u5316\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\log n\\times \\frac{nm^2}{w}+Q)$\n\n## $\\mathrm{Code}$\n\n```cpp\nint n,m,Q,Ans[M];\nchar ch[N][N];\nstruct Node\n{\n\tint x,y,fx,fy,id;\n};\nvector<Node> que;\nbitset<N> f[N][N],g[N][N];\ninline void solve(int l,int r,vector<Node> v) \n{\n\tif(l>r) return;\n\tint mid=l+r>>1,sz=(int)v.size();\n\tif(!sz) return;\n\tDow(i,mid,l) Dow(j,m,1) \n\t{\n\t\tf[i][j].reset(); \n\t\tif(ch[i][j]!='#') \n\t\t{\n\t\t\tif(i==mid) f[i][j][j]=1;\n\t\t\telse f[i][j]|=f[i+1][j];\n\t\t\tif(j<m) f[i][j]|=f[i][j+1];\n\t\t}\n\t}\n\tFor(i,mid,r) For(j,1,m) \n\t{\n\t\tg[i][j].reset();\n\t\tif(ch[i][j]!='#') \n\t\t{\n\t\t\tif(i==mid) g[i][j][j]=1;\n\t\t\telse g[i][j]|=g[i-1][j];\n\t\t\tif(j!=1) g[i][j]|=g[i][j-1];\n\t\t}\n\t}\n\tvector<Node> L,R;\n\tfor(Node i:v) \n\t{\n\t\tif(i.fx<mid) L.pb(i); \n\t\telse if(i.x>mid) R.pb(i);\n\t\telse Ans[i.id]|=((f[i.x][i.y]&g[i.fx][i.fy]).count()>=1); \n\t}\n\tsolve(l,mid-1,L),solve(mid+1,r,R);\n}\nint main()\n{\n\tio.read(n),io.read(m);\n\tFor(i,1,n) scanf(\"%s\",ch[i]+1); \n\tio.read(Q);\n\tFor(i,1,Q)\n\t{\n\t\tint x,y,fx,fy;\n\t\tio.read(x),io.read(y),io.read(fx),io.read(fy);\n\t\tque.pb((Node){x,y,fx,fy,i});\n\t}\n\tsolve(1,n,que);\n\tFor(i,1,Q) puts((Ans[i])?\"Yes\":\"No\");\n\treturn 0;\n}\n```\n",
        "postTime": 1603983503,
        "uid": 308464,
        "name": "\u5947\u7c73",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF232E \u3010Quick Tortoise\u3011"
    }
]
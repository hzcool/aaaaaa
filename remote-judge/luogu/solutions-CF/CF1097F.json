[
    {
        "content": "\u503c\u57df\u5f88\u5c0f,\u5e76\u4e14\u6c42\u7684\u662f\u4e2a\u6570 $\\mod 2$ \u7684\u503c,\u663e\u7136\u4f7f\u7528`bitset`\u7ef4\u62a4\u6bcf\u4e2a\u503c\u51fa\u73b0\u6b21\u6570 $\\mod 2$ \u7684\u503c\n\n\u8bbe $val_{A,i}$\u8868\u793a\u53ef\u91cd\u96c6 $A$ \u4e2d $i$ \u7684\u51fa\u73b0\u6b21\u6570 $\\mod 2$ \u7684\u503c\n\n\u5bf9\u4e8e\u64cd\u4f5c $1,2,4$,\u76f4\u63a5\u505a\u5373\u53ef.\n\n\u5bf9\u4e8e\u64cd\u4f5c $3$,\u8981\u6c42\u4ee4 $A$ \u4e3a $B,C$ \u7684\u79ef,\u5373 $\\forall i,val_{A,i}\\equiv \\sum_j\\sum_kval_{B,j}\\times val_{C,k}[\\gcd(j,k)=i]\\mod 2$\n\nemmmm,\u8fd9\u6837\u4f3c\u4e4e\u6ca1\u6cd5\u505a\n\n\u770b\u5230\u6709\u5173 $\\gcd$,\u4e0d\u59a8\u8003\u8651\u53cd\u6f14.\n\n\u8bbe $f_{A,i}=\\sum_{i|j}val_{A,j}$\n\n\u90a3\u4e48\u6709 $val_{A,i}=\\sum_{i|j}f_{A,j}\\mu(\\frac{j}{i})$\n\n\u6240\u4ee5\u53ea\u8981\u7ef4\u62a4 $f$ \u548c $\\mu$ \u4e5f\u80fd\u505a\n\n## \u64cd\u4f5c1\n\u9884\u5904\u7406,\u76f4\u63a5\u8d4b\u503c\u5373\u53ef\n## \u64cd\u4f5c2\n$$\\forall i,f_{A,i}=f_{B,i}{\\color{red}{xor}}f_{C_i}$$\n## \u64cd\u4f5c3\n$$\\forall i,f_{A,i}\\equiv \\sum_j\\sum_kval_{B,j}\\times val_{C,k}[i|\\gcd(j,k)]\\mod 2$$\n$$\\equiv \\sum_jval_{B,j}[i|j]\\times\\sum_k val_{C,k}[i|k]\\mod 2$$\n$$\\equiv f_{B,i}\\times f_{C,i}\\mod 2$$\n$$=f_{B,i}{\\color{red}{and}}f_{C,i}$$\n## \u64cd\u4f5c4\n$$val_{A,i}\\equiv \\sum_{i|j}f_{A,j}\\mu(\\frac{j}{i})\\mod 2$$\n\n\u4e0d\u59a8\u9884\u5904\u7406 $g_{i,j}\\equiv \\left\\{\\begin{aligned}\\mu(\\frac{j}{i})&&&i|j\\\\0&&&otherwise\\end{aligned}\\right.\\mod 2$\n\n$$val_{A,i}\\equiv \\sum_jf_{A,j}\\times g_{i,j}\\mod 2$$\n\n${\\color{red}{and}}$ \u4e4b\u540e\u4f7f\u7528 `count()`\u5c31\u597d\u4e86",
        "postTime": 1603078087,
        "uid": 114409,
        "name": "9AC8E2",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1097F \u3010Alex and a TV Show\u3011"
    },
    {
        "content": "\u8003\u8651\u5230\u7b54\u6848\u5411 $2$ \u53d6\u6a21\uff0c\u5e76\u4e14\u503c\u57df\u8f83\u5c0f\uff0c\u96c6\u5408\u4e2d\u5b58\u5728\u4e24\u4e2a\u4e00\u6837\u7684\u6570\u5c31\u53ef\u4ee5\u6d88\u53bb\uff0c\u7c7b\u4f3c\u4e8e\u5f02\u6216\u3002\u9700\u8981\u60f3\u4e00\u4e9b\u53e6\u7c7b\u7684\u529e\u6cd5\u3002\n\n\u8bb0 $S_i$ \u8868\u793a $S$ \u96c6\u5408\u91cc\u662f\u5426\u5b58\u5728 $i$ \u8fd9\u4e2a\u6570\u3002\u518d\u8bb0 $\\displaystyle f(S,i) = \\sum_{d=1} S_{id}$\uff0c\u8fd9\u4e2a\u4e1c\u897f\u7684\u610f\u4e49\u5373\u4e3a $S$ \u96c6\u5408\u91cc\u9762\u4e3a $d$ \u7684\u500d\u6570\u7684\u6570\u7684\u4e2a\u6570\u3002\n\n\u7136\u540e\u8003\u8651\u51e0\u4e2a\u64cd\u4f5c\u3002\n\n\u7b2c\u4e00\u4e2a\u64cd\u4f5c\u53ef\u4ee5\u76f4\u63a5\u8d4b\u503c\u3002\u7b2c\u4e8c\u4e2a\u662f\u53ef\u91cd\u96c6\u5e76\uff0c\u76f8\u5f53\u4e8e\u5f02\u6216\u3002\n\n\u7b2c\u4e09\u4e2a\u64cd\u4f5c\u6bd4\u8f83\u8ff7\u60d1\uff0c\u6211\u4eec\u5148\u6c42\u51fa $S = A \\times B$ \u7684\u6bcf\u4e00\u4f4d\u3002\n\n$$\n\\begin{aligned}\nS_i \n&= \\sum_{j} \\sum_{k} [\\gcd(j,k) = i] a_jb_k \\\\\n&= \\sum_{j} \\sum_{k} [\\gcd(j,k) = 1] a_{ij}b_{jk} \\\\\n&= \\sum_{j} \\sum_{k} a_{ij} b_{jk} \\sum_{d|\\gcd(i,j)} \\mu(d) \\\\\n&= \\sum_{d} \\mu(d) \\sum_{j} a_{ijd} \\sum_{k} b_{ikd} \\\\\n&= \\sum_{d} \\mu(d) f(A,id) f(B,id)\n\\end{aligned}\n$$\n\n\u63a8\u5230\u8fd9\u91cc\u5dee\u4e0d\u591a\u544a\u4e00\u6bb5\u843d\uff0c\u53ef\u4ee5\u53d1\u73b0 $S_i$ \u6ca1\u6cd5\u5feb\u901f\u7ef4\u62a4\u5e76\u7b97\u51fa\u3002\u6211\u4eec\u8003\u8651\u7b97 $f(S,i)$\u3002\n\n\u663e\u7136 $\\displaystyle f(S,i) = \\sum_{d} S_d$\uff0c\u6240\u4ee5\u6709\uff1a\n\n$$\n\\begin{aligned}\nf(S,i)\n&= \\sum_{i|p} \\sum_{d=1} \\mu(d) f(A,pd) f(B,pd) \\\\\n&= \\sum_{p=1} f(A,pi) f(B,pi) \\sum_{d|p} \\mu(d) \\\\\n&= \\sum_{p=1} f(A,pi) f(B,pi) [p=1] \\\\\n&= f(A,i) f(B,i)\n\\end{aligned}\n$$\n\n\u8fd9\u4e2a\u4e1c\u897f\u770b\u8d77\u6765\u5c31\u8d4f\u5fc3\u60a6\u76ee\u591a\u4e86\uff0c\u4e24\u4e1c\u897f\u5bf9\u4f4d\u76f8\u4e58\u5728\u6a21 $2$ \u610f\u4e49\u4e0b\u76f8\u5f53\u4e8e $\\operatorname{and}$ \u8fd0\u7b97\u3002\n\n\u5230\u8fd9\u91cc\u5df2\u7ecf\u4e0d\u96be\u60f3\u5230\u7528 `bitset` \u53bb\u7ef4\u62a4 $f$ \u4e86\u3002\n\n\u6700\u540e\u8003\u8651\u600e\u4e48\u5904\u7406\u64cd\u4f5c\u56db\u3002\u6ce8\u610f\u5230\u8981\u6c42 $\\displaystyle S_v = \\sum_{d} \\mu(d) f(S,dv)$\u3002\u4e0d\u53ef\u80fd\u5bf9\u6bcf\u4e2a $v,d$ \u90fd\u5904\u7406\uff0c\u90a3\u4e48\u8003\u8651\u4f18\u5316\u6389\u8fd9\u4e2a\u4e1c\u897f\u3002\u6211\u4eec\u6784\u9020\u4e00\u4e2a $M(v)$ \u4f7f\u5f97 $M(v) \\times f(S) \\bmod 2 = S_v$\u3002\u6709\u4e00\u4e2a\u663e\u7136\u7684\u65b9\u6cd5\u662f $M(v,dv) = \\mu(d)$\uff0c\u90a3\u4e48\u53c8\u53d8\u6210\u76f8\u4e58\u7b97 $1$ \u7684\u4e2a\u6570\uff0c\u7528\u4e86 `bitset` \u5c31\u5f88\u597d\u5904\u7406\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(V \\ln V + \\frac{mV}{\\omega})$\uff0c\u5176\u4e2d $V$ \u4e3a\u503c\u57df\uff0c$\\omega = 64$ \u6216 $32$\u3002\n\n```cpp\nint cnt,prime[7005],mu[7005];\nbool vis[7005];\nbitset<7005> B[100005],F[7005],M[7005];\nvoid hisa(int up)\n{\n\tvis[mu[1]=1]=true;\n\tfor(int i=2;i<=up;++i)\n\t{\n\t\tif(!vis[i])\tprime[++cnt]=i,mu[i]=1;\n\t\tfor(int j=1;j<=cnt && prime[j]*i<=up;++j)\n\t\t{\n\t\t\tvis[prime[j]*i]=true;\n\t\t\tif(i%prime[j]==0)\tbreak;\n\t\t\tmu[prime[j]*i]=mu[i];\n\t\t}\n\t}\n}\nint n,m;\nint main(){\n\thisa(7000);\n\tfor(int i=1;i<=7000;++i)\tfor(int j=1;j*i<=7000;++j)\tF[j*i][i]=1;\n\tfor(int i=1;i<=7000;++i)\tfor(int j=1;j*i<=7000;++j)\tM[i][j*i]=mu[j];\n\tn=read(),m=read();\n\twhile(m-->0)\n\t{\n\t\tint op=read(),x=read();\n\t\tif(op==1)\tB[x]=F[read()];\n\t\telse if(op==2)\tB[x]=B[read()]^B[read()];\n\t\telse if(op==3)\tB[x]=B[read()]&B[read()];\n\t\telse\tputchar('0'+((B[x]&M[read()]).count()&1));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1649989972,
        "uid": 184977,
        "name": "pomelo_nene",
        "ccfLevel": 9,
        "title": "\u4f60\u6700\u540e\u4e00\u4e2a\u7b2c\u4e00\u5929"
    },
    {
        "content": "\u5999\u5999\u9898\u2026\u2026\n\n\u8fd9\u9053\u9898\u8fd9\u8981\u6c42%2\u7684\u4e2a\u6570\uff0c\u80af\u5b9a\u6709\u4ec0\u4e48\u6027\u8d28\n\n~~\u4e8e\u662f\u6211\u4eec\u60f3\u5230\u4e86\u7528$bitset$\u6765\u5904\u7406~~\n\n\u7531\u4e8e\u4e09\u64cd\u4f5c\u6709$gcd$\uff0c~~\u4e8e\u662f\u6211\u4eec\u53c8\u60f3\u5230\u7528\u53cd\u6f14\u6765\u89e3\u51b3~~\n\n\u6211\u4eec\u56de\u5fc6\u4e00\u4e0b\u53cd\u6f14\u7684\u67ff\u5b50\n\n\u8bbe$f(x)$\u4e3ax\u51fa\u73b0\u4e86\u591a\u5c11\u6b21\uff0c$F(x)$\u4e3ax\u7684\u500d\u6570\u51fa\u73b0\u4e86\u591a\u5c11\u6b21\n\n$$F(d) = \\sum_{d|x}f(x)$$\n\n\u8ddf\u636e\u53cd\u6f14\uff0c\u6211\u4eec\u6709\uff1a\n\n$$f(x) = \\sum_{x |d}F(d) * \\mu(\\frac{d}{x})$$\n\n\u6211\u4eec\u8981\u6c42\u7684\u6570\u5373\u4e3a$f(v)$\n\n\u7531\u4e8e$\\mu$\u7684\u53d6\u503c\u53ea\u6709$-1, 0, 1$\uff0c\u5728\u819c\u4e8c\u610f\u4e49\u4e0b\u53ea\u6709$0, 1$\n\n\u6211\u4eec\u7528$a[x][y]$\u8868\u793a$x$\u96c6\u5408\u5185\u7684y\u5373y\u7684\u500d\u6570\u51fa\u73b0\u4e86\u591a\u5c11\u6b21\uff08$F(y)$\uff09\uff0c\u518d\u7528$u[x][y]$\u8868\u793a$\\mu(\\frac{y}{x})$\uff0c\u6211\u4eec\u8981\u6c42\u7684$f(v) = a[x]\\&u[v]$\n\n\u518d\u6765\u91cd\u65b0\u8003\u8651\u6240\u6709\u64cd\u4f5c\uff1a\n\n\u5bf9\u4e8e1\u64cd\u4f5c\uff0c\u9884\u5904\u7406\u51fa\u6bcf\u4e00\u4e2av\u7684\u6240\u6709\u7ea6\u6570\u7684$bitset$\uff0c\u8d4b\u503c\u5373\u53ef\n\n\u5bf9\u4e8e2\u64cd\u4f5c\uff0c\u76f4\u63a5\u7528$a[x]=a[y]^a[z]$\u5373\u53ef\n\n\u5bf9\u4e8e3\u64cd\u4f5c\uff0c$a[x] = a[y]\\&a[z]$\n\n\u5bf9\u4e8e4\u64cd\u4f5c\uff0c\u7528\u4e0a\u8ff0\u65b9\u6cd5\u6c42\u51fa$bitset$\u540e\u7684$1$\u7684\u6570\u91cf\n## $Code:$\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define il inline\n#define re register\nil int read() {\n    re int x = 0, f = 1; re char c = getchar();\n    while(c < '0' || c > '9') { if(c == '-') f = -1; c = getchar();}\n    while(c >= '0' && c <= '9') x = x * 10 + c - 48, c = getchar();\n    return x * f;\n}\n#define rep(i, s, t) for(re int i = s; i <= t; ++ i)\n#define maxn 7001\n#define maxm 100005\nint n, m, prim[maxn], vis[maxn], mu[maxn], cnt;\nbitset<maxn>G[maxn], a[maxm], u[maxn];\nint main() {\n\tn = read(), m = read(), mu[1] = 1;\n\trep(i, 2, 7000) {\n\t\tif(!vis[i]) prim[++ cnt] = i, mu[i] = -1;\n\t\tfor(re int j = 1; j <= cnt && prim[j] * i <= 7000; ++ j) {\n\t\t\tvis[i * prim[j]] = 1;\n\t\t\tif(i % prim[j] == 0) break;\n\t\t\tmu[i * prim[j]] = -mu[i];\n\t\t}\n\t}\n\trep(i, 1, 7000) {\n\t\tfor(re int j = i; j <= 7000; j += i) G[j][i] = 1, u[i][j] = mu[j / i] != 0;\n\t}\n\twhile(m --) {\n\t\tint opt = read(), x = read();\n\t\tif(opt == 1) a[x] = G[read()];\n\t\tif(opt == 2) a[x] = a[read()] ^ a[read()];\n\t\tif(opt == 3) a[x] = a[read()] & a[read()];\n\t\tif(opt == 4) printf(\"%d\", (u[read()] & a[x]).count() & 1);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1570328064,
        "uid": 57014,
        "name": "Nemlit",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1097F \u3010Alex and a TV Show\u3011"
    },
    {
        "content": "\u8fd9\u9898\u7684\u96be\u70b9\u5728\u4e8e\u4e58\u6cd5\u64cd\u4f5c\u3002\n\n\u6211\u4eec\u53d1\u73b0\u5b83\u5176\u5b9e\u662f gcd \u5377\u79ef\u3002\n\n\u6839\u636e\u67d0\u8457\u540d\u539f\u7406\uff0cgcd \u76f8\u5f53\u4e8e\u4f4d\u8fd0\u7b97\u4e0a\u7684\u4e0e\u3002\n\n\u4e8e\u662f\u6211\u4eec\u8003\u8651\u5728\u6bcf\u4e00\u4e2a\u8d28\u56e0\u6570\u7ef4\u5ea6\u8fdb\u884c $\\textsf{FMT}$\u3002\n\n\u800c\u8fd9\u91cc $\\textsf{FMT}$ \u76f8\u5f53\u4e8e $\\sum\\limits_{j|i}f_j$\uff0c\u6211\u53eb\u5b83 $\\textsf{FGT}$\u3002\n\n\u4e8e\u662f\u6211\u4eec\u7528 bitset \u5bc4\u5f55\u6bcf\u4e2a\u70b9\u7684 $\\textsf{FGT}$\uff0c\n\u7136\u540e 1 \u64cd\u4f5c\u76f4\u63a5\u9884\u5904\u7406\u6bcf\u4e2a\u503c\u5bf9\u5e94\u7684 $\\textsf{FGT}$\u3002\n\n2 \u64cd\u4f5c $\\textsf{FGT}(C)=\\sum\\limits_{j|i}C_j=\\sum\\limits_{j|i}A_j+B_j=\\textsf{FGT}(A)+\\textsf{FGT}(B)$ \u76f8\u5f53\u4e8e bitset \u91cc\u7684 xor\u3002\n\n3 \u64cd\u4f5c\u56e0\u4e3a\u6211\u4eec $\\textsf{FGT}$ \u5b8c\u5c31\u76f4\u63a5\u76f8\u4e58\u5c31\u53ef\u4ee5\u4e86\uff0c\u76f8\u5f53\u4e8e and\u3002\n\n4 \u64cd\u4f5c\u67e5\u8be2\u5355\u70b9 $\\textsf{IFGT}$ \u540e\u7684\u503c\uff0c\u53ef\u4ee5\u76f4\u63a5\u66b4\u529b\u3002\n\n\uff08\u5b9e\u9645\u4e0a $\\textsf{FGT}$ \u76f8\u5f53\u4e8e\u53cd\u6f14\uff1f\uff09\u3002\n\n```cpp\nconst int maxn = 7e3+5;const int maxm = 1e5+5;\nll n,T,U[maxn],t,x,y,z;bitset<maxn>p[maxn],q[maxn],a[maxm];\nint main(){\n\tn=read();T=read();U[1]=1;\n\tF(i,1,7e3)for(int j=i*2;j<=7e3;j+=i)U[j]^=U[i];\n\tF(i,1,7e3)F(j,1,7e3){if(i%j==0)p[i][j]=1;if(j%i==0)q[i][j]=U[j/i];}\n\twhile(T--){\n\t\tt=read();x=read();y=read();\n\t\tif(t==1)a[x]=p[y];\n\t\telse if(t==2)a[x]=a[y]^a[read()];\n\t\telse if(t==3)a[x]=a[y]&a[read()];\n\t\telse cout<<((a[x]&q[y]).count()&1);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1667738136,
        "uid": 359952,
        "name": "_lbw_",
        "ccfLevel": 6,
        "title": "[\u53cd\u6f14\u5bc4\u5f55]CF1097F"
    },
    {
        "content": "~~\u8fd9\u4e2a\u96be\u5ea6\u662f\u5047\u7684\u5427\u3002~~\n\n\u7531\u4e8e\u201c\u5728\u6a21 $2$ \u610f\u4e49\u4e0b\u201d\uff0c\u5f88\u81ea\u7136\u60f3\u5230 `bitset` \u7ef4\u62a4\u3002\n\n\u64cd\u4f5c\u4e00\u53ef\u4ee5\u76f4\u63a5\u8d4b\u503c\uff0c\u64cd\u4f5c\u4e8c\u7531\u4e8e\u6a21 $2$ \uff0c\u53ef\u4ee5\u76f4\u63a5\u5f02\u6216\u8d77\u6765\uff0c\u81f3\u4e8e\u64cd\u4f5c\u56db\u76f4\u63a5\u67e5\u8be2\u5373\u53ef\u3002\n\n\u64cd\u4f5c\u4e09\u4e0d\u4f1a\u505a\u4e86\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u7ef4\u62a4**\u6bcf\u4e2a\u53ef\u91cd\u96c6\u7684\u6240\u6709\u7ea6\u6570\u6784\u6210\u7684\u53ef\u91cd\u96c6**\uff0c\u6b64\u65f6\u64cd\u4f5c\u4e09\u660e\u663e\u5c31\u662f\u6309\u4f4d\u4e0e\u3002\n\n\u6b64\u65f6\u4e3a\u4e86\u89e3\u51b3\u64cd\u4f5c\u4e00\uff0c\u8003\u8651\u628a\u503c\u57df\u5185\u6bcf\u4e2a\u6570\u7684\u7ea6\u6570\u6784\u6210\u7684 `bitset` \u9884\u5904\u7406\u51fa\u6765\u3002\u7136\u540e\u64cd\u4f5c\u4e8c\u4e0d\u53d8\uff0c\u64cd\u4f5c\u56db\u548b\u529e\uff1f\n\n\u4e0d\u59a8\u8bbe\u539f\u53ef\u91cd\u96c6\u4e3a $S$ \uff0c\u5176\u7ea6\u6570\u6784\u6210\u7684\u53ef\u91cd\u96c6\u4e3a $T$ \uff0c\u6211\u4eec\u8981\u6c42 $S$ \u4e2d $p$ \u7684\u4e2a\u6570\uff1a\n\n$$\\begin{aligned}&\\ \\ \\ \\ \\sum\\limits_{q\\in S}[p=q]\\\\&=\\sum\\limits_{q\\in S}[\\frac{q}{p}=1]\\\\&=\\sum\\limits_{q\\in S}\\sum\\limits_{d\\mid \\frac{q}{p}}\\mu(d)\\\\&=\\sum\\limits_{q\\in T,p\\mid q}\\mu(q)\\end{aligned}$$\n\n\u524d\u4e24\u6b65\u76f4\u63a5\u53cd\u6f14\uff0c\u6700\u540e\u585e\u5230 $T$ \u91cc\u9762\u5373\u53ef\u3002\n\n\u6839\u636e\u524d\u4eba\u7684\u7ecf\u9a8c\u6211\u4eec\u77e5\u9053 $-1\\equiv 1\\mod 2$ \uff0c\u4e8e\u662f\u6211\u4eec\u53ea\u9700\u8981\u77e5\u9053 $p$ \u662f\u5426\u542b\u6709\u5e73\u65b9\u56e0\u5b50\u5373\u53ef\u3002\n\n\u8003\u8651\u5bf9\u6bcf\u4e2a\u6570\u9884\u5904\u7406\u51fa**\u5176\u500d\u6570\u4e2d\u9664\u4ee5\u5b83\u4e0d\u542b\u5e73\u65b9\u56e0\u5b50\u7684\u4f4d\u7f6e\u6784\u6210\u96c6\u5408**\uff0c\u6c42\u7b54\u6848\u7684\u65f6\u5019\u5148\u6309\u4f4d\u4e0e\u518d\u627e $1$ \u7684\u4e2a\u6570\u5c31\u597d\u4e86\u3002\n\n\n\u987a\u4fbf\u8bf4\u4e00\u53e5\uff0c\u8fd9\u4e2a\u9884\u5904\u7406\u662f\u53ef\u4ee5 $O(v\\ln v)$ \u7684\uff0c\u65b9\u6cd5\u5982\u4e0b\uff1a\n\n$$\\sum\\limits_{i=1}^{\\sqrt{v}}\\frac{v}{i^2}+\\sum\\limits_{i=1}^{v}\\frac{v}{i}=v(\\sum\\limits_{i=1}^{\\sqrt v}\\frac{1}{i^2}+\\sum\\limits_{i=1}^{v}\\frac{1}{i})\\le 2v\\ln v$$\n\n\u540e\u9762\u90a3\u6b65\u8c03\u548c\u7ea7\u6570\u6613\u5f97\u3002\n\n\u603b\u590d\u6742\u5ea6 $O(v\\ln v+\\frac{v}{w}\\times q)$\n\n- $\\mathtt{code:}$\n\n```cpp\nmu.set();// \u9884\u5904\u7406mu\u662f\u5426\u6709\u5e73\u65b9\u56e0\u5b50\nfor (int i = 2; i * i <= maxw - 1; i++) {\n\tfor (int j = 1; j * i * i <= maxw - 1; j++) {\n\t\tmu[i * i * j] = 0;\n\t}\n}\nfor (int i = 1; i <= maxw - 1; i++) {\n\tfor (int j = 1; i * j <= maxw - 1; j++) {\n\t\tpre[i * j][i] = 1;// \u8fd8\u662f\u9884\u5904\u7406\n\t\tfac[i][i * j] = mu[j];\n\t}\n}\nfor (int i = 1, op, x, y, z; i <= m; i++) {\n\tscanf(\"%d%d%d\", &op, &x, &y);\n\tif (op == 1) s[x] = pre[y];// \u5904\u7406\u6bcf\u4e2a\u96c6\u5408\u7ea6\u6570\u6784\u6210\u7684\u53ef\u91cd\u96c6\uff0c\u76f4\u63a5\u8d4b\u503c\n\telse if (op == 2) {\n\t\tscanf(\"%d\", &z);\n\t\ts[x] = s[y] ^ s[z];// \u76f4\u63a5\u5f02\u6216\n\t} else if (op == 3) {\n\t\tscanf(\"%d\", &z);\n\t\ts[x] = s[y] & s[z];// \u76f4\u63a5\u6309\u4f4d\u4e0e\n\t} else {\n\t\tans += ((s[x] & fac[y]).count() & 1) + '0';// \u7edf\u8ba1\u7b54\u6848\n\t}\n}\nprintf(\"%s\", ans.c_str());\n```",
        "postTime": 1636891723,
        "uid": 306573,
        "name": "Ender32k",
        "ccfLevel": 0,
        "title": "CF1097F Alex and a TV Show \u9898\u89e3"
    }
]
[
    {
        "content": "## Description\n\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5b57\u7b26\u4e32 $s$\uff0c\u73b0\u5728\u6709\u4e00\u4e2a\u6253\u5b57\u673a\uff0c\u6bcf\u6b21\u4f60\u53ef\u4ee5\u82b1\u8d39 $a$ \u7684\u4ee3\u4ef7\u6253\u51fa\u4e00\u4e2a\u5b57\u7b26\uff0c\u6216\u8005\u82b1\u8d39 $b$ \u7684\u4ee3\u4ef7\u6253\u51fa\u4e00\u4e2a \u5df2\u7ecf\u6253\u51fa\u7684\u5b57\u7b26\u4e32 \u7684\u5b50\u4e32\uff0c\u6c42\u6253\u51fa $s$ \u7684\u6700\u5c0f\u4ee3\u4ef7\u3002$(1 \\leq n,a,b \\leq 5 \\times 10^3)$\n\n## Solution\n\n\u5f88\u5bb9\u6613\u60f3\u5230 $O(n^3)$ \u7684 **DP** \u3002\n\n\u6211\u4eec\u7528 $f_i$ \u8868\u793a\u6253\u5b8c\u524d $i$ \u4e2a\u5b57\u7b26\u6240\u9700\u8981\u7684\u6700\u5c0f\u4ee3\u4ef7\uff0c\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e3a\n\n$$f_i = \\min \\left( f_{i - 1} + a,\\min \\{ f_{i - k}\\} + b \\right)$$\n\n\u8003\u8651\u7b2c $i$ \u4e2a\u5b57\u7b26\u662f\u600e\u4e48\u6253\u51fa\u6765\u7684\u3002\n\n\u53ef\u4ee5\u5148\u6253\u51fa\u524d $i - 1$ \u4e2a\u5b57\u7b26\uff0c\u7136\u540e\u82b1\u8d39 $a$ \u7684\u4ee3\u4ef7\u6253\u51fa\u7b2c $i$ \u4e2a\u5b57\u7b26\u3002\n\n\u8bbe\u5b50\u4e32\u7684\u672b\u5c3e\u4e3a\u7b2c $j$ \u4e2a\u5b57\u7b26\uff0c\u5b50\u4e32\u7684\u957f\u5ea6\u4e3a $k$\uff0c\u5219\u53ef\u4ee5\u5148\u6253\u51fa\u524d $i - k$ \u4e2a\u5b57\u7b26\uff0c\u518d\u82b1\u8d39 $b$ \u7684\u4ee3\u4ef7\u6253\u51fa $k$ \u4e2a\u5b57\u7b26\u3002\u524d\u63d0\u662f $s_{i-k + 1, i}$ \u4e0e $s_{j - k + 1, j}$ \u76f8\u7b49\uff0c\u53ef\u4ee5\u7528 $\\rm hash$ \u5224\u65ad\u3002\n\n\u6700\u540e\u53d6\u4e0a\u8ff0\u4e24\u79cd\u60c5\u51b5\u7684\u6700\u5c0f\u503c\u5373\u53ef\u3002\n\n\u5982\u4f55\u4f18\u5316\uff1f\n\n\u4e0d\u96be\u53d1\u73b0\uff0c$f$ \u6570\u7ec4\u7684\u503c\u5176\u5b9e\u662f\u5355\u8c03\u4e0d\u51cf\u7684\u3002\n\n\u6362\u53e5\u8bdd\u8bf4\uff0c\u65b9\u7a0b\u4e2d $k$ \u7684\u503c\u8981\u5c3d\u53ef\u80fd\u5927\u3002\n\n\u800c $k$ \u7684\u6700\u5927\u503c\u5176\u5b9e\u662f $s_{1,i}$ \u4e0e $s_{1,j}$ \u7684 **\u6700\u957f\u516c\u5171\u540e\u7f00** \u957f\u5ea6\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u7701\u53bb\u5bf9 $k$ \u7684\u679a\u4e3e\uff0c\u540c\u6837\u7684\u72b6\u6001\uff0c\u65b0\u8f6c\u79fb\u65b9\u7a0b\u4e3a\n\n$$f_i = \\min \\left( f_{i - 1} + a, \\min \\{f_{\\max\\left(i - LPS_{i,j}, j\\right)} \\} + b \\right)$$\n\n\u5176\u4e2d $LPS_{i,j}$ \u8868\u793a $s_{1, i}$ \u4e0e $s_{1,j}$ \u7684\u6700\u957f\u516c\u5171\u540e\u7f00\u957f\u5ea6\u3002\u4e4b\u6240\u4ee5\u8981\u4e0e $j$ \u53d6 $\\max$\uff0c\u662f\u56e0\u4e3a\u5df2\u7ecf\u5047\u8bbe\u5b50\u4e32\u672b\u5c3e\u4e3a\u7b2c $j$ \u4e2a\u5b57\u7b26\uff0c$i - LPS_{i,j}$ \u7684\u503c\u80af\u5b9a\u4e0d\u80fd\u6bd4 $j$ \u5c0f\uff0c\u5426\u5219\u5c31\u7b49\u4e8e\u53d6\u4e86 \u8fd8\u6ca1\u6253\u51fa\u6765\u7684\u5b57\u7b26\u4e32 \u7684\u5b50\u4e32\u3002\n\n\u56fe\u793a\uff1a\n\n![EaEn0K.png](https://s2.ax1x.com/2019/05/04/EaEn0K.png)\n\n$\\rm LPS$ \u53ef\u4ee5\u7528 $O(n^2)$ **DP** \u9884\u5904\u7406\uff0c\u8003\u8651\u7b2c $s_i$ \u548c $s_j$ \u662f\u5426\u76f8\u7b49\u5373\u53ef\u3002\n\n![EaQnB9.png](https://s2.ax1x.com/2019/05/04/EaQnB9.png)\n\n\u5f53\u7136\u8fd9\u9053\u9898\u4e5f\u53ef\u4ee5\u7528 $\\rm SA$ \u7ef4\u62a4 **DP**\uff0c\u53ea\u4e0d\u8fc7\u5199\u8d77\u6765\u9ebb\u70e6\u4e00\u70b9\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^2)$ \u3002\n\n## Code\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\n\ntemplate <class T>\ninline void read(T &x) {\n    x = 0;\n    char c = getchar();\n    bool f = 0;\n    for (; !isdigit(c); c = getchar()) f ^= c == '-';\n    for (; isdigit(c); c = getchar()) x = x * 10 + (c ^ 48);\n    x = f ? -x : x;\n}\n\ntemplate <class T>\ninline void write(T x) {\n    if (x < 0) {\n        putchar('-');\n        x = -x;\n    }\n    T y = 1;\n    int len = 1;\n    for (; y <= x / 10; y *= 10) ++len;\n    for (; len; --len, x %= y, y /= 10) putchar(x / y + 48);\n}\n\nconst int MAXN = 5e3;\nint n, a, b, f[MAXN + 5], lps[MAXN + 5][MAXN + 5];\nchar s[MAXN + 5];\n\nint main() {\n    read(n), read(a), read(b);\n    scanf(\"%s\", s + 1);\n    for (int i = 1; i <= n; ++i)\n        for (int j = 1; j <= i; ++j)\n            lps[i][j] = s[i] == s[j] ? lps[i - 1][j - 1] + 1 : 0;//\u9884\u5904\u7406\u6700\u957f\u516c\u5171\u540e\u7f00\n    memset(f, 0x3f, sizeof (f));\n    f[0] = 0;//\u521d\u59cb\u72b6\u6001\uff1a\u4e0d\u6253\u5b57\u82b1\u8d39\u7684\u4ee3\u4ef7\u4e3a 0 \n    for (int i = 1; i <= n; ++i) {\n        f[i] = f[i - 1] + a;\n        for (int j = 1; j < i; ++j)\n            f[i] = min(f[i], f[max(i - lps[i][j], j)] + b);//\u8f6c\u79fb \n    }\n    write(f[n]);\n    putchar('\\n');\n    return 0;\n}\n```\n\n",
        "postTime": 1556938245,
        "uid": 32139,
        "name": "Heartlessly",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1120C \u3010Compress String\u3011"
    },
    {
        "content": "\n## \u9898\u89e3\u9875\u9762\u7684 $\\LaTeX{}$ \u6709\u9505\uff0c\u8bf7\u5230[\u6211\u7684blog\u4e2d\u9605\u8bfb](https://www.luogu.com.cn/blog/1445353309froggy/solution-cf1120c)\uff01\n\n---\n\n\u4f17\u6240\u5468\u77e5\uff0c$\\mathrm{SAM}$ \u662f\u5728\u7ebf\u7b97\u6cd5\u3002\n\n\u6240\u4ee5\u8fd9\u9053\u9898\u4e3a\u4ec0\u4e48\u4e0d\u80fd\u7528 $\\mathrm{SAM}$ \u66b4\u641e\u5462\uff1f\n\n---\n\n\u9996\u5148\u5f88\u597d\u60f3\u5230\u4e00\u4e2a $\\mathcal{O}(n^3)$ \u7684 $\\mathrm{dp}$\u3002\n\n\u8bb0 $dp_i$ \u4e3a\u5199\u5b8c $1\\sim i$ \u7684\u5b57\u6bcd\u540e\u7684\u6700\u5c0f\u82b1\u8d39\uff0c\u663e\u7136\u7b54\u6848\u662f $dp_n$\u3002\n\n\u7136\u540e\u6709\u5982\u4e0b\u8f6c\u79fb\uff1a\n\n$$dp_i=\\min\n\\begin{cases}\ndp_{i-1}+a \\\\\ndp_j+b \\quad (1\\leq j\\leq i-1,S_{j+1\\cdots i}\\text{\u662f}S_{1\\cdots j}\\text{\u7684\u5b50\u4e32})\n\\end{cases}\n$$\n\n\u5224\u65ad\u4e00\u4e2a\u4e32\u662f\u5426\u662f\u53e6\u4e00\u4e2a\u4e32\u7684\u5b50\u4e32\u663e\u7136\u53ef\u4ee5\u7528 $\\mathrm{kmp}$ \u7b97\u6cd5\u4f18\u5316\u5230 $\\mathcal{O}(n)$ \uff0c\u4f46\u65e0\u6cd5\u6ee1\u8db3\u6211\u4eec\u7684\u8981\u6c42\u3002\n\n---\n\n\u8003\u8651\u628a\u4e0b\u9762\u90a3\u4e2a\u8f6c\u79fb\u4f18\u5316\u5230 $\\mathcal{O}(1)$\uff0c\u8fd9\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u6362\u4e2a\u601d\u8def\uff0c\u7528 $dp_j$ \u6765\u66f4\u65b0 $dp_i$ \u5373**\u7b2c\u4e8c\u79cd\u8f6c\u79fb\u662f\u7528\u5f53\u524d\u72b6\u6001\u4ece\u524d\u5f80\u540e\u66f4\u65b0\u7684**\u3002\n\n\u5b66\u8fc7 $\\mathrm{SAM}$ \u5e94\u8be5\u90fd\u77e5\u9053\uff1a\n\n>\u5982\u679c\u4e00\u4e2a\u4e32 $T$ \u662f\u4e32 $S$ \u7684\u5b50\u4e32\uff0c\u90a3\u4e48\u4e32 $S$ \u7684 $\\mathrm{SAM}$ \u4e0a\u4e00\u5b9a\u5b58\u5728\u4e00\u6761 $T$ \u5bf9\u5e94\u7684\u4ece\u6839\u51fa\u53d1\u7684\u8def\u5f84\u3002\n\n\u5047\u8bbe\u5f53\u524d\u66f4\u65b0\u5b8c\u6bd5\u7684\u4f4d\u7f6e\u662f $i$\uff0c\u90a3\u4e48\u5c31\u628a $S_i$ \u52a0\u5230 $\\mathrm{SAM}$ \u91cc\u9762\uff0c\u7136\u540e\u4ece $i+1$ \u5f00\u59cb\uff0c\u5728 $\\mathrm{SAM}$ \u76f4\u63a5\u8dd1\uff0c\u76f4\u5230\u4e0d\u5b58\u5728\u8fb9\u4e3a\u6b62\uff0c\u5728\u6b64\u4e4b\u524d\u7684\u4f4d\u7f6e\u7684 $\\mathrm{dp}$ \u503c\u90fd\u662f\u9700\u8981\u66f4\u65b0\u7684\u3002\n\n---\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n^2)$\n\n\u5176\u5b9e\u6b64\u9898\u7528 $\\mathrm{SAM}$ \u662f\u53ef\u4ee5\u505a\u5230 $\\mathcal{O}(n)$ \u7684\uff0c~~\u7136\u9e45\u6211\u592a\u83dc\u4e86\u4e0d\u4f1a~~\u3002\n\n---\n\n***code:***\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\n#define N 5050\ninline int read(){\n    int x=0,f=1;\n    char c=getchar();\n    while(c<'0'||c>'9'){\n        if(c=='-')f=-1;\n        c=getchar();\n    }\n    while(c>='0'&&c<='9'){\n        x=(x<<3)+(x<<1)+c-'0';\n        c=getchar();\n    }\n    return x*f;\n}\nint n,a,b;\nint tot,las,dp[N];\nchar s[N];\nstruct SAM{\n\tint ch[26];\n\tint fa,len;\n}t[N<<1];\nvoid Insert(int c){       //\u5efaSAM\n\tint u=++tot;\n\tt[u].len=t[las].len+1;\n\tint p=las;\n\twhile(p&&!t[p].ch[c]){\n\t\tt[p].ch[c]=u;\n\t\tp=t[p].fa;\n\t}\n\tif(!p){\n\t\tt[u].fa=1;\n\t} \n\telse{\n\t\tint q=t[p].ch[c];\n\t\tif(t[q].len==t[p].len+1){\n\t\t\tt[u].fa=q;\n\t\t}\n\t\telse{\n\t\t\tint clone=++tot;\n\t\t\tt[clone]=t[q];\n\t\t\tt[clone].len=t[p].len+1;\n\t\t\twhile(p&&t[p].ch[c]==q){\n\t\t\t\tt[p].ch[c]=clone;\n\t\t\t\tp=t[p].fa;\n\t\t\t}\n\t\t\tt[u].fa=t[q].fa=clone;\n\t\t}\n\t}\n\tlas=u;\n}\nint main(){\n\tn=read(),a=read(),b=read();\n\tmemset(dp,0x3f,sizeof(dp));\n\tscanf(\"%s\",s+1);\n\ttot=las=1;\n\tdp[0]=0;\n\tfor(int i=1;i<=n;++i){\n\t\tInsert(s[i]-'a');\n\t\tdp[i]=min(dp[i],dp[i-1]+a);   //\u7b2c\u4e00\u79cd\u8f6c\u79fb\n\t\tint u=1;\n\t\tfor(int j=i+1;j<=n;++j){     //\u4ece\u524d\u5f80\u540e\u5728SAM\u4e0a\u8dd1\n\t\t\tint c=s[j]-'a';\n\t\t\tif(t[u].ch[c]){\n\t\t\t\tdp[j]=min(dp[j],dp[i]+b);  //\u5b58\u5728\u8fb9\u5c31\u66f4\u65b0\n\t\t\t\tu=t[u].ch[c];\n\t\t\t}\n\t\t\telse break;             //\u5426\u5219\u4e0d\u5b58\u5728\u5230Sj\u7684\u8fb9\u5c31\u8df3\u51fa\u5faa\u73af\n\t\t}\n\t}\n\tprintf(\"%d\\n\",dp[n]);\n\treturn \u5471;\n}\n\n```\n[*Froggy's blog*](https://www.luogu.org/blog/1445353309froggy/)\n\n#### \u5471!!\n",
        "postTime": 1585317460,
        "uid": 100285,
        "name": "Froggy",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1120C \u3010Compress String\u3011"
    },
    {
        "content": "\u6b64\u9898\u4e3a2015 ACM/ICPC Asia Regional Shanghai Online\u7684\u5b57\u7b26\u4e32\u9898Typewriter\u7684\u4e8c\u6b21\u524a\u5f31\u7248  \u539f\u9898\u6bcf\u6b21\u8ffd\u52a0\u7684\u5b57\u6bcd\u5e26\u6743\uff0c\u6570\u636e\u91cf120w  \n\n\u4e00\u6b21\u524a\u5f31\u7248\u4e3a2019\u676d\u7535\u591a\u6821\u7b2c\u4e00\u573a\u7684Typewriter\uff0c\u9898\u610f\u548c\u6b64\u9898\u76f8\u540c \u9898\u76ee\u6570\u636e\u4e3a500w  \n\n\u6628\u5929\u6253\u5b8c\u5c31\u76f4\u63a5\u8fc7\u6765\u653e\u4e2aO(n)\u7684AC\u4ee3\u7801\u5427   \u6211\u7684\u5927\u81f4\u601d\u8def\u662f\u79bb\u7ebf\u9884\u5904\u7406firstpos \u7136\u540e\u5229\u7528\u533a\u95f4\u5355\u8c03\u6027+\u5355\u8c03\u961f\u5217\u4f18\u5316\u8f6c\u79fb\u5373\u53ef\u505a\u5230O\uff08n\uff09 \n\n\u5177\u4f53\u7ec6\u8282\u770b\u4ee3\u7801\uff0c\u4ee3\u7801\u5e94\u8be5\u8fd8\u662f\u5f88\u5bb9\u6613\u770b\u660e\u767d\u7684  \uff08\u539f\u9898std\u662f\u5728\u7ebf\u505a\u6cd5\u770b\u4e0d\u61c2emmmmmm...~~**\u6b3a\u8d1f\u79bb\u7ebf\u515a**~~\uff09\n\n\n\u4ee3\u7801\u4e2dextend\u4e3asam\u7684\u63d2\u5165\n\nO\uff08n\uff09\u79bb\u7ebfAC\u4e3b\u4ee3\u7801\n\n```cpp\nint32_t main() {\n    ios::sync_with_stdio(false);\n    cin.tie(NULL);\n    cout.tie(NULL);\n    string s;\n    long long n,a, b;\n    cin >>n>> a >> b;\n    while (cin >> s)\n    {\n        dp.fill(0);\n        deque<pair<long long, long long> > que;\n        int kk = s.size();\n        last = 1, sam = 1;\n        firstpos.fill(0);\n        memset(trans, 0, sizeof(trans));\n        par.fill(0), len.fill(0);\n        for (auto &p : s)\n            extend(p - 'a');\n        dp[0] = a;\n        que.push_back({ 0,a });\n        int ff = 1, L = 0;\n        ff = trans[ff][s[0] - 'a'];\n        for (int i = 1; i < s.size(); ++i)\n        {\n\n\n            ff = trans[ff][s[i] - 'a'];\n            while ((len[par[ff]] < i - L || firstpos[par[ff]] > L))\n            {\n                L++;\n                if (i - L < len[par[ff]])\n                    ff = par[ff];\n            }\n\n\n            while (!que.empty() && que.front().first < L)\n                que.pop_front();\n            if (!que.empty())\n                dp[i] = min(dp[i - 1] + a, que.front().second + b);\n            else\n                dp[i] = dp[i - 1] + a;\n            while (!que.empty() && que.back().second >= dp[i])\n                que.pop_back();\n            que.push_back({ i,dp[i] });\n        }\n\n\n        cout << dp[kk - 1] << '\\n';\n    }\n    return 0;\n}\n```\n",
        "postTime": 1563866060,
        "uid": 154957,
        "name": "qiyue7",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1120C \u3010Compress String\u3011"
    },
    {
        "content": "\u9884\u77e5\u8bc6\uff1a\u540e\u7f00\u6570\u7ec4\u3002\u4e0d\u4f1a\u7684\u8bf7\u5de6\u8f6c[\u8fd9\u91cc](https://www.luogu.org/problemnew/show/P3809)\n\n\u8003\u8651DP\u3002\n\n\u6211\u4eec\u8bbe$f_i$\u8868\u793a\u5c06$s_{1,i}$\u5212\u5206\u7684\u6700\u5c0f\u82b1\u8d39\uff0c\u5219\n\n$$f_{i+1}=min(f_{i+1},f_i+a)$$\n\n$$f_{k}=min(f_{k},f_i+b)$$\n\n\u5176\u4e2d$k$\u6ee1\u8db3$s_{i+1,k}$\u662f\u524d\u9762\u4e00\u90e8\u5206\u7684\u5b50\u4e32\u3002\n\n\u7b2c\u4e00\u4e2a\u65b9\u7a0b\u5f88\u597d\u5b9e\u73b0\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u4e2a\u65b9\u7a0b\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u4e00\u4e0b\u5b50\u4e32\u7684\u8d77\u59cb\u4f4d\u7f6e\uff0c\u7136\u540e\u7528SA\u6c42\u51fa\u6700\u5927\u7684$k$\uff08\u53ef\u4ee5\u8bc1\u660e\u6bcf\u6b21\u53d6\u6700\u5927\u7684$k$\u4e00\u5b9a\u6700\u4f18\uff09\n\n\u4e22\u4e00\u5f20\u56fe\uff1a\n\n![](https://cdn.luogu.com.cn/upload/pic/55327.png)\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n^2)$\u3002\u4e5f\u8bb8\u6709\u66f4\u4f18\u79c0\u7684\u505a\u6cd5\u3002\n\n\u4ee3\u7801\u4e5f\u5c31\u6bd4\u8f83\u7b80\u5355\u4e86\uff1a\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\nusing namespace std;\nchar s[5005];\nint n,a,b,x[5005],y[5005],c[5005],sa[5005],rnk[5005],height[5005];\nint minl[15][5005],lg2[5005];\nint main()\n{\n\tscanf(\"%d%d%d\",&n,&a,&b);\n\tscanf(\"%s\",s+1);\n\tint m=128;\n\tfor(int i=1;i<=n;i++)c[x[i]=s[i]]++;\n\tfor(int i=1;i<=m;i++)c[i]+=c[i-1];\n\tfor(int i=n;i>=1;i--)sa[c[x[i]]--]=i;\n\tm=0;\n\tfor(int k=1;m<n;k<<=1)\n\t{\n\t\tm=0;\n\t\tfor(int i=n-k+1;i<=n;i++)y[++m]=i;\n\t\tfor(int i=1;i<=n;i++)\n\t\t  if(sa[i]>k)y[++m]=sa[i]-k;\n\t\tfor(int i=1;i<=m;i++)c[i]=0;\n\t\tfor(int i=1;i<=n;i++)c[x[i]]++;\n\t\tfor(int i=1;i<=m;i++)c[i]+=c[i-1];\n\t\tfor(int i=n;i>=1;i--)sa[c[x[y[i]]]--]=y[i],y[i]=x[i];\n\t\tx[sa[1]]=m=1;\n\t\tfor(int i=2;i<=n;i++)\n\t\t{\n\t\t\tif(y[sa[i]]==y[sa[i-1]]&&y[sa[i]+k]==y[sa[i-1]+k])x[sa[i]]=m;\n\t\t\telse x[sa[i]]=++m;\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)rnk[sa[i]]=i;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\theight[rnk[i]]=height[rnk[i-1]]-1;\n\t\tif(height[rnk[i]]<0)height[rnk[i]]=0;\n\t\twhile(s[i+height[rnk[i]]]==s[sa[rnk[i]-1]+height[rnk[i]]])++height[rnk[i]];\n\t}//\u4ee5\u4e0a\u662f\u540e\u7f00\u6570\u7ec4\u677f\u5b50\n\tfor(int i=2;i<=n;i++)\n\t  lg2[i]=lg2[i>>1]+1;\n\tfor(int i=1;i<=n;i++)\n\t  minl[0][i]=height[i];\n\tfor(int i=1;i<=lg2[n];i++)\n\t  for(int j=1;j<=n;j++)\n\t    minl[i][j]=min(minl[i-1][j],minl[i-1][j+(1<<(i-1))]);\n\tmemset(x,0x3f,sizeof(x));//\u8fd9\u91cc\u7684x\u5c31\u662fDP\u6570\u7ec4f\n\tx[0]=0;\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tx[i+1]=min(x[i+1],x[i]+a);\n\t\tint maxl=0;\n\t\tfor(int j=1;j<=i;j++)\n\t\t{\n\t\t\tint x=rnk[j],y=rnk[i+1];\n\t\t\tif(x>y)swap(x,y);\n\t\t\tint d=lg2[y-x];\n\t\t\tmaxl=max(maxl,min(min(minl[d][x+1],minl[d][y-(1<<d)+1]),i+1-j));\n\t\t}\n\t\tx[i+maxl]=min(x[i+maxl],x[i]+b);\n\t}\n\tprintf(\"%d\\n\",x[n]);\n\treturn 0;\n}\n```",
        "postTime": 1553859330,
        "uid": 54214,
        "name": "wucstdio",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1120C \u3010Compress String\u3011"
    }
]
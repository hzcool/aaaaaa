[
    {
        "content": "\u770b\u5230\u79ef\u5f0f\uff0c\u6211\u4eec\u81ea\u7136\u80fd\u60f3\u5230\u7528 dp \u6765\u89e3\u51b3\u6b64\u7c7b\u95ee\u9898\u3002\n\n\u8bbe $f_{i,j}$ \u8868\u793a\u524d $b_{1,2,\\cdots,i}$ \u7684\u503c\u5df2\u7ecf\u786e\u5b9a\uff0c\u540e\u9762\u7684\u6570\u7684\u9650\u5236\u4e3a $\\prod\\limits_{p=i+1}^n b_p\\geq j$ \u7684\u524d\u63d0\u4e0b\uff0c $\\prod\\limits_{p=1}^i\\lfloor\\dfrac{a_p}{b_p}\\rfloor \\times \\dfrac{1}{a_p}$ \u7684\u6700\u5927\u503c\u3002\n\n\u81ea\u7136\u53ef\u4ee5\u901a\u8fc7\u679a\u4e3e $b_i$ \u7684\u503c\u6765\u8f6c\u79fb\uff1a\n\n\u4ee4 $b_i=x$ \uff0c\u5219\u6709\u8f6c\u79fb\uff1a $f_{i,\\lceil\\frac{j}{x}\\rceil}\\leftarrow f_{i-1,j}\\times\\lfloor\\dfrac{a_p}{x}\\rfloor \\times \\dfrac{1}{a_p}$\n\n\u521d\u59cb\u72b6\u6001\u4e3a\uff1a $f_{0,k}=1$\uff0c\u7b54\u6848\u4e3a\uff1a $f_{n,1}\\times k$\u3002\n\n\u76f4\u63a5\u8f6c\u79fb\u662f $O(nk)$ \u7684\uff0c\u8003\u8651\u4f18\u5316\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u7b2c\u4e8c\u7ef4\u7684\u503c\u662f\u7531 $k$ \u4e0d\u65ad\u9664\u4ee5\u6574\u6570\u540e\u5411\u4e0a\u53d6\u6574\u5f97\u5230\u7684\u3002\n\n\u5411\u4e0a\u53d6\u6574\u6709\u4e00\u4e2a\u6027\u8d28\uff1a\n \n$\\lceil\\dfrac{k}{a}\\rceil=\\lfloor\\dfrac{k-1}{a}\\rfloor+1$\n\n\u800c\u4e14\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u5d4c\u5957\uff1a\n\n$\\lceil\\dfrac{\\lceil\\frac{k}{a}\\rceil}{b}\\rceil=\\lfloor\\dfrac{\\lfloor\\frac{k-1}{a}\\rfloor+1-1}{b}\\rfloor+1=\\lfloor\\dfrac{\\lfloor\\frac{k-1}{a}\\rfloor}{b}\\rfloor+1=\\lfloor\\dfrac{k-1}{ab}\\rfloor+1$\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u628a\u5411\u4e0a\u53d6\u6574\u8f6c\u5316\u4e3a\u5411\u4e0b\u53d6\u6574\u4e86\uff0c\u7528\u7c7b\u4f3c\u675c\u6559\u7b5b\u7684\u8f6c\u79fb\u65b9\u5f0f\u5c31\u53ef\u4ee5\u5f97\u5230 $O(nk^{0.75})$ \u7684\u505a\u6cd5\u3002\n\n\u8b66\u949f\u957f\u9e23\uff1a\u9012\u5f52\u5199\u6cd5\u6709\u53ef\u80fd\u88ab\u5361\u5e38\uff0c\u6211\u8003\u573a\u4e0a\u5c31\u88ab\u5361\u4e86\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int MAXN=105,N=7005;\nint n,k,a[MAXN],v[N],m,id[10000001];\nbool vis[MAXN][N];\ndouble f[MAXN][N];\nint main() {\n    scanf(\"%d%d\",&n,&k);\n    for(int i=1; i<=n; ++i)\n        scanf(\"%d\",&a[i]);\n    if(k==1) {//\u8bb0\u5f97\u7279\u5224k=1\n        double ans=1.0;\n        printf(\"%.20lf\\n\",ans);\n        return 0;\n    }\n    for(int l=1,r; l<k; l=r+1) {\n        r=(k-1)/((k-1)/l);\n        v[++m]=(k-1)/l;\n        id[v[m]]=m;\n    }\n    v[++m]=0,id[0]=m;//\u4e0d\u8981\u5fd8\u8bb0\u8fd8\u67091\n    f[0][1]=1;\n    for(int i=1; i<=n; ++i)\n        for(int j=1; j<=m; ++j)\n            if(f[i-1][j]) {\n                for(int l=1,r; l<=v[j]; l=r+1) {\n                    r=v[j]/(v[j]/l);\n                    f[i][id[v[j]/r]]=max(f[i][id[v[j]/r]],(a[i]/l)/(double)a[i]*f[i-1][j]);\n                }\n                f[i][m]=max(f[i][m],(a[i]/(v[j]+1))/(double)a[i]*f[i-1][j]);\n\t\t\t}\n    printf(\"%.15lf\\n\",f[n][m]*k);\n    return 0;\n}\n```",
        "postTime": 1678860941,
        "uid": 279646,
        "name": "mod998244353",
        "ccfLevel": 7,
        "title": "CF1801F \u9898\u89e3"
    },
    {
        "content": "\u8003\u8651\u5230\u6700\u591a\u53ea\u4f1a\u6709\u4e00\u4e2a $b_i \\ge \\sqrt{k}$\u3002\n\n+ \u6ca1\u6709\u4efb\u4f55\u4e00\u4e2a $b_i \\geq \\sqrt{k}$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u7c7b\u4f3c meet-in-the-middle \u7684\u505a\u6cd5\u3002\n\n\u4ee4 $f_{i,j}$ \u8868\u793a\u8003\u8651\u4e86\u524d $i$ \u4e2a\u6570\uff0c\u6b64\u65f6\u4e58\u79ef\u4e3a $j$\uff0c$\\lfloor\\frac{a_1}{b_1}\\rfloor\\lfloor\\frac{a_2}{b_2}\\rfloor\\dots\\lfloor\\frac{a_i}{b_i}\\rfloor\\frac{1}{a_1a_2\\dots a_i}$ \u7684\u6700\u5927\u503c\uff0c$g_{i,j}$ \u7684\u5b9a\u4e49\u7c7b\u4f3c\uff0c\u4e0d\u8fc7\u662f\u4ece $n$ \u5f00\u59cb\u5012\u7740\u7684\u3002dp \u7684\u65f6\u5019\u679a\u4e3e $i$\uff0c\u679a\u4e3e $j$\uff0c\u518d\u679a\u4e3e\u6ee1\u8db3 $j\\times k \\le$ \u7b2c\u4e8c\u7ef4\u5927\u5c0f\u7684\u6240\u6709 $k$ \u5373\u53ef\u3002\n\n\u5219\u6211\u4eec\u8fd9\u79cd\u60c5\u51b5\u4e0b\u7684\u6700\u597d\u7b54\u6848\u5c31\u662f\u679a\u4e3e\u4e00\u4e2a\u4e2d\u95f4\u65ad\u70b9 $i$\uff0c\u548c $i$ \u5de6\u8fb9\u7684\u90e8\u5206\u7684\u4e58\u79ef $j$\uff0c$f_{i,j}\\times g_{i+1,\\lceil\\frac{k}{j}\\rceil}$ \u7684\u6700\u5c0f\u503c\u4e86\u3002\n\n\u6b64\u65f6\u6211\u4eec\u9700\u8981\u8bc1\u660e\uff0c\u5728\u6240\u6709\u9009\u62e9\u7684 $b_i$ \u90fd $\\le \\sqrt{k}$ \u7684\u60c5\u51b5\u4e0b\uff0c$f$ \u548c $g$ \u7684\u7b2c\u4e8c\u7ef4\u90fd\u53ea\u8981\u5f00\u5230 $k^{\\frac{3}{4}}$ \u5373\u53ef\u3002\n\n\u4e0d\u59a8\u8bbe\u4e00\u4e2a $x$\uff0c\u521d\u59cb\u4e3a $b_i$ \u6700\u5927\u7684\u4f4d\u7f6e\uff0c\u4ee4 $p$ \u4e3a $x$ \u5de6\u8fb9\u6240\u6709 $b_i$ \u7684\u4e58\u79ef\uff0c$q$ \u4e3a $x$ \u53f3\u8fb9\u6240\u6709 $b_i$ \u7684\u4e58\u79ef\u3002\n\n\u6211\u4eec\u8d2a\u5fc3\u7684\u8003\u8651\uff0c\u5982\u679c $b_x^2\\times p <q$\uff0c\u5c31\u8ba9 $x+1$\uff1b\u5982\u679c $b_x^2\\times q < p$\uff0c\u5c31\u8ba9 $x-1$\u3002\u5728\u79fb\u52a8 $x$ \u7684\u540c\u65f6\u7ef4\u62a4 $p$ \u548c $q$ \u7684\u503c\u3002\n\n\u6b64\u65f6\u7b2c\u4e8c\u7ef4\u5c31\u9700\u8981\u5f00\u5230\u4e00\u4e2a $\\min(p,q)\\times b_x$ \u7684\u5927\u5c0f\u3002\u56e0\u4e3a $p \\times q \\times b_x$ \u662f $O(k)$ \u7ea7\u522b\u7684\uff0c\u6240\u4ee5 $\\min(p,q)\\le \\sqrt{\\frac{k}{b_x}}$\uff0c\u6545\u7b2c\u4e8c\u7ef4\u53ea\u9700\u8981\u5f00\u5230 $\\sqrt{\\frac{k}{b_x}}\\times b_x=\\sqrt{k\\times b_x}$ \u5373\u53ef\u3002\u56e0\u4e3a $b_x\\le \\sqrt{k}$\uff0c\u6240\u4ee5 $\\sqrt{\\frac{k}{b_x}}\\times b_x \\le k^{\\frac{3}{4}}$\uff0c\u5f97\u8bc1\u3002\n\n\u7efc\u4e0a\uff0c\u8be5\u90e8\u5206\u590d\u6742\u5ea6\u4e3a $O(n\\times k^{\\frac{3}{4}}\\times\\log(k^{\\frac{3}{4}}))$\u3002\n\n+ \u5b58\u5728\u6070\u597d\u4e00\u4e2a $b_i \\geq \\sqrt{k}$\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u679a\u4e3e\u8fd9\u4e2a $i$\uff0c\u53d1\u73b0 $i$ \u5de6\u4fa7\u548c\u53f3\u4fa7 $b_j$ \u7684\u4e58\u79ef\u5747 $\\le \\sqrt{k}$\u3002\u4ee4 $h_j$ \u8868\u793a\u73b0\u6682\u65f6\u4e0d\u9009 $b_i$\uff0c\u5176\u4ed6\u6240\u6709\u4f4d\u7f6e\u90fd\u9009\u4e4b\u540e\u4e58\u79ef\u4e3a $j$ \u65f6\u7684\u6700\u5927\u503c\u3002\u8fd9\u4e2a\u53ef\u4ee5\u5229\u7528 $f_{i-1}$ \u548c $g_{i+1}$ \u5feb\u901f\u5904\u7406\u3002\n\n\u7136\u540e\u6211\u4eec\u679a\u4e3e\u9664\u4e86 $b_i$ \u7684\u6240\u6709 $b_j$ \u7684\u4e58\u79ef $t$\uff0c\u63a8\u51fa $b_i$ \u7684\u503c\u6700\u5c0f\u662f\u591a\u5c11\uff0c\u8ba1\u7b97\u51fa $\\lfloor\\frac{a_i}{b_i}\\rfloor\\frac{1}{a_i}$ \u5373\u7b2c $i$ \u4e2a\u6570\u7684\u8d21\u732e\uff0c\u4e58\u4e0a $h_t$ \u5373\u53ef\u3002\n\n\u8be5\u90e8\u5206\u590d\u6742\u5ea6\u4e3a $O(n\\sqrt{k})$\u3002\n\n\u7efc\u4e0a\uff0c\u603b\u590d\u6742\u5ea6\u4e3a $O(n\\times k^{\\frac{3}{4}}\\times\\log(k^{\\frac{3}{4}}))$\uff0c\u53ef\u4ee5~~\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u4f46\u53ea\u8dd1\u4e861.5s~~\u901a\u8fc7\u6b64\u9898\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int B=177830;\nconst int B2=6600;\nint n,w,a[103];\ndouble f[103][B+3],g[103][B+3],ans;\nvector<int>v;\ndouble h[B2+3];\nint main(){\n\tcin>>n>>w;\n\tfor(int i=1;i<=n;i++)\n\t\tcin>>a[i];\n\tf[0][1]=1;\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=B;j++)\n\t\t\tfor(int k=1;k<=B/j;k++)\n\t\t\t\tf[i][j*k]=max(f[i][j*k],f[i-1][j]*(1.0*(a[i]/k)/a[i]));\n\t\tfor(int j=B;j>0;j--)\n\t\t\tf[i][j]=max(f[i][j],f[i][j+1]); \n\t}\n\tg[n+1][1]=1;\n\tfor(int i=n;i;i--){\n\t\tfor(int j=1;j<=B;j++)\n\t\t\tfor(int k=1;j*k<=B;k++)\n\t\t\t\tg[i][j*k]=max(g[i][j*k],g[i+1][j]*(1.0*(a[i]/k))/a[i]);\n\t\tfor(int j=B;j>0;j--)\n\t\t\tg[i][j]=max(g[i][j],g[i][j+1]); \n\t}\n\tfor(int i=0;i<=n;++i)for(int j=1;j<=B;++j) \n\t    if((w+j-1)/j<=B)ans=max(ans,f[i][j]*g[i+1][(w+j-1)/j]);\n\tfor(int i=1;i<=n;++i){\n\t\tif(1){\n\t\t\tfor(int j=1;j<=B2;++j)h[j]=0;\n\t\t\tfor(int j=1;j<=B2;++j)\n\t\t\t\tfor(int k=1;k*j<=B2;++k)\n\t\t\t\t\th[j*k]=max(h[j*k],f[i-1][j]*g[i+1][k]);\n\t\t\tfor(int j=B2;j;--j)h[j]=max(h[j],h[j+1]);\n\t\t\tfor(int j=1;j<=B2;++j){\n\t\t\t\tint ee=(w+j-1)/j;ee=max(ee,1);\n\t\t\t\tif(ee>a[i])continue;\n\t\t\t\tint e2=a[i]/ee;\n\t\t\t\tans=max(ans,1.0*e2/(1.0*a[i])*h[j]);\n\t\t\t}\n\t\t}\n\t}\n\tcout<<fixed<<setprecision(15)<<ans*w<<'\\n';\n}\n```",
        "postTime": 1678450412,
        "uid": 226760,
        "name": "RedLycoris",
        "ccfLevel": 7,
        "title": "\u4f9d\u6258\u7684\u505a\u6cd5\uff0c\u4f46\u662f\u5c45\u7136\u80fd\u8fc7"
    }
]
[
    {
        "content": "# C. Pollywog\n\n### \u9898\u76ee\u63cf\u8ff0\n\n\u3000\u3000\u539f\u9898\u9898\u76ee\u94fe\u63a5\u3002\u9898\u76ee\u5927\u610f\u4e3a\uff1a\u6709$x$\u53ea\u874c\u86aa\uff0c\u5728$n$\u4e2a\u77f3\u5934\u4e2d\u7684\u6700\u5de6\u7aef\u7684$x$\u4e2a\u77f3\u5934\u4e0a\uff0c\u8fd9$n$\u4e2a\u77f3\u5934\u662f\u5728\u540c\u4e00\u76f4\u7ebf\u4e0a\u7684\u3002\u6bcf\u4e00\u6b21\u53ea\u80fd\u6700\u5de6\u8fb9\u7684\u4e00\u4e2a\u874c\u86aa\u8fdb\u884c\u8df3\u8dc3\uff0c\u5e76\u4e14\u53ea\u80fd\u8df3$1$\u81f3$k$\u6b65\uff0c\u8df3$i$\u6b65\u8981\u82b1\u8d39$c_i$\u7684\u4f53\u529b\u3002\u5728\u874c\u86aa\u8df3\u8dc3\u65f6\uff0c\u662f\u4e0d\u80fd\u8df3\u5230\u5df2\u6709\u874c\u86aa\u7684\u77f3\u5934\u4e0a\u3002\u5728\u8fd9$n$\u4e2a\u77f3\u5934\u91cc\u9762\u6709$q$\u4e2a\u77f3\u5934\u662f\u7279\u6b8a\u7684\u77f3\u5934\uff0c\u8df3\u4e0a\u8fd9$q$\u4e2a\u77f3\u5934\u4e2d\u7684\u7b2c$p$\u4e2a\u8981\u989d\u5916\u82b1\u8d39$w_p$\u7684\u4f53\u529b\u503c\u3002\u95ee\u5f53\u6240\u6709\u874c\u86aa\u8df3\u5230\u6700\u53f3\u8fb9\u7684$x$\u4e2a\u77f3\u5934\u65f6\u7684\u6700\u5c0f\u4f53\u529b\u503c\u3002\n\n### \u601d\u8def\n\n\u3000\u3000\u9996\u5148\uff0c\u6839\u636e\u9898\u610f\u6211\u4eec\u80fd\u77e5\u9053\u6240\u6709\u7684\u874c\u86aa\u90fd\u4e00\u5b9a\u5728\u8fde\u7eed\u7684$k$\u5757\u77f3\u5934\u4e0a\u3002\u73b0\u5728\u8fdb\u884c\u4e00\u4e2a\u5c0f\u5c0f\u7684\u8bc1\u660e\uff1a\u5047\u8bbe\u8fd9\u4e9b\u874c\u86aa\u4e0d\u5728\u8fde\u7eed\u7684$k$\u5757\u77f3\u5934\u4e0a\uff0c\u5219\u6700\u5de6\u8fb9\u7684\u874c\u86aa\u5728\u8df3\u8dc3\u65f6\u4e00\u5b9a\u4f1a\u8df3\u5728\u6700\u53f3\u8fb9\u7684\u874c\u86aa\u7684\u5de6\u8fb9\uff0c\u4e0d\u4f1a\u4f7f\u6700\u53f3\u7aef\u70b9\u5411\u53f3\u79fb\u52a8\uff0c\u4f46\u662f\u56e0\u4e3a\u6700\u5de6\u8fb9\u7684\u874c\u86aa\u8df3\u52a8\u4e86\uff0c\u6240\u4ee5\u6700\u5de6\u7aef\u70b9\u4f1a\u5411\u53f3\u79fb\u52a8\uff0c\u8fd9\u6837\u7684\u8bdd\uff0c\u533a\u95f4\u5c31\u4f1a\u7f29\u77ed\u3002\u77e5\u9053\u5f53\u6700\u5de6\u8fb9\u7684\u874c\u86aa\u548c\u6700\u53f3\u8fb9\u7684\u874c\u86aa\u7684\u8ddd\u79bb\u5c0f\u4e8e$k$\u65f6\uff0c\u624d\u80fd\u5728\u5411\u53f3\u8df3\u8dc3\u65f6\u5c06\u6700\u53f3\u7aef\u70b9\u5411\u53f3\u79fb\u52a8\uff0c\u53c8\u56e0\u4e3a\u5f00\u59cb\u7684\u65f6\u5019\u6240\u6709\u7684\u874c\u86aa\u90fd\u5728\u6700\u5de6\u8fb9\u7684$x$\u4e2a\u77f3\u5934\u4e0a\uff0c\u6240\u4ee5\u4e0d\u4f1a\u4f7f\u533a\u95f4\u5927\u4e8e$k$\u3002\n\n\u3000\u3000\u56e0\u6b64\u6211\u4eec\u5c31\u53ef\u4ee5\u5904\u7406\u51fa\u6765\u957f\u5ea6\u4e3a$k$\u7684\u6240\u6709\u7684\u60c5\u51b5\u4e4b\u95f4\u7684\u8f6c\u79fb\u3002\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u5355\u4f4d\u5143\u77e9\u9635\uff0c$num[i][j]$\u8868\u793a\u72b6\u6001\u4e3a$i$\u7684\u77f3\u5934\u8f6c\u79fb\u6210\u4e3a\u72b6\u6001\u4e3a$j$\u7684\u77f3\u5934\u7684\u82b1\u8d39\u3002\u4ec0\u4e48\u662f\u72b6\u6001\u4e3a$i$\u7684\u77f3\u5934\u5462\uff1f\uff1f\uff1f\u6211\u4eec\u5c06$i$\u8f6c\u6210\u4e8c\u8fdb\u5236\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a$01$\u4e32\uff0c\u5728\u8fd9\u4e2a$01$\u4e32\u4e2d\uff0c$0$\u8868\u793a\u8fd9\u4e2a\u77f3\u5934\u4e0a\u6ca1\u6709\u874c\u86aa\uff0c\u53cd\u4e4b$1$\u8868\u793a\u6709\u874c\u86aa\u3002\u56e0\u4e3a\u6211\u4eec\u4e00\u5171\u5c31\u53ea\u9700\u8981\u679a\u4e3e$k$\u5757\u77f3\u5934\uff0c\u5e76\u4e14\u53ea\u6709$x$\u53ea\u9752\u86d9\uff0c\u4e14$k,x \\le 8$\uff0c\u6240\u4ee5\u6700\u591a\u5c31\u53ea\u6709$C_8^4$\u79cd\u60c5\u51b5\uff0c\u5c06\u4e8c\u8fdb\u5236\u4e32\u79bb\u6563\u4e00\u4e0b\u5c31\u597d\u4e86\u3002\u8fd9\u5c31\u662f\u9884\u5904\u7406\u3002\n\n\u3000\u3000\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a\u8f6c\u79fb\u7684\u90bb\u63a5\u77e9\u9635\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u8fd9\u4e2a\u77e9\u9635\u6765\u8fdb\u884c\u77e9\u4e58\uff0c\u5148\u4e0d\u8003\u8651\u7279\u6b8a\u7684\u77f3\u5934\uff0c\u6240\u4ee5\u5c31\u8ba1\u7b97\u8fd9\u4e2a\u77e9\u9635\u7684$n-x$\u6b21\u5e42\u5c31\u53ef\u4ee5\uff0c$n-x$\u6b21\u5e42\u7684\u610f\u601d\u662f\uff0c\u6bcf\u4e00\u6b21\u90fd\u5c06\u5f53\u524d$k$\u5757\u77f3\u5934\u5411\u53f3\u8fdb\u884c\u79fb\u52a8\u4e00\u5757\u77f3\u5934\uff0c\u8fd9\u6837\u79fb\u52a8$n-x$\u6b21\u5c31\u662f\u7b54\u6848\uff0c\u4f46\u662f\u7279\u6b8a\u7684\u77f3\u5934\u8981\u66f4\u6539\u7b54\u6848\uff0c\u6240\u4ee5\u6211\u4eec\u5230\u8fbe\u4e00\u5757\u7279\u6b8a\u7684\u77f3\u5934\uff0c\u5c31\u505c\u4e0b\u6765\u66b4\u529b\u5c31\u53ef\u4ee5\u4e86\u3002\u6211\u4eec\u77e5\u9053\u4e00\u5757\u7279\u6b8a\u7684\u77f3\u5934\u53ea\u80fd\u5bf9$k$\u4e2a\u8f6c\u79fb\u5e26\u6765\u5f71\u54cd\u3002\u6240\u4ee5\u6211\u4eec\u66b4\u529b\u505c\u4e0b\u6765\u8f6c\u79fb\u662f\u53ef\u4ee5\u7684\uff0c\u65f6\u95f4\u590d\u6742\u7684\u662f$O(k^2 \\times q \\times C_k^x)$\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include <cstdio>\n#include <algorithm>\nusing namespace std;\n#define inf 1e18\n#define N 10\nint x,k,n,q,cnt;long long num[N];int bel[1<<10];\nstruct Square\n{\n\tlong long num[71][71];\n\tSquare()\n\t{for(int i=1;i<=70;i++) {for(int j=1;j<=70;j++) num[i][j]=inf;num[i][i]=0;}}\n\tSquare operator * (const Square &a) const\n\t{\n\t\tSquare tmp;\n\t\tfor(int i=1;i<=cnt;i++)\n\t\t\ttmp.num[i][i]=inf;\n\t\tfor(int i=1;i<=cnt;i++)\n\t\t\tfor(int j=1;j<=cnt;j++)\n\t\t\t\tfor(int k=1;k<=cnt;k++)\n\t\t\t\t\ttmp.num[i][j]=min(tmp.num[i][j],num[i][k]+a.num[k][j]);\n\t\treturn tmp;\n\t}\n\tSquare operator ^ (const int &x) \n\t{\n\t\tif(!x) return Square();\n\t\tSquare tmp,tmp1;int times=x;\n\t\tfor(int i=1;i<=cnt;i++)\n\t\t\tfor(int j=1;j<=cnt;j++) tmp1.num[i][j]=num[i][j];\n\t\twhile(times) {if(times&1) tmp=tmp*tmp1;times>>=1;tmp1=tmp1*tmp1;}\n\t\treturn tmp;\n\t}\n}one;\nstruct Stone\n{int place;long long val;}stone[30];\nbool calc(int tmp)\n{\n\tint many=0;\n\tfor(int i=1;i<=8;i++) if(tmp&(1<<(i-1))) many++;\n\treturn many==x;\n}\nbool cmp(const Stone &a,const Stone &b)\n{return a.place<b.place;}\nint main()\n{\n\tscanf(\"%d%d%d%d\",&x,&k,&n,&q);\n\tfor(int i=0;i<=(1<<k)-1;i++) if(calc(i)) bel[i]=++cnt;\n\tfor(int i=1;i<=k;i++) scanf(\"%lld\",&num[i]);\n\tfor(int i=1;i<=q;i++) scanf(\"%d%lld\",&stone[i].place,&stone[i].val);\n\tsort(stone+1,stone+q+1,cmp);\n\tfor(int i=1;i<=cnt;i++) one.num[i][i]=inf;\n\tfor(int i=1;i<=(1<<k)-1;i++)\n\t{\n\t\tif(!bel[i]) continue;\n\t\tif(i&1)\n\t\t{for(int j=1;j<=k;j++)\n\t\t\t{if(!((1<<j)&i)) one.num[bel[i]][bel[((1<<j)|i)>>1]]=num[j];}}\n\t\telse one.num[bel[i]][bel[i>>1]]=0;\n\t}\n\tint now=1;long long sum=0;Square ans;\n\tfor(int i=1;i<=q;i++)\n\t{\n\t\tif(stone[i].place>n-x) {sum+=stone[i].val;continue;}\n\t\tans=ans*(one^(stone[i].place-now)),now=stone[i].place;\n\t\tfor(int j=1;j<=(1<<k)-1;j+=2)\n\t\t\tif(bel[j])\n\t\t\t\tfor(int k=1;k<=cnt;k++)\n\t\t\t\t\tans.num[k][bel[j]]+=stone[i].val;\n\t}\n\tans=ans*(one^(n-x+1-now));\n\tprintf(\"%lld\",ans.num[1][1]+sum);\n}\n```",
        "postTime": 1542184339,
        "uid": 52851,
        "name": "ysy20021208",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF917C \u3010Pollywog\u3011"
    },
    {
        "content": "UPD 2021.4.9\uff1a\u4fee\u4e86\u4e2a typo\n\n[Codeforces \u9898\u76ee\u4f20\u9001\u95e8](https://codeforces.com/contest/917/problem/C) & [\u6d1b\u8c37\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF917C)\n\n~~\u8fd9\u662f\u4e00\u9053 *2900 \u7684 D1C\uff0c\u4e0d\u8fc7\u8fd8\u662f\u88ab\u6211\u60f3\u51fa\u6765\u4e86~~\n\n~~u1s1 \u5927\u6982\u662f\u8fd9\u9898\u7528\u5230\u7684\u51e0\u4e2a\u5957\u8def\u6211\u90fd\u89c1\u8fc7\u7f62~~\n\n\u9996\u5148\u6ce8\u610f\u5230 $k$ \u5f88\u5c0f\uff0c\u6545\u8003\u8651\u72b6\u538b $dp$\uff0c$dp_{i,s}$ \u8868\u793a\u5f53\u524d\u6240\u6709 pollywog \u90fd\u5728\u7f16\u53f7 $[i-k+1,i]$ \u8303\u56f4\u5185\u7684\u77f3\u5934\u4e0a\uff0c\u5e76\u4e14\u6709\u4e14\u4ec5\u6709\u7f16\u53f7 $i-x+1,x\\in s$ \u7684\u77f3\u5934\u4e0a\u6709 pollywog\u3002\n\n\u8f6c\u79fb\u8fd8\u662f\u6bd4\u8f83\u663e\u7136\u7684\uff0c\u5982\u679c $k\\in s$\uff0c\u90a3\u4e48\u6211\u4eec\u5fc5\u987b\u5f3a\u5236\u8ba9\u8fd9\u4e2a\u5f53\u524d\u4f4d\u4e8e $i-k+1$ \u4f4d\u7f6e\u7684 pollywog \u8df3 $k$ \u6b65\uff0c\u5426\u5219\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u4e00\u4e2a\u9752\u86d9\u5e76\u8ba9\u5b83\u8df3\u5230\u7f16\u53f7\u4e3a $i+1$ \u7684\u77f3\u5934\u4e0a\uff0c\u6216\u8005\u5e72\u8106 $i+1$ \u4f4d\u7f6e\u4e0a\u4e0d\u653e pollywog\uff0c\u4e5f\u5c31\u662f\u8bf4\uff1a\n\n- $dp_{i+1,s'}\\leftarrow dp_{i,s}+c_k+a_{i+1},s'=\\{x+1|x\\in s\\land x\\ne k\\}\\cup\\{1\\}(k\\in s)$\n- $dp_{i+1,s'}\\leftarrow dp_{i,s}+c_d+a_{i+1},s'=\\{x+1|x\\in s\\land x\\ne d\\}\\cup\\{1\\}(k\\notin s,d\\in s)$\n- $dp_{i+1,s'}\\leftarrow dp_{i,s}+c_k,s'=\\{x+1|x\\in s\\}(k\\notin s)$\n\n\u5176\u4e2d $c_i$ \u4e3a\u8df3 $i$ \u683c\u6240\u9700\u6d88\u8017\u7684\u4f53\u529b\uff0c$a_i$ \u4e3a $i$ \u6240\u5728\u7684\u7279\u6b8a\u683c\u6240\u989d\u5916\u6d88\u8017\u7684\u4f53\u529b\uff08\u5982\u679c $i$ \u4e0d\u662f\u7279\u6b8a\u683c\u5219 $a_i=0$\uff09\u3002\n\n\u521d\u59cb $dp_{x,\\{1,2,\\dots,x\\}}=0$\uff0c\u7b54\u6848\u4e3a $dp_{n,\\{1,2,\\dots,x\\}}$\u3002\n\n\u8003\u8651\u4f18\u5316\uff0c\u6ce8\u610f\u5230\u8fd9\u4e2a $n$ \u5f88\u5927\u4f46\u662f\u8fd9\u4e2a\u8f6c\u79fb\u5448\u89c4\u5f8b\u6027\u3002\u6545\u8003\u8651\u77e9\u9635\u4f18\u5316 $dp$\uff0c\u6211\u4eec\u628a\u8f6c\u79fb\u65b9\u7a0b\u7528\u77e9\u9635\u7684\u5f62\u5f0f\u8868\u793a\u51fa\u6765\uff0c\u5373\u6211\u4eec\u603b\u80fd\u627e\u5230\u4e00\u4e2a\u77e9\u9635 $A$ \u4f7f\u5f97 $A\\times\\begin{bmatrix}dp_{i,0}\\\\dp_{i,1}\\\\\\dots\\\\dp_{i,2^k-1}\\end{bmatrix}=\\begin{bmatrix}dp_{i+1,0}\\\\dp_{i+1,1}\\\\\\dots\\\\dp_{i+1,2^k-1}\\end{bmatrix}$\uff08\u5176\u4e2d\u4e24\u4e2a\u5927\u5c0f\u5206\u522b\u4e3a $n\\times m,m\\times k$ \u7684\u77e9\u9635 $A,B$ \u4e58\u6cd5\u5f97\u5230\u7684\u77e9\u9635 $C$ \u4e3a $n\\times k$ \u7684\u77e9\u9635\uff0c\u4e14 $C_{i,j}=\\min\\limits_{l=1}^mA_{i,l}+B_{l,j}$\uff09\u3002\u90a3\u4e48\u5982\u679c\u6ca1\u6709\u4ec0\u4e48\u7279\u6b8a\u683c\u5b50\u7684\u9650\u5236\u7684\u8bdd\uff0c\u76f4\u63a5\u4e00\u904d\u77e9\u9635\u5feb\u901f\u5e42\u5c31\u884c\u4e86\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u6709\u7279\u6b8a\u683c\u5b50\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u6309\u7167 CF576D \u7684\u5957\u8def\u5c06\u6240\u6709\u7279\u6b8a\u683c\u5b50\u6309\u5750\u6807\u6392\u4e2a\u5e8f\uff0c\u663e\u7136\u4e00\u4e2a\u7279\u6b8a\u683c\u5b50 $(x,y)$ \u5bf9 $dp$ \u503c\u4ea7\u751f\u7684\u5f71\u54cd\u5c31\u662f\u4ee4 $\\forall 1\\in S,dp_{x,S}\\leftarrow dp_{x,S}+y$\u3002\u6545\u53ef\u4ee5\u76f4\u63a5\u77e9\u9635\u5feb\u901f\u5e42\u6c42\u51fa $dp_x$\uff0c\u7136\u540e\u5c31\u76f4\u63a5\u5728 $dp_x$ \u4e0a\u4fee\u6539\u8d21\u732e\u5373\u53ef\u3002\n\n\u8fd9\u4e2a\u7b97\u6cd5\u7684\u590d\u6742\u5ea6  $\\omega^3p\\log n$ \u7684\uff0c\u5176\u4e2d $\\omega=2^k$\uff0c\u65e0\u6cd5\u901a\u8fc7\u3002\n\n\u8003\u8651\u4f18\u5316\uff0c\u6ce8\u610f\u5230\u8fd9\u4e2a\u8f6c\u79fb\u77e9\u9635 $A$ \u662f\u4e0d\u4f1a\u53d1\u751f\u53d8\u5316\u7684\uff0c\u6545\u8003\u8651\u501f\u9274 P6772 \u7684\u5957\u8def\uff0c\u800c\u6211\u4eec\u77e9\u9635\u5feb\u901f\u5e42\u6c42\u51fa $dp_x$ \u5b9e\u8d28\u4e0a\u662f\u77e9\u9635\u4e58\u5411\u91cf\uff0c\u5355\u6b21\u4e58\u6cd5\u590d\u6742\u5ea6\u4e3a $\\omega^2$\uff0c\u6545\u8003\u8651\u9884\u5904\u7406\u51fa $A^{2^k}$\uff0c\u8fd9\u6837\u53ef\u5b9e\u73b0 $\\omega^3\\log n$ \u9884\u5904\u7406\uff0c$\\omega^2p\\log n$ \u77e9\u9635\u5feb\u901f\u5e42\u3002 \n\n\u53ef\u662f\u8fd9\u6837\u8fd8\u662f\u4f1a\u70b8\u554a\u2026\u2026\n\n\u8fd9\u91cc\u8fd8\u6709\u7b2c\u4e09\u4e2a\u5957\u8def\uff0c\u5c31\u662f\u5bf9\u4e8e\u5408\u6cd5\u7684 $dp_{i,S}$ \u4e00\u5b9a\u6709 $|S|=x$\uff0c\u6545\u5408\u6cd5\u7684\u72b6\u6001\u6700\u591a $\\binom{8}{4}=70$ \u79cd\uff0c\u4e8e\u662f\u53ef\u4ee5\u628a\u6240\u6709\u5408\u6cd5\u7684\u72b6\u6001\u538b\u7f29\u6210\u4e00\u4e2a $[1,70]$ \u5185\u7684\u6574\u6570\uff0c\u8fd9\u6837\u77e9\u9635\u5927\u5c0f\u5c31\u964d\u5230\u4e86 $70$ \u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\omega^3\\log n+\\omega^2p\\log n+\\log p$\uff0c\u76ee\u524d\u6700\u4f18\u89e3 rk1\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi first\n#define se second\n#define fill0(a) memset(a,0,sizeof(a))\n#define fill1(a) memset(a,-1,sizeof(a))\n#define fillbig(a) memset(a,63,sizeof(a))\n#define pb push_back\n#define ppb pop_back\n#define mp make_pair\ntemplate<typename T1,typename T2> void chkmin(T1 &x,T2 y){if(x>y) x=y;}\ntemplate<typename T1,typename T2> void chkmax(T1 &x,T2 y){if(x<y) x=y;}\ntypedef pair<int,int> pii;\ntypedef long long ll;\ntypedef unsigned int u32;\ntypedef unsigned long long u64;\nnamespace fastio{\n\t#define FILE_SIZE 1<<23\n\tchar rbuf[FILE_SIZE],*p1=rbuf,*p2=rbuf,wbuf[FILE_SIZE],*p3=wbuf;\n\tinline char getc(){return p1==p2&&(p2=(p1=rbuf)+fread(rbuf,1,FILE_SIZE,stdin),p1==p2)?-1:*p1++;}\n\tinline void putc(char x){(*p3++=x);}\n\ttemplate<typename T> void read(T &x){\n\t\tx=0;char c=getchar();T neg=0;\n\t\twhile(!isdigit(c)) neg|=!(c^'-'),c=getchar();\n\t\twhile(isdigit(c)) x=(x<<3)+(x<<1)+(c^48),c=getchar();\n\t\tif(neg) x=(~x)+1;\n\t}\n\ttemplate<typename T> void recursive_print(T x){if(!x) return;recursive_print(x/10);putc(x%10^48);}\n\ttemplate<typename T> void print(T x){if(!x) putc('0');if(x<0) putc('-'),x=~x+1;recursive_print(x);}\n\tvoid print_final(){fwrite(wbuf,1,p3-wbuf,stdout);}\n}\nconst int MAXK=8;\nconst int MAXP=25;\nconst int MAX_SIZ=70;\nconst int LOG_N=28;\nconst ll INF=0x3f3f3f3f3f3f3f3fll;\nint x,k,n,p,c[MAXK+2];pii t[MAXP+2];\nint st[MAX_SIZ+5],st_n=0,id[1<<MAXK];\nstruct mat{\n\tint n,m;ll a[MAX_SIZ+5][MAX_SIZ+5];\n\tmat(){}\n\tmat(int _n,int _m){\n\t\tn=_n;m=_m;\n\t\tfor(int i=1;i<=n;i++) for(int j=1;j<=m;j++)\n\t\t\ta[i][j]=INF;\n\t}\n\tmat operator *(const mat &rhs){\n\t\tassert(m==rhs.n);mat res(n,rhs.m);\n\t\tfor(int i=1;i<=n;i++) for(int j=1;j<=rhs.m;j++)\n\t\t\tfor(int l=1;l<=m;l++) chkmin(res.a[i][j],a[i][l]+rhs.a[l][j]);\n\t\treturn res;\n\t}\n};\nmat pw[LOG_N+2];\nint main(){\n\tscanf(\"%d%d%d%d\",&x,&k,&n,&p);\n\tfor(int i=1;i<=k;i++) scanf(\"%d\",&c[i]);\n\tfor(int i=1;i<=p;i++) scanf(\"%d%d\",&t[i].fi,&t[i].se);\n\tsort(t+1,t+p+1);\n\tfor(int i=0;i<(1<<k);i++) if(__builtin_popcount(i)==x){\n\t\tst[++st_n]=i;id[i]=st_n;//printf(\"%d\\n\",i);\n\t} mat trs(st_n,st_n);\n\tfor(int i=1;i<=st_n;i++){\n\t\tif(st[i]>>(k-1)&1){\n\t\t\ttrs.a[id[((st[i]^(1<<(k-1)))<<1)|1]][i]=c[k];\n\t\t} else {\n\t\t\tfor(int j=0;j<k;j++) if(st[i]>>j&1)\n\t\t\t\ttrs.a[id[((st[i]^(1<<j))<<1)|1]][i]=c[j+1];\n\t\t\ttrs.a[id[st[i]<<1]][i]=0;\n\t\t}\n\t}\n//\tfor(int i=1;i<=st_n;i++) for(int j=1;j<=st_n;j++)\n//\t\tprintf(\"%lld%c\",trs.a[i][j],(j==st_n)?'\\n':' ');\n\tpw[0]=trs;\n\tfor(int i=1;i<=LOG_N;i++) pw[i]=pw[i-1]*pw[i-1];\n\tint pre=x,init_msk=0;mat cur(st_n,1);\n\tfor(int i=0;i<x;i++) init_msk|=1<<i;\n\tcur.a[id[init_msk]][1]=0;\n\tfor(int i=1;i<=p;i++){\n\t\tint dif=t[i].fi-pre;\n\t\tfor(int j=LOG_N;~j;j--) if(dif>>j&1) cur=pw[j]*cur;\n\t\tfor(int j=1;j<=st_n;j++) if(st[j]&1) cur.a[j][1]+=t[i].se;\n\t\tpre=t[i].fi;\n\t}\n\tint dif=n-pre;\n\tfor(int j=LOG_N;~j;j--) if(dif>>j&1) cur=pw[j]*cur;\n\tprintf(\"%lld\\n\",cur.a[id[init_msk]][1]);\n//\tfor(int i=1;i<=st_n;i++) printf(\"%d %lld\\n\",st[i],cur.a[i][1]);\n\treturn 0;\n}\n```\n",
        "postTime": 1615201090,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF917C\u3010Pollywog\u3011"
    },
    {
        "content": "> F. [CF917C Pollywog](https://www.luogu.com.cn/problem/CF917C) *2900\n\n\u6ce8\u610f\u5230 $x$ \u548c $k$ \u5f88\u5c0f\u800c $n$ \u5f88\u5927\uff0c\u540c\u65f6\u6240\u6709\u9752\u86d9\u4e4b\u95f4\u7684\u8ddd\u79bb\u5fc5\u7136\u4e0d\u8d85\u8fc7 $k$\uff08\u56e0\u4e3a\u6bcf\u6b21\u53ea\u80fd\u8df3\u6700\u5de6\u8fb9\u7684\u9752\u86d9\uff09\uff0c\u4ee5\u53ca\u8fd9 $q$ \u4e2a\u5947\u5947\u602a\u602a\u7684\u9650\u5236\uff08\u8054\u60f3\u5230 \u201c\u7f8e\u98df\u5bb6\u201d \u8fd9\u9898\uff09\uff0c\u77e9\u9635\u5feb\u901f\u5e42\u6ca1\u5f97\u8dd1\u4e86\u3002\n\n\u9884\u5904\u7406\u8f6c\u79fb\u77e9\u9635 $A$ \u7684\u5e42\uff0c\u5728\u65ad\u70b9\u5904\u7279\u6b8a\u8003\u8651\uff0c\u6bcf\u6b21\u77e9\u9635\u5feb\u901f\u5e42\u65f6\u53ea\u9700\u5411\u91cf\u4e58\u77e9\u9635\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}((q + |A|)|A| ^ 2\\log n)$\uff08\u8fd9\u91cc $|A|$ \u8868\u793a $A$ \u7684\u89c4\u6a21\u800c\u4e0d\u662f\u884c\u5217\u5f0f\u554a\u5582\uff09\u3002\n\n\u8fd9\u9898\u552f\u4e00\u6709\u6280\u672f\u542b\u91cf\u7684\u5730\u65b9\u5728\u4e8e\u72b6\u6001\u7684\u8bbe\u8ba1\u3002\n\n\u6211\u4eec\u6709\u4e24\u6761\u8def\uff0c\u4e00\u662f\u8bbe $f_{i, j}$ \u8868\u793a\u6700\u5de6\u8fb9\u7684\u9752\u86d9\u5728 $i$ \u5904\uff0c\u5269\u4e0b\u6765\u7684\u9752\u86d9\u72b6\u6001\u4e3a $j$ \u65f6\u6700\u5c0f\u4f53\u529b\u82b1\u8d39\u3002\u8fd9\u6837\u7531\u4e8e\u6bcf\u6b21\u8df3\u52a8\u6700\u591a\u4f1a\u8ba9 $i$ \u589e\u52a0 $k - x + 1$\uff0c\u6240\u4ee5\u5171\u9700\u8981\u8bb0\u5f55 $(k - x + 1)\\dbinom {k - 1} {x - 1}$ \u4e2a\u72b6\u6001\uff0c\u7b97\u4e00\u4e0b\u5f53 $x = 4$\uff0c$k = 8$ \u65f6\u5171\u6709 $170$ \u4e2a\u72b6\u6001\uff0c\u5373 $|A| = 170$\uff0c\u52c9\u5f3a\u53ef\u4ee5\u901a\u8fc7\u3002\n\n\u53e6\u4e00\u79cd\u662f\u8bbe $f_{i, j}$ \u8868\u793a\u5f53\u524d\u7684 **\u89c6\u91ce** \u5728 $i\\sim i + k - 1$ \u5904\uff0c\u4ee5\u8fd9\u6837\u7684\u89c6\u91ce\u89c2\u5bdf\u5230\u9752\u86d9\u7684\u72b6\u6001\u4e3a $j$ \u65f6\u7684\u6700\u5c0f\u4f53\u529b\u82b1\u8d39\u3002\u5177\u4f53\u5730\uff0c$j$ \u7684\u7b2c $p$ \u4f4d\u4e3a $1$ \u5f53\u4e14\u4ec5\u5f53 $i + p$ \u5904\u6709\u9752\u86d9\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u82e5 $2\\mid j$ \u5373 $i$ \u5904\u6ca1\u6709\u9752\u86d9\u65f6\uff0c\u8f6c\u79fb\u5230 $i + 1$ \u53ea\u9700\u7ed9 $j$ \u9664\u4ee5 $2$ \u800c\u975e\u8df3\u6700\u5de6\u8fb9\u7684\u9752\u86d9\u3002\u56e0\u6b64\u53ea\u9700\u8bb0\u5f55 $\\dbinom k x$ \u4e2a\u72b6\u6001\uff0c\u5f53 $x = 4$\uff0c$k = 8$ \u65f6\u53ea\u6709 $70$ \u4e2a\u72b6\u6001\uff0c\u7a33\u7a33\u901a\u8fc7\u3002\n\n\u6240\u4ee5\u8bf4\u6709\u7684\u65f6\u5019\u5de7\u5999\u7684\u72b6\u6001\u8bbe\u8ba1\u662f\u5f88\u91cd\u8981\u7684\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 70 + 5;\nvoid cmin(long long &x, long long y) {x = x < y ? x : y;}\nmap <int, int> mp;\nint x, k, n, q, sz, c[N], lab[1 << 8], msk[N];\nstruct mat {\n\tlong long a[N][N];\n\tmat() {memset(a, 0x3f, sizeof(a));}\n\tmat operator * (mat x) {\n\t\tmat y;\n\t\tfor(int i = 1; i <= sz; i++)\n\t\t\tfor(int j = 1; j <= sz; j++)\n\t\t\t\tfor(int k = 1; k <= sz; k++)\n\t\t\t\t\tcmin(y.a[i][k], a[i][j] + x.a[j][k]);\n\t\treturn y;\n\t}\n\tmat operator / (mat x) {\n\t\tmat y;\n\t\tfor(int i = 1; i <= sz; i++)\n\t\t\tfor(int j = 1; j <= sz; j++)\n\t\t\t\tcmin(y.a[1][j], a[1][i] + x.a[i][j]);\n\t\treturn y;\n\t}\n} tr, pw[27], I;\nstruct stone {\n\tint p, w;\n\tbool operator < (const stone &v) const {return p < v.p;}\n} s[N];\nint main() {\n\t// freopen(\"1.in\", \"r\", stdin);\n\tcin >> x >> k >> n >> q;\n\tfor(int i = 0; i < 1 << k; i++) if(__builtin_popcount(i) == x) msk[lab[i] = ++sz] = i;\n\tfor(int i = 1; i <= k; i++) cin >> c[i];\n\tfor(int i = 0; i < 1 << k; i++) {\n\t\tif(!lab[i]) continue;\n\t\tif(i & 1 ^ 1) {tr.a[lab[i]][lab[i >> 1]] = 0; continue;}\n\t\tfor(int p = 1; p <= k; p++) {\n\t\t\tif(i >> p & 1) continue;\n\t\t\ttr.a[lab[i]][lab[(i | 1 << p) >> 1]] = c[p];\n\t\t}\n\t}\n\tpw[0] = tr;\n\tfor(int i = 1; 1 << i < n; i++) pw[i] = pw[i - 1] * pw[i - 1];\n\tfor(int i = 1; i <= q; i++) cin >> s[i].p >> s[i].w, mp[s[i].p] = s[i].w;\n\tsort(s + 1, s + q + 1);\n\tif(s[q].p < n) s[++q] = {n};\n\tI.a[1][1] = 0;\n\tfor(int i = 1, cur = 1; i <= q; i++) {\n\t\tint to = min(n - x + 1, s[i].p);\n\t\tfor(int j = 26; ~j; j--) {\n\t\t\tif(cur + (1 << j) > to - k) continue;\n\t\t\tcur += 1 << j, I = I / pw[j];\n\t\t}\n\t\twhile(cur < to) {\n\t\t\tmat nxt;\n\t\t\tmemset(nxt.a, 0x3f, sizeof(nxt.a));\n\t\t\tfor(int i = 1; i <= sz; i++) {\n\t\t\t\tint S = msk[i];\n\t\t\t\tif(S & 1 ^ 1) {cmin(nxt.a[1][lab[S >> 1]], I.a[1][i]); continue;}\n\t\t\t\tfor(int p = 1; p <= k; p++) {\n\t\t\t\t\tif(S >> p & 1) continue;\n\t\t\t\t\tlong long nv = I.a[1][i] + c[p] + (mp.find(cur + p) == mp.end() ? 0 : mp[cur + p]);\n\t\t\t\t\tcmin(nxt.a[1][lab[(S | 1 << p) >> 1]], nv);\n\t\t\t\t}\n\t\t\t}\n\t\t\tcur++, I = nxt;\n\t\t}\n\t}\n\tcout << I.a[1][1] << endl;\n\treturn 0;\n}\n\n/*\n2022/4/28\nstart thinking at ??:??\n\n\u8fd9\u9898\u6211\u505a\u8fc7.jpg.\n\nstart coding at 20:40\nfinish debugging at 21:10\n*/\n```",
        "postTime": 1651545332,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "CF917C Pollywog"
    },
    {
        "content": "\u77e9\u9635\u4e58\u6cd5\u4f18\u5316dp\n\n\u56e0\u4e3a\u6bcf\u6b21\u6700\u591a\u8df3k\u683c\uff0c\u5e76\u4e14\u8df3\u7684\u90fd\u662f\u6700\u5de6\u8fb9\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u75282^k\u7684\u72b6\u6001\u6765\u8868\u793a\u76f8\u5bf9\u4f4d\u7f6e\u3002\n\n\u8bbedp[i][j]\u4e3a\u5de6\u7aef\u70b9\u5728i\uff0c\u53f3\u8fb9\u7684\u72b6\u6001\u4e3aj\u7684\u6700\u4f18\u65b9\u6848\u503c\n\n\u53ef\u4ee5\u53d1\u73b0\u8f6c\u79fb\u80fd\u7528\u77e9\u9635\u4f18\u5316\u3002\n\n\u5bf9\u4e8e\u7279\u6b8a\u7684\u77f3\u5b50\uff0c\u56e0\u4e3aq\u7279\u522b\u5c0f\uff0c\u6240\u4ee5\u5206\u6bb5\u8f6c\u79fb\u3002\u7ec6\u8282\u8f83\u591a\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#define int long long\nusing namespace std;\ninline int read(){int x=0,f=1,ch=getchar(); while(ch<'0'||ch>'9'){if(ch=='-') f=-1; ch=getchar();} while(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();} return x*f;}\ninline void write(int x){if (x<0) putchar('-'),x=-x; if (x>=10) write(x/10); putchar(x%10+'0');}\ninline void writeln(int x){write(x); puts(\"\");}\nconst int S=71,INF=1e18;\nint cnt;\nstruct matrix{\n\tint mat[S][S];\n\tmatrix() {\n        for (int i=1;i<=cnt;i++){\n            for (int j=1;j<=cnt;j++) {\n\t\t\t\tmat[i][j]=INF;\n\t\t\t}\n            mat[i][i]=0;\n        }\n    }\n\tinline void New(){\n\t\tfor (int i=1;i<=cnt;i++) mat[i][i]=INF;\n\t}\n};\ninline matrix operator *(matrix A,matrix B){\n\tmatrix C; C.New(); \n\tfor (int i=1;i<=cnt;i++){\n\t\tfor (int j=1;j<=cnt;j++){\n\t\t\tfor (int k=1;k<=cnt;k++){\n\t\t\t\tC.mat[i][j]=min(C.mat[i][j],A.mat[i][k]+B.mat[k][j]);\n\t\t\t}\n\t\t}\n\t}\n\treturn C;\n}\ninline matrix operator ^(matrix A,int k){\n\tmatrix B;\n\tif (!k) return matrix();\n\tfor (;k;k>>=1,A=A*A) if (k&1) B=B*A;\n\treturn B;\n}\ninline int lowbit(int x){\n\treturn x&(-x);\n}\ninline int calc(int x){\n\tint cnt=0;\n\tfor (;x;x-=lowbit(x)) cnt++;\n\treturn cnt;\n}\nstruct node{\n\tint x,y;\n}a[30];\nint c[10],x,k,n,q,g[1<<8];\ninline bool cmp(node A,node B){\n\treturn A.x<B.x;\n}\ninline void init(){\n\tx=read(); k=read(); n=read(); q=read();\n\tfor (int i=1;i<=k;i++) {\n\t\tc[i]=read();\n\t}\n\tfor (int i=1;i<=q;i++){\n\t\ta[i]=(node){read(),read()};\n\t}\n}\ninline void solve(){\n\tfor (int i=0;i<(1<<k);i++){\n\t\tif (calc(i)==x) g[i]=++cnt;\n\t}\n\tmatrix A; A.New();\n\tfor (int i=1;i<(1<<k);i++){\n\t\tif (g[i]){\n\t\t\tif (i&1){\n\t\t\t\tfor (int j=1;j<=k;j++){\n\t\t\t\t\tif ((1<<j)&i) continue;\n\t\t\t\t\tA.mat[g[i]][g[(i|(1<<j))>>1]]=c[j];\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tA.mat[g[i]][g[i>>1]]=0;\n\t\t\t}\n\t\t}\n\t}\n\tsort(a+1,a+1+q,cmp);\n\tmatrix ans; int sum=0,las=1;\n\tfor (int i=1;i<=q;i++){\n\t\tif (a[i].x>n-x){\n\t\t\tsum+=a[i].y;\n\t\t\tcontinue;\n\t\t}\n\t\tans=ans*(A^(a[i].x-las));\n\t\tlas=a[i].x;\n\t\tfor (int j=1;j<(1<<k);j+=2){\n\t\t\tif (g[j]){\n\t\t\t\tfor (int kk=1;kk<=cnt;kk++){\n\t\t\t\t\tans.mat[kk][g[j]]+=a[i].y;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tans=ans*(A^(n-x+1-las));\n\twriteln(ans.mat[1][1]+sum);\n}\nsigned main(){\n\tinit(); solve();\n\treturn 0;\n}\n```",
        "postTime": 1539226751,
        "uid": 34444,
        "name": "\u5927\u83dc\u9e21fks",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF917C \u3010Pollywog\u3011"
    },
    {
        "content": "\u8fd9\u9053\u9898\u6211\u4e00\u770b\u5c31\u77e5\u9053\u662f\u72b6\u538bDP\uff0c\u4f46\u8fd9\u9898$N$\u6bd4\u8f83\u5927\uff0c\u6211\u4e0d\u77e5\u9053\u600e\u4e48\u5feb\u901f\u8f6c\u79fb\uff0c\u6240\u4ee5\u53ea\u80fd\u53bb\u641c\u5176\u4ed6\u4eba\u7684\u9898\u89e3\uff0c\u7ed3\u679c\u767e\u5ea6\u4e0a\u6ca1\u6709\u53d1\u73b0\u4e00\u4e2a\u4eba\u5199\u4e86\u8fd9\u9898\u9898\u89e3\uff0c\u4e8e\u662f\u76f4\u63a5\u5728CF\u4e0a\u627e\u4e86\u4e00\u4e2aAC\u4e86\u7684\u4ee3\u7801\u81ea\u5df1\u53bb\u7406\u89e3...\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u7531\u4e8e\u9752\u86d9\u6700\u591a\u53ef\u4ee5\u8df3$k$\u4e2a\u77f3\u5934\uff0c\u6240\u4ee5\u5728\u4efb\u610f\u65f6\u523b\u6240\u6709$x$\u53ea\u9752\u86d9\u90fd\u5728\u8fde\u7eed\u4e00\u6bb5\u957f\u5ea6\u4e3a$k$\u7684\u533a\u95f4\u91cc\uff0c\u6240\u4ee5\u8fd9\u4e2a\u957f\u5ea6\u4e3a$k$\u7684\u533a\u95f4\u6700\u591a\u53ea\u6709$s (s \\leq 70)$\u79cd\u60c5\u51b5\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u6784\u9020\u51fa\u4e00\u4e2a$s \\times s$\u7684\u77e9\u9635\u6765\u8f6c\u79fb\u72b6\u6001\u3002\n\n\u7136\u540e\uff0c\u5bf9\u4e8e\u7279\u6b8a\u7684\u77f3\u5934\uff0c\u6211\u4eec\u53ef\u4ee5\u53e6\u5916\u8003\u8651\u3002\u56e0\u4e3a$q$\u8f83\u5c0f\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u6bcf\u6b21\u77e9\u9635\u5feb\u901f\u8f6c\u79fb\u5230\u7279\u6b8a\u77f3\u5934\u7684\u4f4d\u7f6e\uff0c\u52a0\u4e0a\u7279\u6b8a\u77f3\u5934\u5bf9\u7b54\u6848\u7684\u8d21\u732e\uff0c\u7136\u540e\u7ee7\u7eed\u8f6c\u79fb\u5373\u53ef\u3002\n\n\u8fd9\u9898~~\u6076\u5fc3\u7684~~\u7ec6\u8282\u8f83\u591a\uff0c\u8bf7\u4ed4\u7ec6\u9605\u8bfb\u4ee3\u7801\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <algorithm>\n\nusing namespace std;\n\n#define debug(...) printf(__VA_ARGS__), fflush(stdout);\n\ntypedef long long LL;\ntypedef pair<int, int> pii;\n\nconst int MAX_STATE = 71;\nconst LL inf = 1e18;\n\npii p[30];\n\nint c[10], f[1 << 8];\n\nint x, k, n, q, cnt;\n\nstruct matrix {\n\n\tLL A[MAX_STATE][MAX_STATE];\n\n\tmatrix() {\n\t\tfor (int i = 1; i < MAX_STATE; i++) {\n\t\t\tfor (int j = 1; j < MAX_STATE; j++)\n\t\t\t\tA[i][j] = inf;\n\t\t\tA[i][i] = 0;\n\t\t}\n\t}\n\n\tmatrix operator * (matrix B) {\n\t\tmatrix r;\n\t\tfor (int i = 1; i <= cnt; i++)\n\t\t\tr.A[i][i] = inf;\n\t\tfor (int i = 1; i <= cnt; i++)\n\t\t\tfor (int j = 1; j <= cnt; j++)\n\t\t\t\tfor (int k = 1; k <= cnt; k++)\n\t\t\t\t\tr.A[i][j] = min(r.A[i][j], A[i][k] + B.A[k][j]);\n\t\treturn r;\n\t}\n\n\tmatrix operator ^ (int y) {\n\t\tmatrix x, r;\n\t\tfor (int i = 1; i <= cnt; i++)\n\t\t\tfor (int j = 1; j <= cnt; j++)\n\t\t\t\tx.A[i][j] = A[i][j];\n\t\tif (!y) return matrix();\n\t\twhile (y) {\n\t\t\tif (y & 1) r = r * x;\n\t\t\tx = x * x; y >>= 1;\n\t\t}\n\t\treturn r;\n\t}\n\n};\n\nint calc(int x) {\n\tint sum = 0;\n\twhile (x) {\n\t\tif (x & 1) sum++;\n\t\tx >>= 1;\n\t}\n\treturn sum;\n}\n\nint main() {\n#ifdef xunzhen\n\tfreopen(\"E.in\", \"r\", stdin);\n\tfreopen(\"E.out\", \"w\", stdout);\n#endif\n\n\tcin >> x >> k >> n >> q;\n\tfor (int i = 1; i <= k; i++)\n\t\tscanf(\"%d\", &c[i]);\n\tfor (int i = 1; i <= q; i++)\n\t\tscanf(\"%d%d\", &p[i].first, &p[i].second);\n\n\tfor (int i = 0; i < (1 << k); i++)\n\t\tif (calc(i) == x) f[i] = ++cnt;\n\n\tmatrix R;\n\tfor (int i = 1; i <= cnt; i++)\n\t\tR.A[i][i] = inf;\n\n\tfor (int i = 1; i < (1 << k); i++) {\n\t\tif (!f[i]) continue;\n\t\tif (i & 1) {\n\t\t\tfor (int j = 1; j <= k; j++) {\n\t\t\t\tif ((1 << j) & i) continue;\n\t\t\t\tR.A[f[i]][f[((1 << j) | i) >> 1]] = c[j];\n\t\t\t}\n\t\t}else R.A[f[i]][f[i >> 1]] = 0;\n\t}\n\n\tsort(p + 1, p + q + 1);\n\n\tmatrix ans;\n\tLL sum = 0; int now = 1;\n\tfor (int i = 1; i <= q; i++) {\n\t\tif (p[i].first > n - x) {\n\t\t\tsum += p[i].second;\n\t\t\tcontinue;\n\t\t}\n\t\tans = ans * (R ^ (p[i].first - now));\n\t\tnow = p[i].first;\n\t\tfor (int j = 1; j < (1 << k); j += 2)\n\t\t\tif (f[j])\n\t\t\t\tfor (int k = 1; k <= cnt; k++)\n\t\t\t\t\tans.A[k][f[j]] += p[i].second;\n\t}\n\tans = ans * (R ^ (n - x + 1 - now));\n\n\tcout << ans.A[1][1] + sum << endl;\n\n\treturn 0;\n}\n```",
        "postTime": 1518016778,
        "uid": 9612,
        "name": "xunzhen",
        "ccfLevel": 0,
        "title": "CF917C Pollywog"
    }
]
[
    {
        "content": "\u91c7\u83dc\u522b\u8e29\u83dc $\\to$ [`George1123`](https://www.cnblogs.com/George1123/p/14242261.html#cf375e-red-and-black-tree)\n\n---\n\n> [luogu](https://www.luogu.com.cn/problem/CF375E)\n\n\u591a\u597d\u7684\u95ee\u9898\u554a\uff0c\u611f\u89c9\u6700\u8fd1\u8fd8\u662f\u8981\u591a\u81ea\u5df1\u601d\u8003\uff0c\u522b\u6253\u5b8c\u6bd4\u8d5b\u5c31\u76f2\u76ee\u8d3a\u9898\u3002\n\n\u542c\u8bf4\u6709\u4e2a\u4ec0\u4e48\u5355\u7eaf\u5f62\u7684\u7ebf\u6027\u89c4\u5212\uff0c\u6211\u6c38\u8fdc\u4e0d\u4f1a\u5b66\u5b83\u7684\uff01\n\n\u8bbe $f(u,i,t)$ \u8868\u793a\u5728\u8282\u70b9 $u$ \u7684\u5b50\u6811\u4e2d\u6709 $i$ \u4e2a\u70b9\u5fc5\u987b\u662f\u9ed1\u70b9\uff08\u5176\u4ed6\u70b9\u4e5f\u53ef\u4ee5\u662f\u9ed1\u70b9\u7684\uff09\uff0c\u7136\u540e\u7528 $t$ \u8fd9\u4e2a\u8282\u70b9\u89e3\u51b3 $u$ \u9700\u8981\u6ee1\u8db3\u7684\u6761\u4ef6\u7684\u6700\u5c0f\u4ee3\u4ef7\uff08\u76f8\u5f53\u4e8e\u8f6c\u5316\u95ee\u9898\uff1a\u4ece\u4ea4\u6362\u989c\u8272\uff0c\u53d8\u6210\u56fa\u5b9a\u6bcf\u4e2a\u989c\u8272\u6570\u91cf\uff0c\u7136\u540e\u6c42\u51fa\u6700\u5c11\u4ea4\u6362\u4ee3\u4ef7\uff09\u3002\n\n\u7136\u540e\u8003\u8651\u600e\u4e48\u8f6c\u79fb\uff0c\u5982\u679c\u5b50\u6811\u72b6\u6001\u662f $f(v,j,a)$ \u8981\u5408\u5e76\u4e0a\u6765\uff1a\n\n1. \u5982\u679c $a=t$\uff0c\u90a3\u4e48 $f(u,i+j,t)\\leftarrow\\min  f(u,i,t)+f(v,j,t)$\uff08\u4e3a\u4ec0\u4e48\u4e0d\u662f $i+j-1$ \u554a\uff1f\u53ef\u80fd\u662f\u60a8\u6ca1\u7406\u89e3\u8fd9\u4e2a `dp`\uff09\uff1a\n      1. \u5982\u679c $t$ \u5728 $v$ \u548c $u$ \u7684\u5b50\u6811\u5916\uff0c\u90a3\u4e48\u5b83\u4eec\u90fd\u4e0d\u9700\u8981\u7edf\u8ba1\u8fd9\u4e2a\u9ed1\u70b9\u3002\n      2. \u5982\u679c $t$ \u5728\u4e4b\u524d $u$ \u7684\u5b50\u6811\u5185\uff0c\u90a3\u4e48\u8fd9\u4e2a\u9ed1\u70b9\u7b97\u5728 $i$ \u4e2d\u4e0d\u7b97\u5728 $j$ \u4e2d\u3002\n      3. \u5982\u679c $t$ \u5728 $v$ \u7684\u5b50\u6811\u5185\uff0c\u8fd9\u4e2a\u9ed1\u70b9\u7b97\u5728 $j$ \u4e2d\u4e0d\u7b97\u5728 $i$ \u4e2d\u3002\n\n2. \u5982\u679c $a\\neq t$\uff0c\u6613\u8bc1\uff1a\u53ea\u6709 $a$ \u5728 $v$ \u5b50\u6811\u4e2d\u4e14 $t$ \u5728 $v$ \u5b50\u6811\u5916\u662f\u4f18\u5316\u7684\uff1a\n\n      1. \u5982\u679c $a$ \u5728 $v$ \u5b50\u6811\u5916\uff0c\u90a3\u4e48 $u$ \u6bd4 $v$ \u79bb $a$ \u66f4\u8fd1\uff0c\u6240\u4ee5\u5e94\u8be5 $t=a$\u3002\n      2. \u5982\u679c $t$ \u5728 $v$ \u5b50\u6811\u5185\uff0c\u90a3\u4e48 $v$ \u6bd4 $u$ \u79bb $t$ \u66f4\u8fd1\uff0c\u6240\u4ee5\u5e94\u8be5 $a=t$\u3002\n\n- \u7136\u540e\u5408\u5e76\u5b8c\u540e\u662f $f(u,i+j,t)$\uff08\u8981\u6c42 $t$ \u5728 $v$ \u5b50\u6811\u5916\uff09\uff0c\u76f4\u63a5\u627e\u5230\u5bf9\u4e8e\u6bcf\u4e2a $v$ \u5b50\u6811\u5185\u7684 $a$ \u6700\u5c0f\u7684 $f(v,j,a)$ \u5373\u53ef\u8f6c\u79fb\u3002\n\n\u7136\u540e\u518d\u60f3\u60f3\u8be5\u600e\u4e48\u521d\u59cb\u5316\uff1a\n\n1. \u9996\u5148\u5148\u628a\u6240\u6709 `dp` \u503c\u8d4b\u4e3a $+\\infty$\u3002\n\n2. \u5bf9\u4e8e\u8282\u70b9 $u$\uff0c\u521d\u59cb\u5316 $f(u,1,u)=1-col_u$\u3002\n\n3. \u5bf9\u4e8e\u8282\u70b9 $u$ \u548c\u6ee1\u8db3 $dis(u,v)\\le x$ \u7684 $v(v\\neq u)$\uff0c\u521d\u59cb\u5316 $f(u,0,v)=0$\u3002\n\n\u7136\u540e\u7b54\u6848\u5c31\u662f\u6240\u6709 $i\\le $ \u539f\u6765\u9ed1\u70b9\u6570\u91cf\u7684 $f({\\rm root},i,t)$ \u6700\u5c0f\u503c\u3002\n\n[aclink](https://codeforces.com/contest/375/submission/103522153)\uff0c\u8981\u7528 `short` \u5361\u7a7a\u95f4\u3002",
        "postTime": 1609939603,
        "uid": 118365,
        "name": "George1123",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF375E \u3010Red and Black Tree\u3011"
    },
    {
        "content": "\u672c\u9898\u53ef\u4ee5\u91c7\u7528\u7ebf\u6027\u89c4\u5212\u7684\u65b9\u5f0f\u6c42\u89e3\u3002\u63a8\u8350\u5148\u9605\u8bfb 2021 \u5e74 dxm \u7684\u96c6\u8bad\u961f\u8bba\u6587\u300a\u518d\u63a2\u7ebf\u6027\u89c4\u5212\u5bf9\u5076\u5728\u4fe1\u606f\u5b66\u7ade\u8d5b\u4e2d\u7684\u5e94\u7528\u300b\uff0c\u540c\u65f6\u53ef\u4ee5\u9605\u8bfb[\u672c\u6587](https://www.cnblogs.com/joke3579/p/linear_programming_1.html)\u83b7\u53d6\u53ef\u80fd\u7684\u524d\u7f6e\u77e5\u8bc6\u3002\n\n\u4e0b\u6587\u5c06\u91c7\u7528\u7c97\u659c\u4f53 $\\bm a$ \u8868\u793a\u4e00\u4e2a\u5411\u91cf\uff0c$a_i$ \u8868\u793a\u8be5\u5411\u91cf\u5728\u7b2c $i$ \u7ef4\u7684\u53d6\u503c\uff08\u7ef4\u6570\u4ece $1$ \u5f00\u59cb\uff09\uff1b\u91c7\u7528\u659c\u4f53\u5927\u5199\u5b57\u6bcd $A$ \u8868\u793a\u4e00\u4e2a\u77e9\u9635\uff0c$A_{i,j}$ \u8868\u793a\u8be5\u77e9\u9635\u7b2c $i$ \u884c\u7b2c $j$ \u5217\u7684\u5143\u7d20\uff1b\u91c7\u7528 $\\bm 1$ \u8868\u793a\u4e00\u4e2a\u5404\u7ef4\u53d6\u503c\u5747\u4e3a $1$ \u7684\u5217\u5411\u91cf\uff0c\u7ef4\u6570\u89c6\u4e0a\u4e0b\u6587\u800c\u5b9a\uff0c$\\bm 0$ \u540c\u7406\u3002\n\n\u4ee4 $n$ \u7ef4\u5411\u91cf $\\bm b$ \u6ee1\u8db3 $b_i = [\\ i\\ \u53f7\u8282\u70b9\u4e3a\u7ea2\u8272]$\uff1b$n\\times n$ \u5927\u5c0f\u7684\u77e9\u9635 $A$ \u6ee1\u8db3 $A_{i,j} = [\\ i, j\\ \u4e24\u8282\u70b9\u95f4\u7684\u8ddd\u79bb \\le x]$\u3002\u4ee4\u89e3 $\\bm x$ \u6ee1\u8db3 $x_i = [\u6700\u7ec8\\ i \\ \u8282\u70b9\u4e3a\u9ed1\u8272]$\uff0c\u540c\u65f6\u8bb0\u9ed1\u8272\u8282\u70b9\u603b\u6570\u4e3a $H$\u3002\u5bb9\u6613\u5199\u51fa\u4ee5\u4e0b\u7684\u6574\u6570\u7ebf\u6027\u89c4\u5212\uff1a\n\n$$\\begin{aligned}\n\n\\min_{\\bm x} \\quad & \\sum_{i=1}^n b_i x_i \\\\\n\\text{s.t.} \\quad & \\forall i, \\sum_{j=1}^n \\ A_{i, j} \\times x_j \\ge 1 \\\\ \n& \\sum_{i = 1}^n x_i = H \\\\\n& x_i \\in \\{0, 1\\}\n\n\\end{aligned}$$\n\n\u6211\u4eec\u5c06\u8bf4\u660e\u5bf9 $x_i$ \u53d6 $\\forall i, \\ x_i\\ge 0$ \u7684\u7ea6\u675f\u6761\u4ef6\u548c $\\forall i, \\ x_i\\in \\{0, 1\\}$ \u7684\u7ea6\u675f\u6761\u4ef6\u5f97\u5230\u7684\u7ed3\u679c\u662f\u76f8\u540c\u7684\u3002\u6211\u4eec\u79f0\u524d\u4e00\u79cd\u7ea6\u675f\u6761\u4ef6\u5bf9\u5e94\u7684\u7ebf\u6027\u89c4\u5212\u4e3a\u666e\u901a\u7ebf\u6027\u89c4\u5212\uff0c\u540e\u4e00\u79cd\u7ea6\u675f\u6761\u4ef6\u5bf9\u5e94\u7684\u7ebf\u6027\u89c4\u5212\u4e3a\u6574\u6570\u7ebf\u6027\u89c4\u5212\u3002\n\n\u9996\u5148\u4e0d\u96be\u53d1\u73b0\u666e\u901a\u7ebf\u6027\u89c4\u5212\u7684\u6700\u4f18\u89e3\u4e00\u5b9a\u5927\u4e8e\u7b49\u4e8e\u6574\u6570\u7ebf\u6027\u89c4\u5212\u3002\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u8bc1\u660e\u666e\u901a\u7ebf\u6027\u89c4\u5212\u7684\u6700\u4f18\u89e3\u4e00\u5b9a\u5c0f\u4e8e\u7b49\u4e8e\u6574\u6570\u7ebf\u6027\u89c4\u5212\u5373\u53ef\u3002\n\n\u73b0\u5728\u9700\u8981\u8bc1\u660e\u4e00\u5b9a\u5b58\u5728\u4e00\u79cd\u6700\u4f18\u89e3\u6ee1\u8db3\u6574\u6570\u7ebf\u6027\u89c4\u5212\u7684\u7ea6\u675f\u6761\u4ef6\u3002\u539f\u56e0\u6709\u4e8c\uff1a\n\n1. \u7531\u4e8e $\\sum_{j=1}^n \\ A_{i, j} \\times x_j \\ge 1$\uff0c\u6211\u4eec\u4e0d\u5fc5\u53d6 $x_j > 1$\u3002\u663e\u7136\u5730\uff0c\u5982\u679c\u5b58\u5728\u4e00\u4e2a\u6700\u4f18\u89e3\u4f7f\u5f97 $x_i > 1$\uff0c\u6211\u4eec\u90fd\u53ef\u4ee5\u5c06\u521d\u59cb\u4e3a\u7ea2\u8272\u7684\u70b9\u7684 $x$ \u503c\u589e\u52a0\uff0c\u8fd9\u6837\u53ef\u4ee5\u5c06 $x_j$ \u964d\u4f4e\u81f3 $1$\uff0c\u65b0\u89e3\u4e00\u5b9a\u4e0d\u52a3\u4e8e\u539f\u89e3\u3002\n2. \u5bf9\u4e8e\u4e00\u4e2a\u6240\u6709\u53d8\u91cf\u90fd\u53d6\u5230\u6574\u6570\u7684\u6700\u4f18\u89e3\uff0c\u4e00\u5b9a\u65e0\u6cd5\u5c06\u4e00\u4e9b $x_i$ \u8c03\u6574\u4e3a\u975e\u6574\u6570\u53d6\u503c\u3002\u5f53\u524d\u60c5\u51b5\u4e0b\u4e00\u5b9a\u662f\u5c06\u539f\u6765\u7684\u7ea2\u70b9 $i$ \u7684 $x_i$ \u8c03\u5c0f\uff0c\u5176\u4f59\u90e8\u5206\u8282\u70b9\u8c03\u5927\u3002\u6211\u4eec\u65ad\u8a00 $x_i = 1$ \u7684\u60c5\u51b5\u4e0b\u548c\u5176\u8ddd\u79bb\u5728 $x$ \u5185\u7684\u8282\u70b9\u4e2d\u80af\u5b9a\u5b58\u5728\u4e00\u4e2a\u8282\u70b9\u6ee1\u8db3\u7b2c\u4e00\u4e2a\u9650\u5236\u6761\u4ef6\u53d6\u7b49\uff1b\u4e0d\u7136\u5219 $x_i$ \u53ef\u4ee5\u7b49\u4e8e $0$\uff0c\u8fd9\u6837\u4e00\u5b9a\u66f4\u4f18\u3002\n\n\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u4e0d\u518d\u8003\u8651 $x_i$ \u7684\u53d6\u503c\u9650\u5236\u3002\n\n\u62c6\u6700\u540e\u7684\u7b49\u4e8e\u4e3a\u5927\u4e8e\u7b49\u4e8e\u4e14\u5c0f\u4e8e\u7b49\u4e8e\u3002\u5199\u6210\u7ebf\u6027\u4ee3\u6570\u5f62\u5f0f\u5c31\u662f\n\n$$\\begin{aligned}\n\n\\min_{\\bm x} \\quad & \\bm b^{\\mathsf T} \\bm x \\\\\n\\text{s.t.} \\quad & \n\\begin{bmatrix}  A \\\\ \\bm 1^{\\mathsf T} \\\\  - \\bm 1^{\\mathsf T} \\end{bmatrix}\n\\bm x \\ge \\begin{bmatrix} \\bm 1 \\\\ H  \\\\ - H \\end{bmatrix}\\\\ \n&\\bm x \\ge \\bm 0\n\n\\end{aligned}$$\n\n\u8f6c\u5bf9\u5076\u5f97\u5230\n\n$$\\begin{aligned}\n\n\\max_{\\bm y} \\quad & \\left[\\bm 1^{\\mathsf T}  \\quad  H \\quad  - H\\right] \\bm y \\\\\n\\text{s.t.} \\quad & \n\\left[A^{\\mathsf T} \\quad \\bm 1 \\quad -\\bm 1\\right]\n\\bm y \\le \\bm b\\\\ \n& \\bm y \\ge \\bm 0\n\n\\end{aligned}$$\n\n\u91c7\u7528\u5355\u7eaf\u5f62\u6cd5\u6c42\u89e3\u5373\u53ef\u3002\n\n[Submission](https://codeforces.com/contest/375/submission/187197055).",
        "postTime": 1672366049,
        "uid": 631791,
        "name": "joke3579",
        "ccfLevel": 0,
        "title": "CF375E \u9898\u89e3"
    },
    {
        "content": "\u633a\u597d\u7684\u4e00\u4e2a\u9898\u3002\n\n\u9996\u5148\u8f6c\u5316\u9898\u76ee\u4e2d\u7684\u64cd\u4f5c\uff0c\u8003\u8651\u4ea4\u6362\u7684\u6b21\u6570\u5982\u4f55\u6700\u5c0f\u5316\u3002\u663e\u7136\u989c\u8272\u5e8f\u5217\u6709\u4e2a\u521d\u59cb\u72b6\u6001\u548c\u7ec8\u6b62\u72b6\u6001\uff0c\u4e5f\u5c31\u662f\u8bf4\u6709\u4e9b\u70b9\u4ece\u767d\u8272\u53d8\u6210\u4e86\u9ed1\u8272\uff0c\u53e6\u4e00\u4e9b\u4ece\u9ed1\u8272\u53d8\u6210\u4e86\u767d\u8272\uff0c\u800c\u4e8c\u8005\u7684\u6570\u91cf\u5e94\u8be5\u662f\u76f8\u540c\u7684\u3002\u4e8e\u662f\u95ee\u9898\u53d8\u6210\u4e86\u5982\u4f55\u6700\u5c0f\u5316\u539f\u6765\u662f\u767d\u70b9\u3001\u73b0\u5728\u662f\u9ed1\u70b9\u7684\u6570\u91cf\u3002\u7528 $f_{x,t,d}$ \u8868\u793a\u5b50\u6811 $x$ \u4e2d\u5df2\u7ecf\u94a6\u5b9a\u4e86 $t$ \u4e2a\u9ed1\u70b9\uff0c\u5e76\u4e14 $x$ \u5bf9\u5e94\u7684\u9ed1\u70b9\u662f\u70b9 $d$ \u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\u8003\u8651\u5b83\u548c\u6bcf\u4e2a\u5b69\u5b50 $y$ \u4e4b\u95f4\u7684\u8f6c\u79fb\u3002\n\n\u5982\u679c\u4e24\u4e2a\u70b9\u5bf9\u5e94\u7684\u9ed1\u70b9\u76f8\u540c\u7684\u8bdd\u5f88\u597d\u5904\u7406\uff0c\u679a\u4e3e\u90a3\u4e2a\u70b9\u662f\u4ec0\u4e48\u5373\u53ef\u3002\u5982\u679c\u4e24\u4e2a\u70b9\u5bf9\u5e94\u7684\u9ed1\u70b9\u4e0d\u540c\uff0c\u6709\u4e00\u4e2a\u663e\u7136\u7684\u4e8b\u60c5\u662f\u8bf4\u7236\u4eb2\u80af\u5b9a\u4e0d\u4f1a\u9009\u5b69\u5b50\u5b50\u6811\u5185\u7684\u70b9\uff0c\u76f8\u5e94\u5730\u5b69\u5b50\u4e5f\u4e0d\u4f1a\u9009\u5b50\u6811\u5916\u7684\uff0c\u56e0\u4e3a\u8fd9\u4e24\u79cd\u60c5\u51b5\u90fd\u53ef\u4ee5\u901a\u8fc7\u8c03\u6574\u6765\u4f7f\u5f97\u9ed1\u70b9\u53d8\u5c11\u5e76\u4e14\u6548\u679c\u4e0d\u53d8\uff0c\u6240\u4ee5\u5bf9\u4e8e\u7236\u4eb2\u9009\u62e9\u4e00\u4e2a\u70b9 $z$ \u7684\u60c5\u51b5\uff0c\u5b69\u5b50\u53ef\u4ee5\u9009\u62e9\u5176\u5b50\u6811\u5185\u4efb\u610f\u7684\u8282\u70b9\uff0c\u8d2a\u5fc3\u53d6\u6700\u5c0f\u503c\u5373\u53ef\u3002\u4e8e\u662f\u603b\u7684\u590d\u6742\u5ea6\u5c31\u662f $O(n^3)$\u3002\u9700\u8981\u7528 short \u6765\u5361\u4e00\u4e0b\u7a7a\u95f4\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n//#define feyn\n#define int long long\nusing namespace std;\nconst int N=501; \ninline void read(int &wh){\n\twh=0;char w=getchar();int f=1;\n\twhile(w<'0'||w>'9'){if(w=='-')f=-1;w=getchar();}\n\twhile(w<='9'&&w>='0'){wh=wh*10+w-'0';w=getchar();}\n\twh*=f;return;\n}\n\nint m,n,a[N];\nstruct edge{\n\tint t,v,nxt;\n}e[N<<1];\nint head[N],esum;\ninline void add(int fr,int to,int val){\n\te[++esum]=(edge){to,val,head[fr]};head[fr]=esum;\n}\n\nint dis[N][N],dfn[N],cnt;\nvoid find(int wh,int fa,int rt,int nowDis){\n\tdis[rt][wh]=nowDis;\n\tif(rt==1)dfn[wh]=++cnt;\n\tfor(int i=head[wh],th;i;i=e[i].nxt){\n\t\tif((th=e[i].t)==fa)continue;\n\t\tfind(th,wh,rt,nowDis+e[i].v);\n\t}\n}\n\nshort f[N][N][N],ff[N][N],siz[N];\ninline void chk(short &s1,short s2){\n\ts1=s1<s2?s1:s2;\n}\nvoid solve(int wh,int fa){\n\tf[wh][1][dfn[wh]]=a[wh]?0:1;siz[wh]=1;\n\tfor(int i=1;i<=m;i++){\n\t\tif(i==wh||dis[wh][i]>n)continue;\n\t\tf[wh][0][dfn[i]]=0;\n\t}\n\tfor(int i=head[wh],th;i;i=e[i].nxt){\n\t\tif((th=e[i].t)==fa)continue;\n\t\tsolve(th,wh);\n\t\tfor(int i=0;i<=siz[wh]+siz[th];i++){\n\t\t\tfor(int j=1;j<=m;j++)ff[i][j]=0x3f3f;\n\t\t}\n\t\tfor(int y=0;y<=siz[th];y++){\n\t\t\tint mn=*min_element(f[th][y]+dfn[th],f[th][y]+dfn[th]+siz[th]);\n\t\t\tfor(int x=0;x<=siz[wh];x++){\n\t\t\t\tfor(int t=1;t<=m;t++){\n\t\t\t\t\tchk(ff[x+y][t],f[wh][x][t]+f[th][y][t]);\n\t\t\t\t\tif(t>=dfn[th]&&t<dfn[th]+siz[th])continue;\n\t\t\t\t\tchk(ff[x+y][t],f[wh][x][t]+mn);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<=siz[wh]+siz[th];i++){\n\t\t\tfor(int j=1;j<=m;j++)f[wh][i][j]=ff[i][j];\n\t\t}\n\t\tsiz[wh]+=siz[th];\n\t}\n}\n\nsigned main(){\n\t\n\t#ifdef feyn\n\tfreopen(\"in.txt\",\"r\",stdin);\n\t#endif\n\t\n\tread(m);read(n);int preNum=0;\n\tfor(int i=1;i<=m;i++)read(a[i]),preNum+=a[i];\n\tfor(int i=1;i<m;i++){\n\t\tint s1,s2,s3;read(s1);read(s2);read(s3);\n\t\tadd(s1,s2,s3);add(s2,s1,s3);\n\t}\n\tfor(int i=1;i<=m;i++)find(i,0,i,0);\n\tmemset(f,0x3f,sizeof(f));\n\tsolve(1,0);int ans=m;\n\tfor(int i=1;i<=preNum;i++){\n\t\tfor(int j=1;j<=m;j++){\n\t\t\tans=min(ans,(int)f[1][i][j]);\n\t\t}\n\t}\n\tif(ans==m)puts(\"-1\");\n\telse printf(\"%lld\\n\",ans);\n\t\n\treturn 0;\n}\n```",
        "postTime": 1679975071,
        "uid": 302383,
        "name": "Feyn",
        "ccfLevel": 0,
        "title": "CF375E"
    }
]
[
    {
        "content": "### [\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF1428D)\n\n## \u9898\u610f\n\n- \u5728 $n\\times n$ \u7684\u65b9\u9635\u4e2d\uff0c\u6bcf\u4e00\u5217\u5e95\u7aef\u90fd\u4f1a\u5411\u4e0a\u8fdb\u5165\u4e00\u4e2a\u7403\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u7279\u6b8a\u70b9\uff0c\u82e5\u7403\u7ecf\u8fc7\u5219\u7403\u65b9\u5411\u53f3\u8f6c\u3002\n\n- \u7ed9\u5b9a\u6bcf\u4e00\u5217\u7684\u7403\u7ecf\u8fc7\u7279\u6b8a\u70b9\u4e2a\u6570\uff0c\u8bf7\u6784\u9020\u65b9\u6848\u3002\n\n## Sol\n\n\u8003\u8651\u5230 $a_i \\le 3$ \u90a3\u5c31\u53ef\u53d1\u73b0\u662f\u4e00\u9053\u5f88\u597d\u6784\u9020\u7684\u8d2a\u5fc3\u3002\n\n\u5206\u56db\u7c7b\u8ba8\u8bba\u3002\n\n#### $a_i=0$\n\n\u76f4\u63a5\u8df3\u8fc7\u5373\u53ef\u3002\n\n#### $a_i=1$\n\n\u65b0\u5f00\u4e00\u884c\u5373\u53ef\u3002\n\n#### $a_i=2$\n\n\u8003\u8651\u5230\u4e00\u884c\u6700\u591a\u53ea\u80fd\u6709 $2$ \u4e2a\u7279\u6b8a\u70b9\uff0c\u90a3\u4e48\u53ef\u53d1\u73b0\u5b83\u4e00\u5b9a\u8ddf\u5728\u4e00\u4e2a $a_i=1$ \u7684\u540e\u9762\u3002\n\n\u8fd9\u91cc\u4f1a\u51fa\u73b0\u65e0\u89e3\u60c5\u51b5\uff0c\u4ec5\u5f53\u524d\u9762\u4e0d\u5b58\u5728 $a_i=1$ \u88ab\u5360\u7528\u3002\n\n#### $a_i=3$\n\n\u518d\u5f00\u4e00\u884c\u5373\u53ef\uff0c\u9700\u8981\u5360\u7528\u4e00\u4e2a $a_i=1/2/3$ \u4f18\u5148\u5360\u7528 $a_i=2/3$\u3002\n\n\u6ca1\u4e86\u3002\u601d\u8def\u6e05\u6670\u3002\u7b80\u5355\u8d2a\u5fc3\u3002\n\n```cpp\n// wish to get better qwq\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll N=1e5+5;\nll n,a[N],ans,nw;\nstack<pair<ll,ll> >c1,c2,qaq,c3;\ntemplate <typename T> void rd(T &x){\n\tll fl=1;x=0;char c=getchar();\n\tfor(;!isdigit(c);c=getchar()) if(c=='-') fl=-fl;\n\tfor(;isdigit(c);c=getchar()) x=(x<<3)+(x<<1)+c-'0';\n\tx*=fl;\n}\nvoid wr(ll x){\n\tif(x<0) x=-x,putchar('-');\n\tif(x<10) putchar(x+'0');\n\tif(x>9) wr(x/10),putchar(x%10+'0');\n}\nint main(){\n//\tfreopen(\".in\",\"r\",stdin);\n//\tfreopen(\".out\",\"w\",stdout);\n\trd(n);nw=n;\n\tfor(ll i=1;i<=n;i++) rd(a[i]);\n\tfor(ll i=n;i>0;i--){\n\t\tif(a[i]==0) continue;\n\t\tif(a[i]==1){\n\t\t\tc1.push(make_pair(nw,i));qaq.push(make_pair(nw,i));\n\t\t\tans++;nw--;\n\t\t}\n\t\tif(a[i]==2){\n\t\t\tif(c1.empty()){\n\t\t\t\tputs(\"-1\");return 0;\n\t\t\t}\n\t\t\tpair<ll,ll> x=c1.top();c1.pop();\n\t\t\tc2.push(make_pair(x.first,i));qaq.push(make_pair(x.first,i));\n\t\t\tans++;\n\t\t}\n\t\tif(a[i]==3){\n\t\t\tif(c1.empty()&&c2.empty()&&c3.empty()){\n\t\t\t\tputs(\"-1\");return 0;\n\t\t\t}\n\t\t\tif(!c3.empty()){\n\t\t\t\tpair<ll,ll> x=c3.top();c3.pop();\n\t\t\t\tans+=2;\n\t\t\t\tc3.push(make_pair(nw,i));\n\t\t\t\tqaq.push(make_pair(nw,i));qaq.push(make_pair(nw,x.second));\n\t\t\t\tnw--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(!c2.empty()){\n\t\t\t\tpair<ll,ll> x=c2.top();c2.pop();\n\t\t\t\tans+=2;\n\t\t\t\tc3.push(make_pair(nw,i));\n\t\t\t\tqaq.push(make_pair(nw,i));qaq.push(make_pair(nw,x.second));\n\t\t\t\tnw--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tpair<ll,ll> x=c1.top();c1.pop();\n\t\t\tans+=2;\n\t\t\tc3.push(make_pair(nw,i));\n\t\t\tqaq.push(make_pair(nw,i));qaq.push(make_pair(nw,x.second));\n\t\t\tnw--;\n\t\t\tcontinue;\n\t\t}\n\t}\n\twr(ans);puts(\"\");\n\twhile(!qaq.empty()){\n\t\tpair<ll,ll> x=qaq.top();qaq.pop();\n\t\twr(x.first),putchar(' '),wr(x.second),puts(\"\");\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1602977500,
        "uid": 83999,
        "name": "Demoe",
        "ccfLevel": 7,
        "title": "CF1428D Bouncing Boomerangs \u9898\u89e3 \u8d2a\u5fc3"
    },
    {
        "content": "# CF1428D \u3010Bouncing Boomerangs\u3011\n[\u5ba3\u4f20Blog](https://chen-jia-liang.gitee.io/blog/2020/10/18/%E9%A2%98%E8%A7%A3-CF1428D-%E3%80%90Bouncing-Boomerangs%E3%80%91/)\n## \u9898\u610f\n\u5728$n\\times n$\u7684\u7f51\u683c\u4e0a\uff0c\u6709\u82e5\u5e72\u76ee\u6807\u3002\u4ece\u6700\u4f4e\u4e0b\u6254\u56de\u65cb\u9556\uff0c\u78b0\u5230\u76ee\u6807\u4f1a\u53f3\u8f6c\u3002\u6bcf\u884c\u3001\u6bcf\u5217\u4e0d\u8d85\u8fc7\u4e24\u4e2a\u76ee\u6807\u3002\u73b0\u5728\u5df2\u77e5\u4ece\u6bcf\u4e00\u5217\u6254\u51fa\u53bb\u4f1a\u649e\u5230$a_i$\u4e2a\u969c\u788d($a_i\\le 3$)\uff0c\u8bf7\u6c42\u51fa\u4e00\u79cd\u5408\u6cd5\u65b9\u6848\u3002\n\n## \u9898\u89e3\n$\\color{red}\\texttt{Warning:}$\u7531\u4e8e\u672c\u4eba\u6bd4\u8f83\u5f31\uff0c\u7b97\u6cd5\u53ef\u80fd\u4f1a\u591a\u4e00\u53ea`log`\n\n\u9996\u5148~~\u901a\u8fc7\u753b\u56fe~~\u6211\u4eec\u53d1\u73b0\u4e00\u4e9b\u5947\u5947\u602a\u602a\u7684\u6784\u9020\u65b9\u6cd5\uff1a\n1. \u5982\u679c$a_i=0$\uff0c\u90a3\u4e48\u4e0d\u7528\u7ba1\u5b83\n1. \u5982\u679c$a_i=1$\uff0c\u90a3\u4e48\u53ef\u4ee5\u65b0\u5f00\u4e00\u5217\uff0c\u4e14\u6b64\u884c\u8fd8\u53ef\u4ee5\u6dfb\uff0c\u6b64\u5217\u4e5f\u8fd8\u53ef\u4ee5\u6dfb\n1. \u5982\u679c$a_i=2$\uff0c\u90a3\u4e48\u53ef\u4ee5\u627e\u4e00\u4e2a\u53ef\u4ee5\u6dfb\u7684\u5217\uff0c\u51fa\u73b0\u5728\u8fd9\u4e00\u5217\u7684\u884c\u5c31\u4e0d\u80fd\u6dfb\u4e86\n1. \u5982\u679c$a_i=3$\uff0c\u90a3\u4e48\u53ef\u4ee5\u65b0\u5f00\u4e00\u5217\uff0c\u5e76\u627e\u5230\u4e00\u4e2a\u53ef\u4ee5\u6dfb\u7684\u884c\u3002\u5728\u8fd9\u4e24\u884c\u6dfb\uff0c\u51fa\u73b0\u5728\u90a3\u884c\u7684\u5217\u5c31\u4e0d\u80fd\u6dfb\u4e86\u3002\n\n\u53ef\u80fd\u8bf4\u8d77\u6765\u6bd4\u8f83\u7ed5\uff0c\u89e3\u56fe\u7406\u89e3\u4e00\u4e0b$1,2,3$\n\n### $a_i=1$\n![](https://cdn.luogu.com.cn/upload/image_hosting/fqi3rjuj.png)\n\n\u663e\u7136\u6b64\u65f6\u7eff\u8272\u7684\u90fd\u53ef\u4ee5\u653e\u3002\n### $a_i=2$\n![](https://cdn.luogu.com.cn/upload/image_hosting/mtk19y15.png)\n\u6b64\u65f6\u7684`x`\u5fc5\u5b9a\u653e\u5728\u7eff\u8272\u7684\u5730\u65b9\u3002\u4e14`x`\u7684\u5de6\u8fb9\u90fd\u4e0d\u80fd\u653e\u3002\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u53f3\u8fb9\u7684`x`\u4e0a\u9762\u4e5f\u4e0d\u80fd\u653e\uff1a\n![](https://cdn.luogu.com.cn/upload/image_hosting/4vejiy2x.png)\n\n\u653e\u5728\u4e0a\u9762\u5fc5\u7136\u4f1a\u51fa\u73b0$4$\u4e2a\uff0c\u90a3\u65f6\u65e0\u610f\u4e49\u7684\u3002\n\n### $a_i=3$\n![](https://cdn.luogu.com.cn/upload/image_hosting/lf2t20mg.png)\n\n\u4e0a\u9762\u4e00\u884c\u4e0d\u80fd\u653e\u662f\u56e0\u4e3a$2$\u4e2a\u7684\u9650\u5236\uff0c\u800c\u4e0b\u9762\u7684`x`\u5de6\u8fb9\u4e0d\u80fd\u653e\u662f\u56e0\u4e3a\u653e\u4e86\u4f1a\u51fa\u73b0$4$\u4e2a\u7684\u60c5\u51b5\u3002\n\n## \u4ee3\u7801\n\u884c\u548c\u5217\u4e00\u76f4\u641e\u4e0d\u6e05\uff0c\u5199\u5f97\u6bd4\u8f83\u4e71\n```cpp\nint n,a[100000+10];\nint ans[100000+10][2];\nint low=0;//\u6700\u9ad8\u5217\nset<int>can1;//\u8fd8\u6709\u90a3\u4e9b\u884c\u5de6\u8fb9\u53ef\u4ee5\u6446\nset<int>can2;//\u8fd8\u6709\u90a3\u4e9b\u5217\u4e0a\u9762\u53ef\u4ee5\u52a0 \nint lst[100000+10];\nsigned main(){\n\tin::read(n);\n\tfor(int i=1;i<=n;i++)\n\t\tin::read(a[i]);\n\tfor(int i=n;i>=1;i--)\n\t\tif(a[i]==1){\n\t\t\t++low;\n\t\t\tans[i][0]=low;\n\t\t\tcan1.insert(low);\n\t\t\tlst[low]=i;\n\t\t\tcan2.insert(i);\n\t\t}\n\t\telse if(a[i]==2){\n\t\t\tif(!can1.size())\n\t\t\t\tputs(\"-1\"),exit(0);\n\t\t\tans[i][0]=*can1.begin();\n\t\t\tcan2.erase(lst[*can1.begin()]);\n\t\t\tcan1.erase(can1.begin());\n\t\t\tcan2.insert(i);\n\t\t} \n\t\telse if(a[i]==3){\n\t\t\tif(!can2.size())\n\t\t\t\tputs(\"-1\"),exit(0);\n\t\t\tlow++; \n\t\t\tans[i][0]=low;\n\t\t\tans[*can2.begin()][1]=low;\n\t\t\tcan1.erase(ans[*can2.begin()][0]);\n\t\t\tcan2.erase(can2.begin());\n\t\t\tcan2.insert(i);\n\t\t}\n\tint cnt=0;\n\tfor(int i=1;i<=n;i++){\n\t\tif(ans[i][0])cnt++;\n\t\tif(ans[i][1])cnt++;\n\t}\n\tprintf(\"%d\\n\",cnt);\n\tfor(int i=1;i<=n;i++){\n\t\tif(ans[i][0])printf(\"%d %d\\n\",n-ans[i][0]+1,i);\n\t\tif(ans[i][1])printf(\"%d %d\\n\",n-ans[i][1]+1,i);\n\t}\n\tout::flush();\n\treturn 0;\n}\n```",
        "postTime": 1602983969,
        "uid": 174304,
        "name": "jun\u5934\u5409\u5409",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1428D \u3010Bouncing Boomerangs\u3011"
    },
    {
        "content": "update\uff1a\u8fdc\u53e4\u9898\u89e3\u4e00\u5927\u5806\u683c\u5f0f\u9519\u8bef\uff0c\u8bd5\u56fe\u4e00\u4e2a\u4e2a\u4fee\u590d\u3002  \n\n\u770b\u5230\u5f88\u591a\u5927\u4f6c\u90fd\u662f\u4ece\u53f3\u5f80\u5de6\u626b\u7684\uff0c\u6211\u6765\u4e00\u4e2a\u4ece\u5de6\u5f80\u53f3\u626b\u7684\u3002  \n~~\u53ef\u80fd\u66f4\u96be\u60f3~~  \n\u8003\u8651\u5230\u8fd9\u9898 $a_i \\leq 3$ \u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8d2a\u5fc3\u6784\u9020\u3002\n\n`for (int i=1;i<=n;i++)`\n\n**1 $\\mathbf{a_i=0}$**\n\u5ffd\u7565\u4ed6\u3002\n\n**2   $\\mathbf{a_i=1/2/3}$**  \n\u90a3\u4e48\u9996\u5148\u8fd9\u4e00\u884c\u4e00\u5b9a\u81f3\u5c11\u6709\u4e00\u4e2a\uff08\u5e9f\u8bdd\uff09\u3002  \n\u90a3\u4e48\u6211\u4eec**\u5148\u5047\u8bbe**\u8fd9\u4e00\u884c\u7684\u6700\u4e0b\u9762\u7684\u76ee\u6807\uff0c$r$\u4e3a\u8fd8\u6ca1\u6709\u51fa\u73b0\u8fc7\u7684\u503c\u4e2d\u6700\u5c0f\u7684\u3002  \n\u6709\u70b9\u62bd\u8c61\uff0c\u53ef\u4ee5\u4e3e\u4f8b\u3002  \n\u6bd4\u5982\u4e4b\u524d\u51fa\u73b0\u8fc7 $1,1,2,3,4,2,3$\uff08\u968f\u624b\u6253\u7684\uff0c\u53ef\u80fd\u5e76\u4e0d\u5b58\u5728\uff09\uff0c\u90a3\u4e48\u5148\u628a\u5b83\u8bbe\u5b9a\u4e3a$5$\u3002\n\n\u90a3\u4e48\u80af\u5b9a\u4e0d\u4f1a\u5bf9\u524d\u9762\u4ea7\u751f\u5f71\u54cd\u3002  \n\n\n\u63a5\u7740\u8003\u8651\u4ed6\u4eec\u5bf9**\u540e\u7eed**\u7684\u5f71\u54cd  \n\n- $a_i=1$  \u65e0\u3002  \n- $a_i=2$  \u9700\u8981\u8fd9\u4e00\u884c\u5728\u540e\u9762\u8fd8\u6709\u76ee\u6807\u3002\n- $a_i=3$  \u9700\u8981\u5728\u8fd9\u4e00\u884c\u540e\u9762\u8fd8\u6709\u76ee\u6807\uff0c\u540c\u65f6\u8fd9\u4e2a\u76ee\u6807\u6240\u5728\u5217\u7684\u4e0b\u9762\u8fd8\u6709\u4e00\u4e2a\u76ee\u6807\u3002\n\n\u7528 ~~\u56fe~~ $\\LaTeX$\u753b\u56fe\u6765\u8bf4\u660e\n\n$a_i=2$ \u7684\u60c5\u51b5\uff1a\n$$\\ \\times \\to \\to \\to\\times$$\n$$\\ \\uparrow \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\downarrow$$\n$$\\ \\uparrow \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\downarrow$$\n\n$a_i=3$ \u7684\u60c5\u51b5\uff1a\n$$\\ \\ \\ \\ \\ \\ \\ \\ \\ \\times \\to \\to \\to \\times$$\n$$\\ \\ \\ \\ \\ \\ \\ \\ \\ \\uparrow \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\downarrow$$\n$$\\leftarrow \\ \\leftarrow \\ \\uparrow \\ \\ \\leftarrow \\leftarrow \\leftarrow \\times$$\n$$\\quad\\quad \\uparrow \\quad\\quad\\quad\\quad $$\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5728\u5904\u7406 $a_i=2/a_i=3$ \u7684\u65f6\u5019\u628a\u5b83\u52a0\u5165\u961f\u5217\u6216\u8005\u6808\u4ec0\u4e48\u7684\uff0c\u7b49\u4e00\u4e0b\u53ef\u4ee5\u5904\u7406\u4e86\u518d\u5904\u7406\u3002\u6ce8\u610f\uff0c\u8981\u52a0\u5165\u7684\u662f\u5904\u7406\u7684\u662f\u54ea\u4e00\u884c\u3002\uff08\u5217\u548c\u884c\u90fd\u52a0\u4e86\u4e5f\u6ca1\u95ee\u9898\u7684\uff09 \n\n\u4e3a\u4e86\u65b9\u4fbf\u8868\u793a\uff0c\u6211\u4eec\u5047\u8bbe\u52a0\u5165\u7684\u5217\u4e3a $j$\uff0c\u52a0\u5165\u7684\u884c\u4e3a $h_j$\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u6bcf\u79cd $a_i$ \u53ef\u4ee5\u5904\u7406\u4ec0\u4e48\u3002\n\n- $a_i=1$  \n\u53ef\u4ee5\u5904\u7406 $a_j=2$ \u548c $a_j=3$  \u3002  \n\u5bf9\u4e8e $a_j=2$ \u7684\u60c5\u51b5\uff0c\u628a\u6700\u4e0b\u9762\u7684\u76ee\u6807\u7684 $r$ \u6362\u6210 $h_j$ \u5373\u53ef\u3002  \n\u5bf9\u4e8e $a_j=3$ \u7684\u60c5\u51b5\uff0c\u9664\u4e86\u6700\u4e0b\u9762\u7684\u76ee\u6807\u5916\uff0c\u52a0\u4e00\u4e2a $h_j$ \u5373\u53ef\u3002  \n\n- $a_i=2$  \n\u53ef\u4ee5\u5904\u7406 $a_j=3$ \u7684\u60c5\u51b5\u3002  \n\u5bf9\u4e8e $a_j=2$ \u7684\u60c5\u51b5\uff1a  \n\u7531\u4e8e\u7b2c $h_j$ \u884c\u82e5\u5728 $i$ \u5217\u52a0\u5165\u76ee\u6807\uff0c\u5219\u7b2c $i$ \u5217\u6ca1\u6709\u6bd4 $h_j$ \u66f4\u4e0b\u9762\u7684\u76ee\u6807\u4e86\uff08\u4e0d\u7136\u4ece $j$ \u5c04\u5165\u7684\u98de\u9556\u4f1a\u8f6c $3$ \u6b21\uff09\u3002  \n\u90a3\u4e48\u518d\u8003\u8651\u5230 $i$ \u5217\u5c04\u5165\u7684\u98de\u9556\u540c\u6837\u8981\u8f6c $2$ \u904d\uff0c\u56e0\u6b64 $h_j$ \u884c\u4e4b\u540e\u8fd8\u9700\u8981\u6dfb\u52a0\u81f3\u5c11\u4e00\u4e2a\u76ee\u6807  \n\u90a3\u4e48\u8fdd\u53cd\u4e86\u9898\u76ee**\u6bcf\u4e00\u884c\u6216\u8005\u6bcf\u4e00\u5217\u4e0d\u80fd\u6709\u8d85\u8fc7 2 \u4e2a\u76ee\u6807**\u7684\u6761\u4ef6\u3002\n\n  \u5bf9\u4e8e $a_j=3$ \u7684\u60c5\u51b5\uff0c\u9664\u4e86\u6700\u4e0b\u9762\u7684\u76ee\u6807\u5916\uff0c\u52a0\u4e00\u4e2a $h_j$ \u5373\u53ef\u3002  \n\n- $a_i=3$  \n\u53ef\u4ee5\u5904\u7406 $a_j=3$ \u7684\u60c5\u51b5\u3002  \n\u4e0e $a_i=2$ \u7c7b\u4f3c\uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u3002\n\n\u7136\u540e\u6211\u4eec\u8003\u8651\u5230\u56e0\u4e3a $a_j=2$ \u53ea\u6709 $a_i=1$ \u624d\u80fd\u5904\u7406\uff0c\u56e0\u6b64\u5f53 $a_i=1$ \u65f6\u4f18\u5148\u5904\u7406 $a_j=2$ \u7684\u60c5\u51b5\uff0c\u5982\u679c\u6ca1\u6709\u518d\u5904\u7406 $a_j=3$ \u7684\u60c5\u51b5\u3002\n\n\u6700\u540e\uff0c\u5982\u679c\u53d1\u73b0\u8fd8\u6709 $2/3$ \u6ca1\u6709\u5904\u7406\uff0c\u90a3\u4e48\u8f93\u51fa `-1`\uff0c\u5426\u5219\u8f93\u51fa\u7b54\u6848\u3002\n\n**Tips**  \n- \u5bf9\u4e8e $a_i=2/3$ \u7684\u60c5\u51b5\uff0c\u522b\u5fd8\u4e86\u5904\u7406\u5b8c\u4e4b\u540e\u8fd8\u8981\u52a0\u5165\u961f\u5217\u3002\n- \u624b\u5199 stl \u7684\u6570\u7ec4\u8981\u5f00\u5230 $2 \\times n$\u3002  \n- \u7b54\u6848\u6570\u7ec4\u4e5f\u8981\u5f00\u5230 $2 \\times n$\u3002  \n- \u884c\u548c\u5217\u7684\u4e0b\u6807\u6bd4\u8f83\u5947\u602a\uff0c\u6ce8\u610f\u4e00\u4e0b\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=2e5+5;\n\n \nint n,H,cnt;\nint a[N];\nint c[N],r[N];\nint que2[N],que3[N],h[N];\nint hd2=1,tl2=0,hd3=1,tl3=0;\nvoid add(int x,int y){c[++cnt]=x;r[cnt]=y;}//\u52a0\u5165\u7b54\u6848\nvoid add2(int x){que2[++tl2]=x;}//\u52a0\u51652\u961f\u5217\nvoid add3(int x){que3[++tl3]=x;}//\u52a0\u51653\u961f\u5217\nsigned main()\n{\n\tcin>>n;\n\tH=0;\n\tfor (int i=1;i<=n;i++) cin>>a[i];\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tif (a[i]==0) continue;\n\t\tif (a[i]==1)\n\t\t{\n\t\t\t//\u5904\u74062\u7684\u95ee\u9898\uff0c\u5982\u679c\u6ca1\u6709\u5219\u5904\u74063\uff0c\u5982\u679c\u8fd8\u6ca1\u6709\u81ea\u5df1\u518d\u641e\u4e00\u884c \n\t\t\tif (hd2<=tl2)\n\t\t\t{\n\t\t\t\tint x=que2[hd2];\n\t\t\t\tadd(i,h[x]);hd2++;\n\t\t\t}\n\t\t\telse if (hd3<=tl3)\n\t\t\t{\n\t\t\t\tH++;\n\t\t\t\tint x=que3[hd3];\n\t\t\t\tadd(i,h[x]);\n\t\t\t\tadd(i,H);\n\t\t\t\thd3++;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tH++;\n\t\t\t\tadd(i,H);\n\t\t\t}\n\t\t}\n\t\tif (a[i]==2)\n\t\t{\n\t\t\t//\u5982\u679c\u67093\u5219\u5904\u74063\u7684\u95ee\u9898 \n\t\t\t//\u5c06\u70b9\u653e\u5165\u961f\u5217\n\t\t\tif (hd3<=tl3)\n\t\t\t{\n\t\t\t\tH++;\n\t\t\t\tint x=que3[hd3];\n\t\t\t\tadd(i,h[x]);add(i,H);hd3++;\n\t\t\t\tadd2(i);h[i]=H;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tH++;\n\t\t\t\tadd(i,H);\n\t\t\t\tadd2(i);h[i]=H;\n\t\t\t}\n\t\t}\n\t\tif (a[i]==3)\n\t\t{\n\t\t\t//\u5982\u679c\u67093\u5148\u5904\u74063\u7684\u95ee\u9898\n\t\t\t//\u5c06\u6b64\u70b9\u653e\u5165\u961f\u5217 \n\t\t\tif (hd3<=tl3)\n\t\t\t{\n\t\t\t\tH++;\n\t\t\t\tint x=que3[hd3];\n\t\t\t\tadd(i,h[x]);add(i,H);hd3++;\n\t\t\t\tadd3(i);h[i]=H;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tH++;\n\t\t\t\tadd(i,H);\n\t\t\t\tadd3(i);h[i]=H;\n\t\t\t}\t\t\n\t\t}\n\t}\n\tif (hd2<=tl2 || hd3<=tl3) //\u5982\u679c\u8fd8\u6ca1\u6709\u5904\u7406\u5b8c2\u548c3\u8f93\u51fa-1\n\t{\n\t\tcout<<-1<<endl;\n\t\treturn 0;\n\t}\n\tcout<<cnt<<endl;\n\tfor (int i=1;i<=cnt;i++) printf(\"%d %d\\n\",r[i],c[i]);\n}\n```",
        "postTime": 1603089028,
        "uid": 70132,
        "name": "AsunderSquall",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1428D \u3010Bouncing Boomerangs\u3011"
    },
    {
        "content": "[$\\text{\u66f4\u4f73\u7684\u9605\u8bfb\u4f53\u9a8c}$](https://www.cnblogs.com/do-while-true/p/13841797.html)\n\n# $\\mathcal{Translate}$\n\n[\u9898\u76ee\u94fe\u63a5](http://codeforces.com/problemset/problem/1428/D)\n\n\u5728\u4e00\u4e2a $n\\times n$ \u7684\u7f51\u683c\u56fe\u4e2d\uff0c\u5728\u4e0b\u9762\u7684\u6bcf\u4e00\u5217\u90fd\u4f1a\u5c04\u51fa\u4e00\u4e2a\u98de\u9556\uff0c\u5728 $n\\times n$ \u7684\u7f51\u683c\u56fe\u4e2d\u4f1a\u6709\u82e5\u5e72\u4e2a\u76ee\u6807\uff0c\u5982\u679c\u98de\u9556\u9047\u5230\u76ee\u6807\u5219\u987a\u65f6\u9488\u65cb\u8f6c $90^{\\circ}$ \u540e\u7ee7\u7eed\u98de\u884c\u76f4\u5230\u98de\u51fa\u7f51\u683c\u56fe\u3002\n\n\u89c4\u5b9a\u5728\u6bcf\u4e00\u884c\u6bcf\u4e00\u5217\u6700\u591a\u6709 $2$ \u4e2a\u76ee\u6807\uff0c\u7b2c $i$ \u884c\u7684\u98de\u9556\u4f1a\u65cb\u8f6c $a_i$ \u6b21\uff0c\u73b0\u7ed9\u5b9a $a_i$\uff0c \u6784\u9020\u51fa\u4e00\u7ec4\u5408\u6cd5\u7684\u89e3\uff08\u786e\u5b9a\u7f51\u683c\u56fe\u4e2d\u7684\u76ee\u6807\u7684\u4e2a\u6570\u548c\u4f4d\u7f6e\uff09\u3002\n\n$n\\leq 10^5,0\\leq a_i\\leq 3$\n\n\u51c9\u5fc3\u6784\u9020\u9898\u3002\n\n# $\\mathcal{Solution}$\n\n\u5bf9\u4e8e $a_i=0$\uff0c\u5ffd\u7565\u8fd9\u4e2a\u5730\u65b9\uff0c\u4e0d\u4f1a\u5bf9\u7b54\u6848\u4ea7\u751f\u4ec0\u4e48\u5f71\u54cd\u3002\n\n\u5148\u5904\u7406 $a_i=1$ \u7684\u60c5\u51b5\uff0c\u56e0\u4e3a $a_i=2,3$ \u4f1a\u4f9d\u9760\u53e6\u4e00\u5217\u6765\u8fdb\u884c\u7b2c\u4e8c\u3001\u4e09\u6b21\u53cd\u5f39\uff0c\u800c $a_i=1$ \u4e0d\u9700\u8981\u8003\u8651\uff0c\u76f4\u63a5\u51fa\u53bb\u5360\u7528\u4e00\u884c\u5c31\u53ef\u4ee5\u3002\u600e\u6837\u5360\u7528\u6700\u4f18\uff1f\u56e0\u4e3a\u5176\u5b83 $3$ \u5339\u914d\u8fd9\u4e2a $1$ \u8fdb\u884c\u4e09\u6b21\u53cd\u5f39\u7684\u65f6\u5019\u9700\u8981\u4e0a\u9762\u591a\u5f00\u4e00\u884c\uff0c\u6240\u4ee5\u4ece\u4e0b\u5f80\u4e0a\u4f9d\u6b21\u5360\u7528\u3002\n\n\u4ece\u5de6\u5f80\u53f3\u627e $a_i=2$\uff0c\u4e4b\u540e\u518d\u627e\u5230\u53f3\u8fb9\u7b2c\u4e00\u4e2a\u6ca1\u6709\u88ab\u524d\u9762\u7684 $2$ \u5339\u914d\u7684 $1$\uff0c\u5339\u914d\u5230\u4e00\u8d77\uff0c\u4e5f\u5c31\u662f\u5229\u7528\u8fd9\u4e2a $1$ \u7684\u8fd9\u4e00\u5217\u76ee\u6807\u8fdb\u884c\u7b2c\u4e8c\u6b21\u53cd\u5f39\u3002\n\n\u4e3a\u4ec0\u4e48\u627e\u53f3\u8fb9\u7b2c\u4e00\u4e2a $1$ \uff1f \u56e0\u4e3a $2$ \u9700\u8981\u53f3\u8fb9\u7684 $1$ \u6765\u53cd\u5f39\uff0c\u8d2a\u5fc3\u4e00\u4e0b\u662f\u9009\u5c3d\u91cf\u9760\u5de6\u7684\u66f4\u4f18\uff0c\u628a\u5c3d\u91cf\u9760\u53f3\u8ba9\u7ed9\u53f3\u8fb9\u7684 $2$\u3002\n\n\u4e3a\u4ec0\u4e48\u5148\u627e $a_i=2$\uff1f\u56e0\u4e3a $a_i=3$ \u53ef\u4ee5\u4f9d\u9760\u5176\u4ed6\u7684 $1,2,3$ \u8fdb\u884c $3$ \u6b21\u53cd\u8f6c\u3002\n\n\u6700\u540e\u5c31\u662f $a_i=3$ \u7684\u60c5\u51b5\uff0c\u5b83\u53ef\u4ee5\u6709\u4e09\u79cd\u65b9\u6cd5\u6765\u8fdb\u884c\u4e09\u6b21\u53cd\u5f39\uff1a\n\n1. \u53f3\u8fb9\u6ca1\u6709\u88ab\u5176\u5b83 $2,3$ \u5339\u914d\u7684 $1$\u3002\n\n2. \u53f3\u8fb9\u6ca1\u6709\u88ab\u5176\u5b83 $3$ \u5339\u914d\u7684 $2$\u3002\n\n3. \u53f3\u8fb9\u6ca1\u6709\u88ab\u5176\u5b83 $3$ \u5339\u914d\u7684 $3$\u3002\n\n\u56e0\u4e3a\u53ef\u4ee5\u4ece\u53f3\u8fb9\u7684 $3$ \u6765\u53cd\u5f39\uff0c\u6240\u4ee5\u8fd9\u91cc $3$ \u4ece\u540e\u5f80\u524d\u5339\u914d\u627e\u3002\n\n$a_i=2,3$ \u53bb\u5339\u914d\u7684\u65f6\u5019\u91c7\u7528\u53cc\u6307\u9488\u626b\uff0c\u4e00\u4e2a\u626b $a_i=2,3$\uff0c\u4e00\u4e2a\u626b\u54ea\u4e00\u4f4d\u53ef\u4ee5\u5339\u914d\u3002\u5982\u679c\u6ca1\u626b\u5230\u5c31\u662f\u65e0\u89e3\u3002\n\n# $\\mathcal{Code}$\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#define ll long long\n#define re register\n//#define int long long\ninline int Max(int x, int y) { return x > y ? x : y; }\ninline int Min(int x, int y) { return x < y ? x : y; }\ninline int Abs(int x) { return x < 0 ? ~x + 1 : x; }\ninline int read() {\n\tint r = 0;\n\tbool w = 0;\n\tchar ch = getchar();\n\twhile(ch < '0' || ch > '9') {\n\t\tif(ch == '-') w = 1;\n\t\tch = getchar();\n\t}\n\twhile(ch >= '0' && ch <= '9') {\n\t\tr = (r << 3) + (r << 1) + (ch ^ 48);\n\t\tch = getchar();\n\t}\n\treturn w ? ~r + 1 : r;\n}\n//#undef int\nconst int N = 300010;\nbool f;\nint n, a[N], cnt, ansx[N], ansy[N];\nbool vis[N];\nint row[N], rowcnt; \nsigned main() {\n\tn = read();\n\tfor(int i = 1; i <= n; ++i) a[i] = read();\n\t//\u5148\u628a\u6240\u6709\u76841\u4e00\u884c\u4e00\u884c\u5f00 \n\tfor(int i = 1; i <= n; ++i)\n\t\tif(a[i] == 1) ++cnt, ansx[cnt] = i, ansy[cnt] = ++rowcnt, row[i] = rowcnt;\n\tint pos = 1;\n\t//2\u548c\u53f3\u8fb9\u7b2c\u4e00\u4e2a1\u5339\u914d \n\tfor(int i = 1; i <= n; ++i) {\n\t\tif(a[i] == 2) {\n\t\t\tpos = Max(pos, i);\n\t\t\twhile(a[pos] != 1 && pos <= n) ++pos;\n\t\t\tif(pos == n + 1) {\n\t\t\t\tputs(\"-1\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\t++cnt;\n\t\t\tansx[cnt] = i, row[i] = ansy[cnt] = row[pos];\n\t\t\tvis[pos] = 1;\n\t\t\t++pos;\n\t\t}\n\t}\n\t//3\u548c\u53f3\u8fb9\u4e09\u79cd\u60c5\u51b5\u5339\u914d \n\tpos = n;\n\tfor(int i = n; i >= 1; --i) {\n\t\tif(a[i] == 3) {\n\t\t\twhile(!((a[pos] == 1 && !vis[pos]) || a[pos] == 2 || (a[pos] == 3 && row[pos])) && pos >= i) --pos;\n\t\t\tif(pos == i - 1) {\n\t\t\t\tputs(\"-1\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\t++cnt; ansx[cnt] = i, ansy[cnt] = ++rowcnt;\n\t\t\t++cnt; ansx[cnt] = pos, ansy[cnt] = rowcnt;\n\t\t\trow[i] = rowcnt;\n\t\t\t--pos;\n\t\t}\n\t}\n\t//\u65e0\u89e3 \n\tif(cnt > n << 1 || rowcnt > n) {\n\t\tputs(\"-1\");\n\t\treturn 0;\n\t}\n\tprintf(\"%d\\n\", cnt);\n\tfor(int i = 1; i <= cnt; ++i) printf(\"%d %d\\n\", n - ansy[i] + 1, ansx[i]);\n\treturn 0;\n}\n```\n",
        "postTime": 1603101882,
        "uid": 223298,
        "name": "do_while_true",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1428D \u3010Bouncing Boomerangs\u3011"
    },
    {
        "content": "## [\u9898\u610f](https://codeforces.com/contest/1428/problem/D)\n\n\u786e\u5b9e\u88ab\u8fd9\u9898\u6076\u5fc3\u5230\u4e86\uff0c\u5bfc\u81f4\u6211\u8d5b\u65f6\u5148\u5199\u7684E\u2026\u2026\n\n\u6211\u4eec\u6ce8\u610f\u5230 $a_i\\le3$\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5927\u529b\u5206\u7c7b\u8ba8\u8bba\u3002\n\n- $a_i=0$\uff0c\u76f4\u63a5\u5ffd\u7565\u5c31\u597d\u3002\n- $a_i=1$\uff0c\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u81f3\u5c11\u6709\u4e00\u4e2a\u76ee\u6807\u70b9\u3002\n- $a_i=2$\uff0c\u5b58\u5728 $i<j$ ,\u4f7f\u5f97 $j$ \u6700\u4e0b\u9762\u7684\u76ee\u6807\u70b9\u548c $i$ \u6700\u4e0b\u9762\u7684\u5904\u4e8e\u540c\u4e00\u884c\u3002\n- $a_i=3$\uff0c\u5b58\u5728 $i<j$ ,\u4f7f\u5f97 $j$ \u6700\u4e0a\u9762\u7684\u76ee\u6807\u70b9\u548c $i$ \u6700\u4e0b\u9762\u7684\u5904\u4e8e\u540c\u4e00\u884c\uff0c\u4e14 $j$ \u6709\u4e24\u4e2a\u76ee\u6807\u70b9\u3002\n\n\u8fd9\u6837\u68b3\u7406\u51fa\u6765\uff0c\u53d1\u73b0\u975e\u5e38\u4e0d\u53ef\u505a\uff0c\u6211\u4eec\u9700\u8981\u8f6c\u5316\u4e00\u4e0b\u9898\u610f\u3002\n\n\u6211\u4eec\u79f0 $a_i=2$ \u6216 $a_i=3$ \u7684 $<i,j>$ \u4e8c\u5143\u7ec4\u4e3a\u4e00\u5bf9 $<a_i,a_j>$ **\u5339\u914d**\u3002\n\n\u9996\u5148\u53ef\u4ee5\u6ce8\u610f\u5230\uff0c\u4e0d\u540c\u884c\u4e4b\u95f4\u7684\u987a\u5e8f\u4f3c\u4e4e\u662f \u201c\u56fa\u5b9a\u201d \u7684\u3002\n\n$a_i=3$ \u7684\u5339\u914d\u4e00\u5b9a\u662f\u5904\u4e8e\u9760\u4e0a\u7684\u4f4d\u7f6e\uff0c$a_i=2$ \u7684\u4e00\u5b9a\u6700\u9760\u4e0b\u3002\n\n\u540c\u65f6\u4e5f\u53d1\u73b0\uff0c\u5bf9\u4e8e $a_i$ \u76f8\u540c\u7684\u5339\u914d\uff0c\u5b83\u4eec\u884c\u4e4b\u95f4\u7684\u987a\u5e8f\u662f\u4efb\u610f\u7684\u3002\n\n\u518d\u52a0\u4e0a\u6bcf\u884c\u6700\u591a\u4e24\u4e2a\u5173\u952e\u70b9\u7684\u9650\u5236\uff0c\u6211\u4eec\u4e0d\u96be\u60f3\u5230\u4e00\u884c\u4e00\u884c\u5206\u5f00\u8003\u8651\u3002\n\n---\n\n**\u91cd\u70b9**\uff1a\u8003\u8651\u4e00\u4e0b\u5339\u914d\u7684\u5b9e\u8d28\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/7irk04y8.png)\n\n\u5982\u4e0a\u56fe\uff0c\u6a58\u8272\u6846\u4f4f\u4e86 $<3,1>$ \u5339\u914d\uff0c\u7ea2\u8272\u6846\u4f4f\u4e86 $<3,2>$ \u5339\u914d\uff0c\u84dd\u8272\u6846\u4f4f\u4e86 $<1,2>$ \u5339\u914d\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u4efb\u4f55\u4e00\u79cd\u5339\u914d\u90fd\u53ef\u4ee5\u88ab\u62c6\u5206\u6210\u82e5\u5e72\u5904\u4e8e\u540c\u4e00\u884c\u7684\u6570\u5bf9\u3002\n\n\u82e5\u662f\u5355\u4e2a $a_i=1$\uff0c\u5219\u53ef\u4ee5\u770b\u6210\u548c\u7a7a\u7684\u6570\u5bf9\uff0c\u79f0\u8fd9\u79cd\u6570\u5bf9\u4e3a\u865a\u6570\u5bf9\u3002\u5176\u4ed6\u7684\u4e3a\u5b9e\u6570\u5bf9\u3002\n\n\u90a3\u4e48 $<2,1>$ \u662f\u4e00\u4e2a\u6570\u5bf9\uff0c$<3,1>$ \u662f\u4e00\u4e2a\u5b9e\u6570\u5bf9\u548c\u4e00\u4e2a\u865a\u6570\u5bf9\uff0c$<3,2>$ \u662f\u4e24\u4e2a\u5b9e\u6570\u5bf9\uff0c$<3,3>$ \u7b49\u540c\u7406\u3002\n\n\u73b0\u5728\u6211\u4eec\u8981\u505a\u7684\u53ea\u662f\u914d\u597d\u5bf9\uff0c\u518d\u6309\u4e0a\u9762\u7684\u987a\u5e8f\u4f9d\u6b21\u628a\u8fd9\u4e9b\u6570\u5bf9\u653e\u5728\u5404\u4e2a\u884c\u4e0a\u9762\u3002\n\n---\n\n\u8fd8\u6709\u6700\u540e\u51e0\u4e2a\u95ee\u9898\uff1a\u914d\u5bf9\u7684\u987a\u5e8f\u4ee5\u53ca\u6709\u65e0\u89e3\u7684\u5224\u5b9a\u3002\n\n\u8fd9\u91cc\u6211\u7684\u601d\u8def\u548c\u5176\u4ed6\u9898\u89e3\u4e0d\u592a\u4e00\u6837\uff1a\u6211\u4eec\u53ef\u4ee5\u501f\u52a9\u6808\uff0c\u628a\u6240\u6709\u975e0\u7684\u6570**\u5012\u5e8f**\u538b\u6808\u3002\n\n\u8fd9\u6837\u6808\u9876\u4e00\u5b9a\u662f\u4e0b\u6807\u9760\u524d\u7684\u4f4d\u7f6e\u3002\n\n\u56e0\u4e3a\u975e0\u7684\u6570\u90fd\u53ef\u4ee5\u76f8\u4e92\u914d\u5bf9 ( \u9664 $<1,1>$)\uff0c\u8fd9\u6837\u505a\u4e00\u5b9a\u662f\u6b63\u786e\u7684\u3002\n\n\u6309\u7167\u4e0a\u9762\u7684\u987a\u5e8f\uff0c\u6211\u4eec\u9996\u5148\u8003\u8651 $a_i=3$ \u7684\u914d\u5bf9\u3002\n\n\u4e4b\u540e\u518d\u628a $a_i=1$ \u538b\u6808\uff0c\u8003\u8651 $<2,1>$ \u7684\u5339\u914d\u3002\n\n\u8fd9\u4e2a\u5730\u65b9\u6709\u5f88\u591a\u7ec6\u8282\uff0c\u5177\u4f53\u53ef\u4ee5\u770b\u4ee3\u7801\u548c\u6ce8\u91ca\u3002\n\n\u65e0\u89e3\u7684\u60c5\u51b5\uff0c\u4e00\u5b9a\u662f\u5b58\u5728 $a_i=2\\ $ \u6216 $\\ a_i=3$ \u6ca1\u6709\u914d\u5bf9\uff0c\u800c $a_i=1$ \u53ef\u4ee5\u548c\u7a7a\u914d\u5bf9\uff0c\u8bb0\u5f97\u52a0\u4e0a\u3002\n\n\u6700\u540e\u8f93\u51fa\u5c31\u53ef\u4ee5\u4e86\u3002\n\n### **\u73cd\u7231rating\uff0c\u8fdc\u79bb\u6bd2\u7624\u6784\u9020\u3002**\n\n---\n\n### Code:\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<vector>\nusing namespace std;\n#define PII pair<int,int>\n#define mp make_pair\nconst int N=1e5+9;\nint T,stk[N],top,n;\nint a[N],vis[N];\nvector<PII> ans;\nint main()\n{\n\tint now=0,pre=0,cnt=0,num=0;\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&a[i]);\t\n\tfor(int i=n;i>=1;i--) if(a[i]) stk[++top]=i;//\u538b\u6808\u4e00\u5b9a\u8981\u5012\u5e8f\n\tfor(int i=1;i<=n;i++)\n\t\tif(a[i]==3)\n\t\t{\n\t\t\twhile(stk[top]<=i&&top) top--;//\u627e\u5230 j>i \u7684\u4f4d\u7f6e\uff0c\u6ce8\u610f\u5224\u65ad\u975e\u7a7a\n\t\t\tif(top) \n\t\t\t{\n\t\t\t\tif(a[stk[top]]==1) vis[stk[top]]=2;//vis=2\u8868\u793a\u5df2\u7ecf\u5339\u914d\uff0c\u4f46\u9700\u8981\u6dfb\u52a0\u7a7a\u8282\u70b9\n\t\t\t\tvis[i]=true;\n\t\t\t\tans.push_back(mp(i,stk[top])),top--,++cnt,now++;\n\t\t\t}\n\t\t}\n\ttop=0;\n\tfor(int i=n;i>=1;i--) if(a[i]==1) stk[++top]=i;\n\tfor(int i=1;i<=n;i++)\n\t\tif(a[i]==2&&top&&!vis[i])\n\t\t{//\u540c\u4e0a\n\t\t\twhile(top&&stk[top]<i) --top;\n\t\t\twhile(top&&vis[stk[top]]) --top;//\u4e0d\u80fd\u548c\u5df2\u5339\u914d\u7684\u70b9\u5339\u914d\n\t\t\tif(!top) break;//attention\n\t\t\tvis[stk[top]]=vis[i]=true;\n\t\t\tans.push_back(mp(i,stk[top]));\n\t\t\t++cnt;--top;now++;\n\t\t}\n\ttop=0;\n\tfor(int i=1;i<=n;i++) \n\t\tif(vis[i]!=1&&a[i]==1) ans.push_back({i,0}),++now,++num;\n\t\telse if(!vis[i]&&(a[i]==2||a[i]==3)) {puts(\"-1\");return 0;}\n\tif(now>n){puts(\"-1\");return 0;}//\u8d85\u8fc7\u9650\u5236\n\tnow=1;\n\tprintf(\"%d\\n\",cnt*2+num);//num\u4e3a\u865a\u6570\u5bf9\uff0ccnt\u4e3a\u5b9e\u6570\u5bf9\n\tfor(auto i:ans)\n\t{\n\t\tprintf(\"%d %d\\n\",now,i.first);\n\t\tif(i.second) printf(\"%d %d\\n\",now,i.second);\n\t\tnow++;\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1603026677,
        "uid": 237308,
        "name": "AlanSP",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1428D"
    },
    {
        "content": "\u6784\u9020\u9898\u3002\n\n\u7531\u4e8e\u53f3\u8fb9\u7684\u70b9\u7b54\u6848\u4e0d\u4f1a\u88ab\u5de6\u8fb9\u70b9\u6539\u53d8\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f3a\u5236\u56fa\u5b9a\u53f3\u8fb9\u7684\u70b9\u3002\n\n\u628a\u56fa\u5b9a\u70b9\u5206\u4e3a\u4e24\u7c7b\uff1a\n\n$1.$ \u4efb\u610f\u56fa\u5b9a\u70b9\uff0c\u5f53\u4e14\u4ec5\u5f53\u56fa\u5b9a\u70b9\u7684 $a_i=1$ \u6b64\u65f6\u53ef\u4ee5\u4efb\u610f\u6dfb\u52a0\u5176\u4ed6\u5355\u72ec\u7684\u56fa\u5b9a\u70b9\uff08\u4e0a\u6216\u4e0b\uff09\u3002\n\n$2.$ \u9650\u5236\u56fa\u5b9a\u70b9\uff0c\u5373 $a_i=2,3$ \u6b64\u65f6\u53ea\u80fd\u5728\u4e0a\u65b9\u52a0\u70b9\uff0c\u4e0d\u80fd\u5728\u4e0b\u65b9\u52a0\u70b9\u3002\n\n\u518d\u6765\u5bf9\u4e8e $a_i$ \u5206\u7c7b\u8ba8\u8bba\u3002\n\n$a_i=0$\uff0c\u76f4\u63a5\u8df3\u8fc7\u8fd9\u4e00\u884c\u3002\n\n$a_i=1$\uff0c\u65b0\u5efa\u4e00\u4e2a\u70b9\uff0c\u4e0e\u4e4b\u524d\u7684\u6240\u6709\u70b9\u5750\u6807\u4e0d\u540c\uff0c\u5e76\u52a0\u5165\u4efb\u610f\u56fa\u5b9a\u70b9\u7684\u961f\u5217\u3002\n\n$a_i=2$\uff0c\u6b64\u65f6\u53ea\u80fd\u4e0e\u4e4b\u524d\u4e00\u4e2a\u4efb\u610f\u56fa\u5b9a\u70b9\u914d\u5bf9\uff0c\u5728\u4e0b\u65b9\u65b0\u5efa\u4e00\u4e2a\u70b9\uff0c\u4e0e $i$ \u5750\u6807\u76f8\u540c\uff0c\u5e76\u628a $i$ \u52a0\u5165\u9650\u5236\u56fa\u5b9a\u70b9\u961f\u5217\u3002\n\n$a_i=3$\uff0c\u6b64\u65f6\u9650\u5236\u4e0e\u4efb\u610f\u90fd\u53ef\u4ee5\uff0c\u4f46\u4e3a\u4e86\u6700\u4f18\uff0c\u6d88\u8017\u6709\u9650\u5236\u7684\u3002\u5728\u4e0a\u65b9\u65b0\u5efa\u70b9\uff0c\u5e76\u628a $i$ \u52a0\u5165\u9650\u5236\u56fa\u5b9a\u70b9\u961f\u5217\u3002\n\n\u5173\u4e8e\u7eb5\u5750\u6807\u7684\u5904\u7406\uff0c\u53ef\u4ee5\u7528\u4e24\u4e2a\u6307\u9488\u6216\u8005\u6700\u540e\u79bb\u6563\u5316\u4e00\u904d\u3002\n```cpp\n#include<bits/stdc++.h>\n#define re register\nusing namespace std;\ninline int read(){\n\tre int t=0;re char v=getchar();\n\twhile(v<'0')v=getchar();\n\twhile(v>='0')t=(t<<3)+(t<<1)+v-48,v=getchar();\n\treturn t;\n}\nint n,m,t,a[200002],b[200002],ans,pos[200002],l,r,aa[200002],bb[200002],cnt,s[200002];\nqueue<int>q[12];\nint main(){\n\tn=read();l=r=100000;++l;\n\tfor(re int i=1;i<=n;++i)s[i]=read();\n\tfor(re int i=n;i;--i){\n\t\tif(s[i]==0)continue;\n\t\telse if(s[i]==1){\n\t\t\tpos[i]=++r;\n\t\t\taa[++cnt]=i,bb[cnt]=r;\n\t\t\tq[1].push(i);\n\t\t}\n\t\telse if(s[i]==2){\n\t\t\tif(q[1].empty())return puts(\"-1\"),0;\n\t\t\tre int xx=q[1].front();\n\t\t\tq[1].pop();\n\t\t\tpos[i]=--l;\n\t\t\taa[++cnt]=xx,bb[cnt]=pos[i];\n\t\t\taa[++cnt]=i,bb[cnt]=pos[i];\n\t\t\tq[2].push(i);\n\t\t}\n\t\telse{\n\t\t\tif(q[2].empty()&&q[1].empty())return puts(\"-1\"),0;\n\t\t\tif(!q[2].empty()){\n\t\t\t\tre int xx=q[2].front();\n\t\t\t\tq[2].pop();\n\t\t\t\tpos[i]=++r;\n\t\t\t\taa[++cnt]=xx,bb[cnt]=pos[i];\n\t\t\t\taa[++cnt]=i,bb[cnt]=pos[i];\n\t\t\t}\n\t\t\telse{\n\t\t\t\tre int xx=q[1].front();\n\t\t\t\tq[1].pop();\n\t\t\t\tpos[i]=++r;\n\t\t\t\taa[++cnt]=xx,bb[cnt]=pos[i];\n\t\t\t\taa[++cnt]=i,bb[cnt]=pos[i];\n\t\t\t}\n\t\t\tq[2].push(i);\n\t\t}\n\t}\n\tprintf(\"%d\\n\",cnt);\n\tfor(re int i=1;i<=cnt;++i)bb[i]-=l-1,printf(\"%d %d\\n\",n-bb[i]+1,aa[i]);\n}\n```\n\n",
        "postTime": 1602999413,
        "uid": 41476,
        "name": "gyh20",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1428D \u3010Bouncing Boomerangs\u3011"
    },
    {
        "content": "$a_i=0$ \u4e0d\u8981\u8003\u8651\u3002\n\n\u8f93\u5165\u91cc\u6709\u4e00\u4e9b $a_i=3$ \u770b\u7684\u633a\u96be\u5904\u7406\u3002\u4f46\u662f\u89c2\u5bdf\u5230\u6240\u6709 $3$ \u7684\u5217\u53ef\u4ee5\u4e32\u5230\u4e00\u8d77\uff0c\u4ec5\u4ec5\u9700\u8981\u4e00\u4e2a $2-1$ \u6216\u8005\u4e00\u4e2a $1$ \u7ed3\u5c3e\uff0c\u5148\u5904\u7406\u5b8c\u8fd9\u4e2a\u3002\n\n\u7136\u540e\u5c31\u53ea\u9700\u8981\u5339\u914d $a_i=2$ \u548c $a_i=1$ \u4e86\uff0c\u53ef\u4ee5\u8d2a\u5fc3\u5339\u914d\u3002\n\n\u8d2a\u5fc3\u65b9\u6cd5\u662f\u6bcf\u4e00\u4e2a $a_i=2$ \u5339\u914d\u5230\u4ed6\u540e\u9762\u7684\u7b2c\u4e00\u4e2a $a_i=1$\u3002\u4e3a\u4ec0\u4e48\u8d2a\u5fc3\u6b63\u786e\uff1f\u5047\u8bbe\u5b58\u5728\u4e00\u4e2a\u5408\u6cd5\u5339\u914d\uff0c\u4e24\u4e2a $2-1$ \u5bf9\u76f8\u4ea4\u4e86\u3002\u4ea4\u6362\u4e00\u4e0b\u5b83\u4eec\u5bf9\u5e94\u7684 $1$\uff0c\u540e\u8005\u201c\u653e\u677e\u201d\u5339\u914d\uff0c\u80af\u5b9a\u4e0d\u4f1a\u8ba9\u5339\u914d\u53d8\u5f97\u4e0d\u5408\u6cd5\u3002\u4e8e\u662f\u8d2a\u5fc3\u80af\u5b9a\u4f1a\u9020\u51fa\u6765\u4e00\u4e2a\u5408\u6cd5\u5339\u914d\u3002\n\n\u5982\u679c\u8fd8\u5269\u4e0b $a_i=1$\uff0c\u53ef\u4ee5\u6446\u5230\u81ea\u5df1\u7684\u884c\u4e0a\u9762\u3002\n\n\u8d5b\u65f6\u4ee3\u7801\uff1a\n\n```cpp\n// writer: w33z8kqrqk8zzzx33\n#include <bits/stdc++.h>\nusing namespace std;\n\n// begin fast read template by CYJian (source: https://www.luogu.com.cn/paste/i11c3ppx)\n\nnamespace io {\n\tconst int __SIZE = (1 << 21) + 1;\n\tchar ibuf[__SIZE], *iS, *iT, obuf[__SIZE], *oS = obuf, *oT = oS + __SIZE - 1, __c, qu[55]; int __f, qr, _eof;\n\t#define Gc() (iS == iT ? (iT = (iS = ibuf) + fread (ibuf, 1, __SIZE, stdin), (iS == iT ? EOF : *iS ++)) : *iS ++)\n\tinline void flush () { fwrite (obuf, 1, oS - obuf, stdout), oS = obuf; }\n\tinline void gc (char &x) { x = Gc(); }\n\tinline void pc (char x) { *oS ++ = x; if (oS == oT) flush (); }\n\tinline void pstr (const char *s) { int __len = strlen(s); for (__f = 0; __f < __len; ++__f) pc (s[__f]); }\n\tinline void gstr (char *s) { for(__c = Gc(); __c < 32 || __c > 126 || __c == ' ';)  __c = Gc();\n\t\tfor(; __c > 31 && __c < 127 && __c != ' '; ++s, __c = Gc()) *s = __c; *s = 0; }\n\ttemplate <class I> inline bool gi (I &x) { _eof = 0;\n\t\tfor (__f = 1, __c = Gc(); (__c < '0' || __c > '9') && !_eof; __c = Gc()) { if (__c == '-') __f = -1; _eof |= __c == EOF; }\n\t\tfor (x = 0; __c <= '9' && __c >= '0' && !_eof; __c = Gc()) x = x * 10 + (__c & 15), _eof |= __c == EOF; x *= __f; return !_eof; }\n\ttemplate <class I> inline void print (I x) { if (!x) pc ('0'); if (x < 0) pc ('-'), x = -x;\n\t\twhile (x) qu[++ qr] = x % 10 + '0',  x /= 10; while (qr) pc (qu[qr --]); }\n\tstruct Flusher_ {~Flusher_(){flush();}}io_flusher_;\n} using io::pc; using io::gc; using io::pstr; using io::gstr; using io::gi; using io::print;\n\n// end fast read template by CYJian\n\n#define iter(i, a, b) for(int i=(a); i<(b); i++)\n#define rep(i, a) iter(i, 0, a)\n#define rep1(i, a) iter(i, 1, (a)+1)\n#define log(a) cerr<<\"\\033[32m[DEBUG] \"<<#a<<'='<<(a)<<\" @ line \"<<__LINE__<<\"\\033[0m\"<<endl\n#define all(a) a.begin(), a.end()\n#define fi first\n#define se second\n#define pb push_back\n#define mp make_pair\n \nusing ll=long long;\nusing pii=pair<int, int>;\n//#define int ll\nconst int MOD = 1000000007;\n\nset<int> one, two, three;\n\nsigned main() {\n    ios_base::sync_with_stdio(false); cin.tie(0);\n    int n; cin >> n;\n\trep1(i, n) {\n\t\tint v; cin >> v;\n\t\tif(v == 1) one.insert(i);\n\t\tif(v == 2) two.insert(i);\n\t\tif(v == 3) three.insert(i);\n\t}\n\tvector<pii> ans;\n\tint row = n;\n\tif(three.size()) {\n\t\tauto b = prev(three.end());\n\t\tauto twop = two.upper_bound(*b);\n\t\tif(twop == two.end() || one.upper_bound(*twop) == one.end()) {\n\t\t\tauto onep = one.upper_bound(*b);\n\t\t\tif(onep == one.end()) {\n\t\t\t\tcout << -1 << endl;\n\t\t\t\treturn 0;\n\t\t\t} else {\n\t\t\t\tvector<int> thee(all(three));\n\t\t\t\treverse(all(thee));\n\t\t\t\tint cur = *onep;\n\t\t\t\tfor(int t:thee) {\n\t\t\t\t\tans.pb({row, cur});\n\t\t\t\t\tans.pb({row-1, cur});\n\t\t\t\t\tcur = t;\n\t\t\t\t\trow--;\n\t\t\t\t}\n\t\t\t\tans.pb({row, cur});\n\t\t\t\tone.erase(onep);\n\t\t\t\trow--;\n\t\t\t}\n\t\t} else {\n\t\t\tauto onep = one.upper_bound(*twop);\n\t\t\tvector<int> thee(all(three));\n\t\t\treverse(all(thee));\n\t\t\tans.pb({row, *onep});\n\t\t\tint cur = *twop;\n\t\t\tfor(int t:thee) {\n\t\t\t\tans.pb({row, cur});\n\t\t\t\tans.pb({row-1, cur});\n\t\t\t\tcur = t;\n\t\t\t\trow--;\n\t\t\t}\n\t\t\tans.pb({row, cur});\n\t\t\ttwo.erase(twop);\n\t\t\tone.erase(onep);\n\t\t\trow--;\n\t\t}\n\t\tthree.clear();\n\t}\n\twhile(two.size()) {\n\t\tauto f = two.begin();\n\t\tif(!one.size()) {\n\t\t\tcout << -1 << endl;\n\t\t\treturn 0;\n\t\t}\n\t\tauto e = one.upper_bound(*f);\n\t\tif(e == one.end() || *f > *e) {\n\t\t\tcout << -1 << endl;\n\t\t\treturn 0;\n\t\t}\n\t\tans.pb({row, *f});\n\t\tans.pb({row, *e});\n\t\trow--;\n\t\ttwo.erase(f); one.erase(e);\n\t}\n\twhile(one.size()) {\n\t\tauto f = one.begin();\n\t\tans.pb({row, *f});\n\t\tone.erase(f);\n\t\trow--;\n\t}\n\tif(three.size() || two.size() || one.size()) cout << -1 << endl;\n\telse {\n\t\tcout << ans.size() << endl;\n\t\tfor(pii a:ans) cout << a.fi << ' ' << a.se << endl;\n\t}\n}\n```",
        "postTime": 1603003473,
        "uid": 220037,
        "name": "w33z8kqrqk8zzzx33",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1428D \u3010Bouncing Boomerangs\u3011"
    },
    {
        "content": "\u770b\u5230 $0\\leq a_i\\leq 3$\uff0c$\\text{sb}$ \u6784\u9020\u9898\u6ca1\u9519\u4e86\u3002\n\n\u8bbe $i<j$\uff0c\u8fdb\u884c\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n- $a_i=0$\uff0c\u4e0d\u653e\u3002\n\n- $a_i=1$\uff0c\u4e0d\u4e0e\u5176\u4ed6\u5217\u5b58\u5728\u5173\u8054\u3002\n\n- $a_i=2$\uff0c\u4e0e\u7b2c\u4e00\u4e2a $a_j=1$ \u7684\u5217\u5b58\u5728\u5173\u8054\u3002\n\n- $a_i=3$\uff0c\u4e0e\u67d0\u4e00 $a_j=1,2,3$ \u7684\u5217\u5b58\u5728\u5173\u8054\uff0c\u5176\u4e2d\u4f18\u5148\u9009\u62e9 $a_j=2,3$ \u7684\u5217\uff0c\u56e0\u4e3a $a_j=1$ \u7684\u5217\u53ef\u80fd\u8fd8\u4f1a\u5bf9 $a_i=2$ \u7684\u5217\u4ea7\u751f\u8d21\u732e\u3002\n\n\u81ea\u5df1\u753b\u51e0\u5f20\u56fe\u5176\u5b9e\u5c31\u77e5\u9053\u4e86\uff0c\u7136\u540e\u6839\u636e\u8fd9\u4e2a\u4ece $n\\sim 1$ \u5012\u5e8f\u8d2a\u5fc3\u5c31\u597d\u3002\n\n```cpp\n#include<cstdio>\n#include<stack>\n#include<functional>\n#define pr std::pair<int,int>\n#define mp(x,y) std::make_pair(x,y) \nstd::stack<pr> s1,s2,s3,ans;\nint a[100005];\ninline int read() {\n\tregister int x=0,f=1;register char s=getchar();\n\twhile(s>'9'||s<'0') {if(s=='-') f=-1;s=getchar();}\n\twhile(s>='0'&&s<='9') {x=x*10+s-'0';s=getchar();}\n\treturn x*f;\n}\nint main() {\n\tint n=read(),cur=n;\n\tfor(register int i=1;i<=n;++i) a[i]=read();\n\tfor(register int i=n;i;--i) {\n\t\tif(a[i]==0) continue;\n\t\tif(a[i]==1) {ans.push(mp(cur,i)); s1.push(mp(cur,i)); --cur;}\n\t\telse if(a[i]==2) {\n\t\t\tif(!s1.size()) {printf(\"-1\\n\"); return 0;}\n\t\t\tpr x=s1.top(); s1.pop(); s2.push(mp(x.first,i)); ans.push(mp(x.first,i)); --cur;\n\t\t}\n\t\telse {\n\t\t\tif(!s1.size()&&!s2.size()&&!s3.size()) {printf(\"-1\\n\"); return 0;}\n\t\t\tif(s2.size()) {pr x=s2.top(); s2.pop(); s3.push(mp(cur,i)); ans.push(mp(cur,x.second)); ans.push(mp(cur,i));}\n\t\t\telse if(s3.size()) {pr x=s3.top(); s3.pop(); s3.push(mp(cur,i)); ans.push(mp(cur,x.second)); ans.push(mp(cur,i));}\n\t\t\telse {pr x=s1.top(); s1.pop(); s3.push(mp(cur,i)); ans.push(mp(cur,x.second)); ans.push(mp(cur,i));}\n\t\t\t--cur;\n\t\t}\n\t} \n\tprintf(\"%d\\n\",ans.size());\n\tfor(;ans.size();ans.pop()) printf(\"%d %d\\n\",ans.top().first,ans.top().second);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1602998917,
        "uid": 95244,
        "name": "tommymio",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF1428D \u3010Bouncing Boomerangs\u3011"
    }
]
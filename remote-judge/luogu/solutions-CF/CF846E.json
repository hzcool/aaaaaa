[
    {
        "content": "\u8fd9\u4e5f\u662f\u4e00\u4e2a\u70ed\u8eab\u9898\uff08\n\n\u663e\u7136\u5efa\u51fa\u6765\u4e00\u68f5\u6811\u3002\u6211\u4eec\u8003\u8651\u6811\u5f62 DP\uff0c$dp_i$ \u8868\u793a\u5b50\u6811 $i$ \u9664\u4e86 $i$ \u90fd\u5408\u6cd5\u7684\u65f6\u5019\uff0c$i$ \u7684\u6700\u5927\u50a8\u5b58\u91cf\u3002\u8f6c\u79fb\u5c31\u626b\u4e00\u904d\u513f\u5b50\u4eec\uff0c\u5c11\u4e86\u7684\u5c31\u8865\uff0c\u591a\u4e86\u7684\u5c31\u8865\u4e0a\u53bb\uff0c\u5c31\u8fd9\u4e48\u7b80\u5355\u3002\n\n\u4f46\u662f\u8fd9\u9898\u96be\u70b9\u4e0d\u5728\u8fd9\u91cc\uff0c\u800c\u5728 DP \u503c\u53ef\u80fd\u5f88\u5927\u5f88\u5927\u3002\u8fd9\u65f6\u5019\u6211\u4eec\u8981\u60f3\u5404\u79cd\u89e3\u51b3\u63aa\u65bd\u3002\u4e00\u662f\u8bbe\u4e00\u4e2a\u65e0\u7a77\u5c0f\u503c\uff0c\u8d85\u8fc7\u8fd9\u4e2a\u503c\u5c31\u76f4\u63a5\u5224\u4e3a\u4e0d\u53ef\u80fd\u3002\u53e6\u4e00\u4e2a\u5c31\u662f `long double`\uff0c\u56e0\u4e3a\u592a\u5927\u7684\u65f6\u5019\u4e0d\u592a\u9700\u8981\u7cbe\u5ea6\u3002",
        "postTime": 1608559130,
        "uid": 138400,
        "name": "chenxia25",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF846E \u3010Chemistry in Berland\u3011"
    },
    {
        "content": "\u8fd9\u9898\u4e4d\u4e00\u770b\u662f\u4e00\u9053\u6c34\u6811\u5f62DP(\u5176\u5b9e\u4e8b\u5b9e\u4e0a\u5b83\u786e\u5b9e\u662f\u6811\u5f62DP)\uff0c\u7136\u540e\u8bbef[i]\u8868\u793a\u7b2ci\u4e2a\u70b9\u6240\u591a\u4f59/\u9700\u8981\u7684\u6750\u6599\uff0c\u7136\u540e\u6211\u4eec\u6109\u5feb\u7684\u5217\u51fa\u4e86\u5f0f\u5b50\uff1a\n```cpp\nif(f[v]<0)\n\tf[u] += f[v] * edges[c_e].dis;\nelse\n\tf[u] += f[v];\n```\n\u7136\u540e\u653e\u5230CF\u4e0a\uff0c\u76f4\u63a5WA\uff0c\u5341\u5206\u81ea\u95ed\uff0c\u4e8e\u662f\u6211\u8bd5\u56fedefine int long long\uff0c\u8fd8\u662f\u6ca1\u8fc7\uff0c\u4ed4\u7ec6\u4e00\u60f3(~~\u5077\u7784\u4e86\u4e00\u773cCF\u7684\u6570\u636e~~)\uff0c\u53d1\u73b0f\u6570\u7ec4\u6709\u53ef\u80fd\u4f1a\u7206long long\uff0c\u600e\u4e48\u529e\uff1f~~\u9ad8\u7cbe~~\uff1f \u663e\u7136\u8fd9\u4e0d\u592a\u73b0\u5b9e\uff0c\u4e8e\u662f\u60f3\u7740\u5982\u679c\u5b83\u8981\u7206\u4e86\u5c31\u628a\u5b83\u7f6e\u56de\u8fb9\u7f18\uff0c\u5b9e\u6d4b\u4e0d\u4f1aWA\n\n\u8d34\u4e2a\u4ee3\u7801  \n```cpp\n#include <cstdio>\n#define ll long long\n\nconst ll INF = (1ll << 62);\n\nusing namespace std;\n\ninline ll read(){\n    ll x = 0; int zf = 1; char ch = ' ';\n    while (ch != '-' && (ch < '0' || ch > '9')) ch = getchar();\n    if (ch == '-') zf = -1, ch = getchar();\n    while (ch >= '0' && ch <= '9') x = x * 10 + ch - '0', ch = getchar(); return x * zf;\n}\n\nstruct Edge{\n    int to; ll dis; int next;\n} edges[2000005];\n\nint head[2000005], edge_num = 0;\n\ninline void addEdge(int u, int v, ll dis){\n    edges[++edge_num] = (Edge){v, dis, head[u]};\n    head[u] = edge_num;\n}\n\nll a[2000005], b[2000005];\nll f[2000005];\n\nvoid DFS(int u){\n    //\u7f6e\u4e3a\u6240\u9700 \n    f[u] = b[u] - a[u];\n    for(int c_e = head[u]; c_e; c_e = edges[c_e].next){\n        int v = edges[c_e].to;\n        DFS(v);\n        if(f[v] < 0){\n            //\u9700\u8981 u \u53bb\u8865 \n            if (INF / edges[c_e].dis <= -f[v])\n                f[u] = -INF;\n            else{\n                f[u] += f[v] * edges[c_e].dis;\n                if (f[u] < -INF)\n                    f[u] = -INF;\n            }\n        }\n        else{\n            //\u53cd\u5411\u8f6c\u6362 \n            f[u] += f[v];\n        }\n    }\n}\n\nint main(){\n    int n = read();\n    for (int i = 1; i <= n; ++i)\n        b[i] = read();\n    for (int i = 1; i <= n; ++i)\n        a[i] = read();\n    for (int i = 2; i <= n; ++i){\n        int u = read(); ll dis = read();\n        addEdge(u, i, dis);\n    }\n    DFS(1);\n    if (f[1] >= 0)\n        printf(\"YES\");\n    else\n        printf(\"NO\");\n    return 0;\n}\n```",
        "postTime": 1557803669,
        "uid": 20462,
        "name": "lukelin",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF846E \u3010Chemistry in Berland\u3011"
    },
    {
        "content": "## CF846E Chemistry in Berland \u9898\u89e3\n\n[\u4f20\u9001\u95e8](https://codeforces.com/contest/846/problem/E)\n\n### \u9898\u610f\n\n\u6709 $n$ \u79cd\u6750\u6599\uff0c\u5b58\u5728 $n-1$ \u4e2a\u8f6c\u5316\u5173\u7cfb\uff0c\u5bf9\u4e8e $i\\ge 2$\uff0c\u6bcf $k_i$ \u4e2a $x_i$ \u53ef\u4ee5\u8f6c\u5316\u4e3a\u4e00\u4e2a $i$\uff0c\u6bcf\u4e00\u4e2a $i$ \u53ef\u4ee5\u8f6c\u5316\u4e3a\u4e00\u4e2a $x_i$\u3002\u73b0\u5728\u544a\u8bc9\u4f60\u6bcf\u79cd\u6750\u6599\u7684\u4f9b\u7ed9/\u9700\u6c42\uff0c\u95ee\u662f\u5426\u5b58\u5728\u4e00\u79cd\u8f6c\u5316\u65b9\u5f0f\u80fd\u6ee1\u8db3\u6240\u6709\u6750\u6599\u7684\u9700\u6c42\u3002\n\n$n\\le 10^5$\n\n### \u9898\u89e3\n\n\u4e0d\u96be\u770b\u51fa\u8f6c\u5316\u5173\u7cfb\u6784\u6210\u4e86\u4e00\u9897\u4ee5 $1$ \u4e3a\u6839\u7684\u6811\u3002\n\n\u90a3\u4e48\u6211\u4eec\u4ee4 $f_i$\u200b \u8868\u793a\u4ee5 $i$\u200b \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\uff0c**\u9664\u4e86 $i$\u200b** \u4ee5\u5916\u5176\u5b83\u8282\u70b9\u90fd\u6ee1\u8db3\u9700\u6c42\u65f6\uff0c $i$\u200b\u200b\u200b \u8fd9\u91cc\u6700\u591a\u80fd\u5c6f\u591a\u5c11\u6750\u6599\uff08\u5982\u679c\u503c\u4e3a\u8d1f\u5c31\u8868\u793a\u8fd8\u9700\u8981 $|f_v|$  \u7684\u6750\u6599\uff09\u3002\n\n\u90a3\u4e48\u7b54\u6848\u5c31\u662f $f_1$ \u662f\u5426\u5927\u4e8e\u7b49\u4e8e $0$\u3002\n\n\u5982\u4f55\u8f6c\u79fb\uff1f\u8003\u8651\u8d2a\u5fc3\uff1a\n\n\u513f\u5b50 $v$ \u591a\u51fa\u6765\u7684\u6750\u6599\u7ed9\u7236\u4eb2 $u$ \u4e00\u5b9a\u4e0d\u4f1a\u66f4\u52a3\uff0c\u90a3\u4e48\n\n- \u5982\u679c $f_v>0$\uff0c\u5c31\u4ee4 $f_u\\leftarrow f_u+f_v$\n\n\u5426\u5219\uff0c\u5c31\u8981\u8ba9\u7236\u4eb2\u53bb\u7ed9\u513f\u5b50\u586b\u6240\u7f3a\u7684\uff1a\n\n- \u5982\u679c $f_v<0$\u200b\uff0c\u5c31\u4ee4 $f_u\\leftarrow f_u+k_v\\cdot f_v$\u200b\uff08\u6ce8\u610f\u8fd9\u91cc $f_v$ \u662f\u8d1f\u6570\uff0c\u6240\u4ee5\u76f4\u63a5\u52a0\u5c31\u53ef\u4ee5\uff09\n\n\u6309\u7167\u4e0a\u8ff0\u8f6c\u79fb\u5373\u53ef\uff0c\u6ce8\u610f\u8282\u70b9 $i$ \u7684 $f_i$ \u521d\u59cb\u7b49\u4e8e$\\text{\u4f9b\u7ed9}-\\text{\u9700\u6c42}$\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nnamespace Acc{\n\tconst int N=1e5+9;\n\tstruct T{int v,w;};\n\tbasic_string<T>G[N];\n\tlong long a[N],b[N];\n\tlong double f[N];\n\tvoid dfs(int u){\n\t\tf[u]=b[u]-a[u];\n\t\tfor(auto[v,w]:G[u])if(dfs(v),f[v]>=0)f[u]+=f[v];else f[u]+=w*f[v];\n\t}\t\t\n\tvoid work(){\n\t\tint n,i,x,y;\n\t\tfor(cin>>n,i=1;i<=n;++i)cin>>b[i];\n\t\tfor(i=1;i<=n;++i)cin>>a[i];\n\t\tfor(i=2;i<=n;++i)cin>>x>>y,G[x]+={i,y};\n\t\tdfs(1),puts(f[1]>=0?\"YES\":\"NO\");\n\t}\n}\nint main(){return Acc::work(),0;}\n```\n\n### \u5c0f\u7ec6\u8282\n\n\u5728\u8fd0\u7b97\u8fc7\u7a0b\u4e2d\u4f1a\u70b8\u51fa `long long`\uff0c\u6240\u4ee5\u8981\u4e48\u8bbe\u7f6e\u4e00\u4e2a\u9608\u503c\uff0c\u8981\u4e48\u4f7f\u7528 `long double`\u3002\n\n",
        "postTime": 1628910370,
        "uid": 383079,
        "name": "Acc_Robin",
        "ccfLevel": 6,
        "title": "CF846E Chemistry in Berland \u9898\u89e3"
    },
    {
        "content": "\u4f60\u4f1a\u53d1\u73b0\u8fd9\u662f\u4e00\u9053\u7b80\u5355\u7684\u6811\u5f62 $\\text{dp}$\n\n\u81ea\u5e95\u5411\u4e0a $\\text{dfs}$ \u5373\u53ef\n\n\u67ff\u5b50\u4e5f\u5f88\u7b80\u5355:\n\n```cpp\nif(a[v]<0) a[u]+=a[v]*w\nelse a[u]+=a[v]\n```\n\n\u7136\u540e\u4f60\u4f1a\u53d1\u73b0\u8fd9\u4f1a\u70b8 $\\text{long long}$\uff0c\u4e8e\u662f\u6211\u4eec\u8bbe\u5b9a\u4e00\u4e2a $\\text{inf}$\n\n\u5982\u679c\u70b8\u4e86\u5c31\u628a\u5b83\u53d8\u6210\u6700\u5c0f\u503c\uff0c\u5176\u4ed6\u6ca1\u6709\u4ec0\u4e48\u6ce8\u610f\u70b9\u4e86\n\n**Code:**\n\n```cpp\nvoid dfs(int u)\n{\n\tfor(int i=0;i<e[u].size();i++)\n\t{\n\t\tint v=e[u][i].v,w=e[u][i].w;dfs(v);\n\t\tif(a[v]<0)\n\t\t{\n            if(inf/w<=-a[v])a[u]=-inf;\n            else a[u]+=a[v]*w,a[u]=max(a[u],-inf);\n\t\t}\n\t\telse a[u]+=a[v];\n\t}\n}\n```\n\n",
        "postTime": 1575000938,
        "uid": 53807,
        "name": "Erusel",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF846E \u3010Chemistry in Berland\u3011"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u9053\u6811\u5f62DP\n\n~~\u3010\u4f46\u662f\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u8001\u5e08\u8bf4\u662f\u6811\u4e0a\u5dee\u5206\u3011\u3010\u5c0f\u58f0BB\u3011~~\n\n\u505a\u6cd5\u5f88\u7b80\u5355\uff0c\u7ef4\u62a4\u4e00\u4e2adp[i]\u8868\u793a\u5f53\u524d\u503c\u4e0e\u76ee\u6807\u503c\u5dee\u8ddd\n\n\u5728\u5bf9i\u7ed3\u70b9dfs\u8fc7\u540e\uff1a\n\n\u5982\u679cdp[i]\u662f\u8d1f\u7684\uff0c\u5e76\u4e14\u7edd\u5bf9\u503c\u5728\uff081e7/\u8f6c\u6362\u7387\uff09\u4ee5\u5185\uff0c\u5c31\u5411i\u7684\u7236\u4eb2\u501f\n\n\u5982\u679cdp[i]\u662f\u8d1f\u7684\uff0c\u5e76\u4e14\u7edd\u5bf9\u503c\u5728\uff081e7/\u8f6c\u6362\u7387\uff09\u4ee5\u5916\uff0c\u76f4\u63a5\u5c06i\u7684\u7236\u4eb2\u8bbe\u4e3a\u8d1f\u65e0\u7a77\n\n\u56e0\u4e3a\u4f60\u518d\u600e\u4e48\u501f\u4e5f\u501f\u4e0d\u8fc7\n\n\uff08\u8282\u70b9\u4e2a\u6570*\u8282\u70b9\u6700\u5927\u503c/\u8f6c\u6362\u7387\uff09= 1e7\n\n\u8fd9\u4e48\u591a\n\n\u5982\u679c\u7ecf\u8fc7\u4e0a\u8ff0\u64cd\u4f5cdp[i]\u8fd8\u5927\u4e8e0\uff0c\u5c31\u628a\u4ed6\u4e22\u7ed9i\u7684\u7236\u4eb2\n\n\u56e0\u4e3ai\u4e5f\u7528\u4e0d\u4e0a\uff0ci\u7684\u7236\u4eb2\u53ef\u80fd\u4e0d\u591f\uff0c\u8981\u5411\u81ea\u5df1\u7684\u513f\u5b50\u7ed3\u70b9\u501f\uff0c\u8fd8\u4e0d\u5982\u76f4\u63a5\u7ed9\u7236\u4eb2\u7528\n\n\u6700\u540e\u770b\u4e00\u4e0bdp[1]\u662f\u5426\u5927\u4e8e0\u5c31\u597d\u4e86\uff08\u81ea\u5df1\u88abN-1\u4e2a\u7ed3\u70b9\u501f\u8fc7\u540e\u81ea\u5df1\u8fd8\u591f\u4e0d\u591f\uff09\n\n\u4e0a\u4ee3\u7801\uff1a\n\n\n\n\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#define LIMIT 1e17\nlong long head[200005],v[200005*2],nxt[200005*2],tot=1,w[200005],sub[200005],c[200005],d[200005],fa[200005],dp[200005],N;\nbool vis[200005],ok;\nvoid addedge(long long U,long long V,long long W){\n\tv[++tot]=V;\n\tnxt[tot]=head[U];\n\tw[tot]=W;\n\thead[U]=tot;\n}\nvoid dfs(long long x)\n{\n\tvis[x]=true;\n    dp[x]=c[x]-d[x];\n    for(int i=head[x];i;i=nxt[i])\n    {\n        dfs(v[i]);\n        if(dp[v[i]]<0)\n        {\n            if(-dp[v[i]]<LIMIT/w[i])\n                dp[x]+=dp[v[i]]*w[i];\n            else dp[x]=-LIMIT;\n            if(dp[x]<-LIMIT)\n                dp[x]=-LIMIT;\n        }\n        else dp[x]+=dp[v[i]];\n    }\n}\nint main(){\n\tfa[1]=0;\n\ttot=1;\n\tok=true;\n\tscanf(\"%lld\",&N);\n\tlong long x,k;\n\tfor(int i=1;i<=N;i++){\n\t\tscanf(\"%lld\",&c[i]);\n\t}\n\tfor(int i=1;i<=N;i++){\n\t\tscanf(\"%lld\",&d[i]);\n\t}\n\tfor(int i=2;i<=N;i++){\n\t\tscanf(\"%lld%lld\",&x,&k);\n \t\taddedge(x,i,k);\n\t}\n\tdfs(1);\n\tif(dp[1]>=0) printf(\"YES\\n\");\n\telse printf(\"NO\\n\");\n}\n```\n\n\u5b8c\u7ed3\u6492\u5c0ffafa~~~",
        "postTime": 1557821422,
        "uid": 62600,
        "name": "\u9f99\u5578\u7a7a",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF846E \u3010Chemistry in Berland\u3011"
    },
    {
        "content": "# Chemistry in Berland\n\u7ed9\u5b9a2\u4e2a\u957f\u5ea6\u4e3an\u7684\u5e8f\u5217a,b\uff0c\u8868\u793a\u5f53\u524d\u7684\u6750\u6599\u6570\u91cf\u548c\u76ee\u6807\u6750\u6599\u6570\u91cf\n\n\u7ed9\u51fan-1\u7ec4\u8f6c\u6362\u5173\u7cfb\uff0cXi,Ki\uff0c\u8868\u793aKi\u4e2aXi\u53ef\u4ee5\u8f6c\u6362\u4e3a1\u4e2ai\u4e141\u4e2ai\u53ef\u4ee5\u8f6c\u6362\u4e3a1\u4e2aXi\n\n\u6c42\u662f\u5426\u80fd\u6ee1\u8db3\u9700\u6c42\n## \u5e7f\u544a\u63d2\u5165\n\u5728\u6211\u7684\u535a\u5ba2\u91cc\u770b\u9898\u89e3\u4f7f\u7528\u6548\u679c\u66f4\u4f73\u54e6QwQ\n\n[\u6155\u5bb9\u7433\u7684\u540e\u82b1\u56ed](https://muronglin.top/hgoi-20190514/)\n\n[\u535a\u5ba2\u56ed(\u540c\u6b65\u66f4\u65b0)](https://www.cnblogs.com/muronglin/p/hgoi-20190514.html)\n## \u89e3\u6cd5\n\u9996\u5148\u5904\u7406\u4e00\u4e0b\u5e8f\u5217a,b\uff0c\u8ba9a[i]-=b[i]\uff0c\u76ee\u6807\u5c31\u662f\u4f7fa\u5e8f\u5217\u53d8\u6210\u975e\u8d1f\u5e8f\u5217\n\n\u628a\u8f6c\u6362\u5173\u7cfb\u770b\u6210\u4ee3\u4ef7\u4e3ak\u7684\u4ecex\u5230i\u7684\u8fb9\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u8dd1dfs\u4e86QAQ\n\n\u5bf9\u4e8e\u4e00\u4e2a\u70b9\uff0c\u8dd1\u5b8c\u4e86\u5b83\u7684\u6240\u6709\u513f\u5b50\u4e4b\u540e\uff0c\u5982\u679c\u5b83\u5df2\u7ecf\u6ee1\u8db3\uff0c\u628a\u591a\u7684\u7ed9\u5b83\u7238\n\n\u5982\u679c\u5b83\u4e0d\u6ee1\u8db3\uff0c\u5c31\u770b\u5b83\u7238\u80fd\u4e0d\u80fd\u8f6c\u7ed9\u4ed6\n\n\u4f18\u5148\u8f6c\u7ed9\u5b83\u7684\u4e00\u5b9a\u662f\u5b83\u513f\u5b50\uff0c\u56e0\u4e3a\u5b83\u513f\u5b50\u8f6c\u7ed9\u5b83\u662f1\u6bd41\uff0c\u5b83\u7238\u8f6c\u7ed9\u5b83\u662fk\u6bd41\n\n\u5982\u679c\u4ed6\u7238\u4e0d\u80fd\u8f6c\u7ed9\u5b83\uff0c\u5c31\u70b8\u4e86QWQ\n\n~~tips:\u4e58\u8d77\u6765\u4f1a\u7206long long\uff08\u5927\u96fe~~\n## ac\u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define inf 23333333333333333\nusing namespace std;\nstruct node{ll to,next,w;}e[100010];\nll n,cnt=0,x,y,a[100010],head[100010];\ndouble tmp;\nvoid add(ll i){e[++cnt]={i,head[x],y},head[x]=cnt;}\nvoid dfs(ll u,ll f,ll k)\n{\n\tfor(ll i=head[u];i;i=e[i].next)dfs(e[i].to,u,e[i].w);\n\tif(a[u]>=0)a[f]+=a[u];\n\telse\n\t{\n\t\ttmp=double(k)*double(a[u]);\n\t\tif(!f||tmp<-inf)puts(\"NO\"),exit(0);\n\t\ta[f]+=k*a[u];\n\t\tif(a[f]<-inf)puts(\"NO\"),exit(0);\n\t}\n}\nint main()\n{\n\tscanf(\"%lld\",&n);\n\tfor(ll i=1;i<=n;i++)scanf(\"%lld\",&a[i]);\n\tfor(ll i=1;i<=n;i++)scanf(\"%lld\",&x),a[i]-=x;\n\tfor(ll i=2;i<=n;i++)scanf(\"%lld%lld\",&x,&y),add(i);\n\tdfs(1,0,0),puts(\"YES\");\n\treturn 0;\n}\n```",
        "postTime": 1557808290,
        "uid": 24663,
        "name": "\u6ce0\u5c0f\u6bd2",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF846E \u3010Chemistry in Berland\u3011"
    }
]
[
    {
        "content": "\u6765\u83dc\u56ed\u91c7\u83dc\u554a $\\to $ [`George1123`](https://www.cnblogs.com/George1123/p/14162749.html)\n\n---\n\n## \u9898\u9762\n\n> [CF1458C Latin Square](https://www.luogu.com.cn/problem/CF1458C)\n\n> $T$ \u7ec4\u6d4b\u8bd5\u6570\u636e\uff0c\u6bcf\u6b21\u7ed9\u4e00\u4e2a $n\\times n$ \u7684\u77e9\u9635\uff0c\u6bcf\u884c\u6bcf\u5217\u90fd\u662f\u4e2a $1\\to n$ \u7684\u6392\u5217\u3002\u6709 $m$ \u6b21\u64cd\u4f5c\uff0c\u5982\u679c\u662f `UDLR` \u5c31\u662f\u8981\u628a\u6574\u4e2a\u77e9\u9635\u6bcf\u884c/\u6bcf\u5217\u5f80\u4e00\u4e2a\u65b9\u5411\u5faa\u73af\u79fb\u52a8\u4e00\u683c\u3002\u5982\u679c\u662f `IC`\uff0c\u5c31\u662f\u628a\u77e9\u9635\u6bcf\u884c/\u6bcf\u5217\u53d8\u6210\u539f\u6765\u7684\u9006\u77e9\u9635\u3002\u6c42\u6700\u540e\u7684\u77e9\u9635\u3002\n\n> \u6570\u636e\u8303\u56f4\uff1a$1\\le T\\le 1000$\uff0c$1\\le \\sum n\\le 1000$\uff0c$1\\le \\sum m\\le 10^5$\uff0c$1\\le a_{i,j}\\le n$\u3002\n\n---\n\n## \u9898\u89e3\n\n> \u521a\u624d\u6709\u4e2a\u7fa4\u53cb\u95ee\u6211 G \u83dc\u9e21\u53d1\u751f\u80be\u6478\u4e8b\u4e86\uff0c\u6211\u8bf4\u600e\u4e48\u56de\u4e8b\uff1f\u7ed9\u6211\u53d1\u4e86\u51e0\u5f20 `CF` \u5206\u6570\u5bf9\u6bd4\u56fe\uff0c\u6211\u4e00\u770b\uff01\u55f7\uff01\u539f\u6765\u662f\u6628\u5929\uff0c\u6211\u6253\u4e86\u4e00\u573a `CF`\uff0c\u7206\u96f6\u4e86\uff0c\u6389\u5206\u5230 `newbie` \uff0c\u53c8\u88ab\u5632\u8bbd\u4e86\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf\u4e0b\u6807\u4ece $0$ \u5f00\u59cb\uff0c\u5373 $i,j,a_{i,j}$ \u7684\u8303\u56f4\u90fd\u662f $[0,n)$\u3002\n\n\u5982\u679c\u53ea\u6709 `UDLR` \u64cd\u4f5c\uff0c\u7ef4\u62a4\u4e24\u4f4d\u7684\u9519\u4f4d\u5373\u53ef\u3002\n\n\u8fd9\u4e2a `IC` \u64cd\u4f5c\u6709\u5f88\u591a\u6027\u8d28\uff0c\u6bd4\u5982\u5148 `I` \u518d `C` \u548c\u76f4\u63a5 `I` \u5f62\u6210\u7684\u77e9\u9635\u6b63\u597d\u662f\u53f3\u4e0a-\u5de6\u4e0b\u7ffb\u8f6c\u5173\u7cfb\u3002\n\n\u5047\u5982\u628a\u4e00\u4e2a\u9898\u76ee\u4e2d\u63cf\u8ff0\u7684\u77e9\u9635\u770b\u6210 $n\\times n$ \u4e2a $(i,j,a_{i,j})$ \u4e09\u5143\u7ec4\u7ec4\u6210\u7684\u96c6\u5408\uff0c\u90a3\u4e48 `I` \u5c31\u662f\u8ba9\u6240\u6709 $(i,j,a_{i,j})$ \u53d8\u6210 $(i,a_{i,j},j)$\uff0c`C` \u5c31\u662f\u8ba9\u6240\u6709 $(i,j,a_{i,j})$ \u53d8\u6210 $(a_{i,j},j,i)$\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u4e09\u5143\u7ec4 $(i,j,k)$\uff0c\u6bcf\u6b21 `R` \u5c31\u662f\u8ba9\u5b83\u53d8\u6210 $(i,(j+1)\\bmod n,k)$\uff0c`LDU` \u540c\u7406\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u7ef4\u62a4\u5bf9\u4e8e\u6bcf\u4e2a\u4e09\u5143\u7ec4\uff0c\u539f\u6765\u7684 $3$ \u7ef4\u73b0\u5728\u53d8\u5230\u54ea\u4e86\uff0c\u4ee5\u53ca $3$ \u7ef4\u5f53\u524d\u5404\u6709\u591a\u5c11\u9519\u4f4d\u3002\n\n\u7531\u4e8e\u5bf9\u4e8e\u6bcf\u4e2a\u4e09\u5143\u7ec4\u60c5\u51b5\u662f\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u6bcf\u6b21 $\\Theta(1)$ \u7ef4\u62a4\u3002\n\n\u7136\u540e\u6700\u540e\u628a\u77e9\u9635\u6309\u53d8\u5316\u6784\u9020\u5373\u53ef\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n^2+m)$\u3002\n\n---\n\n## \u4ee3\u7801\n\n\u6211\u83dc\uff0c\u53c2\u8003\u4e86 `tourist` \u7684\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef double db;\n#define x first\n#define y second\n#define bg begin()\n#define ed end()\n#define pb push_back\n#define mp make_pair\n#define sz(a) int((a).size())\n#define R(i,n) for(int i(0);i<(n);++i)\n#define L(i,n) for(int i((n)-1);i>=0;--i)\nconst int iinf=0x3f3f3f3f;\nconst ll linf=0x3f3f3f3f3f3f3f3f;\n\n//Data\nconst int N=1000;\nint n,m,a[N][N][3],b[N][N];\nint p[3],o[3],f[3];\nstring str;\n\n//Main\nvoid Main(){\n    cin>>n>>m;\n    R(t,3) f[o[t]=t]=0;\n    R(i,n)R(j,n){\n        cin>>a[i][j][2],--a[i][j][2];\n        a[i][j][0]=i,a[i][j][1]=j;\n    }\n    cin>>str;\n    for(char c:str){\n        if(c=='R') f[1]++;\n        else if(c=='L') f[1]--;\n        else if(c=='D') f[0]++;\n        else if(c=='U') f[0]--;\n        else if(c=='I') swap(o[1],o[2]),swap(f[1],f[2]);\n        else if(c=='C') swap(o[0],o[2]),swap(f[0],f[2]);\n    }\n    R(i,3) (((f[i]%=n)+=n)%=n);\n    R(i,n)R(j,n){\n        R(t,3) p[t]=(a[i][j][o[t]]+f[t])%n;\n        b[p[0]][p[1]]=p[2];\n    }\n    R(i,n)R(j,n) cout<<b[i][j]+1<<\" \\n\"[n-j==1];\n    cout<<'\\n';  \n}\nint main(){\n    ios::sync_with_stdio(0);\n    cin.tie(0),cout.tie(0);\n    int t; for(cin>>t;t--;Main());\n    return 0;\n}\n```\n\n---\n\n**\u795d\u5927\u5bb6\u5b66\u4e60\u6109\u5feb\uff01**",
        "postTime": 1608430855,
        "uid": 118365,
        "name": "George1123",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1458C \u3010Latin Square\u3011"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u79cd\u53e6\u7c7b\u7684\u505a\u6cd5 qwq\n\n\u4ee5\u4e0b\u8ba8\u8bba\u5747\u5728\u6a21 $n$ \u610f\u4e49\u4e0b\u8fdb\u884c\u3002\n\n\u5982\u679c\u53ea\u6709 `U`\u3001`D`\u3001`L` \u548c `R` \u64cd\u4f5c\uff0c\u7ed9\u4e0a\u4e0b\u5e73\u79fb\u3001\u5de6\u53f3\u5e73\u79fb\u5206\u522b\u6253\u4e00\u4e2a\u6807\u8bb0\u5373\u53ef\u3002\n\n\u4f46\u662f\u672c\u9898\u8fd8\u6709 `I` \u64cd\u4f5c\u548c `C` \u64cd\u4f5c\u3002\u5047\u8bbe\u5f53\u524d $a_{i,j}=k$\uff0c\u7ecf\u8fc7 `RI` \u64cd\u4f5c\u5c31\u53d8\u6210\u4e86 $a_{i,k}=j+1$\u3002\u6240\u4ee5\u5728\u7ef4\u62a4 `I` \u64cd\u4f5c\u548c `C` \u64cd\u4f5c\u7684\u540c\u65f6\uff0c\u8fd8\u8981\u6253\u4e00\u4e2a\u5168\u5c40\u52a0\u7684\u6807\u8bb0\u3002\n\n\u6240\u4ee5\uff0c\u7b54\u6848\u53ef\u4ee5\u89c6\u4f5c\u539f\u77e9\u9635\u7ecf\u8fc7\u4e00\u5b9a\u7684 `I` \u64cd\u4f5c\u548c `C` \u64cd\u4f5c\uff0c\u518d\u5411\u4e0b\u5e73\u79fb $x$ \u683c\u3001\u5411\u53f3\u5e73\u79fb $y$ \u683c\u3001\u5168\u5c40\u52a0\u4e0a $z$ \u5f97\u5230\u7684\u3002\n\n\u8003\u8651\u6bcf\u79cd\u64cd\u4f5c\u4f1a\u8ba9 $x,y,z$ \u53d1\u751f\u600e\u6837\u7684\u53d8\u5316\uff1a\n\n- `U`\uff1a$a_{i,j}=k$ \u53d8\u4e3a $a_{i-1,j}=k$\u3002\u6267\u884c $x\\leftarrow x-1$ \u5373\u53ef\u3002\n- `D`\uff1a$a_{i,j}=k$ \u53d8\u4e3a $a_{i+1,j}=k$\u3002\u6267\u884c $x\\leftarrow x+1$ \u5373\u53ef\u3002\n- `L`\uff1a$a_{i,j}=k$ \u53d8\u4e3a $a_{i,j-1}=k$\u3002\u6267\u884c $y\\leftarrow y-1$ \u5373\u53ef\u3002\n- `R`\uff1a$a_{i,j}=k$ \u53d8\u4e3a $a_{i,j+1}=k$\u3002\u6267\u884c $y\\leftarrow y+1$ \u5373\u53ef\u3002\n- `I`\uff1a$a_{i,j}=k$ \u53d8\u4e3a $a_{i,k}=j$\u3002\u4ea4\u6362 $y,z$ \u5373\u53ef\u3002\n- `C`\uff1a$a_{i,j}=k$ \u53d8\u4e3a $a_{k,j}=i$\u3002\u4ea4\u6362 $x,z$ \u5373\u53ef\u3002\n\n\u4f46\u5728\u5411\u4e0b\u5e73\u79fb $x$ \u683c\u3001\u5411\u53f3\u5e73\u79fb $y$ \u683c\u3001\u5168\u5c40\u52a0\u4e0a $z$ \u4e4b\u524d\uff0c\u6211\u4eec\u8fd8\u8981\u7ef4\u62a4 `I` \u64cd\u4f5c\u548c `C` \u64cd\u4f5c\u3002\u628a\u64cd\u4f5c\u5e8f\u5217\u4e2d\u7684 `I` \u548c `C` \u63d0\u53d6\u51fa\u6765\uff0c\u7ec4\u6210\u4e00\u4e2a\u65b0\u7684\u5e8f\u5217\u3002\n\n\u7531\u4e8e `II` \u64cd\u4f5c\u548c `CC` \u64cd\u4f5c\u76f8\u5f53\u4e8e\u4ec0\u4e48\u90fd\u4e0d\u505a\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u65ad\u5730\u5220\u9664\u5e8f\u5217\u4e2d\u7684 `II` \u548c `CC`\u3002\u8fd9\u6837\u5f97\u5230\u7684\u5e8f\u5217\u4e00\u5b9a\u5f62\u5982 `ICIC...` \u6216 `CICI...`\u3002\n\n\u5230\u8fd9\u91cc\u6211\u4eec\u5361\u4f4f\u4e86\uff0c\u8fd9\u5e94\u8be5\u600e\u4e48\u7ef4\u62a4\u5462 qwq\n\n\u522b\u6025\uff0c\u8bbe\u4e00\u5f00\u59cb $a_{i,j}=k$\uff0c\u6211\u4eec\u4ee5 `ICIC...` \u4e3a\u4f8b\u627e\u627e\u89c4\u5f8b\uff1a\n\n- `I`\uff1a$a_{i,k}=j$\u3002\n- `C`\uff1a$a_{j,k}=i$\u3002\n- `I`\uff1a$a_{j,i}=k$\u3002\n- `C`\uff1a$a_{k,i}=j$\u3002\n- `I`\uff1a$a_{k,j}=i$\u3002\n- `C`\uff1a$a_{i,j}=k$\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u6267\u884c $6$ \u6b21\u64cd\u4f5c\u540e\uff0c\u77e9\u9635\u4f1a\u6062\u590d\u539f\u6837\u3002`CICI...` \u540c\u7406\u3002\u6240\u4ee5\uff0c\u628a\u5e8f\u5217\u7684\u957f\u5ea6\u6a21 $6$\uff0c\u7136\u540e\u66b4\u529b\u64cd\u4f5c\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(\\sum n^2+m)$\u3002\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\nint T,n,m,a[1005][1005],b[1005][1005],x,y,z,bg,cnt;\nchar s[100005];\nint main(){\n\tscanf(\"%d\",&T);\n\twhile(T--){\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tfor(int i=0;i<n;++i){\n\t\t\tfor(int j=0;j<n;++j){\n\t\t\t\tscanf(\"%d\",&a[i][j]);\n\t\t\t\t--a[i][j];\n\t\t\t}\n\t\t}\n\t\tscanf(\"%s\",s+1);\n\t\tx=y=z=cnt=0;\n\t\tfor(int i=1;i<=m;++i){\n\t\t\tif(s[i]=='U')x=(x-1+n)%n;\n\t\t\tif(s[i]=='D')x=(x+1)%n;\n\t\t\tif(s[i]=='L')y=(y-1+n)%n;\n\t\t\tif(s[i]=='R')y=(y+1)%n;\n\t\t\tif(s[i]=='I'){\n\t\t\t\tswap(y,z);\n\t\t\t\tif(!cnt)cnt=1,bg=0;\n\t\t\t\telse (cnt&1)^bg?--cnt:++cnt;\n\t\t\t}\n\t\t\tif(s[i]=='C'){\n\t\t\t\tswap(x,z);\n\t\t\t\tif(!cnt)cnt=1,bg=1;\n\t\t\t\telse (cnt&1)^bg?++cnt:--cnt;\n\t\t\t}\n\t\t}\n\t\tcnt%=6;\n\t\tfor(int k=1,kk=bg;k<=cnt;++k,kk^=1){\n\t\t\tif(kk==0)\n\t\t\t\tfor(int i=0;i<n;++i)\n\t\t\t\t\tfor(int j=0;j<n;++j)\n\t\t\t\t\t\tb[i][a[i][j]]=j;\n\t\t\telse\n\t\t\t\tfor(int i=0;i<n;++i)\n\t\t\t\t\tfor(int j=0;j<n;++j)\n\t\t\t\t\t\tb[a[i][j]][j]=i;\n\t\t\tfor(int i=0;i<n;++i)\n\t\t\t\tfor(int j=0;j<n;++j)\n\t\t\t\t\ta[i][j]=b[i][j];\n\t\t}\n\t\tfor(int i=0;i<n;++i)\n\t\t\tfor(int j=0;j<n;++j)\n\t\t\t\tprintf(\"%d%c\",(a[(i-x+n)%n][(j-y+n)%n]+z)%n+1,\" \\n\"[j==n-1]);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1611839048,
        "uid": 154520,
        "name": "chen_03",
        "ccfLevel": 9,
        "title": "CF1458C Latin Square \u9898\u89e3"
    },
    {
        "content": "\u73b0\u573a\u88ab\u8fd9\u9898\u533a\u5206\u4e86/kk\n\n\u9996\u5148\u8981\u660e\u786e\u7684\u4e00\u70b9\u662f LRUD \u548c IC \u80af\u5b9a\u4e0d\u662f\u540c\u4e00\u7c7b\u7684\u3002\u5982\u679c $s$ \u4e2d\u53ea\u5305\u542b LRUD\uff0c\u90a3\u6b64\u9898\u5c31\u53d8\u5f97\u5f02\u5e38\u7b80\u5355\u3002\u76f4\u63a5\u7ef4\u62a4\u4e24\u4e2a\u6807\u8bb0 $x,y$ \u8868\u793a\u884c/\u5217\u5206\u522b\u4f4d\u79fb\u4e86\u591a\u5c11\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u91cd\u5934\u620f\u5728\u4e8e I \u548c C\u3002\u9996\u5148\u6211\u4eec\u8981\u7406\u89e3 I \u548c C \u7684\u672c\u8d28\u3002\n\n\u5bf9\u4e8e\u6392\u5217 $p_1,p_2,\\dots,p_n$\uff0c\u6211\u4eec\u5982\u679c\u628a\u6bcf\u4e2a\u5143\u7d20\u770b\u4f5c\u4e00\u4e2a\u4e8c\u7ef4\u5750\u6807 $(i,p_i)$\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6392\u5217\u7684\u9006\u5143\u76f8\u5f53\u4e8e $(p_i,i)$\uff0c\u5373\u4ea4\u6362\u4e24\u7ef4\u5750\u6807\u7684\u503c\u3002\n\nI \u548c C \u4e5f\u662f\u5982\u6b64\u3002\u5982\u679c\u6211\u4eec\u628a\u8fd9\u4e2a\u77e9\u9635\u770b\u4f5c $n^2$ \u4e2a\u4e09\u7ef4\u7a7a\u95f4\u91cc\u7684\u70b9 $(i,j,a_{i,j})$\uff0c\u90a3\u4e48 I \u64cd\u4f5c\u5176\u5b9e\u5c31\u662f\u4ea4\u6362 x,z \u5750\u6807\u7684\u503c\uff0cC \u64cd\u4f5c\u5176\u5b9e\u662f\u4ea4\u6362 y,z \u7684\u503c\u3002\n\n\u8fd9\u6837\u4e00\u6765\u8fd9\u9898\u5c31\u5f88\u597d\u505a\u4e86\uff0c\u5bf9\u4e8e LRUD\uff0c\u8bb0\u5f55\u6bcf\u4e00\u7ef4\u7684\u589e\u91cf\uff0c\u5bf9\u4e8e IC\uff0c\u8bb0\u5f55\u5f53\u524d\u6bcf\u4e00\u7ef4\u662f\u539f\u6765\u7684\u7b2c\u51e0\u7ef4\uff0c\u8fd9\u6837\u6bcf\u4e2a\u64cd\u4f5c\u90fd\u53ef\u4ee5 $\\mathcal O(1)$ \u89e3\u51b3\u4e86\u3002\n\n\u770b\u5230\u6ca1\uff1f\u4ec0\u4e48\u8d85\u7eb2\u7684\u7b97\u6cd5\u90fd\u6ca1\u6709\u3002\u6240\u4ee5\u554a\uff0c\u83dc\u662f\u539f\u7f6a/kk\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define fz(i,a,b) for(int i=a;i<=b;i++)\n#define fd(i,a,b) for(int i=a;i>=b;i--)\n#define ffe(it,v) for(__typeof(v.begin()) it=v.begin();it!=v.end();it++)\n#define fi first\n#define se second\n#define fill0(a) memset(a,0,sizeof(a))\n#define fill1(a) memset(a,-1,sizeof(a))\n#define fillbig(a) memset(a,63,sizeof(a))\n#define pb push_back\n#define mp make_pair\ntypedef long long ll;\ntypedef unsigned long long ull;\ntemplate<typename T1,typename T2> void chkmin(T1 &x,T2 y){if(x>y) x=y;}\ntemplate<typename T1,typename T2> void chkmax(T1 &x,T2 y){if(x<y) x=y;}\ntemplate<typename T>\nvoid read(T &x){\n\tchar c=getchar();T neg=1;\n\twhile(!isdigit(c)){\n\t\tif(c=='-') neg=-1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c)) x=x*10+c-'0',c=getchar();\n\tx*=neg;\n}\nconst int MAXN=1000;\nconst int MAXM=1e5;\nint n,m,a[MAXN*MAXN+5][3],b[MAXN+5][MAXN+5],p[3],x[3];\nchar s[MAXM+5];\nvoid inc(int &x){x++;if(x>=n) x-=n;}\nvoid dec(int &x){x--;if(x<0) x+=n;}\nvoid solve(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n;i++) for(int j=1;j<=n;j++){\n\t\tscanf(\"%d\",&a[(i-1)*n+j][2]);\n\t\ta[(i-1)*n+j][0]=i;a[(i-1)*n+j][1]=j;\n\t}\n\tfor(int i=0;i<3;i++) p[i]=i,x[i]=0;scanf(\"%s\",s+1);\n\tfor(int i=1;i<=m;i++){\n\t\tif(s[i]=='U') dec(x[p[0]]);\n\t\tif(s[i]=='D') inc(x[p[0]]);\n\t\tif(s[i]=='L') dec(x[p[1]]);\n\t\tif(s[i]=='R') inc(x[p[1]]);\n\t\tif(s[i]=='I') swap(p[1],p[2]);\n\t\tif(s[i]=='C') swap(p[0],p[2]);\n\t}\n//\tfor(int j=0;j<3;j++) printf(\"%d\\n\",x[j]);\n\tfor(int i=1;i<=n*n;i++){\n\t\tfor(int j=0;j<3;j++) a[i][j]=(a[i][j]-1+x[j])%n+1;\n//\t\tfor(int j=0;j<3;j++) printf(\"%d \",a[i][j]);printf(\"\\n\");\n\t\tb[a[i][p[0]]][a[i][p[1]]]=a[i][p[2]];\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=n;j++) printf(\"%d \",b[i][j]);\n\t\tprintf(\"\\n\");\n\t}\n}\nsigned main(){\n\tint qu;scanf(\"%d\",&qu);\n\twhile(qu--) solve(); \n\treturn 0;\n}\n```",
        "postTime": 1608453831,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1458C \u3010Latin Square\u3011"
    },
    {
        "content": "\u6ce8\u610f\u5230 RLDU \u548c IC \u6839\u672c\u5c31\u4e0d\u662f\u4e00\u4e2a\u6027\u8d28\u7684\uff0c\u5f88\u96be\u4e00\u8d77\u5728\u77e9\u9635\u4e0a\u9762\u641e\u3002\u6211\u4eec\u8003\u8651\uff0c\u521d\u59cb\u7684\u6bcf\u4e2a\u683c\u5b50\u663e\u7136\u90fd\u5bf9\u7b54\u6848\u77e9\u9635\u7684\u6070\u597d\u4e00\u4e2a\u683c\u5b50\u505a\u51fa\u8d21\u732e\uff0c\u90a3\u4e48\u6211\u4eec\u8003\u8651\u62c6\u5f00\u5b83\u4eec\uff0c\u8003\u8651\u6bcf\u4e2a\u5355\u4e2a\u683c\u5b50\u5bf9\u7b54\u6848\u77e9\u9635\u7684\u8d21\u732e\u3002\n\n\u6211\u4eec\u8003\u8651\u628a\u4e00\u4e2a\u683c\u5b50\u770b\u6210\u4e09\u5143\u7ec4 $(i,j,a_{i,j})$\u3002\u90a3\u4e48 RL \u662f\u5728 $j$ \u4e0a\u9762\u589e\u51cf\uff0cDU \u662f\u5728 $i$ \u4e0a\u9762\u589e\u51cf\uff0cIC \u5219\u662f\u4ea4\u6362\u7b2c\u4e00\u4e09\u6216\u4e8c\u4e09\u7ef4\u3002\u6211\u4eec\u8003\u8651\u5bf9\u4e00\u5f00\u59cb\u7684 $n^2$ \u4e2a\u4e09\u5143\u7ec4\u6bcf\u4e2a\u5206\u522b\u7ef4\u62a4\u8fd9 $m$ \u6b21\u64cd\u4f5c\u3002\u4f18\u5316\u70b9\u5728\u4e8e\uff0c\u5c06\u64cd\u4f5c\u8f6c\u5316\u4e3a\u8fd9\u79cd\u62bd\u8c61\u7684\u4e8b\u60c5\u4e4b\u540e\uff0c\u53d8\u5f97\u53ef\u5408\u5e76\u4e86\uff0c\u5373\u5148\u540e\u82e5\u5e72\u4e2a\u64cd\u4f5c\u53ef\u4ee5\u538b\u7f29\u5230\u4e00\u4e2a\u65b0\u7684 $\\mathrm O(1)$ \u7684\u64cd\u4f5c\uff08\u8fd9\u4e2a\u5957\u8def\u7c7b\u4f3c\u4e8e\u77e9\u4e58\uff0c\u8fd8\u6709\u4e4b\u524d\u67d0\u6b21\u6d1b\u8c37\u6708\u8d5b\u7684 D2D\uff09\uff0c\u6765\u7528\u538b\u7f29\u64cd\u4f5c\u7684\u65f6\u95f4\u6362\u53d6\u5bf9\u6240\u6709\u5143\u7d20\u505a\u8fd9\u4e48\u591a\u6b21\u64cd\u4f5c\u7684\u65f6\u95f4\u3002\n\n\u90a3\u4e48\u6211\u4eec\u7ef4\u62a4\u8fd9\u4e9b\u64cd\u4f5c\u5408\u5e76\u8d77\u6765\u662f\u4ec0\u4e48\u6837\u5b50\u3002\u6bcf\u4e2a\u4e09\u5143\u7ec4\u53ef\u80fd\u67d0\u4e00\u7ef4\u4f1a\u88ab\u589e\u52a0\uff0c\u53ef\u80fd\u67d0\u4e24\u7ef4\u4f1a\u88ab\u4ea4\u6362\u3002\u90a3\u4e48\u6211\u4eec\u7ef4\u62a4\u539f\u5148\u7684\u6bcf\u4e00\u7ef4\u88ab\u52a0\u4e86\u591a\u5c11\uff0c\u7136\u540e\u73b0\u5728\u8dd1\u5230\u4e86\u54ea\u4e2a\u4f4d\u7f6e\u4e0a\u4e86\u5373\u53ef\u3002\u4ec0\u4e48\u90fd\u662f $\\mathrm O(1)$ \u7684\u3002\n\n**_[code](https://www.luogu.com.cn/paste/lmt11ap7)_**",
        "postTime": 1608440609,
        "uid": 138400,
        "name": "chenxia25",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1458C \u3010Latin Square\u3011"
    },
    {
        "content": "[\u9898\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF1458C)\u3002\n\n~~\u9898\u610f\u592a\u957f\u4e86\u4e0d\u60f3\u63cf\u8ff0\uff0c\u81ea\u5df1\u770b\u5427qwq~~\u3002\n\n\u8fd9\u9898\u597d\u795e\u554a\uff0c\u601d\u7ef4\u542b\u91cf\u771f\u7684\u9ad8 orz\u3002\n\n---\n\n### $Solution:$\n\n\u5f88\u663e\u7136\uff0c\u5982\u679c\u8fd9\u9898\u53ea\u6709 `RLDU` \u8fd9\u56db\u4e2a\u64cd\u4f5c\u7684\u8bdd\uff0c\u90a3\u4e48\u5c31\u662f\u4e00\u4e2a sb \u9898\uff0c\u76f4\u63a5\u7ef4\u62a4\u884c\u548c\u5217\u52a0\u4e86\u591a\u5c11\u5373\u53ef\u3002\n\n\u4f46\uff0c\u52a0\u4e0a `IC` \u64cd\u4f5c\u540e\uff0c\u8fd9\u9898\u5c31\u53d8\u5f97\u6709\u4e9b\u56f0\u96be\u4e86\u3002\n\n\u8003\u8651 `IC` \u64cd\u4f5c\u7684\u672c\u8d28\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5750\u6807 $(i, a_i)$\uff0c\u5176\u6c42\u9006\u64cd\u4f5c\u5176\u5b9e\u5c31\u662f\u53d8\u6210 $(a_i, i)$\u3002\n\n\u7167\u8fd9\u6837\uff0c\u6211\u4eec\u8003\u8651\u628a\u6bcf\u4e2a\u70b9\u770b\u6210\u4e00\u4e2a\u4e09\u7ef4\u5750\u6807 $(i, j, a_{i, j})$\u3002\u8fdb\u884c `I` \u64cd\u4f5c\u5c31\u76f8\u5f53\u4e8e\u4ea4\u6362 $y$ \u5750\u6807\u548c $z$ \u5750\u6807\uff0c\u8fdb\u884c `C` \u64cd\u4f5c\u5c31\u76f8\u5f53\u4e8e\u4ea4\u6362 $x$ \u548c $z$ \u5750\u6807\u3002\n\n\u4e8e\u662f\u6bcf\u6b21\u6211\u4eec\u90fd\u53ef\u4ee5\u5b58\u50a8\u8fd9\u4e2a $x, y, z$ \u5750\u6807\u73b0\u5728\u5bf9\u5e94\u7684\u662f\u4ec0\u4e48\u7c7b\u578b\uff0c\u6700\u540e\u52a0\u56de\u53bb\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u5f88\u663e\u7136\u6bcf\u4e00\u6b21\u64cd\u4f5c\u90fd\u662f $O(1)$ \u7684\uff0c\u6700\u540e\u5904\u7406\u4e5f\u662f $O(n \\times n)$ \u7684\u3002\n\nover\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^2 + m)$\u3002\u6ca1\u6709\u4efb\u4f55\u7684\u9ad8\u7ea7\u7b97\u6cd5\u7684\u601d\u7ef4\u9898\u5c5e\u5b9e\u5f3a\u3002\n\n---\n\n### $Code:$\n\n\u975e\u8d5b\u65f6\u4ee3\u7801\uff0c\u7801\u98ce\u53ef\u80fd\u6709\u4e00\u70b9\u4e0d\u540c\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n#include <cmath>\n#include <vector>\n#include <queue>\n#include <map>\n#include <set>\nusing namespace std;\n#define ll long long\n#define ull unsigned long long\n#define ld long double\n#define fi first\n#define se second\n#define dingyi int mid = l + r >> 1, ls = p << 1, rs = p << 1 | 1\n#define y0 y_csyakioi_0\n#define y1 y_csyakioi_1\n#define rep(i, x, y) for(int i = x; i <= y; ++i)\n#define per(i, x, y) for(int i = y; i >= x; --i)\ninline int read(){\n\tint x = 0, f = 1; char ch = getchar();\n\twhile(ch < '0' || ch > '9'){ if(ch == '-') f = -1; ch = getchar(); }\n\twhile(ch >= '0' && ch <= '9'){ x = x * 10 + (ch ^ 48); ch = getchar(); }\n\treturn x * f;\n}\nconst int N = 1010, M = 100010;\nint n, m, a[N * N][3], mov[10], pos[10], ans[N][N]; char s[M];\ninline int id(int x, int y){ return (x - 1) * n + y; }\ninline void work(){\n\tn = read(); m = read();\n\trep(i, 1, n) rep(j, 1, n){\n\t\tint k = id(i, j);\n\t\ta[k][0] = i; a[k][1] = j; a[k][2] = read();\n\t}\n\tscanf(\"%s\",  s + 1);\n\trep(i, 0, 2) pos[i] = i, mov[i] = 0;\n\trep(i, 1, m){\n\t\tif(s[i] == 'R') ++mov[pos[1]];\n\t\tif(s[i] == 'L') --mov[pos[1]];\n\t\tif(s[i] == 'D') ++mov[pos[0]];\n\t\tif(s[i] == 'U') --mov[pos[0]];\n\t\tif(s[i] == 'I') swap(pos[1], pos[2]);\n\t\tif(s[i] == 'C') swap(pos[0], pos[2]);\n\t}\n\trep(i, 1, n * n){\n\t\trep(j, 0, 2) a[i][j] = (a[i][j] + mov[j] - 1 + m * n) % n + 1;\n\t\tans[a[i][pos[0]]][a[i][pos[1]]] = a[i][pos[2]];\n\t}\n\trep(i, 1, n){\n\t\trep(j, 1, n){\n\t\t\tprintf(\"%d \", ans[i][j]);\n\t\t}\n\t\tputs(\"\");\n\t}\n}\nint main(){ int T = read(); while(T--) work(); return 0; }\n```\n",
        "postTime": 1608715805,
        "uid": 147999,
        "name": "Warriors_Cat",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1458C \u3010Latin Square\u3011"
    },
    {
        "content": "\u4e00\u79cd\u5c11\u89c1\u7684\u77e9\u9635\u53d8\u6362\u601d\u7ef4\u9898\u3002\n\n\u5728\u6b64\uff0c\u6211\u4eec\u4e0d\u518d\u8d58\u8ff0\u66b4\u529b\uff0c\u8003\u8651\u6b63\u89e3\u3002\n\n\u9996\u5148\uff0c\u5bf9\u4e8e\u9006\u6392\u5e8f\u5176\u5b9e\u5c31\u662f\u5c06\u4e00\u4e2a\u4f4d\u7f6e\u4e0a\u7684\u6570\u53d8\u4e3a\u8fd9\u4e2a\u6570\u7684\u884c\u6570\u6216\u5217\u6570\u5728\u539f\u6570\u7ec4\u4e2d\u6240\u5728\u884c\u6216\u5217\u51fa\u73b0\u7684\u5730\u5740\u3002\n\n\u4e5f\u5c31\u662f\u539f\u9898\u4e2d\u8bf4\u7684\uff1a$p_{q_i} = i, i \\in [1, n]$\n\n\u5b9a\u4e49\u539f\u6570\u7ec4\u4e3a $a$\uff0c\u4ee5 $a$ \u4e3a\u57fa\u7840\u6211\u4eec\u5b9a\u4e49\u4e09\u5143\u7ec4 $(x, y, z)$\uff0c\u8868\u793a\u5f53\u524d\u64cd\u4f5c\u4ee5\u540e $a_{(x, y)} = z, x \\in [1, n], y \\in [1, n]$\u3002\n\n\u90a3\u4e48\u4e0d\u96be\u53d1\u73b0\uff0c\u5bf9\u539f\u77e9\u9635\u8fdb\u884c\u64cd\u4f5c\u5176\u5b9e\u4e5f\u53ef\u4ee5\u8f6c\u5316\u6210\u5bf9\u4e09\u5143\u7ec4\u8fdb\u884c\u64cd\u4f5c\u3002\u5982\u4e0b\u3002\n\n- **R**\uff1a$(x, y, z)$ ---> $(x, y + 1, z)$\n- **L**\uff1a$(x, y, z)$ ---> $(x, y - 1, z)$\n- **D**\uff1a$(x, y, z)$ ---> $(x + 1, y, z)$\n- **U**\uff1a$(x, y, z)$ ---> $(x - 1, y, z)$\n- **I**\uff1a$(x, y, z)$ ---> $(x, z, y)$\n- **C**\uff1a$(x, y, z)$ ---> $(z, y, x)$\n\n\u5b9e\u5728\u4e0d\u7406\u89e3\u53ef\u4ee5\u81ea\u5df1\u624b\u6784\u4e00\u4e2a\u77e9\u9635\u6a21\u62df\u4e00\u4e0b\u3002\n\n\u5f88\u663e\u7136\u6bcf\u4e00\u4e2a\u64cd\u4f5c\u90fd\u4f1a\u5bf9\u6bcf\u4e00\u4e2a\u4e09\u5143\u7ec4\u4ea7\u751f\u5f71\u54cd\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ea\u9700\u8981\u7ef4\u62a4\u5bf9\u5e94\u4e09\u5143\u7ec4\u4e2d\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u53d8\u52a8\u91cf\u5373\u53ef\u3002\n\n\u5728\u64cd\u4f5c\u6267\u884c\u5b8c\u540e\uff0c\u679a\u4e3e $x, y$\uff0c\u5c31\u4f1a\u6709 $ans_{(f(x + \u0394x), f(y + \u0394y))} = f(z + \u0394z), x \\in [1, n], y \\in [1, n]$\u3002\n\n\u5176\u4e2d $f(x) = \\left\\{\\begin{array} \\\\ x \\mod n + n(x < 0) \\\\ n(n | x) \\\\ x \\mod n(x \\geq 0, n \\nmid x); \\end{array}\\right.$\n\n```cpp\n#include <cstdio>\n\nvoid Swap(int &x, int &y) {\n\tint t = x;\n\tx = y;\n\ty = t;\n}\n\nconst int MAXK = 5;\nconst int MAXN = 1005;\nconst int MAXL = 1e5 + 5;\nint a[MAXN][MAXN], op[MAXK], w[MAXK], n, m; \nchar s[MAXL];\nint ans[MAXN][MAXN];\n\nint Mod(int x) {\n\tif(x < 0)\n\t\treturn x % n + n;\n\telse {\n\t\tif(x % n == 0)\n\t\t\treturn n;\n\t\telse\n\t\t\treturn x % n;\t\t\n\t}\n}\n\nint main() {\n\tint t;\n\tscanf (\"%d\", &t);\n\twhile(t--) {\n\t\tscanf (\"%d %d\", &n, &m);\n\t\tfor(int i = 1; i <= n; i++)\n\t\t\tfor(int j = 1; j <= n; j++) \n\t\t\t\tscanf (\"%d\", &a[i][j]);\n\t\tfor(int i = 0; i <= 3; i++) \n\t\t\top[i] = i, w[i] = 0;\n\t\tscanf (\"%s\", s + 1);\n\t\tfor(int i = 1; i <= m; i++) {\n\t\t\tif(s[i] == 'R')\n\t\t\t\tw[op[2]]++;\n\t\t\telse if(s[i] == 'L')\n\t\t\t\tw[op[2]]--;\t\n\t\t\telse if(s[i] == 'D')\n\t\t\t\tw[op[1]]++;\n\t\t\telse if(s[i] == 'U')\n\t\t\t\tw[op[1]]--;\n\t\t\telse if(s[i] == 'I')\n\t\t\t\tSwap(op[2], op[3]);\n\t\t\telse if(s[i] == 'C')\n\t\t\t\tSwap(op[1], op[3]);\n\t\t}\n\t\tfor(int i = 1; i <= n; i++) \n\t\t\tfor(int j = 1; j <= n; j++) {\n\t\t\t\tint temp[MAXK] = {0, i, j, a[i][j]};\n\t\t\t\tans[Mod(temp[op[1]] + w[op[1]])][Mod(temp[op[2]] + w[op[2]])] = Mod(temp[op[3]] + w[op[3]]);\n\t\t\t}\n\t\tfor(int i = 1; i <= n; i++) {\n\t\t\tfor(int j = 1; j <= n; j++)\n\t\t\t\tprintf(\"%d \", ans[i][j]);\n\t\t\tprintf(\"\\n\");\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1609247212,
        "uid": 266779,
        "name": "STrAduts",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF1458C \u3010Latin Square\u3011"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\uff08\u6211\u8981\u8fdb\u6765\u54af\uff01\uff01\uff01\uff09](https://www.cnblogs.com/dysyn1314/p/14163636.html)\n\n# CF1458C Latin Square\n\n[\u9898\u76ee\u94fe\u63a5](http://codeforces.com/contest/1458/problem/C)\n\n## \u672c\u9898\u9898\u89e3\n\n\u53d1\u73b0 $\\texttt{RLDU}$ \u548c $\\texttt{IC}$ \u662f\u5b8c\u5168\u4e0d\u540c\u7684\u4e24\u7c7b\u64cd\u4f5c\uff0c\u5c06\u5b83\u4eec\u540c\u65f6\u7ef4\u62a4\u5f88\u56f0\u96be\u3002\n\n\u672c\u9898\u7684\u7a81\u7834\u53e3\u662f\uff1a\u521d\u59cb\u65f6\u7684\u6bcf\u4e2a\u683c\u5b50\uff0c\u6700\u7ec8\u90fd\u4f1a\u6070\u597d\u5bf9\u5e94\u7b54\u6848\u91cc\u7684\u4e00\u4e2a\u683c\u5b50\u3002\u4e8e\u662f\u6211\u4eec\u62c6\u5f00\u6765\u8003\u8651\u6bcf\u4e2a\u683c\u5b50\u5bf9\u7b54\u6848\u7684\u201c\u8d21\u732e\u201d\u3002\n\n\u628a\u4e00\u4e2a\u683c\u5b50\u770b\u6210\u4e09\u5143\u7ec4 $(i,j,a_{i,j})$\uff0c\u8003\u8651\u4e00\u6b21\u64cd\u4f5c\u4f1a\u5bf9\u8fd9\u4e2a\u4e09\u5143\u7ec4\u4ea7\u751f\u4ec0\u4e48\u6837\u7684\u5f71\u54cd\uff1a\n\n- $\\texttt{R}$\uff1a$(x, y, z) \\to (x,y + 1, z)$\u3002\u6ce8\u610f\uff0c\u8fd9\u91cc\u7684\u52a0\u6cd5\u662f\u5728 $\\bmod n$ \u610f\u4e49\u4e0b\u7684\uff0c\u4e0b\u540c\u3002\n- $\\texttt{L}$\uff1a$(x, y, z) \\to (x, y - 1, z)$\u3002\u6ce8\u610f\uff0c\u8fd9\u91cc\u7684\u51cf\u6cd5\u662f\u5728 $\\bmod n$ \u610f\u4e49\u4e0b\u7684\uff0c\u4e0b\u540c\u3002\n- $\\texttt{D}$\uff1a$(x, y, z) \\to (x + 1, y, z)$\u3002\n- $\\texttt{U}$\uff1a$(x, y, z)\\to (x - 1, y, z)$\u3002\n- $\\texttt{I}$\uff1a$(x, y, z)\\to (x, z, y)$\u3002\u5373\u4ea4\u6362 2, 3 \u4e24\u9879\u3002\n- $\\texttt{C}$\uff1a$(x, y, z)\\to (z, y, x)$\u3002\u5373\u4ea4\u6362 1, 3, \u4e24\u9879\u3002\n\n\u53d1\u73b0\u8f6c\u5316\u540e\uff0c\u8fd9 $6$ \u79cd\u5bf9\u4e09\u5143\u7ec4\u8fdb\u884c\u7684\u64cd\u4f5c\uff0c\u662f\u201c\u53ef\u5408\u5e76\u201d\u7684\u3002\n\n\u5177\u4f53\u5730\uff0c\u6211\u4eec\u904d\u5386\u8981\u8fdb\u884c\u7684 $m$ \u4e2a\u64cd\u4f5c\uff0c\u5c31\u80fd\u9884\u5904\u7406\u51fa\uff1a\u4f9d\u6b21\u8fdb\u884c\u8fd9\u4e9b\u64cd\u4f5c\u540e\uff0c\u4efb\u610f\u4e00\u4e2a\u521d\u59cb\u4e09\u5143\u7ec4\u4f1a\u4ea7\u751f\u4ec0\u4e48\u53d8\u5316\u3002\n\n\u7136\u540e\u679a\u4e3e\u6bcf\u4e2a\u683c\u5b50\uff0c\u5c06\u9884\u5904\u7406\u51fa\u7684\u53d8\u5316\u4f5c\u7528\u4e8e\u8fd9\u4e2a\u683c\u5b50\u4e0a\uff0c\u5c31\u80fd\u77e5\u9053\u8fd9\u4e2a\u683c\u5b50\u6700\u7ec8\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u662f\u4ec0\u4e48\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(m + n^2)$\u3002\n\n## \u53c2\u8003\u4ee3\u7801\n\n[\u5c0f\u592b\uff0c\u6211\u8981\u8fdb\u6765\u54af\uff01\uff01\uff01](https://www.cnblogs.com/dysyn1314/p/14163636.html)\n",
        "postTime": 1608449039,
        "uid": 100674,
        "name": "duyi",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1458C \u3010Latin Square\u3011"
    },
    {
        "content": "\u6a21\u62df\u8d5b\u8003\u4e86\u8fd9\u9898\uff0c\u8d5b\u65f6\u60f3\u51fa\u4e86\u4e00\u4e2a\u7528\u77e9\u9635\u4e58\u6cd5\u7684\u5c51\u505a\u6cd5\uff0c\u5e38\u6570\u5de8\u5927\uff0c\u6ca1\u60f3\u5230\u8fd8\u8dd1\u7684\u633a\u5feb\u3002\n\n## \u601d\u8def\n\u9996\u5148\u4e3a\u4e86\u65b9\u4fbf\u64cd\u4f5c\uff0c\u6211\u4eec\u8ba9\u77e9\u9635\u7684\u884c\u5217\u7f16\u53f7\u90fd\u4ece $0$ \u5f00\u59cb\uff0c\u5e76\u4e14\u8ba9\u6240\u6709\u5143\u7d20\u90fd\u51cf $1$\u3002\n\n\u524d $4$ \u4e2a\u64cd\u4f5c\u663e\u7136\u53ef\u4ee5\u7528\u77e9\u9635\u8868\u793a\u3002\u6211\u4eec\u628a $1$ \u4e2a\u5143\u7d20 $a_{i,j}$ \u5728\u77e9\u9635\u4e2d\u7684\u4f4d\u7f6e\u8868\u793a\u6210\u5411\u91cf $\\begin{bmatrix} i & j & 1 \\end{bmatrix}$\uff0c\u53d8\u6362\u77e9\u9635\u5982\u4e0b\uff1a\n$$\nR=\n\\begin{bmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & 1 & 1 \\\\\n\\end{bmatrix}\n,\nL=\n\\begin{bmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n0 & -1 & 1 \\\\\n\\end{bmatrix}\n,\nD=\n\\begin{bmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n1 & 0 & 1 \\\\\n\\end{bmatrix}\n,\nU=\n\\begin{bmatrix}\n1 & 0 & 0 \\\\\n0 & 1 & 0 \\\\\n-1 & 0 & 1 \\\\\n\\end{bmatrix}\n$$\n\n\u8003\u8651\u540e $2$ \u4e2a\u64cd\u4f5c\uff0c\u4e0d\u96be\u53d1\u73b0\u5bf9\u4e8e $1$ \u4e2a\u5143\u7d20 $a_{i,j}$\uff0c\u5bf9\u5176\u65bd\u52a0 $\\texttt{I}$ \u53d8\u6362\u7684\u672c\u8d28\u662f\u5c06\u5176\u5217\u7f16\u53f7\u548c\u503c\u4e92\u6362\u3002$\\texttt{C}$ \u53d8\u6362\u540c\u7406\u3002\n\n\u6240\u4ee5\u6211\u4eec\u6700\u7ec8\u5c06 $a_{i,j}$ \u8868\u793a\u6210\u5411\u91cf $\\begin{bmatrix} a_{i,j} & i & j & 1 \\end{bmatrix}$\uff0c\u5bb9\u6613\u5199\u51fa\u6240\u6709\u7684\u53d8\u6362\u77e9\u9635\uff1a\n$$\n\\begin{aligned}\n  & R=\n  \\begin{bmatrix}\n  1 & 0 & 0 & 0 \\\\\n  0 & 1 & 0 & 0 \\\\\n  0 & 0 & 1 & 0 \\\\\n  0 & 0 & 1 & 1 \\\\\n  \\end{bmatrix}\n  ,\n  L=\n  \\begin{bmatrix}\n  1 & 0 & 0 & 0 \\\\\n  0 & 1 & 0 & 0 \\\\\n  0 & 0 & 1 & 0 \\\\\n  0 & 0 & -1 & 1 \\\\\n  \\end{bmatrix}\n  ,\n  D=\n  \\begin{bmatrix}\n  1 & 0 & 0 & 0 \\\\\n  0 & 1 & 0 & 0 \\\\\n  0 & 0 & 1 & 0 \\\\\n  0 & 1 & 0 & 1 \\\\\n  \\end{bmatrix}\n  ,\n  U=\n  \\begin{bmatrix}\n  1 & 0 & 0 & 0 \\\\\n  0 & 1 & 0 & 0 \\\\\n  0 & 0 & 1 & 0 \\\\\n  0 & -1 & 0 & 1 \\\\\n  \\end{bmatrix}\n  , \\\\\n  &I=\n  \\begin{bmatrix}\n  0 & 0 & 1 & 0 \\\\\n  0 & 1 & 0 & 0 \\\\\n  1 & 0 & 0 & 0 \\\\\n  0 & 0 & 0 & 1 \\\\\n  \\end{bmatrix}\n  ,\n  C=\n  \\begin{bmatrix}\n  0 & 1 & 0 & 0 \\\\\n  1 & 0 & 0 & 0 \\\\\n  0 & 0 & 1 & 0 \\\\\n  0 & 0 & 0 & 1 \\\\\n  \\end{bmatrix}\n\\end{aligned}\n$$\n\n\u5bf9\u4e8e\u64cd\u4f5c\u5e8f\u5217\uff0c\u6211\u4eec\u6784\u9020\u51fa\u77e9\u9635\u540e\u76f4\u63a5\u7d2f\u4e58\u3002\u4e58\u6cd5\u5728\u6a21 $n$ \u610f\u4e49\u4e0b\u8fdb\u884c\u3002\n\n\u8bbe\u53d8\u6362\u5b8c\u7684\u77e9\u9635\u4e3a $b$\u3002\u5bf9\u4e8e $a_{i,j}$\uff0c\u6211\u4eec\u6784\u9020\u5411\u91cf $\\begin{bmatrix} a_{i,j} & i & j & 1 \\end{bmatrix}$\uff0c\u8bbe\u4e58\u4e0a\u53d8\u6362\u77e9\u9635\u540e\u7684\u5411\u91cf\u4e3a  $\\begin{bmatrix} c & x & y & 1 \\end{bmatrix}$\uff0c\u8ba9 $b_{x,y}\\leftarrow c$ \u5373\u53ef\u3002\n\n\u8f93\u51fa\u65f6\u8bb0\u5f97\u52a0 $1$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(nm)$\u3002\n\n## \u4ee3\u7801\n```cpp\n#include <cstdint>\n#include <iostream>\n\nusing i64 = int64_t;\nconstexpr size_t N = 1 << 10;\nconstexpr size_t M = 1 << 20;\n\nint n, m;\n\nstruct mat {\n    i64 _m[4][4];\n    constexpr mat() : _m{} {}\n    constexpr i64 &operator()(int i, int j) { return _m[i - 1][j - 1]; }\n    constexpr const i64 &operator()(int i, int j) const { return _m[i - 1][j - 1]; }\n    friend mat operator*(const mat &A, const mat &B) {\n        mat R;\n        for (int i = 1; i <= 4; i++) {\n            for (int k = 1; k <= 4; k++) {\n                for (int j = 1; j <= 4; j++) { R(i, j) = (R(i, j) + A(i, k) * B(k, j) % n + n) % n; }\n            }\n        }\n        return R;\n    }\n    constexpr static mat R() {\n        mat R;\n        R(1, 1) = 1;\n        R(2, 2) = 1;\n        R(3, 3) = 1;\n        R(4, 3) = R(4, 4) = 1;\n        return R;\n    }\n    constexpr static mat L() {\n        mat R;\n        R(1, 1) = 1;\n        R(2, 2) = 1;\n        R(3, 3) = 1;\n        R(4, 3) = -1, R(4, 4) = 1;\n        return R;\n    }\n    constexpr static mat D() {\n        mat R;\n        R(1, 1) = 1;\n        R(2, 2) = 1;\n        R(3, 3) = 1;\n        R(4, 2) = R(4, 4) = 1;\n        return R;\n    }\n    constexpr static mat U() {\n        mat R;\n        R(1, 1) = 1;\n        R(2, 2) = 1;\n        R(3, 3) = 1;\n        R(4, 2) = -1, R(4, 4) = 1;\n        return R;\n    }\n    constexpr static mat I() {\n        mat R;\n        R(1, 3) = 1;\n        R(2, 2) = 1;\n        R(3, 1) = 1;\n        R(4, 4) = 1;\n        return R;\n    }\n    constexpr static mat C() {\n        mat R;\n        R(1, 2) = 1;\n        R(2, 1) = 1;\n        R(3, 3) = 1;\n        R(4, 4) = 1;\n        return R;\n    }\n    constexpr static mat E() {\n        mat R;\n        for (int i = 1; i <= 4; i++) R(i, i) = 1;\n        return R;\n    }\n};\n\nint a[N][N], b[N][N];\nmat R = mat::R();\nmat L = mat::L();\nmat D = mat::D();\nmat U = mat::U();\nmat I = mat::I();\nmat C = mat::C();\n\nchar opt[M];\n\nint T;\n\nint main() {\n    std::ios::sync_with_stdio(false);\n    std::cin >> T;\n    while (T--) {\n        mat A = mat::E();\n        std::cin >> n >> m;\n        for (int i = 0; i < n; i++) {\n            for (int j = 0; j < n; j++) {\n                std::cin >> a[i][j];\n                a[i][j] -= 1;\n            }\n        }\n        std::cin >> opt;\n        for (int i = 0; i < m; i++) {\n            if (opt[i] == 'R') A = A * R;\n            if (opt[i] == 'L') A = A * L;\n            if (opt[i] == 'D') A = A * D;\n            if (opt[i] == 'U') A = A * U;\n            if (opt[i] == 'I') A = A * I;\n            if (opt[i] == 'C') A = A * C;\n        }\n        for (int i = 0; i < n; i++) {\n            for (int j = 0; j < n; j++) {\n                int a = ((::a[i][j] * A(1, 1) + i * A(2, 1) + j * A(3, 1) + A(4, 1)) % n + n) % n;\n                int x = ((::a[i][j] * A(1, 2) + i * A(2, 2) + j * A(3, 2) + A(4, 2)) % n + n) % n;\n                int y = ((::a[i][j] * A(1, 3) + i * A(2, 3) + j * A(3, 3) + A(4, 3)) % n + n) % n;\n                b[x][y] = a;\n            }\n        }\n        for (int i = 0; i < n; i++) {\n            for (int j = 0; j < n; j++) { std::cout << b[i][j] + 1 << \" \\n\"[j == n - 1]; }\n        }\n        std::cout << \"\\n\";\n    }\n    return 0;\n}\n```",
        "postTime": 1666782343,
        "uid": 329316,
        "name": "kernel_panic",
        "ccfLevel": 0,
        "title": "CF1458C \u9898\u89e3"
    },
    {
        "content": "## \u89e3\u6790\n\n\uff08\u4e0b\u9762\u4e3a\u4e86\u65b9\u4fbf\u9ed8\u8ba4\u77e9\u9635\u4e0b\u6807\u4ece $0$ \u5f00\u59cb\uff0c\u5e76\u4e14\u77e9\u9635\u5143\u7d20\u7684\u503c\u90fd\u51cf $1$\uff08\u5373\u9650\u5236\u5728 $[0, n-1]$ \u5185\uff09\uff09\n\n\u8003\u8651\u5c06\u77e9\u9635\u7684 $a[i][j]$ \u89c6\u4e3a\u4e00\u4e2a\u4e09\u5143\u7ec4 $(i, j, a[i][j])$\n\n\u524d\u56db\u79cd\u64cd\u4f5c\u90fd\u6bd4\u8f83\u7b80\u5355\u3002\u800c\u540e\u4e24\u79cd\u64cd\u4f5c\u53ef\u4ee5\u53d1\u73b0\u5b9e\u8d28\u4e0a\u5c31\u662f\u4ea4\u6362\u4e09\u5143\u7ec4\u7684 \u7b2c $2, 3$ \u4e2a\u5143\u7d20\uff08`I`\uff09\u548c \u7b2c $1, 3$ \u4e2a\u5143\u7d20\uff08`C`\uff09\n\n\u63a5\u7740\u4e0d\u96be\u60f3\u5230\u5c06\u4e09\u5143\u7ec4\u89c6\u4e3a\u4e00\u4e2a\u5411\u91cf\uff0c\u5404\u79cd\u53d8\u6362\u5219\u89c6\u4e3a\u77e9\u9635\uff08\u5f53\u7136\u77e9\u4e58\u8981\u5728\u6a21 $n$ \u7684\u610f\u4e49\u4e0b\u8fdb\u884c\uff09\uff0c\u8fd9\u6837\u5c31\u505a\u5b8c\u4e86\n\n\uff08\u5f53\u7136\u4e0d\u60f3\u5927\u5e38\u6570\u77e9\u9635\u641e\u4e5f\u53ef\u4ee5\uff1b\u5c31\u662f\u8ba8\u8bba\u53ef\u80fd\u4f1a\u6709\u4e9b\u9ebb\u70e6\uff09\n\n\u5177\u4f53\u5b9e\u73b0\u53ef\u80fd\u9700\u8981\u4e00\u4e9b trick\u3002\u9996\u5148\u5c06\u53d8\u6362 `I` \u548c `C` \u505a\u6210\u4e00\u4e2a\u4e09\u7ef4\u77e9\u9635\u5f88\u663e\u7136\uff0c\u4f46\u524d\u9762\u56db\u4e2a\u53d8\u6362\u5c31\u6ca1\u6cd5\u8868\u793a\u6210\u4e09\u7ef4\u77e9\u9635\uff1b\u8fd9\u65f6\u53ef\u4ee5\u8003\u8651\u7ed9\u4e09\u5143\u7ec4\u518d\u52a0\u4e00\u7ef4\uff0c\u4e14\u8fd9\u7ef4\u7684\u503c\u6052\u4e3a $1$\uff0c\u5373 $(i, j, a[i][j], 1)$\uff0c\u8fd9\u6837\u518d\u7528\u56db\u7ef4\u77e9\u9635\u5c31\u53ef\u4ee5\u8868\u793a\u524d\u56db\u79cd\u53d8\u6362\u4e86\n\n\uff08\u5176\u5b9e\u611f\u89c9\u8fd9\u4e2a trick \u8fd8\u86ee\u5e38\u89c1\u7684\uff09\n\n\u8fd8\u6709\u7591\u95ee\u53ef\u4ee5\u53c2\u8003\u4ee3\u7801\uff0c\u611f\u89c9\u5e94\u8be5\u4e0d\u96be\u770b\u61c2\n\n## CODE\n\n```cpp\n#include <cstdio>\n#include <cstring>\n\nconst int MAXN =1010, MAXM =1e5+20;\n\n/*------------------------------IO------------------------------*/\n\nint read(){\n\tint x =0; char c =getchar(); bool f =0;\n\twhile(c < '0' || c > '9') (c == '-') ? f =1, c =getchar() : c =getchar();\n\twhile(c >= '0' && c <= '9') x =(x<<1)+(x<<3)+(48^c), c =getchar();\n\treturn (f) ? -x : x;\n}\n\nvoid write(const int &x){\n\tif(x/10)\n\t\twrite(x/10);\n\tputchar('0'+x%10);\n}\n\nvoid read_string(char *s){\n\tchar ch =getchar();\n\twhile(ch < 'A' && ch > 'Z')\n\t\tch =getchar();\n\tint tot =0;\n\twhile(ch >= 'A' && ch <= 'Z')\n\t\ts[tot++] =ch, ch =getchar();\n}\n\n/*------------------------------Matrix------------------------------*/\n\nnamespace Matrix{\n\tconst int MAXS =4;\n\tint M;\n\t\n\tstruct Mx{\n\t\tint r, c;\n\t\tint matrix[MAXS][MAXS]/*row, column*/;\n\t\t\n\t\tMx(){\n\t\t\tmemset(matrix, 0, sizeof(matrix));\n\t\t}\n\t\tMx(const int &n, const int &m):r(n), c(m){\n\t\t\tmemset(matrix, 0, sizeof(matrix));\n\t\t}\n\t\tMx(const int &n, const char *typ):r(n), c(n){\n\t\t\tmemset(matrix, 0, sizeof(matrix));\n\t\t\tif(typ[0] == 'u')\n\t\t\t\tfor(int i =0; i < n; ++i)\n\t\t\t\t\tmatrix[i][i] =1;\n\t\t}\n\t\tMx(const int &n, const int &m, const char *val_matrix):r(n), c(m){\n\t\t\tint cur =0;\n\t\t\tfor(int i =0; i < n; ++i)\n\t\t\t\tfor(int j =0; j < m; ++j){\n\t\t\t\t\tchar ch =val_matrix[cur++];\n\t\t\t\t\tif(ch == '+' || ch == '1')\n\t\t\t\t\t\tmatrix[i][j] =1;\n\t\t\t\t\telse if(ch == '-')\n\t\t\t\t\t\tmatrix[i][j] =-1;\n\t\t\t\t\telse\n\t\t\t\t\t\tmatrix[i][j] =0;\n\t\t\t\t}\n\t\t}\n\t\t\n\t\tMx operator * (const Mx &B) const{\n\t\t\tMx C(r, B.c);\n\t\t\tfor(int i =0; i < r; ++i)\n\t\t\t\tfor(int k =0; k < c; ++k) if(matrix[i][k])\n\t\t\t\t\tfor(int j =0; j < B.c; ++j)\n\t\t\t\t\t\tC.matrix[i][j] =(C.matrix[i][j]+matrix[i][k]*B.matrix[k][j]+M)%M;\n\t\t\treturn C;\n\t\t}\n\t};\n}\nusing Matrix::Mx;\n\n/*------------------------------Main------------------------------*/\n\nconst Mx U(4, 4, \"100-010000100001\"),\n\t\t D(4, 4, \"100+010000100001\"),\n\t\t L(4, 4, \"1000010-00100001\"),\n\t\t R(4, 4, \"1000010+00100001\"),\n\t\t I(4, 4, \"1000001001000001\"),\n\t\t C(4, 4, \"0010010010000001\");\n\nint main(){\n\tfor(int t =0, T =read(); t < T; ++t){\n\t\tint n =read(), m =read();\n\t\tMatrix::M =n;\n\t\tint matrix[MAXN][MAXN];\n\t\tfor(int i =0; i < n; ++i)\n\t\t\tfor(int j =0; j < n; ++j)\n\t\t\t\tmatrix[i][j] =read();\n\t\tchar oper[MAXM];\n\t\tread_string(oper);\n\t\t\n\t\tMx mov(4, \"unit\");\n\t\tfor(int i =0; i < m; ++i){\n\t\t\tif(oper[i] == 'U')\n\t\t\t\tmov =U*mov;\n\t\t\telse if(oper[i] == 'D')\n\t\t\t\tmov =D*mov;\n\t\t\telse if(oper[i] == 'L')\n\t\t\t\tmov =L*mov;\n\t\t\telse if(oper[i] == 'R')\n\t\t\t\tmov =R*mov;\n\t\t\telse if(oper[i] == 'I')\n\t\t\t\tmov =I*mov;\n\t\t\telse\n\t\t\t\tmov =C*mov;\n\t\t}\n\t\t\n\t\tint ans[MAXN][MAXN] ={0};\n\t\tfor(int i =0; i < n; ++i)\n\t\t\tfor(int j =0; j < n; ++j){\n\t\t\t\tMx cur(4, 1);\n\t\t\t\tcur.matrix[0][0] =i;\n\t\t\t\tcur.matrix[1][0] =j;\n\t\t\t\tcur.matrix[2][0] =matrix[i][j]-1;\n\t\t\t\tcur.matrix[3][0] =1;\n\t\t\t\t\n\t\t\t\tcur =mov*cur;\n\t\t\t\tans[cur.matrix[0][0]][cur.matrix[1][0]] =cur.matrix[2][0];\n\t\t\t}\n\t\tfor(int i =0; i < n; ++i){\n\t\t\tfor(int j =0; j < n; ++j)\n\t\t\t\twrite(ans[i][j]+1), putchar(' ');\n\t\t\tputchar('\\n');\n\t\t}\n\t\tputchar('\\n');\n\t}\n}\n```",
        "postTime": 1608450562,
        "uid": 105254,
        "name": "Piwry",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1458C \u3010Latin Square\u3011"
    },
    {
        "content": "\u8003\u573a\u4e0a\u60f3\u5230\u4e86\u5927\u4f53\u601d\u8def\uff0c\u4f46\u662f\u4ee5\u4e3a\u77e9\u9635\u4e00\u5b9a\u662f\u4e00\u884c\u5faa\u73af\u540c\u6784\u6765\u7684\u6240\u4ee5\u4e00\u76f4 wa\u2026\u2026\n\n\u8003\u8651\u8fd9\u6837\u4e00\u79cd\u66b4\u529b\uff1a\u6c42\u51fa\u6bcf\u4e2a\u683c\u5b50\u4ece\u54ea\u91cc\u6765\u3002\n\n\u9996\u5148\u6c42\u51fa $posl(i,j)$\uff08\u539f\u77e9\u9635\u7b2c $j$ \u5217\u7b2c\u51e0\u884c\u5143\u7d20\u662f $i$\uff09\uff0c$posh(i,j)$\uff08\u539f\u77e9\u9635\u7b2c $i$ \u5217\u7b2c\u51e0\u884c\u5143\u7d20\u662f $j$\uff09\u3002\u6211\u4eec\u8bbe\u4e09\u4e2a\u51fd\u6570\uff1a\n\n- $\\mathrm{Find}(x,y,t)$ \u8868\u793a $a(x,y)$ \u5728 $t$ \u65f6\u523b\u662f\u4ec0\u4e48\uff1b\n- $\\mathrm{Findposh}(x,y,t)$ \u8868\u793a $a(x,?)$ \u5728 $t$ \u65f6\u523b\u662f $y$\uff1b\n- $\\mathrm{Findposl}(x,y,t)$ \u8868\u793a $a(?,x)$ \u5728 $t$ \u65f6\u523b\u662f $y$\u3002\n\n\u90a3\u4e48\u7b54\u6848 $ans(i,j)=Find(i,j,m)$\u3002\n\n\u7531\u4e8e\u4ee3\u7801\u5b9e\u5728\u592a\u5bb9\u6613\u7406\u89e3\u4e86\uff0c\u8fd9\u91cc\u76f4\u63a5\u7ed9\u51fa\u5982\u4f55\u6c42\u51fa\u8fd9\u4e09\u4e2a\u51fd\u6570\u7684\u4ee3\u7801\uff1a\n\n```cpp\nint Findposh(int x,int y,int t){//t\u65f6\u523b\uff0ca_{x,?}=y\n\tif(t==0)return posh[x][y];\n\tif(str[t]=='L')return f(Findposh(x,y,t-1)-1);\n\tif(str[t]=='R')return f(Findposh(x,y,t-1)+1);\n\tif(str[t]=='U')return Findposh(x%n+1,y,t-1);\n\tif(str[t]=='D')return Findposh((x-2+n)%n+1,y,t-1);\n\tif(str[t]=='I')return Find(x,y,t-1);\n\tif(str[t]=='C')return Findposh(y,x,t-1);\n}\nint Findposl(int x,int y,int t){//t\u65f6\u523b\uff0ca_{?,x}=y\n\tif(t==0)return posl[y][x];\n\tif(str[t]=='L')return Findposl(x%n+1,y,t-1);\n\tif(str[t]=='R')return Findposl((x-2+n)%n+1,y,t-1);\n\tif(str[t]=='U')return f(Findposl(x,y,t-1)-1);\n\tif(str[t]=='D')return f(Findposl(x,y,t-1)+1);\n\tif(str[t]=='I')return Findposl(y,x,t-1);\n\tif(str[t]=='C')return Find(y,x,t-1);\n}\nint Find(int x,int y,int t){//t\u65f6\u523b\uff0ca_{x,y}=?\n\tif(t==0)return a[x][y];\n\tif(str[t]=='L')return Find(x,y%n+1,t-1);\n\tif(str[t]=='R')return Find(x,(y-2+n)%n+1,t-1);\n\tif(str[t]=='U')return Find(x%n+1,y,t-1);\n\tif(str[t]=='D')return Find((x-2+n)%n+1,y,t-1);\n\tif(str[t]=='I')return Findposh(x,y,t-1);\n\tif(str[t]=='C')return Findposl(y,x,t-1); \n}\n```\n\n\u53ef\u662f\u8fd9\u6837\u4ecd\u7136\u662f $O(n^2m)$ \u7684\u2026\u2026\n\n\u8003\u8651\u4f18\u5316\u3002\u4f60\u4f1a\u53d1\u73b0\uff0c\u6bcf\u6b21\u8c03\u7528\u51fd\u6570\u7684\u5f62\u5f0f\u4e0e $(x,y)$ \u76f8\u5bf9\u4e8e\u539f\u4f4d\u7f6e\u7684\u76f8\u5bf9\u4f4d\u7f6e\u4e0e $x,y$ \u7684\u5177\u4f53\u503c\u6ca1\u6709\u5173\u7cfb\uff0c\u53ea\u4e0e\u64cd\u4f5c\u5e8f\u5217\u6709\u5173\u3002\u8fd9\u610f\u5473\u7740\u5b58\u5728\u4e00\u4e2a\u666e\u9002\u7684\u51fd\u6570\uff0c$f(x,y)=(arrayid,i,j,dx,dy,d,rev)$ \u8868\u793a\u64cd\u4f5c\u540e $a(x,y)$ \u7b49\u4e8e\u64cd\u4f5c\u524d $a/posl/posh(i+dx,j+dy)+d$\uff08\u82e5 $rev=1$ \u5219\u9700\u8981\u4ea4\u6362\u6700\u540e $i+dx,j+dy$ \u7684\u503c\uff09\u3002\u5bf9\u4e8e\u4efb\u610f $x,y$\uff0c$f$ \u7684\u8868\u8fbe\u5f0f\u90fd\u662f\u4e00\u6837\u7684\u2014\u2014\u800c $f$ \u53ea\u4e0e\u64cd\u4f5c\u5e8f\u5217\u6709\u5173\uff0c\u6211\u4eec\u53ef\u4ee5 $O(m)$ \u6c42\u51fa $f$\u3002\n\n\u4ee3\u7801\u975e\u5e38\u597d\u5199\uff0c\u800c\u4e14\u975e\u5e38\u597d\u61c2\uff0c\u5047\u5982\u6ca1\u770b\u61c2\u4e0a\u9762\u7684\u76f4\u63a5\u770b\u4ee3\u7801\u5c31\u61c2\u4e86\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nint a[1005][1005],n,m,t[1005],H,L,ans[1005][1005],posh[1005][1005],posl[1005][1005];\nchar str[100005];\nstruct Thing{\n\tint array_id,xdlt,ydlt,dlt,isrev;\n};\nThing Findposh(int t);\nThing Findposl(int t);\nThing Find(int t);\nint main(){\n\tint tc;\n\tcin>>tc;\n\twhile(tc--){\n\t\tcin>>n>>m;\n\t\tfor(int i=1;i<=n;i++)for(int j=1;j<=n;j++)scanf(\"%d\",&a[i][j]),posh[i][a[i][j]]=j,posl[a[i][j]][j]=i;\n\t\tcin>>str+1;\n\t\tThing t=Find(m);\n\t//\tcout<<t.xdlt<<' '<<t.ydlt<<' '<<t.isrev<<' '<<(char)t.array_id<<' '<<t.dlt<<endl;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tfor(int j=1;j<=n;j++){\n\t\t\t\tint ti=i,tj=j;\n\t\t\t\t//if(t.isrev)swap(ti,tj);\n\t\t\t\tint x=((t.xdlt+ti)%n+n)%n+n,y=((t.ydlt+tj)%n+n)%n+n;\n\t\t\t\tx=(x-1)%n+1,y=(y-1)%n+1;\n\t\t\t\tif(t.isrev)swap(x,y);\n\t\t\t\tint ans;\n\t\t\t\tif(t.array_id=='p')ans=a[x][y];\n\t\t\t\tif(t.array_id=='h')ans=posh[x][y];\n\t\t\t\tif(t.array_id=='l')ans=posl[x][y];\n\t\t\t\tans=((ans+t.dlt)%n+n)%n+n;\n\t\t\t\tans=(ans-1)%n+1;\n\t\t\t\tcout<<ans<<' ';\n\t\t\t}\n\t\t\tputs(\"\");\n\t\t}\n\t\tputs(\"\");\n\t}\n}\nThing Findposh(int t){//t\u65f6\u523b\uff0ca_{x,?}=y\n\tThing tmp;\n\tif(t==0)return {'h',0,0,0,0};\n\tif(str[t]=='L'){\n\t\ttmp=Findposh(t-1),tmp.dlt--;\n\t\treturn tmp;\n\t}\n\tif(str[t]=='R'){\n\t\ttmp=Findposh(t-1),tmp.dlt++;\n\t\treturn tmp;\n\t}\n\tif(str[t]=='U'){\n\t\ttmp=Findposh(t-1),tmp.xdlt++;\n\t\treturn tmp;\n\t}\n\tif(str[t]=='D'){\n\t\ttmp=Findposh(t-1),tmp.xdlt--;\n\t\treturn tmp;\n\t}\n\tif(str[t]=='I'){\n\t\treturn Find(t-1);\n\t}\n\tif(str[t]=='C'){\n\t\ttmp=Findposh(t-1),swap(tmp.xdlt,tmp.ydlt),tmp.isrev^=1;\n\t\treturn tmp;\n\t}\n}\nThing Findposl(int t){//t\u65f6\u523b\uff0ca_{?,x}=y\n\tThing tmp;\n\tif(t==0)return {'l',0,0,0,1};\n\tif(str[t]=='L'){\n\t\ttmp=Findposl(t-1),tmp.xdlt++;\n\t\treturn tmp;\n\t}\n\tif(str[t]=='R'){\n\t\ttmp=Findposl(t-1),tmp.xdlt--;\n\t\treturn tmp;\n\t}\n\tif(str[t]=='U'){\n\t\ttmp=Findposl(t-1),tmp.dlt--;\n\t\treturn tmp;\n\t}\n\tif(str[t]=='D'){\n\t\ttmp=Findposl(t-1),tmp.dlt++;\n\t\treturn tmp;\n\t}\n\tif(str[t]=='I'){\n\t\ttmp=Findposl(t-1),swap(tmp.xdlt,tmp.ydlt),tmp.isrev^=1;\n\t\treturn tmp;\n\t}\n\tif(str[t]=='C'){\n\t\ttmp=Find(t-1),swap(tmp.xdlt,tmp.ydlt),tmp.isrev^=1;\n\t\treturn tmp;\n\t}\n}\nThing Find(int t){//t\u65f6\u523b\uff0ca_{x,y}=?\n\tThing tmp;\n\tif(t==0)return {'p',0,0,0,0};\n\tif(str[t]=='L'){\n\t\ttmp=Find(t-1),tmp.ydlt++;\n\t\treturn tmp;\n\t}\n\tif(str[t]=='R'){\n\t\ttmp=Find(t-1),tmp.ydlt--;\n\t\treturn tmp;\n\t}\n\tif(str[t]=='U'){\n\t\ttmp=Find(t-1),tmp.xdlt++;\n\t\treturn tmp;\n\t}\n\tif(str[t]=='D'){\n\t\ttmp=Find(t-1),tmp.xdlt--;\n\t\treturn tmp;\n\t}\n\tif(str[t]=='I'){\n\t\treturn Findposh(t-1);\n\t}\n\tif(str[t]=='C'){\n\t\ttmp=Findposl(t-1),swap(tmp.xdlt,tmp.ydlt),tmp.isrev^=1;\n\t\treturn tmp;\n\t}\n}\n```",
        "postTime": 1608537250,
        "uid": 42156,
        "name": "feecle6418",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1458C \u3010Latin Square\u3011"
    }
]
[
    {
        "content": "### \u9898\u610f\n\n- \u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u6392\u5217\u4e2d\u7684\u6570\u5b57 $x$ \u662f\u597d\u7684\uff0c\u5f53\u4e14\u4ec5\u5f53\u5305\u542b\u5b83\u7684\u5b50\u4e32\u7684\u6700\u5927\u503c\u7684\u4e2a\u6570\u4e3a $m$\n\n- \u73b0\u5728 Cirno \u60f3\u95ee\u4f60\uff0c\u6709\u591a\u5c11\u957f\u5ea6\u4e3a $n$ \u7684\u6392\u5217\u6ee1\u8db3\u597d\u7684\u6570\u5b57\u6709\u6070\u597d $k$ \u4e2a\u3002\n\n### \u9898\u89e3\n\n\n\u51fa\u9898\u4eba\u9006\u5927\u5929\uff0c$\\mathcal{O}(n^5)$ \u8fc7 100\uff0c\u771f\u662f\u725b\u903c\u55f7\n\n\u9996\u5148\u6211\u4eec\u8003\u8651\u7ed9\u4f60\u4e00\u4e2a\u6392\u5217\uff0c\u600e\u4e48\u786e\u5b9a\u91cc\u9762\u7684\u6570\u5b57\u662f\u597d\u7684\u3002\n\n\u5047\u8bbe\u8fd9\u4e2a\u6570\u7684\u4f4d\u7f6e\u662f $x$\uff0c\u90a3\u4e48\u5b50\u4e32\u6700\u5927\u503c\u7684\u4e2a\u6570\u5c31\u662f $[1\\ldots x]$ \u4e2d\u7684\u540e\u7f00\u6700\u5927\u503c\u4e2a\u6570\u52a0\u4e0a $[x\\ldots n]$ \u7684\u524d\u7f00\u6700\u5927\u503c\u4e2a\u6570\u3002\u6b63\u786e\u6027\u5f88\u663e\u7136\u3002\n\n\u6839\u636e\u7b1b\u5361\u5c14\u6811\u7684\u7ecf\u5178\u7ed3\u8bba\uff0c\u8fd9\u4e2a\u4e1c\u897f\u5c31\u662f\u7b1b\u5361\u5c14\u6811\u4e0a $x$ \u7684\u5c42\u6570\u3002\u5177\u4f53\u8bc1\u660e\u5927\u6982\u5c31\u662f\uff0c\u53ea\u6709 $[1\\ldots x]$ \u4e2d\u7684\u540e\u7f00\u6700\u5927\u503c\u80fd\u6210\u4e3a $x$ \u7684\u7956\u5148\uff0c\u5982\u679c\u4e00\u4e2a\u70b9 $y$ \u5b83\u540e\u9762\u6709\u6570\u5b57\u5927\u4e8e\u5b83\u7684\u8bdd\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6570\u5b57\u4f1a\u5728\u6784\u9020\u7b1b\u5361\u5c14\u6811\u7684\u8fc7\u7a0b\u4e2d\uff0c\u628a $y$ \u653e\u5230\u5de6\u513f\u5b50\uff0c$x$ \u653e\u5230\u53f3\u513f\u5b50\uff0c\u8fd9\u6837\u70b9 $y$ \u5c31\u4e0d\u53ef\u80fd\u6210\u4e3a $x$ \u7684\u7956\u5148\u3002\u53cd\u4e4b\uff0c\u540e\u7f00\u6700\u5927\u503c\u90fd\u80fd\u6210\u4e3a $x$ \u7684\u7956\u5148\u3002\u800c $[x\\ldots n]$ \u7684\u8bc1\u660e\u5219\u540c\u7406\u3002\n\n\u4e8e\u662f\u95ee\u9898\u8f6c\u5316\u6210\uff0c\u6709\u591a\u5c11\u5f62\u6001\u4e0d\u540c\u7684\u7b1b\u5361\u5c14\u6811\u6ee1\u8db3\u5176\u5c42\u6570\u4e3a $m$ \u7684\u8282\u70b9\u6570\u7b49\u4e8e $k$\u3002\n\n\u8fd9\u4e2a\u663e\u7136\u53ef\u4ee5 dp\uff0c\u8bbe $f_{i,j,k}$ \u4e3a\u5927\u5c0f\u4e3a $i$ \u7684\u5b50\u6811\u4e2d\uff0c\u6709\u591a\u5c11\u70b9\u5c42\u6570\u4e3a $m$\uff0c\u4e14\u8fd9\u4e2a\u5b50\u6811\u7684\u6839\u79bb\u6839\u8282\u70b9\u7684\u8ddd\u79bb\u4e3a $j$\n\n\n\u8f6c\u79fb\u6709 \n$$\nf_{i,j,k}=\\sum_a\\sum_b {i-1 \\choose a} \\times f_{a,j+1,b} \\times f_{i-1-a,j+1,k-b-[j==m]}\n$$\n\n\u4f46\u662f\u8fd9\u6837\u662f\u8fc7\u4e0d\u53bb\u7684\uff0c\u56e0\u4e3a\u51fa\u9898\u4eba\u4f1a\u5361\u4f60\u5e38\u6570\uff0c\u4f60\u9700\u8981\u52a0\u4e2a\u526a\u679d\uff0c\u6bd4\u5982\u8bf4\u6211\u4eec\u53d1\u73b0\u4e00\u4e2a\u5927\u5c0f\u4e3a $i$ \u7684\u5b50\u6811\u4e2d\u540c\u4e00\u5c42\u7684\u8282\u70b9\u4e2a\u6570\u6700\u591a\u4e3a $\\dfrac{i+1}{2}$\uff0c\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u8fd9\u4e2a\u526a\u679d\uff0c\u4e8e\u662f\u5c31\u80fd\u5e38\u6570\u9664\u4ee5 4\u3002\n\n\u6211\u5199\u9898\u89e3\u7684\u539f\u56e0\u5c31\u662f\u4e3a\u4e86\u8fd9\u4e2a\u5361\u5e38\uff08\n\n\u5177\u4f53\u770b[\u4ee3\u7801](https://codeforces.com/contest/1580/submission/130537073)\n\n",
        "postTime": 1633162407,
        "uid": 344016,
        "name": "wurzang",
        "ccfLevel": 7,
        "title": "CF1580B"
    },
    {
        "content": "\u9898\u610f\uff1a\n\n\u6c42\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u7684\u6392\u5217\u4e2a\u6570\uff1a\n\n- \u957f\u5ea6\u4e3a $n$\u3002\n- \u6070\u6709 $k$ \u4e2a\u6570\u6ee1\u8db3\uff1a\u6240\u6709\u5305\u542b\u8fd9\u4e2a\u6570\u7684\u533a\u95f4\u4e2d\uff0c\u4e0d\u540c\u7684\u6700\u5927\u503c\u7684\u4e2a\u6570\u6070\u6709 $m$ \u4e2a\u3002\n\n---\n\n$\\textrm{Solution}$\uff1a\n\n\u9664\u53bb\u8fd9\u4e2a 100 \u7684\u8303\u56f4\uff0c\u662f\u4e00\u9053\u597d\u7684\u7ec3\u624b\u9898\u3002\n\n\u5c06\u201c\u6240\u6709\u5305\u542b\u8fd9\u4e2a\u6570\u7684\u533a\u95f4\u4e2d\uff0c\u4e0d\u540c\u7684\u6700\u5927\u503c\u7684\u4e2a\u6570\u6070\u6709 $m$ \u4e2a\u201d\u7684\u6570\u79f0\u4f5c $m$ - \u597d\u6570\uff0c\u90a3\u4e48\u7528 $f_{i,j,k}$ \u8868\u793a\uff1a\u957f\u5ea6\u4e3a $i$ \u7684\u5e8f\u5217\uff0c$k$ - \u597d\u6570\u6709 $j$ \u4e2a\u7684\u65b9\u6848\u6570\u3002\n\n\u8003\u8651\u5982\u4f55\u8f6c\u79fb $f_{i,j,k}$\uff1a\u679a\u4e3e\u6700\u5927\u503c\u7684\u4f4d\u7f6e $p$\uff0c\u5de6\u53f3\u4e24\u8fb9\u53ea\u9700\u8981\u4fdd\u7559\u504f\u5e8f\u5173\u7cfb\uff0c\u53ef\u4ee5\u770b\u4f5c\u662f\u957f\u5ea6\u4e3a $p-1$ \u548c $i-p$ \u7684\u4e24\u4e2a\u6392\u5217\uff0c\u5212\u5206\u65b9\u6848\u6570\u5c31\u662f $\\dbinom{n-1}{p-1}$\u3002\n\n\u8de8\u8d8a\u6700\u5927\u503c\u7684\u533a\u95f4\u663e\u7136\u53ea\u4f1a\u5bf9\u4e0d\u540c\u6700\u5927\u503c\u4e2a\u6570\u6709 $1$ \u7684\u8d21\u732e\uff0c\u9700\u8981\u627e\u7684\u5176\u5b9e\u662f\u5de6\u53f3\u4e24\u8fb9\u7684 $(k-1)$ - \u597d\u6570\u3002\u6240\u4ee5\u53ef\u4ee5\u518d\u679a\u4e3e\u4e00\u7ef4 $c$ \u8868\u793a\u5de6\u534a\u8fb9\u7684 $(k-1)$ - \u597d\u6570\u4e2a\u6570\uff0c\u53f3\u534a\u8fb9\u5373\u4e3a $j-c-[k=1]$\uff08\u4e2d\u95f4\u7684\u6700\u5927\u503c\u662f $1$ - \u597d\u6570\uff0c\u8981\u5224\u6389\uff09\u3002\n\n\u6240\u4ee5\u6709\u8f6c\u79fb\uff1a\n\n$$f_{i,j,k}=\\sum_p \\binom{n-1}{p-1}\\sum_c f_{p-1,c,k-1}\\cdot f_{i-p,j-c-[k=1],k-1}$$\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^5)$\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a\n\n- $p=1$ \u6216 $p=i$ \u9700\u8981\u7279\u5224\u3002\n- \u5982 $j=0$ \u4e14 $k>i$ \u7684\u8fb9\u754c\u60c5\u51b5\u9700\u8981\u6ce8\u610f\uff0c\u6309\u5b9a\u4e49\u8ba1\u7b97\u3002\n- \u4e58\u6cd5\u5f88\u6162\uff0c\u53ef\u4ee5\u5148\u5224\u65ad\u662f\u5426\u4e3a $0$ \u518d\u8f6c\u79fb\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(\"Ofast\")\n#define rgi register int\n#define FOR(i,a,b) for(rgi i=a,i##i=b;i<=i##i;++i)\n#define ROF(i,a,b) for(rgi i=a,i##i=b;i>=i##i;--i)\nusing namespace std;\nconst int N=110;\nint n,m,K,P,f[N][N][N],fac[N],C[N][N];\ninline int get(int i,int j,int k){\n\tif(!j&&(k>i||k<1))return fac[i];\n\treturn f[i][j][k];\n}\nsigned main(){\n\tscanf(\"%d%d%d%d\",&n,&m,&K,&P),f[1][1][1]=C[0][0]=fac[0]=1;\n\tFOR(i,1,n){\n\t\tC[i][0]=1,fac[i]=1ll*fac[i-1]*i%P;\n\t\tFOR(j,1,i)C[i][j]=(C[i-1][j]+C[i-1][j-1])%P;\n\t}\n\tFOR(i,2,n)FOR(j,0,min(i,K))FOR(k,1,min(i-j+1,m)){\n\t\trgi G=j-(k==1),X,Y;\n\t\tf[i][j][k]=(get(i-1,G,k-1)*2)%P;\n\t\tFOR(p,2,i-1)FOR(c,0,min(p,G))if((X=get(p-1,c,k-1))&&(Y=get(i-p,G-c,k-1))){\n\t\t\tf[i][j][k]=(f[i][j][k]+1ll*X*Y%P*C[i-1][p-1])%P;\n\t\t}\n\t}\n\tprintf(\"%d\",f[n][K][m]);\n\treturn 0;\n}\n```\n\n\n",
        "postTime": 1635775664,
        "uid": 78372,
        "name": "M4_SOPMODII_JR",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1580B Mathematics Curriculum"
    },
    {
        "content": "\u5bf9\u4e8e $1\\sim i$  \u7684\u6392\u5217\uff0c\u8003\u8651\u5176\u6700\u5927\u503c $i$ \u5728\u54ea\u4e2a\u4f4d\u7f6e\u3002\u5982\u679c $i$ \u5728\u4f4d\u7f6e $w$\uff0c\u90a3\u4e48\u5de6\u8fb9\u5c31\u53d8\u6210\u4e86 $n=w-1,m=m-1$ \u7684\u7248\u672c\uff0c\u53f3\u8fb9\u5c31\u53d8\u6210\u4e86 $n=i-w,m=m-1$ \u7684\u7248\u672c\n\n\u8fd9\u6837\u5e76\u4e0d\u80fd\u8f6c\u79fb\uff0c\u518d\u52a0\u4e00\u7ef4 $k$ \u8868\u793a\u597d\u6570\u6709 $k$ \u4e2a\u7684\u65b9\u6848\u6570\uff0c\u7136\u540e\u679a\u4e3e\u5de6\u8fb9\u8d21\u732e\u591a\u5c11\u4e2a\u597d\u6570\uff0c\u8fd9\u6837\u662f $O(n^5)$ \u7684\u3002\u5177\u4f53\u5730\uff0c\u4ee4 $f(i,j,k)$ \u8868\u793a $n=i,m=j,k=k$ \u65f6\u7684\u7b54\u6848\uff0c\u90a3\u4e48 $f(i,j,k)=\\sum f(w-1,j-1,t)\\cdot f(i-w,j-1,k-(j==1)-t)\\cdot \\binom{i-1}{w-1}$\n\n\u521d\u59cb\u5316\u548c\u5361\u5e38\u4e00\u5806\u7ec6\u8282\uff0c\u611f\u8c22\u5207\u961f\u6307\u5bfc\u3002\u6709\u4e00\u4e2a\u633a\u91cd\u8981\u7684\u70b9\u662f\u5bf9\u4e8e $j>i$\uff0c$f(i,j,0)$ \u5e94\u5f53\u521d\u59cb\u5316\u4e3a $i!$\u3002\u8fd8\u6709\u4e00\u4e2a\u5f88\u6709\u529b\u7684\u5e38\u6570\u4f18\u5316\u662f\u5982\u679c $f(w-1,j-1,t),f(i-w,j-1,k-(j==1)-t)$ \u4e2d\u6709\u4e00\u4e2a\u503c\u4e3a $0$ \u90a3\u5c31\u4e0d\u8981\u8f6c\u79fb\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#include<vector>\n#include<queue>\n#include<map>\n#define pb push_back\n#define sml(x,y) (x=min(x,y))\n#define big(x,y) (x=max(x,y))\n#define ll long long\n#define db double\n#define fo(i,x,y) for(register int i=x;i<=y;++i)\n#define go(i,x,y) for(register int i=x;i>=y;--i)\nusing namespace std;\ninline int read(){int x=0,fh=1; char ch=getchar(); while(!isdigit(ch)){if(ch=='-') fh=-1; ch=getchar();} while(isdigit(ch)){x=(x<<1)+(x<<3)+ch-'0'; ch=getchar();} return x*fh;}\ninline void out(int *a,int l,int r){fo(i,l,r) printf(\"%lld \",*(a+i));puts(\"\");}\n\nconst int N=105;\nint qlr,n,m,kk,C[N][N],f[N][N][N],fac[N];\n\nsigned main(){\n\tcin>>n>>m>>kk>>qlr;\n\t//f[1][1][1]=1;\n\tfo(i,0,n) f[0][i][0]=1;\n\tfac[0]=fac[1]=1;fo(i,2,n) fac[i]=(ll)fac[i-1]*i%qlr;\n\tC[0][0]=1;\n\tfo(i,1,n){\n\t\tC[i][0]=1;\n\t\tfo(j,1,i) C[i][j]=(C[i-1][j-1]+C[i-1][j])%qlr; \n\t\t//out(C[i],0,i);\n\t}\n\tfo(i,0,n) f[0][i][0]=1;\n\t//fo(i,0,m) f[1][i][0]=1;\n\t//f[1][1][1]=1;f[1][1][0]=0;\n\tfo(i,1,n){\n\t\tf[i][1][1]=fac[i];\n\t\tfo(j,i+1,n) f[i][j][0]=fac[i];\n\t\tfo(j,2,min(i,m))\n\t\t\tfo(k,0,min(i-j+1,kk)){\n\t\t\t\tf[i][j][k]=(f[i][j][k]+(f[i-1][j-1][k-(j==1)]<<1))%qlr;\n\t\t\t\tfo(w,2,i-1)//\u679a\u4e3e i \u6240\u5728\u4f4d\u7f6e\uff0c\u518d\u679a\u4e3e\u5de6\u534a\u8fb9\u8981\u8d21\u732e\u591a\u5c11\u4e2a\u597d\u6570 \n\t\t\t\t\tfo(t,0,k-(j==1)) if(f[w-1][j-1][t]&&f[i-w][j-1][k-(j==1)-t])\n\t\t\t\t\t\tf[i][j][k]=(f[i][j][k]+(ll)f[w-1][j-1][t]*f[i-w][j-1][k-(j==1)-t]%qlr*C[i-1][w-1])%qlr;\n\t\t\t\t//printf(\"%lld,%lld,%lld:%lld\\n\",i,j,k,f[i][j][k]);\n\t\t\t}\t\t\n\t}\n\n\tcout<<f[n][m][kk];\n\treturn 0;\n}\n/*\n-------------------------------------------------\n*/\n\n\n```\n",
        "postTime": 1633573202,
        "uid": 238408,
        "name": "vectorwyx",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1580B Mathematics Curriculum"
    },
    {
        "content": "\u5199\u4e00\u53d1\u9898\u89e3\u7eaa\u5ff5\u4e00\u4e0b\u8fd9\u4e00\u9053\u81ea\u5df1\u60f3\u51fa\u6765\u7684 DP \u597d\u9898\u3002\n\n\u9996\u5148\u6211\u4eec\u53d1\u73b0\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u6392\u5217\uff0c\u5bf9\u5176\u5efa\u7acb\u7b1b\u5361\u5c14\u6811\u4e4b\u540e\uff0c\u5305\u542b\u4e00\u4e2a\u4e0b\u6807\u7684\u533a\u95f4\u4e2d\u4e0d\u540c\u6700\u5927\u503c\u7684\u79cd\u6570\u5c31\u7b49\u4e8e\u8fd9\u4e2a\u70b9\u5728\u7b1b\u5361\u5c14\u6811\u4e0a\u7684\u6df1\u5ea6\u3002\u663e\u7136\u6bcf\u4e2a\u6392\u5217\u4e0e\u4e00\u4e2a\u5e26\u6807\u53f7\u7b1b\u5361\u5c14\u6811\u552f\u4e00\u5bf9\u5e94\uff08\u4ee5\u4e0b\u7684\u201c\u7b1b\u5361\u5c14\u6811\u201d\u5747\u6307\u5e26\u6807\u53f7\u7684\u7b1b\u5361\u5c14\u6811\uff09\uff0c\u90a3\u4e48\u539f\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a\u6c42\u6709 $n$ \u4e2a\u8282\u70b9\uff0c\u6709 $k$ \u4e2a\u6df1\u5ea6\u4e3a $m$ \u7684\u8282\u70b9\u7684\u7b1b\u5361\u5c14\u6811\u6709\u591a\u5c11\u79cd\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u8bbe $f_{i,j,k}$ \u8868\u793a\u4ece\u5c0f\u5230\u5927\u8003\u8651\u4e86 $i$ \u4e2a\u70b9\uff0c\u5f53\u524d\u7b1b\u5361\u5c14\u6811\u4e0a\u6709 $j$ \u4e2a\u6df1\u5ea6\u4e3a $k$ \u7684\u8282\u70b9\uff0c\u7b1b\u5361\u5c14\u6811\u5171\u6709\u591a\u5c11\u79cd\u4e0d\u540c\u7684\u5f62\u6001\u3002\u6211\u4eec\u53d1\u73b0\uff0c\u7531\u4e8e $i$ \u662f\u5f53\u524d\u6743\u503c\u6700\u5927\u7684\u8282\u70b9\uff0c\u6545 $i$ \u4e00\u5b9a\u4e3a\u7b1b\u5361\u5c14\u6811\u7684\u6839\u3002\u4e8e\u662f\u679a\u4e3e\u5de6\u53f3\u5b50\u6811\u5404\u6709\u591a\u5c11\u8282\u70b9\u5373\u53ef\u3002\u90a3\u4e48\u5bf9\u4e8e $k>1$ \u7684\u60c5\u51b5\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u51fa\uff1a\n\n$$f_{i,j,k}=\\sum_{l=0}^{i-1}\\sum_{p=0}^{j}C_{i-1}^l\\times f_{l,p,k-1}\\times f_{i-1-l,j-p,k-1}$$\n\n\u90a3\u4e48\u5bf9\u4e8e $k=1$ \u7684\u60c5\u51b5\uff0c\u6211\u4eec\u8bbe $g_i$ \u8868\u793a\u8282\u70b9\u6570\u4e3a $i$ \u7684\u4e0d\u540c\u7b1b\u5361\u5c14\u6811\u6570\u91cf\uff0c\u90a3\u4e48\u53ef\u4ee5\u5f97\u51fa\uff1a\n\n$$g_i=\n\\begin{cases}\n1& 0\\le i\\le 1\\\\\n\\sum_{j=0}^{i-1}C_{i-1}^j\\times g_j\\times g_{i-1-j}&i>1\\\\\n\\end{cases}\n$$\n\n\u4e8e\u662f\u6709\uff1a\n\n$$f_{i,j,1}=\n\\begin{cases}\ng_i&j=1\\\\\n0&\\text{otherwise}\n\\end{cases}\n$$\n\n\u90a3\u4e48\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a $\\Theta(n^5)$ \u7684\u505a\u6cd5\u3002\u4f46\u662f\u663e\u7136\u662f\u8dd1\u4e0d\u8fc7\u53bb\u8fd9\u9898\u7684\uff0c\u6211\u4eec\u8003\u8651\u526a\u679d\uff1a\n\n1.\u5f53 $k>i$ \u65f6\uff0c\u82e5 $j=0$\uff0c$f_{i,j,k}=g_i$\uff0c\u5426\u5219 $f_{i,j,k}=0$\uff1b\n\n2.\u4e58\u6cd5\u53d6\u6a21\u8fd0\u7b97\u8f83\u6162\uff0c\u5f53\u8f6c\u79fb\u7684\u4e09\u9879\u4e2d\u4efb\u4f55\u4e00\u9879\u4e3a $0$ \u5c31\u53ef\u4ee5\u76f4\u63a5\u8df3\u8fc7\u3002\n\n\u4e8e\u662f\u5c31\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\Theta(n^5)$\uff0c\u4f46\u662f\u5e26\u4e00\u4e2a\u5f88\u5c0f\u7684\u5e38\u6570\u3002\n\nCode:\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\nusing namespace std ;\nint n , m , K , mod ;\ntypedef long long ll ;\nll c[110][110] , f[110][110][110] , g[110] ;\nint main () {\n\tscanf (\"%d%d%d%d\" , &n , &m , &K , &mod) ;\n\tif (m > n || (m == n && K > 1)) return !printf (\"0\") ;\n\tfor (int i = 0 ; i <= n ; i++) c[i][0] = 1 ;\n\tfor (int i = 1 ; i <= n ; i++)\n\t\tfor (int j = 1 ; j <= i ; j++)\n\t\t\tc[i][j] = (c[i - 1][j] + c[i - 1][j - 1]) % mod ;\n\tf[1][1][1] = f[1][0][0] = 1 ;\n\tfor (int i = 0 ; i <= m ; i++) f[0][0][i] = 1 ;\n\tfor (int i = 2 ; i <= m ; i++) f[1][0][i] = 1 ;\n\tg[0] = g[1] = 1 ;\n\tfor (int i = 2 ; i <= n ; i++)\n\t\tfor (int j = 0 ; j < i ; j++)\n\t\t\tg[i] = (g[i] + c[i - 1][j] * g[j] % mod * g[i - 1 - j] % mod) % mod ;\n\tfor (int i = 2 ; i <= n ; i++) {\n\t\tf[i][1][1] = g[i] ;\n\t\tfor (int k = 2 ; k <= m ; k++) {\n\t\t\tif (k > i) {f[i][0][k] = g[i] ; continue ;}\n\t\t\tfor (int j = 0 ; j <= K ; j++) {\n\t\t\t\tfor (int l = 0 ; l <= j ; l++)\n\t\t\t\t\tfor (int p = 0 ; p < i ; p++) {\n\t\t\t\t\t\tif (!c[i - 1][p] || !f[p][l][k - 1] || !f[i - 1 - p][j - l][k - 1]) continue ;\n\t\t\t\t\t\tf[i][j][k] = (f[i][j][k] + c[i - 1][p] * f[p][l][k - 1] % mod * f[i - 1 - p][j - l][k - 1] % mod) % mod ;\n\t\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf (\"%lld\\n\" , f[n][K][m]) ;\n\treturn 0 ;\n}\n```",
        "postTime": 1660555759,
        "uid": 122641,
        "name": "GIFBMP",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1580B\u3010Mathematics Curriculum\u3011"
    },
    {
        "content": "### \u9898\u610f\u7b80\u8ff0\n\n> \u6c42\u6709\u591a\u5c11\u957f\u5ea6\u4e3a $n$ \u7684\u6392\u5217\u6ee1\u8db3\u7b1b\u5361\u5c14\u6811\u4e0a\u6df1\u5ea6\u4e3a $m$ \u7684\u70b9\u6709 $k$ \u4e2a\u3002\n\n### \u601d\u8def\u5206\u6790\n\n\u76f4\u63a5 DP\uff0c\u72b6\u6001\u5c31\u662f $dp_{n,m,k}$ \u8868\u793a\u6709\u591a\u5c11\u957f\u5ea6\u4e3a $n$ \u7684\u6392\u5217\u6ee1\u8db3\u7b1b\u5361\u5c14\u6811\u4e0a\u6df1\u5ea6\u4e3a $m$ \u7684\u70b9\u6709 $k$ \u4e2a\u3002\n\n\u8f6c\u79fb\u65f6\u679a\u4e3e\u7b1b\u5361\u5c14\u6811\u5176\u4e2d\u4e00\u4e2a\u513f\u5b50\u7684\u5927\u5c0f\u548c\u91cc\u9762\u6df1\u5ea6\u4e3a $m$ \u7684\u4e2a\u6570\uff0c\u6709\uff1a\n\n$$dp_{n,m,k}=\\sum_i\\sum_jdp_{i,m-1,j}dp_{n-i-1,m-1,k-j}\\dbinom{n-1}{i}$$\n\n\u76f4\u63a5\u8f6c\u79fb\u5c31\u80fd\u8fc7\uff01$O(n^5)$ \u51b2 $n=100$\uff01\n\n\u9898\u89e3\u533a\u91cc\u90fd\u8bf4\u8981\u5361\u5e38\uff0c\u4f46\u662f\u72b6\u6001\u6839\u672c\u4e0d\u6ee1\uff0c\u8bb0\u641c\u4e0d\u9999\u5417\u2026\u2026\n\n### \u4ee3\u7801\u5c55\u793a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint mod;\nint fac[105],C[105][105];\nint dp[105][105][105];\nint solve(int n,int m,int k){\n\tif(n<k)return 0;\n\tif(!n)return 1;\t\n\tif(m==1)return (k==1)*fac[n];\n\tif(dp[n][m][k]>=0)return dp[n][m][k];\n\tint res=0;\n\tfor(int i=0;i<n;i++)\n\t\tfor(int j=max(k+i+1-n,0);j<=min(k,i);j++)\n\t\t\tres=(res+1ll*solve(i,m-1,j)*solve(n-i-1,m-1,k-j)%mod*C[n-1][i]%mod)%mod;\n\tdp[n][m][k]=res;\n\treturn res;\n}\nint main(){\n\tint n,m,k;\n\tscanf(\"%d%d%d%d\",&n,&m,&k,&mod);\n\tfac[0]=1;for(int i=1;i<=n;i++)fac[i]=1ll*fac[i-1]*i%mod;\n\tfor(int i=0;i<=n;i++){\n\t\tC[i][0]=1;\n\t\tfor(int j=1;j<=i;j++)C[i][j]=(C[i-1][j-1]+C[i-1][j])%mod;\n\t}\n\tmemset(dp,-1,sizeof(dp));\n\tprintf(\"%lld\\n\",solve(n,m,k));\n\treturn 0;\n}\n```",
        "postTime": 1679360894,
        "uid": 233462,
        "name": "Umbrella_Leaf",
        "ccfLevel": 8,
        "title": "\u9898\u89e3CF1580B Mathematics Curriculum"
    }
]
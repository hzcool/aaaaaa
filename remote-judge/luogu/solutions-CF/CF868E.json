[
    {
        "content": "> [\u9898\u76ee\u94fe\u63a5](http://codeforces.com/problemset/problem/868/E)    [\u53ef\u80fd\u66f4\u597d\u7684\u4f53\u9a8c](http://coding-pages-bucket-3532178-8430896-13917-522304-1305159063.cos-website.ap-hongkong.myqcloud.com/CF868E/)\n>\n> \u4e00\u68f5 $n$ \u4e2a\u7ed3\u70b9\u7684\u8fb9\u5e26\u6743\u6811\uff0c\u6709\u4e00\u4e2a\u8b66\u5bdf\u521d\u59cb\u5728 $s$ \u70b9\uff0c\u901f\u5ea6\u4e3a $1$\uff0c\u6811\u4e0a\u5206\u5e03\u6709 $m$ \u4e2a\u7f6a\u72af\uff0c\u901f\u5ea6\u4e3a\u4efb\u610f\u5927\uff0c\u5982\u679c\u7f6a\u72af\u548c\u8b66\u5bdf\u5728\u540c\u4e00\u4e2a\u7ed3\u70b9\u5c31\u4f1a\u88ab\u5e72\u6389\uff0c\u8b66\u5bdf\u5e0c\u671b\u5e72\u6389\u6240\u6709\u7f6a\u72af\u7684\u65f6\u95f4\u5c3d\u91cf\u77ed\uff0c\u800c\u7f6a\u72af\u5e0c\u671b\u6700\u5927\u5316\u8fd9\u4e2a\u65f6\u95f4\uff0c\u5047\u8bbe\u6bcf\u4e2a\u4eba\u90fd\u4ee5\u6700\u4f18\u7b56\u7565\u884c\u52a8\uff0c\u6c42\u8fd9\u4e2a\u65f6\u95f4\u3002\n>\n> $1 \\le n, m, w_i \\le 50$\uff0c$w_i$ \u4e3a\u8fb9\u6743\u3002\n>\n> \u6240\u6709\u7f6a\u72af\u521d\u59cb\u4e0d\u5728 $s$ \u70b9\uff0c\u4e00\u4e2a\u7ed3\u70b9\u53ef\u80fd\u4f1a\u6709\u591a\u4e2a\u7f6a\u72af\u3002\n\n### \u72b6\u6001\u8bbe\u8ba1\n\n\u8003\u8651\u8fd9\u4e2a\u8fc7\u7a0b\u662f\u600e\u6837\u7684\u3002\n\n\u5f53\u8b66\u5bdf\u5728\u7ed3\u70b9 $1$ \u65f6\uff0c\u7531\u4e8e\u7f6a\u72af\u901f\u5ea6\u4efb\u610f\u5927\uff0c\u4f46\u4e0d\u80fd\u7ecf\u8fc7\u8b66\u5bdf\uff0c\u6240\u4ee5\u7f6a\u72af\u5206\u5e03\u5728\u88ab\u7ed3\u70b9 $1$ \u9694\u5f00\u7684\u4e09\u4e2a\u90e8\u5206\u4e2d\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u6240\u5c5e\u90e8\u5206\u7684\u4efb\u610f\u4f4d\u7f6e\u4e0a\uff0c**\u4e0d\u59a8\u5047\u8bbe**\u7f6a\u72af\u5168\u90e8\u5206\u5e03\u5728\u6240\u6709\u4e0e\u7ed3\u70b9 $1$ \u76f8\u90bb\u7684\u7ed3\u70b9 $2,3,4$ \u4e0a\u3002\n\n\u56fe\u4e0a\u7684\u7ea2\u6570\u5b57\u8868\u793a\u8be5\u7ed3\u70b9\u4e0a\u6709\u591a\u5c11\u540d\u7f6a\u72af\u3002\n\n![](https://i.loli.net/2021/03/18/A4Zpd72bkRMeINU.png)\n\n\u5f53\u8b66\u5bdf\u4ece\u7ed3\u70b9 $1$ \u8d70\u5230\u7ed3\u70b9 $4$ \u65f6\uff0c\u7ed3\u70b9 $4$ \u4e0a\u7684\u4e24\u540d\u7f6a\u72af\u5c31\u9700\u8981\u8d70\u5230\u7ed3\u70b9 $5,6$ \uff0c\u540c\u65f6\u7ed3\u70b9 $2,3$ \u4e0a\u7684\u4e24\u540d\u7f6a\u72af\u53ef\u4ee5\u4e00\u8d77\u8d70\u5230\u7ed3\u70b9 $1$\u3002\n\n![](https://i.loli.net/2021/03/18/gtTQYLueC21mlZW.png)\n\n\u5bb9\u6613\u60f3\u5230\u7528\u8b66\u5bdf\u6240\u5728\u7684\u7ed3\u70b9 $u$ \u548c\u6240\u6709\u4e0e\u7ed3\u70b9 $u$ \u76f8\u90bb\u7684\u7ed3\u70b9\u4e0a\u5206\u522b\u6709\u591a\u5c11\u540d\u7f6a\u72af\u6765\u8868\u793a\u4e00\u4e2a\u72b6\u6001\u3002  \n\u4f46\u4e00\u4e2a\u7ed3\u70b9\u7684\u5ea6\u6570\u662f  $O(n)$ \u7ea7\u522b\u7684\uff0c\u56e0\u6b64\u72b6\u6001\u6570\u7206\u70b8\u3002\n\n\u53e6\u4e00\u4e2a\u63cf\u8ff0\u72b6\u6001\u7684\u60f3\u6cd5\u662f\u8b66\u5bdf\u5f53\u524d\u5728\u54ea\u6761\u8fb9\u4e0a\uff0c\u8fd9\u6761\u8fb9\u7684\u4e24\u7aef\u5206\u522b\u6709\u591a\u5c11\u540d\u7f6a\u72af\u3002  \n\u7136\u540e\u72b6\u6001\u6570\u5c31\u51cf\u5c11\u6210\u4e86 $O(n^3)$\uff0c\u975e\u5e38\u5c11\u3002\n\n\u56e0\u6b64\u6211\u4eec\u7528 $f_{i,j,k}$ \u8868\u793a\u5f53\u524d\u603b\u5171\u8fd8\u5269 $i$ \u540d\u7f6a\u72af\uff0c\u8b66\u5bdf**\u521a\u8d70\u4e0a** $j = u \\rightarrow v$ \u8fd9\u6761**\u6709\u5411\u8fb9**\uff08\u8b66\u5bdf\u548c $u$ \u7684\u8ddd\u79bb\u5ffd\u7565\u4e0d\u8ba1\uff09\uff0c\u7ed3\u70b9 $v$ \u4e0a\u6709 $k$ \u540d\u7f6a\u72af\u3002\n\n### \u8f6c\u79fb\n\n\u5047\u8bbe\u5f53\u524d\u603b\u5171\u8fd8\u5269  $i$ \u540d\u7f6a\u72af\uff0c\u8b66\u5bdf\u5728**\u6709\u5411\u8fb9** $j = u \\rightarrow v$ \u4e0a\uff0c\u8fb9\u6743\u4e3a $w$\uff0c\u7ed3\u70b9 $v$ \u4e0a\u6709 $k$ \u540d\u7f6a\u72af\u3002\n\n\u5982\u679c\u7ed3\u70b9 $v$ \u662f\u53f6\u5b50\u7ed3\u70b9\uff0c\u663e\u7136\n$$\nf_{i,j,k}=f_{i-k,\\bar j,i-k} + w\n$$\n\u5176\u4e2d $\\bar j$ \u662f $j$ \u7684\u53cd\u5411\u8fb9\u3002\n\n\u53e6\u4e00\u79cd\u60c5\u51b5\uff1a\n\n![](https://i.loli.net/2021/03/18/Vsnf9c6hIvYkCRd.png)\n\n\u7ed3\u70b9 $4$ \u4e0a\u7684 $k$ \u540d\u7f6a\u72af\u5fc5\u987b\u8981\u5206\u4e3a\u4e24\u6ce2\uff0c\u5176\u4e2d $a$ \u540d\u8dd1\u5230\u4e86\u7ed3\u70b9 $5$\uff0c$b$ \u540d\u8dd1\u5230\u4e86\u7ed3\u70b9 $6$\u3002  \n\u8b66\u5bdf\u4f1a\u4e0b\u4e00\u6b65\u4f1a\u5728 $4 \\rightarrow 5$ \u548c $4 \\rightarrow 6$ \u4e2d\u9009\u62e9\u8f83\u4f18\u7684\u4e00\u6761\u6709\u5411\u8fb9\u3002\n\n\u7f6a\u72af\u4e3a\u4e86\u6700\u5927\u5316\u65f6\u95f4\uff1a\n$$\nf_{i,1 \\rightarrow 4,k} = \\max_{a+b=k}\\min \\lbrace f_{i,4 \\rightarrow 5,a},f_{i,4 \\rightarrow 6,b}\\rbrace + w\n$$\n\u4e00\u822c\u5730\uff0c\u8bbe\u7ed3\u70b9 $v$ \u9664 $u$ \u4ee5\u5916\u7684\u76f8\u90bb\u70b9\u5206\u522b\u4e3a $a_1,a_2,a_3,\\cdots,a_d$\uff0c\u5219\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\n$$\nf_{i,j,k}=\\max_{c_1+c_2+\\cdots+c_d=k}\\min_{s=1}^df_{i,v \\rightarrow a_s,c_s} + w\n$$\n\u4e0b\u9762\u7ed9\u51fa\u4e00\u79cd\u590d\u6742\u5ea6\u6bd4\u8f83\u4f18\u79c0\u7684\u8d2a\u5fc3\u7b97\u6cd5\u5b9e\u73b0\u7b2c\u4e8c\u79cd\u8f6c\u79fb\uff1a\n\n>\u5f15\u7406\uff1a\u82e5\u6c42 $f_{i,j,k}$ \u65f6\u7684**\u51b3\u7b56**\u4e3a $c_1,c_2,\\cdots,c_d$\u3002  \n>\u90a3\u4e48\u6c42 $f_{i,j,k+1}$ \u65f6\u7684\u51b3\u7b56 $\\bar c_1,\\bar c_2,\\cdots,\\bar c_d$ \u4e00\u5b9a\u662f\u5728 $c_1,c_2,\\cdots,c_d$ \u4e2d\u7684\u67d0\u4e2a\u6570 $+1$ \u5f97\u5230\u7684\u3002  \n>\u5e76\u4e14 $+1$ \u7684\u8fd9\u4e2a $c_x$ \u6ee1\u8db3\n>$$\n>f_{i,v \\rightarrow a_x,c_x+1}=\\max_{s=1}^df_{i,v \\rightarrow a_s,c_s+1}\n>$$\n>\u8bc1\u660e\uff1a\u9996\u5148\u5728\u603b\u4eba\u6570\u548c\u4f4d\u7f6e\u76f8\u540c\u7684\u60c5\u51b5\u4e0b\uff0c\u8b66\u5bdf\u8ffd\u7684\u4eba\u8d8a\u591a\uff0c\u5269\u4e0b\u7684\u65f6\u95f4\u5c31\u8d8a\u77ed\u3002  \n>\u6545 $f_{i,j,0} \\ge f_{i,j,1} \\ge f_{i,j,2} \\ge \\cdots \\ge f_{i,j,i}$\u3002\n>\n>\u8003\u8651\n>$$\n>\\forall x \\le f_{i,j,k}\\exists c_1,c_2,\\cdots,c_d,\\\\f_{i,v \\rightarrow a_1,c_1} \\ge x\\\\f_{i,v \\rightarrow a_2,c_2} \\ge x\\\\\\cdots\\\\f_{i,v \\rightarrow a_d,c_d} \\ge x\n>$$\n>\u7531\u4e8c\u5206\u7b54\u6848\u7b97\u6cd5\u7684 ```check``` \u51fd\u6570\u53ef\u77e5\uff1a\u82e5 $m_i$ \u662f $f_{i,v \\rightarrow a_i}$ \u6570\u5217\u4e2d\u6700\u540e\u4e00\u4e2a\u5927\u4e8e\u7b49\u4e8e $x$ \u7684\u4f4d\u7f6e\uff0c  \n>\u5219 $m_1+m_2+\\cdots+m_d \\ge k$\u3002\n>\n>\u800c\u4ee5\u8fd9\u79cd\u51b3\u7b56\u7684\u6784\u9020\u65b9\u5f0f\uff0c\u4e00\u5b9a\u6709 $c_1 \\le m_1,c_2 \\le m_2, \\cdots, c_d \\le m_d$\uff0c\u56e0\u6b64\u901a\u8fc7\u8be5\u51b3\u7b56\u5f97\u5230\u7684\u503c\u4e00\u5b9a\u4e0d\u52a3\u4e8e $x$\u3002\n>\n\n\u56e0\u6b64\u53ef\u4ee5\u7528\u4e00\u4e2a\u5927\u6839\u5806\u7ef4\u62a4\u90a3\u4e2a $x$\uff0c\u53ef\u4ee5\u5728 $O(n\\log n)$ \u7684\u65f6\u95f4\u540c\u65f6\u6c42\u51fa $f_{i,j,0},f_{i,j,1},\\cdots,f_{i,j,i}$\u3002\n\n\u590d\u6742\u5ea6 $O(n^3\\log n)$\uff0c\u6807\u7b97\u7684\u590d\u6742\u5ea6\u662f $O(n^5)$ \u7684\u3002\n\n\u7136\u800c\u7531\u4e8e\u5e38\u6570\u5de8\u5927\uff0c\u6700\u5c0f\u7684\u70b9\u8981 $15$ ```ms```\uff0c\u6700\u5927\u7684\u70b9\u8981 $30$ ```ms```\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i = (l); i <= (r); i++)\n#define per(i, r, l) for(int i = (r); i >= (l); i--)\n#define mem(a, b) memset(a, b, sizeof a)\n#define For(i, l, r) for(int i = (l), i##e = (r); i < i##e; i++)\n\nusing namespace std;\nconst int N = 55, Inf = 1e9;\nint n, s, m, ev[N * 2], ew[N * 2], cnt[N], deg[N];\nvector <int> G[N];\nint f[N][N * 2][N];\nvoid solve(int, int);\nint dp(int i, int j, int k) {\n\tif(!f[i][j][k]) solve(i, j);\n\treturn f[i][j][k];\n}\nstruct node {\n\tint i, e, c;\n\tint val()const { return c < i ? dp(i, e, c + 1) : 0; }\n\tbool operator <(const node& b)const { return val() < b.val(); }\n};\nvoid solve(int i, int j) {\n\tf[i][j][0] = Inf;\n\tif(deg[ev[j]] == 1)\n\t\trep(k, 1, i) f[i][j][k] = k < i ? dp(i - k, j ^ 1, i - k) + ew[j] : ew[j];\n\telse {\n\t\tpriority_queue <node> q;\n\t\tfor(int e : G[ev[j]]) if(e ^ j ^ 1) q.push({ i, e, 0 });\n\t\trep(k, 1, i) {\n\t\t\tnode x = q.top(); q.pop();\n\t\t\tf[i][j][k] = min(f[i][j][k - 1], x.val() + ew[j]);\n\t\t\tx.c++, q.push(x);\n\t\t}\n\t}\n}\nint dfs(int u, int fa) {\n\tint res = cnt[u];\n\tfor(int e : G[u]) if(ev[e] ^ fa) res += dfs(ev[e], u);\n\treturn res;\n}\nint main() {\n\tios::sync_with_stdio(0), cin.tie(0);\n\tcin >> n;\n\tint u, v, w;\n\trep(i, 2, n) {\n\t\tint a = i * 2, b = a + 1;\n\t\tcin >> u >> v >> w, deg[ev[a] = v]++, deg[ev[b] = u]++, ew[a] = ew[b] = w;\n\t\tG[u].push_back(a), G[v].push_back(b);\n\t}\n\tcin >> s >> m;\n\trep(i, 1, m) cin >> u, cnt[u]++;\n\tint ans = Inf;\n\tfor(int e : G[s]) ans = min(ans, dp(m, e, dfs(ev[e], s)));\n\tcout << ans;\n\treturn 0;\n}\n```",
        "postTime": 1616057753,
        "uid": 177524,
        "name": "plate_let",
        "ccfLevel": 9,
        "title": "Policeman and a Tree | Codeforces 868E"
    },
    {
        "content": "[\u6211\u7684\u535a\u5ba2](https://www.cnblogs.com/Memory-of-winter/p/11193001.html)\n\n**\u9898\u76ee\u5927\u610f\uff1a** \u6709\u4e00\u68f5$n$\u4e2a\u70b9\u7684\u5e26\u8fb9\u6743\u7684\u6811\uff0c\u4e0a\u9762\u6709$m$\u4e2a\u7f6a\u72af\uff0c\u901f\u5ea6\u4e3a\u4efb\u610f\u5927\uff0c\u6709\u4e00\u4e2a\u8b66\u5bdf\u5728\u70b9$S$\uff0c\u901f\u5ea6\u4e3a$1$\u3002\u82e5\u8b66\u5bdf\u548c\u7f6a\u72af\u5728\u540c\u4e00\u4e2a\u5730\u65b9\uff0c\u7f6a\u72af\u5c31\u88ab\u5e72\u6389\u4e86\uff0c\u8b66\u5bdf\u5e0c\u671b\u5e72\u6389\u6240\u6709\u7f6a\u72af\u65f6\u95f4\u6700\u77ed\uff0c\u800c\u7f6a\u72af\u5e0c\u671b\u6700\u5927\u5316\u8fd9\u4e2a\u65f6\u95f4\u3002\u6c42\u51fa\u8fd9\u4e2a\u65f6\u95f4\uff0c\u82e5\u65e0\u89e3\u8f93\u51fa`Terrorists win`\u3002$n,m\\leqslant 50$\n\n**\u9898\u89e3\uff1a** \u4e00\u5b9a\u6709\u89e3\uff0c\u4ee4$f[u][v][x][y]$\u8868\u793a\u4ece\u8b66\u5bdf$u$\u8d70\u5230$v$\uff0c$v$\u5173\u4e8e$u$\u7684\u5b50\u6811\u5185\u6709$x$\u4e2a\u7f6a\u72af\uff0c\u53e6\u5916\u7684\u8282\u70b9\u8fd8\u6709$y$\u4e2a\u7f6a\u72af\u7684\u6700\u5c0f\u65f6\u95f4\u3002\u8b66\u5bdf\u4e00\u5b9a\u9009\u62e9$dp$\u503c\u6700\u5c0f\u7684\u8d70\uff0c\u800c\u7f6a\u72af\u7684\u5206\u5e03\u4f1a\u4f7f\u6bcf\u6761\u8fb9$dp$\u503c\u5f97\u6700\u5c0f\u503c\u6700\u5927\u3002\u7528\u7c7b\u4f3c\u80cc\u5305\u7684\u4e1c\u897f\u8f6c\u79fb\u3002\u5728\u8f6c\u79fb\u65f6\u53e6\u5f00\u4e00\u4e2a\u6570\u7ec4$g[i][j]$\u8868\u793a\u73b0\u5728\u662f$v$\u7684\u7b2c$i$\u68f5\u5b50\u6811\uff0c\u653e\u4e86$j$\u4e2a\u7f6a\u72af\u6240\u9700\u7684\u65f6\u95f4\u3002\n$$\ng[i][j]=\\max\\{g[i][j],\\min\\{g[i-1][j-k],dp[v][v'][k][x+y-k]+w\\}\\}\n$$\n$v'$\u4e3a$v$\u7684\u7b2c$i$\u68f5\u5b50\u6811\uff0c$k$\u4e3a$v'$\u8fd9\u68f5\u5b50\u6811\u653e\u51e0\u4e2a\u7f6a\u72af\uff0c$w$\u4e3a$v\\to v'$\u7684\u8fb9\u6743\u3002$g$\u660e\u663e\u53ef\u4ee5\u7528$01$\u80cc\u5305\u7684\u65b9\u6cd5\u628a\u7b2c\u4e00\u7ef4\u6eda\u6389\u3002\u5230\u53f6\u5b50\u7684\u65f6\u5019\u6293\u4f4f\u7f6a\u72af\u7136\u540e\u8fd4\u56de\u3002\u8bb0\u5fc6\u5316\u641c\u7d22\u5373\u53ef\u3002\n\n\n\n**C++ Code\uff1a**\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\nconst int maxn = 60, inf = 0x3f3f3f3f;\n\nint head[maxn], cnt = 1, deg[maxn];\nstruct Edge {\n\tint to, nxt, w;\n} e[maxn << 1];\ninline void addedge(int a, int b, int c) {\n\te[++cnt] = (Edge) { b, head[a], c }; head[a] = cnt;\n\te[++cnt] = (Edge) { a, head[b], c }; head[b] = cnt;\n\t++deg[a], ++deg[b];\n}\n\nint n, m, S, sz[maxn];\nint f[maxn << 1][maxn][maxn];\nvoid dfs(int u, int fa = 0) {\n\tfor (int i = head[u], v; i; i = e[i].nxt) {\n\t\tv = e[i].to;\n\t\tif (v != fa) dfs(v, u), sz[u] += sz[v];\n\t}\n}\nint dp(int E, int x, int y) {\n\tif (!x && !y) return 0;\n\tint &F = f[E][x][y], u = e[E].to;\n\tif (~F) return F;\n\tif (deg[u] == 1) {\n\t\tif (y == 0) return 0;\n\t\treturn F = dp(E ^ 1, y, 0) + e[E].w;\n\t}\n\tint g[maxn];\n\tmemset(g, 0, sizeof g), g[0] = inf;\n\tfor (int i = head[u], v; i; i = e[i].nxt) if (i ^ E ^ 1) {\n\t\tv = e[i].to;\n\t\tfor (int j = x; j; --j)\n\t\t\tfor (int k = j; k; --k)\n\t\t\t\tg[j] = std::max(g[j], std::min(g[j - k], dp(i, k, x + y - k) + e[i].w));\n\t}\n\treturn F = g[x];\n}\n\nint main() {\n\tstd::ios::sync_with_stdio(false), std::cin.tie(0), std::cout.tie(0);\n\tstd::cin >> n;\n\tfor (int i = 1, a, b, c; i < n; ++i) {\n\t\tstd::cin >> a >> b >> c;\n\t\taddedge(a, b, c);\n\t}\n\tstd::cin >> S >> m;\n\tfor (int i = 0, x; i < m; ++i) std::cin >> x, ++sz[x];\n\tdfs(S), memset(f, -1, sizeof f);\n\tint ans = inf;\n\tfor (int i = head[S], v; i; i = e[i].nxt) {\n\t\tv = e[i].to;\n\t\tans = std::min(ans, dp(i, sz[v], m - sz[v]) + e[i].w);\n\t}\n\tstd::cout << ans << '\\n';\n\treturn 0;\n}\n\n```\n\n",
        "postTime": 1563241459,
        "uid": 22072,
        "name": "Memory_of_winter",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF868E \u3010Policeman and a Tree\u3011"
    }
]
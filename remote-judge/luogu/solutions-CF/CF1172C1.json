[
    {
        "content": "\u8003\u8651 DP\uff0c\u6211\u4eec\u53d1\u73b0\u6982\u7387\u7684\u8ba1\u7b97\u7275\u6d89\u4e09\u4e2a\u503c\uff0c\u4e00\u4e2a\u662f\u4e0d\u559c\u6b22\u7684\u56fe\u7247\u7684\u6743\u503c\u548c\uff0c\u4e00\u4e2a\u662f\u559c\u6b22\u7684\u56fe\u7247\u7684\u6743\u503c\u548c\uff0c\u8fd8\u6709\u4e00\u4e2a\u662f\u672c\u8eab\u7684\u6743\u503c\u3002\n\n\u6211\u4eec\u8bb0\u521d\u59cb\u65f6\u559c\u6b22\u7684\u6743\u503c\u548c\u662f $W_a$\uff0c\u4e0d\u559c\u6b22\u7684\u6743\u503c\u548c\u662f $W_b$\uff0c\u5f53\u524d\u7684\u662f $W'_a,W'_b$\uff0c\u4e00\u6b21\u64cd\u4f5c\u4f1a\u4f7f\u5f97 $W_a'$ \u52a0\u4e00\u6216\u662f $W_b'$ \u51cf\u4e00\u3002\n\n\u5bf9\u4e8e\u4e00\u5f20\u56fe\u7247\uff0c\u6211\u4eec\u5728\u610f\u7684\u5e76\u975e\u5176\u7f16\u53f7\uff0c\u800c\u662f\u5176\u521d\u59cb\u6743\u503c\uff0c\u540c\u65f6\u5176\u5b83\u56fe\u7247\u4e5f\u53ef\u4ee5\u770b\u4f5c\u4e24\u5927\u7c7b\u800c\u65e0\u9700\u5206\u6790\uff0c\u4e8e\u662f\u4ee4 $F(w,i,a,b)$  \u8868\u793a\u4e00\u4e2a\u6743\u503c\u4e3a $w$ \u7684\u4e14\u88ab\u559c\u6b22\u7684\u56fe\u7247\uff0c\u7ecf\u8fc7 $i$ \u6b21\u64cd\u4f5c\uff0c$W_a'=a,W_b'=b$ \u65f6\u7684\u671f\u671b\u6743\u503c\uff0c\u4e3a\u4e86\u8ba1\u7b97\u6982\u7387\uff0c\u6211\u4eec\u9009\u62e9\u5728\u64cd\u4f5c\u5e8f\u5217\u524d\u63d2\u5165\u4e00\u4e2a\u64cd\u4f5c\uff0c\u800c\u975e\u5728\u64cd\u4f5c\u5e8f\u5217\u540e\u63d2\u5165\u4e00\u4e2a\u64cd\u4f5c\uff0c\u90a3\u4e48\u4e00\u5171\u6709\u4e09\u79cd\u8f6c\u79fb\u6765\u6e90\uff1a\n\n- \u9009\u5230\u81ea\u5df1\uff0c\u6982\u7387\u4e3a $\\frac{w}{a+b}$\uff0c\u4ece $F(w+1,i-1,a+1,b)$ \u8f6c\u79fb\u8fc7\u6765\uff1b\n- \u9009\u5230\u559c\u6b22\u7684\u56fe\u7247\u4f46\u4e0d\u662f\u81ea\u5df1\uff0c\u6982\u7387\u4e3a $\\frac{a-w}{a+b}$\uff0c\u4ece $F(w,i-1,a+1,b)$ \u8f6c\u79fb\u8fc7\u6765\uff1b\n- \u9009\u5230\u4e0d\u559c\u6b22\u7684\u56fe\u7247\uff0c\u6982\u7387\u4e3a $\\frac{b}{a+b}$\uff0c\u4ece $F(w,i-1,a,b-1)$ \u8f6c\u79fb\u8fc7\u6765\u3002\n\n\u6240\u4ee5\u6709\uff1a\n$$\nF(w,i,a,b)=\\frac{w}{a+b}F(w+1,i-1,a+1,b)+\\frac{a-w}{a+b}F(w,i-1,a+1,b)+\\frac{b}{a+b}F(w,i-1,a,b-1)\n$$\n\u590d\u6742\u5ea6\u8fc7\u9ad8\uff0c\u9700\u8981\u4f18\u5316\u3002\n\n\u53d1\u73b0 $w$ \u8fd9\u4e00\u7ef4\u5f88\u6076\u5fc3\uff0c\u53ef\u4ee5\u53bb\u6389\u5b83\u5417\uff1f\n\n\u7ecf\u8fc7\u89c2\u5bdf\uff0c\u6211\u4eec\u60ca\u4eba\u5730\u53d1\u73b0 $F(w,i,a,b)=wF(1,i,a,b)$\uff01\n\n\u8bc1\u660e\u53ef\u4ee5\u4f7f\u7528\u5f52\u7eb3\u6cd5\u3002\n\n\u90a3\u4e48\u6211\u4eec\u4ee4 $F(i,a,b)$ \u8868\u793a\u539f\u6765\u7684 $F(1,i,a,b)$\uff0c\u5c31\u6709\uff1a\n\n$$F(i,a,b)=\\frac{1}{a+b}((a+1)F(i-1,a+1,b)+bF(i-1,a,b-1))$$\n\n\u521d\u503c $F(0,a,b)=1$\uff0c\u6700\u540e\u8981\u6c42\u7684\u662f $F(m,W_a,W_b)$\u3002\n\n\u6211\u4eec\u89c2\u5bdf $F(m,W_a,W_b)$ \u4f1a\u4ece\u54ea\u91cc\u8f6c\u79fb\u8fc7\u6765\uff0c\u4e5f\u5c31\u662f\u6709\u6548\u7684\u72b6\u6001\u662f\u54ea\u4e9b\uff0c\u53ef\u4ee5\u53d1\u73b0\u540e\u4e24\u7ef4\u7684\u53d8\u5316\u91cf\u4e4b\u548c\u5c31\u7b49\u4e8e\u7b2c\u4e00\u7ef4\u7684\u53d8\u5316\u91cf\uff0c\u800c\u4e14\u968f\u7740\u7b2c\u4e00\u7ef4\u51cf\u5c11\u4e00\uff0c\u53ef\u80fd\u662f\u7b2c\u4e8c\u7ef4\u589e\u52a0\u4e00\uff0c\u6216\u8005\u662f\u7b2c\u4e09\u7ef4\u51cf\u5c11\u4e00\u3002\n\n\u6211\u4eec\u65b0\u641e\u4e00\u4e2a $F^*(a,b)$ \u8868\u793a\u7b2c\u4e8c\u7ef4\u548c\u7b2c\u4e09\u7ef4\u7684\u76f8\u8f83\u4e8e $W_a$ \u4e0e $W_b$ \u7684\u53d8\u5316\u91cf\uff0c\u90a3\u4e48\u6211\u4eec\u77e5\u9053 $F^*(a,b)=F(m-a-b,W_a+a,W_b-b)$\u3002\n\n\u8bb0 $W=W_a+a+W_b-b$\uff0c\u4e8e\u662f\u6709\u8f6c\u79fb\uff1a\n$$\nF^*(a,b)=\\frac{1}{W}((W_a'+1)F(a+1,b)+W_b'F(a,b+1))\n$$\n\u7c7b\u4f3c\u7684\u4ee4 $G^*(a,b)$ \u8868\u793a\u4e0d\u559c\u6b22\u7684\u56fe\u7247\uff0c\u6709\u8f6c\u79fb\uff1a\n$$\nG^*(a,b)=\\frac{1}{W}((W_b'+1)G(a,b+1)+W_a'G(a+1,b))\n$$\n\u521d\u503c $\\forall a+b=m,F^*(a,b)=G^*(a,b)=1$\uff0c\u6700\u7ec8\u9700\u8981 $F^*(0,0),G^*(0,0)$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n+m^2\\log P)$\uff0c\u5176\u4e2d $P=998244353$\u3002",
        "postTime": 1616294464,
        "uid": 83547,
        "name": "LCuter",
        "ccfLevel": 7,
        "title": "CF1172C1"
    }
]
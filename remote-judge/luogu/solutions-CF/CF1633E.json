[
    {
        "content": "\u8003\u8651 `kruskal` \u7684\u8fc7\u7a0b\uff0c\u5b9e\u9645\u4e0a `MST` \u7684\u6784\u6210\u53ea\u548c\u6309\u8fb9\u6743\u6392\u5e8f\u540e\u7ed3\u679c\u6709\u5173\u3002\u8003\u8651\u4efb\u610f\u4e24\u6761\u8fb9 $i$ \u548c $j$ \u4e4b\u95f4\u7684\u5927\u5c0f\u5173\u7cfb\u4ee5 $x=\\dfrac{w_i+w_j}{2}$ \u4e3a\u754c\uff0c\u53ea\u6709 $O(m^2)$ \u79cd `MST` \uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e8e\u6bcf\u79cd\u60c5\u51b5\u8dd1\u51fa\u5bf9\u5e94\u7684 `MST`\uff0c\u6b64\u90e8\u5206\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(m^3\\log m)$\u3002~~\uff08\u5e38\u6570\u5f88\u5c0f\uff0c\u4e14\u6709 cf \u7684\u795e\u673a\u52a0\u6301\uff0c\u8dd1\u7684\u5f88\u5feb\uff09~~\n\n\u5bf9\u4e8e\u540c\u79cd `MST`\uff0c\u5904\u7406\u51fa\u8981\u9009\u90a3\u4e9b\u8fb9\u540e\uff0c\u5bf9\u4e8e\u4e0d\u540c\u7684 $x$ \u53ef\u4ee5\u7528\u53cc\u6307\u9488\u5904\u7406\u3002\uff08\u5177\u4f53\u6765\u8bf4\u6309\u5347\u5e8f\u5904\u7406 $x$\uff0c\u540c\u65f6\u6309\u5347\u5e8f\u52a0\u5165\u6ee1\u8db3 $w_i\\leq x$ \u4e14\u5728 `MST` \u4e2d\u7684\u8fb9\uff0c\u7ef4\u62a4\u5b83\u4eec\u7684\u6570\u91cf\u548c\u6743\u548c\uff09\n\n\u7efc\u5408\u4e00\u4e0b\uff0c\u6211\u4eec\u5f97\u5230\u8fd9\u6837\u4e00\u4e2a\u7b97\u6cd5\uff1a\u5c06\u8be2\u95ee\u7684 $x$ \u6309\u5347\u5e8f\u6392\u5e8f\uff0c\u540c\u65f6\u6309\u5347\u5e8f\u5904\u7406\u4e0d\u540c\u6bb5\u7684 `MST`\uff0c\u6c42\u51fa\u5f53\u524d\u6bb5\u7684 `MST` \uff0c\u94a6\u5b9a\u9009\u54ea\u4e9b\u8fb9\uff0c\u540e\u6309\u5347\u5e8f\u5904\u7406\u8be2\u95ee\uff0c\u5904\u7406\u8be2\u95ee\u65f6\u6309\u5347\u5e8f\u52a0\u8fb9\u3002~~\uff08\u4e09\u6307\u9488\uff09~~\n\n\u5982\u679c\u4f7f\u7528\u5feb\u6392\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(m^3\\log m +q\\log q)$\u3002\n\n\n------------\n\n\n~~\u4f60\u95ee\u7ed9\u957f\u5ea6 $10^7$ \u7684\u6570\u7ec4\u6392\u5e8f\u4e0d\u4f1a\u6709\u95ee\u9898\u5417\uff1f\u5f53\u65f6\u6211\u4e5f\u89c9\u5f97\u8dd1\u4e0d\u8fc7\u53bb\uff0c\u4f46\u4e8b\u5b9e\u8bc1\u660e\u4f60\u53ef\u4ee5\u6c38\u8fdc\u76f8\u4fe1 `std::sort` \u7684\u5e38\u6570\uff0c\u5982\u679c\u5b9e\u5728\u62c5\u5fc3\u5c31\u7528\u677e\u6c0f\u57fa\u6392\u3002\uff08\u96fe\uff09~~\n\n",
        "postTime": 1643812767,
        "uid": 241977,
        "name": "Legitimity",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1633E"
    },
    {
        "content": "## \u524d\u8a00\n\n\u9898\u76ee\u5185\u5bb9\u4e0d\u591a\u8d58\u8ff0\u3002\n\n\u53cd\u6b63\uff0c\u6211\u7ba1\u8fd9\u4e1c\u897f\uff0c\u53eb\u201c\u7edd\u5bf9\u503c\u51fd\u6570\u6700\u5c0f\u751f\u6210\u6811\u201d\u3002\n\n\u8fd9\u9053\u9898\u60f3\u51fa\u89e3\u6cd5\u7684\u6838\u5fc3\u5c31\u5728\u4e8e\u4ed6\u7ed9\u7684\u6570\u636e\u8303\u56f4\uff08\u5176\u5b9e\u6709\u63d0\u793a\u7684\u4f5c\u7528\uff09\uff0c\u8fd8\u6709\u7edd\u5bf9\u503c\u51fd\u6570\u7684\u6027\u8d28\u3002\n\n\u8bdd\u4e0d\u591a\u8bf4\uff0c\u6211\u4eec\u5f00\u59cb\u6b63\u9898\u3002\n\n## \u5206\u6790\n\n\u7531\u9898\u76ee\u4e2d\u51e0\u4e2a\u5173\u952e\u7684\u6570\u636e\u8303\u56f4\uff1a\n\n$1 \\leq n \\leq 50$\n\n$n-1 \\leq m \\leq 300$\n\n$p \\leq k \\leq 10^7$\n\n\u4ee5\u53ca\u505a\u4e00\u6b21\u6700\u5c0f\u751f\u6210\u6811\uff08MST\uff09\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $mlog(m)$\uff08kruskal \u7b97\u6cd5\uff09\uff0c\u6211\u4eec\u5927\u6982\u53ef\u4ee5\u628a\u5bf9 $k$ \u6b21\u8be2\u95ee\u6bcf\u4e00\u4e2a\u8be2\u95ee\u505a\u4e00\u6b21 MST \u7684 BF \u60f3\u6cd5\u63a8\u7ffb\uff0c\u90a3\u4e48\u73b0\u5728\u8be5\u600e\u4e48\u505a\u5462\uff1f\n\n\u4e0d\u59a8\u6765\u89c2\u5bdf\u4e00\u4e0b\u9898\u76ee\u6761\u4ef6\u4e2d\u6240\u7ed9\u7684\u7edd\u5bf9\u503c\u51fd\u6570\u7684\u6027\u8d28\u3002\n\n\u6211\u4eec\u753b\u4e2a\u56fe\uff08\u4f7f\u7528 geogebra\uff09\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/795s6rik.png)\n\n\u6211\u4eec\u77e5\u9053\uff0c\u5728\u8fd9\u9053\u9898\u91cc\u9762\uff0c\u505a MST \u65f6\u6bcf\u6761\u8fb9\u7684\u6743\u503c\u5e94\u8be5\u662f\u7ed9\u5b9a $q$ \uff08\u6216\u8005\u8bf4 $x$\uff09\u4ee5\u540e\u7684\u6743\u503c\uff08\u5bf9\u5e94\u5230\u56fe\u4e2d\u4fbf\u662f\u7ed9\u5b9a\u6a2a\u5750\u6807 $x$\uff0c\u6bcf\u4e2a\u51fd\u6570\uff08\u8fb9\u6743\u503c\uff09\u6240\u5bf9\u5e94\u7684 $y$ \u503c\uff09\u3002\n\n\u7136\u540e\u770b\u56fe\u53ef\u4ee5\u53d1\u73b0\uff0c\u5728\u4e00\u5b9a\u8303\u56f4\u5185\uff0c\u8fb9\u6743\u51fd\u6570\u7684\u5927\u5c0f\u5173\u7cfb\u662f\u786e\u5b9a\u7684\uff0c\u7136\u540e\u589e\u51cf\u6027\u4e5f\u662f\u786e\u5b9a\u7684\uff0c\u8003\u8651 kruskal \u7b97\u6cd5\u7684\u6392\u5e8f\u8fc7\u7a0b\uff0c\u4e0d\u96be\u53d1\u73b0\u5f53\u51fd\u6570\u5927\u5c0f\u5173\u7cfb\u786e\u5b9a\u65f6\uff0c\u6c42\u51fa\u7684 MST \u4e5f\u662f\u552f\u4e00\u7684\u3002\n\n\u597d\u4e86\uff0c\u6240\u4ee5\u73b0\u5728\u6211\u4eec\u6309\u7167\u8fd9\u4e9b\u7edd\u5bf9\u503c\u51fd\u6570\u5f7c\u6b64\u4e4b\u95f4\u8fd8\u6709\u5b83\u4eec\u4e0e $x$ \u8f74\u7684\u4ea4\u70b9\uff0c\u5c06\u6570\u8f74\u5206\u6bb5\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u6bb5\u6c42\u51fa\u5b83\u5f00\u59cb\u70b9 $x$ \u503c\u5bf9\u5e94\u7684\u7b54\u6848\uff0c\u5e76\u4e14\u7edf\u8ba1\u589e\u51cf\u6027\u3002\u8fd9\u6837\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $q$ \u6211\u4eec\u53ef\u4ee5\u4e8c\u5206\u67e5\u627e\u5230\u5b83\u7684\u6240\u5728\u6bb5\uff0c\u7136\u540e\u6839\u636e\u589e\u51cf\u6027 $O(1)$ \u5730\u8ba1\u7b97\u51fa\u7b54\u6848\u3002\n\n\u7531\u4ee5\u4e0a\u8fc7\u7a0b\u53ef\u77e5\uff0c\u8be5\u7b97\u6cd5\u603b\u590d\u6742\u5ea6\u4e3a\uff1a $O(m^3log(m)+klog(m^2))$\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n\u8981\u6ce8\u610f\u7684\u7ec6\u8282\uff1a\n\n1. kruskal \u6392\u5e8f\u8fb9\u6743\u65f6\uff0c\u4ee5\u52a0\u7edd\u5bf9\u503c\u540e\u7684\u8fb9\u6743\u4e3a\u7b2c\u4e00\u5173\u952e\u5b57\u5347\u5e8f\uff0c\u4ee5\u52a0\u7edd\u5bf9\u503c\u524d\u7684\u8fb9\u6743\u4e3a\u7b2c\u4e8c\u5173\u952e\u5b57\u964d\u5e8f\u6392\u5e8f\uff0c\u8fd9\u6837\u53ef\u4ee5\u8ba9\u6bcf\u4e00\u6bb5\u4e2d\u7684\u51cf\u51fd\u6570\u5c3d\u53ef\u80fd\u591a\uff0c\u4fdd\u6301\u7b54\u6848\u6700\u5c0f\u7684\u6b63\u786e\u6027\u3002\n\n2. \u4e0d\u5f00 long long \u89c1\u7956\u5b97\u3002\n\n3. \u5206\u6bb5\u7aef\u70b9\u8981\u53bb\u91cd\u3002\n\n\u53c2\u8003\u4ee3\u7801\uff08\u6709\u70b9\u4e11\uff09\uff1a\n\n```cpp\n/*\n  Author:Lucky_Yukikaze\n  \n*/\n#include<bits/stdc++.h>\n#define int long long\n#define ll long long\n#define ull unsigned long long\n#define ui unsigned int\n#define re register\n#define pb push_back\n#define mp make_pair\n#define pf pop_front\n#define pob pop_back\n#define fr front\n#define bk back\n\nusing namespace std;\ntypedef pair<int,int> pii;\ntypedef long double ld;\ntypedef pair<ll,ll> pll;\n\nint n,m;\n\nstruct dsu{\n\t\n\tint fa[55];\n\t\n\tvoid init(int x){\n\t\tfor(int i=1;i<=x;i++)fa[i]=i;\n\t}\n\t\n\tint getfa(int x){\n\t\treturn (fa[x]==x)?(x):(fa[x]=getfa(fa[x]));\n\t}\n\t\n\tbool merge(int x,int y){\n\t\tint fx=getfa(x),fy=getfa(y);\n\t\tif(fx==fy)return false;\n\t\telse{\n\t\t\tfa[fx]=fy;\n\t\t\treturn true;\n\t\t}\n\t}\n\t\n}bcj;\n\nstruct edge{\n\tint u,v,w,ow;\n}e[310],et[310];\n\nstruct point{\n\tint val,up;\n}poi[90010],uni[90010];int tot=0,cnt=1;\nint ans[90010];\n\nint bins(int q){\n\tint l=1,r=cnt;\n\tint res;\n\twhile(l<=r){\n\t\tint mid=(l+r)>>1;\n\t\tif(uni[mid].val<=q)res=mid,l=mid+1;\n\t\telse r=mid-1;\n\t}\n\treturn res;\n}\n\nsigned main(){\n\tios::sync_with_stdio(false);\n\tcin.tie(nullptr);cout.tie(nullptr);\n\n\tcin>>n>>m;\n\t\n\t\n\tfor(int i=1;i<=m;i++){\n\t\tcin>>e[i].u>>e[i].v>>e[i].w;\n\t}\n\tsort(e+1,e+1+m,[](edge tp1,edge tp2){return tp1.w<tp2.w;});\n\t\n\tfor(int i=1;i<=m;i++){\n\t\tfor(int j=i;j<=m;j++){\n\t\t\tpoi[++tot].val=(e[i].w+e[j].w)/2+((e[i].w+e[j].w)%2);\n\t\t}\n\t}\n\t\n\tsort(poi+1,poi+1+tot,[](point tp1,point tp2){return tp1.val<tp2.val;});\n\t\n\tuni[1]=(point){0,0};\n\tfor(int i=1;i<=tot;i++){\n\t\tif(poi[i].val!=uni[cnt].val){\n\t\t\tuni[++cnt].val=poi[i].val;\n\t\t}\n\t}\n\t\n\tfor(int i=1;i<=cnt;i++){\n\t\tfor(int j=1;j<=m;j++){\n\t\t\tet[j]=(edge){e[j].u,e[j].v,labs(e[j].w-uni[i].val),e[j].w};\n\t\t}\n\t\tsort(et+1,et+1+m,[](edge tp1,edge tp2){return (tp1.w==tp2.w)?(tp1.ow>tp2.ow):(tp1.w<tp2.w);});\n\t\tbcj.init(n);\n\t\tfor(int j=1;j<=m;j++){\n\t\t\tif(bcj.merge(et[j].u,et[j].v)){\n\t\t\t\tans[i]+=et[j].w;\n\t\t\t\tif(et[j].ow<=uni[i].val)uni[i].up++;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tint p,k,a,b,c;\n\t\n\tcin>>p>>k>>a>>b>>c;\n\t\n\tint final=0;\n\tint q;\n\tfor(int i=1;i<=p;i++){\n\t\tcin>>q;\n\t\tint pos=bins(q);\n\t\tint tp=((ans[pos])+(q-uni[pos].val)*uni[pos].up-(q-uni[pos].val)*(n-1-uni[pos].up));\n\t\tfinal^=tp;\n\t}\n\t\n\tfor(int i=p+1;i<=k;i++){\n\t\tq=(q*a+b)%c;\n\t\tint pos=bins(q);\n\t\tint tp=((ans[pos])+(q-uni[pos].val)*uni[pos].up-(q-uni[pos].val)*(n-1-uni[pos].up));\n\t\tfinal^=tp;\t\n\t\t}\n\t\n\tcout<<final;\n\t\n\treturn 0;\n}\n```\n",
        "postTime": 1643778020,
        "uid": 93701,
        "name": "Lucky_Yukikaze",
        "ccfLevel": 9,
        "title": "Sol.CF1633E"
    },
    {
        "content": "### \u5927\u610f\n\u6709\u4e00\u6709 n \u4e2a\u8282\u70b9\u548c m \u6761\u8fb9\u7684\u52a0\u6743\u8fde\u901a\u65e0\u5411\u56fe\u3002\u6709 k \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u7ed9\u51fa\u4e00\u4e2a\u6574\u6570 $q_i$\uff0c\u6c42\u6240\u6709\u751f\u6210\u6811\u4e2d $\\sum\\limits_{j=1}^{\nn-1}|w_j-q_i|$\uff08$w_j$ \u4e3a\u751f\u6210\u6811\u5404\u8fb9\u7684\u6743\u503c\uff09\u7684\u6700\u5c0f\u503c\u3002\u8f93\u51fa\u5404\u6b21\u8be2\u95ee\u7b54\u6848\u7684\u5f02\u6216\u548c\u3002\n### \u601d\u8def\n\n\u6211\u4eec\u5148\u601d\u8003\u66b4\u529b\u7684\u601d\u8def\uff1a\u4e5f\u5c31\u662f\u6bcf\u6b21\u8bfb\u5165\u65f6\u8ba1\u7b97\u6bcf\u6761\u8fb9\u7684\u6743\u503c\uff0c\u7136\u540e Kruskal \u5373\u53ef\uff0c\u4f46\u662f\u8fd9\u6837\u663e\u7136\u590d\u6742\u5ea6\u592a\u9ad8\u3002\u4e8e\u662f\u6211\u4eec\u601d\u8003\uff0c\u53ef\u4e0d\u53ef\u4ee5\u5c11\u8fdb\u884c\u51e0\u6b21\u7b97\u6cd5\u5462\uff1f\n\u6211\u4eec\u53d1\u73b0\uff0c\u5bf9\u4e8e\u56fa\u5b9a\u7684 $w_1$ \u4e0e $w_2$\uff0c\u6539\u53d8 q \u7684\u503c\u65f6\uff0c$|w_1-q|$ \u548c $|w_2-q|$ \u7684\u5927\u5c0f\u5173\u7cfb\u4e0d\u603b\u662f\u4f1a\u6539\u53d8\u3002\u6bd4\u5982\u8bf4\uff0c[\u5982\u56fe](https://img2022.cnblogs.com/blog/2345790/202202/2345790-20220211164028773-2123928017.gif)\uff0c\u6211\u4eec\u53d6 $w_1 = -3,w_2 = 1$ \u8fdb\u884c\u6a21\u62df\uff0c\u753b\u51fa $y=|x-q|$ \u7684\u51fd\u6570\u56fe\u50cf\uff0c\u5728 x=-3 \u548c x=1 \u65f6\u53d6\u51fd\u6570\u4e0a\u7684\u70b9 A \u548c B\u3002\u6211\u4eec\u53d1\u73b0\u6709 $\\begin{cases}|w_1-q|<|w_2-q|&q\\in(-\\infty,-1)\\\\|w_1-q|=|w_2-q|&q=-1\\\\|w_1-q|>|w_2-q|&q\\in(-1,+\\infty)\\end{cases}$ \u3002\u7531\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u63a8\u51fa\uff0c$\\forall w_1,w_2(w_1 < w_2),\\begin{cases}|w_1-q|<|w_2-q|&q\\in(-\\infty,\\dfrac{w_1+w_2}{2})\\\\|w_1-q|=|w_2-q|&q=\\dfrac{w_1+w_2}{2}\\\\|w_1-q|>|w_2-q|&q\\in(\\dfrac{w_1+w_2}{2},+\\infty)\\end{cases}$\u3002\n\n\u540c\u65f6\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u5728\u4e00\u5b9a\u8303\u56f4\u5185\uff0cq \u6539\u53d8\u65f6\uff0c\u8fb9\u6743\u7684\u5927\u5c0f\u5173\u7cfb\u662f\u4e00\u5b9a\u7684\uff0c\u6700\u7ec8\u7ed3\u679c\u4e0e q \u7684\u53d8\u5316\u91cf\u662f\u5448\u4e00\u6b21\u51fd\u6570\u5173\u7cfb\uff08\u56e0\u4e3a q+1 \u65f6\uff0c\u6240\u6709 $|w_i-q|$ \u5bf9\u5e94 +1 \u6216 -1\uff09\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u6309\u7167\u6240\u6709\u7684 $w_i$ \u548c\u6240\u6709\u7684 $\\dfrac{w_i+w_j}{2}$ \u628a\u6570\u8f74\u96f6\u70b9\u5206\u6bb5\uff0c\u5e76\u8ba1\u7b97\u51fa\u6539\u53d8 q \u65f6\u6700\u7ec8\u7ed3\u679c\u7684\u589e\u51cf\u91cf\uff0c\u6700\u540e\u8f93\u5165 q \u65f6\u4e8c\u5206\u67e5\u627e\u5176\u6240\u5728\u6bb5\uff0c\u6839\u636e\u589e\u51cf\u91cf\u5904\u7406\u51fa\u7b54\u6848\u5373\u53ef\u3002  \n\n- Q\uff1a\u4e3a\u4ec0\u4e48\u6240\u6709\u7684 $w_i$ \u8981\u7b97\u4f5c\u96f6\u70b9\uff1f\n- A\uff1a[\u5982\u56fe](https://img2022.cnblogs.com/blog/2345790/202202/2345790-20220211164439110-419899053.gif)\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u5728 $(-\\infty,w_i]$ \u548c $[w_i,+\\infty)$ \u4e0a\uff0c$y=|w_i-q|$ \u7684\u589e\u51cf\u6027\u5e76\u4e0d\u76f8\u540c\uff0c\u6240\u4ee5\u4e3a\u4e86\u4e0d\u5f71\u54cd\u7b54\u6848\u8ba1\u7b97\uff08\u89c1 $Q\\&A\\ 4$\uff09\uff0c\u6211\u4eec\u5c06 $w_i$ \u4e5f\u7eb3\u5165\u96f6\u70b9\u4e2d\u3002\n\n\n- Q\uff1a\u5982\u4f55\u8ba1\u7b97 q \u589e\u52a0\u65f6\u6709\u591a\u5c11\u7684 $|w_i-q|$ \u4f1a\u589e\u52a0\uff1f\n- A\uff1a\u5982\u4e0a\u56fe\uff0c\u5f53 $w_i<q$ \u65f6\uff0c$|w_i-q|$ \u968f q \u589e\u52a0\u800c\u589e\u5927\uff0c\u53cd\u4e4b\u4ea6\u7136\u3002\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u7edf\u8ba1\u591a\u5c11 $w_i<q$ \u5373\u53ef\u3002\n\n- Q\uff1a\u4e3a\u4ec0\u4e48\u6392\u5e8f\u8fd9\u4e48\u6392\uff1f\n- A\uff1a\u9996\u5148\uff0c\u7b2c\u4e00\u5173\u952e\u5b57\u662f $|w_i-q|$\uff0c\u5347\u5e8f\u6392\u5e8f\uff0c\u8fd9\u662f\u663e\u7136\u7684\u3002\u7b2c\u4e8c\u5173\u952e\u5b57\u662f $w_i$\uff0c\u964d\u5e8f\u6392\u5217\uff0c\u4f7f\u5f97MST\u9009\u5230\u7684\u8fb9\u591a\u4e3a $w_i>q$ \u7684\uff0c\u4f7f\u5f97\u6700\u7ec8\u7b54\u6848\u6700\u5c0f\uff08\u539f\u56e0\u89c1 $Q\\&A\\ 2\\And4$\uff09\u3002\n\n- Q\uff1a\u7ed3\u679c\u600e\u4e48\u7b97\uff1f\n- A\uff1a\u9996\u5148\uff0c\u5047\u8bbe\u4e8c\u5206\u51fa\u6765\u7684\u96f6\u70b9\u4e3a res\uff0c\u8be5\u96f6\u70b9\u5904\u7684 MST \u7b54\u6848\u4e3a $mst_{res}.cost$\uff0c\u7531\u4e8e\u6700\u7ec8\u7ed3\u679c\u4e0e q \u7684\u53d8\u5316\u91cf\u662f\u4e00\u6b21\u51fd\u6570\u5173\u7cfb\uff0c\u6240\u4ee5\u6700\u7ec8\u7ed3\u679c $=mst_{res}.cost+(\\Delta q\\times up-\\Delta q\\times(n-1-up))$\uff08up \u4e3a\u968f q \u589e\u52a0\u800c\u589e\u52a0\u7684 $|w_i-q|$ \u6570\u91cf\uff0c\u53c8\u7531\u4e8e\u751f\u6210\u6811\u4e00\u5171\u662f n-1 \u6761\u8fb9\uff0c\u56fa\u6709 (n-1-up) \u6761\u8fb9\u7684 $|w_i-q|$ \u968f q \u589e\u52a0\u800c\u51cf\u5c0f\uff09\u3002\n### \u4ee3\u7801\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#define ll long long\n#define maxn 55\n#define maxm 305\nusing namespace std;\nll n,m,u[maxm],v[maxm],w[maxm],p,k,aa,bb,cc,q;\nstruct node{\n\tll from,to,dis,oridis;//\u4e24\u4e2a\u7aef\u70b9\u3001|w[i]-q|\u548c\u539f\u6765\u7684\u6743\u503c\n}a[maxm];\nstruct msts{\n\tll cost,up;//\u7edf\u8ba1\u96f6\u70b9\u7684MST\u4ef7\u503c\u548cq\u589e\u52a0\u65f6\u6709\u591a\u5c11|w[i]-q|\u4f1a\u589e\u52a0\n}mst[maxm*maxm];\nll ld[maxm*maxm],len=0;//\u96f6\u70b9\nll f[maxn];\nll aabs(ll x) {return x<0?-x:x;}\nbool cmp(node aaa,node bbb) {if(aaa.dis==bbb.dis) return aaa.oridis>bbb.oridis;else return aaa.dis<bbb.dis;}\nvoid clear() {for(ll i=1;i<=n;i++) f[i]=i;}\nll ffind(ll x) {if(f[x]==x) return x;else return f[x]=ffind(f[x]);}\nll bisearch(ll q){//\u4e8c\u5206\u67e5\u627e\u6240\u5c5e\u533a\u95f4\n\tll l=1,r=len,res=0,mid=0;\n\twhile(l<=r){\n\t\tmid=(l+r)/2;\n\t\tif(q<ld[mid]) r=mid-1;else {res=mid;l=mid+1;}\n\t}\n\treturn res;\n}\nint main(){\n\t//\u8f93\u5165\u56fe\u7684\u70b9\u548c\u8fb9 \n\tscanf(\"%lld%lld\",&n,&m);\n\tfor(ll i=1;i<=m;i++) scanf(\"%lld%lld%lld\",&u[i],&v[i],&w[i]);\n\t//\u5904\u7406\u6240\u6709\u96f6\u70b9 \n\tld[++len]=0;\n\tfor(ll i=1;i<=m;i++){\n\t\tfor(ll j=i;j<=m;j++){\n\t\t\tld[++len]=(w[i]+w[j])/2+((w[i]+w[j])%2);//\u5c06\u6240\u6709\u7aef\u70b9\u5b58\u5165\u6570\u7ec4\n\t\t}\n\t}\n\tsort(ld+1,ld+1+len); len=unique(ld+1,ld+1+len)-ld-1;//\u6392\u5e8f+\u53bb\u91cd\n\t//\u5904\u7406\u6240\u6709\u96f6\u70b9\u7684MST\u6743\u503c\u548c \n\tfor(ll i=1;i<=len;i++){\n\t\tfor(ll j=1;j<=m;j++){\n\t\t\ta[j]=(node){u[j],v[j],aabs(w[j]-ld[i]),w[j]};\n\t\t}\n\t\tsort(a+1,a+1+m,cmp);\n\t\tclear();\n\t\tfor(ll j=1;j<=m;j++){\n\t\t\tll r1=ffind(a[j].from),r2=ffind(a[j].to);\n\t\t\tif(r1!=r2) {f[r2]=r1;mst[i].cost+=a[j].dis;if(a[j].oridis<=ld[i]) mst[i].up++;}\n\t\t}\n\t}\n\t//\u8bfb\u5165\u5e76\u5904\u7406\u7b54\u6848 \n \tscanf(\"%lld%lld%lld%lld%lld\",&p,&k,&aa,&bb,&cc);\n\tll res,ans=0;\n \tfor(ll i=1;i<=k;i++){\n\t\tif(i<=p) scanf(\"%lld\",&q);else q=(q*aa+bb)%cc;\n\t\tres=bisearch(q);//\u4e8c\u5206\n\t\tans^=(mst[res].cost+(q-ld[res])*(mst[res].up-(n-1-mst[res].up)));//\u7b54\u6848\n//\t\tprintf(\"%d \",(mst[res].cost+(q-ld[res])*(mst[res].up-(n-1-mst[res].up))));\n\t}\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1644570039,
        "uid": 294382,
        "name": "qzhwlzy",
        "ccfLevel": 5,
        "title": "CF1633E Spanning Tree Queries \u9898\u89e3"
    },
    {
        "content": "## Solution\n\n\u597d\u9898 . \u8d5b\u65f6\u7ec6\u8282\u5199\u6302 , \u9000\u5f79 . \n\n\u5efa\u8bae\u8bc4\u5206 : \u84dd / \u7d2b .\n\n\u8fd9\u91cc\u7684\u7edd\u5bf9\u503c\u662f\u4e00\u4e2a\u5f88\u70e6\u4eba\u7684\u4e1c\u897f , \u5b83\u4f1a\u8ba9\u6bcf\u6761\u8fb9\u7684\u6743\u503c\u53d1\u751f\u6539\u53d8 .\n\n\u8003\u8651 $\\text{Kruscal}$ . \u6211\u4eec\u5bf9\u4e00\u4e2a\u56fe\u6c42 MST \u65f6 , \u9700\u8981\u7684\u662f **\u8fb9\u6743\u4e4b\u95f4\u7684\u76f8\u5bf9\u5927\u5c0f\u5173\u7cfb** , \u53ea\u8981\u6211\u4eec\u77e5\u9053\u8c01\u5927\u8c01\u5c0f\u5c31\u53ef\u4ee5\u6c42\u51fa\u8be5\u79cd\u60c5\u51b5\u7684 MST .\n\n\u52a0\u4e0a\u7edd\u5bf9\u503c\u540e , \u4efb\u610f\u4e24\u4e2a\u6570\u4e4b\u95f4\u7684\u5927\u5c0f\u5173\u7cfb\u90fd\u53ef\u80fd\u53d1\u751f\u6539\u53d8 ( \u9664\u975e\u5b83\u4eec\u76f8\u7b49 ) . \u8fd9\u610f\u5473\u7740\u9898\u76ee\u4e2d\u6240\u8ff0\u7684 $m$ \u6761\u8fb9\u4f1a\u6709 $\\frac{m(m-1)}{2}$ \u79cd\u76f8\u5bf9\u5927\u5c0f\u5173\u7cfb . \u53d1\u73b0 $m$ \u5f88\u5c0f , \u90a3\u4e48\u53ef\u4ee5\u628a\u8fd9\u4e48\u591a\u79cd\u76f8\u5bf9\u5927\u5c0f\u5173\u7cfb\u7684 MST \u90fd\u9884\u5904\u7406\u51fa\u6765 . \u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\text{O(m}^\\text{3} \\text{log m)}$ . \u5f53\u7136 , \u53cc\u6307\u9488\u53ef\u4ee5\u53bb\u6389 $\\text{log}$ , \u4f46\u662f\u4f1a\u9ebb\u70e6\u4e00\u4e9b . \n\n> \u5bf9\u4e8e\u4e24\u4e2a\u6570 $a$ \u548c $b$ ( \u4e0d\u59a8\u8bbe $a < b$ ) , \u4f7f\u5b83\u4eec\u76f8\u5bf9\u5927\u5c0f\u53d1\u751f\u6539\u53d8\u7684 $x$ \u7684\u4e34\u754c\u503c\u4e3a $\\lceil \\frac{a+b}{2} \\rceil$ . \u6211\u4eec\u5b9e\u9645\u4e0a\u628a\u8fd9\u4e9b\u4e34\u754c\u503c\u6392\u5e8f\u53bb\u91cd , \u7136\u540e\u628a\u8fd9\u4e9b\u503c\u5f53\u505a $x$ \u5e26\u5165\u6c42 MST .\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8be2\u95ee , \u627e\u5230\u4e0d\u6bd4\u5b83\u5927\u7684\u6700\u5927\u4e34\u754c\u503c , \u5c31\u76f8\u5f53\u4e8e\u627e\u5230\u4e86\u8fd9\u65f6\u5019\u7684\u76f8\u5bf9\u5927\u5c0f\u5173\u7cfb , \u4e5f\u5c31\u77e5\u9053\u90a3\u4e9b\u8fb9\u53ef\u4ee5\u9009 , \u90a3\u4e9b\u8fb9\u4e0d\u53ef\u4ee5\u9009 . \n\n\u5269\u4e0b\u7684\u64cd\u4f5c\u5c31\u662f\u57fa\u7840\u524d\u7f00\u548c\u4e86 .\n\n\u590d\u6742\u5ea6 : $ \\text{O(m}^\\text{3} \\text{log m+k log m)} $ . CF \u7684\u8bc4\u6d4b\u673a\u8fd8\u662f\u76f8\u5f53\u5feb\u7684 .\n\n[code](https://codeforces.com/contest/1633/submission/145180541) ",
        "postTime": 1644027389,
        "uid": 120947,
        "name": "Purslane",
        "ccfLevel": 7,
        "title": "CF1633E"
    },
    {
        "content": "## \u9898\u610f\n$k$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u8fb9\u6743\u662f $|w_i-x|$ \u65f6\u7684\u6700\u5c0f\u751f\u6210\u6811\u3002\n\n$n\\le 50,m\\le 300,k\\le 10^7$\uff0c\u4fdd\u8bc1\u8054\u901a\u3002\n## \u9898\u89e3\n\u600e\u4e48\u9898\u89e3\u5168\u662f $\\mathcal O(m^3\\log m+k\\log m)$ \u7684\u554a\uff0c\u8fd9\u91cc\u4ecb\u7ecd\u4e00\u79cd $\\mathcal O(m^2\\alpha(m)\\log W+k\\log m)$ \u7684\u65b9\u6cd5\u3002\n\n\u9996\u5148\u8fd9\u4e2a $|w_i-x|$ \u662f\u51f8\u7684\uff0c\u51f8\u7684\u6709\u4ec0\u4e48\u6027\u8d28\u5462\uff1f\u7ecf\u8fc7\u4e00\u4e9b\u4eba\u7c7b\u667a\u6167\u6211\u4eec\u53d1\u73b0\u4e00\u6761\u8fb9\u51fa\u73b0\u5728\u6700\u5c0f\u751f\u6210\u6811\u4e0a\u7684 $x$ \u662f\u4e00\u6bb5\u8fde\u7eed\u7684\u533a\u95f4\uff0c\u8bc1\u660e\u4ea4\uff08wo\uff09\u7ed9\uff08ye\uff09\u8bfb\uff08bu\uff09\u8005\uff08hui\uff09\u81ea\uff08zheng\uff09\u8bc1\uff08ming\uff09\u3002\n\n\u53cd\u6b63\u6211\u4eec\u73b0\u5728\u662f\u6709\u8fd9\u4e2a\u7ed3\u8bba\u4e86\uff0c\u770b\u4e0a\u53bb\u975e\u5e38\u9760\u8c31\u3002\u7136\u540e\u6211\u4eec\u5c31\u80fd\u591f\u76f4\u63a5\u4e8c\u5206\u627e\u5230\u8fd9\u4e2a\u533a\u95f4\u7684\u5de6\u7aef\u70b9\u548c\u53f3\u7aef\u70b9\u4e86\u3002\u628a\u6bcf\u6761\u8fb9\u7684\u8d21\u732e\u533a\u95f4\u7b97\u51fa\u6765\u4e4b\u540e\u6211\u4eec\u5c31\u80fd\u76f4\u63a5\u7528\u524d\u7f00\u548c\u8ba1\u7b97\u6bcf\u4e2a $x$ \u5bf9\u5e94\u7684\u503c\u4e86\u3002\n\n\u63d0\u4ea4\u65f6\u662f\u6d1b\u8c37rk1\u3002\n\n\u5176\u5b9e\u8fd8\u6709\u66f4\u4f18\u7684\u590d\u6742\u5ea6\uff0c\u53ef\u4ee5\u53bb\u505a\u4e00\u505a\u3010JOISC2022\u3011\u590d\u5174\u8ba1\u5212\uff0c\u7b49\u4ee5\u540e\u4f1a\u4e86\u4e4b\u540e\u518d\u6765\u8865\u3002\n\n## \u4ee3\u7801\n\u76f4\u63a5\u6a21\u62df\u3002\n```cpp\n#include<bits/stdc++.h>\n#define mp make_pair\n#define mt make_tuple\n#define eb emplace_back\n#define pb push_back\n#define pc putchar\n#define chkmx(a,b) (a)=max((a),(b))\n#define chkmn(a,b) (a)=min((a),(b))\n#define fi first\n#define se second\nusing namespace std;\ntemplate<class T>\nvoid read(T&x){x=0;char c=getchar();bool f=0;for(;!isdigit(c);c=getchar())f^=c=='-';for(;isdigit(c);c=getchar())x=x*10+c-'0';if(f)x=-x;}\ntemplate<class T,class ...ARK>void read(T&x,ARK&...ark){read(x);read(ark...);}\ntemplate<class T>void write(T x){if(x<0)pc('-'),x=-x;if(x>=10)write(x/10);pc(x%10+'0');}\ntemplate<class T,class ...ARK>void write(T x,ARK...ark){write(x);pc(' ');write(ark...);}\ntemplate<class ...ARK>void writeln(ARK...ark){write(ark...);pc('\\n');}\ntypedef long long ll;\nconst int mod=998244353;\nstruct mint{\n\tint x;mint(int o=0){x=o;}mint&operator+=(mint a){return(x+=a.x)%=mod,*this;}mint&operator-=(mint a){return(x+=mod-a.x)%=mod,*this;}\n\tmint&operator*=(mint a){return(x=1ll*x*a.x%mod),*this;}mint&operator^=( int b){mint a=*this;x=1;while(b)(b&1)&&(*this*=a,1),a*=a,b>>=1;return*this;}\n\tmint&operator/=(mint a){return*this*=(a^=mod-2);}friend mint operator+(mint a,mint b){return a+=b;}friend mint operator-(mint a,mint b){return a-=b;}\n\tfriend mint operator*(mint a,mint b){return a*=b;}friend mint operator/(mint a,mint b){return a/=b;}friend mint operator^(mint a, int b){return a^=b;}\n};\n#define lowbit(x) ((x)&-(x))\n#define mid ((l+r)>>1)\n#define lc (x<<1)\n#define rc (x<<1|1)\nconst int N=1e5+10;\nint n,m,q,k,lst,a,b,c,u[N],v[N],w[N],p[N];\nint sa1[N],sa2[N];\nint fa[N];\nint find(int x){return x==fa[x]?x:fa[x]=find(fa[x]);}\nvoid merge(int x,int y){x=find(x),y=find(y);fa[x]=y;}\nbool chk(int x,int i){\n\t//\u8fb9i\u662f\u5426\u5728x\u65f6\u7684\u751f\u6210\u6811\u5185\u3002\n\t//\u5148\u5199 m log m\uff0c\u53ef\u4ee5\u4f18\u5316\u5230 m \u03b1(m)\n\tvector<pair<int,int>>e(m),a,b;\n\tfor(int i=1;i<=n;i++)fa[i]=i;\n\tfor(int i=1;i<=m;i++)if(w[sa1[i]]>=x)a.eb(w[sa1[i]]-x,sa1[i]);\n\tfor(int i=1;i<=m;i++)if(w[sa2[i]]<x)b.eb(x-w[sa2[i]],sa2[i]);\n\tmerge(a.begin(),a.end(),b.begin(),b.end(),e.begin());\n\tfor(auto E:e){\n\t\tint id=E.se;\n\t\tif(find(u[id])^find(v[id])){\n\t\t\tmerge(u[id],v[id]);\n\t\t\tif(id==i)return 1;\n\t\t}\n\t\tif(id==i)return 0;\n\t}\n\texit(1);\n}\ntuple<int,int,int>kk[N];//\u8d21\u732e\nint cnt=0;\nint pos[N];ll coef1[N],coef2[N];\nll calc(int x){\n\tint p=upper_bound(pos+1,pos+1+cnt,x)-pos-1;\n\t//writeln(coef1[p]*x+coef2[p]);\n\treturn coef1[p]*x+coef2[p];\n}\nsigned main(){\n\tread(n,m);\n\tfor(int i=1;i<=m;i++)read(u[i],v[i],w[i]);\n\tiota(sa1+1,sa1+1+m,1);sort(sa1+1,sa1+1+m,[&](int i,int j){return w[i]==w[j]?i<j:w[i]<w[j];});\n\tiota(sa2+1,sa2+1+m,1);sort(sa2+1,sa2+1+m,[&](int i,int j){return w[i]==w[j]?i<j:w[i]>w[j];});\n\tread(q,k,a,b,c);\n\tfor(int i=1;i<=m;i++){\n\t\tif(!chk(w[i],i))continue;\n\t\tint st=w[i],ed=w[i],l,r;\n\t\tl=0,r=w[i];while(l<=r)if(chk(mid,i))st=mid,r=mid-1;else l=mid+1;\n\t\tl=w[i],r=1e8;while(l<=r)if(chk(mid,i))ed=mid,l=mid+1;else r=mid-1;\n\t\t//\u5b58\u5728\u7684\u533a\u95f4\u5c31\u662f [l,r]\n\t\tkk[++cnt]=mt(st,-1,w[i]);\n\t\tkk[++cnt]=mt(w[i]+1,2,-2*w[i]);\n\t\tkk[++cnt]=mt(ed+1,-1,w[i]);\n\t}\n\tsort(kk+1,kk+1+cnt);\n\tfor(int i=1;i<=cnt;i++)\n\t\tpos[i]=get<0>(kk[i]),\n\t\tcoef1[i]=coef1[i-1]+get<1>(kk[i]),\n\t\tcoef2[i]=coef2[i-1]+get<2>(kk[i]);\n\tll ans=0;int lst=0;\n\tfor(int i=1;i<=q;i++)read(lst),ans^=calc(lst);\n\tfor(int i=q+1;i<=k;i++)lst=(1ll*lst*a+b)%c,ans^=calc(lst);\n\twriteln(ans);\n}\n```",
        "postTime": 1652053546,
        "uid": 174304,
        "name": "jun\u5934\u5409\u5409",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1633E \u3010Spanning Tree Queries\u3011"
    },
    {
        "content": "\u9996\u5148\u6ce8\u610f\u5230\u8fd9\u4e2a\u9898 $n,m$ \u6bd4\u8f83\u5c0f\uff0c\u4f46 $k,q_i$ \u6bd4\u8f83\u5927\uff0c\u6240\u4ee5\u53ef\u4ee5\u60f3\u5230\u5148\u5904\u7406\u597d\u7b54\u6848\u7136\u540e\u67e5\u8be2\u7684\u65f6\u5019\u76f4\u63a5\u4e8c\u5206\u3002\n\n\u8003\u8651\u73b0\u5728\u5c06 $q$ \u56fa\u5b9a\uff0c\u8bbe\u8fb9\u7684\u8fb9\u6743\u4e3a $v_1 \\le v_2 \\le \\cdots \\le v_t \\le q \\le v_{t+1} \\le \\cdots \\le v_m$ \uff0c\u5219\u4e0d\u96be\u53d1\u73b0 $|v_1-q| \\ge |v_2-q| \\ge \\cdots \\ge |v_t-q|$ \uff0c $|v_{t+1}-q| \\le|v_{t+2}-q| \\le \\cdots \\le |v_m-q|$\u3002 \n\n\u7136\u540e\u6ce8\u610f\u5230\u8fb9\u6743\u8f6c\u6362\u540e\u7684\u540c\u4fa7\u7684\u5dee\u662f\u56fa\u5b9a\u7684\uff0c\u6240\u4ee5\u5bf9\u4e8e $q$ \u904d\u5386\u4e00\u904d\u6574\u6570\u57df\uff0c\u8fb9\u6743\u7684\u5927\u5c0f\u5173\u7cfb\u53ea\u6709 $O(m^2)$ \u79cd\u3002\n\n\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u5f00\u5fc3\u5730 $\\text{Kruskal}$ \u4e86\uff0c\u590d\u6742\u5ea6 $O(m^3 \\log m+k)$\u3002 \n\n\u53e6\uff1a\u5982\u679c\u628a\u6240\u6709\u8be2\u95ee\u7684 $q$ \u7528\u57fa\u6392\u6392\u5e8f\u7136\u540e\u626b\u4e00\u904d\u53ef\u4ee5\u505a\u5230 $O(k)$ \u6c42\u7b54\u6848\uff0c\u4f46\u6bcf\u6b21\u4e8c\u5206 $O(k \\log m)$ \u4e5f\u53ef\u4ee5\u3002",
        "postTime": 1645534620,
        "uid": 117771,
        "name": "intel_core",
        "ccfLevel": 7,
        "title": "CF1633E \u9898\u89e3"
    },
    {
        "content": "### Preface\n\n\u4e00\u5b9a\u8981\u628a\u4ee3\u7801\u5199\u6e05\u695a\u4e86\uff01\u4e0d\u7136\u8d5b\u540e\u8ba2\u6b63\u5f88\u75db\u82e6\u3002\uff08\u6211\u91cd\u5199\u4e86\uff09\n\n\u8d5b\u65f6\u5199\u51fa\u6765\u4f46\u8c03\u4e86\u4e00\u523b\u949f\u65e0\u679c\uff0c\u6211\u9009\u62e9\u6b7b\u4ea1\u3002\n\n### Analysis\n\n\u8be2\u95ee $10^7$\uff0c\u660e\u663e\u56de\u7b54\u65f6\u95f4\u4e0d\u80fd\u8d85\u8fc7 $\\log$\u3002\u90a3\u6211\u4eec\u524d\u671f\u8981\u9884\u5904\u7406\u66f4\u591a\u3002\n\n\u53d1\u73b0\u8fd9\u662f**\u5e26\u7edd\u5bf9\u503c\u6700\u5c0f\u751f\u6210\u6811**\u95ee\u9898\u3002\u9047\u5230\u7edd\u5bf9\u503c\u8981\u5206\u7c7b\uff0c\u4f46\u662f\u5206\u6210 $m$ \u7c7b\u597d\u50cf\u4e0d\u884c\u2026\u2026\n\n\u56de\u987e Kruskal \u7684\u7b97\u6cd5\u8fc7\u7a0b\uff0c\u53d1\u73b0\u5982\u679c\u8fb9\u4e4b\u95f4\u8fb9\u6743\u7684\u5927\u5c0f\u5173\u7cfb\u786e\u5b9a\u4e86\uff0c\u90a3\u4e48\u8d2a\u5fc3\u7684\u6392\u5e8f\u5c31\u53ef\u4ee5\u5b9e\u73b0\u4e86\u3002\u800c\u5927\u5c0f\u5173\u7cfb\u5728 $Q$\uff08\u8be2\u95ee\u7684\u6570\uff09\u4e0d\u540c\u65f6\u6700\u591a\u53ea\u6709 $O(m^2)$ \u79cd\u4e0d\u540c\u7684\u8fb9\u6743\u7684\u5927\u5c0f\u5173\u7cfb\u3002\u56e0\u4e3a\u8003\u8651 $Q$ \u4ece $-\\infty$ \u5230 $\\infty$ \u7684\u8fc7\u7a0b\uff0c\u8fb9\u6743 $\\le Q$ \u7684\u5e26\u7edd\u5bf9\u503c\u8fb9\u6743\u5728\u9012\u589e\uff0c\u800c\u8fb9\u6743 $>Q$ \u7684\u9012\u51cf\uff0c\u53ea\u6709\u5f53 \u4e00\u4e2a\u8fb9\u6743\u4ece $>Q$ \u53d8\u4e3a $\\le Q$  \u6216 \u4e00\u4e2a\u7edd\u5bf9\u503c\u8fb9\u6743\u4e0e\u53e6\u4e00\u4e2a\u7edd\u5bf9\u503c\u8fb9\u6743\u7684\u5927\u5c0f\u5173\u7cfb\u53d1\u751f\u53d8\u5316 \u65f6\uff0c\u624d\u4f1a\u6709\u65b0\u7684\u8fb9\u6743\u7684\u5927\u5c0f\u5173\u7cfb\u51fa\u73b0\uff0c\u800c $m$ \u4e2a\u8fb9\u6743\u91cc\u9009\u4e24\u4e2a\u53d6\u5e73\u5747\u6570\u7684\u89c4\u6a21\u662f $O(m^2)$ \u7684\u3002\n\n\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u4e00\u4e9b\u503c $Gap$\uff08\u6309\u5347\u5e8f\u6392\uff09\u6765\u5212\u5206 $Q$ \u7684\u503c\u57df\uff0c\u4f7f\u5f97 $Q$ \u5728\u6bcf\u4e00\u6bb5\u5185\u65f6\uff0c\u7edd\u5bf9\u503c\u8fb9\u6743\u7684\u5927\u5c0f\u5173\u7cfb\u4e0d\u53d8\u3002\n\n\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e2a\u533a\u95f4\u9009\u6700\u5927\u7684 $Q$ \u4e3a\u4ee3\u8868\u503c\uff0c\u7528\u5979 $|Q-w_i|$ \u8fd9\u6837\u7684\u8fb9\u6743\u8dd1 Kruskal\uff0c\u540c\u65f6\u8bb0\u5f55\u6700\u5c0f\u751f\u6210\u6811\u4e2d\u6709\u591a\u5c11\u8fb9\u672c\u6765\u7684\u8fb9\u6743 $<Q$\uff08\u5728\u4fdd\u8bc1\u751f\u6210\u6811\u6700\u5c0f\u65f6\u5c3d\u91cf\u4f7f\u8fd9\u4e2a\u503c\u6700\u5927\uff0c\u8bf7\u8bfb\u8005\u601d\u8003\uff09\u3002\n\n\u5f53\u8be2\u95ee\u65f6\uff0c\u4e8c\u5206\u5230\u8fd9\u6bb5\u533a\u95f4\uff0c\u901a\u8fc7\u4ee3\u8868\u503c\u7684\u7b54\u6848\u6765 $O(1)$ \u63a8\u5bfc\u7b54\u6848\u5373\u53ef\u3002\n\n\u65f6\u95f4 $O(m^3\\log m\\times\\alpha(n)+k\\log m)$\u3002\n\n### Code\n\n[Link](https://codeforces.com/contest/1633/submission/145942192)",
        "postTime": 1644580710,
        "uid": 101868,
        "name": "I_am_Accepted",
        "ccfLevel": 0,
        "title": "CF1633E Spanning Tree Queries"
    },
    {
        "content": "## 001 \u505a\u6cd5\n\n### \u601d\u8def1\n\n\u770b\u5230\u8fd9\u4e2a\u9898\uff0c\u7b2c\u4e00\u60f3\u6cd5\u5c31\u662f\u66b4\u529b\uff0c\u7528\u5e76\u67e5\u96c6\u6c42 MST\uff0c\u590d\u6742\u5ea6 $O(kmlogm)$\uff0c\u80af\u5b9a\u8fc7\u4e0d\u4e86\u3002\n\n### \u601d\u8def2\n\n\u53d1\u73b0\u7b54\u6848\u662f\u8981\u6c42\u5f02\u6216\uff0c\u5c31\u53ef\u4ee5\u7528 map \u53bb\u91cd\uff0c\u4f46\u53d1\u73b0\u4e0d\u4ec5\u6ca1\u7528\uff0cmap \u672c\u8eab\u8fd8\u6162\uff01\n\n$p=1,k=10^7,a=1,b=1,c=10^7,q_1=0$ \u7684\u65f6\u5019 $q$ \u5c31\u662f $0,1,2,\\dots,10^7-1$\uff0c\u53bb\u91cd\u4e00\u70b9\u7528\u6ca1\u6709\u3002\n\n### \u601d\u8def3\n\n\u9898\u76ee\u4e2d\u7684\u56fe\u53ea\u6709 $50$ \u4e2a\u70b9\uff0c$300$ \u6761\u8fb9\uff0c\u56e0\u6b64\u4e0d\u540c\u7684\u6709\u53ef\u80fd\u4f5c\u4e3a\u7b54\u6848\u7684 $MST$ \u53ea\u6709 $O(m^2)$ \u7ea7\u522b\u7684\uff01\n\n\u4e8e\u662f\u53ef\u4ee5\u9884\u5904\u7406\uff1a\n\n\u5148\u8ba1\u7b97 $x=0$ \u65f6\u7684 $MST$\uff08\u4ee5\u540e\u8bb0\u4e3a $go(0)$\uff09\uff0c\u7136\u540e\u4e8c\u5206\u4e0b\u4e00\u4e2a\u4e0d\u540c\u7684 $MST$ \u7684 $x$ \u6700\u5c0f\u662f\u51e0\u3002\n\n\u590d\u6742\u5ea6 \n$$\nO(m^2*logA*mlogm+kn)=O(m^3logAlogm+kn)\n$$\n\uff08$A$\u662f\u503c\u57df\uff09\n\n### \u601d\u8def4\n\n\u9884\u5904\u7406\u4e2d\u7684\u4e8c\u5206\u5176\u5b9e\u662f\u4e0d\u5fc5\u8981\u7684\n\n\u53d1\u73b0\u53ea\u6709\n$$\n\\left\\lfloor\\frac{w_i+w_j}{2}\\right\\rfloor-1,\\left\\lfloor\\frac{w_i+w_j}{2}\\right\\rfloor,\\left\\lfloor\\frac{w_i+w_j}{2}\\right\\rfloor+1\n$$\n\u662f\u6709\u7528\u7684\uff0c\u590d\u6742\u5ea6\u964d\u4e3a\n$$\nO(m^2*mlogm+kn)=O(m^3logm+kn)\n$$\n\u5df2\u7ecf\u8db3\u591f $AC$\uff01\n\n## 002 \u4ee3\u7801\n\n[\u672c\u849f\u84bb\u4ee3\u7801](https://codeforces.com/contest/1633/submission/144810641)",
        "postTime": 1643807741,
        "uid": 483879,
        "name": "hyman00",
        "ccfLevel": 0,
        "title": "CF1633E\u9898\u89e3"
    }
]
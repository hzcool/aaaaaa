[
    {
        "content": "### \u3010CF1601F\u3011Two Sorts \u89e3\u9898\u62a5\u544a\n\n\u5148\u8003\u8651\u4e00\u4e2a\u66b4\u529b\u7684\u505a\u6cd5\uff1a\u76f4\u63a5\u679a\u4e3e\uff0c\u5927\u6982\u80fd\u505a $10^6$\u3002\n\n\u89c2\u5bdf\u6570\u636e\u8303\u56f4\uff0c\u53d1\u73b0 $10^{12}=(10^6)^2$\uff01\u4e8e\u662f\u4e0d\u96be\u60f3\u5230\uff08\uff1f\uff09meet in the middle\u3002\n\n\u5047\u5982\u6211\u4eec\u6309\u7167 $1$ ~ $n$ \u7684\u987a\u5e8f\u6765\u8003\u8651\uff0c\u90a3\u4e48\u6211\u4eec\u53d1\u73b0\u4e24\u4e2a\u76f8\u90bb\u7684\u6570\u7684\u5b57\u5178\u5e8f\u6392\u540d\u53ef\u80fd\u4f1a\u5dee\u5f97\u5f88\u8fdc\uff0c\u96be\u4ee5\u5904\u7406\uff0c\u6240\u4ee5\u6211\u4eec\u5b9e\u9645\u4e0a\u53ef\u4ee5\u628a $i$ \u770b\u505a\u6392\u540d\uff0c$a_i$ \u770b\u6210\u6392\u540d\u4e3a $i$ \u7684\u6570\u7684\u503c\uff0c\u8f6c\u800c\u53bb\u8003\u8651\u5b57\u5178\u5e8f\u6392\u540d\u76f8\u8fd1\u7684\u6570\u7684\u503c\u3002\n\n\u8003\u8651\u600e\u4e48 meet\uff1a\u663e\u7136\u7684\uff0c\u5b57\u7b26\u4e32\u7684\u524d\u7f00\u5982\u679c\u76f8\u540c\uff0c\u90a3\u4e48\u5b83\u4eec\u7684\u5b57\u5178\u5e8f\u6392\u540d\u4e5f\u5c31\u4f1a\u76f8\u8fd1\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u628a 12 \u4f4d\u7684\u6574\u6570\u62c6\u6210\u4e24\u534a\uff0c\u4e00\u534a\u5de6\u8fb9\u4e00\u534a\u53f3\u8fb9\uff0c\u5219\u5de6\u534a\u8fb9\u76f8\u540c\u7684\u6570\u5b57\u5178\u5e8f\u4e00\u5b9a\u8fde\u7eed\u3002\n\n\u53f3\u8fb9\u7684\u4e00\u534a\u4e3a $0$ \u5230 $999999$\uff08\u5b57\u7b26\u4e32\u610f\u4e49\u4e0b\u7684\uff0c\u6240\u4ee5\u4f1a\u5305\u542b\u524d\u5bfc 0\uff09\uff0c\u53ea\u6709\u5927\u7ea6 $10^6$ \u4e2a\u6570\uff0c\u53ef\u4ee5\u66b4\u529b dfs \u679a\u4e3e\u9884\u5904\u7406\u3002\n\n\u5de6\u8fb9\u7684\u4e00\u534a\u540c\u6837\u9700\u8981\u6211\u4eec\u5229\u7528 dfs \u8fdb\u884c\u679a\u4e3e\u3002\u6211\u4eec\u6309\u7167\u5b57\u5178\u5e8f\u679a\u4e3e\u6240\u6709\u53ef\u80fd\u7684\u524d\u7f00\uff0c\u5e76\u7ed3\u5408\u524d\u9762\u9884\u5904\u7406\u7684\u4fe1\u606f\u8ba1\u7b97\u51fa\u5bf9\u5e94\u7684\u7b54\u6848\u5373\u53ef\u3002\u7ec6\u8282\u6bd4\u8f83\u7e41\u7410\uff0c\u8be6\u7ec6\u53ef\u770b\u4ee3\u7801\u5b9e\u73b0\u3002\n\n\u603b\u590d\u6742\u5ea6\u89c6\u5b9e\u73b0\u5927\u7ea6\u4e3a $O(10^6 \\text{poly}(\\log n))$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nconst int mod1=998244353;\nconst int mod2=1e9+7;\nint ans;\nint n;\nint cnt1;\nvector<int> val[7];\nint sum[7];\nvoid dfs1(int k1,int k2){\n\tif(k1==7)return;\n\tval[k1].push_back((cnt1-k2+mod1)%mod1);\n\tsum[k1]+=(cnt1-k2+mod1)%mod1;\n\tcnt1++;\n\tfor(int i=0;i<=9;++i){\n\t\tdfs1(k1+1,k2*10+i);\n\t}\n}\nbool check(int x){\n\tconst int half=1000000;\n\treturn x*half+999999<=n&&x*half*10>n;\n}\nint cnt2;\nint poww[7]={1,10,100,1000,10000,100000,1000000};\nvoid dfs2(int k1,int k2){\n\tif(k2>n)return;\n\tif(check(k2)){\n\t\tfor(int i=0;i<=6;++i){\n\t\t\tint offset=((cnt2+1-(k2*poww[i]))%mod1+mod1)%mod1;\n\t\t\tint pos=lower_bound(val[i].begin(),val[i].end(),mod1-offset)-val[i].begin();\n\t\t\t(ans+=(sum[i]+offset*val[i].size()-mod1*(val[i].size()-pos)))%=mod2;\n\t\t}\n\t\tcnt2+=cnt1;\n\t}\n\telse {\n\t\tcnt2++;\n\t\t(ans+=((cnt2-k2)%mod1+mod1)%mod1)%=mod2;\n\t\tfor(int i=(!k1);i<=9;++i){\n\t\t\tdfs2(k1+1,k2*10+i);\n\t\t}\n\t}\n}\nsigned main(){\n\tscanf(\"%lld\",&n);\n\tdfs1(0,0);\n\tfor(int i=0;i<=6;++i)sort(val[i].begin(),val[i].end());\n\tcnt2=-1;\n\tdfs2(0,0);\n\tprintf(\"%lld\\n\",ans);\n}\n```",
        "postTime": 1639530914,
        "uid": 108510,
        "name": "Terminus_Est",
        "ccfLevel": 0,
        "title": "\u3010CF1601F\u3011Two Sorts \u89e3\u9898\u62a5\u544a"
    },
    {
        "content": "## \u9898\u610f\n\n\u7ed9\u5b9a $n$\uff0c\u4ee4 $a$ \u4e3a $1$ \u5230 $n$ \u6309\u7167\u5b57\u5178\u5e8f\u6392\u5e8f\u540e\u7684\u6392\u5217\uff0c\u6c42 \n\n$$(\\sum_{i=1}^n((i-a_i)\\bmod 998244353))\\bmod 10^9+7$$\n\n## \u5206\u6790\n\n\u6298\u534a\u641c\u7d22\u7684\u6709\u610f\u601d\u9898\u76ee\u3002\n\n\u9996\u5148\u6c42\u9006\u6392\u5217\uff0c\u8bbe $b_i$ \u4e3a $i$ \u7684\u5b57\u5178\u5e8f\u6392\u540d\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f\uff1a\n\n$$(\\sum_{i=1}^n((b_i-i)\\bmod 998244353))\\bmod 10^9+7$$\n\n$10^{12}$ \u660e\u793a\u6298\u534a\u641c\u7d22\uff08\u6839\u53f7\u5206\u6cbb\uff09\uff0c\u6211\u4eec\u8003\u8651\u5148\u628a\u524d $6$ \u4f4d\u641c\u7d22\u51fa\u6765\u3002\n\n\u8bbe $p,q$ \u5206\u522b\u4e3a $x$ \u7684\u524d\u516d/\u540e\u516d\u4f4d\uff0c\u90a3\u4e48\u6709 $b_x=b_{p000000}+b_q$\u3002\n\n$$(b_i-i)\\bmod 998244353=((b_{p000000}-p\\times10^6)+(b_q-q))\\bmod 998244353$$\n\n\u53ef\u4ee5\u53d1\u73b0\u9664\u4e86 $p$ \u7b49\u4e8e $n$ \u524d\u516d\u4f4d\u7684\u60c5\u51b5\u4e0b\uff0c\u5176\u4f59\u7684\u60c5\u51b5\u53f3\u8fb9\u90fd\u53ef\u4ee5\u9884\u5904\u7406\uff0c\u7136\u540e\u4e8c\u5206\u4e00\u4e0b\u90a3\u4e9b $b_q-q$ \u4e0e\u5de6\u8fb9\u52a0\u8d77\u6765\u9700\u8981\u51cf\u53bb\u4e00\u4e2a $998244353$ \u5c31\u597d\u4e86\u3002\n\n\u800c $p$ \u7b49\u4e8e $n$ \u524d\u516d\u4f4d\uff0c$q$ \u7684\u53d6\u503c\u53ea\u6709\u6700\u591a $10^6$ \u79cd\uff0c\u76f4\u63a5\u66b4\u529b\u89e3\u51b3\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\sqrt n\\log n)$\u3002\n\n## \u4ee3\u7801\n```\n#include<stdio.h>\n#include<vector>\n#include<algorithm>\nusing namespace std;\nconst int mod=1000000007,MOD=998244353,maxk=7,base=1000000;\nlong long n,ord;\nint ans;\nint sum[maxk];\nvector<int>v[maxk];\nvoid dfs1(int x,int len) {\n\tord++,v[len].push_back(((ord-x)%MOD+MOD)%MOD),sum[len]=(sum[len]+v[len].back())%mod;\n\tif(len==6)\n\t\treturn ;\n\tfor(int i=0; i<=9; i++)\n\t\tdfs1(x*10+i,len+1);\n}\nvoid dfs2(long long x) {\n\tif(x>n)\n\t\treturn ;\n\tif(x*base+base-1<=n&&x*base*10>n) {\n\t\tlong long now=ord;\n\t\tfor(int i=0,mul=1; i<=6; i++,mul*=10) {\n\t\t\tint sz=v[i].size(),dif=((now-x*mul)%MOD+MOD)%MOD,pos=lower_bound(v[i].begin(),v[i].end(),MOD-dif)-v[i].begin();\n\t\t\tans=(ans+1ll*dif*sz+sum[i])%mod,ans=(ans-1ll*MOD*(sz-pos)%mod+mod)%mod;\n\t\t\tord+=sz;\n\t\t}\n\t\treturn ;\n\t}\n\tord++,ans=(ans+((ord-x)%MOD+MOD)%MOD)%mod;\n\tfor(int i=0; i<=9; i++)\n\t\tdfs2(x*10+i);\n}\nint main() {\n\tscanf(\"%lld\",&n);\n\tord=0,dfs1(0,0);\n\tfor(int i=0; i<=6; i++)\n\t\tsort(v[i].begin(),v[i].end());\n\tord=0;\n\tfor(int i=1; i<=9; i++)\n\t\tdfs2(i);\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1639813113,
        "uid": 105611,
        "name": "IdnadRev",
        "ccfLevel": 0,
        "title": "\u3010\u641c\u7d22\u8bb0\u5f55\u3011CF1601F Two Sorts"
    },
    {
        "content": "## \u601d\u8def\uff1a\n\n\u6298\u534a\u641c\u7d22\uff08meet in the middle\uff09\u3002\n\n\u8fd9\u4e2a\u516c\u5f0f\u597d\u957f\uff01\u600e\u4e48\u529e\u554a\uff01\n\n\u6211\u770b\u61c2\u9898\u4ee5\u540e\u76f4\u63a5\u8003\u8651\u66b4\u529b\uff0c\u6ca1\u60f3\u5230\u66b4\u529b\u80fd\u5bf9\u4e00\u534a\uff0c\u4e5f\u5c31\u662f $O(10^6)$\uff0c\u90a3\u4e48 $6 \\times 2=12$\uff0c\u90a3\u4e48\u4e5f\u5c31\u662f\u6211\u4eec\u9700\u8981\u5728\u66b4\u529b\u641c\u7d22\u4e4b\u4e0a\u8fdb\u884c\u4e00\u79cd\u4e8c\u5206\u7684\u601d\u60f3\uff0c\u90a3\u4e48\u4e5f\u5c31\u4e0d\u96be\u60f3\u5230\u4e86\u6298\u534a\u641c\u7d22\u4e86\u3002\n\n\u6211\u4eec\u63a5\u7740\u6765\u68c0\u9a8c\u4e00\u4e0b\u9898\u76ee\uff1a\n\n1. \u641c\u7d22\u56fe\u4e2d\u7684\u8282\u70b9\u72b6\u6001\u90fd\u662f\u53ef\u9006\u7684\n2. \u989d\u5916\u7684\u6570\u636e\u7ed3\u6784\u5b58\u50a8\u627e\u8fc7\u7684\u8282\u70b9\n\n\u6211\u4eec\u7528 $i$ \u8868\u793a\u4e0b\u6807\uff0c$a_i$ \u8868\u793a\u503c\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u5c31\u6765\u8003\u8651\u4e0b\u6807\u548c\u4e0b\u6807\u4e4b\u95f4\u5b57\u5178\u5e8f\u6392\u540d\u76f8\u8fd1\u7684\u8fd9\u4e2a\u6570\u503c\u5373\u53ef\u3002\n\n\u6298\u534a\uff0c\u6298\u534a\uff0c\u6211\u4eec\u4e5f\u8981\u5c06\u6574\u4e2a\u6570\u5b57\u201c\u6298\u534a\u201d\uff0c\u5206\u6210\u524d\u4e00\u4e2a\u90e8\u5206\u548c\u540e\u4e00\u4e2a\u90e8\u5206\u3002\u6211\u4eec\u5c06 $12$ \u4f4d\u7684\u6570\u5b57\u5206\u6210\u524d\u90e8\u5206 $6$ \u4f4d\uff0c\u540e\u90e8\u5206\u4e5f\u4e3a $6$ \u4f4d\u3002\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5206\u7c7b\u8ba8\u8bba\u4e86\uff1a\n\n1. \u5de6\u534a\u8fb9\n\n\u6bd4\u8f83\u7e41\u6742\uff0c\u6211\u4eec\u9700\u8981\u8003\u8651\u5230\u5b57\u5178\u5e8f\u95ee\u9898\uff0c\u540c\u65f6\u6211\u4eec\u9700\u8981\u9884\u5904\u7406+\u679a\u4e3e\u524d\u7f00\u3002\u7136\u540e\u8fd9\u4e9b\u7684\u6240\u6709\u8fd8\u662f\u8981\u57fa\u4e8e\u6700\u539f\u59cb\u7684\u6df1\u641c\u7b97\u6cd5\u3002\n\n2. \u53f3\u534a\u8fb9\n\n\u8fd9\u534a\u8fb9\u4e0d\u7528\u50cf\u4e0a\u4e00\u4e2a\u4e00\u6837\u8003\u8651\u8fc7\u591a\u7684\u95ee\u9898\uff0c\u4e00\u5171\u4e5f\u5c31$10^6$ \u4e2a\u6570\uff0c\u76f4\u63a5\u66b4\u529b\u8fdb\u884c\u6df1\u641c\u5373\u53ef\u3002\n\n**\u6ce8\u610f**\uff1a\n1. \u4e0d\u8981\u5fd8\u8bb0\u53bb $\\bmod 998244353$\n2. \u524d\u5bfc $0$\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(10^{\\frac{2}{L}}\\ poly(L))$ \u6216 $O(\\sqrt{N}\\ poly(log\\  n))$\u3002\n\n",
        "postTime": 1646476423,
        "uid": 470883,
        "name": "Kyron",
        "ccfLevel": 0,
        "title": "CF1601F \u9898\u89e3"
    }
]
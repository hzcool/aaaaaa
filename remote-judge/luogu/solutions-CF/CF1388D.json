[
    {
        "content": "\u6bcf\u4e2a\u70b9\u6700\u591a\u53ea\u6709\u4e00\u4e2a\u6307\u5411\uff0c\u65e0\u73af\uff0c\u8fd9\u662f\u4e2a\u68ee\u6797\n\n\u5047\u8bbe `i` \u53f7\u70b9\u5728\u6700\u7ec8\u7d2f\u8ba1\u7b54\u6848\u65f6\u7684\u53d6\u503c\u4e3a `mx[i]`\n\n\u5bf9\u4e8e\u5f53\u524d\u70b9 `x`, \u679a\u4e3e\u6240\u6709\u5b50\u8282\u70b9 `son`\n\n\u6700\u7ec8 `mx[son] > 0` \u5c31\u5c06\u5176\u503c\u52a0\u5230\u5f53\u524d\u70b9\u4e0a `mx[x] += mx[son]`\uff0c\u53cd\u4e4b\u4e0d\u52a0\n\n\u7b2c\u4e00\u904d `dfs` \u6c42\u6700\u4f18\u89e3\n\n\u7b2c\u4e8c\u904d `dfs2` \u8f93\u51fa\u65b9\u6848\uff0c\u5bf9\u4e8e\u5f53\u524d\u70b9 `x`\uff0c\u5148\u641c `mx[son] > 0` \u7684\u5b50\u8282\u70b9\uff0c\u9012\u5f52\u8f93\u51fa\u4ed6\u4eec\u7684\u7f16\u53f7\u540e\uff0c\u8f93\u51fa `x` \u7684\u7f16\u53f7\uff0c\u518d\u641c\u5176\u4ed6\u5b50\u8282\u70b9\u5373\u53ef\u3002\n\n\n\n```cpp\n#include<bits/stdc++.h>\n#define N 200007\nusing namespace std;\ntypedef long long ll;\n\ninline int rd() {\n  int x = 0;\n  bool f = 0;\n  char c = getchar();\n  while (!isdigit(c)) {\n    if (c == '-') f = 1;\n    c = getchar();\n  }\n  while (isdigit(c)) {\n    x = x * 10 + (c ^ 48);\n    c = getchar();\n  }\n  return f ? -x : x;\n}\n\nint tot, ver[N], hd[N], nxt[N];\n\ninline void add(int fa, int x) {\n  ver[++tot] = x;\n  nxt[tot] = hd[fa];\n  hd[fa] = tot;\n}\n\nint a[N], rot[N], totr;\n\nll ans, mx[N];\n\nvoid dfs(int x) {\n  ll nw = a[x];\n  for (int i = hd[x]; i; i = nxt[i]) {\n    dfs(ver[i]);\n    nw += max(mx[ver[i]], 0ll);\n  }\n  ans += (mx[x] = nw);\n}\n\nvoid dfs2(int x) {\n  for (int i = hd[x]; i; i = nxt[i])\n    if (mx[ver[i]] > 0) dfs2(ver[i]);\n  printf(\"%d \", x);\n  for (int i = hd[x]; i; i = nxt[i])\n    if (mx[ver[i]] <= 0) dfs2(ver[i]);\n}\n\nint main() {\n  int n = rd(), tmp;\n  for (int i = 1; i <= n; ++i) a[i] = rd();\n  for (int i = 1; i <= n; ++i) {\n    tmp = rd();\n    if (tmp > 0) add(tmp, i);\n    else rot[++totr] = i;\n  }\n  for (int i = 1; i <= totr; ++i) dfs(rot[i]);\n  printf(\"%lld\\n\", ans);\n  for (int i = 1; i <= totr; ++i) dfs2(rot[i]);\n  return 0;\n}\n```\n\n",
        "postTime": 1596552316,
        "uid": 56839,
        "name": "SGColin",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1388D \u3010Captain Flint and Treasure\u3011"
    },
    {
        "content": "## \u9898\u610f\n\u7ed9\u51fa\u6570\u7ec4 $a$ \u548c\u6570\u7ec4 $b$\uff0c\u6bcf\u6b21\u53ef\u4ee5\u6307\u5b9a\u4e00\u4e2a $i$ \uff0c\u4f7f\uff1a\n\n- $ans$ \u52a0\u4e0a $a_i$ \uff1b\n- $a_{b_i}$ \u52a0\u4e0a $a_i$ \uff0c\u5982\u679c $b_i=-1$ \uff0c\u5219\u4e0d\u6267\u884c\u3002\n\n\u6bcf\u4e2a $i$ \u53ea\u80fd\u5e76\u5fc5\u987b\u88ab\u6307\u5b9a\u4e00\u6b21\u3002\n\n\u6c42\u6700\u5927\u7684 $ans$ \uff0c\u5e76\u8f93\u51fa\u53d6 $i$ \u7684\u987a\u5e8f\u3002\n\n\u6570\u636e\u4fdd\u8bc1 $b_{b_{...b_i}}$ \u4e00\u5b9a\u4ee5 $-1$ \u7ed3\u5c3e\uff0c\u5373\u4e0d\u5b58\u5728\u73af\u3002\n\n## \u9898\u89e3\n\n\u6309\u7167 $b$ \u6240\u7ed9\u7684\u5173\u7cfb\u8fde\u8fb9\uff0c\u663e\u7136\u5f62\u6210\u4e86\u4e00\u4e2a\u68ee\u6797\u7684\u7ed3\u6784\u3002\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u6bcf\u68f5\u6811\u5206\u5f00\u7b97\u3002\n\n\u8003\u8651\u4e00\u4e2a\u8d2a\u5fc3\u7684\u601d\u8def\uff0c\u8ba9\u6bcf\u4e2a\u8282\u70b9\u80fd\u53d6\u5230\u7684\u503c\u5c3d\u91cf\u5927\uff0c\u8fd9\u4e2a\u80fd\u53d6\u5230\u503c\u7684\u8bb0\u4e3a $f_i$ \u3002\n\n\u56e0\u4e3a\u513f\u5b50\u53ef\u4ee5\u5411\u7236\u4eb2\u589e\u52a0\u5b83\u7684 $f_i$\u3002\u90a3\u4e48\u53ea\u8981\u8fd9\u4e2a $f_i$ \u662f\u4e2a\u6b63\u6570\uff0c\u6211\u4eec\u5c31\u4e00\u5b9a\u8981\u53d6\u3002\n\n\u81f3\u4e8e\u8f93\u51fa\u65b9\u6848\uff0c\u53ef\u4ee5\u9012\u5f52\u8f93\u51fa\u3002$f_i$ \u4e3a\u6b63\u7684\u513f\u5b50\u5148\u904d\u5386\uff0c\u8f93\u51fa\u5f53\u524d\u8282\u70b9\uff0c\u518d\u904d\u5386$f_i$ \u4e3a\u8d1f\u7684\u513f\u5b50\u3002\n\ncode\uff1a\n```\n#include<bits/stdc++.h>\nusing namespace std;\ntemplate<class T>inline void read(T &x)\n{\n\tx=0;int f=0;char ch=getchar();\n\twhile(!isdigit(ch))\tf=ch=='-',ch=getchar();\n\twhile(isdigit(ch))\tx=(x<<1)+(x<<3)+(ch^48),ch=getchar();\n\tx=f?-x:x;\n}\nconst int N=2e5+5;\nstruct edge{\n\tint next,to;\n}e[N<<1];\nint n,head[N],a[N],cnt,deg[N],rt[N],tot;\nlong long ans,f[N];\nvector<int> fro[N],bac[N];\nvoid add(int u,int v)\n{\n\te[++cnt]={head[u],v};\n\thead[u]=cnt;\n}\nvoid dfs(int x)\n{\n\tf[x]=a[x];\n\tfor(int i=head[x];i;i=e[i].next)\n\t{\n\t\tint y=e[i].to;\n\t\tdfs(y);\n\t\tif(f[y]>0)\tfro[x].push_back(y),f[x]+=f[y];\n\t\telse\t\tbac[x].push_back(y);\n\t}\n\tans+=f[x];\n}\nvoid outit(int x)\n{\n\tfor(auto y:fro[x])\toutit(y);\n\tprintf(\"%d \",x);\n\tfor(auto y:bac[x])\toutit(y);\n}\nint main()\n{\n\tread(n);\n\tfor(int i=1;i<=n;i++)\tread(a[i]);\n\tfor(int i=1,to;i<=n;i++)\n\t{\n\t\tread(to);\n\t\tif(~to)\tadd(to,i);\n\t\telse\trt[++tot]=i;\n\t}\n\tfor(int i=1;i<=tot;i++)\tdfs(rt[i]);\n\tprintf(\"%lld\\n\",ans);\n\tfor(int i=1;i<=tot;i++)\toutit(rt[i]);\n\treturn 0;\n}\n```\n",
        "postTime": 1596419312,
        "uid": 304995,
        "name": "PanH",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1388D \u3010Captain Flint and Treasure\u3011"
    },
    {
        "content": "\u7b2c\u4e00\u95ee\u6c42\u6700\u5927 $ans$ \uff0c\u8fd9\u4e2a\u6ca1\u4ec0\u4e48\u95ee\u9898\u76f4\u63a5\u8dd1\u8bb0\u641c\u5c31\u884c\u4e86\u3002\n\n\u9ebb\u70e6\u7684\u662f\u7b2c\u4e8c\u95ee\uff0c\u4ed6\u8981\u6c42\u8fbe\u5230\u8fd9\u4e2a\u6700\u4f18\u89e3\u7684\u64cd\u4f5c\u987a\u5e8f\u3002\n\n```plain\n        -1 -> 100 -> -1 -> 100\nedgeid     1      2     3\n```\n\n\u901a\u8fc7\u53cd\u5411\u5efa\u8fb9\u8dd1\u8bb0\u641c\u53ef\u4ee5\u5f97\u51fa\u64cd\u4f5c\u540e\u6bcf\u4e2a\u70b9\u6700\u5927\u7684 $a_i$ \u4e3a $-1,99,99,199$\n\n\u5728\u64cd\u4f5c\u4e2d\uff0c\u6211\u4eec\u53d1\u73b0 1 \u53f7\u8fb9\u4f1a\u8ba9\u540e\u9762\u7684 100 \u7684\u503c\u53d8\u4f4e\uff0c\u8fd9\u79cd\u8fb9\u80af\u5b9a\u8981\u6700\u540e\u64cd\u4f5c\n\n\u7136\u540e 2 \u53f7\u8fb9\u548c 3 \u53f7\u8fb9\u90fd\u662f\u53ef\u4ee5\u8ba9\u503c\u53d8\u5927\u7684\uff0c\u6240\u4ee5\u8981\u6309\u7167\u5148 2 \u53f7\u8fb9\u518d 3 \u53f7\u8fb9\u8fd9\u6837\u6765\u64cd\u4f5c\uff0c\u8ba9\u589e\u52a0\u7684\u503c\u53e0\u52a0\n\n\u628a\u80fd\u8ba9\u503c\u53d8\u5927\u7684\u64cd\u4f5c\u5168\u90e8\u6309\u7167\u987a\u5e8f\u8f93\u51fa\uff0c\u8fd9\u4e2a\u987a\u5e8f\u53ef\u4ee5\u53c2\u8003\u62d3\u6251\u6392\u5e8f\n\n\u63a5\u4e0b\u6765\u5904\u7406\u90a3\u4e9b\u4f1a\u8ba9\u503c\u53d8\u5c0f\u7684\u8fb9\n\n```plain\n        -1 -> -1 -> 100\nedgeid     1     2  \n```\n\n\u5728\u8fd9\u91cc\uff0c\u6211\u4eec 1 \u53f7\u8fb9\u548c 2 \u53f7\u8fb9\u90fd\u662f\u4f1a\u8ba9\u6307\u5411\u7684\u70b9\u7684\u503c\u53d8\u5c0f\u7684\u8fb9\uff0c\u6211\u4eec\u80af\u5b9a\u4e0d\u80fd\u60f3\u4e4b\u524d\u628a\u51cf\u5c11\u7684\u503c\u53e0\u52a0\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u8ddf\u4e4b\u524d\u4e00\u6837\uff0c\u4f46\u662f\u7528\u53cd\u5411\u62d3\u6251\u5e8f\uff08\u6216\u8005\u5efa\u53cd\u56fe\u7136\u540e\u7684\u62d3\u6251\u5e8f\uff09\u8f93\u51fa\u8fd9\u4e9b\u64cd\u4f5c\u70b9\n\n```cpp\n// This code wrote by chtholly_micromaker(MicroMaker)\n#include <bits/stdc++.h>\n#define reg register\n#define int long long\nusing namespace std;\nconst int MaxN=200050;\ntemplate <class t> inline void read(t &s)\n{\n\ts=0;\n\treg int f=1;\n\treg char c=getchar();\n\twhile(!isdigit(c))\n\t{\n\t\tif(c=='-')\n\t\t\tf=-1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c))\n\t\ts=(s<<3)+(s<<1)+(c^48),c=getchar();\n\ts*=f;\n\treturn;\n}\nint a[MaxN];\nint f[MaxN],n;\nvector<int> nxt[MaxN],pre[MaxN];\nint deg[MaxN];\nbool bad[MaxN];\ninline int dfs(int u)\n{\n\tif(~f[u])\n\t\treturn f[u];\n\tf[u]=a[u];\n\tfor(int i=0;i<(int)nxt[u].size();++i)\n\t{\n\t\treg int v=nxt[u][i];\n\t\treg int t=dfs(v);\n\t\tif(t>0)\n\t\t\tf[u]+=t,pre[v].push_back(u),++deg[u];//,printf(\"degup %d\\n\",u);\n\t\telse\n\t\t\tbad[v]=true,pre[u].push_back(v),++deg[v];\n\t}\n\treturn f[u];\n}\nsigned main(void)\n{\n\tmemset(f,-1,sizeof f);\n\tcin>>n;\n\tfor(int i=1;i<=n;++i)\n\t\tread(a[i]);\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\treg int x;read(x);\n\t\tif(x!=-1)\n\t\t\tnxt[x].push_back(i);\n\t}\n\treg int ans=0;\n\tfor(int i=1;i<=n;++i)\n\t\tans+=dfs(i);\n\tcout<<ans<<endl;\n\tqueue<int> Q;\n\tfor(int i=1;i<=n;++i)\n\t\tif(!deg[i]&&!bad[i])\n\t\t\tQ.push(i);\n\twhile(!Q.empty())\n\t{\n\t\treg int u=Q.front();Q.pop();\n\t\tif(bad[u])\n\t\t\tcontinue;\n\t\tprintf(\"%lld \",u);\n\t\tfor(int i=0;i<(int)pre[u].size();++i)\n\t\t{\n\t\t\treg int v=pre[u][i];\n\t\t\t--deg[v];\n\t\t\tif(!deg[v])\n\t\t\t\tQ.push(v);\n\t\t}\n\t}\n\tfor(int i=1;i<=n;++i)\n\t\tif(!deg[i]&&bad[i])\n\t\t\tQ.push(i);\n\twhile(!Q.empty())\n\t{\n\t\treg int u=Q.front();Q.pop();\n\t\tif(!bad[u])\n\t\t\tcontinue;\n\t\tprintf(\"%lld \",u);\n\t\tfor(int i=0;i<(int)pre[u].size();++i)\n\t\t{\n\t\t\treg int v=pre[u][i];\n\t\t\tif(!bad[v])\n\t\t\t\tcontinue;\n\t\t\t--deg[v];\n\t\t\tif(!deg[v])\n\t\t\t\tQ.push(v);\n\t\t}\n\t}\n\tputs(\"\");\n\treturn 0;\n}\n```",
        "postTime": 1596413956,
        "uid": 51376,
        "name": "MyukiyoMekya",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1388D \u3010Captain Flint and Treasure\u3011"
    },
    {
        "content": "**\u9898\u610f**\n\n\u7ed9\u957f\u5ea6\u4e3a$n$\u7684\u5e8f\u5217$a[n]$\u548c$b[n]$\uff0c\u521d\u59cb\u65f6$ans=0$,\u6709\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n\n+ $ans=ans+a[i]$\n+ \u5982\u679c$b[i]\\neq-1$\uff0c\u5219$a[b[i]]=a[b[i]]+a[i]$\n\n\u95ee\u6bcf\u4e2a\u5143\u7d20\u64cd\u4f5c\u4e00\u6b21\u540e\uff0c$ans$\u6700\u5927\u4e3a\u591a\u5c11\uff0c\u5e76\u8f93\u51fa\u64cd\u4f5c\u5e8f\u5217\n\n**\u5206\u6790**\n\n\u5bf9\u4e8e\u4e00\u4e2a\u6570\uff0c\u5982\u679c\u4ed6\u6709\u524d\u9a71\u7684\u8bdd\uff0c\u53ef\u4ee5\u8003\u8651\u5bf9\u4e8e\u5176\u67d0\u4e9b\u524d\u9a71\u8fdb\u884c\u64cd\u4f5c\u540e\u518d\u64cd\u4f5c\u8be5\u6570\uff0c\u90a3\u4e48\u753b\u4e00\u4e2a\u524d\u9a71\u56fe\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u662f\u4e00\u4e2a\u62d3\u6251\u6392\u5e8f\u7684\u9898\uff0c\u64cd\u4f5c\u5230\u67d0\u4e2a\u8282\u70b9\u65f6\n\n+ \u5982\u679c\u8be5\u8282\u70b9\u7684\u503c\u5927\u4e8e$0$\uff0c\u8bf4\u660e\u5c06\u5176\u64cd\u4f5c\u5230\u540e\u7eed\u8282\u70b9\u4e00\u5b9a\u662f\u66f4\u4f18\u7684\n+ \u5426\u5219\uff0c\u8fd9\u4e2a\u8282\u70b9\u4e00\u5b9a\u8981\u665a\u4e8e\u5176\u540e\u7eed\u8282\u70b9\u64cd\u4f5c\uff0c\u5426\u5219\u4f1a\u5c06\u8be5\u8282\u70b9\u7684\u503c\u518d\u8d21\u732e\u4e00\u6b21\n\n\u90a3\u4e48\u62d3\u6251\u6392\u5e8f\u7684\u65f6\u5019\u7ef4\u62a4\u4e00\u4e2a\u961f\u5217\u548c\u4e00\u4e2a\u6808\uff0c\u5bf9\u4e8e\u503c\u5927\u4e8e$0$\u7684\u8282\u70b9\uff0c\u5c06\u5176\u653e\u5165\u961f\u5217\u4e2d\uff0c\u7136\u540e\u5c06\u5176\u503c\u52a0\u5165\u540e\u7eed\u8282\u70b9\uff0c\u5426\u5219\u5c06\u5176\u653e\u5165\u6808\u4e2d\uff08\u56e0\u4e3a\u82e5\u8fde\u7eed\u4e24\u4e2a\u8282\u70b9\u503c\u90fd\u5c0f\u4e8e$0$\uff0c\u90a3\u4e48\u5e94\u5148\u64cd\u4f5c\u540e\u7eed\u8282\u70b9\uff09\uff0c\u6700\u540e\u8f93\u51fa\u5373\u53ef\n\n```cpp\n#pragma GCC optimize(3, \"Ofast\", \"inline\")\n \n#include <bits/stdc++.h>\n \n#define start ios::sync_with_stdio(false);cin.tie(0);cout.tie(0);\n#define ll long long\n#define int ll\n#define ls st<<1\n#define rs st<<1|1\n#define pii pair<int,int>\n#define rep(z, x, y) for(int z=x;z<=y;++z)\n#define repd(z, x, y) for(int z=x;z>=y;--z)\n#define com bool operator<(const node &b)const\nusing namespace std;\nmt19937 rnd(chrono::high_resolution_clock::now().time_since_epoch().count());\nconst int maxn = (ll) 3e5 + 5;\nconst int mod = 998244353;\nconst int inf = 0x3f3f3f3f;\nint T = 1;\nint a[maxn], b[maxn];\nvector<int> v[maxn];\nint in[maxn];\n \nvoid solve() {\n    int n;\n    cin >> n;\n    rep(i, 1, n)cin >> a[i];\n    rep(i, 1, n) {\n        cin >> b[i];\n        if (b[i] != -1) {\n            v[i].push_back(b[i]);\n            ++in[b[i]];\n        }\n    }\n    int ans = 0;\n    queue<int> q;\n    rep(i, 1, n) {\n        if (in[i] == 0) {\n            q.push(i);\n        }\n    }\n    vector<int> tmp;\n    stack<int> last;\n    while (!q.empty()) {\n        int now = q.front();\n        if (a[now] > 0)\n            tmp.push_back(now);\n        else\n            last.push(now);\n        ans += a[now];\n        q.pop();\n        for (auto &to:v[now]) {\n            if (a[now] > 0)\n                a[to] += a[now];\n            --in[to];\n            if (in[to] == 0) {\n                q.push(to);\n            }\n        }\n    }\n    cout << ans << '\\n';\n    for (auto &to:tmp)cout << to << ' ';\n    while (!last.empty()) {\n        cout << last.top() << ' ';\n        last.pop();\n    }\n}\n \nsigned main() {\n    start;\n    while (T--)\n        solve();\n    return 0;\n}\n```\n\n",
        "postTime": 1596517185,
        "uid": 147428,
        "name": "F_Mu",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1388D \u3010Captain Flint and Treasure\u3011"
    },
    {
        "content": "# \u9898\u610f\n\u5927\u5c0f\u4e3an\u7684\u6570\u7ec4a\u548cb\uff0c1~n\u6309\u67d0\u79cd\u6392\u5217\u4f9d\u6b21\u9009\u62e9\uff0c\u6bcf\u6b21\u5c06a[i]\u52a0\u5230ans\u4e2d\uff0c\u82e5b[i]\u4e0d\u4e3a-1\uff0c\u5219a[b[i]]+=a[i]\uff0c\u95eeans\u6700\u5927\u503c\u4ee5\u53ca\u5bf9\u5e94\u7684\u4e00\u79cd\u6392\u5217\u3002\n\n# \u89e3\u6cd5\n\u5bf9\u6bcf\u4e00\u4e2ab[i]\u76f4\u63a5\u5efa\u6709\u5411\u8fb9i->b[i]\uff0c\u8fdb\u884c\u62d3\u6251\u6392\u5e8f\u3002\u56e0\u4e3a\u6ca1\u6709\u5165\u5ea6\u7684\u70b9\u503c\u5c06\u4e0d\u518d\u6539\u53d8\u3002\u5bf9\u4e8e\u503c\u4e3a\u8d1f\u6570\u7684\u70b9\uff0c\u5c31\u653e\u5728\u540e\u9762\uff0c\u907f\u514d\u51cf\u5c0f\u5176\u4ed6\u70b9\u7684\u503c\uff0c\u5176\u4f59\u7684\u70b9\u5c31\u53ef\u4ee5\u76f4\u63a5\u987a\u7740\u505a\u3002\n\n# AC\u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\n#define jh(x, y) x ^= y ^= y ^= x\n#define lowbit(x) (x & -x)\n#define loc(x, y) (x = 1) * m + y\n#define rg register\n#define inl inline\ntypedef long long ll;\nconst int N = 5e5 + 5, INF = 0x3f3f3f3f, mod = 998244353;\nusing namespace std;\nnamespace fast_IO {\n\tinl ll read() {\n\t\trg char c;\n\t\trg ll x = 0;\n\t\trg bool flag = false;\n\t\twhile ((c = getchar()) == ' ' || c == '\\n' || c == '\\r');\n\t\tif (c == EOF)return c; if (c == '-')flag = true; else x = c ^ 48;\n\t\twhile ((c = getchar()) != ' ' && c != '\\n' && c != '\\r' && ~c)\n\t\t\tx = (x << 1) + (x << 3) + (c ^ 48);\n\t\tif (flag)return -x; return x;\n\t}\n\tinl ll max(rg ll a, rg ll b) { if (a > b)return a; return b; }\n\tinl ll min(rg ll a, rg ll b) { if (a < b)return a; return b; }\n\tvoid write(ll x) { if (x < 0)putchar('-'), x = -x; if (x >= 10)write(x / 10); putchar(x % 10 ^ 48); }\n}\nll A[N], B[N], du[N], nt[N], ans[N], lt[N], q[N], head, tail = 1;\nvoid add(int x, int y) {\n\tnt[x] = y;\n\t++du[y];\n}\n\nint main() {\n\tll n = fast_IO::read(), ANS = 0;\n\tfor (rg int i = 1; i <= n; ++i)A[i] = fast_IO::read();\n\tfor (rg int i = 1; i <= n; ++i) {\n\t\tB[i] = fast_IO::read();\n\t\tif (~B[i])add(i, B[i]);\n\t}\n\tfor (rg int i = 1; i <= n; ++i)if (du[i] == 0)q[++head] = i;\n\twhile (head >= tail) {\n\t\trg int k = q[tail++];\n\t\tif (A[k] < 0)lt[++*lt] = k;\n\t\telse {\n\t\t\tans[++*ans] = k;\n\t\t\tANS += A[k];\n\t\t\tA[nt[k]] += A[k];\n\t\t}\n\t\t--du[nt[k]];\n\t\tif (du[nt[k]] == 0)q[++head] = nt[k];\n\t}\n\twhile (*lt)ans[++*ans] = lt[*lt], ANS += A[lt[*lt]], (*lt)--;\n\tprintf(\"%I64d\\n\", ANS);\n\tfor (rg int i = 1; i <= n; ++i)printf(\"%I64d \", ans[i]);\n\treturn 0;\n}\n```\n",
        "postTime": 1596444039,
        "uid": 87283,
        "name": "Zechariah",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1388D \u3010Captain Flint and Treasure\u3011"
    },
    {
        "content": "## \u524d\u8a00\n\u5b89\u5229\u81ea\u5df1\u9996\u573a CF \u7684[\u6e38\u8bb0](https://www.luogu.com.cn/blog/PsephurusGladius-zdx/codeforces-round-660-div-2-post)\uff08\u5176\u5b9e\u5565\u4e5f\u6ca1\u5199\uff09\u3002\n\n## \u9898\u76ee\u5206\u6790\n\u5bb9\u6613\u53d1\u73b0\u6240\u6709 $b_i$ \u8868\u793a\u51fa\u7684\u5173\u7cfb\u4f1a\u6784\u6210\u4e00\u4e2a DAG\u3002\u7531\u4e8e\u6211\u4eec\u9700\u8981\u8ba9\u6700\u540e\u7684\u7b54\u6848\u6700\u5927\uff0c\u6709\u4e00\u4e2a\u663e\u7136\u7684\u8d2a\u5fc3\u7b56\u7565\uff1a\u82e5\u5f53\u524d\u7ed3\u70b9\u6743\u503c\u4e0d\u4e3a\u8d1f\uff0c\u5219\u5c06\u5b83\u7684\u6743\u503c\u7d2f\u8ba1\u5230\u5b83\u7684\u51fa\u8fb9\u5bf9\u5e94\u7684\u7ed3\u70b9\u4e0a\uff0c\u5373\u8ba9\u5b83\u6bd4\u5b83\u7684\u51fa\u8fb9\u5bf9\u5e94\u7684\u7ed3\u70b9\u5747\u5148\u9009\u62e9\uff1b\u5426\u5219\u8ba9\u5b83\u540e\u9009\u62e9\u3002\u6c42\u7b54\u6848\u7684\u8fd9\u4e00\u6b65\u7528\u62d3\u6251\u6392\u5e8f\u5c31\u53ef\u4ee5\u89e3\u51b3\u4e86\u3002\n\n\u4f46\u662f\u8fd9\u9053\u9898\u8fd8\u9700\u8981\u6211\u4eec\u8f93\u51fa\u65b9\u6848\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u9700\u8981\u77e5\u9053\u9009\u62e9\u7ed3\u70b9\u7684\u987a\u5e8f\u3002\u5982\u4e0a\u6240\u8ff0\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u6bcf\u4e00\u6761\u8fb9\u4e0a\u4e24\u4e2a\u70b9\u9009\u62e9\u7684\u5148\u540e\u987a\u5e8f\uff1a\u82e5\u8d77\u70b9\u4e3a\u8d1f\u5219\u5148\u9009\u7ec8\u70b9\uff0c\u5426\u5219\u5148\u9009\u8d77\u70b9\u3002\u8003\u573a\u4e0a\u6211\u60f3\u5230\u7684\u662f\u5f53\u67d0\u4e2a\u70b9\u4e3a\u8d1f\u6570\u65f6\u5c31\u5c06\u5b83\u7684\u51fa\u8fb9\u5168\u90e8\u9006\u5411\u3002\u663e\u7136\uff0c\u8fd9\u6837\u505a\u5e76\u4e0d\u4f1a\u6539\u53d8\u5b83\u662f DAG \u7684\u6027\u8d28\u3002\u4e4b\u540e\u5728\u65b0\u56fe\u4e0a\u8dd1\u4e00\u904d\u62d3\u6251\u6392\u5e8f\uff0c\u5e76\u4f7f\u5f97\u5bf9\u4e8e\u6bcf\u4e00\u6761\u8fb9\uff0c\u6ee1\u8db3 $priority_{from}<priority_{to}$\u3002\u6309\u7167 $priority_i$ \u4ece\u5c0f\u5230\u5927\u7684\u987a\u5e8f\u8f93\u51fa\u7ed3\u70b9\u5373\u53ef\u3002\n\n## \u4ee3\u7801\n```cpp\n#include<algorithm>\n#include<cstdio>\n#include<queue>\nusing namespace std;\nlong long n,ans,tot[2],a[200001],b[200001],head[2][200001],go[2][200001],suc[2][200001],degree[2][200001];\nqueue<long long>que;\nstruct node\n{\n\tlong long no,priority;\n}p[200001];\ninline bool cmp(const node &t1,const node &t2)\n{\n\treturn t1.priority<t2.priority;\n}\ninline void add_edge(long long opt,long long u,long long v)\n{\n\tgo[opt][++tot[opt]]=v;\n\tsuc[opt][tot[opt]]=head[opt][u];\n\thead[opt][u]=tot[opt];\n\t++degree[opt][v];\n\treturn;\n}\nsigned main()\n{\n\tscanf(\"%lld\",&n);\n\tfor(long long i=1;i<=n;++i)\n\t\tscanf(\"%lld\",&a[i]);\n\tfor(long long i=1;i<=n;++i)\n\t{\n\t\tscanf(\"%lld\",&b[i]);\n\t\tif(b[i]!=-1)\n\t\t\tadd_edge(0,i,b[i]);\n\t\tp[i].no=i;\n\t}\n\tfor(long long i=1;i<=n;++i)\n\t\tif(!degree[0][i])\n\t\t\tque.push(i);\n\twhile(!que.empty())\n\t{\n\t\tlong long front=que.front();\n\t\tque.pop();\n\t\tans+=a[front];\n\t\tfor(long long i=head[0][front];i;i=suc[0][i])\n\t\t{\n\t\t\t--degree[0][go[0][i]];\n\t\t\tif(!degree[0][go[0][i]])\n\t\t\t\tque.push(go[0][i]);\n\t\t\tif(a[front]>=0)\n\t\t\t{\n\t\t\t\ta[go[0][i]]+=a[front];\n\t\t\t\tadd_edge(1,front,go[0][i]);\n\t\t\t}\n\t\t\telse add_edge(1,go[0][i],front);\n\t\t}\n\t}\n\tfor(long long i=1;i<=n;++i)\n\t\tif(!degree[1][i])\n\t\t\tque.push(i);\n\twhile(!que.empty())\n\t{\n\t\tlong long front=que.front();\n\t\tque.pop();\n\t\tfor(long long i=head[1][front];i;i=suc[1][i])\n\t\t{\n\t\t\t--degree[1][go[1][i]];\n\t\t\tif(!degree[1][go[1][i]])\n\t\t\t\tque.push(go[1][i]);\n\t\t\tp[go[1][i]].priority=max(p[go[1][i]].priority,p[front].priority+1);\n\t\t}\n\t}\n\tsort(p+1,p+n+1,cmp);\n\tprintf(\"%lld\\n\",ans);\n\tfor(long long i=1;i<=n;++i)\n\t\tprintf(\"%lld \",p[i].no);\n\treturn 0;\n}\n```",
        "postTime": 1596441665,
        "uid": 67952,
        "name": "\u767d\u9c9f",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1388D \u3010Captain Flint and Treasure\u3011"
    },
    {
        "content": "\u662f\u6211\u592a\u83dc\u4e86\uff0c\u5199\u5b8c\u6bd4\u8d5b\u521a\u597d\u7ed3\u675f ( 1551\n\n\u8fd9\u9053\u9898\u7684\u601d\u8def\u4e0d\u96be\uff0c\u6211\u4eec\u4e0d\u96be\u53d1\u73b0\u9009\u62e9\u6b63\u6570\u603b\u662f\u6bd4\u9009\u62e9\u8d1f\u6570\u597d\uff0c\u56e0\u4e3a\u8d1f\u6570\u53ef\u80fd\u4f1a\u8ba9\u522b\u7684\u6570\u66f4\u5c0f\uff0c\u800c\u6b63\u6570\u53ef\u80fd\u4f1a\u8ba9\u522b\u7684\u6570\u66f4\u5927\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u628a\u6240\u6709\u7684\u6b63\u6570\u70b9\u5149\u3002\u90a3\u4e48\u95ee\u9898\u6765\u4e86\uff0c\u600e\u4e48\u9009\u6b63\u6570\u3002\n\n\u6211\u4eec\u601d\u8003\u600e\u6837\u624d\u80fd\u8ba9\u4e00\u4e2a\u6b63\u6570\u7684\u8d21\u732e\u6700\u5927\uff0c\u90a3\u5f53\u7136\u662f\u5148\u70b9\u6700\u6df1\u7684\u3002\u6211\u4eec\u8fd9\u91cc\u5b9a\u4e49\u4e00\u4e0b\u6df1\u5ea6\u6700\u5927\u8fd9\u4ef6\u4e8b\n\n\u5df2\u77e5$a_i$\u53ef\u4ee5\u4e3a$a_{b_i}$\u505a\u8d21\u732e\uff0c\u5982\u679c\u4ee5\u8fd9\u4e2a\u65b9\u5411\u5efa\u65e0\u5411\u56fe\u4f1a\u5f62\u6210\u4e00\u7247\u68ee\u6797\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a\u8fd9\u4e9b\u8fb9\u662f\u6709\u65b9\u5411\u7684\uff0c\u5982\u679c\u6211\u4eec\u6309\u7167\u9898\u76ee\u6240\u7ed9\u7684\u65b9\u5411\u5efa\uff0c$a_i$->$a_{b_i}$\uff0c\u90a3\u8fd9\u6837\u6839\u5c31\u662f\u6ca1\u6709\u51fa\u5ea6\u7684\u90a3\u4e2a\u70b9\uff0c\u7136\u800c\u8fd9\u6837\u4e0d\u597d\u5904\u7406\uff0c\u56e0\u4e3a\u6211\u4eec\u662f\u4ece\u6839\u5f00\u59cb\u904d\u5386\u6574\u68f5\u6811\u6765\u8bb0\u5fc6\u5316\u6df1\u5ea6\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53cd\u5411\u5efa\u8fb9\uff0c\u4e5f\u5c31\u662f \u7236\u8282\u70b9->\u5b50\u8282\u70b9 \u7684\u6709\u5411\u8fb9\uff0c\u8868\u793a\u7236\u8282\u70b9\u53ef\u4ee5\u88ab\u5b50\u8282\u70b9\u8d21\u732e\u3002\n\n\u7136\u540e\u6211\u4eecdfs\u4e00\u904d\u5904\u7406\u68ee\u6797\u91cc\u6bcf\u4e00\u4e2a\u8282\u70b9\u5728\u6811\u91cc\u7684\u6df1\u5ea6\u5c31\u884c\u4e86\u3002\n\n\u90a3\u4e3a\u4ec0\u4e48\u8981\u5904\u7406\u8fd9\u4e2a\u6df1\u5ea6\u5462\uff0c\u6211\u4eec\u601d\u8003\u4e00\u4e0b\u8fd9\u4e2a\u6811\u7684\u542b\u4e49\u3002\u5982\u679c\u6211\u4eec\u4ece\u53f6\u5b50\u5f00\u59cb\u9009\u62e9\u8fd9\u4e9b\u8282\u70b9\uff0c\u90a3\u4e48\u8fd9\u4e9b\u8282\u70b9\u7684\u6743\u503c\u5c31\u4f1a\u5411\u7236\u4eb2\u4f20\u9012\uff0c\u4f46\u662f\u6309\u7167\u53cd\u65b9\u5411\u6765\uff0c\u7236\u8282\u70b9\u7684\u6743\u503c\u65e0\u6cd5\u5411\u513f\u5b50\u4f20\u9012\u3002\u6240\u4ee5\u5bf9\u4e8e\u6b63\u6743\u503c\u8282\u70b9\uff0c\u5148\u5904\u7406\u66f4\u6df1\u7684\u8282\u70b9\u603b\u80fd\u8ba9\u5b83\u7684\u8d21\u732e\u6700\u5927\u5316\u3002\n\n\u4f46\u662f\u6211\u4eec\u9700\u8981\u77e5\u9053\uff0c\u9009\u62e9\u4e00\u4e2a\u6b63\u8282\u70b9\u4ee5\u540e\uff0c\u7236\u8282\u70b9\u53ef\u80fd\u88ab\u5b50\u8282\u70b9\u66f4\u65b0\u4e3a\u6b63\u8282\u70b9\uff0c\u800c\u6b64\u65f6\u8fd9\u4e2a\u6b63\u8282\u70b9\u7684\u4f18\u5148\u7ea7\u4f1a\u6bd4\u67d0\u4e9b\u6b63\u8282\u70b9\u9ad8\u3002\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u9700\u8981\u6309\u7167\u6df1\u5ea6\u52a8\u6001\u7ef4\u62a4\u6b63\u8282\u70b9\u3002\u4e0d\u96be\u60f3\u5230\u7528\u4f18\u5148\u961f\u5217\u7ef4\u62a4pair\u6216\u8005\u7ed3\u6784\u4f53\u5b9e\u73b0\u3002\n\n\u800c\u5bf9\u4e8e\u8d1f\u8282\u70b9\uff0c\u5904\u7406\u662f\u76f8\u53cd\u7684\uff0c\u6211\u4eec\u9700\u8981\u5b83\u7684\u8d21\u732e\u5c3d\u53ef\u80fd\u5c11\uff08\u51cf\u53bb\u7684\u8d8a\u5c11\uff09\uff0c\u4e5f\u5c31\u662f\u8d1f\u7684\u7236\u8282\u70b9\u7684\u4f18\u5148\u7ea7\u9ad8\u4e8e\u8d1f\u7684\u5b50\u8282\u70b9\u7684\u4f18\u5148\u7ea7\uff0c\u540c\u6837\u53ef\u4ee5\u7528\u4f18\u5148\u961f\u5217\u7ef4\u62a4\uff0c\u4e0d\u8fc7\u65b9\u5411\u4e0d\u540c\n\n### AC\u4ee3\u7801\n```cpp\n#include<map>\n#include<set>\n#include<cmath>\n#include<queue>\n#include<vector>\n#include<cstdio>\n#include<cstring>\n#include<cstdlib>\n#include<iostream>\n#include<algorithm>\ntypedef long long ll;\ntypedef unsigned long long ull;\n#define rep(i,a,b) for(register ll i = (a);i <= (b);++i)\n#define per(i,a,b) for(register ll i = (a);i >= (b);--i)  \nusing std::string;using std::cin;using std::cout;\nusing std::priority_queue;\n\n//pair<dep,num>\npriority_queue<std::pair<ll,ll> > a_zheng;\npriority_queue<std::pair<ll,ll> > a_fu;\n\nconst ll N = 2e5+5;\nll a[N],b[N],ans,p[N],cnt;\nll head[N],next[N],ver[N],tot,dep[N];\ninline void link(ll x,ll y){ver[++tot] = y , next[tot] = head[x] , head[x] = tot;}\nll n;\ninline void dfs(ll now,ll father){\n\tdep[now] = dep[father] + 1;\n\tfor(ll i = head[now];i;i = next[i]){\n\t\tif(ver[i] == father) continue;\n\t\tdfs(ver[i],now);\n\t}\n}\n\nint main(){\n\tdep[0] = -1 , cnt = 0;\n\tstd::ios::sync_with_stdio(0);cin.tie(0);cout.tie(0);\n\t//freopen(\"in.in\", \"r\", stdin);\n\tcin >> n;\n\twhile(a_zheng.size()) a_zheng.pop();\n\twhile(a_fu.size()) a_fu.pop();\n\trep(i,1,n) cin >> a[i];\n\trep(i,1,n) cin >> b[i];\n\trep(i,1,n) dep[i] = 0;\n\trep(i,1,n){\n\t\tif(b[i] < 0) continue;\n\t\tlink(b[i],i);\n\t\tdep[i] = -1;\n\t}\n\trep(i,1,n){\n\t\tif(dep[i] == 0) dfs(i,0);\n\t\telse continue;\n\t}\n\trep(i,1,n) if(a[i] >= 0) a_zheng.push(std::make_pair(dep[i],i));\n\twhile(a_zheng.size()){\n\t\tstd::pair<ll,ll> now = a_zheng.top();a_zheng.pop();\n\t\tans += a[now.second] , a[ b[now.second] ] += a[now.second];\n\t\tp[++cnt] = now.second;\n\t\tif(a[ b[now.second] ] - a[now.second] < 0 && a[ b[now.second] ] >= 0) a_zheng.push(std::make_pair(dep[ b[now.second] ],b[now.second]));\n\t}\n\trep(i,1,n) if(a[i] < 0) a_fu.push(std::make_pair(-dep[i],i));\n\twhile(a_fu.size()){\n\t\tstd::pair<ll,ll> now = a_fu.top();a_fu.pop();\n\t\tans += a[now.second] , a[ b[now.second] ] += a[now.second];\n\t\tp[++cnt] = now.second;\n\t}\n\tcout << ans << \"\\n\";\n\trep(i,1,cnt) cout << p[i] << \" \";\n\tcout << \"\\n\";\n\treturn 0;\n}\n```",
        "postTime": 1596418973,
        "uid": 123389,
        "name": "Isshiki_Hugh",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 CF1388D \u3010Captain Flint and Treasure\u3011"
    },
    {
        "content": "[\u9898\u9762](https://www.luogu.com.cn/problem/CF1388D)\n\n#### \u7ffb\u8bd1\u6709\u8bef\u7684\u95ee\u9898\uff1a\n\n[\u770b\u8fd9\u91cc](https://www.luogu.com.cn/discuss/408280)\n\n#### \u9898\u76ee\u5206\u6790\uff1a\n\n\u6ce8\u610f\u5230 $n \\leq 2\\times10^5$ \u663e\u7136\u9700\u8981 $O(n\\log n)$ \u53ca\u4ee5\u5185\u7684\u7b97\u6cd5\u3002\n\n\u9898\u76ee\u4e2d\u6709\u4e00\u70b9\u63d0\u793a\uff1a\u4fdd\u8bc1\u4e0d\u5b58\u5728\u73af\u3002\n\n\u8fd9\u544a\u8bc9\u6211\u4eec\u8fd9\u9898\u53ef\u4ee5\u7528\u56fe\u8bba\u89e3\u51b3\u3002\u628a $i$ \u548c $b_i$ \u4e4b\u95f4\u5efa\u8fb9\uff0c\u5355\u5411\u8fb9\uff0c\u5c0f\u4e8e $n$ \u4e2a\uff0c\u6709\u7ed3\u675f\u70b9\uff0c\u4f60\u60f3\u5230\u4e86\u4ec0\u4e48\uff1f\u8fd9\u662f\u4e00\u7247\u68ee\u6797\u3002\u6bcf\u4e00\u6b21\u64cd\u4f5c\u76f8\u5f53\u4e8e\u628a\u6574\u6761\u94fe\u4e0a\u7684\u70b9\u5168\u90e8\u52a0\u4e0a\u4e00\u4e2a\u6570\u3002\u4e0d\u96be\u53d1\u73b0\u4ece\u4e0b\u5f80\u4e0a\u7d2f\u52a0\u6700\u4f18\uff0c\u6240\u4ee5\u76f4\u63a5 dfs \u4e00\u4e0b\u5373\u53ef\u3002\n\n\u5bf9\u4e8e $u$ \u5982\u679c $u$ \u7684\u5b50\u6811\u7684\u503c\u5df2\u7ecf\u90fd\u7d2f\u52a0\u5230\u4e86 $u$ \u8fd9\u4e2a\u8282\u70b9\uff0c\u4f46\u662f $u$ \u7684\u70b9\u6743\u8fd8\u662f\u8d1f\u6570\uff0c\u90a3\u4e48\u5c31\u4e0d\u53bb\u7d2f\u52a0\u8fd9\u4e2a\u8282\u70b9\uff0c\u628a\u5b83\u653e\u5230\u6700\u540e\u3002\u8fd9\u6837\u80fd\u4fdd\u8bc1\u6700\u4f18\u3002\n\n\u7b54\u6848\u4e3a\u6700\u540e\u628a\u6240\u6709\u8282\u70b9\u7684\u70b9\u6743\u52a0\u5728\u4e00\u8d77\u3002\n\n\u603b\u590d\u6742\u5ea6\uff1a$O(n)$\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n[\u63d0\u4ea4\u8bb0\u5f55](https://www.luogu.com.cn/record/69053943)\n\n```cpp\n#include<bits/stdc++.h>\n#define mem(a,b) memset(a,b,sizeof(a));\n#define pc putchar\n#define fast_iostream ios::sync_with_stdio(0),cin.tie(0),cout.tie(0)\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double ld;\ntypedef double db;\nconst ld EPS=1e-8;\nconst ll INF=ll(1e9+7);\nconst ll LLINF=ll(1e18+7);\nconst ld LDEPS=1e-18;\nconst ll MAXN=2e5+7;\ninline ll max(ll x,ll y){return x>y?x:y;}\ninline ll min(ll x,ll y){return x<y?x:y;}\ninline ld dmax(ld x,ld y){return x>y?x:y;}\ninline ld dmin(ld x,ld y){return x<y?x:y;}\ninline ll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\ninline ll lcm(ll a,ll b){return a*b/gcd(a,b);}\ninline ll lowbit(ll x){return x&(-x);}\ninline ll read(){ll read_result=0,is_below_0=0;char now_ch=0;while(!isdigit(now_ch)){is_below_0|=now_ch=='-';now_ch=getchar();}while(isdigit(now_ch)){read_result=(read_result<<3)+(read_result<<1)+(now_ch^48);now_ch=getchar();}return is_below_0?-read_result:read_result;}\ninline ld dread(){ld x=0,d=0.1;char f=0,ch=getchar();while(!isdigit(ch))f|=(ch=='-'),ch=getchar();while(isdigit(ch)) x=x*10+ch-48,ch=getchar();if(ch=='.'){ch=getchar();while(isdigit(ch))x+=d*(ch^48),d*=0.1,ch=getchar();}return f?-x:x;}\ninline void write(ll x){if(x<0){putchar('-');x=-x;}if(x>9){write(x/10);}putchar(x%10+'0');}\nll n,a[MAXN],b[MAXN],ans[MAXN],dfncnt,dfn[MAXN],res=0,ans1[MAXN];\nvector<ll>tree[MAXN];\nvoid dfs(ll u,ll fa)\n{\n\tif(u>0)ans[u]=a[u];\n\tfor(ll i=0;i<tree[u].size();i++)\n\t{\n\t\tll son=tree[u][i];\n\t\tif(son==fa)continue;\n\t\tdfs(son,u);\n\t\tif(ans[son]>0)ans[u]+=ans[son];\n\t}\n\tif(ans[u]>0&&u>0)dfn[u]=++dfncnt;\n\tif(u>0)res+=ans[u];\n}\nvoid dfs1(ll u,ll fa)\n{\n\tif(u>0&&!dfn[u])dfn[u]=++dfncnt; \n\tfor(ll i=0;i<tree[u].size();i++)\n\t{\n\t\tll son=tree[u][i];\n\t\tif(son==fa)continue;\n\t\tdfs1(son,u);\n\t}\n}\nint main()\n{\n\tn=read();\n\tfor(ll i=1;i<=n;i++)a[i]=read();\n\tfor(ll i=1;i<=n;i++)\n\t{\n\t\tb[i]=read();\n\t\tif(b[i]!=-1)tree[b[i]].push_back(i);\n\t\telse tree[0].push_back(i);\n\t}\n\tdfs(0,-1),dfs1(0,-1);\n\twrite(res),pc(10);\n\tfor(ll i=1;i<=n;i++)ans1[dfn[i]]=i;\n\tfor(ll i=1;i<=n;i++)\n\t{\n\t\twrite(ans1[i]);\n\t\tpc(32);\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1644809790,
        "uid": 395288,
        "name": "Yuby",
        "ccfLevel": 6,
        "title": "CF1388D\u9898\u89e3"
    }
]
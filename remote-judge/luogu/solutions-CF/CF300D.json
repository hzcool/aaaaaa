[
    {
        "content": "### P.S.\n\u5176\u5b9e\u633a\u7533\u5fc5\u7684\uff0c\u4f46\u662f\u9898\u76ee\u521a\u5f00\u59cb\u770b\u9519\u4e86\u3002  \n\n### Description.\n\u6bcf\u6b21\u6b63\u65b9\u5f62\u5fc5\u987b\u5207\u6210\u56db\u4e2a\u6b63\u65b9\u5f62\u3002  \n\u95ee\u7ed9\u5b9a\u6b63\u65b9\u5f62\u88ab\u5207 $k$ \u6b21\u540e\u80fd\u5f62\u6210\u51e0\u4e2a\u4e0d\u4e00\u6837\u7684\u6b63\u65b9\u5f62\u3002  \n\n### Solution.\n\u9996\u5148\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u6bcf\u6b21\u5207\u5272\u8f6c\u79fb\u7c7b\u4f3c\u4e8e $i\\rightarrow 2i+1$\u3002  \n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5927\u529b dp\uff0c\u8bbe\u72b6\u6001 $f_{i,j}$ \u8868\u793a\u8fb9\u957f\u4e3a $i$\uff0c\u5207 $j$ \u5200\u7684\u65b9\u6848\u6570\u3002  \n\u90a3\u4e48\u6211\u4eec\u663e\u7136\u6709\u8f6c\u79fb\uff0c\u5982\u4e0b\u3002  \n$$f_{2i+1,a+b+c+d-1}\\leftarrow f_{i,a}\\times f_{i,b}\\times f_{i,c}\\times f_{i,d}$$  \n~~\u597d\u7136\u540e\u5c31\u505a\u5b8c\u4e86~~  \n\u505a\u5b8c\u4e2a dam\uff0c\u4f18\u826f\u590d\u6742\u5ea6 $O(n\\times K^4)$\u3002  \n~~\u677e\u4e00\u677e\uff1f\uff08\uff08\uff08~~  \n\u597d\uff0c\u7136\u540e\u6211\u4eec\u6765\u8003\u8651\u5982\u4f55\u4f18\u5316\u3002  \n\u8fd9\u4e2a $O(K^4)\\rightarrow O(K^2)$ \u662f\u57fa\u4e8e\u4e00\u4e2a\u5957\u8def\u3002  \n\u89c2\u5bdf\u8f6c\u79fb\u5f0f\u5b50\uff0c\u53d1\u73b0\u5176\u4e2d\u7684 $a,b,c,d$ \u672c\u8d28\u90fd\u662f\u76f8\u540c\u7684\u3002  \n\u90a3\u4e48\u6211\u4eec\u6bcf $\\sqrt4=2$ \u4e2a\u8f6c\u79fb\u5206\u4e00\u7ec4\uff0c\u7136\u540e\u5148\u7ec4\u5185\u8f6c\u79fb\uff0c\u7ec4\u5185\u8f6c\u79fb\u5b8c\u4e4b\u540e\u7ec4\u89c1\u8f6c\u79fb\u3002  \n\u5177\u4f53\u7684\uff0c\u8bbe\u8f85\u52a9\u6570\u7ec4 $g_{2i+1,a+b}\\leftarrow g_{i,a}\\times g_{i,b}$\u3002  \n\u90a3\u4e48\u663e\u7136\u6709\u8f6c\u79fb\u5982\u4e0b\u3002  \n$$\\begin{cases}f_{2i+1,a+b-1}\\leftarrow g_{i,a}\\times g_{i,b}\\\\g_{2i+1,a+b}\\leftarrow f_{2i+1,a}\\times f_{2i+1,b}\\end{cases}$$  \n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\u3002  \n\u6865\u8c46\u9ebb\u888b\uff0c\u6211\u4eec\u53d1\u73b0 $n\\le 10^9$\uff0c\u7136\u540e\u590d\u6742\u5ea6\u539f\u5730\u7206\u70b8\u3002  \n\u5982\u4f55\u4f18\u5316\u8fd9\u4e2a $n$ \u5462\uff1f\u6211\u4eec\u8003\u8651\u628a\u5b83\u53d8\u6210 $\\log n$  \n\u6211\u4eec\u89c2\u5bdf\u8f6c\u79fb\u5f0f\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u6bcf\u6b21\u90fd\u662f $n\\rightarrow 2n+1$\u3002  \n\u90a3\u4e48\u6211\u4eec\u5b9a\u4e49\u5076\u6570\u70b9\u4e3a\u65e0\u6cd5\u8f6c\u79fb\u70b9\u3002  \n\u7136\u540e\u6bcf\u4e2a\u53ef\u8f6c\u79fb\u70b9 $x$ \u90fd\u662f\u6bcf\u6b21\u53d8\u6210 $\\frac{x-1}2$\uff0c\u81f3\u591a $\\log x$ \u6b21\u540e\u5c31\u53d8\u6210\u4e86\u65e0\u6cd5\u8f6c\u79fb\u70b9\u3002  \n\u540c\u65f6\uff0c\u6bcf\u4e2a\u53ef\u8f6c\u79fb\u70b9\u90fd\u663e\u7136\u662f\u76f8\u540c\u7684\u3002  \n\u800c\u6211\u4eec\u53d1\u73b0\uff0c\u6bcf\u6b21\u8f6c\u79fb\u7b54\u6848\u90fd\u662f\u672c\u8d28\u4e00\u6837\u7684\u3002  \n\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u70b9\u53ef\u4ee5\u8f6c\u79fb\u76f4\u81f3\u975e\u8f6c\u79fb\u70b9\u7684\u6b21\u6570\u4e3a\u5b83\u7684\u6df1\u5ea6\u3002  \n\u90a3\u4e48\u6211\u4eec\u8bc1\u660e\u4e86\uff0c\u4efb\u610f\u4e24\u4e2a\u540c\u6df1\u5ea6\u7684\u70b9\uff0c\u5b83\u4eec\u7684\u7b54\u6848\u76f8\u540c\u3002  \n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u8bb0\u5f55\u6bcf\u4e2a\u7ed3\u70b9\u7684\u6df1\u5ea6\u5c31\u597d\u4e86\u3002  \n\u590d\u6742\u5ea6\u53d8\u6210\u4e86 $O(K^2\\log n)$\uff0c\u8db3\u4ee5\u901a\u8fc7\u6b64\u9898\u3002  \n### Coding.\n~~\u4ee3\u7801\u4e0d\u653e\u4e86\uff0c\u6709\u624b\u5c31\u884c\u3002~~  \n[\u4ee3\u7801\u94fe\u63a5](https://codeforces.com/contest/300/submission/111345601)  ",
        "postTime": 1617022725,
        "uid": 44805,
        "name": "Leap_Frog",
        "ccfLevel": 7,
        "title": "CF300D Painting Square\uff08\u9898\u89e3\uff09"
    },
    {
        "content": "[portal to luogu](https://www.luogu.com.cn/problem/CF300D)\n\n[portal to CF](codeforces.com/problemset/problem/300/D)\n\n~~\u770b\u89c1\u6ca1\u6709\u9898\u89e3\u5c31\u8dd1\u8fc7\u6765\u6c34\u9898\u89e3\u4e86~~\n\nCF\u4e0a\u6709FFT\u7684tag\uff0c\u4f46\u662f\u8fd9\u9898\u4e0d\u9700\u8981FFT\uff08\u867d\u7136\u5f53$k$\u518d\u5927\u4e00\u70b9\u5c31\u9700\u8981\u4e86\uff09\u3002\n\n\u9996\u5148\uff0c\u5bf9\u4e8e\u4efb\u4f55\u4e00\u4e2a\u6b63\u65b9\u5f62\uff0c\u5b83\u90fd\u53ea\u80fd\u8fdb\u884c\u552f\u4e00\u7684\u64cd\u4f5c\uff1a\u5207\u4e00\u5200\uff0c\u5206\u6210\u56db\u4e2a\u4e00\u6a21\u4e00\u6837\u7684\u6b63\u65b9\u5f62\u3002\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u6b63\u65b9\u5f62\u7684\u6df1\u5ea6\u4e3a\uff1a\u5bf9\u4e8e\u4e00\u4e2a\u6b63\u65b9\u5f62\uff0c\u4e00\u76f4\u7167\u7740\u5207\u5b8c\u540e\u5de6\u4e0a\u89d2\u7684\u6b63\u65b9\u5f62\u5207\uff0c\u76f4\u5230\u5207\u4e0d\u4e86\u4e3a\u6b62\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a$5\\times 5$\u6b63\u65b9\u5f62\u7684\u6df1\u5ea6\u4e3a$1$\uff08\u5207\u4e00\u5200\u5207\u51fa\u56db\u4e2a$2\\times 2$\u7684\uff09\uff0c\u4e00\u4e2a$7\\times 7$\u6b63\u65b9\u5f62\u7684\u6df1\u5ea6\u4e3a$2$\uff08\u5207\u4e00\u5200\u5207\u51fa$3\\times 3$\uff0c\u518d\u5207\u5207\u51fa$1\\times 1$\uff09\uff0c\u4e00\u4e2a$100\\times 100$\u6b63\u65b9\u5f62\u7684\u6df1\u5ea6\u4e3a$0$\uff08\u4e00\u5200\u90fd\u5207\u4e0d\u4e86\uff09\u3002\n\n\u6211\u4eec\u8003\u8651DP\u3002\u8bbe$f_{i,j}$\u8868\u793a\uff1a\u5728\u4e00\u4e2a\u6df1\u5ea6\u4e3a$i$\u7684\u6b63\u65b9\u5f62\u4e2d\uff0c\u5207$j$\u5200\uff0c\u6240\u80fd\u5f97\u5230\u7684\u4e0d\u540c\u5c40\u9762\u6570\u3002\n\n\u5219\u6211\u4eec\u6709$f_{x,y}=\\sum\\limits_{i+j+k+l=y-1}f_{x-1,i}\\times f_{x-1,j}\\times f_{x-1,k}\\times f_{x-1,l}$\u3002\u5b83\u7684\u610f\u4e49\u662f\u5206\u522b\u5728\u5207\u51fa\u6765\u7684\u56db\u4e2a\u5c0f\u6b63\u65b9\u5f62\u4e2d\u5207$i,j,k,l$\u5200\u7684\u79cd\u6570\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u8bbe$g_{x,y}=\\sum\\limits_{i+j=y}f_{x,i}\\times f_{x,j}$\uff0c\u5219$f_{x,y}=\\sum\\limits_{i+j=y-1}g_{x-1,i}\\times g_{x-1,j}$\u3002\n\n\u4e00\u4e2a\u6b63\u65b9\u5f62\u7684\u6df1\u5ea6\u662f$\\log$\u7ea7\u522b\u7684\u3002\u66b4\u529b\u8f6c\u79fb\u662f$k^2$\u7684\u3002\u5219\u8fd9\u4e2aDP\u7684\u590d\u6742\u5ea6\u4e3a$k^2\\log n$\uff0c\u521a\u597d\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n\u6211\u4eec\u4e0d\u59a8\u8003\u8651\u4e00\u4e0b\u5982\u679c$k$\u518d\u5927\u4e00\u70b9\uff0c\u6bd4\u5982$5\\times 10^3$\u6216$1\\times 10^4$\u3002\u8fd9\u65f6\uff0c\u8fd9\u4e2a\u66b4\u529bDP\u5c31\u53ef\u80fd\u5361\u4e0d\u8fc7\u53bb\u3002\n\n\u6211\u4eec\u89c2\u5bdf\u4e00\u4e0b\u8f6c\u79fb\u5f0f\uff1a$g_{x,y}=\\sum\\limits_{i+j=y}f_{x,i}\\times f_{x,j}$\uff0c\u5377\u79ef\u7684\u6c14\u606f\uff01\u4e5f\u5c31\u662f\u8bf4\uff0c$g_x=(f_x)^2$\u3002\n\n$f_{x,y}=\\sum\\limits_{i+j=y-1}g_{x-1,i}\\times g_{x-1,j}$\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c$f_x=(g_{x-1})^2$\u3002\u91c7\u53d6NTT\uff0c\u590d\u6742\u5ea6\u4f18\u5316\u4e3a$O(k\\log n\\log k)$\uff08$7340033$\u662fNTT\u8d28\u6570\uff0c\u539f\u6839\u4e3a$3$\uff09\u3002\n\n\u867d\u7136\u53ef\u4ee5\u7528NTT\uff0c\u4f46\u8fd9\u5e76\u4e0d\u610f\u5473\u7740\u66b4\u529bDP\u4e0d\u53ef\u4ee5\uff08~~\u5176\u5b9e\u662f\u56e0\u4e3a\u6211\u592a\u61d2\u4e86\u61d2\u5f97\u5199NTT\u4e86~~\uff09\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint cnt,n,K,T,f[100][10000],g[100][10000];\nconst int mod=7340033;\nvoid init(){\n\tfor(int i=0;i<=30;i++)f[i][0]=g[i][0]=1;//for squares of any size, if we do not have any cuts, there will only be one situation\n\tfor(int i=1;i<=30;i++)for(int j=1;j<=1000;j++){\n\t\tfor(int k=0;k<j;k++)f[i][j]=(1ll*g[i-1][k]*g[i-1][j-k-1]%mod+f[i][j])%mod;\n\t\tfor(int k=0;k<=j;k++)g[i][j]=(1ll*f[i][k]*f[i][j-k]%mod+g[i][j])%mod;\n\t}\n}\nint main(){\n\tinit();\n\tscanf(\"%d\",&T);\n\twhile(T--){\n\t\tscanf(\"%d%d\",&n,&K),cnt=0;\n\t\tfor(;(n&1)&&(n>1);n>>=1)cnt++;\n\t\tprintf(\"%d\\n\",f[cnt][K]);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1581146113,
        "uid": 123369,
        "name": "xtx1092515503",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF300D \u3010Painting Square\u3011"
    },
    {
        "content": "\u5b9a\u4e49\u4e00\u4e2a\u6b63\u65b9\u5f62\u7684\u6df1\u5ea6\u4e3a\u53ea\u64cd\u4f5c\u4efb\u610f\u4e00\u89d2\u7684\u6b63\u65b9\u5f62\u7684\u6700\u5927\u64cd\u4f5c\u6b21\u6570\u3002\n\n$f_{m,k}$: \u6df1\u5ea6\u4e3a m \u7684\u6b63\u65b9\u5f62\u64cd\u4f5c k \u6b21\u540e\u4e0d\u540c\u6570\u91cf\u3002\n\n\u663e\u7136\u6709\uff1a\n\n$$f_{m,k}=\\sum_{k_1+k_2+k_3+k_4=k-1} f_{m-1,k_1} \\times f_{m-1,k_2} \\times f_{m-1,k_3} \\times f_{m-1,k_4}$$\n\n\u6ce8\u610f\u5230 $m$ \u6700\u591a\u4e3a $\\log n$\uff0c\u6240\u4ee5\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a $k^4\\log n$ \u7684\u5783\u573e\u505a\u6cd5\u3002\n\n\u82e5\u5e72\u4e2a\u4e0b\u6807\u7684\u548c\u4e3a\u5b9a\u503c\uff0c\u6839\u636e\u5957\u8def\u6784\u9020\u5377\u79ef\u3002\n\n\u4ee4 $g_{m,k}=\\displaystyle \\sum_{k_1+k_2=k} f_{m-1,k_1} \\times f_{m-1,k_2}$\n\n\u90a3\u4e48\u6709\uff1a\n\n$$f_{m,k}=\\sum_{k_1+k_2=k-1}g_{m,k_1} \\times g_{m,k_2}$$\n\n$f,g$ \u7684\u8f6c\u79fb\u5747\u4e3a\u5377\u79ef\uff0c\u4f7f\u7528 ntt \u8f6c\u79fb\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O(k\\log k \\log n)}$\u3002\n\n```cpp\n#include <cstdio>\n#include <vector>\n#include <iostream>\nusing namespace std;\n\nconst int MAXN = 4000 , Mod = 7340033;\nint Add( int x , int y ) { x += y; return x >= Mod ? x - Mod : x; }\nint Sub( int x , int y ) { x -= y; return x < 0 ? x + Mod : x; }\nint Mul( int x , int y ) { return 1ll * x * y % Mod; }\nint Quick_pow( int x , int po ) { int Ans = 1; for( ; po ; po >>= 1 , x = Mul( x , x ) ) if( po & 1 ) Ans = Mul( Ans , x ); return Ans; }\nint Inv( int x ) { return Quick_pow( x , Mod - 2 ); }\n\n#define Poly vector< int >\n#define len( x ) ( (int)x.size() )\n\nconst int G = 3 , IG = 2446678;\nint lim , ilim , rev[ MAXN + 5 ];\nvoid ntt( Poly &f , int ty ) {\n\tfor( int i = 0 ; i < lim ; i ++ ) if( i < rev[ i ] ) swap( f[ i ] , f[ rev[ i ] ] );\n\tfor( int len = 2 ; len <= lim ; len <<= 1 ) {\n\t\tint w = Quick_pow( ty == 1 ? G : IG , ( Mod - 1 ) / len );\n\t\tfor( int l = 0 ; l < lim ; l += len ) {\n\t\t\tfor( int i = l , wk = 1 ; i < l + len / 2 ; i ++ , wk = Mul( wk , w ) ) {\n\t\t\t\tint t = Mul( wk , f[ i + len / 2 ] );\n\t\t\t\tf[ i + len / 2 ] = Sub( f[ i ] , t ); f[ i ] = Add( f[ i ] , t ); \n\t\t\t}\n\t\t}\n\t}\n\tif( ty == -1 ) for( int i = 0 ; i < lim ; i ++ ) f[ i ] = Mul( f[ i ] , ilim );\n}\nPoly operator * ( Poly f , Poly g ) {\n\tint n = len( f ) + len( g ) - 1; for( lim = 1 ; lim < n ; lim <<= 1 ); ilim = Inv( lim );\n\tfor( int i = 0 ; i < lim ; i ++ ) rev[ i ] = ( rev[ i >> 1 ] >> 1 ) | ( i & 1 ? lim >> 1 : 0 );\n\tf.resize( lim ); g.resize( lim );\n\tntt( f , 1 ); ntt( g , 1 );\n\tfor( int i = 0 ; i < lim ; i ++ ) f[ i ] = Mul( f[ i ] , g[ i ] );\n\tntt( f , -1 ); f.resize( min( n , 1001 ) );\n\treturn f;\n}\n\nPoly f[ 35 ] , g[ 35 ];\nvoid Dp( ) {\n\tf[ 0 ].resize( 1 ); f[ 0 ][ 0 ] = 1;\n\tfor( int i = 1 ; i <= 30 ; i ++ ) {\n\t\tg[ i ] = f[ i - 1 ] * f[ i - 1 ];\n\t\tf[ i ] = g[ i ] * g[ i ];\n\n\t\tint t = f[ i ].back();\n\t\tfor( int j = len( f[ i ] ) - 1 ; j >= 1 ; j -- ) f[ i ][ j ] = f[ i ][ j - 1 ];\n\t\tf[ i ].push_back( t );\n\t}\n}\n\nint t , n , k;\nint main( ) {\n\tDp();\n\tscanf(\"%d\",&t);\n\twhile( t -- ) {\n\t\tscanf(\"%d %d\",&n,&k);\n\t\tint cnt = 0;\n\t\tfor( int x = n ; ( x & 1 ) && x != 1 ; x = x / 2 , cnt ++ );\n\t\tprintf(\"%d\\n\", len( f[ cnt ] ) <= k ? 0 : f[ cnt ][ k ] );\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1615626313,
        "uid": 123802,
        "name": "chihik",
        "ccfLevel": 0,
        "title": "CF300D Painting Square"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF300D)\n\n\u8fd9\u662f\u4e00\u9053~~\u6076\u8bc4~~\u9898($CF$\u4e0a$2300$,\u6d1b\u8c37\u4e0a\u662f\u4e00\u9053\u7d2b\u9898)\n\n\u8fd9\u9898\u5176\u5b9e\u5e76\u4e0d\u96be(\u5f53\u7136\u7528$FFT$\u7684\u5f53\u6211\u6ca1\u8bf4)\n\n## \uff08\u3007\uff09\u524d\u7f6e\u77e5\u8bc6\n\n1.\u52a8\u6001\u89c4\u5212\n\n2.~~FFT~~\n\n## \uff08\u4e00\uff09\u89e3\u9898\u601d\u8def\n\n\u8fd9\u4e2a$DP$\u5e94\u8be5\u662f\u5f88\u5bb9\u6613\u770b\u51fa\u6765\u7684\u3002\n\n\u9898\u76ee\u6709$k$\u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u64cd\u4f5c\u53ef\u4ee5\u5c06$1$\u4e2a\u6b63\u65b9\u5f62\u5212\u5206\u6210$4$\u4e2a\u6b63\u65b9\u5f62\uff0c\u7ed9\u51fa\u4e00\u4e2a$n\\times n$\u7684\u6b63\u65b9\u5f62\uff0c\u95ee\u6709\u591a\u5c11\u79cd\u4e0d\u540c\u7684\u5212\u5206\u65b9\u6848\u3002\n\n\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6bcf\u6b21\u64cd\u4f5c\u4f1a\u5360\u7528\u6b63\u65b9\u5f62\u6700\u4e2d\u95f4\u7684\u4e00\u884c\u548c\u6700\u4e2d\u95f4\u7684\u4e00\u5217\uff0c\u4e14\u6bcf\u6b21\u5fc5\u987b\u8981\u5c06\u4e00\u4e2a\u5927\u6b63\u65b9\u5f62\u5212\u5206\u4e3a\u56db\u4e2a\u5c0f\u6b63\u65b9\u5f62(\u5373\u5212\u5206\u65b9\u6848\u4e2d\u4e0d\u80fd\u5b58\u5728\u975e\u6b63\u65b9\u5f62)\u3002\n\n\u521d\u770b\u9898\u76ee\uff0c\u5f88\u5bb9\u6613\u60f3\u5230$DP$\u3002$DP$\u7684\u72b6\u6001\u4e5f\u5f88\u5bb9\u6613\u8868\u793a\uff0c\u8bbe$f(n,k)$\u8868\u793a\u5c06\u4e00\u4e2a\u5927\u5c0f\u4e3a$n$\u7684\u6b63\u65b9\u5f62\u5212\u5206$k$\u6b21\u7684\u65b9\u6848\u6570\u3002\n\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5f88\u663e\u7136\u3002\u5373\n\n$$f(n,k)=\\sum\\limits_{i+j+x+y=k-1}f(\\dfrac{n-1}{2},i)\\times f(\\dfrac{n-1}{2},j)\\times f(\\dfrac{n-1}{2},x)\\times f(\\dfrac{n-1}{2},y)$$\n\n\u4e8e\u662f\u6211\u4eec\u5f88\u5f00\u5fc3\u5730\u770b\u4e86\u4e00\u773c\u6570\u636e\u8303\u56f4:$1\\leq n\\leq10^9,0\\leq k\\leq 1000$~~GG~~\n\n\u7a7a\u95f4\u548c\u65f6\u95f4\u90fd\u7206\u4e86\u3002\n\n\u9996\u5148\u6211\u4eec\u6765\u89e3\u51b3\u7a7a\u95f4\u95ee\u9898\u3002\u4e0d\u96be\u53d1\u73b0(\u5047\u8bbe$n$\u5f88\u5927)\uff0c\u6211\u4eec\u9700\u8981\u7528\u5230\u7684\u53ea\u6709$f(n,k)$\u548c$f(\\dfrac{n-1}{2},k)$\u4e2d\u95f4$n-1$\u5230$\\dfrac{n-1}{2}+1$\u7684\u7a7a\u95f4\u5176\u5b9e\u90fd\u6d6a\u8d39\u4e86\u3002\n\n\u800c\u4e14\uff0c\u7531\u4e8e\u6bcf\u6b21\u5fc5\u987b\u5207\u6210\u56db\u4e2a\u6b63\u65b9\u5f62\uff0c\u6240\u4ee5\u5f53$n\\%2=0$\u65f6\uff0c\u662f\u65e0\u6cd5\u5212\u5206\u51fa\u6b63\u65b9\u5f62\u7684\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u5f53\u4e8c\u8fdb\u5236\u4e0b$n$\u7684\u672b\u5c3e\u4e3a$0$\u65f6\uff0c$ans=0$\uff0c\u540e\u9762$\\dfrac{n-1}{2}$\n\u7684\u60c5\u51b5\u6211\u4eec\u4e5f\u4e0d\u9700\u8981\u8003\u8651\u4e86\u3002\n\n\u7531\u6b64\uff0c\u6211\u4eec\u9700\u8981\u7684\u7a7a\u95f4\u5927\u5927\u51cf\u5c0f\u4e86\uff0c\u53ea\u9700\u8981\u5173\u6ce8$\\dfrac{n-1}{2}$\u548c\u4e8c\u8fdb\u5236\u4e0b$n$\u7684\u672b\u5c3e\u4e0d\u4e3a$0$\u7684\u60c5\u51b5\u3002\n\n\u7528\u4e00\u4e2a$cnt$\u8bb0\u5f55$n$\u6ee1\u8db3\u4ee5\u4e0a\u6761\u4ef6\u7684$n$\u7684\u6570\u91cf\u3002\u90a3\u4e48$cnt$\u5b9e\u8d28\u4e0a\u5c31\u7b49\u4e8e\u4e8c\u8fdb\u5236\u4e0b$n$\u7684\u672b\u5c3e\u8fde\u7eed$1$\u7684\u4e2a\u6570(\u5f53\u7136\u5f53$n=1$\u65f6\uff0c\u6309\u7167\u9898\u76ee\u8981\u6c42\u6211\u4eec\u540c\u6837\u4e0d\u8003\u8651)\u3002\n\n\u663e\u7136$cnt\\leq 29$\n\n\u518d\u89e3\u51b3\u65f6\u95f4\u590d\u6742\u5ea6\u7684\u95ee\u9898\u3002\n\n\u89c2\u5bdf\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff0c\u6211\u4eec\u53d1\u73b0\u5176\u5b9e$k^4$\u7684\u679a\u4e3e\u505a\u4e86\u5f88\u591a\u65e0\u7528\u529f\uff0c\u5f88\u591a$i+j+x+y\\not= x$\u7684\u60c5\u51b5\u90fd\u88ab\u679a\u4e3e\u4e86\u3002\u4e0b\u9762\u662f$FFT$\u60ef\u7528\u4f0e\u4fe9\u3002\n\n\u8003\u8651\u5c06\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u62c6\u5206\u3002\u53d8\u4e3a\n\n$\\sum\\limits_{i+j=l}f(\\dfrac{n-1}{2},i)\\times f(\\dfrac{n-1}{2},j)$\u548c$\\sum\\limits_{x+y=z}f(\\dfrac{n-1}{2},x)\\times f(\\dfrac{n-1}{2},y)$\n\n\u5176\u4e2d$l+z=k-1$\u3002\u611f\u89c9\u5230\u4e86\u5377\u79ef\u5417\uff1f\n\n\u6700\u7ec8\u7684\u7b54\u6848\u5176\u5b9e\u5c31\u662f\u4e0a\u8ff0\u4e24\u4e2a\u591a\u9879\u5f0f\u76f8\u4e58(\u8fd9\u4e2a\u4e0d\u7528\u89e3\u91ca\u5427)\n\n\u8bbe$g(x,y)=\\sum\\limits_{i+j=y}f(x,i)\\times f(x,j)$\n\n\u90a3\u4e48\u539f\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5c31\u53d8\u4e3a:\n\n$$f(n,k)=\\sum\\limits_{i+j=k-1}g(\\dfrac{x-1}{2},i)\\times g(\\dfrac{x-1}{2},j)$$\n\n\u663e\u7136\u4e0a\u8ff0\u4e24\u4e2a\u5f0f\u5b50\u90fd\u80fd\u7528$FFT$\u5feb\u901f\u6c42\u51fa\u6765\u3002\u7136\u800c\u6570\u636e\u8303\u56f4\u544a\u8bc9\u6211\u4eec\u4e0d\u7528$FFT$\u3002\u6240\u4ee5~~\u6211\u624d\u4e0d\u7528FFT\u5462\uff0c\u8c01\u7528\u8c01***~~\u3002\u5f53\u7136\u6570\u636e\u8303\u56f4\u6269\u5927\u5c31\u5fc5\u987b\u7528\u4e86\u3002~~\u5efa\u8bae\u6269\u5927\u6570\u636e\u8303\u56f4~~",
        "postTime": 1598192942,
        "uid": 76228,
        "name": "God\u306efather",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF300D \u3010Painting Square\u3011"
    }
]
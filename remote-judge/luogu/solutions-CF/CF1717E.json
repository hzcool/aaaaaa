[
    {
        "content": "# Problem\n\n[Madoka and The Best University](https://www.luogu.com.cn/problem/CF1717E)\n\n# Sol\n\n\u5148\u679a\u4e3e $\\gcd$\uff0c\u518d\u679a\u4e3e $a + b$ \u662f $\\gcd$ \u7684\u51e0\u500d\u3002\n\n>\u8fd9\u91cc\u8bb2\u4e00\u4e0b\u4e3a\u4ec0\u4e48\u679a\u4e3e $\\gcd$ \u3002\n\n>\u9996\u5148\uff0c\u679a\u4e3e $\\gcd$ \u53ef\u4ee5\u679a\u4e3e $a + b$ \u7684\u503c\uff0c\u8fd9\u6837\u4e5f\u786e\u5b9a\u4e86 $c$ \u7684\u503c\uff0c\u5e76\u4e14\u4e5f\u53ef\u4ee5\u8ba1\u7b97\u51fa\u7b54\u6848\u3002\n\n\u8bbe\u662f $x$ \u500d\uff0c\u90a3\u4e48\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u5c06 $x$ \u5206\u6210\u4e24\u4e2a\u6570\uff0c\u4f7f\u5f97\u8fd9\u4e24\u4e2a\u6570\u4e92\u8d28\u3002\uff08\u56e0\u4e3a\u4e24\u4e2a\u6570\u7684 $\\gcd$ \u5fc5\u987b\u662f\u679a\u4e3e\u7684\u90a3\u4e2a\u6570\uff09\n\n\uff08\u4e0b\u6587\u7684 $a$\uff0c$b$\u4e0e\u4e0a\u9762\u4e0d\u540c\uff09\n\n\u8003\u8651\u4e00\u4e2a\u6570 $q$ \uff0c\u53e6\u4e00\u4e2a\u6570\u662f $x - q$\u3002\n\n\u5982\u679c $q$ \u548c $x$ \u4e0d\u4e92\u8d28\u3002\n\n\u8bbe $\\gcd(q,x) = p$\u3002\n\n\u5c31\u6709 $q = a \\times p,x = b\\times p $\u3002\n\n\u7531\u4e8e $q$ \u6bd4 $x$ \u5c0f\uff0c$a$ \u5fc5\u7136\u5c0f\u4e8e $b$\u3002\n\n\u6240\u4ee5 $x - q = (a - b) \\times p$ \u3002\n\n\u90a3\u4e48\u5c31\u4e0d\u6ee1\u8db3 $q$ \u4e0e $x - q$ \u4e92\u8d28\u3002\n\n\u6240\u4ee5 $q$ \u53ea\u80fd\u4e0e $x$ \u4e92\u8d28\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u8981\u6c42\u51fa\u4e0e $x$ \u4e92\u8d28\u7684\u6709\u591a\u5c11\u4e2a\u6570\uff0c\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u7528[\u6b27\u62c9\u51fd\u6570](https://oi-wiki.org/math/number-theory/euler/)\u505a\u3002\n\n# Code\n\n```\n#include<bits/stdc++.h>\n#define IOS ios::sync_with_stdio(0), cin.tie(0), cout.tie(0)\n#define int long long\n#define pb push_back\nusing namespace std;\n\nvoid read(int &x)\n{\n\tchar ch;\n\tint w = x = 0;\n\tch = getchar();\n\tfor (;!isdigit(ch);ch = getchar())\n\tw ^= (ch == 45);\n\tfor (;isdigit(ch);ch = getchar())\n\tx = x * 10 + (ch ^ 48);\n\tx = w ? -x : x;\n}\n\nconst int mod = 1e9 + 7;\n\nint n, f[200000], ans, vis[200000], sum[200000], cnt, p[200000];\n\nvoid make_prime()\n{\n\tvis[1] = 1;\n\tfor (int i = 2; i < n; i++)\n\t{\n\t\tif (!vis[i])\n\t\t{\n\t\t\tp[++cnt] = i;\n\t\t\tsum[i] = i - 1;\n\t\t}\n\t\tfor (int j = 1; j <= cnt && p[j] * i < n; j++)\n\t\t{\n\t\t\tvis[p[j] * i] = 1;\n\t\t\tif (i % p[j] == 0)\n\t\t\t{\n\t\t\t\tsum[i * p[j]] = sum[i] * p[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tsum[i * p[j]] = sum[i] * (p[j] - 1);\n\t\t}\n\t}\n}\n\nvoid solve()\n{\n\tcin >> n;\n\tmake_prime();\n\tfor (int i = 1;i < n;i++)\n\t{\n\t\tfor (int j = 2;j * i < n;j++)\n\t\t{\n\t\t\tint c = n - i * j, lcm = (c / __gcd(c, i) * i) % mod;\n\t\t\t(ans += sum[j] * lcm % mod) %= mod;\n\t\t}\n\t}\n    cout << ans << endl;\n}\n\nsigned main()\n{\n\tIOS;\n\tint t = 1;\n\t// cin >> t;\n\twhile (t--)\n\t{\n\t\tsolve();\n\t}\n}\n```",
        "postTime": 1662373432,
        "uid": 173424,
        "name": "Hovery",
        "ccfLevel": 6,
        "title": "CF1717E Madoka and The Best University"
    },
    {
        "content": "\u9996\u5148\u5316\u5f0f\u5b50\uff1a\n\n$$\n\\begin{aligned}\n & \\sum \\operatorname{lcm}(c, \\gcd(a, b)) \\\\\n= & \\sum \\frac{c \\cdot \\gcd(a, b)}{\\gcd(c, \\gcd(a, b))} \\\\\n= & \\sum \\frac{c \\cdot \\gcd(a, b)}{\\gcd(a, b, c)} \\\\\n= & \\sum \\frac{(n - a - b) \\cdot \\gcd(a, b)}{\\gcd(a, b, n - a - b)} \\\\\n= & \\sum \\frac{(n - a - b) \\cdot \\gcd(a, b)}{\\gcd(a, b, n)} \\\\\n\\end{aligned}\n$$\n\n\u8bbe $s = a + b$\uff0c$d = \\gcd(a, b)$\uff0c\u5219\u663e\u7136\u6709 $d|s$\u3002\n\n\u6211\u4eec\u5c1d\u8bd5\u4ece $1$ \u5230 $n$ \u679a\u4e3e $d$\uff0c\u518d\u679a\u4e3e $d$ \u7684\u500d\u6570\u4f5c\u4e3a $s$\uff0c\u8fd9\u4e00\u90e8\u5206\u7684\u590d\u6742\u5ea6\u4e3a $O(n \\log n)$\u3002\n\n\u6b64\u65f6\u6211\u4eec\u53d1\u73b0\u53ea\u9700\u8981\u7b97\u51fa $\\gcd(a, b) = d$ \u4e14 $a + b = s$ \u7684 $a$ \u4e0e $b$ \u7684\u5408\u6cd5\u65b9\u6848\u6570\u5373\u53ef\u3002\n\n\u8bbe $a' = \\frac{a}{d}$\uff0c $b' = \\frac{b}{d}$\uff0c$s' = \\frac{s}{d}$\uff0c\u5219\u65b9\u6848\u6570\u53ef\u8868\u793a\u4e3a\uff1a\n\n$$\n\\begin{aligned}\n& \\sum_{a' = 1}^{s'} [\\gcd(a', b') = 1] \\\\\n= & \\sum_{a' = 1}^{s'} [\\gcd(a', s' - a') = 1] \\\\\n= & \\sum_{a' = 1}^{s'} [\\gcd(a', s') = 1] \\\\\n= & \u03c6(s') = \u03c6(\\frac{s}{d})\n\\end{aligned}\n$$\n\n\u56e0\u6b64\u5f53\u679a\u4e3e\u4e00\u4e2a $s$ \u548c $d$ \u65f6\uff0c\u5b83\u4eec\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e3a\uff1a\n\n$$\\frac{(n - s) \\cdot d}{\\gcd(n, d)} \\cdot \u03c6(\\frac{s}{d})$$\n\n\u6ce8\u610f\u53d6\u503c\u8303\u56f4 $d \\in [1, n]$\uff0c$s \\in [2d, \\lfloor\\frac{n}{d}\\rfloor \\cdot d]$ \u4e14 $s | d$\uff0c\u7ebf\u6027\u6b27\u62c9\u7b5b\u6c42\u6b27\u62c9\u51fd\u6570\u5373\u53ef\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define ff fflush(stdout)\n#define fop(x, l, r) for (int x = l; x <= r; ++x)\n#define pof(x, r, l) for (int x = r; x >= l; --x)\nusing namespace std;\ntypedef long long ll;\nconst int mod = 1e9 + 7;\nint read() {\n    int x = 0; char c; bool f = 0;\n    while (!isdigit(c = getchar())) if (c == '-') f = 1;\n    do x = (x << 1) + (x << 3) + (c ^ 48); while (isdigit(c = getchar()));\n    return f ? -x : x;\n}\n\nconst int maxn = 1e5 + 3;\n\nint phi[maxn], prime[maxn], cnt;\nbool vis[maxn];\n\nvoid Euler(int n) {\n    phi[1] = 1;\n    fop(i, 2, n) {\n        if (!vis[i]) prime[++cnt] = i, phi[i] = i - 1;\n        for (int j = 1; j <= cnt && i * prime[j] <= n; ++j) {\n            vis[i * prime[j]] = 1;\n            if (i % prime[j] == 0) { phi[i * prime[j]] = phi[i] * prime[j]; break; }\n            phi[i * prime[j]] = phi[i] * (prime[j] - 1);\n        }\n    }\n}\n\nsigned main() {\n    int n = read();\n    Euler(n);\n    int ans = 0;\n    fop(d, 1, n) for (int s = 2 * d; s <= n; s += d) {\n        ans += (n - s) * d / __gcd(n, d) * phi[s / d] % mod;\n        if (ans >= mod) ans -= mod;\n    }\n    printf(\"%d\\n\", ans);\n}\n```\n",
        "postTime": 1665576783,
        "uid": 279857,
        "name": "Eafoo",
        "ccfLevel": 4,
        "title": "CF1717E \u9898\u89e3"
    },
    {
        "content": "\u770b\u89c1\u4e09\u5143\u7ec4\u4e0d\u96be\u5148\u601d\u8003\u53ef\u4e0d\u53ef\u4ee5\u679a\u4e3e\u5176\u4e2d\u7684\u4e00\u4e2a\u6570\u3002\u89c2\u5bdf\u5230 $c$ \u6bd4\u8f83\u7279\u6b8a\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u59a8\u7528 $i$ \u679a\u4e3e $c$\uff0c\u63a5\u4e0b\u6765\u601d\u8003 $\\gcd(a,b)$ \u5e94\u8be5\u5982\u4f55\u5904\u7406\u3002\n\n\u663e\u7136\u76f8\u540c\u7684 $\\gcd(a,b)$ \u5f97\u5230\u7684\u7b54\u6848\u4e5f\u76f8\u540c\uff0c\u6240\u4ee5\u53ef\u4ee5\u8bd5\u7740\u6c42\u51fa\u6bcf\u4e00\u79cd $\\gcd(a,b)$ \u7684\u65b9\u6848\u6570\u3002\u63a5\u4e0b\u6765\u8003\u8651 $\\gcd(a,b)$ \u7a76\u7adf\u6709\u591a\u5c11\u79cd\uff0c\u5982\u679c $a,b$ \u4e92\u8d28\uff0c\u90a3\u4e48 $\\gcd(a,b)=1$\uff1b\u5982\u679c\u4e0d\u4e92\u8d28\uff0c\u5219\u8bbe $p=\\gcd(a,b)$\uff0c\u6709 $a+b=n-i=kp$\uff0c\u4e5f\u5c31\u662f\u8bf4 $\\gcd(a,b)$ \u4e00\u5b9a\u4f1a\u662f $n-i$ \u7684\u6bcf\u4e2a\u56e0\u6570\u3002\n\n\u5c06\u95ee\u9898\u8f6c\u5316\u4e3a\u6c42 $\\operatorname{lcm}(i,k)\\times t$\uff0c\u5176\u4e2d $k$ \u8868\u793a $n-i$ \u7684\u6bcf\u4e2a\u56e0\u6570\uff0c\u8fd9\u662f\u53ef\u4ee5\u5728 $\\mathcal{O}(n\\sqrt{n})$ \u5185\u5b8c\u6210\u7684\u4efb\u52a1\u3002\u8fd9\u6837\u679a\u4e3e\u56e0\u6570\u53ea\u4f1a\u679a\u4e3e\u4e00\u534a\uff0c\u4f46\u662f\u53e6\u4e00\u534a\u53ef\u4ee5\u540c\u65f6\u5904\u7406\u3002\u4f46\u73b0\u5728\u95ee\u9898\u6765\u5230\u89e3\u51b3 $t$ \u4e0a\u3002\n\n$t$ \u7684\u610f\u601d\u662f\u6ee1\u8db3 $x+y=\\dfrac{n-i}{k}$ \u4e14 $\\gcd(x,y)=1$ \u7684\u65b9\u6848\u6570\u3002\u6211\u4eec\u5355\u72ec\u5904\u7406\u8fd9\u4e2a\u95ee\u9898\uff0c\u7528 $d$ \u4ee3\u6362 $\\dfrac{n-i}{k}$\uff0c\u76f4\u63a5\u627e $x+y=d$ \u4e14 $\\gcd(x,y)=1$ \u7684\u89c4\u5f8b\u5373\u53ef\u3002\u5982\u679c $x$ \u4e0e $y$ \u6ee1\u8db3 $\\gcd(x,y)\\neq 1$\uff0c\u90a3\u4e48 $\\exists k$ \u4f7f\u5f97 $d=k\\gcd(x,y)$\uff08\u4e58\u6cd5\u5206\u914d\u5f8b\uff09\u3002\u5bf9\u4e8e\u4e00\u79cd $\\gcd(x,y)$\uff0c\u6ee1\u8db3 $p\\gcd(x,y)+q\\gcd(x,y)=d$ \u7684\u4e00\u5b9a\u90fd\u4e0d\u7b26\u5408\u6761\u4ef6\uff0c\u6240\u4ee5\u5bf9\u4e8e\u4efb\u610f\u7684 $j$\uff0c\u5982\u679c $\\gcd(j,d)\\neq 1$\uff0c\u5219 $(j,d-j)$ \u4e00\u5b9a\u4e0d\u7b26\u5408\u6761\u4ef6\u3002\n\n\u53d1\u73b0\u4e86\u5417\uff0c$x+y=d$ \u4e14 $\\gcd(x,y)=1$ \u7684\u7b54\u6848\u5176\u5b9e\u5c31\u662f $\\varphi(d)$\uff0c\u8fd9\u4e2a\u73a9\u610f\u53ef\u4ee5\u7528\u7ebf\u7b5b\u63d0\u524d\u9884\u5904\u7406\uff0c\u5e76\u4e14 $\\mathcal{O}(1)$ \u5f97\u5230\u7b54\u6848\u3002\u6c42\u6b27\u62c9\u51fd\u6570\u7684\u65b9\u5f0f\u4e0d\u7ec6\u8bf4\u4e86\uff0c\u5927\u5bb6\u53ef\u4ee5\u53bb\u770b [P2158 [SDOI2008] \u4eea\u4ed7\u961f](https://www.luogu.com.cn/problem/P2158)\u3002\n\n\u7ecf\u8fc7\u4e0a\u9762\u7684\u601d\u8003\u540e\u53ef\u4ee5\u5f97\u5230\u4ee5\u4e0b\u67ff\u5b50\uff1a\n\n$$\nans=\\sum\\limits_{i=1}^{n-2}\\sum\\limits_{j\\mid n-i}^{j^2\\leqslant n-i}\\left[\\operatorname{lcm}(i,j)\\times\\varphi\\left(\\dfrac{n-i}{j}\\right)+\\operatorname{lcm}\\left(i,\\dfrac{n-i}{j}\\right)\\times\\varphi(j)\\times[j^2\\neq n-i\\;\\text{and}\\;j\\neq 1]\\right]\n$$\n\n\u53ef\u4ee5\u8f7b\u677e\u6c42\u89e3\uff0c$\\operatorname{lcm}$ \u53ef\u4ee5\u7528 $\\dfrac{ab}{\\gcd(a,b)}$ \u7684\u65b9\u5f0f\u89e3\u51b3\uff0c\u53ef\u4ee5\u5728\u6b64\u57fa\u7840\u4e0a\u4f7f\u7528\u9006\u5143\uff0c\u6b27\u62c9\u51fd\u6570\u7ebf\u7b5b\u89e3\u51b3\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u5e94\u8be5\u662f $\\mathcal{O}(n\\sqrt{n}\\log n)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n```cpp\n//E\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int N=5e5+5;\nint phi[N];\nvoid euler(int x){\n    for(register int i=2;i<=x;i++) phi[i]=0;\n    phi[1]=1;\n    for(register int i=2;i<=x;i++){\n        if(phi[i]==0){\n            for(register int j=i;j<=x;j+=i){\n                if(phi[j]==0) phi[j]=j;\n                phi[j]=phi[j]/i*(i-1);\n            }\n        }\n    }\n}\nint lcm(int a,int b){return a/(__gcd(a,b))*b;}\nsigned main(){\n    int n=read(),ans=0;\n    euler(n);\n    for(register int i=1;i<=n-2;i++){\n        int j=n-i;\n        for(register int k=1;k*k<=j;k++){\n            if(j%k==0){\n                int a=k;\n                int b=j/k;\n                ans=(ans+(lcm(i,a)%mod*phi[b]%mod)%mod)%mod;\n                if(k*k!=j&&k!=1) ans=(ans+(lcm(i,b)%mod*phi[a]%mod)%mod)%mod;\n            }\n        }\n    }\n    printf(\"%lld\",ans);\n}\n```",
        "postTime": 1662185549,
        "uid": 754746,
        "name": "Resolute_Faith",
        "ccfLevel": 0,
        "title": "[CF1717E] Madoka and The Best University"
    },
    {
        "content": "\u771f\u6b63\u7684 $O(n)$ \u7ebf\u6027\u505a\u6cd5\u3002\n\n\u5148\u6765 dirty work\uff1a\n$$\n\\begin{aligned}\n&\\sum_{c=1}^{n-2}\\sum_{a=1}^{n-c-1}\\text{lcm}(c,\\gcd(a,n-c-a))\n\\\\=& \\sum_{c=1}^{n-2}\\sum_{a=1}^{n-c-1}\\text{lcm}(c,\\gcd(a,n-c))\n\\\\=& \\sum_{c=1}^{n-2}\\sum_{d=1}^{n}\\sum_{a=1}^{n-c-1}[\\gcd(a,n-c)=d]\\text{lcm}(c,d)\n\\\\=& \\sum_{c=1}^{n-2}\\sum_{d=1}^{n}[d|n-c]\\text{lcm}(c,d)\\sum_{a=1}^{\\lfloor\\frac{n-c-1}{d}\\rfloor}[\\gcd(a,\\frac{n-c}{d})=1]\n\\\\=& \\sum_{c=1}^{n-2}\\sum_{d=1}^{n}[d|n-c]\\text{lcm}(c,d)\\varphi(\\frac{n-c}{d})[\\frac{n-c}{d}>1]\n\\\\=& \\sum_{c=2}^{n}\\sum_{d=1}^{n}[d|c]\\text{lcm}(n-c,d)\\varphi(\\frac{c}{d})[\\frac{c}{d}>1]\n\\\\=& \\sum_{d=1}^{n}\\sum_{c=2}^{\\lfloor\\frac{n}{d}\\rfloor}\\text{lcm}(n-cd,d)\\varphi(c)\n\\\\=& \\sum_{c=2}^{n}\\varphi(c)\\sum_{d=1}^{\\lfloor\\frac{n}{c}\\rfloor}\\text{lcm}(n-cd,d)\n\\\\=& \\sum_{i=2}^{n}\\varphi(i)\\sum_{j=1}^{\\lfloor\\frac{n}{i}\\rfloor}\\frac{j(n-ij)}{\\gcd(n-ij,j)}\n\\\\=& \\sum_{i=2}^{n}\\varphi(i)\\left(\\sum_{j=1}^{\\lfloor\\frac{n}{i}\\rfloor}\\text{lcm}(n,j)-i\\sum_{j=1}^{\\lfloor\\frac{n}{i}\\rfloor}\\frac{j^2}{\\gcd(n,j)}\\right)\n\\end{aligned}\n$$\n\u4e0d\u59a8\u8bbe\n$$\nS(x)=\\sum_{i=1}^{x}\\text{lcm}(n,i)\\quad T(x)=\\sum_{i=1}^{x}\\frac{i^2}{\\gcd(n,i)}\n$$\n\u5219\u6700\u7ec8\u7ed3\u679c\u4e3a\n$$\n\\sum_{i=2}^{n}\\varphi(i)\\left(S(\\lfloor\\frac{n}{i}\\rfloor)-i\\cdot T(\\lfloor\\frac{n}{i}\\rfloor)\\right)\n$$\n\n\u5148\u7ebf\u6027\u7b5b\u51fa $\\varphi(x),mp(x)$\uff08$mp$ \u4e3a\u6700\u5c0f\u7d20\u56e0\u5b50\uff09\uff0c\u5c31\u53ef\u4ee5\u7ebf\u6027\u6c42\u51fa $\\gcd(n,x),S(x),T(x)$\uff0c\u518d $O(n)$ \u6c42\u5f97\u6700\u7ec8\u7b54\u6848\u3002\n\n```cpp\n/*\n* Author: ShaoJia\n* Last Modified time: 2022-09-03 12:26:17\n* Motto: We'int be counting stars.\n*/\n#pragma GCC optimize(\"Ofast\")\n#include<bits/stdc++.h>\nusing namespace std;\n#define For(i,j,k) for(int i=(j),i##_=(k);i<=i##_;i++)\n#define Rof(i,j,k) for(int i=(j),i##_=(k);i>=i##_;i--)\n#define int long long\nconst int mod=1e9+7;\ninline int pw(int x,int y){int r=1;while(y){if(y&1)r=r*x%mod;x=x*x%mod;y>>=1;}return r;}\n#define N 100010\nint s[N],t[N],phi[N],n,g[N],mp[N],f[N],ivf[N],p[N],pt=0;\nbool vis[N];\nsigned main(){ios::sync_with_stdio(false),cin.tie(nullptr);\n\tcin>>n;\n\tf[0]=1; For(i,1,n) f[i]=f[i-1]*i%mod;\n\tivf[n]=pw(f[n],mod-2); Rof(i,n,1) ivf[i-1]=ivf[i]*i%mod;\n\tphi[1]=1;\n\tint x;\n\tFor(i,2,n){\n\t\tif(!vis[i]){\n\t\t\tp[++pt]=i;\n\t\t\tphi[i]=i-1;\n\t\t\tmp[i]=i;\n\t\t}\n\t\tFor(j,1,pt){\n\t\t\tx=p[j];\n\t\t\tif(i*x>n) break;\n\t\t\tvis[i*x]=1;\n\t\t\tmp[i*x]=x;\n\t\t\tif(i%x){\n\t\t\t\tphi[i*x]=phi[i]*(x-1);\n\t\t\t}else{\n\t\t\t\tphi[i*x]=phi[i]*x;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tg[1]=1;\n\tFor(i,2,n){\n\t\tg[i]=g[i/mp[i]];\n\t\tif(n%(g[i]*mp[i])==0) g[i]*=mp[i];\n\t}\n\tFor(i,1,n) s[i]=(s[i-1]+n/g[i]*i)%mod;\n\tFor(i,1,n) t[i]=(t[i-1]+i*i%mod*ivf[g[i]]%mod*f[g[i]-1])%mod;\n\tint ans=0;\n\tFor(i,2,n) (ans+=(s[n/i]-i%mod*t[n/i]%mod+mod)%mod*phi[i])%=mod;\n\tcout<<ans<<endl;\nreturn 0;}\n```",
        "postTime": 1662687845,
        "uid": 101868,
        "name": "I_am_Accepted",
        "ccfLevel": 0,
        "title": "CF1717E Madoka and The Best University\uff08\u6570\u8bba\uff09"
    },
    {
        "content": "# CF1717E \u9898\u89e3\n\n2022.09.08 \u66f4\u65b0\u4e86\u4e00\u5904\u7b14\u8bef\n\n## \u601d\u8def\u5206\u6790\n\n$$\n\\begin{aligned}\n\\text{Answer}\n&=\\sum_{c=1}^{n-1} \\sum_{a=1}^{n-c-1} \\operatorname{lcm}(c,\\gcd(a,n-a-c))\\\\\n&=\\sum_{c=1}^{n-1} \\sum_{a=1}^{n-c-1} \\operatorname{lcm}(c,\\gcd(a,n-c))\\\\\n&=\\sum_{c=1}^{n-1} \\sum_{d\\mid n-c}^{d\\neq n-c} \\operatorname{lcm}(c,d)\\sum_{a=1}^{n-c-1} \\left[\\gcd\\left(a,\\dfrac{n-c}d\\right)=1\\right]\\\\\n&=\\sum_{c=1}^{n-1} \\sum_{d\\mid n-c}^{d\\neq n-c} \\operatorname{lcm}(c,d)\\varphi\\left(\\dfrac {n-c}{d}\\right)\n\\end{aligned}\n$$\n\n\u76f4\u63a5\u8ba1\u7b97\uff0c\u590d\u6742\u5ea6 $\\Theta(n\\log n)$\u3002\n\n## \u4ee3\u7801\u5448\u73b0\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nconst int MAXN=1e5+1,MOD=1e9+7;\nusing namespace std;\nint phi[MAXN];\nbool tag[MAXN];\nvector <int> p,factor[MAXN];\ninline int lcm(int a,int b) { return a/__gcd(a,b)*b; }\ninline void init() {\n\tphi[1]=0;\n\tfor(int i=2;i<MAXN;++i) {\n\t\tif(!tag[i]) p.push_back(i),phi[i]=i-1;\n\t\tfor(int x:p)  {\n\t\t\tif(x*i>=MAXN) break;\n\t\t\ttag[x*i]=true;\n\t\t\tif(i%x==0) {\n\t\t\t\tphi[x*i]=x*phi[i];\n\t\t\t\tbreak;\n\t\t\t} else phi[x*i]=(x-1)*phi[i];\n\t\t}\n\t}\n\tfor(int i=1;i<MAXN;++i) {\n\t\tfor(int j=i;j<MAXN;j+=i) {\n\t\t\tfactor[j].push_back(i);\n\t\t} \n\t}\n} \nsigned main() {\n\tinit(); \n\tint n,res=0;\n\tscanf(\"%lld\",&n);\n\tfor(int i=1;i<=n-2;++i) {\n\t\tint x=n-i;\n\t\tfor(int d:factor[x]) res=(lcm(i,d)%MOD*phi[x/d]%MOD+res)%MOD;\n\t}\n\tprintf(\"%lld\\n\",res);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1662277804,
        "uid": 539618,
        "name": "DaiRuiChen007",
        "ccfLevel": 6,
        "title": "CF1717E \u9898\u89e3"
    },
    {
        "content": "\u679a\u4e3e $a + b$\uff0c\u5219 $c = n - (a + b)$\u3002\n\n$\\gcd(a, b)$ \u4e00\u5b9a\u662f $a + b$ \u7684\u56e0\u6570\uff0c\u6240\u4ee5\u63a5\u4e0b\u6765\u679a\u4e3e $a + b$ \u7684\u6bcf\u4e00\u4e2a\u56e0\u6570\uff0c\u8ba1\u7b97\u5176\u4f5c\u4e3a $\\gcd(a, b)$ \u7684\u8d21\u732e\u3002\n\n\u6613\u89c1\uff0c$d | (a + b)$ \u4f5c\u4e3a $\\gcd(a, b)$ \u5bf9\u7b54\u6848\u7684\u8d21\u732e\u6b21\u6570\uff0c\u4e3a\u6ee1\u8db3 $a^\\prime \\perp b^\\prime$ \u4e14 $a^\\prime + b^\\prime = \\frac{a + b}{d}$ \u7684\u6709\u5e8f\u6b63\u6574\u6570\u5bf9 $(a^\\prime, b^\\prime)$ \u7684\u6570\u76ee\u3002\n\n\u7531\u66f4\u76f8\u51cf\u635f\u672f\u53ef\u77e5 $\\gcd(a + b, b) = \\gcd(a, b)$\uff0c\u6545 $\\gcd\\left(\\frac{a + b}{d}, b^\\prime\\right) = \\gcd(a^\\prime + b^\\prime, b^\\prime) = \\gcd(a^\\prime, b^\\prime) = 1$\u3002\u7531\u6b64\u53ef\u77e5\uff0c\u6709\u5e8f\u6b63\u6574\u6570\u5bf9 $(a^\\prime, b^\\prime)$ \u6ee1\u8db3 $a^\\prime \\perp b^\\prime$ \u4e14 $a^\\prime + b^\\prime = \\frac{a + b}{d}$\uff0c\u5f53\u4e14\u4ec5\u5f53 $\\frac{a + b}{d} \\perp b^\\prime$ \u4e14 $a^\\prime + b^\\prime = \\frac{a + b}{d}$\u3002\n\n\u4ece\u800c\uff0c\u8fd9\u6837\u7684\u6b63\u6574\u6570\u5bf9\u6570\u76ee\uff0c\u5373\u4e3a\u5c0f\u4e8e $\\frac{a + b}{d}$ \u4e14\u4e0e\u4e4b\u4e92\u8d28\u7684\u6b63\u6574\u6570\u6570\u76ee\u3002\u6613\u89c1\u8fd9\u5c31\u662f $1$ \u5904\u53d6\u503c\u4fee\u6539\u4e3a $0$ \u7684\u6b27\u62c9\u51fd\u6570\u5728 $\\frac{a + b}{d}$ \u5904\u7684\u503c\u3002\n\n\u5b9a\u4e49\n\n$$f(n) = \\begin{cases}0 & (n=1) \\\\ \\varphi(n) & (n \\not= 1)\\end{cases}$$\n\n$f$ \u53ef\u4ee5\u7528\u7b5b\u6cd5\u9884\u5904\u7406\u51fa\u6765\u3002\n\n\u5219\u6700\u7ec8\u6211\u4eec\u6709\n\n$$\\sum_{a+b+c=n}\\operatorname{lcm}(c,\\gcd(a,b)) = \\sum_{s=2}^{n-1}\\sum_{d|s}f\\left(\\frac{s}{d}\\right)\\operatorname{lcm}(n-s,d)$$\n\n\u82e5\u7528\u679a\u4e3e\u8303\u56f4\u5185\u6bcf\u4e00\u4e2a\u56e0\u6570\u7684\u6240\u6709\u500d\u6570\u7684\u65b9\u5f0f\u9884\u5904\u7406\u51fa\u6bcf\u4e00\u4e2a\u6570\u7684\u6240\u6709\u56e0\u6570\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\log n)$\uff1b\u82e5\u76f4\u63a5 $O(\\sqrt n)$ \u679a\u4e3e\u56e0\u6570\uff0c\u5219\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\sqrt n)$\u3002\u5747\u53ef\u4ee5\u901a\u8fc7\u3002",
        "postTime": 1662256943,
        "uid": 118109,
        "name": "whhsteven",
        "ccfLevel": 7,
        "title": "CF1717E Madoka and The Best University"
    },
    {
        "content": "\u770b\u5230\u9898\u76ee\uff0c\u6709\u4e09\u4e2a\u53d8\u91cf\uff0c\u9996\u5148\u60f3\u5230\u6d88\u53c2\u3002\u7531\u8f97\u8f6c\u76f8\u51cf\u6cd5\u53ef\u77e5 $\\gcd (a,b) = \\gcd (a,a + b)$\uff0c\u53c8\u56e0\u4e3a $a + b + c = n$\uff0c\u6240\u4ee5 $a + b = n - c$\uff0c\u5373 $\\gcd (a,b) = \\gcd (a,n - c)$\u3002\n\n\u4ee4 $g = \\gcd (a,n - c)$\uff0c\u5c06\u9898\u76ee\u6240\u6c42\u8fdb\u884c\u8f6c\u5316\uff0c\u5219\u6709 $\\sum \\mathrm{lcm} (c,\\gcd (a,b)) = \\sum \\mathrm{lcm} (c,\\gcd (a,n - c))$\u3002\u679a\u4e3e $c,g$\uff0c\u4e0d\u96be\u53d1\u73b0\u7b54\u6848\u4e0e $a$ \u7684\u5927\u5c0f\u65e0\u76f4\u63a5\u8054\u7cfb\uff0c\u53ea\u4e0e\u7b26\u5408\u6761\u4ef6\u7684 $a$ \u7684\u4e2a\u6570\u6709\u5173\u3002\u7531 $\\gcd$ \u7684\u5b9a\u4e49\u53ef\u77e5\uff0c$\\gcd (\\frac{a}{g},\\frac{n - c}{g}) = 1$\uff0c\u4e5f\u5c31\u662f\u8bf4\u7b26\u5408\u6761\u4ef6\u7684 $a$  \u6ee1\u8db3 $\\frac{a}{g}\\perp\\frac{n - c}{g}$\uff0c\u4e0d\u96be\u60f3\u5230\u6b27\u62c9\u51fd\u6570 $\\varphi(x)$ \u8868\u793a\u4e0e $x$ \u4e92\u8d28\u7684\u6570\u7684\u4e2a\u6570\u3002\u4e8e\u662f\u7b54\u6848\u5c31\u53d8\u4e3a $\\sum \\limits_{g \\mid n - c}\\mathrm{lcm} (c,g) \\times \\varphi(\\frac{n - c}{g})$\uff0c\u9884\u5904\u7406\u6b27\u62c9\u51fd\u6570\u4fbf\u53ef\u89e3\u51b3\u95ee\u9898\u3002\n\n\u4f46\u662f\u5728\u7f16\u5199\u4ee3\u7801\u7684\u65f6\u5019\u8fd8\u9700\u8981\u6ce8\u610f\u4e00\u4e9b\u7ec6\u8282\uff0c$a,b,c$ \u90fd\u662f\u6b63\u6574\u6570\uff0c\u6240\u4ee5\u679a\u4e3e\u7684\u65f6\u5019 $c \\in [1,n - 2]$\uff0c\u679a\u4e3e\u56e0\u6570\u7684\u65f6\u5019\u8981\u6ee1\u8db3 $a < n - c = a + b$\uff0c\u6240\u4ee5 $a = 1$ \u7684\u65f6\u5019 $\\frac{n - c}{a}$ \u5e94\u8be5\u820d\u53bb\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cmath>\n#include <cstring>\n#define init(x) memset (x,0,sizeof (x))\n#define ll long long\n#define ull unsigned long long\n#define INF 0x3f3f3f3f\nusing namespace std;\nconst int MAX = 1e5 + 5;\nconst int MOD = 1e9 + 7;\ninline int read ();\nint n,cnt,ans,p[MAX],phi[MAX],flag[MAX];\nint gcd (int x,int y) {return (!y) ? x : gcd (y,x % y);}\nint main ()\n{\n\t//freopen (\".in\",\"r\",stdin);\n\t//freopen (\".out\",\"w\",stdout);\n\tn = read ();\n\tphi[1] = 1;\n\tfor (int i = 2;i <= n;++i)\n\t{\n\t\tif (!flag[i]) p[++cnt] = i,phi[i] = i - 1;\n\t\tfor (int j = 1;j <= cnt;++j)\n\t\t{\n\t\t\tif (i * p[j] > n) break;\n\t\t\tflag[i * p[j]] = 1;\n\t\t\tif (i % p[j] == 0) \n\t\t\t{\n\t\t\t\tphi[i * p[j]] = phi[i] * p[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tphi[i * p[j]] = phi[i] * (p[j] - 1);\n\t\t}\n\t}\n\tfor (int i = 1;i <= n - 2;++i)\n\t{\n\t\tint k = n - i;\n\t\tfor (int j = 1;j * j <= k;++j)\n\t\t{\n\t\t\tif (k % j != 0) continue;\n\t\t\tans += 1ll * i * j / gcd (i,j) * phi[k / j] % MOD;\n\t\t\tans %= MOD;\n\t\t\tif (j != 1 && k / j != j) ans += 1ll * i * k / j / gcd (i,k / j) * phi[j] % MOD,ans %= MOD;\n\t\t}\n\t}\n\tprintf (\"%d\\n\",ans);\n\treturn 0;\n}\ninline int read ()\n{\n    int s = 0;int f = 1;\n    char ch = getchar ();\n    while ((ch < '0' || ch > '9') && ch != EOF)\n\t{\n        if (ch == '-') f = -1;\n        ch = getchar ();\n    }\n    while (ch >= '0' && ch <= '9')\n\t{\n        s = s * 10 + ch - '0';\n        ch = getchar ();\n    }\n    return s * f;\n}\n\n```",
        "postTime": 1662178612,
        "uid": 183603,
        "name": "SUNCHAOYI",
        "ccfLevel": 6,
        "title": "\u3010\u9898\u89e3\u3011CF1717E Madoka and The Best University"
    },
    {
        "content": "## CF1717E - Madoka and The Best University\n### \u9898\u610f\n\u7ed9\u51fa $n(1\\leq n\\leq 10^5)$\uff0c\u6c42\uff1a\n$$\\sum_{a+b+c=n} \\text{lcm}(c,\\gcd(a,b))$$\n\n### \u601d\u8def\n\n#### \u9519\u8bef\u601d\u8def\n\u5f88\u5bb9\u6613\u60f3\u5230\u5c06\u539f\u5f0f\u5316\u6210\uff1a$\\frac{c\\cdot \\gcd(a,b)}{\\gcd(a,b,c)}$\uff0c\n\u4f46\u662f\u63a5\u4e0b\u6765\u65e0\u4ece\u4e0b\u624b\u3002\n\n#### \u6b63\u786e\u601d\u8def\n\n\u4e0d\u96be\u770b\u51fa\uff1a\n\n$$a=k_a\\cdot \\gcd(a,b)$$\n$$b=k_b\\cdot \\gcd(a,b)$$\n$$a+b=(k_a+k_b)\\cdot \\gcd(a,b)$$\n$$c=n-(a+b)$$\n$$\\gcd(k_a,k_b)=1$$\n\n\u679a\u4e3e $\\gcd(a,b)$ \u548c $(k_a+k_b)$\uff0c\u81ea\u7136\u5f97\u5230\u4e86 $a+b$ \u548c $c$\u3002\n\n\u6240\u4ee5\uff0c\u539f\u5f0f $=\\text{lcm}(c,\\gcd(a,b))\\cdot cnt$\uff0c\u5176\u4e2d\uff0c$cnt=$ \u6ee1\u8db3 $\\gcd(k_a,k_b)=1$ \u7684 $(k_a,k_b)$ \u7684\u5bf9\u6570\u3002\n\n$\\gcd(k_a,k_b)=\\gcd(k_a+k_b,k_a)=1$\n\n\u5728\u6bcf\u6b21\u679a\u4e3e $(k_a+k_b)$ \u4e4b\u540e\uff0c$cnt$ \u5c31\u76f8\u5f53\u4e8e\u6ee1\u8db3\u4e0e $(k_a+k_b)$ \u4e92\u8d28\uff0c\u5e76\u4e14\u5c0f\u4e8e $(k_a+k_b)$ \u7684 $k_a$ \u7684\u6570\u91cf\u3002\n\n\u4f7f\u7528\u6b27\u62c9\u51fd\u6570\u5373\u53ef\u6c42\u89e3\u3002\n\n> \u6c42\u6ee1\u8db3 $\\gcd(a,b)=1$ \u4e14 $a+b\\leq x$ \u7684 $(a,b)$ \u7684\u6570\u91cf\uff0c\u53ef\u4ee5\u5c06\u539f\u5f0f\u5316\u6210 $\\gcd(a+b,a)=1$\uff0c\u7136\u540e\u7528\u6b27\u62c9\u51fd\u6570\u6c42\u5408\u6cd5\u7684 $a$ \u7684\u6570\u91cf\uff0c\u8fd9\u81ea\u7136\u4e5f\u662f $(a,b)$ \u7684\u6570\u91cf\u3002",
        "postTime": 1680003015,
        "uid": 36285,
        "name": "\u6c27\u5c11Kevin",
        "ccfLevel": 4,
        "title": "CF1717E-Madoka and The Best University-\u6570\u8bba,\u6b27\u62c9\u51fd\u6570"
    },
    {
        "content": "\u9898\u610f\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u6b63\u6574\u6570 $n$\uff0c\u5bf9\u4e8e\u6240\u6709\u6ee1\u8db3 $a+b+c=n$ \u7684\u4e09\u5143\u7ec4 $(a,b,c)$\uff0c\u8981\u6c42\u8ba1\u7b97 $\\sum{\\operatorname{lcm}(c, \\gcd(a, b))}$\u3002\n\nSol\uff1a\u66b4\u529b\u679a\u4e3e $c$,\u5c06 $\\gcd(a,b)$ \u8f6c\u5316\u4e3a $\\gcd(a,a + b)$ \u5373 $\\gcd(a, n - c)$\u3002\n        \n\u6309\u7167\u5957\u8def\u5c06 $\\sum{\\operatorname{lcm}(c, \\gcd(a,n - c))}$ \u8f6c\u5316\u4e3a $\\sum{\\operatorname{lcm}(c, d)[\\gcd(a, n - c) = d]}$\u3002\n\n\u800c $\\gcd(a, n - c) = d$ \u7684\u4e2a\u6570\u5373 $\\gcd(a / d, (n - c) / d) = 1$ \u7684\u4e2a\u6570\uff0c\u5373 $\\varphi{(n-c)/d}$\u3002\n\n\u7ebf\u6027\u7b5b\u6b27\u62c9\u51fd\u6570\u6c42\u89e3\u5373\u53ef\u3002",
        "postTime": 1665643206,
        "uid": 140694,
        "name": "T_E_I_O_",
        "ccfLevel": 5,
        "title": "CF1717E Sol"
    },
    {
        "content": "\u53ef\u4ee5\u81ea\u7136\u5730\u60f3\u5230\u679a\u4e3e\u4e09\u5143\u7ec4\u4e2d\u7684\u5143\u7d20\u8fdb\u800c\u8ba1\u6570\u3002\n\n\u53d1\u73b0\u5f53 $\\gcd(a,b)$ \u4e0e $a+b$ \u7684\u503c\u5747\u5df2\u786e\u5b9a\u65f6\uff0c\u4efb\u610f\u4e00\u7ec4 $ \\operatorname{lcm}(c,\\gcd(a,b))$ \u7684\u503c\u4e5f\u662f\u786e\u5b9a\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u679a\u4e3e $\\gcd(a,b)$ \u53ca\u4f7f\u5f97 $\\gcd(a,b)\\cdot d=a+b$ \u7684 $d$ \uff08\u82e5\u679a\u4e3e $a+b$\uff0c\u5219\u786e\u5b9a $\\gcd(a,b)$ \u6240\u9700\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u96be\u4ee5\u627f\u53d7\uff09\u3002\n\n\u4e8e\u662f\u5bf9\u4e8e\u6bcf\u4e00\u7ec4 $\\gcd(a,b)$ \u548c $d$\uff0c\u6211\u4eec\u7684\u95ee\u9898\u53d8\u4e3a\uff1a\u4ee4 $d=p+q$\uff0c\u7edf\u8ba1\u6709\u591a\u5c11\u7ec4 $p$\uff0c$q$ \u4f7f\u5f97 $\\gcd(p,q)=1$ \u6210\u7acb\u3002\n\n\u8003\u8651\u518d\u5355\u72ec\u679a\u4e3e $p$ \u7684\u503c\u5e76\u5f97\u5230 $q$\uff0c\u82e5\u4e8c\u8005\u65e2\u7ea6\u5219\u7d2f\u8ba1\u8fdb\u7b54\u6848\u3002\u4f46\u662f\u8fd9\u6837\u7684\u505a\u6cd5\u65e0\u6cd5\u5728\u65f6\u9650\u5185\u7ed9\u51fa\u7b54\u6848\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\uff1a\u82e5 $d$ \u4e0e $p$ \u65e2\u7ea6\uff0c\u5219 $p$ \u4e0e $q$ \u4e00\u5b9a\u65e2\u7ea6\uff08\u56e0\u4e3a $\\gcd(p,q)=\\gcd(p,d-p)=\\gcd(d,p)=1$\uff09\uff0c\u90a3\u4e48\u9884\u5904\u7406\u5728\u4e0d\u5927\u4e8e $d$ \u7684\u6570\u4e2d\u4e0e $d$ \u65e2\u7ea6\u7684\u6570\u7684\u4e2a\u6570\uff0c\u5373 $\\varphi(d)$ \u7684\u503c\u5373\u53ef\u3002\n\n### Code\n```cpp\n#include<cstdio>\n#include<algorithm>\nconst int mod(1e9+7);\nint pr[100005];\nlong long ph[100005];\nbool vis[100005];\nint main()\n{\n\tint n,tot(0),k,l,i,j;\n\tlong long ans(0);\n\tscanf(\"%d\",&n);\n\tfor(i=2,ph[1]=1;i<=n;i++)\n\t{\n\t\tif(!vis[i])ph[pr[++tot]=i]=i-1;\n\t\tfor(j=1;j<=tot&&pr[j]*i<=n;j++)\n\t\t{\n\t\t\tvis[pr[j]*i]=true;\n\t\t\tif(i%pr[j]==0){ph[pr[j]*i]=ph[i]*pr[j];break;}\n\t\t\tph[pr[j]*i]=ph[i]*(pr[j]-1);\n\t\t}\n\t}\n\tfor(i=1;i<n;i++)\n\t  for(j=2;j*i<n;j++)\n\t\tk=n-i*j,l=k*i/std::__gcd(i,k),\n\t\t(ans+=l*ph[j])%=mod;\n\tprintf(\"%lld\",ans);\n\treturn ~~(0-0);\n}\n```\n",
        "postTime": 1662794816,
        "uid": 305073,
        "name": "SHLMZKALA",
        "ccfLevel": 0,
        "title": "CF1717E Madoka and The Best University \u9898\u89e3"
    },
    {
        "content": "[CSDN](https://blog.csdn.net/lxylluvio/article/details/126677171?spm=1001.2014.3001.5501)\n\n\u9898\u610f\uff1a\u7ed9\u5b9a $n$\uff0c\u6c42\u6240\u6709\u4e09\u5143\u7ec4 $(a,b,c)$ \u6ee1\u8db3 $a+b+c=n$ \u7684 $\\operatorname{lcm}(\\gcd(a,b),c)$ \u7684\u548c\u3002\n\n\u601d\u60f3\uff1a\n\n\u7b2c\u4e00\u5c42\u5faa\u73af\u679a\u4e3e $\\gcd(a,b)$ \u7684\u503c\u3002\n\n\u7136\u540e\u679a\u4e3e $a+b$ \u7684\u503c\u3002\n\n\u5bb9\u6613\u53d1\u73b0\uff0c$a + b$ \u7684\u503c\u4e00\u5b9a\u662f $k\\times \\gcd (a,b)$\uff0c$k\\in N^*$\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c$(a,b)$ \u7684\u53d6\u503c\u65b9\u6cd5\u4e00\u5171\u6709 $\\varphi(\\lfloor\\frac{n-c}{\\gcd(a,b)}\\rfloor)$ \u79cd\uff0c\u6240\u4ee5\u8003\u8651\u8fdb\u884c\u7c7b\u4f3c\u4e8e\u57c3\u5f0f\u7b5b\u6cd5\u7684\u7b97\u6cd5\uff0c\u6bcf\u4e00\u6b21\u66f4\u65b0\u7684\u65f6\u5019\u5c06\u7b54\u6848\u52a0\u4e0a $\\operatorname{lcm}(\\gcd(a,b),c)\\times \\varphi(\\lfloor\\frac{n-c} {\\gcd(a,b)}\\rfloor)$ \u5373\u53ef\u3002\n\n```cpp\n// \u8fd9\u56de\u53ea\u82b1\u4e8645min\u5c31\u6253\u5b8c\u4e86\u3002\n// \u771f\u597d\u3002\u8bb0\u5f97\u591a\u624b\u9020\u51e0\u7ec4\u3002\u6700\u597d\u6709\u66b4\u529b\u5bf9\u62cd\u3002\n\n#include <bits/stdc++.h>\n\n#define int long long\n\nusing namespace std;\n\nconst int N = 2e5 + 10, mod = 1e9 + 7;\nint phi[N]; // debug \u8fd9\u4e2a\u5730\u65b9\u8981\u5f00 long long\nbool not_prime[N];\nint cnt, primes[N], n, ans = 0;\n\nvoid sieve()\n{\n  phi[1] = 1;\n  for (int i = 2; i < N; i ++)\n  {\n    if (!not_prime[i])\n    {\n      primes[++ cnt] = i;\n      phi[i] = i - 1;\n    }\n    for (int j = 1; i * primes[j] < N; j ++)\n    {\n      not_prime[i * primes[j]] = true; // debug i*primes[j] --> j*primes[j]\n      if (i % primes[j])\n        phi[i * primes[j]] = phi[i] * (primes[j] - 1);\n      else\n      {\n        phi[i * primes[j]] = phi[i] * primes[j];\n        break;\n      }\n    }\n  }\n}\n\nsigned main()\n{\n  cin >> n;\n  sieve();\n  for (int i = 1; i < n; i ++)\n    for (int j = 2 * i; j < n; j += i) // debug =n \u7684\u8bdd\u6ca1\u6709\u6cd5\u5b50\u9009\u4e86\n      (ans += phi[j / i] * lcm(i, n - j) % mod) %= mod;\n  cout << ans << '\\n';\n  return 0;\n}\n\n// \u8db3\u4e0b\u5343\u91cc\uff0c\u79fb\u6b65\u6362\u666f\uff0c\u5bf0\u5b87\u7eb7\u5448\u4e07\u82b1\u7b52\n\n```",
        "postTime": 1662250649,
        "uid": 378467,
        "name": "willem248",
        "ccfLevel": 5,
        "title": "CF1717E"
    },
    {
        "content": "\u4e3a\u4ec0\u4e48\u53ea\u6709\u6211\u62ff\u7740\u4e2a\u679a\u4e3e $\\text{gcd}$ \u7684\u5957\u8def\u786c\u5f80\u8fd9\u9053\u9898\u4e0a\u5957...... \u4e0d\u8fc7\u8d5b\u65f6\u63a8\u51fa\u6765\u4e86\uff0c\u4e5f\u7b97\u662f\u4e2a\u601d\u7ef4\u590d\u6742\u5ea6\u53ef\u4ee5\u63a5\u53d7\u7684\u505a\u6cd5\u5427\uff0c\u5e76\u4e14\u679a\u4e3e $\\text{gcd}$ \u7684\u601d\u8def\u5728\u63a8\u5f0f\u5b50\u9898\u91cc\u4e5f\u6bd4\u8f83\u5e38\u89c1\u3002\n\n## Problem:\n\n\u7ed9\u5b9a$n$\uff0c\u6c42 $\\sum_{a+b+c=n} \\text{lcm}(c,\\text{gcd}(a,b))$\u3002$1 \\leq n \\leq 10^5$\u3002\n\n## Editorial:\n\n\u770b\u5230 $\\text{lcm}$ \u548c $\\text{gcd}$ \u7acb\u523b\u60f3\u5230\u679a\u4e3e $d=\\text{gcd}(a,b)$\u3002\u8bbe $p=\\frac{a}{d}, q=\\frac{b}{d}$\uff0c\u539f\u5f0f\u8f6c\u5316\u4e3a $\\sum_{d=1}^{n}\\sum_{d(p+q) <n} \\text{lcm}(n-d(p+q),d)$\uff0c\u5176\u4e2d $\\text{gcd}(p,q)=1$\u3002\uff08\u540e\u9762\u6240\u6709\u5171\u540c\u63d0\u5230 $p,q$ \u7684\u5f0f\u5b50\u91cc\u90fd\u6709 $\\text{gcd}(p,q)=1$\uff09\n\n\u8003\u8651 $\\text{lcm}(x,y)=\\frac{xy}{\\text{gcd}(x,y)}$\uff0c\u90a3\u4e48 $\\text{lcm}(n-d(p+q),d)=\\frac{nd-d^2(p+q)}{\\text{gcd}(n-d(p+q),d)}=\\frac{nd-d^2(p+q)}{\\text{gcd}(n,d)}=\\text{lcm}(n,d)-\\frac{d^2}{\\text{gcd}(n,d)}(p+q)$\u3002\n\n\u539f\u5f0f $=\\sum_{d=1}^{n}\\sum_{p+q\\leq \\lceil{\\frac{n}{d}}\\rceil-1}\\text{lcm}(n,d)-\\frac{d^2}{\\text{gcd}(n,d)}(p+q)$\u3002\u8bbe $f[n]$ \u4e3a\u4e92\u8d28\u7684\u6570 $i,j$ \u4e4b\u548c $\\leq n$ \u7684\u65b9\u6848\u6570\uff08\u5b9e\u9645\u4e0a\u5c31\u662f\u4e0a\u5f0f\u7684\u7b2c\u4e8c\u5c42\u5faa\u73af\uff09\uff0c$g[n]$ \u4e3a\u6240\u6709\u8fd9\u6837\u7684 $i+j$ \u4e4b\u548c\uff0c\u5219\u539f\u5f0f $=\\sum_{d=1}^{n} \\text{lcm}(n,d) \\cdot f[\\lceil{\\frac{n}{d}}\\rceil-1]-\\frac{d^2}{\\text{gcd}(n,d)} \\cdot g[\\lceil{\\frac{n}{d}}\\rceil-1]$\u3002\u53ea\u8981\u53ef\u4ee5\u5feb\u901f\u9884\u5904\u7406\u51fa $f,g$\uff0c\u95ee\u9898\u5c31\u89e3\u51b3\u4e86\u3002\n\n\u5bf9\u4e8e $f$\uff0c\u9996\u5148\u8003\u8651\u4ed6\u7684\u5dee\u5206\u5e8f\u5217 $f'[x]$\uff0c\u8868\u793a\u4e92\u8d28\u7684\u6570 $i,j$ \u4e4b\u548c $= x$ \u7684\u65b9\u6848\u6570\uff0c\u5373 $f'[x]=\\sum_{i=1}^{x-1}[\\text{gcd}(i,x-i)=1]=\\sum_{i=1}^{x-1}[\\text{gcd}(i,x)=1]=\\varphi(x)$\u3002\u56e0\u6b64\uff0c$f$ \u5b9e\u9645\u4e0a\u5c31\u662f $\\varphi$ \u51fd\u6570\u7684\u524d\u7f00\u548c\u3002\n\n\u7c7b\u4f3c\u5730\uff0c\u8003\u8651 $g$ \u7684\u5dee\u5206\u5e8f\u5217 $g'[x]$\uff0c\u8868\u793a\u6240\u6709\u4e92\u8d28\u7684\u6570 $i,j$ \u4e4b\u548c $= x$ \u7684 $i+j$ \u4e4b\u548c\u3002\u7136\u800c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\u7684$(i,j)$\uff0c $i+j=x$ \u554a...... \u6240\u4ee5\uff0c\u6240\u6709\u6ee1\u8db3\u6761\u4ef6\u7684 $i+j$ \u4e4b\u548c\u5b9e\u9645\u4e0a\u5c31\u662f\u4ed6\u4eec\u7684\u65b9\u6848\u6570\u4e58\u4e0a $x$\uff0c$g'[x]=f'[x]\\cdot x$\uff0c$g$ \u4e5f\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u6765\u4e86\u3002\n\n## Code:\n\n\u5b9e\u9645\u7684\u4ee3\u7801\u5341\u5206\u7b80\u5355\uff0c\u7b5b\u51fa\u6765 $\\varphi$ \u51fd\u6570\u540e\u6309\u5f0f\u5b50\u7b97\u5c31\u597d\u4e86\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll mod=1e9+7;\n\nint n;\n\nint primes[100005],pcnt;\n\nbool Composite[100005];\n\nll phi[100005],phis[100005];\n\nll f[100005],g[100005];\n\nvoid Sieve() {\n\tComposite[1]=1;\n\tfor(int i=2;i<=n;i++) {\n\t\tif(!Composite[i]) {\n\t\t\tprimes[++pcnt]=i;\n\t\t\tphi[i]=i-1;\n\t\t}\n\t\tfor(int j=1;j<=pcnt && i*primes[j]<=n;j++) {\n\t\t\tComposite[i*primes[j]]=1;\n\t\t\tif(i%primes[j]==0) {\n\t\t\t\tphi[i*primes[j]]=phi[i]*primes[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tphi[i*primes[j]]=phi[i]*phi[primes[j]];\n\t\t}\n\t}\n}\n\nll gcd(ll a,ll b) {\n\tif(b==0) {\n\t\treturn a;\n\t}\n\treturn gcd(b,a%b);\n}\n\nll lcm(ll a,ll b) {\n\treturn a/gcd(a,b)*b;\n}\n\nll ans=0;\n\nint main() {\n\tscanf(\"%d\",&n);\n\tSieve();\n\tfor(int i=1;i<=n;i++) {\n\t\tphis[i]=phi[i]*i;\n\t\tf[i]=(f[i-1]+phi[i])%mod;\n\t\tg[i]=(g[i-1]+phis[i])%mod;\n\t}\n\tfor(ll i=1;i<=n;i++) {\n\t\tans+=lcm(i,n)%mod*f[(n+i-1)/i-1]%mod;\n\t\tans-=(i*i/gcd(n,i))%mod*g[(n+i-1)/i-1]%mod;\n\t\tans=(ans%mod+mod)%mod;\n\t}\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```\n\n\n\n\u9898\u5916\u8bdd\uff1a\u8d5b\u65f6\u8fc7\u9898\u987a\u5e8fABECD... \u679c\u7136\u8fd8\u662f\u505a\u4e0d\u6765\u601d\u7ef4\u9898\u5462\u3002\n\n",
        "postTime": 1662178981,
        "uid": 289547,
        "name": "bruhify",
        "ccfLevel": 7,
        "title": "CF1717E Madoka and The Best University"
    },
    {
        "content": "Upd 2020/9/5 18:18 \u4fee\u6539 $\\phi$ \u4e3a $\\varphi$\uff0c\u6dfb\u52a0\u4e3a\u4f55\u7406\u8bba\u66f4\u5feb\u5b9e\u9645\u66f4\u6162\u7684\u53d9\u8ff0\n\n**0. \u524d\u8a00**  \n\u8d5b\u540e\u5341\u79d2\u949fAC\u6b64\u9898...  \n\uff08\u636e\u8bf4\u662f\u56e0\u4e3aSystem test\u7ed3\u675f\u4e86\u624d\u80fd\u7ee7\u7eed\u63d0\u4ea4\uff0c\u6240\u4ee5\u8bc4\u6d4b\u8bb0\u5f55\u662f\u4eca\u5929\u65e9\u4e0a\u7684\uff0c\u4ee3\u7801\u662f\u8d5b\u540e\u5341\u79d2\u949f\u5199\u5b8c\u7684...\uff09  \n\u672c\u6b21\u7bc7\u5e45\u8f83\u957f\u800c\u4e14\u6211\u81ea\u5df1\u8bfb\u7740\u90fd\u529d\u9000\uff0c\u5c31\u628a\u4e00\u4e9b\u8bc1\u660e\u548c\u53d9\u8ff0\u90e8\u5206\u5206\u5f00\u6765\uff0c\u8bc1\u660e\u4e00\u822c\u662f\u8bc1\u660e\u4e0a\u9762\u79bb\u5f97\u6700\u8fd1\u7684\u4e00\u4e2a\u7ed3\u8bba\uff0c\u5982\u679c\u8fd9\u4e2a\u7ed3\u8bba\u81ea\u5df1\u4f1a\u8bc1\u53ef\u4ee5\u76f4\u63a5\u8df3\u8fc7\u3002  \n\u9644\u52a0\u7684\u4e00\u4e9b\u89e3\u91ca\u8bf4\u660e\u4e5f\u4f1a\u5206\u79bb\u51fa\u6765\u3002  \n\u5148\u8bf4\u4e00\u4e0b\uff0c $x\\in\\mathbb{Z}$ \u7b49\u4ef7\u4e8e $x$ \u662f\u6574\u6570\u3002\n\n**1. \u5206\u6790**  \n\u9996\u5148\u6211\u4eec\u90fd\u77e5\u9053 $O(n^2\\log n)$ \u66b4\u529b\u975e\u5e38\u597d\u5199\uff0c\u679a\u4e3e $c$\uff0c\u679a\u4e3e $b$\uff0c\u8ba1\u7b97 $a$\uff0c\u7136\u540e\u4ee3\u5165\u6c42\u503c\u52a0\u548c\u5373\u53ef\u3002  \n\u6211\u4eec\u73b0\u5728\u9700\u8981\u7684\u53ea\u662f\u628a\u5f53 $c$ \u56fa\u5b9a\u7684\u65f6\u5019\u7b97\u51fa\u6bcf\u4e00\u4e2a\u603b\u548c\u5373\u53ef\u3002  \n\u5982\u679c $c$ \u56fa\u5b9a\u4e86\uff0c\u90a3\u4e48\u56e0\u4e3a $a+b+c=n$\uff0c\u6240\u4ee5 $a+b$ \u4e5f\u56fa\u5b9a\u4e86\u3002\u4e3a\u4e86\u65b9\u4fbf\u8bb0\u4e3a $s$\u3002\u518d\u628a $\\gcd(a,b)$ \u8bb0\u4e3a $d$\u3002  \n\u5982\u679c\u6211\u4eec\u76f4\u63a5\u8ba1\u7b97\uff0c\u96be\u5ea6\u4f1a\u6bd4\u8f83\u5927\uff0c\u800c\u4e14\u4e5f\u65e0\u6cd5\u6c47\u603b\u5230\u5f0f\u5b50 $\\operatorname{lcm}(c, d)$ \u91cc\u3002  \n\u90a3\u4e48\u4ec0\u4e48\u6837\u7684 $\\operatorname{lcm}(c, d)$ \u53ef\u4ee5\u5408\u5e76\u8ba1\u7b97\u5462\uff1f  \n\u6b64\u65f6 $c$ \u662f\u56fa\u5b9a\u7684\uff0c\u6240\u4ee5\u7b54\u6848\u662f\uff1a$d$ \u76f8\u540c\u7684\u51e0\u4e2a\u5f0f\u5b50\u3002  \n\u4e0d\u90a3\u4e48\u663e\u7136\u4f46\u662f\u53ef\u5f97 $d$ \u662f $s$ \u7684\u56e0\u6570\u3002\n>\u6211\u4eec\u5047\u8bbe $a=dx$\uff0c$b=dy$\uff0c\u90a3\u4e48\u53ef\u5f97 $s=d(x+y)$\uff0c\u663e\u7136 $x+y$ \u662f\u6574\u6570\uff0c\u90a3\u4e48\u53ef\u5f97 $d$ \u662f $s$ \u7684\u56e0\u6570\u3002  \n\u90a3\u5c31\u662f\u679a\u4e3e $d\\le \\sqrt s$\uff0c\u7136\u540e\u53ef\u5f97 $d$ \u548c $s\\div d$ \u5206\u522b\u662f\u4e24\u4e2a $s$ \u7684\u56e0\u6570\u3002  \n\n**\u6ce8\u610f\uff1a\u53ef\u80fd\u4f1a\u5b58\u5728 $s=d^2$ \u7684\u60c5\u51b5\uff0c\u4e0d\u8981\u91cd\u590d\u8ba1\u7b97**  \n\u5bf9\u4e8e\u4e00\u4e2a $d$ \u6211\u4eec\u73b0\u5728\u53ea\u9700\u8981\u5728 $c$ \u56fa\u5b9a\u7684\u60c5\u51b5\u4e0b\u7b97\u4e24\u4e2a\u4e1c\u897f\uff1a $\\operatorname{lcm}(c,d)$ \u548c\u6ee1\u8db3 $x+y=s\\div d$ \u5e76\u4e14 $\\gcd(x, y)=1$ \u7684\u5bf9\u6570\u3002  \n\u663e\u7136\uff0c\u5982\u679c\u4e00\u5bf9\u6570 $x,y$ \u6ee1\u8db3\u4e0a\u9762\u7684\u4e24\u4e2a\u6761\u4ef6\uff0c\u90a3\u4e48 $dx+dy+c=n$\u3002\u7b2c\u4e8c\u4e2a\u6761\u4ef6\u7684\u5b58\u5728\u610f\u4e49\u5728\u4e8e\u53ef\u4ee5\u53bb\u9664 $\\gcd(a,b)$ \u662f $d$ \u7684\u500d\u6570\u7684\u60c5\u51b5\u3002\u5426\u5219\u4f1a\u51fa\u73b0\u5728\u679a\u4e3e\u5230 $d=1$ \u7684\u65f6\u5019\u8ba1\u7b97\u6240\u6709 $d=2,d=3\\dots$ \u7684\u60c5\u51b5\uff0c\u800c\u4e14\u8ba1\u7b97\u7ed3\u679c\u662f\u9519\u8bef\u7684\u3002  \n\n\u8fd9\u4e2a\u6709\u5e8f\u6570\u5bf9\u4e2a\u6570\u5360\u7528\u4e86\u6211\u534a\u5c0f\u65f6\uff0c\u8fd8\u662f\u5728\u5927\u795e\u540c\u5b66\u7684\u70b9\u62e8\u4e0b\u624d\u4f1a\u7684...  \n\u5148\u4e0a\u7ed3\u8bba\uff1a$x+y=s\\div d$ \u7684\u5bf9\u6570\u7b49\u4e8e $\\varphi(s/d)$  \n>\u5176\u4e2d $\\varphi(x)$ \u8868\u793a\u6ee1\u8db3 $1\\le y\\le x$\uff0c$y\\in\\mathbb{Z}$\uff0c$\\gcd(x,y)=1$ \u7684 $y$ \u7684\u4e2a\u6570\u3002\u5373 $x$ \u4ee5\u5185\u4e0e $x$ \u4e92\u8d28\u7684\u6b63\u6574\u6570\u4e2a\u6570\u3002  \n\n\u5982\u4f55\u8ba1\u7b97 $\\varphi$ \u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\uff0c\u7ebf\u6027\u7b5b\u6216\u8005\u9010\u4e2a\u8ba1\u7b97\u90fd\u53ef\u4ee5  \n\u8865\u5145\u4e00\u4e0b\u5bf9\u6570\u7b49\u4e8e $\\varphi$ \u7684\u8bc1\u660e\u3002  \n>\u5bf9\u4e8e\u4e00\u4e2a\u6570 $1\\le x\\le n$\uff0c$x\\in\\mathbb{Z}$\uff0c\u5982\u679c $\\gcd(x,n)=1$\uff0c\u90a3\u4e48 $\\gcd(x,n-x)=1$\u3002\u5373 $y=n-x$\u3002\n>> \u5982\u679c $\\gcd(x,n)=d$\uff0c\u90a3\u4e48\u8bbe $x=x_0d$\uff0c$n=n_0d$\uff0c$\\gcd(x,n-x)=\\gcd(x_0d,(n_0-x_0)d)=d$\u3002  \n\n>$(x,y)$ \u6ee1\u8db3 $\\gcd(x,y)=1,x+y=n$ \u5bf9\u5e94\u5230 $\\gcd(x,n)=1$ \u4e5f\u662f\u5bf9\u7684\uff0c\u8bc1\u660e\u540c\u7406\u8bbe $d$\uff0c\u4e0d\u4f5c\u8d58\u8ff0\u3002  \n\n\u90a3\u4e48\u6211\u4eec\u5c31\u6709\u4e00\u4e2a\u5f88\u5f00\u5fc3\u7684\u7ed3\u8bba\uff1a\u5bf9\u4e8e\u6240\u6709 $c=c_0,d=d_0$ \u7684\u60c5\u51b5\uff0c\u6ee1\u8db3\u8fd9\u4e00\u90e8\u5206\u7684\u603b\u548c\u662f $\\operatorname{lcm}(c_0,d_0)\\times\\varphi((n-c_0)\\div d)$\u3002\u56e0\u4e3a\u6bcf\u4e00\u79cd\u60c5\u51b5\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u90fd\u662f $\\operatorname{lcm}(c_0,d_0)$\uff0c\u800c $\\varphi$ \u51fd\u6570\u6c42\u51fa\u7684\u5bf9\u6570\u5c31\u662f\u53ef\u80fd\u7684\u60c5\u51b5\u6570\u3002  \n\n\u90a3\u5c31\u5bf9\u4e8e\u6240\u6709\u60c5\u51b5\u6c42\u4e2a\u548c\u5c31\u884c\u4e86\u3002  \n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a  \n\u9884\u5904\u7406\u6b27\u62c9\u51fd\u6570 $O(n)$  \n\u679a\u4e3e $c_0$ $O(n)$  \n\u679a\u4e3e $d_0$ $O(\\sqrt n)$  \n\u8ba1\u7b97 $\\operatorname{lcm}$ $O(\\log n)$  \n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n+n\\sqrt n\\log n)$   \n\u5f53 $n=10^5$ \u65f6\uff0c\u8fd9\u4e2a\u6570\u662f $525342950.157$\uff0c\u4e5f\u5c31\u662f $5e8$ \u662f\u53ef\u4ee5\u5361\u8fc7\u53bb\u7684\uff08\u4e8b\u5b9e\u8bc1\u660e\u53ea\u8dd1\u4e86\u4e0d\u5230 200ms\uff09\n\u5f53\u7136\u8fd8\u6709\u7406\u8bba\u66f4\u5feb\u7684\u5199\u6cd5\uff0c\u5206\u89e3\u8d28\u56e0\u6570\u7136\u540e\u76f4\u63a5\u904d\u5386\u6bcf\u4e00\u4e2a\u56e0\u6570\uff0c\u4f46\u662f\u95ee\u9898\u5c31\u5728\u4e8e\uff0c\u5728CF\u4e0a\u8fd9\u79cd\u505a\u6cd5\u4e0d\u5f00O2\u8dd1\u4e86811ms \u5f00\u4e86O2\u8dd1\u4e86826ms ~~\uff0c\u4ee4\u6211\u65e0\u6cd5\u7406\u89e3\uff0c\u5927\u795e\u53ef\u4ee5\u5728\u8bc4\u8bba\u533a\u89e3\u7b54\u4e00\u4e0b\u4e3a\u5565\u7406\u8bba\u66f4\u5feb\u7684\u505a\u6cd5\u66f4\u6162~~\u3002\u73b0\u5728\u6211\u61c2\u4e86\uff0c\u662f\u56e0\u4e3a\n>\u4ee3\u7801\u91cc\u5206\u89e3\u8d28\u56e0\u6570\u90a3\u90e8\u5206\u6bcf\u4e2a\u6570\u5206\u89e3\u90fd\u8981\u904d\u5386\u6240\u6709\u8d28\u6570\u9020\u6210\u7684\u65f6\u95f4\u6d6a\u8d39\n\n\u7684\u7f18\u6545\u3002\u7406\u8bba\u4e0a\u53ef\u4ee5\u52a0\u4e0a `p[i] * p[i] <= x` \u7684\u5faa\u73af\u6761\u4ef6\uff0c\u8df3\u51fa\u5927\u5faa\u73af\u4e4b\u540e\u5c06 $n$ \u7684\u5269\u4f59\u503c\uff08\u5982\u679c\u4e0d\u4e3a 1 \uff09 \u4f5c\u4e3a\u6700\u540e\u7684\u4e00\u4e2a\u8d28\u6570\u901a\u8fc7\u6620\u5c04\u627e\u5230\u4e0b\u6807\u5e76\u5c06\u5e95\u6570\u4e0b\u6807\u548c\u6307\u6570\uff08\u6b64\u5904\u4e3a $1$\uff09\u5199\u5230 `pairvec` \u91cc\u9762\u3002\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<vector>\n#define maxn 100005\n#define mod 1000000007\n\nusing namespace std;\n\nlong long lcm(long long a, long long b) {\n\treturn a / __gcd(a, b) % mod * b % mod;\n}\n\nstruct pairvec {\n\tvector<int> p, q;//\u5e95\u6570\u548c\u6307\u6570 \n};\n\nlong long n, ans, p[maxn], pn, phi[maxn];\nbool up[maxn];\n\npairvec func1(int x) {//\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u53ef\u4ee5\u7528\u5230\u7b5b\u6b27\u62c9\u51fd\u6570\u7684\u526f\u4ea7\u7269\u8d28\u6570\u8868 \n\tpairvec res;\n\tint i = 0;\n\twhile(x > 1 && i < pn) {\n\t\tint cnt = 0;\n\t\twhile(i < pn && x % p[i] != 0) i++;//\u627e\u5230\u4e0b\u4e00\u4e2an\u7684\u8d28\u56e0\u6570\n\t\twhile(i < pn && x % p[i] == 0) cnt++, x /= p[i];\n\t\tres.p.push_back(i);\n\t\tres.q.push_back(cnt);\n\t}\n\treturn res;\n}\n\nvector<int> func2(pairvec f, vector<int> g) {\n\tvector<int> res;\n\tint cnt = 0;\n\tint xum = 1;//\u5f53\u524d\u7684\u56e0\u6570\n\twhile(cnt != 1) {\n\t\tres.push_back(xum);\n\t\tfor(int i = 0; i < g.size(); i++) {\n\t\t\tif(g[i] == f.q[i]) {\n\t\t\t\tg[i] = 0;\n\t\t\t\tfor(int j = 0; j < f.q[i]; j++) xum /= p[f.p[i]];\n\t\t\t\tif(i == g.size() - 1) cnt = 1;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tg[i]++;\n\t\t\t\txum *= p[f.p[i]];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn res;\n}\n\nint main() {\n\tcin >> n;\n\tfor(int i = 2; i <= n; i++) {\n\t\tif(!up[i]) {\n\t\t\tp[pn++] = i;\n\t\t\tphi[i] = i - 1;\n\t\t}\n\t\tfor(int j = 0; j < pn && i * p[j] <= n; j++) {\n\t\t\tup[i * p[j]] = 1;\n\t\t\tif(i % p[j] == 0) {\n\t\t\t\tphi[i * p[j]] = phi[i] * p[j] % mod;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tphi[i * p[j]] = phi[i] * (p[j] - 1) % mod;\n\t\t}\n\t}\n\tfor(int c = 1; c <= n - 2; c++) {\n\t\tint s = n - c;\n\t\t//\u76f4\u63a5\u679a\u4e3e\u56e0\u6570\u5199\u6cd5 \n\t\tpairvec v = func1(s);//\u5206\u89e3\u8d28\u56e0\u6570 \n\t\tvector<int> g;\n\t\tfor(int i = 0; i < v.p.size(); i++) g.push_back(0);//\u653e\u5165\u8db3\u591f\u591a\u76840\u51d1\u4f4d\u6570 ;\n\t\tg = func2(v, g);\n\t\tfor(int i = 0; i < g.size(); i++) {\n\t\t\tif(s / g[i] > 1) {\n\t\t\t\tans += phi[s / g[i]] * lcm(c, g[i]) % mod;//\u57fa\u7840\u8ba1\u7b97\u65b9\u5f0f\u7c7b\u4f3c\n\t\t\t\tans %= mod;\n\t\t\t}\n\t\t}\n\t\t//*/\n\t\t/* //Osqrt(n)\u679a\u4e3e\u5199\u6cd5 \n\t\tfor(int d = 1; d * d <= s; d++) {\n\t\t\tif(s % d == 0) {\n\t\t\t\tif(s / d > 1) {\n\t\t\t\t\tans += (phi[s / d]) * lcm(c, d) % mod;\n\t\t\t\t\tans %= mod;\n\t\t\t\t}\n\t\t\t\tif(d * d != s && d > 1) {\n\t\t\t\t\tans += (phi[d]) * lcm(c, s / d) % mod;\n\t\t\t\t\tans %= mod;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//*/\n\t} \n\tcout << ans << endl;\n}\n```",
        "postTime": 1662163382,
        "uid": 302805,
        "name": "fp_loves_kmn",
        "ccfLevel": 6,
        "title": "CF1717E \u9898\u89e3"
    }
]
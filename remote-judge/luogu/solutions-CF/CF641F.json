[
    {
        "content": "[CF641F Little Artem and 2-SAT](https://www.luogu.com.cn/problem/CF641F)\u89e3\u9898\u62a5\u544a\uff1a\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://zybuluo.com/xiaoziyao/note/1812889)\n\n## \u9898\u610f\n\n\u7ed9\u5b9a\u4e24\u4e2a $n$ \u4e2a\u70b9\u7684 2-SAT \u6a21\u578b\uff08\u5404 $m1,m2$ \u6761\u9650\u5236\uff0c\u578b\u4e3a $\\wedge_{i=1}^m (a_i\\vee b_i)$ \uff09\uff0c\u5224\u65ad\u8fd9\u4e24\u4e2a\u6a21\u578b\u7684\u89e3\u96c6\u662f\u5426\u76f8\u540c\uff0c\u5982\u679c\u4e0d\u540c\uff0c\u6784\u9020\u4e00\u7ec4\u89e3\u4f7f\u5f97\u4e00\u4e2a\u6709\u89e3\u4e00\u4e2a\u65e0\u89e3\u3002\uff08$1\\leqslant n\\leqslant 1000,1\\leqslant m\\leqslant n^2$\uff09\n\n## \u5206\u6790\n\n\u61a8\u61a8\u9898+\u7ecf\u5178\u9898\u3002\n\n\u8fd9\u9053\u9898\u544a\u8bc9\u6211\u4eec\uff0c2-SAT \u4e0d\u4e00\u5b9a\u4e00\u5b9a\u8981\u7528 tarjan \u548c kosaraju\uff0c\u6709\u65f6\u5019 Floyd \u4e5f\u53ef\u4ee5\u5728 2-SAT \u4e2d\u6709\u6240\u5e94\u7528\u3002\n\n\u4e8b\u5b9e\u4e0a\uff0c\u6211\u4eec\u7528 Floyd \u8dd1\u4e00\u904d\u4f20\u9012\u95ed\u5305\uff0c\u7136\u540e\u518d dfs \u4e00\u904d\u5c31\u53ef\u4ee5\u89e3\u51fa 2-SAT \u4e86\u3002\n\n\u9996\u5148\u5efa\u51fa\u6765\u4e24\u4e2a 2-SAT \u6a21\u578b\uff0c\u8dd1\u4e00\u904d\uff0c\u5982\u679c\u4e24\u4e2a\u90fd\u65e0\u89e3\u5c31\u76f8\u4f3c\uff0c\u5982\u679c\u4e00\u4e2a\u6709\u89e3\u4e00\u4e2a\u65e0\u89e3\u5c31\u6784\u9020\u4e00\u7ec4\u4f7f\u67d0\u4e2a\u6a21\u578b\u6709\u89e3\u3002\n\n\u5426\u5219\u6709\u4e00\u4e9b\u53d8\u91cf\u7684\u53d6\u503c\u662f\u56fa\u5b9a\u7684\uff0c\u5224\u4e00\u4e0b\u662f\u5426\u6709\u56fa\u5b9a\u53d8\u91cf\u53d6\u503c\u4e0d\u540c\uff0c\u6216\u662f\u6709\u4e00\u4e2a\u53d8\u91cf\u5728\u4e00\u4e2a\u6a21\u578b\u786e\u5b9a\uff0c\u4e00\u4e2a\u4e0d\u786e\u5b9a\uff0c\u5f88\u5bb9\u6613\u6784\u9020\u51fa\u89e3\u3002\n\n\u6b64\u65f6\u4e24\u4e2a\u6a21\u578b\u7684\u786e\u5b9a\u53d8\u91cf\u5df2\u7ecf\u662f\u76f8\u540c\u7684\u4e86\uff0c\u6211\u4eec\u6bd4\u8f83\u4f20\u9012\u95ed\u5305\u7684\u90bb\u63a5\u77e9\u9635\u662f\u5426\u76f8\u540c\uff0c\u53ea\u8981\u6709\u4e00\u4e2a\u4e0d\u540c\u7684\u5730\u65b9\uff08\u8bbe\u5176\u4e3a $x\\rightarrow y$\uff09\u4e14 $x,y$ \u5728\u53e6\u4e00\u4e2a\u6a21\u578b\u5185\u5747\u6ca1\u6709\u786e\u5b9a\u53d6\u503c\uff0c\u5c31\u53ef\u4ee5\u94a6\u5b9a $x=1,y=0$\uff0c\u7136\u540e\u8dd1\u4e00\u7ec4\u89e3\u5c31\u597d\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(\\frac{n^3}{\\omega}+m)$\u3002\n\n## \u4ee3\u7801\n\n2-SAT\u522b\u5199\u9519\uff0c\u6211\u5199\u9519\u4e86\u8c03\u4e86\u4e00\u4e2a\u4e16\u7eaa /ll \u3002\n\n```\n#include<stdio.h>\n#include<bitset>\n#define rev(x) (x>n? (x-n):(x+n))\nusing namespace std;\nconst int maxn=1005;\nint n;\nstruct two_sat{\n\tint m,ok;\n\tint fixed[maxn<<1];\n\tbitset<maxn<<1>g[maxn<<1];\n\tvoid get(int x){\n\t\tfixed[x]=1,fixed[rev(x)]=0;\n\t\tfor(int i=1;i<=2*n;i++)\n\t\t\tif(g[x][i]&&fixed[i]==-1)\n\t\t\t\tget(i);\n\t}\n\tvoid build(){\n\t\tfor(int i=1;i<=2*n;i++)\n\t\t\tg[i].reset(),g[i][i]=1,fixed[i]=-1;\n\t\tfor(int i=1;i<=m;i++){\n\t\t\tint x,y;\n\t\t\tscanf(\"%d%d\",&x,&y),x=x>0? x:rev(-x),y=y>0? y:rev(-y);\n\t\t\tg[rev(x)][y]=1,g[rev(y)][x]=1;\n\t\t}\n\t\tfor(int k=1;k<=2*n;k++)\n\t\t\tfor(int i=1;i<=2*n;i++)\n\t\t\t\tif(g[i][k])\n\t\t\t\t\tg[i]|=g[k];\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tif(g[i][n+i]&&g[n+i][i]){\n\t\t\t\tok=0;\n\t\t\t\treturn ;\n\t\t\t}\n\t\tok=1;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tif(fixed[i]==-1&&fixed[n+i]==-1&&g[i][n+i])\n\t\t\t\tget(n+i);\n\t\t\tif(fixed[i]==-1&&fixed[n+i]==-1&&g[n+i][i])\n\t\t\t\tget(i);\n\t\t}\n\t}\n\tvoid solve(){\n\t\tfor(int i=1;i<=2*n;i++)\n\t\t\tif(fixed[i]==-1)\n\t\t\t\tget(i);\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tprintf(\"%d%c\",fixed[i],i==n? '\\n':' ');\n\t}\n}A,B;\nint main(){\n\tscanf(\"%d%d%d\",&n,&A.m,&B.m),A.build(),B.build();\n\tif(A.ok==0&&B.ok==0){\n\t\tputs(\"SIMILAR\");\n\t\treturn 0;\n\t}\n\tif(A.ok==0||B.ok==0){\n\t\tif(A.ok)\n\t\t\tA.solve();\n\t\tif(B.ok)\n\t\t\tB.solve();\n\t\treturn 0;\n\t}\n\tfor(int i=1;i<=2*n;i++){\n\t\tif(A.fixed[i]!=-1&&B.fixed[i]!=-1&&A.fixed[i]!=B.fixed[i]){\n\t\t\tA.solve();\n\t\t\treturn 0;\n\t\t}\n\t\tif((A.fixed[i]==-1)+(B.fixed[i]==-1)==1){\n\t\t\tif(A.fixed[i]==-1)\n\t\t\t\tA.get(B.fixed[i]==0? i:rev(i)),A.solve();\n\t\t\tif(B.fixed[i]==-1)\n\t\t\t\tB.get(A.fixed[i]==0? i:rev(i)),B.solve();\n\t\t\treturn 0;\n\t\t}\n\t}\n\tfor(int i=1;i<=2*n;i++)\n\t\tfor(int j=1;j<=2*n;j++){\n\t\t\tif(A.g[i][j]&&B.g[i][j]==0&&B.fixed[i]==-1&&B.fixed[i]==-1){\n\t\t\t\tB.get(i),B.get(rev(j)),B.solve();\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif(B.g[i][j]&&A.g[i][j]==0&&A.fixed[i]==-1&&A.fixed[j]==-1){\n\t\t\t\tA.get(i),A.get(rev(j)),A.solve();\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\tputs(\"SIMILAR\");\n\treturn 0;\n}\n```",
        "postTime": 1627872896,
        "uid": 35754,
        "name": "Verdandi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF641F\u3010Little Artem and 2-SAT\u3011"
    }
]
[
    {
        "content": "\u9898\u610f\uff1a\u6709\u4e09\u4e2a\u5019\u9009\u4eba\u548c $n$ \u4e2a\u9009\u6c11\uff0c\u6bcf\u4e2a\u9009\u6c11\u6709\u4e00\u4e2a\u5bf9\u4e09\u4e2a\u5019\u9009\u4eba\u7684\u652f\u6301\u5ea6\u6392\u5e8f\u3002\u5019\u9009\u4eba\u4e24\u4e24\u4e4b\u95f4\u8fdb\u884c\u4e09\u6b21\u6bd4\u8d5b\uff0c\u6bcf\u6b21\u6bd4\u8d5b\u7684\u7ed3\u679c\u7531\u5982\u4e0b\u65b9\u6cd5\u786e\u5b9a\uff1a\u7ed9\u5b9a\u4e00\u4e2a $2^n$ \u7684\u96f6\u4e00\u6570\u7ec4 $f$\uff0c\u6784\u9020\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6570 $x$\uff0c\u5bf9\u4e8e\u7b2c $i$ \u4f4d\uff0c\u5982\u679c\u7b2c $i$ \u4e2a\u9009\u6c11\u6bd4\u8d77\u7b2c\u4e8c\u4e2a\u4eba\u66f4\u652f\u6301\u7b2c\u4e00\u4e2a\u4eba\uff0c\u5219\u8fd9\u4e00\u4f4d\u4e3a\u4e00\uff0c\u5426\u5219\u4e3a\u96f6\u3002$f_x=1$ \u5219\u4ee3\u8868\u7b2c\u4e00\u4e2a\u4eba\u8d62\u4e86\uff0c\u5426\u5219\u7b2c\u4e8c\u4e2a\u4eba\u8d62\u3002\u95ee\u6709\u591a\u5c11\u79cd\u65b9\u6848\u4f7f\u5f97\u67d0\u4e2a\u5019\u9009\u4eba\u8d62\u4e86\u4e24\u573a\u3002\n\n\u6211\u4eec\u8003\u8651\u5019\u9009\u4eba A \u5728\u4ec0\u4e48\u60c5\u51b5\u4e0b\u80fd\u8d62\u4e24\u573a\u3002\u8003\u8651\u4ed6\u5bf9\u9635 B \u548c C \u65f6\u7684\u4e24\u4e2a\u96f6\u4e00\u5e8f\u5217\uff0c\u4f7f\u5f97\u4ed6\u8d62\u4e86\u4e24\u573a\u3002\u5bf9\u4e8e\u67d0\u4e00\u4f4d\uff0c\u5982\u679c\u8fd9\u4e00\u4f4d\u4e0d\u540c\uff0c\u5219\u8fd9\u4e2a\u9009\u6c11\u7684\u652f\u6301\u5ea6\u6392\u5e8f\u5df2\u7ecf\u53ef\u4ee5\u786e\u5b9a\uff0c\u5426\u5219\u6709\u4e24\u79cd\u6392\u5e8f\u53ef\u4ee5\u9020\u6210\u8fd9\u4e2a\u7ed3\u679c\u3002\u4e8e\u662f\u53ea\u9700\u8981\u77e5\u9053\u8fd9\u4e24\u4e2a\u5e8f\u5217\u7684\u5f02\u6216\u503c\uff0c\u5c31\u53ef\u4ee5\u5f97\u51fa\u8fd9\u4e24\u4e2a\u5e8f\u5217\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u3002\u6211\u4eec\u8003\u8651\u5bf9\u6bcf\u4e2a $x$ \u8ba1\u7b97\u51fa\u6709\u591a\u5c11\u79cd\u96f6\u4e00\u5e8f\u5217\u80fd\u8ba9 A \u8d62\u4e24\u6b21\u5e76\u4e14\u5f02\u6216\u540e\u53ef\u4ee5\u5f97\u5230 $x$\uff0c\u53d1\u73b0\u8fd9\u5c31\u662f $f$ \u4e0e\u81ea\u5df1\u7684\u5f02\u6216\u5377\u79ef\uff0c\u4f7f\u7528 FWT \u5b9e\u73b0\u5373\u53ef\u3002\n\n\u6700\u540e\u8981\u628a\u7b54\u6848\u4e58\u4ee5\u4e09\u3002\u590d\u6742\u5ea6 $n2^n$\u3002\n```cpp\n#include<cctype>\n#include<cstdio>\nusing namespace std;\ninline int readint(){\n\tint x=0;\n\tbool f=0;\n\tchar c=getchar();\n\twhile(!isdigit(c)&&c!='-') c=getchar();\n\tif(c=='-'){\n\t\tf=1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c)){\n\t\tx=x*10+c-'0';\n\t\tc=getchar();\n\t}\n\treturn f?-x:x;\n}\nconst int maxn=20+5;\nint n;\nchar s[(1<<maxn)+5];\ntypedef long long ll;\nll f[(1<<maxn)+5];\nconst ll mod=1e9+7,inv2=500000004;\nvoid FWT(ll* f,int n,bool flag){\n\tfor(int i=1;i<n;i*=2) for(int j=0;j<n;j+=i*2)\n\t\tfor(int k=j;k<j+i;k++){\n\t\t\tll t=f[k+i];\n\t\t\tf[k+i]=(f[k]+mod-t)%mod*(flag?1:inv2)%mod;\n\t\t\tf[k]=(f[k]+t)%mod*(flag?1:inv2)%mod;\n\t\t}\n}\nll ksm(ll a,ll b){\n\tll ans=1;\n\twhile(b>0){\n\t\tif(b%2==1) ans=ans*a%mod;\n\t\ta=a*a%mod;\n\t\tb/=2;\n\t}\n\treturn ans;\n}\nint cnt[(1<<maxn)+5];\nint main(){\n\t#ifdef LOCAL\n\tfreopen(\"in.txt\",\"r\",stdin);\n\tfreopen(\"out.txt\",\"w\",stdout);\n\t#endif\n\tn=readint();\n\tscanf(\"%s\",s);\n\tfor(int i=0;i<(1<<n);i++) f[i]=s[i]-'0';\n\tFWT(f,1<<n,1);\n\tfor(int i=0;i<(1<<n);i++) f[i]=f[i]*f[i]%mod;\n\tFWT(f,1<<n,0);\n\tfor(int i=1;i<(1<<n);i++) cnt[i]=cnt[i^(i&-i)]+1;\n\tll ans=0;\n\tfor(int i=0;i<(1<<n);i++) ans=(ans+f[i]*ksm(2,n-cnt[i])%mod)%mod;\n\tprintf(\"%lld\\n\",ans*3%mod);\n\treturn 0;\n}\n```",
        "postTime": 1592326810,
        "uid": 174045,
        "name": "FZzzz",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF850E \u3010Random Elections\u3011"
    },
    {
        "content": "\u9898\u610f\uff1a\n\n\n\u7ed9\u5b9a $n$ \u4e2a\u4eba\uff0c\u6bcf\u4e2a\u4eba\u5c06\u968f\u673a\u652f\u6301 A,B,C \u4e2d\u7684\u4e00\u4f4d\u7528\u6237\u7684\u4e00\u4e2a\u6392\u5e8f\uff0c\u82e5\u4e3a ABC \u5219\u4f18\u5148\u652f\u6301 A\uff0c\u5176\u6b21\u4e3a B\uff0c\u518d\u6b21\u4e3a C\n\n\u7edf\u8ba1\u6709\u591a\u5c11\u79cd\u65b9\u6848\u4f7f\u5f97\u67d0\u4e2a\u7528\u6237\u83b7\u80dc\u4e24\u6b21\uff0c\u5176\u4e2d\u67d0\u6b21\u6bd4\u8d5b $i$ \u83b7\u80dc\u5f53\u4e14\u4ec5\u5f53\uff1a\n\n$f(i_1,i_2,i_3...)=1$\n\n\u5176\u4e2d $f$ \u662f\u4e00\u4e2a\u8f93\u5165\u53c2\u6570\uff0c\u4fdd\u8bc1 $f(i_1,i_2...)=1-f(i_1,i_2...)$\n\n\u4e24\u4e2a\u7528\u6237\u6bd4\u8f83\u7684\u65f6\u5019\uff0c\u5982\u679c\u4eba $i$ \u652f\u6301 A\uff0c\u5219\u4ee5 A \u8003\u8651\u7684\u65f6\u5019\u6709 $i_j$ \u4e3a $1$\uff0c\u53e6\u4e00\u8fb9\u4e3a $0$\n\n$\\rm Sol:$\n\n\u663e\u7136 win \u4e24\u6b21\u7684\u73a9\u5bb6\u53ea\u6709 $1$ \u4e2a\n\n\u540c\u65f6\u73a9\u5bb6\u662f\u4e92\u4e0d\u5f71\u54cd\u7684\uff0c\u7b97\u51fa\u6765\u5355\u4e2a\u73a9\u5bb6 win \u7684\u6b21\u6570\u4e58\u4ee5 $3$ \u5373\u53ef\u3002\n\n\u8003\u8651\u5355\u4e2a\u73a9\u5bb6\u600e\u4e48 win\uff0c\u5bf9\u4e8e\u4e24\u4e2a\u80dc\u8d1f\u4e2a 01 \u5e8f\u5217 S1 \u548c S2\uff0c\u663e\u7136\u6709 $f(S1)=1,f(S2)=1$\n\n\u6211\u4eec\u53d1\u73b0\u5355\u72ec\u770b\u4e24\u4e2a\u4eba\u7684\u76f8\u5bf9\u987a\u5e8f\u5bf9\u4e8e\u7b54\u6848\u662f\u6ca1\u6709\u5f71\u54cd\u7684\u3002\u5bf9\u4e8e $0,0$ \u7ec4\u5176\u8d21\u732e\u6709\u4e00\u4e2a\u989d\u5916\u7684 $2$\uff0c\u5bf9\u4e8e $1,1$ \u7ec4\u5176\u8d21\u732e\u6709\u4e00\u4e2a\u989d\u5916\u7684 $2$\uff0c\u800c 01 \u548c 10 \u5219\u4f1a\u56fa\u5b9a\u4e09\u5143\u7ec4\u7684\u987a\u5e8f\u3002\n\n\u6211\u4eec\u53d1\u73b0\u95ee\u9898\u5b9e\u9645\u4e0a\u662f\u8ba1\u7b97\u4e24\u4e2a 01 \u5e8f\u5217\u7684\u90fd\u662f win \u7684\u4e2a\u6570\u7684\u4e00\u4e2a\u8ba1\u6570\u95ee\u9898\uff0c\u6bcf\u4e00\u4f4d\u4e0a\u5982\u679c\u90fd\u662f 1 \u90a3\u4e48\u8d21\u732e\u4e3a 2\uff0c\u5982\u679c\u90fd\u662f 0 \u90a3\u4e48\u8d21\u732e\u4e3a 2\n\n\u6211\u4eec\u4e0d\u64cd\u4f5c\u7b2c\u4e00\u4e2a 01 \u5e8f\u5217 S1\uff0c\u5bf9\u4e8e\u7b2c\u4e8c\u4e2a 01 \u5e8f\u5217 S2 \u5219\u5c06\u5176\u4e2d\u7684 01 \u7ffb\u8f6c\uff0c\u90a3\u4e48\u5bb9\u6613\u53d1\u73b0\u5bf9\u4e8e\u65b0\u7684 01 \u5e8f\u5217\u6709\u8fd9\u4e00\u4f4d\u4e0a\u4e3a 01 \u624d\u7528\u8d21\u732e\uff0c\u4f60\u60f3\u5230\u4e86\u4ec0\u4e48\uff1fxor \u5377\u79ef\u554a\u8001\u54e5\u3002\n\n\u7136\u540e\u968f\u4fbf\u5377\u4e00\u4e0b\uff0c\u7b97\u4e00\u4e0b\u8d21\u732e\u5373\u53ef\u3002\n\n$Code:$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std ;\n#define Next( i, x ) for( register int i = head[x]; i; i = e[i].next )\n#define rep( i, s, t ) for( register int i = (s); i <= (t); ++ i )\n#define drep( i, s, t ) for( register int i = (t); i >= (s); -- i )\n#define re register\n#define int long long\nint gi() {\n\tchar cc = getchar() ; int cn = 0, flus = 1 ;\n\twhile( cc < '0' || cc > '9' ) {  if( cc == '-' ) flus = - flus ; cc = getchar() ; }\n\twhile( cc >= '0' && cc <= '9' )  cn = cn * 10 + cc - '0', cc = getchar() ;\n\treturn cn * flus ;\n}\nconst int P = 1e9 + 7 ;\nconst int Iv2 = 5e8 + 4 ;\nconst int N = ( 1 << 21 ) ;\nint n, limit, f[N], g[N], fac[N] ; \nchar s[N] ; \nint lowbit( int x ) {\n    return __builtin_popcountll(x) ;\n}\nvoid FWT_xor( int *a, int type ) {\n\tfor( re int k = 1; k < limit; k <<= 1 ) \t\n\tfor( re int i = 0; i < limit; i = ( i + ( k << 1 ) ) ) \n\t\tfor( re int j = i; j < i + k; ++ j ) {\n\t\t\tint nx = a[j], ny = a[j + k] ;\n\t\t\t( type == 1 ) ? ( a[j] = ( nx + ny ) % P, a[j + k] = ( nx - ny + P ) % P ) : ( a[j] = ( nx + ny ) * Iv2 % P, \n\t\t\t\ta[j + k] = ( nx - ny + P ) * Iv2 % P ) ; \n\t\t}\n}\nsigned main()\n{\n\tn = gi(), limit = ( 1 << n ) ;\n\tscanf(\"%s\", s ) ; int S = limit - 1 ; \n\trep( i, 0, limit - 1 ) f[i] = s[i] - '0' ;\n\tfor( int i = 0; i < limit; ++ i ) g[i] = f[i ^ S] ;\n\tFWT_xor( f, 1 ), FWT_xor( g, 1 ) ;\n\trep( i, 0, limit ) g[i] = f[i] * g[i] % P ; \n\tFWT_xor( g, 0 ) ; int Ans = 0 ;\n\tfac[0] = 1 ; \n\trep( i, 1, 25 ) fac[i] = fac[i - 1] * 2 % P ;  \n\trep( i, 0, limit ) Ans = ( Ans + g[i] * fac[lowbit(i)] % P ) % P ; \n\tcout << ( Ans * 3 ) % P << endl ;\n\treturn 0 ;\n}\n```",
        "postTime": 1588766000,
        "uid": 30036,
        "name": "Soulist",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF850E \u3010Random Elections\u3011"
    },
    {
        "content": "\u96be\u70b9\u5728\u4e8e\u8bfb\u9898\u3002\n\n\u7531\u4e8e\u6bcf\u4e2a\u4eba\u6709 $6$ \u79cd\u9009\u6cd5\uff0c\u7b54\u6848\u5176\u5b9e\u5c31\u662f\u67d0\u4e2a\u4eba\u8d62\u4e24\u6b21\u7684\u65b9\u6848\u6570\u3002\n\n\u7531\u4e8e\u4e09\u4e2a\u4eba\u672c\u8d28\u6ca1\u6709\u5dee\u522b\uff0c\u5e76\u4e14\u4e00\u79cd\u65b9\u6848\u81f3\u591a\u53ea\u6709 $1$ \u4e2a\u4eba\u8d62\u4e24\u6b21\u3002\u6240\u4ee5\u4e0d\u59a8\u8bbe A \u8d62\u4e86\u4e24\u6b21\uff0c\u7b54\u6848\u5c31\u662f\u65b9\u6848\u6570\u4e58 $3$\u3002\n\n\u8003\u5bdf A \u5bf9\u4e8e B \u548c C \u7684\u6bd4\u8d5b\uff0c\u6bcf\u4e2a\u4eba\u7684\u6295\u7968\u7ed3\u679c\uff0c\u7b2c $i$ \u4e2a\u4eba\u7684\u6295\u7968\u4e3a $P_i$ \u548c $Q_i$\uff0c\u6709 $P_i,Q_i\\in \\{0,1\\}$\u3002\n\n- $P_i=0,Q_i=0$\uff1a\u83b7\u80dc\u987a\u5e8f\u4e3a $C\\to B\\to A$ \u6216\u8005 $B\\to C\\to A$\u3002\n- $P_i=0,Q_i=1$\uff1a\u83b7\u80dc\u987a\u5e8f\u4e3a $C\\to A\\to B$\u3002\n- $P_i=1,Q_i=0$\uff1a\u83b7\u80dc\u987a\u5e8f\u4e3a $B\\to A\\to C$\u3002\n- $P_i=1,Q_i=1$\uff1a\u83b7\u80dc\u987a\u5e8f\u4e3a $A\\to B\\to C$ \u6216\u8005 $A\\to C\\to B$\u3002\n\n\u663e\u7136\u53ea\u6709\u5f53 $P_i=Q_i$ \u7684\u65f6\u5019\u8d21\u732e\u4e3a $2$\u3002\u5c06\u6240\u6709\u4f4d\u653e\u5230\u4e00\u8d77\u8ba1\u7b97\uff0c\u6bcf\u5bf9 $(P,Q) $ \u7684\u8d21\u732e\u4e3a $2^{n-\\text{popcount(P \\text{xor} Q)}}$\u3002\n\n\u8bbe $c_k=\\sum\\limits_{i\\ \\text{xor}\\ j=k}f_if_j$\uff0c\u7b54\u6848\u663e\u7136\u5c31\u662f $\\sum\\limits_{i=1}^{2^n-1}c_i2^{n-\\text{popcount(i)}}$\u3002\n\n\u8fd9\u5c31\u662f\u4e2a\u5f02\u6216\u5377\u79ef\uff0cFWT \u5373\u53ef\u3002\u590d\u6742\u5ea6 $O(n2^n)$\u3002\n\n```cpp\nconst int maxn = 22;\nconst int mod = 1e9 + 7;\nconst int T = (1 << 20) + 100;\nint n, S, a[T], pt[T];\n\nint qpow(int p, int q) {\n    int res = 1;\n    while (q) {\n        if (q & 1) res = res * p % mod;\n        p = p * p % mod, q >>= 1;\n    }\n    return res;\n}\n\nvoid fwt(int *s, int op) {\n    for (int o = 2, k = 1; o <= S + 1; o <<= 1, k <<= 1)\n        for (int i = 0; i <= S; i += o) \n            for (int j = 0; j < k; j++)\n                (s[i + j] += s[i + j + k]) %= mod,\n                s[i + j + k] = (a[i + j] - 2 * s[i + j + k] % mod + mod) % mod,\n                (s[i + j + k] *= op) %= mod, (s[i + j] *= op) %= mod;\n}\n\nsigned main() {\n\tn = read(), S = (1 << n) - 1;\n    for (int i = 0; i <= S; i++) scanf(\"%1d\", &a[i]);\n    for (int i = 1; i <= S; i++) pt[i] = pt[i >> 1] + (i & 1);\n    fwt(a, 1);\n    for (int i = 0; i <= S; i++) (a[i] *= a[i]) %= mod;\n    fwt(a, qpow(2, mod - 2));\n    int ans = 0;\n    for (int i = 0; i <= S; i++) \n        (ans += (1 << (n - pt[i])) * a[i] % mod) %= mod;\n    write(3 * ans % mod);\n    return 0;\n}\n```",
        "postTime": 1677576048,
        "uid": 306573,
        "name": "Ender32k",
        "ccfLevel": 0,
        "title": "CF850E Random Elections"
    },
    {
        "content": "\u5efa\u8bae\u591a\u8bfb\u51e0\u904d\u9898\u518d\u6765\u770b\u9898\u89e3\uff0c\u611f\u89c9\u8fd9\u9898\u9898\u610f\u624d\u662f\u6700\u96be\u7684\uff08\u96fe\n\n---\n\n\u6211\u4eec\u5148\u8003\u8651\u94a6\u5b9a\u83b7\u80dc\u4e24\u6b21\u7684\u662f A \u6700\u540e\u7b54\u6848\u4e58$3$\u5c31\u597d\u4e86\u3002\n\n\u8003\u8651\u4e00\u4e2a\u663e\u7136\u7684\u66b4\u529b\uff1a\u679a\u4e3e\u4e24\u4e2a $f(S)=1$ \u7684\u4e32 $S_1,S_2$ \u8868\u793a A \u548c B \u6253\u65f6\u6bcf\u4e2a\u4eba\u7684\u51b3\u5b9a , A \u548c C \u6253\u65f6\u6bcf\u4e2a\u4eba\u7684\u51b3\u5b9a\u3002\u7136\u540e\u6211\u4eec\u8ba1\u7b97\u4e00\u4e0b\u8fd9\u6837\u505a\u7684\u65b9\u6848\u6570\u3002\u5bb9\u6613\u53d1\u73b0\u6bcf\u4f4d\u662f\u72ec\u7acb\u7684\uff0c\u8bb0\u8fd9\u4e24\u4f4d\u662f$x_1,x_2$\uff0c\u6211\u4eec\u6309\u4f4d\u8003\u8651\uff1a\n\n$x_1=0 ,x_2=0$ : BCA CBA\n\n$x_1=1,x_2=0$ : CAB\n\n$x_1=0,x_2=1$ : BAC\n\n$x_1=1,x_2=1$ : ABC ACB\n\n\u6240\u4ee5\u53d1\u73b0\u5982\u679c(x1 xor x2)=0 \u5c31\u53ef\u4ee5\u5bf9\u65b9\u6848\u6570\u9020\u6210 $2$ \u7684\u8d21\u732e\n\n\u6240\u6709\u4f4d\u538b\u5728\u4e00\u8d77\u505a \u53ef\u4ee5\u5f97\u5230\u4e24\u4e2a\u4e32\u7684\u8d21\u732e\u662f $2^{n-pc[S1 \\textbf{xor} S2]}$\n\n\u5176\u4e2d $pc[i]$ \u8868\u793a $i$ \u4e8c\u8fdb\u5236\u4e0b $1$ \u7684\u4e2a\u6570\u3002\n\n\u73b0\u5728\u6211\u4eec\u9700\u8981\u7b97\u51fa\u6240\u6709\u7684\u65b9\u6848\u6570\u4e86 \u66b4\u529b\u679a\u4e3e\u662f $O(4^{n})$ \u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u7528 FWT \u9884\u5904\u7406\u51faxor\u503c$=i$ \u7684\u5bf9\u6570\u6709\u591a\u5c11 \u5206\u522b\u7d2f\u52a0\u8d21\u732e\u5373\u53ef\u3002\n\nCode:\n```cpp\n#include <algorithm>\n#include <iostream>\n#include <cstring>\n#include <climits>\n#include <cstdlib>\n#include <cstdio>\n#include <bitset>\n#include <vector>\n#include <cmath>\n#include <ctime>\n#include <queue>\n#include <stack>\n#include <map>\n#include <set>\n\n#define fi first\n#define se second\n#define U unsigned\n#define P std::pair\n#define LL long long\n#define pb push_back\n#define MP std::make_pair\n#define all(x) x.begin(),x.end()\n#define CLR(i,a) memset(i,a,sizeof(i))\n#define FOR(i,a,b) for(int i = a;i <= b;++i)\n#define ROF(i,a,b) for(int i = a;i >= b;--i)\n#define DEBUG(x) std::cerr << #x << '=' << x << std::endl\n\nconst int MAXN = (1<<21)+3;\nconst int ha = 1e9 + 7;\nconst int inv2 = 500000004;\n\nchar str[MAXN];\nint n,N;\nint pw[MAXN],pc[MAXN];\nint f[MAXN];\n\ninline void FWT(int f[]){\n    for(int mid = 1;mid < N;mid <<= 1){\n        for(int i = 0;i < N;i += (mid<<1)){\n            FOR(j,0,mid-1){\n                int x = f[i+j],y = f[i+mid+j];\n                f[i+j] = (x+y)%ha;f[i+mid+j] = (x+ha-y)%ha;\n            }\n        }\n    }\n}\n\ninline void iFWT(int f[]){\n    for(int mid = N>>1;mid;mid >>= 1){\n        for(int i = 0;i < N;i += (mid<<1)){\n            FOR(j,0,mid-1){\n                int x = f[i+j],y = f[i+mid+j];\n                f[i+j] = 1ll*(x+y)*inv2%ha;f[i+mid+j] = 1ll*(x+ha-y)*inv2%ha;\n            }\n        }\n    }\n}\n\nint main(){\n    scanf(\"%d\",&n);scanf(\"%s\",str);\n    N = (1<<(n+1));pw[0] = 1;\n    FOR(i,1,MAXN-1) pw[i] = 2ll*pw[i-1]%ha,pc[i] = pc[i>>1]+(i&1);\n    FOR(i,0,(1<<n)-1) f[i] = str[i]-'0';\n    FWT(f);\n    FOR(i,0,N-1) f[i] = 1ll*f[i]*f[i]%ha;\n    iFWT(f);int ans = 0;\n    FOR(i,0,N-1) (ans += 1ll*f[i]*pw[n-pc[i]]%ha) %= ha;//,DEBUG(f[i]),DEBUG(pc[i]);\n    ans = 3ll*ans%ha;\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1582002870,
        "uid": 50075,
        "name": "RainAir",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF850E \u3010Random Elections\u3011"
    },
    {
        "content": "[CF850E Random Elections](https://www.luogu.com.cn/problem/CF850E)\n\n\u83dc\u9e21\u7684 FWT \u5e94\u7528\u7b2c\u4e00\u9898\u3002\u8fd9\u9898\u9898\u610f\u6740\u6211\uff0c\u6211\u82b1\u4e86\u4e00\u4e2a\u5c0f\u65f6\u7684\u65f6\u95f4\u624d\u770b\u61c2\u9898\u3002\u3002\u3002\u611f\u89c9\u8fd9\u9898\u7684\u9898\u76ee\u96be\u5ea6\u4e2d\u8bfb\u9898\u96be\u5ea6\u8d77\u7801\u5360\u4e86$\\%50$\u3002\u7ffb\u8bd1\u662f\u771f\u7684\u770b\u4e0d\u61c2\uff0c\u5efa\u8bae\u5927\u5bb6\u90fd\u53bb\u770b\u82f1\u6587\u9898\u9762\u3002\n\n\u663e\u7136\u80fd\u8d62\u4e24\u6b21\u7684\u73a9\u5bb6\u53ea\u6709\u4e00\u4e2a\uff0c\u4e14\u73a9\u5bb6\u4e4b\u95f4\u4e92\u4e0d\u5f71\u54cd\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u53ea\u8003\u8651 A \u8d62\u7684\u60c5\u51b5\uff0c\u6700\u540e\u628a\u7b54\u6848 $\\times 3$\u3002\n\n\u8003\u8651 A \u5bf9\u9635 B \u548c C \u65f6\u7684\u4e24\u4e2a 01 \u5e8f\u5217\uff0c\u4f7f\u5f97 A \u8d62\u4e86\u4e24\u573a\u3002\u53d1\u73b0\u5bf9\u4e8e\u67d0\u4e00\u4f4d\uff0c\u5982\u679c\u8fd9\u4e00\u4f4d\u4e0d\u540c\uff0c\u5219\u8fd9\u4e2a\u9009\u6c11\u7684\u652f\u6301\u5ea6\u6392\u5e8f\u5df2\u7ecf\u53ef\u4ee5\u786e\u5b9a\uff0c\u5426\u5219\u6709\u4e24\u79cd\u6392\u5e8f\u53ef\u4ee5\u9020\u6210\u8fd9\u4e2a\u7ed3\u679c\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u8bbe\u4e24\u4e2a\u4e32 $S1,S2$ \u5206\u522b\u8868\u793a $A-B$ \u548c $C-A$ \u5bf9\u9635\u65f6\u6bcf\u4e2a\u516c\u6c11\u7684\u51b3\u5b9a\uff0c$S1,S 2$  \u7684\u7b2c $i$ \u4f4d\u7684\u60c5\u51b5\u4e3a $(x,y)$ :\n\n* $(x,y)=(0,0)\\Rightarrow CBA,CAB$\n* $(x,y)=(1,0)\\Rightarrow CAB$\n* $(x,y)=(0,1)\\Rightarrow BAC$\n* $(x,y)=(1,1)\\Rightarrow ABC,ACB$\uff1a\n\n\u53d1\u73b0\u5982\u679c $(x \\ xor\\  y)=0$ \u5c31\u53ef\u4ee5\u5bf9\u65b9\u6848\u6570\u9020\u6210 2 \u7684\u8d21\u732e \u3002\u8bbe $S=S1\\ xor \\ S2$ \uff0c$c$ \u4e3a $S$ \u4e2d0\u7684\u4e2a\u6570\uff0c\u90a3\u4e48 $S1,S2$ \u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5373\u4e3a $2^c$ \u3002\u6211\u4eec\u5bf9\u6bcf\u4e2a $S$ \u8ba1\u7b97\u51fa\u6709\u591a\u5c11\u5bf9 $S=S1 \\ xor \\ S2$ \u4e14 $f_{S1}=f_{S2}=1$ \uff0c\u53d1\u73b0\u8fd9\u5c31\u662f $f$ \u4e0e\u81ea\u5df1\u7684\u5f02\u6216\u5377\u79ef\uff0c\u4f7f\u7528 FWT \u5b9e\u73b0\u5373\u53ef\u3002 \n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nnamespace FGF\n{\n\tint n,m;\n\tconst int N=2e6+5;\n\tconst int mo=1e9+7;\n\tchar s[N]; \n\tll a[N],pw[N],cnt[N];\n\tll ans;\n\tvoid FWTxor(ll *y,int op)\n\t{\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tfor(int j=0;j<(1<<n);j+=(1<<i))\n\t\t\t\tfor(int k=0;k<(1<<(i-1));k++)\n\t\t\t\t{\n\t\t\t\t\tll c=(y[j|k]+y[j|k|(1<<(i-1))])%mo,d=(y[j|k]-y[j|k|(1<<(i-1))]+mo)%mo;\n\t\t\t\t\ty[j|k]=c*op%mo,y[j|k|(1<<(i-1))]=d*op%mo;\n\t\t\t\t}\n\t}\n\tvoid work()\n\t{\n\t\tscanf(\"%d\",&n);\n\t\tscanf(\"%s\",s);\n\t\tpw[0]=1;\n\t\tfor(int i=0;i<(1<<n);i++)\n\t\t\ta[i]=s[i]-'0';\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tpw[i]=2LL*pw[i-1]%mo;\n\t\tfor(int i=1;i<(1<<n);i++)\n\t\t\tcnt[i]=cnt[i>>1]+(i&1);\n\t\tFWTxor(a,1);\n\t\tfor(int i=0;i<(1<<n);i++)\n\t\t\ta[i]=a[i]*a[i]%mo;\n\t\tFWTxor(a,(mo+1)/2);\n\t\tfor(int i=0;i<(1<<n);i++)\n\t\t\tans=(ans+1LL*a[i]*pw[n-cnt[i]])%mo;\n\t\tprintf(\"%lld\",ans*3%mo);\n\t}\n}\nint main()\n{\n\tFGF::work();\n\treturn 0;\n}\n```\n\n",
        "postTime": 1607929634,
        "uid": 224403,
        "name": "\u6728xx\u6728\u5927",
        "ccfLevel": 9,
        "title": "CF850E Random Elections(FWT)"
    }
]
[
    {
        "content": "**\u524d\u7f6e\u829d\u58eb**:\u4f4d\u8fd0\u7b97\u5377\u79efFWT\n\n[\u6216\u8bb8\u6709\u7528\u7684\u6587\u7ae0](https://www.luogu.org/blog/command-block/wei-yun-suan-juan-ji-yu-ji-kuo-zhan)\n\n**\u7ea6\u5b9a**: $F$ \u662f\u4e00\u4e2a\u5e42\u7ea7\u6570, $F[n]$ \u662f\u5e42\u7ea7\u6570\u7b2c $n$ \u9879\u7cfb\u6570,\u5e42\u7ea7\u6570\u4e4b\u95f4\u7684$*$\u6307**\u5f02\u6216\u5377\u79ef**\u3002\n\n------------\n\n\u8fd9\u9898\u662f\u771f\u7684\u5999\u554a! Orz\u51fa\u9898\u4eba!!!\n\n\u5982\u679c\u4f60\u719f\u6089\u751f\u6210\u51fd\u6570\u5377\u79ef\u8ba1\u6570\u90a3\u4e00\u5957,\u90a3\u4e48\u5bb9\u6613\u5f97\u5230 :\n\n\u628a\u4e00\u4e2a\u4e09\u5143\u7ec4 $\\{a_i,b_i,c_i\\}$ ,\u53d8\u6210\u4e00\u4e2a $F_i[a_i]=x,\\ F_i[b_i]=y,\\ F_i[c_i]=z$ \u7684\u4e00\u4e2a\u5e42\u7ea7\u6570\u3002\n\n\u7136\u540e\u628a\u6240\u6709\u5e42\u7ea7\u6570\u90fd\u5f02\u6216\u5377\u79ef\u8d77\u6765\u5c31\u80fd\u5f97\u5230\u7b54\u6848\u4e86\u3002\n\n\u53ef\u662f\u8fd9\u9898\u503c\u57df $2^{17}=131072$ ,\u5e42\u7ea7\u6570\u6709 $10^5$ \u4e2a,\u76f4\u63a5\u5377\u79ef $O(nk2^k)$ \u80af\u5b9a\u65e0\u6cd5\u901a\u8fc7\u3002\n\n\u6bcf\u4e2a\u5e42\u7ea7\u6570\u53ea\u67093\u4e2a\u975e\u96f6\u503c,\u6211\u4eec\u8003\u8651\u627e\u627e\u89c4\u5f8b\u3002\n\n\u8bbe $c(i,j)$ \u4e3a\u5f02\u6216\u5377\u79ef\u7684\u53d8\u6362\u7cfb\u6570\u3002\n\n\u5373 $FWT(F_k)[i]=\\sum\\limits_{j=0}^{n-1}c(i,j)F_k[j]$ \n\n\u7531\u4e8e$F_i$\u53ea\u6709\u4e09\u4e2a\u975e0\u4f4d\u7f6e,\u53ef\u4ee5\u5f97\u5230:\n\n$FWT(F_k)[i]=c(i,a_k)x+c(i,b_k)y+c(i,c_k)z$\n\n\u4f17\u6240\u5468\u77e5 $c(i,j)=(-1)^{cnt(i\\&j)}$\n\n( $cnt(i)$ \u662f $i$ \u5728\u4e8c\u8fdb\u5236\u4e0b $1$ \u7684\u4e2a\u6570\u3002)\n\n\u5219$FWT(F_k)[i]=(-1)^{cnt(i\\&a_k)}x+(-1)^{cnt(i\\&b_k)}y+(-1)^{cnt(i\\&c_k)}z$\n\n\u63a8\u5bfc\u5230\u8fd9\u91cc,\u5982\u679c\u6309\u7167\u4e0a\u5f0f\u66b4\u529b\u7b97\u51fa\u6bcf\u4e2a\u5e42\u7ea7\u6570\u7684\u201c\u70b9\u503c\u201d\u7136\u540e\u70b9\u4e58,\u518d $IFWT$ ,\u590d\u6742\u5ea6\u662f $O((n+k)2^k)$ ,\u4ecd\u7136\u65e0\u901a\u8fc7\n\n\u5f62\u5f0f\u5316\u5730\u8bb2:\n\n$S[i]=\\prod\\limits_{k=1}^n{FWT(F_k)[i]}$\n\n\u90a3\u4e48 $IFWT(S)$ \u5c31\u662f\u7b54\u6848\u3002\n\n$\\prod\\limits_{k=1}^n{FWT(F_k)[i]}$\n\n$=\\prod\\limits_{k=1}^n{(-1)^{cnt(i\\&a_k)}x+(-1)^{cnt(i\\&b_k)}y+(-1)^{cnt(i\\&c_k)}z}$\n\n\u540e\u9762\u7684\u4e58\u79ef\u9879\u4e00\u5171\u53ea\u6709\u516b\u79cd\u53ef\u80fd(\u6b63\u8d1f\u53f7)\n\n\u6211\u4eec\u5206\u522b\u6c42\u51fa\u8fd9\u516b\u79cd\u53ef\u80fd\u7684\u4e2a\u6570\u5c31\u80fd\u7528\u5feb\u901f\u5e42\u6c42\u7b54\u6848\u4e86\u3002\n\n\u516b\u79cd\u53ef\u80fd\u592a\u70e6\u4e86,\u6709\u4e00\u79cd\u5de7\u5999\u7684\u5316\u7b80\u65b9\u6cd5 :\n\n\u7531\u5f02\u6216\u7684\u81ea\u53cd\u6027,\u6bcf\u4e2a\u628a\u4e09\u5143\u7ec4 $\\{a_i,b_i,c_i\\}$ \u5f02\u6216\u4e0a $a_i$ ,\u53d8\u4e3a $\\{0,b_i\u2295a_i,c_i\u2295a_i\\}$\u3002\n\n\u90a3\u4e48\u6700\u540e\u7684\u7ed3\u679c\u5f02\u6216\u4e0a $\u2295_{i=1}^na_i$ \u5c31\u80fd\u5f97\u5230\u539f\u6765\u7684\u7b54\u6848\u3002\n\n\u53cd\u6620\u5230\u591a\u9879\u5f0f\u4e0a\u5c31\u662f\u505a\u4e00\u4e2a\u4e0b\u6807\u6620\u5c04\u3002\n\n\u56de\u5230\u8fd9\u4e2a\u5f0f\u5b50:\n\n$S[i]=\\prod\\limits_{k=1}^n{(-1)^{cnt(i\\&a_k)}x+(-1)^{cnt(i\\&b_k)}y+(-1)^{cnt(i\\&c_k)}z}$\n\n\u6211\u4eec\u73b0\u5728\u7ecf\u8fc7\u6539\u9020\u4e4b\u540e\u6240\u6709\u7684 $a_k=0$ ,\u6240\u4ee5 $cnt(i\\&a_k)$ \u4e00\u5b9a\u662f0.\n\n\u90a3\u4e48\u5c31\u53ea\u5269\u56db\u79cd\u60c5\u51b5 : $x+y+z;\\ x+y-z;\\ x-y+z;\\ x-y-z;$\n\n\u8bbe\u8fd9\u56db\u79cd\u60c5\u51b5\u7684\u65b9\u6848\u6570\u5206\u522b\u662f $c_1,c_2,c_3,c_4$ (\u6ce8\u610f,\u662f\u9488\u5bf9 $S[i]$ \u800c\u8a00)\n\n\u6211\u4eec\u6c42\u51fa\u8fd9\u4e9b $c$ \u4e4b\u540e\u5c31\u80fd\u5feb\u901f\u5e42\u6c42 $S[i]$ \u4e86\u3002\n\n\u6211\u4eec\u8003\u8651\u5f04\u51fa $4$ \u4e2a\u65b9\u7a0b\u7136\u540e\u628a\u56db\u4e2a $c$ \u89e3\u51fa\u6765\u3002\n\n\u663e\u7136\u6709 $c_1+c_2+c_3+c_4=n\\quad(1)$\n\n- \u5982\u679c\u4ec5\u4ee4 $F_k[b_k]=1$ ,\u5373 $x=0,y=1,z=0$\n\n\u90a3\u4e48\u6b64\u65f6 $FWT(F_k)[i]=(-1)^{cnt(i\\&b_k)}$\n\n\u8fd9\u6837\u5c31\u53ea\u8003\u8651$y$\u7684\u7b26\u53f7\u7684\u8d21\u732e,\u6709 $\\sum\\limits_{k=1}^nFWT(F_k)[i]=p1=c_1+c_2-c_3-c_4\\quad(2)$\n\n- $x+y+z$ \u4e2d $y$ \u4e3a\u6b63,\u6240\u4ee5 $c_1$ \u7684\u7cfb\u6570\u4e3a\u6b63\u3002\n- $x+y-z$ \u4e2d $y$ \u4e3a\u6b63,\u6240\u4ee5 $c_2$ \u7684\u7cfb\u6570\u4e3a\u6b63\u3002\n- $x-y+z$ \u4e2d $y$ \u4e3a\u8d1f,\u6240\u4ee5 $c_3$ \u7684\u7cfb\u6570\u4e3a\u8d1f\u3002\n- $x-y-z$ \u4e2d $y$ \u4e3a\u8d1f,\u6240\u4ee5 $c_4$ \u7684\u7cfb\u6570\u4e3a\u8d1f\u3002\n\n\u6211\u4eec\u6709 $FWT(F+G)=FWT(F)+FWT(G)$ \u3002\n\n( \u56e0\u4e3a\u8fd9\u4e1c\u897f\u662f\u4e00\u4e2a\u7ebf\u6027\u53d8\u6362,\u5176\u5b9e\u5c31\u662f\u5411\u91cf\u4e58\u77e9\u9635 )\n\n\u90a3\u4e48\u6211\u4eec\u8ba1\u7b97 $FWT(\\sum\\limits_{k=1}^nF_k)$ \u5c31\u597d\u4e86,\u5176\u5b9e\u5c31\u662f\u8ba1\u7b97 $G[k]=\\sum\\limits_{i=1}^n[b_i=k]$ \u8fd9\u6837\u4e00\u4e2a\u5e42\u7ea7\u6570\u7684 $FWT$\u3002\n\n- \u5982\u679c\u4ee4$F_k[c_k]=1$,\u5373$x=0,y=0,z=1$\n\n\u90a3\u4e48\u6b64\u65f6 $FWT(F_k)[i]=(-1)^{cnt(i\\&c_k)}$\n\n\u53ea\u8003\u8651$z$\u7684\u7b26\u53f7\u7684\u8d21\u732e,\u6709 $\\sum\\limits_{k=1}^nFWT(F_k)[i]=c_1-c_2+c_3-c_4\\quad(3)$\n\n\u540c\u6837\u662f\u7b97$DWT(\\sum\\limits_{k=1}^nF_k)$\u5c31\u597d\u4e86\u3002\n\n- \u5982\u679c\u53ea\u4ee4$F_k[b_k\u2295c_k]=1$\n\n\u90a3\u4e48\u5c31\u76f8\u5f53\u4e8e\u628a\u4e0a\u9762\u4e24\u79cd\u60c5\u51b5\u5377\u79ef,\u4e5f\u5c31\u662f**\u70b9\u503c\u70b9\u79ef**\u3002\n\n\u90a3\u4e48\u6b64\u65f6 $FWT(F_k)[i]=(-1)^{cnt(i\\&b_k)}(-1)^{cnt(i\\&c_k)}$\n\n\u90a3\u4e48$\\sum\\limits_{k=1}^nFWT(F_k)[i]=c_1-c_2-c_3+c_4\\quad(4)$\n\n(\u540c\u65f6\u8003\u8651$y,z$\u7684\u7b26\u53f7\u8d21\u732e)\n\n\u73b0\u5728$4$\u4e2a\u65b9\u7a0b\u90fd\u9f50\u4e86,\u90a3\u4e48\u624b\u52a8\u89e3\u65b9\u7a0b\u5c31\u597d\u4e86\u3002\n\n\u5177\u4f53\u7684\u65b9\u7a0b\u662f:\n\n\u539f\u5f0f$\\begin{cases}n=c_1+c_2+c_3+c_4\\\\p1=c_1+c_2-c_3-c_4\\\\p2=c_1-c_2+c_3-c_4\\\\p3=c_1-c_2-c_3+c_4\\end{cases}$\n\n\u89e3\u5f97$\\begin{cases}c_1=(n+p1+p2+p3)/4\\\\c_2=(n+p1-2c_1)/2\\\\c_3=(n+p2-2c_1)/2\\\\c_4=(n+p3-2c_1)/2\\end{cases}$\n\n\u6ce8\u610f\u8fd9\u91cc\u4e0d\u7528\u8003\u8651\u53d6\u6a21\u95ee\u9898,\u56e0\u4e3a $c\\leq n$.\n\n\u6700\u540e\u518d$IFWT$\u56de\u53bb\u5c31\u597d\u4e86\u3002\n\n\u590d\u6742\u5ea6 $O((k+\\log n)2^k)$ ,\u53ef\u4ee5\u901a\u8fc7\u3002\n\n```cpp\n#include<algorithm>\n#include<cstdio>\n#define Maxn 140000\n#define mod 998244353\n#define inv2 499122177ll\n#define ll long long\nusing namespace std;\ninline int read()\n{\n  register int X=0;\n  register char ch=0;\n  while(ch<48||ch>57)ch=getchar();\n  while(ch>=48&&ch<=57)X=X*10+(ch^48),ch=getchar();\n  return X;\n}\nll powM(ll a,ll t=mod-2)\n{\n  ll ans=1;\n  while(t){\n  \tif(t&1)ans=ans*a%mod;\n  \ta=a*a%mod;\n  \tt>>=1;\n  }return ans;\n}\nint m;\nll x,y,z;\nll f1[Maxn],f2[Maxn],f3[Maxn],f[Maxn];\nvoid DWT(ll *a)\n{\n  for (int len=1;len<m;len<<=1)\n    for (int p=0;p<m;p+=len+len)\n      for (int i=p;i<p+len;i++){\n        ll sav0=a[i];\n        a[i]+=a[i+len];\n        a[i+len]=sav0-a[i+len];\n      }\n}\nvoid IDWT(ll *a)\n{\n  for (int len=1;len<m;len<<=1)\n    for (int p=0;p<m;p+=len+len)\n      for (int i=p;i<p+len;i++){\n        ll sav0=a[i];\n        a[i]=(a[i]+a[i+len])*inv2%mod;\n        a[i+len]=(sav0-a[i+len])*inv2%mod;\n      }\n}\nint n;\nint main()\n{\n  n=read();m=(1<<read());\n  x=read();y=read();z=read();\n  int sav=0;\n  for (int i=0,a,b,c;i<n;i++){\n    a=read();b=read();c=read();\n    sav^=a;b^=a;c^=a;\n    f1[b]++;f2[c]++;f3[b^c]++;\n  }\n  DWT(f1);DWT(f2);DWT(f3);\n  ll s1=(x+y+z)%mod,s2=(x+y-z)%mod,\n     s3=(x-y+z)%mod,s4=(x-y-z)%mod;\n  for (int i=0;i<m;i++){\n    ll c1=(n+f1[i]+f2[i]+f3[i])/4;\n    f[i]=powM(s1,c1)*\n         powM(s2,(n+f1[i]-c1-c1)/2)%mod*\n         powM(s3,(n+f2[i]-c1-c1)/2)%mod*\n         powM(s4,(n+f3[i]-c1-c1)/2)%mod; \n  }IDWT(f);\n  for (int i=0;i<m;i++)\n    printf(\"%lld \",(f[i^sav]+mod)%mod);\n  return 0;\n}\n```\n",
        "postTime": 1564461426,
        "uid": 58705,
        "name": "command_block",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1119H \u3010Triple\u3011"
    },
    {
        "content": "> **IX. [CF1119H Triple](https://www.luogu.com.cn/problem/CF1119H)*\n>\n> [\u96c6\u5408\u5e42\u7ea7\u6570\u76f8\u5173](https://www.cnblogs.com/alex-wei/p/set_power_series.html) \u4f8b 9\u3002\n\n\u795e\u4ed9\u7ea7\u522b\u7684\u96c6\u5408\u5e42\u7ea7\u6570\u5e94\u7528\uff01\n\n\u4e0d\u59a8\u76f4\u63a5\u8003\u8651\u5c06\u4e09\u5143\u7ec4\u63a8\u5e7f\u81f3\u4e00\u822c\u60c5\u51b5\uff1a\u7ed9\u51fa $d_i(0\\leq i < m)$ \u4ee5\u53ca $a_{i, j}(1\\leq i \\leq n, 0\\leq j < m)$\uff0c\u4ee4\u96c6\u5408\u5e42\u7ea7\u6570 $f_i = \\sum\\limits_{j = 0} ^ {m - 1}d_i x ^ {a_{i, j}}$\uff0c\u6c42\u51fa\u6240\u6709 $f_i$ \u7684 **\u5f02\u6216\u5377\u79ef** $g = \\prod\\limits_{i = 1} ^ n f_i$\u3002\u5bb9\u6613\u53d1\u73b0\u672c\u9898\u5373 $m = 3$ \u7684\u60c5\u51b5\u3002\n\n\u4ee4 $G = \\hat g$\uff0c$F_i = \\hat f_i$\uff0c\u5219 $G = \\prod\\limits_{i = 1} ^ n F_i$\u3002\u8fd9\u91cc $\\prod $ \u8868\u793a\u5bf9\u5e94\u4f4d\u7f6e\u76f8\u4e58\u3002\u8003\u8651 $[x ^ p]F_i$\uff0c\u6839\u636e FWT \u7684\u5b9a\u4e49\uff0c\u5176\u4e3a $\\sum\\limits_{j = 0} ^ {m - 1} (-1) ^ {p \\odot a_{i, j}} d_j$\u3002\u5982\u679c\u6211\u4eec\u80fd\u5bf9\u4e8e\u6bcf\u4e00\u4f4d $p$ \u6c42\u51fa $[x ^ p]\\prod F_i$\uff0c\u5c31\u53ef\u4ee5\u6c42\u5f97 $G$\uff0c\u7136\u540e IFWT \u5f97\u5230 $g$\u3002\n\n\u6240\u6709 $d_j$ \u524d\u7cfb\u6570\u5747\u4e3a $\\pm 1$\uff0c\u7ec4\u5408\u53ea\u6709 $2 ^ m$ \u79cd\u3002\u8003\u8651\u5bf9\u6bcf\u4e00\u4f4d\u6c42\u51fa $[x ^ p] \\prod F_i$ \u5f53\u4e2d\u8fd9 $2 ^ m$ \u79cd\u7ec4\u5408\u5206\u522b\u51fa\u73b0\u7684\u6b21\u6570\uff0c\u518d\u5feb\u901f\u5e42\u3002\n\n**\u4ee5\u4e0b\u8ba8\u8bba\u5747\u57fa\u4e8e\u7b2c $p$ \u4f4d**\u3002\n\n\u8bbe $c_0 \\sim c_{2 ^ m - 1}$ \u8868\u793a\u5bf9\u5e94\u7ec4\u5408\u7684\u51fa\u73b0\u6b21\u6570\u3002\u82e5 $k$ \u7684\u7b2c $j$ \u4f4d\u4e3a $1$\uff0c\u8bf4\u660e $c_k$ \u6240\u8868\u793a\u7684\u7cfb\u6570\u5e8f\u5217\u7684\u51fa\u73b0\u6b21\u6570\u4e2d $d_j$ \u7684\u7cfb\u6570\u4e3a $-1$\uff0c\u5426\u5219\u4e3a $1$\u3002\u6216\u8005\u8bf4\uff0c\u82e5 $k$ \u7684\u7b2c $j$ \u4f4d\u4e3a $1$\uff0c\u5219\u5b83\u8981\u6c42 $(-1) ^ {p\\odot a_{i, j}} = -1$\uff0c\u5426\u5219\u8981\u6c42 $(-1) ^ {p \\odot a_{i, j}} = 1$\u3002$k$ \u7684\u603b\u5171 $m$ \u4f4d\u7684\u9650\u5236\u552f\u4e00\u786e\u5b9a\u4e86\u4e00\u4e2a\u7cfb\u6570\u5e8f\u5217\u3002\n\n\u6c42\u89e3\u8fd9\u4e9b\u672a\u77e5\u6570\u81ea\u7136\u9700\u8981\u65b9\u7a0b\uff0c\u6211\u4eec\u9700\u8981 $2 ^ m$ \u4e2a\u7ebf\u6027\u65e0\u5173\u7684\u65b9\u7a0b\u6765\u6c42\u89e3 $c$\u3002\u8fd9\u5f15\u5bfc\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e2a $T \\subseteq \\{0, 1, \\cdots, m\\}$\uff0c**\u4ec5** \u5c06 $z_{i, T} = {\\large \\oplus}_{j \\in T} a_{i, j}$ \u4ee3\u5165\u96c6\u5408\u5e42\u7ea7\u6570\u3002\u8003\u8651\u96c6\u5408\u5e42\u7ea7\u6570 $h_T = \\sum\\limits_{i = 1} ^ n x ^ {z_{i, T}}$\uff0c\u5bf9\u5176\u8fdb\u884c\u6c83\u5c14\u4ec0\u53d8\u6362\u5f97\u5230 $H_T$\u3002\n\n\u8003\u8651 $c_k$ \u5bf9 $H_T$ \u5728 $p$ \u8fd9\u4e00\u4f4d\u7f6e\u4e0a\u7684\u503c\u7684\u8d21\u732e\u3002\u9996\u5148\uff0c$[x ^ p]H_T = \\sum\\limits_{i = 1} ^ n (-1) ^ {p \\odot z_{i, T}}$\uff0c\u56e0\u4e3a\u6839\u636e FWT \u7684\u7ebf\u6027\u6027\uff0c$x ^ {z_{i, T}}$ \u5173\u4e8e $i$ \u6c42\u548c\u540e\u8fdb\u884c FWT \u5728 $p$ \u8fd9\u4e00\u4f4d\u4e0a\u7684\u53d6\u503c\uff0c\u5c31\u7b49\u4e8e\u6bcf\u4e2a $x ^ {z_{i, T}}$ FWT \u540e\u5728 $p$ \u8fd9\u4e00\u4f4d\u4e0a\u7684\u53d6\u503c\u4e4b\u548c\uff0c\u6545\u6709\u4e0a\u5f0f\u3002\n\n\u800c\u6839\u636e FWT \u6240\u5229\u7528\u7684 $\\odot$ \u8fd0\u7b97\u7b26\u7684\u91cd\u8981\u6027\u8d28 $i \\odot (j \\oplus k) = (i \\odot j) \\oplus (i \\odot k)$\uff0c$(-1) ^ {p\\odot z_{i, T}}$ \u5c31\u7b49\u4e8e $\\prod\\limits_{j \\in T} (-1) ^ {p \\odot a_{i, j}}$\u3002\n\n\u56e0\u6b64\u5bf9\u4e8e $c_k$\uff0c\u56e0\u4e3a $k$ \u7684\u7b2c $j$ \u4f4d\u4e3a $1$ \u5bf9\u5e94 $(-1) ^ {p \\odot a_{i, j}} = -1$\uff0c\u4e3a $0$ \u5219\u5bf9\u5e94 $(-1) ^ {p \\odot a_{i, j}} = 1$\uff0c\u800c **\u4ec5\u6709 $j \\in T$ \u7684\u4f4d\u7f6e\u624d\u4f1a\u5bf9 $(-1) ^ {p \\odot z_{i, T}}$ \u4ea7\u751f\u8d21\u732e**\uff0c\u6240\u4ee5 $k$ \u5bf9\u5e94\u7684\u7cfb\u6570\u5e8f\u5217\u6bcf\u51fa\u73b0\u4e00\u6b21\uff0c\u90fd\u4f1a\u4ea7\u751f $(-1) ^ {k \\odot T}$ \u7684\u8d21\u732e\uff0c\u8fd9\u91cc\u9700\u8981\u5c06 $T$ \u770b\u6210\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6570\uff08\u4e0d\u5728 $T$ \u91cc\u9762\u7684\u4f4d\u5bf9 $(-1) ^ {p\\odot z_{i, T}}$ \u6ca1\u6709\u8d21\u732e\uff0c\u800c $k$ \u7684\u7b49\u4e8e $0$ \u7684\u4f4d\u5c31\u7b97\u5c5e\u4e8e $T$\uff0c\u5bf9 $(-1) ^ {p \\odot z_{i, T}}$ \u7684\u8d21\u732e\u4e5f\u4e3a $1$\uff0c\u56e0\u4e3a $(-1) ^ {p\\odot a_{i, j}} = 1$\uff0c\u8fd9\u662f $k$ \u5bf9\u5e94\u7684\u7cfb\u6570\u5e8f\u5217\u7684\u5b9a\u4e49\uff09\u3002\n\n\u6240\u4ee5 $\\sum\\limits_{i = 1} ^ n (-1) ^ {p \\odot z_{i, T}}$ \u4e5f\u7b49\u4e8e $\\sum\\limits_{k = 0} ^ {2 ^ m - 1} (-1) ^ {k \\odot T} c_k$\u3002\n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u5b9e\u9645\u4e0a\u662f\u5c06 $c$ \u505a FWT \u540e\u5728\u4f4d\u7f6e $T$ \u7684\u53d6\u503c\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u5bf9\u6bcf\u4e2a $T$ \u5747\u6c42\u51fa $H_T$\uff0c\u5219 $C_i = H_{i, p}$\u3002\u6c42\u5f97 $C$ \u540e IFWT \u56de\u6765\u5373\u53ef\u5f97\u5230 $c$\uff0c\u4ece\u800c\u5f97\u5230 $[x ^ p] \\prod F_i$ \u5373 $[x ^ p] G$\uff0c\u4ece\u800c\u5f97\u5230\u7b54\u6848\u3002\n\n\u68b3\u7406\u4e00\u4e0b\uff0c\u6211\u4eec\u5c06 $a_i$ \u7684\u6bcf\u4e2a\u5b50\u96c6\uff08\u5305\u62ec\u7a7a\u96c6\uff09\u5f02\u6216\u8d77\u6765\u5f97\u5230 $z_{i, T}$\uff0c\u7ed9 $[x ^ {z_{i, T}}]h_T$ \u52a0\u4e0a $1$\u3002\u7136\u540e\u5bf9\u6bcf\u4e2a $h_T$ \u6c42\u5176\u6c83\u5c14\u4ec0\u53d8\u6362 $H_T$\u3002**\u5bf9\u4e8e\u67d0\u4e00\u4f4d\u7f6e** $p$\uff0c$H_{T, p}$ \u7684\u53d6\u503c\u6070\u597d\u662f $d_1\\sim d_m$ \u524d\u5171 $2 ^ m$ \u79cd\u7cfb\u6570\u7ec4\u5408\u5bf9\u5e94\u7684\u51fa\u73b0\u6b21\u6570\u5e8f\u5217 $c$ \u7684 FWT $C$ \u5728 $T$ \u5904\u7684\u53d6\u503c\u3002\u5bf9 $C$ IFWT \u5f97\u5230 $c$\uff0c\u6211\u4eec\u56e0\u800c\u5f97\u4ee5\u6c42\u5f97 $[x ^ p]G$\uff0c\u6700\u540e IFWT \u5373\u53ef\u6c42\u5f97 $g$\uff0c\u5373\u7b54\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(nm2 ^ m + (m + k) 2 ^ {m + k})$\u3002\u4ee3\u7801\u5982\u4e0b\uff0c\u6ce8\u610f\u4ee3\u7801\u91cc\u9762\u7684 $m$ \u548c $k$ \u662f\u53cd\u8fc7\u6765\u7684\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int N = 1 << 17, K = 1 << 3, mod = 998244353;\nint ksm(int a, int b) {\n\tint s = 1;\n\twhile(b) {\n\t\tif(b & 1) s = 1ll * s * a % mod;\n\t\ta = 1ll * a * a % mod, b >>= 1; // add 1ll\n\t}\n\treturn s;\n}\nvoid FWT(int *f, int n, int op) {\n\tfor(int k = 1; k < n; k <<= 1)\n\t\tfor(int i = 0; i < n; i += k << 1)\n\t\t\tfor(int j = 0, x, y; j < k; j++)\n\t\t\t\tx = f[i | j], y = f[i | j | k], f[i | j] = (x + y) % mod, f[i | j | k] = (x + mod - y) % mod;\n\tif(op != 1) for(int i = 0; i < n; i++) f[i] = 1ll * f[i] * op % mod;\n}\nint n, m, k, c[K], f[K], g[N], a[N][K], buc[K][N];\nint main() {\n\tcin >> n >> m, k = 3;\n\tfor(int i = 0; i < k; i++) cin >> c[i], c[i] %= mod;\n\tfor(int i = 0; i < n; i++) {\n\t\tmemset(f, 0, sizeof(f));\n\t\tfor(int j = 0; j < k; j++) cin >> a[i][j];\n\t\tfor(int j = 1; j < 1 << k; j++) for(int p = 0; p < k; p++) if(j >> p & 1) f[j] = f[j ^ (1 << p)] ^ a[i][p];\n\t\tfor(int j = 0; j < 1 << k; j++) buc[j][f[j]]++;\n\t}\n\tfor(int i = 0; i < 1 << k; i++) FWT(buc[i], 1 << m, 1);\n\tfor(int i = 0; i < 1 << m; i++) {\n\t\tfor(int j = 0; j < 1 << k; j++) f[j] = buc[j][i];\n\t\tFWT(f, 1 << k, ksm(mod + 1 >> 1, k)), g[i] = 1;\n\t\tfor(int j = 0; j < 1 << k; j++) {\n\t\t\tint sum = 0;\n\t\t\tfor(int p = 0; p < k; p++) sum = (sum + (j >> p & 1 ? mod - c[p] : c[p])) % mod;\n\t\t\tg[i] = 1ll * g[i] * ksm(sum, f[j]) % mod;\n\t\t}\n\t}\n\tFWT(g, 1 << m, ksm(mod + 1 >> 1, m));\n\tfor(int i = 0; i < 1 << m; i++) cout << g[i] << \" \";\n\treturn 0;\n}\n```",
        "postTime": 1647658204,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "CF1119H Triple"
    },
    {
        "content": "\u5c1d\u8bd5\u89e3\u51b3\u66f4\u4e3a\u4e00\u822c\u5316\u7684\u95ee\u9898\uff1a\u7ed9\u5b9a $w_0,w_2 \\ldots w_{k-1}$ \u548c $a_{i,j} (1 \\leq i \\leq n,0 \\leq j < k)$\uff0c\u6c42 $\\prod_{i=1}^n\\sum_{j=0}^{k-1} w_j x^{a_{i,j}}$\u3002 \u672c\u9898\u5373 $k = 3$ \u7684\u7279\u4f8b\u3002\n\n\u8003\u8651\u5c06 [\u9ece\u660e\u524d\u7684\u5de7\u514b\u529b](https://uoj.ac/problem/310) \u4e00\u9898\u7684\u505a\u6cd5\u6269\u5c55\u5230\u4e00\u822c\u60c5\u51b5\u3002\n\n\u6b64\u65f6\uff0c\u4e00\u4e2a\u591a\u9879\u5f0f\u7684 FWT \u6570\u7ec4\u7684\u6bcf\u4e00\u9879\u6709 $2^k$ \u79cd\u53ef\u80fd\u7684\u53d6\u503c\uff0c\u5373\uff1a$\\sum s_i w_i$ \uff0c\u5176\u4e2d $s_i = \\pm 1$\u3002\u6211\u4eec\u60f3\u8981\u5bf9\u4e8e\u6bcf\u4e00\u9879\uff0c\u6c42\u8fd9 $n$ \u4e2a FWT \u6570\u7ec4\u7684\u5bf9\u5e94\u9879\u4e2d\uff0c\u8fd9 $2^k$ \u79cd\u53d6\u503c\u5206\u522b\u51fa\u73b0\u4e86\u591a\u5c11\u6b21\u3002\u4ee5\u4e0b\u8ba8\u8bba\u5747\u9488\u5bf9 FWT \u6570\u7ec4\u7684\u67d0\u4e00\u9879\u3002\n\n\u4ee4 $c_0,c_1 \\ldots c_{2^k - 1}$ \u5206\u522b\u4e3a\u8fd9 $2^k$ \u79cd\u53d6\u503c\u7684\u51fa\u73b0\u6b21\u6570\u3002\u4e3a\u4e86\u65b9\u4fbf\uff0c\u5bf9\u4e8e $c_x$ \u5bf9\u5e94\u7684\u7cfb\u6570\u6570\u7ec4 $s$\uff0c\u6211\u4eec\u628a $x$ \u770b\u4f5c\u957f\u4e3a $k$ \u7684\u4e8c\u8fdb\u5236\u6570\uff0c\u82e5\u5176\u7b2c $i$ \u4f4d\u4e3a $1$ \u5219 $s_i = -1$\uff0c\u5426\u5219 $s_i = 1$\u3002\u663e\u7136\u8fd9\u6837\u53ef\u4ee5\u548c $s$ \u4e00\u4e00\u5bf9\u5e94\u3002\n\n\u8003\u8651\u5bf9\u4e8e $\\{0,1, \\ldots k-1\\}$ \u7684\u4e00\u4e2a\u5b50\u96c6 $T$\uff0c\u4ee4 $z_i = \\bigoplus_{j \\in T} a_{i,j}$\uff0c\u6c42 $\\sum_{i=1}^n x^{z_i}$ \u7684 FWT \u6570\u7ec4\uff0c\u5b83\u7684\u8fd9\u4e00\u9879\u662f\u4ec0\u4e48\u6837\u5b50\u3002\n\n\u8003\u8651 $|T| = 1$ \u65f6\uff0c\u5f53\u7136\u662f $\\sum \\pm c_i$ \u8fd9\u6837\u7684\u5f62\u5f0f\u3002\u5177\u4f53\u5730\uff0c\u5982\u679c $T$ \u4e2d\u552f\u4e00\u7684\u5143\u7d20\u4e3a $j$\uff0c\u90a3\u4e48\u5bf9\u4e8e\u4e8c\u8fdb\u5236\u4e0b\u7b2c $j$ \u4f4d\u4e3a $1$ \u7684 $i$\uff0c$c_i$ \u524d\u9762\u7684\u7cfb\u6570\u662f $-1$\uff0c\u5426\u5219\u662f $1$\u3002\uff08\u76f8\u5f53\u4e8e\u4f60\u53ea\u4fdd\u7559\u4e00\u9879\u7684\u7cfb\u6570\u505a FWT\uff0c\u770b\u8fd9\u4e00\u9879\u7684\u7cfb\u6570\u7684\u5f71\u54cd\uff09\u3002\n\n\u5f53 $|T| > 1$ \u65f6\uff0c\u90a3\u5176\u5b9e $x^{z_i} = \\prod_{j \\in T} x^{a_{i,j}}$\uff0cFWT \u6570\u7ec4\u7684\u8fd9\u4e00\u9879\u5373\u4e3a\u6240\u6709\u5143\u7d20\u5404\u81ea\u7684 FWT \u6570\u7ec4\uff08\u4e0a\u9762\u4e00\u79cd\u60c5\u51b5\uff09\u8fd9\u4e00\u9879\u7684\u4e58\u79ef\u3002\u56e0\u6b64\u8fd9\u65f6\u5019 $c_i$ \u524d\u9762\u7684\u7cfb\u6570\u4f9d\u7136\u662f $\\pm 1$\uff0c\u5177\u4f53\u5730\uff0c\u53ef\u4ee5\u53d1\u73b0\uff0c\u82e5\u628a $T$ \u4e5f\u5199\u6210\u957f\u4e3a $k$ \u7684\u4e8c\u8fdb\u5236\u6570 $t$\uff0c$c_i$ \u524d\u9762\u7684\u7cfb\u6570\u5b9e\u9645\u4e0a\u662f $(-1)^{|t \\operatorname{and} i|}$\u3002\uff08\u53ea\u6709\u90fd\u662f $1$ \u7684\u4f4d\u7f6e\u4f1a\u4e58\u4e00\u4e2a $-1$\uff09\n\n\u654f\u9510\u7684\u8bfb\u8005\u6b64\u65f6\u5e94\u8be5\u5df2\u7ecf\u610f\u8bc6\u5230\u4e86\uff0c\u8fd9\u6b63\u662f FWT \u7684\u7cfb\u6570\u3002\u5373\uff0c\u82e5\u6c42\u51fa $H_t$ \u8868\u793a\u5bf9\u4e8e\u4e8c\u8fdb\u5236\u8868\u793a\u4e3a $t$ \u7684\u96c6\u5408 $T$ \uff0c$\\sum_{i=1}^n x^{z_i}$ \u7684 FWT \u6570\u7ec4\u7684\u8fd9\u4e00\u9879\uff0c\u4ee4\u4eba\u610f\u5916\u5730\uff0c $H$ \u5c31\u662f $c_0,c_1 \\ldots c_{2^k - 1}$ \u8fdb\u884c FWT \u4e4b\u540e\u5f97\u5230\u7684\u6570\u7ec4\u3002\u73b0\u5728\u6211\u4eec\u8981\u6c42 $c$\uff0c\u53ea\u9700\u628a $H$ \u9006\u53d8\u6362\u56de\u53bb\u5c31\u884c\u4e86\u3002\u603b\u590d\u6742\u5ea6 $O(n2^k + (m + k)2^{m + k})$\u3002\n\n\u4e0b\u9762\u662f\u6211\u7684\u4ee3\u7801\u5b9e\u73b0\u3002\u5c06 $k$ \u8bbe\u4e3a $2$ \u548c $3$\uff0c\u7565\u52a0\u4fee\u6539\u8f93\u5165\u683c\u5f0f\u5373\u53ef\u76f4\u63a5\u901a\u8fc7\u4e0a\u9762\u63d0\u5230\u7684\u9ece\u660e\u524d\u7684\u5de7\u514b\u529b\u548c\u672c\u9898\u3002\n\n```\n#include <bits/stdc++.h>\n\nusing ll = long long;\nconst int mod = 998244353;\nconst int inv2 = (mod + 1) / 2;\nconst int maxn = (1 << 20) + 12;\n\nint n,m,k,w[maxn],z[maxn][12],F[maxn],G[maxn],W[maxn],sum[maxn],lg[maxn];\n\nint qpow(int a,ll b) {\n\tif (b == 0) return 1;\n\tll d = qpow(a,b>>1); d = d * d % mod;\n\tif (b & 1) d = d * a % mod;\n\treturn d;\n}\n\nvoid DFT(int *a,int lim,int flag){\n\tfor (int i = 1; i < lim; i <<= 1)\n\tfor (int j = 0; j < lim; j += (i << 1))\n\tfor (int k = 0; k < i; ++ k) {\n\t\tll A0 = a[j+k], A1 = a[j+k+i];\n\t\ta[j+k] = (A0 + A1) % mod; a[j+k+i] = (A0 - A1 + mod) % mod;\n\t\tif (flag == -1) { \n\t\t\ta[j+k] = (ll) a[j+k] * inv2 % mod;\n\t\t\ta[j+k+i] = (ll) a[j+k+i] * inv2 % mod;\n\t\t}\n\t}\n}\n\nint main() {\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tint H[(1<<k)+10][(1<<m)+10];\n\tstd::memset(H,0,sizeof(H));\n\tfor (int i = 0; i < k; ++ i) scanf(\"%d\",&w[i]);\n\tlg[0] = -1;\n\tfor (int i = 0; i < (1 << k); ++ i) {\n\t\tif (i) lg[i] = lg[i/2] + 1;\n\t\tfor (int j = 0; j < k; ++ j) {\n\t\t\tif (i & (1 << j)) W[i] = (W[i] - w[j] + mod) % mod;\n\t\t\telse W[i] = (W[i] + w[j]) % mod;\n\t\t}\n\t}\n\tfor (int i = 1; i <= n; ++ i) {\n\t\tfor (int j = 0; j < k; ++ j) \n\t\t\tscanf(\"%d\",&z[i][j]); \n\t\tH[0][0] += 1;\n\t\tfor (int mask = 1; mask < (1 << k); ++ mask) {\n\t\t\tint lowbit = mask & -mask;\n\t\t\tint b = lg[lowbit];\n\t\t\tsum[mask] = sum[mask - lowbit] ^ z[i][b];\n\t\t\tH[mask][sum[mask]] += 1;\n\t\t}\n\t}\n\tfor (int mask = 0; mask < (1 << k); ++ mask)\n\t\tDFT(H[mask],(1<<m),1);\n\tfor (int i = 0; i < (1 << m); ++ i) {\n\t\tfor (int j = 0; j < (1 << k); ++ j) \n\t\t\tG[j] = H[j][i];\n\t\tDFT(G,(1<<k),-1);\n\t\tF[i] = 1;\n\t\tfor (int j = 0; j < (1 << k); ++ j) \n\t\t\tF[i] = (ll) F[i] * qpow(W[j],G[j]) % mod;\n\t} DFT(F,(1<<m),-1);\n\tfor (int i = 0; i < (1 << m); ++ i)\n\t\tprintf(\"%d \",F[i]);\n\treturn 0;\n}\n\n\n```\n\n",
        "postTime": 1617173750,
        "uid": 48355,
        "name": "EternalAlexander",
        "ccfLevel": 9,
        "title": "CF1119H Triple"
    },
    {
        "content": "[CF1119H Triple](https://www.luogu.com.cn/problem/CF1119H)\n\n\u9996\u5148\u8003\u8651\u66b4\u529b\uff0c\u6bcf\u4e2a\u6570\u7ec4\u8bbe\u7f6e\u4e00\u4e2a\u96c6\u5408\u5e42\u7ea7\u6570\uff0c\u5373\uff1a\n\n\u4ee4$F_k[a_k]=x\\quad F_k[b_k]=y\\quad F_k[c_k]=z$\n\n\u7136\u540e\u628a\u8fd9$n$\u4e2a\u5e42\u7ea7\u6570\u5f02\u6216\u5377\u79ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$\\Theta(n\\times k2^k)$\n\n\u7b80\u5355\u7684\u4f18\u5316\uff1a\u663e\u7136\u4e0d\u8981\u4e24\u4e24\u5408\u5e76\u5377\u79ef\uff0c\u53ea\u9700\u8981\u6bcf\u4e00\u4e2a\u5355\u72ec$\\rm FWT$\u540e\uff0c\u4e58\u8d77\u6765\u518d$\\rm IFWT$\u56de\u53bb\u5c31\u597d\u4e86\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4f18\u5316\u5230$\\Theta((n+k)2^k)$\n\n\u6211\u4eec\u77e5\u9053$\\rm FWT$\u7684\u7cfb\u6570$c(i,j)=(-1)^{|i\\&j|}$\uff0c\u56e0\u4e3a\u8fd9\u91cc\u6bcf\u4e2a\u5e42\u7ea7\u6570\u53ea\u6709$3$\u5904\u4f4d\u7f6e\u7684\u53d6\u503c\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa$S$\uff0c\u7136\u540e$\\rm IFWT$\u56de\u53bb\uff0c\u5176\u4e2d$S$\u4e3a\uff1a\n\n$$S[i]=\\prod_{k=1}^{n}(-1)^{|i\\&a_k|}x+(-1)^{|i\\&b_k|}y+(-1)^{|i\\&b_k|}z$$\n\n\u6ce8\u610f\u5230$n$\u5f88\u5927\uff0c\u4f46\u662f$\\_x+\\_y+\\_z$\u4e00\u5171\u53ea\u6709$8$\u79cd\u60c5\u51b5\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97\u51fa\u8fd9$8$\u79cd\u60c5\u51b5\u90fd\u51fa\u73b0\u7684\u6b21\u6570\uff0c\u7136\u540e\u5feb\u901f\u5e42\u8ba1\u7b97\n\n\u7136\u540e\u6709\u4e00\u4e2a\u975e\u5e38\u68d2\u7684\u4f18\u5316\uff1a\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5e42\u7ea7\u6570$\\{a_k,b_k,c_k\\}$\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u6bcf\u4e2a\u6570\u5148\u5f02\u6216$a_k$\uff0c\u5f97\u5230$\\{0,b_k\\oplus a_k,c_k\\oplus a_k\\}$\n\n\u6700\u540e$\\rm IFWT$\u540e\uff0c\u539f\u672c\u8981\u8ba1\u7b97\u7684\u4e0b\u6807\u4e3a$p$\uff0c\u5c31\u504f\u79fb\u5230$p\\oplus a_{1\\sim n}$\n\n\u8fd9\u65f6\u540e\u4e0a\u9762\u90a3\u4e2a\u5f0f\u5b50\uff0c\u7b2c\u4e00\u9879\u7684\u7cfb\u6570\u5c31\u786e\u5b9a\u4e3a$1$\u4e86\uff0c\u76f4\u63a5\u5c11\u4e86\u4e00\u534a\u7684\u60c5\u51b5\uff01\uff01\uff01\n\n\n\u6211\u4eec\u8bbe$w_1,w_2,w_3,w_4$\u5206\u522b\u8868\u793a\uff1a$x+y+z\\quad x+y-z\\quad x-y+z\\quad x-y-z$\u8fd9\u56db\u79cd\u60c5\u51b5\u7684\u51fa\u73b0\u6b21\u6570\uff0c\u60f3\u529e\u6cd5\u628a\u8fd9\u56db\u4e2a\u6570\u6c42\u51fa\u6765\n\n- \u9996\u5148\u6709\u7b2c\u4e00\u4e2a\u65b9\u7a0b\uff1a$w_1+w_2+w_3+w_4=n\\quad (1)$\n\n- \u53ea\u4ee4$F_k[b_k]=1$\n\n\u90a3\u4e48\u6b64\u65f6${\\rm FWT}(F_k)[i]=(-1)^{|i\\&b_k|}$\uff0c\u6240\u4ee5\uff1a\n\n$$\\sum_{k=1}^{n}{\\rm FWT}(F_k)[i]=s_1=w_1+w_2-w_3-w_4\\quad(2)$$\n\n\u4e5f\u5c31\u662f\u8003\u8651$y$\u7b26\u53f7\u7684\u8d21\u732e\uff0c\u56e0\u4e3a$S$\u4e2d\u6709\u591a\u5c11\u4e2a$y$\u662f\u7b26\u53f7\u7684\u53ea\u7531$(-1)^{|i\\&b_k|}$\u51b3\u5b9a\n\n\u6839\u636e$\\rm FWT$\u7684\u7ebf\u6027\u6027\uff0c$\\displaystyle s_1=\\sum_{k=1}^{n}{\\rm FWT}(F_k)[i]={\\rm FWT}(\\sum_{k=1}^{n}F_k)[i]$\n\n- \u53ea\u4ee4$F_k[c_k]=1$\n\n\u4eff\u7167\u4e0a\u9762\uff0c\u5f97\u5230\uff1a$s_2=w_1-w_2+w_3-w_4\\quad(3)$\n\n- \u4ee4$F_k[b_k\\oplus c_k]=1$\n\n\u90a3\u4e48\u76f8\u5f53\u4e8e\u628a\u4e0a\u9762\u4e24\u4e2a\u5e42\u7ea7\u6570\u8fdb\u884c\u5f02\u6216\u5377\u79ef\n\n$$F_{k1}(F_{k1}[b_k]=1)\\oplus F_{k2}(F_{k2}[c_k]=1)$$\n\n\u56e0\u4e3a\u8fd9\u4e24\u4e2a\u5e42\u7ea7\u6570\u90fd\u53ea\u6709\u4e00\u4e2a\u5730\u65b9\u53d6\u5230\u503c\uff0c\u5e76\u4e14\u5377\u79ef\u540e\u7684\u6570\u7ec4\u7684${\\rm FWT}$\u7b49\u4e8e\u4e24\u4e2a\u6570\u7ec4\u7684${\\rm FWT}$\u70b9\u79ef\n\n$${\\rm FWT}(F_k)[i]=(-1)^{|i\\&b_k|}(-1)^{i\\&c_k}$$\n\n\u6240\u4ee5$s_3=w_1-w_2-w_3+w_4\\quad(4)$\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u5f97\u5230\u4e86$4$\u4e2a\u65b9\u7a0b\uff0c\u7b97\u51fa$s_1,s_2,s_3$\u540e\u624b\u52a8\u89e3\u51fa\u6765\u5373\u53ef\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <string>\n#define ll long long\nusing namespace std;\nconst int N=(1<<17)+10,M=1e5+10;\nconst ll mod=998244353;\ninline ll power(ll a,ll b)\n{\n\tll res=1;\n\tfor(;b;b>>=1,a=a*a%mod)\n\t\tif(b&1) res=res*a%mod;\n\treturn res;\n}\nint lim; ll inv2=power(2,mod-2);\nll f1[N],f2[N],f3[N],ans[N];\ninline void FWT(ll *A)\n{\n\tfor(int l=1;l<lim;l<<=1)\n\t  for(int i=0;i<lim;i+=(l<<1))\n\t    for(int j=i;j<i+l;j++)\n\t\t{\n\t\t\tll tmp=A[j];\n\t\t\tA[j]=A[j]-A[j+l];\n\t\t\tA[j+l]=A[j+l]+tmp;\n\t\t}\n}\ninline void IFWT(ll *A)\n{\n\tfor(int l=1;l<lim;l<<=1)\n\t  for(int i=0;i<lim;i+=(l<<1))\n\t    for(int j=i;j<i+l;j++)\n\t    {\n\t    \tll tmp=A[j];\n\t\t\tA[j]=(A[j]*inv2%mod+A[j+l]*inv2%mod)%mod;\n\t\t\tA[j+l]=((mod-inv2)*tmp+A[j+l]*inv2)%mod;\n\t\t}\n}\nint a[M],b[M],c[M];\nint main()\n{\n\tint n,tmp=0; ll x,y,z;\n\tscanf(\"%d%d%lld%lld%lld\",&n,&lim,&x,&y,&z);\n\tlim=(1<<lim);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d%d%d\",&a[i],&b[i],&c[i]);\n\t\tb[i]^=a[i],c[i]^=a[i],tmp^=a[i];\n\t\tf1[b[i]]++,f2[c[i]]++,f3[b[i]^c[i]]++;\n\t}\n\tFWT(f1),FWT(f2),FWT(f3);\n\tfor(int i=0;i<lim;i++)\n\t{\n\t\tll w1,w2,w3,w4;\n\t\tw1=(n+f1[i]+f2[i]+f3[i])/4; w2=(n+f1[i]-f2[i]-f3[i])/4;\n\t\tw3=(n+f2[i]-f1[i]-f3[i])/4; w4=(n+f3[i]-f1[i]-f2[i])/4;\n\t\tans[i]=power(x+y+z,w1)*power(x+y-z,w2)%mod*power(x-y+z,w3)%mod*power(x-y-z,w4)%mod;\n\t\tans[i]=(ans[i]%mod+mod)%mod;\n\t}\n\tIFWT(ans);\n\tfor(int i=0;i<lim;i++) printf(\"%lld \",ans[i^tmp]);\n\treturn 0;\n}\n```\n",
        "postTime": 1615968920,
        "uid": 81238,
        "name": "MCAdam",
        "ccfLevel": 7,
        "title": "CF1119H Triple"
    },
    {
        "content": "[\u539f\u9898\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF1119H)\n\n## \u9898\u76ee\u5927\u610f\n\n\u7ed9\u5b9a\u51e0\u4e2a\u6570\uff1a$n$\uff0c$t$\uff0c$x$\uff0c$y$\uff0c$z$ \u6ee1\u8db3 \u503c\u57df$\\leq2^t$\u3002\u7ed9\u51fa $n$ \u4e2a\u4e09\u5143\u7ec4 $(a_i, b_i, c_i)$\uff0c\u8868\u793a\u6709 $x$ \u4e2a $a_i$\uff0c$y$ \u4e2a $b_i$\uff0c$z$ \u4e2a $c_i$\u3002\u5bf9\u4e8e\u6bcf\u4e2a $k \\in [0, 2^t-1]$\uff0c\u8bf7\u6c42\u51fa\u4ece\u6bcf\u7ec4\u9009\u51fa\u4e00\u4e2a\u6570\u7684\u5f02\u6216\u548c\u4e3a $k$ \u7684\u65b9\u6848\u6570\u3002\n\n\n\n## \u601d\u8def\n\n\u6211\u4eec\u5b9a\u4e49 $[\\delta^n]F(\\delta)$ \u8868\u793a\u591a\u9879\u5f0f $F$ \u7684\u7b2c $n$ \u4f4d\u7cfb\u6570\u3002\n\n>   Tips: \u8fd9\u9053\u9898\u7528\u5230\u4e86 $\\text{FWT}$\uff0c\u4e0d\u4f1a\u7684\u7ae5\u978b\u53ef\u4ee5\u5148\u53bb\u5b66\u4e60\u4e00\u4e0b\u3002\n\n\u5982\u679c\u5bf9\u6bcf\u4e2a\u4e09\u5143\u7ec4\u521b\u5efa\u4e00\u4e2a**\u751f\u6210\u51fd\u6570**\uff1a$F_i(\\delta)=x\\delta^{a_i}+y\\delta^{b_i}+z\\delta^{c_i}$\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e $k$ \u7684\u8be2\u95ee\u7b54\u6848\u5c31\u5e94\u5f53\u662f\uff1a\n\n$$[\\delta^k]\u220f_{i=1}^{n}F_i(\\delta)$$\n\n\u8fd9\u91cc\u6211\u4eec\u7684\u5f02\u6216\u5377\u79ef\u7528\u4e58\u6cd5\u8868\u793a\uff0c\u5373 $[\\delta^n]F(\\delta)G(\\delta)=\\sum_{i\u2297j=n}F(\\delta)[\\delta^j]G(\\delta)$\u3002\n\n\u53ef\u4ee5\u770b\u51fa\u6765\uff0c\u4e0a\u9762\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u4f7f\u7528 $\\text{FWT}$ \u8fdb\u884c\u4f18\u5316\uff0c\u4f46\u662f $\u0398{(nk2^k)}$\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u663e\u7136\u901a\u8fc7\u4e0d\u4e86\u8fd9\u9053\u9898\u3002\n\n\u4f46\u662f\u8fd9\u9053\u9898\u5341\u5206\u7279\u6b8a\uff0c\u56e0\u4e3a\u6bcf\u4e2a\u591a\u9879\u5f0f\u53ea\u6709 $3$ \u4e2a\u70b9\u6709\u503c\u3002\u4e8e\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5728 $\\text{FWT}$ \u7684\u8fc7\u7a0b\u4e2d\u8fdb\u884c\u4f18\u5316\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5230\uff0c\u5bf9\u4e8e $[\\delta^i]\\text{FWT}(F_n)$ \u6709\uff1a\n\n$$[\\delta^i]\\text{FWT}(F_n)=(-1)^{\\text{cnt}(i\u2227a_n)}x + (-1)^{\\text{cnt}(i\u2227b_n)}y + (-1)^{\\text{cnt}(i\u2227c_n)}z$$\n\n\u5176\u4e2d\uff0c\u6211\u5b9a\u4e49 $\\text{cnt}(i)$ \u8868\u793a $i$ \u5728\u4e8c\u8fdb\u5236\u4e0b $1$ \u7684\u4e2a\u6570\u3002\n\n\u5982\u679c\u6309\u4e0a\u8ff0\u65b9\u6cd5\u6784\u9020\u7684\u8bdd\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\u0398{((n+k)2^k)}$\uff0c\u4ecd\u7136\u65e0\u6cd5\u901a\u8fc7\u6b64\u9898\uff08\u5361\u5e38\u5927\u795e\u53ef\u4ee5\u5c1d\u8bd5\u4e00\u4e0b\uff09\u3002\u4e8e\u662f\u4e0b\u9762\u8003\u8651\u7ee7\u7eed\u8fdb\u884c\u4f18\u5316\uff1a\n\n\u200b\t\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u5bf9\u4e8e $[\\delta^i]\\text{FWT}(F_n)$\uff0c\u5b83\u7684\u503c\u53ea\u6709 $8$ \u4e2d\u53ef\u80fd\uff0c\u5373\uff1a$x \\pm y \\pm z$\uff0c$x \\pm y \\mp z$\u3002\u4e8e\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97\u5bf9\u4e8e $[\\delta^i]\u220f\\text{FWT}(F_n)$ \u6bcf\u4e00\u79cd\u5206\u522b\u51fa\u73b0\u4e86\u591a\u5c11\u6b21\uff0c\u4e4b\u540e `qpow` \u5373\u53ef\u3002\n\n\u200b\t\u4f46\u662f $8$ \u79cd\u663e\u7136\u592a\u591a\u4e86\uff0c\u7c7b\u4f3c\u4e8e\u5e38\u6570\u4f18\u5316\uff0c\u6211\u5c06\u5728\u4e0b\u9762\u7684\u4e00\u6bb5\u63cf\u8ff0\u628a $8$ \u53d8\u4e3a $4$ \u7684\u5173\u952e\u6027\u4f18\u5316\uff08\u8fd9\u529b\u5ea6\u8ddf\u7531\u4e43\u6709\u4e00\u62fc\u554a\uff09\uff1a\n\n>   \u901a\u8fc7\u628a\u4e00\u4e2a\u4e09\u5143\u7ec4 $(a_i, b_i, c_i)$ \u53d8\u4e3a $(0, b_i\u2297a_i, c_i\u2297a_i)$\uff0c\u7b54\u6848\u5f02\u6216 $\u2297_{i=1}^n{a_i}$ \uff0c\u4ecd\u6b63\u786e\uff01\n\n\u200b\t\u73b0\u5728\u6211\u4eec\u53ea\u6709 $4$ \u79cd\u4e0d\u540c\u7684\u53d6\u503c\u5566\uff01\u4e3a\u4e86\u65b9\u4fbf\uff0c\u4ee4 $S = \u220f_{i=1}^n \\text{FWT}(F_i)$\u3002\u8fd9\u91cc\u7684\u4e58\u6cd5\u5c31\u662f $[\\delta^i]F(\\delta)G(\\delta) = [\\delta^i]F(\\delta)[\\delta^i]G(\\delta)$\u3002\u6211\u4eec\u5bf9\u4e8e $[\\delta^i]S$ \u53ef\u4ee5\u8bbe $t_1, t_2, t_3, t_3$ \u8868\u793a\uff1a\n\n$$[\\delta^i]S = (x+y+z)^{t_1} \\times (x+y-z)^{t_2} \\times (x-y+z)^{t_3} \\times (x-y-z)^{t_4}$$\n\n\u200b\t\u4e8e\u662f\uff0c\u6211\u4eec\u7684\u76ee\u6807\u5c31\u662f\u901a\u8fc7\u8bbe\u51fa $4$ \u4e2a**\u672c\u8d28\u4e0d\u540c**\u7684\u4e00\u6b21\u65b9\u7a0b\u89e3\u5f97 $t_1, t_2, t_3, t_4$\u3002\n\n\u200b\t\u9996\u5148\uff0c\u663e\u7136\u6709\uff1a\n\n$$t_1+t_2+t_3+t_4=n\\space\\space\\space\\space\\space(1)$$\n\n\u200b\t\u7136\u540e\u6211\u4eec\u4f1a\u53d1\u73b0 $t_1,t_2, t_3, t_4$ \u4e0e $x, y, z$ \u5176\u5b9e\u4e00\u70b9\u5173\u7cfb\u90fd\u6ca1\u6709\uff0c\u4e8e\u662f\u60f3\u5230\u5e26\u5165\u7279\u6b8a\u503c\u7684\u65b9\u6cd5\u6c42\u51fa $t_1, t_2, t_3, t_4$\u3002\n* $x=0,y=1,z=0$\n\t\n    \u53ef\u4ee5\u5f97\u5230\uff1a\n$$\\sum_{j=1}^{n}\\text{FWT}(F_j)[\\delta^i]=p_1=t_1+t_2-t_3-t_4\\space\\space\\space\\space\\space(2)$$\n\n* $x=0,y=0,z=1$\n\t\n    \u7c7b\u4f3c\u7684\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n$$\\sum_{j=1}^{n}\\text{FWT}(F_j)[\\delta^i]=p_2=t_1-t_2+t_3-t_4\\space\\space\\space\\space\\space(3)$$\n\n\u200b\t~~\u7ecf\u8fc7\u4e00\u756a\u601d\u8003\u540e\uff0c~~ \u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u6211\u4eec\u6b64\u65f6\u53ea\u6709 $3$ \u4e2a\u65b9\u7a0b\uff0c\u4f46\u662f\u6709 $4$ \u4e2a\u672a\u77e5\u6570\uff0c\u663e\u7136\u662f\u4e0d\u591f\u6ef4\u3002\n\n> \u86e4\uff1f\u4f60\u8bf4 $x=1,y=0,z=0$\uff1f\u5b83\u4e0e $(1)$ \u7684\u672c\u8d28\u662f\u76f8\u540c\u6ef4\u3002\n\n\u200b\t\u4e8e\u662f\uff0c\u5927\u5f00\u8111\u6d1e ~~\uff0c\u5988\u54aa\u5988\u54aa\u54c4~~\uff1a\n$[\\delta^{b_j\u2297c_j}]F(\\delta)=1$\u3002\n\n\u200b\t\u6211\u4eec\u53d1\u73b0\u8fd9\u79cd\u60c5\u51b5\u5176\u5b9e\u5c31\u662f\u524d\u9762\u4e24\u79cd\u60c5\u51b5\u7684\u5377\u79ef\uff0c~~\u4e0d\u96be~~\u5f97\u5230\uff1a\n$$[\\delta^i]\\text{FWT}(F_j) = (-1)^{\\text{cnt}(i\u2227b_j)}(-1)^{\\text{cnt}(i\u2227c_j)}$$\n\u200b\t\u7ecf\u8fc7~~\u7b80\u5355\u7684~~\u5316\u7b80\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u5dee\u7684\u90a3\u4e00\u4e2a\u65b9\u7a0b\uff1a\n$$\\sum_{j=1}^{n}\\text{FWT}(F_j)[\\delta^i]=p_3=t_1-t_2-t_3+t_4\\space\\space\\space\\space\\space(4)$$\n\n\u6574\u7406\u4e00\u4e0b\u4e0a\u9762\u7684\u8fc7\u7a0b\uff0c\u5f97\u5230\u65b9\u7a0b\u7ec4\uff1a\n$$\\left\\{ \\begin{aligned}t_1+t_2+t_3+t_4&=n\\\\t_1+t_2-t_3-t_4&=p_1\\\\t_1-t_2+t_3-t_4&=p_2\\\\t_1-t_2-t_3+t_4&=p_3\\end{aligned} \\right.$$\n$$\u21d2\\left\\{ \\begin{aligned}t_1&=\\frac{n+p_1+p_2+p_3}{4}\\\\t_i&=\\frac{n+p_i-2t_1}{2}(i\\in{2,3,4})\\end{aligned} \\right.$$\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5728 $\u0398{(n+k2^k)}$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e0b\u89e3\u51b3\u8be5\u95ee\u9898\u5566\u3002\n\n## \u53c2\u8003~~\u7684~~\u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define inv2 499122177\n#define mod 998244353\n#define int long long\n\ntemplate <typename T> inline void read (T &t){t = 0;char c = getchar();int f = 1;while (c < '0' || c > '9'){if (c == '-') f = -f;c = getchar();}while (c >= '0' && c <= '9'){t = (t << 3) + (t << 1) + c - '0';c = getchar();} t *= f;}\ntemplate <typename T,typename ... Args> inline void read (T &t,Args&... args){read (t);read (args...);}\ntemplate <typename T> inline void write (T x){if (x < 0){x = -x;putchar ('-');}if (x > 9) write (x / 10);putchar (x % 10 + '0');}\n\ninline int quick_pow(int a,int b)\n{\n\tint res = 1;\n\twhile (b)\n\t{\n\t\tif (b & 1) res = res * a % mod;\n\t\ta = a * a % mod;\n\t\tb >>= 1;\n\t}\n\treturn res;\n}\ninline int inv (int x){return quick_pow(x,mod - 2);} // \u8d39\u9a6c\u6c42\u9006\u5143\n\nint n,t,lim,f[1 << 17],p1[1 << 17],p2[1 << 17],p3[1 << 17];\n\nvoid FWT(int *a)\n{\n\tfor (int i = 1; i < lim; i <<= 1)\n\t\tfor (int j = 0; j < lim; j += i << 1)\n\t\t\tfor (int k = 0; k < i; ++ k)\n\t\t\t{\n\t\t\t\tint x = a[j + k],y = a[j + k + i];\n\t\t\t\ta[j + k] = x + y,a[i + j + k] = x - y;\n\t\t\t}\n}\n\nvoid IFWT(int *a)\n{\n\tfor (int i = 1; i < lim; i <<= 1)\n\t\tfor (int j = 0; j < lim; j += i << 1)\n\t\t\tfor (int k = 0; k < i; ++ k)\n\t\t\t{\n\t\t\t\tint x = a[j + k],y = a[j + k + i];\n\t\t\t\ta[j + k] = (x + y) * inv2 % mod,a[i + j + k] = (x + mod - y) * inv2 % mod;\n\t\t\t}\n}\n// \u4e0a\u9762\u4fe9\u662f\u6a21\u677f, \u6ca1\u5565\u8bb2\u7684\n\nsigned main()\n{\n\tread(n,t), lim = 1 << t;\n    int x,y,z,sta = 0;\n    read(x,y,z);\n\tfor (int i = 1,a,b,c;i <= n;++ i) read(a,b,c), sta ^= a,b ^= a,c ^= a, ++p1[b], ++p2[c], ++p3[b ^ c];\n\tFWT(p1), FWT(p2), FWT(p3);\n\tint s1 = (x + y + z) % mod, s2 = (x + y - z) % mod, s3 = (x - y + z) % mod, s4 = (x - y - z) % mod;\n\tfor(int i = 0;i < lim;++ i)\n\t{\n\t\tint t1 = (n + p1[i] + p2[i] + p3[i]) / 4;// \u6700\u91cd\u8981\u7684t1\n\t\tf[i] = quick_pow (s1,t1) * \n\t\t\t   quick_pow (s2,(n + p1[i] - t1 * 2) / 2) % mod * \n\t\t\t   quick_pow (s3,(n + p2[i] - t1 * 2) / 2) % mod * \n\t\t\t   quick_pow (s4,(n + p3[i] - t1 * 2) / 2) % mod;\n\t}\n\tIFWT(f);\n\tfor(int i = 0;i < lim;++ i) write((f[i ^ sta] + mod) % mod), putchar (' ');\n\tputchar ('\\n');\n\treturn 0;\n}\n```",
        "postTime": 1635161567,
        "uid": 344700,
        "name": "calabash_love_hmz",
        "ccfLevel": 6,
        "title": "CF1119H Triple \u9898\u89e3"
    },
    {
        "content": "[Codeforces \u9898\u76ee\u4f20\u9001\u95e8](https://codeforces.com/contest/1119/problem/H) & [\u6d1b\u8c37\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF1119H)\n\nFWT \u7684 immortal tea %%%\n\n\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u4e00\u4e2a\u6734\u7d20\u7684 $dp$\uff0c\u8bbe $dp_{i,j}$ \u8868\u793a\u8003\u8651\u524d $i$ \u4e2a\u4e09\u5143\u7ec4\u4e2d\u53d6\u6570\u5f02\u6216\u548c\u4e3a $j$ \u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u663e\u7136\u6709 $dp_{i,j}=Xdp_{i-1,j\\oplus a_i}+Ydp_{i-1,j\\oplus b_i}+Zdp_{i-1,j\\oplus c_i}$\uff0c\u8fd9\u6837\u66b4\u529b\u590d\u6742\u5ea6\u662f $n2^k$ \u7684\uff0c\u65e0\u6cd5\u901a\u8fc7\u3002\n\n\u8003\u8651\u4f18\u5316\uff0c\u4e0d\u96be\u53d1\u73b0\u8fd9\u4e2a $dp$ \u662f\u4e00\u4e2a\u5f02\u6216\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u4e0b\u8bb0 $\\times$ \u4e3a\u5e42\u7ea7\u6570\u4e4b\u95f4\u7684\u5f02\u6216\u5377\u79ef\u64cd\u4f5c\uff0c\u8003\u8651\u5e42\u7ea7\u6570 $f_i$ \u4e3a\u6ee1\u8db3 $[x^{a_i}]f_i=X,[x^{b_i}]f_i=Y,[x^{c_i}]=Z$\uff0c\u5176\u4f59\u5404\u9879\u7cfb\u6570\u5747\u4e3a $0$ \u7684\u5e42\u7ea7\u6570\uff0c\u90a3\u4e48\u4e0d\u96be\u53d1\u73b0 $dp_{i-1}\\times f_i=dp_i$ \u6210\u7acb\uff0c\u4f46\u662f\u5982\u679c\u786c\u8981 FWT \u4f18\u5316\uff0c\u628a\u6240\u6709\u5e42\u7ea7\u6570\u90fd\u641e\u4e00\u904d FWTxor \u7136\u540e\u4e58\u8d77\u6765\uff0c\u590d\u6742\u5ea6\u4f1a\u9ad8\u8fbe $nk2^k$\uff0c\u53cd\u800c\u8dd1\u4e0d\u8fc7\u66b4\u529b\u3002\n\n\u90a3\u4e48\u6211\u4eec\u8fd9\u4e2a\u60f3\u6cd5\u6709\u6ca1\u6709\u524d\u9014\u5462\uff1f\u4e0d\u96be\u53d1\u73b0\u6211\u4eec\u8fd9\u4e2a\u5e42\u7ea7\u6570\u5f88\u7279\u6b8a\uff0c\u53ea\u6709\u4e09\u9879\u6709\u503c\uff0c\u5176\u4f59\u9879\u90fd\u662f $0$\uff0c\u5e76\u4e14\u8fd9\u4e09\u9879\u7684\u503c\u8fd8\u662f\u5bf9\u4e8e\u6240\u6709\u5e42\u7ea7\u6570\u90fd\u76f8\u540c\u7684 $X,Y,Z$\uff0c\u8003\u8651\u4ee5\u6b64\u4e3a\u7a81\u7834\u53e3\u3002\u8bb0 $\\hat{A}$ \u4e3a\u5e42\u7ea7\u6570 $A$ \u7684 FWTxor\uff0c\u6211\u4eec\u4e0d\u59a8\u6765\u5bf9\u4e8e\u67d0\u4e2a $i\\in[1,n]$\uff0c$\\hat{f_i}$ \u6709\u4ec0\u4e48\u6027\u8d28\uff0c\u663e\u7136\u6839\u636e FWTxor \u7684\u6c42\u6cd5 $[x^j]\\hat{f_i}=(-1)^{|j\\cap a_i|}X+(-1)^{|j\\cap b_i|}Y+(-1)^{|j\\cap c_i|}Z$\uff0c\u4e5f\u5c31\u662f\u8bf4 $\\hat{f_i}$ \u7684\u6bcf\u4e00\u9879\u603b\u5171\u6709 $2^3=8$ \u79cd\u53ef\u80fd\uff0c\u8fd9\u6837\u5206\u7c7b\u8ba8\u8bba\u8fd8\u662f\u6709\u70b9\u70e6\uff0c\u8fd9\u91cc\u6709\u4e00\u4e2a\u5c0f\u5c0f\u7684\u51cf\u5c11\u5206\u7c7b\u8ba8\u8bba\u7684\u6280\u5de7\uff0c\u8003\u8651\u8bb0 $S=\\operatorname{xor}\\limits_{i=1}^na_i$\uff0c\u6211\u4eec\u4ee4 $b_i\\leftarrow b_i\\oplus a_i,c_i\\leftarrow c_i\\oplus a_i,a_i\\leftarrow 0$\uff0c\u4e0d\u96be\u53d1\u73b0\u7ecf\u8fc7\u8fd9\u4e2a\u8f6c\u5316\u4e4b\u540e\uff0c\u771f\u6b63\u7684 $ans_i=ans_{i\\oplus S}$\uff0c\u4e0d\u8fc7\u8fd9\u6837 $X$ \u524d\u7684\u7cfb\u6570 $(-1)^{|j\\cap a_i|}$ \u5c31\u6052\u4e3a $1$ \u4e86\uff0c\u8fd9\u6837\u5c31\u53ea\u6709 $4$ \u79cd\u60c5\u51b5\u4e86\uff0c\u5217\u4e00\u4e0b\u5206\u522b\u662f $X+Y+Z,X+Y-Z,X-Y+Z,X-Y-Z$\uff0c\u5982\u679c\u6211\u4eec\u77e5\u9053\u8fd9\u56db\u79cd\u60c5\u51b5\u5206\u522b\u51fa\u73b0\u7684\u6b21\u6570\u5c31\u53ef\u4ee5\u5feb\u901f\u5e42\u6c42\u51fa $\\widehat{f_1\\times f_2\\times\\cdots\\times f_n}$ \u524d\u7684\u7cfb\u6570\u4e86\uff0c\u518d IFWTxor \u4e00\u904d\u5373\u53ef\u6c42\u51fa $ans$\uff0c\u5177\u4f53\u6765\u8bf4\u6211\u4eec\u8bb0 $p_j$ \u4e3a\u6709\u591a\u5c11\u4e2a $i$ \u6ee1\u8db3 $[x^j]\\hat{f_i}=X+Y+Z$\uff0c\u4e5f\u7c7b\u4f3c\u5730\u5b9a\u4e49\u4e86 $q_i$ \u4e3a $X+Y-Z$ \u7684\u4e2a\u6570\uff0c$r_i$ \u4e3a $X-Y+Z$ \u7684\u4e2a\u6570\uff0c$s_i$ \u4e3a $X-Y-Z$ \u7684\u4e2a\u6570\uff0c\u90a3\u4e48 $[x^j]\\widehat{f_1\\times f_2\\times\\cdots\\times f_n}=(X+Y+Z)^{p_i}\\times(X+Y-Z)^{q_i}\\times(X-Y+Z)^{r_i}\\times(X-Y-Z)^{s_i}$\u3002\n\n\u4e8e\u662f\u73b0\u5728\u95ee\u9898\u5c31\u53d8\u4e3a\u600e\u6837\u6c42 $p_j,q_j,r_j,s_j$\uff0c\u9996\u5148\u6709\u4e00\u4e2a\u663e\u7136\u7684\u65b9\u7a0b $p_j+q_j+r_j+s_j=n$\uff0c\u56e0\u4e3a\u6bcf\u4e2a $[x^j]\\hat{f_i}$ \u90fd\u662f\u8fd9\u56db\u79cd\u60c5\u51b5\u4e4b\u4e00\uff0c\u4e0d\u8fc7\u53ea\u6709\u8fd9\u4e00\u4e2a\u65b9\u7a0b\u662f\u663e\u7136\u4e0d\u591f\u7684\uff0c\u8003\u8651\u8bb0 $t_j=\\sum\\limits_{i=1}^n(-1)^{|j\\cap b_i|}$\uff0c\u90a3\u4e48\u663e\u7136 $t_j=p_j+q_j-r_j-s_j$\uff0c\u56e0\u4e3a\u6bcf\u4e2a $X+Y+Z,X+Y-Z$ \u90fd\u4f1a\u5bf9\u5176\u4ea7\u751f $+1$ \u7684\u8d21\u732e\uff0c\u800c\u6bcf\u4e2a $X-Y+Z,X-Y-Z$ \u90fd\u4f1a\u5bf9\u5176\u4ea7\u751f $-1$ \u7684\u8d21\u732e\uff0c\u53e6\u4e00\u65b9\u9762\uff0c\u5982\u679c\u6211\u4eec\u8bb0 $c1_j$ \u4e3a $\\sum\\limits_{i=1}^n[j=b_i]$\uff0c\u90a3\u4e48 $t_j=\\sum\\limits_{k}c1_k(-1)^{|j\\cap k|}$\uff0c\u8fd9\u5e94\u8be5\u5f88\u597d\u7406\u89e3\uff0c\u7136\u540e\u5bf9 FWT \u7a0d\u5fae\u654f\u611f\u4e00\u4e9b\u7684\u540c\u5b66\u5c31\u80fd\u53d1\u73b0\uff0c\u8fd9\u4e0d\u5c31 $\\hat{c1}$ \u5417\uff0c\u6545\u6211\u4eec\u6709\u4e86\u7b2c\u4e8c\u4e2a\u65b9\u7a0b $p_j+q_j-r_j-s_j=\\hat{c1}_j$\uff0c\u7c7b\u4f3c\u5730\uff0c\u5982\u679c\u6211\u4eec\u8bb0 $c2_j$ \u4e3a $\\sum\\limits_{i=1}^n[j=c_i]$\uff0c$c3_j$ \u4e3a $\\sum\\limits_{i=1}^n[j=b_i\\oplus c_i]$\uff0c\u90a3\u4e48 $p_j-q_j+r_j-s_j=\\hat{c2}_j,p_j-q_j-r_j+s_j=\\hat{c3}_j$\uff0c\u63a8\u5bfc\u8fc7\u7a0b\u7c7b\u4f3c\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u8d58\u8ff0\u4e86\uff0c\u56e0\u6b64\u6211\u4eec\u6709\uff1a\n$$\n\\begin{cases}\np_j+q_j+r_j+s_j=n\\\\\np_j+q_j-r_j-s_j=\\hat{c1}_j\\\\\np_j-q_j+r_j-s_j=\\hat{c2}_j\\\\\np_j-q_j-r_j+s_j=\\hat{c3}_j\n\\end{cases}\n$$\n\u56db\u4e2a\u672a\u77e5\u6570\u56db\u4e2a\u65b9\u7a0b\uff0c\u628a\u5b83\u89e3\u51fa\u6765\u5373\u53ef\uff0c$\\hat{c1},\\hat{c2},\\hat{c3}$ \u663e\u7136\u53ef\u4ee5\u5728 $k2^k$ \u7684\u65f6\u95f4\u5185\u6c42\u51fa\uff0c\u56e0\u6b64\u603b\u590d\u6742\u5ea6 $n+k2^k$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\n\n```cpp\nconst int MAXN=1<<17;\nconst int MOD=998244353;\nconst int INV2=499122177;\nint n,k,x,y,z,ans[MAXN+5],c1[MAXN+5],c2[MAXN+5],c3[MAXN+5];\nint qpow(int x,int e){\n\tint ret=1;\n\tfor(;e;e>>=1,x=1ll*x*x%MOD) if(e&1) ret=1ll*ret*x%MOD;\n\treturn ret;\n}\nvoid FWTxor(int *a,int len,int type){\n\tfor(int i=2;i<=len;i<<=1)\n\t\tfor(int j=0;j<len;j+=i)\n\t\t\tfor(int k=0;k<(i>>1);k++){\n\t\t\t\tint X=a[j+k],Y=a[(i>>1)+j+k];\n\t\t\t\tif(type==1) a[j+k]=X+Y,a[(i>>1)+j+k]=X-Y;\n\t\t\t\telse a[j+k]=1ll*(X+Y)*INV2%MOD,a[(i>>1)+j+k]=1ll*(X-Y+MOD)*INV2%MOD;\n\t\t\t}\n}\nint main(){\n\tscanf(\"%d%d\",&n,&k);int xsum=0;\n\tscanf(\"%d%d%d\",&x,&y,&z);\n\tfor(int i=1,a,b,c;i<=n;i++){\n\t\tscanf(\"%d%d%d\",&a,&b,&c);b^=a;c^=a;xsum^=a;\n\t\tc1[b]++;c2[c]++;c3[b^c]++;\n\t}\n\tFWTxor(c1,1<<k,1);FWTxor(c2,1<<k,1);FWTxor(c3,1<<k,1);\n\tfor(int i=0;i<(1<<k);i++){\n\t\tint w1=(n+c1[i]+c2[i]+c3[i])/4;\n\t\tint w2=(n+c1[i]-c2[i]-c3[i])/4;\n\t\tint w3=(n-c1[i]+c2[i]-c3[i])/4;\n\t\tint w4=(n-c1[i]-c2[i]+c3[i])/4;\n//\t\tprintf(\"%d %d %d\\n\",c1[i],c2[i],c3[i]);\n//\t\tprintf(\"%d %d %d %d\\n\",w1,w2,w3,w4);\n\t\tans[i]=1ll*qpow((x+y)%MOD+z,w1)*qpow(x+y-z,w2)%MOD*\n\t\tqpow(x-y+z,w3)%MOD*qpow(x-y-z,w4)%MOD;\n\t\tif(ans[i]<0) ans[i]+=MOD;\n\t} FWTxor(ans,1<<k,-1);\n\tfor(int i=0;i<(1<<k);i++) printf(\"%d \",ans[i^xsum]);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1618671036,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1119H Triple"
    },
    {
        "content": "### P.S.\n\u524d\u7f6e\u77e5\u8bc6\uff1a[FWT](https://www.luogu.com.cn/blog/xht37/solution-p4717)  \nupd\uff1a\u6539\u4e86\u90e8\u5206\u7ba1\u7406\u5458\u6307\u51fa\u95ee\u9898\u7684 $\\LaTeX$ ![](//xn--9zr.tk/qq)\n### Description.\n\u7ed9\u5b9a\u4e00\u4e2a\u5143\u7d20\u4e3a\u5e8f\u5217\u7684\u5e8f\u5217\uff0c\u6bcf\u4e2a\u5e8f\u5217\u7531 $X$ \u4e2a $a_i$\uff0c$Y$ \u4e2a $b_i$ \u548c $Z$ \u4e2a $c_i$ \u6784\u6210\u3002  \n\u73b0\u5728\u95ee\u4ece\u5927\u5e8f\u5217\u4e2d\u6bcf\u4e00\u4f4d\u53d6\u51fa\u4e00\u4e2a\u5143\u7d20\uff0c$\\oplus$ \u503c\u4e3a $t(t\\in[0,2^k])$ \u7684\u65b9\u6848\u6570\u3002  \n\n### Solution.\n\u9996\u5148\uff0c\u6709\u4e2a $O(n\\times k\\times 2^k)$ \u7684\u505a\u6cd5\uff0c\u5c31\u662f\u8003\u8651\u7c7b\u4f3c\u751f\u6210\u51fd\u6570\u4e00\u6837\u3002  \n\u6bcf\u4e2a\u5c0f\u5e8f\u5217\u7684\u751f\u6210\u51fd\u6570\u4e3a $Xx^{a_i}+Yx^{b_i}+Zx^{c_i}$\u3002  \n\u7136\u540e\u628a\u8fd9\u4e9b\u751f\u6210\u51fd\u6570 $\\oplus$ \u5377\u79ef\u5373\u4e3a\u7b54\u6848\u3002  \n\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u9700\u8981\u5feb\u901f\u8ba1\u7b97 $n$ \u4e2a\u591a\u9879\u5f0f\u7684 FWT\u3002  \n\u4f46\u662f\u8fd9\u4e2a\u6211\u4e0d\u4f1a\u554a\uff1f\u6ca1\u4e8b\uff0c\u7b49 @$\\text{z}\\color{red}\\text{kdxl}$ kai\u961f\u660e\u5e74\u53d1\u8bba\u6587\u5c31\u597d\u4e86 ![](//xn--9zr.tk/cy)  \n\n\u8fd9\u4e2a FWT \u80af\u5b9a\u65e0\u6cd5\u7ee7\u7eed\u4f18\u5316\u4e86\uff0c\u6211\u4eec\u8003\u8651\u89c2\u5bdf\u6709\u65e0\u4ec0\u4e48\u7279\u6b8a\u6027\u8d28\u3002  \n\u6211\u4eec\u60ca\u559c\u5730\u53d1\u73b0\uff0c\u6bcf\u4e2a\u591a\u9879\u5f0f\u4ec5\u4ec5\u4e09\u4e2a\u4f4d\u7f6e\u6709\u503c\uff01  \n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u901a\u8fc7\u8fd9\u4e2a\u7279\u6b8a\u6027\u8d28\u6765\u4f18\u5316 FWT\u3002  \n\u9996\u5148\uff0cFWT \u7684\u672c\u8d28\u662f\u901a\u8fc7\u6784\u9020\u4e00\u4e9b\u7cfb\u6570\u6765\u8f6c\u6210\u70b9\u503c\u8868\u793a\u3002  \n\u8fd9\u4e2a\u7cfb\u6570\u5c31\u662f $F(i\\&x)=\\text{count}(i\\&x)\\&1$\u3002  \n\u6240\u4ee5\u7b2c $i$ \u4e2a\u591a\u9879\u5f0f\u7684\u7b2c $k$ \u4f4d\u70b9\u503c\u5c31\u662f $(-1)^{F(a_i\\&k)}X+(-1)^{F(b_i\\&k)}Y+(-1)^{F(c_i\\&k)}Z$  \n\u4f46\u662f\u6211\u4eec\u66b4\u70b9\u79ef\u4ed6\u4eec\u65f6\u590d\u6742\u5ea6 $O(n2^k+...)$ \u4ecd\u7136\u7206\u70b8  \n\u7136\u540e\uff0c\u6211\u4eec\u60ca\u559c\u5730\u53d1\u73b0\uff0c\u6bcf\u4f4d\u70b9\u503c\u4ec5\u6709 $8$ \u79cd\u53ef\u80fd\u3002  \n\u540c\u65f6\u8fd8\u53ef\u4ee5\u505a\u4e00\u4e2a\u4e0b\u6807\u5e73\u79fb\uff0c\u8ba9 $\\{a_i,b_i,c_i\\}\\rightarrow\\{0,b_i\\oplus a_i,c_i\\oplus a_i\\}$ \u6700\u540e\u5e73\u79fb\u56de\u53bb\u3002  \n\u90a3\u4e48\u73b0\u5728\u5c31\u53ea\u5269\u4e0b\u56db\u79cd\u60c5\u51b5\uff1a$X+Y+Z,X+Y-Z,X-Y+Z,X-Y-Z$\u3002  \n\u5206\u522b\u8bbe\u5f53\u524d\u8003\u8651\u8fd9\u4e00\u4f4d \uff08\u8bbe\u5176\u4e3a $k$\uff09 \u7cfb\u6570\u4e3a $a,b,c,d$\u3002  \n\u6211\u4eec\u9700\u8981\u901a\u8fc7\u4e00\u4e9b\u5de7\u5999\u7684\u64cd\u4f5c\u5f97\u5230\u4e00\u4e9b\u65b9\u7a0b\u3002  \n\u8003\u8651\u7c7b\u4f3c\u5206\u79bb\u7cfb\u6570\u6cd5\uff0c\u5047\u8bbe $X=0,Y=1,Z=0$  \n\u90a3\u4e48\u5f53\u524d\u8fd9\u4e00\u4f4d\u7b54\u6848\u5c31\u662f $\\sum_{i=1}^n(-1)^{F(k\\&b_i)}=a+b-c-d\\;\\texttt{(1)}$  \n\u5047\u8bbe $X=0,Y=0,Z=1$\uff0c\u540c\u7406\u6709 $\\sum_{i=1}^n(-1)^{F(k\\&c_i)}=a-b+c-d\\;\\texttt{(2)}$  \n\u5047\u8bbe $X=1,Y=0,Z=0$\uff0c\u5219\u6709 $\\sum_{i=1}^n(-1)^{F(0\\&k)}=n=a+b+c+d\\;\\texttt{(3)}$  \n\u7136\u540e\u6839\u636e $(3)$\uff0c$X$ \u7684\u4fe1\u606f\u5df2\u7ecf\u7528\u5b8c\u4e86\uff0c$Y$ \u548c $Z$ \u5355\u72ec\u4fe1\u606f\u4e5f\u7528\u5b8c\u4e86\u3002  \n\u8003\u8651\u5f3a\u884c\u628a $X$ \u548c $Y$ \u5377\u8d77\u6765  \n\u90a3\u4e48\u5c31\u6709 $\\sum_{i=1}^n(-1)^{F(k\\&b_i)\\oplus F(k\\&c_i)}=\\sum_{i=1}^n(-1)^{F(k\\&(b_i\\oplus c_i))}=a-b-c+d$  \n\u7136\u540e\u5c31\u56db\u4e2a\u7b49\u5f0f\u56db\u4e2a\u672a\u77e5\u6570\u4e86\uff0c\u53ef\u4ee5\u89e3\u65b9\u7a0b\u3002  \n$$\n\\begin{cases}\na+b+c+d=x\\\\\na+b-c-d=f1\\\\\na-b+c-d=f2\\\\\na-b-c+d=f3\\\\\n\\end{cases}\n$$\n$$\n\\begin{cases}\na=\\frac{n+f1+f2+f3}4\\\\\nb=\\frac{n+f1}2-a\\\\\nc=\\frac{n+f2}2-a\\\\\nd=\\frac{n+f3}2-a\\\\\n\\end{cases}\n$$\n\u800c\u4e0a\u9762\u7684 $f1,f2,f3$ \u90fd\u53ef\u4ee5\u901a\u8fc7 FWT \u6765\u6c42\u3002  \n\u7136\u540e\u8fd9\u9898\u5c31\u505a\u5b8c\u4e86 qwqwq\u3002  \n### Coding.\n\u8fd9\u8fb9\u8fd8\u6709\u4e00\u4e9b\u4ee3\u7801\u7ec6\u8282 qwq\n- @$\\color{gray}\\text{Leap\\_Frog}$ \u4f60\u4e2a\u5927\u61a8\u61a8 ![](//xn--9zr.tk/jk)\uff0c\u70b9\u503c\u6c42\u51fa\u6765\u4e0d ifwt \u56de\u53bb\u7684 ![](//xn--9zr.tk/jk)  \n- \u6ce8\u610f\u8fd9\u8fb9 $f1$ $f2$ $f3$ \u6a21\u6570\u5e94\u8be5\u662f $P-1$\uff0c\u6240\u4ee5\u5bf9 $2$ \u65e0\u9006\u5143\n\t- \u8003\u8651 $f1$ $f2$ $f3$ \u6700\u5927\u503c\u4e0d\u8d85\u8fc7 $n$\uff0c\u6700\u5c0f\u503c\u4e0d\u8d85\u8fc7 $-n$\uff0c\u800c\u4e14\u53ea\u9700\u8981 fwt \u8fc7\u53bb\n\t- \u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u4e0d\u5bf9 $f1$ $f2$ $f3$ \u53d6\u6a21\n\t- \u8fd9\u6837\u5c31\u9700\u8981\u5199\u4e00\u4e2a fwt \u548c \u4e00\u4e2a ifwt\n\n```cpp\n//\u662f\u554a\u2026\u2026\u4f60\u5c31\u662f\u90a3\u53ea\u9b3c\u4e86\u2026\u2026\u6240\u4ee5\u88ab\u4f60\u78b0\u5230\u4ee5\u540e\uff0c\u5c31\u8f6e\u5230\u6211\u53d8\u6210\u9b3c\u4e86{{{\n#include<bits/stdc++.h>\nusing namespace std;typedef long long ll;\ntemplate<typename T>inline void read(T &x)\n{\n\tx=0;char c=getchar(),f=0;\n\tfor(;c<48||c>57;c=getchar()) if(!(c^45)) f=1;\n\tfor(;c>=48&&c<=57;c=getchar()) x=(x<<1)+(x<<3)+(c^48);\n\tf?x=-x:x;\n}/*}}}*/\nconst int P=998244353;int n,m,X,Y,Z,f1[131075],f2[131075],f3[131075],f[131075];\ninline int ksm(int x,int q=P-2) {int r=1;for(;q;q>>=1,x=1ll*x*x%P) if(q&1) r=1ll*r*x%P;return r;}\ninline int pls(int x,int y) {return x+=y,x>=P?x-P:x;}\ninline void fwt(int n,int *a)\n{\n\tfor(int d=1;d<n;d<<=1) for(int i=0;i<n;i+=d+d) for(int j=0;j<d;j++)\n\t\t{int x=a[i|j],y=a[i|j|d];a[i|j]=x+y,a[i|j|d]=x-y;}\n}\ninline void ifwt(int n,int *a)\n{\n\tll iv=(P+1)>>1;for(int d=1;d<n;d<<=1) for(int i=0;i<n;i+=d+d) for(int j=0;j<d;j++)\n\t\t{int x=a[i|j],y=a[i|j|d];a[i|j]=pls(x,y)*iv%P,a[i|j|d]=pls(x,P-y)*iv%P;}\n}\nint main()\n{\n\tread(n),read(m),read(X),read(Y),read(Z),m=1<<m;int py=0;\n\tfor(int i=1,a,b,c;i<=n;i++) read(a),read(b),read(c),py^=a,f1[a^b]++,f2[a^c]++,f3[b^c]++;\n\tint s1=pls(X,pls(Y,Z)),s2=pls(X,pls(Y,P-Z)),s3=pls(X,pls(P-Y,Z)),s4=pls(X,P-pls(Y,Z));\n\tfwt(m,f1),fwt(m,f2),fwt(m,f3);\n\t//for(int i=0;i<m;i++) printf(\"%d%c\",f1[i],i==m-1?'\\n':' ');\n\t//for(int i=0;i<m;i++) printf(\"%d%c\",f2[i],i==m-1?'\\n':' ');\n\t//for(int i=0;i<m;i++) printf(\"%d%c\",f3[i],i==m-1?'\\n':' ');\n\tfor(int i=0,a,b,c,d;i<m;i++)\n\t{\n\t\ta=(n+f1[i]+f2[i]+f3[i])/4,b=(n+f1[i])/2-a,c=(n+f2[i])/2-a,d=(n+f3[i])/2-a;\n\t\t//printf(\"qwq %d %d %d %d\\n%d %d %d %d\\n\",s1,s2,s3,s4,a,b,c,d);\n\t\tf[i]=1ll*ksm(s1,a)*ksm(s2,b)%P*ksm(s3,c)%P*ksm(s4,d)%P;\n\t}\n\tifwt(m,f);for(int i=0;i<m;i++) printf(\"%d%c\",f[i^py],i==m-1?'\\n':' ');\n\treturn 0;\n}\n```",
        "postTime": 1618363161,
        "uid": 44805,
        "name": "Leap_Frog",
        "ccfLevel": 7,
        "title": "CF1119H Triple\uff08\u9898\u89e3\uff09"
    },
    {
        "content": "### CF1119H Triple  \n\n[\u9898\u9762](https://www.luogu.com.cn/problem/CF1119H)\n\n\u8003\u8651\u5e73\u51e1\u7684dp\u3002  \n$$\nf_i =  xf_{i\\oplus a_j}+yf_{i\\oplus b_j}+zf_{i\\oplus c_j}\n$$\n\u5b9e\u9645\u4e0a\u5c31\u662f\u4ee4$h_j[a_j]=x,h_j[b_j]=y,h_j[c_j]=z$  \n\n\u6c42\n$$\n\\begin{aligned}\n{\\rm FWT}(ans)[i]=\\prod_{i=1}^n {\\rm FWT}(h_i)[i]\n\\\\{\\rm FWT}(h_i)[k] = \\sum_{j=0}^m (-1)^{|j\\& k|} h_i[j]  \n\\\\{=(-1)^{|k \\& a_i|}x +(-1)^{|k\\&b_i|}y+(-1)^{|k\\&c_i|}z}\n\\\\ {\\rm FWT}(ans)[i]=\\prod_{k=0}^7 {(\\pm x\\pm y\\pm z)}^{G_i[k]}  \n\\\\ \\sum_{k=0}^7 G[k]=n  \n\n\\end{aligned}\n$$\n\u5bf9\u4e8e\u6bcf\u4e2a$a,b,c$\u5355\u72ec\u505a$\\rm FWT$\u3002  \n\n\u4f8b\u5982\uff0c\u4ee4\uff1a$g_i[a_i]=1$\n$$\n\\sum_{i=1}^n{\\rm FWT}(g_i)[k]=\\sum_{i=1}^n(-1)^{|a_i \\&k|}=\\sum_{\\{1\\}\\in k}G[k]-\\sum_{\\{1\\}\\notin k}G[k] ={\\rm FWT}(\\sum_{i=1}^n g_i)[k]\n$$\n\u663e\u7136\u8fd8\u662f\u89e3\u4e0d\u51fa\u6765\u7684\u3002  \n\n\u9700\u8981\u5bf9\u6bcf\u4e00\u5bf9$(a,b),(b,c),(c,a),(a,b,c)$\u4e5f\u505a$\\rm FWT$\u3002  \n\n\u5bf9$(a,b)$\uff0c\u7b97\u51fa\u6765\u5c31\u662f\uff1a$2\\sum_{{k \\bmod 4}=3}G[k]-2\\sum_{k\\bmod4=0}G[k]$  \n\n\u5bf9$(a,b,c)$\uff0c\u7b97\u51fa\u6765\u5c31\u662f\uff1a$3G[7]-3G[0]+G[3]+G[5]+G[6]-G[1]-G[2]-G[4]$  \n\n\u9ad8\u65af\u6d88\u5143\u5373\u53ef\u3002  \n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(8*2^kk + (512+64\\log)2^k)$ \n\n\u6ce8\u610f\u8fd9\u91cc\u662f\u4efb\u610f\u6a21\u6570\u9ad8\u65af\u6d88\u5143\u3002 \u56e0\u4e3a\u662f\u5bf9\u6307\u6570\u53d6\u6a21\u3002 \n\n\u4f46\u5b9e\u9645\u4e0a\u503c\u57df\u5e76\u4e0d\u5927\uff0c\u6211\u4eec\u4ecd\u7136\u53d6$998244353$\u53d6\u6a21\u5c31\u53ef\u4ee5\u4e86\u3002  \n\n\u7ecf\u8fc7\u5b9e\u9a8c\u4e4b\u540e\u4f1a\u53d1\u73b0\u65b9\u7a0b\u65e0\u7a77\u89e3\u3002  \n\n\u56e0\u4e3a\u6709\u4fe1\u606f\u662f\u91cd\u590d\u7684\u3002  \n\n\u6211\u4eec\u4e0d\u59a8\u8003\u8651\u4e00\u4e2a\u66f4\u4f18\u79c0\u7684\u6784\u9020\uff0c  \n\n$(a,b)$\u5c31\u52a0\u5165$g[a_i \\oplus b_i]=1$ \u3002  \n\n\u7b97\u51fa\u6765\u7684\u5c31\u662f\u4ed6\u4eec\u7684\u540c\u53f7-\u5f02\u53f7\uff08\u4e0a\u9762\u662f\u5168\u6b63\u53f7\u51cf\u5168\u8d1f\u53f7\uff09\u3002        \n\n$(a,b,c)$\u540c\u7406\u3002  \n\n\u540c\u53f7\u51cf\u5f02\u53f7\u6d89\u53ca\u7684\u4e1c\u897f\u663e\u7136\u66f4\u591a\uff0c\u6240\u4ee5\u66f4\u4f18\u79c0\u3002  \n\n\n\n\u7136\u540e\u88ab\u5361\u5e38\u4e86\u3002\u5fc3\u6001\u7206\u70b8\u3002\u770b\u5230\u5176\u4ed6\u9898\u89e3\u6709\u5316\u6210\u4e24\u4e2a\u7684\u65b9\u6cd5\uff0c\u4f46\u6211\u5c31\u4e0d\u3002    \n\n\u4e8e\u662f\u8003\u8651\u76f4\u63a5\u624b\u63a8\u5f0f\u5b50\u3002  \u53d1\u73b0\u4f1a\u7b97\u5230\u660e\u5e74\u3002  \n\n\n\n\u4e8e\u662f\u6765\u4e86\u4e2a\u9ad8\u65af\u6d88\u5143,\uff08\u5373\u65b9\u7a0b\u53f3\u8fb9\u662f\u591a\u4e2a\u672a\u77e5\u6570\u90a3\u79cd\uff09\u3002\u7136\u540e\u6253\u4e86\u4e00\u6ce2\u8868\uff0c\u7136\u540e\u8fc7\u4e86\u3002  \n\n\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#pragma GCC optimize(\"Ofast\")\n#pragma GCC optimize(\"inline\")\n\nusing namespace std;\ntypedef long long ll;\n#define debug(x) cout<<#x<<':'<<x<<endl\nconst int mod = 998244353;\nint ksm(int a,int b=mod-2)\n{\n\tint ret = 1;\n\tfor(;b;b>>=1,a=1ll*a*a%mod)if(b&1)ret=1ll*ret*a%mod;\n\treturn ret;\n}\nint inv2 = ksm(2);\nvoid FWT(int *A,int n)\n{\n\tfor(int mid=1;mid<n;mid*=2)\n\t\tfor(int i=0;i<n;i+=mid*2)\n\t\t\tfor(int j=0;j<mid;j++)\n\t\t\t{\n\t\t\t\tint x = A[i+j]+A[i+j+mid],y = A[i+j]-A[i+j+mid];\n\t\t\t\tA[i+j] = x;A[i+j+mid] = y;\t\t\t\t\n\t\t\t}\n}\nvoid IFWT(int *A,int n)\n{\n\tfor(int mid=1;mid<n;mid*=2)\n\t\tfor(int i=0;i<n;i+=mid*2)\n\t\t\tfor(int j=0;j<mid;j++)\n\t\t\t{\n\t\t\t\tint x = 1ll*(A[i+j+mid]+A[i+j])*inv2%mod,y = 1ll*(A[i+j]-A[i+j+mid])*inv2%mod;\n\t\t\t\tA[i+j] = x;A[i+j+mid] = y;\n\t\t\t}\n}\nint n,m;\nconst int N = (1<<17)+20;\nint c[3],a[N][3];\nint bit[8],g[8][N],ans[N];\nconst int jz[8][8]={{873463809,-873463809,-873463809,873463809,-873463809,873463809,873463809,-873463809},{873463809,873463809,-873463809,-873463809,-873463809,-873463809,873463809,873463809},{873463809,-873463809,873463809,-873463809,-873463809,873463809,-873463809,873463809},{873463809,873463809,873463809,873463809,-873463809,-873463809,-873463809,-873463809},{873463809,-873463809,-873463809,873463809,873463809,-873463809,-873463809,873463809},{873463809,873463809,-873463809,-873463809,873463809,873463809,-873463809,-873463809},{873463809,-873463809,873463809,-873463809,873463809,-873463809,873463809,-873463809},{873463809,873463809,873463809,873463809,873463809,873463809,873463809,873463809}};\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\tm = 1<<m;\n\tscanf(\"%d%d%d\",&c[0],&c[1],&c[2]);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d%d%d\",&a[i][0],&a[i][1],&a[i][2]);\n\t\tfor(int j=1;j<8;j++)\n\t\t{\n\t\t\tint h = 0;\n\t\t\tfor(int k=0;k<3;k++)if((j>>k)&1)\n\t\t\t\th^=a[i][k];\n\t\t\tg[j][h]++;\n\t\t}\n\t}\n\tfor(int j=1;j<8;j++)bit[j]=bit[j-(j&(-j))]+1;\n\tfor(int j=1;j<8;j++)FWT(g[j],m);\n\tstatic int h[8];\n\tfor(int j=0;j<8;j++)\n\t{\n\t\th[j] = 0;\n\t\tfor(int k=0;k<3;k++)if((j>>k)&1)h[j]=(h[j]+c[k])%mod;\n\t\telse h[j]=(h[j]-c[k])%mod;\n\t}\n\tstatic int K[9];\n\tfor(int i=0;i<m;i++)\n\t{\n\t\tg[0][i] = n;\n\t\tmemset(K,0,sizeof K);\n\t\tfor(int j=0;j<8;j++)\n\t\t\tfor(int l=0;l<8;l++)\n\t\t\t\tK[l] = (K[l]+1ll*jz[l][j]*g[j][i])%mod;\n\t\tans[i] = 1;\n\t\tfor(int j=0;j<8;j++)\n\t\t\tK[j]=(K[j]+mod)%mod,ans[i] = 1ll*ans[i]*ksm(h[j],K[j])%mod;\n\t}\n\tIFWT(ans,m);\n\tfor(int i=0;i<m;i++)printf(\"%d \",(ans[i]+mod)%mod);\n\treturn 0;\n}\n```\n\n\n\n[\u6253\u8868\u4ee3\u7801\u770b\u8fd9\u91cc](https://www.luogu.com.cn/paste/7gq6xfq8)\n\n",
        "postTime": 1616125388,
        "uid": 13197,
        "name": "zhendelan",
        "ccfLevel": 7,
        "title": "CF1119H Triple"
    }
]
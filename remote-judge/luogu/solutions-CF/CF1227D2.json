[
    {
        "content": "\u8d2a\u5fc3\u90e8\u5206\u53ef\u4ee5\u89c1 [D1 \u9898\u89e3](https://www.luogu.com.cn/blog/359113/cf1227d1-xie-ti-bao-gao)\u3002\n\n\u8003\u8651\u5982\u4f55\u5feb\u901f\u5b9e\u73b0\u8fd9\u4ef6\u4e8b\uff1a\u79bb\u7ebf\uff0c\u6c42\u4e00\u4e2a\u5e8f\u5217 $b$ \u7684\u957f\u4e3a $k$ \u7684\u524d\u7f00\u7684\u7b2c $pos$ \u5c0f\u3002\n\n~~\u4e00\u79cd\u505a\u6cd5\u662f\u4e3b\u5e2d\u6811\uff0c\u4f46\u662f\u4e0d\u591f\u4f18\u7f8e\u3002~~\n\n\u53ef\u4ee5\u5148\u5c06\u8be2\u95ee\u6309 $k$ \u9012\u589e\u6392\u5e8f\uff0c\u8fd9\u6837\u6211\u4eec\u53ea\u9700\u8003\u8651\u52a0\u6570\u3002\n\n\u8003\u8651\uff1a$f_i$ \u4e3a $i$ \u662f\u5426\u5728\u6240\u6c42\u5e8f\u5217\u5185\uff0c\u90a3 $g_i=\\sum\\limits_{j=1}^if_j$ \u5373\u4e3a\u5728\u5f53\u524d\u5e8f\u5217\u4e2d\uff0c$i$ \u7684\u6392\u540d\u3002\n\n\u4e0a\u4e8c\u5206\u5373\u53ef\u3002\n\n\u7531\u4e8e $f_i$ \u8981\u652f\u6301\u5355\u70b9\u52a0\uff0c\u6240\u4ee5\u6211\u4eec\u60f3\u5230\u7528 BITS \u7ef4\u62a4 $f$\uff0c\u76f4\u63a5\u5728\u6811\u72b6\u6570\u7ec4\u4e0a\u4e8c\u5206\u3002\n\n\u590d\u6742\u5ea6 $\\mathcal{O(n\\log n)}$\u3002\n\n```cpp\nconst int N=2e5+3;\nint n,m,ans[N],b[N];\nstruct wt{int x,y,z;}a[N],q[N];\nstruct BITS\n{\n\tint c[N];\n\t#define lb x&-x\n\til void Modify(re int x)\n\t{\n\t\tfor(;x<=n;x+=lb) ++c[x];\n\t\treturn;\n\t}\n}f;\nvoid Solve()\n{\n\trd(n);\n\tfor(re int i=1;i<=n;++i) rd(b[i]),a[i]={b[i],i};\n\tstd::sort(a+1,a+n+1,[](re wt x,re wt y){return x.x==y.x?x.y<y.y:x.x>y.x;});\n\trd(m);\n\tfor(re int i=1;i<=m;++i) rd(q[i].x),rd(q[i].y),q[i].z=i;\n\tstd::sort(q+1,q+m+1,[](re wt x,re wt y){return x.x<y.x;});\n\tfor(re int i=1,j=0;i<=m;++i)\n\t{\n\t\tfor(;j<q[i].x;f.Modify(a[++j].y));\n\t\tre int p=0,s=0;\n\t\tfor(re int j=19,v;~j;--j)\n\t\t\tv=p|1<<j,v<=n&&s+f.c[v]<q[i].y&&(p=v,s+=f.c[v]);\n\t\tans[q[i].z]=b[p+1];\n\t}\n\tfor(re int i=1;i<=m;++i) prt(ans[i],'\\n');\n\treturn;\n}\n```\n\n[$\\color{green}{\\checkmark}$](https://codeforces.com/contest/1227/submission/205776136)\u3002",
        "postTime": 1684030960,
        "uid": 359113,
        "name": "elbissoPtImaerD",
        "ccfLevel": 0,
        "title": "CF1227D2 \u89e3\u9898\u62a5\u544a"
    },
    {
        "content": "\u4e09\u4e2a\u6708\u524d\uff0c\u6211\u66fe\u5199\u8fc7 [**1227D1 \u7684\u9898\u89e3**](https://www.luogu.com.cn/problem/solution/CF1227D1)\u3002\n\n\u5f53\u65f6\u5199\u5b8c\u66b4\u529b\u65b9\u6cd5\u540e\u5bf9\u7740 D2 \u770b\u4e86\u534a\u5929\uff0c\u60f3\u4e0d\u51fa\u4ec0\u4e48\u597d\u7684\u505a\u6cd5\uff0c\u8fd9\u9898\u4e5f\u5c31\u4e00\u76f4\u9e3d\u7740\u6ca1\u5199\u3002\u4eca\u5929\u5076\u7136\u770b\u5230\uff0c\u60f3\u5230\u4e86\u4e00\u4e2a\u65b9\u6cd5\uff0c\u5c31\u5728\u8fd9\u91cc\u5206\u4eab\u4e00\u4e0b\u5427\u3002\n\n---------\n### \u5c06\u95ee\u9898\u7b80\u5355\u5316\n\n\u5047\u8bbe\u4e00\u5f00\u59cb\u4ee4\u4e00\u5e8f\u5217 $b$ \u4e0e\u5e8f\u5217 $a$ \u5b8c\u5168\u76f8\u540c\uff0c\u4e14\u4e4b\u540e\u5c06\u5e8f\u5217 $b$ \u4ece\u5927\u5230\u5c0f\u6392\u5e8f\u3002\n\n\u5f53\u67e5\u8be2\u5b50\u5e8f\u5217\u957f\u5ea6\u4e3a $k$ \u65f6\uff0c\u5e8f\u5217 $a$ \u4e2d**\u5927\u4e8e** $b_k$ \u7684\u6570\u4e00\u5b9a\u4f1a\u88ab\u9009\u4e2d\uff0c**\u7b49\u4e8e** $b_k$ \u7684\u6570**\u6392\u5f97\u8d8a\u524d**\uff0c\u8d8a\u4f18\u5148\u88ab\u9009\u5165\u5b50\u5e8f\u5217\u3002\n\n\u8fd9\u91cc\u5c31\u4e0d\u7ec6\u8bf4\u4e86\uff0c\u5982\u679c\u4e0d\u7406\u89e3\u7684\u53ef\u4ee5\u53bb\u770b D1 \u9898\u89e3\u3002\n\n----------\n### \u7b97\u6cd5\u7684\u5206\u6790\n\n- **\u5bf9\u4e8e\u6bcf\u4e2a $i,j$\uff0c\u5feb\u901f\u5b9a\u4f4d\u5e8f\u5217 $a$ \u4e2d\u7b2c $i$ \u4e2a\u7b49\u4e8e $a_j$ \u7684\u6570\u7684\u4f4d\u7f6e**\n\n\u8fd9\u4e2a\u4e0d\u96be\uff0c\u56e0\u4e3a $a_i \\le 10^9$ \u800c\u6570\u5b57\u53ea\u6709 $2 \\times 10^5$ \u4e2a\uff0c\u6240\u4ee5\u53ef\u4ee5\u518d\u521b\u5efa\u4e00\u4e2a\u5e8f\u5217 $c$ \u4f5c\u4e3a\u5e8f\u5217 $a$ \u7684**\u79bb\u6563\u5316**\u6570\u7ec4\u3002\n\n\u5f00 $n$ \u4e2a `vector`\uff08\u547d\u540d\u4e3a `v`\uff09\uff0c\u7b2c $i$ \u4e2a `vector` \u8bb0\u5f55**\u79bb\u6563\u5316\u540e\u7684\u503c**\u7b49\u4e8e $i$ \u7684\u6570\uff0c\u5728\u5e8f\u5217 $a$ \u7684\u4e0b\u6807\u3002\n\n**\u5bf9\u4e8e\u540c\u4e00\u4e2a `vector`\uff0c\u91cc\u9762\u7684\u5143\u7d20\u5e94\u6ee1\u8db3\u5355\u8c03\u9012\u589e\u3002**\n\n\u67e5\u8be2\u5e8f\u5217 $a$ \u4e2d\u7b2c $i$ \u4e2a\u7b49\u4e8e $a_j$ \u7684\u6570\u7684\u4f4d\u7f6e\uff0c\u53ea\u8981\u627e `v[c[j]][i - 1]` \u5c31\u884c\u4e86\u3002\n\n- **\u5173\u4e8e\u8be2\u95ee\u7684\u987a\u5e8f**\n\n\u5982\u679c\u5bf9\u6bcf\u4e2a\u8be2\u95ee\u72ec\u7acb\u8fdb\u884c\u56de\u7b54\uff0c\u8fd9\u4e2a\u95ee\u9898\u4f1a\u53d8\u5f97\u56f0\u96be\u3002\n\n\u4e0d\u96be\u770b\u51fa\uff0c\u8be2\u95ee\u7684 $k_i$ \u957f\u5ea6\u5982\u679c\u9012\u589e\uff0c\u4e00\u5171\u53ea\u9700\u8981\u63d2\u5165 $n$ \u6b21\u6570\u5b57\uff0c\u907f\u514d\u4e86\u5de8\u91cf\u7684\u589e\u5220\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5**\u79bb\u7ebf**\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u5c06\u64cd\u4f5c\u4ee5 $k$ \u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u3002\n\n- **\u5c06\u957f\u5ea6\u4e3a $s$ \u7684\u5e8f\u5217\u6269\u5c55\u5230 $s+1$ \u7684\u89e3\u51b3\u529e\u6cd5**\n\n\u5982\u679c `b[s]` \u4e0e `b[s + 1]` \u76f8\u7b49\uff0c\u90a3\u4e48\u8981\u5728\u5b50\u5e8f\u5217\u4e2d\u63d2\u5165\u4e00\u4e2a**\u4e4b\u524d\u6ca1\u88ab\u63d2\u5165\u8fc7\uff0c\u4e14\u5728\u5e8f\u5217 $a$ \u4e2d\u6700\u9760\u524d**\u4e14\u7b49\u4e8e `b[s]` \u7684\u6570\u3002\n\n\u5426\u5219\uff0c\u53ea\u9700\u8981\u63d2\u5165\u5e8f\u5217 $a$ \u4e2d**\u7b2c\u4e00\u4e2a**\u7b49\u4e8e `b[s + 1]` \u7684\u6570\u7684**\u4f4d\u7f6e**\u3002\n\n\u8fd9\u6b65\u7684\u5b9e\u73b0\u89c1\u4e0a\u6587\u300c\u5feb\u901f\u5b9a\u4f4d\u300d\u7684\u6b65\u9aa4\u3002\n\n- **\u5c06\u4e00\u4e2a\u6570\u63d2\u5165\u5e8f\u5217\u7684\u67d0\u4e2a\u4f4d\u7f6e\uff0c\u540c\u65f6\u80fd\u8be2\u95ee\u5f53\u524d\u5e8f\u5217\u4e2d\u7b2c $pos$ \u4e2a\u6570\u7684\u503c**\n\n\u7531\u4e8e\u6211\u5f88\u83dc\uff0c\u6ca1\u5f80\u5e73\u8861\u6811\u548c\u5757\u72b6\u94fe\u8868\u7b49\u7b97\u6cd5\u601d\u8003\uff0c\u5c31\u5728\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e2a\u8f83\u597d\u7406\u89e3\u7684\u505a\u6cd5\u5427\u3002\n\n\u9996\u5148\u8fd9\u9898\u7279\u6b8a\u7684\u5730\u65b9\u5728\u4e8e\uff0c\u6211\u4eec\u77e5\u9053\u6240\u6709\u5373\u5c06\u63d2\u5165\u7684\u6570\u503c\uff0c\u4ee5\u53ca\u5b83\u5728\u6700\u7ec8\u5e8f\u5217\u7684**\u4e0b\u6807**\u3002\n\n\u90a3\u6362\u4e2a\u8868\u793a\u65b9\u6cd5\uff0c\u6bcf\u63d2\u5165\u4e00\u4e2a\u6570\u5b57\uff0c\u5c31\u5728\u5e8f\u5217 $a$ \u4e2d\u8be5\u6570\u5b57**\u5bf9\u5e94\u7684\u4f4d\u7f6e**\u4e0a\u6253\u4e00\u4e2a\u6807\u8bb0\u3002\n\n\u5982\u679c\u6211\u4eec\u4e0d\u60f3\u8ba9\u8fd9\u4e9b\u6ca1\u6807\u8bb0\u7684\u4f4d\u7f6e\u6dfb\u9ebb\u70e6\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5e8f\u5217 $a$ \u8bb0\u5f55**\u6807\u8bb0**\u7684\u524d\u7f00\u548c\u3002\n\n\u6700\u540e\uff0c\u5982\u679c\u8be2\u95ee\u5230\u5e8f\u5217\u7b2c $pos$ \u4e2a\u4f4d\u7f6e\u7684\u8bdd\uff0c\u6211\u4eec\u5c31\u627e**\u7b2c\u4e00\u4e2a\u524d\u7f00\u548c\u7b49\u4e8e $pos$ \u7684\u4f4d\u7f6e**\u5c31\u53ef\u4ee5\u4e86\u3002\u8fd9\u53ef\u4ee5**\u4e8c\u5206**\u89e3\u51b3\u3002\n\n\u81f3\u4e8e\u524d\u7f00\u548c\u7684\u7ef4\u62a4\uff0c\u6211\u4eec\u53ef\u4ee5\u64cd\u4f5c\u4e00\u4e2a\u6811\u72b6\u6570\u7ec4\u5b9e\u73b0\u3002\n\n---------------\n\n\u603b\u590d\u6742\u5ea6\uff1a$O(m \\log^2 n)$\uff0c\u74f6\u9888\u5728\u4e8e**\u4e8c\u5206 + \u6811\u72b6\u6570\u7ec4**\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <algorithm>\n#include <cstdio>\n#include <vector>\n#define INF 1e9\n#define eps 1e-6\n#define N 200010\ntypedef long long ll;\nusing namespace std;\n\nstruct query{\n\tint k, pos, id;\n}q[N];\nstruct S{\n\tint id, v;\n}s[N];\nint n, m, a[N], b[N], cnt;\nint ss[N], ans[N], t[N];\nvector <int> v[N];\n\nbool cmp(S x, S y){\n\tif(x.v != y.v) return x.v > y.v;\n\treturn x.id < y.id;\n}\n\nbool cmpp(query x, query y){\n\tif(x.k != y.k) return x.k < y.k;\n\treturn x.pos > y.pos;\n}\n\n// \u6811\u72b6\u6570\u7ec4\u6a21\u677f\n\ninline int lowbit(int x){\n\treturn x & (-x);\n}\n\nvoid modify(int x){\n\twhile(x <= n)\n\t\tt[x]++, x += lowbit(x);\n}\n\nint sum(int x){\n\tint ss = 0;\n\twhile(x >= 1)\n\t\tss += t[x], x -= lowbit(x);\n\treturn ss;\n}\n\nint main(){\n\n\tscanf(\"%d\", &n);\n\tfor(int i = 1; i <= n; i++)\n\t\tscanf(\"%d\", &a[i]), b[i] = a[i];\n\tscanf(\"%d\", &m);\n\t// \u79bb\u6563\u5316\n\tsort(b + 1, b + n + 1);\n\tcnt = unique(b + 1, b + n + 1) - b - 1;\n\tfor(int i = 1; i <= n; i++){\n\t\ta[i] = lower_bound(b + 1, b + cnt + 1, a[i]) - b;\n\t\ts[i].id = i, s[i].v = a[i];\n\t\tv[a[i]].push_back(i);\n\t}\n\t// \u6392\u5e8f\u64cd\u4f5c\n\tsort(s + 1, s + n + 1, cmp);\n\tfor(int i = 1, k, pos; i <= m; i++)\n\t\tscanf(\"%d%d\", &q[i].k, &q[i].pos), q[i].id = i;\n\tsort(q + 1, q + m + 1, cmpp);\t// \u79bb\u7ebf\u89e3\u51b3\n\tint nowk = 0;\n\tfor(int i = 1, L, R; i <= m; i++){\n\t\twhile(nowk < q[i].k)\t// \u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\n\t\t\tnowk++, modify(v[s[nowk].v][ss[s[nowk].v]]), ss[s[nowk].v]++;\n\t\tL = 1, R = n;\n\t\twhile(L < R){\t\t// \u4e8c\u5206\u627e\u7b54\u6848\n\t\t\tint mid = (L + R) >> 1;\n\t\t\tif(sum(mid) < q[i].pos) L = mid + 1;\n\t\t\telse R = mid;\n\t\t}\n\t\tans[q[i].id] = b[a[L]];\n\t}\n\tfor(int i = 1; i <= m; i++)\n\t\tprintf(\"%d\\n\", ans[i]);\n\n\treturn 0;\n}\n```",
        "postTime": 1617464410,
        "uid": 87573,
        "name": "HoshizoraZ",
        "ccfLevel": 7,
        "title": "CF1227D2 Optimal Subsequences (Hard Version) \u9898\u89e3"
    },
    {
        "content": "[\u9898\u9762](https://www.luogu.com.cn/problem/CF1227D2)\n\n\u5982\u679c\u6211\u4eec\u5c06 $a$ \u6570\u7ec4\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\uff0c\u90a3\u4e48\u663e\u7136\u7684\uff0c\u524d $k$ \u4e2a\u6570\u5c31\u5bf9\u5e94\u7740\u957f\u5ea6\u4e3a $k$ \u7684\u5143\u7d20\u548c\u6700\u5927\u7684\u5b50\u5e8f\u5217\u4e2d\u5404\u5143\u7d20\u7684\u503c\u3002\n\n\u7531\u4e8e\u8981\u6c42\u5b57\u5178\u5e8f\u6700\u5c0f\uff0c\u6240\u4ee5\u6211\u4eec\u5c06 $a$ \u6570\u7ec4\u4e2d\u7684\u5143\u7d20\u4e0b\u6807\u8fdb\u884c\u6392\u5e8f\uff0c\u5728\u6392\u5e8f\u65f6\u4ee5\u5bf9\u5e94\u7684\u5143\u7d20\u503c\u4e3a\u7b2c\u4e00\u5173\u952e\u5b57\uff0c\u4ee5\u5143\u7d20\u4e0b\u6807\u4e3a\u7b2c\u4e8c\u5173\u952e\u5b57\uff08\u6392\u5e8f\u540e\u5bf9\u5e94\u7684\u5143\u7d20\u503c\u4ece\u5927\u5230\u5c0f\uff0c\u5927\u5c0f\u76f8\u7b49\u7684\u5143\u7d20\uff0c\u4e0b\u6807\u66f4\u5c0f\u7684\u5728\u524d\uff09\u3002\u6211\u4eec\u79f0\u6392\u5e8f\u540e\u5f97\u5230\u7684\u6570\u7ec4\u4e3a $b$\u3002\n\n\u90a3\u4e48\u8fd9\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u53d1\u73b0\uff0c$b$ \u6570\u7ec4\u91cc\u524d $k$ \u4e2a\u5143\u7d20\u5bf9\u5e94\u7684\u5c31\u662f $a$ \u6570\u7ec4\u4e2d\uff0c\u957f\u5ea6\u4e3a $k$ \u7684 optimal subsequence \u4e2d\u7684\u5404\u5143\u7d20\u4e0b\u6807\u3002\n\n\u56e0\u6b64\uff0c$b$ \u6570\u7ec4\u524d $k$ \u4e2a\u4e2d\u7b2c $p$ \u5c0f\u7684\u5143\u7d20\u5bf9\u5e94\u7684\u90a3\u4e2a\u5143\u7d20\uff0c\u5c31\u662f\u957f\u5ea6\u4e3a $k$ \u7684 optimal subsequence \u4e2d\u7b2c $p$ \u4e2a\u5143\u7d20\u3002\n\n\u90a3\u4e48\u8fd9\u65f6\u95ee\u9898\u5c31\u8f6c\u5316\u6210\u4e86\u201c\u627e\u5230 $b$ \u6570\u7ec4\u524d $k$ \u4e2a\u5143\u7d20\u4e2d\u7b2c $p$ \u5c0f\u7684\u90a3\u4e2a\u201d\u3002\n\n\u8fd9\u65f6\u5c31\u53ef\u4ee5\u7528\u4e3b\u5e2d\u6811\u89e3\u51b3\u4e86\uff0c\u4f46\u662f\u6211\u4e0d\u60f3\u7801\u4e3b\u5e2d\u6811\uff0c\u6240\u4ee5\u6211\u628a\u8be2\u95ee\u5b58\u4e0b\u6765\uff0c\u6309 $k$ \u6392\u5e8f\uff0c\u79bb\u7ebf\u56de\u7b54\u3002\n\n\u5177\u4f53\u7684\u56de\u7b54\u65b9\u6cd5\u662f\uff0c\u5f00\u4e00\u68f5 `pbds` \u7684\u5e73\u8861\u6811\uff0c\u904d\u5386\u8be2\u95ee\uff0c\u5982\u679c $k$ \u53d8\u5927\u4e86\uff0c\u5c31\u5411\u5e73\u8861\u6811\u4e2d\u6dfb\u52a0 $b$ \u4e2d\u5143\u7d20\u76f4\u81f3\u5e73\u8861\u6811\u5927\u5c0f\u4e3a $k$\uff0c\u7136\u540e\u6811\u4e2d\u7b2c $p$ \u5c0f\u7684\u5143\u7d20\u5373\u662f\u7b54\u6848\u5143\u7d20\u7684\u4e0b\u6807\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/extc++.h>\n#define endl '\\n'\nusing namespace std;\nusing namespace __gnu_pbds;\ntypedef long long ll;\nconstexpr int N = 2e5 + 5;\nint n, m, a[N], b[N], ans[N];\nstruct query {\n    int k, p, id;\n    bool operator<(const query& b) const {\n        return k < b.k;\n    }\n}q[N];\ntree<int, null_type, less<int>, rb_tree_tag, tree_order_statistics_node_update> tr; \nint main() {\n    ios::sync_with_stdio(0);\n    cin.tie(0), cout.tie(0);\n    cin >> n;\n    for(int i = 1; i <= n; ++i) cin >> a[i];\n    iota(b + 1, b + n + 1, 1);\n    sort(b + 1, b + n + 1, [](int i, int j) \n    { return a[i] == a[j] ? i < j : a[i] > a[j]; });\n    cin >> m;\n    for(int i = 1; i <= m; ++i) cin >> q[i].k >> q[i].p, q[i].id = i;\n    sort(q + 1, q + m + 1);\n    for(int i = 1, j = 0; i <= m; ++i) {\n        while(j < q[i].k) tr.insert(b[++j]);\n        ans[q[i].id] = a[*tr.find_by_order(q[i].p - 1)];\n    }\n    for(int i = 1; i <= m; ++i) cout << ans[i] << endl;\n    return 0;\n}\n```",
        "postTime": 1659668808,
        "uid": 393767,
        "name": "Untitled0",
        "ccfLevel": 5,
        "title": "CF1227D2 \u9898\u89e3"
    }
]
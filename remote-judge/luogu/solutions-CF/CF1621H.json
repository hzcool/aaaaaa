[
    {
        "content": "\n\u6ce8\u610f\u5230\u4ece $x$ \u5f00\u59cb\uff0c\u5728 $i$ \u533a\u57df\u88ab\u67e5\u7968\u7684\u6b21\u6570\u662f\u5b9a\u7684\uff0c\u8bbe\u4e3a $s(x,i)$\uff0c\u53ef\u4ee5\u7528 $26$ \u6b21\u500d\u589e\u9884\u5904\u7406\u3002\u90a3\u4e48 $f(v)$ \u53ef\u4ee5\u5199\u6210\uff1a\n$$\n\\sum_{i\\ne z_v}\\min(fine(v,i)s(v,i),pass(v,i))\n$$\n\u7136\u800c\u8be2\u95ee\u5f88\u5947\u602a\uff0c\u76f4\u63a5\u5199\u6210\u4ee5\u4e0a\u5f62\u5f0f\u5e76\u4e0d\u597d\u56de\u7b54\u8be2\u95ee\u3002\n\n\u6ce8\u610f\u5230\u5728\u8be2\u95ee\u4e2d\uff0c\u5728\u4e0d\u662f\u51fa\u53d1\u70b9\u6240\u5728\u533a\u57df\u7684 $i$ \u533a\u57df\u884c\u8fdb\u7684\u603b\u65f6\u95f4\u662f\u5b9a\u7684\uff0c\u56e0\u6b64\u88ab\u67e5\u7968\u7684\u6b21\u6570\u53ea\u4f1a\u662f $A$ \u6216 $A+1$\u3002\u8fdb\u4e00\u6b65\uff0c\u6ce8\u610f\u5230\u67e5\u7968\u6b21\u6570\u4e3a $A,A+1$ \u7684\u4e0e\u51fa\u53d1\u70b9\u7684\u6df1\u5ea6\u7684\u5173\u7cfb\uff1a\u662f\u4e00\u6bb5\u533a\u95f4\u5185\uff0c\u67e5\u7968\u6b21\u6570\u4e3a $A$\uff0c\u53e6\u4e00\u6bb5\u5185\uff0c\u67e5\u7968\u6b21\u6570\u4e3a $A+1$\uff01\n\n\u6545\u4e00\u5171\u53ea\u6709 $O(k)$ \u4e2a\u533a\u95f4\uff0c\u628a\u6574\u4e2a\u6a21 $T$ \u4f59\u6570\u5206\u6210\u4e86 $O(k)$ \u6bb5\uff0c\u6bcf\u6bb5 $fine,pass$ \u5747\u5b8c\u5168\u76f8\u540c\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\uff0c\u90fd\u53ef\u4ee5\u7528\u4e3b\u5e2d\u6811\u9884\u5904\u7406\u51fa\u6765\uff08\u79bb\u7ebf\u4e00\u4e0b\u53ef\u4ee5\u4e0d\u7528\u4e3b\u5e2d\u6811\uff09\u8fd9\u4e9b\u6bb5\u5185\u5b50\u6811\u4e2d\u6709\u6ca1\u6709\u5143\u7d20\uff0c\u8be2\u95ee\u65f6\u5c31\u53ef\u4ee5\u76f4\u63a5\u56de\u7b54\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(nk\\log n+qk\\log T+qk^2)$\u3002\n\n\u611f\u89c9\u6574\u4e2a\u9898\u884c\u4e91\u6d41\u6c34\uff0c\u505a\u5b8c\uff08\u5f53\u7136\u662f\u770b\u4e86\u9898\u89e3\uff09\u540e\u5927\u547c\u597d\u5999\u3002\n\n\u4ee3\u7801\u4e0a\u7684\u5751\u70b9\uff1a\n\n1. \u4e3b\u5e2d\u6811\u7a7a\u95f4\u5f00\u591f\uff0c\u6211 $1.2\\times 10^7$ \u4f1a RE\uff0c$1.5\\times 10^7$ \u624d\u80fd\u8fc7\u3002\n2. $fine\\times s(x,i)$ \u4f1a\u7206 long long\uff0c\u8bb0\u5f97\u5224\u4e00\u4e0b\u3002\n\n---\n\n\u8ba4\u771f\u8bfb\u4e86\u4e00\u4e0b\u9898\u89e3\uff0c\u53d1\u73b0\u5176\u5b9e\u4e0d\u7528\u4e3b\u5e2d\u6811\u7684\uff0c\u6ce8\u610f\u5230\u5bf9\u4e8e\u540c\u4e00\u4e2a\u540c\u8272\u8fde\u901a\u5757\uff0c\u5b83\u4eec\u7684\u8fd9\u4e9b\u533a\u95f4\u90fd\u4e00\u6837\uff0c\u4ece\u4e0b\u5f80\u4e0a\u5408\u5e76\u4e00\u4e0b\u5c31\u53ef\u4ee5\u7a7a\u95f4 $O(qk)$ \u4e86\u3002\n\n\u540c\u65f6\u8be2\u95ee\u4e5f\u53ef\u4ee5\u505a\u5230 $O(qk)$\uff0c\u53ea\u9700\u8981\u52a8\u6001\u7ef4\u62a4\u5f53\u524d\u7b54\u6848\u800c\u4e0d\u662f\u6bcf\u6b21\u91cd\u65b0\u53bb\u626b\u3002\n\n\u6700\u7ec8\u7684\u590d\u6742\u5ea6\u662f $O(nk\\log n+qk)$\u3002",
        "postTime": 1647256513,
        "uid": 42156,
        "name": "feecle6418",
        "ccfLevel": 0,
        "title": "\u6478\u9c7c\u8bb0\u5f55 CF1621H Trains and Airplanes"
    },
    {
        "content": "## \u524d\u8a00\n\u524d\u6392\u72c2\u66b4% $\\rm\\textcolor{black}{f}\\textcolor{red}{eecle6418}$ \u5de8\u4f6c\uff0c\u601d\u8def\u90fd\u6765\u6e90\u4e8e\u4ed6\u7684\u9898\u89e3\uff0c\u4f46\u662f\u6709\u4ebf\u4e9b\u7ec6\u8282\u4e0d\u4ed4\u7ec6\u8bb2\u771f\u7684\u5f88\u96be\u53d7\uff0c\u4e0d\u653e\u4ee3\u7801\u53bb CF \u4e0a\u770b\u4e5f\u9ebb\u70e6\uff0c\u6240\u4ee5\u5c31\u5199\u4e86\u4e00\u7bc7\u8865\u5145\u8bf4\u660e\u7684\u9898\u89e3\u3002  \n\n## \u9898\u610f\n\n\u628a\u9898\u610f\u7ffb\u8bd1\u6210\u4eba\u8bdd\uff1a\u7ed9\u51fa\u4e00\u68f5\u6811\uff0c\u628a\u8fd9\u9897\u6811\u67d3\u6210 $k (1\\leq k \\leq 26)$ \u79cd\u989c\u8272\uff0c\u5176\u4e2d\u6bcf\u4e2a\u8282\u70b9\u6240\u6709\u7956\u5148\u7684\u989c\u8272\u7f16\u53f7 $j$\uff0c\u90fd\u5c0f\u4e8e\u5f53\u524d\u8282\u70b9\u7684\u989c\u8272\u7f16\u53f7 $i$\uff0c\u7ed9\u51fa\u901a\u8fc7\u6bcf\u6761\u8fb9\u9700\u8981\u7684\u65f6\u95f4 $t_i$\uff0c\u6bcf\u4e2a\u70b9\u7684\u6df1\u5ea6\u4e3a $dist_i$\u3002   \n\u6bcf\u9694 $T$ \u4e2a\u65f6\u523b\uff0c\u90fd\u4f1a\u8fdb\u884c\u4e00\u6b21\u67e5\u7968\uff0c\u5982\u679c $\\rm\\textcolor{black}{t}\\textcolor{red}{ourist}$ \u5728\u533a\u57df $i$ \u5185\uff0c\u5374\u6ca1\u6709\u7f34\u7eb3\u8be5\u533a\u57df\u7684\u8d39\u7528 $pass_i$\uff0c\u5c31\u4f1a\u7f34\u7eb3 $fine_i$ \u7684\u7f5a\u6b3e\u3002  \n\u7f5a\u6b3e\u53ef\u80fd\u591a\u6b21\u7f34\u7eb3\uff0c\u8d39\u7528\u53ea\u7528\u4ed8\u4e00\u6b21\u5c31\u53ef\u4ee5\u4e86\u3002  \n\u518d\u7ed9\u51fa $q$ \u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u64cd\u4f5c\u4e3a\u4fee\u6539\u4e00\u79cd\u989c\u8272\u5bf9\u5e94\u533a\u57df\u7684\u7f5a\u6b3e\uff0c\u8d39\u7528\u6216\u662f**\u4ece\u8282\u70b9u\u7684\u5b50\u6811\u4e2d\u540c\u8272\u8282\u70b9** $v$ \u4e2d\u8d70\u5230\u6839\u8282\u70b9\uff0c\u8be2\u95ee $\\sum fine_i + \\sum pass_i$ \u7684\u6700\u5c0f\u503c\u3002  \n$\\rm\\textcolor{black}{t}\\textcolor{red}{ourist}$ ~~\u88ab\u9ed1\u7684\u6700\u60e8\u7684\u4e00\u6b21\u4e86\u5c5e\u4e8e\u662f\u3002~~  \n\n## \u6027\u8d28\u5206\u6790\n\n\u9996\u5148\u62ff\u5230\u95ee\u9898\uff0c\u53ef\u4ee5\u5206\u6790\u95ee\u9898\u7684\u5173\u952e\u6027\u8d28\u3002\u6709\u8fd9\u6837\u4e00\u4e2a\u6027\u8d28\uff1a**\u5982\u679c\u70b9\u96c6\u4e2d\u901a\u8fc7\u989c\u8272** $i$ **\u7684\u6700\u5c0f\u88ab\u67e5\u7968\u6b21\u6570\u4e3a** $Min_i$**\uff0c\u6700\u5927\u88ab\u67e5\u7968\u6b21\u6570\u4e3a** $Max_i$**\uff0c\u5219\u6709** $Max_i - Min_i \\leq 1$\u3002  \n\u8bc1\u660e\u5341\u5206\u76f4\u89c2\u800c\u663e\u7136\uff1a\u6240\u6c42\u70b9\u96c6\u4e2d\u6240\u6709\u70b9\u901a\u8fc7\u989c\u8272 $i$ \u7684\u533a\u57df\u7684\u8def\u5f84\u5747\u76f8\u7b49\u3002\u8bbe\u901a\u8fc7\u989c\u8272 $i$ \u662f\u4ece $start_i$ \u8d70\u5230 $end_i$ \uff08\u4e0d\u662f\u4e00\u4e2a\u8282\u70b9\uff0c\u662f\u6700\u540e\u4e00\u4e2a\u8282\u70b9\u5230\u5176\u7236\u4eb2\u7684\u8def\u5f84\u4e0a\u7684\u6700\u540e\u4e00\u6bb5\uff09\uff0c\u90a3\u4e48 $Max_i = \\lceil \\frac{dist_{start_i} - dist_{end_i}}{T} \\rceil, Min_i = \\lfloor \\frac{dist_{start_i} - dist_{end_i}}{T} \\rfloor$ \u3002  \n\u8fdb\u4e00\u6b65\u53d1\u73b0\uff0c\u5728 $dist_u$ \u6a21 $T$ \u540c\u4f59\u7684\u60c5\u51b5\u4e0b\uff0c\u88ab\u67e5\u7968\u7684\u6b21\u6570\u5747\u76f8\u7b49\u3002\u6240\u4ee5\u6211\u4eec**\u8ba1\u7b97\u4e00\u79cd\u989c\u8272\u4ea7\u751f\u7684\u8d21\u732e\u65f6\uff0c\u5176\u5b9e\u4e0d\u5173\u5fc3\u5177\u4f53\u7684** $dist_u$**\uff0c\u53ea\u5173\u5fc3** $dist_u$ **\u6a21** $T$ **\u7684\u4f59\u6570\u3002**\u4e14\u53d6\u5f97 $Max_i$ \u548c $Min_i$ \u7684 $dist_v$ \u662f\u6a21 $T$ \u610f\u4e49\u4e0b\u8fde\u7eed\u7684\u4e00\u6bb5\u3002\u4f46\u662f\u6ce8\u610f\uff0c\u8fd9\u4e00\u6bb5\u53ef\u80fd\u8de8\u8fc7\u4e86 $0$\uff0c\u4e5f\u53ef\u80fd\u6ca1\u6709\uff0c\u9700\u8981\u5206\u522b\u5224\u65ad\u3002\n![orz tyl](https://cdn.luogu.com.cn/upload/image_hosting/vmiyv8ty.png?x-oss-process=image)  \n\n## \u601d\u8def\n\n\u6240\u4ee5\uff0c\u5982\u679c\u53ea\u6709\u4e00\u79cd\u989c\u8272\uff0c\u7f5a\u6b3e\u6b21\u6570\u53ea\u6709\u4e24\u79cd\u53ef\u80fd\uff01\u6211\u4eec\u5c31\u53ef\u4ee5\u628a**\u6700\u4f18\u6027\u95ee\u9898\u8f6c\u5316\u4e3a\u5224\u5b9a\u6027\u95ee\u9898**\u3002  \n\u4f46\u662f\u95ee\u9898\u662f\uff0c\u73b0\u5728\u6709\u591a\u79cd\u989c\u8272\u3002\u4f46\u662f\u8fd9\u4e9b\u989c\u8272\u53ea\u4f1a\u628a\u6570\u8f74\u5212\u5206\u4e3a $\\mathcal{O}(k)$ \u6bb5\uff0c\u5728\u6bcf\u4e00\u6bb5\u5185\u90e8\uff0c\u6bcf\u79cd\u989c\u8272\u7684\u7f5a\u6b3e\u91d1\u989d\u56fa\u5b9a\uff0c\u56e0\u6b64\u6700\u4f18\u65b9\u6848\u4e5f\u56fa\u5b9a\uff0c**\u8fd9\u4ecd\u7136\u53ef\u4ee5\u8f6c\u5316\u4e3a\u8f6c\u5316\u4e3a\u5224\u5b9a\u6027\u95ee\u9898**\u3002  \n\u800c\u67e5\u8be2\u4e00\u4e2a\u8282\u70b9\u7684\u5b50\u6811\u5185\u90e8\uff0c\u662f\u5426\u5b58\u5728\u4e00\u4e2a\u70b9\u7684 $dist_v \\bmod T$ \u5728\u7279\u5b9a\u533a\u95f4\u5185\uff0c\u53ef\u4ee5\u7528**\u53ef\u6301\u4e45\u5316\u7ebf\u6bb5\u6811\u5408\u5e76** \u6765\u5b9e\u73b0\u3002  \n\u4ee3\u7801\u7ea6 5k\uff0c\u7565\u957f\u3002\u53c2\u8003\u4e86 $\\rm\\textcolor{black}{f}\\textcolor{red}{eecle6418}$ \u5728 CF \u4e0a\u7684 AC \u4ee3\u7801\u3002\u5199\u7684\u65f6\u5019\u5148\u770b\u770b\u4e0b\u9762\u7684\u4ee3\u7801\uff0c\u591a\u753b\u56fe\u601d\u8003\uff0c\u81ea\u7136\u800c\u7136\u5c31\u5199\u51fa\u6765\u4e86\u3002  \n\u5199\u7684\u65f6\u5019\u91c7\u7528\u4e86 $\\rm\\textcolor{black}{f}\\textcolor{red}{eecle6418}$ \u5947\u5999\u7684\u5361\u7a7a\u95f4\u7ebf\u6bb5\u6811\u3002\n```cpp\n#include<bits/stdc++.h>\n#define mod first\n#define pos second\nusing namespace std;\nconst int N = 2e5+5,M = 30;\ntypedef long long ll;\nint cnt;\n\ninline void mk(int &u)\t\n{\n\tif(!u)\tu = ++cnt;\n}\n\nstruct Node{\n\tint lc,rc;//\u300a\u7ebf\u6bb5\u6811\u300b \n}arr[70 * N];\n\nvoid modify(int &u,int l,int r,int p)\n{\n\tmk(u);\n\tif(l == r)\treturn;\n\tint mid = (l + r) >> 1;\n\tif(p <= mid)\n\t\tmodify(arr[u].lc,l,mid,p);\n\telse\n\t\tmodify(arr[u].rc,mid+1,r,p);\n}\n\nint query(int u,int l,int r,int ql,int qr)//\u67e5\u8be2[ql,qr]\u4e2d\u662f\u5426\u5b58\u5728\u8282\u70b9 \n{\n\tif(!u)\treturn 0;\n\tif(l >= ql && r <= qr)\treturn 1;//\u5b58\u5728\u4e00\u4e2a\u8282\u70b9 \n\tint ans = 0,mid = (l + r) >> 1;\n\tif(ql <= mid)\n\t\tans += query(arr[u].lc,l,mid,ql,qr);\n\tif(qr > mid)\n\t\tans += query(arr[u].rc,mid+1,r,ql,qr);\n\t return ans; \n}\n\nint merge(int x,int y)//\u53ef\u6301\u4e45\u5316\u7ebf\u6bb5\u6811\u5408\u5e76 \n{\n\tif(!x || !y)//\u4e0d\u635f\u5bb3\u7ebf\u6bb5\u6811\u7ed3\u6784\uff0c\u53ef\u4ee5\u76f4\u63a5\u5408\u5e76 \n\t\treturn x + y;\n\tint s = 0;\n\tmk(s);\n\tarr[s].lc = merge(arr[x].lc,arr[y].lc);\n\tarr[s].rc = merge(arr[x].rc,arr[y].rc);\n\treturn s; \n}\n\nint op,a,b,c,T;\nint n,belong[N],k,val,q;\nint pass[M],fine[M],res[M],root[N];//res\u8d77\u5230\u6876\u7684\u4f5c\u7528\uff0c\u65b9\u4fbf\u68c0\u67e5\u5f53\u524d\u4f4d\u7f6e\u6bcf\u4e00\u7c7b\u7684\u8d21\u732e \nchar str[N],ch;\n\nint h[N],e[N<<1],ne[N<<1],w[N<<1],idx;\nint dep[N],fa[N][20],d[N];//\u5e26\u6743\u548c\u4e0d\u5e26\u6743\u7684\u6df1\u5ea6\nll S[N][M],dis[N];//\u4ecei\u70b9\u5230\u8fbej\u533a\u57df\u7684\u4ee3\u4ef7(\u4ee3\u4ef7\u7ecf\u8fc7\u504f\u79fb\u5904\u7406) \ntypedef pair<int,int> pii;\nvector<pii> vc[N];//\u6bcf\u4e2a\u70b9\u4e0a\u8bb0\u5f55\u6df1\u5ea6\u5728w\u7684\u65f6\u5019\uff0c\u7b54\u6848\u505a\u51fa\u7684\u53d8\u5316\uff0c\u6b63\u6570\u5c31\u662f\u589e\u52a0\uff0c\u8d1f\u6570\u5c31\u662f\u51cf\u5c0f \n\ninline void add(int a,int b,int c)\n{\n\te[idx] = b;\n\tne[idx] = h[a];\n\tw[idx] = c;\n\th[a] = idx++;\n}\n\nvoid DFS(int u,int f)\n{\n\td[u] = d[f]+1,fa[u][0] = f;\n\tfor(int i=1;i<=19;i++)\n\t\tfa[u][i] = fa[fa[u][i-1]][i-1];\n\tint tmp = u;//\u5148\u8df3\u5230\u548cu\u540c\u7c7b\u7684\u6700\u540e\u4e00\u4e2a\u4f4d\u7f6e \n\tfor(int i=19;i>=0;i--)\n\t\tif(belong[fa[tmp][i]] == belong[tmp])\ttmp = fa[tmp][i]; \n\ttmp = fa[tmp][0]; \n\tfor(int i=k;i>=belong[u];i--)\n\t\tS[u][i] = -1;//\u5230\u8fbe\u8fd9\u4e9b\u4f4d\u7f6e\u6ca1\u6709\u4ee3\u4ef7 \n\tfor(int i=belong[u] - 1;i>=1;i--)//\u679a\u4e3e\u6bcf\u4e00\u4e2a\u533a\u57df \n\t{\n\t\tint y = u;\n\t\tfor(int j=19;j>=0;j--)\n\t\t\tif(belong[fa[y][j]] >= i)\ty = fa[y][j];\n\t\tif(belong[y] != i)\n\t\t{\n\t\t\tS[u][i] = -1;\n\t\t\tcontinue;\n\t\t}\n\t\ty = fa[y][0];//\u8df3\u5230\u521a\u597d\u8df3\u51fa\u533a\u57dfi\u4e3a\u6b62\n\t\tS[u][i] = (dis[u] - dis[y] - 1) / T - (dis[u] - dis[tmp] - 1) / T;//\u5728i\u533a\u57df\u524d\u7684\u6b21\u6570 - \u5728i-1\u533a\u57df\u524d\u7684\u6b21\u6570=\u88ab\u67e5\u7968\u7684\u6b21\u6570 \n\t\tint r1 =  dis[tmp] % T,r2 = dis[y] % T;//\u5728[r1,r2)\u533a\u95f4\u5185\u7684\u70b9\u4f1a\u591a\u8df3\u4e00\u6b21\n\t\tif(r1 >= r2)\n\t\t{\n\t\t\tif(dis[u] % T > r2 && dis[u] % T <= r1)\n\t\t\t\tS[u][i]--;\n\t\t\tvc[u].emplace_back(r2+1,i);\n\t\t\tvc[u].emplace_back(r1+1,-i);\n\t\t } \n\t\telse\n\t\t{\n\t\t\tif(dis[u] % T > r2 || dis[u] % T <= r1)//\u672c\u8d28\u8fd8\u662f\u53d6\u4e24\u4e2a\u4e2d\u95f4\n\t\t\t\tS[u][i]--;\n\t\t\tvc[u].emplace_back(0,i);\n\t\t\tvc[u].emplace_back(r1+1,-i);\n\t\t\tvc[u].emplace_back(r2+1,i);//\u5728\u8fd9\u4e9b\u533a\u95f4\u5185\u90e8\uff0cu\u5230i\u7684\u533a\u95f4 \n\t\t}\n\t\ttmp = y; \n\t}\n\tmodify(root[u],0,T-1,dis[u] % T); \n\tsort(vc[u].begin(),vc[u].end());\n\tfor(int i = h[u];~i;i = ne[i])\n\t{\n\t\tint j = e[i];\n\t\tif(j == f)\tcontinue;\n\t\tdis[j] = dis[u] + w[i];\n\t\tDFS(j,u);\n\t\tif(belong[u] == belong[j]) \n\t\t\troot[u] = merge(root[u],root[j]);\n\t}\n}\n\nint main()\n{\n\tmemset(h,-1,sizeof(h));\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<n;i++)\n\t\tscanf(\"%d %d %d\",&a,&b,&c),add(a,b,c),add(b,a,c);\n\tscanf(\"%d %s\",&k,str+1); \n\tfor(int i=1;i<=n;i++)\n\t\tbelong[i] = str[i] - 'A' + 1;\n\tfor(int i=1;i<=k;i++)\n\t\tscanf(\"%d\",pass+i);\n\tfor(int i=1;i<=k;i++)\n\t\tscanf(\"%d\",fine+i);\n\tscanf(\"%d\",&T);\n\tfor(int i=1;i<=n;i++)\n\t\tvc[i].emplace_back(0,0),vc[i].emplace_back(T,0);//\u65b9\u4fbf\u6700\u540e\u626b\u63cf\u7684\u65f6\u5019\u4e0d\u52a0\u7279\u5224\u3002 \n\tDFS(1,0);//\u9884\u5904\u7406/ll\n\tscanf(\"%d\",&q);\n\twhile(q--)\n\t{\n\t\tscanf(\"%d \",&op);\n\t\tswitch(op){\n\t\t\tcase 1:{\n\t\t\t\tscanf(\"%c%d\",&ch,&val);\n\t\t\t\tpass[ch - 'A' + 1] = val;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 2:{\n\t\t\t\tscanf(\"%c%d\",&ch,&val);\n\t\t\t\tfine[ch - 'A' + 1] = val;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 3:{\n\t\t\t\tscanf(\"%d\",&c);\n\t\t\t\tll sum = LLONG_MAX;\n\t\t\t\tint ptr = 0;\n\t\t\t\tmemset(res,0,sizeof(res));\n\t\t\t\tfor(int i=0;vc[c][i].mod < T;i = ptr)//\u5206\u7c7b\u7b97\u8d21\u732e \n\t\t\t\t{\n\t\t\t\t\tll ans = 0;\n\t\t\t\t\twhile(vc[c][ptr].mod == vc[c][i].mod)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(vc[c][ptr].pos>=0)\n\t\t\t\t\t\t\tres[vc[c][ptr].pos]++;\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tres[-vc[c][ptr].pos]--;//\u4fee\u6539\u4e3a\u51cf\u5c0f \n\t\t\t\t\t\tptr++;\n\t\t\t\t\t} \n\t\t\t\t\tif(query(root[c],0,T-1,vc[c][i].mod,vc[c][ptr].mod - 1))//\u5b58\u5728\u4e00\u4e2a\u6811\u4e0a\u7684\u70b9\uff0c\u6ee1\u8db3\u6a21T\u5728\u533a\u95f4\u5185\n\t\t\t\t\t{\n\t\t\t\t\t\tfor(int j=1;j<=k;j++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif(S[c][j] == -1)\n\t\t\t\t\t\t\t\tcontinue; \n\t\t\t\t\t\t\tif(S[c][j] > 2e9)//\u592a\u5927\u4e86\uff0c\u53ef\u80fdboomlonglong\n\t\t\t\t\t\t\t\tans += pass[j];\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\tans += min((ll)pass[j],(S[c][j] + res[j]) * fine[j]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsum = min(sum,ans);\n\t\t\t\t\t } \n\t\t\t\t}\n\t\t\t\tprintf(\"%lld\\n\",sum);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n }\n```",
        "postTime": 1667724091,
        "uid": 254688,
        "name": "cool_milo",
        "ccfLevel": 0,
        "title": "CF1621H \u9898\u89e3"
    }
]
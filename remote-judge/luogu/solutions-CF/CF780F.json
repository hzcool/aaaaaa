[
    {
        "content": "\u672c\u849f\u84bb\u89c9\u5f97\u9898\u89e3\u4e2d\u4e8c\u4f4d\u5927\u4f6c\u8bb2\u7684\u8fc7\u5feb\uff0c\u6240\u4ee5\u5c06\u4e00\u4e9b\u5730\u65b9\u5199\u7684\u8be6\u7ec6\u4e00\u70b9\u3002\n\n### Solution\n\n\u9996\u5148\uff0c\u80fd\u591f\u6bd4\u8f83\u660e\u663e\u7684\u770b\u51fa\u6765\uff0c\u5b83\u7684\u8def\u5f84\u7c7b\u578b\u90fd\u662f\u5f62\u5982 $2^i$ \uff0c\u6240\u4ee5\u6211\u4eec\u80fd\u591f\u60f3\u5230\u500d\u589e\u3002\n\n\u7136\u540e\u6211\u4eec\u89c2\u5bdf\u6570\u636e\u8303\u56f4\uff0c\u53d1\u73b0 $n\\leq 500$ \u3002~~\u6211\u53bb\uff0c\u90a3\u6211\u4e71\u641e\u4e0d\u5c31\u884c\u4e86~~\n\n\u8003\u8651**\u500d\u589e\u7684DP**\uff0c\u8bbe\u72b6\u6001 $dp[0/1][s][u][v]$ \u4e3a\u4ece $u$ \u5230 $v$ \u5b58\u5728\u4e00\u6761\u4ee5 $0/1$ \u5f00\u5934\uff0c\u957f\u5ea6\u4e3a $2^s$ \u7684\u8def\u5f84\uff0c\u90a3\u4e48\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e3a $dp[0/1][s][u][v]=dp[0/1][s-1][u][k]\\vee dp[1/0][s-1][k][v]$ \uff0c\u5176\u4e2d $k$ \u4e3a\u4e2d\u95f4\u8f6c\u79fb\u70b9\u3002\n\n\u7136\u540e\u8003\u8651\u5982\u4f55\u8ba1\u7b97\u7b54\u6848\uff0c\u56e0\u4e3a\u4e8c\u8fdb\u5236\u7684\u67d0\u4e2a\u6027\u8d28\uff0c\u5f53\u524d\u4f4d\u6709 $1$ \u8981\u6bd4\u540e\u9762\u90fd\u662f $1$ \u8fd8\u5927\uff0c\u6240\u4ee5\u4ece\u9ad8\u4f4d\u5411\u4f4e\u4f4d\u8d2a\u5fc3\uff0c\u5e76\u7528\u4e00\u4e2a $tmp$ \u6765\u8868\u793a\u72b6\u6001\uff0c\u53ca\u65f6\u66f4\u65b0\u3002\n\n\u7ec6\u8282\uff1a\u56e0\u4e3a\u5927\u4e8e $10^{18}$ \u5c31\u8f93\u51fa $-1$ \uff0c\u6240\u4ee5\u5f00 $long~long$ \uff0c\u5e76\u5728\u7edf\u8ba1\u7b54\u6848\u7684\u65f6\u5019\u53ca\u65f6\u5224\u65ad\u3002\n\n### \u4ee3\u7801\n\n```c++\n#include<cmath>\n#include<bitset>\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\n#define ll long long\n\nusing namespace std;\nconst int N=510;\nconst ll INF=1e18;\nint n,m,now;\nll ans,pow2[100];\nbitset<N> f[2][70][N],g,tmp;\n\ninline int read(){\n    int x=0,f=1;\n    char ch=getchar();\n    while(!isdigit(ch)){if(ch=='-') f=-1;ch=getchar();}\n    while(isdigit(ch)){x=x*10+(ch^48);ch=getchar();}\n    return x*f;\n}\n\nint main(){\n    n=read();m=read();\n    for(int i=1,u,v,w;i<=m;i++){\n        u=read();v=read();w=read();\n        f[w][0][u][v]=1;\n    }\n    for(int i=1;i<=60;i++)\n        for(int u=1;u<=n;u++)\n            for(int v=1;v<=n;v++){\n                if(f[0][i-1][u][v]!=0) f[0][i][u]|=f[1][i-1][v];\n                if(f[1][i-1][u][v]!=0) f[1][i][u]|=f[0][i-1][v];\n            }\n    if(f[0][60][1].count()){\n        puts(\"-1\");\n        return 0;\n    }\n    now=0;tmp[1]=1;pow2[0]=1;\n    for(int i=1;i<=60;i++) pow2[i]=pow2[i-1]*2;\n    for(int i=60;i>=0;i--){\n        g.reset();\n        for(int j=1;j<=n;j++)\n            if(tmp[j]) g|=f[now][i][j];\n        if(g.count()!=0){\n            now^=1;tmp=g;\n            ans+=pow2[i];\n        }\n    }\n    if(ans>INF) puts(\"-1\");\n    else printf(\"%lld\\n\",ans);\n    return 0;\n}\n```\n\n",
        "postTime": 1602138220,
        "uid": 272143,
        "name": "\u662f\u4e2a\u6c49\u5b50",
        "ccfLevel": 4,
        "title": "CF780F Axel and Marston in Bitland"
    },
    {
        "content": "\u9898\u76ee\u8fd9\u4e2a\u6784\u9020\u65b9\u5f0f----\n\u500d\u589e\u6a21\u578b\u3002\n\n\u8003\u8651dp\u3002\n$dp[s][0/1][u][v]$ \u8868\u793a\u662f\u5426\u5b58\u5728\u957f\u5ea6$2^s$\u7684\u4ece$u$\u5230$v$\u7684\u8def\u3002\n\n\u8f6c\u79fb\u65b9\u7a0b\n\n$dp[s][0/1][u][v] = dp[s - 1][0/1][u][k] \\vee dp[s - 1][1/0][k][v] $\n\n\n\u4e2d\u95f4bitset\u538b\u4f4d\u3002\n\nAC\u4ee3\u7801(327ms)\n\n```C++\n#include<cstdio>\n#include<bitset>\n#include<cctype>\nusing namespace std;\n#define debug(...) fprintf(stderr,__VA_ARGS__)\ntypedef long long ll;\n\ninline char nc(){ static char buf[100000] , *p1,*p2; return p1 == p2 && (p2 = (p1 = buf) + fread(buf,1,100000,stdin),p1 == p2) ? EOF: *p1++;}\ntemplate<class T>inline void rd(T & x) { x = 0;char ch = nc();for(;!isdigit(ch);ch = nc()); for(;isdigit(ch);ch = nc()) x = x * 10 - 48 + ch;}\n\n\nconst int lev = 63;\nconst int maxn = 500 + 10;\nconst ll inf = (ll)(1e18);\nint n,m;\n\nbitset<maxn> dp[lev][2][maxn] , pre,g;\nll ans;\n\nint main(){\n\tint n,m; rd(n); rd(m);\n\tfor(int i = 0,u,v,t;i < m;i++){\n\t\trd(u); rd(v); rd(t);\n\t\tdp[0][t][u][v] = 1;\n\t}\n\tfor(int s = 1;s <= 60;s++)\n\t\tfor(int j = 0;j < 2;j++)\n\t\t\tfor(int u = 1;u <= n;u++)\n\t\t\t\tfor(int v = 1;v <= n;v++)\n\t\t\t\t\tif(dp[s - 1][j][u][v]) dp[s][j][u] |= dp[s - 1][j ^ 1][v];\n\tfor(int i = 1;i <= n;i++) if(dp[60][0][1][i]) return !printf(\"-1\");\n\tint t = 0; pre[1] = 1; \n\tfor(int i = 59;i >= 0;i--){\n\t\tg = 0;\n\t\tfor(int j = 1;j <= n;j++) if(pre[j]) g |= dp[i][t][j];\n\t\tif(g.count()) {\n\t\t\tpre = g; t ^= 1; ans += (1ll << i);\n\t\t\tif(ans > inf) return !printf(\"-1\");\n\t\t}\n\t}\n\tif(ans > inf) return !printf(\"-1\");\n\treturn !printf(\"%I64d\\n\",ans);\n}\n```",
        "postTime": 1537843410,
        "uid": 64829,
        "name": "Enzyme125",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF780F \u3010Axel and Marston in Bitland\u3011"
    },
    {
        "content": "$\\text{Problem}:$[Axel and Marston in Bitland](https://codeforces.com/problemset/problem/780/F)\n\n$\\text{Solution}:$\n\n\u8bb0\u4e00\u6761\u8def\u5f84\u662f\u597d\u7684\uff0c\u5373\uff1a\u5b83\u7684\u957f\u5ea6\u4e3a $2^{k}$\uff0c\u4e14\u8fd9\u6bb5\u8def\u5f84\u53ef\u4ee5\u901a\u8fc7\u7ffb\u8f6c\uff08\u5373\u5c06 $P$ \u53d8\u6210 $B$\uff0c$B$ \u53d8\u6210 $P$\uff09\u5982\u679c\u662f\u7b54\u6848\uff0c\u5b83\u662f\u5408\u6cd5\u7684\uff0c\u5373\u8fd9\u6bb5\u8def\u5f84\u5f62\u5982 $PBBP$\uff0c$BPPB$\u3002\u6211\u4eec\u53d1\u73b0\uff0c\u597d\u7684\u8def\u5f84\u5f53\u957f\u5ea6\u56fa\u5b9a\u65f6\uff0c\u5b83\u7684\u5f62\u5f0f\u53ea\u548c\u7b2c\u4e00\u4e2a\u5b57\u7b26\u662f $P$ \u6216\u662f $Q$ \u6709\u5173\u3002\u90a3\u4e48\u7b54\u6848\u8def\u5f84\u5c31\u53ef\u4ee5\u8868\u793a\u6210\u82e5\u5e72\u4e2a\u597d\u7684\u8def\u5f84\u6309\u987a\u5e8f\u62fc\u63a5\u5728\u4e00\u8d77\uff0c\u5177\u4f53\u7684\uff0c\u8bbe\u7b54\u6848\u8def\u5f84\u957f\u5ea6\u4e3a $len$\uff0c\u5219\u6709\uff1a\n\n$len=2^{k_{1}}(st.P)+2^{k_{2}}(st.B)+2^{k_{3}}(st.P)...,k_{1}>k_{2}>k_{3}...$\n\n\u8bbe $F_{i,j,k,s}$ \u8868\u793a\u4ece $i$ \u5230 $j$\uff0c\u662f\u5426\u5b58\u5728\u957f\u5ea6\u4e3a $2^{k}$\uff0c\u4ee5 $s$ \u4e3a\u7b2c\u4e00\u6761\u8fb9\u7684\u597d\u8def\u5f84\uff0c\u5bb9\u6613\u5f97\u5230\u8f6c\u79fb\uff1a\n\n$F_{i,j,k,s}|=(F_{i,x,k-1,s}\\&F_{x,j,k-1,!s}),(1\\leq x \\leq n)$\n\n\u6c42\u7b54\u6848\u65f6\uff0c\u6211\u4eec\u4ece\u5927\u5230\u5c0f\u679a\u4e3e $k$\uff0c\u4ece\u6ee1\u8db3\u5f53\u524d\u6761\u4ef6\u7684\u70b9\uff0c\u8f6c\u79fb\u5230\u6ee1\u8db3 $k$ \u6761\u4ef6\u7684\u70b9\u3002\u5982\u679c\u70b9\u96c6\u4e0d\u7a7a\uff0c\u5219\u66f4\u65b0\u70b9\u96c6\uff0c\u5e76\u4e14\u5c06 $2^k$ \u8ba1\u5165\u7b54\u6848\u3002\n\n\u4f46\u662f $F$ \u8f6c\u79fb\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u6211\u4eec\u65e0\u6cd5\u63a5\u53d7\u3002\u8003\u8651\u5bf9\u4e8e $F$ \u7684\u8f6c\u79fb\uff0c\u90fd\u662f\u4f4d\u8fd0\u7b97\uff0c\u6545\u53ef\u4ee5\u7528 $bitset$ \u4f18\u5316\u8f6c\u79fb\u3002\n\n$\\text{Code}:$\n\n```cpp\n#include <bits/stdc++.h>\n#pragma GCC optimize(3)\n#define int long long\n#define ri register\n#define mk make_pair\n#define fi first\n#define se second\n#define pb push_back\n#define eb emplace_back\n#define is insert\n#define es erase\nusing namespace std; const int N=505, M=60;\ninline int read()\n{\n\tint s=0, w=1; ri char ch=getchar();\n\twhile(ch<'0'||ch>'9') { if(ch=='-') w=-1; ch=getchar(); }\n\twhile(ch>='0'&&ch<='9') s=(s<<3)+(s<<1)+(ch^48), ch=getchar();\n\treturn s*w;\n}\nint n,m,Ans;\nbitset<N> F[N][M+2][2],res,vis;\nsigned main()\n{\n\tn=read(), m=read();\n\tfor(ri int i=1;i<=m;i++)\n\t{\n\t\tint u,v,t;\n\t\tu=read(), v=read(), t=read();\n\t\tu--, v--;\n\t\tF[u][0][t].set(v);\n\t}\n\tfor(ri int p=1;p<=61;p++)\n\tfor(ri int i=0;i<n;i++)\n\tfor(ri int j=0;j<n;j++)\n\tfor(ri int k=0;k<2;k++)\n\tif(F[i][p-1][k][j])\n\tF[i][p][k]|=F[j][p-1][k^1];\n\tvis.set(0);\n\tint sta=0;\n\tfor(ri int i=61;~i;i--)\n\t{\n\t\tres.reset();\n\t\tfor(ri int j=0;j<n;j++) if(vis[j]) res|=F[j][i][sta];\n\t\tif(!(int)(res.count())) continue;\n\t\tvis=res;\n\t\tsta^=1, Ans+=(1ll<<i);\n\t}\n\tprintf(\"%lld\\n\",(Ans>1e18)?(-1):(Ans));\n\treturn 0;\n}\n```\n",
        "postTime": 1613973556,
        "uid": 98618,
        "name": "Provicy",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF780F"
    },
    {
        "content": "\u9898\u76ee\u8981\u6c42\u7b2ci\u4e2a\u662f\u7531\u7b2ci -1\u4e2a\u548c\uff08\u7b2ci\u22121\u4e2a\u53d6\u53cd\uff09\u62fc\u5728\u540e\u9762\u3002 \u6c42\u6700\u957f\u8def\u3002\n\n\u56e0\u6b64\u53ef\u4ee5\u7528\u500d\u589e\u7684\u601d\u60f3\u8fdb\u884cdp\uff0cdp\u601d\u8def\u5728\u4ee3\u7801\u4e2d\u3002\u53ef\u4ee5\u7528bitset\u4f18\u5316\n\n\u6700\u540e\u9009\u53d6\u65f6\u4ece\u957f\u7684\u5f80\u77ed\u7684\u679a\u4e3e\uff0c\u5728\u52a0\u7684\u8fc7\u7a0b\u4e2d\u5927\u4e8e1e18\u5c31\u9000\u51fa\n\n\u542c\u8bf4\u597d\u50cf\u53ef\u4ee5\u7528\u77e9\u4e58\u4f18\u5316\uff0c~~\u4f46\u849f\u84bb\u6211\u4e0d\u4f1a~~\n\n```cpp\n#include <bits/stdc++.h>\n#define ll long long\n#define sqr(x) ((x)*(x))\nusing namespace std;\ninline int read(){\n   int s=0,w=1;\n   char ch=getchar();\n   while(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n   while(ch>='0'&&ch<='9') s=s*10+ch-'0',ch=getchar();\n   return s*w;\n}\nbitset<505>f[2][65][505],t,pre;//f[p][s][x][y]\u8868\u793a\u7b2c\u4e00\u6761\u8fb9\u4e3ap\u7c7b\u578b\uff0cx\u4e0ey\u4e4b\u95f4\u67092\u7684s\u6b21\u65b9\u7684\u8def\u5f84\u5b58\u4e0d\u5b58\u5728\nll ans;\nint main(){\n\tint n=read(),m=read();\n\twhile (m--){\n\t\tint x=read(),y=read(),t=read();\n\t\tf[t][0][x][y]=1;\n\t}\n// \u8f6c\u79fb\u65b9\u7a0b:f[p][s][x][y]|=(f[p][s][x][k]&f[p^1][s][k][y])     k\u4e3a\u679a\u4e3e\u7684\u4e2d\u8f6c\u70b9 \n//\u6700\u540e\u4e00\u4f4d\u53ef\u4ee5\u7528bitset\u538b\u6389\uff0c\u5373if (f[p][s-1][x][k]) f[p][s][x]|=f[p^1][s-1][k]\n\tfor (int s=1;s<=60;++s)//s\u4e3a\u8def\u5f84\u957f\u5ea6\u662f2\u7684\u591a\u5c11\u5e42\u6b21 \n\t\tfor (int p=0;p<=1;++p)//p\u4e3a\u7b2c\u4e00\u6761\u8fb9\u7684\u7c7b\u578b \n\t\t\tfor (int x=1;x<=n;++x)//x\u4e3a\u8d77\u70b9 \n\t\t\t\tfor (int k=1;k<=n;++k)//k\u4e3a\u679a\u4e3e\u7684\u4e2d\u8f6c\u70b9 \n\t\t\t\t\tif (f[p][s-1][x][k])\t\n\t\t\t\t\t\tf[p][s][x]|=f[p^1][s-1][k];\n\tfor (int i=1;i<=n;++i)\n\t\tif (f[0][60][1][i]){\n\t\t\tputs(\"-1\");return 0;\n\t\t}\n\tint now=0;pre[1]=1;//\u4e00\u5f00\u59cb\u53ea\u6709\u8282\u70b91\u53ef\u4ee5\u4f5c\u4e3a\u8d77\u70b9 \n\tfor (int s=59;s>=0;--s){// \u8d2a\u5fc3\u5f97\u9009\uff0c\u80fd\u9009\u957f\u7684\u5c31\u9009\u957f\u7684 \n\t\tt.reset();\n\t\tfor (int i=1;i<=n;++i)\n\t\t\tif (pre[i])//pre\u6570\u7ec4\u8868\u793a\u5f53\u524d\u53ef\u4e0d\u53ef\u4ee5\u9009\u4e3a\u8d77\u70b9 \n\t\t\t\tt|=f[now][s][i];//t\u6570\u7ec4\u8868\u793a\u4ece\u5f53\u524d\u53ef\u9009\u7684\u8d77\u70b9\u8d70\u63a5\u4e0b\u6765\u80fd\u5230\u8fbe\u7684\u70b9\n\t\tif (t.count()){\n\t\t\tpre=t;\n\t\t\tnow^=1;\n\t\t\tans+=(1ll<<s);\n\t\t\tif (ans>1e18){puts(\"-1\");return 0;}\n\t\t}\n\t}\n\tprintf(\"%I64d\",ans);\n}\n```\n",
        "postTime": 1553519995,
        "uid": 54260,
        "name": "tcchyc",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF780F \u3010Axel and Marston in Bitland\u3011"
    }
]
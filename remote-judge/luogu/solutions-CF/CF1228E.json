[
    {
        "content": "\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e2a\u4fbf\u4e8e\u7406\u89e3\u7684\u5bb9\u65a5\u5199\u6cd5\uff1a\n\n\u9996\u5148\uff0c\u4e00\u884c\u7684\u6240\u6709\u6570\u5408\u6cd5\u7684\u60c5\u51b5\u6570\u4e3a $k^n-(k-1)^n$ \uff08\u5373\u6240\u6709\u60c5\u51b5\u51cf\u53bb\u6700\u5c0f\u503c\u5927\u4e8e $1$ \u7684\u60c5\u51b5\uff09\u3002\n\n\u7136\u540e\uff0c\u6211\u4eec\u679a\u4e3e\u81f3\u5c11 $i$ \u5217\u4e0d\u5408\u6cd5\uff08\u4e25\u683c\u4e0a\u6765\u8bf4\u662f\u5bb9\u65a5\u7684\u8f85\u52a9\u6570\u7ec4\uff09\uff0c\u76f8\u5f53\u4e8e\u6bcf\u884c\u4e2d\u94a6\u5b9a\u4e86 $i$ \u4e2a\u6570\u6700\u5c0f\u503c\u5927\u4e8e $1$ \uff0c\u5219\u6bcf\u884c\u7684\u5408\u6cd5\u65b9\u6848\u6570\u4e3a $k^{n-i}(k-1)^i-(k-1)^n$ \uff0c\u4e58\u4e0a\u7ec4\u5408\u6570\u5e76\u628a\u6bcf\u4e00\u884c\u4e58\u8d77\u6765\u5f97\u5230 $\\tbinom{n}{i}(k^{n-i}(k-1)^i-(k-1)^n)^n$ \u3002\n\n\u6700\u540e\u5bb9\u65a5\uff0c\u7b54\u6848\u4e3a $\\displaystyle\\sum_{i=0}^n(-1)^i\\tbinom{n}{i}(k^{n-i}(k-1)^i-(k-1)^n)^n$ \uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$ \u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N=1e6+5,mod=1e9+7;\nll n,k,jc[N],jv[N],mi1[N],mi2[N],ans;\nll ksm(ll di,ll mi) {ll res=1; for(di%=mod;mi;mi>>=1,di=di*di%mod) if(mi&1) res=res*di%mod; return res;}\nll c(ll a,ll b) {return jc[a]*jv[b]%mod*jv[a-b]%mod;}\nint main()\n{\n\tint i,j;\n\tfor(cin>>n>>k,jc[0]=mi1[0]=mi2[0]=i=1;i<=n;i++) jc[i]=jc[i-1]*i%mod,mi1[i]=mi1[i-1]*k%mod,mi2[i]=mi2[i-1]*(k-1)%mod;\n\tfor(jv[n]=ksm(jc[n],mod-2),i=n-1;~i;i--) jv[i]=jv[i+1]*(i+1)%mod;\n\tfor(i=0;i<=n;i++) ans=(ans+(i&1? mod-1:1)*(c(n,i)*ksm(mi1[n-i]*mi2[i]+mod-mi2[n],n)%mod))%mod;\n\tcout<<ans;\n\treturn 0;\n}\n```\n",
        "postTime": 1617612746,
        "uid": 223768,
        "name": "Yukikaze_",
        "ccfLevel": 9,
        "title": "CF1228E solution"
    },
    {
        "content": "\u7b80\u5355\u4e8c\u9879\u5f0f\u53cd\u6f14\u3002\n\n\u5148\u7279\u5224 $k=1$\u3002\u4e0b\u6587\u5047\u8bbe $k\\ge 2$\u3002\n\n\u8bbe $f_{i,j}$ \u662f\u6070\u597d $i$ \u884c\u4e0d\u6ee1\u8db3\u8981\u6c42\uff0c\u6070\u597d $j$ \u5217\u4e0d\u6ee1\u8db3\u8981\u6c42\u7684\u65b9\u6848\u6570\u3002\u8981\u6c42\u662f $f_{0,0}$\u3002\n\n\u8bbe $g_{i,j}$ \u662f\u5bf9\u4e8e\u6240\u6709\u65b9\u6848\u4e2d\uff0c\u9009\u51fa $i$ \u884c\u4e0d\u6ee1\u8db3\u8981\u6c42\uff0c$j$ \u5217\u4e0d\u6ee1\u8db3\u8981\u6c42\u7684\u65b9\u6848\u6570\u4e4b\u548c\u3002\u5f88\u660e\u663e\u6709 $g_{i,j}=\\binom{n}{i}\\binom{n}{j}(k-1)^{n^2-(n-i)(n-j)}k^{(n-i)(n-j)}$\u3002\n\n\u6839\u636e\u5b9a\u4e49\uff0c$g_{i,j}=\\sum\\limits_{x=i}^n\\sum\\limits_{y=j}^n\\binom{x}{i}\\binom{y}{j}f_{x,y}$\u3002\n\n\u4e8c\u9879\u5f0f\u53cd\u6f14\uff0c$f_{i,j}=\\sum\\limits_{x=i}^n\\sum\\limits_{y=j}^n\\binom{x}{i}\\binom{y}{j}(-1)^{(x-i)+(y-j)}g_{x,y}$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2\\log k)$\u3002\u53ef\u80fd\u53ef\u4ee5\u8fdb\u4e00\u6b65\u4f18\u5316\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> PII;\nconst int maxn=100010,mod=1000000007;\n#define MP make_pair\n#define PB push_back\n#define lson o<<1,l,mid\n#define rson o<<1|1,mid+1,r\n#define FOR(i,a,b) for(int i=(a);i<=(b);i++)\n#define ROF(i,a,b) for(int i=(a);i>=(b);i--)\n#define MEM(x,v) memset(x,v,sizeof(x))\ninline ll read(){\n\tchar ch=getchar();ll x=0,f=0;\n\twhile(ch<'0' || ch>'9') f|=ch=='-',ch=getchar();\n\twhile(ch>='0' && ch<='9') x=x*10+ch-'0',ch=getchar();\n\treturn f?-x:x;\n}\nint n,k,ans,fac[maxn],invfac[maxn];\nint qpow(int a,ll b){\n\tint ans=1;\n\tfor(;b;b>>=1,a=1ll*a*a%mod) if(b&1) ans=1ll*ans*a%mod;\n\treturn ans;\n}\nint C(int n,int m){\n\treturn 1ll*fac[n]*invfac[m]%mod*invfac[n-m]%mod;\n}\nint main(){\n\tn=read();k=read();\n\tif(k==1) return puts(\"1\"),0;\n\tfac[0]=1;\n\tFOR(i,1,n) fac[i]=1ll*fac[i-1]*i%mod;\n\tinvfac[n]=qpow(fac[n],mod-2);\n\tROF(i,n-1,0) invfac[i]=1ll*invfac[i+1]*(i+1)%mod;\n\tFOR(i,0,n) FOR(j,0,n){\n\t\tint sum=1ll*C(n,i)*C(n,j)%mod*qpow(k-1,1ll*n*n-1ll*(n-i)*(n-j))%mod*qpow(k,1ll*(n-i)*(n-j))%mod;\n//\t\tprintf(\"i=%d,j=%d,sum=%d\\n\",i,j,sum);\n\t\tif((i+j)%2==0) ans=(ans+sum)%mod;\n\t\telse ans=(ans-sum+mod)%mod;\n\t}\n\tprintf(\"%d\\n\",ans);\n}\n```\n",
        "postTime": 1569858779,
        "uid": 72118,
        "name": "AThousandSuns",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1228E \u3010Another Filling the Grid\u3011"
    },
    {
        "content": "## \u524d\u7f6e\u77e5\u8bc6\uff1aFMT\n\n\u524d\u8a00\uff1a\u7531\u4e8e\u672c\u4eba\u4e0d\u592a\u559c\u6b22\u63a8\u5bb9\u65a5\u5f0f\u5b50\uff0c\u5c31\u501f\u52a9\u4e86\u524d\u4eba\u7684\u667a\u6167\uff0c\u6574\u4e86\u4e2a $FMT$ \u505a\u6cd5\u3002\n\n\u5206\u6790\u9898\u76ee\u7ed9\u51fa\u7684\u9650\u5236\u6761\u4ef6\uff1a\u6bcf\u884c\u6bcf\u5217\u7684\u6700\u5c0f\u503c\u4e3a $1$ \u3002\u7531\u4e8e\u540c\u65f6\u6d89\u53ca\u5230\u884c\u5217\uff0c\u5c31\u4e0d\u592a\u597d\u7528\u6b63\u5e38\u7684\u65b9\u5f0f\u6765\u63cf\u8ff0\u8be5\u9650\u5236\u6761\u4ef6\u3002\u90a3\u4e48\uff0c\u6211\u4eec\u5c31\u5c06\u5404\u884c\u5206\u5f00\u8003\u8651\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u5982\u4f55\u5904\u7406\u5404\u884c\u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u7531\u4e8e\u540c\u4e00\u5217\u53ef\u4ee5\u9009\u82e5\u5e72\u4e2a $1$ \uff0c\u800c\u6bcf\u4e00\u884c\u6bcf\u4e00\u5217\u90fd\u5f97\u6709 $1$\uff0c\u4e00\u4e2a\u6bd4\u8f83\u66b4\u529b\u7684\u60f3\u6cd5\u662f\uff1a\u6216\u5377\u79ef\u3002\n\n\u5bf9\u4e8e $n$ \u5f88\u5c0f\u7684\u65f6\u5019\uff0c\u9996\u5148\u6211\u4eec\u5c06\u77e9\u9635\u6309\u884c\u62c6\u5f00\u6210 $n$ \u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5411\u91cf\uff0c\u7531\u4e8e\u6bcf\u4e2a\u503c\u7684\u9009\u62e9\u53ea\u6709 $1$ \u6216\u8005\u975e $1$ \u4e24\u79cd\u9009\u62e9\uff0c\u6211\u4eec\u4e0d\u59a8\u8bbe\u6bcf\u884c\u7684\u9009\u62e9\u60c5\u51b5\u4e3a $T$ (\u4e00\u4e2a\u4e8c\u8fdb\u5236\u6570)\uff0c\u5176\u4e2d\u7b2c $k$ \u4f4d\u4e3a $1$ \u8868\u793a\u5728\u5411\u91cf\u4e2d\u7b2c $k$ \u4e2a\u4f4d\u7f6e\u586b\u4e0a $1$ \uff0c\u4e3a $0$ \u5219\u8868\u793a\u586b\u4e0a\u5176\u4ed6\u6570\u3002\u90a3\u4e48\uff0c\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u5b83\u7684\u96c6\u5408\u5e42\u7ea7\u6570\uff08\u5377\u79ef\u5b9a\u4e49\u4e3a\u6216\u5377\u79ef\uff09\uff1a\n\n$$\\displaystyle f(x)=\\sum_{T\\neq \\emptyset}(K-1)^{n-pop(T)} x^T$$\n\n\u5176\u4e2d $pop(T)$ \u8868\u793a\u4e8c\u8fdb\u5236\u6570 $T$ \u4e2d $1$ \u7684\u4e2a\u6570\u3002\u6709\u4e86\u8be5\u5f0f\u4e4b\u540e\uff0c\u6211\u4eec\u5c06\u5176\u81ea\u5377 $n$ \u6b21\u540e\u7684\u6700\u9ad8\u9879\u7cfb\u6570\u5c31\u662f\u7b54\u6848\u3002\u5177\u4f53\u7684\uff0c\u5c06 $f(x)$ \u8fdb\u884c $FMT$ \u540e\u518d\u5c06\u6bcf\u4e00\u9879\u90fd\u53d6 $n$ \u6b21\u5e42\u518d $IFMT$ \u56de\u6765\u5373\u53ef\u3002\u5373\uff08\u8bbe $U$ \u4e3a\u6700\u9ad8\u6b21\u9879\uff09\uff1a\n\n$$ ans=[x^{U}] f^n(x) $$\n\n\u7531\u4e8e\u8be5\u505a\u6cd5\u7684\u590d\u6742\u5ea6\u662f $O(n2^n)$ \uff0c\u5f53 $n$ \u7565\u5927\u7684\u65f6\u5019\uff0c\u7531\u4e8e\u8be5\u96c6\u5408\u5e42\u7ea7\u6570\u662f\u6307\u6570\u7ea7\u522b\u589e\u957f\u7684\uff0c\u8fd9\u4e2a\u505a\u6cd5\u4f3c\u4e4e\u5c31\u88c2\u5f00\u4e86\u3002\n\n\u5176\u5b9e\u4e0d\u7136\uff0c\u5f53\u6211\u4eec\u6df1\u5165\u5206\u6790\u8be5\u5f0f\u5b50\u540e\uff0c\u53d1\u73b0\u5f53 $pop(T)$ \u76f8\u540c\u7684\u9879\u5176\u7cfb\u6570\u4e5f\u76f8\u540c\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u4e0d\u5fc5\u5c06\u5404\u4e2a\u9879\u5206\u5f00\u8003\u8651\uff0c\u53ea\u9700\u6309 $pop(T)$ \u5206\u7c7b\u5373\u53ef\u3002 \u91cd\u65b0\u5206\u597d\u7c7b\u4e4b\u540e\uff0c\u6211\u4eec\u8fd8\u5f97\u8003\u8651\u5728\u5f53\u524d\u60c5\u51b5\u4e0b\u5982\u4f55\u505a $FMT$ \uff0c\u6839\u636e\u6216\u5377\u79ef\u7684 $FMT$ \u7684\u5b9a\u4e49\uff08\u8bbe $\\hat f(x)$ \u4e3a $f(x)$ \u83ab\u6bd4\u4e4c\u65af\u53d8\u6362\u4e4b\u540e\u7684\u7ed3\u679c\uff09\uff1a\n\n$$ \\displaystyle \\hat f(x)=\\sum_{T}\\sum_{S\\subseteq T} [x^{S}]f(x) x^{T} $$\n\n\u6211\u4eec\u540c\u7406\u53ef\u4ee5\u7ed9\u5e42\u6b21\u5b9a\u4e49\u4e3a $pop(T)$ \u7684\u591a\u9879\u5f0f\u7c7b\u4f3c\u5730\u8fdb\u884c $FMT$ \uff1a\n\n$$ \\displaystyle \\hat f(x)=\\sum _i \\sum_{j=1}^i \\binom{i}{j}(K-1)^{n-j} x^i$$ \n\n\u4f60\u4e5f\u8bb8\u60f3\u5bf9\u5176\u505a\u5377\u79ef\uff0c\u4f46\u662f\u6a21\u6570 $1e9+7$ \u8981\u5199\u4efb\u610f\u6a21\u5c31\u4f1a\u628a\u6211\u4eec\u529d\u9000\u3002\u4e8b\u5b9e\u4e0a\uff0c\u540e\u5f0f\u5c31\u662f\u4e2a\u4e8c\u9879\u5f0f\u5b9a\u7406\u7684\u5f62\u5f0f\uff0c\u7b80\u5355\u5316\u4e00\u4e0b\u5f0f\u5b50\u5c31\u53ef\u5f97\u5230\uff1a\n\n$$\\displaystyle \\hat f(x)=\\sum_i (K-1)^n*((\\frac{K}{K-1})^i-1) x^i$$ \n\n\u5c06\u6bcf\u4e00\u9879\u7cfb\u6570\u53d6 $n$ \u6b21\u5e42\u540e\u5c31\u5f97\u8003\u8651\u5982\u4f55\u505a $IFMT$ \u53d8\u56de\u6765\uff0c\u4e0d\u8fc7\u5269\u4e0b\u7684\u5de5\u4f5c\u548c\u4ee5\u4e0a\u57fa\u672c\u76f8\u540c\u3002\u8fd8\u662f\u5148\u7ed9\u51fa $IFMT$ \u7684\u5b9a\u4e49\uff1a\n\n$$ \\displaystyle \\hat f(x)=\\sum_{T}\\sum_{S\\subseteq T} (-1)^{|T|-S} [x^{S}]f(x) x^{T} $$ \n\n\u7531\u4e8e\u6211\u4eec\u53ea\u9700\u8981\u6c42\u6700\u9ad8\u6b21\u9879\u7cfb\u6570\uff0c\u5373 $pop(T)=n$ \u7684\u60c5\u51b5\uff0c\u4ee5\u4e0b\u4e5f\u5c31\u53ea\u7ed9\u51fa\u7b2c $n$ \u4f4d\u505a $IFMT$ \u540e\u7684\u7ed3\u679c\uff1a\n\n$$ \\displaystyle ans=\\sum_{i=1}^n \\binom{n}{i} (-1)^{n-i} [x^i]\\hat f(x) $$ \n\n\u5404\u90e8\u5206\u65f6\u95f4\u590d\u6742\u5ea6\u57fa\u672c\u90fd\u662f $O(n)$ \uff0c\u4ec5\u81ea\u4e58\u5904\u590d\u6742\u5ea6\u4e3a $O(n\\log n)$ \uff0c\u6240\u4ee5\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$ \u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define re register int \n#define ll long long\n#define LL inline ll\n#define V inline void\n#define I inline int\n#define FOR(i,a,b) for(re i=(a),i##i=(b);i<=i##i;++i)\n#define ROF(i,a,b) for(re i=(a),i##i=(b);i>=i##i;--i)\n//#define gc getchar()\n#define gc (ft==fs&&(ft=(fs=buf)+fread(buf,1,1<<18,stdin),ft==fs))?0:*fs++\nusing namespace std;\nchar *fs,*ft,buf[1<<18];\nconst int N=2e5+10,mo=1e9+7;\nll inf=1e14;\nLL read(){\n\tll p=0,w=0; char ch=gc;\n\twhile(!isdigit(ch)) w=ch=='-',ch=gc;\n\twhile(isdigit(ch)) p=p*10+ch-'0',ch=gc;\n\treturn w?-p:p;\n}\nint n,K;\nLL Pow(ll x,ll y){ ll as=1; for(;y;y>>=1,x=x*x%mo) if(y&1) as=as*x%mo; return as;}\nV ipt(){ n=read(),K=read();} \nll f[N],g[N],h[N],fc[N],fv[N],pw[N],ans;\nLL get(ll x,ll y){ return x>=y?fc[x]*fv[y]%mo*fv[x-y]%mo:0;}\nV init(){\n\tfc[0]=1,pw[0]=1;\n\tFOR(i,1,n) fc[i]=fc[i-1]*i%mo;\n\tfv[n]=Pow(fc[n],mo-2);\n\tROF(i,n,1) fv[i-1]=fv[i]*i%mo;\n\treturn ; \n} \nV sol(){\n\tll inv=Pow(K-1,mo-2)*K%mo,us=Pow(K-1,n);\n\tpw[0]=1;\n\tFOR(i,1,n) pw[i]=pw[i-1]*inv%mo;\n\tFOR(i,1,n) f[i]=us*(pw[i]-1+mo)%mo;\n\tFOR(i,1,n) f[i]=Pow(f[i],n);\n\tFOR(i,1,n) ans=(ans+((n-i)&1?mo-1:1)*get(n,i)%mo*f[i])%mo;\n\tcout<<ans;\n\treturn ;\n}\nint main(){\n\tipt();\n\tinit();\n\tif(K!=1) sol();\n\telse cout<<1;\n\treturn 0;\n}",
        "postTime": 1617611912,
        "uid": 242478,
        "name": "xin_chen",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1228E [Another Filling the Grid]"
    },
    {
        "content": "## \u5206\u6790\n\n\u8fd9\u9053\u9898\u6211\u7adf\u7136\u6ca1\u770b\u51fa\u6765\u662f\u5bb9\u65a5\u3002\u3002\u3002/wtcl, \u591a\u6821\u8054\u8003\u7684\u5bb9\u65a5\u4e5f\u6ca1\u505a\u51fa\u6765\uff0c\u8981\u8865\u4e00\u8865\u4e86\u3002\n\n\u8fdb\u5165\u6b63\u9898\u3002\n\n\u8fd9\u9053\u9898\u76f4\u63a5\u505a\u663e\u7136\u4e0d\u597d\u3002\u6211\u4eec\u5982\u679c\u76f4\u63a5\u5206\u7c7b\u8ba8\u8bba\uff0c\u9700\u8981\u8ba8\u8bba\u54ea\u4e9b\u4f4d\u7f6e\u662f1\uff0c\u76f4\u63a5\u7206\u70b8\u3002\n\n\u6240\u4ee5\u5bb9\u65a5\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97\u51fa**\u81f3\u5c11**\u6709 $i$ \u4e2a\u884c\uff0c $j$ \u4e2a\u5217\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684\u65b9\u6cd5\u6570\u3002\u8bbe\u4e3a $cnt_{i,j}$\u3002\n\n\u5219 $ans = \\sum_{i=0}^n\\sum_{j=1}^ncnt_{i,j} \\times (2 \\times [2|i+j] - 1)$\n\n\uff08\u6ce8\uff1a$[condition]$ \u8868\u793a\u5f53 $condition$ \u6210\u7acb\u65f6\u4e3a1\uff0c\u5426\u5219\u4e3a0\uff09\u3002\n\n\u7528~~\u5c0f\u5b66\u5965\u6570~~\u5bb9\u65a5\u539f\u7406\u5f88\u5bb9\u6613~~\u7406\u89e3~~\u8bc1\u660e\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8003\u8651\u5982\u4f55\u6c42\u51fa $cnt_{i,j}$\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u9700\u8981\u6c42\u51fa\u5bf9\u4e8e\u6bcf\u4e00\u5bf9 $(i,j)$\uff0c\u6709\u591a\u5c11\u683c\u5b50\u91cc\u586b\u7684\u6570\u5fc5\u987b\u5927\u4e8e1\u3002\n\n\u8fd9\u91cc\u53c8\u8981\u7528\u5230\u5bb9\u65a5\u539f\u7406\uff08\u5bb9\u65a5\u539f\u7406\u91cc\u9762\u7528\u5bb9\u65a5\u539f\u7406\uff0c/yun\uff09\u3002\n\n\u5bf9\u4e8e\u8fd9 $i$ \u884c\u6709 $n \\times i$ \u4e2a\u683c\u5b50\uff0c \u5bf9\u4e8e\u8fd9 $j$ \u884c\u6709 $n \\times j$ \u4e2a\u683c\u5b50\u3002\u65e2\u5c5e\u4e8e\u8fd9 $i$ \u884c\u53c8\u5c5e\u4e8e\u8fd9 $j$ \u884c\u7684\u683c\u5b50\u6709 $i \\times j$ \u4e2a\u3002\n\n\u6240\u4ee5\u4e00\u5171\u6709 $n \\times i + n \\times j - i \\times j$ \u4e2a\u683c\u5b50\uff0c\u53ea\u80fd\u586b\u5927\u4e8e1\u7684\u6570\uff0c\u4e5f\u5c31\u662f\u6709 $k-1$ \u79cd\u6570\u53ef\u4ee5\u586b\u3002\n\n\u5269\u4e0b\u7684\u683c\u5b50\u91cc\u6709 $k$ \u4e2d\u586b\u6cd5\u3002\u4e0d\u7528\u62c5\u5fc3\u6709\u522b\u7684\u884c\u6216\u8005\u5217\u4e2d\u7684\u6700\u5c0f\u503c\u5927\u4e8e1\uff0c\u5e94\u4e3a\u524d\u9762\u8bf4\u4e86**\u81f3\u5c11**\u3002\n\n\u6211\u4eec\u8fd8\u9700\u8981\u4e58\u4e0a\u4e00\u4e2a\u7ec4\u5408\u6570\uff1a$\\binom{n}{i} \\times \\binom{n}{j}$\uff0c\u7528\u6765\u9009\u51fa\u8fd9 $i$ \u884c\u548c\u8fd9 $j$ \u5217\u3002\u4e0d\u7528\u62c5\u5fc3\u91cd\u590d\uff0c\u56e0\u4e3a\u672c\u6765\u5c31\u662f\u5728\u5bb9\u65a5\u3002\u4e2d\u95f4\u6bcf\u4e00\u6b65\u8ba1\u7b97\u7684\u7ed3\u679c\u53ef\u80fd\u90fd\u4e0d\u5bf9\uff0c\u4f46\u662f\u6700\u7ec8\u7684\u7ed3\u679c\u4e00\u5b9a\u6b63\u786e\u3002\n\n\u9884\u5904\u7406\u51fa $(k-1)^x, k^x, \\binom{x}{y}$\uff0c\u5c31\u53ef\u4ee5 $O(n^2)$ \u89e3\u51b3\u3002\n\n\u8c8c\u4f3c\u548c\u73b0\u6709\u9898\u89e3\u91cd\u4e86\uff1f\u6211\u662f\u81ea\u5df1\u60f3\u7684\u554a\u554a\u554a\u3002\n\uff08\u4e0d\u8fc7\u6211\u7684\u590d\u6742\u5ea6\u66f4\u4f18\u4e00\u70b9\u70b9\uff0c\u56e0\u4e3a\u6211\u4f1a\u9884\u5904\u7406\u3002\u3002\u3002\uff09\n\n## \u89e3\u51b3\n\n$\\texttt{\\color{blue}{code:}}$\n\n```cpp\n#include <iostream>\n#include <cstdio>\n\nusing namespace std;\n\nconst int N = 255, Mod = 1e9 + 7;\nint n, k, ans, power_k[N * N], power_kd1[N * N], C[N][N];\n\nint main() {\n    scanf(\"%d%d\", &n, &k);\n    power_k[0] = power_kd1[0] = 1;\n    for (register int i = 1; i <= n * n; i++) {\n        power_k[i] = (long long)power_k[i - 1] * k % Mod;\n        power_kd1[i] = (long long)power_kd1[i - 1] * (k - 1) % Mod;\n    }\n    C[0][0] = 1;\n    for (register int i = 1; i <= n; i++) {\n        C[i][0] = 1;\n        for (register int j = 1; j <= i; j++)\n            C[i][j] = (C[i - 1][j] + C[i - 1][j - 1]) % Mod;\n    }\n    for (register int i = 0; i <= n; i++)\n        for (register int j = 0; j <= n; j++) {\n            int kd1 = i * n + j * (n - i);\n            int res = (long long)power_kd1[kd1] * power_k[n * n - kd1] % Mod\n             * C[n][i] % Mod * C[n][j] % Mod;\n            if ((i + j) & 1)\n                ans = (ans - res) % Mod;\n            else\n                ans = (ans + res) % Mod;\n        }\n    cout << (ans % Mod + Mod) % Mod << endl;\n    return 0;\n}\n```",
        "postTime": 1603438963,
        "uid": 253946,
        "name": "ClHg2",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1228E \u3010Another Filling the Grid\u3011"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://pelom.top/archives/75/)\n\n# \u9898\u610f\n\n\u4e00\u4e2a$n \\times n$\u7684\u77e9\u5f62\uff0c\u6bcf\u4e2a\u683c\u5b50\u91cc\u53ef\u4ee5\u586b$[1,k]$\u5185\u7684\u6574\u6570\uff0c\u6c42\u4fdd\u8bc1\u6bcf\u884c\u6bcf\u5217\u7684\u6700\u5c0f\u503c\u4e3a$1$\u7684\u65b9\u6848\u6570\n\n**\u6570\u636e\u8303\u56f4\uff1a**$1 \\le n \\le 250,1 \\le k \\le 10^9$\n\n# \u9898\u89e3\n\n\u76f4\u63a5\u8ba1\u7b97\u96be\u4ee5\u89e3\u51b3\uff0c\u8003\u8651\u5bb9\u65a5\u539f\u7406\n\n\u679a\u4e3e\u6709$i$\u884c$j$\u5217\u7684\u6700\u5c0f\u503c$> 1$\uff0c\u9009\u62e9\u65b9\u6848\u6709\n$$\\sum_{i=0}^n \\sum_{j=0}^n (-1)^{i+j} C_n^i C_n^j$$\n\n\u4e58\u4e0a\u6bcf\u4e2a\u683c\u5b50\u7684\u9009\u62e9\n\n- $$(k-1)^{ni+nj-ij}$$\n\t\u8fd9$i$\u884c$j$\u5217\u5fc5\u987b$> 1$\n\n- $$k^{n^2-ni-nj+ij}$$\n\t\u5176\u4f59\u683c\u5b50\u53ef\u4ee5\u4efb\u610f\u9009\n\n\u6700\u7ec8\u4e3a\n$$\\sum_{i=0}^n \\sum_{j=0}^n (-1)^{i+j} C_n^i C_n^j (k-1)^{ni+nj-ij} k^{n^2-ni-nj+ij}$$\n\n\u590d\u6742\u5ea6$O(n^2 \\log{n})$\n\n**\u4ee3\u7801\uff1a**\n\n```cpp\n#include<iostream>\n#include<cstdio>\nusing namespace std;\ntypedef long long LL;\nconst int mod=1e9+7;\nconst int N=250+10;\nint n,k;\nint fac[N],invf[N];\nint ans;\ninline int Pow(int a,int b){\n    int res=1;\n    for(;b;b>>=1){\n        if(b&1)\n            res=1ll*res*a%mod;\n        a=1ll*a*a%mod;\n    }\n    return res;\n}\ninline int inv(int x){\n    return Pow(x,mod-2);\n}\ninline int C(int n,int m){\n    return 1ll*fac[n]*invf[m]%mod*invf[n-m]%mod;\n}\nint main(){\n    scanf(\"%d%d\",&n,&k);\n    fac[0]=1;\n    for(int i=1;i<=n;i++)\n        fac[i]=1ll*fac[i-1]*i%mod;\n    invf[n]=inv(fac[n]);\n    for(int i=n-1;~i;i--)\n        invf[i]=1ll*invf[i+1]*(i+1)%mod;\n    for(int i=0;i<=n;i++)\n        for(int j=0;j<=n;j++){\n            int p=n*i+n*j-i*j;\n            ans=(1ll*ans+1ll*Pow(-1,i+j)*C(n,i)%mod*C(n,j)%mod*Pow(k-1,p)%mod*Pow(k,n*n-p)%mod)%mod;\n        }\n    ((ans%=mod)+=mod)%=mod;\n    printf(\"%d\",ans);\n    return 0;\n}\n```\n\n**\u4f18\u5316\uff1a**\n\n\u5bf9\n$$(k-1)^{ni+nj-ij} k^{n^2-ni-nj+ij}$$\n\u53d8\u5f62\u5f97\n\n$$\n\\begin{aligned}\n&(k-1)^{(n-j)i} (k-1)^{nj} k^{(n-i)(n-j)} \\\\\n=&[(k-1)^i k^{n-i}]^{n-j}[(k-1)^n]^j\n\\end{aligned}\n$$\n\n\u4e0e\u524d\u9762\u7684$(-1)^j C_n^j$\u4e00\u540c\uff0c\u53ef\u4ee5\u5e94\u7528**\u4e8c\u9879\u5f0f\u5b9a\u7406**\uff0c\u5f97\n$$[(k-1)^i k^{n-i}-(k-1)^n]^n$$\n\n\u6700\u7ec8\u4e3a\n$$\\sum_{i=0}^n (-1)^i C_n^i [(k-1)^i k^{n-i}-(k-1)^n]^n$$\n\n\u590d\u6742\u5ea6$O(n \\log{n})$\n\n**\u4ee3\u7801\uff1a**\n\n```cpp\n#include<iostream>\n#include<cstdio>\nusing namespace std;\ntypedef long long LL;\nconst int mod=1e9+7;\nconst int N=250+10;\nint n,k;\nint fac[N],invf[N];\nint ans;\ninline int Pow(int a,int b){\n    int res=1;\n    for(;b;b>>=1){\n        if(b&1)\n            res=1ll*res*a%mod;\n        a=1ll*a*a%mod;\n    }\n    return res;\n}\ninline int inv(int x){\n    return Pow(x,mod-2);\n}\ninline int C(int n,int m){\n    return 1ll*fac[n]*invf[m]%mod*invf[n-m]%mod;\n}\nint main(){\n    scanf(\"%d%d\",&n,&k);\n    fac[0]=1;\n    for(int i=1;i<=n;i++)\n        fac[i]=1ll*fac[i-1]*i%mod;\n    invf[n]=inv(fac[n]);\n    for(int i=n-1;~i;i--)\n        invf[i]=1ll*invf[i+1]*(i+1)%mod;\n    for(int i=0;i<=n;i++)\n        ans=(1ll*ans+1ll*Pow(-1,i)*C(n,i)%mod*Pow(((1ll*Pow(k-1,i)*Pow(k,n-i)%mod-Pow(k-1,n))%mod+mod)%mod,n)%mod)%mod;\n    ((ans%=mod)+=mod)%=mod;\n    printf(\"%d\",ans);\n    return 0;\n}\n```",
        "postTime": 1571666555,
        "uid": 63708,
        "name": "Pelom",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1228E \u3010Another Filling the Grid\u3011"
    },
    {
        "content": "[Link](http://codeforces.com/problemset/problem/1228/E)\n\n[My Blog](https://tony102.com/archives/140/)\n\n## Sol\n\n\u5bb9\u65a5\u7ec3\u4e60\u9898\u3002\u5176\u5b9e\u8ddf [\u3010JSOI2015\u3011\u67d3\u8272\u95ee\u9898](https://www.luogu.com.cn/problem/P6076) \u5dee\u4e0d\u591a\uff0c\u5f02\u66f2\u540c\u5de5\u4e4b\u5999\u3002\u53ef\u4ee5\u5148\u770b\u770b\u90a3\u9053\u9898\u3002\n\n\u679a\u4e3e\u6709\u591a\u5c11\u884c\u6ca1\u6709\u586b $1$\uff0c\u5047\u8bbe\u6709 $i$ \u884c\uff0c\u90a3\u4e48\u8fd9 $i$ \u884c\u586b\u6570\u5b57\u7684\u65b9\u6848\u6570\u662f $(k-1)^i$\uff0c\u5269\u4f59 $n-i$ \u884c\u7684\u586b\u6570\u5b57\u7684\u65b9\u6848\u6570\u662f $k^{n-i}$\u3002\u6b64\u5916\uff0c\u8fd8\u5e94\u51cf\u53bb\u5168\u90e8\u90fd\u6ca1\u586b $1$ \u7684\u65b9\u6848\u6570\uff1a$(k-1)^n$\u3002\n\n\u8fd9\u4e00\u7c7b\u9898\u76ee\u6709\u4e00\u4e2a\u5171\u540c\u7684\u6027\u8d28\uff0c\u4e5f\u662f\u53ef\u4ee5\u50cf\u4e0a\u8ff0\u90a3\u6837\u8ba1\u7b97\u7684\u57fa\u7840\uff1a\u884c\u548c\u5217\u4e4b\u95f4\u72ec\u7acb\u3002\u6211\u4eec\u521a\u624d\u90a3\u6837\u662f\u586b\u4e00\u884c\u7684\uff0c$n$ \u884c\u5168\u586b\u53ea\u9700\u8981 $n$ \u6b21\u5e42\u5373\u53ef\u3002\n\n\u6240\u4ee5\uff1a\n\n$$Ans = \\sum\\limits_{i=0}^{n} (-1)^i \\binom{n}{i} ((k-1)^i \\cdot k^{n-i} - (k-1)^n)^n$$\n\n\u53ef\u4ee5\u5728 $O(n \\log n)$ \u5185\u7684\u65f6\u95f4\u8ba1\u7b97\u5b8c\u3002\n\n## Code\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\n\nconst int N = 2.5e2, SIZE = N + 5;\nconst int mod = 1e9 + 7;\n\nint n, k;\nint fac[SIZE], inv[SIZE], pw[SIZE], pw1[SIZE];\n\nnamespace GTR {\n\tconst int bufl = 1 << 15;\n\tchar buf[bufl], *s = buf, *t = buf;\n\tinline int fetch() {\n\t\tif (s == t) { t = (s = buf) + fread(buf, 1, bufl, stdin); if (s == t) return EOF; }\n\t\treturn *s++;\n\t}\n\tinline int read() {\n\t\tint a = 0, b = 1, c = fetch();\n\t\twhile (c < 48 || c > 57) b ^= c == '-', c = fetch();\n\t\twhile (c >= 48 && c <= 57) a = (a << 1) + (a << 3) + c - 48, c = fetch();\n\t\treturn b ? a : -a;\n\t}\n} using GTR::read;\n\nint qPow(int a, int b) {\n    int ans = 1ll;\n    for ( ; b; b >>= 1, a = a * a % mod) {\n        if (b & 1) ans = ans * a % mod;\n    }\n    return ans % mod;\n}\n\nvoid init() {\n    fac[0] = pw[0] = pw1[0] = 1ll;\n    for (int i = 1; i <= N; ++ i)\n        fac[i] = fac[i - 1] * i % mod,\n        pw[i] = pw[i - 1] * k % mod, pw1[i] = pw1[i - 1] * (k - 1) % mod;\n    inv[N] = qPow(fac[N], mod - 2ll);\n    for (int i = N - 1; ~i; -- i) inv[i] = inv[i + 1] * (i + 1) % mod;\n}\n\nint C(int x, int y) {\n    if (x < y) return 0ll;\n    return fac[x] * inv[y] % mod * inv[x - y] % mod;\n}\n\nsigned main() {\n    n = read(), k = read(); init();\n    int ans = 0;\n    for (int i = 0; i <= n; ++ i) {\n        int p = qPow(((pw1[i] * pw[n - i] % mod) - pw1[n] + mod) % mod, n) % mod;\n        if (i & 1) ans = (ans - (C(n, i) * p % mod) + mod) % mod;\n        else ans = (ans + (C(n, i) * p % mod)) % mod;\n    }\n    printf(\"%lld\\n\", ans);\n    return 0;\n}\n```\n\n",
        "postTime": 1633607810,
        "uid": 230933,
        "name": "Tony102",
        "ccfLevel": 7,
        "title": "CF1228E Another Filling the Grid"
    },
    {
        "content": "\u663e\u7136\uff0c\u6211\u4eec\u53ef\u4ee5\u7528$f[i][j]$\u8868\u793a\u524d$i$\u884c,\u524d$j$\u5217\u6700\u5c0f\u503c\u4e3a1\u7684\u65b9\u6848\u6570\n\n\u6211\u4eec\u53ef\u4ee5\u5f97\u5230$f[i][j]=\\sum_{k=0}^{j}C_{n-k}^{j-k}(m-1)^{n-j}m^kf[i-1][k]$\n\n\u8fd9\u6837\u53ef\u4ee5\u5229\u7528\u9884\u5904\u7406\u8fbe\u5230$O(n^3)$\u7684\u65f6\u95f4\u590d\u6742\u5ea6\n\n\u6211\u4eec\u4e5f\u53ef\u4ee5\u8003\u8651\u5bb9\u65a5\uff0c\u5bf9\u4e8e\u5408\u6cd5\u7684\u65b9\u6848\u6570\n\n\u5b9a\u4e49$t=n(i+j)-ij$\uff08\u5373$i$\u884c$j$\u5217\u7684\u683c\u5b50\uff09\n\n$ans=\\sum_{i=0}^{n}\\sum_{j=0}^{n}(-1)^{i+j}(m-1)^tC_{n}^{i}C_{n}^{j}m^{n^2-t}$\n\n\u5176\u4e2d$n^2-t$\u8868\u793a\u6ca1\u6709\u9650\u5236\u7684\u4f4d\u7f6e\n\n\u8003\u8651\u5bf9\u8fd9\u4e2a\u67ff\u5b50\u8fdb\u884c\u5316\u7b80\n\n\u56e0\u4e3a$n^2-t=n^2-n(i+j)+ij=(n-i)(n-j)$\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u628a$(m-1)^t$\u62c6\u6210$(m-1)^{(n-i)j}$\u548c$(m-1)^{ni}$\n\n\u7136\u540e\u628a$(m-1)^{(n-i)j}$\u4e0e\u524d\u9762\u7ec4\u5408,\u4e2d\u95f4\u90e8\u5206\u5206\u79bb\u51fa\u6765\n\n\u53ef\u4ee5\u5f97\u5230:\n\n$\\sum_{i=0}^n(-1)^iC_n^{i}(m-1)^{ni}(m^{n-i}-(m-1)^{n-i})^n$\n\n$=> \\sum_{i=0}^n(-1)^iC_n^{i}(m^{n-i}(m-1)^i-(m-1)^n)^n$\n\n\u53ea\u8981\u9884\u5904\u7406$(m-1)^k$\u548c$m^k$\uff0c\u5c31\u53ef\u4ee5\u505a\u5230$O(nlogn)$\u7684\u65f6\u95f4\u590d\u6742\u5ea6\n\n**Code:**\n\n```\n#include<bits/stdc++.h>\n \n#define rd(x) x=read()\n \n#define N 505\n \nusing namespace std;\n \nint n,m;\nconst int p=1e9+7;\nint s[N],t[N];\nint C[N][N];\nint ans;\n \ninline int read()\n{\n    int x=0,f=1; char ch=getchar();\n    while(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n    while(ch>='0'&&ch<='9'){x=(x<<1)+(x<<3)+(ch^48);ch=getchar();}\n    return x*f;\n}\n \ninline int fastPow(int a,int b){int ans=1;for(;b;b>>=1,a=1ll*a*a%p)if(b&1)ans=1ll*ans*a%p;return ans;}\n \nint main()\n{\n\trd(n),rd(m);\n\tfor(int i=0;i<=n;i++)\n\t{\n\t\tC[i][0]=1;\n\t\tfor(int j=1;j<=i;j++)\n\t\t\tC[i][j]=(C[i-1][j]+C[i-1][j-1])%p;\n\t}s[0]=t[0]=1;\n\tfor(int i=1;i<=n;i++)s[i]=1ll*s[i-1]*m%p,t[i]=1ll*t[i-1]*(m-1)%p;\n\tfor(int i=0;i<=n;i++)\n\t{\n\t\tint res=1ll*C[n][i]*fastPow((1ll*t[i]*s[n-i]%p-t[n]+p)%p,n)%p;\n\t\tif(i&1)ans=(ans-res+p)%p;else ans=(ans+res)%p;\n\t}\n\tcout<<ans<<endl;\n\t\n\t\n\t\n\treturn 0;\n}\n```",
        "postTime": 1571963869,
        "uid": 53807,
        "name": "Erusel",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1228E \u3010Another Filling the Grid\u3011"
    },
    {
        "content": "\u76f4\u63a5\u5bb9\u65a5\n\n\u679a\u4e3e\u6709i\u884cj\u5217\u4e0d\u6ee1\u8db3\u6761\u4ef6\uff0c\u90a3\u4e48\u8fd9\u4e9b\u4f4d\u7f6e\u5c31\u53ea\u6709K-1\u79cd\u586b\u6cd5(\u4e0d\u80fd\u586b1)\uff0c\u5176\u4ed6\u4f4d\u7f6e\u6709K\u79cd\u586b\u6cd5\n\n\u8bbe $u=i*n+j*n-i*j$ \u8868\u793a\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684\u4f4d\u7f6e\u4e2a\u6570\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f\n\n$\\sum_{i=0}^{n}\\sum_{j=0}^{n}(-1)^{i+j}C_n^iC_n^j(K-1)^uK^{n*n-u}$\n\n\u76f4\u63a5\u7b97\u5c31\u884c\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$O(n^2logn)$\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define LL long long\n#define F(x,y,z) for(int x=y;x<=z;++x)\n#define D(x,y,z) for(int x=y;x>=z;--x)\nusing namespace std;\nconst int Mod=1000000007;\nconst int N=310;\nLL Min(LL x,LL y){return x<y?x:y;}\nLL Max(LL x,LL y){return x>y?x:y;}\nLL R(){\n    LL ans=0,f=1;char c=getchar();\n    for(;c<'0'||c>'9';c=getchar()) if (c=='-') f=-1;\n    for(;c>='0'&&c<='9';c=getchar()) ans=ans*10+c-'0';\n    return ans*f;\n}\nLL n,K,ans;\nLL C[N][N];\nLL Pow(LL x,LL bs){\n\tLL an=1;\n\tfor(;bs;bs>>=1,x=x*x%Mod)\n\t\tif(bs&1)an=an*x%Mod;\n\treturn an;\n}\nint main(){\n\tn=R();K=R();\n\tF(i,0,260)C[i][0]=1;\n\tF(i,1,260)\n\t\tF(j,1,i)C[i][j]=(C[i-1][j-1]+C[i-1][j])%Mod;\n\tans=0;\n\tF(i,0,n)F(j,0,n){\n\t\tLL fg=1;\n\t\tif((i+j)%2==1)fg=-1;\n\t\tLL an=C[n][i]*C[n][j]%Mod;\n\t\tLL mj=(i+j)*n-i*j;\n\t\tan=an*Pow(K-1,mj)%Mod;\n\t\tan=an*Pow(K,n*n-mj)%Mod;\n\t\tans=(ans+an*fg+Mod)%Mod;\n\t}\n\tcout<<ans<<'\\n';\n    return 0;\n}\n```",
        "postTime": 1569896030,
        "uid": 52765,
        "name": "ReseeCher",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1228E \u3010Another Filling the Grid\u3011"
    },
    {
        "content": "## \u4e8c\u5143\u4e8c\u9879\u5f0f\u53cd\u6f14\n\n\u672c\u9898\u89e3\u4f7f\u7528\u4e86**\u4e8c\u5143\u4e8c\u9879\u5f0f\u53cd\u6f14**\uff0c\u6545\u5148\u8fdb\u884c\u8bb2\u89e3\u3002\n\n### \u7ed3\u8bba\n\n$$\\begin{aligned}\nf(x,y)&=\\sum_{i=x}^{n}\\sum_{j=y}^{m}\\binom{i}{x}\\binom{j}{y}g(i,j)\\\\\n\\Leftrightarrow g(x,y)&=\\sum_{i=x}^{n}\\sum_{j=y}^{m}(-1)^{i+j-x-y}\\binom{i}{x}\\binom{j}{y}f(i,j)\n\\end{aligned}$$\n\n\u5176\u4e2d $n,m$ \u662f\u5b9a\u503c\u3002\n\nP.S. \u901a\u8fc7**\u5bb9\u65a5\u539f\u7406**\uff0c\u5176\u5b9e\u53ef\u4ee5\u8f83\u4e3a\u611f\u6027\u5730\u7406\u89e3\u8fd9\u4e2a\u7ed3\u8bba\u3002\n\n### \u8bc1\u660e\n\n\u5148\u5199\u51fa**\u521d\u59cb\u6052\u7b49\u5f0f**\uff1a\n\n$$g(x,y)=\\sum_{i=x}^{n}\\sum_{j=y}^{m}\\binom{i}{x}\\binom{j}{y}g(i,j)[i=x \\land j=y]$$\n\n\uff08\u6839\u636e\u53cd\u6f14\u5957\u8def\uff0c\u521d\u59cb\u6052\u7b49\u5f0f\u4e0e\u524d\u4e00\u4e2a\u5f0f\u5b50\u6781\u5176\u76f8\u4f3c\uff09\n\n\u518d\u5199\u51fa**\u4ea4\u9519\u548c\u516c\u5f0f**\uff1a\n\n$$\\sum_{i=0}^{n}(-1)^i\\binom{n}{i}=[n=0]$$\n\n\uff08\u8bc1\u660e\u53ef\u4f7f\u7528**\u4e8c\u9879\u5f0f\u5b9a\u7406**\uff0c\u6216\u7edf\u8ba1\u5927\u5c0f\u4e3a $n$ \u7684\u96c6\u5408\u7684\u5947\u5b50\u96c6\u548c\u5076\u5b50\u96c6\u7684\u4e2a\u6570\uff09\n\n\u7531 $[i=x \\land j=y]=[i-x=0][j-y=0]$ \u5f97\uff1a\n\n$$g(x,y)=\\sum_{i=x}^{n}\\sum_{j=y}^{m}\\binom{i}{x}\\binom{j}{y}g(i,j)(\\sum_{a=0}^{i-x}\\sum_{b=0}^{j-y}(-1)^{a+b}\\binom{i-x}{a}\\binom{j-y}{b})$$\n\n\u6574\u7406\u4e00\u4e0b\u5f0f\u5b50\uff1a\n\n$$g(x,y)=\\sum_{i=x}^{n}\\sum_{j=y}^{m}\\sum_{a=0}^{i-x}\\sum_{b=0}^{j-y}(-1)^{a+b}\\binom{i}{x}\\binom{i-x}{a}\\binom{j}{y}\\binom{j-y}{b}g(i,j)$$\n\n\u8003\u8651\u5bf9\u7ec4\u5408\u6570\u8fdb\u884c\u9636\u4e58\u5c55\u5f00\u5e76\u91cd\u7ec4\u6210\u5176\u5b83\u7ec4\u5408\u6570\uff1a\n\n$$\\begin{aligned}\n\\binom{i}{x}\\binom{i-x}{a}&=\\frac{i!}{x!(i-x)!}\\cdot\\frac{(i-x)!}{a!(i-x-a)!}\\\\\n&=\\frac{1}{x!a!}\\cdot\\frac{i!}{(i-x-a)!}\\\\\n&=\\frac{(x+a)!}{x!a!}\\cdot\\frac{i!}{(x+a)!(i-x-a)!}\\\\\n&=\\binom{x+a}{x}\\binom{i}{x+a}\n\\end{aligned}$$\n\n\uff08\u540c\u7406\u6709 $\\binom{j}{y}\\binom{j-y}{b}=\\binom{y+b}{y}\\binom{j}{y+b}$\uff09\n\n\u4ee3\u5165\u524d\u8ff0\u5f0f\u5b50\u5f97\uff1a\n\n$$g(x,y)=\\sum_{i=x}^{n}\\sum_{j=y}^{m}\\sum_{a=0}^{i-x}\\sum_{b=0}^{j-y}(-1)^{a+b}\\binom{x+a}{x}\\binom{i}{x+a}\\binom{y+b}{y}\\binom{j}{y+b}g(i,j)$$\n\n\u4ee4 $a \\leftarrow x+a$\uff0c$b \\leftarrow y+b$ \u5f97\uff1a\n\n$$g(x,y)=\\sum_{i=x}^{n}\\sum_{j=y}^{m}\\sum_{a=x}^{i}\\sum_{b=y}^{j}(-1)^{a+b-x-y}\\binom{a}{x}\\binom{i}{a}\\binom{b}{y}\\binom{j}{b}g(i,j)$$\n\n\u4ea4\u6362\u6c42\u548c\u7b26\u53f7\uff1a\n\n$$g(x,y)=\\sum_{a=x}^{n}\\sum_{b=y}^{m}(-1)^{a+b-x-y}\\binom{a}{x}\\binom{b}{y}(\\sum_{i=a}^{n}\\sum_{j=b}^{m}\\binom{i}{a}\\binom{j}{b}g(i,j))$$\n\n\u4ee3\u5165\u7ed3\u8bba\u4e2d\u7684\u524d\u4e00\u4e2a\u5f0f\u5b50\u5f97\uff1a\n\n$$g(x,y)=\\sum_{a=x}^{n}\\sum_{b=y}^{m}(-1)^{a+b-x-y}\\binom{a}{x}\\binom{b}{y}f(a,b)$$\n\n\u5373\u7ed3\u8bba\u4e2d\u7684\u540e\u4e00\u4e2a\u5f0f\u5b50\u3002\n\n\u9664\u6700\u540e\u4e00\u6b65\u5916\uff0c\u6240\u6709\u7684\u6b65\u9aa4\u90fd\u662f\u6052\u7b49\u53d8\u5f62\uff0c\u6240\u4ee5**\u7ed3\u8bba\u4e2d\u7684\u4e24\u4e2a\u5f0f\u5b50\u7b49\u4ef7\uff0c\u4e14\u6ca1\u6709\u4efb\u4f55\u9650\u5236\u6761\u4ef6**\u3002\n\n## \u9898\u89e3\n\n\u56de\u5230\u672c\u9898\uff0c\u8bbe $f(x,y)$ \u4e3a**\u81f3\u5c11**\u6709 $x$ \u884c $y$ \u5217\u7684\u6700\u5c0f\u503c $>1$ \u7684\u65b9\u6848\u6570\uff0c$g(x,y)$ \u4e3a**\u6070\u597d**\u6709 $x$ \u884c $y$ \u5217\u7684\u6700\u5c0f\u503c $>1$ \u7684\u65b9\u6848\u6570\u3002\n\n\u6ce8\u610f\uff1a\u6211\u4eec\u5b9a\u4e49\u6b64\u5904\u7684 $f(x,y)$ \u7684\u8ba1\u7b97\u65b9\u6cd5\u4e3a\uff0c\u4ece\u6240\u6709\u884c\u5217\u4e2d\u9009\u51fa $x$ \u884c $y$ \u5217\uff0c\u5e76\u6307\u5b9a\u8fd9 $x$ \u884c $y$ \u5217\u6ee1\u8db3\u6761\u4ef6\uff0c\u800c\u5176\u4f59\u884c\u5217\u4efb\u610f\uff0c\u56e0\u6b64 **$f$ \u662f\u5305\u542b\u91cd\u590d\u60c5\u51b5\u7684**\u3002\uff08\u8fd9\u662f\u4e3a\u4e86\u4f7f\u7528\u4e8c\u9879\u5f0f\u53cd\u6f14\uff09\n\n\u7531 $f$ \u548c $g$ \u7684\u5b9a\u4e49\u77e5\uff1a\n\n$$f(x,y)=\\sum_{i=x}^{n}\\sum_{j=y}^{n}\\binom{i}{x}\\binom{j}{y}g(i,j)$$\n\n\u7531\u4e8c\u5143\u4e8c\u9879\u5f0f\u53cd\u6f14\u77e5\uff1a\n\n$$g(x,y)=\\sum_{i=x}^{n}\\sum_{j=y}^{n}(-1)^{i+j-x-y}\\binom{i}{x}\\binom{j}{y}f(i,j)$$\n\n\u9898\u76ee\u7684\u7b54\u6848\u5373\u4e3a\uff1a\n\n$$g(0,0)=\\sum_{i=0}^{n}\\sum_{j=0}^{n}(-1)^{i+j}f(i,j)$$\n\n\u6839\u636e $f$ \u7684\u5b9a\u4e49\uff0c\u5176\u8ba1\u7b97\u65b9\u6cd5\u5982\u4e0b\uff1a\n\n$$f(x,y)=\\binom{n}{x}\\binom{n}{y}k^{(n-x)(n-y)}(k-1)^{n^2-(n-x)(n-y)}$$\n\n\u9884\u5904\u7406\u7ec4\u5408\u6570 $\\binom{n}{i}$\uff0c\u4ee5 $k$ \u548c $k-1$ \u4e3a\u5e95\u6570\u7684\u5e42\uff0c\u5373\u53ef\u5728 $O(n^2)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u89e3\u51b3\u672c\u9898\u3002\n\n## \u4ee3\u7801\n\n\u9898\u89e3\u4e2d\u7684\u4ee3\u7801\u662f\u901a\u8fc7\u5982\u4e0b\u9012\u63a8\u5f0f\u7b97\u5f97\u7ec4\u5408\u6570 $\\binom{n}{i}$ \u7684\uff1a\n\n$$\\binom{n}{i}=\\frac{n-i+1}{i}\\binom{n}{i-1}$$\n\n\uff08\u5c06\u7ec4\u5408\u6570\u9636\u4e58\u5c55\u5f00\u5373\u8bc1\uff09\n\n\u5f53\u7136\u4e5f\u53ef\u4ee5\u9884\u5904\u7406\u9636\u4e58\u53ca\u9636\u4e58\u9006\u5143\uff0c\u76f4\u63a5\u4f7f\u7528\u9636\u4e58\u5c55\u5f00\u5f0f\u8fdb\u884c\u8ba1\u7b97\u3002\n\n``` cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int max_n=250+5;\nint inv[max_n];\nconst int mod=1e9+7;\nint C[max_n],f[max_n][max_n],g[max_n][max_n];\nconst int max_n2=250*250+5;\nint fac_k_minus_1[max_n2],fac_k[max_n2];\nint main()\n{\n\tint n,k;\n\tscanf(\"%d%d\",&n,&k);\n\tinv[1]=1;\n\tfor(int i=2;i<=n;++i)\n\t\tinv[i]=1ll*(mod-mod/i)*inv[mod%i]%mod;\n\tC[0]=1;\n\tfor(int i=1;i<=n;++i)\n\t\tC[i]=1ll*C[i-1]*inv[i]%mod*(n-(i-1))%mod;\n\tfac_k_minus_1[0]=fac_k[0]=1;\n\tint n2=n*n;\n\tfor(int i=1;i<=n2;++i)\n\t{\n\t\tfac_k_minus_1[i]=(k-1ll)*fac_k_minus_1[i-1]%mod;\n\t\tfac_k[i]=1ll*k*fac_k[i-1]%mod;\n\t}\n\tfor(int i=0;i<=n;++i)\n\t\tfor(int j=0;j<=n;++j)\n\t\t\tf[i][j]=1ll*C[i]*C[j]%mod*fac_k_minus_1[n2-(n-i)*(n-j)]%mod*fac_k[(n-i)*(n-j)]%mod;\n\tint ans=0;\n\tfor(int i=0;i<=n;++i)\n\t\tfor(int j=0;j<=n;++j)\n\t\t{\n\t\t\tif((i^j)&1)\n\t\t\t{\n\t\t\t\tans-=f[i][j];\n\t\t\t\tans+=ans<0?mod:0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tans+=f[i][j];\n\t\t\t\tans-=ans>=mod?mod:0;\n\t\t\t}\n\t\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n\n```",
        "postTime": 1630115169,
        "uid": 145355,
        "name": "wsyhb",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011CF1228E Another Filling the Grid"
    },
    {
        "content": "[CF1228E Another Filling the Grid](https://www.luogu.com.cn/problem/CF1228E)\u89e3\u9898\u62a5\u544a\uff1a\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://zybuluo.com/xiaoziyao/note/1750945)\n\n## \u9898\u610f\n- \u7ed9\u5b9a\u4e00\u4e2a$n\\times n$\u7684\u77e9\u9635\uff0c\u7528$[1,k]$\u4e2d\u7684\u6570\u586b\u5145\uff1b\n- \u8981\u4f7f\u6bcf\u884c\u6bcf\u5217\u6700\u5c0f\u503c\u90fd\u4e3a$1$\uff0c\u95ee\u6709\u591a\u5c11\u79cd\u5199\u6cd5\uff08\u5bf9$10^9+7$\u53d6\u6a21\uff09\u3002\n- $1\\leqslant n\\leqslant 250,1\\leqslant k\\leqslant 10^9$\u3002\n\n## \u5206\u6790\n\n~~\u5bb9\u65a5\u53c8\u4e0d\u4f1a\u505a\uff0c\u5c31\u662f\u53cd\u6f14\u8fd9\u79cd\u4e1c\u897f\uff0c\u624d\u80fd\u7ef4\u6301\u7684\u4e86\u751f\u6d3b\u3002~~\n\n\u9996\u5148\uff0c\u56e0\u4e3a\u8981\u4f7f\u6bcf\u884c\u6bcf\u5217\u6700\u5c0f\u503c\u4e3a$1$\uff0c\u6240\u4ee5\u6bcf\u4e00\u884c\u90fd\u8981\u6709$1$\u3002\n\n\u6b63\u96be\u5219\u53cd\uff0c\u6211\u4eec\u4e0d\u80fd\u5f88\u5feb\u5730\u8ba1\u7b97$i$\u884c$j$\u5217\u6bcf\u4e00\u884c\u5217\u90fd\u6709$1$\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u8bbe$f_{i,j}$\u8868\u793a\u77e9\u9635\u4e2d**\u6070\u597d**$i$\u884c$j$\u5217\u5168\u90e8\u6ca1\u6709$1$\uff0c$g_{i,j}$\u8868\u793a\u77e9\u9635\u4e2d\u6709$i$\u884c$j$\u5217\u5168\u90e8\u6ca1\u6709$1$\u3002\n\n$g_{i,j}$\u5f88\u5bb9\u6613\u8ba1\u7b97\uff0c\u8bbe$now=n^2-(n\\cdot i)(n\\cdot j)$\uff0c\u5219\u6709\n$$g_{i,j}={n\\choose i}{m\\choose j}(k-1)^{now}k^{n^2-now}$$\n\n\u6839\u636e$g_{i,j}$\u7684\u5b9a\u4e49\uff0c\u5f88\u663e\u7136\u6709\uff1a\n$$g_{i,j}=\\sum_{x=i}^n\\sum_{y=j}^n{x\\choose i}{y\\choose j}f_{x,y}$$\n\n\u5bf9\u4e8e\u4e0a\u9762\u7684\u5f0f\u5b50\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e8c\u9879\u5f0f\u53cd\u6f14\u6765\u5f97\u5230\u53e6\u4e00\u4e2a\u5f0f\u5b50\uff1a\n$$f_{i,j}=\\sum_{x=i}^n\\sum_{y=i}^n{x\\choose i}{y\\choose j}(-1)^{(x-i)+(y-j)}g_{x,y}$$\n\n\u6700\u540e\uff0c\u6211\u4eec\u7684\u7b54\u6848\u5c31\u662f$f_{0,0}$\u4e86\u3002\n\n\u5177\u4f53\u5730\uff0c\u6211\u4eec\u53ef\u4ee5\u9996\u5148$O(n+\\log mod)$\u9884\u5904\u7406\u9006\u5143\uff0c\u7136\u540e$O(n^2)$\u6c42$g$\u6570\u7ec4\uff0c\u7136\u540e\u901a\u8fc7$i=0,j=0$\u5e26\u5165\u4e0a\u5f0f\u5f97\u5230$\\sum_{x=0}^n\\sum_{y=0}^n{x\\choose 0}{y\\choose 0}(-1)^{(x-0)+(y-0)}g_{x,y}=\\sum_{x=0}^n\\sum_{y=0}^n(-1)^{x+y}g_{x,y}$\uff0c\u76f4\u63a5$O(n^2)$\u8ba1\u7b97\u5c31\u597d\u4e86\u3002\n\n\u590d\u6742\u5ea6\uff1a$O(n^2)$\u3002\n\n## \u4ee3\u7801\n```\n#include<stdio.h>\n#define int long long\nconst int maxn=2005,mod=1000000007;\nint n,k,ans;\nint fac[maxn],nfac[maxn],g[maxn][maxn],f[maxn][maxn],amul[maxn*maxn],bmul[maxn*maxn];\ninline int c(int n,int m){\n\treturn fac[n]*nfac[n-m]%mod*nfac[m]%mod;\n}\nint ksm(int a,int b){\n\tint res=1;\n\twhile(b){\n\t\tif(b&1)\n\t\t\tres=res*a%mod;\n\t\ta=a*a%mod,b>>=1;\n\t}\n\treturn res;\n}\nsigned main(){\n\tfac[0]=1;\n\tfor(int i=1;i<maxn;i++)\n\t\tfac[i]=fac[i-1]*i%mod;\n\tnfac[maxn-1]=ksm(fac[maxn-1],mod-2);\n\tfor(int i=maxn-1;i>=1;i--)\n\t\tnfac[i-1]=nfac[i]*i%mod;\n\tscanf(\"%lld%lld\",&n,&k);\n\tamul[0]=bmul[0]=1;\n\tfor(int i=1;i<=n*n;i++)\n\t\tamul[i]=amul[i-1]*(k-1)%mod,bmul[i]=bmul[i-1]*k%mod;\n\tfor(int i=0;i<=n;i++)\n\t\tfor(int j=0;j<=n;j++){\n\t\t\tg[i][j]=c(n,i)*c(n,j)%mod*amul[n*n-(n-i)*(n-j)]%mod*bmul[(n-i)*(n-j)]%mod;\n\t\t}\n\tfor(int i=0;i<=n;i++)\n\t\tfor(int j=0;j<=n;j++){\n\t\t\tif((i+j)%2==0)\n\t\t\t\tans=(ans+g[i][j])%mod;\n\t\t\telse ans=(ans-g[i][j]+mod)%mod;\n\t\t}\n\tprintf(\"%lld\\n\",(ans+mod)%mod);\n\treturn 0;\n}\n```\n\n## \u4e8c\u9879\u5f0f\u53cd\u6f14\u8bc1\u660e\n\u4e8c\u7ef4\u4e8c\u9879\u5f0f\u53cd\u6f14\u8bc1\u660e\uff08\u8fd9\u91cc\u5f0f\u5b50\u4e0d\u592a\u4e00\u6837\uff0c\u4f46\u539f\u7406\u5dee\u4e0d\u591a\uff0c\u61d2\u5f97\u6539\u4e86\uff09\uff1a\n$$f_{n,m}=\\sum_{i=0}^n\\sum_{j=0}^m{n\\choose i}{m\\choose j}g_{i,j}\\Rightarrow g_{n,m}=\\sum_{i=0}^n\\sum_{j=0}^m{n\\choose i}{m\\choose j}(-1)^{(n-i)+(m-j)}f_{i,j}$$\n\n\u8bbe$F_i=f_{i,m}$\uff0c$G_i=\\sum_{j=0}^m{m\\choose j}g_{i,j}$\uff0c\u90a3\u4e48\u7531\u4e0a\u5f0f\u5f97\uff1a\n$$F_n=\\sum_{i=0}^n{n\\choose i}G_i$$\n\n\u7136\u540e\u7531\u4e8c\u9879\u5f0f\u53cd\u6f14\u5f97\uff1a\n$$G_n=\\sum_{i=0}^n{n\\choose i}(-1)^{n-i}F_i$$\n\n\u5c55\u5f00\u6709\uff1a\n$$\\sum_{j=0}^m{m\\choose j}g_{n,j}=\\sum_{i=0}^n{n\\choose i}(-1)^{n-i}f_{i,m}$$\n\n\u518d\u8bbe$F_i'=\\sum_{j=0}^n{n\\choose j}(-1)^{n-j}f_{j,i}$\uff0c$G_i'=g_{n,i}$\uff0c\u90a3\u4e48\u4ee3\u5165\u4e0a\u5f0f\u6709\uff1a\n\n$$F_m'=\\sum_{j=0}^m{m\\choose j}G_j'$$\n\n\u7136\u540e\u7ee7\u7eed\u4e8c\u9879\u5f0f\u53cd\u6f14\uff1a\n$$G_m'=\\sum_{j=0}^m{m\\choose j}(-1)^{m-j}F_j'$$\n\n\u5c55\u5f00\u6709\uff1a\n$$g_{n,m}=\\sum_{j=0}^m{m\\choose j}(-1)^{m-j}\\sum_{i=0}^n{n\\choose i}(-1)^{n-i}f_{i,j}$$\n\n\u7136\u540e\u6574\u7406\u4e00\u4e0b\u5c31\u6709\u4e0a\u9762\u7684\u5f0f\u5b50\u4e86\uff1a\n$$g_{n,m}=\\sum_{i=0}^n\\sum_{j=0}^m{n\\choose i}{m\\choose j}(-1)^{(n-i)+(m-j)}f_{i,j}$$",
        "postTime": 1603381246,
        "uid": 35754,
        "name": "Verdandi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1228E \u3010Another Filling the Grid\u3011"
    },
    {
        "content": "\u7b80\u5355\u5bb9\u65a5\uff0c\u8bbe\u6761\u4ef6 $P_i$ \u4e3a\u67d0\u4e00\u884c\u6216\u5217\u7684\u6700\u5c0f\u503c\u4e3a $1$\uff08\u5b9a\u4e49 $i\\in [1,n]$ \u8868\u793a\u884c\uff0c$i\\in [n+1,2n]$ \u8868\u793a\u5217\uff09\uff0c\u6ee1\u8db3\u6761\u4ef6 $P_i$ \u7684\u96c6\u5408 $A_i$\uff0c$S=[1,2n]\\cap \\mathbb{Z}$\uff0c\u6b32\u6c42\uff1a\n$$\\left|\\bigcap_{i\\in S} A_i\\right|$$\n\n\u6839\u636e\u5bb9\u65a5\u539f\u7406\u7684\u4e24\u4e2a\u5f0f\u5b50\uff1a\n$$\\left|\\bigcap_{i\\in S} A_i\\right|=|U|-\\left|\\bigcup_{i\\in S}\\overline{A_i}\\right|$$\n$$\\left|\\bigcup_{i\\in S}\\overline{A_i}\\right|=\\sum_{T\\subseteq S,T\\neq\\varnothing}(-1)^{|T|-1} \\left|\\bigcap_{j\\in T} \\overline{A_j}\\right|$$\n\n\u4e8e\u662f\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651\u5f53 $x+y=|T|$ \u65f6\uff0c\u5373\u5206\u522b**\u4fdd\u8bc1** $x$ \u884c $y$ \u5217\u7684\u6700\u5c0f\u503c\u4e0d\u4e3a $1$ \u7684\u65b9\u6848\u6570\u3002\n\n\u5148\u8003\u8651\u8fd9 $x$ \u884c $y$ \u5217\u5206\u522b\u662f\u4ec0\u4e48\uff0c\u5728\u6b64\u57fa\u7840\u4e0a\u5728\u8fd9 $x$ \u884c $y$ \u5217\u6d89\u53ca\u5230\u7684 $n^2-(n-x)(n-y)$ \u4e2a\u4f4d\u7f6e\u53ef\u4ee5\u586b\u5927\u4e8e $1$ \u7684\u5171 $k-1$ \u4e2a\u6570\uff0c\u5269\u4f59\u4f4d\u7f6e\u586b\u4efb\u610f\u6570\u3002\n\n\u4e5f\u5c31\u662f\uff1a\n\n$$f(x,y)=\\dbinom{n}{x}\\dbinom{n}{y}(k-1)^{n^2-(n-x)(n-y)}k^{(n-x)(n-y)}$$\n\n\n\u518d\u4ee3\u5165\u5bb9\u65a5\u5373\u53ef\u3002\n\n```cpp\ninline int q_pow(int x,int p){\n    int res=1;\n    while(p){\n        if(p&1) res=1ll*res*x%mod;\n        x=1ll*x*x%mod;\n        p>>=1;\n    }\n    return res;\n}\n\nint n,k;\nint C[255][255];\nint f[255][255];\nint ans;\nint main(){\n    n=read(),k=read();\n    C[0][0]=1;\n    for(int i=1;i<=n;++i){\n        C[i][0]=C[i][i]=1;\n        for(int j=1;j<i;++j){\n            C[i][j]=(C[i-1][j-1]+C[i-1][j])%mod;\n        }\n    }\n    for(int i=0;i<=n;++i){\n        for(int j=0;j<=n;++j){\n            f[i][j]=1ll*q_pow(k-1,n*(i+j)-(i*j))*q_pow(k,(n-i)*(n-j))%mod*C[n][i]%mod*C[n][j]%mod;\n        }\n    }\n    for(int i=0;i<=n;++i){\n        for(int j=0;j<=n;++j){\n            if(!i&&!j) continue;\n            if((i+j)&1) ans=(ans+f[i][j])%mod;\n            else ans=(ans-f[i][j]+mod)%mod;\n        }\n    }\n    ans=(f[0][0]-ans+mod)%mod;\n    printf(\"%d\\n\",ans);\n    return 0;\n}\n```\n\n\u4e5f\u53ef\u4ee5\u4f7f\u7528\u4e8c\u5143\u4e8c\u9879\u5f0f\u53cd\u6f14\uff0c\u5373\u6839\u636e\u4e00\u822c\u5f62\u5f0f\uff08\u6b64\u65f6 $f$ \u5b9a\u4e49\u540c\u4e0a\uff09\uff1a\n$$f(x,y)=\\sum_{i=x}^n\\sum_{j=y}^n \\dbinom{i}{x}\\dbinom{j}{y} g(i,j)$$\n\n\u53cd\u6f14\u5f97\u5230\uff1a\n$$g(x,y)=\\sum_{i=x}^n\\sum_{j=y}^n (-1)^{(i-x)+(j-y)}\\dbinom{i}{x}\\dbinom{j}{y} f(i,j)$$",
        "postTime": 1674005143,
        "uid": 321177,
        "name": "SoyTony",
        "ccfLevel": 6,
        "title": "CF1228E \u9898\u89e3"
    },
    {
        "content": "[CF 1228E](https://codeforces.com/problemset/problem/1228/E)\u3002\n\n## Description\n\n\u6709\u4e00\u4e2a $n \\times n$ \u7684\u7f51\u683c\u56fe\uff0c\u5bf9\u4e8e\u7f51\u683c\u56fe\u4e2d\u7684\u6bcf\u4e00\u4e2a\u683c\u70b9\uff0c\u90fd\u53ef\u4ee5\u7528 $1 \\sim k$ \u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u6570\u5b57\u6765\u586b\u5145\u8fd9\u4e2a\u683c\u70b9\u3002\n\n\u95ee\u6709\u591a\u5c11\u79cd\u586b\u5145\u65b9\u6848\uff0c\u4f7f\u5f97\u6bcf\u884c\u6bcf\u5217\u7684\u6700\u5c0f\u503c\u5747\u4e3a $1$\u3002\u7b54\u6848\u5bf9 $10^9 + 7$ \u53d6\u6a21\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1 \\leq n \\leq 250$\uff0c$1 \\leq k \\leq 10^9$\u3002  \n\u65f6\u7a7a\u9650\u5236\uff1a$1000 \\ \\mathrm{ms} / 250 \\ \\mathrm{MiB}$\u3002\n\n## Solution\n\n\u4e0d\u5931\u4e00\u822c\u6027\uff0c\u53ef\u4ee5\u94a6\u5b9a\u6240\u6709\u884c\u662f\u5408\u6cd5\u7684\uff0c\u4ee5\u9488\u5bf9\u5217\u7684\u5408\u6cd5\u6027\u3002\u5728\u6ee1\u8db3\u6240\u6709\u884c\u662f\u5408\u6cd5\u7684\u60c5\u51b5\u4e0b\uff0c**\u94a6\u5b9a** $i$ \u5217\u4e0d\u5408\u6cd5\u7684\u65b9\u6848\u6570\u4e3a\uff1a\n$$\n\\binom{n}{i}\\left(k^{n - i}(k - 1)^i - (k - 1)^n\\right)^n\n$$\n\n\u8fd0\u7528\u5bb9\u65a5\u8ba1\u7b97\u7b54\u6848\uff0c\u53ef\u4ee5\u8bc1\u660e\u5bb9\u65a5\u7684\u7cfb\u6570\u4e3a $\\pm 1$ \u4ea4\u66ff\uff0c\u6545\u7b54\u6848\u4e3a\uff1a\n$$\n\\sum\\limits_{i = 0}^n (-1)^i \\binom{n}{i} \\left(k^{n - i}(k - 1)^i - (k - 1)^n\\right)^n\n$$\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n \\log n)$\uff0c\u74f6\u9888\u5728\u4e8e\u5feb\u901f\u5e42\u3002\n\n#### \u8bc1 1\n\n\u8003\u8651**\u6070\u597d** $j(j \\geq 1)$ \u5217\u4e0d\u5408\u6cd5\u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u5728\u8003\u8651**\u94a6\u5b9a** $0 \\sim j - 1$ \u5217\u4e0d\u5408\u6cd5\u7684\u65b9\u6848\u6570\u65f6\uff0c\u4f1a\u5c06\u8be5\u7ec4\u65b9\u6848\u591a\u7b97\u8fd9\u4e48\u591a\u6b21\uff1a\n$$\n\\begin{aligned}\n\\mathbf{cnt}\n& = \\sum\\limits_{i = 0}^{j - 1} (-1)^i \\binom{j}{i} \\\\\n& = \\sum\\limits_{i = 0}^{j}(-1)^i \\binom{j}{i} - (-1)^j \\\\\n& = \\left(1 + (-1)\\right)^j - (-1)^j \\\\\n& = -(-1)^j\n\\end{aligned}\n$$\n\u65e2\u7136\u591a\u7b97\u4e86 $-(-1)^j$ \u6b21\uff0c\u5c31\u53ef\u4ee5\u5c06\u5f53\u524d\u7684\u5bb9\u65a5\u7cfb\u6570\u8bbe\u4e3a $(-1)^j$\uff0c\u6b64\u65f6\u6070\u597d $j$ \u5217\u4e0d\u5408\u6cd5\u7684\u65b9\u6848\u6570\u5c31\u88ab\u62b5\u6d88\u4e86\u3002\n\nQ.E.D\n\n#### \u8bc1 2\n\n\u8bbe**\u6070\u597d** $i$ \u5217\u4e0d\u5408\u6cd5\u7684\u65b9\u6848\u6570\u4e3a $f(i)$\uff0c**\u94a6\u5b9a** $i$ \u5217\u4e0d\u5408\u6cd5\u7684\u65b9\u6848\u6570\u4e3a $g(i)$\uff0c\u6613\u5f97\uff1a\n$$\ng(i) = \\binom{n}{i}\\left(k^{n - i}(k - 1)^i - (k - 1)^n\\right)^n\n$$\n$$\ng(i) = \\sum\\limits_{j = i}^n \\binom{j}{i} f(j)\n$$\n\u8fd0\u7528\u4e8c\u9879\u5f0f\u53cd\u6f14\uff0c\u53ef\u5f97\uff1a\n$$\nf(i) = \\sum\\limits_{j = i}^n (-1)^{j - i} \\binom{j}{i} g(j)\n$$\n\u5219\uff1a\n$$\n\\begin{aligned}\n\\mathbf{ans}\n& = f(0) \\\\\n& = \\sum\\limits_{i = 0}^n(-1)^i \\binom{i}{0} g(i) \\\\\n& = \\sum\\limits_{i = 0}^n (-1)^i \\binom{n}{i} \\left(k^{n - i}(k - 1)^i - (k - 1)^n\\right)^n\n\\end{aligned}\n$$\nQ.E.D",
        "postTime": 1651047489,
        "uid": 129578,
        "name": "Calculatelove",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1228E\u3010Another Filling the Grid\u3011"
    },
    {
        "content": "## CF1228E Another Filling the Grid\n\n\u63d0\u4f9b\u5b8c\u6574\u7684\u601d\u8def\u3002\n\n### \u9898\u610f\n\n\u7565\u3002\n\n### \u9898\u89e3\n\n\u5148\u5047\u8bbe\u6240\u6709\u6761\u4ef6\u4e2d\u884c\u5fc5\u6ee1\u8db3\u6761\u4ef6\u3002\n\n\u5bf9\u4e8e\u5217\uff0c\u8bbe $f(i)$ \u8868\u793a\u6070\u597d $i$ \u4e2a\u5217\u6ca1\u6709\u7684\u7b54\u6848\uff0c$g(i)$ \u8868\u793a\u81f3\u5c11\uff08\u94a6\u5b9a\uff09$i$ \u4e2a\u5217\u6ca1\u6709\u7684\u7b54\u6848\u3002\n\n\u6613\u77e5\uff1a$ans = f(0)$\u3002\n\n\u6839\u636e\u6761\u4ef6\uff0c\u6709\u7b49\u5f0f\uff1a  \n$$\\displaystyle g(n)=\\sum^N_{i=n} \\binom{i}{n} f(i)$$\n\n\u4e8c\u9879\u5f0f\u53cd\u6f14\u3002\n\n$$\\displaystyle f(n)=\\sum^N_{i=n} (-1)^{i-n}\\binom{i}{n}g(i)$$\n\n\u8003\u8651\u600e\u4e48\u7b97 $g$\u3002\n\n$g(n)$ \u7b49\u4ef7\u4e8e\u884c\u5408\u6cd5\u65f6\uff0c\u94a6\u5b9a $n$ \u5217\u6ca1\u6709 $1$ \u7684\u65b9\u6848\u6570\u3002  \n\u4e5f\u5c31\u662f $N$ \u884c\uff0c$N-n$ \u5217\u7684\u884c\u5408\u6cd5\u65b9\u6848\u518d\u4e58\u4e0a $(K-1)^{nN}$\uff08\u5217\u94a6\u5b9a\u65b9\u6848\uff09\u548c $\\binom{N}{n}$\uff08\u9009\u62e9\u5217\u65b9\u6848\uff09\u3002\n\n\u8003\u8651\u884c\u5408\u6cd5\u600e\u4e48\u7b97\u3002\u7136\u540e\u4f60\u53d1\u73b0\uff1a  \n\u884c\u53c8\u4f1a\u7b97\u91cd\uff01\n\n\u6240\u4ee5\u6362\u4e00\u79cd\u7b97\u6cd5\uff0c\u7528\u51cf\u6cd5\u539f\u7406\uff0c\u5168\u96c6\u51cf\u53bb\u4e0d\u5408\u6cd5\uff0c\u5373\u4e3a $K^{N(N-n)} - (K-1)^{N*(N-n)}$\u3002\n\n\u63d0\u4e00\u4e2a $N$ \u6b21\u65b9\uff0c\u5f97\uff1a\n\n$$g(n) = (((K^{(N-n)}-(K-1)^{(N-n)})(K-1)^n)^N$$\n\n\u5e26\u5165\u539f\u5f0f\u5373\u53ef\u3002\n\n\u70b9\u4e2a\u8d5e\u5427\u3002\n\n```cpp\n//\u6708\u4eae\u7167\u8000\u9752\u7a97\uff0c\u7a97\u91cc\u7a97\u5916\u7686\u6709\u9752\u8272\u7684\u5149\u3002\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn = 300, mod = 1e9+7;\nint pw[maxn],pw_1[maxn],n,ans,fac[maxn],inf[maxn],K;\nint ksm(int x,int y) {int r=1;while(y) y&1?r=1ll*r*x%mod:0,x=1ll*x*x%mod,y>>=1;return r;}\nint C(int x,int y) {return x<y?0:1ll*fac[x]*inf[y]%mod*inf[x-y]%mod;}\nvoid ini(int mx) {\n\tfac[0]=1;for(int i=1;i<=mx;i++) fac[i]=1ll*fac[i-1]*i%mod;\n\tinf[mx]=ksm(fac[mx],mod-2);for(int i=mx-1;~i;i--) inf[i]=1ll*inf[i+1]*(i+1)%mod;\n}\nsigned main() {\n\tcin>>n>>K,ini(n);\n\tpw_1[0]=pw[0]=1;for(int i=1;i<=n;i++) pw_1[i]=pw_1[i-1]*(K-1ll)%mod,pw[i]=1ll*pw[i-1]*K%mod;\n\tfor(int i=0,r=1;i<=n;r=mod-r,i++) ans=(ans+1ll*r/**C(i,0)*/*C(n,i)%mod*ksm(1ll*(pw[n-i]+mod-pw_1[n-i])*pw_1[i]%mod,n))%mod;\n\tcout<<ans<<'\\n';\n\treturn 0;\n}\n```",
        "postTime": 1629982644,
        "uid": 106182,
        "name": "KaisuoShutong",
        "ccfLevel": 0,
        "title": "CF1228E Another Filling the Grid \u9898\u89e3"
    },
    {
        "content": "[Link](https://www.luogu.com.cn/problem/CF1228E)\n-----------\n\n### Solution\n\n\u4e0d\u77e5\u9053\u600e\u4e48\u5c31\u60f3\u5230\u4e86\u2026\u2026\u7528 $G(x,y)$ \u8868\u793a\u6070\u597d\u6709 $x$ \u548c $y$ \u884c\u6ca1\u6709 $1$\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f $G(0,0)$\n\n\u7528 $F(x,y)$ \u8868\u793a\u5f3a\u5236\u6709 $x$ \u884c $y$ \u5217\u6ca1\u6709 $1$ \uff0c\u5269\u4e0b\u7684\u968f\u4fbf\u586b\u7684\u53ef\u91cd\u65b9\u6848\uff0c\u90a3\u4e48\n$$F(x,y)=\\binom{n}{x}\\binom{n}{y}k^{(n-x)(n-y)}\\times k^{n^2-(n-x)(n-y)}$$\n\u7ec4\u5408\u610f\u4e49\u4e3a\u5148\u9009 $x$ \u884c $y$ \u5217\u6ca1\u6709 $1$ \uff0c\u5bf9\u4e8e\u8fd9\u9009\u4e86\u7684\u90e8\u5206\uff0c\u9664\u53bb\u4e0d\u80fd\u9009 $1$\uff0c\u90a3\u4e48\u5171\u6709 $(k-1)^{n^2-(n-x)(n-y)}$ \u79cd\uff0c\u5bf9\u4e8e\u6ca1\u6709\u9009\u7684\uff0c\u53ef\u4ee5\u968f\u4fbf\u586b\u6570\u3002\n\n\u5bb9\u6613\u53d1\u73b0\n$$F(x,y)=\\sum_{i=x}^n \\sum_{j=y}^n \\binom{i}{x}\\binom{j}{y}G(i,j)$$\n\n\u53cd\u6f14\u4e00\u4e0b\uff0c\u5f97\u5230\n$$G(x,y)=\\sum_{i=x}^n \\sum_{j=y}^n (-1)^{i+j-x-y} \\binom{i}{x}\\binom{j}{y} F(i,j)$$\n\u4ee3\u5165 $x=0,y=0$ \uff0c\u7b54\u6848\u5373\u4e3a\n$$\\sum_{i=0}^n \\sum_{j=0}^n (-1)^{i+j} \\binom{n}{i}\\binom{n}{j} k^{(n-i)(n-j)}\\times k^{n^2-(n-i)(n-j)}$$\n\n$O(n^2\\log n)$ \u66b4\u529b\u6c42\u89e3\u5373\u53ef\u3002\n",
        "postTime": 1610452628,
        "uid": 83337,
        "name": "wwlw",
        "ccfLevel": 7,
        "title": "Another Filling the Grid"
    },
    {
        "content": "\u672c\u9898\u89e3\u662f\u4e00\u4e2a\u5e76\u4e0d\u662f\u5f88\u4f18\u79c0\u4f46\u662f\u51fa\u9898\u4eba\u653e\u8fc7\u53bb\u4e86\u7684$O(n^3)$DP\u3002\n\n\u5b9a\u4e49$F[i][j]$\u662f\u53ea\u586b\u4e86\u524d$i$\u884c\uff0c\u6709\u4e14\u4ec5\u6709\u5171$j$\u5217\u4e0a\u67091\u3002\n\n\u9996\u5148\u6709\u4e00\u4e2a\u663e\u7136\u7684\u8fb9\u754c\uff1a$F[1][c]=C^c_n\\cdot(k-1)^{n-c}$\u3002\u5f88\u597d\u7406\u89e3\uff1a\u4ece$n$\u5217\u9009\u51fa$i$\u5217\u586b1\uff0c\u5176\u4ed6$n-i$\u5217\u53ef\u4ee5\u586b\u4efb\u4f55\u975e1\u7684\u6570\u3002\n\n$F[r][c]$\u53ef\u4ee5\u7531\u4efb\u610f$F[r-1][c0](c0<c)$\u8f6c\u79fb\u5f97\u5230\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/lrrynml7.png)\n\n- $c$\u6bd4$c0$\u591a\u4e86$c-c0$\u4e2a\u67091\u5217\uff0c\u8fd9\u4e9b\u5217\u8981\u4ece\u539f\u6765$n-c0$\u7684\u65e01\u5217\u4e2d\u9009\u51fa\uff0c\u56e0\u800c\u8d21\u732e\u4e58$C_{n-c0}^{c-c0}$\uff1b\n\n- \u539f\u6765\u67091\u7684$c0$\u5217\u53ef\u4ee5\u5b8c\u5168\u968f\u4fbf\u586b\uff0c\u56e0\u800c\u8d21\u732e\u4e58$k^{c0}$\uff1b\n\n- \u539f\u6765\u6ca11\u73b0\u5728\u4e5f\u6ca11\u7684$n-c$\u5217\u53ef\u4ee5\u968f\u4fbf\u586b\u975e1\u7684\u6570\uff0c\u56e0\u800c\u8d21\u732e\u4e58$(k-1)^{n-c}$\uff1b\n\n- \u522b\u5fd8\u4e86$F[r-1][c0]$\u672c\u8eab\u3002\u4e8e\u662f\u603b\u5171\u8d21\u732e\u4e86\uff1a\n\n$$C_{n-c0}^{c-c0}\\cdot k^{c0}\\cdot (k-1)^{n-c}\\cdot F[r-1][c0]$$\n\n$F[r][c]$\u4e5f\u53ef\u4ee5\u7531$F[r-1][c]$\u8f6c\u79fb\u5f97\u5230\u3002\n\n- \u6ce8\u610f\uff0c\u539f\u6765\u67091\u7684$c$\u5217\u4e2d\u81f3\u5c11\u67091\u5217\uff0c\u4f7f\u5f97\u5b83\u5728\u8fd9\u4e00\u884c\u4e5f\u586b\u4e861\uff0c\u5426\u5219\u8fd9\u4e00\u884c\u5c31\u6ca11\u4e86\u3002\u6240\u4ee5\u8d21\u732e\u4e58$k^c-(k-1)^c$\uff1b\uff08\u6240\u6709\u65b9\u6848\u6570-\u6ca11\u7684\u65b9\u6848\u6570=\u81f3\u5c11\u6709\u4e00\u4e2a1\u7684\u65b9\u6848\u6570\uff09\n\n- \u5269\u4e0b$n-c$\u5217\u53ef\u4ee5\u4efb\u610f\u586b\u975e1\u6570\uff0c\u6240\u4ee5\u8d21\u732e\u4e58$(k-1)^{n-c}$\uff1b\n\n- \u522b\u5fd8\u4e86$F[r-1][c]$\u672c\u8eab\u3002\u4e8e\u662f\u603b\u5171\u8d21\u732e\u4e86\n\n$$(k^c-(k-1)^c)\\cdot (k-1)^{n-c}\\cdot F[r-1][c]$$\n\n\u4e8e\u662f\u9884\u5904\u7406\u4e00\u4e0b\u7ec4\u5408\u6570\u548c$k,k-1$\u7684\u5e42\u5373\u53ef\u3002\u4ee3\u7801\u5982\u4e0b\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\n\nconst int p=1000000007;\n\nint N,K;\nint inv[305];\nint powK[305],powK1[305];\nint C[305][305];\nint F[305][305];//\u7b2ci\u884c\uff0c\u5171j\u5217\u67091 \nint qpow(int a,int k){\n\tint ans=1;\n\twhile(k){\n\t\tif(k&1) ans=1LL*ans*a%p;\n\t\ta=1LL*a*a%p;\n\t\tk>>=1;\n\t}\n\treturn ans;\n}\n\nint d;\n\nint main(){\n\tscanf(\"%d%d\",&N,&K);\n\tpowK[0]=powK1[0]=1;\n\tinv[1]=1;\n\tfor(int i=2;i<=N;i++) inv[i]=1LL*(p-p/i)*inv[p%i]%p;\n\tfor(int i=1;i<=N;i++) powK[i]=1LL*powK[i-1]*K%p,powK1[i]=1LL*powK1[i-1]*(K-1)%p;\n\tfor(int i=1;i<=N;i++){\n\t\tC[i][0]=1;\n\t\tfor(int j=1;j<=i;j++)\n\t\t\tC[i][j]=1LL*C[i][j-1]*(i-j+1)%p*inv[j]%p;\n\t}\n\t\n\tfor(int i=1;i<=N;i++)\n\t\tF[1][i]=1LL*C[N][i]*powK1[N-i]%p;\n\tfor(int i=2;i<=N;i++)\n\tfor(int j=1;j<=N;j++){\n\t\tfor(int k=1;k<j;k++)\n\t\t\tF[i][j]=((ll)F[i][j]+1LL*powK[k]*C[N-k][j-k]%p*powK1[N-j]%p*F[i-1][k]%p)%p;\n\t\tF[i][j]=((ll)F[i][j]+1LL*(powK[j]-powK1[j]+p)%p*powK1[N-j]%p*F[i-1][j]%p)%p;\n\t}\n\t\n\tprintf(\"%d\\n\",F[N][N]);\n\t\n\treturn 0;\n}\n```\n",
        "postTime": 1569822654,
        "uid": 58567,
        "name": "x\u4e49x",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1228E \u3010Another Filling the Grid\u3011"
    },
    {
        "content": "~~\u6211\u6628\u665a\u4e00\u5b9a\u662f\u964d\u667a\u4e86~~\n\n\u56de\u5f52\u6b63\u9898\uff0c\u9996\u5148\u53ef\u4ee5\u6ce8\u610f\u5230\u6ca1\u5217\u4e00\u5b9a\u662f\u6709\u4e00\u4e2a$1$\u7684\uff0c\u7136\u540e$n$\u8fd8\u6bd4\u8f83\u5c0f\uff0c\u6240\u4ee5\u5e94\u8be5\u662f\u4e00\u9053$dp$\n\n\u8003\u8651\u5f3a\u5236\u4ee4\u6bcf\u4e00\u5217\u90fd\u6709\u4e00\u4e2a$1$\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981$dp$\u51fa\u884c\u7684\u7ed3\u679c\u5373\u53ef\n\n\u8bbe$dp_{i,j}$\u8868\u793a$dp$\u5230\u7b2c$i$\u5217\uff0c\u6709$j$\u884c\u7a7a\u7740\u7684\u65b9\u6848\u6570\n\n\u8f6c\u79fb\u7684\u8bdd\u5c31\u8003\u8651\u586b\u5165$1/$\u5176\u4ed6\n\n\u663e\u7136\u7684\u662f\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u4e00\u4e2a$k$\u7136\u540e\u8f6c\u79fb\uff0c\u8fd9\u6837\u5e94\u8be5\u662f$O(n^3)$\u7684\n\n$$dp_{i,j}=dp_{i-1,k}*(m-1)^{n-j}(m)^k*\\rm C_{n-k}^{j-k}$$\n\n\u7136\u540e\u8fd9\u6837\u4f1a\u9519\n\n\u8fd9\u662f\u56e0\u4e3a\u5bf9\u4e8e$j>k$\u6211\u4eec\u901a\u8fc7\u7ec4\u5408\u6570(\u5b9e\u9645\u4e0a\u662f\u4e00\u5b9a\u9700\u8981\u989d\u5916\u586b\u5165$1$)\u4fdd\u8bc1\u4e86\u6bcf\u4e00\u5217\u81f3\u5c11\u6709\u4e00\u4e2a$1$\n\n\u4f46\u5bf9\u4e8e\u4e24\u8005\u76f8\u7b49\u7684\u60c5\u51b5\u80af\u5b9a\u8fd8\u662f\u4f1a\u91cd\u590d\u7684(\u5fc5\u987b\u8981\u586b\u5165$1$)\n\n\u6240\u4ee5\u5bf9\u4e8e$j=k$\u7684\u76f4\u63a5\u5bb9\u65a5\u4e00\u4e0b\u5c31\u597d\u4e86\uff0c\u590d\u6742\u5ea6$O(n^3)$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define rep( i, s, t ) for( register int i = s; i <= t; ++ i ) \n#define re register\n#define int long long\nint gi() {\n    int cn = 0 ; char cc = getchar() ;\n    while( cc > '9' || cc < '0' ) cc = getchar() ;\n    while( cc >= '0' && cc <= '9' ) cn = cn * 10 + cc - '0', cc = getchar() ;\n    return cn ; \n}\nconst int P = 1e9 + 7 ;\nconst int N = 250 + 5 ; \nint n, m, C[N][N], dp[N][N], inv[N], fac[N] ;\nsigned main(){\n    n = gi(), m = gi() ; C[0][0] = 1, fac[0] = inv[0] = 1 ;\n    rep( i, 1, n ) {\n          C[i][0] = 1, inv[i] = ( inv[i - 1] * m ) % P, fac[i] = ( fac[i - 1] * ( m - 1 ) ) % P ; \n          rep( j, 1, n ) C[i][j] = ( C[i - 1][j] + C[i - 1][j - 1] ) % P;\n    }\n    dp[0][0] = 1 ;\n    rep( i, 1, n ) {\n        rep( j, 1, n ) {\n            dp[i][j] = dp[i - 1][j] * fac[n - j] % P * ( inv[j] - fac[j] + P ) % P ; \n            rep( k, 0, j - 1 ) {\n                dp[i][j] = ( dp[i][j] + dp[i - 1][k] * ( C[n - k][j - k] ) % P * \n                inv[k] % P * fac[n - j] % P ) % P ;\n            }\n        }\n    }\n    printf(\"%I64d\\n\", dp[n][n] % P ) ;\n    return 0 ;\n}\n```",
        "postTime": 1569820840,
        "uid": 30036,
        "name": "Soulist",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1228E \u3010Another Filling the Grid\u3011"
    },
    {
        "content": "# \u9898\u76ee\n\n[Luogu](https://www.luogu.com.cn/problem/CF1228E)\n\n[CF](https://codeforces.com/problemset/problem/1228/E)\n\n\u7ed9\u5b9a\u4e00\u4e2a$n\\cdot n$\u7684\u77e9\u9635\uff0c\u7528$1$\u5230$k$\u586b\u5145\uff0c\u8981\u6c42\u6bcf\u884c\u6bcf\u5217\u81f3\u5c11\u6709$1$\u4e2a$1$\u200b\uff0c\u6c42\u65b9\u6848\u6570\u3002\n\n# Sol\n\n\u611f\u89c9\u548c\u4e00\u9053\u4e09\u8272\u586b\u5145\u7684\u9898\u6709\u4e00\u4e9b\u5171\u540c\u4e4b\u5904\u3002[CF997C](https://www.luogu.com.cn/problem/CF997C)\n\n\u4f46\u662f\u8fd9\u9053\u9898\u53ef\u4ee5$O(n^3)$\uff08\u5e94\u8be5\u5427\uff09\u3002\n\n\u6240\u4ee5\u4ed4\u7ec6\u8f6c\u5316\u4e00\u4e0b\u9898\u610f\u5c31\u53ef\u4ee5\u6709\u5bb9\u65a5\u7684\u601d\u8def\u3002\n\n\u679a\u4e3e$i,j$\uff0c\u8868\u793a\u94a6\u5b9a$i$\u884c$j$\u5217\u4e0d\u5408\u6cd5\uff0c\u5269\u4e0b\u7684\u968f\u4fbf\u653e\u3002\n\n\u5982\u4f55\u4fdd\u8bc1\u4e0d\u5408\u6cd5\u5462\uff1f\u5f3a\u5236\u53ea\u80fd\u9009\u53d6$2$\u5230$k$\u7684\u6574\u6570\u5c31\u884c\u4e86\u3002\n$$\nans=\\sum\\limits_{i=0}^n\\sum\\limits_{j=0}^n(-1)^{i+j}\\binom{n}{i}\\binom{n}{j}k^{(n-i)(n-j)}(k-1)^{n\\cdot n-(n-i)(n-j)}\n$$\n$k^{(n-i)(n-j)}$\u7684\u610f\u601d\u662f\u9664\u53bb\u5f3a\u5236\u4e0d\u5408\u6cd5\u7684$i$\u200b\u884c$j$\u5217\u4ee5\u5916\u5176\u4f59\u7684\u968f\u4fbf\u653e\u3002\n\n\u590d\u6742\u5ea6$O(n^2log\\ n)$\u3002\n\n\u53ef\u4ee5\u9884\u5904\u7406\u5feb\u901f\u5e42\u7701\u6389\u4e00\u4e2a$log$\u200b\uff0c\u4f46\u6ca1\u5fc5\u8981\u3002\n\n# Code\n\n\u5728[\u8fd9\u91cc](https://www.cnblogs.com/xxbbkk/p/15361928.html)\n\n# \u5b8c\u7ed3\u6492\u82b1\u2740",
        "postTime": 1633157350,
        "uid": 101475,
        "name": "xxbbkk",
        "ccfLevel": 0,
        "title": "\u9898\u89e3[CF1228E nother Filling the Grid]"
    }
]
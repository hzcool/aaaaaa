[
    {
        "content": "\u9898\u610f\uff1a\u4e24\u4e2a\u6392\u5217 $a,b$\uff0c\u6bcf\u6b21\u9009\u62e9\u4e00\u4e2a $i$\uff0c\u628a\u4e24\u4e2a\u6392\u5217\u4e2d\u7b49\u4e8e $i$ \u7684\u6570\u4e0e $a_i,b_i$ \u4ea4\u6362\uff0c\u6c42\u628a\u4e24\u4e2a\u6392\u5217\u6392\u597d\u5e8f\u7684\u6700\u5c0f\u64cd\u4f5c\u6b21\u6570\u3002\n\n\u5206\u6790\uff1a\n\n\u5957\u8def\u5316\uff0c\u628a\u4e24\u4e2a\u6392\u5217\u770b\u6210\u4e24\u5f20\u56fe\uff0c\u7b2c\u4e00\u5f20\u56fe\u4e2d $i$ \u5411 $a_i$ \u8fde\u8fb9\uff0c\u7b2c\u4e8c\u5f20\u56fe\u4e2d $i$ \u5411 $b_i$ \u8fde\u8fb9\u3002\n\n\u7b80\u5316\u95ee\u9898\uff0c\u5982\u679c\u53ea\u6709\u4e00\u5f20\u56fe\uff1f\n\n\u663e\u7136\uff0c\u7b54\u6848\u4e3a ```n - \u73af\u7684\u4e2a\u6570```\u3002\u6bcf\u6b21\u64cd\u4f5c\u76f8\u5f53\u4e8e\u628a\u4e00\u4e2a\u70b9\u641e\u81ea\u73af\uff0c\u5176\u6240\u5728\u7684\u73af\u7684\u70b9\u7684\u4e2a\u6570\u51cf\u4e00\uff0c\u6700\u540e\u5269\u4e0b\u90a3\u4e2a\u70b9\u4e0d\u7528\u64cd\u4f5c\u3002\u5373\uff1a\u6bcf\u4e2a\u73af\u90fd\u53ef\u4ee5\u6709\u4e00\u4e2a\u4e0d\u4f1a\u88ab\u64cd\u4f5c\u7684\u70b9\uff0c $n$ \u4e2a\u70b9\u4e2d\u4e00\u5171\u6709 ```\u73af\u7684\u4e2a\u6570``` \u4e2a\u70b9\u4e0d\u4f1a\u88ab\u64cd\u4f5c\u3002\n\n\u4e24\u4e2a\u73af\u5462\uff1f\u6211\u4eec\u4f7f\u7528\u7c7b\u4f3c\u7684\u601d\u60f3\uff0c\u9009\u51fa\u4e00\u4e9b\u4e0d\u64cd\u4f5c\u7684\u70b9\u3002\u4f46\u6709\u4e2a\u6761\u4ef6\uff1a\u6bcf\u4e2a\u73af\u6700\u591a\u9009 $1$ \u4e2a\u70b9\u3002\n\n\u5047\u8bbe\u6709\u4e00\u4e2a\u70b9 $i$\uff0c\u5728\u7b2c\u4e00\u5f20\u56fe\u4e2d\u5904\u4e8e\u7b2c $ca_i$ \u4e2a\u73af\uff0c\u7b2c\u4e8c\u5f20\u56fe\u4e2d\u5904\u4e8e\u7b2c $cb_i$ \u4e2a\u73af\uff0c\u5982\u679c\u9009\u62e9 $i$\uff0c\u90a3\u4e48\u8fd9\u4e24\u4e2a\u73af\u5c31\u4e0d\u80fd\u9009\u62e9\u5176\u4ed6\u7684\u70b9\u3002\n\n\u8fd9\u5c31\u6709\u70b9\u50cf\u4e8c\u5206\u56fe\u5339\u914d\u4e86\uff0c\u7b2c\u4e00\u5f20\u56fe\u7684\u6bcf\u4e2a\u73af\u548c\u7b2c\u4e8c\u5f20\u56fe\u7684\u6bcf\u4e2a\u73af\u5339\u914d\uff0c\u4e00\u4e2a\u73af\u6700\u591a\u6709 $1$ \u6761\u5339\u914d\u8fb9\u3002\n\n\u4e8e\u662f\u679a\u4e3e\u6bcf\u4e2a\u70b9 $i$\uff0c\u628a $ca_i$ \u548c $cb_i$ \u8fde\u8fb9\uff0c\u8dd1\u5308\u7259\u5229\uff0c\u6700\u5927\u5339\u914d\u5c31\u662f\u9009\u51fa\u6700\u591a\u7684\u4e0d\u64cd\u4f5c\u7684\u70b9\u3002\n\n\u7528 $n$ \u51cf\u53bb ```\u6700\u5927\u5339\u914d\u6570``` \u5373\u53ef\uff0c\u8f93\u51fa\u7684\u65b9\u6848\u5e94\u662f\u9664\u4e86\u9009\u62e9\u7684\u70b9\u7684\u5269\u4e0b\u90a3\u4e9b\u70b9\u3002\n\n\u5bf9\u4e8e\u679a\u4e3e\u7684\u6bcf\u4e2a\u70b9 $i$\uff0c\u6700\u591a\u5efa\u7acb\u4e00\u6761\u8fb9\uff08\u56e0\u4e3a\u8fd8\u4f1a\u6709\u91cd\u8fb9\uff09\uff0c\u6700\u591a\u5efa\u7acb $n$ \u6761\u8fb9\uff0c\u6240\u4ee5\u5308\u7259\u5229\u7684\u65f6\u95f4\u662f\u5e73\u65b9\u7ea7\u522b\u7684\uff0c\u603b\u4f53\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^2)$\n\n[**code**](https://codeforces.com/contest/1783/submission/188829624)",
        "postTime": 1673412073,
        "uid": 375953,
        "name": "Sktn0089",
        "ccfLevel": 7,
        "title": "\u3010\u9898\u89e3CF1783F\u3011Double Sort II"
    },
    {
        "content": "# CF1783F \u9898\u89e3\n\n\n\n## \u601d\u8def\u5206\u6790\n\n\u5148\u8003\u8651\u53ea\u5bf9 $a$ \u6392\u5e8f\u7684\u6700\u5c0f\u82b1\u8d39\uff0c\u663e\u7136\u8fde\u63a5 $i\\to a_i$ \u5efa\u56fe\uff0c\u5bf9\u4e8e\u56fe\u4e2d\u7684\u6bcf\u4e00\u4e2a\u5927\u5c0f\u4e3a $|\\mathbf C|$ \u7684\u7f6e\u6362\u73af\uff0c\u6839\u636e\u590d\u539f\u7f6e\u6362\u7684\u7ed3\u8bba\uff0c\u6211\u4eec\u9700\u8981 $|\\mathbf C|-1$ \u6b21\u64cd\u4f5c\u628a\u8fd9\u4e2a\u73af\u590d\u539f\uff0c\u8bbe $cyc$ \u4e3a\u56fe\u4e2d\u73af\u7684\u6570\u91cf\uff0c\u7b54\u6848\u4e3a $n-cyc$\uff0c\u6211\u4eec\u53ef\u4ee5\u7406\u89e3\u4e3a\u6bcf\u4e2a\u5728\u6bcf\u4e2a\u73af\u4e2d\u9009\u51fa\u4e00\u4e2a $x$ \u4e0d\u64cd\u4f5c\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u540c\u65f6\u5bf9 $a$ \u548c $b$ \u6392\u5e8f\uff0c\u7c7b\u4f3c\u4e0a\u9762\uff0c\u5bf9\u4e8e $a,b$ \u4e2d\u7684\u6bcf\u4e2a\u73af\uff0c\u5206\u522b\u9009\u51fa\u4e00\u4e2a $x$ \u4e0d\u64cd\u4f5c\uff0c\u6211\u4eec\u79f0 $x$ \u4e3a\u8fd9\u4e2a\u73af\u7684\u201c\u4ee3\u8868\u201d\u3002\n\n\u6ce8\u610f\u5230\u53ea\u6709 $x$ \u540c\u65f6\u662f $a$ \u4e2d\u6240\u5c5e\u73af\u548c $b$ \u4e2d\u6240\u5c5e\u73af\u7684\u201c\u4ee3\u8868\u201d\uff0c\u6211\u4eec\u624d\u53ef\u4ee5\u4e0d\u64cd\u4f5c $x$\u3002\n\n\u56e0\u6b64\u628a $a$ \u4e2d\u7684\u6bcf\u4e2a\u73af\u770b\u6210\u5de6\u90e8\u70b9\uff0c$v$ \u4e2d\u7684\u6bcf\u4e2a\u73af\u770b\u6210\u5176\u53f3\u90e8\u70b9\uff0c\u6bcf\u4e2a\u4f4d\u7f6e $i$ \u770b\u6210\u4e00\u6761\u8fde\u63a5 $i$ \u5728 $a$ \u4e2d\u6240\u5c5e\u73af\u548c\u5728 $b$ \u4e2d\u6240\u5c5e\u73af\u7684\u4e00\u6761\u8fb9\uff0c\u5f97\u5230\u4e00\u5f20\u4e8c\u5206\u56fe\uff0c\u4e8c\u5206\u56fe\u7684\u6bcf\u6761\u5339\u914d\u8fb9\u5bf9\u5e94\u9009\u62e9\u76f8\u5e94\u7684 $x$ \u4f5c\u4e3a\u5176\u5728\u4e24\u8fb9\u6240\u5728\u7684\u73af\u7684\u201c\u4ee3\u8868\u201d\u7136\u540e\u8df3\u8fc7\u5bf9 $x$ \u7684\u64cd\u4f5c\u3002\n\n\u8bbe\u5176\u6700\u5927\u5339\u914d\u5927\u5c0f\u4e3a $|\\mathbf M|$\uff0c\u90a3\u4e48\u7b54\u6848\u4e3a $n-|\\mathbf M|$\uff0c\u6c42\u51fa\u5339\u914d\u65b9\u6848\u8f93\u51fa\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n^2)$\u3002\n\n## \u4ee3\u7801\u5448\u73b0\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int MAXN=3001;\nvector <int> G[MAXN];\nint a[MAXN],b[MAXN],ia[MAXN],ib[MAXN],tar[MAXN];\nbool vis[MAXN];\ninline bool dfs(int x) {\n\tfor(int p:G[x]) {\n\t\tif(vis[p]) continue;\n\t\tvis[p]=true;\n\t\tif(tar[p]==-1||dfs(tar[p])) {\n\t\t\ttar[p]=x;\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\nsigned main() {\n\tint n;\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;++i) scanf(\"%d\",&a[i]);\n\tmemset(vis,false,sizeof(vis));\n\tfor(int tot=0,i=1;i<=n;++i) {\n\t\tif(ia[i]) continue;\n\t\t++tot;\n\t\twhile(!vis[i]) {\n\t\t\tvis[i]=true,ia[i]=tot;\n\t\t\ti=a[i];\n\t\t}\n\t}\n\tfor(int i=1;i<=n;++i) scanf(\"%d\",&b[i]);\n\tmemset(vis,false,sizeof(vis));\n\tfor(int tot=0,i=1;i<=n;++i) {\n\t\tif(ib[i]) continue;\n\t\t++tot;\n\t\twhile(!vis[i]) {\n\t\t\tvis[i]=true,ib[i]=tot;\n\t\t\ti=b[i];\n\t\t}\n\t}\n\tmemset(tar,-1,sizeof(tar));\n\tfor(int i=1;i<=n;++i) G[ia[i]].push_back(ib[i]);\n\tint tot=n;\n\tfor(int i=1;i<=n;++i) {\n\t\tmemset(vis,false,sizeof(vis));\n\t\tif(dfs(i)) --tot;\n\t}\n\tprintf(\"%d\\n\",tot);\n\tfor(int i=1;i<=n;++i) {\n\t\tif(tar[ib[i]]==ia[i]) tar[ib[i]]=-1;\n\t\telse printf(\"%d \",i);\n\t}\n\tputs(\"\");\n\treturn 0;\n}\n```",
        "postTime": 1673370387,
        "uid": 539618,
        "name": "DaiRuiChen007",
        "ccfLevel": 6,
        "title": "CF1783F \u9898\u89e3"
    },
    {
        "content": "\u4ee5\u4e0b\u662f\u81ea\u5df1\u7684\u9898\u89e3\u4ee5\u53ca\u81ea\u5df1\u7684\u505a\u9898\u7ecf\u8fc7\u3002\u5176\u4e2d\u8bfb\u8005\u7684\u91cd\u70b9\u5728\u4e8e**\u7b2c\u4e8c\u3001\u56db\u90e8\u5206**\uff0c\u7b2c\u4e00\u3001\u4e09\u90e8\u5206\u53ef\u51ed\u4e2a\u4eba\u559c\u597d\u5df2\u786e\u5b9a\u662f\u5426\u9605\u8bfb\u3002\n\n### \u601d\u8def\u5386\u7a0b\n\n\u4e0b\u9762\u662f\u81ea\u5df1\u6ca1\u505a\u51fa\u6765\u7684\u539f\u56e0\u3002\n\n1. \u8d2a\u5fc3\n\n   \u4f3c\u4e4e\u611f\u89c9\u6ca1\u6cd5\u8d2a\uff0c\u4e14\u611f\u89c9\u53cd\u6094\u8d2a\u5fc3\u4e5f\u6ca1\u6709\u7b56\u7565\n\n2. \u6309\u4e00\u5b9a\u987a\u5e8f\u6a21\u62df\n\n   \u56e0\u4e3a\u8003\u8651\u6309\u4e00\u5b9a\u987a\u5e8f\u5f52\u4f4d\uff0c\u6bd4\u5982\u8bf4\u5148\u628a $a,b$ \u7684\u7b2c\u4e00\u4f4d\u90fd\u901a\u8fc7\u64cd\u4f5c\u53d8\u4e3a $1$ \uff0c\u4f46\u662f\u8003\u8651\u53ef\u80fd\u540e\u9762\u7684\u4ec0\u4e48\u901a\u8fc7\u4ea4\u6362\u5f52\u4f4d\u4e86\u518d\u548c\u524d\u9762\u7684\u6362\u5c31\u4e00\u4e3e\u4e24\u5f97\uff0c\u6240\u4ee5\u53ef\u80fd\u7531\u4e8e\u5f53\u524d\u3002\n\n3. \u52a8\u6001\u89c4\u5212\n\n\t $dp[i]$ \u8868\u793a\u628a\u524d $i$ \u4e2a\u6570\u5f52\u4f4d\u7684\u6700\u5c0f\u7b54\u6848\uff0c\u4f46\u6709\u53ef\u80fd\u6709 $2$ \u4e2d\u8bf4\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u6ca1\u6cd5\u8f6c\u79fb\u3002\n\n### \u9898\u89e3\u601d\u8def\n\n\u9996\u5148\u6211\u4eec\u7b80\u5316\u95ee\u9898\uff1a\u5047\u8bbe\u53ea\u8981\u4e00\u4e2a\u6570\u7ec4\u3002\n\n\u6211\u4eec\u628a $i$ \u5411 $a_i$ \u8fde\u8fb9\uff0c\u8fd9\u6837\u5f97\u5230\u4e86\u4e00\u4e2a\u7531\u73af\u7ec4\u6210\u7684\u6709\u5411\u56fe\u3002\n\n\u90a3\u4e48\u601d\u8003\uff0c\u5982\u679c\u6211\u4eec\u8981\u6bcf\u4e00\u6b65\u90fd\u4f1a\u4f7f\u5f97\u4e00\u4e2a\u70b9\u4ece\u73af\u4e2d\u5220\u9664\uff0c\u4ee5\u8fde\u5411\u81ea\u5df1\u3002\u90a3\u4e48\u6700\u540e\u73af\u4e2d\u5269\u4e0b\u7684\u70b9\u5c31\u4e0d\u7528\u64cd\u4f5c\u4e86\u3002\u6240\u4ee5\u4e00\u4e2a\u6570\u7ec4\u7684\u64cd\u4f5c\u6b21\u6570\u662f $n$ \u51cf\u73af\u7684\u4e2a\u6570\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u4e24\u4e2a\u662f\u6570\u7ec4\u3002\u56e0\u4e3a\u6bcf\u4e00\u6b65\u64cd\u4f5c\u90fd\u53ef\u4ee5\u4f7f\u4e24\u4e2a\u6570\u7ec4\u4e2d\u7684 $i$ \u4f4d\u7f6e\u53d8\u6210\u6307\u5b9a\u6570\u503c\u3002\u90a3\u4e48\u5f53\u4e24\u4e2a\u73af\u5269\u4e0b\u7684\u5143\u7d20\u76f8\u540c\u90a3\u4e48\u662f\u53ef\u4ee5\u7701\u6389\u64cd\u4f5c\u5bf9\u7684\u8fd9 $1$ \u6b21\u7684\u3002\n\n\u6240\u4ee5\u6211\u4eec\u628a\u6bcf\u4e2a\u73af\u770b\u6210\u4e00\u4e2a\u70b9\uff0c\u62e5\u6709\u76f8\u540c\u989c\u8272\u7684\u73af\u8fde\u8fb9\u3002\u7531\u4e8e\u6bcf\u4e2a\u73af\u4e2d\u53ea\u6709\u5269\u4e0b\u7684\u4e00\u4e2a\u70b9\u662f\u53ef\u80fd\u7701\u6389 $1$ \u6b65\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8dd1\u4e8c\u5206\u56fe\u7684\u6700\u5927\u5339\u914d\u3002\u800c\u5339\u914d\u51fa\u6765\u7684\u5c31\u662f\u53ef\u4ee5\u7701\u6389\u7684\u6b21\u6570\u3002\u6240\u4ee5\u7b54\u6848\u5c31\u662f $n$ \u51cf\u6700\u5927\u5339\u914d\u6570\u3002\n\n\u81f3\u4e8e\u8f93\u51fa\u65b9\u6848\uff0c\u6211\u4eec\u8981\u77e5\u9053\uff1a\u6709\u4e86\u6211\u4eec\u7684\u6a21\u578b\u8f6c\u6362\u4e4b\u540e\u4e0d\u7ba1\u4ec0\u4e48\u987a\u5e8f\u90fd\u6ca1\u6709\u95ee\u9898\u3002\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u679a\u4e3e\u6bcf\u4e2a $i$ \uff08\u56e0\u4e3a\u524d\u9762\u7684\u8fde\u8fb9\u65b9\u6848\u662f\u628a\u62e5\u6709\u7f16\u53f7\u76f8\u540c\u7684\u4e24\u4e2a\u70b9\u7684\u73af\u6240\u4ee3\u8868\u7684\u70b9\u8fde\u8fb9\uff09\uff0c\u770b\u770b\u8fd9\u6761\u8fb9\u662f\u5426\u88ab\u5339\u914d\u5c31\u884c\u4e86\uff0c\u5982\u679c\u5339\u914d\u4e86\uff0c\u90a3\u4e48\u5c31\u8bc1\u660e\u8fd9\u4e2a\u70b9\u6ca1\u6709\u88ab\u9009\u5e76\u4e14\u64cd\u4f5c\u8fc7\uff0c\u4e0d\u8f93\u51fa\uff1b\u5426\u5219\u8f93\u51fa $i$ \u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2)$ \uff0c\u5728\u4e8e\u6c42\u89e3\u4e8c\u5206\u56fe\u7684\u6700\u5927\u5339\u914d\u7684\u5308\u7259\u5229\u7b97\u6cd5\u3002\n\n### \u5206\u6790\u539f\u56e0\n\n\u4ee5\u4e0b\u662f\u81ea\u5df1\u5206\u6790\u7684\u6ca1\u505a\u51fa\u6765\u7684\u539f\u56e0\u3002\n\n1. \u6ca1\u60f3\u51fa\u5efa\u56fe\u65b9\u5f0f\n\n   \u7f3a\u4e4f\u8fd9\u6837\u5957\u8def\u6027\u7684\u601d\u7ef4\u3002\u5728\u4e00\u4e2a**\u6392\u5217**\u4e2d $i$ \u5411 $a_i$ \u6216\u8005 $a_i$ \u5411 $i$ \u8fde\u8fb9\u7684\u8fd9\u79cd\u5efa\u56fe\u65b9\u5f0f\u975e\u5e38\u5e38\u89c1\u3002\n\n2. \u77e5\u9053\u4e86\u5efa\u56fe\u65b9\u5f0f\u4e4b\u540e\u6ca1\u6709\u60f3\u5230\u6027\u8d28\n\n   \u50cf\u8fd9\u9053\u9898\u7684\u4e00\u4e2a\u6027\u8d28\u9700\u8981\u7b80\u5316\u95ee\u9898\uff0c\u4ece\u53ea\u6709\u4e00\u4e2a\u6570\u7ec4\u5f00\u59cb\u3002\u7136\u540e\u6839\u636e\u9898\u76ee\u7684\u4e24\u4e2a\u6570\u7ec4\u9009\u7684\u90fd\u662f $i$ \u8fd9\u70b9\u53bb\u786e\u5b9a\u5efa\u56fe\u65b9\u5f0f\uff0c\u800c\u6700\u540e\u7684\u5f97\u51fa\u662f\u4e8c\u5206\u56fe\u7684\u7ed3\u8bba\u5c31\u6bd4\u8f83\u663e\u800c\u6613\u89c1\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define L(i, a, b) for(int i = a; i <= b; i++)\n#define R(i, a, b) for(int i = a; i >= b; i--)\nusing namespace std;\nconst int N = 3010;\nint n, cnt, tota, totb, p[N], vis[N];\nint a[N], b[N], t[N], ca[N], cb[N], mp[N][N];\nvector<int> g[N];\nvoid Get(int u, int col, int e[], int c[]){//\u83b7\u53d6\u6bcf\u4e2a\u70b9\u6240\u5904\u73af\u7684\u6807\u53f7\n\tc[u] = col;\n\tif(!c[e[u]]) Get(e[u], col, e, c);\n}\nbool Dfs(int u){//\u4e8c\u5206\u56fe\u7684\u6700\u5927\u5339\u914d\n\tfor(int v: g[u]){\n\t\tif(!vis[v]){\n\t\t\tvis[v] = 1; \n\t\t\tif(!p[v] || Dfs(p[v])){\n\t\t\t\tp[v] = u;\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t} \n\t}\n\treturn 0;\n}\nint main(){\n\tscanf(\"%d\", &n);\n\tL(i, 1, n) scanf(\"%d\", &a[i]); \n\tL(i, 1, n) scanf(\"%d\", &b[i]);\n\tL(i, 1, n){\n\t\tif(!ca[i]) Get(i, ++tota, a, ca);\n\t\tif(!cb[i]) Get(i, ++totb, b, cb);\n\t}\n\tL(i, 1, n)\n\t\tif(!mp[ca[i]][cb[i]])\n\t\t\tmp[ca[i]][cb[i]] = i, g[ca[i]].push_back(cb[i]);//\u62e5\u6709\u76f8\u540c\u8282\u70b9\u7684\u73af\u8fde\u8fb9\n\tL(i, 1, tota){\n\t\tL(j, 1, totb) vis[j] = 0;\n\t\tcnt += Dfs(i);\n\t}\n\tprintf(\"%d\\n\", n - cnt);\n\tL(i, 1, totb)\n\t\tif(p[i]) t[mp[p[i]][i]] = 1;\n\tL(i, 1, n)\n\t\tif(!t[i]) printf(\"%d \", i);\n\treturn 0;\n}\n```",
        "postTime": 1674471371,
        "uid": 341946,
        "name": "zac2010",
        "ccfLevel": 7,
        "title": "CF1783F \u9898\u89e3"
    },
    {
        "content": "\u7531\u4e8e\u573a\u4e0a\u82b1\u4e86\u4e00\u4e2a\u5c0f\u65f6\u5199 E \u7684\u8c14\u8c14\u884c\u4e3a\u5bfc\u81f4\u6ca1\u6709\u65f6\u95f4\u601d\u8003 F\u3002\u5b9e\u9645\u4e0a\u8fd9\u662f\u4e00\u9053\u7b80\u5355\u9898\u3002\n\n\u4e24\u4e2a\u6392\u5217\u592a\u70e6\u4e86\uff0c\u6211\u4eec\u5148\u53ea\u770b\u4e00\u4e2a\u6392\u5217 $a_i$ \u5427\u3002\u5efa\u51fa\u542b\u6709\u7f6e\u6362\u73af\u7684\u56fe\uff1a$i$ \u5411 $a_i$ \u8fde\u8fb9\u3002\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6392\u5217\u6709\u5e8f\u7684\u5145\u8981\u6761\u4ef6\u662f\u5176\u5bf9\u5e94 $n$ \u4e2a\u81ea\u73af\u3002\n\n\u4e00\u6b21\u64cd\u4f5c\u4e2d\u6211\u4eec\u9009\u62e9\u4e86\u4e00\u4e2a\u6570 $i$\uff0c\u4ee4 $a_x=i$ \u4ea4\u6362 $a_x$ \u548c $a_i$\u3002\u8fd9\u4e2a\u64cd\u4f5c\u7684\u672c\u8d28\u662f\u4ec0\u4e48\uff1f\u628a $a_i$ \u5f52\u4f4d\u5f62\u6210\u81ea\u73af\uff0c\u5728\u542b\u6709 $x$ \u548c $i$ \u7684\u7f6e\u6362\u73af\u4e2d\u5207\u6389 $i$\uff0c\u5e76\u628a\u5269\u4e0b\u7684\u90e8\u5206\u987a\u6b21\u8fde\u63a5\u8d77\u6765\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u81ea\u5df1\u6a21\u62df\u4e00\u4e0b\u6837\u4f8b\u5c31\u660e\u767d\u4e86\uff0c\u753b\u56fe\u89e3\u91ca\u6709\u70b9\u70e6\u3002\n\n\u7531\u6b64\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5982\u679c\u6211\u4eec\u628a $i\\in [1,n]$ \u90fd\u64cd\u4f5c\u4e00\u6b21\uff0c\u90a3\u4e48\u4e24\u4e2a\u6392\u5217\u81ea\u7136\u90fd\u80fd\u6709\u5e8f\uff0c\u6240\u4ee5\u64cd\u4f5c\u4e0a\u754c\u4e0d\u8d85\u8fc7 $n$ \u6b21\u3002\u8fdb\u4e00\u6b65\u7684\uff0c\u6bcf\u4e2a\u7f6e\u6362\u73af\u4e2d\u6700\u540e\u5269\u4f59\u7684\u4e00\u4e2a\u70b9\u53ef\u4ee5\u4e0d\u7528\u64cd\u4f5c\uff0c\u56e0\u4e3a\u5b83\u5df2\u7ecf\u5f62\u6210\u81ea\u73af\u4e86\u3002\u90a3\u6211\u4eec\u4e0d\u59a8\u4ece\u53cd\u9762\u6765\u8003\u8651\uff1a\u54ea\u4e9b\u64cd\u4f5c\u662f\u4e0d\u5fc5\u8981\u7684\uff1f\n\n\u518d\u56de\u5230\u7f6e\u6362\u73af\u4e2d\uff0c\u6211\u4eec\u628a\u6bcf\u4e2a\u6392\u5217\u4e2d\u7684\u7f6e\u6362\u73af\u770b\u6210\u4e00\u4e2a\u96c6\u5408\u3002\u4ee5\u6392\u5217 $a_i$ \u4e3e\u4f8b\uff0c\u5047\u8bbe\u6709 $c$ \u4e2a\u7f6e\u6362\u73af\uff0c\u5219\u5b58\u5728\u96c6\u5408 $A_1,A_2,\\cdots A_c$\uff0c\u6bcf\u4e2a\u96c6\u5408\u5bf9\u5e94\u5728\u5b83\u8fd9\u4e2a\u73af\u4e2d\u7684\u6240\u6709\u70b9\uff0c\u4e5f\u5c31\u662f $\\bigcup_{i=1}^{n}A_i=\\{1,2,\\cdots n\\},\\bigcap_{i=1}^{n}A_i=\\emptyset$\u3002$B_i$ \u540c\u7406\u3002\n\n\u5982\u679c\u6211\u4eec\u7701\u7565\u6389\u7684\u64cd\u4f5c\u70b9\u7684\u96c6\u5408 $S=\\{p_1,p_2\\cdots p_m\\}$\uff0c\u90a3\u4e48\u9700\u8981\u4fdd\u8bc1\u8fd9 $m$ \u4e2a\u70b9\u4e2d\u7684\u4efb\u610f\u4e24\u70b9\u5728\u4efb\u610f\u4e00\u5f20\u56fe\u4e2d\u90fd\u4e0d\u80fd\u5b58\u5728\u4e8e\u540c\u4e00\u4e2a\u7f6e\u6362\u73af\u4e2d\uff0c\u4e5f\u5c31\u662f\u8bf4\u6bcf\u4e2a $A_i$ \u548c $B_i$ \u91cc\u6700\u591a\u53d6\u51fa\u4e00\u4e2a\u5143\u7d20\uff08\u6216\u8005\u4e0d\u53d6\uff09\u3002\n\n\u6839\u636e\u7ecf\u9a8c\u8fd9\u5e94\u5f53\u662f\u4e00\u9053\u7f51\u7edc\u6d41\u9898\u3002\u5269\u4e0b\u7684\u4e8b\u60c5\u5c31\u7b80\u5355\u4e86\uff1a\u5efa\u7acb\u6e90\u70b9 $S$ \u548c\u6c47\u70b9 $T$\uff0c$S$ \u5411 $A_i$ \u8fde\u8fb9\uff0c$B_i$ \u5411 $T$ \u8fde\u8fb9\uff0c$A_i$ \u5411\u5b83\u6240\u542b\u7684\u6240\u6709\u6570\u5b57\u8fde\u8fb9\uff0c\u6240\u6709\u6570\u5b57\u5411\u5b83\u6240\u5c5e\u7684\u96c6\u5408 $B_i$ \u8fde\u8fb9\u3002\u4ee5\u4e0a\u6240\u6709\u8fb9\u7684\u5bb9\u91cf\u5747\u4e3a $1$\u3002\u7528\u4f60\u60f3\u7528\u7684\u7f51\u7edc\u6d41\u7b97\u6cd5\u8dd1\u51fa $S$ \u548c $T$ \u76f4\u63a5\u7684\u6700\u5927\u6d41 $f$\uff0c\u7b54\u6848\u5373\u4e3a $n-f$\u3002\u81f3\u4e8e\u70b9 $x$ \u662f\u5426\u5728\u7701\u7565\u7684\u96c6\u5408\u4e2d\uff1f\u76f4\u63a5\u770b\u6307\u5411\u70b9 $x$ \u7684\u8fb9 $(A_i,x)$ \u662f\u5426\u6ee1\u6d41\u5373\u53ef\u3002\n\n\u8fb9\u6570\u70b9\u6570\u5747\u4e3a $\\mathcal{O}(n)$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal{O}(n\\sqrt n)$\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n//114\n#include <bits/stdc++.h>\nconst int M = 30114, inf = 114114;\nint n, a[3005], b[3005], fa[3005], S, T, cnt = 0;\nint tot = 1, ver[M], nxt[M], len[M], head[M];\nint myf = 0, ok[3005], pre[M];\ninline void adde(int x, int y){\n\tnxt[++tot] = head[x];\n\thead[x] = tot;\n\tver[tot] = y;\n\tlen[tot] = 1;\n\tnxt[++tot] = head[y];\n\thead[y] = tot;\n\tver[tot] = x;\n\tlen[tot] = 0;\n\treturn ;\n} \nstd::vector <int> sa[3005], sb[3005];\nint fd(int x){\n\treturn x == fa[x] ? x : fa[x] = fd(fa[x]);\n}\nvoid merge(int x, int y){\n\tx = fd(x);\n\ty = fd(y);\n\tfa[y] = x;\n\treturn ;\n}\nint d[M];\nbool bfs(){\n\tstd::queue <int> q;\n\tmemset(d, 0, sizeof d);\n\tfor(int i = 1; i <= 3 * n; ++i) pre[i] = head[i];\n\tpre[S] = head[S];\n\tpre[T] = head[T];\n\td[S] = 1; q.push(S);\n\twhile(q.size()){\n\t\tint u = q.front(); q.pop();\n\t\tfor(int i = head[u]; i; i = nxt[i]){\n\t\t\tint x = ver[i];\n\t\t\tif(d[x] || !len[i]) continue;\n\t\t\td[x] = d[u] + 1;\n\t\t\tq.push(x);\n\t\t}\n\t}\n\treturn d[T];\n}\nint dinic(int x, int rest){\n\tif(x == T || !rest) return rest;\n\tint tmp = rest;\n\tfor(int i = pre[x]; i; i = nxt[i], pre[x] = i){\n\t\tif(!tmp) break;\n\t\tint v = ver[i];\n\t\tif(d[v] != d[x] + 1 || !len[i]) continue;\n\t\tint k = dinic(v, std::min(tmp, len[i]));\n\t\tif(!k) d[v] = 0;\n\t\ttmp -= k;\n\t\tlen[i] -= k;\n\t\tlen[i ^ 1] += k;\n\t}\n\treturn rest - tmp;\n}\nvoid solve(){\n\tscanf(\"%d\", &n);\n\tfor(int i = 1; i <= n; ++i) scanf(\"%d\", &a[i]);\n\tfor(int i = 1; i <= n; ++i) scanf(\"%d\", &b[i]);\n\tfor(int i = 1; i <= n; ++i) fa[i] = i;\n\tfor(int i = 1; i <= n; ++i) merge(i, a[i]);\n\tfor(int i = 1; i <= n; ++i) sa[fd(i)].push_back(i);\n\tfor(int i = 1; i <= n; ++i) fa[i] = i;\n\tfor(int i = 1; i <= n; ++i) merge(i, b[i]);\n\tfor(int i = 1; i <= n; ++i) sb[fd(i)].push_back(i);\n\tS = 30001, T = 30002;\n\tfor(int i = 1; i <= n; ++i) adde(S, i);\n\tfor(int i = 1; i <= n; ++i) adde(2 * n + i, T);\n\tfor(int i = 1; i <= n; ++i)\n\t\tfor(auto j : sa[i]) \n\t\t\tadde(i, n + j);\n\tfor(int i = 1; i <= n; ++i)\n\t\tfor(auto j : sb[i])\n\t\t\tadde(n + j, 2 * n + i);\n\tint ff = 0;\n\twhile(bfs()) while(ff = dinic(S, inf)) myf += ff;\n\tprintf(\"%d\\n\", n - myf);\n\tfor(int i = 1; i <= n; ++i)\n\t\tfor(int j = head[i]; j; j = nxt[j])\n\t\t\tif(len[j] == 0 && ver[j] != S)\n\t\t\t\tok[ver[j] - n] = 1;\n\tfor(int i = 1; i <= n; ++i) if(!ok[i]) printf(\"%d \", i);\n\tprintf(\"\\n\");\n\treturn ;\n}\nint main(){\n\tint T = 1;\n\twhile(T--) solve();\n\treturn 0;\n}\n```\n",
        "postTime": 1673202325,
        "uid": 131591,
        "name": "\u849f\u84bb\u541bHJT",
        "ccfLevel": 7,
        "title": "CF1783F Double Sort II \u9898\u89e3"
    },
    {
        "content": "\u6700\u8fd1\u603b\u505a\u5230\u6392\u5217\u548c\u7f6e\u6362\u7684\u9898\u3002\u611f\u89c9\u662f\u5957\u8def\u9898\uff0c\u5c3d\u91cf\u5199\u5f97\u4eb2\u6c11\u4e00\u70b9\u3002\n\n--------------------\n\n\u9996\u5148\u8003\u8651\u5c06\u5176\u4e2d\u4e00\u4e2a\u6392\u5217\u53d8\u6210\u81ea\u7136\u987a\u5e8f\u7684\u6700\u5c0f\u64cd\u4f5c\u3002\u663e\u7136\uff0c\u6700\u5c0f\u64cd\u4f5c\u6b21\u6570\u53d6\u51b3\u4e8e\u539f\u6392\u5217\u6240\u5efa\u6709\u5411\u56fe\u4e2d\u7f6e\u6362\u73af\u7684\u4e2a\u6570 $r$\u3002\u5177\u4f53\u5730\uff0c\u5c06\u6392\u5217 $\\mathrm{P}$ \u4e2d\u6bcf\u4e2a\u6570\u5411\u6392\u5e8f\u540e\u7684\u5e8f\u5217 $\\mathrm{P'}$ \u4e2d\u8fd9\u4e2a\u6570\u6240\u5728\u7684\u4f4d\u7f6e\u8fde\u8fb9\u5f97\u5230\u56fe $\\mathrm{G(P)}$\u3002\u663e\u7136\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u5927\u5c0f\u4e3a $|\\mathbb{C}|$ \u7684\u7f6e\u6362\u73af\uff0c\u9700\u8981 $|\\mathbb{C}| - 1$ \u6b21\u4ea4\u6362\u624d\u80fd\u4f7f\u73af\u5185\u6709\u5e8f\u3002\u603b\u64cd\u4f5c\u6b21\u6570\u5c31\u662f $\\sum \\left ( |\\mathbb{C_i}| - 1 \\right ) = n - r$\u3002$r$ \u7684\u610f\u4e49\u5982\u4e0a\u6240\u8ff0\u3002\u5176\u4e2d\u7f6e\u6362\u73af\u53ef\u4ee5\u7528\u641c\u7d22 $O(n)$ \u6c42\u51fa\u6216\u8005\u5e76\u67e5\u96c6 $O\\left(n \\alpha(n) \\right)$ \u6c42\u51fa\u3002\n\n\u73b0\u5728\u8003\u8651\u53cc\u6392\u5e8f\u3002\u6bcf\u4e2a\u4f4d\u7f6e $i$ \u548c\u6743\u503c\u4e3a $i$ \u7684\u70b9\uff0c\u5047\u8bbe\u4e3a $a_x$ \u548c $b_y$ \u4ea4\u6362\uff0c\u76f8\u5f53\u4e8e\u5bf9 $a_x$ \u548c $b_y$ \u4e24\u70b9\u6240\u5728\u7684\u7f6e\u6362\u73af\u90fd\u4ea4\u6362\u4e86\u4e00\u6b21\u3002\u73b0\u5728\u8981\u6c42 $a, b$ \u4e24\u4e2a\u6392\u5217\u4e2d\u7684\u6bcf\u4e2a\u7f6e\u6362\u73af $\\mathbb{C}$ \u90fd\u88ab\u4ea4\u6362 $|\\mathbb{C}| - 1$ \u6b21\u3002\u56e0\u6b64\uff0c\u6bcf\u4e2a\u7f6e\u6362\u73af\u4e2d\u6709\u4e00\u4e2a\u70b9\u4e0d\u9700\u8981\u52a8\u3002\u8ba9\u4e0d\u52a8\u7684\u70b9\u5c3d\u53ef\u80fd\u591a\u662f\u6211\u4eec\u7684\u76ee\u6807\u3002\n\n\u5c06\u6bcf\u4e2a\u4f4d\u7f6e $i$ \u6240\u5728 $a$ \u4e2d\u7f6e\u6362\u73af $\\mathrm{A_x}$ \u548c\u5728 $b$ \u4e2d\u6240\u5728\u7f6e\u6362\u73af $\\mathrm{B_y}$ \u4e4b\u95f4\u8fde\u8fb9\u3002\u8fd9\u6837\u5f62\u6210\u4e86\u4e00\u4e2a\u4e8c\u5206\u56fe\u3002\u8003\u8651\u8fb9\u7684\u610f\u4e49\uff1a\u8fb9\u4e24\u7aef\u7684\u70b9\u53ef\u4ee5\u4e0d\u7528\u4ea4\u6362\u3002\u663e\u7136\uff0c\u4e00\u4e2a\u73af\u6700\u591a\u6709\u4e00\u4e2a\u70b9\u4e0d\u4ea4\u6362\uff0c\u56e0\u6b64\u9898\u76ee\u8f6c\u5316\u4e3a\u4e8c\u5206\u56fe\u6700\u5927\u5339\u914d\u3002\u8bbe\u6700\u5927\u5339\u914d\u4e3a $k$\uff0c$n - k$ \u5373\u4e3a\u7b54\u6848\u3002\n\n\u6c42\u4e8c\u5206\u56fe\u5339\u914d\u53ef\u4ee5\u8dd1\u7f51\u7edc\u6d41\uff0c\u590d\u6742\u5ea6 $O(n\\sqrt{n})$\u3002\u5b9e\u9645\u590d\u6742\u5ea6\u8fd8\u8981\u5c0f\u5f97\u591a\uff0c\u56e0\u4e3a\u73af\u7684\u603b\u4e2a\u6570\u5c0f\u4e8e\u7b49\u4e8e $2n$\u3002\u65b9\u6848\u8f93\u51fa\u5c31\u662f\u770b\u662f\u5426\u6ee1\u6d41\uff0c\u6ee1\u6d41\u7684\u8bdd\u4ee3\u8868\u4e0d\u7528\u4ea4\u6362\uff0c\u6ca1\u6ee1\u6d41\u5c31\u8981\u4ea4\u6362\u3002\n\n\u4ee3\u7801\u5f88\u70c2\uff0c\u53ef\u80fd\u8dd1\u4e0d\u8fc7\u5308\u7259\u5229\u7b97\u6cd5\u3002\n\n```cpp\n#include <iostream>\n#include <cstring>\n#include <cstdio>\n#include <queue>\n\nusing namespace std;\n\nconst int N = 30010, M = N << 2, INF = 2e9;\nint n, m, S, T;\nint h[N], e[M], ne[M], f[M], idx = 1;\nint d[N], cur[N], a[N], b[N];\nint pa[N], pb[N], cnta, cntb, ida[N], idb[N];\nbool sta[N], stb[N], st[3010][3010];\n\nvoid add(int a, int b, int c) {\n\te[ ++ idx] = b, ne[idx] = h[a], h[a] = idx, f[idx] = c;\n}\nbool bfs() { // \u5206\u5c42\n\tmemset(d, -1, sizeof d);\n\tqueue<int> q; cur[S] = h[S];\n\tq.push(S); d[S] = 1;\n\twhile (q.size()) {\n\t\tint u = q.front(); q.pop();\n\t\tfor (int i = h[u]; i; i = ne[i]) {\n\t\t\tint v = e[i];\n\t\t\tif (d[v] == -1 and f[i]) {\n\t\t\t\td[v] = d[u] + 1;\n\t\t\t\tcur[v] = h[v];\n\t\t\t\tif (v == T) return true;\n\t\t\t\tq.push(v);\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\nint dfs(int u, int flow) { // \u627e\u589e\u5e7f\u8def\n\tint now = 0;\n\tif (u == T) return flow;\n\tfor (int i = cur[u]; i; i = ne[i]) {\n\t\tint v = e[i]; cur[u] = i;\n\t\tif (d[v] == d[u] + 1 and f[i])\n\t\t\tif (now = dfs(v, min(flow, f[i])))\n\t\t\t\treturn (f[i] -= now, f[i ^ 1] += now, now);\n\t}\n\treturn 0;\n}\nint dinic() { // \u6c42\u6700\u5927\u5339\u914d\n\tint flow, ans = 0;\n\twhile (bfs()) while (flow = dfs(S, INF)) ans += flow;\n\treturn ans;\n}\nvoid dfsa(int u) { // \u627e a \u6392\u5217\u4e2d\u7684\u73af\n\tif (sta[u]) return;\n\tsta[u] = true; ida[u] = cnta, dfsa(pa[u]);\n}\nvoid dfsb(int u) { // \u627e b \u6392\u5217\u4e2d\u7684\u73af\n\tif (stb[u]) return;\n\tstb[u] = true; idb[u] = cntb; dfsb(pb[u]);\n}\n\nint main() {\n\tscanf(\"%d\", &n);\n\tfor (int i = 1; i <= n; i ++ )\n\t\tscanf(\"%d\", &a[i]);\n\tfor (int i = 1; i <= n; i ++ )\n\t\tscanf(\"%d\", &b[i]);\n\tfor (int i = 1; i <= n; i ++ )\n\t\tpa[i] = a[i], pb[i] = b[i];\n\tfor (int i = 1; i <= n; i ++ )\n\t\tif (!sta[i]) cnta ++ , dfsa(i);\n\tfor (int i = 1; i <= n; i ++ )\n\t\tif (!stb[i]) cntb ++ , dfsb(i);\n\t\n\t\n\tS = 0, T = cnta + cntb + 1;\n\tfor (int i = 1; i <= n; i ++ ) { // \u73af\u4e4b\u95f4\u5efa\u8fb9\n\t\tadd(ida[i], idb[i] + cnta, 1);\n\t\tadd(idb[i] + cnta, ida[i], 0);\n\t}\n\t\n\tfor (int i = 1; i <= cnta; i ++ )\n\t\tadd(S, i, 1), add(i, S, 0);\n\tfor (int i = 1; i <= cntb; i ++ )\n\t\tadd(i + cnta, T, 1), add(T, i + cnta, 0);\n\t\n\tint ans = dinic(); printf(\"%d\\n\", n - ans);\n\t\n\tfor (int i = 1; i <= cnta; i ++ )\n\t\tfor (int j = h[i]; j; j = ne[j])\n\t\t\tif (f[j] == 0 and e[j] != S) \n\t\t\t\tst[i][e[j] - cnta] = true;\n\t\n\tfor (int i = 1; i <= n; i ++ )\n\t\tif (st[ida[i]][idb[i]]) st[ida[i]][idb[i]] = false;\n\t\telse printf(\"%d \", i);\n\treturn 0;\n}\n```\n\n\u53e6\u5916\u5173\u4e8e\u6392\u5217\u6392\u5e8f\u7684\u6700\u5c0f\u4ea4\u6362\u6b21\u6570\u7684\u8bc1\u660e\u53ef\u4ee5\u53c2\u8003\u8fd9\u7bc7\u6587\u7ae0[\u6392\u5217\u6392\u5e8f\u6700\u5c0f\u4ea4\u6362\u6b21\u6570](https://www.cnblogs.com/CDOI-24374/p/16410082.html)\u3002\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u4e86\u3002",
        "postTime": 1683643399,
        "uid": 519384,
        "name": "Link_Cut_Y",
        "ccfLevel": 0,
        "title": "Double Sort II \u9898\u89e3"
    }
]
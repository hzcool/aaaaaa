[
    {
        "content": "## \u9898\u610f\n\n\u7ed9\u4e00\u4e2a\u4e3b\u4e32\uff0c\u5e76\u628a\u5176\u4e2d\u6bcf\u4e2a `*` \u90fd\u586b\u6210\u4e00\u4e2a\u5c0f\u5199\u5b57\u6bcd\u3002\u518d\u7ed9\u51fa\u4e24\u4e2a\u6a21\u5f0f\u4e32 $s$ \u548c $t$\uff0c\u6700\u5927\u5316\u586b\u5b8c\u6bcf\u4e2a `*` \u540e $s$ \u51fa\u73b0\u7684\u6b21\u6570\u548c $t$ \u51fa\u73b0\u7684\u6b21\u6570\u4e4b\u5dee\u5e76\u8f93\u51fa\u3002\n\n## \u601d\u8def\n\n\u8981\u786e\u5b9a\u6bcf\u4e2a `*` \u586b\u7684\u5b57\u6bcd\u81ea\u7136\u800c\u7136\u60f3\u5230 dp\u3002\n\n\u8981\u5339\u914d $s$ \u548c $t$ \u81ea\u7136\u80fd\u60f3\u5230 KMP\u3002\n\n\u4f46\u662f\u6bcf\u4e2a `*` \u7684\u786e\u5b9a\u4f1a\u5bfc\u81f4\u5f53\u524d\u5339\u914d\u5230\u7684\u4f4d\u7f6e\u4e0d\u4e00\u5b9a\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5bf9\u4e8e $s$ \u548c $t$ \u90fd\u5efa\u51fa KMP \u81ea\u52a8\u673a\uff0c\u5e76\u8bb0\u5f55\u5230 dp \u72b6\u6001\u91cc\uff0c\u65b9\u4fbf\u6211\u4eec\u5b9e\u65f6\u786e\u5b9a\u5f53\u524d $s$ \u4e32\u548c  $t$ \u4e32\u5206\u522b\u5339\u914d\u5230\u7684\u4f4d\u7f6e\u3002\n\n\u8bbe $f(i,j,k)$ \u8868\u793a\u5f53\u524d\u4e3b\u4e32\u5df2\u7ecf\u786e\u5b9a\u4e86\u524d $i$ \u4f4d\uff0c\u5728 $s$ \u4e32 KMP \u81ea\u52a8\u673a\u4e0a\u7684\u7b2c $j$ \u4e2a\u72b6\u6001\uff0c\u5728 $t$ \u4e32 KMP \u81ea\u52a8\u673a\u4e0a\u7684\u7b2c $k$ \u4e2a\u72b6\u6001\uff0c\u6240\u80fd\u5f97\u5230\u7684\u6700\u5927\u51fa\u73b0\u6b21\u6570\u7684\u5dee\u503c\u3002\n\n\u5bb9\u6613\u6709\u8f6c\u79fb\uff1a\n\n$$\nf(i,j,k)+w\\to f(i+1,gos_{j,p},got_{k,p})\n$$\n\n\u5176\u4e2d $w$ \u8868\u793a\u524d $i$ \u4f4d\u52a0\u4e0a\u65b0\u6765\u7684\u5b57\u7b26 $p$ \u4e4b\u540e\u5339\u914d\u6b21\u6570\u5dee\u503c\u7684\u53d8\u5316\u91cf\u3002\u5206\u522b\u5224\u65ad\u4e00\u4e0b\u65b0\u5230\u7684\u81ea\u52a8\u673a\u72b6\u6001\u662f\u4e0d\u662f\u7ed3\u5c3e\u72b6\u6001\u5373\u53ef\u3002\n\n\u5982\u679c\u4e3b\u4e32\u7684\u7b2c $i+1$ \u4f4d\u4e0d\u662f `*`\uff0c\u90a3\u4e48 $p$ \u53ea\u80fd\u4e3a\u4e3b\u4e32\u7684\u7b2c $i+1$ \u4f4d\u3002\n\n\u5426\u5219 $p$ \u53ef\u4ee5\u53d6\u5230\u6bcf\u4e00\u4e2a\u5c0f\u5199\u5b57\u6bcd\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(nm^2S)$\uff0c\u5176\u4e2d $S$ \u4e3a\u5b57\u7b26\u96c6\u5927\u5c0f\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <cstdio>\n#include <iostream>\n#include <cstring>\nusing namespace std;\nconst int N = 1005, M = 55, S = 26;\n\nchar s[N], a[M], b[M];\nint n, la, lb, ans = -1e9, nxta[M], nxtb[M], goa[M][S], gob[M][S], f[N][M][M];\n\nvoid get_nxt(char *s, int *nxt, int go[][S]) {\n\tint len = strlen(s + 1);\n\tfor (int i = 2, j = 0; i <= len; i++) {\n\t\twhile (j && s[i] != s[j + 1]) j = nxt[j];\n\t\tif (s[i] == s[j + 1]) j++;\n\t\tnxt[i] = j;\n\t}\n\tfor (int i = 0; i <= len; i++)\n\t\tfor (int j = 0; j < 26; j++) {\n\t\t\tif (s[i + 1] == j + 'a') go[i][j] = i + 1;\n\t\t\telse go[i][j] = go[nxt[i]][j];\n\t\t}\n}\n\nint main() {\n\tscanf(\"%s %s %s\", s + 1, a + 1, b + 1);\n\tn = strlen(s + 1);\n\tla = strlen(a + 1);\n\tlb = strlen(b + 1);\n\tget_nxt(a, nxta, goa);\n\tget_nxt(b, nxtb, gob);\n\tmemset(f, -0x3f, sizeof(f));\n\tf[0][0][0] = 0;\n\tfor (int i = 0; i < n; i++)\n\t\tfor (int j = 0; j <= la; j++)\n\t\t\tfor (int k = 0; k <= lb; k++) {\n\t\t\t\tif (s[i + 1] != '*') {\n\t\t\t\t\tint c = s[i + 1] - 'a', w = 0;\n\t\t\t\t\tif (goa[j][c] == la) w++;\n\t\t\t\t\tif (gob[k][c] == lb) w--;\n\t\t\t\t\tf[i + 1][goa[j][c]][gob[k][c]] = max(f[i + 1][goa[j][c]][gob[k][c]], f[i][j][k] + w);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tfor (int p = 0; p < 26; p++) {\n\t\t\t\t\tint w = 0;\n\t\t\t\t\tif (goa[j][p] == la) w++;\n\t\t\t\t\tif (gob[k][p] == lb) w--;\n\t\t\t\t\tf[i + 1][goa[j][p]][gob[k][p]] = max(f[i + 1][goa[j][p]][gob[k][p]], f[i][j][k] + w);\n\t\t\t\t}\n\t\t\t}\n\tfor (int i = 0; i <= la; i++)\n\t\tfor (int j = 0; j <= lb; j++) ans = max(ans, f[n][i][j]);\n\tprintf(\"%d\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1672545442,
        "uid": 365542,
        "name": "SDqwq",
        "ccfLevel": 7,
        "title": "CF1163D Mysterious Code"
    },
    {
        "content": "\u627e\u4e00\u4e2a\u6a21\u5f0f\u4e32\u5728\u5b57\u7b26\u4e32\u4e2d\u7684\u51fa\u73b0\u6b21\u6570\uff0c\u800c\u770b\u5230\u53ef\u4ee5\u5728 * \u4e0a\u586b\u4efb\u610f\u4e00\u4e2a\u5b57\u6bcd\u53c8\u662f\u7ecf\u5178 DP \u95ee\u9898\u3002\u5bf9 $s,t$ \u5efa\u51fa KMP \u81ea\u52a8\u673a\uff0c\u8bbe $f(i,j,k)$ \u8003\u8651\u5230 $c$ \u7684\u7b2c $i$ \u4f4d\uff0c\u6b64\u65f6\u5728 $s$ \u7684 KMP \u81ea\u52a8\u673a\u7684\u8282\u70b9 $j$\uff0c$t$ \u7684 KMP \u81ea\u52a8\u673a\u7684\u8282\u70b9 $k$ \u7684\u6700\u5927\u7b54\u6848\u3002\u91c7\u7528\u5237\u8868\u6cd5\u8f6c\u79fb\uff0c\u6a21\u5f0f\u4e32 $S$ \u5728\u8f6c\u79fb\u5230\u8282\u70b9 $|S|$ \u65f6\u6709\u8d21\u732e\u3002\u521d\u59cb $f(0,0,0)=0$\uff0c\u8f6c\u79fb $f(i+1,trs_{j,c_{i+1}},trt_{k,c_{i+1}})=\\max\\{f(i,j,k)+w\\}$\uff0c\u76ee\u6807 $\\max\\{f(n,j,k)\\}$\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#define rep(i, l, r) for (int i = l; i <= r; ++i)\n\nusing namespace std;\n\nint n, ls, lt, nxts[55], nxtt[55], trs[55][26], trt[55][26];\nchar a[1005], s[55], t[55];\nint f[1005][55][55];\n\nvoid KMP(char *s, int len, int *nxt, int tr[][26]) {\n    for (int i = 2, p = 0; i <= len; ++i) {\n        while (p && s[i] != s[p + 1]) p = nxt[p];\n        if (s[i] == s[p + 1]) ++p;\n        nxt[i] = p;\n    }\n    rep(i, 0, len) rep(j, 0, 25) {\n        if (i < len && s[i + 1] == j + 'a') tr[i][j] = i + 1; \n        else if (i) tr[i][j] = tr[nxt[i]][j];\n    }\n}\nvoid ckmax(int &x, int t) { if (x < t) x = t; }\n\nint main(void) {\n    scanf(\"%s%s%s\", a + 1, s + 1, t + 1);\n    n = strlen(a + 1); ls = strlen(s + 1); lt = strlen(t + 1);\n    KMP(s, ls, nxts, trs); KMP(t, lt, nxtt, trt);\n    memset(f, 0xbf, sizeof f); f[0][0][0] = 0;\n    rep(i, 0, n - 1) rep(j, 0, ls) rep(k, 0, lt) rep(p, 0, 25) if (a[i + 1] == '*' || a[i + 1] == p + 'a') {\n        int w = 0;\n        if (trs[j][p] == ls) ++w; if (trt[k][p] == lt) --w; \n        ckmax(f[i + 1][trs[j][p]][trt[k][p]], f[i][j][k] + w);\n    }\n    int ans = -1e9;\n    rep(i, 0, ls) rep(j, 0, lt) ans = max(ans, f[n][i][j]);\n    return printf(\"%d\\n\", ans), 0;\n}\n```",
        "postTime": 1673871306,
        "uid": 187051,
        "name": "james1BadCreeper",
        "ccfLevel": 6,
        "title": "CF1136D"
    },
    {
        "content": "# CF1163&558Div.2D\u9898\u89e3\n\t\u672c\u849f\u84bb\u7b2c\u4e8c\u573acf~\n    \u672c\u9898\u4e3b\u8981\u8003\u5bdfDP\u548c\u5b57\u7b26\u4e32\u5339\u914dKMP\u3002\n    \u6211\u4eec\u8bbef[i][j][k]\u8868\u793a\uff0c\u6587\u672c\u4e32\u4ece\u5de6\u5230\u53f3\u5339\u914d\u5230\u7b2ci\u4f4d\uff0cs\u4e32\u5339\u914d\u5230\u7b2cj\n    \u4f4d\uff0ct\u4e32\u5339\u914d\u5230\u7b2ck\u4f4d\u65f6\u7684\u6700\u5927\u7684f(c,s)\u2212f(c,t)\u3002\n    \u5728\u8fdb\u884cDP\u4e4b\u524d\uff0c\u5148\u5bf9s\u4e32\u548ct\u4e32\u8fdb\u884c\u4e00\u6b21KMP\uff0c\u5f97\u5230\u4e24\u4e2anext\u6570\u7ec4\u3002\u63a5\u4e0b\n    \u6765\uff0cDP\u7684\u8f6c\u79fb\u65b9\u7a0b\u53ef\u4ee5\u5206\u4e24\u79cd\u60c5\u51b5\u8ba8\u8bba\uff1a\u7b2ci\u4f4d\u662f\u4e0d\u662f\u2018*\u2019\u3002\u5982\u679c\u662f\uff0c\n    \u76f4\u63a5\u66b4\u529b\u679a\u4e3e\u2018a\u2019\u5230\u2018z\u2019\uff0c\u5982\u679c\u4e0d\u662f\uff0c\u5c31\u65e0\u9700\u679a\u4e3e\u3002\n    \u7136\u540e\u518d\u679a\u4e3ej\u548ck\uff0c\u8f6c\u79fb\u65b9\u7a0b\u5373\u4e3a\uff1a\n###     f[i][p1][p2]=f[i-1][j][k]+W;\n\t\u5177\u4f53\u5b9e\u73b0\u8fd8\u662f\u770b\u4ee3\u7801~\n   ```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define re register int\n#define F(x,y,z) for(re x=y;x<=z;x++)\n#define FOR(x,y,z) for(re x=y;x>=z;x--)\n#define I inline void\n#define IN inline int\ntypedef long long ll;\nI read(int &res){\n    re g=1;register char ch=getchar();res=0;\n    while(!isdigit(ch)){\n        if(ch=='-')g=-1;\n        ch=getchar();\n    }\n    while(isdigit(ch)){\n        res=(res<<3)+(res<<1)+(ch^48);\n        ch=getchar();\n    }\n    res*=g;\n}\nchar c[1010],s[100],t[100];\nint n,m,l,pos,nt[100],nxt[100],f[1010][60][60],v[1010][60][60];\nint main(){\n    scanf(\"%s %s %s\",c+1,s+1,t+1);\n    l=strlen(c+1);\n    n=strlen(s+1);\n    m=strlen(t+1);\n    nt[0]=0;pos=0;\n    nt[1]=0;\n    F(i,2,n){\n        while(pos&&s[pos+1]!=s[i])pos=nt[pos];\n        if(s[pos+1]==s[i])pos++;\n        nt[i]=pos;\n    }\n    nxt[0]=nxt[1]=0;pos=0;\n    F(i,2,m){\n        while(pos&&t[pos+1]!=t[i])pos=nxt[pos];\n        if(t[pos+1]==t[i])pos++;\n        nxt[i]=pos;\n    }//\u5206\u522b\u6c42\u51fas\u4e32\u548ct\u4e32\u7684next\u6570\u7ec4 \n    memset(v,0,sizeof(v));\n    re p1,p2,W;\n    v[0][0][0]=1;//\u7528v\u6570\u7ec4\u8868\u793a\u8fd9\u79cd\u72b6\u6001\u662f\u5426\u5b58\u5728 \n    F(i,1,l){\n        if(c[i]!='*'){\n            F(j,0,n-1){\n                F(k,0,m-1){\n                    if(!v[i-1][j][k])continue;\n                    W=0;\n                    for(p1=j;p1&&s[p1+1]!=c[i];p1=nt[p1]){\n                        \n                    } \n                    for(p2=k;p2&&t[p2+1]!=c[i];p2=nxt[p2]){\n                        \n                    }\n                    if(s[p1+1]==c[i])p1++;\n                    if(t[p2+1]==c[i])p2++;//\u5206\u522b\u5728s\u4e32\u548ct\u4e32\u4e0a\u5339\u914d \n                    if(p1==n){\n                    W++;\n                        p1=nt[p1];\t\n                    }//s\u4e32\u5339\u914d\u6210\u529f\uff0c\u7b54\u6848W++ \n                    if(p2==m){\n                        W--;\n                        p2=nxt[p2];\n                    } //t\u4e32\u5339\u914d\u6210\u529f\uff0c\u7b54\u6848W--\n\t\t\t\t\t//\u6b64\u5916\uff0c\u7531\u4e8ej\u548ck\u7684\u53d6\u503c\u8303\u56f4\u4e3a[0,n-1],[0,m-1],\u5339\u914d\u6210\u529f\u65f6\u9700\u8981\u8f6c\u5230\u5b83\u7684next \n                    if(!v[i][p1][p2])f[i][p1][p2]=f[i-1][j][k]+W;\n                    else f[i][p1][p2]=max(f[i][p1][p2],f[i-1][j][k]+W);//\u8bfb\u8005\u53ef\u4ee5\u81ea\u884c\u7406\u89e3\u4e00\u4e0b\uff0c\u8fd9\u91cc\u4e3a\u4ec0\u4e48\u8981\u8fd9\u4e48\u505a\uff08\u5176\u5b9e\u4e5f\u53ef\u4ee5\u4e0d\u8fd9\u4e48\u9ebb\u70e6\uff09 \n                    v[i][p1][p2]=1;\n                }\n            }\n        }\n        else{\n            F(bas,'a','z'){//\u7b2ci\u4f4d\u4e3a'*'\u65f6\uff0c\u66b4\u529b\u679a\u4e3e'a'\u5230'z' \n                c[i]=bas;\n                //\u540c\u4e0a \n                F(j,0,n-1){\n                    F(k,0,m-1){\n                        if(!v[i-1][j][k])continue;\n                        W=0;\n                        for(p1=j;p1&&s[p1+1]!=c[i];p1=nt[p1]){\n                        \n                        }\n                        for(p2=k;p2&&t[p2+1]!=c[i];p2=nxt[p2]){\n                        \n                        }\n                        if(s[p1+1]==c[i])p1++;\n                        if(t[p2+1]==c[i])p2++;\n                        if(p1==n){\n                            W++;\n                            p1=nt[p1];\t\n                        }\n                        if(p2==m){\n                            W--;\n                            p2=nxt[p2];\n                        }\n                        if(!v[i][p1][p2])f[i][p1][p2]=f[i-1][j][k]+W;\n                        else f[i][p1][p2]=max(f[i][p1][p2],f[i-1][j][k]+W);\n                        v[i][p1][p2]=1;\n                    }\n                }\n            }\n            \n        }\t\t\n    }\n    re ans=-20000;//\u4e00\u5b9a\u8981\u6ce8\u610f\uff0c\u7b54\u6848\u53ef\u80fd\u4f1a\u662f\u8d1f\u6570\uff0c\u6781\u9650\u60c5\u51b5\u4e0b\uff0c\u7b54\u6848\u5c06\u4f1a\u662f-m \n    F(i,0,n-1){\n        F(j,0,m-1){\n            if(v[l][i][j])ans=max(ans,f[l][i][j]);//\u66f4\u65b0\u7b54\u6848 \n        }\n    }\n    printf(\"%d\",ans);\n    return 0;\n}\n```\n",
        "postTime": 1557536472,
        "uid": 93453,
        "name": "Purple_wzy",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1163D \u3010Mysterious Code\u3011"
    },
    {
        "content": "~~zxx \u7684\u9898\u5355\u6765\u7684\uff08~~\n\n\u53d1\u4e00\u4e2a\u65e0\u8111 kmp \u81ea\u52a8\u673a + dp \u505a\u6cd5\u3002\n\n\u770b\u5230\u9898\u5c31\u5f88 dp\uff0c\u8003\u8651\u8bbe\u8ba1\u72b6\u6001\u3002\u663e\u7136\u586b\u5b57\u6bcd\u65f6\u8981\u77e5\u9053\u5f53\u524d\u4e32\u4e0e $s,t$ \u7684\u5339\u914d\u4f4d\u6570\uff0c\u5426\u5219\u5c31\u4e0d\u77e5\u9053 $s,t$ \u662f\u5426\u5b8c\u6574\u51fa\u73b0\u3002\u8bbe $f_{i,j,k}$ \u8868\u793a\u586b\u5230 $c$ \u7684\u7b2c $i$ \u4e2a\u5b57\u7b26\uff0c\u4e0e $s$ \u5339\u914d $j$ \u4f4d\uff0c\u4e0e $t$ \u5339\u914d $k$ \u4f4d\u3002\u8f6c\u79fb\u53ef\u4ee5\u679a\u4e3e\u4e0b\u4e00\u4f4d\u586b\u7684\u5b57\u6bcd\u3002\n\n\u53d1\u73b0\u6211\u4eec\u9700\u8981\u6c42\u51fa\u67d0\u4e2a\u4e32\u7684\u524d $i$ \u4f4d\u540e\u63a5\u4e00\u4e2a\u5b57\u7b26\u7684\u5339\u914d\u4f4d\u6570\uff0c\u8fd9\u4e0d\u5c31\u662f kmp \u81ea\u52a8\u673a\u5e72\u7684\u4e8b\u60c5\u5417\u3002\u3002\u3002\u4e8e\u662f\u5bf9 $s,t$ \u5efa kmp \u81ea\u52a8\u673a\uff0c\u8f6c\u79fb\u5c31\u5f88\u7b80\u5355\u4e86\uff0c\u5927\u6982\u662f $f_{i,j',k'} \\gets f_{i,j,k} + [j'=|s|] - [k'=|t|]$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(26|c||s||t|)$\u3002\n\n[code](https://codeforces.com/contest/1163/submission/187103031)\uff0c[\u53cc\u500d\u7ecf\u9a8c](https://www.luogu.com.cn/problem/CF808G)",
        "postTime": 1672294645,
        "uid": 275273,
        "name": "zltqwq",
        "ccfLevel": 0,
        "title": "CF1163D \u9898\u89e3"
    }
]
[
    {
        "content": "\u8d39\u7528\u6d41\u3002\n\n\u5982\u679c\u7b2c$i$\u5929\u548c\u7b2c$j$\u5929\u90fd\u51fa\u73b0\u4e86\u540c\u4e00\u79cd\u4e66\uff0c\u4e14\u7b2c$i\\sim j-1$\u5929\u6ca1\u6709\u6254\u6389\uff0c\u5219\u53ea\u9700\u8981\u82b1\u8d391\u672c\u7684\u4ef7\u683c\u3002\u5982\u679c\u6254\u6389\u4e86\uff0c\u5219\u8981\u82b1\u8d392\u672c\u7684\u4ef7\u683c\u3002\n\n\u663e\u7136\uff0c\u5982\u679c\u5728$i\\sim j-1$\u4e2d\u67d0\u4e00\u5929\u8981\u6254\u6389\u8fd9\u672c\u4e66\uff0c\u5728\u7b2c$i$\u5929\u8d2d\u5165\u540e\u76f4\u63a5\u6254\u6389\u5e76\u4e0d\u4f1a\u4f7f\u7b54\u6848\u53d8\u52a3\u3002\n\n\u6211\u4eec\u7528\u8d39\u7528\u6d41\uff0c\u5f88\u96be\u4e00\u5929\u4e00\u5929\u8003\u8651\u4e70\u8fd8\u662f\u4e0d\u4e70\uff0c\u53ea\u80fd\u5168\u90fd\u90fd\u5148\u4e70\u8fdb\u6765\u3002\u8003\u8651\u4e00\u79cd\u64cd\u4f5c\uff0c\u80fd\u628a\u591a\u4f59\u7684\u8d2d\u5165\u82b1\u8d39\u62b5\u6d88\u6389\u3002\n\n\u8003\u8651\u7b2c$i$\u5929\u8d2d\u5165\u7684\u4e00\u672c\u4e66\uff0c\u5982\u679c\u7559\u5230\u4e86\u7b2c$j$\u5929\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u7b2c$j-1$\u5929\u201c\u5356\u201d\u6389\u8fd9\u672c\u4e66\uff0c\u83b7\u5f97\u76f8\u5e94\u7684\u6536\u5165\u3002\u8fd9\u6837\u5c31\u76f8\u5f53\u4e8e\u7b2c$j$\u5929\u6ca1\u6709\u4e70\u8fd9\u672c\u4e66\u3002\n\n\u5efa\u56fe\u65b9\u6cd5\u5982\u4e0b\uff1a\n\n\u5bf9\u6bcf\u5929\u90fd\u6709\u4e24\u4e2a\u8282\u70b9$v_i,v'_i$\uff0c\u8868\u793a\u5165\u70b9\u548c\u51fa\u70b9\u3002\n\n\u4ece\u6e90\u70b9\u5411\u6bcf\u4e2a$v_i$\u8fde\u5bb9\u91cf\u4e3a1\uff0c\u8d39\u7528\u4e3a\u5f53\u5929\u8fd9\u79cd\u4e66\u7684\u4ef7\u683c$c_{a_i}$\u7684\u8fb9\uff0c\u8868\u793a\u6bcf\u672c\u4e66\u3002\n\n\u4ece\u6bcf\u4e2a$v_i$\u5411$v_{i+1}$\u8fde\u5bb9\u91cf\u4e3a$k-1$\uff0c\u8d39\u7528\u4e3a0\u7684\u8fb9\uff0c\u8868\u793a\u7b2c$i$\u5929\u4e66\u67b6\u6700\u591a\u7559$k-1$\u672c\u4e66\uff0c\u5269\u4e0b1\u4e2a\u4f4d\u7f6e\u7ed9\u7b2c$i+1$\u5929\u7684\u4e66\u3002\n\n\u4ece\u6bcf\u4e2a$v_i$\u5411$v'_i$\u8fde\u5bb9\u91cf\u4e3a1\uff0c\u8d39\u7528\u4e3a0\u7684\u8fb9\uff0c\u8868\u793a\u5f53\u5929\u4e70\u6765\u5c31\u6254\u6389\u4e86\u8fd9\u672c\u4e66\u3002\n\n\u4ece$v_{i-1}$\u5411$a_i$\u4e0a\u4e00\u6b21\u7684\u51fa\u73b0\u4f4d\u7f6e$j$\u5bf9\u5e94\u7684$v'_ j$\u8fde\u5bb9\u91cf\u4e3a1\uff0c\u8d39\u7528\u4e3a$ -c_{a_i}$\u7684\u8fb9\uff0c\u8868\u793a\u5356\u6389\u8fd9\u672c\u4e66\u3002\n\n\u4ece\u6bcf\u4e2a$v'_i$\u5411\u6c47\u70b9\u8fde\u5bb9\u91cf\u4e3a1\uff0c\u8d39\u7528\u4e3a0\u7684\u8fb9\uff0c\u8868\u793a\u8981\u4e48\u6254\uff0c\u8981\u4e48\u5356\uff0c\u6700\u591a\u9009\u62e9\u4e00\u79cd\u3002\n\n\u5982\u679c\u5f53\u5929\u6ca1\u6709\u6254\uff0c\u5219\u5f53\u5929\u7684\u6d41\u4e00\u5b9a\u4f1a\u987a\u7740\u4e66\u67b6\u5f80\u4e0b\u6d41\uff0c\u76f4\u5230\u5356\u6389\u3002\n\n\u7531\u4e8e\u8d39\u7528\u6d41\u4fdd\u8bc1\u603b\u8d39\u7528\u6700\u5c0f\uff0c\u6700\u7ec8\u7684\u8d39\u7528\u5c31\u662f\u7b54\u6848\u3002\n\n## Code\uff1a\n```cpp\n#include<cstdio>\n#include<queue>\n#include<cstring>\n#include<algorithm>\nstruct edge{\n\tint to,nxt,cap,cost;\n}e[219744];\nint head[180],cnt=1,n,k,a[88],pre[88],c[88],T,tot[88];\ninline void addedge(int u,int v,int flow,int cost){\n\te[++cnt]=(edge){v,head[u],flow,cost};head[u]=cnt;\n\te[++cnt]=(edge){u,head[v],0,-cost};head[v]=cnt;\n}\nstd::queue<int>q;\nbool spfa(int&flow,int&cost){\n\tstatic int a[180],d[180],pre_e[180],vis[180];\n\tmemset(a,0x3f,sizeof a);\n\tmemset(d,0x3f,sizeof a);\n\tmemset(vis,0,sizeof a);\n\tmemset(pre_e,0,sizeof a);\n\t*d=0;\n\tfor(q.push(0);!q.empty();){\n\t\tint u=q.front();q.pop();\n\t\tvis[u]=0;\n\t\tfor(int i=head[u];i;i=e[i].nxt)\n\t\tif(e[i].cap&&d[e[i].to]>d[u]+e[i].cost){\n\t\t\td[e[i].to]=d[u]+e[i].cost;\n\t\t\ta[e[i].to]=std::min(a[u],e[i].cap);\n\t\t\tpre_e[e[i].to]=i;\n\t\t\tif(!vis[e[i].to])vis[e[i].to]=1,q.push(e[i].to);\n\t\t}\n\t}\n\tif(d[T]==0x3f3f3f3f)return 0;\n\tflow+=a[T];cost+=d[T]*a[T];\n\tfor(int i=T;i;i=e[pre_e[i]^1].to){\n\t\te[pre_e[i]].cap-=a[T];\n\t\te[pre_e[i]^1].cap+=a[T];\n\t}\n\treturn 1;\n}\nint main(){\n\tscanf(\"%d%d\",&n,&k);\n\tT=n*2+1;\n\tfor(int i=1;i<=n;++i){\n\t\taddedge(i,i+n,1,0);\n\t\taddedge(i+n,T,1,0);\n\t\tscanf(\"%d\",&a[i]);\n\t}\n\tfor(int i=1;i<=n;++i)scanf(\"%d\",&c[i]);\n\tfor(int i=1;i<=n;++i){\n\t\taddedge(0,i,1,c[a[i]]);\n\t\tif(pre[a[i]])\n\t\taddedge(i-1,pre[a[i]]+n,1,-c[a[i]]);\n\t\tpre[a[i]]=i;\n\t}\n\tfor(int i=1;i<n;++i)addedge(i,i+1,k-1,0);\n\tint flow=0,cost=0;\n\twhile(spfa(flow,cost));\n\tprintf(\"%d\\n\",cost);\n\treturn 0;\n}\n```",
        "postTime": 1550218260,
        "uid": 6813,
        "name": "mrsrz",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF802C \u3010Heidi and Library (hard)\u3011"
    },
    {
        "content": "\n\u66f4\u5496\u55b1\u68d2\u7684\u9605\u8bfb\u4f53\u9a8c $\\to $ [`George1123`](https://www.cnblogs.com/George1123/p/14011031.html)\n\n---\n\n## \u9898\u9762\n\n> [CF802C Heidi and Library (hard)](https://www.luogu.com.cn/problem/CF802C)\n\n> \u6709\u4e00\u4e2a\u5927\u5c0f\u4e3a $k$ \u7684\u7a7a\u4e66\u67b6\u3002\u6709 $n$ \u5929\u548c $n$ \u79cd\u4e66\uff0c\u6bcf\u5929\u8981\u6c42\u4e66\u67b6\u4e2d\u6709\u4e66 $a_i$\u3002\u6bcf\u5929\u53ef\u4ee5\u591a\u6b21\u4e70\u4e66\uff0c\u4e70\u4e66 $i$ \u7684\u4ef7\u683c\u4e3a $c_i$\u3002\u6bcf\u5929\u53ef\u4ee5\u6254\u4e66\uff08\u56e0\u4e3a\u4e66\u67b6\u6ee1\u4e86\uff09\u3002\u6c42\u6ee1\u8db3\u8981\u6c42\u7684\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n> \u6570\u636e\u8303\u56f4\uff1a$1\\le n,k\\le 80$\u3002\n\n---\n\n## \u8def\u6807\n\n\u5f88\u660e\u663e\u8fd9\u662f\u4e00\u9053\u5957\u8def\u70c2\u5927\u8857\u7684\u6c34\u9898\uff0c\u4f46\u662f\u4eca\u5929\u849f\u84bb\u60f3\u8bb2 $3$ \u79cd\u5de7\u5999\u7684\u505a\u6cd5\u3002\n\n> \u6b64\u9898\u7684\u8f93\u51fa\u65b9\u6848\u7248\uff1a[CF132E Bits of merry old England](https://www.luogu.com.cn/problem/CF132E)\n\n$(u,v,f,c)$ \u8868\u793a\u8fde\u4e00\u6761 $u$ \u5230 $v$ \u5bb9\u91cf $f$ \u8d39\u7528 $c$ \u7684\u8fb9\uff0c\u5e76\u5efa\u5b83\u7684\u53cd\u6094\u8fb9\u3002\n\n---\n\n## \u9898\u89e3 1\n\n\u8fd9\u4e2a\u849f\u84bb\u7684\u505a\u6cd5\uff0c\u662f\u5f53\u524d\u6700\u52a3\u89e3\u3002\n\n\u6839\u636e\u65f6\u95f4\u548c\u4e66\u79cd\u62c6\u70b9 $(time,book)$\u3002\n\n\u589e\u52a0\u4e00\u79cd\u4e66\u79cd\u53eb\u201c\u7a7a\u201d\uff08$n$\uff09\uff0c\u589e\u52a0\u4e00\u4e2a\u65f6\u95f4\u4e3a\u5f00\u59cb\u65f6\uff08$0$\uff09\u3002\n\n\u5148 $(s,(0,n),k,0)$\uff0c\u6d41\u91cf $x$ \u6d41\u5230\u70b9 $(i,j)$ \u8868\u793a\u5728\u7b2c $i$ \u65f6\u95f4 $x$ \u8fd9\u4e2a\u4e66\u67b6\u4f4d\u7f6e\u662f\u4e66 $j$\u3002\n\n$((i,j),(i+1,x)(x\\neq j),1,c_x)$\uff0c\u8868\u793a\u8fd9\u4e2a\u4f4d\u7f6e\u6362\u4e66\u3002\u5f88\u660e\u663e\u4e00\u5929\u6362\u4e00\u672c\u4e66\u8db3\u77e3\u3002\n\n$((i,j),(i+1,j),k,0)$\uff0c\u8868\u793a\u4e0d\u6362\u4e66\u3002\n\n\u5982\u679c $j=a_i$\uff0c\u628a $(i,j)$ \u62c6\u6210 $(i,j)_0$ \u548c $(i,j)_1$\uff0c$((i,j)_0,t,1,0)$\uff0c$(s,(i,j)_1,1,0)$\uff0c\u8868\u793a\u8981\u6c42\u6709 $j$ \u8fd9\u672c\u4e66\u3002$((i,j)_0,(i,j)_1,k-1,0)$\u3002\n\n$((n,j),mid,k,0)$\uff0c$(mid,t,k,0)$\u3002$mid$ \u7684\u4f5c\u7528\u662f\u9650\u5236\u6d41\u91cf\u3002\n\n\u7136\u540e\u8dd1\u56fe\uff0c\u6d41\u91cf\u5fc5\u5b9a\u662f $n+k$ \u8d39\u7528\u662f\u7b54\u6848\u3002\n\n**\u70b9\u6570 $\\Theta(n^2)$\uff0c\u8fb9\u6570 $\\Theta(n^3)$\u3002**\n\n### \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef double db;\n#define x first\n#define y second\n#define bg begin()\n#define ed end()\n#define pb push_back\n#define mp make_pair\n#define sz(a) int((a).size())\n#define R(i,n) for(int i(0);i<(n);++i)\n#define L(i,n) for(int i((n)-1);~i;--i)\nconst int iinf=0x3f3f3f3f;\nconst ll linf=0x3f3f3f3f3f3f3f3f;\n \n//Data\nconst int N=80;\nint n,k,a[N],c[N];\n \n//Flows\nconst int fN=(N+1)*(N+1)+N+3;\nint fn,s,t,mid,dep[fN],pre[fN],q[fN],*ta,*he;\nbool vis[fN];\nvector<int> e[fN],to,fw,co;\nvoid adde(int u,int v,int w,int c){\n    // cout<<u<<' '<<v<<' '<<w<<'-'<<c<<'\\n';\n    e[u].pb(sz(to)),to.pb(v),fw.pb(w),co.pb(+c);\n    e[v].pb(sz(to)),to.pb(u),fw.pb(0),co.pb(-c);\n}\nbool spfa(){\n    R(u,fn) dep[u]=iinf,vis[u]=false,pre[u]=-1;\n    ta=he=q,dep[*ta++=pre[s]=s]=0,vis[s]=true;\n    while(ta!=he){\n        int u=*he++; he-q>=fn&&(he-=fn),vis[u]=false;\n        for(int v:e[u])if(fw[v]&&dep[to[v]]>dep[u]+co[v])\n            dep[to[v]]=dep[u]+co[v],pre[to[v]]=v,\n            !vis[to[v]]&&(*ta++=to[v],ta-q>=fn&&(ta-=fn),vis[to[v]]=true);\n    }\n    return dep[t]^iinf;\n}\npair<int,int> flow(){\n    pair<int,int> res(0,0);\n    while(spfa()){\n        int f=iinf;\n        for(int u=t;u^s;u=to[pre[u]^1]) f=min(f,fw[pre[u]]);\n        for(int u=t;u^s;u=to[pre[u]^1]) fw[pre[u]]-=f,fw[pre[u]^1]+=f;\n        res.x+=f,res.y+=dep[t]*f;\n    }\n    return res;\n}\n \n//Main\nint main(){\n    ios::sync_with_stdio(0),cin.tie(0),cout.tie(0);\n    cin>>n>>k,fn=(t=(s=(mid=(n+1)*(n+1)+n)+1)+1)+1;\n    #define p(i,j) ((i)*(n+1)+(j))\n    R(i,n) cin>>a[i],--a[i]; R(i,n) cin>>c[i];\n    adde(mid,t,k,0),adde(s,p(0,n),k,0);\n    R(i,n+1) adde(i==a[n-1]?(n+1)*(n+1)+n-1:p(n,i),mid,k,0);\n    R(i,n){\n        adde(p(i+1,a[i]),t,1,0),adde(s,(n+1)*(n+1)+i,1,0);\n        adde(p(i+1,a[i]),(n+1)*(n+1)+i,k-1,0);\n        R(j,n+1){\n            int last=(i&&j==a[i-1])?(n+1)*(n+1)+i-1:p(i,j);\n            adde(last,p(i+1,j),k,0);\n            R(t,n) (j^t)&&(adde(last,p(i+1,t),1,c[t]),true);\n        }\n    }\n    pair<int,int> ns(flow());\n    assert(ns.x==k+n),cout<<ns.y<<'\\n';\n    return 0;\n}\n```\n\n---\n\n## \u9898\u89e3 2\n\n\u795e\u4ed9 `@mrsrz` \u7684\u505a\u6cd5\uff0c\u975e\u5e38\u5de7\u5999\u3002\n\n\u6bcf\u672c\u9700\u8981\u4e66\u53ef\u4ee5\u5728\u5f53\u5929\u5148\u4e70\u4e0a\uff0c\u5982\u679c\u624b\u4e0a\u5df2\u7ecf\u6709\u8fd9\u672c\u4e66\u4e86\u53ef\u4ee5\u628a\u624b\u4e0a\u8fd9\u672c\u5356\u4e86\u3002\n\n\u628a\u6bcf\u5929\u62c6\u6210 $u_0$ \u548c $u_1$\uff0c$(s,u_0,1,c_{a_u})$ \u8868\u793a\u4e70\u4e66\uff0c$(u_0,u_1,1,0)$ \u8868\u793a\u4f9b\u4e66\uff0c$(u_1,t,1,0)$ \u8868\u793a\u63d0\u4ea4\u4e66\uff0c$(u_0,(u+1)_0,k-1,0)$ \u8868\u793a\u5b58\u4e66\uff08$k-1$ \u662f\u56e0\u4e3a\u7559\u7ed9\u4e0b\u4e00\u5929\u7684\u4e66\u4f4d\u7f6e\uff09\uff0c$((u-1)_0,p(a_u)_1,1,-c_{a_u})$ \u8868\u793a\u5356\u4e66\uff08$p(x)$ \u8868\u793a\u7b2c $x$ \u79cd\u4e66\u4e0a\u6b21\u51fa\u73b0\u4f4d\u7f6e\uff09\u3002\n\n**\u70b9\u6570 $\\Theta(n)$\uff0c\u8fb9\u6570 $\\Theta(n)$\u3002**\n\n### \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef double db;\n#define x first\n#define y second\n#define bg begin()\n#define ed end()\n#define pb push_back\n#define mp make_pair\n#define sz(a) int((a).size())\n#define R(i,n) for(int i(0);i<(n);++i)\n#define L(i,n) for(int i((n)-1);~i;--i)\nconst int iinf=0x3f3f3f3f;\nconst ll linf=0x3f3f3f3f3f3f3f3f;\n\n//Data\nconst int N=80;\nint n,k,a[N],c[N],p[N];\n\n//Flows\nconst int fN=(N<<1)+2;\nint fn,s,t,dep[fN],pre[fN],q[fN],*ta,*he;\nbool vis[fN];\nvector<int> e[fN],to,fw,co;\nvoid adde(int u,int v,int w,int c){\n    // cout<<u<<' '<<v<<' '<<w<<'-'<<c<<'\\n';\n    e[u].pb(sz(to)),to.pb(v),fw.pb(w),co.pb(+c);\n    e[v].pb(sz(to)),to.pb(u),fw.pb(0),co.pb(-c);\n}\nbool spfa(){\n    R(u,fn) dep[u]=iinf,vis[u]=false,pre[u]=-1;\n    ta=he=q,dep[*ta++=pre[s]=s]=0,vis[s]=true;\n    while(ta!=he){\n        int u=*he++; he-q>=fn&&(he-=fn),vis[u]=false;\n        for(int v:e[u])if(fw[v]&&dep[to[v]]>dep[u]+co[v])\n            dep[to[v]]=dep[u]+co[v],pre[to[v]]=v,\n            !vis[to[v]]&&(*ta++=to[v],ta-q>=fn&&(ta-=fn),vis[to[v]]=true);\n    }\n    return dep[t]^iinf;\n}\npair<int,int> flow(){\n    pair<int,int> res(0,0);\n    while(spfa()){\n        int f=iinf;\n        for(int u=t;u^s;u=to[pre[u]^1]) f=min(f,fw[pre[u]]);\n        for(int u=t;u^s;u=to[pre[u]^1]) fw[pre[u]]-=f,fw[pre[u]^1]+=f;\n        res.x+=f,res.y+=dep[t]*f;\n    }\n    return res;\n}\n\n//Main\nint main(){\n    ios::sync_with_stdio(0),cin.tie(0),cout.tie(0);\n    cin>>n>>k,fn=(t=(s=n<<1)+1)+1;\n    R(i,n) cin>>a[i],--a[i];\n    R(i,n) cin>>c[i],p[i]=-1;\n    R(i,n){\n        adde(i,i+n,1,0),adde(i+n,t,1,0);\n        adde(s,i,1,c[a[i]]),i+1<n&&(adde(i,i+1,k-1,0),true);\n        ~p[a[i]]&&(adde(i-1,p[a[i]]+n,1,-c[a[i]]),true),p[a[i]]=i;\n    }\n    cout<<flow().y<<'\\n';\n    return 0;\n}\n```\n\n---\n\n## \u9898\u89e3 3\n\n\u6839\u636e `@Um_nik` \u548c `@Kronecker` \u5199\u7684\u5f53\u524d `Codeforces` \u4e0a\u6b64\u9898\u6700\u4f18\u89e3\u6539\u7f16\uff0c\u5230\u8fd9\u91cc\u770b [\u539f\u7248](https://codeforces.com/problemset/submission/802/27404603)\u3002\n\n\u539f\u7406\u662f\u53cd\u6094\u8d2a\u5fc3\uff0c\u7528\u7f51\u7edc\u6d41\u6765\u5b9e\u73b0\u3002\n\n\u540c\u6837\u628a\u70b9\u62c6\u6210 $u_0$ \u548c $u_1$\uff0c$(u_0,u_1,1,-\\infty)$ \u8868\u793a\u6bcf\u6b21\u589e\u5e7f\u540e\u90fd\u5fc5\u987b\u9009\u6b64\u8fb9\uff0c$(s,mid,k,0)$ \u9650\u5236\u6d41\u91cf\uff0c$(mid,u_0,1,c_{a_u})$ \u8868\u793a\u4e70\u4e66\uff0c$(u_1,t,1,0)$ \u8868\u793a\u4ea4\u4e66\uff0c$(u_1,v_0,1,c_{a_v})(u<v,a_u\\neq a_v)$ \u8868\u793a\u6362\u4e66\uff0c$(u_1,v_0,1,0)(u<v,a_u=a_v)$ \u8868\u793a\u6cbf\u7528\u4e66\u3002\n\n\u7136\u540e\u8dd1\u56fe\uff0c\u4e00\u65e6\u67d0\u6b21 `spfa` \u4ee5\u540e $dep_t\\ge 0$ \u4e86\u5c31\u505c\u6b62\uff08\u6700\u5c0f\u8d39\u7528\u53ef\u884c\u6d41\uff09\uff0c\u7b54\u6848\u662f\u8d39\u7528 $+n\\cdot \\infty$\u3002\n\n**\u70b9\u6570 $\\Theta(n)$\uff0c\u8fb9\u6570 $\\Theta(n^2)$\u3002**\n\n\u8fd9\u4e2a\u505a\u6cd5\u6709\u4e2a\u795e\u5947\u4e4b\u5904\uff1a\u53ef\u4ee5\u901a\u8fc7\u4e0d\u505c\u589e\u52a0 $s$ \u548c $mid$ \u4e4b\u95f4\u7684\u6d41\u91cf\u5e76\u589e\u5e7f\u6d41\u91cf $1$\uff0c\u9ad8\u6548\u5730\u6c42\u51fa $k=1\\sim K$ \u65f6\u7684\u7b54\u6848\uff0c\u53ea\u4e0d\u8fc7\u9700\u8981\u628a\u4e0a\u9762\u90a3\u53e5\u8bdd\u7684\u505c\u6b62\u53d8\u6210\u8fde\u4e00\u6761 $(s,t,\\infty,0)$ \u7684\u8fb9\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef double db;\n#define x first\n#define y second\n#define bg begin()\n#define ed end()\n#define pb push_back\n#define mp make_pair\n#define sz(a) int((a).size())\n#define R(i,n) for(int i(0);i<(n);++i)\n#define L(i,n) for(int i((n)-1);~i;--i)\nconst int iinf=0x3f3f3f3f;\nconst ll linf=0x3f3f3f3f3f3f3f3f;\n\n//Data\nconst int N=80,F=3e6;\nint n,k,mid,a[N],c[N],p[N];\n\n//Flows\nconst int fN=(N<<1)+3;\nint fn,s,t,dep[fN],pre[fN],q[fN],*ta,*he;\nbool vis[fN];\nvector<int> e[fN],to,fw,co;\nvoid adde(int u,int v,int w,int c){\n    // cout<<u<<' '<<v<<' '<<w<<'-'<<c<<'\\n';\n    e[u].pb(sz(to)),to.pb(v),fw.pb(w),co.pb(+c);\n    e[v].pb(sz(to)),to.pb(u),fw.pb(0),co.pb(-c);\n}\nbool spfa(){\n    R(u,fn) dep[u]=iinf,vis[u]=false,pre[u]=-1;\n    ta=he=q,dep[*ta++=pre[s]=s]=0,vis[s]=true;\n    while(ta!=he){\n        int u=*he++; he-q>=fn&&(he-=fn),vis[u]=false;\n        for(int v:e[u])if(fw[v]&&dep[to[v]]>dep[u]+co[v])\n            dep[to[v]]=dep[u]+co[v],pre[to[v]]=v,\n            !vis[to[v]]&&(*ta++=to[v],ta-q>=fn&&(ta-=fn),vis[to[v]]=true);\n    }\n    return dep[t]^iinf;\n}\npair<int,int> flow(){\n    pair<int,int> res(0,0);\n    while(spfa()){\n        if(dep[t]>=0) break;\n        int f=iinf;\n        for(int u=t;u^s;u=to[pre[u]^1]) f=min(f,fw[pre[u]]);\n        for(int u=t;u^s;u=to[pre[u]^1]) fw[pre[u]]-=f,fw[pre[u]^1]+=f;\n        res.x+=f,res.y+=dep[t]*f;\n    }\n    return res;\n}\n\n//Main\nint main(){\n    ios::sync_with_stdio(0),cin.tie(0),cout.tie(0);\n    cin>>n>>k,fn=(t=(s=(mid=n<<1)+1)+1)+1,adde(s,mid,k,0);\n    R(i,n) cin>>a[i],--a[i]; R(i,n) cin>>c[i];\n    R(i,n) adde(mid,i,1,c[a[i]]),adde(i,i+n,1,-F),adde(i+n,t,1,0);\n    R(j,n)R(i,j) adde(i+n,j,1,a[i]==a[j]?0:c[a[j]]);\n    cout<<flow().y+F*n<<'\\n';\n    return 0;\n}\n```\n\n---\n\n**\u795d\u5927\u5bb6\u5b66\u4e60\u6109\u5feb\uff01**",
        "postTime": 1605860141,
        "uid": 118365,
        "name": "George1123",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF802C \u3010Heidi and Library (hard)\u3011"
    },
    {
        "content": "~~\u548c [CF132E](https://www.luogu.com.cn/problem/CF132E) \u4e00\u8d77\u6c34\u7684\u9898\u4ee5\u53ca\u9898\u89e3\uff0c\u4f1a\u6709\u4e9b\u8bb8\u96f7\u540c\u3002~~\n\n\u4e0d\u540c\u4e8e\u5176\u5b83\u7684\u9898\u89e3\uff0c\u4f7f\u7528\u6700\u5c0f\u8d39\u7528\u6d41\uff0c$\\Theta(n^2)$ \u5efa\u8fb9\uff0c\u8fd9\u79cd\u601d\u8def\u8fd8\u662f~~\u559c\u63d0\u6700\u52a3\u89e3~~\u6bd4\u8f83\u597d\u60f3\u7684\u3002\n\n# $\\texttt{Description}$\n\n\u628a\u6bcf\u4e2a\u5bb9\u91cf\u60f3\u8c61\u6210\u683c\u5b50\uff0c\u4fbf\u662f\u8981\u7528\u4e0d\u8d85\u8fc7\u5bb9\u91cf\u653e\u8fc7\u6240\u6709\u7684\u4e66\u3002\u628a\u683c\u5b50\u62bd\u8c61\u6210\u8def\u5f84\uff0c\u4e66\u62bd\u8c61\u6210\u70b9\uff0c\u5c31\u662f\u4e0d\u591a\u4e8e $k$ \u6761\u4e0d\u76f8\u4ea4\uff08\u4e00\u672c\u4e66\u53ea\u80fd\u653e\u4e00\u4e2a\u683c\u5b50\uff0c\u663e\u7136\u4e0d\u76f8\u4ea4\uff09\u8def\u5f84\u8986\u76d6\u6240\u6709\u70b9\uff0c\u4f7f\u5f97\u8d39\u7528\u6700\u5c0f\u3002\n\n- \u5c06\u6bcf\u4e2a\u70b9 $v$ \u62c6\u6210 $v_1$ \u548c $v_2$\uff0c\u8868\u793a\u5230\u8fbe/\u51fa\u53d1\u8be5\u70b9\u3002\n\n- $S$ \u5411\u6bcf\u4e2a\u70b9 $v$ \u7684 $v_1$ \u8fde\u5bb9\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u4e3a $c_{a_v}$ \u7684\u8fb9\uff0c\u8868\u793a\u53ea\u6709\u4e00\u6761\u8def\u5f84\u53ef\u4ee5\uff08\u56e0\u4e3a\u662f\u4e0d\u76f8\u4ea4\uff0c\u4e0b\u540c\uff09\u4ece $v$ \u5f00\u59cb\uff0c\u4e14\u7ecf\u8fc7\u5b83\u9700\u8981 $c_{a_v}$ \u7684\u8d39\u7528\uff08\u5373\u521d\u59cb\u4e70\u4e0b\u7b2c $a_v$ \u672c\u4e66\u7684\u8d39\u7528\uff09\u3002\n\n- \u5bf9\u4e8e\u4efb\u610f\u4e24\u70b9 $u,v\\,(u\\ne v)$\uff0c\u5982\u679c $a_u\\ne a_v$\uff0c\u90a3\u4e48\u4ece $u_2$ \u5411 $v_1$ \u8fde\u5bb9\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u4e3a $c_{a_v}$ \u7684\u8fb9\uff0c\u8868\u793a\u6709\u53ea\u4e00\u6761\u8def\u5f84\u53ef\u4ee5\u4ece $u$ \u51fa\u53d1\u5230\u8fbe $v$\uff0c\u5e76\u4e14\u7ecf\u8fc7\u5b83\u9700\u8981 $c_{a_v}$ \u7684\u8d39\u7528\uff08\u5373\u5f53\u524d\u683c\u5b50\u539f\u672c\u653e\u7684\u662f $a_u$\uff0c\u6539\u6210\u653e $a_v$ \u9700\u8981\u4e70\u4e0b\u8fd9\u672c\u4e66\uff0c\u5e76\u4e22\u6389 $a_u$ \u518d\u5c06 $a_v$ \u653e\u4e0a\u53bb\uff0c\u56e0\u6b64\u8d39\u7528\u662f\u4e70 $a_v$ \u7684\u8d39\u7528 $c_{a_v}$\uff09\uff1b\u5426\u5219\u8fde\u5bb9\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u4e3a $0$ \u7684\u8fb9\uff08\u5f53\u524d\u683c\u5b50\u4e0a\u7684\u4e66\u5c31\u662f\u6211\u8981\u653e\u7684\u4e66\uff0c\u90a3\u4e48\u4e0d\u7528\u518d\u4e70\u5b83\uff0c $a_v$ \u8fd9\u672c\u4e66\u5c31\u5df2\u7ecf\u653e\u4e0a\u53bb\u4e86\uff09\u3002\n\n- \u6bcf\u4e2a\u70b9 $v$ \u7684 $v_2$ \u5411 $T$ \u8fde\u5bb9\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u4e3a $0$ \u7684\u8fb9\uff0c\u8868\u793a\u53ea\u6709\u4e00\u6761\u8def\u5f84\u5728 $v$ \u5904\u7ed3\u675f\u3002\n\n- \u6bcf\u4e2a\u70b9 $v$ \u7684 $v_1$ \u548c $v_2$ \u4e4b\u95f4\u8fde\u5bb9\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u4e3a $-\\inf$ \u7684\u8fb9\u3002\u5bb9\u91cf\u4e3a $1$ \u5f88\u597d\u7406\u89e3\uff0c\u6bcf\u4e2a\u70b9\u53ea\u80fd\u7ecf\u8fc7\u4e00\u6b21\u3002\u90a3\u8d39\u7528\u4e3a\u4ec0\u4e48\u8981\u8fd9\u6837\u8bbe\u7f6e\u5462\uff1f\u56e0\u4e3a\u9898\u76ee\u8981\u6c42\u662f\u6bcf\u672c\u4e66\u90fd\u653e\u8fc7\uff0c\u6240\u4ee5\u6bcf\u4e2a\u70b9\u5747\u9700\u7ecf\u8fc7\u4e00\u6b21\uff0c\u7136\u800c\u7ecf\u8fc7\u4e00\u4e2a\u70b9\u5c31\u662f\u8d70\u4e86 $v_1\\rightarrow v_2$ \u8fd9\u6761\u8fb9\u3002\u6240\u4ee5\u6211\u4eec\u5c06\u8fd9\u6761\u8fb9\u7684\u8d39\u7528\u8bbe\u7f6e\u6210\u8d4b\u65e0\u7a77\uff0c\u4fdd\u8bc1 $S$ \u5230 $T$ \u7684\u6700\u77ed\u8def\u5f84\u80af\u5b9a\u7ecf\u8fc7\u8fd9\u6761\u8fb9\u4f7f\u5176\u88ab\u589e\u5e7f\uff0c\u7136\u800c\u5176\u53cd\u5411\u8fb9\u7684\u8d39\u7528\u5c31\u662f\u6b63\u65e0\u7a77\uff0c\u56e0\u6b64\u80af\u5b9a\u4e0d\u5728\u6700\u77ed\u8def\u4e0a\uff0c\u4e0d\u4f1a\u88ab\u589e\u5e7f\uff0c\u5373\u4e0d\u4f1a\u88ab\u8fd4\u6094\u6389\uff0c\u8fdb\u800c\u6ee1\u8db3\u6bcf\u4e2a\u70b9\u7ecf\u8fc7\u540e\u4e0d\u4f1a\u8fd4\u56de\u7ecf\u8fc7\u5b83\u7684\u8fd9\u4e2a\u64cd\u4f5c\uff0c\u8fdb\u800c\u6ee1\u8db3\u6bcf\u4e2a\u70b9\u90fd\u88ab\u7ecf\u8fc7\u4e00\u6b21\u3002\n\n\u56e0\u4e3a\u6709 $k$ \u4e2a\u683c\u5b50\uff0c\u5373 $k$ \u6761\u8def\u5f84\uff0c\u6240\u4ee5\u6700\u591a\u589e\u5e7f $k$ \u6b21\u3002\u5982\u679c\u53d1\u73b0\u67d0\u6b21\u589e\u5e7f\u6700\u77ed\u8def\u7684\u8d39\u7528\u5927\u4e8e\u7b49\u4e8e $0$ \u4e86\uff0c\u5c31\u8df3\u51fa\u3002\u56e0\u4e3a\u6700\u5c0f\u8d39\u7528\u6d41\u662f\u53ef\u4ee5\u4fdd\u8bc1 $n$ \u4e2a\u70b9\u90fd\u88ab\u7ecf\u8fc7\u7684\uff08\u4e0a\u9762\u8bf4\u4e86\uff09\uff0c\u7136\u800c\u5e0c\u671b\u5728\u6b64\u57fa\u7840\u4e0a\u8d39\u7528\u5c3d\u91cf\u5c0f\uff0c\u5982\u679c\u8d39\u7528\u5c0f\u4e8e $0$\uff0c\u8bf4\u660e\u6211\u5728\u4f7f\u7b54\u6848\u8d8a\u6765\u8d8a\u5c0f\uff0c\u5e76\u6700\u7ec8\u5f97\u5230\u6700\u5c0f\u8d39\u7528\uff1b\u53cd\u4e4b\uff0c\u82e5\u8d39\u7528\u5927\u4e8e\u7b49\u4e8e $0$\uff0c\u8bf4\u660e\u8d39\u7528\u589e\u52a0\u4e86\uff0c\u4e0e\u76ee\u7684\u76f8\u53cd\uff08\u7b49\u4e8e $0$ \u76f8\u5f53\u4e8e\u6ca1\u52a0\uff0c\u90a3\u4e0d\u8003\u8651\u4e5f\u662f\u53ef\u4ee5\u7684\uff09\u3002\u6b64\u540e\uff0c\u8d39\u7528\u53ea\u4f1a\u8d8a\u6765\u8d8a\u5927\uff0c\u90a3\u4e48\u80af\u5b9a\u90fd\u662f\u4e0d\u9700\u8981\u4e86\u7684\u3002 \n\n\u6700\u7ec8\u7684\u6700\u5c0f\u4ee3\u4ef7\u5c31\u662f $\\text{mincost}+n\\times \\inf$\uff0c\u4e3a\u4ec0\u4e48\u8981\u52a0\u4e0a\u540e\u9762\u90a3\u4e00\u9879\u5462\uff1f\u56e0\u4e3a\u672c\u6765\u7ecf\u8fc7\u6bcf\u4e2a\u70b9\u5e94\u8be5\u4e0d\u4ed8\u8d39\u7528\uff0c\u7136\u800c\u6211\u5374\u4e3a\u4e86\u9650\u6d41\u4ed8\u4e86 $-\\inf$ \u7684\u8d39\u7528\uff0c\u76f8\u5f53\u4e8e\u5c11\u4ed8\u4e86 $\\inf$ \u7684\u8d39\u7528\uff0c\u5bf9\u4e8e $n$ \u4e2a\u70b9\uff0c\u6bcf\u4e2a\u70b9\u90fd\u5c11\u4ed8\u4e86\uff0c\u90a3\u4e48\u8981\u5c06 $n$ \u4e2a\u70b9\u5c11\u4ed8\u7684\u8d39\u7528\u90fd\u8fd8\u56de\u6765\u3002\n\n# $\\texttt{Solution}$\n\n~~\u6307\u4ee4\u96c6\u548c `SLF + LLL SPFA` \u53ef\u4ee5\u5feb\u4e0d\u5c11\u3002~~\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long//\u6d89\u53cainf\uff0c\u9632\u7956\u5b97\nconst int N = 1e5, inf = 1e10;\nint n, k, a[N], c[N], d[N], h, t, q[N], T, cnt = 1, hd[N], la[N], ans;\nbool iq[N];\nstruct edge {\n    int v, w, c, nxt;\n}e[N];\ninline void add(int u, int v, int w, int c) {\n    e[++cnt] = edge{v, w, c, hd[u]};\n    hd[u] = cnt;\n}\ninline void bfs() {\n    for (int i = 0; i <= T; ++i) {\n        d[i] = inf;\n        iq[i] = 0;\n    }\n    d[q[h = t = 1] = 0] = 0;\n    while (h <= t) {\n        int x = q[h++];\n        iq[x] = 0;\n        for (int i = hd[x]; i; i = e[i].nxt) {\n            if (e[i].w && d[x] + e[i].c < d[e[i].v]) {\n                d[e[la[e[i].v] = i].v] = d[x] + e[i].c;\n                if (!iq[e[i].v]) {\n                    iq[q[++t] = e[i].v] = 1;\n                }\n            }\n        }\n    }\n}\nsigned main() {\n    scanf(\"%lld%lld\", &n, &k);\n    T = (n << 1) + 1;\n    for (int i = 1; i <= n; ++i) {\n        scanf(\"%lld\", &a[i]);\n    }\n    for (int i = 1; i <= n; ++i) {\n        scanf(\"%lld\", &c[i]);\n    }\n    for (int i = 1; i <= n; ++i) {\n        add(0, i, 1, c[a[i]]);\n        add(i, 0, 0, -c[a[i]]);\n        add(i, i + n, 1, -inf);\n        add(i + n, i, 0, inf);\n        add(i + n, T, 1, 0);\n        add(T, i + n, 0, 0);\n        for (int j = i + 1; j <= n; ++j) {\n            if (a[i] == a[j]) {\n                add(i + n, j, 1, 0);\n                add(j, i + n, 0, 0);\n            } else {\n                add(i + n, j, 1, c[a[j]]);\n                add(j, i + n, 0, -c[a[j]]);\n            }\n        }\n    }\n    for (int i = 1; i <= k; ++i) {\n        bfs();\n        if (d[T] >= 0) {\n            break;\n        }\n        ans += d[T];\n        for (int j = T; j; j = e[la[j] ^ 1].v) {\n            --e[la[j]].w;\n            ++e[la[j] ^ 1].w;\n        }\n    }\n    printf(\"%lld\\n\", ans + n * inf);\n}\n```\n\n\n\u5b8c\u7ed3\u6492\u82b1\uff01\n",
        "postTime": 1663422965,
        "uid": 539211,
        "name": "\u849f\u84bb\u00b7\u5ed6\u5b50\u9633",
        "ccfLevel": 5,
        "title": "CF802C"
    },
    {
        "content": "## \u9898\u89e3\n\n\u8fd9\u662f\u4e00\u4e2a\u53ea\u9700\u8981 $n+2$ \u4e2a\u70b9\u7684\u7b80\u5355\u505a\u6cd5\n\n### \u5982\u4f55\u60f3\u5230\n\n\u9996\u5148\uff0c\u5bb9\u6613\u60f3\u5230\u7684\u662f\uff1a\u5982\u679c\u4e0d\u80fd\u5356\u51fa\u518d\u4e70\u5165\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u989c\u8272 $x$\uff0c\u6211\u4eec\u5728\u7b2c\u4e00\u6b21\u51fa\u73b0\u4e70\u5165\uff0c\u6700\u540e\u4e00\u6b21\u5356\u51fa\u3002![image-20220217102809162](https://blogpicp.oss-cn-guangzhou.aliyuncs.com/ltdblogimg/image-20220217102809162.png)\n\n\u4e0a\u56fe\uff0c\u6570\u8f74\u4e0a\u6bcf\u4e2a\u70b9\u8868\u793a\u4e00\u5929\uff0c\u6bcf\u5929\u7684\u4e66\u90fd\u53ef\u4ee5\u76f4\u63a5\u6d41\u5411\u4e0b\u4e00\u5929\uff0c\u5bb9\u91cf\u4e3a $k$\uff0c\u8d39\u7528\u4e3a $0$\uff0c\u8868\u793a\u653e\u5728\u4e66\u67b6\u3002\n\n\u95ee\u9898\u662f\uff0c\u5982\u4f55\u8003\u8651\u5356\u51fa\u540e\u518d\u4e70\u5165\u7684\u64cd\u4f5c\u5462\uff1f\n\n\u4ed4\u7ec6\u60f3\uff0c\u5bf9\u4e8e\u76f8\u90bb\u4e24\u4e2a $x$ \u4e4b\u95f4\u7684\u4e00\u6bb5(\u5982\u4e0a\u56fe\u7ea2\u8272\u90e8\u5206),\u8fd9\u672c\u4e66\u8981\u4e48\u4e00\u76f4\u5728\u4e66\u67b6\uff0c\u8981\u4e48\u4e00\u76f4\u4e0d\u5728\uff08\u5982\u679c\u524d\u90e8\u5206\u5728\u540e\u534a\u90e8\u5206\u4e0d\u5728\u8fd8\u4e0d\u5982\u76f4\u63a5\u5728\u4e0a\u4e00\u4e2a $x$  \u90a3\u91cc\u5356\u6389\uff09\u3002\u5982\u679c\u4e0d\u5728\u4e66\u67b6\u7684\u8bdd\uff0c\u5c31\u4e0d\u4f1a\u5360\u7528\u4e66\u67b6\u7684\u5bb9\u91cf\uff0c\u4f46\u662f\u5728\u4e0b\u4e00\u4e2a $x$ \u5c31\u4e00\u5b9a\u8981\u91cd\u65b0\u4e70\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u7528\u4e00\u6761\u989d\u5916\u7684\u8fb9\u8fde\u63a5\u76f8\u90bb\u7684\u4e24\u4e2a $x$,\u8d39\u7528\u4e3a $c_x$,\u5bb9\u91cf\u4e3a $1$\u3002 \n\n### \u4e3a\u4ec0\u4e48\u662f\u5bf9\u7684\n\n\u8fd9\u6837\u505a\u662f\u5bf9\u7684\u5417\uff1f\u6211\u4eec\u53d1\u73b0\uff1a\u5982\u679c\u8fd9\u6837\u505a\u4e0d\u662f\u9519\u7684\u8bdd\u90a3\u5b83\u4e00\u5b9a\u662f\u5bf9\u7684\uff08\u3002\u6211\u4eec\u8003\u8651\u5230\u9519\u7684\u60c5\u51b5\u6709\u4e24\u79cd\uff1a\u4e00\u4e2a\u6d41\u6d41\u8fc7\u4e86\u5b83\u4e0d\u8be5\u6d41\u7684\u8fb9\u6216\u8005\u4e0d\u8be5\u6d41\u5165\u7684\u6c47\u70b9\u3002\n\n1.\u6211\u4eec\u79f0\u76f8\u90bb\u4e24\u4e2a $x$ \u4e4b\u95f4\u7684\u8fb9\u4e3a\u8d2d\u4e70\u8fb9\uff0c\u7406\u60f3\u72b6\u6001\u4e0b $x$ \u53ea\u4f1a\u8d70 $x$ \u7684\u8d2d\u4e70\u8fb9\uff0c\u4f46\u5b9e\u9645\u4e0a\u5b83\u53ef\u80fd\u8d70\u5230 $y$ \u7684\u8d2d\u4e70\u8fb9\uff0c\u7531\u4e8e\u8d2d\u4e70\u8fb9\u6d41\u91cf\u4e3a1\uff0c\u6b64\u65f6 $y$ \u4e00\u5b9a\u8d70\u7684\u662f\u4e66\u67b6\u8fb9\uff0c\u90a3\u8fd9\u79cd\u60c5\u51b5\u7b49\u4ef7\u4e8e $y$ \u8d70\u8d2d\u4e70\u8fb9\u800c $x$ \u8d70\u4e66\u67b6\u8fb9\u3002\u6240\u4ee5\uff0c**\u4e00\u6761\u6d41\u53ea\u8981\u4ece $x$ \u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u70b9\u6d41\u5165\u6700\u540e\u51fa\u73b0\u7684\u70b9\uff0c\u90a3\u4e48\u4e2d\u9014\u65e0\u8bba\u7ecf\u8fc7\u4ec0\u4e48\u8fb9\u90fd\u662f\u5408\u6cd5\u7684**\n\n2.\u5047\u5982 $x$ \u6d41\u5165\u4e86 $y$ \u7684\u6c47\u70b9\u5462\uff1f\u4e8b\u5b9e\u4e0a\u7531\u4e8e\u7b2c\u4e00\u70b9\uff0c\u4e0b\u9762\u4e24\u79cd\u60c5\u51b5\u53ef\u4ee5\u770b\u6210\u7b49\u4ef7\u7684\n\n![image-20220217112218812](https://blogpicp.oss-cn-guangzhou.aliyuncs.com/ltdblogimg/image-20220217112218812.png)![image-20220217112332544](https://blogpicp.oss-cn-guangzhou.aliyuncs.com/ltdblogimg/image-20220217112332544.png)\n\n\u800c\u4e14\u5b83\u60c5\u51b5\u5b9e\u9645\u4e0a\u90fd\u53ef\u4ee5\u8f6c\u5316\u6210\u4e0a\u8ff0\u60c5\u51b5\u7684\u3002\n\n\n\n## \u5b9e\u73b0\n\n\u6709\u4e00\u4e2a\u5c0f\u7ec6\u8282\uff0c\u5982\u679c\u4f60\u5b8c\u5168\u6309\u7167\u4e0a\u8ff0\u5efa\u56fe\uff0c\u4f1a\u6709\u4e00\u4e2a\u95ee\u9898: \u5982\u679c\u4e00\u4e2a\u70b9\u521a\u4e70\u5c31\u5356\u4e86\uff0c\u4ed6\u662f\u4e0d\u4f1a\u8d70\u4e66\u67b6\u8fb9\u7684\uff0c\u4f46\u5b9e\u9645\u4e0a\u5b83\u5f53\u5929\u9700\u8981\u5360\u7528\u4e00\u4e2a\u4e66\u67b6\u4f4d\u7f6e\u3002\u90a3\u6211\u4eec\u6362\u4e00\u79cd\u601d\u8def\uff0c\u6211\u4eec\u8ba4\u4e3a\u8fd9\u672c\u4e66\u662f\u524d\u4e00\u5929\u4e0b\u73ed\u7684\u65f6\u5019\u4e70\u7684\uff0c\u628a\u5165\u8fb9\u8fde\u5230\u4e0a\u4e00\u5929\u5373\u53ef\u3002\n\n```cpp\nint main()\n{\n\tmemset(head,-1,sizeof(head)); num_edge=-1;\n    N=read(), K=read();\n    for(int i=1; i<=N; i++) A[i]=read();\n    for(int i=1; i<=N; i++) C[i]=read();\n    s=N+1, t=N+2;\n\n    for(int i=1; i<N; i++) addEdge(i, i+1, K, 0);\n    for(int i=1; i<=N; i++){\n        if(!VIS[A[i]]) {\n            if(i == 1) addEdge(N+1, i, 1, C[A[i]]);\n            else addEdge(N+1, i-1, 1, C[A[i]]);\n        }else{\n            addEdge(VIS[A[i]], i-1, 1, C[A[i]]);\n        }\n        VIS[A[i]] = i;\n    }\n    for(int i=1; i<=N; i++) if(VIS[i]) addEdge(VIS[i], N+2, 1, 0);\n\tMCMF();\n\tprintf(\"%d\\n\", mincost);\n\treturn 0;\n}\n```",
        "postTime": 1645068536,
        "uid": 159375,
        "name": "ltdj",
        "ccfLevel": 7,
        "title": "CF802C"
    },
    {
        "content": "# \u6b63\u9898\n\u9898\u76ee\u94fe\u63a5:[https://www.luogu.com.cn/problem/CF802C](https://www.luogu.com.cn/problem/CF802C)\n\n\n\u83b7\u53d6\u66f4\u597d\u4f53\u9a8c:[https://www.cnblogs.com/QuantAsk/p/15879351.html](https://www.cnblogs.com/QuantAsk/p/15879351.html)\n\n-------\n\n## \u9898\u76ee\u5927\u610f\n\u4f60\u6709\u4e00\u4e2a\u53ef\u4ee5\u653e $k$ \u672c\u4e66\u7684\u4e66\u67b6\uff0c\u7b2c $i$ \u5929\u8981\u6c42\u4e66\u67b6\u4e0a\u6709\u7b2c $a_i$ \u79cd\u4e66\uff0c\u8d2d\u4e70\u7b2c $i$ \u79cd\u4e66\u7684\u4ef7\u683c\u4e3a $c_i$ \u3002\n\n\u6c42\u6ee1\u8db3 $n$ \u5929\u8981\u6c42\u7684\u6700\u5c0f\u82b1\u8d39\u3002\n\n$1\\leq n,k\\leq 80,1\\leq c_i\\leq 10^6$\n\n------\n\n## \u89e3\u9898\u601d\u8def\n\u6211\u4eec\u6ce8\u610f\u5230\u6bcf\u4e00\u5929\u7684\u9650\u5236\u662f\u4e0d\u80fd\u8d85\u8fc7 $k$ \u672c\u4e66\u5ef6\u7eed\u5230\u4e0b\u4e00\u5929\u3002\u800c\u4e66\u7684\u4fdd\u7559\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u89c6\u4e3a\u5c06\u4e00\u672c\u4e66\u4ece\u8fd9\u4e00\u5929\u5ef6\u7eed\u5230\u4e0b\u4e00\u6b21\u9700\u8981\u8fd9\u672c\u4e66\u7684\u65f6\u5019\u514d\u8d39\u62ff\u4e00\u672c\u65b0\u7684\u3002\n\n\u597d\u90a3\u4e48\u73b0\u5728\u76f8\u5f53\u4e8e\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u9738\u5360\u4e00\u4e9b\u533a\u95f4\u6765\u51cf\u5c11\u82b1\u8d39\uff0c\u4f46\u662f\u4e00\u4e2a\u683c\u5b50\u6700\u591a\u88ab\u533a\u95f4\u5305\u542b $k$ \u6b21\u3002\n\n\u8fd9\u548c[[NOI2008] \u5fd7\u613f\u8005\u62db\u52df](https://www.luogu.com.cn/problem/P3980)\u5f88\u50cf\uff0c\u8003\u8651\u4f7f\u7528\u8d39\u7528\u6d41\u6765\u505a\u672c\u9898\u3002\n\n\u9996\u5148\u6211\u4eec\u8981\u56fa\u5b9a\u603b\u6d41\u91cf\u4e3a $n$ \uff0c\u7136\u540e\u8003\u8651\u600e\u4e48\u5efa\u56fe\u3002\u8fd9\u91cc\u5c06\u4e00\u4e2a\u70b9\u62c6\u4e3a\u4e09\u90e8\u5206\u8bb0\u4e3a $p(x,1/2/3)$ \n1. \u83b7\u53d6\u70b9\uff0c\u7528\u6765\u6d41\u8fc7\u4eca\u5929\u9700\u8981\u7684\u4e66\u3002\n2. \u50a8\u5b58\u70b9\uff0c\u8868\u793a\u6d41\u8fc7\u7684\u8fd9\u672c\u4e66\u5df2\u7ecf\u4f7f\u7528\u5b8c\u4e86\u3002\n3. \u5546\u5e97\u70b9\uff0c\u6d41\u8fc7\u591a\u4f59\u7684\u6d41\u91cf\uff0c\u8d2d\u4e70\u4e66\u65f6\u4ece\u8fd9\u4e2a\u70b9\u6d41\u8fc7\u3002\n\n\u7136\u540e\u8981\u5b9e\u73b0\u4ee5\u4e0b\u529f\u80fd\n- \u8981\u6c42\u6ee1\u8db3\u6bcf\u5929\u7684\u6761\u4ef6\uff1a\u6211\u4eec\u8ba9 $p(x,1)\\rightarrow p(x,2)$ \uff0c\u6d41\u91cf\u4e3a $1$ \uff0c\u8d39\u7528\u4e3a $-\\infty$ ,\u8868\u793a\u6bcf\u5929\u7684\u6761\u4ef6\u5fc5\u987b\u6ee1\u8db3\u3002\n- \u5ef6\u7eed\u8fd9\u672c\u4e66\u5230\u4e0b\u4e00\u4e2a\u540c\u6837\u9700\u6c42\u7684\u70b9$y$\uff1a$p(x,2)\\rightarrow p(y,1)$\uff0c\u6d41\u91cf\u4e3a $1$ \uff0c\u8d39\u7528\u4e3a $0$ \uff0c\u8868\u793a\u8fd9\u672c\u4e66\u7528\u5b8c\u4e4b\u540e\u53ef\u4ee5\u7559\u7ed9\u540e\u9762\u7684\u7528\u3002\n- \u8d2d\u4e70\u4e00\u672c\u4e66\uff1a $p(x,3)\\rightarrow p(x,1)$ \uff0c\u6d41\u91cf\u4e3a $1$ \uff0c\u8d39\u7528\u4e3a $c_{a_x}$ \u3002\n- \u4e22\u5f03\u4e00\u672c\u4e66\uff1a $p(x,2)\\rightarrow p(x+1,3)$ \uff0c\u6d41\u91cf\u4e3a $1$ \uff0c\u8d39\u7528\u4e3a $0$ \u3002\u56e0\u4e3a\u8fd9\u672c\u4e66\u4eca\u5929\u5df2\u7ecf\u501f\u51fa\u4e86\u6240\u4ee5\u9700\u8981\u5360\u7528\u7a7a\u95f4\uff0c\u660e\u5929\u624d\u80fd\u4e22\u6389\u3002\n- \u9650\u5236\u5b58\u6709\u4e66\u7684\u6570\u91cf\u4e0d\u8d85\u8fc7 $k$ \uff1a\u8003\u8651\u5230\u6211\u4eec\u76f8\u5f53\u4e8e\u603b\u5171\u6709 $n$ \u70b9\u6d41\u91cf\uff0c\u5728 $1/2$ \u7c7b\u70b9\u4e4b\u95f4\u7684\u6d41\u91cf\u90fd\u76f8\u5f53\u4e8e\u76ee\u524d\u5b58\u5728\u4e66\u67dc\u91cc\u7684\uff0c\u6240\u4ee5\u5546\u5e97\u7684\u4e66\u81f3\u5c11\u9700\u8981\u4e3a $n-k$ \u672c\u3002\u90a3\u4e48\u6211\u4eec\u8ba9 $p(x,3)\\rightarrow p(x+1,3)$ \u6d41\u91cf\u4e3a $n-k$ \uff0c\u8d39\u7528\u4e3a $-\\infty$ \uff0c\u8fd9\u6837\u8fd9\u4e9b\u6d41\u91cf\u5c31\u5fc5\u987b\u6d41\u8fc7\u4e86\uff0c\u7136\u540e\u518d\u5efa\u7acb\u4e00\u6761 $p(x,3)\\rightarrow p(x+1,3)$ \u6d41\u91cf\u4e3a $\\infty$ \uff0c\u8d39\u7528\u4e3a $0$ \u7684\u7ed9\u591a\u4f59\u7684\u6d41\u8fc7\u5c31\u597d\u4e86\u3002\n\n\u8d39\u7528\u4e3a $-\\infty$ \u7684\u6211\u4eec\u8bbe\u4e3a\u4e00\u4e2a\u5f88\u5927\u7684\u503c\uff0c\u6700\u540e\u5c06\u7b54\u6848\u628a\u8fd9\u4e9b\u503c\u52a0\u56de\u53bb\u5c31\u597d\u4e86\u3002\n\n\u5c31\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u4e86\n\n------\n\n## code\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<queue>\n#define ll long long\nusing namespace std;\nconst ll N=1e4+10,inf=1e9;\nstruct node{\n\tll to,next,w,c;\n}a[N<<1];\nll n,k,tot,ans,op[N],c[N],las[N];\nll s,t,ls[N],f[N],pre[N],mf[N];\nbool v[N];queue<ll> q;\nvoid addl(ll x,ll y,ll w,ll c){\n\ta[++tot].to=y;a[tot].next=ls[x];ls[x]=tot;a[tot].w=w;a[tot].c=c;\n\ta[++tot].to=x;a[tot].next=ls[y];ls[y]=tot;a[tot].w=0;a[tot].c=-c;\n\treturn;\n}\nbool SPFA(){\n\tmemset(f,0x3f,sizeof(f));pre[t]=0;\n\tf[s]=0;q.push(s);v[s]=1;mf[s]=inf;\n\twhile(!q.empty()){\n\t\tll x=q.front();q.pop();v[x]=0;\n\t\tfor(ll i=ls[x];i;i=a[i].next){\n\t\t\tll y=a[i].to;\n\t\t\tif(a[i].w&&f[x]+a[i].c<f[y]){\n\t\t\t\tf[y]=f[x]+a[i].c;pre[y]=i;\n\t\t\t\tmf[y]=min(mf[x],a[i].w);\n\t\t\t\tif(!v[y])v[y]=1,q.push(y);\n\t\t\t}\n\t\t}\n\t}\n\treturn pre[t];\n}\nll update(){\n\tll x=t;\n\twhile(x!=s){\n\t\ta[pre[x]].w-=mf[t];\n\t\ta[pre[x]^1].w+=mf[t];\n\t\tx=a[pre[x]^1].to;\n\t}\n\treturn mf[t]*f[t];\n}\nsigned main()\n{\n\tscanf(\"%lld%lld\",&n,&k);tot=1;\n\tfor(ll i=1;i<=n;i++)scanf(\"%lld\",&op[i]);\n\tfor(ll i=1;i<=n;i++)scanf(\"%lld\",&c[i]);\n\tll w=0;s=3*n+2;t=s+1;\n\taddl(s,2*n+1,n,0);\n\tfor(ll i=1;i<=n;i++){\n\t\tif(las[op[i]])\n\t\t\taddl(las[op[i]]+n,i,1,0);\n\t\telse w=min(w+1,k);\n\t\taddl(i+2*n,i,1,c[op[i]]);\n\t\taddl(i,i+n,1,-inf);ans+=inf;\n\t\taddl(i+n,i+2*n+1,1,0);\n\t\tlas[op[i]]=i;\n\t\tif(n>w){\n\t\t\taddl(i+2*n,i+2*n+1,n-w,-inf);\n\t\t\tans+=(n-w)*inf;\n\t\t}\n\t\taddl(i+2*n,i+2*n+1,inf,0);\n\t}\n\taddl(3*n+1,t,n,0);\n\tint k=0;\n\twhile(SPFA())ans+=update();\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1644478690,
        "uid": 52918,
        "name": "QuantAsk",
        "ccfLevel": 9,
        "title": "CF802C-Heidi and Library(hard)\u3010\u8d39\u7528\u6d41\u3011"
    },
    {
        "content": "\u4e00\u9053\u4e09\u500d\u7ecf\u9a8c\u7684\u9898\u76ee\u3002\n\n[\u4e00\u500d](https://www.luogu.com.cn/problem/CF802A)\uff0c[\u4e8c\u500d](https://www.luogu.com.cn/problem/CF802C)\uff0c[\u4e09\u500d](https://www.luogu.com.cn/problem/CF132E)\u3002\n\n\u81f3\u4e8e[\u8fd9\u4e2a](https://www.luogu.com.cn/problem/CF802B)\u957f\u5f97\u5f88\u76f8\u4f3c\uff0c\u4f46\u7f51\u7edc\u6d41\u590d\u6742\u5ea6\u8fc7\u4e0d\u53bb\u3002\n\n#### \u601d\u8def\n\n\u8003\u8651~~\u70c2\u5927\u8857\u7684~~\u8d39\u7528\u6d41\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u5f88\u96be\u5355\u72ec\u51b3\u5b9a\u6bcf\u5929\u4e70\u4e0d\u4e70\uff0c\u6240\u4ee5\u53ef\u4ee5\u5148\u628a\u6240\u6709\u4e1c\u897f\u90fd\u4e70\u8fdb\u6765\uff0c\u518d\u5356\u6389\u4e0d\u5fc5\u8981\u7684\uff0c\u62b5\u6d88\u82b1\u8d39\u3002\n\n\u9996\u5148\u8fdb\u884c\u62c6\u70b9 $i$ \u4e0e $i'$ \u4e4b\u95f4\u8fde\u4e00\u6761\u8d39\u7528\u4e3a $0$ \uff0c\u6d41\u91cf\u4e3a $1$ \u7684\u8fb9\u3002\n\n\u4ece\u539f\u70b9 $s$ \uff0c\u8fde\u4e00\u6761\u8d39\u7528\u4e3a $c_{a_{i}}$ \uff0c\u6d41\u91cf\u4e3a $1$ \u7684\u8fb9\u3002\n\n\u518d\u4ece\u6bcf\u4e2a $i+1$ \u5411 $i$ \u8fde\u4e00\u6761\u6d41\u91cf\u4e3a $k - 1$ \uff0c\u8d39\u7528\u4e3a $0$ \u7684\u8fb9\u3002\n\n\u4ece $i-1$ \u5411 $a_i$ \u4e0a\u4e00\u6b21\u7684\u51fa\u73b0\u4f4d\u7f6e $j$ \u5bf9\u5e94\u7684      $j'$ \u8fde\u4e00\u6761\u6d41\u91cf $1$ \uff0c\u8d39\u7528\u4e3a $-c_{i}$ \u7684\u8fb9\u3002\n\n\u6700\u540e\u4ece\u6bcf\u4e2a $i'$ \u5411\u6c47\u70b9 $t$ \u8fde\u4e00\u6761\u6d41\u91cf\u4e3a $1$ \uff0c\u8d39\u7528\u4e3a $0$ \u7684\u8fb9\u3002\n\n\u4ee3\u7801\u5b9e\u73b0\u76f4\u63a5\u5957\u8d39\u7528\u6d41\u677f\u5b50\u5c31\u53ef\u4ee5\u4e86\u3002\n\n#### Code\n\n```\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int inf = 0x3f3f3f3f;\nint n , k , tot , s , t , maxf , ans , head[5010] , d[5010] , in[5010] , pre[5010] , v[5010] , a[100] , c[100] , re[100];\nstruct E\n{\n\tint to , nex , fei, liu;\n}e[150100];\n\nint read()\n{\n\tlong long X = 0 , w = 1;\n\tchar c = getchar();\n\twhile (c < '0' || c > '9')\n\t{\n\t\tif (c == '-')\n\t\tw = -1;\n\t\tc = getchar();\n\t}\n\twhile (c >= '0' && c <= '9')\n\t\tX = X * 10 + c - '0' , c = getchar();\n\treturn X * w;\n}\n\nvoid add(int x , int y , int z , int u)\n{\n\te[++tot].to = y , e[tot].liu = z , e[tot].fei = u , e[tot].nex = head[x] , head[x] = tot;\n\te[++tot].to = x , e[tot].liu = 0 , e[tot].fei = -u , e[tot].nex = head[y] , head[y] = tot;\n}\n\nbool spfa()\n{\n\tqueue<int> q;\n\tmemset(d , inf , sizeof(d));\n\tmemset(v , 0 , sizeof(v));\n\tq.push(s); d[s] = 0; v[s] = 1;\n\tin[s] = 1 << 30;\n\twhile(!q.empty()) \n\t{\n\t\tint x = q.front(); v[x] = 0; q.pop();\n\t\tfor(int i = head[x];i;i = e[i].nex)\n\t\t{\n\t\t\tif(!e[i].liu) continue;\n\t\t\tint y = e[i].to;\n\t\t\tif(d[y] > d[x] + e[i].fei)\n\t\t\t{\n\t\t\t\td[y] = d[x] + e[i].fei;\n\t\t\t\tin[y] = min(in[x] , e[i].liu);\n\t\t\t\tpre[y] = i;\n\t\t\t\tif(!v[y]) v[y] = 1 , q.push(y);\t\n\t\t\t} \n\t\t}\n\t}\n\tif(d[t] == 4557430888798830399) return 0;\n\treturn 1;\n}\n\nvoid update()\n{\n\twhile(spfa())\n\t{\n\t\tint x = t;\n\t\tmaxf += in[t];\n\t\tans += d[t] * in[t];\n\t\tint i;\n\t\twhile(x != s)\n\t\t{\n\t\t\ti = pre[x];\n\t\t\te[i].liu -= in[t];\n\t\t\te[i ^ 1].liu += in[t];\n\t\t\tx = e[i ^ 1].to;\n\t\t} \n\t}\n}\n\nsigned main()\n{\n\tn = read() , k = read() , s = 0 , t = 2 * n + 1;\n\ttot = 1;\n\tfor(int i = 1;i <= n;++i) add(i , i + n , 1 , 0) , add(i + n , t , 1 , 0) , a[i] = read();\n\tfor(int i = 1;i <= n;++i) c[i] = read();\n\tfor(int i = 1;i <= n;++i)\n\t{\n\t\tadd(s , i , 1 , c[a[i]]);\n\t\tif(re[a[i]]) add(i - 1 , re[a[i]] + n , 1 , -c[a[i]]);\n\t\tre[a[i]] = i;\n\t}\n\tfor(int i = 1;i < n;++i) add(i , i + 1 , k - 1 , 0);\n\tupdate();\n\tcout << ans;\n\treturn 0;\n}\n```\n",
        "postTime": 1632655947,
        "uid": 320933,
        "name": "Mfeitveer",
        "ccfLevel": 0,
        "title": "CF802C Heidi and Library (hard) \u9898\u89e3"
    },
    {
        "content": "[\u9898\u76ee\u94fe\u63a5](https://www.luogu.org/problemnew/show/CF802C)\n\n\u611f\u89c9\u8ddf\u9910\u5dfe\u8ba1\u5212\u95ee\u9898\u6709\u70b9\u50cf\u3002\u8d39\u7528\u6d41\u3002\n\n\u51b3\u5b9a\u6bcf\u5929\u4e70\u4e0d\u4e70\u4e0d\u592a\u597d\u641e\uff0c\u4e0d\u5982\u5148\u628a\u6240\u6709\u4e1c\u897f\u90fd\u4e70\u8fdb\u6765\uff0c\u518d\u5356\u6389\u4e0d\u5fc5\u8981\u7684\u3002\n\n\u62c6\u70b9\uff0c\u6bcf\u4e2a\u70b9\u62c6\u6210$x,y$\u3002\n\n\u6e90\u70b9\u5411\u6bcf\u4e2a\u70b9\u7684$x$\u8fde\u8d39\u7528\u4e3a\u5f53\u5929\u7684\u4ef7\u683c\uff0c\u6d41\u91cf\u4e3a1\u7684\u8fb9\u3002\n\n\u6bcf\u4e2a\u70b9\u7684$y$\u5411\u6c47\u70b9\u8fde\u8d39\u7528\u4e3a0\uff0c\u6d41\u91cf\u4e3a1\u7684\u8fb9\u3002\n\n\u6bcf\u4e2a\u70b9$x$\u5411$y$\u8fde\u6d41\u91cf\u4e3a1\uff0c\u8d39\u7528\u4e3a0\u7684\u8fb9\u3002\n\n\u6b64\u65f6\u6d41\u51fa\u7684\u5df2\u7ecf\u7b49\u4e8e\u6d41\u5165\u7684\u4e86\uff0c\u4e5f\u5c31\u662f\u8bf4\u6700\u5927\u6d41\u4e00\u5b9a\u4e3a$n$\u3002\n\n\u73b0\u5728\u8003\u8651\u52a0\u5165\u8d39\u7528\u9650\u5236\u3002\n\n\u6bcf\u5929\u7684$x$\u5411\u4e0b\u4e00\u5929\u7684$x$\u8fde\u6d41\u91cf\u4e3a$k-1$\uff0c\u8d39\u7528\u4e3a0\u7684\u8fb9\uff0c\u8868\u793a\u53ef\u4ee5\u4e0d\u6254\uff0c\u7559\u5230\u660e\u5929\uff0c\u4f46\u660e\u5929\u7684\u4e66\u8fd8\u9700\u8981\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u6240\u4ee5\u662f$k-1$\u3002\n\n\u6bcf\u5929\u7684\u524d\u4e00\u5929\u5411\u4e0a\u4e00\u4e2a$a_i$\u51fa\u73b0\u7684\u4f4d\u7f6e\u7684$y$\u8fde\u4e00\u6761\u8d39\u7528\u4e3a$-c_{a_i}$\uff0c\u6d41\u91cf\u4e3a1\u7684\u8fb9\uff0c\u8868\u793a\u5728\u5df2\u7ecf\u6709\u8fd9\u672c\u4e66\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u5356\u6389\u8fd9\u672c\u4e66\u3002\n\n\u6b64\u65f6\u6c42\u51fa\u6700\u5c0f\u8d39\u7528\u5373\u4e3a\u7b54\u6848\u3002\n```cpp\n#include <cstdio>\n#include <queue>\n#include <cstring>\n#define INF 2147483647\nusing namespace std;\nconst int MAXN = 210;\nconst int MAXM = 200010;\nqueue <int> q; \nint s, t, now, n;\nstruct Edge{\n    int from, next, to, rest, cost;\n}e[MAXM];\nint head[MAXN], num = 1, dis[MAXN], vis[MAXN], Flow[MAXN], pre[MAXN];\ninline void Add(int from, int to, int flow, int cost){\n    e[++num] = (Edge){ from, head[from], to, flow, cost }; head[from] = num;\n    e[++num] = (Edge){ to, head[to], from, 0, -cost }; head[to] = num;\n}\nint RoadsExist(){\n    q.push(s);\n    memset(dis, 127, sizeof dis);\n    dis[s] = 0; Flow[s] = INF; pre[t] = 0;\n    while(!q.empty()){\n      now = q.front(); q.pop(); vis[now] = 0;\n      for(int i = head[now]; i; i = e[i].next)\n         if(e[i].rest && dis[e[i].to] > dis[now] + e[i].cost){\n           dis[e[i].to] = dis[now] + e[i].cost;\n           pre[e[i].to] = i;\n           Flow[e[i].to] = min(Flow[now], e[i].rest);\n           if(!vis[e[i].to]){\n             vis[e[i].to] = 1;\n             q.push(e[i].to);\n           }\n         }\n    }\n    return pre[t];\n}\nint k, maxflow, mincost, sum;\nint a[MAXN], c[MAXN], last[MAXN];\nint main(){\n    scanf(\"%d%d\", &n, &k); s = 199; t = 200;\n    for(int i = 1; i <= n; ++i) scanf(\"%d\", &a[i]);\n\tfor(int i = 1; i <= n; ++i) scanf(\"%d\", &c[i]);\n    for(int i = 1; i <= n; ++i){\n       Add(s, i, 1, c[a[i]]);\n       if(i != 1) Add(i - 1, i, k - 1, 0);\n       Add(i, i + n, 1, 0);\n       if(last[a[i]]) Add(i - 1, last[a[i]] + n, 1, -c[a[i]]);\n       Add(i + n, t, 1, 0);\n       last[a[i]] = i;\n    }\n    while(RoadsExist()){\n      mincost += Flow[t] * dis[t];\n      for(int i = t; i != s; i = e[pre[i]].from){\n         e[pre[i]].rest -= Flow[t];\n         e[pre[i] ^ 1].rest += Flow[t];\n      }\n    }\n    printf(\"%d\\n\", mincost);\n    return 0;\n}\n\n```",
        "postTime": 1552319906,
        "uid": 61834,
        "name": "Huami360",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF802C \u3010Heidi and Library (hard)\u3011"
    },
    {
        "content": "[\u9898\u76ee\u94fe\u63a5](https://codeforces.com/contest/802/problem/C)\n\n\u5728 CF \u901b\u4ee3\u7801\u533a\u7684\u65f6\u53d1\u73b0\u4e86\u4e0d\u540c\u7684\u5efa\u56fe\u65b9\u6cd5\uff0c\u5199\u4e00\u4e0b\u5427\u3002\n\n\u9996\u5148\u6211\u4eec\u4e70\u4e00\u672c\u4e66\u4e22\u4e00\u672c\u4e66\u3002\n\n\u5982\u679c\u6211\u4eec\u8981\u9009\u62e9\u4e24\u4e2a\u540c\u8272\u76f8\u90bb\u7684\u4e66(\u5929) $l,r$\uff0c\u5982\u679c\u5b83\u4eec\u4e0d\u76f8\u90bb\uff0c\u610f\u5473\u7740\u6211\u4eec\u8981\u8986\u76d6 $[l+1,r-1]$ \u533a\u95f4\u4e00\u6b21\uff0c\u610f\u5473\u7740\u8fd9\u4e9b\u5929\u4e66\u67b6\u8981\u591a\u627f\u62c5\u4e00\u672c\u4e66(\u672c\u6765\u6bcf\u5929\u5c31\u8981\u627f\u62c5\u4e00\u672c)\u3002\n\n\u4e8e\u662f\u8f6c\u5316\u6210 [\u6700\u957fk\u53ef\u91cd\u533a\u95f4\u96c6\u95ee\u9898](https://www.luogu.com.cn/problem/P3358)  , \u4e0d\u4e00\u6837\u662f\uff0c\u5982\u679c\u6211\u4eec\u91c7\u7528 \u201c\u70b9\u201d \u7684\u6d41\u91cf\u4f1a\u6709\u4e00\u70b9\u95ee\u9898\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u9700\u8981\u628a\u95ed\u533a\u95f4\u53d8\u6210\u5f00\u533a\u95f4\uff0c\u8fd9\u65f6\u5019\u5c31\u4f1a\u6709\u95ee\u9898\u3002 \u4e3e\u4e2a\u6700\u7b80\u5355\u7684\u4f8b\u5b50:\n\n$[l,r-1],[r,z]$  \u533a\u95f4\u65e0\u4ea4\uff0c\u8f6c\u5316\u4e3a\u5f00\u533a\u95f4\u6709\u4ea4\uff0c\u5bf9\u5e94\u7684\u56fe\u5c31\u4f1a\u51fa\u73b0\u76f8\u5e94\u7684\u95ee\u9898\uff0c\u4f1a\u5224\u65ad\u8fd9\u4e24\u4e2a\u533a\u95f4\u6709\u4ea4\u3002\n\n\u90a3\u4e0d\u59a8\u6362\u53e6\u4e00\u79cd\u65b9\u6cd5\u5efa\u56fe\uff0c\u4ee5\u521d\u59cb\u8fb9\uff0c\u5373 $i\\rightarrow i+1$ \u7684\u521d\u59cb\u6d41\u91cf\u7684\u6b8b\u4f59\u5bb9\u91cf\u6765\u4f5c\u4e3a\u7b2c $i$ \u5929\u8fd8\u5269\u4e0b\u591a\u5c11\u7a7a\u4f4d\u3002\u8fd9\u79cd\u5efa\u56fe\u5bf9\u4e8e\u5904\u7406\u95ed\u533a\u95f4\u53ef\u4ee5\u517c\u5bb9\u4e0a\u8ff0\u60c5\u51b5\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u4e00\u79cd\u8f83\u4e3a\u7b80\u5355\u7684\u5efa\u56fe\u65b9\u6cd5\uff0c\u5373\u53ef\u901a\u8fc7\u6b64\u9898\u3002\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <cmath>\n#include <cstdlib>\n#include <vector>\n \nusing namespace std;\n \nconst int N = 10005;\n \nstruct edge { int y, c, w, next; } a[N << 1]; int len, last[N];\n \nvoid ins(int x, int y, int c, int w) { \n\ta[++len] = (edge) { y, c, w, last[x] }; last[x] = len;\n\ta[++len] = (edge) { x, 0, -w, last[y] }; last[y] = len;\n}\n \nint q[N << 2], d[N], f[N], S, T, prv[N], ans, sta[N], top; bool v[N];\n \nbool spfa() {\n\tmemset(d, 0xcf, sizeof d); memset(f, 0, sizeof f);\n\td[S] = 0; f[S] = 0x3f3f3f3f; int l = 1, r = 0; v[q[++r] = S] = 1;\n\tfor (int x = q[l]; l <= r; x = q[++l]) {\n\t\tv[x] = 0; for (int k = last[x], y; k; k = a[k].next) {\n\t\t\tif (d[y = a[k].y] < d[x] + a[k].w && a[k].c) {\n\t\t\t\td[y] = d[x] + a[k].w; f[y] = min(f[x], a[k].c);\n\t\t\t\tif (!v[y]) v[q[++r] = y] = 1; prv[y] = k;\n\t\t\t}\n\t\t}\n\t}\n\treturn f[T] > 0;\t\t\t\n}\t\n \nvoid upd() {\n\tans -= f[T] * d[T]; int k = prv[T];\n\twhile (k) {\n\t\ta[k].c -= f[T]; \n\t\ta[k ^ 1].c += f[T];\n\t\tk = prv[a[k ^ 1].y];\n\t}\n}\n \nint A[N], C[N], lst[N];\n \nint main() {\n\tlen = 1; memset(last, 0, sizeof last); memset(lst, 0, sizeof lst);\n\tint n, m; scanf(\"%d%d\", &n, &m); ans = 0;\n\tfor (int i = 1; i <= n; ++i) scanf(\"%d\", &A[i]);\n\tfor (int i = 1; i <= n; ++i) scanf(\"%d\", &C[i]); \n\tfor (int i = 1; i <= n; ++i) ans += C[A[i]];\n\t\n\tS = 0; T = n + 1; --m;\n\tfor (int i = 0; i < T; ++i) ins(i, i + 1, m, 0);\n\tfor (int i = 1; i <= n; ++i) {\n\t\tif (!lst[A[i]]) lst[A[i]] = i;\n\t\telse {\n\t\t\tif (lst[A[i]] == i - 1) ans -= C[A[i]]; \n\t\t\telse ins(lst[A[i]] + 1, i, 1, C[A[i]]);\n\t\t\tlst[A[i]] = i;\n\t\t}\n\t}\n\t\n\twhile (spfa()) upd();\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n```\n\n\n\n",
        "postTime": 1597709686,
        "uid": 106232,
        "name": "_Sein",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF802C \u3010Heidi and Library (hard)\u3011"
    }
]
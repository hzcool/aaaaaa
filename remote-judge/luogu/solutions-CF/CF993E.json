[
    {
        "content": "[CF993E Nikita and Order Statistics](https://www.luogu.com.cn/problem/CF993E)\n\n---\n\n\u4f5c\u4e3a\u6211\u505a\u7684\u7b2c\u4e00\u9053 FFT \u7684\u9898\u76ee\uff0c\u60f3\u6765\u53d1\u4e00\u4e2a\u9898\u89e3\u3002\n\n\u6211\u4eec\u628a\u5e8f\u5217\u4e2d $\\ge x$ \u7684\u6570\u8bbe\u6210 $0$ \uff0c $<x$ \u7684\u6570\u8bbe\u6210 $1$\u3002\n\n\u7136\u540e\u518d\u5bf9\u5e8f\u5217 $a$ \u6c42\u524d\u7f00\u548c\uff0c\u8bb0\u4e3a $s$ \u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a $k$ \uff0c\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa $s[i]-s[j]=k$\uff0c$0\\leq i,j\\leq n$ \u7b26\u5408\u6761\u4ef6\u7684 $i,j$ \u5171\u6709\u591a\u5c11\u4e2a\u3002\n\n\u5982\u679c $s[i]-s[j]=k$\uff0c\u90a3\u4e48 $s[i]=s[j]+k$ \u3002\n\n\u8bb0 $f[i]$ \u8868\u793a\u524d\u7f00\u548c $s$ \u6570\u7ec4\u4e2d\u5171\u6709\u591a\u5c11\u4e2a $i$ \u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a $k$ \uff0c\u6211\u4eec\u53ea\u9700\u8981\u6c42 $ans[k]=\\sum_{i=0}^{n-k} f[i]\\times f[i+k]$ \u3002\n\n\u63a5\u4e0b\u6765\u597d\u50cf\u662f FFT \u7684\u4e00\u4e2a~~\u7ecf\u5178\u5957\u8def~~\uff1a\u53cd\u8f6c\u6570\u7ec4\u3002\n\n\u8bbe $g[i]=f[n-i]$ \uff0c\u7528 FFT \u505a $f$ \u4e0e $g$ \u7684\u5377\u79ef\uff0c\u8bbe\u4e3a $h[i]$\u3002\n\n\u90a3\u4e48 $h[n-i]=\\sum_{j=0}^{n-i} f[j]\\times g[n-i-j]=\\sum_{j=0}^{n-i} f[j]\\times f[i+j]$\n\n\u518d\u4e0e\u4e0a\u9762\u7684 $ans[k]$ \u7684\u67ff\u5b50\u5bf9\u6bd4\u4e00\u4e0b\uff0c\u662f\u4e0d\u662f\u6709\u70b9\u773c\u719f\uff1f\n\n\u5bf9\uff0c $ans[i]=h[n-i]$ \u3002\n\n\u8fd9\u6837\u6211\u4eec\u53ea\u9700\u8981\u6c42 $f$ \u4e0e $g$ \u7684\u5377\u79ef $h$ \uff0c\u5c31\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u4e86\u3002\n\n\u8bb0\u5f97 $ans[0]$ \u9700\u8981\u7279\u5224\uff0c\u56e0\u4e3a\u4e0d\u80fd\u9009\u957f\u5ea6\u4e3a $0$ \u7684\u533a\u95f4\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define For(i,a,b) for(register int i=(a);i<=(b);++i)\n#define Rep(i,a,b) for(register int i=(a);i>=(b);--i)\n#define int long long //\u5f00\u4e86 long long\nusing namespace std;\ninline int read()\n{\n    char c=getchar();int x=0;bool f=0;\n    for(;!isdigit(c);c=getchar())f^=!(c^45);\n    for(;isdigit(c);c=getchar())x=(x<<1)+(x<<3)+(c^48);\n    if(f)x=-x;return x;\n}\n#define maxn 2000007\nconst double pi=acos(-1.0);\nstruct cpx{\n\tdouble x,y;\n\tcpx operator +(const cpx&b)const{return (cpx){x+b.x,y+b.y};}\n\tcpx operator -(const cpx&b)const{return (cpx){x-b.x,y-b.y};}\n\tcpx operator *(const cpx&b)const{return (cpx){x*b.x-y*b.y,x*b.y+y*b.x};}\n}a[maxn],b[maxn];\nint n,m,l,lim=1,rev[maxn];\nvoid fft(cpx *a,int typ)\n{\n\tFor(i,0,lim-1)\n\t\tif(i<rev[i])swap(a[i],a[rev[i]]);\n\tfor(int mid=1;mid<lim;mid<<=1)\n\t{\n\t\tcpx wn=(cpx){cos(pi/mid),typ*sin(pi/mid)};\n\t\tfor(int r=mid<<1,j=0;j<lim;j+=r)\n\t\t{\n\t\t\tcpx w=(cpx){1,0};\n\t\t\tfor(int k=0;k<mid;++k,w=w*wn){\n\t\t\t\tcpx x=a[j+k],y=w*a[j+k+mid];\n\t\t\t\ta[j+k]=x+y,a[j+k+mid]=x-y;\n\t\t\t}\n\t\t}\n\t}\n}\nint s[maxn],f[maxn],px;\nint get0()//ans0\u7684\u7279\u5224\n{\n\tint p=0,res=0;\n\tFor(i,1,n){\n\t\tif(s[i]!=s[i-1])p=i;\n\t\tres+=i-p;\n\t} return res;\n}\nsigned main()\n{\n\tn=read(),px=read();\n\tFor(i,1,n){\n\t\tint x=read();\n\t\tif(x<px)s[i]=s[i-1]+1;\n\t\telse s[i]=s[i-1];\n\t\tf[s[i]]++;\n\t}f[0]++;\n\twhile(lim<=n+n)lim<<=1,l++;\n\tFor(i,0,lim-1)rev[i]=(rev[i>>1]>>1)|((i&1)<<(l-1));\n\tFor(i,0,n)a[i].x=f[i],b[i].x=f[n-i];\n\tfft(a,1);\n\tfft(b,1);\n\tFor(i,0,lim)a[i]=a[i]*b[i];\n\tfft(a,-1);\n\tcout<<get0();\n\tRep(i,n-1,0)cout<<' '<<(int)(a[i].x/lim+0.5);\n    return 0;\n}\n```",
        "postTime": 1580827543,
        "uid": 151935,
        "name": "Rainbow_qwq",
        "ccfLevel": 0,
        "title": "CF993E \u3010Nikita and Order Statistics\u3011"
    },
    {
        "content": "### \u9898\u610f\n\n\u7ed9\u4f60\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u4e2a\u5e8f\u5217 $a$ \u548c\u4e00\u4e2a\u6570 $x$\uff0c\u5bf9\u4e8e $0\\leq k\\leq n$ \u6c42\u51fa\u6709\u591a\u5c11\u4e2a $a$ \u7684\u5b50\u533a\u95f4\u6ee1\u8db3\u6070\u597d\u6709 $k$ \u4e2a\u6570\u5c0f\u4e8e $x$\u3002\n\n$\\texttt{Data Range:}1\\leq n\\leq 2\\times 10^5$\n\n### \u9898\u89e3\n\nCF \u6807\u7b7e\u6076\u8bc4\u9898\u3002\u540c\u6837\u662f CRT,FFT,math \u4eba\u5bb6 CF1054H \u5c31\u6709 $\\texttt{*3500}$ \u4e3a\u5565\u4f60\u53ea\u6709 $\\texttt{*2300}$\uff08\u65e0\u80fd\u72c2\u6012\uff09\n\n\u5176\u5b9e\u662f\u4e2a\u517b\u751f\u9898\u5566\n\n\u5148\u8003\u8651\u4e00\u4e2a $O(n^2)$ \u7684\u66b4\u529b\u505a\u6cd5\u3002\n\n\u6ce8\u610f\u5230\u6211\u4eec\u8981\u7ef4\u62a4\u7684\u533a\u95f4\u4fe1\u606f\uff08\u4e5f\u5373\u6709\u591a\u5c11\u4e2a\u6570\u5c0f\u4e8e $x$\uff09\u6ee1\u8db3\u53ef\u51cf\u6027\uff0c\u6240\u4ee5\u53ef\u4ee5\u6784\u9020 $b_i=[a_i\\lt x]$\uff0c\u5e76\u4e14\u8bbe $s$ \u4e3a $b$ \u7684\u524d\u7f00\u548c\uff0c\u7136\u540e\u679a\u4e3e\u533a\u95f4\u7684\u5de6\u53f3\u7aef\u70b9\u7edf\u8ba1\u4e00\u4e0b\u8d21\u732e\uff08\u4e5f\u5373 $[l,r]$ \u7ed9 $s_r-s_{l-1}$ \u7684\u8d21\u732e\uff09\u5373\u53ef\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u8fd9\u6837\u4e00\u4e2a\u6027\u8d28\uff0c\u6ce8\u610f\u5230 $b_i\\in\\{0,1\\}$\uff0c\u6240\u4ee5 $s$ \u662f\u5355\u8c03\u4e0d\u964d\u7684\u3002\n\n\u6211\u4eec\u6539\u53d8\u4e00\u4e0b\u679a\u4e3e\u987a\u5e8f\uff0c\u8003\u8651\u679a\u4e3e\u5de6\u7aef\u70b9 $l-1$ \u548c $s_r-s_{l-1}=p$\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5f88\u5feb\u7b97\u51fa $s_r$ \u7684\u7b54\u6848\u3002\n\n\u800c\u4e14\uff0c\u7531\u4e8e $s$ \u5355\u8c03\u4e0d\u964d\uff0c\u6240\u4ee5\u5bf9\u4e8e\u6240\u6709\u6ee1\u8db3 $s_x=s_{l-1}+p$ \u7684 $x$ \u90fd\u4f1a\u7ed9 $p$ \u5e26\u6765\u8d21\u732e\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u8bbe $g_i$ \u8868\u793a\u6709\u591a\u5c11\u4e2a $x$ \u6ee1\u8db3 $s_x=i$\uff0c$f_i$ \u8868\u793a $i$ \u7684\u8d21\u732e\uff0c\u6211\u4eec\u7528\u4e0a\u9762\u7684\u679a\u4e3e\u65b9\u6cd5\u53ef\u4ee5\u5f97\u5230\n\n$$f_i=\\sum\\limits_{j=0}^{}g_jg_{j+i}$$\n\n\u6ce8\u610f\u5230\u8fd9\u662f\u7ecf\u5178\u5957\u8def\uff0c$\\texttt{FFT}$ \u5373\u53ef\u3002\n\n\u4f46\u662f\u6ce8\u610f\u5230\u6211\u4eec\u5e76\u4e0d\u4fdd\u8bc1 $i=0$ \u7684\u65f6\u5019\u6211\u4eec\u679a\u4e3e\u7684\u5de6\u7aef\u70b9\u4e00\u5b9a\u5728\u53ef\u80fd\u7684\u53f3\u7aef\u70b9\u7684\u5de6\u8fb9\uff0c\u4e8e\u662f\u5fc5\u987b\u8981\u66b4\u529b\u8ba1\u7b97\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef int ll;\ntypedef long long int li;\ntypedef long double db;\nconst ll MAXN=524291;\nconst db PI=acos(-1);\nstruct Complex{\n\tdb re,im;\n\tComplex(db x=0,db y=0)\n\t{\n\t\tthis->re=x,this->im=y;\n\t}\n\tinline Complex conj()\n\t{\n\t\treturn Complex(re,-im);\n\t}\n};\nll n,kk,cnt=1,limit=-1;\nComplex f[MAXN],g[MAXN];\nll x[MAXN],rev[MAXN],prefix[MAXN],barrel[MAXN],rb[MAXN];\nli res[MAXN];\ninline ll read()\n{\n    register ll num=0,neg=1;\n    register char ch=getchar();\n    while(!isdigit(ch)&&ch!='-')\n    {\n        ch=getchar();\n    }\n    if(ch=='-')\n    {\n        neg=-1;\n        ch=getchar();\n    }\n    while(isdigit(ch))\n    {\n        num=(num<<3)+(num<<1)+(ch-'0');\n        ch=getchar();\n    }\n    return num*neg;\n}\ninline Complex operator +(Complex x,Complex y)\n{\n\treturn Complex(x.re+y.re,x.im+y.im);\n}\ninline Complex operator -(Complex x,Complex y)\n{\n\treturn Complex(x.re-y.re,x.im-y.im);\n}\ninline Complex operator *(Complex x,Complex y)\n{\n\treturn Complex(x.re*y.re-x.im*y.im,x.re*y.im+x.im*y.re);\n}\ninline Complex operator /(Complex x,db y)\n{\n\treturn Complex(x.re/y,x.im/y);\n}\ninline void FFT(Complex *cp,ll cnt,ll inv)\n{\n\tll cur=0;\n\tComplex res,omg;\n\tfor(register int i=0;i<cnt;i++)\n\t{\n\t\tif(i<rev[i])\n\t\t{\n\t\t\tswap(cp[i],cp[rev[i]]);\n\t\t}\n\t}\n\tfor(register int i=2;i<=cnt;i<<=1)\n\t{\n\t\tcur=i>>1,res=Complex(cos(2*PI/i),inv*sin(2*PI/i));\n\t\tfor(register Complex *p=cp;p!=cp+cnt;p+=i)\n\t\t{\n\t\t\tomg=Complex(1,0);\n\t\t\tfor(register int j=0;j<cur;j++)\n\t\t\t{\n\t\t\t\tComplex t=omg*p[j+cur],t2=p[j];\n\t\t\t\tp[j+cur]=t2-t,p[j]=t+t2;\n\t\t\t\tomg=omg*res;\n\t\t\t}\n\t\t}\n\t}\n\tif(inv==-1)\n\t{\n\t\tfor(register int i=0;i<cnt;i++)\n\t\t{\n\t\t\tcp[i]=cp[i]/cnt;\n\t\t}\n\t}\n}\nint main()\n{\n\tn=read(),kk=read(),barrel[0]=1;\n\tfor(register int i=1;i<=n;i++)\n\t{\n\t\tx[i]=read(),barrel[prefix[i]=prefix[i-1]+(x[i]<kk)]++;\n\t}\n\tfor(register int i=0;i<=n;i++)\n\t{\n\t\trb[i]=barrel[i];\n\t}\n\treverse(rb,rb+n+1);\n\tfor(register int i=0;i<=n;i++)\n\t{\n\t\tf[i].re=barrel[i],g[i].re=rb[i];\n\t}\n\twhile(cnt<=((n+1)<<1))\n\t{\n\t\tcnt<<=1,limit++;\n\t}\n\tfor(register int i=0;i<cnt;i++)\n\t{\n\t\trev[i]=(rev[i>>1]>>1)|((i&1)<<limit);\n\t}\n\tFFT(f,cnt,1),FFT(g,cnt,1);\n\tfor(register int i=0;i<cnt;i++)\n\t{\n\t\tf[i]=f[i]*g[i];\n\t}\n\tFFT(f,cnt,-1);\n\tfor(register int i=0;i<=n;i++)\n\t{\n\t\tres[i]=(li)(f[i].re+0.5);\n\t}\n\treverse(res,res+n+1),res[0]=0;\n\tfor(register int i=0,p=0;i<=n;i++)\n\t{\n        if(prefix[i]!=prefix[i-1])\n        {\n            p=i;\n        }\n\t\tres[0]+=i-p;\n\t}\n\tfor(register int i=0;i<=n;i++)\n\t{\n\t\tprintf(\"%lld \",res[i]);\n\t}\n}\n```",
        "postTime": 1592390965,
        "uid": 60990,
        "name": "Karry5307",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF993E \u3010Nikita and Order Statistics\u3011"
    },
    {
        "content": "\u4e00\u773c\u9898\u5427\u2026\n\n\u503c\u57df\u5e76\u4e0d\u91cd\u8981\uff0c\u76f4\u63a5 $pre_i = \\sum [a_i < k]$\u3002\n\n\u7136\u540e\u5c31\u662f\u6c42 $pre_i - pre_j = x$ \u7684\u4e2a\u6570\u4e86\u3002\n\n\u76f4\u63a5 fft \u5c31\u884c\u5427\u2026\u611f\u89c9\u662f\u4e0d\u8981\u62c6\u7cfb\u6570\u7684\u2026",
        "postTime": 1612408945,
        "uid": 96580,
        "name": "SXNhdW5veWE",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF993E \u3010Nikita and Order Statistics\u3011"
    },
    {
        "content": "\u521d\u770b\u8fd9\u9053\u9898\uff0c\u4ee5\u4e3a\u53c8\u662f\u4ec0\u4e48\u6570\u636e\u7ed3\u6784\u6570\u6570\u9898\uff0c\u6ca1\u5565\u601d\u8def\uff0c\u7ed3\u679c\u63a8\u5f0f\u5b50\u65f6\u641e\u51fa\u4e86\u4e00\u4e2a\u7c7b\u4f3c\u53ef\u4ee5\u5377\u79ef\u7684\u73a9\u610f\u513f\uff0c\u6240\u4ee5\u679c\u65ad $FFT$ \u89e3\u51b3\u3002\n\n\u90a3\u6211\u4eec\u6765\u5206\u6790\u95ee\u9898\uff1a\n\n1. \u8fd9\u9053\u9898\u91cc\uff0c\u503c\u57df\u6ca1\u7528\uff0c\u6bcf\u4e00\u4e2a\u6570\u53ea\u8981\u7ba1\u5b83\u4e0e $x$ \u7684\u76f8\u5bf9\u5927\u5c0f\u5173\u7cfb\u5373\u53ef\u3002\u5982\u679c\u5b83\u5c0f\u4e8e $x$ \u90a3\u4e48\u6709\u8d21\u732e\uff0c\u8d4b\u503c\u4e3a\u4e00\uff0c\u5426\u5219\u4e3a\u96f6\u3002\u7136\u540e\uff0c\u53ef\u4ee5\u6c42\u524d\u7f00\u548c\uff0c\u533a\u95f4\u90e8\u5206\u548c\u95ee\u9898\u5f80\u5f80\u53ef\u4ee5\u7528\u524d\u7f00\u548c\u914d\u5bf9\u7aef\u70b9\u89e3\u51b3\u3002\n\n2. \u4ee4 $f_i$ \u8868\u793a\u524d\u7f00\u548c\u4e3a $i$ \u7684\u524d\u7f00\u7aef\u70b9\u6570\u91cf\uff0c$m$ \u4e3a\u603b\u5171\u6bd4 $x$ \u5c0f\u7684\u6570\u7684\u4e2a\u6570\u3002\u663e\u7136\u7684\uff0c\u5bf9\u4e8e\u6070\u597d\u6709\u5927\u4e8e\u4e00\u4e2a\u6570\u6bd4 $x$ \u5c0f\u7684\u60c5\u51b5\u4e2d\uff0c\u7b54\u6848 $g_k = \\sum\\limits_{i=0}^{m-k} f_i \\times f_{i+k}$\u3002 \u8fd9\u4e2a\u5f0f\u5b50\u610f\u601d\u5c31\u662f\u53d6\u4e24\u4e2a\u7aef\u70b9\u4f7f\u533a\u95f4\u503c\u7b26\u5408\u6761\u4ef6\uff0c\u7136\u540e\u7528\u52a0\u4e58\u539f\u7406\u7edf\u8ba1\u4e00\u4e0b\u3002\n\n3. \u8003\u8651\u5e38\u7528\u6280\u5de7\uff0c\u53d8\u6362\u987a\u5e8f\uff0c\u4ee4 $h_i = f_{m-i}$ \uff0c\u6240\u4ee5 $f_{i+k} = h_{m-i-k}$ \uff0c\u8fd9\u6837\u7684\u8bdd\uff0c$g$ \u5c31\u53ef\u4ee5\u5199\u6210\u4e24\u8005\u52a0\u6cd5\u5377\u79ef\u4e86\u3002\u5927\u529f\u544a\u6210\u3002\n\n4. \u4e0d\u8981\u5fd8\u4e86\u7279\u6b8a\u5904\u7406 $g_0$ \uff0c\u7ecf\u8fc7\u63a8\u5bfc\u53ef\u77e5 $g_0 = \\sum\\limits_{i=0}^m \\frac{f_i\\times{(f_i + 1)}}{2}$ \uff0c\u66b4\u529b\u7b97\u5c31\u597d\u3002\n\n```cpp\nstruct Vector {\n\tdouble x, y;\n\tVector(double _x = 0, double _y = 0) : x(_x), y(_y) {}\n\n\tinline Vector Vary(void) { return Vector(x, -y); }\n\n\tinline bool operator < (const Vector&rhs)\n\tconst { return x == rhs.x ? y < rhs.y : x < rhs.x; }\n\tinline Vector operator - (const Vector&rhs)\n\tconst { return Vector(x - rhs.x, y - rhs.y); }\n\tinline Vector operator + (const Vector&rhs)\n\tconst { return Vector(x + rhs.x, y + rhs.y); }\n\n\tinline Vector operator * (const double&rhs)\n\tconst { return Vector(x * rhs, y * rhs); }\n\tinline Vector operator / (const double&rhs)\n\tconst { return Vector(x / rhs, y / rhs); }\n\n\tinline Vector operator * (const Vector&rhs)\n\tconst { return Vector(x * rhs.x - y * rhs.y, x * rhs.y + y * rhs.x); }\n}; typedef Vector Complex;\n\nconst double PI = std :: acos(-1.0);\nconst int Maxn = 6e5 + 5;\n\nint lim = 1, rev[Maxn];\ninline void FFT(int limit, Complex *arr, int type) {\n\tfor (int i = 0; i < limit; i++)\n\t\tif (i < rev[i]) swap(arr[i], arr[rev[i]]);\n\tfor (int mid = 1; mid < limit; mid <<= 1) {\n\t\tComplex w0(cos(PI / mid), type * sin(PI / mid));\n\t\tfor (int i = 0; i < limit; i += mid << 1) { Complex w(1, 0);\n\t\t\tfor (int j = 0; j < mid; j++, w = w * w0) {\n\t\t\t\tComplex x = arr[i + j], y = w * arr[i + j + mid];\n\t\t\t\tarr[i + j] = x + y, arr[i + j + mid] = x - y;\n\t\t\t}\n\t\t}\n\t} if (type == -1) for (int i = 0; i < limit; i++) arr[i] = arr[i] / limit;\n}\n\nint n, m, x; Complex f[Maxn];\n\nsigned main(void) {\n\tread(n), read(x);\n\tfor (int i = 1, v; i <= n; i++) {\n\t\tread(v); m += v < x ? 1 : 0; f[m].x++;\n\t}\n\t\n\tf[0].x++;\n\twhile (lim <= m << 1) lim <<= 1;\n\tfor (int i = 0; i < lim; i++)\n\t\trev[i] = (rev[i >> 1] >> 1) | ((i & 1) ? (lim >> 1) : 0);\n\t\n\tll ret = 0;\n\tfor (int i = 0; i <= m; i++) f[m - i].y = f[i].x, ret += (ll) f[i].x * (f[i].x - 1) / 2;\n\t\n\tFFT(lim, f, 1);\n\tfor (int i = 0; i < lim; i++) f[i] = f[i] * f[i];\n\tFFT(lim, f, -1);\n\t\n\twriteln(ret, ' ');\n\tfor (int i = 1; i <= m; i++) writeln((ll) (f[m - i].y / 2.0 + 0.5), ' ');\n\tfor (int i = m + 1; i <= n; i++) writeln(0, \" \\n\"[i == n]);\n//\tfwrite(pf, 1, o1 - pf, stdout);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1612343101,
        "uid": 50925,
        "name": "EternalEpic",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF993E \u3010Nikita and Order Statistics\u3011"
    },
    {
        "content": "\u5982\u679c\u8fd9\u7bc7\u9898\u89e3 $\\LaTeX$ \u9505\u4e86\u5c31\u8bf7\u5230 [\u6211\u7684\u6d1b\u8c37\u535a\u5ba2](https://www.luogu.com.cn/blog/My-luoguBuoke-HZR/the-solution-of-CF993E) \u91cc\u770b\u5427\u3002\u3002\u6342\u8138\n\n\u9898\u610f\uff1a\n\nNikita\u7ed9\u4f60\u4e00\u4e2a\u5e8f\u5217 $a$\uff0c\u95ee\u4f60\u5bf9\u4e8e\u6bcf\u4e2a  $\\text{k}\\in[1,\\text{n}]$ \u6709\u591a\u5c11\u4e2a\u8fde\u7eed\u7684\u5e8f\u5217\u6ee1\u8db3\u6070\u597d\u6709 $\\text{k}$ \u4e2a\u6570\u5c0f\u4e8e\u6307\u5b9a\u7684\u5e38\u6570 $X$\n\n---\n\n\u9996\u5148\u56e0\u4e3a\u5e38\u6570\u662f\u56fa\u5b9a\u7684\uff0c\u6570\u5b57\u53ea\u6709\u6709\u8d21\u732e\u7684\u548c\u65e0\u8d21\u732e\u4e4b\u5206\u3002\n\n\u628a\u6240\u6709\u5927\u4e8e\u7b49\u4e8e $\\text{X}$ \u7684\u6570\u6539\u4e3a 0 \uff0c\u5c0f\u4e8e $\\text{X}$ \u7684\u6570\u5b57\u6539\u4e3a 1 \uff0c\u539f\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a\u95ee\u6709\u591a\u5c11\u4e2a\u8fde\u7eed\u5e8f\u5217\u6ee1\u8db3\u548c\u4e3a $\\text{k}$ \u3002\n\n\u56e0\u4e3a\u53ea\u8be2\u95ee\u8fde\u7eed\u5e8f\u5217\uff0c\u8bb0\u524d\u7f00\u548c $\\text{sum}_{\\text{ i}}= \\sum\\limits^i_{j=1} a_j$\uff0c\u539f\u95ee\u9898\u8f6c\u5316\u4e3a\u6c42\uff1a\n\n$\n\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\sum\\limits^n_{i=1}\\sum\\limits^n_{j=1}[a_i-a_j=k]\n$\n\n\u518d\u8bbe $S_i = \\sum[sum_j=i]$\uff0c$S_0=0$\n\n\u539f\u95ee\u9898\u8f6c\u6362\u4e3a\u6c42\n\n$\n\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\sum\\limits^n_{i=k+1}S_i\\cdot S_{i-k}\n$\n\n\u590d\u6742\u5ea6 $O(n^2)$ \uff0c\u4f46\u8fd8\u4e0d\u8db3\u901a\u8fc7\u6b64\u9898\u3002\n\n---\n\n\u4e0a\u9762\u7684\u5f0f\u5b50\u8f6c\u5316\u4e00\u4e0b\u53d8\u4e3a\n\n$\n\\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\ \\sum\\limits_{i-j=k} S_i\\cdot S_j = \\sum\\limits_{i+j=k} S_i\\cdot S_{-j}\n$\n\n(\u6ce8\u610f\u4e0b\u6807\u7684\u8d1f\u6570)\n\n\u90a3\u4e48\u8bbe\n\n$A(x) = S_0+S_1x+S_2x^2+...$\n\n$B(x) = S_0+S_1x^{-1}+S_2x^{-2}+...$\n\n$C(x) = A(x)B(x)$\n\n\u90a3\u4e48\u5bf9\u4e8e\u6bcf\u4e2a $\\text{k}$ \u53ea\u8981\u6c42 $C(x)$ \u4e2d $x^k$ \u9879\u7684\u7cfb\u6570\u5c31\u662f\u7b54\u6848\u3002\n\n\u7136\u540e\u663e\u7136\u662f\u4e2a FTT \u7684\u677f\u5b50\u3002\u5b9e\u9645\u64cd\u4f5c\u65f6\u8fd8\u8981\u628a $B(x)$ \u7684\u6bcf\u4e2a\u9879\u4e58\u4e2a $x^n$ \u53d8\u6210\u6b63\u6570\u518d\u505a FFT\u3002\u6ce8\u610f k=0 \u8981\u7279\u5224\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\ninline int read(){\n\tchar c=getchar();int x=0,f=1;\n    while(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n    while(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n    return x*f;\n}\nconst int maxn=200010*4;\nconst double Pi=acos(-1.0);\nstruct Complex{\n\tdouble A,B;\n};\nint i,j,k,n,m,a[maxn],s[maxn],R[maxn];\nComplex A[maxn],B[maxn];\nComplex operator +(Complex A,Complex B){return Complex{A.A+B.A,A.B+B.B};}\nComplex operator -(Complex A,Complex B){return Complex{A.A-B.A,A.B-B.B};}\nComplex operator *(Complex A,Complex B){return Complex{A.A*B.A-A.B*B.B,A.A*B.B+A.B*B.A};}\nComplex Get_w(int k,int n,bool op){\n\tint K=1;if(!op)K=-1;\n\treturn Complex{cos(k*2.0*Pi/n),K*sin(k*2.0*Pi/n)};\n}\nvoid FFT(int len,Complex *A,bool op){\n\tfor(int i=0;i<len;i++)\n\t\tif(i<R[i])swap(A[i],A[R[i]]);\n\tComplex Wn,w;\n\tfor(int i=1;i<len;i*=2){\n\t\tWn=Get_w(1,i*2,op);\n\t\tfor(int j=0;j<len;j+=i*2){\n\t\t\tw=Complex{1,0};\n\t\t\tfor(int k=0;k<i;k++,w=w*Wn){\n\t\t\t\tint K=k+j;\n\t\t\t\tComplex S1=A[K],S2=w*A[K+i];\n\t\t\t\tA[K]=S1+S2;\n\t\t\t\tA[K+i]=S1-S2;\n\t\t\t}\n\t\t}\n\t}\n}\nint main(){\n\tcin>>n>>m;\n\tA[0].A=1;\n\tfor(i=1;i<=n;i++){\n\t\ta[i]=read();\n//\t\tcout<<a[i]<<' ';\n\t\tif(a[i]<m)a[i]=1;\n\t\telse a[i]=0;\n\t\ts[i]=s[i-1]+a[i];\n\t\tA[s[i]].A+=1;\n\t}\n\tcout<<endl;\n\tfor(i=0;i<=n;i++)\n\t\tB[i].A=A[n-i].A;\n\tint len=1,L=0;\n\twhile(len<=n*2)len*=2,++L;\n\tfor(i=0;i<len;i++)\n\t\tR[i]=R[i/2]/2+((i%2)<<L-1);\n\tFFT(len,A,1);\n\tFFT(len,B,1);\n\tfor(i=0;i<=len;i++)A[i]=A[i]*B[i];\n\tFFT(len,A,0);\n\t\n\tll Ans0=0,Sum=0;\n\ta[n+1]=1;\n\tfor(i=1;i<=n+1;i++){\n\t\tif(a[i]==0)Sum++;\n\t\telse Ans0+=Sum*(Sum+1)/2,Sum=0;\n\t}\n\tprintf(\"%lld\",Ans0);\n\t\n\tfor(i=1;i<=n;i++)\n\t\tprintf(\" %lld\",(ll)(A[i+n].A/len+0.5));\n\tcout<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1582199896,
        "uid": 35891,
        "name": "huangzirui",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF993E \u3010Nikita and Order Statistics\u3011"
    },
    {
        "content": "[Link](https://www.luogu.com.cn/problem/CF993E)\n---------------\n\n### Solution\n\n\u8003\u8651\u5148\u5c06\u5e8f\u5217 $<a_i>$ \u8f6c\u6362\uff0c\u5b9a\u4e49\u5e8f\u5217 $<b_i>$\u3002\u4ee4 $b_i=[a_i<X]$\uff0c\u90a3\u4e48\u5bf9 $b_i$ \u505a\u524d\u7f00\u548c\u7684\u8bdd\uff0c\u5f97\u5230\u7684 $s_i$ \u5c31\u8868\u793a\u524d $i$ \u4e2a\u6570\u4e2d\u5c0f\u4e8e $X$ \u7684\u6570\u7684\u4e2a\u6570\u3002\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a\u7279\u5b9a\u7684 $k$ \uff0c\u6211\u4eec\u5c31\u9700\u8981\u56de\u7b54 $s_i=s_j+k$ \u7684\u6709\u5e8f\u5bf9 $(i,j)$ \u7684\u4e2a\u6570\u3002\u6211\u4eec\u6210\u529f\u5730\u5c06\u533a\u95f4\u8ba1\u6570\u8f6c\u6362\u6210\u4e86\u5143\u7d20\u7edf\u8ba1\uff0c\u8fd9\u5b9e\u9645\u4e0a\u662f\u8fd9\u7c7b\u95ee\u9898\u7684\u60ef\u7528\u4f0e\u4fe9\u3002\n\n\u518d\u8fdb\u4e00\u6b65\uff0c$s$ \u76f8\u540c\u7684\u524d\u7f00\u53ef\u4ee5\u5408\u5e76\uff0c\u4ee4 $c_i$ \u8868\u793a $s=i$ \u7684\u524d\u7f00\u4e2a\u6570\u3002\u90a3\u4e48\u5bf9\u4e8e\u7b54\u6848 $G(k)$ \uff0c\u5c31\u6709\n$$G(k)=\\sum_{i=0}^{m-k} c_i\\times c_{i+k}$$\n\u5176\u4e2d $m$ \u4e3a\u6240\u6709\u5c0f\u4e8e $X$ \u7684\u6570\u7684\u4e2a\u6570\uff0c\u5bb9\u6613\u77e5\u9053\u5f53 $i>m-k$ \u65f6 $c_{i+k}$ \u90fd\u4e3a\u96f6\uff0c\u6240\u4ee5\u4e0d\u7528\u7edf\u8ba1\u3002\n\n\u5230\u4e86\u8fd9\u4e00\u6b65\u5c31\u5f88\u7b80\u5355\u4e86\uff0c\u5bb9\u6613\u53d1\u73b0\u662f\u4e00\u4e2a\u5dee\u5377\u79ef\u7684\u5f62\u5f0f\u3002\u5177\u4f53\u5730\uff0c\u4ee4 $A_{i}=c_i$ \u548c $B_{i}=c_{m-i}$\uff0c\u90a3\u4e48\u4e0a\u5f0f\u5c31\u53ef\u4ee5\u5199\u6210\n$$G(k)=\\sum_{i=0}^{m-k} A_{i}\\times B_{m-i-k}$$\n\u6c42\u51fa $A$ \u548c $B$ \u7684\u5377\u79ef\u540e\u518d\u628a\u524d $m$ \u9879 reverse \u4e00\u4e0b\uff0c\u5c31\u80fd\u5f97\u5230 $G$ \u5e8f\u5217\u3002\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n\u7279\u522b\u7684\uff0c$G(0)$ \u5e76\u4e0d\u80fd\u8fd9\u4e48\u5904\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u5355\u72ec\u7b97\u51fa $G(0)$\uff0c\u590d\u6742\u5ea6 $O(n)$\u3002\n$$G(0)=\\sum_{i=0}^m \\frac{c_i(c_i-1)}{2}$$\n\n```cpp\n#include<stdio.h>\n#include<math.h>\n#include<algorithm>\nusing namespace std;\n#define N ((1<<21)+3)\n#define db double\n#define ll long long\n\nconst db PI=acos(-1);\n\ninline int read(){\n    int x=0,flag=1; char c=getchar();\n    while(c<'0'||c>'9'){if(c=='-') flag=0;c=getchar();}\n    while(c>='0'&&c<='9'){x=(x<<1)+(x<<3)+c-48;c=getchar();}\n    return flag? x:-x;\n}\n\nstruct Complex{\n    db x,y;\n    Complex(db x_=0,db y_=0):x(x_),y(y_){}\n    Complex operator +(const Complex X){return Complex(x+X.x,y+X.y);}\n    Complex operator -(const Complex X){return Complex(x-X.x,y-X.y);}\n    Complex operator *(const Complex X){return Complex(x*X.x-y*X.y,x*X.y+y*X.x);}\n}a[N];\n\nint n,X,m=0,op=0,rk[N];\nll G[N];\n\nvoid FFT(){\n    for(int i=0;i<n;i++)\n        if(i<rk[i]) swap(a[i],a[rk[i]]);\n    for(int p=2;p<=n;p<<=1){\n        int len=p>>1;\n        Complex w(cos(2*PI/p),op*sin(2*PI/p));\n        for(int k=0;k<n;k+=p){\n            Complex now(1.0,0.0);\n            for(int l=k;l<k+len;l++){\n                Complex t=now*a[l+len];\n                a[l+len]=a[l]-t;\n                a[l]=a[l]+t;\n                now=now*w;\n            }\n        }\n    }\n}\n\nint main(){\n    n=read(),X=read();\n    a[0]=1; int n_=n;ll ret=0;\n    for(int i=1;i<=n;i++){\n        int x=read();\n        if(x<X) a[++m].x=1;\n        else a[m].x++;\n    }\n    for(int i=0;i<=m;i++) a[m-i].y=a[i].x,ret+=(ll)a[i].x*(a[i].x-1)/2;\n    for(n=1;n<=(m<<1);n<<=1);\n    for(int i=0;i<n;i++)\n        rk[i]=(rk[i>>1]>>1)|((i&1)? n>>1:0);\n    op=1,FFT();\n    for(int i=0;i<n;i++) a[i]=a[i]*a[i];\n    op=-1,FFT();\n    for(int i=0;i<=m;i++) G[i]=(ll)(a[i].y/n/2+0.5);\n    reverse(G,G+1+m),G[0]=ret;\n    for(int i=0;i<=n_;i++) printf(\"%lld \",G[i]);\n}\n```",
        "postTime": 1612260753,
        "uid": 83337,
        "name": "wwlw",
        "ccfLevel": 7,
        "title": "CF993E Nikita and Order Statistics"
    },
    {
        "content": "\u7b2c\u4e00\u9053FFT\u7684\u5e94\u7528\u9898\n\n# \u601d\u8def\u7b80\u8ff0\n\n\u56e0\u4e3a$x$\u662f\u4e00\u4e2a\u7ed9\u5b9a\u7684\u5e38\u6570\uff0c\u800c\u6211\u4eec\u53ea\u5173\u5fc3\u5927\u5c0f\u7684\u76f8\u5bf9\u5173\u7cfb\u53ca\u5176\u7684\u5bf9\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u628a$<x$\u7684\u6570\u8bbe\u4e3a$1$\uff0c$\\geq x$\u7684\u8bbe\u4e3a$0$\uff0c\u6c42\u4e00\u4e2a\u524d\u7f00\u548c\u3002\u56e0\u4e3a\u5e8f\u5217\u975e\u8d1f\uff0c\u6240\u4ee5\u524d\u7f00\u5927\u5c0f\u4e3a$i+k$\u7684\u4e00\u5b9a\u5728\u524d\u7f00\u5927\u5c0f\u4e3a$i$\u7684\u540e\u8fb9\uff0c\u8fd9\u5f88\u91cd\u8981\uff0c\u53ea\u6709\u4fdd\u8bc1\u5b83\u4eec\u7684\u524d\u540e\u5173\u7cfb\u6211\u4eec\u624d\u80fd\u8fdb\u884c\u4e0b\u4e00\u6b65\u64cd\u4f5c\u3002\n\n\u8bbe$f_i$\u662f\u524d\u7f00\u548c\u5927\u5c0f\u4e3a$i$\u7684\u524d\u7f00\u548c\u7684\u4e2a\u6570\uff0c\u90a3\u4e48\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\u663e\u7136\u6709$ans_k=\\sum\\limits_{i=0}^{n-k}f_i \\times f_{i+k}$\u3002\n\n\u63a5\u4e0b\u6765\u5c31\u662fFFT\u9898\u76ee\u7684\u60ef\u7528\u5957\u8def\uff1a\u53cd\u8f6c\u6570\u7ec4\u3002\n\n\u8bbe$g_i=f_{n-i}$\uff0c\u90a3\u4e48\u6709$f_{i+k}=g_{n-k-i}$\uff0c\u90a3\u4e48\u518d\u8bbe\u4e00\u4e2a$h$\u6570\u7ec4\uff0c$ans_k=h_{n-k}=\\sum\\limits_{i=0}^{n-k}f_i \\times g_{n-k-i}$\uff0c\u90a3\u4e48$h$\u6570\u7ec4\u663e\u7136\u662f$f$\u548c$g$\u7684\u5377\u79ef\uff0c\u90a3\u8fd9\u9898\u4e0a\u4e2aFFT\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u6ce8\u610f$k=0$\u65f6\u7279\u5224\u4e00\u4e0b\uff0c\u6bd5\u7adf\u6211\u4eec\u4e0d\u80fd\u9009\u7a7a\u533a\u95f4\u3002$k=0$\u65f6\u5165\u95e8\u9009\u624b\u90fd\u4f1a\uff0c\u4e0d\u591a\u8d58\u8ff0\uff0c\u8be6\u89c1\u4ee3\u7801\u3002\n\n# \u4ee3\u7801\u65f6\u95f4\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\nusing std::swap;\n#define int long long\nnamespace QiFeng233{\n\tconst int maxn=4e6+10;\n\tconst double pi=acos(-1);\n\tstruct complex{//\u590d\u6570\u7c7b\u578b \n\t\tdouble r,i;\n    \tcomplex(double r=0,double i=0):r(r),i(i){}\n\t\tcomplex operator+(const complex &a)const{\n        \treturn complex(r+a.r,i+a.i);\n\t\t}\n\t\tcomplex operator*(const complex &a)const{\n\t        return complex(r*a.r-i*a.i,r*a.i+i*a.r);\n\t    }\n\t\tvoid operator*=(const complex &a){\n\t        *this=complex(r*a.r-i*a.i,r*a.i+i*a.r);\n\t    }\n\t    complex operator-(const complex &a)const{\n\t        return complex(r-a.r,i-a.i);\n\t    }\n\t};\n\tcomplex F[maxn],G[maxn];\n\tint n,lim=1,L,rev[maxn],a[maxn],s[maxn],x;\n\tvoid FFT(complex *A,int n,int type){\n\t\tfor(int i=0;i<n;++i){\n\t\t\tif(i>=rev[i])continue;\n\t        swap(A[i],A[rev[i]]);\n\t    }\n\t    //\u4e09\u91cd\u5faa\u73af\n\t    for(int mid=1;mid<n;mid<<=1){//\u4e3a\u4e86\u4e00\u6b21\u5904\u7406\u4e24\u4e2a\u76f8\u90bb\u533a\u95f4\uff0c\u5b9e\u9645\u4e0a\u6211\u4eec\u679a\u4e3e\u533a\u95f4\u5de6\u7aef\u70b9\u5230\u4e2d\u70b9\u7684\u957f\u5ea6\n\t        double d=pi/mid;//2*pi/(mid*2)\u7b80\u5316\u540e\n\t        complex root=complex(cos(d),type*sin(d));\n\t        int r=mid<<1;//\u4e00\u6b21\u641e\u5b9a\u4e24\u4e2a\u533a\u95f4\n\t        for(int l=0;l<n;l+=r){\n\t            complex w=complex(1,0);\n\t            for(int k=0;k<mid;++k){\n\t\t\t\t\tcomplex A0=A[l+k];//\u76f8\u5f53\u4e8e\u9012\u5f52\u7248A0\u90a3\u4e00\u884c\n\t                complex A1=w*A[l+k+mid];//\u76f8\u5f53\u4e8e\u9012\u5f52\u7248A1\u90a3\u4e00\u884c\n\t                A[l+k]=A0+A1;\n\t                A[l+k+mid]=A0-A1;\n\t                w*=root;\n\t            }\n\t\t\t}\n\t    }\n\t    if(type==1)return;\n\t    //\u522b\u5fd8\u4e86\u9006\u53d8\u6362\u8981\u9664n\n\t    for(int i=0;i<n;++i)A[i].r/=(1.0*n);\n\t}\n\tint read(){\n\t\tint res=0,c=getchar(),f=c=='-'?-1:1;\n\t\twhile(c<'0'||c>'9')c=getchar(),f=c=='-'?-1:f;\n\t\twhile(c>='0'&&c<='9')res=res*10+c-'0',c=getchar();\n\t\treturn res*f;\n\t}\n\tvoid solve(){\n\t\tn=read(),x=read();\n\t\tfor(int i=1;i<=n;++i)a[i]=read()<x?1:0,s[i]=s[i-1]+a[i];\n\t\tfor(int i=0;i<=n;++i)F[s[i]].r+=1.0;\n\t\tfor(int i=0;i<=n;++i)G[i].r=F[n-i].r;\n\t\twhile(lim<=2*n)lim<<=1,++L;\n\t\t--L;\n\t\tfor(int i=0;i<=lim;++i)rev[i]=(rev[i>>1]>>1)|((i&1)<<L);\n\t\tFFT(F,lim,1);\n\t\tFFT(G,lim,1);\n\t\tfor(int i=0;i<=lim;++i)F[i]*=G[i]; \n\t\tFFT(F,lim,-1);\n\t\tint ans0=0,head=1,tail=1;\n\t\ta[n+1]=-1;\n\t\twhile(head<=n&&tail<=n){\n\t\t\twhile(a[head]==1)++head,++tail;\n\t\t\twhile(a[tail]==0)++tail;\n\t\t\tans0+=(tail-head)*(tail-head+1)/2;\n\t\t\thead=tail;\n\t\t}\n\t\tprintf(\"%lld \",ans0);\n\t\tfor(int i=n-1;i>=0;--i){\n\t\t\tprintf(\"%lld \",(int)round(F[i].r));\n\t\t}\n\t}\n}\nsigned main(){\n\tQiFeng233::solve();\n\treturn 0;\n}\n```\n\n# \u53cd\u601d\u603b\u7ed3\n- \u8fd9\u9898\u4e0d\u80fd\u7528NTT\u7684\u539f\u56e0\u662f\u503c\u57df\u8fbe\u5230\u4e86 $4 \\times 10^{10}$\uff0c\u90a3\u4e48\u6a21\u6570\u8d77\u7801\u6bd4\u8fd9\u4e2a\u8981\u5927\uff0c\u8fd9\u6837\u7684\u8bdd\u4e58\u6cd5\u8fc7\u7a0b\u4e2d\u8981\u4e48\u7206long long\uff0c\u8981\u4e48\u5feb\u901f\u4e58\u5f88\u6162\u3002\n\n- FFT\u7684\u9898\u76ee\u7684\u4e00\u4e2a\u7ecf\u5178\u5957\u8def\u5c31\u662f\u53cd\u8f6c\u6570\u7ec4",
        "postTime": 1585542384,
        "uid": 233357,
        "name": "QiFeng233",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF993E \u3010Nikita and Order Statistics\u3011"
    },
    {
        "content": "\u5176\u5b9e\u8fd9\u9053\u9898\u6bd4\u8f83\u6a21\u677f\uff0c\u53d1\u8fd9\u7bc7\u9898\u89e3\u5c31\u662f\u8ba8\u8bba\u4e00\u4e0b\u5927\u5bb6\u6709\u6ca1\u6709\u4ec0\u4e48\u597d\u7684\u60f3\u6cd5\u3002\n\n\u548c\u4e4b\u524d\u7684\u9898\u89e3\u4e0d\u4e00\u6837\uff0c\u6211\u662f\u76f4\u63a5\u505a\u7684\u3002\u9996\u5148\u628a\u5e8f\u5217\u8f6c\u5316\u4e3a01\u5e8f\u5217\uff0c\u73b0\u5728\u8981\u6c42\u51fa\u548c\u4e3ak\u7684\u533a\u95f4\u4e2a\u6570\u3002\n\n\u6211\u4eec\u8bb0$cnt[v]$\u8868\u793a\u524d\u7f00\u548c\u4e3av\u7684\u51fa\u73b0\u6b21\u6570\uff0c\u5219\n\n$ans[k]=\\sum \\limits_{i<=k} cnt[i]\\times cnt[i-k]$\uff0c\u56e0\u4e3a\u524d\u7f00\u548c\u5355\u8c03\u4e0d\u964d\uff0c\u6240\u4ee5$cnt[i]$\u5728\u539f\u6570\u7ec4\u7684\u4f4d\u7f6e\u4e00\u5b9a\u5927\u4e8e$cnt[i-k]$\u7684\u3002\u76f4\u63a5\u53cd\u8f6c\u6570\u7ec4\uff0c\u5957\u7528FFT\u5373\u53ef\u3002\n\n\u6ce8\u610f$ans[0]$\u9700\u8981\u7279\u5224\uff0c\u56e0\u4e3a$\\sum cnt[i]^2$\u5e76\u6ca1\u6709\u4fdd\u8bc1\u5de6\u53f3\u7aef\u70b9\u4e00\u4e2a\u5728\u524d\u4e00\u4e2a\u5728\u540e\u3002\n\n```cpp\nLL calc0()\n{\n    LL res=0;\n    for(ri i=1,p=0; i<=n; ++i)\n    {\n        if(a[i]!=a[i-1]) p=i;\n        res+=i-p;\n    }\n    return res;\n}\ncpx f[N],g[N];\nLL ans[N];\nsigned main()\n{\n    in(n),in(lim);\n    g[0].x+=1;\n    for(ri i=1; i<=n; ++i)\n    {\n        in(a[i]),a[i]=(a[i]<lim)+a[i-1];\n        g[a[i]].x+=1;\n    }\n    for(ri i=0; i<=n; ++i) f[i]=g[n-i];\n    int m=1;\n    for(; m<=(n*2); m<<=1);\n    for(ri i=1,hb=m>>1; i<m; ++i) r[i]=(r[i>>1]>>1)|((i&1)?hb:0);\n    dft(f,m,1), dft(g,m,1);\n    for(ri i=0; i<=m; ++i) f[i]=f[i]*g[i];\n    dft(f,m,-1);\n    for(ri i=1; i<=n; ++i) ans[i]=(f[n-i].x+0.5);\n    ans[0]=calc0();\n    for(ri i=0; i<=n; ++i) out(ans[i],' ');\n    return 0;\n}\n```",
        "postTime": 1545891320,
        "uid": 58302,
        "name": "i207M",
        "ccfLevel": 0,
        "title": "FFT-CF993E Nikita and Order Statistics-\u89e3\u9898\u62a5\u544a"
    },
    {
        "content": "\n# \u9898\u5916\u8bdd\n[\u6233\u6211\u4e00\u4e0b\u561bQvQ](https://blog.csdn.net/litble/article/details/80963180)\n\n# \u89e3\u9898\u601d\u8def\n\n\u663e\u7136\u5c06\u6240\u6709\u5c0f\u4e8e$x$\u7684\u6570\u8f6c\u5316\u4e3a1\uff0c\u5176\u4ed6\u7684\u4e3a0\uff0c\u8fd9\u5c31\u662f\u4e2a01\u5e8f\u5217\uff0c\u7136\u540e\u6c42\u533a\u95f4\u548c\u662f$k$\u7684\u533a\u95f4\u4e2a\u6570\u3002\n\n\u90a3\u4e48\u6211\u4eec\u9996\u5148\u8981\u53d6\u4e00\u4e2a\u5de6\u7aef\u70b9\uff0c\u518d\u53d6\u4e00\u4e2a\u53f3\u7aef\u70b9\u3002\n\n$k$\u8981\u53d6\u904d\uff0c\u5e76\u4e14\u662f$10^5$\u7ea7\u7684\u6570\u636e\uff0c\u8003\u8651FFT\u3002\n\n\u8003\u8651\u5de6\u7aef\u70b9\u53d6\u6bcf\u4e00\u4e2a\u70b9\u65f6\uff0c\u5728\u8fd9\u4e2a\u70b9\u5de6\u8fb9\u7684$1$\u7684\u4e2a\u6570\uff0c\u82e5\u4e2a\u6570\u4e3a$t$\uff0c\u5219$x^t$\u7684\u7cfb\u6570\u52a01\uff0c\u8fd9\u6837\u6784\u9020\u4e00\u4e2a\u591a\u9879\u5f0f$A$\u3002\n\n\u53f3\u7aef\u70b9\u53d6\u6bcf\u4e00\u4e2a\u70b9\u65f6\uff0c\u5728\u8fd9\u4e2a\u70b9\u53f3\u8fb9\u7684$1$\u7684\u4e2a\u6570\uff0c\u6784\u9020\u4e00\u4e2a\u7c7b\u4f3c\u7684\u591a\u9879\u5f0f$B$\u3002\n\n\u90a3\u4e48$A$\u548c$B$\u505a\u5377\u79ef\uff0c\u7b2c$t$\u9879\u7684\u7cfb\u6570\u5c31\u662f\u533a\u95f4\u5916$1$\u7684\u4e2a\u6570\u4e3a$t$\u7684\u533a\u95f4\u4e2a\u6570\u3002\n\n\u6865\u8c46\u9ebb\u888b\uff0c\u6709\u53ef\u80fd\u51fa\u73b0\u53f3\u7aef\u70b9\u53d6\u5f97\u6bd4\u5de6\u7aef\u70b9\u5c0f\u7684\u60c5\u51b5\u3002\n\n\u53d1\u73b0\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u7b97\u51fa\u6765\u5728\u533a\u95f4\u5916$1$\u7684\u4e2a\u6570\u4e00\u5b9a\u5927\u4e8e\u7b49\u4e8e\u6574\u4e2a\u5e8f\u5217$1$\u7684\u4e2a\u6570\uff0c\u6240\u4ee5\u53d7\u5f71\u54cd\u7684\u53ea\u6709$k=0$\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u5355\u72ec\u7528\u7ec4\u5408\u7684\u65b9\u6cd5\u8ba1\u7b97\u4e00\u4e0b$k=0$\u7684\u60c5\u51b5\u5373\u53ef\u3002\n\n# \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define RI register int\nint read() {\n\tint q=0,w=1;char ch=' ';\n\twhile(ch!='-'&&(ch<'0'||ch>'9')) ch=getchar();\n\tif(ch=='-') w=-1,ch=getchar();\n\twhile(ch>='0'&&ch<='9') q=q*10+ch-'0',ch=getchar();\n\treturn q*w;\n}\ntypedef long long LL;\ntypedef double db;\nconst db pi=3.1415926535897384626;\nconst int N=524300;\nstruct com{db r,i;}a[N],b[N];\nint n,X,tot,len,kn;\nint sum[N],rev[N];LL ans[N];\ncom operator* (com a,com b) {return (com){a.r*b.r-a.i*b.i,a.r*b.i+a.i*b.r};}\ncom operator- (com a,com b) {return (com){a.r-b.r,a.i-b.i};}\ncom operator+ (com a,com b) {return (com){a.r+b.r,a.i+b.i};}\ncom operator/ (com a,db b) {return (com){a.r/b,a.i/b};}\nvoid NTT(com *a,int n,int x) {\n\tfor(RI i=0;i<n;++i) if(rev[i]>i) swap(a[i],a[rev[i]]);\n\tfor(RI i=1;i<n;i<<=1) {\n\t\tcom wn=(com){cos(pi/i),sin(pi/i)*x};\n\t\tfor(RI j=0;j<n;j+=(i<<1)) {\n\t\t\tcom t1,t2,w=(com){1,0};\n\t\t\tfor(RI k=0;k<i;++k,w=w*wn)\n\t\t\t\tt1=a[j+k],t2=w*a[j+i+k],a[j+k]=t1+t2,a[j+i+k]=t1-t2;\n\t\t}\n\t}\n\tif(x==-1) for(RI i=0;i<n;++i) a[i]=a[i]/(db)n;\n}\nint main()\n{\n    n=read(),X=read();\n    for(RI i=1;i<=n;++i) sum[i]=sum[i-1]+(read()<X);\n    for(RI i=1;i<=n;++i) ++a[sum[i-1]].r;\n    for(RI i=1;i<=n;++i) ++b[sum[n]-sum[i]].r;\n    kn=1;while(kn<=sum[n]*2) kn<<=1,++len;\n    for(RI i=1;i<kn;++i) rev[i]=(rev[i>>1]>>1)|((i&1)<<(len-1));\n    NTT(a,kn,1),NTT(b,kn,1);\n    for(RI i=0;i<kn;++i) a[i]=a[i]*b[i];\n    NTT(a,kn,-1);\n    int js=0;\n    for(RI i=1;i<=n;++i)\n    \tif(sum[i]==sum[i-1]) ++js;\n    \telse ans[0]+=1LL*js*(js-1)/2+js,js=0;\n    ans[0]+=1LL*js*(js-1)/2+js;\n    for(RI i=0;i<sum[n];++i) ans[sum[n]-i]=(LL)(a[i].r+0.2);\n    for(RI i=0;i<=n;++i) printf(\"%lld \",ans[i]);\n    puts(\"\");\n    return 0;\n}\n```\n",
        "postTime": 1531057891,
        "uid": 20604,
        "name": "litble",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF993E \u3010Nikita and Order Statistics\u3011"
    },
    {
        "content": "\u9898\u89e3\n===\nFFT\u6c34\u9898\u3002\u3002\u3002\n\n\u8fd9\u9053\u9898\u7684\u5173\u952e\u5728\u4e8e\u610f\u8bc6\u5230 $x$ \u662f\u7ed9\u5b9a\u4e0d\u53d8\u7684\uff0c\u800c\u6570\u7ec4 $\\{a_n\\}$ \u540c\u65f6\u4e5f\u662f\u7ed9\u5b9a\u4e0d\u53d8\u7684\u3002\u8fd9\u6837\u8fd9\u9898\u4fbf\u4e0e\u6570\u7ec4\u91cc\u7684\u5404\u4e2a\u6570\u5206\u522b\u662f\u4ec0\u4e48\u6216\u8005 $x$ \u662f\u591a\u5c11\u6beb\u65e0\u5173\u7cfb\u4e86\u3002\n\n\u6211\u4eec\u73b0\u5728\u5df2\u7ecf\u77e5\u9053\u4e86\u6570\u7ec4\u91cc\u7b26\u5408\u201c\u6bd4 $x$ \u5c0f\u201d\u8981\u6c42\u7684\u6570\u7684\u5177\u4f53\u4f4d\u7f6e\uff0c\u6bcf\u4e2a\u7b26\u5408\u8981\u6c42\u7684\u6570\u5c06\u8fd9\u4e2a\u6570\u5217\u5212\u5206\u6210\u4e86\u6570\u4e2a\u533a\u57df\uff0c\u6211\u4eec\u5148\u8003\u8651\u66b4\u529b\uff0c\u5bf9\u4e8e\u4e00\u4e2a $k$\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u679a\u4e3e\u5305\u542b\u5728\u533a\u95f4\u91cc\u7684 $k$ \u4e2a\u6bd4 $x$ \u5c0f\u7684\u6570\u5206\u522b\u662f\u54ea\u51e0\u4e2a\uff0c\u90a3\u4e48\u8fd9\u4e9b\u6570\u4e00\u5b9a\u662f\u8fde\u7eed\u7684\u3002\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u76f8\u9694 $k-1$ \u4e2a\u533a\u57df\u7684\u4e24\u4e2a\u533a\u57df\uff0c\u5728\u8fd9\u4e24\u4e2a\u533a\u57df\u4e2d\u5206\u522b\u9009\u53d6\u533a\u95f4\u5de6\u7aef\u70b9\u548c\u53f3\u7aef\u70b9\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u9009\u51fa\u6765\u7684\u533a\u57df\u4e2d\u4e00\u5b9a\u5305\u542b $k$ \u4e2a\u7b26\u5408\u8981\u6c42\u7684\u6570\uff0c\u800c\u8fd9\u6837\u4e00\u6b21\u64cd\u4f5c\u7684\u8d21\u732e\u7684\u65b9\u6848\u6570\u5c31\u662f\u4e24\u4e2a\u533a\u57df\u5927\u5c0f\u7684\u4e58\u79ef\u3002\n\n\u53ef\u4ee5\u5148\u5b58\u4e00\u4e2a\u6570\u7ec4\u8868\u793a\u88ab\u7b26\u5408\u8981\u6c42\u7684\u6570\u5212\u5f00\u7684\u533a\u95f4\u7684\u5927\u5c0f\uff0c\u8bbe\u4e3a $s$\uff0c\u518d\u5047\u8bbe\u5212\u51fa\u4e86 $m$ \u4e2a\u533a\u57df\uff0c\u7136\u540e\u5bf9\u4e8e\u4e00\u4e2a $k$ \u6211\u4eec\u8981\u6c42\u7684\u5c31\u662f $\\sum_{i=0}^{m-k}(s_i\\times s_{i+k})$\u3002\n\n\u5982\u679c\u66b4\u529b\u7b97\u80af\u5b9a\u4f1a\u51fa\u95ee\u9898\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u6240\u6709\u7684 $k$\uff0c\u603b\u5171\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5927\u6982\u662f $O(n^2)$ \u7684\u3002\u6240\u4ee5\u6211\u4eec\u5728\u8fd9\u91cc\u505a\u4e00\u4e2a\u53d8\u5f62\u3002\n\n\u6211\u4eec\u53d1\u73b0\u6bcf\u6b21\u88ab\u4e58\u8d77\u6765\u7684\u4e24\u4e2a\u6570\u7684\u89c4\u5f8b\uff1a\u4e0b\u6807\u4e4b\u5dee\u4e3a\u5b9a\u503c\uff0c\u8fd9\u4f1a\u8ba9\u719f\u6089\u591a\u9879\u5f0f\u64cd\u4f5c\u7684\u4f60\u89c9\u5f97\u4e0d\u723d\uff0c\u800c\u4e24\u4e24\u76f8\u4e58\uff0c\u6700\u540e\u76f8\u52a0\u7684\u5f62\u5f0f\u53c8\u8ba9\u4f60\u89c9\u5f97\u5f88\u719f\u6089\u3002\u6240\u4ee5\u4f60\u60f3\u5230\u4e86\u4e00\u4e2a\u5957\u8def\uff1a\u5c06\u5176\u4e2d\u4e00\u4e2a\u6570\u7ec4\u7ffb\u8f6c\u8fc7\u6765\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a $k$\uff0c\u6211\u4eec\u8981\u6c42\u7684\u662f $\\sum_{i-j=k}(s_i\\times s_j)$\u3002\u5982\u679c\u5c06\u6570\u7ec4\u7ffb\u8f6c\u8fc7\u6765\uff0c\u5176\u4e2d\u7684\u4e00\u4e2a\u53d8\u91cf\uff08\u6bd4\u5982 $j$\uff09\u5c31\u4f1a\u53d8\u6210 $-j$ \u8fd9\u65f6\u5019\u5c31\u4f1a\u6709 $i+(-j)=k$\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u4f7f\u7528\u795e\u5947\u7684\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\u52a0\u901f\u4e86\u3002\n\n\u6700\u540e\u6ce8\u610f\u4e00\u4e2a\u7ec6\u8282\uff0c\u5982\u679c $k>0$\uff0c\u5f88\u660e\u663e\u9009\u53d6\u7684\u533a\u95f4\u53ef\u4ee5\u4ee5\u7b26\u5408\u8981\u6c42\u7684\u6570\u4f5c\u4e3a\u8fb9\u754c\u3002\u800c\u5f53 $k=0$ \u65f6\u4e0d\u884c\uff0c\u6240\u4ee5\u8bf4\u6211\u4eec\u5f97\u8981\u5c06 $k>0$ \u548c $k=0$ \u7684\u60c5\u51b5\u5206\u5f00\u8ba8\u8bba\u3002\n\n```cpp\n  #include <iostream>\n  #include <cctype>\n  #include <cstdio>\n  #include <cstring>\n  #include <algorithm>\n  #include <cmath>\n  using namespace std;\n\n  #define Pi acos(-1)\n\n  inline int read() {\n      char ch;\n      int k = 1;\n      while (!isdigit(ch = getchar()))\n          if (ch == '-')\n              k = -1;\n      int sum = ch ^ 48;\n      while (isdigit(ch = getchar()))\n          sum = (sum << 1) + (sum << 3) + (ch ^ 48);\n      return sum * k;\n  }\n\n  struct complex {\n      double x, y;\n\n      inline complex(double a = 0, double b = 0) : x(a), y(b) { };\n\n      inline complex operator + (const complex& n) const {\n          return complex(x + n.x, y + n.y);\n      }\n\n      inline complex operator - (const complex& n) const {\n          return complex(x - n.x, y - n.y);\n      }\n\n      inline complex operator * (const complex& n) const {\n          return complex(x * n.x - y * n.y, x * n.y + y * n.x);\n      }\n  };\n\n  int n, x, arr[200010];\n  int rev[800010], p, len;\n  long long s[200010], cnt, lst, ans;\n  complex arr1[800010], arr2[800010];\n\n  inline void get_rev() {\n      for (len = 1; len <= cnt * 2; len <<= 1, p++) ;\n      for (int i = 1; i < len; i++)\n          rev[i] = (rev[i >> 1] >> 1) | ((i & 1) << (p - 1));\n  }\n\n  inline void FFT(complex* arr, int p, int len, int typ) {\n      for (int i = 0; i < len; i++)\n          if (rev[i] > i)\n              swap(arr[i], arr[rev[i]]);\n      int step = 1;\n      complex w, dw, x, y;\n      for (int i = 1; i < len; i <<= 1) {\n          step <<= 1;\n          dw = complex(cos(Pi / i), sin(Pi / i) * typ);\n          for (int j = 0; j < len; j += step) {\n              w = complex(1, 0);\n              for (int d = 0; d < i; d++, w = w * dw) {\n                  x = arr[j + d], y = w * arr[j + d + i];\n                  arr[j + d] = x + y;\n                  arr[j + d + i] = x - y;\n              }\n          }\n      }\n      if (typ == -1) {\n          for (int i = 0; i < len; i++)\n              arr[i].x /= (double)len;\n      }\n  }\n\n  int main() {\n      n = read(), x = read();\n      for (int i = 0; i < n; i++)\n          arr[i] = read();\n      ans = 0;\n      for (int i = 0; i < n; i++) {\n          if (arr[i] < x) {\n              s[cnt++] = i - lst + 1;\n              ans += (i - lst - 1) * (i - lst) / 2 + i - lst;\n              lst = i + 1;\n          }\n      }\n      s[cnt++] = n - lst + 1;\n      ans += (n - lst - 1) * (n - lst) / 2 + n - lst;\n      for (int i = 1; i < cnt; i++)\n          arr1[i - 1].x = s[i];\n      for (int i = 0; i < cnt - 1; i++)\n          arr2[cnt - 2 - i].x = s[i];\n      get_rev();\n      FFT(arr1, p, len, 1);\n      FFT(arr2, p, len, 1);\n      for (int i = 0; i < len; i++)\n          arr1[i] = arr1[i] * arr2[i];\n      FFT(arr1, p, len, -1);\n      printf(\"%lld \", ans);\n      for (int i = 1; i <= n; i++)\n          printf(\"%lld \", (long long)(arr1[cnt - 3 + i].x + 0.5));\n      printf(\"\\n\");\n      return 0;\n  }\n```",
        "postTime": 1613367390,
        "uid": 298917,
        "name": "AnOldSaltedFish",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF993E \u3010Nikita and Order Statistics\u3011"
    },
    {
        "content": "\u9898\u610f\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u7ed9\u51fa\u4e00\u4e2a\u5927\u5c0f\u4e3a$n$\u7684\u6570\u7ec4$a$\u548c\u4e00\u4e2a\u6570$x$\uff0c\u5bf9\u4e8e$0$\u548c$n$ \u4e4b\u95f4\u7684\u6240\u6709$k$\uff0c\u6c42\u6709\u591a\u5c11\u4e2a$a$\u7684\u533a\u95f4\u4e2d\u6070\u6709$k$\u4e2a\u6570\u5c0f\u4e8e$x$\n\n\u81f3\u4e8e\u89e3\u6cd5\uff0c\u5176\u4ed6\u5927\u4f6c\u4eec\u5df2\u7ecf\u8bb2\u5f97\u5f88\u6e05\u695a\u4e86\u3002\u6211\u53d1\u73b0\u5927\u4f6c\u4eec\u7528\u7684\u90fd\u662fFFT\uff0c\u6b64\u5904\u6211\u7ed9\u51faNTT\u7684\u7a0b\u5e8f\u5e76\u89e3\u91ca\u4e3a\u4ec0\u4e48\u7528NTT\u4e0d\u597d\u3002\n\n\u6ce8\u610f\u672c\u9898\u7684\u7b54\u6848\u53ef\u80fd\u5f88\u5927\uff0c\u6240\u4ee5\u8981\u7528\u8f83\u5927\u7684\u6a21\u6570\uff0c\u81f3\u5c11\u8981$N^2$\uff0c\u4e8e\u662f\u5728\u4e58\u6cd5\u8fc7\u7a0b\u4e2d\u5c31\u4f1a\u7206`long long`\uff0c\u4e8e\u662f\u8981\u7528\u5feb\u901f\u4e58\uff0c\u4f46\u8fd9\u6837\u4e00\u6765\uff0c\u7a0b\u5e8f\u7684\u6548\u7387\u5c31\u5927\u5927\u964d\u4f4e\u4e86\uff0c\u4e0d\u52a0\u5e38\u6570\u4f18\u5316\u5f88\u5bb9\u6613TLE\n\nTLE\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\nconst int INF=1e9+7,MAXN=1e6+10;\nconst LL BASE=3,MOD=75161927681,INV=25053975894;\ninline LL mult(LL a,LL b){\n\tLL ret=0;\n\twhile(b>0){\n\t\tif(b&1)\n\t\t\tret=(ret+a)%MOD;\n\t\ta=(a+a)%MOD;\n\t\tb>>=1;\n\t}\n\treturn ret;\n}\ninline LL fpm(LL base,LL p){\n\tLL ret=1;\n\twhile(p){\n\t\tif(p&1)\n\t\t\tret=mult(ret,base)%MOD;\n\t\tbase=mult(base,base)%MOD;\n\t\tp>>=1;\n\t}\n\treturn ret%MOD;\n}\nint N,X,limit=1,lg,rev[MAXN];\ninline void NTT(LL *a,int type){\n\tfor(int i=0;i<limit;i++)\n\t\tif(i<rev[i])\n\t\t\tswap(a[i],a[rev[i]]);\n\tfor(int mid=1;mid<limit;mid<<=1){\n\t\tint len=mid<<1/*n*/;\n\t\tLL Wn=fpm(type==1?BASE:INV/*BASE^type*/,(MOD-1)/len);\n\t\tfor(int j=0;j<limit;j+=len){\n\t\t\tLL w=1;\n\t\t\tfor(int k=0;k<mid;k++){\n\t\t\t\tLL x=a[j+k],y=mult(w,a[j+k+mid]);\n\t\t\t\ta[j+k]=(x+y)%MOD;\n\t\t\t\ta[j+k+mid]=(x-y+MOD)%MOD;\n\t\t\t\tw=mult(w,Wn);\n\t\t\t}\n\t\t}\n\t}\n}\nLL s[MAXN],f[MAXN],g[MAXN],ans[MAXN];\nchar ch;\nint main(){\n\tscanf(\"%d%d\",&N,&X);\n\tfor(int i=1;i<=N;i++){\n\t\tscanf(\"%lld\",s+i);\n\t\ts[i]=(s[i]<X)+s[i-1];\n\t}\n\tfor(int i=0;i<N;i++){\n\t\tf[s[i]]++;\n\t\tg[s[N]-s[i+1]]++;\n\t}\n\twhile(limit<=(N<<1)){\n\t\tlimit<<=1;\n\t\tlg++;\n\t}\n\tfor(int i=0;i<limit;i++)\n\t\trev[i]=(rev[i>>1]>>1)|((i&1)<<(lg-1));\n\tNTT(f,1);\n\tNTT(g,1);\n\tfor(int i=0;i<limit;i++)\n\t\tf[i]=mult(f[i],g[i]);\n\tNTT(f,-1);\n\tLL cnt=0;\n\tfor(int i=1;i<=N;i++)\n\t\tif(s[i]==s[i-1])\n\t\t\tcnt++;\n\t\telse{\n\t\t\tans[0]+=cnt*(cnt-1)/2+cnt;\n\t\t\tcnt=0;\n\t\t}\n\tans[0]+=cnt*(cnt-1)/2+cnt;\n\tLL limit_inv=fpm(limit,MOD-2);\n\tfor(int i=0;i<s[N];i++)\n\t\tans[s[N]-i]=mult(f[i],limit_inv);\n\tfor(int i=0;i<=N;i++)\n\t\tprintf(\"%lld \",ans[i]);\n\treturn 0;\n}\n```",
        "postTime": 1564552493,
        "uid": 70252,
        "name": "guoshaoyang",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF993E \u3010Nikita and Order Statistics\u3011"
    }
]
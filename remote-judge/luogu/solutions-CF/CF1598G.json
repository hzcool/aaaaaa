[
    {
        "content": "\u8003\u8651\u548c\u4e3a $x$ \u7684\u4e24\u4e2a\u6570\u662f $a$ \u548c $b$\uff0c\u4e14 $a \\geq b$\u3002\u663e\u7136\uff0c$|a|=|x|$ \u6216 $|a|=|x|-1$\u3002\n\n\u5148\u8003\u8651 $|a|=|x|-1$ \u7684\u60c5\u51b5\uff0c\u6b64\u65f6\u80af\u5b9a\u6709 $|b|=|x|-1$\u3002\u53ea\u8981\u679a\u4e3e\u4e24\u4e2a\u8fde\u7eed\u7684\u957f\u5ea6\u90fd\u662f $|x|-1$ \u7684\u5b57\u7b26\u4e32\u5373\u53ef\u3002\n\n\u518d\u8003\u8651 $|a|=|x|$ \u7684\u60c5\u51b5\uff0c\u8bbe $lcp$ \u4e3a $a$ \u548c $x$ \u7684\u6700\u957f\u516c\u5171\u524d\u7f00\u957f\u5ea6\uff08\u53ef\u4ee5\u7528 Z \u51fd\u6570\u6c42\u51fa\uff09\u3002\u6b64\u65f6\u6709 $|b|=|x|-lcp$ \u6216 $|b|=|x|-lcp-1$\uff0c\u518d\u679a\u4e3e\u4e00\u4e0b $b$ \u5728 $a$ \u7684\u524d\u9762\u8fd8\u662f\u540e\u9762\u5373\u53ef\u3002\n\n\u81f3\u6b64\uff0c\u6211\u4eec\u5df2\u7ecf\u5728 $O(n)$ \u7684\u65f6\u95f4\u91cc\u6c42\u51fa\u4e86\u6240\u6709\u53ef\u80fd\u6210\u4e3a\u7b54\u6848\u7684 $a$ \u548c $b$\uff0c\u53ea\u9700\u4e00\u4e00\u68c0\u9a8c\u3002\u6734\u7d20\u7684\u9ad8\u7cbe\u5ea6\u7b97\u6cd5\u663e\u7136\u4e0d\u591f\u4f18\u79c0\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u5b57\u7b26\u4e32\u54c8\u5e0c\u89e3\u51b3\u3002**\u6ce8\u610f\u54c8\u5e0c\u4e00\u5b9a\u8981\u7528\u968f\u673a\u6a21\u6570\uff0c\u5426\u5219\u5206\u5206\u949f\u88ab\u5361\u6389\u3002**\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define N 500010\nusing namespace std;\nint n,m,z[N*2];\nchar s[N],x[N*2];\nvector<int> mods,valx,h[N],p10[N];\nbool isprime(int x){\n\tfor(int i=2;i*i<=x;i++)\n\t\tif(!x%i) return 0;\n\treturn 1;\n}\nvector<int> geth(int l,int r){\n\tvector<int> res;\n\tfor(int i=0;i<5;i++) res.push_back((h[r][i]-h[l-1][i]*p10[r-l+1][i]%mods[i]+mods[i])%mods[i]);\n\treturn res;\n} \nvoid check(int l1,int r1,int l2,int r2){\n\tif(l1>r1||l2>r2||l1<1||r1>n||l2<1||r2>n) return;\n\tvector<int> a=geth(l1,r1),b=geth(l2,r2);\n\tfor(int i=0;i<5;i++)\n\t\tif((a[i]+b[i])%mods[i]!=valx[i]) return;\n\tprintf(\"%d %d\\n%d %d\\n\",l1,r1,l2,r2);\n\texit(0);\n}\nsigned main(){\n\tsrand(time(NULL));\n\twhile(mods.size()<5){\n\t\tint r=(rand()*233333&((1<<30)-1))+1e8;\n\t\tif(isprime(r)) mods.push_back(r);\n\t}\n\tscanf(\"%s%s\",s+1,x+1);\n\tn=strlen(s+1);m=strlen(x+1);\n\tfor(int i=0;i<=n;i++) h[i].resize(5,0);\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=0;j<5;j++)\n\t\t\th[i][j]=(h[i-1][j]*10+s[i]-'0')%mods[j];\n\tvalx.resize(5,0);\n\tfor(int i=1;i<=m;i++)\n\t\tfor(int j=0;j<5;j++) valx[j]=(valx[j]*10+x[i]-'0')%mods[j];\n\tfor(int i=0;i<=n;i++) p10[i].resize(5,1);\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=0;j<5;j++) p10[i][j]=p10[i-1][j]*10%mods[j];\n\tx[m+1]='#';\n\tfor(int i=1;i<=n;i++) x[m+1+i]=s[i];\n\tz[1]=n+m+1;\n\tint l=0,r=0;\n\tfor(int i=2;i<=n+m+1;i++){\n\t\tif(i<=r&&z[i-l+1]<r-i+1) z[i]=z[i-l+1];\n\t\telse{\n\t\t\tz[i]=max(0ll,r-i+1);\n\t\t\twhile(i+z[i]<=n+m+1&&x[i+z[i]]==x[z[i]+1]) z[i]++;\n\t\t}\n\t\tif(i+z[i]-1>r) l=i,r=i+z[i]-1;\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tcheck(i,i+m-2,i+m-1,i+2*m-3);\n\t\tint lcp=z[m+1+i];\n\t\tcheck(i,i+m-1,i+m,i+m+(m-lcp)-1);\n\t\tcheck(i,i+m-1,i+m,i+m+(m-lcp-1)-1);\n\t\tcheck(i-(m-lcp),i-1,i,i+m-1);\n\t\tcheck(i-(m-lcp-1),i-1,i,i+m-1);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1634366697,
        "uid": 213870,
        "name": "Yudanjun",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1598G The Sum of Good Numbers"
    },
    {
        "content": "## \u9898\u89e3\n\n~~\u8fd9\u79cd\u9ad8\u7cbe\u52a0\u6cd5\u54c8\u5e0c\u6bd4\u8f83\u7684\u9898\u771f\u7684\u5f88\u81ed\u5440\uff0c\u8d5b\u540e\u4e00\u7fa4\u4eba\u5728\u90a3\u91cc\u5361\u6a21\u6570\uff0c\u771f\u7684\u5410\u4e86~~\n\n\u6211\u4eec\u8003\u8651\u5982\u4f55\u5feb\u901f\u6bd4\u8f83\u4e24\u4e2a\u5927\u6574\u6570\u7684\u548c\uff0c\u663e\u7136\uff0c\u54c8\u5e0c\u662f\u4e00\u79cd\u5f88\u597d\u7684\u65b9\u6cd5\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5c06\u6bd4\u8f83\u4e24\u4e2a\u5f88\u957f\u7684\u5927\u6574\u6570\u7684\u548c\u8f6c\u6362\u6210\u6bd4\u8f83\u5b83\u4eec\u54c8\u5e0c\u503c\u7684\u548c\u3002\n\n\u7531\u4e8e\u6211\u4eec\u6240\u6709\u7684\u6570\u90fd\u662f *\"\u597d\u6570\"* ,\u4e5f\u5c31\u662f\u4e0d\u542b $0$ \u7684\u6570\uff0c\u6240\u4ee5\u5b83\u7684\u8fdb\u4f4d\u4e00\u5b9a\u662f\u6bd4\u8f83\u5c11\u7684\uff0c\u5176\u8fdb\u4f4d\u6700\u591a\u53ea\u4f1a\u6bd4\u505a\u52a0\u6cd5\u7684\u4e24\u4e2a\u6570\u591a\u51fa $1$ \u4f4d\u3002\n\n\u6240\u4ee5\u6211\u4eec\u52a0\u7684\u4e24\u4e2a\u6570\u8981\u4e48\u662f\u957f\u5ea6\u51e0\u4e4e\u76f8\u5f53\uff0c\u90fd\u662f $|x|$ \u6216 $|x|-1$\uff0c\u8981\u4e48\u8f83\u957f\u7684\u4e3a $|x|$\uff0c\u5176\u524d\u7f00\u7684\u5927\u90e8\u5206\u90fd\u4e0e\u6211\u4eec\u76ee\u6807\u7684$x$\u76f8\u540c\u3002\n\n\u5bf9\u4e8e\u524d\u9762\u7684\u90fd\u662f $|x|$ \u6216 $|x|-1$ \u7684\u60c5\u51b5\uff0c\u6211\u4eec\u53ef\u4ee5\u7279\u6b8a\u8bb0\u5f55\u4e00\u4e0b\uff0c\u4ece\u6bcf\u4e2a\u70b9\u5f00\u59cb\u7684\u957f\u5ea6\u4e3a $|x|$ \u6216\u8005 $|x|-1$ \u7684\u524d\u7f00\u7684\u54c8\u5e0c\u503c\uff0c\u5c06\u76f8\u90bb\u7684\u4e24\u4e2a\u52a0\u8d77\u6765\uff0c\u5224\u65ad\u5b83\u7684\u54c8\u5e0c\u503c\u662f\u5426\u7b49\u4e8e\u6211\u4eec\u76ee\u6807 $x$ \u7684\u54c8\u5e0c\u503c\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u53ef\u4ee5\u731c\u6d4b\u5927\u90e8\u5206\u60c5\u51b5\u4e0b\u4e0e\u524d\u7f00\u5927\u90e8\u5206\u4e0e\u6211\u4eec\u76ee\u6807 $x$ \u76f8\u540c\u7684\u6570\u662f\u6bd4\u8f83\u5c11\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8fd9\u6837\u7684\u524d\u7f00\u5c31\u66b4\u529b\u679a\u4e3e\u5176\u5f80\u524d\u6269\u6563\u4e0e\u5f80\u540e\u6269\u6563\u7684\u54c8\u5e0c\u503c\uff0c\u770b\u662f\u5426\u5b58\u5728\u4e00\u4e2a\u4f7f\u5f97\u52a0\u8d77\u6765\u53ef\u4ee5\u8fbe\u5230\u6211\u4eec\u76ee\u6807\u7684 $x$\u3002\n\n\u7531\u4e8e\u8d5b\u540e\u4e00\u7fa4\u4eba\u5728\u90a3\u91cc\u5361\u54c8\u5e0c\uff0c\u628a\u7b14\u8005\u90fd\u7ed9\u5361\u5410\u4e86\uff0c\u6240\u4ee5\u7b14\u8005\u7528\u7684\u662f\u968f\u673a\u7684\u54c8\u5e0c\u6570\uff0c\u4e5f\u5c31\u662f\u5148\u5217\u51fa\u4e00\u5927\u5806\u54c8\u5e0c\u6570\uff0c\u6bcf\u6b21\u4ece\u91cc\u9762\u968f\u673a\u51fa\u4e24\u4e2a\u4f5c\u4e3a\u8fd9\u6b21\u7684\u54c8\u5e0c\u6a21\u6570\u3002\n\n~~\u4e5f\u8bb8\u5e38\u6570\u4f1a\u6709\u70b9\u5927\u3002~~\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O\\left(|s|+|x|\\right)$\u3002\n\n## \u6e90\u7801\nupdate\uff1a\u968f\u673a\u6a21\u6570\u90fd\u6709\u4eba\u628a\u6240\u6709\u6a21\u6570\u6253\u51fa\u6765hack\uff0c\u771f\u7684\u5410\u4e86\uff0c\u4e0d\u8fc7\u6362\u51e0\u4e2a\u6a21\u6570\u5c31\u8fc7\u4e86\u3002\n\n```c++\n#include<bits/stdc++.h>\nusing namespace std;\n#define MAXN 500005\n#define MAXM (1<<20)+5\n#define lowbit(x) (x&-x)\n#define reg register\n#define pb push_back\n#define mkpr make_pair\n#define fir first\n#define sec second\n#define lson (rt<<1)\n#define rson (rt<<1|1)\ntypedef long long LL;\ntypedef unsigned long long uLL;     \nconst int INF=0x3f3f3f3f;  \nconst int inv2=499122177;\nconst int jzm=2333;\nconst int n1=50;\nconst int zero=10000;\nconst int orG=3,invG=332748118;\nconst double Pi=acos(-1.0);\nconst double eps=1e-5;\ntypedef pair<LL,int> pii;\ntemplate<typename _T>\n_T Fabs(_T x){return x<0?-x:x;}\ntemplate<typename _T>\nvoid read(_T &x){\n\t_T f=1;x=0;char s=getchar();\n\twhile(s>'9'||s<'0'){if(s=='-')f=-1;s=getchar();}\n\twhile('0'<=s&&s<='9'){x=(x<<3)+(x<<1)+(s^48);s=getchar();}\n\tx*=f;\n}\ntemplate<typename _T>\nvoid print(_T x){putchar('\\n');while(x>9){putchar((x%10)|'0');x/=10;}putchar(x|'0');}\nLL gcd(LL a,LL b){return !b?a:gcd(b,a%b);}\nint add(int x,int y,int p){return x+y<p?x+y:x+y-p;}\nvoid Add(int &x,int y,int p){x=add(x,y,p);}\nint qkpow(int a,int s,int p){int t=1;while(s){if(s&1LL)t=1ll*a*t%p;a=1ll*a*a%p;s>>=1LL;}return t;}\nint lens,lenx,mod1,mod2;pii nowx,sum1[MAXN],sum2[MAXN];\nint mp[15]={99990571,99990337,99999941,99999931,99999847,99999839,99999827,99999821,99999787,99999773,99999721,};\nchar str[MAXN],x[MAXN];\npii operator + (pii x,pii y){return mkpr(add(x.fir,y.fir,mod1),add(x.sec,y.sec,mod2));}\nbool operator == (pii x,pii y){return x.fir==y.fir&&x.sec==y.sec;}\nsigned main(){\n\tscanf(\"%s\\n%s\",str+1,x+1);\n\tmt19937 e(time(0));uniform_int_distribution<int> g(0,10);\n\tint u=g(e),v=g(e);mod1=mp[u];mod2=mp[v];\n\tlens=(int)strlen(str+1);lenx=(int)strlen(x+1);pii num1=mkpr(1,1),num2=mkpr(1,1);\n\tfor(int i=1;i<=lenx;i++)nowx.fir=(10ll*nowx.fir+(x[i]-'0'))%mod1,nowx.sec=(10ll*nowx.sec+(x[i]-'0'))%mod2;\n\tfor(int i=1;i<=lenx;i++)num1.fir=10ll*num1.fir%mod1,num1.sec=10ll*num1.sec%mod2;\n\tfor(int i=1;i<lenx;i++)num2.fir=10ll*num2.fir%mod1,num2.sec=10ll*num2.sec%mod2;\n\tfor(int i=1;i<=lenx;i++)\n\t\tsum1[lenx].fir=(10ll*sum1[lenx].fir+1ll*(str[i]-'0'))%mod1,\n\t\tsum1[lenx].sec=(10ll*sum1[lenx].sec+1ll*(str[i]-'0'))%mod2;\n\tfor(int i=1;i<lenx;i++)\n\t\tsum2[lenx-1].fir=(10ll*sum2[lenx-1].fir+1ll*(str[i]-'0'))%mod1,\n\t\tsum2[lenx-1].sec=(10ll*sum2[lenx-1].sec+1ll*(str[i]-'0'))%mod2;\n\tfor(int i=lenx+1;i<=lens;i++)\n\t\tsum1[i].fir=(10ll*sum1[i-1].fir+1ll*(str[i]-'0')-1ll*num1.fir*(str[i-lenx]-'0')%mod1+1ll*mod1)%mod1,\n\t\tsum1[i].sec=(10ll*sum1[i-1].sec+1ll*(str[i]-'0')-1ll*num1.sec*(str[i-lenx]-'0')%mod2+1ll*mod2)%mod2;\n\tfor(int i=lenx;i<=lens;i++)\n\t\tsum2[i].fir=(10ll*sum2[i-1].fir+1ll*(str[i]-'0')-1ll*num2.fir*(str[i-lenx+1]-'0')%mod1+1ll*mod1)%mod1,\n\t\tsum2[i].sec=(10ll*sum2[i-1].sec+1ll*(str[i]-'0')-1ll*num2.sec*(str[i-lenx+1]-'0')%mod2+1ll*mod2)%mod2;\n\tfor(int i=lenx+lenx-2;i<=lens;i++){\n\t\tif(i>=lenx+lenx&&sum1[i]+sum1[i-lenx]==nowx){printf(\"%d %d\\n%d %d\\n\",i-lenx-lenx+1,i-lenx,i-lenx+1,i);return 0;}\n\t\tif(lenx>1&&i>=lenx+lenx-1&&sum1[i]+sum2[i-lenx]==nowx){printf(\"%d %d\\n%d %d\\n\",i-lenx-lenx+2,i-lenx,i-lenx+1,i);return 0;}\n\t\tif(lenx>1&&i>=lenx+lenx-1&&sum2[i]+sum1[i-lenx+1]==nowx){printf(\"%d %d\\n%d %d\\n\",i-lenx-lenx+2,i-lenx+1,i-lenx+2,i);return 0;}\n\t\tif(lenx>1&&sum2[i]+sum2[i-lenx+1]==nowx){printf(\"%d %d\\n%d %d\\n\",i-lenx-lenx+3,i-lenx+1,i-lenx+2,i);return 0;}\n\t}\n\tfor(int i=lenx+1;i<=lens;i++){\n\t\tbool flag=0;\n\t\tfor(int j=1;j<=min(10,lenx);j++)if(str[i-lenx+j]^x[j])flag=1;\n\t\tif(flag&&lenx>10)continue;pii summ=mkpr(0,0),num=mkpr(1,1);\n\t\tfor(int j=1;j<=min(lenx,i-lenx);j++){\n\t\t\tsumm.fir=(1ll*summ.fir+1ll*num.fir*(str[i-lenx-j+1]-'0'))%mod1;\n\t\t\tsumm.sec=(1ll*summ.sec+1ll*num.sec*(str[i-lenx-j+1]-'0'))%mod2;\n\t\t\tif(sum1[i]+summ==nowx){printf(\"%d %d\\n%d %d\\n\",i-lenx-j+1,i-lenx,i-lenx+1,i);return 0;}\n\t\t\tnum.fir=10ll*num.fir%mod1;num.sec=10ll*num.sec%mod2;\n\t\t}\n\t\tsumm=mkpr(0,0);\n\t\tfor(int j=1;j<=min(lenx,lens-i);j++){\n\t\t\tsumm.fir=(10ll*summ.fir+str[i+j]-'0')%mod1;\n\t\t\tsumm.sec=(10ll*summ.sec+str[i+j]-'0')%mod2;\n\t\t\tif(sum1[i]+summ==nowx){printf(\"%d %d\\n%d %d\\n\",i-lenx+1,i,i+1,i+j);return 0;}\n\t\t}\n\t\tnum=mkpr(1,1);summ=mkpr(0,0);\n\t\tfor(int j=1;j<=min(lenx-1,i-lenx+1);j++){\n\t\t\tsumm.fir=(1ll*summ.fir+1ll*num.fir*(str[i-lenx-j+2]-'0'))%mod1;\n\t\t\tsumm.sec=(1ll*summ.sec+1ll*num.sec*(str[i-lenx-j+2]-'0'))%mod2;\n\t\t\tif(sum2[i]+summ==nowx){printf(\"%d %d\\n%d %d\\n\",i-lenx-j+2,i-lenx+1,i-lenx+2,i);return 0;}\n\t\t\tnum.fir=10ll*num.fir%mod1;num.sec=10ll*num.sec%mod2;\n\t\t}\n\t\tsumm=mkpr(0,0);\n\t\tfor(int j=1;j<=min(lenx-1,lens-i);j++){\n\t\t\tsumm.fir=(10ll*summ.fir+str[i+j]-'0')%mod1;\n\t\t\tsumm.sec=(10ll*summ.sec+str[i+j]-'0')%mod2;\n\t\t\tif(sum2[i]+summ==nowx){printf(\"%d %d\\n%d %d\\n\",i-lenx+2,i,i+1,i+j);return 0;}\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1633960682,
        "uid": 105141,
        "name": "StaroForgin",
        "ccfLevel": 9,
        "title": "\u9898\u89e3[CF1598G]The Sum of Good Number"
    },
    {
        "content": "\u8bb0 $s$ \u7684\u957f\u5ea6\u4e3a $n$\uff0c\u8bb0 $x$ \u7684\u957f\u5ea6\u4e3a $m$\u3002\n\n\u8003\u8651\u5230\u7b54\u6848\u53ea\u6709\u4ee5\u4e0b\u4e09\u79cd\u60c5\u51b5\uff1a\n\n* \u7b2c\u4e00\u4e2a\u4e32\u957f\u5ea6\u4e3a $m$\u3002\n* \u7b2c\u4e8c\u4e2a\u4e32\u957f\u5ea6\u4e3a $m$\u3002\n* \u4e24\u4e2a\u4e32\u7684\u957f\u5ea6\u5747\u4e3a $m-1$\u3002\n\n\u5bf9\u4e8e\u524d\u4e24\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u5bf9\u5e94\u7684\u4e32\uff0c\u7136\u540e\u548c $x$ \u6c42\u4e00\u4e2a LCP\uff0c\u5c31\u53ef\u4ee5\u7b97\u51fa\u53e6\u5916\u4e00\u79cd\u60c5\u51b5\u4e86\u3002\n\nLCP \u53ef\u4ee5\u4f7f\u7528 Z \u51fd\u6570\u6216\u8005\u4e00\u4e9b\u540e\u7f00\u6570\u636e\u7ed3\u6784\uff0c\u4e5f\u53ef\u4ee5\u54c8\u5e0c\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u4e86 $O(n)$ \u4e2a\u53ef\u80fd\u7684\u7b54\u6848\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u7b54\u6848\uff0c\u5982\u679c\u6211\u4eec\u66b4\u529b\u52a0\u7684\u590d\u6742\u5ea6\u662f $O(\\frac{n^2}{C})$\uff0c$C$ \u662f\u538b\u4f4d\u9ad8\u7cbe\u7684\u5e38\u6570\uff0c\u7ea6\u7b49\u4e8e $18$\uff0c\u52a0\u4e0a\u4e00\u4e9b\u4f18\u5316\u6211\u4e5f\u4e0d\u77e5\u9053\u8fc7\u4e0d\u8fc7\u7684\u53bb\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8003\u8651\u4e00\u4e2a\u975e\u5b8c\u7f8e\u7684\u7b97\u6cd5\uff1a\u968f\u673a\u9009\u4e00\u4e2a\u6a21\u6570 $p$\uff0c\u628a\u4e09\u4e2a\u6570\u6a21 $p$ \u7684\u503c\u6c42\u51fa\u6765\uff0c\u5148\u8fdb\u884c\u4e00\u8f6e\u5224\u65ad\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u5728\u6a21\u6570\u8303\u56f4\u5f88\u5927\u65f6\uff0chash \u7684\u51c6\u786e\u7387\u5f88\u9ad8\uff08\u56e0\u4e3a\u8f93\u5165\u7684\u5b57\u7b26\u4e32\u4e0d\u80fd\u542b $0$\uff09\uff0c\u56e0\u6b64\u65f6\u95f4\u590d\u6742\u5ea6\u8fd1\u4f3c\u4e0e $O(n)$\u3002\n\n\u4ee3\u7801\u6ca1\u5199\uff0c\u56e0\u4e3a\u592a\u6076\u5fc3\u4e86\u3002",
        "postTime": 1633940941,
        "uid": 111055,
        "name": "dead_X",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1598G"
    },
    {
        "content": "\u6bd4\u8f83\u7b80\u5355\u7684\u9898\uff0c\u53ef\u80fd\u662f\u56e0\u4e3a\u5361\u54c8\u5e0c\u88ab\u8bc4\u5230\u4e86 \\*3200\u3002\n\n## \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a\u4e0d\u542b `0` \u7684\u5b57\u7b26\u4e32\uff0c\u7ed9\u4f60\u4e00\u4e2a\u6574\u6570 $x$\uff0c\u627e\u5230\u4e24\u4e2a\u76f8\u90bb\u4e14\u548c\u4e3a $x$ \u7684\u5b50\u4e32\uff0c\u4fdd\u8bc1\u6709\u89e3\u3002\n\n$2\\leqslant |S|\\leqslant 5\\times 10^5,2\\leqslant x\\leqslant 10^{200000}$\u3002\n\n## \u5206\u6790\n\n\u4ee4\u8fd9\u4e24\u4e2a\u5b50\u4e32\u4e3a $A,B$\uff0c\u5bb9\u6613\u53d1\u73b0 $\\max(|A|,|B|)\\geqslant |x|-1$\u3002\n\n\u82e5 $\\max(|A|,|B|)=|x|-1$\uff0c\u90a3\u4e48\u4e00\u5b9a\u6709 $|A|=|B|$\uff0c\u76f4\u63a5\u5224\u65ad\u5373\u53ef\u3002\n\n\u82e5 $\\max(|A|,|B|)=|x|$\uff0c\u90a3\u4e48\u5bf9\u4e8e\u957f\u7684\u90a3\u4e2a\u4e32\u4e0e $x$ \u6c42\u4e2a lcp\uff0c\u5c31\u53ef\u4ee5\u77e5\u9053 $|B|$ \u7684\u957f\u5ea6\u4e86\uff08\u53ef\u80fd\u4f1a\u6709 $1$ \u7684\u8bef\u5dee\uff09\uff0c\u76f4\u63a5\u8dd1\u4e00\u8fb9 exkmp \u89e3\u51b3\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$\u3002\n\n## \u4ee3\u7801\n\n\u8fd9\u9053\u9898\u5361\u54c8\u5e0c\uff0c\u9700\u8981\u968f\u673a\u6a21\u6570\u3002\n\n```\n#include<stdio.h>\n#include<iostream>\n#include<stdlib.h>\n#include<time.h>\nusing namespace std;\nconst int maxn=500005;\nint n,m,mds;\nint mod[5],hshs[maxn][5],hsht[maxn][5],z[maxn<<1],mul[maxn][5];\nstring s,t;\nint check(int x) {\n\tif(x<=2)\n\t\treturn x==2;\n\tfor(int i=2; i*i<=x; i++)\n\t\tif(x%i==0)\n\t\t\treturn 0;\n\treturn 1;\n}\nvoid Z_function(string s) {\n\tint n=s.size(),l=0,r=0;\n\ts=\" \"+s,z[1]=n;\n\tfor(int i=2; i<=n; i++) {\n\t\tif(i<=r)\n\t\t\tz[i]=min(z[i-l],r-i+1);\n\t\telse z[i]=0;\n\t\twhile(i+z[i]<=n&&s[i+z[i]]==s[1+z[i]])\n\t\t\tz[i]++;\n\t\tif(i+z[i]-1>r)\n\t\t\tl=i,r=i+z[i]-1;\n\t}\n}\nvoid calc(int al,int ar,int bl,int br) {\n\tif(1<=al&&al<=ar&&ar<=n&&1<=bl&&bl<=br&&br<=n) {\n\t\tfor(int i=1; i<=4; i++) {\n\t\t\tint va=(hshs[ar][i]-1ll*hshs[al-1][i]*mul[ar-al+1][i]%mod[i]+mod[i])%mod[i];\n\t\t\tint vb=(hshs[br][i]-1ll*hshs[bl-1][i]*mul[br-bl+1][i]%mod[i]+mod[i])%mod[i];\n\t\t\tif((va+vb)%mod[i]!=hsht[m][i])\n\t\t\t\treturn ;\n\t\t}\n\t\tprintf(\"%d %d\\n%d %d\\n\",al,ar,bl,br);\n\t\texit(0);\n\t}\n}\nint main() {\n\twhile(mds<4) {\n\t\tint x=1ll*rand()*rand()%99900000+100000;\n\t\tif(check(x))\n\t\t\tmod[++mds]=x;\n\t}\n\tcin>>s>>t,n=s.size(),m=t.size(),Z_function(t+\"#\"+s),s=\" \"+s,t=\" \"+t;\n\tfor(int i=1; i<=4; i++)\n\t\tmul[0][i]=1;\n\tfor(int i=1; i<=n; i++)\n\t\tfor(int j=1; j<=4; j++)\n\t\t\tmul[i][j]=mul[i-1][j]*10%mod[j];\n\tfor(int i=1; i<=4; i++)\n\t\thshs[0][i]=0;\n\tfor(int i=1; i<=n; i++)\n\t\tfor(int j=1; j<=4; j++)\n\t\t\thshs[i][j]=(hshs[i-1][j]*10+s[i]-48)%mod[j];\n\tfor(int i=1; i<=4; i++)\n\t\thsht[0][i]=0;\n\tfor(int i=1; i<=m; i++)\n\t\tfor(int j=1; j<=4; j++)\n\t\t\thsht[i][j]=(hsht[i-1][j]*10+t[i]-48)%mod[j];\n\tfor(int i=1; i<=n; i++) {\n\t\tint len=z[m+i+1];\n\t\tcalc(i,i+(m-1)-1,i+(m-1),i+(m-1)+(m-1)-1);\n\t\tcalc(i,i+m-1,i+m,i+m+(m-len)-1),calc(i,i+m-1,i+m,i+m+(m-len-1)-1);\n\t\tcalc(i-1-(m-len)+1,i-1,i,i+m-1),calc(i-1-(m-len-1)+1,i-1,i,i+m-1);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1643701806,
        "uid": 105611,
        "name": "IdnadRev",
        "ccfLevel": 0,
        "title": "\u3010Str\u8bb0\u5f55\u3011CF1598G The Sum of Good Numbers"
    }
]
[
    {
        "content": "\u9898\u76ee\u5373\u662f\u8ba9\u4f60\u6c42\uff1a\n\n$\\sum_{a_1 = 1}^n\\sum_{a_2 = 1}^n\\cdots\\sum_{a_f=1}^n[\\gcd(a_1,a_2,\\cdots,a_f) = 1][a_1 + a_2 + \\cdots + a_f = n]$\n\n\u6211\u4eec\u6b64\u5904\u7b80\u5316\u4e3a\u8ba8\u8bba\u4e24\u4e2a\u6570\u3002\n\n$\\sum_{i = 1}^n\\sum_{j = 1}^n[\\gcd(i,j) = 1][i + j = n]$\n\n\u628a $\\gcd = 1$ \u62c6\u6389\uff1a\n\n$\\sum_{i = 1}^n\\sum_{j = 1}^n\\sum_{d|\\gcd(i,j)} \\mu(d) [i + j = n]$\n\n\u5957\u8def\uff0c\u6539\u4e3a\u679a\u4e3e\u500d\u6570\uff1a\n\n$\\sum_{d = 1}^n\\mu(d)\\sum_{i = 1}^{\\frac{n}{d}}\\sum_{j = 1}^{\\frac{n}{d}}[i + j = \\frac{n}{d}]$\n\n\u9996\u5148\uff0c\u5e8f\u5217\u91cc\u7684\u6570\u90fd\u662f\u6574\u6570\uff0c\u6240\u4ee5 $\\frac{n}{d}$ \u4e00\u5b9a\u4e3a\u6574\u6570\uff0c\u90a3\u4e48 $d$ \u5fc5\u7136\u662f $n$ \u7684\u56e0\u6570\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u6839\u53f7\u679a\u4e3e\u56e0\u6570\u3002\n\n\u7136\u540e\uff0c\u8981\u7b97\u51fa\u6709\u591a\u5c11\u79cd\u6784\u9020\u5e8f\u5217\u7684\u65b9\u6cd5\uff0c\u4f7f\u5f97\u6240\u6709\u6570\u7684\u548c\u4e3a $\\frac{n}{d}$\u3002\n\n\u5c0f\u5b66\u5965\u6570\u5185\u5bb9\uff0c\u63d2\u677f\u6cd5\uff0c\u76f8\u5f53\u4e8e\u6709 $\\frac{n}{d}$ \u4e2a $1$ \uff0c\u5728\u4e2d\u95f4\u63d2\u677f\uff0c\u6bcf\u4e00\u79cd\u4e0d\u540c\u7684\u63d2\u677f\u7684\u4f4d\u7f6e\u663e\u7136\u5bf9\u5e94\u4e0d\u540c\u7684\u5206\u89e3\u65b9\u5f0f\uff0c\u5e76\u4e14\u548c\u4e00\u5b9a\u3002\n\n$\\frac{n}{d}$ \u4e2a $1$ \uff0c\u6709 $\\frac{n}{d} - 1$  \u4e2a\u7a7a\u95f4\uff08\u4e0d\u53ef\u4ee5\u4e3a 0 \uff09\uff0c\u8981\u63d2 $f - 1$ \u5757\u677f\uff08\u5206\u6210 $f$ \u5757\uff09\uff0c\u663e\u7136\u662f\u7ec4\u5408\u6570\u3002\n\n\u4e8e\u662f\u679a\u4e3e\u56e0\u6570\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u56e0\u6570\u53e0\u52a0\u7ec4\u5408\u6570\u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\n\n#define int long long\n#define mem(x,y) memset(x,y,sizeof(x))\n#define frein freopen(\"in.in\",\"r\",stdin)\n#define freout freopen(\"out.out\",\"w\",stdout)\n#define debug(x) cout << (#x) << \" = \" << x << endl;\n\nusing namespace std;\n\nint read(){\n   int s = 0,w = 1;\n   char ch = getchar();\n   while(ch < '0' || ch > '9'){if(ch == '-')w = -1;ch = getchar();}\n   while(ch >= '0' && ch <= '9')s = s * 10 + ch - '0',ch = getchar();\n   return s * w;\n}\n\nint t;\nint n,m;\nbool isprime[1000010];\nint prime[1000010];\nint cnt;\nint mu[1000010];\nint fac[1000010];\nint inv[1000010];\nint finv[1000010];\nconst int mod = 1e9 + 7;\n\nvoid init(){\n\tn = 100000;\n\tfac[0] = fac[1] = inv[1] = finv[1] = inv[0] = finv[0] = 1;\n\tfor(int i = 2;i <= n;i ++){\n\t\tfac[i] = (fac[i - 1] * i) % mod;\n\t\tinv[i] = (mod - mod / i) * inv[mod % i] % mod;\n\t}\n\tfor(int i = 2;i <= n;i ++)finv[i] = (finv[i - 1] * inv[i]) % mod;\n\tmu[1] = 1;\n\tfor(int i = 2;i <= n;i ++){\n\t\tif(!isprime[i]){\n\t\t\tprime[++ cnt] = i;\n\t\t\tmu[i] = -1;\n\t\t}\n\t\tfor(int j = 1;j <= cnt && i * prime[j] <= n;j ++){\n\t\t\tisprime[i * prime[j]] = true;\n\t\t\tif(i % prime[j])mu[i * prime[j]] = -mu[i];\n\t\t\telse break;\n\t\t}\n\t}\n}\n\nint C(int x,int y){\n\tif(x > y)return 0;\n\treturn fac[y] * finv[y - x] % mod * finv[x] % mod;\n}\n\nsigned main(){\n\tinit();\n\tcin>>t;\n\twhile(t --){\n\t\tn = read(),m = read();\n\t\tint ans = 0;\n\t\tfor(int i = 1;i * i <= n;i ++){\n\t\t\tif(n % i == 0){\n\t\t\t\tans = (ans + mu[i] * C(m - 1,n / i - 1)) % mod;\n\t\t\t\tif(n / i != i)ans = (ans + mu[n / i] * C(m - 1,i - 1)) % mod;\n\t\t\t}\n\t\t}\n\t\tprintf(\"%lld\\n\",(ans + mod) % mod);\n\t}\n}\n```",
        "postTime": 1640094525,
        "uid": 294562,
        "name": "EDqwq",
        "ccfLevel": 7,
        "title": "CF439E Devu and Birthday Celebration \u9898\u89e3"
    },
    {
        "content": "[CF439E Devu and Birthday Celebration](https://www.luogu.com.cn/problem/CF439E)\n\n\u770b\u9898\u89e3\u91cc\u9762\u5168\u662f$\u03bc$\u51fd\u6570\uff0c\u6211\u6765\u8865\u4e00\u7bc7\u5bb9\u65a5\u539f\u7406\u7684\u9898\u89e3\u3002\n\n\u57fa\u672c\u601d\u8def\uff1a\u6211\u4eec\u53ef\u4ee5\u5f88\u5bb9\u6613\u6c42\u51fa\u6765\u5982\u679c\u6ca1\u6709$gcd(a_1 , a_2 \u2026\u2026a_f) = 1$\u9650\u5236\u7684\u65b9\u6848\u6570\uff0c\u5373\u8003\u8651\u9694\u677f\u6cd5$C_{n - 1}^{f - 1}$\u53ef\u662f\u8fd9\u65f6\u4e0d\u514d\u4f1a\u51fa\u73b0\u4e00\u4e9b$gcd$\u4e0d\u4e3a1\u7684\u7ec4\u5408$i$\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e$n$\u7684\u7ea6\u6570\uff0c\u7136\u540e\u51cf\u53bb$gcd$\u6070\u597d\u4e3a$i$\u7684\u65b9\u6848\u6570\uff0c\u6700\u7ec8\u5c31\u662f\u6211\u4eec\u7684\u7b54\u6848\u5566\n\n\u5177\u4f53\u6765\u8bf4\uff0c\u6211\u4eec\u4f7f\u7528\u8bb0\u5fc6\u5316\u641c\u7d22\u6765\u5b8c\u6210\u6211\u4eec\u7684$dp$\u8fc7\u7a0b\uff0c\u8bbe$f[s , l]$\u8868\u793a\u6211\u73b0\u5728\u8981\u628a$s$\u5206\u6210$l$\u4e2a\u5408\u6cd5\u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u5f53\u6211\u4eec\u7684$s$\u4e3a\u8d28\u6570\u7684\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u65e0\u8bba\u5982\u4f55\u5206\uff08\u6bcf\u4e2a\u5206\u5f97\u7684\u6570\u81f3\u5c11\u4e3a1\uff09\uff0c\u5176\u4e0d\u53ef\u80fd\u51fa\u73b0$gcd$\u5927\u4e8e1\n\n\u8bc1\u660e\uff1a\u5982\u679c$gcd$\u5927\u4e8e1\uff0c\u90a3\u4e48\u4e5f\u5c31\u662f\u8bf4$s$\u9664\u53bb$gcd$\u540e\u4ecd\u7136\u662f\u4e2a\u6574\u6570\uff0c\u4e0e$s$\u662f\u4e2a\u8d28\u6570\u76f8\u77db\u76fe\n\n\u6240\u4ee5\u5982\u679c$s$\u4e3a\u8d28\u6570\u7684\u65f6\u5019\uff0c\u65b9\u6848\u6570\u5c31\u4e3a$C_{s - 1}^{l - 1}$\n\n\u5f53$s$ \u4e0d\u662f\u8d28\u6570\u7684\u65f6\u5019\uff0c\u5982\u679c$l > s$\u76f4\u63a5\u8fd4\u56de0 \u5c31\u53ef\u4ee5\uff0c\u56e0\u4e3a\u4e0d\u591f\u6bcf\u4eba\u4e00\u4e2a\u7cd6(\u5982\u679c\u5b81\u597d\u5947\u4e3a\u5565\u8fd9\u56de\u51fa\u6765\u201c\u4eba\u201d\u548c\u201c\u7cd6\u201d\uff0c\u5b81\u53ef\u4ee5\u53bb\u5eb7\u5eb7\u82f1\u6587\u9898\u9762\uff09\n\n\u5426\u5219\uff0c\u6211\u4eec\u5148\u6c42\u51fa\u6765\u603b\u7684\u65b9\u6848\u6570$C_{s - 1}^{l - 1}$,\u4e4b\u540e$O(\\sqrt n)$\u679a\u4e3e\u5176\u7ea6\u6570$i$\u9012\u5f52\u6c42$f[s/i , l]$\u4e5f\u5c31\u662f\u8bf4\u6211\u679a\u4e3e\u4e86\u4ed6\u4eec\u7684$gcd$\uff0c\n\u51cf\u53bb$gcd$\u6070\u597d\u4e3a$i$\u7684\u65b9\u6848\u6570\n\n\u6709\u4e00\u70b9\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u6211\u4eec\u5e76\u4e0d\u80fd\u5f00\u4e0b$f[1e5 , 1e5]$\u7684\u8bb0\u5fc6\u5316\u6570\u7ec4\uff0c\u6240\u4ee5\u6211\u4eec\u9009\u62e9\u79bb\u7ebf\u5904\u7406\uff0c\u5c06\u8be2\u95ee\u6309\u7167$l$\u6392\u5e8f\uff0c\u56e0\u4e3a\u6211\u4eec\u53d1\u73b0$l$\u4e0d\u540c\u7684\u662f\u4e92\u4e0d\u5e72\u6270\u7684\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6bcf\u4e2a$l$\u7684\u8be2\u95ee\u6211\u5355\u72ec\u8bb0\u5fc6\u5316\u641c\u7d22\uff0c\u5f53$l$\u6539\u53d8\u65f6\uff0c\u6211\u5c31\u4e0d\u7ba1\u522b\u7684$l$\u7684\u503c\uff0c\u5373\u76f4\u63a5\u8986\u76d6\u5c31\u53ef\u4ee5\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u5c31\u53d8\u4e3a\u4e86$O(n)$\u3002\n\n\u53ef\u4ee5\u7279\u6b8a\u5224\u65ad\u7684\u4e00\u70b9\u5c31\u662f\u5f53$l = 1$\u7684\u65f6\u5019\uff0c\u770b\u4e00\u4e0b\u6211\u7684$s$\u662f\u591a\u5c11\uff0c\u5982\u679c\u662f1\uff0c\u90a3\u4e48\u65b9\u6848\u6570\u5c31\u662f1\uff0c\u5426\u5219\u4e3a0.\n\n$ code:$\n```\n#include <cstdio>\n#include <algorithm>\n#include <cctype>\nusing namespace std;\ninline int read()\n{\n\tint res = 0;\n\tchar c;\n\tbool flag = false;\n\tc = getchar();\n\twhile(!isdigit(c))\n\t{\n\t\tflag = (c == '-');\n\t\tc = getchar();\n\t}\n\twhile(isdigit(c))\n\t{\n\t\tres = res * 10 + (c ^ 48);\n\t\tc = getchar();\n\t}\n\treturn !flag ? res : -res;\n}\ntypedef long long ll;\nconst int MOD = 1e9 + 7;\nconst int Max_n = 1e5 + 5;\nll jc[Max_n];\nstruct Node\n{\n\tint sum, len , id;\n\tNode(int a , int b)\n\t{\n\t\tsum = a , len = b;\n\t}\n\tNode(int a , int b , int c)\n\t{\n\t\tsum = a , len = b , id = c;\n\t}\n\tNode() {}\n} query[Max_n] , f[Max_n];\ninline bool cmp(Node a , Node b)\n{\n\treturn a.len < b.len;\n}\nint prime[Max_n] , vis[Max_n] , tot , maxn;\ninline int quickpow(ll x , int y)\n{\n\tll ret = 1;\n\twhile(y)\n\t{\n\t\tif(y & 1)\tret *= x , ret %= MOD;\n\t\tx *= x , x %= MOD;\n\t\ty >>= 1;\n\t}\n\treturn ret;\n}\ninline int ni(int x)\n{\n\treturn quickpow(x , MOD - 2);\n}\ninline int C(int n , int m)\n{\n\tif(m > n)\treturn 0;\n\treturn jc[n] * ni(jc[m] * jc[n - m] % MOD) % MOD;\n}\ninline ll dfs(int s , int l)//s candys need to be divided by l people;\n{\n\tif(s < l)\n\t{\n\t\tf[s] = Node(0 , l);\n\t\treturn 0;\n\t}\n\tif(f[s].len == l)\treturn f[s].sum;\n\tif(s == prime[vis[s]])\n\t{\n\t\tf[s] = Node(C(s - 1 , l - 1) , l);\n\t\treturn f[s].sum;\n\t}\n\tll val = C(s - 1 , l - 1);\n\tfor(int i = 2 ; i * i <= s ; ++ i)\n\t{\n\t\tif(s % i)\tcontinue;\n\t\tval -= dfs(s / i , l) , val %= MOD;\n\t\tif(i * i == s)\tbreak;\n\t\tval -= dfs(s / (s / i) , l) , val %= MOD;\n\t}\n\tval = (val + MOD) % MOD;\n\tf[s] = Node(val , l);\n\treturn val;\n}\ninline void build()\n{\n\tvis[1] = 0;\n\tprime[0] = 1;\n\tfor(int i = 2 ; i <= maxn ; ++ i)\n\t{\n\t\tif(!vis[i])\n\t\t{\n\t\t\tprime[ ++ tot] = i;\n\t\t\tvis[i] = tot;\n\t\t}\n\t\tfor(int j = 1 ; j <= tot && (ll) i * prime[j] <= maxn; ++ j)\n\t\t{\n\t\t\tvis[i * prime[j]] = j;\n\t\t\tif(i % prime[j] == 0)\tbreak;\n\t\t}\n\t}\n}\nll ans[Max_n];\nint main()\n{\n\tint q = read();\n\tfor(int i = 1 ; i <= q ; ++ i)\n\t{\n\t\tint ui = read() , vi = read();\n\t\tmaxn = max(ui , maxn);\n\t\tquery[i] = Node(ui , vi , i);\n\t}\n\tbuild();\n\tjc[0] = 1;\n\tfor(int i = 1 ; i <= maxn ; ++ i)\n\t\tjc[i] = jc[i - 1] * i % MOD;\n\tsort(query + 1 , query + q + 1 , cmp);\n\tfor(int i = 1 ; i <= q ; ++ i)\n\t{\n\t\tif(query[i].len == 1)\tans[query[i].id] = (query[i].sum == 1);\n\t\telse ans[query[i].id] = dfs(query[i].sum , query[i].len);\n\t}\n\tfor(int i = 1 ; i <= q ; ++ i)\n\t\tprintf(\"%lld\\n\" , ans[i]);\n\treturn 0;\n}\n```\n",
        "postTime": 1601103508,
        "uid": 247650,
        "name": "thecold",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF439E \u3010Devu and Birthday Celebration\u3011"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.com.cn/problem/CF439E)\n\n\u9898\u610f\uff1a$Q$\u6b21\u8be2\u95ee\uff0c\u7ed9\u5b9a$n$\u548c$f$\uff0c\u6c42\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u7684\u5e8f\u5217$\\{a_i\\}$\u7684\u6570\u91cf\n\n$\\displaystyle \\sum_{i=1}^{f}a_i=n\\quad \\gcd(a_1,a_2,...,a_f)=1$\n\n$1\\leq f\\leq n\\leq 10^5\\quad Q\\leq 10^5$\n\n$\\displaystyle \\sum_{a_1=1}^{n}\\sum_{a_2=1}^{n}...\\sum_{a_f=1}^{n}[\\sum_{i=1}^{f}a_i=n,\\gcd(a_i)=1]$\n\n$\\displaystyle =\\sum_{a_1=1}^{n}\\sum_{a_2=1}^{n}...\\sum_{a_f=1}^{n}[\\sum_{i=1}^{f}a_i=n]\\sum_{d\\mid \\gcd(a_i)}\\mu(d)$\n\n$\\displaystyle =\\sum_{d=1}^{n}\\mu(d)\\sum_{d\\mid a_1}^{n}\\sum_{d\\mid a_2}^{n}...\\sum_{d\\mid a_f}^{n}[\\sum_{i=1}^{f}a_i=n]$\n\n$\\displaystyle =\\sum_{d=1}^{n}\\mu(d)\\sum_{a_1=1}^{n/d}\\sum_{a_2=1}^{n/d}...\\sum_{a_f=1}^{n/d}[\\sum_{i=1}^{f}a_i=\\frac{n}{d}]$\n\n\u7136\u540e\u679a\u4e3e\u4e00\u4e0b$d$\uff0c\u5148\u5224\u65ad$d$\u662f\u5426\u6574\u9664$n$\uff0c\u5982\u679c\u6574\u9664\uff0c\u5c31\u76f4\u63a5\u9694\u677f\u6cd5\u7b97\u540e\u9762\u90a3\u4e00\u5768\u5c31\u53ef\u4ee5\u4e86\n\n\u6ce8\u610f\u5230\u8fd9\u91cc$a_i$\u90fd\u662f\u6b63\u6574\u6570\n    \n\u5982\u679c\u628a$n$\u5206\u6210$m$\u4efd\uff0c\u4e14\u6bcf\u4e00\u4efd\u4e0d\u80fd\u4e3a\u7a7a\n    \n\u65b9\u6848\u6570\u4e3a$\\binom{n-1}{m-1}$\n\n\u5982\u679c\u53ef\u4ee5\u4e3a\u7a7a\uff0c\u5c31\u662f$\\binom{n+m-1}{m-1}$\uff08\u4e0e\u6b64\u9898\u65e0\u74dc\uff09\n\n\u9884\u5904\u7406\u4e00\u4e0b$\\mu$\u51fd\u6570\uff0c\u9636\u4e58\u548c\u9636\u4e58\u7684\u9006\u5143\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$O(Q\\times \\sqrt{n})$\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#define ll long long\nusing namespace std;\nconst int N=1e5;\nconst ll mod=1e9+7;\nint vis[N+10],prim[N+10];\nll fac[N+10],inv[N+10],miu[N+10];\ninline ll power(ll a,ll b)\n{\n\tll res=1;\n\twhile(b)\n\t{\n\t\tif(b&1) res=res*a%mod;\n\t\tb>>=1;\n\t\ta=a*a%mod;\n\t}\n\treturn res;\n}\ninline ll C(int n,int m)\n{\n\tif(n<m) return 0;\n\treturn fac[n]*inv[m]%mod*inv[n-m]%mod;\n}\ninline void pre()\n{\n\tfac[0]=1;\n\tfor(int i=1;i<=N;i++)\n\t\tfac[i]=fac[i-1]*i%mod;\n\tinv[N]=power(fac[N],mod-2);\n\tfor(int i=N-1;i>=0;i--)\n\t\tinv[i]=inv[i+1]*(i+1)%mod;\n\tmiu[1]=1;\n\tint cnt=0;\n\tfor(int i=2;i<=N;i++)\n\t{\n\t\tif(!vis[i]) vis[i]=1,prim[++cnt]=i,miu[i]=-1;\n\t\tfor(int j=1;j<=cnt&&i*prim[j]<=N;j++)\n\t\t{\n\t\t\tvis[i*prim[j]]=1;\n\t\t\tif(i%prim[j]) miu[i*prim[j]]=-miu[i];\n\t\t\telse{ miu[i*prim[j]]=0; break; }\n\t\t}\n\t}\n}\nint main()\n{\n\tpre();\n\tint T;\n\tscanf(\"%d\",&T);\n\twhile(T--)\n\t{\n\t\tint n,m,k; ll ans=0;\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tfor(int i=1;i<=sqrt(n);i++)\n\t\t{\n\t\t\tif(n%i) continue;\n\t\t\tans=(ans+miu[i]*C(n/i-1,m-1)%mod+mod)%mod;\n\t\t\tif(n/i!=i) ans=(ans+miu[n/i]*C(i-1,m-1)%mod+mod)%mod;\n\t\t}\t\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n\n  ",
        "postTime": 1598262306,
        "uid": 81238,
        "name": "MCAdam",
        "ccfLevel": 7,
        "title": "CF439E Devu and Birthday Celebration"
    },
    {
        "content": "### \u9898\u610f\n\n- $q$ \u6b21\u8be2\u95ee\u3002\u6bcf\u6b21\u8be2\u95ee\u7ed9\u51fa $n,f$\uff0c\u6c42\u6709\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u5e8f\u5217 $\\left\\{a_i\\right\\}_{i=1}^f$ \u6ee1\u8db3\uff1a$\\displaystyle \\sum_{i=1}^f a_i =n$\uff1b$\\gcd\\left(a_1,\\dots,a_f\\right)=1$\uff0c\u7b54\u6848\u5bf9 $10^9+7$ \u53d6\u6a21\u3002\n- $1\\le q\\le 10^5,1\\le f\\le n\\le 10^5$\u3002\n\n### \u505a\u6cd5\n\n\u7b54\u6848\u4e3a\n\n$$\\begin{aligned}\\sum_{a_1=1}^n\\sum_{a_2=1}^n\\cdots\\sum_{a_f=1}^n \\left[\\gcd\\left\\{a_i\\right\\}=1 \\right]\\left[\\sum_{i=1}^f a_i=n \\right] &=\\sum_{a_1=1}^n\\sum_{a_2=1}^n\\cdots\\sum_{a_f=1}^n\\left[\\sum_{i=1}^f a_i=n\\right] \\sum_{d\\mid \\gcd \\left\\{a_i\\right\\}}\\mu(d)\\\\&=\\sum_{d\\mid n}\\mu(d)\\sum_{a_1=1}^{\\frac nd}\\sum_{a_2=1}^{\\frac nd}\\cdots\\sum_{a_f=1}^{\\frac nd}\\left[\\sum_{i=1}^f a_i=\\dfrac nd\\right]  \\end{aligned}$$\n\n$\\displaystyle \\sum_{d\\mid n} \\mu(d)$ \u53ef\u4ee5 $O\\left(\\sqrt n\\right)$ \u679a\u4e3e\u56e0\u5b50\u5b9e\u73b0\uff0c\u5173\u952e\u5728\u4e8e\u540e\u9762\u4e00\u5768\u3002\n\n\u7528\u63d2\u677f\u6cd5\u53bb\u8003\u8651\uff0c\u6709 $\\dfrac nd$ \u4e2a\u70b9\uff0c$a_i$ \u4ece $1$ \u5f00\u59cb\u679a\u4e3e\uff0c\u6240\u4ee5\u6709 $\\dfrac nd-1$ \u4e2a\u7a7a\u3002\u6700\u540e\u8981\u5206\u6210 $f$ \u6bb5\uff0c\u5373\u63d2 $f-1$ \u4e2a\u677f\uff0c\u6240\u4ee5\u7b54\u6848\u5c31\u662f $\\Large\\tbinom{\\frac nd -1}{f-1}$ \u3002\n\n\u6700\u540e\u5f0f\u5b50\u5c31\u662f $\\displaystyle \\sum_{d\\mid n}\\mu(d)\\tbinom{\\frac nd -1}{f-1}$\u3002\n\n$O(n)$ \u5904\u7406\u9006\u5143\uff0c\u524d\u7f00\u79ef\uff0c$\\mu$ \u51fd\u6570\u3002$O(q\\sqrt n)$ \u8be2\u95ee\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define mod 1000000007\nusing namespace std;\nint q,cnt;\nint inv[100005],fac[100005];\nint mu[100005],prime[100005];\nbitset<100005>used;\ninline int read()\n{\n\tint x=0,f=1;char c=getchar();\n\twhile(c<'0'||c>'9'){if(c=='-')f=-f;c=getchar();}\n\twhile(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n\treturn x*f;\n}\ninline void sieve(int n)\n{\n\tmu[1]=1;\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tif(!used[i])\tprime[++cnt]=i,mu[i]=-1;\n\t\tfor(int j=1;j<=cnt&&i*prime[j]<=n;j++)\n\t\t{\n\t\t\tused[i*prime[j]]=1;\n\t\t\tif(i%prime[j])\tmu[i*prime[j]]=-mu[i];\n\t\t\telse\tbreak;\n\t\t}\n\t}\n}\ninline int getc(int n,int m)\n{\n\tif(n<m)\treturn 0;\n\treturn 1ll*fac[n]*inv[m]%mod*inv[n-m]%mod;\n}\nint main()\n{\n\tq=read();\n\tsieve(100000),inv[0]=inv[1]=1,fac[0]=1;\n\tfor(int i=1;i<=100000;i++)\tfac[i]=1ll*fac[i-1]*i%mod;\n\tfor(int i=2;i<=100000;i++)\tinv[i]=1ll*(mod-mod/i)*inv[mod%i]%mod;\n\tfor(int i=2;i<=100000;i++)\tinv[i]=1ll*inv[i]*inv[i-1]%mod;\n\twhile(q--)\n\t{\n\t\tint n=read(),f=read(),ans=0;\n\t\tfor(int d=1;d*d<=n;d++)\n\t\t{\n\t\t\tif(n%d!=0)\tcontinue;\n\t\t\tans=(ans+mu[d]*getc(n/d -1,f-1)%mod)%mod;\n\t\t\tif(d*d!=n)\tans=(ans+mu[n/d]*getc(d-1,f-1)%mod)%mod;\n\t\t}\n\t\tprintf(\"%d\\n\",(ans%mod+mod)%mod);\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1638579190,
        "uid": 181775,
        "name": "_Fontainebleau_",
        "ccfLevel": 0,
        "title": "\u300cCF439E Devu and Birthday Celebration\u300d"
    },
    {
        "content": "$$\\sum_{i_1=1}^n\\sum_{i_2=1}^n...\\sum_{i_f=1}^n [\\sum{a_i}=n][\\gcd{a_i}=1]$$\n\n$$\\sum_{i_1=1}^n\\sum_{i_2=1}^n...\\sum_{i_f=1}^n [\\sum{a_i}=n]\\sum_{d|\\gcd{a_i}} \\mu(d)$$\n\n$$\\sum_{d|n} \\mu(d) \\sum_{i_1=1}^{\\frac{n}{d}}\\sum_{i_2=1}^{\\frac{n}{d} }...\\sum_{i_f=1}^{\\frac{n}{d}} [\\sum{a_i}=\\frac{n}{d}]$$\n\n\u540e\u9762\u679a\u4e3e $i$ \u7684\u8fc7\u7a0b\u53ef\u4ee5\u770b\u4f5c\u5c06 $\\frac{n}{d}$ \u4e2a\u76f8\u540c\u7684\u7403\u653e\u8fdb $f$ \u4e2a\u4e0d\u540c\u7684\u76d2\u5b50\uff0c\u4e14\u4e0d\u80fd\u6709\u7a7a\u76d2\u7684\u65b9\u6848\u6570\uff0c\u5229\u7528\u63d2\u677f\u6cd5\u53ef\u5f97\uff1a $\\binom{\\frac{n}{d}-1}{f-1}$\n\n\u90a3\u4e48\u539f\u5f0f\u5373\u4e3a\uff1a\n\n$$\\sum_{d|n} \\mu(d) \\binom{\\frac{n}{d} - 1 }{f-1}$$\n\n```cpp\n#include <cstdio>\n\nconst int MAXN = 1e5 , Mod = 1e9 + 7;\n\nint Quick_pow( int x , int po ) { int p = 1; for( ; po ; po >>= 1 , x = 1ll * x * x % Mod ) if( po & 1 ) p = 1ll * p * x % Mod; return p; }\nint Inv( int x ) { return Quick_pow( x , Mod - 2 ); }\n\nint prnum , prime[ MAXN + 5 ] , mu[ MAXN + 5 ];\nbool vis[ MAXN + 5 ];\nvoid sieve( ) {\n\tmu[ 1 ] = 1;\n\tfor( int i = 2 ; i <= MAXN ; i ++ ) {\n\t\tif( !vis[ i ] ) {\n\t\t\tprime[ ++ prnum ] = i;\n\t\t\tmu[ i ] = -1;\n\t\t}\n\t\tfor( int j = 1 ; j <= prnum && i * prime[ j ] <= MAXN ; j ++ ) {\n\t\t\tvis[ i * prime[ j ] ] = 1;\n\t\t\tif( i % prime[ j ] == 0 ) break;\n\t\t\tmu[ i * prime[ j ] ] = -mu[ i ];\n\t\t}\n\t}\n}\nint fac[ MAXN + 5 ] , ivf[ MAXN + 5 ];\nvoid Init( ) {\n\tfac[ 0 ] = 1;\n\tfor( int i = 1 ; i <= MAXN ; i ++ ) fac[ i ] = 1ll * fac[ i - 1 ] * i % Mod;\n\tivf[ MAXN ] = Inv( fac[ MAXN ] );\n\tfor( int i = MAXN ; i >= 1 ; i -- ) ivf[ i - 1 ] = 1ll * ivf[ i ] * i % Mod;\n}\nint C( int n , int m ) {\n\treturn n < m ? 0 : 1ll * fac[ n ] * ivf[ m ] % Mod * ivf[ n - m ] % Mod;\n}\n\n\nint Solve( int n , int f ) {\n\tint Ans = 0;\n\tfor( int d = 1 ; d * d <= n ; d ++ )\n\t\tif( n % d == 0 ) {\n\t\t\tAns = ( Ans + mu[ d ] * C( n / d - 1 , f - 1 ) ) % Mod;\n\t\t\tif( d * d != n ) Ans = ( Ans + mu[ n / d ] * C( d - 1 , f - 1 ) ) % Mod;\n\t\t}\n\treturn ( Ans + Mod ) % Mod;\n}\n\nint q , n , f;\nint main( ) {\n\tInit(); sieve();\n\tscanf(\"%d\",&q);\n\twhile( q -- ) {\n\t\tscanf(\"%d %d\",&n,&f);\n\t\tprintf(\"%d\\n\", Solve( n , f ) );\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1612151783,
        "uid": 123802,
        "name": "chihik",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF439E \u3010Devu and Birthday Celebration\u3011"
    },
    {
        "content": "\u4e00\u9053\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u540e\u7ec4\u5408\u610f\u4e49\u7684\u9898\uff0c\u6709\u70b9\u6709\u8da3\u3002\n\n### $Solution:$\n\n\u76f4\u63a5\u4e00\u901a\u4e71\u641e\u63a8\u5f0f\u5b50\uff1a\n\n$$\\begin{aligned}\\text{\u539f\u5f0f}&=\\sum_{a_1=1}^n\\sum_{a_2=1}^n...\\sum_{a_f=1}^n[\\gcd\\{a_i\\}=1\\land\\sum_{i=1}^fa_i=n]\\\\&=\\sum_{a_1=1}^n\\sum_{a_2=1}^n...\\sum_{a_f=1}^n[\\sum_{i=1}^fa_i=n]\\sum_{d\\mid \\gcd\\{a_i\\}}\\mu(d)\\\\&=\\sum_{d\\mid n}\\mu(d)\\sum_{a_1=1}^{\\frac{n}{d} }\\sum_{a_2=1}^{\\frac{n}{d} }...\\sum_{a_f=1}^{\\frac{n}{d}}[\\sum_{i=1}^fa_i=\\frac{n}{d} ]\\end{aligned}$$\n\n\u9996\u5148\u6709\u4e00\u4e2a\u70b9\uff0c$d$ \u4e00\u5b9a\u8981\u4e3a $n$ \u7684\u7ea6\u6570\uff0c\u56e0\u4e3a $a_i$ \u5747\u4e3a\u6574\u6570\u3002\u8fd9\u5c31\u662f\u8fd9\u91cc $d\\mid n$ \u7684\u7531\u6765\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e $n$ \u7684\u6240\u6709\u7ea6\u6570\uff0c\u7ebf\u6027\u7b5b\u9884\u5904\u7406 $\\mu$\uff0c\u5c31\u53ea\u5269\u4e0b\u6700\u540e\u90a3\u4e00\u5806\u4e86\u3002\n\n\u8003\u8651\u7ec4\u5408\u610f\u4e49\u3002\u8fd9\u5c31\u662f\u628a $\\dfrac{n}{d}$ \u4e2a\u76f8\u540c\u7684\u5c0f\u9c7c\u5206\u7ed9 $f$ \u4e2a\u4e0d\u540c\u7684\u732b\u5403\uff0c\u6bcf\u53ea\u732b\u90fd\u8981\u6709\u9c7c\u7684\u65b9\u6848\u6570\u3002\u4e8e\u662f\u76f4\u63a5\u63d2\u677f\u6cd5\u53ef\u5f97\u65b9\u6848\u6570\u4e3a $\\dbinom {\\frac{n}{d}-1} {f-1}$\uff0c\u6ce8\u610f $\\dfrac{n}{d}<f$ \u65f6\u65b9\u6848\u6570\u4e3a $0$\u3002\n\n\u4e8e\u662f\u8fd9\u9898\u5c31\u505a\u5b8c\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(N + q\\sqrt{N})$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\n\n### $Code:$\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\nusing namespace std;\n#define int long long\ninline int read(){\n    int x = 0, f = 1; char ch = getchar();\n    while(ch < '0' || ch > '9'){ if(ch == '-') f = -1; ch = getchar(); }\n    while(ch >= '0' && ch <= '9'){ x = x * 10 + (ch ^ 48); ch = getchar(); }\n    return x * f;\n}\nconst int N = 100000, mod = 1000000007;\nint q, n, f, fac[N + 10], inv[N + 10], mu[N + 10], pri[N + 10], len, ans; bool vis[N + 10];\ninline int fpow(int x, int p){ int ans = 1; for(; p; p >>= 1, x = x * x % mod) if(p & 1) ans = ans * x % mod; return ans; }\ninline void initfac(int n){\n\tfac[0] = 1;\n\tfor(int i = 1; i <= n; ++i) fac[i] = fac[i - 1] * i % mod;\n\tinv[n] = fpow(fac[n], mod - 2);\n\tfor(int i = n - 1; ~i; --i) inv[i] = inv[i + 1] * (i + 1) % mod;\n}//\u9884\u5904\u7406\u9636\u4e58\u548c\u9636\u4e58\u9006\u5143\ninline int C(int n, int m){ if(n < m) return 0; return fac[n] * inv[m] % mod * inv[n - m] % mod; }//\u7ec4\u5408\u6570\ninline void sieve(){\n\tmu[1] = 1;\n\tfor(int i = 2; i <= N; ++i){\n\t\tif(!vis[i]) pri[++len] = i, mu[i] = -1;\n\t\tfor(int j = 1; j <= len && i * pri[j] <= N; ++j){\n\t\t\tint k = i * pri[j]; vis[k] = 1;\n\t\t\tif(i % pri[j] == 0) break;\n\t\t\tmu[k] = -mu[i];\n\t\t}\n\t}\n}//\u7ebf\u6027\u7b5b\nsigned main(){\n\tq = read(); initfac(N); sieve();\n\twhile(q--){\n\t\tn = read(); f = read(); ans = 0;\n\t\tfor(int i = 1; i * i <= n; ++i){\n\t\t\tif(n % i != 0) continue;\n\t\t\tans = (ans + mu[i] * C(n / i - 1, f - 1) % mod) % mod;\n\t\t\tif(n != i * i) ans = (ans + mu[n / i] * C(i - 1, f - 1) % mod) % mod; \n\t\t}\n\t\tprintf(\"%lld\\n\", (ans % mod + mod) % mod);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1602566138,
        "uid": 147999,
        "name": "Warriors_Cat",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF439E \u3010Devu and Birthday Celebration\u3011"
    },
    {
        "content": "# \u63d0\u793a\u51e0\u4e2a\u7ec6\u8282\uff0c\u4e0d\u4f1a\u6d89\u53ca\u505a\u6cd5\n\n\u6570\u5b66\u8fd9\u4e1c\u897f\uff0c\u5199\u6cd5\u8fd8\u662f\u89c4\u8303\u70b9\u5427\u4ee5\u540e\u3002\u3002\u3002\n\n\u5199\u8fd9\u9898\u4e4b\u524d\u6211\u8ba1\u7b97\u7ec4\u5408\u6570\u7684\u65f6\u5019\u4ece\u6ca1\u5224\u8fc7\u5206\u5b50\u5c0f\u4e8e\u5206\u6bcd\uff08\u4e5f\u5c31\u662fm<n\uff09\u7684\u60c5\u51b5\uff0c\u88ab\u5361\u4e86\n\n\u8fd8\u6709\u5bf9\u9636\u4e58\u548c\u5176\u9006\u5143\u7684\u9884\u5904\u7406\uff0c0\u7684\u9636\u4e58\u53ca\u9006\u5143\u7684\u53d6\u503c\u4e5f\u4ece\u4e0d\u8003\u7a76\uff0c\u4e5f\u88ab\u5361\u4e86\uff080\u7684\u9636\u4e58\u4e00\u822c\u5904\u7406\u62101\uff0c0\u7684\u9006\u5143\u4e00\u822c\u4e5f\u5904\u7406\u62101\uff09\n\n1\u7684\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\uff0c\u4e5f\u5148\u8d4b\u62101\n\nem\u57fa\u672c\u4e0a\u5c31\u662f\u8fd9\u4e9b\u4e86\uff0c\u8fd8\u6709\u5c31\u662f\u6570\u5b66\u9898\u561b\uff0c\u538b\u884c\u6109\u5feb\uff01",
        "postTime": 1600934699,
        "uid": 286239,
        "name": "ql12345",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF439E \u3010Devu and Birthday Celebration\u3011"
    }
]
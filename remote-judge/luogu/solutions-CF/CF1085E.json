[
    {
        "content": "\u5927\u5206\u8ba8\u3002\n\n\u5982\u679c $a$ \u4e32\u548c $b$ \u4e32\u5f53\u524d\u4f4d\u4e4b\u95f4\u6709\u53ef\u7528\u7684\u5b57\u7b26\uff0c\u90a3\u4e48\u5c31\u586b\u4e0a\u8fd9\u4e2a\u5b57\u7b26\uff0c\u540e\u9762\u5c31\u53ef\u4ee5\u968f\u4fbf\u586b\u4e86\u3002  \n\u5982\u679c $a$ \u548c $b$ \u5f53\u524d\u4f4d\u662f\u4e00\u6837\u7684\uff0c\u90a3\u4e48\u663e\u7136\u53ea\u80fd\u586b\u8fd9\u4e2a\u5b57\u7b26\u3002  \n\u5426\u5219\u5c31\u628a $a$ \u548c $b$ \u5f53\u524d\u4f4d\u7f6e\u90fd\u8bd5\u4e00\u4e0b\uff0c\u5177\u4f53\u6765\u8bf4\uff0c\u662f\u679a\u4e3e\u5f53\u524d\u4f4d\u7f6e\u548c $a/b$ \u76f8\u540c\uff0c\u540e\u9762\u4e00\u4f4d\u586b\u6700\u5927/\u6700\u5c0f\u3002\n\n\u90a3\u4e48\u5c31\u6765\u8003\u8651\u600e\u4e48\u5b9e\u73b0\u8fd9\u4e2a\u4e1c\u897f\u3002\n\n1. \u5982\u679c\u5f53\u524d\u4f4d\u7f6e\u4e0a\u4e0b\u754c\u4e4b\u95f4\u6709\u7a7a\u7684\u3002\n\t1. \u5982\u679c $s$ \u8fd9\u4e00\u4f4d\u6ca1\u6709\u88ab\u6620\u5c04\u8fc7\u3002\n    \t1. \u5982\u679c\u4e0a\u4e0b\u754c\u4e4b\u95f4\u6709\u4e00\u4e2a\u5b57\u6bcd\u53ef\u7528\uff0c\u586b\u4e0a\u8fd9\u4e2a\u5b57\u6bcd\uff0c\u540e\u9762\u968f\u4fbf\u586b\u3002\n        2. \u5c1d\u8bd5\u538b\u7740\u4e0b\u754c\u884c\u4e0d\u884c\u3002\n        3. \u5c1d\u8bd5\u538b\u7740\u4e0a\u754c\u884c\u4e0d\u884c\u3002\n        3. \u5982\u679c\u90fd\u4e0d\u884c\u8fd4\u56de NO\u3002\n    2. \u5982\u679c\u88ab\u6620\u5c04\u8fc7\u4e86\u3002\n    \t1. \u6620\u5c04\u6210\u7684\u5b57\u6bcd\u5728\u4e0a\u4e0b\u754c\u4e2d\u95f4\u5219\u968f\u4fbf\u6784\u9020\u3002\n        2. \u5426\u5219\u5c1d\u8bd5\u4e0a\u4e0b\u754c\u884c\u4e0d\u884c\u3002\n2. \u5982\u679c\u4e0a\u4e0b\u754c\u662f\u4e00\u6837\u7684\u3002\n\t1. \u5982\u679c\u88ab\u6620\u5c04\u8fc7\u4e86\u3002  \n   \t\t\u548c\u5f53\u524d\u4e00\u6837\u5c31\u7ee7\u7eed\uff0c\u5426\u5219\u8fd4\u56de NO\u3002\n    2. \u6ca1\u88ab\u6620\u5c04\u8fc7\u5219\u586b\u4e0a\u5e76\u7ee7\u7eed\u3002\n3. \u5982\u679c\u4e0a\u4e0b\u754c\u4e0d\u4e00\u6837\u3002\n\t1. \u5c1d\u8bd5\u4e0a\u4e0b\u754c\u884c\u4e0d\u884c\u3002\n\n\u7136\u540e\u8003\u8651\u600e\u4e48\u201c\u5c1d\u8bd5\u201d\u3002\n\n1. \u5982\u679c\u538b\u7740\u4e0a\u754c\u3002\n\t2. \u5f53\u524d\u4f4d\u6ca1\u6709\u6620\u5c04\u8fc7\u3002\n    \t1. \u586b\u4e0a\u6700\u5c0f\u7684\uff0c\u5982\u679c\u5c0f\u4e8e\u4e0a\u754c\u5219\u540e\u9762\u968f\u4fbf\u6784\u9020\uff0c\u5927\u4e8e\u4e0a\u754c\u8fd4\u56de NO\uff0c\u5426\u5219\u586b\u4e86\u4e4b\u540e\u7ee7\u7eed\u5f80\u4e0b\u5904\u7406\u3002\n    3. \u5f53\u524d\u4f4d\u7f6e\u88ab\u6620\u5c04\u8fc7\u3002\n    \t1. \u5c0f\u4e8e\u4e0a\u754c\u968f\u4fbf\u6784\u9020\uff0c\u5927\u4e8e\u4e0a\u754c\u8fd4\u56de NO\uff0c\u5426\u5219\u7ee7\u7eed\u5f80\u4e0b\u3002\n2. \u4e0b\u754c\u4e5f\u662f\u7c7b\u4f3c\u7684\u3002\n\n\u7136\u540e\u5c31\u5199\u6210\u4e86\u8fd9\u6837 130+ \u884c\u7684\u4ee3\u7801\u3002  \n\n\u4e00\u770b cf \u6700\u77ed\u89e3\u53d1\u73b0\u53ea\u6709 40 \u884c\uff0c\u6211\u4e5f\u4e0d\u77e5\u9053\u4ed6\u600e\u4e48\u505a\u5230\u7684 /dk\u3002\n\n\n```cpp\n#include <bits/stdc++.h>\n// #define DEBUG\nnamespace Qiaoqia { \nstd::string s, a, b;\nint k;\nstd::string con(int p, std::vector<int> map, std::vector<int> rec, int fg1, int fg2) {\n    std::vector<int> rem;\n    for (int i = 0; i < k; i++)\n        if (rec[i] == -1) rem.push_back(i);\n    if ((fg1 && fg2) || p == (int)s.size()) {\n        std::string res = \"YES\\n\";\n        for (int i = 0; i < k; i++)\n            if (map[i] == -1) {\n                map[i] = rem.back();\n                rec[rem.back()] = i; \n                rem.pop_back();\n            }\n        for (int i = 0; i < k; i++) res += char(map[i] + 'a');\n        #ifdef DEBUG\n        std::string _res;\n        for (auto c : s) _res += char(map[c - 'a'] + 'a');\n        if (_res >= a && _res <= b) std::cout << \"AC\";\n        else std::cout << \"WA(\" << _res << \")\";\n        return \"\";\n        #endif\n        return res;\n    }\n    else if (fg1) {\n        if (map[s[p] - 'a'] == -1) {\n            if (rem.size() && rem[0] < b[p] - 'a') {\n                auto tmap = map, trec = rec;\n                tmap[s[p] - 'a'] = rem[0], trec[rem[0]] = s[p] - 'a';\n                return con(p + 1, tmap, trec, 1, 1);\n            }\n            else if (rem.size() && rem[0] == b[p] - 'a') {\n                auto tmap = map, trec = rec;\n                tmap[s[p] - 'a'] = rem[0], trec[rem[0]] = s[p] - 'a';\n                return con(p + 1, tmap, trec, 1, 0);\n            }\n            else return \"NO\";\n        }\n        else {\n            if (map[s[p] - 'a'] < b[p] - 'a')\n                return con(p + 1, map, rec, 1, 1);\n            else if (map[s[p] - 'a'] == b[p] - 'a') \n                return con(p + 1, map, rec, 1, 0);\n            else return \"NO\";\n        }\n    }\n    else {\n        if (map[s[p] - 'a'] == -1) {\n            if (rem.size() && rem.back() > a[p] - 'a') {\n                auto tmap = map, trec = rec;\n                tmap[s[p] - 'a'] = rem.back(), trec[rem.back()] = s[p] - 'a';\n                return con(p + 1, tmap, trec, 1, 1);\n            }\n            else if (rem.size() && rem.back() == a[p] - 'a') {\n                auto tmap = map, trec = rec;\n                tmap[s[p] - 'a'] = rem.back(), trec[rem.back()] = s[p] - 'a';\n                return con(p + 1, tmap, trec, 0, 1);\n            }\n            else return \"NO\";\n        }\n        else {\n            if (map[s[p] - 'a'] > a[p] - 'a')\n                return con(p + 1, map, rec, 1, 1);\n            else if (map[s[p] - 'a'] == a[p] - 'a') \n                return con(p + 1, map, rec, 0, 1);\n            else return \"NO\";\n        }\n    }\n}\nvoid solve() {\n    std::cin >> k >> s >> a >> b;\n    if (a > b) return std::cout << \"NO\\n\", void();\n    std::vector<int> map(26, -1), rec(26, -1);\n    for (int i = 0; i < (int)a.size(); i++) {\n        bool flag = 0;\n        if (a[i] < b[i] - 1 && map[s[i] - 'a'] == -1) {\n            for (int j = a[i] + 1 - 'a'; j < b[i] - 'a'; j++)\n                if (rec[j] == -1) {\n                    auto tmap = map, trec = rec;\n                    tmap[s[i] - 'a'] = j, trec[j] = s[i] - 'a';\n                    std::cout << con(i + 1, tmap, trec, 1, 1) << '\\n';\n                    return;\n                }\n            flag = 1;\n        }\n        else if (a[i] < b[i] - 1 &&\n                 map[s[i] - 'a'] > a[i] - 'a' && \n                 map[s[i] - 'a'] < b[i] - 'a') \n            return std::cout << con(i + 1, map, rec, 1, 1) << '\\n', void();\n        else if (a[i] != b[i]) flag = 1;\n        else {\n            if (map[s[i] - 'a'] == -1 && rec[a[i] - 'a'] == -1) \n                map[s[i] - 'a'] = a[i] - 'a', rec[a[i] - 'a'] = s[i] - 'a';\n            else if (map[s[i] - 'a'] != a[i] - 'a' ||\n                     rec[a[i] - 'a'] != s[i] - 'a') \n                return std::cout << \"NO\\n\", void();\n        }\n        if (flag) {\n            auto tmap = map, trec = rec;\n            if (tmap[s[i] - 'a'] == -1 && trec[a[i] - 'a'] == -1) {\n                tmap[s[i] - 'a'] = a[i] - 'a', trec[a[i] - 'a'] = s[i] - 'a';\n                auto ans = con(i + 1, tmap, trec, 0, 1);\n                if (ans == \"NO\" && trec[b[i] - 'a'] == -1) {\n                    tmap = map, trec = rec;\n                    tmap[s[i] - 'a'] = b[i] - 'a', trec[b[i] - 'a'] = s[i] - 'a';\n                    std::cout << con(i + 1, tmap, trec, 1, 0) << '\\n';\n                    return;\n                }\n                else return std::cout << ans << '\\n', void();\n            }\n            else if (tmap[s[i] - 'a'] == -1 && trec[b[i] - 'a'] == -1) {\n                tmap[s[i] - 'a'] = b[i] - 'a', trec[b[i] - 'a'] = s[i] - 'a';\n                std::cout << con(i + 1, tmap, trec, 1, 0) << '\\n';\n                return;\n            }\n            else if (tmap[s[i] - 'a'] == a[i] - 'a')\n                return std::cout << con(i + 1, tmap, trec, 0, 1) << '\\n', void();\n            else if (tmap[s[i] - 'a'] == b[i] - 'a')\n                return std::cout << con(i + 1, tmap, trec, 1, 0) << '\\n', void();\n            else return std::cout << \"NO\\n\", void();\n        }\n    }\n    std::cout << con(s.size(), map, rec, 1, 1) << '\\n';    \n}\nvoid main() {\n\tint T;\n\tstd::cin >> T;\n\twhile (T--) solve();\n}\n}\nvoid _() { std::ios::sync_with_stdio(false), std::cin.tie(nullptr); }\nint main() { _(); Qiaoqia::main(); }\n```",
        "postTime": 1646289759,
        "uid": 499996,
        "name": "Qiaoqia",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1085E Vasya and Templates"
    }
]
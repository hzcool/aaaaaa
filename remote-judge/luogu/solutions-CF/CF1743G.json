[
    {
        "content": "\u5148\u65e0\u89c6\u7a7a\u95f4\u9650\u5236\uff0c\u8003\u8651\u7a7a\u95f4\u9650\u5236\u6b63\u5e38\u7684\u60c5\u51b5\u4e0b\u600e\u4e48\u505a\u3002\n\n\u9996\u5148\u53ef\u4ee5\u5904\u7406\u51fa\u6240\u6709\u6590\u6ce2\u90a3\u5951\u4e32\u7684\u54c8\u5e0c\u503c\u4ee5\u53ca $\\displaystyle\\sum_{i = 1}^n s_i$ \u7684\u54c8\u5e0c\u503c\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651 dp\uff0c\u8bbe $dp_i$ \u8868\u793a\u4ee5 $i$ \u7ed3\u5c3e\u7684\u4e32\u7684\u65e0\u6590\u6ce2\u90a3\u5951\u62c6\u5206\u6570\u3002\n\n\u521d\u503c\uff1a$dp_0 = 1$\u3002\n\n\u8f6c\u79fb\uff1a$dp_i = \\displaystyle\\sum_{j = 0}^{i - 1} [[i + 1, j] \\text{is not a fibonacci string}] f_j$\u3002\n\n\u6ce8\u610f\u5230\u82e5\u8bbe $m = |\\displaystyle\\sum_{i = 1}^n s_i|$\uff0c\u5219\u53ef\u80fd\u51fa\u73b0\u6590\u6ce2\u90a3\u5951\u4e32\u53ea\u6709 $O(\\log m)$ \u4e2a\uff0c\u4e8e\u662f\u6211\u4eec\u8bb0\u4e2a\u524d\u7f00\u548c\u5e76\u679a\u4e3e\u53ef\u80fd\u7684\u6590\u6ce2\u90a3\u5951\u4e32\u8f6c\u79fb\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(m \\log m)$\u3002\n\n\u73b0\u5728\u6211\u4eec\u6765\u8003\u8651\u5982\u4f55\u5361\u7a7a\u95f4\u3002\n\n\u9996\u5148\u6211\u4eec\u5e0c\u671b\u4e0d\u518d\u8bb0\u5f55\u6590\u6ce2\u90a3\u5951\u4e32\u3002\u5355\u6b21\u6c42\u6590\u6ce2\u90a3\u5951\u4e32\u7684\u67d0\u4e00\u9879\u663e\u7136\u53ef\u4ee5\u901a\u8fc7\u4e0d\u65ad\u51cf\u53bb\u6590\u6ce2\u90a3\u5951\u6570\u5217\u4e2d\u7684\u67d0\u4e00\u9879\u5728 $O(\\log m)$ \u5185\u6c42\u51fa\u3002\n\n\u53e6\u4e00\u65b9\u9762\uff0c\u6211\u4eec\u80fd\u4e0d\u80fd\u4e0d\u8bb0\u5f55\u539f\u4e32\u5462\uff1f\u5176\u5b9e\u662f\u53ef\u4ee5\u7684\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5f00\u4e00\u4e2a vector \u8bb0\u5f55\u5f53\u524d\u53ef\u80fd\u7684\u8f6c\u79fb\u70b9 $j$\uff0c\u8fd9\u91cc\u6211\u4eec\u9700\u8981\u4fdd\u8bc1 $[j + 1, i]$ \u4e3a\u4e00\u4e2a\u6590\u6ce2\u90a3\u5951\u4e32\u7684**\u524d\u7f00**\u3002\u7531\u4e8e $fib_{i - 1}$ \u4e3a $fib_i = fib_{i - 1} + fib_{i - 2} + fib_{i - 1}$ \u7684\u6700\u957f border\uff08\u539f\u56e0\u5982\u5de6\uff09\uff0c\u4e8e\u662f\u603b\u9879\u6570\u662f $O(\\log m)$ \u7ea7\u522b\u7684\u3002\u4ece $i \\to i + 1$ \u65f6\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5220\u53bb\u4e0d\u4e3a\u524d\u7f00\u7684\u6570\u4ee5\u53ca\u6dfb\u52a0 $i$ \u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(m \\log^2 m)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\log m + \\max |s_i|)$\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <iostream>\n#include <vector>\n#include <cstdio>\n#include <cstring>\n\nusing namespace std;\n\nconst int N = 31, M = 1e3 + 7, mod = 998244353;\nint fib[N + 7];\nchar s[M];\nvector<pair<int, int> > v1, v2;\n\ninline int get(int x){\n\tint t = x;\n\tfor (int i = N; i >= 2; i--){\n\t\tif (x > fib[i]) x -= fib[i];\n\t}\n\treturn x == 1;\n}\n\ninline bool check(int x){\n\tfor (int i = 0; i <= N; i++){\n\t\tif (x == fib[i]) return true;\n\t}\n\treturn false;\n}\n\nint main(){\n\tint n, pos = 0, sum = 1, lst;\n\tscanf(\"%d\", &n);\n\tfib[0] = fib[1] = 1;\n\tfor (int i = 2; i <= N; i++){\n\t\tfib[i] = fib[i - 1] + fib[i - 2];\n\t}\n\tv1.push_back(make_pair(0, 1));\n\tfor (int i = 1; i <= n; i++){\n\t\tint len;\n\t\tscanf(\"%s\", &s[1]);\n\t\tlen = strlen(&s[1]);\n\t\tfor (int j = 1; j <= len; j++){\n\t\t\tint size = v1.size(), ch = s[j] - '0';\n\t\t\tpos++;\n\t\t\tlst = sum;\n\t\t\tv2.clear();\n\t\t\tfor (int k = 0; k < size; k++){\n\t\t\t\tint len = pos - v1[k].first;\n\t\t\t\tif (len == 1 || get(len) == ch){\n\t\t\t\t\tif (check(len)) lst = ((lst - v1[k].second) % mod + mod) % mod;\n\t\t\t\t\tif (ch == 1 || len > 1) v2.push_back(v1[k]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tsum = (sum + lst) % mod;\n\t\t\tv2.push_back(make_pair(pos, lst));\n\t\t\tv1 = v2;\n\t\t}\n\t\tcout << lst << endl;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1666177871,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1743G \u3010Antifibonacci Cut\u3011"
    },
    {
        "content": "[CF1743G Antifibonacci Cut](https://www.luogu.com.cn/problem/CF1743G)\n\n\u8bbe $m = \\sum |s_i|$\u3002\n\n**VP \u505a\u6cd5**\uff1a\n\n\u8003\u8651\u6734\u7d20 DP\uff0c\u8bbe $g_i$ \u8868\u793a $i$ \u524d\u7f00\u65b9\u6848\u6570\uff0c\u5219 $g_i = \\sum\\limits_{j < i} g_j - \\sum\\limits_{j\\in S(i)} g_j$\uff0c\u5176\u4e2d $S(i)$ \u8868\u793a\u4f7f\u5f97 $s[j + 1, i]$ \u4e3a\u6590\u6ce2\u90a3\u5951\u4e32\u7684 $j$ \u7684\u96c6\u5408\u3002\u663e\u7136 $|S(i)| = \\mathcal{O}(\\log m)$\uff0c\u53ef\u76f4\u63a5 KMP \u5339\u914d\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(m\\log m)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(m)$\uff0c\u65e0\u6cd5\u63a5\u53d7\u3002\n\n\u8003\u8651 KMP \u7684\u8fc7\u7a0b\uff0c\u5982\u679c $f_i$ \u5728 $s$ \u4e2d\u51fa\u73b0\uff0c\u56e0\u4e3a $f_i = f_{i - 2} + f_{i - 3} + f_{i - 2}$ \u7684\u6700\u957f border \u4e3a $f_{i - 2}$\uff08\u4e0d\u4f1a\u8bc1\u660e\uff0c\u611f\u6027\u7406\u89e3\uff09\uff0c\u6240\u4ee5\u4e0b\u4e00\u4e2a\u6700\u957f\u5339\u914d\u957f\u5ea6\u4e3a $|f_{i - 2}|$\uff0c\u8fd9\u8bf4\u660e $f_i$ \u5728 $s$ \u4e2d\u51fa\u73b0\u6b21\u6570\u4e3a $\\mathcal{O}(\\frac m {|f_i|})$\u3002\u636e\u6b64\u8003\u8651\u6839\u53f7\u5206\u6cbb\u3002\n\n\u7528 bitset \u5b58\u4e0b $s$\u3002\n\n\u82e5 $f_i > \\sqrt m$\uff0c\u5219\u9884\u5904\u7406\u51fa $f_i$ \u6240\u6709\u51fa\u73b0\u4f4d\u7f6e $T$\uff0c\u6807\u8bb0 $-g_{j - |f_i|} \\to g_j(j\\in T)$\uff0c\u8f6c\u79fb\u603b\u6570\u4e3a $\\mathcal{O}(\\sqrt m)$\u3002\n\n\u5bf9\u4e8e $f_i < \\sqrt m$\uff0c\u7ef4\u62a4\u6700\u8fd1 $\\sqrt m$ \u4e2a DP \u503c\u5373\u53ef\u3002\n\n\u7528\u54c8\u5e0c\u7ef4\u62a4\u5b57\u7b26\u4e32\u5339\u914d\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(m\\log m)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(\\frac m w)$\u3002[\u4ee3\u7801](https://codeforces.com/contest/1743/submission/183800601)\u3002\n\n**\u5b98\u65b9\u89e3\u6cd5**\uff1a\n\n\u5bf9\u4e8e\u4efb\u610f $i > 1$\uff0c\u4e00\u5b9a\u6709 $f_i$ \u662f $f_{i + 1}$ \u7684\u524d\u7f00\u3002\u56e0\u6b64\uff0c\u8003\u8651 $f_{\\infty}$\uff0c\u6bcf\u4e2a\u4ea7\u751f $-g_j\\to g_i$ \u7684 $s[j + 1, i]$ \u4e00\u5b9a\u662f\u5b83\u7684\u524d\u7f00\u3002\n\n\u5047\u8bbe $s[j + 1, i]$ \u662f $f_{\\infty}$ \u7684\u524d\u7f00\uff0c$s[j' + 1, i](j < j')$ \u540c\u6837\u662f $f_{\\infty}$ \u7684\u524d\u7f00\uff0c\u5219 $s[j' + 1, i]$ \u4e3a $s[j + 1, i]$ \u7684 border\u3002\u6240\u6709\u8fd9\u6837\u7684 $s[j + 1, i]$ \u4e4b\u95f4\u7684 border \u5173\u7cfb\u5f62\u6210\u5168\u5e8f\u5173\u7cfb\uff0c\u53ef\u7528\u4e00\u6761\u94fe\u63cf\u8ff0\uff0c\u800c $f_{\\infty}$ \u6bcf\u4e2a\u524d\u7f00\u7684\u6700\u957f border \u4e0d\u4f1a\u592a\u957f\uff08\u4e0d\u4f1a\u8bc1\u660e\uff0c\u611f\u6027\u7406\u89e3\uff09\uff0c\u6240\u4ee5\u8fd9\u6761\u94fe\u7684\u957f\u5ea6\u4e3a $\\mathcal{O}(\\log m)$\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u7ef4\u62a4\u6240\u6709 $j$ \u53ca\u5176\u5bf9\u5e94 $g_j$\u3002\n\n\u9700\u8981 $\\mathcal{O}(m\\log m)$ \u6b21\u6c42\u51fa $f_{\\infty}$ \u7684\u7b2c $i$ \u4e2a\u5b57\u7b26\uff0c\u53ca\u5224\u65ad\u4e00\u4e2a\u6570\u662f\u5426\u4e3a\u6590\u6ce2\u90a3\u5951\u6570\u3002\u9884\u5904\u7406\u65f6\u95f4 $\\mathcal{O}(m\\log m)$ \u7a7a\u95f4 $\\mathcal{O}(\\frac m w)$\uff0c[\u4ee3\u7801](https://codeforces.com/contest/1743/submission/183815857)\u3002\u4e0d\u9884\u5904\u7406\u505a\u5230\u65f6\u95f4 $\\mathcal{O}(m\\log ^ 2 m)$\uff0c\u7a7a\u95f4 $\\mathcal{O}(\\log m)$\uff0c[\u4ee3\u7801](https://codeforces.com/contest/1743/submission/183814902)\u3002",
        "postTime": 1670150100,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "CF1743G Antifibonacci Cut"
    }
]
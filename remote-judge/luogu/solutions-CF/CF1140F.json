[
    {
        "content": "~~\u5728\u51ac\u4ee4\u8425\u6ca1\u542c\u61c2\u7684\u6211\u53c8\u8dd1\u6765\u6c34\u9898\u89e3\u4e86~~\n\n\u7531\u4e8e\u4e4b\u524d\u89c1\u8fc7[\u67d0\u9053\u7c7b\u4f3c\u7684\u9898](https://www.luogu.com.cn/problem/AT2167)\uff0c\u5e76\u4e14\u8fd9\u4e2a\u8f6c\u79fb\u64cd\u4f5c\u4e5f\u5f88\u76f8\u4f3c\uff0c\u6211\u4eec\u53ef\u4ee5\u5f88\u81ea\u7136\u7684\u60f3\u5230\uff0c\u5bf9\u4e8e\u539f\u56fe\u7684\u884c\u548c\u5217\u5206\u522b\u5efa\u70b9\uff0c\u5e76\u5c06\u539f\u56fe\u4e2d\u7684\u4e00\u4e2a\u70b9\u770b\u4f5c\u662f\u8fde\u63a5\u884c\u548c\u5217\u7684\u4e00\u6761\u65e0\u5411\u8fb9\u3002\u663e\u7136\uff0c\u65e0\u8bba\u4f55\u65f6\uff0c\u8fd9\u90fd\u4f1a\u662f\u4e00\u5f20\u4e8c\u5206\u56fe\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u8fd9\u6837\u8fde\u8fb9\u540e\uff0c\u9898\u9762\u4e2d\u7684\u90a3\u4e2a\u64cd\u4f5c\u7684\u8981\u6c42\u5c31\u662f\uff1a\n\n\u5bf9\u4e8e\u4e00\u6761\u8fb9$(x_1,y_1)$\uff0c\n\n\u6240\u6709\u4e0e$x_1$\u76f8\u8fde\u7684\u70b9\uff0c\n\n\u4e0e\u6240\u6709\u540c$y_1$\u76f8\u8fde\u7684\u70b9\uff0c\n\n\u4e4b\u95f4\u4e24\u4e24\u8fde\u8fb9\u3002\n\n\u8fd9\u6837\u4e00\u76f4\u8fde\u4e0b\u53bb\u540e\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\uff0c\u6bcf\u4e2a\u539f\u56fe\u4e2d\u7684\u8fde\u901a\u5757\u4e2d\uff0c\u6240\u6709\u7684\u884c\u70b9\u4e0e\u6240\u6709\u7684\u5217\u70b9\u4e4b\u95f4\u5404\u6709\u4e00\u6761\u8fb9\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u8981\u5173\u4e8e\u6bcf\u4e2a\u8fde\u901a\u5757\uff0c\u7ef4\u62a4\u8fd9\u4e2a\u8fde\u901a\u5757\u91cc\u9762\u884c\u70b9\u6570\u91cf\u548c\u5217\u70b9\u6570\u91cf\uff0c\u7136\u540e\u7b54\u6848\u5c31\u662f\u6240\u6709\u8fde\u901a\u5757\u7684\uff08\u884c\u70b9\u6570\u91cf\u4e0e\u5217\u70b9\u6570\u91cf\u4e4b\u79ef\uff09\u7684\u548c\u3002\n\n\u89c2\u5bdf\u5230\u64cd\u4f5c\u53ef\u4ee5\u79bb\u7ebf\u3002\u90a3\u4e48\u6211\u4eec\u5c31\u8fdb\u884c\u7ebf\u6bb5\u6811\u5206\u6cbb\u5373\u53ef\u3002\u884c\u5217\u70b9\u7684\u6570\u91cf\u90fd\u53ef\u4ee5\u5728\u53ef\u64a4\u9500\u51b0\u8336\u59ec\u91cc\u9762\u7ef4\u62a4\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define mpp make_pair\n#define pii pair<int,int>\n#define mid ((l+r)>>1)\n#define lson x<<1\n#define rson x<<1|1\ntypedef long long ll;\nconst int N=3e5;\nint n;\nll res;\nmap<pii,int>mp;\nvector<pii>v[1200100];\nvoid modify(int x,int l,int r,int L,int R,pii p){\n\tif(l>R||r<L)return;\n\tif(L<=l&&r<=R){v[x].push_back(p);return;}\n\tmodify(lson,l,mid,L,R,p),modify(rson,mid+1,r,L,R,p);\n}\nstruct DSU{\n\tint fa;\n\tpii sz;\n\tDSU(int a=0,pii b=mpp(0,0)){fa=a,sz=b;}\n}dsu[600100];\nint find(int x){\n\treturn dsu[x].fa==x?x:find(dsu[x].fa);\n}\nstruct Query{\n\tint u,v;\n\tll r;\n\tpii su,sv;\n\tQuery(int a=0,pii b=mpp(0,0),int c=0,pii d=mpp(0,0),ll e=0){u=a,su=b,v=c,sv=d,r=e;}\n};\nstack<Query>s;\nbool merge(int x,int y){\n//\tprintf(\"%d %d\\n\",x,y);\n\tx=find(x),y=find(y);\n\tif(x==y)return false;\n\ts.push(Query(x,dsu[x].sz,y,dsu[y].sz,res));\n\tres-=1ll*dsu[x].sz.first*dsu[x].sz.second+1ll*dsu[y].sz.first*dsu[y].sz.second;\n\tif(dsu[x].sz.first+dsu[x].sz.second>dsu[y].sz.first+dsu[y].sz.second){\n\t\tdsu[x].sz.first+=dsu[y].sz.first;\n\t\tdsu[x].sz.second+=dsu[y].sz.second;\n\t\tdsu[y].fa=x;\n\t\tres+=1ll*dsu[x].sz.first*dsu[x].sz.second;\n\t}else{\n\t\tdsu[y].sz.first+=dsu[x].sz.first;\n\t\tdsu[y].sz.second+=dsu[x].sz.second;\n\t\tdsu[x].fa=y;\n\t\tres+=1ll*dsu[y].sz.first*dsu[y].sz.second;\n\t}\n\treturn true;\n}\nvoid Pop(){\n\tdsu[s.top().u]=DSU(s.top().u,s.top().su);\n\tdsu[s.top().v]=DSU(s.top().v,s.top().sv);\n\tres=s.top().r;\n\ts.pop();\n}\nvoid iterate(int x,int l,int r){\n\tint tot=0;\n\tfor(int i=0;i<v[x].size();i++)tot+=merge(v[x][i].first,v[x][i].second+N);\n\tif(l==r)printf(\"%lld \",res);\n\telse iterate(lson,l,mid),iterate(rson,mid+1,r);\n\twhile(tot--)Pop();\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=N;i++)dsu[i]=DSU(i,mpp(1,0));\n\tfor(int i=N+1;i<=2*N;i++)dsu[i]=DSU(i,mpp(0,1));\n\tfor(int i=1,x,y;i<=n;i++){\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tif(mp.find(mpp(x,y))==mp.end())mp[mpp(x,y)]=i;\n\t\telse modify(1,1,n,mp[mpp(x,y)],i-1,mpp(x,y)),mp.erase(mpp(x,y));\n\t}\n\tfor(auto it:mp)modify(1,1,n,it.second,n,it.first);\n\titerate(1,1,n);\n\treturn 0;\n}\n```\n",
        "postTime": 1583735422,
        "uid": 123369,
        "name": "xtx1092515503",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1140F \u3010Extending Set of Points\u3011"
    },
    {
        "content": "\u5f88\u597d\u7684\u4e00\u9053\u7ebf\u6bb5\u6811\u5206\u6cbb\u6a21\u677f\u9898\u554a\uff01\n\n\u771f\u5fc3\u9002\u5408\u5165\u95e8\uff0c\u7eaa\u5ff5\u6211\u7684\u7b2c\u4e00\u9053\u7ebf\u6bb5\u6811\u5206\u6cbb\u3002\n\n------------\n\n\u5148\u8003\u8651\u6ca1\u6709\u5220\u9664\u8be5\u600e\u4e48\u505a\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u70b9$(x,y)$\uff0c\u4ed6\u53ea\u80fd\u8ddf\u540c\u884c\u548c\u540c\u5217\u7684\u70b9\u76f8\u5173\u3002\n\n\u4e00\u7cfb\u5217\u76f8\u5173\u7684\u70b9\u4f1a\u88ab\u6269\u5c55\u6210\u4e00\u4e2a\u201c\u8868\u683c\u201d\u3002\n\n\u770b\u5230\u201c\u76f8\u5173\u201d\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u8054\u60f3\u5230\u5e76\u67e5\u96c6\uff1a\n\n\u6211\u4eec\u53ef\u4ee5\u628a$(x,y)$,\u770b\u6210\u4e8c\u5206\u56fe\u4e2d\u7684\u8fb9\u3002\n\n\u5982\u679c\u4e8c\u5206\u56fe\u4e2d\u7684\u4e00\u4e2a\u8054\u901a\u5757\u5305\u62ec$xc$\u4e2a\u5de6\u65b9\u8282\u70b9\uff0c$yc$\u4e2a\u53f3\u65b9\u8282\u70b9\uff0c\u90a3\u4e48\u8be5\u8054\u901a\u5feb\u5bf9\u4e8e\u7b54\u6848\u7684\u8d21\u732e\u5c31\u662f$xc*yc$\u3002\n\n\u8fd9\u53ef\u4ee5\u7528\u5e76\u67e5\u96c6\u65b9\u4fbf\u5730\u7ef4\u62a4\u3002\n\n------------\n\n\u7136\u800c\u8fd9\u9898\u5e26\u5220\u9664\uff0c\u8fd9\u5c31\u4e0d\u662f\u5f88\u597d\u529e\u4e86\u3002\n\n\u6211\u4eec\u8003\u8651\u7ef4\u62a4\u4e00\u4e2a\u65f6\u95f4\u8f74\uff1a\n\n```cpp\n\u5982\u6837\u4f8b\uff1a\n(1,1) time:1~7\n(1,2) time:2~4\n(2,1) time:3~6\n(2,2) time:4~7\n(1,3) time:6~7\n\n(2,2)              |-----------|\n(2,1)          |-----------|\n(1,2)      |-------|       |---|(1,3)\n(1,1)  |-----------------------|\n-------1---2---3---4---5---6---7-->\n```\n\n\u53ef\u4ee5\u770b\u5230\u6bcf\u4e2a\u70b9\u90fd\u6709\u4e00\u4e2a\u51fa\u73b0\u7684\u65f6\u95f4\u6bb5\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u91c7\u53d6\u5982\u4e0b\u66b4\u529b\uff1a\n\n\u4e0b\u79f0\u201c\u72b6\u6001$t$\u201d\u4e3a\u65f6\u523b\u4e3a$t$\u662f\u6240\u6709\u5b58\u5728\u7684\u70b9\u52a0\u5165\u5e76\u67e5\u96c6\u540e\uff0c\u5e76\u67e5\u96c6\u7684\u72b6\u6001\u3002\n\n\u5f04$m$\u4e2a\u94fe\u8868\uff0c\u66b4\u529b\u628a\u4e00\u4e2a\u70b9\u6302\u5728\u51fa\u73b0\u533a\u95f4\u7684\u94fe\u8868\u91cc\u3002\n\n\u90a3\u4e48\u5982\u679c\u6211\u4eec\u8981\u83b7\u5f97\u201c\u72b6\u6001$t$\u201d\uff0c\u53ea\u8981\u628a\u5e76\u67e5\u96c6\u6e05\u7a7a\u7136\u540e\u628a\u7b2c$t$\u4e2a\u94fe\u8868\u91cc\u7684\u64cd\u4f5c\u505a\u4e00\u904d\u5c31\u597d\u4e86\u3002\n\n\u8fd9\u6837\u5b50\u590d\u6742\u5ea6\u9ad8\u8fbe$O(m^2\\alpha(m))$,\u80af\u5b9a\u662f\u5e03\u661f\u7684\u3002\n\n\u4e8e\u662f\u4f60\u770b\u5230\u4e86\u719f\u6089\u7684\u533a\u95f4\uff0c\u60f3\u5230\u4e86\u7ebf\u6bb5\u6811\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5efa\u7acb\u4e00\u9897\u65f6\u95f4\u8f74\u4e0a\u7684\u7ebf\u6bb5\u6811\uff0c\u7136\u540e\u6bcf\u4e2a\u8282\u70b9\u6302\u4e00\u4e2a\u94fe\u8868\u3002\n\n\u7136\u540e\u628a\u4e00\u4e2a\u533a\u95f4\u5bf9\u5e94\u7684$O(\\log m)$\u4e2a\u8282\u70b9\u6302\u4e0a\u8be5\u64cd\u4f5c\u3002\n\n\u7136\u540e\u6211\u4eec\u7528\u67d0\u79cd\u5965\u5999\u91cd\u91cd\u7684\u65b9\u5f0f\u8ba9\u513f\u5b50\u7ee7\u627f\u7236\u4eb2\u7684\u64cd\u4f5c\uff0c\u5c31\u53ef\u4ee5\u505a\u5230\u5728$t$\u53f7\u53f6\u8282\u70b9\u8fbe\u5230\u72b6\u6001$t$\u3002\n\n\u4e00\u4e2a\u7b80\u5355\u7684\u60f3\u6cd5\u662f\u4f7f\u7528\u53ef\u6301\u4e45\u5316\u5e76\u67e5\u96c6\uff0c\u7136\u540e\u513f\u5b50\u5f15\u7528\u7236\u4eb2\uff0c\u4e0d\u8fc7\u5b8c\u5168\u6ca1\u8fd9\u4e2a\u5fc5\u8981\u3002\n\n\u6211\u4eec\u53d1\u73b0\u6c42\u7b54\u6848\u7684\u8fc7\u7a0b\u662f\u4e2a`dfs`\u7684\u8fc7\u7a0b\uff0c\u6211\u4eec\u9000\u51fa\u67d0\u4e2a\u8282\u70b9\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u628a\u8be5\u8282\u70b9\u4e0a\u6302\u7684\u64cd\u4f5c\u64a4\u56de\uff0c\u7136\u540e\u5c31\u80fd\u5f97\u5230\u7236\u8282\u70b9\u7684\u72b6\u6001\u4e86\u3002\n\n\u5e76\u67e5\u96c6\u662f\u652f\u6301$O(\\log n)$\u64a4\u56de\u7684,\u6309\u79e9\u5408\u5e76\u5373\u53ef\u3002\n\n\u7406\u8bba\u4e0a\u6765\u8bb2\u6240\u6709\u975e\u5747\u644a\u7684\u6570\u636e\u7ed3\u6784\u90fd\u662f\u8d44\u74f7\u64a4\u56de\u7684\uff0c\u6240\u4ee5\u8fd9\u4e2a\u7b97\u6cd5\u975e\u5e38\u7684\u597d\u7528\u3002\n\n\u66f4\u591a\u6280\u5de7\u8bf7\u89c1 : [\u4e00\u4e9b\u5e38\u7528\u7684\u6570\u636e\u7ed3\u6784\u7ef4\u62a4\u624b\u6cd5](https://www.luogu.com.cn/blog/command-block/yi-suo-chang-yong-di-shuo-ju-jie-gou-wei-hu-shou-fa)\n\n**Code:**\n\n```cpp\n#include<algorithm>\n#include<vector>\n#include<cstdio>\n#include<map>\n#define MaxN 300500\nusing namespace std;\ninline int read()\n{\n  register int X=0;\n  register char ch=0;\n  while(ch<48||ch>57)ch=getchar();\n  while(ch>=48&&ch<=57)X=X*10+(ch^48),ch=getchar();\n  return X;\n}\nint n,m;\nstruct Point\n{int l,r,x,y;}\nb[MaxN];\nstruct xyPoint\n{int x,y;}wfc;\nvector<xyPoint> g[MaxN<<2];\nint tn;\nmap<pair<int,int>,int> mmp;\nint f[MaxN<<1],xc[MaxN<<1],yc[MaxN<<1];\nstruct Data\n{int x,y;}\nstk[MaxN];\nint top;\nlong long ans;\nint findf(int x)\n{return f[x]==x ? x :findf(f[x]);}\nvoid marge(int x,int y)\n{\n  x=findf(x);y=findf(y);\n  if (x==y)return ;\n  ans-=1ll*xc[x]*yc[x]+1ll*xc[y]*yc[y];\n  if (xc[x]+yc[x]>xc[y]+yc[y])swap(x,y);\n  stk[++top]=(Data){x,y};\n  f[x]=y;\n  xc[y]+=xc[x];\n  yc[y]+=yc[x];\n  ans+=1ll*xc[y]*yc[y];\n}\nvoid undo(int x,int y)\n{\n  ans-=1ll*xc[y]*yc[y];\n  f[x]=x;\n  xc[y]-=xc[x];\n  yc[y]-=yc[x];\n  ans+=1ll*xc[x]*yc[x]+1ll*xc[y]*yc[y];\n}\nint wfl,wfr;\nvoid addop(int l,int r,int num)\n{\n  if (wfl<=l&&r<=wfr){\n  \tg[num].push_back(wfc);\n    return ;\n  }int mid=(l+r)>>1;\n  if (wfl<=mid)addop(l,mid,num<<1);\n  if (wfr>mid)addop(mid+1,r,num<<1|1);\n}\nlong long sav[MaxN];\nvoid solve(int l,int r,int num)\n{\n  int tim=top;\n  for (int i=0;i<g[num].size();i++)\n    marge(g[num][i].x,g[num][i].y);\n  if (l==r)sav[l]=ans;\n  else {\n    int mid=(l+r)>>1;\n    solve(l,mid,num<<1);\n    solve(mid+1,r,num<<1|1);\n  }\n  while(tim<top){\n    undo(stk[top].x,stk[top].y);\n    top--;\n  }\n}\npair<int,int> gg;\nint main()\n{\n  m=read();n=300005;\n  for (int i=1,x,y;i<=m;i++){\n  \tx=read();y=read()+n;\n  \tgg=make_pair(x,y);\n  \tif (mmp.find(gg)!=mmp.end()){\n  \t  b[mmp[gg]].r=i-1;\n  \t  mmp.erase(gg);\n    }else \n      b[mmp[gg]=++tn]=(Point){i,0,x,y};\n  }\n  for (int i=1;i<=tn;i++){\n  \twfl=b[i].l;wfr=b[i].r;\n  \tif (wfr==0)wfr=m;\n  \twfc=(xyPoint){b[i].x,b[i].y};\n  \taddop(1,m,1);\n  }\n  for (int i=1;i<=n+n;i++){\n  \tf[i]=i;xc[i]=(i<=n);yc[i]=!xc[i];\n  }solve(1,m,1);\n  for (int i=1;i<=n+n;i++)\n  \tif (f[i]!=i||xc[i]!=(i<=n)||yc[i]!=!xc[i])\n      {puts(\"!\");break;}\n  if (ans!=0)puts(\"!\");\n  for (int i=1;i<=m;i++)\n    printf(\"%lld \",sav[i]);\n  return 0;\n}\n```\n\u8fd9\u79cd\u5199\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f$O(nlog^2n)$,\u7a7a\u95f4\u590d\u6742\u5ea6\u662f$O(nlogn)$\u3002\n\n\u5176\u5b9e\u7a7a\u95f4\u590d\u6742\u5ea6\u662f\u53ef\u4ee5\u505a\u5230$O(n)$\u7684\uff0c\u505a\u6cd5\u5982\u4e0b\uff1a\n\n\u4f46\u662f\u6bd4\u4e0a\u9762\u7684\u4ee3\u7801\u65f6\u7a7a\u53cc\u52a3\uff0c\u4e0d\u77e5\u4e3a\u5565\u2026\u2026\n\n```cpp\n#include<algorithm>\n#include<vector>\n#include<cstdio>\n#include<map>\n#define MaxN 600500\nusing namespace std;\ninline int read()\n{\n  register int X=0;\n  register char ch=0;\n  while(ch<48||ch>57)ch=getchar();\n  while(ch>=48&&ch<=57)X=X*10+(ch^48),ch=getchar();\n  return X;\n}\nint n,m;\nstruct Point\n{int l,r,x,y;}\nb[MaxN];\nint tn;\nmap<pair<int,int>,int> mmp;\nint f[MaxN],xc[MaxN],yc[MaxN];\nstruct Data\n{int x,y;}\nstk[MaxN];\nint top;\nlong long ans;\nint findf(int x)\n{return f[x]==x ? x :findf(f[x]);}\nvoid marge(int x,int y)\n{\n  x=findf(x);y=findf(y);\n  if (x==y)return ;\n  ans-=1ll*xc[x]*yc[x]+1ll*xc[y]*yc[y];\n  if (xc[x]+yc[x]>xc[y]+yc[y])swap(x,y);\n  stk[++top]=(Data){x,y};\n  f[x]=y;\n  xc[y]+=xc[x];\n  yc[y]+=yc[x];\n  ans+=1ll*xc[y]*yc[y];\n}\nvoid undo(int x,int y)\n{\n  f[x]=x;\n  xc[y]-=xc[x];\n  yc[y]-=yc[x];\n}\nvector<int> s[MaxN<<1];\nvoid solve(int l,int r,int num)\n{\n  long long sav=ans;\n  int tim=top;\n  Point *v;\n  for (int i=0;i<s[num].size();i++){\n  \tv=&b[s[num][i]];\n  \tif (v->l<=l&&r<=v->r)\n      marge(v->x,v->y);\n  }\n  if (l==r)printf(\"%lld \",ans);\n  else {\n    int mid=(l+r)>>1;\n    for (int i=0;i<s[num].size();i++){\n  \t  v=&b[s[num][i]];\n  \t  if (!(v->l<=l&&r<=v->r)){\n  \t  \tif (v->l<=mid)s[num<<1].push_back(s[num][i]);\n        if (v->r>mid)s[num<<1|1].push_back(s[num][i]);\n      }\n    }s[num].clear();\n    solve(l,mid,num<<1);\n    solve(mid+1,r,num<<1|1);\n  }\n  while(tim<top){\n    undo(stk[top].x,stk[top].y);\n    top--;\n  }ans=sav;\n}\nint main()\n{\n  m=read();n=300005;\n  pair<int,int> sav;\n  for (int i=1,x,y;i<=m;i++){\n  \tx=read();y=read()+n;\n  \tsav=make_pair(x,y);\n  \tif (mmp[sav]){\n  \t  b[mmp[sav]].r=i-1;\n  \t  mmp[sav]=0;\n    }else \n      b[mmp[sav]=++tn]=(Point){i,0,x,y};\n  }\n  for (int i=1;i<=tn;i++){\n  \tif (b[i].r==0)b[i].r=m;\n  \ts[1].push_back(i);\n  }\n  for (int i=1;i<=n+n;i++){\n  \tf[i]=i;xc[i]=(i<=n);yc[i]=!xc[i];\n  }solve(1,m,1);\n  return 0;\n}\n```",
        "postTime": 1560836968,
        "uid": 58705,
        "name": "command_block",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1140F \u3010Extending Set of Points\u3011"
    },
    {
        "content": "\u662f\u770b\u4e86\u7ebf\u6bb5\u6811\u5206\u6cbb\u6a21\u677f\u9898\u9898\u89e3\u91cc\u9762\u7684\u63a8\u8350\u4f8b\u9898\u6765\u7684\u3002\u4f46\u662f\u5728\u5f00\u59cb\u505a\u8fd9\u9053\u9898\u4e4b\u524d\uff0c\u6211\u7a81\u7136\u89c9\u5f97\uff0c\u9898\u76ee\u7684\u201c\u5185\u6db5\u201d\u4e5f\u8bb8\u6bd4\u8fd9\u4e9b\u7b97\u6cd5\u8981\u91cd\u8981\u4e00\u4e9b\u3002\n\n\u6211\u5148\u53bb\u505a\u4e86 [AT2167](https://www.luogu.com.cn/problem/AT2167)\uff0c\u53d1\u73b0\u8fd9\u79cd\u7ed5\u7740\u628a\u8fb9\u8bf4\u6210\u70b9\u5df2\u7ecf\u662f\u4e00\u79cd\u5957\u8def\u4e86\uff0c\u5c24\u5176\u8fd9\u9898\u8fd8\u76f4\u767d\u5f97\u591a\u3002\n\n\u8fd9\u9898\u8d34\u5fc3\u5730\u5e2e\u6211\u4eec\u628a\u70b9\u5206\u6210\u4e86 $x$ \u548c $y$ \u4e24\u4e2a\u96c6\u5408\uff0c\u4e8e\u662f\u6211\u4eec\u731c\u60f3\u5e76\u4e14\u6839\u636e\u540e\u9762\u7ed9\u7684\u62d3\u5c55\u8fb9\u7684\u6761\u4ef6\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u7684\u786e\u662f\u4e2a\u4e8c\u5206\u56fe\u3002\u6216\u8005\u8bf4\uff0c\u4e0d\u7ba1\u4ec0\u4e48\u56fe\uff0c\u62c6\u70b9\u4e4b\u540e\u5c31\u662f\u4e2a\u4e8c\u5206\u56fe\u3002 ~~\u8bf4\u4e86\u8ddf\u6ca1\u8bf4\u4e00\u6837~~\n\n\u6211\u4eec\u89c2\u5bdf\u62d3\u5c55\u7684\u6761\u4ef6\uff0c\u53d1\u73b0\uff1a\n\n![](https://cdn-warfare-1302619124.file.myqcloud.com/rgngtuk7.png)\n\n\u5bf9\u4e8e\u4e00\u4e2a\u5728\u53f3\u8fb9\u96c6\u5408\u7684\u8282\u70b9\uff0c\u5982\u679c\u6709\u4e24\u4e2a\u8282\u70b9\u90fd\u5f15\u4e86\u4e00\u6761\u8fb9\u5230\u8fd9\u4e2a\u8282\u70b9\uff0c\u90a3\u4e48\u6211\u4eec\u6709\uff0c\u4efb\u610f\u4e00\u4e2a\u5176\u4e2d\u4e00\u4e2a\u8282\u70b9\u6709\u8fb9\u5230\u8fbe\u7684\u8282\u70b9\uff0c\u53e6\u5916\u4e00\u4e2a\u8282\u70b9\u90fd\u4f1a\u5f15\u4e00\u6761\u8fb9\u5230\u90a3\u4e2a\u8282\u70b9\u3002\u975e\u5e38\u7c7b\u4f3c\u4e8e\uff0c\u7f29\u70b9\uff08\u8ddfWC2021 T1 \u4e5f\u5f88\u50cf\uff09\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u6211\u4eec\u4e0d\u65ad\u62d3\u5c55\uff0c\u6700\u540e\u5f97\u5230\u7684\u7ed3\u679c\u5c06\u4f1a\u662f\u51e0\u4e2a\u76f8\u4e92\u72ec\u7acb\u7684\u8fde\u901a\u5757\u3002\u5e76\u4e14\u5bf9\u4e8e\u4e00\u4e2a\u8fde\u901a\u5757\u4e2d\u4efb\u610f\u4e00\u4e2a\u5de6\u8fb9\u96c6\u5408\u7684\u70b9\u5230\u53f3\u8fb9\u96c6\u5408\u6240\u6709\u7684\u70b9\u90fd\u6709\u4e00\u6761\u8fb9\u3002\u8fd9\u6837\u7684\u4e00\u4e2a\u96c6\u5408\u7684\u8d21\u732e\u5c06\u4f1a\u662f $l\\times r$\uff0c\u5206\u522b\u5bf9\u5e94\u5de6\u96c6\u5408\u5927\u5c0f\u548c\u53f3\u96c6\u5408\u5927\u5c0f\u3002\n\n\u5e76\u4e14\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u8fd9\u6837\u7684\u96c6\u5408\uff01\u6211\u4eec\u9700\u8981\u7ef4\u62a4\u4e00\u4e2a\u8fde\u901a\u5757\u5185\u5de6\u96c6\u5408\u7684\u5927\u5c0f\u548c\u53f3\u96c6\u5408\u7684\u5927\u5c0f\u3002\n\n\u6211\u4eec\u628a\u6bcf\u6761\u8fb9\u7684\u7684\u64cd\u4f5c\u53d8\u6210\u4e00\u5806\u5f71\u54cd\u533a\u95f4\uff0c\u8fd9\u662f\u7ebf\u6bb5\u6811\u5206\u6cbb\u57fa\u64cd\uff0c\u968f\u540e\u8003\u8651\u52a0\u5165\u8fb9\u7684\u5f71\u54cd\u3002\n\n\u5982\u679c\u5bf9\u5e94\u7684\u53f3\u96c6\u5408\u7684\u70b9\u8fd8\u6ca1\u6709\u4e00\u6761\u8fde\u5411\u5b83\u7684\u8fb9\uff0c\u90a3\u4e48\u8fd9\u5e76\u4e0d\u9700\u8981\u5408\u5e76\u96c6\u5408\uff0c\u53f3\u96c6\u5408\u5927\u5c0f++\u5373\u53ef\u3002\n\n\u5982\u679c\u5df2\u7ecf\u6709\u4e86\uff0c\u90a3\u4e48\u9700\u8981\u5408\u5e76\u96c6\u5408\uff0c$ans=ans+(l_u+l_v)\\times(r_u+r_v)-l_u\\times r_u-l_v\\times r_v$\u3002\n\n\u6574\u597d\u4e86\uff01\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nmap<int,map<int,int> >mp;\nint n;\nstruct Seg{\n    int l,r;\n    vector<pair<int,int> >v;\n    #define l(o) C[o].l\n    #define r(o) C[o].r\n    #define mid(o) ((C[o].l+C[o].r)/2)\n    #define v(o) C[o].v\n}C[1200005];\nvoid build(int o,int l,int r){\n    l(o)=l;\n    r(o)=r;\n    if(l>=r)\n        return;\n    build(o*2,l,mid(o));\n    build(o*2+1,mid(o)+1,r);\n}\nvoid update(int o,int l,int r,pair<int,int> v){\n    if(l(o)>=l&&r(o)<=r){\n        v(o).push_back(v);\n        return;\n    }\n    if(l<=mid(o))\n        update(o*2,l,r,v);\n    if(r>mid(o))\n        update(o*2+1,l,r,v);\n}\nstruct State{\n    long long typ,u,v,s,t;\n};\nstack<State>sta;\nint mk[300005],f[300005];\nlong long s[300005],t[300005];\nint find(int p){\n    return f[p]==p?p:find(f[p]);\n}\nlong long res,ans[300005];\nvoid Resolve(int o){\n    int siz=sta.size();\n    long long _rev=res;\n    for(int i=0,u,v;i<v(o).size();i++){\n        u=v(o)[i].first;\n        v=v(o)[i].second;\n        if(mk[v]==0){\n            mk[v]=u;\n            u=find(u);\n            t[u]++;\n            res+=s[u];\n            sta.push({0,u,v,0,1});\n        }else if(find(mk[v])!=find(u)){\n            u=find(u);\n            v=find(mk[v]);\n            if(s[u]>s[v])\n                swap(u,v);\n            res+=(s[u]+s[v])*(t[u]+t[v])-s[u]*t[u]-s[v]*t[v];\n            sta.push({1,u,v,s[u],t[u]});\n            s[v]+=s[u];\n            t[v]+=t[u];\n            f[u]=v;\n        }\n    }\n    if(l(o)>=r(o)){\n        ans[l(o)]=res;\n        goto Karkov;\n    }\n    Resolve(o*2);\n    Resolve(o*2+1);\n    Karkov:;\n    while(sta.size()>siz){\n        //Distribute\n        State u=sta.top();\n        if(u.typ==0){\n            t[u.u]-=u.t;\n            mk[u.v]=0;\n        }\n        if(u.typ==1){\n            s[u.v]-=u.s;\n            t[u.v]-=u.t;\n            f[u.u]=u.u;\n        }\n        sta.pop();\n    }\n    res=_rev;\n}\nint main(){\n    scanf(\"%d\",&n);\n    build(1,1,n);\n    for(int i=1,u,v;i<=n;i++){\n        scanf(\"%d%d\",&u,&v);\n        if(mp[u][v]==0)\n            mp[u][v]=i;\n        else {\n            // cout<<\"(\"<<u<<\",\"<<v<<\")\"<<mp[u][v]<<\"-\"<<i-1<<'\\n';\n            update(1,mp[u][v],i-1,make_pair(u,v));\n            mp[u][v]=0;\n        }\n    }\n    for(auto s:mp)\n        for(auto t:s.second)\n            if(t.second){\n                // cout<<\"(\"<<s.first<<\",\"<<t.first<<\")\"<<t.second<<\"-\"<<n<<'\\n';\n                update(1,t.second,n,make_pair(s.first,t.first));\n            }\n    for(int i=1;i<=n;i++){\n        f[i]=i;\n        s[i]=1;\n    }\n    Resolve(1);\n    for(int i=1;i<=n;i++)\n        printf(\"%lld \",ans[i]);\n}/*\n\u9996\u5148\u8fd9\u662f\u4e00\u4e2a\u4e8c\u5206\u56fe\n\u968f\u540e\u5982\u679c\u6211\u4eec\u6709u->v<-w\uff0c\u90a3\u4e48w\u8fde\u4ec0\u4e48\uff0cu\u4e5f\u8fde\u4ec0\u4e48\u3002\u7b49\u4e8e\u8bf4\u662f\u7f29\u70b9\u3002\n\u8d21\u732e\u662f\u8fd9\u4e2a\u8fde\u901a\u5757\u5de6\u8fb9\u7684siz*\u53f3\u8fb9\u7684siz\u3002\n\u5e76\u4e14\uff0c\u663e\u7136\u6574\u4e2a\u8fde\u901a\u5757\u662f\u72ec\u7acb\u7684\uff0c\u4e0d\u5b58\u5728\u76f8\u8fde\uff0c\u4f46\u662f\u4e0d\u88ab\u7f29\u5230\u4e00\u4e2a\u70b9\u91cc\u9762\u53bb\u7684\u60c5\u51b5\n\u6240\u4ee5\u6574\u597d\u4e86\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\n*/\n```\n\n",
        "postTime": 1612773160,
        "uid": 251723,
        "name": "Schwarzkopf_Henkal",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF1140F \u3010Extending Set of Points\u3011"
    },
    {
        "content": "### P.S.\n\u7ebf\u6bb5\u6811\u5206\u6cbb\u5165\u95e8\u9898\uff0c\u8fd8\u7b97\u6bd4\u8f83\u57fa\u7840\u5427\u3002  \n~~\u6765\u8865\u6628\u5929\u9898\u7684\u9898\u89e3\u4e86\uff08\uff08\uff08~~\n\n### Problem.\n\u5982\u679c\u6709 $(a,x),(a,y),(b,x)$ \u90a3\u5c31\u53ef\u4ee5\u52a0\u5165 $(b,y)$\u3002  \n\u6bcf\u6b21\u52a0\u5165\u4e00\u4e2a\u70b9\u6216\u5220\u9664\u4e00\u4e2a\u70b9\u3002  \n\u6c42\u5982\u679c\u5f53\u524d\u6240\u6709\u70b9\u505a\u4e0a\u9762\u7684\u64cd\u4f5c\u540e\uff0c\u603b\u5171\u4f1a\u6709\u591a\u5c11\u70b9\u3002  \n\u8be2\u95ee\u72ec\u7acb\u3002  \n\n### Solution.\n\u9996\u5148\uff0c\u5982\u679c\u6211\u4eec\u8003\u8651\u5728\u5e73\u9762\u4e0a\u505a\u9898\uff0c\u8fd9\u9898\u4f1a\u53d8\u5f97\u5341\u5206\u56f0\u96be\u3002  \n\u90a3\u4e48\u6211\u4eec\u8003\u8651\u7ecf\u5178\u5957\u8def\u8f6c\u5316\uff1a\u5b58\u5728 $(x,y)\\rightarrow$ $x$ \u548c $y$ \u4e4b\u95f4\u6709\u8fde\u8fb9\u3002  \n\u6211\u4eec\u5c31\u6210\u529f\u628a\u5e73\u9762\u95ee\u9898\u8f6c\u5316\u6210\u4e86\u4e8c\u5206\u56fe\u4e0a\u95ee\u9898\u3002  \n\n\u6211\u4eec\u8003\u8651\u4e00\u4e2a\u90a3\u4e2a\u52a0\u5165\u70b9\u64cd\u4f5c\u610f\u4e3a\u7740\u4ec0\u4e48\u3002  \n\u9996\u5148\uff0c\u5982\u679c\u5b58\u5728\u4e00\u4e2a\u6781\u5927\u8054\u901a\u4e8c\u5206\u56fe\uff0c\u90a3\u4e48\u5b83\u80af\u5b9a\u8fde\u5230\u6700\u540e\u4f1a\u53d8\u6210\u5b8c\u5168\u4e8c\u5206\u56fe\u3002  \n\u8bc1\u660e\u5982\u4e0b\uff08\u53ef\u80fd\u4e0d\u662f\u5f88\u4e25\u8c28\uff1a  \n\u9996\u5148\uff0c\u4e0a\u9762\u7684\u8f6c\u5316\u76f8\u5f53\u4e8e\u662f\u628a\u4e24\u70b9\u4e4b\u95f4\u957f\u5ea6\u4e3a $3$ \u589e\u5e7f\u8def\u8fde\u8d77\u6765\u3002  \n\u800c\u5bf9\u4e8e\u4e00\u4e2a\u957f\u5ea6\u4e3a $5$ \u7684\u589e\u5e7f\u8def\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u524d\u4e09\u6761\u8fde\u8d77\u6765\uff0c\u518d\u5904\u7406\u540e\u4e09\u6761\u3002  \n\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u7c7b\u4f3c\u628a\u4efb\u610f\u7684\u4e00\u6761\u589e\u5e7f\u8def\u9996\u5c3e\u76f8\u63a5\u3002  \n\u6240\u4ee5\u6700\u540e\u8fde\u6210\u7684\u56fe\u5c31\u662f\u5f20\u5b8c\u5168\u4e8c\u5206\u56fe\u3002  \n\u800c\u5b8c\u5168\u4e8c\u5206\u56fe\u7684\u8fb9\u6570\u662f $num_{left}\\times num_{right}$\u3002  \n\u6240\u4ee5\u6211\u4eec\u76f4\u63a5 **\u52a0\u8fb9\uff01\u52a0\u8fb9\uff01\u52a0\u8fb9\uff01\u7136\u540e~~\u53ef\u64a4\u9500~~\u5e76\u67e5\u96c6\u7ef4\u62a4** \u5c31\u597d\u4e86\u3002  \n\n\u800c\u8fd9\u79cd\u4e00\u4e2a\u70b9\u51fa\u73b0\u65f6\u95f4\u662f\u4e2a\u65f6\u95f4\u8f74\uff0c\u6211\u4eec\u5f88\u663e\u7136\u80fd\u60f3\u5230\u7528\u7ebf\u6bb5\u6811\u5206\u6cbb\u3002  \n\u6ce8\u610f\u8fd9\u4e2a\u5e76\u67e5\u96c6\u9700\u8981\u7ef4\u62a4\u4e24\u4e2a $siz$\uff0c\u5206\u522b\u662f\u5de6\u53f3\u4e24\u90e8\u7684\u5927\u5c0f\u3002  \n\u5177\u4f53\u8fd8\u53ef\u4ee5\u53c2\u8003\u4ee3\u7801\u6ce8\u91ca\u3002  \n\n### Coding.\n```cpp\n//\u613f\u4f60\u548c\u4f60\u91cd\u8981\u7684\u4eba\u80fd\u591f\u518d\u6b21\u91cd\u9022\uff01\n#include<bits/stdc++.h>\nusing namespace std;typedef long long ll;\ntemplate<typename T>inline void read(T &x)\n{\n\tx=0;char c=getchar(),f=0;\n\tfor(;c<'0'||c>'9';c=getchar()) if(!(c^45)) f=1;\n\tfor(;c>='0'&&c<='9';c=getchar()) x=(x<<1)+(x<<3)+(c^48);\n\tif(f) x=-x;\n}\nint n,fa[600005],sz1[600005],sz2[600005],ds[600005];\nstruct node{int x,y,s1,s2,ds;ll rs;}st[600005];int tp;ll res=0;\nmap<pair<int,int>,int>mp;vector<pair<int,int> >T[1200005];\ninline int getf(int x) {return fa[x]==x?x:getf(fa[x]);}//\u4e0d\u8def\u5f84\u538b\u7f29\u7684\u5e76\u67e5\u96c6\ninline void mrg(int x,int y)\n{//\u5408\u5e76\uff0c\u6709\u4e24\u4e2asiz\uff0c\u9700\u8981\u53ef\u64a4\u9500\n\tx=getf(x),y=getf(y);if(x==y) return;else if(ds[x]>ds[y]) swap(x,y);\n\tst[++tp]=(node){x,y,sz1[y],sz2[y],ds[y],res},res-=1ll*sz1[x]*sz2[x]+1ll*sz1[y]*sz2[y];\n\tds[y]+=ds[x]==ds[y],fa[x]=y,sz1[y]+=sz1[x],sz2[y]+=sz2[x],res+=1ll*sz1[y]*sz2[y];\n}\ninline void pop() {int x=st[tp].x,y=st[tp].y;fa[x]=x,ds[y]=st[tp].ds,sz1[y]=st[tp].s1,sz2[y]=st[tp].s2,res=st[tp].rs,tp--;}\ninline void back(int x) {while(tp>x) pop();}//\uff08\u6279\u91cf\uff09\u64a4\u9500\u64cd\u4f5c\ninline void modif(int x,int l,int r,int dl,int dr,pair<int,int>dc)\n{//\u7ebf\u6bb5\u6811\u5408\u5e76\u4e2d\u7684\u4fee\u6539\n\tif(l>dr||dl>r) return;else if(dl<=l&&r<=dr) return T[x].push_back(dc);\n\tmodif(x<<1,l,(l+r)>>1,dl,dr,dc),modif(x<<1|1,((l+r)>>1)+1,r,dl,dr,dc);\n}\ninline void solve(int x,int l,int r)\n{//\u7ebf\u6bb5\u6811\u5408\u5e76\u4e2d\u904d\u5386\u65f6\u95f4\u8f74\n\tint wh=tp;for(int i=0;i<(int)T[x].size();i++) {int a=T[x][i].first,b=T[x][i].second;mrg(a,b);}\n\tif(l==r) return printf(\"%lld \",res),back(wh);else solve(x<<1,l,(l+r)>>1),solve(x<<1|1,((l+r)>>1)+1,r);\n\tback(wh);//\u7ebf\u6bb5\u6811\u5408\u5e76\u9700\u8981\u64a4\u9500\n}\nint main()\n{\n\tread(n);for(int i=1,x,y;i<=n;i++)\n\t{//\u8bfb\u5165\n\t\tread(x),read(y);pair<int,int>p=make_pair(x,y+300000);\n\t\tif(mp[p]) modif(1,1,n,mp[p],i-1,p),mp.erase(p);else mp[p]=i;\n\t}\n\tfor(int i=1;i<=600000;i++) fa[i]=i,(i<=300000?sz1[i]:sz2[i])=1;//\u521d\u59cb\u5316\n\tfor(auto i:mp) modif(1,1,n,i.second,n,i.first);//\u5269\u4f59\u4fee\u6539\n\treturn solve(1,1,n),putchar('\\n'),0;//\u5b8c\u7ed3\u6492\u82b1\uff0c\u6c42\u8d5e\n}\n```",
        "postTime": 1612697745,
        "uid": 44805,
        "name": "Leap_Frog",
        "ccfLevel": 7,
        "title": "CF1140F Extending Set of Points\uff08\u9898\u89e3\uff09"
    },
    {
        "content": "### \u7b80\u8981\u9898\u9762\n\n\u4e8c\u7ef4\u5e73\u9762\u4e0a\u6709\u82e5\u5e72\u4e2a\u70b9\uff0c\u5b9a\u4e49\u4e00\u4e2a\u70b9\u96c6 $S$ \u7684**\u5f20\u96c6**\u4e3a\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u7684\u6700\u5c0f\u96c6\u5408 $T$ \uff1a\n\n- \u5bf9\u4efb\u610f $(x,y)\\in S$ \uff0c $(x,y)\\in T$ \uff1b\n- \u5bf9\u4efb\u610f $(x_0,y_0)\\in T,$ \u82e5\u5b58\u5728 $(x_0,y_1)\\in T$ \u4e14 $(x_1,y_0)\\in T$ \uff0c\u5219 $(x_1,y_1)\\in T$ \u3002\n\u73b0\u5728\u6709 $n$ \u4e2a\u64cd\u4f5c\uff0c\u6bcf\u6b21\u63d2\u5165\u6216\u5220\u9664\u4e00\u4e2a\u70b9\uff0c\u6c42\u6bcf\u6b21\u64cd\u4f5c\u540e\u5f53\u524d\u70b9\u96c6\u7684\u5f20\u96c6\u5927\u5c0f\u3002\n\n### \u5206\u6790\n\n\u8003\u8651\u5982\u4f55\u6c42\u51fa\u4e00\u4e2a\u70b9\u96c6\u7684\u5f20\u96c6\u5927\u5c0f\u3002\n\n\u6211\u4eec~~\u6309\u7167\u5957\u8def~~\uff0c\u628a\u4e00\u4e2a\u70b9 $(x,y)$ \u770b\u6210\u5728\u4e00\u4e2a\u56fe\u4e2d\uff0c\u4ece $1$ \u7c7b\u70b9 $x$ \u8fde\u5411 $2$ \u7c7b\u70b9 $y$ \u3002\u663e\u7136\u5728\u4efb\u610f\u65f6\u523b\uff0c\u8fd9\u4e2a\u56fe\u90fd\u662f\u4e2a**\u4e8c\u5206\u56fe**\u3002\n\n\u8fd9\u65f6\u5019\u5982\u679c\u5de6\u8fb9 $x$ \u4e0e\u53f3\u8fb9 $y$ \u8054\u901a\uff0c\u90a3\u4e48 $T$ \u4e2d\u4e00\u5b9a\u5b58\u5728 $(x,y)$ \u8fd9\u4e2a\u70b9\u3002\n\n\u4e00\u5171\u6709\u591a\u5c11\u4e2a\u70b9\u5462\uff1f\u8bbe\u4e00\u4e2a\u8fde\u901a\u5757\u5de6\u8fb9\u6709 $s_1$ \u4e2a\u70b9\uff0c\u53f3\u8fb9\u6709 $s_2$ \u4e2a\u70b9\uff0c\u90a3\u4e48\u4e00\u5171\u6709 $\\sum s1\\times s2$ \u3002\n\n\u4e5f\u5c31\u662f\u628a\u95ee\u9898\u8f6c\u5316\u6210\uff1a\u4e00\u5f20\u4e8c\u5206\u56fe\uff0c\u652f\u6301\u63d2\u5165\u5220\u9664\u8fb9\u4ee5\u53ca\u7ef4\u62a4\u8fd9\u4e2a\u548c\u3002\n\n\u6211\u4eec\u628a\u6bcf\u6761\u8fb9\u5f04\u51fa\u6765\u4e00\u4e2a\u5b58\u5728\u533a\u95f4\uff0c\u7136\u540e\u505a\u7ebf\u6bb5\u6811\u5206\u6cbb\u3002\n\n\u4e5f\u5c31\u662f\uff0c\u6211\u4eec\u7528\u7c7b\u4f3c\u7ebf\u6bb5\u6811\u7684\u904d\u5386\u65b9\u5f0f\u7ef4\u62a4\u4e00\u4e2a\u6309\u79e9\u5408\u5e76\u5e76\u67e5\u96c6\uff0c\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u6bcf\u4e2a\u8fde\u901a\u5757\u7684 $s_1,s_2$ \u3002\n\n\u800c\u8fd9\u4e2a\u5e76\u67e5\u96c6\u9700\u8981\u652f\u6301\u53ef\u64a4\u9500\uff08\u904d\u5386\u7ebf\u6bb5\u6811\u65f6\u9700\u8981\u56de\u6eaf\uff09\uff0c\u56e0\u6b64\u7528\u6808\u5b58\u4e0b\u6bcf\u6b21\u5408\u5e76\u64cd\u4f5c\u4e4b\u524d\u88ab\u5408\u5e76\u70b9\u7684\u72b6\u6001\u3002\n\n### \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nmap<pair<int,int>,int> mp;\nvector<pair<int,int> >v[1200005];\nint n;\nint fa[600005],siz1[600005],siz2[600005],dis[600005];\nll now;\nstruct node{\n\tint x,y,s1,s2,ds;ll now;\n};\nstack<node> st;\nint get(int x){\n\tif(x==fa[x])return x;\n\telse return get(fa[x]);\n}\nvoid add(int x,int y){\n\tx=get(x),y=get(y);\n\tif(x==y)return;\n\tif(dis[x]>dis[y])swap(x,y);\n\tfa[x]=y;\n\tst.push({x,y,siz1[y],siz2[y],dis[y],now});\n\tnow-=(long long)siz1[x]*siz2[x]+(long long)siz1[y]*siz2[y];\n\tsiz1[y]+=siz1[x],siz2[y]+=siz2[x];\n\tif(dis[y]==dis[x])dis[y]++;\n\tnow+=(long long)siz1[y]*siz2[y];\n}\nvoid pop(){\n\tint x=st.top().x,y=st.top().y;\n\tsiz1[y]=st.top().s1,siz2[y]=st.top().s2,dis[y]=st.top().ds;\n\tfa[x]=x;\n\tnow=st.top().now;\n\tst.pop();\n}\nvoid insert(int k,int l,int r,int x,int y,pair<int,int> z){\n\tif(l>=x&&r<=y){\n\t\tv[k].push_back(z);\n\t\treturn;\n\t}\n\tint mid=l+r>>1;\n\tif(mid>=x)insert(k*2,l,mid,x,y,z);\n\tif(mid<y)insert(k*2+1,mid+1,r,x,y,z);\n}\nvoid solve(int k,int l,int r){\n\tint ht=st.size();\n\tfor(int i=0;i<v[k].size();i++)add(v[k][i].first,v[k][i].second);\n\tif(l==r){\n\t\tprintf(\"%lld \",now);\n\t\twhile(st.size()>ht)pop();\n\t\treturn;\n\t}\n\tint mid=l+r>>1;\n\tsolve(k*2,l,mid);\n\tsolve(k*2+1,mid+1,r);\n\twhile(st.size()>ht)pop();\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++){\n\t\tint x,y;\n\t\tscanf(\"%d%d\",&x,&y);\n\t\ty+=300000;\n\t\tif(mp[make_pair(x,y)]){\n\t\t\tinsert(1,1,n,mp[make_pair(x,y)],i-1,make_pair(x,y));\n\t\t\tmp.erase(make_pair(x,y));\n\t\t}\n\t\telse mp[make_pair(x,y)]=i;\n\t}\n\tfor(int i=1;i<=300000;i++)fa[i]=i,siz1[i]=1;\n\tfor(int i=300001;i<=600000;i++)fa[i]=i,siz2[i]=1;\n\tfor(map<pair<int,int>,int>::iterator i=mp.begin();i!=mp.end();i++)\n\t\tinsert(1,1,n,(*i).second,n,(*i).first);\n\tsolve(1,1,n);\n\treturn 0;\n}\n```",
        "postTime": 1621905529,
        "uid": 233462,
        "name": "Umbrella_Leaf",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1140F Extending Set of Points"
    },
    {
        "content": "[\u524d\u5f80\u6211\u7684\u535a\u5ba2\u83b7\u53d6\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://lookcatbox.github.io/)\n\n\u7ebf\u6bb5\u6811\u5206\u6cbb\u597d\u9898\u3002\n\n\u9996\u5148\u6211\u4eec\u8f6c\u6362\u4e00\u4e0b\u9898\u610f\uff1a\u5c06\u70b9 $(x,y)$ \u770b\u505a\u662f\u8fde\u63a5\u7b2c $x$ \u884c\u548c\u7b2c $y$ \u5217\u7684\u4e00\u6761\u8fb9\u3002\u9898\u76ee\u6240\u8bf4\u7684\u62d3\u5c55\u96c6\u5408\u5927\u5c0f\u5373\u4e3a\u6bcf\u4e00\u4e2a\u8fde\u901a\u5757\u4e2d\u884c\u548c\u5217\u80fd\u5f62\u6210\u4ea4\u70b9\u6570\u3002\u8bbe\u8fde\u901a\u5757\u4e2d\u6709 $x_n$ \u4e2a\u884c\u70b9\uff0c$y_n$ \u4e2a\u5217\u70b9\uff0c\u5219\u8be5\u8fde\u901a\u5757\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e3a $x_n \\times y_n$\n\n\u8003\u8651\u4fee\u6539\u64cd\u4f5c\uff0c\u4e00\u4e2a\u70b9\u4f1a\u5728\u67d0\u4e2a\u65f6\u5019\u51fa\u73b0\uff0c\u67d0\u4e2a\u65f6\u5019\u6d88\u5931\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u6bcf\u4e2a\u70b9\u5728\u65f6\u95f4\u8f74\u4e0a\u662f\u4ee5\u4e00\u4e9b**\u533a\u95f4**\u7684\u5f62\u5f0f\u5b58\u5728\u7684\u3002\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u7528\u4e00\u4e2a\u5e76\u67e5\u96c6\u6765\u7ef4\u62a4\u8fde\u901a\u5757\u4ee5\u53ca\u5176\u8d21\u732e\uff0c\u5e76\u628a\u4fee\u6539\u79bb\u7ebf\u5230\u65f6\u95f4\u8f74\u4e0a\u3002\n\n\u4f46\u6211\u4eec\u53d1\u73b0\u5e76\u67e5\u96c6\u5e76\u4e0d\u662f\u4e00\u79cd\u5229\u4e8e\u5220\u9664\u7684\u64cd\u4f5c\uff0c\u5b83\u53ea\u652f\u6301\u56de\u9000\u6700\u65b0\u7684\u64cd\u4f5c\u3002\u5982\u679c\u6211\u4eec\u8981\u76f4\u63a5\u79bb\u7ebf\u67e5\u8be2\uff0c\u90a3\u8981\u5220\u9664\u5e76\u67e5\u96c6\u91cc\u4e00\u6761\u8fb9\u7684\u65f6\u5019\u8fd9\u6761\u8fb9\u90fd\u4e0d\u77e5\u9053\u8dd1\u5230\u54ea\u91cc\u53bb\u4e86\u3002\u6240\u4ee5\u6211\u4eec\u9700\u8981\u4e00\u79cd\u65b9\u6cd5\u6765\u907f\u514d\u5220\u9664\u64cd\u4f5c\uff0c\u53ea\u7559\u4e0b\u6dfb\u52a0\u548c\u64a4\u56de\u64cd\u4f5c\u3002\n\n\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 **\u7ebf\u6bb5\u6811\u5206\u6cbb**\u3002\u5728\u65f6\u95f4\u8f74\u4e0a\u5efa\u4e00\u68f5\u7ebf\u6bb5\u6811\uff0c\u628a\u6bcf\u4e00\u4e2a\u70b9\u7684\u5b58\u5728\u533a\u95f4\u4e0b\u653e\u5230\u7ebf\u6bb5\u6811\u4e0a\u3002\u7136\u540e\u6211\u4eec\u4ece\u533a\u95f4 $[1,n]$ \u5f00\u59cb\u4e8c\u5206\uff0c\u6bcf\u8fdb\u5165\u4e00\u4e2a\u533a\u95f4\u65f6\u5904\u7406\u6302\u5728\u8fd9\u4e2a\u533a\u95f4\u4e0a\u7684\u4fee\u6539\u64cd\u4f5c\u3002\u8fd9\u6837\u5f53\u6211\u4eec\u5230\u8fbe$[i,i]$ \u8fd9\u4e2a\u65f6\u95f4\u70b9\u65f6\uff0c\u6240\u6709\u8986\u76d6\u5728 $i$ \u8fd9\u4e2a\u65f6\u95f4\u4e0a\u7684\u4fee\u6539\u64cd\u4f5c\u90fd\u5df2\u7ecf\u5904\u7406\u5b8c\u4e86\u3002\u4e4b\u540e\u5728\u9000\u51fa\u4e00\u4e2a\u533a\u95f4\u7684\u65f6\u5019\u5c06\u4fee\u6539\u5168\u90e8\u64a4\u56de\u5373\u53ef\u3002\n\n```cpp\n// Problem: CF1140F Extending Set of Points\n// Contest: Luogu\n// URL: https://www.luogu.com.cn/problem/CF1140F\n// Memory Limit: 1000 MB\n// Time Limit: 3500 ms\n// \n// Powered by CP Editor (https://cpeditor.org)\n\n#include<bits/stdc++.h>\n#define ls k*2\n#define rs k*2+1\n#define mid (l+r)/2\n#define mp make_pair\n#define fi first\n#define se second\n#define pb push_back\n#define int long long\n#define N 600010\nusing namespace std;\ntypedef pair<int,int> pii;\nint read() {\n\tint res=0,f=1;char ch=getchar();\n\twhile(!isdigit(ch)) f=ch=='-'?-1:1,ch=getchar();\n\twhile(isdigit(ch)) res=res*10+ch-'0',ch=getchar();\n\treturn f*res;\n}\nint n,fa[N],size[N],tp;\npii siz[N];\nint find(int x) {\n\twhile(fa[x]!=x) x=fa[x];\n\treturn x;\n}\nmap<pii,int> pt;\nvector<pii> p[N<<2];\nint res;\nstruct node{\n\tint x,y;\n\tpii siz;\n\tint size,res;\n}sk[N];\nvoid merge(int x,int y) {\n\tx=find(x),y=find(y);\n\tif(x==y) return ;\n\tif(size[x]>size[y]) swap(x,y);\n\tsk[++tp]=node{x,y,siz[y],size[y],res};\n\tres-=1ll*siz[x].fi*siz[x].se+1ll*siz[y].fi*siz[y].se;\n\tfa[x]=y,size[y]+=size[x];\n\tsiz[y]=mp(siz[y].fi+siz[x].fi,siz[y].se+siz[x].se);\n\tres+=1ll*siz[y].fi*siz[y].se;\n}\nvoid modify(int k,int l,int r,int L,int R,pii val) \n{\n\tif(L<=l&&r<=R) {p[k].pb(val);return ;}\n\tif(L<=mid) modify(ls,l,mid,L,R,val);\n\tif(R>mid) modify(rs,mid+1,r,L,R,val);\n}\nvoid solve(int k,int l,int r) {\n\tint las=tp;\n\tfor(int i=0; i<p[k].size(); i++) \n\t\tmerge(p[k][i].fi,p[k][i].se);\n\tif(l==r) printf(\"%lld \",res);\n\telse solve(ls,l,mid),solve(rs,mid+1,r);\n\twhile(tp>las) {\n\t    int x=sk[tp].x,y=sk[tp].y;\n\t    fa[x]=x,size[y]=sk[tp].size;\n\t    siz[y]=sk[tp].siz;\n\t    res=sk[tp].res;\n\t    tp--;\n\t}\n}\nsigned main()\n{\n\tn=read();\n\tfor(int i=1; i<=n; i++) {\n\t\tpii tmp=mp(read(),read()+300000);\n\t\tif(pt[tmp]) modify(1,1,n,pt[tmp],i-1,tmp),pt.erase(tmp);\n\t\telse pt[tmp]=i;\n\t}\n\tfor(int i=1; i<=600000; i++) \n\t    fa[i]=i,siz[i]=((i<=300000)?mp(1,0):mp(0,1)),size[i]=1;\n\tfor(auto i:pt) modify(1,1,n,i.se,n,i.fi);\n\tsolve(1,1,n);\n\treturn 0;\n}\n```\n\n\n\n",
        "postTime": 1649922229,
        "uid": 124918,
        "name": "LinkyChristian",
        "ccfLevel": 6,
        "title": "\u3010\u9898\u89e3\u3011CF1140F Extending Set of Points"
    },
    {
        "content": "## \u9898\u89e3\uff1a$CF1140F$\n\n### \u5410\u69fd\uff1a\n\n\u4e3a\u5565\u540c\u673a\u623f\u7684\u5946\u4f6c\u7684\u9898\u90fd\u53ea\u6709$2700$\uff0c\u7136\u540e\u6211$2600$\u3002\u3002\u3002\n\n\u4e07\u91cc\u957f\u5f81\u521a\u521a\u5f00\u59cb\uff0c\u8fd9\u662f\u7b2c\u4e00\u7bc7\u3002\n\n### \u9898\u610f\uff1a\n\n\u7ef4\u62a4\u4e00\u4e2a\u5e73\u9762\u4e0a\u70b9\u7684\u96c6\u5408\uff0c\u652f\u6301\u63d2\u5165\uff0c\u5220\u9664\uff0c\u67e5\u8be2\u6269\u5c55\u96c6\u5408\u7684\u5927\u5c0f\u3002\n\n\u6269\u5c55\u96c6\u5408\u7684\u5b9a\u4e49\uff1a\u53cd\u590d\u8fdb\u884c\u5982\u4e0b\u64cd\u4f5c\uff0c\u76f4\u5230\u4e0d\u80fd\u52a0\u5165\u70b9\u4e3a\u6b62\u3002\n\n\u5c06\u7b26\u5408\u4ee5\u4e0b\u6761\u4ef6\u7684(x2,y2)\u52a0\u5165S\uff08\u6761\u4ef6\uff1a\u5b58\u5728x1,y1\u4f7f\u5f97(x1,y1),(x1,y2),(x2,y1)\u5c5e\u4e8eS\uff09\u3002\n\n### \u601d\u8def\uff1a\n\n\u6211\u4eec\u5148\u8003\u8651\u7ed9\u51fa\u4e00\u4e2a\u70b9\u96c6\uff0c\u5982\u4f55\u8ba1\u7b97\u5b83\u62d3\u5c55\u96c6\u5408\u7684\u5927\u5c0f\u3002\n\n![1.png](https://image.blackwhitetony.com/2020/12/29/67941093a2b78.png)\n\n\u4e0a\u9762\u662f\u6700\u521d\u7684\u96c6\u5408\u3002\n\n![2.png](https://image.blackwhitetony.com/2020/12/29/b4bea39f798d9.png)\n\n\u7ea2\u8272\u662f\u7b2c\u4e00\u6b21\u52a0\u5165\u7684\u70b9\u3002\n\n\u7eff\u8272\u662f\u7b2c\u4e8c\u6b21\u52a0\u5165\u7684\u70b9\u3002\n\n\u6a59\u8272\u662f\u7b2c\u4e09\u6b21\u52a0\u5165\u7684\u70b9\u3002\n\n\u84dd\u8272\u662f\u7b2c\u56db\u6b21\u52a0\u5165\u7684\u70b9\u3002\n\n\u6211\u4eec\u53d1\u73b0\u5176\u5b9e\u5b83\u62d3\u5c55\u6210\u4e86\u4e00\u4e2a\u77e9\u5f62\u3002\n\n\u6211\u4eec\u518d\u753b\u4e00\u4e9b\u56fe\u3002\n\n![3.png](https://image.blackwhitetony.com/2020/12/29/1bb8cc026d2fa.png)\n\n- ![4.png](https://image.blackwhitetony.com/2020/12/29/342bcf9abc6c1.png)\n\n\u89c2\u5bdf\u5230\u4e5f\u662f\u62d3\u5c55\u6210\u4e00\u4e2a\u77e9\u9635\u3002\n\n\u800c\u4e14\u6240\u6709\u7684\u70b9\u6a2a\u7ad6\u8fde\u8fb9\u7684\u8bdd\u56fe\u5c31\u4f1a\u8054\u901a\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e00\u4e2a\u70b9\u4f1a\u548c\u5b83\u540c\u6a2a\u5750\u6807\u7ad6\u5750\u6807\u7684\u70b9\u8054\u901a\uff0c\u800c\u89c2\u5bdf\u4e0a\u8ff0\u4e8c\u4f8b\uff0c\u5176\u96c6\u5408\u5927\u5c0f\u5c31\u662f\u4e00\u4e2a\u8fde\u901a\u5757\u4e2d\u4e0d\u540c\u6a2a\u5750\u6807\u70b9\u7684\u4e2a\u6570\u4e58\u4e0a\u4e0d\u540c\u7eb5\u5750\u6807\u70b9\u7684\u4e2a\u6570\uff0c\u4e8e\u662f\u6211\u4eec\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u8fde\u901a\u5757\uff0c\u5bf9\u4e8e\u6a2a\u7eb5\u5750\u6807\u5206\u522b\u7ef4\u62a4\u96c6\u5408\u5927\u5c0f\uff0c\u7b54\u6848\u5c31\u662f\u5176\u4e58\u79ef\u4e4b\u548c\u3002\u52a0\u5165\u4e00\u4e2a\u70b9\u5c31\u76f8\u5f53\u4e8e\u6a2a\u5750\u6807\u548c\u7eb5\u5750\u6807\u8fde\u8fb9\uff0c\u7136\u540e\uff0c\u6ca1\u4e86\uff1f\n\n\u505c\u505c\u505c\uff0c\u8fd8\u6709\u5220\u9664\u6765\u7740\uff0c\u55ef\u55ef\u5e76\u67e5\u96c6\u4f3c\u4e4e\u4e0d\u652f\u6301\u5220\u9664\u5427\uff0c\u4f46\u5e76\u67e5\u96c6\u770b\u4e0a\u53bb\u662f\u90a3\u4e48\u7684\u53ef\u884c\u8bf6\u3002\n\n\u4e8e\u662f\uff0c\u7ebf\u6bb5\u6811\u5206\u6cbb\u767b\u573a\uff0c\u5b83\u80fd\u5c06\u5e26\u5220\u9664\u64cd\u4f5c\u7684\u9898\u76ee\u4ee5\u4e00\u4e2a$log$\u7684\u4ee3\u4ef7\u8f6c\u5316\u4e3a\u4e0d\u5e26\u5220\u9664\u7684\u9898\u76ee\u3002\n\n### \u7ebf\u6bb5\u6811\u5206\u6cbb\uff1a\n\n\u6211\u4eec\u8003\u8651\u4e00\u4e2a\u70b9\uff0c\u5b83\u52a0\u5165\u4e86\u53c8\u5220\u9664\uff0c\u5f88\u5bb9\u6613\u7528$map$\u6c42\u51fa\u5b83\u8986\u76d6\u7684\u65f6\u95f4\u6bb5\uff0c\u5f53\u7136\uff0c\u8fd9\u9700\u8981\u4e00\u4e2a\u70b9\u5220\u9664\u540e\u5bf9\u7b54\u6848\u7684\u5f71\u54cd\u6d88\u5931\u3002\n\n\u5f88\u5bb9\u6613\u60f3\u5230\u5f00\u4e00\u9897\u7ef4\u62a4\u65f6\u95f4\u7684\u7ebf\u6bb5\u6811\uff0c\u5c06\u4e00\u4e2a\u64cd\u4f5c\u8986\u76d6\u7684\u65f6\u95f4\u6bb5\u4e0a\u7684\u8282\u70b9\u6253\u4e0a\u8fd9\u4e2a\u64cd\u4f5c\uff0c\u67e5\u8be2\u65f6\u5bf9\u7ebf\u6bb5\u6811\u8fdb\u884c$dfs$\u5c31\u53ef\u4ee5\u5728\u53f6\u5b50\u8282\u70b9\u5f97\u5230\u7b54\u6848\u4e86\u3002\n\n\u522b\u5fd9\uff0c\u56de\u6eaf\u600e\u4e48\u529e\uff0c\u4e0d\u8fd8\u662f\u8981\u5220\u70b9\u5417\uff1f\u55ef\uff0c\u597d\u597d\u60f3\u60f3\uff0c\u5b83\u53ea\u9700\u8981\u64a4\u9500\u524d\u4e00\u4e2a\u64cd\u4f5c\u554a\uff0c\u53ef\u64a4\u9500\u5e76\u67e5\u96c6\u554a\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5feb\u4e50\u5730\u641e\u5b9a\u4e86\u8fd9\u9053\u9898\u3002\n\n### \u4ee3\u7801\u548c\u5b9e\u73b0\u4e2d\u7684\u7ec6\u8282\u95ee\u9898\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<set>\n#include<map>\n#include<queue>\n#include<cmath>\n#include<string>\n#include<cstring>\n#include<ctime>\n#include<stack>\n#include<vector>\n#define next nxt\n#define itn int\n#define y1 y3647\n#define LL long long\nusing namespace std;\ninline void read(int &x)\n{\n\tx=0;\n\tint f=1;\n\tchar ch=getchar();\n\twhile((ch<'0'||ch>'9')&&ch!='-')\n\tch=getchar();\n\tif(ch=='-')\n\t{\n\t\tf=-1;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9')\n\t{\n\t\tx=x*10+ch-'0';\n\t\tch=getchar();\n\t}\n\tx*=f;\n}\nconst int N=3e5+10;\nint i,j,k,m,n,s,t,top,tc;\nmap <pair<int,int>,int> mp;\nmap <pair<int,int>,int> ::iterator it;\nvector <pair<int,int> > a[N<<2];\nstruct bc{\n\tint v,fv,u,s1u,s2u;\n}sta[N<<6];\nint fa[N<<1],size1[N<<1],size2[N<<1],root[N<<1];\nint find(int x)\n{\n\tif(fa[x]==x)\n\treturn x;\n\treturn find(fa[x]);\n}\nvoid updata(int l,int r,int rt,int x,int y,pair<int,int> op)\n{\n\tif(x<=l&&y>=r)\n\t{\n\t\ta[rt].push_back(op);//vector\u771f\u7684\u5f88\u9999\n\t\treturn;\n\t}\n\tint mid=(l+r)/2;\n\tif(x<=mid)\n\tupdata(l,mid,rt<<1,x,y,op);\n\tif(y>mid)\n\tupdata(mid+1,r,rt<<1|1,x,y,op);\n}\nlong long put(int u,int v,long long c)\n{\n\tu=find(u),v=find(v);\n\tif(u==v)\n\treturn c;\n\ttc++;\n\tif(size1[u]+size2[u]>size1[v]+size2[v])\n\tswap(u,v);\n\tsta[++top]=(bc){u,fa[u],v,size1[v],size2[v]};//\u6539\u53d8\u7684\u6709\u4ee5\u4e0b\uff1au\u7684fa\uff0cv\u7684size1,size2\u3002\n\tfa[u]=v;\n\tc-=(long long)size1[v]*size2[v];\n\tc-=(long long)size1[u]*size2[u];\n\tsize1[v]+=size1[u];\n\tsize2[v]+=size2[u];\n\tc+=(long long)size1[v]*size2[v];//\u7b2c\u4e00\u53d1WA\u6ca1\u5f00longlong\n\treturn c;\n}\nvoid dfs(int l,int r,int rt,long long ans)\n{\n\ttc=0;\n\tfor(int i=0;i<a[rt].size();i++)\n\tans=put(a[rt][i].first,a[rt][i].second,ans);\n\tint cc=tc;\n\tif(l==r)\n\t{\n\t\tprintf(\"%lld \",ans);\n\t\tfor(int i=0;i<cc;i++)\n\t\t{\n\t\t\tfa[sta[top].v]=sta[top].fv;\n\t\t\tsize1[sta[top].u]=sta[top].s1u;\n\t\t\tsize2[sta[top].u]=sta[top].s2u;\n\t\t\ttop--;\n\t\t}\n\t\treturn;\n\t}\n\tint mid=(l+r)/2;\n\tdfs(l,mid,rt<<1,ans);\n\tdfs(mid+1,r,rt<<1|1,ans);\n\tfor(int i=0;i<cc;i++)\n\t{\n\t\tfa[sta[top].v]=sta[top].fv;\n\t\tsize1[sta[top].u]=sta[top].s1u;\n\t\tsize2[sta[top].u]=sta[top].s2u;\n\t\ttop--;\n\t}\n}\nint main()\n{\n\t//freopen(\".in\",\"r\",stdin);\n\t//freopen(\".out\",\"w\",stdout);\n\t//freopen(\".ans\",\"w\",stdout);\n\tread(n);\n\tfor(i=1;i<=n;i++)\n\t{\n\t\tint x,y;\n\t\tread(x),read(y);\n\t\tint tmp=mp[make_pair(x,y)];\n\t\tif(tmp)\n\t\t{\n\t\t\tupdata(1,n,1,tmp,i-1,make_pair(x,y+3e5));//\u6ce8\u610f\u662fi-1\u56e0\u4e3a\u5728i\u5904\u5df2\u7ecf\u5220\u53bb\u4e86\u8fd9\u4e2a\u70b9\n\t\t\tmp.erase(make_pair(x,y));\n\t\t}\n\t\telse\n\t\tmp[make_pair(x,y)]=i;\n\t}\n\tfor(it=mp.begin();it!=mp.end();it++)\n\tupdata(1,n,1,(*it).second,n,make_pair(it->first.first,it->first.second+3e5));//\u5728\u6700\u540e\u7684\u65f6\u95f4\u628a\u6240\u6709\u64cd\u4f5c\u52a0\u5165\u3002\n\tfor(i=1;i<=3e5;i++)\n\t{\n\t\tfa[i]=i;\n\t\tsize1[i]=1;\n\t}\n\tfor(i=3e5+1;i<=6e5;i++)\n\t{\n\t\tfa[i]=i;\n\t\tsize2[i]=1;\n\t}\n\tdfs(1,n,1,0);\n\treturn 0;\n}\n```\n\n### \u5404\u4f4d\u770b\u5b98\u770b\u5230\u8fd9\u91cc\u5c31\u53ef\u4ee5\u4e86\uff0c\u4e0b\u9762\u662f\u7ed9\u81ea\u5df1\u770b\u7684\u3002\n\n\u67d0\u5927\u725b\u4ee3\u7801\uff1a\n\n```cpp\npx[top]=x; py[top]=y; fa[y]=x;\nsz1[x]+=sz1[y]; sz2[x]+=sz2[y];\n------------------------------\nint x=px[top],y=py[top];\nfa[y]=y;\nsz1[x]-=sz1[y];\nsz2[x]-=sz2[y];\n```\n\n\u6211\u81ea\u5df1\u7684\u5bf9\u5e94\u90e8\u5206\uff1a\n\n```cpp\nsta[++top]=(bc){u,fa[u],v,size1[v],size2[v]};\n--------------------------------------------\nfor(int i=0;i<cc;i++)\n{\n\tfa[sta[top].v]=sta[top].fv;\n\tsize1[sta[top].u]=sta[top].s1u;\n\tsize2[sta[top].u]=sta[top].s2u;\n\ttop--;\n}\n```\n\n\u663e\u7136\u7ef4\u62a4\u7684\u4fe1\u606f\u6709\u4e9b\u5197\u4f59\uff0c\u8fd9\u53c8\u662f\u7a7a\u95f4\u590d\u6742\u5ea6\u74f6\u9888\uff0c\u4e8e\u662f\u3002\u3002\u3002\n\n### \u53cd\u601d\uff1a\n\n\u8fd9\u79cd\u9898\u8981\u591a\u753b\u56fe\u60f3\u4e00\u60f3\uff0c\u5176\u5b9e\u6700\u5f00\u59cb\u6211\u5c31\u8003\u8651\u4e86\u7ebf\u6bb5\u6811\u5206\u6cbb\uff0c\u4f46\u662f\u6211\u4f3c\u4e4e\u4e0d\u4f1a\u9759\u6001\u95ee\u9898\u3002\n\n$vector$\u76f8\u5f53\u7684\u597d\u7528\u3002\n\n\u53ef\u64a4\u9500\u5e76\u67e5\u96c6\u5b9e\u73b0\u8fd8\u6709\u4e9b\u4e0d\u719f\u7ec3\u3002\n\n\n\n",
        "postTime": 1609214144,
        "uid": 177535,
        "name": "CDFLS_mao_zx",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1140F \u3010Extending Set of Points\u3011"
    },
    {
        "content": "### Description\n\n\u5b9a\u4e49\u4e00\u4e2a\u70b9\u96c6\u5408 $S=\\{(x_i,y_i)\\}(1\\leq i\\leq n)$ \u7684\u62d3\u5c55\u64cd\u4f5c\u4e3a\u5c06\u7b26\u5408\u4ee5\u4e0b\u6761\u4ef6\u7684 $(x_0,y_0)$ \u52a0\u5165 $S$\uff1a\n\n- \u5b58\u5728 $a,b$\uff0c\u4f7f\u5f97 $(a,b),(a,y_0),(x_0,b)\\in S$\u3002\n\n\u4e0d\u65ad\u6267\u884c\u4ee5\u4e0a\u64cd\u4f5c\u76f4\u5230\u4e0d\u80fd\u64cd\u4f5c\uff0c\u6b64\u65f6\u5f97\u5230\u7684\u96c6\u5408\u5373\u4e3a\u62d3\u5c55\u96c6\u5408\u3002\u73b0\u5728\u7ed9\u5b9a $q$ \u4e2a\u64cd\u4f5c\uff0c\u6bcf\u6b21\u52a0\u5165\u6216\u5220\u9664\u4e00\u4e2a\u70b9\uff0c\u8f93\u51fa\u6bcf\u4e2a\u64cd\u4f5c\u4e4b\u540e\u7684\u62d3\u5c55\u96c6\u5408\u5927\u5c0f\u3002\n\n- $q,x_i,y_i\\le 3\\times10^5$\u3002\n\n### Solution\n\n\u6761\u4ef6\u4e3a\u5b58\u5728 $a,b$\uff0c\u4f7f\u5f97 $(a,b),(a,y_0),(x_0,b)\\in S$\uff0c\u90a3\u4e48\u53ef\u4ee5\u8f6c\u5316\u6210\u56fe\u8bba\u95ee\u9898\u3002\u8003\u8651\u5efa\u4e8c\u5206\u56fe\uff0c\u5de6\u90e8\u4e3a\u884c\uff0c\u53f3\u90e8\u4e3a\u5217\u3002\u6bcf\u4e2a\u70b9 $(x,y)$ \u5373\u5c06 $l_x$ \u548c $r_y$ \u8fde\u8fb9\uff08$l_i$ \u8868\u793a\u5de6\u90e8\u7b2c $x$ \u4e2a\u70b9\uff0c$r_i$ \u540c\u7406\uff09\u3002\u627e\u89c4\u5f8b\u540e\u4e0d\u96be\u53d1\u73b0\u8fd9\u4e2a\u4e8c\u5206\u56fe\u8865\u5168\u540e\uff0c\u6bcf\u4e2a\u8fde\u901a\u5757\u5404\u4f1a\u53d8\u6210\u4e00\u4e2a**\u5b8c\u5168\u4e8c\u5206\u56fe**\u3002\n\n\u8fd9\u4e2a\u5b8c\u5168\u4e8c\u5206\u56fe\u7684\u8fb9\u6570\u5c31\u662f\u5de6\u90e8\u7684\u5927\u5c0f\u4e58\u4e0a\u53f3\u90e8\u7684\u5927\u5c0f\u3002\n\n\u53ea\u6709\u52a0\u8fb9\u64cd\u4f5c\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u8fd9\u4e2a\u4e8c\u5206\u56fe\uff0c\u5e76\u65f6\u523b\u6c42\u51fa\u7b54\u6848\u3002\n\n\u8003\u8651\u5220\u8fb9\uff0c\u53d1\u73b0\u6bcf\u6761\u8fb9\u90fd\u6709\u51fa\u73b0\u533a\u95f4\uff0c\u8fd9\u4e9b\u533a\u95f4\u6570\u662f $O(q)$ \u7684\uff0c\u5e76\u4e14\u4e0a\u9762\u53ea\u6709\u52a0\u8fb9\u7684\u5f31\u5316\u7248\u53ef\u4ee5\u4f7f\u7528\u5e76\u67e5\u96c6\u89e3\u51b3\uff0c\u8fd9\u542f\u53d1\u6211\u4eec\u4f7f\u7528\u7ebf\u6bb5\u6811\u5206\u6cbb\u3002\u628a\u5e76\u67e5\u96c6\u66ff\u6362\u6210\u53ef\u64a4\u9500\u5e76\u67e5\u96c6\u5373\u53ef\u3002\n\n\u590d\u6742\u5ea6 $O(q\\log q\\log w)$\uff0c$w$ \u4e3a $x_i,y_i$ \u503c\u57df\uff0c\u9898\u76ee\u4e2d\u4e0e $q$ \u540c\u9636\u3002\n\n[\u8bc4\u6d4b\u8bb0\u5f55\u3002](https://codeforces.com/contest/1140/submission/180703650)",
        "postTime": 1668312824,
        "uid": 306573,
        "name": "Ender32k",
        "ccfLevel": 0,
        "title": "CF1140F Extending Set of Points \u9898\u89e3"
    }
]
[
    {
        "content": "# CF1666J \u9898\u89e3\n\n\n\n## \u601d\u8def\u5206\u6790\n\n\u8bb0 $dp_{l,r}$ \u8868\u793a\u533a\u95f4 $[l,r]$ \u4e2d\u6240\u6709\u70b9**\u8d21\u732e**\u4e4b\u548c\u7684\u6700\u5c0f\u503c\uff0c\u6211\u4eec\u679a\u4e3e $dp_{l,r}$ \u4e2d\u7684\u6839 $k$\uff0c\u5219 $[l,k)$ \u4e3a $k$ \u7684\u5de6\u5b50\u6811\uff0c$(k,r]$ \u4e3a $k$ \u7684\u53f3\u5b50\u6811\u3002\n\n\u4e00\u4e2a\u663e\u7136\u7684\u60f3\u6cd5\u662f\u628a $d_{i,j}$ \u62c6\u5206\u5230\u6bcf\u6761\u8fb9\u4e0a\u7edf\u8ba1\uff0c\u6bcf\u6761\u8fb9\u5bf9\u7b54\u6848\u4ea7\u751f\u591a\u5c11\u8d21\u732e\u90a3\u4e48\u6bcf\u6b21\u5408\u5e76\u4e24\u68f5\u5b50\u6811\u7684\u65f6\u5019\u4ea7\u751f\u7684\u65b0\u8d21\u732e\u4e3a\uff1a\u5de6\u5b50\u6811\u5185\u6bcf\u4e2a\u70b9\u5230\u5de6\u5b50\u6811\u5916\u6bcf\u4e2a\u70b9\u7684\u901a\u8bdd\u6570\u52a0\u4e0a\u53f3\u5b50\u6811\u5185\u6bcf\u4e2a\u70b9\u5230\u53f3\u5b50\u6811\u5916\u6bcf\u4e2a\u70b9\u7684\u901a\u8bdd\u6570\u3002\n\n\u5047\u8bbe\u6211\u4eec\u8bb0 $C_{\\mathbf {I_1},\\mathbf {I_2}}$ \u4e3a $x\\in \\mathbf {I_1},y\\in\\mathbf{I_2}$ \u7684 $c_{x,y}$ \u7684\u548c\uff0c\u5176\u4e2d $\\mathbf{I_1},\\mathbf{I_2}$ \u4e3a\u4e24\u4e2a\u533a\u95f4\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e8c\u7ef4\u524d\u7f00\u548c\u5feb\u901f\u67e5\u8be2\uff0c\u90a3\u4e48\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5982\u4e0b\uff1a\n$$\ndp_{l,r}=\\max_{k=l}^r\\{dp_{l,k-1}+dp_{k+1,r}+(C_{[l,k),[1,l)}+C_{[l,k),[k,n]})+(C_{(k,r],[1,k]}+C_{(k,r],(r,n]})\\}\n$$\n\u6784\u9020\u65b9\u6848\u65f6\u8bb0\u5f55\u6bcf\u4e2a $[l,r]$ \u8f6c\u79fb\u65f6\u6700\u4f18\u7684 $k$\uff0c\u9012\u5f52\u8ba1\u7b97 $[l,k)$ \u548c $(k,r]$ \u5b50\u6811\u7684\u5f62\u6001\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n^3)$\u3002\n\n## \u4ee3\u7801\u5448\u73b0\n\n```cpp\n#include<bits/stdc++.h> \n#define int long long\nusing namespace std;\nconst int MAXN=201,INF=1e17;\nint dp[MAXN][MAXN],rt[MAXN][MAXN],c[MAXN][MAXN],sum[MAXN][MAXN],fa[MAXN];\ninline void dfs(int l,int r,int f) {\n\tif(l>r) return ;\n\tint k=rt[l][r];\n\tfa[k]=f;\n\tdfs(l,k-1,k),dfs(k+1,r,k);\n}\ninline int cnt(int r1,int r2,int c1,int c2) {\n\tif(r1>r2||c1>c2) return 0;\n\treturn sum[r2][c2]-sum[r2][c1-1]-sum[r1-1][c2]+sum[r1-1][c1-1];\n}\nsigned main() {\n\tint n;\n\tscanf(\"%lld\",&n);\n\tfor(int i=1;i<=n;++i) {\n\t\tfor(int j=1;j<=n;++j) {\n\t\t\tscanf(\"%lld\",&c[i][j]);\n\t\t\tsum[i][j]=sum[i-1][j]+sum[i][j-1]-sum[i-1][j-1]+c[i][j];\n\t\t}\n\t}\n\tfor(int i=1;i<=n;++i) for(int j=1;j<=n;++j) dp[i][j]=INF;\n\tfor(int i=1;i<=n;++i) dp[i][i]=0,rt[i][i]=i;\n\tfor(int len=1;len<n;++len) {\n\t\tfor(int l=1,r=l+len;r<=n;++l,++r) {\n\t\t\tfor(int k=l;k<=r;++k) {\n\t\t\t\tint val=cnt(l,k-1,1,l-1)+cnt(l,k-1,k,n)+\n\t\t\t\t\t\tcnt(k+1,r,1,k)+cnt(k+1,r,r+1,n)+\n\t\t\t\t\t\t(k==l?0:dp[l][k-1])+(k==r?0:dp[k+1][r]);\n\t\t\t\tif(val<dp[l][r]) rt[l][r]=k,dp[l][r]=val;\n\t\t\t}\n\t\t}\n\t}\n\tdfs(1,n,0);\n\tfor(int i=1;i<=n;++i) printf(\"%lld \",fa[i]);\n\tputs(\"\");\n\treturn 0;\n}\n```\n\n",
        "postTime": 1672559990,
        "uid": 539618,
        "name": "DaiRuiChen007",
        "ccfLevel": 6,
        "title": "CF1666J \u9898\u89e3"
    },
    {
        "content": "# CF1666J\n\n\u6811\u5f62+\u533a\u95f4dp\n\n\u8bbe $dp_{l,r}$ \u4e3a l \u5230 r \u7684\u533a\u95f4\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n\u90a3\u4e48\u679a\u4e3e\u8fd9\u4e00\u6bb5\u7684\u6839 k\uff0c\u4e8e\u662f\n$$\ndp_{l,r}=\\min_{k=l}^r{dp_{l,k-1}+dp_{k+1,r}+\\sum_{i\\in[l,k-1]}(\\sum_{j\\in[0,l-1]}a_{i,j}+\\sum_{j\\in[k,n-1]}a_{i,j})+\\sum_{i\\in[k+1,r]}(\\sum_{j\\in[0,k]}a_{i,j}+\\sum_{j\\in[r+1,n-1]}a_{i,j})}\n$$\n\n\u540e\u9762\u7684\u53ef\u4ee5\u7528\u4e8c\u7ef4\u524d\u7f00\u548c\u505a\u3002\n\n```c++\nint calc(int l1,int r1,int l2,int r2){\n\tre sum[r1][r2]-sum[l1-1][r2]-sum[r1][l2-1]+sum[l1-1][l2-1];\n}\n```\n\u5b8c\u6574\u4ee3\u7801\uff1a\n```c++\nint a[202][202];\npii dp[202][202];\nint sum[202][202];\nint calc(int l1,int r1,int l2,int r2){\n\tre sum[r1][r2]-sum[l1-1][r2]-sum[r1][l2-1]+sum[l1-1][l2-1];\n}\nint ans[202];\nvoid getans(int l,int r,int p){\n\tif(r<l)re;//cout<<l<<\" \"<<r<<\" \"<<p<<\"\\n\";\n\tans[dp[l][r].S]=p;\n\tgetans(l,dp[l][r].S-1,dp[l][r].S);\n\tgetans(dp[l][r].S+1,r,dp[l][r].S);\n}\nvoid run(){\n\tint n;\n\tcin>>n;\n\trept(i,1,n+1)rept(j,1,n+1){\n\t\tcin>>a[i][j];\n\t\tsum[i][j]=sum[i-1][j]+sum[i][j-1]-sum[i-1][j-1]+a[i][j];\n\t}\n\trept(i,1,n+1)rept(j,1,n+1)dp[i][j]={0,i};\n\trept(i,1,n+1)dp[i][i]={0,i};\n\trept(d,1,n){\n\t\tfor(int l=1,r=d+1;r<=n;l++,r++){\n\t\t\tdp[l][r]={INF,INF};\n\t\t\trept(k,l,r+1){\n\t\t\t\tint cc=dp[l][k-1].F+dp[k+1][r].F;\n\t\t\t\tcc+=calc(l,k-1,1,l-1);\n\t\t\t\tcc+=calc(l,k-1,k,n);\n\t\t\t\tcc+=calc(k+1,r,1,k);\n\t\t\t\tcc+=calc(k+1,r,r+1,n);\n\t\t\t\tMi(dp[l][r],{cc,k});\n\t\t\t}\n\t\t}\n\t}\n\tgetans(1,n,0);\n\trept(i,1,n+1)cout<<ans[i]<<\" \";\n\tcout<<\"\\n\";\n}\n```\n\u6ce8\u610f\u8bb0\u5f55\u8def\u5f84\u3002\n",
        "postTime": 1650089205,
        "uid": 483879,
        "name": "hyman00",
        "ccfLevel": 0,
        "title": "CF1666J\u9898\u89e3"
    },
    {
        "content": "# [\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF1666J) \r\n## \u524d\u8a00\r\n\u663e\u7136\uff0c\u7531\u9898\u6613\u77e5\u6bcf\u68f5\u5b50\u6811\u7684\u8282\u70b9\u7f16\u53f7\u662f\u4e00\u6bb5\u8fde\u7eed\u7684\u533a\u95f4\uff0c\u6240\u4ee5\u53ef\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528\u533a\u95f4 DP \u505a\u8fd9\u9053\u9898\u3002\r\n## \u601d\u8def\r\n\u6211\u4eec\u77e5\u9053\u6811\u4e0a\u4e24\u70b9\u4e4b\u95f4\u53ea\u6709\u4e00\u6761\u8fb9\uff0c\u6240\u4ee5\u6211\u4eec\u6ca1\u6709\u5fc5\u8981\u53bb\u6c42\u4e24\u70b9\u4e4b\u95f4\u7684\u8def\u5f84\uff0c\u6211\u4eec\u8981\u5c06 $c_{i,j},d_{i,j}$ \u8f6c\u6362\u4e3a $c_{i,j}$\uff0c$\\left(\\begin{matrix}\\underbrace{1+1+\\dots+1}\\\\d_{i,j}\\end{matrix}\\right)$ \u5176\u4e2d\u7684 $1$ \u5219\u662f\u4ee3\u8868\u6bcf\u4e00\u6761\u8fb9\uff0c\u628a\u8d39\u7528\u5206\u914d\u5230\u6bcf\u4e00\u6761\u8fb9\u3002\r\n\r\n\u600e\u4e48\u5224\u65ad\u4e24\u4e2a\u70b9\u8981\u4e0d\u8981\u7ecf\u8fc7\u4e00\u6761\u8fb9\u5462\uff0c\u53ea\u9700\u8981\u770b\u4e00\u9897\u5b50\u6811\u4e4b\u4e2d\uff0c\u5728\u5b50\u6811\u91cc\u9762\u7684\u70b9\u4e0e\u5728\u5b50\u6811\u5916\u9762\u7684\u70b9\u662f\u5fc5\u7136\u7ecf\u8fc7\u5b50\u6811\u6839\u8282\u70b9\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u6bcf\u6b21\u8ba1\u7b97\u6240\u6709\u5b50\u6811\u91cc\u9762\u4e0e\u5916\u9762\u7684\u70b9\u7ecf\u8fc7\u5b50\u6811\u6839\u8282\u70b9\u7684\u603b\u548c\u5c31\u53ef\u4ee5\u4e86\u3002\r\n\r\n\u8bbe $f_{l,r}$ \u8868\u793a $l$ \u5230 $r$ \u533a\u95f4\u7684\u6700\u5c0f\u82b1\u8d39\u3002\r\n\r\n\r\n\u8f6c\u79fb\u65f6\u679a\u4e3e\u8fd9\u4e00\u6bb5\u533a\u95f4\u7684\u6839\u8282\u70b9 $k$\uff1a\r\n\r\n$f_{l,r}=\\min(f_{l,r},f_{l,k-1}+f_{k+1,r}+\\sum_{i=l}^{k-1}\\left(\\sum_{j=1}^{l-1}c_{i,j}+\\sum_{j=k}^nc_{i,j}\\right)+\\sum_{i=k+1}^r\\left(\\sum_{j=1}^kc_{i,j}+\\sum_{j=r+1}^nc_{i,j}\\right)$\r\n\r\n\r\n\u800c\u540e\u9762\u7684 $\\sum_{i=l}^{k-1}\\left(\\sum_{j=1}^{l-1}c_{i,j}+\\sum_{j=k}^nc_{i,j}\\right)+\\sum_{i=k+1}^r\\left(\\sum_{j=1}^kc_{i,j}+\\sum_{j=r+1}^nc_{i,j}\\right)$ \u5c31\u5b8c\u5168\u53ef\u4ee5\u7528\u4e8c\u7ef4\u524d\u7f00\u548c\u6765\u505a\u3002\r\n\r\n\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a $O\\left(n^3\\right)$ \u65f6\u95f4\u590d\u6742\u5ea6\u7684\u7b97\u6cd5\u4e86\u3002\r\n## \u5b8c\u6574\u4ee3\u7801\r\n```cpp\r\n#include<bits/stdc++.h>\r\nusing namespace std;\r\nlong long n,a[1000][1000],pre[1000][1000],f[1000][1000],y[1000][1000],fa[1000];\r\nvoid find(int now,int l,int r){//\u67e5\u627e\u6bcf\u4e00\u4e2a\u70b9\u7684\u7236\u8282\u70b9\r\n\tif(l==r)return;\r\n\tfa[y[l][now-1]]=now;\r\n\tfa[y[now+1][r]]=now;\r\n\tif(now>1)find(y[l][now-1],l,now-1);\r\n\tif(now<n)find(y[now+1][r],now+1,r);\r\n}\r\nint main(){\r\n\tmemset(f,0x3f,sizeof(f));\r\n\tcin>>n;\r\n\tfor(int i=1;i<=n;i++)\r\n\t\tfor(int j=1;j<=n;j++)\r\n\t\t\tcin>>a[i][j];\r\n\tfor(int i=1;i<=n;i++)//\u4e8c\u4f4d\u524d\u7f00\u548c\r\n\t\tfor(int j=1;j<=n;j++)\r\n\t\t\tpre[i][j]=a[i][j]+pre[i-1][j]+pre[i][j-1]-pre[i-1][j-1];\r\n\tfor(int i=1;i<=n;i++)f[i][i]=0,y[i][i]=i;//\u5bf9l=r\u7684\u8fdb\u884c\u521d\u59cb\u5316\r\n\tfor(int k=2;k<=n;k++){//\u679a\u4e3e\u957f\u5ea6\uff0c\u4fdd\u8bc1\u7b97\u6cd5\u7684\u53ef\u884c\u6027\r\n\t\tfor(int l=1;l<=n-k+1;l++){//\u679a\u4e3e\u5de6\u8282\u70b9\r\n\t\t\tlong long r=l+k-1;//\u8ba1\u7b97\u53f3\u8282\u70b9\r\n\t\t\tfor(int m=l;m<=r;m++){//\u679a\u4e3e\u5b50\u6811\u6839\u8282\u70b9\r\n\t\t\t\tlong long ls=pre[m-1][n]-pre[l-1][n]-(pre[m-1][m-1]-pre[l-1][m-1]-pre[m-1][l-1]+pre[l-1][l-1]);\r\n\t\t\t\tlong long rs=pre[r][n]-pre[m][n]-(pre[r][r]-pre[m][r]-pre[r][m]+pre[m][m]);//\u4e8c\u4f4d\u524d\u7f00\u548c\u6c42\u503c\r\n\t\t\t\tlong long ll=f[l][m-1],rr=f[m+1][r];\r\n\t\t\t\tif(m==l)ll=0,ls=0;if(m==r)rr=0,rs=0;//\u7279\u5224\u8fb9\u754c\u60c5\u51b5\r\n\t\t\t\tif(f[l][r]>=ll+rr+ls+rs){\r\n\t\t\t\t\tf[l][r]=ll+rr+ls+rs;\r\n\t\t\t\t\ty[l][r]=m;//\u8bb0\u5f55\u4e0b\u6b64\u5b50\u6811\u7684\u6839\u8282\u70b9\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tfind(y[1][n],1,n);\r\n\tfor(int i=1;i<=n;i++)cout<<fa[i]<<\" \";\r\n\treturn 0;//\u5b8c\u7ed3\u6492\u82b1\r\n}\r\n```",
        "postTime": 1666453285,
        "uid": 765493,
        "name": "OIerBoy",
        "ccfLevel": 0,
        "title": "CF1666J\u9898\u89e3"
    }
]
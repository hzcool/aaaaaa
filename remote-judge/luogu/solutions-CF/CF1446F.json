[
    {
        "content": "- [CF1446F Line Distance](https://www.luogu.com.cn/problem/CF1446F)\n\n---\n\n\u9996\u5148\u7b54\u6848\u80af\u5b9a\u53ef\u4ee5\u4e8c\u5206\uff0c$\\rm check(R)$ \u65f6\u6211\u4eec\u9700\u8981\u6c42\u591a\u5c11\u6761\u76f4\u7ebf\u4e0e $(0,0)$ \u76f8\u8ddd $\\le R$ \u3002\n\n\u7136\u540e\u753b\u753b\u56fe\uff0c\u611f\u89c9\u5f88\u96be\u7edf\u8ba1\u3002\n\n\u8fd9\u91cc\u8981\u7528\u5230\u4e00\u4e2a\u795e\u4ed9\u8f6c\u5316\uff1a\n\n\u4ee5 $(0,0)$ \u4e3a\u5706\u5fc3\uff0c$R$ \u4e3a\u534a\u5f84\u753b\u4e2a\u5706\uff0c\u5706\u5185/\u5706\u4e0a\u7684\u70b9\u4e0e\u5176\u4ed6\u70b9\u8fde\u7ebf\u4e00\u5b9a\u8ddd\u79bb $\\le R$\uff0c\u8fd9\u6837\u53ea\u8981\u8003\u8651\u5706\u5916\u7684\u70b9\u3002\n\n\u6bcf\u4e2a\u5706\u5916\u7684\u70b9\u5bf9\u5706\u4f5c\u4e24\u6761\u5207\u7ebf\uff0c\u53ef\u4ee5\u5f97\u5230\u4e00\u6bb5\u5706\u5f27\u3002\n\n**\u4e24\u4e2a\u5706\u5916\u7684\u70b9 $(x_i,y_i),(x_j,y_j)$ \u8fde\u7ebf\u4e0e $(0,0)$ \u8ddd\u79bb $> R$\uff0c\u5f53\u4e14\u4ec5\u5f53\u5b83\u4eec\u6295\u5c04\u7684\u4e24\u6bb5\u5706\u5f27\u6709\u4ea4\u96c6\u4e14\u4e0d\u5305\u542b\u3002**\n\n\u5982\u56fe\uff0c\u53ef\u4ee5\u89c2\u5bdf\u4e00\u4e0b CD \u4e0e CE\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/is7hj9z1.png)\n\n\u4e8e\u662f\u95ee\u9898\u8f6c\u5316\u4e3a\uff0c\u5728\u5706\u4e0a\u6709\u82e5\u5e72\u5706\u5f27\uff0c\u6c42\u6709\u591a\u5c11\u5bf9\u5706\u5f27\u76f8\u4ea4\u4f46\u4e0d\u5305\u542b\u3002\n\n\u8fd9\u6837\u770b\u8d77\u6765\u53ef\u505a\u591a\u4e86\uff0c\u4f46\u662f\u4f3c\u4e4e\u4e0d\u592a\u597d\u5904\u7406\u3002\n\n\u4e8e\u662f\u849f\u84bb\u4e71\u753b\u4e86\u4e00\u4e0b\uff0c\u5f97\u5230\u53e6\u4e00\u4e2a\u6027\u8d28\uff1a\u4e00\u6bb5\u5706\u5f27\u7ffb\u8f6c\u4ee5\u540e\uff0c\u5bf9\u7b54\u6848\u6ca1\u6709\u5f71\u54cd\u3002\n\n\u90a3\u5c31\u5728\u5706\u4e0a\u67d0\u70b9\u62c6\u5f00\uff0c\u62c6\u6210\u4e00\u6761\u76f4\u7ebf\uff0c\u5982\u679c\u6709\u8de8\u8d8a\u8fd9\u4e2a\u70b9\u4e24\u6bb5\u7684\u5706\u5f27\u5c31\u7ffb\u8f6c\u3002\n\n\u7136\u540e\u79bb\u6563\u5316+\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u5373\u53ef\uff0c$O(n\\log n\\log V)$\n\n```cpp\n#include<bits/stdc++.h>\n#define For(i,a,b) for(register int i=(a);i<=(b);++i)\n#define Rep(i,a,b) for(register int i=(a);i>=(b);--i)\n//#define double long double\nusing namespace std;\ninline int read()\n{\n    char c=getchar();int x=0;bool f=0;\n    for(;!isdigit(c);c=getchar())f^=!(c^45);\n    for(;isdigit(c);c=getchar())x=(x<<1)+(x<<3)+(c^48);\n    if(f)x=-x;return x;\n}\n#define maxn 200005\nconst double pi=3.14159265358979323846,eps=1e-8;\nint n,m,l[maxn],r[maxn];\ndouble a[maxn],b[maxn],t[maxn],tl[maxn],tr[maxn];\nbool vis[maxn];\nint c[maxn],p[maxn],k;\nbool cmp(int x,int y){return l[x]<l[y];}\ninline void add(int x,int y){\n\tfor(;x<=m;x+=x&-x)c[x]+=y;\n}\ninline int ask(int x){\n\tint res=0;\n\tfor(;x;x^=x&-x)res+=c[x];\n\treturn res;\n}\ninline int ask(int l,int r){return ask(r)-ask(l-1);}\n\nlong long check(double rd)\n{\n\tlong long res=0,in=0; m=0;k=0;\n\tFor(i,1,n)vis[i]=0; \n\tFor(i,1,n){\n\t\tdouble x=a[i],y=b[i],dis=sqrt(x*x+y*y);\n\t\tif(dis<rd+eps){in++;vis[i]=1;continue;}\n\t\tdouble ang=atan2(y,x),dt=acos(rd/dis);\n\t\ttl[i]=ang-dt,tr[i]=ang+dt;\n\t\tif(tl[i]<-pi)tl[i]+=pi*2;\n\t\tif(tr[i]>pi)tr[i]-=pi*2;\n\t\tif(tl[i]>tr[i])swap(tl[i],tr[i]);\n\t\tt[++m]=tl[i],t[++m]=tr[i];\n\t//\tprintf(\"%d %.4Lf %.4Lf\\n\",i,tl[i],tr[i]); \n\t}\n\tsort(t+1,t+m+1);\n\tFor(i,1,n){\n\t\tif(vis[i])continue;\n\t\tp[++k]=i;\n\t\tl[i]=lower_bound(t+1,t+m+1,tl[i])-t;\n\t\tr[i]=lower_bound(t+1,t+m+1,tr[i])-t;\n\t}\n\tmemset(c,0,sizeof c);\n\tsort(p+1,p+k+1,cmp);\n    res=1ll*n*(n-1)/2;\n\tFor(i,1,k){\n\t\tint u=p[i];\n\t\tres-=ask(l[u],r[u]);\n\t\tadd(r[u],1);\n\t}\n\t//printf(\"chk %.8Lf %lld\\n\",rd,res);\n\treturn res;\n}\n\nint main()\n{\n//\tfreopen(\"my.out\",\"w\",stdout);\n\tn=read();long long kk;cin>>kk;\n\tFor(i,1,n)cin>>a[i]>>b[i];\n\tdouble l=0,r=20000;\n\twhile(r-l>eps){\n\t\tdouble mid=(l+r)/2;\n\t\tif(check(mid)>=kk)r=mid;\n\t\telse l=mid;\n\t}\n\tprintf(\"%.8lf\\n\",l);\n    return 0;\n}\n```",
        "postTime": 1610176956,
        "uid": 151935,
        "name": "Rainbow_qwq",
        "ccfLevel": 0,
        "title": "CF1446F \u3010Line Distance\u3011"
    }
]
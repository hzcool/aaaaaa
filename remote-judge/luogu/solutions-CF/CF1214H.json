[
    {
        "content": "### P.S.\n\u6ca1 G \u9898\u96be ![](//xn--9zr.tk/ll)\n\n### Description.\n\u7565\n\n### Solution.\n\u9996\u5148\u627e\u5230\u76f4\u5f84\u3002  \n\u5982\u679c\u76f4\u5f84 $<K$ \u76f4\u63a5\u968f\u4fbf\u586b\u5c31\u53ef\u4ee5\u4e86\u3002  \n\u5982\u679c\u76f4\u5f84 $\\ge K$\uff0c\u90a3\u76f4\u5f84\u4e0a\u6240\u6709\u6570\u5df2\u7ecf\u786e\u5b9a\u4e86\uff0c\u672c\u8d28\u662f\u5faa\u73af\u540c\u6784\u7684\u3002  \n\u5982\u679c\u5de6\u8fb9\u652f\u94fe\u548c\u5de6\u8fb9\u4e3b\u94fe\u80fd\u5f62\u6210 $\\ge K$ \u7684\u94fe\uff0c\u76f4\u63a5\u65e0\u89e3\uff0c\u53f3\u8fb9\u540c\u7406\u3002  \n**\u8bc1\u660e**\uff1a\uff08\u663e\u7136\uff09\u8fd9\u6761\u652f\u94fe\u8981\u540c\u65f6\u6ee1\u8db3\u53f3\u8fb9\u4e3b\u94fe\u548c\u5de6\u8fb9\u4e3b\u94fe\uff0c\u663e\u7136\u4e0d\u80fd\u540c\u65f6\u6ee1\u8db3\u3002  \n\u5426\u5219\uff0c\u8ba9\u76f4\u5f84\u5de6\u8fb9\u7684\u652f\u94fe\u548c\u540c\u6df1\u5ea6\u4e3b\u94fe\u76f8\u540c\uff0c\u53f3\u8fb9\u540c\u7406\u3002  \n\u8fd9\u6837\u53ef\u4ee5\u8ba9\u5de6\u8fb9\u652f\u94fe\u548c\u53f3\u8fb9\u4e3b\u94fe\u3001\u652f\u94fe\u5b8c\u7f8e\u5339\u914d\u3002  \n\n\u5927\u4f53\u4e0a\u662f\u8fd9\u6837\u3002  \n\u4f46\u662f\uff01  \n\nCorner Case 1\uff1a$K=2$ \u5fc5\u7136\u6709\u89e3\uff0c\u4e0a\u6587\u4e0d\u4e00\u5b9a\uff0c\u9700\u8981\u7279\u5224\u3002  \nCorner Case 2\uff1a\u4e0d\u5b58\u5728\u652f\u94fe\uff0c\u7279\u5224\u4e00\u4e0b\u5373\u53ef\u3002  \n\n### Coding.\n```cpp\n//\u662f\u554a\uff0c\u4f60\u5c31\u662f\u90a3\u53ea\u9b3c\u4e86\uff0c\u6240\u4ee5\u88ab\u4f60\u78b0\u5230\u4ee5\u540e\uff0c\u5c31\u8f6e\u5230\u6211\u53d8\u6210\u9b3c\u4e86{{{\n#include<bits/stdc++.h>\nusing namespace std;typedef long long ll;\ntemplate<typename T>inline void read(T &x)\n{\n\tx=0;char c=getchar(),f=0;\n\tfor(;c<48||c>57;c=getchar()) if(!(c^45)) f=1;\n\tfor(;c>=48&&c<=57;c=getchar()) x=(x<<1)+(x<<3)+(c^48);\n\tf?x=-x:x;\n}\ntemplate<typename T,typename...L>inline void read(T &x,L&...l) {read(x),read(l...);}//}}}\nconst int N=200005;int dep[N],mxd,dw,rt,f[N];char ban[N];\nstruct edge{int to,nxt;}e[N<<1];int et,head[N],n,K,rs[N],dg[N];\ninline void adde(int x,int y) {e[++et]=(edge){y,head[x]},head[x]=et,dg[x]++;}\ninline void dfs0(int x,int fa)\n{\n\tdep[x]=dep[fa]+1,f[x]=fa;if(mxd<dep[x]) mxd=dep[x],dw=x;\n\tfor(int i=head[x];i;i=e[i].nxt) if(e[i].to!=fa) dfs0(e[i].to,x);\n}\nstruct $\n{\n\tint fs,sc,mx;\n\tinline $ operator+(int b) {return($){fs+b,sc+b,mx};}\n\tinline $ operator+($ b)\n\t{\n\t\tint a[4]={fs,sc,b.fs,b.sc};sort(a,a+4);\n\t\treturn ($){a[0],a[1],max(mx,b.mx)};\n\t}\n}d[N];\ninline void clor(int x,int fa,int dx)\n{\n\tfor(int i=head[x];i;i=e[i].nxt) if(e[i].to!=fa)\n\t\trs[e[i].to]=(rs[x]+dx-1)%K+1,clor(e[i].to,x,dx);\n}\ninline int fndmx(int x,int fa,int dep)\n{\n\tint rs=0;for(int i=head[x];i;i=e[i].nxt)\n\t\tif(e[i].to!=fa&&!ban[e[i].to]) rs=max(rs,fndmx(e[i].to,x,dep+1));\n\treturn max(rs,dep);\n}\ninline char get(int x,int fa)\n{\n\tint sn=0,fg=0;for(int i=head[x];i;i=e[i].nxt)\n\t\tif(e[i].to!=fa) sn++,fg|=get(e[i].to,x);\n\treturn sn>=2||fg;\n}\nint main()\n{\n\tread(n,K);for(int i=1,x,y;i<n;i++) read(x,y),adde(x,y),adde(y,x);\n\tif(K==2)\n\t{\n\t\trs[1]=1,clor(1,0,1),puts(\"Yes\");\n\t\tfor(int i=1;i<=n;i++) printf(\"%d%c\",rs[i],i==n?'\\n':' ');\n\t\treturn 0;\n\t}\n\tmxd=dw=0,dfs0(1,0),rt=dw,mxd=dw=0,dfs0(rt,0);\n\tint dx=dw,md=(dep[dw]-1)>>1;for(int i=md;i;i--,dx=f[dx]);\n\tif(!(dep[dw]&1))\n\t{\n\t\tint d1,d2,f1=get(dx,f[dx]),f2=get(f[dx],dx);\n\t\tban[f[dx]]=1,d1=fndmx(dw,0,1),ban[f[dx]]=0;\n\t\tban[dx]=1,d2=fndmx(rt,0,1),ban[dx]=0;\n\t\tif((d1>=K&&f1)||(d2>=K&&f2)) return puts(\"No\"),0;\n\t\trs[dx]=1,rs[f[dx]]=K,clor(dx,f[dx],1),clor(f[dx],dx,K-1),puts(\"Yes\");\n\t\tfor(int i=1;i<=n;i++) printf(\"%d%c\",rs[i],i==n?'\\n':' ');\n\t}\n\telse\n\t{\n\t\tban[f[dx]]=1;int d=fndmx(dw,0,1);if(d>=K&&get(dx,f[dx])) return puts(\"No\"),0;\n\t\trs[dx]=1,rs[f[dx]]=K,clor(dx,f[dx],1),clor(f[dx],dx,K-1),puts(\"Yes\");\n\t\tfor(int i=1;i<=n;i++) printf(\"%d%c\",rs[i],i==n?'\\n':' ');\n\t}return 0;\n}\n```",
        "postTime": 1634020145,
        "uid": 44805,
        "name": "Leap_Frog",
        "ccfLevel": 7,
        "title": "CF1214H Tiles Placement\uff08\u9898\u89e3\uff09"
    },
    {
        "content": "[CF1214H Tiles Placement](https://www.luogu.com.cn/problem/CF1214H)\u89e3\u9898\u62a5\u544a\uff1a\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://zybuluo.com/xiaoziyao/note/1747190)\n\n## \u9898\u610f\n- \u7ed9\u5b9a\u4e00\u68f5$n$\u4e2a\u70b9\u7684\u6811\uff0c\u53ef\u4ee5\u7528$k$\u79cd\u989c\u8272\u67d3\u8272\uff1b\n- \u4f60\u9700\u8981\u5224\u65ad\u662f\u5426\u5b58\u5728\u4e00\u79cd\u67d3\u8272\u65b9\u6848\u6ee1\u8db3\u4efb\u610f\u957f\u5ea6\u4e3a$k$\u7684\u94fe\u5fc5\u987b\u5305\u542b$k$\u79cd\u989c\u8272\uff1b\n- \u82e5\u6709\u65b9\u6848\uff0c\u5219\u8f93\u51fa\"Yes\"\uff0c\u5e76\u4efb\u610f\u8f93\u51fa\u4e00\u79cd\u65b9\u6848\uff1b\u5426\u5219\u8f93\u51fa\"No\"\u3002\n- $1\\leqslant n\\leqslant 2\\cdot 10^5,2\\leqslant k\\leqslant n$\u3002\n\n## \u5206\u6790\n\u6700\u8fd1\u542c\u4e86\u4e00\u4e2a\u795e\u4ed9\u8bb2\u4e86\u8fd9\u9053\u9898\uff0c\u5c31\u6765\u505a\u4e00\u505a\u3002\n\n\u4e00\u9053\u627e\u89c4\u5f8b\u795e\u9898\uff0c~~\u73b0\u573a\u63a8\u51fa\u4e86\u548c\u6b63\u89e3\u7b49\u4ef7\u7684\u89c4\u5f8b\uff0c\u4f46\u662f\u8fd8\u662f\u4e0d\u4f1a~~\u3002\n\n\u5148\u7ed9\u51fa\u7ed3\u8bba\uff1a\n\n- $k=2$\u65f6\uff0c\u4e00\u5b9a\u5b58\u5728\u8fd9\u6837\u7684\u67d3\u8272\u65b9\u6848\uff0c\u53ea\u9700\u8981\u6309\u7167\u6df1\u5ea6\u4ea4\u66ff\u67d3\u8272\u5c31\u53ef\u4ee5\u4e86\uff1b\n- $k>2$\u65f6\uff0c\u82e5\u5b58\u5728$3$\u4e2a\u70b9\u8ddd\u79bb\u5927\u4e8e\u7b49\u4e8e$k$\uff0c\u90a3\u4e48\u4e0d\u5b58\u5728\u67d3\u8272\u65b9\u6848\u3002\n\n$k=2$\u65f6\uff0c\u7ed3\u8bba\u663e\u7136\u6210\u7acb\u3002\n\n$k>2$\u65f6\uff0c\u6211\u4eec\u770b\u4e00\u770b\u56fe\uff1a\n\n![](https://fp1.fghrsh.net/2020/10/08/7700b412c89bab2b2cd0c832b3d4922c.png)\n\n\u8bbe$a$\u5230$x$\u8ddd\u79bb\u4e3a$len_a$\uff0c$b$\u5230$x$\u8ddd\u79bb\u4e3a$len_b$\uff0c$c$\u5230$x$\u8ddd\u79bb\u4e3a$len_c$\u3002\n\n\u5982\u679c$len_a+len_b\\geqslant k$\uff0c$len_a+len_c\\geqslant k$\uff0c$len_b+len_c\\geqslant k$\uff0c\u90a3\u4e48\u6211\u4eec\u4efb\u53d6$a$\u5230$x$\u94fe\u4e0a\u4e00\u70b9$p$\uff0c$b$\u5230$x$\u94fe\u4e0a\u4e00\u70b9$q$\uff0c$c$\u5230$x$\u94fe\u4e0a\u4e00\u70b9$r$\uff0c\u4f7f$p$\u5230$q$\u7684\u8ddd\u79bb\u4e3a$k$\uff0c$q$\u5230$r$\u7684\u8ddd\u79bb\u4e3a$k$\u3002\n\n\u6211\u4eec\u4ee4$p$\u5230$q$\u94fe\u4e0a\u5df2\u7ecf\u786e\u5b9a\u4e86\u67d3\u8272\u65b9\u6848\uff0c\u90a3\u4e48$p$\u5230$x$\u7684\u67d3\u8272\u65b9\u6848\u9012\u63a8\u5230$r$\u7684\u65b9\u6848\uff0c\u4e00\u5b9a\u4e0e$q$\u5230$x$\u7684\u67d3\u8272\u65b9\u6848\u9012\u63a8\u5230$r$\u7684\u65b9\u6848\u4e0d\u540c\uff0c\u4e8e\u662f\u6211\u4eec\u63a8\u51fa\u4e86\u77db\u76fe\u3002\n\n\u56e0\u6b64\u7ed3\u8bba\u6210\u7acb\u3002\n\n\u6211\u4eec\u8003\u8651\u53d6\u51fa\u76f4\u5f84\uff08\u8fd9\u91cc\u53d6\u51fa\u76f4\u5f84\u4e3b\u8981\u662f\u4e3a\u4e86\u89e3\u51b3\u7b2c\u4e8c\u95ee\uff09\uff0c\u6c42\u51fa\u6bcf\u4e2a\u70b9\u4e0d\u5411\u76f4\u5f84\u6269\u5c55\u7684\u6700\u957f\u94fe\u548c\u6b21\u957f\u94fe\uff0c\u5e76\u5bf9\u4e8e\u76f4\u5f84\u4e0a\u7684\u70b9\u548c\u76f4\u5f84\u5916\u7684\u70b9\u5206\u7c7b\u8ba8\u8bba\uff1a\n\uff08\u4e0b\u9762\u7684\u6700\u957f\u94fe\u4e0e\u6b21\u957f\u94fe\u5747\u6307\u4e0d\u5411\u76f4\u5f84\u6269\u5c55\u7684\u94fe\uff09\n\n- \u5bf9\u4e8e\u6240\u6709\u7684$x$\uff0c\u5982\u679c\u6700\u957f\u94fe\u4e0e\u6b21\u957f\u94fe\u5408\u5e76\u540e\u957f\u5ea6\u5927\u4e8e\u7b49\u4e8e$k$\uff0c\u90a3\u4e48\u4e0d\u80fd\u6784\u9020\u65b9\u6848\u3002\uff08\u8bbe\u6700\u957f\u94fe\u7684\u94fe\u5e95\u4e3a$p_1$\uff0c\u6b21\u957f\u94fe\u7684\u94fe\u5e95\u4e3a$p_2$\uff0c\u5219\u76f4\u5f84\u4e24\u4e2a\u7aef\u70b9\u4e2d\u7684\u4e00\u4e2a\u4e00\u5b9a\u53ef\u4ee5\u4e0e$p_1$\u548c$p_2$\u6784\u6210\u4e24\u4e24\u8ddd\u79bb\u5927\u4e8e\u7b49\u4e8e$k$\u7684\u4e09\u4e2a\u70b9\uff09\n- \u82e5$x$\u5728\u76f4\u5f84\u4e0a\uff0c\u5982\u679c\u6700\u957f\u94fe\u4e0e$x$\u5206\u9694\u5f00\u7684\u76f4\u5f84\u4e24\u6bb5\u5408\u5e76\u540e\u957f\u5ea6\u5747\u5927\u4e8e\u7b49\u4e8e$k$\uff0c\u90a3\u4e48\u4e0d\u80fd\u6784\u9020\u65b9\u6848\u3002\uff08\u6700\u957f\u94fe\u94fe\u5e95\u548c\u76f4\u5f84\u7684\u4e24\u7aef\u53ef\u4ee5\u6784\u6210\u4e24\u4e24\u8ddd\u79bb\u5927\u4e8e\u7b49\u4e8e$k$\u7684\u4e09\u4e2a\u70b9\uff09\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u5224\u65ad\u51fa\u4e86\u662f\u5426\u53ef\u4ee5\u8fdb\u884c\u6784\u9020\u3002\n\n\u6784\u9020\u65b9\u6cd5\u6bd4\u8f83\u663e\u7136\uff1a\n\n\u9996\u5148\uff0c\u56e0\u4e3a\u5728\u6ee1\u8db3\u4e0a\u8ff0\u8981\u6c42\u4e0b\uff0c\u957f\u5ea6\u5927\u4e8e\u7b49\u4e8e$k$\u7684\u94fe\u4e00\u5b9a\u90fd\u5728\u76f4\u5f84\u4e0a\uff0c\u6240\u4ee5\u6211\u4eec\u5148\u5bf9\u76f4\u5f84\u8fdb\u884c\u67d3\u8272\u3002\n\n\u6211\u4eec\u8003\u8651\u5269\u4e0b\u7684\u70b9\u5982\u4f55\u67d3\u8272\u2014\u2014\u5269\u4e0b\u7684\u70b9\u4e00\u5b9a\u53ef\u4ee5\u4ece\u76f4\u5f84\u4e0a\u7684\u989c\u8272\u5730\u63a8\u4e0b\u6765\u3002\n\n\u4f46\u662f\u6709\u4e00\u70b9\u7ec6\u8282\u8981\u6ce8\u610f\uff1a\n\n![](https://fp1.fghrsh.net/2020/10/08/67063642e456f8bbb146ec1e147d77a4.png)\n\n\u5982\u56fe\uff0c$k=4$\uff0c\u6b64\u65f6\u5047\u8bbe\u6211\u4eec\u9009\u62e9\u7684\u76f4\u5f84\u4e3a$(1,6)$\uff0c\u90a3\u4e48$(1,7),(3,6),(3,7)$\u8fd9\u4e9b\u8def\u5f84\u7684\u67d3\u8272\u642d\u914d\u4e5f\u8981\u8003\u8651\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u53d6\u76f4\u5f84\u4e2d\u70b9$mid$\uff0c\u76f4\u5f84\u4e0a$mid$\u5de6\u8fb9\u7684\u70b9\u53ef\u4ee5\u91c7\u7528\u989c\u8272\u4e0d\u65ad\u52a0$1$\u7684\u67d3\u8272\u7b56\u7565\uff0c$mid$\u53ca\u53f3\u8fb9\u7684\u70b9\u53ef\u4ee5\u91c7\u7528\u989c\u8272\u4e0d\u65ad\u51cf$1$\u7684\u67d3\u8272\u7b56\u7565\uff0c\u8fd9\u6837$mid$\u5de6\u53f3\u4e24\u70b9\u4ea7\u751f\u7684\u8def\u5f84\u6211\u4eec\u90fd\u53ef\u4ee5\u6ee1\u8db3\u6761\u4ef6\u4e86\u3002\n\n\u590d\u6742\u5ea6\uff1a$O(n)$\u3002\n\n## \u4ee3\u7801\n\u4ee3\u7801\u627e\u4e86\u597d\u4e45\u9519\uff0c\u7ed3\u679c\u662f$\\text{getlen}$\u7684\u9012\u5f52\u8c03\u7528\u4e86$\\text{dfs}$\uff08\u6342\u8138\uff09\u3002\n\n\u6ce8\u610f\u7279\u5224$\\text{m=2}$\n```\n#include<stdio.h>\n#define inf 1000000000\nconst int maxn=200005,maxm=maxn<<1;\nint n,m,e,s1,s2,s,maxx,col,flg,mid;\nint start[maxn],to[maxm],then[maxm];//\u94fe\u5f0f\u524d\u5411\u661f\nint dep[maxn],f[maxn],ans[maxn],flen[maxn],slen[maxn];//\u6df1\u5ea6\uff0c\u9012\u5f52\u65f6\u7684\u7236\u4eb2\uff0c\u67d3\u7684\u989c\u8272\uff0c\u6700\u957f\u94fe\uff0c\u6b21\u957f\u94fe\ninline void add(int x,int y){//\u52a0\u8fb9\n\tthen[++e]=start[x],start[x]=e,to[e]=y;\n}\nvoid dfs(int x,int last){\n\tf[x]=last,dep[x]=dep[last]+1;\n\tflen[x]=slen[x]=0;\n\tif(dep[x]>maxx)\n\t\tmaxx=dep[x],s=x;\n\tfor(int i=start[x];i;i=then[i]){\n\t\tint y=to[i];\n\t\tif(y==last)\n\t\t\tcontinue;\n\t\tdfs(y,x);\n\t}\n}\nvoid getlen(int x,int last){\n\tfor(int i=start[x];i;i=then[i]){\n\t\tint y=to[i];\n\t\tif(y==last||ans[y])\n\t\t\tcontinue;\n\t\tgetlen(y,x);\n\t\tif(flen[y]+1>flen[x])\n\t\t\tslen[x]=flen[x],flen[x]=flen[y]+1;\n\t\telse if(flen[y]+1>slen[x])\n\t\t\tslen[x]=flen[y]+1;\n\t\tif(slen[y]+1>slen[x])\n\t\t\tslen[x]=slen[y]+1;\n\t}\n}\nvoid solve(int x,int c,int t){//\u67d3\u8272\uff0c\u5176\u4e2dt=1\u65f6\u989c\u8272\u4e3a\u7236\u4eb2\u7684\u989c\u8272+1\uff0ct=-1\u65f6\u76f8\u53cd\n\tans[x]=c;\n\tc=(c+t+m-1)%m+1;\n\tfor(int i=start[x];i;i=then[i]){\n\t\tint y=to[i];\n\t\tif(ans[y]!=0)\n\t\t\tcontinue;\n\t\tsolve(y,c,t);\n\t}\n}\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<n;i++){\n\t\tint x,y;\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tadd(x,y),add(y,x);\n\t}\n\tmaxx=-inf,dfs(1,0),s1=s;//s1\u4e3a\u76f4\u5f84\u4e00\u4e2a\u7aef\u70b9\n\tmaxx=-inf,dfs(s,0),s2=s;//s2\u4e3a\u76f4\u5f84\u53e6\u4e00\u7aef\u70b9\n\tif(m==2){//\u7279\u5224m=2\n\t\tputs(\"Yes\");\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tprintf(\"%d%c\",dep[i]%2+1,i==n? '\\n':' ');\n\t\treturn 0;\n\t}\n\tfor(int i=s2;i!=0;i=f[i]){//\u5bf9\u76f4\u5f84\u67d3\u8272\n\t\tcol=col%m+1;\n\t\tif((dep[s1]+dep[s2])/2==dep[i])//\u627e\u5230\u4e2d\u70b9\n\t\t\tmid=i;\n\t\tans[i]=col;\n\t}\n\tfor(int i=s2;i!=0;i=f[i]){//\u76f4\u5f84\u4e0a\u7684\u70b9\u5411\u5b83\u4e0d\u5411\u76f4\u5f84\u6269\u5c55\u7684\u5b50\u6811\u4e2d\u6c42\u6700\u957f/\u6b21\u957f\u94fe\n\t\tgetlen(i,0);\n\t\tif(ans[i]&&flen[i]&&dep[i]+flen[i]>=m&&(dep[s2]-dep[i]+1)+flen[i]>=m){\n\t\t\tputs(\"No\");\n\t\t\treturn 0;\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tif(flen[i]+slen[i]+1>=m){\n\t\t\tputs(\"No\");\n\t\t\treturn 0;\n\t\t}\n\tfor(int i=s2;i!=mid;i=f[i])//\u76f4\u5f84\u524d\u534a\u6bb5\u67d3\u8272\n\t\tsolve(i,ans[i],-1);\n\tfor(int i=mid;i!=0;i=f[i])//\u76f4\u5f84\u540e\u534a\u6bb5\u67d3\u8272\n\t\tsolve(i,ans[i],1);\n\tputs(\"Yes\");\n\tfor(int i=1;i<=n;i++)\n\t\tprintf(\"%d%c\",ans[i],i==n? '\\n':' ');\n\treturn 0;\n}\n```",
        "postTime": 1602164594,
        "uid": 35754,
        "name": "Verdandi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1214H \u3010Tiles Placement\u3011"
    }
]
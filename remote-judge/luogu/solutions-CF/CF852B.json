[
    {
        "content": "### \u9898\u610f\n\u6709\u4e00\u5e45\u6709\u5411\u56fe\uff0c\u9664\u4e86\u6e90\u70b9\u548c\u6c47\u70b9\u6709 $L$ \u5c42\uff0c\u6bcf\u5c42 $N$ \u4e2a\u70b9\u3002 \u7b2c $i$ \u5c42\u7684\u6bcf\u4e2a\u70b9\u5230\u7b2c $i+1$ \u5c42\u7684\u6bcf\u4e2a\u70b9\u90fd\u6709\u4e00\u6761\u8fb9\uff0c\u7ed9\u51fa\u6e90\u70b9\u5230\u7b2c\u4e00\u5c42\u7684\u8fb9\u6743\uff0c\u5c42\u4e0e\u5c42\u4e4b\u95f4\u7684\u8fb9\u6743\uff0c\u6700\u540e\u4e00\u5c42\u5230\u6c47\u70b9\u7684\u8fb9\u6743\uff0c\u6c42\u6e90\u70b9\u5230\u6c47\u70b9\u7684\u8def\u5f84\u957f\u5ea6\u80fd\u88ab $M$ \u6574\u9664\u7684\u65b9\u6848\u6570\u3002\n\n$1\\le N\\le 10^6,2\\le L \\le 10^5,2\\le M \\le 100$\n\n### \u9898\u89e3\n\u89c2\u5bdf\u4e00\u4e0b\u6570\u636e\u8303\u56f4\uff0c\u53d1\u73b0 $M$ \u76f8\u5bf9\u4e8e $N$ \u548c $L$ \u5f88\u5c0f\uff0c\u5e76\u4e14\u5c42\u4e0e\u5c42\u4e4b\u95f4\u7684\u8fb9\u6743\u76f8\u540c\uff0c\u8054\u60f3\u5230\u77e9\u9635\u5feb\u901f\u5e42\u3002\n\n\u4f46\u662f\u7528\u77e9\u9635\u4f3c\u4e4e\u5e76\u4e0d\u597d\u8868\u793a\u8def\u5f84\u65b9\u6848\u6570\u7684\u8f6c\u79fb\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u81ea\u5df1\u53e3\u80e1\u4e00\u4e2a\u4e1c\u897f\u6765\u66ff\u4ee3\u77e9\u9635\u8fdb\u884c\u5feb\u901f\u8fd0\u7b97\u3002\n\n\u60f3\u4e00\u4e0b\u8fd9\u9053\u9898\u600e\u4e48\u66b4\u529b\u8f6c\u79fb\u72b6\u6001\uff1a\n- $dp_{i,j}$ \u8868\u793a\u5230\u8fbe\u7b2c $i$ \u5c42\uff0c\u8def\u5f84\u957f\u5ea6\u4e3a $j$ \u7684\u65b9\u6848\u6570\u3002\n- $w_{k}$ \u8868\u793a\u4e24\u5c42\u95f4\u8fb9\u6743\u4e3a $k$ \u7684\u8fb9\u6570\u91cf\n- $dp_{i,j}=\\sum{dp_{i-1,j-w_{k}}}$\n\n\u66b4\u529b\u7684\u4ee3\u7801\u662f\u8fd9\u6837\u7684\uff1a\n```cpp\n//\u4ee3\u7801\u91cc\u8981\u52a0\u819c\u6cd5\uff0c\u4e3a\u4e86\u65b9\u4fbf\u9605\u8bfb\u6ca1\u52a0\ndp[0][0]=1;\nfor(int i=1;i<=n;i++)\n\tfor(int j=0;j<m;j++)\n\t\tfor(int k=0;k<m;k++)\n\t\t\tdp[i][j+k]+=dp[i-1][j]*w[k];\n```\n\n\u73b0\u5728\u597d\u50cf\u8fd8\u770b\u4e0d\u51fa\u4ec0\u4e48\u4e1c\u897f\uff0c\u4e0d\u5982\u538b\u4e2a\u7ef4\uff1f\n```cpp\ndp[0][0]=1;\nfor(int i=1;i<=n;i++)\n\tfor(int j=0;j<m;j++)\n\t\tfor(int k=0;k<m;k++)\n\t\t\tdp[i&1][j+k]+=dp[(i-1)&1][j]*w[k];\n```\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a\u4e00\u7ef4\u6570\u7ec4\u8868\u793a\u5230\u8fbe\u4e00\u5c42\u7684\u8def\u5f84\u957f\u5ea6\u65b9\u6848\u6570\uff01\u6570\u7ec4 $w$ \u4e5f\u53ef\u4ee5\u8fd9\u6837\u5904\u7406\uff01\n\n\u6211\u4eec\u53ef\u4ee5\u628a $dp_i$ \u770b\u4f5c $dp_{i-1}\\times w$ \u7684\u7ed3\u679c\uff01\u90a3 $dp_i \\times dp_i$ \u5f97\u5230\u7684\u4e1c\u897f\u662f\u4ec0\u4e48\uff1f$dp_{2i}$ \uff01\n\n~~\u6211\u4e5f\u4e0d\u77e5\u9053\u8fd9\u4e2a\u8fd0\u7b97\u7b97\u4e0d\u7b97\u4e58\u6cd5\uff0c\u4f46\u662f\u540c\u6837\u5177\u6709\u4ea4\u6362\u5f8b\u7ed3\u5408\u5f8b\u4e4b\u7c7b\u7684\u6027\u8d28\uff0c\u8fd9\u5c31\u591f\u4e86~~\n\n\u60f3\u5230\u4e86\u4ec0\u4e48\uff1f\u5feb\u901f\u5e42\uff01\u5c31\u7b97\u8fd9\u4e2a\u8fd0\u7b97\u770b\u8d77\u6765\u5f88\u602a\uff0c\u4f46\u8fd8\u662f\u53ef\u4ee5\u5feb\u901f\u5e42\uff01\n\n\u8bb0\u5f97\u628a\u6c47\u70b9\u548c\u6700\u540e\u4e00\u5c42\u5408\u5e76\u8d77\u6765\uff0c\u907f\u514d\u51fa\u73b0\u5404\u79cd\u5947\u5947\u602a\u602a\u7684\u95ee\u9898\u3002\n\n### \u4ee3\u7801\n```cpp\n#include<cstdio>\n#include<cstring>\n#define int long long\n#define mod 1000000007\nusing namespace std;\nint n,l,m,dp[2][105],t[1000005],ans;\nstruct vec\n{\n\tint x[105]={0};\n\tvec operator *(vec a)\n\t{\n\t\tvec ans;\n\t\tfor(int i=0;i<m;i++)\n\t\t\tfor(int j=0;j<m;j++)\n\t\t\t\tans.x[(i+j)%m]+=x[i]*a.x[j],ans.x[(i+j)%m]%=mod;\n\t\treturn ans;\n\t}\n}a,b,c;\nvec qpow(vec base,int k)\n{\n\tvec ans;ans.x[0]=1;\n\twhile(k)\n\t{\n\t\tif(k&1)\n\t\t\tans=ans*base;\n\t\tk>>=1;\n\t\tbase=base*base;\n\t}\n\treturn ans;\n}\nsigned main()\n{\n\tscanf(\"%lld %lld %lld\",&n,&l,&m);\n\tfor(int i=1,x;i<=n;i++)scanf(\"%lld\",&x),a.x[x%m]++;\n\tfor(int i=1,x;i<=n;i++)scanf(\"%lld\",&x),b.x[x%m]++,t[i]=x;\n\tfor(int i=1,x;i<=n;i++)scanf(\"%lld\",&x),x+=t[i],c.x[x%m]++;\n\tb=a*qpow(b,l-2)*c;\n\t//for(int i=0;i<m;i++)printf(\"%lld \",b.x[i]);\n\tprintf(\"%lld\",b.x[0]);\n}\n```",
        "postTime": 1624800556,
        "uid": 87434,
        "name": "_Life_",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF852B \u3010Neural Network country\u3011"
    },
    {
        "content": "\u539f\u5148\u90a3\u7bc7\u9898\u89e3\u611f\u89c9\u6709\u70b9\u602a\u602a\u7684 ..... \n\n\u8fd0\u7528\u77e9\u4e58\u5feb\u901f\u5e42\u7684\u601d\u60f3\u4f46\u4e0d\u662f\u77e9\u4e58 \n\n\u6807\u51c6\u7684\u77e9\u4e58 \n\n\u89c2\u5bdf\u6570\u636e\u8303\u56f4 M \u5f88\u5c0f L \u5f88\u5927 \u5e94\u8be5\u662f\u77e9\u4e58\u65e0\u7591 \n\n\u4f46\u662f\u6211\u4eec\u8fdb\u4e00\u6b65\u8bfb\u9898\u540e\u53d1\u73b0 \n\n\u5728\u6700\u540e\u4e00\u5c42\u65f6 \u8f6c\u79fb\u53ef\u80fd\u4e0e\u5f53\u524d\u6240\u5728\u8282\u70b9\u4f4d\u7f6e\u6709\u5173\n\n\u90a3\u6211\u4eec\u7684\u77e9\u4e58\u91cc\u4f1a\u5957\u4e00\u4e2a N ~~\u5149\u8363\u7684\u8d1f\u4f18\u5316~~ \n\n\u4f46\u662f\u771f\u7684\u9700\u8981\u5417 \u5176\u5b9e\u5728\u5206\u5c42\u56fe\u4e2d \u4e0b\u4e00\u6b65\u8f6c\u79fb\u4e0e\u5f53\u524d\u4f4d\u7f6e\u65e0\u5173\n\n\u90a3\u6211\u4eec\u624b\u52a8\u505a\u6700\u540e\u4e00\u5c42\u5c31\u597d\u4e86 \n\n\u4ee3\u7801 : \n\n$S.a_{i}$ \u8868\u793a\u5230\u67d0\u4e00\u5c42\u957f\u5ea6 %M \u540e\u4e3ai \u7684\u8def\u5f84\u6570\u91cf \n\n$g$\u662f\u8f6c\u79fb\u77e9\u9635 \u6ce8\u610f$cost$\u53ef\u80fd\u4e3a M \u6700\u597d\u90fd % \u4e00\u4e0b \n\n```cpp\n#include<bits/stdc++.h> \n#define rg register \n#define i60 long long  \n#define int long long \n#define fp( i , x , y ) for( rg int i=(x); i<=(y); ++i ) \n#define fq( i , x , y ) for( rg int i=(y); i>=(x); --i )  \nusing namespace std ; \nconst int N = 105 ; \nconst i60 hgs = 1e9+7 ; \nint n , l , m , A[N*10000] ;   \nstruct Matrix { \n  int a[N][N] ; \n  void clean( ) { memset( a , 0 , sizeof(a) ) ; } \n  friend Matrix operator *  ( Matrix A , Matrix B ) { \n     Matrix C ; C.clean( ) ;  \n     fp( i , 0 , m-1 ) fp( j , 0 , m-1 ) fp( k , 0 , m-1 ) \n       C.a[i][j] += ( A.a[i][k] * (i60)B.a[k][j] % hgs ) , C.a[i][j] %= hgs ; \n     return C ; \n  } // f[j] += f[i] * g[i][j] \n  Matrix qpow( Matrix A , int B ) { \n    Matrix C ; C.clean( ) ; \n    fp( i , 0 , m-1 ) C.a[i][i] = 1 ; \n    for( ; B ; B >>= 1 ) { \n       if( B & 1 ) C = C * A ;  \n       A = A * A  ; \n\t} return C ; \n  }  \n} S , g ;  \nsigned main( ) {  \n  int x ; \n  scanf( \"%lld %lld %lld\" , &n , &l , &m ) ; \n  fp( i , 1 , n )  \n    scanf( \"%lld\" , &x ) , S.a[0][x%m] ++ ; \n  fp( i , 1 , n ) { \n    scanf( \"%lld\" , &A[i] ) ; A[i] %= m ; \n    fp( j , 0 , m-1 ) \n       g.a[j][(j+A[i])%m] ++ ; \n  } \n  S = S * g.qpow ( g , l-2 ) ; \n  int ans = 0 ; \n  fp( i , 1 , n ) { \n     scanf( \"%lld\" , &x ) ; x %= m ;  \n\t ans = ( ans + S.a[0][(2*m-x-A[i])%m] ) % hgs ; \n  } \n  printf( \"%lld\\n\" , ans ) ; \n  return 0 ; \n} \n```\n\n\n",
        "postTime": 1597799126,
        "uid": 100114,
        "name": "hater",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF852B \u3010Neural Network country\u3011"
    },
    {
        "content": "## Solution of CF852B\n\n\u53ef\u4ee5\u5bf9\u5206\u5c42\u56fe\u505a\u66b4\u529b dp\uff1a\n\n> $dp_{i,j}$ \u8868\u793a\u5230\u7b2c $i$ \u4e2a\u8282\u70b9\u8def\u5f84\u957f $\\bmod m$ \u610f\u4e49\u4e0b\u7b49\u4e8e $j$ \u7684\u65b9\u6848\u79cd\u6570 \n\n\u663e\u7136\u8fd9\u4e2a\u8f6c\u79fb\u662f $O(Ln^2m)$ \u7684\u3002\u8003\u8651\u5c42\u4e0e\u5c42\u4e4b\u95f4\u5230\u540c\u4e00\u8282\u70b9\u7684\u8fb9\u6743\u76f8\u540c\uff0c\u90a3\u4e48\u524d\u4e00\u5c42\u6bcf\u4e2a\u8282\u70b9\u7684\u8f6c\u79fb\u90fd\u76f8\u540c\u7684\uff0c\u8003\u8651\u5bf9\u5c42\u4e0e\u5c42\u4e4b\u95f4 $dp$\uff1a\n\n> $tp_{i,j}$ \u8868\u793a\u5230\u7b2c $i$ \u4e2a\u5c42\u8def\u5f84\u957f $\\bmod m$ \u610f\u4e49\u4e0b\u7b49\u4e8e $j$ \u7684\u65b9\u6848\u79cd\u6570 \n\n\u8fd9\u4e2a\u8f6c\u79fb\u662f $O(Lnm)$ \u7684\uff0c\u663e\u7136\u8fd8\u662f\u8fc7\u6162\uff0c\u800c\u6211\u4eec\u89c2\u5bdf\u5230\u4e2d\u95f4\u5c42\u4e4b\u95f4\u7684\u8fb9\u6743\u4e0d\u53d8\uff0c\u90a3\u4e48\u8bf4\u660e\u4e2d\u95f4\u5c42\u4e4b\u95f4\u7684\u8f6c\u79fb\u4e5f\u662f\u76f8\u540c\u7684\u3002\n\n\u5982\u679c\u6211\u4eec\u628a\u8fd9\u4e2a $tp$ \u770b\u6210\u4e00\u4e2a\u751f\u6210\u51fd\u6570\uff0c\u663e\u7136\u5b83\u5728 $\\bmod x^n$ \u4e0b\u6ee1\u8db3\u6307\u6570\u76f8\u52a0\uff0c\u7cfb\u6570\u76f8\u4e58\u7684\u591a\u9879\u5f0f\u4e58\u6cd5\u6cd5\u5219\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u6c42\u51fa $tp$\uff0c\u590d\u6742\u5ea6 $O(m\\log L)$\u3002\n\n\u800c\u77e5\u9053\u4e86 $tp_{n-2}$\uff0c\u5c31\u53ef\u4ee5\u63a8\u5f97\u6240\u6709 $dp_{i}(i\\in S_{n-1})$\uff0c\u90a3\u4e48\u8bb0\u5f55\u7b54\u6848\u4e5f\u5c31\u5f88\u7b80\u5355\u4e86\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define Maxn 2000006\n#define Maxm 105\n#define Nep(i, l, r) for(int i = l; i != r; ++ i)\n#define Rep(i, l, r) for(int i = l; i <= r; ++ i)\n#define rep(i, l, r) for(int i = l; i < r; ++ i)\n#define Lep(i, l, r) for(int i = l; i >= r; -- i)\n#define lep(i, l, r) for(int i = l; i > r; -- i)\n#define Max(a, b) a = std :: max(a, b)\n#define ll long long\n#define ull unsigned long long\n#define int long long\n\nconst int mod = 1e9 + 7;\n\nint read() {\n\tint x = 1, res = 0, ch = getchar();\n\twhile(ch < '0' || ch > '9') { if(ch == '-') x = -1; ch = getchar(); }\n\twhile(ch >= '0' && ch <= '9') res = (res << 3) + (res << 1) + (ch ^ 48), ch = getchar();\n\treturn x * res;\n}\n\nint m, L, n, d[Maxn];\nint add(int x, int y) { return (x + y) % mod; }\nint mul(int x, int y) { return (x * y) % mod; }\n\nstruct poly {\n    int x[Maxm];\n\n    friend poly operator * (poly x, poly y) {\n        poly z = {}; \n        rep(i, 0, m) rep(j, 0, m) z.x[(i + j) % m] = add(z.x[(i + j) % m], mul(x.x[i], y.x[j]));\n        return z; \n    }\n};\n\npoly qpow(poly x, int y) {\n    poly ret = {1};\n\n    for (; y; y >>= 1, x = x * x)\n        if (y & 1) ret = ret * x;\n    return ret;\n}\n\nsigned main() {\n    n = read(), L = read(), m = read();\n    poly A = {}, B = {}, ans;\n    Rep(i, 1, n) A.x[read() % m] ++; \n    Rep(i, 1, n) B.x[d[i] = read() % m] ++; \n    ans = L > 1 ? A * qpow(B, L - 2) : A; int res = 0;  \n    Rep(i, 1, n) res = add(res, ans.x[(m + (- read() - d[i]) % m) % m]);\n    return printf(\"%lld\", res), 0;\n}\n```\n",
        "postTime": 1660207385,
        "uid": 486187,
        "name": "2000VOLT",
        "ccfLevel": 0,
        "title": "CF852B \u9898\u89e3"
    },
    {
        "content": "\u9898\u610f\uff1a\u6709\u4e00\u5e45\u6709\u5411\u56fe\uff0c\u9664\u4e86\u6e90\u70b9\u548c\u6c47\u70b9\u6709 $L$ \u5c42\uff0c\u6bcf\u5c42 $n$ \u4e2a\u70b9\u3002\u7b2c $i+1$ \u5c42\u7684\u6bcf\u4e2a\u70b9\u5230\u7b2c $i+2$ \u5c42\u7684\u6bcf\u4e2a\u70b9\u90fd\u6709\u4e00\u6761\u8fb9\uff0c\u8fb9\u7684\u6743\u503c\u4e3a\u6709\u5411\u8fb9\u7ec8\u70b9\u7684\u6743\u503c\u3002\u6c42\u6e90\u70b9\u5230\u6c47\u70b9\u7684\u8def\u5f84\u957f\u5ea6\u80fd\u88ab $m$ \u6574\u9664\u7684\u4e2a\u6570\u3002  \n~~\u6bd4\u8f83\u5bb9\u6613\u770b\u51fa\u6765\u7684~~\u5feb\u901f\u5e42\u3002\u8bbe $a_i$ \u8868\u793a\u4ece\u7b2c $1$ \u5c42\u5230\u7b2c $a$ \u5c42\u603b\u8def\u5f84\u957f\u5ea6\u4e3a $i (i \\mod  m)$ \u7684\u6570\u76ee\uff0c\u540c\u7406\u8bbe $b_j$ \u8868\u793a\u4ece\u7b2c $a+1$ \u5c42\u5230\u7b2c $a+1$ \u5c42\uff08\u4e5f\u5c31\u662f\u81ea\u5df1\u5c42\uff09\u603b\u8def\u5f84\u957f\u5ea6\u4e3a $j (j \\mod  m)$ \u7684\u6570\u76ee\uff0c\u90a3\u4e48\u7b2c $a+2$ \u5c42\u7684 $a_{(i+j) \\ mod m} = a_i \\times b_j$\u3002  \n\u90a3\u4e48\u5982\u679c\u4e00\u4e2a\u4e00\u4e2a\u4e58\u4e0a\u53bb\u7684\u8bdd\u4f1a\u8d85\u65f6\u3002  \n\u6211\u4eec\u4e0d\u96be\u53d1\u73b0\u4ece\u7b2c $2$ \u5c42\u5230\u7b2c $L-1$ \u5c42\uff0c\u6bcf\u6b21\u4e58\u7684\u64cd\u4f5c\u662f\u76f8\u540c\u7684\uff0c\u53ef\u4ee5\u7528\u5feb\u901f\u5e42\u5148\u9884\u5904\u7406\u628a\u7b2c $2$ \u5c42\u5230\u7b2c $L-1$ \u5c42\u4e58\u8d77\u6765\u3002\u8fd9\u6837\u5c31\u4e0d\u4f1a\u8d85\u65f6\u4e86\u3002  \n _Code_ \n ```cpp\n#include<iostream>\n#include<cstdio> \n#include<algorithm>\n#include<cstring>\n#define mod 1000000007\n#define maxn 1000010\nusing namespace std;\nint a[maxn],n,q,m;\ninline int read(){\n\tregister int x=0,f=0,ch=getchar();\n\twhile('0'>ch||ch>'9')f^=ch=='-',ch=getchar();\n\twhile('0'<=ch&&ch<='9')x=(x<<1)+(x<<3)+(ch^'0'),ch=getchar();\n\treturn f?-x:x;\n}\nstruct node\n{\n    long long num[110];\n    node(){\n    \tmemset(num,0,sizeof(num));\n\t}\n}l,r,mid;\nnode mul(node x,node y)\n{\n    node aa=node();\n    for(int i=0;i<m;i++)\n    {\n        for(int j=0;j<m;j++)\n        {\n            int k=(i+j)%m;\n            aa.num[k]+=x.num[i]*y.num[j]%mod;\n            aa.num[k]%=mod;\n        }\n    }\n    return aa;\n}\nnode qpow(node nod,int k)\n{\n    node sum=nod;\n    k--;\n    while(k)\n    {\n        if(k&1)\n        {\n            sum=mul(sum,nod);\n        }\n        k>>=1;\n        nod=mul(nod,nod);\n    }\n    return sum;\n}\nint main()\n{\n    l=node();\n    r=node();\n    mid=node();\n    n=read(),q=read(),m=read();\n    for(int i=1;i<=n;i++)\n    {\n        int x=read();\n        l.num[x%m]++;\n    }\n    for(int i=1;i<=n;i++)\n    {\n        int x=read();\n        a[i]=x;\n        mid.num[x%m]++;\n    }\n    for(int i=1;i<=n;i++) {\n        int x=read();\n        r.num[(x+a[i])%m]++;\n    }\n    node nod;\n    if(q-2>0){\n        nod=qpow(mid,q-2);    \n        nod=mul(nod,l);\n        nod=mul(nod,r); \n    }\n    else\n        nod=mul(l,r);\n    long long ans=0;\n    for(int j=0;j<=100;j++){\n        if(j%m==0){\n            ans+=nod.num[j];\n            ans%=mod;\n        }\n    }\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n ```",
        "postTime": 1592569401,
        "uid": 181506,
        "name": "Jay142753869",
        "ccfLevel": 5,
        "title": "CF852B Neural Network country\u9898\u89e3"
    }
]
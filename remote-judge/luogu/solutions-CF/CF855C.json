[
    {
        "content": "## Description\n\n\u7ed9\u4f60\u4e00\u4e2a\u6811\uff0c\u53ef\u4ee5\u67d3 $m$ \u4e2a\u989c\u8272\uff0c\u5b9a\u4e49\u4e00\u4e2a\u7279\u6b8a\u989c\u8272 $k$ \uff0c \u8981\u6c42\u4fdd\u8bc1\u6574\u68f5\u6811\u4e0a\u7279\u6b8a\u989c\u8272\u7684\u4e2a\u6570\u4e0d\u8d85\u8fc7 $x$ \u4e2a\u3002\u540c\u65f6\uff0c\u5982\u679c\u4e00\u4e2a\u8282\u70b9\u662f\u7279\u6b8a\u989c\u8272\uff0c\u90a3\u4e48\u5b83\u7684\u76f8\u90bb\u8282\u70b9\u7684\u989c\u8272\u7f16\u53f7\u5fc5\u987b\u5168\u90e8\u5c0f\u4e8e $k$\u3002\u6c42\u65b9\u6848\u6570\u3002\n\n## Input\n\n\u7b2c\u4e00\u884c $n,m$ \u4ee3\u8868\u8282\u70b9\u4e2a\u6570\u548c\u989c\u8272\u6811\n\n\u4e0b\u9762 $n~-~1$ \u884c\u63cf\u8ff0\u4e00\u68f5\u6811\n\n\u6700\u540e\u4e00\u884c\u662f\u7279\u6b8a\u989c\u8272 $k$ \u548c\u989c\u8272\u4e2a\u6570 $x$\n\n## Output\n\n\u8f93\u51fa\u4e00\u884c\u4e00\u4e2a\u6574\u6570\uff0c\u4ee3\u8868\u7b54\u6848\u5bf9 $10^9~+~7$ \u53d6\u6a21\u7ed3\u679c\n\n## Hint\n\n$Forall:$\n\n$n~\\leq~10^5~,~m~\\leq~10^9~,~k~\\leq~m~,~x~\\leq~10$\n\n## Solution\n\n\u8fd9\u9898\u611f\u89c9\u6709\u70b9\u50cf[DDOSvoid\u7684\u7591\u60d1](https://www.luogu.org/problemnew/show/P5007)\n\n~~**\u6211 \u7206 \u7834 \u6211 \u81ea \u5df1**~~\n\n\u6570\u6570\u9898\uff0c\u8003\u8651DP\u3002\n\n\u663e\u7136\u8fd9\u4e2a\u9898\u7684\u9009\u70b9\u5206\u4e3a\u4e09\u79cd\uff0c\u5206\u522b\u662f\u5c0f\u4e8e $k$\uff0c\u7b49\u4e8e $k$\uff0c\u5927\u4e8e $k$\u3002\u540c\u65f6\u6709\u989c\u8272\u4e2a\u6570\u7684\u9650\u5236\uff0c\u4e8e\u662f\u53ef\u4ee5\u8bbe $f_{i,j,0/1/2}$ \u4ee3\u8868\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\uff0c\u9009\u4e86 $j$ \u4e2a\u7279\u6b8a\u989c\u8272\uff0c\u5176\u4e2d\u8282\u70b9 $i$ \u7684\u989c\u8272 \u5c0f\u4e8e/\u7b49\u4e8e/\u5927\u4e8e $k$\n\n\u8003\u8651\u4e00\u4e2a\u8282\u70b9\u53ea\u6709\u4e24\u4e2a\u513f\u5b50\u7684\u60c5\u51b5\uff0c\u76f4\u63a5\u628a\u8d21\u732e\u4e58\u4e00\u4e0b\u5373\u53ef\u3002\n\n\u8003\u8651\u4e00\u4e2a\u8282\u70b9\u6709\u591a\u4e2a\u513f\u5b50\u7684\u65f6\u5019\uff0c\u6bcf\u52a0\u5165\u4e00\u4e2a\u65b0\u8282\u70b9\u4ea7\u751f\u7684\u8d21\u732e\u5982\u4f55\u8ba1\u7b97\uff1a\n\n\u8bbe $g_{i,j,0/1/2}$ \u4e3a $u$ \u7684\u5b50\u6811\uff08\u7701\u7565\u7b2c\u4e00\u7ef4\uff09\uff0c\u8003\u8651\u524d $i$ \u4e2a\u513f\u5b50\uff0c\u9009\u4e86 $j$ \u4e2a $k$\uff0c\u8282\u70b9 $i$ \u7684\u72b6\u6001\u662f $0/1/2$ \u7684\u65b9\u6848\u6570\u3002\n\n\u4e00\u4e0b\u5047\u8bbe\u5f53\u524d\u679a\u4e3e\u7684\u662f $u$ \u7684\u7b2c $i$ \u4e2a\u513f\u5b50\u3002\n\n\u8003\u8651 $u$ \u9009\u5c0f\u4e8e $k$ \u7684\u60c5\u51b5\uff1a\n\n\u5219\u8be5\u513f\u5b50\u53ef\u4ee5\u9009 $0/1/2$ \u4e09\u79cd\u60c5\u51b5\uff0c\u8fd9\u4e09\u79cd\u60c5\u51b5\u76f8\u4e92\u5e76\u884c\uff0c\u5e94\u8be5\u5c06\u8d21\u732e\u76f8\u52a0\uff0c\u540c\u65f6\u4e24\u4e24\u5b50\u6811\u95f4\u4e92\u4e0d\u5f71\u54cd\uff0c\u5e94\u5c06\u8d21\u732e\u76f8\u4e58\u3002\n\n\u4e8e\u662f\u6709\n\n$$g_{i,j,0}~=~\\sum_{h=0}^{j}(g_{i-1,j-h,0}~\\times~\\sum_{s=0}^{2}f_{to,h,s})$$\n\n\u540c\u7406\uff0c$u$ \u9009\u7b49\u4e8e $k$ \u7684\u60c5\u51b5\uff1a\n\n\u8be5\u513f\u5b50\u53ea\u80fd\u9009 $0$ \u4e00\u79cd\u60c5\u51b5\uff0c\u4e8e\u662f\u6709\n\n$$g_{i,j,1}~=~\\sum_{h=0}^{j}(g_{i-1,j-h,1}~\\times~f_{to,h,0})$$\n\n\u540c\u7406\uff0c$u$ \u9009\u5927\u4e8e $k$ \u7684\u60c5\u51b5\uff1a\n\n\u8be5\u513f\u5b50\u53ef\u4ee5\u9009 $0/2$ \u4e24\u79cd\u53ef\u80fd\uff0c\u4e8e\u662f\n\n$$g_{i,j,2}~=~\\sum_{h=0}^{j}(g_{i-1,j-h,2}~\\times~\\sum_{s=0,2}f_{to,h,s})$$\n\n\u8bbe $u$ \u6709 $v$ \u4e2a\u5b69\u5b50\uff0c\u4e8e\u662f\n\n$$f_{u,j,0/1/2}~=~g_{v,j,0/1/2}$$\n\n\u5f53\u7136 $g$ \u53ef\u4ee5\u628a\u7b2c\u4e00\u7ef4\u6eda\u6389\uff0c\u8fd9\u6837\u5c31\u6ca1\u6709\u7a7a\u95f4\u95ee\u9898\u8fa3~\n\n\u4e8e\u662f\u5c31\u53ef\u4ee5\u7edf\u8ba1\u7b54\u6848\u4e86\u3002\u8bb0\u5f97\u53d6\u6a21\u3002\u4ee3\u7801\u91cc\u9762\u56e0\u4e3a\u4e0d\u77e5\u9053\u54ea\u91cc\u7206\u6389\u4e86\u4e8e\u662f\u5e72\u8106 $define~~int~~ll$ \u4e8623333\n\n## Code\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#ifdef ONLINE_JUDGE\n#define freopen(a, b, c)\n#define putchar(o) \\\nputs(\"I am a cheater!\")\n#endif\n#define rg register\n#define ci const int\n#define cl const long long\n#define int ll\n\n\ntypedef long long ll;\n\nnamespace IPT {\n\tconst int L = 1000000;\n\tchar buf[L], *front=buf, *end=buf;\n\tchar GetChar() {\n\t\tif (front == end) {\n\t\t\tend = buf + fread(front = buf, 1, L, stdin);\n\t\t\tif (front == end) return -1;\n\t\t}\n\t\treturn *(front++);\n\t}\n}\n\ntemplate <typename T>\ninline void qr(T &x) {\n\trg char ch = IPT::GetChar(), lst = ' ';\n\twhile ((ch > '9') || (ch < '0')) lst = ch, ch=IPT::GetChar();\n\twhile ((ch >= '0') && (ch <= '9')) x = (x << 1) + (x << 3) + (ch ^ 48), ch = IPT::GetChar();\n\tif (lst == '-') x = -x;\n}\n\ntemplate <typename T>\ninline void ReadDb(T &x) {\n\trg char ch = IPT::GetChar(), lst = ' ';\n\twhile ((ch > '9') || (ch < '0')) lst = ch, ch = IPT::GetChar();\n\twhile ((ch >= '0') && (ch <= '9')) x = x * 10 + (ch ^ 48), ch = IPT::GetChar();\n\tif (ch == '.') {\n\t\tch = IPT::GetChar();\n\t\tdouble base = 1;\n\t\twhile ((ch >= '0') && (ch <= '9')) x += (ch ^ 48) * ((base *= 0.1)), ch = IPT::GetChar();\n\t}\n\tif (lst == '-') x = -x;\n}\n\nnamespace OPT {\n\tchar buf[120];\n}\n\ntemplate <typename T>\ninline void qw(T x, const char aft, const bool pt) {\n\tif (x < 0) {x = -x, putchar('-');}\n\trg int top=0;\n\tdo {OPT::buf[++top] = x % 10 + '0';} while (x /= 10);\n\twhile (top) putchar(OPT::buf[top--]);\n\tif (pt) putchar(aft);\n}\n\nconst int maxn = 100010;\nconst int maxm = 200010;\nconst int MOD = 1000000007;\n\nstruct Edge {\n\tint to, nxt;\n};\nEdge edge[maxm]; int hd[maxn], ecnt = 1;\ninline void cont(ci from, ci to) {\n\tEdge &e = edge[++ecnt];\n\te.to = to; e.nxt = hd[from]; hd[from] = ecnt;\n}\n\nint n, m, x, v, dv;\nint frog[maxn][15][3], gorf[maxn][2][15][3];\n\nvoid reading();\nvoid dfs(ci, ci);\n\nsigned  main() {\n\tfreopen(\"1.in\", \"r\", stdin);\n\tqr(n); qr(m);\n\treading();\n\tqr(v); qr(x); dv = m - v;\n\tdfs(1, 0);\n\tint ans = 0;\n\tfor (rg int i = 0; i <= x; ++i) \n\t\tfor(rg int j = 0; j < 3; ++j) ans = (ans + frog[1][i][j]) % MOD;\n\tqw(ans, '\\n', true);\n\treturn 0;\n}\n\nvoid reading() {\n\tint a, b;\n\tfor (rg int i = 1; i < n; ++i) {\n\t\ta = b = 0;\n\t\tqr(a); qr(b);\n\t\tcont(a, b);\n\t\tcont(b, a);\n\t}\n}\n\nvoid dfs(ci u, ci pree) {\n\tint pre = 0;\n\tgorf[u][pre][0][0] = v - 1;\n\tgorf[u][pre][1][1] = 1;\n\tgorf[u][pre][0][2] = dv;\n\tfor (int i = hd[u]; i; i = edge[i].nxt) if(i != pree) {\n\t\tint &to = edge[i].to;\n\t\tdfs(to, i ^ 1);\n\t\tpre ^= 1;\n\t\tmemset(gorf[u][pre], 0, sizeof gorf[u][pre]);\n\t\tfor (rg int j = 0; j <= x; ++j) {\n\t\t\tfor (rg int k = 0; k <= j; ++k) {\n\t\t\t\tgorf[u][pre][j][0] = (gorf[u][pre][j][0] + 1ll * gorf[u][pre ^ 1][j - k][0] * (frog[to][k][0] + frog[to][k][1] + frog[to][k][2])) % MOD;\n\t\t\t\tgorf[u][pre][j][1] = (1ll * gorf[u][pre ^ 1][j - k][1] * frog[to][k][0] + gorf[u][pre][j][1]) % MOD;\n\t\t\t\tgorf[u][pre][j][2] = (1ll * gorf[u][pre ^ 1][j - k][2] * (frog[to][k][0] + frog[to][k][2]) + gorf[u][pre][j][2]) % MOD;\n\t\t\t}\n\t\t}\n\t}\n\tfor (rg int i = 0; i <= x; ++i) \n\t\tfor (rg int j = 0; j < 3; ++j)\n\t\t\tfrog[u][i][j] = gorf[u][pre][i][j];\n#ifdef DEBUG\n\tprintf(\"EM%d:\\n\", u);\n\tfor (rg int i = 0; i <= x; ++i) {\n\t\tfor (rg int j = 0; j < 3; ++j) \n\t\t\tprintf(\"%d %d %d\\n\",i, j, frog[u][i][j]);\n\t}\n#endif\n}\n```\n\n## Summary\n\n\u8fd9\u7c7b\u6811\u4e0a\u6c42\u65b9\u6848\u6570\u7684\u95ee\u9898\u90fd\u9700\u8981\u5728\u8f6c\u79fb\u65f6\u501f\u52a9\u4e00\u4e2a\u8f85\u52a9\u6570\u7ec4\uff0c\u8bb0\u5f55\u5df2\u7ecf\u679a\u4e3e\u8fc7\u5f97\u513f\u5b50\u7684\u4fe1\u606f\uff0c\u7136\u540e\u8ba1\u7b97\u5f53\u524d\u8fd9\u4e2a\u513f\u5b50\u52a0\u5165\u7684\u8d21\u732e\u3002",
        "postTime": 1544253585,
        "uid": 65363,
        "name": "\u4e00\u6276\u82cf\u4e00",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF855C \u3010Helga Hufflepuff's Cup\u3011"
    },
    {
        "content": "## Description\n\u539f\u9898\u7684\u7ffb\u8bd1\u591a\u5c11\u6709\u70b9\u95ee\u9898\u3002\u642c\u4e00\u4e0b \u4e00\u6276\u82cf\u4e00 \u5728\u9898\u89e3\u4e2d\u7684\u7ffb\u8bd1\uff1a\n\n\u7ed9\u4f60\u4e00\u4e2a\u6811\uff0c\u53ef\u4ee5\u67d3 $m$ \u4e2a\u989c\u8272\uff0c\u5b9a\u4e49\u4e00\u4e2a\u7279\u6b8a\u989c\u8272 $k$ \uff0c \u8981\u6c42\u4fdd\u8bc1\u6574\u68f5\u6811\u4e0a\u7279\u6b8a\u989c\u8272\u7684\u4e2a\u6570\u4e0d\u8d85\u8fc7 $x$ \u4e2a\u3002\u540c\u65f6\uff0c\u5982\u679c\u4e00\u4e2a\u8282\u70b9\u662f\u7279\u6b8a\u989c\u8272\uff0c\u90a3\u4e48\u5b83\u7684\u76f8\u90bb\u8282\u70b9\u7684\u989c\u8272\u7f16\u53f7\u5fc5\u987b\u5168\u90e8\u5c0f\u4e8e $k$\u3002\u6c42\u65b9\u6848\u6570\u3002\n\n## Analysis\n\u8bfb\u9898\u610f\uff0c\u6811\u4e0a\u65b9\u6848\u6570\u7edf\u8ba1\u95ee\u9898\uff0c\u663e\u7136\u6811\u5f62 dp \u3002\n\n\u8003\u8651\u4ec0\u4e48\u56e0\u7d20\u4f1a\u5bf9\u7b54\u6848\u9020\u6210\u5f71\u54cd\uff1a\u5b50\u6811\u5185 **\u5df2\u7ecf\u67d3\u7684\u7279\u6b8a\u989c\u8272\u6570\u91cf**\uff0c\u5f53\u524d\u70b9\u7f16\u53f7 **\u4e0e\u7279\u6b8a\u989c\u8272\u7f16\u53f7\u7684\u5173\u7cfb** \u3002\n\n\u4e0e\u7279\u6b8a\u7f16\u53f7\u7684\u5173\u7cfb\u65e0\u975e $3$ \u79cd\uff0c\u5c0f\u4e8e\uff0c\u7b49\u4e8e\uff0c\u5927\u4e8e\uff0c\u53ea\u8981\u662f\u8fd9 $3$ \u79cd\u60c5\u51b5\u4e2d\u7684\u4e00\u79cd\uff0c\u5177\u4f53\u7684\u989c\u8272\u4e0d\u4f1a\u5bf9\u7b54\u6848\u9020\u6210\u5f71\u54cd\uff08\u4f8b\u5982 $k=3$ \uff0c\u5f53\u524d\u8282\u70b9\u662f $1/2$ \u4e0d\u5f71\u54cd\u7b54\u6848\uff09\u3002\n\n\u90a3\u4e48\u72b6\u6001\u5c31\u5f88\u663e\u7136\u4e86\u3002\n\n\u8bbe $f_{x,j,0/1/2}$ \u8868\u793a\u5728 $x$ \u7684\u5b50\u6811\u5185\u5df2\u7ecf\u53d6\u4e86 $j$ \u4e2a\u7279\u6b8a\u989c\u8272\uff0c\u5f53\u524d\u8282\u70b9\u989c\u8272\u7f16\u53f7 \u5c0f\u4e8e/\u7b49\u4e8e/\u5927\u4e8e $k$ \u7684\u65b9\u6848\u6570\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u5c31\u662f\u4e00\u822c\u7684\u6811\u5f62\u80cc\u5305\u4e86\u3002\n\n\u6839\u636e\u9898\u610f\uff0c\u6709\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n\uff08\u5176\u4e2d\uff0c $x$ \u8868\u793a\u5f53\u524d\u8282\u70b9\uff0c $y$ \u8868\u793a\u5f53\u524d\u6b63\u5728\u5408\u5e76\u7684\u5b50\u6811\uff0c $si_{i}$ \u8868\u793a\u5728\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u5185\u70b9\u7684\u6570\u91cf\u3002\uff09\n\n1. \u5f53\u524d\u8282\u70b9\u7f16\u53f7 $< k$ \uff0c\u90a3\u4e48\u513f\u5b50\u968f\u4fbf\u53d6\uff1a\n\n$$f_{x,i+j,0}=\\sum\\limits_{i=0}^{si_{x}}\\sum\\limits_{j=0}^{si_{y}}f_{x,i,0}\\times(f_{y,j,0}+f_{y,j,1}+f_{y,j,2})$$\n\n2. \u5f53\u524d\u8282\u70b9\u7f16\u53f7 $= k$ \uff0c\u90a3\u4e48\u513f\u5b50\u7f16\u53f7 $<k$ \uff1a\n\n$$f_{x,i+j,0}=\\sum\\limits_{i=0}^{si_{x}}\\sum\\limits_{j=0}^{si_{y}}f_{x,i,0}\\times f_{y,j,0}$$\n\n3. \u5f53\u524d\u8282\u70b9\u7f16\u53f7 $> k$ \uff0c\u90a3\u4e48\u513f\u5b50\u53ea\u6709 $k$ \u4e0d\u80fd\u53d6\uff1a\n\n$$f_{x,i+j,0}=\\sum\\limits_{i=0}^{si_{x}}\\sum\\limits_{j=0}^{si_{y}}f_{x,i,0}\\times (f_{y,j,0}+f_{y,j,2})$$\n\n\u8fb9\u754c\u60c5\u51b5\uff1a\n\n$$f_{x,0,0}=k-1$$\n\n$$f_{x,1,1}=1$$\n\n$$f_{x,0,2}=m-k$$\n\n## Notice\n\n- \u6ce8\u610f\u53d6\u6a21\u3002\n\n- \u80cc\u5305\u7684\u65f6\u5019\u4e0b\u6807\u53ef\u80fd\u4f1a\u91cd\u590d\uff0c\u8bb0\u5f97\u5148\u8bb0\u4e0b\u539f\u5b50\u6811\u7684\u4fe1\u606f\u518d\u66f4\u65b0\u3002\n\n## Code\n\n```cpp\n#include<bits/stdc++.h>\n#define LL long long\n#define inf 0x3f3f3f3f\nusing namespace std;\ninline LL read(){\n\tLL res=0,fl=1;\n\tchar ch=getchar();\n\twhile(!(ch>='0' && ch<='9')){if(ch=='-')fl=-1;ch=getchar();}\n\twhile(ch>='0' && ch<='9')res=(res<<3)+(res<<1)+ch-'0',ch=getchar();\n\treturn res*fl;\n}\ninline LL max(LL a,LL b){return a>b?a:b;}\ninline LL min(LL a,LL b){return a<b?a:b;}\ninline void swap(int &a,int &b){int c;c=a;a=b;b=c;}\nconst int MAXN=1e5+5,MAXK=10+5,mod=1e9+7;\nint n,m,k,p,ans=0,si[MAXN],f[MAXN][MAXK][3],g[MAXN][MAXK];\nvector<int> e[MAXN];\ninline void Tree_dp(int x,int fa){\n\tsi[x]=1;\n\tf[x][0][0]=k-1;\n\tf[x][1][1]=1;\n\tf[x][0][2]=m-k;\n\tfor(int i=0;i<e[x].size();i++){\n\t\tint y=e[x][i];\n\t\tif(y!=fa){\n\t\t\tTree_dp(y,x);\n\t\t\tint up1=min(si[x],p),up2;\n\t\t\tfor(int j=0;j<=up1;j++)\n\t\t\t\tfor(int c=0;c<=2;c++)\n\t\t\t\t\tg[j][c]=f[x][j][c],f[x][j][c]=0;\n\t\t\t\n\t\t\tfor(int j=0;j<=up1;j++){\n\t\t\t\tup2=min(si[y],p-j);\n\t\t\t\tfor(int l=0;l<=up2;l++){\n\t\t\t\t\tf[x][j+l][0]=(f[x][j+l][0]+1LL*g[j][0]%mod*((f[y][l][0]+f[y][l][1])%mod+f[y][l][2])%mod)%mod;\n\t\t\t\t\tf[x][j+l][1]=(f[x][j+l][1]+1LL*g[j][1]%mod*f[y][l][0]%mod)%mod;\n\t\t\t\t\tf[x][j+l][2]=(f[x][j+l][2]+1LL*g[j][2]%mod*(f[y][l][0]+f[y][l][2])%mod)%mod;\n\t\t\t\t}\n\t\t\t}\n\t\t\tsi[x]+=si[y];\n\t\t}\n\t}\n}\nint main() {\n\tint x,y;\n\tn=read(),m=read();\n\tfor(int i=1;i<n;i++){\n\t\tx=read(),y=read();\n\t\te[x].push_back(y);\n\t\te[y].push_back(x);\n\t}\n\tk=read(),p=read();\n\tTree_dp(1,0);\n\tfor(int i=0;i<=p;i++)\n\t\tfor(int j=0;j<=2;j++)\n\t\t\tans=(ans+f[1][i][j])%mod;\n\tcout<<ans<<'\\n';\n\treturn 0;\n}\n\n\n```\n",
        "postTime": 1661642856,
        "uid": 347086,
        "name": "Powerless233",
        "ccfLevel": 6,
        "title": "Solution of CF855C"
    },
    {
        "content": "\u4e00\u9053\u5f88\u597d\u7684\u6811\u5f62$DP$\n\n\u6bcf\u4e2a\u8282\u70b9\u53ef\u4ee5\u770b\u6210\u6709\u4e09\u79cd\u53d6\u503c\uff0c\u5206\u522b\u4e3a\u5927\u4e8e$K$\u3001\u7b49\u4e8e$K$\u3001\u5c0f\u4e8e$K$\n\n\u4e0d\u59a8\u8bbe\uff1a\n\n$\\large f_{i,j,k}:$ \u4ee5$i$\u4e3a\u6839\u7684\u5b50\u6811\uff0c\u6709$j$\u4e2a\u70b9\u4e3a\u7279\u6b8a\u989c\u8272\uff0c$i$\u8282\u70b9\u4e3a$k$\u7684\u65b9\u6848\u6570\n\n\u5176\u4e2d$k$\u4e3a$0,1,2$\uff0c\u5206\u522b\u4e3a\u5927\u4e8e$K$\u3001\u7b49\u4e8e$K$\u3001\u5c0f\u4e8e$K$\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8282\u70b9\uff0c\u8fd8\u8981\u518d\u8fdb\u884c\u4e00\u6b21$DP$\uff0c\u8bbe\uff1a\n\n$\\large G_{x,i,j,k}:$ $x$\u4e3a\u6811\u7684\u6839\uff0c$x$\u7684\u989c\u8272\u4e3a$k$\uff0c\u524d$i$\u4e2a\u5b50\u8282\u70b9\uff0c\u5176\u4e2d$j$\u4e2a\u5b50\u8282\u70b9\u4e3a\u7279\u6b8a\u989c\u8272\u7684\u65b9\u6848\u6570\u3002\u663e\u7136\uff0c\u524d\u4e24\u7ef4\u53ef\u4ee5\u6eda\u6389\u3002\n\n\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$\\large G_{j+k,0}=f_{x,j,0}\\times \\sum\\limits_{i=0}^2  \\sum\\limits_{i=0}^2 f_{son,k,i}$\n\n$\\large G_{j+k,0}=f_{x,j,0}\\times f_{son,k,0}$\n\n$\\large G_{j+k,0}=f_{x,j,0}\\times (f_{son,k,0}+f_{son,k,2})$\n\n## code\n```\n#include<bits/stdc++.h>\n#define maxn 100005\n#define ll long long\nusing namespace std;\nconst ll TT=1e9+7;\nint s[maxn],n,x,tot,y,lnk[maxn],m,K,nxt[maxn<<1],son[maxn<<1],N;\nll f[maxn][15][3],G[15][3],Ans;\ninline int read(){\n\tint ret=0;char ch=getchar();\n\twhile (ch<'0'||ch>'9') ch=getchar();\n\twhile (ch<='9'&&ch>='0') ret=ret*10+ch-'0',ch=getchar();\n\treturn ret;\n}\ninline void add(int x,int y){nxt[++tot]=lnk[x];lnk[x]=tot;son[tot]=y;}\ninline void Dfs(int x,int fa){\n\tf[x][0][0]=K-1;\n\ts[x]=f[x][1][1]=1;\n\tf[x][0][2]=m-K;\n\tfor (int i=lnk[x];i;i=nxt[i])\n\t  if (son[i]!=fa){\n\t  \tDfs(son[i],x);memset(G,0,sizeof G);\n\t  \tfor (int j=0;j<=s[x];j++)\n\t  \tfor (int k=0;k<=s[son[i]];k++){\n\t  \t\tif (j+k>N) break;\n\t  \t\tG[j+k][0]=(G[j+k][0]+f[x][j][0]*(f[son[i]][k][0]+f[son[i]][k][1]+f[son[i]][k][2]))%TT;\n\t\t    G[j+k][1]=(G[j+k][1]+f[x][j][1]*f[son[i]][k][0])%TT;\n\t\t    G[j+k][2]=(G[j+k][2]+f[x][j][2]*(f[son[i]][k][0]+f[son[i]][k][2]))%TT;\n\t\t  }\n\t\ts[x]=min(s[x]+s[son[i]],N);\n\t\tfor (int j=0;j<=s[x];j++)\n\t\tfor (int k=0;k<3;k++) f[x][j][k]=G[j][k];\n\t  }\n}\nint main(){\n\tn=read(),m=read();\n\tfor (int i=1;i<n;i++) x=read(),y=read(),add(x,y),add(y,x);\n\tK=read(),N=read();Dfs(1,0);\n\tfor (int i=0;i<=s[1];i++)\n\tfor (int j=0;j<3;j++) Ans=(Ans+f[1][i][j])%TT;\n\tprintf(\"%lld\",Ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1594961885,
        "uid": 108047,
        "name": "LlLlCc",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF855C \u3010Helga Hufflepuff's Cup\u3011"
    },
    {
        "content": "\u4e00\u9053\u5f88\u6709\u610f\u601d\u7684\u6811\u5f62 dp\uff0c\u548c [P4516 \u6f5c\u5165\u884c\u52a8](https://www.luogu.com.cn/problem/P4516) \u975e\u5e38\u76f8\u4f3c\u3002\n\n\u8003\u8651\u72b6\u6001\u600e\u4e48\u5b9a\u4e49\u3002\u7b2c\u4e00\u4e2a\u7ef4\u5ea6\u80af\u5b9a\u662f\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\uff0c\u7b2c\u4e8c\u4e2a\u7ef4\u5ea6\u662f\u5f53\u524d\u5b50\u6811\u4e2d\u7684\u7279\u6b8a\u8282\u70b9\u4e2a\u6570\uff0c\u540c\u65f6\u8fd8\u8981\u8003\u8651**\u5f53\u524d\u8282\u70b9\u7684\u989c\u8272**\uff0c\u5373\u4e3a\u7b2c\u4e09\u4e2a\u7ef4\u5ea6\u3002\n\n**\u5f53\u524d\u8282\u70b9\u7684\u989c\u8272**\u65e0\u975e\u8ddf $k$ \u6709\u5173\uff0c\u5373\u5c0f\u4e8e $k$\uff0c\u7b49\u4e8e $k$\uff0c\u5927\u4e8e $k$ \u8fd9\u4e09\u79cd\u5173\u7cfb\uff0c\u5c06\u8fd9\u4e09\u79cd\u5173\u7cfb\u8bb0\u4e3a $0/1/2$\u3002\u6545\u5b9a\u4e49 $dp_{i,j,k}$ \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u6709 $j$ \u4e2a\u7279\u6b8a\u8282\u70b9\uff0c\u4e14\u5f53\u524d\u8282\u70b9\u989c\u8272\u7f16\u53f7\u5173\u7cfb\u662f $k$ \u7684\u67d3\u8272\u65b9\u6848\u6570\u3002\n\n\u8003\u8651\u521d\u59cb\u5316\u3002$dp_{i,0,1}=k-1,dp_{i,1,1}=1,dp_{i,0,2}=m-k$\u3002\n\n\u8003\u8651\u8f6c\u79fb\u3002\u5957\u8def\u7684\u6765\u8bb2\uff0c\u82e5 $x$ \u662f $y$ \u7684\u7236\u4eb2\uff0c\u5219\u679a\u4e3e $x$ \u9009\u62e9 $j$ \u4e2a\u70b9\uff0c\u679a\u4e3e $y$ \u9009\u62e9 $k(k\\leq j)$ \u4e2a\u70b9\u3002\u5373\u4e3a $dp_{x,j}=\n\\text{combine}(dp_{x,j-k},dp_{y,k})$\u3002\n\n\u6b64\u9898\u4e2d\uff0c\u56e0\u4e3a\u52a0\u4e0a\u4e86 $k$ \u8fd9\u4e2a\u7ef4\u5ea6\uff0c\u6240\u4ee5\u9700\u8981\u8ba8\u8bba $k=0/1/2$ \u8fd9\u4e09\u79cd\u60c5\u51b5\u3002\n\n* \u82e5 $k=0$\uff0c\u5373\u5f53\u524d\u8282\u70b9\u989c\u8272\u7f16\u53f7\u5c0f\u4e8e $k$\uff0c\u5219\u513f\u5b50\u968f\u4fbf\u9009\u3002    \n$dp_{u,j,0}=\n\\sum dp_{u,j-k,0}\\times (dp_{v,k,0}+dp_{v,k,1}+dp_{v,k,2})$\n* \u82e5 $k=1$\uff0c\u5373\u5f53\u524d\u8282\u70b9\u989c\u8272\u7f16\u53f7\u7b49\u4e8e $k$\uff0c\u5219\u513f\u5b50\u989c\u8272\u7f16\u53f7\u53ea\u80fd\u5c0f\u4e8e $k$\u3002   \n$dp_{u,j,1}=\n\\sum dp_{u,j-k,1}\\times dp_{v,k,0}$\n* \u82e5 $k=2$\uff0c\u5373\u5f53\u524d\u8282\u70b9\u989c\u8272\u7f16\u53f7\u5927\u4e8e $k$\uff0c\u513f\u5b50\u989c\u8272\u7f16\u53f7\u9664\u4e86 $k$ \u5176\u4ed6\u90fd\u53ef\u4ee5\u9009\u3002   \n$dp_{u,j,2}=\n\\sum dp_{u,j-k,2}\\times (dp_{v,k,0}+dp_{v,k,2})$\n\n\u7b54\u6848\u5373\u4e3a $\\sum_{i=0}^{x}\\sum_{j=0}^{2\n} dp_{1,i,j}$\u3002\n\n## \u4ee3\u7801\n```c++\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\nconst int N = 1e5 + 5, mod = 1e9 + 7;\n\nint n, m, k, x, dp[N][11][3], tmp[11][3];\n\nint en, first[N], sz[N];\nstruct edge {\n\tint e, next;\n}ed[N * 2];\n\nvoid add_edge(int s, int e) {\n\ten++;\n\ted[en].e = e;\n\ted[en].next = first[s];\n\tfirst[s] = en;\n}\n\nvoid init(int u, int fa) {  // \u9884\u5904\u7406\u5b50\u6811\u5927\u5c0f\n\tsz[u] = 1;\n\tfor (int p = first[u]; p; p = ed[p].next) {\n\t\tint e = ed[p].e;\n\t\tif (e == fa) continue;\n\t\tinit(e, u);\n\t\tsz[u] += sz[e];\n\t}\n}\n\nvoid dfs(int u, int fa) {\n\tdp[u][0][0] = k - 1;\n\tdp[u][1][1] = 1;\n\tdp[u][0][2] = m - k;\n\tfor (int p = first[u]; p; p = ed[p].next) {\n\t\tint e = ed[p].e;\n\t\tif (e == fa) continue;\n\t\tdfs(e, u);\n\t\tfor (int j = 0; j <= x; j++) {\n\t\t\tfor (int k = 0; k < 3; k++) {\n\t\t\t\ttmp[j][k] = dp[u][j][k];\n\t\t\t\tdp[u][j][k] = 0;\n\t\t\t}\n\t\t}\n\t\tfor (int j = min(sz[u], x); j >= 0; j--) {\n\t\t\tfor (int k = 0; k <= min(sz[e], j); k++) {\n\t\t\t\tdp[u][j][0] = (dp[u][j][0] + tmp[j - k][0] * (dp[e][k][0] + dp[e][k][1] + dp[e][k][2]) % mod) % mod;\n\t\t\t\tdp[u][j][1] = (dp[u][j][1] + tmp[j - k][1] * dp[e][k][0] % mod) % mod;\n\t\t\t\tdp[u][j][2] = (dp[u][j][2] + tmp[j - k][2] * (dp[e][k][0] + dp[e][k][2]) % mod) % mod;\n\t\t\t}\n\t\t}\n\t}\n}\n\nsigned main() {\n// \tfreopen(\"color.in\", \"r\", stdin);\n// \tfreopen(\"color.out\", \"w\", stdout);\n\tcin >> n >> m;\n\tfor (int i = 1; i <= n - 1; i++) {\n\t\tint u, v;\n\t\tcin >> u >> v;\n\t\tadd_edge(u, v), add_edge(v, u);\n\t}\n\tcin >> k >> x;\n\tinit(1, -1);\n\tdfs(1, -1);\n\tint res = 0;\n\tfor (int i = 0; i <= x; i++) {\n\t\tfor (int j = 0; j < 3; j++) res = (res + dp[1][i][j]) % mod; \n\t}\n\tcout << res << endl;\n}\n```",
        "postTime": 1683191313,
        "uid": 411727,
        "name": "stOtue",
        "ccfLevel": 0,
        "title": "CF855C"
    }
]
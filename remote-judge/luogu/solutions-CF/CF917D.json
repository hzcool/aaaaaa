[
    {
        "content": "\n\u600e\u4e48\u522b\u7684\u505a\u6cd5\u90fd\u662f $\\mathcal{O(n^4)}$ \u7684\u795e\u4ed9\u89e3\u6cd5\n\n\u5148\u8003\u8651\u8bbe $g_i$ \u8868\u793a\u81f3\u5c11\u6709 $i$ \u6761\u8fb9\u91cd\u5408\u7684\u65b9\u6848\u6570\uff0c\u8fd9\u7b49\u4ef7\u4e8e\u6709 $n-i$ \u4e2a\u8054\u901a\u5757\u7684\u65b9\u6848\u6570\u3002\u90a3\u4e48\u5bf9\u4e8e $f_i$ \u7684\u8ba1\u7b97\u5c31\u53ea\u9700\u8981\u4e8c\u9879\u5f0f\u53cd\u6f14\u5373\u53ef\u3002\n\n\u7136\u540e\u8003\u8651\u5982\u679c\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86\u4e00\u4e2a\u8054\u901a\u5757\u5212\u5206 S \u4e4b\u540e\u6211\u4eec\u600e\u4e48\u505a\uff0c\u53ef\u4ee5\u8bc1\u660e\u5047\u8bbe\u5f53\u524d\u6709 $k$ \u4e2a\u8054\u901a\u5757\uff0c\u7b2c $i$ \u4e2a\u8054\u901a\u5757\u5927\u5c0f\u4e3a $a_i$\uff0c$n=\\sum a_i$\uff0c\u5219\u6709\u751f\u6210\u6811\u7684\u6570\u91cf\u4e3a $\\prod a\\times n^{k-2}$\uff0c\u8bc1\u660e\u7684\u8bdd\u653e\u6587\u7ae0\u7ed3\u5c3e\uff0c\u4e24\u79cd\u65b9\u5f0f\uff0c\u53ef\u4ee5\u6311\u9009\u4f60\u559c\u6b22\u7684\u770b\uff08\n\n\u4e8e\u662f\u5bf9\u4e8e\u4e00\u7ec4\u5212\u5206\uff0c\u5047\u8bbe\u6709 $k$ \u4e2a\u8054\u901a\u5757\uff0c\u5219\u5bf9\u4e8e\u7b54\u6848\u7684\u8d21\u732e\u4e3a $\\prod a_i\\times n^{k-2}$\uff0c\u5982\u679c\u8003\u8651 $f_{i,j,k}$ \u4e3a $i$ \u4e3a\u6839\u7684\u5b50\u6811\u5212\u5206\u4e86 $j$ \u4e2a\u8054\u901a\u5757\uff0c\u5f53\u524d\u70b9\u6240\u5728\u7684\u8054\u901a\u5757\u5927\u5c0f\u4e3a $k$ \u7684\u8d21\u732e\u548c\u662f\u53ef\u4ee5\u8f7b\u6613\u505a\u5230 $\\mathcal O(n^3)$ \u7684\u3002\n\n\u8003\u8651 $\\prod a$ \u7684\u7ec4\u5408\u610f\u4e49\uff0c\u6211\u4eec\u53ef\u4ee5\u89c6\u4e3a\u5c06\u6811\u5212\u5206\u4e3a\u82e5\u5e72\u4e2a\u8054\u901a\u5757\uff0c\u6bcf\u4e2a\u8054\u901a\u5757\u5185\u653e\u5165\u4e00\u4e2a\u7403\u7684\u65b9\u6848\u6570\uff0c\u8fd9\u6837\u901a\u8fc7\u6811\u4e0a\u80cc\u5305\u7684 trick \u76f4\u63a5 dp \u590d\u6742\u5ea6\u5c31\u662f $\\mathcal O(n^2)$ \u4e86\uff0c\u7136\u540e $\\mathcal O(n^2)$ \u7684\u4e8c\u9879\u5f0f\u53cd\u6f14\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u6838\u5fc3\u4ee3\u7801\uff1a\n\n```cpp\n\nvoid dfs( int x, int fa ) {\n\tdp[x][1][0] = 1, dp[x][1][1] = 1, sz[x] = 1 ; \n\tfor( int v : G[x] ) {\n\t\tif( v == fa ) continue ; dfs( v, x ) ;\n\t\tdrep( j, 1, sz[x] ) drep( k, 1, sz[v] ) {\n\t\t\tinc( bef[x][j + k][0], dp[x][j][0] * dp[v][k][1] % P ) ;\n\t\t\tinc( bef[x][j + k][1], dp[x][j][1] * dp[v][k][1] % P ) ; \n\t\t\tinc( bef[x][j + k - 1][0], dp[x][j][0] * dp[v][k][0] % P ) ;\n\t\t\tinc( bef[x][j + k - 1][1], ( dp[x][j][1] * dp[v][k][0] + dp[x][j][0] * dp[v][k][1] ) % P ) ; \n\t\t}\n\t\tsz[x] += sz[v] ; \n\t\trep( j, 1, sz[x] ) dp[x][j][0] = bef[x][j][0], dp[x][j][1] = bef[x][j][1], bef[x][j][0] = 0, bef[x][j][1] = 0 ; \n\t}\n}\n```\n\n\u8bc1\u660e\uff1a\n\n\n- $\\rm Matrix-Tree$ \u5b9a\u7406\u3002\n\n\u6211\u4eec\u5148\u5c06 S \u4e2d\u7684\u6240\u6709\u8054\u901a\u5757\u7f29\u8d77\u6765\uff0c\u8003\u8651\u6784\u5efa\u4e00\u5f20\u65b0\u56fe\uff0c\u6211\u4eec\u8fde\u63a5 $i\\to j$ \u7684\u65e0\u5411\u8fb9\uff0c\u4f46\u662f\u8fde\u63a5\u91cd\u8fb9\u6570\u91cf\u4e3a $a_i\\times a_j$\n\n\u90a3\u4e48\u6839\u636e\u77e9\u9635\u6811\u5b9a\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u5176 Kirchhoff \u77e9\u9635\u4e3a\uff1a\n\n$\\begin{bmatrix}a_1(\\sum a -a_{1})&...& 0\\\\0&a_2(\\sum a-a_{2})&...0\\\\0&...&0\\\\0&...&a_k(\\sum a-a_{k})\\end{bmatrix}-\\begin{bmatrix}0&...& a_{1}\\times a_{k}\\\\a_{2}\\times a_{1}&0&...a_{2}\\times a_{k}\\\\a_{k-1}\\times a_{1}&...&a_{k-1}\\times a_{k}\\\\a_{k}\\times a_{1}&...&0\\end{bmatrix}$\n\n\u5373\uff1a\n\n$$\\begin{bmatrix}a_1(n -a_{1})&...& ...&-a_1\\times a_k\\\\-a_2\\times a_1&a_2(n-a_{2})&...&a_2\\times a_k\\\\...&...&...&...\\\\-a_{k-1}\\times a_1&...&a_{k-1}\\times(n-a_{k-1})&-a_{k-1}\\times a_k\\\\-a_1\\times a_{k}&...&...&a_k(n-a_{k})\\end{bmatrix}$$\n\n\u7136\u540e\u6211\u4eec\u5220\u9664\u4e00\u884c\u4e00\u5217\u540e\u7684\u884c\u5217\u5f0f\u5373\u4e3a\u7b54\u6848\uff1a\n\n$$\\begin{bmatrix}a_1(n -a_{1})&...& ...\\\\-a_2\\times a_1&a_2(n-a_{2})&...\\\\...&...&...\\\\-a_{k-1}\\times a_1&...&a_{k-1}\\times(n-a_{k-1})\\end{bmatrix}$$\n\n\u6839\u636e\u884c\u5217\u5f0f\u7684\u6027\u8d28\uff0c\u6211\u4eec\u628a\u6bcf\u884c\u7684\u4e00\u4e2a\u516c\u5171\u7cfb\u6570 $a_i$ \u90fd\u63d0\u53d6\u51fa\u6765\u540e\u5f97\u5230\uff1a\n\n$$\\prod_{i=1}^{n-1}a_i\\begin{bmatrix}(n -a_{1})&...& ...\\\\-a_1&(n-a_{2})&...\\\\...&...&...\\\\-a_{1}&...&(n-a_{k-1})\\end{bmatrix}$$\n\n\u7136\u540e\u6211\u4eec\u5c06\u7b2c $2\\to n-1$ \u5217\u90fd\u52a0\u5230\u7b2c $1$ \u5217\u4e0a\u4f1a\u5f97\u5230\uff1a\uff08\u8fd9\u91cc\u7684 $n$ \u6307\u8054\u901a\u5757\u6570\u91cf\uff09\n\n$$\\begin{bmatrix}a_k&...& ...\\\\a_k&(n-a_{2})&...\\\\...&...&...\\\\a_k&...&(n-a_{k-1})\\end{bmatrix}$$\n\n\u7136\u540e\u6211\u4eec\u628a\u6bcf\u884c\u90fd\u51cf\u53bb\u7b2c\u4e00\u884c\u5f97\u5230\uff1a\n\n$$\\begin{bmatrix}a_k&...& ...\\\\0&n&...\\\\...&...&...\\\\0&...&n\\end{bmatrix}$$\n\n\u4e8e\u662f\u5176\u884c\u5217\u5f0f\u4e3a $n^{k-2}a_k$\uff0c\u6240\u4ee5\u7b54\u6848\u4e3a\uff1a$\\Big(\\prod a_i \\Big)n^{k-2}$\n\n- $\\rm prufer$ \u5e8f\u5217\u3002\n\n\u5c06\u6bcf\u4e2a\u8054\u901a\u5757\u89c6\u4e3a\u4e00\u4e2a\u5927\u8054\u901a\u5757\uff0c\u8bbe\u5176\u51fa\u73b0\u6b21\u6570\u4e3a $k$\uff0c\u5219\u5176\u5bf9\u4e8e\u7b54\u6848\u7684\u8d21\u732e\u4e3a $a_i^{k+1}$\n\n\u7531\u4e8e\u6bcf\u4e2a $\\rm prufer$ \u5e8f\u5217\u90fd\u662f\u5408\u6cd5\u7684\uff0c\u6211\u4eec\u7b49\u4ef7\u4e8e\u6c42\u6709 $k-2$ \u4e2a\u4f4d\u7f6e\uff0c\u6bcf\u4e2a\u6570\u51fa\u73b0\u6b21\u6570\u4e3a $i$ \u65f6\u5bf9\u4e8e\u7b54\u6848\u7684\u8d21\u732e\u4e3a $a_j^{i+1}$\uff0c\u6c42\u6240\u6709\u65b9\u6848\u7684\u6743\u503c\u3002\n\n\u6784\u5efa\u6bcf\u4e2a\u6570\u7684 EGF \u4e3a $F(a_i)$\uff0c\u6211\u4eec\u5f97\u5230\uff1a\n\n$$Ans=\\prod a_i \\bigg((k-2)![x^{k-2}]\\prod F(a_i)\\bigg)$$\n\n$$Ans=\\prod a_i\\bigg((k-2)![x^{k-2}]\\prod e^{a_ix}\\bigg)$$\n\n$$Ans=\\prod a_i\\frac{(k-2)!(\\sum a_i)^{k-2}}{(k-2)!}$$\n\n$$Ans=\\prod a_i \\times n^{k-2}$$",
        "postTime": 1590732112,
        "uid": 30036,
        "name": "Soulist",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF917D \u3010Stranger Trees\u3011"
    },
    {
        "content": "## \u9898\u610f\r\n\r\n\u7ed9\u5b9a $n$ \u4e2a\u8282\u70b9\u7684\u6811\uff0c\u8003\u8651\u4e0b\u5217\u95ee\u9898\uff1a\r\n\r\n> \u6c42\u6709\u591a\u5c11\u68f5\u4e0d\u540c\u7684\u6811\u6ee1\u8db3\uff1a\u4e0e\u7ed9\u5b9a\u6811\u91cd\u5408\u7684\u8fb9\u6070\u597d\u6709 $x$ \u6761\u3002  \r\n> \u4e24\u68f5\u6811\u4e0d\u540c\u5f53\u4e14\u4ec5\u5f53\u5b58\u5728\u8fb9 $(u,v)$ \u5728\u4e00\u68f5\u6811\u4e2d\u51fa\u73b0\u4e14\u4e0d\u5728\u53e6\u4e00\u68f5\u6811\u4e2d\u51fa\u73b0\u3002\r\n\r\n\u5bf9 $x=0,1,\\cdots,n-1$ \u5206\u522b\u6c42\u51fa\u4e0a\u8ff0\u95ee\u9898\u7684\u7b54\u6848\u3002\r\n\r\n**\u6570\u636e\u8303\u56f4**\uff1a$n \\le 100$\u3002\uff08\u53ef\u505a\u5230 $O(n^2)$ \u6216\u66f4\u4f4e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff09\r\n\r\n## \u9898\u89e3\r\n\r\n\u8bb0\u4e0a\u8ff0\u95ee\u9898\u7684\u7b54\u6848\u4e3a $f_x$\uff0c\u53d1\u73b0 $f$ \u5f88\u96be\u6c42\uff0c\u8003\u8651\u8f6c\u5316\u3002\r\n\r\n\u8003\u8651\u5bb9\u65a5\uff1a\u8bbe $g_x$ \u8868\u793a\u5305\u542b\u7ed9\u5b9a\u6811\u4e2d $x$ \u6761\u8fb9\u7684\u6811\u7684\u6570\u91cf\uff08\u4e0d\u8981\u6c42\u5176\u5b83 $n-1-x$ \u6761\u8fb9\u4e0d\u88ab\u5305\u542b\uff1b\u5bf9\u4e8e\u4e0d\u540c\u7684 $x$ \u6761\u8fb9\uff0c\u540c\u4e00\u68f5\u6811\u53ef\u80fd\u88ab\u8ba1\u7b97\u591a\u6b21\uff09\uff0c\u5219\u6709\uff1a\r\n\r\n$$f_x=\\sum_{i=x}^{n-1}(-1)^{i-x}\\binom{i}{x}g_i$$\r\n\r\n\uff08\u5373\u8fd0\u7528\u4e86**\u4e8c\u9879\u5f0f\u53cd\u6f14**\uff0c\u8bc1\u660e\u53ef\u53c2\u8003[xyyxyyx \u7684\u535a\u5ba2 - \u4e8c\u9879\u5f0f\u53cd\u6f14\u8bc1\u660e](https://blog.csdn.net/xyyxyyx/article/details/103523894)\uff0c\u4ea6\u53ef\u4eff\u7167[\u8fd9\u7bc7\u9898\u89e3](https://www.luogu.com.cn/blog/wsyhb/post-ti-xie-luo-gu-p3349-zjoi2016-xiao-xing-xing)\u4e2d\u5b50\u96c6\u53cd\u6f14\u8bc1\u660e\u7684\u90e8\u5206\uff0c\u5217\u51fa**\u521d\u59cb\u6052\u7b49\u5f0f**\u8fdb\u884c\u8bc1\u660e\uff09\r\n\r\n\u56e0\u6b64\u53ef\u4ee5\u5728 $O(n^2)$ \u7684\u65f6\u95f4\u91cc\u7528 $g$ \u6c42\u5f97 $f$\uff0c\u63a5\u4e0b\u6765\u8003\u8651\u5982\u4f55\u6c42 $g$\u3002\r\n\r\n------------\r\n\r\n\u6709\u4e00\u4e2a\u91cd\u8981\u7684\u7ed3\u8bba\uff1a\r\n\r\n> \u82e5 $n$ \u4e2a\u70b9\u7684\u65e0\u5411\u56fe\u4e2d\u6709 $k$ \u4e2a\u8fde\u901a\u5757\uff0c\u4e14\u5176\u4e2d\u7b2c $i$ \u4e2a\u8fde\u901a\u5757\u5927\u5c0f\u4e3a $s_i$\uff0c\u5219\u628a\u8fd9 $k$ \u4e2a\u8fde\u901a\u5757\u7528 $k-1$ \u6761\u8fb9\u8fde\u901a\u8d77\u6765\u7684\u65b9\u6848\u6570\u4e3a $\\prod{s_i} \\cdot n^{k-2}$\u3002\r\n\r\n\u53ef\u4ee5\u4f7f\u7528**\u65e0\u6839\u6811\u7684 Prufer \u5e8f\u5217**\u8bc1\u660e\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528**\u77e9\u9635\u6811\u5b9a\u7406**\u8bc1\u660e\u3002\r\n\r\n\u5177\u4f53\u53ef\u53c2\u8003[OI Wiki - \u56fe\u8fde\u901a\u65b9\u6848\u6570](https://oi-wiki.org/graph/prufer/#_3)\uff08Prufer \u5e8f\u5217+\u591a\u9879\u5f0f\u5b9a\u7406\uff09\u548c[Soulist \u7684\u9898\u89e3](https://www.luogu.com.cn/blog/Soulist/solution-cf917d)\uff08\u77e9\u9635\u6811\u5b9a\u7406 & Prufer \u5e8f\u5217+EGF\uff09\r\n\r\n------------\r\n\r\n\u5305\u542b\u7ed9\u5b9a\u6811\u4e2d $x$ \u6761\u8fb9\u7b49\u4ef7\u4e8e\u6709 $n-x$ \u4e2a\u8fde\u901a\u5757\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u5bf9\u6bcf\u4e2a $x$ \u8ba1\u7b97\u51fa\u6240\u6709\u60c5\u51b5\u7684 $\\prod{s_i}$ \u4e4b\u548c\uff0c\u5e76\u4e58\u4e0a $n^{n-x-2}$ \u5373\u53ef\u3002\r\n\r\n\u8003\u8651**\u6811\u5f62\u80cc\u5305 DP**\uff0c\u8bbe $f_{u,i,j}$ \u8868\u793a\uff1a\u8003\u8651\u4ee5 $u$ \u4e3a\u6839\u7684\u5b50\u6811\uff0c\u5c06\u5176\u5206\u6210 $i$ \u4e2a\u8fde\u901a\u5757\uff0c\u4e14 $u$ \u6240\u5728\u8fde\u901a\u5757\u5927\u5c0f\u4e3a $j$ \u7684\u6240\u6709\u60c5\u51b5\u7684 $\\prod{s_i}$ \u4e4b\u548c\uff08\u8fd8\u672a\u4e58\u4e0a $j$\uff09\u3002\u4e0d\u96be\u60f3\u5230\u8f6c\u79fb\uff1a\r\n\r\n$$f_{u,x,a} \\cdot f_{v,y,b} \\cdot b \\to f'_{u,x+y,a}$$\r\n\r\n$$f_{u,x,a} \\cdot f_{v,y,b} \\to f'_{u,x+y-1,a+b}$$\r\n\r\n\u5176\u4e2d $f'$ \u8868\u793a\u66f4\u65b0\u540e\u7684 $f$\uff0c$v$ \u662f $u$ \u7684\u513f\u5b50\u3002\uff08\u540e\u6587\u8868\u793a\u76f8\u540c\u542b\u4e49\uff09\r\n\r\n**\u8bf4\u660e**\uff1a\u7b2c\u4e00\u884c\u8868\u793a\u4e0d\u5408\u5e76\uff0c\u7b2c\u4e8c\u884c\u8868\u793a\u5c06 $v$ \u6240\u5728\u8fde\u901a\u5757\u4e0e $u$ \u6240\u5728\u8fde\u901a\u5757\u5408\u5e76\u3002\r\n\r\n\u6811\u4e0a\u80cc\u5305\u662f $O(n^2)$ \u7684\uff08\u56e0\u4e3a\u4efb\u610f\u4e24\u4e2a\u70b9\u53ea\u4f1a\u5728\u5b83\u4eec\u7684 LCA \u5904\u5408\u5e76\u6070\u597d\u4e00\u6b21\uff09\uff0c\u7b97\u4e0a\u989d\u5916\u7684\u4e00\u7ef4\u662f $O(n^3)$ \u7684\uff0c\u53ef\u4ee5\u7ee7\u7eed\u4f18\u5316\u3002\r\n\r\n------------\r\n\r\n\u6709\u4e00\u4e2a\u7ecf\u5178\u7684 Trick\uff1a**\u5404\u90e8\u5206\u6570\u91cf\u4e4b\u79ef\u7b49\u4e8e\u5728\u6bcf\u4e00\u90e8\u5206\u9009\u4e00\u4e2a\u5143\u7d20\u7684\u65b9\u6848\u6570**\u3002\r\n\r\n\u56e0\u6b64\u628a\u7b2c\u4e09\u7ef4\u6539\u4e3a\u662f\u5426\u5df2\u9009\u8fc7\uff1a\u8bbe $f_{u,i,k}$ \u8868\u793a\uff0c\u8003\u8651\u4ee5 $u$ \u4e3a\u6839\u7684\u5b50\u6811\uff0c\u5c06\u5176\u5206\u6210 $i$ \u4e2a\u8fde\u901a\u5757\uff0c\u4e14\u672a/\u5df2\u9009\u62e9\u597d $u$ \u6240\u5728\u8fde\u901a\u5757\u7684\u70b9\uff08$k=0/1$\uff09\u3002\u7c7b\u4f3c\u5730\u53ef\u5f97\u8f6c\u79fb\uff1a\r\n\r\n$$f_{u,x,0} \\cdot f_{v,y,1} \\to f'_{u,x+y,0}$$\r\n\r\n$$f_{u,x,1} \\cdot f_{v,y,1} \\to f'_{u,x+y,1}$$\r\n\r\n$$f_{u,x,0} \\cdot f_{v,y,0} \\to f'_{u,x+y-1,0}$$\r\n\r\n$$f_{u,x,1} \\cdot f_{v,y,0}+f_{u,x,0} \\cdot f_{v,y,1} \\to f'_{u,x+y-1,1}$$\r\n\r\n**\u8bf4\u660e**\uff1a\r\n\r\n- \u524d\u4e24\u884c\u8868\u793a\u4e0d\u5408\u5e76\u3002\r\n\t- $v$ \u6240\u5728\u8fde\u901a\u5757\u5fc5\u987b\u5df2\u9009\u70b9\u3002\r\n\t- $u$ \u6240\u5728\u8fde\u901a\u5757\u662f\u5426\u9009\u70b9\u4e0e $v$ \u65e0\u5173\u3002\r\n- \u540e\u4e24\u884c\u8868\u793a\u5c06 $v$ \u6240\u5728\u8fde\u901a\u5757\u4e0e $u$ \u6240\u5728\u8fde\u901a\u5757\u5408\u5e76\u3002\r\n\t- \u82e5\u5408\u5e76\u524d\u4e24\u4e2a\u8fde\u901a\u5757\u90fd\u672a\u9009\u70b9\uff0c\u5219\u5408\u5e76\u540e\u672a\u9009\u70b9\u3002\r\n\t- \u82e5\u5408\u5e76\u524d\u6070\u6709\u4e00\u4e2a\u8fde\u901a\u5757\u5df2\u9009\u70b9\uff0c\u5219\u5408\u5e76\u540e\u5df2\u9009\u70b9\u3002\r\n\t- \u6ce8\u610f\u4e24\u4e2a\u8fde\u901a\u5757\u4e0d\u80fd\u90fd\u9009\u70b9\u3002\r\n\r\n\u521d\u59cb\u65f6 $f_{u,1,0}=f_{u,1,1}=1$\u3002\r\n\r\n\u603b\u65f6\u7a7a\u590d\u6742\u5ea6\u4e3a $O(n^2)$\u3002\r\n\r\n## \u4ee3\u7801\r\n\r\n``` cpp\r\n#include<bits/stdc++.h>\r\nusing namespace std;\r\nconst int max_n=100+5;\r\nint End[max_n<<1],Last[max_n],Next[max_n<<1],e;\r\ninline void add_edge(int x,int y)\r\n{\r\n\tEnd[++e]=y,Next[e]=Last[x],Last[x]=e;\r\n\tEnd[++e]=x,Next[e]=Last[y],Last[y]=e;\r\n}\r\nconst int mod=1e9+7;\r\ninline int get_sum(int a,int b)\r\n{\r\n\treturn a+b-(a+b>=mod?mod:0);\r\n}\r\nint sz[max_n],dp[max_n][max_n][2],f[max_n][2];\r\nvoid dfs(int x,int fa)\r\n{\r\n\tdp[x][1][0]=dp[x][1][1]=1,sz[x]=1;\r\n\tfor(int i=Last[x];i;i=Next[i])\r\n\t{\r\n\t\tint y=End[i];\r\n\t\tif(y!=fa)\r\n\t\t{\r\n\t\t\tdfs(y,x);\r\n\t\t\tfor(int j=1;j<=sz[x];++j)\r\n\t\t\t\tfor(int k=1;k<=sz[y];++k)\r\n\t\t\t\t{\r\n\t\t\t\t\tf[j+k][0]=(f[j+k][0]+1ll*dp[x][j][0]*dp[y][k][1])%mod;\r\n\t\t\t\t\tf[j+k][1]=(f[j+k][1]+1ll*dp[x][j][1]*dp[y][k][1])%mod;\r\n\t\t\t\t\tf[j+k-1][0]=(f[j+k-1][0]+1ll*dp[x][j][0]*dp[y][k][0])%mod;\r\n\t\t\t\t\tf[j+k-1][1]=(f[j+k-1][1]+1ll*dp[x][j][1]*dp[y][k][0]+1ll*dp[x][j][0]*dp[y][k][1])%mod;\r\n\t\t\t\t}\r\n\t\t\tsz[x]+=sz[y];\r\n\t\t\tfor(int j=1;j<=sz[x];++j)\r\n\t\t\t\tfor(int k=0;k<=1;++k)\r\n\t\t\t\t{\r\n\t\t\t\t\tdp[x][j][k]=f[j][k];\r\n\t\t\t\t\tf[j][k]=0;\r\n\t\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\nint C[max_n][max_n],Pow[max_n];\r\ninline void init(int n)\r\n{\r\n\tfor(int i=0;i<=n;++i)\r\n\t{\r\n\t\tC[i][0]=1;\r\n\t\tfor(int j=1;j<=i;++j)\r\n\t\t\tC[i][j]=get_sum(C[i-1][j-1],C[i-1][j]);\r\n\t}\r\n\tPow[0]=1;\r\n\tfor(int i=1;i<=n;++i)\r\n\t\tPow[i]=1ll*Pow[i-1]*n%mod;\r\n}\r\nint F[max_n],G[max_n];\r\nint main()\r\n{\r\n\tint n;\r\n\tscanf(\"%d\",&n);\r\n\tfor(int i=1;i<=n-1;++i)\r\n\t{\r\n\t\tint u,v;\r\n\t\tscanf(\"%d%d\",&u,&v);\r\n\t\tadd_edge(u,v);\r\n\t}\r\n\tdfs(1,0);\r\n\tinit(n);\r\n\tfor(int i=0;i<=n-2;++i)\r\n\t\tG[i]=1ll*dp[1][n-i][1]*Pow[n-i-2]%mod;\r\n\tG[n-1]=1;\r\n\tfor(int i=0;i<=n-1;++i)\r\n\t{\r\n\t\tfor(int j=i;j<=n-1;++j)\r\n\t\t{\r\n\t\t\tif((j^i)&1) // (j-i)&1\r\n\t\t\t\tF[i]=(F[i]-1ll*C[j][i]*G[j])%mod;\r\n\t\t\telse\r\n\t\t\t\tF[i]=(F[i]+1ll*C[j][i]*G[j])%mod;\r\n\t\t}\r\n\t\tF[i]+=F[i]<0?mod:0;\r\n\t\tprintf(\"%d%c\",F[i],i<n-1?' ':'\\n');\r\n\t}\r\n\treturn 0;\r\n}\r\n```\r\n\r\n## \u5f69\u86cb\r\n\r\n**\u8fd9\u91cc\u662f\u672c\u9898\u89e3\u7684\u5199\u4f5c\u80cc\u666f\u3002**\uff08\u679c\u7136\u6709\u9898\u76ee\u80cc\u666f\u5c31\u4f1a\u6709\u9898\u89e3\u80cc\u666f\u5417\uff08\u96fe\uff09\uff09\r\n\r\n\u672c\u6587\u7684\u76ee\u7684\u4e4b\u4e00\uff1a~~\u796d\u5960~~\u7eaa\u5ff5\u81ea\u5df1\u5728\u6a21\u62df\u8d5b\u4e2d\u505a\u4e0d\u51fa\u6765\u539f\u9898\u3002\r\n\r\n~~\u540c\u65f6\u8c34\u8d23\u51fa\u9898\u4eba/\u7ec4\u9898\u4eba\u5728\u6a21\u62df\u8d5b\u4e2d\u653e\uff08\u6211\u4e0d\u4f1a\u5927\u5bb6\u90fd\u4f1a\u7684\uff09\u539f\u9898\uff01\uff01\uff01~~\r\n\r\n\u672c\u7bc7\u6587\u7ae0\u7684\u5b8c\u6210\u65f6\u95f4\u4e3a 2021.11.2\uff0c\u7ed3\u5408\u521b\u5efa\u65f6\u95f4\u53ef\u77e5\uff0c\u8fd9\u662f\u5f53\u65f6\u7559\u7684\u4e00\u4e2a\u5751\u3002\r\n\r\n\u5927\u7ea6\u56db\u4e2a\u6708\u524d\u7684\u6211\u5728\u9605\u8bfb\u4e86 Soulist \u7684\u9898\u89e3\u4ee5\u540e\u5927\u6709\u6536\u83b7\uff0c\u6253\u7b97\u5199\u4e00\u7bc7\u9898\u89e3\u3002\r\n\r\n\u53ef\u540e\u6765\u7531\u4e8e\u5404\u79cd\u5404\u6837\u7684\u539f\u56e0\u5495\u6389\u4e86\u2026\u2026\r\n\r\n\u4eca\u5929\u6a21\u62df\u8d5b\u6070\u597d\u8003\u5230\u4e86\u8fd9\u9053\u9898\uff08\u552f\u4e00\u7684\u533a\u522b\uff1a$n$ \u5f00\u5927\u5230\u4e86 $8000$\uff0c\u4e14\u7565\u5fae\u5361\u7a7a\u95f4\uff09\uff0c\u800c\u6211\u5b8c\u5168\u6ca1\u6709\u610f\u8bc6\u5230\u8fd9\u662f\u81ea\u5df1\u505a\u8fc7\u7684\u539f\u9898 /wul\u3002\r\n\r\n\u5c3d\u7ba1\u6211\u60f3\u5230\u4e86\u7528\u4e8c\u9879\u5f0f\u53cd\u6f14\u505a\u6070\u597d\u548c\u81f3\u5c11\u7684\u8f6c\u5316\uff0c\u60f3\u5230\u4e86\u7528 Prufer \u5e8f\u5217\u548c Matrix Tree \u5b9a\u7406\u63a8\u4e00\u63a8\u5f0f\u5b50\uff0c\u4e14\u9690\u9690\u7ea6\u7ea6\u89c9\u5f97\u4f1a\u6709\u4ec0\u4e48\u7ed3\u8bba\u3002\r\n\r\n\u6211\u6700\u7ec8\u6ca1\u80fd\u63a8\u51fa\u6765\u5f0f\u5b50\uff0c\u5e76\u4e14\u8fd8\u53d1\u73b0\u81ea\u5df1\u5bf9 Matrix Tree \u5b9a\u7406\u7684\u8bb0\u5fc6\u5341\u5206\u6a21\u7cca\uff0c\u4ee5\u81f3\u4e8e\u6839\u672c\u65e0\u6cd5\u5e94\u7528\u2026\u2026\r\n\r\n\u6700\u7ec8\u53ea\u597d\u6253\u4e86\u4e2a $O(n^{n-1})$ \u7684\u66b4\u529b\u8d70\u4eba\u2026\u2026\r\n\r\n\u7ecf\u540c\u5b66\u4e00\u63d0\u9192\uff0c\u7ffb\u51fa\u539f\u9898\u77ac\u95f4\u60f3\u8d77\u4e86\u4e00\u5207\u2026\u2026\r\n\r\n\u4e8e\u662f\u6211\u4eca\u5929\u4e00\u53e3\u6c14\u628a\u8fd9\u4e2a\u5751\u586b\u4e86\uff01",
        "postTime": 1625238456,
        "uid": 145355,
        "name": "wsyhb",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011CF917D Stranger Trees"
    },
    {
        "content": "# \u9898\u76ee\u5927\u610f\n\u4e00\u5f20\u6709 $ n $ \u4e2a\u8282\u70b9\u7684\u5b8c\u5168\u56fe\uff0c\u518d\u7ed9\u51fa\u8fd9\u5f20\u56fe\u7684\u4e00\u68f5\u751f\u6210\u6811\uff0c\u95ee\u8be5\u56fe\u6709\u591a\u5c11\u9897\u751f\u6210\u6811\u548c\u8fd9\u9897\u751f\u6210\u6811\u7684\u516c\u5171\u8fb9\u603b\u5171\u6709 $ k $ \u6761\uff0c\u6c42\u52a9 $ 0 \\leq k \\leq n-1 $ \u65f6\u6240\u6709 $ k $ \u7684\u7b54\u6848\u3002\n\n# \u505a\u6cd5\n\u9996\u5148\u6211\u4eec\u77e5\u9053\u77e9\u9635\u6811\u5b9a\u7406\u6c42\u7684\u662f \u6240\u6709\u751f\u6210\u6811\u7684\u8fb9\u6743\u4e4b\u79ef\u7684\u548c\u3002\n\n\u90a3\u4e48\u6211\u4eec\u8bbe\u6811\u8fb9\u7684\u8fb9\u6743\u4e3a $ x $\uff0c\u975e\u6811\u8fb9\u7684\u8fb9\u6743\u4e3a $ 1 $\uff0c\u82e5\u4e00\u68f5\u751f\u6210\u6811\u548c\u8be5\u6811\u6709 $ k $ \u6761\u516c\u5171\u8fb9\uff0c\u5219\u8be5\u751f\u6210\u6811\u7684\u8fb9\u6743\u4e4b\u79ef\u4e3a $ x^k $\u3002\n\n\u6c42\u548c\u4e4b\u540e\u7684 $ k $ \u6b21\u9879\u5c31\u662f\u7b54\u6848\u4e86\u3002\n\n\u4f46\u662f\u6bcf\u4e00\u6b21\u884c\u53d8\u6362\u6211\u4eec\u9700\u8981\u505a $ 1 $ \u6b21\u4e58\u6cd5\u548c $ n $ \u6b21\u51cf\u6cd5\uff0c\u590d\u6742\u5ea6\u867d\u7136\u662f $ O(n^4\\log n) $ \u7684\uff0c\u4f46\u662f\u5982\u6b64\u5927\u7684\u5e38\u6570\u5373\u4f7f\u662f CF \u7684\u673a\u5b50\u4e5f\u4f1a T\u3002\u3002\u3002\n\n\u6211\u4eec\u6362\u4e2a\u601d\u8def\uff0cFFT \u7684\u8fd0\u7b97\u8fc7\u7a0b\u5c31\u662f \u5e26\u5165+\u5dee\u503c\uff0c\u90a3\u6211\u4eec\u628a\u8fd9\u4e2a\u8fc7\u7a0b\u63d0\u5230\u5916\u9762\u6765\u505a\u4e0d\u5c31\u597d\u4e86\uff1f\n\n\u7b54\u6848\u4e00\u5b9a\u662f\u4e00\u4e2a $ n-1 $ \u6b21\u591a\u9879\u5f0f\uff0c\u6839\u636e\u4ee3\u6570\u57fa\u672c\u5b9a\u7406\uff0c\u6211\u4eec\u53ea\u9700\u8981 $ n $ \u4e2a\u70b9\u503c\u5c31\u80fd\u628a\u5b83\u63d2\u51fa\u6765\u3002\n\n\u6211\u4eec\u679a\u4e3e $ x $ \u4ece $ 1 $ \u5230 $ n $\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $ x $ \u8dd1\u4e00\u6b21\u77e9\u9635\u6811\uff0c\u590d\u6742\u5ea6 $ O(n^4) $\u3002\n\n\u6700\u540e\u6211\u4eec\u53ef\u4ee5 $ O(n) $ \u62c9\u683c\u6717\u65e5\u5dee\u503c\uff0c\u4e5f\u53ef\u4ee5 $ O(n^3) $ \u9ad8\u65af\u6d88\u5143\uff0c\u6211\u5199\u7684\u662f\u9ad8\u65af\u6d88\u5143\uff0c\u56e0\u4e3a\u6700\u8fd1\u5237\u77e9\u9635\u6811\u9010\u6e10\u719f\u6089\u4e86\u9ad8\u65af\u6d88\u5143\uff08\n\ncode:\n```cpp#include<cstdio>\nconst int M=105,mod=1e9+7;\nint n,u[M],v[M],x[M];\nint G[M][M],Matrix[M][M];\ninline int Add(const int&a,const int&b){\n    return a+b>=mod?a+b-mod:a+b;\n}\ninline int Del(const int&a,const int&b){\n    return a-b<0?a-b+mod:a-b;\n}\ninline int pow(int a,int b=mod-2){\n    int ans=1;\n    for(;b;b>>=1,a=1ll*a*a%mod)if(b&1)ans=1ll*ans*a%mod;\n    return ans;\n}\ninline int Matrix_Tree(){\n    register int i,j,k,d,inv,ans=1;\n    for(i=2;i<=n;++i){\n        inv=pow(Matrix[i][i]);\n        for(j=i+1;j<=n;++j){\n            d=1ll*Matrix[j][i]*inv%mod;\n            for(k=i;k<=n;++k)Matrix[j][k]=Del(Matrix[j][k],1ll*d*Matrix[i][k]%mod);\n        }\n        ans=1ll*ans*Matrix[i][i]%mod;\n    }\n    return ans;\n}\ninline void Gauss(){\n    register int i,j,k,d,inv;\n    for(i=1;i<=n;++i){\n        inv=pow(G[i][i]);\n        for(j=1;j<=n;++j){\n            if(i==j)continue;\n            d=1ll*G[j][i]*inv%mod;\n            for(k=i;k<=n+1;++k)G[j][k]=Del(G[j][k],1ll*d*G[i][k]%mod);\n        }\n    }\n}\nsigned main(){\n    register int i,j,k,X;\n    scanf(\"%d\",&n);\n    for(i=1;i<=n;++i){\n        for(j=1;j<=n;++j){\n            if(i==j)G[i][j]=n-1;\n            else G[i][j]=mod-1;\n        }\n    }\n    for(i=1;i<n;++i)scanf(\"%d%d\",u+i,v+i);\n    for(i=1;i<=n;++i){\n        for(j=1;j<=n;++j){\n            for(k=1;k<=n;++k){\n                Matrix[j][k]=G[j][k];\n            }\n        }\n        x[i]=i;G[i][n+1]=Matrix_Tree();\n        for(j=1;j<n;++j){\n            ++G[u[j]][u[j]];++G[v[j]][v[j]];\n            --G[u[j]][v[j]];--G[v[j]][u[j]];\n        }\n    }\n    for(i=1;i<=n;++i){\n        G[i][1]=1;X=x[i];\n        for(j=2;j<=n;++j){\n            G[i][j]=X;X=1ll*X*x[i]%mod;\n        }\n    }\n    Gauss();\n    for(i=1;i<=n;++i)printf(\"%d \",1ll*G[i][n+1]*pow(G[i][i])%mod);\n}\n```",
        "postTime": 1608393459,
        "uid": 160839,
        "name": "Prean",
        "ccfLevel": 7,
        "title": "\u6570\u8bba+\u7ebf\u6027\u4ee3\u6570 \u63d2\u503c+\u77e9\u9635\u6811 CF917D\u9898\u89e3"
    },
    {
        "content": "## \u3010\u9898\u89e3\u3011CF917D Stranger Trees(prufer\u5e8f\u5217+\u4e8c\u9879\u5f0f\u53cd\u6f14)\n\n\u8003\u8651\u6709\u4e00\u4e2a\u4e1c\u897f\u53eb\u505a$prufer$\u5e8f\u5217\uff0c\u7136\u540e\u4e2a\u4e1c\u897f\u53eb\u505a[\u56fe\u8054\u901a\u65b9\u6848\u6570](https://oi-wiki.org/graph/prufer/#_3)\u3002\n\n\u7136\u540e\u6211\u4eec\u8003\u8651\u5148\u7b97\u4e00\u4e0b**\u81f3\u5c11**$k$\u6761\u8fb9\u5728\u65b9\u6848\u91cc\u7684\u65b9\u6848\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u6811\u5f62dp\n\n$dp(i,j,k)$\u8868\u793a\u5bf9\u4e8e$i$\u8282\u70b9\u53ca\u5176\u5b50\u6811\uff0c\u5171\u6709$j$\u6761\u8fb9\u88ab\u9009\u4e2d\uff0c\u4e14\u548c$i$\u5171\u6709$k$\u4e2a\u70b9\u662f\u5728\u4e00\u4e2a\u8054\u901a\u5757\u91cc\u7684$\\prod siz[]$\u4e4b\u548c\u3002\u8f6c\u79fb\u5f88\u7b80\u5355\u5566\u3002(\u4f46\u662fCF\u7684\u5185\u5b58\u8bbf\u95ee\u6781\u6162\uff01\u8981\u7528\u5bf9\u5185\u5b58\u53cb\u597d\u7684\u5199\u6cd5)\n\n\u901a\u8fc7$dp()$\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u6c42\u51fa\u6765\u662f$f(k)$\u8868\u793a\u81f3\u5c11\u6709$k$\u6761\u8fb9\u5728\u65b9\u6848\u91cc\u7684\u65b9\u6848\u6570\u3002\n\n\u6211\u4eec\u8bbe$g(k)$\u4e3a\u7b54\u6848\uff0c\u90a3\u4e48\u8003\u8651$f(k)$\u548c$g(k)$\u7684\u5173\u7cfb\n\n\u503c\u5f97\u6ce8\u610f\u7684\u4e8b\u60c5\u662f\uff0c\u7531\u4e8e\u6211\u4eec\u662f\u5728\u6811\u4e0a\u9009\u62e9\u8fb9\uff0c\u6240\u4ee5\u6211\u4eec\u94a6\u5b9a\u9009\u62e9\u7684\u8fb9\u662f\u4e0d\u4f1a\u6210\u73af\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u4efb\u4f55\u4e00\u4e2a\u9009\u6811\u8fb9\u7684\u65b9\u6848\u90fd\u662f\u5408\u6cd5\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u6709\n$$\nf(k)=\\sum_{j\\ge k} {j\\choose k} g(j)\n$$\n\u6839\u636e\u4e8c\u9879\u5f0f\u53cd\u6f14\u76f4\u63a5\u5f97\u5230\n$$\ng(k)=\\sum_{j\\ge k}{j\\choose k}(-1)^{k-j}f(j)\n$$\n\n```cpp\n//@winlere\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<vector>\n#include<assert.h>\n\nusing namespace std;  typedef long long ll; \ninline int qr(){\n\tint ret=0,f=0,c=getchar();\n\twhile(!isdigit(c))f|=c==45,c=getchar();\n\twhile(isdigit(c)) ret=ret*10+c-48,c=getchar();\n\treturn f?-ret:ret;\n}\n\nconst int maxn=105;\nconst int mod=1e9+7;\nint dp[maxn][maxn][maxn],n,siz[maxn],ans[maxn];\nint invs[maxn*maxn],c[maxn][maxn];\nint inv[maxn][maxn*maxn];\nvector<int>e[maxn];\nvoid add(int fr,int to){e[fr].push_back(to);e[to].push_back(fr);}\nint MOD(const int&x){return x>=mod?x-mod:x;}\nint MOD(const int&x,const int&y){return 1ll*x*y%mod;}\nint MOD(const int&x,const int&y,const int&z,const int&b){return 1ll*x*y%mod*b%mod*z%mod;}\nint ksm(const int&ba,const int&p){\n\tint ret=1;\n\tfor(int t=p,b=ba;t;t>>=1,b=MOD(b,b))\n\t\tif(t&1) ret=MOD(ret,b);\n\treturn ret;\n}\n\nvoid pre(const int&n){\n\tinvs[1]=1;\n\tfor(int t=2;t<=n;++t) invs[t]=MOD(mod-mod/t,invs[mod%t]),assert(MOD(t,invs[t])==1);\n\tfor(int t=n+1;t<=n*n;++t) invs[t]=MOD(mod-mod/t,invs[mod%t]);\n\tfor(int t=1;t<=n*n;++t)\n\t\tfor(int i=1;i<=n;++i)\n\t\t\tinv[i][t]=MOD(i,invs[t]);\n\tfor(int t=0;t<=n;++t)\n\t\tfor(int i=c[t][0]=1;i<=t;++i)\n\t\t\tc[t][i]=MOD(c[t-1][i-1]+c[t-1][i]);\n\t//cerr<<\"c[5][2]=\"<<c[5][2]<<endl;\n}\n\nvoid dfs(const int&now,const int&last){\n\tdp[now][0][1]=1;\n\tsiz[now]=1;\n\tfor(auto t:e[now]){\n\t\tif(t^last){\n\t\t\tdfs(t,now);\n\t\t\tint g[maxn][maxn];\n\t\t\tmemset(g,0,sizeof g);\n\t\t\t/*\n\t\t\tfor(int i=siz[now]-1;~i;--i){// edge_totol\n\t\t\t\tfor(int j=0,edj=min(siz[t]-1,i);j<=edj;++j){// edge_target\n\t\t\t\t\tfor(int p=1,edp=siz[t];p<=edp;++p){// vertices_target\n\t\t\t\t\t\tif(dp[t][j][p]){\n\t\t\t\t\t\t\tfor(int k=siz[now];k;--k){// vertices_total\n\t\t\t\t\t\t\t\tint&s=g[i][k];\n\t\t\t\t\t\t\t\t//connect\n\t\t\t\t\t\t\t\tif(i-j-1>=0&&k>p) s=(s+1ll*dp[now][i-j-1][k-p]*dp[t][j][p]%mod*inv[k][(k-p)*p])%mod;\n\t\t\t\t\t\t\t\t//dont connect\n\t\t\t\t\t\t\t\tif(i>=j) s=(s+1ll*dp[now][i-j][k]*dp[t][j][p])%mod;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\u8fd9\u79cd\u5199\u6cd5\u5f88\u4e0d\u4f18\u79c0\uff0c\u5185\u5b58\u8bbf\u95ee\u975e\u5e38\u4e0d\u8fde\u7eed\uff01\n\t\t\t*/\n\t\t\tfor(int i=0;i<siz[now];++i)\n\t\t\t\tfor(int k=1;k<=siz[now];++k)\n\t\t\t\t\tfor(int j=0;j<siz[t];++j)\n\t\t\t\t\t\tfor(int p=1;p<=siz[t];++p){\n\t\t\t\t\t\t\tll l=1ll*dp[now][i][k]*dp[t][j][p]%mod;\n\t\t\t\t\t\t\tg[i+j+1][k+p]=(g[i+j+1][k+p]+l*inv[k+p][k*p])%mod;\n\t\t\t\t\t\t\tg[i+j][k]=MOD(g[i+j][k]+l);\n\t\t\t\t\t\t}\n\t\t\tsiz[now]+=siz[t];\n\t\t\tmemcpy(dp[now],g,sizeof g);\n\t\t}\n\t}\n}\n\nint rt,val=1e9;\nvoid dfsrt(int now,int last){\n\tsiz[now]=1;\n\tint k=0;\n\tfor(auto t:e[now])\n\t\tif(!siz[t])\n\t\t\tsiz[now]+=siz[t],k=max(k,siz[t]);\n\tk=max(k,n-siz[now]);\n\tif(k<val) rt=now;\n}\n\nint main(){\n\tn=qr();\n\tpre(101);\n\tfor(int t=1;t<n;++t) add(qr(),qr());\n\tint k=min(n,55);\n\tdfs(k,0);\n\tfor(int e=0;e<=n-1;++e){\n\t\tfor(int i=1;i<=e+1;++i)\n\t\t\tans[e]=MOD(ans[e]+dp[k][e][i]);\n\t\tif(e<=n-2) ans[e]=MOD(ksm(n,n-2-e),ans[e]);\n\t\tif(e==n-1) ans[e]=1;\n\t}\n\tfor(int t=0;t<=n-1;++t){\n\t\tint ret=0;\n\t\tfor(int i=t;i<=n-1;++i){\n\t\t\tint d=MOD(c[i][t],ans[i]);\n\t\t\tif((t^i)&1) ret=MOD(ret-d+mod);\n\t\t\telse ret=MOD(ret+d);\n\t\t}\n\t\tcout<<ret<<' ';\n\t}\n\tcerr<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1588946358,
        "uid": 113460,
        "name": "\u8c01\u662f\u9e3d\u738b",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF917D \u3010Stranger Trees\u3011"
    },
    {
        "content": "### \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a $n$ \u4e2a\u70b9\u7684\u6811\uff0c\u5bf9\u4e8e $0\\leq k\\leq n-1$ \u6c42 $K_{n}$ \u4e2d\u4e0e\u7ed9\u5b9a\u6811\u7684 $n$ \u6761\u8fb9\u91cd\u5408\u751f\u6210\u6811\u7684\u6570\u91cf\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\leq n\\leq 100$\u3002\n\n### \u9898\u89e3\n\n\u7b80\u5355\u9898\uff0c\u4f46 $O(n^2)$ \u505a\u6cd5\u5b9e\u5c5e\u725b\u903c\uff0c\u6211\u5199\u7684 $O(n^4)$\u3002\n\n\u5982\u679c\u505a\u8fc7 P5296 \u6216\u8005 P6624 \u7684\u770b\u4e00\u773c\u5c31\u77e5\u9053\u5c06\u662f\u7ed9\u5b9a\u6811\u4e0a\u7684\u8fb9\u7684\u90a3\u4e9b\u8fb9\u6743\u503c\u8bbe\u4e3a $x$\uff0c\u4e0d\u662f\u7684\u8bbe\u4e3a $1$\uff0c\u7136\u540e Matrix-Tree \u5373\u53ef\u3002\n\n\u4f46\u662f\u9ad8\u65af\u6d88\u5143\u662f $O(n^3)$\uff0c\u591a\u9879\u5f0f\u4e58\u6cd5 $O(n^2)$\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^5)$ \u8fc7\u4e0d\u53bb\uff0c\u4e8e\u662f\u9700\u8981\u4f18\u5316\u3002\n\n\u8003\u8651\u4e0d\u76f4\u63a5\u7528\u591a\u9879\u5f0f\u7b97\u800c\u662f\u5c06\u5177\u4f53\u7684 $x$ \u4ee3\u5165\u8fdb\u53bb\uff0c\u7136\u540e\u7531\u4e8e\u7b54\u6848\u662f\u591a\u9879\u5f0f\u6240\u4ee5\u6700\u540e\u63d2\u503c\u56de\u6765\uff0c\u8fd9\u4e2a\u65f6\u5019\u590d\u6742\u5ea6\u4e3a $O(n^4)$ \u5c31\u53ef\u4ee5\u8fc7\u9898\u4e86\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef int ll;\ntypedef long long int li;\nconst ll MAXN=151,MOD=1e9+7;\nll n,w,fd,rr;\nll x[MAXN],y[MAXN],mat[MAXN][MAXN],f[MAXN],g[MAXN],r[MAXN];\ninline ll read()\n{\n    register ll num=0,neg=1;\n    register char ch=getchar();\n    while(!isdigit(ch)&&ch!='-')\n    {\n        ch=getchar();\n    }\n    if(ch=='-')\n    {\n        neg=-1;\n        ch=getchar();\n    }\n    while(isdigit(ch))\n    {\n        num=(num<<3)+(num<<1)+(ch-'0');\n        ch=getchar();\n    }\n    return num*neg;\n}\ninline ll qpow(ll base,ll exponent)\n{\n    ll res=1;\n    while(exponent)\n    {\n        if(exponent&1)\n        {\n            res=(li)res*base%MOD;\n        }\n        base=(li)base*base%MOD,exponent>>=1;\n    }\n    return res;\n}\ninline void add(ll x,ll y,ll w)\n{\n\tmat[x][x]=(mat[x][x]+w)%MOD,mat[y][y]=(mat[y][y]+w)%MOD;\n\tmat[x][y]=(mat[x][y]-w+MOD)%MOD,mat[y][x]=(mat[y][x]-w+MOD)%MOD;\n}\ninline ll det()\n{\n\tll pivot,cof,res=1,sgn=1;\n\tfor(register int i=1;i<n;i++)\n\t{\n\t\tpivot=n;\n\t\tfor(register int j=i;j<n;j++)\n\t\t{\n\t\t\tif(mat[j][i])\n\t\t\t{\n\t\t\t\tpivot=i;\n\t\t\t\tbreak;\t\n\t\t\t}\n\t\t}\n\t\tif(pivot==n)\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\t\tpivot!=i?swap(mat[pivot],mat[i]),sgn*=-1:1;\n\t\tfor(register int j=i+1;j<n;j++)\n\t\t{\n\t\t\tcof=(li)mat[j][i]*qpow(mat[i][i],MOD-2)%MOD;\n\t\t\tfor(register int k=i;k<n;k++)\n\t\t\t{\n\t\t\t\tmat[j][k]=(mat[j][k]-(li)mat[i][k]*cof%MOD+MOD)%MOD;\n\t\t\t}\n\t\t}\n\t\tres=(li)res*mat[i][i]%MOD;\n\t}\n\treturn sgn==1?res:(MOD-res)%MOD;\n}\ninline ll calc(ll w)\n{\n\tmemset(mat,0,sizeof(mat));\n\tfor(register int i=1;i<=n;i++)\n\t{\n\t\tfor(register int j=i+1;j<=n;j++)\n\t\t{\n\t\t\tadd(i,j,1);\n\t\t}\n\t}\n\tfor(register int i=1;i<=n-1;i++)\n\t{\n\t\tadd(x[i],y[i],w-1);\n\t}\n\treturn det();\n}\ninline void mul(ll x)\n{\n\tg[fd+1]=0;\n\tfor(register int i=fd-1;i>=0;i--)\n\t{\n\t\tg[i+1]=(g[i+1]+g[i])%MOD,g[i]=(li)g[i]*(MOD-x)%MOD;\n\t}\n\tfd++;\n}\ninline void div(ll x)\n{\n\tll invl=qpow(x,MOD-2);\n\tfor(register int i=0;i<fd;i++)\n\t{\n\t\tg[i]=(MOD-(li)g[i]*invl%MOD)%MOD,g[i+1]=(g[i+1]-g[i]+MOD)%MOD;\n\t}\n\tfd--;\n}\nint main()\n{\n\tn=read(),g[0]=fd=1;\n\tfor(register int i=1;i<=n-1;i++)\n\t{\n\t\tx[i]=read(),y[i]=read();\n\t}\n\tfor(register int i=1;i<=n;i++)\n\t{\n\t\tr[i]=calc(i),mul(i);\n\t}\n\tfor(register int i=1;i<=n;i++)\n\t{\n\t\tdiv(i),rr=1;\n\t\tfor(register int j=1;j<=n;j++)\n\t\t{\n\t\t\tj!=i?rr=(li)rr*(i-j+MOD)%MOD:1;\n\t\t}\n\t\trr=(li)r[i]*qpow(rr,MOD-2)%MOD;\n\t\tfor(register int i=0;i<fd;i++)\n\t\t{\n\t\t\tf[i]=(f[i]+(li)rr*g[i])%MOD;\n\t\t}\n\t\tmul(i);\n\t}\n\tfor(register int i=0;i<n;i++)\n\t{\n\t\tprintf(\"%d \",f[i]);\n\t}\n}\n```",
        "postTime": 1615296866,
        "uid": 60990,
        "name": "Karry5307",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF917D \u3010Stranger Trees\u3011"
    },
    {
        "content": "[\u9898\u76ee](https://www.luogu.org/problemnew/show/CF917D)\n\n\u770b\u9898\u89e3\u7684\u65f6\u5019\u624d\u7a81\u7136\u53d1\u73b0$zky$\u8bb2\u8fc7\u8fd9\u9053\u9898\u554a\uff0c\u6211\u73b0\u5728\u6015\u4e0d\u662f\u4e00\u4e2a\u8001\u5e74\u4eba\u4e86\n\n\u4f17\u6240\u5468\u77e5\u77e9\u9635\u6811\u6c42\u5f97\u662f\u8fd9\u4e2a\n\n$$\\sum_{T}\\prod_{e\\in T}w_e$$\n\n\u800c\u6211\u4eec\u73b0\u5728\u7684\u8fd9\u4e2a\u95ee\u9898\u6709\u4e9b\u9b3c\u755c\u4e86\uff0c\u7ed9\u5b9a\u4e00\u68f5\u6811\uff0c\u6c42\u548c\u8fd9\u68f5\u6811\u6709$k$\u6761\u516c\u5171\u8fb9\u7684\u751f\u6210\u6811\u4e2a\u6570\n\n\u6211\u4eec\u5982\u4f55\u533a\u5206\u51fa\u548c\u539f\u751f\u6210\u6811\u6709\u51e0\u6761\u8fb9\u5462\uff0c\u5bb9\u65a5\u663e\u7136\u4e0d\u662f\u5f88\u53ef\u505a\uff0c\u4e8e\u662f\u4e4b\u540e\u5c31\u4e0d\u4f1a\u5566\n\n\u770b\u4e86\u9898\u89e3\u53d1\u73b0\u8fd9\u662f\u795e\u4ed9\u9898\uff0c\u5f15\u7528\u6f6e\u5b50\u540d\u8a00\u6211\u53ef\u80fd\u8fd9\u8f88\u5b50\u662f\u505a\u4e0d\u51fa\u6765\u4e86\n\n\u5bf9\u4e8e\u4e0d\u5728\u7ed9\u5b9a\u751f\u6210\u6811\u91cc\u7684\u8fb9$w_e$\u6211\u4eec\u8bbe$w_e=1$\uff0c\u5bf9\u4e8e\u5728\u751f\u6210\u6811\u91cc\u7684\u8fb9\u6211\u4eec\u5c06\u5176\u8bbe\u6210$w_e=x$\uff0c\u6ca1\u9519\u5c31\u662f$x$\uff0c\u5c31\u662f\u4e00\u4e2a\u591a\u9879\u5f0f\n\n\u8fd9\u6837\u77e9\u9635\u6811\u5f97\u5230\u7684\u7ed3\u679c\u5fc5\u7136\u4e5f\u662f\u4e00\u4e2a\u591a\u9879\u5f0f\uff0c\u5176\u4e2d$k$\u6b21\u9879\u7cfb\u6570\u5c31\u5bf9\u5e94\u4e86\u548c\u539f\u6811\u6709$k$\u6761\u516c\u5171\u8fb9\u7684\u65b9\u6848\u6570\n\n\u5982\u679c\u6a21\u6570\u662f$NTT$\u6a21\u6570\u90a3\u4e48\u6211\u4eec\u76f4\u63a5\u77e9\u9635\u6811\u5957\u591a\u9879\u5f0f\u5c31\u597d\u5566\uff0c\u4f46\u662f$O(n^4logn)$\u7684\u590d\u6742\u5ea6\u663e\u7136\u4e0d\u79d1\u5b66\u554a\n\n\u8003\u8651\u4e00\u4e9b\u5176\u4ed6\u6c42\u591a\u9879\u5f0f\u7cfb\u6570\u7684\u65b9\u6cd5\uff0c\u66b4\u529b\u4e00\u70b9\u4e5f\u884c\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u9ad8\u65af\u6d88\u5143\n\n\u8fd9\u4e2a\u591a\u9879\u5f0f\u662f\u4e00\u4e2a$n-1$\u7684\u591a\u9879\u5f0f\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u7ed9$x$\u627e$n$\u79cd\u53d6\u503c\uff0c\u4e4b\u540e\u5f97\u5230$n$\u4e2a\u65b9\u7a0b\uff0c\u4e4b\u540e\u9ad8\u65af\u6d88\u5143\u5c31\u53ef\u4ee5\u6c42\u51fa\u7cfb\u6570\u6765\u4e86\n\n\u4ee3\u7801\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\n#define re register\n#define LL long long\n#define max(a,b) ((a)>(b)?(a):(b))\n#define min(a,b) ((a)<(b)?(a):(b))\nconst int maxn=105;\nconst int mod=1e9+7;\ninline int read() {\n\tchar c=getchar();int x=0;while(c<'0'||c>'9') c=getchar();\n\twhile(c>='0'&&c<='9') x=(x<<3)+(x<<1)+c-48,c=getchar();return x;\n}\nint n,x[maxn],y[maxn],ans[maxn];\nint a[maxn][maxn],b[maxn][maxn];\ninline int ksm(int a,int b) {\n\tint S=1;\n\twhile(b) {if(b&1) S=(1ll*S*a)%mod;b>>=1;a=(1ll*a*a)%mod;}\n\treturn S;\n}\ninline void reBuild() {\n\tfor(re int i=1;i<=n;i++) a[i][i]=n-1;\n\tfor(re int i=1;i<=n;i++)\n\t\tfor(re int j=1;j<=n;j++) {\n\t\t\tif(i==j) continue;\n\t\t\ta[i][j]=mod-1;\n\t\t}\n}\ninline int solve(int t) {\n\treBuild();\n\tfor(re int i=1;i<n;i++) {\n\t\tint u=x[i],v=y[i];\n\t\ta[u][u]--,a[v][v]--;\n\t\ta[u][u]+=t,a[v][v]+=t;\n\t\ta[u][v]=a[v][u]=mod-t;\n\t}\n\tint o=0;\n\tfor(re int i=1;i<n;i++) {\n\t\tint p;\n\t\tfor(p=i;p<n;++p) if(a[p][i]) break;\n\t\tif(p!=i) std::swap(a[p],a[i]),o^=1;\n\t\tint Inv=ksm(a[i][i],mod-2);\n\t\tfor(re int j=i+1;j<n;j++) {\n\t\t\tint mul=(1ll*a[j][i]*Inv)%mod;\n\t\t\tfor(re int k=i;k<n;k++)\n\t\t\t\ta[j][k]=(a[j][k]-1ll*a[i][k]*mul%mod+mod)%mod;\n\t\t}\n\t}\n\tint now=1;\n\tfor(re int i=1;i<n;i++) now=(1ll*now*a[i][i])%mod;\n\treturn o?(mod-now)%mod:now;\n}\nint main() {\n\tn=read();\n\tfor(re int i=1;i<n;i++) x[i]=read(),y[i]=read();\n\tfor(re int i=0;i<n;i++) {\n\t\tb[i][n]=solve(i+1);\n\t\tb[i][0]=1;\n\t\tfor(re int j=1;j<n;j++) b[i][j]=ksm(i+1,j);\n\t}\n\tfor(re int i=0;i<n;i++) {\n\t\tint p;\n\t\tfor(p=i;p<n;++p) if(b[p][i]) break;\n\t\tif(p!=i) std::swap(b[p],b[i]);\n\t\tint Inv=ksm(b[i][i],mod-2);\n\t\tfor(re int j=n;j>=i;--j) b[i][j]=(1ll*b[i][j]*Inv)%mod;\n\t\tfor(re int j=i+1;j<n;j++)\n\t\t\tfor(re int k=n;k>=i;--k)\n\t\t\t\tb[j][k]=(b[j][k]-1ll*b[j][i]*b[i][k]%mod+mod)%mod;\n\t}\n\tans[n-1]=b[n-1][n];\n\tfor(re int i=n-2;i>=0;--i) {\n\t\tans[i]=b[i][n];\n\t\tfor(re int j=n-1;j>i;--j)\n\t\t\tans[i]=(ans[i]-1ll*ans[j]*b[i][j]%mod+mod)%mod;\n\t}\n\tfor(re int i=0;i<n;i++) printf(\"%d \",ans[i]);\n\treturn 0;\n}\n```\n",
        "postTime": 1555494266,
        "uid": 35178,
        "name": "asuldb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 \u3010CF917D\u3011Stranger Trees"
    },
    {
        "content": "\u5b66\u5230\u4e86\u2026\u2026\n\n\u8fd9\u91cc\u662f\u4e00\u4e2a\u4e0d\u4f1a $prufer$ \u5e8f\u5217\u7684\u83dc\u9e21\u3002\u88ab $\\texttt{S\\red{oulist}}$ \u770b\u4e0d\u8d77\u7684\u5783\u573e $\\Theta(n^4)$ \u7684\u505a\u6cd5\u3002\n\n## \u9898\u76ee\u5927\u610f:\n\n\u7ed9\u4e00\u68f5 $n$ \u4e2a\u70b9\u7684\u6811\uff0c\u6709\u591a\u5c11\u68f5\u7531\u8fd9 $n$ \u4e2a\u70b9\u4e4b\u95f4\u7684\u8fb9\u6784\u9020\u6210\u7684\u6811\uff0c\u4e0e\u7ed9\u5b9a\u7684\u6811\u6070\u597d\u6709 $k$ \u6761\u8fb9\u91cd\u590d\u3002\uff08\u5bf9\u4e8e\u4efb\u610f\u7684 $k \\in[1, n]$ \u8f93\u51fa\u7b54\u6848\uff09\n\n## \u751f\u6210\u6811\uff0c\u8ba1\u6570\uff0c\u4f18\u5148\u60f3\u5230\u7684\u662f\u77e9\u9635\u6811\u5b9a\u7406\u3002\n\n\u77e9\u9635\u6811\u5b9a\u7406\u662f\u5e72\u8fd9\u4e48\u4e00\u4ef6\u4e8b\u60c5\u3002\n\n$$\\sum_{w\\in T} \\prod w$$\n\n\u6211\u4eec\u53ef\u4ee5\u4ee4**\u6bcf\u6761\u88ab\u9009\u4e2d\u7684\u8fb9**\u7684\u8fb9\u6743\u4e3a $x^1$\u3002 **\u6ca1\u6709\u88ab\u9009\u4e2d\u7684\u8fb9** \u7684\u8fb9\u6743\u4e3a $x^0$\u3002\n\n\u7136\u540e\u5bf9\u5e94\u7684 $x^k$ \u7cfb\u6570\u5c31\u662f $k$ \u6761\u8fb9\u91cd\u590d\u7684\u7b54\u6848\uff0c\u53ef\u4ee5\u81ea\u5df1\u73a9\u4e00\u4e0b\uff08\n\n\u8fd9\u4e2a\u73a9\u610f\u6211\u4eec\u5176\u5b9e\u53ef\u4ee5\u76f4\u63a5\u66b4\u529b dft\uff0c\u4f46\u662f\u8fc7\u4e0d\u53bb\uff08\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u4e00\u4ef6\u4e8b\u60c5\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u7528\u77e9\u9635\u6811\u5b9a\u7406\u7b97\u51fa\u6765\u628a\u5404\u79cd $k \\in [1,n]$ \u7684\u503c\u7b97\u51fa\u6765\uff1f\u4e0d\u5c31\u53ef\u4ee5\u9ad8\u65af\u6d88\u5143\u4e86\u5417\u3002\n\n\u4ee4 $p_i$ \u4e3a\u7b54\u6848\uff0c$b_i$ \u4e3a\u628a $i$ \u5e26\u8fdb\u53bb\u7684\u503c\u3002\n\n$$b_j = \\sum_{i=0}^n p_i \\times i^j$$\n\n\u9ad8\u65af\u6d88\u5143\u5927\u6982\u662f\u8fd9\u6837\u4e00\u4e2a\u4e8b\u60c5\u3002\n\n\u5047\u8bbe\u4f60\u6709 $n$ \u4e2a\u672a\u77e5\u6570\u4e3a $p_1, ... , p_n$\u3002\u5df2\u77e5\u6570\u4e3a $g\\{\\}, b\\{\\}$\n\n($b_i$ \u5df2\u7ecf\u8ba1\u7b97\u8fc7\u4e86\uff0c$g_{i,j} = i ^{j-1}$)\n\n\u901a\u8fc7\u521d\u4e2d\u77e5\u8bc6\u4f60\u77e5\u9053\u3002\uff08\n\n$n$ \u5143\u4e00\u6b21\u662f\u53ef\u4ee5\u7528 $n$ \u4e2a\u5f0f\u5b50\u89e3\u51fa\u6765\u7684\u3002\n\n$$\\large\\lceil g_{1,1} \\times p_1 + ... + g_{1, n} \\times p_n = b_1\\rceil$$\n$$\\large| g_{2,1} \\times p_1 + ... + g_{2, n} \\times p_n = b_2|$$\n$$......$$\n$$\\large\\lfloor g_{n,1} \\times p_1 + ... + g_{n, n} \\times p_n = b_n\\rfloor$$\n\n\u628a\u8fd9\u4e2a\u90e8\u5206\u9ad8\u65af\u6d88\u5143\u677f\u5b50\u641e\u641e\u5c31\u505a\u5b8c\u4e86\u3002",
        "postTime": 1595401528,
        "uid": 96580,
        "name": "SXNhdW5veWE",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF917D \u3010Stranger Trees\u3011"
    },
    {
        "content": "soulist\u8bf4\u6709\u663e\u7136\u7684 $O(n^3)$ \u505a\u6cd5\uff0c\u4f46\u9898\u89e3\u533a\u6ca1\u4eba\u5199\u4e8e\u662f\u8fd9\u91cc\u6765\u8865\u5145\u4e00\u4e0b\u3002\n\n\n------------\n\n\u9898\u610f\uff1a\u7ed9\u5b9a\u4e00\u68f5 $n$ \u4e2a\u70b9\u7684\u6811\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $k = 0,1\\cdots n-1$ \u6c42\u51fa\u6709\u591a\u5c11\u68f5\u6811\u4e0e\u7ed9\u5b9a\u6811\u6709 $k$ \u6761\u8fb9\u91cd\u590d\u3002\n\n\n\n\u9898\u89e3\uff1a\n\n\u53e6 $dp_{u, i, j}$ \u8868\u793a $u$ \u4e0e $u$ \u76f8\u8fde\u7684\u8fde\u901a\u5757\u5927\u5c0f\u4e3a $i$\uff0c $u$\u7684\u5b50\u6811\u5185\u6709 $j$ \u6761\u91cd\u590d\u7684\u8fb9 \u7684\u6743\u503c\u548c\uff0c\u66b4\u529b\u8f6c\u79fb\u5373\u53ef\uff0c\u5173\u4e8e $O(n^4)$ \u505a\u6cd5\u4e0d\u518d\u8d58\u8ff0\u3002\n\n\u53e6 $f_{u,i}(x) = \\sum_{j=0} dp_{u,i,j}$\uff0c\u53ef\u4ee5\u53d1\u73b0\u8f6c\u79fb\u662f\u591a\u9879\u5f0f\u95f4\u7684\u52a0\u6cd5\u6216\u4e58\u6cd5\u3002\n\n\u56e0\u6b64\u76f4\u63a5\u5bf9 \u7b54\u6848\u7684\u591a\u9879\u5f0f\u5dee\u503c\u5373\u53ef\uff0c\u6bcf\u6b21\u5c06 $x$ \u4ee3\u5165\u4e3a $0,1,\\cdots n$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2)$\uff0c\u4ee3\u5165 $n$ \u6b21\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3)$\u3002\n\n\n\n------------\n\n\u4ee3\u7801\uff1a\n\n```cpp\n/*mjytxdy!*/\n#include <bits/stdc++.h>\n#define rep(i, a, b) for(int i = (a); i <= int(b); i ++)\n#define per(i, a, b) for(int i = (a); i >= int(b); i --)\n#define fi first\n#define se second\n#define all(s) s.begin(),s.end()\n#define trv(i, u, v) for(int i = head[u], v = e[i].to; i; v = e[i = e[i].next].to)\n#define sz(s) (int)(s.size())\n#define lb(s) ((s) & (-s))\n#define mk(s, t) make_pair(s, t)\nusing namespace std;\n\ntypedef long long ll;\ntypedef pair<int,int> P;\n\ntemplate <typename T> bool chkmx(T &x, T y){return x < y ? x = y, true : false;}\ntemplate <typename T> bool chkmn(T &x, T y){return x > y ? x = y, true : false;}\nconst int maxn = 100;\nconst int mod = 1e9 + 7;\nint n, nn, invnn, u, v, k, size[maxn + 5], inv[maxn + 5], fac[maxn + 5], ifac[maxn + 5];\nint dp[maxn + 5][maxn + 5], tmp[maxn + 5], val[maxn + 5], f[maxn + 5], g[maxn + 5];\nint all[maxn + 5], nw[maxn + 5], sum[maxn + 5];\nvector<int> e[maxn + 5];\ninline int add(int a, int b) {return (a += b) >= mod ? a - mod : a;}\ninline int sub(int a, int b) {return (a -= b) < 0 ? a + mod : a;}\ninline int mul(int a, int b) {return 1ll * a * b % mod;}\ninline int fpw(int a, int b, int ans = 1) {\n\tfor(; b; b >>= 1, a = mul(a, a)) if(b & 1) ans = mul(ans, a);\n\treturn ans;\n}\nvoid dfs(int u, int par) {\n\tdp[u][0] = 0, dp[u][1] = invnn, size[u] = 1;\n\tfor(auto v : e[u]) if(v != par) {\n\t\tdfs(v, u);\n\t\trep(i, 0, size[u] + size[v]) tmp[i] = dp[u][i], dp[u][i] = 0;\n\t\trep(i, 0, size[u]) rep(j, 0, size[v]) dp[u][i + j] = add(dp[u][i + j], mul(nn, mul(tmp[i], dp[v][j])));\n\t\tsize[u] += size[v];\n\t} \n\trep(i, 0, size[u]) tmp[i] = dp[u][i];\n\trep(i, 0, size[u]) dp[u][i] = mul(k, dp[u][i]);\n\trep(i, 1, size[u]) dp[u][0] = add(dp[u][0], mul(tmp[i], mul(i, n)));\n}\nvoid init() {\n\tnn = mul(n, n), invnn = fpw(nn, mod - 2);\n\tall[0] = 1;\n\trep(i, 1, n) {\n\t\tper(j, n, 1) all[j] = sub(all[j - 1], mul(i, all[j]));\n\t\tall[0] = mul(all[0], mod - i);\n\t}\n\tinv[0] = inv[1] = fac[0] = fac[1] = ifac[0] = ifac[1] = 1;\n\trep(i, 2, maxn) inv[i] = mul(mod - mod / i, inv[mod % i]);\n\trep(i, 2, maxn) fac[i] = mul(fac[i - 1], i);\n\trep(i, 2, maxn) ifac[i] = mul(ifac[i - 1], inv[i]);\n\trep(i, 1, n) val[i] = fpw(2, i * (i - 1) / 2 - i + 1);\n}\ninline int c(int n, int m) {return mul(mul(fac[n], ifac[m]), ifac[n - m]);}\nint main() {\n\t//freopen(\"in.txt\", \"r\", stdin);\n\tcin >> n, init();\n\trep(i, 2, n) cin >> u >> v, e[u].push_back(v), e[v].push_back(u);\n\trep(i, 1, n) {\n\t\tk = i, dfs(1, 1);\n\t\tint res = 1;\n\t\trep(j, 1, n) if(j != i) res = mul(res, sub(i, j));\n\t\tnw[0] = mul(all[0],  mod - inv[i]);\n\t\trep(j, 1, n) nw[j] = mul(sub(nw[j - 1], all[j]), inv[i]);\n\t\tres = mul(dp[1][0], fpw(res, mod - 2));\n\t\trep(j, 0, n) sum[j] = add(sum[j], mul(nw[j], res));\n\t}\n\trep(i, 0, n - 1) f[i] = sum[i];\n\trep(i, 0, n - 1) {\n\t\tint d = 1;\n\t\trep(j, i, n - 1) g[i] = add(g[i], mul(d, mul(c(j, i), f[j]))), d = mod - d;\n\t\tcout << g[i] << ' ';\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1631609602,
        "uid": 55650,
        "name": "flowerletter",
        "ccfLevel": 9,
        "title": "CF917D Stranger Trees"
    },
    {
        "content": "#### \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a $n$ \u4e2a\u7ed3\u70b9\u7684\u6709\u6807\u53f7\u6811\uff0c\u5171 $k$ \u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u53ef\u4ee5\u5c06\u6811\u4e0a\u4e00\u6761\u8fb9\u5220\u53bb\u518d\u52a0\u4e0a\u4e00\u6761\uff0c\u4f7f\u5f97\u4ed6\u4ecd\u7136\u662f\u4e00\u68f5\u6811\u3002\n\n\u95ee $k$ \u6b21\u64cd\u4f5c\u7ed3\u675f\u540e\u6709\u591a\u5c11\u4e2a\u672c\u8d28\u4e0d\u540c\u7684\u6811\u3002\n\n$n\\leq 50,1\\leq k\\leq n$ \u3002\n\n#### \u9898\u89e3\n\n\u867d\u7136\u573a\u4e0a\u8fc7\u4e86\uff0c\u4f46\u662f\u6709\u66f4\u4f18\u79c0\u7684\u505a\u6cd5\uff08\n\n\u5148\u628a\u95ee\u9898\u7b80\u5316\u4e00\u4e0b\uff0c\u8003\u8651\u5f53\u524d\u6811\u4e3a $T$ \uff0c\u6211\u4eec $k$ \u6b21\u64cd\u4f5c\u4ee5\u540e\u7684\u6811\u4e3a $T'$ \uff0c\u53ea\u8981 $T$ \u4e0e $T'$ \u7684\u91cd\u8fb9\u4e2a\u6570 $\\leq k$ \u4e2a\u5c31\u4e3a\u4e00\u79cd\u65b9\u6848\u3002\n\n\u8bbe $f(i)$ \u8868\u793a\u8054\u901a\u5757\u6070\u597d\u4e3a $i$ \u4e2a\u7684\u65b9\u6848\u3002\n\n~~\u663e\u7136\u6211\u6ca1\u60f3\u5230~~\u5bf9\u56fe\u8dd1\u77e9\u9635\u6811\u5b9a\u7406\uff0c\u6bcf\u4e2a\u4f4d\u7f6e\u4e3a $1/x$ \uff0c\u6700\u540e $f(i)$ \u5c31\u4e3a $[x^{n-i}]$ \u3002\n\n\u66b4\u529b\u7684\u590d\u6742\u5ea6\u4e3a $\\mathcal O(n^5)/O(n^3\\log n)$ \uff0c\u4f46\u53ef\u4ee5\u63d2 $n$ \u4e2a\u503c\u6700\u540e\u8fd8\u539f\u6b64\u591a\u9879\u5f0f\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^4)$ \u3002 \n\n\u4e00\u4e2a\u8f83\u4e3a\u660e\u663e\u7684\u505a\u6cd5\u4e3a\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u91cd\u8fb9\u662f\u54ea\u51e0\u6761\u5982\u4f55\u8ba1\u7b97\u7b54\u6848\uff0c\u4e00\u4e2a\u7ecf\u5178\u7ed3\u8bba\u662f\u5982\u679c\u5f53\u524d\u8054\u901a\u5757\u4e2a\u6570\u4e3a $x_1,x_2,...,x_r$ \uff0c\u90a3\u4e48\u5c06\u8be5\u8054\u901a\u5757\u8fde\u6210\u6811\u7684\u65b9\u6848\u6570\u4e3a $\\prod_{i=1}^{r} x_i n^{r_2}$ \u3002\u90a3\u4e48\u6211\u4eec\u76f4\u63a5\u4e0a\u8be5\u65b9\u6848\u6570\u4f1a\u5ffd\u7565\u5230\u65b0\u52a0\u8fdb\u6765\u7684\u8fb9\u662f\u91cd\u8fb9\u7684\u60c5\u51b5\uff0c\u90a3\u4e48\u5bb9\u65a5\u8ba1\u7b97\u3002\n\n\u5f62\u5f0f\u5316\u7684\u8bb2\uff0c\u8bbe $g(i)$ \u8868\u793a\u94a6\u5b9a\u8054\u901a\u5757\u4e2a\u6570\u6709 $i$ \u4e2a\u7684\u65b9\u6848\uff0c\u90a3\u4e48\n$$\nf(i)=\\sum_{j=1}^i (-1)^{i-j} g(j)\\dbinom{n-j}{i-j}\n$$\n\u800c \n$$\ng(i)=\\sum n^{i-2} \\prod_{\\sum^ix =n} x_i\n$$\n\u663e\u7136 $g(i)$ \u53ef\u4ee5\u901a\u8fc7\u6811\u5f62 $dp$ \u89e3\u51b3\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n^4)$ \u3002\n\n\u66f4\u4f18\u79c0\u7684\u505a\u6cd5\u662f\u8003\u8651 $\\prod_{i} x_i$ \u7684\u7ec4\u5408\u610f\u4e49\uff0c\u76f8\u5f53\u4e8e\u5728\u6bcf\u4e2a\u8054\u901a\u5757\u5185\u9009\u62e9\u4e00\u4e2a\u7279\u6b8a\u70b9\uff0c\u95ee\u6700\u540e\u65b9\u6848\u6570\u3002\n\n\u90a3\u4e48\u8bbe $f_{i,j,0/1}$ \u8868\u793a\u5728\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u9009\u62e9 $j$ \u4e2a\u8054\u901a\u5757\uff0c\u5176\u4e2d\u5305\u542b $i$ \u7684\u8054\u901a\u5757\u662f\u5426\u6709\u7279\u6b8a\u70b9\u88ab\u9009\u62e9\u3002\n\n\u8f6c\u79fb\u65f6\u8003\u8651\u5b50\u6811\u5408\u5e76 $(u,v)$ \u7684\u8054\u901a\u5757\u662f\u5426\u6709\u7279\u6b8a\u70b9\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n^2)$ \u3002\n\n```cpp\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<climits>\n#include<algorithm>\n#include<queue>\n#include<vector>\n#define int long long\n#define mod 1000000007\n#define pii pair<int,int>\n#define mp make_pair\n#define pb push_back\n#define fi first\n#define se second\nusing namespace std;\ninline int read(){\n\tint f=1,ans=0; char c=getchar();\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9'){ans=ans*10+c-'0';c=getchar();}\n\treturn f*ans;\n}\nconst int MAXN=111;\nint binom[MAXN][MAXN],N,K,U[MAXN],V[MAXN],pw[MAXN],Invn,inv[MAXN]; vector<int> vec[MAXN];\nint ksm(int a,int b){int ans=1;while(b){if(b&1) ans*=a,ans%=mod;a*=a,a%=mod;b>>=1;}return ans;}\nnamespace Force{\n\tint Ans[MAXN],F[MAXN];\n\tstruct Union{\n\t\tint siz[MAXN],f[MAXN];\n\t\tvoid init(){for(int i=1;i<=N;i++) f[i]=i,siz[i]=1;return;}\n\t\tint find(int x){return f[x]==x?x:f[x]=find(f[x]);}\n\t\tvoid merge(int x,int y){int t1=find(x),t2=find(y);f[t2]=t1,siz[t1]+=siz[t2];return;}\n\t}UU;\n\tbool G[MAXN];\n\tvoid calc(){\n\t\tUU.init(); for(int i=1;i<=N-1;i++) if(G[i]) UU.merge(U[i],V[i]); \n\t\tint mul=1,cnt=0;\n\t\tfor(int i=1;i<=N;i++) if(UU.find(i)==i) mul*=UU.siz[i],mul%=mod,mul*=N,mul%=mod,++cnt;\n\t\tint res=mul*Invn%mod*Invn%mod;\n\t\tAns[cnt]+=res,Ans[cnt]%=mod;\n\t}\n\tvoid dfs(int u){\n\t\tif(u==N){\n\t\t\tcalc(); return;\n\t\t}\n\t\tG[u]=1; dfs(u+1);\n\t\tG[u]=0; dfs(u+1);\n\t\treturn;\n\t}\n\tvoid Main(){\n\t\tdfs(1);\n\t\tfor(int i=1;i<=N;i++){\n\t\t\tfor(int j=1;j<=i;j++){\n\t\t\t\tint opt=((i-j)&1?mod-1:1);\n\t\t\t\tF[i]+=opt*Ans[j]*binom[N-j][i-j]%mod; F[i]%=mod;\n\t\t\t}\n\t\t}\n\t\tint res=0;\n\t\tfor(int i=1;i<=K+1;i++) res+=F[i],res%=mod;\n\t\tprintf(\"%lld\\n\",res); exit(0);\n\t}\n}\nnamespace std{\n\tint f[MAXN][MAXN][MAXN][2],siz[MAXN],g[MAXN][MAXN][2];\n\tint Ans[MAXN],F[MAXN];\n\tvoid dfs(int u,int fath){\n\t\tsiz[u]=1,f[u][0][1][0]=1;\n\t\tfor(auto v:vec[u]) if(v!=fath){\n\t\t\tdfs(v,u);\n\t\t\tmemset(g,0,sizeof(g));\n\t\t\tfor(int i=0;i<=siz[u];i++) for(int j=0;j<=siz[u];j++){\n\t\t\t\tfor(int I=0;I<=siz[v];I++) for(int J=0;J<=siz[v];J++){\n\t\t\t\t\tg[i+I][j][0]+=f[u][i][j][0]*f[v][I][J][1]; g[i+I][j][0]%=mod;\n\t\t\t\t\tg[i+I][j+J][0]+=f[u][i][j][0]*f[v][I][J][0]; g[i+I][j+J][0]%=mod;\n\t\t\t\t}\n\t\t\t}\n\t\t\tsiz[u]+=siz[v];\n\t\t\tfor(int i=0;i<=siz[u];i++) for(int j=0;j<=siz[u];j++) f[u][i][j][0]=g[i][j][0];\n\t\t}\n\t\tfor(int i=siz[u];i>=1;i--) for(int j=1;j<=siz[u];j++) f[u][i][j][1]=f[u][i-1][j][0]*j%mod*N%mod;\n\t\treturn;\n\t}\n\tvoid Main(){\n\t\tdfs(1,0);\n\t\tfor(int i=1;i<=N;i++) for(int j=1;j<=N;j++) Ans[i]+=f[1][i][j][1],Ans[i]%=mod;\n\t\tfor(int i=1;i<=N;i++) Ans[i]=Ans[i]*Invn%mod*Invn%mod;\n\t\tfor(int i=1;i<=N;i++){\n\t\t\tfor(int j=1;j<=i;j++){\n\t\t\t\tint opt=((i-j)&1?mod-1:1);\n\t\t\t\tF[i]+=opt*Ans[j]%mod*binom[N-j][i-j]%mod; F[i]%=mod;\n\t\t\t}\n\t\t}\n\t\tfor(int i=N;i>=1;i--) printf(\"%lld \",F[i]);printf(\"\\n\");\n\t\texit(0);\n\t}\n}\nnamespace faster{\n\tint f[MAXN][MAXN][2],g[MAXN][2],siz[MAXN],Ans[MAXN],F[MAXN];\n\tvoid dfs(int u,int fath){\n\t\tf[u][1][0]=1,f[u][1][1]=N; siz[u]=1;\n\t\tfor(auto v:vec[u]) if(v!=fath){\n\t\t\tdfs(v,u); memset(g,0,sizeof(g));\n\t\t\tfor(int i=0;i<=siz[u];i++) for(int j=0;j<=siz[v];j++){\n\t\t\t\tif(i+j) g[i+j-1][0]+=f[u][i][0]*f[v][j][0],g[i+j-1][0]%=mod;\n\t\t\t\tg[i+j][0]+=f[u][i][0]*f[v][j][1]; g[i+j][0]%=mod;\n\t\t\t\tif(i+j) g[i+j-1][1]+=f[u][i][0]*f[v][j][1],g[i+j-1][1]%=mod;\n\t\t\t\tif(i+j) g[i+j-1][1]+=f[u][i][1]*f[v][j][0],g[i+j-1][1]%=mod;\n\t\t\t\tg[i+j][1]+=f[u][i][1]*f[v][j][1],g[i+j][1]%=mod;\n\t\t\t}\n\t\t\tsiz[u]+=siz[v];\n\t\t\tfor(int i=0;i<=siz[u];i++) f[u][i][0]=g[i][0],f[u][i][1]=g[i][1];\n\t\t}return;\n\t}\n\tvoid Main(){\n\t\tdfs(1,0);\n\t\tfor(int i=1;i<=N;i++) Ans[i]=f[1][i][1],Ans[i]%=mod;\n\t\tfor(int i=1;i<=N;i++) Ans[i]=Ans[i]*Invn%mod*Invn%mod;\n\t\tfor(int i=1;i<=N;i++){\n\t\t\tfor(int j=1;j<=i;j++){\n\t\t\t\tint opt=((i-j)&1?mod-1:1);\n\t\t\t\tF[i]+=opt*Ans[j]%mod*binom[N-j][i-j]%mod; F[i]%=mod;\n\t\t\t}\n\t\t}\n\t\tfor(int i=N;i>=1;i--) printf(\"%lld \",F[i]);printf(\"\\n\");\n\t\texit(0);\n\t}\n}\nsigned main(){\n\t//freopen(\"1.in\",\"r\",stdin);\n\t//freopen(\"kaisou.out\",\"w\",stdout);\n\tbinom[0][0]=1; N=read(); for(int i=1;i<N;i++){U[i]=read(),V[i]=read();vec[U[i]].pb(V[i]),vec[V[i]].pb(U[i]);}\n\tInvn=ksm(N,mod-2);\n\tinv[1]=1; for(int i=2;i<=N;i++) inv[i]=(mod-mod/i)*inv[mod%i]%mod;\n\tpw[0]=1; for(int i=1;i<=N;i++) pw[i]=pw[i-1]*N%mod;\n\tfor(int i=1;i<=N;i++){\n\t\tbinom[i][0]=1; for(int j=1;j<=i;j++) binom[i][j]=(binom[i-1][j-1]+binom[i-1][j])%mod;\n\t}\n\t//Force::Main();\n\t//std::Main();\n\tfaster::Main();\n}\n\n```\n",
        "postTime": 1617700849,
        "uid": 293177,
        "name": "sry_",
        "ccfLevel": 9,
        "title": "CF917D"
    },
    {
        "content": "\u9898\u76ee\u9700\u8981\u6c42\u51fa\u6070\u597d$k$\u6761\u8fb9\u4e0d\u76f8\u540c\u7684\u65b9\u6848\u6570$f(k)$\n\n\u8003\u8651\u6c42\u51fa\u56fa\u5b9a$n-1-k$\u6761\u8fb9\u4e00\u5b9a\u548c\u539f\u6765\u7684\u6811\u76f8\u540c\u7684\u65b9\u6848$g(k)$\n\n$g(k) =\\ sum_{i=0}^{k} f(i) \\binom{k}{i}$\n\n\u7136\u540e\u4e8c\u9879\u5f0f\u53cd\u6f14\u5373\u53ef\u6c42\u51fa$f$\n\n\u8003\u8651\u5982\u679c\u6c42$g$\n\n\u56fa\u5b9a$n-1-k$\u6761\u8fb9\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u662f\u8981\u5bf9$k+1$\u4e2a\u8054\u901a\u5757\u6c42\u751f\u6210\u6811\u4e2a\u6570\u3002\n\n\u6839\u636e[WC2019\u6570\u6811](https://www.luogu.com.cn/problem/P5206)\u4e2d\u7684\u7ed3\u8bba\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u65b9\u6848\u6570\u4e3a$n^{k-1}\\prod_{1\\leq i \\leq k-1} a_i$\n\n\u5176\u4e2d$a_i$\u662f\u7b2c$i$\u4e2a\u8054\u901a\u5757\u7684\u5927\u5c0f\u3002\n\n\u90a3\u4e48\u5728\u6bcf\u4e2a\u8fde\u901a\u5757\u90fd\u9009\u62e9\u4e00\u4e2a\u70b9\u7684\u65b9\u6848\u6570\u5c31\u662f$\\prod_{1\\leq i \\leq k-1} a_i$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5$f_{i,j,0/1}$\u8868\u793a\u4ee5$i$\u4e3a\u6839\u7684\u5b50\u6811\u5185\u56fa\u5b9a\u4e86$size_i-1-j$\u6761\u8fb9\u4e00\u5b9a\u548c\u539f\u6765\u7684\u6811\u76f8\u540c\uff0c\u800c\u4e14$i$\u7684\u8fde\u901a\u5757\u6709\u6ca1\u6709\u9009\u62e9\u70b9\u7684\u65b9\u6848\u6570\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u7b97\u51fa$g$\u4e86\u3002\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n^2)$\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define maxn 105\n#define mod 1000000007\n#define rep(i,j,k) for(int i=(j),LIM=(k);i<=LIM;i++)\n#define per(i,j,k) for(int i=(j),LIM=(k);i>=LIM;i--)\nusing namespace std;\n\nint n;\nvector<int>G[maxn];\n#define pb push_back\nint sz[maxn],f[maxn][maxn][2],ans[maxn];\n\nint C[maxn][maxn];\nint Pow(int b,int k){ int r=1;for(;k;k>>=1,b=1ll*b*b%mod) if(k&1) r=1ll*r*b%mod; return r; }\n\nvoid dfs(int u,int ff,int v=0){\n\tsz[u] = f[u][0][0] = f[u][0][1] = 1;\n\trep(i,0,G[u].size()-1) if((v=G[u][i])^ff){\n\t\tdfs(v,u);\n\t\tstatic int g[maxn][2]={};\n\t\trep(j,0,sz[u]+sz[v]) g[j][0] = g[j][1] = 0;\n\t\trep(j,0,sz[u]) rep(k,0,sz[v])\n\t\t\tg[j+k][0] = (g[j+k][0] + f[u][j][0] * 1ll * f[v][k][0]) % mod,\n\t\t\tg[j+k][1] = (g[j+k][1] + f[u][j][0] * 1ll * f[v][k][1] + f[u][j][1] * 1ll * f[v][k][0]) % mod,\n\t\t\tg[j+k+1][0] = (g[j+k+1][0] + f[u][j][0] * 1ll * f[v][k][1]) % mod,\n\t\t\tg[j+k+1][1] = (g[j+k+1][1] + f[u][j][1] * 1ll * f[v][k][1]) % mod;\n\t\tsz[u] += sz[v];\n\t\trep(j,0,sz[u]) \n\t\t\tf[u][j][0] = g[j][0],\n\t\t\tf[u][j][1] = g[j][1];\n\t}\n}\n\nint main(){\n\tscanf(\"%d\",&n);\n\trep(i,1,n-1){\n\t\tint u,v;scanf(\"%d%d\",&u,&v);\n\t\tG[u].pb(v),G[v].pb(u);\n\t}\n\tdfs(1,0);\n\tans[0] = 1;\n\trep(i,1,n-1) ans[i] = f[1][i][1] * 1ll * Pow(n,i-1) % mod;\n\trep(i,(C[0][0]=1),n) rep(j,(C[i][0]=1),i) C[i][j] = (C[i-1][j-1] + C[i-1][j]) % mod;\n\trep(i,1,n-1) rep(j,0,i-1) ans[i] = (ans[i] - 1ll * C[n-1-j][i-j] * ans[j]) % mod;\n\tper(i,n-1,0) printf(\"%d%c\",(ans[i]+mod)%mod,\" \\n\"[i==0]);\n} \n```\n",
        "postTime": 1588757604,
        "uid": 30037,
        "name": "Freopen",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF917D \u3010Stranger Trees\u3011"
    },
    {
        "content": "\u751f\u6210\u6811\u8ba1\u6570\u95ee\u9898\u7528\u77e9\u9635\u6811\u5b9a\u7406\u6765\u8003\u8651\u3002\n\n\u77e9\u9635\u6811\u5b9a\u7406\u6c42\u5f97\u7684\u4e3a$\\sum\\limits_T\\prod\\limits_{e\\in T}v_e$\uff0c\u4e5f\u5c31\u662f\u6240\u6709\u751f\u6210\u6811\u7684\u8fb9\u6743\u79ef\u7684\u548c\u3002\n\n\u8fd9\u9898\u8fb9\u662f\u4e0d\u5e26\u6743\u7684\uff0c\u5e94\u7528\u77e9\u9635\u6811\u5b9a\u7406\u524d\uff0c\u6211\u4eec\u5fc5\u987b\u8003\u8651\u7ed9\u6bcf\u6761\u8fb9\u8d4b\u4e0a\u4e00\u4e2a\u6743\u503c\u3002\n\n\u53ef\u4ee5\u4ece\u591a\u9879\u5f0f\u7684\u89d2\u5ea6\u6765\u8003\u8651\u89e3\u51b3\u751f\u6210\u6811\u548c\u7ed9\u5b9a\u6811\u6709$k$\u6761\u8fb9\u91cd\u590d\u8fd9\u4e00\u6761\u4ef6\uff0c\u5c06\u7ed9\u5b9a\u6811\u7684\u8fb9\u8fb9\u6743\u8d4b\u4e3a$x$\uff0c\u5176\u4f59\u8fb9\u8d4b\u4e3a$1$\uff0c\u90a3\u4e48\u5e94\u7528\u77e9\u9635\u6811\u5b9a\u7406\u540e\u5f97\u5230\u7684\u591a\u9879\u5f0f\u4e2d\u7b2c$k$\u6b21\u9879$x^k$\u7684\u7cfb\u6570\u5373\u4e3a\u6070\u597d\u6709$k$\u6761\u8fb9\u91cd\u590d\u7684\u65b9\u6848\u6570\u3002\n\n\u53d1\u73b0\u76f4\u63a5\u4ee3\u5165\u591a\u9879\u5f0f\u6765\u6c42\u884c\u5217\u5f0f\u4e0d\u592a\u73b0\u5b9e\uff0c\u90a3\u4e48\u53ef\u4ee5\u5148\u6c42\u5f97$x$\u5728\u53d6$1$\u5230$n$\u65f6\u884c\u5217\u5f0f\u7684\u503c\uff0c\u7136\u540e\u5c31\u5f97\u5230\u4e86$n$\u4e2a\u65b9\u7a0b\uff0c\u628a\u539f\u591a\u9879\u5f0f\u7684\u7cfb\u6570\u770b\u4f5c\u672a\u77e5\u6570\uff0c\u4ee3\u5165$x$\u5f97\u5230\u7684\u503c\u6765\u4f5c\u4e3a\u73b0\u5728\u7684\u7cfb\u6570\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u901a\u8fc7\u9ad8\u65af\u6d88\u5143\u6765\u6c42\u89e3\u4e86\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u770b\u4ee3\u7801\u5427\u3002\n\n$code:$\n\n```cpp\n#include<bits/stdc++.h>\n#define maxn 210\n#define mod 1000000007\nusing namespace std;\ntypedef long long ll;\ntemplate<typename T> inline void read(T &x)\n{\n    x=0;char c=getchar();bool flag=false;\n    while(!isdigit(c)){if(c=='-')flag=true;c=getchar();}\n    while(isdigit(c)){x=(x<<1)+(x<<3)+(c^48);c=getchar();}\n    if(flag)x=-x;\n}\nll n;\nll a[maxn][maxn],b[maxn][maxn],e[maxn][maxn];\nll inv(ll x)\n{\n    ll y=mod-2,ans=1;\n    while(y)\n    {\n        if(y&1) ans=ans*x%mod;\n        x=x*x%mod;\n        y>>=1;\n    }\n    return ans;\n}\nll det()\n{\n    ll ans=1;\n    for(int i=1;i<n;++i)\n    {\n        ll p=inv(b[i][i]);\n        for(int j=i+1;j<n;++j)\n        {\n            ll d=b[j][i]*p%mod;\n            for(int k=i;k<n;++k)\n                b[j][k]=(b[j][k]-b[i][k]*d%mod+mod)%mod;\n        }\n        ans=ans*b[i][i]%mod;\n        if(!b[i][i]) return 0;\n    }\n    return ans;\n}\nvoid gauss()\n{\n    for(int i=1;i<=n;++i)\n    {\n        ll d=inv(a[i][i]);\n        for(int j=i;j<=n+1;++j) a[i][j]=a[i][j]*d%mod;\n        for(int j=i+1;j<=n;++j)\n        {\n            d=a[j][i];\n            for(int k=i;k<=n+1;++k)\n                a[j][k]=(a[j][k]-a[i][k]*d%mod+mod)%mod;\n        }\n    }\n    for(int i=n;i;--i)\n        for(int j=i-1;j;--j)\n            a[j][n+1]=(a[j][n+1]-a[j][i]*a[i][n+1]%mod+mod)%mod;\n}\nint main()\n{\n    read(n);\n    for(int i=1;i<n;++i)\n    {\n        int x,y;\n        read(x),read(y);\n        e[x][y]=e[y][x]=1;\n    }\n    for(int i=1;i<=n;++i)\n    {\n        a[i][1]=1;\n        for(int j=2;j<=n;++j)\n            a[i][j]=a[i][j-1]*i%mod;\n    }\n    for(int k=1;k<=n;++k)\n    {\n        for(int i=1;i<=n;++i)\n        {\n            b[i][i]=0;\n            for(int j=1;j<=n;++j)\n            {\n                if(i==j) continue;\n                if(e[i][j]) b[i][j]=mod-k,b[i][i]+=k;\n                else b[i][j]=mod-1,b[i][i]++;\n            }\n        }\n        a[k][n+1]=det();\n    }\n    gauss();\n    for(int i=1;i<=n;++i) printf(\"%lld \",a[i][n+1]);\n    return 0;\n}\n```\n",
        "postTime": 1586274253,
        "uid": 172489,
        "name": "lhm_",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF917D \u3010Stranger Trees\u3011"
    },
    {
        "content": "\u751f\u6210\u6811\u8ba1\u6570\u53ef\u4ee5\u60f3\u5230\u77e9\u9635\u6811\u5b9a\u7406\uff0c\u4f46\u662f\u663e\u7136\u77e9\u9635\u6811\u8dd1\u51fa\u6765\u7684\u503c\u662f\u8fb9\u6743\u7684\u4e58\u79ef\u7684\u548c\uff0c\u4e0d\u80fd\u7edf\u8ba1\u8be5\u6811\u4e0a\u7684\u8fb9\u4e0e\u7ed9\u51fa\u7684\u6811\u7684\u91cd\u5408\u8fb9\u6570\u3002\n\n\u8003\u8651\u628a\u4e00\u6761\u8fb9\u770b\u505a\u4e00\u4e2a\u591a\u9879\u5f0f\uff0c\u5982\u679c\u8fd9\u6761\u8fb9\u5728\u539f\u6811\u4e0a\uff0c\u8fd9\u6761\u8fb9\u7684\u6743\u503c\u770b\u4f5c\u662f$x^1$\uff0c\u5426\u5219\u770b\u505a$1$\u3002\u4e8e\u662f\u4e00\u68f5\u6811\u7684\u603b\u6743\u503c\u5c31\u662f$x^k$\uff0c\u5176\u4e2d$k$\u662f\u4e0e\u539f\u6811\u91cd\u5408\u7684\u8fb9\u7684\u6570\u76ee\u3002\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u4e9b\u591a\u9879\u5f0f\u6c42\u548c\uff0c\u7528\u77e9\u9635\u6811\u7b97\u51fa\u6765\uff0c\u603b\u548c\u5c31\u662f\u4e00\u4e2a\u591a\u9879\u5f0f\uff0c\u5176\u4e2d$x^k$\u7684\u7cfb\u6570\u8868\u793a\u6709$k$\u6761\u8fb9\u4e0e\u539f\u6811\u76f8\u540c\u3002\n\n\u6211\u4eec\u4e0d\u80fd\u628a\u591a\u9879\u5f0f\u5e26\u4eba\u8fdb\u53bb\u7b97\uff0c\u4f46\u662f\u6211\u4eec\u77e5\u9053\u6700\u7ec8\u7684\u591a\u9879\u5f0f\u7684\u6b21\u6570\u662f$n-1$\u7684\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u53d6$n$\u4e2a\u6570\u4ee3\u66ff$x$\u53bb\u6c42\u884c\u5217\u5f0f\uff0c\u56e0\u4e3a\u662f\u8981\u6c42\u51fa\u7cfb\u6570\uff0c\u6240\u4ee5\u76f4\u63a5\u66b4\u529b\u9ad8\u65af\u6d88\u5143\u63d2\u503c\u5c31\u597d\u4e86\u3002\u590d\u6742\u5ea6\u662f$O(n^4)$\u7684\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cmath>\n#include <cstring>\n#define LL long long\n\nconst int maxn=105;\nconst LL mod=1e9+7;\n\nusing namespace std;\n\nint n,x,y;\nLL a[maxn][maxn],c[maxn][maxn],b[maxn];\n\nLL power(LL x,LL y)\n{\n    if (y==1) return x;\n    LL c=power(x,y/2);\n    c=(c*c)%mod;\n    if (y%2) c=(c*x)%mod;\n    return c; \n}\n\nLL det(int n)\n{\n    LL ans=1;\n    for (int i=1;i<=n;i++)\n    {\n    \tLL inv=power(c[i][i],mod-2);\n        for (int j=i+1;j<=n;j++)\n        {\n            LL rate=c[j][i]*inv%mod;\n            for (int k=i;k<=n;k++)\n            {\n                c[j][k]=(c[j][k]+mod-rate*c[i][k]%mod)%mod;\n            }\n        }\n        ans=(ans*c[i][i])%mod;\n        if (!c[i][i]) break;\n    }\n    return ans;\n}\n\nint main()\n{\n    scanf(\"%d\",&n);\n    for (int i=1;i<n;i++)\n    {\n        scanf(\"%d%d\",&x,&y);\n        a[x][y]=1;\n        a[y][x]=1;\n    }\n    for (int k=1;k<=n;k++)\n    {\n        memset(c,0,sizeof(c));\n        for (int i=1;i<=n;i++)\n        {\n            for (int j=1;j<=n;j++)\n            {\n                if (i!=j)\n                {\n                    if (a[i][j]) c[i][j]=mod-k,c[i][i]+=k;\n                            else c[i][j]=mod-1,c[i][i]+=1;\n                } \n            }\n        }\t\t\n        b[k]=det(n-1);\n    }\n    \n    for (int i=1;i<=n;i++)\n    {\n        c[i][1]=1;\n        for (int j=2;j<=n;j++) c[i][j]=(c[i][j-1]*i)%mod;\n    }\n    for (int i=1;i<=n;i++)\n    {\n        LL inv=power(c[i][i],mod-2);\n        for (int j=1;j<=n;j++)\n        {\n            if (i==j) continue;\n            LL rate=c[j][i]*inv%mod;\n            for (int k=i;k<=n;k++)\n            {\n                c[j][k]=(c[j][k]+mod-rate*c[i][k]%mod)%mod;\n            }\n            b[j]=(b[j]+mod-rate*b[i]%mod)%mod;\n        }\n    }\n    for (int i=1;i<=n;i++)\n    {\n        b[i]=b[i]*power(c[i][i],mod-2)%mod;\n        printf(\"%lld \",b[i]);\n    }\n}\n```",
        "postTime": 1533967950,
        "uid": 18895,
        "name": "liangzihao",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF917D \u3010Stranger Trees\u3011"
    }
]
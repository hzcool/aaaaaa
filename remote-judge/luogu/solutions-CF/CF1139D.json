[
    {
        "content": "\u66f4\u597d\u7684\u4f53\u9a8c$\\to $ [$\\color{#142857}{\\it George1123}$](https://www.cnblogs.com/George1123/p/13586454.html)\u3002\r\n\r\n---\r\n## \u9898\u9762\r\n\r\n> [CF1139D Steps to One](https://www.luogu.com.cn/problem/CF1139D) \r\n\r\n> \u4e00\u4e2a\u6570\u5217\uff0c\u6bcf\u6b21\u968f\u673a\u9009\u4e00\u4e2a $[1,m]$ \u4e4b\u95f4\u7684\u6570\u52a0\u5728\u6570\u5217\u672b\u5c3e\uff0c\u6570\u5217\u4e2d\u6240\u6709\u6570\u7684 $\\gcd=1$ \u65f6\u505c\u6b62\uff0c\u6c42\u671f\u671b\u957f\u5ea6 $\\bmod 10^9+7$\u3002\r\n\r\n> \u6570\u636e\u8303\u56f4\uff1a$1\\le m\\le 10^5$\u3002\r\n\r\n---\r\n## \u849f\u84bb\u8bed\r\n\r\n\u8fd9\u9898\u7684\u975e dp \u505a\u6cd5\u8bb2\u5f97\u592a\u7384\u4e86\u800c\u4e14\u5199\u9898\u89e3\u7684\u4eba\u8c8c\u4f3c\u4e0d\u5c51\u4e8e\u89e3\u91ca\uff0c\u4e8e\u662f\u849f\u84bb\u6765\u5199\u4e00\u7bc7\u3002\r\n\r\n---\r\n## \u849f\u84bb\u89e3\r\n\r\n\u5148\u63a8\u4e00\u6ce2\u6982\u7387\u671f\u671b\u5f0f\uff08$E(x)$ \u662f $x$ \u7684\u671f\u671b\uff0c$P(x)$ \u662f $x$ \u4e8b\u4ef6\u7684\u6982\u7387\uff09\u3002\r\n\r\n$$\r\n\\begin{aligned}\r\nE(len)=&\\sum_{i\\ge 1}P(len=i)\\cdot i\\\\\r\n=&\\sum_{i\\ge 1}P(len=i)\\sum_{j=1}^i\\\\\r\n=&\\sum_{j\\ge 1}\\sum_{i\\ge j}P(len=i)\\\\\r\n=&\\sum_{i\\ge 1}P(len\\ge i)\\\\\r\n=&1+\\sum_{i\\ge 1}P(len>i)\\\\\r\n\\end{aligned}\r\n$$\r\n\r\n\u56e0\u4e3a $\\gcd_{i=1}^{len} a_i=1$ \u5c31\u7ed3\u675f\u4e86\uff0c\u6240\u4ee5\uff1a\r\n\r\n$$\r\n\\begin{aligned}\r\nP(len>i)=&P\\left(\\left(\\gcd_{j=1}^{i} a_i\\right)>1\\right)\\\\\r\n=&1-P\\left(\\left(\\gcd_{j=1}^{i} a_i\\right)=1\\right)\\\\\r\n=&1-\\frac{\\sum_{a_1=1}^m\\sum_{a_2=1}^m\\cdots\\sum_{a_i=1}^m\\epsilon\\left(\\left(\\gcd_{j=1}^{i} a_i\\right)\\right)}{m^i}\\\\\r\n=&^{\\color{#aa88cc}{(1)}}1-\\frac{\\sum_{a_1=1}^m\\sum_{a_2=1}^m\\cdots\\sum_{a_i=1}^m\\sum_{d|\\left(\\gcd_{j=1}^{i} a_i\\right)}\\mu(d)}{m^i}\\\\\r\n=&1-\\frac{\\sum_{d=1}^m\\mu(d)\\sum_{a_1=1}^m[d|a_1]\\sum_{a_2=1}^m[d|a_2]\\cdots\\sum_{a_i=1}^m[d|a_i]}{m^i}\\\\\r\n=&1-\\frac{\\sum_{d=1}^m\\mu(d)\\left(\\lfloor\\frac{m}{d}\\rfloor\\right)^i}{m^i}\\\\\r\n=&^{\\color{#eeaa22}{(2)}}-\\frac{\\sum_{d=2}^m\\mu(d)\\left(\\lfloor\\frac{m}{d}\\rfloor\\right)^i}{m^i}\\\\\r\n\\end{aligned}\r\n$$\r\n\r\n$\\color{#aa88cc}{(1)}$ \u5c31\u662f\u4e00\u4e2a\u83ab\u53cd\uff0c$\\color{#eeaa22}{(2)}$ \u5c31\u662f\u628a $d=1$ \u7684\u503c\u548c $1$ \u62b5\u6d88\u6389\u3002\r\n\r\n\u5e26\u56de\u4e0a\u5f0f\uff1a\r\n\r\n$$\r\n\\begin{aligned}\r\nE(len)=&1+\\sum_{i\\ge 1}P(len>i)\\\\\r\n=&1-\\sum_{i\\ge 1}\\frac{\\sum_{d=2}^m\\mu(d)\\left(\\lfloor\\frac{m}{d}\\rfloor\\right)^i}{m^i}\\\\\r\n=&1-\\sum_{i\\ge 1}\\frac{1}{m^i}\\sum_{d=2}^m\\mu(d)\\left(\\lfloor\\frac{m}{d}\\rfloor\\right)^i\\\\\r\n=&1-\\sum_{d=2}^m\\mu(d)\\sum_{i\\ge 1}\\left(\\frac{\\lfloor\\frac{m}{d}\\rfloor}{m}\\right)^i\\\\\r\n=&^{\\color{#ff2211}{(3)}}1-\\sum_{d=2}^m\\mu(d)\\frac{\\lfloor\\frac{m}{d}\\rfloor}{m-\\lfloor\\frac{m}{d}\\rfloor}\\\\\r\n\\end{aligned}\r\n$$\r\n\r\n$\\color{#ff2211}{(3)}$ \u662f\u65e0\u7a77\u7b49\u6bd4\u6570\u5217\u6c42\u503c\uff1a\r\n\r\n$$s=x+x^2+x^3+\\cdots$$\r\n\r\n$$sx=x^2+x^3+x^4+\\cdots$$\r\n\r\n$$s-sx=x$$\r\n\r\n$$s=\\frac{x}{1-x}$$\r\n\r\n\u7136\u540e\u5c31\u53ef\u4ee5\u7b5b\u4e2a $\\mu(i)$ \u5c31\u53ef\u4ee5 $\\Theta(m)$ \u5730\u7b97\u4e86\uff0c\u5f53\u7136\u60a8\u53ef\u4ee5\u675c\u6559\u5230 $\\Theta(m^{\\frac 23})$\uff0c\u4f46\u662f\u90a3\u4e48\u79c0\u6709\u4ec0\u4e48\u610f\u601d\u5462\u2026\u2026\r\n\r\n---\r\n## \u4ee3\u7801\r\n\r\n```cpp\r\n#include <bits/stdc++.h>\r\nusing namespace std;\r\n\r\n//Start\r\ntypedef long long ll;\r\ntypedef double db;\r\n#define mp(a,b) make_pair((a),(b))\r\n#define x first\r\n#define y second\r\n#define be(a) (a).begin()\r\n#define en(a) (a).end()\r\n#define sz(a) int((a).size())\r\n#define pb(a) push_back(a)\r\n#define R(i,a,b) for(int i=(a),I=(b);i<I;i++)\r\n#define L(i,a,b) for(int i=(a),I=(b);i>I;i--)\r\nconst int iinf=0x3f3f3f3f;\r\nconst ll linf=0x3f3f3f3f3f3f3f3f;\r\n\r\n//Data\r\nconst int mod=1e9+7;\r\n\r\n//Sieve\r\nstruct sieve{\r\n\tint n;\r\n\tvector<bool> np;\r\n\tvector<int> prime,mu,inv;\r\n\tvoid Sieve(){\r\n\t\tnp[1]=true,mu[1]=1;\r\n\t\tR(i,2,n){\r\n\t\t\tif(!np[i]) prime.pb(i),mu[i]=-1;\r\n\t\t\tfor(int p:prime){\r\n\t\t\t\tif(!(i*p<n)) break;\r\n\t\t\t\tnp[i*p]=true;\r\n\t\t\t\tif(i%p==0){mu[i*p]=0;break;}\r\n\t\t\t\tmu[i*p]=mu[i]*mu[p];\r\n\t\t\t}\r\n\t\t}\r\n\t\tinv[1]=1;\r\n\t\tR(i,2,n) inv[i]=1ll*(mod-mod/i)*inv[mod%i]%mod;\r\n\t}\r\n\tsieve(int _n){\r\n\t\tn=_n,np.assign(n,false),inv.resize(n);\r\n\t\tprime.clear(),mu.resize(n),Sieve();\r\n\t}\r\n};\r\n\r\n//Main\r\nint main(){\r\n\tios::sync_with_stdio(0);\r\n\tcin.tie(0),cout.tie(0);\r\n\tint n; cin>>n;\r\n\tsieve math(n+1);\r\n\tint ans=1;\r\n\tR(i,2,n+1) (ans+=mod-1ll*(mod+math.mu[i])%mod\r\n\t\t\t   *(n/i)%mod*math.inv[n-n/i]%mod)%=mod;\r\n\tcout<<ans<<'\\n'; \r\n\treturn 0;\r\n}\r\n```\r\n---\r\n**\u795d\u5927\u5bb6\u5b66\u4e60\u6109\u5feb\uff01**",
        "postTime": 1598789563,
        "uid": 118365,
        "name": "George1123",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1139D \u3010Steps to One\u3011"
    },
    {
        "content": "\u600e\u4e48\u5404\u4f4ddalao\u7684\u590d\u6742\u5ea6\u90fd\u4e0d\u662f$O(m)$\u554a...\u745f\u745f\u53d1\u6296qwq\n![](https://cdn.luogu.com.cn/upload/pic/55533.png)\n```cpp\n#include <cstring>\n#include <iostream>\nusing int_t = long long int;\nusing std::cin;\nusing std::cout;\nusing std::endl;\n\nconst int_t mod = 1e9 + 7;\nconst int_t LARGE = 1e5;\nint_t inv[LARGE + 1];\nint_t m;\nint_t mu[LARGE + 1];\nint_t factor[LARGE + 1];\nbool isPrime[LARGE + 1];\n\nint main() {\n    memset(isPrime, 1, sizeof(isPrime));\n    cin >> m;\n    inv[1] = 1;\n    for (int_t i = 2; i <= m; i++)\n        inv[i] = (mod - mod / i) * inv[mod % i] % mod;\n    for (int_t i = 2; i <= m; i++)\n        if (isPrime[i]) {\n            for (int_t j = i * i; j <= m; j += i) {\n                factor[j] = i;\n                isPrime[j] = false;\n            }\n            factor[i] = i;\n        }\n    mu[1] = 1;\n    for (int_t i = 2; i <= m; i++) {\n        int_t p = factor[i];\n        if (i / p % p == 0)\n            mu[i] = 0;\n        else\n            mu[i] = mu[i / p] * -1;\n    }\n    int_t result = 1;\n    for (int_t i = 2; i <= m; i++) {\n        int_t x = m / i;\n        result = (result - mu[i] * x % mod * inv[m - x] % mod + mod) % mod;\n    }\n    cout << result << endl;\n    return 0;\n}\n```",
        "postTime": 1554011156,
        "uid": 56891,
        "name": "officeyutong",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1139D \u3010Steps to One\u3011"
    },
    {
        "content": "## \u8fd9\u91cc\u662f\u4e00\u4e2a$O(NlogN)$\u7684\u505a\u6cd5!!\n\n\u597d\u5427..\u5176\u5b9e\u524d\u9762\u7684\u6b65\u9aa4\u548c\u5176\u4ed6\u7684\u9898\u89e3\u5dee\u4e0d\u591a\u4e86..\u53ea\u4e0d\u8fc7\u518d\u5f80\u540e\u63a8\u4e00\u4e9b\u5c31\u597d\u4e86..\n\n\u9996\u5148,\u53ef\u4ee5\u8bbe\u7f6e\u72b6\u6001$f[i]$\u8868\u793a\u5f53\u524d\u6240\u6709\u7684\u6570\u7684$gcd=i$\u65f6,\u8fd8\u9700\u8981\u52a0\u5165\u7684\u6570\u7684\u671f\u671b\u4e2a\u6570.\n\n\u663e\u7136\u53ef\u77e5,$f[1]=0$,\u5e76\u4e14\u6709:\n\n$$ans=1+\\frac{\\sum_{i=1}^{m}f[i]}{m}$$\n\n$+1$\u662f\u56e0\u4e3a\u8bbe\u7f6e\u72b6\u6001\u7684\u539f\u56e0..\u663e\u7136\u7b2c\u4e00\u4e2a\u6570\u662f\u6ca1\u6709\u8003\u8651\u5728\u5185\u7684...\u6240\u4ee5\u9700\u8981\u679a\u4e3e\u4e00\u4e0b\u7b2c\u4e00\u4e2a\u6570\u662f\u4ec0\u4e48,\u6bcf\u4e00\u4e2a\u6570\u90fd\u6709$\\frac{1}{m}$\u7684\u6982\u7387\u9009\u4e0a,\u9009\u4e0a\u4e4b\u540e\u8fd8\u671f\u671b\u5728\u4e4b\u540e\u52a0\u4e0a$f[i]$\u4e2a\u6570,\u6240\u4ee5\u7b54\u6848\u5c31\u662f\u8fd9\u4e2a\u4e86..\n\n\u7136\u540e\u8003\u8651\u8f6c\u79fb..\n\n\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u8fd9\u6837\u4e00\u4e2a\u975e\u5e38\u663e\u7136\u7684\u5f0f\u5b50:\n\n$$f[i]=1+\\frac{\\sum_{j=1}^m f[gcd(i,j)]}{m}$$\n\n\u5927\u81f4\u7684\u610f\u601d\u5c31\u662f,\u5f53\u524d\u7684$gcd$\u4e0d\u4e3a$1$($gcd=1$,\u5373$f[1]=0$),\u663e\u7136\u4f1a\u63d2\u5165\u81f3\u5c11\u4e00\u4e2a\u6570,\u8fd9\u6837\u6211\u4eec\u5c31\u4f1a\u67091\u7684\u8d21\u732e. \u7136\u540e\u5c31\u53ef\u4ee5\u679a\u4e3e\u4e0b\u4e00\u4e2a\u6570\u53ef\u80fd\u662f\u4ec0\u4e48, \u9009\u5230\u4efb\u610f\u4e00\u4e2a\u6570\u7684\u6982\u7387\u90fd\u662f$\\frac{1}{m}$,\u9009\u51fa\u8fd9\u4e2a\u6570\u4e4b\u540e\u6570\u5217\u7684$gcd$\u663e\u7136\u5c31\u4f1a\u662f\u524d\u9762\u7684\u6570\u7684$gcd$\u4e0e\u5f53\u524d\u63d2\u5165\u7684\u6570\u7684$gcd$.\u6240\u4ee5\u5c31\u4f1a\u6709\u8fd9\u4e2a\u9012\u63a8..\n\n\u7136\u540e\u8003\u8651\u4f18\u5316\u8f6c\u79fb..\u9996\u5148\u53ef\u4ee5\u60f3\u5230\u7684\u662f\u679a\u4e3e$gcd$.\u56e0\u4e3a$gcd$\u4e00\u5b9a\u662f$i$\u7684\u56e0\u5b50,$1$~$n$\u7684\u56e0\u5b50\u4e2a\u6570\u548c\u662f\u63a5\u8fd1$n\\times ln(n)$\u7684,\u6240\u4ee5\u53ef\u4ee5\u4f18\u5316\u4e00\u5b9a\u7684\u590d\u6742\u5ea6.\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u73b0\u5728\u9700\u8981\u6c42\u7684\u5f0f\u5b50\u53d8\u6210\u4e86\u8fd9\u4e2a:\n\n$$f[i]=1+\\frac{\\sum_{d|i} f[d]\\sum_{j=1}^m [gcd(i,j)=d]}{m}$$\n\n\u600e\u4e48\u5feb\u901f\u6c42$\\sum_{d|i} f[d]\\sum_{j=1}^m [gcd(i,j)=d]$\u5462..\n\n~~\u663e\u7136\u9700\u8981\u61f5\u903c\u94a8\u4e1d\u53cd\u6f14\u4e86...~~\u7a9d\u4e0d\u4f1a\u53cd\u6f14\u53ea\u4f1a\u61f5\u903c\u94a8\u4e1d\u51fd\u6570...\n\n\u6240\u4ee5\u53ef\u4ee5~~\u6b22\u4e50\u5730~~\u5316\u5f0f\u5b50\u8fa3!!\n\n$$\\sum_{d|i} f[d]\\sum_{j=1}^m [gcd(i,j)=d]$$\n\n$$\\sum_{d|i} f[d]\\sum_{j=1}^{m/d} [gcd(i/d,j)=1]$$\n\n$$\\sum_{d|i} f[d]\\sum_{j=1}^{m/d} \\sum_{t=1}^{m}\\mu(t)[t|(i/d)][t|j]$$\n\n$$\\sum_{d|i} f[d]\\sum_{t=1}^{m}\\mu(t)[t|(i/d)] \\sum_{j=1}^{m/d} [t|j]$$\n\n$$\\sum_{d|i} f[d]\\sum_{t|(i/d)}\\mu(t)\\lfloor \\frac{m}{td} \\rfloor$$\n\n\u7136\u540e\u6211\u4eec\u8003\u8651\u8bbe$T=td$,\u4ea4\u6362\u4e00\u4e0b\u679a\u4e3e\u987a\u5e8f:\n\n\u6ce8\u610f\u4e00\u4e0b,\u8fd9\u91cc\u7684$d$\u4ee5\u53ca$t$\u7684\u6761\u4ef6,\u53d1\u73b0\u6ee1\u8db3$(td)|i$,\u6240\u4ee5\u9700\u8981\u5199\u6210\u4e0b\u9762\u8fd9\u4e2a\u6837\u5b50:\n\n$$\\sum_{T|i}\\lfloor \\frac{m}{T} \\rfloor \\sum_{d|T}f[d]\\mu(\\frac{T}{d})$$\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u4e2a\u5f0f\u5b50\u5e26\u56de\u5230\u539f\u5f0f\u4e2d:\n\n$$f[i]=1+\\frac{\\sum_{T|i}\\lfloor \\frac{m}{T} \\rfloor \\sum_{d|T}f[d]\\mu(\\frac{T}{d})}{m}$$\n\n\u5982\u679c\u6211\u4eec\u8bbe$F[x]=\\sum_{d|T}f[d]\\mu(\\frac{T}{d})$,\u90a3\u4e48\u5982\u679c\u6211\u4eec\u65b0\u6c42\u51fa\u4e86\u4e00\u4e2a$f[i+1]$,\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u7528$O(\\frac{m}{i+1})$\u7684\u65f6\u95f4\u66f4\u65b0$F(x)$..\u8fd9\u6837\u6c42$F(x)$\u7684\u590d\u6742\u5ea6\u5c31\u662f$O(nlogn)$.\n\n\u4f46\u662f\u600e\u4e48\u6c42$f[i]$\u5462..\u4e0a\u9762\u7684\u5f0f\u5b50\u4e2d,\u82e5$T=d=i$\u7684\u65f6\u5019\u51fa\u73b0\u4e86\u672a\u77e5\u7684$f[i]$,\u663e\u7136\u6211\u4eec\u9700\u8981\u628a\u5b83\u79fb\u5230\u7b49\u53f7\u5de6\u8fb9\u53bb.\u90a3\u4e48\u5c31\u7b97\u4e00\u4e0b\u7cfb\u6570\u5427..\n\n$T=d=i$,\u4ece\u91cc\u5230\u5916\u7684\u7cfb\u6570\u5c31\u662f$\\mu(1)$, $\\lfloor \\frac{m}{i} \\rfloor$, $\\frac{1}{m}$,\u90a3\u4e48\u628a$f[i]$\u62c6\u51fa\u6765\u5c31\u662f\u8fd9\u4e2a\u4e86:\n\n$$f[i]=1+\\frac{\\sum_{T|i}\\lfloor \\frac{m}{T} \\rfloor \\sum_{d|T}f[d]\\mu(\\frac{T}{d})[d \\neq i]}{m}+\\frac{f[i]\\lfloor \\frac{m}{i} \\rfloor}{m}$$\n\n\u518d\u5f80\u4e0b\u63a8\u5c31\u53ef\u4ee5\u6709:\n\n$$f[i]-\\frac{f[i]\\lfloor \\frac{m}{i} \\rfloor}{m}=1+\\frac{\\sum_{T|i}\\lfloor \\frac{m}{T} \\rfloor \\sum_{d|T}f[d]\\mu(\\frac{T}{d})[d \\neq i]}{m}$$\n\n$$f[i]=\\frac{m+\\sum_{T|i}\\lfloor \\frac{m}{T} \\rfloor \\sum_{d|T}f[d]\\mu(\\frac{T}{d})[d \\neq i]}{m-\\lfloor \\frac{m}{i} \\rfloor}$$\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u4e86...\u7b49\u4f1a..\u4e0a\u9762\u7684$[d \\neq i]$\u597d\u50cf\u548c\u4e4b\u524d\u7684\u4e1c\u897f\u4e0d\u592a\u50cf\u554a..\n\n\u5176\u5b9e\u8fd9\u4e2a\u6761\u4ef6\u53ea\u5728$T=i$\u7684\u65f6\u5019\u624d\u6709\u9650\u5236...\u7136\u540e\u8003\u8651\u6c42\u72c4\u5229\u514b\u96f7\u5377\u79ef\u7684\u65f6\u5019,\u5982\u679c\u5916\u5c42\u5faa\u73af\u6b63\u597d\u679a\u4e3e\u5230$i$,\u5185\u5c42\u5faa\u73af\u8fd8\u6ca1\u6709\u8fdb\u5165\u7684\u65f6\u5019,$1$~$i-1$\u7684\u4f4d\u7f6e\u7684\u5377\u79ef\u80af\u5b9a\u662f\u5df2\u7ecf\u7b97\u597d\u4e86\u7684..\u7b2c$i$\u4e2a\u4f4d\u7f6e\u4e0a\u7684\u503c\u8fd8\u5c11\u4e86$f[i] \\times \\mu(1)$..\u8fd9\u4e0d\u5c31\u662f\u6211\u4eec\u60f3\u8981\u7684\u4e1c\u897f\u4e48..\n\n\u6240\u4ee5\u5c31\u53ef\u4ee5\u5148\u7b97$f[i]$\u518d\u7b97$F(i)$\u4e86..\n\n\u8d34\u4e0a\u4ee3\u7801...\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\nconst int mod = 1000000007;\nconst int MAXN = 1000000;\n\nint n;\n\nint tot;\nint pri[MAXN + 1];\nint miu[MAXN + 1];\nint inv[MAXN + 1];\nbitset<MAXN + 1>chk;\nvector<int>d[MAXN + 1];\n\nint F[MAXN + 1];\n\ninline void prework();\ninline int Mod(int);\n\nint main() {\n\tcin >> n, prework(); int res = 1;\n\tfor(int i = 2; i <= n; i++) { // \u72c4\u5229\u514b\u96f7\u5377\u79ef\n\t\tint si = d[i].size(); int f = n;\n\t\tfor(int j = 0; j < si; j++) { // \u679a\u4e3eT\u8ba1\u7b97f[i]\n\t\t\tint T = d[i][j];\n\t\t\tf = (f + 1LL * (n / T) * F[T]) % mod;\n\t\t} f = 1LL * f * inv[n - n / i] % mod; res = Mod(res + f + 1);\n\t\tfor(int j = 1, k = i; k <= n; j++, k += i) // \u72c4\u5229\u514b\u96f7\u5377\u79ef\u8ba1\u7b97F[i]\n\t\t\tF[k] = Mod(F[k] + r * miu[j]);\n\t} cout << 1LL * res * inv[n] % mod << endl;\n\tcerr << 1.0 * clock() / CLOCKS_PER_SEC << endl;\n\treturn 0;\n}\n\ninline void prework() {\n\tmiu[1] = 1;\n\tfor(int i = 2; i <= n; i++) { // \u9884\u5904\u7406miu\n\t\tif(!chk[i]) pri[++tot] = i, miu[i] = -1;\n\t\tfor(int j = 1; j <= tot; j++) {\n\t\t\tif(pri[j] * i > n) break;\n\t\t\tchk[pri[j] * i] = 1;\n\t\t\tif(i % pri[j] == 0) break;\n\t\t\tmiu[i * pri[j]] = -miu[i];\n\t\t}\n\t}\n\tfor(int i = 1; i <= n; i++) // \u9884\u5904\u7406\u6bcf\u4e2a\u6570\u7684\u7ea6\u6570\n\t\tfor(int j = i; j <= n; j += i)\n\t\t\td[j].push_back(i);\n\tinv[1] = 1;\n\tfor(int i = 2; i <= n; i++) // \u9884\u5904\u7406\u9006\u5143\n\t\tinv[i] = 1LL * (mod - mod / i) * inv[mod % i] % mod;\n}\n\ninline int Mod(int x) { return x >= mod ? x - mod : (x < 0 ? x + mod : x); }\n```\n\n~~\u597d\u50cf\u88ab\u522b\u7684\u5927\u4f6c\u7684$NlogN$\u540a\u6253\u4e86QwQ~~",
        "postTime": 1554204519,
        "uid": 20782,
        "name": "CYJian",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1139D \u3010Steps to One\u3011"
    },
    {
        "content": "\u8fd9\u91cc\u63d0\u4f9b\u4e00\u7bc7\u4e0d\u7528\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u9898\u89e3 qwq\u3002\n\n~~\uff08\u5f88\u4e0d\u64c5\u957f\u671f\u671b\u6240\u4ee5\u53ef\u80fd\u4f1a\u6709\u4e9b\u5730\u65b9\u8bf4\u7684\u4e0d\u662f\u5f88\u6070\u5f53\uff09~~\n\n\u8003\u8651\u4ece $\\gcd$ \u4e3a $x$ \u65f6\u53ef\u4ee5\u8f6c\u79fb\u5230\u54ea\u4e9b\u72b6\u6001:\n\n1. \u8f6c\u79fb\u5230\u81ea\u5df1\u3002\n\n2. \u8f6c\u79fb\u5230\u9664\u4e86\u81ea\u5df1\u5916\u7684\u7ea6\u6570\u3002\n\n\u7b2c\u4e00\u79cd\u4f1a\u81ea\u5df1\u548c\u81ea\u5df1\u5957\u5708\u6bd4\u8f83\u9ebb\u70e6\uff0c\u6211\u4eec\u60f3\u529e\u6cd5\u7528\u7b49\u4ef7\u7684\u65b9\u5f0f\u53bb\u6389\u5b83\u3002\n\n\u6709\u4e00\u4e2a\u5b9a\u7406\u5b58\u5728\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u72b6\u6001\u6bcf\u6b21\u6709 $\\frac{1}{x}$ \u7684\u6982\u7387\u8f6c\u79fb\u5230\u5176\u5b83\u72b6\u6001\uff0c\u90a3\u4e48\u5b83\u80fd\u591f\u8f6c\u79fb\u5230\u5176\u5b83\u72b6\u6001\u7684\u671f\u671b\u6b21\u6570\u662f $x$\u3002\uff08\u8fd9\u4e2a\u5b9a\u7406\u53ef\u4ee5\u5c06\u5f0f\u5b50\u62c6\u6210\u82e5\u5e72\u4e2a\u7b49\u6bd4\u6570\u5217\uff0c\u6bcf\u4e2a\u7b49\u6bd4\u6570\u5217\u7684\u548c\u4e5f\u5f62\u6210\u4e00\u4e2a\u7b49\u6bd4\u6570\u5217\uff0c\u518d\u6c42\u548c\u5c31\u53ef\u4ee5\u5f97\u5230\u7b54\u6848\uff09\n\n\u8003\u8651\u4e00\u4e2a\u6570 $x$ \u548c\u53e6\u4e00\u4e2a\u6570\u7684 $\\gcd$ \u8fd8\u662f\u81ea\u5df1\uff0c\u90a3\u4e48\u8fd9\u53e6\u4e00\u4e2a\u6570\u4e00\u5b9a\u662f $x$ \u7684\u500d\u6570\u3002\u8fd9\u6837\u7684\u500d\u6570\u6709 $\\left \\lfloor \\frac{n}{x} \\right \\rfloor $ \u4e2a\uff0c\u6240\u4ee5\u5b83\u8f6c\u79fb\u5230\u81ea\u5df1\u7684\u6982\u7387\u662f $\\frac{\\left \\lfloor \\frac{n}{x} \\right \\rfloor}{n}$\uff0c\u8f6c\u79fb\u5230\u5176\u5b83\u72b6\u6001\u7684\u671f\u671b\u957f\u5ea6\u5c31\u662f $\\frac{n}{n-\n\\left \\lfloor \\frac{n}{x} \\right \\rfloor}$\u3002\n\n\u90a3\u4e48\u5c31\u53ef\u4ee5\u8f6c\u5316\u6210\uff0c$\\gcd$ \u4e3a $x$ \u65f6\u7684\u671f\u671b\u957f\u5ea6\u7531\u8f6c\u79fb\u5230\u7684\u6240\u6709\u7ea6\u6570\u7684\u201c\uff08\u52a0\u6743\uff09\u5e73\u5747\u671f\u671b\u957f\u5ea6\u201d\u518d\u52a0\u4e0a\u81ea\u5df1\u8f6c\u79fb\u5230\u5176\u5b83\u72b6\u6001\u7684\u671f\u671b\u957f\u5ea6\u5f97\u5230\u3002\n\n\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u53ea\u9700\u8981\u8ba1\u7b97\u8fd9\u4e2a\u201c\u5e73\u5747\u671f\u671b\u957f\u5ea6\u201d\u5373\u53ef\uff0c\u8fd9\u4e2a\u201c\u5e73\u5747\u671f\u671b\u957f\u5ea6\u201d\u7684\u8ba1\u7b97\u65b9\u6cd5\u662f\u6bcf\u79cd\u8f6c\u79fb\u7684 **\u8f6c\u79fb\u6982\u7387 $\\times$ \u8f6c\u79fb\u540e\u72b6\u6001\u7684\u671f\u671b\u957f\u5ea6** \u4e4b\u548c\u3002\n\n\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u53ea\u8981\u8003\u8651\u5982\u4f55\u8ba1\u7b97\u8f6c\u79fb\u6982\u7387\u5373\u53ef\u3002\u8003\u8651\u5230\u4ece $x$ \u8f6c\u79fb\u5230\u4e86\u5b83\u7684\u7ea6\u6570 $y$ \uff0c\u90a3\u4e48\u8fd9\u6b21\u8f6c\u79fb\u6709\u53ef\u80fd\u7684\u6570\u662f\u6240\u6709 $y$ \u7684\u500d\u6570\u3002\n\n\u90a3\u4e48\u5728\u8fd9\u4e9b $y$ \u7684\u500d\u6570\u91cc\uff0c\u53d1\u73b0\u5982\u679c\u88ab\u6709\u66f4\u5927\u7684 $x$ \u7684\u500d\u6570\u7528\u6389\u4e86\uff0c$y$ \u5c31\u4e0d\u80fd\u901a\u8fc7\u8fd9\u4e2a\u500d\u6570\u8f6c\u79fb\u4e86\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u4ece\u5927\u5230\u5c0f\u627e\u7ea6\u6570\uff0c\u5728\u6bcf\u4e00\u4e2a $x$ \u7684\u7ea6\u6570 $y$ \u8ba1\u7b97\u5b8c\u65f6\uff0c\u90fd\u8ba9\u540e\u9762\u7684 $y$ \u7684\u7ea6\u6570\u51cf\u53bb\u81ea\u5df1\u8f6c\u79fb\u53ef\u80fd\u901a\u8fc7\u7684\u6570\u7684\u4e2a\u6570\uff0c\u4e4b\u540e\u7b97\u5230\u67d0\u4e2a\u7ea6\u6570\u65f6\u5c31\u76f4\u63a5\u52a0\u4e0a\u6709\u591a\u5c11\u4e2a\u81ea\u5df1\u7684\u500d\u6570\u5373\u53ef\uff0c\u56e0\u4e3a\u5728\u524d\u9762\u66f4\u5927\u7684\u7ea6\u6570\u8ba1\u7b97\u65f6\u5df2\u7ecf\u628a\u81ea\u5df1\u4e0d\u80fd\u53d6\u7684\u53bb\u6389\u4e86\u3002\n\n\u7531\u4e8e\u8f6c\u79fb\u5230\u540e\u9762\u7ea6\u6570\u53ef\u4ee5\u901a\u8fc7\u7684\u6570\u5b57\u4e2a\u6570\u6709 $n-\n\\left \\lfloor \\frac{n}{x} \\right \\rfloor$ \u4e2a\uff0c\u5982\u679c\u6709 $p$ \u4e2a\u6570\u53ef\u4ee5\u8ba9 $x$ \u8f6c\u79fb\u5230 $y$\uff0c\u90a3\u4e48\u8f6c\u79fb\u5230\u67d0\u4e2a\u7ea6\u6570\u7684\u6982\u7387\u5c31\u662f $\\frac{p}{n-\n\\left \\lfloor \\frac{n}{x} \\right \\rfloor}$\u3002\n\n\u53ea\u8981\u8fd9\u6837\u4ece $1$ \u53cd\u63a8\u5230 $n$\uff0c\u7b54\u6848\u662f\u5c31\u662f $\\gcd$ \u5206\u522b\u4e3a $1$ \u5230 $n$ \u65f6\u7684\u671f\u671b\u957f\u5ea6\u7684\u5e73\u5747\u6570\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\sum_{i=1}^{n} ys_i^2)$\uff0c\u5176\u4e2d $ys_i$ \u8868\u793a $i$ \u7684\u7ea6\u6570\u4e2a\u6570\u3002\n\ncode\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mo=1e9+7;\nlong long n,p[100001];\nvector<long long> v[100001],f[100001];\ninline long long ksm(long long x,long long y){//\u5feb\u901f\u5e42 \n\tif (y==1) return x; if (y==0) return 1;\n\tlong long z=ksm(x,y/2);\n\tif (y&1) return z*z%mo*x%mo; return z*z%mo;\n}\ninline long long inv(long long x){return ksm(x,mo-2);}//\u8d39\u9a6c\u5c0f\u5b9a\u7406\u6c42\u4e58\u6cd5\u9006\u5143 \nint main(){\n\tios::sync_with_stdio(false);\n\tcin>>n;\n\tfor (int i=n;i;--i) for (int j=i;j<=n;j+=i) v[j].push_back(i),f[j].push_back(0);//v\u91cc\u5b58\u6709\u54ea\u4e9b\u7ea6\u6570\uff0cf\u91cc\u5b58\u6709\u591a\u5c11\u4e2a\u6570\u4f7f\u72b6\u6001\u8f6c\u79fb\u5230\u67d0\u4e2a\u7ea6\u6570 \n\tp[1]=1;//gcd\u4e3a1\u7684\u671f\u671b\u957f\u5ea6\u662f1\n\tfor (int i=2;i<=n;++i){\n\t\tfor (int j=0;j<v[i].size();++j){\n\t\t\tf[i][j]+=n/v[i][j];//\u52a0\u4e0a\u53ef\u80fd\u53ef\u4ee5\u901a\u8fc7\u5b83\u6765\u8f6c\u79fb\u7684\u6570 \n\t\t\tfor (int k=j+1;k<v[i].size();++k) if (v[i][j]%v[i][k]==0) f[i][k]-=f[i][j];//\u4e3a\u540e\u9762\u7684\u7ea6\u6570\u53bb\u6389\u4e0d\u53ef\u4ee5\u901a\u8fc7\u5b83\u6765\u8f6c\u79fb\u7684\u6570 \n\t\t}\n\t\tp[i]=n*inv(n-f[i][0]);//\u81ea\u5df1\u4f20\u7ed9\u540e\u9762\u7684\u671f\u671b\u957f\u5ea6 \n\t\tfor (int j=1;j<v[i].size();++j) p[i]=(p[i]+p[v[i][j]]*f[i][j]%mo*inv(n-f[i][0]))%mo;//\u52a0\u4e0a\u540e\u9762\u7684\u52a0\u6743\u5e73\u5747\u671f\u671b\u957f\u5ea6 \n\t}\n\tlong long ans=0;\n\tfor (int i=1;i<=n;++i) ans=(ans+p[i])%mo;//\u8ba1\u7b97\u6700\u7ec8\u7b54\u6848 \n\tcout<<ans*inv(n)%mo;\n\treturn 0;\n}\n```\n\n",
        "postTime": 1661499813,
        "uid": 351749,
        "name": "lanos212",
        "ccfLevel": 0,
        "title": "CF1139D Steps to One \u9898\u89e3"
    },
    {
        "content": "\n\u6211\u6709\u4e00\u4e2a\u4e0d\u4e00\u6837\u7684\u63a8\u5f0f\u5b50\u65b9\u6cd5\u3002\n\n\u5148\u5c06\u95ee\u9898\u8f6c\u6362\u4e00\u4e0b\uff0c\u5047\u8bbe\u5f53\u524d\u7684 gcd $x=p1^{k1}p2^{k2}\\cdots$\uff0c\u5373\u4e3a\u6c42\uff1a\n$$\nE(\\max(\\forall i,\\min(k_i)=0))\n$$\n\u4e0d\u59a8\u5c06\u6bcf\u4e2a\u8d28\u6570 $p$ \u770b\u6210\u4e00\u4e2a\u7269\u54c1\uff0c\n\n\u5047\u8bbe $x$ \u662f\u65b0\u63d2\u5165\u96c6\u5408\u7684\u6570\uff0c\u4e0d\u59a8\u5c06 $x$ \u770b\u6210\u4e00\u4e2a\u8fd9\u6837\u7684\u64cd\u4f5c\uff1a\n\n- \u5c06\u4e0e $x$ \u4e92\u8d28\u7684\u7269\u54c1\u53d6\u8d70\u3002\n\n\u73b0\u5728\u95ee\u9898\u8f6c\u5316\u6210\u4e86\u4e00\u4e2a\u53d6\u7269\u54c1\u7684\u7684\u95ee\u9898\uff0c\u5373\u4e3a\u6c42\uff1a\n$$\nE(\\max(S))\n$$\n\u90a3\u4e48\u76f4\u63a5 Min-max \u5bb9\u65a5\uff1a\n$$\nE(max(S)=\\sum_{T\\in S}(-1)^{|T|+1}E(min(T)=\\sum_{T\\in S}(-1)^{|T+1|}\\frac{1}{P(T)}\n$$\n\u8003\u8651\u5f53 $\\prod_{x\\in T}x>n$ \u65f6 $P(T)=1$\uff0c\u4e14 $x$ \u4e3a\u8d28\u6570\uff0c\u4e8e\u662f\u53ef\u4ee5\u5c06\u5f0f\u5b50\u6539\u5199:\n$$\nE(max(S))=\\sum_{T\\in S}(-1)^{|T|+1}-\\sum_{i=2}^n \\mu(i)+\\sum_{i=2}^n \\mu(i)\\lfloor\\frac{n}{i}\\rfloor=1-\\sum_{i=2}^n \\mu(i)+\\sum_{i=2}^n \\mu(i)\\lfloor\\frac{n}{i}\\rfloor\n$$\n\u7136\u540e\u95ee\u9898\u5c31\u89e3\u51b3\u4e86\u3002\n\n```\nint qmod(int x,int y)\n{\n\tint ans=1;\n\twhile(y)\n\t{\n\t\tif(y&1)(ans*=x)%=M;\n\t\t(x*=x)%=M;\n\t\ty>>=1;\n\t}\n\treturn ans;\n}\nsigned main()\n{\n\tn=read();\n\tint inv=qmod(n,M-2);\n\tfor(rg int i=2;i<=n;i++)\n\t{\n\t\tif(!vis[i])p[++len]=i,u[i]=1;\n\t\tfor(rg int j=1;j<=len&&p[j]*i<=n;j++)\n\t\t{\n\t\t\tvis[i*p[j]]=1;\n\t\t\tif(i%p[j]==0)break;\n\t\t\tu[i*p[j]]=-u[i];\n\t\t}\n\t\tsum=(sum-u[i]+M)%M;\n\t}\n\tfor(rg int i=2;i<=n;i++)\n\t{\n\t\tif(u[i]==0)continue;\n\t\tmul[i]=n*qmod(n-n/i,M-2);\n\t\tsum=(sum+u[i]*mul[i]%M+M)%M;\n\t}\n\twrite((sum+1)%M);\n}\n```\n\n",
        "postTime": 1611878165,
        "uid": 55201,
        "name": "clamee",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011CF1139D Step to One"
    },
    {
        "content": "\u9898\u610f\n=\n\n- \u7ed9\u5b9a\u6b63\u6574\u6570 $m$ \uff0c\u4f60\u6709\u4e00\u4e2a\u7a7a\u96c6\u5408 $a$\n\n- \u6bcf\u6b21\u4f60\u53ef\u4ee5\u7b49\u6982\u7387\u968f\u673a\u4e00\u4e2a $[1,m]$ \u5185\u7684\u6b63\u6574\u6570\u52a0\u5165\u96c6\u5408 $a$\n\n- \u52a0\u5165\u4e4b\u540e\uff0c\u5982\u679c\u96c6\u5408 $a$ \u5185\u6240\u6709\u6570\u7684 $\\gcd$ \u4e3a $1$ \u5219\u7ed3\u675f\u8fc7\u7a0b\uff0c\u5426\u5219\u7ee7\u7eed\u968f\u673a\n\n- \u6c42\u8fc7\u7a0b\u7ed3\u675f\u540e\u96c6\u5408 $a$ \u7684\u671f\u671b\u5927\u5c0f\n\n- $1\\le m\\le 100000$\n\n\u7b97\u6cd5\uff1a\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14 + \u671f\u671b DP\n=\n\n- \u72b6\u6001 $f[i]$ \u8868\u793a\u5f53\u524d\u96c6\u5408 $a$ \u7684 $\\gcd$ \u4e3a $i$ \u7684\u60c5\u51b5\u4e0b\uff0c\u671f\u671b\u52a0\u5165\u591a\u5c11\u4e2a\u6570\u4e4b\u540e\u8fd9\u4e2a $\\gcd$ \u53d8\u6210 $1$\n\n- \u663e\u7136\u6709\n\n- $$f[1]=0$$\n\n- $$f[i]=1+\\frac 1m\\sum_{j=1}^mf[\\gcd(i,j)]$$\n\n- \u53d1\u73b0 $\\gcd(i,j)$ \u7684\u53d6\u503c\u4e2a\u6570\u53ea\u6709 $i$ \u7684\u7ea6\u6570\u4e2a\u6570\uff0c\u6240\u4ee5\u628a\u679a\u4e3e $j$ \u6539\u6210\u679a\u4e3e $\\gcd(i,j)$\n\n- $$f[i]+1+\\frac 1m\\sum_{d|i}f[d]\\times cnt(d,i)$$\n\n- $cnt(d,i)$ \u8868\u793a $[1,m]$ \u5185\u6709\u591a\u5c11\u4e2a\u6570\u4e0e $i$ \u7684 $\\gcd$ \u7b49\u4e8e $d$\n\n- \u53e6\u8bbe $g(i,j)$ \u8868\u793a $[1,i]$ \u5185\u6709\u591a\u5c11\u4e2a\u6570\u4e0e $j$ \u4e92\u8d28\n\n- \u663e\u7136\u6709 $cnt(d,i)=g(\\lfloor\\frac md\\rfloor,\\frac id)$\n\n- \u6ce8\u610f\u5230 $\\sum_{i=1}^m\\frac mi=O(m\\log m)$\n\n- \u6240\u4ee5\u8003\u8651\u6c42\u51fa\u6240\u6709\u7684 $ij\\le m$ \uff0c\u5bf9\u5e94 $g(\\lfloor\\frac mi\\rfloor,j)$ \u7684\u503c\n\n- \u90a3\u4e48\u5bf9\u4e8e\u7ed9\u5b9a\u7684 $a\\ge b$ \uff0c\u5982\u4f55\u6c42\u6709\u591a\u5c11\u4e2a $1\\le i\\le a$ \u6ee1\u8db3 $\\gcd(i,b)=1$ \u5462\uff1f\n\n- \u5982\u679c\u4e0d\u662f\u6ee1\u8db3 $\\gcd(i,b)=1$ \u800c\u662f\u6ee1\u8db3 $x|\\gcd(i,b)$ \uff0c\u5219\u8fd9\u663e\u7136\u4e3a $\\lfloor\\frac ax\\rfloor$\n\n- \u6240\u4ee5\uff0c\u8003\u8651\u53cd\u6f14\uff0c\u5f97\n\n- $$g(a,b)=\\sum_{x|b}\\mu(x)\\lfloor\\frac ax\\rfloor$$\n\n- \u8bbe $D(x)$ \u4e3a $x$ \u7684\u7ea6\u6570\u4e2a\u6570\n\n- \u90a3\u4e48\u7ebf\u6027\u7b5b $\\mu$ \u4e4b\u540e\u5c31\u53ef\u4ee5\u5728 $O(D(b))$ \u7684\u65f6\u95f4\u5185\u6c42\u51fa $g(a,b)$\n\n- \u5bf9\u6bcf\u5bf9 $ij\\le m$ \u8fdb\u884c\u8ba1\u7b97\u7684\u603b\u590d\u6742\u5ea6\u4e3a\n\n- $$\\sum_{i=1}^m\\sum_{j=1}^{\\lfloor\\frac mi\\rfloor}D(j)=\\sum_{i=1}^m\\sum_{j=1}^{\\lfloor\\frac mi\\rfloor}\\lfloor\\frac{\\lfloor\\frac mi\\rfloor}j\\rfloor=\\sum_{i=1}^m\\lfloor\\frac mi\\rfloor\\log m=O(m\\log^2m)$$\n\n- \u56de\u5230\u8fd9\u4e2a\u8f6c\u79fb\n\n- $$f[i]+1+\\frac 1m\\sum_{d|i}f[d]\\times cnt(d,i)$$\n\n- \u53d1\u73b0 $d$ \u53ef\u4ee5\u7b49\u4e8e $i$ \uff0c\u5f97\u4e0d\u5230\u8f6c\u79fb\u7684\u76ee\u7684\uff0c\u6240\u4ee5\u505a\u4e00\u4e9b\u79fb\u9879\n\n- $$(1-\\frac{cnt(i,i)}m)f[i]=1+\\frac1m\\sum_{d|i,d\\ne i}f[d]\\times cnt(d,i)$$\n\n- $$f[i]=\\frac1{1-\\frac{cnt(i,i)}m}(1+\\frac1m\\sum_{d|i,d\\ne i}f[d]\\times cnt(d,i))$$\n\n- \u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u8f6c\u79fb\u4e86\n\n- \u8003\u8651\u5982\u4f55\u7b97\u7b54\u6848\n\n- \u7531\u4e8e\u7b2c\u4e00\u4e2a\u6570\u53ef\u4ee5\u968f\u4fbf\u53d6\uff0c\u6240\u4ee5\u7b54\u6848\u4e3a\n\n- $$\\frac1m\\sum_{i=1}^m(1+f[i])$$\n\n- \u770b\u5230\u67d0\u4eba\u7684\u63d0\u4ea4\u8bb0\u5f55\u91cc\u6709\u540a\u6253\u6807\u7b97\u7684\u975e DP \u505a\u6cd5\uff0c\u590d\u6742\u5ea6\u4eff\u4f5b\u662f $O(m\\log m)$ \uff0c\u6240\u4ee5\u6709\u66f4\u4f18\u505a\u6cd5\u6b22\u8fce\u63d0\u51fa\n\n\u4ee3\u7801\n=\n\n- \u8be5\u4ee3\u7801\u4e2d\u7684 $f[i]$ \u8868\u793a\u7684\u662f\u9898\u89e3\u4e2d\u7684 $f[i]$ \u52a0\u4e00\uff0c\u7b54\u6848\u4e3a $\\frac1m\\sum_{i=1}^mf[i]$ \uff0c\u8fb9\u754c\u4e3a $f[1]=1$ \uff0c\u89c1\u8c05\n\n\n```cpp\n#include <bits/stdc++.h>\n\n// 20030830\n\ninline int read()\n{\n\tint res = 0; bool bo = 0; char c;\n\twhile (((c = getchar()) < '0' || c > '9') && c != '-');\n\tif (c == '-') bo = 1; else res = c - 48;\n\twhile ((c = getchar()) >= '0' && c <= '9')\n\t\tres = (res << 3) + (res << 1) + (c - 48);\n\treturn bo ? ~res + 1 : res;\n}\n\nconst int N = 1e5 + 5, ZZQ = 1e9 + 7;\n\nint qpow(int a, int b)\n{\n\tint res = 1;\n\twhile (b)\n\t{\n\t\tif (b & 1) res = 1ll * res * a % ZZQ;\n\t\ta = 1ll * a * a % ZZQ;\n\t\tb >>= 1;\n\t}\n\treturn res;\n}\n\nint n, f[N], miu[N], tot, pri[N], inv[N], wt[N], num[N], res[N], ans;\nbool mark[N];\nstd::vector<int> divi[N], cont[N];\n\nint solve(int n, int m)\n{\n\tint tt = divi[m].size(), res = 0;\n\tfor (int i = 0; i < tt; i++)\n\t{\n\t\tint x = divi[m][i];\n\t\tres += miu[x] * (n / x);\n\t}\n\treturn res;\n}\n\nvoid sieve()\n{\n\tmark[0] = mark[miu[1] = 1] = 1;\n\tfor (int i = 2; i <= n; i++)\n\t{\n\t\tif (!mark[i]) miu[pri[++tot] = i] = -1;\n\t\tfor (int j = 1; j <= tot; j++)\n\t\t{\n\t\t\tif (1ll * i * pri[j] > n) break;\n\t\t\tmark[i * pri[j]] = 1;\n\t\t\tif (i % pri[j] == 0) break;\n\t\t\telse miu[i * pri[j]] = -miu[i];\n\t\t}\n\t}\n\tfor (int i = 1; i <= n; i++)\n\t\tfor (int j = i; j <= n; j += i)\n\t\t\tdivi[j].push_back(i);\n\tfor (int i = 1; i <= n;)\n\t{\n\t\tint nxt = n / (n / i);\n\t\tfor (int j = 1; j <= n / i; j++) res[j] = solve(n / i, j);\n\t\tfor (int j = i; j <= nxt; j++)\n\t\t\tfor (int k = j; k <= n; k += j)\n\t\t\t\tcont[k].push_back(res[k / j]);\n\t\ti = nxt + 1;\n\t}\n}\n\nint main()\n{\n\tn = read();\n\tinv[1] = 1;\n\tfor (int i = 2; i <= n; i++)\n\t\tinv[i] = 1ll * (ZZQ - ZZQ / i) * inv[ZZQ % i] % ZZQ;\n\tsieve();\n\tf[1] = 1;\n\tfor (int i = 2; i <= n; i++)\n\t{\n\t\tint tt = divi[i].size();\n\t\tfor (int j = 0; j < tt; j++)\n\t\t\twt[j + 1] = 1ll * inv[n] * cont[i][j] % ZZQ, num[j + 1] = divi[i][j];\n\t\tint qt = qpow((1 - wt[tt] + ZZQ) % ZZQ, ZZQ - 2);\n\t\tfor (int j = 1; j < tt; j++) wt[j] = 1ll * wt[j] * qt % ZZQ;\n\t\tf[i] = qt;\n\t\tfor (int j = 1; j < tt; j++)\n\t\t\tf[i] = (1ll * wt[j] * f[num[j]] + f[i]) % ZZQ;\n\t}\n\tfor (int i = 1; i <= n; i++)\n\t\tans = (1ll * inv[n] * f[i] + ans) % ZZQ;\n\tstd::cout << ans << std::endl;\n\treturn 0;\n}\n```",
        "postTime": 1553828812,
        "uid": 29936,
        "name": "xyz32768",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1139D \u3010Steps to One\u3011"
    },
    {
        "content": "[\u9898\u76ee](https://codeforces.com/problemset/problem/1139/D)\n\n\u6253$div2$\u7684\u65f6\u5019\u88ab\u8fd9\u9053\u9898\u9524\u81ea\u95ed\u4e86\n\n\u786e\u5b9e\u662f\u975e\u5e38\u795e\u4ed9\u7684\u7684\u4e00\u9053\u9898\n\n\u6211\u4eec\u53d1\u73b0\u4e0d\u80fd\u548c\u7ed3\u5c3e\u7684\u6570\u4e92\u8d28\uff0c\u7ed3\u5c3e\u7684\u6570\u4e5f\u4e0d\u4f1a\u548c\u524d\u9762\u7684\u6570\u4e92\u8d28\uff0c\u6240\u4ee5\u6211\u4eec\u53d1\u73b0\u6574\u4e2a\u5e8f\u5217\u90fd\u662f\u4e0d\u4e92\u8d28\u7684\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u628a\u8fd9\u4e2a\u5173\u7cfb\u62bd\u8c61\u6210\u4e00\u5f20\u62d3\u6251\u56fe\uff0c\u6bcf\u4e00\u4e2a\u6570$x$\u5411\u5176\u7ea6\u6570$k$\u8fde\u8fb9\uff0c\u8868\u793a\u6211\u4eec\u901a\u8fc7\u5728\u672b\u5c3e\u6dfb\u52a0\u4e00\u4e2a\u6570\u53ef\u4ee5\u4f7f\u5f97\u6574\u4e2a\u5e8f\u5217\u7684$gcd$\u4ece$x$\u53d8\u6210$k$\n\n\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u5f20$DAG$\uff0c\u6211\u4eec\u518d\u641e\u4e00\u4e2a\u865a\u70b9\uff0c\u5411\u6240\u6709\u6570\u8fde\u8fb9\uff0c\u8868\u793a\u8d77\u70b9\n\n\u6bcf\u4e00\u6761\u8fb9\u90fd\u6709\u4e00\u4e2a\u8d70\u7684\u6982\u7387\uff0c\u6211\u4eec\u5df2\u7ecf\u628a\u95ee\u9898\u8f6c\u5316\u6210\u4e86\u6c42\u4ece\u8d77\u70b9\u5230$1$\u7684\u671f\u671b\u8def\u5f84\u957f\u5ea6\n\n\u4ece\u8d77\u70b9\u8fde\u5411\u5404\u70b9\u7684\u8fb9\u6982\u7387\u663e\u7136\u662f$\\frac{1}{m}$\n\n\u4ece$x$\u8fde\u5411\u5176\u7ea6\u6570$k$\u7684\u8fb9\u7684\u6982\u7387\u663e\u7136\u662f$\\frac{\\sum_{i=1}^m[(x,i)=k]}{m}$\n\n\u73b0\u5728\u7684\u95ee\u9898\u8f6c\u5316\u6210\u4e86\u5982\u4f55\u6c42\n\n$$f(x,k)=\\sum_{i=1}^m[(x,i)=k]$$\n\n\u8003\u8651\u53cd\u6f14\n\n\u8bbe\n\n$$F(x,k)=\\sum_{i=1}^m[k|(x,i)]$$\n\n\u663e\u7136\u5b58\u5728\n\n$$F(x,k)=\\sum_{k|d}f(x,d)=\\lfloor\\frac{n}{k}\\rfloor\\times[k|x]$$\n\n\u76f4\u63a5\u53cd\u6f14\u53ef\u5f97\n\n$$f(x,k)=\\sum_{k|d}\\mu(\\frac{d}{k})F(x,d)$$\n\n\u6ce8\u610f\u8fd9\u91cc\u7684$d$\u4ec5\u80fd\u53d6$x$\u7684\u7ea6\u6570\n\n\u6211\u4eec\u6c42$f(x,k)$\u76f4\u63a5\u66b4\u529b\u5c31\u597d\u4e86\uff0c\u590d\u6742\u5ea6\u57fa\u4e8e$\\sum_{i=1}^md^2(i)$\uff0c\u4e0d\u662f\u5f88\u4f1a\u7b97\uff0c\u5927\u6982$O(nlog^2n)$\u5427\n\n\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff0c\u5c31\u662f\u6bcf\u4e00\u4e2a\u70b9\u81ea\u5df1\u80fd\u50cf\u81ea\u5df1\u8f6c\u79fb\uff0c\u770b\u8d77\u6765\u6ca1\u6709\u4ec0\u4e48\u529e\u6cd5\u76f4\u63a5$dp$\u4e86\u5440\n\n\u7167\u6837\u505a\u5c31\u597d\u4e86\n\n\u8bbe$dp_x$\u8868\u793a\u4ece$1$\u5230$x$\u7684\u671f\u671b\u8def\u5f84\u957f\u5ea6\n\n\u663e\u7136\n\n$$dp_x=\\frac{f(x,x)}{m}dp_x+1+\\sum_{k|x,k!=x}\\frac{f(x,k)}{m}dp_k$$\n\n\u79fb\u9879\u53ef\u5f97\n\n$$(1-\\frac{f(x,x)}{m})dp_x=1+\\sum_{k|x,k!=x}\\frac{f(x,k)}{m}dp_k$$\n\n\u6c42\u51fa\u53f3\u8fb9\u4e4b\u540e\u76f4\u63a5\u89e3\u65b9\u7a0b\u5c31\u597d\n\n\u4ee3\u7801\n\n```cpp\n#include<algorithm>\n#include<iostream>\n#include<cstring>\n#include<cstdio>\n#include<vector>\n#define re register\n#define LL long long\nconst int maxn=200005;\nconst int M=2500005;\nconst LL mod=1e9+7;\nint n,num;\nstd::vector<int> v[maxn];\nint f[maxn],mu[maxn],p[maxn>>1],head[maxn],vis[maxn];\nLL a[maxn],g[maxn],dp[maxn];\nstruct E{int v,nxt;LL w;}e[M];\ninline void add(int x,int y,LL w) {\n\te[++num].v=y;e[num].nxt=head[x];\n\thead[x]=num;e[num].w=w;\n}\ninline LL ksm(LL a,LL b) {LL S=1;while(b) {if(b&1) S=S*a%mod;b>>=1;a=a*a%mod;}return S;}\ninline LL dfs(int x) {\n\tif(vis[x]) return dp[x];\n\tvis[x]=1;\n\tfor(re int i=head[x];i;i=e[i].nxt) \n\t\tdp[x]=(dp[x]+e[i].w*(dfs(e[i].v)+1ll)%mod)%mod;\n\tif(a[x]) {\n\t\tdp[x]=(dp[x]+a[x])%mod;\n\t\tdp[x]=dp[x]*ksm((1-a[x]+mod)%mod,mod-2);\n\t\tdp[x]%=mod;\n\t}\n\treturn dp[x];\n}\nint main() {\n\tscanf(\"%d\",&n);\n\tfor(re int i=1;i<=n;i++)\n\t\tfor(re int j=i;j<=n;j+=i) v[j].push_back(i);\n\tf[1]=mu[1]=1;\n\tfor(re int i=2;i<=n;i++) {\n\t\tif(!f[i]) p[++p[0]]=i,mu[i]=-1;\n\t\tfor(re int j=1;j<=p[0]&&p[j]*i<=n;j++) {\n\t\t\tf[p[j]*i]=1;\n\t\t\tif(i%p[j]==0) break;\n\t\t\tmu[p[j]*i]=-1*mu[i];\n\t\t}\n\t}\n\tLL inv=ksm(n,mod-2);\n\tfor(re int i=1;i<=n;i++) {\n\t\tfor(re int j=0;j<v[i].size();j++) {\n\t\t\tint now=0,x=v[i][j];\n\t\t\tif(v[i][j]==i) continue;\n\t\t\tfor(re int k=j;k<v[i].size();k++) {\n\t\t\t\tint t=v[i][k];\n\t\t\t\tif(t%x==0) now+=mu[t/x]*(n/t);\n\t\t\t}\n\t\t\tadd(i,x,now*inv%mod);\n\t\t}\n\t\ta[i]=n/i;\n\t\ta[i]=(a[i]*inv)%mod;\n\t}\n\tfor(re int i=1;i<=n;i++) add(0,i,inv);\n\tvis[1]=0;\n\tstd::cout<<dfs(0);\n\treturn 0;\n}\n```",
        "postTime": 1553502207,
        "uid": 35178,
        "name": "asuldb",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1139D \u3010Steps to One\u3011"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u79cd\u590d\u6742\u5ea6\u8f83\u52a3\u4f46\u6613\u4e8e\u7406\u89e3\u7684\u505a\u6cd5\u3002\n\n\u8003\u8651\u679a\u4e3e\u52a0\u5165\u6700\u540e\u4e00\u4e2a\u6570\u4e4b\u524d\uff0c\u6240\u6709\u6570\u7684 $\\gcd$\u3002\u5148\u5355\u72ec\u8ba8\u8bba\u76f4\u63a5\u52a0 $1$ \u7684\u60c5\u51b5\uff0c\u8d21\u732e\u671f\u671b\u957f\u5ea6 $\\frac{1}{m}$\u3002\n\n\u5269\u4e0b\u7684\u7b54\u6848\u8bb0\u4e3a $ans$\u3002\u6709\uff1a\n\n$$\\begin{aligned}ans&=\\sum\\limits_{i=1}^{+\\infty}\\frac{i+1}{m^{i+1}}\\sum\\limits_{j=2}^m(\\sum\\limits_{(a_1,\\cdots ,a_i)}[\\gcd(a_1,\\cdots,a_i)=j])\\times(\\sum\\limits_{k=1}^m[\\gcd(k,j)=1])\\end{aligned}$$\n\n\u8bbe $g(j)=\\sum\\limits_{k=1}^m[\\gcd(k,j)=1]$\uff0c\u76f4\u63a5\u53cd\u6f14\u7136\u540e\u7b5b\u51fa\u3002\n\n$$\\begin{aligned}ans&=\\sum\\limits_{i=1}^{+\\infty}\\frac{i+1}{m^{i+1}}\\sum\\limits_{j=2}^m g(j)\\sum\\limits_{(a_1,\\cdots ,a_i)}\\sum\\limits_{d\\mid\\gcd(a_1/j,\\cdots,a_i/j)}\\mu(d)    \\\\&=\\sum\\limits_{j=2}^{m}g(j)\\sum_{d=1}^{\\left \\lfloor\\frac{m}{j} \\right \\rfloor}\\mu(d)\\sum\\limits_{(a_1,\\cdots,a_i)}[\\forall k,dj\\mid a_k]\\frac{i+1}{m^{i+1}}\\\\&=\\sum\\limits_{j=2}^{m}g(j)\\sum_{d=1}^{\\left \\lfloor\\frac{m}{j} \\right \\rfloor}\\mu(d)\\sum\\limits_{i=1}^{+\\infty}\\left \\lfloor \\frac{m}{dj} \\right \\rfloor^i\\frac {i+1} {m^{i+1}} \\\\&=\\sum\\limits_{j=2}^{m}g(j)f(\\left \\lfloor \\frac{m}{j}\\right \\rfloor) \\end{aligned}$$\n\n\u5176\u4e2d $f(x)=\\sum\\limits_{d=1}^x \\mu(d)\\sum\\limits_{i=1}^{+\\infty}(\\frac{\\left\\lfloor\\frac{x}{d}\\right\\rfloor}{m})^i(i+1)$\u3002\u540e\u4e00\u4e2a\u548c\u5f0f\u5c31\u662f\u7ecf\u5178\u7684\u7b49\u5dee\u4e58\u7b49\u6bd4\u95ee\u9898\uff0c\u5316\u7b80\u540e\u662f\u5173\u4e8e $\\left \\lfloor\\frac{x}{d}\\right \\rfloor$ \u7684\u5f0f\u5b50\uff0c\u6574\u9664\u5206\u5757\u6c42\u51fa\u5373\u53ef\u3002\n\n---\n\n\uff0820211130 \u66f4\u65b0\uff09\n\n\u6ce8\u610f\u5230 $f$ \u7684\u53d6\u503c\u53ea\u6709 $\\sqrt m$ \u79cd\uff0c\u6c42\u7b54\u6848\u53ef\u4ee5 $\\mathcal{O}(m)$\u3002\u518d\u8003\u8651\u9884\u5904\u7406\uff0c\u603b\u7684\u590d\u6742\u5ea6\u5219\u662f $\\mathcal{O}(m\\log m)$\u3002\u9884\u5904\u7406\u53ef\u80fd\u53ef\u4ee5\u4f18\u5316\u5230\u7ebf\u6027\uff0c\u4e0d\u8fc7\u6211\u4e0d\u4f1a\u3002",
        "postTime": 1637998435,
        "uid": 34372,
        "name": "_wkjzyc",
        "ccfLevel": 0,
        "title": "CF1139D"
    },
    {
        "content": "dp\u662f\u5565\u554a\uff0c\u76f4\u63a5\u7b97\u554a\n\n$$\n\\begin{aligned}E(X)&=\\sum_{i\\geq 1}P(X=i)i\\\\&=\\sum_{i\\geq 1}P(X=i)\\sum_{j=1}^i1\\\\&=\\sum_{j\\geq 1}\\sum_{i\\geq j}P(X=i)\\\\&=\\sum_{j\\geq 1}P(X\\geq j)\\\\&=1+\\sum_{j\\geq 1}P(X>j)\\\\&=1+\\sum_{j\\geq 1}(1-P(\\gcd(a_1,a_2,\\cdots,a_j)=1))\\\\&=1+\\sum_{j\\geq 1}\\frac {m^j-\\sum_{k\\geq 1}\\mu(k)\\lfloor\\frac{m}{k}\\rfloor^j}{m^j}\\\\&=1-\\sum_{k\\geq 2}\\mu(k)\\sum_{j\\geq 1}\\left(\\frac{\\lfloor\\frac{m}{k}\\rfloor}{m^j}\\right)^j\\\\&=1-\\sum_{k\\geq 2}\\mu(k)\\frac{\\lfloor\\frac{m}{k}\\rfloor}{m-\\lfloor\\frac{m}{k}\\rfloor}\\end{aligned}\n$$\n\n\u7ba1\u7406\u89c9\u5f97\u8bf4\u660e\u592a\u5c11\u6ca1\u8fc7\uff0c\u4e8e\u662f\u6211\u6765\u628a\u5f0f\u5b50\u7ffb\u8bd1\u6210\u4eba\u8bdd\n\n\u7b2c\u4e00\u6b65\u662f\u671f\u671b\u7684\u5b9a\u4e49\n\n\u7b2c\u4e8c\u4e09\u56db\u4e94\u6b65\u597d\u50cf\u770b\u5f0f\u5b50\u5c31\u6bd4\u8f83\u663e\u7136\n\n\u7b2c\u516d\u6b65\u6309\u7167\u9898\u610f\uff0c\u957f\u5ea6\u5927\u4e8e $j$ \u7684\u6982\u7387\u5c31\u662f\u524d $j$ \u4e2a\u4e0d\u4e92\u8d28\u7684\u6982\u7387\uff0c\u90a3\u4e48\u6211\u4eec\u7528 $1$ \u51cf\u53bb\u90fd\u4e92\u8d28\u7684\u6982\u7387\n\n\u5269\u4e0b\u7684\u90e8\u5206\u662f\u4e00\u4e2a\u5f88\u7b80\u5355\u7684\u83ab\u53cd\n\n\u53ef\u4ee5 $O(m^{2/3})$ \u751a\u81f3 $O(m)$ \u8ba1\u7b97(\u96fe)\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\nconst int mod=1000000007,N=2e5;\nint mu[N],inv[N],n,prime[N],p[N],cnt;\nint main()\n{\n    scanf(\"%d\",&n);\n    mu[1]=inv[1]=1;\n    for(int i=2;i<=n;i++)\n    {\n        inv[i]=1ll*inv[mod%i]*(mod-mod/i)%mod;\n        if(!p[i])mu[i]=-1,prime[++cnt]=i;\n        for(int j=1;j<=cnt&&i*prime[j]<=n;j++)\n        {\n            int x=i*prime[j];p[x]=1;\n            if(i%prime[j])mu[x]=-mu[i];\n            else break;\n        }\n    }\n    int ans=1;\n    for(int i=2;i<=n;i++)ans=(ans-mu[i]*1ll*(n/i)*inv[n-n/i])%mod;\n    cout<<(ans+mod)%mod<<endl;\n}\n```",
        "postTime": 1590921168,
        "uid": 22136,
        "name": "qwaszx",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1139D \u3010Steps to One\u3011"
    },
    {
        "content": "\u5728\u6211\u7684\u535a\u5ba2\u4e0a\u770b\u6548\u679c\u66f4\u4f73\uff1a[\u70b9\u8fd9\u91cc](https://www.cnblogs.com/1000Suns/p/10656969.html)\n\nstm\u8fd9\u662fdiv2\u7684D\u9898\u2026\u2026\u6211\u8981\u5bf9\u4e0d\u4f4f\u6211\u8fd9\u4e2a\u7d2b\u540d\u4e86\u2026\u2026\n\n---\n\u9996\u5148\u5f88\u5bb9\u6613\u60f3\u5230DP\uff1a$f_i$ \u8868\u793a\u76ee\u524d\u7684 $\\gcd$ \u4e3a $i$\uff0c\u671f\u671b\u8fd8\u8981\u591a\u5c11\u6b21\u624d\u80fd\u7ed3\u675f\u3002\n\n\u90a3\u4e48\u6709 $f_1=0$\u3002\n\n\u8f6c\u79fb\uff0c\u76f4\u63a5\u679a\u4e3e\u5373\u53ef\uff1a$f_i=1+\\dfrac{1}{m}\\sum\\limits^m_{j=1}f_{\\gcd(i,j)}$\u3002\n\n\u5982\u679c\u51fa\u73b0 $\\gcd(i,j)=i$\uff08\u4e5f\u5c31\u662f $i|j$\uff09\uff0c\u90a3\u4e48\u628a\u8fd9\u79cd\u60c5\u51b5\u7279\u6b8a\u5224\u65ad\uff0c\u90a3\u4e48\u89e3\u4e2a\u65b9\u7a0b\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$$f_i=\\dfrac{1+\\dfrac{1}{m}\\sum\\limits^m_{j=1,i\\nmid j}f_{\\gcd(i,j)}}{1-\\lfloor\\frac{m}{i}\\rfloor}$$\n\n\u7b54\u6848\u4e3a $\\dfrac{1}{m}\\sum\\limits^m_{i=1}(f_i+1)$\u3002\n\n\u8fd9\u662f $O(m^2\\log m)$ \u7684\u3002\u6211\u5f53\u65f6\u5c31\u662f\u5728\u8fd9\u91cc\u5361\u4f4f\u4e86\uff0c\u73b0\u5728\u611f\u89c9\u81ea\u5df1\u662f\u4e2azz\u2026\u2026\n\n\u6211\u4eec\u5957\u8def\u5730\u679a\u4e3e $\\gcd$\uff0c\u8bbe $c(i,j)$ \u8868\u793a\u6709\u591a\u5c11\u4e2a $1\\le x\\le m$ \u6ee1\u8db3 $\\gcd(i,x)=j$\u3002\u90a3\u4e48\u5c31\u6709\uff1a\n\n$$f_i=\\dfrac{1+\\dfrac{1}{m}\\sum\\limits_{j|i}f_{j}c(i,j)}{1-\\lfloor\\frac{m}{i}\\rfloor}$$\n\n\u63a5\u4e0b\u6765\u5c31\u8981\u8003\u8651\u6c42 $c(i,j)(j|i)$\u3002\n\n$$c(i,j)=\\sum\\limits^m_{x=1}[\\gcd(i,x)=j]$$\n\n$$c(i,j)=\\sum\\limits^m_{j|x}[\\gcd(\\frac{i}{j},\\frac{x}{j})=1]$$\n\n$$c(i,j)=\\sum\\limits^{\\lfloor\\frac{m}{j}\\rfloor}_{x=1}[\\gcd(\\frac{i}{j},x)=1]$$\n\n\u63a5\u4e0b\u6765\u6709\u4e24\u6761\u8def\u53ef\u8d70\uff1a\u5206\u89e3\u8d28\u56e0\u6570\uff08\u5b98\u65b9\u505a\u6cd5\uff09\u548c\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff08\u5927\u4f17\u505a\u6cd5\uff09\u3002\n\n\u90a3\u6211\u4eec\u5148\u6765\u770b\u770b\u5927\u4f17\u505a\u6cd5\u3002\n\n---\n### \u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff1a\n$$c(i,j)=\\sum\\limits^{\\lfloor\\frac{m}{j}\\rfloor}_{x=1}\\sum\\limits_{d|\\gcd(\\frac{i}{j},x)}\\mu(d)$$\n\n$$c(i,j)=\\sum\\limits_{d|\\frac{i}{j}}\\mu(d)\\sum\\limits^{\\lfloor\\frac{m}{j}\\rfloor}_{d|x}1$$\n\n$$c(i,j)=\\sum\\limits_{d|\\frac{i}{j}}\\mu(d)\\lfloor\\dfrac{m}{jd}\\rfloor$$\n\n\u6b64\u65f6\u6c42 $c(i,j)$ \u590d\u6742\u5ea6\u4e3a $O(\\sqrt{\\frac{i}{j}})$\u3002\n\n\u603b\u590d\u6742\u5ea6\u4e3a $O(\\sum\\limits^m_{i=2}\\sum\\limits_{j|i}\\sqrt{\\frac{i}{j}})=O(\\sum\\limits^m_{i=2}\\sum\\limits_{j|i}\\sqrt{j})=O(\\sum\\limits^m_{j=1}\\sqrt{j}\\lfloor\\frac{m}{j}\\rfloor)\\approx O(m\\int^m_1j^{-\\frac{1}{2}}\\mathrm{d}j)=O(m\\sqrt{m})$\u3002\n\n---\n### \u5206\u89e3\u8d28\u56e0\u6570\uff1a\n\u6211\u4eec\u4e0d\u59a8\u4fee\u6539\u4e00\u4e0b\u5b9a\u4e49\uff08\u53ea\u662f\u4e3a\u4e86\u65b9\u4fbf\uff09\uff1a\u4ee4 $c(x,y)=\\sum\\limits^y_{i=1}[\\gcd(i,x)=1]$\u3002\u90a3\u4e48\u539f\u6765\u7684 $c(i,j)$ \u5c31\u53d8\u6210\u4e86\u73b0\u5728\u7684 $c(\\frac{i}{j},\\lfloor\\frac{m}{j}\\rfloor)$\u3002\n\n\u4e5f\u5c31\u662f\u8981 $i$ \u548c $x$ \u7684\u8d28\u56e0\u5b50\u96c6\u5408\u6ca1\u6709\u4ea4\u96c6\u3002\n\n\u6211\u4eec\u4ece\u53cd\u5411\u8003\u8651\uff0c\u8003\u8651\u4e0e $x$ \u7684\u8d28\u56e0\u5b50\u6709\u4ea4\u96c6\u7684 $i$ \u7684\u4e2a\u6570\u3002\n\n\u5148\u5bf9 $x$ \u8d28\u56e0\u6570\u5206\u89e3\uff0c\u8bbe\u5206\u89e3\u51fa\u7684\u4e0d\u540c\u8d28\u56e0\u5b50\u6709 $p_1,p_2\\cdots p_k$\u3002\u90a3\u4e48\u6709 $k\\le 6$\u3002\n\n\u90a3\u4e48\u4e0e\u96c6\u5408 $S$ \u6709\u4ea4\u7684 $i$ \u7684\u4e2a\u6570\u5c31\u662f $\\lfloor\\frac{y}{\\prod S_i}\\rfloor$\u3002\n\n\u7136\u540e\u8fd8\u8981\u518d\u5bb9\u65a5\u4e00\u4e0b\u3002\u90a3\u4e48\u603b\u7684\u5c31\u662f\uff1a\n\n$$c(x,y)=y-\\sum\\limits_{S\\in x_{pr},S\\ne\\varnothing}(-1)^{|S|+1}\\lfloor\\frac{y}{\\prod S_i}\\rfloor$$\n\n\u5f53\u7136\u4e5f\u53ef\u4ee5\u5199\u6210\uff1a\uff08\u8fd9\u662f\u4ee3\u7801\u4e2d\u7684\u5199\u6cd5\uff09\n\n$$c(x,y)=\\sum\\limits_{S\\in x_{pr}}(-1)^{|S|}\\lfloor\\frac{y}{\\prod S_i}\\rfloor$$\n\n\u6b64\u65f6\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\n\n$$f_i=\\dfrac{1+\\dfrac{1}{m}\\sum\\limits_{j|i}f_{j}c(\\frac{i}{j},\\lfloor\\frac{m}{j}\\rfloor)}{1-\\lfloor\\frac{m}{i}\\rfloor}$$\n\n\u8fd9\u4e2a\u53ef\u4ee5\u505a\u5230 $O(2^k+\\sqrt{x})$\u3002\u6ce8\u610f\u6700\u597d\u7528DFS\uff0c\u4e0d\u8981\u7528\u4e8c\u8fdb\u5236\u679a\u4e3e\uff0c\u5426\u5219\u4f1a\u9000\u5316\u4e3a $O(2^k\\times k+\\sqrt{x})$\u3002\uff08\u867d\u7136\u4e5f\u80fd\u8fc7\uff09\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u662f $O(m\\sqrt{m})$\u3002\n\n---\n\u7531\u4e8e\u5927\u591a\u6570\u4eba\u5199\u7684\u90fd\u662f\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u6211\u5c31\u5199\u4e00\u53d1\u8d28\u56e0\u6570\u5206\u89e3\u7ed9\u5927\u5bb6\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=100010,mod=1000000007;\n#define FOR(i,a,b) for(int i=(a);i<=(b);i++)\n#define ROF(i,a,b) for(int i=(a);i>=(b);i--)\n#define MEM(x,v) memset(x,v,sizeof(x))\ninline int read(){\n    char ch=getchar();int x=0,f=0;\n    while(ch<'0' || ch>'9') f|=ch=='-',ch=getchar();\n    while(ch>='0' && ch<='9') x=x*10+ch-'0',ch=getchar();\n    return f?-x:x;\n}\nint m,f[maxn],fac[7],fl;\ninline int qpow(int a,int b){\n    int ans=1;\n    for(;b;b>>=1,a=1ll*a*a%mod) if(b&1) ans=1ll*ans*a%mod;\n    return ans;\n}\nint dfs(int dep,int pro,int sgn,int up){    //dep\u8868\u793a\u6b63\u5728\u679a\u4e3e\u7b2c\u51e0\u4e2a\u8d28\u56e0\u5b50\uff0cpro\u8868\u793aS\u7684\u4e58\u79ef\uff0csgn\u8868\u793a\u5bb9\u65a5\u7cfb\u6570\uff081\u6216-1\uff09\uff0cup\u8868\u793a\u4e0a\u754c\n    if(dep>fl) return up/pro*sgn;\n    else return dfs(dep+1,pro,sgn,up)+dfs(dep+1,pro*fac[dep],-sgn,up);\n}\nint cnt(int x,int y){\n    fl=0;\n    for(int i=2;i*i<=x;i++)\n        if(x%i==0){\n            fac[++fl]=i;\n            while(x%i==0) x/=i;\n        }\n    if(x>1) fac[++fl]=x;\n    return dfs(1,1,1,y);\n}\nint main(){\n    m=read();int inv=qpow(m,mod-2);\n    f[1]=0;\n    FOR(i,1,m){\n        if(i!=1){    //\u6700\u540e\u8981\u9664\u4ee5m\uff0c\u52a01\u518d\u9664\u4ee51-m/i\n            f[i]=1ll*f[i]*inv%mod;\n            f[i]=(f[i]+1)%mod;\n            f[i]=1ll*f[i]*qpow((1-1ll*(m/i)*inv%mod+mod)%mod,mod-2)%mod;\n        }\n        FOR(j,2,m/i) f[i*j]=(f[i*j]+1ll*f[i]*cnt(j,m/i))%mod;\n        //\u679a\u4e3ei\u7684\u500d\u6570\uff0cf[i*j]+=f[i]*c((i*j)/i,m/i)\n    }\n    int ans=0;\n    FOR(i,1,m) ans=(ans+f[i]+1)%mod;    //\u7d2f\u52a0\u7b54\u6848\n    ans=1ll*ans*inv%mod;\n    printf(\"%d\\n\",ans);\n}\n```",
        "postTime": 1554383948,
        "uid": 72118,
        "name": "AThousandSuns",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1139D \u3010Steps to One\u3011"
    },
    {
        "content": "\u53cd\u6f14\u5957 DP \u7684\u597d\u9898\uff08\u4e0d\u7528\u53cd\u6f14\u8c8c\u4f3c\u4e5f\u80fd\u505a \u53c2\u8003[\u5b98\u65b9 Tutorial](https://codeforces.com/blog/entry/66101)\n\n\u5728\u6211\u7684\u535a\u5ba2\u67e5\u770b\uff1a[**\u4f20\u9001\u95e8**](http://www.wjyyy.top/3403.html)\n\n\u56e0\u4e3a\u6bcf\u4e00\u6b65\u4e0d\u4f1a\u8ba9\u5df2\u7ecf\u9009\u4e86\u7684\u5143\u7d20\u7684 $\\gcd$ \u548c\u53d8\u5927\uff0c\u56e0\u6b64\u8ba4\u4e3a\u662f\u4e00\u4e2a\u9664\u81ea\u73af\u5916\u7684\u6709\u5411\u65e0\u73af\u56fe\u3002\u5bf9\u4e8e\u81ea\u73af\u6211\u4eec\u5f88\u597d\u5904\u7406\uff0c\u6240\u4ee5\u628a\u5b83\u770b\u6210\u662f\u4e00\u9053\u671f\u671b DP\u3002\n\n\u4ee4 $f[i]$ \u8868\u793a\u5f53\u524d\u7684 $\\gcd$ \u548c\u4e3a $i$\uff0c\u5230 $\\gcd$ \u548c\u4e3a $1$ \u7684\u72b6\u6001\u7684\u671f\u671b\u6b65\u6570\u3002\u56e0\u6b64\u628a\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5199\u51fa\u6765 \n$$\nf[i]=1+\\frac{\\sum_{j=1}^m f[\\gcd(i,j)]}m\n$$\n\u8fd9\u6837\u7684\u8f6c\u79fb\u662f $O(m^2)$ \u7684\u3002\u4f46\u662f\u6211\u4eec\u53d1\u73b0\uff0c\u5bf9\u4e8e\u5f88\u591a $j$\uff0c$\\gcd(i,j)$ \u90fd\u662f\u76f8\u7b49\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u628a\u8fd9\u6837\u7684\u6570\u6574\u5408\u5230\u4e00\u8d77\u3002\n\n\u4ee4 $F(n)$ \u8868\u793a $1\\sim m$ \u4e2d\u6709\u591a\u5c11\u4e2a\u6570 $i$ \u6ee1\u8db3 $\\gcd(x,i)=n$\uff0c\u5176\u4e2d\u89c6 $x$ \u4e3a\u5e38\u6570\u3002\n\n\u5219\u8ba1\u7b97 $f[i]$ \u5c31\u8f6c\u5316\u4e3a\u4e86\n$$f[i]=1+\\frac{\\sum_{d|i}f[d]\\times F(d)}n,x=i$$\n\u8fd9\u6837\u5dee\u4e0d\u591a\u5c31\u628a\u679a\u4e3e\u4f18\u5316\u5230\u4e86 $\\log n$ \u7684 $d|i$\u3002\n\n\u8003\u8651\u600e\u4e48\u8ba1\u7b97 $F(n)$\n$$F(n)=\\sum_{i=1}^m[\\gcd(x,i)=n]$$\n\u4ee4 $G(n)=\\sum_{n|d}F(d)$\uff0c\u5219\n$$\\begin{aligned}G(n)&=\\sum_{n|d}F(d)\\\\&=\\sum_{n|d}\\sum_{i=1}^m[\\gcd(x,i)=d]\\\\&=\\sum_{i=1}^m[n|\\gcd(x,i)]\\\\?&=\\sum_{i=1}^{\\left\\lfloor\\frac mn\\right\\rfloor}\\left[1|\\gcd\\left(\\frac xn,i\\right)\\right]\\end{aligned}$$\n\u5b9e\u9645\u4e0a\u8fd9\u6837\u662f\u6709\u95ee\u9898\u7684\uff0c\u56e0\u4e3a\uff08\u5728\u540e\u9762\uff09\u65e0\u6cd5\u4fdd\u8bc1 $n|x$\uff0c\u6b64\u65f6 $G(n)$ \u5c31\u4e00\u5b9a\u4e3a $0$ \u4e86\u3002\n\n\u6211\u4eec\u518d\u591a\u5316\u4e00\u6b65\uff1a\n$$\\begin{aligned}G(n)&=\\sum_{i=1}^{\\left\\lfloor\\frac mn\\right\\rfloor}\\left[1|\\gcd\\left(\\frac xn,i\\right)\\right][n|x]\\\\&=\\left\\lfloor\\frac mn\\right\\rfloor\\cdot[n|x]\\end{aligned}$$\n\u6839\u636e $G(n)=\\sum_{n|d}F(d)$\uff0c\u6211\u4eec\u53cd\u6f14\u5230 $F$\uff0c\u5f97\n$$\\begin{aligned}F(n)&=\\sum_{n|d}\\mu\\left(\\frac dn\\right)G(d)\\\\&=\\sum_{i=1}^{\\left\\lfloor\\frac mn\\right\\rfloor}\\mu(i)G(ni)\\\\&=\\sum_{i=1}^{\\left\\lfloor\\frac mn\\right\\rfloor}\\mu(i)\\left\\lfloor\\frac{m}{ni}\\right\\rfloor[(ni)|x]\\end{aligned}$$\n\u6211\u4eec\u53d1\u73b0\u540e\u9762\u7684\u5e03\u5c14\u8868\u8fbe\u5f0f\u53ef\u4ee5\u5f53\u4f5c\u6761\u4ef6\u3002\u539f\u672c\u7684\u6761\u4ef6\u672c\u6765\u5c31\u662f $\\to +\\infty$ \u7684\uff0c\u53ea\u4e0d\u8fc7\u8d85\u8fc7\u4e86 $\\left\\lfloor\\frac mn\\right\\rfloor$ \u6ca1\u6709\u610f\u4e49\u3002\u56e0\u6b64\u76f4\u63a5\u628a\u6761\u4ef6\u6362\u6210 $[(ni)|x]$ \u5373\u53ef\u3002\u53c8\u56e0\u4e3a $n|x$ \u5728\u4e0a\u9762\u7684\u679a\u4e3e\u8fc7\u7a0b\u4e2d\u662f\u6210\u7acb\u7684\uff0c\u540c\u65f6\u53ef\u4ee5\u8f6c\u5316\u4e3a $\\left[i|\\frac xn\\right]$\u3002\n$$F(n)=\\sum_{i|\\frac xn}\\mu(i)\\left\\lfloor\\frac{m}{ni}\\right\\rfloor$$\n\u8fd9\u6837\u7684\u4e00\u6b21\u679a\u4e3e\u662f $O\\left(d\\left(\\frac xn\\right)\\right)$ \u7684\uff0c\u7531\u4e8e $1\\sim m$ \u7684\u7ea6\u6570\u4e2a\u6570\u548c\u5747\u644a\u662f $O(\\log m)$ \u7684\uff0c\u5176\u4e2d\u6700\u591a\u7684\u6709 $128$ \u4e2a\u7ea6\u6570\uff0c\u4f46\u662f\u8fd9\u6837\u7684\u6570\u80af\u5b9a\u4e0d\u662f\u5f88\u591a\uff0c\u5e76\u4e14\u5176\u4e2d\u5f88\u591a\u88ab\u679a\u4e3e\u5230\u7684\u6570\u90fd\u662f\u8d28\u56e0\u6570\uff0c\u8fed\u4ee3\u4e00\u4e0b\u5e76\u4e0d\u4f1a\u9020\u6210\u5f88\u5927\u7684\u590d\u6742\u5ea6\u3002\n\n\u7136\u540e\u6211\u4eec\u9700\u8981\u518d\u628a\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u7a0d\u5fae\u8f6c\u5316\u4e00\u4e0b\uff0c\u628a $f[i]$ \u79fb\u5230\u5de6\u8fb9\n$$\\begin{aligned}f[i]&=1+\\frac{\\sum_{d|i,d<i}f[d]\\times F(d)+f[i]\\times F(i)}n,x=i\\\\\\frac{n-F(i)}{n}\\cdot f[i]&=1+\\frac{\\sum_{d|i,d\\neq i}f[d]\\times F(d)}n,x=i\\\\f[i]&=\\frac{n+\\sum_{d|i,d<i}f[d]\\times F(d)}{n-F(i)},x=i\\end{aligned}$$\n\u5c31\u5f97\u5230\u4e86\u771f\u6b63\u7684\u8f6c\u79fb\u65b9\u7a0b\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(m\\log^2 m)$\u3002\n\n## Code\uff1a\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<vector>\n#define ll long long\n#define p 1000000007\nusing std::vector;\nvector<int> v[100100];//\u7ea6\u6570\u7528 vector \u5b58\u4e00\u4e0b\uff0c\u6bcf\u6b21 \u221am \u679a\u4e3e\u4e0d\u662f\u5f88\u7a33\nll qpow(ll x,ll y)\n{\n    ll ans=1;\n    while(y)\n    {\n        if(y&1)\n            ans=ans*x%p;\n        x=x*x%p;\n        y>>=1;\n    }\n    return ans;\n}\nbool is[100100];\nint pri[100100],mu[100100],cnt=0;\nll f[100100];\nint n;\nint calc(int x,int y)//1~n \u4e2d gcd(x,i)=y \u7684\u6570\u7684\u4e2a\u6570\n{\n    int g=x/y,ans=0;\n    for(int i=0;i<v[g].size();++i)\n        ans+=mu[v[g][i]]*(n/v[g][i]/y);\n    return ans;\n}\nint main()\n{\n    scanf(\"%d\",&n);\n    f[1]=1;\n    mu[1]=1;\n    for(int i=2;i<=n;++i)\n    {\n        if(!is[i])\n        {\n            pri[++cnt]=i;\n            mu[i]=-1;\n        }\n        for(int j=1;j<=cnt&&i*pri[j]<=n;++j)\n        {\n            is[i*pri[j]]=1;\n            if(i%pri[j])\n                mu[i*pri[j]]=-mu[i];\n            else\n            {\n                mu[i*pri[j]]=0;\n                break;\n            }\n        }\n    }\n    for(int i=1;i<=n;++i)\n        for(int j=i;j<=n;j+=i)\n            v[j].push_back(i);\n    ll ans=1,inv=qpow(n,p-2);\n    for(int i=2;i<=n;++i)\n    {\n        for(int j=0;j<v[i].size()-1;++j)\n            f[i]=(f[i]+calc(i,v[i][j])*f[v[i][j]]%p)%p;\n        f[i]=(f[i]*inv+1)%p;\n        ll g=n-calc(i,i);\n        f[i]=f[i]*n%p*qpow(g,p-2)%p;\n        ans=(ans+f[i])%p;\n    }\n    printf(\"%lld\\n\",ans*qpow(n,p-2)%p);\n    return 0;\n}\n```\n",
        "postTime": 1553489919,
        "uid": 63539,
        "name": "wjyyy",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1139D \u3010Steps to One\u3011"
    },
    {
        "content": "\u7ed9\u4e00\u4e2a\u6570\u5217\uff0c\u6bcf\u6b21\u968f\u673a\u9009\u4e00\u4e2a $1$ \u5230 $m$ \u4e4b\u95f4\u7684\u6570\u52a0\u5728\u6570\u5217\u672b\u5c3e\uff0c\u6570\u5217\u4e2d\u6240\u6709\u6570\u7684 $\\gcd=1$ \u65f6\u505c\u6b62\uff0c\u6c42\u671f\u671b\u957f\u5ea6 $\\bmod 10^9+7$\u3002\n\n$1 \\leq m \\leq 10^5$\u3002\n\n\u83ab\u53cd\u795e\u4ed9\u9898\u3002\n\n\u5f00\u59cb\u5c3d\u91cf\u8fd8\u662f\u8f6c\u5316\u4e00\u4e0b\u95ee\u9898\u3002\u5047\u8bbe\u6211\u4eec\u6700\u7ec8\u7684\u5e8f\u5217\u662f $a_1,a_2,...,a_i$\uff0c\u5219\u6709 $\\gcd_{j=1}^ia_j=1$\u3002\n\n\u8003\u8651\u8fd9\u4ef6\u4e8b\u53d1\u751f\u7684\u6982\u7387 $P(\\gcd_{j=1}^ia_j=1)=\\frac{\\sum_{a_1=1}^m\\sum_{a_2=1}^n...\\sum_{a_i=1}^m[\\gcd_{j=1}^ia_j=1]}{m^i}$\u3002\n\n$=\\frac{\\sum_{a_1=1}^m\\sum_{a_2=1}^n...\\sum_{a_i=1}^m\\sum_{d|a_1,d|a_2,...,d|a_i}\\mu(d)}{m^i}$\u3002\n\n$=\\frac{\\sum_{d=1}^m\\mu(d)(\\lfloor\\frac{m}{d}\\rfloor)^i}{m^i}$\u3002\n\n\u8bbe\u6700\u7ec8\u957f\u5ea6\u4e3a $len$\uff0c\u5219\u5b83\u6b63\u597d\u662f $P(len \\leq i)$\u3002\uff08\u6ce8\u610f\u4e0d\u662f $P(len=i)$\uff0c\u56e0\u4e3a\u53ef\u80fd\u4e0d\u5230 $i$ \u9879 $gcd=1$ \u5c31\u76f4\u63a5\u505c\u6b62\u4e86\uff0c\u6240\u4ee5 $1 \\sim i$ \u90fd\u6709\u53ef\u80fd\uff09\n\n\u7136\u540e\u601d\u8003\u5176\u4e0e\u7b54\u6848 $E$ \u7684\u5173\u7cfb\uff1a$E=\\sum_{i \\geq 1}P(len=i)i$\u3002\n\n$=\\sum_{i \\geq 1}P(len=i)\\sum_{j=1}^i1$\u3002\n\n$\\sum_{j \\geq 1}\\sum_{i \\geq j}P(len=i)$\u3002\n\n$=\\sum_{i \\geq 1}P(len \\geq i)$\u3002\n\n$=1+\\sum_{i \\geq 1}P(len>i)$\u3002\n\n$=1+\\sum_{i \\geq 1}[1-P(len \\leq i)]$\u3002\n\n\u4e0a\u8ff0\u4e3a\u6c42\u79bb\u6563\u671f\u671b\u7ecf\u5178\u5957\u8def\u3002\u2014\u2014Graygoo\u4f6c\n\n\u7136\u540e\u5e26\u5165\u5c31\u884c\u4e86\uff0c$E=1+\\sum_{i \\geq 1}[1-P(len \\leq i)]=1+\\sum_{i \\geq 1}[1-\\frac{\\sum_{d=1}^m\\mu(d)(\\lfloor\\frac{m}{d}\\rfloor)^i}{m^i}]$\u3002\n\n$=1+\\sum_{i \\geq 1}\\frac{\\sum_{d=2}^m\\mu(d)(\\lfloor\\frac{m}{d}\\rfloor)^i}{m^i}$\u3002\n\n$=1-\\sum_{d=2}^m\\mu(d)\\sum_{i \\geq 1}(\\frac{\\lfloor\\frac{m}{d}\\rfloor}{m})^i$\u3002\n\n$=1-\\sum_{d=2}^m\\mu(d)\\frac{\\lfloor\\frac{m}{d}\\rfloor}{m-\\lfloor\\frac{m}{d}\\rfloor}$\u3002\uff08\u6700\u540e\u4e00\u6b65\u4e3a\u65e0\u7a77\u7ea7\u6570\u6c42\u548c\uff09\n\n\u63a5\u4e0b\u91cc\u5c31\u7b80\u5355\u4e86\uff0c\u7ebf\u6027\u7b5b $\\mu$ \u7136\u540e\u5bf9 $d$ \u6570\u8bba\u5206\u5757\u5373\u53ef\u3002\u56e0\u4e3a\u5feb\u901f\u5e42\u4f1a\u591a\u4e2a $\\log$\uff0c\u6240\u4ee5\u6700\u7ec8\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}(m+\\sqrt{m} \\log m)$\u3002\n\n~~\u65e2\u7136\u9884\u5904\u7406\u590d\u6742\u5ea6\u6bd4\u5355\u6b21\u8be2\u95ee\u6162\uff0c\u4e3a\u4f55\u4e0d\u591a\u6d4b\u5462\uff1f~~\n\n\u65e2\u7136\u4e0d\u591a\u6d4b\uff0c\u5c31\u4e0d\u6570\u8bba\u5206\u5757\u4e86\uff0c\u76f4\u63a5\u66b4\u529b\u679a\u4e3e $d$ \u597d\u4e86\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\ntypedef long long LL;\nconst int N=1e5+9,P=1e9+7;\nint qmi(int a,int b){\n\tint res=1;\n\twhile(b){\n\t\tif(b&1) res=(LL)res*a%P;\n\t\ta=(LL)a*a%P;\n\t\tb>>=1;\n\t}\n\treturn res;\n}\nint m; \nint primes[N],cnt,mu[N]; bool st[N];\nvoid init(int n){\n\tmu[1]=1;\n\tfor(int i=2;i<=n;i++){\n\t\tif(!st[i]) primes[++cnt]=i,mu[i]=-1;\n\t\tfor(int j=1;primes[j]<=n/i;j++){\n\t\t\tint t=primes[j]*i;\n\t\t\tst[t]=1;\n\t\t\tif(i%primes[j]==0){\n\t\t\t\tmu[t]=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tmu[t]=-mu[i];\n\t\t}\n\t}\n}\nint main(){\n\tscanf(\"%d\",&m);\n\tinit(m);\n\tint res=1;\n\tfor(int d=2;d<=m;d++) res=(res-(LL)mu[d]*(m/d)%P*qmi(m-m/d,P-2)%P+P)%P;\n\tprintf(\"%d\\n\",res);\n\treturn 0;\n} \n```",
        "postTime": 1681381819,
        "uid": 477032,
        "name": "diandian2020",
        "ccfLevel": 0,
        "title": "[CF1139D] Steps to One \u9898\u89e3"
    },
    {
        "content": "- \u5f52\u96f6\u5fc3\u6001\u3002\n\n**\u9898\u610f**\n- \u751f\u6210\u503c\u57df\u5728 $[1,m]$ \u5185\u968f\u673a\u7684\u65e0\u7a77\u81ea\u7136\u6570\u5217\uff0c\u6c42\u5b83\u7684\u6700\u77ed\u6ee1\u8db3\u6700\u5927\u516c\u7ea6\u6570\u4e3a $1$ \u7684\u524d\u7f00\u7684\u671f\u671b\u957f\u5ea6\u3002\n- $m\\le 10^5$\u3002\n\n**\u5206\u6790**\n- \u4e00\u4e0b\u5c31\u60f3\u5230\u4e86\u9ad8\u65af\u6d88\u5143\uff0c\u5f88\u5feb\u554a\uff01\n- \u8bbe $p_i$ \u4e3a\u4ee5 $i$ \u4e3a\u516c\u7ea6\u6570\u7684\u60c5\u51b5\u540e\u9762\u7684\u671f\u671b\u957f\u5ea6\uff08$p_1=0$\uff09\uff0c\u90a3\u4e48\u7b54\u6848\u662f\uff1a\n$$1+\\frac 1m\\sum_{i=1}^mp_i$$\n- \u4e14\u6ee1\u8db3\u7ea6\u675f\u6761\u4ef6\uff1a\n$$p_i=1+\\frac 1m\\sum_{j=1}^mp_{\\gcd(i,j)}$$\n- \u4f60\u7acb\u523b\u5c31\u53d1\u73b0\u4e86\u4e0d\u5bf9\u52b2\uff1a$p_i$ \u662f\u5355\u8c03\u7684\uff0c\u800c\u4e14 $p_i$ \u53ea\u548c\u5b83\u7684\u7ea6\u6570\u6709\u5173\u7cfb\u5462\uff01\u6211\u4eec\u62c6\u5f00\u8d21\u732e\u7cfb\u6570\uff1a\n$$p_i=1+\\frac 1m\\sum_{d|i}p_d\\sum_{j=1}^m[\\gcd(i,j)=d]=1+\\frac 1m\\sum_{d|i}p_d\\sum_{j=1}^{\\lfloor m/d\\rfloor}\\epsilon(\\gcd(i/d,j/d))$$\n- \u8bbe\uff1a\n$$g(n,m)=\\sum_{j=1}^m\\epsilon(\\gcd(n,j))=\\sum_{j=1}^m\\sum_{d|n,d|j}\\mu(d)=\\sum_{d|n}\\mu(d)\\lfloor m/d\\rfloor$$\n$$p_i=1+\\frac 1m\\sum_{d|i}p_dg(n/d,\\lfloor m/d\\rfloor)$$\n- \u8fd9\u4e1c\u897f\u2026\u2026\u4f3c\u4e4e\u771f\u53ef\u4ee5\u8fc7\uff0c\u4f46\u662f\u6211\u7edd\u5bf9\u4e0d\u4efb\u5b83\u6765\u2026\u2026\u771f\u662f\u592a\u79bb\u8c31\u4e86\uff0c\u8fd9\u662f\u4ec0\u4e48\u9b3c\uff0c\u5c45\u7136\u662f $O(n\\log^2n)$ \u7684\u590d\u6742\u5ea6\uff0c[\u4ee3\u7801](https://www.luogu.com.cn/paste/81civsdg)\u3002\n- \u5982\u679c\u628a\u91cc\u9762\u90a3\u4e2a\u4e1c\u897f\u5c55\u5f00\uff1a\n$$p_i=1+\\frac 1m\\sum_{d|i}\\sum_{gd|i}p_d\\mu(g)\\lfloor m/(d\\cdot g)\\rfloor=1+\\frac 1m\\sum_{T|i}\\lfloor m/T\\rfloor\\sum_{d|T}p_d\\mu(T/d)$$\n- \u8bbe\uff1a\n$$f(n)=\\sum_{d|n}p_d\\mu(n/d)$$\n$$p_i=1+\\frac 1m\\sum_{d|i}\\lfloor m/d\\rfloor f(d)$$\n- \u8fd9\u4e2a\u5f0f\u5b50\u663e\u7136\u53ef\u4ee5\u505a\u5230 $O(n\\log n)$ \u7684\u590d\u6742\u5ea6\uff0c[\u4ee3\u7801](https://www.luogu.com.cn/paste/xhacdobr)\u3002\n- \u5982\u679c\u60f3\u8981\u8ffd\u6c42\u7ebf\u6027\u4e43\u81f3\u66f4\u5feb\u7684\u590d\u6742\u5ea6\uff0c\u6211\u4eec\u663e\u7136\u9700\u8981\u8f6c\u6362\u4e00\u4e2a\u89d2\u5ea6\uff0c\u53e6\u8f9f\u8e4a\u5f84\u3002\n- \u679a\u4e3e\u6b65\u6570\u770b\u4f3c\u6781\u4e0d\u53ef\u884c\uff0c\u4f46\u5374\u662f\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u7a81\u7834\u53e3\u3002\n- \u8bbe $F(n,m,k)$ \u4e3a\uff1a\u968f\u673a $n$ \u4e2a $[1,m]$ \u7684\u6574\u6570\uff0c\u6700\u5927\u516c\u7ea6\u6570\u4e3a $k$ \u7684\u6982\u7387\u3002\n- \u8bbe $G(n,m,k)$ \u4e3a\uff1a\u968f\u673a $n$ \u4e2a $[1,m]$ \u7684\u6574\u6570\uff0c\u6700\u5927\u516c\u7ea6\u6570\u4e3a $k$ \u7684\u500d\u6570\u7684\u6982\u7387\u3002\n- \u663e\u7136\uff1a\n$$G(n,m,k)=\\frac{\\lfloor m/k\\rfloor^n}{m^n}$$\n$$G(n,m,k)=\\sum_{k|d}F(n,m,d)$$\n$$F(n,m,k)=\\sum_{k|d}\\mu(d)G(n,m,d)=\\frac1{m^n}\\sum_{k|d}\\mu(d)\\lfloor m/d\\rfloor^n$$\n- \u6211\u4eec\u8981\u6c42\u7684\u5c31\u662f\uff1a\n$$1+\\sum_{i=1}^{\\infty}(1-F(i,m,1))=1+\\sum_{i=1}^{\\infty}(1-\\frac1{m^i}\\sum_{d=1}^m\\mu(d)\\lfloor m/d\\rfloor^i)=1-\\sum_{i=1}^{\\infty}\\frac1{m^i}\\sum_{d=2}^m\\mu(d)\\lfloor m/d\\rfloor^i$$\n- \u5957\u8def\u5730\u4ea4\u6362\u6c42\u548c\u53f7\uff1a\n$$1-\\sum_{d=2}^m\\mu(d)\\sum_{i=1}^{\\infty}\\bigg(\\frac{\\lfloor m/d\\rfloor}m\\bigg)^i=1-\\sum_{d=2}^m\\mu(d)\\frac{\\lfloor m/d\\rfloor}{m-\\lfloor m/d\\rfloor}$$\n- \u8fd9\u4e2a\u53ef\u4ee5 $O(n)$ \u9884\u5904\u7406 $O(\\sqrt n)$ \u5904\u7406\u5355\u6b21\u67e5\u8be2\uff0c\u5bf9\u4e8e\u8fd9\u9898\uff0c\u6211\u4eec\u80fd\u4f7f\u7528\u675c\u6559\u7b5b\u505a\u5230 $O(n^{2/3})$ \u7684\u590d\u6742\u5ea6\uff0c[\u4ee3\u7801](https://www.luogu.com.cn/paste/ymyv8rbu)\u3002\n- \u6700\u540e\uff0c\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff1a\u8bbe\u7b54\u6848\u4e3a $F(m)$\uff0c\u5bb9\u6613\u53d1\u73b0\uff1a\n$$F(n)-F(n-1)=\\sum_{d|n}\\mu(d)\\bigg(\\frac{1-d}{2d-1}+\\frac{1}{1-d}\\bigg)$$\n- \u6240\u4ee5\u7406\u8bba\u4e0a\u53ef\u4ee5\u7528 $O(n\\log\\log n)$ \u7b5b\u51fa $F(1)$ \u5230 $F(n)$\u3002",
        "postTime": 1653309745,
        "uid": 260884,
        "name": "WeLikeStudying",
        "ccfLevel": 0,
        "title": "steps to one"
    },
    {
        "content": "\u5f88\u96be\u60f3\u8c61\u4e3a\u4ec0\u4e48\u8fd9\u9898\u53ea\u662f\u4e2a div2D\uff0c\u4e14\u96be\u5ea6\u53ea\u6709 *2300/qd\uff08\u53ef\u80fd\u662f\u6211\u592a\u5f31\u4e86\u5427\uff09\n\n\u8003\u8651\u679a\u4e3e\u7b2c\u4e00\u4e2a\u9009\u7684\u6570 $x$\uff0c\u6c42\u671f\u671b\u6b21\u6570\u3002\u8bbe $x=\\prod p_i^{\\alpha_i}$\uff0c\u90a3\u4e48\u5c31\u662f\u4e00\u76f4\u9009\u6570\u76f4\u5230\u5bf9\u6bcf\u4e2a $p_i$ \u90fd\u9009\u4e86\u81f3\u5c11\u4e00\u4e2a\u4e0e\u5176\u4e92\u8d28\u7684\u6570\u5c31\u505c\u3002\u5230\u8fd9\u513f\u5c31\u662f\u4e2a\u7ecf\u5178\u7684 minmax \u6a21\u578b\u4e86\uff0c\u8bbe $t_i$ \u8868\u793a\u4e0e $p_i$ \u4e92\u8d28\u7684\u6570\u7b2c\u4e00\u6b21\u88ab\u9009\u7684\u65f6\u95f4\uff0c\u90a3\u4e48\u5c31\u662f\u6c42 $\\mathrm E(\\max\\{t_i\\})$\u3002\u53cd\u6f14\u4e00\u4e0b\uff1a\n$$\n\\mathrm E(\\max\\{t_i\\})=\\sum\\limits_{S\\subseteq\\{p_i\\},S\\neq\\varnothing}(-1)^{|S|+1}\\mathrm E\\!\\left(\\min\\limits_{i\\in S}\\{t_i\\}\\right)\n$$\nmin \u5c31\u662f\u7b2c\u4e00\u6b21\u4e92\u8d28\u4e8e\u81f3\u5c11\u4e00\u4e2a $p\\in S$\u3002\u4e92\u8d28\u4e8e\u81f3\u5c11\u4e00\u4e2a $p\\in S$\uff0c\u76f8\u5f53\u4e8e\u4e0d\u88ab $y=\\prod_{p\\in S}p$ \u6574\u9664\u3002\u8fd9\u5c31\u5f88\u597d\u529e\uff0c\u4e94\u5c81\u5c0f\u513f\u4ea6\u53ef\u89e3\u4e4b\uff1a\u8fd9\u6837\u7684\u6570\u6709 $n-\\left\\lfloor\\dfrac ny\\right\\rfloor$ \u4e2a\uff0c\u53d6\u5230\u7684\u6982\u7387\u4e3a $1-\\dfrac{\\left\\lfloor\\frac ny\\right\\rfloor}n$\uff0c\u6240\u4ee5\u53d6\u5230\u7684\u671f\u671b\u65f6\u95f4\u662f $\\dfrac1{1-\\dfrac{\\left\\lfloor\\frac ny\\right\\rfloor}n}=\\dfrac{n}{n-\\left\\lfloor\\frac ny\\right\\rfloor}$\u3002\u6240\u4ee5\n$$\n\\mathrm E(\\max\\{t_i\\})=n\\sum\\limits_{S\\subseteq\\{p_i\\},S\\neq\\varnothing}(-1)^{|S|+1}\\dfrac1{n-\\left\\lfloor\\frac{n}{\\prod_{p\\in S}p}\\right\\rfloor}\n$$\n\u6ce8\u610f\u5230\u8d28\u56e0\u5b50\u96c6\u5408\u4e0a\u7684\u5bb9\u65a5\u7cfb\u6570\u53ef\u4ee5\u7528 $\\mu$ \u8868\u793a\uff0c\u4e8e\u662f\n$$\n\\mathrm E(\\max\\{t_i\\})=-n\\sum\\limits_{y\\mid x,y>1}\\mu(y)\\dfrac1{n-\\left\\lfloor\\frac{n}{y}\\right\\rfloor}\n$$\n\u5230\u8fd9\u4e00\u6b65\u5c31\u5f88\u7b80\u5355\u4e86\u3002\u6ce8\u610f\u5230 $\\sum$ \u540e\u9762\u7684\u5f0f\u5b50\u53ea\u4e0e $y$ \u6709\u5173\uff0c\u8bb0\u4e3a $f(y)$\u3002\u679a\u4e3e $x$ \u65f6\uff0c\u8003\u8651\u6bcf\u4e2a $y$ \u8d21\u732e\u4e86\u591a\u5c11\u6b21\uff0c\u663e\u7136\u662f $\\left\\lfloor\\dfrac ny\\right\\rfloor$\u3002\u6700\u540e\u53d6\u5e73\u5747\u6570\u6b63\u597d\u628a $n$ \u6d88\u6389\u4e86\uff0c\u5e76\u4e14\u8981\u52a0\u4e0a\u5f00\u5934\u9009\u4e00\u6b21\u7684\u6b21\u6570\uff0c\u7b54\u6848\u5c31\u662f\n$$\n1-\\sum_{y=2}^n\\mu(y)\\dfrac{\\left\\lfloor\\frac ny\\right\\rfloor}{n-\\left\\lfloor\\frac ny\\right\\rfloor}\n$$\n",
        "postTime": 1648610499,
        "uid": 138400,
        "name": "chenxia25",
        "ccfLevel": 9,
        "title": "CF1139D - Steps to One \u9898\u89e3"
    },
    {
        "content": "\u5ba3\u4f20\u535a\u5ba2 $\\to$ [link](https://blog.csdn.net/BWzhuzehao/article/details/123216994)\n\n\u4e00\u9053\u83ab\u53cd\u597d\u9898\u3002\n\n\u5148\u8bc1\u4e2a\u5f0f\u5b50\uff1a$E(X)=\\sum_{i\\ge 1}P(X \\ge i)$\uff0c\u4e5f\u5c31\u662f\u6700\u7ec8\u957f\u5ea6\u4e3a $X$ \u7684\u671f\u671b\u662f\u6240\u6709\u6700\u7ec8\u957f\u5ea6\u5c0f\u4e8e\u7b49\u4e8e $X$ \u7684\u6982\u7387\u4e4b\u548c\u3002\n\n\u8bc1\u660e\uff1a$E(X)=\\sum_{i\\ge 1}iP(X=i)=\\sum_{i\\ge 1}\\sum_{1\\le j\\le i}P(X=i)=\\sum_{j\\ge 1}\\sum_{i\\ge j}P(X=i)=\\sum_{j\\ge1}P(x\\ge j)$\u3002\n\n\u8003\u8651\u5bb9\u65a5\uff0c\u6700\u7ec8\u957f\u5ea6\u5927\u4e8e\u7b49\u4e8e $i$ \u7b49\u4ef7\u4e8e\u957f\u5ea6\u4e3a $i-1$ \u7684\u5e8f\u5217 $\\gcd$ \u5927\u4e8e 1\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u7528 1 \u51cf\u53bb $\\gcd=1$ \u7684\u6982\u7387\uff0c\u6ce8\u610f\u8fd9\u91cc\u7684 $i \\ge 2$\u3002\n\n\u6982\u7387\u7528\u6ee1\u8db3\u6761\u4ef6\u65b9\u6848\u6570 / \u603b\u65b9\u6848\u6570\u8ba1\u7b97\uff0c\u603b\u65b9\u6848\u6570 $m^{i-1}$\uff0c\u56e0\u6b64\u53ea\u9700\u8981\u8ba1\u7b97 $i-1$ \u65f6 $\\gcd=1$ \u7684\u65b9\u6848\u6570\u5373\u53ef\u3002\n\n\u63a8 $\\gcd=1$ \u7684\u5f0f\u5b50\uff1a$\\sum_{1 \\le a_1,a_2,...,a_{i-1} \\le m}[\\gcd(a_1,a_2,...,a_{i-1})=1]$\n\n\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u5f97\u5230 $\\sum_{1 \\le a_1,a_2,...,a_{i-1}\\le m}\\sum_{d \\mid \\gcd(a_1,a_2,...,a_{i-1})}\\mu(d)$\n\n\u6362\u4e2a\u679a\u4e3e\u987a\u5e8f\uff0c\u987a\u4fbf\u5904\u7406\u4e00\u4e0b\u6c42\u548c\u7b26\u53f7\u5f97\u5230 $\\sum_{d=1}^{m}\\mu(d)\\lfloor\\dfrac{m}{d}\\rfloor^{i-1}$\n\n\u7136\u540e\u5f00\u59cb\u8ba1\u7b97\u7b54\u6848\u5f0f\u5b50\uff0c\u4e3a $1+\\sum_{i\\ge2}\\dfrac{m^{i-1}-\\sum_{d=1}^m\\mu(d)\\lfloor\\dfrac{m}{d}\\rfloor^{i-1}}{m^{i-1}}$\u3002\n\n$i-1$ \u592a\u4e11\uff0c\u4ee4 $i \\gets i-1$\uff0c\u5f97\u5230 $1+\\sum_{i\\ge1}\\dfrac{m^i-\\sum_{d=1}^m\\mu(d)\\lfloor\\dfrac{m}{d}\\rfloor^i}{m^i}$\u3002\n\n\u6ce8\u610f\u5230 $d=1$ \u65f6 $\\sum_{d=1}^{m}\\mu(d)\\lfloor\\dfrac{m}{d}\\rfloor^i=m^i$\uff0c\u56e0\u6b64\u5c06\u8fd9\u4e00\u90e8\u5206\u63d0\u51fa\u6765\u4e0e $m^i$ \u6d88\u6389\u3002\n\n\u7136\u540e\u4ea4\u6362\u6c42\u548c\u7b26\u53f7\uff0c\u5f97\u5230 $1-\\sum_{d=1}^{m}\\mu(d)(\\dfrac{\\lfloor\\frac{m}{d}\\rfloor}{m})^i$\u3002\n\n\u56e0\u4e3a $\\dfrac{\\lfloor\\frac{m}{d}\\rfloor}{m}<1$\uff0c\u6839\u636e $x<1 \\to \\sum_{i\\ge1}x^i=\\dfrac{x}{1-x}$\uff08\u8c8c\u4f3c\u662f\u7528\u751f\u6210\u51fd\u6570\u63a8\u7684\uff09\uff0c\u5f97\u5230 $1-\\sum_{d=1}^{m}\\mu(d)\\dfrac{\\dfrac{\\lfloor\\frac{m}{d}\\rfloor}{m}}{m-\\dfrac{\\lfloor\\frac{m}{d}\\rfloor}{m}}$\uff0c\u7136\u540e\u6574\u9664\u5206\u5757\u5373\u53ef\u3002\n\nGitHub\uff1a[CodeBase-of-Plozia](https://github.com/Plozia/CodeBase-of-Plozia/blob/main/%E6%95%B0%E5%AD%A6%26%E6%95%B0%E8%AE%BA/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%87%BD%E6%95%B0%E4%B8%8E%E5%8F%8D%E6%BC%94%EF%BC%88%E5%90%AB%E6%95%B4%E9%99%A4%E5%88%86%E5%9D%97%EF%BC%89/CF1139D%20Steps%20to%20One.cpp)\n\nCode\uff1a\n\n```cpp\n/*\n========= Plozia =========\n\tAuthor:Plozia\n\tProblem:CF1139D Steps to One\n\tDate:2022/3/1\n========= Plozia =========\n*/\n\n#include <bits/stdc++.h>\n\ntypedef long long LL;\nconst int MAXN = 1e5 + 5;\nconst LL P = 1e9 + 7;\nint t, n, cntPrime, Prime[MAXN];\nLL mu[MAXN], inv[MAXN];\nbool book[MAXN];\n\nint Read()\n{\n\tint sum = 0, fh = 1; char ch = getchar();\n\tfor (; ch < '0' || ch > '9'; ch = getchar()) fh -= (ch == '-') << 1;\n\tfor (; ch >= '0' && ch <= '9'; ch = getchar()) sum = sum * 10 + (ch ^ 48);\n\treturn sum * fh;\n}\nint Max(int fir, int sec) { return (fir > sec) ? fir : sec; }\nint Min(int fir, int sec) { return (fir < sec) ? fir : sec; }\nLL ksm(LL a, LL b = P - 2, LL p = P)\n{\n\tLL s = 1 % p;\n\tfor (; b; b >>= 1, a = a * a % p)\n\t\tif (b & 1) s = s * a % p;\n\treturn s;\n}\n\nvoid init()\n{\n\tbook[1] = mu[1] = 1;\n\tfor (int i = 2; i <= n; ++i)\n\t{\n\t\tif (!book[i]) { Prime[++cntPrime] = i; mu[i] = -1; }\n\t\tfor (int j = 1; j <= cntPrime; ++j)\n\t\t{\n\t\t\tif (i * Prime[j] > n) break ;\n\t\t\tbook[i * Prime[j]] = 1;\n\t\t\tif(i % Prime[j] == 0) { mu[i * Prime[j]] = 0; break ; }\n\t\t\tmu[i * Prime[j]] = -mu[i];\n\t\t}\n\t}\n\tfor (int i = 2; i <= n; ++i) mu[i] = mu[i - 1] + mu[i];\n}\n\nint main()\n{\n\tn = Read(); init(); LL ans = 0;\n\tfor (int i = 1; i <= n; ++i) inv[i] = ksm(i);\n\tfor (int l = 2, r; l <= n; l = r + 1)\n\t{\n\t\tr = Min(n / (n / l), n);\n\t\tans = (ans + (mu[r] - mu[l - 1]) * (n / l) % P * inv[n - (n / l)] % P) % P;\n\t}\n\tans = ((1 - ans) % P + P) % P;\n\tprintf(\"%lld\\n\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1646142089,
        "uid": 134000,
        "name": "Plozia",
        "ccfLevel": 7,
        "title": "CF1139D Steps to One \u9898\u89e3"
    },
    {
        "content": "[Link](https://www.luogu.com.cn/problem/CF1139D)\n\n## Sol\n\n\u8bbe $len$ \u4e3a\u968f\u673a\u51fa\u6765\u7684\u4e00\u4e2a\u5e8f\u5217\u957f\u5ea6\u3002\n\n$$E(len) = \\sum\\limits_{i \\geq 1} P(len = i) \\times i$$\n\n$$E(len) = \\sum\\limits_{i \\geq 1} P(len = i) \\sum\\limits_{j=1}^{i} 1$$\n\n$$E(len) = \\sum\\limits_{j \\geq 1} \\sum\\limits_{i \\geq j} P(len = i) = \\sum\\limits_{i \\geq 1} P(len \\geq i) = 1 + \\sum\\limits_{i \\geq 1} P(len > i)$$\n\n\u73b0\u5728\u6765\u5904\u7406\u540e\u9762\u7684 $\\sum\\limits_{i \\geq 1} P(len > i)$\n\n$$P(len > i) = P((gcd_{j=1}^{i} a_i) > 1)$$\n\n> \u9634\u9633\u5e08\uff1a\u201c\u6b63\u96be\u5219\u53cd\u201d\n\n$$P(len > i) = 1 - P((gcd_{j=1}^{i} a_i) = 1)$$\n\n\u5bf9\u4e8e\u5e8f\u5217\u4e2d\u7684\u6bcf\u4e00\u4e2a\u6570\uff0c\u5176\u5b9e\u90fd\u53ef\u4ee5\u679a\u4e3e\u5b83\u4eec\u662f $[1,m]$ \u4e2d\u7684\u54ea\u4e00\u4e2a\uff0c\u518d\u9664\u6389 $m^i$ \u4e3a $i$ \u4e2a\u7403\u653e\u5728 $m$ \u4e2a\u6807\u6709\u6570\u5b57\u7684\u76d2\u5b50\u4e2d\uff0c\u4e14\u5141\u8bb8\u6709\u6570\u5b57\u6ca1\u51fa\u73b0\u8fc7\u7684\u603b\u65b9\u6848\u6570\u3002\n\n$$lsh = \\frac{\\sum_{a_1 = 1}^{m}\\sum_{a_2 = 1}^{m}\\cdots \\sum_{a_{i} = 1}^{m} \\epsilon(gcd_{j=1}^{i} a_j)}{m^i} $$\n\n\u5bf9\u6700\u540e\u4e00\u5c42\u7684\u6c42\u548c\u7b26\u53f7\u4f7f\u7528\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n\n$$lsh = \\frac{\\sum_{a_1 = 1}^{m}\\sum_{a_2 = 1}^{m}\\cdots \\sum_{a_{i} = 1}^{m}\\sum_{d|(gcd_{j = 1}^{i} a_j)} \\mu(d)}{m^i} $$\n\n\u5bf9\u6bcf\u4e00\u5c42\u90fd\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u628a\u679a\u4e3e\u7684 $d$ \u63d0\u5230\u6700\u524d\u9762\u53bb\n\n$$lsh = 1 - \\frac{\\sum_{d=1}^{m} \\mu(d)\\sum_{a_1=1}^{m} [d|a_1] \\cdots}{m^i}$$\n\n\u540e\u9762\u7684\u90e8\u5206\u4e0a\u6307\u6807\u540c\u65f6\u9664\u4ee5 $d$ \u4e4b\u540e\u53ef\u4ee5\u76f4\u63a5\u62ff\u51fa\u6765\n\n$$lsh = \\frac{\\sum_{d=1}^{m} \\mu(d) (\\lfloor \\frac{m}{d} \\rfloor)^i}{m^i}$$\n\n$$lsh = 1 - \\frac{\\sum_{d=2}^{m} \\mu(d) (\\lfloor \\frac{m}{d} \\rfloor)^i}{m^i}$$\n\n\u6240\u4ee5\u5e26\u56de\u539f\u5f0f\u53ef\u5f97\uff1a\n\n$$1 - \\frac{1}{m^i} \\sum\\limits_{i \\geq 1}\\sum\\limits_{d=2}^{m} \\mu(d)(\\lfloor \\frac{m}{d} \\rfloor)^i$$\n\n\u6574\u9664\u5206\u5757\uff1a\n\n$$1-\\sum\\limits_{d = 2}^{m} \\mu(d)\\frac{\\lfloor \\frac{m}{d} \\rfloor}{m - \\lfloor \\frac{m}{d} \\rfloor}$$\n\n\n\n\u9a6c\u8001\u5e08\u544a\u8bc9\u4f60\uff0c\u540e\u9762\u90a3\u4e00\u5768\u7c7b\u4f3c\u4e8e\u675c\u6559\u7b5b\u9884\u5904\u7406\u5373\u53ef\u3002\n\n\n\n## Code\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\n\nconst int SIZE = 2e5 + 5;\nconst int mod = 1e9 + 7;\n\nint m, tot;\nint isnPri[SIZE], pri[SIZE], mu[SIZE], inv[SIZE];\n\nnamespace GTR {\n\tconst int bufl = 1 << 15;\n\tchar buf[bufl], *s = buf, *t = buf;\n\tinline int fetch() {\n\t\tif (s == t) { t = (s = buf) + fread(buf, 1, bufl, stdin); if (s == t) return EOF; }\n\t\treturn *s++;\n\t}\n\tinline int read() {\n\t\tint a = 0, b = 1, c = fetch();\n\t\twhile (c < 48 || c > 57) b ^= c == '-', c = fetch();\n\t\twhile (c >= 48 && c <= 57) a = (a << 1) + (a << 3) + c - 48, c = fetch();\n\t\treturn b ? a : -a;\n\t}\n} using GTR::read;\n\nint qPow(int a, int b) {\n    int ans = 1ll;\n    for ( ; b; b >>= 1, a = a * a % mod) {\n        if (b & 1) ans = ans * a % mod;\n    }\n    return ans % mod;\n}\n\nvoid init() {\n    isnPri[1] = mu[1] = 1;\n    for (int i = 2; i <= m + 1; ++ i) {\n        if (!isnPri[i]) pri[++ tot] = i, mu[i] = -1;\n        for (int j = 1; j <= tot && i * pri[j] <= m + 1; ++ j) {\n            isnPri[i * pri[j]] = 1;\n            if (i % pri[j]) mu[i * pri[j]] = -mu[i];\n            else { mu[i * pri[j]] = 0; break; }\n        }\n    }\n    inv[1]=1;\n    for (int i = 2; i <= m + 1; ++ i) inv[i] = (mod - mod / i) * inv[mod % i] % mod;\n}\n\nsigned main() {\n    m = read(); init();\n    int ans = 1ll;\n    for (int i = 2; i <= m + 1; ++ i) ans = (ans - (mu[i] * (m / i) % mod * inv[m - m / i] % mod) + mod) % mod;\n    printf(\"%lld\\n\", ans % mod);\n    return 0;\n}\n```\n\n",
        "postTime": 1629467306,
        "uid": 230933,
        "name": "Tony102",
        "ccfLevel": 7,
        "title": "CF1139D Steps to One"
    },
    {
        "content": "\u8bbe\u6570\u5217\u957f\u5ea6\u4e3a $k$\uff0c$E(k)$ \u4e3a $k$ \u7684\u671f\u671b\uff0c$P(X)$ \u4e3a\u6570\u5217\u6ee1\u8db3 $X$ \u6761\u4ef6\u7684\u6982\u7387\uff0c\u5219\n$$\n\\begin{aligned}\nE(k)&=\\sum_{i\\geq 1}i \\cdot P(k=i) \\\\\n&=\\sum_{i \\geq 1}P(k \\geq i) \\\\\n&=1+\\sum_{i \\geq 1}P(k > i)\n\\end{aligned}\n$$\n\u4ee4 $\\gcd_{i=u}^{v}t_i=\\gcd(t_u,t_{u+1},\\cdots,t_{v-1},t_v)$\n\n\u6ce8\u610f\u5230\uff0c\u53ea\u8981\u6ee1\u8db3 $\\gcd_{j=1}^{i}a_j \\neq 1$\uff0c\u5219\u8be5\u5e8f\u5217\u5fc5\u7136\u6ee1\u8db3 $k > i$\uff0c\u6545\u6709\n$$\n\\begin{aligned}\nP(k > i)&=P\\left(\\gcd_{j=1}^{i}a_j \\neq 1\\right) \\\\\n&=1-P\\left(\\gcd_{j=1}^{i}a_j = 1\\right) \\\\\n&=1-\\frac{\\sum_{a_1=1}^{m}\\sum_{a_2=1}^{m}\\cdots\\sum_{a_{i-1}=1}^{m}\\sum_{a_{i}=1}^{m}[\\gcd_{j=1}^{i}a_j = 1]}{m^i} \\\\\n&=1-\\frac{\\sum_{a_1=1}^{m}\\sum_{a_2=1}^{m}\\cdots\\sum_{a_{i-1}=1}^{m}\\sum_{a_{i}=1}^{m}\\sum_{d|\\gcd_{j=1}^{i}a_j }\\mu(d)}{m^i} \\\\\n&=1-\\frac{\\sum_{d=1}^{m}\\mu(d)(\\lfloor\\frac{m}{d}\\rfloor)^i}{m^i} \\\\\n&=1-\\frac{\\mu(1)(\\lfloor\\frac{m}{1}\\rfloor)^i+\\sum_{d=2}^{m}\\mu(d)(\\lfloor\\frac{m}{d}\\rfloor)^i}{m^i} \\\\\n&=-\\frac{\\sum_{d=2}^{m}\\mu(d)(\\lfloor\\frac{m}{d}\\rfloor)^i}{m^i}\n\\end{aligned}\n$$\n\n\u4ee3\u5165\uff0c\u5f97\n\n$$\n\\begin{aligned}\nE(k)&=1-\\sum_{i \\geq 1}\\frac{\\sum_{d=2}^{m}\\mu(d)(\\lfloor\\frac{m}{d}\\rfloor)^i}{m^i} \\\\\n&=1-\\sum_{i \\geq 1}\\sum_{d=2}^{m}\\mu(d)(\\frac{\\lfloor\\frac{m}{d}\\rfloor}{m})^i \\\\\n&=1-\\sum_{d=2}^{m}\\mu(d)\\sum_{i \\geq 1}(\\frac{\\lfloor\\frac{m}{d}\\rfloor}{m})^i \\\\\n&=1-\\sum_{d=2}^{m}\\mu(d)\\frac{\\lfloor\\frac{m}{d}\\rfloor}{m-\\lfloor\\frac{m}{d}\\rfloor}\n\\end{aligned}\n$$\n\n$O(m)$ \u66b4\u529b\u8ba1\u7b97\u5373\u53ef",
        "postTime": 1613631081,
        "uid": 225734,
        "name": "derta",
        "ccfLevel": 6,
        "title": "\u3010\u9898\u89e3\u3011\u3010CF1139D Steps to One\u3011"
    },
    {
        "content": "[CF1139D Steps to One](https://www.luogu.com.cn/problem/CF1139D)\n\n\u672c\u7bc7\u9898\u89e3\u4e3b\u8981\u53c2\u8003\u4e86[\u540c\u6821\u5b66\u957f\u7684\u82f1\u6587\u535a\u5ba2](https://www.cnblogs.com/zyt1253679098/p/10584706.html)\u3002\uff08\u80fd\u7528 English \u5199\u535a\u5ba2\u592a\u5de8\u4e86orz\uff09\n\n\u8bbe $f_i$ \u8868\u793a $gcd=i$ \u65f6\uff0c\u8fd8\u9700\u8981\u6dfb\u52a0\u4e2a\u6570\u7684\u671f\u671b\u4e2a\u6570\u3002\u5bb9\u6613\u63a8\u51fa\n$$\nf_1=0,\\ \\ \\ f_i=1+\\sum_{j=1}^{m}\\frac{f_{gcd(i,j)}}{m},  \\ \\ \\ ans=1+\\sum_{i=1}^{m}\\frac{f_i}{m}\n$$\n\u7a0d\u5fae\u5316\u7b80\u4e00\u4e0b\u5f97\n$$\nm\\times f_i=m+\\sum_{j=1}^{m}{f_{gcd(i,j)}}\n$$\n\u8fd9\u5c31\u662f $O(n^2 )$ \u7684 dp \u5f0f\u3002\u6211\u4eec\u8003\u8651\u4f18\u5316\u3002\u770b\u5230 gcd \uff0c\u6211\u4eec\u60f3\u5230\u83ab\u53cd\u3002\u5f00\u59cb\u63a8\u5f0f\u5b50\uff1a\n$$\nm\\times f_i=m+\\sum_{j=1}^{m}{f_{gcd(i,j)}}=m+\\sum_{d|i}f_d\\sum_{j=1}^{m}[gcd(i,j)==d]\n$$\n$d=i$ \u65f6\uff0c\u7edf\u8ba1\u7b54\u6848\u4e0d\u65b9\u4fbf\uff0c\u4e8e\u662f\u6211\u4eec\u6d88\u6389\u8fd9\u4e00\u5f71\u54cd\u3002$d=i$ \u65f6\uff0c$\\sum_{j=1}^{m}[gcd(i,j)==d]=\\lfloor {\\frac{m}{i}}\\rfloor$\u3002\u4e8e\u662f\u6709\n$$\n(m-\\lfloor {\\frac{m}{i}}\\rfloor)\\times f_i=m+\\sum_{d|i,d\\neq i}f_d\\sum_{j=1}^{m}[gcd(i,j)==d]\n$$\n\u628a\u53f3\u534a\u90e8\u5206\u7ee7\u7eed\u6f14\uff0c\u6839\u636e\u83ab\u53cd\u7684\u5957\u8def $\\mu*1=\\epsilon$\uff0c\u53ef\u4ee5\u5f97\u5230\n$$\n\\sum_{j=1}^{m}[gcd(i,j)==d]=\\sum_{j=1}^{\\lfloor {\\frac{m}{d}}\\rfloor}[gcd(\\lfloor {\\frac{i}{d}}\\rfloor,j)==1]=\\sum_{j=1}^{\\lfloor {\\frac{m}{d}}\\rfloor}\\sum_{x|j,x|{\\lfloor {\\frac{i}{d}}\\rfloor}}\\mu(x)=\\sum_{x|{\\lfloor {\\frac{i}{d}}\\rfloor}}\\mu(x)\\times\\lfloor{\\frac{\\lfloor {\\frac{m}{d}}\\rfloor}{x}}\\rfloor\n$$\n\u6700\u540e\u518d\u6574\u7406\u4e00\u4e0b\n$$\nf_i=\\frac{m+\\sum_{d|i,d\\neq i}f_d\\sum_{x|{\\lfloor {\\frac{i}{d}}\\rfloor}}\\mu(x)\\times\\lfloor{\\frac{\\lfloor {\\frac{m}{d}}\\rfloor}{x}}\\rfloor}{m-\\lfloor {\\frac{m}{i}}\\rfloor}\n$$\n\n\uff08\u611f\u8c22\u540c\u673a\u623f\u5de8\u4f6c zzc \u5e2e\u6211\u63a8\u5f0f\u5b50\u3002\uff09\n\n\u9884\u5904\u7406\u51fa\u6bcf\u4e2a\u6570\u7684\u56e0\u6570\u548c $\\mu$ \uff0c\u6839\u636e\u4e0a\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u6c42\u51fa\u6bcf\u4e00\u4e2a $f_i$ \u3002\u679a\u4e3e $d$ \u548c $x$ \uff0c\u590d\u6742\u5ea6 $O(\u80fd\u8fc7\uff09$\uff0c\u5927\u6982\u4e0d\u8d85\u8fc7 $O(n\\sqrt n)$ \u5427\uff0c\u6211\u4e0d\u592a\u4f1a\u8bc1\u3002\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nnamespace FGF\n{\n\tint n,m;\n\tconst int mo=1e9+7;\n\tconst int N=1e5+5;\n\tbool vis[N];\n\tint cnt;\n\tvector<int> fac[N];\n\tll mu[N],p[N],f[N],ans,inv[N];\n\tvoid init()\n\t{\n\t\tmu[1]=1;\n\t\tfor(int i=2;i<=n;i++)\n\t\t{\n\t\t\tif(!vis[i])p[++cnt]=i,mu[i]=mo-1;\n\t\t\tfor(int j=1;j<=cnt&&p[j]*i<=n;j++)\n\t\t\t{\n\t\t\t\tvis[p[j]*i]=1;\n\t\t\t\tif(i%p[j]==0)\n\t\t\t\t{\n\t\t\t\t\tmu[i*p[j]]=0;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tmu[i*p[j]]=mo-mu[i];\n\t\t\t}\n\t\t}\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tfor(int j=i;j<=n;j+=i)\n\t\t\t\tfac[j].push_back(i);\n\t\tinv[1]=1;\n\t\tfor(int i=2;i<=n;i++)\n\t\t\tinv[i]=inv[mo%i]*(mo-mo/i)%mo;\n\t}\n\tvoid work()\n\t{\n\t\tscanf(\"%d\",&n);\n\t\tinit();\n\t\tfor(int i=2;i<=n;i++)\n\t\t{\n\t\t\tfor(int sz=fac[i].size(),j=0;j<sz;j++)\n\t\t\t{\n\t\t\t\tint d=fac[i][j];\n\t\t\t\tif(d==i)continue;\n\t\t\t\tll sum=0;\n\t\t\t\tfor(int s=fac[i/d].size(),k=0;k<s;k++)\n\t\t\t\t\tsum=(sum+mu[fac[i/d][k]]*(n/d/fac[i/d][k])%mo)%mo;\n\t\t\t\tf[i]=(f[i]+sum*f[d]%mo)%mo;\n\t\t\t} \n\t\t\tf[i]=(f[i]+n)*inv[n-n/i]%mo;\n\t\t\tans=(ans+f[i])%mo;\n\t\t}\t\n\t\tprintf(\"%lld\",(ans*inv[n]%mo+1)%mo);\n\t}\n}\nint main()\n{\n\tFGF::work();\n\treturn 0;\n}\n```",
        "postTime": 1605864241,
        "uid": 224403,
        "name": "\u6728xx\u6728\u5927",
        "ccfLevel": 9,
        "title": "CF1139D Steps to One(\u671f\u671bdp+\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14)"
    }
]
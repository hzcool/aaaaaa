[
    {
        "content": "## \u9898\u610f\n**\u5e73\u9762\u76f4\u89d2\u5750\u6807\u7cfb**\u4e0a\uff0c\u6709\u4e00\u4e2a\u516c\u4e3b\u548c\u5979\u7684\u5f71\u5b50\uff0c\u8fd8\u6709 $m$ \u68f5\u6811\uff0c\u516c\u4e3b\u5728 $(v_x,v_y)$,\u5f71\u5b50\u5728 $(s_x,s_y)$ \u3002\n\u516c\u4e3b\u8981\u53bb\u8ffd\u5f71\u5b50\u3002\n\u516c\u4e3b\u5411\u53f3\u8d70\uff0c\u5f71\u5b50\u5c31\u4f1a\u5411\u53f3\u8d70\uff1b\u516c\u4e3b\u5411\u5de6\u8d70\uff0c\u5f71\u5b50\u5c31\u4f1a\u5411\u5de6\u8d70\uff1b\u516c\u4e3b\u5411\u4e0a\u8d70\uff0c\u5f71\u5b50\u5c31\u4f1a\u5411\u4e0a\u8d70\uff1b\u516c\u4e3b\u5411\u4e0b\u8d70\uff0c\u5f71\u5b50\u5c31\u4f1a\u5411\u4e0b\u8d70\u3002\n\u5982\u679c\u5f71\u5b50\u524d\u8fdb\u7684\u65b9\u5411\u662f\u4e00\u68f5\u6811\uff0c\u5f71\u5b50\u5c31\u4e0d\u4f1a\u52a8\u3002\u516c\u4e3b\u4e0d\u80fd\u649e\u6811\u3002\n\u6c42\u4e00\u7ec4\u516c\u4e3b\u7684\u884c\u52a8\u65b9\u6848\uff0c\u8ba9\u516c\u4e3b\u6293\u5230\u5f71\u5b50\uff0c\u8981\u6c42\u65b9\u6848\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7 $10^6$\u3002\u82e5\u65e0\u89e3\uff0c\u8f93\u51fa $-1$\n\n$0\\le m\\le 400,-200\\le\\text{\u5750\u6807}\\le200$\n## \u9898\u89e3\n\n\u9000\u5f79\u540e\u4e00\u8840\uff0c\u5728$\\rm\\color{black}W\\color{red}YH$ \u7684\u5e2e\u52a9\u4e0b\u60f3\u51fa\u4e86 $3100$\uff08\u6076\u8bc4\u9898\uff09\u3002\n\n\u975e\u5e38 \u3010\u3011\uff0c\u76f4\u63a5\u731c\u7ed3\u8bba\u5373\u53ef\u3002\n\n\u7ed9\u4e2a\u6bd4\u8f83\u83dc\u7684\u65b9\u6cd5\u3002\n\n\u8003\u8651 $400$ \u68f5\u6811\u80fd\u5426\u628a\u516c\u4e3b\u548c\u5f71\u5b50\u56f4\u8d77\u6765\u3002\n\n\u5982\u679c\u4e24\u8005\u7686\u4e0d\u5c01\u95ed\uff0c\u90a3\u4e48\u4e00\u5b9a\u53ef\u4ee5\u628a\u4e24\u8005\u90fd\u79fb\u5230\u5916\u9762\uff0c\u90fd\u79fb\u5230\u5916\u9762\u4e4b\u540e\u5c31\u4e00\u5b9a\u6709\u89e3\uff0c\u8fd9\u90e8\u5206\u53ef\u4ee5\u624b\u73a9\u4e00\u4e0b\u3002\u7531\u4e8e\u6bd4\u8f83\u83dc\uff0c\u4ee3\u7801\u91cc\u76f4\u63a5\u5206\u7c7b\u8ba8\u8bba\u4e86\u3002\n\n\u5982\u679c\u4e00\u4e2a\u5c01\u95ed\u4e00\u4e2a\u4e0d\u5c01\u95ed\uff0c\u663e\u7136\u65e0\u89e3\u3002\n\n\u5982\u679c\u4e24\u4e2a\u90fd\u5c01\u95ed\uff0c\u90a3\u4e48\u8054\u901a\u5c31\u5fc5\u5b9a\u6709\u89e3\u3002\u6211\u4eec\u6570\u5b66\u8bfe\u521a\u521a\u8bb2\u8fc7\u829d\u8bfa\u8ffd\u4e4c\u9f9f\uff0c\u501f\u9274\u8ffd\u4e4c\u9f9f\u7684\u65b9\u6cd5\u628a\u516c\u4e3b\u79fb\u5230\u5f71\u5b50\u5728\u7684\u5730\u65b9\uff0c\u7136\u540e\u7ee7\u7eed\u641c\u7d22\u3002\u5e94\u8be5\u53ef\u4ee5\u8bc1\u660e\u4e0d\u4f1a\u66f4\u52a3\uff0c\u7531\u4e8e\u662f $\\rm OI$ \u5c31\u4e0d\u8bc1\u660e\u4e86\u3002\n\n\u53ef\u80fd\u6709\u66f4\u9ad8\u5999\u7684\u505a\u6cd5\u4f46\u4e0d\u592a\u4f1a\u3002\n\n\u52a0\u7c97**\u5e73\u9762\u76f4\u89d2\u5750\u6807\u7cfb**\u662f\u56e0\u4e3a\u4e00\u5f00\u59cb\u770b\u53cd\u4e86\u3002\n\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n#define mp make_pair\n#define pii pair<int,int>\n#define ppp pair<pii,pii>\n#define L 0\n#define R 1\n#define D 2\n#define U 3\n#define vvx now.first.first\n#define vvy now.first.second\n#define ssx now.second.first\n#define ssy now.second.second\n#define mnx min(vvx,ssx)\n#define mxx max(vvx,ssx)\n#define mny min(vvy,ssy)\n#define mxy max(vvy,ssy)\nusing namespace std;\nint vx,vy,sx,sy,m;\nint vis[450][450];\nint flag[450][450];\nint x[450],y[450];\nconst int dx[4]={0,0,-1,1};\nconst int dy[4]={-1,1,0,0};\nconst char ch[4]={'L','R','D','U'};\nbool In(int x,int y){return x>=5&&x<=440&&y>=5&&y<=440;}\nbool Not(int x,int y){\n\tif(!In(x,y))return false;\n\treturn vis[x][y];\n}\nbool fb(int x,int y){\n\tmemset(flag,0,sizeof flag);\n\tqueue<pii>q;q.push(mp(x,y));flag[x][y]=1;\n\twhile(q.size()){\n\t\tauto [x,y]=q.front();q.pop();\n\t\tfor(int i=0;i<4;i++){\n\t\t\tint xx=x+dx[i],yy=y+dy[i];\n\t\t\tif(!In(xx,yy))return false;\n\t\t\tif(vis[xx][yy])continue;\n\t\t\tif(flag[xx][yy])continue;\n\t\t\tflag[xx][yy]=1;\n\t\t\tq.push(mp(xx,yy));\n\t\t}\n\t}return true;\n}\nppp work(ppp A,int dir){\n\tauto [x,y]=A.first;auto [xx,yy]=A.second;\n\tif(Not(x+dx[dir],y+dy[dir]))exit(-1);\n\tx+=dx[dir],y+=dy[dir];\n\tif(!Not(xx+dx[dir],yy+dy[dir]))xx+=dx[dir],yy+=dy[dir];\n\tputchar(ch[dir]);\n\tif(x==xx&&y==yy)exit(0);\n\treturn mp(mp(x,y),mp(xx,yy));\n} \nppp work(ppp A,int dir,int times){\n\twhile(times--)\n\t\tA=work(A,dir);\n\treturn A;\n}\nppp now;\nvoid dfs(int x,int y){\n\t//printf(\"%d %d\\n\",x-210,y-210);\n\tif(flag[x][y]!=-10){\n\t\tint dir=flag[x][y]^1;\n\t\tdfs(x+dx[dir],y+dy[dir]);\n\t}else return;\n\tnow=work(now,flag[x][y]);\n}\nsigned main(){\n\t//freopen(\"1.out\",\"w\",stdout);\n\tscanf(\"%d%d%d%d%d\",&vx,&vy,&sx,&sy,&m);\n\tif(!m){\n\t\tif(vx==sx&&vy==sy)return 0;\n\t\treturn puts(\"-1\"),0;\n\t}\n\tvx+=210,vy+=210,sx+=210,sy+=210;\n\tswap(vx,vy);swap(sx,sy);\n\tfor(int i=1;i<=m;i++){\n\t\tscanf(\"%d%d\",&y[i],&x[i]);\n\t\tx[i]+=210;y[i]+=210;\n\t\tvis[x[i]][y[i]]=1;\n\t}\n\tbool V=fb(vx,vy);\n\tbool S=fb(sx,sy);\n\tif(V^S)\n\t\treturn puts(\"-1\"),0;\n\tif(V&&S){\n\t\t{\n\t\t\tmemset(flag,0,sizeof flag);\n\t\t\tqueue<pii>q;q.push(mp(vx,vy));flag[vx][vy]=0;\n\t\t\twhile(q.size()){\n\t\t\t\tauto [x,y]=q.front();q.pop();\n\t\t\t\tfor(int i=0;i<4;i++){\n\t\t\t\t\tint xx=x+dx[i],yy=y+dy[i];\n\t\t\t\t\tif(vis[xx][yy])continue;\n\t\t\t\t\tif(flag[xx][yy])continue;\n\t\t\t\t\tif(xx==sx&&yy==sy)\n\t\t\t\t\t\tgoto loop;\n\t\t\t\t\tflag[xx][yy]=1;\n\t\t\t\t\tq.push(mp(xx,yy));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn puts(\"-1\"),0;\n\t\tloop:;\n\t\tfor(;;){\n\t\t\tmemset(flag,0xff,sizeof flag);\n\t\t\t//flag\u8bb0\u5f55dir \n\t\t\tflag[vx][vy]=-10;\n\t\t\tqueue<pii>q;q.push(mp(vx,vy));\n\t\t\twhile(q.size()){\n\t\t\t\tauto [x,y]=q.front();q.pop();\n\t\t\t\tfor(int i=0;i<4;i++){\n\t\t\t\t\tint xx=x+dx[i],yy=y+dy[i];\n\t\t\t\t\tif(vis[xx][yy])continue;\n\t\t\t\t\tif(flag[xx][yy]!=-1)continue;\n\t\t\t\t\tflag[xx][yy]=i;\n\t\t\t\t\tif(xx==sx&&yy==sy)\n\t\t\t\t\t\tgoto out;\n\t\t\t\t\tq.push(mp(xx,yy));\n\t\t\t\t}\n\t\t\t}\n\t\t\tout:;\n\t\t\tnow=mp(mp(vx,vy),mp(sx,sy));\n\t\t\t\n\t\t\tdfs(sx,sy);\n\t\t\t//putchar('\\n');\n\t\t\tvx=now.first.first;\n\t\t\tvy=now.first.second;\n\t\t\t\n\t\t\tsx=now.second.first;\n\t\t\tsy=now.second.second;\n\t\t\tif(vx==sx&&vy==sy)\n\t\t\t\treturn 0;\n\t\t}\n\t}\n\tmemset(flag,0xff,sizeof flag);\n\t//flag\u8bb0\u5f55dir \n\tint ex,ey;\n\tflag[vx][vy]=-10;\n\tqueue<pii>q;q.push(mp(vx,vy));\n\twhile(q.size()){\n\t\tauto [x,y]=q.front();q.pop();\n\t\tfor(int i=0;i<4;i++){\n\t\t\tint xx=x+dx[i],yy=y+dy[i];\n\t\t\tif(vis[xx][yy])continue;\n\t\t\tif(flag[xx][yy]!=-1)continue;\n\t\t\tflag[xx][yy]=i;\n\t\t\tif(!In(xx,yy)){\n\t\t\t\tex=xx,ey=yy;\n\t\t\t\tgoto out2;\n\t\t\t}\n\t\t\tq.push(mp(xx,yy));\n\t\t}\n\t}\n\tout2:;\n\tnow=mp(mp(vx,vy),mp(sx,sy));\n\tdfs(ex,ey);\n\t\n\tif(ex==441)now=work(now,L,500),now=work(now,D,500);\n\telse now=work(now,D,500),now=work(now,L,500);\n\tnow=work(now,D,500),now=work(now,L,500);\n\t\n\tsx=now.second.first;\n\tsy=now.second.second;\n\tif(In(sx,sy)){\n\t\tint ex,ey;\n\t\tmemset(flag,0xff,sizeof flag);\n\t\tflag[sx][sy]=-10;\n\t\twhile(q.size())q.pop();\n\t\tq.push(mp(sx,sy));\n\t\twhile(q.size()){\n\t\t\tauto [x,y]=q.front();q.pop();\n\t\t\tfor(int i=0;i<4;i++){\n\t\t\t\tint xx=x+dx[i],yy=y+dy[i];\n\t\t\t\tif(vis[xx][yy])continue;\n\t\t\t\tif(flag[xx][yy]!=-1)continue;\n\t\t\t\tflag[xx][yy]=i;\n\t\t\t\tif(!In(xx,yy)){\n\t\t\t\t\tex=xx,ey=yy;\n\t\t\t\t\tgoto out3;\n\t\t\t\t}\n\t\t\t\tq.push(mp(xx,yy));\n\t\t\t}\n\t\t}\n\t\tout3:;\n\t\tdfs(ex,ey);\n\t\t\n\t\tif(ex==441)now=work(now,L,500),now=work(now,D,500);\n\t\telse now=work(now,D,500),now=work(now,L,500);\n\t}\n\tif(ssx>=vvx&&ssy>=vvy){\n\t\tint mn=0x3f3f3f3f;\n\t\tfor(int i=1;i<=m;i++)mn=min(mn,x[i]);\n\t\twhile(ssx!=mn)\n\t\t\tnow=work(now,U);\n\t\twhile(!Not(ssx+dx[R],ssy+dy[R]))\n\t\t\tnow=work(now,R);\n\t\twhile(vvy!=ssy)\n\t\t\tnow=work(now,R);\n\t\tnow=work(now,D);\n\t\tnow=work(now,R);\n\t\twhile(1)now=work(now,U);\n\t}\n\tif(ssx>=vvx&&ssy<=vvy){\n\t\twhile(ssy<=440)now=work(now,R);\n\t\tint mn=0x3f3f3f3f;\n\t\tfor(int i=1;i<=m;i++)mn=min(mn,x[i]);\n\t\twhile(ssx!=mn)\n\t\t\tnow=work(now,U);\n\t\twhile(!Not(ssx+dx[L],ssy+dy[L]))\n\t\t\tnow=work(now,L);\n\t\twhile(vvy!=ssy)\n\t\t\tnow=work(now,L);\n\t\tnow=work(now,D);\n\t\tnow=work(now,L);\n\t\twhile(1)now=work(now,U);\n\t}\n\tif(ssx<=vvx&&ssy<=vvy){\n\t\twhile(ssy<=440)now=work(now,R);\n\t\tint mx=-0x3f3f3f3f;\n\t\tfor(int i=1;i<=m;i++)mx=max(mx,x[i]);\n\t\twhile(ssx!=mx)\n\t\t\tnow=work(now,U);\n\t\twhile(!Not(ssx+dx[L],ssy+dy[L]))\n\t\t\tnow=work(now,L);\n\t\twhile(vvy!=ssy)\n\t\t\tnow=work(now,L);\n\t\tnow=work(now,U);\n\t\tnow=work(now,L);\n\t\twhile(1)now=work(now,D);\n\t}\n\tif(ssx<=vvx&&ssy>=vvy){\n\t\tint mx=-0x3f3f3f3f;\n\t\tfor(int i=1;i<=m;i++)mx=max(mx,x[i]);\n\t\twhile(ssx!=mx)\n\t\t\tnow=work(now,U);\n\t\twhile(!Not(ssx+dx[R],ssy+dy[R]))\n\t\t\tnow=work(now,R);\n\t\twhile(vvy!=ssy)\n\t\t\tnow=work(now,R);\n\t\tnow=work(now,U);\n\t\tnow=work(now,R);\n\t\twhile(1)now=work(now,D);\n\t}\n}\n```",
        "postTime": 1624456225,
        "uid": 174304,
        "name": "jun\u5934\u5409\u5409",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF317E \u3010Princess and Her Shadow\u3011"
    }
]
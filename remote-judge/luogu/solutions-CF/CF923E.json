[
    {
        "content": "**\u9898\u76ee\u5927\u610f.**\n\n\u6c42 $A^mP$\uff0c\u5176\u4e2d $P$ \u7ed9\u5b9a\uff0c$A$ \u662f\u4e00\u4e2a\u7ebf\u6027\u53d8\u6362\uff1a\n$$\np_i\\leftarrow \\sum_{j\\ge i}\\dfrac{p_j}{j+1}\n$$\n\n\u4e0b\u6807\u8303\u56f4\u5747\u4e3a $0\\sim n$\u3002\n\n$n\\le 10^5,m\\le 10^{18}$\u3002\u7b54\u6848\u6a21 $998244353$\u3002\n\n**\u9898\u89e3.**\n\n~~\u8349\uff0c\u597d\u50cf\u548c\u5b98\u65b9\u9898\u89e3\u649e\u4e86~~\n\n\u65e2\u7136\u7ed9\u51fa\u4e86\u4e00\u4e2a\u7ebf\u6027\u53d8\u6362\uff0c\u8fd8\u8981\u6211\u4eec\u6c42\u9ad8\u6b21\u5e42\uff0c\u4e0d\u96be\u60f3\u5230[**\u5bf9\u89d2\u5316**](https://xyix.github.io/posts/?page=0&postname=linear-algebra)\u3002\n\n\u90a3\u6ca1\u5565\u597d\u8bf4\u7684\uff0c\u5927\u529b\u89e3\u5427\u3002\u5177\u4f53\u627e\u51fa\u7684\u7279\u5f81\u5411\u91cf\u4e3a\uff1a\u7f16\u53f7\u4e3a $i\\in[0\\sim n]$ \u7684\u7279\u5f81\u5411\u91cf\u7684\u7b2c $j\\in[0\\sim n]$ \u7ef4\u662f\n\n$$\n(-1)^{i+j}{i\\choose j}\n$$\n\n\u8bb0 $F$ \u662f\u628a\u7b2c $i$ \u4e2a $A$ \u7684\u7279\u5f81\u5411\u91cf\u4f5c\u4e3a\u7b2c $i$ \u5217\u6784\u6210\u7684\u77e9\u9635\uff0c\u5219\u6211\u4eec\u5c31\u5f97\u5230\n\n$$\nA^m=F(F^{-1}AF)^mF^{-1}\n$$\n\n\u5927\u529b\u624b\u7b97\u53ef\u4ee5\u5f97\u51fa\uff1a\n\n- $F^{-1}$ \u7684 $i$ \u5217 $j$ \u884c \u4e3a ${i\\choose j}$\u3002\n\n- $F^{-1}AF$ \u662f\u5bf9\u89d2\u77e9\u9635\uff0c\u5176\u7b2c $i$ \u5217 $i$ \u884c\u4e3a $\\dfrac{1}{i+1}$\u3002\n\n\u4e58\u4ee5 $F$ \u548c $F^{-1}$ \u663e\u7136\u90fd\u53ef\u4ee5\u4f7f\u7528 NTT \u4f18\u5316\u3002\n\n```cpp\nint main() {\n\tinit();\n\tscanf(\"%d%lld\", &n, &m); n++; F.resize(n); G.resize(n);\n\tfor(int i = 0; i < n; i++) scanf(\"%d\", &F[i].x), F[i] *= fac[i];\n\tF.reverse();\n\tfor(int i = 0; i < n; i++) G[i] = ifac[i];\n\tF = Conv(F, G, n << 1); F.resize(n);\n\tF.reverse();\n\tfor(int i = 0; i < n; i++) F[i] *= qpow(inv[i + 1], m % (p - 1)), F[i] = i & 1 ? -F[i] : F[i];\n\tF.reverse();\n\tF = Conv(F, G, n << 1); F.resize(n);\n\tF.reverse();\n\tfor(int i = 0; i < n; i++) F[i] *= ifac[i], F[i] = i & 1 ? -F[i] : F[i], printf(\"%d \", F[i].x);\n}\n```",
        "postTime": 1607430093,
        "uid": 58567,
        "name": "x\u4e49x",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF923E \u3010Perpetual Subtraction\u3011"
    },
    {
        "content": "\u8bbe$f(\\tau,i)$\u8868\u793a**\u7b2c$\\tau$\u6b21\u64cd\u4f5c\u8fdb\u884c\u4e4b\u524d\uff0c\u4e5f\u5c31\u662f\u7b2c$(\\tau-1)$\u6b21\u64cd\u4f5c\u8fdb\u884c\u4e4b\u540e**\u5f97\u5230\u7684\u6570\u662f$i$\u7684\u6982\u7387\u3002\u90a3\u4e48$f(1,i)=p_i$\uff0c\u6211\u4eec\u9700\u8981\u5bf9\u4e8e\u6bcf\u4e2a$i$\u6c42\u51fa$f(m+1,i)$\u3002\n\n~~\u4e0d\u8981\u95ee\u6211\u4e3a\u4ec0\u4e48\u7528$\\tau$\u8fd9\u4e2a\u5947\u602a\u7684\u5b57\u6bcd~~\n\n\u8003\u8651\u4e00\u6b21\u64cd\u4f5c\u5e26\u6765\u7684\u5f71\u54cd\uff1a\u663e\u7136\u6709\n\n$$f(\\tau+1,i)=\\sum\\limits_{j=i}^n\\frac{f(\\tau,j)}{j+1}$$\n\n\u770b\u8d77\u6765\u4e0d\u662f\u5f88\u660e\u663e\uff0c\u6211\u4eec\u5229\u7528\u751f\u6210\u51fd\u6570\u6765\u627e\u5173\u7cfb\u3002\u8bbe$F_\\tau(x)=\\sum\\limits_{i=0}^nf(\\tau,i)x^i$\uff0c\u90a3\u4e48\n\n$$F_{\\tau+1}(x)=\\sum\\limits_{i=0}^nf(\\tau+1,i)x^i$$\n\n$$=\\sum\\limits_{i=0}^n\\sum\\limits_{j=i}^n\\frac{f(\\tau,j)}{j+1}x^i$$\n\n$$=\\sum\\limits_{j=0}^n\\frac{f(\\tau,j)}{j+1}\\sum\\limits_{i=0}^jx^i$$\n\n$$=\\sum\\limits_{j=0}^n\\frac{f(\\tau,j)}{j+1}\\cdot\\frac{x^{j+1}-1}{x-1}$$\n\n$$=\\frac{1}{x-1}\\sum\\limits_{j=0}^nf(\\tau,j)\\frac{x^{j+1}-1}{j+1}$$\n\n$$=\\frac{1}{x-1}\\sum\\limits_{j=0}^nf(\\tau,j)\\int_1^xt^j\\mathrm{d}t$$\n\n$$=\\frac{1}{x-1}\\int_1^xF_\\tau(t)\\mathrm{d}t$$\n\n\u6211\u4eec\u559c\u95fb\u4e50\u89c1\u7684\u662f$\\int_0^xf(t)\\mathrm{d}t=\\int f(x)\\mathrm{d}x$\u5e76\u4e14\u5e38\u6570\u9879\u4e3a$0$\u3002\u4f46\u8fd9\u91cc\u79ef\u5206\u4e0b\u9650\u662f$1$\uff0c\u4e0d\u597d\u5904\u7406\u3002\n\n\u8bbe$G_\\tau(x)=F_\\tau(x+1)$\uff0c\u5e76\u4e14$G_\\tau(x)=\\sum\\limits_{i=0}^ng(\\tau,i)x^i$\uff0c\u90a3\u4e48\n\n$$G_{\\tau+1}(x)=\\frac{1}{x}\\int_1^{x+1}F_\\tau(t)\\mathrm{d}t$$\n\n$$=\\frac{1}{x}\\int_0^xF_\\tau(t+1)\\mathrm{d}(t+1)$$\n\n$$=\\sum\\limits_{i=0}^n\\frac{g(\\tau,i)}{i+1}x^i$$\n\n\u4e8e\u662f\u6211\u4eec\u53d1\u73b0\n\n$$g(\\tau+1,i)=\\frac{g(\\tau,i)}{i+1}$$\n\n\u8fd9\u662f\u7b49\u6bd4\u6570\u5217\u3002\u90a3\u4e48\n\n$$g(m+1,i)=\\frac{g(1,i)}{(i+1)^m}$$\n\n\u4e0b\u9762\u7684\u95ee\u9898\u5c31\u662f\u5982\u4f55\u6c42\u51fa$g(1,i)$\uff0c\u4ee5\u53ca\u5982\u4f55\u7531$g(m+1,i)$\u6c42\u51fa$f(m+1,i)$\u3002\n\n$$\\because G_\\tau(x)=F_\\tau(x+1)$$\n\n$$\\therefore \\sum\\limits_{i=0}^ng(\\tau,i)x^i=\\sum\\limits_{i=0}^nf(\\tau,i)\\sum\\limits_{j=0}^iC_i^jx^j$$\n\n$$=\\sum\\limits_{j=0}^nx^j\\sum\\limits_{i=j}^nf(\\tau,i)C_i^j$$\n\n$$\\therefore g(\\tau,i)=\\sum\\limits_{j=i}^nC_j^if(\\tau,j)$$\n\n\u4ee4$\\tau=1$\uff0c\u8fd9\u65f6$f(\\tau,i)=p_i$\uff0c\u90a3\u4e48\n\n$$g(1,i)=\\sum\\limits_{j=i}^n\\frac{j!p_j}{i!(j-i)!}$$\n\n$$=\\frac{1}{i!}\\sum\\limits_{j=0}^{n-i}\\frac{1}{j!}(j+i)!p_{j+i}$$\n\n\u8bb0$a_i=\\frac{1}{i!},b_i=(n-i)!p_{n-i}$\uff0c\u90a3\u4e48\n\n$$g(1,i)=\\frac{1}{i!}\\sum\\limits_{j=0}^{n-i}a_jb_{n-i-j}$$\n\nNTT\u6c42\u5377\u79ef\u5373\u53ef\u3002\n\n\u7136\u540e\u518d\u8003\u8651\u600e\u4e48\u6c42\u51fa$f(m+1,i)$\u3002\u4e3a\u4e86\u65b9\u4fbf\u8d77\u89c1\uff0c\u5c06$f(m+1,i)$\u8bb0\u4e3a$f_i$\uff0c\u5c06$g(m+1,i)$\u8bb0\u4e3a$g_i$\u3002\n\n\u6211\u4eec\u53d1\u73b0\u7531$f$\u6c42\u51fa$g$\u7684\u8fc7\u7a0b\u5c31\u662f\u4e2a\u5377\u79ef\uff0c\u73b0\u5728\u8981\u53cd\u8fc7\u6765\u6c42\uff0c\u6211\u4eec\u9700\u8981\u591a\u9879\u5f0f\u6c42\u9006\u5417\uff1f\u5e76\u4e0d\u9700\u8981\uff0c\u53ea\u8981\u4e00\u4e2a\u53cd\u6f14\u5373\u53ef\u3002\n\n$$\\because g_i=\\sum\\limits_{j=i}^nC_j^if_j$$\n\n$$\\therefore f_i=\\sum\\limits_{j=i}^n(-1)^{j-i}C_j^ig_j$$\n\n$$=\\frac{1}{i!}\\sum\\limits_{j=i}^n\\frac{(-1)^{j-i}}{(j-i)!}j!g_j$$\n\n$$=\\frac{1}{i!}\\sum\\limits_{j=0}^{n-i}\\frac{(-1)^j}{j!}(j+i)!g_{j+i}$$\n\n\u8bbe$c_i=\\frac{(-1)^i}{i!},d_i=(n-i)!g_{n-i}$\uff0c\u90a3\u4e48\n\n$$f_i=\\frac{1}{i!}\\sum\\limits_{j=0}^{n-i}c_jd_{n-i-j}$$\n\nNTT\u6c42\u5377\u79ef\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\log n)$\u3002\n\n```cpp\n#include <cctype>\n#include <cstdio>\n#include <climits>\n#include <algorithm>\n\ntemplate <typename T> inline void read(T& x) {\n    int f = 0, c = getchar(); x = 0;\n    while (!isdigit(c)) f |= c == '-', c = getchar();\n    while (isdigit(c)) x = x * 10 + c - 48, c = getchar();\n    if (f) x = -x;\n}\ntemplate <typename T, typename... Args>\ninline void read(T& x, Args&... args) {\n    read(x); read(args...); \n}\ntemplate <typename T> void write(T x) {\n    if (x < 0) x = -x, putchar('-');\n    if (x > 9) write(x / 10);\n    putchar(x % 10 + 48);\n}\ntemplate <typename T> inline void writeln(T x) { write(x); puts(\"\"); }\ntemplate <typename T> inline bool chkmin(T& x, const T& y) { return y < x ? (x = y, true) : false; }\ntemplate <typename T> inline bool chkmax(T& x, const T& y) { return x < y ? (x = y, true) : false; }\n\ntypedef long long LL;\n\nconst LL mod = 998244353, G = 3, Gi = 332748118;\nconst int maxn = 1e5 + 7;\n\ninline LL qpow(LL x, LL k) {\n    LL s = 1;\n    for (; k; x = x * x % mod, k >>= 1)\n        if (k & 1) s = s * x % mod;\n    return s;\n}\n\ninline void ntt(LL *A, int *r, int lim, int tp) {\n    for (int i = 0; i < lim; ++i)\n        if (i < r[i]) std::swap(A[i], A[r[i]]);\n    for (int mid = 1; mid < lim; mid <<= 1) {\n        LL wn = qpow(tp == 1 ? G : Gi, (mod - 1) / (mid << 1));\n        for (int j = 0; j < lim; j += mid << 1) {\n            LL w = 1;\n            for (int k = 0; k < mid; ++k, w = w * wn % mod) {\n                LL x = A[j + k], y = w * A[j + k + mid] % mod;\n                A[j + k] = (x + y) % mod;\n                A[j + k + mid] = (x - y + mod) % mod;\n            }\n        }\n    }\n    if (tp == -1) {\n        LL inv = qpow(lim, mod - 2);\n        for (int i = 0; i < lim; ++i)\n            A[i] = A[i] * inv % mod;\n    }\n}\n\nint n, r[maxn << 2], lim, l;\nLL m, p[maxn], fac[maxn], ifac[maxn];\nLL a[maxn << 2], b[maxn << 2], g[maxn];\n\nint main() {\n    read(n, m);\n    for (int i = 0; i <= n; ++i) read(p[i]);\n    fac[0] = ifac[0] = 1;\n    for (int i = 1; i <= n + 1; ++i)\n        fac[i] = fac[i - 1] * i % mod;\n    ifac[n + 1] = qpow(fac[n + 1], mod - 2);\n    for (int i = n; i; --i)\n        ifac[i] = ifac[i + 1] * (i + 1) % mod;\n    for (int i = 0; i <= n; ++i) {\n        a[i] = ifac[i];\n        b[i] = fac[n - i] * p[n - i] % mod;\n    }\n    for (lim = 1; lim <= (n << 1); ++l) lim <<= 1;\n    for (int i = 0; i < lim; ++i)\n        r[i] = (r[i >> 1] >> 1) | ((i & 1) << (l - 1));\n    ntt(a, r, lim, 1); ntt(b, r, lim, 1);\n    for (int i = 0; i < lim; ++i)\n        a[i] = a[i] * b[i] % mod;\n    ntt(a, r, lim, -1);\n    for (int i = 0; i <= n; ++i)\n        g[i] = ifac[i] * a[n - i] % mod * qpow(qpow(i + 1, m), mod - 2) % mod;\n    for (int i = 0; i <= n; ++i) {\n        a[i] = ((i & 1) ? mod - 1 : 1ll) * ifac[i] % mod;\n        b[i] = fac[n - i] * g[n - i] % mod;\n    }\n    for (int i = n + 1; i < lim; ++i)\n        a[i] = b[i] = 0;\n    ntt(a, r, lim, 1); ntt(b, r, lim, 1);\n    for (int i = 0; i < lim; ++i)\n        a[i] = a[i] * b[i] % mod;\n    ntt(a, r, lim, -1);\n    for (int i = 0; i <= n; ++i)\n        write(ifac[i] * a[n - i] % mod), putchar(' ');\n    return 0;\n}\n```",
        "postTime": 1566307838,
        "uid": 72071,
        "name": "GKxx",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF923E \u3010Perpetual Subtraction\u3011"
    },
    {
        "content": "\u597d\u9898\uff01\u6559\u4f1a\u4e86\u6211\u76f8\u4f3c\u5bf9\u89d2\u5316\u3002\n\n\u6211\u4eec\u8bbe $f_{k,i}$ \u8868\u793a $k$ \u6b21\u8fc7\u540e $x=i$ \u7684\u6982\u7387\uff0c\u5219\u6709\uff1a\n$$\nf_{k,i}=\\sum\\limits_{j=i}^n\\frac{f_{k-1,j}}{j+1}\\\\\n$$\n\n\u4ee4 $F_k$ \u4e3a\u5217\u5411\u91cf $\\begin{bmatrix}f_{k,0}\\\\\\vdots\\\\f_{k,n}\\end{bmatrix}$\uff0c\u5219\u6709\uff1a\n$$\n\\begin{bmatrix}1&\\frac{1}{2}&\\cdots&\\frac{1}{n+1}\\\\0&\\frac{1}{2}&\\cdots&\\frac{1}{n+1}\\\\\\vdots&\\vdots&\\ddots&\\vdots\\\\0&0&\\cdots&\\frac{1}{n+1}\\end{bmatrix}F_k=F_{k+1}\n$$\n\u8bbe\u8fd9\u4e2a\u5927\u65b9\u9635\u4e3a $D$\uff0c\u8f93\u5165\u7684\u5217\u5411\u91cf\u4e3a $p$\u3002\n\n\u6211\u4eec\u8981\u6c42\u7684\u5b9e\u9645\u4e0a\u5c31\u662f $D^mp$\u3002\n\n\u6211\u4eec\u53d1\u73b0\u6211\u4eec\u8981\u6c42\u5b83\u7684\u5e42\uff0c\u8003\u8651\u5bf9\u89d2\u5316\u8fd9\u4e2a\u77e9\u9635\u3002\n\n\u7b80\u5355\u5730\u8bf4\uff0c\u627e\u5230\u8fd9\u4e2a\u77e9\u9635\u7684\u6240\u6709\u7279\u5f81\u5411\u91cf\uff0c\u7531\u4e8e\u7279\u5f81\u5411\u91cf\u53ea\u4f1a\u88ab\u62c9\u4f38\uff0c\u6240\u4ee5\u5728\u7279\u5f81\u57fa\u4f5c\u4e3a\u57fa\u5411\u91cf\u7684\u7a7a\u95f4\u4e2d\uff0c\u8fd9\u4e2a\u7ebf\u6027\u53d8\u6362\u4e00\u5b9a\u662f\u5bf9\u89d2\u77e9\u9635\uff0c\u5bf9\u89d2\u7ebf\u4e0a\u7684\u503c\u5373\u4e3a\u6240\u6709\u7279\u5f81\u503c\uff0c\u5bf9\u89d2\u77e9\u9635\u7684\u5e42\u662f\u975e\u5e38\u597d\u8ba1\u7b97\u7684\uff0c\u590d\u6742\u5ea6\u4e3a $O(n\\log n)$\uff0c\u518d\u53d8\u6362\u56de\u4e00\u822c\u7684\u7a7a\u95f4\u5373\u53ef\u3002\u8bbe $G$ \u4e3a\u5c06\u7279\u5f81\u5411\u91cf\u53d8\u4e3a\u57fa\u5411\u91cf\u7684\u57fa\u53d8\u6362\u77e9\u9635\uff0c\u5219\u6709 $G^{-1}DG$ \u662f\u7279\u5f81\u57fa\u4e0b\u7684\u8be5\u7ebf\u6027\u53d8\u6362\uff0c\u6240\u4ee5\u6211\u4eec\u6709 $D^m=G(G^{-1}DG)^mG^{-1}$\u3002\n\n\u4e0a\u4e09\u89d2\u77e9\u9635\u7684\u7279\u5f81\u503c\u5c31\u662f\u5bf9\u89d2\u7ebf\u4e0a\u7684\u6240\u6709\u5143\u7d20\uff0c\u6240\u4ee5\u6709\uff1a\n$$\nG^{-1}DG=\\begin{bmatrix}1&0&\\cdots&0\\\\0&\\frac{1}{2}&\\cdots&0\\\\\\vdots&\\vdots&\\ddots&\\vdots\\\\0&0&\\cdots&\\frac{1}{n+1}\\end{bmatrix}\n$$\n\u800c\u7279\u5f81\u5411\u91cf\u662f\u53ef\u4ee5\u6839\u636e\u5b9a\u4e49\u89e3\u5f97\uff1a\n$$\n(D-\\lambda I)x=0\n$$\n\u628a $\\lambda=1,\\cdots,\\frac{1}{n+1}$ \u4ee3\u5165\uff0c\u5c31\u53ef\u4ee5\u89e3\u5f97 $G$ \u4e3a\uff1a\n$$\n\\begin{bmatrix}(-1)^{0}{0\\choose 0}&(-1)^1{1\\choose 0}&\\cdots&(-1)^n{n\\choose 0}\\\\0&(-1)^2{1\\choose 1}&\\cdots&(-1)^{n+1}{n\\choose 1}\\\\\\vdots&\\vdots&\\ddots&\\vdots\\\\0&0&\\cdots&(-1)^{2n}{n\\choose n}\\end{bmatrix}\n$$\n \u4e00\u5217\u5c31\u662f\u4e00\u4e2a\u7279\u5f81\u5411\u91cf\u3002\u73b0\u5728\u8003\u8651\u6c42\u51fa $G^{-1}$\uff0c\u6253\u8868\u53d1\u73b0\uff1a\n$$\nG^{-1}=\\begin{bmatrix}{0\\choose 0}&{1\\choose 0}&\\cdots&{n\\choose 0}\\\\0&{1\\choose 1}&\\cdots&{n\\choose 1}\\\\\\vdots&\\vdots&\\ddots&\\vdots\\\\0&0&\\cdots&{n\\choose n}\\end{bmatrix}\n$$\n\u8bc1\u660e\uff1a\n$$\n\\sum\\limits_{k=0}^n(-1)^{i+k}{k\\choose i}{j\\choose k}=[i=j]\\\\\n\\begin{aligned}\n&\\sum\\limits_{k=0}^n(-1)^{i+k}{k\\choose i}{j\\choose k}\\\\\n=&\\sum\\limits_{k=i}^j(-1)^{i+k}{j-i\\choose k-i}{j\\choose i}\\\\\n=&{j\\choose i}\\sum\\limits_{k=0}^{j-i}(-1)^{2i+k}{j-i\\choose k}\\\\\n=&{j\\choose i}\\sum\\limits_{k=0}^{j-i}(-1)^{k}{j-i\\choose k}\\\\\n=&{j\\choose i}[j-i=0]\\\\\n=&[i=j]\n\\end{aligned}\n$$\n\u73b0\u5728\u95ee\u9898\u53d8\u6210\u7ed9\u4e00\u4e2a\u5217\u5411\u91cf\u5de6\u4e58\u4e00\u4e2a\u65b9\u9635\uff0c\u8fd9\u4e2a\u590d\u6742\u5ea6\u662f $O(n^2)$ \u7684\uff0c\u4e0d\u80fd\u63a5\u53d7\uff0c\u4f46\u6211\u4eec\u7684\u65b9\u9635\u6bd4\u8f83\u7279\u6b8a\u3002\n\n\u5148\u8003\u8651 $Gp$ \u7684\u8ba1\u7b97\uff0c\u8bbe $q=Gp$\uff0c\u5219\u6709\n$$\n\\begin{aligned}\nq_i=&\\sum\\limits_{k=i}^n(-1)^{i+k}{k\\choose i}p_k\\\\\n=&\\sum\\limits_{k=i}^n(-1)^{i+k}\\frac{k!}{i!(k-i)!}p_k\\\\\n=&\\frac{(-1)^i}{i!}\\sum\\limits_{k=i}^n(-1)^{k}k!p_k\\frac{1}{(k-i)!}\\\\\n\\end{aligned}\n$$\n\u5bb9\u6613\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u51cf\u6cd5\u5377\u79ef\u53ef\u4ee5 $\\text{NTT}$ \u4f18\u5316\uff0c\u5de6\u4e58 $G^{-1}$ \u7684\u8ba1\u7b97\u548c\u8fd9\u4e2a\u533a\u522b\u4e0d\u5927\uff0c\u5c31\u4e0d\u7ec6\u8bf4\u4e86\uff0c\u5de6\u4e58 $(G^{-1}DG)^m$ \u7684\u8ba1\u7b97\u5c31\u662f\u7ed9\u6bcf\u4e00\u9879\u4e58\u4e0a\u5bf9\u89d2\u7ebf\u4e0a\u5bf9\u5e94\u7684\u90a3\u4e00\u4e2a\u6570\u5373\u53ef\u3002\n\n\u90a3\u4e48\u8fd9\u9053\u9898\u5c31\u7ed3\u675f\u4e86\u3002\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nint const mod=998244353,g=3,gi=(mod+1)/g;\nint p[400010],tmp[400010],r[400010],fac[400010],inv[400010],lim=1<<18,n,m;\nlong long nm;\nint pow(int x,int y){\n\tint res=1;\n\twhile(y){\n\t\tif(y&1) res=1ll*res*x%mod;\n\t\tx=1ll*x*x%mod;\n\t\ty>>=1;\n\t}\n\treturn res;\n}\nvoid ntt(int *a,int const &type){\n\tfor(int i=0;i<lim;i++)if(i<r[i])std::swap(a[i],a[r[i]]);\n\tfor(int mid=1;mid<lim;mid<<=1){\n\t\tint rt=pow(type==1?g:gi,(mod-1)/(mid<<1));\n\t\tfor(int r=mid<<1,j=0;j<lim;j+=r)\n\t\t\tfor(int p=1,k=0;k<mid;k++,p=1ll*p*rt%mod){\n\t\t\t\tint x=a[j+k],y=1ll*p*a[j+mid+k]%mod;\n\t\t\t\ta[j+k]=(x+y)%mod,a[j+mid+k]=(x-y+mod)%mod;\n\t\t\t}\n\t}\n\tif(type==-1)for(int p=pow(lim,mod-2),i=0;i<lim;i++)a[i]=1ll*a[i]*p%mod;\n}\nint main(){\n\tfor(int i=0;i<lim;i++)r[i]=(r[i>>1]>>1)|((i&1)*(lim>>1));\n\tscanf(\"%d%lld\",&n,&nm);\n\tm=nm%(mod-1);\n\tfor(int i=0;i<=n;i++)scanf(\"%d\",p+i);\n\tfac[0]=1;\n\tfor(int i=1;i<=n;i++)fac[i]=1ll*fac[i-1]*i%mod;\n\tinv[n]=pow(fac[n],mod-2);\n\tfor(int i=n;i;i--)inv[i-1]=1ll*inv[i]*i%mod;\n\tfor(int i=0;i<=n;i++)p[i]=1ll*p[i]*fac[i]%mod,tmp[i]=inv[i];\n\tfor(int i=0;i<=n;i++)if(i<n-i)std::swap(p[i],p[n-i]);\n\tntt(p,1),ntt(tmp,1);\n\tfor(int i=0;i<lim;i++)p[i]=1ll*p[i]*tmp[i]%mod;\n\tntt(p,-1);\n\tfor(int i=0;i<=n;i++)if(i<n-i)std::swap(p[i],p[n-i]);\n\tfor(int i=n+1;i<lim;i++)tmp[i]=p[i]=0;\n\tfor(int i=0;i<=n;i++)p[i]=1ll*p[i]*inv[i]%mod;\n\tfor(int i=0;i<=n;i++)p[i]=1ll*p[i]*pow(pow(i+1,mod-2),m)%mod;\n\tfor(int i=0;i<=n;i++)tmp[i]=inv[i],p[i]=1ll*p[i]*pow(mod-1,i)%mod*fac[i]%mod;\n\tfor(int i=0;i<=n;i++)if(i<n-i)std::swap(p[i],p[n-i]);\n\tntt(p,1),ntt(tmp,1);\n\tfor(int i=0;i<lim;i++)p[i]=1ll*p[i]*tmp[i]%mod;\n\tntt(p,-1);\n\tfor(int i=0;i<=n;i++)if(i<n-i)std::swap(p[i],p[n-i]);\n\tfor(int i=n+1;i<lim;i++)p[i]=0;\n\tfor(int i=0;i<=n;i++)p[i]=1ll*p[i]*pow(mod-1,i)%mod*inv[i]%mod;\n\tfor(int i=0;i<=n;i++)printf(\"%d \",p[i]);\n\treturn 0;\n}\n```",
        "postTime": 1613525908,
        "uid": 55707,
        "name": "gxy001",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF923E Perpetual Subtraction"
    },
    {
        "content": "### \u8fd9\u91cc\u6709\u6211\u5bf9\u8c31\u5206\u89e3\u4e00\u4e9b\u4e2a\u4eba\u7406\u89e3\uff0c\u5e0c\u671b\u80fd\u5e2e\u52a9\u5230\u5404\u4f4d\n\n\u524d\u7f6e\u77e5\u8bc6\uff1a\u7ebf\u6027\u53d8\u6362\uff0c\u7279\u5f81\u503c\uff0c\u7279\u5f81\u5411\u91cf\uff0c\u77e9\u9635\u6c42\u9006\uff0c\u57fa\u53d8\u6362\u3002\n\n\u4f60\u53ef\u80fd\u9700\u8981\u770b\u4ee5\u4e0b\u89c6\u9891\uff1a\n\n[\u7279\u5f81\u5411\u91cf](https://www.bilibili.com/video/BV1ys411472E?p=14)\n\n[\u77e9\u9635\u5bf9\u89d2\u5316](https://www.bilibili.com/video/BV1PA411T7b5?spm_id_from=333.337.search-card.all.click)\n\n\u4e0b\u9762\u6765\u8fdb\u5165\u6b63\u9898\uff0c\u7531\u4e8e\u6211\u4eec\u5b66\u7684\u662f OI \uff0c\u6240\u4ee5\u4e0b\u9762\u7684\u8bb2\u89e3\u4fa7\u91cd\u4e8e\u7406\u89e3\u800c\u4e0d\u4fa7\u91cd\u4e8e\u4e25\u8c28\u3002\u4f46\u5982\u679c\u6709\u672c\u8d28\u4e0a\u7684\u9519\u8bef\u8fd8\u671b\u6307\u51fa\n\n## \u77e9\u9635\u8c31\u5206\u89e3\n\n\u6211\u4eec\u5148\u56de\u987e\u4e00\u4e0b\u77e9\u9635\u5bf9\u89d2\u5316\uff0c\u5c06\u4e00\u4e2a $n$ \u9636\u77e9\u9635 $A$ \u89c6\u4e3a\u4e00\u4e2a\u7ebf\u6027\u53d8\u6362\uff0c\u5982\u679c\u5176\u6709 $n$ \u4e2a\u7ebf\u6027\u65e0\u5173\u7684\u7279\u5f81\u5411\u91cf\uff08\u8fd9\u4e9b\u5411\u91cf\u5728\u7ecf\u8fc7\u6b64\u7ebf\u6027\u53d8\u6362\u540e\u53ea\u53d7\u5230\u62c9\u4f38\u4f5c\u7528\uff09\uff0c\u6211\u4eec\u9009\u53d6\u8fd9 $n$ \u4e2a\u7279\u5f81\u5411\u91cf\u4e3a\u57fa\u7ec4\u6210\u4e00\u4e2a\u65b0\u7684\u7cfb\uff0c\u6211\u4eec\u4ee4 $Q$ \u662f\u7531 $A$ \u7684 $n$ \u4e2a\u7ebf\u6027\u65e0\u5173\u7684\u7279\u5f81\u5411\u91cf\u7ec4\u6210\u7684\u77e9\u9635\uff0c$\\Lambda$ \u662f\u7531\u6bcf\u4e2a\u5411\u91cf\u5bf9\u5e94\u7684\u7279\u5f81\u503c\u6240\u7ec4\u6210\u7684\u5bf9\u89d2\u77e9\u9635\uff0c\u90a3\u4e48\u5728\u539f\u7cfb\u4e0b\u7684 $A$ \u53d8\u6362\u5c31\u53ef\u4ee5\u88ab\u65b0\u7cfb\u4e0b\u7684 $\\Lambda$ \u53d8\u6362\u6240\u4ee3\u66ff\u3002 \n\n\u5148\u7ed9\u51fa\u8c31\u5206\u89e3\u5f0f\u5b50\uff1a\n$$\nA = Q\\Lambda Q^{-1} \\Leftrightarrow \\Lambda = Q^{-1}(AQ)\n$$\n\u6211\u4eec\u6765\u4ece\u7ebf\u6027\u53d8\u6362\u7684\u89d2\u5ea6\u7406\u89e3\u4e00\u4e0b\uff1a$Q$ \u5de6\u4e58\u4e00\u4e2a $A$ \u77e9\u9635\u4ee3\u8868\u7740\u5bf9 $Q$ \u4e2d\u7684\u5411\u91cf\u5b9e\u65bd $A$ \u53d8\u6362\uff0c\u53c8\u6839\u636e\u57fa\u53d8\u6362\u77e5\u8bc6\u548c\u4e0a\u6587\uff0c\u5411\u91cf\u5de6\u4e58\u77e9\u9635 $Q^{-1}$ \u662f\u6307\u5c06\u8be5\u5411\u91cf\u4ece\u65e7\u7cfb\u8f6c\u5316\u4e3a\u7531 $Q$ \u4e2d\u5411\u91cf\u7ec4\u6210\u7684\u57fa\u5f62\u6210\u7684\u65b0\u7cfb\uff0c\u4e5f\u5c31\u5bf9\u5e94\u7740\u65e7\u7cfb\u4e0b $A$ \u53d8\u6362\u5728\u65b0\u7cfb\u4e2d\u7684\u53d8\u6362\uff0c\u4e5f\u5c31\u662f $\\Lambda$ \u53d8\u6362\u3002\n\n## \u56de\u5230\u672c\u9898\n\n\u9012\u63a8\u77e9\u9635\u4e3a\uff1a\n\n$$\n\n\\left[\n\\begin{matrix}\n&1,&\\frac{1}{2},& \\frac{1}{3},&\\cdots, &\\frac{1}{n+1}\\\\\n&0,&\\frac{1}{2},&\\frac{1}{3}, &\\cdots, &\\frac{1}{n+1}\\\\\n&\\vdots,&\\vdots,&\\vdots, &\\ddots, &\\vdots\\\\\n&0, &0,&0, &\\cdots, &\\frac{1}{n + 1}\n\\end{matrix}\n\\right]\n$$\n\n\u7ed9\u5176\u7b97 $m$ \u6b21\u65b9\u663e\u7136\u8d85\u65f6\uff0c\u6211\u4eec\u8003\u8651\u8c31\u5206\u89e3\uff0c\u5bf9\u4e8e\u4e0a\u4e09\u89d2\u77e9\u9635\uff0c\u5148\u8003\u8651\u6c42\u5176\u7279\u5f81\u503c $\\lambda$\uff0c\u636e\u5b9a\u4e49\uff0c\u6709\uff1a\n$$\n\\begin{aligned}\nA\\vec{v} &= \\lambda I\\vec{v}\\\\\n(A-\\lambda I)\\vec{v} &= \\vec0\n\\end{aligned}\n$$\n\u7531\u4e8e $v$ \u662f\u975e\u96f6\u5411\u91cf\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u6210 \u77e9\u9635 $A-\\lambda I$ \u5bf9\u5176\u5b9e\u65bd\u4e86\u7ebf\u6027\u53d8\u6362\uff0c\u800c\u5374\u628a\u4e00\u4e2a\u975e\u96f6\u5411\u91cf\u53d8\u6210\u4e86\u96f6\u5411\u91cf\uff0c\u8bf4\u660e $\\vec{v}$ \u4e00\u5b9a\u53d7\u5230\u4e86\u964d\u7ef4\u6253\u51fb\uff0c\u6240\u4ee5\u77e9\u9635 $A-\\lambda I$ \u7684\u884c\u5217\u5f0f\u4e3a $0$\uff0c\u53c8\u56e0\u5176\u4e3a\u4e0a\u4e09\u89d2\u77e9\u9635\uff0c\u6240\u4ee5\u5176\u884c\u5217\u5f0f\u4e3a\u4e3b\u5bf9\u89d2\u7ebf\u6240\u6709\u5143\u7d20\u76f8\u4e58\uff0c\u8fd9\u6837\u5c31\u5f88\u5bb9\u6613\u5730\u89e3\u51fa\u4e86\u5176\u7279\u5f81\u503c\u5206\u522b\u4e3a $1,\\frac{1}{2},\\frac{1}{3},\\cdots,\\frac{1}{n+1}$\u3002\n\n\u73b0\u5728\u6765\u8003\u8651\u89e3\u51fa\u7279\u5f81\u5411\u91cf\uff0c\u6211\u4eec\u628a $\\lambda$ \u4ee3\u56de\uff0c\u5f97\n$$\n\\left[\n\\begin{matrix}\n&1-\\lambda,&\\frac{1}{2}, \\frac{1}{3},&\\cdots, &\\frac{1}{n+1}\\\\\n&0,&\\frac{1}{2}-\\lambda,\\frac{1}{3}, &\\cdots, &\\frac{1}{n+1}\\\\\n&\\vdots,&\\vdots, &\\ddots, &\\vdots\\\\\n&0, &0, &\\cdots, &\\frac{1}{n + 1}-\\lambda\n\\end{matrix}\n\\right]\n\\times \\vec{v} = \\vec{0}\n$$\n\u5c55\u5f00\u540e\u884c\u884c\u76f8\u51cf\uff0c\u5f97\uff1a\n$$\n\\begin{aligned}\n(1-\\lambda)v_1 + \\lambda v_2 &=0\\\\\n(\\frac{1}{2}-\\lambda)v_2 + \\lambda v_3 &=0\\\\\n(\\frac{1}{3}-\\lambda)v_3 + \\lambda v_4 &=0\\\\\n\\vdots\n\\end{aligned}\n$$\n\u6211\u4eec\u53d1\u73b0\uff0c\u5c06\u89e3\u5f97\u7684 $\\lambda$ \u5e26\u5165\u540e\uff0c\u4f1a\u51fa\u73b0\u4e00\u4e2a\u81ea\u7531\u5143\uff0c\u800c\u81ea\u7531\u5143\u4ee5\u4e0b\u7684\u672a\u77e5\u6570\u5747\u4e3a $0$\uff0c\u94a6\u5b9a\u81ea\u7531\u5143\u4e3a $1$\uff0c\u5219\u6211\u4eec\u53ef\u89e3\u51fa\u81ea\u7531\u5143\u4ee5\u4e0a\u7684\u6240\u6709\u672a\u77e5\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u89e3\u5f97\u7684\u7279\u5f81\u5411\u91cf $v_k = \\sum_{i = 0}^n(-1)^{i + k}\\binom{k}{i} \\vec{e_{i+1}}$ \u7ec4\u6210\u7684\u77e9\u9635 $Q$ \u4e3a\uff1a\n$$\n\\left[\n\\begin{matrix}\n&1,&-1, &1, &-1&\\cdots, &(-1)^n\\\\\n&0,&1,&-2, &3, &\\cdots, &(-1)^{n + 1}\\binom{n}{1}\\\\\n&0,&0,&1, &3,&\\cdots,  &(-1)^n\\binom{n}{2}\\\\\n&\\vdots,&\\vdots, &\\vdots, &\\vdots, &\\ddots, &\\vdots\\\\\n&0, &0, &\\cdots, &\\cdots,&\\cdots,&1\n\\end{matrix}\n\\right]\n$$\n\u5bf9\u8be5\u77e9\u9635\u6c42\u9006\u6211\u4f7f\u7528\u7684\u662f\u4ee3\u6570\u4f59\u5b50\u5f0f\u6cd5\uff0c\u5f97\u5230\u7684\u7ed3\u679c\u628a\u4e0a\u9762\u77e9\u9635\u6240\u6709\u542b $(-1)$ \u7684\u82e5\u5e72\u6b21\u65b9\u9879\u90fd\u53bb\u6389\u5c31\u884c\u4e86\u3002\n\n\u8bbe\u521d\u59cb\u5411\u91cf\u4e3a $\\vec{p}$\uff0c \u6211\u4eec\u8981\u6c42 $A^m \\vec{p} = Q\\Lambda^m Q^{-1} \\vec{p}$\uff0c\u8003\u8651\u5229\u7528\u7ed3\u5408\u7387\u4ece\u53f3\u5f80\u5de6\u8ba1\u7b97\uff0c\u6211\u4eec\u53ea\u9700\u8981\u77e5\u9053 $Q\\vec{p}$ \u4e0e $Q^{-1}\\vec{p}$ \u5982\u4f55\u5feb\u901f\u8ba1\u7b97\u5c31\u53ef\u4ee5\u4e86\uff0c\u6211\u4eec\u7528 $Q\\vec{p}$ \u4e3e\u4f8b\uff1a\n$$\n\\begin{aligned}\n(Q\\vec{p})_i &= \\sum_{k = 0}^n Q_{i,k}\u00b7p_{k}\\\\\n&=\\frac{(-1)^i}{i !} \\sum_{k = 0}^i (-1)^j k!p_k \\frac{1}{(k-i)!}\n\\end{aligned}\n$$\n\u662f\u4e2a\u5dee\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u628a\u5176\u4e2d\u4e00\u4e2a\u591a\u9879\u5f0f\u7ffb\u8f6c\u4e00\u4e0b $NTT$ \u4e00\u8fb9\u4e58\u51fa\u6765\u628a\u7ed3\u679c\u518d\u7ffb\u8f6c\u4e00\u8fb9\u5c31\u884c\u4e86\u3002\n\n",
        "postTime": 1658154054,
        "uid": 66769,
        "name": "Ji_Kang",
        "ccfLevel": 0,
        "title": "CF923E\u9898\u89e3"
    },
    {
        "content": "### CF923E Perpetual Subtraction\n\n--update 2021.02.03--\n\n\u4fee\u6b63\u4e8c\u9879\u5f0f\u53cd\u6f14\u7684\u4e00\u4e2a\u7b14\u8bef\n\n#### Solution\n\n\u8bbe\u6570\u5217$\\{f_i^k\\}$\u662f\u7b2c$k$\u6b21\u64cd\u4f5c\u540e\u6570\u5b57\u4e3a$i$\u7684\u6982\u7387\uff0c\u8003\u8651\u5230\u6bcf\u6b21rand\u540e\u6570\u5b57\u4e0d\u53ef\u80fd\u589e\u5927\n\n\u6240\u4ee5$f_i^{k+1}=\\sum\\limits_{j=i}^n\\dfrac{f_{j}^{k}}{j+1}$\uff0c\u56e0\u4e3a\u6bcf\u4e2a$f_i^k$\u90fd\u6709$[0,i]$\u4e00\u5171$i+1$\u79cd\u53d6\u503c\uff0c\u5176\u4e2d\u6709$\\frac{1}{i+1}$\u6982\u7387\u9009\u5230\u7279\u5b9a\u7684\u6570\n\n\u5bf9\u4e8e\u8fd9\u79cd\u8fed\u4ee3\u7684\u6570\u5217\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4ed6\u4eec\u751f\u6210\u51fd\u6570\u95f4\u7684\u5173\u7cfb\uff0c\u56e0\u4e3a\u591a\u9879\u5f0f\u6709\u7740\u4f18\u7f8e\u7684\u6027\u8d28\n\n\u8bbe$F_k=\\sum x^if_i^k$\n\n\u90a3\u4e48$F_{k+1}=\\sum\\limits_{i=0}^nx^i\\sum\\limits_{j=i}^n\\dfrac{f_j^k}{j+1}$\n\n\u4ea4\u6362\u6c42\u548c\u987a\u5e8f$\\sum\\limits_{i=0}^n\\dfrac{f_i^k}{i+1}\\sum\\limits_{j=0}^ix^i=\\sum\\limits_{i=0}^n\\dfrac{f_i^k}{i+1}\\dfrac{x^{i+1}-1}{x-1}$\u7b49\u6bd4\u6570\u5217\u6c42\u548c\u4e00\u4e0b\n\n\u63d0\u53d6\u51fa\u65e0\u5173\u53d8\u91cf$\\dfrac{1}{x-1}\\sum\\limits_{i=0}^n{f_i^k}(\\dfrac{x^{i+1}}{i+1}-\\dfrac{1}{i+1})$\u52a8\u7528\u4e00\u70b9\u89c2\u5bdf\u529b\u80fd\u591f\u53d1\u73b0$(\\dfrac{x^{i+1}}{i+1}-\\dfrac{1}{i+1})=\\int^x_0 z^i-\\int^1_0z^i=\\int^x_1z^i\\mathbb{d}z$\n\n\u6240\u4ee5$F_{k+1}=\\dfrac{\\int_1^xF_k(z)\\mathbb{d}z}{x-1}$\n\n\u6362\u5143\u8bbe$G_k(x)=F_k(x+1)=\\dfrac{1}{x}\\int_0^xG_k(z)\\mathbb{d}z$\uff0c\n\n\u56de\u987e\u4e0b\u751f\u6210\u51fd\u6570\u57fa\u672c\u64cd\u4f5c\uff0c\u80fd\u591f\u53d1\u73b0\u65b0\u6570\u5217$g_{i}^{k+1}=\\dfrac{g_i^k}{i+1}$\n\n$m$\u6b21\u64cd\u4f5c\u4ec5\u9700$m$\u6b21\u5e42\u5373\u53ef\n\n\u7136\u540e\u6211\u4eec\u9700\u8981\u5feb\u901f\u7684\u4ece$g_i^k$\u53d8\u6210$f_i^k$(\u4e3a\u4e86\u65b9\u4fbf\u4ee5\u4e0b\u7701\u7565$k$)\n\n$G=\\sum g_ix^i=\\sum f_i(x+1)^i=\\sum f_i\\sum\\binom{i}{j}x^i$\u63d0\u53d6\u4e00\u4e0b\n\n$g_i=\\sum\\limits_{j=i}^n\\binom{j}{i}f_j$\n\n\u53cd\u6f14\u4e00\u4e0b\n\n$f_i=\\sum\\limits_{j=i}^n(-1)^{j-i}\\binom{j}{i}g_j$\n\n\u7ed3\u675f\u5566~~\n\n```cpp\n#include \"Polynomial.h\"\n#include <iostream>\nusing namespace std;\nusing namespace Poly;\nPolynomial<long long> f, g;\nconst ll Mod   = 998244353;\nconst int maxn = 1e6 + 7;\ntypedef long long ll;\nll n, m;\nll fac[maxn], invfac[maxn];\nll a[maxn];\nint main() {\n    cin >> n >> m;\n    n++;\n    f.resize(n);\n    g.resize(n);\n    m %= (Mod - 1);\n    fac[0] = 1;\n    for (int i = 1; i < n; i++)\n        fac[i] = 1ll * fac[i - 1] * i % Mod;\n    invfac[n - 1] = invx(fac[n - 1]);\n    for (int i = n - 2; i + 1; i--)\n        invfac[i] = 1ll * invfac[i + 1] * (i + 1) % Mod;\n    for (int i = 0; i < n; i++) {\n        cin >> a[i];\n    }\n    for (int i = 0; i < n; i++) {\n        f[n - i - 1] = 1ll * fac[i] * a[i] % Mod;\n    }\n    for (int i = 0; i < n; i++) {\n        g[i] = invfac[i];\n    }\n    f = f * g; // clac g_i^1\n    f.resize(n);\n    for (int i = 0; i < n; i++) {\n        g[i] = 1ll * invfac[i] * f[n - i - 1] % Mod;\n    }\n    for (int i = 0; i < n; i++) {\n        g[i] = 1ll * g[i] * invx(qpow(i + 1, m)) % Mod; // calc g_i^m\n    }\n    for (int i = 0; i < n; i++) {\n        f[n - i - 1] = 1ll * fac[i] * g[i] % Mod;\n    }\n    for (int i = 0; i < n; i++) {\n        g[i] = (i & 1) ? Mod - invfac[i] : invfac[i];\n    }\n    f = f * g;\n    for (int i = 0; i < n; i++) {\n        cout << 1ll * invfac[i] * f[n - i - 1] % Mod << \" \";\n    }\n}\n```\n\n",
        "postTime": 1612259644,
        "uid": 46099,
        "name": "YCS_GG",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF923E \u3010Perpetual Subtraction\u3011"
    },
    {
        "content": "$$\\texttt{Preface}$$\n\n\u7531\u4e8e\u7b14\u8005\u592a\u83dc\uff0c\u6240\u4ee5\u82b1\u4e86\u5927\u6982 $1h$ \u591a\u624d\u628a\u751f\u6210\u51fd\u6570\u7684\u505a\u6cd5\u770b\u61c2\uff0c\u5199\u7bc7\u9898\u89e3\u9632\u6b62\u4e0b\u6b21\u6765\u7684\u65f6\u5019\u5fd8\u4e86 $QwQ$\u3002\n\n$$\\texttt{Description}$$\n\n[Perpetual Subtraction](https://www.luogu.com.cn/problem/CF923E)\n\n$$\\texttt{Solution}$$\n\n\u9996\u5148\u6211\u4eec\u8bbe $f(i, k)$ \u8868\u793a\u7ecf\u8fc7 $k$ \u6b21\u64cd\u4f5c\u540e $x$ \u53d6\u5230 $i$ \u7684\u6982\u7387\uff0c\u5176\u4e2d $f(i, 0) = p(i)$\u3002\n\n\u7136\u540e\u5bb9\u6613\u5217\u51fa\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$f(i, k) = \\sum_{j \\ge i} \\dfrac{f(j, k - 1)}{j + 1}$$\n\n\u63a5\u7740\u6211\u4eec\u8bbe\u51fa $f(i, k)$ \u7684\u666e\u901a\u751f\u6210\u51fd\u6570 $F_k(x)$\uff1a\n\n$$F_k(x) = \\sum_{i = 0}^n f(i, k) \\cdot x ^ i$$\n\n\u628a\u8f6c\u79fb\u65b9\u7a0b\u4ee3\u5165\u5f97\uff1a\n\n$$F_k(x) = \\sum_{i = 0}^n x ^ i \\sum_{j \\ge i} \\dfrac{f(j, k - 1)}{j + 1}$$\n\n$$=\\sum_{j = 0}^n \\dfrac{f(j, k - 1)}{j + 1} \\sum_{i = 0}^j x ^ i$$\n\n$$= \\sum_{j = 0}^n \\dfrac{f(j, k - 1)}{j + 1} \\cdot \\dfrac{x ^ {j + 1} - 1}{j + 1}$$\n\n$$= \\dfrac{1}{x + 1} \\cdot \\sum_{j = 0}^n \\dfrac{x ^ {j + 1} - 1}{j + 1} \\cdot f(j, k - 1)$$\n\n$$\\because \\int_0^x t ^ i \\cdot dt = \\dfrac{x ^ {i + 1}}{i + 1}$$\n\n$$\\therefore \\dfrac{x ^ {j + 1} - 1}{j + 1} = \\int_{1}^{x} t ^ i \\cdot dt$$\n\n\u539f\u5f0f\u5c31\u53d8\u6210\u4e86\uff1a\n\n$$\\dfrac{1}{x + 1} \\cdot \\sum_{j = 0}^n \\int_{1}^{x} t ^ j \\cdot dt \\cdot f(j, k - 1)$$\n\n$$= \\dfrac{1}{x + 1} \\int_{1}^{x} dt\\cdot \\sum_{j = 0}^n t ^ j \\cdot f(j, k - 1)$$\n\n$$= \\dfrac{1}{x + 1} \\int_{1}^{x} F_{k - 1}(t) \\cdot dt$$\n\n\u660e\u663e\u8fd9\u4e2a $\\dfrac{1}{x + 1}$ \u4e0e\u79ef\u5206\u4e0b\u754c $1$ \u6bd4\u8f83\u96be\u5904\u7406\uff0c\u6211\u4eec\u5e0c\u671b\u628a $\\dfrac{1}{x + 1}$ \u53d8\u6210 $\\dfrac{1}{x}$\uff0c\u79ef\u5206\u4e0b\u754c\u628a $1$ \u66ff\u6362\u6210 $0$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528 $x$ \u66ff\u6362 $x + 1$\uff0c\u8bbe $G_k(x) = F_k(x + 1)$\uff0c\u5219\uff1a\n\n$$G_k(x) = F_k(x + 1) = \\dfrac{1}{x} \\int_1^{x + 1} F_{k - 1}(t) \\cdot dt$$\n\n$$= \\dfrac{1}{x} \\int_{0}^ x F_{k - 1}(t + 1) \\cdot dt$$\n\n$$= \\dfrac{1}{x} \\int_{0}^ x G_{k - 1}(t) \\cdot dt$$\n\n$$= \\dfrac{1}{x} \\int_{0}^ x \\sum_{i = 0}^n g(i, k - 1) \\cdot dt \\cdot t ^ i$$\n\n$$= \\dfrac{1}{x} \\sum_{i = 0}^n g(i, k - 1) \\cdot \\int_{0}^ x t ^ i \\cdot dt$$\n\n$$= \\dfrac{1}{x} \\sum_{i = 0}^n g(i, k - 1) \\cdot \\dfrac{x ^ {i + 1}}{i + 1}$$\n\n$$= \\sum_{i = 0}^n \\dfrac{g(i, k - 1)}{i + 1} \\cdot x ^ i$$\n\n\u6240\u4ee5\u53ef\u5f97\uff1a\n\n$$g(i, k) = \\dfrac{g(i, k - 1)}{i + 1}$$\n\n$$\\therefore g(i, m) = \\dfrac{g(i, 0)}{(i + 1) ^ m}$$\n\n\u76f4\u63a5\u7528\u5feb\u901f\u5e42\u5373\u53ef\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u5982\u4f55\u4ece $F_0$ \u8f6c\u5230 $G_0$\uff0c\u4ee5\u53ca\u5982\u4f55\u4ece $G_m$ \u8f6c\u5230 $F_m$\u3002\n\n$$G_0(x) = F_0(x + 1) = \\sum_{i = 0}^n p(i) \\cdot (x + 1) ^ i$$\n\n\u6839\u636e\u4e8c\u9879\u5f0f\u5b9a\u7406\uff1a\n\n$$G(x) = \\sum_{i = 0}^n f(i) \\cdot \\sum_{j = 0}^i {i \\choose j} \\cdot x ^ j$$\n\n\u5c06 $j$ \u63d0\u5230\u524d\u9762\u6765\uff1a\n\n$$\\sum_{j = 0}^n x ^ j \\cdot \\sum_{i = j}^n {i \\choose j} \\cdot f(i)$$\n\n\u6240\u4ee5\uff1a\n\n$$g(i) = \\sum_{j = i}^n {j \\choose i} \\cdot f(j)$$\n\n\u8003\u8651\u5c06\u7ec4\u5408\u6570\u62c6\u5f00\u6765\uff1a\n\n$$g(i) = \\sum_{j = i}^n \\dfrac{j! \\cdot f(j)}{i! \\cdot (j - i)!}$$\n\n$$g(i) \\cdot i! = \\sum_{j = i}^n \\dfrac{j! \\cdot f(j)}{(j - i)!}$$\n\n\u8003\u8651\u8bbe $A(x) = x! \\cdot f(x), B(x) = \\dfrac{1}{x!}$\uff0c\u5219\uff1a\n\n$$g(i) \\cdot i! = \\sum_{j = i}^n A(j) \\cdot B(j - i)$$\n\n\u6211\u4eec\u4f1a\u53d1\u73b0 $A$ \u4e0e $B$ \u7684\u7cfb\u6570\u5dee\u4e3a\u5b9a\u503c\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a $B$ \u7ffb\u8f6c\u8fc7\u6765\uff1a\n\n\u8bbe $B'(x) = \\dfrac{1}{(n - x)!}$\uff0c\u5219\uff1a\n\n$$g(i) = \\sum_{j = i}^n A(j) \\cdot B'(n - j + i)$$\n\n$$g(i) = \\sum_{j = 0}^{n - i} A(n - j) \\cdot B'(j - i)$$\n\n\u8fd9\u4e2a\u5c31\u662f\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\u4e86\uff0c\u5377\u8d77\u6765\u4e4b\u540e\u7b2c $n - i$ \u4f4d\u7684\u7cfb\u6570\u5373\u662f $g(i)$\u3002\n\n\u7136\u540e\u8003\u8651\u4ece $G_m$ \u8f6c\u5230 $F_m$\uff1a\n\n\u6839\u636e\u4e8c\u9879\u5f0f\u53cd\u6f14\uff1a\n\n$$g(i) = \\sum_{j = i}^n {j \\choose i} \\cdot f(j) \\Leftrightarrow f(i) = \\sum_{j = i}^n (-1)^{j - i} \\cdot {j \\choose i} \\cdot g(j)$$\n\n\u540e\u9762\u8f6c\u5316\u6210\u5377\u79ef\u5f62\u5f0f\u7684\u6b65\u9aa4\u4e0e\u524d\u9762\u76f8\u540c\uff0c\u8fd9\u91cc\u5c31\u4e0d\u4f5c\u8d58\u8ff0\u4e86\u3002\n\n$$\\texttt{Code}$$\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing i64 = long long;\nusing poly = vector <int>;\n\nconstexpr int mod = 998244353, ginv = 332748118;\n\nint n, len = 1, l = 0, rev[400005], p[100005];\nint fac[100005], ifac[100005];\ni64 m;\n\nint qpow(int x, i64 p) {\n    int ans = 1;\n\n    while (p) {\n        if (p & 1) ans = 1ll * ans * x % mod;\n        p >>= 1, x = 1ll * x * x % mod;\n    }\n\n    return ans;\n}\n\nvoid ntt(poly &a, int inv, int len) {\n    for (int i = 0; i < len; ++i) {\n        if (i < rev[i]) {\n            swap(a[i], a[ rev[i] ]);\n        }\n    }\n\n    for (int mid = 1; mid < len; mid <<= 1) {\n        int gn = (inv == 1 ? qpow(3, (mod - 1) / (mid << 1)) : qpow(ginv, (mod - 1) / (mid << 1)));\n\n        for (int i = 0; i < len; i += (mid << 1)) {\n            for (int j = 0, g0 = 1; j < mid; ++j, g0 = 1ll * g0 * gn % mod) {\n                int g1 = a[ i + j ], g2 = a[ i + j + mid ];\n                a[ i + j ] = (1ll * g1 + 1ll * g2 * g0) % mod;\n                a[ i + j + mid ] = (1ll * g1 - 1ll * g2 * g0 % mod + mod) % mod;\n            }\n        }\n    }\n}\n\npoly g, f;\n\nint main() {\n    ios :: sync_with_stdio(0), cin.tie(0);\n\n    cin >> n >> m;\n\n    for (int i = 0; i <= n; ++i) {\n        cin >> p[i];\n    }\n\n    while (len <= (n << 1)) {\n        len <<= 1, ++l;\n    }\n\n    for (int i = 0; i < len; ++i) {\n        rev[i] = (rev[ i >> 1 ] >> 1) | ((i & 1) << (l - 1));\n    }\n\n    fac[0] = 1;\n\n    for (int i = 1; i <= n; ++i) {\n        fac[i] = 1ll * fac[ i - 1 ] * i % mod;\n    }\n\n    ifac[n] = qpow(fac[n], mod - 2);\n\n    for (int i = n; i; --i) {\n        ifac[ i - 1 ] = 1ll * ifac[i] * i % mod;\n    }\n\n    poly a(len, 0), b(len, 0);\n\n    for (int i = 0; i <= n; ++i) {\n        a[ n - i ] = 1ll * fac[i] * p[i] % mod;\n    }\n\n    for (int i = 0; i <= n; ++i) {\n        b[i] = ifac[i];\n    }\n\n    ntt(a, 1, len), ntt(b, 1, len), g.resize(len, 0);\n\n    for (int i = 0; i < len; ++i) {\n        g[i] = 1ll * a[i] * b[i] % mod;\n    }\n\n    ntt(g, -1, len);\n\n    for (int i = 0; i < len; ++i) {\n        g[i] = 1ll * g[i] * qpow(len, mod - 2) % mod;\n    }\n\n    reverse(g.begin(), g.begin() + n + 1);\n\n    for (int i = 0; i <= n; ++i) {\n        g[i] = 1ll * g[i] * ifac[i] % mod;\n    }\n\n    for (int i = n + 1; i < len; ++i) {\n        g[i] = 0;\n    }\n\n    for (int i = 0; i <= n; ++i) {\n        g[i] = 1ll * g[i] * qpow(qpow(i + 1, m), mod - 2) % mod;\n    }\n\n    fill(a.begin(), a.end(), 0), fill(b.begin(), b.end(), 0);\n\n    for (int i = 0; i <= n; ++i) {\n        a[ n - i ] = 1ll * g[i] * fac[i] % mod;\n    }\n\n    for (int i = 0; i <= n; ++i) {\n        b[i] = 1ll * ifac[i] * qpow(mod - 1, i) % mod;\n    }\n\n    ntt(a, 1, len), ntt(b, 1, len), f.resize(len, 0);\n\n    for (int i = 0; i < len; ++i) {\n        f[i] = 1ll * a[i] * b[i] % mod;\n    }\n\n    ntt(f, -1, len);\n\n    for (int i = 0; i < len; ++i) {\n        f[i] = 1ll * f[i] * qpow(len, mod - 2) % mod;\n    }\n\n    reverse(f.begin(), f.begin() + n + 1);\n\n    for (int i = 0; i <= n; ++i) {\n        cout << 1ll * f[i] * ifac[i] % mod << \" \\n\" [ i == n ];\n    }\n\n    return 0;\n}\n```\n\n$$\\texttt{Thanks for watching!}$$",
        "postTime": 1671418879,
        "uid": 355448,
        "name": "Fido_Puppy",
        "ccfLevel": 0,
        "title": "Perpetual Subtraction"
    },
    {
        "content": "\u4e3b\u8981\u662f\u611f\u89c9\u522b\u4eba\u7684\u751f\u6210\u51fd\u6570\u7684\u505a\u6cd5\u6709\u70b9\u602a\u624d\u5199\u7684\u8fd9\u7bc7\u9898\u89e3\u3002\n\n\u8bbe $\\mathrm{dp}_{i,j}$ \u8868\u793a\u5f53\u524d\u503c\u662f $i$ \u4e14\u5df2\u7ecf\u9009\u4e86 $j$ \u4e2a\u3002\n\n\u4e0d\u96be\u5f97\u5230\u8f6c\u79fb\uff1a $\\mathrm{dp}_{i,j}=\\sum_{k\\ge j} \\frac{1}{(k+1)!}\\mathrm{dp}_{i-1,k}$\u3002\n\n\u9996\u5148\u5199\u6210\u540e\u7f00\u548c\u5f62\u5f0f\uff0c\u8bbe $s_{i,j}$ \u8868\u793a $\\mathrm{dp}_i$ \u7684\u540e\u7f00\u548c\u3002\n\n$s_{i,j}=s_{i,j+1}+\\frac{\\mathrm{dp}_{i,j}}{j+1}$ \u5373 $s_{i,j}=s_{i,j+1}+\\frac{s_{i-1,j}}{j+1}$\u3002\n\n\u5199\u51fa $s$ \u7684\u751f\u6210\u51fd\u6570\uff1a\n\n$$\n\\begin{aligned}\nxS_i(x)=S_i(x)+\\int S_{i-1}(x)\\\\\nS_i(x)=\\frac{1}{x-1}\\int S_{i-1}(x)\\\\\n\\end{aligned}\n$$\n\n\u4e0d\u59a8\u8bbe $H_i(x)=S_i(x+1)$ \u90a3\u4e48\u65b9\u7a0b\u53ef\u5199\u6210\uff1a\n\n$$\nH_i(x)=\\frac{1}{x}\\int H_{i-1}(x)\n$$\n\n\u63d0\u53d6\u7cfb\u6570\u53ef\u4ee5\u5f97\u5230\u548c\u5176\u4ed6\u9898\u89e3\u7c7b\u4f3c\u7684\u7ed3\u679c\uff0c\u5373 $h_{i,j}=\\frac{h_{i-1,j}}{j+1}$\u3002\n\n\u5269\u4e0b\u7684\u5c31\u53ea\u5269\u4e0b\u591a\u9879\u5f0f\u5e73\u79fb\u4e86\u3002\n\n\u5410\u69fd\uff0c\u5b9e\u9645\u4e0a\u4f60\u77e5\u9053 $H(x)=S(x+1)$ \u65f6\u5019 $S(x)=H(x-1)$ \u76f4\u63a5\u591a\u9879\u5f0f\u5e73\u79fb\u5c31\u884c\uff0c\u6ca1\u5fc5\u8981\u7528\u4e8c\u9879\u5f0f\u53cd\u6f14\u3002\u3002\u3002\u3002",
        "postTime": 1655286920,
        "uid": 184069,
        "name": "Imitators",
        "ccfLevel": 0,
        "title": "solution-cf923e"
    },
    {
        "content": "UPD on 2021.5.9\uff1a\u4fee\u4e86\u4e2a typo\n\n[Codeforces \u9898\u76ee\u4f20\u9001\u95e8](https://codeforces.com/contest/923/problem/E) & [\u6d1b\u8c37\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF923E)\n\n\u795e\u4ed9\u9898 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%\n\n\u9996\u5148\u8003\u8651\u6700\u6734\u7d20\u7684 $dp$\uff0c\u8bbe $dp_{z,i}$ \u8868\u793a\u7ecf\u8fc7 $z$ \u6b21\u64cd\u4f5c\u540e\u5269\u4e0b\u7684\u6570\u4e3a $i$ \u7684\u6982\u7387\uff0c\u90a3\u4e48\u663e\u7136\u6709 $dp$ \u8f6c\u79fb\u65b9\u7a0b $dp_{z,i}=\\sum\\limits_{j\\ge i}dp_{z-1,j}\u00b7\\dfrac{1}{j+1}$\u3002\n\n\u8fb9\u754c\u6761\u4ef6 $dp_{0,i}=p_i$\n\n\u76f4\u63a5\u9012\u63a8\u663e\u7136\u4e0d\u884c\uff0c\u8003\u8651\u4f18\u5316\uff0c\u6211\u4eec\u8bb0 $F_z(x)=\\sum\\limits_{i=0}^ndp_{z,i}x^i$\uff0c\u6211\u4eec\u4e0d\u59a8\u6765\u63a2\u7a76\u4e00\u4e0b $F_z(x)$ \u6709\u54ea\u4e9b\u6027\u8d28\uff1a\n$$\n\\begin{aligned}\nF_z(x)&=\\sum\\limits_{i=0}^ndp_{z,i}x^i\\\\\n&=\\sum\\limits_{i=0}^n\\sum\\limits_{j\\ge i}dp_{z-1,j}\\dfrac{1}{j+1}x^i\\\\\n&=\\sum\\limits_{j=0}^ndp_{z-1,j}\\dfrac{1}{j+1}\\sum\\limits_{i=0}^jx^i\\\\\n&=\\sum\\limits_{j=0}^ndp_{z-1,j}\\dfrac{1}{j+1}\\dfrac{x^{j+1}-1}{x-1}\\\\\n&=\\dfrac{1}{x-1}\\sum\\limits_{j=0}^ndp_{z-1,j}\\dfrac{x^{j+1}-1}{j+1}\n\\end{aligned}\n$$\n\u6ce8\u610f\u5230\n$$\n\\dfrac{x^{j+1}}{j+1}=\\int_0^xk^j\\,\\mathrm dk,\\dfrac{1}{j+1}=\\int_0^1k^j\\,\\mathrm dk\n$$\n\u56e0\u6b64\n$$\n\\dfrac{x^{j+1}-1}{j+1}=\\int_1^xk^j\\,\\mathrm dk\n$$\n\u4ee3\u5165\u5f97\n$$\n\\begin{aligned}\n&\\dfrac{1}{x-1}\\sum\\limits_{j=0}^ndp_{z-1,j}\\dfrac{x^{j+1}-1}{j+1}\\\\\n=&\\dfrac{1}{x-1}\\sum\\limits_{j=0}^ndp_{z-1,j}\\int_1^xk^j\\,\\mathrm dk\\\\\n=&\\dfrac{1}{x-1}\\int_1^x\\sum\\limits_{j=0}^ndp_{z-1,j}k^j\\,\\mathrm dk\\\\\n=&\\dfrac{1}{x-1}\\int_1^xF_{z-1}(k)\\,\\mathrm dk\n\\end{aligned}\n$$\n\u6ce8\u610f\u5230\u8fd9\u8fb9\u79ef\u5206\u4e0b\u754c\u662f $1$\uff0c\u5e76\u4e14\u5de6\u8fb9\u8fd8\u591a\u51fa\u4e86\u4e2a\u6076\u5fc3\u7684 $\\dfrac{1}{x-1}$\uff0c\u975e\u5e38\u68d8\u624b\uff0c\u56e0\u6b64\u8003\u8651\u5c06\u8fd9\u4e2a $\\dfrac{1}{x-1}$ \u53bb\u6389\uff0c\u4e8e\u662f\u8003\u8651\u8bbe $G_z(x)=F_z(x+1)$\uff0c\u90a3\u4e48\uff1a\n$$\n\\begin{aligned}\nG_z(x)&=F_z(x+1)\\\\\n&=\\dfrac{1}{x}\\int_1^{x+1}F_{z-1}(k)\\,\\mathrm dk\\\\\n&=\\dfrac{1}{x}\\int_0^{x}F_{z-1}(k+1)\\,\\mathrm dk\\\\\n&=\\dfrac{1}{x}\\int_0^{x}G_{z-1}(k)\\,\\mathrm dk\\\\\n\\end{aligned}\n$$\n\u566b\uff01\u597d\uff01\u8fd9\u4e0b\u4e0b\u754c\u53d8\u6210 $0$ \u4e86\uff0c\u5de6\u8fb9\u4e5f\u6ca1\u6709\u8ba8\u538c\u7684 $\\dfrac{1}{x-1}$ \u4e86\uff01\n\n\u63a5\u4e0b\u6765\u8003\u8651\u8bbe $G_z(x)=\\sum\\limits_{i=0}^ng_{z,i}x^i$\uff0c\u90a3\u4e48\u6839\u636e $G_z(x)=\\dfrac{1}{x}\\int_0^xG_{z-1}(k)\\,\\mathrm dk$ \u6709\n$$\nG_z(x)=\\dfrac{1}{x}\\int_0^xG_{z-1}(k)\\,\\mathrm dk=\\dfrac{1}{x}\\sum\\limits_{i=1}^{n+1}\\dfrac{g_{z-1,i-1}}{i}x^i=\\sum\\limits_{i=0}^{n}\\dfrac{g_{z-1,i}}{i+1}x^i\n$$\n\u56e0\u6b64 $g_{z,i}=\\dfrac{g_{z-1,i}}{i+1}$\u3002\n\n\u8fd9\u73a9\u610f\u513f\u663e\u7136\u53ef\u4ee5\u5feb\u901f\u5e42\u52a0\u901f\uff0c\u5373 $g_{m,i}=\\dfrac{g_{0,i}}{(i+1)^m}$\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\u63a5\u4e0b\u6765\u6211\u4eec\u53ea\u9700\u5b9e\u73b0 $F_0(x)\\to G_0(x),G_m(x)\\to F_m(x)$ \u5373\u53ef\u3002\n\n\u6ce8\u610f\u5230\n$$\n\\begin{aligned}\nF_0(x+1)&=\\sum\\limits_{i=0}^np_i(x+1)^i\\\\\n&=\\sum\\limits_{i=0}^np_i\\sum\\limits_{j=0}^i\\dbinom{i}{j}x^j\\\\\n&=\\sum\\limits_{j=0}^i(\\sum\\limits_{i=j}^n\\dbinom{i}{j}p_i)x^j\n\\end{aligned}\n$$\n\u6545\n$$\ng_{0,i}=\\sum\\limits_{j=i}^n\\dbinom{j}{i}p_j\n$$\n\u62c6\u7ec4\u5408\u6570\u53ef\u5f97 $g_{0,i}=\\sum\\limits_{j=i}^n\\dfrac{j!}{i!(j-i)!}p_j=\\dfrac{1}{i!}\\sum\\limits_{j=i}^nj!p_j\u00b7\\dfrac{1}{(j-i)!}$\uff0c\u6309\u7167 NTT \u6c42\u5dee\u5377\u79ef\u7684\u5957\u8def\u6765\u5373\u53ef\u3002\n\n$G_m(x)\\to F_m(x)$ \u4e5f\u540c\u7406\uff0c\u7c7b\u4f3c\u5730\u6709\n$$\ng_{m,i}=\\sum\\limits_{j=i}^n\\dbinom{j}{i}f_{m,j}\n$$\n\u4e8c\u9879\u5f0f\u53cd\u6f14\u4e00\u4e0b\u53ef\u5f97\n$$\nf_{m,i}=\\sum\\limits_{j=i}^n\\dbinom{j}{i}(-1)^{j-i}g_{m,j}\n$$\n\u548c\u4e0a\u9762\u4e00\u6837 NTT \u6c42\u904d\u5dee\u5377\u79ef\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $n\\log n$\u3002\n\n```cpp\nconst int MAXN=1e5;\nconst int MAXP=1<<18;\nconst int MOD=998244353;\nconst int pr=3;\nconst int ipr=(MOD+1)/3;\nint n,f[MAXN+5],g[MAXN+5],h[MAXN+5];ll m;\nint fac[MAXN+5],ifac[MAXN+5];\nvoid init_fac(int n){\n\tfor(int i=(fac[0]=ifac[0]=ifac[1]=1)+1;i<=n;i++) ifac[i]=1ll*ifac[MOD%i]*(MOD-MOD/i)%MOD;\n\tfor(int i=1;i<=n;i++) fac[i]=1ll*fac[i-1]*i%MOD,ifac[i]=1ll*ifac[i-1]*ifac[i]%MOD;\n}\nint qpow(int x,int e){\n\tint ret=1;\n\tfor(;e;e>>=1,x=1ll*x*x%MOD) if(e&1) ret=1ll*ret*x%MOD;\n\treturn ret;\n}\nint rev[MAXP+5];\nvoid NTT(vector<int> &a,int len,int type){\n\tint lg=31-__builtin_clz(len);\n\tfor(int i=0;i<len;i++) rev[i]=(rev[i>>1]>>1)|((i&1)<<(lg-1));\n\tfor(int i=0;i<len;i++) if(i<rev[i]) swap(a[i],a[rev[i]]);\n\tfor(int i=2;i<=len;i<<=1){\n\t\tint W=qpow((type<0)?ipr:pr,(MOD-1)/i);\n\t\tfor(int j=0;j<len;j+=i){\n\t\t\tfor(int k=0,w=1;k<(i>>1);k++,w=1ll*w*W%MOD){\n\t\t\t\tint X=a[j+k],Y=1ll*a[(i>>1)+j+k]*w%MOD;\n\t\t\t\ta[j+k]=(X+Y)%MOD;a[(i>>1)+j+k]=(X-Y+MOD)%MOD;\n\t\t\t}\n\t\t}\n\t}\n\tif(type==-1){\n\t\tint ivn=qpow(len,MOD-2);\n\t\tfor(int i=0;i<len;i++) a[i]=1ll*a[i]*ivn%MOD;\n\t}\n}\nvector<int> conv(vector<int> a,vector<int> b){\n\tint LEN=1;while(LEN<a.size()+b.size()) LEN<<=1;\n\ta.resize(LEN,0);b.resize(LEN,0);NTT(a,LEN,1);NTT(b,LEN,1);\n\tfor(int i=0;i<LEN;i++) a[i]=1ll*a[i]*b[i]%MOD;NTT(a,LEN,-1);\n\treturn a;\n}\nint main(){\n\tscanf(\"%d%lld\",&n,&m);m%=(MOD-1);init_fac(n);\n\tfor(int i=0;i<=n;i++) scanf(\"%d\",&f[i]);\n\tvector<int> A(n+1),B(n+1);\n\tfor(int i=0;i<=n;i++) A[i]=ifac[i],B[n-i]=1ll*fac[i]*f[i]%MOD;\n\tvector<int> C=conv(A,B);\n\tfor(int i=0;i<=n;i++){\n\t\tg[i]=1ll*ifac[i]*C[n-i]%MOD;\n\t\tg[i]=1ll*g[i]*qpow(qpow(i+1,MOD-2),m)%MOD;\n\t} iota(A.begin(),A.end(),0);iota(B.begin(),B.end(),0);\n\tfor(int i=0;i<=n;i++){\n\t\tif(~i&1) A[i]=ifac[i];else A[i]=MOD-ifac[i];\n\t\tB[n-i]=1ll*fac[i]*g[i]%MOD;\n\t} C=conv(A,B);\n\tfor(int i=0;i<=n;i++) printf(\"%d \",1ll*C[n-i]*ifac[i]%MOD);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1620457432,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF923E Perpetual Subtraction"
    },
    {
        "content": "\u751f\u6210\u51fd\u6570\u597d\u9898\uff0c\u5199\u4e2a\u9898\u89e3\u52a0\u6df1\u7406\u89e3\u3002\n\n\u9996\u5148\u771f\u8bda\u819c\u62dc [_rqy](https://rqy.moe/Solutions/cf947E/) \u7684\u795e\u4ed9\u505a\u6cd5\u3002\n\n\u5148\u4ece\u57fa\u7840\u8bb2\u8d77\u3002\n\n**\u4ec0\u4e48\u662f\u79ef\u5206**\n\n\u5bf9\u4e8e\u51fd\u6570 $f(x)$\uff0c\u5b83\u7684\u4e0d\u5b9a\u79ef\u5206 $\\int f(x)\\,\\text dx$ \u5b9a\u4e49\u4e3a\u4e00\u4e2a\u51fd\u6570 $g(x)$\uff0c\u6ee1\u8db3 $g'(x)=f(x)$\uff0c\u5373\u662f $f(x)$ \u7684\u53cd\u5bfc\u6570\uff0c\u5176\u4e2d $\\text dx$ \u4ee3\u8868\u7740\u5bf9 $x$ \u6c42\u79ef\u3002\n\n\u5bf9\u4e8e\u51fd\u6570 $f(x)$\uff0c\u5b83\u7684\u5b9a\u79ef\u5206 $\\int_a^b f(x)\\,\\text dx$ \u5b9a\u4e49\u4e3a\u51fd\u6570 $f(x)$ \u4e0e $x$ \u5750\u6807\u8f74\u56f4\u6210\u7684\u6709\u7b26\u53f7\u9762\u79ef\uff0c\u5176\u4e2d $\\text dx$ \u4ee3\u8868\u7740\u5bf9 $x$ \u6c42\u79ef\u3002\u8fd9\u91cc\u7684\u6709\u7b26\u53f7\u6307\u7684\u662f\u66f2\u7ebf\u5728\u6a2a\u8f74\u4e4b\u4e0a\uff0c$a<b$ \u65f6\u4e3a\u6b63\uff0c$a>b$ \u65f6\u4e3a\u8d1f\uff1b\u5728\u6a2a\u8f74\u4e4b\u4e0b\uff0c$a<b$ \u65f6\u4e3a\u8d1f\uff0c$a>b$ \u65f6\u4e3a\u6b63\u3002\n\n\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4ee5\u4e0a\u4e24\u8005\u90fd\u4e0d\u662f\u4e25\u8c28\u7684\u5b9a\u4e49\uff0c\u5b83\u4eec\u90fd\u6ca1\u6709\u8003\u8651\u5b9a\u4e49\u5b58\u5728\u7684\u524d\u63d0\uff0c\u53ea\u662f\u6613\u4e8e\u7406\u89e3\u7684\u7b80\u5316\u5f62\u5f0f\u3002\n\n\u725b\u987f-\u83b1\u5e03\u5c3c\u8328\u516c\u5f0f\u6307\u51fa\uff0c\u4e0d\u5b9a\u79ef\u5206\u4e0e\u5b9a\u79ef\u5206\u662f\u76f8\u4e92\u8054\u7cfb\u7684\u3002\u5373\u5bf9\u4e8e\u5728 $[a,b]$ \u4e0a\u8fde\u7eed\u53ef\u79ef\u7684\u51fd\u6570 $f(x)$\uff0c\u82e5\u5176\u4e0d\u5b9a\u79ef\u5206\uff08\u53cd\u5bfc\u6570\uff09$g(x)=\\int f(x)\\,\\text dx$ \u5b58\u5728\uff0c\u90a3\u4e48\u5c31\u6709\uff1a\n\n$$ \\int_a^b f(x)\\,\\text dx=g(b)-g(a)=g(x)|_a^b $$\n\n**\u5f62\u5f0f\u5e42\u7ea7\u6570\u7684\u6c42\u5bfc\u548c\u79ef\u5206**\n\n\u57fa\u672c\u6c42\u5bfc\u6cd5\u5219\u5bf9\u4e8e\u5f62\u5f0f\u5e42\u7ea7\u6570\u4f9d\u7136\u9002\u7528\uff0c\u6839\u636e $(x^n)'=nx^{n-1},u'\u00b1v'=[u\u00b1v]'$\uff0c\u53ef\u4ee5\u63a8\u5f97\uff1a\n$$ \\dfrac{\\text d}{\\text dx} \\left( \\sum\\limits_{i\\ge 0} a_ix^i \\right)= \\sum\\limits_{i\\ge 0}a_{i+1}(i+1)x^i$$\n\n\u6839\u636e $\\int x^n\\,\\text dx=\\frac{x^{n+1}}{n+1}$\uff0c\u53ef\u4ee5\u63a8\u5f97\uff1a\n$$ \\int \\left( \\sum\\limits_{i\\ge 0} a_ix^i \\right)\\,\\text dx= \\sum\\limits_{i> 0} \\dfrac{a_{i-1}}{i}x^i$$\n\n\u4ee5\u4e0a\u4e24\u5f0f\u53ef\u4f5c\u4e3a\u5f62\u5f0f\u5e42\u7ea7\u6570\u6c42\u5bfc/\u79ef\u5206\u7684\u5b9a\u4e49\u3002\n\n**\u672c\u9898\u7684\u63a8\u5bfc**\n\n\u8bbe $f[k,i]$ \u8868\u793a\u7ecf\u8fc7 $k$ \u8f6e\uff0c\u5f97\u5230 $i$ \u7684\u6982\u7387\uff0c\u6709\u9012\u63a8\u5173\u7cfb $f[k,i]=\\sum\\limits_{j\\ge i}^n f[k-1,j]/j+1$\u3002\n\n\u8bbe $F(k,z)=\\sum\\limits_{i=0}^n f[k,i]z^i$ \u662f $f$ \u7684 OGF\uff0c\u5176\u4e2d $z$ \u662f\u5f62\u5f0f\u53d8\u91cf\u3002\n\n\u6839\u636e\u4e0a\u9762\u7684\u9012\u63a8\u5173\u7cfb\uff0c\u6709\uff1a\n\n$$\\begin{aligned} F(k,z)&=\\sum\\limits_{i=0}^n z^i\\sum\\limits_{j=i}^n \\dfrac{f[k-1,j]}{j+1}\\\\ &=\\sum\\limits_{j=0}^n \\dfrac{f[k-1,j]}{j+1}\\sum\\limits_{i=0}^j z^i \\\\&=\\dfrac{1}{z-1} \\sum\\limits_{i=0}^n f[k-1,i]\\dfrac{z^{i+1}-1}{i+1} \\end{aligned}$$\n\n\u8003\u8651 $f[k-1,i]$ \u8f6c\u79fb\u5230\u4e86\u54ea\u91cc\uff0c\u5bb9\u6613\u53d1\u73b0\u5b83\u5728 $F(k,\u00b7)$ \u4e2d\u662f $i+1$ \u9879\u7cfb\u6570\uff0c\u8fd9\u4e2a\u53d8\u6362\u4e0d\u5bb9\u6613\u5feb\u901f\u5b9e\u73b0\uff0c\u90a3\u4e48\u7ee7\u7eed\u63a8\u5bfc\u3002\n\n\u6839\u636e\u725b\u987f-\u83b1\u5e03\u5c3c\u8328\u516c\u5f0f\uff0c\u53ef\u4ee5\u63a8\u5f97\uff1a\n$\\int_1^z t^i\\,\\text dt=\\dfrac{z^{i+1}}{z-1}-\\dfrac{1}{z-1}$\uff0c\u90a3\u4e48\u539f\u5f0f\u5316\u4e3a\uff1a\n\n$$\\begin{aligned} F(k,z)&=\\dfrac{1}{z-1}\\sum\\limits_{i=0}^n f[k-1,i]\\int_1^z t^i\\,\\text dt\\\\ &=\\dfrac{1}{z-1}\\int_1^z\\left( \\sum\\limits_{i=0}^nf[k-1,i]t^i\\right)\\,\\text dt\\\\ &= \\dfrac{1}{z-1}\\int_1^z F(k-1,t)\\,\\text dt  \\end{aligned}$$\n\n\u8003\u8651\u539f\u5f0f\u4e2d $z^{i+1}-1$ \u5f88\u662f\u9b3c\u755c\uff0c\u8003\u8651\u628a\u5b9a\u79ef\u5206\u7684\u4e0b\u6307\u6807\u6539\u4e3a\u4ece 0 \u5f00\u59cb\uff0c\u90a3\u4e48\u8bbe $G(k,z)=F(k,z+1)$\uff0c\u6709\uff1a\n\n$$\\begin{aligned} G(k,z)&=\\dfrac{1}{z}\\int_1^{z+1} F(k-1,t)\\,\\text dt \\\\ &=\\dfrac{1}{z}\\int_0^z F(k-1,t+1)\\,\\text d(t+1)\\\\ &=\\dfrac{1}{z}\\int_0^z G(k-1,t)\\,\\text dt \\\\ &= \\dfrac{1}{z}\\sum\\limits_{i=0}^n \\dfrac{g[k-1,i]}{i+1}z^{i+1}\\\\ &=\\sum\\limits_{i=0}^n \\dfrac{g[k-1,i]}{i+1}z^i \\end{aligned}$$\n\n\u5176\u4e2d $g[k,i]$ \u6ee1\u8db3 $G(k,z)=\\sum\\limits_{i=0}^n g[k,i]z^i$\uff0c\u5373\u662f\u5bf9\u5e94\u7684\u5e8f\u5217\u3002\n\u8003\u8651\u7cfb\u6570\u7684\u53d8\u5316\uff1a$k\\to k+1:g[k,i]\\to g[k+1,i]/(i+1)$\uff0c\u90a3\u4e48 $m$ \u6b21\u53d8\u5316\u4e4b\u540e\u5c31\u662f $g[m,i]=\\dfrac{g[0,i]}{(i+1)^m}$ \u8fd9\u4e2a\u5c31\u53ef\u4ee5\u8fd1\u4f3c\u7ebf\u6027\u76f4\u63a5\u6c42\u51fa\u6765\u3002\n\n\u90a3\u4e48\u53ea\u9700\u8981\u7c7b\u4f3c\u4e8e DFT \u548c IDFT \u90a3\u6837\u5b50\uff0c\u628a $F$ \u53d8\u6210 $G$\uff0c\u7cfb\u6570\u4fee\u6539\u5b8c\u4e4b\u540e\u518d\u53d8\u56de\u6765\u5373\u53ef\u3002\n\n\u8003\u8651\u600e\u4e48\u53d8\uff0c\u6839\u636e\u5b9a\u4e49\uff0c\u5f97\u5230\uff1a\n\n$$\\begin{aligned} G(k,z)&=F(k,z+1)\\\\ \\Leftrightarrow \\sum\\limits_{i=0}^n g[k,i]z^i&=\\sum\\limits_{i=0}^n f[k,i](z+1)^i\\\\ &=\\sum\\limits_{i=0}^n\\sum\\limits_{j=0}^i\\dbinom{i}{j}z^jf[k,i] \\\\ &= \\sum\\limits_{i=0}^n z^i \\sum\\limits_{j=i}^n \\dbinom{j}{i}f[k,j]\\end{aligned}$$\n\n\u8003\u8651 $k=0$\uff0c\u5f97\uff1a\n\n$$\\begin{aligned} g[0,i]&=\\sum\\limits_{j=i}^n \\dbinom{j}{i}p_j\\\\ &= \\dfrac{1}{i!}\\sum\\limits_{t=0}^{n-i} \\dfrac{(i+t)!p_{i+t}}{t!}\\end{aligned}$$\n\n\u8fd9\u91cc\u662f\u5dee\u4e3a\u5b9a\u503c\u7684\u5377\u79ef\uff0c\u4f9d\u7136\u53ef\u4ee5\u5316\u6210\u5e8f\u5217\u5377\u79ef\uff0c\u90a3\u4e48\u6784\u9020 $A(x)=\\sum\\limits_{i=0}^n \\dfrac{1}{i!},B(x)=\\sum\\limits_{i=0}^n b_ix^i$\uff0c\u5176\u4e2d\u6709 $p_ii!=b_{n-i}$\uff0c\u5373\u4eba\u4e3a\u4ee4\u4e0b\u6807\u7684\u548c\u4e3a\u5b9a\u503c\uff0c\u90a3\u4e48\u5bb9\u6613\u53d1\u73b0 $g[0,i]=\\dfrac{1}{i!}[z^{n-i}]A(x)B(x)$\u3002NTT \u5373\u53ef\uff0c\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n\u5bf9\u4e8e $g\\to f$ \u7684\u8f6c\u5316\uff0c\u6839\u636e\u4e8c\u9879\u5f0f\u53cd\u6f14\uff0c\u6709\uff1a\n\n$$\\begin{aligned} g[k,i]&=\\sum\\limits_{j=i}^n\\dbinom{j}{i}f[k,j] \\\\ \\Leftrightarrow f[k,i]&=\\sum\\limits_{j=i}^n (-1)^{j-i}\\dbinom{j}{i}g[k,j] \\end{aligned}$$\n\n\u4f9d\u7136\u662f\u5dee\u4e3a\u5b9a\u503c\u7684\u5377\u79ef\uff0c\u540c\u7406\u53ef\u4eff\u7167\u4e0a\u9762\u6c42\u51fa\u3002\n\n\u7136\u540e\u5c31\u53ef\u89e3\u4e86\uff0c\u603b\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\u601d\u8def\u7684\u5999\u5904\u5728\u4e8e\u901a\u8fc7\u4ee3\u6570\u63a8\u5bfc\u6765\u627e\u5230\u4e00\u4e2a\u6613\u4e8e\u5904\u7406\u7684\u7ebf\u6027\u53d8\u6362\u5f62\u5f0f\uff0c\u7136\u540e\u628a\u95ee\u9898\u53d8\u6210\u4e86\u4f7f\u7528\u591a\u9879\u5f0f\u7b97\u6cd5\u6613\u4e8e\u89e3\u51b3\u7684\u5e8f\u5217\u53d8\u6362\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define LL long long\nconst int P = 998244353;\nconst int CN = 1e5 + 10;\nLL read(){\n    LL s = 0, ne = 1; char c = getchar();\n    for(;c < '0' || c > '9';c = getchar()) if(c == '-') ne = -1;\n    for(;c >= '0' && c <= '9';c = getchar()) s = (s << 1) + (s << 3) + c - '0';\n    return s * ne;\n}\nint add(int x, int y) {return x + y >= P ? x + y - P : x + y;}\nint qp(int a, int b){\n    int r = 1;\n    while(b){\n        if(b & 1) r = 1ll * r * a % P;\n        a = 1ll * a * a % P, b >>= 1;\n    }\n    return r;\n}\nint inv(int x) {return qp(x, P - 2);}\nint rev[CN << 2];\nvoid cg(int t[], int n){\n    for(int i = 0; i < n; i++) rev[i] = (rev[i >> 1] >> 1) + (i & 1) * (n >> 1);\n    for(int i = 0; i < n; i++) if(i < rev[i]) swap(t[i], t[rev[i]]);\n}\nvoid ntt(int t[], int n, int tp){\n    cg(t, n);\n    for(int w = 2; w <= n; w <<= 1){\n        int l = w >> 1, gn = qp(tp ? 3 : inv(3), (P - 1) / w);\n        for(int i = 0; i < n; i += w){\n            int g = 1;\n            for(int j = i; j < i + l; j++){\n                int u = t[j], v = 1ll * g * t[j + l] % P;\n                t[j] = add(u, v), t[j + l] = add(u, P - v), g = 1ll * g * gn % P;\n            }\n        }\n    }\n    if(!tp){\n        int in = inv(n);\n        for(int i = 0; i < n; i++) t[i] = 1ll * t[i] * in % P;\n    }\n}\nvoid conv(int A[], int B[], int n){ // A = A * B\n    int N = 1; while(N < (n << 1)) N <<= 1;\n    ntt(A, N, 1), ntt(B, N, 1);\n    for(int i = 0; i < N; i++) A[i] = 1ll * A[i] * B[i] % P;\n    ntt(A, N, 0);\n    for(int i = n; i < N; i++) A[i] = B[i] = 0;\n}\nint A[CN << 2], B[CN << 2];\nint n, m, p[CN], fac[CN], ifac[CN], g[CN];\nint main()\n{\n    freopen(\"_in.in\", \"r\", stdin);\n    n = read() + 1, m = read() % (P - 1);\n    fac[0] = 1; for(int i = 1; i < n; i++) fac[i] = 1ll * fac[i - 1] * i % P;\n    ifac[n - 1] = inv(fac[n - 1]); for(int i = n - 2; i + 1; i--) ifac[i] = 1ll * ifac[i + 1] * (i + 1) % P;\n    for(int i = 0; i < n; i++) p[i] = read();\n    for(int i = 0; i < n; i++) A[n - i - 1] = 1ll * fac[i] * p[i] % P;\n    for(int i = 0; i < n; i++) B[i] = ifac[i];\n    conv(A, B, n); \n    for(int i = 0; i < n; i++) g[i] = 1ll * ifac[i] * A[n - i - 1] % P;\n    for(int i = 0; i < n; i++) g[i] = 1ll * g[i] * inv(qp(i + 1, m)) % P;\n    for(int i = 0; i < n; i++) A[n - i - 1] = 1ll * fac[i] * g[i] % P;\n    for(int i = 0; i < n; i++) B[i] = i & 1 ? P - ifac[i] : ifac[i];\n    conv(A, B, n);\n    for(int i = 0; i < n; i++) printf(\"%d \", int(1ll * ifac[i] * A[n - i - 1] % P)); puts(\"\");\n    return 0;\n}\n```",
        "postTime": 1607952864,
        "uid": 70177,
        "name": "big_news",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF923E \u3010Perpetual Subtraction\u3011"
    },
    {
        "content": "\u4e4b\u524d\u5b66\u5230\u5bf9\u89d2\u5316\u7684\u65f6\u5019\u5c31\u5728\u60f3\u80fd\u4e0d\u80fd\u51fa\u6210 OI \u9898\uff0c\u7ed3\u679c\u4eca\u5929\u5c31\u9047\u5230\u4e86\uff08\n\n\u9996\u5148\u5217\u51fa\u6734\u7d20\u7684 dp \u7684\u5f0f\u5b50\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u7ecf\u5178\u7684\u77e9\u9635\u4e58\u6cd5\u7684\u5f62\u5f0f\n\n\u7b54\u6848\u5c31\u662f $[p^TA^m]_i$\n\n\u5176\u4e2d $a_{i,j}=[i\\geq j]\\dfrac{1}{i+1}$\n\n\u53d1\u73b0 $n=10^5$\uff0c\u77e9\u9635\u4e58\u6cd5\u663e\u7136\u65e0\u6cd5\u901a\u8fc7\n\n****\n\n\u8fd9\u4e2a\u65f6\u5019\u53ef\u4ee5\u8003\u8651\u5bf9\u89d2\u5316\uff1a\n\n\u5bf9\u4e8e\u65b9\u9635 $A$ \u548c\u590d\u6570 $\\lambda$\uff0c\u82e5 $\\exists \\vec x\\neq \\vec 0$\uff0c\u6ee1\u8db3 $Ax=\\lambda x$\uff0c\u5219\u79f0 $\\lambda$ \u4e3a $A$ \u7684\u4e00\u4e2a\u7279\u5f81\u503c\uff0c $\\vec x$ \u4e3a $A$ \u7684\u4e00\u4e2a\u5173\u4e8e $\\lambda$ \u7684\u7279\u5f81\u5411\u91cf\uff0c\u4e00\u4e2a $n\\times n$ \u7684\u77e9\u9635\u6709 $n$ \u4e2a\u7279\u5f81\u503c\uff0c\u4ed6\u4eec\u662f\u7279\u5f81\u591a\u9879\u5f0f\n\n$$p(\\lambda)=\\det(A-\\lambda I)$$\n\n\u7684 $n$ \u4e2a\u6839\uff0c\u5219\u6709\n\n$$A=XDX^{-1}$$\n\n\u5176\u4e2d $D$ \u4e3a\u4e00\u5bf9\u89d2\u77e9\u9635\uff0c$d_{i,i}=\\lambda_i$\uff0c$X$ \u7684\u5217\u5411\u91cf $x_i$ \u4e3a\u4e00\u5173\u4e8e $\\lambda_i$ \u7684\u7279\u5f81\u5411\u91cf\uff0c\u8981\u6c42 $\\operatorname{rank} X=n$\uff0c\u5373\u6bcf\u4e2a\u5217\u5411\u91cf\u7ebf\u6027\u65e0\u5173\n\n**\u8bc1\u660e\uff1a**\n\n\u56e0\u4e3a $\\operatorname{rank}X=n$\uff0c\u6240\u4ee5 $X$ \u663e\u7136\u53ef\u9006\uff0c\u5373\u8bc1\n\n$$\n\\begin{aligned}\nD&=X^{-1}AX\\\\\n&=X^{-1}(\\lambda_1x_1,\\lambda_2x_2,\\cdots,\\lambda_nx_n) \\\\\n&=D\n\\end{aligned}\n$$\n\n\u8bc1\u6bd5\n\n\u5bf9\u89d2\u5316\u7684\u4e00\u4e2a\u6027\u8d28\u5c31\u662f\u53ef\u4ee5\u5f88\u597d\u7684\u8ba1\u7b97\u4e00\u4e2a\u77e9\u9635\u7684 $m$ \u6b21\u5e42\n\n\u5373 $A^m=(XDX^{-1})^m=XD^mX^{-1}$\uff0c\u800c\u4e00\u4e2a\u5bf9\u89d2\u77e9\u9635\u7684 $m$ \u6b21\u5e42\u662f\u975e\u5e38\u597d\u8ba1\u7b97\u7684\n\n****\n\n\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u56e0\u4e3a $A$ \u662f\u4e00\u4e2a\u4e0b\u4e09\u89d2\u77e9\u9635\uff0c\u6240\u4ee5\u4ed6\u7684\u7279\u5f81\u503c\u5c31\u662f\u6240\u6709\u7684\u5bf9\u89d2\u5143\u7d20 $\\dfrac{1}{i+1}$\n\n\u63a5\u4e0b\u6765\u6c42 $X$\uff0c\u624b\u73a9\u5c0f\u6570\u636e\u4e0d\u96be\u53d1\u73b0\u6709 $x_{i,j}=\\binom{i}{j}$\n\n**\u8bc1\u660e\uff1a**\n\n$$\n\\begin{aligned}\n[Ax_j]_i&=\\sum_{j\\leq k \\leq i}a_{i,k}x_{k,j} \\\\\n&=\\frac{1}{i+1}\\sum_{j\\leq k\\leq i}\\binom{k}{j} \\\\\n&=\\frac{1}{i+1}\\binom{i+1}{j+1} \\\\\n&=\\frac{1}{j+1}\\binom{i}{j} \\\\\n&=\\lambda_j x_{i,j}\n\\end{aligned}\n$$\n\n\u63a5\u4e0b\u6765\u6c42 $X^{-1}$\uff0c\u624b\u73a9\u5c0f\u6570\u636e\u4e0d\u96be\u53d1\u73b0\u6709 $x^{-1}_{i,j}=(-1)^{i+j}\\binom{i}{j}$\n\n**\u8bc1\u660e\uff1a**\n\n\u8bbe $X^{-1}X=Y$\n\n$$\n\\begin{aligned}\ny_{i,j}&=\\sum_{k=0}^n(-1)^{i+k}\\binom{i}{k}\\binom{k}{j} \\\\\n&=\\sum_{k=0}^n(-1)^{i+k}\\binom{i}{j}\\binom{i-j}{i-k} \\\\\n&=\\binom{i}{j}\\Bigg(\\sum_{k\\in even}\\binom{i-j}{k}-\\sum_{k\\in odd}\\binom{i-j}{k}\\Bigg) \\\\\n&=\\delta_{i,j}=[i=j]\n\\end{aligned}\n$$\n\n\u4f46\u662f\u6211\u4eec\u5411\u91cf\u4e58\u77e9\u9635\u7684\u590d\u6742\u5ea6\u8fd8\u662f $O(n^2)$ \u7684\uff0c\u4f46\u662f\u6211\u4eec\u7684 $X$ \u7684\u6027\u8d28\u662f\u975e\u5e38\u597d\u7684\uff0c\u6bcf\u4e00\u4e2a\u5143\u7d20\u90fd\u662f\u7ec4\u5408\u6570\uff0c\u6211\u4eec\u628a\u4ed6\u5199\u6210\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u53d1\u73b0\u662f\u4e00\u4e2a\u5dee\u5377\u79ef\uff0c\u4e8e\u662f\u53ef\u4ee5\u76f4\u63a5\u4e0a NTT \u89e3\u51b3\n\n\u590d\u6742\u5ea6 $O(n\\log n)$\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n# define Rep(i,a,b) for(int i=a;i<=b;i++)\n# define _Rep(i,a,b) for(int i=a;i>=b;i--)\n# define RepG(i,u) for(int i=head[u];~i;i=e[i].next)\n\nconst int N=1<<18;\nconst int mod=998244353;\n\ntypedef long long ll;\ntypedef double db;\n\n# define chkmax(a,b) a=max(a,b)\n# define chkmin(a,b) a=min(a,b)\n# define PII pair<int,int>\n# define mkp make_pair\n\ntemplate<typename T> void read(T &x){\n    x=0;int f=1;\n    char c=getchar();\n    for(;!isdigit(c);c=getchar())if(c=='-')f=-1;\n    for(;isdigit(c);c=getchar())x=(x<<1)+(x<<3)+c-'0';\n    x*=f;\n}\n\nint n;ll m;\nint A[N],B[N];\nint pos[N],tmp[N];\nint fac[N],inv[N];\n\nint inc(int x,int y){\n    return x+y>=mod?x+y-mod:x+y;\n}\n\nint dec(int x,int y){\n    return x<y?x-y+mod:x-y;\n}\n\nint Qpow(int base,int ind){\n    int res=1;\n    while(ind){\n        if(ind&1)res=1ll*res*base%mod;\n        base=1ll*base*base%mod;\n        ind>>=1;\n    }\n    return res;\n}\n\nvoid init(int limit){\n    for(int i=1;i<limit;i<<=1)for(int j=0;j<i;j++)pos[i+j]=pos[j]+limit/i/2;\n}\n\nvoid NTT(int *A,int limit,int opt){\n    for(int i=0;i<limit;i++)tmp[pos[i]]=A[i];\n    for(int i=0;i<limit;i++)A[i]=tmp[i];\n    for(int i=1;i<limit;i<<=1){\n        int len=i<<1;\n        int g0=Qpow(opt==1?3:332748118,(mod-1)/len);\n        for(int j=0;j<limit;j+=len)\n            for(int k=0,g=1;k<i;k++,g=1ll*g*g0%mod){\n                int x=A[j+k],y=1ll*A[j+k+i]*g%mod;\n                A[j+k]=inc(x,y);\n                A[j+k+i]=dec(x,y);\n            }\n    }\n    if(opt==-1){\n        int inv=Qpow(limit,mod-2);\n        for(int i=0;i<limit;i++)A[i]=1ll*A[i]*inv%mod;\n    }\n}\n\nint main()\n{\n    # ifndef ONLINE_JUDGE\n    freopen(\"testdata.in\",\"r\",stdin);\n    //freopen(\"test1.out\",\"w\",stdout);\n    # endif\n    read(n),read(m);m%=mod-1;\n    n++;\n    for(int i=0;i<n;i++)read(A[i]);\n    fac[0]=1;\n    Rep(i,1,n)fac[i]=1ll*fac[i-1]*i%mod;\n    inv[n]=Qpow(fac[n],mod-2);\n    _Rep(i,n-1,0)inv[i]=1ll*inv[i+1]*(i+1)%mod;\n    int limit=1;\n    while(limit<2*n)limit<<=1;\n    init(limit);\n    for(int i=0;i<n;i++)A[i]=1ll*A[i]*fac[i]%mod;\n    for(int i=0;i<n;i++)B[i]=inv[i];\n    reverse(B,B+n);\n    NTT(A,limit,1),NTT(B,limit,1);\n    for(int i=0;i<limit;i++)A[i]=1ll*A[i]*B[i]%mod;\n    NTT(A,limit,-1);\n    for(int i=0;i<n;i++)A[i]=A[i+n-1];\n    for(int i=n;i<limit;i++)A[i]=0;\n    for(int i=0;i<n;i++)A[i]=1ll*A[i]*Qpow(Qpow(i+1,m),mod-2)%mod;\n    for(int i=0;i<n;i++)B[i]=inv[i];\n    for(int i=0;i<n;i++)if(i&1)B[i]=mod-B[i];\n    for(int i=n;i<limit;i++)B[i]=0;\n    reverse(B,B+n); \n    NTT(A,limit,1),NTT(B,limit,1);\n    for(int i=0;i<limit;i++)A[i]=1ll*A[i]*B[i]%mod;\n    NTT(A,limit,-1);\n    for(int i=0;i<n;i++)A[i]=A[i+n-1];\n    for(int i=0;i<n;i++)A[i]=1ll*A[i]*inv[i]%mod;\n    for(int i=0;i<n;i++)printf(\"%d \",A[i]);\n    puts(\"\");\n    return 0;\n}\n```",
        "postTime": 1654250476,
        "uid": 97344,
        "name": "devout",
        "ccfLevel": 9,
        "title": "CF923E Perpetual Subtraction"
    }
]
[
    {
        "content": "DP \u597d\u9898\u3002\n\n\u5148\u8f6c\u6210\u6700\u5927\u5316 $a_i$ \u548c $b_{p_i}$ \u7684\u4ea4\u96c6\u7684\u548c\u3002\n\n\u8003\u8651\u6bcf\u4e2a\u7ed9\u5b9a\u533a\u95f4 $a_i$ \u4f1a\u5339\u914d\u5230\u54ea\u4e2a\u6211\u4eec\u6784\u9020\u7684\u533a\u95f4 $b_{p_i}$\uff0c\u663e\u7136\u5c06 $a,b$ \u6309\u7167\u4e2d\u70b9 sort \u4e4b\u540e\u53ef\u4ee5\u53d1\u73b0 $p_i\\leq p_{i+1}$\uff0c\u56e0\u6b64\u76f4\u63a5\u8bbe $f_{x,y}$ \u4e3a\u524d $x$ \u4e2a $a_i$ \u7528\u6389 $y$ \u6bb5 $b_i$ \u7684\u7b54\u6848\u3002\n\n\u7528\u811a\u60f3\u90fd\u77e5\u9053\u8fd9\u73a9\u610f\u6ee1\u8db3\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\u7136\u540e\u53ef\u4ee5\u51b3\u7b56\u5355\u8c03\u6027\u4f18\u5316\uff0c\u4e8e\u662f\u53ea\u9700\u8981\u5feb\u901f\u6c42\u4e00\u4e2a\u533a\u95f4\u7684\u7b54\u6848 $g_{l,r}$ \u5373\u53ef\uff0c\u8003\u8651\u672c\u8d28\u4e0d\u540c\u7684\u533a\u95f4\u5de6\u7aef\u70b9\u53ea\u6709 $2n$ \u4e2a\uff08\u5982\u679c\u533a\u95f4\u5de6\u53f3\u7aef\u70b9\u90fd\u4e0d\u5728 $a_i$ \u7684\u7aef\u70b9\u4e0a\uff0c\u90a3\u4e48\u79fb\u8fc7\u53bb\u7b54\u6848\u4e0d\u53d8\uff09\uff0c\u518d\u7528\u4e00\u6b21\u51b3\u7b56\u5355\u8c03\u6027\u4f18\u5316\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u6c42\u533a\u95f4\u7b54\u6848 $g_{l,r}$ \u7684\u53ea\u9700\u8981\u679a\u4e3e\u6240\u6709\u51b3\u7b56\u70b9\uff0c\u662f $O(n^2)$ \u7684\uff0c\u4f46\u662f\u540e\u9762\u8fd9\u4e2a\u6c42\u5168\u5c40\u7b54\u6848 $f_{x,y}$ \u7684\u7684\u9700\u8981\u5206\u6cbb\u6c42\u540c\u4e00\u884c\u6bcf\u4e00\u5217\u7684\u51b3\u7b56\u70b9\uff0c\u4f1a\u591a\u4e00\u4e2a $\\log n$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2\\log n)$\u3002",
        "postTime": 1684200826,
        "uid": 111055,
        "name": "dead_X",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1832F"
    },
    {
        "content": "### [CF1832F Zombies](https://www.luogu.com.cn/problem/CF1832F)\n\n\u4e0d\u59a8\u8ba4\u4e3a\u4e00\u4e2a\u5165\u53e3\u7684\u4ee3\u4ef7\u4e3a $x - m - (r_i - l_i)$ \u52a0\u4e0a $[l_i, r_i)$ \u548c\u4e0e\u4e4b\u5339\u914d\u7684\u6b66\u5668\u7684\u65f6\u523b\u533a\u95f4\u7684\u4ea4\u96c6\u5927\u5c0f\uff0c\u73b0\u5728\u6211\u4eec\u7684\u76ee\u6807\u53d8\u6210\u6700\u5927\u5316\u4ea4\u96c6\u5927\u5c0f\u4e4b\u548c\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u5165\u53e3\uff0c\u4e3a\u4e86\u6700\u5927\u5316\u4ea4\u96c6\uff0c\u53c8\u56e0\u4e3a\u6b66\u5668\u7684\u65f6\u523b\u533a\u95f4\u957f\u5ea6\u56fa\u5b9a\u4e3a $m$\uff0c\u6240\u4ee5\u4e00\u5b9a\u4f1a\u9009\u62e9\u65f6\u523b\u533a\u95f4\u7684\u4e2d\u70b9\u76f8\u8ddd\u6700\u8fd1\u7684\u6b66\u5668\u3002\u5c06\u5165\u53e3\u6309\u7167\u4e2d\u70b9\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u6bcf\u628a\u6b66\u5668\u4f1a\u5206\u914d\u5230\u4e00\u6bb5\u533a\u95f4\uff0c\u4e14\u5206\u914d\u5728\u524d\u9762\u7684\u6b66\u5668\u6bd4\u5206\u914d\u5728\u540e\u9762\u7684\u6b66\u5668\u7684\u6fc0\u6d3b\u65f6\u95f4\u65e9\u3002\n\n\u5bf9\u4e8e\u4e00\u628a\u6b66\u5668\uff0c\u5982\u679c\u5b83\u7684\u6fc0\u6d3b\u65f6\u95f4\u4e0d\u7b49\u4e8e\u4efb\u4f55\u5165\u53e3\u7684\u5de6\u7aef\u70b9\uff0c\u4e14\u7ed3\u675f\u65f6\u95f4\u4e0d\u7b49\u4e8e\u4efb\u4f55\u5165\u53e3\u7684\u53f3\u7aef\u70b9\uff0c\u90a3\u4e48\u5c06\u6b66\u5668\u7684\u65f6\u523b\u533a\u95f4\u5411\u5de6\u6216\u5411\u53f3\u79fb\u52a8\u4e00\u5b9a\u4e0d\u52a3\u3002\u56e0\u4e3a\u5728\u6ee1\u8db3\u4e0a\u8ff0\u9650\u5236\u7684\u524d\u63d0\u4e0b\uff0c\u5bf9\u4e8e\u67d0\u4e2a\u5165\u53e3\uff0c\u5982\u679c\u6b66\u5668\u7684\u65f6\u523b\u533a\u95f4\u5411\u5de6\u79fb\u52a8 $1$ \u4f7f\u5f97\u4ea4\u96c6\u51cf\u5c0f $1$\uff0c\u90a3\u4e48\u5411\u53f3\u79fb\u52a8\u4e00\u5b9a\u4f7f\u5f97\u4ea4\u96c6\u589e\u52a0 $1$\u3002\u6240\u4ee5\u5411\u5de6\u79fb\u52a8\u548c\u5411\u53f3\u79fb\u52a8\u7684\u4ee3\u4ef7\u603b\u548c\u4e3a $0$\uff0c\u603b\u6709\u4e00\u4fa7\u4e0d\u52a3\u3002\n\n\u56e0\u6b64\uff0c\u53ef\u80fd\u7684\u6b66\u5668\u6fc0\u6d3b\u65f6\u95f4\u53ea\u6709 $\\mathcal{O}(n)$ \u79cd\uff1a$\\{l_i\\}\\cup \\{r_i - m\\}$\u3002\n\n\u7b54\u6848\u5173\u4e8e\u7269\u54c1\u4e2a\u6570\u7684\u51fd\u6570\u770b\u8d77\u6765\u5c31\u5f88\u51f8\uff0c\u8003\u8651 wqs \u4e8c\u5206\uff08\u8fd9\u4e2a\u5b98\u65b9\u9898\u89e3\u90fd\u4e0d\u4f1a\u8bc1\uff09\u3002\u8bbe $f_{i, j}$ \u8868\u793a\u7528\u524d $i$ \u4e2a\u6fc0\u6d3b\u65f6\u95f4\u7684\u6b66\u5668\u8986\u76d6\u4e86\u524d $j$ \u4e2a\u5165\u53e3\u7684\u6700\u5927\u8d21\u732e\uff0c\u6709\u8f6c\u79fb\u65b9\u7a0b\n$$\nf_{i, j} = \\max(f_{i, j - 1} + w(i, j), \\max_{p = 1} ^ {i - 1} f_{p, j - 1} + w(p, j) - \\mathrm{slope})\n$$\n\u5176\u4e2d $w(i, j)$ \u8868\u793a\u7b2c $i$ \u4e2a\u6fc0\u6d3b\u65f6\u95f4\u7684\u6b66\u5668\u548c\u7b2c $j$ \u4e2a\u5165\u53e3\u7684\u4ea4\u96c6\u3002\u5bf9\u4e8e\u540e\u534a\u90e8\u5206\uff0c\u76f8\u5f53\u4e8e\u65b0\u5f00\u4e00\u628a\u6b66\u5668\uff0c\u6240\u4ee5\u8d21\u732e\u8981\u51cf\u53bb\u659c\u7387\u3002\u524d\u7f00 $\\max$ \u4f18\u5316\u5373\u53ef\u505a\u5230 $\\mathcal{O}(n ^ 2 \\log V)$\u3002\n\n\u56de\u5f52\u6700\u81ea\u7136\u7684\u60f3\u6cd5\uff0c\u8bbe $f_{i, j}$ \u8868\u793a\u7528 $i$ \u628a\u6b66\u5668\u8986\u76d6\u524d $j$ \u4e2a\u5165\u53e3\u7684\u7b54\u6848\uff0c\u6709\u8f6c\u79fb\u65b9\u7a0b\n$$\nf_{i, j} = \\max_{k = 1} ^ {j} f_{i - 1, k - 1} + w(k, j)\n$$\n\u5176\u4e2d $w(i, j)$ \u8868\u793a\u7528\u4e00\u628a\u6b66\u5668\u8986\u76d6\u7b2c $i\\sim j$ \u4e2a\u5165\u53e3\u7684\u6700\u5927\u8d21\u732e\u3002\n\n\u56e0\u4e3a $w(i, j)$ \u770b\u8d77\u6765\u5c31\u5f88\u6ee1\u8db3\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\uff08\u8bc1\u660e\u7565\uff09\uff0c\u6240\u4ee5\u76f4\u63a5\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\u4f18\u5316\u5c31\u505a\u5230 $\\mathcal{O}(n ^ 2)$ \u4e86\uff1a\u8bbe $p_{i, j}$ \u8868\u793a $f_{i, j}$ \u7684\u51b3\u7b56\u70b9\uff0c\u90a3\u4e48 $p_{i - 1, j} \\leq p_{i, j} \\leq p_{i, j + 1}$\uff0c\u6309 $i$ \u5347\u5e8f $j$ \u964d\u5e8f\u8f6c\u79fb\uff0c\u8f6c\u79fb\u65f6\u5728 $p_{i - 1, j}\\sim p_{i, j + 1}$ \u4e4b\u95f4\u5bfb\u627e\u6700\u4f18\u51b3\u7b56\u70b9\u5373\u53ef\u3002\n\n\u95ee\u9898\u6765\u4e86\uff0c$w(i, j)$ \u600e\u4e48\u6c42\u3002\u4e00\u4e2a\u7b80\u5355\u7684\u60f3\u6cd5\u662f\u679a\u4e3e\u6bcf\u4e2a\u6fc0\u6d3b\u65f6\u95f4 $t_k$\uff0c\u7b97\u51fa $[t_k, t_k + m)$ \u548c $i\\sim j$ \u6bcf\u4e2a\u5165\u53e3\u7684\u4ea4\u96c6\u5927\u5c0f\u4e4b\u548c\uff0c\u53d6\u6700\u5927\u503c\u3002\u8fd9\u6837\u662f $\\mathcal{O}(n ^ 4)$ \u7684\u3002\u4f46\u662f $t_k$ \u548c $i\\sim j$ \u4e4b\u95f4\u7684\u8d21\u732e\u53ef\u4ee5\u901a\u8fc7\u5dee\u5206\u505a\u5230 $\\mathcal{O}(1)$\uff1a\u9884\u5904\u7406 $s_{k, j}$ \u8868\u793a $t_k$ \u548c $1\\sim j$ \u4e4b\u95f4\u7684\u8d21\u732e\u3002\u8fd9\u6837\u5c31\u662f $\\mathcal{O}(n ^ 3)$\u3002\u90a3\u8fdb\u4e00\u6b65\u5730\uff0c\u8bbe $q_{i, j}$ \u8868\u793a $w(i, j)$ \u7684\u6700\u4f18\u51b3\u7b56\u70b9\uff0c\u5373\u53d6\u5230\u6700\u5927\u503c\u7684 $k$\uff0c\u90a3\u4e48\u603b\u53ef\u4ee5\u4f7f\u5f97 $q_{i, j - 1} \\leq q_{i, j} \\leq q_{i + 1, j}$\uff08\u8bc1\u660e\u7565\uff09\u3002\u4f9d\u7136\u662f\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\uff0c\u4f18\u5316\u4e4b\u540e\u9884\u5904\u7406 $w$ \u7684\u590d\u6742\u5ea6\u5c31\u662f $\\mathcal{O}(n ^ 2)$ \u4e86\u3002\n\n\u6ce8\u610f\u4e00\u4e2a\u7ec6\u8282\uff1a\u5982\u679c\u521d\u59cb $q_{i, i}$ \u4ece\u6240\u6709\u6700\u4f18\u51b3\u7b56\u70b9\u4e2d\u4efb\u53d6\uff0c\u5219\u53ef\u80fd\u5bfc\u81f4 $q_{i, i} > q_{i + 1, i + 1}$\u3002\u6c42 $q_{i, i}$ \u65f6\u679a\u4e3e\u51b3\u7b56\u70b9\u7684\u5de6\u8fb9\u754c\u8bbe\u4e3a $q_{i - 1, i - 1}$ \u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n ^ 2)$\u3002\n\n\u7565\u53bb\u7684\u8bc1\u660e\u53ef\u4ee5\u5728 CF \u5b98\u65b9\u9898\u89e3\u4e2d\u627e\u5230\u3002\u8bc1\u8d77\u6765\u6bd4\u8f83\u5e73\u51e1\uff0c\u5404\u4f4d\u540c\u5b66\u53ef\u4ee5\u81ea\u884c\u601d\u8003\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing pii = pair<int, int>;\nusing pll = pair<ll, ll>;\nusing ull = unsigned long long;\n\nconstexpr int mod = 998244353;\nvoid addt(int &x, int y) {x += y, x >= mod && (x -= mod);}\nint add(int x, int y) {return x += y, x >= mod && (x -= mod), x;}\nint ksm(int a, int b) {\n  int s = 1;\n  while(b)    {\n    if(b & 1) s = 1ll * s * a % mod;\n    a = 1ll * a * a % mod, b >>= 1;\n  }\n  return s;\n}\n\nbool Mbe;\nconstexpr int N = 2e3 + 5;\n\nll ans;\nint n, k, x, m;\nstruct itv {\n  int l, r;\n  bool operator < (const itv &z) const {\n    return l + r < z.l + z.r;\n  }\n} c[N];\n\nint L, p[N][N], d[N << 1];\nll s[N << 1][N], w[N][N], f[N][N];\nint calc(int id, int x) {\n  int l = max(c[id].l, x), r = min(c[id].r, x + m);\n  return max(0, r - l);\n}\nvoid solve() {\n  cin >> n >> k >> x >> m;\n  for(int i = 1; i <= n; i++) {\n    cin >> c[i].l >> c[i].r;\n    ans += x - (c[i].r - c[i].l) - m;\n    d[++L] = c[i].l, d[++L] = c[i].r - m;\n  }\n  sort(d + 1, d + L + 1);\n  sort(c + 1, c + n + 1);\n  L = unique(d + 1, d + L + 1) - d - 1;\n  for(int i = 1; i <= L; i++)\n    for(int j = 1; j <= n; j++)\n      s[i][j] = s[i][j - 1] + calc(j, d[i]);\n  for(int len = 1; len <= n; len++) {\n    for(int i = 1, j = len; j <= n; i++, j++) {\n      int l = max(p[i - 1][j - 1], p[i][j - 1]), r = p[i + 1][j];\n      if(len == 1) r = L;\n      if(l == 0) l = 1;\n      w[i][j] = -1e18;\n      for(int k = l; k <= r; k++) {\n        ll val = s[k][j] - s[k][i - 1];\n        if(val > w[i][j]) w[i][j] = val, p[i][j] = k;\n      }\n    }\n  }\n  for(int i = 1; i <= k; i++) {\n    p[i][n + 1] = L;\n    for(int j = n; j; j--) {\n      int l = p[i - 1][j], r = p[i][j + 1];\n      if(i == 1) l = 1;\n      for(int z = l; z <= r; z++) {\n        if(z > j) break;\n        ll val = f[i - 1][z - 1] + w[z][j];\n        if(val > f[i][j]) f[i][j] = val, p[i][j] = z;\n      }\n    }\n  }\n  cout << ans + f[k][n] << \"\\n\";\n}\n\nbool Med;\nint main() {\n  fprintf(stderr, \"%.3lf MB\\n\", (&Mbe - &Med) / 1048576.0);\n  ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n  int T = 1;\n  while(T--) solve();\n  cerr << 1e3 * clock() / CLOCKS_PER_SEC << \" ms\\n\";\n  return 0;\n}\n```",
        "postTime": 1684207958,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "CF1832F Zombies"
    },
    {
        "content": "## \u7b80\u8981\u9898\u610f\n\n\u7ed9\u5b9a $n$ \u4e2a\u5de6\u95ed\u53f3\u5f00\u7684\u533a\u95f4 $A_i = [L_i, R_i)$\uff0c\u5176\u4e2d $0\\le L_i < R_i \\le x$\uff0c\u4f60\u53ef\u4ee5\u81ea\u7531\u9009\u62e9 $k$ \u4e2a\u957f\u5ea6\u4e3a $m$ \u5de6\u95ed\u53f3\u5f00\u7684\u533a\u95f4 $B_j = [l_j, r_j)$ \u4f7f\u5f97 $0\\le l_j<r_j\\le x$\u3002\u533a\u95f4\u957f\u5ea6\u5b9a\u4e49\u4e3a\u5185\u90e8\u6574\u70b9\u4e2a\u6570\u3002\u63a5\u4e0b\u6765\u7ed9\u6bcf\u4e2a $A$ \u4e2d\u7684\u533a\u95f4 $A_i$ \u5206\u914d\u552f\u4e00\u7684\u4e00\u4e2a $B$ \u4e2d\u7684\u533a\u95f4 $B_{p_i}$\uff08$B$ \u4e2d\u533a\u95f4\u53ef\u4ee5\u91cd\u590d\u4f7f\u7528\uff09\uff0c\u4f60\u9700\u8981\u6700\u5927\u5316 $\\sum_i \\operatorname{len}\\left([1, x)\\backslash(A_i\\cup B_{p_i})\\right)$\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\le k\\le n\\le 2000,1\\le m\\le x\\le 10^9$\u3002\n\n## \u9898\u89e3\n\n\u975e\u5e38\u597d\u9898\u3002\n\n\u9996\u5148\u8003\u8651\u5982\u679c\u5df2\u7ecf\u786e\u5b9a\u4e86 $B$\uff0c\u90a3\u4e48\u5982\u4f55\u786e\u5b9a $p_i$\uff0c\u4e5f\u5c31\u662f\u5982\u4f55\u7ed9 $A$ \u4e2d\u5143\u7d20\u5206\u914d $B$ \u4e2d\u533a\u95f4\u3002\u6ce8\u610f\u5230\u6211\u4eec\u9700\u8981\u6700\u5927\u5316\u7684\u662f $A_i\\cap B_{p_i}$ \u7684 \u603b\u957f\u5ea6\uff0c\u800c $B_i$ \u957f\u5ea6\u90fd\u76f8\u540c\u3002\u90a3\u4e48\u663e\u7136\u7684\uff0c$A_i$ \u548c $B_{p_i}$ \u4e2d\u70b9\u8d8a\u63a5\u8fd1\u5c31\u8d8a\u597d\u3002\u6240\u4ee5\u5176\u5b9e\u5206\u914d $B_i$ \u7684\u8fc7\u7a0b\u662f\u5f88\u4f18\u7f8e\u7684\uff1a\u628a $A$ \u6309\u4e2d\u70b9\u5750\u6807\u6392\u5e8f\uff0c\u90a3\u4e48\u4e00\u5b9a\u662f\u5c06\u5176\u5212\u5206\u4e3a\u4e0d\u8d85\u8fc7 $k$ \u4e2a\u8fde\u7eed\u6bb5\uff0c\u5176\u4e2d\u6bcf\u4e2a\u6bb5\u5185\u5bf9\u5e94\u7684 $B$ \u533a\u95f4\u76f8\u540c\u3002\n\n\u8fd9\u6837\u6211\u4eec\u5f88\u5bb9\u6613\u8bbe\u8ba1\u51fa\u4e00\u4e2a 2D/1D DP\u3002\u8bbe $f_{i,j}$ \u8868\u793a\u524d $i$ \u4e2a\u533a\u95f4\u5212\u5206\u6210 $j$ \u6bb5\u6700\u5927\u7684\u533a\u95f4\u4ea4\u7684\u957f\u5ea6\u548c\u3002\u8bb0 $g_{l, r}$ \u8868\u793a $A_{l\\dots r}$ \u7684\u6240\u6709\u533a\u95f4\u5982\u679c\u5206\u4e3a\u4e00\u7ec4\uff0c\u9009\u53d6\u7684 $B$ \u533a\u95f4\u6700\u4f18\u65f6\uff0c\u533a\u95f4\u4ea4\u7684\u957f\u5ea6\u548c\u3002\u90a3\u4e48\u8f6c\u79fb\u5f62\u5982 $f_{i, j} = \\max\\limits_{k=1}^{i}f_{k-1, j-1}+g_{k,i}$\u3002\n\n\u90a3\u4e48\u63a5\u4e0b\u6765\u5c31\u6709\u4e24\u4e2a\u95ee\u9898\uff1a\n\n1. \u600e\u4e48\u6c42\u51fa $g$\uff1b\n2. \u600e\u4e48\u5feb\u901f\u8f6c\u79fb $f$\u3002\n\n\u89e3\u51b3\u7b2c\u4e00\u4e2a\u95ee\u9898\u9700\u8981\u6bd4\u8f83\u597d\u7684\u76f4\u89c9\u3002\u9996\u5148\uff0c\u53ef\u80fd\u7684\u533a\u95f4\u6709 $\\Theta(x)$ \u79cd\uff0c\u8fd9\u662f\u4e0d\u53ef\u63a5\u53d7\u7684\u3002\u7b2c\u4e00\u53cd\u5e94\u662f\u6709\u6ca1\u6709\u4ec0\u4e48\u516c\u5f0f\u6216\u8005\u9ad8\u5999\u624b\u6bb5\u80fd\u76f4\u63a5\u8ba1\u7b97\u51fa\u533a\u95f4\u4f4d\u7f6e\uff0c\u4f46\u662f\u627e\u4e86\u4e00\u6bb5\u65f6\u95f4\u5e76\u6ca1\u6709\u3002\u90a3\u4e48\u8003\u8651\u53ef\u884c\u7684\u533a\u95f4\u3002\u5047\u8bbe\u4e00\u4e2a\u5019\u9009\u533a\u95f4\u7684\u5de6\u7aef\u70b9\u4e0d\u662f\u4efb\u4f55\u4e00\u4e2a\u6bb5\u5185 $A$ \u533a\u95f4\u7684\u5de6\u7aef\u70b9\uff0c\u53f3\u7aef\u70b9\u4e5f\u4e0d\u662f\u4efb\u4f55\u4e00\u4e2a\u6bb5\u5185\u533a\u95f4\u7684\u53f3\u7aef\u70b9\uff0c\u90a3\u4e48\u628a\u5b83\u5411\u5de6\u6216\u5411\u53f3\u79fb\u52a8\u4e00\u5b9a\u81f3\u5c11\u6709\u4e00\u4e2a\u4e0d\u52a3\u3002\u6240\u4ee5\u53ef\u80fd\u7684\u6700\u4f18\u533a\u95f4\u53ea\u6709 $\\Theta(n)$ \u79cd\u3002\u8fd9\u65f6\u5019\u5982\u679c\u9884\u5904\u7406\u51fa\u4e00\u4e9b\u524d\u7f00\u548c\uff0c\u53ef\u4ee5 $\\Theta(n^3)$ \u7b97\u51fa\u6240\u6709 $g$ \u7684\u503c\u3002\u8fd9\u663e\u7136\u4e0d\u591f\u3002\u5bf9 $g$ \u7684\u4e00\u4e9b\u6d1e\u5bdf\u544a\u8bc9\u6211\u4eec\uff0c\u8bb0 $g_{l,r}$ \u7684\u51b3\u7b56\u70b9\u4e3a $t_{l,r}$\uff0c\u5219 $t_{l-1,r}\\le t_{l,r}\\le t_{l,r+1}$\u3002\u76f4\u63a5\u8fd0\u7528\u51b3\u7b56\u5355\u8c03\u6027\u4f18\u5316\u505a\u5230 $\\Theta(n^2)$\u3002\n\n\u7b2c\u4e8c\u4e2a\u95ee\u9898\u6bd4\u8f83\u597d\u89e3\u51b3\u3002\u9996\u5148\u6ce8\u610f\u5230\u8bb0\u5f55 $j$ \u662f\u4e3a\u4e86\u9650\u5236\u533a\u95f4\u4e0d\u8d85\u8fc7 $k$ \u4e2a\uff0c\u4e8e\u662f\u76f4\u63a5\u4e0a\u4e00\u4e2a wqs \u4e8c\u5206\uff08aliens trick\uff09\u5373\u53ef\u505a\u5230\u5e73\u65b9 $\\log$\u3002\u53e6\u4e00\u79cd\u65b9\u6cd5\u5219\u662f\u6ce8\u610f\u5230 $g$ \u6ee1\u8db3\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\uff08\u8fd9\u5176\u5b9e\u662f\u6839\u636e DP \u65b9\u7a0b\u7684\u5f62\u72b6\u731c\u5230\u7684\uff09\uff0c\u90a3\u4e48 $f$ \u5177\u6709\u51b3\u7b56\u5355\u8c03\u6027\uff0c\u4e8e\u662f\u5c31\u505a\u5230\u4e86 $\\Theta(n^2)$\u3002\n\n\u6211\u7528\u4e86 wqs \u4e8c\u5206\u3002\n\n## \u4ee3\u7801\n\n```cpp\n// Author: kyEEcccccc\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\nusing LL = long long;\nusing ULL = unsigned long long;\n\n#define F(i, l, r) for (int i = (l); i <= (r); ++i)\n#define FF(i, r, l) for (int i = (r); i >= (l); --i)\n#define MAX(a, b) ((a) = max(a, b))\n#define MIN(a, b) ((a) = min(a, b))\n#define SZ(a) ((int)((a).size()) - 1)\n\nconst int N = 2005;\n\nint n, k, x, m, nn;\nstruct Seg { int l, r; } a[N];\nvector<int> p;\nint opt[N][N];\nLL f[N], g[N][N], w[N << 1][N];\nint h[N];\n\nLL intersect(Seg a, Seg b)\n{\n\tif (a.l > b.l) swap(a, b);\n\tif (a.r <= b.l) return 0;\n\treturn min(a.r, b.r) - b.l;\n}\n\nvoid compute_g(void)\n{\n\tF(i, 1, nn) F(j, 1, n)\n\t\tw[i][j] = w[i][j - 1] + intersect({p[i], p[i] + m}, a[j]);\n\tFF(d, n - 1, 0) F(l, 1, n - d)\n\t{\n\t\tint r = l + d;\n\t\tint pl = l == 1 ? 1 : opt[l - 1][r],\n\t\t\tpr = r == n ? nn : opt[l][r + 1];\n\t\t// cerr << l << ' ' << r << ' ' << pl << ' ' << pr << '\\n';\n\t\t// pl = 1, pr = nn;\n\t\tg[l][r] = LLONG_MIN / 2;\n\t\tF(i, pl, pr)\n\t\t{\n\t\t\tif (g[l][r] < w[i][r] - w[i][l - 1])\n\t\t\t{\n\t\t\t\topt[l][r] = i;\n\t\t\t\tg[l][r] = w[i][r] - w[i][l - 1];\n\t\t\t}\n\t\t}\n\t}\n}\n\npair<int, LL> compute(LL slp)\n{\n\tF(i, 1, n)\n\t{\n\t\tpair<LL, int> fr = {g[1][i], 0};\n\t\tF(j, 1, i - 1) MAX(fr, make_pair(f[j] + g[j + 1][i], -h[j]));\n\t\tf[i] = fr.first - slp; h[i] = -fr.second + 1;\n\t}\n\treturn {h[n], f[n]};\n}\n\nsigned main(void)\n{\n\t// freopen(\".in\", \"r\", stdin);\n\t// freopen(\".out\", \"w\", stdout);\n\tios::sync_with_stdio(0), cin.tie(nullptr);\n\n\tcin >> n >> k >> x >> m;\n\tLL ans = (LL)x * n - (LL)m * n;\n\tF(i, 1, n)\n\t{\n\t\tcin >> a[i].l >> a[i].r;\n\t\tans -= a[i].r - a[i].l;\n\t\tp.push_back(a[i].l + m > x ? x - m : a[i].l);\n\t\tp.push_back(a[i].r - m < 0 ? 0 : a[i].r - m);\n\t}\n\tsort(a + 1, a + n + 1, [] (Seg a, Seg b)\n\t\t{ return a.l + a.r < b.l + b.r; });\n\tsort(p.begin(), p.end());\n\tp.resize(unique(p.begin(), p.end()) - p.begin());\n\tnn = p.size();\n\tp.insert(p.begin(), 0);\n\n\tcompute_g();\n\n\tLL cl = 0, cr = 2000000000000LL, ca, cc;\n\twhile (cl <= cr)\n\t{\n\t\tLL cm = (cl + cr) >> 1;\n\t\tpair<int, LL> res = compute(cm);\n\t\tif (res.first <= k)\n\t\t\tca = res.second, cc = cm, cr = cm - 1;\n\t\telse cl = cm + 1;\n\t}\n\tcout << ca + ans + cc * k << '\\n';\n\t\n\treturn 0;\n}\n```",
        "postTime": 1684285262,
        "uid": 312811,
        "name": "Retired_kyEEcccccc",
        "ccfLevel": 7,
        "title": "CF1832F Zombies"
    },
    {
        "content": "\u786e\u5b9a\u54ea\u4e9b\u533a\u95f4\u5728\u4e00\u4e2a\u7ec4\u540e\u8003\u8651\u786e\u5b9a\u6700\u4f18\u533a\u95f4\u3002\n\n\u672c\u8d28\u4e0a\u662f\u6700\u5927\u5316\u603b\u4ea4\u96c6\u3002\u4e00\u5b9a\u5b58\u5728\u6700\u4f18\u65b9\u6848\u4f7f\u5f97\u6211\u4eec\u786e\u5b9a\u7684\u533a\u95f4\u7684\u5de6/\u53f3\u7aef\u70b9\u5728\u7ed9\u5b9a\u533a\u95f4\u7684\u5de6/\u53f3\u7aef\u70b9\u4e0a\uff08\u6216\u8005\u662f\u6570\u8f74\u7684\u8fb9\u754c\uff09\u3002\n\n\u5426\u5219\u4e00\u5b9a\u53ef\u4ee5\u4f7f\u7528\u8c03\u6574\u6cd5\u4f7f\u5f97\u5176\u4e0d\u52a3\u3002\n\n\u6240\u4ee5\u53ef\u9009\u533a\u95f4\u7684\u6570\u91cf\u964d\u4f4e\u5230\u4e86 $O(n)$ \u4e2a\u3002\n\n\u6211\u4eec\u5e94\u8be5\u53ef\u4ee5\u5b9a\u4e49 $f_{i,j}$ \u8868\u793a\u5f53\u524d\u533a\u95f4\u5de6\u7aef\u70b9\u5728 $j$ \uff0c\u9009\u62e9\u4e86 $i$ \u4e2a\u533a\u95f4\u7684\u6700\u4f18\u4ea4\u96c6\u5927\u5c0f\u3002\n\n\u90a3\u4e48\uff0c\u5b9e\u9645\u4e0a\uff0c\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u4e8c\u5206\u9009\u62e9\u65b0\u7684\u533a\u95f4\u7684\u4ee3\u4ef7\uff0c\u5b9e\u6d4b\u53d1\u73b0\u6574\u6570\u4ee3\u4ef7\u5c31\u53ef\u4ee5\u5f97\u51fa\u6b63\u786e\u7b54\u6848\u4e86\u3002\n\n\u90a3\u8fd9\u91cc\u5176\u5b9e\u6709\u4e00\u4e2a\u8d21\u732e\u7684\u6539\u53d8\u95ee\u9898\u3002\n\n\u4ece $j \\rightarrow k$ \uff1a\n\n- \u5de6\u7aef\u70b9\u5728 $j$ \u5de6\u8fb9\u7684\uff0c\u8ba9 $j$ \u8d21\u732e\u66f4\u4f18\u3002\n- \u5de6\u7aef\u70b9\u5728 $j,k$ \u4e4b\u95f4\u7684\u7ed9\u5b9a\u533a\u95f4 $[l,r)$\uff0c\u4ecd\u9700\u8ba8\u8bba\uff1a\n  - \u82e5 $r \\leq i + m$ \uff0c\u5219\u8fd9\u4e2a\u533a\u95f4\u5f52\u7ed9 $i$ \u66f4\u4f18\u3002\n  - \u5426\u5219\uff0c\u53f3\u8fb9\u7684\u533a\u95f4\uff0c\u5728\u53f3\u7aef\u70b9\u8fbe\u5230\u8fd9\u4e2a\u4f4d\u7f6e\u4e4b\u524d\uff0c\u8d21\u732e\u90fd\u662f $m$\uff0c\u518d\u5f80\u53f3\u79fb\u5c31\u4f1a\u51cf\u5c11\u3002\u518d\u5dee\u5206\u9884\u5904\u7406\u4e00\u4e0b\u8d21\u732e\u53d8\u5316\u91cf\u5c31\u597d\u4e86\u3002\n- \u5de6\u7aef\u70b9\u5728 $k$ \u53f3\u8fb9\u7684\uff0c\u8ba9 $k$ \u8d21\u732e\u66f4\u4f18\u3002\n\n\u4e8e\u662f\u53ef\u4ee5\u7ef4\u62a4\u4e00\u4e2a $val_{i,j}$ \u8868\u793a\u533a\u95f4\u9009\u5728 $i$ \uff0c\u90a3\u4e48\u5de6\u7aef\u70b9 $\\geq j$ \u7684\u533a\u95f4\u4e0e $i$ \u7684\u4ea4\u96c6\u548c\u662f\u591a\u5c11\u3002\n\n\u590d\u6742\u5ea6 $O(n^2 (\\log V + \\log n))$\u3002\n\n\u7ec6\u8282\u597d\u50cf\u6709\u70b9\u591a\uff0cCF \u53c9\u4eba\u592a\u731b\u4e86\uff0c\u628a\u6211\u7ed9\u53c9\u70c2\u4e86\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define pii pair <int , int>\n#define pll pair <LL , LL>\n#define mp make_pair\n#define fs first\n#define sc second\n#define int long long\nusing namespace std;\ntypedef long long LL;\ntypedef unsigned long long ULL;\n\n//const int Mxdt=100000;\n//static char buf[Mxdt],*p1=buf,*p2=buf;\n//#define getchar() p1==p2&&(p2=(p1=buf)+fread(buf,1,Mxdt,stdin),p1==p2)?EOF:*p1++;\n\ntemplate <typename T>\nvoid read(T &x) {\n\tT f=1;x=0;char s=getchar();\n\twhile(s<'0'||s>'9') {if(s=='-') f=-1;s=getchar();}\n\twhile(s>='0'&&s<='9') {x=(x<<3)+(x<<1)+(s^'0');s=getchar();}\n\tx *= f;\n}\n\ntemplate <typename T>\nvoid write(T x , char s='\\n') {\n\tif(!x) {putchar('0');putchar(s);return;}\n\tif(x<0) {putchar('-');x=-x;}\n\tT t = 0 , tmp[25] = {};\n\twhile(x) tmp[t ++] = x % 10 , x /= 10;\n\twhile(t -- > 0) putchar(tmp[t] + '0');\n\tputchar(s);\n}\n\nconst int MAXN = 2005;\nconst double eps = 1e-6;\n\nint n , k , m , x;\nint l[MAXN] , r[MAXN] , b[MAXN << 1] , p;\nLL val[MAXN << 1][MAXN << 1] , chg[MAXN << 1][MAXN << 1] , Cnt[MAXN << 1];\nvector <int> G[MAXN << 1];\n\npair <LL , int> f[MAXN << 1];\npair <LL , int> check(LL c , int op = 1) {\n\tfor (int i = 1; i <= p; ++i) if(b[i] <= x - m) {\n\t\tf[i] = mp(val[i][i] - c , -1 * op);\n\t\tfor (int j = 1; j < i; ++j) {\n\t\t\tfor (auto R:G[j]) if(R > b[i]) \n\t\t\t\tf[i].fs += min(R , b[i] + m) - b[i];\n\t\t}\n\t}\n\tfor (int i = 1; i < p; ++i) {\n\t\tfor (int j = i + 1; j <= p; ++j) if(b[j] <= x - m) {\n\t\t\tf[j] = max(f[j] , mp(f[i].fs - val[i][j] + val[j][j] + chg[i][j] - c , f[i].sc - 1 * op));\n\t\t}\n\t}\n\tpair <LL , int> res = f[1];\n\tfor (int i = 1; i <= p; ++i) res = max(res , f[i]);\n\tres.sc = -res.sc * op;\n\t\n\treturn res;\n}\n\nsigned main() {\n\tread(n),read(k),read(x),read(m);\n\t\n\tb[++p] = 0 , b[++p] = x - m;\n\tLL ans = n * x - m * n;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tread(l[i]),read(r[i]);\n\t\tans -= (r[i] - l[i]);\n\t\tb[++p] = l[i];\n\t\tif(r[i] >= m) b[++p] = r[i] - m;\n\t}\n\t\n\tsort(b + 1 , b + 1 + p);\n\tp = unique(b + 1 , b + 1 + p) - b - 1;\n\t\n\tfor (int i = 1; i <= n; ++i) {\n\t\tint d = lower_bound(b + 1 , b + 1 + p , l[i]) - b;\n\t\tG[d].push_back(r[i]);\n\t}\n\t\n\tfor (int i = 1; i <= p; ++i) {\n\t\tfor (int j = p; j >= i; --j) if(b[j] < b[i] + m) {\n\t\t\tval[i][j] = val[i][j + 1];\n\t\t\tfor (auto R:G[j]) val[i][j] += min(b[i] + m , R) - b[j];\n\t\t}\n\t}\n\t\n\tfor (int i = 1; i <= p; ++i) {\n\t\tfor (int j = i + 1; j <= p; ++j) {\n\t\t\tCnt[j] += Cnt[j - 1];\n\t\t\tchg[i][j] += chg[i][j - 1];\n\t\t\tfor (auto R:G[j]) if(R > b[i] + m) {\n\t\t\t\tint d = lower_bound(b + 1 , b + 1 + p , R - m) - b;\n\t\t\t\tif(d > j) chg[i][j + 1] += m - max(m + b[i] - b[j] , 0ll) , chg[i][d + 1] -= m - max(m + b[i] - b[j] , 0ll);\n\t\t\t\td = max(d , j);\n\t\t\t\tint h = lower_bound(b + 1 , b + 1 + p , R - max(m + b[i] - b[j] , 0ll)) - b;\n\t\t\t\tif(h > d) {\n\t\t\t\t\tchg[i][d + 1] += R - max(m + b[i] - b[j] , 0ll);\n\t\t\t\t\tCnt[d + 1] ++;\n\t\t\t\t\tCnt[h] --;\n\t\t\t\t\tchg[i][h] -= R - max(m + b[i] - b[j] , 0ll);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor (int j = i + 1; j <= p; ++j) {\n\t\t\tchg[i][j] -= Cnt[j] * b[j];\n\t\t}\n\t\tfor (int j = 1; j <= p; ++j) Cnt[j] = 0; \n\t}\n\t\n//\twrite(ans);\n//\twrite((LL)check(0).fs , ' ') , write(check(0).sc);\n\t\n\tLL l = 0 , r = 1e9 , res = 0;\n\t\n\twhile(l <= r) {\n\t\tdouble mid = (l + r) / 2;\n\t\tif(check(mid).sc <= k) res = mid , r = mid - 1;\n\t\telse l = mid + 1;\n\t}\n\t\n\tpair <LL , int> cur = check(res , -1);\n\tcur.sc = min(cur.sc , k);\n\t\n\twrite(ans + (LL)(cur.fs + res * cur.sc));\n\t\n\treturn 0;\n}\n```",
        "postTime": 1684324718,
        "uid": 171554,
        "name": "Reanap",
        "ccfLevel": 9,
        "title": "CF1832F Zombies"
    }
]
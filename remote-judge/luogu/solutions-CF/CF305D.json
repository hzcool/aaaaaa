[
    {
        "content": "\u9898\u610f\u4e0d\u518d\u91cd\u590d\n\ncodeforces \u8bc4\u5206 $2200$\n\n\u672c\u6587\u7528 $(x,y)$ \u8868\u793a $x$ \u5411 $y$ \u7684\u4e00\u6761**\u6709\u5411\u8fb9** , $d(x,y)$ \u8868\u793a $x$ \u5230 $y$ \u7684\u8ddd\u79bb\n\n\u9996\u5148\uff0c\u663e\u7136\uff0c\u6211\u4eec**\u5fc5\u987b**\u6dfb\u52a0 $\\forall x\\in[1,n-1],(x,x+1)$\n\n\u7136\u540e\uff0c\u6211\u4eec\u8003\u8651\u6ee1\u8db3\u7b2c\u4e8c\u4e2a\u6761\u4ef6\n\n\u6211\u4eec**\u53ef\u4ee5**\u6dfb\u52a0\u4e00\u4e9b\u9644\u52a0\u8fb9 $(x,x')$ \uff0c\u6ee1\u8db3 $x+k+1=x'$\n\n\u8fd9\u6837\u53ef\u4ee5\u4f7f\u5f97 $d(a,b),a\\le x,b\\ge x'$ \u7f29\u5c0f\u5230 $d(a,b)-k$\n\n\u4f46\u662f\u8981\u6ce8\u610f\u4e00\u70b9\n\n\u5bf9\u4e8e $\\forall (x,x'),(y,y')$ **\u5fc5\u987b**\u6ee1\u8db3 $x'>y,y'>x$ ,\u5373 $[x,x']\\cap[y,y']\\neq\\varnothing$\n\n\u5982\u679c\u4e0d\u8fd9\u6837,\u4ece $a$ \u5230 $b$ , $a\\le \\min(x,y),b\\ge\\max(x',y')$ \u5c06\u7ecf\u8fc7 $\\ge 2$ \u6761\u9644\u52a0\u8fb9\uff0c $d(a,b)$ \u51cf\u5c11\u8d85\u8fc7 $k$ ,\u6211\u4eec\u79f0\u8fd9\u79cd\u60c5\u51b5\u4e3a\u51b2\u7a81\n\n\u73b0\u5728\u6211\u4eec\u8003\u8651\u5982\u4f55\u8ba1\u6570\n\n\u8bb0 $p,q$ \u5206\u522b\u4e3a\u9884\u5148\u52a0\u7684\u9644\u52a0\u8fb9\u4e2d\u8d77\u59cb\u70b9\u7f16\u53f7\u6700\u5c0f\uff0c\u6700\u5927\u7684\n\n\u6211\u4eec\u679a\u4e3e $i$ ,\u5176\u4e2d $i$ \u4e3a\u6211\u4eec\u65b0\u52a0\u5165\u7684\u8fb9\u4e2d\u8d77\u59cb\u70b9\u7f16\u53f7\u6700\u5c0f\u7684\uff0c\u5f53\u7136\u9884\u5148\u52a0\u7684\u9644\u52a0\u8fb9\u4e2d\u6ca1\u6709 $(i,i')$\n\n\u6211\u4eec\u8981\u5148\u5224\u65ad $(i,i')$ \u662f\u5426\u6ee1\u8db3\u6761\u4ef6\uff0c\u5bb9\u6613\u77e5\u9053\u53ea\u9700\u4e0e $(p,p'),(q,q')$ \u5224\u65ad\u662f\u5426\u51b2\u7a81\n\n\u52a0\u5165 $(i,i')$ \u540e\uff0c\u65b0\u7684 $p,q$ \u53d8\u6210 $p_1,q_1$\n\n\u8bb0 $u$ \u4e3a\u80fd\u52a0\u5165\u7684\u8d77\u59cb\u70b9\u7f16\u53f7\u6700\u5927\u7684\u8fb9\n\n\u5f53 $p_1+k>n$ \u65f6 $u=n-(k+1)$ ,\u56e0\u4e3a\u7ec8\u5230\u4e0d\u80fd\u8d85\u8fc7 $n$\n\n\u5f53 $p_1+k\\le n$ \u65f6 $u=p+k$\n\n\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u5730\u8ba1\u6570\u53d1\u73b0\u6709 $2^{(u-i+1)-x-1}$ \u79cd\u52a0\u8fb9\u65b9\u6848,\n\n\u5176\u4e2d $x$ \u4e3a\u8d77\u59cb\u70b9\u7f16\u53f7\u5728 $[i,u]$ \u4e2d\u7684\u5df2\u52a0\u597d\u7684\u8fb9\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u8fb9\u4e0d\u80fd\u9009\u62e9\uff0c\u5fc5\u987b\u5b58\u5728\uff0c$-1$ \u56e0\u4e3a $(i,i')$ \u5fc5\u987b\u52a0\u5165\n\n\u5bf9\u4e8e\u8d77\u59cb\u72b6\u6001\u6ca1\u6709\u9644\u52a0\u8fb9\u7684\u56fe\uff0c\u8fdb\u884c\u7279\u6b8a\u5224\u65ad\u7279\u6b8a\u5904\u7406\uff0c\u7c7b\u4f3c\u4e8e\u4e0a\u9762\u7684\u5206\u7c7b\u65b9\u6cd5\n\n\u5f53\u6709\u4e00\u6761\u9884\u5148\u52a0\u7684\u8fb9 $(x,y)$ \u4e0d\u6ee1\u8db3 $y=x+1$ \u6216\u8005 $y=x+k+1$ \u65f6\u65e0\u89e3\uff0c\u6b64\u65f6\u5e94\u8be5\u8f93\u51fa $0$\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#define mod 1000000007\nint n,m,k,flag,ans,cnt,p,q,w[1000005],f[1000005],g[1000005],s[1000005];\nint main()\n{\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tw[0]=1;for (int i=1;i<=n;i++) w[i]=w[i-1]*2%mod;\n\tfor (int i=1;i<=m;i++)\n\t{\n\t\tint x,y;\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tif (x>y) std::swap(x,y);\n\t\tif (x+1==y) f[x]=1;\n\t\telse if (x+k+1==y) g[x]=1,++cnt;\n\t\telse flag=1;\n\t}\n\tif (flag)\n\t{\n\t\tputs(\"0\");\n\t\treturn 0;\n\t}\n   if (cnt==0)\n\t{\n\t\tfor (int i=1;i<=n;i++)\n\t   {\n\t\t   if (i+k+1>n) continue;\n\t\t\tint up=(i+k+k+1>n?n-k-1:i+k);\n\t\t\tint can=up-i+1;\n\t\t   ans=(ans+w[can-1])%mod;\n\t   }\n\t   ++ans;\n\t   printf(\"%d\\n\",ans);\n\t   return 0;\n\t}\n\tfor (int i=1;i<=n;i++) if (g[i]) q=i;\n\tfor (int i=n;i>=1;i--) if (g[i]) p=i;\n\tif (p+k+1<=q)\n\t{\n\t\tputs(\"0\");\n\t\treturn 0;\n\t}\n\tfor (int i=1;i<=n;i++) s[i]=s[i-1]+g[i];\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tif (g[i]||i+k+1>n) continue;\n\t\tif (i>=p+k+1||i+k+1<=q) continue;\n\t\tint cp=p,cq=q;\n\t\tif (i<p) p=i;if (i>q) q=i;\n\t\tint up=(p+k+k+1>n?n-k-1:p+k);\n\t\tint can=up-i+1-(s[up]-s[i-1]);\n\t\tans=(ans+w[can-1])%mod;\n\t\tq=cq,p=cp;\n\t}\n\t++ans;\n\tprintf(\"%d\\n\",ans);\n}\n```\n\u5b9e\u6d4b $57$ \u4e2a\u6d4b\u8bd5\u70b9 $3.05s,18.82MB$\n\n\u6700\u5927\u6d4b\u8bd5\u70b9 $122ms$\n\n\u8c22\u8c22\u89c2\u770b",
        "postTime": 1594734833,
        "uid": 36957,
        "name": "RainFestival",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF305D \u3010Olya and Graph\u3011"
    }
]
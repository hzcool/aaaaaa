[
    {
        "content": "\u559c\u95fb\u4e50\u89c1\u7684EDU round\u677f\u5b50\u9898.\n~~\u5750\u7b49\u795e\u4ed9@NaCly_Fish\u53d1\u5728\u7ebf\u505a\u6cd5~~\n\n\u5957\u7528\u7ebf\u6bb5\u6811\u5206\u6cbb.\u4fdd\u8bc1\u4e00\u6761\u8fb9\u88ab\u63d2\u5165\u6b21\u6570\u662f$O(log\\,m)$\u7684.\u7136\u540edfs\u8fd9\u4e2a\u7ebf\u6bb5\u6811.\n\u4fdd\u8bc1\u8fdb\u5165\u533a\u95f4$[l,r]$\u65f6,\u6709\u4e14\u4ec5\u6709\u5728\u65f6\u95f4$[l,r]$\u4e00\u76f4\u5b58\u5728\u7684\u8fb9\u88ab\u8003\u8651\u5230.\n\n\u4e00\u76f4\u7ef4\u6301\u8fd9\u4e2a\u6027\u8d28\u8d70\u5230\u53f6\u5b50\u5373\u53ef\u56de\u7b54\u8be2\u95ee.\u56de\u6eaf\u65f6\u53ef\u4ee5\u53cd\u5411\u64a4\u9500.\u8fd9\u6837\u6211\u4eec\u7ef4\u62a4\u7684\u6240\u8c13\u52a8\u6001\u56fe\u53ea\u6709\u52a0\u8fb9,\u5224\u540c\u8272\u4e0d\u76f8\u90bb\u80fd\u5426\u4e8c\u67d3\u8272,\u64a4\u9500\u6700\u540e\u4e00\u6761\u52a0\u5165\u7684\u8fb9.~~\u663e\u7136\u662fLCT~~\u7528\u5e26\u6743\u5e76\u67e5\u96c6\u7684trick\u5224\u65ad\u4e8c\u5206\u56fe,\u7528\u6309size/height\u5408\u5e76\u4fdd\u8bc1\u6811\u9ad8,\u5e76\u4e14\u4fdd\u8bc1\u5355\u6b21merge\u53ea\u6539\u53d8$O(1)$\u6761\u5e76\u67e5\u96c6\u4e2d\u7684\u8fb9\u6240\u4ee5\u53ef\u4ee5\u652f\u6301\u9ad8\u6548\u64a4\u9500.\n\n\n\u54e6\u4f3c\u4e4e\u6ca1\u626f\u600e\u4e48\u5224\u4e8c\u5206\u56fe?\u6211\u4eec\u7ef4\u62a4\u539f\u56fe\u7684\u4efb\u610f\u4e00\u4e2a\u751f\u6210\u6811,\u63d2\u5165\u4e00\u6761\u8fb9,\u5982\u679c\u662f\u8fde\u63a5\u4e24\u4e2a\u4e0d\u76f8\u4ea4\u7684\u6811,\u90a3\u4e48\u5fc5\u7136\u6ca1\u6709\u77db\u76fe.\n\n\u5982\u679c\u63d2\u5165\u7684\u8fb9\u5f62\u6210\u5947\u73af,\u90a3\u4e48\u4e4b\u540e\u4e0d\u8bba\u5982\u4f55\u52a0\u5165\u8fb9\u90fd\u4e0d\u662f\u4e8c\u5206\u56fe,\u5947\u73af?\u5c31\u662f\u751f\u6210\u6811\u4e0a\u7684\u8ddd\u79bb\u4e3a\u5076\u6570,\u518d\u52a0\u4e00\u6761\u8fb9\u5f62\u6210\u7684.$d(x,y)\\equiv d(x)+d(y)-2d(lca)\\pmod 2$\u5f88\u660e\u663e\u540e\u9762\u7684\u6ca1\u4e86...\u7136\u540e\u5c31\u662f\u7ef4\u62a4\u5230\u6839\u7684\u8ddd\u79bb...\u8fd9\u4e2a\u662f\u5e26\u6743\u5e76\u67e5\u96c6\u53ef\u4ee5\u505a\u7684.\u5f53\u7136\u4e5f\u53ef\u4ee5\u66b4\u529bLCT...\u770b\u6837\u5b50\u65f6\u95f4\u5f88\u677e.lct\u4e5f\u80fd\u8f7b\u677e\u8fc7?\n\n----\n\n\u601d\u60f3\u8bb2\u5b8c\u4e86.\u6211\u4eec\u6254\u4ee3\u7801\u8dd1\u8def...\u7ebf\u6bb5\u6811\u5206\u6cbb\u8fd9\u4e2atrick.\u53ef\u4ee5\u53c2\u8003\u8fd9\u91cc\u5b66\u4e60.\n\n2014\u5e74\u96c6\u8bad\u961f\u8bba\u6587:\u7ebf\u6bb5\u6811\u5728\u4e00\u7c7b\u5206\u6cbb\u95ee\u9898\u4e0a\u7684\u5e94\u7528.\n(btw,\u8fd9\u4e2a\u4e1c\u897f\u548c\u6240\u8c13cdq/gyz\u5206\u6cbb\u5e94\u8be5\u662f\u6bd4\u8f83\u63a5\u8fd1\u7684\u4e1c\u897f....\u6709\u70b9\u7c7b\u4f3c\u4e8e\u70b9\u5206\u6cbb\u548c\u91cd\u5fc3\u5256\u5206\u7684\u5173\u7cfb...\u7ebf\u6bb5\u6811\u5206\u6cbb\u8fd9\u4e2a\u6280\u5de7\u4e2d\u8981\u5efa\u51fa\u4e86\u5206\u6cbb\u8fc7\u7a0b\u7684\u9012\u5f52\u6811\u7ed3\u6784)\n\n\n```cpp\n#include <bits/stdc++.h>\nconst int N=200000+10;\nint n,m,ans[N];\nstruct E{ int u,v; E(int a,int b):u(a),v(b){} };\nstd::map<int,int> g[N];\n\nint L[N<<2],R[N<<2];\nstd::vector<E> tag[N<<2];\n#define lc (o<<1)\n#define rc ((o<<1)|1)\nvoid build(int o,int l,int r){\n\tL[o]=l;R[o]=r; if(l==r) return ;\n\tint mid=(l+r)>>1;\n\tbuild(lc,l,mid); build(rc,mid+1,r);\n}\n// \u628a\u4e00\u6761\u8fb9\u62c6\u5230logm\u4e2a\u533a\u95f4\u4e0a\u53bb.\n// \u53ef\u4ee5\u8bf4\u7ebf\u6bb5\u6811\u53ea\u662f\u7528\u6765\u4fdd\u8bc1\u590d\u6742\u5ea6\u7684...\nvoid query(int o,int l,int r,const E&e){\n\tif(L[o]>r||R[o]<l) return ;\n\tif(l<=L[o]&&R[o]<=r){ tag[o].push_back(e); return ; }\n\tquery(lc,l,r,e); query(rc,l,r,e);\n}\n\n//merged tree(root=x)->tree(root=y)\nstruct P{ int x,y; P(int a,int b):x(a),y(b){} };\nint fa[N],size[N],dis[N];\ninline int getpar(int x){\n\twhile(fa[x]!=x) x=fa[x];\n\treturn x;\n}\n\n// \u5230\u5e76\u67e5\u96c6\u6839\u6240\u7ecf\u8fc7\u7684\u8fb9\u6570mod2.\n// mod2\u610f\u4e49\u4e0b\u7684\u52a0\u6cd5\u5373\u4e3axor.\n// \u7528\u6765\u67e5\u8be2x\u548c\u6839\u662f\u4e0d\u662f\u76f8\u540c\u989c\u8272.\ninline int getdis(int x){\n\tint d=0;\n\twhile(fa[x]!=x){ d^=dis[x]; x=fa[x]; }\n\treturn d;\n}\n/// \u6309\u7167size\u5408\u5e76.\ninline int solve(int x,int y,std::stack<P> &stk){\n\tint dx=getdis(x),dy=getdis(y);\n\tx=getpar(x);y=getpar(y);\n\tif(x==y) return (dx^dy);\n\tif(size[x]>size[y]){ std::swap(x,y); std::swap(dx,dy); }\n\tsize[y]+=size[x];\n\tfa[x]=y; dis[x]=(dx^dy^1);\n\tstk.push(P(x,y));\n\treturn 1;\n}\n// \u64a4\u9500(x->y)\u7684\u5408\u5e76.\u62c6\u51fa\u6765,size\u6539\u56de\u53bb.dis\u6539\u62100\ninline void back(P p){\n\tint x=p.x,y=p.y;\n\tsize[y]-=size[x];\n\tdis[fa[x]=x]=0;\n}\n// \u9012\u5f52\u7ebf\u6bb5\u6811,\u8fdb\u5165\u533a\u95f4[l,r]\u65f6\n// \u4fdd\u8bc1\u65f6\u95f4\u8f74\u4e0a[l,r]\u8303\u56f4\u5185\u4e00\u76f4\u53ef\u7528\u7684\u8fb9\u90fd\u88ab\u52a0\u5165\u4e86\nvoid dfs(int o,int flag){\n\tstd::stack<P> stk;\n\tfor(auto e:tag[o]) flag&=solve(e.u,e.v,stk);\n\tif(L[o]==R[o]) ans[L[o]]=flag;\n\telse{ dfs(lc,flag); dfs(rc,flag); }\n// \u64a4\u9500\u64cd\u4f5c...\u4e0d\u7136\u4ece\u7238\u7238\u8fdb\u5165\u5144\u5f1f\u8282\u70b9\u7684\u65f6\u5019\u5f00\u59cb\u8bb2\u5230\u7684\u90a3\u4e2a\u6027\u8d28\u4f1a\u88ab\u7834\u574f.\n// \u6ce8\u610f\u64a4\u9500\u987a\u5e8f...\n\twhile(!stk.empty()){ back(stk.top()); stk.pop(); }\n}\n\nint read(){\n\tint x=0;char c;\n\tdo{c=getchar();}while(!isdigit(c));\n\tdo{x=x*10+c-'0';c=getchar();}while(isdigit(c));\n\treturn x;\n}\nint main(){\n\tn=read();m=read(); build(1,1,m);\n\tint x,y;\n\tfor(int i=1;i<=m;i++){\n\t\tx=read();y=read(); if(x>y) std::swap(x,y);\n\t\tif(g[x][y]==0) g[x][y]=i;\n\t\telse{\n\t\t\tquery(1,g[x][y],i-1,E(x,y));\n\t\t\tg[x][y]=0;\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tsize[fa[i]=i]=1;\n\t\tfor(auto p:g[i]) if(p.second>0)\n\t\t\tquery(1,p.second,m,E(i,p.first));\n\t}\n\tdfs(1,1);\n\tfor(int i=1;i<=m;i++) puts(ans[i]?\"YES\":\"NO\");\n\treturn 0;\n}\n\n```\n\n",
        "postTime": 1554433420,
        "uid": 15295,
        "name": "hehelego",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF813F \u3010Bipartite Checking\u3011"
    },
    {
        "content": "\u7ebf\u6bb5\u6811\u5206\u6cbb+\u5e26\u6743\u5e76\u67e5\u96c6\n\n\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u65f6\u95f4\u8f74\uff0c\u628a\u6bcf\u6761\u8fb9\u8986\u76d6\u7684\u65f6\u95f4\u7528vector\u5b58\u5728\u5bf9\u5e94\u7684\u7ebf\u6bb5\u6811\u8282\u70b9\u4e0a\u3002\u904d\u5386\u7ebf\u6bb5\u6811\u65f6\u4f7f\u7528\u53ef\u64a4\u9500\u5e26\u6743\u5e76\u67e5\u96c6\u7ef4\u62a4\u4e24\u70b9\u4e4b\u95f4\u8ddd\u79bb\u5947\u5076\uff0c\u5728\u8fde\u8fb9\u65f6\u5982\u679c\u4e24\u70b9\u4e4b\u95f4\u8ddd\u79bb\u4e3a2\u7684\u500d\u6570\u5219\u56fe\u4e0d\u662f\u4e8c\u5206\u56fe\uff0c\u76f4\u63a5\u628a\u5f53\u524d\u8282\u70b9\u4e0b\u7684\u6240\u6709\u8be2\u95ee\u90fd\u56de\u7b54NO\u3002\u5f53\u9012\u5f52\u5230\u53f6\u5b50\u7684\u65f6\u5019\u7b54\u6848\u4e3aYES\u3002\n\n```cpp\n#include <stdio.h>\n#include <string.h>\n#include <set>\n#include <vector>\nusing namespace std;\ntypedef pair<int,int> pa;\nconst int N=1e5+2,M=4e5+2;\nvector<pa> s[M];\nset<pa> lj[N];\nset<pa>::iterator it;\npa st[N],cr;\nint f[N],rk[N],len[N],l[M],r[M];\nint n,m,q,i,x,y,z,u,v,c,tp;\ninline void read(int &x)\n{\n\tc=getchar();\n\twhile ((c<48)||(c>57)) c=getchar();\n\tx=c^48;c=getchar();\n\twhile ((c>=48)&&(c<=57))\n\t{\n\t\tx=x*10+(c^48);\n\t\tc=getchar();\n\t}\n}\nvoid build(int x)\n{\n\twhile (l[x]<r[x])\n\t{\n\t\tl[c=x<<1]=l[x];r[c]=l[x]+r[x]>>1;\n\t\tl[c|1]=r[c]+1;r[c|1]=r[x];\n\t\tbuild(c);x=x<<1|1;\n\t}\n}\nvoid add(int x)\n{\n\tif ((z<=l[x])&&(r[x]<=y))\n\t{\n\t\ts[x].push_back(cr);\n\t\treturn;\n\t}\n\tif (z<=r[x<<1]) add(x<<1);\n\tif (y>r[x<<1]) add(x<<1|1);\n}\nvoid getf(int &x,int &y)\n{\n\ty=0;\n\twhile (f[x]!=x)\n\t{\n\t\ty^=len[x];\n\t\tx=f[x];\n\t}\n}\ninline int uni(int x,int y)\n{\n\tgetf(x,u);getf(y,v);\n\tif (x!=y)\n\t{\n\t\tif (rk[x]>rk[y]) swap(x,y);\n\t\tf[x]=y;cr.first=x;len[x]=u^v^1;\n\t\tcr.second=rk[y];\n\t\tif (rk[x]==rk[y]) ++rk[y];\n\t\tst[++tp]=cr;return 0;\n\t}\n\treturn (u^v^1);\n}\ninline void del(pa &x)\n{\n\trk[f[x.first]]=x.second;\n\tf[x.first]=x.first;\n}\nvoid sum(int x)\n{\n\tint cur=tp;\n\tfor (i=0;i<s[x].size();i++) if (uni(s[x][i].first,s[x][i].second))\n\t{\n\t\twhile (tp>cur) del(st[tp--]);\n\t\tfor (i=l[x];i<=r[x];i++) puts(\"NO\");\n\t\treturn;\n\t}\n\tif (l[x]==r[x]) {puts(\"YES\");while (tp>cur) del(st[tp--]);return;}\n\tsum(x<<1);sum(x<<1|1);\n\twhile (tp>cur) del(st[tp--]);\n}\nint main()\n{\n\tread(n);read(q);m=n<<1;\n\tr[l[1]=1]=q;build(1);\n\tfor (i=1;i<=n;i++) f[i]=i;\n\tfor (i=1;i<=q;i++)\n\t{\n\t\tread(u);read(v);\n\t\tif (u>v) swap(u,v);\n\t\tcr.first=v;cr.second=0;\n\t\tit=lj[u].lower_bound(cr);\n\t\tif ((it==lj[u].end())||((*it).first!=v))\n\t\t{\n\t\t\tcr.second=i;\n\t\t\tlj[u].insert(cr);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tz=(*it).second;y=i-1;\n\t\t\tlj[u].erase(it);\n\t\t\tcr.first=u;cr.second=v;add(1);\n\t\t}\n\t}\n\tfor (i=1;i<=n;i++) for (it=lj[i].begin();it!=lj[i].end();it++)\n\t{\n\t\tcr.first=i;cr.second=(*it).first;\n\t\tz=(*it).second;y=q;add(1);\n\t}\n\tsum(1);\n}\n```\n",
        "postTime": 1554293693,
        "uid": 29826,
        "name": "SSerxhs",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF813F \u3010Bipartite Checking\u3011"
    },
    {
        "content": "\u5206\u6cbb+LCT\n\n\u8003\u8651\u628a\u6bcf\u6761\u8fb9\u51fa\u73b0\u7684\u533a\u95f4$[L,R]$\u627e\u51fa\u6765\uff0c\u7136\u540e\u5206\u6cbb\u3002\n\n\u6bcf\u6b21\u52a0\u5165\u4e00\u6761\u8fb9$(u,v,L,R)$\u65f6\uff0c\u82e5$u,v$\u4e0d\u8fde\u901a\uff0c\u76f4\u63a5\u8fde\uff0c\u82e5\u8054\u901a\uff0c\u5224\u65ad\u957f\u5ea6\u662f\u5426\u4e3a\u5076\u6570\uff0c\u4e3a\u5076\u6570\u5219$[L\\dots R]$\u5168\u4e3a$NO$\uff0c\u4e3a\u5947\u6570**\u4e0d\u8fdb\u884c\u4efb\u4f55\u64cd\u4f5c**\u3002\n\n\u7136\u540e\u5206\u6cbb$[l,mid]$\uff0c$[mid+1,r]$\u3002\u6700\u540e\u64a4\u9500\u52a0\u5165\u7684\u8fb9\u3002\n\n```\n#include<cstdio>\n#include<map>\n#include<vector>\nusing namespace std;\nconst int N=1e5+50;\nint n,q,x,y,z;\nint zn[N],cnt;\nmap<int,int>mp[N];\ntypedef map<int,int>::iterator IT;\nstruct node{\n\tint x,y,l,r;\n\tnode(){}\n\tnode(int X,int Y,int L,int R):x(X),y(Y),l(L),r(R){}\n};\nvector<node>vp;\ninline void swap(int &u,int &v){int o=u;u=v;v=o;}\nstruct lct{\n\tint ch[N][2],fa[N],tagrev[N],sum[N];\n\tbool isrot(int x){\n\t\treturn ch[fa[x]][0]!=x&&ch[fa[x]][1]!=x;\n\t}\n\tvoid rev(int x){\n\t\ttagrev[x]^=1;\n\t\tswap(ch[x][0],ch[x][1]);\n\t}\n\tvoid pushdown(int x){\n\t\tif(!isrot(x))pushdown(fa[x]);\n\t\tif(!tagrev[x])return;\n\t\ttagrev[x]=0;\n\t\trev(ch[x][0]);rev(ch[x][1]);\n\t}\n\tvoid update(int x){\n\t\tsum[x]=sum[ch[x][0]]+sum[ch[x][1]]+1;\n\t}\n\tvoid rotate(int x){\n\t\tint y=fa[x],z=fa[y],opt=(ch[y][1]==x),w=ch[x][opt^1];\n\t\tif(!isrot(y))ch[z][ch[z][1]==y]=x;fa[x]=z;\n\t\tch[y][opt]=w;fa[w]=y;\n\t\tch[x][opt^1]=y;fa[y]=x;\n\t\tupdate(y);update(x);\n\t}\n\tvoid splay(int x){\n\t\tint y,z;pushdown(x);\n\t\twhile(!isrot(x)){\n\t\t\ty=fa[x];z=fa[y];\n\t\t\tif(!isrot(y))\n\t\t\trotate(((ch[y][0]==x)^(ch[z][0]==y))?x:y);\n\t\t\trotate(x);\n\t\t}\n\t}\n\tvoid access(int x){\n\t\tfor(int y=0;x;y=x,x=fa[x])\n\t\tsplay(x),ch[x][1]=y,update(x);\n\t}\n\tvoid mktrot(int x){\n\t\taccess(x);splay(x);rev(x);\n\t}\n\tvoid mkvrot(int x){\n\t\taccess(x);splay(x);\n\t}\n\tvoid link(int x,int y){\n\t\tmktrot(x);mkvrot(y);\n\t\tfa[x]=y;\n\t}\n\tvoid cut(int x,int y){\n\t\tmktrot(x);mkvrot(y);\n\t\tch[y][0]=fa[x]=0;\n\t\tupdate(y);\n\t}\n\tint query(int x,int y){\n\t\tmktrot(x);mkvrot(y);int z;\n\t\tfor(z=y;ch[z][0];z=ch[z][0]);\n\t\treturn x==z?sum[y]:0;\n\t}\n}s;\nvoid solve(int l,int r,vector<node>&t){\n\tvector<node>L,R;int cnt_=cnt,mid=l+r>>1;\n\tfor(int i=0,j;i<t.size();i++){\n\t\tif(t[i].l==l&&t[i].r==r){//\u52a0\u5165\u8fb9\n\t\t\tj=s.query(t[i].x,t[i].y);//\u67e5\u8be2\u4e24\u70b9\u95f4\u8def\u5f84\u957f\u5ea6\uff08\u8fd9\u91cc\u662f\u70b9\u7684\u4e2a\u6570\uff09\n\t\t\tif(j&1){//\u6709\u5076\u73af\uff08\u5947\u6570\u4e2a\u70b9\uff09\n\t\t\t\tfor(;l<=r;l++)puts(\"NO\");//\u8f93\u51faNO\n\t\t\t\tfor(;cnt>cnt_;cnt--)s.cut(t[zn[cnt]].x,t[zn[cnt]].y);//\u64a4\u9500\u5df2\u7ecf\u52a0\u5165\u7684\u8fb9\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(!j)s.link(t[i].x,t[i].y),zn[++cnt]=i;//\u6ca1\u6709\u8fde\u901a\uff0c\u5219\u8fde\u63a5\n\t\t\tcontinue;\n\t\t}\n\t\tif(t[i].l>mid)R.push_back(t[i]);\n\t\telse if(t[i].r<=mid)L.push_back(t[i]);\n\t\telse L.push_back(node(t[i].x,t[i].y,t[i].l,mid)),R.push_back(node(t[i].x,t[i].y,mid+1,t[i].r));\n\t}\n\tif(l==r){\n\t\tputs(\"YES\");\n\t\tfor(;cnt>cnt_;cnt--)s.cut(t[zn[cnt]].x,t[zn[cnt]].y);//\u64a4\u9500\n\t\treturn;\n\t}\n\tsolve(l,mid,L);solve(mid+1,r,R);//\u5206\u6cbb\u5de6\u53f3\u4e24\u8fb9\n\tfor(;cnt>cnt_;cnt--)s.cut(t[zn[cnt]].x,t[zn[cnt]].y);//\u64a4\u9500\n}\nint main(){\n\tscanf(\"%d%d\",&n,&q);\n\tfor(int i=1;i<=n;i++)s.sum[i]=1;\n\tfor(int i=1;i<=q;i++){\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tif(x>y)swap(x,y);\n\t\tz=mp[x][y];\n\t\tif(z)vp.push_back(node(x,y,z,i-1)),mp[x][y]=0;\n\t\telse mp[x][y]=i;\n\t}\n\tfor(int i=1;i<=n;i++)\n\tfor(IT j=mp[i].begin();j!=mp[i].end();++j)\n\tif(j->second)vp.push_back(node(i,j->first,j->second,q));\n    //vp\u6570\u7ec4\u91cc\u653e\u4e86\u6240\u6709\u8fb9\u7684\u5b58\u5728\u65f6\u95f4\n\tsolve(1,q,vp);\n}\n```",
        "postTime": 1553657303,
        "uid": 50092,
        "name": "da32s1da",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF813F \u3010Bipartite Checking\u3011"
    }
]
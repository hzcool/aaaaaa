[
    {
        "content": "# \u89e3\u6cd5\u5206\u6790\n\u4f7f\u7528\u4e8c\u4f4d\u524d\u7f00\u548c\u89e3\u51b3\u6b64\u9898\u3002\u4f7f\u7528\u4e00\u4e2a\u4e8c\u7ef4\u6570\u7ec4 $s$ \u8bb0\u5f55\u524d\u7f00\u548c\uff0c\u6bcf\u8bfb\u5165\u4e00\u4e2a\u77e9\u5f62\u7684 $h$ \u548c $w$ \u5c31\u5728\u5bf9\u5e94\u4f4d\u7f6e\u52a0\u4e0a\u5b83\u7684\u9762\u79ef\uff0c\u5373\u6267\u884c $s_{h, w}\\gets s_{h, w}+ h\\times w$\uff0c\u8bfb\u5165\u5b8c\u540e\u8ba1\u7b97\u4e00\u904d\u524d\u7f00\u548c\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee\uff0c\u7531\u4e8e $h_{s}<h_{i}<h_{b}$ \u4e14 $w_{s}<w_{i}<w_{b}$\uff0c\u8ba1\u7b97 $s_{hs+1, ws+1}$ \u5230 $s_{hb-1, wb-1}$ \u7684\u503c\uff0c\u5373 $s_{hb - 1, wb - 1}- s_{hb - 1, ws}- s_{hs, wb - 1}+ s_{hs, ws}$\u3002\n# \u4ee3\u7801\n\u5feb\u8bfb\u5feb\u8f93\u51fd\u6570\u5b9a\u4e49\u5df2\u7701\u7565\u3002\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define ll long long\n\nll s[1005][1005];\n\nint main() {\n\tint t = read(), n, q, h, w, hs, ws, hb, wb;\n\twhile (t--) {\n\t\tn = read(), q = read();\n\t\tfor (int i = 1; i <= 1000; ++i)\n\t\t\tfor (int j = 1; j <= 1000; ++j)\n\t\t\t\ts[i][j] = 0;\n\t\twhile (n--)\n\t\t\th = read(), w = read(), s[h][w] += h * w;\n\t\tfor (int i = 1; i <= 1000; ++i)\n\t\t\tfor (int j = 1; j <= 1000; ++j)\n\t\t\t\ts[i][j] += s[i - 1][j] + s[i][j - 1] - s[i - 1][j - 1];\n\t\twhile (q--)\n\t\t\ths = read(), ws = read(), hb = read(), wb = read(), write(s[hb - 1][wb - 1] - s[hb - 1][ws] - s[hs][wb - 1] + s[hs][ws]);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1661930791,
        "uid": 437893,
        "name": "ScottSuperb",
        "ccfLevel": 4,
        "title": "CF1722E Counting Rectangles \u9898\u89e3"
    },
    {
        "content": "# CF1722E Counting Rectangles \u9898\u89e3\u62a5\u544a\r\n\r\n## \u524d\u8a00\r\n\r\n\u5148\u5410\u69fd\u4e00\u4e0b\u8fd9\u4e2a\u7ffb\u8bd1\uff0c\u5199\u5f97\u8fd9\u77ed\u5c0f\u7cbe\u608d\u2026\u2026\r\n\r\n\u591a\u4e8f\u4e86\u6709 dalao @yangshiyu10 \u7684\u5e2e\u52a9\u3002\r\n\r\n## \u9898\u610f\r\n\r\n\u7ed9\u5b9a $n$ \u4e2a\u77e9\u9635\uff0c$q$ \u6b21\u8be2\u95ee\u3002\r\n\r\n\u6bcf\u6b21\u7ed9\u5b9a\u56db\u4e2a\u6574\u6570 $h_s,w_s,h_b,w_b$\uff0c\u957f\u5728 $(h_s,h_b)$\uff0c\u5bbd\u5728 $(w_s,w_b)$ \u4e4b\u95f4\u7684\u6240\u6709\u77e9\u9635\u7684\u9762\u79ef\u4e4b\u548c\u3002\r\n\r\n## \u9898\u89e3\r\n\r\n\u957f\u548c\u5bbd\u90fd\u662f\u957f\u5ea6\uff0c\u5f88\u5bb9\u6613\u60f3\u5230\u6743\u503c\u7ebf\u6bb5\u6811\u3002\r\n\r\n\u4f46\u662f\u6709\u4e24\u4e2a\u9650\u5236\u533a\u95f4\uff0c\u6709\u5f88\u5bb9\u6613\u60f3\u5230\u6811\u5957\u6811\u3002\r\n\r\n\u90a3\u4e48\u5c31\u53ef\u4ee5\u7528 **\u6743\u503c\u7ebf\u6bb5\u6811\u5957\u6743\u503c\u7ebf\u6bb5\u6811** \u6765\u89e3\u51b3\u8fd9\u9053\u9898\u3002\r\n\r\n\u7b2c\u4e00\u7ef4\u6743\u503c\u6811\u7ef4\u62a4 $h$\uff0c\u7b2c\u4e8c\u7ef4\u6743\u503c\u6811\u7ef4\u62a4 $w$\u3002\r\n\r\n\u6bcf\u6b21\u5728\u4e00\u7ef4\u7ebf\u6bb5\u6811\u5355\u70b9\u4fee\u6539\uff0c\u5bf9\u5e94\u4e00\u7ef4\u7ebf\u6bb5\u6811\u7684 $\\log n$ \u4e2a\u8282\u70b9\u3002\r\n\r\n\u800c\u4e00\u7ef4\u7ebf\u6bb5\u6811\u7684\u6bcf\u4e2a\u8282\u70b9\uff0c\u53c8\u5bf9\u5e94\u8fd9\u4e00\u68f5\u4e8c\u7ef4\u7ebf\u6bb5\u6811\u3002\r\n\r\n\u4e8c\u7ef4\u7ebf\u6bb5\u6811\u7684\u5355\u70b9\u4fee\u6539\uff0c\u53c8\u5bf9\u5e94\u5176 $\\log n$ \u4e2a\u8282\u70b9\u3002\r\n\r\n\u6545\u6bcf\u6b21\u5355\u70b9\u4fee\u6539\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\log^2n)$\u3002\r\n\r\n\u800c\u533a\u95f4\u67e5\u8be2\uff0c\u540c\u6837\u662f $O(n\\log^2n)$ \u7684\u3002\r\n\r\n\u81f3\u4e8e\u7ec6\u8282\u5b9e\u73b0\uff0c\u770b\u4ee3\u7801\u5427\uff1a\r\n\r\n```cpp\r\n#include<cstdio>\r\n#include<cstring>\r\n#define int long long//\u9898\u5e72\u660e\u786e\u8bf4\u660e\u8981\u5f00 long long\r\nusing namespace std;\r\nint re()\r\n{\r\n\tint s=0,f=1;char ch=getchar();\r\n\twhile(ch>'9'||ch<'0')\r\n\t{\r\n\t\tif(ch=='-')f=-1;\r\n\t\tch=getchar();\r\n\t}\r\n\twhile(ch>='0'&&ch<='9')\r\n\t\ts=s*10+ch-48,ch=getchar();\r\n\treturn s*f;\r\n}\r\nvoid wr(int s)\r\n{\r\n\tif(s<0)putchar('-'),s=-s;\r\n\tif(s>9)wr(s/10);\r\n\tputchar(s%10+48);\r\n}\r\nconst int inf=1e3+7;\r\nint qwq,n,m;\r\nstruct Segment_Tree{//\u7b2c\u4e8c\u7ef4\r\n\tstruct Seg_Tree{\r\n\t\tint lc,rc;\r\n\t\tint sum;//\u6743\u503c\u548c\r\n\t}T[inf*inf*10];\r\n\tint cnt;//\u4e60\u60ef\u6027\u52a8\u6001\u5f00\u70b9\r\n\tvoid insert(int &i,int l,int r,int h,int w)\r\n\t{//\u5355\u70b9\u4fee\u6539\r\n\t\tif(i==0)i=++cnt;\r\n\t\tif(l==r)\r\n\t\t{\r\n\t\t\tT[i].sum+=h*w;//\u9762\u79ef\u548c\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tint mid=(l+r)>>1;\r\n\t\tif(w<=mid)insert(T[i].lc,l,mid,h,w);\r\n\t\telse insert(T[i].rc,mid+1,r,h,w);\r\n\t\tT[i].sum=T[T[i].lc].sum+T[T[i].rc].sum;\r\n\t}\r\n\tint ask(int i,int l,int r,int x,int y)\r\n\t{//\u533a\u95f4\u67e5\u8be2\r\n\t\tif(i==0)return 0;\r\n\t\tif(x<=l&&r<=y)return T[i].sum;\r\n\t\tint mid=(l+r)>>1,ans=0;\r\n\t\tif(x<=mid)ans+=ask(T[i].lc,l,mid,x,y);\r\n\t\tif(mid<y)ans+=ask(T[i].rc,mid+1,r,x,y);\r\n\t\treturn ans;\r\n\t}\r\n}xds;\r\nint rot[inf*10];//\u7b2c\u4e00\u7ef4\r\nvoid insert(int i,int l,int r,int h,int w)\r\n{//\u5355\u70b9\u4fee\u6539\r\n\txds.insert(rot[i],1,1000,h,w);//\u4fee\u6539 log n \u4e2a\u8282\u70b9\r\n\tif(l==r)return;\r\n\tint mid=(l+r)>>1;\r\n\tif(h<=mid)insert(i<<1,l,mid,h,w);\r\n\telse insert(i<<1|1,mid+1,r,h,w);\r\n}\r\nint ask(int i,int l,int r,int x,int y,int wx,int wy)\r\n{//\u533a\u95f4\u67e5\u8be2\r\n\tif(x<=l&&r<=y)return xds.ask(rot[i],1,1000,wx,wy);\r\n\tint mid=(l+r)>>1,ans=0;\r\n\tif(x<=mid)ans+=ask(i<<1,l,mid,x,y,wx,wy);\r\n\tif(mid<y)ans+=ask(i<<1|1,mid+1,r,x,y,wx,wy);\r\n\treturn ans;\r\n}\r\nsigned main()\r\n{\r\n\tqwq=re();\r\n\twhile(qwq--)\r\n\t{//\u591a\u6d4b\u6e05\u7a7a\r\n\t\tmemset(rot,0,sizeof(rot));\r\n\t\tmemset(xds.T,0,sizeof(xds.T));\r\n\t\tn=re();m=re();\r\n\t\tfor(int i=1;i<=n;i++)\r\n\t\t{//\u5355\u70b9\u4fee\u6539\r\n\t\t\tint h=re(),w=re();\r\n\t\t\tinsert(1,1,1000,h,w);\r\n\t\t}\r\n\t\tfor(int i=1;i<=m;i++)\r\n\t\t{//\u533a\u95f4\u67e5\u8be2\uff0c\u8bb0\u5f97\u662f\u5f00\u533a\u95f4\r\n\t\t\tint hs=re(),ws=re(),hb=re(),wb=re();\r\n\t\t\twr(ask(1,1,1000,hs+1,hb-1,ws+1,wb-1)),putchar('\\n');\r\n\t\t}\r\n\t}\r\n\treturn 0;\r\n}\r\n```\r\n\r\n## \u540e\u8bb0\r\n\r\n\u5173\u4e8e\u6811\u5957\u6811\u7684\u535a\u5ba2\uff0c\u5c0f\u849f\u84bb\u8fd8\u6ca1\u5f00\u59cb\u5199\uff0c\u7b49\u5199\u5b8c\u4e4b\u540e\u518d\u6253\u5e7f\u544a\u5427\uff08\u96fe\u3002\r\n\r\n\u4eca\u5e74 NOIp \u4e4b\u540e\u5c31\u8981\u9000\u5f79\u4e86\uff0c\u591a\u5199\u70b9\u4e1c\u897f\u7eaa\u5ff5\u4e00\u4e0b\u6211\u6d3b\u5728\u8fc7\u8fd9\u4e2a\u4e16\u4e0a\u3002\r\n\r\n\u4eca\u5e74\u6b22\u7b11\u590d\u660e\u5e74\uff0c\u4e0d\u77e5\u9000\u5f79\u5728\u773c\u524d\u3002\r\n\r\n\u54ce\u3002",
        "postTime": 1662732692,
        "uid": 413020,
        "name": "Zvelig1205",
        "ccfLevel": 4,
        "title": "CF1722E Counting Rectangles \u9898\u89e3\u62a5\u544a"
    },
    {
        "content": "\u9898\u76ee\u5927\u610f\uff1a  \n\u6709 $n$ \u4e2a\u77e9\u5f62\uff0c\u7b2c $i$ \u4e2a\u77e9\u5f62\u7684\u9ad8\u5ea6\u4e3a $h_i$\uff0c\u5bbd\u5ea6\u4e3a $w_i$\u3002  \n\u6709 $q$ \u4e2a\u8be2\u95ee\uff0c\u6bcf\u4e00\u4e2a\u8be2\u95ee\u8868\u793a\u4e3a $h_s,w_s,h_b,w_b$\u3002  \n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8be2\u95ee\uff0c\u4f60\u9700\u8981\u8f93\u51fa\u6240\u6709\u6ee1\u8db3\u6761\u4ef6 $h_s<h_i<h_b$ \u548c $w_s<w_i<w_b$ \u7684\u77e9\u5f62\u9762\u79ef\u4e4b\u548c\u3002  \n\n\u89e3\u9898\u601d\u8def\uff1a  \n\u8d5b\u65f6\u6ca1\u6709\u6ce8\u610f\u5230\u6b64\u9898\u7ed9\u7684\u65f6\u95f4\u9650\u5236\u4e3a $6$ \u79d2\uff0c\u7528\u4e8c\u7ef4\u524d\u7f00\u548c\u53ef\u4ee5\u89e3\u51b3\uff0c\u5f53\u65f6\u76f4\u63a5\u60f3\u7740\u7528\u53ef\u6301\u4e45\u5316\u7ebf\u6bb5\u6811\u80fd\u505a\u3002\u9996\u5148\u5c06\u6240\u6709\u77e9\u5f62\u4ee5\u9ad8\u5ea6\u4e3a\u5173\u952e\u5b57\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u8fd9\u6837\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8be2\u95ee\u6211\u4eec\u53ef\u4ee5\u4e8c\u5206\u67e5\u627e\u51fa\u6ee1\u8db3 $h_s<h_i$ \u7684\u6700\u5c0f\u7684 $i$ \u8bb0\u4e3a $L$\uff0c\u6ee1\u8db3 $h_i<h_b$ \u7684\u6700\u5927\u7684 $i$ \u8bb0\u4e3a $R$\u3002\u6784\u9020 $n$ \u68f5\u6743\u503c\u7ebf\u6bb5\u6811\uff0c\u7b2c $j$ \u68f5\u6743\u503c\u7ebf\u6bb5\u6811\u8868\u793a\u524d $j$ \u4e2a\u77e9\u5f62\u4e2d\uff0c\u5728\u67d0\u4e2a\u5bbd\u5ea6\u533a\u95f4\u5185\u51fa\u73b0\u7684\u77e9\u5f62\u9762\u79ef\u4e4b\u548c\u662f\u591a\u5c11\u3002\u4e3a\u4e86\u6ee1\u8db3 $w_s<w_i<w_b$\uff0c\u67e5\u8be2\u6743\u503c\u7ebf\u6bb5\u6811\u7684\u5bbd\u5ea6\u533a\u95f4\u4e3a $[w_s+1,w_b-1]$\u3002\u6839\u636e\u524d\u7f00\u548c\u601d\u60f3\uff0c\u6bcf\u4e00\u4e2a\u8be2\u95ee\u7684\u7b54\u6848\u5c31\u662f\u7b2c $R$ \u68f5\u6743\u503c\u7ebf\u6bb5\u6811\u4e2d $[w_s+1,w_b-1]$ \u7684\u9762\u79ef\u548c\u51cf\u53bb\u7b2c $L-1$ \u68f5\u6743\u503c\u7ebf\u6bb5\u6811\u4e2d $[w_s+1,w_b-1]$ \u7684\u9762\u79ef\u548c\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\times \\log(n)+n\\times \\log(1000)+q\\times \\log(n)+q\\times \\log(1000))=O((n+q)\\times (\\log(n)+\\log(1000)))$\u3002  \n\n\u4ee3\u7801\uff1a  \n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nlong long read(){\n\tlong long x=0,sgn=1;char ch=getchar();\n\twhile(ch<'0' || ch>'9'){if(ch=='-')sgn=-1;ch=getchar();}\n\twhile(ch>='0' && ch<='9'){x=(x<<3)+(x<<1)+(ch&15);ch=getchar();}\n\treturn x*sgn;\n}\nvoid write(long long n,bool p){\n\tif(n<0){putchar('-');n=-n;}\n\tif(n==0){if(p)putchar('0');return;}\n\twrite(n/10,0);putchar(n%10+'0');\n}\n\nstruct node{\n\tlong long  h,w,s;\n}a[100010];\nbool cmp(node x,node y){\n\treturn x.h<y.h;\n}\nlong long t,n,q,l,r,mid,L,R,ans,Hs,Ws,Hb,Wb,tot,root[100010];\nlong long lson[4000010],rson[4000010],sum[4000010];\nlong long build(long long l,long long r){\n\ttot++;\n\tif(l==r)return tot;\n\tint save=tot;\n\tlson[save]=build(l,(l+r)/2);\n\trson[save]=build((l+r)/2+1,r);\n\tsum[save]=0;\n\treturn save;\n}\nlong long insert(long long i,long long l,long long r,long long now,long long f){\n\ttot++;\n\tint save=tot;\n\tlson[tot]=lson[i];\n\trson[tot]=rson[i];\n\tsum[tot]=sum[i]+f;\n\tif(l==r)return save;\n\tif(now<=(l+r)/2)\n\t\tlson[tot]=insert(lson[i],l,(l+r)/2,now,f);\n\telse\n\t\trson[tot]=insert(rson[i],(l+r)/2+1,r,now,f);\n\treturn save;\n}\nvoid ask(long long x,long long y,long long l,long long r,long long L,long long R){\n\tif(L<=r && R>=l){//\u6709\u4ea4\u96c6 \n\t\tif(L<=l && R>=r){//\u5b8c\u5168\u8986\u76d6 \n\t\t\tans+=sum[y]-sum[x];\n\t\t\treturn;\n\t\t}\n\t\task(lson[x],lson[y],l,(l+r)/2,L,R);\n\t\task(rson[x],rson[y],(l+r)/2+1,r,L,R);\n\t}\n\t\n}\nint main(){\n\tcin>>t;\n\twhile(t--){\n\t\tcin>>n>>q;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tcin>>a[i].h>>a[i].w;\n\t\t\ta[i].s=a[i].h*a[i].w;\n\t\t}\n\t\tsort(a+1,a+n+1,cmp);\n\t\tfor(int i=1;i<=tot;i++){\n\t\t\tlson[i]=0;\n\t\t\trson[i]=0;\n\t\t\tsum[i]=0;\n\t\t}\n\t\ttot=0;\n\t\troot[0]=build(1,1000);\n\t\tfor(int i=1;i<=n;i++)\n\t\t\troot[i]=insert(root[i-1],1,1000,a[i].w,a[i].s);\n\t\tfor(int i=1;i<=q;i++){\n\t\t\tcin>>Hs>>Ws>>Hb>>Wb;\n\t\t\tL=-1;\n\t\t\tR=-1;\n\t\t\tl=1;r=n;\n\t\t\twhile(l<=r){\n\t\t\t\tmid=(l+r)/2;\n\t\t\t\tif(a[mid].h<=Hs)l=mid+1;\n\t\t\t\telse{\n\t\t\t\t\tL=mid;\n\t\t\t\t\tr=mid-1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tl=1;r=n;\n\t\t\twhile(l<=r){\n\t\t\t\tmid=(l+r)/2;\n\t\t\t\tif(a[mid].h>=Hb)r=mid-1;\n\t\t\t\telse{\n\t\t\t\t\tR=mid;\n\t\t\t\t\tl=mid+1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(L==-1 || R==-1){//\u6839\u672c\u5c31\u585e\u4e0d\u8fdb\u53bb \n\t\t\t\tcout<<0<<endl;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tans=0;\n\t\t\task(root[L-1],root[R],1,1000,Ws+1,Wb-1);\n\t\t\tcout<<ans<<endl;\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1661992000,
        "uid": 19967,
        "name": "lihanwen12",
        "ccfLevel": 8,
        "title": "CF1722E Counting Rectangles\u9898\u89e3"
    },
    {
        "content": "### \u9898\u76ee\u63cf\u8ff0\n\n\u5206\u522b\u7ed9\u5b9a $n$ \u4e2a\u6b63\u6574\u6570 $h_i,w_i$\uff0c\u6709 $q$ \u6b21\u8be2\u95ee\u3002\n\n\u5bf9\u4e8e\u6bcf\u6b21\u8be2\u95ee\uff0c\u8f93\u5165\u56db\u4e2a\u6574\u6570 $h_s,w_s,h_b,w_b$\uff0c\u8f93\u51fa\u6ee1\u8db3 $h_i \\in (h_s,h_b),w_i\\in(w_s,w_b)$ \u7684 $\\sum h_i \\cdot w_i$ \u3002\n\n### \u601d\u8def\n\n\u4e0d\u96be\u60f3\u5230 $O(nq)$ \u7684\u66b4\u529b\uff0c\u6bcf\u6b21\u8be2\u95ee\u626b\u4e00\u904d\u7edf\u8ba1\u7b54\u6848\u3002\n\n\u8003\u8651\u600e\u4e48\u4f18\u5316\u3002\n\n\u6ce8\u610f\u5230 $h_i,w_i\u22641000$\uff0c\u53ef\u4ee5\u7528 $O(hw)$ \u9884\u5904\u7406\u51fa\u7684\u4e8c\u7ef4\u524d\u7f00\u548c\uff08\u524d\u7f00\u548c\u6570\u7ec4\u5b58\u7684\u662f $(1,1)$ \u5230 $(x,y)$ \u4e2d\uff0c\u6240\u6709\u7684 $h_i\\cdot w_i$ \u4e4b\u548c\uff09\uff0c\u7136\u540e\u6bcf\u6b21\u8be2\u95ee\u65f6 $O(1)$ \u51fa\u7b54\u6848\u3002\n\n### \u4ee3\u7801\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nint n,q;\nlong long juz[1005][1005];\nvoid solve(){\n\tmemset(juz,0,sizeof(juz));\n\tcin>>n>>q;\n\tfor(int i=1;i<=n;i++){\n\t\tint h,w;\n\t\tcin>>h>>w;\n\t\tjuz[h][w]+=h*w;\n\t}\n\tfor(int i=1;i<=1000;i++){\n\t\tfor(int j=1;j<=1000;j++){\n\t\t\tjuz[i][j]+=juz[i-1][j]+juz[i][j-1]-juz[i-1][j-1];\n\t\t}\n\t}\n\twhile(q--){\n\t\tint xs,ys,xb,yb;\n\t\tcin>>xs>>ys>>xb>>yb;\n\t\txs++;ys++;xb--;yb--;\n\t\tcout<<juz[xb][yb]-juz[xs-1][yb]-juz[xb][ys-1]+juz[xs-1][ys-1]<<endl;\n\t}\n}\n\nint main(){\n\tint t;\n\tcin>>t;\n\twhile(t--){\n\t    solve();\n\t}\n}\n\n```\n",
        "postTime": 1661951242,
        "uid": 503075,
        "name": "Lantrol",
        "ccfLevel": 4,
        "title": "\u3010\u9898\u89e3\u3011CF1722 E"
    },
    {
        "content": "# Part 1\uff1a\u524d\u8a00\n~~\u573a\u4e0a\u6570\u7ec4\u5f00\u5c0f\u4e86\u554a\u554a\u554a\u554a\u554a\uff0c\u4e3a\u5565\u4e0d\u62a5 RE \u554a\u554a\u554a\u554a\u554a\u554a~~\n\n\u56e0\u4e3a\u770b\u9898\u89e3\u90fd\u662f\u4e8c\u7ef4\u524d\u7f00\u548c\uff0c\u6240\u4ee5\u6765\u8865\u5145\u4e2a\u4e8c\u7ef4\u6570\u70b9\u3002\n\n# Part 2\uff1a\u6b63\u6587\n\n\u95ee\u9898\u53ef\u4ee5\u8f6c\u5316\u4e3a\u5728\u4e8c\u7ef4\u5e73\u9762\u4e0a\u6709 $n$ \u4e2a\u70b9\uff0c\u7b2c $i$ \u4e2a\u70b9\u7684\u5750\u6807\u4e3a $(h_i,w_i)$\uff0c\u6c42\u5728\u77e9\u5f62 $(h_s,w_s,h_b,w_b)$ \u4e2d\u70b9\u7684\u4e2a\u6570\uff08\u4e0d\u5305\u62ec\u8fb9\u7f18\uff09\u3002\n\n\u663e\u7136\u4e8c\u7ef4\u6570\u70b9\uff0c\u5bf9\u6a2a\u5750\u6807\u8fdb\u884c\u6392\u5e8f\uff0c\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u5bf9\u5e94\u7eb5\u5750\u6807\u4e0a\u70b9\u7684\u4e2a\u6570\uff0c\u679a\u4e3e\u6a2a\u5750\u6807\uff0c\u6bcf\u6b21\u626b\u5230\u70b9\u5c31\u5728\u5bf9\u5e94\u7eb5\u5750\u6807\u4f4d\u7f6e\u52a0 $1$\uff0c\u626b\u5230\u8be2\u95ee\u7684\u5de6\u7aef\u5c31\u5728\u7b54\u6848\u4e0a\u51cf\u53bb\u533a\u95f4 $(w_s,w_b)$ \u7684\u70b9\u7684\u4e2a\u6570\uff0c\u626b\u5230\u8be2\u95ee\u7684\u53f3\u7aef\u5c31\u5728\u7b54\u6848\u4e0a\u52a0\u4e0a\u533a\u95f4 $(w_s,w_b)$ \u7684\u70b9\u7684\u4e2a\u6570\uff0c\u601d\u60f3\u7c7b\u4f3c\u4e8e\u524d\u7f00\u548c\uff0c~~\u7531\u4e8e\u8fd9\u91cc\u4e0d\u662f\u626b\u63cf\u7ebf\u6a21\u677f\uff0c~~ \u4e0d\u8fc7\u591a\u8d58\u8ff0\uff0c\u4e0d\u61c2\u7684\u53ef\u4ee5\u53bb\u5b66\u4e60\u4e00\u4e0b\u3002\n\n\u8fd9\u91cc\u7b80\u5355\u63d0\u4e0b\u6211\u7684\u5b9e\u73b0\uff0c\u5728\u626b\u63cf\u65f6\uff0c\u6309\u7167 **\u8be2\u95ee\u53f3\u7aef\u70b9-\u70b9-\u8be2\u95ee\u5de6\u7aef\u70b9** \u7684\u987a\u5e8f\u8fdb\u884c\u5904\u7406\uff0c\u5c31\u53ef\u4ee5\u8fbe\u5230\u8be2\u95ee\u5f00\u533a\u95f4\u7684\u6548\u679c\uff0c\u8fd9\u70b9~~\u8bfb\u8005\u81ea\u8bc1\u4e0d\u96be~~\uff08\u771f\u7684\u5f88\u7b80\u5355\u554aqwq\uff09\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(q\\log V)$\uff0c\u5176\u4e2d $V$ \u662f $h$ \u7684\u503c\u57df\u3002\n\n# Part 3\uff1a\u4ee3\u7801\n```cpp\nbool DataS=1,FilE=0;\nint T;\nvoid init(){\n\treturn;\n}\nconst int N=1e3+7,M=1e5+7;\nstruct point{\n\tint h,w1,w2,id;\n}p[M<<2];\nbool cmp(point x,point y){\n\treturn x.h==y.h?x.id<y.id:x.h<y.h;\n}\nll arr[N];\nll ans[M];\nint n,q;\nvoid add(int x,int v){for(int i=x;i<=1000;i+=lowbit(i))arr[i]+=v;}\nll ask(int x){ll res=0;for(int i=x;i;i-=lowbit(i))res+=arr[i];return res;}\nll query(int l,int r){return ask(r-1)-ask(l);}\nsigned main(){\n\tif(FilE){\n\t\tfreopen(\"test.in\",\"r\",stdin);\n\t\tfreopen(\"test.out\",\"w\",stdout);\n\t}\n\tT=(DataS?read():1);\n\twhile(T--){\n\t\tinit();\n\t\tn=read();q=read();memset(arr,0,sizeof(arr));\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tp[i].h=read();p[i].w1=read();p[i].w2=0,p[i].id=0;\n\t\t}\n\t\tfor(int i=1;i<=q;i++){\n\t\t\tp[n+i].h=read(),\n\t\t\tp[n+i].w1=read();\n\t\t\tp[n+q+i].w1=p[n+i].w1;\n\t\t\tp[n+i].id=i;\n\t\t\tp[n+q+i].h=read(),\n\t\t\tp[n+q+i].w2=read();\n\t\t\tp[n+i].w2=p[n+q+i].w2;\n\t\t\tp[n+q+i].id=-i;\n\t\t}\n\t\tsort(p+1,p+2*q+n+1,cmp);\n\t\tfor(int i=1;i<=n+2*q;i++){\n\t\t\tif(p[i].id==0)add(p[i].w1,p[i].h*p[i].w1);\n\t\t\telse if(p[i].id>0){\n\t\t\t\tans[p[i].id]-=query(p[i].w1,p[i].w2);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tans[-p[i].id]+=query(p[i].w1,p[i].w2);\n\t\t\t}\n\t\t}\n\t\tfor(int i=1;i<=q;i++){\n\t\t\tprintf(\"%lld\\n\",ans[i]);ans[i]=0;\n\t\t}\n\t}\n\treturn 0;\n}\n```\n# Part 4\uff1a\u540e\u6587\n\u70b9\u8d5e\u518d\u8d70\u5427\uff08\u53ef\u601c",
        "postTime": 1662120666,
        "uid": 373699,
        "name": "EXODUS",
        "ccfLevel": 0,
        "title": "CF1722E\u9898\u89e3"
    },
    {
        "content": "**\u9898\u610f**  \n\u6bcf\u6b21\u7ed9\u5b9a $n$ \u4e2a\u70b9 $(x_i,y_i)$\uff0c\u5176\u6743\u503c\u4e3a $x_i\\times y_i$\uff0c\u5171\u6709 $q$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u7ed9\u51fa $x_s,y_s,x_t,y_t$\uff0c\u6c42\u5728\u5de6\u4e0a\u89d2\u9876\u70b9\u5750\u6807\u4e3a $(x_s+1,y_s+1)$\uff0c\u53f3\u4e0b\u89d2\u9876\u70b9\u5750\u6807\u4e3a $(x_t-1,y_t-1)$ \u7684\u77e9\u5f62\u4e2d\u6240\u6709\u70b9\u7684\u6743\u503c\u4e4b\u548c\u3002  \n**\u89e3\u6790**  \n\u975e\u5e38\u5178\u578b\u7684\u4e00\u4e2a\u4e8c\u7ef4\u524d\u7f00\u548c\u548c\u5dee\u5206\u6c42\u5e73\u9762\u4e0a\u4e00\u4e2a\u77e9\u5f62\u5185\u6743\u503c\u4e4b\u548c\u7684\u9898\u3002\n\n\u5e38\u7528\u516c\u5f0f\uff08\u516c\u5f0f\u5747\u7528\u4e8e\u6574\u70b9\u4e0a\u7684\u524d\u7f00\u548c\u548c\u5dee\u5206\uff09\uff1a\n- \u4e8c\u7ef4\u524d\u7f00\u548c\u901a\u7528\u516c\u5f0f:\n$$d_{ij}=d_{{i-1}j}+d_{i{j-1}}-d_{{i-1}{j-1}}+w_{ij}$$\n\u5176\u4e2d $w_{ij}$ \u8868\u793a\u70b9 $(i,j)$ \u4e0a\u7684\u6743\u503c\u3002\n- \u4e8c\u7ef4\u5dee\u5206\u901a\u7528\u516c\u5f0f\uff1a\n$$ans=d_{x_1y_1}-d_{x_1{y_0-1}}-d_{{x_0-1}y_1}+d_{{x_0-1}{y_0-1}}$$\n\u5176\u4e2d $(x_0,y_0)$ \u8868\u793a\u77e9\u5f62\u4e0a\u6a2a\u7eb5\u5750\u6807\u5747\u6700\u5c0f\u7684\u9876\u70b9\uff0c$(x_1,y_1)$ \u8868\u793a\u77e9\u5f62\u4e0a\u6a2a\u7eb5\u5750\u6807\u5747\u6700\u5927\u7684\u9876\u70b9\u3002  \n\u6ce8\uff1a\u8bb0\u5f97\u5f00`long long`\u3002  \n**Code**\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint n,q,d[1010][1010],t;\nsigned main(){\n    // freopen(\"1.out\",\"w\",stdout);\n    cin>>t;\n    while(t--){\n        cin>>n>>q;\n        for(int i=1;i<=1000;i++){\n            for(int j=1;j<=1000;j++){\n                d[i][j]=0;\n            }\n        }//\u867d\u7136\u8fd9\u9898memset\u5e76\u4e0d\u4f1a\u6709\u4ec0\u4e48\u4e8b\uff0c\u4f46\u6700\u597d\u4e0d\u8981\u7528\uff0c\u5c3d\u91cf\u624b\u52a8\u6e05\u96f6\n        int x,y;\n        for(int i=1;i<=n;i++){\n            cin>>x>>y;\n            d[x][y]+=x*y;//\u8bb0\u5f55\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u6743\u503c\u4e4b\u548c\n        }\n        for(int i=1;i<=1000;i++){\n            for(int j=1;j<=1000;j++){\n                d[i][j]=d[i][j]+d[i-1][j]+d[i][j-1]-d[i-1][j-1];\n            }\n        }//\u7edf\u8ba1\u524d\u7f00\u548c\n        int xs,xt,ys,yt;\n        while(q--){\n            cin>>xs>>ys>>xt>>yt;\n            cout<<d[xt-1][yt-1]-d[xt-1][ys]-d[xs][yt-1]+d[xs][ys]<<endl;//\u8ba1\u7b97\u77e9\u5f62\u5185\u6743\u503c\u7684\u5dee\u5206\u7ed3\u679c\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1662123106,
        "uid": 131610,
        "name": "luo_shen",
        "ccfLevel": 7,
        "title": "cf1722e\u9898\u89e3"
    },
    {
        "content": "### \u9898\u610f\u7b80\u8ff0\n\n\u7ed9\u51fa $n$ \u4e2a\u77e9\u9635\u7684\u957f $h_i$ \u548c\u5bbd $w_i$\u3002\u7136\u540e\u7ed9\u51fa $q$ \u7ec4\u8be2\u95ee\uff0c\u6bcf\u7ec4\u5305\u542b\u56db\u4e2a\u6b63\u6574\u6570 $h_s,w_s,h_b,w_b$\uff0c\u6c42 $\\sum h_i\\cdot w_i$\uff0c\u5176\u4e2d $h_s<h_i<h_b,w_s<w_i<w_b$\u3002\n\n### \u9898\u76ee\u5206\u6790\n\n\uff08\u4e0b\u6587\u4e2d\u6d89\u53ca\u6570\u5b66\u7b26\u53f7\u53ef\u80fd\u4f7f\u7528\u4e0d\u89c4\u8303\uff0c\u4f46\u610f\u5bf9\u5373\u53ef\u3002\uff09\n\n\u5c06 $h_s,w_s$ \u548c $h_b,w_b$ \u5206\u522b\u6784\u9020\u6210\u4e24\u4e2a\u77e9\u5f62 $S$ \u548c $B$\uff0c\u6839\u636e\u6570\u636e\u8303\u56f4\u53ef\u4ee5\u5f97\u51fa $S\\subseteq B$\uff0c\u6211\u4eec\u8981\u6c42\u7684\u662f\u6240\u6709\u6ee1\u8db3 $s\\subseteq I \\subseteq B$ \u7684\u77e9\u5f62 $I$ \u7684\u9762\u79ef\u603b\u548c\u3002\n\n\u663e\u7136\u66b4\u529b\u679a\u4e3e\u662f\u901a\u8fc7\u4e0d\u4e86\u7684\uff0c\u6211\u4eec\u8003\u8651\u5c06\u77e9\u5f62 $S,I,B$ \u7684\u5de6\u4e0a\u89d2\u5bf9\u9f50\u8fdb\u884c\u5206\u6790\u3002\n\n\u6211\u4eec\u8bbe $m_{i,j}$ \u8868\u793a\u70b9 $(0,0),(0,i),(0,j),(i,j)$ \u56db\u4e2a\u70b9\u6784\u6210\u7684\u77e9\u5f62\u533a\u57df\u4e2d\u771f\u5305\u542b\u7684\u6240\u6709\u77e9\u5f62\u9762\u79ef\u548c\u3002\n\n\uff08\u5728\u4e0b\u6587\u4e2d\u6211\u4eec\u4e3a\u4e66\u5199\u65b9\u4fbf\uff0c\u5c06\u4e0a\u4e00\u884c\u4e2d\u56db\u4e2a\u70b9\u7ec4\u6210\u7684\u77e9\u5f62\u8bb0\u4f5c $R_{i,j}$\uff0c\u4e0d\u89c4\u8303\u4f46\u80fd\u770b\u61c2\u5c31\u597d\u3002\uff09\n\n\u90a3\u4e48\u9996\u5148\u5c31\u80fd\u5728\u8f93\u5165\u65f6\u5c06 $m_{i,j}$ \u52a0\u4e0a\u76ee\u524d\u8f93\u5165\u7684\u77e9\u5f62\u9762\u79ef\u3002\uff08\u6ce8\u610f\u662f\u52a0\u4e0a\u800c\u4e0d\u662f\u8d4b\u503c\uff0c\u8981\u8003\u8651\u4e24\u4e2a\u5b8c\u5168\u76f8\u540c\u7684\u77e9\u5f62\u3002\uff09\n\n\u90a3\u4e48\u4fbf\u53ef\u4ee5\u7528 **\u4e8c\u7ef4\u524d\u7f00\u548c** \u7684\u65b9\u5f0f\u8fdb\u884c\u8ba1\u7b97\uff0c\u53ef\u5f97\u5982\u4e0b\u5f0f\u5b50\uff1a\n$$\nm'_{i,j}=m_{i,j}+m_{i-1,j}+m_{i,j-1}-m_{i-1,j-1}\n$$\n\u5176\u4e2d $m'$ \u8868\u793a $m_{i,j}$ \u65b0\u7684\u503c\uff0c\u5373\u7f16\u7a0b\u4e2d\u7684\u8d4b\u503c\u540e\u7684\u6570\u3002\n\n\u90a3\u4e48\u4e3a\u4ec0\u4e48\u8fd9\u4e2a\u5f0f\u5b50\u6210\u7acb\u5462\uff1f\n\n\u9996\u5148\u6211\u4eec\u77e5\u9053\uff0c\u82e5 $i>p,j>q$\uff0c\u90a3\u4e48 $R_{p,q}$ \u80fd\u88ab $R_{i,j}$ \u5b8c\u5168\u5305\u542b\uff08\u5373\u771f\u5305\u542b\uff09\uff0c\u90a3\u4e48 $R_{p,q}$ \u80fd\u5b8c\u5168\u5305\u542b\u7684\u77e9\u5f62 $R_{i,j}$ \u4e5f\u4e00\u5b9a\u80fd\u5305\u542b\uff0c\u6240\u4ee5 $m'_{i,j}=m_{i,j}+m_{i-1,j}+m_{i,j-1}$ \u4fbf\u660e\u786e\u4e86\u3002\n\n\u90a3\u4e48\u4e3a\u4ec0\u4e48\u8981\u51cf\u53bb $m_{i-1,j-1}$ \u5462\uff1f\n\n\u6211\u4eec\u53ef\u4ee5\u8fd9\u4e48\u60f3\uff0c\u5c06 $m_{p,q}$ \u5206\u6210 $R_{p-1,q}$ **\u5c31\u80fd** \u5305\u542b\u7684\u77e9\u5f62\u9762\u79ef \u4e0e \u6709\u4e86\u7b2c $p$ \u884c **\u624d\u80fd** \u5305\u542b\u7684\u77e9\u5f62\u9762\u79ef\u4e4b\u548c\u3002\u6211\u4eec\u5bb9\u6613\u53d1\u73b0\u8fd9\u4e24\u90e8\u5206\u662f\u4e0d\u76f8\u4ea4\u7684\u4e14\u8986\u76d6\u4e86\u6240\u6709\u60c5\u51b5\u3002\u540c\u6837\u5730\uff0c\u4e5f\u53ef\u5206\u6210 $R_{p,q-1}$ **\u5c31\u80fd** \u5305\u542b\u7684\u77e9\u5f62\u9762\u79ef \u4e0e \u6709\u4e86\u7b2c $q$ \u5217 **\u624d\u80fd** \u5305\u542b\u7684\u77e9\u5f62\u9762\u79ef\u4e4b\u548c\u3002\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u5c06 $m_{i-1,j}$ \u548c $m_{i,j-1}$ \u90fd\u5982\u6b64\u5206\u89e3\uff0c\u4f1a\u53d1\u73b0\u91cd\u5408\u90e8\u5206 $m_{i-1,j-1}$ \u6240\u4ee5\u4fbf\u53ef\u4ee5\u51cf\u53bb\u3002\u8fd9\u662f **\u5bb9\u65a5\u539f\u7406**\uff0c\u4e5f\u662f\u4e8c\u7ef4\u524d\u7f00\u548c\u5b9e\u73b0\u7684\u91cd\u8981\u57fa\u7840\uff0c\u8fd9\u6837\uff0c\u6211\u4eec\u4fbf\u53ea\u5269\u4e0b\u6700\u540e\u4e00\u90e8\u5206\u4e86\u3002\n\n\u5728\u4e0a\u9762\u7684\u63a8\u5bfc\u4e2d\uff0c\u6211\u4eec\u7684 $m_{i,j}$ \u59cb\u7ec8\u662f\u5305\u542b\u800c\u4e0d\u662f\u771f\u5305\u542b\uff08\u4e24\u8005\u7684\u5dee\u8ddd\u6211\u4eec\u6682\u4e14\u770b\u4f5c\u771f\u5305\u542b\u4e0d\u80fd\u8fb9\u754c\u91cd\u5408\uff09\u3002\u800c\u6839\u636e\u6570\u636e\u90fd\u662f\u6574\u6570\uff0c\u5e76\u4e14\u6211\u4eec\u6709\u6574\u6570\u96c6\u4e2d\u7684\u8fd9\u6837\u4e00\u4e2a\u5f0f\u5b50\uff1a\u82e5 $x,y\\in\\mathbb{Z},x<y$\uff0c\u5219 $x+1\\leq y$\u3002\n\n\u6240\u4ee5\u65e2\u7136 $m_{i,j}$ \u662f\u5305\u542b\uff0c\u90a3\u4e48 $m_{i-1,j-1}$ \u4e00\u5b9a\u662f $R_{i,j}$ \u7684\u771f\u5305\u542b\u3002\u7136\u800c\u8fd8\u6ca1\u7ed3\u675f\uff0c\u56e0\u4e3a\u6211\u4eec\u8fd8\u5f97\u89e3\u51b3\u4e00\u4e2a\u88ab\u5305\u542b\u7684\u5173\u7cfb\u3002\n\n\u4e5f\u4f7f\u7528\u5bb9\u65a5\uff0c\u6211\u4eec\u5c06\u73b0\u5728\u7684\u7b54\u6848\u51cf\u53bb\u80fd\u88ab $R_{h_s,w_s}$ **\u5305\u542b** \u7684\u77e9\u5f62\u9762\u79ef\uff08\u8fd9\u91cc\u56e0\u4e3a\u8fb9\u754c\u91cd\u5408\u4e0d\u80fd\u7b97\u8fdb\u7b54\u6848\uff0c\u4e8e\u662f\u53ef\u4ee5\u4e00\u8d77\u51cf\u53bb\uff09\u3002\n\n\u4f46\u4ed4\u7ec6\u60f3\u60f3\u8fd8\u4f1a\u53d1\u73b0\uff0c\u6709\u4e00\u90e8\u5206\u4e0d\u80fd\u88ab $R_{h_w,w_s}$ \u5305\u542b\u4f46\u8fd8\u5728\u7b54\u6848\u91cc\u3002\u8fd9\u662f\u4ec0\u4e48\uff1f\n\n\u5176\u5b9e\u662f\u56e0\u4e3a\u8fd9\u4e9b\u77e9\u5f62\u6709\u4e00\u6761\u8fb9\u548c $R_{h_s,w_s}$ \u5176\u4e2d\u4e00\u6761\u8fb9\u6240\u5728\u76f4\u7ebf\u91cd\u5408\uff0c\u4f46\u53e6\u4e00\u6761\u8fb9\u5374\u5f88\u957f\uff0c\u5c31\u4e0d\u80fd\u88ab $R_{h_s,w_s}$ \u5305\u542b\uff0c\u8fd9\u90e8\u5206\u6211\u4eec\u76f4\u63a5\u4ece\u4e0b\u9762\u7684\u5f0f\u5b50\u4e2d\u770b\uff1a\n$$\nans_{R_{h_s,w_s},R_{h_b,w_b}} = m_{h_b-1,w_b-1}-m_{h_s,w_b-1}-m_{h_b-1}{w_s}+m_{h_s,w_s}\n$$\n\n\n### \u4ee3\u7801\u5b9e\u73b0\n\n\u6ce8\u610f\u591a\u6d4b\uff0c\u8bb0\u5f97\u6e05\u7a7a $m$ \u6570\u7ec4\u3002\n\n\u4e0d\u5f00 ll \u89c1\u7956\u5b97\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nconst int N = 1e5;\nconst int M = 1000;\nusing namespace std;\nint t, n, q, h, w;\nll m[M + 5][M + 5], ans;\nint h1, w1, h2, w2;\nint main()\n{\n\tscanf(\"%d\", &t);\n\tfor(int z = 1; z <= t; z++)\n\t{\n\t\tmemset(m, 0, sizeof m);\n\t\tscanf(\"%d%d\", &n, &q);\n\t\tfor(int i = 1; i <= n; i++)\n\t\t{\n\t\t\tscanf(\"%d%d\", &h, &w);\n\t\t\tm[h][w] = m[h][w] + h * w;\n\t\t}\n\t\tfor(int i = 1; i <= M + 2; i++)\n\t\t{\n\t\t\tfor(int j = 1; j <= M + 2; j++)\n\t\t\t{\n\t\t\t\tm[i][j] = m[i][j] + m[i - 1][j] + m[i][j - 1] - m[i - 1][j - 1];\n\t\t\t}\n\t\t}\n\t\tfor(int i = 1; i <= q; i++)\n\t\t{\n\t\t\tscanf(\"%d%d%d%d\", &h1, &w1, &h2, &w2);\n\t\t\tans = m[h2 - 1][w2 - 1] - m[h1][w2 - 1] - m[h2 - 1][w1] + m[h1][w1];\n\t\t\tprintf(\"%lld\\n\", ans);\n\t\t}\n\t}\n    return 0;\n}\n```\n\n",
        "postTime": 1662121140,
        "uid": 530030,
        "name": "_ExistX_",
        "ccfLevel": 5,
        "title": "CF1722E Counting Rectangles"
    },
    {
        "content": "# CF1722E Counting Rectangles\n\n  [CF\u9898\u9762](http://codeforces.com/problemset/problem/1722/E)\n  \n  [\u6d1b\u8c37\u9898\u9762](https://www.luogu.com.cn/problem/CF1722E)\n\n  \u6709 $T$ \u7ec4\u6570\u636e\uff0c\u6bcf\u7ec4\u6570\u636e\u7ed9\u51fa $n$ \u4e2a\u77e9\u5f62\u4ee5\u53ca\u5b83\u4eec\u7684\u957f\u5bbd $h_i,w_i$\u3002\u6709 $q$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u8f93\u5165\u56db\u4e2a\u6570 $h_s,w_s,h_b,w_b$\uff08\u8fd9\u4e9b\u6570\u548c\u521a\u521a\u8f93\u5165\u7684\u77e9\u5f62**\u65e0\u5173**\uff09\uff0c\u8f93\u51fa\u6ee1\u8db3  \u7684\u77e9\u5f62\u9762\u79ef\u4e4b\u548c\u3002\n\n  \u6570\u636e\u8303\u56f4\uff1a$1\\leq T\\leq 100,1\\leq n,q\\leq 10^5,1\\leq h_i,w_i \\leq 1000,1\\leq h_s<h_b,w_s<w_b \\leq 1000$\n\n## \u601d\u8def\n\n  \u5bf9\u4e8e\u8be2\u95ee\uff0c\u6211\u4eec\u80af\u5b9a\u4e0d\u80fd\u66b4\u529b\u679a\u4e3e\u6bcf\u4e2a\u77e9\u5f62\uff0c\u5426\u5219\u65f6\u95f4\u590d\u6742\u5ea6 $O(qn)$ \u4f1a\u8d85\u65f6\u3002\u4ece\u53e6\u4e00\u4e2a\u89d2\u5ea6\u770b\uff0c\u7ed9\u51fa\u7684\u5750\u6807\u8303\u56f4\u4e3a $[1,1000]$\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a\u4e8c\u4f4d\u6570\u7ec4\u6765\u5b58\u50a8\u6bcf\u4e00\u4e2a\u77e9\u5f62\uff0c\u4e0b\u6807\u4ee3\u8868\u5750\u6807\uff0c\u503c\u4e3a\u9762\u79ef\u3002\u600e\u4e48\u624d\u80fd\u5feb\u901f\u7b97\u51fa\u6ee1\u8db3 $h_i \\in (h_s,h_w),w_i\\in (w_s,w_w)$ \u77e9\u5f62\u603b\u9762\u79ef\u5462\uff1f\n\n  \u901a\u8fc7**\u4e8c\u7ef4\u524d\u7f00\u548c**\u6216**\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4**\u6765\u89e3\u51b3\u672c\u9898\u3002\n\n## \u4ee3\u7801\n  \n  \u9898\u89e3\u90fd\u662f\u524d\u7f00\u548c\uff0c\u4e8e\u662f\u6211\u5199\u4e86\u4efd\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\u7684\n\n  ```cpp\n  #include<bits/stdc++.h>\n  using namespace std;\n  #define ll long long\n\n  const int M=1e3+9;\n  int T,n,q;\n  ll tr[M][M];\n  \n  int lowbit(int x){\n      return x&-x;\n  }\n  void add(int x,int y,ll d){//\u5728(x,y)\u5904\u52a0\u4e0a\u77e9\u5f62\u7684\u9762\u79ef\n      for(int i=x;i<=1e3;i+=lowbit(i)){\n          for(int j=y;j<=1e3;j+=lowbit(j)) tr[i][j]+=d;\n      }\n  }\n  ll sum(int x,int y){//\u6c42\u524d\u7f00\u548c\n      ll ans=0;\n      for(int i=x;i;i-=lowbit(i)){\n          for(int j=y;j;j-=lowbit(j)) ans+=tr[i][j];\n      }\n      return ans;\n  }\n  \n  int main(){\n      scanf(\"%d\",&T);\n      while(T--){\n          memset(tr,0,sizeof(tr));//\u8bb0\u5f97\u6e05\u7a7a\u6811\u72b6\u6570\u7ec4\n          scanf(\"%d%d\",&n,&q);\n         ll x,y;\n          for(int i=1;i<=n;i++){\n              scanf(\"%lld%lld\",&x,&y);\n              add(x,y,x*y);\n          }\n          int c,d,e,f;\n          while(q--){\n              scanf(\"%d%d%d%d\",&c,&d,&e,&f);\n              printf(\"%lld\\n\",sum(e-1,f-1)-sum(c,f-1)-sum(e-1,d)+sum(c,d));//\u6c42\u51fa\u533a\u95f4\u5185\u7684\u77e9\u5f62\u9762\u79ef\u603b\u548c\n          }\n      }\n      return 0;\n  }\n  ```",
        "postTime": 1662112972,
        "uid": 545327,
        "name": "\u5b64\u8292\u661f\u6cb3233",
        "ccfLevel": 4,
        "title": "\u300c\u9898\u89e3\u300dCF1722E Counting Rectangles"
    },
    {
        "content": "### \u9898\u76ee\u63cf\u8ff0\uff1a\n\n\u7ed9\u5b9a $n$ \u4e2a\u77e9\u5f62\uff0c\u6bcf\u4e2a\u77e9\u5f62\u6709\u957f $h_i$ , \u5bbd $w_i$ \uff0c$q$ \u7ec4\u8be2\u95ee\uff0c\u6bcf\u6b21\u7ed9\u5b9a $h_s,w_s,h_b,w_b$ \u6c42 $\\sum\\limits_{i=1}^n h_i\\times w_i\\times [h_s<h_i<h_b] \\times [w_s<w_i<w_b]$\u3002\n\n\u6570\u636e\u8303\u56f4 $n,q\\leq 10^5, h_i,w_i\\leq 10^3$\u3002\n\n### solution:\n\n\u89c2\u5bdf\u5230 $h,w$ \u7684\u8303\u56f4\u90fd\u5f88\u5c0f\uff0c\u8003\u8651\u4ee5\u6b64\u7740\u624b\uff0c\u6211\u4eec\u7528 $a_{i,j}$ \u8868\u793a $h=i,w=j$ \u7684\u77e9\u5f62\u7684\u9762\u79ef\uff0c\u4e0d\u96be\u53d1\u73b0\u6bcf\u6b21\u8be2\u95ee\u5373\u6c42 $\\sum\\limits_{i=h_s+1}^{h_b-1}\\sum\\limits_{j=w_s+1}^{w_b-1}a_{i,j}$\u3002\u8fd9\u6837\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\varTheta(n+qhw)$\uff0c\u65e0\u6cd5\u901a\u8fc7\u3002\n\n\u53ef\u4ee5\u53d1\u73b0\u6211\u4eec\u80fd\u5c06\u590d\u6742\u5ea6\u8f6c\u79fb\u5230\u9884\u5904\u7406\u4e0a\uff0c\u4ee5\u524d\u7f00\u548c\u7684\u601d\u60f3\uff0c\u6211\u4eec\u7528 $a_{i,j}$ \u8868\u793a $h=i,w\\leq j$ \u7684\u77e9\u5f62\u7684\u9762\u79ef\u548c\uff0c\u6bcf\u6b21\u8be2\u95ee\u5c31\u53d8\u6210\u6c42 $\\sum\\limits_{i=h_s+1}^{h_b-1}(a_{i,wb-1}-a_{i,ws})$\u3002 \u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\varTheta(nw+qh)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n### Code:\n```cpp\n#include <bits/stdc++.h>\n#define f(i,a,b) for(int i=a;i<=b;i++)\n#define g(i,a,b) for(int i=a;i>=b;i--)\n#define ll long long\n#define end() putchar('\\n')\nusing namespace std;\ninline int read(){\n    int x=0,f=1;\n    char ch=getchar();\n    while(ch<'0'||ch>'9'){if(ch=='-')f=0;ch=getchar();}\n    while(ch>='0'&&ch<='9'){x=(x<<1)+(x<<3)+(ch^48);ch=getchar();}\n    return f?x:-x;\n}\ninline void write(ll x,char end=' '){\n    static int k[31];\n    int f=0;\n    if(x<0)x=-x,putchar('-');\n    do{k[f++]=x%10,x/=10;}while(x);\n    while(f)putchar(k[--f]^'0');\n    putchar(end);\n}\nll T=read(),n,q,h[100010],w[100010];\nll a[1010][1010];\nint main(){\n\twhile(T--){\n\t\tmemset(a,0,sizeof(a));\n\t\tn=read(),q=read();\n\t\tf(i,1,n){\n\t\t\th[i]=read(),w[i]=read();\n\t\t\tf(j,w[i],1000)a[h[i]][j]+=h[i]*w[i];\n\t\t}\n\t\twhile(q--){\n\t\t\tll hs=read(),ws=read(),hb=read(),wb=read();\n\t\t\tll tot=0;\n\t\t\tf(i,hs+1,hb-1)tot+=a[i][wb-1]-a[i][ws];\n\t\t\twrite(tot,'\\n');\n\t\t}\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1661877772,
        "uid": 604479,
        "name": "zongSiLing",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF1722E"
    }
]
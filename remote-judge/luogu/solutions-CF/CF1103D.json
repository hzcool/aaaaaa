[
    {
        "content": "\u5f04\u4e86\u534a\u5929\uff0c\u7ec8\u4e8e\u641e\u51fa\u6765\u4e00\u4e2a\u590d\u6742\u5ea6\u6b63\u786e\u7684\u505a\u6cd5\u4e86\u3002\u8fd9\u4e2a\u9898\u60f3\u4fdd\u8bc1\u590d\u6742\u5ea6\u7684\u8bdd\uff0c\u5728\u5b9e\u73b0\u4e0a\u5927\u6982\u9700\u8981\u7cbe\u7ec6\u4e00\u4e9b\u3002\u8fd9\u7bc7\u9898\u89e3\u4f1a\u5c3d\u91cf\u8bb2\u6e05\u695a\u6bcf\u4e2a\u5730\u65b9\u7684\u5b9e\u73b0\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u6c42\u51fa\u6240\u6709$a_i$\u7684$gcd$\uff0c\u5047\u8bbe\u662f$g$\uff0c\u90a3\u4e48\u4e0d\u96be\u53d1\u73b0\u53ea\u6709$g$\u7684\u8d28\u56e0\u5b50\u662f\u6709\u7528\u7684\uff0c\u5176\u4f59\u7684\u56e0\u5b50\u90fd\u6ca1\u6709\u7528\u5904\u3002\n\n\u7531\u4e8e$g\\le 10^{12}$\uff0c\u6572\u4e00\u4e0b\u8ba1\u7b97\u5668\u5c31\u77e5\u9053\u5b83\u7684\u8d28\u56e0\u5b50\u6700\u591a\u6709$N=11$\u4e2a\u3002\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5bf9\u8fd9$11$\u4e2a\u56e0\u5b50\u8fdb\u884c\u72b6\u538b\uff0c\u4e8e\u662f\u5c31\u6709\u4e00\u4e2a\u663e\u7136\u7684$dp$\u601d\u8def\uff1a\n\n\u8bbe$dp_{i,cnt,S}$\u4ee3\u8868\u5bf9\u524d$i$\u4e2a\u6570\u4e2d\u7684$cnt$\u4e2a\u6570\u505a\u4e86\u9664\u6cd5\uff0c\u5df2\u7ecf\u6d88\u9664\u6389$S$\u8fd9\u4e2a\u96c6\u5408\u7684\u8d28\u6570\uff0c\u6b64\u65f6$e_i$\u548c\u7684\u6700\u5c0f\u503c\u662f\u591a\u5c11\u3002\u8fd9\u6837\u76f4\u63a5\u8f6c\u79fb\u5927\u6982\u662f$O(nN3^N)$\u7684\uff08$cnt$\u6700\u591a\u4e3a$N$\uff09\uff0c\u60f3\u60f3\u5c31\u89c9\u5f97\u4e0d\u5927\u80fd\u8fc7\u3002\n\n\u6211\u4eec\u5148\u8003\u8651\u4f18\u5316\u8fd9\u4e2a$n$,\u5982\u679c\u6211\u4eec\u5c06\u6bcf\u4e2a\u6570\u4e2d\u4e0d\u662f$gcd$\u8d28\u56e0\u5b50\u7684\u8d28\u56e0\u5b50\u90fd\u53bb\u6389\u7684\u8bdd\uff0c\u4e0d\u540c\u7684\u6570\u6700\u591a\u6709\u5927\u6982$12000$\u79cd\uff08\u5199\u4e2a\u66b4\u529b\u8dd1\u4e00\u4e0b\uff09\uff0c\u8bbe\u8fd9\u4e2a\u6570\u5b57\u4e3a$M$\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6bcf\u4e2a\u6570\u5b57\uff0c\u6211\u4eec\u53ea\u9700\u8981\u4fdd\u7559$N$\u4e2a$e_i$\u6700\u5c0f\u7684\u3002\u8fd9\u73a9\u610f\u53ef\u4ee5\u76f4\u63a5\u62ff\u4e2amap\u641e\u4e00\u641e\uff0c\u8fd9\u6837$n$\u5c31\u53ef\u4ee5\u4f18\u5316\u5230$NM$\u3002\u5904\u7406\u51fa\u8fd9\u90e8\u5206\u6570\u5b57\u7684\u590d\u6742\u5ea6\u5dee\u4e0d\u591a\u662f$n(N+\\log n)$\u7684\u3002\n\n\u6211\u4eec\u518d\u8003\u8651\u600e\u4e48\u4f18\u5316\u5269\u4e0b\u7684\u4e1c\u897f\uff0c\u6ce8\u610f\u5230\u5bf9\u4e8e\u6bcf\u4e2a$S$\uff0c\u6211\u4eec\u8003\u8651\u6240\u6709\u80fd\u6d88\u9664$S$\u8fd9\u4e2a\u96c6\u5408\u7684\u6570\uff0c\u540c\u6837\u53ea\u6709$e_i$\u6700\u5c0f\u7684\u90a3$N$\u4e2a\u6570\u662f\u6709\u7528\u7684\u3002\u5982\u679c\u6211\u4eec\u628a\u8fd9\u4e9b\u6570\u90fd\u62ff\u51fa\u6765\uff0c\u6211\u4eec\u53d1\u73b0\u53ea\u9700\u8981\u8fdb\u884c$O(2^NN)$\u6b21\u8f6c\u79fb\u3002\u5904\u7406\u8fd9\u4e9b\u6570\u8fd8\u662f\u6bd4\u8f83\u7b80\u5355\u7684\uff0c\u5904\u7406\u7684\u590d\u6742\u5ea6\u5927\u6982\u662f$O(NM2^N)$\u7684\u3002\n\n\u90a3\u4e48\u8f6c\u79fb\u600e\u4e48\u8f6c\u79fb\u5462\uff1f\u6211\u4eec\u5bf9\u4e8e\u4e0a\u9762\u5904\u7406\u51fa\u6765\u7684\u67d0\u4e2a$(i,S)$\uff08$i$\u4ee3\u8868\u7f16\u53f7\uff0c$S$\u4ee3\u8868\u80fd\u6d88\u9664\u7684\u8d28\u6570\u7684\u96c6\u5408\uff09\uff0c\u6211\u4eec\u679a\u4e3e$S$\u7684\u8865\u96c6\u7684\u5b50\u96c6$T$\u548c\u9009\u62e9\u7684\u6570\u5b57\u4e2a\u6570$cnt$\uff0c\u5c31\u53ef\u4ee5\u4ece$dp_{T,cnt}$\u8f6c\u79fb\u5230$dp_{S\\cup T,cnt+1}$\u3002\u8fd9\u6837\u679a\u4e3e\u6bcf\u4e2a\u8f6c\u79fb\u72b6\u6001$(i,S)$\u8865\u96c6\u7684\u5b50\u96c6\u603b\u590d\u6742\u5ea6\u4e3a$O(3^NN)$\uff0c\u518d\u52a0\u4e0a\u679a\u4e3e$cnt$\u7684\u590d\u6742\u5ea6\uff0c\u8fd9\u90e8\u5206\u590d\u6742\u5ea6\u4e3a$O(3^NN^2)$\n\n\u8fd9\u91cc\u8981\u6ce8\u610f\u4e00\u4e2a\u7ec6\u8282\uff0c\u6709\u53ef\u80fd\u5bf9\u4e8e\u51e0\u4e2a\u4e0d\u540c\u7684$S$\uff0c\u67d0\u4e2a$i$\u80fd\u591f\u6d88\u9664\u8fd9\u51e0\u4e2a\u96c6\u5408\uff0c\u4e14\u5bf9\u4e8e\u6bcf\u4e2a\u96c6\u5408\uff0c\u8fd9\u4e2a$i$\u90fd\u5728$e_i$\u524d$N$\u5c0f\u7684\u6570\u5f53\u4e2d\uff0c\u6b64\u65f6\u8fd9\u51e0\u79cd\u8f6c\u79fb\u6211\u4eec\u53ea\u80fd\u9009\u62e9\u4e00\u79cd\u3002\u8fd9\u6837\u5176\u5b9e\u4e5f\u4e0d\u96be\u5904\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e8e$i$\u76f8\u540c\u7684\u8f6c\u79fb\u653e\u5728\u4e00\u5757\u5904\u7406\uff0c\u8bb0\u5f55\u4e00\u4e2a$dp'_{S,T}$\u4ee3\u8868\u4f7f\u7528\u8fd9\u4e2a\u6570\u4e4b\u524d\u7684\u72b6\u6001\u3002\u8f6c\u79fb\u7684\u8bdd\u5c31\u94a6\u5b9a\u53ea\u80fd\u4ece$dp'$\u8f6c\u79fb\u5230$dp$\uff0c\u7b49\u5230\u5904\u7406\u5b8c\u8fd9\u4e2a\u6570\u7684\u6240\u6709\u53ef\u80fd\u8f6c\u79fb\u4e4b\u540e\u518d\u7528$dp_{S,T}$\u66f4\u65b0$dp'$\u3002\u8fd9\u91cc\u7684\u5b9e\u73b0\u53ef\u4ee5\u6ce8\u610f\u4e00\u4e0b\uff0c\u6211\u4eec\u5982\u679c\u76f4\u63a5\u6574\u4e2a\u590d\u5236\u7684\u8bdd\u590d\u6742\u5ea6\u4f1a\u9ad8\u4e00\u4e9b\uff08\u53ef\u80fd\u6700\u574f\u662f$O(N^24^N)$\uff1f\u53ef\u60dc\u6211\u4e0d\u4f1a\u9020\u6570\u636e\uff0c\u4e5f\u6709\u53ef\u80fd\u6839\u672c\u5361\u4e0d\u6ee1\uff09\uff0c\u800c\u4e8b\u5b9e\u4e0a\u6211\u4eec\u53ea\u9700\u8981\u5c06\u88ab\u66f4\u65b0\u8fc7\u7684\u90a3\u4e9b$dp$\u590d\u5236\u8fc7\u53bb\u5c31\u53ef\u4ee5\u4e86\uff0c\u8fd9\u6837dp\u90e8\u5206\u5c31\u53ef\u4ee5\u4fdd\u8bc1$O(3^NN^2)$\u7684\u590d\u6742\u5ea6\u3002\n\n\u4e8e\u662f\u8fd9\u9053\u9898\u5c31\u505a\u5b8c\u4e86\uff0c\u5177\u4f53\u600e\u4e48\u5b9e\u73b0\u53ef\u4ee5\u770b\u4e00\u4e0b\u4ee3\u7801\uff0c\u6211\u4f1a\u5c3d\u91cf\u52a0\u4e00\u4e9b\u6ce8\u91ca\u5e2e\u52a9\u7406\u89e3\u7684\u3002\n\n```cpp\n#include<iostream>\n#include<algorithm>\n#include<cstdio>\n#include<cstring>\n#include<vector>\n#include<map>\nusing namespace std;\nlong long gcd(long long a,long long b)\n{\n\treturn b==0?a:gcd(b,a%b);\n}\nint n;\nlong long k;\nint e[1000010];\nlong long a[1000010];\nbool cmp(int x,int y)\n{\n\treturn e[x]<e[y];\n}\n//mp\u7528\u6765\u5b58\u50a8\u6bcf\u4e2a\u672c\u8d28\u4e0d\u540c\u7684\u6570\u5b57\nmap<long long,vector<int> >mp;\n//vec\u7528\u6765\u5b58\u6bcf\u4e00\u79cd\u8f6c\u79fb\uff0c\u8fd9\u91cc\u5982\u679c\u76f4\u63a5\u6392\u5e8f\u7684\u8bdd\u53ef\u4ee5\u5c06$i$\u653e\u5230\u4e00\u8d77\u3002\nvector<pair<int,int> >vec;//(i,S)\n//\u8fd9\u91cc\u5c31\u662f\u5b58\u6bcf\u4e2aS\u5bf9\u5e94\u7684\u82b1\u8d39\u6700\u5c0f\u7684\u82e5\u5e72\u4e2a\u6570\u3002\nvector<int>vc[1<<12];\nint N;//\u8d28\u56e0\u5b50\u4e2a\u6570\nlong long d[13];\n//sum[S]\u7528\u6765\u5b58\u5bf9\u4e8e\u5f53\u524d\u7684x\uff0c\u8981\u60f3\u53bb\u6389S\u8fd9\u4e2a\u96c6\u5408\u7684\n//\u8d28\u56e0\u5b50\uff0c\u6700\u5c11\u9700\u8981\u9664\u4ee5\u591a\u5c11\nlong long sum[1<<12];\nvoid solve(long long x,vector<int> V)\n{\n\tsort(V.begin(),V.end(),cmp);\n\tint sz=min((int)V.size(),N);//\u6700\u591a\u53d6N\u4e2a\n\tsum[0]=1;\n\tfor(int i=0;i<N;i++)\n\t{\n\t\tlong long val=1;\n\t\twhile(x%d[i]==0)x/=d[i],val*=d[i];\n\t\tfor(int s=0;s<(1<<i);s++)\n\t\t\tsum[s|(1<<i)]=sum[s]*val;\n\t}\n\tfor(int s=1;s<(1<<N);s++)\n\t\tif(sum[s]<=k){\n\t\t\tfor(int i=0;i<sz;i++)\n\t\t\t\tvc[s].push_back(V[i]);\n\t\t}\n\treturn ;\n}\nconst long long INF=1e15;\n//state\u7528\u6765\u5b58\u6bcf\u4e2a\u88ab\u66f4\u65b0\u8fc7\u7684dp\u72b6\u6001\nvector<pair<int,int> >state;\n//\u5206\u522b\u662f\u4e0a\u9762\u63cf\u8ff0\u7684dp\u548cdp'\nlong long f[13][1<<12];\nlong long g[13][1<<12];\n//\u66f4\u65b0\u67d0\u4e2a\u72b6\u6001\nvoid upd(int i,int s,long long val)\n{\n\tif(val<f[i][s])\n\t{\n\t\tf[i][s]=val;\n\t\tstate.push_back(make_pair(i,s));\n\t}\n\treturn ;\n}\nint main()\n{\n\tscanf(\"%d %lld\",&n,&k);\n\tlong long G=0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%lld\",&a[i]);\n\t\tG=gcd(G,a[i]);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t\tscanf(\"%d\",&e[i]);\n\tif(G==1){\n\t\tprintf(\"0\\n\");\n\t\treturn 0;\n\t}\n\tfor(int i=2;1ll*i*i<=G;i++)\n\t\tif(G%i==0){\n\t\t\td[N++]=i;\n\t\t\twhile(G%i==0)G/=i;\n\t\t}\n\tif(G>1)d[N++]=G;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tlong long x=a[i],y=1;\n\t\tfor(int j=0;j<N;j++)\n\t\t\twhile(x%d[j]==0)x/=d[j],y*=d[j];\n\t\tmp[y].push_back(i);\n\t}\n\tfor(map<long long,vector<int> >::iterator\n\t\tit=mp.begin();it!=mp.end();it++)\n\t\t\tsolve(it->first,it->second);\n    //\u628aO(2^n*n)\u4e2a\u8f6c\u79fb\u90fd\u641e\u51fa\u6765\n\tfor(int s=0;s<(1<<N);s++)\n\t{\n\t\tsort(vc[s].begin(),vc[s].end(),cmp);\n\t\tint sz=min((int)vc[s].size(),N);\n\t\tfor(int i=0;i<sz;i++)\n\t\t\tvec.push_back(make_pair(vc[s][i],s));\n\t}\n\tsort(vec.begin(),vec.end());\n\tfor(int i=0;i<=N;i++)\n\t\tfor(int s=0;s<(1<<N);s++)\n\t\t\tf[i][s]=g[i][s]=INF;\n\tf[0][0]=g[0][0]=0;\n\tint lst=0;//\u4e0a\u4e00\u4e2aid\n\tfor(int i=0;i<vec.size();i++)\n\t{\n\t\tint id=vec[i].first;\n\t\tint s=vec[i].second;\n\t\tint cost=e[id];\n\t\tif(id!=lst)\n\t\t{\n        \t\t//\u53ea\u66f4\u65b0\u88ab\u66f4\u65b0\u8fc7\u7684f\n\t\t\tfor(int j=0;j<state.size();j++)\n\t\t\t{\n\t\t\t\tint x=state[j].first;\n\t\t\t\tint y=state[j].second;\n\t\t\t\tg[x][y]=f[x][y];\n\t\t\t}\n\t\t\tstate.clear();\n\t\t\tlst=id;\n\t\t}\n        //\u540e\u9762\u679a\u4e3e\u4e0d\u5230\u7a7a\u96c6\uff0c\u8fd9\u91cc\u5224\u4e86\u4e00\u4e0b\n\t\tupd(1,s,cost);\n\t\tint U=((1<<N)-1)^s;\n\t\tfor(int t=U;t;t=(t-1)&U)\n\t\t\tfor(int c=0;c<N;c++)\n\t\t\t\tupd(c+1,s|t,g[c][t]+cost);\n\t}\n    //\u7edf\u8ba1\u7b54\u6848\uff0c\u65e0\u9700\u591a\u8bb2\n\tlong long ans=INF;\n\tfor(int c=0;c<=N;c++)\n\t\tif(f[c][(1<<N)-1]<INF)\n\t\t\tans=min(ans,f[c][(1<<N)-1]*c);\n\tif(ans==INF)printf(\"-1\\n\");\n\telse printf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n\n~~\u7559\u4e2a\u8d5e\u518d\u8d70\u5457~~",
        "postTime": 1594183372,
        "uid": 54475,
        "name": "\u732a\u8111\u5b50",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1103D \u3010Professional layer\u3011"
    },
    {
        "content": "\u6709\u610f\u601d\u7684\u4e00\u9053\u9898\uff0c\u4f46\u9898\u89e3\u597d\u50cf\u8bf4\u7684\u90fd\u4e0d\u592a\u6e05\u695a\uff08\u7b2c\u4e00\u7bc7\u592a\u6df7\u4e71\u4e86\u770b\u4e0d\u61c2\n\n\u6211\u4e5f\u6765\u4e00\u7bc7\u8be6\u7ec6\u7684\uff01\n\n------------\n\n\u9996\u5148\u6211\u4eec\u5148\u5bf9\u6240\u6709\u6570\u6c42\u51fa\u4ed6\u4eec\u7684 Gcd\uff0c\u76ee\u6807\u662f\u6d88\u5b8c\u4ee5\u540e Gcd \u4e3a $1$\uff0c\u90a3\u4e48\u6211\u5c31\u5bf9\u7740\u73b0\u6709\u7684 Gcd \u91cc\u7684\u7d20\u6570\u6d88\u3002\n\n\u8003\u8651 Gcd \u7684\u5b9a\u4e49\u662f $\\prod p_i^{\\min_j c_{i,j}}$\uff0c\u5373\u5728\u6bcf\u4e2a\u8d28\u6570\u5728\u6240\u6709\u6570\u4e2d\u6700\u5c0f\u7684\u90a3\u4e2a\u6307\u6570\u5e42\u4e58\u8d77\u6765\uff0c\u5176\u4e2d $c_{i,j}$ \u8868\u793a $a_j$ \u91cc\u9762\u8d28\u6570 $p_i$ \u7684\u4e2a\u6570\u3002\n\n\u4e3a\u4e86\u4f7f\u5f97\u6700\u7ec8\u7684 Gcd \u4e3a $1$\uff0c\u540c\u65f6\u4e3a\u4e86\u6700\u4f18\u5316\u4ee3\u4ef7\uff0c\u6bcf\u4e2a\u8d28\u6570 $p_i$ \u80af\u5b9a\u90fd\u662f**\u53ea**\u627e\u4e00\u4e2a\u6570 $j$ \u628a $c_{i,j}$ \u6d88\u6210 $0$ \u7136\u540e\u5c31\u4e0d\u7ba1\u8fd9\u4e2a\u8d28\u6570\u4e86\u3002\n\n\u663e\u7136 $c_{i,j}$ \u6d88\u6210\u5176\u4ed6\u7684\u5f62\u5f0f\uff08\u6307\u4e0d\u662f\u4e0a\u8ff0\u6d88\u6cd5\uff09\u90fd\u662f\u4e0d\u4f18\u7684\u3002\n\n------------\n\n\u624b\u7b97\u4e00\u4e0b $10^{12}$ \u6700\u591a\u80fd\u5305\u542b $11$ \u4e2a\u8d28\u6570\uff08$2\\times 3\\times\\cdots\\times 31$\uff09\uff0c\u4ee4\u4e2a\u6570\u4e3a $m$\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe\u8ba1\u4e00\u4e2a $m\\times 2^m$ \u4e2a\u72b6\u6001\u7684 DP \u6765\u89e3\u51b3\u6b64\u95ee\u9898\u3002\n\n\u5373 $f_{i,j}$ \u8868\u793a\u9009\u51fa\u4e86 $i$ \u4e2a\u6570\uff0c\u6d88\u6389\u4e86 $j$ \u7684\u8d28\u6570\u96c6\u5408\uff08\u6ce8\u610f\u4e00\u4e2a\u6570\u662f\u53ef\u4ee5\u6d88\u6389\u591a\u4e2a\u8d28\u6570\u7684\uff09\u7684\u6700\u5c0f\u82b1\u8d39\u3002\n\n\u8fd9\u91cc\u6709\u4e2a\u5f88\u91cd\u8981\u7684\u4e00\u70b9\u662f\u6bcf\u6b21\u9009\u4e00\u4e2a\u6570\u5fc5\u5b9a\u6d88\u6389\u4e00\u4e2a\u65b0\u7684\u8d28\u6570\uff08\u5982\u7b2c\u4e00\u90e8\u5206\u6240\u53d9\u8ff0\uff09\uff0c\u6700\u540e\u81f3\u591a\u9009 $m$ \u4e2a\uff0c\u4e5f\u5373\u7b2c\u4e00\u7ef4\u53ea\u6709 $m$\uff0c\u540e\u9762\u6709\u7528\u5230\u90fd\u9ed8\u8ba4\u5df2\u77e5\u6653\u3002\n\n\u6bcf\u6b21\u8f6c\u79fb\u5c31\u8003\u8651\u4e00\u4e2a\u6570\uff0c\u679a\u4e3e\u5f53\u524d\u72b6\u6001\uff0c\u590d\u6742\u5ea6\u5df2\u8fbe $O(nm2^m)$\uff0c\u8f6c\u79fb\u662f\u679a\u4e3e\u4e00\u4e2a\u8d85\u96c6\u7136\u540e\u628a\u4e2d\u95f4\u8981\u586b\u7684\u8d28\u6570\u586b\u6389\uff0c\u590d\u6742\u5ea6 $O(nm3^m)$\u3002\n\n\u663e\u7136\u8fc7\u4e0d\u53bb\uff0c\u63a5\u4e0b\u6765\u5c31\u662f\u5f88\u795e\u7684\uff08\u662f\u6211\u592a\u83dc\u4e86\uff09\u51e0\u6b65\u51cf\u5c11\u72b6\u6001\u4ee5\u53ca\u8f6c\u79fb\u3002\n\n------------\n\n\u9996\u5148 $n$ \u4e2a\u6570\u5e94\u8be5\u6709\u5f88\u591a\u91cd\u590d\u7684\uff0c\u5c31\u662f\u8003\u8651\u8fd9 $m$ \u4e2a\u8d28\u6570\u6240\u6709\u7684\u6307\u6570\u5e42\u7ec4\u6210\u65b9\u5f0f\uff0c\u5373\u6240\u6709\u60c5\u51b5\u7684 $c_i>1$ \u4e2d $\\prod p_i^{c_i}$ \u6709\u591a\u5c11\u4e2a\u672c\u8d28\u4e0d\u540c\u7684\u3002\n\n\u8fd9\u4e2a\u73a9\u610f\u771f\u5f97\u7206\u641c\uff0c\u89e3\u91ca\u4e0d\u6e05\uff08\u6211\u53c8\u592a\u83dc\u4e86\uff09\uff0c\u636e\u8bf4\u641c\u51fa\u6765\u5c31\u662f $12000$ \u4e2a\uff0c\u4ee4\u4e3a $M$\u3002\n\n\u7531\u4e8e\u6211\u4eec\u53ea\u4f1a\u9009 $m$ \u4e2a\u6570\uff0c\u6240\u4ee5\u6bcf\u79cd\u6570\u90fd\u4fdd\u7559 $m$ \u4e2a\uff0c\u66f4\u5177\u4f53\u7684\uff0c\u6211\u4eec\u4fdd\u7559\u6700\u4fbf\u5b9c\u7684 $m$ \u4e2a\u3002\n\n\u6ce8\u610f\u4e00\u79cd\u6570\u662f\u6709\u591a\u79cd\u6d88\u8d28\u6570\u7684\u65b9\u6cd5\u7684\uff0c\u4e5f\u5c31\u662f\u4e00\u79cd\u6570\uff08\u524d\u63d0\u662f\u6709\u591a\u4e2a\uff09\u53ef\u4ee5\u7528\u4e0d\u540c\u7684\u4fee\u6539\u6765\u6d88\u6389\u591a\u79cd\u7684\u8d28\u6570\u3002\n\n\u6240\u4ee5\u6211\u4eec\u5c06 $n\\to M\\times m$\uff0c\u5927\u6982\u662f $10^6\\to 10^5$\uff0c\u7b97\u662f\u4f18\u5316\u4e86\u4e00\u4e2a\u7ea7\u522b\uff0c\u4f46\u5b83\u7684\u7528\u5904\u5e76\u4e0d\u5728\u4e8e\u6b64\u3002\n\n------------\n\n\u8fd9\u4e00\u6b65\u624d\u662f\u5173\u952e\u4f18\u5316\uff0c\u6211\u4eec\u8003\u8651 _\u98de\u8dc3\u5f0f\u7684_ \u51cf\u5c11\u8f6c\u79fb\uff0c\u56e0\u4e3a\u5c31\u7b97\u662f $nm3^m\\to Mm\\times m3^m$ \u4e5f\u6ca1\u4f18\u5316\u591a\u5c11\uff0c\u800c $m3^m$ \u7684\u74f6\u9888\u4e5f\u6709\u5f88\u5927\u7684\u5f71\u54cd\u3002\n\n\u518d\u6b21\u601d\u8003\u6211\u4eec\u7684\u72b6\u6001\uff0c\u53ea\u6709 $m2^m$ \u4e2a\uff0c\u679a\u4e3e\u8d85\u96c6\u7684\u90e8\u5206\u6ca1\u6cd5\u4f18\u5316\uff0c\u5927\u5934\u8fd8\u662f\u5728 $n$\uff08\u6216\u8005\u8bf4 $Mm$\uff09\u7684\u8f6c\u79fb\u4e0a\u3002\n\n\u66f4\u5177\u4f53\u7684\uff0c\u6211\u4eec\u8003\u8651\u5230\u6bcf\u6b21\u679a\u4e3e\u8d85\u96c6\u540e\u4e2d\u95f4\u586b\u8865\u7684\u90a3\u90e8\u5206\u8d28\u6570\u96c6\u5408\uff0c\u4ee4\u4e3a $S$\uff08\u8fd9\u73a9\u610f\u72b6\u6001\u6570\u663e\u7136 $2^m$\uff09\u3002\n\n _\u795e\u4ed9\u4e00\u6b65\uff08\u5173\u952e\u4e00\u62db\uff09\u8b66\u544a\uff1a_ \n\n\u53d1\u73b0\u5bf9\u4e8e $S$\uff0c\u56e0\u4e3a\u6700\u540e\u53ea\u4f1a\u9009 $m$ \u4e2a\uff0c**\u53ea\u6709\u6240\u6709\u7684 $S$ \u7684\u524d $m$ \u4e2a\u4e1c\u897f\u7684\u5e76\u96c6\u7684\u8fd9\u4e9b\u4e1c\u897f\u662f\u6709\u7528\u7684**\uff0c\u540c\u65f6\u4e00\u4e2a\u4e1c\u897f\u7684\u6709\u7528\u4f53\u73b0\u5728**\u53ea\u6709\u5b83\u51fa\u73b0\u5728\u8fd9\u4e2a $S$ \u7684\u524d $m$ \u4e2a\u4e2d\u624d\u53ef\u80fd\u8f6c\u79fb\u8fd9\u79cd $S$**\u3002\n\n\u6839\u636e\u8fd9\u4e00\u6b65\u6211\u4eec\u53ea\u641e\u8fd9\u4e9b\u8f6c\u79fb\uff0c\u590d\u6742\u5ea6\u4f18\u5316\u81f3 $O(m^23^m)$\uff0c\u76f8\u5f53\u4e8e\u76f4\u63a5\u628a $n/Mm\\to m$\u3002\n\n\u5982\u679c\u4f60\u611f\u89c9\u6709\u4ec0\u4e48\u6ca1\u8bf4\u5230\u7684\u5927\u6982\u7387\u662f**\u9ed1\u4f53\u5b57**\u6ca1\u8bfb\u6e05\u695a\uff0c\u53cd\u6b63\u90a3\u91cc\u7279\u522b\u5173\u952e\uff0c\u4f46~~\u6211\u5f88\u77ed~~\u53ef\u80fd\u88ab\u4f60\u5ffd\u7565\u4e86\uff0c\u591a\u770b\u51e0\u904d\u5982\u679c\u8fd8\u6709\u95ee\u9898\u518d\u6765\u95ee\u6211\u5427\uff08\n\n------------\n\n\u4f60\u53ef\u80fd\u7591\u60d1\u524d\u9762 $n\\to Mm$ \u8fd9\u4e00\u6b65\u6709\u4ec0\u4e48\u7528\uff0c\u5b9e\u9645\u4e0a\u662f\u540e\u9762\u8fd9\u4e00\u6b65 $S$ \u7684\u524d $m$ \u4e2a\u9700\u8981\u9884\u5904\u7406\uff0c\u800c\u76f4\u63a5\u7528 $n$ \u4e2a\u4e1c\u897f\u9884\u5904\u7406\u8fbe\u5230\u4e86 $n\\times 2^m\\times m$ \u5c31\u6302\u6389\u4e86\u3002\n\n\u6211\u4eec\u5148\u5904\u7406\u6210 $M$ \u79cd\u672c\u8d28\u4e0d\u540c\u7684\uff0c\u518d\u62ff\u53bb\u9884\u5904\u7406\u5c31\u53ea\u5269\u4e0b $M\\times 2^m\\times m$ \u4e86\uff0c\u6839\u636e\u5b9e\u73b0\u7684\u4e0d\u540c\u6216\u5904\u7406\u7684\u4e0d\u5f53\u53ef\u80fd\u51fa\u73b0 $M\\times 2^m\\times m^2$ \u6216\u8005\u662f $M\\times 2^m\\times m\\log$ \u7684\u4e1c\u897f\uff0c~~\u4f46\u7b14\u8005\u53ea\u4f1a\u53e3\u80e1\u5c31\u9ed8\u8ba4\u5927\u5bb6\u90fd\u4f1a\u7cbe\u7ec6\u5b9e\u73b0\u505a\u5230\u6700\u4f18\u590d\u6742\u5ea6\u4e86~~\n\n\u8fd9\u6837\u60f3\u6765\u6b64\u9898\u7684\u505a\u6cd5\u6bcf\u4e00\u6b65\u90fd\u5341\u5206\u7cbe\u5de7\uff0c\u603b\u590d\u6742\u5ea6\u4e3a $O(Mm2^m+m^23^m)$\u3002",
        "postTime": 1647656458,
        "uid": 158948,
        "name": "\u7ea6\u745f\u592b\u7528\u8111\u73a9",
        "ccfLevel": 0,
        "title": "CF1103D Professional layer"
    },
    {
        "content": "\u6211\u4eec\u4e0a\u624b\u80fd\u6709\u4e2a\u601d\u8def\uff1a\n\n\u5148\u6c42\u51fa\u6240\u6709$a_i$\u200b\u7684$gcd$\uff0c\u518d\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u5f97\u5230\u7684\u7d20\u6570\u4e2a\u6570$m$\u4e00\u5b9a\u6ee1\u8db3$m\\leq11$\u200b\u3002\n\n\u4e4b\u540e\u53ea\u9700\u8981\u5173\u6ce8\u8fd9\u4e9b\u7d20\u6570\u5373\u53ef\u3002\u82e5\u5bf9\u4e00\u4e2a\u6570\u8fdb\u884c\u64cd\u4f5c\uff0c\u4e00\u5b9a\u662f\u76f4\u63a5\u6d88\u9664\u67d0\u4e9b\u7d20\u6570\uff0c\u6240\u4ee5\u81f3\u591a\u9009$m\u200b$\u4e2a\u6570\u3002\n\n\u6240\u4ee5\u53ea\u8981\u6839\u636e$k$\u5904\u7406\u51fa\u6bcf\u4e2a\u6570\u53ef\u4ee5\u6d88\u9664\u7684\u7d20\u6570\u96c6\u5408\uff0c\u5c31\u5f97\u5230\u4e00\u4e2a$O(n*m*3^m)$\u200b\u7684$dp$\uff0c\u663e\u7136\u8fc7\u4e0d\u4e86\u7684\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8981\u5728\u8fd9\u4e2a\u57fa\u7840\u4e0a\u8fdb\u884c\u526a\u679d\u3002\n\n\u526a\u679d\uff1a\n\n\u5c06\u4e0d\u662f\u76ee\u6807\u7d20\u6570\u7684\u7d20\u6570\u5168\u9664\u6389\u5f97\u5230\u4e00\u7ec4\u65b0\u7684$a_i$\uff0c\u7136\u540e\u628a\u76f8\u540c$a_i$\u538b\u7f29\u8d77\u6765\uff0c\u5bf9\u5e94\u7684\u6240\u6709$c_i$\u53ea\u4fdd\u7559\u6700\u4fbf\u5b9c\u7684$m$\u4e2a\uff0c\u90a3\u4e48\u81f3\u591a\u53ea\u5269\u4e0b$O(M \u2217 m)$\u4e2a\u7269\u54c1\uff08\u4e0d\u540c\u7684 $a_i$\u53ea\u6709$M$\u4e2a\uff09\u3002\n\n$M$\u53d6\u6700\u5927\u65f6\uff0c\u4e00\u5b9a\u662f\u53d6\u6700\u5c0f\u7684$m$\u4e2a\u7d20\u6570\uff0c\u56e0\u4e3a\n$a_i\\leq10^{12}$ ,\u53ef\u4ee5\u901a\u8fc7\u7a0b\u5e8f\u66b4\u529b\u5f97\u5230\uff1a$M<12000$\n\n$O(M*m^2*3^m)$ \u4ecd\u7136\u4e0d\u80fd\u63a5\u53d7\n\n\u56e0\u4e3a\u6700\u7ec8\u81f3\u591a\u53ea\u9009$m$\u4e2a\uff0c\u5927\u90e8\u5206\u88ab\u9009\u4e2d\u7684\u673a\u4f1a\u5f88\u5c11\u751a\u81f3\u6839\u672c\u4e0d\u4f1a\u88ab\u9009\uff0c\u8fd9\u7531\u5b83\u4eec\u6bcf\u4e2a\u7ba1\u8f96\u7684\u7d20\u6570\u96c6\u5408\u548c\u82b1\u8d39\u6709\u5173\u3002\u53ef\u4ee5\u9884\u5904\u7406$ok[S]$\u8868\u793a\u7d20\u6570\u96c6\u5408\u4e3a$S$\u65f6\u90a3\u4e9b\u6570\u53ef\u80fd\u88ab\u9009\uff0c\u800c\u5bf9\u4e8e\u6bcf\u4e2a$S$\uff0c\u81f3\u591a\u5b58\u50a8$m$\u4e2a\u6700\u4fbf\u5b9c\u7684\u6570\u5373\u53ef\u3002\u7136\u540e\u6309\u6570\u5b57\u987a\u5e8f\u505a$dp$\u3002\n\n\u9884\u5904\u7406$ok[S]$ \uff0c\u6b64\u5904\u590d\u6742\u5ea6\u662f $O(M*2^m*m^2)$\n\n\u8fd9\u6837\u6240\u6709\u7684\u8f6c\u79fb\u65b9\u5411\u81f3\u591a\u53ea\u6709$O(m * 2^m)$ \uff0c\u518d\u679a\u4e3e\u5f53\u524d\u9009\u4e86\u51e0\u4e2a\u6570\uff0c\u603b\u7684\u8f6c\u79fb\u590d\u6742\u5ea6\u662f $O(m^2* 3^m)$\n\n```cpp\n#define B cout << \"BreakPoint\" << endl;\n#define O(x) cout << #x << \" \" << x << endl;\n#define O_(x) cout << #x << \" \" << x << \" \";\n#define Msz(x) cout << \"Sizeof \" << #x << \" \" << sizeof(x)/1024/1024 << \" MB\" << endl;\n#include<cstdio>\n#include<cmath>\n#include<iostream>\n#include<cstring>\n#include<algorithm>\n#include<queue>\n#include<map>\n#define fr first\n#define sc second\n#define LL long long\nusing namespace std;\ninline LL read() {\n\tLL s = 0,w = 1;\n\tchar ch = getchar();\n\twhile(ch < '0' || ch > '9') {\n\t\tif(ch == '-')\n\t\t\tw = -1;\n\t\tch = getchar();\n\t}\n\twhile(ch >= '0' && ch <= '9') {\n\t\ts = s * 10 + ch - '0';\n\t\tch = getchar();\n\t}\n\treturn s * w;\n}\nLL gcd(LL a,LL b){return b ? gcd(b,a % b) : a;}\n#define st first\n#define nd second\n#define pb push_back\nconst int N = 1e6 + 7;\nstruct node{\n    LL a,w;\n    bool operator <(const node a)const{return w < a.w;}\n}c[N];\nvector<LL>ok;\nLL n,m,K,res,f[12][1 << 11],g[1 << 11];\nmap<LL,vector<LL>>mp;\nvoid init(){\n\tn = read(),K = read();\n    for(int i = 1;i <= n;i++){\n        c[i].a = read();\n        res = gcd(res,c[i].a);\n    }\n    for(int i = 1;i <= n;i++) c[i].w = read();\n    if(res == 1) puts(\"0\"),exit(0);\n    for(int i = 2;i <= 1e6 && 1ll * i * i <= res;i++)\n        if(res % i == 0) {\n\t\t\tok.pb(i);\n\t\t\twhile(res % i == 0) res /= i;\n\t\t}\n    if(res - 1) ok.pb(res);\n    m = ok.size();\n    for(int i = 1;i <= n;i++){\n        LL z = 1;\n        for(auto j : ok) while(c[i].a % j == 0) c[i].a /= j,z *= j;\n        mp[z].pb(c[i].w);\n    }\n}\nvoid solve(){\n\tmemset(f,2,sizeof(f));\n    f[0][0] = 0;\n    for(auto t : mp){\n        LL x = t.st;\n        sort(t.nd.begin(),t.nd.end());\n        if(t.nd.size() > m) t.nd.resize(m);\n        vector<LL>a;\n        for(int i = 0;i < 1<<m;i++){\n            LL times = 1 , p = x;\n            for(int j = 0;j < m;j++)\n                if(i & (1 << j)) while(p % ok[j] == 0) p /= ok[j],times *= ok[j];\n            a.pb(times);\n        }\n        for(auto p : t.nd){\n            bool flg = 0;\n            for(int i = m - 1;i >= 0;i--)\n                for(int j = 0;j < 1 << m;j++)\n                    if(f[i][j] <= 1e12){\n                        int tmp = (1 << m) - 1 - j;\n                        for(int k = tmp;k;k = (k - 1) & tmp)\n                            if(a[k] <= K) if(f[i + 1][j | k] > f[i][j] + p) f[i + 1][j | k] = f[i][j] + p,flg = 1;\n                    }\n            if(!flg) break;\n        }\n    }\n    LL ans = 1e18;\n    for(int i = 1;i <= m;i++) ans = min(ans,f[i][(1 << m) - 1] * i);\n    if(ans > 1e12) puts(\"-1\");\n    else printf(\"%lld\\n\",ans);\n}\nint main(){\n    init();\n    solve();\n    return 0;\n}\n```",
        "postTime": 1586097266,
        "uid": 160811,
        "name": "\u4f18\u79c0\u7684\u6e23\u6e23\u79b9",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF1103D \u3010Professional layer\u3011"
    },
    {
        "content": "[\u5b89\u5229\u4e00\u6ce2\u535a\u5ba2](https://foreverlasting1202.github.io/)\n\nD Professional layer\n\n\u9898\u9762\uff1a\u7ed9\u51fa$n$\u4e2a\u70b9\u548c$k$\uff0c\u6bcf\u4e2a\u70b9\u6709\u4e00\u4e2a\u6743\u503c$a$\u548c\u9644\u52a0\u503c$e$\u3002\u73b0\u5728\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\u53ef\u4ee5\u8ba9\u5b83\u7684\u6743\u503c\u9664\u4ee5\u5b83\u81ea\u5df1\u4e00\u4e2a\u4e0d\u8d85\u8fc7$k$\u7684\u7ea6\u6570\uff0c\u8981\u6c42\u4ece$n$\u4e2a\u6570\u4e2d\u9009\u62e9\u82e5\u5e72\u4e2a\u6570\u51fa\u6765\uff0c\u4f7f\u5f97\u5b83\u4eec\u7684\u6743\u503c\u5728\u9664\u4ee5\u7ea6\u6570\u8fc7\u540e\u7684$gcd$\u4e3a1\uff0c\u82b1\u8d39\u7684\u4ee3\u4ef7\u662f\u9009\u51fa\u6765\u7684\u9009\u62e9\u6570\u7684\u4e2a\u6570\u4e58\u4e0a\u9009\u51fa\u6765\u7684\u6240\u6709\u6570\u7684\u9644\u52a0\u503c\u4e4b\u548c\uff0c\u6c42\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n$a$\u5c0f\u4e8e\u7b49\u4e8e1e12,$n$\u5c0f\u4e8e\u7b49\u4e8e1e6\n\n\u505a\u6cd5\uff1a\u795e\u4ed9\u9898\uff0c\u60f3\u4e86\u8d85\u7ea7\u4e45\u4e5f\u89c9\u5f97\u590d\u6742\u5ea6\u4e0d\u5bf9\uff0c\u540e\u6765\u770b\u4e86\u9898\u89e3\u624d\u53d1\u73b0\u6709\u4e00\u4e9b\u795e\u5947\u7684\u7f29\u5c0f\u6570\u636e\u8303\u56f4\u7684\u529e\u6cd5\u3002\n\n\u9996\u5148\u8003\u8651\u5230\u6240\u6709\u6570\u7684gcd\u4e00\u5b9a\u5c0f\u4e8e1e12\uff0c\u6240\u4ee5\u53ea\u6709\u4e0d\u8d85\u8fc712\u4e2a\u7684\u4e0d\u540c\u8d28\u56e0\u6570\u3002\u7136\u540e\u8003\u8651\u72b6\u538b$dp$\uff0c$f[i][S]$\u8868\u793a\u9009\u4e86$i$\u4e2a\u6570\uff0c\u8d28\u56e0\u6570\u96c6\u5408\u4e3a$S$\u7684\u65b9\u6848\uff08\u8fd9\u662f\u56e0\u4e3a\u5bf9\u4e8e\u9009\u51fa\u6765\u7684\u6570\u800c\u8a00\uff0c\u4ed6\u4eec\u53ea\u7528\u5c06\u81ea\u8eab\u7684\u67d0\u4e00\u4e2a\u8d28\u56e0\u6570\u5168\u90e8\u9664\u6389\u5c31\u53ef\u4ee5\u4e86\uff0c\u6240\u4ee5\u6700\u591a12\u4e2a\uff09\u3002\n\n\u7136\u540e\u5462\uff0c\u6211\u5c31\u4e0d\u4f1a\u4e86\u3002\u8fd9\u91cc\u76f4\u63a5\u8f6c\u79fb\u7684\u590d\u6742\u5ea6\u5e94\u8be5\u662f$O(n\\ast 2^{12}\\ast 12)$\uff0c\u8fd9\u663e\u7136\u662f\u8fc7\u4e0d\u4e86\u7684\u3002\n\n\u600e\u4e48\u529e\u5462\uff0c\u9898\u89e3\u8bc1\u660e\u4e86\u6700\u591a\u53ea\u670912000\u4e2a\u6570\u662f\u6709\u7528\u7684\uff08\u8fd9\u5176\u5b9e\u633a\u663e\u7136\u7684\uff0c\u611f\u89c9\u4e00\u4e0b\u5c31\u597d\u4e86\uff09\uff0c\u4e8e\u662f\u526a\u526a\u679d\uff0c\u53bb\u6389\u4e00\u4e9b\u65e0\u7528\u7684\u60c5\u51b5\u5c31\u80fd\u8fc7\u4e86\u3002\n\n\u611f\u89c9\u6211\u7684\u590d\u6742\u5ea6\u597d\u50cf\u548c\u9898\u89e3\u7684\u590d\u6742\u5ea6\u4e0d\u4e00\u6837\uff0c\u6211\u7684\u590d\u6742\u5ea6\u662f\u4e0d\u662fO(\u7384\u5b66)\u554a\uff01\n\ncode:\n```cpp\n//2019.1.26 by ljz\n#include<bits/stdc++.h>\nusing namespace std;\n#define res register int\n#define LL long long\n#define inf 0x3f3f3f3f3f3f3f\n#define eps 1e-10\ninline int read() {\n    res s=0;\n    bool w=0;\n    char ch=getchar();\n    while(ch<'0'||ch>'9') {\n        if(ch=='-')w=1;\n        ch=getchar();\n    }\n    while(ch>='0'&&ch<='9')s=s*10+ch-'0',ch=getchar();\n    return w?-s:s;\n}\ninline void _swap(res &x,res &y) {\n    x^=y^=x^=y;\n}\ninline int _abs(const res &x) {\n    return x>0?x:-x;\n}\ninline int _max(const res &x,const res &y) {\n    return x>y?x:y;\n}\ninline int _min(const res &x,const res &y) {\n    return x<y?x:y;\n}\nconst int N=1e6+10;\nnamespace MAIN {\n    int n;\n    LL k;\n    inline LL gcd(LL x,LL y){\n        while(y){\n            LL t=x;\n            x=y,y=t%y;\n        }\n        return x;\n    }\n    LL GCD;\n    struct P{\n        LL a;\n        int e;\n        inline bool operator < (const P &b) const {\n            return e<b.e;\n        }\n    }p[N];\n    LL f[12][1<<11],g[12][1<<11];\n    int f1[(1<<13)+10];\n    LL prim[13+10],gx[13+10],part[(1<<13)+10];\n    int tot;\n    LL ans=inf;\n//    const int KCZ=19260817;\n//    struct Hash{\n//        int head[KCZ+10];\n//        struct ED{\n//            int next,to,val;\n//            ED() {}\n//            ED(res next,res to):next(next),to(to) {}\n//        }ed[N];\n//        int Cnt;\n//        inline void add(const res &u,const LL &v){\n//            ed[++Cnt]=ED(head[u],v),head[u]=Cnt;\n//        }\n//        inline bool count(const LL &S){\n//            for(res i=head[S%KCZ];i;i=ed[i].next)\n//                if(ed[i].to==S)return 1;\n//            return 0;\n//        }\n//        inline int &operator [] (const LL &S){\n//            for(res i=head[S%KCZ];i;i=ed[i].next)\n//                if(ed[i].to==S)return ed[i].val;\n//            add(S%KCZ,S);\n//            return ed[Cnt].val;\n//        }\n//    }f2;\n    unordered_map<LL,int> f2;\n    inline void MAIN(){\n        n=read(),scanf(\"%lld\",&k);\n        for(res i=1;i<=n;i++)scanf(\"%lld\",&p[i].a),GCD=gcd(p[i].a,GCD);\n        for(res i=1;i<=n;i++)p[i].e=read();\n        if(GCD==1){puts(\"0\");return;}\n        sort(p+1,p+n+1);\n        for(res i=2;1LL*i*i<=GCD;i++){\n            if(GCD%i==0){\n                prim[++tot]=i;\n                while(GCD%i==0)GCD/=i;\n            }\n        }\n        if(GCD>1)prim[++tot]=GCD;\n        for(res i=0;i<=tot;i++)\n            for(res j=0;j<(1<<tot);j++)f[i][j]=(j==0)?0:inf;\n        for(res i=1;i<=n;i++){\n            LL nw=1;\n            for(res j=1;j<=tot;j++){\n                gx[j]=1;\n                while(p[i].a%prim[j]==0)nw*=prim[j],gx[j]*=prim[j],p[i].a/=prim[j];\n            }\n            if(f2[nw]>=tot)continue;\n            f2[nw]++;\n            memcpy(g,f,sizeof(g));\n            part[0]=1;\n            for(res s=0;s<tot;s++){\n                for(res S=0;S<1<<s;S++){\n                    part[S|(1<<s)]=part[S]*gx[s+1];\n                    if(part[S|(1<<s)]>k||f1[S|(1<<s)]>=tot)continue;\n                    f1[S|(1<<s)]++;\n                    for(res l=0;l<tot;l++)\n                        for(res SS=0;SS<(1<<tot);SS++)f[l+1][S|SS|(1<<s)]=min(f[l+1][S|SS|(1<<s)],g[l][SS]+p[i].e);\n\n                }\n            }\n        }\n        for(res i=1;i<=tot;i++)ans=min(ans,1LL*f[i][(1<<tot)-1]*i);\n        printf(\"%lld\\n\",ans==inf?-1:ans);\n    }\n}\nint main() {\n    MAIN::MAIN();\n    return 0;\n}\n```",
        "postTime": 1548545748,
        "uid": 32878,
        "name": "foreverlasting",
        "ccfLevel": 7,
        "title": "\u3010CF1103D\u3011Professional layer"
    },
    {
        "content": "**CF1103D**\n\n\u96be\u70b9\u5728\u4e8e\u6253\u8868\u3002\n\n\u8bbe\u6240\u6709 $a_i$ \u7684\u8d28\u56e0\u6570\u5206\u89e3\u7ed3\u679c\u53ea\u4fdd\u7559\u4e0e $\\gcd$ \u8d28\u56e0\u6570\u5206\u89e3\u5f97\u5230\u7684\u5e42\u7ea7\u6570\u96c6\u5408\u4ea4\uff0c\u6682\u4e14\u79f0\u4e3a $a_i$ \u5173\u4e8e $\\gcd$ \u7684\u8d28\u56e0\u6570\u5206\u89e3\uff0c\u4ee5\u6b64\u4f5c\u4e3a\u7b49\u4ef7\u7c7b\u5212\u5206\uff0c\u8bbe $\\gcd$ \u8d28\u56e0\u6570\u5206\u89e3\u7ed3\u679c\u5b58\u5728 $k$ \u4e2a\u8d28\u6570\u3002\n \n\u4e00\u4e2a\u4e00\u773c\u7684\u8d2a\u5fc3\uff1a\u9009\u4e86\u4e00\u4e2a\u6570\u4e00\u5b9a\u8981\u6d88\u6389\u81f3\u5c11\u4e00\u4e2a\u8d28\u6570\u3002\u6240\u4ee5\u603b\u7684\u9009\u62e9\u7684\u6570\u7684\u4e2a\u6570\u81f3\u591a\u4e3a $m$ \u4e2a\uff0c\u76f4\u63a5\u8bbe $dp_{i,S}$ \u8868\u793a\u9009\u62e9\u4e86 $i$ \u4e2a\u6570\u6d88\u6389\u7684\u8d28\u56e0\u6570\u96c6\u5408\u4e3a $S$ \u7684\u6700\u5c0f\u82b1\u8d39\u3002\n\n\u6700\u66b4\u529b\u7684\u8f6c\u79fb\uff1a\u76f4\u63a5\u679a\u4e3e\u9009\u6bcf\u4e2a\u6570\u548c\u8fd9\u4e2a\u6570\u6d88\u6389\u7684\u8d28\u56e0\u6570\u96c6\u5408\u3002\u4e00\u4e2a\u5f88 naive \u7684\u526a\u679d\u662f\u53d1\u73b0\u5bf9\u4e8e\u6bcf\u4e2a\u7b49\u4ef7\u7c7b\u53ea\u7528\u4fdd\u7559\u524d $m$ \u5c0f\u7684\u6570\u5373\u53ef\u3002\n\n\u7136\u540e\u4f60\u53d1\u73b0\u4f60\u73b0\u5728\u7684\u8f6c\u79fb\u5f88\u5de8\u5927\u591a\u6050\u6016\uff0c\u4e8e\u662f\u4f60\u653e\u5f03\u601d\u8003\u5199\u4e86\u8fd9\u4e2a\u770b\u8d77\u6765\u5f88\u66b4\u529b\u7684\u505a\u6cd5\u53d1\u73b0\u8fc7\u4e86\u3002\n\n\u7ecf\u6253\u8868\u68c0\u9a8c\uff0c\u6240\u6709\u7b49\u4ef7\u7c7b\u4fdd\u7559\u524d $m$ \u4e2a\u540e\u4ea7\u751f\u7684\u6570\u7684\u4e2a\u6570\u6570\u91cf\u7ea7\u4e3a $12000$\uff0c\u8bbe\u4e3a $N$\uff0c\u90a3\u4e48\u6700\u540e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u53ea\u6709 $O(N k^2 3 ^ k)$\uff0c\u7136\u540e\u5c31\u83ab\u540d\u8dd1\u8fc7\u4e86\uff0c\u96be\u70b9\u679c\u7136\u5728\u4e8e\u6253\u8868\u3002\n\n```cpp\n/*\n\u5148\u628a gcd \u6c42\u51fa\u6765\uff0c\u7136\u540e\u94a6\u5b9a\u6bcf\u4e2a\u8d28\u56e0\u6570\u5bf9\u5e94\u54ea\u4e2a\u88ab\u9009\u62e9\u7684\u6570\u5c31\u884c\u4e86\n\u4f46\u662f\u8fd9\u4e2a\u9884\u5904\u7406\u597d\u50cf\u5f88\u56f0\u96be\u3002\u5bb9\u6211\u665a\u4e0a\u60f3\u60f3\u3002\n*/\n#include \"bits/stdc++.h\"\nusing namespace std;\n#define int long long\nconst int Len = 1e6 + 5 , Inf = 1e15;\nint n,k,m,a[Len],e[Len],f[20][(1 << 13) + 5];\ninline int read() {\n    char ch = getchar();\n    int x = 0, f = 1;\n    while (ch < '0' || ch > '9') ch = getchar();\n    while ('0' <= ch && ch <= '9') {\n        x = x * 10 + ch - '0';\n        ch = getchar();\n    }\n    return x * f;\n}\nint gcd(int a,int b)\n{\n\tif(!b) return a;\n\treturn gcd(b , a % b);\n}\nvector<int> Pm;\nmap<int,vector<int> > vc;\nmap<int,vector<int> >::iterator it;\nsigned main()\n{\n\tn = read() , k = read();int GCD = 0;\n\tfor(int i = 1 ; i <= n ; i ++) a[i] = read() , GCD = gcd(a[i] , GCD);\n\tfor(int i = 1 ; i <= n ; i ++) e[i] = read();\n\tif(GCD == 1) return puts(\"0\") & 0; \n\tfor(int i = 2 ; i * i <= GCD ; i ++) while(GCD % i == 0) Pm.push_back(i) , GCD /= i;\n\tif(GCD != 1) Pm.push_back(GCD);\n\tsort(Pm.begin() , Pm.end());\n\tPm.erase(unique(Pm.begin() , Pm.end()) , Pm.end());\n\tm = (int)Pm.size();\n\tfor(int i = 1 ; i <= n ; i ++) \n\t{\n\t\tint ns = 1;\n\t\tfor(int j = 0 ; j < m ; j ++) while(a[i] % Pm[j] == 0) ns = ns * Pm[j] , a[i] /= Pm[j];\n\t\tvc[ns].push_back(e[i]);\n\t}\n\tfor(int i = 0 ; i <= m ; i ++) for(int j = 0 ; j < (1 << m) ; j ++) f[i][j] = Inf;\n\tf[0][0] = 0;\n\tfor(it = vc.begin() ; it != vc.end() ; it ++)\n\t{\n\t\tvector<int> N;N = it -> second;int w = it -> first;\n\t\tsort(N.begin() , N.end());\n\t\tvector<int> A;\n\t\tfor(int s = 0 ; s < (1 << m) ; s ++)\n\t\t{\n\t\t\tint ds = 1 , ww = w;\n\t\t\tfor(int i = 0 ; i < m ; i ++) \n\t\t\t{\n\t\t\t\tif((s >> i) & 1)\n\t\t\t\t{\n\t\t\t\t\twhile(ww % Pm[i] == 0) ds = ds * Pm[i] , ww /= Pm[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tA.push_back(ds);\n\t\t}\n\t\tconst int SS = (int)N.size();\n\t\tfor(int p = 0 ; p < min(SS , m + 1) ; p ++) \n\t\t{\n\t\t\tint sw = N[p];bool bot = 0;\n\t\t\tfor(int i = m - 1 ; i >= 0 ; i --)\n\t\t\t\tfor(int j = 0 ; j < (1 << m) ; j ++)\n\t\t\t\t{\n\t\t\t\t\tint NT = (1 << m) - 1 - j;\n\t\t\t\t\t//printf(\"%d %d\\n\",j,A[j]);\n\t\t\t\t\tfor(int T = NT ; T ; T = (T - 1) & NT) \n\t\t\t\t\t{\n\t\t\t\t\t\tif(A[T] <= k && f[i + 1][j | T] > f[i][j] + sw) \n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tf[i + 1][j | T] = f[i][j] + sw;\n\t\t\t\t\t\t\tbot = 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\tif(!bot) break;\n\t\t}\n\t}\n\tint as = Inf;\n\tfor(int i = 1 ; i <= m ; i ++) as = min(as , f[i][(1 << m) - 1] * i);\n\tprintf(\"%lld\\n\",(as == Inf) ? -1 : as);\n\treturn 0;\n}\n```",
        "postTime": 1676811541,
        "uid": 132533,
        "name": "Hakuoro",
        "ccfLevel": 0,
        "title": "\u4f38\u624b\u53ef\u89e6\u7684\u300e\u4eca\u5929\u300d\u5b89\u629a\u9759\u8109\u7684\u8dc3\u52a8\u58f0"
    },
    {
        "content": "[CF \u4f20\u9001\u95e8](https://codeforces.com/problemset/problem/1103/d) | [\u6d1b\u8c37\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF1103D)\n\n\u72b6\u538b dp\u3002\n\n## Solution\n\n\u53d1\u73b0\u6709\u4e9b\u9898\u89e3\u5bf9\u4e00\u4e9b\u7ec6\u8282\u90e8\u5206\u6ca1\u6709\u8bf4\u660e\uff0c\u5bfc\u81f4\u67d0\u4e9b\u5b9e\u73b0\u90e8\u5206\u6ca1\u5f97\u5230\u8bc1\u660e\u3002\n\n\u7ea6\u5b9a\uff1a\u8bb0\u9898\u9762\u4e2d\u7684\u56e0\u6570\u4e0a\u9650 $k$ \u4e3a $limit$\u3002\n\n### 1\n\n\u8bb0\u6240\u6709\u6570\u7684\u6700\u5927\u516c\u56e0\u6570\u4e3a $res$\u3002\n\n\u7a0d\u52a0\u601d\u8003\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u6211\u60f3\u4f7f\u7528\u4e00\u4e2a\u6570\u53bb\u6d88\u9664\u6389 $res$ \u7684\u4e00\u4e2a\u8d28\u56e0\u6570 $x$\uff0c\u5fc5\u987b\u8981\u9664\u6389\u8fd9\u4e2a\u6570\u5185\u6240\u6709\u7684 $x$\uff0c\u624d\u80fd\u4f7f\u5f97\u4e4b\u540e\u6240\u6709\u6570\u7684\u6700\u5927\u516c\u56e0\u6570\u4e0d\u542b $x$\u3002\n\n\u6545\uff0c\u82e5\u60f3\u4f7f\u7528\u4e00\u4e2a\u6570 $x = p_1^{k_1} \\times p_2^{k_2} \\times \\cdots \\times p_t^{k_t}\\times r$ \u6d88\u53bb $res$ \u4e2d $p_1,\\ p_2,\\ \\cdots,\\  p_t$ \u8fd9 $t$ \u4e2a\u8d28\u56e0\u6570\uff08\u5176\u4e2d $x$ \u7684 $r$ \u90e8\u5206\u6307\u7684\u662f $x$ \u4e2d\u9664\u53bb\u8fd9\u4e9b\u7d20\u6570\u4e4b\u5916\u7684\u4f59\u4e0b\u90e8\u5206\uff09\uff0c\u5fc5\u987b\u8981\u4f7f $x$ \u9664\u53bb $p_1^{k_1} \\times p_2^{k_2} \\times \\cdots \\times p_t^{k_t}$\uff0c\u800c\u8fd9\u6b65\u64cd\u4f5c\u53ef\u884c\u5f53\u4e14\u4ec5\u5f53 $p_1^{k_1} \\times p_2^{k_2} \\times \\cdots \\times p_t^{k_t} \\leq limit$\u3002\u6240\u4ee5\u6211\u4eec\u660e\u767d\uff1a\u8981\u60f3\u4f7f\u7528 $x$ \u6d88\u53bb $res$ \u4e2d\u7684\u4e00\u4e2a\u8d28\u56e0\u6570 $p$\uff0c\u4e0e $p$ \u5728 $res$ \u4e2d\u7684\u6b21\u6570\u65e0\u5173\uff0c\u800c\u662f\u4e0e $p$ \u5728 $x$ \u4e2d\u7684\u6b21\u6570\u6709\u5173\u3002\n\n\u663e\u7136\uff0c\u6211\u4eec\u7684\u76ee\u6807\u5c31\u662f\u5c06 $res$ \u4e2d\u7684\u6bcf\u4e2a\u8d28\u56e0\u6570\u6d88\u6389\u3002\n\n\u5176\u5b9e\u8fd9\u91cc\u5df2\u7136\u53ef\u4ee5\u60f3\u5230\u4f7f\u7528\u72b6\u538b dp \u6765\u5904\u7406\u4e86\uff0c\u4f46\u662f\u76f4\u63a5\u4e0a\u624b\u590d\u6742\u5ea6\u663e\u7136\u8fc7\u4e0d\u4e86\uff0c\u6240\u4ee5\u9700\u8981\u6839\u636e\u9650\u5236\u8003\u8651\u4f18\u5316\u3002\n\n### 2\n\n\u5176\u4e2d\uff0c\u6839\u636e\u6570\u636e\u8303\u56f4\u53ef\u77e5 $res$ \u7684\u4e0d\u540c\u8d28\u56e0\u6570\u4e2a\u6570\u4e0a\u9650\u4e3a $11$\u3002\u540c\u65f6\uff0c\u6bcf\u4e00\u4e2a\u6570 $x$ \u4e0e $res$ \u6709\u5173\u8054\u7684\u53ea\u6709 $x$ \u5185 \u540c\u65f6\u5728 $res$ \u4e2d\u51fa\u73b0\u7684\u8d28\u56e0\u6570 \u7684\u5e42\u3002\u800c\u9664\u4e86\u8fd9\u4e9b\u8d28\u56e0\u6570\u5916\u7684\u56e0\u6570\uff0c\u5bf9 $x$ \u6ca1\u6709\u8d21\u732e\uff0c\u6545\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5c06\u6bcf\u4e2a $x$ \u52a0\u5de5\uff0c\u628a\u8fd9\u4e9b\u6ca1\u6709\u8d21\u732e\u7684\u6570\u5168\u90e8\u4ece $x$ \u4e2d\u9664\u53bb\u3002\u5f97\u5230\u7684\u8fd9\u4e9b\u65b0\u7684\u6570\uff0c\u901a\u8fc7\u66b4\u529b\u6253\u8868\uff0c\u5f97\u77e5\u5176\u4e0d\u540c\u79cd\u7c7b\u6570\u7684\u4e0a\u9650\u7ea6\u4e3a $12000$\u3002\n\n\u7ea6\u5b9a\uff1a\u4e0b\u6587\u63d0\u53ca\u7684\u201c\u6570\u201d\u90fd\u662f\u5c06\u6bcf\u4e2a $a_i$ \u91cd\u65b0\u5904\u7406\uff08\u5373\u5254\u9664\u6389\u65e0\u8d21\u732e\u90e8\u5206\uff09\u540e\u5f97\u5230\u7684\u65b0\u5e8f\u5217\u4e2d\u7684\u6570\u3002\n\n\u4e0a\u8ff0\u4e24\u8005\u7684\u4e0a\u9650\u90fd\u8f83\u5c0f\uff0c\u5bf9\u4e8e\uff1a\n\n- \u201d\u4e0d\u540c\u8d28\u56e0\u6570 $m$ \u4e0a\u9650\u4e3a $11$\u201d\uff1a\n\n\t~~\u4e0d\u96be\u60f3\u5230~~\u4f7f\u7528\u72b6\u538b dp\uff0c\u5b9a\u4e49 $f_{i,st}$\uff0c\u8868\u793a\u4f7f\u7528\u4e86 $i$ \u4e2a\u6570\uff0c\u628a $st$ \u4e2d\u4e3a $1$ \u7684\u6bcf\u4e00\u4f4d\u5bf9\u5e94\u7684 $res$ \u4e2d\u7684\u4e00\u4e2a\u8d28\u56e0\u6570 \u9664\u53bb\u4e86\u3002\u5176\u4e2d\uff0c$i$ \u7684\u4e0a\u9650\u4e3a $m$\uff0c\u56e0\u4e3a\u6700\u52a3\u60c5\u51b5\u5c31\u662f\u4f7f\u7528\u4e00\u4e2a\u6570\u6d88\u53bb\u4e00\u4e2a\u8d28\u56e0\u6570\uff0c\u5373\u6700\u591a\u4f7f\u7528 $m$ \u4e2a\u6570\u3002\n    \n- \u201c\u65b0\u6570\u79cd\u7c7b\u6570 $S$ \u4e0a\u9650\u4e3a $12000$\u201d\uff1a\n\n\t\u6211\u4eec\u53ef\u4ee5\u5c06 $a$ \u5e8f\u5217\u4e2d\u7684\u6570\u91cd\u65b0\u5206\u95e8\u522b\u7c7b\uff0c\u5373\u5c06\u5904\u7406\u8fc7\u540e\u76f8\u540c\u7684\u6570\u653e\u5230\u4e00\u8d77\u5904\u7406\uff08\u56e0\u4e3a\u5b83\u4eec\u4e4b\u95f4\u7684\u5dee\u522b\u53ea\u5269\u4e0b\u4ee3\u4ef7\u7684\u4e0d\u540c\uff09\u3002\u5177\u4f53\u5730\uff0c\u5f00\u4e00\u4e2a `map`\uff0c\u4e00\u4e2a\u6570\u503c\u5bf9\u5e94\u4e00\u4e2a `vector`\uff0c\u800c\u67d0\u4e2a\u6570\u503c $val$ \u5bf9\u5e94\u7684 `vector` \u5185\u5b58\u653e \u90a3\u4e9b\u5904\u7406\u4e4b\u540e\u7684\u503c\u4e3a $val$ \u7684\u6570\uff0c\u64cd\u4f5c\u4e00\u6b21\u7684\u4ee3\u4ef7\u3002\n    \n    \u8fd9\u91cc\u5728\u5b9e\u73b0\u4e0a\u8fd8\u6709\u4e00\u4e2a\u5c0f\u4f18\u5316\uff1a\u5728\u5c06\u6bcf\u4e2a\u503c\u5bf9\u5e94\u7684 `vector` \u5185\u90e8\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u4e4b\u540e\uff0c\u6211\u4eec\u6700\u591a\u663e\u7136\u662f\u4f7f\u7528\u524d $m$ \u5c0f\u7684\u90a3\u4e9b\u4ee3\u4ef7\uff0c\u6240\u4ee5\u7b2c $m$ \u4e2a\u4ee3\u4ef7\u4e4b\u540e\u7684\u4ee3\u4ef7\u4e8e\u6211\u4eec\u6765\u8bf4\u90fd\u6ca1\u6709\u610f\u4e49\u4e86\uff0c\u6545\u53ef\u4ee5\u76f4\u63a5 `resize(m)` \u6389\uff0c\u8fd9\u6837\u4e4b\u540e\u8f6c\u79fb\u72b6\u6001\u4e5f\u4e0d\u7528\u518d\u8003\u8651\u4e86\u3002\n    \n    \u6309\u7167\u5904\u7406\u540e\u7684\u503c\u5206\u7c7b\u4e4b\u540e\uff0c\u5c31\u53ef\u4ee5\u5206\u522b\u8003\u8651\u8fd9\u4e9b\u503c\u5bf9\u7b54\u6848\u7684\u8d21\u732e\uff0c\u5373\u8f6c\u79fb dp \u72b6\u6001\u3002\u9996\u5148\u9884\u5904\u7406\u51fa\u5bf9\u4e8e\u6bcf\u4e2a\u72b6\u6001 $st$\uff08\u5373\u9009\u53d6\u51fa $res$ \u7684\u67d0\u4e9b\u8d28\u56e0\u6570\uff09\uff0c\u82e5\u60f3\u4f7f\u7528 $val$ \u8fd9\u4e2a\u503c\u9664\u53bb $res$ \u4e2d\u7684\u8fd9\u4e9b\u8d28\u56e0\u6570\uff0c\u9700\u8981\u9664\u53bb\u591a\u5c11\u3002\n    \n    \u7136\u540e\u5c31\u662f\u8f6c\u79fb\u72b6\u6001\u4e86\uff0c\u8fd9\u91cc\u6309\u7167\u4ece\u5c0f\u5230\u5927\u7684\u987a\u5e8f\u904d\u5386\u6bcf\u4e00\u4e2a\u4ee3\u4ef7\uff0c\u8003\u8651\u8fd9\u4e2a\u6570\u5bf9\u5e94\u7684\u6bcf\u4e2a\u4ee3\u4ef7\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u3002\uff08\u4e00\u65e6\u53d1\u73b0\u904d\u5386\u5230\u67d0\u4e2a\u4ee3\u4ef7\u4e4b\u540e\u6ca1\u6cd5\u66f4\u65b0\u4efb\u4f55\u72b6\u6001\uff0c\u7acb\u5373 `break` \u6389\u3002\uff09\u8fd9\u91cc\u8f6c\u79fb\u72b6\u6001\u7684\u65b9\u5f0f\u6bd4\u8f83\u7279\u522b\uff1a\u679a\u4e3e\u72b6\u6001 $st$\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $st$\uff0c\u627e\u5230 $2^m-1$ \u8fd9\u4e2a\u72b6\u6001\u4e0e $st$ \u7684\u8865\u96c6 $C$\uff0c\u7136\u540e\u904d\u5386\u8fd9\u4e2a\u8865\u96c6\u4e2d\u7684\u6bcf\u4e00\u4e2a\u975e\u7a7a\u5b50\u96c6 $k$\uff0c\u90a3\u4e48\u5728\u9700\u8981\u9664\u53bb\u7684\u6570\uff08\u5373\u4e0a\u9762\u9884\u5904\u7406\u7684\u90e8\u5206\uff09\u5c0f\u4e8e $limit$ \u7684\u65f6\u5019\uff0c\u5373\u6709\uff1a$f_{i + 1,j | k} = \\min(f_{i + 1,j | k},\\ f_{i,j} + cst)$\uff08\u5176\u4e2d $cst$ \u6307\u7684\u662f\u5f53\u524d\u904d\u5386\u5230\u7684\u4ee3\u4ef7\u3002\uff09\n    \n\u4e8e\u662f\u6700\u540e\u7684\u7b54\u6848\u4e5f\u5c31\u6c34\u5230\u6e20\u6210\u4e86\uff1a`rep(i, 1, m) ans = min(ans, f[i][(1 << m) - 1] * i);`\u3002\n\n\u8bb0\u65b0\u6570\u7684\u79cd\u7c7b\u6570\u4e3a $S$\uff0c\u90a3\u4e48\u6700\u7ec8\u590d\u6742\u5ea6\u5c31\u662f $\\mathcal{\\text{O}}(Sm^23^m)$\uff0c\u8dd1\u4e0d\u6ee1\uff0c\u80fd\u8fc7\u3002\n\n## Code\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n \n#define int long long\n#define rep(i, a, b) for(register int i = a; i <= b; ++i)\n#define per(i, a, b) for(register int i = a; i >= b; --i)\nconst int maxn = 1e6 + 5;\nint n, lmt, m, res, ans = 1e15;\nvector <int> fac;\nstruct node{\n    int a, c;\n}p[maxn];\nmap <int, vector<int> > mp;\nint f[12][1 << 12];\n \ninline int gcd(int x, int y){\n    return !y ? x : gcd(y, x % y);\n}\n \ninline void dp(){\n    memset(f, 2, sizeof f), f[0][0] = 0;\n    for(auto val : mp){ int x = val.first;/*\u503c\u4e3ax\u7684\u6570*/ vector <int> mul;\n        sort(val.second.begin(), val.second.end());\n        if(val.second.size() > m) val.second.resize(m);\n        rep(i, 0, (1 << m) - 1){ int tot = 1, tmp = x;\n            rep(j, 0, m - 1) if(i & (1 << j)) \n                while(!(tmp % fac[j])) tot *= fac[j], tmp /= fac[j];\n            mul.push_back(tot);//tot\uff1a\u8981\u60f3\u6d88\u6389\u8fd9\u4e00\u79cd\u642d\u914d\u4e2d\u6240\u6709\u7d20\u6570\uff0cx \u9700\u8981\u9664\u53bb\u591a\u5c11 \n            //\u8fd9\u91cc\u662f\u6309\u987a\u5e8f\u5b58\u653e\u7684\uff0c\u4e4b\u540e\u8c03\u7528\u7684\u65f6\u5019\u76f4\u63a5\u7528\u72b6\u6001\u8c03\u7528\u5373\u53ef \n        } for(auto cst : val.second){ bool flg = 0;//\u4ece\u5c0f\u5230\u5927\u6bcf\u4e00\u79cd\u4ee3\u4ef7 \n            per(i, m - 1, 0) rep(j, 0, (1 << m) - 1) \n                if(f[i][j] <= 1e13){\n                    int C = (1 << m) - 1 - j;//\u8be5\u72b6\u6001\u7684\u8865\u96c6 \n                    for(int k = C; k; k = (k - 1) & C) if(mul[k] <= lmt)\n                        if(f[i + 1][j | k] > f[i][j] + cst) f[i + 1][j | k] = f[i][j] + cst, flg = 1;\n                } if(!flg) break;\n        }\n    }\n}\n \nsigned main(){\n    scanf(\"%lld%lld\", &n, &lmt);\n    rep(i, 1, n) scanf(\"%lld\", &p[i].a),\n        res = gcd(res, p[i].a);\n    rep(i, 1, n) scanf(\"%lld\", &p[i].c);\n    if(!(res - 1)) return printf(\"0\"), 0;\n    rep(i, 2, 1e6) if(i <= res and !(res % i)){\n        fac.push_back(i); \n        while(!(res % i)) res /= i;\n    } else if(i > res) break;\n    if(res - 1) fac.push_back(res);\n    m = fac.size();\n    rep(i, 1, n){ int nw = 1;\n        rep(j, 0, m - 1) \n            while(!(p[i].a % fac[j])) nw *= fac[j], p[i].a /= fac[j];\n        mp[nw].push_back(p[i].c);//\u628a\u6bcf\u4e2a\u8f93\u5165\u7684\u6570\u66f4\u65b0\uff0c\u5373\u5254\u9664\u6389\u6ca1\u7528\u7684\u90e8\u5206\uff0c\u5176\u6700\u7ec8\u5f62\u5f0f\u4e3a nw \n    } dp();\n    rep(i, 1, m) ans = min(ans, f[i][(1 << m) - 1] * i);\n    if(ans > 1e13) printf(\"-1\"); else printf(\"%lld\", ans);\n    return 0;\n}\n\n```\n\n\n------------\n\u611f\u8c22\u9605\u8bfb\u3002",
        "postTime": 1660272331,
        "uid": 469672,
        "name": "\u4f0d\u53c1\u58f9",
        "ccfLevel": 7,
        "title": "\u3010CF1103D\u3011 Professional layer \u9898\u89e3"
    },
    {
        "content": "### CF1103D Professional layer\r\n\r\n\u597d\u9898\u3002\r\n\r\n\u9996\u5148\u8003\u8651\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u6709\u91cd\u8d28\u56e0\u6570\uff0c\u627e\u4e00\u4e9b\u6570\u5c06\u6307\u6570\u6d88\u6210 $0$\u3002\r\n\r\n\u597d\u50cf\u5206\u89e3\u4e0d\u4e86\u90a3\u4e48\u591a\uff1f\u53d1\u73b0\u6709\u6548\u8d28\u6570\u96c6\u53ea\u80fd\u662f $\\gcd$\uff0c\u4e14\u4e0d\u540c\u8d28\u56e0\u5b50\u4e2a\u6570\u6700\u591a $11$ \u4e2a\u3002\r\n\r\n\u72b6\u538b\u5c31\u884c\u4e86\uff0c\u8bb0 $f_{i,j}$ \u8868\u793a\u9009 $i$ \u4e2a\u6570\uff0c\u6d88\u4e86 $j$ \u7684\u8d28\u6570\u96c6\u5408\u7684\u6700\u5c0f\u82b1\u8d39\u3002\r\n\r\n\u6ce8\u610f\u5230\u6bcf\u6b21\u9009\u4e00\u4e2a\u6570\u5fc5\u5b9a\u6d88\u6389\u4e00\u4e2a\u65b0\u7684\u8d28\u6570\uff0c\u6545\u7b2c\u4e00\u7ef4\u5927\u5c0f\u53ea\u6709 $m$\uff0c\u5373\u6700\u591a\u9009 $m$ \u4e2a\u6570\uff0c\u6240\u4ee5\u6bcf\u79cd\u6570\u90fd\u4fdd\u7559\u6700\u4fbf\u5b9c\u7684 $m$ \u4e2a\u3002\uff08\u8bb0\u4e0e\u80fd\u53d6\u5f97\u6700\u5927 $\\gcd$ \u7684\u500d\u6570\u7684\u76f8\u540c\u7684 $a_i$ \u4e3a\u4e00\u7c7b\u6570\uff09\r\n\r\n\u66b4\u529b\u53d1\u73b0 $m$ \u4e2a\u8d28\u6570\u6240\u6709\u7684\u6307\u6570\u5e42\u7ec4\u5408\u65b9\u5f0f\u6700\u591a $12000$ \u4e2a\uff0c\u8bb0\u4e3a $N$\u3002\r\n\r\n\u6240\u4ee5\u6211\u4eec\u9996\u5148\u679a\u4e3e\u7ec4\u5408\u65b9\u5f0f\uff0c\u5185\u5c42\u5d4c\u5957\u679a\u4e3e\u5bf9\u5e94\u7684\u6700\u4fbf\u5b9c\u7684 $m$ \u7684\u82b1\u8d39\u3002\r\n\r\n\u8f6c\u79fb\u65f6\u5148\u679a\u4e3e\u9009\u51e0\u4e2a\u6570\uff0c\u5f53\u524d\u6d88\u7684\u72b6\u6001\uff0c\u4ee5\u53ca\u51c6\u5907\u6d88\u54ea\u4e9b\u8d28\u6570\u3002\r\n\r\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(Nm^23^m)$\u3002\r\n\r\n```cpp\r\n#include <cstdio>\r\n#include <vector>\r\n#include <unordered_map>\r\n#include <cstring>\r\n#include <algorithm>\r\n\r\ntypedef long long ll;\r\n\r\n#define ha putchar(' ')\r\n#define he putchar('\\n')\r\n\r\ninline ll read() {\r\n\tll x = 0;\r\n\tchar c = getchar();\r\n\twhile (c < '0' || c > '9')\r\n\t\tc = getchar();\r\n\twhile (c >= '0' && c <= '9')\r\n\t\tx = (x << 3) + (x << 1) + (c ^ 48), c = getchar();\r\n\treturn x;\r\n}\r\n\r\ninline void write(ll x) {\r\n\tif (x < 0) {\r\n\t\tputchar('-');\r\n\t\tx = -x;\r\n\t}\r\n\tif (x > 9)\r\n\t\twrite(x / 10);\r\n\tputchar(x % 10 + 48);\r\n}\r\n\r\nconst int _ = 1e6 + 1;\r\n\r\nint n, m;\r\n\r\nll k, f[12][1 << 11], ans = 1e18;\r\n\r\nstd::pair<ll, ll> c[_];\r\n\r\nstd::vector<ll> a, d;\r\n\r\nstd::unordered_map<ll, std::vector<ll>> mp;\r\n\r\nll gcd(ll a, ll b)\r\n{\r\n\treturn b ? gcd(b, a % b) : a;\r\n}\r\n\r\nsigned main() {\r\n\tn = read(), k = read();\r\n\tll nw = 0;\r\n\tfor (int i = 1; i <= n; ++i) c[i].first = read(), nw = gcd(nw, c[i].first);\r\n\tfor (int i = 1; i <= n; ++i) c[i].second = read();\r\n\tif (nw == 1) return write(0), he, 0;\r\n\tfor (int i = 2; 1ll * i * i <= nw; ++i)\r\n\t\tif (!(nw % i)) {\r\n\t\t\td.emplace_back(i);\r\n\t\t\twhile (!(nw % i)) nw /= i;\r\n\t\t}\r\n\tif (nw != 1) d.emplace_back(nw);\r\n\tm = d.size();\r\n\tfor (int i = 1; i <= n; ++i) {\r\n\t\tll z = 1;\r\n\t\tfor (ll j : d)\r\n\t\t\twhile (!(c[i].first % j)) c[i].first /= j, z *= j;\r\n\t\tmp[z].emplace_back(c[i].second);\r\n\t}\r\n\tmemset(f, 2, sizeof f);\r\n\tf[0][0] = 0;\r\n\tfor (auto t : mp) {\r\n\t\tsort(t.second.begin(), t.second.end());\r\n\t\ta.clear();\r\n\t\tfor (int i = 0; i < (1 << m); ++i) {\r\n\t\t\tll z = 1, nw = t.first;\r\n\t\t\tfor (int j = 0; j < m; ++j)\r\n\t\t\t\tif (i & (1 << j)) while (!(nw % d[j])) nw /= d[j], z *= d[j];\r\n\t\t\ta.emplace_back(z);\r\n\t\t}\r\n\t\tfor (ll r : t.second) {\r\n\t\t\tbool flg = 0;\r\n\t\t\tfor (int i = m - 1; i >= 0; --i)\r\n\t\t\t\tfor (int j = 0; j < (1 << m); ++j) {\r\n\t\t\t\t\tint tmp = (1 << m) - j - 1;\r\n\t\t\t\t\tfor (int p = tmp; p; p = (p - 1) & tmp)\r\n\t\t\t\t\t\tif (a[p] <= k && f[i + 1][j | p] > f[i][j] + r)  f[i + 1][j | p] = f[i][j] + r, flg = 1;\r\n\t\t\t\t}\r\n\t\t\tif (!flg) break;\r\n\t\t}\r\n\t}\r\n\tfor (int i = 1; i <= m; ++i) ans = std::min(ans, f[i][(1 << m) - 1] * i);\r\n\twrite(ans > 1e12 ? -1 : ans), he;\r\n\treturn 0;\r\n}\r\n```\r\n\r\n",
        "postTime": 1660220006,
        "uid": 257146,
        "name": "orz_z",
        "ccfLevel": 0,
        "title": "CF1103D Professional layer"
    },
    {
        "content": "## $\\text{Description}$\n\u7ed9\u5b9a $1 \\le n \\le 10^6$ \u4e2a\u6b63\u6574\u6570 $a_i,1 \\le a_i\u226410^{12}$\uff0c\u4ee5\u53ca\u6b63\u6574\u6570 $1 \\le k \\le 10^{12}$\uff0c\u4fee\u6539\u7b2c $i$ \u4e2a\u6b63\u6574\u6570 $a_i$ \u7684\u82b1\u8d39\u4e3a $e_i,1 \\le e_i \\le 10^9$ \u3002\n\n\u8981\u6c42\u9009\u51fa\u82e5\u5e72\u4e2a\u6b63\u6574\u6570\u8fdb\u884c\u4e00\u6b21\u4fee\u6539\uff0c\u4f7f\u5f97\u4fee\u6539\u540e\u6240\u6709\u6b63\u6574\u6570\u7684\u6700\u5927\u516c\u7ea6\u6570\u7b49\u4e8e $1$ \u3002\u4fee\u6539\u64cd\u4f5c\u4e3a\uff1a\u5bf9\u4e8e\u6b63\u6574\u6570 $a$\uff0c\u9009\u62e9 $a$ \u7684\u4e00\u4e2a\u7ea6\u6570 $d \\le k$\uff0c\u628a $a$ \u4fee\u6539\u4e3a $ \\frac{a}{d}$\u3002\n\n\u8bbe\u9009\u51fa\u5e76\u4fee\u6539\u7684\u6b63\u6574\u6570\u6709 $x$ \u4e2a\uff0c\u4ed6\u4eec\u7684\u82b1\u8d39\u4e4b\u548c\u4e3a $y$\uff0c\u5219\u603b\u7684\u4fee\u6539\u82b1\u8d39\u4e3a $x \\times y$\u3002\u6c42\u6700\u5c0f\u82b1\u8d39\u3002\n## $\\text{Solution}$\n\u6bd2\u7624\u72b6\u538b\u9898\u3002    \n\u4e0d\u96be\u60f3\u5230\uff0c\u516c\u56e0\u6570\u7684\u8d28\u56e0\u5b50\u4e0d\u8d85\u8fc7 $11$ \u4e2a\uff0c\u53ef\u4ee5\u72b6\u538b\u3002  \n\u5173\u952e\u5c31\u662f\u5bf9\u590d\u6742\u5ea6\u7684\u4f18\u5316\u3002  \n\uff08\u4ee5\u4e0b\u8bbe\u8d28\u56e0\u5b50\u4e2a\u6570\u4e3a $k$\uff09  \n\u6734\u7d20 dp \u7684\u590d\u6742\u5ea6\u662f $O(nk3^k)$\uff0c\u96be\u4ee5\u901a\u8fc7\u3002  \n\u8003\u8651\u4f18\u5316\u3002  \n\u9996\u5148\uff0c\u6ce8\u610f\u5230\u4f1a\u6709\u5927\u91cf\u7684\u91cd\u590d\u6570\uff08\u6253\u8868\u53ef\u77e5\u4e0d\u540c\u7684\u6570\u53ea\u6709 $10^4$ \u4e2a\uff09\uff0c\u6bcf\u79cd\u6570\u5b57\u53d6\u4ee3\u4ef7\u6700\u5c0f\u7684\u524d $k$ \u4e2a\u5373\u53ef\u3002  \n\u7136\u540e\uff0c\u6570\u7684\u6570\u91cc\u964d\u5230\u4e86\u5341\u4e07\u7ea7\u522b\uff0c\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u6c42\u51fa\u6bcf\u4e2a\u6570\u53ef\u4ee5\u8f6c\u79fb\u5230\u90a3\u4e9b\u8d28\u56e0\u6570\u96c6\u5408\uff0c\u800c\u6bcf\u4e2a\u96c6\u5408\u5176\u5b9e\u4e5f\u53ea\u9700\u8981\u53d6\u524d $k$ \u4e2a\u6570\u8fdb\u884c\u8f6c\u79fb\uff0c\u6240\u4ee5\u8f6c\u79fb\u6570\u964d\u5230\u4e86 $k\\times2^k$\u3002  \n\u5bf9\u6bcf\u4e2a\u8f6c\u79fb\u96c6\u5408\u7684\u8865\u96c6\u679a\u4e3e\u5b50\u96c6\u8f6c\u79fb\uff0c\u518d\u52a0\u4e0a\u679a\u4e3e\u4e00\u7ef4\u9009\u53d6\u4e2a\u6570\u7684\u590d\u6742\u5ea6\uff0c\u603b\u590d\u6742\u5ea6 $3^k\\times k^2$\u3002  \n\u6ce8\u610f\u6bcf\u6b21\u4e0d\u80fd\u66b4\u529b\u66f4\u65b0\u6eda\u52a8\u6570\u7ec4\uff0c\u590d\u6742\u5ea6\u4f1a\u5047\u6389\uff0c\u6240\u4ee5\u9700\u8981\u5f00\u4e2a vector \u8bb0\u5f55\u4e00\u4e0b\u66f4\u65b0\u4e86\u54ea\u4e9b\u72b6\u6001\u3002  \n\u6ce8\u610f\u5f00 longlong\u3002\n## $\\text{Code}$\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define ull unsigned long long\n#define debug(...) fprintf(stderr,__VA_ARGS__)\nconst int N=2e6+100;\ninline ll read(){\n  ll x(0),f(1);char c=getchar();\n  while(!isdigit(c)){if(c=='-')f=-1;c=getchar();}\n  while(isdigit(c)) {x=(x<<1)+(x<<3)+c-'0';c=getchar();}\n  return x*f;\n}\nint n,m;\nll k,flag;\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nstruct node{\n  ll a,c;\n}p0[N],p[N];\nbool cmpc(node x,node y){return x.c<y.c;}\nbool cmpa(node x,node y){return x.a<y.a;}\nll tot,g;\nll dp[2][13][2105],now,nxt;\nll prime[13],cnt;\nmap<ll,int>mp;\nvector<int>v[2105];\nll w[13],mi[13],bit[2105];\nvector<int>vv[N];\nvoid findtrans(int id){\n  ll x=p[id].a;\n  //ll x=p[i].a;\n  for(int j=1;j<=cnt;j++){\n    w[j]=1;\n    while(x%prime[j]==0){\n      x/=prime[j];w[j]*=prime[j];\n    }\n  }\n  for(int s=0;s<(1<<cnt);s++){\n    ll o=1;int ss=s;\n    if((int)v[s].size()==cnt) continue;\n    while(ss){\n      o*=w[bit[ss&-ss]+1];ss-=ss&-ss;\n    }\n    if(o<=k){\n      //v.push_back(s);\n      v[s].push_back(id);\n      //printf(\"  s=%d o=%lld\\n\",s,o);\n    }\n  }\n}\nvoid init(){\n  int tp=floor(sqrt(g));\n  for(int i=2;i<=tp;i++){\n    if(g%i==0){\n      prime[++cnt]=i;\n      while(g%i==0) g/=i;\n    }\n  }\n  if(g>1) prime[++cnt]=g;\n  sort(p0+1,p0+1+n,cmpc);\n  for(int i=1;i<=n;i++){\n    int x=p0[i].a;\n    if(mp.find(x)!=mp.end()&&mp[x]>=cnt) continue;\n    p[++tot]=p0[i];mp[x]=mp[x]+1;\n    /*for(int j=1;j<=cnt;j++){\n      if(x%prime[j]==0){\n\tp[++tot]=p0[i];mp[x]=mp[x]+1;break;\n      }\n      }*/\n  }\n  mi[0]=1;bit[1]=0;\n  for(int i=1;i<=cnt;i++) mi[i]=mi[i-1]<<1,bit[mi[i]]=i;\n  for(int i=1;i<=tot;i++) findtrans(i);\n  //sort(p+1,p+1+tot,cmpa);\n  for(int i=0;i<(1<<cnt);i++){\n    for(auto x:v[i]) vv[x].push_back(i);\n  }\n}\nvector<int>tr;\nvoid DP(){\n  memset(dp,0x3f,sizeof(dp));dp[now=1][0][0]=0;\n  for(int i=1;i<=tot;i++){\n    //swap(nxt,now);\n    tr.clear();\n    for(auto ns:vv[i]){\n      int t=((1<<cnt)-1)^ns,T=t;\n      //debug(\"ns=%d\\n\",ns);\n      dp[nxt][1][ns]=min(dp[nxt][1][ns],p[i].c);\n      tr.push_back(ns);\n      for(;t;t=T&(t-1)){\n\ttr.push_back(t|ns);\n\tfor(int o=0;o<cnt;o++){\n\t  //debug(\"ns=%d t=%d o=%d\\n\",ns,t,o);\n\t  dp[nxt][o+1][t|ns]=min(dp[nxt][o+1][t|ns],dp[now][o][t]+p[i].c);\n\t}\n      }\n    }\n    for(auto s:tr){\n      for(int o=0;o<=cnt;o++) dp[now][o][s]=min(dp[now][o][s],dp[nxt][o][s]);\n    }\n    /*\n    for(int s=0;s<(1<<cnt);s++){\n      for(int o=0;o<=cnt;o++){\n\tdp[nxt][o][s]=min(dp[nxt][o][s],dp[now][o][s]);\n\t//if(dp[nxt][o][s]<1e9) printf(\"s=%d num=%d dp=%lld\\n\",s,o,dp[nxt][o][s]);\n      }\t\n      }*/\n  }\n}\nvoid findans(){\n  ll ans(2e18),op;\n  for(int i=0;i<=cnt;i++){\n    if(dp[now][i][(1<<cnt)-1]<1e18){\n      if(ans>dp[now][i][(1<<cnt)-1]*i) op=i;\n      ans=min(ans,dp[now][i][(1<<cnt)-1]*i);\n    }\n  }\n  printf(\"%lld\\n\",ans>1e18?-1:ans);\n  //if(flag) printf(\"g=%lld op=%lld tot=%lld\\n\",g,op,tot);\n  //debug(\"ans=%lld num=%lld\\n\",ans,op);\n}\nsigned main(){\n#ifndef ONLINE_JUDGE\n  freopen(\"a.in\",\"r\",stdin);\n  freopen(\"a.out\",\"w\",stdout);\n#endif\n  n=read();k=read();\n  for(int i=1;i<=n;i++) p0[i].a=read(),g=gcd(g,p0[i].a);\n  for(int i=1;i<=n;i++) p0[i].c=read();\n  //printf(\"g=%lld\\n\",g);\n  flag=p0[1].a==204367626045ll;\n  init();//debug(\"ok\\n\");\n  DP();\n  findans();\n  return 0;\n}\n/*\n\n*/\n\n```\n",
        "postTime": 1640250326,
        "uid": 449265,
        "name": "wind_whisper",
        "ccfLevel": 10,
        "title": "CF1103D Professional layer"
    },
    {
        "content": "## \u3010\u9898\u89e3\u3011[**CF1103D**Professional layer](https://www.luogu.org/problemnew/show/CF1103D) \n\n\u795e\u9898\u505a\u524d\u5148$orzyyb$\n\n\u4e00\u4e2a\u5f88\u597d\u7684\u6027\u8d28(\u4e4b\u524d\u4e5f\u89c1\u8fc7\u4f46\u662f\u6ca1\u6709\u60f3\u5230\u7684)\nzhengchu\n$gcd\\le 10^{12}$ \u6240\u4ee5\u4e0d\u540c\u7684\u8d28\u56e0\u6570$\\le 12$\n\n\u6240\u4ee5\u5bf9\u8fd9$12$\u4e2a\u8d28\u56e0\u6570\u72b6\u538b\u3002\n\n\u6240\u4ee5\u7b54\u6848\u663e\u7136\u5c0f\u4e8e\u7b49\u4e8e$12$\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u6570\uff0c\u53ea\u6709\u56e0\u6570\u548c\u5168\u5c40$gcd$\u6709\u5173\u7684\u624d\u6709\u7528\uff0c\u5176\u4f59\u6ca1\u7528\u3002\n\n\u6240\u4ee5\u6bcf\u79cd\u6570(\u610f\u4f1a\u4e00\u4e0b\uff0c\u5c31\u662f\u548c$gcd\u200b$\u5173\u7cfb\u4e00\u6837\u7684\u6570)\u6700\u591a\u53ea\u9700\u8981$12\u200b$\u4e2a\uff0c\u6240\u4ee5\u53ef\u4ee5\u628a$n\u200b$\u5c06\u4e0b\u6765\u3002\n\n\u7136\u540e\u5c31\u6109\u5feb\u5730$dp\u200b$\u4e86(\u8bf4\u7684\u8f7b\u5de7)\n\n\u8bbe$dp(i,STATE)\u200b$\u8868\u793a\u5df2\u7ecf\u9009\u7528\u4e86$i\u200b$\u4e2a\u6570\uff0c\u73b0\u5728$gcd\u200b$\u7684\u8d28\u56e0\u6570\u8fd8\u5269$STATE\u200b$\u7684\u72b6\u6001\n\n\u5047\u5982\u4e00\u4e2a\u72b6\u6001\u8f6c\u79fb\u4e86$\\ge 13\u200b$\u6b21\uff0c\u90a3\u4e48\u4e00\u5b9a\u662f\u4e0d\u4f18\u7684\u3002\u5f00\u4e2a\u6570\u7ec4\u8bb0\u5f55\u987a\u4fbf\u526a\u679d\u3002\u8f6c\u79fb\u65b9\u7a0b\n$$\ndp(i,k' \\subset k)=min\\{  dp(i-1,k)+e[i]\\},(cnt(k)<13)\n$$\n\n$$\ndp(0,0)=0\n$$\n\n\n\n\u5b9e\u9645\u4e0a$13\u200b$\u53ef\u4ee5\u4f18\u5316\u5230$d\u200b$\u5168\u5c40$gcd\u200b$\u7684\u8d28\u56e0\u6570\u4e2a\u6570$m\u200b$\n\n\u6709\u4e00\u4e2a\u72b6\u538b\u7684\u6280\u5de7\uff0c\u5982\u4f55\u679a\u4e3e\u5b50\u96c6\uff1f$j \\subset k $\n\n- \u77e5\u9053$j$\n\n```cpp\nfor(register int k=(j+1)|j;k<=S;k=(k+1)|j)\n```\n\n- \u77e5\u9053$k\u200b$\n\n```cpp\nfor(register int j=(k-1)&k;j;j=(j-1)&k)\n```\n\n\u4e0a~~\u6284zsy\u7684~~\u4ee3\u7801\n\n```\n#include<bits/stdc++.h>\n\nusing namespace std;typedef long long ll;\n#define DRP(t,a,b) for(register ll t=(a),edd=(b);t>=edd;--t)\n#define RP(t,a,b)  for(register ll t=(a),edd=(b);t<=edd;++t)\n#define ERP(t,a)   for(register ll t=head[a];t;t=e[t].nx)\n#define pu(x) seg[x]=seg[(x)<<1]+seg[(x)<<1|1]\n#define lef l,mid,pos<<1\n#define rgt mid+1,r,pos<<1|1\n#define all 1,n,1\n#define re register\n#define midd register int mid=(l+r)>>1\n#define TMP template < class ccf >\nTMP inline ccf qr(ccf b){\n    register char c=getchar();register int q=1;register ccf x=0;\n    while(c<48||c>57)q=c==45?-1:q,c=getchar();\n    while(c>=48&&c<=57)x=x*10+c-48,c=getchar();\n    return q==-1?-x:x;}\nTMP inline ccf Max(ccf a,ccf b){return a<b?b:a;}\nTMP inline ccf Min(ccf a,ccf b){return a<b?a:b;}\nTMP inline ccf Max(ccf a,ccf b,ccf c){return Max(a,Max(b,c));}\nTMP inline ccf Min(ccf a,ccf b,ccf c){return Min(a,Min(b,c));}\nTMP inline void Swap(ccf& a,ccf& b){re ccf c=b;b=a;a=c;}\nTMP inline void READ(ccf* _arr,int _n){RP(t,1,_n)_arr[t]=qr((ccf)1);}\n//----------------------template&IO---------------------------\nconst int maxn=1e6+15;\n//const ll mod=1e9+7;\ninline ll gcd(ll x,ll y){\n    for(register ll t=x;y;t=y,y=x%y,x=t);\n    return x;\n}\nint n,m,S,e[maxn],vis[1<<12];\nll d,k,a[maxn],p[maxn],f[13][1<<12],ans,inf;\nmap < ll ,vector<int> >mp;\nint main(){\n#ifndef ONLINE_JUDGE\n    freopen(\"A.in\",\"r\",stdin);\n    freopen(\"A.out\",\"w\",stdout);\n#endif\n    n=qr(1);k=qr(1ll);\n    RP(t,1,n) d=gcd(a[t]=qr(1ll),d);\n    RP(t,1,n) e[t]=qr(1ll);\n    for(register ll t=2;t*t<=d;++t){\n\tif(d%t==0){\n\t    p[m++]=t;\n\t    while(d%t==0) d/=t;\n\t}\n    }\n    if(d>1) p[m++]=d;\n    S=(1<<m)-1;\n    RP(t,1,n){\n\tregister ll temp=1;\n\tRP(k,0,m-1){\n\t    while(a[t]%p[k]==0) a[t]/=p[k],temp*=p[k];\n\t}\n\tmp[temp].push_back(e[t]);\n    }\n    memset(f,63,sizeof f);\n    ans=inf=f[0][0];f[0][0]=0;\n    for(register auto pr:mp){\n\tll x=pr.first;sort(pr.second.begin(),pr.second.end());\n\tif((int)pr.second.size()>m) pr.second.resize(m);\n\tRP(t,0,S){\n\t    ll y=x,z=1;\n\t    RP(i,0,m-1)\n\t\tif(t>>i&1)\n\t\t    while(y%p[i]==0) y/=p[i],z*=p[i];\n\t    vis[t]=(z<=k);\n\t}\n\tfor(register auto cost:pr.second){\n\t    register bool fg=0;\n\t    for(register int i=m-1;~i;--i)\n\t\tfor(register int j=0;j<=S;++j)\n\t\t    if(f[i][j]<inf)\n\t\t\tfor(register int k=(j+1)|j;k<=S;k=(k+1)|j)\n\t\t\t    if(vis[k^j])\n\t\t\t\tif(f[i+1][k]>f[i][j]+cost)\n\t\t\t\t    fg=1,(f[i+1][k]=f[i][j]+cost);\n\t    if(not fg) break;\n\t}\n    }\n    RP(t,0,m)if(f[t][S]<inf) ans=Min(ans,f[t][S]*t);\n    if(ans==inf) puts(\"-1\");\n    else cout<<ans<<endl;\n    return 0;\n}\n// orz zsy\n\n\n\n```",
        "postTime": 1551796397,
        "uid": 113460,
        "name": "\u8c01\u662f\u9e3d\u738b",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1103D \u3010Professional layer\u3011"
    }
]
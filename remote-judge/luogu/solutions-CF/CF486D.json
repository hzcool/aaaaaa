[
    {
        "content": "\u6811\u5f62 DP\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8fde\u901a\u5b50\u56fe\uff0c\u6211\u4eec\u9009\u53d6 $a$ \u503c\u6700\u5927\u7684\u4f5c\u4e3a\u4ee3\u8868\u70b9\uff0c\u5982\u679c\u6709\u591a\u4e2a $a$ \u503c\u6700\u5927\u7684\uff0c\u6211\u4eec\u9009\u7f16\u53f7\u6700\u5927\u7684\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $root$ \u4f5c\u4e3a\u4ee3\u8868\u70b9\uff0c\u6211\u4eec\u8bbe $dp_i$ \u4e3a\u4ee5 $root$ \u4e3a\u4ee3\u8868\u70b9\uff0c\u5b50\u6811 $i$ \u4e2d\u6709\u591a\u5c11\u4e2a\u5408\u6cd5\u7684\u8fde\u901a\u5b50\u56fe\n\n\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c$dp_u=(dp_u+dp_u\\times dp_v)$\n\n\u8868\u793a\u6211\u4eec\u8981\u4e48\u4e0d\u8981 $v$ \u5b50\u6811\u4e2d\u7684\u8054\u901a\u5757\uff0c\u6b64\u65f6\u65b9\u6848\u6570\u4e3a $dp_u$\uff0c\u8981\u4e48\u5f3a\u5236\u9009 $v$ \u5b50\u6811\u4e2d\u7684\u8054\u901a\u5757\uff0c\u6b64\u65f6\u65b9\u6848\u6570\u4e3a $dp_u\\times dp_v$\n\n```cpp\nconst int N = 2010,M = N;\nint n,d,a[N];EE(1);\nll ans,dp[N];\nvoid dfs(int u,int fa,int root)\n{\n\tdp[u] = 1;\n\tfor(int i = head[u],v;i;i = e[i].nxt) if((v = e[i].to) != fa)\n\t\tif((a[root] > a[v] || a[root] == a[v] && root >= v) && a[root] - a[v] <= d)\n\t\t\tdfs(v,u,root),dp[u] = (dp[u] + dp[u] * dp[v]) % mod;\n}\nint main()\n{\n\td = read(),n = read();\n\tfor(int i = 1;i <= n;i++) a[i] = read();\n\tfor(int i = 1;i < n;i++) add_edge(read(),read());\n\tfor(int i = 1;i <= n;i++) dfs(i,-1,i),ans = Mod(ans + dp[i]);\n\tfprint(ans);\n}\n\n```",
        "postTime": 1594025052,
        "uid": 53994,
        "name": "81179332_",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF486D \u3010Valid Sets\u3011"
    },
    {
        "content": "\u8fd9\u4e2a\u6811\u5f62 DP \u633a\u6709\u610f\u601d\u7684\u3002\n\n\u5b9a\u4e49\u4e00\u4e2a\u70b9  $u$ \u6bd4\u4e00\u4e2a\u70b9 $v$ \u597d\uff0c\u5f53\u4e14\u4ec5\u5f53 $a_u>a_v$ \u6216\u8005 $a_u=a_v$ \u4e14 $u<v$\u3002\n\n\u8bbe $f(u)$ \u4e3a $u$ \u5b50\u6811\u4e2d\uff0c$u$ \u4e3a\u8fde\u901a\u5757\u4e2d\u7684\u6700\u597d\u7684\u8282\u70b9\u4e14 $a_p$ \u6bd4 $a$ \u6700\u5c0f\u7684\u8282\u70b9\u5927\u4e0d\u8d85\u8fc7 $d$\uff08\u6ce8\uff1a\u82f1\u6587\u539f\u9898\u9762\u662f\u5dee $\\le d$ \u800c\u975e $<d$\uff09\u3002\n\n\u4e3a\u4e86\u8ba1\u7b97\u51fa\u6bcf\u4e00\u4e2a\u70b9 $p$ \u4f5c\u4e3a\u6700\u5927\u503c\u7684\u60c5\u51b5\uff0c\u6211\u4eec\u9700\u8981\u679a\u4e3e\u6bcf\u4e00\u4e2a $p$\uff0c\u7136\u540e\u6c42\u51fa $p$\u3002\n\n\u8fd9\u6837\u8bbe\u6709\u4ec0\u4e48\u597d\u5904\u5462\uff1f\u65b9\u4fbf\u8f6c\u79fb\uff01\u8fd9\u6837\u8f6c\u79fb\u7684\u65f6\u5019\uff0c\u5c31\u4e0d\u9700\u8981\u518d\u53bb\u8003\u8651\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\u7684\u5dee\u4e86\uff0c\u53ea\u9700\u8981\u8003\u8651\u6700\u5927\u503c\u548c $u$ \u7684\u5dee\u5373\u53ef\u3002\n\n\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$\nf(u)=\\prod (1+f(v)) \n$$\n\n\u5176\u4e2d $v$ \u5fc5\u987b\u8981\u6ee1\u8db3\u4e0d\u6bd4 $p$ \u66f4\u597d\u4e14\u5dee\u4e0d\u5927\u4e8e $d$\u3002\n\n---\n\n\u7406\u4e00\u4e0b\u601d\u8def\uff0c\u5176\u5b9e\u5c31\u662f\u9009\u53d6\u4e00\u4e2a\u201c\u6839\u8282\u70b9\u201d\uff0c\u7136\u540e\u518d\u8fd9\u4e2a\u6839\u8282\u70b9\u7684\u73af\u5883\u4e0b\u53bb\u505a DP\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int N=2009,mod=1e9+7;\n\nstruct edge {int to,nxt;}e[N*2]; int hd[N],tot;\nvoid add(int u,int v) {e[++tot]=(edge){v,hd[u]};hd[u]=tot;}\n\nint n,d,a[N],f[N],ans;\nbool better(int u,int v) {return a[u]>a[v]||a[u]==a[v]&&u<v;}\nvoid dfs(int u,int fa,int p) {\n\tf[u]=1;\n\tfor(int i=hd[u],v;i;i=e[i].nxt) {\n\t\tif((v=e[i].to)==fa) continue;\n\t\tif((!better(p,v))||a[p]-a[v]>d) continue;\n\t\tdfs(v,u,p);\n\t\t(f[u]*=(f[v]+1))%=mod;\n\t}\n}\n\nsigned main() {\n\tscanf(\"%lld%lld\",&d,&n);\n\tfor(int i=1;i<=n;i++) scanf(\"%lld\",&a[i]);\n\tfor(int i=1,u,v;i<n;i++)\n\t\tscanf(\"%lld%lld\",&u,&v), add(u,v), add(v,u);\n\tfor(int i=1;i<=n;i++) dfs(i,0,i), (ans+=f[i])%=mod;\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1600703445,
        "uid": 180652,
        "name": "_lgswdn",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF486D \u3010Valid Sets\u3011"
    },
    {
        "content": "\u5b9a\u4e49dp[i]\u8868\u793a\u6746\u8282\u70b9i\u7684\u5b50\u6811\u4e2d\u6709\u591a\u5c11\u4e2a\u8282\u70b9\uff0c\u5bf9\u4e8e\u4e00\u5272\u63a5\u70b9\u7684\u6240\u6709\u8054\u901a\u5757\u7684\u4e2a\u6570\u5c31\u662f$dp[u]*=(dp[v]+1)$,\u5bf9\u4e8e\u8fd9\u9053\u9898\uff0c\u89c2\u5bdf\u6570\u636e\u8303\u56f4\u53ef\u5f97\u77e5\u590d\u6742\u5ea6\u662f$O(n^2)$\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u6bcf\u6b21\u56fa\u5b9a\u4e00\u4e2a\u70b9\uff0c\u786e\u5b9a\u5b83\u4e3a\u5f53\u524d\u6700\u5c0f\u503c\uff0c\u7136\u540e\u4fdd\u8bc1\u6bcf\u6b21\u5411\u4e0b\u9012\u5f52\u7684\u65f6\u5019\u4fdd\u8bc1val[v]\u5927\u4e8e\u5f53\u524d\u7684\u6839\u5c31\u884c\u4e86\uff0c\u4f46\u662f\u6709\u4e2a\u5f88\u5751\u7684\u5730\u65b9\u662f\uff0c\u6743\u503c\u662f\u53ef\u4ee5\u76f8\u7b49\u7684\uff0c\u90a3\u4e48\u5c31\u4f1a\u9020\u6210\u591a\u6b21\u7edf\u8ba1\uff0c\u6240\u4ee5\u6211\u4eec\u8fd9\u91cc\u5f3a\u884c\u89c4\u5b9a\u6743\u503c\u76f8\u7b49\u7684\u53ea\u80fd\u548c\u6bd4\u4ed6\u5e8f\u53f7\u5927\u7684\u70b9\u8fdb\u884c\u8ba1\u6570\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u9519\u4e86\u3001\n\n~~~\n#include<bits/stdc++.h>\n#define pts putchar('\\n');\n#define ptc putchar(' ');\n#define rep(i,a,b) for(int i=(a);i<=(b);++i)\nusing namespace std;\ntypedef long long ll;\ntypedef long long ll;\nconst int maxm=2e6+9;\nconst int maxn=2e6+9;\nconst int N=200+9;\nconst int inf=0x3f3f3f3f;\nconst int base=131;\nconst int mod=1e9+7;\nconst double eps=1e-4;\nint n,d;\nint val[maxn],sze[maxn];\nvector<int>G[maxn];\nll ans=0;\nint read(){\n    int a=1,b=0;char c=getchar();\n    while(c>'9'||c<'0'){if(c=='-') a=-1;c=getchar();}\n    while(c>='0'&&c<='9'){b=(b<<1)+(b<<3)+(c^'0');c=getchar();}\n    return a*b;\n}\nvoid print(ll x){\n    if(x<0) putchar('-'),x=-x;\n    if(x>9) print(x/10);\n    putchar(x%10+'0');\n}\nll dfs(int now,int fa,int root){\n\tll ret=1;\n\tfor(int i=0,k=G[now].size();i<k;++i){\n\t\tint to=G[now][i];\n\t\tif(to==fa) continue;\n\t\tif(val[to]-val[root]>d||val[root]>val[to]) continue;\n\t\tif(val[to]==val[root]&&to<root) continue;\n\t\tret+=(ret*(dfs(to,now,root))%mod)%mod;\n\t\tret%=mod;\n\t}\n\treturn ret;\n}\nint main(){\n//\tfreopen(\"4.in\",\"r\",stdin);\n//\tfreopen(\"test.txt\",\"w\",stdout); \n  \td=read(),n=read();\n  \trep(i,1,n) val[i]=read();\n  \trep(i,1,n-1){\n  \t\tint u=read(),v=read();\n  \t\tG[u].push_back(v);\n  \t\tG[v].push_back(u);\n\t}\n\trep(i,1,n){\n\t\tans=(ans+dfs(i,0,i))%mod;\n\t}\n\tprint(ans);\n    return 0;\n}\n\n~~~",
        "postTime": 1552790774,
        "uid": 64593,
        "name": "Mr_cold",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 CF486D \u3010Valid Sets\u3011"
    },
    {
        "content": "[\u6211\u7684\u535a\u5ba2](https://blog.csdn.net/qq_35019468/article/details/101900500)\n\n\u6811\u5f62DP\u3002\n\n\u8bbe$dp[i]$\u8868\u793a\u5728\u4ee5$i$\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u80fd\u6709\u591a\u5c11\u4e2a\u8054\u901a\u5b50\u56fe\u3002\n\n\u6bcf\u6b21\u4ee5\u4e00\u4e2a\u70b9\u4e3a\u6839\uff0c\u6c42\u51fa\u6700\u5927\u8054\u901a\u5b50\u56fe\u6570\u91cf\u3002\n\n\u56e0\u4e3a\u6211\u4eec\u8981\u6709\u987a\u5e8f\uff08\u53bb\u91cd\uff09\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u5c06\u6bcf\u4e00\u6b21\u7684\u6839\u8bbe\u4e3a$a$\u503c\u6700\u5927\u7684\u4e00\u4e2a\uff0c\u53bbDP\u3002\n\n\u4f46\u662f\u8fd9\u6837\u8fd8\u662f\u4f1a\u6709\u91cd\u590d\uff0c\u56e0\u4e3a\u5f53$a[root]==a[son]$\u65f6\uff0c$root$\u53ef\u4ee5\u66f4\u65b0$son$,$son$\u4e5f\u53ef\u4ee5\u66f4\u65b0$root$,\u6240\u4ee5\u6211\u4eec\u8981\u5728$a[root]==a[son]$\u65f6\uff0c\u9650\u5236\u53ea\u80fd\u4ece\u7f16\u53f7\u5927\u7684\u8bbf\u95ee\u7f16\u53f7\u5c0f\u7684\u3002\n\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n#### $dp[u]+=dp[u]*dp[v]$\uff08\u7531\u513f\u5b50\u4e2d\u53ef\u4ee5\u7684\u8054\u901a\u5b50\u56fe\u548c\u81ea\u5df1\u4e2d\u7684\u8054\u901a\u5b50\u56fe\uff0c\u4e58\u6cd5\u539f\u7406\uff09\u3002\n\n\u5224\u65ad\u6761\u4ef6\uff1a\n```cpp\nif(v!=fa&&(a[root]>a[v]||(a[root]==a[v]&&v<=root))&&a[root]-a[v]<=k)\n{\n\tdfs(v,u,root);\n\tdp[u]=(dp[u]+1ll*dp[u]*dp[v])%mod;\n}\n```\n\n```cpp\n#include<bits/stdc++.h>\n#define mod 1000000007\n#define N 2010\nusing namespace std;\nint ans,dp[N],head[N],to[N<<1],nxt[N<<1],a[N],n,k,x,y,cnt;\nvoid adde(int x,int y)\n{\n\tto[++cnt]=y;\n\tnxt[cnt]=head[x];\n\thead[x]=cnt;\n}\nvoid dfs(int u,int fa,int root)\n{\n\tdp[u]=1;\n\tfor(int i=head[u];i;i=nxt[i])\n\t{\n\t\tint v=to[i];\n\t\tif(v!=fa&&(a[root]>a[v]||(a[root]==a[v]&&v<=root))&&a[root]-a[v]<=k)//\u8fd9\u4e9b\u5224\u65ad\u6761\u4ef6\u90fd\u662f\u4e3a\u4e86\u53bb\u91cd\n\t\t{\n\t\t\tdfs(v,u,root);\n\t\t\tdp[u]=(dp[u]+1ll*dp[u]*dp[v])%mod;\n\t\t}\n\t}\n}\nint main()\n{\n\tscanf(\"%d%d\",&k,&n);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&a[i]);\n\t}\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tadde(x,y);\n\t\tadde(y,x);\n\t}\n\tfor(int i=1;i<=n;i++)//\u4ee5\u6bcf\u4e00\u4e2a\u70b9\u4e3a\u6839\n\t{\n\t\tdfs(i,-1,i);\n\t\tans=(ans+dp[i])%mod;\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1569978286,
        "uid": 103334,
        "name": "Honor\u8a89",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF486D \u3010Valid Sets\u3011"
    },
    {
        "content": "[\u535a\u5ba2\u56ed\u98df\u7528](https://www.cnblogs.com/yizhixiaoyun/p/17301307.html)\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF486D)\n\n## \u9898\u76ee\u5206\u6790\n\n\u4e0d\u7b97\u5f88\u96be\u7684\u6811\u5f62 $\\text{dp}$\u3002\n\n\u4ee4 $dp_i$ \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u4e2d\u8054\u901a\u5b50\u56fe\u7684\u4e2a\u6570\u3002\n\n\u5728\u66f4\u65b0\u7684\u65f6\u5019\uff0c\u8003\u8651\u513f\u5b50\u7684\u8054\u901a\u5b50\u56fe\u548c\u81ea\u5df1\u7684\uff0c\u5219\u6709\uff1a\n\n$$dp_u = dp_u \\times (dp_v + 1)$$\n\n\u9009\u6839\u7684\u65f6\u5019\u5c06 $a$ \u6700\u5927\u7684\u4f5c\u4e3a\u6839\u8282\u70b9\u3002\u8fd8\u8981\u6ce8\u610f\u53e6\u5916\u4e00\u70b9\uff0c\u5c31\u662f\u5f53 $a_{fa}=a_{v}$ \u65f6\uff0c\u53cc\u65b9\u4e92\u76f8\u90fd\u53ef\u4ee5\u66f4\u65b0\uff0c\u6240\u4ee5\u4f1a\u51fa\u73b0\u95ee\u9898\u3002\u6b64\u65f6\u5c06\u6839\u8282\u70b9\u8bbe\u4e3a\u7f16\u53f7\u5927\u7684\u90a3\u4e2a\u5373\u53ef\u3002\n\n## \u8d34\u4e0a\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define debug puts(\"Shiina_Mashiro_kawaii\")\n#define ok puts(\"Yes\")\n#define no puts(\"No\")\n#define inf 1e9\nusing namespace std;\nint read(){\n\tint x=0,f=1;char c=getchar();\n\twhile(c<'0'||c>'9'){\n\t\tif(c=='-') f=-1;\n\t\tc=getchar();\n\t}\n\twhile(c>='0'&&c<='9'){\n\t\tx=x*10+c-48;\n\t\tc=getchar();\n\t}\n\treturn x*f;\n}\nconst int maxn=2e5+5;\nconst int mod=1e9+7;\nint n,d;\nint ans;\nint a[maxn];\nint dp[maxn];\nint cnt_edge,head[maxn];\nstruct edge{\n\tint to,nxt;\n}e[maxn<<1];\nvoid add(int u,int v){\n\te[++cnt_edge].nxt=head[u];\n\te[cnt_edge].to=v;\n\thead[u]=cnt_edge;\n}\nvoid dfs(int u,int fa,int rt){\n\tdp[u]=1;\n\tfor(register int i=head[u];i;i=e[i].nxt){\n\t\tint v=e[i].to;\n\t\tif(v==fa) continue;\n\t\tif((a[v]==a[rt]&&v<rt)||(a[v]-a[rt]>d||a[rt]>a[v])) continue;\n\t\tdfs(v,u,rt);\n\t\tdp[u]*=dp[v]+1;dp[u]%=mod;\n\t}\n}\ninline void init(){\n\td=read();n=read();\n\tfor(register int i=1;i<=n;++i) a[i]=read();\n\tfor(register int i=1;i<n;++i){\n\t\tint u=read(),v=read();\n\t\tadd(u,v);add(v,u);\n\t}\n}\nsigned main(){\n\tinit();\n\tfor(register int i=1;i<=n;++i){\n\t\tdfs(i,0,i);\n\t\tans+=dp[i];ans%=mod;\n\t}\n\tprintf(\"%d\",ans);\n}\n```",
        "postTime": 1681050445,
        "uid": 590864,
        "name": "Yizhixiaoyun",
        "ccfLevel": 5,
        "title": "CF486D \u9898\u89e3"
    },
    {
        "content": "### \u9898\u610f\u7b80\u8ff0\n\n> \u7ed9\u4f60\u4e00\u68f5\u6811\uff0c\u70b9\u6709\u70b9\u6743\uff0c\u6c42\u8fd9\u68f5\u6811\u7684\u6ee1\u8db3\u6700\u5927\u70b9\u6743\u4e0e\u6700\u5c0f\u70b9\u6743\u4e4b\u5dee\u5c0f\u4e8e\u7b49\u4e8e $k$ \u7684\u8fde\u901a\u5b50\u56fe\u7684\u4e2a\u6570\u3002\n> \n> \uff08\u8c8c\u4f3c\u6d1b\u8c37\u9898\u9762\u91cc\u6ca1\u5199\uff09$1\\le n\\le 2000$\u3002\n\n### \u5206\u6790\n\n\u6bd4\u8f83\u7b80\u5355\u7684\u4e00\u9053\u9898\u3002\n\n\u9996\u5148\u6211\u4eec\u8003\u8651\u679a\u4e3e\u6700\u5c0f\u70b9\u6743\u51fa\u73b0\u5728\u54ea\u4e2a\u70b9\uff08\u5f53\u7136\uff0c\u679a\u4e3e\u6700\u5927\u70b9\u6743\u4e5f\u80fd\u505a\uff09\u3002\n\n\u90a3\u4e48\u56e0\u4e3a $n\\le 2000$ \u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u4ece\u8fd9\u4e2a\u70b9\u51fa\u53d1\u5f00\u59cb `dfs`\uff0c\u627e\u4ee5\u5b83\u4e3a\u6700\u5c0f\u8282\u70b9\u7684\u8fde\u901a\u5b50\u56fe\u6700\u5927\u6269\u5c55\u5230\u54ea\u91cc\u3002\n\n`dfs`\u7684\u65b9\u6cd5\u5f88\u7b80\u5355\uff0c\u5982\u679c\u679a\u4e3e\u7684\u6700\u5c0f\u70b9\u6743\u662f $x$\uff0c\u90a3\u4e48\u53ea\u80fd\u5728\u5f53\u524d\u641c\u5230\u7684\u8282\u70b9\u6743 $v$ \u6ee1\u8db3 $x\\le v\\le x+d$ \u65f6\u624d\u80fd\u63a5\u7740\u641c\u3002\n\n\u7136\u540e\u8fd9\u91cc\u5982\u679c\u6709\u4e24\u4e2a\u70b9\u70b9\u6743\u91cd\u590d\u4f1a\u91cd\u7b97\uff0c\u6240\u4ee5\u6211\u4eec\u5e94\u8be5\u5728 $v=x$ \u65f6\u68c0\u67e5\u641c\u5230\u7684\u8282\u70b9\u7f16\u53f7\u5927\u4e8e\u6700\u5c0f\u70b9\u6743\u7684\u7f16\u53f7\uff08\u6216\u8005\u8bf4\u628a\u70b9\u6743\u7684\u6bd4\u8f83\u5f04\u4e00\u4e2a\u7b2c\u4e8c\u4f18\u5148\u7ea7\u662f\u70b9\u7684\u7f16\u53f7\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1a\u91cd\u590d\uff09\u3002\n\n\u627e\u51fa\u8fd9\u4e2a\u5b50\u56fe\u4e4b\u540e\u6211\u4eec\u53ef\u4ee5\u5728\u4e0a\u9762\u6811\u5f62 DP\uff0c$f_i$ \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u5185\u53d6\u5230 $i$ \u7684\u8fde\u901a\u5b50\u56fe\u6709\u591a\u5c11\u79cd\u65b9\u6848\uff0c\u5219\n\n$$f_x=\\prod_{y\\in son_x}f_y+1$$\n\n\u7136\u540e\u5c31\u6ca1\u6709\u7136\u540e\u4e86\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nconst ll mod=1e9+7;\nint n,d;\nint a[2005];\nvector<int> edge[2005];\nll dp[2005];\nvoid dfs(int x,int f,int v){\n\tif(a[x]<a[v]||a[x]==a[v]&&x>v||a[x]>a[v]+d)return;\n\tdp[x]=1;\n\tfor(int y:edge[x])\n\t\tif(y!=f){\n\t\t\tdfs(y,x,v);\n\t\t\tdp[x]=dp[x]*(dp[y]+1)%mod;\n\t\t}\n}\nint main(){\n\tscanf(\"%d%d\",&d,&n);\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",&a[i]);\n\tfor(int i=1;i<n;i++){\n\t\tint x,y;\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tedge[x].push_back(y);\n\t\tedge[y].push_back(x);\n\t}\n\tll ans=0;\n\tfor(int i=1;i<=n;i++){\n\t\tmemset(dp,0,sizeof(dp));\n\t\tdfs(i,0,i);\n\t\tans=(ans+dp[i])%mod;\n\t}\n\tprintf(\"%lld\\n\",ans);\n\t// system(\"pause\");\n\treturn 0;\n}\n```",
        "postTime": 1642759898,
        "uid": 233462,
        "name": "Umbrella_Leaf",
        "ccfLevel": 8,
        "title": "\u9898\u89e3CF486D Valid Sets"
    }
]
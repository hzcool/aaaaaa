[
    {
        "content": "[CF913G Power Substring](https://www.luogu.com.cn/problem/CF913G)\n\n---\n\n\u770b\u8d77\u6765\u662f\u6784\u9020\u9898\u4f46\u5176\u5b9e\u662f\u6570\u5b66\u9898\u3002\u5bf9\u4e8e\u8fd9\u79cd\u6570\u7684\u6784\u9020\u9898\u5c31\u53bb\u6784\u9020\u4e00\u79cd\u60c5\u51b5\u7136\u540e\u7b97\u51fa\u6765\u3002\n\n\u5047\u8bbe $a$ \u6709 $n$ \u4f4d\uff0c\u679a\u4e3e\u540e\u9762\u6709\u591a\u5c11\u4f4d $m$ \uff0c\u8bbe $x = a\\times 10^m + b , 2^k \\bmod{ 10^{n+m} } = x$ \u3002\n\n\u5f53 $m$ \u786e\u5b9a\uff0c\u90a3\u4e48 $b$ \u80fd\u53d6\u4e00\u6bb5 $10^m$ \u4e2a\u4e0d\u540c\u7684\u6570\uff0c\u5f53 $10^m \\ge 2^{n+m}$ \u65f6\u4e00\u5b9a\u6709\u89e3\u3002\n\n\u6211\u4eec\u9700\u8981\u505a\u4e24\u6b65\uff1a\u7b97 $b$ \uff0c\u7b97 $k$ \u3002\n\n\u8bbe $k\\ge n+m$ \u3002\u6240\u4ee5 $2^{n+m} | 2^k , 2^{n+m}|10^{n+m}$ \u6240\u4ee5 $2^{n+m} | a\\times 10^m + b$ \u3002\n\n\u540c\u65f6\u7531\u4e8e $5 \\nmid 2^k$ \uff0c\u6240\u4ee5 $5^{n+m} \\nmid 2^k , 5^{n+m} \\nmid a\\times 10^m + b$ \u3002\n\n\u6784\u9020 $b=-a\\times {10}^{m} \\bmod 2^{n+m}$ \uff0c\u5982\u679c $b$ \u4e3a $5$ \u7684\u500d\u6570\u5c31\u518d\u52a0\u4e0a $2^{n+m}$ \uff0c\u8fd9\u6837 $a\\times 10^m +b$ \u7b26\u5408\u6761\u4ef6\u3002\uff08\u6b64\u65f6\u8fd8\u8981\u6ee1\u8db3 $10^m \\ge 2^{n+m}$ \uff09\n\n------\n\n\u8ba9\u521a\u624d\u7684\u540c\u4f59\u5f0f\u5b50\u4e24\u8fb9\u9664\u4ee5 $2^{n+m}$ \u5f97\u5230 $2^{k-n-m} \\bmod{ 5^{n+m} } = \\dfrac{a\\times 10^m + b}{ 2^{n+m} }$ \u3002\n\n\u7531\u4e8e $2$ \u662f $5^m$ \u7684\u539f\u6839\uff0c\u6211\u4eec\u53ef\u4ee5\u6784\u9020\u51fa $k$ \u3002\n\n\u8fd9\u91cc\u4e0d\u80fd\u76f4\u63a5 BSGS \u4e86\u3002\u4f46\u53ef\u4ee5\u4e00\u6b65\u6b65\u5f52\u7eb3\u6784\u9020\uff1a\n\n\u9996\u5148\u66b4\u529b\u51fa $d_1$ \u4f7f\u5f97 $2^{d_1}  \\equiv x \\pmod 5$ \u3002\n\n\u7136\u540e\u6c42 $d_i$ \u4f7f\u5f97 $2^{d_i} \\equiv x\\pmod {5^i}$ \u3002\u53ef\u4ee5\u66b4\u529b\u679a\u4e3e $d_{i-1}+j\\times \\varphi(5^{i-1}),j=0\\sim 4$ \uff0c\u4e00\u5b9a\u6709\u4e00\u4e2a\u6ee1\u8db3\u3002\uff08\u8fd9\u4e2a\u7ed3\u8bba\u4e0d\u592a\u4f1a\u8bc1\uff09\n\nCF \u4e0d\u8ba9\u7528 `__int128` \uff0c\u53ea\u80fd\u7528\u9f9f\u901f\u4e58\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define For(i,a,b) for(register int i=(a);i<=(b);++i)\n#define Rep(i,a,b) for(register int i=(a);i>=(b);--i)\n#define int long long \nusing namespace std;\ninline int read()\n{\n    char c=getchar();int x=0;bool f=0;\n    for(;!isdigit(c);c=getchar())f^=!(c^45);\n    for(;isdigit(c);c=getchar())x=(x<<1)+(x<<3)+(c^48);\n    if(f)x=-x;return x;\n}\n\ninline int mul(int x,int y,int mod){\n\tint res=0;\n\twhile(y){\n\t\tif(y&1)res=(res+x)%mod;\n\t\ty>>=1,x=(x<<1)%mod;\n\t}return res;\n}\ninline int qpow(int x,int y,int mod){\n\tint res=1;\n\twhile(y){\n\t\tif(y&1)res=mul(res,x,mod);\n\t\ty>>=1,x=mul(x,x,mod);\n\t}return res;\n}\n\nvoid work()\n{\n\tint a=read(),qwq=a,n=0;\n\twhile(qwq)++n,qwq/=10;\n\tfor(int pw10=10,m=1;;m++,pw10*=10)\n\t{\n\t\tint mod=(1ll<<(n+m));\n\t\tif(pw10<mod) continue;\n\t\tint b=(-a*pw10%mod+mod)%mod;\n\t\tif(b%5==0) b+=mod;\n\t\tif(b>=pw10)continue;\n\t\tint x=(a*pw10+b)/mod;\n\t\tint phi=4,pw5=25,res;\n\t\tFor(i,0,4)\n\t\t\tif(qpow(2,i,5)==x%5){res=i;break;}\n\t//\tcout<<\"res \"<<res<<\" \"<<x<<endl;\n\t\tfor(int i=2;i<=n+m;++i,phi*=5,pw5*=5){\n\t\t\tFor(j,0,4)\n\t\t\t\tif(qpow(2,res+phi*j,pw5)==x%pw5){\n\t\t\t\t\tres+=phi*j;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t}\n\t\tres+=m+n;\n\t\tcout<<res<<endl;\n\t\treturn;\n\t}\n}\n\nsigned main()\n{\n\tint T=read();\n\twhile(T--)work();\n\treturn 0;\n}\n```",
        "postTime": 1624246162,
        "uid": 151935,
        "name": "Rainbow_qwq",
        "ccfLevel": 0,
        "title": "CF913G Power Substring"
    },
    {
        "content": "\u5f88\u6709\u8da3\u7684\u6784\u9020\u9898\u3002\n\n\u7ea6\u5b9a\uff1a$B$ \u8fdb\u5236\u6570\u7684\u7b2c $d$ \u4f4d\u6307\u7684\u662f $B^d$ \u8fd9\u4e00\u4f4d\u3002\n\n\u6211\u4eec\u8003\u8651\u5728\u4ec0\u4e48\u4f4d\u7f6e\u8ba9 $a$ \u51fa\u73b0\u3002\n\n\u7531\u4e8e $a$ \u4e0d\u8d85\u8fc7 $11$ \u4f4d\uff0c\u4e0d\u59a8\u5047\u8bbe\u662f\u5728 $[d-11,d-1]$ \u8fd9\u4e9b\u4f4d\u91cc\u586b\u4e86 $a$\u3002\n\n\u53ea\u9700\u8981\u8003\u8651 $b=2^{k}\\bmod 10^d$ \u7684\u53d6\u503c\u60c5\u51b5\u3002\n\n\u5f53 $k\\ge d$ \u7684\u65f6\u5019\uff0c$2^d|b$\u3002\n\n\u6211\u4eec\u58f0\u79f0\uff1a\u53ea\u9700\u8981\u8003\u8651 $k\\ge d$ \u7684\u60c5\u51b5\u5c31\u53ef\u4ee5\u6784\u9020\u51fa\u89e3\u3002\n\n\u4e8e\u662f\u53ea\u9700\u8981\u8003\u8651 $\\dfrac{b}{2^d}=2^{k-d}\\bmod 5^d$ \u7684\u53d6\u503c\u60c5\u51b5\u3002\n\n\u6211\u4eec\u5e0c\u671b $2$ \u662f $5^d$ \u7684\u4e00\u4e2a\u539f\u6839\uff0c\u8fd9\u6837 $2^{k-d}\\bmod 5^d$ \u5c31\u53ef\u4ee5\u8986\u76d6\u6240\u6709\u4e0d\u662f $5$ \u7684\u500d\u6570\u7684\u6570\u3002\u6682\u65f6\u5148\u5047\u8bbe\u8fd9\u4e00\u70b9\u662f\u6210\u7acb\u7684\u3002\n\n$b$ \u7684\u524d $11$ \u4f4d\u5df2\u7ecf\u88ab\u56fa\u5b9a\u4e0b\u6765\uff0c\u5982\u679c\u8981\u4e00\u5b9a\u80fd\u6784\u9020\u89e3\uff0c\u90a3\u4e48\u53ea\u9700\u8981\u6ee1\u8db3 $10^{d-11}\\ge 2^{d+1}$\uff0c\u5373\u81f3\u5c11\u6709**\u4e24\u4e2a** $2^d$ \u7684\u500d\u6570\u6ee1\u8db3\u524d $11$ \u4f4d\u4e3a $a$\u3002\n\n\u8981\u6c42\u6709\u4e24\u4e2a\u800c\u4e0d\u662f\u4e00\u4e2a\u662f\u4e3a\u4e86\u907f\u514d $5$ \u7684\u500d\u6570\u8fd9\u79cd\u7279\u6b8a\u60c5\u51b5\uff0c\u800c\u76f8\u90bb\u4e24\u4e2a\u6b63\u6574\u6570\u91cc\u81f3\u5c11\u6709\u4e00\u4e2a\u4e0d\u662f $5$ \u7684\u500d\u6570\u3002\n\n\u6839\u636e\u4e0a\u9762\u8fd9\u4e2a\u5f0f\u5b50\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 $d\\ge 17$\u3002\u90a3\u4e48\u6211\u4eec\u76f4\u63a5\u53d6 $d=17$\uff0c\u968f\u4fbf\u5199\u4e2a\u4ee3\u7801\u9a8c\u8bc1\u4e00\u4e0b\u5373\u53ef\u53d1\u73b0 $2$ \u662f $5^{17}$ \u7684\u4e00\u4e2a\u539f\u6839\uff0c\u56e0\u6b64\u4e0a\u9762\u8bf4\u7684\u6784\u9020\u65b9\u6cd5\u53ef\u4ee5\u6210\u7acb\u3002\n\n\u73b0\u5728\u6211\u4eec\u5f97\u5230\u4e86 $b$\uff0c\u4e14 $b=2^{k-17}\\mod 5^{17}$\uff0c\u5982\u4f55\u6c42\u51fa $k$ \u5462\uff1f\n\n\u4e00\u4e2a\u76f4\u89c2\u7684\u60f3\u6cd5\u662f\u76f4\u63a5\u66b4\u529b BSGS\uff0c\u590d\u6742\u5ea6\u5c31\u8fc7\u5927\u4e86\u3002\n\n\u8003\u8651\u5728 $5$ \u8fdb\u5236\u4e0b\u6309\u4f4d\u6784\u9020\uff0c\u5047\u8bbe\u76ee\u524d\u5df2\u7ecf\u6784\u9020\u51fa\u4e86 $k$ \u6ee1\u8db3 $b\\equiv 2^k\\pmod{5^{d-1}}$\uff0c\u6211\u4eec\u9700\u8981\u5bf9 $5$ \u8fdb\u5236\u4e0b\u7684\u7b2c $d$ \u4f4d\u8fdb\u884c\u8c03\u6574\u3002\n\n\u53ef\u4ee5\u652f\u6301\u7684\u64cd\u4f5c\u53ea\u6709\u4e58\u6cd5\uff0c\u4e00\u79cd\u60f3\u6cd5\u662f\u5bf9\u4e8e\u6bcf\u4e2a $d$ \u627e\u5230\u4e00\u4e2a $w_d$ \u6ee1\u8db3 $5^d+1=2^{w_d}\\mod 5^{17}$\u3002\u53ef\u4ee5\u53d1\u73b0\uff0c\u4e0d\u65ad\u5730\u7ed9 $k$ \u52a0\u4e0a $w_d$ \u7684\u8fc7\u7a0b\u4e2d\uff0c$2^k$ \u5728 $5$ \u8fdb\u5236\u4e0b\u7684 $5^d$ \u8fd9\u4e00\u4f4d\u4f1a\u904d\u5386 $[0,4]$ \u4e2d\u7684\u6bcf\u4e00\u4e2a\u6570\u3002\u56e0\u6b64\uff0c\u4e00\u5b9a\u5b58\u5728\u4e00\u4e2a\u65f6\u523b\u6ee1\u8db3 $b\\equiv 2^{k}\\pmod{5^d}$\u3002\n\n\u73b0\u5728\u6211\u4eec\u53ea\u9700\u8981\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $d$ \u6c42\u51fa $w_d$ \u6ee1\u8db3 $5^d+1=2^{w_d}\\bmod 5^{17}$\uff0c\u76f4\u63a5 BSGS \u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\sqrt{n}\\log n+T\\log n)$\uff0c\u5df2\u7ecf\u80fd\u591f\u901a\u8fc7\u672c\u9898\u3002\n\n\u4f46\u5b9e\u9645\u4e0a\u6211\u4eec\u8fd8\u6709\u66f4\u52a0\u667a\u6167\u7684\u6784\u9020\u65b9\u5f0f\u3002\u5bf9 $w_d$ \u7684\u4f5c\u7528\u8fdb\u884c\u5206\u6790\u53ef\u4ee5\u53d1\u73b0\uff0c\u6211\u4eec\u5b9e\u9645\u4e0a\u53ea\u9700\u8981\u4fdd\u8bc1 $c\\times 5^d+1\\equiv 2^{w_d}\\pmod{5^{d+1}}$\uff0c\u5176\u4e2d $c\\in [1,4]$\u3002\u6784\u9020 $w_d=\\varphi(5^d)$\uff0c\u5bb9\u6613\u8bc1\u660e\u8fd9\u4e2a\u6784\u9020\u65b9\u6cd5\u4e00\u5b9a\u6ee1\u8db3\u6761\u4ef6\u3002\n\n\u4ee3\u7801\u975e\u5e38\u597d\u5199\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(T\\log n)$\u3002\n\n\u53c2\u8003\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define N 25\n#define ll long long\n#define lll __int128\nint T;ll n,nw,ans,pw[N],w[N],w1[N];\nvoid init()\n{\n\tpw[0]=w[0]=1;w[1]=4;w1[0]=2;w1[1]=16;\n\tfor(int i=1;i<=17;++i) pw[i]=pw[i-1]*5;\n\tfor(int i=2;i<17;++i)\n\t{\n\t\tw[i]=w[i-1]*5;\n\t\tw1[i]=(lll)w1[i-1]*w1[i-1]%pw[17];\n\t\tw1[i]=(lll)w1[i]*w1[i]%pw[17];\n\t\tw1[i]=(lll)w1[i]*w1[i-1]%pw[17];\n\t}\n}\nvoid slv()\n{\n\tscanf(\"%lld\",&n);n*=1e6;nw=1;ans=17;\n\tn=((n-1)>>17)+1;if(!(n%5)) ++n;\n\tfor(int i=0;i<17;++i)\n\t\twhile(n%pw[i+1]!=nw%pw[i+1])\n\t\t\tnw=(lll)nw*w1[i]%pw[17],ans+=w[i];\n\tprintf(\"%lld\\n\",ans);\n}\nint main()\n{\n\tscanf(\"%d\",&T);init();\n\twhile(T--) slv();return 0;\n}\n```",
        "postTime": 1655263609,
        "uid": 119621,
        "name": "Kubic",
        "ccfLevel": 10,
        "title": "CF913G Power Substring"
    },
    {
        "content": "# \u9898\u610f\uff1a\n\n $T\\le1000$ \u7ec4\u8be2\u95ee\uff0c\u6bcf\u7ec4\u7ed9\u51fa\u4e00\u4e2a\u6570$ a\\le 10^{11}$\uff0c\u8ba9\u4f60\u9009\u5b9a\u4e00\u4e2a\u6570 $k$ \u4f7f\u5f97 $2^k$ \u7684\u5341\u8fdb\u5236\u8868\u793a\u4e2d\u7684\u672b 100 \u4f4d\u4e2d\u5305\u542b $a$ \u4f5c\u4e3a\u5b50\u4e32\u3002\n\n# \u9898\u89e3\uff1a\n\n\u8003\u8651\u91cd\u65b0\u63cf\u8ff0\u4e00\u4e0b\u9898\u76ee\u7684\u5b50\u4e32\u7684\u9650\u5236\u3002\n\n\u9996\u5148\u5bf9\u4e8e\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u8fd9\u4e2a\u5b50\u4e32\u5728\u672b\u5c3e\u7684\u54ea\u4e2a\u4f4d\u7f6e\uff0c\u5982\u679c\u66b4\u529b\u679a\u4e3e\u4e5f\u6700\u591a\u7528100\u7684\u590d\u6742\u5ea6\uff0c\u8003\u8651\u679a\u4e3e\u4e00\u4e2a $m$\u3002\n\n\u4ee4\u672b $m$ \u4f4d\u4e3a\u4efb\u610f\u6570\uff0c\u4ee4 $n$ \u4e3a $a$ \u7684\u4f4d\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u8981\u6c42\u6709$2^k \\equiv x \\equiv a\\times 10^m +b \\mod 10^{n+m}  $\n\n\u89c2\u5bdf\uff0c\u7531\u4e8e\u81f3\u5c11\u8981\u6709n+m\u4f4d\uff0c\u5219 $k\\ge n+m$\u3002\n\n\u6709 $2^{n+m}|2^{k}$ \uff0c\u6240\u4ee5\u6709 $2^{n+m}|x$ \u3002\n\n\u6709 $5\\not|2^{k}$ \uff0c\u6240\u4ee5\u6709 $5\\not|x$ \u3002\n\n\u4e24\u8fb9\u540c\u9664 $2^{n+m}$ \u6709 $2^{k-(n+m)}\\equiv {x\\over2^{n+m}}\\mod 5^{n+m}$\n\n\u53ef\u4ee5\u53d1\u73b0 $({x\\over2^{n+m}},5)=1$ \uff0c\u53ea\u8981\u4efb\u610f\u5b58\u5728\u4e00\u4e2a $x$ \u6ee1\u8db3\u4ee5\u4e0a\u4e24\u4e2a\u6761\u4ef6\uff0c\u7531\u4e8e\u5bf9\u4e8e\u4efb\u610f $5^\\omega$\uff0c$2$ \u90fd\u4e3a\u539f\u6839\uff0c\u4e8e\u662f\u5bf9\u4e8e\u4efb\u610f\u8fd9\u6837\u7684x\uff0c\u90fd\u53ef\u4ee5\u8fd8\u539f\u51fa\u6765\u4e00\u4e2a $k-(n+m)$ \n\n\u8003\u8651\u8bf4\u600e\u4e48\u6c42\u5f97\u8fd9\u4e2a\u5e42\u6b21\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 BSGS \u7b97\u6cd5\uff0c\u4f46\u662f\u6709\u70b9\u5c0f\u6162\uff0c\u8003\u8651\u9012\u63a8\u6c42\u89e3\uff0c\u6b64\u65f6\u60f3\u8981\u6c42 $2^ {t\\text{'}}\\equiv S \\mod 5^{m+1}$ \n\n\u8003\u8651\u8bf4\u5bf9\u4e8e  $2^ {t\\text{'}}\\equiv S \\mod 5^{m+1}$ \u6210\u7acb\u65f6 $2^ {t\\text{'}}\\equiv S\\mod 5^{m}$ \u4e00\u5b9a\u6210\u7acb\uff0c\u6b64\u65f6\u6211\u4eec\u8bbe\u82e5\u5f53\u524d\u6c42\u51fa\u6765 $2^ t\\equiv S \\mod 5^{m}$ \u5219 $t\\text{'}\\equiv t \\mod \\varphi(5^m)$ \u6240\u4ee5\u679a\u4e3e5\u4e2a\u5373\u53ef\uff0c\u5177\u4f53\u7684\uff0c\u679a\u4e3e $t\\text{'}= t +j \\times \\varphi(5^m)$ $j$ \u5728 [0,4]\u3002\n\n# \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nchar gc(){static char buf[1<<16],*s,*t;if(s==t){t=(s=buf)+fread(buf,1,1<<16,stdin);if(s==t)return EOF;}return *s++;}\n//#define getchar gc\nll read()\n{\n\tchar c;\n\tll w=1;\n\twhile((c=getchar())>'9'||c<'0')if(c=='-')w=-1;\n\tll ans=c-'0';\n\twhile((c=getchar())>='0'&&c<='9')ans=(ans<<1)+(ans<<3)+c-'0';\n\treturn ans*w;\n}\nvoid pc(char c,int op)\n{\n\tstatic char buf[1<<16],*s=buf,*t=buf+(1<<16);\n\t(op||((*s++=c)&&s==t))&&(fwrite(buf,1,s-buf,stdout),s=buf);\n}\n#define __ __int128\nvoid wt(__ x)\n{\n\tif(x>9)wt(x/10);\n\tpc('0'+x%10,0);\n}\nvoid wts(__ x,char op)\n{\n\tif(x<0)pc('-',0),x=-x;\n\twt(x);pc(op,0);\n}\nll a;\n__ ksm(__ a,__ b,__ mod)\n{\n\t__ ans=1;\n\twhile(b)\n\t{\n\t\tif(b&1)ans*=a,ans%=mod;\n\t\ta*=a,a%=mod,b>>=1;\n\t}\n\treturn ans;\n}\nint main(){\n\tint T=read();\n\twhile(T--)\n\t{\n\t\ta=read();\n\t\tint n=0;\n\t\t{\n\t\t\tll x=a;\n\t\t\twhile(x)x/=10,n++;\n\t\t}\n\t\tint m=6;\n\t\t__ mod=1ll<<n+m;\n\t\tll t1=a%mod*ksm(10,m,mod)%mod,t2=mod-t1;\n\t\tif(t2%5==0)t2+=mod;\n\t\t__ x;\n\t\tx=a*ksm(10,m,1e32)+t2;\n\t\tx/=mod;\n\t\tint t=n+m;\n\t\t__ num=25;\n\t\t__ fi=4;\n\t\t__ ans=0;\n\t\tfor(int i=0;i<4;i++)if(ksm(2,i,5)==x%5)ans=i;\n\t\tfor(int i=2;i<=t;i++)\n\t\t{\n\t\t\tfor(int j=0;j<5;j++)\n\t\t\t{\n\t\t\t\tif(ksm(2,ans+fi*j,num)==x%num)\n\t\t\t\t{\n\t\t\t\t\tans+=j*fi;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tnum*=5,fi*=5;\n\t\t}\n\t\twts(ans+t,'\\n');\n\t\tpc('1',1);\n\t}\n\tpc('1',1);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1650938618,
        "uid": 371852,
        "name": "\u4e00\u5ff5\u4e4b\u95f4\u3001\u3001",
        "ccfLevel": 0,
        "title": "CF913G"
    }
]
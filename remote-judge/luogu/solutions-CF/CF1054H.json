[
    {
        "content": "### \u9898\u610f\n\n\u7ed9\u4e24\u4e2a\u4e0b\u6807\u4ece$0$\u5f00\u59cb\u4e14\u957f\u5ea6\u5206\u522b\u4e3a$n,m$\u7684\u5e8f\u5217$A,B$\u548c\u4e00\u4e2a\u5e38\u6570$C$\uff0c\u6c42\uff1a\n\n$$\\sum\\limits_{i=0}^{n-1}\\sum\\limits_{j=0}^{m-1}A_iB_jc^{i^2j^3}$$\n\n\u7b54\u6848\u5bf9$490019$\u53d6\u6a21\u3002\n\n$\\texttt{Data Range:}n,m\\leq 10^5,A_i,B_i\\leq 10^3,c\\leq 490019$\n\n### \u9898\u89e3\n\n\u4ece\u6628\u5929\u665a\u4e0a\u5199\u5230\u4eca\u5929\u665a\u4e0a\uff0c\u73b0\u5728\u7ec8\u4e8e AC \u4e86\uff0c\u5199\u7bc7\u9898\u89e3\u7eaa\u5ff5\u4e00\u4e0b\u3002\n\n[![MNz29I.md.png](https://s2.ax1x.com/2019/11/14/MNz29I.md.png)](https://imgchr.com/i/MNz29I)\n\n\u4e0d\u5f97\u4e0d\u8bf4\u8fd9\u662f\u6211\u505a\u8fc7\u7684\u6700\u6709\u610f\u601d~~\u5e76\u4e14\u6700\u96be~~\u7684\u591a\u9879\u5f0f\u9898\uff0c\u5b9e\u5728\u914d\u5f97\u4e0a\u51fa\u9898\u4eba\u7ed9\u7684 `Epic` \u7684\u79f0\u53f7\u548c CF \u7ed9\u7684 $3400$ \u7684\u8bc4\u5206\u3002\n\n\u8003\u8651\u5230$\\texttt{\\color{black}y\\color{red}wy}$\u7684\u9898\u89e3\u5199\u7684\u6709\u4e00\u70b9\u70b9\u4e71\uff0c\u6211\u6765\u5199\u4e00\u7bc7\u6bd4\u8f83\u597d\u61c2\u7684\uff08\u5f53\u7136\u8fd8\u662f\u8981\u611f\u8c22\u4ed6\u7684\u5566qwq\uff09\n\n\u8fd9\u4e2a\u9898\u76ee\u4e0e\u53e4\u4ee3\u732a\u6587\u90a3\u4e2a\u9898\u6709\u70b9\u50cf\uff0c\u56e0\u4e3a$490019$\u662f\u8d28\u6570\uff0c\u7531\u6b27\u62c9\u5b9a\u7406\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6c42\n\n$$\\sum\\limits_{i=0}^{n-1}\\sum\\limits_{j=0}^{m-1}A_iB_jc^{i^2j^3\\bmod 490018}\\bmod 490019$$\n\n\u53d1\u73b0\u8fd9\u4e2a\u6307\u6570\u53ea\u6709$490018$\u4e2d\u53ef\u80fd\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u6709\u4e00\u4e2a\u60f3\u6cd5\n\n$$C_x=\\sum\\limits_{i=0}^{n-1}\\sum\\limits_{j=0}^{m-1}A_iB_j[i^2j^3\\bmod 490018=x]$$\n\n\u770b\u8fd9\u4e2a\u4e58\u6cd5\u633a\u8ba8\u538c\u7684\uff0c\u663e\u7136\u53ef\u4ee5\u53d6\u4e2a\u79bb\u6563\u5bf9\u6570\u5316\u4e58\u4e3a\u52a0\uff0c\u7136\u540e\u53d1\u73b0\u4e0d\u6653\u5f97\u4ee5\u4ec0\u4e48\u4e3a\u5e95\uff0c\u8003\u8651\u6362\u4e2a\u601d\u8def\u3002\n\n\u8bf6\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a$490018=2\\times 491\\times 499$\u662f\u4e2a$\\texttt{square-free number}$\uff0c\u597d\u554a\u3002\n\n\u5f88\u660e\u663e\u6211\u4eec\u53ef\u4ee5$\\texttt{CRT}$\u5408\u5e76\uff0c\u56e0\u4e3a\u6a21\u6570\u4e92\u8d28\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4e0d\u7528\u4e0a\u62d3\u4e2d\u4e86\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u81ea\u7136\u5730\u8bbe\u4e00\u4e2a\u8fd9\u6837\u7684\u4e1c\u897f\n\n$$C_{x,y,z}=\\sum\\limits_{i=0}^{n-1}\\sum\\limits_{j=0}^{m-1}A_iB_j[i^2j^3\\bmod 2=x][i^2j^3\\bmod 491=y][i^2j^3\\bmod 499=z]$$\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u4e00\u4e2a\u6709\u610f\u601d\u7684\u4e8b\u60c5\uff1a$491$\u6709$g=2$\uff0c$499$\u6709$g=7$\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4ee5\u539f\u6839\u4e3a\u5e95\u554a\uff0c\u8fd9\u5c31\u975e\u5e38\u597d\u4e86\u3002\n\n\u4f46\u662f\u8fd9\u4e2a$2$\u6ca1\u6709\u539f\u6839\u554a\uff0c\u8fd9\u600e\u4e48\u529e\uff1f\n\n\u8003\u8651\u5230\u8fd9\u4e00\u7ef4\u53d6\u503c\u53ea\u6709$2$\u79cd\uff0c\u53ef\u4ee5\u66b4\u529b\u8ba8\u8bba\uff0c\u5269\u4e0b\u4e24\u4e2a\u4e1c\u897f\u53ef\u4ee5\u79bb\u6563\u5bf9\u6570\u641e\u641e\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u8bbe\u4e24\u4e2a\u4e1c\u897f\uff1a\uff08\u4ee5\u4e0b\u7528$\\log_{x,y}p$\u8868\u793a$p$\u5728\u6a21$x$\u610f\u4e49\u4e0b\u4ee5$y$\u4e3a\u5e95\u7684\u79bb\u6563\u5bf9\u6570\uff09\n\n$$f_{x,y,z}=\\sum\\limits_{i^2\\bmod 2=x,\\log_{491,2}i^2=y,\\log_{499,7}i^2=z}A_i$$\n\n\u548c\n\n$$g_{x,y,z}=\\sum\\limits_{i^3\\bmod 2=x,\\log_{491,2}i^3=y,\\log_{499,7}i^3=z}B_i$$\n\n\u7136\u540e\u6211\u4eec\u5c31\u4f1a\u53d1\u73b0\u6211\u4eec\u7684\u8981\u6c42\u7684\u4e1c\u897f\u5c31\u53ef\u4ee5\u5199\u6210\u8fd9\u4e2a\u4e1c\u897f\uff1a\n\n\n$$C_{x,y,z}=\\sum\\limits_{p\\&q=x}\\sum\\limits_{i=0}^{y}\\sum\\limits_{j=0}^{z}f_{p,i,j}g_{q,y-i,z-j}$$\n\n~~\u4e8c\u5143\u591a\u9879\u5f0f\u5377\u79ef\u4e86\u89e3\u4e00\u4e0b~~\n\n\u6211\u4eec\u5b9a\u4e49\u4e24\u4e2a\u77e9\u9635$A,B$\u7684\u5377\u79ef$C$\u4e3a$C_{i,j}=\\sum\\limits_{i=0}^{n}\\sum\\limits_{j=0}^{m}A_{i,j}B_{n-i,m-j}$\u3002\n\n\u8003\u8651\u5230\u7b2c\u4e00\u7ef4\u6a21\u6570\u4e3a$2$\u7684\u7279\u6b8a\u6027\u8d28\uff0c\u6211\u4eec\u53ef\u4ee5\u5927\u529b\u8ba8\u8bba~~\u7b80\u5355\u5bb9\u65a5~~\u4e00\u4e0b\uff0c\u6709\n\n$$\\begin{cases}C_0=(f_0+f_1)(g_0+g_1)-f_1g_1\\\\C_1=f_1g_1\\end{cases}$$\n\n\u63a5\u7740\u5c31\u662f\u4e8c\u7ef4$\\texttt{FFT}$\u7684\u8868\u6f14\u5566qwq\u3002\n\n\u4f60\u53ef\u4ee5\u53bb\u7f51\u4e0a\u767e\u5ea6\u8fd9\u4e2a\u4e1c\u897f\u7136\u540e\u53d1\u73b0\u6240\u8c13\u4e8c\u7ef4$\\texttt{FFT}$\u5176\u5b9e\u5c31\u662f\u628a\u6bcf\u4e00\u884c\u505a\u4e00\u904d$\\texttt{FFT}$\u518d\u6bcf\u4e00\u5217\u4e5f\u505a\u4e00\u904d$\\texttt{FFT}$\uff0c\u4e5f\u53ef\u4ee5\u53cd\u8fc7\u6765\u3002\n\n\u8bc1\u660e\u7531\u4e8e\u7bc7\u5e45\u539f\u56e0\u6240\u9650~~\u5176\u5b9e\u662f\u6211\u4e0d\u4f1a~~\u7565\u53bb\u3002\n\n\u7136\u540e\u53d1\u73b0\u67d0\u4e00\u4e9b\u6570\u53ef\u80fd\u662f$491$\u6216\u8005$499$\u7684\u500d\u6570\u5bfc\u81f4\u6ca1\u6709\u79bb\u6563\u5bf9\u6570\uff0c\u8fd9\u4e9b\u6570\u53ef\u4ee5\u66b4\u529b\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u505a\u5b8c\u4e86qwq\u3002\n\n\u7136\u540e\u8fd8\u6709\u4e00\u4e2a\u9644\u52a0\u73af\u8282\uff0c\u5c31\u662f\u5361\u5e38\u3002\n\n\u80fd\u5c11\u6a21\u7684\u5c31\u5c11\u6a21\uff0c\u5f00\u4e2a$\\texttt{long long}$\u5728\u4e00\u6b21\u6a21\u6389\uff01\n\n\u4e00\u5b9a\u8bb0\u5f97\u5438\u6c27\uff01\u4e0d\u8981\u7528\u4e07\u80fd\u5934\uff01\n\n\u7136\u540e\u4f60\u5c31\u80fd\u4ece TLE 13 \u5230 AC \u4e86qwq\n\n### \u4ee3\u7801\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<vector>\n#pragma GCC optimize(2)\n#pragma GCC optimize(3)\n#pragma GCC optimize(\"Ofast\")\nusing namespace std;\ntypedef int ll;\ntypedef long long int li;\ntypedef long double db;\nconst ll MAXN=1e5+51,G499=7,G491=2,MOD=490019;\nconst db PI=acos(-1.0);\nstruct Complex{\n\tdb re,im;\n\tComplex(db x=0,db y=0)\n\t{\n\t\tthis->re=x,this->im=y;\n\t}\n};\nComplex f0,f1,g0,g1;\nComplex omgs[1025],invo[1025],tmp[1024];\nComplex f[2][1024][1024],g[2][1024][1024];\nvector<ll>xx,yy;\nll n,m,c,kk=250,kk2=399,cur,p,q,res,h,xp;\nli kd,qq;\nll rev[1024],x[MAXN],y[MAXN];\nll lg499[500],lg491[500],pw499[500],pw491[500];\nli fx[2][1024][1024],fy[2][1024][1024];\nli pw[490021];\ninline ll read()\n{\n    register ll num=0,neg=1;\n    register char ch=getchar();\n    while(!isdigit(ch)&&ch!='-')\n    {\n        ch=getchar();\n    }\n    if(ch=='-')\n    {\n        neg=-1;\n        ch=getchar();\n    }\n    while(isdigit(ch))\n    {\n        num=(num<<3)+(num<<1)+(ch-'0');\n        ch=getchar();\n    }\n    return num*neg;\n}\ninline ll CRT(ll x,ll y,ll z)\n{\n\tll r=kk*(y-x);\n\tr=((r%499)+499)%499;\n\tll p=2*r+x,r2=kk2*(z-p);\n\tr2=((r2%491)+491)%491;\n\treturn r2*998+p;\n}\ninline Complex operator +(Complex x,Complex y)\n{\n\treturn Complex(x.re+y.re,x.im+y.im);\n}\ninline Complex operator -(Complex x,Complex y)\n{\n\treturn Complex(x.re-y.re,x.im-y.im);\n}\ninline Complex operator *(Complex x,Complex y)\n{\n\treturn Complex(x.re*y.re-x.im*y.im,x.re*y.im+x.im*y.re);\n}\ninline Complex operator /(Complex x,db y)\n{\n\treturn Complex(x.re/y,x.im/y);\n}\ninline void FFT(Complex *cp,ll cnt,ll inv)\n{\n\tll cur=0;\n\tComplex res,omg;\n\tfor(register int i=0;i<cnt;i++)\n\t{\n\t\tif(i<rev[i])\n\t\t{\n\t\t\tswap(cp[i],cp[rev[i]]);\n\t\t}\n\t}\n\tfor(register int i=2;i<=cnt;i<<=1)\n\t{\n\t\tcur=i>>1,res=inv==1?omgs[i]:invo[i];\n\t\tfor(register Complex *p=cp;p!=cp+cnt;p+=i)\n\t\t{\n\t\t\tomg=Complex(1,0);\n\t\t\tfor(register int j=0;j<cur;j++)\n\t\t\t{\n\t\t\t\tComplex t=omg*p[j+cur],t2=p[j];\n\t\t\t\tp[j+cur]=t2-t,p[j]=t+t2;\n\t\t\t\tomg=omg*res;\n\t\t\t}\n\t\t}\n\t}\n\tif(inv==-1)\n\t{\n\t\tfor(register int i=0;i<cnt;i++)\n\t\t{\n\t\t\tcp[i]=cp[i]/cnt;\n\t\t}\n\t}\n}\ninline void FFT2D(ll n,ll m,Complex cp[][1024],ll inv)\n{\n\tfor(register int i=0;i<m;i++)\n\t{\n\t\tfor(register int j=0;j<n;j++)\n\t\t{\n\t\t\ttmp[j]=cp[j][i];\n\t\t}\n\t\tFFT(tmp,n,inv);\n\t\tfor(register int j=0;j<n;j++)\n\t\t{\n\t\t\tcp[j][i]=tmp[j];\n\t\t}\n\t}\n\tfor(register int i=0;i<n;i++)\n\t{\n\t\tFFT(cp[i],m,inv);\n\t}\t\n}\nint main()\n{\n\tn=read(),m=read(),c=read(),cur=1;\n\tfor(register int i=0;i<490;i++)\n\t{\n\t\tlg491[cur]=i,pw491[i]=cur,cur=(cur*G491)%491;\n\t}\n\tcur=1;\n\tfor(register int i=0;i<498;i++)\n\t{\n\t\tlg499[cur]=i,pw499[i]=cur,cur=(cur*G499)%499;\n\t}\n\tfor(register int i=0;i<1024;i++)\n\t{\n\t\trev[i]=(rev[i>>1]>>1)|((i&1)<<9);\n\t}\n\tfor(register int i=0;i<n;i++)\n\t{\n\t\tx[i]=read();\n\t\tif(i%499&&i%491)\n\t\t{\n\t\t\tfx[i&1][lg499[(li)i*i%499]][lg491[(li)i*i%491]]+=x[i];\n\t\t\tcontinue;\n\t\t}\n\t\txx.push_back(i);\n\t}\n\tfor(register int i=0;i<m;i++)\n\t{\n\t\ty[i]=read();\n\t\tif(i%499&&i%491)\n\t\t{\n\t\t\tfy[i&1][lg499[(li)i*i*i%499]][lg491[(li)i*i*i%491]]+=y[i];\n\t\t\tcontinue;\n\t\t}\n\t\tyy.push_back(i);\n\t}\n\tfor(register int i=0;i<499;i++)\n\t{\n\t\tfor(register int j=0;j<491;j++)\n\t\t{\n\t\t\tf[0][i][j].re=fx[0][i][j]%MOD,f[1][i][j].re=fx[1][i][j]%MOD;\n\t\t\tg[0][i][j].re=fy[0][i][j]%MOD,g[1][i][j].re=fy[1][i][j]%MOD;\n\t\t}\t\n\t}\n\tfor(register int i=1;i<=1024;i<<=1)\n\t{\n\t\tomgs[i]=Complex(cos(2*PI/i),sin(2*PI/i));\n\t\tinvo[i]=Complex(cos(2*PI/i),-sin(2*PI/i));\n\t}\n\tFFT2D(1024,1024,f[0],1),FFT2D(1024,1024,f[1],1);\n\tFFT2D(1024,1024,g[0],1),FFT2D(1024,1024,g[1],1);\n\tfor(register int i=0;i<1024;i++)\n\t{\n\t\tfor(register int j=0;j<1024;j++)\n\t\t{\n\t\t\tf0=f[0][i][j],f1=f[1][i][j],g0=g[0][i][j],g1=g[1][i][j];\n\t\t\tf[0][i][j]=(f0+f1)*(g0+g1)-f1*g1,f[1][i][j]=f1*g1;\n\t\t}\n\t}\n\tFFT2D(1024,1024,f[0],-1),FFT2D(1024,1024,f[1],-1),pw[0]=1;\n\tfor(register int i=1;i<MOD;i++)\n\t{\n\t\tpw[i]=(li)pw[i-1]*c%MOD;\n\t}\n\tfor(register int i=0;i<1024;i++)\n\t{\n\t\tfor(register int j=0;j<1024;j++)\n\t\t{\n\t\t\tfor(register int k=0;k<2;k++)\n\t\t\t{\n\t\t\t\th=((li)(f[k][i][j].re+0.5))%MOD;\n\t\t\t\txp=CRT(k,pw499[i%498],pw491[j%490]);\n\t\t\t\tres=(res+h*pw[xp])%MOD;\n\t\t\t}\n\t\t}\n\t}\n\tfor(register int i=0;i<xx.size();i++)\n\t{\n\t\tfor(register int j=0;j<m;j++)\n\t\t{\n\t\t\tkd=(li)xx[i]*xx[i]*j%(MOD-1)*j*j%(MOD-1);\n\t\t\tqq=x[xx[i]]*y[j]*pw[kd]%MOD;\n\t\t\tres=(li)(res+qq)%MOD;\n\t\t}\n\t}\n\tfor(register int i=0;i<yy.size();i++)\n\t{\n\t\tfor(register int j=0;j<n;j++)\n\t\t{\n\t\t\tif(!(j%499&&j%491))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tkd=(li)yy[i]*yy[i]*yy[i]%(MOD-1)*j*j%(MOD-1);\n\t\t\tres=(res+(li)x[j]*y[yy[i]]*pw[kd])%MOD;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",res);\n}\n```",
        "postTime": 1573736996,
        "uid": 60990,
        "name": "Karry5307",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1054H \u3010Epic Convolution\u3011"
    },
    {
        "content": "\u7ffb\u8bd1\u81ea[\u6211\u7684\u535a\u5ba2\u3002](https://codeforces.com/blog/entry/82165)\n\n\u8003\u8651\u5efa\u7acb\u4e24\u4e2a\u6570\u7ec4 $a'$ \u548c $b'$\uff0c\u6ee1\u8db3\uff1a\n\n$$a'[i]=\\sum_{j^2\\equiv i\\pmod{490018}}a[i]$$\n$$b'[i]=\\sum_{j^3\\equiv i\\pmod{490018}}b[i]$$\n\n\u4e8e\u662f\u73b0\u5728\u7b54\u6848\u5c31\u662f\n\n$$\\sum_{i=0}^{490017}\\sum_{j=0}^{490017}a'_ib'_jc^{ij}$$\n\n\u63d0\u51fa $a'_i$\uff0c\u53d1\u73b0\u91cc\u9762\u7b49\u4ef7\u4e8e\u5bf9 $b'$ \u751f\u6210\u51fd\u6570\u5728 $c^i$ \u5904\u6c42\u503c\uff1a\n\n$$\\sum_{i=0}^{490017}a'_iB'(c^i)$$\n\n\u5bf9 $B'$ \u8fdb\u884c\u4efb\u610f\u6a21\u6570 [Chirp-Z Transform](https://www.luogu.com.cn/problem/P6800) \u5373\u53ef\u3002\n\n\u6838\u5fc3\u4ee3\u7801\uff1a\n\n```cpp\nsigned main() {\n    ios_base::sync_with_stdio(false); cin.tie(0);\n    simonMTT::vl a(M-1), b(M-1);\n    int n, m, c; cin >> n >> m >> c;\n    rep(i, n) {\n        int v; cin >> v;\n        a[(1ll*i*i)%(M-1)] += v;\n    }\n    rep(j, m) {\n        int v; cin >> v;\n        b[(1ll*j*j*j)%(M-1)] += v;\n    }\n    for(int& v:a) v %= M;\n    for(int& v:b) v %= M;\n    simonMTT::vl res = CZT::run(b, b.size(), c, a.size());\n    int tot = 0;\n    rep(i, a.size()) tot = (tot + 1ll * a[i] * res[i]) % M;\n    cout << tot;\n}\n```",
        "postTime": 1598921434,
        "uid": 220037,
        "name": "w33z8kqrqk8zzzx33",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1054H \u3010Epic Convolution\u3011"
    },
    {
        "content": "\u9996\u5148\u4f60\u53d1\u73b0\u8fd9\u4e2a$c^{i^2j^3}$\u96be\u4ee5\u5904\u7406\uff0c\u4f46\u662f\u5f88\u663e\u7136\u6839\u636e\u6b27\u62c9\u5b9a\u7406\u8fd9\u4e2a\u7b49\u4ef7\u4e8e$c^{i^2j^3\\%490018}$\uff0c\u672c\u8d28\u4e0d\u540c\u7684\u6307\u6570\u53ea\u6709490018\u79cd\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u5e0c\u671b\u6784\u9020\u4e00\u4e2a$a[k]=\\sum_{i,j}A_iB_j[i^2j^3\\%490018=k]$\u90a3\u6211\u4eec\u5c31\u80fd\u505a\u4e86\u3002\n\n\u8003\u8651\u8fd9\u4e2a\u4e1c\u897f\u96be\u4ee5\u5904\u7406\u7684\u539f\u56e0\u5728\u4e8e$i^2$\u548c$j^3$\u662f\u4e58\u5728\u4e00\u8d77\u7684\u800c\u4e0d\u662f\u52a0\u5728\u4e00\u8d77\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5957\u8def\u7684\u8003\u8651**\u53d6\u5bf9\u6570**\uff0c\u7136\u800c490018\u4e0d\u662f\u8d28\u6570\uff0c\u4f46\u662f$490018=2\u00d7491\u00d7499$\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u6c42\u4e00\u4e2a$a[x][y][z]=\\sum_{i,j}A_iB_j[i^2j^3\\%2=x\\&i^2j^3\\%499=y\\&i^2j^3\\%491=z]$\uff0c\u7136\u540e$CRT$\u5373\u53ef\u6c42\u51fa\u8fd9\u4e2a\u6307\u6570\u4e86\u3002\n\n\u8003\u8651\u52302\u6ca1\u6709\u539f\u6839\u4f46\u662f\u8fd9\u4e00\u7ef4\u4e0d\u662f0\u5c31\u662f1\u6240\u4ee5\u628a\u5b83\u8ba8\u8bba\u4e00\u4e0b\u5373\u53ef\u3002\u7136\u540e\u6211\u4eec\u5bf9\u4e8e\u6240\u6709\u7684$i^2$\u548c$j^3$\u7528499\u7684\u539f\u68397\u548c491\u7684\u539f\u68392\u5728\u6a21499\u548c491\u610f\u4e49\u4e0b\u5206\u522b\u8868\u793a\u6210\u79bb\u6563\u5bf9\u6570\u7684\u5f62\u5f0f\uff0c\u641e\u51fa\u4e00\u4e2a$f[x][y][z]$\u4e3a$i^2\\%2=x$\uff0c$i^2$\u5728\u6a21499\u548c491\u610f\u4e49\u4e0b\u7684\u79bb\u6563\u5bf9\u6570\u5206\u522b\u4e3a$y,z$\u7684$\\sum A_i$\uff0c\u540c\u7406\u5bf9\u4e8e$B$\u6570\u7ec4\u6211\u4eec\u4e5f\u641e\u51fa\u4e00\u4e2a$g[x][y][z]$\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u8981\u6c42$h[x][y][z]$\u4e3a$i^2j^3\\%2=x$\uff0c$i^2$\u4e0e$j^3$\u7684\u79bb\u6563\u5bf9\u6570\u52a0\u8d77\u6765\uff08\u5373$i^2j^3$\u7684\u79bb\u6563\u5bf9\u6570\uff09\u5206\u522b\u4e3a$y,z$\u7684$\\sum A_iB_j$\u3002\u90a3\u4e48\u663e\u7136\u6709$h[x][y][z]=\\sum_{a\\&b=x}\\sum_{i=0}^y\\sum_{j=0}^zf[a][i][j]g[b][y-i][z-j]$\u3002\u7136\u540e\u8fd9\u76f8\u5f53\u4e8e\u67094\u4e2a\u77e9\u9635$f[0],f[1],g[0],g[1]$\uff0c\u6211\u4eec\u4e0d\u59a8\u5b9a\u4e49\u4e24\u4e2a\u77e9\u9635$AB$\u7684**\u5377\u79ef**$C$\u4e3a$C_{ij=}\\sum_{a=0}^i\\sum_{b=0}^jA_{ab}B_{i-a,j-b}$\uff0c\u90a3\u4e48$h[1]=f[1]g[1]$\uff0c$h[0]=f[1]g[0]+f[0]g[1]+f[0]g[0]$\u3002\n\n\u8003\u8651\u5982\u4f55\u7b97\u4e24\u4e2a\u77e9\u9635\u7684\u5377\u79ef\uff0c\u8fd9\u5176\u5b9e\u4e5f\u662f\u53ef\u4ee5FFT\u7684\uff0c\u8fd9\u5176\u5b9e\u76f8\u5f53\u4e8e\u4e00\u4e2a\u4e8c\u7ef4\u591a\u9879\u5f0f$\\sum_{i,j}A_{ij}x^iy^j$\uff0c\u6211\u4eec\u5bf9\u4e8e\u4e00\u7ef4\u591a\u9879\u5f0f\u7684$DFT$\u662f\u628a$\\sum_iA_ix^i$\u4ee3\u5165\u5355\u4f4d\u6839\u5f97\u5230$\\sum A_i\\omega_n^i$\uff0c\u90a3\u4e48\u6211\u4eec\u5176\u5b9e\u8981\u5e72\u7684\u5c31\u662f\u628a\u8fd9\u4e2a\u77e9\u9635\u641e\u6210$\\sum_{i,j}A_{ij}\\omega_{n}^i\\omega_m^j$\uff0c\u90a3\u4e48\u6211\u4eec\u5148\u628a\u6240\u6709\u7684\u884c\u505a\u4e00\u904d$DFT$\uff0c\u518d\u628a\u6240\u6709\u7684\u5217\u505a\u4e00\u904d$DFT$\u5373\u53ef\uff0c$IDFT$\u540c\u7406\uff0c\u4e0d\u8fc7\u8981\u6ce8\u610f\u6bcf\u6b21$IDFT$\u90fd\u8981\u628a\u7ed3\u679c\u9664$n$\u3002~~\u8fd9\u9898\u6ca1\u6cd5NTT\u771f\u662f**~~\n\n\u90a3\u4e48\u8fd9\u9898\u4f3c\u4e4e\u5c31\u505a\u5b8c\u4e86\u3002\u4e0d\u8fc7\u6211\u4eec\u8fd8\u6709\u4e2a\u95ee\u9898\uff0c\u5c31\u662f\u5982\u679c$i^2$\u6216\u8005$j^3$\u662f499\u6216491\u7684\u500d\u6570\uff0c\u90a3\u4e48\u5b83\u4eec\u5c31\u6ca1\u6709\u79bb\u6563\u5bf9\u6570\u3002\u4f46\u662f\u8fd9\u6837\u7684\u6570\u53ea\u6709$O(\\frac n {491})$\u4e2a\uff08\u6216\u8005\u53eb$O(\\frac n{\\sqrt p})$\uff09\uff0c\u90a3\u4e48\u5bf9\u8fd9\u4e9b\u6570\u8fdb\u884c$O(\\frac {nm}{\\sqrt p})$\u7684\u66b4\u529b\u5373\u53ef\u3002\n\n\u7136\u540e\u603b\u590d\u6742\u5ea6\u662f$O(p\\log p+\\frac{nm}{\\sqrt p})$\u7684\uff0c\u5e38\u6570\u8fd8\u633a\u5927\u2026\u2026\n\n\u4e0a\u4ee3\u7801~\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<vector>\n#define ll long long\n#define p 490019\n#define double long double\nusing namespace std;\nnamespace ywy{\n\tinline int get(){\n\t\tint n=0;char c;while((c=getchar())||23333){\n\t\t\tif(c>='0'&&c<='9')break;if(c=='-')goto s;\n\t\t}n=c-'0';while((c=getchar())||23333){\n\t\t\tif(c>='0'&&c<='9')n=n*10+c-'0';else return(n);\n\t\t}s:while((c=getchar())||23333){\n\t\t\tif(c>='0'&&c<='9')n=n*10-c+'0';else return(n);\n\t\t}\n\t}\n\ttypedef struct _fushu{\n\t\tdouble a,b;_fushu(double x,double y){a=x;b=y;}_fushu(){a=b=0;}\n\t\tfriend _fushu operator +(const _fushu &a,const _fushu &b){return(_fushu(a.a+b.a,a.b+b.b));}\n\t\tfriend _fushu operator -(const _fushu &a,const _fushu &b){return(_fushu(a.a-b.a,a.b-b.b));}\n\t\tfriend _fushu operator /(const _fushu &a,const double &b){return(_fushu(a.a/b,a.b/b));}\n\t\tfriend _fushu operator *(const _fushu &a,const _fushu &b){\n\t\t\treturn(_fushu(a.a*b.a-a.b*b.b,a.b*b.a+a.a*b.b));\n\t\t}\n\t}fushu;\n\tfushu dks[2][1025],a[1024],b[1024];\n\tint hudie[1024];\n\tinline void fft(int n,fushu *f,int op){\n\t\tfor(register int i=0;i<n;i++)if(i<hudie[i])swap(f[i],f[hudie[i]]);\n\t\tfor(register int bit=2;bit<=n;bit<<=1){\n\t\t\tfushu dk=dks[op][bit];\n\t\t\tfor(register int i=0;i<n;i+=bit){\n\t\t\t\tfushu dwg=_fushu(1,0);\n\t\t\t\tfor(register int j=i;j<i+(bit>>1);j++){\n\t\t\t\t\tfushu cjr=dwg*f[j+(bit>>1)];\n\t\t\t\t\tf[j+(bit>>1)]=f[j]-cjr;\n\t\t\t\t\tf[j]=f[j]+cjr;dwg=dwg*dk;\n\t\t\t\t}\n\t\t\t}\n\t\t}if(op==1)for(register int i=0;i<n;i++)f[i]=f[i]/n;\n\t}\n\tinline void dft(int n,int m,fushu f[][1024],int op,int dbg){\n\t\tfor(register int i=0;i<n;i++)hudie[i]=(hudie[i>>1]>>1)|((i&1)?(n>>1):0);\n\t\tfor(register int i=0;i<m;i++){\n\t\t\tfor(register int j=0;j<n;j++)a[j]=f[j][i];fft(n,a,op);\n\t\t\tfor(register int j=0;j<n;j++)f[j][i]=a[j];\n\t\t}\n\t\tfor(register int i=0;i<m;i++)hudie[i]=(hudie[i>>1]>>1)|((i&1)?(m>>1):0);\n\t\tfor(register int i=0;i<n;i++)fft(m,f[i],op);\n\t}\n\tint lg499[500],lg491[500];fushu f[2][1024][1024],g[2][1024][1024];\n\tll dk[500001];int k_2_499,k_998_491;\n\tinline int CRT(int a,int b,int c){\n\t\tint rk1=k_2_499*(b-a);\n\t\trk1%=499;rk1+=499;rk1%=499;\n\t\tint d=2*rk1+a;\n\t\tint rk2=k_998_491*(c-d);\n\t\trk2%=491;rk2+=491;rk2%=491;\n\t\treturn(rk2*998+d);\n\t}\n\tvoid exgcd(int a,int b,int &x,int &y){\n\t\tif(!b){\n\t\t\tx=1;y=0;return;\n\t\t}\n\t\tint x1,y1;\n\t\texgcd(b,a%b,x1,y1);\n\t\tx=y1;y=x1-(a/b)*y1;\n\t}\n\tconst int g499=7,g491=2;\n\tll da[2][1024][1024],db[2][1024][1024];\n\tint A[100001],B[100001];\n\tvector<int> fa,fb;\n\tint exp499[500],exp491[500];\n\tvoid ywymain(){\n\t\tint n=get(),m=get(),c=get();\n\t\tll ji=1;\n\t\tfor(register int i=0;i<490;i++){\n\t\t\tlg491[ji]=i;\n\t\t\texp491[i]=ji;\n\t\t\tji=(ji*g491)%491;\n\t\t}\n\t\tji=1;\n\t\tfor(register int i=0;i<498;i++){\n\t\t\tlg499[ji]=i;\n\t\t\texp499[i]=ji;\n\t\t\tji=(ji*g499)%499;\n\t\t}\n\t\tfor(register int i=0;i<n;i++){\n\t\t\tA[i]=get();\n\t\t\tif(i%499&&i%491){\n\t\t\t\tda[i&1][lg499[(i*(ll)i)%499]][lg491[(i*(ll)i)%491]]+=A[i];\n\t\t\t}else fa.push_back(i);\n\t\t}\n\t\tfor(register int i=0;i<m;i++){\n\t\t\tB[i]=get();\n\t\t\tif(i%499&&i%491){\n\t\t\t\tdb[i&1][lg499[(((i*(ll)i)%499)*(ll)i)%499]][lg491[(((i*(ll)i)%491)*(ll)i)%491]]+=B[i];\n\t\t\t}else fb.push_back(i);\n\t\t}for(register int i=0;i<499;i++){\n\t\t\tfor(register int j=0;j<491;j++){\n\t\t\t\tf[0][i][j].a=da[0][i][j]%p;\n\t\t\t\tf[1][i][j].a=da[1][i][j]%p;\n\t\t\t\tg[0][i][j].a=db[0][i][j]%p;\n\t\t\t\tg[1][i][j].a=db[1][i][j]%p;\n\t\t\t}\n\t\t}\n\t\tdouble pi=acos(-1);\n\t\tfor(register int i=1;i<=1024;i<<=1){\n\t\t\tdks[0][i]=_fushu(cos(2*pi/i),sin(2*pi/i));\n\t\t\tdks[1][i]=_fushu(cos(2*pi/i),-sin(2*pi/i));\n\t\t}\n\t\tdft(1024,1024,f[0],0,0);\n\t\tdft(1024,1024,g[0],0,0);\n\t\tdft(1024,1024,f[1],0,0);\n\t\tdft(1024,1024,g[1],0,0);\n\t\tfor(register int i=0;i<1024;i++){\n\t\t\tfor(register int j=0;j<1024;j++){\n\t\t\t\tfushu f0=f[0][i][j],f1=f[1][i][j],g0=g[0][i][j],g1=g[1][i][j];\n\t\t\t\tf[0][i][j]=(f0+f1)*(g0+g1)-f1*g1;\n\t\t\t\tf[1][i][j]=f1*g1;\n\t\t\t}\n\t\t}\n\t\tdft(1024,1024,f[0],1,0);\n\t\tdft(1024,1024,f[1],1,0);\n\t\tint x,y;exgcd(2,499,x,y);\n\t\tx%=499;x+=499;x%=499;k_2_499=x;\n\t\texgcd(998,491,x,y);\n\t\tx%=491;x+=491;x%=491;k_998_491=x;dk[0]=1;\n\t\tfor(register int i=1;i<p;i++)dk[i]=(dk[i-1]*c)%p;\n\t\tll ans=0;\n\t\tfor(register int i=0;i<1024;i++){\n\t\t\tfor(register int j=0;j<1024;j++){\n\t\t\t\tfor(register int k=0;k<=1;k++){\n\t\t\t\t\tint h=((ll)(f[k][i][j].a+0.5))%p,xp=CRT(k,exp499[i%498],exp491[j%490]);\n\t\t\t\t\tans=(ans+h*dk[xp])%p;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor(register int i=0;i<fa.size();i++){\n\t\t\tfor(register int j=0;j<m;j++){\n\t\t\t\tll kd=fa[i];kd*=fa[i];\n\t\t\t\tkd*=j;kd%=(p-1);kd*=j;kd*=j;kd%=(p-1);\n\t\t\t\tll cjr=A[fa[i]];cjr*=B[j];\n\t\t\t\tcjr*=dk[kd];ans=(ans+cjr)%p;\n\t\t\t}\n\t\t}\n\t\tfor(register int i=0;i<fb.size();i++){\n\t\t\tfor(register int j=0;j<n;j++){\n\t\t\t\tif(!(j%499&&j%491))continue;\n\t\t\t\tll kd=fb[i];kd*=fb[i];kd*=fb[i];kd%=(p-1);\n\t\t\t\tkd*=j;kd*=j;kd%=(p-1);\n\t\t\t\tans=(ans+A[j]*(ll)B[fb[i]]*dk[kd])%p;\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}\nint main(){\n\tywy::ywymain();return(0);\n}\n```",
        "postTime": 1559026566,
        "uid": 125124,
        "name": "ywy_c_asm",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1054H \u3010Epic Convolution\u3011"
    },
    {
        "content": "\u8003\u8651\u679a\u4e3e $i^2,j^3$\uff0c\u6839\u636e\u8d39\u9a6c\u5c0f\u5b9a\u7406\u5b83\u4eec\u5728 $\\bmod \\ 490018$ \u610f\u4e49\u4e0b\u7b49\u4ef7\uff0c\u56e0\u6b64\u53ef\u4ee5\u7528\u8ba1\u6570\u5668\u6570\u7ec4\u8fdb\u884c\u7edf\u8ba1\uff0c\u8bbe\u4e3a $A',B'$\uff0c\u7136\u540e\u7b54\u6848\u5c31\u53d8\u6210\u4e86\n$$\n\\sum_{i}\\sum_{j}A'_iB'_jc^{ij}\n$$\n\u63d0\u51fa $A'_i$ \u53d1\u73b0\u5c31\u4e00 $B'(c^i)$\uff0c\u7136\u540e\u5f0f\u5b50\u5c31\u53d8\u6210\u4e86\n$$\n\\sum_{i}A'_iB'(c^i)\n$$\n\u4f60\u53ef\u80fd\u89c9\u5f97\u8981\u591a\u70b9\u6c42\u503c\uff0c\u4f46\u4ed4\u7ec6\u89c2\u5bdf\u4f1a\u53d1\u73b0\u7b26\u5408 CZT \u7684\u4f7f\u7528\u6761\u4ef6\uff0c\u6240\u4ee5\u7528 CZT \u5373\u53ef\u3002\n\n\u6a21\u6570\u662f\u4ec0\u4e48\u50bb\u903c\uff0c\u611f\u6069\u51fa\u9898\u4eba\u7ed9\u4e86\u4e2a\u8d28\u6570\uff0c\u4e8e\u662f\u6211\u4eec\u6574\u4e2a[\u4efb\u610f\u6a21\u6570 CZT](https://www.luogu.com.cn/problem/P6828)\uff0c\u590d\u6742\u5ea6\u5c31\u662f $O(mod\\log mod)$ \u7684\u3002\n\n\u4ee3\u7801\u6211\u9e3d\u4e86\u3002",
        "postTime": 1636042252,
        "uid": 121027,
        "name": "Spasmodic",
        "ccfLevel": 7,
        "title": "\u7406\u6027\u6109\u60a6 *3500"
    }
]
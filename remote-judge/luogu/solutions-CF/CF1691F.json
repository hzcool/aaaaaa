[
    {
        "content": "## \u601d\u8def\n\u9996\u5148\u8003\u8651\u6839\u9009\u597d\u4e86\u600e\u4e48\u505a\uff0c\u663e\u7136\u5c31\u76f4\u63a5\u679a\u4e3e $\\text{LCA}$ \u5373\u53ef\uff0c\u76f4\u63a5\u5217\u51fa\u5f0f\u5b50\u3002\n\n$$\n\\sum sz_i\\left(\\binom{sz_i}{k}-\\sum_{j\\in \\text{}son(i)}\\binom{sz_j}{k}\\right)\n$$\n\n\u4e5f\u5c31\u662f\u8bf4\u4e00\u4e2a\u70b9\u7684\u8d21\u732e\u662f $(sz_i-sz_{fa_i})\\binom{sz_i}{k}$\u3002\n\n\u7136\u540e\u76f4\u63a5\u6362\u6839 dp\uff0cdfs \u4e00\u904d\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u5c06 $fa_i$ \u5206\u4e09\u7c7b\u679a\u4e3e\uff1a\n\n- \u6ca1\u6709 $fa_i$\uff0c\u5c31\u662f $n\\binom{n}{k}$\u3002\n  \n- $fa_i$ \u5728 $i$ \u5b50\u6811\u91cc\uff0c\u8bb0\u5f55\u5b50\u6811\u91cc\u6bcf\u4e2a\u6839\u5bf9\u5e94\u7684 $sz_j$ \u603b\u548c\u3002\n  \n- $fa_i$ \u5c31\u662f\u4ee5 $1$ \u4e3a\u6839\u7684\u6811\u4e0a $i$ \u7684\u7236\u4eb2\uff0c\u8bb0\u5f55\u6bcf\u4e2a\u6839\u5bf9\u5e94\u7684 $sz_{fa_i}$ \u7684\u603b\u548c\u3002\n\n## \u4ee3\u7801\n```cpp\n// Problem: F. K-Set Tree\n// Contest: Codeforces - CodeCraft-22 and Codeforces Round #795 (Div. 2)\n// URL: https://codeforces.com/problemset/problem/1691/F\n// Memory Limit: 512 MB\n// Time Limit: 3000 ms\n// \n// Powered by CP Editor (https://cpeditor.org)\n\n//\u56de\u5bb6\uff1f\u6211\u6ca1\u6709\u5bb6\u53ef\u4ee5\u56de\uff0c\u6211\u6ca1\u6709\u9000\u8def\u3002\n#include<bits/stdc++.h>\n#pragma GCC optimize(\"Ofast\")\n#pragma GCC optimize(\"unroll-loops\")\n#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,avx2,tune=native\")\nusing namespace std;\n#define int long long\ninline int read(){\n   int s=0,w=1;\n   char ch=getchar();\n   while(ch<'0'||ch>'9'){if(ch=='-')w=-1;ch=getchar();}\n   while(ch>='0'&&ch<='9') s=s*10+ch-'0',ch=getchar();\n   return s*w;\n}\nconst int p=1e9+7;\nint qp(int x,int y)\n{\n\tint res=1;\n\tfor(int t=x; y; y>>=1,t=t*t%p) if(y&1) res=res*t%p;\n\treturn res;\n}\nvector<int> e[200003];\nint fac[200003],ifac[200003],sz[200003],ssz[200003];\nint n=read(),k=read(),ans;\nint C(int n)\n{\n\tif(n<k) return 0;\n\treturn fac[n]*ifac[k]%p*ifac[n-k]%p;\n}\nvoid dfs(int x,int fa=0)\n{\n\tsz[x]=1;\n\tfor(int y:e[x]) if(y!=fa)\n\t\tdfs(y,x),sz[x]+=sz[y];\n\treturn ;\n}\nvoid calc(int x,int fa=0)\n{\n\tint fsz=(n+(n-sz[x])*sz[x])%p;\n\tssz[x]=n;\n\tfor(int y:e[x]) if(y!=fa)\n\t\tfsz=(fsz+sz[y]*(n-sz[y]))%p;\n\tfor(int y:e[x]) if(y!=fa)\n\t\tans=(ans+(p+sz[y]*(n-sz[y])%p-(fsz+p-sz[y]*(n-sz[y])%p)%p)*C(sz[y]))%p,\n\t\tcalc(y,x),ssz[x]=(ssz[x]+sz[y]*(n-sz[y]))%p,\n\t\tans=(ans+(p+(n-sz[y])*sz[y]%p-ssz[y])*C(n-sz[y]))%p;\n\treturn ;\n}\nsigned main()\n{\n\tfac[0]=ifac[0]=1;\n\tfor(int i=1; i<=n; ++i) fac[i]=fac[i-1]*i%p;\n\tifac[n]=qp(fac[n],p-2);\n\tfor(int i=n-1; i>=1; --i) ifac[i]=ifac[i+1]*(i+1)%p;\n\tfor(int i=1,u,v; i<n; ++i)\n\t\tu=read(),v=read(),e[u].push_back(v),e[v].push_back(u);\n\tans=n*n%p*C(n)%p,dfs(1),calc(1),printf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1656334057,
        "uid": 111055,
        "name": "dead_X",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1691F"
    },
    {
        "content": "## CF1691F [link](https://codeforces.com/contest/1691/problem/F)\n\n~~[Rd795 \u9898\u89e3](https://280800.blog.luogu.org/codecraft-22-and-codeforces-round-795-div-2-post)\u6ede\u9500\uff0c\u5e2e\u5e2e\u6211\uff08\u8bef~~\n\n\u4e0d\u96be\u60f3\u5230\u6362\u6839 dp\uff0c\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u5199\u51fa\u5982\u4e0b\u5f0f\u5b50\uff1a\n$$\nf_u=\\left(\\dbinom{\\mathrm{sz}_u}{k}-\\sum_{v}\\dbinom{\\mathrm{sz}_v}{k}\\right)\\mathrm{sz}_u+\\sum_{v}f_v\n$$\n\u5177\u4f53\u542b\u4e49\u5c31\u662f\uff1a\u8003\u8651\u8fd9 $k$ \u4e2a\u70b9\uff0c\u4ec0\u4e48\u65f6\u5019 $\\operatorname{lca}$ \u4e3a $u$\u3002\n\n\u51cf\u6cd5\u539f\u7406\uff0c\u8003\u8651\u4ec0\u4e48\u65f6\u5019\u4e0d\u4e3a $u$\uff0c\u5f53\u4e14\u4ec5\u5f53\u8fd9 $k$ \u4e2a\u70b9\u6765\u81ea\u4e8e\u540c\u4e00\u9897\u5b50\u6811\u3002\u51cf\u53bb$\\sum\\limits_{v}\\dbinom{\\mathrm{sz}_v}{k}$ \u5373\u53ef\u3002\n\n\u6700\u540e\u628a\u5b50\u6811\u7b54\u6848\u5408\u5e76\u4e0a\u53bb\u5373\u53ef\u3002\n\n\u89c2\u5bdf\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u53ef\u4ee5\u62c6\u51fa\u300c\u53ea\u548c $v$ \u6709\u5173\u300d\u3001\u300c\u53ea\u548c $u$ \u6709\u5173\u300d\u3001\u300c\u548c $u,v$ \u90fd\u6709\u5173\u300d\u4e09\u79cd\u3002\u4e3a\u4e86\u597d\u6362\u6839\uff0c\u6211\u4eec\u9700\u8981\u8ba9\u548c $v$ \u6709\u5173\u7684\u90fd\u6bd4\u8f83\u597d\u7edf\u8ba1\u3002\u4e8e\u662f\u8003\u8651\u91cd\u5b9a\u4e49 $f_u$ \u548c $g_u$\u3002$f_u$ \u8868\u793a\u6240\u6709\u513f\u5b50\u7684\u7b54\u6848\uff0c$g_u$ \u8868\u793a $\\sum\\limits_{v}\\dbinom{\\mathrm{sz}_v}{k}$\u3002\n\n\u6b64\u65f6\u5b50\u6811 $u$ \u7684\u7b54\u6848\u5e94\u8be5\u662f\uff1a\n$$\n\\mathrm{ans}_u=\\left(\\dbinom{\\mathrm{sz}_u}{k}-g_u\\right)\\mathrm{sz}_u+f_u\n$$\n\u6b64\u65f6\u6362\u6839\u53ea\u9700\u8981\u4fee\u6539 $g$ \u548c $f$ \u5373\u53ef\uff0c\u51cf\u51cf\u52a0\u52a0\u4e0a\u9762\u63d0\u5230\u7684\u7ec4\u5408\u6570\uff0c\u76f8\u4fe1\u5927\u5bb6\u90fd\u4f1a\u3002\n\n\u6ca1\u4ec0\u4e48\u6ce8\u610f\u4e8b\u9879\uff0c\u6ca1\u6709\u7ec6\u8282\uff0c\u5f88\u597d\u5199\u3002\n\n## \u7801\n\n```cpp\n// Problem: F. K-Set Tree\n// From: Codeforces - CodeCraft-22 and Codeforces Round #795 (Div. 2)\n// URL: https://codeforces.com/contest/1691/problem/F\n// Time: 2022-05-31 22:35\n// Author: lingfunny\n\n#include <bits/stdc++.h>\n#define LL long long\nusing namespace std;\nconst int mxn = 2e5+10, mod = 1e9+7;\nint jc[mxn], ijc[mxn], n, f[mxn], g[mxn], k, sz[mxn], ans;\n// f: \u5b50\u6811 ans \u548c\n// g: \u5b50\u6811 (sz, k) \u548c\n// ans[u]: (C(S-1, k-1) + C(S-1, k) - g[u]) * S + f[u]\nvector <int> G[mxn];\n\ninline int mul() { return 1; }\ntemplate <typename... A>\nint mul(int x, A... a) { return (LL)x*mul(a...)%mod; }\ninline int qpow(int x, int y) {\n\tint res = 1;\n\tfor(; y; x = mul(x, x), y >>= 1) if(y&1) res = mul(res, x);\n\treturn res;\n}\ninline int C(int n, int m) {\n\tif(m > n) return 0;\n\treturn mul(jc[n], ijc[m], ijc[n-m]);\n}\nvoid add(int &x) { x = x; }\ntemplate <typename... A>\nvoid add(int &x, int y, A... a) { x += (x + y) >= mod ? y - mod : y; add(x, a...); }\ninline int calc(int S, int F, int G) { return (mul((C(S, k) - G + mod)%mod, S) + F) % mod; }\nvoid dfs(int u, int fa) {\n\tsz[u] = 1;\n\tfor(int v: G[u]) if(v != fa) {\n\t\tdfs(v, u), sz[u] += sz[v];\n\t\tadd(f[u], calc(sz[v], f[v], g[v]));\n\t\tadd(g[u], C(sz[v], k));\n\t}\n}\nvoid dfs2(int u, int fa) {\n\tif(fa) {\n\t\tint F = f[fa], G = g[fa];\n\t\tadd(F, mod - calc(sz[u], f[u], g[u])), add(G, mod - C(sz[u], k));\n\t\tadd(f[u], calc(n - sz[u], F, G));\n\t\tadd(g[u], C(n - sz[u], k));\n\t}\n\tadd(ans, calc(n, f[u], g[u]));\n\tfor(int v: G[u]) if(v != fa) dfs2(v, u);\n}\n\nsigned main() {\n\tscanf(\"%d%d\", &n, &k);\n\tjc[0] = 1; for(int i = 1; i <= n; ++i) jc[i] = mul(jc[i-1], i);\n\tijc[n] = qpow(jc[n], mod-2); for(int i = n - 1; ~i; --i) ijc[i] = mul(ijc[i+1], i+1);\n\tfor(int i = 1, u, v; i < n; ++i) scanf(\"%d%d\", &u, &v), G[u].emplace_back(v), G[v].emplace_back(u);\n\tdfs(1, 0); dfs2(1, 0);\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1654133088,
        "uid": 280800,
        "name": "lingfunny",
        "ccfLevel": 7,
        "title": "CF1691F \u9898\u89e3"
    }
]
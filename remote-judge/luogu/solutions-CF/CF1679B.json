[
    {
        "content": "### \u9898\u610f\n\u7ed9\u51fa\u4e00\u4e2a $n$ \u4e2a\u6570\u7684\u5e8f\u5217 $a$\uff0c$q$ \u6b21\u4fee\u6539\uff0c\u683c\u5f0f\u5982\u4e0b\u3002\n\n- `1 i x` \u5c06 $a_i$ \u53d8\u4e3a $x$ \u5373 $a_i\\gets x$\u3002\n- `2 x` \u5c06\u5e8f\u5217\u6240\u6709\u6570\u53d8\u4e3a $x$\u3002\n\n\u6bcf\u6b21\u8be2\u95ee\u540e\u8f93\u51fa\u6240\u6709\u6570\u7684\u548c\u5373 $\\displaystyle\\sum_{i=1}^na_i$\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\le n,q\\le2\\times10^5,1\\le a_i,x\\le10^9$\u3002\n### \u601d\u8def\n\u663e\u7136\u53ef\u4ee5\u7ebf\u6bb5\u6811\uff0c$O(n+q\\log n)$ \u89e3\u51b3\u3002\n\n\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e2a $O(n+q)$ \u4e14\u7801\u91cf\u5c0f\u7684\u65b9\u6cd5\u3002\n\n\u8bb0 $t_i$ \u4e3a $a_i$ \u6700\u540e\u4fee\u6539\u7684\u65f6\u95f4\uff08\u7b2c\u51e0\u6b21\u64cd\u4f5c\uff09\uff0c$T$ \u4e3a $2$ \u64cd\u4f5c\u6700\u540e\u7684\u65f6\u95f4\u3002\n\n$1$ \u64cd\u4f5c\u53ef\u4ee5\u901a\u8fc7\u6bd4\u8f83\u65f6\u95f4\u8ba1\u7b97\u548c\u7684\u53d8\u5316\uff0c$2$ \u64cd\u4f5c\u548c\u5c31\u4e3a $n\\times x$\u3002\n\n\u6700\u540e\uff0c\u4e00\u5b9a\u8981\u5f00 `long long`\u3002\n### \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nnamespace solution{\n#define ll long long\nconstexpr int N=2e5+5;\nint a[N],t[N],tag,T=-1;\nvoid main(){\n#ifdef IAKIOI\n\tfreopen(\"in.txt\",\"r\",stdin);\n#endif\n\tint n,q,op,x,y;\n\tll sum=0;\n\tcin>>n>>q;\n\tfor(int i=1;i<=n;++i)\n\t\tcin>>a[i],sum+=a[i];\n\tfor(int i=1;i<=q;++i){\n\t\tcin>>op>>x;\n\t\tif(op==1){\n\t\t\tcin>>y;\n\t\t\tsum+=y-(t[x]>T?a[x]:tag);\n\t\t\tt[x]=i,a[x]=y;\n\t\t}\n\t\telse\n\t\t\ttag=x,T=i,sum=(ll)n*x;\n\t\tcout<<sum<<'\\n';\n\t}\n}\n}\nint main(){\n\tios::sync_with_stdio(false);\n\tcin.tie(nullptr);\n\treturn solution::main(),0;\n}\n\n```\n",
        "postTime": 1652679251,
        "uid": 478461,
        "name": "lfxxx",
        "ccfLevel": 7,
        "title": "CF1679B Stone Age Problem"
    },
    {
        "content": "\u7ef4\u62a4\u4e00\u4e2a\u5e8f\u5217 $a$\uff0c\u8981\u6c42\u652f\u6301\u4e24\u79cd\u64cd\u4f5c\uff1a\n\n1. \u7ed9\u5b9a $i,x$\uff0c\u5c06 $a_i$ \u4fee\u6539\u4e3a $x$\uff1b\n2. \u7ed9\u5b9a $x$\uff0c\u5c06\u6574\u4e2a\u6570\u7ec4\u4fee\u6539\u4e3a $x$\u3002\n\n\u6c42\u51fa\u6bcf\u6b21\u64cd\u4f5c\u540e\u6574\u4e2a\u6570\u7ec4\u7684\u503c\u3002\n\n\u672c\u9898\u6d89\u53ca\u533a\u95f4\u64cd\u4f5c\uff0c\u53ef\u4ee5\u4f7f\u7528\u7ebf\u6bb5\u6811\u6765\u7ef4\u62a4\u3002\n\n\u5173\u4e8e\u7ebf\u6bb5\u6811\u7684\u539f\u7406\uff0c\u6b64\u5904\u4e0d\u4f1a\u8be6\u89e3\uff0c\u56e0\u4e3a\u5df2\u6709[\u6a21\u677f\u9898](https://www.luogu.com.cn/problem/P1253)\uff08\u542b\u6709\u533a\u95f4\u8986\u76d6\u7684\u7ebf\u6bb5\u6811\uff09\u7684\u5b58\u5728\u3002\n\n```cpp\n// author: TMJYH09\n// create time: 2022/05/15 00:13:22\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\n\nint n,q;\nint a[200005];\nstruct seg{\n    int l,r;\n    int sum,cov;\n}tr[200005<<2];\n#define ls(x) (x<<1)\n#define rs(x) (x<<1|1)\ninline void pushup(int p){tr[p].sum=tr[ls(p)].sum+tr[rs(p)].sum;}\nvoid build(int p,int l,int r){\n    tr[p].l=l;tr[p].r=r;\n    if(l==r){tr[p].sum=a[l];return;}\n    int mid=l+r>>1;\n    build(ls(p),l,mid);\n    build(rs(p),mid+1,r);\n    pushup(p);\n}\nvoid pushdown(int p){\n    if(tr[p].cov){\n        tr[ls(p)].cov=tr[rs(p)].cov=tr[p].cov;\n        tr[ls(p)].sum=(tr[ls(p)].r-tr[ls(p)].l+1)*tr[p].cov;\n        tr[rs(p)].sum=(tr[rs(p)].r-tr[rs(p)].l+1)*tr[p].cov;\n        tr[p].cov=0;\n    }\n}\nvoid modify(int p,int x,int k){\n    if(tr[p].l==tr[p].r){\n        tr[p].cov=tr[p].sum=k;return;\n    }\n    pushdown(p);\n    int mid=tr[p].l+tr[p].r>>1;\n    if(x<=mid)modify(ls(p),x,k);\n    else modify(rs(p),x,k);\n    pushup(p);\n}\nvoid cover(int p,int l,int r,int k){\n    if(l<=tr[p].l&&tr[p].r<=r){\n        tr[p].cov=k;\n        tr[p].sum=(tr[p].r-tr[p].l+1)*k;\n        return;\n    }\n    pushdown(p);\n    int mid=tr[p].l+tr[p].r>>1;\n    if(l<=mid)cover(ls(p),l,r,k);\n    if(mid<r)cover(rs(p),l,r,k);\n    pushup(p);\n}\n\nsigned main(){\n    ios::sync_with_stdio(false),cin.tie(nullptr);\n    cin>>n>>q;\n    for(int i=1;i<=n;i++)cin>>a[i];\n    build(1,1,n);\n    while(q--){\n        int t;\n        cin>>t;\n        if(t==1){\n            int i,x;cin>>i>>x;modify(1,i,x);\n        }else{\n            int x;cin>>x;cover(1,1,n,x);\n        }\n        cout<<tr[1].sum<<endl;\n    }\n    return 0;\n}\n```",
        "postTime": 1652604346,
        "uid": 482728,
        "name": "Engulf",
        "ccfLevel": 0,
        "title": "CF1679B Stone Age Problem \u9898\u89e3"
    },
    {
        "content": "## \u9898\u610f\n\u7ed9\u4f60\u4e00\u4e2a\u957f\u5ea6\u4e3a $n(n \\le 2 \\times 10^5)$ \u7684\u5e8f\u5217\u548c $q(q \\le 2 \\times 10^5)$ \u4e2a\u8be2\u95ee\uff0c\u8be2\u95ee\u683c\u5f0f\u4e3a\uff1a\n\n```\n1 i x\n```\n\u6216\n```\n2 x\n```\n\u5176\u4e2d\u7b2c\u4e00\u79cd\u8868\u793a\u628a\u4e0b\u6807\u4e3a $i$ \u7684\u5143\u7d20\u6539\u4e3a $k$ \uff0c\u7b2c\u4e8c\u79cd\u8868\u793a\u628a\u6240\u6709\u5143\u7d20\u6539\u6210 $x$ \u3002\n\u6bcf\u6b21\u4fee\u6539\u540e\u90fd\u8981\u8f93\u51fa\u8be5\u6570\u7ec4\u7684\u6240\u6709\u5143\u7d20\u4e4b\u548c\u3002\n## \u601d\u8def\n\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u8bb0\u5f55\u6240\u6709\u5143\u7d20\u7684\u548c\uff0c\u6b64\u5904\u8bbe\u4e3a \n$\\textbf{sum}$ \u3002\n\n\u53e6\u5916\uff0c\u7528 $\\textbf{set}$ \u8bb0\u5f55\u6240\u6709\u6ee1\u8db3\n* \u5728\u4e00\u6b21\u6574\u4f53\u4fee\u6539\uff08\u8be2\u95ee\u4e8c\uff09\u540e\u5355\u72ec\u4fee\u6539\uff08\u8be2\u95ee\u4e00\uff09\u7684\u5143\u7d20\n\n\u7684\u4e0b\u6807\u3002\u7279\u522b\u5730\uff0c\u4e00\u5f00\u59cb\u6240\u6709\u5143\u7d20\u90fd\u5728\u5176\u4e2d\u3002\n\n\u5219\u5bf9\u4e8e\u67e5\u8be2\u4e8c\uff0c\u6211\u4eec\u53ea\u9700\u8981\u628a $\\textbf{sum}$ \u6539\u4e3a $x \\times n$ \u5373\u53ef\uff0c\u540c\u65f6\u6e05\u7a7a $\\textbf{set}$ \uff1b\n\n\u5bf9\u4e8e\u67e5\u8be2\u4e00\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u6b64\u4e0b\u6807\u662f\u5426\u5728 $\\textbf{set}$ \u4e2d\uff0c\u82e5\u4e0d\u5728\uff0c\u5219\u8be5\u5143\u7d20\u4fee\u6539\u524d\u5373\u662f\u4e0a\u4e00\u6b21\u67e5\u8be2\u4e8c\u4e2d\u7684 $x$ \u503c\uff0c\u540c\u65f6\u628a\u5176\u4e0b\u6807\u52a0\u5165 $\\textbf{set}$ \uff0c\u5e76\u4fee\u6539\u5b83\u5728\u6570\u7ec4\u4e2d\u7684\u503c\uff1b\n\n\u5426\u5219\uff0c\u8fd9\u4e2a\u5143\u7d20\u4fee\u6539\u524d\u7684\u503c\u5c31\u662f\u5728\u6570\u7ec4\u4e2d\u8bb0\u5f55\u7684\u503c\u3002\n\n\u5982\u679c\u4e0d\u597d\u7406\u89e3\uff0c\u53ef\u4ee5\u914d\u5408\u4ee3\u7801\u98df\u7528\u3002\n\n~~\u672c\u9898\u5176\u5b9e\u662f\u88f8\u7684[\u7ebf\u6bb5\u6811](https://oi-wiki.org/ds/seg/)~~\n## Code\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nlong long useTC,mod;\n// /*segment tree*/   template<typename T>struct segment_tree{unsigned int N;vector<T> tree,lazy_tag;T build(unsigned int l,unsigned int r,unsigned int p,const vector<T> &original){if(l==r){return tree[p]=original[l];}unsigned int m=l+((r-l)>>1);return tree[p]=build(l,m,p<<1,original)+build(m+1,r,(p<<1)|1,original);}void update(unsigned int l,unsigned int r,T c,unsigned int s=0,unsigned int t=0,unsigned int p=1){if(p==1){s=1,t=N;}if(l<=s&&t<=r){tree[p]+=(t-s+1)*c,lazy_tag[p]+=c;return;}unsigned int m=s+((t-s)>>1);if(lazy_tag[p]){tree[p<<1]+=lazy_tag[p]*(m-s+1),tree[(p<<1)|1]+=lazy_tag[p]*(t-m),lazy_tag[p<<1]+=lazy_tag[p],lazy_tag[(p<<1)|1]+=lazy_tag[p];}lazy_tag[p]=0;if(l<=m){update(l,r,c,s,m,p<<1);}if(r>m){update(l,r,c,m+1,t,(p<<1)|1);}tree[p]=tree[p<<1]+tree[(p<<1)|1];}T getsum(unsigned int l,unsigned int r,unsigned int s=0,unsigned int t=0,unsigned int p=1){if(p==1){s=1,t=N;}if(l<=s&&t<=r) {return tree[p];}unsigned int m=s+((t-s)>>1);if(lazy_tag[p]){tree[p<<1]+=lazy_tag[p]*(m-s+1),tree[(p<<1)|1]+=lazy_tag[p]*(t-m),lazy_tag[p<<1]+=lazy_tag[p],lazy_tag[(p<<1)|1]+=lazy_tag[p];}lazy_tag[p]=0;T sum=0;if(l<=m) {sum=getsum(l,r,s,m,p<<1);}if(r>m) {sum+=getsum(l,r,m+1,t,(p<<1)|1);}return sum;}segment_tree(vector<T> original={0}){N=original.size();if(original.size()==1&&original[0]==0){N=100005;}original.insert(original.begin(),0),tree.resize(4*N),lazy_tag.resize(4*N),build(1,N,1,original),tree[0]=N;}};\n/*union find set*/ struct union_find{int N;vector<int> fa;union_find(int n=100005):N(n){fa.resize(n+1);for(int i=1;i<=n;++i)fa[i]=i;}int root(int x){return ((fa[x]==x)?(x):(fa[x]=root(fa[x])));}void unite(int a,int b){fa[root(a)]=root(b);}bool same(int a,int b){return root(a)==root(b);}};\n/*yes or no*/      inline string YN(bool x,string Y=\"Yes\",string N=\"No\"){return (x)?(Y):(N);}\n/*quick pow*/      template<typename T>T pow(T a,T b,T m=mod){T res=1;a%=m;while(b>0){res=(b&1)?(res*a%m):(res);a=a*a%m;b>>=1;}return res;}\nusing uint=unsigned int; using i64=long long; using u64=unsigned long long;\nusing pii=pair<int,int>; using puu=pair<unsigned,unsigned>; using p64=pair<long long,long long>; using pu64=pair<unsigned long long,unsigned long long>;\ntemplate<class t,class u> ostream& operator<<(ostream& os,const pair<t,u>& p){return os<<\"(\"<<p.first<<\",\"<<p.second<<\")\";}\n#define f0(i,n)     for(long long i=0;i<n;++i)\n#define f1(i,n)     for(long long i=1;i<=n;++i)\n#define ff(i,b,e,s) for(long long i=b;i<=e;i+=s)\n#define all(n)      n.begin(),n.end()\n#define fir         first\n#define sec         second\n#define pb          push_back\n#define mp          make_pair\n#define over(n,v)   {n; return v;}\n/*\n    NOTE:\n    Never define variable or functions called 'f0' or 'f1' or 'ff'\n    There may be strange bugs in function pow(a,b,m) and ceil()\n    Use i64 if necessary\n    Check useTC\n    Priority_queue is max-heap (default)\n*/\n//Global Variables & Functions\nset<i64> notsame; //\u82e5i\u5728\u5176\u4e2d\u5219\u8868\u793a\u5728\u4e00\u6b21\u8be2\u95ee\u4e8c\u540e\u5355\u72ec\u4fee\u6539\u4e86a[i]\ni64 a[300000];\ni64 n,q;\nsigned temp__main()\n{\n    cin>>n>>q;\n    i64 all=0LL,sum=0LL;\n    f0(i,n) \n    {\n        cin>>a[i];\n        notsame.insert(i);\n        sum+=a[i];\n    }\n    while(q--)\n    {\n        i64 op;cin>>op;\n        if(op==2) \n        {\n            cin>>all;\n            sum=all*n;\n            notsame.clear();\n            cout<<sum<<endl;\n        }\n        else\n        {\n            i64 pos,val;\n            cin>>pos>>val;\n            pos--;\n            i64 ori;\n            if(notsame.count(pos)) ori=a[pos]; //\u5728set\u4e2d\n            else ori=all,notsame.insert(pos); //\u4e0d\u5728set\u4e2d\n            a[pos]=val;\n            sum=sum-ori+val;\n            cout<<sum<<endl;\n        }\n    }\n    return 0;\n}\nvoid temp__init()\n{\n    ios::sync_with_stdio(false),cin.tie(0),cout.tie(0);\n    cout.setf(ios::fixed),cout.precision(20);\n    useTC=0,mod=1000000007;\n    unsigned long long temp__t=1;\n    if(useTC)cin>>temp__t;\n    while(temp__t--) temp__main();\n}\nsigned main()\n{\n    temp__init();\n    return 0;\n}\n\n```\n\n",
        "postTime": 1652711387,
        "uid": 508624,
        "name": "Chronomia",
        "ccfLevel": 0,
        "title": "CF1679B Stone Age Problem \u9898\u89e3"
    },
    {
        "content": "## \u7b80\u8981\u9898\u610f\n\n\u4f60\u9700\u8981\u7ef4\u62a4\u4e00\u4e2a\u5e8f\u5217\uff0c\u652f\u6301\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n\n- \u7ed9\u5b9a $v$\uff0c\u5c06\u8fd9\u4e2a\u5e8f\u5217\u7684\u6240\u6709\u5143\u7d20\u8d4b\u503c\u4e3a $v$\u3002\n- \u7ed9\u5b9a $p,v$\uff0c\u5c06\u7b2c $p$ \u4e2a\u8d4b\u503c\u4e3a $v$\u3002\n\n\u6bcf\u4e00\u6b21\u64cd\u4f5c\u540e\uff0c\u9700\u8981\u8f93\u51fa\u8fd9\u4e2a\u5e8f\u5217\u6240\u6709\u5143\u7d20\u7684\u548c\u3002\n\n## \u601d\u8def\n\n\u8fd9\u9053\u9898\u5176\u5b9e\u662f\u4e00\u4e2a\u88f8\u7684\u7ebf\u6bb5\u6811\uff0c\u53ea\u8981\u652f\u6301\u533a\u95f4\u4fee\u6539\u533a\u95f4\u67e5\u8be2\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n+q\\log n)$\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\n\n#define ls (i<<1)\n#define rs (i<<1|1)\n#define mid ((l+r)>>1)\n\nconst int SIZE = 2e5+5;\nint tree[SIZE<<2],tag[SIZE<<2];\nint n,m;\nint a[SIZE];\n\nvoid pushup(int i) {\n\ttree[i]=tree[ls]+tree[rs];\n}\nvoid build(int i,int l,int r) {\n\ttag[i]=LLONG_MIN;\n\tif(l==r) {\n\t\ttree[i]=a[l];\n\t\treturn ;\n\t}\n\tbuild(ls,l,mid);\n\tbuild(rs,mid+1,r);\n\tpushup(i);\n}\nvoid pushdown(int i,int l,int r) {\n\tif(tag[i]!=LLONG_MIN) {\n\t\ttag[ls]=tag[i];\n\t\ttag[rs]=tag[i];\n\t\ttree[ls]=(mid-l+1)*tag[i];\n\t\ttree[rs]=(r-mid)*tag[i];\n\t\ttag[i]=LLONG_MIN;\n\t}\n}\nvoid update(int i,int l,int r,int x,int y,int k) {\n\tif(l>=x&&r<=y) {\n\t\ttree[i]=(r-l+1)*k;\n\t\ttag[i]=k;\n\t\treturn ;\n\t}\n\tpushdown(i,l,r);\n\tif(mid>=x) update(ls,l,mid,x,y,k);\n\tif(mid<y) update(rs,mid+1,r,x,y,k);\n\tpushup(i);\n}\nint query(int i,int l,int r,int x,int y) {\n\tif(l>=x&&r<=y) {\n\t\treturn tree[i];\n\t}\n\tpushdown(i,l,r);\n\tint ret=0;\n\tif(mid>=x) ret+=query(ls,l,mid,x,y);\n\tif(mid<y) ret+=query(rs,mid+1,r,x,y);\n\treturn ret;\n}\n\nsigned main() {\n\tcin>>n>>m;\n\tfor(int i=1; i<=n; i++) {\n\t\tcin>>a[i];\n\t}\n\tbuild(1,1,n);\n\twhile(m--) {\n\t\tint opt,p,k;\n\t\tcin>>opt;\n\t\tif(opt==1) {\n\t\t\tcin>>p>>k;\n\t\t\tupdate(1,1,n,p,p,k);\n\t\t} else {\n\t\t\tcin>>k;\n\t\t\tupdate(1,1,n,1,n,k);\n\t\t}\n\t\tcout<<query(1,1,n,1,n)<<'\\n';\n\t}\n\treturn 0;\n}\n```\n\n[Record](https://www.luogu.com.cn/record/75859787)\n\n\u5176\u5b9e\u4e5f\u53ef\u4ee5\u76f4\u63a5\u8f93\u51fa `tree[1]`\uff0c\u4e5f\u5c31\u662f\u6839\u8282\u70b9\uff0c\u6548\u7387\u63d0\u5347\u4e86\u4e0d\u5c11\u3002\uff08\u7559\u5f85\u8bfb\u8005\u81ea\u5df1\u5199\uff09",
        "postTime": 1652676108,
        "uid": 413065,
        "name": "xiezheyuan",
        "ccfLevel": 5,
        "title": "CF1679B Stone Age Problem"
    },
    {
        "content": "## \u9898\u610f\n\n\u7ed9\u4f60\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u5217 $a$\uff0c\u8fdb\u884c $q$ \u6b21\u64cd\u4f5c\u3002\u64cd\u4f5c\u6709\u4e09\u79cd\uff1a\n- \u628a $a_i$ \u8d4b\u503c\u4e3a $x$\uff1b\n- \u628a $a$ \u4e2d\u6240\u6709\u6570\u5b57\u8d4b\u503c\u4e3a $x$\uff1b\n- \u67e5\u8be2 $a$ \u7684\u6240\u6709\u5143\u7d20\u548c\u3002\n\n$n, q \\leq 2\\times 10^5$\u3002\n\n## \u5206\u6790\n\n\u770b\u5230\u7b2c\u4e8c\u79cd\u64cd\u4f5c\uff08\u533a\u95f4\u63a8\u5e73\uff09\uff0c\u60f3\u5230\u73c2\u6735\u8389\u6811\u3002\n\n\u867d\u7136\u6b64\u9898\u6570\u636e\u4e0d\u4fdd\u8bc1\u968f\u673a\uff0c\u4f46\u662f\u53ea\u6709\u5355\u70b9\u4fee\u6539\u548c\u533a\u95f4\u8d4b\u503c\u4e24\u79cd\u4fee\u6539\u64cd\u4f5c\uff0c\u4e14\u6240\u6709\u7684\u67e5\u8be2\u64cd\u4f5c\u8303\u56f4\u90fd\u4e00\u81f4\uff0c\u6240\u4ee5\u8fd8\u662f\u53ef\u4ee5\u8dd1\u8fc7\u53bb\u7684\u3002\n\n\u987a\u5e26\u4e00\u63d0\uff0c\u7531\u4e8e\u73c2\u6735\u8389\u6811\u7684\u6bcf\u4e2a\u533a\u95f4\u90fd\u662f\u76f8\u90bb\u7684\uff0c\u540e\u4e00\u4e2a\u533a\u95f4\u7684\u5de6\u7aef\u70b9\u7b49\u4e8e\u524d\u4e00\u4e2a\u533a\u95f4\u7684\u53f3\u7aef\u70b9\uff0c\u6240\u4ee5\u73c2\u6735\u8389\u6811\u4e5f\u53ef\u4ee5\u7528 `std::map` \u6765\u5b9e\u73b0\u2014\u2014\n\n\u7528\u4e8c\u5143\u7ec4 $[l, val]$ \u8868\u793a\u73c2\u6735\u8389\u6811\u7684\u6bcf\u4e2a\u533a\u95f4\uff0c\u4f7f\u7528 `std::map<int, int>` \u5b58\u50a8\u3002`key` \u662f\u533a\u95f4\u7684\u5de6\u7aef\u70b9\uff0c`value` \u662f\u533a\u95f4\u7684\u503c\u3002\u8fd9\u6bd4 `set` \u7684\u5199\u6cd5\u7b80\u6d01\u4e0d\u5c11\u3002\n\n[\u73c2\u6735\u8389\u6811\u505a\u6cd5\u4ee3\u7801](https://www.luogu.com.cn/paste/tf180kku)\n\n## \u66f4\u4f18\u7684\u505a\u6cd5\n\n\u867d\u7136\u73c2\u6735\u8389\u6811\u7684\u505a\u6cd5\u53ef\u4ee5\u8fc7\uff0c\u4f46\u6709\u70b9\u78b0\u8fd0\u6c14\u7684\u6210\u5206\u3002\u5176\u5b9e\u6b64\u9898\u8fd8\u6709\u65e0\u9700\u6570\u636e\u7ed3\u6784\u7684\u505a\u6cd5\u3002\n\n\u53ea\u9700\u8bb0\u5f55\u6bcf\u4e2a\u4f4d\u7f6e\u4e0a\u6b21\u4fee\u6539\u7684\u65f6\u95f4\u6233\uff08`lastSingle[i]`\uff09\u3001\u4ee5\u53ca\u4e0a\u4e00\u6b21\u5168\u5c40\u4fee\u6539\u662f\u4ec0\u4e48\u65f6\u5019\u3001\u4fee\u6539\u6210\u4e86\u4ec0\u4e48\u5373\u53ef\uff08`lastAll`\uff0c`lastAllVal`\uff09\u3002\n\n\u540c\u65f6\u7ef4\u62a4\u6574\u4e2a\u6570\u5217\u7684\u548c\uff1a\u82e5\u662f\u5168\u5c40\u4fee\u6539\uff0c\u65b0\u7684\u6570\u5217\u548c\u662f $n\\times x$\uff1b\u5982\u679c\u662f\u5355\u70b9\u4fee\u6539\uff0c\u5224\u65ad\u4fee\u6539\u7684\u4f4d\u7f6e\u4e4b\u524d\u662f\u4ec0\u4e48\uff08\u5229\u7528\u65f6\u95f4\u6233\uff09\uff0c\u7136\u540e\u52a0\u52a0\u51cf\u51cf\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n+q)$\uff0c\u989d\u5916\u7a7a\u95f4\u590d\u6742\u5ea6 $O(n)$\u3002\n\n```cpp\nvoid solution() {\n  int n, q;\n  read(n, q);\n  std::vector<int> a(n + 1);\n  for (int i = 1; i <= n; ++i) read(a[i]);\n  ll s = std::accumulate(a.begin() + 1, a.end(), 0ll);\n  int lastAll = -1, lastAllVal = -1;\n  std::vector<int> lastSingle(n + 1);\n  for (int _ = 1; _ <= q; ++_) {\n    int opt;\n    read(opt);\n    if (opt == 1) {\n      int idx, x;\n      read(idx, x);\n      s -= lastSingle[idx] < lastAll ? lastAllVal : a[idx];\n      s += x;\n      lastSingle[idx] = _;\n      a[idx] = x;\n    } else {\n      int x;\n      read(x);\n      lastAll = _;\n      lastAllVal = x;\n      s = 1ll * x * n;\n    }\n    print(s);\n  }\n}\n```",
        "postTime": 1652620121,
        "uid": 53062,
        "name": "Anguei",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1679B\u3010Stone Age Problem\u3011"
    },
    {
        "content": "## \u9898\u76ee\u5927\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a $n$ \u9879\u6570\u5217 $a$\uff0c\u6709\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n\n- \u5355\u70b9\u4fee\u6539 $a_i$ \u4e3a $x$\n- \u5c06 $a$ \u4e2d\u7684\u6240\u6709\u503c\u5168\u90e8\u6539\u4e3a $x$\n\n\u6bcf\u6b21\u64cd\u4f5c\u540e\u8f93\u51fa\u6570\u5217\u548c\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\leqslant n,q\\leqslant2\\cdot 10^5$\n\n## \u601d\u8def\n\n\u4e00\u4e2a\u6700\u4e3a\u7eaf\u7cb9\u7684\u60f3\u6cd5\u662f\u641e\u4e00\u4e2a\u7ebf\u6bb5\u6811\uff0c\u6709\u5355\u70b9\u4fee\u6539\u548c\u5168\u5c40\u63a8\u5e73\uff0c\u8fd8\u8981\u7ef4\u62a4\u548c\uff0c\u663e\u7136\u5f88\u4e0d\u60f3\u5199\u3002\n\n\u4f46\u662f\u6211\u4eec\u53d1\u73b0\u53ea\u7528\u8f93\u51fa\u6240\u6709\u6570\u7684\u548c\uff0c\u6211\u4eec\u4e0d\u59a8\u8bd5\u8bd5\u8131\u79bb\u7ebf\u6bb5\u6811\u3002\n\n### \u5355\u70b9\u4fee\u6539\n\n\u5f88\u5bb9\u6613\uff0c\u539f\u6570\u4e3a $a_i$\uff0c\u6539\u6210 $g$\uff0c\u76f4\u63a5\u7ed9\u548c\u52a0\u4e0a\u4e00\u4e2a $g-a_i$ \u5c31\u884c\u4e86\u3002\n\n### \u5168\u5c40\u63a8\u5e73\n\n\u5047\u8bbe\u6539\u6210 $g$ \u76f4\u63a5\u628a\u548c\u6539\u6210 $g\\times n$ \u5c31\u884c\u3002\n\n\u4f46\u662f\u8fd9\u4f1a\u548c\u5355\u70b9\u4fee\u6539\u51b2\u7a81\u7684\u5730\u65b9\u5728\u4e8e\uff0c\u5168\u5c40\u63a8\u5e73\u4e4b\u540e\u6211\u4eec\u4e0d\u4f1a\u53bb\u4fee\u6539 $a_i$\uff0c\u6240\u4ee5\u6211\u4eec\u5f97\u5728\u5355\u70b9\u4fee\u6539\u7684\u65f6\u5019\u5c06 $a_i$ \u6539\u4e3a\u4e0a\u6b21\u63a8\u5e73\u7684\u6570\u3002\n\n\u4f46\u662f\u8fd9\u53c8\u4f1a\u51fa\u95ee\u9898\uff0c\u6211\u4eec\u65e0\u6cd5\u77e5\u9053\u8fd9\u4e2a\u8981\u88ab\u4fee\u6539\u7684\u6570\u6709\u6ca1\u6709\u88ab\u63a8\u5e73\u8fc7\u3002\u5047\u8bbe\u4e00\u6b21\u63a8\u5e73\u4e4b\u540e\u6211\u4eec\u8981\u4fee\u6539\u4e24\u6b21\u5b83\uff0c\u6bcf\u6b21\u5b83\u90fd\u4f1a\u88ab\u6539\u6210\u63a8\u5e73\u7684\u90a3\u4e2a\u6570\uff0c\u7b2c\u4e8c\u6b21\u4fee\u6539\u540e\u7ef4\u62a4\u7684\u548c\u5c31\u4e0d\u5bf9\u4e86\u3002\u4e5f\u4e0d\u80fd\u901a\u8fc7\u662f\u5426\u7b49\u4e8e\u63a8\u5e73\u6570\u8fd9\u6837\u7b80\u5355\u7684\u5224\u65ad\u6765\u5904\u7406\uff0c\u6240\u4ee5\u6211\u4eec\u5fc5\u987b\u5728\u4fee\u6539\u4e4b\u540e\u6253\u4e0a\u6807\u8bb0\uff0c\u7136\u540e\u5728\u4e0b\u6b21\u63a8\u5e73\u7684\u65f6\u5019\u6e05\u6389\u6240\u6709\u6807\u8bb0\u3002\n\n\u4f46\u662f\u8fd9\u6837\u65f6\u95f4\u4f1a\u88ab\u5361\u6210 $O(nq)$\uff0c`memset` \u6e05\u6807\u8bb0\u592a\u6162\u4e86\u3002\u5bb9\u6613\u53d1\u73b0\u6211\u4eec\u5176\u5b9e\u628a\u5f88\u591a\u6ca1\u6709\u6807\u8bb0\u7684\u70b9\u6e05\u6210\u4e86\u6ca1\u6709\u6807\u8bb0\u7684\u70b9\uff0c\u6beb\u65e0\u610f\u4e49\uff0c\u6240\u4ee5\u4f7f\u7528\u4e00\u4e2a\u6808\u4fdd\u5b58\u54ea\u4e9b\u6807\u8bb0\u9700\u8981\u6e05\u7a7a\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u56de\u5230 $O(n+q)$\uff0c\u539f\u56e0\u662f\u5982\u679c\u6bcf\u6b21\u90fd\u8981\u7ed9 $x$ \u4e2a\u6570\u6e05\u6807\u8bb0\uff0c\u90a3\u4e48\u6700\u591a\u4e5f\u5c31\u53ea\u6709 $\\frac{n}{x}$ \u6b21\uff0c\u603b\u5171\u662f\u662f $O(n)$ \u7684\u3002\n\n## \u4ee3\u7801\n\n```\n//Author:Zealous_YH\n//Hai Bian & Xiao Bao\n#include <bits/stdc++.h>\n#define ET return 0\n#define fi first\n#define se second\n#define mp make_pair\n#define pb push_back\n#define ll long long\n#define ull unsigned long long\n#define inf INT_MAX\n#define uinf INT_MIN\n#define pt puts(\"\")\n#define fr1(i,a,b) for(int i=a;i<=b;i++)\n#define fr2(i,a,b) for(int i=a;i>=b;i--)\n#define fv(i,p) for(int i=0;i<p.size();i++)\nusing namespace std;\nconst int N=2e5+10;\nint maxn=uinf,minn=inf;\nint tnt,tot;\nll n,q;\nll sum;\nll a[N];\nbool ok[N];\nll las;//\u8981\u5f00long long\nstack <int> s;\nint main(){\n\tlas=inf;\n\tcin>>n>>q;\n\tfr1(i,1,n){\n\t\tcin>>a[i];\n\t\tsum+=a[i];\n\t}\n\twhile(q--){\n\t\tll opt,x,y;\n\t\tcin>>opt;\n\t\tif(opt==1){\n\t\t\tcin>>x>>y;\n\t\t\tif(las!=inf&&!ok[x]){//\u8fd8\u6ca1\u6709\u63a8\u5e73\u8fc7\u6216\u8005\u5df2\u7ecf\u63a8\u5e73\u4e00\u6b21\u4e86\u5c31\u4e0d\u7528\u518d\u6765\u4e00\u6b21\u4e86\n\t\t\t\tok[x]=1;//\u6253\u6807\u8bb0\n\t\t\t\ta[x]=las;\n\t\t\t\ts.push(x);//\u4e22\u5230\u6808\u91cc\n\t\t\t}\n\t\t\tsum+=y-a[x];//\u5355\u70b9\u4fee\u6539\u6539\u548c\n\t\t\ta[x]=y;//\u8bb0\u5f97\u8981\u6539\u539f\u6570\u7ec4\n\t\t}\n\t\telse{\n\t\t\tcin>>x;\n\t\t\tlas=x;//\u8bb0\u5f55\u4e0a\u4e00\u6b21\u63a8\u5e73\u63a8\u5e73\u6210\u4e86\u4ec0\u4e48\u6570\n\t\t\tsum=x*n;\n\t\t\twhile(!s.empty()){\n\t\t\t\tok[s.top()]=0;//\u7528\u6808\u6765\u5feb\u901f\u6e05\u6807\u8bb0\n\t\t\t\ts.pop();\n\t\t\t}\n\t\t}\n\t\tcout<<sum<<endl;\n\t}\n\tET;\n}\n//Teens-in-Times\n//HJL 2004.06.15\n//Everything For Ji.\n//Everything For Lin.\n//Everything For You.\n```\n\n[\u8d5b\u65f6 AC](https://codeforces.com/contest/1679/submission/157157660)",
        "postTime": 1652592663,
        "uid": 399150,
        "name": "Shunpower",
        "ccfLevel": 7,
        "title": "CF1679B Stone Age Problem \u9898\u89e3"
    },
    {
        "content": "### \u9898\u76ee\u5927\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6b63\u6574\u6570\u5e8f\u5217 $a$\uff0c\u73b0\u5728\u6709 $q$ \u4e2a\u64cd\u4f5c\uff0c\u6bcf\u4e2a\u64cd\u4f5c\u5982\u4e0b\uff1a\n\n+ \u64cd\u4f5c $1$\uff0c\u5355\u70b9\u4fee\u6539\uff0c\u5c06 $a_i$ \u4fee\u6539\u4e3a $x$\u3002\n+ \u64cd\u4f5c $2$\uff0c\u5168\u5c40\u4fee\u6539\uff0c\u5c06\u6240\u6709 $i\\in[1,n]$ \u7684 $a_i$ \u4fee\u6539\u4e3a $x$\u3002\n\n\u6bcf\u6b21\u4fee\u6539\u5b8c\u6210\u540e\uff0c\u8981\u6c42\u8f93\u51fa\u6240\u6709 $a_i$ \u7684\u548c\u3002\n\n### \u57fa\u672c\u601d\u8def\n\n\u8fd9\u9053\u9898\u542c\u540c\u673a\u623f\u5de8\u4f6c [Zealous_YH](https://www.luogu.com.cn/user/399150) \u548c [L_h_](https://www.luogu.com.cn/user/413129) \u8bf4\uff0c\u8fd8\u80fd\u7528\u4e00\u4e9b\u6bd4\u672c\u9898\u89e3\u7684\u65b9\u6cd5\u66f4\u7b80\u4fbf\u7684\u89e3\u6cd5\uff0c\u6709\u95ee\u9898\u53ef\u4ee5\u95ee\u4e00\u4e0b\u4ed6\u4eec\uff0c\u8fd9\u91cc\u5c31\u4e0d\u8bb2\u4e86\u3002\n\n\u6211\u7684\u89e3\u6cd5\u5c31\u5f88\u66b4\u529b\uff0c\u76f4\u63a5\u628a $1$ \u64cd\u4f5c\u770b\u6210\u5355\u70b9\u4fee\u6539\uff0c$2$ \u64cd\u4f5c\u770b\u6210\u533a\u95f4\u4fee\u6539\uff0c\u6c42\u548c\u76f4\u63a5\u770b\u6210\u533a\u95f4\u548c\uff0c\u8fd9\u4e9b\u90fd\u53ef\u4ee5\u7528**\u7ebf\u6bb5\u6811**\u6765\u505a\uff0c\u7136\u540e\u5c31\u884c\u4e86\u3002\n\n\u8fd9\u4e2a\u5e94\u8be5\u662f\u6253\u8fc7\u7ebf\u6bb5\u6811\u7684\u90fd\u4f1a\u7684\u5427\u3002\n\n\u7801\u98ce\u51d1\u5408\u7740\u770b\u5427\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define rep1(i, l, r) for (register int i(l); i <= r; ++i)\n#define rep2(i, l, r) for (register int i(l); i >= r; --i)\n#define int long long\nusing namespace std;\nconst int Buffer_Size = 1 << 10;\nnamespace {\n    char buffer[Buffer_Size], *ihead = buffer + Buffer_Size, *itail = ihead;\n    inline char Next_Char() {\n        if (ihead == itail) fread(buffer, 1, Buffer_Size, stdin), ihead = buffer;\n        return *ihead++;\n    }\n    template <typename T>\n    inline void read(T &x) {\n        x = 0; char ch = Next_Char(); T f = 1;\n        while (!isdigit(ch)) f -= (ch == '-') << 1, ch = Next_Char();\n        while (isdigit(ch)) x = (x << 1) + (x << 3) + (ch & 15), ch = Next_Char();\n        x *= f;\n    }\n    template <typename T, typename ...L> inline void read(T &x, L &...y) {read(x), read(y...);}\n    inline void readstr(string &s) {\n        s = \"\"; char ch = Next_Char();\n        while (ch == ' ' || ch == '\\n') ch = Next_Char();\n        while (ch ^ ' ' && ch ^ '\\n') s += ch, ch = Next_Char();\n    }\n    inline int read() {int x; read(x); return x;}\n}\nconst int N = 2e5 + 5;\nint n, q; \ninline int lson(int x) {return x << 1;}\ninline int rson(int x) {return x << 1 | 1;}\nstruct node {\n    int l, r; //\u5de6\u53f3\u7aef\u70b9\n    int tag, sum;\n} t[N << 2];\ninline void pushup(int x) { \n    t[x].sum = t[lson(x)].sum + t[rson(x)].sum; \n}\ninline void pushdown(int x) {\n    if (t[x].tag == -1) return ;\n    t[lson(x)].tag = t[rson(x)].tag = t[x].tag;\n    int mid = t[x].r + t[x].l >> 1;\n    t[lson(x)].sum = (mid - t[x].l + 1) * t[x].tag;\n    t[rson(x)].sum = (t[x].r - mid) * t[x].tag;\n    t[x].tag = -1;\n}\ninline void buildtree(int x, int l, int r) {\n    t[x].tag = -1; t[x].l = l; t[x].r = r;\n    if (t[x].l == t[x].r) {\n        t[x].sum = read();\n        return ;\n    } int mid = t[x].l + t[x].r >> 1;\n    buildtree(lson(x), l, mid);\n    buildtree(rson(x), mid + 1, r);\n    pushup(x);\n}\ninline void update(int x, int L, int R, int val) {\n    if (L <= t[x].l && t[x].r <= R) {\n        t[x].tag = val;\n        t[x].sum = val * (t[x].r - t[x].l + 1);\n        return ;\n    } int mid = t[x].l + t[x].r >> 1; pushdown(x);\n    if (L <= mid) update(lson(x), L, R, val);\n    if (R > mid) update(rson(x), L, R, val); \n    pushup(x);\n}\nsigned main(void) {\n    read(n, q); buildtree(1, 1, n);\n    while (q--) {\n        int op, pos, x; read(op);\n        if (op == 1) {\n            read(pos, x);\n            update(1, pos, pos, x);\n        } else {\n            read(x);\n            update(1, 1, n, x);\n        }\n        printf(\"%lld\\n\", t[1].sum);\n    }\n}\n```\n\n",
        "postTime": 1652588212,
        "uid": 377787,
        "name": "Hooch",
        "ccfLevel": 6,
        "title": "CF1679B"
    },
    {
        "content": "### Preface  \n\u7ebf\u6bb5\u6811\u677f\u5b50\u9898\u3002  \n### Problem  \n\u7ed9\u4f60\u4e00\u4e2a\u5e8f\u5217\uff0c\u6709\u4e24\u79cd\u64cd\u4f5c\uff1a  \n1.\u5c06\u5176\u4e2d\u4e00\u4e2a\u6570\u66f4\u6539\u3002  \n2.\u5168\u4f53\u66f4\u6539\u3002  \n\u6bcf\u6b21\u64cd\u4f5c\u5b8c\u8f93\u51fa\u5168\u90e8\u4e4b\u548c\u3002  \n### Solution  \n\u53d1\u73b0\u7b80\u76f4\u662f\u7ebf\u6bb5\u6811\u6a21\u677f\u9898\u7684\u5f31\u5316\u7248\uff0c\u8fde\u8be2\u95ee\u51fd\u6570\u90fd\u514d\u4e86\uff0c\u76f4\u63a5\u8f93\u51fa\u6839\u8282\u70b9\u7684\u503c\u5c31\u53ef\u4ee5\u4e86\uff0c\u61d2\u60f0\u6807\u8bb0\u4e5f\u76f4\u63a5\u6253\u5728\u6839\u8282\u70b9\u4e0a\uff0c\u66f4\u6539\u7684\u65f6\u5019\u4e0b\u4f20\u3002  \ncode\uff1a  \n```cpp\n#include <bits/stdc++.h>\n#define ll long long\nusing namespace std;\nint T;\nconst int N=2e5+10;\nll n;ll a[N];\nll q,t,x,y;\nll tree[N<<4];ll lazy[N<<4];\nvoid init(){\n\t\n}\nvoid pushdown(int rt,int left,int right){\n\tint mid=(left+right)/2;\n\tif(left==right)return;\n\tif(lazy[rt]){\n\t\tlazy[rt*2]=lazy[rt];\n\t\tlazy[rt*2+1]=lazy[rt];\n\t\ttree[rt*2]=(mid-left+1)*lazy[rt];\n\t\ttree[rt*2+1]=(right-mid)*lazy[rt];\n\t\tlazy[rt]=0;\n\t}\n}\nvoid pushup(int rt){\n\ttree[rt]=tree[rt*2]+tree[rt*2+1];\n}\nvoid update(int rt,int left,int right,int x,ll y){\n\tpushdown(rt,left,right);\n\tif(left==right){\n\t\ttree[rt]=y;lazy[rt]=0;return;\n\t}\n\tint mid=(left+right)/2;\n\tif(x<=mid)update(rt*2,left,mid,x,y);\n\telse update(rt*2+1,mid+1,right,x,y);\n\tpushup(rt);\n}\nvoid solve(){\n\tcin>>n>>q;\n\tfor(int i=1;i<=n;i++){\n\t\tcin>>a[i];\n\t\tupdate(1,1,n,i,a[i]);\n\t}\n\tfor(int i=1;i<=q;i++){\n\t\tcin>>t;\n\t\tif(t==1){\n\t\t\tcin>>x>>y;\n\t\t\tupdate(1,1,n,x,y);\n\t\t\tpushdown(1,1,n);\n\t\t\tcout<<tree[1]<<endl;\n\t\t}else{\n\t\t\tcin>>x;\n\t\t\tlazy[1]=x;\n\t\t\ttree[1]=n*x;\n\t\t\tcout<<n*x<<endl;\n\t\t}\n\t}\n}\nint main(){\n\tT=1;\n\twhile(T--)init(),solve();\n\treturn 0;\n}\n```\n",
        "postTime": 1652583516,
        "uid": 213173,
        "name": "\u5c0f\u6728\u866b",
        "ccfLevel": 4,
        "title": "\u3010\u849f\u84bb\u7684CF\u5b9e\u5f55\u3011CF1679B Stone Age Problem"
    }
]
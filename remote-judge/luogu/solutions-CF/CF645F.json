[
    {
        "content": "### \u9898\u610f\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u5217 $\\{a_i\\}$ \u548c\u4e00\u4e2a\u6574\u6570 $k$\uff0c\u7ed9\u51fa $q$ \u4e2a\u8be2\u95ee\uff0c\u6bcf\u6b21\u5411 $\\{a_i\\}$ \u52a0\u5165\u4e00\u4e2a\u65b0\u6570 $x$\uff0c\u5e76\u8be2\u95ee\u52a0\u5165\u8fd9\u4e2a\u6570\u4e4b\u540e\uff0c\u6570\u5217\u4e2d\u6240\u6709\u5927\u5c0f\u4e3a $k$ \u7684\u5b50\u96c6\u7684 $\\gcd$ \u4e4b\u548c\u3002\u6bcf\u6b21\u64cd\u4f5c\u6709\u540e\u6548\u6027\uff0c\u4f1a\u4fdd\u7559\u52a0\u5165\u7684\u6570\u3002  \n$1\\le n,k,q \\le 10^5$\uff0c$1 \\le a_i,x \\le 10^6$\u3002\n### \u9898\u89e3\n\u5b9a\u4e49 $m$ \u4e3a\u6240\u6709\u52a0\u5165\u7684\u6570\u548c\u6570\u5217\u4e2d\u539f\u6709\u7684\u6570\u7684\u6700\u5927\u503c\u3002  \n\u6211\u4eec\u8bbe $f(i)$ \u8868\u793a\u6240\u6709\u5927\u5c0f\u4e3a $k$ \u7684\u5b50\u96c6\u4e2d\uff0c$\\gcd$ \u4e3a $i$ \u7684\u5b50\u96c6\u6570\u91cf\uff0c\u6700\u7ec8\u7b54\u6848\u5c31\u662f $\\sum_{i=1}^m i\\times f(i)$\u3002  \n\u8003\u8651\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\uff0c\u5b9a\u4e49 $F(i)$ \u4e3a\u5927\u5c0f\u4e3a $k$ \u7684\u5b50\u96c6\u4e2d\uff0c$\\gcd$ \u4e3a $i$ \u7684\u500d\u6570\u7684\u65b9\u6848\u6570\uff0c\u6839\u636e\u5b9a\u4e49\u5bb9\u6613\u5f97\u5230 $F(i)=\\sum_{i|d} f(d)$\u3002  \n\u540c\u65f6\uff0c\u6211\u4eec\u8bb0 $cnt_i$ \u4e3a\u6570\u5217\u4e2d\u5b58\u5728\u56e0\u5b50 $i$ \u7684\u6570\u7684\u4e2a\u6570\uff0c\u5219 $F(i)$ \u4e2d\u6240\u6709\u5b50\u96c6\u5fc5\u7136\u662f\u4ece $cnt_i$ \u4e2a\u6570\u4e2d\u9009\u62e9 $k$ \u4e2a\u6570\u7684\u4e00\u4e2a\u65b9\u6848\u3002\u56e0\u6b64\uff0c\u53ef\u4ee5\u5f97\u5230 $F(i)=C_{cnt_i}^k$\u3002  \n\u901a\u8fc7\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u53ef\u4ee5\u7528 $F(i)$ \u8868\u793a $f(i)$\uff0c\u5f97\u5230\u5982\u4e0b\u5f0f\u5b50\uff1a\n\n$$f(i)=\\sum_{i|d} F(d)\\mu(\\frac{d}{i})=\\sum_{i|d}\\mu(\\frac{d}{i})\\times C_{cnt_d}^k$$\n\n$$Ans=\\sum_{i=1}^m i\\times f(i)=\\sum_{i=1}^m i \\sum_{i|d}\\mu(\\frac{d}{i})\\times C_{cnt_d}^k$$\n\n\u8003\u8651\u63d2\u5165\u4e00\u4e2a\u6570\u65f6\uff0c\u5982\u4f55\u66f4\u65b0\u7b54\u6848\u3002\u89c2\u5bdf\u5230\u6bcf\u6b21\u52a0\u5165\u4e00\u4e2a\u6570\u6700\u591a\u4f7f\u82e5\u5e72\u4e2a $cnt_x$ \u53d8\u5316 $1$\uff0c\u53ef\u4ee5\u4ece\u8fd9\u91cc\u5165\u624b\u3002  \n\u5bf9\u4e8e\u4e00\u4e2a $cnt_x$\uff0c\u5b83\u53ea\u4f1a\u5bf9\u6240\u6709 $i|x$ \u7684 $f(i)$ \u4e2d\u7684\u4e00\u9879\u4ea7\u751f\u8d21\u732e\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u7684\u8d21\u732e\u62c6\u51fa\u6765\uff0c\u5c31\u662f $\\sum_{i|x} i\\times \\mu(\\frac{x}{i})\\times C_{cnt_x}^k$\uff0c\u6bcf\u6b21 $cnt_x$ \u52a0 $1$ \u7684\u65f6\u5019\uff0c\u65b0\u589e\u7684\u8d21\u732e\u5c31\u662f $(C_{cnt_x+1}^k-C_{cnt_x}^k)\\times(\\sum_{i|x} i\\times \\mu(\\frac{x}{i}))$ \u3002  \n\u7531\u4e8e $\\mu*Id=\\varphi$\uff0c\u5bb9\u6613\u53d1\u73b0\u540e\u9762\u90a3\u4e00\u5927\u5768\u5c31\u662f\u6b27\u62c9\u51fd\u6570 $\\varphi(x)$\uff0c\u7ebf\u6027\u7b5b\u9884\u5904\u7406\u5373\u53ef\u3002  \n\u6211\u4eec\u628a\u8fd9 $n+q$ \u4e2a\u6570\u987a\u6b21\u52a0\u5165\uff0c\u6bcf\u6b21\u7ef4\u62a4 $cnt_x$ \u548c $Ans$ \u5373\u53ef\u6c42\u89e3\u3002\u6bcf\u6b21\u66f4\u65b0 $cnt_x$ \u590d\u6742\u5ea6\u4e3a $O(\\sqrt{m})$ \uff0c\u603b\u590d\u6742\u5ea6\u4e3a $O((n+q)\\sqrt{m})$\u3002\n### \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n#define reg register\ntypedef long long ll;\nusing namespace std;\nconst int mod=1e9+7;\nconst int MN=2e5+5;\nconst int MM=1e6+5;\nint fac[MN],inv[MN];\ninline ll C(int n,int m){\n\tif(n<m)return 0;\n\treturn 1ll*fac[n]*inv[m]%mod*inv[n-m]%mod;\n}\nint phi[MM],pri[MM],F[MM],pcnt;\nbool vis[MM];\nint n,m,q,Ans,cnt[MM];\nint main(){\n\tfac[0]=fac[1]=inv[0]=inv[1]=1;\n\tfor(reg int i=2;i<MN;i++)fac[i]=1ll*fac[i-1]*i%mod;\n\tfor(reg int i=2;i<MN;i++)inv[i]=1ll*(mod-mod/i)*inv[mod%i]%mod;\n\tfor(reg int i=2;i<MN;i++)inv[i]=1ll*inv[i-1]*inv[i]%mod;\n\tphi[1]=1;\n\tfor(reg int i=2;i<MM;i++){\n\t\tif(!vis[i])pri[++pcnt]=i,phi[i]=i-1;\n\t\tfor(reg int j=1;i*pri[j]<MM&&j<=pcnt;j++){\n\t\t\tvis[i*pri[j]]=true;\n\t\t\tif(i%pri[j]==0){phi[i*pri[j]]=phi[i]*pri[j];break;}\n\t\t\tphi[i*pri[j]]=phi[i]*(pri[j]-1);\n\t\t}\n\t}\n\tscanf(\"%d%d%d\",&n,&m,&q);\n\tfor(reg int i=1,x;i<=n;i++){\n\t\tscanf(\"%d\",&x);\n\t\tfor(reg int j=1;j*j<=x;j++){\n\t\t\tif(x%j)continue;cnt[j]++;Ans=(Ans+phi[j]*(C(cnt[j],m)-C(cnt[j]-1,m)))%mod;\n\t\t\tif(j*j!=x)cnt[x/j]++,Ans=(Ans+phi[x/j]*(C(cnt[x/j],m)-C(cnt[x/j]-1,m)))%mod;\n\t\t}\n\t}\n\twhile(q--){\n\t\tstatic int x;scanf(\"%d\",&x);\n\t\tfor(reg int j=1;j*j<=x;j++){\n\t\t\tif(x%j)continue;cnt[j]++;Ans=(Ans+phi[j]*(C(cnt[j],m)-C(cnt[j]-1,m)))%mod;\n\t\t\tif(j*j!=x)cnt[x/j]++,Ans=(Ans+phi[x/j]*(C(cnt[x/j],m)-C(cnt[x/j]-1,m)))%mod;\n\t\t}\n\t\tprintf(\"%d\\n\",(Ans+mod)%mod);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1588082899,
        "uid": 17930,
        "name": "Marser",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF645F \u3010Cowslip Collections\u3011"
    },
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a[\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14](https://oi-wiki.org/math/number-theory/mobius/)\n\n\u5bf9\u500d\u6570\u5f62\u5f0f\u7684\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u8fd8\u662f\u4e0d\u719f /kk\n\n\u8bbe $f(i)$ \u8868\u793a $\\gcd$ \u4e3a $i$ \u65f6\u7684\u7b54\u6848\uff0c$g(i)$ \u8868\u793a $\\gcd$ \u4e3a $j$ \u7684\u500d\u6570\u65f6\u7684\u7b54\u6848\uff0c\u5219 $g(i) = \\displaystyle\\sum_{i \\mid d}^N f(d)$\u3002\u7531\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u53ef\u5f97\uff1a$f(i) = \\displaystyle\\sum_{i \\mid d}^N \\mu(\\frac{i}{d}) g(d)$\u3002\n\n\u7b54\u6848 $= \\displaystyle\\sum_{i = 1}^N i f(i)$\n\n$ = \\displaystyle\\sum_{i = 1}^N i \\displaystyle\\sum_{i \\mid d}^N \\mu(\\frac{i}{d}) g(d)$\n\n$ = \\displaystyle\\sum_{d = 1}^N g(d) \\displaystyle\\sum_{i \\mid d} i \\mu(\\frac{i}{d})$\n\n$ = \\displaystyle\\sum_{d = 1}^N \\mu(d) g(d)$\n\n\u8bbe $cnt_i$ \u8868\u793a\u5f53\u524d $a$ \u4e2d\u4e3a $i$ \u7684\u500d\u6570\u7684\u6570\u7684\u4e2a\u6570\uff0c\u5219\u663e\u7136 $g(i) = C_{cnt_i}^k$\uff0c\u4e8e\u662f\u5728\u9884\u5904\u7406\u6bcf\u4e2a\u6570\u7684\u56e0\u6570\u540e\u679a\u4e3e\u56e0\u6570\u5e76\u66f4\u65b0\u7b54\u6848\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(N \\log N + \\sum \\tau(a_i) + \\sum \\tau(c_i))$\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <vector>\n#include <cstdio>\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst int N = 1e6, M = 2e5 + 7, mod = 1e9 + 7;\nint prime[N + 7], phi[N + 7], cnt[N + 7];\nll fac[M], inv_fac[M];\nbool p[N + 7];\nvector<int> v[N + 7];\n\ninline ll quick_pow(ll x, ll p, ll mod){\n\tll ans = 1;\n\twhile (p){\n\t\tif (p & 1) ans = ans * x % mod;\n\t\tx = x * x % mod;\n\t\tp >>= 1;\n\t}\n\treturn ans;\n}\n\ninline void init(int n){\n\tint cnt = 0;\n\tfor (register int i = 1; i <= N; i++){\n\t\tfor (register int j = i; j <= N; j += i){\n\t\t\tv[j].push_back(i);\n\t\t}\n\t}\n\tp[0] = p[1] = true;\n\tphi[1] = 1;\n\tfor (register int i = 2; i <= N; i++){\n\t\tif (!p[i]){\n\t\t\tprime[++cnt] = i;\n\t\t\tphi[i] = i - 1;\n\t\t}\n\t\tfor (register int j = 1; j <= cnt && i * prime[j] <= N; j++){\n\t\t\tint t = i * prime[j];\n\t\t\tp[t] = true;\n\t\t\tif (i % prime[j] == 0){\n\t\t\t\tphi[t] = phi[i] * prime[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tphi[t] = phi[i] * (prime[j] - 1);\n\t\t}\n\t}\n\tfac[0] = 1;\n\tfor (register int i = 1; i <= n; i++){\n\t\tfac[i] = fac[i - 1] * i % mod;\n\t}\n\tinv_fac[n] = quick_pow(fac[n], mod - 2, mod);\n\tfor (register int i = n - 1; i >= 0; i--){\n\t\tinv_fac[i] = inv_fac[i + 1] * (i + 1) % mod;\n\t}\n}\n\ninline ll comb(int n, int m, int mod){\n\tif (n < m) return 0;\n\treturn fac[n] * inv_fac[m] % mod * inv_fac[n - m] % mod;\n}\n\ninline ll insert(int x, int k){\n\tint size = v[x].size();\n\tll ans = 0;\n\tfor (register int i = 0; i < size; i++){\n\t\tll t = comb(cnt[v[x][i]], k, mod);\n\t\tcnt[v[x][i]]++;\n\t\tans += phi[v[x][i]] * (comb(cnt[v[x][i]], k, mod) - t) % mod;\n\t\tif (ans < 0){\n\t\t\tans += mod;\n\t\t} else if (ans >= mod){\n\t\t\tans -= mod;\n\t\t}\n\t}\n\treturn ans;\n}\n\nint main(){\n\tint n, k, q;\n\tll ans = 0;\n\tscanf(\"%d %d %d\", &n, &k, &q);\n\tinit(n + q);\n\tfor (register int i = 1; i <= n; i++){\n\t\tint a;\n\t\tscanf(\"%d\", &a);\n\t\tans = (ans + insert(a, k)) % mod;\n\t}\n\tfor (register int i = 1; i <= q; i++){\n\t\tint c;\n\t\tscanf(\"%d\", &c);\n\t\tans = (ans + insert(c, k)) % mod;\n\t\tprintf(\"%lld\\n\", ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1641987107,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF645F \u3010Cowslip Collections\u3011"
    },
    {
        "content": "\u4e00\u79cd\u4e0d\u7528\u6b27\u62c9\u51fd\u6570\u7684\u505a\u6cd5\u3002\n\n\u6839\u636e\u83ab\u53cd\u5957\u8def\uff0c\u8bbe $f(x)$ \u4e3a $\\gcd$ \u4e3a $x$ \u7684 $k$ \u4e2a\u6570\u7684\u7ec4\u6570\uff0c $F(x)$ \u4e3a $\\gcd$ \u4e3a $x$ \u7684\u500d\u6570 $k$ \u4e2a\u6570\u7684\u7ec4\u6570\uff0c\u5219\u6709\u6240\u6c42\u7b54\u6848\u4e3a $ans=\\sum\\limits_{i=1}^ni\\times f(x),F(i)=\\sum\\limits_{i|d}f(d),F(i)=\\tbinom{g(i)}{k}$ \uff0c\u5176\u4e2d $g(i)$  \u8868\u793a\u52a0\u5165\u7684\u6570\u4e2d\u4e3a $i$ \u7684\u500d\u6570\u7684\u6570\u7684\u4e2a\u6570\u3002\n\n\u5219 \n$$f(i)=\\sum\\limits_{i|d}\\mu(\\tfrac{d}{i})F(d)$$\n$$ans=\\sum\\limits_{i=1}^n\\sum\\limits_{i|d}\\mu(\\tfrac{d}{i})F(d)$$\n\n\u6211\u4eec\u6539\u53d8\u6c42\u548c\u987a\u5e8f\uff0c\u679a\u4e3e $F$\n\n$$ans=\\sum\\limits_{i=1}^nF(i)\\sum\\limits_{d|i}d\\times\\mu(\\tfrac{i}{d})$$\n\n\u540e\u9762\u7684\u7cfb\u6570\u53ea\u4e0e $i$ \u6709\u5173\uff0c\u53ef\u4ee5 $O(m\\ln m)$ \u9884\u5904\u7406\u3002\u6bcf\u6b21\u52a0\u5165\u4e00\u4e2a\u6570\u53ea\u4f1a\u6539\u53d8 $O(\\sqrt n)$ \u9879 $F(i)$ \u3002\u5219\u590d\u6742\u5ea6\u4e3a $O(q\\sqrt m)$ \u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(q\\sqrt m+m\\ln m)$ \uff0c$m$ \u4e3a\u503c\u57df\u3002\n\n\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define mod 1000000007\nusing namespace std;\nint n,m,q,q1,miu[1000005],mu[1000005],pri[1000005],g[1000005],fac[1000005],inv[1000005],f[1000005],ans;\nbool bo[1000005];\nvoid xxs(int n)\n{\n    miu[1]=1;\n    for(int i=2;i<=n;i++)\n    {\n        if(!bo[i])\n        {\n            bo[i]=0;\n            pri[++q1]=i;\n            miu[i]=-1;\n        }\n        for(int j=1;j<=q1&&pri[j]*i<=n;j++)\n        {\n            bo[i*pri[j]]=1;\n            if(i%pri[j]==0) break;\n            miu[i*pri[j]]=-miu[i];\n        }\n    }\n    for(int i=1;i<=n;i++)\n    \tif(miu[i]) for(int j=1;j*i<=n;j++) mu[i*j]=(mu[i*j]+j*miu[i]+mod)%mod;\n}\nint kp(int a,int b)\n{\n\tint c=1;\n\twhile(b)\n\t{\n\t\tif(b&1) c=1ll*c*a%mod;\n\t\ta=1ll*a*a%mod;\n\t\tb>>=1;\n\t}\n\treturn c;\n}\nint c(int x,int y)\n{\n\tif(x<y) return 0;\n\treturn 1ll*fac[x]*inv[y]%mod*inv[x-y]%mod;\n}\nvoid ad(int x)\n{\n\t++g[x];\n\tif(g[x]<m) return;\n\tans-=f[x];\n\tans=(ans+mod)%mod;\n\tf[x]=1ll*c(g[x],m)*mu[x]%mod;\n\tans+=f[x];\n\tans%=mod;\n}\nvoid add(int x)\n{\n\tfor(int i=1;i*i<=x;i++)\n\t\tif(x%i==0)\n\t\t{\n\t\t\tad(i);\n\t\t\tif(i*i!=x) ad(x/i);\n\t\t}\n}\nint main()\n{\n\tscanf(\"%d%d%d\",&n,&m,&q);\n\txxs(1000005);\n\tfac[0]=1;\n\tfor(int i=1;i<=200005;i++) fac[i]=1ll*i*fac[i-1]%mod;\n\tinv[200005]=kp(fac[200005],mod-2);\n\tfor(int i=200005;i;i--) inv[i-1]=1ll*i*inv[i]%mod;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint x;\n\t\tscanf(\"%d\",&x);\n\t\tadd(x);\n\t}\n\tfor(int i=1;i<=q;i++)\n\t{\n\t\tint x;\n\t\tscanf(\"%d\",&x);\n\t\tadd(x);\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1638327194,
        "uid": 112921,
        "name": "zhimao",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF645F Cowslip Collections"
    },
    {
        "content": "### **\u9898\u610f**  \n\u7ed9\u5b9a\u4e00\u4e2a\u6709 $n$ \u4e2a\u5143\u7d20\u7684\u6570\u5217 $\\{a_i\\}$ \u548c\u4e00\u4e2a\u6b63\u6574\u6570 $k$\uff0c\u6709 $q$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u5411\u6570\u5217\u4e2d\u52a0\u5165\u4e00\u4e2a\u6570 $b$\uff08\u6709\u540e\u6548\u6027\uff09\uff0c\u5e76\u8be2\u95ee\u6dfb\u52a0\u5b8c\u4e4b\u540e\u4efb\u610f $k$ \u4e2a\u5143\u7d20\u7684 $\\gcd$ \u4e4b\u548c\u3002  \n$1\\leq n,k,q\\leq 10^5, 1\\leq a_i, b\\leq 10^6$\n\n### **\u9898\u89e3**  \n\u6211\u4eec\u8003\u8651\u6b27\u62c9\u53cd\u6f14:\n$$n=\\sum_{d|n}\\varphi(d)$$\n\u4e8e\u662f\u5c31\u6709:\n$$\\gcd_{i=1}^{m}t_i=\\sum_{\\forall 1\\leq i\\leq m, d|t_i} \\varphi(d)$$\n\u8bbe $b$ \u662f $a$ \u7684\u4e00\u4e2a\u5927\u5c0f\u4e3a $k$ \u7684\u5b50\u96c6\uff0c\u5219\u9898\u76ee\u4e2d\u6240\u6c42\u5373\u4e3a\n$$\\sum_b \\gcd_{i=1}^k b_i = \\sum_b \\sum_{\\forall 1\\leq i\\leq k, d|b_i} \\varphi(i)$$\n\u6211\u4eec\u8bbe $cnt_i$ \u8868\u793a\u76ee\u524d $i$ \u662f\u6570\u5217 $\\{a_i\\}$ \u4e2d\u591a\u5c11\u4e2a\u6570\u7684\u56e0\u5b50\uff0c\u5bb9\u6613\u5f97\u51fa\u4e0a\u5f0f\u4e2d $i$ \u7684\u8d21\u732e\u4e3a:\n$$\\tbinom{cnt_i}{k}\\times \\varphi(i)$$\n\u4e8e\u662f\u6211\u4eec\u53ea\u9700\u9884\u5904\u7406\u51fa $\\varphi(i)$\u548c\u9636\u4e58\uff0c\u7136\u540e\u987a\u5e8f\u52a0\u5165\u8fd9 $n+q$ \u4e2a\u6570\u5e76\u7ef4\u62a4 $cnt_i$ \u5373\u53ef\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u6211\u4eec\u8003\u8651\u52a0\u5165\u7684\u6570 $b$ \u7684 $O(\\sqrt{b})$ \u4e2a\u56e0\u5b50\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u56e0\u5b50 $d$\uff0c\u6211\u4eec\u5c06\u7b54\u6848\u52a0\u4e0a $(\\tbinom{cnt_i}{k}-\\tbinom{cnt_i-1}{k})\\varphi(i)$\uff0c\u5373 $\\tbinom{cnt_i-1}{k-1}\\varphi(i)$\u3002  \n\n\u603b\u590d\u6742\u5ea6 $\\Theta(w)-\\Theta((n+q)\\sqrt{w})$\uff0c\u5176\u4e2d $w$ \u4e3a\u503c\u57df\u3002\n\n### **\u4ee3\u7801**\n```cpp\n#include <cstdio>\n#define mod 1000000007\n#define maxn 1000000\n\nusing namespace std;\n\nint phi[maxn + 5];\nint prime[maxn + 5];\nbool ntp[maxn + 5];\nint k;\nint cnt[maxn + 5], ans = 0;\nint fac[maxn + 5], inv[maxn + 5];\nint qpow(int x, int y)\n{\n\tint ans = 1;\n\twhile(y)\n\t{\n\t\tif(y & 1)\n\t\t\tans = 1ll * ans * x % mod;\n\t\tx = 1ll * x * x % mod;\n\t\ty >>= 1; \n\t}\n\treturn ans;\n}\nvoid sieve()\n{\n\tint i, j, cnt = 0;\n\tphi[1] = 1;\n\tfor(i = 2; i <= maxn; i++)\n\t{\n\t\tif(!ntp[i])\n\t\t{\n\t\t\tphi[i] = i - 1;\n\t\t\tprime[++cnt] = i;\n\t\t}\n\t\tfor(j = 1; j <= cnt && prime[j] * i <= maxn; j++)\n\t\t{\n\t\t\tntp[i * prime[j]] = true;\n\t\t\tif(!(i % prime[j]))\n\t\t\t{\n\t\t\t\tphi[i * prime[j]] = phi[i] * prime[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tphi[i * prime[j]] = phi[i] * (prime[j] - 1);\n\t\t}\n\t}\n}\nint C(int x, int y)\n{\n\treturn ((x < y) || (x < 0) || (y < 0)) ? 0 : (1ll * fac[x] * inv[y] % mod * inv[x - y] % mod);\n}\nvoid work(int x)\n{\n\tint i;\n\tfor(i = 1; i * i <= x; i++)\n\t\tif(!(x % i))\n\t\t{\n\t\t\t++cnt[i];\n\t\t\tif(cnt[i] >= k)\n\t\t\t\tans = (ans + 1ll * phi[i] * C(cnt[i] - 1, k - 1) % mod) % mod;\n\t\t\tif(1ll * i * i != x)\n\t\t\t{\n\t\t\t\t++cnt[x / i];\n\t\t\t\tif(cnt[x / i] >= k)\n\t\t\t\t\tans = (ans + 1ll * phi[x / i] * C(cnt[x / i] - 1, k - 1) % mod) % mod;\n\t\t\t}\n\t\t}\n}\n\nint main()\n{\n\tint n, m, i, a;\n\tsieve();\n\tfac[0] = 1;\n\tfor(i = 1; i <= maxn; i++)\n\t\tfac[i] = 1ll * fac[i - 1] * i % mod;\n\tinv[maxn] = qpow(fac[maxn], mod - 2);\n\tfor(i = maxn; i >= 1; i--)\n\t\tinv[i - 1] = 1ll * inv[i] * i % mod;\n\tscanf(\"%d%d%d\", &n, &k, &m);\n\tfor(i = 1; i <= n; i++)\n\t{\n\t\tscanf(\"%d\", &a);\n\t\twork(a);\n\t}\n\tfor(i = 1; i <= m; i++)\n\t{\n\t\tscanf(\"%d\", &a);\n\t\twork(a);\n\t\tprintf(\"%d\\n\", ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1638092214,
        "uid": 128235,
        "name": "le0n",
        "ccfLevel": 7,
        "title": "CF654F\u9898\u89e3"
    }
]
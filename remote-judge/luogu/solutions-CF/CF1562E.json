[
    {
        "content": "- \u7ecf\u5178\u7684 LIS \u95ee\u9898\uff0c\u53ea\u4e0d\u8fc7\u5c06\u6570\u5b57\u53d8\u6210\u4e86\u5b57\u7b26\u4e32\uff0c\u6bd4\u8f83\u7684\u5173\u952e\u5b57\u53d8\u6210\u4e86\u5b57\u7b26\u4e32\u7684\u5b57\u5178\u5e8f\u3002\n\n- \u5b50\u4e32\u7684\u6570\u91cf\u662f $O(n^2)$ \u7ea7\u522b\u7684\uff0c$\\sum n\\le 10^4$ \u8981\u6c42\u6211\u4eec\u6709 $O(n^2)$ \u53ca\u4ee5\u4e0b\u7684\u505a\u6cd5\uff0c\u4e5f\u5c31\u662f\u6bcf\u4e2a\u5b50\u4e32\u6700\u591a\u904d\u5386\u4e00\u6b21\u3002\u5bf9\u6240\u6709\u5b50\u4e32\u76f4\u63a5\u505a LIS \u80af\u5b9a\u7206\u70b8\u3002\n\n- \u4ee4 $[l,r]$ \u8868\u793a\u5b57\u7b26\u4e32 $S$ \u7684\u4e00\u4e2a\u5b57\u4e32 $S_l\\sim S_{r}$\uff0c\u90a3\u4e48\u6211\u4eec\u53d1\u73b0 $[l,r+1]$ \u7684\u5b57\u5178\u5e8f\u4e00\u5b9a\u5927\u4e8e $[l,r]$\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5047\u5982 $[l,r]$ \u80fd\u4ece\u524d\u9762\u67d0\u4e2a\u72b6\u6001\u8f6c\u79fb\u8fc7\u6765\uff0c\u90a3\u4e48 $[l,r+1]$ \u4e5f\u4e00\u5b9a\u53ef\u4ee5\u3002\n\n- \u4ee4 $f(i)$ \u8868\u793a\u4ee5\u5b50\u4e32 $[i,p](i<p\\le n)$ \u4e3a LIS \u672b\u5c3e\u7684\u7b54\u6848\uff0c$g(i,j)(i>j)$ \u4e3a\u6ee1\u8db3 $S_{i+k}$ \u4e0e $S_{j+k}$ \u4e0d\u76f8\u7b49\u7684\u6700\u5c0f\u7684 $k$\u3002\u5982\u679c $i + g(i,j) \\le n + 1$ \u5e76\u4e14 $S_{i+g(i,j)}>S_{j+g(i,j)}$\uff0c\u8bf4\u660e\u72b6\u6001 $i$ \u53ef\u4ee5\u4ece\u72b6\u6001 $j$ \u8f6c\u79fb\u8fc7\u6765\uff0c\u5373 $[i,i+g(i,j)\\sim n]$ \u90fd\u53ef\u4ee5\u7ee7\u627f $j$\u3002\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\n\n  $$f(i)=\\max_{1\\le j<i}\\{n-i+1,f_j+n-i-g(i,j)+1\\}$$\n\n- \u5982\u4f55\u6c42\u5feb\u901f\u6c42\u51fa $g(i,j)$ \u5462\uff1f\u6c42 $g(i,j)$ \u7b49\u4ef7\u4e8e\u6c42 $[i,n]$ \u548c $[j,n]$ \u7684\u6700\u957f\u516c\u5171\u524d\u7f00 LCP \u7684\u957f\u5ea6\uff0c\u53ef\u4ee5\u7528 DP \u6c42\u89e3\u3002\u5982\u679c $S_i\\neq S_j$\uff0c\u663e\u7136 $g(i,j)=0$\u3002\u5426\u5219\uff1a\n\n  $$g(i,j)=g(i+1,j+1)+1$$\n  \n- \u65f6\u95f4\u3001\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^2)$\u3002\u7531\u4e8e\u591a\u6d4b\uff0c\u4e0d\u80fd\u6bcf\u6b21\u90fd\u7528 memset \u91cd\u65b0\u6e05\u7a7a $g$ \u6570\u7ec4\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define N 5005\nusing namespace std;\nint T, n, Ans, f[N][N], dp[N]; // f \u6570\u7ec4\u5c31\u662f\u4e0a\u6587\u7684 g \u6570\u7ec4\uff0cdp \u6570\u7ec4\u5c31\u662f\u4e0a\u6587\u7684 f \u6570\u7ec4\uff0c\u61d2\u5f97\u6539\u4e86\u3002\nchar S[N];\nbool compare(int x, int y) { // \u5224\u65ad\u80fd\u5426\u7531 y \u8f6c\u79fb\u5230 x\u3002\n    if (x + f[x][y] > n + 1) return false;\n    return S[x + f[x][y]] > S[y + f[x][y]];\n}\nint solve(int x, int y) { // \u8f6c\u79fb\n    if (!compare(x, y)) return 0;\n    return dp[y] + n - x - f[x][y] + 1;\n}\nint main() {\n    scanf(\"%d\", &T);\n    while (T--) {\n        scanf(\"%d %s\", &n, S + 1);\n        for (int i = n - 1; i >= 1; --i) f[n][i] = (S[n] == S[i]);\n        for (int i = n - 1; i >= 1; --i)\n            for (int j = i - 1; j >= 1; --j)\n                f[i][j] = (S[i] == S[j]) ? (f[i + 1][j + 1] + 1) : 0; // DP \u6c42\u89e3 LCP\n        dp[1] = Ans = n;\n        for (int i = 2; i <= n; ++i) {\n            dp[i] = n - i + 1;\n            for (int j = 1; j < i; ++j)\n                dp[i] = max(dp[i], solve(i, j)); // DP \u6c42\u89e3 LIS\u3002\n            Ans = max(Ans, dp[i]);\n        }\n        printf(\"%d\\n\", Ans);\n    }\n\treturn 0;\n}\n```\n",
        "postTime": 1630112332,
        "uid": 148851,
        "name": "StevenLu1103",
        "ccfLevel": 6,
        "title": "CF1562E"
    },
    {
        "content": "# \u9898\u76ee\u5927\u610f\n\u7ed9\u5b9a\u4e00\u4e2a\u5b57\u7b26\u4e32 $s$\uff0c\u6c42\u5176\u4f9d\u6b21\u653e\u7f6e\u7684\u6240\u6709\u540e\u7f00\u7684\u524d\u7f00\u7684\u5b57\u5178\u5e8f\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u3002\n# \u9898\u76ee\u5206\u6790\n\u5927\u4f6c\u4eec\u7684\u505a\u6cd5\u90fd\u597d\u9ad8\u7ea7\u554a\uff0c\u849f\u84bb\u7528\u7684\u662f\u7eaf\u66b4\u529b\u9884\u5904\u7406 dp\u3002\n\n\u9996\u5148\u8fd9\u4e2a\u6570\u636e\u8303\u56f4\u662f\u4f7f\u7528 $O(n^2)$ \u901a\u8fc7\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u66b4\u529b\u6c42 LIS\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u5176\u4e2d\u52a0\u5165\u9650\u5236\u3002\u8bc1\u660e\u4e00\u4e2a\u5f15\u7406\uff1a\u5f53\u4e00\u4e2a\u540e\u7f00\u7684\u67d0\u4e2a\u524d\u7f00\u88ab\u53d6\u4e86\uff0c\u90a3\u4e48\u540e\u9762\u7684\u524d\u7f00\u53d6\u5b8c\u4e00\u5b9a\u4e0d\u4f1a\u66f4\u52a3\u3002\u7531\u4e8e\u662f\u4ece\u524d\u5f80\u540e dp\uff0c\u8d8a\u9760\u540e\u7684\u540e\u7f00\u524d\u7f00\u6570\u91cf\u8d8a\u5c11\uff0c\u5982\u679c\u5fc5\u987b\u8981\u9876\u66ff\u4e4b\u524d\u7684\u67d0\u4e00\u4e2a\u540e\u7f00\u540e\u9762\u7684\u4e00\u6bb5\u524d\u7f00\uff0c\u4e24\u4e2a\u540e\u7f00\u8bbe\u4e3a $s1$ \u548c $s2$\uff0c\u90a3\u4e48 $s1$ \u7684\u4e00\u6bb5\u524d\u7f00\u7b49\u4e8e $s2$ \u7684\u4e00\u6bb5\u524d\u7f00\uff0c\u5426\u5219\u53ef\u4ee5\u76f4\u63a5\u5b8c\u5168\u62fc\u63a5\u3002\u7136\u800c $s1$ \u5269\u4e0b\u7684\u524d\u7f00\u66f4\u5c11\uff0c\u6240\u4ee5\u4e00\u5b9a\u4e0d\u4f18\u4e8e $s2$\u3002\n\n\u6709\u4e86\u8fd9\u4e2a\u7ed3\u8bba\uff0c\u9898\u76ee\u5c31\u53ef\u4ee5\u8f6c\u5316\u4e3a\u4e00\u4e2a\u7c7b\u4f3c\u4e8e\u5e26\u6743 LIS \u7684\u4e1c\u897f\uff0c\u5c31\u53ef\u4ee5\u521d\u6b65\u8bbe\u8ba1 dp \u4e86\uff1a\u4ece\u524d\u5f80\u540e\u679a\u4e3e\u540e\u7f00\uff0c\u518d\u5728\u4e4b\u524d\u679a\u4e3e\u9996\u5b57\u6bcd\u4e25\u683c\u5c0f\u7684\u540e\u7f00\uff0c\u66b4\u529b\u8f6c\u79fb\u3002\u4f46\u8fd9\u65f6\u51fa\u73b0\u4e00\u4e2a\u95ee\u9898\uff0c\u53ef\u80fd\u6709\u76f8\u7b49\u7684\u3002\u4ecd\u7528\u4e4b\u524d\u7684\u8bbe\u5b9a\uff0c\u5373\u867d\u7136 $s1$ \u6574\u4e2a\u4e0d\u80fd\u62fc\u5728 $s2$ \u540e\u9762\uff0c\u4f46 $s1$ \u540e\u9762\u67d0\u4e00\u6bb5\u540e\u7f00\u53ef\u80fd\u53ef\u4ee5\u62fc\u63a5\uff0c\u4f8b\u5982 zazb\uff0c\u867d\u7136 z \u4e0d\u53ef\u4ee5\u63a5\u5728 zazb \u540e\u9762\uff0c\u4f46 zb \u5c31\u53ef\u4ee5\u63a5\u5728 zazb \u540e\u9762\u3002\n\n\u5bf9\u4e8e\u8fd9\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u4ecd\u66b4\u529b\u5904\u7406\u3002\u7531\u4e8e\u5b58\u5728\u516c\u5171\u524d\u7f00\uff0c\u9884\u5904\u7406\u4e00\u4e2a\u6570\u7ec4 $to$\uff0c$to[i][j]$ \u8868\u793a\u4ece $i$\uff0c$j$ \u5f00\u5934\u7684\u516c\u5171\u524d\u7f00\u957f\u5ea6\u52a0\u4e00\uff08\u65b9\u4fbf\u5904\u7406\u8f6c\u79fb\u548c\u8fb9\u754c\u95ee\u9898\uff09\uff0c\u5982\u679c\u4e0d\u5b58\u5728\u5219\u4e3a $0$\u3002\u4ece\u540e\u5f80\u524d\u626b\uff0c\u5982\u679c $s[i]==s[j]$\uff0c\u90a3\u4e48 $to[i][j]=to[i+1][j+1]+1$\uff0c\u5426\u5219 $to[i][j]=1$\uff0c\u53ef\u4ee5 $O(n^2)$ \u89e3\u51b3\u3002\n\n\u6709\u4e86\u8fd9\u4e2a\u6570\u7ec4\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u66b4\u529b dp \u5566\uff0c\u6ce8\u610f\u4e00\u4e0b\u8fb9\u754c\u95ee\u9898\u548c\u591a\u6d4b\u6e05\u7a7a\u5373\u53ef\uff01\n# \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n#define YPC rubbish \n#define R register\n#define I inline\n#define ll long long\n#define ull unsigned long long\n#define db double\nusing namespace std;\n#define pb push_back\n#define pii pair<int,int>\n#define pli pair<ll,int>\n#define pll pair<ll,ll>\n#define mp(x,y) make_pair(x,y)\n#define piii pair<pair<int,int>,int>\n#define mp3(x,y,z) make_pair(make_pair(x,y),z)\n#define fi first.first\n#define se first.second\n#define th second\n#define putint(x) printf(\"%d\\n\",x)\n#define putll(x) printf(\"%lld\\n\",x)\n#define putull(x) printf(\"%llu\\n\",x)\n#define lowbit(x) ((x)&(-(x)))\n#define chkmin(x,y) (x=min(x,y))\n#define chkmax(x,y) (x=max(x,y))\n#define inv(x) ksm(x,Mod-2)\n#define inf (1e9)\n#define INF (1e18)\n#define eps (1e-8)\n#define For(i,x,y) for(R int i=x;i<=y;++i)\n#define For2(i,x,y,k) for(R int i=x;i<=y;i+=k)\n#define Rof(i,x,y) for(R int i=x;i>=y;--i)\n#define Rof2(i,x,y,k) for(R int i=x;i>=y;i-=k)\n#define ForG(i,edge,x) for(auto i:edge[x])\nI int read()\n{\n\tchar ch=getchar();\n\tint res=0,flag=1;\n\twhile(ch<'0'||ch>'9')\n\t{\n\t\tif(ch=='-')\n\t\t\tflag=-1;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9')\n\t{\n\t\tres=res*10+ch-'0';\n\t\tch=getchar();\n\t}\n\treturn res*flag;\n}\nint T,n,f[5005],to[5005][5005];\nchar s[5001];\nint main()\n{\n\tT=read();\n\twhile(T--)\n\t{\n\t\tn=read();\n\t\tscanf(\"%s\",s+1);\n\t\tFor(i,1,n+1)\n\t\t{\n\t\t\tf[i]=0;\n\t\t\tFor(j,1,n+1)\n\t\t\t\tto[i][j]=0;\n\t\t}\n\t\tRof(i,n,2)\n\t\t\tRof(j,i-1,1)\n\t\t\t{\n\t\t\t\tif(s[i]==s[j]&&to[j+1][i+1])\n\t\t\t\t\tto[j][i]=to[j+1][i+1]+1;\n\t\t\t\telse\n\t\t\t\t\tto[j][i]=1;\n\t\t\t}\n\t\tFor(i,1,n)\n\t\t{\n\t\t\tf[i]=n-i+1;\n\t\t\tFor(j,1,i-1)\n\t\t\t{\n\t\t\t\tif(s[j]<s[i])\n\t\t\t\t\tchkmax(f[i],f[j]+n-i+1);\n\t\t\t\tif(s[j]==s[i]&&to[j][i]&&s[j+to[j][i]-1]<s[i+to[j][i]-1])\n\t\t\t\t\tchkmax(f[i],f[j]+n-i-to[j][i]+2);\n\t\t\t}\n\t\t}\n\t\tint ans=0;\n\t\tFor(i,1,n)\n\t\t\tchkmax(ans,f[i]);\n\t\tputint(ans);\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1630026710,
        "uid": 68011,
        "name": "\u53e4\u660e\u5730_ypc",
        "ccfLevel": 7,
        "title": "CF1562E\u9898\u89e3"
    },
    {
        "content": "\u9996\u5148\uff0c\u5bb9\u6613\u53d1\u73b0\uff0c$s[i,j+1]$ \u7684\u5b57\u5178\u5e8f\u4e00\u5b9a\u5927\u4e8e $s[i,j]$\uff0c\u6240\u4ee5\uff0c$s[i,j]$ \u540e\u9762\u4e00\u5b9a\u80fd\u63a5\u4e0a $s[i,j+1]$\u3002\n\n\u6709\u4e00\u4e2a\u7ed3\u8bba\uff0c\u4e00\u5b9a\u5b58\u5728\u4e00\u79cd\u7b54\u6848\u6700\u4f18\u7684\u9009\u62e9\u65b9\u6848\uff0c\u4f7f\u5f97\uff0c\u82e5 $s[i,j]$ \u88ab\u9009\u4e86\uff0c\u5219 $s[i,j+1 \\sim n]$ \u4e5f\u88ab\u9009\u3002\u4e0b\u9762\u8bc1\u660e\u8fd9\u4e2a\u7ed3\u8bba\u3002\n\n\u5047\u8bbe $s[i,j \\sim k]$ \u5168\u90fd\u9009\u4e86\uff0c$s[i,k+1]$ \u5ffd\u7136\u4e0d\u9009\u4e86\u3002\u8003\u8651\u5728\u4ec0\u4e48\u60c5\u51b5\u4e0b\u624d\u4f1a\u5bfc\u81f4\u8fd9\u6837\u6539\u53d8\u9009\u62e9\u3002\u663e\u7136\uff0c\u4e00\u5b9a\u5b58\u5728\u4e00\u5bf9 $l,r$\uff0c\u4f7f\u5f97 $l>i$ \u4e14 $s[l,r] > s[i,k]$ \u4e14 $s[l,r] < s[i,k+1]$\u3002\n\n\u9996\u5148\uff0c\u4e00\u5b9a\u6709 $s[l,r-1]=s[i,k]$\u3002\n\n\u82e5 $s[l,r-1]<s[i,k]$\uff0c\u5219\u663e\u7136\u5728 $k$ \u66f4\u5c0f\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u6539\u53d8\u9009\u62e9\u4e86\uff0c\u5f97\u5230\u7684\u7b54\u6848\u4e00\u5b9a\u4e0d\u4f1a\u6bd4\u73b0\u5728\u52a3\u3002\u82e5 $s[l,r-1]>s[i,k]$\uff0c\u5219\u4e00\u5b9a\u6709 $s[l,r]>s[i,k+1]$\u3002\u4e0d\u6ee1\u8db3\u5b9a\u4e49\u7684\u6761\u4ef6\u3002\n\n\u65e2\u7136\u5982\u6b64\uff0c\u9009 $s[i,k]$ \u5c31\u53ef\u4ee5\u89c6\u4f5c\u662f\u9009\u4e86 $s[l,r-1]$\uff0c\u5e76\u4ece $s[l,r]$ \u5f00\u59cb\u7ee7\u7eed\u5f80\u540e\u9009\u3002\u53ef\u4ee5\u628a\u8fd9\u4e2a\u7406\u89e3\u4e3a\u4e00\u4e2a\u201c\u7ee7\u627f\u201d\u7684\u8fc7\u7a0b\uff0c\u4e00\u5b9a\u4f1a\u4e0d\u65ad\u201c\u7ee7\u627f\u201d\uff0c\u76f4\u5230\u9009\u4e0a\u4e86\u4e00\u4e2a $s[x,n]$\uff08\u5426\u5219\uff0c\u7b54\u6848\u4e00\u5b9a\u4e0d\u4f18\uff09\u3002\u603b\u7684\u6765\u770b\uff0c\u5c31\u53ef\u4ee5\u8ba4\u4e3a\u6211\u4eec\u9009\u62e9\u4e86 $s[x,y \\sim n]$\u3002\n\n\u8fd9\u6837\u4e00\u4e2a\u201c\u7ee7\u627f\u201d\u7684\u8fc7\u7a0b\u5c31\u5305\u542b\u4e86\u6240\u6709**\u53ef\u80fd\u4f1a\u4f7f\u7b54\u6848\u66f4\u4f18\u7684**\u6539\u53d8\u9009\u62e9\u7684\u60c5\u51b5\uff0c\u81f3\u6b64\uff0c\u7ed3\u8bba\u8bc1\u6bd5\u3002\u6240\u4ee5\uff0c\u53ea\u9700\u8003\u8651\u6240\u6709\u4ee5 $s[i,n]$ \u4e3a\u7ed3\u5c3e\u7684 LIS \u5373\u53ef\u3002\n\n\u4ee4 $\\operatorname{lcp}(i,j)$ \u8868\u793a\u6ee1\u8db3 $s_{i+k}$ \u4e0e $s_{j+k}$ \u4e0d\u76f8\u7b49\u7684\u6700\u5c0f\u7684 $k$\uff0c\u4ee4 $f_i$ \u8868\u793a\u4ee5 $s[i,n]$ \u4e3a\u7ed3\u5c3e\u7684 LIS\u3002\n\n\u82e5 $s_{i+\\operatorname{lcp}(i,j)}>s_{j+\\operatorname{lcp}(i,j)}$\uff0c\u5219 $f_i$ \u662f\u53ef\u4ee5\u7531 $f_j$ \u8f6c\u79fb\u8fc7\u6765\u7684\uff0c\u8f6c\u79fb\u4e3a\uff1a$f_i=(n-i+1)+\\max \\limits_{1 \\leq j <i}\\{f_j-\\operatorname{lcp}(i,j)\\}$\u3002\n\n$\\operatorname{lcp}$ \u548c $f$ \u90fd\u5bb9\u6613\u5728 $O(n^2)$ \u7684\u590d\u6742\u5ea6\u5185\u5f97\u5230\u3002\n\n```cpp\n#include<iostream>\n#include<cstring>\n#include<cstdio>\nusing namespace std;\nconst int N=5010;\nint T,n,f[N];\nint lcp[N][N];\nchar s[N];\nint MAX(int x,int y)\n{\n\treturn x>y?x:y;\n}\nint main()\n{\n\tscanf(\"%d\",&T);\n\twhile(T--)\n\t{\n\t\tscanf(\"%d\",&n);\n\t\tscanf(\"%s\",s+1);\n\t\tfor(int i=1;i<n;i++)\n\t\t\tlcp[i][n]=(s[i]==s[n]);\n\t\tfor(int j=n-1;j>=1;j--)\n\t\t\tfor(int i=j-1;i>=1;i--)\n\t\t\t{\n\t\t\t\tif(s[i]==s[j]) lcp[i][j]=lcp[i+1][j+1]+1;\n\t\t\t\telse lcp[i][j]=0;\n\t\t\t}\n\t\tfor(int i=1;i<=n;i++) f[i]=n-i+1;\n\t\tfor(int i=2;i<=n;i++)\n\t\t\tfor(int j=1;j<i;j++)\n\t\t\t\tif(s[i+lcp[j][i]]>s[j+lcp[j][i]])\n\t\t\t\t\tf[i]=MAX(f[i],f[j]+n-i+1-lcp[j][i]);\n\t\tint ans=0;\n\t\tfor(int i=1;i<=n;i++) ans=MAX(ans,f[i]);\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n} \n```",
        "postTime": 1632655756,
        "uid": 186587,
        "name": "BBD186587",
        "ccfLevel": 0,
        "title": "CF1562E"
    },
    {
        "content": "\u6211\u4eec\u6ce8\u610f\u5230\u8fd9\u4e2a\u5b57\u7b26\u4e32 $\\text{Expansion}$ \u51fa\u6765\u7684\u5e8f\u5217\u5728\u5b57\u5178\u5e8f\u4e0a\u5927\u81f4\u662f\u5f88\u591a\u4e2a\u8fde\u7eed\u9012\u589e\u7684\u6bb5\u3002\n\n\u5177\u4f53\u5730\uff0c\u8bbe $S=\\tt{s_1s_2\\cdots s_n}$\uff0c\u90a3\u4e48 $\\text{Expansion}$ \u51fa\u6765\u7684\u5e8f\u5217\u4e2d\u5c31\u662f\u4ee5\u4e0b $n$ \u6bb5\u9012\u589e\u7684\u5e8f\u5217\uff1a\n\n- $\\tt{s_1,s_1s_2,\\cdots,s_1s_2\\cdots s_n}$\n- $\\tt{s_2,s_2s_3,\\cdots,s_2s_3\n\\cdots s_n}$\n- $\\cdots$\n- $\\tt{s_{n-1},s_{n-1}s_n}$\n- $\\tt{s_n}$\n\n\u56e0\u6b64\uff0c\u8fd9\u4e2a\u4e1c\u897f\u7684 $\\text{LIS}$ \u5927\u81f4\u5c31\u662f\u4ece\u8fd9 $n$ \u6bb5\u533a\u95f4\u4e2d\u9009\u51fa\u6765\u4e00\u4e9b\uff0c\u7136\u540e\u62fc\u5728\u4e00\u8d77\u3002\n\n\u8fd9\u6837\uff0c**\u5982\u679c\u5b57\u7b26\u4e32\u4e2d\u7684\u5b57\u7b26\u4e92\u4e0d\u76f8\u540c**\uff0c\u7c7b\u4f3c $\\text{LIS}$ \u7684 dp\uff0c\u7528 $F(i)$ \u8868\u793a\u4ee5\u7b2c $i$ \u4e2a\u6bb5\u7ed3\u5c3e\u7684\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\uff0c\u90a3\u4e48\u8f6c\u79fb\u65b9\u7a0b\u5c31\u662f\uff1a\n\n$$\nF(i)=\\max\\{F(j)+n-j|\\tt{s_j<s_i}\\}\n$$\n\n\u4f46\u662f\u8fd9\u6837\u505a\u6709\u4e2a\u95ee\u9898\uff1a\u5982\u679c\u5b57\u7b26\u4e32\u4e2d\u6709\u4e24\u4e2a\u76f8\u540c\u7684\u5b57\u7b26\uff0c\u90a3\u4e48\u6211\u4eec\u7684\u6bd4\u8f83\u5c31\u5931\u53bb\u4e86\u6b63\u786e\u6027\u3002\n\n\u7a0d\u52a0\u601d\u8003\u53ef\u4ee5\u53d1\u73b0\u6211\u4eec\u6bd4\u8f83\u7684\u5b9e\u9645\u4e0a\u662f\u540e\u7f00\u4e32\uff0c\u4e8e\u662f\u8003\u8651\u4ee4 $a_i$ \u4e3a $S[i...n]$ \u8fd9\u4e00\u540e\u7f00\u5728\u6240\u6709\u540e\u7f00\u4e2d\u7684\u6392\u540d\uff0c\u7136\u540e\u628a\u8f6c\u79fb\u65b9\u7a0b\u4e2d\u7684 $\\tt{s_j<s_i}$ \u6539\u6210 $a_j<a_i$\u3002\n\n\u4f46\u662f\u6211\u4eec\u53d1\u73b0\uff1a\u5f53\u4e24\u4e2a\u9996\u5b57\u6bcd\u76f8\u540c\u7684\u6bb5\u5408\u5e76\u65f6\uff0c\u6211\u4eec\u9700\u8981\u820d\u6389\u4e00\u4e9b\u3002\n\n\u6bd4\u5982 `abcab`\uff0c\u5982\u679c\u6211\u4eec\u9009\u62e9\u5c06 $j=1,i=4$ \u8fd9\u4e24\u4e2a `a` \u5408\u5e76\u8d77\u6765\uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u820d\u6389 `a` \u548c `ab` \u8fd9\u4e24\u4e2a\u3002\n\n\u56e0\u6b64\u6211\u4eec\u8003\u8651\u53e6\u4e00\u4e2a dp\uff1a\u4ee4 $G(i,j)$ \u4e3a\u300c\u6309\u4e0a\u8ff0\u65b9\u5f0f\u5408\u5e76\u65f6\u81f3\u5c11\u9700\u8981\u820d\u6389\u7684\u4e2a\u6570\u300d\uff0c\u90a3\u4e48\u8f6c\u79fb\u65b9\u7a0b\u5c31\u662f\uff1a\n\n$$\nG(i,j)=\\begin{cases}G(i+1,j+1)+1&,\\tt{s_i=s_j}\\\\0&,\\tt{s_i\\neq s_j}\\end{cases}\n$$\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u7528 $O(n\\log n)$ \u7684\u65f6\u95f4\u5229\u7528\u540e\u7f00\u6392\u5e8f\u9884\u5904\u7406\u51fa $a$\uff0c\u518d\u7528 $O(n^2)$ \u7684\u65f6\u95f4\u505a\u4e24\u6b21 $\\text{dp}$\uff0c\u5c31\u5728 $O(n^2)$ \u7684\u65f6\u95f4\u5185\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\u3002\n\n```cpp\n#pragma GCC optimize(\"Ofast,no-stack-protector,unroll-loops,fast-math\")\n#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4.1,sse4.2,avx,avx2,popcnt,tune=native\")\n#pragma GCC optimize(3)\n\n#include<iostream>\n#include<cstring>\n#include<algorithm>\n#include<cstdlib>\n\n#define int long long\nconst int MN=5005;\n\nusing namespace std;\n\nint t,n;\nint a[MN],dp[MN],f[MN][MN];\nint N,M,rak[MN],sa[MN],tax[MN],tp[MN];\nstring s;\n\nvoid Qsort() {\n    for(int i=0;i<=M;i++)tax[i]=0;\n    for(int i=1;i<=N;i++)tax[rak[i]]++;\n    for(int i=1;i<=M;i++)tax[i]+=tax[i-1];\n    for(int i=N;i>=1;i--)sa[tax[rak[tp[i]]]--]=tp[i];\n}\n\nvoid SuffixSort(){\n    M=75;for(int i=1;i<=N;i++)rak[i]=s[i-1]-'0'+1,tp[i]=i;\n    Qsort();\n    for(int w=1,p=0;p<N;M=p,w<<=1){\n        p=0;for(int i=1;i<=w;i++)tp[++p]=N-w+i;\n        for(int i=1;i<=N;i++)if(sa[i]>w)tp[++p]=sa[i]-w; \n        Qsort();swap(tp, rak);rak[sa[1]]=p=1;\n        for(int i=2;i<=N;i++)rak[sa[i]]=(tp[sa[i-1]]==tp[sa[i]]&&tp[sa[i-1]+w]==tp[sa[i]+w])?p:++p;\n    }\n}\n\nsigned main(void){\n\n    cin>>t;\n    while(t--){\n        memset(a,0,sizeof(a));\n        memset(sa,0,sizeof(sa));\n        memset(rak,0,sizeof(rak));\n        memset(tax,0,sizeof(tax));\n        memset(tp,0,sizeof(tp));\n        \n        cin>>n;N=n;\n        cin>>s;\n        SuffixSort();\n        \n        for(int i=0;i<n;i++)a[sa[i+1]-1]=i;\n        for(int i=n-1;i>=0;i--){\n            for(int j=n-1;j>=0;j--){\n                if(s[i]!=s[j])f[i][j]=0;\n                else f[i][j]=f[i+1][j+1]+1;\n            }\n        }\n\n        dp[0]=n;int ans=n;\n        for(int i=1;i<n;i++){\n            dp[i]=n-i;\n            for(int j=0;j<i;j++){\n                if(a[i]>a[j])dp[i]=max(dp[i],dp[j]+n-i-f[i][j]);\n            }\n            ans=max(ans,dp[i]);\n        }\n\n        cout<<ans<<endl;\n    }\n\n    return 0;\n}\n```",
        "postTime": 1630030366,
        "uid": 307453,
        "name": "\u4e91\u6d45\u77e5\u5904",
        "ccfLevel": 6,
        "title": "CF1562E"
    },
    {
        "content": "\u4ec5\u4ee5\u6b64\u7eaa\u5ff5\u6211\u88ab\u8bc8\u9a97\u9898+\u9898\u76ee\u96be\u5ea6\u987a\u5e8f\u5751\u4e86\u7684CF\u6bd4\u8d5b\n\n\u8fd9\u4e00\u9898\u6bd4D2\u7b80\u5355\u4e0d\u77e5\u9053\u591a\u5c11\u500d\uff0c\u751a\u81f3\u6bd4D1\u8fd8\u7b80\u5355\uff0c\u5982\u679c\u6211\u5148\u505a\u7684E\u7684\u8bdd\u6211\u80af\u5b9a\u4e0d\u81f3\u4e8e\u6389\u5206\u3002\u3002\u3002\n\n\u8fd9\u9898\u9996\u5148\u6709\u4e00\u4e2a\u597d\u60f3\u597d\u5199\u7684\u66b4\u529b\uff0c\u5c31\u662f\u628a $O(n^2)$ \u4e2a\u5b57\u7b26\u4e32\u90fd\u8003\u8651\u8fdb\u53bb\uff0c\u7136\u540e\u76f4\u63a5\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217+ $\\text{SA}$ \u5224\u65ad\u4e24\u4e2a\u5b50\u4e32\u7684\u5b57\u5178\u5e8f\u5927\u5c0f\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2\\log n)$\uff0c\u5f88\u660e\u663e\u8fc7\u4e0d\u53bb\u3002\n\n\u8003\u8651\u4f18\u5316\uff0c\u53d1\u73b0\u6709\u4e00\u4e2a\u5f88\u663e\u7136\u7684\u7ed3\u8bba\uff0c\u5c31\u662f\u5982\u679c\u6211\u53d6\u4e86\u4ee5 $i$ \u4e3a\u5f00\u5934\u7684\u5b50\u4e32\uff0c\u6211\u4e00\u5b9a\u4f1a\u628a\u5b83\u53d6\u5b8c\uff0c\u611f\u6027\u7406\u89e3\u4e00\u4e0b\uff0c\u5c31\u662f\u5982\u679c\u6211\u4e0d\u5f04\u5b8c\u8ba9\u540e\u9762\u7684\u63a5\u4e0a\u53bb\uff0c\u90a3\u8fd9\u6837\u7684\u8bdd\u4e0d\u53ef\u80fd\u66f4\u4f18\uff0c\u56e0\u4e3a\u5982\u679c\u66f4\u4f18\u7684\u8bdd\u90a3\u540e\u9762\u7684\u5b50\u4e32\u4e5f\u80fd\u63a5\u5230\u5b8c\u6574\u7684\u4e0a\u9762\u53bb\u3002\n\n\u7136\u540e\u76f4\u63a5 $dp[i]$ \u8868\u793a\u76ee\u524d\u8003\u8651\u5230\u4ee5 $i$ \u4e3a\u5f00\u5934\u7684\u5b50\u4e32\uff0c\u5e76\u5f3a\u5236\u53d6 $i$ \u5f00\u5934\u7684\u5b50\u4e32\uff0c\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u957f\u5ea6\u662f\u591a\u5c11\uff0c\u7136\u540e\u7528 $SA$ \u8ba1\u7b97\u4e00\u4e0b\u5982\u679c\u4ece $j\\rightarrow i$ \u7684\u8bdd\u90a3 $i$ \u80fd\u53d6\u591a\u5c11\u4e2a\uff0c\u4e5f\u5c31\u662f $len_i-lcp_{i,j}$\u3002\n\n```.cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int NR=5005;\nvoid Min(int& x,int y){x=min(x,y);}\nvoid Max(int& x,int y){x=max(x,y);}\nint read()\n{\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+(ch^48);ch=getchar();}\n\treturn x*f;\n}\nint n,m;\nchar s[NR<<1];\nint sa[NR<<1],id[NR<<1];\nint rk[NR<<1],lark[NR<<1];\nint cnt[NR];\nint h[NR<<1];\nint dp[NR<<1];\nint mn[NR][NR];\nvoid work()\n{\n\tmemset(s,0,sizeof(s));\n\tmemset(sa,0,sizeof(sa));\n\tmemset(rk,0,sizeof(rk));\n\tn=read(),scanf(\"%s\",s+1);m=max(n,300);\n\tmemset(cnt,0,sizeof(cnt));\n\tfor(int i=1;i<=n;i++)cnt[rk[i]=s[i]]++;\n\tfor(int i=1;i<=m;i++)cnt[i]+=cnt[i-1];\n\tfor(int i=n;i>=1;i--)sa[cnt[rk[i]]--]=i;\n\tfor(int w=1;w<n;w<<=1)\n\t{\n\t\tmemset(cnt,0,sizeof(cnt));int p=0;\n\t\tfor(int i=n-w+1;i<=n;i++)id[++p]=i;\n\t\tfor(int i=1;i<=n;i++)if(sa[i]>w)id[++p]=sa[i]-w;\n\t\tfor(int i=1;i<=n;i++)cnt[rk[id[i]]]++;\n\t\tfor(int i=1;i<=m;i++)cnt[i]+=cnt[i-1];\n\t\tfor(int i=n;i>=1;i--)sa[cnt[rk[id[i]]]--]=id[i];\n\t\tmemcpy(lark,rk,sizeof(lark));\n\t\trk[sa[1]]=m=1;\n\t\tfor(int i=2;i<=n;i++){\n\t\t\tif(lark[sa[i]]==lark[sa[i-1]]&&lark[sa[i]+w]==lark[sa[i-1]+w])rk[sa[i]]=m;\n\t\t\telse rk[sa[i]]=++m;\n\t\t}\n\t}\n\tmemset(h,0,sizeof(h));\n\tint lcp=0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(lcp)lcp--;\n\t\twhile(s[i+lcp]==s[sa[rk[i]-1]+lcp])lcp++;\n\t\th[rk[i]]=lcp;\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tmn[i][i]=h[i];\n\t\tfor(int j=i+1;j<=n;j++)\n\t\t\tmn[i][j]=min(mn[i][j-1],h[j]);\n\t}\n\tint ans=0;\n\tmemset(dp,0,sizeof(dp));\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint len=dp[i]=n-i+1;\n\t\tfor(int j=1;j<i;j++)\n\t\t{\n\t\t\tif(rk[i]<rk[j])continue;\n\t\t\tdp[i]=max(dp[i],dp[j]+len-mn[rk[j]+1][rk[i]]);\n\t\t}\n\t\tans=max(ans,dp[i]);\n\t}\n\tprintf(\"%d\\n\",ans);\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tmn[i][j]=0;\n}\nint main()\n{\n\tint T=read();while(T--)work();\n\treturn 0;\n}\n/*\n1\n8\nacabacba\n*/\n```",
        "postTime": 1630065032,
        "uid": 97136,
        "name": "chenzida",
        "ccfLevel": 0,
        "title": "CF1562E Rescue Niwen!"
    },
    {
        "content": "\u524d\u7f6e\u77e5\u8bc6\uff1a[\u540e\u7f00\u6570\u7ec4\u53ca height \u6570\u7ec4](https://oiwiki.org/string/sa/)\u3002\r\n\r\n\u4e00\u4e9b\u5b9a\u4e49\uff1a\u539f\u4e32\u4e3a $S[1..n]$\uff0c$\\text{suf}_i$ \u8868\u793a $S[i..n]$\uff0c$\\text{LCP}(i,j)$ \u8868\u793a $\\text{suf}_i$ \u548c $\\text{suf}_j$ \u7684\u6700\u957f\u516c\u5171\u524d\u7f00\u7684\u957f\u5ea6\u3002\r\n\r\n\u7531\u4e8e\u5b50\u4e32 $S[i..j]$ \u7684\u5b9e\u8d28\u4e3a $\\text{suf}_i$ \u7684\u4e00\u4e2a\u524d\u7f00\uff0c\u4e14\u5728 $j<n$ \u7684\u60c5\u51b5\u4e0b\u5fc5\u5b9a\u80fd\u8f6c\u79fb\u5230 $S[i..j+1]$\uff0c\u76f4\u5230 $S[i..j]=\\text{suf}_i$\uff0c\u56e0\u6b64\u53ea\u9700\u8003\u8651\u6240\u6709\u540e\u7f00\u3002\r\n\r\n\u4ee4 $dp_i$ \u8868\u793a $rank$ \u503c\u4e3a $i$ \u7684\u540e\u7f00\u7684 LIS\u7684\u957f\u5ea6\uff0c\u8003\u8651\u6309 $rank$ \u503c\u4ece\u5c0f\u5230\u5927\u8f6c\u79fb\uff0c\u5219\u6709 $dp_i=\\max\\limits_{j<i \\text{\u4e14} sa[j]<sa[i]}(dp_j+n-sa[i]+1-\\text{LCP}(\\text{suf}_i,\\text{suf}_j))$\u3002\r\n\r\n\u5176\u4e2d $n-sa[i]+1$ \u8868\u793a $\\text{suf}_i$ \u7684\u957f\u5ea6\uff0c\u51cf\u53bb\u91cd\u590d\u8ba1\u7b97\u7684\u516c\u5171\u524d\u7f00\u7684\u957f\u5ea6\u540e\u4fbf\u4e3a\u8d21\u732e\uff0c\u6700\u7ec8\u7b54\u6848\u4e3a $\\max\\limits_{i=1}^ndp_i$\u3002\r\n\r\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2)$\uff0c\u74f6\u9888\u5728\u4e8e\u8f6c\u79fb\u3002\r\n\r\n\u4ee3\u7801\uff1a\r\n\r\n```cpp\r\n#include<bits/stdc++.h>\r\nusing namespace std;\r\n#define ri register int\r\n#define DEBUG(k...) fprintf(stderr,k)\r\ntypedef long long ll;\r\ntemplate<class T>inline bool ckmax(T &x,const T &y){return x<y?x=y,true:false;}\r\ntemplate<class T>inline bool ckmin(T &x,const T &y){return x>y?x=y,true:false;}\r\nconst int maxn=2e4+10;\r\ntemplate<class T>inline void clear(T *arr,int siz){memset(arr,0,sizeof(T)*(siz+1));}\r\nint cnt[maxn],mx,n,rk[maxn],sa[maxn],tmp[maxn];\r\nchar s[maxn];\r\ninline void base_sort(){\r\n\tclear(cnt,mx);\r\n\tfor(ri i=1;i<=n;++i)++cnt[rk[i]];\r\n\tfor(ri i=1;i<=mx;++i)cnt[i]+=cnt[i-1];\r\n\tfor(ri i=n;i;--i)sa[cnt[rk[tmp[i]]]--]=tmp[i];\r\n}\r\ninline void suffix_sort(){\r\n\tmx=0;\r\n\tfor(ri i=1;i<=n;++i)mx=max(mx,rk[i]=s[i]),tmp[i]=i;\r\n\tbase_sort();\r\n\tfor(ri len=1,dif=0;dif<n;len<<=1,mx=dif){\r\n\t\tri p=0;\r\n\t\tfor(ri i=n-len+1;i<=n;++i)tmp[++p]=i;\r\n\t\tfor(ri i=1;i<=n;++i)\r\n\t\t\tif(sa[i]>len)\r\n\t\t\t\ttmp[++p]=sa[i]-len;\r\n\t\tbase_sort();\r\n\t\tswap(rk,tmp);\r\n\t\trk[sa[1]]=dif=1;\r\n\t\tfor(ri i=2;i<=n;++i){\r\n\t\t\tif(tmp[sa[i-1]]!=tmp[sa[i]]||tmp[sa[i-1]+len]!=tmp[sa[i]+len])++dif;\r\n\t\t\trk[sa[i]]=dif;\r\n\t\t}\r\n\t}\r\n}\r\nint ht[maxn];\r\ninline void calc_ht(){\r\n\tfor(ri i=1,h=0;i<=n;++i){\r\n\t\tif(h)--h;\r\n\t\tri j=sa[rk[i]-1];\r\n\t\twhile(s[i+h]==s[j+h])++h;\r\n\t\tht[rk[i]]=h;\r\n\t}\r\n}\r\nint lg,lg2[maxn],st[(int)log2(maxn)+1][maxn];\r\ninline void build_st(){\r\n\tfor(ri i=1;i<=n;++i)lg2[i]=lg2[i-1]+((2<<lg2[i-1])==i),st[0][i]=ht[i];\r\n\tlg=lg2[n];\r\n\tfor(ri i=1;i<=lg;++i)\r\n\t\tfor(ri j=1;j+(1<<(i-1))<=n;++j)\r\n\t\t\tst[i][j]=min(st[i-1][j],st[i-1][j+(1<<(i-1))]);\r\n}\r\ninline int query(int l,int r){\r\n\tri k=lg2[r-l+1];\r\n\treturn min(st[k][l],st[k][r-(1<<k)+1]);\r\n}\r\nint f[maxn],t_case;\r\nint main(){\r\n\tscanf(\"%d\",&t_case);\r\n\twhile(t_case--){\r\n\t\tscanf(\"%d%s\",&n,s+1);\r\n\t\tsuffix_sort();\r\n\t\tcalc_ht();\r\n\t\tbuild_st();\r\n\t\tri ans=0;\r\n\t\tfor(ri i=1;i<=n;++i){\r\n\t\t\tfor(ri j=0;j<i;++j)\r\n\t\t\t\tif(sa[j]<sa[i])\r\n\t\t\t\t\tckmax(f[i],f[j]+n-sa[i]+1-query(j+1,i));\r\n\t\t\tckmax(ans,f[i]);\r\n\t\t}\r\n\t\tprintf(\"%d\\n\",ans);\r\n\t\tclear(f,n);\r\n\t\tclear(s,n);\r\n\t\tclear(rk,n);\r\n\t\tclear(sa,n);\r\n\t\tclear(tmp,n);\r\n\t}\r\n\treturn 0;\r\n}\r\n```",
        "postTime": 1630057277,
        "uid": 67942,
        "name": "meyi",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1562E \u3010Rescue Niwen!\u3011"
    },
    {
        "content": "\u7b2c\u4e00\u6b21\u60f3\u51fa\u6765\u6700\u8fd1 CF 2500 \u7684\u9898\u3002\n\n## \u601d\u8def\n\n\u4ee5\u4e0b\u7528 $s_{[l,r]}$ \u8868\u793a $s_l,s_{l+1},\\cdots ,s_r$ \u7ec4\u6210\u7684\u5b50\u4e32\u3002$s<t$ \u8868\u793a $s$ \u7684\u5b57\u5178\u5e8f\u6bd4 $t$ \u5c0f\u3002\n\n\u9996\u5148\uff0c\u6839\u636e\u5b57\u5178\u5e8f\u7684\u5b9a\u4e49\uff0c\u663e\u7136\u6709 $s_{[l,r]}<s_{[l,r+1]}$\u3002\u90a3\u4e48\u5982\u679c\u9009 $s_{[l,r]}$\uff0c\u5219 $s_{[l,r+1]},s_{[l,r+2]},\\cdots , s_{[l,n]}$ \u90fd\u53ef\u4ee5\u9009\u3002\n\n\u53ef\u4ee5\u731c\u4e00\u4e2a\u7ed3\u8bba\uff1a\u5982\u679c\u9009\u4e86 $s_{[l,r]}$\uff0c\u5219 $s_{[l,r+1]},s_{[l,r+2]},\\cdots , s_{[l,n]}$ \u4e00\u5b9a\u9009\u3002\n\n\u8bc1\u660e\uff1a\u663e\u7136\u4e0d\u53ef\u80fd\u4ece\u4e2d\u95f4\u62bd\u51fa\u4e00\u4e2a\u5b50\u4e32\u6765\uff0c\u8fd9\u6837\u663e\u7136\u4e0d\u4f18\u3002\u73b0\u5728\u8003\u8651\u5220\u9664 $s_{[l,n]}$ \u662f\u5426\u66f4\u4f18\u3002\u5047\u8bbe\u5728\u9009 $s_{[l,n]}$ \u7684\u65f6\u5019\uff0c\u4e0b\u4e00\u4e2a\u9009\u7684\u662f $s_{[l2,r2]}$\uff0c\u90a3\u4e0d\u9009 $s_{[l2,r2-1]}$ \u7684\u539f\u56e0\u4e00\u5b9a\u662f $s_{[l2,r2-1]} \\le s_{[l,n]}$\uff0c\u800c\u53c8\u56e0\u4e3a\u4f1a\u9009 $s_{[l2,r2]}$\uff0c\u6240\u4ee5 $s_{[l2,r2-1]}=s_{[l,n]}$\u3002\u66f4\u8fdb\u4e00\u6b65\uff0c$s_{[l2,r2-2]}=s_{[l,n-1]}$\u3002\u5982\u679c\u4e0d\u9009 $s_{[1,n]}$\uff0c\u53ea\u4f1a\u5728\u540e\u9762\u6dfb\u52a0\u4e00\u4e2a $s_{[l2,r2-1]}$\uff08\u56e0\u4e3a $s_{[l2,r2-2]}=s_{[l,n-1]}$ \u6240\u4ee5\u4e0d\u53ef\u80fd\u6dfb\u52a0 $s_{[l2,r2-2]}$\uff09\uff0c\u6b64\u65f6\u4e0d\u4f1a\u589e\u52a0\u8d21\u732e\u3002\u6240\u4ee5\u6bcf\u5220\u6700\u540e\u4e00\u4e2a\u90fd\u4e0d\u4f1a\u589e\u52a0\u8d21\u732e\u3002\n\n\u8bbe $dp_i$ \u8868\u793a\u9009 $i$ \u4f5c\u4e3a\u5de6\u7aef\u70b9\u7684\u82e5\u5e72\u5b50\u4e32\u3002\u679a\u4e3e\u4e0a\u4e00\u4e2a\u9009\u7684 $j$\uff0c\u90a3\u4e48 $s_{[j,n]}$ \u5373\u4e3a\u4e0a\u4e00\u4e2a\u9009\u7684\u3002\u73b0\u5728\u9700\u8981\u627e\u5230\u4e00\u4e2a\u6700\u5c0f\u7684 $k$\uff0c\u4f7f\u5f97 $s_{[j,n]}<s_{[i,k]}$\uff0c\u7136\u540e\u63a5\u4e0a\u53bb\u3002\n\n\u82e5 $s<t$\uff0c\u5219 $s,t$ \u7684\u6700\u957f\u516c\u5171\u524d\u7f00\u7684\u4e0b\u4e00\u4e2a\u4f4d\u7f6e $lcp+1$ \u5fc5\u987b\u6ee1\u8db3 $s_{lcp+1}<t_{lcp+1}$\u3002\u5bf9\u4e8e\u4e0a\u9762\u7684\u95ee\u9898\u53ef\u4ee5\u7528\u540c\u6837\u7684\u65b9\u5f0f\u505a\u3002\u627e\u5230 $i$ \u540e\u7f00\u548c $j$ \u540e\u7f00\u7684\u6700\u957f\u516c\u5171\u524d\u7f00\uff0c\u5219\u82e5 $i$ \u7684\u4e0b\u4e00\u4e2a\u4f4d\u7f6e\u6bd4 $j$ \u7684\u5927\uff0c\u90a3\u4e2a\u4f4d\u7f6e\uff08\u4ee5\u53ca\u540e\u9762\u7684\uff09\u5c31\u53ef\u4ee5\u63a5\u4e0a\u4e86\u3002\n\n\u73b0\u5728\u8f6c\u5316\u6210\u4e00\u4e2a\u95ee\u9898\uff1a\u6c42\u4e24\u4e2a\u540e\u7f00\u7684\u6700\u957f\u516c\u5171\u524d\u7f00\u3002\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u7528\u540e\u7f00\u6570\u7ec4\u89e3\u51b3\uff08\u4e5f\u6709\u522b\u7684\u505a\u6cd5\uff09\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u9884\u5904\u7406 $\\mathcal O(n \\log n)$\uff08\u6216\u8005 $\\mathcal O(n \\log^2 n)$\uff09\uff0c\u67e5\u8be2 $\\mathcal O(1)$\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\nint n;\n\nstring s;\n\nint dp[5010];\n\nint rk[5010],sa[5010];\n\nstruct px\n{\n\tint a,b,id;\n} p[5010];\nbool cmp(px x,px y) { return x.a==y.a?x.b<y.b:x.a<y.a; }\n\nint height[5010];\n\nint lg2[5010],st[20][5010];\n\nint query(int l,int r)\n{\n\tint len=lg2[r-l+1];\n\treturn min(st[len][l],st[len][r-(1<<len)+1]);\n}\n\nint main()\n{\n\tint t; cin>>t; while(t--)\n\t{\n\t\tcin>>n>>s;\n\t\ts=\" \"+s;\n\t\tfor(int i=1; i<=n; ++i) rk[i]=s[i];\n\t\tfor(int w=1; w<n; w<<=1)\n\t\t{\n\t\t\tfor(int i=1; i<=n; ++i)\n\t\t\t{\n\t\t\t\tp[i].a=rk[i],p[i].b=(i+w>n?0:rk[i+w]),p[i].id=i;\n\t\t\t}\n\t\t\tsort(p+1,p+n+1,cmp);\n\t\t\tint now=0;\n\t\t\tbool flag=1;\n\t\t\tfor(int i=1; i<=n; ++i)\n\t\t\t{\n\t\t\t\tif(p[i].a!=p[i-1].a || p[i].b!=p[i-1].b) ++now;\n\t\t\t\telse flag=0;\n\t\t\t\trk[p[i].id]=now;\n\t\t\t}\n\t\t\tif(flag) break;\n\t\t}\n\t\tlg2[1]=0; for(int i=2; i<=n; ++i) lg2[i]=lg2[i>>1]+1;\n\t\tfor(int i=1; i<=n; ++i) sa[rk[i]]=i;\n\t\tint now=0;\n\t\tfor(int i=1; i<=n; ++i)\n\t\t{\n\t\t\tif(now) --now;\n\t\t\twhile(s[i+now]==s[sa[rk[i]-1]+now]) ++now;\n\t\t\theight[rk[i]]=now;\n\t\t}\n\t\tfor(int i=1; i<=n; ++i) st[0][i]=height[i];\n\t\tfor(int i=1; i<=15; ++i)\n\t\t{\n\t\t\tfor(int j=1; j<=n-(1<<i)+1; ++j)\n\t\t\t{\n\t\t\t\tst[i][j]=min(st[i-1][j],st[i-1][j+(1<<i-1)]);\n\t\t\t}\n\t\t}\n\t\tint ans=0;\n\t\tfor(int i=1; i<=n; ++i)\n\t\t{\n\t\t\tdp[i]=n-i+1;\n\t\t\tfor(int j=1; j<i; ++j)\n\t\t\t{\n\t\t\t\tint wz1=rk[i],wz2=rk[j];\n\t\t\t\tif(wz1>wz2) swap(wz1,wz2);\n\t\t\t\tint lcp=query(wz1+1,wz2),k1=i+lcp-1,k2=j+lcp-1;\n\t\t\t\tif(k1==n) continue;\n\t\t\t\tif(s[k1+1]>s[k2+1]) dp[i]=max(dp[i],dp[j]+n-(k1+1)+1);\n\t\t\t}\n\t\t\tans=max(ans,dp[i]);\n\t\t}\n\t\tcout<<ans<<'\\n';\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1660899675,
        "uid": 353688,
        "name": "\u738b\u7199\u6587",
        "ccfLevel": 0,
        "title": "CF1562E \u9898\u89e3"
    },
    {
        "content": "# Description\n\n\u4e00\u4e2a\u5b57\u7b26\u4e32\uff0c\u5bf9\u4e8e\u5b83\u7684\u6240\u6709\u540e\u7f00\u5b50\u4e32\u7684\u6240\u6709\u524d\u7f00\uff0c\u6784\u6210\u4e86\u4e00\u4e2a\u5f88\u5927\u7684\u5b57\u7b26\u4e32\u5e8f\u5217\uff0c\u6c42\u8fd9\u4e2a\u5e8f\u5217\u7684\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u3002\n\n[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF1562E)\n\n# Solution\n\n\u4ea7\u751f\u7684\u5b57\u7b26\u4e32\u7684\u6570\u91cf\u7ea7\u662f $n^2$ \u7ea7\u522b\u7684\uff0c\u76f4\u63a5\u8dd1 LIS \u7684 dp \u4f1a T \u5230\u8d77\u98de\uff0c\u90a3\u4e48\u8fd9\u9898\u662f\u5426\u6709\u4ec0\u4e48\u7279\u6b8a\u7684\u5730\u65b9\u5462\u3002\n\n\u7684\u786e\uff0c\u8fd9\u9898\u6709\u4e00\u4e2a\u6027\u8d28\uff1a\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u540e\u7f00\uff08\u8bbe\u957f\u5ea6\u4e3a $len$ \uff09\uff0c**\u5b83\u4ea7\u751f\u7684 $len$ \u4e2a\u5b50\u4e32\u4e00\u5b9a\u4f1a\u628a\u540e\u9762\u7684\u4e00\u4e32\u5168\u9009\u4e0a**\u3002 \u6bd4\u65b9\u8bf4\u4e32 \"aabc\" ,\u6709\u5b50\u4e32 \"aabc\",\"abc\",\"bc\",\"c\" \u90a3\u4e48\u6700\u540e\u5728 LIS \u91cc\u7684\u4e00\u5b9a\u4f1a\u662f\u540e\u9762\u7684\u4e00\u6bb5\uff0c\u800c\u4e0d\u4f1a\u662f \"aabc\",\"bc\",\"c\" \uff08\u4e0d\u8fde\u7eed\uff09\u6216 \"aabc\",\"abc\" \uff08\u6ca1\u6709\u4e00\u76f4\u9009\u5230\u6700\u540e\uff09\u3002\n\n\u4e3a\u4ec0\u4e48\u5462\uff0c\u8fde\u7eed\u9009\u5f88\u597d\u7406\u89e3\uff0c\u7136\u540e\u9009\u5230\u6700\u540e\u662f\u56e0\u4e3a\u4f60\u540e\u9762\u7684\u4e32\u5982\u679c\u53ef\u4ee5\u63a5\u5728\u8fd9\u4e2a\u4e32\u540e\u9762\uff0c\u90a3\u4e48\u8fd9\u4e2a\u4e32\u540e\u9762\u518d\u63a5\u4e00\u70b9\u522b\u7684\u4e1c\u897f\u5b57\u5178\u5e8f\u4e5f\u4e00\u5b9a\u6bd4\u540e\u9762\u90a3\u4e2a\u5927\u3002\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u8f6c\u79fb\u4e86\uff0c\u6211\u4eec\u8bbe $f_i$ \u4e3a\u5728\u539f\u4e32\u4e0a\u5230\u4e86 $i$ \u4f4d\u7f6e\u7684 LIS \u3002\u8bbe $g_{i,j}$ \u4e3a $i$ \u4f4d\u7f6e\u7684\u540e\u7f00\u4e32\u548c $j$ \u4f4d\u7f6e\u7684\u540e\u7f00\u4e32\u7684\u6700\u957f\u516c\u5171\u524d\u7f00\uff08\u610f\u601d\u662f\u8fd9\u4e9b\u4e32\u90fd\u4e00\u6837\uff0c\u8981\u4ece $g_{i,j} + 1$ \u5f00\u59cb\u8f6c\u79fb\uff09\u3002\n\n$$f_i=\\max_{j\\in \\left [ 1,i-1 \\right ] }{f_i,f_j+n-i+1-g_{i,j}}$$\n\n\u6ce8\uff1a $n-i+1$ \u4e3a\u4e32\u957f\u3002\u8fd8\u6709\uff0c\u8f6c\u79fb\u7684\u65f6\u5019\u8981\u5224\u4e00\u4e0b\u5b57\u5178\u5e8f\u662f\u4e0d\u662f\u6bd4\u524d\u9762\u5927\uff0c\u8fd9\u91cc\u4e0d\u662f\u592a\u96be\uff0c\u5177\u4f53\u770b\u4ee3\u7801\u5427\u3002\n\n\u7136\u540e $g$ \u6570\u7ec4\u7684\u8bdd\u6211\u4eec\u53ef\u4ee5 $O(n^2)$ \u5904\u7406\uff0c\u603b\u7684\u590d\u6742\u5ea6\u4e5f\u662f $O(n^2)$ \u7684\u3002\n\n# Code\n\n```cpp\n#include<bits/stdc++.h>\n#define N 5010\nusing namespace std;\ninline void read(int& x)\n{\n\tx=0;int y=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')y=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();}\n\tx=x*y;\n}\nint n,t,g[N][N],f[N];\nchar s[N];\ninline bool chk(int i,int j)\n{\n\tif(i+g[i][j]>n+1)return false;\n\tif(s[i+g[i][j]]>s[j+g[i][j]])return true;\n\telse return false;\n}\nint main(){\n\tread(t);\n\twhile(t--)\n\t{\n\t\tread(n);\n\t\tscanf(\"%s\",s+1);\n\t\tfor(int i=n-1;i>=1;i--)\n\t\t\tif(s[i]==s[n])g[n][i]=1;\n\t\t\telse g[n][i]=0;\n\t\tfor(int i=n-1;i>=1;i--)\n\t\t{\n\t\t\tfor(int j=i-1;j>=1;j--)\n\t\t\t{\n\t\t\t\tif(s[i]==s[j])g[i][j]=g[i+1][j+1]+1;\n\t\t\t\telse g[i][j]=0;\n\t\t\t}\n\t\t}\n\t\tf[1]=n;\n\t\tint ans=f[1];\n\t\tfor(int i=2;i<=n;i++)\n\t\t{\n\t\t\tf[i]=n-i+1;\n\t\t\tfor(int j=1;j<i;j++)\n\t\t\t{\n\t\t\t\tif(!chk(i,j))continue;\n\t\t\t\tf[i]=max(f[i],f[j]+n-i+1-g[i][j]);\n\t\t\t}\n\t\t\tans=max(ans,f[i]);\n\t\t}\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n\n# Conclusion\n\n\u5bf9\u4e8e\u8fd9\u79cd\u7ecf\u5178\u95ee\u9898\u7684\u53d8\u5f62\uff0c\u539f\u7b97\u6cd5\u8dd1\u4e0d\u8fc7\u53bb\u7684\u65b0\u95ee\u9898\uff0c\u6211\u4eec\u8981\u5584\u4e8e\u53d1\u73b0\u5b83\u4eec\u7684\u6027\u8d28\uff0c\u4ece\u800c\u627e\u5230\u5408\u9002\u7684\u65b9\u6cd5\u3002",
        "postTime": 1637138122,
        "uid": 284715,
        "name": "\u906e\u4e91\u58d1",
        "ccfLevel": 7,
        "title": "CF1562E Rescue Niwen!"
    },
    {
        "content": "## \u601d\u8def\n\n\u83dc\u72d7\u7b2c\u4e00\u6b21\u63a5\u89e6 `E` \u9898\uff0c\u5b66\u5230\u7684\u4e1c\u897f\u8fd8\u633a\u591a\u3002\u5b98\u65b9\u9898\u89e3\u662f\u771f\u7684\u96be\u61c2\uff0c\u53e3\u80e1\u4e86\u4e24\u5927\u6bb5\u4e3a\u4ec0\u4e48\u8981 `lcp` \u786c\u662f\u8ba9\u8c37\u6b4c\u7ffb\u8bd1\u7684\u4e71\u4e03\u516b\u7cdf\uff0c\u641e\u4e86\u4e00\u5929\u624d\u61c2\u3002\n\n\n\n\u9898\u76ee\u610f\u5728\u627e\u51fa\u7279\u6b8a\u7684 LIS \uff0c\u5982\u4f55\u771f\u7684\u6309\u7167\u9898\u76ee\u8981\u6c42\u7684\uff0c\u6c42\u51fa\u6240\u6709\u5b57\u4e32\uff0c\u7136\u540e\u6328\u4e2a\u6bd4\u8f83\uff0c\u90a3\u4e48\u5c31\u662f $O(n^4)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002\u8fd9\u542f\u53d1\u6211\u4eec\u53bb\u770b\u6027\u8d28\u3002\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u5982\u679c\u4e00\u4e2a\u4ee5 $l$ \u5f00\u5934\u7684\u5b57\u4e32\uff0c\u5982\u4f55\u4e00\u5f00\u59cb\u5c31\u5728 LIS \u4e2d\uff0c\u90a3\u4e48\u5b57\u4e32 $[l,l+1..n]$ \u4e5f\u4e00\u5b9a\u4f1a\u5728\u5b57\u4e32\u4e2d\u3002\n\n\u4f46\u4e5f\u5b58\u5728\u53e6\u5916\u7684\u60c5\u51b5\uff0c\u5c31\u662f\u4ee5 $l$ \u5f00\u5934\u7684\u90e8\u5206\u5b57\u4e32\u5df2\u7ecf\u5728\u524d\u9762\u51fa\u73b0\u8fc7\u4e86\uff0c\u5373\u524d\u9762\u4e5f\u6709\u4e00\u4e2a\u4ee5 $l$ \u5f00\u5934\u7684\u5b57\u4e32\uff0c\u4f46\u662f\u53e6\u4e00\u90e8\u5206\u7684\u5b57\u4e32\u6bd4\u524d\u9762\u90a3\u4e2a\u7684\u5b57\u4e32 $[l\uff0cn]$ \u8fd8\u5927\uff0c\u6b64\u65f6\u53ef\u4ee5\u76f4\u63a5\u62fc\u4e0a\u53bb\u3002\n\n\u90a3\u4e48\u5982\u4f55\u77e5\u9053\u4ec0\u4e48\u65f6\u5019\u62fc\u4e0a\u53bb\uff0c\u5373\u6bd4\u8f83\u4e24\u4e2a\u7528\u7740\u516c\u5171\u524d\u7f00\u7684\u5b57\u4e32\u7684\u5927\u5c0f\u3002\u6c42\u51fa\u4e24\u4e2a\u5b57\u4e32\u7684 LCP\uff0c\u6bd4\u8f83\u4e0b\u4e00\u4f4d\u5373\u53ef\u3002\n\n\u6c42 LCP \u7684\u65b9\u5f0f\u662f DP \uff0c\u8bbe $lcp_{i,j}$ \u8868\u793a\u540e\u7f00 $[i,n]$ \u548c\u540e\u7f00 $[j,n]$ \u7684LCP\uff0c\u672c\u6765\u81ea\u5df1\u662f\u60f3\u4e0d\u5230\u7684\uff0c\u8fd8\u4ee5\u4e3a\u8981\u53bb\u5b66\u540e\u7f00\u6392\u5e8f\uff0c\u7136\u540e\u770b\u4e86\u9898\u89e3\u624d\u77e5\u8fd9\u4e48\u663e\u7136\uff1a\n$$\nlcp_{i,j}=lcp_{i+1,j+1}+1 (s[i]=s[j])\n$$\n\u7136\u540e\u5c31\u662f\u6c42 LIS \uff0c\u51b3\u7b56\u5c31\u4e0a\u524d\u9762\u8bf4\u7684\uff0c\u662f\u5426\u53ef\u4ee5\u4ea7\u751f\u62fc\u63a5\u7684\u60c5\u51b5\u3002\n\n\u4ee4 $f_{i}$ \u8868\u793a\u5230 $i$ \u5f00\u5934\u7684\u5b57\u7b26\u4e32\u524d\u7684\u6240\u6709\u5b57\u4e32\u4ea7\u751f\u7684 LIS \n\n\u8f6c\u79fb\u6211\u4eec\u9700\u8981\u5224\u65ad\u4e24\u4e2a\u4e1c\u897f\uff0c\u56e0\u4e3a\u4ee3\u7801\u4e5f\u8bb8\u5bf9\u4e8e\u4e00\u4e9b\u4eba\u6bd4\u8f83\u96be\u61c2\uff08~~\u6211~~ \uff0c\u6211\u505a\u4e00\u4e0b\u89e3\u91ca\u3002\n\n\u6211\u4eec\u5927\u529b\u679a\u4e3e\u524d\u9762\u5df2\u7ecf\u6c42\u8fc7\u7684 LIS \uff0c\u5c31\u5f53\u662f $j$\uff0c\u5982\u679c\u6b64\u65f6\u7684 $i$ \u548c $j$ \u5b58\u5728 LCP \u8003\u8651\u62fc\u63a5\u95ee\u9898\uff0c\u5982\u679c\u4e0d\u80fd\u62fc\u63a5\uff0c\u770b\u5c06 $j$ \u5168\u90e8\u9664\u53bb\u662f\u5426\u4f1a\u66f4\u4f18\n\n```c\n\tif (l[j]-lcp[i][j]>l[i] && s[j+lcp[i][j]]<s[i+lcp[i][j]])\n\tl[i]=l[j]-lcp[i][j];\n\t\t\n```\n\n\u8fd9\u6bb5\u8bf4\u660e\u7684\u662f\u5982\u679c $j$ \u53bb\u9664 LCP \u540e\u957f\u5ea6\u5728 $i$ \u7684\u51b3\u7b56\u70b9\u4e2d\u5c5e\u4e8e\u6700\u4f18\u7684\uff0c\u5e76\u4e14 $i$ \u53ef\u4ee5\u62fc\u63a5\u4e0a\u6765\uff0c\u90a3\u4e48\u76f4\u63a5\u8f6c\u79fb\n\n\u8f6c\u79fb\u65f6\u51cf\u53bb LCP \u7684\u539f\u56e0\uff0c\u5982\u4e0b\uff1a\n\n```c\nl[i]=l[i]+n-i+1;\nif (l[i]>ans) ans=l[i];\n```\n\n\u5982\u679c\u53ef\u4ee5\u62fc\u63a5\u90a3\u4e48 $n-i+1$ \u5c31\u4f1a\u5c06 LCP \u62b5\u6d88\u6389\uff0c\u76f8\u5f53\u4e8e\u53ea\u52a0\u4e86\u540e\u9762\u7684\u4e00\u90e8\u5206\u3002\u540c\u7406\u5982\u679c\u6ca1\u6709\u53ef\u4ee5\u62fc\u63a5\u7684\uff0c\u8bc1\u660e\u524d\u9762\u6ca1\u6709\u516c\u5171\u524d\u7f00\uff0c\u90a3\u4e48\u76f4\u63a5\u5c06\u81ea\u5df1\u7684\u5168\u90e8\u5b57\u4e32\u8bb0\u5f55\u5230\u8d21\u732e\u91cc\u5373\u53ef\u3002\u6240\u4ee5\u8fd9\u4e00\u6b65\u53ef\u4ee5\u7406\u89e3\u4e3a\u662f\u4e3a\u4e24\u79cd\u60c5\u51b5\u7684\u540c\u4e00\u5904\u7406\u3002\n\n```c\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\nusing namespace std;\nconst int B=5e3+10;\nint lcp[B][B];\nint T;\nint n;\nint l[B];\nchar s[B];\nint read() {int x; scanf(\"%d\",&x); return x;}\nvoid solve()\n{\n\tn=read();\n\tcin>>s+1;\n\tfor (int i=0;i<=n;i++)\n\t\tfor (int j=0;j<=n;j++) lcp[i][j]=0;\n\tfor (int i=n;i>=1;i--)\n\t{\t\n\t\tl[i]=0;\n\t\tfor (int j=n;j>=1;j--)\n\t\t{\n\t\t\tif (s[i]==s[j]) lcp[i][j]=lcp[i+1][j+1]+1;\n\t\t}\n\t}\n\tint ans=0;\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tfor (int j=1;j<=n;j++)\n\t\t{\n\t\t\tif (l[j]-lcp[i][j]>l[i] && s[j+lcp[i][j]]<s[i+lcp[i][j]])\n\t\t\tl[i]=l[j]-lcp[i][j];\n\t\t}\n\t\tl[i]=l[i]+n-i+1;\n\t\tif (l[i]>ans) ans=l[i];\n\t}\t\n\tprintf(\"%d\\n\",ans);\n}\nint main()\n{\n\tT=read();\n\twhile (T--) solve(); \n} \n```\n\u6ce8\uff1aLCP \u8868\u793a\u4e24\u4e2a\u5b57\u4e32\u7684\u6700\u5927\u516c\u5171\u524d\u7f00\n",
        "postTime": 1630219520,
        "uid": 230808,
        "name": "Zxsoul",
        "ccfLevel": 4,
        "title": "E. Rescue Niwen!"
    },
    {
        "content": "[\u4f20\u9001\u95e8](https://codeforces.com/problemset/problem/1562/E)\n\n\u8fd8\u6ca1\u6709\u51fa\u73b0\u4f18\u4e8e\u5e73\u65b9\u7684\u505a\u6cd5\uff0c\u6240\u4ee5 lcp \u90e8\u5206\u542c\u8bf4\u88ab\u4e8c\u5206+hash\u641e\u8fc7\u53bb\u4e86\u3002\n\n\u624b\u73a9\u4ee5\u540e\u53d1\u73b0\u5982\u679c\u9009\u4e86 $s_{l...r}$\uff0c\u90a3\u4e48 $s_{l...r+1},s_{l...r+2}$ \u4e00\u76f4\u5230 $s_{l...n}$ \u90fd\u4f1a\u88ab\u9009\u62e9\u3002\u56e0\u4e3a\u5047\u8bbe\u540e\u9762\u53c8\u9009\u62e9\u4e86\u4e00\u4e2a\u4e32 $t$ \u5927\u4e8e $s_{l...r}$\uff0c\u90a3\u4e48 $t$ \u4e5f\u4e00\u5b9a\u5927\u4e8e $s_{l...r+1},s_{l...r+2},...,s_{l...n}$ \u8fd9\u4e9b\u4e32\u3002\n\n\u6240\u4ee5\u76f4\u63a5\u8bbe $dp_i$ \u662f\u6700\u540e\u9009\u7684\u662f $i$ \u540e\u7f00\u7684 LIS \u957f\u5ea6\u3002\u8003\u8651 $dp_i$ \u4ece $dp_j$ \u8f6c\u79fb\u800c\u6765\uff08$j<i$\uff09\uff0c\u90a3\u4e48\u4e3a\u4e86\u8ba9 $i$ \u540e\u7f00\u8fd9\u91cc\u9009\u62e9\u7684\u4e32\u5c3d\u53ef\u80fd\u591a\u4e14\u5927\u4e8e $s_{j...n}$\uff0c\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa $i$ \u540e\u7f00\u548c $j$ \u540e\u7f00\u7684 $lcp$ \u503c $len$\u3002\u5982\u679c $i+len \\le n$ \u4e14 $s_{i+len}>s_{j+len}$\uff0c\u6211\u4eec\u5c31\u628a $s_{i,i+len}$ \u4e00\u76f4\u5230 $s_{i,n}$ \u8fd9 $(n-i+1)-len$ \u4e2a\u5b50\u4e32\u5168\u90e8\u9009\u62e9\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2)$\u3002\u6ce8\u610f\u8fd9\u91cc\u7684 $lcp$ \u53ef\u4ee5\u6c42\u51fa $height$ \u4ee5\u540e $O(n^2)$ \u9884\u5904\u7406\uff0c\u4e0d\u7528\u9ebb\u70e6\u5730\u518d\u53bb\u5199\u4e00\u4e2a RMQ\u3002\n\n```\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=(a);i<=(b);i++)\n#define per(i,a,b) for(int i=(a);i>=(b);i--)\n#define op(x) ((x&1)?x+1:x-1)\n#define odd(x) (x&1)\n#define even(x) (!odd(x))\n#define lc(x) (x<<1)\n#define rc(x) (lc(x)|1)\n#define lowbit(x) (x&-x)\n#define Max(a,b) (a>b?a:b)\n#define Min(a,b) (a<b?a:b)\n#define next Cry_For_theMoon\n#define il inline\n#define pb(x) push_back(x)\n#define is(x) insert(x)\n#define sit set<int>::iterator\n#define mapit map<int,int>::iterator\n#define pi pair<int,int>\n#define ppi pair<int,pi>\n#define pp pair<pi,pi>\n#define fr first\n#define se second\n#define vit vector<int>::iterator\n#define mp(x,y) make_pair(x,y)\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef unsigned int uint;\ntypedef double db;\nusing namespace std;\nconst int MAXN=5010;\nint T,n,ans,f[MAXN];\nchar s[MAXN];\nstruct SA{\n\tint sa[MAXN],rk[MAXN*2],oldrk[MAXN*2],cnt[MAXN],tmp[MAXN];\n\tint lcp[MAXN][MAXN],height[MAXN];\n\tvoid build(char* s,int n){\n\t\trep(i,0,n*2+5){rk[i]=oldrk[i]=0;}\n\t\tint m=max(n,150);\n\t\trep(i,0,m)cnt[i]=0;\n\t\trep(i,1,n)rk[i]=s[i]; \n\t\trep(i,1,n)cnt[rk[i]]++;\n\t\trep(i,1,m)cnt[i]+=cnt[i-1];\n\t\tper(i,n,1)sa[cnt[rk[i]]--]=i;\n\t\tfor(int w=1;w<n;w<<=1){\n\t\t\tint p=0;\n\t\t\trep(i,n-w+1,n)tmp[++p]=i;\n\t\t\trep(i,1,n)if(sa[i]>w)tmp[++p]=sa[i]-w;\n\t\t\trep(i,0,m)cnt[i]=0;\n\t\t\trep(i,1,n)cnt[rk[tmp[i]]]++;\n\t\t\trep(i,1,m)cnt[i]+=cnt[i-1];\n\t\t\tper(i,n,1)sa[cnt[rk[tmp[i]]]--]=tmp[i];\n\t\t\trep(i,1,n)oldrk[i]=rk[i];\n\t\t\trk[sa[1]]=1;\n\t\t\trep(i,2,n){\n\t\t\t\trk[sa[i]]=rk[sa[i-1]];\n\t\t\t\tif(oldrk[sa[i]] != oldrk[sa[i-1]] || oldrk[sa[i]+w] != oldrk[sa[i-1]+w])rk[sa[i]]++;\n\t\t\t}\n\t\t}\n\t\tint j=0;\n\t\trep(i,1,n){\n\t\t\tif(j)j--;\n\t\t\twhile(s[i+j]==s[sa[rk[i]-1]+j])j++; \n\t\t\theight[rk[i]]=j;\n\t\t}\n\t\trep(i,1,n){\n\t\t\tlcp[i][i]=(n-sa[i]+1);\n\t\t\trep(j,i+1,n){\n\t\t\t\tlcp[i][j]=min(lcp[i][j-1],height[j]);\n\t\t\t}\n\t\t}\n\t}\n\tint query(int L,int R){\n\t\tL=rk[L];R=rk[R];\n\t\tif(L>R)swap(L,R);\n\t\treturn lcp[L][R];\n\t}\n}sa;\nvoid solve(){\n\tscanf(\"%d%s\",&n,s+1);\n\tsa.build(s,n);\n\tans=0;\n\trep(i,1,n){\n\t\tf[i]=n-i+1;\n\t\trep(j,1,i-1){\n\t\t\t//f[i]\u7531f[j]\u8f6c\u79fb\u800c\u6765\n\t\t\tint len=sa.query(i,j);\n\t\t\tif(i+len-1==n || s[i+len]<s[j+len])continue; //\u4e0d\u80fd\u8f6c\u79fb\n\t\t\tf[i]=max(f[i],f[j]+(n-i+1-len)); \n\t\t}\n\t\tans=max(ans,f[i]);\n\t}\n\tprintf(\"%d\\n\",ans);\n}\nint main(){\n\tscanf(\"%d\",&T);\n\twhile(T--){\n\t\tsolve();\n\t}\n\t\n\treturn 0;\n}\n```",
        "postTime": 1630068416,
        "uid": 340632,
        "name": "Cry_For_theMoon",
        "ccfLevel": 8,
        "title": "\u3010CF1562E\u3011Rescue Niwen!"
    },
    {
        "content": "### \u9898\u76ee\u5206\u6790\n\n\u5148\u8bbe\u539f\u4e32\u4e2d\u4ee5 $x$ \u4f4d\u7f6e\u4e3a\u5f00\u5934\u7684\u6240\u6709\u5b50\u4e32\u7684\u96c6\u5408\u4e3a $sw(x)$\uff0c$s(x,y)$ \u8868\u793a\u539f\u4e32\u4e2d\u4ece $x$ \u5230 $y$ \u7684\u5b50\u4e32\u3002\n\n\u7531\u4e8e\u540c\u4e00\u4e2a $x$ \u5bf9\u5e94\u7684 $sw(x)$ \u5728\u6700\u540e\u7684 LIS \u91cc\u51fa\u73b0\u7684\u4e00\u5b9a\u662f\u8fde\u7eed\u7684\uff0c\n\n\u800c\u4e14\u4e00\u5b9a\u6709\u4e00\u79cd\u6700\u4f18\u65b9\u6848\u4f7f\u5f97\u82e5 $sw(x)$ \u4e2d\u5b58\u5728\u4e00\u4e2a\u4e32\u5728 LIS \u4e2d\u51fa\u73b0\u8fc7\uff0c\u5219 $s(x,n)$ \u4e5f\u51fa\u73b0\u8fc7\uff0c\uff08\u8bc1\u660e\u5148\u9e3d\u7740\uff0c\u6709\u9700\u8981\u7684\u50ac\u6211\uff09\n\n\u6240\u4ee5\u8bbe `dp[i]` \u8868\u793a\u4ee5 $s(i,n)$ \u4e3a\u7ed3\u5c3e\u7684\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684\u957f\u5ea6\u3002\n\n\u7ebf\u6027\u679a\u4e3e `dp[i]` \u662f\u4ece\u54ea\u4e2a `dp[j]`$(j<i)$ \u63a8\u8fc7\u6765\u3002\n\n### Details\n\n\u5148 init \u51fa `lcp[i][j]`\uff0c\u5373 $i$ \u548c $j$ \u7684\u6700\u957f\u516c\u5171\u540e\u7f00\u7684\u957f\u5ea6\uff0c\u4fbf\u4e8e\u51b3\u7b56\u3002\n\n### ACcode\n\n\u590d\u6742\u5ea6 $O(Tn^2)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntemplate<class T> inline void ckmx(T &a,T b){ if(a<b)a=b; }\n#define IOS ios::sync_with_stdio(0);cin.tie(0);cout.tie(0)\n#define For(i,j,k) for(register int i=j;i<=k;i++)\n#define Rof(i,j,k) for(register int i=j;i>=k;i--)\n#define N 5050\n\nint T,n;\nstring s;\nint ans;\nint lcp[N][N];//i\u548cj\u7684\u6700\u957f\u516c\u5171\u540e\u7f00\u7684\u957f\u5ea6 \nint dp[N];//\u4ee5[i,n]\u4e3a\u7ed3\u5c3e\u7684\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\u7684\u957f\u5ea6 \nbool bigger(int x,int y){//\u4ee5x\u4e3a\u5f00\u5934\u7684\u540e\u7f00 \u662f\u5426\u6bd4 \u4ee5y\u4e3a\u5f00\u5934\u7684\u540e\u7f00 \u5927\uff08x>y\uff09 \n\tif(x+lcp[x][y]==n)return false;\n\telse return s[x+lcp[x][y]]>s[y+lcp[x][y]];\n}\nint contri(int x,int y){//j\u66f4\u65b0i \n\tif(bigger(x,y)) return dp[y]+n-x-lcp[x][y];\n\telse return 0;\n}\nsigned main(){\n\tIOS;\n\tcin>>T;\n\twhile(T--){\n\t\tcin>>n;\n\t\tcin>>s;\n\t\tFor(i,0,n)For(j,0,n)lcp[i][j]=0;//\u5f52\u96f6 \n\t\tRof(i,n-1,0)\n\t\t\tRof(j,n-1,0)\n\t\t\t\tif(i==j)\n\t\t\t\t\tlcp[i][j]=n-i;//\u4e4b\u540e\u90fd\u76f8\u7b49 \n\t\t\t\telse if(s[i]==s[j])\n\t\t\t\t\tlcp[i][j]=lcp[i+1][j+1]+1;//\u9012\u63a8 \n\t\tans=n;\n\t\tdp[0]=n;\n\t\tFor(i,1,n-1){\n\t\t\tdp[i]=n-i;\n\t\t\tFor(j,0,i-1)\n\t\t\t\tckmx(dp[i],contri(i,j));\n\t\t\tckmx(ans,dp[i]);\n\t\t}\n\t\tcout<<ans<<endl;\n\t} \n    return 0;\n}\n\n```",
        "postTime": 1630034128,
        "uid": 101868,
        "name": "I_am_Accepted",
        "ccfLevel": 0,
        "title": "CF1562E\u9898\u89e3"
    }
]
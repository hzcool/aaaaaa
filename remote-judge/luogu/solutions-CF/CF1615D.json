[
    {
        "content": ">\u7ed9\u5b9a\u4e00\u9897 $n(n\\le 2\\times 10^5)$ \u4e2a\u70b9\u7684\u5e26\u6743\u6811\uff0c\u4e00\u4e9b\u6743\u503c\u5df2\u7ecf\u786e\u5b9a\u800c\u5176\u4ed6\u7684\u6ca1\u6709\u786e\u5b9a\uff08\u7528 $-1$ \u8868\u793a\uff09\u3002\n\n>\u73b0\u5728\u6709 $m(m\\le 2\\times 10^5)$ \u6761\u4fe1\u606f\u8868\u793a $u_i$ \u5230 $v_i$ \u7684\u8def\u5f84\u4e0a\u7684\u6743\u503c $\\texttt{xor}$ \u548c\u7684 popcount \u4e3a\u5947\u6570\u8fd8\u662f\u5076\u6570\u3002\n\n>\u8bf7\u4f60\u6784\u9020\u51fa\u8fd9\u6837\u4e00\u68f5\u6811\uff0c\u6216\u8005\u8f93\u51fa\u65e0\u89e3\u3002\n\n\u6211\u60f3\u5230\u7684\u5185\u5bb9\uff1a\u5c06\u8def\u5f84\u4e0a\u7684\u5f02\u6216\u548c\u8f6c\u5316\u4e3a\u4e24\u4e2a\u70b9\u5230\u6839\u7684\u8ddd\u79bb\u7684\u5f02\u6216\u548c\uff0c\u800c\u4e14\u6bcf\u6539\u53d8\u8def\u5f84\u4e0a\u4e00\u6761\u8fb9\u7684\u4e8c\u8fdb\u5236\u4f4d\u90fd\u4f1a\u6539\u53d8\u8def\u5f84 popcount \u7684\u5947\u5076\u6027\u3002\n\n\u4e4b\u540e\u5c31\u4e0d wei zhuo \u5566\u3002\n\n\u6838\u5fc3\u601d\u60f3\uff1a\u5176\u5b9e\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u4e00\u6761\u8fb9\u7684\u6743\u503c\u6839\u636e\u5176 popcount \u7684\u5947\u5076\u6027\u6539\u4e3a $0$ \u6216 $1$\uff0c\u56e0\u4e3a\u4efb\u610f\u4e00\u4f4d\u6539\u53d8\u90fd\u4f1a\u5f71\u54cd\u5947\u5076\u6027\u3002\n\n\u90a3\u4e48\u6240\u6709\u7684\u5f02\u6216\u503c\u53ea\u80fd\u4e3a $0$ \u6216 $1$ \u4e86\u3002\n\n\u5982\u679c\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u8def\u5f84\u5947\u5076\u6027\u7b49\u4e8e $1$\uff0c\u5219\u8fd9\u4e24\u4e2a\u70b9\u5230\u6839\u7684\u8def\u5f84 popcount \u4e0d\u7b49\uff1b\u53cd\u4e4b\uff0c\u5219\u76f8\u7b49\u3002\n\n\u56e0\u6b64\u8f6c\u5316\u4e3a\u4e86\u8fd9\u6837\u4e00\u9053\u9898\uff1a\u6709\u4e24\u4e2a\u96c6\u5408\uff0c\u7b2c $i$ \u4e2a\u6761\u4ef6\u8868\u793a $u$ \u548c $v$ \u5728\u540c\u4e00\u4e2a\u96c6\u5408\uff0c\u6216\u4e0d\u5728\u540c\u4e00\u4e2a\u96c6\u5408\uff0c\u6c42\u51fa\u4e00\u7ec4\u89e3\u3002\n\n\u8fd9\u4e0d\u5c31\u662f 2-sat \u6216\u6269\u5c55\u57df\u5e76\u67e5\u96c6\u88f8\u9898\u5417\uff1f\u76f4\u63a5\u8dd1\u5373\u53ef\u3002\n\n\u8f93\u51fa\u65b9\u6848\u7684\u65f6\u5019\u770b\u4e00\u6761\u8fb9\u4e0a\u7684\u4e24\u4e2a\u70b9\u662f\u5426\u5728\u540c\u4e00\u4e2a\u96c6\u5408\uff0c\u5728\u5373 $0$\uff0c\u4e0d\u5728\u5373 $1$\u3002\n\n```cpp\n#define Maxn 200005\ntypedef long long ll;\nint T,n,m,tot=1;\nint hea[Maxn<<1],nex[Maxn<<1],ver[Maxn<<1],edg[Maxn<<1],ans[Maxn<<1];\nint fa[Maxn<<1];\nbool Last[Maxn];\ninline void add(int x,int y,int d)\n{ ver[++tot]=y,nex[tot]=hea[x],hea[x]=tot,edg[tot]=d; }\nint Find(int x){ return (fa[x]==x)?x:(fa[x]=Find(fa[x])); }\ninline void merge(int x,int y) { fa[Find(x)]=Find(y); }\nvoid dfs(int x,int F)\n{\n\t for(int i=hea[x];i;i=nex[i])\n\t {\n\t \t if(ver[i]==F) continue;\n\t \t if(Last[x]!=Last[ver[i]]) ans[i]=ans[i^1]=1;\n\t \t else ans[i]=ans[i^1]=0;\n\t \t dfs(ver[i],x);\n\t }\n}\nvoid solve()\n{\n \t n=rd(),m=rd(),tot=1;\n \t for(int i=1;i<=n+n;i++) fa[i]=i,hea[i]=0;\n \t for(int i=1,x,y,d;i<n;i++)\n\t {\n\t \t x=rd(),y=rd(),d=rd(),add(x,y,d),add(y,x,d);\n \t \t if(d!=-1)\n\t\t {\n\t\t \t if(__builtin_popcount(d)&1) merge(x,y+n),merge(x+n,y);\n\t\t \t else merge(x,y),merge(x+n,y+n);\n\t\t }\n\t }\n \t for(int i=1,x,y,d;i<=m;i++)\n \t {\n \t \t x=rd(),y=rd(),d=rd();\n \t \t if(d) merge(x+n,y),merge(x,y+n);\n \t \t else merge(x,y),merge(x+n,y+n);\n\t }\n\t for(int i=1;i<=n;i++) if(Find(i)==Find(i+n)) { printf(\"NO\\n\"); return; }\n\t for(int i=1;i<=n;i++) Last[i]=(Find(i)<=n)?1:0;\n \t dfs(1,0);\n \t printf(\"YES\\n\");\n \t for(int i=2;i<=tot;i+=2)\n\t  \t if(edg[i]!=-1) printf(\"%d %d %d\\n\",ver[i],ver[i^1],edg[i]);\n\t  \t else printf(\"%d %d %d\\n\",ver[i],ver[i^1],ans[i]);\n}\nint main()\n{\n\t T=rd();\n\t while(T--) solve();\n\t return 0;\n}\n```",
        "postTime": 1640396300,
        "uid": 113073,
        "name": "EricQian",
        "ccfLevel": 7,
        "title": "CF1615D \u9898\u89e3"
    },
    {
        "content": "\u540e\u6587 $\\operatorname{popcnt}(x)$ \u5c31\u662f popcount\uff0c\u5373 $x$ \u4e8c\u8fdb\u5236\u4e2d $1$ \u7684\u4e2a\u6570 .\n***\n\n> \u5f15\u7406\n> \n> $$\\operatorname{popcnt}(x\\oplus y)\\equiv \\operatorname{popcnt}(x)+\\operatorname{popcnt}(x)\\pmod 2$$\n\n\u8bc1\u660e\uff1a\u6309\u4f4d\u8003\u8651\u771f\u503c\u8868\uff1a\n\n| $x$ | $y$ | LHS | RHS |\n| :--: | :--: | :--: | :--: |\n| $0$ | $0$ | $0$ | $0$ |\n| $0$ | $1$ | $1$ | $1$ |\n| $1$ | $0$ | $1$ | $1$ |\n| $1$ | $1$ | $0$ | $2$ |\n\n\u663e\u7136 $\\mathrm{LHS}\\equiv \\mathrm{RHS}\\pmod 2$\uff0c\u8bc1\u6bd5 .\n***\n\u6240\u4ee5\u6761\u4ef6\u76f8\u5f53\u4e8e\u7ed9\u8def\u5f84 $\\operatorname{popcnt}$ \u548c\u7684\u5947\u5076\u6027 .\n\n\u4e8e\u662f\u76f4\u63a5\u8ba9\u6240\u6709\u8fb9\u6743\u90fd\u662f $0$ \u6216 $1$\uff0c\u663e\u7136\u4e0d\u5931\u4e00\u822c\u6027 .\n\n\u4ee4 $e_u$ \u4e3a\u4ece\u6839\u5230\u70b9 $u$ \u7684\u8fb9\u6743\u5f02\u6216\u548c\uff0c\u4e8e\u662f\u6bcf\u6761\u8def\u5f84\u7684\u8fb9\u6743 $\\operatorname{popcnt}$ \u548c\u5c31\u53ef\u4ee5\u62c6\u6210\u4e24\u4e2a $e$ \u7684\u5f02\u6216 .\n\n\u6211\u4eec\u7684\u6761\u4ef6\u5c31\u53d8\u6210\u4e86\u4e00\u5927\u5806\n$$e_p\\oplus e_q\\equiv c\\pmod 2$$\n\u5176\u4e2d $c\\in\\{0,1\\}$\uff0c\u7136\u540e\u56e0\u4e3a $e_p, e_q$ \u4e5f\u90fd\u5728 $\\{0,1\\}$ \u91cc\uff0c\u4e8e\u662f\u968f\u4fbf\u53d8\u5f62\u4e00\u4e0b\uff1a\n- $c=0$\uff1a$e_p=e_q$ .\n- $c\\neq 0$\uff1a$e_p\\neq e_q$ .\n\n\u8fd9\u4e0d\u662f sb \u9898\u5417\uff0c\u968f\u4fbf\u5e76\u67e5\u96c6\u4e00\u4e0b\u5c31\u6ca1\u4e86 .\n***\n\u4ee3\u7801\u7565",
        "postTime": 1642233653,
        "uid": 325613,
        "name": "Implicit",
        "ccfLevel": 0,
        "title": "CF1615D \u9898\u89e3"
    },
    {
        "content": "\n## \u7b80\u8ff0\u9898\u610f\uff1a\n\u8bf4\uff1a\u7ed9\u4e00\u68f5\u6811\uff0c\u67d0\u4e9b\u5730\u65b9\uff08\u8fb9\u6743\uff09\u662f -1 \uff0c\u8ba9\u4f60\u628a\u6bcf\u4e2a -1 \u7684\u4f4d\u7f6e\u586b\u4e00\u4e2a\u503c\uff0c\u4f7f\u5f97\u6ee1\u8db3 $q$ \u4e2a\u9650\u5236\uff0c\u6bcf\u4e2a\u9650\u5236\u5f62\u5982 $x,y,0/1$ \u8868\u793a\u4ece $x$ \u8d70\u5230 $y$ \u7684\u6240\u6709\u8fb9\u6743\u5f02\u6216\u548c\u7684\u4e8c\u8fdb\u5236\u8868\u793a\u6709\u5947\u6570/\u5076\u6570\u4e2a1\u3002\n\n## \u89e3\u6cd5\uff1a\n\n\u4ed4\u7ec6\u89c2\u5bdf\uff0c\u53d1\u73b0\u5bf9\u4e8e\u4e00\u6761\u8fb9\uff0c\u82e5\u4e8c\u8fdb\u5236\u7684\u67d0\u4e00\u4f4d\u586b\u4e00\u4e2a 1 \uff0c\u5219\u4f1a\u5f71\u54cd\u6240\u6709\u8fc7\u8fd9\u4e2a\u8fb9\u7684\u9650\u5236\uff08 0 \u53d8 1 , 1 \u53d8 0 \uff09\uff0c\u4e8c\u8fdb\u5236\u4efb\u610f\u4e00\u4f4d\u586b1\u8fd9\u4e2a\u7684\u5f71\u54cd\u662f\u76f8\u540c\u7684\uff0c\u4e8e\u662f\u6211\u4eec\u53ea\u7528\u8003\u8651-1\u8fb9\u586b0/1\u5373\u53ef\uff0c\u7136\u540e\u6d88\u9664\u5df2\u7ecf\u586b\u4e86\u7684\u8fb9\u9650\u5236\u3002\n\n\u7136\u540e\u5c31\u4f1a\u53d8\u6210\u4e00\u5806\u8fb9\u5f02\u6216\u8d77\u6765\u4e3a\u4e00\u4e2a\u5b9a\u503c\uff0c\u663e\u7136**\u4e0d\u80fd**\u9ad8\u65af\u6d88\u5143\uff0c\u76f4\u63a5\u6811\u4e0a\u5dee\u5206\uff0c\u6362\u6210\u5230\u6839\u524d\u7f00\u5f02\u6216\u548c\uff08\u6ce8\u610f\u5728\u4e00\u6761\u5e26\u521d\u59cb\u8fb9\u6743\u7684\u8fb9\u7684\u4e24\u7aef\u5230\u6839\u662f\u6709\u9650\u5236\u7684\uff0c\u5728\u6d88\u9664\u5f71\u54cd\u540e\u9650\u5236\u662f\u4e24\u8fb9\u5230\u6839\u524d\u7f00\u548c\u76f8\u7b49\u76f8\u7b49\uff09\uff0c\u7136\u540e\u5e26\u6743\u5e76\u67e5\u96c6\u7ef4\u62a4\u3002\n\n```\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nchar gc(){static char buf[1<<16],*s,*t;if(s==t){t=(s=buf)+fread(buf,1,1<<16,stdin);if(s==t)return EOF;}return *s++;}\n//#define getchar gc\nint read()\n{\n\tchar c;\n\tint w=1;\n\twhile((c=getchar())>'9'||c<'0')if(c=='-')w=-1;\n\tint ans=c-'0';\n\twhile((c=getchar())>='0'&&c<='9')ans=(ans<<1)+(ans<<3)+c-'0';\n\treturn ans*w;\n}\nvoid pc(char c,int op)\n{\n\tstatic char buf[1<<16],*s=buf,*t=buf+(1<<16);\n\t(op||((*s++=c)&&s==t))&&((fwrite(buf,1,s-buf,stdout)),s=buf);\n}\nvoid wt(int x)\n{\n\tif(x>9)wt(x/10);\n\tpc('0'+x%10,0);\n}\nvoid wts(int x,char op)\n{\n\tif(x<0)pc('-',0),x=-x;\n\twt(x);pc(op,0);\n}\nconst int xx=2e5+5;\nint fa[xx],sum[xx];//0\u8868\u793a\u76f8\u7b491\u8868\u793a\u4e0d\u76f8\u7b49 \nint find(int x)//\u8fd4\u56de\u7684\u8fd8\u662f\u70b9 \n{\n\tif(fa[x]==x)return x;\n\tint a=find(fa[x]);\n\tsum[x]=sum[x]^sum[fa[x]];\n\tfa[x]=fa[fa[x]];\n\treturn fa[x];\n}\nstruct nod{int next,to,v;}e[xx<<1];\nint cnt,h[xx];\nvoid add(int x,int y,int z)\n{\n\tcnt++;\n\te[cnt].next=h[x];\n\th[x]=cnt;\n\te[cnt].to=y;\n\te[cnt].v=z;\n}\nint d[xx],f[xx],fv[xx];\nint dep[xx];\n//\u6ce8\u610f\u53ef\u80fd\u7ed9\u51fa\u6765\u67090\u7684\u8fb9\u6743 \nvoid dfs(int x,int y)\n{\n\tdep[x]=dep[y]+1;\n\tf[x]=y;\n\tfor(int i=h[x];i;i=e[i].next)\n\t{\n\t\tif(e[i].to==y)continue;\n\t\tfv[e[i].to]=e[i].v;\n\t\tif(e[i].v==-1)\n\t\t\td[e[i].to]=d[x];\n\t\telse d[e[i].to]=d[x]^e[i].v;\n\t\tdfs(e[i].to,x);\n\t\t\n\t}\n}\nstruct No\n{\n\tint a,b,c;\n};\nint op=1;\nvoid AD(int x,int y,int z)\n{\n\tif(!op)return;\n\tif(find(x)==find(y))\n\t{\n\t\tif((sum[x]^sum[y])!=z)op=0;\n\t\treturn;\n\t}\n\tint o=find(y); \n\tsum[o]=sum[y]^z;\n\t//\u8fd9\u91cc\u5148\u66f4\u65b0sum find\u8981\u9519\uff01 \n\tfa[o]=x;\n}\nint ans[xx];\nint main(){\n\tint T=read();\n\twhile(T--)\n\t{\n\t\top=1;\n\t\tint n=read(),m=read();\n\t\tmemset(e,0,sizeof(e[0])*(cnt+1));\n\t\tmemset(h,0,sizeof(h[0])*(n+1));\n\t\tcnt=0;\n\t\tfor(int i=1;i<=n;i++)fa[i]=i,sum[i]=0;\n\t\tvector<No>v;\n\t\tfor(int i=1;i<n;i++)\n\t\t{\n\t\t\tint a=read(),b=read(),c=read();\n\t\t\tadd(a,b,c),add(b,a,c);\n\t\t\tv.push_back({a,b,c});\n\t\t}\n\t\tdfs(1,0);\n\t\tfor(int i=1;i<=m;i++)\n\t\t{\n\t\t\tint a=read(),b=read(),c=read();\n\t\t\tint now=d[a]^d[b];\n\t\t\tint num=__builtin_popcount(now);\n\t\t\tnum&=1,c^=num;\n\t\t\tAD(a,b,c);\n\t\t}\n\t\t//\u76f8\u5f53\u4e8e\u628a\u6240\u6709\u5e26\u9650\u5236\u7684\u5730\u65b9\u90fd\u8f6c\u6210\u4e860 \n\t\tfor(int i=2;i<=n;i++)\n\t\t{\n\t\t\tif(fv[i]!=-1)\n\t\t\t{\n\t\t\t\tint a=i,b=f[i],c=0;\n\t\t\t\tAD(a,b,c);//\u5f3a\u5236\u8981\u6c42\u76f8\u7b49 \n\t\t\t}\n\t\t}\n\t\tif(!op)\n\t\t{\n\t\t\tputs(\"No\");\n\t\t\tcontinue;\n\t\t}\n\t\tfor(int i=1;i<=n;i++)ans[i]=0;\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tif(find(i)==i)ans[i]=0;\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tif(find(i)!=i)ans[i]=sum[i];\n\t\tputs(\"Yes\");\n\t\tfor(auto it:v)\n\t\t{\n\t\t\tif(it.c!=-1)\n\t\t\t\tcout<<it.a<<\" \"<<it.b<<\" \"<<it.c<<\"\\n\";\n\t\t\telse \n\t\t\t\tcout<<it.a<<\" \"<<it.b<<\" \"<<(ans[it.a]^ans[it.b])<<\"\\n\";\n\t\t}\n\t}\n\tpc('1',1);\n\treturn 0;\n}\n```",
        "postTime": 1640610482,
        "uid": 371852,
        "name": "\u4e00\u5ff5\u4e4b\u95f4\u3001\u3001",
        "ccfLevel": 0,
        "title": "CF1615D X(or)-mas Tree"
    },
    {
        "content": "~~\u9898\u76ee\u96be\u5ea6\u9010\u6e10\u4ece 2400 \u6389\u5230 2200 \u505a\u4e0d\u52a8\u4e86\uff09~~\n\n\u6e05\u65b0\u6784\u9020\u9898\u3002\n\n[CF1615D X(or)-mas Tree](https://www.luogu.com.cn/problem/CF1615D)\n\n$\\text{Solution:}$\n\n\u9996\u5148\u6211\u4eec\u5c1d\u8bd5\u53d1\u73b0\u6027\u8d28\u3002\u4ee5\u4e0b\u662f\u5199\u7684\u65f6\u5019\u53d1\u73b0\u7684\uff1a\n\n\u4ee5\u4e0b\u4ee4 $pc(a)=popcount(a),$ \u6027\u8d28\u4e8c\u4ee5\u53ca\u540e\u9762\u90fd\u76f4\u63a5\u8ba9\u5b83\u5bf9 $2$ \u53d6\u6a21\u4e86\u3002\n\n* \u82e5 $pc(a)\\equiv pc(b)(\\bmod 2),pc(a\\text{ xor }b)=0(\\bmod 2)$\n\n* \u82e5 $pc(a)\\not = pc(b),pc(a\\text{ xor }b)=1$\n\n\u4ee5\u53ca\uff0c\u6709\u4e00\u4e2a\u81ea\u7136\u7684\u8054\u60f3\uff1a\u8fd9\u662f\u5f02\u6216\uff0c\u6240\u4ee5\u4e24\u70b9\u8def\u5f84\u7684 $\\text{xor}$ \u5b9e\u9645\u5c31\u662f\u4ece\u6839\u5230\u8fd9\u4e2a\u70b9\u7684 $\\text{prexor}$ \u7684\u5f02\u6216\u503c\u3002\n\n\u6240\u4ee5\u6211\u4eec\u4e0d\u59a8\u628a\u9898\u76ee\u6240\u7ed9\u7684\u9650\u5236 $(u,v,w)$ \u770b\u505a\u903b\u8f91\u63a8\u5bfc\u7684 **\u8fb9** \uff0c\u90a3\u4e48\u6211\u4eec\u6309\u7167\u9650\u5236\u5efa\u56fe\uff0c\u5728\u56fe\u4e0a\u9762\u6839\u636e\u8fb9\u6765\u5b9a\u503c\u5373\u53ef\u3002\n\n\u987a\u4fbf\u4e00\u53e5\uff0c\u6211\u4eec\u5176\u5b9e\u53ef\u4ee5\u53d1\u73b0\u6784\u9020\u53ea\u9700\u8981\u7528\u5230 $0/1$\n\n\u6ce8\u610f\u8981\u7528\u5230\u539f\u56fe\u7684\u8fb9\u3002$(u,v,w)\\to pc(p[u]\\text{ xor }p[v])=w$ \u90fd\u52a0\u4e0a\u53bb\u3002\n\n\u90a3\u4e48\u65e0\u89e3\u7684\u6761\u4ef6\u5c31\u662f\u903b\u8f91\u5b9a\u503c\u7684\u65f6\u5019\u51b2\u7a81\u3002\u968f\u4fbf\u5224\u65ad\u4e00\u4e0b\u5373\u53ef\u3002\n\n\u7136\u540e\u6211\u4eec\u8fd8\u8981\u5728\u539f\u6811\u4e0a\u8dd1\u4e00\u8fb9\u907f\u514d\u89e3\u4e0d\u5408\u6cd5\u3002\n\n\u6700\u540e\u8f93\u51fa\u5373\u53ef\u3002\u8fd9\u91cc\u5b9a\u8fb9\u7528\u4e86 ```map,``` \u5b9e\u9645\u4e0a\u53ef\u4ee5\u4e0d\u5e26\u8fd9\u4e2a $\\log.$\n\n\u6211\u7684\u4ee3\u7801\u590d\u6742\u5ea6\u662f $O(n\\log n).$\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef double db;\n#define int long long\n#define fi first\n#define se second\n#define mk make_pair\n#define pb emplace_back\n#define poly vector<int>\n#define Bt(a) bitset<a>\n#define bc __builtin_popcount\n#define pc putchar\n#define ci const int&\nconst int mod = 1e9 + 7;\nconst db eps = 1e-10;\nconst int inf = (1 << 30);\ninline int Max(ci x, ci y) {return x > y ? x : y;}\ninline int Min(ci x, ci y) {return x < y ? x : y;}\ninline db Max(db x, db y) {return x - y > eps ? x : y;}\ninline db Min(db x, db y) {return x - y < eps ? x : y;}\ninline int Add(ci x, ci y, ci M = mod) {return (x + y) % M;}\ninline int Mul(ci x, ci y, ci M = mod) {return 1ll * x * y % M;}\ninline int Dec(ci x, ci y, ci M = mod) {return (x - y + M) % M;}\ntypedef pair<int, int> pii;\ninline int Abs(int x) {return x < 0 ? -x : x;}\n//char buf[1<<21],*p1=buf,*p2=buf;\n//#define getchar() (p1==p2&&(p2=(p1=buf)+fread(buf,1,1<<21,stdin),p1==p2)?EOF:*p1++)\nchar Obuf[105000],*O=Obuf;//Siz shoule be the size of Out File\nint pst[30],ptop;\ninline void Fprint(){fwrite(Obuf,1,O-Obuf,stdout);}\ninline void Fwrite(int x){\n  if(x==0){*O++='0';return;}\n  if(x<0)*O++='-',x=-x;ptop=0;\n  while(x)pst[++ptop]=x%10,x/=10;\n  while(ptop)*O++=pst[ptop--]+'0';\n  if(O-Obuf>100000)Fprint(),O=Obuf;\n}\ninline int read() {\n    int s = 0, w = 1;\n    char ch = getchar();\n    while (!isdigit(ch)) {if (ch == '-') w = -1;ch = getchar();}\n    while (isdigit(ch)) {s = s * 10 + ch - '0';ch = getchar();}\n    return s * w;\n}\ninline void write(int x) {\n    if (x < 0)putchar('-'), x = -x;\n    if (x > 9)write(x / 10);\n\tpc(x % 10 + '0');\n}\ninline int qpow(int x, int y) {\n    int res = 1;\n    while (y) {if (y & 1)res = Mul(res, x);x = Mul(x, x);y >>= 1;}\n    return res;\n}\ninline void cadd(int &x, int y) {x += y;}\ninline void cmul(int &x, int y) {x *= y;}\ninline void cmax(int &x, int y) {x = Max(x, y);}\ninline void cmin(int &x, int y) {x = Min(x, y);}\nconst int N = 2e6 + 10;\nnamespace Refined_heart{\n\tint T,head[N],tot,n,m;\n\tstruct E{int nxt,to,dis;}e[N],Eg[N];\n\tinline void link(int x,int y,int v){\n\t\te[++tot]=(E){head[x],y,v};\n\t\thead[x]=tot;\n\t}\n\tint TOT=1,Head[N];\n\tinline void linktr(int u,int v,int w){\n\t\tEg[++TOT]=(E){Head[u],v,w};\n\t\tHead[u]=TOT;\n\t}\n\tstruct Node{int u,v,w;};\n\tvector<Node> eg;\n\tint val[N],vis[N];\n\tint Tg=0;\n\tvoid dfs(int x,int fa,int v){\n\t\tif(Tg)return;\n\t\tvis[x]++;\n\t\tif(val[x]!=-1&&val[x]!=v){\n\t\t\tTg=1;\n\t\t\treturn;\n\t\t}\n\t\tval[x]=v;\n\t\tfor(int i=head[x];i;i=e[i].nxt){\n\t\t\tint j=e[i].to;\n\t\t\tif(j==fa)continue;\n\t\t\tif(val[j]==(v^e[i].dis))continue;\n\t\t\tdfs(j,x,v^e[i].dis);\n\t\t}\n\t}\n\tmap<int,int>edge[N];\n\tint tag[N];\n\tvoid dfs2(int x,int fa){\n\t\tfor(int i=Head[x];i;i=Eg[i].nxt){\n\t\t\tint j=Eg[i].to;\n\t\t\tif(j==fa)continue;\n\t\t\tint vl=val[j]^val[x];\n\t\t\tvl=bc(vl);vl&=1;\n\t\t\tif(vl)edge[j][x]=edge[x][j]=1;\n\t\t\telse edge[j][x]=edge[x][j]=0;\n\t\t\tdfs2(j,x);\n\t\t}\n\t}\n\tbool check(int x,int fa,int prev){\n\t\tint fg=1;\n\t\tfor(int i=Head[x];i;i=Eg[i].nxt){\n\t\t\tint j=Eg[i].to;\n\t\t\tif(j==fa)continue;\n\t\t\tint vl=(Eg[i].dis==-1?edge[x][j]:Eg[i].dis)^prev;\n\t\t\tvl=bc(vl);vl&=1;\n\t\t\tif(vl!=val[j]){\n\t\t\t\tfg=0;\n\t\t\t\treturn fg;\n\t\t\t}\n\t\t\tfg&=check(j,x,prev^(Eg[i].dis==-1?edge[x][j]:Eg[i].dis));\n\t\t}\n\t\treturn fg;\n\t}\n\tvoid clear(){\n\t\tTOT=1,tot=0;eg.clear();Tg=0;\n\t\tfor(int i=1;i<=n;++i)Head[i]=head[i]=vis[i]=0,val[i]=-1;\n\t\tfor(int i=1;i<=n;++i){edge[i].clear();}\n\t}\n\tvoid work(){\n\t\tclear();\n//\t\tif(T==1){\n//\t\t\tint a=0;\n//\t\t\tint b=1;\n//\t\t\tassert(a>b);\n//\t\t}\n\t\tn=read();m=read();\n\t\tfor(int i=1;i<n;++i){\n\t\t\tint u=read(),v=read(),w=read();\n\t\t\tlinktr(u,v,w);linktr(v,u,w);\n\t\t\teg.pb((Node){u,v,w});\n\t\t\tif(w==-1)continue;\n\t\t\tlink(u,v,bc(w)&1);\n\t\t\tlink(v,u,bc(w)&1);\n\t\t}\n\t\tfor(int i=1;i<=m;++i){\n\t\t\tint u=read(),v=read(),w=read();\n\t\t\tlink(u,v,w);link(v,u,w);\n\t\t}\n\t\tfor(int i=1;i<=n;++i)val[i]=-1;\n\t\t\n\t\tfor(int i=1;i<=n;++i){\n\t\t\tif(!vis[i]){\n\t\t\t\tval[i]=0;\n\t\t\t\tdfs(i,0,0);\n\t\t\t}\n\t\t}\n\t\tif(Tg){\n\t\t\tputs(\"NO\");\n\t\t\treturn;\n\t\t}\n\t\t\n\t\tdfs2(1,0);\n\t\tint fg=check(1,0,0);\n\t\tif(!fg){\n\t\t\tputs(\"NO\");\n\t\t\treturn;\n\t\t}\n\t\tputs(\"YES\");\n\t\tfor(auto vv:eg){\n\t\t\tint u=vv.u;\n\t\t\tint v=vv.v;\n\t\t\tint w=vv.w;\n\t\t\tif(w==-1)w=edge[u][v];\n\t\t\tprintf(\"%lld %lld %lld\\n\",u,v,w);\n\t\t}\n\t\treturn;\n\t}\n\tvoid solve(){\n\t\tT=read();int Z=T;\n\t\twhile(Z--)work();\n\t}\n}\nsigned main(){\n\tfreopen(\"in.txt\",\"r\",stdin);\n\tRefined_heart::solve();\n\treturn 0;\n}\n\n\n```\n",
        "postTime": 1643354081,
        "uid": 128591,
        "name": "Refined_heart",
        "ccfLevel": 9,
        "title": "CF1615D X(or)-mas Tree \u9898\u89e3"
    },
    {
        "content": "\u548c E \u4e00\u6837\u4e5f\u662f\u5999\u5999\u9898\n\n#### \u5206\u6790\uff1a\n\n\u672c\u9898\u6bd2\u7624\u5728\u4e24\u5904\uff1a\n\n- \u4e24\u70b9\u8def\u5f84\u5f02\u6216\u548c\n\n- popcount\n\n\u5bf9\u4e8e\u7b2c\u4e00\u4e2a\uff0c\u6211\u4eec\u77e5\u9053\u8bbe $d(u)$ \u8868\u793a $u$ \u5230\u6839\u7684\u5f02\u6216\u548c\uff0c\u7531\u4e8e\u5f02\u6216\u7684\u826f\u597d\u6027\u8d28 $u,v$ \u8def\u5f84\u7684\u5f02\u6216\u548c\u7b49\u4e8e $d(u)\\oplus d(v)$\uff0c\u8fd9\u6837\u6211\u4eec\u628a\u4e00\u8fde\u4e32\u6570\u5f02\u6216\u8f6c\u6210\u4e86\u4e24\u4e2a\u6570\u5f02\u6216\u3002\n\n\u65e2\u7136\u6211\u4eec\u7528\u4e86 $d$\uff0c\u6211\u4eec\u5c31\u76f4\u63a5\u6784\u9020 $d$\uff0c\u6700\u540e\u6839\u636e $d(fa)$ \u548c $d(u)$ \u5c31\u53ef\u4ee5\u786e\u5b9a $fa\\Leftrightarrow u$ \u8fd9\u6761\u8fb9\u7684\u6743\u503c\u3002\n\n\u4f46\u662f\u6b64\u65f6\u6211\u4eec\u8fd8\u6ca1\u89e3\u51b3 popcount \u7684\u95ee\u9898\u3002\u6ce8\u610f\u8fd9\u91cc\u53ea\u5173\u6ce8\u5176\u5947\u5076\u6027\uff0c\u5173\u952e\u6027\u7684\u7ed3\u8bba\u662f\uff1a\n\n$$count(x\\oplus y)\\equiv count(x)+ count(y)(\\bmod\\,2)$$\n\n\u8fd9\u4e2a\u7ed3\u8bba\u8fd8\u662f\u633a\u5e38\u89c1\u7684\uff0c\u5982\u679c\u4f60\u6ca1\u4e86\u89e3\u8fc7\u5f88\u53ef\u80fd\u505a\u4e0d\u51fa\uff08\u6bd4\u5982\u6211www\uff09\u3002\n\n\u5982\u679c\u4f60\u6ca1\u5b66\u8fc7\uff0c\u6211\u4eec\u6765\u8bc1\u660e\u4e00\u4e0b\uff1a\n\n\u6211\u4eec\u4efb\u9009 $x,y$ \u7684\u67d0\u4e00\u4f4d\uff0c\u5f53\u5176\u4e3a $0,0$ \u7684\u65f6\u5019\uff0c\u5728\u5de6\u8fb9\u7684\u5f0f\u5b50\u91cc\u6ca1\u6709\u8d21\u732e\uff0c\u53f3\u8fb9\u6ca1\u6709\u8d21\u732e\uff1b\u5f53\u5176\u4e3a $1,1$ \u7684\u65f6\u5019\uff0c\u5728\u5de6\u8fb9\u6ca1\u6709\u8d21\u732e\uff0c\u53f3\u8fb9\u8d21\u732e $2$\uff1b\u5f53\u5176\u4e3a $0,1$\uff08\u6216 $1,0$\uff09\u7684\u65f6\u5019\uff0c\u5728\u5de6\u8fb9\u8d21\u732e $1$\uff0c\u53f3\u8fb9\u8d21\u732e $1$\u3002\u6240\u4ee5\u5728\u6a21 $2$ \u610f\u4e49\u4e0b\u5de6\u53f3\u76f8\u7b49\uff0c\u800c\u6a21 $2$ \u610f\u4e49\u5176\u5b9e\u5c31\u7b49\u4ef7\u4e8e\u5947\u5076\u6027\uff01\n\n\u5982\u679c\u6211\u4eec\u4ee4 $count$ \u7684\u5b9a\u4e49\u6539\u4e3a\u4f4d\u6570\u7684\u5947\u5076\u6027\uff0c\u5219\u6839\u636e\u4e0a\u9762\u5f97\u51fa\uff1a\n\n$$count(x\\oplus y)=count(x)\\oplus count(y)$$\n\n\u4f60\u53d1\u73b0\u5176\u5b9e\u4e0a\u9762\u7684\u90a3\u4e2a $d$ \u53ef\u4ee5\u76f4\u63a5\u6539\u4e3a $count$\uff0c\u8fd9\u6837\uff0c\u4e0d\u7ba1\u662f\u521d\u59cb\u7ed9\u7684\u8fb9\uff0c\u8fd8\u662f\u9898\u76ee\u91cc\u7684 $m$ \u4e2a\u9650\u5236\uff0c\u90fd\u662f\u518d\u7ed9\u4f60\u4e24\u4e2a\u70b9 $u,v$\uff0c\u4f7f\u5f97 $count(u)$ \u548c $count(v)$ \u7684\u503c\u5fc5\u987b\u76f8\u540c/\u4e0d\u540c\u3002\n\n\u8fd9\u662f\u4e00\u4e2a\u7ecf\u5178\u7684\u5e26\u6743\u5e76\u67e5\u96c6\u6a21\u578b\uff0c\u53ef\u4ee5\u6784\u9020\u51fa\u4e00\u7ec4\u5408\u6cd5\u7684 $count$ \u6765\uff0c\u6709\u4e86 $count$\uff0c\u5c31\u53ef\u4ee5\u8fd8\u539f\u51fa\u6240\u6709\u7684\u8fb9\u6743\u4e86\uff0c\u6709\u610f\u601d\u7684\u662f\u6211\u4eec\u53d1\u73b0\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u53ea\u586b $0/1$ \u6765\u6784\u9020\u65b9\u6848\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(int i=(a);i<=(b);i++)\n#define per(i,a,b) for(int i=(a);i>=(b);i--)\n#define op(x) ((x&1)?x+1:x-1)\n#define odd(x) (x&1)\n#define even(x) (!odd(x))\n#define lc(x) (x<<1)\n#define rc(x) (lc(x)|1)\n#define lowbit(x) (x&-x)\n#define Max(a,b) (a>b?a:b)\n#define Min(a,b) (a<b?a:b)\n#define next Cry_For_theMoon\n#define il inline\n#define pb(x) push_back(x)\n#define is(x) insert(x)\n#define sit set<int>::iterator\n#define mapit map<int,int>::iterator\n#define pi pair<int,int>\n#define ppi pair<int,pi>\n#define pp pair<pi,pi>\n#define fr first\n#define se second\n#define vit vector<int>::iterator\n#define mp(x,y) make_pair(x,y)\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef unsigned int uint;\ntypedef double db;\nusing namespace std;\nconst int MAXN=2e5+10;\nint T,n,m,u,v,w;\nint fa[MAXN],dsu[MAXN],dis[MAXN];\nmap<pi,int>f;\nvector<int>e[MAXN];\nint Find(int x){\n\tif(dsu[x]==x)return x;\n\tint tmp=dsu[x];dsu[x]=Find(tmp);dis[x]^=dis[tmp];return dsu[x]; \n}\nvoid dfs(int u){\n\tfor(auto v:e[u]){\n\t\tif(v==fa[u])continue;\n\t\tfa[v]=u;dfs(v);\n\t}\n}\nvoid solve(){\n\tscanf(\"%d%d\",&n,&m);\n\tf.clear();rep(i,1,n){\n\t\te[i].clear();\n\t\tfa[i]=0;\n\t\tdsu[i]=i;dis[i]=0;\n\t}\n\trep(i,1,n-1){\n\t\tscanf(\"%d%d%d\",&u,&v,&w);\n\t\te[u].pb(v);e[v].pb(u);\n\t\tif(w!=-1)f[mp(u,v)]=f[mp(v,u)]=w;\n\t}\n\tdfs(1);\n\tint flag=0;\n\tfor(auto tmp:f){\n\t\tint u=tmp.fr.fr,v=tmp.fr.se,w=tmp.se;\n\t\tw=__builtin_popcount(w)&1;\n\t\tint a=Find(u),b=Find(v);\n\t\tif(a==b){\n\t\t\tif((dis[u]^dis[v])!=w){\n\t\t\t\tflag=1;\n\t\t\t}\n\t\t}else{\n\t\t\tdis[a]=dis[u]^dis[v]^w;\n\t\t\tdsu[a]=b;\n\t\t}\n\t}\n\trep(i,1,m){\n\t\tscanf(\"%d%d%d\",&u,&v,&w);\n\t\tint a=Find(u),b=Find(v);\n\t\tif(a==b){\n\t\t\tif((dis[u]^dis[v])!=w){\n\t\t\t\tflag=1;\n\t\t\t}\n\t\t}else{\n\t\t\tdis[a]=dis[u]^dis[v]^w;\n\t\t\tdsu[a]=b;\n\t\t}\n\t}\n\tif(flag){printf(\"NO\\n\");return;}\n\tprintf(\"YES\\n\");\n\trep(i,2,n){\n\t\tif(f.find(mp(i,fa[i]))!=f.end()){\n\t\t\tprintf(\"%d %d %d\\n\",i,fa[i],f[mp(i,fa[i])]);\n\t\t}else{\n\t\t\tint a=Find(i),b=Find(fa[i]);\n\t\t\tint vala=dis[i],valb=dis[fa[i]];\n\t\t\tprintf(\"%d %d %d\\n\",i,fa[i],vala^valb);\n\t\t}\n\t}\n}\nint main(){\n\tscanf(\"%d\",&T);\n\twhile(T--){\n\t\tsolve();\n\t}\n\n\treturn 0;\n}\n```",
        "postTime": 1640614204,
        "uid": 340632,
        "name": "Cry_For_theMoon",
        "ccfLevel": 8,
        "title": "\u3010CF1615D\u3011X(or)-mas Tree"
    },
    {
        "content": "\u9996\u5148\u6839\u636e\u5f02\u6216\u7684\u6027\u8d28\u5bb9\u6613\u53d1\u73b0\uff0c\u82e5\u5e72\u4e2a\u6570\u5f02\u6216\u7684 popcount \u662f\u5947\u662f\u5076\u7b49\u540c\u4e8e\u6bcf\u4e2a\u6570 popcount \u7684\u5947\u5076\u5f02\u6216\u8d77\u6765\u3002\u56e0\u6b64\u6bcf\u6761\u8fb9\u53ef\u4ee5\u7b49\u6548\u4e8e $0$ \u548c $1$\u3002\n\n\u6211\u4eec\u8fdb\u884c\u6811\u4e0a\u5dee\u5206\uff0c\u5bf9\u6bcf\u4e2a\u70b9\u8ba1\u7b97\u4e00\u4e2a $dis_i$ \u8868\u793a\u4ece\u6839\u5230\u8282\u70b9 $i$ \u7684\u8def\u5f84\u4e0a\u7684\u5f02\u6216\u548c\u3002\u90a3\u4e48\u5bf9\u4e8e\u6bcf\u4e2a\u6761\u4ef6\u53ef\u4ee5\u8f6c\u5316\u4e3a $dis_u \\text{ xor } dis_v =w$\u3002\n\n\u5bf9\u4e8e\u6811\u4e0a\u539f\u6709\u7684\u8fb9\uff0c\u4e5f\u53ef\u4ee5\u8fdb\u884c\u76f8\u540c\u7684\u8f6c\u5316\u3002\u56e0\u6b64\u95ee\u9898\u53d8\u6210\u5f88\u7ecf\u5178\u7684\u9898\u76ee\u4e86\u3002\u82e5\u5e72 $01$ \u53d8\u91cf\u82e5\u5e72\u6761\u4ef6\uff0c\u6bcf\u4e2a\u6761\u4ef6\u662f\u5176\u4e2d\u4e24\u4e2a\u53d8\u91cf\u7684\u5f02\u6216\uff0c\u6c42\u4e00\u7ec4\u6784\u9020\u3002\n\n\u4f60\u53ef\u4ee5\u4f7f\u7528\u4e8c\u5206\u56fe\u7b49\u65b9\u5f0f\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u6211\u9009\u62e9\u7684\u662f\u79cd\u7c7b\u5e76\u67e5\u96c6\uff0c\u7c7b\u4f3c\u4e8e [[NOI2001] \u98df\u7269\u94fe](https://www.luogu.com.cn/problem/P2024) \u7684\u505a\u6cd5\u3002\n\n```cpp\nint fa[N];\nvector<int>t[N],v[N];\nint find(int x)\n{\n\tif (x==fa[x]) return fa[x];\n\treturn fa[x]=find(fa[x]);\n}\nint wq[N];\nbool ans;\ninline int wr(int z)\n{\n\tint res=0;\n\twhile (z)\n\t{\n\t\tif (z&1) res^=1;\n\t\tz>>=1;\n\t}\n\treturn res;\n}\nvoid merge(int x,int y)\n{\n\tx=find(x),y=find(y);\n\tif (x==y) return;\n\tfa[x]=y;\n}\nvoid ddd(int x,int y,int z)\n{\n\tif (z==0) \n\t{\n\t\tif (find(x+n)==find(y)||find(y+n)==find(x))\n\t\t{\n\t\t\tans=1;\n\t\t\treturn;\n\t\t}\n\t\tmerge(x,y),merge(x+n,y+n);\n\t}\n\telse\n\t{\n\t\tif (find(x)==find(y)||find(y+n)==find(x+n))\n\t\t{\n\t\t\tans=1;\n\t\t\treturn;\n\t\t}\n\t\tmerge(x,y+n),merge(y,x+n);\n\t}\n}\nvoid dfs(int x,int f,int vv)\n{\n\tif (x==1) a[x]=0,wq[find(1)]=0,wq[find(1+n)]=1;\n\telse \n\t{\n\t\tif (wq[find(x)]==-1) \n\t\t{\n\t\t\ta[x]=0;\n\t\t\twq[find(x)]=0,wq[find(x+n)]=1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\ta[x]=wq[find(x)];\n\t\t}\n\t\tif (vv!=-1) printf(\"%d %d %d\\n\",x,f,vv);\n\t\telse printf(\"%d %d %d\\n\",x,f,(a[x]^a[f]));\n\t}\n\tfor (int i=0;i<t[x].size();i++)\n\t{\n\t\tif (t[x][i]==f) continue;\n\t\tdfs(t[x][i],x,v[x][i]);\n\t}\n}\nvoid work()\n{\n\tn=read(),m=read(),ans=0;\n\tfor (int i=1;i<=2*n;i++) fa[i]=i,wq[i]=-1;\n\tfor (int i=1;i<=n;i++) t[i].clear();\n\tfor (int i=1;i<=n;i++) v[i].clear();\n\tfor (int i=1;i<n;i++)\n\t{\n\t\tint x=read(),y=read(),z=read();\n\t\tt[x].push_back(y),t[y].push_back(x);\n\t\tv[x].push_back(z),v[y].push_back(z);\n\t\tif (z!=-1) ddd(x,y,wr(z));\n\t}\n\tfor (int i=1;i<=m;i++)\n\t{\n\t\tint x=read(),y=read(),z=read();\n\t\tddd(x,y,z);\n\t}\n\tif (ans==1)\n\t{\n\t\tprintNO;\n\t\treturn;\n\t}\n\ta[1]=0;\n\tprintYES;\n\tdfs(1,-1,-1);\n\treturn;\n}\n\nint main()\n{\n\tint T=read();\n\twhile (T--) work();\n\treturn 0;\n}\n\n```\n",
        "postTime": 1640612129,
        "uid": 151475,
        "name": "Little09",
        "ccfLevel": 8,
        "title": "CF1615D X(or)-mas Tree"
    },
    {
        "content": "\u5199\u4e2a\u8be6\u7ec6\u70b9\u7684\u9898\u89e3\u3002\n\n## Description\n\u7ed9\u5b9a\u4e00\u68f5 $n$ \u4e2a\u8282\u70b9\u7684\u6811\uff0c\u5176\u4e2d\u67d0\u4e9b\u8fb9\u6743\u5c1a\u672a\u786e\u5b9a\u3002\u8981\u6c42\u4f60\u6839\u636e\u5982\u4e0b\u7684 $m$ \u6761\u9650\u5236\u786e\u5b9a\u6240\u6709\u7684\u8fb9\u6743\uff1a\n\n- \u6bcf\u4e2a\u9650\u5236\u5f62\u5982 $(a, b, c)$\uff0c\u610f\u5473\u7740\u4ece $a$ \u5230 $b$ \u7684\u8def\u5f84\u4e0a\u7684\u6240\u6709\u8fb9\u6743\u7684\u5f02\u6216\u548c $S$ \u5728\u4e8c\u8fdb\u5236\u7684\u8868\u793a\u4e0b\u7684\u4f4d\u6570\u6ee1\u8db3 $\\operatorname{popcount}(S) \\bmod 2 = c$\u3002\n\n$n,m\\le 2\\times 10^5$\n\n## Solution\n\n\u5b9a\u4e49 $\\operatorname{parity}(x)$ \u8868\u793a $\\operatorname{popcount}(x)\\bmod 2$\uff0c\u5219\u6211\u4eec\u53ef\u4ee5\u77e5\u9053 $\\operatorname{parity}(x\\oplus y) = \\operatorname{parity}(x)\\oplus \\operatorname{parity}(y)$\u3002\u6240\u4ee5\u5e72\u8106\u76f4\u63a5\u5148\u5c06\u6811\u4e0a\u7684\u6240\u6709\u8fb9\u6743 $d$ \u5148\u53d8\u6210 $\\operatorname{parity}(d)$\u3002\n\n\u4ee4\u6811\u4e0a\u524d\u7f00\u5f02\u6216\u548c\uff08\u4ece\u6839\u5230 $u$ \u7684\u8def\u5f84\u4e0a\u7684\u5f02\u6216\u548c\uff09\u4e3a $r_u$\uff0c\u5219\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u7531\u5f02\u6216\u7684\u6d88\u53bb\u5f8b\uff0c$(a,b)$ \u8def\u5f84\u7684\u5f02\u6216\u548c\u4e3a $r_a\\oplus r_b$\u3002\u6240\u4ee5\u6211\u4eec\u73b0\u5728\u5c31\u6709\u4e86\u82e5\u5e72\u6761\u5f62\u5982 $r_a\\oplus r_b = c$ \u7684\u9650\u5236\uff08\u5bf9\u4e8e\u6811\u4e0a\u5df2\u6709\u7684\u8fb9 $(u,v, x)$ \u53ef\u4ee5\u770b\u4f5c\u662f $r_u\\oplus r_v = x$\uff09\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u9650\u5236 $r_a\\oplus r_b = c$\uff0c\u5728\u65b0\u56fe\u4e0a\u5efa\u4e00\u6761\u8fb9 $(a, b, c)$\uff0c\u7136\u540e\u8003\u8651\u4e8c\u5206\u56fe\u67d3\u8272\uff08\u4e00\u5f00\u59cb\u94a6\u5b9a\u4e00\u4e2a $r_i = 0$\uff0c\u7136\u540e\u8fdb\u884c dfs\uff09\uff0c\u8fd9\u6837\u5b50\u5c31\u53ef\u4ee5\u6c42\u51fa\u6240\u6709\u7684 $r_u$\u3002\u5728 dfs \u7684\u8fc7\u7a0b\u4e2d\u82e5\u9047\u5230\u77db\u76fe\u5219\u8bf4\u660e\u5bc4\u4e86\uff0c\u7279\u5224\u4e00\u4e0b\u5373\u53ef\u3002\n\n## Implementation\n```cpp\nconst int maxn = 2e5 + 5;\nint r[maxn], vis[maxn], n, m, flag;\nstruct edge {\n    int to, w;\n    edge(int v, int d) : to(v), w(d) {}\n};\nvector<edge> G[maxn], G1[maxn];\n\nil int parity(int n) {return __builtin_popcount(n) & 1;}\n\nvoid dfs1(int u, int val) {\n    vis[u] = 1, r[u] = val;\n    for (auto &e : G1[u]) {\n        int v = e.to, w = e.w;\n        if (vis[v] && (w ^ val) != r[v]) flag = 1;\n        if (!vis[v]) dfs1(v, val ^ w);\n    }\n    return;\n}\n\nvoid dfs2(int u, int fa) {\n    for (auto &e : G[u]) {\n        int v = e.to, w = e.w;\n        if (v == fa) continue;\n        print(v, u, w == -1 ? r[u] ^ r[v] : w);\n        dfs2(v, u);\n    }\n    return;\n}\n\nint main() {\n    int T; read(T);\n    while (T--) {\n        read(n, m);\n        flag = 0;\n        FOR(i, 1, n) r[i] = vis[i] = 0, G[i].clear(), G1[i].clear();\n        FOR(i, 1, n - 1) {\n            int a, b, c; read(a, b, c);\n            G[a].push_back(edge(b, c));\n            G[b].push_back(edge(a, c));\n            if (c == -1) continue;\n            G1[a].push_back(edge(b, parity(c)));\n            G1[b].push_back(edge(a, parity(c)));\n        }\n        FOR(i, 1, m) {\n            int a, b, c; read(a, b, c);\n            G1[a].push_back(edge(b, c));\n            G1[b].push_back(edge(a, c));\n        }\n        FOR(i, 1, n) if (!vis[i]) dfs1(i, 0);\n        if (flag) print(\"NO\");\n        else {\n            print(\"YES\");\n            dfs2(1, 0);\n        }\n    }\n    return output(), 0;\n}\n```",
        "postTime": 1640500646,
        "uid": 212488,
        "name": "\u6e05\u70db",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1615D X(or)-mas Tree"
    },
    {
        "content": "\u9996\u5148\u662f\u505a\u8fd9\u9053\u9898\u7684\u4e00\u4e2a\u91cd\u8981\u5f0f\u5b50:\n\t\n$$ (x \\oplus y)\\mod 2 = (x \\mod 2) \\oplus (y\\mod2)$$ \n\n\u7136\u540e\u518d\u539f\u56fe\u7684\u57fa\u7840\u4e0a\u5efa\u4e00\u5f20\u65b0\u56fe,\u8868\u793a\u70b9\u4e4b\u95f4\u7684\u5f02\u6216\u5173\u7cfb,\u5df2\u786e\u5b9a\u7684\u8fb9\u4e5f\u53ef\u4ee5\u52a0\u8fdb\u53bb\u3002\n\n\u4ee4$val[i]$\u4e3a$i$\u4e0e\u5176\u7236\u4eb2\u8fb9\u7684\u503c\u3002\u4ee4$val[root]=0$\uff0c\u7136\u540e\u5728\u65b0\u56fe\u4e0a\u8dd1dfs,\u6c42\u51fa\u6240\u6709\u7684\u503c\uff0c\u518d\u5c06\u539f\u6765\u7684\u56fe\u4e0a\u8fb9\u4e0a\u7684\u503c\u4ee3\u5165\u5373\u53ef\u3002\n\n\u6ce8\u610f\u7279\u5224\u77db\u76fe\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define fir first\n#define sec second\nusing namespace std;\nconst int maxn=2e5+10;\nvector< pair<int,int> > X[maxn],G[maxn];\nint T,n,m;\nbool vis[maxn],flag;\nint sta[maxn],ans[maxn];\nvoid xorval(int u,int val)\n{\n\tvis[u]=1;sta[u]=val;\n\tfor(auto cur : X[u])\n\t{\n\t\tint v=cur.fir,w=cur.sec;\n\t\tif(vis[v]&&w^val!=sta[v])flag=1;\n\t\tif(!vis[v])xorval(v,w^val);\n\t}\n}\nvoid dfs(int u,int fa)\n{\n\tfor(auto cur : G[u])\n\t{\n\t\tint v=cur.fir,w=cur.sec;\n\t\tif(v==fa)continue;\n\t\tans[v]=(w==-1?sta[u]^sta[v]:w);\n\t\tprintf(\"%d %d %d\\n\",v,u,ans[v]);\n\t\tdfs(v,u);\n\t}\n}\nvoid solve()\n{\n\tscanf(\"%d%d\",&n,&m);\n\tflag=0;\n\tfor(int i=1;i<=n;i++)\n\t\tX[i].clear(),G[i].clear(),vis[i]=sta[i]=0;\n\tfor(int i=1,a,b,c,num;i<n;i++)\n\t{\n\t\tnum=0;\n\t\tscanf(\"%d%d%d\",&a,&b,&c);\n\t\tG[a].push_back({b,c});\n\t\tG[b].push_back({a,c});\n\t\tif(c==-1)continue;\n\t\tfor(int i=0;i<=30;i++)\n\t\t\tif(c&(1<<i))num++;\n\t\tX[a].push_back({b,num%2});\n\t\tX[b].push_back({a,num%2});\n\t}\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tint a,b,c;\n\t\tscanf(\"%d%d%d\",&a,&b,&c);\n\t\tX[a].push_back({b,c});\n\t\tX[b].push_back({a,c});\n\t}\n\tfor(int i=1;i<=n;i++)if(!vis[i])xorval(i,0);\n\tif(flag){puts(\"NO\");return;} \n\telse puts(\"YES\");\n\tdfs(1,0);\n}\nint main()\n{\n\tcin>>T;\n\twhile(T--)solve();\n}\n```\n",
        "postTime": 1640440568,
        "uid": 343060,
        "name": "kkio",
        "ccfLevel": 7,
        "title": "CF1615D \u9898\u89e3"
    },
    {
        "content": "### Analysis\n\n\u6211\u4eec\u8bbe\u9898\u76ee\u4e2d**\u8fb9\u6743\u6761\u4ef6\u4e3a A \u6761\u4ef6\uff0c\u8def\u5f84\u6761\u4ef6\u4e3a B \u6761\u4ef6**\u3002\n\n**\u4ee5\u4e0b ppcnt \u5747\u6307 __builtin_popcount \u51fd\u6570\uff0c\u5373\u4e8c\u8fdb\u5236\u4e0b $1$ \u7684\u4e2a\u6570\u3002$f(x)=ppcnt(x)\\mod 2$\u3002\u8bbe\u70b9 $x$ \u5230 $root$ \u7684\u8def\u5f84\u8fb9\u6743\u5f02\u6216\u548c\u4e3a $g(x)$**\n\n\u5bb9\u6613\u53d1\u73b0\u8bbe $x\\leftrightarrow y$ \u7684\u8def\u5f84\u5f02\u6216\u548c\u4e3a $z$\uff0c\u5219 $g(x)\\operatorname{xor}g(y)=z,f(g(x))\\operatorname{xor}f(g(y))=f(z)$\uff08\u8bfb\u8005\u81ea\u8bc1\uff09\u3002\n\n\u56e0\u4e3a B \u6761\u4ef6\u53ea\u548c\u5f02\u6216\u548c\u7684 $f$ \u6709\u5173\uff0c\u6240\u4ee5\u8fb9\u6743\u7684\u5177\u4f53\u6570\u503c\u6839\u672c\u6ca1\u7528\uff08\u9664\u4e86\u6700\u540e\u7684\u6784\u9020\uff09\uff0c\u5bf9\u4e8e\u4e00\u6761\u5df2\u77e5\u7684\u8fb9\u6743 $x$\uff0c\u6211\u4eec\u5b58 $f(x)$ \u5373\u53ef\u3002\u5c31\u662f\u8bf4 **A \u6761\u4ef6\u5747\u53ef\u8f6c\u6362\u6210 B \u6761\u4ef6**\u3002\n\n\u6211\u4eec\u5f88\u5bb9\u6613\u60f3\u5230 NO \u7684\u65b9\u6848\uff0c\u5c31\u662f\u4e00\u7cfb\u5217\u6761\u4ef6\u63a8\u51fa\u4e24\u4e2a\u70b9 $x,y$ \u7684 $f(g(x))$ \u4e0e $f(g(y))$ \u65e2\u76f8\u540c\u53c8\u4e0d\u540c\uff0c\u81ea\u76f8\u77db\u76fe\u3002\n\n\u53d1\u73b0\u8fd9\u53ef\u4ee5\u7528**\u5e26\u8fb9\u6743\u7684\u5e76\u67e5\u96c6**\u7ef4\u62a4\uff0c\u5e76\u67e5\u96c6\u7684\u8fb9 $(x,y)$ \u8fb9\u6743\u8868\u793a\u70b9 $x,y$ \u7684 $f(g(x)),f(g(y))$ \u662f\uff08$0$\uff09\u5426\uff08$1$\uff09\u76f8\u540c\u3002\n\n\u6700\u540e\uff0c\u5982\u679c\u5224\u5b9a\u4e3a YES\uff08\u5373\u5728\u5e76\u67e5\u96c6\u7684\u8fc7\u7a0b\u4e2d\u6ca1\u6709\u77db\u76fe\uff09\uff0c\u5219\u8fd9\u6837\u6784\u9020\u8fb9\u6743\u521d\u59cb\u4e3a $-1$ \u7684\u8fb9\uff1a\n\n* \u5982\u679c\u8fd9\u6761\u8fb9\u4e24\u7aef $x,y$ \u5728\u540c\u4e00\u4e2a\u5e76\u67e5\u96c6\u5185\uff0c\u5219\u8fb9\u6743\u8bbe\u4e3a $f(g(x))\\ !=f(g(y))$\uff08bool \u7c7b\u578b\uff09\n\n* \u5426\u5219\uff0c\u8fb9\u6743\u4efb\u610f\uff08\u56e0\u4e3a\u4e24\u8005\u7684\u5173\u7cfb\u73b0\u5728\u4e0d\u660e\u786e\uff09\uff0c\u518d\u5c06\u8fd9\u4e24\u4e2a\u5e76\u67e5\u96c6\u5408\u5e76\u5373\u53ef\u3002\n\n### Code\n\n```cpp\nint n,m;\nint f[N],g[N];\nstruct node{int x,y,val;};\nvector<node> v,inp;\ninline int gf(int x){//get father in dsu\n\tif(x==f[x]) return x;\n\tint tmp=gf(f[x]);\n\tg[x]^=g[f[x]];\n\treturn f[x]=tmp;\n}\ninline void mou(int x){//make root in dsu\n\tint tmp=gf(x);\n\tif(x==tmp) return ;\n\tf[tmp]=x;\n\tg[tmp]=g[x];\n\tg[x]=0;\n\tf[x]=x;\n}\ninline int dis(int x){//the val to the root in dsu\n\tint tmp=gf(x);\n\tif(x==tmp) return 0;\n\treturn g[x];\n}\nint calc(int x,int y){\n\tif(gf(x)!=gf(y)){\n\t\tmou(x);\n\t\tmou(y);\n\t\tf[x]=y;\n\t\tg[x]=0;\n\t\treturn 0;\n\t}else{\n\t\treturn dis(x)^dis(y);\n\t}\n}\nvoid work(){\n\tcin>>n>>m;\n\tv.clear();\n\tinp.clear();\n\tFor(i,1,n) f[i]=i;\n\tFor(i,1,n) g[i]=0;\n\tint x,y,z;\n\tFor(i,1,n-1){\n\t\t cin>>x>>y>>z;\n\t\t inp.pb((node){x,y,z});//for construction\n\t\t if(z>=0){\n\t\t \tv.pb((node){x,y,__builtin_popcount(z)&1});\n\t\t }\n\t}\n\tFor(i,1,m){\n\t\tcin>>x>>y>>z;\n\t\tv.pb((node){x,y,z});\n\t}\n\tfor(auto i:v){\n\t\tif(gf(i.x)!=gf(i.y)){\n\t\t\tmou(i.x);\n\t\t\tmou(i.y);\n\t\t\tf[i.x]=i.y;\n\t\t\tg[i.x]=i.val;\n\t\t}else if(dis(i.x)^dis(i.y)^i.val){\n\t\t\tcout<<\"NO\"<<endl;\n\t\t\treturn ;\n\t\t} \n\t}\n\tcout<<\"YES\"<<endl;\n\tfor(auto i:inp){\n\t\tcout<<i.x<<\" \"<<i.y<<\" \";\n\t\tif(i.val>=0) cout<<i.val<<endl;\n\t\telse cout<<calc(i.x,i.y)<<endl;\n\t}\n}\n```",
        "postTime": 1640397727,
        "uid": 101868,
        "name": "I_am_Accepted",
        "ccfLevel": 0,
        "title": "CF1615D X(or)-mas Tree"
    }
]
[
    {
        "content": "[CF1423D Does anyone else hate the wind?](https://www.luogu.com.cn/problem/CF1423D)\n\n\u53ef\u80fd\u771f\u7684\u53ea\u662f\u6ca1\u6709\u4eba\u5f00\u8fd9\u9898\u5bfc\u81f4\u5927\u5bb6\u90fd\u4e0d\u505a\uff0c\u8bc4\u5206\u865a\u9ad8\u3002~~3100\u7684BFS\u4f60\u6562\u4fe1~~\n\n\u7b80\u5355\u9898\u610f\uff1a\u6709\u4e00\u4e2a $n \\times m$ \u7684\u65b9\u683c\u56fe\uff0c\u4f60\u8981\u4ece\u8d77\u70b9\u8d70\u5411\u7ec8\u70b9\uff0c\u6709\u4e00\u4e9b\u65b9\u683c\u4e0d\u80fd\u8d70\uff0c\u6bcf\u4e2a\u65f6\u523b\u53ef\u4ee5\u90fd\u4e00\u6b65\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u79fb\u52a8\u3002\u4f60\u6700\u591a\u643a\u5e26 $k$ \u4e2a\u8865\u7ed9\uff0c\u6bcf\u8d70\u4e00\u6b65\u6d88\u8017\u4e00\u4e2a\u8865\u7ed9\uff0c\u6709 $t$ \u8865\u7ed9\u70b9\u53ea\u5728\u7ed9\u5b9a\u65f6\u523b\u3001\u5750\u6807\u51fa\u73b0\uff0c\u5230\u8fbe\u8865\u7ed9\u70b9\u5219\u8865\u6ee1\u8865\u7ed9\uff0c\u51fa\u53d1\u65f6\u6ee1\u8865\u7ed9\u3002\u7531\u4e8e\u7279\u6b8a\u7684\u539f\u56e0\uff0c\u6bcf\u4e2a\u65f6\u523b\u4f60\u53ef\u80fd\u5f3a\u5236\u79fb\u52a8\u4e00\u6b21\uff0c\u4e0d\u6d88\u8017\u8865\u7ed9\u3002\u5224\u65ad\u4e0d\u80fd\u5230\u8fbe\u6216\u8f93\u51fa\u6700\u5c0f\u5230\u8fbe\u65f6\u523b\u3002\n\n\u901a\u8fc7\u9605\u8bfb\u9898\u9762\uff0c\u80fd\u53d1\u73b0\uff1a\u5f3a\u5236\u79fb\u52a8\u5e8f\u5217\u957f\u5ea6\u3001\u8865\u7ed9\u70b9\u51fa\u73b0\u65f6\u523b\u503c\u57df\u8fd9\u4e24\u4e2a $10^6$ \u90fd\u662f\u5728\u641e\u7b11\u3002\u8003\u8651\u6700\u591a\u83b7\u5f97\u8865\u7ed9\u7684\u6570\u91cf\u4e3a $K \\times (T+1)=200 \\times 21=4200$\uff0c\u6700\u591a $4200$ \u65f6\u523b\u540e\u79fb\u52a8\u7ed3\u675f\u3002\n\n\u540c\u65f6\u8003\u8651\uff1a\u82e5\u6709\u591a\u79cd\u8def\u5f84\u80fd\u591f\u5728 $t$ \u65f6\u523b\u5230\u8fbe $(x,y)$\uff0c\u6211\u4eec\u5fc5\u4fdd\u7559\u8865\u7ed9\u6570\u91cf\u591a\u7684\uff0c\u5f53\u524d\u4e3a\u8865\u7ed9\u70b9\u5219\u5fc5\u8865\u6ee1\u3002\n\n\u8bbe $f_{i,j,k}$ \u4e3a\u65f6\u523b $k$ \u5750\u6807 $(i,j)$ \u7684\u6700\u591a\u8865\u7ed9\u6570\uff0c\u5219\u72b6\u6001\u6570\u4e3a $200 \\times 200 \\times 4200=1.68 \\times 10^8$\uff0c\u800c\u4e14\u8fd9\u4e2a\u5b8c\u5168\u8dd1\u4e0d\u6ee1\u3002\n\n\u907f\u514d\u7a7a\u95f4\u592a\u5927\uff0c\u6211\u4eec\u53ea\u9700\u628a\u65f6\u523b\u8fd9\u4e00\u7ef4\u6eda\u6389\uff0c\u679a\u4e3e\u6bcf\u4e00\u4e2a\u65f6\u523b\uff0c\u6bcf\u6b21\u8bb0\u5f55\u5f53\u524d\u65f6\u523b\u4fe1\u606f\uff0c\u5904\u7406\u8d70\u4e00\u6b65\u540e\u7684\u72b6\u6001\u5373\u53ef\uff0c\u6ce8\u610f\u5224\u65ad\u4e0d\u80fd\u8d70\u7684\u65b9\u683c\uff0c\u540c\u65f6\u5f3a\u5236\u79fb\u52a8\u4e0e\u81ea\u884c\u79fb\u52a8\u7684\u987a\u5e8f\u53ef\u4ee5\u81ea\u884c\u9009\u62e9\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(NMKT)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=205,M=1e6+5;\ninline int read(){\n    int x=0,f=1; char s;\n    while((s=getchar())<'0'||s>'9') if(s=='-') f=-1;\n    while(s>='0'&&s<='9') x=(x*10)+(s^'0'),s=getchar();\n    return x*f;\n}\nstruct node{ int x,y,w; };\nint k,n,m,w,t,dx[M],dy[M],sx,sy;\nchar s[2],ma[N][N];\nbool ok[205][205][21*200+5];\nint f[205][205],g[205][205];\nint xx[6]={0,0,0,1,-1};\nint yy[6]={0,1,-1,0,0};\nqueue<node>q;\nint main(){\n\tn=read(),m=read(),k=read(),t=read(),w=read();\n\tfor(int i=1;i<=n;++i){\n\t\tfor(int j=1;j<=m;++j){\n\t\t\tscanf(\"%s\",s),ma[i][j]=s[0];\n\t\t\tif(s[0]=='M') sx=i,sy=j;\n\t}}\n\tfor(int i=0;i<=n;++i) ma[i][m+1]=ma[i][0]='L';\n\tfor(int i=0;i<=m;++i) ma[n+1][i]=ma[0][i]='L';\n\tfor(int i=1;i<=w;++i){ \n\t\tscanf(\"%s\",s); \n\t\tif(s[0]=='N') dx[i]=-1;\n\t\telse if(s[0]=='S') dx[i]=1;\n\t\telse if(s[0]=='E') dy[i]=1; \n\t\telse if(s[0]=='W') dy[i]=-1;\n\t}\n\tint lim=k*(t+1);\n\tfor(int i=1,x,y,w;i<=t;++i){\n\t\tx=read()+1,y=read()+1,w=read();\n\t\tif(w<=lim) ok[x][y][w]=1;\n\t}\n\tf[sx][sy]=k;\n\tq.push((node){sx,sy,k});\n\tfor(int i=1,x,y,nx,ny;i<=lim;++i){\n\t\tmemset(f,0,sizeof(f));\n\t\twhile(!q.empty()){\n\t\t\tnode tmp=q.front();q.pop();\n\t\t\tx=tmp.x+dx[i],y=tmp.y+dy[i];\n\t\t\tif(ma[x][y]!='L'){f[x][y]=max(f[x][y],tmp.w-1);\n\t\t\tif(ok[x][y][i]) f[x][y]=k;\n\t\t\tif(ma[x][y]=='P') {cout<<i; return 0;}}\n\t\t\tfor(int j=1;j<=4;++j){\n\t\t\t\tnx=x+xx[j],ny=y+yy[j];\n\t\t\t\tif(nx<1||nx>n||ny<1||ny>m) continue;\n\t\t\t\tif(ma[nx][ny]=='L') continue;\n\t\t\t\tif(ma[nx-dx[i]][ny-dy[i]]=='L'&&ma[x][y]=='L') continue;\n\t\t\t\tif(ma[nx][ny]=='P') { cout<<i; return 0;}\n\t\t\t\tf[nx][ny]=max(tmp.w-1,f[nx][ny]);\n\t\t\t\tif(ok[nx][ny][i]) f[nx][ny]=k;\n\t\t\t}\n\t\t}\n\t\tfor(int a=1;a<=n;++a){\n\t\t\tfor(int j=1;j<=m;++j){\n\t\t\t\tif(f[a][j]) q.push((node){a,j,f[a][j]});\n\t\t\t} \n\t\t}\n\t}\n\tcout<<-1;\n\treturn 0;\n}\n```\n",
        "postTime": 1642060551,
        "uid": 215604,
        "name": "dztlb",
        "ccfLevel": 0,
        "title": "CF1423D Does anyone else hate the wind?"
    }
]
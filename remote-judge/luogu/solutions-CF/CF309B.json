[
    {
        "content": ">### [\u6d1b\u8c37\u9898\u76ee\u9875\u9762\u4f20\u9001\u95e8](https://www.luogu.org/problem/CF309B) & [CodeForces\u9898\u76ee\u9875\u9762\u4f20\u9001\u95e8](https://codeforces.com/contest/309/problem/B)\n\n>\u7ed9\u5b9a\u4e00\u4e2a$n$\u4e2a\u5355\u8bcd\u7684\u6587\u672c\uff0c\u7b2c$i$\u4e2a\u5355\u8bcd\u7684\u957f\u5ea6\u4e3a$len_i$\uff0c\u8981\u6c42\u622a\u53d6\u6587\u672c\u7684\u4e00\u6bb5\uff08\u5355\u8bcd\u5fc5\u987b\u53d6\u6574\u7684\uff09\uff0c\u5206\u82e5\u5e72\u884c\u653e\uff0c\u540c\u884c\u5355\u8bcd\u7528\u7a7a\u683c\u5206\u9694\uff0c\u4f7f\u5f97\u6bcf\u884c\u7684\u957f\u5ea6\u4e0d\u8d85\u8fc7$m$\uff0c\u6700\u591a\u653e$s$\u884c\u3002\u6c42\u622a\u53d6\u7684\u5355\u8bcd\u6570\u6700\u591a\u7684\u622a\u6cd5\u3002\n\n>$n\\in\\left[1,10^6\\right],\\sum\\limits_{i=1}^nlen_i\\in\\left[1,5\\times10^6\\right],ms\\in\\left[1,10^6\\right]$\u3002\n\n\u8fd9\u9053\u9898\u60f3\u8981AC\u8fd8\u662f\u5f88\u5bb9\u6613\u7684\u3002\u8003\u8651\u679a\u4e3e\u622a\u53d6\u7684\u7b2c$1$\u4e2a\u5355\u8bcd\uff0c\u7136\u540e\u8ba1\u7b97\u5f80\u540e\u6700\u591a\u80fd\u5ef6\u7533\u591a\u5c11\u4e2a\u5355\u8bcd\uff0c\u6700\u540e\u53d6\u4e2a$\\max$\u3002\u91cd\u70b9\u5728\u4e8e\u5982\u4f55\u8ba1\u7b97\u5f80\u540e\u6700\u591a\u80fd\u5ef6\u7533\u591a\u5c11\u4e2a\u5355\u8bcd\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u50bb\u50bb\u5730\u8d2a\u5fc3\u3002\u5148\u6c42\u51fa$spl$\u6570\u7ec4\uff0c\u8868\u793a\u4ece\u7b2c$i$\u4e2a\u5355\u8bcd\u5f00\u59cb\u6700\u591a\u80fd\u5f80\u540e\u5ef6\u7533\u5230\u7b2c$spl_i-1$\u4e2a\u5355\u8bcd\u653e\u5728\u4e00\u884c\u3002\u5f88\u663e\u7136\uff0c\u201c\u662f\u5426\u80fd\u5ef6\u7533\u5230\u7b2c$x$\u4e2a\u5355\u8bcd\u653e\u5728\u4e00\u884c\u201d\u5177\u6709\u5355\u8c03\u6027\uff0c\u4e8e\u662f$spl$\u6570\u7ec4\u53ef\u4ee5$\\mathrm O(n\\log_2n)$\u914d\u5408\u524d\u7f00\u548c\u4e8c\u5206\u6c42\u51fa\u3002\u90a3\u4e48\u4ece\u7b2c$i$\u4e2a\u5355\u8bcd\u5f80\u540e\u6700\u591a\u80fd\u5ef6\u7533\u7684\u5355\u8bcd\u6570\u5c31\u662f$\\underbrace{spl_{spl_{spl_{\\cdots_{i}}}}}_{s\\text{\u6b21}spl\\text{\u6620\u5c04}}-i$\u3002\u8fd9\u4e2a\u53c8\u663e\u7136\u53ef\u4ee5\u603b\u5171$\\mathrm O(n\\log_2n)$\u500d\u589e\u6c42\u51fa\u3002\u4e8e\u662f$\\mathrm O(n\\log_2n)$\u7684\u590d\u6742\u5ea6\u662fextremely easy\u7684\u3002\n\n\u800c\u6211~~\u4eec~~\u662f\u8ffd\u6c42\u5b8c\u7f8e\u7684OIer\uff0c\u8fd9\u4e2a\u590d\u6742\u5ea6\u80fd\u5426\u8fbe\u5230$\\mathrm O(n)$\u5462\uff1f\u5e26$\\log$\u590d\u6742\u5ea6\u7684\u5730\u65b9\u6709$2$\u4e2a\u2014\u2014\u6c42$spl$\u6570\u7ec4\u548c$s$\u6b21$spl$\u6620\u5c04\uff0c\u6211\u4eec\u4e00\u4e2a\u4e00\u4e2a\u6765\u770b\u3002\n\n\u9996\u5148\u662f\u6c42$spl$\u6570\u7ec4\u3002\u4e0d\u96be\u53d1\u73b0\uff0c$spl$\u6570\u7ec4\u672c\u8eab\u5177\u6709\u5355\u8c03\u6027\uff0c\u5373$spl_i\\le spl_{i+1}$\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4ece\u540e\u5f80\u524dtwo-pointers\uff0c\u6c42$spl_i$\u65f6\uff0c\u53ea\u9700\u4ece$spl_{i+1}$\u5230$i$\u4ece\u540e\u5f80\u524d\u8bd5\u662f\u5426\u80fd\u5ef6\u7533\u5230\u5373\u53ef\u3002\u5176\u4e2d\u8fb9\u754c\u662f$spl_{n+1}=n+1$\u3002\u8fd9\u6837\u6240\u6709\u5355\u8bcd\u5747\u644a\u88ab\u8bd5$\\mathrm O(n)$\u6b21\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u6ca1\u6709$\\log$\u4e86\u3002\n\n\u63a5\u4e0b\u6765\u662f\u6620\u5c04\u3002\u4ecd\u7136\u5229\u7528$spl$\u6570\u7ec4\u7684\u5355\u8c03\u6027\uff0c\u82e5\u5728\u6240\u6709$i$\u548c$spl_i$\u4e4b\u95f4\u8fde\u4e00\u6761\u8fb9\uff0c\u82e5$i=spl_i$\u5219\u4e0d\u8fde\u8fb9\uff0c\u90a3\u4e48\u4e00\u5b9a\u4f1a\u5f62\u6210\u4e00\u4e2a\u68ee\u6797\uff0c\u800c\u5bf9$i$\u8fdb\u884c$s$\u6b21\u6620\u5c04\u663e\u7136\u5c31\u7b49\u4e8e\u8282\u70b9$i$\u7684$\\min(s,dep_i)$\u8f88\u7956\u5148\u3002\u6211\u4eec\u5bf9\u68ee\u6797\u91cc\u7684\u6bcf\u4e00\u68f5\u6811\u8fdb\u884cDFS\uff0c\u540c\u65f6\u7ef4\u62a4\u4e00\u4e2a\u9012\u5f52\u6808$stk$\uff0c\u90a3\u4e48$\\mathrm O(1)$\u4fbf\u53ef\u627e\u5230\u8282\u70b9$i$\u7684$\\min(s,dep_i)$\u8f88\u7956\u5148\uff0c\u590d\u6742\u5ea6\u4e5f\u53d8\u6210\u6574\u4f53$\\mathrm O(n)$\u4e86\u3002\n\n\u4e0b\u9762\u8d34\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define pb push_back\nconst int N=1000000;\nint n/*\u5355\u8bcd\u6570*/,m/*\u6bcf\u884c\u6700\u591a\u80fd\u653e\u7684\u957f\u5ea6*/,s/*\u6700\u591a\u80fd\u653e\u7684\u884c\u6570*/;\nstring a[N+1];//\u5355\u8bcd\u4eec \nint Sum[N+1];//\u524d\u7f00\u957f\u5ea6\u548c\uff08\u6bcf\u4e2a\u5355\u8bcd\u540e\u9762\u52a0\u4e0a\u7a7a\u683c\uff09 \nvector<int> son[N+2];int fa[N+2];//\u6811\uff0cfa\u5373spl\u6570\u7ec4 \nint stk[N+1],top;//\u9012\u5f52\u6808 \nint ans[N+2];//\u4ece\u7b2ci\u4e2a\u5355\u8bcd\u5f00\u59cb\u6700\u591a\u80fd\u5ef6\u4f38\u7684\u5355\u8bcd\u6570 \nvoid dfs(int x){//\u5bf9\u6811DFS \n\tstk[top++]=x;//\u5c06\u6b64\u8282\u70b9\u5165\u6808 \n\tans[x]=stk[max(0,top-1-s)]-x;//O(1)\u627emin(s,dep[i])\u8f88\u7956\u5148 \n\tfor(int i=0;i<son[x].size();i++){\n\t\tint y=son[x][i];\n\t\tdfs(y);\n\t}\n\ttop--;//\u51fa\u6808 \n}\nint main(){\n\tcin>>n>>s>>m;\n\tfor(int i=1;i<=n;i++)cin>>a[i],Sum[i]=Sum[i-1]+a[i].size()+1/*\u9884\u5904\u7406\u524d\u7f00\u548c*/;\n\tfa[n+1]=n+1;//\u9012\u63a8\u8fb9\u754c \n\tfor(int i=n;i;i--){//\u4ece\u540e\u5f80\u524d\u9012\u63a8 \n\t\tfa[i]=fa[i+1]; \n\t\twhile(Sum[fa[i]-1]-Sum[i-1]-1>m)fa[i]--;//\u4ece\u540e\u5f80\u524d\u8bd5 \n\t\tif(fa[i]!=i)son[fa[i]].pb(i);//\u8fde\u8fb9 \n\t}\n//\tfor(int i=1;i<=n+1;i++)cout<<fa[i]<<\" \";puts(\"\");\n\tfor(int i=1;i<=n+1;i++)if(fa[i]==i)top=0,dfs(i);//DFS\u6bcf\u68f5\u6811 \n\tint mx=*max_element(ans+1,ans+n+2);//\u6700\u5927\u7b54\u6848 \n\tfor(int i=1;i<=n+1;i++)if(ans[i]==mx){\n\t\twhile(s--){//\u8f93\u51fa \n\t\t\tfor(int j=i;j<fa[i];j++)cout<<a[j]<<(j<fa[i]-1?\" \":\"\\n\");\n\t\t\ti=fa[i];\n\t\t}\n\t\treturn 0;\n\t}\n}\n```",
        "postTime": 1570984242,
        "uid": 138400,
        "name": "chenxia25",
        "ccfLevel": 9,
        "title": "CodeForces 309B - Context Advertising"
    }
]
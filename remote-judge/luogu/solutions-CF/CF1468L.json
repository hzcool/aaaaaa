[
    {
        "content": "> \u6458\u81ea\u6211\u7684 [\u6742\u9898\u9009\u505a\u2164](https://www.cnblogs.com/ET2006/p/greedy-construction-dp5.html) \u4e2d\u7684\u7b2c $105$ \u9898\u3002\n\n\u6211\u4eec\u5148\u8003\u8651\u5c06\u6bcf\u4e2a\u6570\u5199\u6210 $p^a$ \u7684\u5f62\u5f0f\uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u8d28\u56e0\u5b50 $p$ \u7684\u201c\u51fa\u73b0\u6b21\u6570\u201d\u4e3a\uff0c\u6ee1\u8db3 $a_i=p^x$ \u7684 $i$ \u7684\u4e2a\u6570\uff08$x\\in\\mathbb{Z}$\uff09\u3002\u663e\u7136\u5982\u679c\u4e00\u4e2a\u8d28\u56e0\u5b50\u51fa\u73b0\u6b21\u6570 $\\le 1$\uff0c\u90a3\u4e48\u5305\u542b\u8fd9\u4e9b\u8d28\u56e0\u5b50\u7684\u6570\u90fd\u4e0d\u80fd\u88ab\u9009\u62e9\uff0c\u6211\u4eec\u5c31\u5e72\u8106\u628a\u8fd9\u4e9b\u8d28\u56e0\u5b50\u5168\u90e8\u8e22\u51fa\u53bb\uff0c\u8fd9\u6837\u6211\u4eec\u5269\u4e0b\u7684\u5c31\u53ea\u6709\u90a3\u4e9b\u7531\u51fa\u73b0\u6b21\u6570 $\\ge 2$ \u7684\u8d28\u56e0\u5b50\u6784\u6210\u7684\u6570\u3002\n\n\u663e\u7136\u5982\u679c $k=1$ \u6216\u8005 $k$ \u8d85\u8fc7\u4e86\u5269\u4f59\u7684\u6570\u7684\u4e2a\u6570\u90a3\u80af\u5b9a\u65e0\u89e3\u4e86\uff0c\u76f4\u63a5\u8f93\u51fa $0$\u3002\u4f46\u662f\u5982\u679c $k$ \u5728 $2$ \u4e0e\u5269\u4f59\u7684\u6570\u7684\u4e2a\u6570\u4e4b\u95f4\u90a3\u4e5f\u6709\u53ef\u80fd\u51fa\u73b0\u65e0\u89e3\u7684\u60c5\u51b5\uff0c\u7279\u4f8b\uff1a$a=[4,8,9,27],k=3$\uff0c\u56e0\u6b64\u8003\u8651\u8fdb\u4e00\u6b65\u5206\u60c5\u51b5\u8ba8\u8bba\uff1a\n\n- \u8bb0 $cnt$ \u8868\u793a\u51fa\u73b0\u6b21\u6570 $\\ge 2$ \u7684\u8d28\u56e0\u5b50\u4e2a\u6570\uff0c\u5982\u679c $k\\ge 2cnt$ \u90a3\u597d\u529e\uff0c\u76f4\u63a5\u5728\u8fd9 $cnt$ \u4e2a\u8d28\u56e0\u5b50\u4e2d\u5148\u968f\u4fbf\u9009 $2$ \u4e2a\u6570\uff0c\u7136\u540e\u518d\u968f\u4fbf\u9009 $k-2cnt$ \u4e2a\u6570\u5373\u53ef\u3002\n- \u5426\u5219\u5982\u679c $k$\u200b \u662f\u5076\u6570\u90a3\u4e5f\u597d\u529e\uff0c\u968f\u673a\u9009 $\\dfrac{k}{2}$ \u4e2a\u8d28\u56e0\u5b50\uff0c\u7136\u540e\u8fd9\u4e9b\u8d28\u56e0\u5b50\u4e2d\u968f\u4fbf\u9009 $2$ \u4e2a\u5bf9\u5e94\u7684\u6570\u5373\u53ef\u3002\n- \u5426\u5219\u7ee7\u7eed\u5206\u60c5\u51b5\u8ba8\u8bba\uff0c\u5982\u679c\u5b58\u5728\u4e00\u4e2a\u8d28\u56e0\u5b50 $p$\u200b \u51fa\u73b0\u6b21\u6570 $\\ge 3$\u200b \u90a3\u4e48\u6211\u4eec\u5c31\u9009 $3$\u200b \u4e2a\u6ee1\u8db3\u53ef\u4ee5\u5199\u6210 $p^x$\u200b \u7684\u6570\uff0c\u7136\u540e\u518d\u968f\u673a\u9009\u53e6\u5916 $\\dfrac{k-3}{2}$\u200b \u4e2a\u8d28\u56e0\u5b50\uff0c\u5bf9\u4e8e\u9009\u4e2d\u7684\u8d28\u56e0\u5b50 $p\u2019$\uff0c\u968f\u4fbf\u9009\u4e24\u4e2a\u6570\u5f62\u5982 $(p\u2019)^x$ \u7684\u6570\u5373\u53ef\u3002\n- \u5426\u5219\u8bf4\u660e\u6240\u6709\u8d28\u56e0\u5b50\u7684\u51fa\u73b0\u6b21\u6570\u90fd\u7b49\u4e8e $2$\uff0c\u90a3\u4e48\u6211\u4eec\u8003\u8651\u6240\u6709\u4e0d\u53ef\u4ee5\u5199\u6210 $p^x$ \u4e14\u6ca1\u6709\u88ab\u6211\u4eec\u8e22\u6389\u7684\u6570\uff0c\u6211\u4eec\u8bb0\u8fd9\u4e9b\u6570\u4e2d\u8d28\u56e0\u5b50\u4e2a\u6570\u7684\u6700\u5c0f\u503c\u4e3a $M$\uff0c\u90a3\u4e48\u5982\u679c $k<2M-1$ \u5c31\u65e0\u89e3\u4e86\u3002\u5426\u5219\u6211\u4eecj\uff0c\u518d\u9009\u5047\u8bbe\u6ca1\u6709\u88ab\u8e22\u6389\u7684\u6570\u4e2d\u8d28\u56e0\u5b50\u4e2a\u6570\u6700\u5c0f\u7684\u6570\u4e3a $v$\uff0c$v$ \u7684 $M$ \u4e2a\u8d28\u56e0\u5b50\u4e3a $p_1,p_2,\\cdots,p_M$\uff0c\u90a3\u4e48\u6211\u4eec\u5bf9\u4e8e $i\\in[1,M]$\uff0c\u9009\u51fa\u4e24\u4e2a\u5f62\u5982 $p_i^x$ \u7684\u6570\uff0c\u7136\u540e\u9009\u4e0a $v$ \u8fd9\u4e2a\u6570\uff0c\u7136\u540e\u518d\u968f\u4fbf\u9009 $\\dfrac{k-2M-1}{2}$ \u4e2a\u5269\u4f59\u7684\u8d28\u56e0\u5b50 $p$\uff0c\u6bcf\u4e2a\u8d28\u56e0\u5b50\u9009\u4e24\u4e2a\u5f62\u5982 $p^x$ \u7684\u6570\u5373\u53ef\u3002\n\n\u6ce8\u610f\u5230\u6bcf\u4e2a\u6570\u4e92\u4e0d\u76f8\u540c\uff0c\u6240\u4ee5\u53ea\u6709 $<10^9$ \u7684\u8d28\u6570\u662f\u6709\u7528\u7684\uff0c\u5176\u4ed6\u8d28\u6570\u7684\u51fa\u73b0\u6b21\u6570\u81f3\u591a\u4e3a $1$\u3002\u800c\u5982\u679c\u6211\u4eec\u8003\u8651\u5bf9 $1\\sim 10^6$ \u91cc\u7684\u8d28\u6570\u66b4\u529b\u5206\u89e3\uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u5bf9\u6240\u6709 $\\le 10^6$ \u7684\u8d28\u6570 $p$\uff0c\u627e\u51fa\u5e8f\u5217\u4e2d\u6240\u6709\u53ef\u4ee5\u8868\u793a\u6210 $p^x$ \u7684\u6570\u3002\u800c\u5982\u679c $a_i\\le 10^9$\uff0c\u5e76\u4e14 $a_i$ \u6ca1\u6709 $\\le 10^6$\u200b \u7684\u8d28\u56e0\u5b50\uff0c\u90a3\u4e48\u5c31\u8bf4\u660e $a_i$ \u662f\u8d28\u6570\uff0c\u6211\u4eec\u53ea\u9700\u68c0\u9a8c $a_i^2$ \u662f\u5426\u662f\u4e00\u4e2a\u8d28\u6570\uff0c\u5982\u679c\u662f\u5219\u8bf4\u660e $a_i$ \u7684\u51fa\u73b0\u6b21\u6570\u4e3a\u4e8c\uff0c\u5426\u5219\u6211\u4eec\u76f4\u63a5\u8e22\u6389\u8fd9\u4e2a\u8d28\u6570\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $n\\pi(10^6)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi first\n#define se second\n#define fill0(a) memset(a, 0, sizeof(a))\n#define fill1(a) memset(a, -1, sizeof(a))\n#define fillbig(a) memset(a, 63, sizeof(a))\n#define pb push_back\n#define ppb pop_back\n#define mp make_pair\n#define mt make_tuple\n#define eprintf(...) fprintf(stderr, __VA_ARGS__)\ntemplate <typename T1, typename T2> void chkmin(T1 &x, T2 y){\n\tif (x > y) x = y;\n}\ntemplate <typename T1, typename T2> void chkmax(T1 &x, T2 y){\n\tif (x < y) x = y;\n}\ntypedef pair<int, int> pii;\ntypedef long long ll;\ntypedef unsigned int u32;\ntypedef unsigned long long u64;\ntypedef long double ld;\nnamespace fastio {\n\t#define FILE_SIZE 1 << 23\n\tchar rbuf[FILE_SIZE], *p1 = rbuf, *p2 = rbuf, wbuf[FILE_SIZE], *p3 = wbuf;\n\tinline char getc() {\n\t\treturn p1 == p2 && (p2 = (p1 = rbuf) + fread(rbuf, 1, FILE_SIZE, stdin), p1 == p2) ? -1: *p1++;\n\t}\n\tinline void putc(char x) {(*p3++ = x);}\n\ttemplate <typename T> void read(T &x) {\n\t\tx = 0; char c = getc(); T neg = 0;\n\t\twhile (!isdigit(c)) neg |= !(c ^ '-'), c = getc();\n\t\twhile (isdigit(c)) x = (x << 3) + (x << 1) + (c ^ 48), c = getc();\n\t\tif (neg) x = (~x) + 1;\n\t}\n\ttemplate <typename T> void recursive_print(T x) {\n\t\tif (!x) return;\n\t\trecursive_print (x / 10);\n\t\tputc (x % 10 ^ 48);\n\t}\n\ttemplate <typename T> void print(T x) {\n\t\tif (!x) putc('0');\n\t\tif (x<0) putc('-'), x = -x;\n\t\trecursive_print(x);\n\t}\n\ttemplate <typename T> void print(T x,char c) {print(x); putc(c);}\n\tvoid readstr(char *s) {\n\t\tchar c = getc();\n\t\twhile (c <= 32 || c >= 127) c = getc();\n\t\twhile (c > 32 && c < 127) s[0] = c, s++, c = getc();\n\t\t(*s) = 0;\n\t}\n\tvoid printstr(string s) {\n\t\tfor (int i = 0; i < s.size(); i++) putc(s[i]);\n\t}\n\tvoid printstr(char *s) {\n\t\tint len = strlen(s);\n\t\tfor (int i = 0; i < len; i++) putc(s[i]);\n\t}\n\tvoid print_final() {fwrite(wbuf, 1, p3-wbuf, stdout);}\n}\nconst int MAXN = 1000;\nconst int MAXV = 1e6;\nint n, k; ll x[MAXN + 5], pp[MAXN + 5];\nbool ok[MAXN + 5]; map<ll, int> cnt;\nint prcnt, pr[MAXV / 6 + 5], vis[MAXV + 5];\nvoid sieve(int n) {\n\tfor (int i = 2; i <= n; i++) {\n\t\tif (!vis[i]) pr[++prcnt] = i;\n\t\tfor (int j = 1; j <= prcnt && pr[j] * i <= n; j++) {\n\t\t\tvis[pr[j] * i] = 1;\n\t\t}\n\t}\n}\nvector<int> fac[MAXN + 5];\nbool book[MAXN + 5];\nint main() {\n\tscanf(\"%d%d\", &n, &k); sieve(MAXV);\n\tmap<ll, vector<int> > pos;\n\tfor (int i = 1; i <= n; i++) {\n\t\tscanf(\"%lld\", &x[i]);\n\t\tbool flg = 1; ll tmp = x[i];\n\t\tfor (int j = 1; j <= prcnt; j++) {\n\t\t\tif (x[i] % pr[j] == 0) {\n\t\t\t\twhile (tmp % pr[j] == 0) tmp /= pr[j];\n\t\t\t\tif (tmp == 1) pp[i] = pr[j];\n\t\t\t\telse pp[i] = -1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tpos[x[i]].pb(i);\n\t}\n\tfor (int i = 1; i <= n; i++) if (!pp[i]) {\n\t\tif (x[i] <= 1e9 && !pos[x[i] * x[i]].empty()) {\n\t\t\tfor (int j : pos[x[i] * x[i]]) pp[j] = x[i];\n\t\t\tpp[i] = x[i];\n\t\t}\n\t\telse pp[i] = -1;\n\t}\n\tint num = 0;\n//\tfor (int i = 1; i <= n; i++) printf(\"%lld%c\", pp[i], \" \\n\"[i == n]);\n\tfor (int i = 1; i <= n; i++) if (~pp[i]) cnt[pp[i]]++;\n\tvector<ll> seq; ll mpos = -1;\n\tfor (auto p : cnt) if (p.se >= 2) {\n\t\tseq.pb(p.fi);\n\t\tif (p.se >= 3) mpos = p.fi;\n\t}\n//\tprintf(\"%d\\n\", seq.size());\n\tfor (int i = 1; i <= n; i++) {\n\t\tif (!~pp[i]) {\n\t\t\tll tmp = x[i]; vector<int> fc;\n\t\t\tfor (int j : seq) if (tmp % j == 0) {\n\t\t\t\tfc.pb(j);\n\t\t\t\twhile (tmp % j == 0) tmp /= j;\n\t\t\t}\n\t\t\tif (tmp == 1) fac[i] = fc, num++, ok[i] = 1;\n\t\t}\n\t\telse if (cnt[pp[i]] == 1) pp[i] = -1;\n\t\telse num++;\n\t}\n\tif (num < k || k == 1) return puts(\"0\"), 0;\n\tif (~mpos) {\n//\t\tputs(\"-1\");\n\t\tif (k <= seq.size() * 2) {\n\t\t\tfor (int j = 1, lft = 2 + (k & 1); j <= n; j++)\n\t\t\t\tif (pp[j] == mpos && lft) {\n\t\t\t\t\tbook[j] = 1; lft--; k--;\n\t\t\t\t}\n\t\t\tfor (int i = 0; i < seq.size(); i++) if (mpos != seq[i]) {\n\t\t\t\tfor (int j = 1, lft = 2; j <= n; j++)\n\t\t\t\t\tif (pp[j] == seq[i] && lft && k) {\n\t\t\t\t\t\tbook[j] = 1; lft--; k--;\n\t\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfor (int i = 0; i < seq.size(); i++)\n\t\t\t\tfor (int j = 1, lft = 2 + (seq[i] == mpos); j <= n; j++)\n\t\t\t\t\tif (pp[j] == seq[i] && lft) {\n\t\t\t\t\t\tbook[j] = 1; lft--; k--;\n\t\t\t\t\t}\n\t\t\tfor (int i = 1; i <= n; i++) if (!book[i] && (ok[i] || pp[i] != -1) && k)\n\t\t\t\tbook[i] = 1, k--;\n\t\t}\n\t} else {\n\t\tpii mn = mp(seq.size(), 0);\n\t\tfor (int i = 1; i <= n; i++) if (ok[i]) chkmin(mn, mp((int)fac[i].size(), i));\n\t\tif (k <= 2 * mn.fi && (k & 1)) return puts(\"0\"), 0;\n\t\tif (k <= 2 * seq.size()) {\n\t\t\tif (k % 2 == 0) {\n\t\t\t\tfor (int i = 0; i < seq.size(); i++)\n\t\t\t\t\tfor (int j = 1; j <= n; j++)\n\t\t\t\t\t\tif (pp[j] == seq[i] && k) {\n\t\t\t\t\t\t\tbook[j] = 1; k--;\n\t\t\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tbook[mn.se] = 1; k--;\n\t\t\t\tfor (int f : fac[mn.se]) {\n\t\t\t\t\tfor (int j = 1; j <= n; j++) if (pp[j] == f)\n\t\t\t\t\t\tbook[j] = 1, k--;\n\t\t\t\t}\n\t\t\t\tfor (int i = 0; i < seq.size(); i++)\n\t\t\t\t\tfor (int j = 1; j <= n; j++)\n\t\t\t\t\t\tif (pp[j] == seq[i] && !book[j] && k) {\n\t\t\t\t\t\t\tbook[j] = 1; k--;\n\t\t\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfor (int i = 1; i <= n; i++) if (~pp[i]) book[i] = 1, k--;\n\t\t\tfor (int i = 1; i <= n; i++) if (ok[i] && k) book[i] = 1, k--;\n\t\t}\n\t}\n\tfor (int i = 1; i <= n; i++) if (book[i])\n\t\tprintf(\"%lld \", x[i]);\n\treturn 0;\n}\n/*\n5 3\n2 4 9 27 6\n\n7 5\n2 4 9 27 5 25 10\n\n7 6\n2 4 9 27 5 25 10\n*/\n```",
        "postTime": 1640416159,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1468L Prime Divisors Selection"
    }
]
[
    {
        "content": "[$$\\Large\\texttt{My Blog}$$](https://hydingsy.github.io/articles/problem-Codeforces-776E-The-Holmes-Children/)\n\n---\n\n## Description\n\n> \u9898\u76ee\u94fe\u63a5\uff1a[Codeforces 776E](https://codeforces.com/contest/776/problem/E)\n\nHolmes \u7684\u5b69\u5b50\u4eec\u5728\u4e89\u8bba\u8c01\u624d\u662f\u4ed6\u4eec\u4e2d\u6700\u806a\u660e\u7684\u3002\n\nMycroft \u63d0\u51fa\u4e86\u5982\u4e0b\u7684\u51fd\u6570\u6c42\u503c\u95ee\u9898\uff1a\u5df2\u77e5 $f(1)=1$\uff0c\u4e14\u5f53 $n\\ge 2$ \u65f6\uff0c$f(n)$ \u8868\u793a\u6ee1\u8db3 $x+y=n$ \u7684\u4e92\u8d28\u7684\u6b63\u6574\u6570\u5bf9 $(x,y)$ \u7684\u5bf9\u6570\uff0c$g(n)=\\sum_{d\\mid n}f\\left(\\frac{n}{d}\\right)$\u3002\n\n\u5979\u5b9a\u4e49\u4e86\u4e00\u4e2a\u51fd\u6570 $F_k(n)$\uff0c\u5176\u503c\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u5f0f\u5b50\u9012\u5f52\u6c42\u89e3\uff1a\n$$F_k(n)=\\begin{cases}f(g(n)) & k=1 \\\\g(F_{k-1}(n)) & k>1,k\\bmod 2=0 \\\\f(F_{k-1}(n)) & k>1,k\\bmod 2 =1\\end{cases}$$\n\u73b0\u5728\u5979\u5e0c\u671b\u4f60\u5bf9\u4e8e\u7ed9\u5b9a $n,k$\uff0c\u6c42\u51fa $F_k(n)\\bmod 1000000007$ \u7684\u503c\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\le n,k\\le 10^{12}$\n\n------\n\n## Solution\n\n\u6211\u4eec\u5148\u63a8\u5bfc\u4e00\u4e0b $f(n)$ \u548c $g(n)$ \u51fd\u6570\u5230\u5e95\u957f\u6210\u4ec0\u4e48\u6837\u5b50\uff1a\n$$\\begin{aligned}f(n) & =\\sum_{i=1}^{n-1} [\\gcd(i,n-i)=1] \\\\&=\\sum_{i=1}^{n-1}[\\gcd(i,n)=1] \\\\&=\\varphi(n)\\end{aligned}$$\n\u7531\u4e8e $f(n)$ \u5c31\u662f $\\varphi(n)$ \u51fd\u6570\uff0c\u90a3\u4e48 $g(n)$ \u51fd\u6570\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u5f0f\u5b50\u8868\u793a\uff1a\n$$\\begin{aligned}g(n) & =\\sum_{d\\mid n} f\\left(\\frac{n}{d}\\right) \\\\& = \\sum_{d\\mid n} \\varphi\\left(\\frac{n}{d}\\right)\\end{aligned}$$\n\u663e\u7136\u8fd9\u662f\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\uff1a\n$$g=\\varphi\\ast 1=\\texttt{ID}$$\n\u56e0\u6b64 $g(n)=n$\uff01\n\n\u90a3\u4e48\u9012\u5f52\u5f0f\u53d8\u4e3a\uff1a\n$$F_k(n)=\\begin{cases}\\varphi(n) & k=1 \\\\F_{k-1}(n) & k>1,k\\bmod 2=0 \\\\\\varphi(F_{k-1}(n)) & k>1,k\\bmod 2 =1\\end{cases}$$\n\u6211\u4eec\u53ef\u4ee5\u627e\u89c4\u5f8b\u53d1\u73b0\uff0c$F_k(n)$ \u7684\u503c\u5c31\u662f\u5bf9 $n$ \u6c42 $\\left\\lfloor\\frac{k+1}{2}\\right\\rfloor$ \u6b21 $\\varphi$ \u51fd\u6570\u3002\n\n\u663e\u7136\u6211\u4eec\u4e0d\u80fd\u771f\u7684\u6c42 $O(k)$ \u6b21 $\\varphi$\uff0c\u7531\u4e8e $n$ \u6c42 $O(\\log n)$ \u6b21 $\\varphi$ \u7684\u503c\u5c31\u662f $1$\uff0c\u6b64\u65f6\u518d\u6c42 $\\varphi$ \u5c31\u6ca1\u6709\u610f\u4e49\u4e86\u3002\u6545\u6211\u4eec\u53ea\u9700\u8981\u6c42 $\\max\\left(\\log n,\\left\\lfloor\\frac{k+1}{2}\\right\\rfloor\\right)$ \u6b21 $\\varphi$ \u5373\u53ef\u3002\n\n**\u65f6\u95f4\u590d\u6742\u5ea6**\uff1a$O\\left(\\max\\left(\\log n,\\left\\lfloor\\frac{k+1}{2}\\right\\rfloor\\right)\\sqrt n\\right)$\n\n------\n\n## Code\n\n```cpp\n#include <cstdio>\n\nconst int N=1e6+5;\nint tot,p[N];\nbool flg[N];\n\nvoid sieve(int n) {\n\tfor(int i=2;i<=n;++i) {\n\t\tif(!flg[i]) p[++tot]=i;\n\t\tfor(int j=1;j<=tot&&i*p[j]<=n;++j) {\n\t\t\tflg[i*p[j]]=1;\n\t\t\tif(i%p[j]==0) break;\n\t\t}\n\t}\n}\nlong long phi(long long x) {\n\tlong long ans=x;\n\tfor(int i=1;i<=tot&&1LL*p[i]*p[i]<=x;++i) {\n\t\tif(x%p[i]) continue;\n\t\tans=ans/p[i]*(p[i]-1);\n\t\twhile(x%p[i]==0) x/=p[i];\n\t}\n\tif(x>1) ans=ans/x*(x-1);\n\treturn ans;\n}\nint main() {\n\tsieve(N-5);\n\tlong long n,k;\n\tscanf(\"%lld%lld\",&n,&k);\n\tk=(k+1)/2;\n\tfor(long long i=1;i<=k&&n>1;++i) {\n\t\tn=phi(n);\n\t}\n\tprintf(\"%lld\\n\",n%1000000007);\n\treturn 0;\n}\n```\n\n\n\n",
        "postTime": 1549594142,
        "uid": 49725,
        "name": "Siyuan",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF776E \u3010The Holmes Children\u3011"
    },
    {
        "content": "\u6b27\u62c9\u51fd\u6570\n\n\u6211\u4eec\u8003\u8651\u8fd9\u4e2a\u5206\u6bb5\u51fd\u6570\n\n\n\n$$f_i = \\sum_{i=1}^{n-1} [\\gcd(n,n-i)==1]$$\n\n$$=\\sum_{i=1}^{n-1}[\\gcd(n,i)==1]$$\n\n\u7136\u800c\u5c31\u662f\u6b27\u62c9\u51fd\u6570 $\\varphi$\n\n\u90a3\u4e48\u8003\u8651 $g_n = \\sum_{d|n} \\varphi (d)$\n\n\u8003\u8651 $\\varphi(n)$ \u7684\u5b9e\u9645\u610f\u4e49\u662f $[1,n-1]$ \u6709\u591a\u5c11\u4e2a\u548c $n$ \u4e92\u8d28\u7684\u6570\u5b57\n\n\n\u5b9a\u4e49 $S = {d|d\\in [1,n] , d|n}$\n\n\u56e0\u4e3a $g_n = \\sum_{d|n} \\varphi (d) = \\sum_{d|n} \\varphi(\\frac{n}{d})$\n\n\n\u6240\u4ee5 $g_n$ \u7684\u5b9e\u9645\u610f\u4e49\u5c31\u662f\u4e0e $n$ \u7684 $\\gcd$ \u4e3a $S$ \u4e2d\u7684\u5143\u7d20\u7684\u4e2a\u6570\n\n\u5373 $g_n = \\sum_{i=1}^{n} [\\gcd(i,n) \\in S]$\n\n\u6613\u8bc1\u7b54\u6848\u662f $g_n = n$\n\n\u8003\u8651\u5230\u5947\u6570\u65f6\u624d\u8fdb\u884c\u6b27\u62c9\u51fd\u6570\uff0c\u5076\u6570\u6b21\u53c8\u4e0d\u5f71\u54cd\uff0c\u4f46\u662f $k$ \u7684\u9650\u5236\u53c8\u5f88\u5927\uff0c\u6240\u4ee5\u8003\u8651 $\\varphi$ \u7684\u6027\u8d28\uff0c\u56e0\u4e3a\u7ecf\u8fc7\u81f3\u591a $\\log$ \u6b21\u4f1a\u4f7f\u5f97\u539f\u6570\u53d8\u6210 $1$\uff0c\u7279\u6b8a\u7684\uff0c$\\varphi (1) =1$ \uff0c\u6240\u4ee5 $k$ \u662f\u5047\u7684\n\n```cpp\n// powered by c++11\n// by Isaunoya\n\n#include<bits/stdc++.h>\n#define rep(i , x , y) for(register int i = (x) ; i < (y) ; i ++)\nusing namespace std ;\nusing db = double ;\nusing ll = long long ;\nusing uint = unsigned int ;\n#define int long long\nusing pii = pair < int , int > ;\n#define ve vector\n#define Tp template\n#define all(v) v.begin() , v.end()\n#define sz(v) ((int)v.size())\n#define pb emplace_back\n#define fir first\n#define sec second\n\n// the cmin && cmax\nTp < class T > void cmax(T & x , const T & y) {\n\tif(x < y) x = y ;\n}\nTp < class T > void cmin(T & x , const T & y) {\n\tif(x > y ) x = y ;\n}\n\n// sort , unique , reverse\nTp < class T > void sort(ve < T > & v) {\n\tsort(all(v)) ;\n}\nTp < class T > void unique(ve < T > & v) {\n\tsort(all(v)) ;\n\tv.erase(unique(all(v)) , v.end()) ;\n}\nTp < class T > void reverse(ve < T > & v) {\n\treverse(all(v)) ;\n}\n\nint qwq(int x) {\n\tint res = x ;\n\tfor(int i = 2 ; i <= sqrt(x) ; i ++) {\n\t\tif(! (x % i)) {\n\t\t\tres = res / i * (i - 1) ;\n\t\t\twhile(! (x % i)) x /= i ;\n\t\t}\n\t}\n\tif(x > 1) res = res / x * (x - 1) ;\n\treturn res ;\n} \nsigned main() {\n\tios_base :: sync_with_stdio(false) ;\n\tcin.tie(nullptr) , cout.tie(nullptr) ;\n// code begin.\n\tint n , k ;\n\tcin >> n >> k ;\n\twhile(k && n > 1) {\n\t\tif(k & 1) n = qwq(n) ;\n\t\tk -- ;\n\t}\n\tcout << n % 1000000007 << '\\n' ;\n\treturn 0 ;\n// code end.\n} \n```",
        "postTime": 1580452046,
        "uid": 96580,
        "name": "SXNhdW5veWE",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF776E \u3010The Holmes Children\u3011"
    },
    {
        "content": "## \u601d\u8def\n\n![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF776E/bd985db890d6882c9f46cc152e6a148e4e80dbfa.png)\n\n\u5f88\u660e\u663e\u7684\u6570\u5b66\u9898\u4e86\uff0c\u53ef\u4ee5\u5148\u5316\u7b80\u4e00\u4e0b $f(n)$ \u548c $g(n)$\u3002\n\n\u6839\u636e\u9898\u610f\uff0c$f(n)$ \u8868\u793a\u6ee1\u8db3 $x+y=n$ \u7684\u4e92\u8d28\u7684\u6b63\u6574\u6570\u5bf9 $(x,\u2009y)$ \u7684\u5bf9\u6570\u3002\u4f46\u5f53\u6211\u4eec\u77e5\u9053 $x$ \u7684\u65f6\u5019\u80af\u5b9a\u4e5f\u77e5\u9053 $y$ \u4e86\uff0c\u4e14 $y=n-x$\u3002\u6240\u4ee5\u5c31\u53ef\u4ee5\u5316\u7b80\u6210\u6c42 $x$ \u4e0e $n-x$ \u4e92\u8d28\u7684\u5bf9\u6570\uff0c\u4e5f\u5c31\u662f $x$ \u4e0e $n$ \u4e92\u8d28\u7684\u5bf9\u6570\uff0c\u4e5f\u5c31\u662f $\\varphi(n)$\u3002\u6240\u4ee5\u5c31\u53ef\u4ee5\u5f97\u5230 $f(n)=\\varphi(n)$\u3002\n\n\u518d\u6765\u770b $g(n)$\uff0c\u8fd9\u4e2a\u5c31\u5f88\u597d\u5316\u7b80\u4e86\u3002$g(n)=\\sum_{d|n}f(\\frac{n}{d})=\\sum_{d|n}\\varphi(\\frac{n}{d})=n$\uff0c\u8fd9\u4e2a\u5e94\u8be5\u662f\u6700\u57fa\u672c\u7684\u8bc1\u660e\u4e86\u7f62\u3002\n\n\u6240\u4ee5\u6700\u540e\u5c31\u53ef\u4ee5\u5f97\u5230 $F_k(n)$ \u5c31\u662f\u5bf9 $n$ \u6c42 $k$ \u6b21\u6b27\u62c9\u51fd\u6570\u7684\u503c\uff0c\u90a3\u76f4\u63a5\u6839\u53f7\u7684\u66b4\u529b\u5c31\u884c\u4e86\u3002\n\n## code\n```c++\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int MOD=1e9+7;\nint phi(int n)\n{\n\tint ans=n;\n\tfor(int i=2;i*i<=n;i++)\n\t{\n\t\tif(!(n%i))\n\t\t{\n\t\t\tans=(ans/i*(i-1));\n\t\t\twhile(!(n%i)) n/=i;\n\t\t}\n\t}\n\tif(n>1) ans=(ans/n*(n-1));\n\treturn ans;\n}\nint read()\n{\n    int s=0,w=1;\n    char ch=getchar();\n    while(ch<'0'||ch>'9') {if(ch=='-') w=-1;ch=getchar();}\n    while(ch>='0'&&ch<='9') {s=s*10+ch-'0';ch=getchar();}\n    return s*w;\n}\nvoid solve()\n{\n\tint n=read(),k=read();\n\tfor(int i=1;i<=(k+1)/2;i++)\n\t{\n\t\tif(n==1) break;\n\t\tn=phi(n);\n\t}\n\tprintf(\"%lld\",n%MOD);\n}\nsigned main()\n{\n\tsolve();\n\treturn 0;\n}\n\n\n```\n## The End",
        "postTime": 1683422335,
        "uid": 366400,
        "name": "Enderch",
        "ccfLevel": 5,
        "title": "\u6b27\u62c9\u51fd\u6570-The Holmes Children"
    },
    {
        "content": "$f(n)$\n\n$=\\sum_{i=1 \\to n-1}[gcd(i,n-i)=1]$\n\n$=\\sum_{i=1 \\to n-1}[gcd(i,n)=1]$\n\n$=\\phi(n)$\n\n$g(n)$\n\n$=\\sum_{d|n}f(d)$\n\n$=\\sum_{d|n}\\phi(d)$\n\n$=n$\n\n\u4e8e\u662f$F_k(n)$\u5373\u4e3a\u5c06$n$\u6c42$k$\u6b21\u6b27\u62c9\u51fd\u6570\u540e\u7684\u503c\u3002\u6ce8\u610f\u5230\u80fd\u4f7f$F_k(n)$\u4e0d\u4e3a$1$\u7684$k$\u662f$log n$\u7ea7\u522b\u7684\u3002\u6bcf\u6b21$O(\\sqrt{n})$\u66b4\u529b\u6c42\u6b27\u62c9\u51fd\u6570\u5373\u53ef\u3002\n\n\u4ee3\u7801\uff1a\n\n```\n\n#include<iostream>\n#include<cstdio>\n#include<cstdlib>\n#include<cstring>\n#include<string>\n#include<algorithm>\n#include<math.h>\nusing namespace std;\n\nlong long n,k;\n\nlong long phi(long long x)\n{\n\tint i;long long tx=x;\n\tfor(i=2;1LL*i*i<=x;++i)\n\t\tif(tx%i==0)\n\t\t{\n\t\t\twhile(tx%i==0) tx/=i;\n\t\t\tx=x/i*(i-1);\n\t\t}\n\tif(tx>1) x=x/tx*(tx-1);\n\treturn x;\n}\n\nint main()\n{\n\tlong long i;\n\tscanf(\"%lld%lld\",&n,&k);\n\tfor(i=1;i<=k;i+=2)\n\t{\n\t\tn=phi(n);\n\t\tif(n==1) break;\n\t}\n\tprintf(\"%lld\\n\",n%1000000007);\n\treturn 0;\n}\n\n```",
        "postTime": 1549070044,
        "uid": 31435,
        "name": "hwk0518",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF776E \u3010The Holmes Children\u3011"
    }
]
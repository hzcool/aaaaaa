[
    {
        "content": "\u9996\u5148\uff0c\u6839\u636e\u6570\u5217\u7684\u6784\u9020\u65b9\u5f0f\uff0c\u6211\u4eec\u53d1\u73b0\u5728\u7b2c $k + 1$ \u6b21\u64cd\u4f5c\u4e2d $S_i(0\\leq i < 2 ^ k)$ \u7ffb\u8f6c\u5f97\u5230 $S_{i + 2 ^ k}$\u3002\u5bf9\u4e8e\u67d0\u4e2a $i$\uff0c\u4ece $0$ \u5f00\u59cb\u4ece\u4f4e\u4f4d\u5230\u9ad8\u4f4d\u4e00\u6b65\u6b65\u6784\u9020\u5f97\u5230 $i$ \u53ef\u4ee5\u8bc1\u660e $S_i$ \u7b49\u4e8e $i$ \u5728\u4e8c\u8fdb\u5236\u4e0b $1$ \u7684\u4e2a\u6570\u7684\u5947\u5076\u6027\uff0c\u5373 $S_i = \\mathrm{popcount}(i)\\bmod 2$\u3002\u56e0\u6b64\uff0c\u95ee\u9898\u76f8\u5f53\u4e8e\u6c42 $\\sum\\limits_{i = 0} ^ {m - 1} (\\mathrm{popcount}(i \\oplus (i + n)) \\bmod 2)$\u3002\n\n\u8003\u8651 $i + n$ \u5728\u4e8c\u8fdb\u5236\u4e0b\u7684\u8ba1\u7b97\u65b9\u5f0f\uff0c\u6700\u4f4e\u7684 $i$ \u4f4d\u4f1a\u5bf9 $i + 1$ \u4ea7\u751f\u81f3\u591a $1$ \u7684\u8fdb\u4f4d\u8d21\u732e\u3002\u56e0\u6b64\uff0c\u8003\u8651\u6570\u4f4d DP\uff0c\u8bbe $f_{i, c, p, l}$ \u8868\u793a\u5f53\u524d\u8003\u8651\u5230\u7b2c $i$ \u4f4d\uff0c\u4f4e $i - 1$ \u4f4d\u5411\u7b2c $i$ \u4f4d\u8fdb\u4f4d $c$\uff0c\u5f53\u524d $\\mathrm{popcount}$ \u5947\u5076\u6027\u4e3a $p$\uff0c$l$ \u8868\u793a\u5f53\u524d\u662f\u5426\u88ab $m$ \u9650\u5236\u3002\n\n\u8f6c\u79fb\u679a\u4e3e\u7b2c $i - 1$ \u4f4d\u7684\u503c $v$ \u548c\u7b2c $i - 1$ \u4f4d\u5f97\u5230\u8fdb\u4f4d $cc$\uff0c\u8bbe $b$ \u4e3a $m$ \u5728\u7b2c $i - 1$ \u4f4d\u7684\u503c\uff0c$d$ \u4e3a $n$ \u5728\u7b2c $i - 1$ \u4f4d\u7684\u503c\u3002\u8003\u8651\u5927\u5c0f\u9650\u5236\uff0c\u82e5 $l = 1$ \u4e14 $b = 0$ \u4e14 $v = 1$ \u5219\u4e0d\u5408\u6cd5\u3002\u8003\u8651\u8fdb\u4f4d\u9650\u5236\uff0c\u82e5 $[v + d + cc \\geq 2]\\neq c$ \u5219\u4e0d\u5408\u6cd5\u3002\u5426\u5219 $f_{i, c, p, l}$ \u8f6c\u79fb\u5230 $f_{i - 1, cc, p \\oplus d\\oplus cc, l\\land [v = b]}$\uff0c\u56e0\u4e3a $i \\oplus (i + n)$ \u7684\u5f53\u524d\u4f4d\u4e3a $v \\oplus (v \\oplus d\\oplus cc)$\uff0c\u6240\u4ee5\u65b0\u7684 $\\mathrm{popcount}$ \u5373 $p \\oplus d \\oplus cc$\u3002\n\n\u7b54\u6848\u5373 $f_{0, 0, 1, 0}$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(T\\log n)$\u3002[\u4ee3\u7801](https://codeforces.com/contest/1734/submission/173376384)\u3002",
        "postTime": 1671168598,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "CF1734F Zeros and Ones"
    },
    {
        "content": "\u5c1d\u8bd5\u5199\u51fa $S$\uff1a\n$$\nS_i=\n\\begin {cases}\n0 &(i=0)\\\\\nS_{i-{\\rm hibit}(i)}\\oplus 1&(i \\neq 1)\n\\end {cases}\n$$\n\n\u7136\u540e\u53d1\u73b0 $S_i={\\rm popcount}(i)\\%2$\u3002\n\n\u4e8e\u662f\uff0c\u539f\u8be2\u95ee\u7684\u7b54\u6848\u7b49\u4ef7\u4e8e\u6709\u591a\u5c11\u4e2a\u6574\u6570 $x \\in [0,m-1]$\uff0c\u6ee1\u8db3 $S_{x}\\neq S_{x+n}$\uff0c\u5373 $x$ \u548c $x+n$ \u5728\u4e8c\u8fdb\u5236\u4e0b\u4e0d\u540c\u4f4d\u7684\u6570\u91cf\u662f\u5947\u6570\u3002\n\n\u8003\u8651\u7528\u6570\u4f4d dp \u5b8c\u6210\u8fd9\u4e00\u8fc7\u7a0b\u3002\n\n\u8bbe $f_{i,j,k}$ \u8868\u793a\u9009\u5230\u4e8c\u8fdb\u5236\u8868\u793a\u4e0b\u7684\u7b2c $i$ \u4f4d\uff08\u6700\u4f4e\u4f4d\u4e3a\u7b2c 0 \u4f4d\uff09\uff0c\u524d\u9762\u8fde\u7eed\u7684 1 \u7684\u4e2a\u6570\u7684\u5947\u5076\u6027\u4e3a $j$\uff0c\u524d\u9762\u7684\u53d8\u5316\u4f4d\u6570\u7684\u5947\u5076\u6027\u4e3a $k$ \u7684\u9009\u6cd5\u6570\u3002\n\n\u72b6\u6001\u6570\u662f $\\log n$ \u7ea7\u522b\uff0c\u590d\u6742\u5ea6 $O(T \\log n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntemplate <class T> inline void read(T &x) {\n\tx = 0; int f = 0; char ch = getchar();\n\twhile(!isdigit(ch))\n\t\tf |= ch == '-', ch = getchar();\n\twhile(isdigit(ch))\n\t\tx = x * 10 + ch - 48, ch = getchar();\n\tx = f ? -x : x; return;\n}\n#define inf 0x3f3f3f3f\n#define int long long\n#define fir first\n#define sec second\nint b[65], bsz, addb[65], asz;\nint f[65][2][2];\nint dfs(int p, int lim, int prlen, int st) {\n\tif(!~p) return st;\n\tif(!lim && ~f[p][prlen][st]) return f[p][prlen][st];\n\tint res = 0, up = (lim ? b[p] : 1);\n\tfor(int bit = 0; bit <= up; bit++) {\n\t\tint nb = bit ^ addb[p], pb = bit & addb[p];\n\t\tres += dfs(p - 1, lim && (bit == up), nb ? (!pb * prlen) ^ 1 : 0ll, st ^ (bit ^ nb) ^ (pb ? prlen ^ 1 : 0));\n\t}\n\tif(!lim) f[p][prlen][st] = res;\n\treturn res;\n}\nsigned main() {\n//\tfreopen(\"data.in\", \"r\", stdin);\n\tint T, n, m; read(T); while(T--) {\n\t\tread(n), read(m);\n\t\tmemset(f, -1, sizeof(f));\n\t\tmemset(b, 0, sizeof(b));\n\t\tmemset(addb, 0, sizeof(addb));\n\t\tint x = m - 1; bsz = -1; while(x) {\n\t\t\tb[++bsz] = x & 1;\n\t\t\tx >>= 1;\n\t\t}\n\t\tx = n; asz = -1; while(x) {\n\t\t\taddb[++asz] = x & 1;\n\t\t\tx >>= 1;\n\t\t}\n\t\tprintf(\"%lld\\n\", dfs(max(asz, bsz), 1, 0, 0));\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1667912504,
        "uid": 90027,
        "name": "GG_jok_er",
        "ccfLevel": 0,
        "title": "CF1734F Zeros and Ones \u9898\u89e3"
    },
    {
        "content": "**\u524d\u8a00**\n\n------------\n\n\u6709\u4e2a\u5c0f trick\uff0c\u4f1a\u4e86\u5dee\u4e0d\u591a\u5c31\u80fd\u505a\u4e86\u3002\n\n$O(n)$ \u505a\u6cd5\n\n------------\n\n\u8003\u8651\u66b4\u529b\u679a\u4e3e\u70b9\u5bf9\uff0c\u4e0d\u96be\u53d1\u73b0\u70b9\u5bf9 $(i,i+n)$ \u7684\u7ed3\u679c\u53ef\u4ee5\u8f6c\u5316\u4e3a $[\\text{popcount}(i \\oplus (i+n))\\mod 2]$\uff0c\u4e0d\u4f1a\u7684\u53ef\u4ee5\u60f3\u4e00\u60f3\uff0c\u5b83\u7684\u8f6c\u5316\u5c31\u662f\u6bcf\u6b21 $i=i-2^{\\lfloor log_2(i)\\rfloor}$\uff0c\u76f4\u5230 $i=0$ \u6240\u64cd\u4f5c\u7684\u6b21\u6570\uff0c\u663e\u7136\u5c31\u662f $\\text{popcount}$ \u7684\u610f\u601d\u3002\n\n$O(\\log_2^2 n)$ \u505a\u6cd5\n\n------------\n\n\u6253\u4e2a\u5173\u4e8e $i$ \u548c $j$ \u7684\u8868\uff0c\u6574\u51fa\u6765\u4e0b\u9762\u8fd9\u4e2a\u77e9\u9635\uff1a\n\n```\nxooxoxxooxxoxooxoxxox\noxxoxooxxooxoxxoxooxo\noxxoxooxxooxoxxoxooxo\nxooxoxxooxxoxooxoxxox\noxxoxooxxooxoxxoxooxo\nxooxoxxooxxoxooxoxxox\nxooxoxxooxxoxooxoxxox\noxxoxooxxooxoxxoxooxo\noxxoxooxxooxoxxoxooxo\nxooxoxxooxxoxooxoxxox\nxooxoxxooxxoxooxoxxox\noxxoxooxxooxoxxoxooxo\nxooxoxxooxxoxooxoxxox\noxxoxooxxooxoxxoxooxo\noxxoxooxxooxoxxoxooxo\nxooxoxxooxxoxooxoxxox\noxxoxooxxooxoxxoxooxo\nxooxoxxooxxoxooxoxxox\nxooxoxxooxxoxooxoxxox\noxxoxooxxooxoxxoxooxo\nxooxoxxooxxoxooxoxxox\n```\n\n\u6211\u4eec\u8981\u6c42\u7684\u70b9\u5bf9\u662f\u5dee\u503c\u76f8\u540c\u7684\uff0c\u4e5f\u5c31\u662f\u5728\u77e9\u9635\u4e0a\u7684\u4e00\u6761\u659c\u7ebf\u7684\u548c\u3002\n\n\u8bbe\u51fd\u6570 $f(i,j)$ \u8868\u793a\u4ece\u70b9\u5bf9 $(0,i)$ \u5230 $(j-1,i+j-1)$ \u8fd9\u6761\u659c\u7ebf\u7684\u548c\u3002\n\n\u6574\u4e2a\u77e9\u9635\u5176\u5b9e\u662f\u4e00\u4e2a\u4e8c\u7ef4\u7684 Thue-Morse\uff0c\u6240\u4ee5\u53ef\u4ee5\u53d1\u73b0\u4e0d\u540c\u7684\u659c\u7ebf\u662f\u53ef\u4ee5\u6709\u89c4\u5f8b\u5730\u62fc\u51d1\u800c\u6210\u7684\uff0c\u6700\u663e\u7136\u7684\u662f\u5f53 $i$ \u662f\u5076\u6570\u65f6\uff0c$f(i,j)=f(i/2,\\lfloor j/2 \\rfloor)+f(i/2,\\lceil j/2 \\rceil)$\u3002\u90a3\u4e48\u5f53 $i$ \u662f\u5947\u6570\u65f6\uff0c$f(i,j)=j-f(\\lfloor i/2 \\rfloor,\\lceil j/2 \\rceil)-f(\\lceil i/2 \\rceil,\\lfloor j/2 \\rfloor)$\u3002\n\n\u76f4\u63a5\u641e\u8fd8\u662f $O(n)$ \u7ea7\u522b\u7684\uff0c\u4f46\u662f\u53ef\u4ee5\u7528 $\\text{map}$ \u8bb0\u5fc6\u5316\u4e00\u4e0b\uff0c\u79d2\u53d8 $O(\\log_2^2 n)$\u3002",
        "postTime": 1664197103,
        "uid": 271260,
        "name": "PosVII",
        "ccfLevel": 7,
        "title": "CF1734F \u9898\u89e3"
    },
    {
        "content": "\n\u6839\u636e\u8fd9\u4e2a\u795e\u79d8\u751f\u6210\u65b9\u5f0f\uff0c\u6211\u4eec\u53d1\u73b0\u4e00\u4e2a\u628a\u4e00\u4e2a\u4e0b\u6807\u5199\u6210\u4e8c\u8fdb\u5236\uff0c\u90a3\u4e48\u5728\u67d0\u4e00\u4f4d\u4e0a\u628a $0$ \u53d8\u6210 $1$ \u540e\uff0c\u8fd9\u4e2a\u503c\u80af\u5b9a\u53d8\u4e86\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u6bcf\u4e00\u4f4d\u53d6\u503c\u548c\u4e0b\u6807\u4e8c\u8fdb\u5236\u7684 `popcount` \u5947\u5076\u6027\u662f\u76f8\u540c\u7684\u3002\u539f\u95ee\u9898\u8f6c\u5316\u4e3a\u7ed9\u5b9a $n,m$\uff0c\u6c42 $0$ \u81f3 $n$ \u4e2d\u6709\u591a\u5c11\u4e2a $x$\uff0c\u6ee1\u8db3 $x$ \u548c $x+m$ `popcount` \u5947\u5076\u6027\u4e0d\u540c\u3002\n\n\u5982\u679c $n$ \u662f\u4e8c\u7684\u5e42\u6b21\uff0c\u90a3\u4e48\u6570\u4f4d dp \u662f\u5bb9\u6613\u7684\uff0c$dp_i,0/1,0/1,0/1$ \u8868\u793a $x$ \u4e0e $x+m$ \u7b2c $i-1$ \u4f4d\u662f\u5426\u8fdb\u4f4d\uff0c\u4e14 $i-1$ \u4f4d `popcount` \u5947\u5076\u6027\u662f\u5426\u76f8\u540c\u3002\u503c\u5f97\u6ce8\u610f\u662f\u5b58\u5728 $m>n$ \u7684\u60c5\u51b5\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u8003\u8651 $m>n$ \u7684\u90e8\u5206\u7684 `popcount` \u5947\u5076\uff0c\u679a\u4e3e\u6700\u540e\u4e00\u4f4d\u662f\u5426\u8fdb\u4f4d\u548c\u5947\u5076\u6027\uff0c\u5c31\u53ef\u4ee5\u7edf\u8ba1\u7b54\u6848\u3002\n\n\u90a3\u4e48\u5f53 $n$ \u4e0d\u662f\u4e8c\u7684\u5e42\u6b21\u7684\u65f6\u5019\uff0c\u628a\u5b83\u62c6\u6210\u82e5\u5e72\u4e2a\u4e8c\u7684\u5e42\u6b21\uff0c\u7136\u540e\u53ef\u4ee5\u770b\u6210\u662f \u7ed9\u5b9a $n,m$\uff0c\u6c42 $0$ \u81f3 $n$ \u4e2d\u6709\u591a\u5c11\u4e2a $x$\uff0c\u6ee1\u8db3 $x+m1$ \u548c $x+m2$ `popcount` \u5947\u5076\u6027\u4e0d\u540c\uff0c\u8fd9\u91cc\u4e0d\u7406\u89e3\u53ef\u4ee5\u770b\u4ee3\u7801\uff0c\u76f8\u5f53\u4e8e\u628a\u5b83\u4e4b\u524d\u7b97\u4e86\u7684\u4e0b\u6807\u52a0\u8fdb\u6765\uff0c\u8fd9\u4e2a\u95ee\u9898\u539f\u6765\u7684 dp \u4ecd\u7136\u9002\u7528\u3002\n\n\u4ee3\u7801\u89c1 CF \u63d0\u4ea4\u3002",
        "postTime": 1665733039,
        "uid": 282751,
        "name": "cryozwq",
        "ccfLevel": 7,
        "title": "CF1734F Zeros and Ones \u9898\u89e3"
    },
    {
        "content": "### Problem Statement\n\u6709\u4e00\u4e2a\u65e0\u9650\u957f\u7684 01 \u4e32\uff0c\u5176\u751f\u6210\u65b9\u5f0f\u4e3a\uff1a  \n\u4e00\u5f00\u59cb\u4e3a\u4e00\u4e2a\u957f\u5ea6\u4e3a 1 \u7684 0\u3002  \n\u4e4b\u540e\u6bcf\u4e00\u6b21\u5c06\u81ea\u5df1 filp \u540e\u62fc\u63a5\u5230\u540e\u9762\u3002  \n\u73b0\u5728\u7ed9\u4f60 $n$ \u548c $m$\uff0c\u95ee\u4f60\u8fd9\u4e2a 01 \u4e32\u7684 $[0,m-1]$ \u548c $[n,n+m-1]$ \u4e24\u4e2a\u5b50\u4e32\u6709\u591a\u5c11\u4e2a\u4f4d\u7f6e\u76f8\u540c\u3002  \n### Solution  \n\u6211\u4eec\u5bb9\u6613\u53d1\u73b0\u4e00\u4e2a\u4f4d\u7f6e\u4e3a 0 \u8fd8\u662f 1 \u4e0e\u5176\u4f4d\u7f6e\u7684 $\\text{popcnt}$ \u6709\u5173\uff0c\u5f53 $\\text{popcnt}$ \u4e3a\u5076\u6570\u7684\u65f6\u5019\u4e3a 0\uff0c\u53cd\u4e4b\u4e3a 1\u3002  \n\n\u90a3\u4e48\u770b\u7740\u5982\u6b64\u5927\u7684\u6570\u636e\u8303\u56f4\uff0c\u4f60\u60f3\u5230\u4e86\u6570\u4f4d dp\u3002  \n\u7531\u4e8e\u4e0e $\\text{popcnt}$ \u76f8\u5173\uff0c\u8fd9\u4e2a\u6570\u4f4d\u80af\u5b9a\u4e3a\u4e8c\u8fdb\u5236\u6570\u4f4d\u3002  \n$[0,m-1]$ \u662f\u597d\u5904\u7406\u7684\uff0c\u56e0\u4e3a\u4ece 0 \u5f00\u59cb\uff0c\u4fbf\u4e8e\u8ba1\u7b97 $\\text{popcnt}$\u3002  \n\u800c $[n,n+m-1]$ \u5219\u662f $[0,m-1]$ \u7684\u57fa\u7840\u4e0a\u52a0\u4e0a\u4e00\u4e2a $n$\u3002  \n\n\u4e8e\u662f\u6211\u4eec\u628a $n$ \u7684\u6570\u4f4d\u4e5f\u641e\u51fa\u6765\uff0c\u52a0\u4e0a $n$ \u53ef\u4ee5\u76f4\u63a5\u5728 dp \u7684\u65f6\u5019\u505a\u4e00\u4e2a\u7c7b\u4f3c\u4e8e\u9ad8\u7cbe\u5ea6\u52a0\u6cd5\u7684\u4e1c\u897f\u540c\u65f6\u8ba1\u7b97 $[n,n+m-1]$ \u7684 $\\text{popcnt}$\uff0c\u8fd9\u65f6\u5019\u9700\u8981\u5145\u5206\u6fc0\u53d1\u6211\u4eec\u7684\u521b\u9020\u6027\u601d\u7ef4\uff0c\u4ee5\u5f80\u7684\u6570\u4f4d dp \u90fd\u662f\u4ece\u9ad8\u4f4d\u5f80\u4f4e\u4f4d\u8d70\uff0c\u4f46\u662f\u8fd9\u4e2a\u52a0\u6cd5\u5219\u9700\u8981\u4ece\u4f4e\u4f4d\u5411\u9ad8\u4f4d\u8d70\u3002  \n\n\u90a3\u4e48\u8bbe\u72b6\u6001 $f_{pos,x,y,z,limit}$ \u4e3a\u5f53\u524d\u9009\u5230 $pos$ \u4f4d\uff0c$x,y$ \u5206\u522b\u4ee3\u8868\u4e24\u4e2a\u4f4d\u7f6e\u76ee\u524d\u7684 $\\text{popcnt}$ \u4e3a\u5076\u6570\u8fd8\u662f\u5947\u6570\uff0c$z$ \u4e3a\u52a0\u6cd5\u662f\u5426\u8fdb\u4f4d\uff0c$limit$ \u7684\u5b9a\u4e49\u5219\u4e0d\u540c\u4e8e\u4e00\u822c\u7684\u6570\u4f4d dp\uff0c\u5176\u4ee3\u8868\u8fd9\u4e2a\u4f4d\u80fd\u4e0d\u80fd\u9009\u5927\u4e8e\u7b49\u4e8e\u8fd9\u4e2a\u4f4d\u4e0a\u7684\u6570\u7684\u6570\u3002  \n\u4ec0\u4e48\u65f6\u5019\u4e0d\u80fd\u9009\u5462\uff1f\u663e\u7136\u662f\u4f4e\u4f4d\u4e0a\u6709\u4e00\u4e2a\u540e\u7f00\uff0c\u8fd9\u4e2a\u540e\u7f00\u7684\u9009\u62e9\u7b2c\u4e00\u4e2a\u5927\u4e8e\uff0c\u5176\u4ed6\u7684\u5168\u90e8\u5927\u4e8e\u7b49\u4e8e\u5176\u4f4d\u4e0a\u7684\u6570\u7684\u60c5\u51b5\u4e0b\u3002  \n\ncode\uff1a  \n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nint T,n,m;\nint N[65],M[65];\nint f[65][2][2][2][2];\nbool vis[65][2][2][2][2];\nint dfs(int pos,int x,int y,int z,int limit){\n\tif(pos==61&&limit)return 0;\n\tif(pos==61&&x!=(y^z))return 1;\n\tif(pos==61)return 0;\n\tif(vis[pos][x][y][z][limit])\n\t\treturn f[pos][x][y][z][limit];\n\tvis[pos][x][y][z][limit]=1;\n\tint sz=M[pos];\n\tint u=z^N[pos];int res=0;\n\tfor(int i=0;i<=1;i++){\n\t\tint l=i>sz;if(limit&&i==sz)l=1;\n\t\tres+=dfs(pos+1,x^i,y^i^u,(i&&N[pos])||(i&&z)||(z&&N[pos]),l);\n\t}return f[pos][x][y][z][limit]=res;\n}\nvoid init(){\n\t\n}\nvoid solve(){\n\tcin>>n>>m;m--;\n\tfor(int i=0;i<=60;i++){\n\t\tN[i]=((n>>i)&1);\n\t\tM[i]=((m>>i)&1);\n\t\t//cout<<(n>>i)<<\" \"<<N[i]<<\" \"<<(m>>i)<<\" \"<<M[i]<<endl;\n\t}memset(f,0,sizeof(f));\n\tmemset(vis,0,sizeof(vis));\n\tcout<<dfs(0,0,0,0,0)<<endl;\n}\nsigned main(){\n\tios::sync_with_stdio(0);cin.tie(0);cout.tie(0);\n\tcin>>T;\n\twhile(T--)init(),solve();\n}\n\n```\n",
        "postTime": 1668067679,
        "uid": 213173,
        "name": "\u5c0f\u6728\u866b",
        "ccfLevel": 4,
        "title": "CF1734F Zeros and Ones \u9898\u89e3"
    },
    {
        "content": "\u5f88\u5947\u602a\u7684\u4e00\u79cd\u505a\u6cd5\uff0c\u4f46\u662f\u8fc7\u4e86\u3002\u597d\u50cf\u8ddf editorial \u7684\u9012\u5f52\u505a\u6cd5\u5dee\u4e0d\u591a\u3002\n\n## \u9898\u610f\n\n\u5b9a\u4e49 $S$ \u662f Thue-Morse sequence\uff0c\u6784\u9020\uff1a\n\n1. \u4e00\u5f00\u59cb $S=\\texttt{0}$\n2. \u7136\u540e\u628a $S$ \u6309\u4f4d\u53d6\u53cd\u4e4b\u540e\u62fc\u63a5\u5728 $S$ \u540e\u9762\n3. \u628a 2 \u91cd\u590d\u65e0\u9650\u591a\u6b21\n\n\u7136\u540e $q$ \u6b21\u8be2\u95ee\uff0c\u7ed9\u5b9a $n,m$\uff0c\u6c42 $S_{[0,m)}$ \u548c $S_{[n,n+m)}$ \u6709\u591a\u5c11\u4e2a\u4f4d\u4e0d\u540c\uff0c\u4e0b\u6807\u4ece $0$ \u5f00\u59cb\u3002\n\n## \u505a\u6cd5\n\n\u9996\u5148\u6ce8\u610f\u5230 $S_i$ \u5c31\u662f $i$ \u7684\u4e8c\u8fdb\u5236\u4e2d $1$ \u7684\u4e2a\u6570\u7684\u5947\u5076\u6027\u3002\n\n> \u8bc1\u660e\uff1a\u5bf9 $i$ \u5f52\u7eb3\u3002\u8bbe $i$ \u7684\u4e8c\u8fdb\u5236\u4e2d\u6700\u9ad8\u7684\u4e00\u4f4d\u662f $2^k$\uff0c\u90a3\u4e48 $2^k\\le n<2^{k+1}$\uff0c\u7531\u6784\u9020\u6709 $S_i$ \u4e0e $S_{i-2^k}$ \u76f8\u53cd\u3002$\\square$\n\n\u90a3\u4e48\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u5bf9\u591a\u5c11\u4e2a $0\\le i<m$ \u6709 $S_i\\ne S_{i+n}$. \u5206\u7c7b\u8ba8\u8bba $i$ \u7684\u5947\u5076\u6027\u3002\n\n\u82e5 $2|i$ \u90a3\u4e48\u8bbe $i=2k$\uff0c\u5c31\u6709 $S_i=S_k,S_{i+n}=S_{k+\\lfloor n/2\\rfloor}\\oplus (n\\bmod 2)$\uff08$\\oplus$ \u8bb0\u5f02\u6216\uff09\u3002\u90a3\u4e48\u6761\u4ef6\u5c31\u53d8\u4e3a $S_k\\ne S_{k+\\lfloor n/2\\rfloor}\\oplus(n\\bmod 2)$. \u7136\u540e\u95ee\u9898\u5c31\u88ab\u8f6c\u5316\u4e3a\u4e86 $\\dfrac{m}{2}$ \u89c4\u6a21\u7684\u95ee\u9898\u3002$2\\nmid i$ \u7684\u60c5\u51b5\u540c\u7406\u3002\n\n## \u65f6\u95f4/\u7a7a\u95f4\u590d\u6742\u5ea6\n\n\u6839\u636e\u4e0a\u9762\u7684\u8ba8\u8bba\u6211\u4eec\u77e5\u9053\u6bcf\u6b21 $(n,m)\\mapsto(\\lfloor n/2\\rfloor,\\lfloor (m+1)/2\\rfloor),(\\lfloor(n+1)/2\\rfloor,\\lfloor m\\rfloor)$\uff0c\u4ece\u800c\u6211\u4eec\u53ea\u9700\u8981\u6570 $m$ \u548c $n$ \u5206\u522b\u53ef\u80fd\u53d8\u6210\u54ea\u4e9b\u6570\u3002\n\n> \u5f15\u7406\uff1a\u6709\u6b63\u6574\u6570 $n$\uff0c\u6bcf\u6b21\u53ef\u4ee5\u628a\u5979\u53d8\u6210 $\\lfloor n/2\\rfloor$ \u6216\u8005 $\\lfloor (n+1)/2\\rfloor$\uff0c\u81f3\u591a\u53ef\u4ee5\u8fbe\u5230 $O(\\log n)$ \u4e2a\u6570\u3002\n\n\u8fd9\u91cc\u611f\u8c22 I_am_Accepted \u5927\u4f6c\u7684\u8bc1\u660e\u3002\n\n> \u8bc1\u660e\uff1a\u4e0d\u96be\u5bf9 $k$ \u5f52\u7eb3\u8bc1\u660e\uff0c\u64cd\u4f5c $k$ \u6b21\u53ef\u4ee5\u8fbe\u5230\u7684\u6570\u662f\u4e24\u4e2a\u76f8\u90bb\u7684\u6570\u3002\u800c\u64cd\u4f5c\u6b21\u6570\u81f3\u591a $O(\\log n)$\uff0c\u5373\u8bc1\u3002\n\n\u4ece\u800c\u6bcf\u6b21\u81f3\u591a\u8fbe\u5230 $O(\\log n\\log m)$ \u4e2a\u4e0d\u540c\u7684 $(n,m)$\uff0c\u4ece\u800c\u65f6\u95f4\u7a7a\u95f4\u90fd\u662f $O(q\\log n\\log m)$ \u7684\u3002\n\n## \u4ee3\u7801\n\n\u6ce8\u610f `unordered_map` \u8981\u9632 hack\u3002\u4ee3\u7801\u4e2d\u7684 `dfs(n, m, i)` \u8868\u793a\u6709\u591a\u5c11\u4e2a $0\\le j<m$ \u6ee1\u8db3 $S_j\\oplus S_{j+n}\\ne i$.\n\n```cpp\n// Let QwQ bless me. I love QwQ forever!\n \n#include <stdio.h>\n#include <stdint.h>\n#include <utility>\n#include <unordered_map>\n#include <chrono>\n#include <random>\n \n#pragma GCC optimize(\"-Ofast\")\n#pragma GCC target(\"avx2\")\n \nusing i32 = int32_t;\nusing i64 = int64_t;\nusing u32 = uint32_t;\nusing u64 = uint64_t;\n \nstruct hesh\n{\n    inline size_t operator()(std::pair<u64, u64> p) const\n    {\n        static const u64 r = std::chrono::high_resolution_clock().now().time_since_epoch().count();\n        u64 x = p.first + p.second * r;\n        x ^= r;\n        x ^= (x >> 29);\n        x *= 9;\n        return x;\n    }\n};\n \nstd::unordered_map<std::pair<u64, u64>, u64, hesh> umap;\n \nu64 solve(u64 n, u64 m, u64 i)\n{\n    if (i == 1) return m - solve(n, m, 0);\n    if (m == 0) return 0;\n    if (m == 1) return __builtin_parity(n) != 0;\n    if (umap.count({n, m})) return umap[{n, m}];\n    u64 ans = solve(n / 2, (m + 1) / 2, n % 2) + solve((n + 1) / 2, m / 2, n % 2);\n    umap[{n, m}] = ans;\n    return ans;\n}\n \nint main()\n{\n    int q; scanf(\"%d\", &q);\n    while (q--)\n    {\n        u64 n, m; scanf(\"%lld %lld\", &n, &m);\n        printf(\"%lld\\n\", solve(n, m, 0));\n    }\n}\n```",
        "postTime": 1666249066,
        "uid": 384214,
        "name": "esquigybcu",
        "ccfLevel": 0,
        "title": "CF1734F (\u5206\u6cbb\uff0c\u8bb0\u641c)"
    }
]
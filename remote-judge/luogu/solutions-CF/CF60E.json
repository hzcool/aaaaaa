[
    {
        "content": "\u77e9\u9635\u5feb\u901f\u5e42\u9898\u3002\u4e2a\u4eba\u8ba4\u4e3a\u53ef\u4ee5\u8bc4\u7eff\u3002\n\n## \u9898\u76ee\u5927\u610f\n\n\u4e00\u4e2a\u6570\u5217\u9012\u589e\u5e8f\u5217 $a$\uff0c\u6bcf\u79d2\u8fdb\u884c\u4e00\u6b21\u64cd\u4f5c\uff1a\u5728\u6570\u5217\u4e2d\u6bcf\u4e24\u4e2a\u76f8\u90bb\u5143\u7d20\u4e2d\u95f4\u52a0\u5165\u4e00\u4e2a\u65b0\u7684\u5143\u7d20\uff0c\u503c\u4e3a\u8fd9\u4e24\u4e2a\u5143\u7d20\u53ea\u548c\u3002\u8fd9\u6837\u7684\u64cd\u4f5c\u5171\u8fdb\u884c ${x}$ \u79d2\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u5c06\u64cd\u4f5c\u540e\u7684\u6570\u5217\u518d\u6b21\u5347\u5e8f\u6392\u5217\uff0c\u5e76\u91cd\u590d\u4e0a\u8ff0\u64cd\u4f5c ${y}$ \u79d2\u3002\u95ee\uff1a\u6700\u7ec8\u5e8f\u5217\u7684\u6743\u503c\u548c\u5bf9 ${p}$ \u53d6\u6a21\u7684\u503c\u3002\n\n## \u9898\u76ee\u5206\u6790\n\n\u53ef\u4ee5\u5148\u624b\u73a9\u4e00\u4e0b\u3002\n\n\u5c06\u7b2c ${i}$ \u6b21\u7684\u7ed3\u679c\u8bb0\u4e3a ${s_i}$\uff0c\u90a3\u4e48\u53ef\u4ee5\u53d1\u73b0 ${s_i = 3 \\times s_{i - 1} - a_1 - a_n}$\uff0c\u8fd9\u91cc\u53ef\u4ee5\u770b\u505a\u628a\u6bcf\u4e2a\u6570\u590d\u5236\u4e24\u4efd\uff0c\u5c06\u8fd9\u4e24\u4efd\u5206\u522b\u52a0\u5165\u5230\u5de6\u53f3\u4e24\u8fb9\u7684\u7a7a\u9699\u91cc\uff0c\u6700\u540e\u51cf\u53bb\u9996\u4f4d\u4e24\u4e2a\u6570\u3002\n\n\u800c ${s_1}$ \u6613\u5f97\u4e3a\u539f\u6570\u5217\u7684\u6743\u503c\u548c\u3002\u6240\u4ee5\u524d ${x}$ \u79d2\u7684\u7b54\u6848\u5c31\u53ef\u4ee5\u7528\u4e00\u4e2a\u77e9\u9635\u5feb\u901f\u5e42\u6765\u7b97\u3002\u5411\u91cf ${\\begin{bmatrix}\n s_i & d\n\\end{bmatrix}}$ \u7684\u6bcf\u4e2a\u5143\u7d20\u5206\u522b\u8868\u793a\u5f53\u524d\u7b54\u6848\u548c\u8981\u51cf\u53bb\u7684\u6570\u3002\uff08\u5f53\u7136\u7b2c\u4e00\u6b21\u8981\u51cf\u53bb\u7684\u5c31\u662f $a_1 - a_n$\uff0c\u540e\u9762\u4ee5\u6b64\u7c7b\u63a8\uff09\u3002\u53ef\u4ee5\u5f97\u5230\u4e0b\u9762\u7684\u8f6c\u79fb\u77e9\u9635\uff1a\n\n${\\begin{bmatrix}\n 3 & 0 \\\\\n -1 & 1\n\\end{bmatrix}}$\n\n\u524d $x$ \u79d2\u7b97\u5b8c\u4e4b\u540e\uff0c\u6211\u4eec\u53c8\u8981\u7b97\u540e ${y}$ \u79d2\u7684\u7b54\u6848\u3002\u663e\u7136\uff0c\u6211\u4eec\u53ef\u4ee5\u5957\u7528\u524d\u9762\u8ba1\u7b97 ${s_x}$ \u7684\u65b9\u6cd5\uff0c\u4f46\u6211\u4eec\u8981\u5148\u77e5\u9053\u6570\u5217\u7684\u4e24\u7aef\u662f\u591a\u5c11\u3002\u6839\u636e\u9898\u76ee\uff0c\u663e\u7136\u662f\u6570\u5217\u7684\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\u3002\n\n\u6700\u5c0f\u503c\u80af\u5b9a\u662f ${a_1}$\uff0c\u4f46\u662f\u6700\u5927\u503c\u4e0d\u77e5\u9053\u3002\n\n\u6839\u636e\u6bcf\u6b21\u4e2d\u95f4\u5143\u7d20\u662f\u4e24\u8fb9\u5143\u7d20\u76f8\u52a0\uff0c\u4f60\u4f1a\u60f3\u5230\u4ec0\u4e48\u5462\uff1f\u6ca1\u9519\uff0c\u5c31\u662f\u6590\u6ce2\u90a3\u5951\u6570\u5217\u3002\u6590\u6ce2\u90a3\u5951\u6570\u5217\u6bcf\u6b21\u53d6\u524d\u4e24\u4e2a\u6570\u76f8\u52a0\uff0c\u662f\u4e0d\u662f\u4e0e\u8fd9\u9053\u9898\u6709\u70b9\u50cf\u5462\uff1f\n\n\u624b\u63a8\u4e4b\u540e\u53d1\u73b0\u786e\u5b9e\u662f\u8fd9\u6837\uff08\u624b\u63a8\u8fc7\u7a0b\u5c31\u4e0d\u5199\u4e86\uff0c\u5927\u5bb6\u53ef\u4ee5\u968f\u4fbf\u627e\u4e24\u4e2a\u53d8\u91cf\u8bd5\u8bd5\u770b\uff09\uff0c\u6700\u5927\u503c\u5f53\u7136\u5c31\u662f $F_{x - 1} a_{n - 1} + F_{x} a_n$\uff0c\u5176\u4e2d $F_i$ \u8868\u793a\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7b2c $i$ \u9879\u3002\n\n\u4e4b\u540e\u5957\u7528\u8ba1\u7b97 $x$ \u7684\u516c\u5f0f\u5373\u53ef\u3002\n\n## \u4ee3\u7801\u793a\u4f8b\n\n```cpp\n#include <algorithm>\n#include <iostream>\n#include <cstring>\n#include <cstdio>\n#define int long long\n#define rep(i, a, b) for (int i = (a); i <= (b); i ++ )\n#define rop(i, a, b) for (int i = (a); i < (b); i ++ )\n#define dep(i, a, b) for (int i = (a); i >= (b); i -- )\n#define dop(i, a, b) for (int i = (a); i > (b); i -- )\n \nusing namespace std;\n \nusing LL = long long;\nusing PII = pair<int, int>;\nusing PLL = pair<LL, LL>;\n \nconst int N = 1000010;\nint w[N], n, x, y, mod;\nstruct Matrix {\n    int a[2][2];\n    void clear(int x) {memset(a, x, sizeof a);}\n    void makeI() { a[0][0] = 1; a[0][1] = 0; a[1][0] = 0; a[1][1] = 1; }\n    bool empty() {return ((a[0][0] == 1) and (a[0][1] == 0) and (a[1][0] == 0) and (a[1][1] == 1));}\n    void init(int _00, int _01, int _10, int _11) {\n    \ta[0][0] = _00, a[0][1] = _01, a[1][0] = _10, a[1][1] = _11;\n\t}\n\t\n\tMatrix operator + (const Matrix& B) {\n\t    Matrix res; res.clear(0);\n\t    for (int i = 0; i <= 1; i ++ )\n\t        for (int j = 0; j <= 1; j ++ )\n\t            res.a[i][j] = (a[i][j] + B.a[i][j]) % mod;\n\t    return res;\n\t}\n\tMatrix operator * (const Matrix& B) {\n\t    Matrix res; res.clear(0);\n\t    for (int i = 0; i <= 1; i ++ )\n\t        for (int j = 0; j <= 1; j ++ )\n\t            for (int k = 0; k <= 1; k ++ )\n\t                (res.a[i][j] += (a[i][k] * B.a[k][j])) %= mod;\n\t    return res;\n\t}\n\tMatrix &operator += (Matrix B) { *this = *this + B; return *this; }\n\tMatrix &operator *= (Matrix B) { *this = *this * B; return *this; }\n};\nMatrix operator ^ (Matrix A, int b) {\n    Matrix res; res.makeI();\n    while (b) {\n        if (b & 1) res = res * A;\n        A = A * A; b >>= 1;\n    }\n    return res;\n}\n\nint calc(int sum, int minn, int maxn, int k) {\n\tMatrix t; t.init(3, 0, -1, 1); t = t ^ k;\n\tMatrix ans; ans.init(sum % mod, (minn + maxn) % mod, 0, 0); ans *= t;\n\treturn ans.a[0][0];\n}\nMatrix f(int x) {\n\tMatrix t; t.init(0, 1, 1, 1); if (x < 0) return t; t = t ^ x;\n\tMatrix ans; ans.init(1, 1, 0, 0); return ans * t;\n}\n \nsigned main() {\n\tscanf(\"%lld%lld%lld%lld\", &n, &x, &y, &mod);\n\tfor (int i = 1; i <= n; i ++ )\n\t\tscanf(\"%lld\", &w[i]);\n\tint sum = 0;\n\tfor (int i = 1; i <= n; i ++ )\n\t\t(sum += w[i]) %= mod;\n\t\n\tint sum_x = calc(sum, w[1] % mod, w[n] % mod, x);\n\tMatrix F = f(x - 1);\n\t\n\tint sum_y = calc(sum_x, w[1], w[n - 1] * F.a[0][0] % mod + w[n] * F.a[0][1] % mod, y);\n\tprintf(\"%lld\\n\", (sum_y + mod) % mod);\n\treturn 0;\n}\n```\n\n\u662f\u76ee\u524d\u7684\u6700\u4f18\u89e3\uff0c\u4e0d\u8fc7\u76f8\u4fe1\u5f88\u5feb\u5c31\u4f1a\u88ab\u6253\u4e0b\u53bb\u3002",
        "postTime": 1675157851,
        "uid": 519384,
        "name": "Link_Cut_Y",
        "ccfLevel": 0,
        "title": "CF60E \u9898\u89e3"
    },
    {
        "content": "[\u9898\u9762](https://www.luogu.com.cn/record/63701562)\n\n\u70b9\u6570\uff1a2600\n\nupd 2022.8.30\uff1a\u4fee\u6b63\u4e86\u4e00\u4e9b\u95ee\u9898\n\n##### \u6807\u7b7e\uff1a\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316 dp\n\n##### \u5206\u6790\uff1a\n\n\u6ce8\u610f\u5230\u6570\u636e\u8303\u56f4\u5927\u5230\u79bb\u8c31\uff0c\u663e\u7136\u8981\u5bf9\u6570\u7ea7\u522b\u7684\u7b97\u6cd5\u3002\n\n\u6ce8\u610f\u6bcf\u6b21\u4e24\u4e2a\u8611\u83c7\u4e4b\u95f4\u4f1a\u957f\u51fa\u4e00\u4e2a\u5927\u5c0f\u7b49\u4e8e\u4ed6\u4eec\u4e4b\u548c\u7684\u8611\u83c7\uff0c\u6240\u4ee5\u6bcf\u6b21\u7684\u7b54\u6848\u662f\u539f\u6765\u76843\u500d\u51cf\u53bb\u5934\u548c\u5c3e\u3002\n\n\u5373\uff1a$sum=sum\\times3-del$\u3002\n\n\u518d\u7ed3\u5408\u590d\u6742\u5ea6\u8ba1\u7b97\uff0c\u4e2a\u4eba\u8ba4\u4e3a\u60f3\u5230\u77e9\u9635\u5feb\u901f\u5e42\u4e0d\u96be\u3002\n\n\u8fd9\u4e2a\u8ba1\u7b97\u5e94\u8be5\u4e0d\u7b97\u96be\uff0c\u4f46\u63a8\u51fa\u7684\u8f6c\u79fb\u77e9\u9635\u5728\u4e0b\u9762\u3002\n\n$\\begin{matrix}3&0\\\\-1&1\\end{matrix}$\n\n\u6ce8\u610f\u524d\u9762\u51cf\u53bb\u7684\u503c\u548c\u5730\u7cbe\u56de\u6765\u641e\u4e8b\u60c5\u4e4b\u540e\u7684\u662f\u4e0d\u4e00\u6837\u7684\u3002\uff0c\u540e\u9762\u7684 $del$ \u8981\u7528\u6590\u6ce2\u90a3\u5951\u6570\u5217\u8ba1\u7b97\u3002\n\n\u4ee3\u7801\uff08\u8bf7\u52ff\u6284\u88ad\uff09\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define mem(a,b) memset(a,b,sizeof(a));\n#define pc putchar\n#define fast_iostream ios::sync_with_stdio(0),cin.tie(0),cout.tie(0)\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double ld;\ntypedef double db;\nconst ld EPS=1e-8;\nconst ll INF=ll(1e9+7);\nconst ll LLINF=ll(1e18+7);\nconst ld LDEPS=1e-18;\nconst ll MAXN=1e6+7;\ninline ll max(ll x,ll y){return x>y?x:y;}\ninline ll min(ll x,ll y){return x<y?x:y;}\ninline ld dmax(ld x,ld y){return x>y?x:y;}\ninline ld dmin(ld x,ld y){return x<y?x:y;}\ninline ll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\ninline ll lcm(ll a,ll b){return a*b/gcd(a,b);}\ninline ll lowbit(ll x){return x&(-x);}\ninline ll read(){ll read_result=0,is_below_0=0;char now_ch=0;while(!isdigit(now_ch)){is_below_0|=now_ch=='-';now_ch=getchar();}while(isdigit(now_ch)){read_result=(read_result<<3)+(read_result<<1)+(now_ch^48);now_ch=getchar();}return is_below_0?-read_result:read_result;}\ninline ld dread(){ld x=0,d=0.1;char f=0,ch=getchar();while(!isdigit(ch))f|=(ch=='-'),ch=getchar();while(isdigit(ch)) x=x*10+ch-48,ch=getchar();if(ch=='.'){ch=getchar();while(isdigit(ch))x+=d*(ch^48),d*=0.1,ch=getchar();}return f?-x:x;}\ninline void write(ll x){if(x<0){putchar('-');x=-x;}if(x>9){write(x/10);}putchar(x%10+'0');}\nll n,x,y,p,MOD,a[MAXN],del,sum;\nconst ll MAXM=7;//\u77e9\u9635\u9636 \nstruct Matrix\n{\n\tll m[MAXM][MAXM];\n\tMatrix(){memset(m,0,sizeof(m));}\n\tMatrix operator +(const Matrix& xx)\n\t{\n\t\tMatrix res;\n\t\tfor(ll i=0;i<MAXM;i++)\n\t\t\tfor(ll j=0;j<MAXM;j++)\n\t\t\t\tres.m[i][j]=(m[i][j]+xx.m[i][j])%MOD;\n\t\treturn res;\n\t}\n\tMatrix operator *(const Matrix& b)\n\t{\n\t\tMatrix result;\n\t\tfor(ll i=0;i<MAXM;i++)\n\t\t\tfor(ll j=0;j<MAXM;j++)\n\t\t\t\tfor(ll k=0;k<MAXM;k++)\n\t\t\t\t\tresult.m[i][j]=(result.m[i][j]+m[i][k]*b.m[k][j]%MOD+MOD)%MOD;\n\t\treturn result;\n\t}\n\tMatrix operator ^(ll b)\n\t{\n\t\tMatrix result,Base;\n\t\tfor(ll i=0;i<MAXM;i++)result.m[i][i]=1;\n\t\tfor(ll i=0;i<MAXM;i++)for(ll j=0;j<MAXM;j++)Base.m[i][j]=m[i][j];\n\t\twhile(b)\n\t\t{\n\t\t\tif(b&1)result=result*Base;\n\t\t\tBase=Base*Base;\n\t\t\tb>>=1;\n\t\t}\n\t\treturn result;\n\t}\n}mian,fibo,lxy,now,ans;\nll num[MAXM],aaa[MAXM];\nint main()\n{\n \t//freopen(\".in\",\"r\",stdin);\n    //freopen(\".out\",\"w\",stdout);\n\tn=read(),x=read(),y=read(),p=read();MOD=p;\n\tfor(ll i=1;i<=n;i++)\n\t{\n\t\ta[i]=read()%MOD;\n\t\tsum=(sum+a[i])%p;\n\t}\n\tif(n==1)\n\t{\n\t\twrite(sum);\n\t\treturn 0;\n\t}\n\tmian.m[0][0]=3,mian.m[1][0]=-1,mian.m[1][1]=1;\n\tnum[0]=a[n-1],num[1]=a[n];\n\tfibo.m[0][0]=0,fibo.m[0][1]=1,fibo.m[1][0]=1,fibo.m[1][1]=1;\n\tans.m[0][0]=sum;ans.m[0][1]=(a[1]+a[n])%MOD;\n\tnow=mian^x;\n\tMatrix abab=ans*now;\n\tans=abab;\n//\tcout<<ans.m[0][0]<<' '<<ans.m[0][1]<<'\\n';\n\tif(!x)\n\t{\n\t\tans.m[0][1]=a[n];\n\t}\n\telse if(x==1)ans.m[0][1]=(a[n-1]+a[n])%MOD;\n\telse\n\t{\n\t\tfibo=fibo^x;\n\t\tfor(ll i=0;i<2;i++)\n\t\t{\n\t\t\tfor(ll j=0;j<2;j++)\n\t\t\t{\n\t\t\t\taaa[i]=(aaa[i]+(num[j]*fibo.m[j][i])%MOD)%MOD;\n\t\t\t}\n\t\t}\n\t\tans.m[0][1]=aaa[1]%MOD;\n\t}\n//\tcout<<ans.m[0][0]<<' '<<aaa[1]<<'\\n';\n\tans.m[0][1]=(ans.m[0][1]+a[1])%MOD;\n\tmian=mian^y;\n\tabab=ans*mian;\n\tif(y)ans=abab;\n\twrite((ans.m[0][0]+MOD)%MOD);\n\treturn 0;\n}\n```\n\n\n\n",
        "postTime": 1637994757,
        "uid": 395288,
        "name": "Yuby",
        "ccfLevel": 6,
        "title": "CF60E\u9898\u89e3"
    },
    {
        "content": "## \u4e00\u70b9\u5e9f\u8bdd\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF60E)\n\n[My blog](https://www.luogu.com.cn/blog/128433/#)\n\n\u8c03\u4ee3\u7801\u8c03\u5230\u6000\u7591\u4eba\u751f\uff0c\u6700\u540e\u53d1\u73b0\u662f\u6700\u5927\u6570\u627e\u9519\u4e86\u2026\u2026\n\n## \u601d\u8def\n\n\u7531\u4e8e\u5730\u7cbe\u5403\u4e86\u4e00\u6b21\u996d\u540e\u56de\u6765\u641e\u4e8b\u60c5\uff0c\u6240\u4ee5\u5f97\u628a\u4e24\u6bb5\u5206\u5f00\u6765\u8ba1\u7b97\u3002\n\n~~\u6709\u75c5~~\n\n\u5148\u5904\u7406\u5403\u996d\u524d\u7684\u4e00\u6bb5\uff1a\n\n\u5047\u8bbe\u7b2c $x$ \u5206\u949f\u65f6\u6709 $m$ \u4e2a\u8611\u83c7\uff0c\u8611\u83c7\u91cd\u91cf\u4e3a $a_1,a_2 \\ldots a_m$\uff0c\u603b\u91cd\u91cf\u4e3a $\\sum_{i=1}^m a_i$\uff0c\u8bb0\u4f5c $sum_x$\uff0c$sum_0$ \u5c31\u662f\u5f00\u59cb\u65f6\u6240\u6709\u8611\u83c7\u7684\u603b\u91cd\u91cf\u3002\n\n\u663e\u7136 $a_1,a_m$ \u5206\u522b\u662f $x=0$ \u65f6\u7684\u5de6\u53f3\u8611\u83c7\u91cd\u91cf\u3002\n\n\u90a3\u4e48\u4e0b\u4e00\u79d2\u5c31\u4f1a\u957f\u51fa $m-1$ \u4e2a\u8611\u83c7\uff1a$a_1+a_2,a_2+a_3 \\ldots a_{m-1}+a_m$\uff0c\u8fd9\u4e9b\u65b0\u957f\u51fa\u7684\u8611\u83c7\u603b\u91cd\u91cf\u4e3a $\\sum_{i=1}^{m-1}(a_i+a_{i+1})$\u3002\n\n\u6b64\u65f6\u7684\u603b\u91cd\u91cf\u4e3a\uff1a\n\n$$\n\\begin{aligned} sum_{x+1} & = sum_x + \\sum_{i=1}^{m-1} (a_i+a_{i+1}) \\\\\n\n& = sum_x + \\sum_{i=1}^m a_i +\\sum_{i=2}^{m-1}a_i \\\\\n\n& = sum_x + 2 * \\sum_{i=1}^m a_i - a_1 - a_m \\\\\n\n& = sum_x + 2*sum_x - a_1 -a_m \\\\\n\n& = 3*sum_x - a_1 - a_m\n\n\\end{aligned}\n$$\n\n\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u5173\u4e8e $\\{sum_i\\}$ \u7684\u9012\u63a8\u5f0f\uff1a\n\n$sum_i = 3*sum_{i-1} - a_1 - a_n$\n\n\u5728\u5730\u7cbe\u4eec\u5403\u5b8c\u7b2c\u4e00\u6b21\u996d\u524d\u8611\u83c7\u7684\u603b\u91cd\u91cf\u5c31\u662f $sum_x$\uff0c\u624b\u63a8\u5c01\u95ed\u5f62\u5f0f\u6216\u8005\u77e9\u9635\u90fd\u53ef\u4ee5\u8ba1\u7b97\uff0c~~\u50cf\u6211\u8fd9\u4e48\u61d2\u80af\u5b9a\u9009\u62e9\u590d\u5236\u77e9\u9635\u6a21\u677f~~\u3002\n\n\u518d\u770b\u5403\u5b8c\u540e\u7684\u60c5\u51b5\uff1a\n\n\u7531\u4e8e\u5730\u7cbe\u91cd\u65b0\u6392\u4e86\u4e00\u6b21\u5e8f\uff0c\u6240\u4ee5\u9700\u8981\u91cd\u65b0\u627e\u5230 $a_1$ \u548c $a_m$\u3002\n\n$a_1$ \u7b80\u5355\u554a\uff0c\u5c31\u662f $t=0$ \u65f6\u7684\u6700\u5c0f\u503c\uff0c\u6076\u5fc3\u7684\u662f $a_m$\uff0c\u4e5f\u5c31\u662f $t=x$ \u65f6\u7684\u6700\u5927\u503c\u3002\n\n\u7a0d\u52a0\u601d\u7d22\u5c31\u53ef\u4ee5\u77e5\u9053\uff0c$a_m$ \u5728\u6392\u5e8f\u524d\u80af\u5b9a\u5904\u4e8e $t=0$ \u65f6\u6700\u5927\u503c\u548c\u6b21\u5927\u503c\u4e4b\u95f4\uff0c\u4ee4 $p,q$ \u5206\u522b\u4e3a $t=0$ \u65f6\u7684\u6700\u5927\u503c\u548c\u6b21\u5927\u503c\uff0c\u624b\u63a8\u4e00\u4e0b $p$ \u548c $q$ \u4e4b\u95f4\u7684\u5e8f\u5217\uff1a\n\n- $t=0$\uff0c\u5e8f\u5217\u4e3a $p,q$\n\n- $t=1$\uff0c\u5e8f\u5217\u4e3a $p,p+q,q$\n\n- $t=2$\uff0c\u5e8f\u5217\u4e3a $p,2p+q,p+q,p+2q,q$\n\n- $t=3$\uff0c\u5e8f\u5217\u4e3a $p,3p+q,2p+q,3p+2q,p+q,2p+3q,p+2q,p3q,q$\n\n\u89c2\u5bdf\u5f97\u5230 $t>0$ \u65f6\uff0c\u6700\u5927\u503c\u53ef\u4ee5\u8868\u793a\u6210 $Fib_t*p+Fib_{t-1}*q$\uff0c\u5176\u4e2d $Fib$ \u4e3a $Fib_0=Fib_1=1$ \u7684\u6590\u6ce2\u90a3\u5951\u6570\u5217\uff0c\u4fe1\u4e0d\u8fc7\u7684\u53ef\u4ee5\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bc1\u660e\u4e00\u4e0b\uff0c~~\u4f46OIer\u8c01\u8bc1\u660e\u554a~~\u3002\n\n\u90a3\u4e48\u7528\u77e9\u9635\u5feb\u901f\u5e42\u5c31\u80fd\u6c42\u51fa\u6700\u5927\u503c\u4e86\u3002\n\n## \u4ee3\u7801\n\n\u4e3a\u4e86\u65b9\u4fbf\u505a\u9898\uff0c\u6211\u628a\u77e9\u9635\u8fd0\u7b97\u5c01\u88c5\u4e86\u4e00\u4e0b\n\n```cpp\nmatrix a,b,c,d,f;//a\u4e3asum\u7684\u7cfb\u6570\u77e9\u9635\uff0cb[1][1]\u4e3a\u8611\u83c7\u603b\u91cd\u91cf\uff0cb[2][1]\u4e3aa1+am\uff0cd\u3001f\u7528\u4e8e\u6c42\u7b2c\u4e8c\u6b21\u7684a1+am\nll n,x,y,ma,mi=1145141919810,cnt;\nint main()\n{\n\tn=read(),x=read(),y=read(),maxn=read();\n\ta.n=a.m=2;\n\td.n=b.n=2,d.m=b.m=1;\n\tf.n=f.m=2;\n\tf[1][1]=f[1][2]=f[2][1]=1;\n\ta[1][1]=3;\n\ta[1][2]=-1;\n\ta[2][2]=1;\n\tll xx=0;\n\tfor (register int i=1;i<=n;++i)\n\t{\n\t\tll tmp=read();\n\t\tif (i==1 || i==n)\n\t\t\tcnt=(cnt+tmp)%maxn;\n\t\tif (i==1)\n\t\t\tmi=tmp;\n\t\tif (i==n)\n\t\t\tma=tmp;\n\t\tif (i==n-1)\n\t\t\txx=tmp;\n\t\tb[1][1]=(b[1][1]+tmp)%maxn;\n\t}\n\tif (n==1)\n\t{\n\t\twrite(ma%maxn);\n\t\treturn 0;\n\t}\n\tb[2][1]=cnt%maxn;\n\tc=a^x;\n\tb=c*b;//\u5403\u996d\u524d\n\td[1][1]=ma,d[2][1]=xx;\n\tif (!x)\n\t\tb[2][1]=ma;\n\telse if (x==1)\n\t\t\tb[2][1]=ma+xx;\n\t\telse\n\t\t{\n\t\t\tf=f^(x-1);\n\t\t\td=f*d;\n\t\t\tb[2][1]=d.sum();\n\t\t}\n\tb[2][1]=(b[2][1]+mi)%maxn;\n//\tif (x)\n//\t{\n//\t\tll tmp=0;\n//\t}\n//\telse\n//\t\tb[2][1]=(ma%maxn+mi%maxn)%maxn;\n\tc=a^y;\n\tb=c*b;//\u5403\u996d\u540e\n\twrite((b[1][1]+maxn)%maxn);\n\treturn 0;\n}\n```\n",
        "postTime": 1634307079,
        "uid": 128433,
        "name": "C6H14",
        "ccfLevel": 7,
        "title": "\u3010\u9898\u89e3\u3011CF60E"
    }
]
[
    {
        "content": "### $\\text{Difficulty : 1700}$\n\n---\n### \u89e3\u9898\u601d\u8def\uff1a\n\n\u672c\u8d28\u4e0a\u662f\u4e0d\u65ad\u8fdb\u884c\u4e00\u4e2a\u56fa\u5b9a\u7684\u7f6e\u6362\u3002\n\n\u8003\u8651\u5bf9\u4e8e\u4e00\u4e2a\u4f4d\u7f6e\u8fde\u7eed\u8be2\u95ee\u4e24\u6b21\uff0c\u5982\u679c\u7b2c\u4e00\u6b21\u5f97\u5230\u7684\u7b54\u6848\u4e3a $a$\uff0c\u800c\u7b2c\u4e8c\u6b21\u5f97\u5230\u7684\u7b54\u6848\u4e3a $b$\uff0c\u6839\u636e\u9898\u76ee\u7ed9\u51fa\u7684\u64cd\u4f5c\u6709\uff1a$p_a=b$\u3002\u4e3a\u4e86\u8282\u7ea6\u8be2\u95ee\u6b21\u6570\uff0c\u4e0d\u59a8\u4e00\u76f4\u76ef\u7740\u4e00\u4e2a\u4f4d\u7f6e\u4e00\u76f4\u8be2\u95ee\u76f4\u5230\u51fa\u73b0\u4e4b\u524d\u51fa\u73b0\u8fc7\u7684\uff0c\u76f4\u63a5\u6e05\u9664\u4e00\u4e2a\u73af\u3002\n\n\u6700\u574f\u60c5\u51b5\u662f $p_i=i$\uff0c\u8fd9\u6837\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u90fd\u9700\u8981\u8be2\u95ee\u4e24\u6b21\uff0c\u603b\u6b21\u6570\u4e3a $2n$\uff0c\u6070\u597d\u5361\u5230\u4e0a\u9650\uff0c\u6ce8\u610f\u4e0d\u8981\u6709\u591a\u4f59\u64cd\u4f5c\u3002\n\n---\n### \u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\nusing namespace std;\nint T,ans[10005],rec[10005],cnt,n;\nvoid ask(int x,int y){\n\tprintf(\"? %d\\n\",x);\n\tfflush(stdout);\n\tscanf(\"%d\",&rec[y]);\n}\nint main(){\n\tscanf(\"%d\",&T);\n\twhile(T--){\n\t\tscanf(\"%d\",&n);\n\t\tfor(int i=1;i<=n;i++)ans[i]=0;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tif(ans[i]!=0)continue;\n\t\t\task(i,1);ask(i,2);cnt=2;\n\t\t\twhile(rec[cnt]!=rec[1])ask(i,++cnt);\n\t\t\tfor(int i=1;i<cnt;i++)ans[rec[i]]=rec[i+1];\n\t\t}\n\t\tprintf(\"! \");\n\t\tfor(int i=1;i<=n;i++)\n\t\tprintf(\"%d \",ans[i]);\n\t\tprintf(\"\\n\");\n\t\tfflush(stdout);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1646311232,
        "uid": 223559,
        "name": "qxp101",
        "ccfLevel": 6,
        "title": "CF1621C Hidden Permutations \u9898\u89e3"
    },
    {
        "content": "## Description\n\u4ea4\u4e92\u9898\uff0c\u731c\u4e00\u4e2a\u6392\u5217 $p$\uff08$n\\le 10000$\uff09\u3002\u521d\u59cb\u6709\u4e00\u4e2a\u6392\u5217 $q_i = i$\uff0c\u6bcf\u6b21\u53ef\u4ee5\u8be2\u95ee\u4e00\u4e2a $q_i$ \u7684\u503c\uff0c\u4ea4\u4e92\u5e93\u56de\u7b54\u4f60\u7684\u8be2\u95ee\u4e4b\u540e\u4f1a\u5c06 $q$ \u66ff\u6362\u6210 $q_i' = q_{p_i}$\u3002\u6700\u591a $2n$ \u6b21\u8be2\u95ee\uff0c\u6c42\u51fa $p$\u3002\n## Solution\n\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u5bf9 $q$ \u65bd\u52a0 $q_i = q_{p_i}$ \u7684\u53d8\u6362\u8fd9\u4e00\u8fc7\u7a0b\u7684\u672c\u8d28\u662f\u4e00\u4e2a\u7f6e\u6362\u3002\u4e0d\u59a8\u76ef\u7740\u4e00\u4e2a $q_i$ \u4e0d\u653e\uff0c\u6211\u4eec\u53d1\u73b0\u5176\u53d8\u6362\u4e0b\u53bb\u4e4b\u540e\u4f1a\u4e3a $p_i, p_{p_i}, p_{p_{p_i}},\\cdots$ \u4f1a\u5f62\u6210\u4e00\u4e2a\u73af\uff0c\u73af\u4e0a $u\\to v$ \u8868\u793a $p_u = v$\u3002\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u6bcf\u6b21\u76ef\u7740\u4e00\u4e2a\u6ca1\u6709\u6c42\u51fa\u7b54\u6848\u7684\u4e0b\u6807\u8be2\u95ee\uff0c\u628a\u8fd9\u90e8\u5206\u73af\u627e\u5230\uff0c\u8fd9\u9898\u5c31\u89e3\u51b3\u4e86\u3002\n\n\u8be2\u95ee\u6b21\u6570\u7684\u4e0a\u754c\u521a\u597d\u4e3a $2n$\uff0c\u5361\u7684\u5f88\u51c6\u3002\u5b9e\u9645\u89e3\u51b3\u8fd9\u9053\u9898\u76ee\u65f6\u5343\u4e07\u8bb0\u5f97\u6253\u8868\u627e\u89c4\u5f8b\uff0c\u53ef\u4ee5\u52a0\u5feb\u627e\u5230\u7b54\u6848\u7684\u8fc7\u7a0b\u3002\n## Implementation\n\n```cpp\nconst int maxn = 1e4 + 5;\nint n, vis[maxn], ans[maxn];\n\nint ask(int i) {\n    cout << \"? \" << i << endl;\n    int x; cin >> x;\n    return x;\n}\n\nint main() {\n    int T; cin >> T;\n    while (T--) {\n        cin >> n;\n        FOR(i, 1, n) vis[i] = 0;\n        FOR(i, 1, n) {\n            if (vis[i]) continue;\n            vector<int> vec;\n            int st = ask(i);\n            vec.push_back(st);\n            int u;\n            do {\n                u = ask(i);\n                vec.push_back(u);\n            } while (u != st);\n            FOR(j, 0, (int)vec.size() - 2) {\n                ans[vec[j]] = vec[j + 1];\n                vis[vec[j]] = 1;\n            }\n        }\n        cout << \"! \";\n        FOR(i, 1, n) cout << ans[i] << ' ';\n        cout << endl;\n    }\n    return 0;\n}\n```\n\n",
        "postTime": 1641297229,
        "uid": 212488,
        "name": "\u6e05\u70db",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 1621C Hidden Permutations"
    }
]
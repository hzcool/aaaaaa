[
    {
        "content": "\u677f\u5b50\u9898\uff0c\u4e3a\u5565\u6ca1\u4eba\u5199\u9898\u89e3\u554a\u3002\n\n## \u9898\u610f\n\n\u6709 $n$ \u53ea\u9a6f\u9e7f\uff0c\u6bcf\u53ea\u9a6f\u9e7f\u6709\u4e00\u4e2a\u5f97\u5206 $a_i$\u3002\u7ed9\u5b9a\u4e00\u4e2a\u5173\u7cfb\u56fe\uff0c$a$ \u5411 $b$ \u8fde\u8fb9\u7b49\u4ef7\u4e8e $a$ \u6700\u540e\u7684\u5f97\u5206\u8981\u6bd4 $b$ \u5c0f\uff0c\u4f60\u53ef\u4ee5\u8fdb\u884c\u82e5\u5e72\u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u7ed9\u4e00\u53ea\u9a6f\u9e7f\u7684\u5f97\u5206\u52a0\u51cf\u4e00\uff0c\u6c42\u6ee1\u8db3\u9700\u6c42\u7684\u6700\u5c0f\u64cd\u4f5c\u6b21\u6570\u3002\n\n$2\\leqslant n\\leqslant 1000,1\\leqslant m\\leqslant 1000,1\\leqslant a_i\\leqslant 10^9$\n\n## \u5206\u6790\n\n\u4fdd\u5e8f\u56de\u5f52\u3002 \n\n\u6211\u4eec\u5bf9\u6240\u6709\u9a6f\u9e7f\u7684\u5f97\u5206\u6574\u4f53\u4e8c\u5206\uff0c\u4e0d\u59a8\u8bbe\u6211\u4eec\u76ee\u524d\u786e\u5b9a\u4e86\u70b9\u96c6 $S$ \u7684\u5f97\u5206\u5728 $[l,r]$ \u5185\uff0c\u8003\u8651\u600e\u4e48\u5224\u65ad\u54ea\u4e9b\u70b9\u5f97\u5206\u5927\u4e8e $mid$\u3002\n\n\u6839\u636e\u8bba\u6587\u4e2d\u7684\u7ed3\u8bba\u53ef\u4ee5\u77e5\u9053\u6700\u540e\u7684\u65b9\u6848\u4e2d\u5927\u4e8e $mid$ \u7684\u70b9\u7b49\u4e8e\u70b9\u6743\u5728 $[mid,mid+1]$ \u5185\u8dd1\u51fa\u7684\u65b9\u6848\u4e2d\u5927\u4e8e $mid$ \u7684\u70b9\u3002\n\n\u8f6c\u5316\u6210\u53ea\u6709\u4e24\u79cd\u70b9\u6743\u53d6\u503c\uff0c\u8fd9\u662f\u7ecf\u5178\u7684\u6700\u5927\u95ed\u5408\u5b50\u56fe\u6a21\u578b\uff0c\u6211\u4eec\u8dd1\u4e00\u8fb9\u7f51\u7edc\u6d41\u5373\u53ef\u6c42\u51fa\u65b9\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2m\\log n)$\u3002\n\n## \u4ee3\u7801\n```\n#include<stdio.h>\n#include<queue>\n#include<algorithm>\n#include<string.h>\n#define int long long\n#define inf 10000000000000000\nusing namespace std;\nconst int maxn=1005,maxm=6005;\nint n,m,s,t,e=1,flg,ans;\nint start[maxn],to[maxm],then[maxm],limit[maxm],dep[maxn],vis[maxn],a[maxn],xx[maxn],yy[maxn],id[maxn],b[maxn],g[maxn][maxn],d[maxn];\nqueue<int>q;\ninline void add(int x,int y,int z) {\n\tthen[++e]=start[x],start[x]=e,to[e]=y,limit[e]=z;\n}\ninline void addedge(int x,int y,int z) {\n\tadd(x,y,z),add(y,x,0);\n}\ninline int cmp(int a,int b) {\n\treturn d[a]<d[b];\n}\nint bfs(int s,int t) {\n\tfor(int i=1; i<=t; i++)\n\t\tdep[i]=inf,vis[i]=0;\n\tdep[s]=0,vis[s]=1,q.push(s);\n\twhile(!q.empty()) {\n\t\tint x=q.front();\n\t\tvis[x]=0,q.pop();\n\t\tfor(int i=start[x]; i; i=then[i]) {\n\t\t\tint y=to[i];\n\t\t\tif(limit[i]&&dep[y]>=dep[x]+1) {\n\t\t\t\tdep[y]=dep[x]+1;\n\t\t\t\tif(vis[y]==0)\n\t\t\t\t\tvis[y]=1,q.push(y);\n\t\t\t}\n\t\t}\n\t}\n\treturn dep[t]!=inf;\n}\nint dfs(int x,int flw,int t) {\n\tif(x==t) {\n\t\tflg=1,ans+=flw;\n\t\treturn flw;\n\t}\n\tint rest=flw;\n\tfor(int i=start[x]; i; i=then[i]) {\n\t\tint y=to[i];\n\t\tif(limit[i]&&dep[y]==dep[x]+1) {\n\t\t\tint newflw=dfs(y,min(limit[i],rest),t);\n\t\t\tif(newflw) {\n\t\t\t\trest-=newflw,limit[i]-=newflw,limit[i^1]+=newflw;\n\t\t\t\tif(rest==0)\n\t\t\t\t\tbreak;\n\t\t\t} else dep[y]=0;\n\t\t}\n\t}\n\treturn flw-rest;\n}\nint Dinic(int s,int t) {\n\tans=0;\n\twhile(bfs(s,t))\n\t\tfor(flg=1; flg;)\n\t\t\tflg=0,dfs(s,inf,t);\n\treturn ans;\n}\nvoid solve(int l,int r,int L,int R) {\n\tif(L>R)\n\t\treturn ;\n\tif(l==r) {\n\t\tfor(int i=L; i<=R; i++)\n\t\t\tb[id[i]]=l;\n\t\treturn ;\n\t}\n\tint mid=(l+r)>>1;\n\te=1,memset(start,0,sizeof(start));\n\tfor(int i=L; i<=R; i++)\n\t\tfor(int j=L; j<=R; j++)\n\t\t\tif(g[id[i]][id[j]])\n\t\t\t\taddedge(i,j,inf);\n\tfor(int i=L; i<=R; i++) {\n\t\tint p=abs(a[id[i]]-mid-1),q=abs(a[id[i]]-mid);\n\t\tif(p>=q)\n\t\t\taddedge(s,i,p-q);\n\t\telse addedge(i,t,q-p);\n\t}\n\tDinic(s,t);\n\tfor(int i=L; i<=R; i++)\n\t\td[id[i]]=dep[i];\n\tsort(id+L,id+1+R,cmp);\n\tint pos=R;\n\tfor(int i=L; i<=R; i++)\n\t\tif(d[id[i]]==inf) {\n\t\t\tpos=i-1;\n\t\t\tbreak;\n\t\t}\n\tsolve(l,mid,L,pos),solve(mid+1,r,pos+1,R);\n}\nsigned main() {\n\tscanf(\"%lld%lld\",&n,&m),s=n+1,t=s+1;\n\tfor(int i=1; i<=n; i++)\n\t\tscanf(\"%lld\",&a[i]),id[i]=i;\n\tfor(int i=1,x,y; i<=m; i++)\n\t\tscanf(\"%lld%lld\",&x,&y),g[y][x]=1;\n\tsolve(-1e15,1e15,1,n);\n\tfor(int i=1; i<=n; i++)\n\t\tprintf(\"%lld%c\",b[i],i==n? '\\n':' ');\n\treturn 0;\n}\n```",
        "postTime": 1643621469,
        "uid": 105611,
        "name": "IdnadRev",
        "ccfLevel": 0,
        "title": "\u3010??\u8bb0\u5f55\u3011CF1615H Reindeer Games"
    }
]
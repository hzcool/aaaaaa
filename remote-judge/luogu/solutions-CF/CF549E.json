[
    {
        "content": "> [CF549E Sasha Circle](https://codeforces.com/contest/549/problem/E)\n\n## \u9898\u610f\n\n- $n+m$ \u4e2a\u6574\u70b9\u3002\n- \u8be2\u95ee\u662f\u5426\u5b58\u5728\u4e00\u4e2a\u5706\u5c06\u524d $n$ \u4e2a\u70b9\u548c\u540e $m$ \u4e2a\u70b9\u4e25\u683c\u5206\u5f00\u3002\n- $n,|x|,|y| \\le 10^4$\u3002\n\n## \u9898\u89e3\n\n\u8bbe $A$ \u4e3a\u524d $n$ \u4e2a\u70b9\u7684\u96c6\u5408\uff0c$B$ \u4e3a\u540e $m$ \u4e2a\u70b9\u7684\u96c6\u5408\uff0c\u4e0d\u59a8\u8bbe\u5706\u5185\u4e3a $A$\u3002\n\n\u9996\u5148\u53ef\u4ee5\u53d1\u73b0\u7b2c\u4e00\u4e2a\u6027\u8d28\uff1a\n\n\u9898\u76ee\u8981\u6c42**\u4e25\u683c\u5206\u5f00**\uff0c\u5b9e\u9645\u4e0a\u76f8\u5f53\u4e8e\u627e\u5230\u4e00\u4e2a\u5706\uff0c\u4f7f $A$ \u5728\u5706\u5185**\u6216\u5706\u4e0a**\uff0c\u800c $B$ \u90fd\u5728\u5706\u5916\u3002\n\n\u56e0\u4e3a\u5982\u679c\u80fd\u627e\u5230\uff0c\u90a3\u4e48\u610f\u5473\u7740\u53ef\u4ee5\u5c06\u8fd9\u6837\u4e00\u4e2a\u5706\u7a0d\u7a0d\u653e\u5927\uff0c\u4ece\u800c\u505a\u5230**\u4e25\u683c\u5206\u5f00**\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u8fd8\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u5706\u5c3d\u91cf\u7f29\u5c0f\uff0c\u4f7f\u5f97**\u81f3\u5c11**\u6709\u4e24\u4e2a $A$ \u4e2d\u7684\u70b9\u5728\u5706\u4e0a\u3002\n\n\u90a3\u4e48\u5c31\u6709\u4e00\u4e2a\u6734\u7d20\u505a\u6cd5\uff1a\n\n\u679a\u4e3e\u8fd9\u4e24\u4e2a\u5728\u5706\u4e0a\u7684\u70b9\uff0c\u90a3\u4e48\u5706\u5fc3\u53ea\u80fd\u5728\u8fd9\u4e24\u4e2a\u70b9\u7684**\u4e2d\u5782\u7ebf**\u4e0a\uff0c\u800c\u5176\u4ed6\u70b9\u662f\u5426\u5728\u5706\u5916\u53ef\u4ee5\u8f6c\u5316\u4e3a\u5bf9\u5706\u5fc3\u7684\u9650\u5236\uff0c\u5982\u679c\u5b58\u5728\u6ee1\u8db3\u6240\u6709\u9650\u5236\u7684\u5706\u5fc3\uff0c\u5219\u5b58\u5728\u4e00\u4e2a\u7b26\u5408\u8981\u6c42\u7684\u5706\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal O(n^2(n+m))$\u3002\u540c\u65f6\uff0c\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0d\u5fc5\u7b97\u51fa\u5706\u5fc3\uff0c\u800c\u662f\u5bf9**\u5706\u5468\u89d2\u7684\u4f59\u5207\u503c**\u52a0\u4ee5\u9650\u5236\uff0c\u800c\u89d2\u7684\u4f59\u5207\u503c\u6b63\u597d\u7b49\u4e8e\u70b9\u79ef\u9664\u4ee5\u53c9\u79ef\uff0c\u6613\u4e8e\u8ba1\u7b97\u3002\n\n\u8003\u8651\u4f18\u5316\uff0c\u53ef\u4ee5\u53d1\u73b0\u5e76\u4e0d\u9700\u8981\u5bf9\u6240\u6709 $A$ \u4e2d\u7684\u70b9\u5bf9\u8fdb\u884c\u4e00\u6b21\u4e0a\u8ff0\u64cd\u4f5c\u3002\n\n\u5efa\u7acb\u4e00\u4e2a\u4e09\u7ef4\u5750\u6807\u7cfb\uff0c\u5c06 $A,B$ \u653e\u5728 $z=0$ \u7684\u5e73\u9762\u4e0a\u3002\n\n\u4f5c\u4e00\u4e2a\u629b\u7269\u9762 $z = x^2 + y^2$\uff0c\u5c06 $A,B$ \u5782\u76f4\u6295\u5f71\u5230\u8fd9\u4e2a\u629b\u7269\u9762\u4e0a\u5f97\u5230 $A_0, B_0$\u3002\n\n\u8003\u8651\u4efb\u610f\u4e00\u4e2a\u4e0d\u5782\u76f4\u4e14\u4e0e\u629b\u7269\u9762\u6709\u4ea4\u7684\u5e73\u9762 $z = ax + by + c$\uff0c\u4e0e\u629b\u7269\u9762\u7684\u89e3\u6790\u5f0f\u8054\u7acb\u53ef\u4ee5\u5f97\u5230 $x^2 + y^2 - ax - by - c = 0$\uff0c\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u5706\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5f97\u5230\u4e00\u6761\u91cd\u8981\u7684\u6027\u8d28\uff1a\u5e73\u9762\u4e0a\u7684\u5706\u4e0e\u4e0d\u5782\u76f4\u4e14\u4e0e\u629b\u7269\u9762\u6709\u4ea4\u7684\u5e73\u9762**\u4e00\u4e00\u5bf9\u5e94**\u3002\n\n\u90a3\u4e48\uff0c\u95ee\u9898\u8f6c\u5316\u4e3a\uff0c\u80fd\u5426\u627e\u5230\u4e00\u4e2a\u4e0d\u5782\u76f4\u4e14\u4e0e\u629b\u7269\u9762\u6709\u4ea4\u7684\u5e73\u9762\uff0c\u4f7f\u5f97 $A_0$ \u90fd\u5728\u6b64\u5e73\u9762\u4e0b\u65b9\u6216\u6b64\u5e73\u9762\u4e0a\uff0c$B_0$ \u90fd\u4e25\u683c\u5728\u6b64\u5e73\u9762\u4e0a\u65b9\u3002\n\n\u6b64\u65f6\u663e\u7136\u53ea\u9700\u8981\u4fdd\u7559 $A_0$ \u7684\u4e0a\u51f8\u58f3\uff0c\u53c8\u7531\u4e8e $z = x^2 + y^2$ \u662f\u4e0b\u51f8\u7684\uff0c\u6240\u4ee5 $A_0$ \u7684\u4e0a\u51f8\u58f3\u4e00\u5b9a\u662f $A$ \u7684\u51f8\u5305\u7684\u4e00\u4e2a**\u4e09\u89d2\u5256\u5206**\u5728\u629b\u7269\u9762\u4e0a\u7684\u6295\u5f71\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u5bf9\u8fd9\u4e2a\u4e09\u89d2\u5256\u5206\u4e2d\u7684\u6bcf\u4e00\u6761\u8fb9\u8fdb\u884c\u4e00\u6b21\u6734\u7d20\u505a\u6cd5\u5373\u53ef\uff0c\u56e0\u4e3a\u6700\u7ec8\u8981\u6c42\u7684\u5706\u5728\u629b\u7269\u9762\u4e0a\u7684\u6295\u5f71\u4e00\u5b9a\u53ef\u4ee5\u7ecf\u8fc7\u4e00\u6761\u4e0a\u51f8\u58f3\u4e2d\u7684\u68f1\uff0c\u800c\u6bcf\u6761\u68f1\u90fd\u5bf9\u5e94\u7740\u4e09\u89d2\u5256\u5206\u4e2d\u7684\u4e00\u6761\u8fb9\u3002\n\n\u7531\u4e8e\u6574\u70b9\u51f8\u5305\u7684\u70b9\u6570\u4e0a\u754c\u4e3a $\\mathcal O(C^{\\frac 23})$\uff0c\u5176\u4e2d $C$ \u662f\u503c\u57df\uff0c\u56e0\u6b64\u8fd9\u4e2a\u505a\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal O(C^{\\frac 23}(n + m))$\u3002\n\n\u8fd8\u5269\u4e0b\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u4f55\u5728\u53ef\u63a5\u53d7\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e0b\u6c42\u51fa $A_0$ \u7684\u4e0a\u51f8\u58f3\uff0c\u5373 $A$ \u7684\u51f8\u5305\u7684\u4e00\u4e2a\u7279\u5b9a\u7684\u4e09\u89d2\u5256\u5206\uff1f\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u4e2a\u4e0a\u51f8\u58f3\u6bcf\u4e00\u4e2a\u9762\u5728 $z = 0$ \u7684\u6295\u5f71\u90fd\u6ee1\u8db3**\u6240\u6709\u9876\u70b9\u5171\u5706**\u4e14**\u5916\u63a5\u5706\u5305\u542b $A$ \u4e2d\u7684\u6240\u6709\u70b9**\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u4e00\u5f00\u59cb\u968f\u4fbf\u786e\u5b9a\u51f8\u5305\u7684\u4e00\u6761\u8fb9 $p_1,p_2$\uff0c\u7136\u540e\u627e\u5230\u51f8\u5305\u4e0a\u7684\u53e6\u4e00\u4e2a\u9876\u70b9 $p_k$ \u4f7f $p_1,p_2,p_k$ \u786e\u5b9a\u7684\u5706\u6700\u5927\u3002\u663e\u7136\u6b64\u65f6\u8fd9\u4e2a\u5706\u4e00\u5b9a\u5305\u542b\u51f8\u5305\u7684\u6240\u6709\u9876\u70b9\uff0c\u56e0\u6b64\u8981\u6784\u9020\u7684\u4e09\u89d2\u5256\u5206\u4e2d\u4e00\u5b9a\u6709 $p_1,p_2,p_k$ \u8fd9\u4e2a\u4e09\u89d2\u5f62\u3002\u7136\u540e\u539f\u95ee\u9898\u8f6c\u5316\u6210\u7531 $p_1p_k$ \u548c $p_2p_k$ \u5272\u5f00\u7684\u4e24\u4e2a\u89c4\u6a21\u66f4\u5c0f\u7684\u5b50\u95ee\u9898\uff0c\u5206\u6cbb\u9012\u5f52\u6c42\u89e3\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(C^{\\frac 43})$\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(C^{\\frac 43} + C^{\\frac 23}(n + m))$\u3002\n\n## \u4ee3\u7801\n\n```cpp\nconst ld eps = 1e-10L, PI = acos(-1);\n\nstruct P {\n\tint x, y;\n\tinline P() {}\n\tinline P(int x, int y) : x(x), y(y) {}\n\tinline P &operator += (P o) { return x += o.x, y += o.y, *this; }\n\tinline P &operator -= (P o) { return x -= o.x, y -= o.y, *this; }\n\tinline friend P operator + (P a, P b) { return a += b; }\n\tinline friend P operator - (P a, P b) { return a -= b; }\n\tinline friend bool operator < (P a, P b) { return a.x == b.x ? a.y < b.y : a.x < b.x; }\n\tinline friend int operator * (P a, P b) { return a.x * b.x + a.y * b.y; }\n\tinline friend int operator % (P a, P b) { return a.x * b.y - a.y * b.x; }\n};\n\nconst int N = 1e4 + 7;\nint n, m, t;\nP a[N], b[N], c[N];\n\ninline bool chk(P x, P y) {\n\tld l = -1e100L, r = 1e100L;\n\tfor (int i = 1; i <= n; i++) {\n\t\tP o = a[i];\n\t\tif (!((x - o) % (y - o))) continue;\n\t\tld w = 1.0L * ((x - o) * (y - o)) / ((x - o) % (y - o));\n\t\tif ((o - x) % (y - x) < 0) l = max(l, w);\n\t\telse r = min(r, w);\n\t}\n\tfor (int i = 1; i <= m; i++) {\n\t\tP o = b[i];\n\t\tif (!((x - o) % (y - o))) {\n\t\t\tif (o.x >= min(x.x, y.x) && o.x <= max(x.x, y.x) && o.y >= min(x.y, y.y) && o.y <= max(x.y, y.y)) return 0;\n\t\t\tcontinue;\n\t\t}\n\t\tld w = 1.0L * ((x - o) * (y - o)) / ((x - o) % (y - o));\n\t\tif ((o - x) % (y - x) > 0) l = max(l, w);\n\t\telse r = min(r, w);\n\t}\n\treturn l + eps < r;\n}\n\ninline bool dfs(int l, int r) {\n\tif (l + 1 == r) return 0;\n\tint x;\n\tld k = 1e100L;\n\tfor (int i = l + 1; i < r; i++) {\n\t\tP o = c[i];\n\t\tld w = 1.0L * ((o - c[l]) * (o - c[r])) / ((o - c[l]) % (o - c[r]));\n\t\tif (w < k) x = i, k = w;\n\t}\n\treturn chk(c[l], c[x]) || chk(c[r], c[x]) || dfs(l, x) || dfs(x, r);\n}\n\ninline bool pd() {\n\tt = 0;\n\tfor (int i = 1; i <= n; i++) {\n\t\twhile (t > 1 && (c[t] - c[t-1]) % (a[i] - c[t-1]) <= 0) --t;\n\t\tc[++t] = a[i];\n\t}\n\tint o = t;\n\tfor (int i = n - 1; i; i--) {\n\t\twhile (t > o && (c[t] - c[t-1]) % (a[i] - c[t-1]) <= 0) --t;\n\t\tc[++t] = a[i];\n\t}\n\t--t;\n\treturn chk(c[1], c[t]) || dfs(1, t);\n}\n\nint main() {\n\trd(n), rd(m);\n\tif (n == 1 || m == 1) return prints(\"YES\"), 0;\n\tfor (int i = 1, x, y; i <= n; i++) rd(x), rd(y), a[i] = P(x, y);\n\tfor (int i = 1, x, y; i <= m; i++) rd(x), rd(y), b[i] = P(x, y);\n\tsort(a + 1, a + n + 1), sort(b + 1, b + m + 1);\n\tprints(pd() || (swap(a, b), swap(n, m), pd()) ? \"YES\" : \"NO\");\n\treturn 0;\n}\n```",
        "postTime": 1575092910,
        "uid": 100544,
        "name": "xht",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF549E \u3010Sasha Circle\u3011"
    }
]
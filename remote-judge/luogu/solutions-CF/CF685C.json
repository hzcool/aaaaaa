[
    {
        "content": "# CF685C Optimal Point\n\n\u8fd9\u4e2a\u9898\uff0c\u6211\u770b\u5230\u7684\u7b2c\u4e00\u773c\u4ee5\u4e3a\u662f\u4e2a\u4e09\u5206\u3002\u56e0\u4e3a $x$ \u8f74\u56fa\u5b9a\u4e00\u4e2a\u4f4d\u7f6e\uff0c$y$ \u8f74\u56fa\u5b9a\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u53bb\u626b $z$ \u8f74\uff0c\u4f1a\u53d1\u73b0\u8ddd\u79bb\u662f\u4e00\u4e2a\u5355\u5cf0\u7684\u51fd\u6570\uff0c\u5bf9\u4e8e $x$ \u8f74\u548c $y$ \u8f74\u4e5f\u7c7b\u4f3c\u5904\u7406\uff0c\u7c7b\u4f3c [UVA10228](https://www.luogu.com.cn/problem/UVA10228) \u7684\u5904\u7406\u65b9\u5f0f\u5373\u53ef\u3002\u90a3\u4e48\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u4e2a $O(n \\log^3 v)$ \u7684\u505a\u6cd5\uff0c\u800c\u4e14\u662f\u6b63\u786e\u7684\u3002\u4f46\u662f\u770b\u4e00\u773c\u6570\u636e\u89c4\u6a21\uff0c$n=10^5,v=10^{18}$\uff0c\u4f1a\u88ab\u5361\u6389\uff0c\u8fd9\u5c31\u5f88\u4ee4\u4eba\u4e0d\u723d\u3002\n\n\u7136\u540e\u6211\u4eec\u770b\u4e00\u773c\u9898\u610f\uff0c\u5b83\u662f\u8981\u6c42\u8ddd\u79bb\u7684\u6700\u5927\u503c\u6700\u5c0f\uff0c\u800c\u6700\u5927\u503c\u6700\u5c0f\u53c8\u53ef\u4ee5\u63d0\u793a\u6211\u4eec\u8fd9\u4e2a\u9898\u53ef\u80fd\u9700\u8981\u4e8c\u5206\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5f88\u663e\u7136\u5730\u53bb\u4e8c\u5206\u8fd9\u4e2a\u6700\u5927\u8ddd\u79bb $dis$\uff0c\u7136\u540e\u5c31\u6709 $n$ \u7ec4\u7ea6\u675f\u6761\u4ef6 $|x-x_i|+|y-y_i|+|z-z_i| \\leq dis$\n\n\u6211\u4eec\u4f1a\u53d1\u73b0\u8fd9\u662f\u4e2a\u5f88\u4e0d\u597d\u5904\u7406\u7684\u4e0d\u7b49\u5f0f\u5173\u7cfb\u7ec4\uff0c\u56e0\u4e3a\u6709\u4e00\u5806\u53d8\u91cf\uff0c\u8fd8\u5957\u4e2a\u7edd\u5bf9\u503c\u3002\u6211\u4eec\u8003\u8651\u62c6\u7edd\u5bf9\u503c\uff0c\u6839\u636e\u6b63\u8d1f\u5173\u7cfb\uff0c\u5e94\u8be5\u4f1a\u5f97\u5230 $2^3=8$ \u7ec4\u4e0d\u7b49\u5f0f\u5173\u7cfb\uff1a\n\n$\\begin{cases}x+y+z-x_i-y_i-z_i \\leq dis \\\\ x+y-z-x_i-y_i+z_i \\leq dis \\\\ x-y+z-x_i+y_i-z_i \\leq dis \\\\ x-y-z-x_i+y_i+z_i \\leq dis \\\\ -x+y+z+x_i-y_i-z_i \\leq dis \\\\ -x+y-z+x_i-y_i+z_i \\leq dis \\\\ -x-y+z+x_i+y_i-z_i \\leq dis \\\\ -x-y-z+x_i+y_i+z_i \\leq dis\\end{cases}$\n\n\u770b\u8d77\u6765\u662f\u7ec4\u5f88\u6050\u6016\u7684\u5f0f\u5b50\u3002\u8003\u8651\u79fb\u9879\u5408\u5e76\uff0c\u5219\u6709\uff1a\n\n$\\begin{cases} l_1 \\leq x+y+z \\leq r_1 \\\\ l_2 \\leq -x+y+z \\leq r_2 \\\\ l_3 \\leq x-y+z \\leq r_3 \\\\ l_4 \\leq x+y-z \\leq r_4\\end{cases}$\n\n\u5176\u4e2d $l_{1 \\dots 4},r_{1 \\dots 4}$ \u5728\u540e\u7eed\u8ba1\u7b97\u4e2d\u53ef\u88ab\u89c6\u4f5c\u5e38\u6570\uff0c\u5206\u522b\u4e3a\uff1a\n\n$\\begin{cases}l_1=\\max(-mid+x_i+y_i+z_i)\\\\l_2=\\max(-mid-x_i+y_i+z_i)\\\\l_3=\\max(-mid+x_i-y_i+z_i)\\\\l_4=\\max(-mid+x_i+y_i-z_i)\\end{cases}$\n\n$\\begin{cases}r_1=\\min(-mid+x_i+y_i+z_i)\\\\r_2=\\min(-mid-x_i+y_i+z_i)\\\\r_3=\\min(-mid+x_i-y_i+z_i)\\\\r_4=\\min(-mid+x_i+y_i-z_i)\\end{cases}$\n\n\u8fd9\u91cc\u7684 $\\max()$ \u548c $\\min()$ \u5176\u5b9e\u672c\u8d28\u4e0a\u662f\u7ed9\u533a\u95f4\u53d6\u4ea4\u96c6\u3002\n\n\u6211\u4eec\u8003\u8651\u6362\u5143\uff0c\u4ee4 $a=-x+y+z,b=x-y+z,c=x+y-z$\uff0c\u90a3\u4e48\u53ef\u4ee5\u4ee3\u6362\u51fa\n\n$\\begin{cases}x=\\frac{b+c}{2}\\\\y=\\frac{a+c}{2}\\\\z=\\frac{a+b}{2}\\\\x+y+z=a+b+c\\end{cases}$\n\n\u6211\u4eec\u8fd8\u4f1a\u53d1\u73b0\u53e6\u5916\u4e00\u70b9\uff0c\u5c31\u662f $a,b,c$ \u7684\u5947\u5076\u6027\u662f\u4e00\u81f4\u7684\uff0c\u56e0\u4e3a $a,b,c$ \u7684\u5947\u5076\u6027\u53d6\u51b3\u4e8e $x,y,z$ \u7684\u5947\u5076\u6027\uff0c\u7b26\u53f7\u53ea\u662f\u589e\u52a0\u6216\u8005\u51cf\u5c11\u4e86\u4e24\u500d\u7684 $x$ \u6216 $y$ \u6216 $z$\uff0c\u4e0d\u5f71\u54cd\u5bf9 $2$ \u53d6\u6a21\u7684\u4f59\u6570\u3002\u8fd9\u4e5f\u5c31\u544a\u8bc9\u4e86\u6211\u4eec\uff0c\u5176\u5b9e\u6211\u4eec\u53ef\u4ee5\u53bb\u679a\u4e3e $a \\bmod 2$\uff0c\u8fd9\u6837\u53ef\u4ee5\u518d\u6362\u5143\uff1a\n\n$\\begin{cases}a'=\\frac{a-a\\bmod 2}{2} \\\\ b'=\\frac{b-a\\bmod 2}{2} \\\\ c'=\\frac{c-a\\bmod 2}{2}\\end{cases}$\n\n\u8fd9\u6837\u6211\u4eec\u518d\u5e26\u56de\u7b2c\u4e8c\u4e2a\u4e0d\u7b49\u5f0f\u7ec4\uff0c\u5219\u6709\uff1a\n\n$\\begin{cases}l_1' \\leq a'+b'+c' \\leq r_1' \\\\ l_2' \\leq a' \\leq r_2'\\\\ l_3' \\leq b' \\leq r_3' \\\\ l_4' \\leq c' \\leq r_4'\\end{cases}$\n\n\u90a3\u4e48\u95ee\u9898\u5c31\u5728\u4e8e\u5982\u4f55\u6c42\u89e3\u8fd9\u4e2a\u4e0d\u7b49\u5f0f\u7ec4\u4e86\u3002\u5176\u5b9e\u4e5f\u4e0d\u8981\u60f3\u5f97\u592a\u590d\u6742\uff0c\u56e0\u4e3a\u6211\u4eec\u53ea\u8981\u6c42\u51fa\u4e00\u7ec4\u89e3\uff0c\u6240\u4ee5\u53ef\u4ee5\u8003\u8651\u6211\u4eec\u5e73\u65f6\u505a\u6570\u5b66\u9898\u7684\u7b56\u7565\uff1a\u4ee4 $a'=l_2',b'=l_3',c'=l_4'$\uff0c\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1\u540e\u4e09\u4e2a\u4e0d\u7b49\u5f0f\u7684\u7ea6\u675f\uff0c\u7136\u540e\u518d\u770b\u8fd9\u4e2a\u65f6\u5019\u7684 $a'+b'+c'$ \u662f\u5426\u6ee1\u8db3 $l_1' \\leq a'+b'+c' \\leq l_2'$\uff0c\u82e5\u6ee1\u8db3\u5c31\u662f\u4e00\u7ec4\u89e3\uff1b\n\n\u82e5\u4e0d\u6ee1\u8db3\u6761\u4ef6\uff0c\u800c\u4e14 $a'+b'+c' < l_1'$\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8003\u8651\uff0c\u5728\u4e0d\u8d85\u8fc7\u540e\u4e09\u7ec4\u7ea6\u675f\u6761\u4ef6\u7684\u540c\u65f6\uff0c\u9002\u5f53\u589e\u52a0\u4e00\u4e0b $a',b',c'$ \u7684\u5927\u5c0f\uff0c\u4e5f\u5c31\u662f\u5148\u52a0 $a'$\uff0c\u5982\u679c $a'$ \u88ab\u52a0\u5230\u6700\u5927\u8fd8\u4e0d\u6ee1\u8db3 $l_1'$\uff0c\u5c31\u53bb\u52a0 $b'$\uff0c\u4ee5\u6b64\u7c7b\u63a8\u5373\u53ef\u3002\u5982\u679c\u662f $a'+b'+c' > r_1'$ \u90a3\u4e48\u5c31\u65e0\u89e3\u4e86\u3002\n\n\u6700\u540e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5e94\u8be5\u662f $O(n \\log_2 v)$ \u4e86\uff0c\u6bd4\u5f00\u573a\u7684\u90a3\u4e2a\u4e09\u5206\u4e0d\u77e5\u9053\u5feb\u5230\u54ea\u91cc\u53bb\u4e86\u3002\u6ce8\u610f\u4e00\u4e0b C++ \u7279\u8272\u53d6\u6a21\u53ef\u80fd\u9020\u6210\u4e00\u4e9b\u610f\u60f3\u4e0d\u5230\u7684\u8be1\u5f02\u95ee\u9898\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#include <cmath>\n#include <cctype>\n#include <queue>\n#include <vector>\n\nusing namespace std;\n\ninline long long read()\n{\n\tlong long x=0,f=1;char ch=getchar();\n\twhile (!isdigit(ch)){if (ch=='-') f=-1;ch=getchar();}\n\twhile (isdigit(ch)){x=x*10+ch-48;ch=getchar();}\n\treturn x*f;\n}\n\nint n;\n\nlong long x[100050],y[100050],z[100050],xans,yans,zans;\n\ninline void Init()\n{\n\tfor (int i=1;i<=n;i++)\n\t\tx[i]=y[i]=z[i]=0;\n\t//memset(x,0,sizeof(x));\n\t//memset(y,0,sizeof(y));\n\t//memset(z,0,sizeof(z));\n\txans=yans=zans=0;\n}\n\ninline bool check(long long mid)\n{\n\tlong long r1=4e18,r2=4e18,r3=4e18,r4=4e18;\n\tlong long l1=-4e18,l2=-4e18,l3=-4e18,l4=-4e18;\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tr1=min(r1,mid+x[i]+y[i]+z[i]);\n\t\tr2=min(r2,mid-x[i]+y[i]+z[i]);\n\t\tr3=min(r3,mid+x[i]-y[i]+z[i]);\n\t\tr4=min(r4,mid+x[i]+y[i]-z[i]);\n\t\tl1=max(l1,-mid+x[i]+y[i]+z[i]);\n\t\tl2=max(l2,-mid-x[i]+y[i]+z[i]);\n\t\tl3=max(l3,-mid+x[i]-y[i]+z[i]);\n\t\tl4=max(l4,-mid+x[i]+y[i]-z[i]);\n\t}\n\tfor (int i=0;i<=1;i++)\n\t{\n\t\tlong long l11=l1+((l1&1)^i);\n\t\tlong long r11=r1-((r1&1)^i);\n\t\tlong long l21=l2+((l2&1)^i);\n\t\tlong long r21=r2-((r2&1)^i);\n\t\tlong long l31=l3+((l3&1)^i);\n\t\tlong long r31=r3-((r3&1)^i);\n\t\tlong long l41=l4+((l4&1)^i);\n\t\tlong long r41=r4-((r4&1)^i);\n\t\tif (l11<=r11 && l21<=r21 && l31<=r31 && l41<=r41)\n\t\t{\n\t\t\tlong long a=l21;\n\t\t\tlong long b=l31;\n\t\t\tlong long c=l41;\n\t\t\tif (a+b+c<=r11)\n\t\t\t{\n\t\t\t\tif (a+b+c<l11)\n\t\t\t\t{\n\t\t\t\t\tif (r21<l11-b-c)\n\t\t\t\t\t\ta=r21;\n\t\t\t\t\telse\n\t\t\t\t\t\ta=l11-b-c;\n\t\t\t\t}\n\t\t\t\tif (a+b+c<l11)\n\t\t\t\t{\n\t\t\t\t\tif (r31<l11-a-c)\n\t\t\t\t\t\tb=r31;\n\t\t\t\t\telse\n\t\t\t\t\t\tb=l11-a-c;\n\t\t\t\t}\n\t\t\t\tif (a+b+c<l11)\n\t\t\t\t{\n\t\t\t\t\tif (r41<l11-a-b)\n\t\t\t\t\t\tc=r41;\n\t\t\t\t\telse\n\t\t\t\t\t\tc=l11-a-b;\n\t\t\t\t}\n\t\t\t\tif (a+b+c>=l11)\n\t\t\t\t{\n\t\t\t\t\txans=(b+c)>>1;\n\t\t\t\t\tyans=(a+c)>>1;\n\t\t\t\t\tzans=(a+b)>>1;\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n\nint main()\n{\n\tint T=read();\n\twhile (T--)\n\t{\n\t\tn=read();\n\t\tInit();\n\t\tfor (int i=1;i<=n;i++)\n\t\t{\n\t\t\tx[i]=read();\n\t\t\ty[i]=read();\n\t\t\tz[i]=read();\n\t\t}\n\t\tif (n==1)\n\t\t{\n\t\t\tcout << x[1] << \" \" << y[1] << \" \" << z[1] << endl;\n\t\t\tcontinue;\n\t\t}\n\t\tlong long left=0,right=4e18;\n\t\twhile (left<=right)\n\t\t{\n\t\t\tlong long mid=(left+right)>>1; \n\t\t\tif (check(mid))\n\t\t\t\tright=mid-1;\n\t\t\telse\n\t\t\t\tleft=mid+1;\n\t\t}\n\t\tcout << xans << \" \" << yans << \" \" << zans << endl;\n\t}\n\treturn 0;\n}\n\n```\n\n",
        "postTime": 1587302797,
        "uid": 8457,
        "name": "chen_zhe",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF685C \u3010Optimal Point\u3011"
    },
    {
        "content": "> [CF685C Optimal Point](https://codeforces.com/contest/685/problem/C)\n\n## \u9898\u610f\n\n- \u7acb\u4f53\u76f4\u89d2\u5750\u6807\u7cfb\u4e2d\u6709 $n$ \u4e2a\u6574\u70b9\u3002\n- \u6c42\u4e00\u4e2a\u6574\u70b9\u6ee1\u8db3\u5230\u8fd9 $n$ \u4e2a\u6574\u70b9\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u7684\u6700\u5927\u503c\u6700\u5c0f\u3002\n- $n \\le 10^5$\u3002\n\n## \u9898\u89e3\n\n\u663e\u7136\u5148\u4e8c\u5206\u7b54\u6848\u3002\n\n\u8003\u8651\u5982\u4f55 check\uff0c\u5047\u8bbe\u6b64\u65f6\u4e8c\u5206\u5230\u7684\u503c\u4e3a $d$\u3002\n\n\u5219\u6211\u4eec\u53ef\u4ee5\u5f97\u5230 $n$ \u4e2a\u9650\u5236 $|x - x_i| + |y - y_i| + |z - z_i| \\le d$\u3002\n\n\u4e0d\u59a8\u8bbe $x_i = y_i = z_i = 0$\uff0c\u6211\u4eec\u8003\u8651 $|x| + |y| + |z| \\le d$ \u7684\u60c5\u51b5\u3002\n\n\u679a\u4e3e\u6bcf\u4e2a\u7edd\u5bf9\u503c\u53d6\u6b63\u53d6\u8d1f\uff0c\u6211\u4eec\u53ef\u4ee5\u5217\u51fa $2^3 = 8$ \u4e2a\u4e0d\u7b49\u5f0f\u3002\n\n\u5408\u5e76\u8fd9 $8n$ \u4e2a\u4e0d\u7b49\u5f0f\uff0c\u6700\u7ec8\u4f1a\u5f97\u5230\u4e00\u4e2a\u4e0d\u7b49\u5f0f\u7ec4\uff1a\n\n$$\\begin{cases}l \\leq x+y+z \\leq r \\\\lx \\leq-x+y+z \\leq rx \\\\ly \\leq x-y+z \\leq ry \\\\lz \\leq x+y-z \\leq rz\\end{cases}$$\n\n\u8bbe $a=-x+y+z$\uff0c$b=x-y+z$\uff0c$c=x+y-z$\uff0c\u5219 $x=\\frac{b+c}{2}$\uff0c$y=\\frac{a+c}{2}$\uff0c$z=\\frac{a+b}{2}$\uff0c\u4e14 $x+y+z = a+b+c$\uff0c\u4e14 $a,b,c$ \u5947\u5076\u6027\u76f8\u540c\u3002\n\n\u4ee4 $a = 2a^{\\prime} + r$\uff0c$b = 2b^{\\prime} + r$\uff0c$c = 2c^{\\prime} + r$\uff0c\u5176\u4e2d $r \\in [0,1]$\uff0c\u5219\u6211\u4eec\u6700\u7ec8\u5f97\u5230\u7684\u4e0d\u7b49\u5f0f\u7ec4\u4e3a\uff1a\n\n$$\\begin{cases}l^{\\prime} \\leq a^{\\prime}+b^{\\prime}+c^{\\prime} \\leq r^{\\prime} \\\\lx^{\\prime} \\leq a^{\\prime} \\leq rx^{\\prime} \\\\ly^{\\prime} \\leq b^{\\prime} \\leq ry^{\\prime} \\\\lz^{\\prime} \\leq c^{\\prime} \\leq rz^{\\prime}\\end{cases}$$\n\n\u6211\u4eec\u8981\u6c42\u51fa\u8fd9\u4e2a\u4e0d\u7b49\u5f0f\u7ec4\u7684\u4e00\u7ec4\u89e3\u3002\n\n\u5148\u8d2a\u5fc3\u7684\u8bbe $a^{\\prime} = lx^{\\prime}$\uff0c$b^{\\prime} = ly^{\\prime}$\uff0c$c^{\\prime} = lz^{\\prime}$\uff0c\u82e5\u4e0d\u6ee1\u8db3 $l^{\\prime} \\leq a^{\\prime}+b^{\\prime}+c^{\\prime} \\leq r^{\\prime}$\uff0c\u5219\u4e00\u4e2a\u4e00\u4e2a\u8c03\u5927 $a^{\\prime}, b^{\\prime}, c^{\\prime}$\u3002\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5 $\\mathcal O(n)$ check \u5e76\u6784\u9020\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n \\log w)$\u3002\n\n\u8bf4\u53e5\u9898\u5916\u8bdd\uff0c\u4ee3\u7801\u4e0d\u592a\u4f1a\u5199\uff0c\u5077\u5077\u770b\u4e00\u773c\u5154\u5154\u7684\uff0c\u53d1\u73b0\u4ed6\u5077\u5077\u770b\u4e86\u9898\u89e3\u4ee3\u7801\uff08\n\n## \u4ee3\u7801\n\n```cpp\nconst int N = 1e5 + 7;\nconst ll inf = 4e18;\n#define Max(a, b) (a = a > b ? a : b)\n#define Min(a, b) (a = a < b ? a : b)\nint n;\nll x[N], y[N], z[N], X, Y, Z, mx, mxx, mxy, mxz, mn, mnx, mny, mnz;\n\ninline bool pd(ll o) {\n\tmx = mxx = mxy = mxz = inf, mn = mnx = mny = mnz = -inf;\n\tfor (int i = 1; i <= n; i++)\n\t\tMin(mx, o + x[i] + y[i] + z[i]),\n\t\tMin(mxx, o - x[i] + y[i] + z[i]),\n\t\tMin(mxy, o + x[i] - y[i] + z[i]),\n\t\tMin(mxz, o + x[i] + y[i] - z[i]),\n\t\tMax(mn, -o + x[i] + y[i] + z[i]),\n\t\tMax(mnx, -o - x[i] + y[i] + z[i]),\n\t\tMax(mny, -o + x[i] - y[i] + z[i]),\n\t\tMax(mnz, -o + x[i] + y[i] - z[i]);\n\tfor (int i = 0; i < 2; i++) {\n\t\tll l = mn + ((mn & 1) ^ i), r = mx - ((mx & 1) ^ i);\n\t\tll lx = mnx + ((mnx & 1) ^ i), rx = mxx - ((mxx & 1) ^ i);\n\t\tll ly = mny + ((mny & 1) ^ i), ry = mxy - ((mxy & 1) ^ i);\n\t\tll lz = mnz + ((mnz & 1) ^ i), rz = mxz - ((mxz & 1) ^ i);\n\t\tif (l > r || lx > rx || ly > ry || lz > rz) continue;\n\t\tll a = lx, b = ly, c = lz;\n\t\tif (a + b + c > r) continue;\n\t\tif (a + b + c < l) a = rx < l - b - c ? rx : l - b - c;\n\t\tif (a + b + c < l) b = ry < l - a - c ? ry : l - a - c;\n\t\tif (a + b + c < l) c = rz < l - a - b ? rz : l - a - b;\n\t\tif (a + b + c < l) continue;\n\t\treturn X = (b + c) >> 1, Y = (a + c) >> 1, Z = (a + b) >> 1, 1;\n\t}\n\treturn 0;\n}\n\ninline void solve() {\n\trd(n);\n\tfor (int i = 1; i <= n; i++) rd(x[i]), rd(y[i]), rd(z[i]);\n\tll l = 0, r = inf;\n\twhile (l <= r) {\n\t\tll mid = (l + r) >> 1;\n\t\tif (pd(mid)) r = mid - 1;\n\t\telse l = mid + 1;\n\t}\n\tprint(X, ' '), print(Y, ' '), print(Z);\n}\n\nint main() {\n\tint T;\n\trd(T);\n\twhile (T--) solve();\n\treturn 0;\n}\n```",
        "postTime": 1583825317,
        "uid": 100544,
        "name": "xht",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF685C \u3010Optimal Point\u3011"
    },
    {
        "content": "[\u8bf7\u5728\u535a\u5ba2\u4e2d\u67e5\u770b](https://dra.blog.luogu.org/solution-cf685c)\n\n\u6807\u7b7e: \u4e8c\u5206\u7b54\u6848.\n\n\u8fd9\u9053\u9898\u5c45\u7136\u6ca1\u6709 xht \u5927\u795e\u7684\u9898\u89e3?\n\n\u5bb9\u6613\u60f3\u5230\u4e8c\u5206\u7b54\u6848, \u8003\u8651\u5982\u4f55\u5224\u65ad\u4e00\u4e2a\u4e8c\u5206\u7684\u503c $Ans$ \u7684\u53ef\u884c\u6027.\n\n\u5217\u51fa\u4e0d\u7b49\u5f0f\u7ec4: \n$$\\left\\{\\begin{aligned}\nx+y+z-x_i-y_i-z_i\\geqslant Ans\\\\\nx+y-z-x_i-y_i+z_i\\geqslant Ans\\\\\nx-y+z-x_i+y_i-z_i\\geqslant Ans\\\\\nx-y-z-x_i+y_i+z_i\\geqslant Ans\\\\\n-x+y+z+x_i-y_i-z_i\\geqslant Ans\\\\\n-x+y-z+x_i-y_i+z_i\\geqslant Ans\\\\\n-x-y+z+x_i+y_i-z_i\\geqslant Ans\\\\\n-x-y-z+x_i+y_i+z_i\\geqslant Ans\\\\\n\\end{aligned}\\right.$$\n\n\u79fb\u9879\u540e\u7684\u5230\u8fd9\u6837\u7684\u5f62\u5f0f: \n$$\\left\\{\\begin{aligned}\nx+y+z\\in [l_0,r_0]\\\\\nx+y-z\\in [l_1,r_1]\\\\\nx-y+z\\in [l_2,r_2]\\\\\nx-y-z\\in [l_3,r_3]\\\\\n\\end{aligned}\\right.$$\n\n\u8bbe $a=x+y-z, b=x-y+z,c=x-y-z$ , \u5219 $a+b-c=x+y+z$ , \u8fd9\u91cc\u9690\u542b\u4e86 $a\\equiv b\\equiv c\\pmod 2$ , \u4e8e\u662f\u6211\u4eec\u679a\u4e3e $a\\bmod 2$ , \u90a3\u4e48\u4e0d\u7b49\u5f0f\u7ec4\u53ef\u4ee5\u8f6c\u5316\u6210\u5173\u4e8e $a,b,c$ \u7684\u4e0d\u7b49\u5f0f\u7ec4, \u8fd9\u4e2a\u4e0d\u7b49\u5f0f\u7ec4\u5f88\u597d\u89e3.\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n\\log x)$.\n\n\u5b9e\u9645\u5b9e\u73b0\u4e2d\u5c06 $c$ \u8bbe\u4e3a $-x+y+z$ .\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nlong long read();\n\nint T, n;\nlong long x[100005], y[100005], z[100005], l[4], r[4], L[4], R[4];\nvoid chmax(long long &x, long long y) { x < y ? x = y : x; }\nvoid chmin(long long &x, long long y) { x > y ? x = y : x; }\n\nbool check(long long p, bool prt) {\n    for (int i = 0; i < 4; ++i) l[i] = -6e18, r[i] = 6e18;\n    for (int i = 1; i <= n; ++i) {\n        chmin(r[0], x[i] + y[i] + z[i] + p);\n        chmax(l[0], x[i] + y[i] + z[i] - p);\n        chmin(r[1], -x[i] + y[i] + z[i] + p);\n        chmax(l[1], -x[i] + y[i] + z[i] - p);\n        chmin(r[2], x[i] - y[i] + z[i] + p);\n        chmax(l[2], x[i] - y[i] + z[i] - p);\n        chmin(r[3], x[i] + y[i] - z[i] + p);\n        chmax(l[3], x[i] + y[i] - z[i] - p);\n    }\n\n    for (int i = 0; i < 4; ++i)\n        if (l[i] > r[i]) return 0;\n    for (int A = 0, flag; A < 2; ++A) {\n        L[0] = l[0] - 3 * A, R[0] = r[0] - 3 * A;\n        for (int i = 1; i < 4; ++i) L[i] = l[i] - A, R[i] = r[i] - A;\n        for (int i = 0; i < 4; ++i) L[i] = L[i] + 1 >> 1, R[i] >>= 1;\n\n        flag = 1;\n        for (int i = 0; i < 4; ++i)\n            if (L[i] > R[i]) {\n                flag = 0;\n                break;\n            }\n        if (!flag) continue;\n        long long L0 = L[1] + L[2] + L[3], R0 = R[1] + R[2] + R[3];\n        if (R[0] >= L0 && R0 >= L[0]) {\n            if (prt) {\n                long long a = L[1], b = L[2], c = L[3];\n                if (a + b + c < L[0]) a += min(R[1] - L[1], L[0] - a - b - c);\n                if (a + b + c < L[0]) b += min(R[2] - L[2], L[0] - a - b - c);\n                if (a + b + c < L[0]) c += min(R[3] - L[3], L[0] - a - b - c);\n                printf(\"%lld %lld %lld\\n\", b + c + A, a + c + A, a + b + A);\n            }\n            return 1;\n        }\n    }\n    return 0;\n}\n\nint main() {\n    T = read();\n    while (T--) {\n        n = read();\n        for (int i = 1; i <= n; ++i)\n            x[i] = read(), y[i] = read(), z[i] = read();\n        long long l = 0, r = 6e18, rs = r, mid;\n        while (l <= r)\n            check(mid = l + r >> 1, 0) ? rs = mid, r = mid - 1 : l = mid + 1;\n        check(rs, 1);\n    }\n    return 0;\n}\nconst int _SIZE = 1 << 22;\nchar ibuf[_SIZE], *iS = ibuf, *iT = ibuf;\n#define gc                                                         \\\n    (iS == iT ? iT = ((iS = ibuf) + fread(ibuf, 1, _SIZE, stdin)), \\\n     (iS == iT ? EOF : *iS++) : *iS++)\nlong long read() {\n    long long x = 0, f = 1;\n    char c = gc;\n    while (!isdigit(c)) f = (c == '-') ? -1 : f, c = gc;\n    while (isdigit(c)) x = x * 10 + c - '0', c = gc;\n    return x * f;\n}\n```\n\n",
        "postTime": 1580733719,
        "uid": 51237,
        "name": "Kinandra",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF685C \u3010Optimal Point\u3011"
    },
    {
        "content": "\u8fd9\u7bc7\u9898\u89e3\u662f\u7528\u6765\u8d28\u7591\u5176\u4ed6\u9898\u89e3~~\u7684\u667a\u5546~~\u4e3a\u4ec0\u4e48\u6ca1\u6709\u7528 $O(n+\\log{W})$ \u7684\uff0c\u5e76\u4e14\u6240\u6709\u9898\u89e3\u7684\u5224\u65ad\u90fd\u8fd9\u4e48\u62c9\u80ef\u3002\n\n\u9996\u5148\u4e8c\u5206\u7b54\u6848\u4e3a $dis$\uff0c\u8bbe\u7b54\u6848\u70b9\u4e3a $(x,y,z)$\uff0c\u7136\u540e\u5c31\u6709 $n$ \u7ec4\u7ea6\u675f\u6761\u4ef6 $|x-x_i|+|y-y_i|+|z-z_i| \\leq dis$\n\n\u76f4\u63a5\u66b4\u529b\u62c6\u5f00\u7edd\u5bf9\u503c\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$\\begin{cases}x+y+z-x_i-y_i-z_i \\leq dis \\\\ x+y-z-x_i-y_i+z_i \\leq dis \\\\ x-y+z-x_i+y_i-z_i \\leq dis \\\\ x-y-z-x_i+y_i+z_i \\leq dis \\\\ -x+y+z+x_i-y_i-z_i \\leq dis \\\\ -x+y-z+x_i-y_i+z_i \\leq dis \\\\ -x-y+z+x_i+y_i-z_i \\leq dis \\\\ -x-y-z+x_i+y_i+z_i \\leq dis\\end{cases}$\n\n\u79fb\u9879\u5c31\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$\\begin{cases} \\max(-dis+x_i+y_i+z_i) \\leq x+y+z \\leq \\min(-dis+x_i+y_i+z_i) \\\\ \\max(-dis-x_i+y_i+z_i) \\leq -x+y+z \\leq \\min(-dis-x_i+y_i+z_i) \\\\ \\max(-dis+x_i-y_i+z_i) \\leq x-y+z \\leq \\min(-dis+x_i-y_i+z_i) \\\\ \\max(-dis+x_i+y_i-z_i) \\leq x+y-z \\leq \\min(-dis+x_i+y_i-z_i)\\end{cases} $\n\n\u8fd9\u91cc\u6709\u4e2a\u663e\u800c\u6613\u89c1\u7684\u4e8b\u5b9e\u662f\uff1a\n\n$\\begin{cases}\\max(-dis+x_i+y_i+z_i)=-dis+\\max(x_i+y_i+z_i)\\\\\\max(-dis-x_i+y_i+z_i)=-dis+\\max(-x_i+y_i+z_i)\\\\\\max(-dis+x_i-y_i+z_i)=-dis+\\max(x_i-y_i+z_i)\\\\\\max(-dis+x_i+y_i-z_i)=-dis+\\max(x_i+y_i-z_i)\\end{cases} $\n \n\n$\\begin{cases}\\min(-dis+x_i+y_i+z_i)=-dis+\\min(x_i+y_i+z_i)\\\\\\min(-dis-x_i+y_i+z_i)=-dis+\\min(-x_i+y_i+z_i)\\\\\\min(-dis+x_i-y_i+z_i)=-dis+\\min(x_i-y_i+z_i)\\\\\\min(-dis+x_i+y_i-z_i)=-dis+\\min(x_i+y_i-z_i)\\end{cases} $\n\n\u663e\u7136\u6bcf\u4e2a $-dis+\\max/\\min{\\text{?}}$ \u540e\u9762\u7684\u4e1c\u897f\u662f\u53ef\u4ee5\u63d0\u524d\u9884\u5904\u7406\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u5176\u5b9e\u8fd9\u56db\u4e2a\u4e0d\u7b49\u5f0f\u53ea\u4e0e $dis$ \u6709\u5173\u3002\n\n\u8bbe\uff1a\n\n$\\begin{cases}l_1=-mid+\\max(x_i+y_i+z_i)\\\\l_2=-mid+\\max(-x_i+y_i+z_i)\\\\l_3=-mid+\\max(x_i-y_i+z_i)\\\\l_4=-mid+\\max(x_i+y_i-z_i)\\end{cases} $\n\n$\\begin{cases}r_1=-mid+\\min(x_i+y_i+z_i)\\\\r_2=-mid+\\min(-x_i+y_i+z_i)\\\\r_3=-mid+\\min(x_i-y_i+z_i)\\\\r_4=-mid+\\min(x_i+y_i-z_i)\\end{cases} $\n\n\u5219\uff1a\n\n$\\begin{cases} l_1 \\leq x+y+z \\leq r_1 \\\\ l_2 \\leq -x+y+z \\leq r_2 \\\\ l_3 \\leq x-y+z \\leq r_3 \\\\ l_4 \\leq x+y-z \\leq r_4\\end{cases} $\n\n\u90a3\u4e48\u6211\u4eec\u6bcf\u6b21\u5224\u65ad\u53ea\u7528 $O(1)$ \u7684\u89e3\u4e00\u4e2a\u4e0d\u7b49\u5f0f\u7ec4\u5373\u53ef\u3002\n\n\u89e3\u8fd9\u4e2a\u4e0d\u7b49\u5f0f\u7ec4\u8fd8\u5f97\u6709\u70b9\u6280\u5de7\uff0c\u9996\u5148\u662f\u4e00\u4e2a\u5c0f\u5965\u5c31\u80fd\u770b\u51fa\u6765\u7684\u6362\u5143\uff0c\u4ee4 $a=-x+y+z,b=x-y+z,c=x+y-z$\uff0c\u5219\uff1a\n\n$\\begin{cases}x=\\frac{b+c}{2}\\\\y=\\frac{a+c}{2}\\\\z=\\frac{a+b}{2}\\\\x+y+z=a+b+c\\end{cases} $\n\n\u6545\uff1a\n\n$\\begin{cases}l_1\\leq a+b+c\\leq r_1\\\\l_2\\leq a\\leq r_2\\\\l_3\\leq b\\leq r_3\\\\l_4\\leq c\\leq r_4\\end{cases}$\n\n\u7136\u540e\u662f $a,b,c$ \u5947\u5076\u6027\u76f8\u540c\uff0c\u56e0\u4e3a $x,y,z$ \u5747\u4e3a\u6574\u6570\uff0c\u4ee4 $f=a\\&1$\uff0c\u518d\u4ee4\uff1a\n\n$\\begin{cases}a'=\\frac{a-f}{2} \\\\ b'=\\frac{b-f}{2} \\\\ c'=\\frac{c-f}{2}\\end{cases} $\n\n$\\begin{cases}l_1'=\\lceil\\frac{l_1-3f}{2}\\rceil \\\\ l_2'=\\lceil\\frac{l_2-f}{2}\\rceil \\\\ l_3'=\\lceil\\frac{l_3-f}{2}\\rceil \\\\ r_1'=\\lceil\\frac{r_1-3f}{2}\\rceil \\\\ r_2'=\\lceil\\frac{r_2-f}{2}\\rceil \\\\ r_3'=\\lceil\\frac{r_3-f}{2}\\rceil \\\\ \\end{cases} $\n\n\u81ea\u7136\u5f97\u5230\uff1a\n\n$\\begin{cases}l_1' \\leq a'+b'+c' \\leq r_1' \\\\ l_2' \\leq a' \\leq r_2'\\\\ l_3' \\leq b' \\leq r_3' \\\\ l_4' \\leq c' \\leq r_4'\\end{cases}$\n\n\u8fd9\u4e2a\u4e1c\u897f\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u6bcf\u6b21\u5224\u65ad\u6c42\u89e3\uff0c\u6211\u4eec\u53ea\u7528\u5224\u65ad\u5408\u6cd5\u5373\u53ef\uff0c\u4e8e\u662f\u5224\u65ad\u4ee5\u4e0b\u4e24\u4e2a\u4e0d\u7b49\u5f0f\uff1a\n\n$\\begin{cases}l_2'+l_3'+l_4' \\leq r_1' \\\\ r_2'+r_3'+r_4' \\geq l_1'\\end{cases}$\n\n\u6700\u540e\u5f97\u5230\u4e86 $dis$ \u7684\u503c\u540e\u518d\u6765\u6c42\u89e3 $a,b,c$ \u5373\u53ef\uff0c\u5177\u4f53\u7684\uff0c\u5148\u53d6\u6700\u5c0f\uff0c\u7136\u540e\u9010\u4e2a\u589e\u5927\u5373\u53ef\u3002\n\n**\u590d\u6742\u5ea6 $\\color{red}O(n+\\log{W})$\u3002**\n\n\u6211\u53cd\u6b63\u662f\u6ca1\u60f3\u5230\u4e3a\u4ec0\u4e48\u9898\u89e3\u533a\u4e00\u7247\u62c9\u80ef\uff0c\u90fd\u7528\u7684 $O(n\\log{W})$ \u4e14\u6bcf\u6b21\u5224\u65ad\u90fd\u8981\u6784\u9020\u4e00\u6b21\u89e3\uff0c\u5c31\u7b97\u5e38\u6570\u6ca1\u4eba\u8981\uff0c\u590d\u6742\u5ea6\u4e5f\u4e0d\u7ba1\u7ba1\uff1f",
        "postTime": 1628854689,
        "uid": 158948,
        "name": "\u7ea6\u745f\u592b\u7528\u8111\u73a9",
        "ccfLevel": 0,
        "title": "CF685C Optimal Point"
    },
    {
        "content": "[CF685C Optimal Point](https://www.luogu.com.cn/problem/CF685C)\u89e3\u9898\u62a5\u544a\uff1a\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://zybuluo.com/xiaoziyao/note/1807921)\n\n## \u9898\u610f\n\n\u7ed9\u5b9a $n$ \u4e2a\u7acb\u4f53\u4e09\u7ef4\u5750\u6807\u7cfb\u7684\u6574\u70b9\uff08\u5750\u6807\u8303\u56f4 $[-10^{18},10^{18}]$ \uff09\uff0c\u6c42\u4e00\u4e2a\u70b9\u4f7f\u5f97\u5176\u4e0e\u6240\u6709\u70b9\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u6700\u5927\u503c\u6700\u5c0f\u3002\uff08 $1\\leqslant n\\leqslant 10^5$ \uff09\n\n## \u5206\u6790\n\n\u4f18\u7f8e\u7684\u80d6\u9898\u3002\n\n\u9996\u5148\u6c42\u6700\u5927\u503c\u6700\u5c0f\u5c31\u53ef\u4ee5\u77e5\u9053\u8981\u4e8c\u5206\u8fd9\u4e2a\u8ddd\u79bb\u6700\u5927\u503c\u3002\n\n\u8003\u8651\u600e\u4e48 check \u8fd9\u4e2a\u8ddd\u79bb $mid$ \uff0c\u53d1\u73b0\u8fd9\u7b49\u4ef7\u4e8e\u89e3\u8fd9\u4e2a\u65b9\u7a0b\u7ec4\u7684\u89e3\uff08\u5176\u4e2d $x_0,y_0,z_0$ \u4e3a\u672a\u77e5\u6570\uff09\uff1a\n\n$$\\begin{cases}|x_1-x_0|+|y_1-y_0|+|z_1-z_0|\\leqslant mid\\\\|x_2-x_0|+|y_2-y_0|+|z_2-z_0|\\leqslant mid\\\\\\cdots\\\\|x_n-x_0|+|y_n-y_0|+|z_n-z_0|\\leqslant mid\\end{cases}$$\n\n\u53d1\u73b0\u8fd9\u4e2a\u7edd\u5bf9\u503c\u5f88\u96be\u62c6\uff0c\u4f46\u7531\u4e8e $\\max\\{a-b,b-a\\}=|a-b|$ \uff0c\u6240\u4ee5\u6bcf\u4e2a\u4e0d\u7b49\u5f0f\u53ef\u4ee5\u7b49\u4ef7\u4e3a\uff1a\n\n$$\\begin{cases}x_i-x_0+y_i-y_0+z_i-z_0\\leqslant mid\\\\x_0-x_i+y_i-y_0+z_i-z_0\\leqslant mid\\\\x_i-x_0+y_0-y_i+z_i-z_0\\leqslant mid\\\\x_0-x_i+y_0-y_i+z_i-z_0\\leqslant mid\\\\x_i-x_0+y_i-y_0+z_0-z_i\\leqslant mid\\\\x_0-x_i+y_i-y_0+z_0-z_i\\leqslant mid\\\\x_i-x_0+y_0-y_i+z_0-z_i\\leqslant mid\\\\x_0-x_i+y_0-y_i+z_0-z_i\\leqslant mid\\end{cases}$$\n\n\u7136\u540e\u4e0d\u96be\u53d1\u73b0\u8fd9\u4e2a\u4e0d\u7b49\u5f0f\u53ef\u4ee5\u5316\u4f5c\uff1a\n\n$$\\begin{cases}x_i+y_i+z_i-mid\\leqslant x_0+y_0+z_0\\leqslant x_i+y_i+z_i+mid\\\\-x_i+y_i+z_i-mid\\leqslant -x_0+y_0+z_0\\leqslant -x_i+y_i+z_i+mid\\\\x_i-y_i+z_i-mid\\leqslant x_0-y_0+z_0\\leqslant x_i-y_i+z_i+mid\\\\x_i+y_i-z_i-mid\\leqslant x_0+y_0-z_0\\leqslant x_i+y_i-z_i+mid\\end{cases}$$\n\n\u8bbe $al,bl,cl,dl$ \u4e3a\u524d\u56db\u4e2a\u5f0f\u5b50\u7684\u6700\u5927\u503c\uff0c $ar,br,cr,dr$ \u4e3a\u540e\u56db\u4e2a\u5f0f\u5b50\u7684\u6700\u5c0f\u503c\uff0c\uff0c $a=-x_0+y_0+z_0,b=x_0-y_0+z_0,c=x_0+y_0-z_0$ \uff0c\u90a3\u4e48\u7b49\u4ef7\u4e8e\uff1a\n\n$$\\begin{cases}al\\leqslant a+b+c\\leqslant ar\\\\bl\\leqslant a\\leqslant br\\\\cl\\leqslant b\\leqslant cr\\\\dl\\leqslant c\\leqslant dr\\end{cases}$$\n\n\u7531\u4e8e $x_0=\\frac{b+c}{2},y_0=\\frac{a+c}{2},z_0=\\frac{a+b}{2}$ \uff0c\u4e14\u5b83\u4eec\u90fd\u662f\u6574\u6570\uff0c\u6240\u4ee5\u8fd8\u6709 $a\\equiv b\\equiv c\\pmod 2$ \u3002\n\n\u6b64\u65f6\u5957\u8def\u5730\u679a\u4e3e $a,b,c$ \u7684\u6700\u540e\u4e00\u4e2a\u4e8c\u8fdb\u5236\u4f4d $t\\in\\{0,1\\}$ \u518d\u5904\u7406\u4e00\u4e0b\u8fb9\u754c\uff0c\u90a3\u4e48\u6a21 $2$ \u76f8\u540c\u7684\u9650\u5236\u5c31\u6ca1\u4e86\uff0c\u6700\u540e\u4e0d\u96be\u7528\u8c03\u6574\u6cd5\u7b97\u51fa\u4e00\u4e2a\u7b54\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a $O(n\\log v)$ \u3002\n\n## \u4ee3\u7801\n\n```\n#include<stdio.h>\n#include<iostream>\n#define inf 6000000000000000000\nusing namespace std;\nconst int maxn=100005;\nint T,n;\nlong long ansx,ansy,ansz;\nlong long x[maxn],y[maxn],z[maxn];\ninline long long ceil(long long x){\n\treturn x>=0? (x+1)/2ll:-((-x)/2ll);\n}\ninline long long floor(long long x){\n\treturn x>=0? x/2ll:-((-x+1)/2ll);\n}\nint check(long long mid){\n\tlong long al=-inf,bl=-inf,cl=-inf,dl=-inf,ar=inf,br=inf,cr=inf,dr=inf;\n\t//al<=a+b+c<=ar,bl<=a<=br,cl<=b<=cr,dl<=c<=dr\n\tfor(int i=1;i<=n;i++){\n\t\tal=max(al,x[i]+y[i]+z[i]-mid),ar=min(ar,x[i]+y[i]+z[i]+mid);\n\t\tbl=max(bl,-x[i]+y[i]+z[i]-mid),br=min(br,-x[i]+y[i]+z[i]+mid);\n\t\tcl=max(cl,x[i]-y[i]+z[i]-mid),cr=min(cr,x[i]-y[i]+z[i]+mid);\n\t\tdl=max(dl,x[i]+y[i]-z[i]-mid),dr=min(dr,x[i]+y[i]-z[i]+mid);\n\t}\n\tfor(int t=0;t<=1;t++){\n\t\tlong long wl=ceil(al-3*t),wr=floor(ar-3*t);\n\t\tlong long xl=ceil(bl-t),xr=floor(br-t);\n\t\tlong long yl=ceil(cl-t),yr=floor(cr-t);\n\t\tlong long zl=ceil(dl-t),zr=floor(dr-t);\n\t\tif(wl<=wr&&xl<=xr&&yl<=yr&&zl<=zr&&xl+yl+zl<=wr&&xr+yr+zr>=wl){\n\t\t\tlong long x=xl,y=yl,z=zl,up=max(0ll,wl-xl-yl-zl);\n\t\t\tx+=min(up,xr-xl),up-=min(up,xr-xl);\n\t\t\ty+=min(up,yr-yl),up-=min(up,yr-yl);\n\t\t\tz+=min(up,zr-zl),up-=min(up,zr-zl);\n\t\t\tx=((x<<1)|t),y=((y<<1)|t),z=((z<<1)|t);\n\t\t\tansx=(y+z)>>1,ansy=(x+z)>>1,ansz=(x+y)>>1;\n\t\t\treturn 1;\n\t\t}\n\t}\n\treturn 0;\n}\nint main(){\n\tscanf(\"%d\",&T);\n\twhile(T--){\n\t\tscanf(\"%d\",&n);\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tscanf(\"%lld%lld%lld\",&x[i],&y[i],&z[i]);\n\t\tlong long L=-1,R=inf+1;\n\t\twhile(L+1<R){\n\t\t\tlong long mid=L+(R-L)/2ll;\n\t\t\tif(check(mid))\n\t\t\t\tR=mid;\n\t\t\telse L=mid;\n\t\t}\n\t\tcheck(R);\n\t\tprintf(\"%lld %lld %lld\\n\",ansx,ansy,ansz);\n\t}\n\treturn 0;\n}\n```\n\n[\u6574\u573a\u6bd4\u8d5b\u7684\u9898\u89e3](https://zybuluo.com/xiaoziyao/note/1807911)",
        "postTime": 1625831912,
        "uid": 35754,
        "name": "Verdandi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF685C\u3010Optimal Point\u3011"
    },
    {
        "content": "# CF685C Optimal Point\n\n## \u9898\u76ee\u5927\u610f\n\n[\u9898\u76ee\u94fe\u63a5](https://codeforces.com/contest/685/problem/C)\n\n\u7ed9\u51fa\u4e09\u7ef4\u7a7a\u95f4\u91cc\u7684 $n$ \u4e2a\u70b9\u3002\u6c42\u4e00\u4e2a\u5750\u6807\u662f\u6574\u6570\u7684\u70b9\uff0c\u6700\u5c0f\u5316\u5b83\u5230 $n$ \u4e2a\u70b9\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u7684\u6700\u5927\u503c\u3002\n\n$1\\leq n\\leq 10^5$\uff0c\u5750\u6807\u7684\u7edd\u5bf9\u503c $\\leq 10^{18}$\u3002\n\n## \u672c\u9898\u9898\u89e3\n\n\u6700\u5c0f\u5316\u6700\u5927\u503c\uff0c\u5bb9\u6613\u60f3\u5230\u4e8c\u5206\u7b54\u6848\u3002\u8bbe\u5f53\u524d\u9700\u8981\u5224\u65ad\u7684\u7b54\u6848\u4e3a $d$\uff0c\u5373\u5224\u65ad\u662f\u5426\u5b58\u5728\u4e00\u4e2a\u70b9 $(x,y,z)$\uff0c\u4f7f\u5f97\u5b83\u5230 $n$ \u4e2a\u70b9\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u90fd $\\leq d$\u3002\u5f62\u5f0f\u5316\u5730\u5199\u4e3a\uff1a\n$$\n\\forall i: |x_i - x| + |y_i - y| + |z_i - z| \\leq d\n$$\n$|p|\\leq q$\uff0c\u53ef\u4ee5\u7b49\u4ef7\u4e8e $p\\leq q$ \u4e14 $-p\\leq q$\u3002\u56e0\u4e3a\u8d1f\u6570\u5bf9\u8fd9\u4e2a\u5224\u65ad\u6ca1\u6709\u5f71\u54cd\u3002\u4e8e\u662f\u53ef\u4ee5\u628a\u7edd\u5bf9\u503c\u62c6\u5f00\u3002\u5219\u6bcf\u4e2a\u6761\u4ef6\u53d8\u6210 $2^3 = 8$ \u4e2a\u6761\u4ef6\uff1a\n$$\n\\begin{cases}\nx_i - x + y_i - y + z_i - z \\leq d\\\\\nx_i - x + y_i - y + z - z_i \\leq d\\\\\nx_i - x + y - y_i + z_i - z \\leq d\\\\\nx_i - x + y - y_i + z - z_i \\leq d\\\\\nx - x_i + y_i - y + z_i - z \\leq d\\\\\nx - x_i + y_i - y + z - z_i \\leq d\\\\\nx - x_i + y - y_i + z_i - z \\leq d\\\\\nx - x_i + y - y_i + z - z_i \\leq d\n\\end{cases}\n$$\n\u6211\u4eec\u5173\u5fc3\u7684\u662f $(x,y,z)$\uff0c\u6240\u4ee5\u6574\u7406\u4e00\u4e0b\uff1a\n$$\n\\begin{cases}\n-x - y - z \\leq d - x_i - y_i - z_i\\\\\n-x - y + z \\leq d - x_i - y_i + z_i\\\\\n-x + y - z \\leq d - x_i + y_i - z_i\\\\\n-x + y + z \\leq d - x_i + y_i + z_i\\\\\nx - y - z \\leq d + x_i - y_i - z_i\\\\\nx - y + z \\leq d + x_i - y_i + z_i\\\\\nx + y - z \\leq d + x_i + y_i - z_i\\\\\nx + y + z \\leq d + x_i + y_i + z_i\\\\\n\\end{cases}\n$$\n\u8fdb\u4e00\u6b65\u6574\u7406\u5f97\uff1a\n$$\n\\begin{cases}\n-d + x_i + y_i + z_i\\leq x + y + z \\leq d + x_i + y_i + z_i\\\\\n-d - x_i + y_i + z_i \\leq -x + y + z\\leq d - x_i + y_i + z_i\\\\\n-d + x_i - y_i + z_i \\leq x - y + z \\leq d + x_i - y_i + z_i\\\\\n-d + x_i + y_i - z_i \\leq x + y - z \\leq d + x_i + y_i - z_i\n\\end{cases}\n$$\n\u8bbe\uff1a\n$$\nl_1 = \\max_{i = 1}^{n}(-d + x_i + y_i + z_i)\\\\\nl_2 = \\max_{i = 1}^{n}(-d - x_i + y_i + z_i)\\\\\nl_3 = \\max_{i = 1}^{n}(-d + x_i - y_i + z_i)\\\\\nl_4 = \\max_{i = 1}^{n}(-d + x_i + y_i - z_i)\\\\\nr_1 = \\min_{i = 1}^{n}(d + x_i + y_i + z_i)\\\\\nr_2 = \\min_{i = 1}^{n}(d - x_i + y_i + z_i)\\\\\nr_3 = \\min_{i = 1}^{n}(d + x_i - y_i + z_i)\\\\\nr_4 = \\min_{i = 1}^{n}(d + x_i + y_i - z_i)\n$$\n$l_1,l_2,l_3,l_4,r_1,r_2,r_3,r_4$ \u90fd\u53ef\u4ee5\u770b\u505a\u5e38\u6570\u3002\u4e0a\u8ff0 $\\min, \\max$ \u7684\u672c\u8d28\u662f\u5bf9 $n$ \u4e2a\u6761\u4ef6\u6c42\u4ea4\u3002\n\n\u4e8e\u662f\u6761\u4ef6\u53ef\u4ee5\u6539\u5199\u6210\uff1a\n$$\n\\begin{cases}\nl_1 \\leq x + y + z \\leq r_1\\\\\nl_2 \\leq -x + y + z \\leq r_2\\\\\nl_3 \\leq x - y + z \\leq r_3\\\\\nl_4 \\leq x + y - z \\leq r_4\n\\end{cases}\n$$\n\u6362\u5143\u3002\u8bbe $a = -x + y + z$\uff0c$b = x - y + z$\uff0c$c = x + y - z$\u3002\u5219 $a + b + c = x + y + z$\u3002\n\n\u56e0\u4e3a $a + b = (-x + y + z) + (x - y + z) = 2z$\uff0c\u6240\u4ee5 $a,b$ \u5947\u5076\u6027\u76f8\u540c\u3002\u540c\u7406\u53ef\u77e5 $a,b,c$ **\u5947\u5076\u6027\u90fd\u76f8\u540c**\u3002\n\n\u77e5\u9053\u4e00\u7ec4 $a,b,c$ \u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7 $x = \\frac{b + c}{2}$, $y = \\frac{a + c}{2}$, $z = \\frac{a + b}{2}$\uff0c\u6c42\u51fa\u5176\u5bf9\u5e94\u7684 $x,y,z$\u3002\u4e8e\u662f\u95ee\u9898\u4ece\u5224\u65ad\u662f\u5426\u5b58\u5728 $(x,y,z)$\uff0c\u8f6c\u5316\u4e3a\u5224\u65ad\u662f\u5426\u5b58\u5728\u6574\u6570\u4e09\u5143\u7ec4 $(a,b,c)$\uff0c\u4f7f\u5176\u6ee1\u8db3\u5982\u4e0b\u6761\u4ef6\uff1a\n$$\n\\begin{cases}\nl_1 \\leq a + b + c \\leq r_1\\\\\nl_2 \\leq a \\leq r_2\\\\\nl_3 \\leq b \\leq r_3\\\\\nl_4 \\leq c \\leq r_4\\\\\na\\equiv b\\equiv c \\pmod{2} \n\\end{cases}\n$$\n\u8bbe $a',b',c'$\uff0c\u6ee1\u8db3\uff1a\n$$\na = 2a' + t\\\\\nb = 2b' + t\\\\\nc = 2c' + t\n$$\n\u5176\u4e2d $t \\in\\{0,1\\}$\uff0c\u662f\u6211\u4eec\u53ef\u4ee5\u4efb\u53d6\u7684\u3002\u4e0d\u59a8\u679a\u4e3e $t$\u3002\u90a3\u4e48\u518d\u8bbe\uff1a\n$$\nl_1' = \\lceil\\frac{l_1 - 3t}{2}\\rceil,\\  r_1' = \\lfloor\\frac{r_1 - 3t}{2}\\rfloor\\\\\nl_2' = \\lceil\\frac{l_2 - t}{2}\\rceil,\\ r_2' = \\lfloor\\frac{r_2 - t}{2}\\rfloor\\\\\nl_3' = \\lceil\\frac{l_3 - t}{2}\\rceil,\\ r_3' = \\lfloor\\frac{r_3 - t}{2}\\rfloor\\\\\nl_4' = \\lceil\\frac{l_4 - t}{2}\\rceil,\\ r_4' = \\lfloor\\frac{r_4 - t}{2}\\rfloor\n$$\n\u6ce8\u610f\uff0c\u5bf9\u8d1f\u6570\u6765\u8bf4\uff0c\u8fd9\u91cc\u7684\u4e0a\u3001\u4e0b\u53d6\u6574\uff0c\u662f\u771f\u7684\u53d6\u66f4\u5927\u3001\u66f4\u5c0f\u7684\u6570\uff0c\u800c\u4e0d\u662f $\\texttt{C++}$ \u4e2d\u9ed8\u8ba4\u7684\u5411 $0$ \u53d6\u6574\u3002\n\n\u5219\u95ee\u9898\u8f6c\u5316\u4e3a\uff0c\u5224\u65ad\u662f\u5426\u5b58\u5728\u6574\u6570\u4e09\u5143\u7ec4 $(a',b', c')$\uff0c\u6ee1\u8db3\uff1a\n$$\n\\begin{cases}\nl_1'\\leq a' + b' + c'\\leq r_1'\\\\\nl_2'\\leq a' \\leq r_2'\\\\\nl_3'\\leq b' \\leq r_3'\\\\\nl_4'\\leq c' \\leq r_4'\n\\end{cases}\n$$\n\u7528\u53d6\u5148\u6781\u503c\uff0c\u518d\u8c03\u6574\u7684\u65b9\u6cd5\u3002\u53ef\u4ee5\u53d1\u73b0\u6761\u4ef6\u7b49\u4ef7\u4e8e\uff1a\n$$\n\\begin{cases}\nl_1'\\leq r_1'\\\\\nl_2'\\leq r_2'\\\\\nl_3'\\leq r_3'\\\\\nl_4'\\leq r_4'\\\\\nl_2' + l_3' + l_4'\\leq r_1'\\\\\nr_2' + r_3' + r_4'\\geq l_1'\n\\end{cases}\n$$\n\u76f4\u63a5\u5224\u65ad\u5373\u53ef\u3002\n\n\u5355\u6b21\u5224\u65ad\u7684\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n)$\u3002\u56e0\u4e3a\u8fd8\u8981\u4e8c\u5206\u7b54\u6848\uff0c\u6240\u4ee5\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n\\log \\text{ans})$\u3002\n\n\u53c2\u8003\u4ee3\u7801\uff1a\n\n```cpp\n// problem: CF685C\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define mk make_pair\n#define fi first\n#define se second\n#define SZ(x) ((int)(x).size())\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\n\ntemplate<typename T> inline void ckmax(T& x, T y) { x = (y > x ? y : x); }\ntemplate<typename T> inline void ckmin(T& x, T y) { x = (y < x ? y : x); }\n\n/* --------------- fast io --------------- */ // begin\nnamespace Fread {\nconst int SIZE = 1 << 21;\nchar buf[SIZE], *S, *T;\ninline char getchar() {\n\tif (S == T) {\n\t\tT = (S = buf) + fread(buf, 1, SIZE, stdin);\n\t\tif (S == T) return '\\n';\n\t}\n\treturn *S++;\n}\n} // namespace Fread\nnamespace Fwrite {\nconst int SIZE = 1 << 21;\nchar buf[SIZE], *S = buf, *T = buf + SIZE;\ninline void flush() {\n\tfwrite(buf, 1, S - buf, stdout);\n\tS = buf;\n}\ninline void putchar(char c) {\n\t*S++ = c;\n\tif (S == T) flush();\n}\nstruct NTR {\n\t~ NTR() { flush(); }\n} ztr;\n} // namespace Fwrite\n#ifdef ONLINE_JUDGE\n\t#define getchar Fread :: getchar\n\t#define putchar Fwrite :: putchar\n#endif\nnamespace Fastio {\nstruct Reader {\n\ttemplate<typename T>\n\tReader& operator >> (T& x) {\n\t\tchar c = getchar();\n\t\tT f = 1;\n\t\twhile (c < '0' || c > '9') {\n\t\t\tif (c == '-') f = -1;\n\t\t\tc = getchar();\n\t\t}\n\t\tx = 0;\n\t\twhile (c >= '0' && c <= '9') {\n\t\t\tx = x * 10 + (c - '0');\n\t\t\tc = getchar();\n\t\t}\n\t\tx *= f;\n\t\treturn *this;\n\t}\n\tReader& operator >> (char& c) {\n\t\tc = getchar();\n\t\twhile (c == '\\n' || c == ' ') c = getchar();\n\t\treturn *this;\n\t}\n\tReader& operator >> (char* str) {\n\t\tint len = 0;\n\t\tchar c = getchar();\n\t\twhile (c == '\\n' || c == ' ') c = getchar();\n\t\twhile (c != '\\n' && c != ' ') {\n\t\t\tstr[len++] = c;\n\t\t\tc = getchar();\n\t\t}\n\t\tstr[len] = '\\0';\n\t\treturn *this;\n\t}\n\tReader(){}\n} cin;\nconst char endl = '\\n';\nstruct Writer {\n\ttemplate<typename T>\n\tWriter& operator << (T x) {\n\t\tif (x == 0) { putchar('0'); return *this; }\n\t\tif (x < 0) { putchar('-'); x = -x; }\n\t\tstatic int sta[45];\n\t\tint top = 0;\n\t\twhile (x) { sta[++top] = x % 10; x /= 10; }\n\t\twhile (top) { putchar(sta[top] + '0'); --top; }\n\t\treturn *this;\n\t}\n\tWriter& operator << (char c) {\n\t\tputchar(c);\n\t\treturn *this;\n\t}\n\tWriter& operator << (char* str) {\n\t\tint cur = 0;\n\t\twhile (str[cur]) putchar(str[cur++]);\n\t\treturn *this;\n\t}\n\tWriter& operator << (const char* str) {\n\t\tint cur = 0;\n\t\twhile (str[cur]) putchar(str[cur++]);\n\t\treturn *this;\n\t}\n\tWriter(){}\n} cout;\n} // namespace Fastio\n#define cin Fastio :: cin\n#define cout Fastio :: cout\n#define endl Fastio :: endl\n/* --------------- fast io --------------- */ // end\n\nconst int MAXN = 1e5;\nconst ll MAX_ANS = 3e18;\nconst ll LL_INF = 9e18;\n\nint n;\nstruct Point {\n\tll x, y, z;\n} p[MAXN + 5];\n\nll c(ll x) {\n\t// ceil(x / 2)\n\t\n\tif (x >= 0) {\n\t\treturn (x + 1) / 2;\n\t} else {\n\t\treturn -((-x) / 2);\n\t}\n}\nll f (ll x) {\n\t// floor(x / 2)\n\t\n\tif (x >= 0) {\n\t\treturn x / 2;\n\t} else {\n\t\treturn -((-x + 1) / 2);\n\t}\n}\n\nPoint ans;\nbool check(ll d, bool _calc_ans = false) {\n\tll l1 = -LL_INF, l2 = -LL_INF, l3 = -LL_INF, l4 = -LL_INF;\n\tll r1 = LL_INF, r2 = LL_INF, r3 = LL_INF, r4 = LL_INF;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tckmax(l1, -d + p[i].x + p[i].y + p[i].z);\n\t\tckmax(l2, -d - p[i].x + p[i].y + p[i].z);\n\t\tckmax(l3, -d + p[i].x - p[i].y + p[i].z);\n\t\tckmax(l4, -d + p[i].x + p[i].y - p[i].z);\n\t\tckmin(r1, d + p[i].x + p[i].y + p[i].z);\n\t\tckmin(r2, d - p[i].x + p[i].y + p[i].z);\n\t\tckmin(r3, d + p[i].x - p[i].y + p[i].z);\n\t\tckmin(r4, d + p[i].x + p[i].y - p[i].z);\n\t}\n\tfor (int t = 0; t <= 1; ++t) {\n\t\tll _l1 = c(l1 - 3 * t), _r1 = f(r1 - 3 * t);\n\t\tll _l2 = c(l2 - t), _r2 = f(r2 - t);\n\t\tll _l3 = c(l3 - t), _r3 = f(r3 - t);\n\t\tll _l4 = c(l4 - t), _r4 = f(r4 - t);\n\t\t\n\t\tif (_l1 <= _r1 && _l2 <= _r2 && _l3 <= _r3 && _l4 <= _r4 && _l2 + _l3 + _l4 <= _r1 && _r2 + _r3 + _r4 >= _l1) {\n\t\t\tif (!_calc_ans) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\t\n\t\t\tll _a = _l2;\n\t\t\tll _b = _l3;\n\t\t\tll _c = _l4;\n\t\t\t\n\t\t\tll rest = max(0LL, _l1 - (_l2 + _l3 + _l4));\n\t\t\tll add;\n\t\t\tadd = min(rest, _r2 - _l2);\n\t\t\t_a += add, rest -= add;\n\t\t\tadd = min(rest, _r3 - _l3);\n\t\t\t_b += add, rest -= add;\n\t\t\tadd = min(rest, _r4 - _l4);\n\t\t\t_c += add, rest -= add;\n\t\t\tassert(rest == 0);\n\t\t\t\n\t\t\tll a = _a * 2 + t;\n\t\t\tll b = _b * 2 + t;\n\t\t\tll c = _c * 2 + t;\n\t\t\t\n\t\t\tassert(l1 <= a + b + c); assert(a + b + c <= r1);\n\t\t\tassert(l2 <= a); assert(a <= r2);\n\t\t\tassert(l3 <= b); assert(b <= r3);\n\t\t\tassert(l4 <= c); assert(c <= r4);\n\t\t\t\n\t\t\tans.x = (b + c) / 2;\n\t\t\tans.y = (a + c) / 2;\n\t\t\tans.z = (a + b) / 2;\n\t\t\t\n\t\t\treturn true;\n\t\t}\n\t\t\n\t}\n\treturn false;\n}\n\nvoid solve_case() {\n\tcin >> n;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tcin >> p[i].x >> p[i].y >> p[i].z;\n\t}\n\t\n\t// for (int i = 0; i <= 10; ++i) cerr << check(i); cerr << endl;\n\tll l = 0, r = LL_INF;\n\twhile (l < r) {\n\t\tll mid = (l + r) >> 1;\n\t\tif (check(mid)) {\n\t\t\tr = mid;\n\t\t} else {\n\t\t\tl = mid + 1;\n\t\t}\n\t}\n\tcerr << l << endl;\n\tcheck(l, true);\n\tcout << ans.x << \" \" << ans.y << \" \" << ans.z << endl;\n}\nint main() {\n\tint T; cin >> T; while (T--) {\n\t\tsolve_case();\n\t}\n\treturn 0;\n}\n```\n\n\n\n",
        "postTime": 1610273697,
        "uid": 100674,
        "name": "duyi",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF685C \u3010Optimal Point\u3011"
    },
    {
        "content": "[Codeforces \u9898\u9762\u4f20\u9001\u95e8](https://codeforces.ml/contest/685/problem/C) & [\u6d1b\u8c37\u9898\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF685C)\n\n\u5206\u7c7b\u8ba8\u8bba\u795e\u9898\u3002\n\n\u9996\u5148\u770b\u5230\u6700\u5927\u503c\u6700\u5c0f\uff0c\u4e00\u773c\u4e8c\u5206\u7b54\u6848\uff0c\u4e8e\u662f\u95ee\u9898\u8f6c\u5316\u4e3a\u5224\u5b9a\u6027\u95ee\u9898\uff0c\u5373\u662f\u5426 $\\exists x_0,y_0,z_0$ \u6ee1\u8db3 $\\forall i,|x_0-x_i|+|y_0-y_i|+|z_0-z_i|\\le mid$\u3002\n\n\u67ff\u5b50\u4e2d\u5e26\u4e2a\u7edd\u5bf9\u503c\uff0c\u4e0d\u597d\u76f4\u63a5\u8f6c\u5316\u3002\u4e0d\u8fc7\u6ce8\u610f\u5230\u5bf9\u4e8e\u4efb\u610f\u5b9e\u6570 $x$ \u90fd\u6709 $x\\le |x|,-x\\le |x|$\uff0c\u56e0\u6b64 $|x-y|\\le v$ \u7684\u5145\u8981\u6761\u4ef6\u5373\u662f $x-y\\le v,y-x\\le v$\uff0c\u56e0\u6b64\u4e0a\u5f0f\u53ef\u4ee5\u628a\u7edd\u5bf9\u503c\u62c6\u5f00\u5f97\u5230\uff1a\n$$\n\\begin{cases}\nx_0-x_i+y_0-y_i+z_0-z_i\\le mid\\\\\nx_0-x_i+y_0-y_i+z_i-z_0\\le mid\\\\\nx_0-x_i+y_i-y_0+z_0-z_i\\le mid\\\\\nx_0-x_i+y_i-y_0+z_i-z_0\\le mid\\\\\nx_i-x_0+y_0-y_i+z_0-z_i\\le mid\\\\\nx_i-x_0+y_0-y_i+z_i-z_0\\le mid\\\\\nx_i-x_0+y_i-y_0+z_0-z_i\\le mid\\\\\nx_i-x_0+y_i-y_0+z_i-z_0\\le mid\n\\end{cases}\n$$\n\u5c06\u4e0a\u5f0f\u6574\u7406\u4e00\u4e0b\u53ef\u4ee5\u5f97\u5230\uff1a\n$$\n\\begin{cases}\nx_i+y_i+z_i-mid\\le x_0+y_0+z_0\\le x_i+y_i+z_i+mid\\\\\n-x_i+y_i+z_i-mid\\le -x_0+y_0+z_0\\le -x_i+y_i+z_i+mid\\\\\nx_i-y_i+z_i-mid\\le x_0-y_0+z_0\\le x_i-y_i+z_i+mid\\\\\nx_i+y_i-z_i-mid\\le x_0+y_0-z_0\\le x_i+y_i-z_i+mid\n\\end{cases}\n$$\n\u8bb0 $A_{l}=\\max\\limits_{i=1}^nx_i+y_i+z_i-mid,A_{r}=\\min\\limits_{i=1}^nx_i+y_i+z_i-mid$\uff0c$B_{l},B_r,C_l,C_r,D_l,D_r$ \u4e5f\u540c\u7406\uff0c\u90a3\u4e48\u663e\u7136\u4e0a\u8ff0\u67ff\u5b50\u53ef\u4ee5\u7b49\u6548\u4e8e\uff1a\n$$\n\\begin{cases}\nA_l\\le x_0+y_0+z_0\\le A_r\\\\\nB_l\\le -x_0+y_0+z_0\\le B_r\\\\\nC_l\\le x_0-y_0+z_0\\le C_r\\\\\nD_l\\le x_0+y_0+z_0\\le D_r\n\\end{cases}\n$$\n\u6ce8\u610f\u5230\u8fd9\u56db\u4e2a\u4e0d\u7b49\u5f0f\u4e2d\u95f4\u4e00\u9879\u90fd\u5e26\u4e09\u4e2a\u672a\u77e5\u6570\uff0c\u4e0d\u597d\u5904\u7406\uff0c\u4e0d\u8fc7\u8fd9\u4e09\u4e2a\u672a\u77e5\u6570\u4e4b\u95f4\u53c8\u5b58\u5728\u67d0\u79cd\u8054\u7cfb\uff0c\u56e0\u6b64\u8003\u8651\u8bb0 $a=-x_0+y_0+z_0,b=x_0-y_0+z_0,c=x_0+y_0-z_0$\uff0c\u90a3\u4e48\u6709 $x_0=\\dfrac{b+c}{2},y_0=\\dfrac{a+c}{2},z_0=\\dfrac{a+b}{2}$\u3002\u6211\u4eec\u8fd8\u53ef\u4ee5\u6ce8\u610f\u5230 $x_0+y_0+z_0=a+b+c$\uff0c\u56e0\u6b64\u67ff\u5b50\u53c8\u8f6c\u5316\u4e3a\n$$\n\\begin{cases}\nA_l\\le a+b+c\\le A_r\\\\\nB_l\\le a\\le B_r\\\\\nC_l\\le b\\le C_r\\\\\nD_l\\le c\\le D_r\n\\end{cases}\n$$\n\u5f53\u7136\u8fd9\u91cc\u6709\u4e00\u4e2a restriction \u662f $x_0,y_0,z_0$ \u5fc5\u987b\u90fd\u662f\u6574\u6570\uff0c\u56e0\u6b64\u5fc5\u987b\u6709 $a\\equiv b\\equiv c\\pmod{2}$\u3002\u6545\u8003\u8651\u679a\u4e3e $r=a\\bmod 2$\uff0c\u8bb0 $a'=\\dfrac{a-r}{2},b'=\\dfrac{b-r}{2},c'=\\dfrac{c-r}{2}$\uff0c\u90a3\u4e48\u4e0a\u5f0f\u53c8\u53d8\u4e3a\uff1a\n$$\n\\begin{cases}\n\\lceil\\dfrac{A_l-3r}{2}\\rceil\\le a'+b'+c'\\le\\lfloor\\dfrac{A_r-3r}{2}\\rfloor\\\\\n\\lceil\\dfrac{B_l-r}{2}\\rceil\\le a'\\le\\lfloor\\dfrac{B_r-r}{2}\\rfloor\\\\\n\\lceil\\dfrac{C_l-r}{2}\\rceil\\le b'\\le\\lfloor\\dfrac{C_r-r}{2}\\rfloor\\\\\n\\lceil\\dfrac{D_l-r}{2}\\rceil\\le c'\\le\\lfloor\\dfrac{D_r-r}{2}\\rfloor\n\\end{cases}\n$$\n\u8fd9\u4e2a\u968f\u4fbf\u6c42\u4e00\u6c42\u5c31\u884c\u4e86\uff0c~~\u6211\u76f8\u4fe1\u5373\u4fbf\u521a\u5b66\u8fc7 OI \u7684\u5e94\u8be5\u4e5f\u4f1a\u7f62~~\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $n\\log A$\uff0c\u5176\u4e2d $A=\\max\\{a_i\\}$\n\n```cpp\nconst int MAXN=1e5;\nconst ll INF=7e18; \nint n;ll x[MAXN+5],y[MAXN+5],z[MAXN+5],X,Y,Z;\nll down(ll x){return (x>=0)?(x>>1):(-(-x+1>>1));}//\\lfloor x/2 \\rfloor\nll up(ll x){return (x>=0)?(x+1>>1):(-(-x>>1));}//\\lceil x/2 \\rceil\nbool check(ll mid){\n\tll al=-INF,ar=INF,bl=-INF,br=INF;\n\tll cl=-INF,cr=INF,dl=-INF,dr=INF;\n\tfor(int i=1;i<=n;i++){\n\t\tchkmax(al,x[i]+y[i]+z[i]-mid);chkmin(ar,x[i]+y[i]+z[i]+mid);\n\t\tchkmax(bl,-x[i]+y[i]+z[i]-mid);chkmin(br,-x[i]+y[i]+z[i]+mid);\n\t\tchkmax(cl,x[i]-y[i]+z[i]-mid);chkmin(cr,x[i]-y[i]+z[i]+mid);\n\t\tchkmax(dl,x[i]+y[i]-z[i]-mid);chkmin(dr,x[i]+y[i]-z[i]+mid);\n\t}\n\tfor(int r=0;r<2;r++){\n\t\tll wl=up(al-3*r),wr=down(ar-3*r);\n\t\tll xl=up(bl-r),xr=down(br-r);\n\t\tll yl=up(cl-r),yr=down(cr-r);\n\t\tll zl=up(dl-r),zr=down(dr-r);\n\t\tif(wl<=wr&&xl<=xr&&yl<=yr&&zl<=zr&&xl+yl+zl<=wr&&xr+yr+zr>=wl){\n\t\t\tll a=xl,b=yl,c=zl,need=max(0ll,wl-xl-yl-zl);\n\t\t\ta+=min(need,xr-xl);need-=min(need,xr-xl);\n\t\t\tb+=min(need,yr-yl);need-=min(need,yr-yl);\n\t\t\tc+=min(need,zr-zl);need-=min(need,zr-zl);\n\t\t\ta=(a<<1|r);b=(b<<1|r);c=(c<<1|r);\n\t\t\tX=b+c>>1;Y=c+a>>1;Z=a+b>>1;return 1;\n\t\t}\n\t} return 0;\n}\nvoid solve(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++) scanf(\"%lld%lld%lld\",&x[i],&y[i],&z[i]);\n\tll l=0,r=INF>>1,p=-1;\n\twhile(l<=r){\n\t\tll mid=l+r>>1;\n\t\tif(check(mid)) p=mid,r=mid-1;\n\t\telse l=mid+1;\n\t} check(p);//printf(\"%lld\\n\",p);\n\tprintf(\"%lld %lld %lld\\n\",X,Y,Z);\n}\nint main(){\n\tint qu;scanf(\"%d\",&qu);\n\twhile(qu--) solve();\n\treturn 0;\n}\n```\n\n",
        "postTime": 1625998551,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF685C Optimal Point"
    }
]
[
    {
        "content": "\u9898\u610f\u975e\u5e38\u7b80\u5355\uff0c\u5c31\u662f\u6c42\u5706\u9525\u4e0a\u4e24\u70b9\uff08\u8bbe\u4e3a $A$ \u548c $B$ \uff09\u7684\u6700\u5c0f\u8868\u9762\u8ddd\u79bb\u3002\n### \u5206\u6790\n\u6765\u8003\u8651\u4e00\u4e0b\u4e24\u4e2a\u70b9\u7684\u4f4d\u7f6e\u60c5\u51b5\uff1a\n\n- \u4e24\u4e2a\u70b9\u90fd\u5728\u5e95\u9762\n\n\u8fd9\u79cd\u60c5\u51b5\u5f88\u663e\u7136\u76f4\u63a5\u8ba1\u7b97\u6b27\u51e0\u91cc\u5f97\u8ddd\u79bb\u5c31\u884c\u4e86\u3002\n\n- \u4e00\u4e2a\u70b9\u5728\u4fa7\u9762\uff0c\u4e00\u4e2a\u70b9\u5728\u5e95\u9762\n\n\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6682\u65f6\u8fd8\u6ca1\u6709\u60f3\u5230\u4ec0\u4e48\u7b80\u5355\u7684\u51e0\u4f55\u8ba1\u7b97\u65b9\u6cd5\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u66b4\u529b\u679a\u4e3e\u5e95\u9762\u5706\u4e0a\u7684\u70b9\uff0c\u53d6\u6700\u5c0f\u503c\u3002\n\n- \u4e24\u4e2a\u70b9\u5728\u4fa7\u9762\n\n\u53ef\u80fd\u5f88\u591a\u4eba\u90fd\u4f1a\u89c9\u5f97\uff0c\u4fa7\u9762\u4e0a\u4e24\u70b9\u7684\u6700\u5c0f\u8868\u9762\u8ddd\u79bb\u5c31\u662f\u628a\u4fa7\u9762\u5c55\u5f00\u6210\u6247\u5f62\u540e\u518d\u6c42\u4e24\u70b9\u7684\u6b27\u51e0\u91cc\u5f97\u8ddd\u79bb\u3002\u4f46\u662f\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u6837\u5e76\u4e0d\u603b\u662f\u6700\u4f18\u7684\uff0c\u6700\u77ed\u8ddd\u79bb\u662f\u53ef\u80fd\u7ecf\u8fc7\u5e95\u9762\u7684\uff0c\u4f8b\u5982\u4e0b\u9762\u4e00\u7ec4\u6570\u636e\uff1a\n>\u9876\u70b9\u5750\u6807\uff080\uff0c0,100\uff09\uff1b\u5e95\u9762\u534a\u5f84100\uff1b\u4e24\u70b9\u5750\u6807\u5206\u522b\u4e3a\uff0899\uff0c0\uff0c1\uff09\uff0c\uff08-99\uff0c0\uff0c1\uff09\uff1b\u5982\u679c\u662f\u5728\u4fa7\u9762\u4e0a\u7684\u8bdd\u7b97\u51fa\u6765\u662f $198\\sqrt2\\times\\sin\\frac{\\sqrt2}{4}\\pi\\approx250.898$\uff0c\u5982\u679c\u6309\u7ecf\u8fc7\u5e95\u9762\u6765\u7b97\u7684\u8bdd\u662f $200+2\\sqrt2\\approx202.828$\n\n\uff08\u4e8b\u5b9e\u4e0a\u5f53\u4e24\u4e2a\u70b9\u8ddd\u79bb\u5e95\u9762\u8f83\u8fd1\u65f6\uff0c\u6700\u77ed\u8ddd\u79bb\u5927\u6982\u7387\u662f\u7ecf\u8fc7\u5e95\u9762\u7684\uff0c\u800c\u4e0d\u662f\u5728\u4fa7\u9762\u3002\uff09\n\n\u8ba1\u7b97\u7ecf\u8fc7\u5e95\u9762\u7684\u8def\u5f84\u65f6\u53ef\u4ee5\u5728\u5e95\u9762\u5706\u4e0a\u679a\u4e3e\u4e24\u4e2a\u70b9\uff0c\u518d\u8ba1\u7b97\u5e95\u9762\u4e24\u70b9\u7684\u8ddd\u79bb\u52a0\u4e0a\u4fa7\u9762\u7684\u8ddd\u79bb\uff0c\u5982\u4e0b\u56fe\u7ea2\u7ebf\uff0c\u53d6\u6700\u5c0f\u503c\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/i1rxhgxr.png)\n\n\u7efc\u4e0a\u6211\u4eec\u5c31\u7406\u8bba\u505a\u51fa\u4e86\u8fd9\u9053\u9898\u4e86\uff0c\u4ee3\u7801\u7ec6\u8282\u5f88\u591a\uff0c\u8fd8\u6709\u4e00\u4e9b\u5c0f\u6280\u5de7\uff0c\u6765\u770b\u770b\u5177\u4f53\u5b9e\u73b0\n\n### \u4ee3\u7801\u5b9e\u73b0\n\u63a5\u4e0b\u6765\u6211\u4f1a\u8be6\u7ec6\u8bf4\u660e\u4e24\u4e2a\u6700\u91cd\u8981\u7684\u51fd\u6570\u7684\u4ee3\u7801\u5b9e\u73b0\n\n- \u8ba1\u7b97\u5706\u9525\u5e95\u9762\u4e24\u70b9\u7684\u8ddd\u79bb\uff1a\n\n\u7528\u7a7a\u95f4\u4e24\u70b9\u8ddd\u79bb\u516c\u5f0f\uff08z \u5176\u5b9e\u53ef\u4ee5\u7701\u53bb\uff09\n```cpp\nint d(point a1,point a2){\n    return sqrt((a1.x-a2.x)*(a1.x-a2.x)+(a1.y-a2.y)*(a1.y-a2.y)+(a1.z-a2.z)*(a1.z-a2.z));\n}\n```\n- \u8ba1\u7b97\u5706\u9525\u4fa7\u9762\u4e24\u70b9\u7684\u8ddd\u79bb\uff1a\n\n\u6211\u4eec\u9700\u8981\u5206\u522b\u8fde\u63a5\u9876\u70b9\u548c $A$\uff0c\u9876\u70b9\u548c $B$\uff0c\u5982\u56fe\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/mcys3hvk.png)\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u90e8\u5206\u7ea2\u8272\u7684\u53d6\u51fa\u6765\uff0c\u5c55\u5f00\u8fd9\u90e8\u5206\u7684\u4fa7\u9762\uff0c\u73b0\u5728\u6211\u4eec\u628a\u5176\u4e2d\u4e00\u8fb9\u653e\u5728x\u8f74\uff0c$A$ \u7684\u5750\u6807\u4e3a $(l_{AV},0)$\uff0c$B$ \u7684\u5750\u6807\u4e3a $(l_{BV}\\cos\\angle_{AVB} , l_{BV}\\sin\\angle_{AVB})$ \u5982\u56fe\uff1b\n![](https://cdn.luogu.com.cn/upload/image_hosting/lcdqhfdo.png)\n\n\u53d1\u73b0 $\\angle_{AVB}=$ \u5f27$FG\\div VG$\uff0c$VG$ \u662f\u5706\u9525\u6bcd\u7ebf\u7684\u957f\u5ea6\uff0c\u53ef\u4ee5\u5229\u7528\u52fe\u80a1\u5b9a\u7406 $VG^2=h^2+r^2$ \u6c42\u51fa\uff0c\u5f27$FG$ \u7684\u957f\u5ea6\u600e\u4e48\u6c42\uff1f\n\n\u56de\u5230\u4e0a\u9762\u7684\u7acb\u4f53\u56fe\u5f62\u53ef\u4ee5\u53d1\u73b0\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u5e95\u9762\u5706\u6c42\u51fa\u5f27$FG$\u3002\u8fd9\u9700\u8981\u6211\u4eec\u6c42\u51fa $\\angle_{FOG}$\uff0c\u53ef\u4ee5\u5229\u7528 $A$\uff0c$B$ \u7684 x , y \u5750\u6807\u518d\u5229\u7528\u53cd\u6b63\u5207\u51fd\u6570\uff08atan\uff09\u6c42\u51fa\u3002\n\n```cpp\nint solve(point a1,point a2){\n    int res;\n    if(abs(a1.z)<eps&&abs(a2.z)<eps) return d(a1,a2);\n    \n    int l1=d(a1,vertex),l2=d(a2,vertex);\n    int A=atan2(a2.y,a2.x)-atan2(a1.y,a1.x);\n    \n    while(A<-eps) A+=2*pi;\n    while(A>2*pi-eps) A-=2*pi;//\u8fd9\u91cc\u662f\u5c06\u2220FOG\u5316\u52300~90\u5ea6\n    if(A>pi) A=2*pi-A;\n    \n    int B=(A*r)/sqrt(r*r+h*h);//\u6c42\u2220AVB\n    int u1=0,v1=l1,u2=l2*sin(B),v2=l2*cos(B);\n    res=sqrt((u1-u2)*(u1-u2)+(v1-v2)*(v1-v2));\n    B=2*pi-B;//\u8fd9\u91cc\u8fd8\u9700\u8981\u8003\u8651\u2220AVB\u7684\u8865\u89d2\n    u1=0,v1=l1,u2=l2*sin(B),v2=l2*cos(B);\n    res=min(res,sqrt((u1-u2)*(u1-u2)+(v1-v2)*(v1-v2)));\n    return res;\n}\n```\n\u6709\u4e86\u4e0a\u8ff0\u4e24\u4e2a\u5173\u952e\u51fd\u6570\u6211\u4eec\u5c31\u80fd\u6109\u5feb\u7684\u5207\u6389\u8fd9\u9053\u9898\u4e86\u3002\n\n\n- \u5c0ftips\n\n\u6211\u4eec\u679a\u4e3e\u7684\u65f6\u5019\u4e0d\u7528\u4ee5\u7cbe\u5ea6\u4e3a\u6b65\u957f\u6765\u679a\u4e3e\uff0c\u56e0\u4e3a\u8fd9\u6837\u4f1a\u679a\u4e3e\u5f88\u591a\u6b21\uff0c\u76f4\u63a5TLE\uff0c\u53ef\u4ee5\u5148\u5927\u6b65\u7684\u8df3\uff0c\u518d\u6839\u636e\u5927\u6b65\u957f\u5f97\u5230\u4e00\u4e2a\u7c97\u7565\u7b54\u6848\uff0c\u8c03\u6574\u533a\u95f4\uff0c\u8fdb\u884c\u7cbe\u5ea6\u4e8c\u5206\u3002\n\n\u5b8c\u6574\u4ee3\u7801\uff08\u8be6\u89c1\u6ce8\u91ca\uff09\n```cpp\n#include<bits/stdc++.h>\n#define int double\nusing namespace std;\nconst int eps=1e-7,pi=acos(-1.0);\nint ans,r,h,la,ra,mxa,mya,lb,rb,mxb,myb,lv,rv,step=pi/20;\nstruct point{int x,y,z;}vertex,a,b;\nint d(point a1,point a2){ //\u7a7a\u95f4\u4e24\u70b9\u8ddd\u79bb \n    return sqrt((a1.x-a2.x)*(a1.x-a2.x)+(a1.y-a2.y)*(a1.y-a2.y)+(a1.z-a2.z)*(a1.z-a2.z));\n}\nint solve(point a1,point a2){ //\u8ba1\u7b97\u5706\u9525\u4fa7\u9762\u5c55\u5f00\u56fe\u4e0a\u4e24\u70b9\u8ddd\u79bb\uff0c\u4ee5\u53ca\u4e24\u70b9\u90fd\u5728\u5e95\u9762\u7684\u8ddd\u79bb \n    int res;\n    if(abs(a1.z)<eps&&abs(a2.z)<eps) return d(a1,a2);\n    \n    int l1=d(a1,vertex),l2=d(a2,vertex);\n    int A=atan2(a2.y,a2.x)-atan2(a1.y,a1.x);\n    \n    while(A<-eps) A+=2*pi;\n    while(A>2*pi-eps) A-=2*pi;//\u8fd9\u91cc\u662f\u5c06\u2220FOG\u5316\u52300~90\u5ea6\n    if(A>pi) A=2*pi-A;\n    \n    int B=(A*r)/sqrt(r*r+h*h);//\u6c42\u2220AVB\n    int u1=0,v1=l1,u2=l2*sin(B),v2=l2*cos(B);\n    res=sqrt((u1-u2)*(u1-u2)+(v1-v2)*(v1-v2));\n    B=2*pi-B;//\u8fd9\u91cc\u8fd8\u9700\u8981\u8003\u8651\u2220AVB\u7684\u8865\u89d2\n    u1=0,v1=l1,u2=l2*sin(B),v2=l2*cos(B);\n    res=min(res,sqrt((u1-u2)*(u1-u2)+(v1-v2)*(v1-v2)));\n    return res;\n}\n\nint get_line_basement(int A,int B){ //\u8ba1\u7b97\u4e24\u4e2a\u70b9\u90fd\u5728\u4fa7\u9762\uff0c\u7ecf\u8fc7\u5e95\u9762\u7684\u60c5\u51b5 \n    point aa=(point){r*cos(A),r*sin(A),0};\n\tpoint bb=(point){r*cos(B),r*sin(B),0};\n\treturn solve(a,aa)+solve(b,bb)+d(aa,bb);\n}\n\nint get_min_line(int A){//\u8fd9\u662f\u679a\u4e3e\u4e24\u4e2a\u70b9\u65f6\u4e3a\u4e86\u4fdd\u8bc1\u7cbe\u5ea6\u989d\u5916\u63d0\u51fa\u6765\u7684\u4e00\u7ef4\u679a\u4e3e \n    int B,vl,ch,ret=1919810;\n    for(B=0;B<2*pi;B+=step){\n    \tvl=get_line_basement(A,B);\n    \tif(ret>vl){\n    \t\tret=vl;\n    \t\tch=B;\n    \t}\n    }\n    lb=max(0.0,ch-step);\n    rb=min(2*pi,ch+step);\n    while(lb<rb){\n    \tmxb=0.5*(lb+rb);\n    \tmyb=mxb+eps;\n    \tif(get_line_basement(A,mxb)>get_line_basement(A,myb)) lb=mxb+eps;\n        else rb=mxb-eps;\n    }\n    vl=get_line_basement(A,0.5*(lb+rb));\n    if(ret>vl) ret=vl;\n    return ret;\n}\nsigned main(){\n    scanf(\"%lf%lf\",&r,&h);\n    scanf(\"%lf%lf%lf\",&a.x,&a.y,&a.z);\n    scanf(\"%lf%lf%lf\",&b.x,&b.y,&b.z);\n    ans=1919810;\n    vertex=(point){0,0,h};\n    if(abs(a.z)<eps&&abs(b.z)<eps) return printf(\"%0.9f\",d(a,b)),0;//\u4e24\u70b9\u90fd\u5728\u5e95\u9762 \n\tif(abs(b.z)<eps){\n    \tswap(a.x,b.x);\n    \tswap(a.y,b.y);\n    \tswap(a.z,b.z);\n    }\n    if(abs(a.z)<eps&&abs(b.z)>eps){//\u4e00\u4e2a\u5728\u5e95\u9762\uff0c\u4e00\u4e2a\u5728\u4fa7\u9762 \n    \tint B,vl,ch,mi=1919810;\n        for(B=0;B<2*pi;B+=step){//\u66b4\u529b\u679a\u4e3e\u4e24\u4e2a\u5706\u4e0a\u7684\u70b9 \n    \t    point t=(point){r*cos(B),r*sin(B),0}; \n\t\t\tvl=solve(a,t)+solve(b,t);\n    \t\tif(mi>vl){\n    \t\t\tmi=vl;\n    \t\t\tch=B;\n    \t\t}\n    \t\tif(ans>vl) ans=vl;\n    \t}\n    \tla=max(0.,ch-step);\n    \tra=min(2*pi,ch+step);\n    \twhile(la<ra){\n    \t\tmxa=0.5*(la+ra);\n    \t\tmya=mxa+eps;\n    \t\tpoint t1=(point){r*cos(mxa),r*sin(mxa),0};\n    \t\tpoint t2=(point){r*cos(mya),r*sin(mya),0};\n    \t\tlv=solve(a,t1)+solve(b,t1);\n        \trv=solve(a,t2)+solve(b,t2);\n    \t\tif(lv>rv) la=mxa+eps;\n    \t\telse ra=mxa-eps;\t\n    \t}\n    \tpoint tool=(point){r*cos(0.5*(la+ra)),r*sin(0.5*(la+ra)),0};\n    \tvl=solve(a,tool)+solve(b,tool);\n    \tif(ans>vl) ans=vl;\n    \treturn printf(\"%0.9f\",ans),0;\n\t}\n\tif(abs(a.z)>eps&&abs(b.z)>eps){//\u4e24\u70b9\u90fd\u5728\u4fa7\u9762 \n\t\tans=min(ans,solve(a,b));//\u4fa7\u9762\u5c55\u5f00\u8def\u5f84 \n\t\tint B,vl,ch,mi=1919810;\n    \tfor(B=0;B<2*pi;B+=step){\n    \t\tvl=get_min_line(B);//\u66b4\u529b\u679a\u4e3e\u5706\u4e0a\u7684\u4e24\u70b9 \n    \t\tif(mi>vl){\n            \tmi=vl;\n            \tch=B;\n        \t}\n        \tif(ans>vl) ans=vl;\n    \t}\n    \tla=max(0.0,ch-step);\n    \tra=min(2*pi,ch+step);\n    \twhile(la<ra){\n        \tmxa=0.5*(la+ra);\n        \tmya=mxa+eps;\n    \t\tif(get_min_line(mxa)>get_min_line(mya)) la=mxa+eps;\n    \t\telse ra=mxa-eps;\n    \t}\n    \tvl=get_min_line(0.5*(la+ra));\n    \tif(ans>vl) ans=vl;\n    \tprintf(\"%.9f\\n\",ans);\n\t}\n}\n```\n\n\n",
        "postTime": 1630208392,
        "uid": 376125,
        "name": "_outcast_",
        "ccfLevel": 0,
        "title": "CF142E Help Greg the Dwarf 2"
    }
]
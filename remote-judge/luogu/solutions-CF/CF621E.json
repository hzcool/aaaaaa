[
    {
        "content": "\u9996\u5148\uff0c\u4e00\u4e2adp\u5e94\u8be5\u662f\u663e\u7136\u7684\u3002\n\n$dp[i][j]$ \u8868\u793a\u9009\u5230\u7b2c $i$ \u4e2a\u683c\u5b50\uff0c\u4f59\u6570\u662f $j$ \u7684\u65b9\u6848\u6570\uff0c\u679a\u4e3e\u53d6\u6570 $l$\uff0c\u5f97\u5230\n\n$$dp[i+1][(10j+a_{l})\\bmod x]\\text{ += }dp[i][j]$$\n\n\u53ef\u4ee5\u53d1\u73b0\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $dp[i]$\uff0c\u8f6c\u79fb\u90fd\u662f\u7c7b\u4f3c\u7684\u3002\n\n\u7136\u540e\u6211\u4eec\u8003\u8651\u7528\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\u8f6c\u79fb\u3002\n\n\u521d\u59cb\u72b6\u6001 $dp[0]$ \u662f\n$$\\begin{bmatrix}1\\\\0\\\\\\vdots\\\\0\\end{bmatrix}$$\n\n\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u6570 $v$\uff0c\u6211\u4eec\u4fee\u6539\u8f6c\u79fb\u77e9\u9635$A$\n$$A\\left[j\\right]\\left[\\left(10j+v\\right)\\bmod x\\right]\\text{ += }1$$\n\u7136\u540e\u6700\u7ec8\u7b54\u6848\u5c31\u662f $A^b\\times dp[0]$ \u7684\u7b2c $k$ \u884c\u4e86\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\ntypedef long long ll;\nll n, b, k, x;\nconst ll P = 1000000007;\nstruct Matrix {\n\tll a[105][105];\n};\n\nMatrix A, I;\n\ninline ll read() {\n\tll x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();}\n\treturn x*f;\n}\ninline Matrix MatrixMul(const Matrix &A, const Matrix &B) {\n\tMatrix ret;\n\tfor (int i=0; i<x; i++)\n\t\tfor (int j=0; j<x; j++) {\n\t\t\tret.a[i][j] = 0;\n\t\t\tfor (int k=0; k<x; k++)\n\t\t\t\t(ret.a[i][j] += A.a[i][k] * B.a[k][j] % P) %= P;\n\t\t}\n\treturn ret;\n}\ninline Matrix Pow(ll k){\n\tMatrix ans = I;\n\tfor (; k; k>>=1, A=MatrixMul(A, A)) if (k&1) ans = MatrixMul(ans, A);\n\treturn ans;\t\n}\n\nint main() {\n\tn = read(); b = read(); k = read(); x = read();\n\tfor (int i=0; i<x; i++) I.a[i][i] = 1;\n\tfor (int i=0; i<n; i++) {\n\t\tll val = read();\n\t\tfor (int j=0; j<x; j++)\n\t\t\t++A.a[j][(j*10%x+val%x)%x];\n\t}\n\tMatrix ret = Pow(b);\n\tcout << ret.a[0][k] << endl;\n\treturn 0;\n}\n\n```",
        "postTime": 1534231183,
        "uid": 15231,
        "name": "ChinaNB",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF621E \u3010Wet Shark and Blocks\u3011"
    },
    {
        "content": "[\u9898\u9762](https://www.luogu.com.cn/problem/CF621E)\n\n\u6709 $b$ \u4e2a\u683c\u5b50\uff0c\u6bcf\u4e2a\u683c\u5b50\u6709 $n$ \u4e2a\u6570\u5b57\uff0c\u5404\u4e2a\u683c\u5b50\u91cc\u9762\u7684\u6570\u5b57\u90fd\u662f\u76f8\u540c\u7684. \u6c42\u4ece $b$ \u4e2a\u683c\u5b50\u4e2d\u5404\u53d6\u4e00\u4e2a\u6570\u5b57,\u6784\u6210\u4e00\u4e2a $b$ \u4f4d\u6570\uff0c\u4f7f\u5f97\u8fd9\u4e2a $b$ \u4f4d\u6570\u6a21 $x$ \u4e3a $k$ \u7684\u65b9\u6848\u6570\uff08\u540c\u4e00\u683c\u5b50\u5185\u76f8\u540c\u7684\u6570\u5b57\u7b97\u4e0d\u540c\u65b9\u6848\uff09\u3002\n\n\u6211\u4eec\u8bbe $dp_{i,j}$ \u8868\u793a\u524d $i$ \u4e2a\u683c\u5b50\u4e2d\u53d6\u6570\u540e\uff0c\u6a21 $x$ \u7684\u7ed3\u679c\u4e3a $j$ \u7684\u65b9\u6848\u6570\u3002\n\n\u9012\u63a8\u5f0f\u4e5f\u5bb9\u6613\u63a8\u51fa\u6765\uff1a$dp_{i,(j\\times10+a_k)\\bmod x}=\\sum dp_{i-1,j}$\u3002\n\n\u4f46\u662f\uff0c\u8fd9\u6837\u663e\u7136\u4f1a TLE\u3002\u6240\u4ee5\u6211\u4eec\u9700\u8981\u4e00\u4e9b\u4f18\u5316\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i=\\overline{1,2,\\cdots,b}$\uff0c\u6211\u4eec\u53ef\u4ee5\u628a $dp_{i,j},j=\\overline{0,1,\\cdots,x-1}$ \u5f53\u505a\u4e00\u4e2a\u72b6\u6001\u3002\u7136\u540e\u6839\u636e\u6240\u7ed9\u7684 $a$ \u8fdb\u884c\u8f6c\u79fb\u3002\u7136\u540e\u7528\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\u5373\u53ef\u3002\n\n\u5bf9\u4e8e\u77e9\u9635\u5feb\u901f\u5e42\uff0c\u8fd9\u662f\u4e00\u79cd\u597d\u7528\u7684\u4f18\u5316\u9012\u63a8\u7684\u7b97\u6cd5\u3002\n\n\u9996\u5148\uff0c\u5b9a\u4e49\u77e9\u9635\u4e58\u6cd5\uff1a\n\n\u5bf9\u4e8e\u4e00\u4e2a $n\\times k$ \u7684\u77e9\u9635 $A$ \u548c\u4e00\u4e2a $k\\times m$ \u7684\u77e9\u9635 $B$ \u8fd8\u6709\u4e00\u4e2a\u77e9\u9635 $C=A\\times B$\u3002\u90a3\u4e48 $C$ \u662f\u4e00\u4e2a $n\\times m$ \u7684\u77e9\u9635\uff0c\u4e14 $C_{ij}=\\sum\\limits_{p=1}^kA_{i,p}\\times B_{p,j}(i=\\overline{1,2,\\cdots,n},j=\\overline{1,2,\\cdots,m})$\u3002\n\n\u7136\u540e\uff0c\u56e0\u4e3a\u77e9\u9635\u4e58\u6cd5\u6ee1\u8db3\u7ed3\u5408\u5f8b\uff0c\u6240\u4ee5\u6211\u4eec\u6709\u4e86\u77e9\u9635\u5feb\u901f\u5e42\u3002\u77e9\u9635\u5feb\u901f\u5e42\u7684\u8bdd\u5c31\u662f\u628a\u5feb\u901f\u5e42\u7684\u677f\u5b50\u5957\u5728\u77e9\u9635\u4e0a\u800c\u5df2\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n  #include<bits/stdc++.h>\n  #define int long long \n  using namespace std;\n  const int mod=1e9+7;\n  int n,b,x,k,a[50005];\n  struct M{\n      int a[100][100];//\u77e9\u9635\n      M operator*(M t){//\u4e58\n          M res;\n          for(int i=0;i<x;i++)for(int j=0;j<x;j++)res.a[i][j]=0;\n          for(int i=0;i<x;i++){\n              for(int j=0;j<x;j++){\n                  for(int k=0;k<x;k++){\n                      res.a[i][j]=(res.a[i][j]+a[i][k]*t.a[k][j]%mod)%mod;\n                  }\n              }\n          }\n          return res;\n      }\n      M operator^(int k){//\u5feb\u901f\u5e42\n          M res,_=*this;\n          for(int i=0;i<x;i++)for(int j=0;j<x;j++)res.a[i][j]=(i==j);\n          while(k){\n              if(k&1)res=res*_;\n              _=_*_;\n              k>>=1;\n          }\n          return res;\n      }\n  }ans,base;\n  signed main()\n  {\n      scanf(\"%lld%lld%lld%lld\",&n,&b,&k,&x);\n      for(int i=1;i<=n;i++)scanf(\"%lld\",&a[i]);\n      for(int i=0;i<x;i++)for(int j=0;j<x;j++)ans.a[i][j]=0;\n      for(int i=0;i<x;i++)for(int j=0;j<x;j++)base.a[i][j]=0;\n      ans.a[0][0]=1;\n      for(int i=0;i<x;i++){\n          for(int j=1;j<=n;j++){\n              base.a[(i*10+a[j])%x][i]++;//\u6c42\u51fa\u8f6c\u79fb\u5f0f\n          }\n      }\n      ans=(base^(b))*ans;//\u63a8\uff01\n      printf(\"%lld\",ans.a[k][0]);\n      return 0;\n  }\n```",
        "postTime": 1661420242,
        "uid": 428358,
        "name": "cqbztzl",
        "ccfLevel": 5,
        "title": "CF621E\u9898\u89e3"
    },
    {
        "content": "+ \u6211\u4eec\u5148\u770b\u6570\u636e\u8303\u56f4 $b$ \u6709 $10^9$ ,\u5f88\u5927\u3002\u770b\u4e86\u9898\u76ee\uff0c\u6211\u4eec\u77e5\u9053\u9898\u76ee\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5fc5\u5b9a\u4e0e $b$ \u6709\u5173\uff0c\u81ea\u7136\u800c\u7136\u5f80 $\\log b$ \u65b9\u5411\u60f3\u3002\u503c\u5f97\u5e86\u5e78\u7684\u662f $x$ \u5728 $100$ \u4e4b\u5185\u3002\u82e5\u7528\u5e38\u89c4 dp \uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\Theta(b\\times x^2)$ \uff0c\u663e\u7136\u4e0d\u884c\u3002\u4f46\uff0c\u4f7f\u7528\u77e9\u9635\u4e58\u6cd5\u52a0\u901f\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u53d8\u4e3a$\\Theta(\\log b\\times x^3)$ \uff0c\u53ef\u7528\u3002\n+ \u6839\u636e\u9898\u76ee\u6027\u8d28\uff0c\u6211\u4eec\u53d1\u73b0\u53ea\u6709\u76f8\u90bb\u7684\u683c\u4e4b\u95f4\u5b58\u5728\u5173\u7cfb\uff0c\u5373\u53ea\u6709\u5230\u4e0a\u4e00\u683c\u7684\u4f59\u6570\u4f1a\u5f71\u54cd\u8fd9\u4e00\u683c\u3002\u4f8b\u5982\uff1a\u5230\u4e0a\u4e00\u683c\u7684\u4f59\u6570\u4e3a $i$ \uff0c\u8fd9\u683c\u7684\u6570\u5b57\u4e3a$j$\uff0c\u8fd9\u683c\u7684\u4f59\u6570\u4e3a$(i\\times10+j)\\bmod x$(\u5373\u4f59\u6570\u7531 $i$ \u53d8\u4e3a $(i\\times10+j) \\bmod x$ \u7684\u65b9\u6848\u6570 $+1$ )\u3002\n+ \u51ed\u501f\u8fd9\u4e2a\u5173\u7cfb\uff0c\u6784\u9020\u77e9\u9635\u3002  \n  \n\u5177\u4f53\u7ec6\u8282\uff0c\u8bf7\u770b\u4ee3\u7801\u3002(\u5df2\u7ecf\u53ef\u4ee5$AC$\u4e86)\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\ntypedef pair<int,int> PII;\nconst LL N=105,mod=1e9+7;\nLL a[N][N];//a[i][j]\u4e2d,i\u4e3a\u4f59\u6570,j\u4e3a\u4f59\u6570,a[i][j]\u7684\u503c\u4e3a\u4f59\u6570\u4ecei\u53d8\u4e3aj\u7684\u65b9\u6848\u6570 \nLL ans[N];//ans[i]\u4e2d,i\u4e3a\u4f59\u6570,ans[i]\u7684\u503c\u4e3a\u5f62\u6210\u4f59\u6570i\u7684\u65b9\u6848\u6570 \nLL n,b,k,x,sz;\nvoid mul()\n{\n\tLL c[N];\n\tmemset(c,0,sizeof c);\n\tfor(int i=0;i<x;i++)\n\t{\n\t\t//\u5bf9\u4e8e\u73b0\u5728\u5f62\u6210\u4f59\u6570i\u7684\u65b9\u6848\u6570\u4e3a:\u4f59\u6570\u4ecej\u53d8\u4e3ai\u7684\u65b9\u6848\u6570\u4e58\u4ee5\u4e4b\u524d\u5f62\u6210\u4f59\u6570j\u7684\u65b9\u6848\u6570\u4e4b\u548c \n\t\tfor(int j=0;j<x;j++)\n\t\t{\n\t\t\tc[i]=(c[i]+ans[j]*a[j][i])%mod;\n\t\t}\n\t}\n\t//\u7528\u73b0\u5728\u7684\u66ff\u6362\u4e4b\u524d\u7684 \n\tmemcpy(ans,c,sizeof ans);\n}\nvoid mulself()\n{\n\tLL c[N][N];\n\tmemset(c,0,sizeof c);\n\t//\u5bf9\u4e8e\u73b0\u5728\u4f59\u6570\u4ecei\u53d8\u4e3aj\u7684\u65b9\u6848\u6570\u4e3a:\u4f59\u6570\u4ecei\u53d8\u4e3ak\u7684\u65b9\u6848\u6570\u4e58\u4ee5\u4f59\u6570\u4ecek\u53d8\u4e3aj\u7684\u65b9\u6848\u6570\u4e4b\u548c\n\t//(\u795e\u4f3cfloyd) \n\tfor(int i=0;i<x;i++)\n\t{\n\t\tfor(int j=0;j<x;j++)\n\t\t{\n\t\t\tfor(int k=0;k<x;k++)\n\t\t\t{\n\t\t\t\tc[i][j]=(c[i][j]+a[i][k]*a[k][j])%mod;\n\t\t\t}\n\t\t}\n\t}\n\tmemcpy(a,c,sizeof a);\n}\nint main()\n{\n    scanf(\"%lld%lld%lld%lld\",&n,&b,&k,&x);\n    ans[0]=1;//\u4e00\u5f00\u59cb,\u663e\u7136\u53ea\u6709\u4f59\u6570\u662f0\u7684\u4e00\u79cd\u65b9\u6848 \n    for(int i=0;i<n;i++)\n    {\n    \tscanf(\"%lld\",&sz);//sz \u6570\u5b57(shu zi)\n    \tfor(int j=0;j<x;j++)\n    \t{\n    \t\ta[j][(10*j+sz)%x]++;//\u4f59\u6570j\u4e0e\u6570\u5b57sz\u642d\u914d\u53ef\u5f62\u6210\u4f59\u6570(10*j+sz)%x\n\t\t}\n\t}\n\t//\u77e9\u9635\u4e58\u6cd5\u52a0\u901f\u9012\u63a8(\u7c7b\u4f3c\u5feb\u901f\u5e42)\n\twhile(b)\n\t{\n\t\tif(b&1) mul();\n\t\tmulself();\n\t\tb>>=1;\n\t}\n\t//\u8f93\u51fa \n\tprintf(\"%lld\\n\",ans[k]);\n    return 0;\n}\n```\n\u8fdb\u4e00\u6b65\u601d\u8003\uff0c\u4e0d\u96be\u60f3\u5230\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$\\Theta(\\log b\\times x^2)$\u7684\u65b9\u6cd5(\u7406\u89e3\u8d77\u6765\u6bd4\u8f83\u96be\uff0c\u53ef\u4ee5\u4e0d\u770b\uff0c\u4e0a\u9762\u7684\u65b9\u6cd5\u5df2\u7ecf\u53ef\u4ee5\u8fc7\u4e86)\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\ntypedef pair<int,int> PII;\nLL a[105];//\u4f59\u6570\u4e3ai\uff0c\u6709a[i]\u79cd\u65b9\u6848 \nLL b[105];//\u5728\u6570\u5b57\u6709p\u4f4d\u65f6,\u4f59\u6570\u4e3ai\uff0c\u6709b[i]\u79cd\u65b9\u6848 \nLL c[105];//\u7528\u4e8e\u6682\u65f6\u50a8\u5b58 \nLL mod=1e9+7;//\u7528\u4e8e\u53d6\u6a21 \nLL n,B,k,x,y,z;\nLL p; \nvoid mulself()\n{\n\tfor(int i=0;i<x;i++) c[i]=0;\n\t//\u6570\u5b57\u6709p*2\u4f4d\u65f6,\u4f59\u6570\u4e3a(i*y+j)%x[(i*10^p+j)%x=(i*10^p%x+j)%x=(i*y+j)%x]\u7684\u65b9\u6848\u6570\u7d2f\u52a0\u5f53\u6570\u5b57\u6709p\u4f4d\u65f6,\u4f59\u6570\u4e3ai\u7684\u65b9\u6848\u6570\u4e0e\u4f59\u6570\u4e3aj\u7684\u65b9\u6848\u6570\u4e4b\u79ef \n\tfor(int i=0;i<x;i++)\n\t\tfor(int j=0;j<x;j++)\n\t\t\tc[(i*y+j)%x]=(c[(i*y+j)%x]+b[i]*b[j])%mod;\n\tmemcpy(b,c,sizeof b);\n}\nvoid mul()\n{\n\tfor(int i=0;i<x;i++) c[i]=0;\n\t//\u6839\u636e\u4e0a\u9762mulself()\u7684\u89e3\u91ca,\u5f88\u5bb9\u6613\u60f3 \n\tfor(int i=0;i<x;i++)\n\t\tfor(int j=0;j<x;j++)\n\t\t\tc[(i*y+j)%x]=(c[(i*y+j)%x]+a[i]*b[j])%mod;\n\tmemcpy(a,c,sizeof a);\n}\nint main()\n{\n\tscanf(\"%d%d%d%d\",&n,&B,&k,&x);\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&z),b[z%x]++;\n\tp=1;\n\ty=10;//y=10^p%x\n\ta[0]=1;\n\twhile(B)\n\t{\n\t\tif(B&1) mul();\n\t\tmulself();\n\t\tp>>=1;\n\t\ty=y*y%x;//y=10^p%x\n\t\tB>>=1;\n\t}\n\tprintf(\"%d\",a[k]);\n}\n\n```\n",
        "postTime": 1585399130,
        "uid": 114725,
        "name": "\u5f90\u6668\u71a0",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF621E \u3010Wet Shark and Blocks\u3011"
    },
    {
        "content": "#### Solution\n\u3000\u3000\u8fd8\u662f\u7b2c\u4e00\u6b21\u505a\u77e9\u9635\u4e58\u6cd5\u4f18\u5316\u52a8\u6001\u89c4\u5212\u7684\u9898,\u5982\u6709\u4e0d\u59a5\u4e4b\u5904\u8bf7\u591a\u591a\u6307\u6559.\u5173\u4e8e\u77e9\u9635\u4e58\u6cd5\u66f4\u57fa\u7840\u7684\u5185\u5bb9\u53ef\u4ee5\u770b[\u77e9\u9635\u4e58\u6cd5](https://www.luogu.org/blog/aiyoupass/ju-zhen-sheng-fa).\n  \n\u3000\u3000\u5bb9\u6613\u5199\u51fa\u8f6c\u79fb\u65b9\u7a0b\n\n$$f(i,j)=\\sum_{p=0}^9tot(p)f(i-1,(j-p)/10\\mod k)$$\n\n\u53ef\u4ee5\u53d1\u73b0\u6bcf\u6b21\u4ece$i-1$\u5230$i$\u7684\u8f6c\u79fb\u662f\u4e00\u6837\u7684, \u8fd9\u4e48\u4e00\u6b21\u8f6c\u79fb\u53ef\u4ee5\u8868\u793a\u6210\u4e00\u6b21\u77e9\u9635\u4e58\u6cd5\u7684\u5f62\u5f0f.\n\n\u3000\u3000\u5176\u4e2d$f(i,j)$\u8868\u793a\u524di\u4e2a\u683c\u5b50\u6784\u6210\u6570\u6a21$k$\u4e3a$j$\u7684\u65b9\u6848\u6570, \u5c06$tot(p)$\u653e\u5165\u77e9\u9635\u4e2d\u6784\u9020\u51fa\u4e00\u4e2a\u77e9\u9635$A$,**\u7b2ci\u884c\u7b2cj\u5217\u4e3a\u76f8\u90bb\u4e24\u4e2a\u683c\u5b50\u524d\u4e00\u4e2a\u4f59\u6570\u4e3a$i$\u65f6\u7684\u7b54\u6848\u5bf9\u540e\u4e00\u4e2a\u4f59\u6570\u4e3a$j$\u65f6\u7b54\u6848\u7684\u8d21\u732e**(\u76f8\u5f53\u4e8e\u662f$f(a,i)+=A_{i,j}\\times f(a-1,j)$),$f(a,i)+=A_{i,j}^2\\times f(a-2,j)$\u53ef\u4ee5\u8868\u793a\u7b2c\u96f6\u4e2a\u683c\u5b50(\u6ca1\u6709\u683c\u5b50)\u7684\u7b54\u6848\u5bf9\u524d\u4e24\u4e2a\u683c\u5b50\u7b54\u6848\u7684\u8d21\u732e, \u6700\u7ec8\u4e3a$f(b,i)+=A_{i,j}^b\\times f(a-2,j)$.\n\u8fd9\u6837\u5c31\u4f7f\u5f97\u8f6c\u79fb\u53d8\u6210\u4e86$f(i)=Af(i-1)$.\u8fd9\u6837\u5c31\u53ef\u4ee5\u6700\u7ec8\u5229\u7528**\u77e9\u9635\u5feb\u901f\u5e42**\u6c42\u51fa\u6700\u7ec8\u7684\u77e9\u9635, $A^b$\u77e9\u9635\u7684\u7b2c\u4e00\u884c\u7684\u7b2c$k$\u4e2a\u6570\u5c31\u662f\u7b54\u6848.\n\n\u3000\u3000\u5982\u679c\u611f\u89c9\u6bd4\u8f83\u62bd\u8c61\u7684\u8bdd\u5c31\u5c06\u6240\u6709\u8f6c\u79fb\u5168\u90e8\u5199\u51fa\u6765, \u4f1a\u53d1\u73b0\u5b83\u521a\u597d\u53ef\u4ee5\u5199\u6210\u4e00\u4e2a\u77e9\u9635\u4e58\u6cd5\u7684\u5f62\u5f0f,\u4e5f\u53ef\u4ee5\u591a\u770b\u770b**\u7ebf\u4ee3**\u7684\u4e66.\n\n#### Code\n```c++\n#include<cstdio>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\n#define N 105\n#define mod 1000000007\n#define int long long\nusing namespace std;\n\nclass matrix {//\u77e9\u9635\u7684\u7c7b\n    public:\n    int n,m,mat[N][N];\n    matrix(){}\n    matrix(int _n){n=m=_n;for(int i=0;i<_n;++i)mat[i][i]=1;}\n    matrix(int _n,int _m){n=_n,m=_m;}\n    matrix operator+(const matrix &b)const{\n        matrix c=matrix(n,m);\n        for(int i=0;i<n;++i)\n            for(int j=0;j<m;++j)\n                c.mat[i][j]=(mat[i][j]+b.mat[i][j])%mod;\n        return c;\t\n    }\n    matrix operator-(const matrix &b)const{\n        matrix c=matrix(n,m);\n        for(int i=0;i<n;++i)\n            for(int j=0;j<m;++j)\n                c.mat[i][j]=(mat[i][j]-b.mat[i][j])%mod;\n        return c;\n    }\n    matrix operator*(const matrix &b)const{\n        matrix c=matrix(n,b.m);\n        for(int i=0;i<n;++i)\n            for(int j=0;j<b.m;++j){\n                long long tmp=0LL;\n                for(int k=0;k<m;++k){\n                    tmp+=mat[i][k]*b.mat[k][j];\n                    if(tmp>1e9)tmp%=mod;\n                }\n                c.mat[i][j]=tmp;\n            }\n        return c;\n    }\n    matrix operator*(const int &s)const{\n        matrix c=*this;\n        for(int i=0;i<n;++i)\n            for(int j=0;j<m;++j){\n                c.mat[i][j]*=s;\n                c.mat[i][j]%=mod;\n            }\n    }\n    matrix operator^(const int &s)const{\n        int p=s;\n        matrix ans=matrix(n);\n        matrix bas=*this;\n        while(p){\n            if(p&1)ans=ans*bas;\n            bas=bas*bas;p>>=1;\n        }\n        return ans;\n    }\n    void input(int _n,int _m){\n        n=_n,m=_m;\n        for(int i=0;i<n;++i)\n            for(int j=0;j<m;++j)\n                scanf(\"%lld\",&mat[i][j]);\n    }\n    void print(){\n        putchar('\\n');\n        for(int i=0;i<n;++i){\n            for(int j=0;j<m;++j)\n                printf(\"%lld \",mat[i][j]);\n            putchar('\\n');\n        }\n        putchar('\\n');\n    }\n}A;//\u5373\u4e0a\u6587\u4e2d\u7684A\n\nint n,b,k,x;\nint cnt[10];//\u6bcf\u4e2a\u683c\u5b50\u4e2d\u6570i\u7684\u4e2a\u6570\n\nmain(){\n \tscanf(\"%lld%lld%lld%lld\",&n,&b,&k,&x);\n    memset(cnt,0,sizeof(cnt));int v;\n    for(int i=1;i<=n;i++){\n        scanf(\"%d\",&v);cnt[v]++;\n    }\n    A=matrix(x,x);//\u521d\u59cb\u5316\u77e9\u9635\n    for(int i=0; i<x; i++){\n        for(int j=0; j<10; j++){\n            A.mat[i][(i*10+j)%x]+=cnt[j];\n        }\n    }//\u6784\u9020\u77e9\u9635A\n    matrix ans=A^b;//b\u4e2a\u683c\u5b50\u7684\u7b54\u6848\n    printf(\"%lld\\n\",ans.mat[0][k]%mod);\n    return 0;\n}\n```",
        "postTime": 1525178090,
        "uid": 39067,
        "name": "aiyougege",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF621E \u3010Wet Shark and Blocks\u3011"
    },
    {
        "content": "\u8bbe $dp_{i,j}$ \u8868\u793a\u4ece\u9ad8\u5230\u4f4e\u586b\u4e86\u524d $i$ \u4f4d\uff0c\u5f53\u524d\u6570\u6a21 $x$ \u7b49\u4e8e $j$\uff0c\u679a\u4e3e\u5f53\u524d\u4f4d\u9009\u54ea\u4e2a\u6570\uff0c\u8bbe $w=(10\\times j+a_h)\\bmod x$\uff0c\u5047\u8bbe\u9009 $a_h$\uff0c$dp_{i,w}=dp_{i,w}+dp_{i-1,j}$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(nbx)$\uff0c\u5927\u5f97\u6050\u6016\u3002\n\n\u53d1\u73b0\u6bcf\u4e00\u6b21\u4ece $i-1$ \u8f6c\u79fb\u5230 $i$ \u4e00\u6a21\u4e00\u6837\uff0c\u5373 $j$ \u5411 $(10\\times j+a_h)\\bmod x$ \u8f6c\u79fb\uff0c\u8003\u8651\u77e9\u9635\u4f18\u5316\u3002\n\n\u8bbe $x\\times x$ \u7684\u77e9\u9635 $st$\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $(j,h)$\uff0c\u6211\u4eec\u628a $st_{w,j}$ \u52a0 $1$\u3002\n\n\u518d\u8bbe $1\\times n$ \u7684\u77e9\u9635 $s$\uff0c\u5176\u4e2d $s$ \u7684\u7b2c $j$ \u5217\u8868\u793a $dp_{i-1,j}$\uff0c\u6211\u4eec\u53d1\u73b0\u7528 $st$ \u77e9\u9635\u4e58\u4e0a\u8fd9\u4e2a\u77e9\u9635\u5f97\u5230\u7684\u65b0\u77e9\u9635 $s\\prime$ \u7684\u7b2c $j$ \u5217\u5c31\u8868\u793a $dp_{i,j}$\uff0c\u6240\u4ee5\u5c31\u53ef\u4ee5\u8fdb\u884c\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(nx+x^2\\log_2b)$\u3002\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<stack>\n#include<vector>\n#include<queue>\n#include<cstring>\n\n#define rep(x,y,z) for(int x=y;x<=z;x++)\n#define per(x,y,z) for(int x=z;x>=y;x--)\n#define LL long long\n\nusing namespace std;\nconst int N=5e4+10,K=110,mod=1e9+7;\n\nint a[N],n,b,k,m;\nint cnt[N];\n\nstruct matrix\n{\n\tint jz[K][K];\n\tmatrix() {memset(jz,0,sizeof(jz));}\n\tmatrix operator * (const matrix &b) const\n\t{\n\t\tmatrix c;\n\t\trep(i,0,m-1)\n\t\t\trep(j,0,m-1)\n\t\t\t\trep(h,0,m-1)\n\t\t\t\t\tc.jz[i][j]=(c.jz[i][j]+1ll*jz[i][h]*b.jz[h][j]%mod)%mod;\n\t\treturn c;\n\t}\n};\n\nmatrix ksm(matrix x,int y)\n{\n\tmatrix s;\n\trep(i,0,m-1) s.jz[i][i]=1;\n\twhile(y)\n\t{\n\t\tif(y&1) s=s*x;\n\t\tx=x*x;\n\t\ty>>=1;\n\t}\n\treturn s;\n}\n\nint main()\n{\n\tscanf(\"%d%d%d%d\",&n,&b,&k,&m);\n\trep(i,1,n) scanf(\"%d\",&a[i]);\n\tmatrix st;\n\trep(i,0,m-1)\n\t\trep(j,1,n)\n\t\t\tst.jz[(10*i+a[j])%m][i]++;\n\tst=ksm(st,b-1);\n\tint ans=0;\n\trep(i,1,n) cnt[a[i]%m]++;\n\trep(i,0,m-1) ans=(ans+1ll*st.jz[k][i]*cnt[i]%mod)%mod;\n\tprintf(\"%d\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1661262900,
        "uid": 571634,
        "name": "hgzxwzf",
        "ccfLevel": 7,
        "title": "CF621E"
    },
    {
        "content": "\u4ece\u7ed9\u5b9a $n\\leq 50000$ \u4e2a\u4e00\u4f4d\u6570\u4e2d\u53ef\u91cd\u590d\u9009\u62e9 $b\\leq 10^9$ \u4e2a\u7ec4\u6210 $b$ \u4f4d\u6570\uff0c\u6c42\u6709\u591a\u5c11\u4e2a\u5bf9 $x$ \u53d6\u6a21\u4e3a $k$\n\n\u5b9a\u4e49 $dp_{i,j}$ \u4e3a $i$ \u4f4d\u6570\u4e2d\u5bf9 $x$ \u53d6\u6a21\u4e3a $j$ \u7684\u4e2a\u6570\u3002\u7136\u540e\u500d\u589e\u8f6c\u79fb\u3002\n\n\u9996\u5148 $i=1$ \u7684\u65f6\u5019\u76f4\u63a5\u7edf\u8ba1\u539f\u59cb\u6570\u636e\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u7136\u540e\u5bf9\u4e8e $dp_{i}$ \u8f6c\u79fb\u5230 $dp_{2i}$ \uff0c\u53ef\u4ee5\u53d1\u73b0\n$$\ndp_{2i,j}=\\sum_{10^ij_1+j_2=j} dp_{i,j_1}\\times dp_{i,j_2}\n$$\n\u770b\u89c1 $j$ \u7684\u8303\u56f4\uff0c\u6beb\u4e0d\u72b9\u8c6b\u76f4\u63a5\u66b4\u529b\u5377\u79ef\uff08\u4e09\u6a21NTT\u53ef\u6162\u4e86\u3002\u3002\u3002\n\n\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f $\\mathcal O(x^2\\log_2b)$\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#ifndef ONLINE_JUDGE\n#define FILEIO\n#endif // ONLINE_JUDGE\n#ifdef FILEIO\nFILE *infile=fopen(\"CF621E.in\",\"r\"), *outfile=fopen(\"CF621E.out\",\"w\");\n#define scanf(x...) fscanf(infile,x)\n#define printf(x...) fprintf(outfile,x)\n#endif // FILEIO\n\nconst int mod=1e9+7;\nint n,b,k,x,opt,N;\nint dp[2][101],d[101];\ninline int fastpow(int x,int k,const int mod) {\n\tint res=1;\n\twhile(k) {\n\t\tif(k&1) res=res*x%mod;\n\t\tx=x*x%mod; k>>=1;\n\t}\n\treturn res;\n}\ninline int plus(int x,int y,const int m=mod) { x+=y-m; return x+((x>>31)&m); }\n\nint main() {\n\tscanf(\"%d%d%d%d\",&n,&b,&k,&x);\n\tfor(int i=1;i<=n;++i) {\n\t\tscanf(\"%d\",&opt);\n\t\t++dp[0][opt%x];\n\t}\n\tfor(int i=0;i<x;++i) d[i]=dp[0][i];\n\tN=b; n=1; int i=1; opt=0;\n\twhile(n<<1<=N) n<<=1;\n\twhile(n>>=1) {\n\t\tmemset(dp[opt^=1],0,sizeof(dp[0]));\n\t\tconst int _10=fastpow(10,i,x);\n\t\tfor(int j1=0;j1<x;++j1) {\n\t\t\tconst int _1=_10*j1%x;\n\t\t\tfor(int j2=0;j2<x;++j2) {\n\t\t\t\tdp[opt][plus(_1,j2,x)]=plus(1ll*dp[opt^1][j1]*dp[opt^1][j2]%mod,dp[opt][plus(_1,j2,x)]);\n\t\t\t}\n\t\t}\n\t\ti<<=1;\n\t\tif(n&N) {\n\t\t\tmemset(dp[opt^=1],0,sizeof(dp[0]));\n\t\t\tfor(int j1=0;j1<x;++j1) {\n\t\t\t\tconst int _1=10*j1%x;\n\t\t\t\tfor(int j2=0;j2<x;++j2) {\n\t\t\t\t\tdp[opt][plus(_1,j2,x)]=plus(1ll*dp[opt^1][j1]*d[j2]%mod,dp[opt][plus(_1,j2,x)]);\n\t\t\t\t}\n\t\t\t}\n\t\t\ti|=1;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",dp[opt][k]);\n#ifdef FILEIO\n\tfclose(infile); fclose(outfile);\n#undef scanf\n#undef printf\n#endif // FILEIO\n\treturn 0;\n}\n\n```",
        "postTime": 1658807042,
        "uid": 192989,
        "name": "\u4ea6\u95fb\u695a\u6b4c\u8d77",
        "ccfLevel": 0,
        "title": "\u3010\u500d\u589e\u3011 CF621E Wet Shark and Blocks \u9898\u89e3"
    },
    {
        "content": "## $\\mathcal{Problem}$\n\u7ed9\u4f60 $n$ \u4e2a\u6570\u5b57\uff0c\u7ec4\u6210\u4e00\u4e2a $b$ \u4f4d\u6570\uff0c\u6570\u5b57\u53ef\u4ee5\u91cd\u590d\u4f7f\u7528\uff0c\u8bbe\u6700\u540e\u6570\u5b57\u4e3a $m$\uff0c\u6c42 $m\\mod x=k$ \u7684\u6b21\u6570\uff0c\u5bf9 $10^9+7$ \u53d6\u6a21\u3002\n$$2\u2264n\u226450000,1\u2264b\u226410^9,0\u2264k<x\u2264100,x\u22652$$\n## $\\mathcal{Solution}$\n\u7136\u540e\u5c31\u80fd\u6ca1\u6709\u538b\u529b\u5730\u5199\u51fa\u66b4\u529b dp \u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$f_{k,10\\times i+j\\mod x}=f_{10\\times i+j\\mod x}+f_i\\times cnt_j\\pmod{10^9+7}$$\n$f_{k,i}$ \u8868\u793a\u586b\u5230\u7b2c $k$ \u4f4d\uff0c\u5bf9 $x$ \u53d6\u6a21\u4f59\u6570\u662f $i$ \u7684\u65b9\u6848\u6570\u3002\n\n$cnt_i$ \u8868\u793a\u6570\u5b57 $i$ \u5728\u6570\u7ec4\u4e2d\u51fa\u73b0\u7684\u6b21\u6570\u3002\n\n\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal O(bx)$\u3002\n\n\u4e00\u770b $b$ \u7684\u8303\u56f4 $\\mathbf{10^9!}$\n\n\u5f88\u81ea\u7136\u5c31\u80fd\u60f3\u5230\u4e00\u4e2a\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal O(\\log b)$ \u7684\u4f18\u79c0 dp \u8f6c\u79fb\u65b9\u6cd5\uff1a**\u77e9\u9635\u5feb\u901f\u5e42**\u3002\n\n\u8fd9\u91cc $f_{...,10\\times i+j}$ \u53ef\u4ee5\u7531\u4e5d\u79cd\u4e0d\u540c\u7684\u72b6\u6001\u8f6c\u79fb\u8fc7\u6765\uff0c\u6240\u4ee5\u9884\u5904\u7406\u51fa\u8fd9\u5341\u79cd\u72b6\u6001\u7684\u77e9\u9635 **a**\uff1a\n```\nfor(int i=0;i<X;i++)\n\tfor(int j=1;j<=9;j++)\n\ta[(i*10+j)%X][i]+=t[j];\n```\n\u7136\u540e\u7b54\u6848\u77e9\u9635\u5c31\u521d\u59cb\u5316\u6210\uff1a\n$$\n\\begin{bmatrix}\n1&0&0&\\dotsb\\\\\n0&1&0&\\dotsb\\\\\n0&0&1&\\dotsb\\\\\n\\vdots&\\vdots&\\vdots&\\ddots\n\\end{bmatrix}\n$$\n\u6700\u540e\u8f93\u51fa $ans_{0,k}$ \u5c31\u8fc7\u4e86\u8fd9\u9053\u9898\u3002\n\n[$\\mathfrak{C^od_e}$](https://www.luogu.com.cn/paste/manh0wk9)",
        "postTime": 1651219503,
        "uid": 262322,
        "name": "panyanppyy",
        "ccfLevel": 5,
        "title": "CF621E"
    }
]
[
    {
        "content": "- upd 2022.6.19 \u4fee\u6b63\u4e86\u516c\u5f0f\u9519\u8bef\u548c latex \u8bed\u6cd5\u9519\u8bef\n\n\u5b98\u65b9\u9898\u89e3\u91cc\u63d0\u5230\u9a8c\u9898\u4eba\u7684\u4e00\u79cd\u671f\u671b\u66f4\u4f18\u7684\u4f5c\u6cd5\uff0c\u611f\u89c9\u5f88\u6709\u610f\u601d\u3002\n\n\u8003\u8651\u4ece $u$ \u548c $v$ \u5206\u522b\u627e\u51fa\u4e00\u6761\u5230 0 \u7684\u957f\u5ea6\u5728 100 \u4ee5\u5185\u7684\u8def\u5f84\u3002\u90a3\u4e48\u4ee5 $u$ \u4e3a\u4f8b\uff0c\u6211\u4eec\u5728\u533a\u95f4 $[1, p-1]$ \u5185\u968f\u673a\u53d6\u4e00\u4e2a\u6574\u6570 $x$ \uff0c\u8bb0 $a=ux\\bmod p,b=x$\u3002\u5bf9 $(a,b)$ \u4f7f\u7528\u66f4\u76f8\u51cf\u635f\u672f\u5c06 $b$ \u8fed\u4ee3\u5230 0 \u4e3a\u6b62\uff0c\u5177\u4f53\u8fc7\u7a0b\u5982\u4e0b\uff1a\n\n- \u82e5 $a<b$ \uff0c\u4ea4\u6362 $a$ \u548c $b$\u3002\n- \u5426\u5219\uff0c\u5c06 $a$ \u51cf\u53bb $b$\u3002\n\n\u89c2\u5bdf\u5230\u521d\u59cb\u65f6 $u\\equiv\\frac{a}{b}\\pmod p$\uff0c\u90a3\u4e48\u64cd\u4f5c $u\\to u-1\\pmod p$ \u5c31\u76f8\u5f53\u4e8e $\\frac{a}{b}\\to \\frac{a-b}{b}\\pmod p$\uff0c$u\\to u^{p-2}\\pmod p$ \u5c31\u76f8\u5f53\u4e8e $\\frac{a}{b}\\to \\frac{b}{a}\\pmod p$\u3002\u5230 $b=0$ \u65f6 $u$ \u4e5f\u5c31\u4e3a 0 \u4e86\u3002\n\n\u4f46\u66f4\u76f8\u51cf\u635f\u672f\u4e0d\u80fd\u4fdd\u8bc1\u590d\u6742\u5ea6\u3002\u4e8e\u662f\u6211\u4eec\u4e0d\u65ad\u968f\u673a $x$ \u5e76\u7528\u8f97\u8f6c\u76f8\u9664\u6cd5\u8ba1\u7b97\u8def\u5f84\u957f\u5ea6\uff0c\u76f4\u5230\u5b83\u5c0f\u4e8e\u7b49\u4e8e 100 \u4e3a\u6b62\u3002\u5b9e\u9645\u4e0a\u8fd9\u6837\u8dd1\u7684\u6b21\u6570\u4f1a\u5f88\u5c11\uff0c\u51e0\u4e4e\u662f\u671f\u671b $O(1)$ \u7684\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5728\u671f\u671b $O(\\log p)$ \u5de6\u53f3\u7684\u65f6\u95f4\u627e\u5230\u4e00\u6761\u4ece\u4efb\u4e00\u70b9\u5230 0 \u7684\u957f\u5ea6\u5728 100 \u4ee5\u5185\u7684\u8def\u5f84\u3002\n\n\u56e0\u4e3a 2 \u64cd\u4f5c\u4e0e 3 \u64cd\u4f5c\u4e92\u9006\uff0c\u90a3\u4e48\u663e\u7136 $v$ \u5230 0 \u7684\u8def\u5f84\u662f\u53ef\u9006\u7684\u3002\u6700\u7ec8\u7b54\u6848\u5c31\u662f\u628a\u4e24\u6761\u8def\u5f84\u62fc\u8d77\u6765\u3002\n\n\u4e0b\u9762\u662f\u4ee3\u7801\uff1a\n```cpp\n#include <cstdio>\n#include <algorithm>\n#include <chrono>\nusing namespace std;\nmt19937 rng(chrono::steady_clock::now().time_since_epoch().count());\nconst int MAXL=220;\nint get_len(int a, int b)\n{\n\tif (b==0) return 0;\n\treturn get_len(b, a%b)+a/b+1;\n}\nint get_path(int u, int p, bool* c)\n{\n\tint a, b, l=0;\n\tdo\n\t{\n\t\tb=rng()%(p-1)+1;\n\t\ta=1ll*u*b%p;\n\t} while (get_len(a, b)>100);\n\twhile (b!=0)\n\t\tif (a<b) c[++l]=0, swap(a, b);\n\t\telse a-=b, c[++l]=1;\n\treturn l;\n}\nbool c1[MAXL], c2[MAXL];\nint main()\n{\n//\tfreopen(\"E.in\", \"r\", stdin);\n//\tfreopen(\"E.out\", \"w\", stdout);\n\tint u, v, p;\n\tscanf(\"%d%d%d\", &u, &v, &p);\n\tint l1=get_path(u, p, c1);\n\tint l2=get_path(v, p, c2);\n\tprintf(\"%d\\n\", l1+l2);\n\tfor (int i=1; i<=l1; i++) printf(\"%d \", c1[i]?2:3);\n\tfor (int i=l2; i>=1; i--) printf(\"%d \", c2[i]?1:3);\n\tputchar('\\n');\n\treturn 0;\n}\n```",
        "postTime": 1580344892,
        "uid": 43064,
        "name": "\u6500\u5ca9\u9ad8\u624b",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF995E \u3010Number Clicker\u3011"
    },
    {
        "content": "\u9898\u76ee\u5927\u610f\uff1a\n\n\u7ed9\u4f60\u4e09\u4e2a\u6570 $ u $,$ v $,$ p $,\u5c06 $ u $ \u8fdb\u884c\u82e5\u5e72\u6b21\u53d8\u5316\u5f97\u5230 $ v $,\u8981\u6c42\u6b21\u6570\u5728 $ 200 $ \u4ee5\u5185\uff0c\u7136\u540e\u8f93\u51fa\u4e00\u7ec4\u5408\u6cd5\u7684\u89e3\uff0c\u5176\u4e2d $ p $ \u4fdd\u8bc1\u4e3a\u8d28\u6570\u3002\n\n\u53d8\u5316\u5171\u6709\u4e09\u79cd\uff0c\u5206\u522b\u662f:\n1.  $ u \\to u+1\\pmod{p} $\uff1b\n\n2.  $ u \\to u+p-1\\pmod{p} $\uff1b\n\n3.  $ u \\to u^{p-2}\\pmod{p} $\uff1b\n\n\u6211\u505a\u8fd9\u9053\u9898\u7684\u65f6\u5019\u7b2c\u4e00\u4e2a\u53cd\u5e94\u662f\u5e7f\u641c\uff0c\u7528\u5e7f\u641c\u505a\u663e\u7136\u662f\u53ef\u4ee5\u505a\u51fa\u8fd9\u9053\u9898\u7684\uff0c\u5f53\u7136\uff0c\u666e\u901a\u7684\u5e7f\u641c\u4e5f\u80af\u5b9a\u662f\u4f1a\u8d85\u65f6\u7684\u3002\n\n\u90a3\u4e48\u6211\u4eec\u73b0\u5728\u53ef\u4ee5\u8003\u8651\u53cc\u5411\u5e7f\u641c\uff0c\u8fd9\u79cd\u505a\u6cd5\u8981\u6c42\u5176\u4e2d\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u662f\u53ef\u9006\u7684\uff0c\u5176\u4e2d\u524d\u4e24\u79cd\u64cd\u4f5c\u663e\u7136\u662f\u53ef\u9006\u7684\uff0c\u4f46\u662f\u7b2c\u4e09\u79cd\u64cd\u4f5c\u662f\u5426\u662f\u53ef\u9006\u7684\u5462\uff1f\n\n\u7b54\u6848\u662f\u80af\u5b9a\u7684\uff0c\u56e0\u4e3a\u9898\u76ee\u4e2d\u4fdd\u8bc1\u4e86 $ p $ \u662f\u4e00\u4e2a\u8d28\u6570\uff0c\u90a3\u4e48 $ u^{p-2}\\pmod{p} $ \u4e0e $ u $ \u4e92\u4e3a\u9006\u5143\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$ \\left(u^{p-2}\\right)^{p-2}\\pmod{p} = u  $ \n\n\u6240\u4ee5\u7b2c\u4e09\u79cd\u53d8\u6362\u4e5f\u662f\u53ef\u9006\u7684\uff0c\u90a3\u4e48\u8fd9\u9053\u9898\u5c31\u53ef\u4ee5\u4f7f\u7528\u53cc\u5411bfs\u6765\u6c42\u89e3\u4e86\u3002\n\n\u672c\u4eba\u4f7f\u7528\u7684\u662fC++11\u7684unordered_map\uff0c\u4e0d\u4f7f\u7528C++11\u4f1a\u9020\u6210CE\u3002\n\n\u56e0\u4e3a\u4ed6\u4f7f\u7528\u7684\u662f\u54c8\u5e0c\uff0c\u6240\u4ee5\u7406\u8bba\u4e0a\u4f1a\u5feb\u4e00\u4e9b\uff0c\u5f53\u7136\uff0c\u4f7f\u7528map\u4e5f\u4e0d\u4f1a\u8d85\u65f6\u3002\n\n\u5e7f\u641c\u51fd\u6570\uff1a\n```\nlong long a,b,p;\nunordered_map<long long,int>ans1;\nunordered_map<long long,int>ans2;\nunordered_map<long long,long long>pre1;\nunordered_map<long long,long long>pre2;\nunordered_map<long long,int>num1;\nunordered_map<long long,int>num2;\nunordered_map<long long,bool>vis1;\nunordered_map<long long,bool>vis2;\nvoid bfs() {\n\tqueue<long long>que1;\n\tqueue<long long>que2;\n\tif(a==b) {//\u5982\u679ca\u4e0eb\u76f8\u7b49\uff0c\u76f4\u63a5\u8f93\u51fa0\uff0c\u9000\u51fa\u51fd\u6570\n\t\tprintf(\"0\");\n\t\treturn ;\n\t}\n\tque1.push(a);//\u7b2c\u4e00\u4e2a\u961f\u5217\u4ecea\u5f00\u59cb\u641c\u7d22\n\tpre1[a]=-1;\n\tvis1[a]=1;\n\tque2.push(b);//\u7b2c\u4e8c\u4e2a\u961f\u5217\u4eceb\u5f00\u59cb\u641c\u7d22\n\tpre2[b]=-1;//\u5c06\u524d\u7f00\u6807\u8bb0\u4e3a-1\n\tvis2[b]=1;//\u8bb0\u5f97\u6253\u4e0aa\u4e0eb\u7684\u6807\u8bb0\n\twhile(true) {\n\t\tlong long ti=que1.front();//\u53d6\u51fa\u961f\u5217\u4e00\u7684\u7684\u961f\u9996\n\t\tque1.pop();\n\t\tlong long tt=ti+1;//\u53d8\u63621\n\t\tif(tt>=0&&vis1[tt]==0) {\n\t\t\ttt%=p;\n\t\t\tvis1[tt]=1;\n\t\t\tans1[tt]=ans1[ti]+1;\n\t\t\tpre1[tt]=ti;\n\t\t\tnum1[tt]=1;\n\t\t\tque1.push(tt);\n\t\t\tif(vis2[tt]==1) {\n\t\t\t\tprint(tt);\n\t\t\t\treturn ;\n\t\t\t}\n\t\t}\n\t\ttt=ti-1;//\u53d8\u63622\n\t\tif(tt>=0&&vis1[tt]==0) {\n\t\t\ttt%=p;\n\t\t\tvis1[tt]=1;\n\t\t\tans1[tt]=ans1[ti]+1;\n\t\t\tpre1[tt]=ti;\n\t\t\tnum1[tt]=2;\n\t\t\tque1.push(tt);\n\t\t\tif(vis2[tt]==1) {\n\t\t\t\tprint(tt);\n\t\t\t\treturn ;\n\t\t\t}\n\t\t}\n\t\ttt=ny(ti);//\u53d8\u63623\n\t\tif(tt>=0&&vis1[tt]==0) {\n\t\t\ttt%=p;\n\t\t\tvis1[tt]=1;\n\t\t\tans1[tt]=ans1[ti]+1;\n\t\t\tpre1[tt]=ti;\n\t\t\tnum1[tt]=3;\n\t\t\tque1.push(tt);\n\t\t\tif(vis2[tt]==1) {\n\t\t\t\tprint(tt);\n\t\t\t\treturn ;\n\t\t\t}\n\t\t}\n\t\tti=que2.front();//\u53d6\u51fa\u961f\u5217\u4e8c\u7684\u961f\u9996\n\t\tque2.pop();\n\t\ttt=ti-1;//\u56e0\u4e3a\u662f\u53cc\u5411bfs\uff0c\u6240\u4ee5\u7b2c\u4e8c\u4e2a\u961f\u5217\u91cc\u53d8\u53161\u548c\u53d8\u53162\u662f\u98a0\u5012\u7684\n\t\tif(tt>=0&&vis2[tt]==0) {//\u53d8\u53161\n\t\t\ttt%=p;\n\t\t\tvis2[tt]=1;\n\t\t\tans2[tt]=ans2[ti]+1;\n\t\t\tpre2[tt]=ti;\n\t\t\tnum2[tt]=1;\n\t\t\tque2.push(tt);\n\t\t\tif(vis1[tt]==1) {\n\t\t\t\tprint(tt);\n\t\t\t\treturn ;\n\t\t\t}\n\t\t}\n\t\ttt=ti+1;//\u53d8\u53162\n\t\tif(tt>=0&&vis2[tt]==0) {\n\t\t\ttt%=p;\n\t\t\tvis2[tt]=1;\n\t\t\tans2[tt]=ans2[ti]+1;\n\t\t\tpre2[tt]=ti;\n\t\t\tnum2[tt]=2;\n\t\t\tque2.push(tt);\n\t\t\tif(vis1[tt]==1) {\n\t\t\t\tprint(tt);\n\t\t\t\treturn ;\n\t\t\t}\n\t\t}\n\t\ttt=ny(ti)//\u53d8\u53163\n\t\tif(tt>=0&&vis2[tt]==0) {\n\t\t\ttt%=p;\n\t\t\tvis2[tt]=1;\n\t\t\tans2[tt]=ans2[ti]+1;\n\t\t\tpre2[tt]=ti;\n\t\t\tnum2[tt]=3;\n\t\t\tque2.push(tt);\n\t\t\tif(vis1[tt]==1) {\n\t\t\t\tprint(tt);\n\t\t\t\treturn ;\n\t\t\t}\n\t\t}\n\t}\n}\n```\n\u5feb\u901f\u5e42\u6c42\u9006\u5143\uff1a\n```\nlong long ny(long long n) {//\u6c42n\u7684\u9006\u5143\n\tlong long pi=p-2;//\u6b21\u6570\u4e3ap-2\n\tlong long ans=1;\n\twhile(pi) {\n\t\tif(pi&1)\n\t\t\tans*=n,ans%=p;\n\t\tn=n*n,n%=p;\n\t\tpi>>=1;\n\t}\n\treturn ans;\n}\n```\n**\u5feb\u901f\u5e42\u4e00\u5b9a\u8981\u8bb0\u5f97\u53d6\u6a21\u3002**\n\n\u6211\u4e0d\u53ef\u80fd\u544a\u8bc9\u4f60\u4eecWA\u4e86\u4e24\u5929\u6ca1\u627e\u5230\u9519\u54ea\u91cc\u5c31\u662f\u56e0\u4e3a\u5feb\u901f\u5e42\u6ca1\u6709\u53d6\u6a21\u3002\n\n\u7136\u540e\u5c31\u662f\u7ed5\u8111\u5b50\u7684\u8f93\u51fa\u51fd\u6570\uff1a\n```\nvoid print1(long long t) {\n\tif(pre1[t]==-1)//\u5982\u679c\u6ca1\u6709\u524d\u7f00\uff08t=a\uff09\u8fd4\u56de\n\t\treturn ;\n\tprint1(pre1[t]);\n\tprintf(\"%d \",num1[t]);\n}\nvoid print2(long long t) {\n\tif(pre2[t]==-1)\n\t\treturn ;\n\tprintf(\"%d \",num2[t]);//\u6ce8\u610f\u8fd9\u91cc\u548c\u4e0a\u9762\u7684print1\u91cc\u8bed\u53e5\u987a\u5e8f\u4e0d\u4e00\u6837\n\tprint2(pre2[t]);\n}\nvoid print(long long t) {//\u8c03\u7528\u5165\u53e3\u5728bfs\u91cc\n\tprintf(\"%d\\n\",ans1[t]+ans2[t]);//\u5148\u8f93\u51fa\u53d8\u5316\u64cd\u4f5c\u6570\n\tprint1(t);//\u8f93\u51fa\u961f\u52171\u4e2dt\u5982\u4f55\u53d8\u5316\n\tprint2(t);//\u8f93\u51fa\u961f\u52172\u4e2dt\u5982\u4f55\u53d8\u5316\n}\n```\n\u90a3\u4e48\u6211\u4eec\u5c31\u628a\u8fd9\u9053\u9898\u89e3\u51b3\u4e86\u3002\n\nAC\u4ee3\u7801\uff1a\n```\n#include<bits/stdc++.h>\nusing namespace std;\nlong long a,b,p;\nunordered_map<long long,int>ans1;\nunordered_map<long long,int>ans2;\nunordered_map<long long,long long>pre1;\nunordered_map<long long,long long>pre2;\nunordered_map<long long,int>num1;\nunordered_map<long long,int>num2;\nunordered_map<long long,bool>vis1;\nunordered_map<long long,bool>vis2;\nlong long ny(long long n) {//\u6c42n\u7684\u9006\u5143\n\tlong long pi=p-2;//\u6b21\u6570\u4e3ap-2\n\tlong long ans=1;\n\twhile(pi) {\n\t\tif(pi&1)\n\t\t\tans*=n,ans%=p;\n\t\tn=n*n,n%=p;\n\t\tpi>>=1;\n\t}\n\treturn ans;\n}\nvoid print1(long long t) {\n\tif(pre1[t]==-1)//\u5982\u679c\u6ca1\u6709\u524d\u7f00\uff08t=a\uff09\u8fd4\u56de\n\t\treturn ;\n\tprint1(pre1[t]);\n\tprintf(\"%d \",num1[t]);\n}\nvoid print2(long long t) {\n\tif(pre2[t]==-1)\n\t\treturn ;\n\tprintf(\"%d \",num2[t]);//\u6ce8\u610f\u8fd9\u91cc\u548c\u4e0a\u9762\u7684print1\u91cc\u8bed\u53e5\u987a\u5e8f\u4e0d\u4e00\u6837\n\tprint2(pre2[t]);\n}\nvoid print(long long t) {//\u8c03\u7528\u5165\u53e3\u5728bfs\u91cc\n\tprintf(\"%d\\n\",ans1[t]+ans2[t]);//\u5148\u8f93\u51fa\u53d8\u5316\u64cd\u4f5c\u6570\n\tprint1(t);//\u8f93\u51fa\u961f\u52171\u4e2dt\u5982\u4f55\u53d8\u5316\n\tprint2(t);//\u8f93\u51fa\u961f\u52172\u4e2dt\u5982\u4f55\u53d8\u5316\n}\nvoid bfs() {\n\tqueue<long long>que1;\n\tqueue<long long>que2;\n\tif(a==b) {//\u5982\u679ca\u4e0eb\u76f8\u7b49\uff0c\u76f4\u63a5\u8f93\u51fa0\uff0c\u9000\u51fa\u51fd\u6570\n\t\tprintf(\"0\");\n\t\treturn ;\n\t}\n\tque1.push(a);//\u7b2c\u4e00\u4e2a\u961f\u5217\u4ecea\u5f00\u59cb\u641c\u7d22\n\tpre1[a]=-1;\n\tvis1[a]=1;\n\tque2.push(b);//\u7b2c\u4e8c\u4e2a\u961f\u5217\u4eceb\u5f00\u59cb\u641c\u7d22\n\tpre2[b]=-1;//\u5c06\u524d\u7f00\u6807\u8bb0\u4e3a-1\n\tvis2[b]=1;//\u8bb0\u5f97\u6253\u4e0aa\u4e0eb\u7684\u6807\u8bb0\n\twhile(true) {\n\t\tlong long ti=que1.front();//\u53d6\u51fa\u961f\u5217\u4e00\u7684\u7684\u961f\u9996\n\t\tque1.pop();\n\t\tlong long tt=ti+1;//\u53d8\u63621\n\t\tif(tt>=0&&vis1[tt]==0) {\n\t\t\ttt%=p;\n\t\t\tvis1[tt]=1;\n\t\t\tans1[tt]=ans1[ti]+1;\n\t\t\tpre1[tt]=ti;\n\t\t\tnum1[tt]=1;\n\t\t\tque1.push(tt);\n\t\t\tif(vis2[tt]==1) {\n\t\t\t\tprint(tt);\n\t\t\t\treturn ;\n\t\t\t}\n\t\t}\n\t\ttt=ti-1;//\u53d8\u63622\n\t\tif(tt>=0&&vis1[tt]==0) {\n\t\t\ttt%=p;\n\t\t\tvis1[tt]=1;\n\t\t\tans1[tt]=ans1[ti]+1;\n\t\t\tpre1[tt]=ti;\n\t\t\tnum1[tt]=2;\n\t\t\tque1.push(tt);\n\t\t\tif(vis2[tt]==1) {\n\t\t\t\tprint(tt);\n\t\t\t\treturn ;\n\t\t\t}\n\t\t}\n\t\ttt=ny(ti);//\u53d8\u63623\n\t\tif(tt>=0&&vis1[tt]==0) {\n\t\t\ttt%=p;\n\t\t\tvis1[tt]=1;\n\t\t\tans1[tt]=ans1[ti]+1;\n\t\t\tpre1[tt]=ti;\n\t\t\tnum1[tt]=3;\n\t\t\tque1.push(tt);\n\t\t\tif(vis2[tt]==1) {\n\t\t\t\tprint(tt);\n\t\t\t\treturn ;\n\t\t\t}\n\t\t}\n\t\tti=que2.front();//\u53d6\u51fa\u961f\u5217\u4e8c\u7684\u961f\u9996\n\t\tque2.pop();\n\t\ttt=ti-1;//\u56e0\u4e3a\u662f\u53cc\u5411bfs\uff0c\u6240\u4ee5\u7b2c\u4e8c\u4e2a\u961f\u5217\u91cc\u53d8\u53161\u548c\u53d8\u53162\u662f\u98a0\u5012\u7684\n\t\tif(tt>=0&&vis2[tt]==0) {//\u53d8\u53161\n\t\t\ttt%=p;\n\t\t\tvis2[tt]=1;\n\t\t\tans2[tt]=ans2[ti]+1;\n\t\t\tpre2[tt]=ti;\n\t\t\tnum2[tt]=1;\n\t\t\tque2.push(tt);\n\t\t\tif(vis1[tt]==1) {\n\t\t\t\tprint(tt);\n\t\t\t\treturn ;\n\t\t\t}\n\t\t}\n\t\ttt=ti+1;//\u53d8\u53162\n\t\tif(tt>=0&&vis2[tt]==0) {\n\t\t\ttt%=p;\n\t\t\tvis2[tt]=1;\n\t\t\tans2[tt]=ans2[ti]+1;\n\t\t\tpre2[tt]=ti;\n\t\t\tnum2[tt]=2;\n\t\t\tque2.push(tt);\n\t\t\tif(vis1[tt]==1) {\n\t\t\t\tprint(tt);\n\t\t\t\treturn ;\n\t\t\t}\n\t\t}\n\t\ttt=ny(ti)//\u53d8\u53163\n\t\tif(tt>=0&&vis2[tt]==0) {\n\t\t\ttt%=p;\n\t\t\tvis2[tt]=1;\n\t\t\tans2[tt]=ans2[ti]+1;\n\t\t\tpre2[tt]=ti;\n\t\t\tnum2[tt]=3;\n\t\t\tque2.push(tt);\n\t\t\tif(vis1[tt]==1) {\n\t\t\t\tprint(tt);\n\t\t\t\treturn ;\n\t\t\t}\n\t\t}\n\t}\n}\nint main() {\n\tscanf(\"%lld%lld%lld\",&a,&b,&p);\n\tbfs();\n\treturn 0;\n}\n```\n\u4ee3\u7801\u7ec6\u8282\u6ce8\u610f\uff1a\n\n1.  \u5feb\u901f\u5e42\u4e2d\u4e24\u4e2a\u6570\u76f8\u4e58\u53ef\u80fd\u4f1a\u7206int\uff1b\n\n2.  \u5982\u679c\u53d8\u91cf\u662flong long \u7c7b\u578b\uff0c\u90a3\u4e48\u4f7f\u7528 printf\u51fd\u6570\u65f6\u4e00\u5b9a\u8981\u7528\"%lld\"\uff08\u5982\u679c\u4f60\u4f7f\u7528cin\u548ccout\u8bf7\u5ffd\u7565\u8fd9\u53e5\u8bdd\uff09\uff1b\n\n3. \u4e00\u5b9a\u8981\u628a\u53d8\u91cf\u7c7b\u578b\u641e\u6e05\u695a\uff1b\n\n4.  \u8bb0\u5f97\u53d6\u6a21\uff08\u4e0d\u8981\u50cf\u6211\u4e00\u6837\u8fc7\u4e86\u4e24\u5929\u624d\u53d1\u73b0\uff09\uff1b\n\n5.  \u64cd\u4f5c $ 2 $ \u4e2d\u5982\u679c\u5bf9 $ 0 $ \u8fdb\u884c\u7ed3\u679c\u4f1a\u53d8\u6210 $ p-1 $\u3002\n\n6.  \u6c42\u9006\u5143\u65f6\u4e0d\u7528\u5feb\u901f\u5e42\u4f1a\u8d85\u65f6\u3002\n\n7.  \u8f93\u51fa\u65f6\u8981\u628a\u8bed\u53e5\u987a\u5e8f\u641e\u6e05\u695a\uff0c\u4e00\u5b9a\u8981\u6709\u7ed3\u675f\u6761\u4ef6\u3002\n\n8.  bfs\u91cc\u9762\u627e\u5230\u7b54\u6848\u8981\u8bb0\u5f97\u7acb\u5373\u9000\u51fa\u3002\n\n\u611f\u8c22\u89c2\u770b\uff01",
        "postTime": 1617859142,
        "uid": 400201,
        "name": "Wuyanru",
        "ccfLevel": 7,
        "title": "CF995E Number Clicker"
    },
    {
        "content": "\u8fd9\u9053\u9898\u4e4d\u4e00\u770b\u50cf\u9053\u8fed\u4ee3\u52a0\u6df1\uff0c\u4f46\u770b\u540c\u5b66\u90fd\u7528\u5e7f\u641c\u8fc7\u7684\uff0c\u6211\u5c31\u5f00\u59cb\u7528\u53cc\u5411bfs\u505a\u4e86\u3002\n## \u5e72\u8d27\u8865\u5145\n### \u53cc\u5411 bfs\n\u901a\u8fc7\u540c\u65f6\u4ece\u7ec8\u70b9\u548c\u8d77\u70b9\u5e7f\u641c\uff0c\u627e\u5230\u7b2c\u4e00\u4e2a\u4ea4\u70b9\uff0c\u6b64\u65f6\u4e24\u8fb9\u6b65\u6570\u76f8\u52a0\u5373\u4e3a\u6240\u6c42\uff08\u6bd4\u5355\u5411\u5feb\u5f88\u591a\uff09\u3002![](https://i.loli.net/2019/09/25/jevyd2TPC7FX6GA.png)\n[\u56fe\u7247\u6765\u6e90](https://blog.csdn.net/weixin_43501684/article/details/90147421)\n### \u57fa\u672c\u601d\u8def\n\u540c\u65f6\u4ece $u$ \u548c $v$ \u5e7f\u641c\uff0c\u8bbe\u5f53\u524d\u4ece $u$ \u5e7f\u641c\u5230 $i$ \uff0c\u4ece $v$ \u5e7f\u641c\u5230 $j$ \uff0c\u4ece $i$ \u7684\u5e7f\u641c\u5927\u5bb6\u5e94\u8be5\u90fd\u4f1a\uff0c\u4ece $j$ \u7684\u5e7f\u641c\u5219\u64cd\u4f5c\u4e00\u4e3a $j-1$ ,\u56e0\u4e3a $j$ \u4e3a\u88ab\u52a0\u4e00\u540e\u7684\u7ed3\u679c\uff0c\u540c\u7406\u64cd\u4f5c\u4e8c\u4e5f\u4e3a $j+1$ ,\u90a3\u64cd\u4f5c\u4e09\u5462\uff1f\u89c1\u4e0b\u65b9\u3002\n### \u5173\u4e8e\u9006\u5143\n\n\u6ce8\u610f\u5230\u9006\u5143\u662f\u5728 $\\bmod$ $p$ \u7684\u60c5\u51b5\u4e0b\uff0c\u6240\u4ee5 $a$ \u7684\u9006\u5143\u7684\u9006\u5143\u5373\u4e3a $a$ \u3002\u6240\u4ee5\u64cd\u4f5c\u4e09\u7684\u9006\u64cd\u4f5c\u5373\u4e3a\u6c42 $j$ \u7684 $p-2$ \u6b21\u65b9\u3002\n## \u4e24\u4e2a\u5c0f\u7ec6\u8282\n\u5f00 long long\u3002\n\n\u56e0\u4e3a\u6211\u662f\u624b\u5199\u961f\u5217\uff0c\u6240\u4ee5\u6570\u7ec4\u4e00\u5b9a\u8981\u5f00\u5927\u4e9b\u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nlong long int u,v,p;\nmap<long long int,bool>q;\nmap<long long int,bool>q1;//\u5224\u91cd\nmap<long long int,long long int>p1;\nmap<long long int,long long int>p2;//\u8bb0\u524d\u7f00\nmap<long long int,long long int>num;\nmap<long long int,long long int>num1;//\u8bb0\u8def\u5f84\nmap<long long int,long long int>ans;\nmap<long long int,long long int>ans1;//\u8bb0\u6b65\u6570\nlong long int qwq[1000001];\nlong long int qaq[1000001];\nint mi(int x)\n{\n\tlong long int ans=1,base=x;\n\tlong long int mod=p-2;\n\twhile(mod)\n\t{\n\t\tif(mod&1)\n\t\t\tans=(ans*base)%p;\n\t\tbase=(base*base)%p;\n\t\tmod>>=1;\n\t}\n\treturn ans;\n}\nvoid print1(int x)\n{\n\tif(p1[x]==-1)\n\t\treturn;\n\tprint1(p1[x]);\n\tcout<<num[x]<<\" \";\n}\nvoid print2(int x)\n{\n\tif(p2[x]==-1)\n\t\treturn;\t\n\tcout<<num1[x]<<\" \";\n\tprint2(p2[x]);\n}\nvoid print(int x)\n{\n\tprint1(x);\n\tprint2(x);\n}\nvoid bfs()\n{\n\tlong long int head=0,end=1,head1=0,end1=1;\n\tq[u]=1;\n\tq1[v]=1;\n\tp1[u]=-1;\n\tp2[v]=-1;\n\tqaq[1]=v;\n\tqwq[1]=u;\n\tlong long int a,a1;\n\twhile(1)//\u8fd9\u91cc\u5199while\uff081\uff09\u662f\u56e0\u4e3a\u5b83\u4fdd\u8bc1\u6709\u89e3\n\t{\n\t\ta=qwq[++head];\t\n\t\tlong long int b=a+1;\n\t\tif(b>=0&&q[b]==0)\n\t\t{\n\t\t\tb%=p;\n\t\t\tq[b]=1;\n\t\t\tqwq[++end]=b;\n\t\t\tans[b]=ans[a]+1;\n\t\t\tp1[b]=a;\n\t\t\tnum[b]=1;\n\t\t\tif(q1[b]==1)\n\t\t\t{\n\t\t\t\tcout<<ans[b]+ans1[b]<<endl;\n\t\t\t\tprint(b);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t}\n\t\tb=a-1;\n\t\tif(b>=0&&q[b]==0)\n\t\t{\n\t\t\tb%=p;\n\t\t\tq[b]=1;\n\t\t\tqwq[++end]=b;\n\t\t\tans[b]=ans[a]+1;\n\t\t\tp1[b]=a;\n\t\t\tnum[b]=2;\n\t\t\tif(q1[b]==1)\n\t\t\t{\n\t\t\t\tcout<<ans[b]+ans1[b]<<endl;\n\t\t\t\tprint(b);\n\t\t\t\treturn;\n\t\t\t}\t\t\t\n\t\t}\n\t\tb=mi(a);\n\t\tif(b>=0&&q[b]==0)\n\t\t{\n\t\t\tb%=p;\n\t\t\tq[b]=1;\n\t\t\tqwq[++end]=b;\n\t\t\tans[b]=ans[a]+1;\n\t\t\tp1[b]=a;\n\t\t\tnum[b]=3;\n\t\t\tif(q1[b])\n\t\t\t{\n\t\t\t\tcout<<ans[b]+ans1[b]<<endl;\n\t\t\t\tprint(b);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\ta1=qaq[++head1];\t\t\t\t\t\n\t\tb=a1+1;\n\t\tif(b>=0&&q1[b]==0)\n\t\t{\n\t\t\tb%=p;\n\t\t\tq1[b]=2;\n\t\t\tqaq[++end1]=b;\n\t\t\tans1[b]=ans1[a1]+1;\n\t\t\tp2[b]=a1;\n\t\t\tnum1[b]=2;\n\t\t\tif(q[b])\n\t\t\t{\n\t\t\t\tcout<<ans[b]+ans1[b]<<endl;\n\t\t\t\tprint(b);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t}\n\t\tb=a1-1;\n\t\tif(b>=0&&q1[b]==0)\n\t\t{\n\t\t\tb%=p;\n\t\t\tq1[b]=1;\n\t\t\tqaq[++end1]=b;\n\t\t\tans1[b]=ans1[a1]+1;\n\t\t\tp2[b]=a1;\n\t\t\tnum1[b]=1;\n\t\t\tif(q[b])\n\t\t\t{\n\t\t\t\tcout<<ans[b]+ans1[b]<<endl;\n\t\t\t\tprint(b);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t}\n\t\tb=mi(a1);\n\t\tif(b>=0&&q1[b]==0)\n\t\t{\n\t\t\tb%=p;\n\t\t\tq1[b]=1;\n\t\t\tqaq[++end1]=b;\n\t\t\tans1[b]=ans1[a1]+1;\n\t\t\tp2[b]=a1;\n\t\t\tnum1[b]=3;\n\t\t\tif(q[b]==1)\n\t\t\t{\n\t\t\t\tcout<<ans[b]+ans1[b]<<endl;\n\t\t\t\tprint(b);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t}\t\t\n\t}\n\t\n}\nint main()\n{\n\tcin>>u>>v>>p;\n\tif(u==v)\n\t{\n\t\tcout<<0;\n\t\treturn 0;\n\t}\n\tbfs();\n\treturn 0;\n}\n```\n",
        "postTime": 1618145459,
        "uid": 437795,
        "name": "wanggiaoxing",
        "ccfLevel": 7,
        "title": "CF995E"
    },
    {
        "content": "~~\u8fd9\u9053\u9898\u6211\u4e00\u5f00\u59cb\u770b\u8fd8\u4ee5\u4e3a\u662f\u6570\u5b66\u9898~~\n\n\u6c42\u9006\u5143\u5176\u5b9e\u5c31\u53ef\u4ee5\u770b\u5b8c\u968f\u673a\u8df3\u5230\u53e6\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u90a3\u4e48\u6839\u636e\u751f\u65e5\u6096\u8bba\uff0c\u72b6\u6001\u6570\u4e0d\u4f1a\u592a\u591a\uff0c\u53cc\u5411bfs\u5373\u53ef\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint u,v,p;\nmap<int,int>vis1,vis2,nxt,pre;//\u8bb0\u5f55\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u6709\u4e48\u6709\u88ab\u8bbf\u95ee\u8fc7\u548c\u662f\u54ea\u8df3\u8fc7\u6765\u7684\nqueue<int> q1,q2;\nint qpow(int a,int b){\n\tif(b==0)return 1;\n\tint tmp=qpow(a,b/2);\n\treturn b%2?tmp*tmp%p*a%p:tmp*tmp%p;\t\n}\nmain(){\n\tscanf(\"%lld%lld%lld\",&u,&v,&p);\n\tq1.push(u);\n\tq2.push(v);\n\tvis1[u]=1;\n\tpre[u]=-1;\n\tvis2[v]=1;\n\tnxt[v]=-1;\n\twhile(!q1.empty()){\n\t\tint now=q1.front();\n\t\tq1.pop();\n\t\tif(vis2[now]){\n\t\t\tprintf(\"%lld\\n\",vis1[now]+vis2[now]-2);\n\t\t\tstack<int>s;\n\t\t\tint tmp=now;\n\t\t\twhile(tmp!=-1){\n\t\t\t\ts.push(tmp);\n\t\t\t\ttmp=pre[tmp];\n\t\t\t}\n\t\t\twhile(s.size()!=1){\n\t\t\t\tint k=s.top();\n\t\t\t\ts.pop();\n\t\t\t\tif((k+1)%p==s.top()){\n\t\t\t\t\tprintf(\"1 \");\n\t\t\t\t}\n\t\t\t\telse if((k+p-1)%p==s.top()){\n\t\t\t\t\tprintf(\"2 \");\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tprintf(\"3 \");\n\t\t\t\t}\n\t\t\t}\n\t\t\ttmp=now;\n\t\t\twhile(nxt[tmp]!=-1){\n\t\t\t\tif((tmp+1)%p==nxt[tmp]){\n\t\t\t\t\tprintf(\"1 \");\n\t\t\t\t}\n\t\t\t\telse if((tmp+p-1)%p==nxt[tmp]){\n\t\t\t\t\tprintf(\"2 \");\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tprintf(\"3 \");\n\t\t\t\t}\n\t\t\t\ttmp=nxt[tmp];\n\t\t\t}\n\t\t\treturn 0;\n\t    }\n\t\tif(!vis1[(now+1)%p])q1.push((now+1)%p),vis1[(now+1)%p]=vis1[now]+1,pre[(now+1)%p]=now;\n\t\tif(!vis1[(now-1+p)%p])q1.push((now-1+p)%p),vis1[(now-1+p)%p]=vis1[now]+1,pre[(now-1+p)%p]=now;\n\t\tint power=qpow(now,p-2);\n\t\tif(!vis1[power])q1.push(power),vis1[power]=vis1[now]+1,pre[power]=now;\n\t\tnow=q2.front();q2.pop();\n\t\tif(!vis2[(now+1)%p])q2.push((now+1)%p),vis2[(now+1)%p]=vis2[now]+1,nxt[(now+1)%p]=now;\n\t\tif(!vis2[(now-1+p)%p])q2.push((now-1+p)%p),vis2[(now-1+p)%p]=vis2[now]+1,nxt[(now-1+p)%p]=now;\n\t\tpower=qpow(now,p-2);\n\t\tif(!vis2[power])q2.push(power),vis2[power]=vis2[now]+1,nxt[power]=now;\n\t}\n}\n```\n\u8fd8\u6709...\n\n\u636e\u6211\u4eec\u5b66\u6821\u7684\u5b66\u957f\u8bf4\uff0c\u53cc\u5411\u5e7f\u641c\u53ef\u80fd\u641c\u51fa\u6765\u7684\u4e0d\u662f\u6700\u4f18\u89e3\n",
        "postTime": 1566130025,
        "uid": 183154,
        "name": "swiftc",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF995E \u3010Number Clicker\u3011"
    },
    {
        "content": "\u8fd9\u9898\u770b\u7740\u633a\u5413\u4eba\uff0c\u5b9e\u9645\u4e0a\u53cc\u5411BFS\u5373\u53ef\uff0c\u636eCF\u9898\u89e3\u8bf4\u662f\u4e0d\u4f1a\u641c\u8d85\u8fc7$10^7$\u79cd\u72b6\u6001\u7684\uff0c\u4e8e\u662f\u8dd1\u4e86\u8fc7\u53bb\n\nCode\n```\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll u, v, p;\ninline ll pw(ll x, ll y){\n\tll ans = 1;\n\twhile(y){\n\t\tif(y & 1)(ans *= x) %= p;\n\t\tx = x * x % p;\n\t\ty >>= 1;\n\t}\n\treturn ans;\n}\nmap <ll, ll> M, pre, Vis, nxt;\nqueue <ll> q, q2;\nint stk[1000], top = 0;\nint main(){\n\tscanf(\"%lld%lld%lld\", &u, &v, &p);\n\tq.push(u); M[u] = 1; pre[u] = -1; q2.push(v); Vis[v] = 1; nxt[v] = -1;\n\twhile(! q.empty()){\n\t\tll x = q.front(), f; q.pop();\n\t\tif(Vis[x]){\n\t\t\tprintf(\"%lld\\n\", M[x] + Vis[x] - 2);\n\t\t\tint v = x;\n\t\t\twhile(v != -1)stk[++ top] = v, v = pre[v];\n\t\t\tfor(int i = top; i > 1; -- i){\n\t\t\t\tif((stk[i] + 1) % p == stk[i - 1])printf(\"1 \");\n\t\t\t\telse if((stk[i] + p - 1) % p == stk[i - 1])printf(\"2 \");\n\t\t\t\telse printf(\"3 \");\n\t\t\t}\n\t\t\twhile(nxt[x] != -1){\n\t\t\t\tif((x + 1) % p == nxt[x])printf(\"1 \");\n\t\t\t\telse if((x + p - 1) % p == nxt[x])printf(\"2 \");\n\t\t\t\telse printf(\"3 \");\n\t\t\t\tx = nxt[x];\n\t\t\t}\n\t\t\treturn 0;\n\t\t}\n\t\tif(!M[f = (x + 1) % p])q.push(f), M[f] = M[x] + 1, pre[f] = x;\n\t\tif(!M[f = (x + p - 1) % p])q.push(f), M[f] = M[x] + 1, pre[f] = x;\n\t\tif(!M[f = pw(x, p - 2)])q.push(f), M[f] = M[x] + 1, pre[f] = x;\n\t\tx = q2.front(); q2.pop();\n\t\tif(!Vis[f = (x + 1) % p])q2.push(f), Vis[f] = Vis[x] + 1, nxt[f] = x;\n\t\tif(!Vis[f = (x + p - 1) % p])q2.push(f), Vis[f] = Vis[x] + 1, nxt[f] = x;\n\t\tif(!Vis[f = pw(x, p - 2)])q2.push(f), Vis[f] = Vis[x] + 1, nxt[f] = x;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1563938065,
        "uid": 29519,
        "name": "qianfujia",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF995E \u3010Number Clicker\u3011"
    },
    {
        "content": "[\u535a\u5ba2\u56ed\u4f53\u9a8c\u66f4\u4f73](https://www.cnblogs.com/C202202chenkelin/p/14507927.html)\n# \u9898\u76ee\u5927\u610f\n\u7ed9\u5b9a\u4e24\u4e2a\u6570 $u$ \uff0c $v$ \u3002\u6709\u4e09\u79cd\u64cd\u4f5c\uff1a\n1. $u=u+1(mod$ $p)$ \u3002\n2. $u=u+p\u22121(mod$ $p)$ \u3002\n3. $u=u^{p\u22122}(mod$ $p)$ \u3002\n\n# \u601d\u8def\n## BFS\n\u72b6\u6001\u592a\u591a\u5bfc\u81f4\u961f\u5217\u88c5\u4e0d\u4e0b\u3002\n## \u8fed\u4ee3\u52a0\u6df1\n$TLE$ \uff0c\u6d6a\u8d39\u4e86\u592a\u591a\u65f6\u95f4\u5728\u6bcf\u4e00\u5c42\u4e0a\uff0c\u6ca1\u6709\u8bb0\u5fc6\u5316\u4e14\u72b6\u6001\u5f88\u591a\u3002\n## IDA*\n\u4e0d\u884c\uff0c\u65e0\u6cd5\u5f97\u51fa\u4e50\u89c2\u4f30\u4ef7\u51fd\u6570\u3002\n## \u53cc\u5411BFS\n\u8fd9\u6837\u4f1a\u5c06\u6b65\u6570\u5f88\u4e3a\u4e24\u534a\uff0c\u72b6\u6001\u76f8\u8f83\u4e8e\u666e\u901a\u7684 $BFS$ \u4f1a\u5c11\u5f88\u591a\u3002\n\n\u5148\u6765\u770b\u64cd\u4f5c\u4e00\u548c\u64cd\u4f5c\u4e8c\uff0c\u4ed6\u4eec\u7684\u5173\u7cfb\u662f\u53ef\u4ee5\u4e92\u9006\u7684\u3002\u4e00\u4e2a\u5bf9\u4e8e\u539f\u6570 $+1$ \uff0c\u53e6\u4e00\u4e2a\u5bf9\u4e8e\u539f\u6570 $-1$ \u3002\n\n\u64cd\u4f5c\u4e09\u548c\u64cd\u4f5c\u4e09\u662f\u4e92\u9006\u7684\uff0c\u7531\u8d39\u9a6c\u5c0f\u5b9a\u7406\u53ef\u77e5\uff1a\u82e5 $p$ \u4e3a\u8d28\u6570\uff0c\u5219 $a^{p-1}\u22611(mod$ $p)$\u3002\n\n\u53ef\u5f97\u51fa\uff1a$(u^{p-2})^{p-2}\u2261u^{(p-2)(p-2)}\u2261u^{(p-1)(p-3)+1}\u2261(u^{p-1})^{p-3}u\u2261u(mod$ $p)$\n\n\u90a3\u4e48\u5c31\u5206\u522b\u7531\u5f00\u59cb\u72b6\u6001\u4e0e\u7ed3\u675f\u72b6\u6001\u6765\u5411\u4e2d\u95f4\u63a8\u8fdb\u3002\n# Code\n```cpp\n#include <map>\n#include <queue>\n#include <cstdio>\n#include <iostream>\nusing namespace std;\nstruct Status {//\u961f\u5217\u4e2d\u4fdd\u5b58\u7684\u72b6\u6001\n\tint step, number, flag;//\u5206\u522b\u662f\uff1a\u6b65\u6570\uff0c\u5f53\u524d\u72b6\u6001\u7684\u6570\uff0c\u6b63\u5411\u6216\u8005\u53cd\u5411\n\tStatus() {}\n\tStatus(int S, int N, int F) {\n\t\tstep = S;\n\t\tnumber = N;\n\t\tflag = F;\n\t}\n};\nconst int MAXN = 1e6 + 5;\nqueue<Status> q;\nmap<int, int> real;\nbool vis[2][MAXN];//\u662f\u5426\u8bbf\u95ee\u8fc7\nint dis[2][MAXN];//\u6b65\u6570\npair<int, int> pre[2][MAXN];//first\u8bb0\u5f55\u524d\u4e00\u4e2a\u6570\u7684\u54c8\u5e0c\u503c\uff0csecond\u8bb0\u5f55\u64cd\u4f5c\u7684\u5e8f\u53f7\nint u, v, p;\nint tot;\nint Quick_Pow(int fpx, int fpy) {//\u5feb\u901f\u5e42\n\tlong long res = 1;\n\tlong long x = fpx;\n\tlong long y = fpy;\n\twhile(y) {\n\t\tif(y & 1)\n\t\t\tres = (res * x) % p;\n\t\tx = (x * x) % p; \n\t\ty >>= 1;\n\t}\n\tint ans = res;\n\treturn ans;\n}\nint Get_Hash(int x) {//map\u6620\u5c04\u5047\u54c8\u5e0c\n\tmap<int, int>::iterator it = real.find(x);\n\tif(it != real.end())\n\t\treturn (*it).second;\n\treal[x] = ++tot;\n\treturn tot;\n}\nvoid Print(int x, int y) {//\u8f93\u51fa\u8def\u5f84\uff1a\u8bb0\u5f55\u6bcf\u4e2a\u524d\u7f00\n\tif(y == -1)\n\t\treturn;\n\tif(!x) {//\u524d\u534a\u90e8\u5206\u5012\u7740\u8f93\u51fa\n\t\tif(pre[x][y].first != -1) {\n\t\t\tPrint(x, pre[x][y].first);\n\t\t\tprintf(\"%d \", pre[x][y].second);\n\t\t}\n\t}\n\telse {//\u540e\u534a\u90e8\u5206\u6b63\u7740\u8f93\u51fa\n\t\tif(pre[x][y].first != -1) {\n\t\t\tprintf(\"%d \", pre[x][y].second);\n\t\t\tPrint(x, pre[x][y].first);\n\t\t}\n\t}\n}\nvoid DoubleBfs() {\n\tint tmp;\n\tq.push(Status(0, u, 0));//\u521d\u59cb\u5316\u4e24\u4e2a\u72b6\u6001\n\tq.push(Status(0, v, 1));\n\ttmp = Get_Hash(u);\n\tvis[0][tmp] = 1;\n\tpre[0][tmp].first = -1;\n\ttmp = Get_Hash(v);\n\tvis[1][tmp] = 1;\n\tpre[1][tmp].first = -1;\n\twhile(!q.empty()) {\n\t\tStatus now = q.front();\n\t\tq.pop();\n\t\tint skt = Get_Hash(now.number);\n\t\tif(vis[!now.flag][skt]) {//\u78b0\u5934\u4e86\u8f93\u51fa\u5e76\u8df3\u51fa\n\t\t\tprintf(\"%d\\n\", dis[!now.flag][skt] + dis[now.flag][skt]);\n\t\t\tif(pre[0][skt].first != -1) {\n\t\t\t\tPrint(0, pre[0][skt].first);\n\t\t\t\tprintf(\"%d \", pre[0][skt].second);\n\t\t\t}\n\t\t\tif(pre[1][skt].first != -1) {\n\t\t\t\tprintf(\"%d \", pre[1][skt].second);\n\t\t\t\tPrint(1, pre[1][skt].first);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tStatus next = now;\n\t\tnext.step++;\n\t\tnext.number = (next.number + 1) % p;\n\t\ttmp = Get_Hash(next.number);\n\t\tif(!vis[now.flag][tmp]) {//\u6ca1\u6709\u88ab\u8bbf\u95ee\u5219\u8bbf\u95ee\n\t\t\tvis[now.flag][tmp] = 1;\n\t\t\tdis[now.flag][tmp] = next.step;\n\t\t\tpre[now.flag][tmp].first = skt;\n\t\t\tif(now.flag)\n\t\t\t\tpre[now.flag][tmp].second = 2;//\u82e5\u662f\u5012\u7740\u7684\uff0c\u5219\u8be5\u64cd\u4f5c\u4e3a1\n\t\t\telse\n\t\t\t\tpre[now.flag][tmp].second = 1;//\u82e5\u662f\u6b63\u7740\u7684\uff0c\u5219\u8be5\u64cd\u4f5c\u4e3a2\n\t\t\tq.push(next);\n\t\t}\n\t\tnext = now;\n\t\tnext.step++;\n\t\tnext.number = (next.number + p - 1) % p;\n\t\ttmp = Get_Hash(next.number);\n\t\tif(!vis[now.flag][tmp]) {//\u540c\u4e0a\n\t\t\tvis[now.flag][tmp] = 1;\n\t\t\tdis[now.flag][tmp] = next.step;\n\t\t\tpre[now.flag][tmp].first = skt;\n\t\t\tif(now.flag)\n\t\t\t\tpre[now.flag][tmp].second = 1;\n\t\t\telse\n\t\t\t\tpre[now.flag][tmp].second = 2;\n\t\t\tq.push(next);\n\t\t}\n\t\tnext = now;\n\t\tnext.step++;\n\t\tnext.number = Quick_Pow(next.number, p - 2) % p;\n\t\ttmp = Get_Hash(next.number);\n\t\tif(!vis[now.flag][tmp]) {//\u540c\u4e0a\n\t\t\tvis[now.flag][tmp] = 1;\n\t\t\tdis[now.flag][tmp] = next.step;\n\t\t\tpre[now.flag][tmp].first = skt;\n\t\t\tpre[now.flag][tmp].second = 3;//\u81ea\u5df1\u7684\u9006\u64cd\u4f5c\u5c31\u662f\u81ea\u5df1\n\t\t\tq.push(next);\n\t\t}\n\t}\n}\nint main() {\n\tscanf(\"%d %d %d\", &u, &v, &p);\n\tDoubleBfs();\n\treturn 0;\n}\n```",
        "postTime": 1615293442,
        "uid": 254733,
        "name": "Night_Bringer",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF995E Number Clicker"
    },
    {
        "content": "\u8fd9\u9053\u9898\u5176\u5b9e\u96be\u5ea6\u5e76\u4e0d\u5927\uff0c\u662f\u6211\u4e00\u6b21\u6a21\u62df\u8d5b\u7684\u9898\uff0c~~\u5c3d\u7ba1\u6211\u5728\u8003\u8bd5\u65f6\u6ca1\u80fdA\u6389\uff0c\u800c\u4e14\u8fd8\u6ca1\u5f97\u51e0\u5206~~\uff0c\u6211\u4eec\u770b\u8fd9\u9053\u9898\uff0c\u6050\u6015\u6700\u66b4\u529b\u7684\u601d\u8def\u5c31\u662fbfs\uff08~~\u751a\u81f3\u8003\u573a\u4e0a\u6211\u90fd\u6ca1\u8fd9\u4e48\u6253\uff0c\u6211\u592a\u5f31\u4e86~~\uff09\n\n\u5728\u66b4\u529b\u7684\u57fa\u7840\u4e0a\uff0c\u6211\u4eec\u8fdb\u884c\u4f18\u5316\uff0c\u5176\u5b9e\u4e0d\u96be\u53d1\u73b0\uff0c\u8fd9\u9053\u9898\u4ec5\u9700\u53cc\u5411bfs\u5373\u53ef,~~\u7b11~~\n\n\u8fd9\u9898\u8d70\u7684\u65f6\u5019\u6709\u4e09\u79cd\u60c5\u51b5\uff0c+1\uff0c-1\uff0c\u6c42\u9006\u5143\uff0c\u7531\u4e8e\u8981\u8f93\u51fa\u8fc7\u7a0b\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u5728\u53cc\u5411bfs\u7684\u8fc7\u7a0b\u4e2d\u7ef4\u62a4\u4e00\u4e0b\u5f53\u524d\u6570\u7684\u7236\u4eb2\uff0c\u5373\u5f53\u524d\u6570\u662f\u7531\u54ea\u4e2a\u6570\u8fdb\u884c\u64cd\u4f5c\u540e\u5f97\u5230\u7684\n\n//~~spyz201862\u63d0\u9192\u60a8\uff0cu==v\u65f6\u7279\u5224\u5343\u4e07\u522b\u5fd8QwQ~~\n\n\u4e0b\u9762\u6765\u770b\u4e00\u4e0b\u6211\u7684\u4ee3\u7801\n\n```cpp\n#pragma GCC optimize(2)\n#include<cstdio>\n#include<cctype>\n#include<queue>\n#include<map>\nusing namespace std;\n#define rg register\ntypedef long long LL;\nint u,v,mod,nw1,nw2,ans,anss[222],w;\nmap<int,int>vis1,vis2,fa,hw;\ntemplate<class T>inline void read(T &x)\n{\n    x=0;int f=0;char ch=getchar();\n    while(!isdigit(ch)){f|=(ch=='-');ch=getchar();}\n    while(isdigit(ch)){x=(x<<1)+(x<<3)+(ch^48);ch=getchar();}\n    x=f?-x:x;\n}\ninline LL ksm(LL x,int y)\n{\n    LL res=1;\n    while(y){\n        if(y&1) res=(res*x)%mod;\n        x=(x*x)%mod;\n        y>>=1;\n    }\n    return (int)(res%mod);\n}\ninline void dl_bfs()\n{\n    queue<pair<int,int> >p,q;\n    p.push(make_pair(u,0));q.push(make_pair(v,0));\n    vis1[u]=vis2[v]=1;\n    while(p.size()||q.size()){\n        if(p.size()){\n            int x=p.front().first,y=p.front().second,ii;\n            p.pop();\n            if(y>199) continue;\n            ii=(x-1+mod)%mod;\n            if(vis2[ii]){nw1=x;nw2=ii;w=2;break;}\n            if(!vis1[ii]) vis1[ii]=1,fa[ii]=x,hw[ii]=2,p.push(make_pair(ii,y+1));\n            ii=(x+1+mod)%mod;\n            if(vis2[ii]){nw1=x;nw2=ii;w=1;break;}\n            if(!vis1[ii]) vis1[ii]=1,fa[ii]=x,hw[ii]=1,p.push(make_pair(ii,y+1));\n            ii=ksm((LL)x,mod-2);\n            if(vis2[ii]){nw1=x;nw2=ii;w=3;break;}\n            if(!vis1[ii]) vis1[ii]=1,fa[ii]=x,hw[ii]=3,p.push(make_pair(ii,y+1));\n        }\n        if(q.size()){\n            int x=q.front().first,y=q.front().second,ii;\n            q.pop();\n            if(y>199) continue;\n            ii=(x-1+mod)%mod;\n            if(vis1[ii]){nw1=ii;nw2=x;w=1;break;}\n            if(!vis2[ii]) vis2[ii]=1,fa[ii]=x,hw[ii]=1,q.push(make_pair(ii,y+1));\n            ii=(x+1+mod)%mod;\n            if(vis1[ii]){nw1=ii;nw2=x;w=2;break;}\n            if(!vis2[ii]) vis2[ii]=1,fa[ii]=x,hw[ii]=2,q.push(make_pair(ii,y+1));\n            ii=ksm((LL)x,mod-2);\n            if(vis1[ii]){nw1=ii;nw2=x;w=3;break;}\n            if(!vis2[ii]) vis2[ii]=1,fa[ii]=x,hw[ii]=3,q.push(make_pair(ii,y+1));\n        }\n    }\n}\ninline void search1(int x)\n{\n    if(x==u) return;\n    search1(fa[x]);\n    anss[++ans]=hw[x];\n}\ninline void search2(int x)\n{\n    if(x==v) return;\n    anss[++ans]=hw[x];\n    search2(fa[x]);\n}\nint main()\n{\n    read(u);read(v);read(mod);\n    if(u==v){printf(\"0\\n\");return 0;}\n    dl_bfs();\n    search1(nw1);\n    anss[++ans]=w;\n    search2(nw2);\n    printf(\"%d\\n\",ans);\n    for(rg int i=1;i<=ans;++i) printf(\"%d \",anss[i]);\n    printf(\"\\n\");\n}\n```\n",
        "postTime": 1564998825,
        "uid": 84726,
        "name": "sp201613",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF995E \u3010Number Clicker\u3011"
    }
]
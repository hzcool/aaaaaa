[
    {
        "content": "\u4ea4\u4e92\u672c\u8d28\u6709\u4f55\u7528\uff1f\n\n\u6211\u4eec\u4ed4\u7ec6\u601d\u8003\uff0c\u52a0\u51cf\u4e58\u9664\u4e58\u65b9\u6211\u4eec\u90fd\u80fd\u76f4\u63a5\u5b9e\u73b0\uff0c\u552f\u72ec `sqrt` \u4f3c\u4e4e\u4e0d\u597d\u5b9e\u73b0\u3002\n\n\u6211\u4eec\u8bbe $n = p_1p_2\\ldots p_k$\u3002\n\n\u6211\u4eec\u8003\u8651\u5982\u4f55\u901a\u8fc7 `sqrt` \u83b7\u53d6\u4fe1\u606f\u3002\u8bbe $y=x^2$\uff0c\u6211\u4eec\u8be2\u95ee `sqrt y` \u5f97\u5230\u4e86\u4e00\u4e2a\u4e0d\u540c\u4e8e $x$ \u7684\u89e3 $x'$\uff0c\u90a3\u4e48\n\n$$x^2=x'^2 \\pmod n$$\n\n$$(x-x')(x+x')=0 \\pmod n$$\n\n$$(x-x')(x+x')=kn$$\n\n\u90a3\u4e48 $x-x'$ \u548c $x+x'$ \u5c06 $n$ \u7684\u8d28\u56e0\u6570\u5206\u6210\u4e86\u4e24\u4e2a\u96c6\u5408 $S_1, S_2$\u3002\n\n\u6211\u4eec\u8fdb\u884c\u82e5\u5e72\u6b21\u8fd9\u6837\u7684\u64cd\u4f5c\uff0c\u5f97\u5230\u4e86\u82e5\u5e72\u4e2a $S$\uff0c\u90a3\u4e48\u6211\u4eec\u80fd\u6c42\u51fa\u4e00\u4e2a\u8d28\u56e0\u5b50 $p_i$ \u5f53\u4e14\u4ec5\u5f53\u5bf9\u4e8e\u6bcf\u4e2a $j\\neq i$\uff0c\u5b58\u5728\u4e00\u4e2a $S$ \u4f7f\u5f97 $p_j$ \u5728 $S$ \u4e2d\u51fa\u73b0\u4f46 $p_i$ \u6ca1\u6709\u51fa\u73b0\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5982\u4f55\u5f97\u5230\u4e00\u4e2a $x'$\uff1f\n\n\u6211\u4eec\u628a\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u5c55\u5f00\uff1a\n\n$$x^2-x'^2=0 \\pmod {p_1}$$\n$$x^2-x'^2=0 \\pmod {p_2}$$\n$$x^2-x'^2=0 \\pmod {p_3}$$\n$$\\ldots$$\n\n\u8fd9\u4e9b\u5f0f\u5b50\u4e2d\u53ea\u8981\u6709\u4e00\u4e2a\u6210\u7acb\uff0c\u6700\u540e\u6211\u4eec\u7528 CRT \u5408\u5e76\u56de\u53bb\u5c31\u662f\u539f\u5f0f\u3002\n\n$x^2-x'^2=0 \\pmod {p}$ \u7684\u89e3\u4e3a $x'=x$ \u548c $x = p-x$\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u5171\u6709 $2^k$ \u79cd\u89e3\uff0c\u65e0\u8bba\u4ea4\u4e92\u5e93\u5982\u4f55\u8fdb\u884c\uff0c\u6211\u4eec\u7684 $x$ \u5bf9\u65b9\u662f\u4e0d\u77e5\u9053\u7684\uff0c\u6240\u4ee5\u8fd4\u56de\u7684 $x'=x$ \u7684\u6982\u7387\u662f $2^{-k}$\uff0c\u663e\u7136\uff0c\u8fd9\u4e2a\u6982\u7387\u5f88\u5c0f\u3002\n\n\u5e76\u4e14\u7531\u6b64\u6211\u4eec\u5f97\u5230\uff1a$S_1, S_2$ \u7684\u5206\u914d\u4e5f\u662f\u968f\u673a\u7684\u3002\u6240\u4ee5 $p_i, p_j$ \u4e0d\u540c\u65f6\u51fa\u73b0\u5728\u4e00\u4e2a $S$ \u4e2d\u7684\u6982\u7387\u4e3a $50\\%$\u3002\n\n\u6211\u4eec\u968f\u673a\u627e\u5230 $t$ \u7ec4 $S_1, S_2$\uff0c\u8fd9\u6837\u5bf9\u4e00\u4e2a $i$\uff0c\u4e00\u4e2a $j$ \u6ee1\u8db3\u7684\u6982\u7387\u4e3a $1-2^{-t}$\uff0c\u5168\u90e8 $(i, j)$ \u90fd\u6ee1\u8db3\u7684\u6982\u7387\u4e3a $(1-2^{-t})^{k^2}$\u3002\n\n\u4ee4 $t=50$\uff0c\u5219\u6b63\u786e\u6027\u5df2\u7ecf\u8db3\u591f\u3002\n\n\u7531\u4e8e\u8981\u4f7f\u7528\u9ad8\u7cbe\u5ea6\uff0c\u4ee3\u7801\u4f7f\u7528 python\uff0c\u4e0d\u8fc7\u5341\u5206\u7b80\u5355\u3002\n\n```python\nfrom random import *\nimport math\n\ndef gcd(a, b):\n\tif a == 0:\n\t\treturn b\n\telse:\n\t\treturn gcd(b % a, a)\n\n\nn = int(input())\nval = []\nans = []\nfor _ in range(50):\n\tx = randint(1, n - 1)\n\tprint(\"sqrt %d\" % (x * x % n))\n\ty = int(input())\n\tif x != y:\n\t\tif x > y:\n\t\t\tx, y = y, x\n\t\tval.append(y - x), val.append(n // (y - x))\nwhile n != 1:\n\tp = n\n\tfor i in range(len(val)):\n\t\tif gcd(p, val[i]) != 1:\n\t\t\tp = gcd(p, val[i])\n\tfor i in range(len(val)):\n\t\tif val[i] % p == 0:\n\t\t\tval[i] = val[i] // p\n\twhile n % p == 0:\n\t\tn = n // p\n\tans.append(p)\nprint(\"!\", len(ans), *ans)\n\n```\n",
        "postTime": 1603877389,
        "uid": 49093,
        "name": "_sys",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1091G \u3010New Year and the Factorisation Collaboration\u3011"
    }
]
[
    {
        "content": "\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c$f(l,r)$\u53ef\u4ee5,\u90a3\u4e48$f(l,r+1) f(l,r+2) f(l,r + x)$\u90fd\u53ef\u4ee5(\u53ea\u8981$l,r$\u5728\u89c4\u5b9a\u8303\u56f4\u5185)\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u53cc\u6307\u9488\uff0c\u5bf9\u4e8e\u6bcf\u4e2a$l$\uff0c\u627e\u5230\u4e00\u4e2a\u6700\u5c0f\u7684$r$\u4f7f\u5176\u6ee1\u8db3\u6761\u4ef6\uff0c\u5f53$l$\u5411\u53f3\u79fb\u52a8\u65f6$r$\u4e5f\u8ddf\u7740\u5411\u53f3\u79fb\u52a8\u3002\n\n\u90a3\u4e48\u600e\u4e48\u5224\u65ad\u662f\u5426\u6ee1\u8db3\u6761\u4ef6\u5462\uff0c\u6211\u4eec\u8bb0\u5f55\u4ee5\u4e0b\u8fd9\u4e9b\u6570\u7ec4\n\n$p_i$\u8868\u793a$i$\u5728\u539f\u6570\u7ec4\u51fa\u73b0\u6700\u65e9\u7684\u4f4d\u7f6e\n\n$q_i$\u8868\u793a$i$\u5728\u539f\u6570\u7ec4\u51fa\u73b0\u6700\u65e9\u7684\u4f4d\u7f6e\n\n$p1_i$\u8868\u793a$i-n$\u5728\u539f\u6570\u7ec4\u51fa\u73b0\u6700\u65e9\u7684\u4f4d\u7f6e\n\n$q1_i$\u8868\u793a$1-i$\u5728\u539f\u6570\u7ec4\u51fa\u73b0\u6700\u665a\u7684\u4f4d\u7f6e\n\n\u6211\u4eec\u8003\u8651\u5f53$l - 1$\u79fb\u52a8\u5230$l$\u65f6\u9700\u8981\u6ee1\u8db3\u7684\u6761\u4ef6\uff0c\u56e0\u4e3a\u79fb\u52a8\u4e86\uff0c\u6240\u4ee5$l-1$\u4e0d\u4f1a\u88ab\u5220\u53bb\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u8981\u4fdd\u8bc1$l - 2$\u53ca\u4ee5\u4e0b\u7684\u6240\u6709\u6570\u90fd\u5728$l-1$\u5de6\u8fb9\u5373$p2[l - 2] < p[l - 1]$\n\n\u6211\u4eec\u8003\u8651\u5f53$r$\u79fb\u52a8\u5230$r + 1$\u65f6\u9700\u8981\u6ee1\u8db3\u7684\u6761\u4ef6\uff0c\u5f53$q1[l - 1] > p1[r + 1]$\u5373$l-1$\u4ee5\u5185\u51fa\u73b0\u6700\u665a\u7684\u6570\u5927\u4e8e$r+1$\u4e4b\u5916\u51fa\u73b0\u6700\u65e9\u7684\u6570\uff0c\u56e0\u4e3a\u6b64\u65f6\u4e0d\u6ee1\u8db3\u9898\u610f\u6240\u4ee5\u624d\u8981\u79fb\u52a8$r$,\u6700\u540e\u5f97\u5230\u7684$r$\u5c31\u662f\u6700\u5c0f\u7684\u6ee1\u8db3\u9898\u610f\u7684$r$\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int N = 1e6 + 10;\nconst int inf = INT_MAX;\n\n#define int long long\n#define FOR(i,a,b) for(int i = a;i <= b;i++)\n#define _FOR(i,a,b) for(int i = a;i >= b;i--)\n\ntemplate<typename T> void read(T &x)\n{\n    x = 0;int f = 1;\n    char c = getchar();\n    for(;!isdigit(c);c = getchar()) if(c == '-') f = -1;\n    for(;isdigit(c);c = getchar()) x = x * 10 + c - '0';\n    x *= f;\n}\n\nint n,k,a[N],p[N],q[N],p1[N],q1[N];\nsigned main()\n{\n    //freopen(\".in\",\"r\",stdin);\n    //freopen(\".out\",\"w\",stdout);\n    read(n),read(k);\n\tmemset(p,0x3f,sizeof(p));\n\tFOR(i,1,n)\n\t{\n\t\tread(a[i]);\n\t\tif(p[a[i]] > 1e9) p[a[i]] = i;\n\t\tq[a[i]] = i;\n\t}\n\tFOR(i,1,k)\n\t\tq1[i] = max(q1[i - 1],q[i]);\n\tp1[k] = p[k],p1[k + 1] = 1e9;\n\t_FOR(i,k - 1,1)\n\t\tp1[i] = min(p1[i + 1],p[i]);\n\tint r = k - 1,ans = 0;\n\twhile(r >= 1 && q[r] < p1[r + 1]) r--;\n\t//FOR(i,1,n)\n\t\t//printf(\"%lld %lld %lld %lld\\n\",p[i],q[i],p1[i],q1[i]);\n\tFOR(l,1,k)\n\t{\n\t\tif(l > 2 && p[l - 1] < q1[l - 2]) break;\n\t\t//printf(\"!!!%lld %lld\\n\",q1[l - 1],p1[r + 3]);\n\t\twhile(r <= k && (r < l || q1[l - 1] > p1[r + 1]))\n\t\t\tr++;\n\t\tans += k - r + 1; \n\t}\n\tprintf(\"%lld\\n\",ans);\n    return 0;\n}\n\n\n\n```",
        "postTime": 1595246260,
        "uid": 93382,
        "name": "_gjm2005_",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1167E \u3010Range Deleting\u3011"
    },
    {
        "content": "\u5220\u9664$[l,r]$\u4e2d\u7684\u6240\u6709\u6570\u540e\uff0c\u82e5\u5269\u4e0b\u7684\u662f\u4e00\u4e2a\u5355\u8c03\u9012\u589e\u5e8f\u5217\uff0c\u5219\u5f62\u5982$1..l-1,r+1...x$\uff08\u5141\u8bb8\u6709\u4e9b\u5730\u65b9\u6ca1\u6709\u6570\uff09\n\n\u627e\u4e00\u4e2a\u6700\u5c0f\u7684$suf$\uff0c\u6ee1\u8db3$[suf,x]$\u4e2d\u7684\u6570\u6784\u6210\u4e00\u4e2a\u5355\u8c03\u9012\u589e\u5e8f\u5217\u3002\u8fd9\u662f\u5f88\u5bb9\u6613\u5728\u7ebf\u6027\u65f6\u95f4\u5185\u6c42\u89e3\u7684\uff1a\u7edf\u8ba1\u6bcf\u4e2a\u6570\u7684\u6700\u65e9\u4f4d\u7f6e$first(i)$\u548c\u6700\u665a\u4f4d\u7f6e$last(i)$,\u5012\u5e8f\u8003\u8651\u6bcf\u4e2a$i$:\u82e5$i$\u6ca1\u6709\u51fa\u73b0\uff0c\u90a3\u4e48\u4e00\u5b9a\u80fd\u9009\uff1b\u82e5$last(i)>\\max_{j>i}first(j)$\u90a3\u4e48\u5c31\u7ed3\u675f\uff1b\u5426\u5219\u53ef\u4ee5\u9009\uff0c\u5e76\u7ef4\u62a4\u4e00\u4e0b$\\max_{j\\ge i}first(j)$\u3002\n\n\u8003\u8651\u679a\u4e3e$l$,\u5e76\u8003\u8651$r$\u7684\u53d6\u503c\u8303\u56f4\u3002\u9996\u5148\u82e5$r<suf-1$,\u56e0\u4e3a$suf$\u662f\u6700\u5c0f\u7684\uff0c\u6240\u4ee5$[r+1,x]$\u4e0d\u662f\u5355\u8c03\u9012\u589e\u5e8f\u5217\uff0c\u6545\u6709$r\\ge suf-1$;\u540c\u65f6\u6709$r\\ge l,r\\ge\\max_{j\\le last(l-1)}a_j$;\u53e6\u5916\uff0c$[1,l-1]$\u9700\u8981\u6784\u6210\u4e00\u4e2a\u5355\u8c03\u9012\u589e\u5e8f\u5217\uff0c\u8fd9\u663e\u7136\u4e0e$suf$\u7684\u6c42\u89e3\u7c7b\u4f3c\uff0c\u7ef4\u62a4\u4e00\u4e0b$\\max_{j<l}last(j)$\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$\\mathcal O(n+x)$\n```cpp\n/**********/\n#define MAXN 1000011\nll first[MAXN],last[MAXN],premax[MAXN];\nint main()\n{\n    ll n=read(),m=read();\n    for(ll i=1;i<=n;++i)\n    {\n        ll x=read();\n        if(!first[x])first[x]=i;\n        last[x]=i;\n        premax[i]=max(premax[i-1],x);\n    }\n    ll suf=m+1,pos=n+1;\n    for(ll i=m;i;--i)\n    {\n        if(!first[i]){suf=i;continue;}\n        if(last[i]>pos)break;\n        suf=i,pos=first[i];\n    }\n    ll ans=0,it=0;\n    for(ll l=1;l<=m;++l)\n    {\n        ll r=max(suf-1,l);\n        umax(r,premax[it]);\n        //printf(\"r=%lld\\n\",r);\n        ans+=m-r+1;\n        if(first[l])\n        {\n            if(first[l]<it)break;\n            it=last[l];\n        }\n    }\n    printf(\"%lld\",ans);\n    return 0;\n}\n```",
        "postTime": 1586229846,
        "uid": 73142,
        "name": "\u4e07\u5f18",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1167E \u3010Range Deleting\u3011"
    },
    {
        "content": "\u663e\u7136\u5220\u7684\u6570\u8d8a\u591a\u4e00\u4e2a\u5e8f\u5217\u8d8a\u53ef\u80fd\u662f\u4e0d\u4e0b\u964d\u5e8f\u5217\n\n\u90a3\u4e48\u6211\u4eec\u4ece\u5c0f\u5230\u5927\u679a\u4e3e $r$\uff0c$l$ \u5355\u8c03\u4e0d\u51cf\uff0c\u53cc\u6307\u9488\u5373\u53ef\n\n\u6211\u4eec\u9700\u8981\u7ef4\u62a4\u52a0\u5165\u4e00\u4e2a\u6570\u3001\u5220\u9664\u4e00\u4e2a\u6570\u3001\u67e5\u8be2\u662f\u5426\u5408\u6cd5\uff0c\u6211\u7528 `set` \u67e5\u8be2\u524d\u9a71\u540e\u7ee7\uff0c\u7528\u53ef\u5220\u5806\u7ef4\u62a4\u76f8\u90bb\u6570\u7684\u5dee\u7684\u6700\u5c0f\u503c\n\n\u6211\u7684\u5199\u6cd5\u590d\u6742\u5ea6\u662f\u5bf9\u7684\uff0c\u6ca1\u6709\u64a4\u9500\u64cd\u4f5c\u7684\uff0c\u4f46\u662f\u88ab\u5361\u5e38\u4e86\uff0cTime limit exceeded on test 50\n\n\u8fd8\u662f\u53c2\u8003\u7ebf\u6027\u505a\u6cd5\u7684\u9898\u89e3\u5427\n\n```cpp\nconst int N = 1000010;\nint n,x;struct data { int pos,v; }a[N];\nll ans;\nset<pair<int,int> > s;\nstruct heap\n{\n\tpriority_queue<int,vector<int>,greater<int> > add,del;\n\tvoid push(int x) { add.push(x); } void pop(int x) { del.push(x); }\n\tint size() { return add.size() - del.size(); }\n\tint top()\n\t{\n\t\twhile(add.size() && del.size() && add.top() == del.top()) add.pop(),del.pop();\n\t\treturn add.top();\n\t}\n}h;\nvoid add(data x)\n{\n\tauto a = s.upper_bound({x.pos,x.v});\n\tif(a != s.end()) h.push((*a).second - x.v);\n\tif(a != s.begin())\n\t{\n\t\tauto b = prev(a);\n\t\th.push(x.v - (*b).second);\n\t\tif(a != s.end()) h.pop((*a).second - (*b).second);\n\t}s.insert({x.pos,x.v});\n}\nvoid del(data x)\n{\n\ts.erase({x.pos,x.v});\n\tauto a = s.upper_bound({x.pos,x.v});\n\tif(a != s.end()) h.pop((*a).second - x.v);\n\tif(a != s.begin())\n\t{\n\t\tauto b = prev(a);\n\t\th.pop(x.v - (*b).second);\n\t\tif(a != s.end()) h.push((*a).second - (*b).second);\n\t}\n}\nbool check() { return !h.size() || h.top() >= 0; }\nint main()\n{\n\tn = read(),x = read();for(int i = 1;i <= n;i++) a[i].v = read(),a[i].pos = i;\n\tsort(a + 1,a + 1 + n,[&](data a,data b) { return a.v < b.v; });\n\tint l = 0,pos = 1;for(int i = 1;i <= n;i++) add(a[i]);\n\tfor(int r = 1;r <= x;r++)\n\t{\n\t\twhile(pos <= n && a[pos].v <= r) del(a[pos++]);\n\t\twhile(l < pos - 1 && check()) add(a[++l]);\n\t\tans += a[l].v;\n\t}fprint(ans);\n\treturn 0;\n}\n```",
        "postTime": 1593420378,
        "uid": 53994,
        "name": "81179332_",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1167E \u3010Range Deleting\u3011"
    },
    {
        "content": "## \u3010\u524d\u8a00\u3011\n\u5c31\u6211\u4e00\u4e2a\u83dc\u9e21\u662f\u7528 ST\u8868\u505a\u7684\u5417\u3002\u3002\u3002\u4f3c\u4e4e\u4e00\u4e2a\u4e2a\u8dd1\u7684\u90fd\u6bd4\u6211\u5feb\u597d\u51e0\u500d\u3002\u3002\u3002\n\n## \u3010\u601d\u8def\u3011\n\u9996\u5148\u5927\u80c6\u731c\u60f3\u8fd9\u9053\u9898\u548c\u9006\u5e8f\u5bf9\u6709\u5173\u3002\n\n\u5b9e\u9645\u4e0a\u5b83\u5c31\u662f\u95ee\u6211\u4eec\u6709\u591a\u5c11\u4e2a\u5e8f\u5217 **\u9006\u5e8f\u5bf9\u4e2a\u6570\u4e3a\u96f6** \u3002\n\n\u7136\u540e\u6211\u4eec\u770b\u4e00\u770b\u9006\u5e8f\u5bf9\u662f\u600e\u4e48\u4ea7\u751f\u7684\u3002\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u5982\u679c\u4f60 **\u9009\u4e86\u67d0\u4e00\u4e2a\u6570\u4e0d\u5220** \uff0c\u90a3\u4e48\u6240\u6709\u6bd4\u5b83\u5c0f\u7684\u6570\u4e5f\u4e00\u5b9a\u4e0d\u4f1a\u88ab\u5220\uff0c\u8fd9\u65f6\uff0c\u5982\u679c\u8fd9\u4e2a\u5927\u7684\u6570\u5c31\u4f1a\u548c\u6bd4\u5b83\u5c0f\u7684\u6570\u4ea7\u751f\u9006\u5e8f\u5bf9\uff0c\u5c31\u4f1a\u5bfc\u81f4\u4e0d\u7b26\u5408\u9898\u610f\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u8981\u4fdd\u8bc1\u4ece\u5c0f\u5230\u5927\u6bcf\u4e00\u4e2a **\u6570\u503c** \u7684 **\u6700\u5de6\u8fb9\u90a3\u4e00\u4e2a** \u6bd4\u6240\u6709\u6bd4\u5b83\u5c0f\u7684\u6570\u503c\u7684 **\u6700\u53f3\u8fb9\u90a3\u4e00\u4e2a** \u8fd8\u8981\u53f3\u8fb9\u3002\n\n\u4ece\u5927\u5230\u5c0f\u540c\u7406\u3002\n\n\u8fd9\u4e2a\u663e\u7136\u53ef\u4ee5 $O(1)$ \u67e5\u8be2\uff0c\uff08\u7136\u800c\u6211\u50bb\u4e4e\u4e4e\u7684\u5199\u4e86\u4e2a ST\u8868\uff09\u3002 \n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u8fd9\u4ec5\u4ec5\u53ea\u662f\u4e00\u4e2a\u5fc5\u8981\u6761\u4ef6\uff0c\u6bd4\u5982\u8fd9\u4e2a\uff1a\n\n```\n3 2 1\n```\n\n\u6309\u6211\u4eec\u7684\u7b97\u6cd5\u53bb\u627e\uff0c\u4ece\u5c0f\u5230\u5927\u548c\u4ece\u5927\u5230\u5c0f\u90fd\u4f1a\u8ba4\u4e3a $2$ \u662f\u7b2c\u4e00\u4e2a\u4e0d\u6ee1\u8db3\u7684\uff0c\u4f46\u540c\u65f6\u9009 $1,3$ \u4e0d\u5220\u53c8\u663e\u7136\u662f\u4e0d\u5408\u6cd5\u7684\u3002\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u8fd9\u4e1c\u897f\u6709\u5355\u8c03\u6027\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u5220 $[x,y]$ \u53ef\u884c\uff0c\u90a3\u4e48\u663e\u7136\u5220 $[x,y + 1]$ \u4e5f\u53ef\u884c\u3002\u5982\u679c\u5220 $[x,y]$ \u4e0d\u53ef\u884c\uff0c\u90a3\u4e48\u663e\u7136\u5220 $[x + 1, y]$ \u548c $[x, y + 1]$ \u4e5f\u4e0d\u53ef\u884c\u3002\n\n\u7136\u540e\u5c31\u53ef\u7528\u53cc\u6307\u9488 $O(n)$ \u8dd1\u51fa\u7ed3\u679c\u5e76\u7edf\u8ba1\u7b54\u6848\u3002\n\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\u3002\n\n## \u3010\u4ee3\u7801\u3011\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define getchar() printf(\"I am a cheater!I AK IOI!%c\", 10)\ntemplate <typename T>\ninline void read(T &x){\n    x = 0;int fu = 1;\n    char c = getchar();\n    while(c > 57 || c < 48){\n        if(c == 45) fu = -1;\n        c = getchar();\n    }\n    while(c <= 57 && c >= 48){\n        x = (x << 3) + (x << 1) + c - 48;\n        c = getchar();\n    }\n    x *= fu;\n}\ntemplate <typename T>\ninline void fprint(T x){\n    if(x < 0) putchar(45), x = -x;\n    if(x > 9) fprint(x / 10);\n    putchar(x % 10 + 48);\n}\ntemplate <typename T>\ninline void fprint(T x, char ch){\n    fprint(x);putchar(ch);\n}\ninline char next_char(){\n    char ch = getchar();\n    while(ch == 9 || ch == 10 || ch == 32) ch = getchar();\n    return ch;\n}\n\ntemplate <typename T>\ninline T mn(T x, T y) {return x < y ? x : y;}\ntemplate <typename T>\ninline T mx(T x, T y) {return x > y ? x : y;}\ntemplate <typename T>\ninline void chmin(T &x, T y) {(x > y) && (x = y);}\ntemplate <typename T>\ninline void chmax(T &x, T y) {(x < y) && (x = y);}\n\nint n, x;\nint l[1000005], r[1000005];\nint L[1000005][21], R[1000005][21];\nint Luogu[1000005];\nint RL, RR;\ninline int getL(int ll, int rr){\n    if(rr < ll) return 0x3f3f3f3f;\n    int num = Luogu[rr - ll + 1];\n    return mn(L[ll][num], L[rr - (1 << num) + 1][num]);\n}\n\ninline int getR(int ll, int rr){\n    if(rr < ll) return -0x3f3f3f3f;\n    int num = Luogu[rr - ll + 1];\n    return mx(R[ll][num], R[rr - (1 << num) + 1][num]);\n}\n\nint main(){\n    read(n);read(x);\n    for (register int i = 1;i <= n;i ++){\n        int a;read(a);\n        r[a] = i;\n        if(!l[a]) l[a] = i;\n    }\n    for (register int i = 1;i <= x;i ++){\n        if(!l[i]) l[i] = 0x3f3f3f3f;\n        if(!r[i]) r[i] = -0x3f3f3f3f;\n        L[i][0] = l[i];R[i][0] = r[i];\n    }\n    for (register int i = 1;i <= 20;i ++){\n        for (register int j = 1;j + (1 << i) - 1 <= x;j ++){\n            L[j][i] = mn(L[j][i - 1], L[j + (1 << (i - 1))][i - 1]);\n            R[j][i] = mx(R[j][i - 1], R[j + (1 << (i - 1))][i - 1]);\n        }\n    }\n    for (register int i = 2;i <= x;i ++) Luogu[i] = Luogu[i >> 1] + 1;\n    RL = 1;\n    while(RL < x && l[RL] > getR(1, RL - 1)) RL ++;\n    RR = x;\n    while(RR > 1 && r[RR] < getL(RR + 1, x)) RR --;\n    int it = RR + 1;\n    long long ans = 0;\n    for (register int i = 0;i < RL;i ++){\n        while(it <= x && (getL(it, x) <= getR(1, i) || it <= (i + 1))) it ++;\n        ans += x - it + 2;\n    }\n    fprint(ans, 10);\n    return 0;\n}\n```\n\n",
        "postTime": 1601637773,
        "uid": 66511,
        "name": "DPair",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1167E \u3010Range Deleting\u3011"
    },
    {
        "content": "\u53ef\u5220\u5806+\u7ebf\u6bb5\u6811+\u53cc\u6307\u9488\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u7531\u4e8e\u4ece\u4e00\u4e2a\u5355\u8c03\u5e8f\u5217\u91cc\u5220\u4e00\u4e9b\u6570\u4e4b\u540e\u8fd8\u662f\u5355\u8c03\u5e8f\u5217\uff0c\u6240\u4ee5\u5bf9\u4e8e\u4e00\u4e2a\u503c\u57df\u7684\u53f3\u7aef\u70b9$r$\uff0c\u5408\u6cd5\u7684$l$\u4e00\u5b9a\u662f\u603b\u4e4b\u524d\u67d0\u4e2a\u4f4d\u7f6e$l_0$\u5f00\u59cb\u518d\u5f80\u524d\uff0c$f(l,r)$\u5c31\u90fd\u5408\u6cd5\u4e86\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u662f\u8981\u5bf9\u6bcf\u4e2a\u53f3\u7aef\u70b9\u6c42$l_0$\u3002\n\n\u5f88\u663e\u7136\uff0c\u968f\u7740$r$\u7684\u9012\u589e\uff0c$l_0$\u4e5f\u662f\u5355\u8c03\u4e0d\u964d\u7684\uff0c\u8003\u8651\u53cc\u6307\u9488\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u662f\u8981\u652f\u6301\u5728\u5f53\u524d\u5e8f\u5217\u91cc\u63d2\u5165/\u5220\u9664\u4e00\u4e9b\u6570\uff0c\u5e76\u4e14\u5224\u65ad\u5b83\u662f\u5426\u4e3a\u5355\u8c03\u5e8f\u5217\u3002\n\n\u8003\u8651\u7ef4\u62a4\u76f8\u90bb\u4e24\u9879\u7684\u5dee\u5206\uff0c\u5982\u679c\u6709\u4e00\u4e2a\u5730\u65b9\u7684\u5dee\u5206$<0$\u90a3\u4e48\u663e\u7136\u4e0d\u662f\u5355\u8c03\u4e0d\u964d\u7684\u5e8f\u5217\uff0c\u8fd9\u4e2a\u7528\u53ef\u5220\u5806\u7ef4\u62a4\uff0c\u540c\u65f6\u7528\u4e2a\u7ebf\u6bb5\u6811\u6765\u67e5\u524d\u9a71\u540e\u7ee7\u3002\n\n\uff08\u4e0d\u8fc7\u8fd9\u91cc\u8fd8\u6709\u4e2a\u95ee\u9898\uff0c\u6211\u4eec\u5728\u79fb\u52a8$l_0$\u6307\u9488\u7684\u65f6\u5019\uff0c\u5148\u63d2\u5165\u4e00\u904d\uff0c\u5982\u679c\u53d1\u73b0\u4e0d\u5408\u6cd5\u5c31\u8981\u64a4\u56de\uff0c\u4f46\u662f\u8fd9\u6837\u64a4\u56de\u7684\u8bdd\u5e76\u6ca1\u6709\u590d\u6742\u5ea6\u7684\u4fdd\u8bc1\u2026\u2026\u53cd\u6b63\u6211\u8fd9\u4e48\u5199A\u4e86\u2026\u2026\u5927\u6982\u53ef\u4ee5\u7528\u522b\u7684\u53cc\u6307\u9488\u7684\u5b9e\u73b0\u65b9\u5f0f\u4fee\u9505\u5427\uff09\n\n\u4e0a\u4ee3\u7801~\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<queue>\n#include<vector>\n#include<algorithm>\n#define ll long long\n#define ls(_o) (_o<<1)\n#define rs(_o) ((_o<<1)|1)\n#define inf 1234567890\n#define up(_o) data[_o]=data[ls(_o)]+data[rs(_o)]\nusing namespace std;\nnamespace ywy{\n\tinline int get(){\n\t\tint n=0;char c;while((c=getchar())||23333){\n\t\t\tif(c>='0'&&c<='9')break;if(c=='-')goto s;\n\t\t}n=c-'0';while((c=getchar())||23333){\n\t\t\tif(c>='0'&&c<='9')n=n*10+c-'0';else return(n);\n\t\t}s:while((c=getchar())||23333){\n\t\t\tif(c>='0'&&c<='9')n=n*10-c+'0';else return(n);\n\t\t}\n\t}\n\ttypedef struct _h{\n\t\tpriority_queue<int> que,del;\n\t\tinline void wh(){while(!que.empty()&&!del.empty()&&del.top()==que.top())que.pop(),del.pop();}\n\t\tinline int top(){wh();if(que.empty())return(inf);return(-que.top());}\n\t\tinline void push(int x){que.push(-x);}\n\t\tinline void erase(int x){del.push(-x);}\n\t}heap;\n\tvector<int> vec[1000001];\n\tint ints[1000001],data[4000001],nd[1000001];\n\tvoid build(int l,int r,int tree){\n\t\tif(l==r){\n\t\t\tnd[l]=tree;data[tree]=1;return;\n\t\t}int mid=(l+r)>>1;\n\t\tbuild(l,mid,ls(tree));\n\t\tbuild(mid+1,r,rs(tree));up(tree);\n\t}\n\tinline void setpt(int pt,int x){\n\t\tdata[nd[pt]]=x;\n\t\tfor(register int i=nd[pt]>>1;i;i>>=1)up(i);\n\t}\n\tint getlst(int rl,int rr,int l,int r,int tree){\n\t\tif(rl>rr||!data[tree])return(0);\n\t\tif(l==r)return(l);\n\t\tint mid=(l+r)>>1;\n\t\tif(rl==l&&rr==r){\n\t\t\tif(data[rs(tree)])return(getlst(mid+1,r,mid+1,r,rs(tree)));\n\t\t\treturn(getlst(l,mid,l,mid,ls(tree)));\n\t\t}\n\t\tif(rl>mid)return(getlst(rl,rr,mid+1,r,rs(tree)));\n\t\tif(rr<=mid)return(getlst(rl,rr,l,mid,ls(tree)));\n\t\tint cjr=getlst(mid+1,rr,mid+1,r,rs(tree));\n\t\tif(cjr)return(cjr);\n\t\treturn(getlst(rl,mid,l,mid,ls(tree)));\n\t}\n\tint getfst(int rl,int rr,int l,int r,int tree){\n\t\tif(rl>rr||!data[tree])return(0);\n\t\tif(l==r)return(l);\n\t\tint mid=(l+r)>>1;\n\t\tif(rl==l&&rr==r){\n\t\t\tif(data[ls(tree)])return(getfst(l,mid,l,mid,ls(tree)));\n\t\t\treturn(getfst(mid+1,r,mid+1,r,rs(tree)));\n\t\t}\n\t\tif(rl>mid)return(getfst(rl,rr,mid+1,r,rs(tree)));\n\t\tif(rr<=mid)return(getfst(rl,rr,l,mid,ls(tree)));\n\t\tint cjr=getfst(rl,mid,l,mid,ls(tree));\n\t\tif(cjr)return(cjr);\n\t\treturn(getfst(mid+1,rr,mid+1,r,rs(tree)));\n\t}\n\tvoid ywymain(){\n\t\tint n=get(),x=get();\n\t\tfor(register int i=1;i<=n;i++)vec[ints[i]=get()].push_back(i);build(1,n,1);\n\t\theap global;\n\t\tfor(register int i=1;i<n;i++)global.push(ints[i+1]-ints[i]);\n\t\tll ans=0;int ptr=0;\n\t\tunsigned char bswitch=0;\n\t\tfor(register int i=1;i<=x;i++){\n\t\t\tfor(register int j=0;j<vec[i].size();j++){\n\t\t\t\tint pre=getlst(1,vec[i][j]-1,1,n,1),nxt=getfst(vec[i][j]+1,n,1,n,1);\n\t\t\t\tif(pre)global.erase(i-ints[pre]);\n\t\t\t\tif(nxt)global.erase(ints[nxt]-i);\n\t\t\t\tif(pre&&nxt)global.push(ints[nxt]-ints[pre]);\n\t\t\t\tsetpt(vec[i][j],0);\n\t\t\t}\n\t\t\tif(global.top()>=0)bswitch=1;\n\t\t\tif(bswitch){\n\t\t\t\tans++;while(ptr+1<i){\n\t\t\t\t\tfor(register int j=0;j<vec[ptr+1].size();j++){\n\t\t\t\t\t\tint pre=getlst(1,vec[ptr+1][j]-1,1,n,1),nxt=getfst(vec[ptr+1][j]+1,n,1,n,1);\n\t\t\t\t\t\tif(pre)global.push(ptr+1-ints[pre]);\n\t\t\t\t\t\tif(nxt)global.push(ints[nxt]-ptr-1);\n\t\t\t\t\t\tif(pre&&nxt)global.erase(ints[nxt]-ints[pre]);\n\t\t\t\t\t\tsetpt(vec[ptr+1][j],1);\n\t\t\t\t\t}\n\t\t\t\t\tif(global.top()>=0)ptr++;\n\t\t\t\t\telse{\n\t\t\t\t\t\tfor(register int j=(int)vec[ptr+1].size()-1;j>=0;j--){\n\t\t\t\t\t\t\tint pre=getlst(1,vec[ptr+1][j]-1,1,n,1),nxt=getfst(vec[ptr+1][j]+1,n,1,n,1);\n\t\t\t\t\t\t\tif(pre)global.erase(ptr+1-ints[pre]);\n\t\t\t\t\t\t\tif(nxt)global.erase(ints[nxt]-ptr-1);\n\t\t\t\t\t\t\tif(pre&&nxt)global.push(ints[nxt]-ints[pre]);\n\t\t\t\t\t\t\tsetpt(vec[ptr+1][j],0);\n\t\t\t\t\t\t}break;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tans+=ptr;\n\t\t\t}\n\t\t}\n\t\tcout<<ans<<endl;\n\t}\n}\nint main(){\n\tywy::ywymain();return(0);\n}\n```",
        "postTime": 1558179800,
        "uid": 125124,
        "name": "ywy_c_asm",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1167E \u3010Range Deleting\u3011"
    }
]
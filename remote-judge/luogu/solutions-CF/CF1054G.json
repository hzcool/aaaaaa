[
    {
        "content": "\u611f\u6027\u505a\u6cd5\uff0c\u4e0d\u4f1a\u8bc1\u660e\u3002\n\n\u6211\u4eec\u8bbe $a_{i,j}\\in\\{0,1\\}$\uff0c\u8868\u793a\u7b2c $i$ \u4e2a\u70b9\u662f\u5426\u5b58\u5728\u4e8e\u7b2c $j$ \u4e2a\u96c6\u5408\u4e2d\u3002\n\n\u7136\u540e\u6309\u7167 $a$ \u6784\u9020\u4e00\u4e2a\u65e0\u5411\u5b8c\u5168\u56fe\uff1a\u8fb9 $(x,y)$ \u7684\u8fb9\u6743\u4e3a $a_x$ \u4e0e $a_y$ \u4ea4\u7684\u5927\u5c0f\u3002\n\n\u610f\u601d\u662f\uff0c\u82e5\u9009\u62e9\u8fb9 $(x,y)$\uff0c\u8fd9\u6761\u8fb9\u53ef\u4ee5\u6ee1\u8db3\u5176\u8fb9\u6743\u4e2a\u96c6\u5408\u7684\u8981\u6c42\u3002\n\n\u7136\u540e\u5bf9\u8fd9\u4e2a\u56fe\u8dd1\u6700\u5927\u751f\u6210\u6811\u3002\u5f97\u5230\u7684\u5c31\u662f\u6700\u6709\u53ef\u80fd\u7684\u7b54\u6848\u3002\u56e0\u4e3a\u6211\u4eec\u5df2\u7ecf\u5c3d\u53ef\u80fd\u7684\u591a\u5730\u6ee1\u8db3\u4e86\u8981\u6c42\u3002\n\n\u7136\u540e check \u8fd9\u4e2a\u6811\u662f\u5426\u6ee1\u8db3\u6bcf\u4e00\u4e2a\u96c6\u5408\u7684\u8981\u6c42\u3002\u5177\u4f53\u65b9\u6cd5\u662f\uff1a\u82e5\u8be5\u70b9\u96c6\u7ec4\u6210\u4e86\u4e00\u4e2a\u8fde\u901a\u5757\uff0c\u5219\u8fd9\u4e2a\u70b9\u96c6\u5f62\u6210\u4e86\u4e00\u68f5\u6811\uff0c\u5145\u8981\u6761\u4ef6\u5c31\u662f\u8fb9\u6570\u7b49\u4e8e\u70b9\u6570 $-1$\u3002\n\n$O(\\dfrac {n^3} w)$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nbitset<2005> a[2005];\nchar s[2005];\nint f[2005];\nint find(int x)\n{\n\treturn f[x]==x?x:f[x]=find(f[x]);\n}\nstruct edge\n{\n\tint x,y,v;\n\tfriend bool operator <(const edge &x,const edge &y)\n\t{\n\t\treturn x.v>y.v;\n\t}\n}t[4000005],ans[2005];\nint main()\n{\n\tint T,n,m,i,j,cnt,fx,fy,res,ncnt;\n\tscanf(\"%d\",&T);\n\twhile(T--)\n\t{\n\t\tscanf(\"%d%d\",&n,&m);\n\t\tres=cnt=0;\n\t\tfor(i=1;i<=n;i++)\n\t\t\tf[i]=i,a[i].reset();\n\t\tfor(i=1;i<=m;i++)\n\t\t{\n\t\t\tscanf(\"%s\",s+1);\n\t\t\tfor(j=1;j<=n;j++)\n\t\t\t\ta[j][i]=s[j]-'0';\n\t\t}\n\t\tfor(i=1;i<=n;i++)\n\t\t\tfor(j=i+1;j<=n;j++)\n\t\t\t\tt[++cnt]=edge({i,j,int((a[i]&a[j]).count())});\n\t\tsort(t+1,t+1+cnt);\n\t\tfor(i=1;i<=cnt;i++)\n\t\t\tif((fx=find(t[i].x))!=(fy=find(t[i].y)))\n\t\t\t\tf[fx]=fy,ans[++res]=t[i];\n\t\tfor(i=1;i<=m;i++)\n\t\t{\n\t\t\tncnt=res=0;\n\t\t\tfor(j=1;j<=n;j++)\n\t\t\t\tncnt+=a[j][i];\n\t\t\tfor(j=1;j<n;j++)\n\t\t\t\tres+=a[ans[j].x][i]&&a[ans[j].y][i];\n\t\t\tif(res!=ncnt-1) \n\t\t\t{\n\t\t\t\tputs(\"NO\");\n\t\t\t\tgoto bre;\n\t\t\t}\n\t\t}\n\t\tputs(\"YES\");\n\t\tfor(i=1;i<n;i++)\n\t\t\tprintf(\"%d %d\\n\",ans[i].x,ans[i].y);\n\t\tbre:;\n\t}\n}\n```\n",
        "postTime": 1632922926,
        "uid": 203623,
        "name": "Ntokisq",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1054G New Road Network"
    }
]
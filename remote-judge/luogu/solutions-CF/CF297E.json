[
    {
        "content": "\u4e0d\u96be\u53d1\u73b0\uff0c\u5728\u4e00\u4e2a\u5706\u4e2d\u4efb\u610f\u4e09\u6761\u5f26\u7684\u4f4d\u7f6e\u5173\u7cfb\u53ea\u6709\u5982\u4e0b\u4e94\u79cd\u60c5\u51b5\uff1a\n\n![](https://s2.ax1x.com/2020/02/13/1qEbgH.png)\n\n~~\u56fe2\u7684\u4e0d\u662f\u5f26\u4f46\u662f\u610f\u601d\u662f\u4e00\u6837\u7684\u3002~~\n\n\u90a3\u4e48\u5982\u679c\u8981\u6ee1\u8db3\u4efb\u610f\u4e00\u6761\u5f26\u6240\u8fde\u63a5\u7684\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u70b9\u6570\u76f8\u540c\uff0c\u53ea\u6709\u56fe2\u548c\u56fe5\u6ee1\u8db3\u6761\u4ef6\uff0c\u6211\u4eec\u5c31\u662f\u8981\u8ba1\u7b97\u8fd9\u4e24\u79cd\u60c5\u51b5\u7684\u65b9\u6848\u6570\u3002\n\n\u76f4\u63a5\u8ba1\u7b97\u4e0d\u662f\u5f88\u597d\u8ba1\u7b97\uff0c\u6211\u4eec\u8003\u8651\u7528\u603b\u65b9\u6848\u6570\u51cf\u53bb\u4e0d\u5408\u6cd5\uff08\u5373\u56fe1\u30013\u30014\uff09\u7684\u65b9\u6848\u6570\u3002\n\n\u603b\u65b9\u6848\u6570\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u4ece$n$\u6761\u5f26\u4e2d\u9009\u51fa $3$ \u6761\u7684\u65b9\u6848\u6570 $C^3_n$\u3002\n\n\u5bf9\u4e8e\u56fe1\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u6bcf\u4e00\u6761\u5f26\uff0c\u628a\u5b83\u5f53\u505a\u4e2d\u95f4\u7684\u90a3\u4e00\u6761\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa\u8fd9\u6761\u5f26\u5de6\u3001\u53f3\u5206\u522b\u6709\u591a\u5c11\u6761\u4e0e\u5b83\u4e0d\u76f8\u4ea4\u7684\u5f26\uff0c\u8bb0\u4f5c $l[i]$ \u548c $r[i]$\uff0c\u90a3\u4e48\u8fd9\u4e00\u6761\u5f26\u5728\u4e2d\u95f4\u7684\u65b9\u6848\u6570\u5c31\u662f $l[i]\\times r[i]$\u3002\u6240\u4ee5\u56fe1\u7684\u603b\u65b9\u6848\u6570\u5c31\u662f $\\sum^{n}_{i=1}l[i]\\times r[i]$\u3002\n\n\u5bf9\u4e8e\u56fe3\u548c\u56fe4\uff0c\u6211\u4eec\u628a\u5b83\u4eec\u653e\u5728\u4e00\u8d77\u8ba1\u7b97\u3002\u5bb9\u6613\u53d1\u73b0\u8fd9\u4e24\u5f20\u56fe\u7684\u5171\u540c\u70b9\u662f\u201c\u4e09\u6761\u5f26\u4e2d\u6709\u4e24\u6761\u6ee1\u8db3\u53e6\u5916\u7684\u4e24\u6761\u5f26\u4e00\u6761\u4e0e\u5176\u76f8\u4ea4\uff0c\u4e00\u6761\u4e0e\u5176\u76f8\u79bb\u201d\u3002\u4ed4\u7ec6\u770b\u4e00\u4e0b\u8fd9\u53e5\u8bdd\uff0c\u5e94\u8be5\u80fd\u770b\u61c2\u7684 $:)$ \u3002\n\n\u6240\u4ee5\u6211\u4eec\u4f9d\u7136\u679a\u4e3e\u6bcf\u4e00\u6761\u5f26\uff0c\u5bf9\u4e8e\u4efb\u610f\u4e00\u6761\u5f26\uff0c\u5b83\u7684\u65b9\u6848\u6570\u5c31\u662f\u201c\u4e0e\u5b83\u76f8\u4ea4\u7684\u5f26\u7684\u4e2a\u6570\u201d$\\times$ \u201c\u4e0e\u5b83\u4e0d\u76f8\u4ea4\u7684\u5f26\u7684\u4e2a\u6570\u201d\u3002\u800c\u6211\u4eec\u77e5\u9053\u4e0e\u5b83\u4e0d\u76f8\u4ea4\u7684\u5f26\u7684\u4e2a\u6570\u662f $l[i]+r[i]$\uff0c\u90a3\u4e48\u4e0e\u5b83\u76f8\u4ea4\u7684\u5f26\u7684\u4e2a\u6570\u5c31\u662f $n-l[i]-r[i]-1$\u4e86\u3002\n\n\u8003\u8651\u5230\u6bcf\u5f20\u56fe\u6709\u4e24\u6761\u5f26\u6ee1\u8db3\u4e0a\u8ff0\u201c\u5171\u540c\u70b9\u201d\uff0c\u6240\u4ee5\u8fd9\u6837\u6bcf\u5f20\u56fe\u90fd\u4f1a\u88ab\u7b97\u4e24\u904d\uff0c\u6700\u7ec8\u9664\u4ee5 $2$ \u5373\u4e3a\u56fe4\u548c\u56fe5\u7684\u7b54\u6848\u3002\u4e5f\u5c31\u662f $\\frac{\\sum^{n}_{i=1}(l[i]+r[i])(n-l[i]-r[i]-1)}{2}$\u3002\n\n\u8ba1\u7b97\u7b54\u6848\u90e8\u5206\u6211\u4eec\u5df2\u7ecf\u5728 $O(n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5185\u5b8c\u6210\u4e86\uff0c\u73b0\u5728\u5982\u679c\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97\u51fa $l[i],r[i]$\uff0c\u8fd9\u9053\u9898\u5c31\u89e3\u51b3\u4e86\u3002\n\n\u4f8b\u5982\u4e0b\u56fe\uff0c\u6211\u4eec\u9700\u8981\u6c42\u84dd\u8272\u5f26\u7684\u5de6\u53f3\u5206\u522b\u4e0e\u5b83\u4e0d\u76f8\u4ea4\u7684\u5f26\u7684\u6761\u6570\uff0c\u9ed1\u8272\u5f26\u90fd\u4e0d\u4e0e\u5b83\u76f8\u4ea4\uff0c\u5176\u4e2d\u4ec5\u6709\u5f26 $4-5$ \u5728\u5b83\u53f3\u8fb9\u3002\n\n![](https://s2.ax1x.com/2020/02/13/1qupcD.png)\n\n\u89c2\u5bdf\u5728\u84dd\u8272\u5f26\u5de6\u8fb9\u7684\u5f26\uff0c\u8bbe\u84dd\u8272\u5f26\u7684\u4e24\u4e2a\u7aef\u70b9\u4e3a $x,y$\uff0c\u5176\u4ed6\u5f26\u7684\u7aef\u70b9\u4e3a $x',y'$\uff0c\uff08$x<y,x'<y'$\uff09\u53d1\u73b0\u9700\u8981\u6ee1\u8db3\u4e00\u4e0b\u4e09\u4e2a\u6761\u4ef6\u4e4b\u4e00\uff1a\n\n1. $x'<x$ \u4e14 $y'<x$\n2. $x'<x$ \u4e14 $y'>y$\n3. $x'>y$ \u4e14 $y'>y$\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u4e0e\u4e8c\u7ef4\u504f\u5e8f\u5341\u5206\u50cf\uff0c\u7528\u4e8c\u7ef4\u504f\u5e8f\u5373\u53ef\u89e3\u51b3\u3002\n\n\u540c\u7406\uff0c\u53f3\u8fb9\u7684\u5f26\u53ea\u9700\u8981\u6ee1\u8db3\u4e00\u4e2a\u6761\u4ef6\uff1a$x'>x$ \u4e14 $y'<y$ \uff0c\u540c\u6837\u53ef\u4ee5\u7528\u4e8c\u7ef4\u504f\u5e8f\u89e3\u51b3\u3002\n\n\u81f3\u6b64\uff0c\u8fd9\u9053\u9898\u7684\u4e24\u4e2a\u90e8\u5206\u90fd\u5df2\u7ecf\u7ed3\u675f\u3002\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\log n)$\u3002\n\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\ntypedef long long ll;\n\nconst int N=300010;\nint n,l[N],r[N];\nll ans1,ans2;\n\nstruct node\n{\n    int x,y,id;\n}a[N];\n\nstruct BIT\n{\n    int c[N];\n    \n    void add(int x,int val)\n    {\n        for (;x<=n*2;x+=x&-x)\n            c[x]+=val;\n    }\n    \n    int ask(int x)\n    {\n        int sum=0;\n        for (;x;x-=x&-x)\n            sum+=c[x];\n        return sum;\n    }\n}bit;\n\nbool cmp1(node x,node y)\n{\n    return x.x<y.x;\n}\n\nbool cmp2(node x,node y)\n{\n    return x.y>y.y;\n}\n\nint main()\n{\n    scanf(\"%d\",&n);\n    for (int i=1;i<=n;i++)\n    {\n        scanf(\"%d%d\",&a[i].x,&a[i].y);\n        if (a[i].x>a[i].y) swap(a[i].x,a[i].y);\n        a[i].id=i;\n    }\n    sort(a+1,a+1+n,cmp1);\n    for (int i=1;i<=n;i++)  //\u4e8c\u7ef4\u504f\u5e8f\u6c42\u6bcf\u4e00\u6761\u5f26\u7684 l[i] \u548c r[i]\n    {\n        l[a[i].id]+=bit.ask(a[i].x)+bit.ask(n*2)-bit.ask(a[i].y);\n        bit.add(a[i].y,1);\n    }\n    memset(bit.c,0,sizeof(bit.c));\n    for (int i=n;i>=1;i--)\n    {\n        r[a[i].id]+=bit.ask(a[i].y)-bit.ask(a[i].x);\n        bit.add(a[i].y,1);\n    }\n    memset(bit.c,0,sizeof(bit.c));\n    sort(a+1,a+1+n,cmp2);\n    for (int i=1;i<=n;i++)\n    {\n        l[a[i].id]+=bit.ask(n*2)-bit.ask(a[i].y);\n        bit.add(a[i].x,1);\n    }\n    ans1=1LL*n*(n-1)*(n-2)/6;  //C(n,3)\n    for (int i=1;i<=n;i++)\n    {\n        ans1-=1LL*l[i]*r[i];\n        ans2+=1LL*(l[i]+r[i])*(n-l[i]-r[i]-1);\n    }\n    printf(\"%I64d\",ans1-ans2/2);\n    return 0;\n}\n```",
        "postTime": 1581562501,
        "uid": 53962,
        "name": "stoorz",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF297E \u3010Mystic Carvings\u3011"
    }
]
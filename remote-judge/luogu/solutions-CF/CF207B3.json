[
    {
        "content": "# \u601d\u8def\n\u672c\u9898\u89e3\u7b2c\u4e00\u90e8\u5206\u548c[\u5f31\u5316\u7248](https://www.luogu.com.cn/problem/CF207B2)\u4e00\u81f4\u3002\u8bf7\u5148\u9605\u8bfb[\u5f31\u5316\u7248\u9898\u89e3](https://www.luogu.com.cn/blog/xiaohao-aibiancheng/solution-cf207b2)\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a $x$ \u627e $y$\uff0c\u76ee\u524d\u7684\u65b9\u6cd5\u8fd8\u662f\u4e00\u4e2a\u4e00\u4e2a\u627e\u3002\u4f46\u662f\u8fd9\u6837\u592a\u6162\u4e86\uff0c\u53ef\u4ee5\u901a\u8fc7**\u500d\u589e**\u6765\u4f18\u5316\uff1a\n\n\u5bf9\u4e8e\u6bcf\u4e2a $x$\uff0c\u6c42\u51fa $x$ \u7684\u7b2c $2^0,2^1\\dots2^{\\log n}$ \u4e2a $y$\u3002\u8fd9\u6837\u9884\u5904\u7406\u590d\u6742\u5ea6 $O(n\\log n)$\uff0c\u6bcf\u6b21\u67e5\u8be2\u590d\u6742\u5ea6 $O(\\log n)$\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n# AC code\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define MAXN 1000000\n \nint Log[MAXN];\nint st[MAXN][30];\nint a[MAXN];\nint fa[MAXN][30];\n \n//ST \u8868\nvoid init(int n)\n{\n\tLog[0]=Log[1]=0;\n\tfor(int i=2;i<=n;i++)Log[i]=Log[i/2]+1;\n}\n \nvoid Build(int n)\n{\n\tfor(int i=0;i<=n;i++)st[i][0]=i;\n\tfor(int j=1;j<=Log[n]+1;j++)\n\t\tfor(int i=0;i<=n;i++) \n\t\t\tst[i][j]=((a[st[i][j-1]]<=a[st[i+(1<<(j-1))][j-1]])?st[i][j-1]:st[i+(1<<(j-1))][j-1]);\n}\n \ninline int Query(int l,int r)\n{\n\tint t=Log[r-l+1];\n\treturn (a[st[l][t]]<=a[st[r-(1<<t)+1][t]])?st[l][t]:st[r-(1<<t)+1][t];\n}\n\t\nint main()\n{\n\tint n;\n\tcin>>n;\n\tinit(2*n);\n\tfor(int i=1;i<=n;i++)cin>>a[i],a[i+n]=a[i];\n\tfor(int i=1;i<=n+n;i++)a[i]=max(i-a[i],1);\n\tBuild(2*n);\n\t//\u500d\u589e\n\tfor(int i=1;i<=n+n;i++)fa[i][0]=Query(a[i],i);\n\tfor(int j=1;j<30;j++)\n        for(int i=1;i<=n+n;i++)\n            fa[i][j]=fa[fa[i][j-1]][j-1];\n\tlong long ans=0;\n\t\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tlong long cnt=2;\n\t\tint now=i+n-1;\n\t\t//\u7279\u5224\n\t\tif(a[now]<=i)\n\t\t{\n \t\t\tans++;\n\t\t\tcontinue;\n\t\t}\n\t\t//\u67e5\u8be2\n\t\tfor(int j=29;j>=0;j--)\n\t\t{\n \t\t\tif(a[fa[now][j]]>i)cnt+=(1<<j),now=fa[now][j];\n \t\t}\n\t\tans+=cnt;\n\t}\n\tcout<<ans;\n\treturn 0;\n}\n```",
        "postTime": 1679233078,
        "uid": 718740,
        "name": "xiaohaoaibiancheng66",
        "ccfLevel": 5,
        "title": "CF207B3 Military Trainings \u9898\u89e3"
    }
]
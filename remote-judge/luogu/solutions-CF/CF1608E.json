[
    {
        "content": "\u60ca\u614c\uff0c\u5c3d\u7136\u6709\u8fd9\u79cd\u5927\u5206\u7c7b\u8ba8\u8bba\u578b\u9898\u76ee\u3002\n\n- \u9898\u610f\n\n\u7ed9\u5b9a $n$ \u4e2a\u70b9\uff0c\u6bcf\u4e2a\u70b9\u6709\u5bf9\u5e94\u7684\u989c\u8272 $c_i(1 \\le c_i \\le 3)$\uff0c\u548c\u5750\u6807 $(x_i,y_i)$\uff0c\u6bcf\u79cd\u989c\u8272\u6070 $\\frac{n}{3}$ \u4e2a\u3002\n\n\u627e\u4e00\u4e2a\u6700\u5927\u503c $k$ \u4f7f\u5f97\u4ece\u4e09\u79cd\u989c\u8272\u4e2d\u5404\u9009 $\\frac{k}{3}$ \u4e2a\uff0c\u53ef\u4ee5\u7528\u4e09\u4e2a\u4ea4\u96c6\u4e3a $0$ \u7684\u77e9\u5f62\u5b8c\u5168\u8986\u76d6\u6bcf\u4e2a\u989c\u8272\u7684 $\\frac{k}{3}$ \u4e2a\u70b9\u3002\n\n- \u5206\u6790\n\n\u65e2\u7136\u548c\u56fe\u6709\u5173\u7cfb\uff0c\u90a3\u5728\u6ca1\u6709\u601d\u8def\u7684\u65f6\u5019\u5c31\u4e0d\u59a8\u753b\u4e2a\u56fe\uff0c\u4e8e\u662f\uff0c\u4f60\u53d1\u73b0\u5176\u5b9e\u53ea\u6709\u516d\u79cd\u4e0d\u540c\u7684\u53ef\u80fd\u7684\u56fe\uff0c\u5982\u4e0b\uff1a\n\n\u7b2c\u4e00\u79cd\u60c5\u51b5\uff0c\u4e09\u4e2a\u5e76\u6392\uff0c\u5206\u6a2a\u5411\u548c\u7ad6\u5411\uff1a\n\n![CF1608E_sub1.png](https://s2.loli.net/2022/07/24/FazNRnlgKYXLBHT.png)\n\n![CF1608E_sub2.png](https://s2.loli.net/2022/07/24/jCvnrbf7YoxQh3a.png)\n\n\u7b2c\u4e8c\u79cd\u60c5\u51b5\u4e00\u4e2a\u7ad6\u5411\u4e24\u4e2a\u6a2a\u5411\uff0c\u53ef\u4ee5\u7ffb\u8f6c\uff1a\n\n![CF1608E_sub3.png](https://s2.loli.net/2022/07/24/gRC4MFsNzru5SBX.png)\n\n![CF1608E_sub4.png](https://s2.loli.net/2022/07/24/lMx4QOWuJtZFofS.png)\n\n\u7b2c\u4e09\u79cd\u60c5\u51b5\uff0c\u5982\u679c\u5c06\u7b2c\u4e8c\u79cd\u60c5\u51b5\u65cb\u8f6c\u4e5d\u5341\u5ea6\uff0c\u53ef\u4ee5\u5f97\u5230\u4e0b\u9762\u4e24\u5e45\u56fe\uff1a\n\n![CF1608E_sub5.png](https://s2.loli.net/2022/07/24/sU2I69KHrWLcSDA.png)\n\n![CF1608E_sub6.png](https://s2.loli.net/2022/07/24/o9CwQgGJbxjHpeX.png)\n\n\u90a3\u60f3\u5230\u8fd9\u91cc\uff0c\u5c31\u57fa\u672c\u505a\u5b8c\u4e86\uff0c\u6211\u4eec\u53ef\u4ee5\u4e8c\u5206\u7b54\u6848\uff0c\u679a\u4e3e $k$ \u7136\u540e\u8003\u8651\uff0c\u5206\u8fd9\u516d\u7c7b\u8ba8\u8bba\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e00\u79cd\u60c5\u51b5\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u6240\u6709\u70b9\u6309 $x_i$ \u548c $y_i$ \u5206\u522b\u6392\u5e8f\uff0c\u7136\u540e\u5bf9\u4e8e\u7b2c\u4e00\u79cd\u60c5\u51b5\uff0c\u987a\u5e8f\u53d6\uff1b\u7b2c\u4e8c\u79cd\u60c5\u51b5\u5148\u53d6 $x_i$ \u524d $k$ \u5927\u7684\u70b9\uff0c\u5728\u987a\u5e8f\u53bb\u5269\u4f59\u8fde\u4e2a\u77e9\u5f62\uff0c\u6ce8\u610f\u6ee1\u8db3\u8fd9\u4e24\u4e2a\u77e9\u5f62\u7684 $x_i$ \u8981\u5927\u4e8e\u7b2c\u4e00\u4e2a\u77e9\u5f62\uff0c\u5176\u4f59\u540c\u7406\u3002\n\n- \u5c0f\u7ec6\u8282\n\n\u53ef\u80fd\u4f1a\u51fa\u73b0 $x_i$ \u6216 $y_i$ \u5927\u5c0f\u76f8\u540c\u7684\u4e0d\u540c\u989c\u8272\u7684\u70b9\uff0c\u8981\u8df3\u8fc7\u3002\n\n- \u590d\u6742\u5ea6\n\n\u4e09\u79cd\u989c\u8272\u6392\u5217\uff0c\u516d\u79cd\u4e0d\u540c\u60c5\u51b5\uff0c\u590d\u6742\u5ea6 $O(36n\\log{n})$\u3002\n\n\u5b9e\u9645\u4e0a\u8dd1\u5f97\u8fd8\u633a\u5feb\u7684\uff08\n\n![CF1608E_status.png](https://s2.loli.net/2022/07/24/VjNIMQ165TwmARG.png)\n\n- code\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nnamespace q_wr {\n\tinline int read() {\n\t\tchar c = getchar();\n\t\tint x = 0, f = 1;\n\t\twhile (c < '0' || c > '9') {\n\t\t\tif (c == '-') f = -1;\n\t\t\tc = getchar();\n\t\t}\n\t\twhile (c >= '0' && c <= '9') {\n\t\t\tx = (x << 1) + (x << 3) + c - '0';\n\t\t\tc = getchar();\n\t\t}\n\t\treturn x * f;\n\t}\n\tinline void write(int x) {\n\t\tif (x < 0) {\n\t\t\tx = ~(x - 1);\n\t\t\tputchar('-');\n\t\t}\n\t\tif (x > 9)\n\t\t\twrite(x / 10);\n\t\tputchar(x % 10 + '0');\n\t}\n}\n\nusing namespace q_wr;\n\nconst int maxn = 1e5 + 500;\n\nstruct pnt { int x, y, id; } p[maxn], q[maxn];\n\nint n;\n\nbool sub1 (int mid) {\n\tfor (int s = 1; s <= 3; s++) {\n\t\tfor (int t = 1; t <= 3; t++) {\n\t\t\tif (s == t) continue;\n\t\t\tfor (int r = 1; r <= 3; r++) {\n\t\t\t\tif (s == r || t == r) continue;\n\t\t\t\tint ptr = 1, cnt;\n\t\t\t\tfor (cnt = 0; ptr <= n && cnt < mid; ptr++) if (p[ptr].id == s) cnt++;\n\t\t\t\tif (cnt < mid) continue;\n\t\t\t\tfor (; ptr <= n && p[ptr].x == p[ptr - 1].x; ptr++);\n\t\t\t\tfor (cnt = 0; ptr <= n && cnt < mid; ptr++) if (p[ptr].id == t) cnt++;\n\t\t\t\tif (cnt < mid) continue;\n\t\t\t\tfor (; ptr <= n && p[ptr].x == p[ptr - 1].x; ptr++);\n\t\t\t\tfor (cnt = 0; ptr <= n && cnt < mid; ptr++) if (p[ptr].id == r) cnt++;\n\t\t\t\tif (cnt < mid) continue;\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n\nbool sub2 (int mid) {\n\tfor (int s = 1; s <= 3; s++) {\n\t\tfor (int t = 1; t <= 3; t++) {\n\t\t\tif (s == t) continue;\n\t\t\tfor (int r = 1; r <= 3; r++) {\n\t\t\t\tif (s == r || t == r) continue;\n\t\t\t\tint ptr = 1, cnt;\n\t\t\t\tfor (cnt = 0; ptr <= n && cnt < mid; ptr++) if (q[ptr].id == s) cnt++;\n\t\t\t\tif (cnt < mid) continue;\n\t\t\t\tfor (; ptr <= n && q[ptr].y == q[ptr - 1].y; ptr++);\n\t\t\t\tfor (cnt = 0; ptr <= n && cnt < mid; ptr++) if (q[ptr].id == t) cnt++;\n\t\t\t\tif (cnt < mid) continue;\n\t\t\t\tfor (; ptr <= n && q[ptr].y == q[ptr - 1].y; ptr++);\n\t\t\t\tfor (cnt = 0; ptr <= n && cnt < mid; ptr++) if (q[ptr].id == r) cnt++;\n\t\t\t\tif (cnt < mid) continue;\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n\nbool sub3 (int mid) {\n\tfor (int s = 1; s <= 3; s++) {\n\t\tfor (int t = 1; t <= 3; t++) {\n\t\t\tif (s == t) continue;\n\t\t\tfor (int r = 1; r <= 3; r++) {\n\t\t\t\tif (s == r || t == r) continue;\n\t\t\t\tint ptr = 1, cnt, pt;\n\t\t\t\tfor (cnt = 0; ptr <= n && cnt < mid; ptr++) if (p[ptr].id == s) cnt++;\n\t\t\t\tif (cnt < mid) continue;\n\t\t\t\tpt = 1, ptr--;\n\t\t\t\tfor (cnt = 0; pt <= n && cnt < mid; pt++) if (q[pt].id == t && q[pt].x > p[ptr].x) cnt++;\n\t\t\t\tif (cnt < mid) continue;\n\t\t\t\tfor (; pt <= n && q[pt].y == q[pt - 1].y; pt++);\n\t\t\t\tfor (cnt = 0; pt <= n && cnt < mid; pt++) if (q[pt].id == r && q[pt].x > p[ptr].x) cnt++;\n\t\t\t\tif (cnt < mid) continue;\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n\nbool sub4 (int mid) {\n\tfor (int s = 1; s <= 3; s++) {\n\t\tfor (int t = 1; t <= 3; t++) {\n\t\t\tif (s == t) continue;\n\t\t\tfor (int r = 1; r <= 3; r++) {\n\t\t\t\tif (s == r || t == r) continue;\n\t\t\t\tint ptr = n, cnt, pt;\n\t\t\t\tfor (cnt = 0; ptr && cnt < mid; ptr--) if (p[ptr].id == s) cnt++;\n\t\t\t\tif (cnt < mid) continue;\n\t\t\t\tptr++, pt = 1;\n\t\t\t\tfor (cnt = 0; pt <= n && cnt < mid; pt++) if (q[pt].id == t && q[pt].x < p[ptr].x) cnt++;\n\t\t\t\tif (cnt < mid) continue;\n\t\t\t\tfor (; pt <= n && q[pt].y == q[pt - 1].y; pt++);\n\t\t\t\tfor (cnt = 0; pt <= n && cnt < mid; pt++) if (q[pt].id == r && q[pt].x < p[ptr].x) cnt++;\n\t\t\t\tif (cnt < mid) continue;\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n\nbool sub5 (int mid) {\n\tfor (int s = 1; s <= 3; s++) {\n\t\tfor (int t = 1; t <= 3; t++) {\n\t\t\tif (s == t) continue;\n\t\t\tfor (int r = 1; r <= 3; r++) {\n\t\t\t\tif (r == s || r == t) continue;\n\t\t\t\tint ptr = 1, pt, cnt;\n\t\t\t\tfor (cnt = 0; ptr <= n && cnt < mid; ptr++) if (q[ptr].id == s) cnt++;\n\t\t\t\tif (cnt < mid) continue;\n\t\t\t\tptr--, pt = 1;\n\t\t\t\tfor (cnt = 0; pt <= n && cnt < mid; pt++) if (p[pt].id == t && p[pt].y > q[ptr].y) cnt++;\n\t\t\t\tif (cnt < mid) continue;\n\t\t\t\tfor (; pt <= n && p[pt].x == p[pt - 1].x; pt++);\n\t\t\t\tfor (cnt = 0; pt <= n && cnt < mid; pt++) if (p[pt].id == r && p[pt].y > q[ptr].y) cnt++;\n\t\t\t\tif (cnt < mid) continue;\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n\nbool sub6 (int mid) {\n\tfor (int s = 1; s <= 3; s++) {\n\t\tfor (int t = 1; t <= 3; t++) {\n\t\t\tif (s == t) continue;\n\t\t\tfor (int r = 1; r <= 3; r++) {\n\t\t\t\tif (s == r || t == r) continue;\n\t\t\t\tint ptr = n, pt, cnt;\n\t\t\t\tfor (cnt = 0; ptr && cnt < mid; ptr--) if (q[ptr].id == s) cnt++;\n\t\t\t\tif (cnt < mid) continue;\n\t\t\t\tptr++, pt = 1;\n\t\t\t\tfor (cnt = 0; pt <= n && cnt < mid; pt++) if (p[pt].id == t && p[pt].y < q[ptr].y) cnt++;\n\t\t\t\tif (cnt < mid) continue;\n\t\t\t\tfor (; pt <= n && p[pt].x == p[pt - 1].x; pt++);\n\t\t\t\tfor (cnt = 0; pt <= n && cnt < mid; pt++) if (p[pt].id == r && p[pt].y < q[ptr].y) cnt++;\n\t\t\t\tif (cnt < mid) continue;\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t}\n\t}\n\treturn 0;\n}\n\nbool check (int mid) {\n\tif (sub1(mid)) return 1;\n\tif (sub2(mid)) return 1;\n\tif (sub3(mid)) return 1;\n\tif (sub4(mid)) return 1;\n\tif (sub5(mid)) return 1;\n\tif (sub6(mid)) return 1;\n\treturn 0;\n}\n\nint main () {\n\tn = read();\n\tfor (int i = 1; i <= n; i++) p[i] = q[i] = {read(), read(), read()};\n\tsort(p + 1, p + n + 1, [] (pnt u, pnt v) { return u.x < v.x; });\n\tsort(q + 1, q + n + 1, [] (pnt u, pnt v) { return u.y < v.y; });\n\tint l = 1, r = n / 3, mid, ans;\n\twhile (l <= r) {\n\t\tmid = (l + r) >> 1;\n\t\tif (check(mid)) l = mid + 1, ans = mid;\n\t\telse r = mid - 1;\n\t}\n\twrite(ans * 3);\n}\n```",
        "postTime": 1658660666,
        "uid": 317495,
        "name": "JWRuixi",
        "ccfLevel": 7,
        "title": "Solution CF1608E"
    },
    {
        "content": "# CF1608E\n\n#### \u9898\u610f\u7b80\u8ff0\n- \u7ed9\u5b9a\u5e73\u9762\u4e0a\u7684 $n$ \u4e2a\u70b9 $(x_i,y_i)$\uff0c\u6bcf\u4e2a\u70b9\u6709\u4e00\u4e2a\u989c\u8272 $c_i\\in\\{1,2,3\\}$\u3002\u6bcf\u79cd\u989c\u8272\u7684\u70b9\u6070\u597d\u5404\u6709 $\\frac{n}{3}$ \u4e2a\u3002\n- \u627e\u5230\u6700\u5927\u7684 $k$\uff0c\u4f7f\u5f97\u6070\u597d\u80fd\u5728\u6bcf\u4e2a\u989c\u8272\u4e2d\u9009\u51fa $\\frac{k}{3}$ \u4e2a\u70b9\uff0c\u53ef\u4ee5\u7528\u4e09\u4e2a\u4ea4\u96c6\u4e3a $0$ \u7684\u77e9\u5f62\u5b8c\u5168\u8986\u76d6\u6bcf\u4e2a\u989c\u8272\u7684 $\\frac{k}{3}$ \u4e2a\u70b9\u3002\n- $1 \\leq n \\leq 10^5,|x_i|,|y_i| \\leq 10^9,c_i \\in\\{1,2,3\\},3 | n$\u3002\n\n#### \u9898\u76ee\u5206\u6790\n\u663e\u7136\u53ef\u4ee5\u4e8c\u5206\u7b54\u6848\uff1a\u82e5 $k_1$ \u6210\u7acb\uff0c\u5219 $k<k_1$ \u5fc5\u5b9a\u4e5f\u6210\u7acb\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u600e\u4e48\u68c0\u67e5 $k$ \u7684\u6b63\u786e\u6027\u3002\n\n\u4e0d\u96be\u53d1\u73b0\u8fd9\u4e09\u4e2a\u77e9\u5f62\u53ea\u53ef\u80fd\u6709 $6$ \u79cd\u60c5\u51b5\uff1a\n1. \u4ece\u5de6\u5f80\u53f3\u4f9d\u6b21\u6446\u653e\u3002\n1. \u4ece\u4e0a\u5f80\u4e0b\u4f9d\u6b21\u6446\u653e\u3002\n1. \u6700\u4e0a\u65b9\u6709\u4e00\u4e2a\uff0c\u4e0b\u65b9\u5de6\u53f3\u5404\u4e00\u4e2a\u3002\n1. \u6700\u4e0b\u65b9\u6709\u4e00\u4e2a\uff0c\u4e0a\u65b9\u5de6\u53f3\u5404\u4e00\u4e2a\u3002\n1. \u6700\u5de6\u65b9\u6709\u4e00\u4e2a\uff0c\u53f3\u65b9\u4e0a\u4e0b\u5404\u4e00\u4e2a\u3002\n1. \u6700\u53f3\u65b9\u6709\u4e00\u4e2a\uff0c\u5de6\u65b9\u4e0a\u4e0b\u5404\u4e00\u4e2a\u3002\n\n\u4f9d\u6b21\u68c0\u67e5\u4e0a\u8ff0 $6$ \u79cd\u60c5\u51b5\u5373\u53ef\u3002\u6ce8\u610f\uff0c\u5e94\u8be5\u679a\u4e3e\u989c\u8272\u7684\u6392\u5217\u6765\u5c06\u989c\u8272\u4e92\u6362\uff0c\u5c1d\u8bd5\u6bcf\u79cd\u53ef\u80fd\u7684\u60c5\u51b5\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u4e0a\uff0c\u524d\u4e24\u79cd\u60c5\u51b5\u5148\u5c1d\u8bd5\u5c06\u4e24\u79cd\u989c\u8272\u653e\u5728\u6700\u5de6\u3001\u6700\u53f3\u6216\u6700\u4e0a\u3001\u6700\u4e0b\u65b9\uff0c\u518d\u5c1d\u8bd5\u5c06\u5269\u4e0b\u7684\u4e00\u79cd\u989c\u8272\u653e\u5230\u4e2d\u95f4\u5373\u53ef\u3002\n\n\u5bf9\u4e8e\u540e\u56db\u79cd\u60c5\u51b5\uff0c\u53ef\u4ee5\u5148\u627e\u5230\u90a3\u4e2a\u5355\u4e2a\u7684\u989c\u8272\u6240\u5904\u7684\u6700\u504f\u4e0a\u3001\u4e0b\u3001\u5de6\u3001\u53f3\u7684\u4f4d\u7f6e\uff0c\u518d\u5c1d\u8bd5\u653e\u53e6\u5916\u4e24\u79cd\u989c\u8272\u3002\n\n\u7b97\u4e0a\u4f9d\u6b21\u68c0\u67e5\u548c\u679a\u4e3e\u6392\u5217\uff0c\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(36n\\operatorname{log}n)$\uff0c\u5b9e\u73b0\u65f6\u5e94\u5f53\u6ce8\u610f\u7ec6\u8282\u548c\u8fb9\u754c\u60c5\u51b5\u7684\u5904\u7406\u3002\n\nCode\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconstexpr int N=1e5+10;\nint n,cnt[3];\nstruct node\n{\n\tint x,y;\n}p[3][N],px[3][N],py[3][N],cur[3][N];\ninline bool cmpx(node a,node b){return a.x<b.x;}\ninline bool cmpy(node a,node b){return a.y<b.y;}\ninline bool check_left_to_right(int k,int per[])\n{\n\tfor(int i=0;i<3;i++)memcpy(cur[i],px[per[i]-1],sizeof(px[per[i]-1]));\n\tint lx=cur[0][k].x,rx=cur[2][n/3-k+1].x;\n\tif(lx>=rx)return 0;\n\tfor(int i=1;i+k-1<=n/3;i++)\n\t\tif(cur[1][i].x>lx&&cur[1][i+k-1].x<rx)return 1;\n\treturn 0;\n}\ninline bool check_up_to_down(int k,int per[])\n{\n\tfor(int i=0;i<3;i++)memcpy(cur[i],py[per[i]-1],sizeof(py[per[i]-1]));\n\tint dy=cur[0][k].y,uy=cur[2][n/3-k+1].y;\n\tif(dy>=uy)return 0;\n\tfor(int i=1;i+k-1<=n/3;i++)\n\t\tif(cur[1][i].y>dy&&cur[1][i+k-1].y<uy)return 1;\n\treturn 0;\n}\ninline bool check_up1down2(int k,int per[])\n{\n\tmemcpy(cur[0],py[per[0]-1],sizeof(py[per[0]-1]));\n\tfor(int i=1;i<3;i++)memcpy(cur[i],px[per[i]-1],sizeof(px[per[i]-1]));\n\tint uy=cur[0][n/3-k+1].y;\n\tint mx=-2e9,cnt1=0,mn=2e9,cnt2=0;\n\tfor(int i=1;i<=n/3;i++){if(cur[1][i].y<uy)cnt1++,mx=cur[1][i].x;if(cnt1==k)break;}\n\tfor(int i=n/3;i>=1;i--){if(cur[2][i].y<uy)cnt2++,mn=cur[2][i].x;if(cnt2==k)break;}\n\tif(mx<mn&&cnt1==k&&cnt2==k)return 1;\n\tmx=-2e9,cnt1=0,mn=2e9,cnt2=0;\n\tfor(int i=1;i<=n/3;i++){if(cur[2][i].y<uy)cnt1++,mx=cur[2][i].x;if(cnt1==k)break;}\n\tfor(int i=n/3;i>=1;i--){if(cur[1][i].y<uy)cnt2++,mn=cur[1][i].x;if(cnt2==k)break;}\n\tif(mx<mn&&cnt1==k&&cnt2==k)return 1;\n\treturn 0;\n}\ninline bool check_left1right2(int k,int per[])\n{\n\tmemcpy(cur[0],px[per[0]-1],sizeof(px[per[0]-1]));\n\tfor(int i=1;i<3;i++)memcpy(cur[i],py[per[i]-1],sizeof(py[per[i]-1]));\n\tint lx=cur[0][k].x;\n\tint mx=-2e9,cnt1=0,mn=2e9,cnt2=0;\n\tfor(int i=1;i<=n/3;i++){if(cur[1][i].x>lx)cnt1++,mx=cur[1][i].y;if(cnt1==k)break;}\n\tfor(int i=n/3;i>=1;i--){if(cur[2][i].x>lx)cnt2++,mn=cur[2][i].y;if(cnt2==k)break;}\n\tif(mx<mn&&cnt1==k&&cnt2==k)return 1;\n\tmx=-2e9,cnt1=0,mn=2e9,cnt2=0;\n\tfor(int i=1;i<=n/3;i++){if(cur[2][i].x>lx)cnt1++,mx=cur[2][i].y;if(cnt1==k)break;}\n\tfor(int i=n/3;i>=1;i--){if(cur[1][i].x>lx)cnt2++,mn=cur[1][i].y;if(cnt2==k)break;}\n\tif(mx<mn&&cnt1==k&&cnt2==k)return 1;\n\treturn 0;\n}\ninline bool check_down1up2(int k,int per[])\n{\n\tmemcpy(cur[0],py[per[0]-1],sizeof(py[per[0]-1]));\n\tfor(int i=1;i<3;i++)memcpy(cur[i],px[per[i]-1],sizeof(px[per[i]-1]));\n\tint dy=cur[0][k].y;\n\tint mx=-2e9,cnt1=0,mn=2e9,cnt2=0;\n\tfor(int i=1;i<=n/3;i++){if(cur[1][i].y>dy)cnt1++,mx=cur[1][i].x;if(cnt1==k)break;}\n\tfor(int i=n/3;i>=1;i--){if(cur[2][i].y>dy)cnt2++,mn=cur[2][i].x;if(cnt2==k)break;}\n\tif(mx<mn&&cnt1==k&&cnt2==k)return 1;\n\tmx=-2e9,cnt1=0,mn=2e9,cnt2=0;\n\tfor(int i=1;i<=n/3;i++){if(cur[2][i].y>dy)cnt1++,mx=cur[2][i].x;if(cnt1==k)break;}\n\tfor(int i=n/3;i>=1;i--){if(cur[1][i].y>dy)cnt2++,mn=cur[1][i].x;if(cnt2==k)break;}\n\tif(mx<mn&&cnt1==k&&cnt2==k)return 1;\n\treturn 0;\n}\ninline bool check_right1left2(int k,int per[])\n{\n\tmemcpy(cur[0],px[per[0]-1],sizeof(px[per[0]-1]));\n\tfor(int i=1;i<3;i++)memcpy(cur[i],py[per[i]-1],sizeof(py[per[i]-1]));\n\tint rx=cur[0][n/3-k+1].x;\n\tint mx=-2e9,cnt1=0,mn=2e9,cnt2=0;\n\tfor(int i=1;i<=n/3;i++){if(cur[1][i].x<rx)cnt1++,mx=cur[1][i].y;if(cnt1==k)break;}\n\tfor(int i=n/3;i>=1;i--){if(cur[2][i].x<rx)cnt2++,mn=cur[2][i].y;if(cnt2==k)break;}\n\tif(mx<mn&&cnt1==k&&cnt2==k)return 1;\n\tmx=-2e9,cnt1=0,mn=2e9,cnt2=0;\n\tfor(int i=1;i<=n/3;i++){if(cur[2][i].x<rx)cnt1++,mx=cur[2][i].y;if(cnt1==k)break;}\n\tfor(int i=n/3;i>=1;i--){if(cur[1][i].x<rx)cnt2++,mn=cur[1][i].y;if(cnt2==k)break;}\n\tif(mx<mn&&cnt1==k&&cnt2==k)return 1;\n\treturn 0;\n}\ninline bool check(int k)\n{\n\tif(k*3>n)return 0;\n\tint per[]={1,2,3};\n\tdo\n\t{\n\t\tif(check_left_to_right(k,per))return 1;\n\t\tif(check_up_to_down(k,per))return 1;\n\t\tif(check_up1down2(k,per))return 1;\n\t\tif(check_left1right2(k,per))return 1;\n\t\tif(check_down1up2(k,per))return 1;\n\t\tif(check_right1left2(k,per))return 1;\n\t}while(next_permutation(per,per+3));\n\treturn 0;\n}\ntemplate<typename T>inline void read(T &x) \n{\n\tx=0;int f=1;char c=getchar();\n\tfor(;!isdigit(c);c=getchar())if(c=='-')f=-1;\n\tfor(;isdigit(c);c=getchar())x=(x<<1)+(x<<3)+(c^48);\n\tx*=f;\n}\nint main()\n{\n\tread(n);\n\tfor(int i=1,x,y,c;i<=n;i++)\n\t{\n\t\tread(x);read(y);read(c);\n\t\tp[c-1][++cnt[c-1]]=(node){x,y};\n\t}\n\tfor(int i=1;i<=n/3;i++)\n\t\tfor(int j=0;j<3;j++)\n\t\t\tpx[j][i].x=py[j][i].x=p[j][i].x,\n\t\t\tpx[j][i].y=py[j][i].y=p[j][i].y;\n\tfor(int i=0;i<3;i++)\n\t\tsort(px[i]+1,px[i]+n/3+1,cmpx),sort(py[i]+1,py[i]+n/3+1,cmpy);\n\tint l=0,r=(n/3)+1,mid,ans=0;\n\twhile(l<=r)\n\t{\n\t\tmid=(l+r)>>1;\n\t\tif(check(mid))l=mid+1,ans=mid;\n\t\telse r=mid-1;\n\t}\n\tprintf(\"%d\",ans*3);\n\treturn 0;\n}\n```",
        "postTime": 1639643884,
        "uid": 333574,
        "name": "Tyyyyyy",
        "ccfLevel": 7,
        "title": "CF1608E\u9898\u89e3"
    },
    {
        "content": "\u9898\u610f\uff1a\u7528\u4e09\u4e2a\u4e0d\u76f8\u4ea4\u7684\u77e9\u5f62\uff0c\u4f7f\u5176\u6bcf\u4e00\u4e2a\u4e3e\u884c\u4e2d\u6709 $k$ \u4e2a\u67d0\u79cd\u989c\u8272\u7684\u70b9\u3002\u4f7f $k$ \u6700\u5927\u3002\n\n\n------------\n\n\n\u7531\u4e8e\u7b54\u6848\u660e\u663e\u5177\u6709\u5355\u8c03\u6027\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u4e8c\u5206\u7b54\u6848\u3002\n\n\n------------\n\n\n\u90a3\u4e48\u5982\u4f55\u5224\u65ad\u4e00\u4e2a\u503c\u53ef\u4e0d\u53ef\u884c\u5462\uff0c\u8fd9\u4e2a\u4f3c\u4e4e\u6709\u70b9\u590d\u6742\uff0c\u6211\u4eec\u9010\u6b65\u8003\u8651\u3002\n\n\u9996\u5148\uff0c\u6211\u4eec\u8003\u8651\u5982\u679c\u53ea\u6709\u4e24\u79cd\u989c\u8272\u600e\u4e48\u529e\u3002\n\n\u5f88\u660e\u663e\u4e24\u4e2a\u77e9\u5f62\u7684\u5206\u5e03\u5fc5\u7136\u5982\u4e0b\u56fe\u6240\u793a\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ivjshgdy.png)\n\n\n\n------------\n\u90a3\u4e48\u5176\u5b9e\u5206\u6210\u4e09\u4e2a\u77e9\u5f62\u4e5f\u5dee\u4e0d\u591a\uff0c\u53ef\u4ee5\u5927\u81f4\u5f52\u4e3a\u4ee5\u4e0b\u516d\u7c7b\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/qp54mgs7.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/r84itnh2.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/elignqo2.png)\n\n\n\u6211\u4eec\u53ea\u8981\u5224\u65ad\u80fd\u4e0d\u80fd\u7528\u8fd9\u516d\u79cd\u65b9\u5f0f\u505a\u5230\u5c31\u53ef\u4ee5\u4e86\uff0c\u518d\u52a0\u4e0a\u989c\u8272\u7684\u6392\u5217\u4e00\u6b21\uff0c\u4e8c\u5206\u6bcf\u6b21\u5224\u65ad 36 \u6b21\u3002\n\n\u5bf9\u4e8e\u5982\u4f55\u5224\u65ad\u4efb\u610f\u4e00\u79cd\u77e9\u5f62\u6392\u5217\u662f\u5426\u53ef\u884c\u5462\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u4e24\u4e2a\u6570\u7ec4\u5b58\u50a8\u5750\u6807\uff0c\u4e00\u4e2a\u6309 x \u6392\u5e8f\uff0c\u53e6\u4e00\u4e2a\u6309 y \u6392\u5e8f\u3002\u5bf9\u6ee1\u8db3\u9650\u5236\u7684\u5750\u6807\u6570\u989c\u8272\u5373\u53ef\u3002\n\n\n\u6ce8\u610f\uff1a\u4ee3\u7801\u7ec6\u8282\u8f83\u591a\uff0c\u4e00\u4e2a\u77e9\u5f62\u5185\u53ea\u80fd\u542b\u4e00\u79cd\u989c\u8272\u7684\u70b9\uff0c\u5224\u65ad\u4e0d\u80fd\u53d6\u7b49\u4e8e\u3002\n\n------------\n\u4ee3\u7801\u5982\u4e0b\n\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n//static char buf[1000000],*p1=buf,*p2=buf;\n//#define getchar() p1==p2&&(p2=(p1=buf)+fread(buf,1,1000000,stdin),p1==p2)?EOF:*p1++\n#define pi pair<int,int>\n#define mp make_pair\n#define fi first\n#define se second\n#define pb push_back\n#define ls (rt<<1)\n#define rs (rt<<1|1)\n#define lowbit (x&-x)\nconst int maxn=1e5+5,M=34005;\ninline int read()\n{\n\tchar ch=getchar();bool f=0;int x=0;\n\tfor(;!isdigit(ch);ch=getchar())if(ch=='-')f=1;\n\tfor(;isdigit(ch);ch=getchar())x=(x<<1)+(x<<3)+(ch^48);\n\tif(f==1)x=-x;return x;\n}\ninline void print(int x)\n{\n    static int a[55];int top=0;\n    if(x<0) putchar('-'),x=-x;\n    do{a[top++]=x%10,x/=10;}while(x);\n    while(top) putchar(a[--top]+48);\n}\nint n,m,l,r,vis[maxn];\nstruct node \n{\n\tint x,y,z,id;\n}a[maxn],b[maxn];\nbool cmp(node a,node b)\n{\n\treturn a.x<b.x;\n}\nbool cmp2(node a,node b)\n{\n\treturn a.y<b.y;\n}\n\nbool check(int d,int e,int f,int x)\n{\n\tint l=0,r=0,t=0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(a[i].z==d)t++;\n\t\tif(t==x){l=a[i].x;break;}\n\t}\n\tif(t==x)\n\t{\n\t\tt=0;\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tif(a[i].z==e&&a[i].x>l)t++;\n\t\t\tif(t==x){r=a[i].x;break;}\n\t\t}\n\t\tif(t==x)\n\t\t{\n\t\t\tt=0;\n\t\t\tfor(int i=1;i<=n;i++)\n\t\t\t{\n\t\t\t\tif(a[i].z==f&&a[i].x>r)t++;\n\t\t\t\tif(t==x){break;}\n\t\t\t}\n\n\t\t\tif(t==x)return 1;\n\t\t}\n\t\n\t\tt=0;\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tif(b[i].z==e&&b[i].x>l)t++;\n\t\t\tif(t==x){r=b[i].y;break;}\n\t\t}\n\t\tif(t==x)\n\t\t{\n\t\t\tt=0;\n\t\t\tfor(int i=1;i<=n;i++)\n\t\t\t{\n\t\t\t\tif(b[i].z==f&&b[i].x>l&&b[i].y>r)t++;\n\t\t\t\tif(t==x){break;}\n\t\t\t}\n\t\t\tif(t==x)return 1;\n\t\t}\n\t}\n\t\n\t\n\t\n\tt=0;\n\tfor(int i=n;i>=1;i--)\n\t{\n\t\tif(a[i].z==d)t++;\n\t\tif(t==x){r=a[i].x;break;}\n\t}\n\tif(t==x)\n\t{\n\t\tt=0;\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tif(b[i].z==e&&b[i].x<r)t++;\n\t\t\tif(t==x){l=b[i].y;break;}\n\t\t}\n\t\tif(t==x)\n\t\t{\n\t\t\tt=0;\n\t\t\tfor(int i=1;i<=n;i++)\n\t\t\t{\n\t\t\t\tif(b[i].z==f&&b[i].x<r&&b[i].y>l)t++;\n\t\t\t\tif(t==x){break;}\n\t\t\t}\n\t\t\tif(t==x)return 1;\n\t\t}\n\t}\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\t\n\tt=0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(b[i].z==d)t++;\n\t\tif(t==x){l=b[i].y;break;}\n\t}\n\tif(t==x)\n\t{\n\t\tt=0;\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tif(b[i].z==e&&b[i].y>l)t++;\n\t\t\tif(t==x){r=b[i].y;break;}\n\t\t}\n\t\t\n\t\tif(t==x)\n\t\t{\n\t\t\tt=0;\n\t\t\tfor(int i=1;i<=n;i++)\n\t\t\t{\n\t\t\t\tif(b[i].z==f&&b[i].y>r)t++;\n\t\t\t\tif(t==x){break;}\n\t\t\t}\n\t\t\tif(t==x)return 1;\n\t\t}\n\t\t\n\t\t\n\t\t\n\t\t\n\t\tt=0;\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tif(a[i].z==e&&a[i].y>l)t++;\n\t\t\tif(t==x){r=a[i].x;break;}\n\t\t}\n\t\tif(t==x)\n\t\t{\n\t\t\tt=0;\n\t\t\tfor(int i=1;i<=n;i++)\n\t\t\t{\n\t\t\t\tif(a[i].z==f&&a[i].y>l&&a[i].x>r)t++;\n\t\t\t\tif(t==x){break;}\n\t\t\t}\n\t\t\tif(t==x)return 1;\n\t\t}\n\t}\n\t\n\t\n\tt=0;\n\tfor(int i=n;i>=1;i--)\n\t{\n\t\tif(b[i].z==d)t++;\n\t\tif(t==x){r=b[i].y;break;}\n\t}\n\tif(t==x)\n\t{\n\t\tt=0;\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tif(a[i].z==e&&a[i].y<r)t++;\n\t\t\tif(t==x){l=a[i].x;break;}\n\t\t}\n\t\tif(t==x)\n\t\t{\n\t\t\tt=0;\n\t\t\tfor(int i=1;i<=n;i++)\n\t\t\t{\n\t\t\t\tif(a[i].z==f&&a[i].y<r&&a[i].x>l)t++;\n\t\t\t\tif(t==x){break;}\n\t\t\t}//cout<<t<<endl;\n\t\t\tif(t==x)return 1;\n\t\t}\n\t}return 0;\n}\nbool check2(int x)\n{\n\tif(check(1,2,3,x))return 1;\n\tif(check(2,1,3,x))return 1;\n\tif(check(3,1,2,x))return 1;\n\tif(check(3,2,1,x))return 1;\n\tif(check(1,3,2,x))return 1;\n\tif(check(2,3,1,x))return 1;\n\treturn 0;\n}\nsigned main()\n{\n\t//freopen(\".in\",\"r\",stdin);\n\t//freopen(\".out\",\"w\",stdout);\n\tn=read();\n\tfor(int i=1;i<=n;i++)a[i].x=read(),a[i].y=read(),a[i].z=read(),a[i].id=i,b[i]=a[i];\n\tsort(a+1,a+n+1,cmp),sort(b+1,b+n+1,cmp2);\n\tint l=1,r=n/3,res=0;//return 0;\n\twhile(l<=r)\n\t{\n\t\tint mid=l+r>>1;\n\t\tif(check2(mid))l=mid+1,res=mid;\n\t\telse r=mid-1;\n\t}\n\tcout<<res*3<<endl;\n \treturn 0;\n}\n\n```\n",
        "postTime": 1639399850,
        "uid": 343748,
        "name": "louhao088",
        "ccfLevel": 9,
        "title": "\u9898\u89e3CF1608E The Cells on the Paper"
    },
    {
        "content": "## \u9898\u610f\n\u5e73\u9762\u4e0a\u6709 $n$ \u4e2a\u70b9 $(3\\mid n)$\uff0c$1,2,3$ \u8fd9 3 \u79cd\u989c\u8272\u7684\u70b9\u6bcf\u79cd $\\dfrac n3$ \u4e2a\u3002\n\n\u6c42\u6700\u5927\u7684 $k\\ (3\\mid k)$\uff0c\u53ef\u4ee5\u9009\u62e9\u6bcf\u79cd\u70b9 $\\dfrac k3$ \u4e2a\uff0c\u5b58\u5728 $3$ \u4e2a\u4e92\u4e0d\u76f8\u4ea4\u7684\u77e9\u5f62\u5206\u522b\u5305\u542b\u5168\u90e8\u6bcf\u79cd\u989c\u8272\u7684 $\\dfrac k3$ \u4e2a\u70b9\u3002\n\n## \u9898\u89e3\n**\u4e8c\u5206\u7b54\u6848**\u3002\n\n\u53ea\u8981\u628a\u5e73\u9762\u5206\u6210 $3$ \u5757\uff0c\u6bcf\u4e00\u5757\u81f3\u5c11\u6709 $\\dfrac k3$ \u4e2a\u8be5\u989c\u8272\u7684\u70b9\u5373\u53ef\u3002\n\n\u56e0\u4e3a\u662f $3$ \u5757\uff0c\u4e00\u5b9a\u662f\u4e0b\u9762\u4e24\u79cd\u4e4b\u4e00\u3002\uff08\u65cb\u8f6c\u7b49\u4ef7\uff09\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/nkkq9urc.png)\n\n\u5148\u6392\u5e8f\u3002\n\n+ \u5bf9\u4e8e\u7b2c 1 \u79cd\uff0c\u5c06\u6a2a\u7ebf\u4ece\u4e0b\u5411\u4e0a\u79fb\uff0c\u76f4\u5230\u6709 $\\dfrac k3$ \u4e2a\u8be5\u989c\u8272\u7684\u70b9\uff0c\u7136\u540e\u5728\u4e0a\u9762\u7528\u524d\u7f00\u548c\u3002\n\n+ \u5bf9\u4e8e\u7b2c 2 \u79cd\uff0c\u5c06\u6a2a\u7ebf\u4ece\u5de6\u5411\u53f3\u79fb\uff08\u548c\u7b2c 1 \u79cd\u7c7b\u4f3c\uff09\uff0c\u76f4\u5230\u6709 $\\dfrac k3$ \u4e2a\u8be5\u989c\u8272\u7684\u70b9\uff0c\u7136\u540e\u6362\u4e00\u79cd\u989c\u8272\u7ee7\u7eed\u79fb\uff0c\u6700\u540e\u68c0\u67e5\u5269\u4e0b\u533a\u57df\u7684\u5bf9\u5e94\u989c\u8272\u662f\u5426\u6709 $\\dfrac k3$ \u4e2a\u3002\n\n[code](https://codeforces.com/problemset/submission/1608/138819724)",
        "postTime": 1639269139,
        "uid": 222088,
        "name": "liuhengxi",
        "ccfLevel": 0,
        "title": "CF1608E \u9898\u89e3"
    }
]
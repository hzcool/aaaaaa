[
    {
        "content": "\u8bb0\u5fc6\u5316\u4e8c\u5206+\u6811\u72b6\u6570\u7ec4\u3002\n\n\u5148\u8003\u8651\u5982\u4f55\u89e3\u51b3\u5355\u7ec4\u8be2\u95ee\uff0c\u6211\u4eec\u7528 $sum_i$ \u8868\u793a $1\\sim i$ \u7684\u548c\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7\u8be2\u95ee `? 1 i` \u6765\u5f97\u5230 $sum_i$,\u82e5\u67e5\u8be2\u7684\u6570\u4e3a $k$\uff0c\u5219\u7b54\u6848\u4e3a\u6ee1\u8db3 $i-sum_i=k$ \u7684**\u6700\u5c0f\u7684** $i$\uff0c\u53ef\u4ee5\u4e8c\u5206\u5f97\u5230\u7b54\u6848\u3002\n\n\u7c7b\u4f3c\u5730\uff0c\u82e5\u6211\u4eec\u5bf9\u591a\u7ec4\u8be2\u95ee\u7684\u6bcf\u7ec4\u90fd\u4f7f\u7528\u4e0a\u8ff0\u65b9\u6cd5\uff0c\u67e5\u8be2\u6b21\u6570\u662f $O(t\\log n)$ \u7684\uff0c\u9700\u8981\u4f18\u5316\uff0c\u53d1\u73b0\u6709\u591a\u6b21\u91cd\u590d\u67e5\u8be2\u4e00\u4e2a\u70b9\u7684 $sum$\uff0c\u4e8e\u662f\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\uff0c\u53ea\u5728\u7b2c\u4e00\u6b21\u67e5\u8be2\u65f6\u8f93\u51fa\u8be2\u95ee\uff0c\u4e4b\u540e\u7684\u67e5\u8be2\u76f4\u63a5\u4f7f\u7528\u5df2\u7ecf\u5f97\u5230\u7684\u503c\u5373\u53ef\u3002\n\n\u4f46\u9898\u76ee\u8fd8\u6709\u4e00\u4e2a\u6761\u4ef6\uff0c\u8981\u5728\u6bcf\u6b21\u56de\u7b54\u8be2\u95ee\u540e\u5c06\u7b54\u6848\u5bf9\u5e94\u4f4d\u7f6e\u7684 `0` \u6539\u4e3a `1`\uff0c\u4e8e\u662f\u82e5\u6211\u4eec\u56de\u7b54\u4e86 $k$\uff0c\u5219\u9700\u8981\u5c06 $[k+1,n]$ \u7684 $sum$ \u90fd\u81ea\u589e `1`\u3002\u8fd9\u9700\u8981\u4e00\u4e2a\u652f\u6301\u5355\u70b9\u67e5\u8be2\u548c\u533a\u95f4\u4fee\u6539\u7684\u6570\u636e\u7ed3\u6784\uff0c\u6211\u4f7f\u7528\u7684\u662f\u6811\u72b6\u6570\u7ec4\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ri register int\n#define DEBUG(k...) fprintf(stderr,k)\ntypedef long long ll;\ntemplate<class T>inline bool chmax(T &x,const T &y){return x<y?x=y,true:false;}\ntemplate<class T>inline bool chmin(T &x,const T &y){return x>y?x=y,true:false;}\nconst int maxn=2e5+10;\n#define lowbit(k) ((k)&(-k))\ntemplate<typename T>\nstruct BIT{\n\tT c[maxn];\n\tint mx_idx;\n\tinline void clear(){memset(c,0,sizeof(T)*(mx_idx+1));}\n\tinline void add(int k,T v){\n\t\tfor(;k<=mx_idx;k+=lowbit(k))c[k]+=v;\n\t}\n\tinline T query(int k){\n\t\tri ret=0;\n\t\tfor(;k;k^=lowbit(k))ret+=c[k];\n\t\treturn ret;\n\t}\n\tinline T query(int l,int r){\n\t\treturn query(r)-query(l-1);\n\t}\n};\nBIT<int>c;\nbool vis[maxn];\nint k,m,n,t_case;\ninline void ask(int l,int r){\n\tprintf(\"? %d %d\\n\",l,r);\n\tfflush(stdout);\n}\ninline void half(int l,int r,int k){\n\tif(l==r){\n\t\tprintf(\"! %d\\n\",l);\n\t\tvis[l]=true;\n\t\tri d=l-k-c.query(l);\n\t\tc.add(l,d+1);\n\t\tc.add(l+1,-d);\n\t\tfflush(stdout);\n\t\treturn;\n\t}\n\tri mid=l+r>>1,tmp;\n\tif(vis[mid])tmp=c.query(mid);\n\telse{\n\t\task(1,mid);\n\t\tscanf(\"%d\",&tmp);\n\t\tvis[mid]=true;\n\t\tri d=tmp-c.query(mid);\n\t\tc.add(mid,d);\n\t\tc.add(mid+1,-d);\n\t}\n\tif(tmp<=mid-k)half(l,mid,k);\n\telse half(mid+1,r,k);\n}\nint main(){\n\tscanf(\"%d%d\",&n,&t_case);\n\tc.mx_idx=n;\n\twhile(t_case--){\n\t\tscanf(\"%d\",&k);\n\t\thalf(1,n,k);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1622915557,
        "uid": 67942,
        "name": "meyi",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1520F2 \u3010Guess the K-th Zero (Hard version)\u3011"
    },
    {
        "content": "\u5f88\u6709\u610f\u601d\u7684\u4e00\u4e2a\u9898\u76ee\uff0c\u636e\u8bf4\u8bb0\u5fc6\u5316\u641c\u7d22\u7684\u590d\u6742\u5ea6\u5bf9\u7684\uff0c\u4f46\u662f\u6211\u7684\u505a\u6cd5\u4e0d\u662f\u90a3\u6837\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u5f88\u79bb\u8c31\u3002\u4ed6\u8981\u6c42\u4ea4\u4e92\u6b21\u6570\u4e0d\u80fd\u5927\u4e8e $6\\times 10^4$\uff0c\u6211\u4eec\u9996\u5148\u5f88\u663e\u7136\u7684\u6709\u4e00\u4e2a\u4e8c\u5206\u7684\u505a\u6cd5\uff0c\u53ef\u662f\u8fd9\u4e2a\u7684\u6b21\u6570\u4e3a$O(t\\log n)$\uff0c\u65e0\u6cd5\u901a\u8fc7\u8fd9\u9898\n\n\u4e8e\u662f\u8003\u8651\u6211\u4eec\u5148\u9884\u5904\u7406\u51fa\u6765\u4e8c\u5206\u7684\u4e00\u90e8\u4efd\u503c\uff0c\u7136\u540e\u6bcf\u6b21\u53ea\u7528\u5728\u5f88\u5c0f\u7684\u8303\u56f4\u5185\u4e8c\u5206\u5373\u53ef\u3002\n\n\u6211\u4eec\u8003\u8651\u5bf9\u4e8e\u6240\u6709\u5750\u6807\u662f $8$ \u7684\u500d\u6570\u7684\u4e0b\u6807\u9884\u5904\u7406\u51fa\u6765\u4ed6\u4eec\u7684 $sum_{1,pos}$\uff0c\u7136\u540e\uff0c\u628a $n$ \u53d8\u957f\u5230 $2$ \u7684\u5e42\u6b21\n\n\u6bcf\u6b21\u76f4\u63a5\u4e8c\u5206\u5373\u53ef\uff0c\u524d\u4e00\u90e8\u5206\u7684\u4e8c\u5206\u7684\u7b54\u6848\u5df2\u7ecf\u88ab\u9884\u5904\u7406\u51fa\u6765\u4e86\uff0c\u4fee\u6539\u7684\u90e8\u5206\u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u3002\u5c0f\u7684\u90e8\u5206\u76f4\u63a5\u67e5\u8be2\u7b54\u6848\u5c31\u597d\u4e86\u3002\n\n\u6839\u636e\u5b9e\u73b0\u7684\u65b9\u6cd5\u4e0d\u540c\u53ef\u4ee5\u505a\u5230 $O(t\\log n)$ \u6216\u8005\u662f $O(t\\log ^2n)$ \u7684\u590d\u6742\u5ea6\u3002\n\n```cpp\n#include <bits/stdc++.h>\nconst int N = 2e5 + 10;\nint n, t, sc[N], val[N];\ninline void add(int x) {\n\tfor ( ; x <= n; x += x & -x) {\n\t\tsc[x]++;\n\t}\n}\ninline int sum(int x) {\n\tint res = 0;\n\tfor ( ; x; x -= x & -x) {\n\t\tres += sc[x];\n\t}\n\treturn res;\n}\nint main() {\n\tstd::cin >> n >> t;\n\tstd::function<void(int, int)> ask = [&] (int l, int r) {\n\t\tstd::cout << \"? \" << l << \" \" << r << std::endl; \n\t};\n\tstd::function<bool(int, int)> check = [&] (int pos, int cnt) {\n\t\tif (pos >= n) {\n\t\t\treturn true;\n\t\t}\n\t\tif (pos % 8 == 0) {\n\t\t\treturn pos - val[pos] - sum(pos) >= cnt;\n\t\t}\n\t\task(1, pos);\n\t\tint res;\n\t\tstd::cin >> res;\n\t\treturn pos - res >= cnt;\n\t};\n\tint sz = 1;\n\twhile (sz < n) {\n\t\tsz <<= 1;\n\t}\n\tfor (int i = 1, k; i <= t; ++i) {\n\t\tstd::cin >> k;\n\t\tif (i == 1) {\n\t\t\tfor (int j = 8; j <= n; j += 8) {\n\t\t\t\task(1, j);\n\t\t\t\tstd::cin >> val[j];\n\t\t\t}\n\t\t}\n\t\tint l = 1, r = sz;\n\t\twhile (l < r) {\n\t\t\tint mid = (l + r) / 2;\n\t\t\tif (check(mid, k)) {\n\t\t\t\tr = mid;\n\t\t\t}\n\t\t\telse {\n\t\t\t\tl = mid + 1;\n\t\t\t}\n\t\t}\n\t\tstd::cout << \"! \" << r << std::endl;\n\t\tadd(r);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1620289572,
        "uid": 232125,
        "name": "SiRiehn_nx",
        "ccfLevel": 9,
        "title": "Codeforces 1520F2 solution"
    },
    {
        "content": "## \u9898\u89e3 CF1520F2 \u3010Guess the K-th Zero (Hard version)\u3011\n\n### \u9898\u610f\n\n+ \u7ed9\u51fa\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684 01 \u4e32\uff0c$t$ \u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u627e\u5230\u4ece\u5de6\u5230\u53f3\u6570\u7b2c $k$ \u4e2a 0 \u5e76\u628a\u5b83\u4fee\u6539\u4e3a 1\u3002\n+ \u4f60\u53ef\u4ee5\u8be2\u95ee\u4ea4\u4e92\u5e93\u4e0d\u8d85\u8fc7 $6\\times10^4$ \u4e2a\u95ee\u9898\uff0c\u6bcf\u4e2a\u95ee\u9898\u5f62\u5982\u7b2c $l$ \u4e2a\u5b57\u7b26\u5230\u7b2c $r$ \u4e2a\u5b57\u7b26\u4e2d\u6709\u591a\u5c11\u4e2a 1\u3002\n+ $n\\le2\\times10^5,t\\le\\min(n,10^4)$\u3002\n\n### \u505a\u6cd5\n\n\u5e73\u5747\u6bcf\u6b21\u64cd\u4f5c\u4e0d\u80fd\u8d85\u8fc7 $\\dfrac{6\\times10^4}{t}=6$ \u6b21\u8be2\u95ee\u3002\n\n\u53ef\u4ee5\u7528\u7c7b\u4f3c\u7ebf\u6bb5\u6811\u4e0a\u4e8c\u5206\u7684\u505a\u6cd5\uff0c\u6bcf\u6b21\u67e5\u8be2\u7684\u65f6\u5019\u4fdd\u5b58\u4e00\u4e0b\u8282\u70b9\u7684\u4fe1\u606f\uff0c\u4fee\u6539\u7684\u65f6\u5019\u76f4\u63a5 $O(\\log n)$ \u4fee\u6539\u3002\n\n\u7136\u540e\u53d1\u73b0\u6bcf\u6b21\u64cd\u4f5c\u9700\u8981\u7684\u8be2\u95ee\u4e2a\u6570\u662f $\\log_2n$\uff0c\u5927\u7ea6\u662f $18$ \u4e2a\uff0c\u8fdc\u8d85\u5e73\u5747\u7684 $6$\u3002\n\n\u6211\u4eec\u6ce8\u610f\u5230\u6bcf\u4e2a\u8282\u70b9\u6700\u591a\u88ab\u67e5\u8be2\u4e00\u6b21\uff0c\u56e0\u4e3a\u88ab\u67e5\u8be2\u540e\u6211\u4eec\u65f6\u523b\u4fdd\u6301\u5b83\u7684\u4fe1\u606f\u662f\u6b63\u786e\u7684\uff1a\n\n> \u4fee\u6539\u7684\u65f6\u5019\u76f4\u63a5 $O(\\log n)$ \u4fee\u6539\u3002\n\n\u4e14\u6bcf\u4e2a\u8282\u70b9\u7684\u4e24\u4e2a\u5b50\u6811\u4e2d\uff0c\u53ea\u6709\u5de6\u5b50\u6811\u4f1a\u88ab\u67e5\u5230\uff08\u6211\u4eec\u53ea\u9700\u8981\u5de6\u5b50\u6811\u7684\u503c\u6765\u5224\u65ad\u7b54\u6848\u5728\u54ea\u4e2a\u5b50\u6811\u5185\uff0c\u53f3\u5b50\u6811\u7684\u503c\u5bf9\u6211\u4eec\u6ca1\u6709\u4ef7\u503c\uff09\uff0c\u4e14\u5728\u6bcf\u6b21\u8be2\u95ee\u91cc\uff0c\u6700\u591a\u53ea\u4f1a\u5728\u7ebf\u6bb5\u6811\u7684\u6bcf\u4e00\u5c42\u591a\u8be2\u95ee\u4e00\u4e2a\u8282\u70b9\u3002\n\n\u7efc\u4e0a\uff0c\u7ebf\u6bb5\u6811\u7684\u6bcf\u4e00\u5c42\u6700\u591a\u53ea\u4f1a\u88ab\u8be2\u95ee $\\min(t,\\dfrac{size}{2})$ \u6b21\uff0c$size$ \u4e3a\u8be5\u5c42\u7ebf\u6bb5\u6811\u7684\u8282\u70b9\u4e2a\u6570\uff0c\u53ef\u5217\u51fa\u4e0b\u8868\uff08\u56fe\u4e11\u52ff\u602a\uff09\uff1a\n\n|\u5c42\u6570|\u672c\u5c42\u6700\u591a\u8be2\u95ee\u6b21\u6570|\u672c\u5c42\u53ca\u4ee5\u4e0a\u6700\u591a\u8be2\u95ee\u6b21\u6570|\u672c\u5c42\u8282\u70b9\u6570|\n|:-|:-|:-|:-|\n|$0$(root)|$0$|$0$|$1$|\n|$1$|$1$|$1$|$2$|\n|$2$|$2$|$3$|$4$|\n|$3$|$4$|$7$|$8$|\n|$4$|$8$|$2^4-1$|$16$|\n|$\\dots$|$\\dots$|$\\dots$|$\\dots$|\n|$13$|$2^{12}=4096$|$2^{13}-1$|$2^{13}$|\n|$14$|$2^{13}=8192$|$2^{14}-1$|$2^{14}$|\n|$15$|$10^4$|$10^4+2^{14}-1$|$2^{15}$|\n|$16$|$10^4$|$2\\times10^4+2^{14}-1$|$2^{16}$|\n|$17$|$10^4$|$3\\times10^4+2^{14}-1$|$2^{17}=131072$|\n|$18$|$10^4$|$4\\times10^4+2^{14}-1$|$2^{18}=262144$|\n\n\u53d1\u73b0\u5230\u4e86\u6700\u540e\u4e00\u5c42\uff0c\u6700\u591a\u4e5f\u5c31 $56383$ \u6b21\u8be2\u95ee\uff0c\u5df2\u7ecf\u53ef\u4ee5\u8fc7\uff0c\u800c\u4e14\u5f88\u96be\u6784\u9020\u5361\u6ee1\u7684\u6570\u636e\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include <cstdio>\n\nusing namespace std;\n\nconst int N = 2e5 + 5;\n\nstruct Tree {\n\tTree *ls, *rs;\n\tint sum, vis;\n\t\n\tTree() {\n\t\tvis = 0;\n\t}\n} seg[N << 1], *leaf = seg;\n\nvoid build(Tree *t, int l, int r) {\n\tif (l == r) {\n\t\treturn;\n\t}\n\tint mid = (l + r) >> 1;\n\tt->ls = ++leaf;\n\tt->rs = ++leaf;\n\tbuild(t->ls, l, mid);\n\tbuild(t->rs, mid + 1, r);\n}\n\nint q(int l, int r) {\n\tprintf(\"? %d %d\\n\", l, r);\n\tfflush(stdout);\n\tint ans;\n\tscanf(\"%d\", &ans);\n\treturn ans;\n}\n\nint query(Tree *t, int l, int r, int k) {\n\t--t->sum;\n\tif (l == r) return l;\n\tint mid = (l + r) >> 1;\n\tif (!t->ls->vis) {\n\t\tt->ls->vis = 1;\n\t\tt->ls->sum = mid - l + 1 - q(l, mid);\n\t}\n\tif (t->ls->sum >= k) return query(t->ls, l, mid, k);\n\telse return query(t->rs, mid + 1, r, k - t->ls->sum);\n}\n\nint main() {\n\tint n, t;\n\tscanf(\"%d%d\", &n, &t);\n\tbuild(seg, 1, n);\n\tfor (int i = 1; i <= t; ++i) {\n\t\tint k;\n\t\tscanf(\"%d\", &k);\n\t\tprintf(\"! %d\\n\", query(seg, 1, n, k));\n\t\tfflush(stdout);\n\t}\n}\n```",
        "postTime": 1626927568,
        "uid": 246014,
        "name": "Cutest_Junior",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF1520F2 \u3010Guess the K-th Zero (Hard version)\u3011"
    },
    {
        "content": "\u6765\u4e2a\u66b4\u529b\u70b9\u7684\u3002\n\n\u9996\u5148 F1 \u7684\u76f4\u63a5\u4e8c\u5206\u505a query \u4f1a\u5427\uff1f\u6211\u4eec\u76f4\u63a5\u628a\u540c\u4e00\u4e2a\u533a\u95f4\u7684\u8be2\u95ee hash \u4e00\u4e0b\u5b58\u4e0b\u6765\uff0c\u7136\u540e\u52a0\u4e0a\u6bcf\u6b21 guess \u540e\u6539\u53d8\u7684\u503c\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u76f4\u63a5\u7528\u6811\u72b6\u6570\u7ec4\u505a\u3002\n\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\uff0c\u641c\u7d22\u6811\u5361\u6ee1\u4e5f\u8dd1\u5f97\u8fc7\u3002\n\n[code](https://paste.ubuntu.com/p/mShDDvh7DT/)",
        "postTime": 1620740422,
        "uid": 161849,
        "name": "cirnovsky",
        "ccfLevel": 6,
        "title": "solution-cf1520f2"
    },
    {
        "content": "\u5c3d\u7ba1\u542c\u8bf4\u6709\u8bb0\u5fc6\u5316\u4e8c\u5206\u7684\u505a\u6cd5\uff0c\u4f46\u8bf4\u70b9\u5e38\u89c4\u70b9\u7684\u3002\n\n\u4e00\u770b\u8fd9\u4e2a\u9650\u5236\u6b21\u6570\u548c $n$ \u5c31\u5f88\u540c\u9636\uff0c\u8003\u8651\u5206\u5757\uff0c\u628a\u8fde\u7eed $w$ \u4e2a\u5206\u4e00\u5757\uff0c\u76f4\u63a5\u66b4\u529b\u67e5\u8be2\u6240\u6709\u5757\uff0c\u8be2\u95ee\u5c31\u5148\u5728\u5757\u7684\u524d\u7f00\u548c\u4e0a\u4e8c\u5206\uff0c\u518d\u5757\u5185\u4e8c\u5206\uff0c\u4fee\u6539\u5c31\u7ef4\u62a4\u5757\u524d\u7f00\u548c\u7684\u6811\u72b6\u6570\u7ec4\u3002\n\n\u8fd9\u6837\u7684\u4ea4\u4e92\u6b21\u6570\u662f $\\frac n w + t\\cdot \\lceil \\log_2 w\\rceil$\uff0c$w$ \u53d6 $8$\uff0c\u4ea4\u4e92\u6b21\u6570\u6700\u591a $55000$ \u6b21\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n\\log n + t\\log^2 n)$\uff0c\u53ef\u4ee5\u8fc7\u3002\n\n\u53e6\u5916\u9700\u8981\u7279\u522b\u6ce8\u610f\u4e8c\u5206\u7684\u5199\u6cd5\uff0c\u4e00\u822c\u7684 `L<R` \u7684\u5199\u6cd5\u662f $\\lceil \\log_2 w\\rceil$ \u6b21 `check`\uff0c\u800c `L<=R` \u7684\u5199\u6cd5\u6700\u591a $\\lceil \\log_2 w\\rceil+1$ \u6b21 `check`\u3002~~\u641e\u4e86\u534a\u5929\u4e8c\u5206\u4e00\u76f4\u5199\u4e11\u4e86~~\n\n```cpp\n\n// Problem: F2. Guess the K-th Zero (Hard version)\n// Contest: Codeforces - Codeforces Round #719 (Div. 3)\n// URL: https://codeforces.com/problemset/problem/1520/F2\n// Memory Limit: 256 MB\n// Time Limit: 4000 ms\n// Powered by CP Editor (https://github.com/cpeditor/cpeditor)\n\n// Happy Chinese new year! (Feb. 12th, 2021)\n\n/*\n * Codeforces @Chenkaifeng\n * Luogu @longer_name\n */\n\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef double db;\ntypedef long double ldb;\ntypedef vector<int> vi;\ntypedef pair<int, int> pii;\n#define fi first\n#define se second\n\n#if __cplusplus < 201703L\n#define rg register\n#else\n#define rg\n#endif\n\n#define mp make_pair\n#define pb push_back\n#define pf push_front\n\n#define rep(i, s, t) for (rg int i = s; i <= t; i++)\n#define per(i, s, t) for (rg int i = t; i >= s; i--)\n#define OK cerr << \"OK!\\n\"\n\nnamespace fastio {\n\tconst int SIZE = (1 << 20) + 1;\n\tchar ibuf[SIZE], *iS, *iT, obuf[SIZE], *oS = obuf, *oT = obuf + SIZE - 1;\n\tchar _st[55];\n\tint _qr = 0;\n\n\tinline char getchar() {\n\t\treturn (iS == iT ? iT = (iS = ibuf) + fread(ibuf, 1, SIZE, stdin),\n\t\t        (iS == iT ? EOF : *iS++) : *iS++);\n\t}\n\tinline void qread() {}\n\ttemplate <typename T1, typename... T2>\n\tinline void qread(T1 &x, T2 &...ls) {\n\t\tx = 0;\n\t\trg char ch = ' ';\n\t\trg int ps = 1;\n\t\twhile (!isdigit(ch) && ch != '-') ch = getchar();\n\t\tif (ch == '-') ps = -1, ch = getchar();\n\t\twhile (isdigit(ch)) x = x * 10 + ch - '0', ch = getchar();\n\t\tx *= ps;\n\t\tqread(ls...);\n\t}\n\n\tinline void flush() {\n\t\tfwrite(obuf, 1, oS - obuf, stdout);\n\t\toS = obuf;\n\t\treturn;\n\t}\n\tinline void putchar(char _x) {\n\t\t*oS++ = _x;\n\t\tif (oS == oT) flush();\n\t}\n\ttemplate <typename T>\n\tinline void qwrite(T x) {\n\t\tif (x < 0) putchar('-'), x = -x;\n\t\tif (x < 10) return putchar('0' + x), void();\n\t\tqwrite(x / 10), putchar('0' + (x % 10));\n\t}\n\n\ttemplate <typename T>\n\tinline void qwrite(T x, char ch) {\n\t\tqwrite(x), putchar(ch);\n\t}\n};  // namespace fastio\n\n#ifndef ONLINE_JUDGE\n\nvoid debug(const char *s) {\n\tcerr << s;\n}\ntemplate <typename T1, typename... T2>\nvoid debug(const char *s, const T1 x, T2... ls) {\n\tint p = 0;\n\twhile (*(s + p) != '\\0') {\n\t\tif (*(s + p) == '{' && *(s + p + 1) == '}') {\n\t\t\tcerr << x;\n\t\t\tdebug(s + p + 2, ls...);\n\t\t\treturn;\n\t\t}\n\t\tcerr << *(s + p++);\n\t}\n}\n\n#else\n#define debug(...) void(0)\n#endif\n\nll qpow(ll x, ll p, ll mod) {\n\trg ll base = x, res = 1;\n\twhile (p) {\n\t\tif (p & 1) res = (res * base) % mod;\n\t\tbase = (base * base) % mod;\n\t\tp >>= 1;\n\t}\n\treturn res;\n}\n\n// const ll mod = 1e9 + 7;\n// const ll mod = 1e9 + 9;\n// const ll mod = 19260817;\n// const ll mod = 998244353;\nconst int mod =2017;\n\ntemplate <typename T>\ninline void chkadd(T& x, T y) {\n\tx = x + y >= mod ? x + y - mod : x + y;\n}\ntemplate <typename T>\ninline void chkadd(T& x, T y, T z) {\n\tx = y + z >= mod ? y + z - mod : y + z;\n}\ntemplate <typename T>\ninline void chkmns(T& x, T y) {\n\tx = x - y < 0 ? x - y + mod : x - y;\n}\ntemplate <typename T>\ninline void chkmns(T& x, T y, T z) {\n\tx = y - z < 0 ? y - z + mod : y - z;\n}\ntemplate <typename T>\ninline void chkmax(T& x, T y) {\n\tx = x < y ? y : x;\n}\ntemplate <typename T>\ninline void chkmax(T& x, T y, T z) {\n\tx = y > z ? y : z;\n}\ntemplate <typename T>\ninline void chkmin(T& x, T y) {\n\tx = x < y ? x : y;\n}\ntemplate <typename T>\ninline void chkmin(T& x, T y, T z) {\n\tx = y < z ? y : z;\n}\n\nconst int N = 2e5 + 5;\nconst int SIZ = 8;\n\nint n, q;\n\nint sum[N];\ninline int lowbit(int x) {\n\treturn x & (-x);\n}\ninline void add(int x, int val) {\n\tfor(int x0 = x; x0 <= n; x0 += lowbit(x0)) sum[x0] += val;\n}\ninline int getsum(int x) {\n\tint res = 0;\n\tfor(int x0 = x; x0 > 0; x0 -= lowbit(x0)) res += sum[x0];\n\treturn res;\n}\n\ninline int ask(int L, int R) {\n\tL = max(L, 1);\n\tR = min(R, n);\n\tprintf(\"? %d %d\\n\", L, R);\n\tfflush(stdout);\n\tint ret = 0;\n\tscanf(\"%d\", &ret);\n\treturn R - L + 1 - ret;\n}\n\ninline void answer(int p) {\n\tprintf(\"! %d\\n\", p);\n\tfflush(stdout);\n}\n\ninline void solve(int k) {\n\tint L = 1, R = n / SIZ + 1;\n\tint res = -1;\n\twhile(L <= R) {\n\t\tint mid = L + R >> 1;\n\t\tif(getsum(mid) >= k) {\n\t\t\tres = mid;\n\t\t\tR = mid - 1;\n\t\t} else {\n\t\t\tL = mid + 1;\n\t\t}\n\t}\n\tint p = (res - 1) * SIZ + 1;\n\tL = 1, R = SIZ;\n\tres = -1;\n\twhile(L < R) {\n\t\tint mid = L + R >> 1;\n\t\tif(ask(1, p + mid - 1) >= k) {\n\t\t\tR = mid;\n\t\t} else {\n\t\t\tL = mid + 1;\n\t\t}\n\t}\n\tres = p + R - 1;\n\tanswer(res);\n\tadd((res - 1) / SIZ + 1, -1);\n}\n\nint main() {\n\tscanf(\"%d%d\", &n, &q);\n\tint x;\n\tscanf(\"%d\", &x);\n\tfor(int i = 1; i <= n; i += SIZ) add(i / SIZ + 1, ask(i, i + SIZ - 1));\n\tsolve(x);\n\trep(i, 2, q) {\n\t\tscanf(\"%d\", &x);\n\t\tsolve(x);\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1620303072,
        "uid": 95103,
        "name": "KellyFrog",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1520F2 Guess the K-th Zero (Hard version)"
    },
    {
        "content": "\u9898\u89e3\u533a\u91cc\u600e\u4e48\u90fd\u7528\u4e86\u9ad8\u7ea7\u6570\u636e\u7ed3\u6784\u554a\uff0c\u7ebf\u6bb5\u6811\u4e8c\u5206\u8fd9\u79cd\u7b97\u6cd5\u5e76\u4e0d\u662f div3 \u7ea7\u522b\u7684\u5427\u3002\u8fd9\u91cc\u7ed9\u51fa\u4e00\u79cd\u6ca1\u6709\u4efb\u4f55\u6570\u636e\u7ed3\u6784\u7684\u7b80\u5355\u505a\u6cd5\uff0c\u5199\u8d77\u6765\u5f88\u8212\u670d\u3002\n\n\u9996\u5148\uff0c\u4e00\u4e2a\u5f88\u76f4\u89c2\u7684\u60f3\u6cd5\u662f\u6bcf\u6b21\u8be2\u95ee\u76f4\u63a5\u4e8c\u5206\u7b2c $k$ \u4e2a $0$ \u7684\u4f4d\u7f6e\uff0c\u8fd9\u662f\u975e\u5e38\u7b80\u5355\u7684\uff0c\u4f46\u8be2\u95ee\u6b21\u6570\u4f1a\u8fbe\u5230 $t\\log_2 n$\uff0c\u8d85\u8fc7\u4e86\u6700\u5927\u8be2\u95ee\u6b21\u6570\uff0c\u5e76\u4e0d\u53ef\u884c\u3002\n\n\u6ce8\u610f\u5230\u4e00\u4ef6\u4e8b\uff1a\u7531\u4e8e\u6bcf\u6b21\u67e5\u8be2\u4e4b\u95f4\uff0c\u53ea\u6539\u52a8\u4e86\u4e00\u4e2a\u4f4d\u7f6e\u7684\u6570\u503c\uff0c\u6240\u4ee5\u66b4\u529b\u4e8c\u5206\u7684\u505a\u6cd5\u5b9e\u9645\u4e0a\u8fdb\u884c\u4e86\u5f88\u591a\u65e0\u7528\u7684\u67e5\u8be2\u3002\u6bd4\u5982\u8bf4\uff0c\u6839\u636e\u4e8c\u5206\u7684\u601d\u8def\uff0c\u7b2c\u4e00\u6b21\u67e5\u8be2\uff0c\u6211\u4eec\u9996\u5148\u95ee\u4e86 $x=[1,n/2]$\uff1b\u7b2c\u4e8c\u6b21\u67e5\u8be2\uff0c\u6211\u4eec\u53c8\u9996\u5148\u95ee\u4e86 $y=[1,n/2]$\uff0c\u800c\u8fd9\u7b2c\u4e8c\u6b21\u663e\u7136\u662f\u4e0d\u5fc5\u8981\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u7b2c\u4e00\u6b21\u67e5\u8be2\u65f6 $1$ \u7684\u4f4d\u7f6e\u548c $x$ \u63a8\u51fa $y$ \u662f $x$ \u8fd8\u662f $x+1$\u3002\n\n\u4e8e\u662f\uff0c\u8003\u8651\u5c06\u539f\u5e8f\u5217\u6bcf $B$ \u4e2a\u5206\u6210\u4e00\u5757\uff0c\u4e00\u5171\u5206\u6210\u5927\u7ea6 $\\text{cnt}=n/B$ \u5757\u3002\u5b9e\u65f6\u7ef4\u62a4\u6bcf\u5757 $0$ \u7684\u4e2a\u6570 $c_i$\u3002\u5177\u4f53\u600e\u4e48\u64cd\u4f5c\u5462\uff1f\u5728\u6240\u6709\u8be2\u95ee\u7684\u6700\u521d\uff0c\u6211\u4eec\u66b4\u529b\u8be2\u95ee\u6bcf\u5757 $0$ \u7684\u4e2a\u6570\uff1b\u800c\u6bcf\u6b21\u67e5\u8be2\u8fc7\u540e\uff0c\u4fee\u6539\u5176\u4e2d\u67d0\u4e00\u5757 $0$ \u7684\u4e2a\u6570\u5373\u53ef\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u5728\u67e5\u8be2\u65f6\uff0c\u6211\u4eec\u5148\u627e\u51fa\u8fd9\u4e2a $0$ \u7684\u6240\u5728\u5757\u7f16\u53f7 $id$\uff1a\u4ece\u524d\u5f80\u540e\u626b\u63cf\u6bcf\u4e00\u5757\uff0c\u76f4\u5230 $\\sum_{i=1}^{id}c_i\\geq k$\uff0c\u7136\u540e\u5728\u7f16\u53f7\u4e3a $id$ \u5757\u4e2d\u4e8c\u5206\u5b83\u7684\u4f4d\u7f6e\u5c31\u53ef\u4ee5\u4e86\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u6211\u4eec\u7684\u8be2\u95ee\u6b21\u6570\u5c31\u53d8\u6210\u4e86 $n/B+t\\log_{2}B$\uff0c\u53d6 $B=32$\uff0c\u8fd9\u4e2a\u6b21\u6570\u4e0d\u8d85\u8fc7 $56250$\u3002\u6839\u636e $n$ \u548c $t$ \u7684\u503c\u786e\u5b9a\u6700\u4f18\u7684 $B$ \u4e5f\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$\\mathcal{O}(t(n/B+\\log B))$\uff0c\u7a33\u8fc7\u4e14\u597d\u5199\u3002\n\n[code](https://codeforces.com/contest/1520/submission/189204104)",
        "postTime": 1673695253,
        "uid": 131591,
        "name": "\u849f\u84bb\u541bHJT",
        "ccfLevel": 7,
        "title": "CF1520F2 Guess the K-th Zero (Hard version) \u9898\u89e3"
    },
    {
        "content": "# CF1520F2 \u9898\u89e3\n\n\n\n## \u601d\u8def\u5206\u6790\n\n\u7b80\u5355\u7248\u672c\u662f\u975e\u5e38\u5bb9\u6613\u89e3\u51b3\u7684\uff0c\u76f4\u63a5\u5728\u539f\u5e8f\u5217\u4e0a\u8fdb\u884c\u4e8c\u5206\uff0c\u6bcf\u6b21\u68c0\u67e5 $1\\sim x$ \u4e2d $0$ \u7684\u4e2a\u6570\u662f\u5426\u8d85\u8fc7 $k$ \u5373\u53ef\uff0c\u8be2\u95ee\u6b21\u6570 $\\log_2 n$ \u6b21\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u56f0\u96be\u7248\u672c\uff0c\u6700\u663e\u7136\u7684\u505a\u6cd5\u662f\u590d\u5236\u5bb9\u6613\u7248\u672c $t$ \u6b21\uff0c\u6bcf\u6b21\u76f4\u63a5\u5bf9\u6bcf\u6b21\u8be2\u95ee\u90fd\u8fdb\u884c\u4e8c\u5206\uff0c\u8be2\u95ee\u6b21\u6570 $t\\log_2n$ \u6b21\uff0c\u8d85\u8fc7\u4e86\u9898\u76ee\u4e2d\u7684\u9650\u5236\u3002\n\n\u8003\u8651\u4f18\u5316\uff0c\u5047\u8bbe\u6bcf\u6b21\u731c\u5230 $x$ \u540e\u4e0d\u4f1a\u4fee\u6539 $a_x$ \u7684\u503c\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u8bb0\u5fc6\u5316\uff0c\u5373\u5bf9\u91cd\u590d\u7684\u8be2\u95ee\u76f4\u63a5\u8fd4\u56de\u7b54\u6848\u3002\n\n\u800c\u6bcf\u6b21\u4fee\u6539 $a_x$ \u7684\u503c\u4e5f\u53ef\u4ee5\u7c7b\u4f3c\u89e3\u51b3\uff0c\u5047\u8bbe\u6211\u4eec\u7ef4\u62a4 $b_x$ \u8868\u793a $a_1\\sim a_x$ \u7684\u548c\uff0c\u90a3\u4e48\u6bcf\u79cd\u64cd\u4f5c\u5bf9 $\\{b_i\\}$ \u7684\u8d21\u732e\u5982\u4e0b\uff1a\n\n- \u4fee\u6539 $a_x$ \u4e3a $1$\uff0c\u5bf9\u4e8e\u6240\u6709 $i\\in[x,n]$\uff0c\u4f7f $b_i\\gets b_i+1$\u3002\n- \u8be2\u95ee `? 1 x`  \u7684\u7b54\u6848\u4e3a $p$\uff0c\u4f7f $b_i\\gets p$\u3002\n\n\u56e0\u6b64\u6211\u4eec\u8981\u7ef4\u62a4 $\\{b_i\\}$ \u652f\u6301\u5355\u70b9\u67e5\u503c\uff0c\u5355\u70b9\u8986\u76d6\u548c\u533a\u95f4\u52a0\uff0c\u663e\u7136\u7528\u7ebf\u6bb5\u6811\u6216\u6811\u72b6\u6570\u7ec4\u968f\u4fbf\u7ef4\u62a4\u4e00\u4e0b\u5373\u53ef\u3002\n\n\u8ba1\u7b97\u4e00\u4e0b\u8bb0\u5fc6\u5316\u540e\u7684\u8be2\u95ee\u6b21\u6570\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u4e8c\u5206\u7684\u8fc7\u7a0b\u8f6c\u6210\u5728\u7ebf\u6bb5\u6811\u4e0a\u9010\u6b65\u5411\u4e0b\u7684\u8fc7\u7a0b\uff0c\u90a3\u4e48\u8be2\u95ee\u6b21\u6570\u5c31\u662f\u5728\u4e00\u68f5\u52a8\u6001\u5f00\u70b9\u7ebf\u6bb5\u6811\u4e2d\u63d2\u5165 $t$ \u4e2a\u4f4d\u7f6e\u540e\uff0c\u52a8\u6001\u5f00\u70b9\u7ebf\u6bb5\u6811\u7684\u5927\u5c0f\uff0c\u56e0\u6b64\u7b54\u6848\u4e3a $\\sum_{i=0}^{\\left\\lceil\\log_2n\\right\\rceil}\\min(2^i,t)$\uff0c\u5728 $n=2\\times  10^5,t=10^4$ \u65f6\uff0c\u8be2\u95ee\u6b21\u6570\u4e3a $1+2+4+\\cdots+8192+10^4+10^4+10^4+10^4=56383$ \u6b21\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(t\\log^2 n)$\u3002\n\n## \u4ee3\u7801\u5448\u73b0\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long \nusing namespace std;\nconst int MAXN=2e5+1;\ninline int read(int l,int r) {\n\tcout<<\"? \"<<l<<\" \"<<r<<endl;\n\tint ret; cin>>ret; return ret;\n}\nint n,T,k;\nstruct BitTree {\n\tint tree[MAXN];\n\tinline int lowbit(int x) { return x&-x; }\n\tinline void update(int x,int v) {\n\t\tfor(;x<=n;x+=lowbit(x)) tree[x]+=v;\n\t}\n\tinline void Modify(int l,int r,int v) {\n\t\tupdate(l,v);\n\t\tif(r<n) update(r+1,-v);\n\t}\n\tinline int Query(int x) {\n\t\tint ret=0;\n\t\tfor(;x;x-=lowbit(x)) ret+=tree[x];\n\t\treturn ret;\n\t}\n}\tB;\nbool vis[MAXN];\ninline int query(int x) {\n\tif(vis[x]) return B.Query(x);\n\tvis[x]=true;\n\tint p=read(1,x);\n\tB.Modify(x,x,p-B.Query(x));\n\treturn p;\n}\ninline bool check(int x) {\n\treturn x-query(x)>=k;\n}\nsigned main() {\n\tcin>>n>>T;\n\twhile(T--) {\n\t\tcin>>k;\n\t\tint l=1,r=n,res=0;\n\t\twhile(l<=r) {\n\t\t\tint mid=(l+r)>>1;\n\t\t\tif(check(mid)) res=mid,r=mid-1;\n\t\t\telse l=mid+1;\n\t\t}\n\t\tB.Modify(res,n,1);\n\t\tcout<<\"! \"<<res<<endl;\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1673169193,
        "uid": 539618,
        "name": "DaiRuiChen007",
        "ccfLevel": 6,
        "title": "CF1520F2 \u9898\u89e3"
    }
]
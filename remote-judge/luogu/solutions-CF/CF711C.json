[
    {
        "content": " [\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.org/problem/CF711C)\r\n\r\n **\u9898\u76ee\u5927\u610f**\uff1a\u6709 n \u68f5\u6811\uff0c m \u79cd\u989c\u6599\uff0c\u8981\u6c42\u73b0\u5728\u8981\u7ed9\u8fd9\u4e9b\u6811\u6d82\u4e0a\u989c\u6599\r\n>> \u6700\u540e\u6d82\u6210 k \u6bb5\uff08\u8fde\u7eed\u989c\u8272\u76f8\u540c\u5212\u4e3a\u4e00\u6bb5\u5982 2 ,\u20091 , 1 ,\u20091 ,\u20093 ,\u20092 ,\u20092 ,\u20093 ,\u20091 ,\u20093 \u662f7\u6bb5\uff09\r\n>> \u6709\u4e9b\u6811\u5df2\u7ecf\u6d82\u4e86\uff0c\u5219\u4e0d\u6d82\u4e86\u53ea\u80fd\u6d82\u4e00\u6b21\uff0c\u8f93\u5165n\u4e2a\u6570\uff08\u6bcf\u4e2a\u6570\u4e3a0~m\uff09\uff0c0\u8868\u793a\u8fd8\u6ca1\u6709\u6d82\uff0c1~m\u8868\u793a\u5df2\u7ecf\u6d82\u4e86\u54ea\u79cd\u989c\u6599\u3002\r\n>> \u63a5\u4e0b\u6765\u8f93\u5165 n \u884c m \u5217\uff0c\u8868\u793a\u6bcf\u68f5\u6811\u6d82\u6210\u6bcf\u79cd\u989c\u8272\u6240\u8981\u7684\u989c\u6599\u91cf\u3002\r\n>> \u73b0\u5728\u8981\u628a\u6240\u6709\u6811\u90fd\u6d82\u4e0a\u989c\u6599\u6d82\u6210 k \u6bb5\uff0c\u6c42\u6700\u5c11\u8981\u7528\u7684\u989c\u6599\u91cf\u3002\r\n\r\n \u6570\u636e\u8303\u56f4\uff1an , m <=100\r\n\r\n \u9996\u5148\uff0c\u6839\u636e\u8303\u56f4\u6211\u4eec\u5f88\u5bb9\u6613\u60f3\u5230\u8fd9\u662f\u4e00\u9053\u4e09\u7ef4DP\r\n\r\n \u90a3\u4e48$dp[i][j][k]$\u7684\u542b\u4e49\u5c31\u662f\r\n> \u524d$i$\u4e2a\u70b9\r\n> \u5206\u6210$j$\u6bb5\r\n> \u6700\u540e\u4e00\u6bb5\u989c\u8272\u662f$k$\u7684\u6700\u5c0f\u4ee3\u4ef7\r\n\r\n \u72b6\u6001\u65b9\u7a0b\u5f88~~\u5bb9\u6613~~\u5c31\u63a8\u51fa\u6765\u4e86\r\n\r\n \u8981\u6ce8\u610f\u672c\u8eab\u5c31\u6709\u989c\u8272\u7684\u60c5\u51b5\r\n\r\n \u7ec6\u8282\u8be6\u89c1\u4ee3\u7801\u6ce8\u91ca\uff1a\r\n\r\n\r\n```c++\r\n#include<bits/stdc++.h>\r\n#define N 105\r\n#define R register\r\n#define LL long long \r\n#define inf 0x7f7f7f7f7f7f//inf\u4e0d\u80fd\u5f00\u5c0f\u4e86\uff0c\u4e0d\u7136\u4f1aWA\r\nusing namespace std;\r\ninline LL read(){\r\n\tLL f=1,x=0; char ch=getchar();\r\n\twhile(ch<'0'||ch>'9'){if(ch=='-') f=-1;ch=getchar();}\r\n\twhile(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+ch-'0';ch=getchar();}\r\n\treturn x*f;\r\n}//\u5feb\u8bfb\uff0c\u4f46\u597d\u50cf\u6ca1\u7528\r\ninline LL maxx(LL x,LL y){return x>y?x:y;}\r\ninline LL minn(LL x,LL y){return x<y?x:y;}//\u81ea\u5b9a\u4e49min\u51fd\u6570\uff08\u7a0d\u5fae\u5feb\u4e00\u70b9\uff09\r\nLL n,m,k,ans=inf,co[N],w[N][N],dp[N][N][N];\r\nint main()\r\n{\r\n\tscanf(\"%lld%lld%lld\",&n,&m,&k);\r\n\tfor (LL i=1;i<=n;i++) scanf(\"%lld\",&co[i]);\r\n\tfor (LL i=1;i<=n;i++)\r\n\t\tfor (LL j=1;j<=m;j++) scanf(\"%lld\",&w[i][j]);\r\n\tmemset(dp,inf,sizeof(dp));//\u5148\u521d\u59cb\u5316\u4e3a\u6781\u5927\u503c\r\n\tif (co[1]) dp[1][1][co[1]]=0;//\u5982\u679c\u7b2c\u4e00\u4e2a\u70b9\u6709\u989c\u8272\u5c31\u6ca1\u6709\u4ee3\u4ef7\r\n\telse for (LL i=1;i<=m;i++) dp[1][1][i]=w[1][i];//\u5426\u5219\u8d4b\u4ee3\u4ef7\r\n\tfor (LL i=2;i<=n;i++)\r\n\tfor (LL j=1;j<=k&&j<=i;j++){\r\n\t\tif (co[i]){//\u6709\u989c\u8272\uff08\u65e0\u4ee3\u4ef7\uff09\r\n\t\t\tfor (LL l=1;l<=m;l++){\r\n\t\t\t\tif (co[i]==l) dp[i][j][l]=minn(dp[i][j][l],dp[i-1][j][l]);//\u4e00\u6837\u5c31\u4f5c\u4e3a\u8fde\u7eed\u4e00\u6bb5\r\n\t\t\t\telse dp[i][j][co[i]]=minn(dp[i][j][co[i]],dp[i-1][j-1][l]);//\u4e0d\u4e00\u6837\u5c31\u65b0\u5f00\u4e00\u6bb5\r\n\t\t\t}\r\n\t\t}else{//\u6ca1\u989c\u8272\uff08\u6709\u4ee3\u4ef7\uff09\r\n\t\t\tfor (LL l=1;l<=m;l++)\r\n\t\t\tfor (LL p=1;p<=m;p++)\r\n\t\t\t\tif (l==p) dp[i][j][l]=minn(dp[i][j][l],dp[i-1][j][p]+w[i][l]);//\u4e00\u6837\u662f\u8fde\u7eed\u4e00\u6bb5\r\n\t\t\t\telse dp[i][j][l]=minn(dp[i][j][l],dp[i-1][j-1][p]+w[i][l]);//\u4e0d\u4e00\u6837\u65b0\u5f00\u4e00\u6bb5\r\n\t\t}\r\n\t}\r\n\tif (co[n]) ans=dp[n][k][co[n]];//\u6700\u540e\u4e00\u4e2a\u6709\u989c\u8272\u5c31\u53ea\u80fd\u4ee5\u90a3\u79cd\u989c\u8272\u7ed3\u5c3e\r\n\telse for (LL i=1;i<=m;i++) ans=minn(ans,dp[n][k][i]);//\u5426\u5219\u5168\u90e8\u679a\u4e3e\u4e00\u904d\r\n\tprintf(\"%lld\",(ans<inf)?ans:-1);//\u8bb0\u5f97\u8981\u5224\u65ad\u65e0\u89e3\r\n    return 0;\r\n}\r\n```\r\n\r\n \u8fd8\u6709\u7591\u95ee\u79c1\u4fe1\u6211QWQ",
        "postTime": 1571661083,
        "uid": 64175,
        "name": "qian_shang",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF711C \u3010Coloring Trees\u3011"
    },
    {
        "content": "[CF711C Coloring Trees](https://www.luogu.com.cn/problem/CF711C)\n\n\u539f\u9898\u7f51\u5740\uff1a[Codeforces Round #369 (Div. 2)C. Coloring Trees](https://codeforces.com/problemset/problem/711/C)\n\n\u8fd9\u9053\u9898\u7684\u9898\u610f\u5f88\u597d\u7406\u89e3\uff0c\u6240\u4ee5\u76f4\u5954\u4e3b\u9898\n\n\u5148\u8bbe\u7f6e\u4e00\u4e2a $DP$ \u51fd\u6570 \uff1a\n\n$$\ndp[iterator][colour][k]\n$$\n\n\u8fd9\u4e2a\u51fd\u6570\u610f\u4e49\u4e3a\uff0c\u5728\u7b2c $i$ \u68f5\u6811\uff0c\u67d3\u4e3a\u7b2c $colour$ \u7684\u989c\u8272\uff0c\u5206\u6210\u4e86 $k$ \u6bb5\u7684\u6700\u5c0f\u82b1\u8d39\u3002\n\n\u4e4b\u540e\u5206\u7c7b\u8ba8\u8bba\n\n- \u8fd9\u68f5\u6811\u539f\u672c\u88ab\u67d3\u8272\u4e86\n\n\u6240\u4ee5\u8fd9\u68f5\u6811\u989c\u8272\u4e0d\u53d8\uff0c\u72b6\u6001\u76f4\u63a5\u4ece\u524d\u4e00\u68f5\u6811\u7ee7\u627f\u3002\n\n$$\ndp[i][colour[i]][tmp] = min(dp[i][colour[i]][tmp],dp[i-1][last][tmp - (last == colour[i] ? 0 : 1)]);\n$$\n\n- \u8fd9\u68f5\u6811\u539f\u672c\u6ca1\u88ab\u67d3\u8272\n\n\u8fd9\u68f5\u6811\u53ef\u4ee5\u67d3\u6210\u4efb\u4f55\u7684\u989c\u8272\uff0c\u6240\u4ee5\u5728\u7ee7\u627f\u7684\u57fa\u7840\u4e0a\u52a0\u4e0a\u67d3\u8272\u82b1\u8d39\n\n$$\ndp[i][j][tmp] = min(dp[i][j][tmp],dp[i-1][last][tmp - (last == j ? 0 : 1)] + cost[i][j]);\n$$\n\n\u5bf9\u7b2c\u4e00\u68f5\u6811\u8fdb\u884c\u64cd\u4f5c\uff0c\u521d\u59cb\u5316 $DP$ \u6570\u7ec4\uff08\u9884\u5148\u8bbe\u4e3a\u6b63\u65e0\u9650\uff09\uff0c\u4e4b\u540e\u4ece\u7b2c\u4e8c\u8bfe\u6811\u5f00\u59cb\u8fdb\u884c $DP$ \u3002\n\n# code\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\nconst int SIZE = 150;\n\ninline int read()\n{\n\tint x = 0,f = 1;\n\tchar ch = getchar();\n\twhile (ch < '0' || ch > '9')\n\t{\n\t\tif (ch == '-') f = -1;\n\t\tch = getchar();\n\t}\n\twhile (ch >= '0' && ch <= '9')\n\t{\n\t\tx = (x << 1) + (x << 3) + (ch ^ 48);\n\t\tch = getchar();\n\t}\n\treturn f * x;\n}\n\nint n,m,k;\nint num[SIZE];\nint cost[SIZE][SIZE],dp[SIZE][SIZE][SIZE];\n\nsigned main()\n{\n\tmemset(dp,0x3f,sizeof(dp));\n\tn = read();m = read();k = read();\n\tfor (int i = 1; i <= n; ++i)\n\t{\n\t\tnum[i] = read();\n\t}\n\tfor (int i = 1; i <= n; ++i)\n\t{\n\t\tfor (int j = 1; j <= m; ++j)\n\t\t{\n\t\t\tcost[i][j] = read();\n\t\t}\n\t}\n\tif (num[1]) dp[1][num[1]][1] = 0;\n\telse \n\t{\n\t\tfor (int i = 1; i <= m; ++i)\n\t\t{\n\t\t\tdp[1][i][1] = cost[1][i];\n\t\t}\n\t}\n\tfor (int i = 2; i <= n; ++i)\n\t{\n\t\tif (num[i] != 0)\n\t\t{\n\t\t\tfor (int tmp = 1; tmp <= k; ++tmp)\n\t\t\t{\n\t\t\t\tfor (int last = 1; last <= m; ++last)\n\t\t\t\t{\n\t\t\t\t\tdp[i][num[i]][tmp] = min(dp[i][num[i]][tmp],dp[i-1][last][tmp - (last == num[i] ? 0 : 1)]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tfor (int j = 1; j <= m; ++j)\n\t\t{\n\t\t\tfor (int tmp = 1; tmp <= k; ++tmp)\n\t\t\t{\n\t\t\t\tfor (int last = 1; last <= m; ++last)\n\t\t\t\t{\n\t\t\t\t\tdp[i][j][tmp] = min(dp[i][j][tmp],dp[i-1][last][tmp - (last == j ? 0 : 1)] + cost[i][j]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint ans = 0x7f7f7f7f7f7f;\n\tfor (int i = 1; i <= m; ++i)\n\t{\n\t\tans = min(ans,dp[n][i][k]);\n\t}\n\tif (ans >= 0x7f7f7f7f7f7f) printf(\"-1\\n\"); // \u8bb0\u5f97\u5224\u65e0\u89e3\n\telse printf(\"%lld\\n\",ans);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1603804401,
        "uid": 415231,
        "name": "nomonick",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF711C \u3010Coloring Trees\u3011"
    },
    {
        "content": "# $DP$\n\n$a[i]$\u8868\u793a\u7b2c$i$\u68f5\u6811\u7684\u989c\u8272\n\n$col[i][j]$\u8868\u793a\u7b2c$i$\u68f5\u6811\u6d82\u6210\u989c\u8272$j$\u6240\u9700\u8981\u7684\u989c\u6599\u91cf\n\n\u5f88\u5bb9\u6613\u60f3\u5230$DP$\u7684\u505a\u6cd5\n\n$f[i][j][k]$\u8868\u793a\u6d82\u5b8c\u524d$i$\u68f5\u6811\uff0c\u6d82\u6210$j$\u6bb5\uff0c\u7b2c$i$\u68f5\u6811\u6d82\u6210\u989c\u8272$k$\u65f6\uff0c\u6700\u5c11\u9700\u8981\u7684\u989c\u6599\u91cf\n\n\u5206\u4e3a\u4e24\u79cd\u60c5\u51b5\u8ba8\u8bba\uff1a\n\n### $1.$\u7b2c$i$\u68f5\u6811\u5df2\u88ab\u6d82\u8272\n\n$$ f[i][j][a[i]]=\\max\\begin{cases}\nf[i-1][j][a[i]]  \\\\\n\\max\\limits_{1\u2264t\u2264m,t\u2260a[i]}f[i-1][j-1][t] \n\\end{cases}\n$$\n\n### $2.$\u7b2c$i$\u68f5\u6811\u672a\u88ab\u6d82\u8272\n\n$$ f[i][j][l]=\\max\\begin{cases}\n\nf[i-1][j][l]+col[i][l]  \\\\\n\n\\max\\limits_{1\u2264t\u2264m,t\u2260l} \\{f[i-1][j-1][t]+col[i][l]\\} \n\n\\end{cases}\n$$\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(nkm^2)$\n\n\u7a7a\u95f4\u590d\u6742\u5ea6\uff1a$O(nkm)$\n\n\u5b9e\u9645\u4e0a\u5df2\u7ecf\u53ef\u4ee5$AC$\u4e86\n\n\u4f46\u662f\u6211\u4eec\u8003\u8651\u4f18\u5316\n\n## \u7a7a\u95f4\u4f18\u5316\uff1a\n\n\u5e38\u89c4\u64cd\u4f5c\uff0c\u6211\u4eec\u89c2\u5bdf\u5230$f[i][\u2026][\u2026]$\u53ea\u4e0e$f[i-1][\u2026][\u2026]$\u6709\u5173\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u6eda\u52a8\u6570\u7ec4\uff0c\u4ece\u800c\u4f18\u5316\u7a7a\u95f4\u590d\u6742\u5ea6\n\n## \u65f6\u95f4\u4f18\u5316\uff1a\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u7b2c\u4e8c\u79cd\u60c5\u51b5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u8f83\u5927\uff0c\u5c1d\u8bd5\u4f18\u5316\u8fd9\u79cd\u60c5\u51b5\n\n\u89c2\u5bdf\u4e00\u4e0b\u8fd9\u4e2a\u5f0f\u5b50\uff1a\n\n$$ f[i][j][l]=\\max\\begin{cases}\n\nf[i-1][j][l]+col[i][l]  \\\\\n\n\\max\\limits_{1\u2264t\u2264m,t\u2260l} \\{f[i-1][j-1][t]+col[i][l]\\} \n\n\\end{cases}\n$$\n\n\u8f6c\u5316\u4e3a\uff1a\n\n$$ f[i][j][l]=col[i][l]+\\max\\begin{cases}\n\nf[i-1][j][l]  \\\\\n\n\\max\\limits_{1\u2264t\u2264m,t\u2260l} \\{f[i-1][j-1][t]\\} \n\n\\end{cases}\n$$\n\n$\\max\\limits_{1\u2264t\u2264m,t\u2260l} \\{f[i-1][j-1][t]\\}$\u5982\u4f55\u8ba1\u7b97\n\n$RMQ?$\n\n\u6ca1\u9519\uff0c\u6211\u4eec\u53ef\u4ee5\u7528$ST$\u8868\u8fdb\u884c\u5904\u7406\uff0c\u7136\u540e\u5c06$[1,l-1],[l+1,m]$\u4e24\u6bb5\u533a\u95f4\u7684\u6700\u5927\u503c\u76f4\u63a5\u4ece$ST$\u8868\u4e2d\u53d6\u51fa\u5c31\u597d\u4e86\uff01\n\n\u4f18\u5316\u540e\uff1a\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(nkm\u00b7logm)$\n\n\u7a7a\u95f4\u590d\u6742\u5ea6\uff1a$O(km)$\n\n$C$++ $Code:$\n\n```cpp\n#include<bits/stdc++.h>\n#define N 105\nusing namespace std;\nint n,m,s,a[N],col[N][N],lg2[N],r1,r2,r3;\nlong long dp[2][N][N];\nlong long st[N][N];\ninline int read()\n{\n\tint s=0;\n\tchar c=getchar();\n\twhile (c<'0'||c>'9')\n\t\tc=getchar();\n\twhile ('0'<=c&&c<='9')\n\t\ts=s*10+c-'0',c=getchar();\n\treturn s;\n}\ninline long long gm(int s,int t)\n{\n\tif (s>t)\n\t\treturn 12345678987654321;\n\tint k=lg2[t-s+1];\n\treturn min(st[s][k],st[t-(1 << k)+1][k]);\n}\nint main() \n{\n\tn=read(),m=read(),s=read();\n\tfor (int i=1;i<=n;i++)\n\t\ta[i]=read();\n\tfor (int i=1;i<=n;i++)\n\t\tfor (int j=1;j<=m;j++)\n\t\t\tcol[i][j]=read();\n\tfor (int i=0;i<2;i++)\n\t\tfor (int j=0;j<=s;j++)\n\t\t\tfor (int k=0;k<=m;k++)\n\t\t\t\tdp[i][j][k]=12345678987654321;\n\tlg2[0]=-1;\n\tfor (int i=1;i<=m;i++)\n\t\tlg2[i]=lg2[i/2]+1;\n\tif (a[1])\n\t\tdp[1][1][a[1]]=0; else\n\t\t{\n\t\t\tfor (int k=1;k<=m;k++)\n\t\t\t\tdp[1][1][k]=col[1][k];\n\t\t}\n\tfor (int pre=1,now=0,i=2;i<=n;pre=i&1,i++,now=i&1)\n\t{\n\t\tfor (int j=0;j<=s;j++)\n\t\t\tfor (int k=0;k<=m;k++)\n\t\t\t\tdp[now][j][k]=12345678987654321;\n\t\tr1=min(i,s);\n\t\tfor (int j=1;j<=r1;j++)\n\t\t{\n\t\t\tif (a[i])//\u7b2c\u4e00\u79cd\u60c5\u51b5\n\t\t\t{\n\t\t\t\tfor (int k=1;k<=m;k++)\n\t\t\t\t\tif (a[i]^k)\n\t\t\t\t\t\tdp[now][j][a[i]]=min(dp[now][j][a[i]],dp[pre][j-1][k]); else\n\t\t\t\t\t\tdp[now][j][a[i]]=min(dp[now][j][a[i]],dp[pre][j][k]);\n\t\t\t} else//\u7b2c\u4e8c\u79cd\u60c5\u51b5\n\t\t\t{ //\u5efa\u7acbST\u8868\n\t\t\t\tfor (int k=1;k<=m;k++)\n\t\t\t\t\tst[k][0]=dp[pre][j-1][k];\n\t\t\t\tfor (int k=1;k<=lg2[m];k++)\n\t\t\t\t\tfor (int l=1;l<=m-(1 << k)+1;l++)\n\t\t\t\t\t\tst[l][k]=min(st[l][k-1],st[l+(1 << (k-1))][k-1]);\n\t\t\t\tfor (int k=1;k<=m;k++)\n\t\t\t\t\tdp[now][j][k]=min(dp[now][j][k],min(dp[pre][j][k],min(gm(1,k-1),gm(k+1,m)))+col[i][k]);\n\t\t\t}\n\t\t}\n\t}\n\tlong long ans=12345678987654321;\n\tfor (int i=1,now=n&1;i<=m;i++)\n\t\tans=min(ans,dp[now][s][i]);\n\tif (ans==12345678987654321)\n\t\tans=-1;\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1594897261,
        "uid": 10341,
        "name": "GK0328",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF711C \u3010Coloring Trees\u3011"
    },
    {
        "content": "\u7ec8\u6781n^4DP\u6765\u4e5f\uff01\n\nfirst,n,m<=100\uff0c\u4e00\u770b\u5c31\u7279\u522b\u66b4\u529b\n\n\u7136\u540e\uff0c\u6211\u4eec\u5b9a\u4e49```dp[i][j][k]```\u4e3a**\u6d82\u5230\u7b2ci\u68f5\u6811\uff0c\u4e00\u5171\u6709j\u6bb5\u989c\u8272\uff0c\u4e0a\u4e00\u4e2a\u989c\u8272\u662fk\u7684\u6700\u5c0f\u82b1\u8d39**\n\n\u8f6c\u79fb\u65f6\u6211\u4eec\u679a\u4e3e\u4e0a\u4e00\u4e2a\u989c\u8272\u548c\u8fd9\u4e00\u4e2a\u989c\u8272\uff08\u5982\u679c\u5df2\u6d82\u5219\u4e0d\u7528\u679a\u4e3e\uff09\n\n\u5982\u679c\u5f53\u524d\u7684\u989c\u8272=\u4e0a\u4e00\u4e2a\u989c\u8272\uff0c\u5219\u5c06```dp[i-1][j][k]```\u8f6c\u79fb\u5230```dp[i][j][k]```\n\n\u5426\u5219\uff0c\u5219\u5c06```dp[i-1][j-1][k]```\u8f6c\u79fb\u5230```dp[i][j][l]```\n\ncode:\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#define ll long long\nusing namespace std;\nll dp[110][110][110],a[110][110];\nint n,m,p,col[110];\nint main()\n{\n\tscanf(\"%d%d%d\",&n,&m,&p);\n\tfor(int i=1;i<=n;i++)\n\tscanf(\"%d\",&col[i]);\n\tfor(int i=1;i<=n;i++)\n\tfor(int j=1;j<=m;j++)\n\tscanf(\"%lld\",&a[i][j]);\n\tfor(int i=0;i<=n;i++)\n\tfor(int j=0;j<=p;j++)\n\tfor(int k=1;k<=m;k++)\n\tdp[i][j][k]=1e17;//\u521d\u59cb\u5316\n\tfor(int i=1;i<=m;i++)\n\tdp[0][0][i]=dp[0][1][i]=0;//\u8fd9\u4e2a\u521d\u59cb\u5316\u5f88\u91cd\u8981\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1;j<=i&&j<=p;j++)\n\t\t{\n\t\t\tif(col[i])//\u7279\u5224\u662f\u5426\u5df2\u6709\u989c\u8272\n\t\t\t{\n\t\t\t\tif(col[i-1])//\u540c\u7406\n\t\t\t\t{\n\t\t\t\t\tif(col[i]==col[i-1])\n\t\t\t\t\tdp[i][j][col[i]]=min(dp[i][j][col[i]],dp[i-1][j][col[i-1]]);\n\t\t\t\t\telse\n\t\t\t\t\tdp[i][j][col[i]]=min(dp[i][j][col[i]],dp[i-1][j-1][col[i-1]]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tfor(int l=1;l<=m;l++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(l==col[i])\n\t\t\t\t\t\tdp[i][j][col[i]]=min(dp[i][j][col[i]],dp[i-1][j][l]);\n\t\t\t\t\t\telse\n\t\t\t\t\t\tdp[i][j][col[i]]=min(dp[i][j][col[i]],dp[i-1][j-1][l]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor(int k=1;k<=m;k++)\n\t\t\t\t{\n\t\t\t\t\tif(col[i-1])\n\t\t\t\t\t{\n\t\t\t\t\t\tif(k==col[i-1])\n\t\t\t\t\t\tdp[i][j][k]=min(dp[i][j][k],dp[i-1][j][col[i-1]]+a[i][k]);\n\t\t\t\t\t\telse\n\t\t\t\t\t\tdp[i][j][k]=min(dp[i][j][k],dp[i-1][j-1][col[i-1]]+a[i][k]);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tfor(int l=1;l<=m;l++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif(l==k)\n\t\t\t\t\t\t\tdp[i][j][k]=min(dp[i][j][k],dp[i-1][j][l]+a[i][k]);\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\tdp[i][j][k]=min(dp[i][j][k],dp[i-1][j-1][l]+a[i][k]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tll ans=1e17;\n\tif(col[n])\n\tans=dp[n][p][col[n]];\n\telse\n\t{\n\t\tfor(int i=1;i<=m;i++)\n\t\tans=min(ans,dp[n][p][i]);\n\t}\n\tif(ans>=1e17)\n\tans=-1;\n\tprintf(\"%lld\",ans);\n}\n```\n",
        "postTime": 1572270599,
        "uid": 103029,
        "name": "James_Brady",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF711C \u3010Coloring Trees\u3011"
    },
    {
        "content": "\u8bb0 $f_{i,j,k}$ \u8868\u793a\u524d $i$ \u4e2a\u70b9\uff0c\u7b2c $i$ \u4e2a\u70b9\u67d3\u4e3a $j$\uff0c\u5206\u6210 $k$ \u6bb5\u7684\u6700\u5c0f\u82b1\u8d39\u3002\n\n\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n* \u7b2c $i$ \u4e2a\u70b9\u5df2\u88ab\u67d3\u8272\uff1a$f_{i,col_i,k}=\\min(f_{i,col_i,k},f_{i-1,lst,k-[lst \\ne col_i]})$\u3002\n* \u7b2c $i$ \u4e2a\u70b9\u672a\u88ab\u67d3\u8272\uff1a$f_{i,j,k}=\\min(f_{i,j,k},f_{i-1,lst,k-[lst\\ne j]}+cost_{i,j})$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(nkm^2)$\uff0c\u53ef\u7528 `st` \u8868\u4f18\u5316\u5230 $\\mathcal O(nkm\\log m)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\n#define int long long\n\ninline int read()\n{\n\tint x = 0, f = 1;\n\tchar c = getchar();\n\twhile (c < '0' || c > '9')\n\t{\n\t\tif (c == '-')\n\t\t\tf = -1;\n\t\tc = getchar();\n\t}\n\twhile (c >= '0' && c <= '9')\n\t\tx = x * 10 + c - '0', c = getchar();\n\treturn x * f;\n}\n\n#define inf 0x7f7f7f7f7f7f\n\nconst int _ = 208;\n\nint n, m, k, ans = inf, col[_], cost[_][_], dp[_][_][_];\n\nsigned main()\n{\n\tn = read(), m = read(), k = read();\n\tfor(int i = 1; i <= n; ++i) col[i] = read();\n\tfor(int i = 1; i <= n; ++i)\n\t\tfor(int j = 1; j <= m; ++j) cost[i][j] = read();\n\tmemset(dp, inf, sizeof dp);\n\tif(col[1]) dp[1][col[1]][1] = 0;\n\telse for(int i = 1; i <= m; ++i) dp[1][i][1] = cost[1][i];\n\tfor(int i = 2; i <= n; ++i)\n\t\tfor(int j = 1; j <= k && j <= i; ++j)\n\t\t\tif(col[i])\n\t\t\t{\n\t\t\t\tfor(int l = 1; l <= m; ++l)\n\t\t\t\t\tdp[i][col[i]][j] = min(dp[i][col[i]][j], dp[i - 1][l][j - (col[i] == l ? 0 : 1)]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor(int l = 1; l <= m; ++l)\n\t\t\t\t\tfor(int p = 1; p <= m; ++p)\n\t\t\t\t\t\tdp[i][l][j] = min(dp[i][l][j], dp[i - 1][p][j - (l == p ? 0 : 1)] + cost[i][l]);\n\t\t\t}\n\tif(col[n]) ans = dp[n][col[n]][k];\n\telse for(int i = 1; i <= m; ++i) ans = min(ans, dp[n][i][k]);\n\tprintf(\"%lld\", (ans < inf) ? ans : -1);\n\treturn 0;\n}\n```",
        "postTime": 1669855469,
        "uid": 257146,
        "name": "orz_z",
        "ccfLevel": 0,
        "title": "CF711C Coloring Trees"
    },
    {
        "content": "## \u7ecf\u5178\u5206\u7c7b\u5de8\u591a\u65e0\u6bd4\u7684dp\n\u9898\u76ee\u5927\u610f\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\uff0c\u6ca1\u770b\u8fc7\u7684\u770b[\u9898\u9762](https://www.luogu.com.cn/problem/CF711C)\n\u3002\n\n\u72b6\u6001\u5f88\u597d\u786e\u5b9a\uff1a\u7528$dp(i,j,k)$\u8868\u793a\u524d$i$\u68f5\u6811\uff0c\u67d3\u8272\u67d3\u6210$j$\u6bb5\uff0c\u6700\u540e\u4e00\u6bb5\u989c\u8272\u4e3a$k$\u65f6\u7684\u6700\u5c0f\u989c\u6599\u503c\u3002\n\n\u95ee\u9898\u5c31\u5728\u4e8e\u5206\u7c7b\uff1a\u9996\u5148\u5f88\u5bb9\u6613\u60f3\u5230\u5206\u4e3a\u5f53\u524d\u6811\u6728\u67d3\u8fc7\u548c\u6ca1\u67d3\u8fc7\u4e24\u79cd\u60c5\u51b5\uff08\u5df2\u7ecf\u67d3\u597d\u7684\u4e0d\u80fd\u518d\u67d3\uff09\u3002\n\n\u5982\u679c\u6811\u6728\u6ca1\u6709\u88ab\u67d3\u8fc7\u8272\uff0c\u90a3\u4e48\u67d3\u5230\u8fd9\u91cc\u7684\u6700\u5c0f\u4ee3\u4ef7\u5c31\u4e0e\u5b83\u7684\u524d\u4e00\u68f5\u6811\u7684\u67d3\u8272\u6709\u5173\u3002\n\n\u7528$k$\u8868\u793a\u5f53\u524d\u67d3\u8272\uff0c$l$\u8868\u793a\u524d\u4e00\u68f5\u6811\u7684\u67d3\u8272\uff0c\u5219\uff1a\n\n$if(k==l):$\n$dp(i,j,k)=min(dp(i,j,k),dp(i-1,j,l)+c(i,k))$\n\n$if(k!=l):$\n$dp(i,j,k)=min(dp(i,j,k),dp(i-1,j-1,l)+c(i,k))$\n\n\u8fd9\u91cc\u7528$c$\u6570\u7ec4\u6765\u8868\u793a\u6d82\u6bcf\u4e00\u68f5\u6811\u6240\u9700\u7684\u989c\u6599\u91cf\uff0c\u5176\u4ed6\u5e94\u8be5\u5c31\u5f88\u597d\u7406\u89e3\u4e86\u3002\n\n\u5982\u679c\u5f53\u524d\u6811\u6728\u5df2\u7ecf\u88ab\u67d3\u8fc7\u8272\u4e86\uff0c\u90a3\u4e48\u5c31\u4e0d\u7528\u679a\u4e3e\u5f53\u524d\u6811\u6728\u7684\u989c\u8272\uff08\u5373$dp(i,j,k)$\u4e2d\u7684$k$\u9879\uff09\u3002\n\n\u6b64\u65f6\u7528$k$\u679a\u4e3e\u524d\u4e00\u68f5\u6811\u7684\u989c\u8272\uff0c$t(i)$\u8868\u793a\u5f53\u524d\u6811\u6728\u7684\u989c\u8272\uff0c\u5219\u6709\uff1a\n\n$dp(i,j,t(i))=min(dp(i,j,t(i)),dp(i-1,j-(k==t(i)),k))$\n\n\u5e94\u8be5\u4e5f\u5f88\u597d\u7406\u89e3\uff0c\u4e0d\u591a\u53d9\u8ff0\uff08\u5176\u4e2d\u7684$k==t(i)$\u8868\u5224\u65ad\uff09\u3002\n\n\u6700\u540e\u7684\u7b54\u6848\u540c\u6837\u5206\u4e24\u79cd\u60c5\u51b5\uff1a\u5982\u679c\u6700\u540e\u4e00\u68f5\u6811\u662f\u67d3\u597d\u8272\u7684\uff0c\u90a3\u7b54\u6848\u5c31\u56fa\u5b9a\u4e3a$dp(n,p,t(n))$\uff08p\u662f\u9898\u4e2d\u8981\u6c42\u6700\u540e\u6d82\u6210\u7684\u6bb5\u6570\uff09\uff1b\u5982\u679c\u6700\u540e\u4e00\u68f5\u6811\u6ca1\u6709\u67d3\u8272\uff0c\u5219\u7b54\u6848\u662f$min(dp(n,p,i))(1<=i<=m)$\u3002\n\n\u6700\u540e\u6ce8\u610f\uff0c\u672c\u9898\u7684\u6570\u636e\u8303\u56f4\u662f$1<=c(i,j)<=10^9$\uff0c\u6240\u4ee5\u9700\u8981\u5f00$long long$\u3002\n\n\u5b8c\u6574\u7684$AC$\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nll n,m,p,t[105],c[105][105],dp[105][105][105],ans;\nint main()\n{\n\tscanf(\"%lld%lld%lld\",&n,&m,&p);\n\tfor(ll i=1;i<=n;i++)scanf(\"%lld\",&t[i]);\n\tfor(ll i=1;i<=n;i++)\n\t{\n\t\tfor(ll j=1;j<=m;j++)\n\t\t{\n\t\t\tscanf(\"%lld\",&c[i][j]);\n\t\t}\n\t}\n\tfor(ll i=0;i<=n;i++)\n\t{\n\t\tfor(ll j=0;j<=p;j++)\n\t\t{\n\t\t\tfor(ll k=0;k<=m;k++)dp[i][j][k]=1e18;//\u6ce8\u610f\u521d\u59cb\u5316\uff01\n\t\t}\n\t}\n\tfor(ll k=0;k<=m;k++)dp[0][0][k]=dp[0][1][k]=0;\n\tfor(ll i=1;i<=n;i++)\n\t{\n\t\tfor(ll j=1;j<=i&&j<=p;j++)\n\t\t{\n\t\t\tif(t[i]==0)\n\t\t\t{\n\t\t\t\tfor(ll k=1;k<=m;k++)\n\t\t\t\t{\n\t\t\t\t\tfor(ll l=1;l<=m;l++)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(k==l)dp[i][j][k]=min(dp[i][j][k],dp[i-1][j][l]+c[i][k]);\n\t\t\t\t\t\telse dp[i][j][k]=min(dp[i][j][k],dp[i-1][j-1][l]+c[i][k]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor(ll k=1;k<=m;k++)\n\t\t\t\t{\n\t\t\t\t\tif(k==t[i])dp[i][j][t[i]]=min(dp[i][j][t[i]],dp[i-1][j][k]);\n\t\t\t\t\telse dp[i][j][t[i]]=min(dp[i][j][t[i]],dp[i-1][j-1][k]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tans=1e18;\n\tif(t[n])ans=dp[n][p][t[n]];\n\telse for(ll i=1;i<=m;i++)ans=min(ans,dp[n][p][i]);\n\tif(ans==1e18)printf(\"-1\");\n\telse printf(\"%lld\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1601368321,
        "uid": 333574,
        "name": "Tyyyyyy",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF711C \u3010Coloring Trees\u3011"
    },
    {
        "content": "## \u8fd9\u9053\u9898\u7684\u4e3b\u8981\u89e3\u6cd5\u5c31\u662f\u4e09\u7ef4DPdp[i][j][k]\u8868\u793a\u5728\u7b2ci\u4e2a\u6811\u4e4b\u524d\u5206\u4e3a\u4e86j\u7ec4\uff0c\u4e14\u4e0a\u4e00\u7ec4\u7684\u989c\u8272\u662fk\n\n#### \u4f46\u662f\u8fd9\u9053\u9898\u4e0d\u597d\u505a\u7684\u5730\u65b9\u5728\u4e8e\u5b83\u8981\u5206\u5f88\u591a\u79cd\u60c5\u51b5\uff0c\u73b0\u5728\u6211\u4eec\u5c31\u4e00\u4e00\u5206\u6790\u4e00\u4e0b\uff1a\n\n## \u4e00\uff1a\u6b64\u65f6\u6811\u5df2\u7ecf\u88ab\u67d3\u8272\u4e86\uff1a\n\n\u90a3\u4e48\u663e\u7136\uff0c\u6b64\u65f6k\u5c31\u786e\u5b9a\u4e86\uff0c\u5373\u6b64\u65f6\u7684\u989c\u8272\uff0c\u6211\u4eec\u6240\u8003\u8651\u7684\u5c31\u662fj\uff0c\u524d\u9762\u5206\u4e86\u591a\u5c11\u7ec4\uff0c\u8fd9\u53ef\u4ee5\u5728\u6700\u5916\u5c42\u7684for\u5faa\u73af\u4e2d\u76f4\u63a5\u679a\u4e3e\u3002\n\n\u6240\u4ee5\u5f88\u591a\u4eba\u5c31\u89c9\u5f97dp[i][j][k]=dp[i-1][j-1][k]\u4e86\u3002\u4f46\u662f\u6211\u4eec\u8981\u8003\u8651\u4e0a\u4e00\u7ec4\u7684\u989c\u8272\u4e0e\u5f53\u524d\u989c\u8272\u76f8\u540c\u4e0e\u5426\u3002\u90a3\u4e48\u6211\u4eec\u5c31\u8fd8\u8981\u6765\u4e00\u4e2afor\u5faa\u73af\u679a\u4e3e\n\n```\nfor(long long k=1;k<=m;k++)\n{\n\tif(k==num[i])\n\tdp[i][j][num[i]]=min(dp[i][j][num[i]],dp[i-1][j][k]);\n\telse\n\tdp[i][j][num[i]]=min(dp[i][j][num[i]],dp[i-1][j-1][k]);\n}\n```\n\n## \u4e8c\uff1a\u6b64\u65f6\u6811\u8fd8\u6ca1\u6709\u88ab\u67d3\u8272\uff1a\n\n\u6b64\u65f6k\u4e0d\u786e\u5b9a\u4e86\uff0c\u90a3\u4e48\u6211\u4eec\u8fd8\u662f\u7528for\u5faa\u73af\u89e3\u51b3\uff0c\u6bcf\u4e2a\u90fd\u679a\u4e3e\u4e00\u6b21\u3002\u4e0a\u9762\u4e0a\u4e00\u7ec4\u7684\u989c\u8272\u4e0e\u5f53\u524d\u989c\u8272\u76f8\u540c\u4e0e\u5426\u7684\u95ee\u9898\u4ecd\u7136\u5b58\u5728\uff0c\u90a3\u4e48\u6211\u4eec\u8fd8\u8981\u7528\u4e00\u4e2afor\u5faa\u73af\u679a\u4e3e\n\n```\nfor(long long k=1;k<=m;k++)\nfor(long long q=1;q<=m;q++)\nif(k==q)\ndp[i][j][k]=min(dp[i][j][k],dp[i-1][j][q]+hua[i][k]);\nelse\ndp[i][j][k]=min(dp[i][j][k],dp[i-1][j-1][q]+hua[i][k]);\n\n```\n\n### \u8fd9\u5c31\u662fdp\u7684\u4e3b\u4f53\u5185\u5bb9\u4e86\uff0c\u5982\u679c\u5927\u5bb6\u8fd8\u6709\u4e0d\u61c2\u7684\u5c31\u7ed3\u5408\u4ee3\u7801\u7406\u89e3\u54c8\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nlong long a,b,c,n,m,x,dp[101][101][101],num[101],hua[101][101],ans=1e17;             //dp[i][j][k]\u8868\u793a\u524di\u4e2a\u6811\u6d82\u6210j\u6bb5\uff0c\u6700\u540e\u4e00\u6bb5\u989c\u8272\u662fk; \nint main ( )\n{\n\tscanf(\"%lld%lld%lld\",&n,&m,&x);\n\tfor(long long i=1;i<=n;i++)\n\tscanf(\"%lld\",&num[i]);\n\tfor(long long i=1;i<=n;i++)\n\tfor(long long j=1;j<=m;j++)\n\tscanf(\"%lld\",&hua[i][j]);\n\tfor(long long i=0;i<=n;i++)\n\tfor(long long j=0;j<=x;j++)\n\tfor(long long k=1;k<=m;k++)\n\tdp[i][j][k]=1e17;\n\tfor(long long i=1;i<=m;i++)\n\tdp[0][0][i]=dp[0][1][i]=0;\n\tfor(long long i=1;i<=n;i++)\n\tfor(long long j=1;j<=i&&j<=x;j++)               //\u5df2\u6709j\u6bb5\n\t{\n\t\tif(num[i]==0)\n\t\t{\n\t\t\tfor(long long k=1;k<=m;k++)\n\t\t\tfor(long long q=1;q<=m;q++)\n\t\t\tif(k==q)\n\t\t\tdp[i][j][k]=min(dp[i][j][k],dp[i-1][j][q]+hua[i][k]);\n\t\t\telse\n\t\t\tdp[i][j][k]=min(dp[i][j][k],dp[i-1][j-1][q]+hua[i][k]);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor(long long k=1;k<=m;k++)\n\t\t\t{\n\t\t\t\tif(k==num[i])\n\t\t\t\tdp[i][j][num[i]]=min(dp[i][j][num[i]],dp[i-1][j][k]);\n\t\t\t\telse\n\t\t\t\tdp[i][j][num[i]]=min(dp[i][j][num[i]],dp[i-1][j-1][k]);\n\t\t\t}\n\t\t}\n\t}\n\tif(num[n]!=0)\n\tans=dp[n][x][num[n]];\n\telse\n\tfor(long long i=1;i<=m;i++)\n\tans=min(ans,dp[n][x][i]);\n\tif(ans>=1e17)\n\tcout<<-1;\n\telse\n\tcout<<ans;\n\treturn 0 ;\n}\n```\n\nThanks for reading",
        "postTime": 1599219516,
        "uid": 187923,
        "name": "liuyanxi2",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 CF711C \u3010Coloring Trees\u3011"
    }
]
[
    {
        "content": "## \u9898\u89e3\n\n\u6765\u4e00\u53d1\u4e0d\u7528 ddp \u7684\u7ebf\u6bb5\u6811\u9898\u89e3\u3002\n\n\u6211\u4eec\u5b9a\u4e49\u4e00\u6761\u8fb9\u88ab **\u9009\u5b9a** \u5f53\u4e14\u4ec5\u5f53\u6709\u8f66\u4f1a\u7ecf\u8fc7\u8fd9\u6761\u8fb9\u3002\n\n\u9996\u5148\u53ef\u4ee5\u53d1\u73b0\uff0c\u4e0d\u80fd\u6709\u8fde\u7eed\u4e24\u6761\u8fb9\u540c\u65f6\u4e0d\u9009\uff0c\u5426\u5219\u8fd9\u4e24\u6761\u8fb9\u4e2d\u95f4\u7684\u8f66\u5c31\u65e0\u6cd5\u79fb\u52a8\uff0c\u5176\u6b21\uff0c\u4e00\u6761\u88ab\u9009\u5b9a\u7684\u8fb9\u4f1a\u88ab\u7ecf\u8fc7\u4e24\u6b21\uff0c\u4e24\u7aef\u7684\u8fb9\u5fc5\u5b9a\u88ab\u9009\u5b9a\u3002\n\n\u7136\u540e\uff0c\u6b64\u9898\u5c31\u8f6c\u5316\u6210\u4e86\u6700\u5927\u72ec\u7acb\u96c6\u95ee\u9898\uff0c\u5b9a\u4e49 $val$ \u4e3a\u6700\u5927\u6743\u72ec\u7acb\u96c6\uff0c\u7b54\u6848\u5c31\u7b49\u4ef7\u4e8e $(sum-val)*2$\u3002\n\n\u5982\u4f55\u7528\u7ebf\u6bb5\u6811\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u5462\uff0c\u6ce8\u610f\u5230\u672c\u9898\u7684\u56fe\u662f\u4e00\u4e2a\u94fe\uff0c\u53ef\u4ee5\u8fdb\u884c DP\u3002\u5b9e\u9645\u4e0a\u4e00\u6bb5\u533a\u95f4\u6709\u7528\u7684\u72b6\u6001\u53ea\u6709\u533a\u95f4\u7684\u4e24\u7aef\u662f\u5426\u88ab\u9009\uff0c\u6211\u4eec\u53ef\u4ee5\u5728 pushup \u64cd\u4f5c\u7684\u65f6\u5019\u76f4\u63a5\u8f6c\u79fb\u3002\n\n```cpp\nvoid pushup(ll rt)\n{\n\tnode[rt].dp[1][1]=max(L.dp[1][0]+R.dp[0][1],max(L.dp[1][1]+R.dp[0][1],L.dp[1][0]+R.dp[1][1]));\n\tnode[rt].dp[1][0]=max(L.dp[1][0]+R.dp[0][0],max(L.dp[1][1]+R.dp[0][0],L.dp[1][0]+R.dp[1][0]));\n\tnode[rt].dp[0][0]=max(L.dp[0][0]+R.dp[0][0],max(L.dp[0][1]+R.dp[0][0],L.dp[0][0]+R.dp[1][0]));\n\tnode[rt].dp[0][1]=max(L.dp[0][0]+R.dp[0][1],max(L.dp[0][1]+R.dp[0][1],L.dp[0][0]+R.dp[1][1]));\n}\n```\n\n\u4fee\u6539\u64cd\u4f5c\u76f4\u63a5\u7ebf\u6bb5\u6811\u4fee\u6539\u5373\u53ef\uff08\u4e0d\u8981\u5fd8\u4e86\u7279\u5224\u4e24\u7aef\uff09\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <cstdio>\n#include <cmath>\n#include <iostream>\n#include <cstring>\n#include <algorithm>\n#include <queue>\n#include <vector>\n#include <map>\n#include <unordered_map>\n#define ll long long\n#define reg register\n#define fo(a,b,c) for(reg ll a=b;a<=c;a++)\n#define re(a,b,c) for(reg ll a=b;a>=c;a--)\n#define pb push_back\n#define mp make_pair\n#define pii pair<ll,ll>\n#define fi first\n#define se second\n#define mod 1000000007\nusing namespace std;\ninline ll gi(){\n    ll x = 0, f = 1;\n    char ch = getchar();\n    while(ch < '0' || ch > '9'){\n        if (ch == '-')\n            f = -1;\n        ch = getchar();\n    }\n    while(ch >= '0' && ch <= '9'){\n        x = (x<<1) + (x<<3) + (ch^48);\n        ch = getchar();\n    }\n    return x * f;\n}\nstruct IO\n{\n\tll dp[2][2],l,r;\n}node[2000005];\nll a[200005];\n#define L node[rt*2]\n#define R node[rt*2+1]\nll n;\nvoid pushup(ll rt)\n{\n\tnode[rt].dp[1][1]=max(L.dp[1][0]+R.dp[0][1],max(L.dp[1][1]+R.dp[0][1],L.dp[1][0]+R.dp[1][1]));\n\tnode[rt].dp[1][0]=max(L.dp[1][0]+R.dp[0][0],max(L.dp[1][1]+R.dp[0][0],L.dp[1][0]+R.dp[1][0]));\n\tnode[rt].dp[0][0]=max(L.dp[0][0]+R.dp[0][0],max(L.dp[0][1]+R.dp[0][0],L.dp[0][0]+R.dp[1][0]));\n\tnode[rt].dp[0][1]=max(L.dp[0][0]+R.dp[0][1],max(L.dp[0][1]+R.dp[0][1],L.dp[0][0]+R.dp[1][1]));\n}\nvoid bt(ll rt,ll l,ll r)\n{\n\tnode[rt].l=l;\n\tnode[rt].r=r;\n\tif(l==r)\n\t{\n\t\tnode[rt].dp[0][0]=0;\n\t\tif(l==1||l==n) node[rt].dp[1][1]=0;\n\t\telse node[rt].dp[1][1]=a[l];\n\t\tnode[rt].dp[1][0]=node[rt].dp[0][1]=-999999999;\n\t\treturn;\n\t}\n\tll mid=(l+r)/2;\n\tbt(rt*2,l,mid);\n\tbt(rt*2+1,mid+1,r);\n\tpushup(rt);\n}\nvoid ud(ll rt,ll w,ll v)\n{\n//\tcout<<node[rt].l<<\" \"<<node[rt].r<<\" \"<<w<<'\\n';\n\tif(node[rt].l==node[rt].r)\n\t{\n\t\tnode[rt].dp[0][0]=0;\n\t\tif(w==1||w==n) node[rt].dp[1][1]=0;\n\t\telse node[rt].dp[1][1]=v;\n\t\tnode[rt].dp[1][0]=node[rt].dp[0][1]=-999999999;\n\t\treturn;\n\t}\n\tll mid=(node[rt].l+node[rt].r)/2;\n//\tcout<<mid<<'\\n';\n\tif(w<=mid) ud(rt*2,w,v);\n\telse ud(rt*2+1,w,v);\n\tpushup(rt);\n}\nint main()\n{\n\tn=gi()-1;\n\tll sum=0;\n\tfo(i,1,n)\n\t{\n\t\ta[i]=gi();\n\t\tsum+=a[i];\n\t}\n\tbt(1,1,n);\n\tll ans=0;\n\tll m=gi();\n\tfo(i,1,m)\n\t{\n\t\tll x=gi(),y=gi();\n\t\tsum-=a[x];\n\t\ta[x]=y;\n\t\tsum+=a[x];\n\t\tud(1,x,y);\n\t\tll z=max(node[1].dp[1][0],max(node[1].dp[0][0],max(node[1].dp[0][1],node[1].dp[1][1])));\n\t\tcout<<(sum-z)*2<<'\\n';\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1681916279,
        "uid": 529632,
        "name": "ciuim",
        "ccfLevel": 0,
        "title": "CF1814E\u9898\u89e3"
    },
    {
        "content": "> \u6027\u8d28\uff1a\u5982\u679c\u8981\u4f7f $i, i+1,\\cdots, j$ \u8fd9\u51e0\u4e2a\u70b9\u9519\u6392\uff0c\u5219\u6700\u5c0f\u6743\u503c\u4e3a $2\\times \\displaystyle\\sum_{k=i}^{j-1} w_k$\uff08$w_k$ \u8868\u793a\u7b2c $k$ \u6761\u8fb9\u7684\u6743\u503c\uff09\u3002\n\n\u8fdb\u4e00\u6b65\u53ef\u53d1\u73b0\u8fd9\u4e00\u6027\u8d28\uff1a\n\n> \u5982\u679c\u8fde\u7eed\u4e24\u6761\u8fb9\u90fd\u6ca1\u6709\u9009\u62e9\uff0c\u5fc5\u5b9a\u4e0d\u80fd\u4f7f\u8fd9 $n$ \u4e2a\u70b9\u9519\u6392\u3002\n\n$f_{i, 0}$ \u8868\u793a\u4e0d\u9009\u7b2c $i$ \u6761\u8fb9\u7684\u6700\u5c0f\u6743\u503c\uff1b\n\n$f_{i, 1}$ \u8868\u793a\u9009\u7b2c $i$ \u6761\u8fb9\u7684\u6700\u5c0f\u6743\u503c\u3002\n\n\u8003\u8651\u8f6c\u79fb\uff1a\n\n- \u7b2c $i$ \u6761\u8fb9\u4e0d\u9009\uff0c\u5219\u7b2c $i-1$ \u6761\u8fb9\u5fc5\u9009\uff0c\u6240\u4ee5 $f_{i, 0}=f_{i-1, 1}$\uff1b\n- \u7b2c $i$ \u6761\u8fb9\u9009\uff0c\u5219\u7b2c $i-1$ \u6761\u8fb9\u53ef\u9009\u53ef\u4e0d\u9009\uff0c\u6240\u4ee5 $f_{i, 1}=\\min\\{f_{i-1, 0}, f_{i - 1, 1}\\}+2\\times a_i$\u3002\n\n\u672c\u9898\u5e26\u4fee\u6539\uff0c\u56e0\u6b64\u6211\u4eec\u8003\u8651 ddp\u3002\n\n\u6211\u4eec\u65b0\u5b9a\u4e49\u77e9\u9635\u4e58\u6cd5\u3002\n\n\u6211\u4eec\u4ee4 $C=A\\times B$\u3002\n\n\u5219 $C_{i, j}=\\displaystyle\\min_{k=1}^{p}\\{a_{i, k}+b_{k, j}\\}$\u3002\n\n\u6211\u4eec\u6784\u9020\u77e9\u9635\uff1a\n\n- $f_{i, 0}=\\min\\{f_{i-1, 0}+\\infty, f_{i-1, 1}\\}$\uff1b\n\n- $f_{i, 1}=\\min\\{f_{i-1, 0}+2\\times a_i, f_{i-1, 1}+ 2\\times a_i\\}$\u3002\n\n\u6784\u9020\u51fa\u5982\u4e0b\u77e9\u9635\uff1a\n$$\n\\begin{bmatrix}\n\n\\infty, 2\\times a_i\\\\\n0, 2\\times a_i\\\\\n\n\\end{bmatrix}\\times\\begin{bmatrix}\nf_{i - 1, 0}\\\\\nf_{i - 1, 1}\\\\\n\\end{bmatrix}=\\begin{bmatrix}\nf_{i, 0}\\\\\nf_{i, 1}\n\\end{bmatrix}\n$$\n\u7b54\u6848\u5c31\u4e3a $\\displaystyle\\prod_{i=1}^{n}m_{n-i+1}$\u3002\n\n[\u4ee3\u7801\u3002](https://codeforces.com/contest/1814/submission/202141327)",
        "postTime": 1681527989,
        "uid": 353330,
        "name": "hcywoi",
        "ccfLevel": 5,
        "title": "\u3010CF1814E \u9898\u89e3\u3011"
    },
    {
        "content": "### \u9898\u610f\n\n\u5728\u4e00\u6761\u957f\u5ea6\u4e3a $n$ \u7684\u94fe\u4e0a\uff0c\u6709 $1\\sim n$ \u8fd9 $n$ \u4e2a\u70b9\uff0c\u7b2c $i$ \u6761\u8fb9\u8fde\u63a5\u7740\u7b2c $i$ \u4e2a\u70b9\u5230\u7b2c $i+1$ \u4e2a\u70b9\uff0c\u8fb9\u6743\u662f $w_i$\u3002\n\n\u5728\u4e00\u5f00\u59cb\uff0c\u5728\u7b2c $i$ \u4e2a\u70b9\u4e0a\u90fd\u505c\u7740\u4e00\u8f86\u8f66 $i$\u3002\u73b0\u5728\uff0c\u4f60\u9700\u8981\u901a\u8fc7\u8fd9\u4e9b\u9053\u8def\uff0c\u79fb\u52a8\u4e00\u4e9b\u8f66\u8f86\uff0c\u4f7f\u5f97\u6bcf\u4e00\u8f86\u8f66\u90fd\u4e0d\u505c\u5728\u5b83\u7684\u521d\u59cb\u4f4d\u7f6e\u4e0a\uff0c\u4f7f\u5f97\u6bcf\u4e2a\u4f4d\u7f6e\u6700\u7ec8\u4e5f**\u4ec5\u6709\u4e00\u8f86\u8f66**\uff0c\u5e76\u4e14\u8f66\u7684\u79fb\u52a8\u603b\u8ddd\u79bb\u5c3d\u53ef\u80fd\u5c0f\u3002\n\n\u63a5\u4e0b\u6765\u4f1a\u6709 $m$ \u7ec4\u8be2\u95ee\uff0c\u6bcf\u7ec4\u8be2\u95ee\u4f1a\u4fee\u6539\u4e00\u6761\u8fb9\u7684\u8fb9\u6743\uff0c\u4f60\u9700\u8981\u8f93\u51fa\u4fee\u6539\u540e\u7684\u8f66\u7684\u79fb\u52a8\u7684\u6700\u5c0f\u8ddd\u79bb\u3002\u4fee\u6539\u4e0d\u72ec\u7acb\uff0c\u8f66\u5e76\u4e0d\u4f1a\u771f\u7684\u79fb\u52a8\u3002\n\n$n,m\\leq 2\\times 10^5$\n\n### \u9898\u89e3\n\n\u9996\u5148\u53ef\u4ee5\u89c2\u5bdf\u5230\uff0c\u6bcf\u4e00\u6761\u8fb9\u8981\u4e48\u4e0d\u88ab\u7ecf\u8fc7\uff0c\u8981\u4e48\u88ab\u4ece\u5de6\u8fb9\u7ecf\u8fc7\u4e00\u6b21\uff0c\u53f3\u8fb9\u7ecf\u8fc7\u4e00\u6b21\u3002\u56e0\u4e3a\u5982\u679c\u88ab\u7ecf\u8fc7\u591a\u6b21\u7684\u8bdd\uff0c\u90a3\u4e48\u5de6\u8fb9\u8fc7\u53bb\u7684\u4e24\u4e2a\u70b9\u548c\u53f3\u8fb9\u8fc7\u53bb\u7684\u4e24\u4e2a\u70b9\u81ea\u5df1\u5185\u90e8\u4ea4\u6362\u80af\u5b9a\u4f1a\u66f4\u4f18\uff0c\u4e0d\u5982\u4e0d\u8de8\u8fc7\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ea\u5173\u5fc3\u4e00\u6761\u8fb9\u6709\u6ca1\u6709\u88ab\u7ecf\u8fc7\u3002\n\n\u8003\u8651\u600e\u4e48\u6837\u7684\u65b9\u6848\u662f\u4e0d\u5408\u6cd5\u7684\u3002\u5047\u5982\u6709\u76f8\u90bb\u7684\u4e24\u6761\u8fb9\u6ca1\u6709\u88ab\u7ecf\u8fc7\uff0c\u90a3\u4e48\u4ed6\u4eec\u7684\u4ea4\u70b9\u6240\u5728\u7684\u8f66\u4e00\u5b9a\u53ea\u80fd\u505c\u5728\u81ea\u5df1\u539f\u6765\u7684\u4f4d\u7f6e\uff0c\u8fd9\u6837\u7684\u65b9\u6848\u663e\u7136\u4e0d\u5408\u6cd5\u3002\u7279\u522b\u7684\uff0c\u6700\u5de6\u8fb9\u7684\u8fb9\u548c\u6700\u53f3\u8fb9\u7684\u8fb9\u4e00\u5b9a\u8981\u88ab\u9009\u3002\u5bb9\u6613\u53d1\u73b0\u53ea\u8981\u6ee1\u8db3\u4e86\u8fd9\u4e2a\u6761\u4ef6\uff0c\u5c31\u4e00\u5b9a\u5408\u6cd5\u3002\n\n\u7136\u540e\uff0c\u4e0a\u9762\u7684\u95ee\u9898\u5c31\u8f6c\u5316\u6210\u4e86\u94fe\u4e0a\u6700\u5927\u72ec\u7acb\u96c6\u95ee\u9898\uff0c\u53ef\u4ee5\u4f7f\u7528\u7ebf\u6bb5\u6811\u7b80\u5355\u4f18\u5316 DP\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\uff0c\u53ef\u80fd\u8981\u4e58\u4e0a\u4e00\u4e2a\u6bd4\u8f83\u5927\u7684\u5e38\u6570\u3002\n\n### \u4ee3\u7801\n```c++\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint n,a[200010],q;\nstruct node\n{\n\tint f[2][2]; \n};\nnode t[800010];\nint sum=0;\nnode operator +(node x,node y)\n{\n\tnode res;\n\tfor(int i=0;i<=1;i++)\n\t\tfor(int j=0;j<=1;j++)\n\t\t\tres.f[i][j]=-1e18;\n\tfor(int i=0;i<=1;i++)\n\t{\n\t\tfor(int j=0;j<=1;j++)\n\t\t{\n\t\t\tfor(int k=0;k<=1;k++)\n\t\t\t{\n\t\t\t\tfor(int l=0;l<=1;l++)\n\t\t\t\t\tif(j==0||k==0)\n\t\t\t\t\t\tres.f[i][l]=max(x.f[i][j]+y.f[k][l],res.f[i][l]);\t\n\t\t\t}\n\t\t} \n\t}\n\treturn res;\n}\nvoid build(int x,int l,int r)\n{\n\tif(l==r)\n\t{\n\t\tt[x].f[0][0]=0,t[x].f[0][1]=-1e18;\n\t\tt[x].f[1][0]=-1e18;t[x].f[1][1]=a[l];\n\t\treturn ;\n\t}\n\tint mid=(l+r)/2;\n\tbuild(x<<1,l,mid);\n\tbuild(x<<1|1,mid+1,r);\n\tt[x]=t[x<<1]+t[x<<1|1];\n}\nvoid update(int x,int l,int r,int p,int v)\n{\n\tif(p<l||p>r)\n\t\treturn ;\n\tif(l==r)\n\t{\n\t\tt[x].f[0][0]=0,t[x].f[0][1]=-1e18;\n\t\tt[x].f[1][0]=-1e18;t[x].f[1][1]=v;\n\t\treturn ;\n\t}\n\tint mid=(l+r)/2;\n\tupdate(x<<1,l,mid,p,v);\n\tupdate(x<<1|1,mid+1,r,p,v);\n\tt[x]=t[x<<1]+t[x<<1|1]; \n}\nsigned main()\n{\n\tscanf(\"%lld\",&n);\n\tfor(int i=1;i<n;i++)\n\t\tscanf(\"%lld\",&a[i]),sum+=a[i];\n\tbuild(1,1,n-1);\n\tscanf(\"%lld\",&q);\n\twhile(q--)\n\t{\n\t\tint x,v;\n\t\tscanf(\"%lld%lld\",&x,&v);\n\t\tsum-=a[x];\n\t\ta[x]=v;\n\t\tsum+=a[x];\n\t\tupdate(1,1,n-1,x,v); \n\t\tprintf(\"%lld\\n\",(sum-t[1].f[0][0])*2);\n\t}\n}\n```",
        "postTime": 1680833517,
        "uid": 133520,
        "name": "Retired_lvmao",
        "ccfLevel": 7,
        "title": "CF1814E"
    },
    {
        "content": "## [CF1814E](https://www.luogu.com.cn/problem/CF1814E)\n\n### \u89e3\u9898\u601d\u8def\uff1a\n\n\u5148\u9009\u4e2d\u54ea\u4e9b\u8fb9\u88ab\u7ecf\u8fc7\uff0c\u90a3\u4e48\u5bf9\u4e8e\u6781\u957f\u7684\u6743\u503c\u548c\u4e3a $s$ \u7684\u8fde\u7eed\u8fb9\uff0c\u663e\u7136\u53ef\u4ee5\u7528 $2s$ \u7684\u4ee3\u4ef7\u5c06\u6240\u6709\u70b9\u9519\u6392\uff0c\u800c\u8fd9\u662f\u6700\u5c0f\u7684\u4ee3\u4ef7\uff0c\u56e0\u4e3a\u6bcf\u6761\u8fb9\u53ea\u80fd\u7ecf\u8fc7\u5076\u6570\u6b21\uff0c\u65e2\u7136\u94a6\u5b9a\u4e86\u8fd9\u4e9b\u8fb9\u88ab\u7ecf\u8fc7\uff0c\u90a3\u4e48\u88ab\u7ecf\u8fc7 $2$ \u6b21\u5c31\u662f\u6700\u5c0f\u7684\u3002\n\n\u8bbe $dp_{i,0/1}$ \u8868\u793a\u7b2c $i$ \u6761\u8fb9\u9009\u8fd8\u662f\u4e0d\u9009\u3002\n\n$dp_{0,0}=0,dp_{0,1}=+\\infty$\uff1b\n\n$dp_{i,0}=dp_{i-1,1},dp_{i,1}=\\min(dp_{i-1,0,dp_{i-1,1}})+2\\times a_i$\u3002\n\n\u7528 ddp \u4f18\u5316\u5373\u53ef\u3002\n\n[Code](https://codeforces.com/contest/1814/submission/201088720)\u3002",
        "postTime": 1680833349,
        "uid": 571634,
        "name": "hgzxwzf",
        "ccfLevel": 7,
        "title": "CF1814E"
    }
]
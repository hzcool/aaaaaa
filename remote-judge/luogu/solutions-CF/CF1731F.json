[
    {
        "content": "## Description\n\n\u9898\u76ee\u5927\u610f\uff1a\n\n\u5bf9\u4e8e\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u5217 $a$\u3002\n\n\u5b9a\u4e49 $lsl(i)$ \u8868\u793a $i$ \u5de6\u8fb9\u7684\u6570\u4e2d\u6bd4 $a_i$ \u5c0f\u7684\u6570\u7684\u4e2a\u6570\uff0c\u5373 $\\sum\\limits_{j = 1}^{i - 1}[a_j < a_i]$\u3002\n\n\u540c\u6837\u7684\u5b9a\u4e49 $grr(i)$ \u8868\u793a $i$ \u53f3\u8fb9\u7684\u6bd4 $a_i$ \u5927\u7684\u6570\u7684\u4e2a\u6570\uff0c\u5373 $\\sum\\limits_{j = i + 1}^n[a_j > a_i]$\u3002\n\n\u6211\u4eec\u79f0\u4e00\u4e2a\u4f4d\u7f6e\u662f\u597d\u7684\u5f53\u4e14\u4ec5\u5f53 $lsl(i) < grr(i)$\u3002\n\n\u6211\u4eec\u518d\u5bf9\u4e8e\u4e00\u4e2a\u6570\u5217 $a$ \u5b9a\u4e49\u4e00\u4e2a\u51fd\u6570 $f(a)$ \u4e3a $\\sum\\limits_{i = 1}^na_i[i\\  \\text{is good}]$\u3002\n\n\u73b0\u5728\u7ed9\u5b9a\u4e24\u4e2a\u6574\u6570 $n, k$\uff0c\u8bf7\u4f60\u6c42\u51fa\u5bf9\u4e8e\u6240\u6709\u957f\u5ea6\u4e3a $n$ \u4e14 $1 \\leq a_i \\leq k$ \u7684\u6570\u5217 $a$ \u7684 $f(a)$ \u7684\u548c\u662f\u591a\u5c11\u3002\n\n\u7b54\u6848\u5bf9 $\\text{998244353}$ \u53d6\u6a21\u3002\n\n## Solution\n\n\u89c2\u5bdf\u5230 $n \\leq 50$\uff0c\u542f\u793a\u6211\u4eec\u8981\u7528 $O(n^4)$ \u751a\u81f3 $O(n^5)$ \u7684\u7b97\u6cd5\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u9700\u8981\u4ec0\u4e48\u679a\u4e3e\u4ec0\u4e48\u5c31\u884c\u4e86\u3002\n\n\u8bbe $F(t)$ \u8868\u793a\u6570\u5217\u4e2d\u5b58\u5728\u4e00\u4e2a\u6570\u7b49\u4e8e $t$ \u65f6\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u3002\n\n\u6211\u4eec\u679a\u4e3e\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u7b49\u4e8e $t$\uff0c\u518d\u679a\u4e3e $lsl(i)$ \u548c $grr(i)$ \u5206\u522b\u7b49\u4e8e $x, y$\u3002\n\n\u90a3\u4e48\u4e0d\u96be\u5199\u51fa\u4e00\u4e2a\u5f0f\u5b50\uff1a\n\n$$\nF(t) = t \\times \\sum_{i = 1}^n\\sum_{x = 0}^{i - 1}\\sum_{y = x + 1}^{n - i}(\\dbinom {i - 1}{x}(t - 1)^x(k - t + 1)^{i - 1 - x} \\times \\dbinom {n - i}{y}(k - t)^yt^{n - i - y})\n$$\n\n\u76f8\u4fe1\u5927\u5bb6\u4e00\u5b9a\u90fd\u80fd\u770b\u61c2\u8fd9\u4e2a\u5f0f\u5b50\u3002\n\n\u6700\u540e\u7b54\u6848\u5c31\u662f\n\n$$\nG(k) = \\sum_{i = 1}^kF(i)\n$$\n\n\u4f46\u662f\u6211\u4eec\u660e\u663e\u65e0\u6cd5\u76f4\u63a5\u7b97\u51fa\u6765\uff0c\u62c9\u63d2\u4e00\u4e0b\u5c31\u597d\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^4\\log n)$\n\n## Code\n\n```cpp\n#include <bits/stdc++.h>\n#define pb push_back\n\nusing namespace std;\n\nnamespace IO{\n    inline int read(){\n        int x = 0, f = 1;\n        char ch = getchar();\n        while(!isdigit(ch)) {if(ch == '-') f = -1; ch = getchar();}\n        while(isdigit(ch)) x = (x << 3) + (x << 1) + ch - '0', ch = getchar();\n        return x * f;\n    }\n\n    template <typename T> inline void write(T x){\n        if(x < 0) putchar('-'), x = -x;\n        if(x > 9) write(x / 10);\n        putchar(x % 10 + '0');\n    }\n}\nusing namespace IO;\n\nconst int N = 60;\nconst int mod = 998244353;\nint n, k;\nint f[N], c[N][N];\n\ninline int add(int x) {return x >= mod ? x - mod : x;}\ninline int sub(int x) {return x < 0 ? x + mod : x;}\ninline int mul(int x, int y) {return 1ll * x * y % mod;}\n\ninline int qpow(int a, int b){\n    int res = 1;\n    while(b){\n        if(b & 1) res = mul(res, a);\n        a = mul(a, a), b >>= 1;\n    }\n    return res;\n}\n\ninline int Inv(int x) {return qpow(x, mod - 2);}\n\ninline int lagrange(int n, int k){\n    int res = 0;\n    for(int i = 1; i <= n; ++i){\n        int t1 = f[i], t2 = 1;\n        for(int j = 1; j <= n; ++j)\n            if(i != j) t1 = mul(t1, k - j), t2 = mul(t2, sub(i - j));\n        res = add(res + mul(t1, Inv(t2)));\n    }\n    return res;\n}\n\nsigned main(){\n#ifndef ONLINE_JUDGE\n    freopen(\"test.in\", \"r\", stdin);\n    freopen(\"test.out\", \"w\", stdout);\n#endif\n    n = read(), k = read();\n    for(int i = 0; i <= n; ++i) c[i][0] = 1;\n    for(int i = 1; i <= n; ++i)\n        for(int j = 1; j <= i; ++j)\n            c[i][j] = add(c[i - 1][j - 1] + c[i - 1][j]);\n    for(int t = 1 ; t <= min(n + 2, k); ++t){\n        int sum = 0;\n        for(int i = 1; i <= n; ++i)\n            for(int x = 0; x <= i - 1; ++x)\n                for(int y = x + 1; y <= n - i; ++y){\n                    int t1 = mul(c[i - 1][x], mul(qpow(t - 1, x), qpow(k + 1 - t, i - 1 - x)));\n                    t1 = mul(t1, mul(c[n - i][y], mul(qpow(k - t, y), qpow(t, n - i - y))));\n                    sum = add(sum + t1);\n                }\n        f[t] = mul(t, sum);\n    }\n    for(int i = 1; i <= n + 2; ++i) f[i] = add(f[i] + f[i - 1]);\n    if(k <= n + 2) write(f[k]), puts(\"\");\n    else write(lagrange(n + 2, k)), puts(\"\");\n    return 0;\n}\n```",
        "postTime": 1673870703,
        "uid": 158846,
        "name": "xixike",
        "ccfLevel": 0,
        "title": "CF1731F Function Sum \u9898\u89e3"
    },
    {
        "content": "CF1731F Function Sum \u9898\u89e3\u3002\n\n\u679a\u4e3e\u6240\u6709\u80fd\u679a\u4e3e\u7684\u4e1c\u897f\uff0c\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u5f0f\u5b50\u3002\n\n$$\\sum_{p=1}^n\\sum_{i=0}^{p-1}\\sum_{j=i+1}^{n-p}\\sum_{w=1}^k w{p-1\\choose i}(w-1)^i(k-w+1)^{p-1-i}{n-p\\choose j}(k-w)^jw^{n-p-j}$$\n\n\u5373\u9009\u62e9 good \u7684\u4f4d\u7f6e $p$\uff0c\u679a\u4e3e\u5de6\u8fb9\u6bd4\u5176\u5c0f\u7684\u4e2a\u6570 $i$ \u548c\u53f3\u8fb9\u6bd4\u5176\u5927\u7684\u4e2a\u6570 $j$\uff0c\u5206\u522b\u5206\u914d\u4f4d\u7f6e\u548c\u503c\u3002\n\n\u8fd9\u4e2a\u5f0f\u5b50\u6700\u5927\u7684\u95ee\u9898\u662f\u679a\u4e3e\u4e86 $w$\u3002\u90a3\u4e48\u5c1d\u8bd5\u5c06 $w$ \u63d0\u5230\u5916\u9762\u3002\u89c2\u5bdf\u53d1\u73b0\u6240\u6709\u7684\u4e8c\u9879\u5f0f\u7cfb\u6570\u90fd\u4e0e $w$ \u548c $k$ \u6ca1\u6709\u5173\u7cfb\uff0c\u800c\u6307\u6570\u90fd\u662f\u5173\u4e8e $n$ \u7684\u3002\u53d1\u73b0\u5982\u679c\u5c06\u5176\u770b\u6210\u4e00\u4e2a\u5173\u4e8e $k$ \u7684\u51fd\u6570 $f(k)$\uff0c\u5219\u5176\u6b21\u6570\u6700\u591a\u4e3a $n+1$\u3002\n\n\u56e0\u6b64\u66b4\u529b\u7b97\u51fa\u524d $n+2$ \u9879\u540e\u63d2\u503c\u5373\u53ef\u3002",
        "postTime": 1673453786,
        "uid": 114356,
        "name": "arundo",
        "ccfLevel": 0,
        "title": "\u60f3\u8981\u628a\u7eda\u70c2\u7d27\u7d27\u63e1\u5728\u624b\u4e2d\u3002\u5ffd\u7136\u53d1\u73b0\uff0c\u4f60\u5df2\u4e0d\u89c1\u3002"
    }
]
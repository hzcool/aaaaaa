[
    {
        "content": "\u6b64\u9898\u505a\u6cd5\u4e0e[\u5f39\u98de\u7ef5\u7f8a](https://www.luogu.com.cn/problem/P3203)\u505a\u6cd5\u57fa\u672c\u4e00\u81f4\u3002~~\u53cc\u500d\u7ecf\u9a8c\uff01~~\n\n\u8003\u8651\u7528\u5206\u5757\u5904\u7406\u3002\n\n\u4ee4$pla[i]$\u4e3a\u5c0f\u7403\u5728\u7b2c$i$\u4e2a\u6d1e\u65f6\u4f1a\u88ab\u5f39\u5230\u7684\u6d1e\u7684\u7f16\u53f7\uff0c$num[i]$\u4e3a\u7403\u5728\u7b2c$i$\u4e2a\u6d1e\u5f39\u51fa\u8fd9\u4e2a\u6d1e\u6240\u5728\u7684\u5757\u6240\u5f39\u7684\u6b21\u6570\u3002\n\n\u5757\u5927\u5c0f\u4e3a$\\sqrt n$\n\n\u9884\u5904\u7406\u590d\u6742\u5ea6\u4e3a$O(n\\sqrt n)$\uff0c\u4fee\u6539\u548c\u67e5\u8be2\u7684\u590d\u6742\u5ea6\u5747\u4e3a$O(\\sqrt n)$\n\n\u603b\u590d\u6742\u5ea6\u4e3a$O(n\\sqrt n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=200001;\nint n,c,m,a[N],bl[N],st[N],ed[N],pla[N],num[N],siz[N],ans1,ans2;\ninline int get(){//\u5feb\u8bfb\n    char ch=getchar();\n\tint sum=0,fl=1;\n    while(ch<'0'||ch>'9'){\n        ch=getchar();\n        if(ch=='-') \n\t\t\tfl=-1;\n\t}\n    while(ch>='0'&&ch<='9')\n        sum*=10,sum+=ch-'0',ch=getchar();\n    return sum*fl;\n}\ninline void build(){//\u5206\u5757\n    int sum=sqrt(n);\n    for(register int i=1;i<=sum;++i)\n        st[i]=(n/sum)*(i-1)+1,ed[i]=(n/sum)*i;\n    ed[sum]=n;\n    for(register int i=1;i<=sum;++i){\n        for(register int j=st[i];j<=ed[i];++j)\n            bl[j]=i;\t \n    }\n    for(register int i=1;i<=sum;++i)\n\t\tfor(register int j=ed[i];j>=st[i];--j){\n\t\t\tif(a[j]+j>ed[i])\n\t\t\t\tnum[j]=1,pla[j]=a[j]+j;\n\t\t\telse\t\n\t\t\t\tnum[j]=num[j+a[j]]+1,pla[j]=pla[j+a[j]];//\u9884\u5904\u7406\n\t\t}\n    return;   \n}\ninline void ask(int x){//\u67e5\u8be2\n\tint tim=0;\n   \tfor(register int i=x;i<=n;i=pla[i])\n   \t\ttim+=num[i],ans1=i;\n   \tfor(register int i=ans1;i<=n;i+=a[i]){\n   \t\tif(i+a[i]>n)\n   \t\t\tans1=i;\n\t   }\t\n   \tans2=tim;\n}\ninline void modify(int x,int y){ //\u4fee\u6539\n\ta[x]=y;\n\tint blx=bl[x];\n\tfor(register int i=x;i>=st[blx];--i){\n\t\tif(a[i]+i>ed[blx])\n\t\t\tnum[i]=1,pla[i]=a[i]+i;\n\t\telse\t\n\t\t\tnum[i]=num[i+a[i]]+1,pla[i]=pla[i+a[i]];\n\t}\n\treturn;\n}\nint main(){\n\tn=get(),m=get();\n    for(register int i=1;i<=n;++i)\n        a[i]=get();\n    build();//\u5206\u5757\n\tint op,p,q,ans=0;\n    while(m--){\n        op=get(),p=get();\n        if(op==1){\n\t\t\task(p);\n        \tprintf(\"%d %d\\n\",ans1,ans2);\t//\u8f93\u51fa\u7b54\u6848\n\t\t}\n        \t\n\t\telse\n\t\t\tq=get(),modify(p,q); \n\t}\n    return 0;\n}\n```",
        "postTime": 1585472917,
        "uid": 108098,
        "name": "FourteenObsidian",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF13E \u3010Holes\u3011"
    },
    {
        "content": "\u8fd9\u4e2a\u9898\u548c$P3203\\ $\u5f39\u98de\u7ef5\u7f8a\u57fa\u672c\u4e0a\u5b8c\u5168\u4e00\u81f4\n\n\u6211\u7684\u505a\u6cd5\u662f\u7528$LCT$\u7ef4\u62a4\u4fe1\u606f\uff0c\u5f00\u4e00\u4e2a\u8282\u70b9$fly$\uff0c\u8868\u793a\u5230\u6b64\u8282\u70b9\u65f6\uff0c\u5c0f\u7403\u4f1a\u5f39\u98de\uff0c\u90a3\u4e48\u67e5\u8be2\u5f39\u591a\u5c11\u6b21\u5373\u4e3a$siz[fly]-1$\n\n\u6700\u540e\u4e00\u6b21\u843d\u5728\u54ea\u4e2a\u6d1e\u53ef\u4ee5\u7528\u7ef4\u62a4\u94fe\u4e0a\u6700\u5927\u503c\u6765\u89e3\u51b3\n\n\u4e00\u4e9b\u5c0f\u7ec6\u8282\u770b\u4ee3\u7801\u5c31\u884c\u4e86\n\n$code:$\n```cpp\n#include<bits/stdc++.h>\n#define maxn 400010\nusing namespace std;\ntemplate<typename T> inline void read(T &x)\n{\n\tx=0;char c=getchar();bool flag=false;\n\twhile(!isdigit(c)){if(c=='-')flag=true;c=getchar();}\n\twhile(isdigit(c)){x=(x<<1)+(x<<3)+(c^48);c=getchar();}\n\tif(flag)x=-x;\n}\nint n,m,flag,root,tot,fly;\nint p[maxn],fa[maxn],ch[maxn][2],siz[maxn],ma[maxn],rev[maxn];\nbool check(int x)\n{\n\treturn ch[fa[x]][1]==x;\n}\nvoid pushr(int x)\n{\n\trev[x]^=1;swap(ch[x][0],ch[x][1]);\n}\nvoid pushup(int x)\n{\n\tsiz[x]=siz[ch[x][0]]+siz[ch[x][1]]+1;\n\tif(x!=fly) ma[x]=max(x,max(ma[ch[x][0]],ma[ch[x][1]]));\n\telse ma[x]=max(ma[ch[x][0]],ma[ch[x][1]]);\n}\nvoid pushdown(int x)\n{\n\tif(!rev[x]) return;\n\tpushr(ch[x][0]),pushr(ch[x][1]);\n\trev[x]=0;\n}\nbool notroot(int x)\n{\n\treturn ch[fa[x]][0]==x||ch[fa[x]][1]==x;\n}\nvoid rotate(int x)\n{\n\tint y=fa[x],z=fa[y],k=check(x),w=ch[x][k^1];\n\tif(notroot(y)) ch[z][check(y)]=x;\n\tfa[x]=z;\n\tch[y][k]=w;\n\tif(w) fa[w]=y;\n\tch[x][k^1]=y;\n\tfa[y]=x;\n\tpushup(y);\n}\nvoid all(int x)\n{\n\tif(notroot(x)) all(fa[x]);\n\tpushdown(x);\n}\nvoid splay(int x)\n{\n\tall(x);\n\tfor(int y;notroot(x);rotate(x))\n\t\tif(notroot(y=fa[x]))\n\t\t\trotate(check(x)^check(y)?x:y);\n\tpushup(x);\n}\nvoid access(int x)\n{\n\tfor(int y=0;x;y=x,x=fa[x])\n\t\tsplay(x),ch[x][1]=y;\n}\nvoid makeroot(int x)\n{\n\taccess(x),splay(x),pushr(x);\n}\nvoid split(int x,int y)\n{\n\tmakeroot(x),access(y),splay(y);\n}\nvoid link(int x,int y)\n{\n\tsplit(x,y),fa[x]=y;\n}\nvoid cut(int x,int y)\n{\n\tsplit(x,y),fa[x]=ch[y][0]=0;\n}\nint main()\n{\n\tread(n),read(m);\n\tfly=n+1;\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tread(p[i]);\n\t\tif(i+p[i]<=n) link(i,i+p[i]);\n\t\telse link(i,fly);\n\t}\n\twhile(m--)\n\t{\n\t\tint x,y;\n\t\tread(flag);\n\t\tif(flag)\n\t\t{\n\t\t\tread(x);\n\t\t\tsplit(x,fly);\n\t\t\tprintf(\"%d %d\\n\",ma[fly],siz[fly]-1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tread(x),read(y);\n\t\t\tif(x+p[x]<=n) cut(x,x+p[x]);\n\t\t\telse cut(x,fly);\n\t\t\tp[x]=y;\n\t\t\tif(x+p[x]<=n) link(x,x+p[x]);\n\t\t\telse link(x,fly);\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1575092438,
        "uid": 172489,
        "name": "lhm_",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF13E \u3010Holes\u3011"
    },
    {
        "content": "\u5176\u5b9e\u8fd9\u9053\u9898\u548c\u5f39\u98de\u7ef5\u7f8a\u533a\u522b\u5e76\u4e0d\u5927\uff0c\u540c\u6837\u4e5f\u662f\u5229\u7528\u5206\u5757\u6765\u89e3\u51b3\uff0c\u53ea\u4e0d\u8fc7\u8fd8\u8981\u6c42\u79bb\u5f00\u524d\u7684\u6700\u540e\u4f4d\u7f6e\u3002\u6211\u4eec\u8fd8\u662f\u7b80\u5355\u7684\u7406\u987a\u4e00\u4e0b\u8fd9\u9053\u9898\u7684\u601d\u8def\u5427\uff1a\n\n\u601d\u8def\u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u6211\u4eec\u5c06\u6574\u4e2a\u5e8f\u5217\u5206\u6210\u82e5\u5e72\u4e2a\u5757\uff08\u5757\u7684\u5927\u5c0f\u53d6\u51b3\u4e8e\u6570\u636e\uff0c\u4f46\u662f\u6211\u4eec\u4e00\u822c\u90fd\u4f1a\u9ed8\u8ba4\u4e3a\u221an\uff09\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u5757\u7684\u6bcf\u4e00\u4e2a\u70b9\u6211\u4eec\u53ea\u8981\u7ef4\u62a4\u4ed6\u5f39\u51fa\u8fd9\u4e2a\u5757\u8fd8\u9700\u51e0\u6b65\u548c\u5f39\u51fa\u4e4b\u540e\u4f1a\u5230\u8fbe\u54ea\u4e00\u4e2a\u70b9\u5373\u53ef\u3002\n\n\u5173\u4e8e\u4fee\u6539\uff0c\u7531\u4e8e\u6bcf\u4e00\u4e2a\u5757\u4e4b\u95f4\u90fd\u662f\u76f8\u4e92\u72ec\u7acb\u7684\uff0c\u6240\u4ee5\u5355\u70b9\u4fee\u6539\u53ea\u9700\u8981\u7ef4\u62a4\u6bcf\u4e00\u4e2a\u5757\u5c31\u53ef\u4ee5\u4e86\uff0c\u5e76\u4e14\u7531\u4e8e\u6bcf\u4e00\u4e2a\u70b9\u7684\u6570\u636e\u90fd\u5efa\u7acb\u5728\u4ed6\u540e\u9762\u5757\u7684\u57fa\u7840\u4e0a\uff0c\u6240\u4ee5\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5757\u90fd\u9700\u8981\u5012\u7740\u6765\u8fdb\u884c\u7ef4\u62a4\u3002\n\n\u800c\u5bf9\u4e8e\u67e5\u8be2\u6b21\u6570\u6211\u4eec\u53ea\u8981\u5faa\u7740\u6bcf\u4e00\u4e2a\u70b9\u7684\u6307\u5411\uff0c\u7d2f\u52a0\u6bcf\u4e00\u4e2a\u70b9\u7684sum\u503c\uff0c\u5927\u4e8en\u7684\u65f6\u5019\u8df3\u51fa\u5373\u53ef\u3002\n\n\u53ef\u662f\u5982\u679c\u8981\u67e5\u8be2\u4f4d\u7f6e\u5462\uff1f\n\n\u8fd9\u91cc\u5c31\u9690\u85cf\u7740\u4e00\u4e2a\u5de8\u5927\u7684\u5751\u70b9\uff1a\u7531\u4e8e\u6bcf\u4e00\u4e2a\u70b9\u8bb0\u5f55\u7684\u53ea\u662f\u5f39\u51fa\u8fd9\u4e2a\u65b9\u5757\u6240\u5230\u8fbe\u7684\u4f4d\u7f6e\uff0c\u6240\u4ee5\u6c42\u5f97\u7684\u6700\u7ec8\u4f4d\u7f6e\u5e76\u4e0d\u662f\u5b9e\u9645\u7684\u4f4d\u7f6e\uff0c\u8fd8\u8981\u518d\u5f80\u540e\u627e\u4e00\u904d\uff08\u5c31\u5728\u4e00\u4e2a\u5757\u5185\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u53ef\u4ee5\u5ffd\u7565\uff09\u5c31\u5b8c\u4e8b\u4e86\uff01\n\n\u6700\u540e\uff0c\u9644\u4e0a\u672c\u9898\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\nusing namespace std;\nstruct pot\n{\n    int to,k,conti,sum;\n}p[100005];\nint size,cnt=1,n,ac,ans;\nvoid change(int ct)\n{\n    //printf(\"%d\\n\",size);\n    for(int j=min(ct*size,n);j>(ct-1)*size;j--)\n    {\n        if(j + p[j].k > ct * size || j + p[j].k > n) p[j].sum = 1,p[j].to = j + p[j].k;\n        else\n        {\n            p[j].to=p[j+p[j].k].to;\n            p[j].sum=p[j+p[j].k].sum + 1;\n        }\n        //printf(\"%d\\n\",p[j].to);\n    }\n}\nvoid query(int y)\n{\n    ans=0;\n    while(y<=n)\n    {\n        ans+=p[y].sum;\n        //printf(\"%d\\n\",ans);\n        if(p[y].to>n) ac=y;\n        y=p[y].to;\n    }\n    while(ac+p[ac].k<=n)\n    {\n        ac+=p[ac].k;\n    }\n}\nint main()\n{\n    int temp = 0,m;\n    scanf(\"%d%d\",&n,&m);\n    size=sqrt(n);\n    for(int i=1;i<=n;i++)\n    {\n        temp++;\n        if(temp>size)\n        {\n            cnt++;\n            temp=1;\n        }\n        scanf(\"%d\",&p[i].k);\n        p[i].conti=cnt;\n    }\n    //if(temp != 0) cnt++;\n    //printf(\"%d\\n\",cnt);\n    for(int i=cnt;i >= 1;i--)\n        change(i);\n    for(int i=1;i<=m;i++)\n    {\n        int x,y,z;\n        scanf(\"%d%d\",&x,&y);\n        if(x==0)\n        {\n            scanf(\"%d\",&z);\n            p[y].k=z;\n            //printf(\"%d\\n\",p[y].k); \n            change(p[y].conti);\n        } \n        else\n        {\n            query(y);\n            printf(\"%d %d\\n\",ac,ans);\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1550403582,
        "uid": 133227,
        "name": "\u4e8e\u4e30\u6797",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF13E \u3010Holes\u3011"
    },
    {
        "content": "## Description\uff1a\n\n>\u6709 $N$ \u4e2a\u6d1e\uff0c\u6bcf\u4e2a\u6d1e\u6709\u76f8\u5e94\u7684\u5f39\u529b\uff0c\u80fd\u628a\u8fd9\u4e2a\u7403\u5f39\u5230 $i+power[i]$ \u4f4d\u7f6e\u3002\u5f53\u7403\u7684\u4f4d\u7f6e $>N$ \u65f6\u5373\u89c6\u4e3a\u88ab\u5f39\u51fa\u3002\n\n>\u6709\u4e24\u79cd\u64cd\u4f5c\uff1a\n\n>1. \u4fee\u6539\u67d0\u4e2a\u70b9\u7684\u5f39\u529b\u503c\u3002\n\n>2. \u8be2\u4e00\u4e2a\u7403\u4ece\u67d0\u70b9\u51e0\u6b21\u80fd\u591f\u5f39\u51fa\uff0c\u5f39\u51fa\u524d\u7684\u6700\u540e\u4e00\u4e2a\u4f4d\u7f6e\u662f\u54ea\u91cc\u3002\n\n\n------------\n## Solution\n\u8003\u8651\u5206\u5757\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\uff0c\u8bb0\u5f55\u5176\u5f39\u51e0\u6b21\u80fd\u591f\u5f39\u51fa\u5176\u6240\u5728\u5757\uff0c\u8bb0\u4f5c$cnt_i$\uff0c\u5f39\u51fa\u5176\u6240\u5728\u5757\u524d\u7684\u6700\u540e\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u8bb0\u4f5c$ls_i$\uff0c\u5f39\u51fa\u5176\u6240\u5728\u5757\u540e\u7684\u4f4d\u7f6e\uff0c\u8bb0\u4f5c $to_i$\u3002\n\n\u8bb0\u5757\u957f\u4e3a $s$\uff0c\n\u7531\u4e8e\u4fee\u6539\u64cd\u4f5c\u53ea\u4f1a\u5f71\u54cd\u4e00\u4e2a\u5757\u5185\u7684\u7b54\u6848\uff0c\u6240\u4ee5\u53ef\u4ee5\u5728 $\\Theta(s)$ \u7684\u65f6\u95f4\u91cc\u5b8c\u6210\u4fee\u6539\uff0c\u53c8\u4e00\u4e2a\u7403\u6700\u591a\u8df3\u5757\u6570\u6b21\u5c31\u53ef\u4ee5\u8df3\u51fa\uff0c\u6240\u4ee5\u53ef\u4ee5\u5728 $\\Theta(\\frac n s)$ \u7684\u65f6\u95f4\u5b8c\u6210\u67e5\u8be2\uff0c\u53d6 $s=\\sqrt n$ \u53ef\u53d6\u5f97\u6700\u4f18\u89e3\uff0c\u603b\u590d\u6742\u5ea6 $\\Theta(n\\sqrt n)$\u3002\n\n[\u53cc\u500d\u7ecf\u9a8c](https://www.luogu.com.cn/problem/P3203)\u3002\n\n------------\n## Code\n```cpp\n/*If you are full of hope,you will be invincible*/\n#include <ctime>\n#include <cstdio>\n#include <random>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\n#include<ext/pb_ds/assoc_container.hpp>\n#include<ext/pb_ds/hash_policy.hpp>\n#include<ext/pb_ds/priority_queue.hpp>\n#define ri register int\ntypedef long long ll;\nstd::mt19937 hpy(time(nullptr)+(unsigned long long)(new char));\nnamespace IO{\n\tconstexpr int HL=1<<20;\n\tchar buf[HL],*t1=buf,*t2=buf;\n\t#ifndef ONLINE_JUDGE\n\t#define getc() getchar()\n\t#else\n\t#define getc() t1==t2&&(t2=(t1=buf)+fread(buf,1,HL,stdin),t1==t2)?EOF:*t1++\n\t#endif\n\tinline int read(){static int an,f;an = 0,f = 1;static char ch;ch=getc();\n\twhile(!isdigit(ch))ch=='-'?f=-1:1,ch=getc();\n\twhile(isdigit(ch))an=(an<<3)+(an<<1)+(ch^48),ch=getc();\n\treturn an*f;}\n\tchar buff[HL],*T=buff;\n\tvoid flush(){fwrite(buff,1,T-buff,stdout);T=buff;}\n\tinline void putc(char ch){if(T==buff+HL)flush();*T++=ch;}\n\ttemplate<typename Tp>\n\tinline void print(Tp x){if(x<0)putc('-'),x=-x;if(!x)return putc('0'),void();\n\tstatic int st[20],tp;while(x)st[++tp]=x%10,x/=10;while(tp)putc(st[tp]^48),--tp;}\n}\nusing IO::read;\nusing IO::print;\nusing IO::putc;\nconstexpr int inf = 0x3f3f3f3f,N = 1e5 + 10,M = sqrt(N) + 10;\nint a[N],to[N],bl[N],L[M],R[M],cnt[N],la[N],n,m,siz,tot;\ninline int pos(int x){return (x-1)/siz+1;}\ninline void Init() {\n    n=read(),m=read(),siz=sqrt(n),tot=pos(n);\n    for(ri i=1;i<=n;++i) a[i]=read(),bl[i]=pos(i);\n    for(ri i=1;i<=tot;++i) L[i] = R[i-1]+1,R[i]=i*siz;\n    R[tot] = n;\n    for(ri i=n;i>=1;--i) {\n        if(i+a[i] > R[bl[i]]) \n            cnt[i] = 1,to[i] = i + a[i],la[i]=i;\n        else \n            cnt[i] = cnt[i+a[i]]+1,to[i] = to[i+a[i]],la[i]=la[i+a[i]];\n    }\n} \ninline void Modify(int x,int k) {\n    a[x] = k;\n    int pn = pos(x);\n    for(ri i=R[pn];i>=L[pn];--i) {\n        if(i+a[i] > R[pn]) cnt[i] = 1,to[i] = i + a[i],la[i] = i;\n        else cnt[i] = cnt[i+a[i]] + 1,to[i] = to[i+a[i]],la[i]=la[i+a[i]];\n    }\n}\ninline std::pair<int,int> query(int p) {\n    int res = 0,lst;\n    while(p <= n) {\n        res += cnt[p],lst = la[p],p = to[p];\n    }\n    return std::make_pair(lst,res);\n}\nint main() {\n    Init();\n    for(ri i=1;i<=m;++i) {\n        int opt=read(),x,y;\n        if(opt) {\n            x=read();\n            std::pair<int,int> p = query(x);\n            print(p.first),putc(' '),print(p.second),putc('\\n');\n        } else  {\n            x=read(),y=read();\n            Modify(x,y);\n        }\n    }\n    return IO::flush(),0;\n}\n```",
        "postTime": 1614511274,
        "uid": 413147,
        "name": "_Alejandro_",
        "ccfLevel": 0,
        "title": "CF13E\u9898\u89e3"
    },
    {
        "content": "\u9898\u76ee\u5728\u8fd9\uff1a[\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF13E)\u3002\n\n[P3203](https://www.luogu.com.cn/problem/P3203)\u3002\n\n\u5efa\u8bae\u5148\u505a\u505a\u4e0a\u9762\u90a3\u5230\u53cc\u500d\u7ecf\u9a8c\u7684\u9898\u518d\u6765\u505a\u8fd9\u4e00\u9898\uff08\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u5199\u5b8c\u8fd9\u9898\u987a\u4fbf\u628a\u4e0a\u4e00\u9898\u4e5f A \u4e86\uff09\u3002\n\n\u6211\u4eec\u5148\u770b\u770b P3230 \u600e\u4e48\u5199\uff1a\uff08\u4f1a\u7684\u53ef\u4ee5\u81ea\u884c\u8df3\u8fc7\uff09\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u9898\u76ee\u6240\u7ed9\u51fa\u7684\u6761\u4ef6\u5176\u5b9e\u53ef\u4ee5\u6784\u6210\u4e00\u68f5\u6811\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5efa\u4e00\u4e2a\u865a\u62df\u8282\u70b9 $n+1$\uff0c\u7ef5\u7f8a\u5230\u6b64\u5904\u5373\u4e3a\u5f39\u98de\u3002\n\n\u5bf9\u4e8e\u8282\u70b9 $i$\uff0c\u6211\u4eec\u628a $i$ \u548c $i+k_i$ \u8fdb\u884c link\u3002\u5982\u679c $i+k_i>n$\uff0c\u5219\u5bf9 $i$ \u548c $n+1$ \u8fdb\u884c link\u3002\n\n\u67e5\u8be2\u51e0\u6b21\u5f39\u98de\u53ef\u4ee5\u5148\u628a $x$ \u5230 $n+1$ \u7684\u8def\u5f84 split \u51fa\u6765\uff0c $n+1$ \u53f7\u8282\u70b9\u4e2a\u6570 -1 \u5373\u4e3a\u7ed3\u679c\u3002\n\n\u4fee\u6539\u64cd\u4f5c\u5373\u4e3a\u628a $x$ \u548c $i+k_i$ \u8fdb\u884c cut\uff0c\u7136\u540e\u628a $k_i$ \u66f4\u65b0\uff0c\u518d\u628a $x$ \u548c $i+k_i$ \u8fdb\u884c link\u3002\u540c\u6837\u9700\u8981\u6ce8\u610f $i+k_i$ \u662f\u5426\u5927\u4e8e $n$\u3002\n\n\u90a3\u4e48\u5230\u8fd9\u91cc\uff0cP3230 \u5c31\u53ef\u4ee5 A \u4e86\u3002\n\n\u8fd9\u4e00\u9898\u548c P3230 \u51e0\u4e4e\u4e00\u6837\uff0c\u4f46\u662f\u591a\u4e86\u4e00\u4e2a\u4e1c\u897f\uff1a\u8f93\u51fa\u6700\u540e\u4e00\u6b21\u843d\u5728\u54ea\u4e2a\u6d1e\u3002\n\n\u56e0\u4e3a splay \u8f85\u52a9\u6811\u662f\u6309\u7167\u6df1\u5ea6\u6765\u5efa\u6811\u7684\uff0c\u53c8\u56e0\u4e3a\u662f\u6700\u540e\u4e00\u4e2a\u88ab\u5f39\u98de\u7684\u4f4d\u7f6e\uff0c\u6240\u4ee5\u8fd9\u4e2a\u95ee\u9898\u76f8\u5f53\u4e8e\u95ee $n+1$ \u7684\u524d\u9a71\u3002\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u591a\u4e00\u4e2a pre \u51fd\u6570\u53bb\u5bfb\u627e $n+1$ \u53f7\u70b9\u7684\u524d\u9a71\u4fbf\u53ef\u4ee5\u4e86\u3002\n\n\u5f53\u7136\uff0c\u8fd9\u9898\u8fd8\u662f\u6709\u4e00\u4e9b**\u5751\u70b9**\u3002\n\n1. \u56e0\u4e3a\u6709\u70b9\u5361\u65f6\u95f4\uff0c\u6240\u4ee5\u5e94\u8be5\u8981\u5f00 scanf \u548c printf\u3002\n2. pre \u51fd\u6570\u4e5f\u4e0d\u8981\u5fd8\u4e86 pushdown \u54e6\u3002\n\n\u653e\u4e0a\u4ee3\u7801\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\nusing namespace std;\nconst int N=1e6+10;\nstruct splay{\n\tint fa,son[2];\n\tint size;\n\tint rev;\n};\nsplay spl[N];\nint a[N];\ninline bool check_root(int pos){\n\treturn spl[spl[pos].fa].son[0]!=pos&&spl[spl[pos].fa].son[1]!=pos;\n}\ninline int relation(int pos,int fa){\n\treturn spl[fa].son[1]==pos;\n}\ninline void connect(int pos,int fa,int son){\n\tspl[fa].son[son]=pos;\n\tspl[pos].fa=fa;\n}\ninline void pushup(int pos){\n\tspl[pos].size=spl[spl[pos].son[0]].size+spl[spl[pos].son[1]].size+1;\n}\ninline void pushdown(int pos){\n\tif(!spl[pos].rev)\n\t\treturn ;\n\tswap(spl[pos].son[0],spl[pos].son[1]);\n\tspl[spl[pos].son[0]].rev^=1;\n\tspl[spl[pos].son[1]].rev^=1;\n\tspl[pos].rev=0;\n}\ninline void pushall(int pos){\n\tif(!check_root(pos))\n\t\tpushall(spl[pos].fa);\n\tpushdown(pos);\n}\nvoid rotate(int pos){\n\tint fa=spl[pos].fa,gf=spl[fa].fa;\n\tint t1=relation(pos,fa),t2=relation(fa,gf);\n\tconnect(spl[pos].son[t1^1],fa,t1);\n\tconnect(fa,pos,t1^1);\n\tspl[pos].fa=gf;\n\tif(spl[gf].son[t2]==fa)\n\t\tspl[gf].son[t2]=pos;\n\tpushup(fa);\n\tpushup(pos);\n}\nvoid splaying(int pos){\n\tpushall(pos);\n\twhile(!check_root(pos)){\n\t\tint fa=spl[pos].fa,gf=spl[fa].fa;\n\t\tif(!check_root(fa))\n\t\t\trelation(pos,fa)^relation(fa,gf)?rotate(pos):rotate(fa);\n\t\trotate(pos);\n\t}\n}\nvoid access(int pos){\n\tint son=0;\n\twhile(pos){\n\t\tsplaying(pos);\n\t\tspl[pos].son[1]=son;\n\t\tpushup(pos);\n\t\tson=pos;\n\t\tpos=spl[pos].fa;\n\t}\n}\nvoid make_root(int pos){\n\taccess(pos);\n\tsplaying(pos);\n\tspl[pos].rev^=1;\n}\nvoid link(int x,int y){\n\tmake_root(x);\n\tspl[x].fa=y;\n}\nvoid cut(int x,int y){\n\tmake_root(x);\n\taccess(y);\n\tsplaying(y);\n\tspl[y].son[0]=0;\n\tspl[x].fa=0;\n\tpushup(y);\n}\nvoid split(int x,int y){\n\tmake_root(x);\n\taccess(y);\n\tsplaying(y);\n}\nint pre(int pos){\n\t//\u56e0\u4e3apos\u5df2\u7ecf\u65cb\u4e3a\u6839\uff0c\u6240\u4ee5\u76f4\u63a5\u53bb\u627e\u5c31\u884c\u4e86\n\tpos=spl[pos].son[0];\n\tpushdown(pos);//\u522b\u5fd8\u4e86pushdown\u54e6\n\twhile(spl[pos].son[1]){\n\t\tpos=spl[pos].son[1];\n\t\tpushdown(pos);//\u522b\u5fd8\u4e86pushdown\u54e6\n\t}\n\tsplaying(pos);\n\treturn pos;\n}\nint main(){\n\tint n,m;\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n+1;i++)\n\t\tspl[i].size=1;\n\tint x,y;\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%d\",&x);\n\t\ta[i]=i+x>n?n+1:i+x;\n\t\tlink(i,a[i]);\n\t}\n\tint opt;\n\twhile(m--){\n\t\tscanf(\"%d\",&opt);\n\t\tif(opt){\n\t\t\tscanf(\"%d\",&x);\n\t\t\tsplit(x,n+1);\n\t\t\tprintf(\"%d %d\\n\",pre(n+1),spl[n+1].size-1);\n\t\t}\n\t\telse{\n\t\t\tscanf(\"%d%d\",&x,&y);\n\t\t\tcut(x,a[x]);\n\t\t\ta[x]=x+y>n?n+1:x+y;\n\t\t\tlink(x,a[x]);\n\t\t}\n\t}\n}\n```",
        "postTime": 1608292453,
        "uid": 204705,
        "name": "KiDDOwithTopTree",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF13E \u3010Holes\u3011"
    },
    {
        "content": "\u9898\u89e3\u4e0d\u591a\uff0cLCT\u66f4\u5c11\uff0c\u6765\u5199\u4e00\u7bc7\u987a\u4fbf\u52a0\u6df1\u81ea\u5df1\u5bf9LCT\u7684\u7406\u89e3\u3002\u8fd9\u9053\u9898\u548cP3203\u5f39\u98de\u7ef5\u7f8a\u51e0\u4e4e\u4e00\u6a21\u4e00\u6837\uff0c\u591a\u4e86\u4e2a\u8f93\u51fa\u6700\u540e\u843d\u70b9\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5f53\u524d\u70b9\u4e0e\u5b83\u6240\u80fd\u5f39\u5230\u7684\u4e0b\u4e00\u4e2a\u4f4d\u7f6e\u76f8\u8fde\u3002\u5982\u679c\u8df3\u51fan\u7684\u8303\u56f4\uff0c\u5c31\u4e0en+1\u53f7\u7ec8\u6b62\u70b9\u76f8\u8fde\u3002\u7ec8\u6b62\u70b9\u662f\u4e3a\u4e86\u4fbf\u4e8e\u4e4b\u540e\u628ai->n+1\u7528split\u62ce\u51fa\u6765\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u8be2\u95ee\uff0c\u5148\u770b\u4e00\u5171\u80fd\u8df3\u51e0\u6b65\uff0c\u6211\u4eec\u7ef4\u62a4splay\u7684size\uff0c\u7136\u540e\u76f4\u63a5\u628ai->n+1\u7528split\u62ce\u51fa\u6765\uff0c\u8fd9\u6761\u94fe\u7684\u94fe\u957f-1\u5c31\u662f\u6b65\u6570\u3002\u94fe\u957f\u5373\u8fd9\u4e2asplay\u7684size\u3002\n\n\u5bf9\u4e8e\u6700\u540e\u4e00\u4e2a\u843d\u70b9\u7684\u8be2\u95ee\uff0c\u5176\u5b9e\u5c31\u662f\u8fd9\u4e2asplay\u91ccn+1\u7ec8\u6b62\u70b9\u7684\u524d\u9a71\u6216\u540e\u7ee7\u3002\u6211\u7684\u4ee3\u7801\u91cc\u7531\u4e8e\u662f\u4ee5i\u4e3a\u6839\uff0cn+1\u662f\u6df1\u5ea6\u6700\u5927\u7684\u70b9\uff0c\u6240\u4ee5\u662f\u627e\u524d\u9a71\u3002\u628an+1\u8fd9\u4e2a\u70b9splay\u4e0a\u53bb\uff0c\u627e\u6bd4\u5b83\u5c0f\u7684\u6700\u5927\u503c\uff0c\u548c\u627e\u6839\u5f88\u50cf\u3002\n\n\u8981\u6ce8\u610f\u7684\u662f\uff0csplay\u8fd9\u4e2a\u64cd\u4f5c\u5e76\u4e0d\u80fd\u4e0b\u653e\u7531splay\u7684\u6839\u5230\u4e0b\u9762\u6240\u6709\u7684\u7ffb\u8f6c\u6807\u8bb0\uff0c\u5728\u5bfb\u627e\u524d\u9a71\u7684\u65f6\u5019\u8981\u8001\u8001\u5b9e\u5b9epushdown\u3002\uff08\u627e\u6839\u6807\u51c6\u5199\u6cd5\uff09\n\n\u5f53\u7136\u4e5f\u6709\u53ef\u4ee5\u4e0d\u7528\u8003\u8651\u4ec0\u4e48\u524d\u9a71\u4ec0\u4e48pushdown\u7684\u505a\u6cd5\uff0c\u6700\u540e\u4e00\u4e2a\u843d\u70b9\u4e00\u5b9a\u662f\u6574\u6761\u94fe\u4e0a\u9664\u4e86n+1\u4ee5\u5916\u7684\u6700\u5927\u503c\uff0c\u7ef4\u62a4\u4e00\u4e2a\u6700\u5927\u503c\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u4ee3\u7801\uff08\u91cc\u9762\u5305\u542b\u4e24\u79cd\u8be2\u95ee\u7b2c\u4e00\u95ee\u7684\u505a\u6cd5\uff09\uff1a\n\n```cpp\n#include<iostream>\n#include<cstdio>\nusing namespace std;\nint n,m,t,top,q[100101],id,u,v;\nstruct node{\n\tint ch[2],fa,maxx,sum,tag;\n}a[100101];\nint b[100101];\nint isroot(int x){\n\treturn a[a[x].fa].ch[0]!=x&&a[a[x].fa].ch[1]!=x;\n}\nvoid work(int x){\n\ta[x].tag^=1;\n\tswap(a[x].ch[0],a[x].ch[1]);\n}\nvoid pushup(int x){\n\ta[x].sum=a[a[x].ch[0]].sum+a[a[x].ch[1]].sum+1;\n\ta[x].maxx=max(max(a[a[x].ch[0]].maxx,a[a[x].ch[1]].maxx),((x==t)?0:x));\n\t//\u8fd9\u91cc\u662f\u7ef4\u62a4\u6700\u5927\u503c\n}\nvoid pushdown(int x){\n\tif(a[x].tag){\n\t\ta[x].tag=0;\n\t\tif(a[x].ch[0])work(a[x].ch[0]);\n\t\tif(a[x].ch[1])work(a[x].ch[1]);\n\t}\n}\nvoid rotate(int x){\n\tint y=a[x].fa,z=a[y].fa;\n\tint k=(a[y].ch[1]==x);\n\tif(!isroot(y))a[z].ch[a[z].ch[1]==y]=x;\n\ta[x].fa=z;\n\ta[y].ch[k]=a[x].ch[k^1];\n\ta[a[x].ch[k^1]].fa=y;\n\ta[x].ch[k^1]=y;\n\ta[y].fa=x;\n\tpushup(y);\n}\nvoid splay(int x){\n\ttop=1,q[top]=x;\n\tfor(int i=x;!isroot(i);i=a[i].fa)q[++top]=a[i].fa;\n\tfor(int i=top;i;i--)pushdown(q[i]);\n\twhile(!isroot(x)){\n\t\tint y=a[x].fa,z=a[y].fa;\n\t\tif(!isroot(y)){\n\t\t\t(a[y].ch[0]==x)^(a[z].ch[0]==y)?rotate(x):rotate(y);\n\t\t}\n\t\trotate(x);\n\t}\n\tpushup(x);\n}\nvoid access(int x){\n\tfor(int y=0;x;y=x,x=a[x].fa){\n\t\tsplay(x);\n\t\ta[x].ch[1]=y;\n\t\tpushup(x);\n\t}\n}\nvoid makeroot(int x){\n\taccess(x);\n\tsplay(x);\n\twork(x);\n}\nvoid link(int x,int y){\n\tmakeroot(x);\n\ta[x].fa=y;\n}\nvoid split(int x,int y){\n\tmakeroot(x);\n\taccess(y);\n\tsplay(y);\n}\nvoid cut(int x,int y){\n\tsplit(x,y);\n\ta[y].ch[0]=a[x].fa=0;\n\tpushup(y);\n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\tt=n+1;\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%d\",&b[i]);\n\t\tif(i+b[i]<=n)link(i,i+b[i]);\n\t\telse link(i,t);\n\t}\n\twhile(m--){\n\t\tscanf(\"%d\",&id);\n\t\tif(id){\n\t\t\tscanf(\"%d\",&u);\n\t\t\tsplit(u,t);\n\t\t\tint k=a[t].ch[0];//\u8fd9\u79cd\u662f\u524d\u9a71 \n\t\t\tpushdown(k);\n\t\t\twhile(a[k].ch[1])k=a[k].ch[1],pushdown(k);\n\t\t\tprintf(\"%d %d\\n\",k,a[t].sum-1);\n\t\t}\n\t\telse{\n\t\t\tscanf(\"%d%d\",&u,&v);\n\t\t\tif(u+b[u]<=n)cut(u,u+b[u]);\n\t\t\telse cut(u,t);\n\t\t\tb[u]=v;\n\t\t\tif(u+b[u]<=n)link(u,u+b[u]);\n\t\t\telse link(u,t);\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\u4ee5\u4e0a\uff0c\u611f\u8c22\u9605\u8bfb",
        "postTime": 1562229280,
        "uid": 114222,
        "name": "\u72db\u679d\u51ea\u6597",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF13E \u3010Holes\u3011"
    },
    {
        "content": "\u8fd9\u9898\u548c[\u5f39\u98de\u7ef5\u7f8a](https://www.luogu.org/problemnew/show/P3203)\u5dee\u4e0d\u591a\n\n\u4f9d\u7136\u662f\u66b4\u529b\u7684\u5206\u5757\n\n\u5728\u539f\u9898\u57fa\u7840\u4e0a\u591a\u4e86\u4e00\u95ee\uff1a\u6700\u540e\u4e00\u6b21\u843d\u5728\u54ea\u4e2a\u6d1e\u4e2d\n\n\u5148\u9884\u5904\u7406\u51fa\u6bcf\u4e2a\u70b9\u5411\u540e\u8df3\u5230\u8fbe\u7684\u70b9\n\n\u6bcf\u6b21\u8bb0\u5f55$pre$\uff0c\u8df3\u5230$>n$\u7684\u4f4d\u7f6e\u6216\u8005\u8d85\u51fa\u4e86\u5757\u7684\u6570\u91cf\u5c31$break$\n\n\u4f46\u662f\u8fd9\u6837\u627e\u5230\u7684$pre$\u4e0d\u4e00\u5b9a\u662f\u6700\u540e\u4e00\u4e2a\u6d1e\n\n\u5982\u679c\u5b83\u8fd8\u53ef\u4ee5\u5f80\u540e\u8df3\uff0c\u5c31\u8ba9\u5b83\u7ee7\u7eed\u8df3\n\n\u8fd9\u4e2a\u5730\u65b9\u5751\u6211$WA$\u4e86\u597d\u51e0\u53d1orz\n\n```\n#include<cstdio>\n#include<cstring>\n#include<cctype>\n#include<cmath>\n#include<algorithm>\n#define reg register\nusing namespace std;\nconst int N=2e5+5;\nstruct block\n{\n    int l,r;\n}s[500];\nint n,m,q,num,a[N],to[N],belong[N],step[N];\ninline int read()\n{\n    int x=0,w=1;\n    char c=getchar();\n    while (!isdigit(c)&&c!='-') c=getchar();\n    if (c=='-') c=getchar(),w=-1;\n    while (isdigit(c))\n    {\n        x=(x<<1)+(x<<3)+c-'0';\n        c=getchar();\n    }\n    return x*w;\n}\ninline void getblock()\n{\n    int now=1;\n    while (now<=n)\n    {\n        s[++num].l=now;\n        s[num].r=min(n,now+m-1);\n        now+=m;\n    }\n    if (num<m) s[++num].l=num*m+1,s[num].r=n; num=1;\n    for (reg int i=1;i<=n;i++)\n    {\n        if (i>s[num].r) ++num;\n        belong[i]=num;\n    }\n}\ninline void change(int l,int r)\n{\n    for (reg int i=r;i>=l;i--)\n    {\n        if (i+a[i]>s[belong[i]].r) step[i]=1,to[i]=i+a[i];\n        else step[i]=step[i+a[i]]+1,to[i]=to[i+a[i]];\n    }\n}\nint main()\n{\n    n=read(),q=read(); m=sqrt(n); if (m*m<n) ++m;\n    for (reg int i=1;i<=n;a[i++]=read());\n    getblock(); change(1,n);\n    while (q--)\n    {\n        int opt=read(),x=read();\n        if (opt==1) \n        {\n            int ans=step[x],y=to[x],pre=x;\n            for (reg int i=belong[x];i<=m&&y<=n;i++) ans+=step[y],pre=y,y=to[y];\n            while (pre+a[pre]<=n) pre+=a[pre];\n            printf(\"%d %d\\n\",pre,ans);\n        }\n        else\n        {\n            int y=read(); a[x]=y;\n            change(s[belong[x]].l,s[belong[x]].r);\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1538989434,
        "uid": 43471,
        "name": "Captain_Paul",
        "ccfLevel": 0,
        "title": "CF13E  Holes"
    },
    {
        "content": "\u8fd9\u9053\u9898\u9996\u5148\u770b\u6570\u636e\u8303\u56f4\uff0c$10^5$,\u90a3\u9996\u5148\u60f3\u5230\u5206\u5757\u7ef4\u62a4\u5427\uff0c\u4f46\u8fd9\u9053\u9898\u7684\u5206\u5757\u4e0e\u666e\u901a\u7684\u5206\u5757\u4e0d\u592a\u4e00\u6837\uff0c\u5b83\u662f\u4e00\u79cd\u53eb\u505a\u5757\u72b6\u94fe\u8868\u7684\u4e1c\u897f\u7ef4\u62a4\u7684\u3002\u5757\u72b6\u94fe\u8868\u662f\u4ec0\u4e48\u5462\uff1f\n![\u5757\u72b6\u94fe\u8868](https://cdn.luogu.com.cn/upload/image_hosting/6g122yrj.png)\n\uff08\u5176\u5b9e\u5c31\u662f\u7528\u94fe\u8868\u5427\u5757\u4e0e\u5757\u4e4b\u95f4\u8fde\u4e86\u8d77\u6765\uff09\n\n\u90a3\u6211\u4eec\u8981\u7528\u5757\u72b6\u94fe\u8868\u7ef4\u62a4\u4ec0\u4e48\u5462\uff1f\n\n\u663e\u800c\u6613\u89c1\uff0c\u7ef4\u62a4\u6bcf\u4e00\u4e2a\u70b9\u8df3\u51fa\u8fd9\u4e2a\u5757\u4ee5\u540e\u4f1a\u8df3\u5728\u54ea\u91cc\u4ee5\u53ca\u6240\u9700\u65f6\u95f4\uff0c\u8fd9\u6837\u6211\u4eec\u4e00\u4e2a\u70b9\u53ea\u4f1a\u8df3\u4e00\u6b21\uff0c\u5c31\u628a\u4e00\u6b21\u8be2\u95ee\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f$O$($\\sqrt{n}$)\u3002\n\n\u90a3\u4e48\u5bf9\u4e8e\u4fee\u6539\u64cd\u4f5c\u5462\uff1f\u56e0\u4e3a\u4e00\u6b21\u4fee\u6539\u53ea\u4f1a\u6539\u53d8\u4e00\u4e2a\u5757\u91cc\u7684\u4fe1\u606f\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u4ece\u53f3\u5411\u5de6\u7684\u7ef4\u62a4\uff0c\u53ef\u4ee5\u5b9e\u73b0$O(1)$,\u4e3a\u4ec0\u4e48\u8981\u4ece\u53f3\u5411\u5de6\u5462\uff1f\u56e0\u4e3a\u4ece\u53f3\u5411\u5de6\u4f60\u53ef\u4ee5\u53d1\u73b0\u4f60\u53ea\u9700\u8981\u5411\u53f3\u8df3\u4e00\u6b21\u5c31\u53ef\u4ee5\u66f4\u65b0\u7b54\u6848\uff0c\u5982\u679c\u4f60\u5411\u53f3\u8df3\u4e00\u6b65\u8fd8\u5728\u5757\u5185\uff0c\u56e0\u4e3a\u4f60\u5411\u53f3\u8df3\u8fc7\u7684\u70b9\u4ee5\u53ca\u66f4\u65b0\u8fc7\u4e86\uff0c\u6240\u4ee5\u76f4\u63a5\u7ee7\u627f\uff0c\u5982\u679c\u5728\u5757\u5916\uff0c\u90a3\u4e48\u76f4\u63a5\u66f4\u65b0\u3002\u6240\u4ee5\u4fee\u6539\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u662f$O$($\\sqrt{n}$)\u7684\u3002\n\n\u4fee\u6539\u4ee3\u7801\n```\nvoid change(int x,int y)//x\u4e3a\u4f4d\u7f6e\uff0cy\u4e3a\u503c\n{\n\tint tmp=x,cnt=0;\n\ta[x]=y;\n\twhile (pos[tmp].k==pos[x].k)tmp+=a[tmp],cnt++;\n\tpos[x].next=tmp;\n\tpos[x].w=cnt;\n\tfor (int i=x-1;i>=l[pos[x].k];i--)\n\t{\n\t\tint tmp=i,cnt=0;\n\t\ttmp=tmp+a[tmp];//\u5411\u53f3\u8df3\u4e00\u6b65\n\t\tif (pos[tmp].k==pos[i].k)//\u5728\u5757\u5185\u76f4\u63a5\u7ee7\u627f\n\t\t{\n\t\t\tpos[i].next=pos[tmp].next;\n\t\t\tpos[i].w=pos[tmp].w+1;\n\t\t}\n\t\telse//\u5728\u5757\u5916\n\t\t{\n\t\t\tpos[i].next=tmp;\n\t\t\tpos[i].w=1;\n\t\t}\n\t}\n}\n```\n\n\u5b8c\u6574\u4ee3\u7801\n```\n#include<cstdio>\n#include<cmath>\nusing namespace std;\nconst int maxn=2e5+10;\nint n,m,a[maxn],k,l[maxn];\nstruct node{\n\tint next,w,k;\n}pos[maxn*2];\nvoid ask(int x)\n{\n\tint tmp=x,ans=0,cnt=tmp;\n\twhile(pos[tmp].k)\n\t{\n\t\tans+=pos[tmp].w;\n\t\tcnt=tmp;\n\t\ttmp=pos[tmp].next;\n\t}\n\ttmp=cnt;\n\twhile(pos[tmp].k==pos[cnt].k)cnt=tmp,tmp+=a[tmp];\n\tprintf(\"%d %d\\n\",cnt,ans);\n}\nvoid change(int x,int y)\n{\n\tint tmp=x,cnt=0;\n\ta[x]=y;\n\twhile (pos[tmp].k==pos[x].k)tmp+=a[tmp],cnt++;\n\tpos[x].next=tmp;\n\tpos[x].w=cnt;\n\tfor (int i=x-1;i>=l[pos[x].k];i--)\n\t{\n\t\tint tmp=i,cnt=0;\n\t\ttmp=tmp+a[tmp];\n\t\tif (pos[tmp].k==pos[i].k)\n\t\t{\n\t\t\tpos[i].next=pos[tmp].next;\n\t\t\tpos[i].w=pos[tmp].w+1;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tpos[i].next=tmp;\n\t\t\tpos[i].w=1;\n\t\t}\n\t}\n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&m);\n\tfor (int i=1;i<=n;i++)scanf(\"%d\",&a[i]);\n\tk=sqrt(n);\n\tfor (int i=1;i<=n;i++)pos[i].k=(i-1)/k+1;\t\n\tfor (int i=1;i<=n;i++)if (pos[i].k!=pos[i-1].k)l[pos[i].k]=i;\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tint tmp=i,cnt=0;\n\t\twhile (pos[tmp].k==pos[i].k)tmp+=a[tmp],cnt++;\n\t\tpos[i].next=tmp;\n\t\tpos[i].w=cnt;\n\t}\n\tfor (int i=1;i<=m;i++)\n\t{\n\t\tint opt,x,y;\n\t\tscanf(\"%d\",&opt);\n\t\tif (opt==1)\n\t\t{\n\t\t\tscanf(\"%d\",&x);\n\t\t\task(x);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tscanf(\"%d%d\",&x,&y);\n\t\t\tchange(x,y);\n\t\t}\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1600245119,
        "uid": 227436,
        "name": "\u5e74\u534e\u5929\u5730",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 CF13E \u3010Holes\u3011"
    },
    {
        "content": "\u663e\u7136\u4e0e\u5f39\u98de\u7ef5\u7f8a\u662f\u4e00\u4e2a\u9898\uff0c\u53ea\u4e0d\u8fc7\u52a0\u4e86\u4e00\u4e2a\u6c42**n+1\u7684\u524d\u9a71**\u3002\n\n\u8bb0\u5f55\u6700\u5927\u70b9\u7684\u7f16\u53f7\uff0c\u4ee4n+1\u7684\u7f16\u53f7\u4e3a0\u3002\n\n```\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nconst int N=2e5+50;\ninline void swap(int &u,int &v){int o=u;u=v;v=o;}\nstruct lct{\n    int ch[N][2],fa[N],siz[N],tagrev[N],Max[N],val[N];\n    bool isrot(int x){\n        return ch[fa[x]][0]!=x&&ch[fa[x]][1]!=x;\n    }\n    void rev(int x){\n        tagrev[x]^=1;\n        swap(ch[x][0],ch[x][1]);\n    }\n    void pushdown(int x){\n        if(!isrot(x))pushdown(fa[x]);\n        if(!x||!tagrev[x])return;\n        tagrev[x]=0;\n        rev(ch[x][0]);rev(ch[x][1]);\n    }\n    void update(int x){\n        if(!x)return;\n        siz[x]=siz[ch[x][0]]+siz[ch[x][1]]+1;\n        Max[x]=max({val[x],Max[ch[x][0]],Max[ch[x][1]]});//\u76f4\u63a5\u53d6max\u66f4\u65b0\u5c31\u597d\n    }\n    void rotate(int x){\n        int y=fa[x],z=fa[y],opt=(ch[y][1]==x),w=ch[x][opt^1];\n        if(!isrot(y))ch[z][ch[z][1]==y]=x;fa[x]=z;\n        ch[y][opt]=w;fa[w]=y;\n        ch[x][opt^1]=y;fa[y]=x;\n        update(y);update(x);\n    }\n    void splay(int x){\n        int y,z;pushdown(x);\n        while(!isrot(x)){\n            y=fa[x];z=fa[y];\n            if(!isrot(y))\n            rotate(((ch[y][0]==x)^(ch[z][0]==y))?x:y);\n            rotate(x);\n        }\n    }\n    void access(int x){\n        for(int y=0;x;y=x,x=fa[x])\n        splay(x),ch[x][1]=y,update(x);\n    }\n    void mktrot(int x){\n        access(x);splay(x);rev(x);\n    }\n    void mkvrot(int x){\n        access(x);splay(x);\n    }\n    void query(int x,int y){\n        mktrot(x);mkvrot(y);\n        printf(\"%d %d\\n\",Max[y],siz[y]-1);\n    }\n    void link(int x,int y){\n        mktrot(x);mkvrot(y);\n        fa[x]=y;\n    }\n    void cut(int x,int y){\n        mktrot(x);mkvrot(y);\n        ch[y][0]=fa[x]=0;\n        update(y);\n    }\n}s;\nint n,m,a[N],opt,x,y;\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n;i++)s.siz[i]=1,s.Max[i]=s.val[i]=i;//\u8bb0\u5f55\u6700\u5927\u70b9\u7f16\u53f7\n    for(int i=1;i<=n;i++){\n        scanf(\"%d\",&a[i]);\n        if(i+a[i]<=n)s.link(i,i+a[i]);\n        else s.link(i,n+1);\n    }\n    for(int i=1;i<=m;i++){\n        scanf(\"%d\",&opt);\n        if(opt==1){\n            scanf(\"%d\",&x);\n            s.query(x,n+1);\n            continue;\n        }else{\n            scanf(\"%d%d\",&x,&y);\n            if(x+a[x]<=n){\n                s.cut(x,x+a[x]);\n                if(x+y<=n)s.link(x,x+y);\n                else s.link(x,n+1);\n            }else{\n                s.cut(x,n+1);\n                if(x+y<=n)s.link(x,x+y);\n                else s.link(x,n+1);\n            }\n            a[x]=y;\n        }\n    }\n}\n```",
        "postTime": 1553649428,
        "uid": 50092,
        "name": "da32s1da",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF13E \u3010Holes\u3011"
    },
    {
        "content": "# CF13E Holes\n\n[LG\u4f20\u9001\u95e8](https://www.luogu.org/problemnew/show/CF13E)\n\n\u53cc\u500d\u7ecf\u9a8c\u9898\uff0c\u51e0\u4e4e\u540c[[HNOI2010]\u5f39\u98de\u7ef5\u7f8a](https://www.luogu.org/problemnew/show/P3203)\uff0cLCT\u7ec3\u624b\u9898\uff0cLG\u6ca1\u6709LCT\u9898\u89e3\u4e8e\u662f\u53d1\u4e00\u6ce2\u3002\n\n\u4ece\u5f53\u524d\u70b9\u5411\u76ee\u6807\u70b9\u8fde\u8fb9\uff0c\u6784\u6210\u4e00\u68f5\u6811\uff0c\u5e26\u4fee\u6539\u5c31\u7528LCT\u52a8\u6001\u7ef4\u62a4\u7b54\u6848\uff0c\u7531\u4e8e\u4e0d\u7528\u67e5\u8be2\u4fee\u6539\u94fe\u4e0a\u4fe1\u606f\uff0c\u4e0d\u9700\u8981\u4e0emakeroot\u6709\u5173\u7684\u51fd\u6570\u3002\u5206\u5757\u4e5f\u53ef\u4ee5\u5199\u3002\n\n\u4e0d\u4f1aLCT\u7684\u8bdd\u53ef\u4ee5\u770b\u770b\u6211\u7684[LCT\u603b\u7ed3](https://www.cnblogs.com/cj-chd/p/10065274.html)\u3002\n\n```cpp\n#include<cstdio>\n#include<cctype>\n#define R register\n#define I inline\nusing namespace std;\nconst int S=100003;\nchar buf[1000000],*p1,*p2;\nI char gc(){return p1==p2&&(p2=(p1=buf)+fread(buf,1,S,stdin),p1==p2)?EOF:*p1++;}\nI int rd(){\n\tR int f=0; R char c=gc();\n\twhile(c<48||c>57) c=gc();\n\twhile(c>47&&c<58) f=f*10+(c^48),c=gc();\n\treturn f;\n}\nstruct splay{int p,d[2],s;}e[S];\nI int min(int x,int y){return x<y?x:y;}\nI int nrt(int x){return e[e[x].p].d[0]==x||e[e[x].p].d[1]==x;}\nI void psu(int x){e[x].s=e[e[x].d[0]].s+e[e[x].d[1]].s+1;}\nI void rtt(int x){\n\tR int f=e[x].p,g=e[f].p,b=e[f].d[0]==x,c=e[x].d[b];\n\tif(nrt(f)) e[g].d[e[g].d[1]==f]=x;\n\tif(c) e[c].p=f;\n\te[x].p=g,e[f].p=x,e[x].d[b]=f,e[f].d[!b]=c,psu(f);\n}\nI void spl(int x){\n\tfor(R int f,g;nrt(x);rtt(x)){\n\t\tf=e[x].p,g=e[f].p;\n\t\tif(nrt(f))\n\t\t\trtt((e[g].d[1]==f)^(e[f].d[1]==x)?x:f);\n\t}\n\tpsu(x);\n}\nI void acc(int x){\n\tfor(R int y=0;x;x=e[y=x].p)\n\t\tspl(x),e[x].d[1]=y,psu(x);\n}\nI void cut(int x){acc(x),spl(x),e[e[x].d[0]].p=0,e[x].d[0]=0,psu(x);}\nI int frt(int x){\n\tacc(x),spl(x);\n\twhile(e[x].d[0])\n\t\tx=e[x].d[0];\n\treturn x;\n}\nint main(){\n\tR int n=rd(),m=rd(),i,x,y,z;\n\tfor(i=1;i<=n;++i){\n\t\tx=rd(),z=i+x;\n\t\tif(z<=n)\n\t\t\te[i].p=z;\n\t}\n\tfor(i=1;i<=m;++i){\n\t\tx=rd(),y=rd();\n\t\tif(x)\n\t\t\tprintf(\"%d \",frt(y)),printf(\"%d\\n\",e[y].s);\n\t\telse{\n\t\t\tx=rd(),cut(y),z=x+y;\n\t\t\tif(z<=n)\n\t\t\t\te[y].p=z;\n\t\t}\n\t}\n\treturn 0;\n}\n\n```\n\n",
        "postTime": 1545028192,
        "uid": 91933,
        "name": "newbiechd",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF13E \u3010Holes\u3011"
    },
    {
        "content": "emmm\u770b\u5b8c\u9898\u76ee\u672c\u6765\u60f3\u7528\u7ebf\u6bb5\u6811\u5199\u7684\uff0c\u4f46\u662f\u672c\u849f\u84bb\u5199\u70b8\u4e86\uff0c\u6837\u4f8b\u90fd\u8fc7\u4e0d\u4e86\uff0c\u6240\u4ee5\u5199\u4e86\u4e2a\u6c34\u6c34\u7684\u7eaf\u6a21\u62df\uff0c\u8c01\u77e5\u9053\u5c45\u7136\u8fc7\u4e86\u3002\u3002\n\u592a\u610f\u5916\u4e86\u3002\uff08\u4e0d\u9700\u8981\u4e00\u70b9\u4f18\u5316\uff09\n\n\u7a0b\u5e8f\u91cc\u5b57\u6bcd\u548c\u9898\u9762\u4e00\u6837\uff0c\u6ce8\u610f\u5b83\u662f\u5148\u8f93\u51fa\u6700\u540e\u843d\u5230\u54ea\u4e2a\u6d1e\uff01\n\ntt\u8bb0\u5f55\u7684\u662f\u6b21\u6570\uff0cbbb\u662f\u843d\u5730\u4f4d\u7f6e\uff0c\u7136\u540e..\u7136\u540e\u5c31\u6ca1\u6709\u4e86\u3002\u3002\n\n\u9644\u4ee3\u7801:\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nint n,power[10000],m,a,b,kk,bbb;\nint main(){\n\tscanf(\"%d %d\",&n,&m);\n\tfor(int i=1;i<=n;i++)scanf(\"%d\",&power[i]);\n\twhile(m--){\n\t     scanf(\"%d\",&kk);\n\t\t if(kk==0){\n\t\t \tscanf(\"%d%d\",&a,&b);\n\t\t \tpower[a]=b;\n\t\t }\t\n\t\t else {\n\t\t \tscanf(\"%d\",&a);\n\t\t \t bbb=a;\n      \t\tint tt=0;\n\t \t\twhile(1){\n\t\t\t     tt++;\n\t\t\t    if(power[a]+a>n)break;\n\t\t \t    bbb=power[a]+a;a=bbb; \n\t\t \t   \n\t\t \t}\n\t\t \tprintf(\"%d %d\\n\",bbb,tt );\n\t\t }\n\t\t\n\n\t}\n}\n```\n",
        "postTime": 1533176653,
        "uid": 47269,
        "name": "yzx72424",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF13E \u3010Holes\u3011"
    }
]
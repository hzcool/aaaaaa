[
    {
        "content": "### \u9898\u76ee\u5927\u610f\n\n\u6bcf\u6b21 check \u51fa\u4e00\u4e2a\u533a\u95f4\u662f\u5426\u80fd\u88ab\u91cd\u6392\u4e3a\u516c\u5dee\u4e3a $d$ \u7684\u7b49\u5dee\u6570\u5217\u3002\n\n---\n\n\u4e71\u641e\u8fc7\u53bb\u7684\uff08\n\n\u9996\u5148\u53ef\u4ee5\u5f88\u8f7b\u6613\u7684\u7b97\u51fa\u7b49\u5dee\u6570\u5217\u7684\u9996\u9879\u3002\n\n\u7136\u540e\u628a $d = 0$ \u548c $d >0$ \u5206\u5f00\u6765\u8003\u8651\u3002\n\n$d=0$ \u5f88\u597d\u505a\uff0c\u76f4\u63a5 check \u4e00\u4e0b\u6574\u4e2a\u533a\u95f4\u662f\u5426\u6240\u6709\u6570\u90fd\u76f8\u540c\u5373\u53ef\u3002\n\n$d>0$ \u7684\u8bdd\uff0c\u5148 check \u4e00\u4e0b\u662f\u5426\u6574\u4e2a\u533a\u95f4\u6240\u6709\u6570\u90fd\u4e0d\u540c\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u8f7b\u6613\u7684\u7528\u7ebf\u6bb5\u6811\u5b9e\u73b0\u3002\n\n\u7136\u540e\u5728\u533a\u95f4\u5185\u968f\u4e00\u4e9b\u6570\uff0c\u82e5\u5b83\u4e0d\u662f\u672b\u9879\u7684\u8bdd\u770b\u5b83\u7684\u540e\u7ee7\u662f\u5426\u5728 $[l,r]$ \u5185\u5373\u53ef\u3002\u53ef\u4ee5\u9884\u5904\u7406\u4e00\u4e2a set \u6765\u505a\u3002\n\n\u6b63\u786e\u7387\u5e94\u8be5\u5f88\u9ad8\uff0c\u81f3\u5c11\u6211\u4e0d\u4f1a\u5361\uff08\n\n\u5047\u8bbe\u6bcf\u6b21\u968f $B$ \u4e2a\u6570\uff0c\u90a3\u4e48\u65f6\u95f4\u590d\u6742\u5ea6\u5373\u4e3a $O(n\\log n + qB\\log n)$\u3002\n\n\u4e8b\u5b9e\u4e0a\u540e\u9762\u8fd9\u9879\u5e38\u6570\u5f88\u5c0f\uff0c$B$ \u53d6 $100$ \u53ef\u4ee5\u901a\u8fc7\u3002\n\n```cpp\n/*\n60 + 0 + 100 + 64 = 224.\n*/\n\n//#pragma GCC target(\"sse,sse2,sse3,ssse3,sse4,popcnt,abm,mmx,avx,avx2,tune=native\")\n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\ninline int read()\n{\n\tint sum = 0, nega = 1;\n\tchar ch = getchar();\n\twhile (ch > '9'||ch < '0')\n\t{\n\t    if (ch == '-') nega = -1;\n\t\tch = getchar();\n\t}\n\twhile (ch <= '9' && ch >= '0') sum = sum * 10 + ch - '0', ch = getchar();\n\treturn sum * nega;\n}\nconst int N = 2e5 + 9, mod = 1e9 + 7;\ninline int Pow(int x, int y) \n{\n\tint res = 1, base = x;\n\twhile(y) \n\t{\n\t\tif(y & 1) res = res * base % mod;\n\t\tbase = base * base % mod; y >>= 1; \n\t} return res;\n}\nint tr[N << 2], nxt[N], n, q, a[N];\ninline int lc(int p) {return p << 1;} \ninline int rc(int p) {return p << 1 | 1;}\ninline void build(int l, int r, int p) \n{\n\tif(l == r) {tr[p] = nxt[l]; return ;}\n\tint mid = (l + r) >> 1; build(l, mid, lc(p)), build(mid + 1, r, rc(p));\n\ttr[p] = min(tr[lc(p)], tr[rc(p)]); return ;\n}\ninline int query(int l, int r, int p, int L, int R) \n{\n\tif(L <= l && r <= R) return tr[p];\n\tint res = 1e9, mid = (l + r) >> 1; \n\tif(mid >= L) res = min(res, query(l, mid, lc(p), L, R));\n\tif(mid < R) res = min(res, query(mid + 1, r, rc(p), L, R)); return res;\n}\nmap<int, int> mp;\nset<int> s[N]; \nint cnt, tmp[N], sum[N], eq[N];\ninline bool find(int t, int l, int r) \n{\n\tif(!mp[t]) return 0;\n\tint po = mp[t];\n\tif(s[po].lower_bound(l) == s[po].end()) return 0;\n\tif(*s[po].lower_bound(l) > r) return 0;\n\treturn 1;\n}\nsigned main()\n{\n\tint B = 100;\n\tn = read(), q = read(); \n\tfor (int i = 1; i <= n; i++) a[i] = read(), sum[i] = (sum[i - 1] + a[i]) % mod, eq[i] = eq[i - 1] + (a[i] == a[i - 1]);\n\tfor (int i = 1; i <= n; i++) \n\t\tif(!mp[a[i]]) mp[a[i]] = ++cnt;\n\tfor (int i = 1; i <= n; i++) s[mp[a[i]]].insert(i);\n\tfor (int i = 1; i <= cnt; i++) tmp[i] = n + 1;\n\tfor (int i = n; i >= 1; i--) \n\t\tnxt[i] = tmp[mp[a[i]]], tmp[mp[a[i]]] = i;\n\tbuild(1, n, 1);\n\tfor (int i = 1; i <= q; i++) \n\t{\n\t\tint l = read(), r = read(), d = read(), len = (r - l + 1);\n\t\tif(l == r) {puts(\"Yes\"); continue;}\n\t\tif(query(1, n, 1, l, r) <= r && d) {puts(\"No\"); continue;}\n\t\tif(!d) \n\t\t{\n\t\t\tif(eq[r] - eq[l] == r - l) puts(\"Yes\");\n\t\t\telse puts(\"No\"); continue;\n\t\t}\n\t\tint su = (sum[r] - sum[l - 1] + mod) % mod, t = (su - len * (len - 1) / 2 % mod * d % mod + mod) % mod;\n//\t\tcout << su << \" \" << t << endl;\n\t\tt = t * Pow(len, mod - 2) % mod; int sb = (t + (len - 1) * d) % mod;\n\t\tif(!find(t, l, r)) {puts(\"No\"); continue;}\n\t\tbool fl = 0;\n\t\tfor (int j = 1; j <= B; j++) \n\t\t{\n\t\t\tint x = l + rand() % len;\n\t\t\tif(a[x] == sb) continue;\n\t\t\tif(!find((a[x] + d) % mod, l, r)) \n\t\t\t{\n\t\t\t\tputs(\"No\"); fl = 1; break;\n\t\t\t}\n\t\t}\n\t\tif(!fl) puts(\"Yes\"); \n\t} \n\treturn 0;\n}\n\n\n```\n",
        "postTime": 1677202431,
        "uid": 398188,
        "name": "Nagisa_Tomoya",
        "ccfLevel": 0,
        "title": "CF1599F Mars \u9898\u89e3"
    },
    {
        "content": "**CF1599F - Mars** / [**\u539f\u9898\u94fe\u63a5**](https://www.luogu.com.cn/problem/CF1599F) \n\n## \u89e3\u6cd5\n\n\u63d0\u4f9b\u4e00\u4e2a\u7384\u5b66\u505a\u6cd5\u3002\n\n\u8bbe $len=r-l+1$\uff0c\u76f8\u5f53\u4e8e\u5c06\u5e8f\u5217\u91cd\u6392\u6210\u4e00\u4e2a\u6709 $len$ \u9879\u4e14\u516c\u5dee\u4e3a $d$ \u7684\u5e8f\u5217\u3002\n\n\u627e\u5230\u4e00\u4e2a $k$\uff0c\u6211\u4eec\u8bd5\u7740\u53bb\u7ef4\u62a4\u8fd9\u4e2a\u7b49\u5dee\u5e8f\u5217\u7684\u6bcf\u4e2a\u6570\u5b57 $k$ \u6b21\u65b9\u7684\u548c\uff0c\u770b\u770b\u662f\u5426\u4e0e\u539f\u5e8f\u5217 $k$ \u6b21\u65b9\u7684\u548c\u76f8\u7b49\u3002\u6211\u4eec\u591a\u53d6\u51e0\u4e2a $k$\uff0c\u4f7f\u5f97\u9519\u8bef\u6027\u6781\u5c0f\uff0c\u5982\u679c\u90fd\u662f\u76f8\u7b49\u7684\uff0c\u5c31\u8ba4\u4e3a\u65b9\u6848\u5408\u6cd5\u3002\uff08\u6211\u53d6\u4e86 $k=2,3,6,7,8,9$\uff09\n\n\u5bb9\u6613\u7ed3\u5408\u5c0f\u5b66\u5965\u6570\u8ba1\u7b97\u51fa\uff0c\u6b64\u7b49\u5dee\u5e8f\u5217\u7684\u9996\u9879 $\\Large a=\\frac{\\sum\\limits_{i=l}^rN_i-\\frac{len*(len-1)*d}{2}}{len}$\u3002\uff08$N_i$ \u6307\u9898\u9762\u7ed9\u7684 $i$ \u53f7\u57ce\u5e02\u7684\u8ddd\u79bb\uff09\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u8981\u6c42 $\\sum\\limits_{i=0}^{len-1}(a+di)^k=\\sum\\limits_{i=l}^r N_i^k$\u3002\n\n\u7b49\u5f0f\u53f3\u8fb9\u5f88\u597d\u8ba1\u7b97\uff0c\u7528\u524d\u7f00\u548c\u5373\u53ef\u3002\n\n\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\uff0c\u7b49\u5f0f\u5de6\u8fb9 $\\text{LHS}=\\sum\\limits_{j=0}^k\\binom{k}{j}d^ja^{k-j}\\sum\\limits_{i=0}^{len-1} i^j$\u3002\u524d\u9762\u7684\u548c\u5f0f\u662f $O(k)$ \u7684\uff0c\u540e\u9762\u7684\u548c\u5f0f\u53ef\u4ee5\u7528\u524d\u7f00\u548c\u9884\u5904\u7406\uff0c\u6240\u4ee5\u603b\u5171\u662f $O(k)$ \u7684\u3002\n\n\u6700\u540e\u5224\u65ad\u662f\u5426\u76f8\u7b49\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n+Tk)$\u3002\n\n## \u4ee3\u7801\n\n\uff08\u6bd2\u7624\u7801\u98ce\uff09\n\n```c++\n#include<bits/stdc++.h>\n#define rep(i,x,y) for(int i=x;i<=y;++i)\n#define per(i,x,y) for(int i=x;i>=y;--i)\n#define lon long long\n#define pow BlankAo\nusing namespace std;\nconst int n7=201234,k7=12;\nconst lon mo=1000000007;\nint n,T;lon a[n7],b[n7],s[n7][k7],inv[n7],pow[n7][k7],spow[n7][k7],C[k7][k7];\n\nint rd(){\n\tint shu=0;bool fu=0;char ch=getchar();\n\twhile( !isdigit(ch) ){if(ch=='-')fu=1;ch=getchar();}\n\twhile( isdigit(ch) )shu=(shu<<1)+(shu<<3)+ch-'0',ch=getchar();\n\treturn fu?-shu:shu;\n}\n\nlon Dpow(lon p,lon q){\n\tlon tot=1;\n\twhile(q){\n\t\tif(q&1)tot=tot*p%mo;\n\t\tp=p*p%mo,q=q>>1;\n\t}\n\treturn tot;\n}\n\nvoid ready(){\n\trep(i,1,n)b[i]=1;\n\trep(j,1,10)rep(i,1,n){\n\t\tb[i]=b[i]*a[i]%mo;\n\t\ts[i][j]=(s[i-1][j]+b[i])%mo;\n\t}\n\t\n\tinv[1]=1;\n\trep(i,2,n)inv[i]=mo-(mo/i)*inv[mo%i]%mo;\n\t\n\trep(i,0,n)pow[i][0]=1;\n\trep(i,1,n)rep(j,1,10)pow[i][j]=pow[i][j-1]*i%mo;\n\trep(j,0,10)spow[0][j]=pow[0][j];\n\trep(j,0,10)rep(i,1,n)spow[i][j]=(spow[i-1][j]+pow[i][j])%mo;\n\t\n\trep(i,0,10)C[i][0]=1;\n\trep(i,1,10)rep(j,1,i){\n\t\tC[i][j]=(C[i-1][j]+C[i-1][j-1])%mo;\n\t}\n}\n\nlon Dcalc(lon me,lon A,lon d,int r){\n\tlon tot=0;\n\trep(i,0,me){\n\t\ttot=(tot+C[me][i]*Dpow(A,me-i)%mo*Dpow(d,i)%mo*spow[r][i]%mo)%mo;\n\t}\n\treturn tot;\n}\n\nbool calc(lon A,lon d,int l,int r){\n\tint me;\n\tme=2;if( Dcalc(me,A,d,r-l)^( (s[r][me]-s[l-1][me]+mo)%mo ) )return 0;\n\tme=3;if( Dcalc(me,A,d,r-l)^( (s[r][me]-s[l-1][me]+mo)%mo ) )return 0;\n\tme=6;if( Dcalc(me,A,d,r-l)^( (s[r][me]-s[l-1][me]+mo)%mo ) )return 0;\n\tme=7;if( Dcalc(me,A,d,r-l)^( (s[r][me]-s[l-1][me]+mo)%mo ) )return 0;\n\tme=8;if( Dcalc(me,A,d,r-l)^( (s[r][me]-s[l-1][me]+mo)%mo ) )return 0;\n\tme=9;if( Dcalc(me,A,d,r-l)^( (s[r][me]-s[l-1][me]+mo)%mo ) )return 0;\n\treturn 1;\n}\n\nint main(){\n\tn=rd(),T=rd();\n\trep(i,1,n)a[i]=rd();\n\tready();\n\twhile(T--){\n\t\tlon l=rd(),r=rd(),d=rd();\n\t\tlon A=( (s[r][1]-s[l-1][1]+mo)%mo-(r-l+1)*(r-l)%mo*d%mo*inv[2]%mo+mo )%mo*inv[r-l+1]%mo;\n\t\tputs(calc(A,d,l,r)?\"Yes\":\"No\");\n\t}\n\treturn 0;\n}\n\n```",
        "postTime": 1635752171,
        "uid": 99623,
        "name": "BlankAo",
        "ccfLevel": 0,
        "title": "CF1599F - Mars"
    },
    {
        "content": "\u8fd9\u9898\u5f88\u7c7b\u4f3c[\u5927\u6bcd\u795e](https://www.luogu.com.cn/problem/P3792)\u3002\n\n\u5728\u5927\u6bcd\u795e\u90a3\u9898\u4e2d\uff0c\u6709\u4e24\u79cd\u505a\u6cd5\uff1a\n\n1. \u54c8\u5e0c\uff08\u4e0d\u786e\u5b9a\u6027\uff09\n\n2. \u7ef4\u62a4\u5dee\u5206\u7684 gcd \u503c\uff08\u786e\u5b9a\u6027\uff09\n\n\u5728\u8fd9\u9898\u4e2d\uff0c\u52a0\u4e86\u53d6\u6a21\u7684\u6761\u4ef6\uff0c\u6240\u4ee5\u7b2c\u4e8c\u79cd\u505a\u6cd5\u5c31\u5f88\u96be\u4e86\uff0c\u8003\u8651\u7b2c\u4e00\u79cd\u505a\u6cd5\u54c8\u5e0c\u3002\n\n\u600e\u4e48\u77e5\u9053\u9996\u9879\uff1f\u5f88\u5bb9\u6613\u63a8\u5f97 $a=\\dfrac{S-dC_{x}^{2}}{x}$\uff0c\u5176\u4e2d $x$ \u662f\u533a\u95f4\u7684\u957f\u5ea6\uff0c$S$ \u662f\u533a\u95f4\u7684\u548c\uff0c$d$ \u662f\u516c\u5dee\u3002\n\n\u4e0b\u4e00\u6b65\uff0c\u6211\u4eec\u53ea\u8981\u627e\u5230\u4e00\u4e2a\u4e0d\u4f9d\u8d56\u4e8e\u987a\u5e8f\u7684\u54c8\u5e0c\u5c31\u53ef\u4ee5\u4e86\uff0c\u53ef\u4ee5\u9009\u62e9\u82e5\u5e72\u6b21\u65b9\u548c\u3002\u8fd9\u91cc\u6211\u968f\u4e86 $3$ \u4e2a $1\\sim 50$ \u7684\u6570\u3002\n\n\u5982\u679c\u51fa\u9898\u4eba\u5361\u4f60\u600e\u4e48\u529e\uff1f\u628a\u6570\u5217\u6bcf\u4e2a\u6570\u52a0\u4e2a\u76f8\u540c\u7684\u968f\u673a\u6570 $r$ \u5c31\u5b8c\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define mod 1000000007\nusing namespace std;\nint a[200005],s[200005],M[1005],S[25][200005];\nint L[55][200005],C[105][105];\nint powdv(int x,int y)\n{\n\tint ans=1;\n\twhile(y)\n\t{\n\t\tif(y&1)ans=1ll*ans*x%mod;\n\t\ty>>=1;\n\t\tx=1ll*x*x%mod;\n\t}\n\treturn ans;\n}\nint niyuan(int x)\n{\n\treturn powdv(x,mod-2);\n}\nint main()\n{\n\tsrand(time(0)+20090908);\n\tint n,m,r=rand(),T=3,J=50;\n\tcin>>n>>m;\n\tfor(int i=1;i<=T;i++)M[i]=rand()%J+1;\n\tfor(int i=0;i<=J;i++)\n\t{\n\t\tL[i][0]=powdv(0,i);\n\t\tfor(int j=1;j<=n;j++)L[i][j]=(L[i][j-1]+powdv(j,i))%mod;\n\t}\n\tfor(int i=0;i<=J;i++)\n\t{\n\t\tC[i][0]=1;\n\t\tfor(int j=1;j<=i;j++)C[i][j]=(C[i-1][j]+C[i-1][j-1])%mod;\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tscanf(\"%d\",&a[i]);\n\t\ts[i]=(s[i-1]+(a[i]=(a[i]+r)%mod))%mod;\n\t\tfor(int j=1;j<=T;j++)S[j][i]=(S[j][i-1]+powdv(a[i],M[j]))%mod;\n\t}\n\twhile(m--)\n\t{\n\t\tint l,r,d;\n\t\tscanf(\"%d%d%d\",&l,&r,&d);\n\t\tint x=r-l+1,SS=(s[r]-s[l-1])%mod;\n\t\tint sx=((SS-1ll*x*(x-1)/2%mod*d)%mod*niyuan(x)%mod+mod)%mod;\n\t\tint flag=1;\n\t\tfor(int j=1;j<=T;j++)\n\t\t{\n\t\t\tint k=M[j],he=0;\n\t\t\tfor(int l=0;l<=k;l++)\n\t\t\t{\n\t\t\t\tint SS=1ll*C[k][l]*powdv(d,l)%mod*powdv(sx,k-l)%mod;\n\t\t\t\the=(he+1ll*SS*L[l][x-1])%mod;\n\t\t\t}\n\t\t\tif((0ll+he-S[j][r]+S[j][l-1])%mod)\n\t\t\t{\n\t\t\t\tflag=0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(flag)printf(\"Yes\\n\");\n\t\telse printf(\"No\\n\");\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1635394840,
        "uid": 107484,
        "name": "wmy_goes_to_thu",
        "ccfLevel": 8,
        "title": "CF1599F"
    }
]
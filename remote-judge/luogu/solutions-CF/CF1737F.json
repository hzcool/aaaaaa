[
    {
        "content": "\u9996\u5148\u5982\u679c\u5b58\u5728\u4e00\u4e2a $b_i\\ge4$ \u5c31\u65e0\u89e3\u3002\u56e0\u4e3a\uff0c\u8fd9\u8981\u6c42 $n-1$ \u4e2a\u4f4d\u7f6e\u4e2d\u81f3\u5c11\u6709 $\\left\\lfloor\\dfrac{n-1}2\\right\\rfloor$ \u4e2a\u5728\u7b2c $p_i$ \u4e0a\u7684\u6307\u6570\u4e3a $0$ \u6216 $1$\uff0c\u4f46\u6ee1\u8db3\u8fd9\u4e2a\u8981\u6c42\u7684\u56e0\u5b50\u53ea\u6709 $\\dfrac{2n}{b_i+1}-1$ \u4e2a\u3002\u540c\u7406\u53ef\u4ee5\u8bc1\u660e\uff0c\u5982\u679c\u5b58\u5728 $b_i=3$ \u548c $b_j\\ge2$\uff0c\u6216\u8005\u5b58\u5728 $b_i=b_j=b_k=2$\uff0c\u4e5f\u65e0\u89e3\u3002\n\n\u5269\u4e0b\u7684\u60c5\u51b5\u662f\u4e0d\u662f\u5c31\u90fd\u6709\u89e3\u4e86\u5462\uff1f\u5982\u679c\u4e0d\u5b58\u5728 $b_i=1$\uff0c\u90a3\u4e48\u5269\u4e0b\u7684\u60c5\u51b5\u5c31\u662f\u6709\u9650\u7684\uff0c\u53ef\u4ee5\u624b\u73a9\u51fa\u6765\u5b83\u4eec\u7684\u89e3\u3002\u8fd9\u5927\u6982\u542f\u53d1\u6211\u4eec\u6bcf\u6b21\u52a0\u5165\u4e00\u4e2a $b_i=1$ \u7684\u8d28\u56e0\u5b50\u3002\n\n\u5047\u5b9a\u6211\u4eec\u73b0\u5728\u5df2\u7ecf\u5f97\u51fa\u4e86 $c$ \u7684\u7b54\u6848\uff0c\u5b83\u6709 $n$ \u4e2a\u56e0\u6570\uff0c\u6211\u4eec\u8981\u6839\u636e\u5b83\u6c42\u51fa $cp$ \u7684\u7b54\u6848\uff0c\u5176\u4e2d $p$ \u662f\u4e00\u4e2a\u8d28\u6570\u3002\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u59cb\u7ec8\u5728\u6211\u4eec\u7684\u7b54\u6848\u5e8f\u5217\u524d\u9762\u52a0\u4e00\u4e2a $1$\u3002\u90a3\u4e48\u6211\u4eec\u8981\u505a\u7684\u5176\u5b9e\u662f\uff0c\u4ee5\u67d0\u79cd\u65b9\u5f0f\u628a\u539f\u6765\u7684\u7b54\u6848\u5e8f\u5217\u590d\u5236\u4e00\u4efd\uff0c\u7136\u540e\u7ed9\u5176\u4e2d\u4e00\u4e9b\u4f4d\u7f6e\u4e58\u4e0a $p$\uff0c\u4f7f\u5f97\u6bcf\u4e2a\u6570\u548c\u5b83\u7684\u590d\u5236\u4e2d\u6070\u597d\u4e00\u4e2a\u88ab\u4e58\u4e86 $p$\uff0c\u5b8c\u4e86\u4ee5\u540e\u4f9d\u7136\u8981\u6ee1\u8db3 gcd \u7684\u9650\u5236\u3002\n\n\u4e0b\u9762\u76f4\u63a5\u8bf4\u505a\u6cd5\u4e86\u3002\u5f3a\u5316\u4e00\u4e0b\uff0c\u6211\u4eec\u8981\u6c42\u6211\u4eec\u5f97\u51fa\u7684\u7b54\u6848\u5e8f\u5217\u7684\u7ed3\u5c3e\u662f\u4e00\u4e2a\u8d28\u6570\u3002\u90a3\u4e48\uff0c\u6211\u4eec\u628a $c$ \u7684\u7b54\u6848\u5012\u7740\u590d\u5236\u4e00\u4efd\u63a5\u5728\u5b83\u540e\u9762\uff0c\u5f97\u5230\u4e00\u4e2a\u957f\u4e3a $2n$ \u7684\u5e8f\u5217\u3002\u63a5\u7740\uff0c\u628a\u5176\u4e2d\u9664\u7b2c\u4e00\u4f4d\u4ee5\u5916\u7684\u5947\u6570\u4f4d\uff0c\u4ee5\u53ca\u6700\u540e\u4e00\u4f4d\uff0c\u90fd\u4e58\u4e0a $p$\u3002\u8fd9\u6837\u5c31\u5f97\u5230\u4e86 $cp$ \u7684\u7b54\u6848\u5e8f\u5217\uff0c\u5e76\u4e14\u5b83\u8fd8\u662f\u6ee1\u8db3\u9650\u5236\u3002\n\n\u4f8b\u5982\uff0c\u4ece $x^2y^2$ \u5f97\u5230 $x^2y^2z$\uff08\u5176\u4e2d $x$\u3001$y$ \u548c $z$ \u5747\u4e3a\u8d28\u6570\uff09\u7684\u8fc7\u7a0b\u662f\u8fd9\u6837\u7684\uff1a\n$$\\begin{aligned}&[1,x^2y^2,y,x^2y,y^2,xy,x^2,xy^2,x]\\\\\\Rightarrow&[1,x^2y^2,y,x^2y,y^2,xy,x^2,xy^2,x,x,xy^2,x^2,xy,y^2,x^2y,y,x^2y^2,1]\\\\\\Rightarrow&[1,x^2y^2,yz,x^2y,y^2z,xy,x^2z,xy^2,xz,x,xy^2z,x^2,xyz,y^2,x^2yz,y,x^2y^2z,z]\\end{aligned}$$\n\u5728\u4e0d\u5b58\u5728 $b_i=1$ \u7684\u6570\u4e2d\uff0c\u5bf9\u4e8e\u5f62\u4e3a $x^2$ \u548c $x^2y^2$ \u7684\u6570\u90fd\u53ef\u4ee5\u624b\u73a9\u6784\u9020\u51fa\u4e00\u4e2a\u6ee1\u8db3\u6761\u4ef6\u7684\u521d\u59cb\u7b54\u6848\u5e8f\u5217\u3002\u5bf9\u4e8e $1$ \u6211\u4eec\u65e0\u6cd5\u6784\u9020\uff0c\u4f46\u662f\u53ef\u4ee5\u63d0\u524d\u62ff\u4e00\u4e2a $b_i=1$ \u7684\u56e0\u5b50 $x$ \u8fc7\u6765\uff0c\u90a3\u4e48 $x$ \u7684\u7b54\u6848\u5e8f\u5217\u5c31\u662f $[1,x]$\uff0c\u4e5f\u6ee1\u8db3\u6761\u4ef6\u3002\u4f46\u662f\uff0c\u5bf9\u4e8e\u5f62\u5982 $x^3$ \u7684\u6570\uff0c\u6211\u4eec\u65e0\u6cd5\u6784\u9020\u51fa\u8fd9\u6837\u7684\u7b54\u6848\u5e8f\u5217\u3002\n\n\u6b64\u65f6\u6211\u4eec\u6362\u4e00\u4e2a\u5904\u7406\u65b9\u6cd5\u3002\u989d\u5916\u7684\u9650\u5236\u6539\u4e3a\uff0c\u7b2c $\\dfrac n2+1$ \u4f4d\u662f $x$\uff0c\u7b2c $n$ \u4f4d\u662f $x^2$\u3002\u90a3\u4e48\u6211\u4eec\u52a0\u5165 $p$ \u65f6\u628a\u7b54\u6848\u5e8f\u5217\u987a\u7740\u590d\u5236\u4e00\u904d\u63a5\u5728\u540e\u9762\uff0c\u524d\u534a\u90e8\u5206\u5076\u6570\u4f4d\u4e58\u4e0a $p$\uff0c\u540e\u534a\u90e8\u5206\u5947\u6570\u4f4d\u4e58\u4e0a $p$\uff0c\u6700\u540e\u4ea4\u6362\u7b2c $\\dfrac n2+1$ \u4f4d\u548c\u7b2c $n+1$ \u4f4d\u3002\u4ece $x^3$ \u5230 $x^3y$ \u7684\u8fc7\u7a0b\u662f\u8fd9\u6837\u7684\uff1a\n$$\\begin{aligned}&[1,x^3,x,x^2]\\\\\\Rightarrow&[1,x^3,x,x^2,1,x^3,x,x^2]\\\\\\Rightarrow&[1,x^3y,x,x^2y,y,x^3,xy,x^2]\\\\\\Rightarrow&[1,x^3y,y,x^2y,x,x^3,xy,x^2]\\end{aligned}$$\n\u8fd9\u6837\u5c31\u5b8c\u6574\u89e3\u51b3\u4e86\u95ee\u9898\uff0c\u65f6\u7a7a\u590d\u6742\u5ea6\u4e3a $O(nm)$\u3002\u6709\u89e3\u7684\u60c5\u51b5\u4e0b $n$ \u662f $O(2^m)$ \u7ea7\u522b\u7684\uff0c\u65e0\u89e3\u7684\u5224\u65ad\u662f $O(m)$ \u65f6\u95f4\u3002\u4e0d\u8fc7\u8fd9\u9898\u53cd\u6b63\u7ed9\u7684\u662f $\\sum nm$ \u7684\u9650\u5236\uff0c\u90a3\u80af\u5b9a\u968f\u4fbf\u8fc7\u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nusing ll=long long;\ninline ll read(){\n\tll x=0;\n\tbool f=0;\n\tchar c=getchar();\n\twhile(!isdigit(c)){\n\t\tif(c=='-') f=1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c)){\n\t\tx=x*10+c-'0';\n\t\tc=getchar();\n\t}\n\treturn f?-x:x;\n}\nconst int maxn=2.3e5,maxm=16+5;\nint n,m,a[maxm],b[maxn][maxm];\nint main(){\n#ifdef LOCAL\n\tfreopen(\"in.txt\",\"r\",stdin);\n\tfreopen(\"out.txt\",\"w\",stdout);\n#endif\n\tint T=read();\n\twhile(T--){\n\t\tm=read();\n\t\tfor(int i=1;i<=m;i++) a[i]=read();\n\t\tvector<int> vec;\n\t\tfor(int i=1;i<=m;i++) if(a[i]>1) vec.push_back(i);\n\t\tbool flag=1;\n\t\tif(vec.size()>2) flag=0;\n\t\telse if(vec.size()==2) flag=a[vec[0]]==2&&a[vec[1]]==2;\n\t\telse if(vec.size()==1) flag=a[vec[0]]<=3;\n\t\tif(!flag){\n\t\t\tprintf(\"-1\\n\");\n\t\t\tcontinue;\n\t\t}\n\t\tif(vec.size()==1&&a[vec[0]]==3){\n\t\t\tn=4;\n\t\t\tfor(int i=1;i<=n;i++) memset(b[i],0,sizeof(b[i]));\n\t\t\tint x=vec[0];\n\t\t\tb[3][x]=1;\n\t\t\tb[4][x]=2;\n\t\t\tb[2][x]=3;\n\t\t\tfor(int i=1;i<=m;i++) if(a[i]==1){\n\t\t\t\tfor(int j=n+1;j<=n*2;j++) memcpy(b[j],b[j-n],sizeof(b[j]));\n\t\t\t\tfor(int j=2;j<=n;j+=2) b[j][i]=1;\n\t\t\t\tfor(int j=n+1;j<=n*2;j+=2) b[j][i]=1;\n\t\t\t\tswap(b[n/2+1],b[n+1]);\n\t\t\t\tn*=2;\n\t\t\t}\n\t\t}\n\t\telse{\n\t\t\tif(vec.size()==2){\n\t\t\t\tn=9;\n\t\t\t\tfor(int i=1;i<=n;i++) memset(b[i],0,sizeof(b[i]));\n\t\t\t\tint x=vec[0],y=vec[1];\n\t\t\t\tb[3][y]=b[4][y]=b[6][x]=b[6][y]=b[8][x]=b[9][x]=1;\n\t\t\t\tb[2][x]=b[2][y]=b[4][x]=b[5][y]=b[7][x]=b[8][y]=2;\n\t\t\t}\n\t\t\telse if(vec.size()==1){\n\t\t\t\tn=3;\n\t\t\t\tfor(int i=1;i<=n;i++) memset(b[i],0,sizeof(b[i]));\n\t\t\t\tint x=vec[0];\n\t\t\t\tb[3][x]=1;\n\t\t\t\tb[2][x]=2;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tn=2;\n\t\t\t\tfor(int i=1;i<=n;i++) memset(b[i],0,sizeof(b[i]));\n\t\t\t\tb[2][1]=1;\n\t\t\t}\n\t\t\tfor(int i=vec.size()?1:2;i<=m;i++) if(a[i]==1){\n\t\t\t\tfor(int j=n+1;j<=n*2;j++) memcpy(b[j],b[n*2-j+1],sizeof(b[j]));\n\t\t\t\tfor(int j=3;j<=n*2;j+=2) b[j][i]=1;\n\t\t\t\tb[n*2][i]=1;\n\t\t\t\tn*=2;\n\t\t\t}\n\t\t}\n\t\tfor(int i=2;i<=n;i++){\n\t\t\tfor(int j=1;j<=m;j++) printf(\"%d \",b[i][j]);\n\t\t\tprintf(\"\\n\");\n\t\t}\n\t}\n#ifdef LOCAL\n\tfprintf(stderr,\"%f\\n\",1.0*clock()/CLOCKS_PER_SEC);\n#endif\n\treturn 0;\n}\n```",
        "postTime": 1665410219,
        "uid": 174045,
        "name": "FZzzz",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1737F Ela and Prime GCD"
    }
]
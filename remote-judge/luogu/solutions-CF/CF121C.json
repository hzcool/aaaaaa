[
    {
        "content": "#### \u9898\u610f\uff1a\n\n\u5b9a\u4e49\uff1a\u5e78\u8fd0\u6570\u5b57\u662f\u6307\u53ea\u542b 4 \u548c 7 \u7684\u6570\u5b57\u3002\n\n\u6c42\u5728 1 \u5230 $n$ \u7684\u7b2c $k$ \u4e2a\u5168\u6392\u5217\u4e2d\u6709\u591a\u5c11\u5143\u7d20\u7684\u4e0b\u6807\u548c\u503c\u90fd\u662f\u5e78\u8fd0\u6570\u3002\n\n$1 \\leq n,k\\leq 10^9$\n\n#### \u5206\u6790\uff1a\n\n\u6ce8\u610f\u5230 $n$ \u548c $k$ \u7684\u8303\u56f4\u5f88\u5927\uff0c\u80af\u5b9a\u662f\u6ca1\u529e\u6cd5\u5f3a\u7b97\u7684\u3002\n\n\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u8981\u8fd4\u56de\u5168\u6392\u5217\u7684\u5b9a\u4e49\u548c\u6027\u8d28\u3002\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217\u6709 $n!$ \u79cd\u6392\u5217\u3002\u4ee5\u4e0b\u5206\u6790\u90fd\u662f\u6309\u7167\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217\u3002\n\n\u8fd9\u4e2a $n!$ \u662f\u7531 $n*(n-1)!$ \u5f97\u5230\u7684\uff0c\u4e5f\u5c31\u662f\u8bf4\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u7b2c\u4e00\u4f4d\u90fd\u6709 $(n-1)!$ \u79cd\u65b9\u6848\u3002\u7b2c\u4e00\u4f4d\u6bcf\u589e\u52a0 1 \u76f8\u5f53\u4e8e\u6392\u5217\u65b9\u6848\u589e\u52a0 $(n-1)!$ \u6362\u53e5\u8bdd\u8bf4\u5c31\u662f\u5982\u679c\u5f53\u524d\u662f\u7b2c $x$ \u79cd\u65b9\u6848\u90a3\u4e48\u5f53\u9996\u4f4d\u589e\u52a0 1 \u65f6\u53d8\u6210\u4e86\u7b2c $x+(n-1)!$ \u79cd\u65b9\u6848\u3002\n\n\u8fd0\u7528\u8fd9\u4e2a\u6027\u8d28\u53d1\u73b0\u4f1a\u53d8\u7684\u53ea\u6709\u5e8f\u5217\u7684\u6700\u540e\u5341\u51e0\u4e2a\u6570\u3002\u56e0\u4e3a\u5341\u51e0\u7684\u9636\u4e58\u5c31\u5df2\u7ecf\u8d85\u8fc7\u4e86 $10^9$\u3002\u4e0d\u59a8\u628a\u4ed6\u4eec\u5355\u72ec\u5904\u7406\u3002\u8fd0\u7528\u4e0a\u9762\u7684\u7ed3\u8bba\u5373\u53ef $O(m^2 \\log m)$ \u8ba1\u7b97\u7b2c $k$ \u5c0f\u7684\u5b57\u5178\u5e8f\u3002$m$ \u4e3a\u4f1a\u6539\u53d8\u7684\u6570\u5217\u90e8\u5206\u7684\u603b\u957f\u5ea6\uff0c\u6700\u591a\u5341\u51e0\u4e2a\u3002\n\n#### \u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define mem(a,b) memset(a,b,sizeof(a));\n#define pc putchar\n#define fast_iostream ios::sync_with_stdio(0),cin.tie(0),cout.tie(0)\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef long double ld;\ntypedef double db;\nconst ld EPS=1e-8;\nconst ll INF=ll(1e9+7);\nconst ll LLINF=ll(1e18+7);\nconst ld LDEPS=1e-18;\ninline ll max(ll x,ll y){return x>y?x:y;}\ninline ll min(ll x,ll y){return x<y?x:y;}\ninline ld dmax(ld x,ld y){return x>y?x:y;}\ninline ld dmin(ld x,ld y){return x<y?x:y;}\ninline ll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\ninline ll lcm(ll a,ll b){return a*b/gcd(a,b);}\ninline ll lowbit(ll x){return x&(-x);}\ninline ll read(){ll read_result=0,is_below_0=0;char now_ch=0;while(!isdigit(now_ch)){is_below_0|=now_ch=='-';now_ch=getchar();}while(isdigit(now_ch)){read_result=(read_result<<3)+(read_result<<1)+(now_ch^48);now_ch=getchar();}return is_below_0?-read_result:read_result;}\ninline ld dread(){ld x=0,d=0.1;char f=0,ch=getchar();while(!isdigit(ch))f|=(ch=='-'),ch=getchar();while(isdigit(ch)) x=x*10+ch-48,ch=getchar();if(ch=='.'){ch=getchar();while(isdigit(ch))x+=d*(ch^48),d*=0.1,ch=getchar();}return f?-x:x;}\ninline void write(ll x){if(x<0){putchar('-');x=-x;}if(x>9){write(x/10);}putchar(x%10+'0');}\nconst ll MAXN=1e9+7;\nll n,k,bas[1200],a[100007],b[100007];\nvector<ll>luck;\nvoid dfs(ll x)\n{\n\tif(x>MAXN)return ;\n\tif(x)luck.push_back(x);\n\tdfs(x*10+4),dfs(x*10+7);\n}\nbool check(ll x)\n{\n\twhile(x>0)\n\t{\n\t\tif(x%10!=4&&x%10!=7)return 0;\n\t\tx/=10;\n\t}\n\treturn 1;\n}\nint main()\n{\n\tdfs(0);\n\tbas[0]=1;\n\tfor(ll i=1;i<=15;i++)bas[i]=bas[i-1]*i;\n\tn=read(),k=read();\n\tll pos=0;\n\tfor(ll i=1;i<=min(15,n);i++)\n\t\tif(bas[i]>=k)\n\t\t{\n\t\t\tpos=i;\n\t\t\tbreak;\n\t\t}\n\tif(bas[pos]<k)\n\t{\n\t\tputs(\"-1\");\n\t\treturn 0;\n\t}\n\tll ans=0;\n\tfor(ll i=0;i<luck.size();i++)if(luck[i]<n-pos+1)ans++;//\u5904\u7406\u4e0d\u4f1a\u53d8\u7684\u6570\u7684\u8d21\u732e\n\tfor(ll i=1;i<=pos;i++)a[i]=n-i+1;//h\n\tsort(a+1,a+pos+1);k--;\n\tfor(ll i=1;i<=pos;i++)\n\t{\n\t\tif(k<=0)break;\n\t\tif(k<bas[pos-i])continue;\n\t\tll p=k/bas[pos-i];\n\t\tswap(a[i],a[i+p]);\n\t\tk%=bas[pos-i];\n\t\tsort(a+i+1,a+pos+1);\n\t}\n\tfor(ll i=1;i<=pos;i++)\n\t\tif(check(i+n-pos)&&check(a[i]))ans++;\n\twrite(ans);\n\treturn 0;\n}\n```",
        "postTime": 1642145150,
        "uid": 395288,
        "name": "Yuby",
        "ccfLevel": 6,
        "title": "CF121C\u9898\u89e3"
    },
    {
        "content": "\u7531\u4e8e\u9636\u4e58\u7684\u6570\u91cf\u589e\u957f\u975e\u5e38\u8fc5\u901f\uff0c\u800c$k$\u53c8\u975e\u5e38\u5c0f\uff0c\u90a3\u4e48\u663e\u7136\u6700\u540e\u7684\u5e8f\u5217\u53ea\u6709\u6700\u540e\u51e0\u4f4d\u4f1a\u53d1\u751f\u6539\u53d8\uff0c\u524d\u9762\u7684\u4f4d\u7f6e\u90fd\u662f$i = a[i]$\u3002\u90a3\u4e48\u524d\u9762\u7684\u53ef\u4ee5\u76f4\u63a5\u6570\u4f4ddp/\u7206\u641c\uff0c\u540e\u9762\u7684\u90e8\u5206\u662f\u7ecf\u5178\u95ee\u9898\uff0c\u53ef\u4ee5\u7528\u9006\u5eb7\u6258\u5c55\u5f00\u8ba1\u7b97\u3002\n```cpp\n/*\n*/\n#include<bits/stdc++.h> \n#define Pair pair<int, int>\n#define MP(x, y) make_pair(x, y)\n#define fi first\n#define se second\n#define int long long \n#define LL long long \n#define Fin(x) {freopen(#x\".in\",\"r\",stdin);}\n#define Fout(x) {freopen(#x\".out\",\"w\",stdout);}\nusing namespace std;\nconst int MAXN = 1e6 + 1, mod = 1e9 + 7, INF = 1e9 + 10;\nconst double eps = 1e-9;\ntemplate <typename A, typename B> inline bool chmin(A &a, B b){if(a > b) {a = b; return 1;} return 0;}\ntemplate <typename A, typename B> inline bool chmax(A &a, B b){if(a < b) {a = b; return 1;} return 0;}\ntemplate <typename A, typename B> inline LL add(A x, B y) {if(x + y < 0) return x + y + mod; return x + y >= mod ? x + y - mod : x + y;}\ntemplate <typename A, typename B> inline void add2(A &x, B y) {if(x + y < 0) x = x + y + mod; else x = (x + y >= mod ? x + y - mod : x + y);}\ntemplate <typename A, typename B> inline LL mul(A x, B y) {return 1ll * x * y % mod;}\ntemplate <typename A, typename B> inline void mul2(A &x, B y) {x = (1ll * x * y % mod + mod) % mod;}\ntemplate <typename A> inline void debug(A a){cout << a << '\\n';}\ntemplate <typename A> inline LL sqr(A x){return 1ll * x * x;}\ninline int read() {\n    char c = getchar(); int x = 0, f = 1;\n    while(c < '0' || c > '9') {if(c == '-') f = -1; c = getchar();}\n    while(c >= '0' && c <= '9') x = x * 10 + c - '0', c = getchar();\n    return x * f;\n}\nint N, K, fac[MAXN];\nvector<int> res;\nint find(int x) {\n\tsort(res.begin(), res.end());\n\tint t = res[x];\n\tres.erase(res.begin() + x);\n\treturn t;\n}\nbool check(int x) {\n\twhile(x) {\n\t\tif((x % 10) != 4 && (x % 10) != 7) return 0;\n\t\tx /= 10;\n\t}\n\treturn 1;\n}\nint ans;\nvoid dfs(int x, int Lim) {//\u8ba1\u7b971 - lim\u4e2d\u53ea\u5305\u542b4 7\u7684\u6570\u91cf \n\tif(x > Lim) return ;\n\tif(x != 0) ans++;\n\tdfs(x * 10 + 4, Lim);\n\tdfs(x * 10 + 7, Lim);\n}\nsigned main() {\n\tN = read(); K = read() - 1;\n\tint T = -1; fac[0] = 1;\n\tfor(int i = 1; i <= N;i++) {\n\t\tfac[i] = i * fac[i - 1];\n\t\tres.push_back(N - i + 1);\n\t\tif(fac[i] > K) {T = i; break;}\n\t}\n\tif(T == -1) {puts(\"-1\"); return 0;}\n    dfs(0, N - T);\n    for(int i = T; i >= 1; i--) {\n \t   \tint t = find(K / fac[i - 1]), pos = N - i + 1;\n    \tif(check(pos) && check(t)) ans++;\n    \tK = K % fac[i - 1];\n\t}\n\tcout << ans;\n\treturn 0;\n}\n/*\n\n*/\n```",
        "postTime": 1546696332,
        "uid": 36984,
        "name": "attack",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF121C \u3010Lucky Permutation\u3011"
    }
]
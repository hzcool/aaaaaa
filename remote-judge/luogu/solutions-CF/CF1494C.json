[
    {
        "content": "\u6b63\u8d1f\u7684\u7bb1\u5b50\u662f\u72ec\u7acb\u7684\u4e24\u90e8\u5206\uff0c\u6211\u4eec\u5206\u5f00\u8003\u8651\uff0c\u73b0\u5728\u53ea\u8003\u8651\u6b63\u7684\u90a3\u90e8\u5206\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u7b2c\u4e00\u4e2a\u7bb1\u5b50\u63a8\u5230\u54ea\u4e2a\u4f4d\u7f6e\uff0c\u4f46\u662f\u76f4\u63a5\u679a\u4e3e\u7684\u8bdd\u5c31\u65e0\u4e86\uff0c\u5176\u5b9e\u7b2c\u4e00\u4e2a\u7bb1\u5b50\u4e00\u5b9a\u662f\u5728\u7279\u6b8a\u70b9\u4e0a\u662f\u6700\u4f18\u7684\u3002\u5047\u5982\u4e0d\u5728\u7279\u6b8a\u70b9\u4e0a\uff0c\u628a\u6574\u4f53\u5f80\u53f3\u63a8\u5230\u7279\u6b8a\u70b9\u4e0a\uff0c\u6b64\u65f6\u5360\u636e\u7684\u7279\u6b8a\u70b9\u4e2a\u6570\u4e0d\u4f1a\u53d8\u5c11\uff0c\u56e0\u4e3a\u6211\u4eec\u662f\u5b8c\u5168\u8986\u76d6\u540e\u9762\u7684\u533a\u95f4\u3002\u81f3\u4e8e\u600e\u4e48\u7b97\u5f53\u524d\u70b9\u540e\u9762\u5ef6\u7533\u4e86\u591a\u5c11\u70b9\uff0c\u53d1\u73b0\u5ef6\u7533\u7684\u70b9\u662f\u5355\u8c03\u9012\u589e\u7684\uff0c\u6240\u4ee5\u6ca1\u5f80\u540e\u591a\u5ef6\u7533\u4e00\u4e2a\u70b9\u5c31\u66f4\u65b0\u4e00\u4e2a\u672b\u5c3e\u8ddd\u79bb\uff0c\u540c\u65f6\u770b\u770b\u80fd\u4e0d\u80fd\u518d\u5f80\u4e0b\u78b0\u5230\u5176\u4ed6\u7bb1\u5b50\u3002\n\n--------\n```c\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nconst int N=2e5+5;\nint a[N],b[N],vis[N];\nint main(){\n\tint T; scanf(\"%d\",&T); while(T--){\n\tint n,m; scanf(\"%d %d\",&n,&m);\n\tint sta=1,stb=1;\n\tfor(int i=1;i<=n;++i){ \n\t\tvis[i]=0; scanf(\"%d\",&a[i]); \n\t\tif(a[i-1]<0 && a[i]>0){\n\t\t\tsta=i;\n\t\t} \n\t}\n\tfor(int i=1;i<=m;++i){\n\t\tvis[i]=0; \n\t\tscanf(\"%d\",&b[i]); \n\t\tif(b[i-1]<0 && b[i]>0){\n\t\t\tstb=i; \n\t\t} \n\t}\n\tfor(int i=1;i<=n;++i){\n\t\tint x=lower_bound(b+1,b+m+1,a[i])-b;\n\t\tif(b[x]==a[i]) vis[x]=1;\n\t}\n\tint ans=0;\n\tif(a[n]<0 && sta==1) sta=n+1; \n\tif(b[m]<0 && stb==1) stb=m+1;\n\tif(sta>1 && stb>1){\n\t\tfor(int i=stb;i>=1;--i) vis[i]+=vis[i+1];\n\t\tint res=0;\n\t\tfor(int i=stb-1;i>=1;--i){\n\t\t\tint x=lower_bound(a+1,a+n+1,b[i])-a;\n\t\t\tint num=sta-x;\n\t\t\tint y=lower_bound(b+1,b+m+1,b[i]+num-1)-b;\n\t\t\tint nowans=y-i;\n\t\t\tif(b[y]==b[i]+num-1){\n\t\t\t\tnowans++;\n\t\t\t}\n\t\t\tres=max(res,nowans+vis[1]-vis[i]);\n\t\t}\n\t\tans+=res;\n\t}\n\tif(a[n]>0 && b[m]>0){\n\t\tfor(int i=stb;i<=m;++i){\n\t\t\tvis[i]+=vis[i-1];\n\t\t}\n\t\tint res=0;\n\t\tfor(int i=stb;i<=m;++i){\n\t\t\tint x=upper_bound(a+1,a+n+1,b[i])-a-1;\n\t\t\tint num=x-sta+1;\n\t\t\tint y=lower_bound(b+1,b+m+1,b[i]-num+1)-b;\n\t\t\tint nowans=i-y+1;\n\t\t\tres=max(res,nowans+vis[m]-vis[i]);\n\t\t}\n\t\tans+=res;\n\t\t}\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1678371194,
        "uid": 546103,
        "name": "\u5927\u5b9d\u548c\u5c0f\u5b9d",
        "ccfLevel": 0,
        "title": "1D Sokoban"
    },
    {
        "content": "\u53ef\u4ee5\u505a\u5230$O(Tn)$\n\n\n------------\n\n\u663e\u7136\u53ef\u4ee5\u6b63\u8d1f\u6570\u65b9\u5411\u5206\u5f00\u8ba8\u8bba\uff0c\u6b63\u6570\uff1a\n\n\u9996\u5148\u8981\u5904\u7406\u524d\u7f00\u548c$sum_i$\uff0c\u8868\u793a\u4ece$0$\u5f00\u59cb\uff0c\u80fd\u63a8$sum_i$\u4e2a\u7bb1\u5b50\u8fc7\u6765\u3002\u8fd9\u4e2a\u5177\u4f53\u770b\u4ee3\u7801\uff0c\u7528\u4e24\u4e2a\u6307\u9488$O(n)$\u80fd\u5f88\u8f7b\u677e\u5b8c\u6210\u3002\n\n\u518d\u5904\u7406$in_i$\uff0c\u8868\u793a\u4ece$0$\u5f00\u59cb\u4e00\u5171\u6709$in_i$\u5728\u63a8\u7bb1\u5b50\u4e4b\u524d\u5df2\u7ecf\u5728\u4ed6\u7684\u4f4d\u7f6e\u4e0a\u4e86\n\n\u6211\u4eec\u679a\u4e3e\u6bcf\u4e00\u4e2a\u4f4d\u7f6e$i$\uff1a\n\n- \u6211\u4eec\u60f3\u518d\u627e\u5230\u4e00\u4e2a\u4f4d\u7f6e$j$\uff0c\u4f7f\u5f97\u63a8\u6765\u7684\u7bb1\u5b50\u521a\u597d\u80fd\u8fbe\u5230\u6216\u8d85\u8fc7\u8fd9\u4e2a\u70b9\u3002\u6ce8\u610f\u8fd9\u91cc\u63a8\u6765\u7684\u7bb1\u5b50\u4e0d\u6b62$sum_i$\uff0c\u800c\u5e94\u8be5\u662f$sum_j$\uff0c\u56e0\u4e3a$i$\u5230$j$\u7684\u7bb1\u5b50\u4e5f\u4f1a\u88ab\u63a8\u8fc7\u6765\uff0c\u6240\u4ee5\u5e94\u8be5\u662f$sum_i + (sum_j - sum_i) == sum_j$\n\n- \u6211\u4eec\u73b0\u5728\u5c31\u6709$sum_j$\u4e2a\u7bb1\u5b50\uff0c\u800c\u4e24\u70b9\u7684\u683c\u5b50\u6570\u6709$b[j] - b[i] + 1$\uff0c\u5982\u679c$b[j] - b[i] + 1 \\leq sum_j$\u5c31\u8bf4\u660e$j$\u8fd9\u4e2a\u70b9\u5408\u6cd5\u3002\n\n- \u663e\u7136\uff0c\u8fd9\u4e2a\u4f4d\u7f6e$j$\u662f\u5355\u8c03\u7684\uff0c\u56e0\u6b64\u4e8c\u5206\u5373\u53ef\u3002\n\n\u4f46\u662f\u6211\u4eec\u518d\u60f3\u60f3\uff0c\u5f53$i$\u5355\u8c03\u65f6\uff0c$j$\u80af\u5b9a\u4e5f\u662f\u5355\u8c03\u7684\uff08\u79ef\u7d2f\u7684\u7bb1\u5b50\u4f1a\u8d8a\u6765\u8d8a\u591a\uff09\uff0c\u6240\u4ee5\u4e5f\u662f\u7528\u4e24\u4e2a\u6307\u9488\u5c31\u53ef\u4ee5\u7ef4\u62a4\u4e86\n\n\u8d1f\u6570\u8fb9\u76f8\u4f3c\uff0c\u4f46\u662f\u6ce8\u610f\u8fb9\u754c\u3002\n\n```cpp\n#include <iostream>\n#include <unordered_set>\n#include <algorithm>\n#include <cstring>\nusing namespace std;\n\nconstexpr size_t MAXN = 2e5 + 5;\nint a[MAXN], b[MAXN];\nint sum[MAXN], in[MAXN];//sum \u524d\u7f00\u548c\uff0cin \uff08\u5df2\u7ecf\u5728\u4f4d\u7f6e\u4e0a\u7684\u70b9\u4e2a\u6570\uff09\u7684\u524d\u7f00\u548c\nint T, n, m;\n\nsigned main() {\n\tios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n\tcin >> T;\n\tfor (int t = 1; t <= T; t++) {\n\t\tcin >> n >> m;\n\t\tunordered_set<int> s;\n\t\tfor (int i = 0; i < m; i++) in[i] = sum[i] = 0;\n\t\tfor (int i = 0; i < n; i++) cin >> a[i], s.insert(a[i]);\n\t\tfor (int i = 0; i < m; i++) cin >> b[i], in[i] = (s.count(b[i]) >= 1);\n\t\tfor (int i = 1; i < m; i++) in[i] += in[i - 1];\n\t\t//\u5206\u522b\u627e\u5230a,b\u8d1f\u6570\u8fb9\u5f00\u59cb\u7684\u70b9\uff0c\u7edf\u8ba1\u524d\u7f00\u548c\n\t\tint ta = lower_bound(a, a + n, 0) - a - 1;\n\t\tint tb = lower_bound(b, b + m, 0) - b - 1;\n\t\twhile (tb >= 0) {\n\t\t\twhile (ta >= 0 && a[ta] >= b[tb]) sum[tb]++, ta--;\n\t\t\ttb--;\n\t\t}\n\t\t//\u5206\u522b\u627e\u5230a,b\u6b63\u6570\u8fb9\u5f00\u59cb\u7684\u70b9\uff0c\u7edf\u8ba1\u524d\u7f00\u548c\n\t\tta = lower_bound(a, a + n, 0) - a;\n\t\ttb = lower_bound(b, b + m, 0) - b;\n\t\twhile (tb < m) {\n\t\t\twhile (a[ta] <= b[tb] && ta < n) sum[tb]++, ta++;\n\t\t\ttb++;\n\t\t}\n\t\t// b\u6570\u7ec4\u4e2d pos <= posl\u662f\u8d1f\u6570\u8fb9 pos >= posr\u662f\u6b63\u6570\u8fb9 \n\t\tint posl = lower_bound(b, b + m, 0) - b - 1, posr = posl + 1;\n\t\tfor (int i = posl - 1; i >= 0; i--) sum[i] += sum[i + 1];\n\t\tfor (int i = posr + 1; i < m; i++) sum[i] += sum[i - 1];\n\t\tint ansl = 0, ansr = 0;\n\t\t//\u5904\u7406\u8d1f\u6570\u8fb9\n\t\tfor (int i = posl, mx = posl + 1; i >= 0; i--) {\n\t\t\twhile (mx - 1 >= 0 && b[i] - b[mx - 1] + 1 <= sum[mx - 1]) mx--;\n\t\t\tif (mx >= 1)\n\t\t\t\tansl = max(ansl, i - mx + 1 + in[mx - 1]);\n\t\t\telse\n\t\t\t\tansl = max(ansl, i - mx + 1);\n\t\t}\n\t\t//\u5904\u7406\u6b63\u6570\u8fb9\n\t\tfor (int i = posr, mx = posr - 1; i < m; i++) {\n\t\t\twhile (mx + 1 < m && b[mx + 1] - b[i] + 1 <= sum[mx + 1]) mx++;\n\t\t\tansr = max(ansr, mx - i + 1 + in[m - 1] - in[mx]);\n\t\t}\n\t\tint ans = ansl + ansr;\n\t\tcout << ans << '\\n';\n\t}\n}\n```\n",
        "postTime": 1615024649,
        "uid": 29354,
        "name": "CodyTheWolf",
        "ccfLevel": 4,
        "title": "CF1494C"
    },
    {
        "content": "[\u539f\u9898](https://www.luogu.com.cn/problem/CF1494C)\n\n\u663e\u7136\u6b63\u8d1f\u53ef\u4ee5\u5206\u5f00\u5904\u7406\u3002\u4e0b\u9762\u4ee5\u6b63\u6570\u4e3a\u4f8b\u3002\n\n\u6700\u540e\u7684\u72b6\u6001\u4e2d\uff0c\u7bb1\u5b50\u53ef\u4ee5\u5206\u4e3a\u4e24\u90e8\u5206\uff1a\u4ece\u7b2c\u4e00\u4e2a\u7bb1\u5b50\u5f00\u59cb\u5230\u67d0\u4e00\u4e2a\u7bb1\u5b50\u88ab\u63a8\u5230\u4e00\u8d77\uff0c\u5176\u672b\u6bb5\u662f\u4e00\u4e2a\u5f97\u5206\u70b9\u3002\u4e4b\u540e\u7684\u7bb1\u5b50\u7559\u5728\u539f\u4f4d\u3002\n\n\u679a\u4e3e\u90a3\u4e00\u4e32\u7bb1\u5b50\u7684\u672b\u7aef\u5f97\u5206\u70b9\uff0c\u90a3\u4e48\u5f53\u524d\u8d21\u732e\u53ef\u4ee5\u5206\u4e3a\u4e24\u90e8\u5206\uff1a\u90a3\u8fde\u5728\u4e00\u8d77\u7684\u7bb1\u5b50\u6240\u6db5\u76d6\u7684\u5f97\u5206\u70b9\u6570\u91cf\uff0c\u4ee5\u53ca\u4e4b\u540e\u672c\u5c31\u5728\u5f97\u5206\u70b9\u4e0a\u7684\u7bb1\u5b50\u6570\u91cf\u3002\n\n\u540e\u8005\u53ef\u4ee5\u9884\u5904\u7406\u4e00\u4e2a\u540e\u7f00\u548c\u3002\n\n\u524d\u8005\u53ef\u4ee5\u4e8c\u5206\u51fa\u90a3\u4e00\u4e32\u7bb1\u5b50\u7684\u6700\u540e\u4e00\u4e2a\u7bb1\u5b50\u7f16\u53f7\uff0c\u4ece\u800c\u5f97\u51fa\u90a3\u4e00\u4e32\u7bb1\u5b50\u7684\u6570\u91cf\uff0c\u7b97\u51fa\u90a3\u4e00\u4e32\u7bb1\u5b50\u7684\u8d77\u70b9\u3002\u63a5\u7740\u5c31\u53ef\u4ee5\u4e8c\u5206\u6700\u540e\u4e00\u4e2a\u5c0f\u4e8e\u90a3\u4e32\u7bb1\u5b50\u8d77\u70b9\u7684\u5f97\u5206\u70b9\u4f4d\u7f6e\uff0c\u4ece\u800c\u7b97\u51fa\u6db5\u76d6\u7684\u5f97\u5206\u70b9\u6570\u91cf\u3002\n\n\u5f53\u7136\u8981\u5148\u4fdd\u8bc1\u5e8f\u5217\u6709\u5e8f\u3002\n\n\u8fd9\u6837\u53ef\u4ee5\u5355\u6b21 $O(\\log n)$ \u8ba1\u7b97\uff0c\u603b\u590d\u6742\u5ea6\u4e3a $O(n \\log n)$ \u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#pragma GCC optimize(2)\n\n#include <cstdio>\n#include <vector>\n#include <algorithm>\n\nconst int maxn = 2e5 + 5;\n\ntemplate<typename T>\ninline T max(const T &a,const T &b){\n\treturn a>b?a:b;\n}\n\nstruct IO{\n\tIO(){};char c;\n\tinline char gc(){\n\t\tstatic char buf[maxn],*p1=buf,*p2=buf;\n\t\treturn p1==p2&&(p2=(p1=buf)+fread(buf,1,maxn,stdin),p1==p2)?EOF:*p1++;\n\t}\n\ttemplate<typename T>\n\tinline IO&operator>>(T &_){\n\t\t_=0;bool f=1;c=gc();while(c<'0'||c>'9'){if(c=='-') f=0; c=gc();}\n\t\twhile(c>='0'&&c<='9'){_=_*10+c-48;c=gc();}if(!f) _=-_;return *this;\n\t}\n\tchar buf[maxn];int p = 0;~IO(){fwrite(buf,1,p,stdout);}\n\tinline void pc(char c){\n\t\tbuf[p++] = c;\n\t\tif(p==maxn) fwrite(buf,1,maxn,stdout),p=0;\n\t}\n\ttemplate<typename T>\n\tinline IO&operator<<(T x){\n\t\tif(!x){pc(48);pc('\\n');return *this;}static int wt[40],len;len=0;if(x<0){pc('-');x=-x;}\n\t\tfor(;x;x/=10){wt[++len]=x%10;}\n\t\twhile(len){pc(wt[len--]+48);}pc('\\n');return *this;\n\t}\n}io;\n\nstd::vector<int> alpha;std::vector<int> beta;\nstd::vector<int> v;\n\nint n,m,a[maxn],b[maxn];\n\nint count(){\n\tv.clear();v.resize(beta.size());\n\tint answer = 0;\n\tfor(int j=0;j<(int)beta.size();j++){\n\t\tstd::vector<int>::iterator it = std::lower_bound(alpha.begin(),alpha.end(),beta[j]);\n\t\tif(j) v[j] = v[j-1];\n\t\tif(it != alpha.end() && *it == beta[j]) v[j] ++ ;\n\t}\n\tfor(int j=0;j<(int)beta.size();j++){\n\t\tint id = std::upper_bound(alpha.begin(),alpha.end(),beta[j]) - alpha.begin();\n\t\t// printf(\"id:%d\\n\",id);\n\t\tif(id == 0) continue ;id -- ;\n\t\tint num = id + 1;int st = beta[j] - num + 1;//\u8fd9\u6837\u53ef\u80fd\u770b\u8d77\u6765\u597d\u61c2\u4e00\u70b9\n\t\tint Id = std::lower_bound(beta.begin(),beta.end(),st) - beta.begin();\n\t\tId -- ;\n\t\tanswer = max(answer , j - Id + v.back()-v[j]);\n\t}\n\treturn answer ;\n}\n\nint main(){\n\tint cas;scanf(\"%d\",&cas);\n\twhile(cas--){\n\t\tio>>n>>m;\n\t\tfor(int i=1;i<=n;i++) io>>a[i];\n\t\tfor(int i=1;i<=m;i++) io>>b[i];\n\t\tint answer = 0;\n\t\talpha.clear(),beta.clear();\n\t\tfor(int i=1;i<=n;i++) if(a[i]<0) alpha.push_back(-a[i]);\n\t\tfor(int i=1;i<=m;i++) if(b[i]<0) beta.push_back(-b[i]);\n\t\tstd::reverse(alpha.begin(),alpha.end()),std::reverse(beta.begin(),beta.end());\n\t\tanswer += count();\n\t\talpha.clear(),beta.clear();\n\t\tfor(int i=1;i<=n;i++) if(a[i]>0) alpha.push_back(a[i]);\n\t\tfor(int i=1;i<=m;i++) if(b[i]>0) beta.push_back(b[i]);\n\t\tanswer += count();\n\t\tio << answer ;\n\t}\n\treturn 0 ;\n}\n\n\n```\n\n",
        "postTime": 1614997881,
        "uid": 101984,
        "name": "Rui_R",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1494C \u30101D Sokoban\u3011"
    }
]
[
    {
        "content": "# CF685D Kay and Eternity\n\n\u8003\u8651\u7528\u77e9\u5f62\u7684\u53f3\u4e0a\u89d2\u6765\u4ee3\u8868\u6bcf\u4e2a $k\\times k$ \u7684\u77e9\u5f62\u3002\n\n\u5bf9\u6bcf\u4e2a\u70b9 $(x,y)$\uff0c\u8003\u8651\u5b83\u80fd\u88ab\u54ea\u4e9b $k\\times k$ \u77e9\u5f62\u5305\u542b\u3002$k\\times k $ \u77e9\u5f62\u7684\u53f3\u4e0a\u89d2\uff0c\u5fc5\u987b\u4f4d\u4e8e\uff0c\u4ee5 $(x, y)$ \u4e3a\u5de6\u4e0b\u89d2\uff0c\u4ee5 $(x + k - 1, y + k - 1)$ \u4e3a\u53f3\u4e0a\u89d2\u7684\u77e9\u5f62\u533a\u57df\u5185\u3002\n\n\u4e8e\u662f\u6bcf\u4e2a\u70b9 $(x_i,y_i)$ \u90fd\u5bf9\u5e94\u8fd9\u6837\u4e00\u4e2a\u77e9\u5f62\u533a\u57df\u3002\n\n\u95ee\u9898\u8f6c\u5316\u4e3a\uff1a\u7ed9\u4f60 $n$ \u4e2a\u77e9\u5f62\u533a\u57df\uff0c\u6c42\u88ab\u8986\u76d6 $1,2,\\dots n$ \u6b21\u7684\u5750\u6807\u6570\u91cf\uff08\u6574\u6570\u5750\u6807\uff09\u3002\n\n\u8003\u8651**\u626b\u63cf\u7ebf**\u3002\n\n\u5bf9\u4e00\u4e2a\u77e9\u5f62\u533a\u57df\uff0c\u53d6\u51fa\u5176\u5de6\u53f3\u8fb9\u754c\uff0c\u5f97\u5230 $(x_l,y_l,y_r, 1)$\uff0c$(x_r + 1, y_l,y_r, -1)$\uff0c\u8fd9\u4e24\u4e2a\u56db\u5143\u7ec4\u3002\u6700\u540e\u7684 $1$ \u6216 $-1$\uff0c\u8868\u793a\u5bf9 $[y_l,y_r]$ \u8fd9\u6bb5\u533a\u57df\u7684\u8986\u76d6\u6b21\u6570\uff0c\u662f\u589e\u52a0\u4e86\u8fd8\u662f\u51cf\u5c11\u4e86\u3002\u628a\u8fd9 $2n$ \u4e2a\u56db\u5143\u7ec4\u6309\u6a2a\u5750\u6807\u6392\u5e8f\u3002\n\n\u8003\u8651\u5982\u4f55\u52a0\u5165\u4e00\u4e2a\u56db\u5143\u7ec4\u5e76\u66f4\u65b0\u7b54\u6848\u5462\uff1f\u6ce8\u610f\u5230 $k$ \u975e\u5e38\u5c0f\uff0c\u4e5f\u5c31\u662f $y_r - y_l + 1 = k\\leq 300$\u3002\u6240\u4ee5\u53ef\u4ee5\u66b4\u529b\u679a\u4e3e $[y_l, y_r]$ \u4e2d\u6bcf\u4e2a\u7eb5\u5750\u6807\uff0c\u66f4\u65b0\u5b83\u88ab\u8986\u76d6\u7684\u6b21\u6570\uff0c\u540c\u65f6\u66f4\u65b0\u7b54\u6848\u3002\n\n\u56e0\u4e3a $y$ \u503c\u5f88\u5927\uff0c\u9700\u8981\u5148\u79bb\u6563\u5316\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(nk)$\u3002\n\n\u53c2\u8003\u4ee3\u7801\uff1a\n\n```cpp\n// problem:\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define mk make_pair\n#define fi first\n#define se second\n#define SZ(x) ((int)(x).size())\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\n\ntemplate<typename T> inline void ckmax(T& x, T y) { x = (y > x ? y : x); }\ntemplate<typename T> inline void ckmin(T& x, T y) { x = (y < x ? y : x); }\n\n/* --------------- fast io --------------- */ // begin\nnamespace Fread {\nconst int SIZE = 1 << 21;\nchar buf[SIZE], *S, *T;\ninline char getchar() {\n\tif (S == T) {\n\t\tT = (S = buf) + fread(buf, 1, SIZE, stdin);\n\t\tif (S == T) return '\\n';\n\t}\n\treturn *S++;\n}\n} // namespace Fread\nnamespace Fwrite {\nconst int SIZE = 1 << 21;\nchar buf[SIZE], *S = buf, *T = buf + SIZE;\ninline void flush() {\n\tfwrite(buf, 1, S - buf, stdout);\n\tS = buf;\n}\ninline void putchar(char c) {\n\t*S++ = c;\n\tif (S == T) flush();\n}\nstruct NTR {\n\t~ NTR() { flush(); }\n} ztr;\n} // namespace Fwrite\n#ifdef ONLINE_JUDGE\n\t#define getchar Fread :: getchar\n\t#define putchar Fwrite :: putchar\n#endif\nnamespace Fastio {\nstruct Reader {\n\ttemplate<typename T>\n\tReader& operator >> (T& x) {\n\t\tchar c = getchar();\n\t\tT f = 1;\n\t\twhile (c < '0' || c > '9') {\n\t\t\tif (c == '-') f = -1;\n\t\t\tc = getchar();\n\t\t}\n\t\tx = 0;\n\t\twhile (c >= '0' && c <= '9') {\n\t\t\tx = x * 10 + (c - '0');\n\t\t\tc = getchar();\n\t\t}\n\t\tx *= f;\n\t\treturn *this;\n\t}\n\tReader& operator >> (char& c) {\n\t\tc = getchar();\n\t\twhile (c == '\\n' || c == ' ') c = getchar();\n\t\treturn *this;\n\t}\n\tReader& operator >> (char* str) {\n\t\tint len = 0;\n\t\tchar c = getchar();\n\t\twhile (c == '\\n' || c == ' ') c = getchar();\n\t\twhile (c != '\\n' && c != ' ') {\n\t\t\tstr[len++] = c;\n\t\t\tc = getchar();\n\t\t}\n\t\tstr[len] = '\\0';\n\t\treturn *this;\n\t}\n\tReader(){}\n} cin;\nconst char endl = '\\n';\nstruct Writer {\n\ttemplate<typename T>\n\tWriter& operator << (T x) {\n\t\tif (x == 0) { putchar('0'); return *this; }\n\t\tif (x < 0) { putchar('-'); x = -x; }\n\t\tstatic int sta[45];\n\t\tint top = 0;\n\t\twhile (x) { sta[++top] = x % 10; x /= 10; }\n\t\twhile (top) { putchar(sta[top] + '0'); --top; }\n\t\treturn *this;\n\t}\n\tWriter& operator << (char c) {\n\t\tputchar(c);\n\t\treturn *this;\n\t}\n\tWriter& operator << (char* str) {\n\t\tint cur = 0;\n\t\twhile (str[cur]) putchar(str[cur++]);\n\t\treturn *this;\n\t}\n\tWriter& operator << (const char* str) {\n\t\tint cur = 0;\n\t\twhile (str[cur]) putchar(str[cur++]);\n\t\treturn *this;\n\t}\n\tWriter(){}\n} cout;\n} // namespace Fastio\n#define cin Fastio :: cin\n#define cout Fastio :: cout\n#define endl Fastio :: endl\n/* --------------- fast io --------------- */ // end\n\nconst int MAXN = 1e5;\n\nint n, K, cnt, cnt_val;\nll vals[MAXN * 2 + 5];\n\nstruct Event {\n\tll x, l, r;\n\tint t;\n\tEvent() {}\n\tEvent(ll _x, ll _l, ll _r, int _t) {\n\t\tx = _x;\n\t\tl = _l;\n\t\tr = _r;\n\t\tt = _t;\n\t}\n} event[MAXN * 2 + 5];\n\nbool cmp(Event lhs, Event rhs) { return lhs.x < rhs.x; }\n\nint c[MAXN * 2 + 5];\nll ans[MAXN + 5];\n\n\nll lenx;\n\nvoid modify(int p, int v) {\n\tll len = vals[p + 1] - vals[p];\n\tans[c[p]] -= len * lenx;\n\tc[p] += v;\n\tassert(c[p] >= 0);\n\tassert(c[p] <= n);\n\tans[c[p]] += len * lenx;\n}\n\nint main() {\n\tcin >> n >> K;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tll x, y;\n\t\tcin >> x >> y;\n\t\tevent[++cnt] = Event(x, y, y + K - 1, 1);\n\t\tevent[++cnt] = Event(x + K, y, y + K - 1, -1);\n\t\t\n\t\tvals[++cnt_val] = y;\n\t\tvals[++cnt_val] = y + K;\n\t}\n\t\n\tsort(event + 1, event + cnt + 1, cmp);\n\t\n\tsort(vals + 1, vals + cnt_val + 1);\n\tcnt_val = unique(vals + 1, vals + cnt_val + 1) - (vals + 1);\n\t\n\tfor (int i = 1; i <= cnt; ++i) {\n\t\tint j = i;\n\t\twhile (j + 1 <= cnt && event[j + 1].x == event[i].x)\n\t\t\t++j;\n\t\tlenx = event[cnt].x - event[j].x;\n\t\tfor (int k = i; k <= j; ++k) {\n\t\t\tint l = lower_bound(vals + 1, vals + cnt_val + 1, event[k].l) - vals;\n\t\t\tint r = lower_bound(vals + 1, vals + cnt_val + 1, event[k].r + 1) - vals;\n\t\t\t\n\t\t\tassert(r - l <= K);\n\t\t\tfor (int p = l; p < r; ++p) {\n\t\t\t\tmodify(p, event[k].t);\n\t\t\t}\n\t\t}\n\t\ti = j;\n\t}\n\tfor (int i = 1; i <= n; ++i) {\n\t\tcout << ans[i] << \" \\n\"[i == n];\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1610263997,
        "uid": 100674,
        "name": "duyi",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF685D \u3010Kay and Eternity\u3011"
    }
]
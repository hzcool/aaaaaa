[
    {
        "content": "\u53d1\u73b0\u9898\u76ee\u5c31\u662f\u8981\u6c42 $a$ \u4e2d\u6709\u591a\u5c11\u4e2a\u957f\u5ea6\u4e3a $m$ \u7684\u5b50\u5e8f\u5217\u6ee1\u8db3\u8fd9\u4e2a\u5b50\u5e8f\u5217\u4e3a $[p_1+q,p_2+q,p_3+q,\\ldots,p_m+q]$\uff0c\u5176\u4e2d $p$ \u662f\u4e00\u4e2a\u6392\u5217\uff0c$q$ \u662f\u4e00\u4e2a\u975e\u8d1f\u6574\u6570\u3002\n\n\u6211\u4eec\u628a\u6bcf\u4e2a\u6570\uff08\u4ece\u5c0f\u5230\u5927\uff09\u51fa\u73b0\u7684\u6b21\u6570\u7edf\u8ba1\u8d77\u6765\uff08\u4ee3\u7801\u4e2d\u8bb0\u4e3a $\\operatorname{pi}$\uff09\uff0c\u5728 $\\operatorname{pi}$ \u4e2d\u627e\u5230\u6240\u6709\u957f\u4e3a $m$ \u7684\u8fde\u7eed\u7684\u4e00\u6bb5\uff0c\u5c06\u8fd9\u4e00\u6bb5\u6bcf\u4e2a\u6570\u7684\u51fa\u73b0\u6b21\u6570\u7d2f\u4e58\u8d77\u6765\uff0c\u5c06\u7ed3\u679c\u7d2f\u52a0\u5230\u7b54\u6848\u4e2d\u5373\u53ef\u3002\n\n\u5177\u4f53\u5b9e\u73b0\u4e2d\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u6240\u6709\u6570\u7684\u51fa\u73b0\u6b21\u6570\u7684\u9006\u5143\u6c42\u51fa\u6765\uff0c\u7136\u540e\u6c42\u51fa $\\operatorname{pi}$ \u4e2d\u6240\u6709\u957f\u4e3a $m$ \u7684\u6bcf\u4e00\u6bb5\u7684\u51fa\u73b0\u6b21\u6570\u4e58\u79ef\uff0c\u590d\u6742\u5ea6\u662f $\\mathcal{O}(n\\log p)$ \u7684\uff0c\u5176\u4e2d $p=10^9+7$\u3002\n```cpp\n#include<bits/stdc++.h>\n#define pb push_back\n#define mp make_pair\nusing namespace std;\ntypedef long long ll;\nconst int maxn=200005;\nconst ll p=1000000007;\n//const ll inf=1145141919810ll;\nll qpow(ll a,ll b){\n\tll res=1;\n\tfor(;b;b>>=1,a=a*a%p){if(b&1) res=res*a%p;}\n\treturn res;\n}\nll n,m,a[maxn],cnt,sum,ans;\nmap<ll,ll> buc;\npair<ll,pair<ll,ll> > pi[maxn];\nint main(void){\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\tll T=1;\n\tcin>>T;\n\tpi[0]=mp(-1,mp(1,1));\n\tfor(int tcs=1;tcs<=T;tcs++){\n\t\tcin>>n>>m;\n\t\tcnt=ans=0,sum=1,buc.clear();\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tcin>>a[i];\n\t\t\tbuc[a[i]]++;\n\t\t}\n\t\tfor(auto i:buc){\n\t\t\tcnt++,pi[cnt].first=i.first;\n\t\t\tpi[cnt].second=mp(i.second,qpow(i.second,p-2));\n\t\t}\n\t\tfor(int i=1;i<=cnt;i++){\n\t\t\tsum=sum*pi[i].second.first%p;\n\t\t\tif(i<m) continue;\n\t\t\tsum=sum*pi[i-m].second.second%p;\n\t\t\tif(pi[i-m+1].first+m-1==pi[i].first) ans=(ans+sum)%p; //\u662f\u5426\u8fde\u7eed\n\t\t}\n\t\tcout<<ans<<\"\\n\";\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1684637931,
        "uid": 475432,
        "name": "aeiouaoeiu",
        "ccfLevel": 5,
        "title": "[CF1833F] Ira and Flamenco \u9898\u89e3"
    },
    {
        "content": "### \u5206\u6790\n\n\u56e0\u4e3a\u9009\u51fa\u7684 $m$ \u4e2a\u6570\u9700\u8981\u6ee1\u8db3\u5bf9\u4e8e\u6240\u6709\u7684 $1 \\le i,j \\le m$ \u4e14 $i\\neq j$\uff0c\u90fd\u6709 $a_i \\neq a_j$ \u4e14 $|a_i-a_j|<m$\uff0c\u6240\u4ee5\u9009\u51fa\u7684 $m$ \u4e2a\u6570\u5bf9\u5e94\u7684 $a$ \u7684\u503c\u9700\u8981\u5f62\u6210\u4e00\u4e2a\u516c\u5dee\u4e3a $1$ \u7684\u7b49\u5dee\u6570\u5217\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5c06 $a$ \u6392\u5e8f\uff0c\u627e\u5230 $a$ \u4e2d\u53ef\u4ee5\u5f62\u6210\u516c\u5dee\u4e3a $1$ \u7684\u7b49\u5dee\u6570\u5217\u4e14\u957f\u5ea6\u6781\u5927\u7684\u90e8\u5206\uff0c\u5206\u90e8\u5206\u6c42\u89e3\u7b54\u6848\u3002\n\n\u6211\u4eec\u8bbe\u8fd9\u90e8\u5206\u662f\u7531 $a_l\\sim a_r$ \u7ec4\u6210\u7684\uff0c\u82e5 $a_r-a_l<m-1$\uff0c\u90a3\u4e48\u663e\u7136\u8fd9\u90e8\u5206\u65e0\u6cd5\u7ec4\u6210\u7b49\u5dee\u6570\u5217\uff0c\u76f4\u63a5\u8df3\u51fa\u3002\n\n\u53cd\u4e4b\uff0c\u6211\u4eec\u5f00\u4e2a\u6876 $ma$\uff0c\u5b58\u6bcf\u4e2a\u6570\u51fa\u73b0\u7684\u6b21\u6570\u3002\n\n\u82e5\u6211\u4eec\u73b0\u5728\u9700\u8981\u6c42 $k\\sim k+m-1$ \u80fd\u591f\u7ec4\u6210\u7684\u516c\u5dee\u4e3a $1$ \u4e14\u957f\u5ea6\u4e3a $m$ \u7684\u7b49\u5dee\u6570\u5217\u7684\u4e2a\u6570\uff0c\u6839\u636e\u4e58\u6cd5\u539f\u7406\uff0c\u7b54\u6848\u7b49\u4e8e $ma_k \\times ma_{k+1} \\times ma_{k+2} \\times \\cdots ma_{k+m-1}$\u3002\n\n\u90a3\u6211\u4eec\u518d\u5f00\u4e2a\u6876 $tim$\uff0c\u5b58\u8fd9\u4e9b\u6570\u7684\u524d\u7f00\u79ef\uff0c\u5229\u7528\u9006\u5143\u8ba1\u7b97\u6bcf\u4e2a\u90e8\u5206\u7684\u7b54\u6848\uff0c\u6700\u540e\u5c06\u6bcf\u90e8\u5206\u7684\u7b54\u6848\u76f8\u52a0\u5373\u53ef\u3002\n\n\u6700\u540e\u6ce8\u610f\u503c\u57df\u8f83\u5927\uff0c\u53ef\u4ee5\u4f7f\u7528 `map` \u66ff\u6362\u6876\u3002\n\n### \u4ee3\u7801\n\n```c++\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nnamespace IO{\n\tchar ibuf[(1<<20)+1],*iS,*iT;\n\t#if ONLINE_JUDGE\n\t#define gh() (iS==iT?iT=(iS=ibuf)+fread(ibuf,1,(1<<20)+1,stdin),(iS==iT?EOF:*iS++):*iS++)\n\t#else\n\t#define gh() getchar()\n\t#endif\n\t#define reg register\n\tinline long long read(){\n\t\treg char ch=gh();\n\t\treg long long x=0;\n\t\treg char t=0;\n\t\twhile(ch<'0'||ch>'9')   t|=ch=='-',ch=gh();\n\t\twhile(ch>='0'&&ch<='9') x=x*10+(ch^48),ch=gh();\n\t\treturn t?-x:x;\n\t}\n}\nusing IO::read;\nconst int mod=1e9+7,N=4e5+5;\nint n,m,a[N],cnt;\nint ksm(int a,int b){\n\tint res=1;\n\twhile(b){\n\t\tif(b&1) res=res*a%mod;\n\t\ta=a*a%mod;\n\t\tb>>=1;\n\t}\n\treturn res;\n}\nvoid solve(){\n\tmap <int,int> ma;\n\tmap <int,int> tim;\n\tn=read(),m=read();\n\tint p=1,ans=0;\n\tfor(int i=1;i<=n;i++) a[i]=read();\n\tsort(a+1,a+1+n);\n\tfor(int i=1;i<=n;i++){\n\t\tif(a[i+1]-a[i]>1||i==n){\n\t\t\tif(a[i]-a[p]>=m-1){\n\t\t\t\tcnt=0;\n\t\t\t\tfor(int j=p;j<=i;j++){\n\t\t\t\t\tma[a[j]]++;\n\t\t\t\t}\n\t\t\t\ttim[a[p]-1]=1;\n\t\t\t\tfor(int j=a[p];j<=a[i];j++){\n\t\t\t\t\ttim[j]=ma[j]*tim[j-1]%mod;\n\t\t\t\t}\n\t\t\t\tfor(int j=a[p],k=a[p]+m-1;k<=a[i];j++,k++){\n\t\t\t\t\tans=ans+(tim[k]*ksm(tim[j-1],mod-2)%mod);\n\t\t\t\t\tans=ans%mod;\n\t\t\t\t}\n\t\t\t}\n\t\t\tp=i+1;\n\t\t}\n\t}\n\tcout<<ans<<endl;\n}\nsigned main(){\n\tint T=read();\n\twhile(T--) solve();\n\treturn 0;\n}\n```",
        "postTime": 1684631414,
        "uid": 744687,
        "name": "Coffee_zzz",
        "ccfLevel": 0,
        "title": "CF1833F Ira and Flamenco \u9898\u89e3"
    }
]
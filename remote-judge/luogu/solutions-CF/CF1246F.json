[
    {
        "content": "\n\u8003\u8651\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$i$\uff0c\u6c42\u51fa\u81f3\u591a\u8d70$k$\u6b65\u5c31\u80fd\u591f\u5230\u8fbe\u5b83\u7684\u4f4d\u7f6e\u6240\u6784\u6210\u7684\u533a\u95f4$[L_{i,k},R_{i,k}]$\u3002\u6211\u4eec\u53ea\u8981\u5bf9\u6bcf\u4e2a$i$\u5206\u522b\u6c42\u51fa$\\sum_k L_{i,k},\\sum_k R_{i,k}$\u5c31\u80fd\u5f97\u5230\u7b54\u6848\u3002\n\n\u6700\u77ed\u8def\u4e0d\u4e00\u5b9a\u662f\u5355\u5411\u7684\uff08\u6bd4\u5982\u5bf9\u4e8ebaaaaac\uff0c\u4eceb\u8d70\u5230\u6700\u540e\u4e00\u4e2aa\uff09\uff0c\u6240\u4ee5$L,R$\u53ef\u80fd\u4e0d\u72ec\u7acb\uff0c\u4e0d\u80fd\u76f4\u63a5\u500d\u589e\u8ba1\u7b97$L,R$\u7684\u548c\u3002\n\n\u8fdb\u4e00\u6b65\u89c2\u5bdf\uff0c$R_{i,k+2}$\u7684\u53d6\u503c\u4e0e$[L_{i,k+1},L_{i,k})$\u4e2d\u7684\u4f4d\u7f6e\u6709\u5173\u7684\u5fc5\u8981\u6761\u4ef6\u662f$[L_{i,k+1},R_{i,k+1}]$\u7684\u5b57\u7b26\u96c6\u5927\u4e8e$[L_{i,k},R_{i,k}]$\u7684\u5b57\u7b26\u96c6\uff1b\u5982\u679c$[L_{i,k+1},R_{i,k+1}],[L_{i,k},R_{i,k}]$\u5b57\u7b26\u96c6\u76f8\u540c\uff0c\u5219$R_{i,k+2}$\u5c31\u53ea\u4e0e$R_{i,k+1}$\u548c$[L_{i,k},R_{i,k}]$\u7684\u5b57\u7b26\u96c6\u5927\u5c0f\u6709\u5173\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a$i$\uff0c\u5f53$k$\u4ece$0$\u53d6\u5230$+\\infty$\u7684\u65f6\u5019\uff0c$[L_{i,k},R_{i,k}]$\u7684\u5b57\u7b26\u96c6\u5927\u5c0f\u53ea\u4f1a\u53d8\u5316$|\\Sigma|$\u6b21\uff08$|\\Sigma|$\u8868\u793a\u5b57\u7b26\u96c6\u5927\u5c0f\uff09\u3002\u6545\u800c\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u5f53\u524d\u8fd9\u4e9b\u533a\u95f4\u7684\u5b57\u7b26\u96c6\u5927\u5c0f\uff0c\u8fd9\u65f6\u5019$L,R$\u662f\u72ec\u7acb\u7684\uff0c\u53ef\u4ee5\u76f4\u63a5\u500d\u589e\u6c42\u51fa\u5b83\u4eec\u7684\u548c\u3002\n\n\u5b9e\u73b0\u7ec6\u8282\u4e0a\uff0c\u5728\u6700\u5916\u5c42\u679a\u4e3e\u533a\u95f4\u7684\u5b57\u7b26\u96c6\u5927\u5c0f$t$\uff0c\u7136\u540e\u5bf9\u6bcf\u4e2a\u4f4d\u7f6e$i$\u5904\u7406\u51fa$fl_i$\u2014\u2014\u8868\u793a\u5f53$L$\u4e3a\u67d0\u4e2a\u6ee1\u8db3$[L,i]$\u5b57\u7b26\u96c6\u5927\u5c0f\u4e3a$t$\u7684\u4f4d\u7f6e\uff0c$R=i$\u7684\u65f6\u5019\uff0c\u8df3\u4e00\u6b65\u80fd\u591f\u628a$R$\u6269\u5c55\u5230\u54ea\u91cc\uff1b\u4ee5\u53ca\u7c7b\u4f3c\u5b9a\u4e49\u7684$fr_i$\u3002\u9884\u5904\u7406\u51fa$fl_i,fr_i$\u500d\u589e\u7684\u7ed3\u679c\u3002\u7136\u540e\u5bf9\u6bcf\u4e2a$i$\u4ece\u5927\u5230\u5c0f\u679a\u4e3e$j$\uff0c\u7136\u540e\u770b\u5b83\u73b0\u5728\u7684\u533a\u95f4\u7aef\u70b9\u6269\u5c55$2^j$\u6b21\u4ee5\u540e\uff0c\u533a\u95f4\u5185\u662f\u5426\u4ecd\u7136\u53ea\u6709$t$\u79cd\u5b57\u7b26\u3002\n\n[\u53c2\u8003\u4ee3\u7801](https://codeforces.com/contest/1246/submission/69554739)",
        "postTime": 1580028610,
        "uid": 40534,
        "name": "zhongyuwei",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1246F \u3010Cursor Distance\u3011"
    },
    {
        "content": "\u9996\u5148\u6709\u4e00\u4e2a key observation\uff0c\u5bf9\u4e8e\u6240\u6709 $i$\uff0c\u7528\u4e0d\u8d85\u8fc7 $j$ \u6b65\u80fd\u8d70\u5230 $i$ \u7684\u70b9\u662f\u4e00\u6bb5\u533a\u95f4\u3002\n\n\u6b64\u65f6\u6211\u4eec\u5176\u5b9e\u5df2\u7ecf\u53ef\u4ee5\u5feb\u901f\u6c42\u51fa\u4efb\u610f\u4e00\u4e2a $dis(i,j)$ \u4e86\u3002\n\n\u4f46\u8fd9\u8fd8\u4e0d\u591f\uff0c\u6211\u4eec\u9700\u8981\u6c42\u51fa\u6240\u6709 $dis(i,j)$ \u4e4b\u548c\u3002\n\n\u4ee4\u4ece $i$ \u5f00\u59cb\uff0c$j$ \u6b65\u80fd\u8d70\u5230 $i$ \u7684\u533a\u95f4\u662f $[L_{i,j},R_{i,j}]$\u3002\n\n\u53ef\u4ee5\u53d1\u73b0 $L_{i,j+1}$ \u53ea\u4e0e $L_{i,j}$ \u4ee5\u53ca $[L_{i,j},R_{i,j}]$ \u7684\u5b57\u7b26\u96c6\u6709\u5173\uff0c$R_{i,j+1}$ \u540c\u7406\u3002\n\n\u5982\u679c\u5728\u4e00\u6bb5\u8fde\u7eed\u7684 $j$ \u4e2d $[L_{i,j},R_{i,j}]$ \u7684\u5b57\u7b26\u96c6\u6ca1\u6709\u53d8\u5316\u8fc7\uff0c\u90a3\u4e48\u5728\u8fd9\u4e00\u6bb5\u4e2d $L_{i,j}$ \u4ee5\u53ca $R_{i,j}$ \u7684\u79fb\u52a8\u4ee5\u53ca\u6240\u4ea7\u751f\u7684\u8d21\u732e\u53ef\u4ee5\u770b\u4f5c\u662f\u72ec\u7acb\u7684\u3002\n\n\u56e0\u4e3a $[L_{i,j},R_{i,j}]\\subseteq [L_{i,j+1},R_{i,j+1}]$\uff0c\u6240\u4ee5\u5b57\u7b26\u96c6\u53ea\u4f1a\u53d8\u5927\u3002\u800c\u6574\u4e2a\u4e32\u7684\u5b57\u7b26\u96c6\u5927\u5c0f\u4e0d\u8d85\u8fc7 $|\\Sigma|=26$\u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $i$ \u500d\u589e\u5730\u627e\u51fa\u6bcf\u4e00\u6bb5 $j$\uff0c\u5728\u500d\u589e\u7684\u540c\u65f6\u8ba1\u7b97\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u3002\n\n\u5177\u4f53\u5730\uff0c\u6211\u4eec\u7ef4\u62a4\u51e0\u4e2a\u500d\u589e\u6570\u7ec4\uff1a\n\n$zL_{i,j,k}$\uff1a\u4ee5 $k$ \u4e3a\u5de6\u7aef\u70b9\u7684\u533a\u95f4\uff0c\u94a6\u5b9a\u5b57\u7b26\u96c6\u5927\u5c0f\u59cb\u7ec8\u4e3a $i$\uff0c\u8d70\u4e86 $2^j$ \u6b65\u6240\u5230\u7684\u5de6\u7aef\u70b9\u3002\n\n$wL_{i,j,k}$\uff1a\u4ee5 $k$ \u4e3a\u5de6\u7aef\u70b9\u7684\u533a\u95f4\uff0c\u94a6\u5b9a\u5b57\u7b26\u96c6\u5927\u5c0f\u59cb\u7ec8\u4e3a $i$\uff0c\u8d70\u4e86 $2^j$ \u6b65\u6240\u4ea7\u751f\u7684\u8d21\u732e\u3002\n\n$zR_{i,j,k}$ \u548c $wR_{i,j,k}$\u3002\n\n\u5177\u4f53\u7684\u8f6c\u79fb\u6bd4\u8f83\u5bb9\u6613\uff0c\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n|\\Sigma|\\log n)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define N 100005\n#define ll long long\nint n,L[N],R[N],zL[17][N],zR[17][N];ll ans,wL[17][N],wR[17][N];\nint bL[N][26],bR[N][26],psL[N][26],psR[N][26];char a[N];\nint main()\n{\n\tscanf(\"%s\",a+1);n=strlen(a+1);\n\tfor(int i=0;i<26;++i) psL[0][i]=1,psR[n+1][i]=n;\n\tfor(int i=1;i<=n;++i)\n\t{\n\t\tfor(int j=0;j<26;++j) psL[i][j]=psL[i-1][j];psL[i][a[i]-'a']=i;\n\t\tfor(int j=0;j<26;++j) bL[i][j]=psL[i][j];sort(bL[i],bL[i]+26);\n\t\treverse(bL[i],bL[i]+26);\n\t}\n\tfor(int i=n;i;--i)\n\t{\n\t\tfor(int j=0;j<26;++j) psR[i][j]=psR[i+1][j];psR[i][a[i]-'a']=i;\n\t\tfor(int j=0;j<26;++j) bR[i][j]=psR[i][j];sort(bR[i],bR[i]+26);\n\t}for(int i=1;i<=n;++i) L[i]=R[i]=i,zL[0][i]=n+1;\n\tfor(int i=0,tL,tR;i<26;++i)\n\t{\n\t\tfor(int j=1;j<=n;++j)\n\t\t{\n\t\t\tzL[0][j]=min(zL[0][j],psL[j-1][a[bR[j][i]]-'a']);\n\t\t\tzR[0][j]=max(zR[0][j],psR[j+1][a[bL[j][i]]-'a']);\n\t\t\twL[0][j]=j-1;wR[0][j]=n-j;\n\t\t}\n\t\tfor(int j=1;j<=16;++j) for(int k=1;k<=n;++k)\n\t\t{\n\t\t\tzL[j][k]=zL[j-1][zL[j-1][k]];zR[j][k]=zR[j-1][zR[j-1][k]];\n\t\t\twL[j][k]=wL[j-1][k]+wL[j-1][zL[j-1][k]];\n\t\t\twR[j][k]=wR[j-1][k]+wR[j-1][zR[j-1][k]];\n\t\t}\n\t\tfor(int j=1;j<=n;++j)\n\t\t{\n\t\t\tfor(int k=16;k>=0;--k)\n\t\t\t{\n\t\t\t\ttL=zL[k][L[j]];tR=zR[k][R[j]];\n\t\t\t\tif(i==25 || (tL>1 && tR<n && bL[tR][i+1]<tL))\n\t\t\t\t\tans+=wL[k][L[j]]+wR[k][R[j]],L[j]=tL,R[j]=tR;\n\t\t\t}tL=zL[0][L[j]];tR=zR[0][R[j]];\n\t\t\tif(L[j]>1 && R[j]<n && bL[R[j]][i+1]<L[j])\n\t\t\t\tans+=wL[0][L[j]]+wR[0][R[j]],L[j]=tL,R[j]=tR;\n\t\t}\n\t}printf(\"%lld\\n\",ans);return 0;\n}\n```",
        "postTime": 1649849225,
        "uid": 119621,
        "name": "Kubic",
        "ccfLevel": 10,
        "title": "CF1246F Cursor Distance"
    }
]
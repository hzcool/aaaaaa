[
    {
        "content": "[\u83b7\u5f97\u66f4\u4e0d\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\uff0c\u4f60\u53ef\u4ee5\u524d\u5f80\u6211\u7684\u535a\u5ba2](http://zhylj.cc/index.php/archives/59/)\u3002\n\n\u89c2\u5bdf\u6837\u4f8b\u53ef\u4ee5\u53d1\u73b0\uff0c\u6700\u5f00\u59cb\u7684 $4\\times 4$ \u7684\u6bcf\u4e00\u884c / \u6bcf\u4e00\u5217\u90fd\u5305\u542b\u4e86 $1,2,3,4$ \u56db\u4e2a\u5143\u7d20\u3002\u518d\u6ce8\u610f\u5230\u8868\u683c\u6709\u4e00\u90e8\u5206\u662f\u91cd\u590d\u7684\uff0c\u4e8e\u662f\u731c\u60f3\uff1a\n\n**\u5f15\u7406 1**\uff1a\u5bf9\u4e8e\u5de6\u4e0a\u89d2 $2^{n}\\times 2^n$ \u5927\u5c0f\u7684\u77e9\u5f62\uff0c\u6bcf\u4e00\u884c\u6bcf\u4e00\u5217\u90fd\u5305\u542b $1,2,\\cdots,2^n$ \u7684\u6570\u3002\n\n**\u8bc1\u660e**\uff1a\u8003\u8651\u5bf9 $n$ \u65bd\u5f52\u7eb3\u6cd5\uff0c\u5f53 $n = 1$ \u65f6\u663e\u7136\u6210\u7acb\u3002\n\n\u5426\u5219\u5f53 $n > 1$ \u65f6\u7531\u5f52\u7eb3\u5047\u8bbe\u5de6\u4e0a\u89d2\u7684 $2^{n-1}\\times 2^{n-1}$ \u77e9\u5f62\u7684\u6bcf\u884c\u6bcf\u5217\u90fd\u5305\u542b\u4e86 $1,\\cdots,2^{n-1}$\uff0c\u6545\u5de6\u4e0b\u89d2\u548c\u53f3\u4e0a\u89d2\u7684 $2^{n-1}\\times 2^{n-1}$ \u77e9\u5f62\u4e0d\u53ef\u80fd\u5305\u542b\u5728 $1,\\cdots,2^{n-1}$ \u4e4b\u4e2d\u7684\u6570\uff0c\u8fd9\u76f8\u5f53\u4e8e\u628a $\\operatorname {mex}$ \u7684\u300c\u6700\u5c0f\u6b63\u6574\u6570\u300d\u7684\u9650\u5236\uff0c\u53d8\u4e3a\u300c$>2^{n-1}$ \u7684\u6700\u5c0f\u6574\u6570\u300d\u7684\u9650\u5236\u3002\u6545\u628a\u5de6\u4e0a\u89d2\u7684\u6570\u52a0\u4e0a $2^{n-1}$ \u653e\u5728\u5de6\u4e0b\u89d2\u548c\u53f3\u4e0a\u89d2\u5373\u662f\u65b0\u7684\u65b9\u6848\u3002\u800c\u5bf9\u4e8e\u53f3\u4e0b\u89d2\u7684\u6570\uff0c\u53ea\u53d7\u5185\u90e8\u548c\u53f3\u4e0a\u89d2\u3001\u5de6\u4e0b\u89d2\u7684\u5f71\u54cd\uff0c\u4f46\u5de6\u4e0a\u89d2\u3001\u53f3\u4e0b\u89d2\u53c8\u5168\u90e8\u8d85\u8fc7\u4e86 $2^{n-1}$\uff0c\u6240\u4ee5\u5b9e\u9645\u4e0a\u4e0d\u53ef\u80fd\u5f71\u54cd\u5230\u5b83\uff0c\u6545\u8fd9\u90e8\u5206\u7684\u6570\u4e5f\u5c31\u548c\u5de6\u4e0a\u89d2\u5b8c\u5168\u76f8\u540c\u4e86\u3002\n\n\u5bb9\u6613\u9a8c\u8bc1\u65b0\u7684\u77e9\u9635\u4ecd\u7136\u6ee1\u8db3\u6761\u4ef6\u3002\n\n**\u5f15\u7406 2**\uff1a$a_{i,j}=(i-1)\\oplus (j-1) + 1$\uff0c\u5176\u4e2d $\\oplus$ \u4e3a\u6309\u4f4d\u5f02\u6216\u3002\n\n**\u8bc1\u660e**\uff1a\u8003\u8651\u5148\u524d\u7684\u6784\u9020\u65b9\u6cd5\uff0c\u5047\u5982\u6211\u4eec\u628a\u6574\u4e2a\u77e9\u9635\u6240\u6709\u6570\u51cf\u4e00\uff0c\u5e76\u4e14\u884c\u5217\u7684\u7f16\u53f7\u4e5f\u5168\u90e8\u51cf\u4e00\uff0c\u90a3\u4e48\u6211\u4eec\u9012\u5f52\u7684\u8fc7\u7a0b\u5b9e\u9645\u4e0a\u662f\u5728\u4f9d\u6b21\u8003\u5bdf $i,j$ \u7684\u6700\u9ad8\u4f4d\uff1a\u82e5 $i,j$ \u7684\u6700\u9ad8\u4f4d\u4e0d\u540c\uff08\u4f4d\u4e8e\u5de6\u4e0b\u89d2\u6216\u53f3\u4e0a\u89d2\uff09\uff0c\u5219\u52a0\u4e0a $2^{n-1}$\uff0c\u7136\u540e\u53bb\u6389\u6700\u9ad8\u4f4d\uff08\u8fdb\u5165\u5de6\u4e0a\u89d2\uff09\u3002\u53ef\u4ee5\u53d1\u73b0\u8fd9\u5c31\u662f\u5f02\u6216\u7684\u8fc7\u7a0b\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651\u76f4\u63a5\u628a\u6574\u4e2a\u77e9\u9635\u6240\u6709\u6570\u51cf\u4e00\uff0c\u5e76\u4e14\u884c\u5217\u7684\u7f16\u53f7\u4e5f\u5168\u90e8\u51cf\u4e00\u540e\u7684\u7b54\u6848\u3002\n\n\u8003\u8651\u6570\u4f4d dp\uff0c\u9996\u5148\u77e9\u9635\u53ef\u4ee5\u62c6\u6210\u56db\u4e2a\u524d\u7f00\uff0c\u7136\u540e\u8bb0 $f_{0/1,0/1,0/1,n}$ \u8868\u793a\u8003\u8651\u4e86\u6700\u9ad8 $n$ \u4f4d\uff0c$i$ \u662f\u5426\u9876\u5230\u4e86\u4e0a\u754c\uff0c$j$ \u662f\u5426\u9876\u5230\u4e86\u4e0a\u754c\uff0c$i\\oplus j$ \u662f\u5426\u9876\u5230\u4e86\u4e0a\u754c\u7684\u65b9\u6848\u6570\u3002\u8f6c\u79fb\u8003\u8651\u76f4\u63a5\u679a\u4e3e $i,j$ \u5728\u8fd9\u4e00\u4f4d\u5206\u522b\u662f\u4ec0\u4e48\uff0c\u5224\u65ad\u4e00\u4e0b\u662f\u5426\u5408\u6cd5\u4ee5\u53ca\u662f\u5426\u7ee7\u7eed\u9876\u7740\u4e0a\u754c\u5373\u53ef\u3002\n\n[\u4ee3\u7801\u94fe\u63a5](https://codeforces.ml/contest/809/submission/129928248)\u3002",
        "postTime": 1632664068,
        "uid": 34238,
        "name": "zhylj",
        "ccfLevel": 9,
        "title": "\u300cCodeforces 809C\u300dFind a car"
    },
    {
        "content": "[\u6765\u849f\u84bb\u7684\u535a\u5ba2\u56ed\u91cc\u6765\u770b /kel](https://www.cnblogs.com/zkyJuruo/p/14356706.html)\n\n\u9898\u89e3\u533a\u91cc\u9762\u5199\u7684\u90fd\u662f\u6570\u4f4d $dp$\uff0c\u849f\u84bb\u6765\u4e00\u4e2a\u5947\u602a\u7684\u505a\u6cd5\u3002\n\n\u901a\u8fc7\u6253\u8868\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u5206\u5f62\uff0c\u7136\u540e\u53ef\u4ee5\u53d1\u73b0 $a_{i, j} = (i - 1) \\oplus (j - 1) + 1$ \uff08\u849f\u84bb\u4e5f\u4e0d\u77e5\u9053\u600e\u4e48\u8bc1\u660e\uff09\n\n\u8003\u8651\u628a\u8fd9\u4e2a\u77e9\u9635\u8f6c\u5316\u4e3a\u524d\u7f00\u548c\u3002\u73b0\u5728\u6211\u4eec\u8981\u6c42\u7684\u662f $f(x, y) = \\sum\\limits_{i = 0}^{x-1} \\sum\\limits_{j = 0}^{y-1} [i \\oplus j + 1 \\le t] i \\oplus j + 1$\n\n\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u7528\u7c7b\u4f3c\u4e8e\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\u7684\u4e1c\u897f\u6765\u641e\u3002\u628a\u8fd9\u4e2a\u524d\u7f00\u548c\u5206\u6210\u5f88\u591a\u4e2a\u77e9\u9635\uff0c\u6bcf\u4e2a\u77e9\u9635\u90fd\u662f $(x - lowbit(x), x), (y - lowbit(y), y)$ \u7684\u5f62\u5f0f\u3002\n\n\u6211\u4eec\u8ba9 $lowbit(x) \\ge lowbit(y)$ \n\n\u53d1\u73b0\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u533a\u95f4\u5185\u7684 $y$ \u5750\u6807\uff0c\u90a3\u4e48\u4ed6\u4eec\u5f02\u6216\u4e0a $x$ \u5750\u6807\u533a\u95f4\u540e\u7684\u503c\u7684\u96c6\u5408\u662f\u56fa\u5b9a\u7684\uff01\u8ba9 $t = (x - lowbit(x) ) \\oplus (y - lowbit(y))$\uff0c\u90a3\u4e48 $y$ \u5750\u6807\u5f02\u6216\u4e0a $x$ \u5750\u6807\u533a\u95f4\u540e\u7684\u503c\u662f\u4e00\u6bb5\u533a\u95f4\uff0c\u533a\u95f4\u90fd\u662f $[t, t + lowbit(x))$ (\u6ce8\u610f\u4e4b\u540e\u8fd8\u8981 $+1$)\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(T \\log r_1 \\log r_2)$\n\n\u4ee3\u7801\u5f88\u597d\u5199\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define L(i, j, k) for(int i = j, i##E = k; i <= i##E; i++)\n#define R(i, j, k) for(int i = j, i##E = k; i >= i##E; i--)\n#define ll long long\n#define ull unsigned long long\n#define db double\n#define pii pair<int, int>\n#define mkp make_pair\nusing namespace std;\nconst int N = 1e3 + 7;\nconst int mod = 1e9 + 7;\ninline int read() {\n\tint x = 0, f = 1; char ch = getchar();\n\twhile(ch < '0' || ch > '9') { if(ch == '-') f = -1; ch = getchar(); }\n\twhile('0' <= ch && ch <= '9') x = x * 10 + (ch ^ '0'), ch = getchar();\n\treturn x * f;\n}\nint n, m, T;\nint Sum(int l, int r) {\n\treturn (ll) (r - l + 1) * (l + r) / 2 % mod;\n}\nint Get(int l1, int r1, int l2, int r2, int k) {\n\tif(r1 - l1 < r2 - l2) swap(l1, l2), swap(r1, r2);\n\tint mn = (l1 ^ l2), len = r1 - l1;\n\tmn ^= (mn & (len - 1));\n\tif(k <= mn) return 0;\n\treturn (ll) (r2 - l2) * Sum(mn + 1, min(k, mn + len)) % mod;\n}\nint work(int x, int y, int k) {\n\tint res = 0;\n\tfor(int i = x; i; i -= (i & -i)) for(int j = y; j; j -= (j & -j)) (res += Get(i - (i & -i), i, j - (j & -j), j, k)) %= mod;\n\treturn res;\n}\nvoid Main() {\n\tint l1 = read(), l2 = read(), r1 = read(), r2 = read(), k = read();\n\tprintf(\"%d\\n\", ((work(r1, r2, k) - work(l1 - 1, r2, k) - work(r1, l2 - 1, k)\n\t + work(l1 - 1, l2 - 1, k)) % mod + mod) % mod);\n}\nint main() {\n\tT = read();\n\twhile(T--) Main();\n\treturn 0;\n}\n```",
        "postTime": 1612163146,
        "uid": 173660,
        "name": "zhoukangyang",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF809C \u3010Find a car\u3011"
    },
    {
        "content": "[Codeforces \u9898\u76ee\u4f20\u9001\u95e8](https://codeforces.com/contest/809/problem/C) & [\u6d1b\u8c37\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF809C)\n\n\u9996\u5148\u62ff\u5230\u8fd9\u7c7b\u9898\u7b2c\u4e00\u6b65\u80af\u5b9a\u8981\u5206\u6790\u9898\u76ee\u7ed9\u51fa\u7684\u77e9\u9635\u6709\u4ec0\u4e48\u6027\u8d28\u3002\u7a0d\u5fae\u6253\u4e2a\u8868\u5373\u53ef\u53d1\u73b0\u9898\u76ee\u8981\u6c42\u7684\u77e9\u5f62\u662f\u4e00\u4e2a**\u5206\u5f62**\u3002\u5f62\u5f0f\u5316\u5730\u8bf4\uff0c\u8be5\u77e9\u5f62\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u751f\u6210\uff1a$A_n$ \u4e3a\u4e00\u4e2a $2^n\\times 2^n$ \u7684\u77e9\u9635\uff0c$A_0=[1]$\uff0c$A_i=\\begin{bmatrix}A_{i-1}&A'_{i-1}\\\\A'_{i-1}&A_{i-1}\\end{bmatrix}$\uff0c\u5176\u4e2d $A'_{i}$ \u4e5f\u662f\u4e00\u4e2a $2^i\\times 2^i$ \u7684\u77e9\u9635\uff0c\u5176\u7b2c $x$ \u884c $y$ \u5217\u7684\u5143\u7d20\u4e3a $A_i$ \u7b2c $x$ \u884c $y$ \u5217\u7684\u5143\u7d20\u52a0\u4e0a $2^i$\u3002\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u6211\u60f3\u4e0d\u5230\u7684\u5730\u65b9\u4e86\uff0c\u78b0\u5230\u8fd9\u7c7b\u751f\u6210\u65b9\u5f0f\u4e0e\u4e8c\u8fdb\u5236\u8054\u7cfb\u5f02\u5e38\u7d27\u5bc6\u7684\u77e9\u9635\uff0c\u6211\u4eec\u8981\u5c1d\u8bd5\u5c06\u5176\u4e0e\u4f4d\u8fd0\u7b97\u5efa\u7acb\u8054\u7cfb\u3002\u8fd9\u91cc\u5c31\u6709\u4e00\u4e2a\u6027\u8d28\uff0c\u90a3\u5c31\u662f\u8be5\u77e9\u9635\u7b2c $x$ \u884c\u7b2c $y$ \u5217\u7684\u6570\u4e3a $(x-1)\\oplus(y-1)+1$\uff0c\u8bc1\u660e\u53ef\u4ee5\u5927\u529b\u5f52\u7eb3\uff0c\u5e94\u8be5\u4e0d\u96be\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u8d58\u8ff0\u4e86\u3002~~\u8981\u8bf4\u600e\u4e48\u53d1\u73b0\u7684\u6211\u4e5f\u4e0d\u77e5\u9053\uff0c\u53cd\u6b63\u5bf9\u4e8e\u6211\u8fd9\u7c7b\u6ca1\u8111\u5b50\u9009\u624b\u80af\u5b9a\u662f\u60f3\u4e0d\u5230\u7684\u54af\u3002~~\n\n\u4e8e\u662f\u6b64\u9898\u53ef\u4ee5\u8f6c\u5316\u4e3a\u6c42 $\\sum\\limits_{i=l_1}^{r_1}\\sum\\limits_{j=l_2}^{r_2}(i-1)\\oplus(j-1)+1[(i-1)\\oplus(j-1)+1\\le k]$\u3002\u770b\u5230\u8fd9\u7c7b\u77e9\u5f62\u6c42\u548c\u7684\u95ee\u9898\u9996\u5148\u5c06\u5176\u5dee\u5206\u62c6\u6210\u56db\u4e2a\u5f62\u5982 $\\sum\\limits_{i=0}^{x-1}\\sum\\limits_{j=0}^{y-1}i\\oplus j+1[i\\oplus j+1\\le k]$ \u7684\u90e8\u5206\u3002\u4e8e\u662f\u73b0\u5728\u95ee\u9898\u8f6c\u5316\u4e3a\u600e\u4e48\u6c42\u5de6\u8fb9\u8fd9\u5768\u4e1c\u897f\u3002\u8fd9\u91cc\u53c8\u6709\u4e00\u4e2a\u6211\u60f3\u4e0d\u5230\u7684\u5957\u8def\uff0c\u53d1\u73b0\u8fd9\u4e1c\u897f\u957f\u5f97\u633a\u50cf\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u77e9\u9635\u62c6\u6210 $\\log^2n$ \u4e2a\u5f62\u5982 $[x-\\text{lowbit}(x),x),[y-\\text{lowbit}(y),y)$ \u7684\u5b50\u77e9\u9635\uff0c\u4e0d\u59a8\u5047\u8bbe $\\text{lowbit}(x)\\ge \\text{lowbit}(y)$\uff0c\u8bb0 $t=(x-\\text{lowbit}(x))\\oplus (y-\\text{lowbit}(y))$\uff0c\u90a3\u4e48\u663e\u7136 $[x-\\text{lowbit}(x),x),[y-\\text{lowbit}(y),y)$ \u4e2d\u4efb\u610f\u4e24\u6570\u5f02\u6216\u8d77\u6765\u7684\u503c\u521a\u597d\u662f $[t,t+\\text{lowbit}(x))$ \u4e2d\u6bcf\u4e2a\u6570\u6070\u597d\u51fa\u73b0 $\\text{lowbit}(y)$ \u6b21\uff0c\u56e0\u4e3a $\\forall v\\in[t,t+\\text{lowbit}(x)),j\\in [y-\\text{lowbit}(y),y)$ \u90fd\u6709 $v\\oplus j\\in[x-\\text{lowbit}(x),x)$\uff0c\u8fd9\u4e2a\u7a0d\u5fae\u60f3\u60f3\u5c31\u80fd\u60f3\u660e\u767d\uff0c\u56e0\u6b64\u5bf9\u4e8e\u6240\u6709\u5f62\u5982 $[x-\\text{lowbit}(x),x),[y-\\text{lowbit}(y),y)$ \u53ef\u4ee5 $\\mathcal O(1)$ \u8ba1\u7b97\u8d21\u732e\u3002\u56e0\u6b64\u5355\u6b21\u65f6\u95f4\u590d\u6742\u5ea6 $\\log^2n$\uff0c\u603b\u590d\u6742\u5ea6 $T\\log^2n$\u3002\n\n\u53ef\u80fd\u6709\u51e0\u4e2a\u5730\u65b9\u8bb2\u5f97\u4e0d\u662f\u592a\u660e\u767d\uff0c\u5177\u4f53\u770b\u4ee3\u7801\u7f62\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi first\n#define se second\n#define fill0(a) memset(a,0,sizeof(a))\n#define fill1(a) memset(a,-1,sizeof(a))\n#define fillbig(a) memset(a,63,sizeof(a))\n#define pb push_back\n#define ppb pop_back\n#define mp make_pair\n#define y0 y101010101010\n#define y1 y010101010101\ntemplate<typename T1,typename T2> void chkmin(T1 &x,T2 y){if(x>y) x=y;}\ntemplate<typename T1,typename T2> void chkmax(T1 &x,T2 y){if(x<y) x=y;}\ntypedef pair<int,int> pii;\ntypedef long long ll;\ntypedef unsigned int u32;\ntypedef unsigned long long u64;\nnamespace fastio{\n\t#define FILE_SIZE 1<<23\n\tchar rbuf[FILE_SIZE],*p1=rbuf,*p2=rbuf,wbuf[FILE_SIZE],*p3=wbuf;\n\tinline char getc(){return p1==p2&&(p2=(p1=rbuf)+fread(rbuf,1,FILE_SIZE,stdin),p1==p2)?-1:*p1++;}\n\tinline void putc(char x){(*p3++=x);}\n\ttemplate<typename T> void read(T &x){\n\t\tx=0;char c=getchar();T neg=0;\n\t\twhile(!isdigit(c)) neg|=!(c^'-'),c=getchar();\n\t\twhile(isdigit(c)) x=(x<<3)+(x<<1)+(c^48),c=getchar();\n\t\tif(neg) x=(~x)+1;\n\t}\n\ttemplate<typename T> void recursive_print(T x){if(!x) return;recursive_print(x/10);putc(x%10^48);}\n\ttemplate<typename T> void print(T x){if(!x) putc('0');if(x<0) putc('-'),x=~x+1;recursive_print(x);}\n\tvoid print_final(){fwrite(wbuf,1,p3-wbuf,stdout);}\n}\nconst int MOD=1e9+7;\nconst int INV2=5e8+4;\nint sum(int l,int r){return 1ll*(l+r)*(r-l+1)%MOD*INV2%MOD;}\nint calc(int l1,int r1,int l2,int r2,int k){\n\tif((r1-l1+1)<(r2-l2+1)) l1^=l2^=l1^=l2,r1^=r2^=r1^=r2;\n\tint tl=(l1^l2)&~(r1-l1),tr=min(tl+r1-l1,k-1);\n\tif(tl>k-1) return 0;return 1ll*(r2-l2+1)*sum(tl+1,tr+1)%MOD;\n}\nint solve(int x,int y,int k){\n\tint ans=0;\n\tfor(int i=x;i;i&=(i-1)) for(int j=y;j;j&=(j-1))\n\t\tans=(ans+calc(i&(i-1),i-1,j&(j-1),j-1,k))%MOD;\n//\tprintf(\"%d %d %d %d\\n\",x,y,k,ans);\n\treturn ans;\n}\nint main(){\n\tint qu;scanf(\"%d\",&qu);\n\twhile(qu--){\n\t\tint x1,y1,x2,y2,k;scanf(\"%d%d%d%d%d\",&x1,&y1,&x2,&y2,&k);\n\t\tprintf(\"%d\\n\",((solve(x2,y2,k)-solve(x2,y1-1,k)-solve(x1-1,y2,k)+solve(x1-1,y1-1,k))%MOD+MOD)%MOD);\n\t}\n\treturn 0;\n}\n/*\n1\n6 3 9 5 1\n*/\n```\n\n",
        "postTime": 1615864979,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF809C Find a car"
    },
    {
        "content": "\u5b50\u77e9\u9635\u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u8f6c\u6362\u4e3a\u4e8c\u7ef4\u524d\u7f00\u3002\u90a3\u4e48\u770b\u5b8c\u8fd9\u9898\uff0c\u7b2c\u4e00\u6b65\u80af\u5b9a\u8981\u6253\u8868\u3002\n\n\u53ef\u4ee5\u968f\u4fbf\u6253\u51fa\u524d 8x8 \u7684\u8868\uff1a\n\n```\n1 2 3 4 5 6 7 8\n2 1 4 3 6 5 8 7\n3 4 1 2 7 8 5 6\n4 3 2 1 8 7 6 5\n5 6 7 8 1 2 3 4\n6 5 8 7 2 1 4 3\n7 8 5 6 3 4 1 2\n8 7 6 5 4 3 2 1\n```\n\n\u7136\u540e\u53d1\u73b0\u5bf9\u4e8e\u4e00\u4e2a $2^n \\times 2^n$ \u7684\u77e9\u9635\uff0c\u90a3\u4e48\u628a\u5b83\u5e73\u5206\u6210\u56db\u90e8\u5206\uff0c\u5b83\u4eec\u90fd\u662f\u76f8\u4f3c\u7684\uff0c\u5de6\u4e0a\u548c\u53f3\u4e0b\u76f8\u540c\uff0c\u53f3\u4e0a\u548c\u5de6\u4e0b\u4e5f\u76f8\u540c\uff0c\u4f46\u6bcf\u4e2a\u503c\u90fd\u521a\u597d\u6bd4\u5de6\u4e0a/\u53f3\u4e0b\u7684\u5bf9\u5e94\u4f4d\u7f6e\u9ad8 $2^{n-1}$\u3002\n\n\u611f\u6027\u7406\u89e3\u4e00\u4e0b\u597d\u50cf\u786e\u5b9e\u662f\u5bf9\u7684\uff0c\u7136\u540e\u7ee7\u7eed\u89c2\u5bdf\u53ef\u4ee5\u53d1\u73b0\u8fd9\u6837\u4e00\u4e2a\u77e9\u9635\u6709\u4e00\u4e2a\u66f4\u795e\u5947\u7684\u6027\u8d28\uff1a\u6bcf\u884c\u6bcf\u5217\u7684\u6570\u521a\u597d\u90fd\u662f\u4e00\u4e2a $1$ \u5230 $2^n$ \u7684\u6392\u5217\u3002\u90a3\u4e48\u6709\u4e86\u8fd9\u4e2a\u795e\u5947\u7684\u6027\u8d28\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u7528\u516c\u5f0f\u6c42\u51fa\u4e00\u4e2a\u5b50\u77e9\u9635\u7684\u4e00\u884c\u6216\u4e00\u5217\u7684\u4e0d\u8d85\u8fc7 $p$ \u7684\u6570\u7684\u548c\u4ee5\u53ca\u4e2a\u6570\uff0c\u901a\u8fc7\u4e58\u6cd5\u5c31\u53ef\u4ee5\u5f97\u5230\u51e0\u6574\u884c\u6216\u51e0\u6574\u5217\u7684\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u9012\u5f52\u6c42\u89e3\u4e86\u3002\u8bbe $f(n,m,p,x,l)$ \u8868\u793a\u4e00\u4e2a $n \\times m$ \u7684\u77e9\u9635\u4e2d\u6240\u6709\u4e0d\u8d85\u8fc7 $p$ \u7684\u6570\u52a0\u4e0a $l$ \u7684\u548c\uff0c\u5e76\u4e14\u4fdd\u8bc1 $n,m \\le x$ \u4e14 $x = 2^k(k \\in \\operatorname Z)$\u3002\u6ce8\u610f\u662f\u6bcf\u4e2a\u6570\u5206\u522b\u52a0\u4e0a $l$ \u518d\u6c42\u548c\u3002\n\n\u7136\u540e\u5206\u8ba8\u8f6c\u79fb\u5373\u53ef\uff0c\u6ce8\u610f\u6700\u591a\u53ea\u80fd\u6709\u4e00\u4e2a\u5411\u4e0b\u9012\u5f52\u7684\u5206\u652f\uff0c\u8fd9\u6837\u624d\u80fd\u4fdd\u8bc1\u590d\u6742\u5ea6\u4e3a $\\log 10^9$\uff0c\u4e0d\u59a8\u8bbe $n \\le m$\u3002\n\n\u90a3\u4e48\u5927\u81f4\u601d\u8def\u5c31\u662f\u5206\u8ba8\u8fd9\u4e2a\u77e9\u9635\u7684\u4f4d\u7f6e\uff1a\n1. \u88ab\u5de6\u4e0a\u89d2\u5305\u542b\uff0c\u90a3\u4e48\u76f4\u63a5\u8f6c\u79fb\u5373\u53ef\u3002\n2. \u5305\u542b\u4e86\u5de6\u4e0a\u89d2\uff0c\u90a3\u4e48\u9012\u5f52\u6c42\u51fa\u53f3\u4e0b\u89d2\u7684\u90e8\u5206\u7684\u7b54\u6848\uff0c\u800c\u5176\u4ed6\u7684\u90fd\u53ef\u4ee5\u5229\u7528\u90a3\u4e2a\u795e\u5947\u7684\u6027\u8d28\u5f97\u51fa\u3002\n3. \u5176\u4ed6\u60c5\u51b5\u5c31\u4e00\u5b9a\u662f\u5305\u542b\u4e86\u5de6\u4e0a\u89d2\u7684\u4e0a\u9762\u82e5\u5e72\u884c\u548c\u53f3\u4e0a\u89d2\u7684\u5de6\u4e0a\u89d2\uff0c\u90a3\u4e48\u9012\u5f52\u6c42\u51fa\u53f3\u4e0a\u89d2\u90e8\u5206\u5e76\u76f4\u63a5\u7684\u51fa\u5de6\u4e0a\u89d2\u7684\u90e8\u5206\u5373\u53ef\u3002\n\n\u5206\u8ba8\u6bd4\u8f83\u590d\u6742\uff0c\u4f46\u5199\u4e4b\u524d\u628a\u5b9a\u4e49\u60f3\u6e05\u695a\uff0c\u8ba4\u771f\u63a8\u4e00\u4e0b\u8fd8\u662f\u6bd4\u8f83\u7b80\u5355\u7684\u3002\n\n\u4ee3\u7801\uff1a\n\n```\n#include<cstdio>\n#define TY ll\n#define MAXN 100002\n#define debug if(1==1)\n#define FOR(i,a,b) for(TY i=(a);i<=(b);i=-~i)\n#define fOR(i,a,b) for(TY i=(a);i<(b);i=-~i)\n#define ROF(i,a,b) for(TY i=(a);i>=(b);i=~-i)\n#define rOF(i,a,b) for(TY i=(a);i>(b);i=~-i)\nusing namespace std;\ntypedef double db;\ntypedef long long ll;\nconst TY M=1e9+7;\ntypedef unsigned long long ull;\nTY _abs(TY a){return a<0?-a:a;}\nTY maxn(TY a,TY b){return a>b?a:b;}\nTY minn(TY a,TY b){return a<b?a:b;}\ninline void updmx(TY &x,TY y){if(x<y)x=y;}\ninline void updmn(TY &x,TY y){if(x>y)x=y;}\ninline void add(TY &x,TY y){if((x+=y)>=M)x-=M;}\nTY gcd(TY a,TY b){return b?gcd(b,a%b):a;}\nTY qp(TY a,TY b){TY ans=1;do{if(b&1)ans=ans*a%M;a=a*a%M;}while(b>>=1);return ans;}\nchar getc(){char ch=getchar();while(ch==' '||ch=='\\n'||ch=='\\r')ch=getchar();return ch;}\nTY qr(){\n\tchar ch=getchar();TY s=0,x=1;\n\tfor(;ch<'0'||ch>'9';ch=getchar())if(ch=='-')x=-1;\n\tfor(;ch>='0'&&ch<='9';ch=getchar())s=s*10+ch-'0';return x*s;\n}void qw(TY a){if(a>9)qw(a/10);putchar(a%10+'0');}\nvoid qw(TY a,char ch){\n\tif(a<0){a=-a;putchar('-');}\n\tif(a>9)qw(a/10);putchar(a%10+'0');\n\tif(ch)putchar(ch);\n}TY T=qr(),x1,y1,x2,y2,p,ans;\nTY js(TY x){return (x*(x+1)>>1)%M;}\nTY findans(TY n,TY m,TY p,TY x,TY l){\n\tif(!n||!m)return 0;if(n>m)n^=m^=n^=m;updmn(p,x);\n//\tqw(n,' ');qw(m,' ');qw(p,' ');qw(x,'\\n');\n\tif(x==1)return l+1;x>>=1;\n\tif(p<=x){//\u5982\u679c p<=x\uff0c\u90a3\u4e48\u53ea\u6709\u5de6\u4e0a\u89d2\u548c\u53f3\u4e0b\u89d2\u6709\u7528\n\t\tif(m<x)return findans(n,m,p,x,l);//\u5927\u6982\u5c31\u662f\u6309\u6587\u5b57\u9898\u89e3\u987a\u5e8f\u5206\u8ba8\u7684\n\t\tif(n<=x&&m>=x)return (n*js(p)+p*n%M*l)%M;\n\t\treturn (x*p%M*l+x*js(p)+findans(n-x,m-x,p,x,l))%M;\n\t}TY ans;if(m<x)return findans(n,m,x,x,l);\n\tif(n<=x&&m>=x){\n\t\tans=n*js(x)%M;add(ans,l*x%M*n%M);\n\t\tadd(ans,findans(n,m-x,p-x,x,l|x));return ans;\n\t}ans=x*js(x)%M;add(ans,x*x%M*l%M);n-=x;m-=x;\n\tp-=x;add(ans,findans(n,m,x,x,l));\n\tadd(ans,(n+m)*(l|x)%M*p%M);\n\tadd(ans,js(p)*(n+m)%M);return ans;\n}int main(){\n\twhile(T--){\n\t\tx1=qr()-1;y1=qr()-1;x2=qr();y2=qr();p=qr();\n\t\tans=findans(x2,y1,p,1073741824,0);\n\t\tadd(ans,findans(x1,y2,p,1073741824,0));ans=M-ans;\n\t\tadd(ans,findans(x2,y2,p,1073741824,0));\n\t\tadd(ans,findans(x1,y1,p,1073741824,0));qw(ans,'\\n');\n\t}return 0;\n}\n```",
        "postTime": 1675752178,
        "uid": 184168,
        "name": "xuanxuan001",
        "ccfLevel": 8,
        "title": "\u9898\u89e3CF809C\u3010Find a car\u3011"
    },
    {
        "content": "### \u601d\u8def\n\n#### \u8f6c\u5316\u9898\u610f\n\n\u6ce8\u610f\u5230\u8fd9\u4e2a\u201c\u6ca1\u6709\u51fa\u73b0\u8fc7\u7684\u6700\u5c0f\u6b63\u6574\u6570\u201d\u5f88\u4e0d\u8212\u670d\u3002\n\n\u6539\u5b9a\u4e49\uff1a\n\n$$b_{x,y}=a_{x+1,y+1}-1$$\n\n\u5219\u6211\u4eec\u6709\n\n$$b_{x,y}=\\operatorname{mex}(\\{b_{x,k}|0\\le k<y\\}\\cup\\{b_{k,y}|0\\le k<x\\})$$\n\n\u800c\u6211\u4eec\u6240\u6c42\u7684\u5373\n\n$$\\sum_{i=x_1}^{x_2}\\sum_{j=y_1}^{y_2}[a_{i,j}\\le k]a_{i,j}=\\sum_{i=x_1-1}^{x_2-1}\\sum_{j=y_1-1}^{y_2-1}[b_{i,j}<k](b_{i,j}+1)$$\n\n\u8bbe\n\n$$f_k(x,y)=\\sum_{i<x}\\sum_{j<y}[b_{i,j}<k]$$\n\n$$g_k(x,y)=\\sum_{i<x}\\sum_{j<y}[b_{i,j}<k]b_{i,j}$$\n\n$$h_k=f_k+g_k$$\n\n\u4e8e\u662f\u5373\u6c42 \n\n$$h_k(x_2,y_2)-h_k(x_2,y_1-1)-h_k(x_1-1,y_2)+h_k(x_1-1,y_1-1)$$\n\n\u56e0\u6b64\u73b0\u5728\u7684\u4efb\u52a1\u5c31\u662f\u5feb\u901f\u8ba1\u7b97 $f,g$\u3002\n\n\u6211\u4eec\u6307\u51fa\u5982\u4e0b\u4e8b\u5b9e\uff1a\n\n$$b_{x,y}=x\\oplus y$$\n\n\u5176\u4e2d $\\oplus$ \u8868\u793a**\u5f02\u6216**\u3002\n\n\u8bc1\u660e\uff1a\n> \u6784\u9020 $2$ \u5806\u77f3\u5b50\u7684 nim \u6e38\u620f $a_1,a_2$\uff0c\u8bbe\u5176 SG \u503c\u4e3a $c_{a_1,a_2}$\u3002\n> \n> \u7531 SG \u51fd\u6570\u7684\u5b9a\u4e49\u5f0f\uff0c\u6211\u4eec\u5f97\u5230 $c_{a_1,a_2}=\\operatorname{mex}(\\{c_{a_1,k}|0\\le k<a_2\\}\\cup\\{c_{k,a_2}|0\\le k<a_1\\})$\u3002\n> \n> \u4e8e\u662f\u4f7f\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u5bb9\u6613\u8bc1\u660e\uff0c$b_{x,y}=c_{x,y}$\u3002\n> \n> \u7531 SG \u5b9a\u7406\uff0c\u6211\u4eec\u5f97\u5230 $c_{a_1,a_2}=a_1\\oplus a_2$\u3002\n> \n> \u56e0\u6b64\uff0c$b_{x,y}=x\\oplus y$\u3002\n\n\u4e8e\u662f\n\n$$f_k(x,y)=\\sum_{i<x}\\sum_{j<y}[i\\oplus j<k]$$\n\n$$g_k(x,y)=\\sum_{i<x}\\sum_{j<y}[i\\oplus j<k](i\\oplus j)$$\n\n\u8fd9\u4e0d\u5c31\u662f[\u50a8\u80fd\u8868](https://www.luogu.com.cn/problem/P4067)\u5417\uff01\n\n\u56e0\u6b64\u6570\u4f4d dp \u662f\u80fd\u505a\u7684\u3002\u5f53\u7136\uff0c\u8fd9\u5e76\u4e0d\u4f18\u7f8e\u3002\n\n\u8003\u8651\u6709\u6ca1\u6709\u66f4\u52a0\u4f18\u7f8e\u7684\u505a\u6cd5\u3002\n\n#### \u5f02\u6216\u5377\u79ef\n\n\u6211\u4eec\u53d1\u73b0\u548c\u5f0f\u5185\u90e8\u4ec5\u548c $i\\oplus j$ \u6709\u5173\uff0c\u800c\u679a\u4e3e\u7684\u5374\u662f $i,j$\u3002\n\n\u56e0\u6b64\u8003\u8651\u80fd\u5426**\u5bf9\u6bcf\u4e2a $z=x\\oplus y$\uff0c\u53cd\u63a8\u51fa\u6709\u591a\u5c11\u4e2a\u5408\u6cd5\u7684 $(x,y)$ \u6709\u5e8f\u4e8c\u5143\u7ec4\u6ee1\u8db3\u6b64\u70b9**\u3002\n\n\u5b9a\u4e49\u6570\u5217 $f,g$ \u7684**\u5f02\u6216\u5377\u79ef**\u4e3a\u6570\u5217\n\n$$h_z=\\sum_{x\\oplus y=z}f_xg_y$$\n\n\u4e0d\u59a8\u8bb0\u4e3a $h=f\\times_\\oplus g$\u3002\n\n\u663e\u7136\u8fd9\u4e2a\u67ff\u5b50\u7684\u7ec4\u5408\u610f\u4e49\u4e3a\u679a\u4e3e $f,g$ \u5bf9\u5e94\u4e0b\u6807\u5f02\u6216\u503c\u4e3a $z$ \u7684\u65b9\u6848\u6570\uff0c\u5176\u4e2d $f,g$ \u5206\u522b\u8868\u793a\u5176\u4f5c\u4e3a\u5b50\u5f0f\u65f6\u53d8\u91cf\u5f02\u6216\u548c\u4e3a\u67d0\u503c\u7684\u65b9\u6848\u6570\u3002\n\n\u8003\u8651\u8ba1\u7b97 $f_k(x,y),g_k(x,y)$ \u7684\u8fc7\u7a0b\u3002\n\n$$f_k(x,y)=\\sum_{i<x}\\sum_{j<y}[i\\oplus j<k]=\\sum_{z<k}\\sum_{i<x}\\sum_{j<y}[i\\oplus j=z]$$\n\n$$g_k(x,y)=\\sum_{i<x}\\sum_{j<y}[i\\oplus j<k](i\\oplus j)=\\sum_{z<k}z\\sum_{i<x}\\sum_{j<y}[i\\oplus j=z]$$\n\n\u4e8e\u662f\u8bb0\n\n$$f_i=[i<x]$$\n\n$$g_i=[i<y]$$\n\n$$h=f\\times_\\oplus g$$\n\n\u5219\n\n$$h_z=\\sum_{i<x}\\sum_{j<y}[i\\oplus j=z]$$\n\n\u56e0\u6b64\n\n$$f_k(x,y)=\\sum_{z<k}h_z$$\n\n$$g_k(x,y)=\\sum_{z<k}zh_z$$\n\n#### \u7279\u6b8a\u5f62\u5f0f\u7684\u5f02\u6216\u5377\u79ef\n\n\u63a5\u4e0b\u6765\u7684\u4efb\u52a1\u5c31\u662f\u89c2\u5bdf\u5982\u4f55\u5feb\u901f\u8ba1\u7b97\u4e0e\u8bb0\u5f55\u8fd9\u4e2a\u5f02\u6216\u5377\u79ef\u7684\u7ed3\u679c\u4e86\u3002\n\n\u56e0\u4e3a\u503c\u57df\u8f83\u5927\uff0c\u6240\u4ee5\u5f02\u6216\u5377\u79ef\u663e\u7136\u4e0d\u80fd\u66b4\u529b\u4f7f\u7528\u57fa\u4e8e\u5feb\u901f\u6c83\u5c14\u4ec0\u53d8\u6362\u7684\u96c6\u5408\u5bf9\u79f0\u5dee\u5377\u79ef\u5b9e\u73b0\uff0c\u6211\u4eec\u8003\u8651\u89c2\u5bdf\u6027\u8d28\u3002\n\n\u4e0d\u59a8\u8bbe\u5728\u8ba8\u8bba\u8303\u56f4\u5185\uff0c\u4e00\u4e2a\u6570\u5217\u975e\u96f6\u503c\u7684\u4e0b\u6807\u603b\u662f\u5c0f\u4e8e $2^m$\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u5bf9\u4e8e\u6570\u5217 $f,g$\uff0c\u5176**\u524d\u4e00\u534a\u6216\u540e\u4e00\u534a\u4e0b\u6807\u5bf9\u5e94\u7684\u503c\u603b\u662f\u76f8\u7b49**\uff0c**\u53e6\u4e00\u534a\u4e0b\u6807\u5bf9\u5e94\u5730\u9012\u5f52\u6ee1\u8db3\u76f8\u540c\u6027\u8d28**\u3002\n\n\u7b80\u5355\u8ba8\u8bba\u5bb9\u6613\u9a8c\u8bc1\uff0c**\u5f02\u6216\u5377\u79ef\u4fdd\u6301\u8fd9\u4e2a\u6027\u8d28\u4e0d\u53d8**\uff0c\u56e0\u6b64 $h=f\\times_\\oplus g$ \u4e5f\u6ee1\u8db3\u8fd9\u4e2a\u6027\u8d28\u3002\n\n**\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 $m+1$ \u5bf9\u6570\uff0c\u6765\u8868\u793a\u8fd9\u6837\u7684\u4e00\u4e2a\u6570\u5217\uff08\u8bb0\u5f55\u662f\u524d\u4e00\u534a\u8fd8\u662f\u540e\u4e00\u534a\u4e3a\u5b9a\u503c\uff1b\u8bb0\u5f55\u5177\u4f53\u662f\u4ec0\u4e48\u503c\uff09\uff1b\u5bf9\u4e8e\u8fd9\u4e48\u4e00\u5bf9\u6570\u5217\u7684\u5f02\u6216\u5377\u79ef\uff0c\u6211\u4eec\u603b\u53ef\u4ee5\u5728 $O(m)$ \u7684\u65f6\u95f4\u5185\u5b9e\u73b0\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u4ecd\u4fdd\u6301\u6b64\u6027\u8d28\u7684\u6570\u5217\u3002**\n\n\u8fd9\u4e2a\u7ed3\u8bba\u6709\u4e00\u4e2a\u7ecf\u5178\u7684\u4e60\u9898\uff1a[loj3073\u300c2019 \u96c6\u8bad\u961f\u4e92\u6d4b Day 2\u300d\u5e8f\u5217](https://loj.ac/p/3073)\u3002\u611f\u5174\u8da3\u53ef\u4ee5\u53bb\u505a\u4e00\u505a\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f18\u7f8e\u5730\u5728 $O(\\log v)$ \u7684\u65f6\u95f4\u5185\u89e3\u51b3\u6bcf\u4e00\u95ee\u4e86\u3002\n\n### Code\n\n\u7ffb\u8bd1\u6ca1\u7ffb\u5230\u4f4d\uff0c\u539f\u6765\u662f\u5bf9 $10^9+7$ \u53d6\u6a21\u7684\u2026\u2026\n\n\u4ee3\u7801\u8dd1\u5f97\u5f88\u5feb\u3002\n\n\u4e0b\u9762\u662f\u6838\u5fc3\u4ee3\u7801\u3002\n\n---\n#### Update on 2022.11.5\n\n\u6253\u725b\u5ba2\u53d1\u73b0\u5f02\u6216\u5377\u79ef\u677f\u5b50\u5047\u4e86\uff0c\u56de\u6765\u4fee\u4e00\u4fee\u3002\n\n---\n\n\n```cpp\nconst ullt Mod=1e9+7;\ntypedef ConstMod::mod_ullt<Mod>modint;\ntypedef std::vector<std::pair<bol,modint> >vec;\ntypedef std::vector<modint>modvec;\nconst uint M=32;ullt Len[M+1];\nmodvec User(vec a){\n    modvec Ans(M+1);\n    for(uint i=0;i<=M;i++)Ans[i]=a[i].second*Len[i];\n    for(uint i=M;i;i--)Ans[i-1]+=Ans[i];\n    return Ans;\n}\nvec mul(vec A,vec B){\n    vec Ans(M+1);modvec UserA=User(A),UserB=User(B);\n    for(uint i=0;i<M;i++)\n    {\n        Ans[i].first=A[i].first==B[i].first;\n        Ans[i+1].second+=Ans[i].second+A[i].second*B[i].second*Len[i];\n        Ans[i].second+=A[i].second*UserB[i+1]+B[i].second*UserA[i+1];\n    }\n    Ans[M].second+=A[M].second*B[M].second;\n    return Ans;\n}\nvec get(ullt r){\n    vec Ans(M+1);\n    for(uint i=0;i<M;i++)if(r>=Len[i])Ans[i]={0,1},r-=Len[i];else Ans[i]={1,0};\n    Ans[M].second=r;return Ans;\n}\nmodint sum(ullt l,ullt r){return(l+r-1)*(r-l)/2;}\nmodint find(vec A,ullt k){\n    modint ans;ullt from=0;\n    for(uint i=0;i<M;i++)if(A[i].first)\n    {\n        if(k>Len[i])ans+=sum(from+Len[i]+1,from+k+1)*A[i].second,k=Len[i];\n    }else{\n        if(k<=Len[i]){\n            ans+=sum(from+1,from+k+1)*A[i].second;\n            return ans;\n        }\n        ans+=sum(from+1,from+Len[i]+1)*A[i].second;\n        k-=Len[i];\n        from+=Len[i];\n    }\n    if(k)ans+=(from+1)*A[M].second;\n    return ans;\n}\n```\n",
        "postTime": 1667266883,
        "uid": 105050,
        "name": "myee",
        "ccfLevel": 7,
        "title": "809C"
    },
    {
        "content": "# $\\texttt{Solution}$\n\n\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u5148\u6253\u4e00\u4e2a $20\\times 20$ \u7684\u8868\uff08\u65b9\u4fbf\u770b\u51fa\u5de8\u5927\u7684\u6570\u5b57\u5dee\uff09\u3002\n\n\u7136\u540e\u53d1\u73b0\u8fd9\u6837\u5b50\u7684\u4e00\u4e2a\u4e8b\u5b9e\uff1a\n$$\na(x+2^k,y+2^k)=a(x,y)\\\\\na(x+2^k,y)=a(x,y)+2^k\\\\\na(x,y+2^k)=a(x,y)+2^k\\\\\n$$\n\n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\uff1a$a(x,y)=(x-1)\\oplus(y-1)+1$\n\n\u90a3\u4e48\u6211\u4eec\u4e8b\u5b9e\u4e0a\u5c31\u662f\u8981\u6c42\uff1a\n$$\n\\sum_{i=x_1}^{x2}\\sum_{j=y_1}^{y_2} (i-1)\\oplus (j-1)+1 ((i-1)\\oplus (j-1)+1\\le k)\n$$\n\n\u4e00\u4e2a\u5dee\u5206\u4e4b\u540e\uff0c\u5c31\u662f\u4e00\u4e2a\u6bd4\u8f83\u5957\u8def\u7684\u6570\u4f4d $\\texttt{DP}$ \u4e86\u3002\n\n\u6211\u4eec\u8003\u8651\u8bbe $f(x,0\\sim2,0\\sim 2,0\\sim 2)$ \u8868\u793a\u505a\u5230\u7b2c $i$ \u4f4d\uff0c\u76f8\u5bf9\u4e8e $n,m,k$ \u5f53\u524d\u7684\u72b6\u6001\uff08\u5c0f\u4e8e\u9650\u5236\uff0c\u7b49\u4e8e\u9650\u5236\uff0c\u8d85\u8fc7\u9650\u5236\uff09\u65f6\u7684\u7b54\u6848\u3002\n\n\u53d1\u73b0\u8fd9\u6837\u5b50\u4e0d\u597d\u8f6c\u79fb\uff0c\u90a3\u4e48\u518d\u8bbe\u4e00\u4e2a\u8f85\u52a9\u6570\u7ec4\uff0c\u8bb0\u5f55\u8fd9\u79cd\u72b6\u6001\u4e0b\u6709\u591a\u5c11\u4e2d\u65b9\u6848\uff0c\u7136\u540e\u5957\u8def\u8f6c\u79fb\u5c31\u597d\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a $\\mathcal O(T\\times \\log n)$\n\n# $\\texttt{Code}$\n\n``` cpp\nlong long Va(long long x,long long y){if (x==y) return 1;if (x<y) return 0;return 2; } \nlong long Vb(long long x,long long y,long long z){\n\tif ((x<y)) return 0;if (x>y) return 2;return z;\n}\nlong long calc(long long n,long long m){\n\tif ((n<0)||(m<0)) return 0;\n\tfor (i=0;i<=30;i++) for (A=0;A<=2;A++) for (B=0;B<=2;B++) for (C=0;C<=2;C++) f[i][A][B][C]=e[i][A][B][C]=0;\n    for (A=0;A<=1;A++)\n       for (B=0;B<=1;B++)\n           f[0][Va(A,n&1)][Va(B,m&1)][Va(A^B,K&1)]+=A^B,e[0][Va(A,n&1)][Va(B,m&1)][Va(A^B,K&1)]++;\n\tfor (i=1;i<=30;i++)\n        for (lst1=0;lst1<=2;lst1++)\n           for (lst2=0;lst2<=2;lst2++)\n             for (lst3=0;lst3<=2;lst3++)\n                for (now1=0;now1<=1;now1++)\n                   for (now2=0;now2<=1;now2++){\n                   \t   tagA=((n&(1ll<<i))>0);tagB=((m&(1ll<<i))>0);tagC=((K&(1ll<<i))>0);\n                   \t   valA=Vb(now1,tagA,lst1);valB=Vb(now2,tagB,lst2);valC=Vb(now1^now2,tagC,lst3);\n                   \t   f[i][valA][valB][valC]+=((now1^now2)*(1ll<<i)*e[i-1][lst1][lst2][lst3])+f[i-1][lst1][lst2][lst3];\n                   \t   f[i][valA][valB][valC]%=MOD;\n                   \t   e[i][valA][valB][valC]+=e[i-1][lst1][lst2][lst3];\n                   \t   e[i][valA][valB][valC]%=MOD;\n\t\t\t\t   }\n\tlong long tot=0;\n\tfor (lst1=0;lst1<=1;lst1++)\n\t   for (lst2=0;lst2<=1;lst2++)\n\t      for (lst3=0;lst3<=1;lst3++)\n\t        tot=(tot+f[30][lst1][lst2][lst3]+e[30][lst1][lst2][lst3]) % MOD;\n\treturn tot;\n}\nvoid Main(){\n\tXa=read();Ya=read();Xb=read();Yb=read();K=read();\n\tXa--;Ya--;Xb--;Yb--;K--;\n\ttot=calc(Xb,Yb)-calc(Xa-1,Yb)-calc(Xb,Ya-1)+calc(Xa-1,Ya-1);\n\ttot=(tot % MOD+MOD) % MOD;\n\tprintf(\"%lld\\n\",tot);     \n\treturn ;\n}\n```\n\n",
        "postTime": 1650952783,
        "uid": 508480,
        "name": "Albedo",
        "ccfLevel": 0,
        "title": "CF809C\u9898\u89e3"
    },
    {
        "content": "\u7ec8\u4e8e\u628a\u8fd9\u9898 A \u6389\u4e86\uff0c\u611f\u52a8\u4e2d\u56fd\uff08\n\n\u505a\u8fd9\u9898\u4e5f\u662f\u4e00\u6ce2\u4e09\u6298\u554a\u2026\u2026\u51e0\u5929\u524d\u60f3\u7684\u65f6\u5019\u60f3\u5047\u6389\u4e86\uff0c\u4ea4\u4e0a\u53bb T \u4e86\uff0c\u7136\u540e\u5495\u4e86\u597d\u51e0\u5929\u4e00\u76f4\u5495\u5230\u73b0\u5728\u3002\u7136\u540e\u8fd9\u6570\u4f4d DP \u53c8\u4e0d\u662f\u4e00\u822c\u7684\u96be\u5199\uff0c\u5199\u7684\u8fc7\u7a0b\u4e2d\u5fc3\u6001\u5d29\u8fc7\u51e0\u6b21\u3002\u7136\u540e\u53c8\u4e0d\u662f\u4e00\u822c\u7684\u96be\u8c03\uff0c\u8c03\u51fa\u6765\u4e4b\u540e\u4ea4\u4e0a\u53bb\u53c8 WA \u4e86\u2026\u2026\u7136\u540e\u53d1\u73b0\u662f\u7206 `ll` \u4e86\uff0c\u6539\u6210 `__int128_t` \u4e0a\u53bb\uff0c\u53c8 CE \u4e86\u2026\u2026\u53ea\u597d\u624b\u52a8\u628a\u7206\u70b8\u7684\u5730\u65b9\u6539\u8fc7\u6765\u624d AC\u3002\n\n---\n\n**[Portal]( https://www.luogu.com.cn/problem/CF809C )**\n\n\u9996\u5148\u6253\u4e2a\u8868\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u5206\u5f62\uff0c\u5f62\u5f0f\u5316\u7684\u8868\u8ff0\u5c31\u662f $a=\\begin{bmatrix}a&a+n_a\\\\a+n_a&a\\end{bmatrix}$\u3002\u7136\u540e\u6211\u5c31\u76f4\u63a5\u9012\u5f52\u4e86\uff0c\u5199\u5f97\u50cf\u4e8c\u7ef4\u7ebf\u6bb5\u6811\u4e00\u6837\uff0c\u4ee5\u4e3a\u662f\u4e8c\u6b21\u5bf9\u6570\u7684\u3002\u4f46\u5176\u5b9e\u8fd9\u4e2a\u662f\u5047\u7684\uff0c\u56e0\u4e3a\u4e8c\u7ef4\u7ebf\u6bb5\u6811\u662f\u6a2a\u7740\u7ad6\u7740\u5404\u5206\u4e3a\u82e5\u5e72\u4e2a\u6574\u533a\u95f4\uff0c\u6a2a\u7ad6\u72ec\u7acb\uff0c\u800c\u8fd9\u4e2a\u9664\u6b64\u4e4b\u5916\u8fd8\u8981\u6ee1\u8db3\u6a2a\u7ad6\u76f8\u7b49\uff08\u5373\u662f\u4e2a\u6b63\u65b9\u5f62\uff09\u3002\n\n\u7136\u540e\u5c31\u81ea\u7206\u4e86\uff0c\u5c31\u770b\u9898\u89e3\u4e86\u3002\u53d1\u73b0\u4e00\u4e2a\u7ed3\u8bba\uff1a$a_{i,j}=(i-1)\\oplus(j-1)+1$\u3002\u90a3\u4e48\u5230\u5e95\u600e\u4e48\u624d\u80fd\u53d1\u73b0\u8fd9\u4e2a\u7ed3\u8bba\u6211\u4e5f\u662f\u4e0d\u77e5\u9053\u7684\uff0c\u56e0\u4e3a\u6211\u8981\u667a\u5546\u6ca1\u667a\u5546\uff0c\u8981\u773c\u529b\u6ca1\u773c\u529b\u3002\n\n\u6211\u4eec\u8003\u8651\u5c06\u6240\u6c42\u95ee\u9898\u4e8c\u4f4d\u524d\u7f00\u548c\u4e00\u4e0b\uff0c\u90a3\u4e48\u95ee\u9898\u5f52\u7ea6\u5230\u6c42 $\\sum\\limits_{i=0}^x\\sum\\limits_{j=0}^y[i\\oplus j<k]((i\\oplus j)+1)$\u3002\u8fd9\u4e5f\u662f\u4e2a\u6bd4\u8f83\u96be\u7684\u95ee\u9898\u3002\u8003\u8651\u7c7b\u4f3c\u6570\u4f4d DP\uff08\u4e8c\u8fdb\u5236\uff09\u5730\u7edf\u8ba1\u7b54\u6848\uff1a\u5c06 $x,y$ \u5206\u522b\u62c6\u6210\u4f4d\u6570\u6bd4\u539f\u6570\u4f4e\u7684\u3001\u548c\u539f\u6570\u7684\u4e00\u4e2a\u524d\u7f00\u540e\u9762\u968f\u4fbf\u52a0\u7684\u4e00\u4e9b\uff0c\u8fd9\u6837\u6bcf\u90e8\u5206\u90fd\u662f\u4e00\u4e2a\u56fa\u5b9a\u7684\u524d\u7f00\u540e\u9762\u6709\u82e5\u5e72\u4f4d\u968f\u4fbf\u653e\u7684\u8fd9\u4e2a\u5f62\u5f0f\uff0c\u5e76\u4e14\u6570\u91cf\u662f\u5bf9\u6570\u7ea7\u522b\u7684\u3002\u73b0\u5728\u6211\u4eec\u53ea\u8981\u6c42\uff0c\u4e24\u4e2a\u8fd9\u6837\u5f62\u5f0f\u7684\u6570\u7684\u4e0a\u9762\u90a3\u4e2a $\\sum$ \u7684\u503c\u662f\u591a\u5c11\uff0c\u5e76\u4e14\u8fd8\u8981\u662f\u5e38\u6570\u65f6\u95f4\uff0c\u8fd9\u6837\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u4e8c\u6b21\u5bf9\u6570\u3002\n\n\u8fd9\u4e2a\u5c31\u5206\u7c7b\u5c0f\u8ba8\u8bba\u4e00\u4e0b\u5373\u53ef\u3002\u6ce8\u610f\u5230\u5c40\u9762\u662f\u4e0b\u9762\u8fd9\u4e2a\u6837\u5b50\u7684\uff1a\n\n```\n.----.----------.\n| h1 |    z1    |\n.----.-----.----.\n|    h2    | h2 |\n.----------.----.\n|        k      |\n.---------------.\n```\n\n\u90a3\u4e48\u663e\u7136\u53ef\u4ee5\u5206\u4e3a\u4e09\u6bb5\u3002\u7b2c\u4e00\u6bb5\u4e0a\u4e0b\u7684\u5f02\u6216\u548c\u662f\u56fa\u5b9a\u7684\uff0c\u90a3\u4e48\u5c31\u8ba8\u8bba\u4e00\u4e0b\u4e0e $k$ \u7684\u8fd9\u6bb5\u7684\u5927\u5c0f\u3002\u5982\u679c\u5927\u90a3\u5c31\u4e3a $0$\uff0c\u5982\u679c\u5c0f\u90a3\u5c31\u540e\u9762\u968f\u4fbf\u53d6\uff08\u8fd9\u4e2a\u5f88\u5bb9\u6613\u7b97\u51fa\u5f0f\u5b50\uff0c\u7b49\u5dee\u6570\u5217\u4e5f\u53ef\u4ee5\u641e\u5b9a\uff09\uff0c\u5982\u679c\u76f8\u7b49\u5c31\u7ee7\u7eed\u5f80\u4e0b\u3002\u7136\u540e\u770b\u7b2c\u4e8c\u6bb5\uff0c\u8fd9\u4e2a\u7b2c\u4e00\u4e2a\u6570\u7684\u90e8\u5206\u662f\u81ea\u5df1\u53d6\u7684\uff0c\u7b2c\u4e8c\u4e2a\u6570\u7684\u90e8\u5206\u662f\u56fa\u5b9a\u7684\u3002\u4e8e\u662f\u5206\u5c0f\u4e8e\u548c\u7b49\u4e8e $k$ \u8fd9\u90e8\u5206\u4e24\u79cd\u52a0\u8d77\u6765\u3002\u5c0f\u4e8e\u7684\u8bdd\u540e\u9762\u968f\u4fbf\u53d6\uff0c\u5bb9\u6613\u5217\u5f0f\uff1b\u7b49\u4e8e\u7684\u8bdd\uff0c\u540e\u9762\u8981\u5c0f\u4e8e\uff0c\u4e5f\u5bb9\u6613\u3002\n\n\u4ee3\u7801\u5f02\u5e38\u96be\u5199\uff0c\u7ec6\u8282\u591a\u7684\u4e00\u6279\u3002\u6211\u7b2c\u4e00\u904d\u5199\u5b8c\u540e\u53ea\u6709\u4e00\u4e2a\u9519\u8bef\u4e5f\u662f\u86ee\u4e86\u4e0d\u8d77\u7684\u3002\n\n**_[code]( https://www.luogu.com.cn/paste/0y3ef2ss )_**",
        "postTime": 1605624595,
        "uid": 138400,
        "name": "chenxia25",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF809C \u3010Find a car\u3011"
    },
    {
        "content": "~~\u901a\u8fc7\u77aa\u773c\u6cd5~~\u53d1\u73b0\uff0c$a_{i,j}=(i-1)\\text{ xor }(j-1)+1$\u3002\n\n\u4e8c\u7ef4\u5dee\u5206\u4e00\u4e0b\uff0c\u6211\u4eec\u53ea\u8981\u80fd\u6c42$\\sum\\limits_{i=0}^x\\sum\\limits_{j=0}^yi\\text{ xor }j\\le k$\u5c31\u597d\u4e86\u3002\n\n\u6bd4\u8f83\u5957\u8def\u7684\u6570\u4f4dDP\u3002\n\n\u4ece\u9ad8\u4f4d\u5f80\u4f4e\u4f4d\u505a\uff0c\u8bbe$f[t][0/1][0/1][0/1]$\u8868\u793a\u5230\u7b2c$t$\u4f4d\uff0c$i,j,i\\text{ xor }j$\u5df2\u786e\u5b9a\u7684\u503c\u662f\u5426\u5361\u5230$x,y,k$\u524d$t$\u4f4d\u7684\u4e0a\u754c\u7684\u65b9\u6848\u6570\u548c\u6743\u503c\u548c\u3002\n\n\u6bcf\u4e00\u4f4d\u7684\u8f6c\u79fb\u90fd\u662f\u4e00\u4e2a\u5c0f\u8ba8\u8bba\uff1a\u5982\u679c\u4e4b\u524d\u5361\u5230\u4e0a\u754c\uff0c\u8fd9\u4e00\u4f4d\u53ef\u4ee5\u63a5\u7740\u5361\uff0c\u6216\u8005\u5982\u679c\u8fd9\u4e00\u4f4d\u7684\u4e0a\u754c\u662f$1$\uff0c\u5c31\u53ef\u4ee5\u586b$0$\u8f6c\u79fb\u5230\u4e0d\u5361\u4e0a\u754c\u3002\u5982\u679c\u4e4b\u524d\u4e0d\u5361\u4e86\uff0c\u90a3\u4e48\u8fd9\u4e00\u4f4d\u968f\u4fbf\u9009\u3002\n\n\u6ce8\u610f\u5230\u6700\u5f00\u59cb\u7684\u5f0f\u5b50\u91cc\u6709\u4e00\u4e2a$+1$\uff0c\u6240\u4ee5\u8981\u8f93\u51fa$\\sum$\u6743\u503c\u548c+\u65b9\u6848\u6570\u3002\n\n\u4e0b\u9762\u7684\u4ee3\u7801\u4f7f\u7528\u4e86\u538b\u4f4d\u548cdefine\u53ef\u80fd\u4f1a\u6bd4\u8f83\u4e11\n```cpp\n#include<bits/stdc++.h>\n#define R register int\nusing namespace std;\nconst int YL=1e9+7;\nint t,fc[8],fs[8],gc[8],gs[8];\ninline int in(){R x;scanf(\"%d\",&x);return x;}\ninline void M(R&x){if(x>=YL)x-=YL;}\n#define T(x,u,v) if(i>1||w==x)Trans(i>>1,li,u,v,i>1?w^x:w)\nvoid Trans(R i,R li,R u,R v,R w){//\u66b4\u641c\u8f6c\u79fb\n    if(!i){\n        if(w)gs[v]=(gs[v]+fc[u]*(long long)t)%YL;\n        return M(gc[v]+=fc[u]),M(gs[v]+=fs[u]);\n    }\n    if(i&li){T(0,u,v|i);T(1,u,v);}//\u8ba8\u8bba\u5f00\u59cb\n    else T(0,u,v);\n    T(0,u|i,v|i);\n    T(1,u|i,v|i);\n}\nint Dp(R n,R m,R k){\n    if(n<0||m<0)return 0;\n    memset(fc,0,32);fc[0]=1;\n    memset(fs,0,32);\n    for(t=1<<30;t;t>>=1){\n        Trans(4,!!(n&t)*4|!!(m&t)*2|!!(k&t),0,0,0);\n        memcpy(fc,gc,32),memset(gc,0,32);\n        memcpy(fs,gs,32),memset(gs,0,32);\n    }\n    R s=0;\n    for(R i=0;i<8;++i)M(s+=fs[i]),M(s+=fc[i]);\n    return s;\n}\nint main(){\n    for(R q=in();q--;){\n        R x1=in()-2,y1=in()-2,x2=in()-1,y2=in()-1,k=in()-1;\n        cout<<((Dp(x2,y2,k)-Dp(x1,y2,k)-Dp(x2,y1,k)+Dp(x1,y1,k))%YL+YL)%YL<<endl;\n    }\n    return 0;\n}\n```",
        "postTime": 1552814310,
        "uid": 61325,
        "name": "FlashHu",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF809C \u3010Find a car\u3011"
    }
]
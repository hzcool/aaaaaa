[
    {
        "content": "\u975e\u5e38\u5999\u7684\u4e00\u9053\u9898\n\n\u9996\u5148\u5b83\u7ed9\u7684\u56fe\u975e\u5e38\u7684\u6709\u6027\u8d28\uff0c$A_i$\u5411$A_{i+1}$\u8fde\u4e86\u4e00\u6761\u8fb9\uff0c\u7136\u540e$B_i$\u5411$B_{i+1}$\u8fde\u4e00\u6761\u8fb9\uff0c\u7136\u540e$A$\u5411$B$\u5185\u4efb\u610f\u8fde\u8fb9\uff0c\u5b58\u5728\u8fb9\u6743\n\n\u6211\u4eec\u53ef\u4ee5\u6ce8\u610f\u5230\u6309\u7167\u6700\u5c0f\u5272\u7684\u6027\u8d28\uff0c\u5047\u8bbe\u6211\u4eec\u5272\u4e86$A_i->A_{i+1}$\u8fd9\u4e00\u6761\u8fb9\uff0c\u90a3\u4e48\u6211\u4eec\u4e00\u5b9a\u4e0d\u4f1a\u5272\u53bb$A_u->A_{u+1}(u>i)$\u8fd9\u4e00\u6761\u8fb9\uff0c\u8fd9\u662f\u56e0\u4e3a$A_u$\u5230$A_{u+1}$\u5df2\u7ecf\u6ca1\u6cd5\u518d\u8fde\u5411$A_1$\u4e86\n\n\u7531\u4e8e\u4e0a\u8ff0\u7684\u7ed3\u8bba\uff0c\u4e0d\u59a8\u5047\u8bbe\u5272\u53bb$A_x->A_{x+1}$\u662f\u6700\u5c0f\u5272\u7684\u4e00\u6761\u5272\u8fb9\uff0c\u90a3\u4e48\u663e\u7136\u6211\u4eec\u4e0d\u4f1a\u5272\u53bb$A_{(i<x)}->A_{i+1}$\u8fd9\u6761\u8fb9\uff0c\u5426\u5219\u6211\u4eec\u5272\u53bb\u90a3\u6761\u8fb9\u5c31\u4e0d\u4f1a\u518d\u5272\u53bb$A_x->A_{x+1}$\u8fd9\u6761\u8fb9\u4e86\uff0c\u4e8e\u662f\u6709\u6211\u4eec\u4f1a\u5272\u4e14\u4ec5\u5272\u53bb\u4e00\u6761$A_{i}->A_{i+1}$\u7684\u8fb9\n\n\u540c\u7406\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u5f97\u5230\u6211\u4eec\u4f1a\u5272\u4e14\u4ec5\u5272\u53bb\u4e00\u6761$B_{i}->B_{i+1}$\u8fd9\u6837\u7684\u4e00\u6761\u8fb9\n\n\u6211\u4eec\u4ee4\u5272\u53bb\u7684$A_u->A_{u+1},B_v->B_{v+1}$\u4e3a\u4e8c\u5143\u7ec4$(u,v)$\u9020\u6210\u7684\u8d21\u732e\uff0c\u4ee4\u5176\u8fb9\u6743\u4e3a$a_u,b_v$\uff0c\u4ee4\u8fde\u63a5$A,B$\u95f4\u7684\u8fb9\u8fb9\u6743\u4e3a$c$\n\n\u90a3\u4e48\u663e\u7136\u6709\n\n$$cost_{u,v}=a_u+b_v+\\sum_{i\\le u\\&j>v}c_{i,j}$$\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5bf9\u4e8e\u4e00\u4e2a$u$\uff0c\u5176\u6700\u4f18\u7684$v$\u662f\u56fa\u5b9a\u7684\n\n\u5373\u4f7f\u662f\u4fee\u6539\u4e5f\u4ec5\u4ec5\u662f\u5355\u70b9\u6539$a_i$\uff0c\u6240\u4ee5\u5373\u4f7f\u4fee\u6539\u4e5f\u4e0d\u4f1a\u5bf9\u540e\u9762\u90a3\u4e00\u5768\u9020\u6210\u5f71\u54cdqwq\n\n\u4ee4\u5bf9\u4e8e\u4e00\u4e2a$u$\u6700\u4f18\u7684\u540e\u9762\u90a3\u4e00\u5768\u7684\u6743\u503c\u4e3a$p_u$\n\n\u4e8e\u662f\u4fee\u6539\u5c31\u662f\u6539$a_u$\u6c42$(a_u+p_u)_{min}$\n\n\u8003\u8651\u6c42\u89e3$p_u$\n\n\u5bf9$b$\u5f00\u4e00\u9897\u7ebf\u6bb5\u6811\uff0c\u8003\u8651\u4e00\u6b21\u6c42\u89e3$u=1...n$\u65f6\u7684$p_u$\n\n\u90a3\u4e48\u6bcf\u6b21$u$\u589e\u5927\u5c31\u53ea\u9700\u8981\u4fee\u6539\u4e0d\u540c$b$\u7684\u6743\u503c\u5373\u53ef\uff0c\u7ebf\u6bb5\u6811\u5e38\u89c4\u64cd\u4f5cqwq\n\n\u5f53\u7136\u8fd9\u9053\u9898\u6709\u90a3\u4e48\u4e00\u70b9\u70b9\u5f1f\u5f1f\u5728\u4e8e\uff0c\uff0c\uff0c\u5b83\u53ef\u80fd\u4e0d\u5220\u6389\u4efb\u4f55\u4e00\u6761$A$\u8fb9/$B$\u8fb9\uff0c\u8fd9\u5c31\u5bfc\u81f4\u5176\u975e\u5e38\u7684$\\rm naive$\n\n\u6240\u4ee5\u6211\u4eec\u8fd8\u8981\u4e24\u6761\u8fb9\u6743\u4e3a$0$\u7684\u8fb9\u6765\u7279\u5224\u8fd9\u4e24\u79cd\u60c5\u51b5...\n\n\u56e0\u4e3a\u5b9e\u5728\u662f\u8bb2\u4e0d\u6e05\u4e86~~\u61d2\u764c\u665a\u671f~~\uff0c\u6240\u4ee5\u8fd8\u662f\u770b\u4ee3\u7801\u5427...\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define rep( i, s, t ) for( register int i = s; i <= t; ++ i )\n#define Next( i, x ) for( register int i = head[x]; i; i = e[i].next )\n#define re register\n#define ls(x) x * 2\n#define rs(x) x * 2 + 1\n#define inf 1e17\n#define int long long\nint read() {\n\tchar cc = getchar(); int cn = 0, flus = 1;\n\twhile(cc < '0' || cc > '9') {  if( cc == '-' ) flus = -flus;  cc = getchar();  }\n\twhile(cc >= '0' && cc <= '9')  cn = cn * 10 + cc - '0', cc = getchar();\n\treturn cn * flus;\n}\nconst int N = 2e5 + 5 ; \nint n, m, q, A[N], B[N], C[N] ; \nint head[N], cnt ; \nstruct E { int to, next, w ; } e[N * 2] ;\nstruct Tr { int mi, tag ; } tr[N * 4] ;\ninline void add( int x, int y, int z ) {\n\te[++ cnt] = (E){ y, head[x], z }, head[x] = cnt ; \n}\ninline void build( int x, int l, int r ) {\n\tif( l == r ) { tr[x].mi = B[l] ; return ; }\n\tint mid = ( l + r ) >> 1 ; \n\tbuild( ls(x), l, mid ), build( rs(x), mid + 1, r ) ;\n\ttr[x].mi = min( tr[ls(x)].mi, tr[rs(x)].mi ) ;\n}\ninline void pushmark( int x ) {\n\tif( tr[x].tag )\n\t\ttr[ls(x)].mi += tr[x].tag, tr[rs(x)].mi += tr[x].tag, \n\t\ttr[ls(x)].tag += tr[x].tag, tr[rs(x)].tag += tr[x].tag, \n\t\ttr[x].tag = 0 ;\n}\ninline void update( int x, int l, int r, int ql, int qr, int w ) {\n\tif( ql > r || qr < l ) return ; \n\tif( ql <= l && r <= qr ) { tr[x].mi += w, tr[x].tag += w ; return ; }\n\tint mid = ( l + r ) >> 1 ; pushmark(x) ; \n\tupdate( ls(x), l, mid, ql, qr, w ), update( rs(x), mid + 1, r, ql, qr, w ) ;\n\ttr[x].mi = min( tr[ls(x)].mi, tr[rs(x)].mi ) ; \n}\nvoid Init() {\n\tbuild( 1, 1, n ) ; \n\trep( x, 1, n ) {\n\t\tNext( i, x ) update( 1, 1, n, 1, e[i].to, e[i].w ) ;\n\t\tC[x] = tr[1].mi ; \n\t}\n\tmemset( tr, 0, sizeof(tr) ) ;\n\trep( i, 1, n ) B[i] = A[i] + C[i] ; \n\tbuild( 1, 1, n ) ;\n}\nsigned main()\n{\n\tn = read(), m = read(), q = read() ; int x, y, z ; \n\trep( i, 2, n ) A[i - 1] = read(), B[i] = read() ; B[1] = 0 ;\n\trep( i, 1, m ) {\n\t\tx = read(), y = read(), z = read(), add( x, y, z ) ;\n\t}\n\tInit() ; printf(\"%I64d\\n\", tr[1].mi );\n\trep( i, 1, q ) {\n\t\tx = read(), z = read() ; \n\t\tupdate( 1, 1, n, x, x, z - A[x] ), A[x] = z ; \n\t\tprintf(\"%I64d\\n\", tr[1].mi ) ; \n\t}\n\treturn 0 ;\n}\n```",
        "postTime": 1568613553,
        "uid": 30036,
        "name": "Soulist",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF903G \u3010Yet Another Maxflow Problem\u3011"
    },
    {
        "content": "# [CF903G]Yet Another Maxflow Problem\n\n### \u9898\u76ee\u5927\u610f\uff1a\n\n\u6709$A$\u7c7b\u70b9\u548c$B$\u7c7b\u70b9\u5404$n(n\\le2\\times10^5)$\u4e2a\uff0c\u6240\u6709$A_i$\u5230$A_{i+1}$\u6709\u4e00\u6761\u6743\u503c\u4e3a$a_i$\u7684\u6709\u5411\u8fb9\uff0c\u6240\u6709$B_i$\u5230$B_{i+1}$\u6709\u4e00\u6761\u6743\u503c\u4e3a$b_i$\u7684\u6709\u5411\u8fb9\uff0c\u53e6\u6709$m(m\\le2\\times10^5)$\u6761\u4ece$A_x$\u5230$B_y$\u7684\u6743\u503c\u4e3a\u6709\u5411\u8fb9\u3002\u8fde\u7eed$q(q\\le2\\times10^5)$\u6b21\u64cd\u4f5c\u5c06$A_{v_i}$\u4e0e$A_{v_i+1}$\u4e4b\u95f4\u7684\u8fb9\u7684\u6743\u503c\u6539\u4e3a$w_i$\u3002\u95ee\u6bcf\u6b21\u4fee\u6539\u5b8c\u6bd5\u540e\u7684\u4ece$A_1$\u5230$B_n$\u7684\u6700\u5927\u6d41\u3002\n\n### \u601d\u8def\uff1a\n\n\u6839\u636e\u6700\u5927\u6d41-\u6700\u5c0f\u5272\u5b9a\u7406\uff0c\u9898\u76ee\u6240\u6c42\u76f8\u5f53\u4e8e\u6bcf\u6b21\u4fee\u6539\u5b8c\u6bd5\u540e\u7684\u6700\u5c0f\u5272\u3002\u5b9a\u4e49$A$\u7c7b\u70b9\u95f4\u7684\u8fb9\u4e3a$A$\u7c7b\u8fb9\uff0c$B$\u7c7b\u70b9\u95f4\u7684\u8fb9\u4e3a$B$\u7c7b\u8fb9\uff0c$AB$\u7c7b\u70b9\u95f4\u7684\u8fb9\u4e3a$C$\u7c7b\u8fb9\u3002\u5047\u8bbe\u4e24\u7c7b\u8fb9\u5404$n-1$\u6761\u4e4b\u5916\u8fd8\u5206\u522b\u6709\u4e00\u4e2a\u8fb9\u6743\u4e3a$0$\u7684\u8fb9\uff0c\u90a3\u4e48\u6bcf\u6b21\u7684\u6700\u5c0f\u5272\u4e00\u5b9a\u6070\u597d\u5305\u542b\u4e00\u4e2a$A$\u7c7b\u8fb9\u3001\u4e00\u4e2a$B$\u7c7b\u8fb9\u548c\u82e5\u5e72$C$\u7c7b\u8fb9\u3002\u7531\u4e8e$B$\u7c7b\u8fb9\u548c$C$\u7c7b\u8fb9\u90fd\u4e0d\u4f1a\u88ab\u4fee\u6539\uff0c\u5219\u5bf9\u4e8e\u540c\u4e00\u4e2a$A$\u7c7b\u8fb9\uff0c\u5bf9\u5e94\u7684\u6700\u4f18\u7684$B$\u7c7b\u8fb9\u662f\u56fa\u5b9a\u7684\u3002\u65b9\u4fbf\u8d77\u89c1\uff0c\u4e0b\u6587\u5c06$B_i$\u5230$B_{i+1}$\u7684\u8fb9\u8bb0\u4f5c$b_{i+1}$\uff0c\u4e0d\u540c\u4e8e\u9898\u9762\u63cf\u8ff0\u3002\n\n\u8003\u8651\u9884\u5904\u7406\u6bcf\u4e2a$A$\u7c7b\u8fb9\u5bf9\u5e94\u7684\u6700\u4f18$B$\u7c7b\u8fb9\u3002\u4e0d\u96be\u53d1\u73b0\uff0c\u82e5\u6211\u4eec\u9009\u62e9\u4e86$a_i$\u548c$b_j$\u4e24\u6761\u8fb9\uff0c\u8981\u4f7f\u5f97$A_1$\u4e0e$B_n$\u4e0d\u8fde\u901a\uff0c\u5219\u6211\u4eec\u8fd8\u9700\u8981\u5272\u53bb\u6240\u6709\u8fde\u63a5$A_x,B_y(x\\le i,y\\ge j)$\u7684$C$\u7c7b\u8fb9\uff0c\u800c\u8fd9\u4e5f\u662f\u9009\u62e9$a_i$\u548c$b_j$\u540e\u7684\u6700\u5c0f\u5272\u3002\u53cd\u8fc7\u6765\u8bf4\uff0c\u8fde\u63a5$A_x,B_y$\u7684$C$\u7c7b\u8fb9\u4f1a\u5bf9$a_i,b_j(x\\le i,y\\ge j)$\u7684\u9009\u62e9\u4ea7\u751f\u5f71\u54cd\u3002\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5$1\\sim n$\u679a\u4e3e\u6bcf\u4e2a$a_i$\uff0c\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u5bf9\u5e94\u6bcf\u4e2a$b_j$\u6240\u9700\u8981\u7684\u6700\u5c0f\u5272\u7684\u5927\u5c0f\u3002\u9996\u5148\u5c06\u6240\u6709$b_j$\u52a0\u5165\u5230\u7ebf\u6bb5\u6811\u4e2d\uff0c\u5bf9\u4e8e\u5f53\u524d\u679a\u4e3e\u5230\u7684$a_i$\uff0c\u679a\u4e3e\u4ece$A_i$\u51fa\u53d1\u7684\u6240\u6709$C$\u7c7b\u8fb9\uff0c\u82e5\u5bf9\u5e94\u7684\u70b9\u4e3a$B_j$\uff0c\u6743\u503c\u4e3a$w$\uff0c\u5c06\u533a\u95f4$[1,j]$\u52a0\u4e0a$w$\uff0c\u8868\u793a\u5bf9\u4e8e$a_i$\u53ca$a_i$\u4ee5\u540e\u7684$A$\u7c7b\u8fb9\uff0c\u82e5\u8fd8\u8981\u8003\u8651$b_j$\u53ca$b_j$\u4ee5\u524d\u7684$B$\u7c7b\u8fb9\u4f5c\u4e3a\u5bf9\u5e94\u8fb9\uff0c\u4e00\u5b9a\u8981\u5272\u53bb\u8fd9\u6761$C$\u7c7b\u8fb9\u3002\u800c\u6bcf\u6b21\u63d2\u5165\u540e\u7ebf\u6bb5\u6811\u6700\u5c0f\u5143\u7d20\u5c31\u662f\u5bf9\u5e94\u5f53\u524d$a_i$\uff0c\u7531\u4e00\u4e2a$B$\u7c7b\u8fb9\u548c\u82e5\u5e72$C$\u7c7b\u8fb9\u7ec4\u6210\u7684\u3001\u80fd\u4e0e$a_i$\u6784\u6210\u5272\u7684\u8fb9\u6743\u548c\uff0c\u8bb0\u8fd9\u4e00\u8fb9\u6743\u548c\u4e3a$sum$\uff0c\u5219\u9009\u62e9$a_i$\u65f6\u7684\u6700\u5c0f\u5272\u4e3a$sum+a_i$\uff0c\u8bb0\u4f5c$c_i$\u3002\n\n\u8003\u8651\u4fee\u6539\u64cd\u4f5c\uff0c\u7531\u4e8e$a_i$\u5bf9\u5e94\u7684$B$\u7c7b\u8fb9\u548c$C$\u7c7b\u8fb9\u5df2\u7ecf\u786e\u5b9a\uff0c\u6bcf\u6b21\u4fee\u6539\u65f6$a_i$\u7684\u53d8\u5316\u4e5f\u5c31\u662f$c_i$\u7684\u53d8\u5316\u3002\u7528\u4e00\u4e9b\u6570\u636e\u7ed3\u6784\u7ef4\u62a4\u6240\u6709$c_i$\u7684\u6700\u5c0f\u503c\u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6$\\mathcal O((m+q)\\log n)$\u3002\n\n### \u6e90\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<cctype>\n#include<vector>\nusing int64=long long;\ninline int getint() {\n\tregister char ch;\n\twhile(!isdigit(ch=getchar()));\n\tregister int x=ch^'0';\n\twhile(isdigit(ch=getchar())) x=(((x<<2)+x)<<1)+(ch^'0');\n\treturn x;\n}\nconstexpr int N=2e5+1;\nint64 a[N],b[N],c[N];\nusing Edge=std::pair<int,int>;\nstd::vector<Edge> e[N];\nclass SegmentTree {\n\t#define _left <<1\n\t#define _right <<1|1\n\tprivate:\n\t\tint64 val[N<<2],tag[N<<2];\n\t\tvoid push_up(const int &p) {\n\t\t\tval[p]=std::min(val[p _left],val[p _right]);\n\t\t}\n\t\tvoid push_down(const int &p) {\n\t\t\tif(!tag[p]) return;\n\t\t\tval[p _left]+=tag[p];\n\t\t\tval[p _right]+=tag[p];\n\t\t\ttag[p _left]+=tag[p];\n\t\t\ttag[p _right]+=tag[p];\n\t\t\ttag[p]=0;\n\t\t}\n\tpublic:\n\t\tvoid build(const int &p,const int &b,const int &e,const int64 arr[]) {\n\t\t\ttag[p]=0;\n\t\t\tif(b==e) {\n\t\t\t\tval[p]=arr[b];\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst int mid=(b+e)>>1;\n\t\t\tbuild(p _left,b,mid,arr);\n\t\t\tbuild(p _right,mid+1,e,arr);\n\t\t\tpush_up(p);\n\t\t}\n\t\tvoid modify(const int &p,const int &b,const int &e,const int &l,const int &r,const int64 &v) {\n\t\t\tif(b==l&&e==r) {\n\t\t\t\tval[p]+=v;\n\t\t\t\ttag[p]+=v;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpush_down(p);\n\t\t\tconst int mid=(b+e)>>1;\n\t\t\tif(l<=mid) modify(p _left,b,mid,l,std::min(mid,r),v);\n\t\t\tif(r>mid) modify(p _right,mid+1,e,std::max(mid+1,l),r,v);\n\t\t\tpush_up(p);\n\t\t}\n\t\tint64 query() const {\n\t\t\treturn val[1];\n\t\t}\n\t#undef _left\n\t#undef _right\n};\nSegmentTree t;\nint main() {\n\tconst int n=getint(),m=getint(),q=getint();\n\tfor(register int i=1;i<n;i++) {\n\t\ta[i]=getint(),b[i+1]=getint();\n\t}\n\tt.build(1,1,n,b);\n\tfor(register int i=0;i<m;i++) {\n\t\tconst int u=getint(),v=getint(),w=getint();\n\t\te[u].push_back({v,w});\n\t}\n\tfor(register int x=1;x<=n;x++) {\n\t\tfor(register auto &j:e[x]) {\n\t\t\tconst int &y=j.first,&w=j.second;\n\t\t\tt.modify(1,1,n,1,y,w);\n\t\t}\n\t\tc[x]=t.query()+a[x];\n\t}\n\tt.build(1,1,n,c);\n\tprintf(\"%lld\\n\",t.query());\n\tfor(register int i=0;i<q;i++) {\n\t\tconst int x=getint(),v=getint();\n\t\tt.modify(1,1,n,x,x,v-a[x]);\n\t\ta[x]=v;\n\t\tprintf(\"%lld\\n\",t.query());\n\t}\n\treturn 0;\n}\n```\n\n",
        "postTime": 1527216451,
        "uid": 10086,
        "name": "skylee",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF903G \u3010Yet Another Maxflow Problem\u3011"
    },
    {
        "content": "## Solution CF903G Yet Another Maxflow Problem\n[\u9898\u76ee\u94fe\u63a5](https://codeforces.com/problemset/problem/903/G)\n\n\u9898\u610f\u63cf\u8ff0\n>\u7ed9\u5b9a\u4e00\u5f20\u56fe\uff0c\u5de6\u53f3\u5404$n$\u4e2a\u8282\u70b9\uff0c$A_i\\to A_{i+1}$\u8fde\u8fb9\uff0c$B_i\\to B_{i+1}$\u200b\u8fde\u8fb9\uff0c\u5bb9\u91cf\u7ed9\u51fa\u3002\n>\u6709$m$\u5bf9$A_i\\to B_j$\u200b\u6709\u8fb9\uff0c\u5bb9\u91cf\u7ed9\u51fa\u3002\n>\u4f60\u9700\u8981\u5148\u6c42\u51fa\u539f\u56fe\u4ece$A_1$\u5230$B_n$\u7684\u6700\u5927\u6d41\uff0c\u7136\u540e\u6709$q$\u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u64cd\u4f5c\u7ed9\u51fa$i$\uff0c\u5148\u4fee\u6539$A_i\\to A_{i+1}$\u7684\u8fb9\u7684\u5bb9\u91cf\uff0c\u7136\u540e\u8be2\u95ee\u4ece$A_1$\u5230$B_n$\u7684\u6700\u5927\u6d41\u3002\n\nSolution\uff1a\n\n\u663e\u7136\u6700\u5927\u6d41\u5148\u8f6c\u6700\u5c0f\u5272\uff0c\u5219\u8003\u8651\u5272\u6389\u54ea\u4e9b\u8fb9\u6700\u4f18\u3002\n\n![](https://cdn.luogu.com.cn/upload/vjudge_pic/CF903G/dcc7a52e873b883e6fea740d5c4aff84e5c0da8d.png)\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u5272\u8fb9\u6709\u56db\u79cd\u9009\u62e9\uff1a\u5de6\u90e8\u94fe\u4e0a\u5272or\u4e0d\u5272\uff0c\u53f3\u90e8\u94fe\u4e0a\u5272or\u4e0d\u5272\uff0c\u4e58\u6cd5\u539f\u7406\u5f97\u5230\u56db\u79cd\u9009\u62e9\u3002\n\n\u6211\u4eec\u4e0d\u5e0c\u671b\u8fc7\u591a\u7684\u5206\u7c7b\u8ba8\u8bba\uff0c\u56e0\u6b64\u53ef\u4ee5\u5728$A_1$\u4e0a\u9762\u589e\u52a0\u4e00\u6761\u8fb9\u8868\u793a\u5de6\u90e8\u4e0d\u5272\u8fb9\uff0c\u5728$B_n$\u4e0b\u9762\u589e\u52a0\u4e00\u6761\u8fb9\u8868\u793a\u53f3\u90e8\u4e0d\u5272\u8fb9\u3002\u90a3\u4e48\u95ee\u9898\u5c31\u662f\u5728\u5de6\u90e8\u5272\u82e5\u5e72\u6761\u8fb9\uff0c\u53f3\u90e8\u5272\u82e5\u5e72\u6761\u8fb9\uff0c\u518d\u5272\u6389\u4e2d\u95f4\u4e0e$A_1,B_n$\u8fde\u901a\u7684\u8fb9\uff0c\u6c42\u6240\u6709\u65b9\u6848\u6700\u5c0f\u4ee3\u4ef7\u3002\n\n\u5728\u5de6\u90e8\u6216\u53f3\u90e8\u540c\u65f6\u5272\u6389\u591a\u6761\u8fb9\u663e\u7136\u662f\u4e0d\u4f18\u7684\uff0c\u56e0\u4e3a\u53ea\u6709\u65ad\u6389\u7684\u4e0e$A_1,B_n$\u6700\u8fd1\u7684\u8fb9\u4ea7\u751f\u4e86\u5272\u7684\u6548\u679c\uff0c\u4e8e\u662f\u95ee\u9898\u53ef\u4ee5\u62bd\u8c61\u4e3a\u4e00\u4e2a\u5f0f\u5b50\uff1a\n\n$$Min\\{A_x+B_y+\\sum\\limits_{u,v\\in E,u<x,v\\geq y}W(u,v)\\}$$\n\n\u6b64\u65f6\u56de\u5230\u9898\u76ee\uff1a$q$\u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u64cd\u4f5c\u7ed9\u51fa$i$\uff0c\u5148\u4fee\u6539$A_i\\to A_{i+1}$\u7684\u8fb9\u7684\u5bb9\u91cf\uff0c\u7136\u540e\u8be2\u95ee\u4ece$A_1$\u5230$B_n$\u7684\u6700\u5927\u6d41\u3002\n\n\u6ce8\u610f\u5230\u4fee\u6539\u4ec5\u5728\u5de6\u90e8\u8fdb\u884c\uff0c\u56e0\u6b64\u5bf9\u4e8e\u5272\u6389\u4e00\u6761\u5de6\u90e8\u8fb9$A_x\\to A_{x+1}$\uff0c\u6240\u5bf9\u5e94\u7684\n$$B_y+\\sum\\limits_{u,v\\in E,u<x,v\\geq y}W(u,v)$$\n\u662f\u4e0d\u53d8\u7684\u3002\u8003\u8651\u4f7f\u7528\u7ebf\u6bb5\u6811\uff0c\u5c06$B$\u653e\u5230\u7ebf\u6bb5\u6811\u4e0a\uff0c\u4ece$1$\u5230$n$\u52a0\u5165$A_x$\uff0c\u6bcf\u5230\u4e00\u4e2a\u65b0\u70b9\u5c31\u679a\u4e3e\u8be5\u70b9\u7684\u8fb9\u96c6$E(x,v)$\uff0c\u5728\u7ebf\u6bb5\u6811\u4e0a\u5bf9\u5e94\u533a\u95f4$v\\sim n$\u8fdb\u884c\u533a\u95f4\u52a0\uff0c\u7136\u540e\u6c42\u5168\u5c40\u6700\u5c0f\u503c\u3002\u6c42\u5b8c\u540e\u5c06\n$$Min\\{A_x+B_y+\\sum\\limits_{u,v\\in E,u<x,v\\geq y}W(u,v)\\}$$\n\u653e\u5165\u4e00\u68f5\u65b0\u7684\u7ebf\u6bb5\u6811\uff0c\u4e4b\u540e\u7684\u64cd\u4f5c\u5c31\u662f\u5355\u70b9\u4fee\u6539$+$\u5168\u5c40\u6700\u5c0f\u503c\uff0c\u76f4\u63a5\u7ef4\u62a4\u5373\u53ef\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define INF 0x3f3f3f3f\n#define N 200005\n#define ls k<<1\n#define rs k<<1|1\n#define mid ((l+r)>>1)\n#define mp make_pair\n#define pb push_back\n#define fi first\n#define se second\n#define pii pair<int,int>\n#define il inline\n#define file(x) freopen(x\".in\",\"r\",stdin);freopen(x\".out\",\"w\",stdout);\nusing namespace std;\nil int read(){\n\tint w=0,h=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')h=-h;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){w=w*10+ch-'0';ch=getchar();}\n\treturn w*h;\n}\nstruct Edge{\n\tint next,to,val;\n}edge[N];\nint n,m,q;\nint head[N],num;\nint A[N],B[N],res[N];\nvoid add(int u,int v,int w){\n\tedge[++num].next=head[u];\n\tedge[num].to=v;\n\tedge[num].val=w;\n\thead[u]=num;\n}\nnamespace SGT{\n\tint Min[N<<2],Tag[N<<2];\n\tvoid pushup(int k){Min[k]=min(Min[ls],Min[rs]);}\n\tvoid pushdown(int k){\n\t\tif(!Tag[k])return;\n\t\tMin[ls]+=Tag[k];Min[rs]+=Tag[k];\n\t\tTag[ls]+=Tag[k];Tag[rs]+=Tag[k];\n\t\tTag[k]=0;\n\t}\n\tvoid build(int k,int l,int r){\n\t\tTag[k]=0;\n\t\tif(l==r){\n\t\t\tMin[k]=B[l];\n\t\t\treturn;\n\t\t}\n\t\tbuild(ls,l,mid);\n\t\tbuild(rs,mid+1,r);\n\t\tpushup(k);\n\t}\n\tvoid modify(int k,int l,int r,int x,int y,int val){\n\t\tif(l>=x&&r<=y){\n\t\t\tMin[k]+=val;\n\t\t\tTag[k]+=val;\n\t\t\treturn;\n\t\t}\n\t\tpushdown(k);\n\t\tif(x<=mid)modify(ls,l,mid,x,y,val);\n\t\tif(mid<y)modify(rs,mid+1,r,x,y,val);\n\t\tpushup(k);\n\t}\n}\nsigned main(){\n\tn=read();m=read();q=read();\n\tfor(int i=2;i<=n;i++)A[i-1]=read(),B[i]=read();\n\tfor(int i=1;i<=m;i++){\n\t\tint u=read(),v=read(),w=read();\n\t\tadd(u,v,w);\n\t}\n\tSGT::build(1,1,n);\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=head[i];j;j=edge[j].next){\n\t\t\tint v=edge[j].to,w=edge[j].val;\n\t\t\tSGT::modify(1,1,n,1,v,w);\n\t\t}\n\t\tres[i]=SGT::Min[1];\n\t}\n\tfor(int i=1;i<=n;i++)B[i]=res[i]+A[i];\n\tSGT::build(1,1,n);\n\tprintf(\"%lld\\n\",SGT::Min[1]);\n\twhile(q--){\n\t\tint x=read(),val=read();\n\t\tSGT::modify(1,1,n,x,x,val-A[x]);\n\t\tA[x]=val;\n\t\tprintf(\"%lld\\n\",SGT::Min[1]);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1635863276,
        "uid": 191538,
        "name": "pidan",
        "ccfLevel": 0,
        "title": "CF903G"
    },
    {
        "content": "## CF903G\n### \u9898\u610f\u7b80\u8ff0\n\u6709\u4e00\u5f20\u56fe\uff0c\u7ed3\u6784\u4e3a $A,B$ \u4e24\u6761\u957f\u5ea6\u4e3a $n$ \u7684\u94fe\uff0c\u518d\u7531 $A$ \u5411 $B$ \u8fde\u4e86 $m$ \u6761\u8fb9\u3002$q$ \u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u4fee\u6539 $A$ \u94fe\u4e0a\u4e00\u6761\u8fb9\u7684\u6743\u503c\uff0c\u6c42 $A_1\\to B_n$ \u7684\u6700\u5927\u6d41\u3002\n\n$n,m,q\\leq 2\\times 10^5$\u3002\n\n### \u9898\u76ee\u5206\u6790\n\u6700\u5927\u6d41\u8f6c\u6210\u6700\u5c0f\u5272\u540e\uff0c\u663e\u7136 $A,B$ \u4e2d\u7684\u8fb9\u53ea\u4f1a\u5404\u5272\u6389\u4e00\u6761\u3002\u8bbe\u6211\u4eec\u5272\u6389 $A$ \u4e2d\u7684\u7b2c $i$ \u6761\u8fb9\uff0c$B$ \u4e2d\u7684\u7b2c $j$ \u6761\u8fb9\uff0c\u90a3\u4e48\u5c31\u8fd8\u9700\u8981\u5272\u6389 $A$ \u4e2d\u7b2c $i$ \u6761\u8fb9\u524d\u9762\u7684\u70b9\u8fde\u5230 $B$ \u4e2d\u7b2c $j$ \u6761\u8fb9\u540e\u9762\u7684\u70b9\u7684\u8fb9\u3002\n\n\u6211\u4eec\u628a\u201c\u5272\u6389 $A$ \u4e2d\u7684\u7b2c $i$ \u6761\u8fb9\uff0c$B$ \u4e2d\u7684\u7b2c $j$ \u6761\u8fb9\u201d\u770b\u4f5c\u4e8c\u7ef4\u5e73\u9762\u4e0a\u7684\u4e00\u4e2a\u70b9 $(i,j)$\uff0c\u5219\u4e0d\u96be\u53d1\u73b0\u672c\u9898\u7684\u672c\u8d28\u662f\u82e5\u5e72\u6b21\u77e9\u5f62\u52a0\u548c\u67e5\u8be2\u5168\u5c40\u6700\u5c0f\u503c\u3002\u7136\u800c\uff0c\u82e5\u6211\u4eec\u4f7f\u7528\u79bb\u7ebf\u540e cdq \u5206\u6cbb\u7684\u65b9\u6cd5\uff0c\u4f1a\u56e0\u4e3a\u62c6\u5dee\u5206/\u626b\u63cf\u7ebf\u592a\u591a\u800c\u8d85\u65f6\uff1b\u82e5\u4f7f\u7528\u6811\u5957\u6811\uff0c\u5219\u4f1a\u8d85\u7a7a\u95f4\u3002\u6211\u4eec\u8003\u8651\u53d1\u6398\u672c\u9898\u4e2d\u64cd\u4f5c\u7684\u6027\u8d28\u3002\n\n\u6211\u4eec\u53d1\u73b0\uff0c\u4fee\u6539\u64cd\u4f5c\u53ea\u4fee\u6539 $A$ \u94fe\u4e0a\u7684\u8fb9\u6743\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c$B$ \u94fe\u4e0a\u548c $A\\to B$ \u7684\u8fb9\u6743\u6240\u5e26\u6765\u7684\u77e9\u5f62\u64cd\u4f5c\u662f\u5728\u8be2\u95ee\u4e4b\u524d\u5c31\u786e\u5b9a\u4e86\u7684\u3002\u800c\u8003\u8651\u6211\u4eec\u7684\u4e8c\u7ef4\u5e73\u9762\uff0c\u4fee\u6539 $A$ \u4e2d\u7684\u7b2c $i$ \u6761\u8fb9\u4f1a\u5f71\u54cd\u5230\u6240\u6709\u7684 $(i,j)$\uff0c\u4e5f\u5c31\u662f\u4e00\u5217\u3002\u65e2\u7136\u6240\u6709\u7684\u4fee\u6539\u90fd\u662f\u5728\u4e00\u5217\u4e2d\u6574\u4f53\u8fdb\u884c\u7684\uff0c\u90a3\u5c31\u8bf4\u660e\u6bcf\u4e00\u5217\u7684 **\u6700\u5c0f\u503c\u4f4d\u7f6e** \u4e0d\u4f1a\u53d1\u751f\u6539\u53d8\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u5904\u7406\u539f\u6765\u7684\u8fb9\u6743\u5e26\u6765\u7684\u77e9\u5f62\u52a0\uff0c\u9884\u5904\u7406\u51fa\u6bcf\u4e00\u5217\u7684\u6700\u5c0f\u503c\uff0c\u518d\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u8fd9 $n$ \u5217\u5373\u53ef\u3002\n\nCode\uff1a\uff08\u5220\u9664\u4e86\u5934\u6587\u4ef6\u548c\u5feb\u8bfb\uff09\n```cpp\nconst int N=2e5+10;\nint n,m,q,wa[N];\nll w[N];\nvector<pii>e[N];\nstruct SegmentTree\n{\n\tll mn[N<<2],tag[N<<2];\n\tvoid pushup(int p){mn[p]=min(mn[p<<1],mn[p<<1|1]);}\n\tvoid pushdown(int p)\n\t{\n\t\tif(!tag[p])return;\n\t\tmn[p<<1]+=tag[p],tag[p<<1]+=tag[p];\n\t\tmn[p<<1|1]+=tag[p],tag[p<<1|1]+=tag[p];\n\t\ttag[p]=0;\n\t}\n\tvoid upd(int p,int l,int r,int L,int R,ll d)\n\t{\n\t\tif(L<=l&&r<=R){mn[p]+=d,tag[p]+=d;return;}\n\t\tpushdown(p);int mid=(l+r)>>1;\n\t\tif(L<=mid)upd(p<<1,l,mid,L,R,d);\n\t\tif(R>mid)upd(p<<1|1,mid+1,r,L,R,d);\n\t\tpushup(p);\n\t}\n}sgt;\nint main()\n{\n\tread(n),read(m),read(q);\n\tfor(int i=1,x;i<n;i++)read(wa[i]),read(x),sgt.upd(1,1,n,i+1,i+1,x);\n\tfor(int i=1,x,y,z;i<=m;i++)\n\t{\n\t\tread(x),read(y),read(z);\n\t\te[x].push_back({y,z});\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(auto p:e[i])sgt.upd(1,1,n,1,p.fi,p.se);\n\t\tw[i]=wa[i]+sgt.mn[1];\n\t}\n\tmemset(sgt.mn,0,sizeof(sgt.mn));\n\tmemset(sgt.tag,0,sizeof(sgt.tag));\n\tfor(int i=1;i<=n;i++)sgt.upd(1,1,n,i,i,w[i]);\n\twrite(sgt.mn[1]);\n\tfor(int i=1,x,y;i<=q;i++)\n\t{\n\t\tread(x),read(y);\n\t\tsgt.upd(1,1,n,x,x,y-wa[x]),wa[x]=y;\n\t\twrite(sgt.mn[1]);\n\t}\n\tIO::pchar(0);\n\treturn 0;\n}\n```",
        "postTime": 1651043878,
        "uid": 333574,
        "name": "Tyyyyyy",
        "ccfLevel": 7,
        "title": "CF903G \u9898\u89e3"
    },
    {
        "content": "\u8fd9\u8fb9\u662f\u4e00\u4e2a\u4e0d\u7528\u7ebf\u6bb5\u6811\u7684\u505a\u6cd5\uff0c\u6211\u4e5f\u4e0d\u77e5\u9053\u95ee\u9898\u51fa\u5728\u54ea\u91cc\u4e86\uff0c\u5f88\u795e\u5947\u3002\n\n\u9996\u5148\u5fc5\u7136\u662f\u6700\u5927\u6d41\u8f6c\u6700\u5c0f\u5272\u3002\n\n\u5bb9\u6613\u53d1\u73b0 $A_i\\to A_{i+1}$ \u548c $B_i\\to B_{i+1}$ \u7684\u8fb9\u90fd\u53ea\u4f1a\u65ad\u4e00\u6761\uff0c\u800c\u4fee\u6539\u53ea\u4f1a\u4fee\u6539 $A$\uff0c\u4e8e\u662f\u5982\u679c\u56fa\u5b9a $A$ \u4e2d\u65ad\u7684\u8fb9\uff0c$B$ \u4e2d\u65ad\u7684\u8fb9\u4e5f\u56fa\u5b9a\u4e86\u3002\u4e8e\u662f\u6211\u4eec\u53ea\u9700\u5728\u4e00\u5f00\u59cb\u6c42\u51fa\u65ad\u6bcf\u6761 $A$ \u8fb9\u4f1a\u65ad\u54ea\u6761 $B$ \u8fb9\u5373\u53ef\u3002\u6613\u8bc1\u8fd9\u4e2a\u662f\u6709\u5355\u8c03\u6027\u7684\u3002\u4e8e\u662f\u6211\u4eec\u76f4\u63a5\u5206\u6cbb\u7b97\u51fa\u6765\u5c31\u884c\u3002\n\n\u590d\u6742\u5ea6 $O(n\\log^2 n)$\u3002\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=2e5+10;\nconst int mod=1e9+7;\n#define inf 1e9\ninline int read(){\n\tint x=0,f=1;char c=getchar();\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9'){x=(x<<1)+(x<<3)+c-'0';c=getchar();}\n\treturn x*f;\n}\n#define ll long long\n#define INF 1e18\n#define pb push_back\n#define pii pair<int,int>\n#define fi first\n#define se second\n#define mkp make_pair\nvector<pii>E[maxn];\nint n,m,q,A[maxn],B[maxn];ll Ans[maxn],tr[maxn];\ninline void add(int x,int y){for(;x<=n;x+=x&(-x))tr[x]+=y;}\ninline ll query(int x){ll res=0;for(;x;x-=x&(-x))res+=tr[x];return res;}\ninline void solve(int l,int r,int L,int R){\n\tif(l>r)return;int mid=(l+r)>>1;\n\tfor(int i=l;i<=mid;i++)\n\t\tfor(auto x:E[i])add(n-x.fi+1,x.se);\n\tint pos=L;ll res=INF;\n\tfor(int i=L;i<=R;i++){\n\t\tll now=B[i]+query(n-i+1);\n\t\tif(now<res)pos=i,res=now;\n\t}Ans[mid]=res;\n\tfor(int i=l;i<=mid;i++)\n\t\tfor(auto x:E[i])add(n-x.fi+1,-x.se);\n\tsolve(l,mid-1,L,pos);\n\tfor(auto x:E[mid])add(n-x.fi+1,x.se);\n\tsolve(mid+1,r,pos,R);\n}\nmultiset<ll>S;\nint main(){\n\tn=read(),m=read(),q=read();\n\tfor(int i=1;i<n;i++)A[i]=read(),B[i+1]=read();\n\tfor(int i=1,x,y,z;i<=m;i++)\n\t\tx=read(),y=read(),z=read(),E[x].pb(mkp(y,z));\n\tsolve(1,n,1,n);\n\tfor(int i=1;i<=n;i++)S.insert(A[i]+Ans[i]);\n\tprintf(\"%lld\\n\",*S.begin());\n\tfor(int i=1,x,y;i<=q;i++){\n\t\tx=read(),y=read();\n\t\tS.erase(S.find(A[x]+Ans[x]));\n\t\tA[x]=y;S.insert(y+Ans[x]);\n\t\tprintf(\"%lld\\n\",*S.begin());\n\t}\n\treturn 0;\n}\n```\n\n\u6df1\u6df1\u5730\u611f\u5230\u81ea\u5df1\u7684\u5f31\u5c0f\u3002",
        "postTime": 1679708233,
        "uid": 140876,
        "name": "syzf2222",
        "ccfLevel": 9,
        "title": "CF903G Yet Another Maxflow Problem"
    }
]
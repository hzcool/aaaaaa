[
    {
        "content": ">### [\u6d1b\u8c37\u9898\u76ee\u9875\u9762\u4f20\u9001\u95e8](https://www.luogu.org/problem/CF263E) & [CodeForces\u9898\u76ee\u9875\u9762\u4f20\u9001\u95e8](https://codeforces.com/contest/263/problem/E)\n\n>\u7ed9\u5b9a\u4e00\u4e2a$n$\u884c$m$\u5217\u7684\u77e9\u9635\uff0c\u7b2c$i$\u884c$j$\u5217\u4e3a$a_{i,j}$\uff0c\u4ee5\u53ca\u4e00\u4e2a\u5e38\u6570$s\\in\\left[1,\\left\\lceil\\dfrac{\\min(n,m)}2\\right\\rceil\\right]$\uff0c\u6c42\u4e00\u4e2a\u6b63\u6574\u6570\u5bf9$(a,b)(a\\in[s,n-s+1],b\\in[s,m-s+1])$\u4f7f\u5f97$f(a,b)=\\sum\\limits_{i=1}^m\\sum\\limits_{j=1}^m\\max(0,s-(|i-a|+|j-b|))a_{i,j}$\u6700\u5927\u3002\n\n>$n,m\\in\\left[1,10^3\\right]$\u3002\n\n\u5c06\u77e9\u9635\u4e0a\u6bcf\u683c\u5bf9\u51fd\u6570$f$\u503c\u7684\u8d21\u732e\u7684\u7cfb\u6570\u753b\u51fa\u6765\uff0c\u4f1a\u53d1\u73b0\u5b83\u662f\u4e2a\u659c\u7740\u7684\u6b63\u65b9\u5f62\uff0c\u4e2d\u5fc3\u7cfb\u6570\u7b49\u4e8e$s$\uff0c\u5f80\u5916$1$\u5c42\u7cfb\u6570\u51cf$1$\uff0c\u51cf\u5230$0$\u4e3a\u6b62\uff0c\u5982\u4e0b\u56fe\u3002\n\n![](https://s2.ax1x.com/2020/01/17/lzIwef.png)\n\n\u679a\u4e3e\u4e2d\u5fc3\u70b9\uff0c\u53ef\u4ee5\u5f97\u5230$\\mathrm O(nm)$\u4e2a\u8fd9\u6837\u7684\u6b63\u65b9\u5f62\u3002\u73b0\u5728\u95ee\u9898\u662f\u600e\u4e48\u5feb\u901f\u6c42\u51fa\u6240\u6709\u6b63\u65b9\u5f62\u7684\u7cfb\u6570\u4e58\u683c\u5b50\u5185\u7684\u6570\u4e4b\u548c\uff0c\u5373\u6240\u6709\u4e2d\u5fc3\u70b9\u7684\u51fd\u6570\u503c\u3002\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86$f(i,j)$\uff0c\u73b0\u5728\u60f3\u77e5\u9053$f(i,j+1)$\u3002\u4e0d\u59a8\u628a\u8fd9\u4e24\u4e2a\u6b63\u65b9\u5f62\u753b\u51fa\u6765\uff0c\u770b\u5b83\u4eec\u76f8\u5dee\u4ec0\u4e48\u3002\n\n![](https://s2.ax1x.com/2020/01/17/lzOjFP.png)\n\n\u5982\u4e0a\u56fe\uff0c\u662f$2$\u4e2a\u76f8\u90bb\u7684$s=3$\u7684\u6b63\u65b9\u5f62\uff0c\u7d2b\u8272\u7684\u6570\u5b57\u662f\u6b64\u683c\u5b50\u5185\u7ea2\u8272\u7cfb\u6570\u51cf\u84dd\u8272\u7cfb\u6570\u3002\u4e0d\u96be\u53d1\u73b0\uff0c\u5de6\u8fb9\u4e00\u534a\u662f\u4e00\u4e2a\u5dee\u90fd\u662f$-1$\u3001\u9ad8\u4e3a$s=3$\u3001\u76f4\u89d2\u9876\u70b9\u5728\u5e95\u8fb9\u5de6\u4fa7\u7684\u7b49\u8170\u76f4\u89d2\u4e09\u89d2\u5f62\uff0c\u53f3\u8fb9\u4e00\u534a\u662f\u4e00\u4e2a\u5dee\u90fd\u662f$1$\u2026\u2026\u5e95\u8fb9\u53f3\u4fa7\u2026\u2026\u3002\u7531\u6b64\u53ef\u4ee5\u5f52\u7eb3\u51fa\uff0c\u8bbe$trl_{i,j}$\u8868\u793a\u5e95\u8fb9\u4e2d\u70b9\u4e3a$(i,j)$\u3001\u9ad8\u4e3a$s$\u3001\u76f4\u89d2\u9876\u70b9\u5728\u5e95\u8fb9\u5de6\u4fa7\u7684\u7b49\u8170\u76f4\u89d2\u4e09\u89d2\u5f62\u5185\u5143\u7d20\u4e4b\u548c\uff0c$trr_{i,j}$\u8868\u793a\u2026\u2026\u5e95\u8fb9\u53f3\u4fa7\u2026\u2026\uff0c\u5219$f(i,j)=f(i,j-1)-trl_{i,j-1}+trr_{i,j}$\u3002\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86$trl,trr$\u6570\u7ec4\uff0c\u90a3\u4e48\u53ef\u4ee5$\\forall i\\in[s,n-s+1]$\uff0c\u66b4\u529b\u7528\u5bf9\u89d2\u7ebf\u524d\u7f00\u548c$\\mathrm O(s)$\u6c42\u51fa$f(i,s)$\uff0c\u7136\u540e$\\forall i\\in[s,n-s+1],\\forall j\\in(s,m-s+1]$\uff0c\u7528\u4e0a\u9762\u90a3\u4e2a\u5173\u7cfb\u5f0f\u9012\u63a8\u6c42\u51fa$f(i,j)$\uff0c\u603b\u590d\u6742\u5ea6\u4e3a$\\mathrm O(nm)$\u3002\n\n\u73b0\u5728\u95ee\u9898\u8f6c\u5316\u4e3a\u600e\u4e48\u5feb\u901f\u6c42\u51fa$trl,trr$\u6570\u7ec4\u3002\u4ee5$trl$\u4e3a\u4f8b\uff0c\u5148\u753b\u51fa\u76f8\u90bb\u4e24\u4e2a\u4e09\u89d2\u5f62\u3002\n\n![](https://s2.ax1x.com/2020/01/19/19DKKg.png)\n\n\u5982\u4e0a\u56fe\uff0c\u662f\u4e24\u4e2a\u76f8\u90bb\u7684$s=3$\u7684\u4e09\u89d2\u5f62\uff0c\u7d2b\u8272\u7684\u6570\u5b57\u662f\u6b64\u683c\u5b50\u5185\u7ea2\u8272\u7cfb\u6570\u51cf\u84dd\u8272\u7cfb\u6570\u3002\u53c8\u4e0d\u96be\u53d1\u73b0\uff0c\u5de6\u8fb9\u7684\u4e09\u89d2\u5f62\u8f6e\u5ed3\u7684\u5dee\u90fd\u662f$-1$\uff0c\u53f3\u8fb9\u4e00\u5217\u7684\u5dee\u90fd\u662f$1$\u3002\u8fd9\u4e2a\u8f6e\u5ed3\u7684\u548c\u548c\u5217\u7684\u548c\u53ef\u4ee5\u7ef4\u62a4\u5217\u524d\u7f00\u548c$Sum1$\u3001\u526f\u5bf9\u89d2\u7ebf\u524d\u7f00\u548c$Sum2$\uff08\u5728\u540c\u4e00\u6761\u526f\u5bf9\u89d2\u7ebf\u4e0a\u5f53\u4e14\u4ec5\u5f53\u884c\u5217\u548c\u76f8\u7b49\uff09\u3001\u4e3b\u5bf9\u89d2\u7ebf\u524d\u7f00\u548c$Sum3$\uff08\u5728\u540c\u4e00\u6761\u4e3b\u5bf9\u89d2\u7ebf\u4e0a\u5f53\u4e14\u4ec5\u5f53\u884c\u5217\u5dee\u76f8\u7b49\uff09\u641e\u5b9a\u3002\u4e8e\u662f\u5c31\u6709\u4e86\u4e00\u4e2a$trl_{i,j},trl_{i,j-1}$\u7684\u5173\u7cfb\u5f0f\u3002\u90a3\u4e48\u53ef\u4ee5$\\forall i\\in[s,n-s+1]$\uff0c\u66b4\u529b\u7528\u5217\u524d\u7f00\u548c$\\mathrm O(s)$\u6c42\u51fa$trl_{i,s}$\uff0c\u7136\u540e$\\forall i\\in[s,n-s+1],\\forall j\\in(s,m]$\uff0c\u7528\u5173\u7cfb\u5f0f\u9012\u63a8\u6c42\u51fa$trl_{i,j}$\uff0c\u603b\u590d\u6742\u5ea6\u4e3a$\\mathrm O(nm)$\u3002$trr$\u6c42\u6cd5\u7c7b\u4f3c\u3002\n\n$\\mathrm O(nm)$\u4e0e\u5904\u7406\u5b8c$3$\u4e2a\u524d\u7f00\u548c\uff0c$trl,trr$\u5c31\u53ef\u4ee5$\\mathrm O(nm)$\u6c42\u51fa\u6765\u4e86\uff0c\u90a3\u4e48$f$\u4e5f\u53ef\u4ee5$\\mathrm O(nm)$\u6c42\u51fa\u6765\u4e86\uff0c\u6700\u540e\u627e\u6700\u5927\u503c\u5373\u53ef\u3002\u603b\u590d\u6742\u5ea6$\\mathrm O(nm)$\u3002\n\n\u4e0b\u9762\u8d34\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define mp make_pair\n#define X first\n#define Y second\nconst int N=1000,M=1000;\nint n/*\u77e9\u9635\u884c\u6570*/,m/*\u77e9\u9635\u5217\u6570*/,s/*\u5e38\u6570*/;\nint a[N+1][M+1];//\u77e9\u9635 \nint Sum1[M+1][N+1]/*\u5217\u524d\u7f00\u548c*/,Sum2[N+M+1][M+1]/*\u526f\u5bf9\u89d2\u7ebf\u524d\u7f00\u548c*/,Sum3[2*N+1][M+1]/*\u4e3b\u5bf9\u89d2\u7ebf\u524d\u7f00\u548c\uff0c\u7531\u4e8e\u884c\u5217\u5dee\u53ef\u80fd\u662f\u8d1f\u6570\uff0c\u6240\u4ee5\u5e73\u79fbmax(n,m)\u4e2a\u5355\u4f4d*/;\nint sum1(int x,int l,int r){return l>r?0:Sum1[x][r]-Sum1[x][l-1];}//\u5217\u533a\u95f4\u548c \nint sum2(int x,int l,int r){return l>r?0:Sum2[x][r]-Sum2[x][l-1];}//\u526f\u5bf9\u89d2\u7ebf\u533a\u95f4\u548c \nint sum3(int x,int l,int r){return l>r?0:Sum3[x+max(n,m)][r]-Sum3[x+max(n,m)][l-1];}//\u4e3b\u5bf9\u89d2\u7ebf\u533a\u95f4\u548c \nint trl[N+1][M+1],trr[N+1][M+1];//\u671d\u5de6\u3001\u671d\u53f3\u4e09\u89d2\u5f62 \nint rhm[N+1][M+1];//\u6b63\u65b9\u5f62\uff0c\u5373f\u51fd\u6570 \nsigned main(){\n\tcin>>n>>m>>s;\n\tfor(int i=1;i<=n;i++)for(int j=1;j<=m;j++)scanf(\"%lld\",a[i]+j);\n\t//\u9884\u5904\u7406\u524d\u7f00\u548c\u5f00\u59cb \n\tfor(int i=1;i<=m;i++)for(int j=1;j<=n;j++)Sum1[i][j]=Sum1[i][j-1]+a[j][i];\n\tfor(int i=1;i<=n+m;i++)for(int j=1;j<=n;j++)Sum2[i][j]=Sum2[i][j-1]+(1<=i-j&&i-j<=m?a[j][i-j]:0);\n\tfor(int i=-max(n,m);i<=max(n,m);i++)for(int j=1;j<=n;j++)Sum3[i+max(n,m)][j]=Sum3[i+max(n,m)][j-1]+(1<=j+i&&j+i<=m?a[j][j+i]:0);\n\t//\u9884\u5904\u7406\u524d\u7f00\u548c\u7ed3\u675f \n\tfor(int i=s;i<=n-s+1;i++){//\u7b97trl \n\t\tfor(int j=1;j<=s;j++)trl[i][s]+=sum1(j,i-j+1,i+j-1);//\u66b4\u529b\u7b97\u8fb9\u4e0a\u7684trl \n\t\tfor(int j=s+1;j<=m;j++)trl[i][j]=trl[i][j-1]+sum1(j,i-s+1,i+s-1)-sum2(i+j-s,i-s+1,i)-sum3(j-s-i,i+1,i+s-1);//\u7528\u5173\u7cfb\u5f0f\u9012\u63a8\u5176\u4ed6trl \n\t}\n\tfor(int i=s;i<=n-s+1;i++){//\u7b97trr\uff0c\u4e0etrl\u7c7b\u4f3c \n\t\tfor(int j=m;j>=m-s+1;j--)trr[i][m-s+1]+=sum1(j,i-(m-j+1)+1,i+(m-j+1)-1); \n\t\tfor(int j=m-s;j;j--)trr[i][j]=trr[i][j+1]+sum1(j,i-s+1,i+s-1)-sum3(j+s-i,i-s+1,i)-sum2(i+j+s,i+1,i+s-1);\n\t}\n//\tfor(int i=1;i<=n;i++)for(int j=1;j<=m;j++)printf(\"tr(%lld,%lld)=(%lld,%lld)\\n\",i,j,trl[i][j],trr[i][j]);\n\tfor(int i=s;i<=n-s+1;i++){//\u7b97rhm \n\t\tfor(int j=0;j<s;j++)rhm[i][s]+=(s-j)*(sum2(i-j+s,i-j,i)+sum3(s-(i+j),i+1,i+j)+sum2(i+j+s,i,i+j-1)+sum3(s-(i-j),i-j+1,i-1));//\u66b4\u529b\u7b97\u8fb9\u4e0a\u7684rhm \n\t\tfor(int j=s+1;j<=m-s+1;j++)rhm[i][j]=rhm[i][j-1]+trr[i][j]-trl[i][j-1];//\u7528\u5173\u7cfb\u5f0f\u9012\u63a8\u5176\u4ed6rhm \n\t}\n//\tfor(int i=s;i<=n-s+1;i++)for(int j=s;j<=m-s+1;j++)printf(\"rhm[%lld][%lld]=%lld\\n\",i,j,rhm[i][j]);\n\tpair<int,pair<int,int> > mx(0,mp(0,0)); \n\tfor(int i=s;i<=n-s+1;i++)for(int j=s;j<=m-s+1;j++)mx=max(mx,mp(rhm[i][j],mp(i,j)));//\u627e\u6700\u5927\u503c \n\tcout<<mx.Y.X<<\" \"<<mx.Y.Y;\n\treturn 0;\n}\n```",
        "postTime": 1579402328,
        "uid": 138400,
        "name": "chenxia25",
        "ccfLevel": 9,
        "title": "CodeForces 263E - Rhombus"
    },
    {
        "content": "idea \u662f\u5077\u7f51\u4e0a\u7684\uff0c\u90a3\u5c31\u7b97\u4e00\u4e0b\u590d\u6742\u5ea6\u5427\u3002\n\n\u8003\u8651\u8f6c\u6210\u5207\u6bd4\u96ea\u592b\uff0c\u90a3\u4e48\u8981\u52a0\u7684\u533a\u57df\u5c31\u628a\u4e00\u4e2a\u659c 45 \u6b63\u65b9\u5f62\u8f6c\u6210\u4e86\u4e00\u4e2a\u6b63\u65b9\u5f62\uff08$dis(a,b)=\\max\\{|x_a-x_b|,|y_a-y_b|\\}$ \u7ed3\u8bba\u663e\u7136\uff09\uff0c\u90a3\u8fd9\u6837\u5c31\u53ef\u4ee5\u4e8c\u7ef4\u524d\u7f00\u548c\u76f4\u63a5\u505a\u4e86\uff0c\u6b63\u65b9\u5f62\u5185\u7684\u7cfb\u6570\u8fd8\u662f\u4e00\u5c42\u4e00\u5c42\u9012\u51cf\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u679a\u4e3e\u70b9\u5750\u6807\u548c\u5f53\u524d\u8ba1\u7b97\u8d21\u732e\u7684\u5c42\u6570 $i\\in [k,n-k+1],j\\in[k,m-k+1],z\\in[0,k-1]$ \u7206\u7b97\u5c31\u884c\u4e86\u3002\n\n\u7b97\u4e00\u4e0b\u590d\u6742\u5ea6\uff1a$O(i\\cdot j\\cdot z)=O((n-2k)(m-2k)k)$\uff0c\u663e\u7136 $n=m=1000$ \u65f6\u53d6\u7684\u6700\u5927\uff0c\u8fd9\u65f6\u5019\u5c31\u662f $10^6k-4000k^2+4k^3,k\\le500$\uff0c\u6c42\u5bfc\u4e00\u4e0b\u53ef\u77e5\u6700\u5927\u503c\u4e3a $74074074.41591052711$\uff0c\u7efc\u4e0a\u80fd\u8fc7\u3002\n\n\u80fd\u61c2\u8fd9\u4e2a\u6b63\u65b9\u5f62\u957f\u4ec0\u4e48\u6837\u5427\uff0c\u80fd\u61c2\u5427\u80fd\u61c2\u5427\u3002\u6765\u5f20\u56fe\uff0c\u8fd9\u80fd\u7406\u89e3\u4e86\u5427\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/fzwmr8w9.png)\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int _=2005;\nint n,m,k;\nlong long b[_][_],maxn;\nint main(){\n    ios::sync_with_stdio(0); cin.tie(0);\n    cin>>n>>m>>k;\n    pair<int,int> ans={k,k};\n    for(int i=1;i<=n;++i)\n        for(int j=1;j<=m;++j)\n            cin>>b[i+j][i-j+m];//+m\u662f\u56e0\u4e3a\u6709\u8d1f\u6570\n    for(int i=1;i<=n+m;++i)\n        for(int j=1;j<=n+m;++j)\n            b[i][j]+=b[i-1][j]+b[i][j-1]-b[i-1][j-1];\n    for(int i=k;i<=n-k+1;++i){\n        for(int j=k;j<=m-k+1;++j){\n            int x=i+j,y=i-j+m;\n            long long sum=0;\n            for(int z=0;z<k;++z) sum+=b[x+z][y+z]-b[x-z-1][y+z]-b[x+z][y-z-1]+b[x-z-1][y-z-1];//\u7406\u89e3\u6210\u4e00\u5708\u4e00\u5708\u52a0\n            if(maxn<sum) ans={i,j},maxn=sum;\n        }\n    }\n    cout<<ans.first<<\" \"<<ans.second;\n    return 0;\n}\n//O(74074074.41591052711)\n```",
        "postTime": 1658391606,
        "uid": 186045,
        "name": "itisover",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF263E Rhombus"
    }
]
[
    {
        "content": "\u5f88\u5bb9\u6613\u60f3\u51fa\u4e00\u4e2a $O(n^2k)$ \u7684 dp\u3002$f_{i, j}$ \u8868\u793a $i$ \u4e2a\u6570\u5206\u6210 $j$ \u7ec4\u7684\u6700\u5927\u4ef7\u503c\u3002\n\n$$\nf_{i,j} = \\max\\{f_{k,j-1} + sum_i - sum_k\\}\n$$\n\n\u89c2\u5bdf\u4e00\u4e0b\u6570\u636e\u8303\u56f4\u53ef\u4ee5\u53d1\u73b0 $p$ \u5f88\u5c0f\uff0c\u6240\u4ee5 $sum_k$ \u7684\u53d6\u503c\u662f\u5f88\u5c11\u7684\uff0c\u90a3\u4e48\u6362\u4e00\u79cd\u601d\u8def\uff0c\u522b\u679a\u4e3e $k$ \u4ee5\u53d6 $f_{k, j-1}$ \u4e86\uff0c\u6bd5\u7adf $sum_k$ \u548c $f_{k, j-1}$ \u662f\u76f8\u5bf9\u5e94\u7684\u3002\u53ea\u9700\u679a\u4e3e $sum_k$ \u7684\u503c\uff0c\u628a $sum_k$ \u5bf9\u5e94\u7684\u6700\u5927\u7684 $f_{k, j-1}$ \u62ff\u6765\u8f6c\u79fb\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(nkp)$\u3002\n\n```cpp\n#include <cstdio>\n#include <algorithm>\nconst int N = 20005, M = 55, INF = 0x3f3f3f3f;\nint n, K, p, sum[N], f[M][N], t[105];\nint main() {\n\tscanf(\"%d%d%d\", &n, &K, &p);\n\tfor (int i = 1; i <= n; i++) \n\t\tscanf(\"%d\", &sum[i]), \n\t\tsum[i] = (sum[i] + sum[i-1]) % p;\n\tfor (int i = 1; i <= n; i++) f[0][i] = -INF;\n\tfor (int i = 1; i <= K; i++) {\n\t\tfor (int j = 0; j < p; j++) t[j] = -INF;\n\t\tif (i == 1) t[0] = 0; \n\t\tfor (int j = 1; j <= n; j++) {\n\t\t\tf[i][j] = -INF;\n\t\t\tfor (int k = 0; k < p; k++)\n\t\t\t\tf[i][j] = std::max(f[i][j], t[k] + (sum[j] - k + p) % p);\n\t\t\tt[sum[j]] = std::max(t[sum[j]], f[i-1][j]);\n\t\t}\n\t}\n\tprintf(\"%d\", f[K][n]);\n\treturn 0;\n}\n```",
        "postTime": 1625106017,
        "uid": 40318,
        "name": "Acfboy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF958C2 Encryption (medium)"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF958C2)\n\n$\\verb!CF!$ \u7684\u673a\u5b50\u597d\u5feb\uff0c\u5c45\u7136\u8ba9\u6211\u7684\u66b4\u529b\u8fc7\u6389\u4e86\u3002\n## \u601d\u8def\n\u663e\u7136\u6211\u4eec\u6709\u4e00\u4e2a $\\verb!DP!$ \u7684\u601d\u8def\uff0c\u8bbe $f_{i,j}$ \u8868\u793a\u524d $i$ \u4e2a\u6570\uff0c\u5206\u6210 $j$ \u6bb5\u7684\u6700\u5927\u4ef7\u503c\uff0c\u7136\u540e\u8f6c\u79fb\u5c31\u662f $f_{i,j}=\\max{f_{k,j-1}+\\sum_{l=k+1}^n a_l}$\uff0c\u540e\u9762\u7684 $\\sum$ \u53ef\u4ee5\u524d\u7f00\u548c\u4f18\u5316\u6389\uff0c\u4f46\u662f\u524d\u9762\u7684\u9700\u8981\u679a\u4e3e\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2k)$\u3002\n\n\u4f46\u662f\uff0c\u8fd9\u4e2a\u679a\u4e3e\u53ef\u4ee5\u52a0\u4e00\u4e2a\u5c0f\u4f18\u5316\uff0c\u56e0\u4e3a $f_{i,j}$ \u7684\u72b6\u6001\u5168\u90fd\u662f\u4ece $f_{k,j-1}$ \u8f6c\u79fb\u8fc7\u6765\u7684\uff0c\u65e2\u7136\u5b83\u4eec\u5206\u7684\u6bb5\u6570\u76f8\u540c\uff0c\u6240\u4ee5 $f$ \u6570\u7ec4\u5fc5\u7136\u662f\u5355\u8c03\u4e0d\u964d\u7684\uff0c\u5f53\u6211\u4eec\u679a\u4e3e\u5230\u4e00\u4e2a $k$\uff0c\u53d1\u73b0 $f_{k,j-1}+p-1 \\le f_{i,j}$ \u65f6\uff0c\u6211\u4eec\u5df2\u7ecf\u4e0d\u9700\u8981\u5f80\u4e0b\u679a\u4e3e\u4e86\u3002\n\n\u52a0\u4e0a\u8fd9\u4e2a\u4f18\u5316\u540e\u66b4\u529b\u8dd1\u7684\u98de\u5feb\uff0c\u6700\u6162\u7684\u70b9\u53ea\u9700\u8981 $\\verb!93ms!$\u3002\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nint const N=2e4+10;\nint const M=50+5;\nint f[N][M],sum[N],a[N];\nsigned main(){\n\tios::sync_with_stdio(false);\n\tcin.tie(0),cout.tie(0);\n\tint n,k,p;cin>>n>>k>>p;\n\tfor (int i=1;i<=n;++i) cin>>a[i],sum[i]=sum[i-1]+a[i];\n\tfor (int i=1;i<=n;++i){\n\t    f[i][1]=sum[i]%p;\n\t    for (int j=2;j<=min(i,k);++j)\n\t\t\tfor (int k=i-1;k>=1;--k){\n\t\t\t    if (f[k][j-1]+p-1<=f[i][j]) break;//\u526a\u679d\n\t            f[i][j]=max(f[i][j],f[k][j-1]+(sum[i]-sum[k])%p);\n\t\t\t}\n\t}\n\tcout<<f[n][k]<<'\\n';\n\treturn 0;\n}\n```\n",
        "postTime": 1662510328,
        "uid": 253608,
        "name": "Tx_Lcy",
        "ccfLevel": 7,
        "title": "CF958C2 Encryption (medium)"
    },
    {
        "content": "# \u9898\u76ee\u5927\u610f\n\n\u6709\u4e00\u4e2a\u5305\u542b $n$ \u4e2a\u6b63\u6574\u6570\u7684\u6570\u5217\uff0c\u5c06\u8fd9\u4e2a\u6570\u5217\u5206\u6210 $m$ \u4e2a\u975e\u7a7a\u6bb5\uff0c\u6bcf\u6bb5\u7684\u4ef7\u503c\u4e3a\u8fd9\u6bb5\u7684\u6240\u6709\u6570\u603b\u548c $\\bmod~p$\uff0c\u4f60\u9700\u8981\u4f7f $k$ \u6bb5\u4ef7\u503c\u603b\u548c\u6700\u5927\uff0c\u8bf7\u6c42\u51fa\u8fd9\u4e2a\u6700\u5927\u503c\u3002\n\n# \u9898\u76ee\u5206\u6790\n\n\u5148\u6709 $\\mathcal{O(n^2m)}$ \u505a\u6cd5\uff1a\n\n\u4ee4 $dp[i][j]$ \u8868\u793a\u524d $i$ \u4e2a\u6570\u5206 $j$ \u7ec4\u7684\u6700\u5927\u503c\u3002\n\n\u6709 $dp[i][j]=\\max\\{dp[k][j-1]+(sum[i]-sum[k])\\bmod p\\}$\u3002\n\n-----\n\n\u8003\u8651\u600e\u4e48\u4f18\u5316\uff0c\u6ce8\u610f\u5230\u6211\u4eec $dp[i][j]$ \u7684\u6700\u5927\u503c\u7684\u6c42\u89e3\u662f\u4ece $\\max\\{dp[k][j-1]\\}$ \u91cc\u6765\u7684\uff0c\u4f46\u662f\u5355\u7eaf\u8bb0\u5f55\u6700\u5927\u503c\u8fd8\u4e0d\u884c\uff0c\u6211\u4eec\u8fd8\u8981\u8bb0\u5f55\u4f4d\u7f6e\uff08$sum[k]$\uff09\uff0c\u7136\u540e\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u6b63\u786e\u6027\u8bc1\u660e\uff1a\n\n\u9996\u5148 $sum$ \u6570\u7ec4\u4e00\u5b9a\u4e25\u683c\u5355\u8c03\u9012\u589e\uff0c\u56e0\u4e3a $\\forall i\\in [1,n],a[i]\\in[1,10^6]$\u3002\u5176\u6b21\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0 $dp[i][j]\\equiv sum[i](\\bmod p)$\uff0c\u56e0\u4e3a $(a+b)\\bmod p=a\\bmod p+b\\bmod p$\u3002\n\n\u6240\u4ee5\u627e\u5230\u4e24\u4e2a $x,y$\uff0c\u6211\u4eec\u8981\u505a\u7684\u5176\u5b9e\u5c31\u662f\u6c42\u51fa $dp[x][j-1],dp[y][j-1]$ \u7684\u6700\u5927\u503c\uff0c\u8bbe $w[x]=(sum[i]-sum[x])\\bmod p,w[y]=(sum[i]-sum[y])\\bmod p$\u3002\n\n\u53c8\u56e0\u4e3a $dp[i][j]\\equiv dp[i][j](\\bmod p)$\uff0c\n\n\u6545 $dp[x][j-1]+w[x]\\equiv dp[y][j-1]+w[y](\\bmod p)$\u3002\n\n\u4e0d\u59a8\u8bbe $dp[x][j-1]\\lt dp[y][j-1]$\uff0c\u56e0\u4e3a $w[x],w[y]\\lt p$\uff0c\u6240\u4ee5 $dp[x][j-1]+w[x]\\lt dp[y][j-1]+w[y]$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u6709\u4e86\u601d\u8def\uff1a\u5bf9\u4e8e\u6bcf\u4e2a $j$\uff0c\u8bb0\u5f55\u6700\u5927\u7684 $dp[k][j]$ \u7684\u4f4d\u7f6e $k$\uff0c\u8f6c\u79fb\u65f6\u5c31\u80fd $\\mathcal{O(1)}$ \u8f6c\u79fb\u4e86\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O(nm)}$\u3002\n\n# \u4ee3\u7801\n\n```cpp\n// Problem: CF958C2 Encryption (medium)\n// Contest: Luogu\n// URL: https://www.luogu.com.cn/problem/CF958C2\n// Memory Limit: 500 MB\n// Time Limit: 3000 ms\n// Date:2022-05-21 15:33\n// \n// Powered by CP Editor (https://cpeditor.org)\n\n#include <iostream>\n#include <cstdio>\n#include <climits>//need \"INT_MAX\",\"INT_MIN\"\n#include <cstring>//need \"memset\"\n#include <numeric>\n#include <algorithm>\n#define enter putchar(10)\n#define debug(c,que) std::cerr << #c << \" = \" << c << que\n#define cek(c) puts(c)\n#define blow(arr,st,ed,w) for(register int i = (st);i <= (ed); ++ i) std::cout << arr[i] << w;\n#define speed_up() std::ios::sync_with_stdio(false),std::cin.tie(0),std::cout.tie(0)\n#define mst(a,k) memset(a,k,sizeof(a))\n#define stop return(0)\nconst int mod = 1e9 + 7;\ninline int MOD(int x) {\n\tif(x < 0) x += mod;\n\treturn x % mod;\n}\nnamespace Newstd {\n\tinline int read() {\n\t\tint ret = 0,f = 0;char ch = getchar();\n\t\twhile (!isdigit(ch)) {\n\t\t\tif(ch == '-') f = 1;\n\t\t\tch = getchar();\n\t\t}\n\t\twhile (isdigit(ch)) {\n\t\t\tret = (ret << 3) + (ret << 1) + ch - 48;\n\t\t\tch = getchar();\n\t\t}\n\t\treturn f ? -ret : ret;\n\t}\n\tinline void write(int x) {\n\t\tif(x < 0) {\n\t\t\tputchar('-');\n\t\t\tx = -x;\n\t\t}\n\t\tif(x > 9) write(x / 10);\n\t\tputchar(x % 10 + '0');\n\t}\n}\nusing namespace Newstd;\n\nconst int N = 2e4 + 5,M = 55;\nstruct Rem {\n\tint Max,pos;\n} ;\nint a[N],sum[N],dp[N][M],g[2][M];\n//dp[i][j]:\u524d i \u4e2a\u6570\u5206\u6210 j \u7ec4\u7684\u6700\u5927\u548c\nint n,m,p;\nint main(void) {\n\tn = read(),m = read(),p = read();\n\tfor (register int i = 1;i <= n; ++ i) {\n\t\ta[i] = read();\n\t\tsum[i] = (sum[i - 1] + a[i]) % p;\n\t}\n\tfor (register int i = 1;i <= n; ++ i) dp[i][1] = sum[i];\n\tfor (register int i = 1;i <= n; ++ i) {\n\t\tfor (register int j = 2;j <= m; ++ j) {\n\t\t\tdp[i][j] = std::max(dp[i][j],dp[g[i & 1 ^ 1][j - 1]][j - 1] + ((sum[i] - sum[g[i & 1 ^ 1][j - 1]]) % p + p) % p);\n\t\t}\n\t\tfor (register int j = 0;j <= m; ++ j) {\n\t\t\tg[i & 1][j] = g[i & 1 ^ 1][j];\n\t\t\tif (dp[i][j] > dp[g[i & 1][j]][j]) {\n\t\t\t\tg[i & 1][j] = i;\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",dp[n][m]);\n\t\n\treturn 0;\n}\n```",
        "postTime": 1653124016,
        "uid": 430409,
        "name": "Coros_Trusds",
        "ccfLevel": 6,
        "title": "CF958C2 Encryption (medium)"
    }
]
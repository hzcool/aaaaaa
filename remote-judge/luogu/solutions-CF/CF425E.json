[
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF425E)\n\n\u76f4\u63a5\u8ba1\u6570\uff01\n\n\u8003\u8651\u5982\u679c\u5df2\u77e5\u7ebf\u6bb5\u60c5\u51b5\uff0c\u662f\u4e00\u4e2a\u7ecf\u5178\u8d2a\u5fc3\uff0c\u6bcf\u6b21\u9009\u5f53\u524d\u53f3\u7aef\u70b9\u6700\u5c0f\u7684\u7ebf\u6bb5\u5373\u53ef\u3002\n\n\u7136\u540e\u8bbe $dp_{i,j}$ \u8868\u793a\u5f53\u524d\u53f3\u7aef\u70b9\u4e3a $i$\uff0c\u5df2\u7ecf\u9009\u4e86 $j$ \u6761\u7ebf\u6bb5\u7684\u65b9\u6848\u6570\uff0c\u679a\u4e3e\u4e0b\u4e00\u4e2a\u53f3\u7aef\u70b9 $k$ \u8fdb\u884c\u8f6c\u79fb\u3002\n\n\u8ba1\u6570\u601d\u8def\u80af\u5b9a\u662f\u786e\u5b9a\u80fd\u653e\u7684\u7ebf\u6bb5\uff0c\u7136\u540e\u627e\u53ef\u653e\u53ef\u4e0d\u653e\u7684\u7ebf\u6bb5\u6709\u591a\u5c11\u3002\n\n\u90a3\u4e48\u8003\u8651\u4e00\u6761\u7ebf\u6bb5 $[l,r]$\uff0c\u53ea\u9700\u8981\u8003\u8651 $l>i$ \u7684\u60c5\u51b5\u3002\u90a3\u4e48\u5bf9\u4e8e $i<l \\le r=k$ \u7684\u7ebf\u6bb5\uff0c\u8fd9\u79cd\u7ebf\u6bb5\u6709 $k-i$ \u6761\uff0c\u81f3\u5c11\u8981\u9009\u62e9\u5176\u4e2d\u4e00\u6761\uff0c\u6240\u4ee5\u65b9\u6848\u6570\u662f $2^{k-i}-1$\u3002\n\n\u5bf9\u4e8e $i<l \\le r <k$ \u7684\u7ebf\u6bb5\uff0c\u90fd\u4e0d\u80fd\u9009\u3002\n\n\u5bf9\u4e8e $i<l \\le k < r$ \u7684\u7ebf\u6bb5\uff0c\u4e0d\u5f71\u54cd\u5f53\u524d\u72b6\u6001\uff0c\u53ef\u9009\u53ef\u4e0d\u9009\uff0c\u6240\u4ee5\u65b9\u6848\u6570\u662f $ 2^{(n-k)(k-i)}$\u3002\n\n\u6240\u4ee5\u8f6c\u79fb\u5c31\u662f\u628a\u8fd9\u4e9b\u65b9\u6848\u6570\u90fd\u4e58\u8d77\u6765\uff0c\u5373 $dp_{k,j+1}=dp_{i,j}\\times (2^{k-i}-1)\\times 2^{(n-k)(k-i)}$\u3002\n\n\u521d\u59cb\u6001 $dp_{0,0}=1$\uff0c\u6ce8\u610f\u8981\u4ece $i=0,j=0$ \u5f00\u59cb\u8f6c\u79fb\u3002\n\n\u9884\u5904\u7406 $2$ \u7684\u5e42\u53ef\u4ee5\u7701\u6389\u4e00\u4e2a $\\log$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3)$\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#include<iostream>\n#define ll long long\n#define back return \n#define ri register int\nusing namespace std;\nll read()\n{\n\tll x=0,f=1;\n\tchar ch=getchar();\n\twhile(ch<'0'||ch>'9')\n\t{\n\t\tif(ch=='-')\n\t\t\tf=-1;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9')\n\t{\n\t\tx=x*10+ch-'0';\n\t\tch=getchar();\n\t}\n\tback x*f;\n}\nconst int mod=1e9+7;\nll n,m,ans,dp[1005][1005],f[500005];\nint main()\n{\n\tn=read(),m=read();\n\tf[0]=1,dp[0][0]=1;\n\tfor(ri i=1;i<=n*n;i++)\n\t\tf[i]=f[i-1]*2%mod;\n\tfor(ri i=0;i<=n;i++)\n\t\tfor(ri j=0;j<=i;j++)\n\t\t\tfor(ri k=i+1;k<=n;k++)\n\t\t\t\tdp[k][j+1]=(dp[k][j+1]+dp[i][j]*(f[k-i]-1+mod)%mod*f[(n-k)*(k-i)]%mod)%mod;\n\tfor(ri i=m;i<=n;i++)\n\t\tans=(ans+dp[i][m])%mod;\n\tcout<<ans<<\"\\n\";\n    back 0;\n}\n```\n",
        "postTime": 1666927399,
        "uid": 93266,
        "name": "\u65ad\u6e05\u79cb",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011CF425E Sereja and Sets"
    },
    {
        "content": "\u4ee4 $dp_{i, j}$ \u8868\u793a $f(i)=j$ \u7684\u65b9\u6848\u6570\u3002\n\n\u6709\u8f6c\u79fb\u65b9\u7a0b $dp_{i, j}\\gets dp_{i,j}+dp_{k, j - 1}\\times(2^{i - k}-1)\\times2^{(i - k) \\times k}$\n\n\u663e\u7136\uff0c\u5bf9\u4e8e\u589e\u52a0\u4e00\u4e2a\u53ef\u9009\u7684\u533a\u95f4\uff0c\u6211\u4eec\u53ef\u4ee5\u9009\u62e9 $[k+1, k+1],[k+1, k+2]\\cdots [k+1, i]$ \u8fd9\u4e9b\u533a\u95f4\u7684\u4efb\u610f\u591a\u4e2a\u3002\u56e0\u4e3a\u4e0d\u7ba1\u9009\u51e0\u4e2a\uff0c\u9009\u7684\u533a\u95f4\u80af\u5b9a\u662f\u4e24\u4e24\u6709\u4ea4\u96c6\u7684\u3002\u6240\u4ee5\u6700\u591a\u80af\u5b9a\u53ea\u80fd\u9009\u4e00\u4e2a\uff0c\u6ce8\u610f\u8981\u51cf\u6389\u7a7a\u96c6\u3002\n\n\u6211\u4eec\u8fd8\u8981\u8ba1\u7b97\u53ef\u4ee5\u591a\u51fa\u7684\u91cd\u53e0\u533a\u95f4\u3002\u5de6\u7aef\u70b9\u53ef\u4ee5\u843d\u5728 $[1, k]$\uff0c\u53f3\u7aef\u70b9\u53ef\u4ee5\u843d\u5728 $[k+1, i]$\u3002\u4e00\u5171\u6709 $(i-k)\\times k$ \u4e2a\u533a\u95f4\uff0c\u800c\u4e14\u4fdd\u8bc1\u8fd9\u4e9b\u533a\u95f4\u4e0e\u4e4b\u524d\u9009\u7684\u533a\u95f4\u5fc5\u6709\u91cd\u590d\u56e0\u4e3a\u90fd\u5305\u542b $k+1$\uff0c\u4efb\u9009\u82e5\u5e72\u4e2a\u5373\u53ef\u3002\n\n\u521d\u59cb\u5316 $dp_{i, 0}=1$\uff0c\u4e0d\u89e3\u91ca\u3002\n\n\u4e3b\u8981\u4ee3\u7801\uff1a\n\n```cpp\nfor (int i = 1; i <= n; i ++)\nfor (int j = 1; j <= i; j ++)\nfor (int k = j - 1; k <= i; k ++)\n\t(dp[i][j] += dp[k][j - 1] * (pw[i - k] - 1) % P * pw[(i - k) * k] % P) %= P;\n```",
        "postTime": 1661077082,
        "uid": 224663,
        "name": "AcO2d",
        "ccfLevel": 0,
        "title": "CF425E Sereja and Sets \u9898\u89e3"
    }
]
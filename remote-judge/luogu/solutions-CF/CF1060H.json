[
    {
        "content": "[\u81ea\u5df1\u535a\u5ba2\u7684\u5e7f\u544a](https://wallbreaker5th.github.io/2018/%E9%A2%98%E8%A7%A3-CF1060H-Sophisticated%20Device/)\uff0c\u82e5\u4ee5\u540e\u6709\u4fee\u6539\u591a\u534a\u53ea\u5199\u5728\u81ea\u5df1\u535a\u5ba2\u4e2d\u3002\n\n[\u9898\u76ee\u94fe\u63a5](https://www.luogu.org/problemnew/show/CF1060H)\n\n\u8fd9\u9053\u9898\u5b9e\u5728\u662f\u6bd2\u7624\u3002~~\u4ee5\u53ca\u6d1b\u8c37\u4e0a\u7684\u7ffb\u8bd1\u5176\u5b9e\u662f\u6211\u7ffb\u7684\uff0c\u8d28\u91cf\u8ddf\u673a\u7ffb\u5dee\u4e0d\u591a\u3002~~\n\n\u9996\u5148\u6211\u4eec\u786e\u5b9a\u6c42\u51fa $xy$ \u7684\u6574\u4f53\u601d\u8def\u2014\u2014$xy=\\frac{(x+y)^2-x^2-y^2}{2}$\u3002\n\n\u8fd9\u4e2a\u601d\u8def\u4e0d\u96be\u60f3\u5230\uff1a\u6211\u4eec\u80fd\u591f\u6bd4\u8f83\u5bb9\u6613\u5b9e\u73b0\u7684\u4e24\u4e2a\u64cd\u4f5c\u6570\u7684\u8fd0\u7b97\u53ea\u6709\u52a0\u3001\u51cf\uff0c\u4e8e\u662f\u6211\u4eec\u5c06\u8fd0\u7b97\u8f6c\u6362\u4e3a\u52a0\u3001\u51cf\u4e0e\u53ea\u6709\u4e00\u4e2a\u64cd\u4f5c\u6570\u7684\u5e73\u65b9\u3001\u9664\u4ee5 2\u3002\u5173\u952e\u5728\u4e8e\u5982\u4f55\u5b9e\u73b0\u8fd9\u4e9b\u8fd0\u7b97\u3002\n\n### \u524d\u7f6e\u6280\u80fd\n\n- \u5feb\u901f\u5e42/\u4e58\n\n- \u9ad8\u65af\u6d88\u5143\n\n- exgcd \u6c42\u4e58\u6cd5\u9006\u5143\n\n- \u5c11\u91cf\u6570\u5b66\u77e5\u8bc6\n\n- \u5927\u91cf\u8010\u5fc3\n\n\u6211\u4eec\u5148\u8003\u8651\u51e0\u4e2a\u7b80\u5355\u7684\u8fd0\u7b97\uff1a\n\n## 0\n\n\u5728\u6c42\u89e3\u8fc7\u7a0b\u4e2d\uff0c\u6709\u4e00\u4e2a\u6570\u5b57 0 \u662f\u5f88\u65b9\u4fbf\u7684\uff0c\u5229\u7528 `+ zero zero x` \u5c31\u53ef\u4ee5\u6e05\u7a7a\u4e00\u683c\u3002\n\n\u5728\u8fd9\u91cc\u9700\u8981\u7528\u5230\u5feb\uff08\u6162\uff1f\uff09\u901f\u4e58\uff0c\u5b9e\u73b0\uff1a\n\n```cpp\nint f=p-1;\nwhile(f){\n    if(f&1ll){\n        cout<<\"+ \"<<4998<<\" \"<<zero<<\" \"<<zero<<endl;\n    }\n    cout<<\"+ \"<<4998<<\" \"<<4998<<\" \"<<4998<<endl;\n    f/=2;\n}\n//zero=4999\n```\n\n\u8fd9\u6837 `zero` \u683c\u5c31\u6709\u4e86\u4e00\u4e2a\u5e38\u6570 0\u3002\n\n## \u4e58\u4ee5\u5e38\u6570\n\n\u540c\u6837\u662f\u5feb\u901f\u4e58\u3002\u8981\u6ce8\u610f\u7684\u662f\uff0c**\u6bcf\u6b21\u5fc5\u987b\u6e05\u7a7a\u6240\u9700\u683c\u5b50**\u3002\n\n```cpp\nint getmulti(int a,int b,int q){\n    b=(b%p+p)%p;\n    int ans=(q?q:++tot);\n    int x=++tot;\n    while(b){\n        if(b&1ll){\n            cout<<\"+ \"<<x<<\" \"<<ans<<\" \"<<ans<<endl;\n        }\n        cout<<\"+ \"<<x<<\" \"<<x<<\" \"<<x<<endl;\n        b/=2;\n    }\n    return ans;\n}\n//\u5982\u679c\u6709 q \uff0c\u7b54\u6848\u5b58\u5728 q \u5f53\u4e2d\u3002\u8fd4\u56de\u7ed3\u679c\u6240\u5728\u683c\u5b50\u3002\n```\n\n## \u51cf\u6cd5\n\n$a-b=a+(p-1)b$\n\n```cpp\nint jian(int a,int b){\n    b=getmulti(b,p-1);\n    ++tot;\n    cout<<\"+ \"<<a<<\" \"<<b<<\" \"<<tot<<endl;\n    return tot;\n}\n```\n\n## \u9664\u4ee5\u5e38\u6570\n\n\u5373\u4e58\u4ee5\u5176\u9006\u5143\u3002\n\n---\n\n\u4e0b\u9762\u662f\u91cd\u5934\u620f\uff1a\n\n# \u6c42\u4e00\u4e2a\u6570\u7684\u5e73\u65b9\n\n\u5f88\u660e\u663e\uff0c$x^2$ \u5e76\u4e0d\u80fd\u901a\u8fc7 $x^d$ \u76f4\u63a5\u6c42\u51fa\u3002\n\n\u6211\u4eec\u8003\u8651\u5c06 $x^2$ \u8868\u8fbe\u4e3a $a_0(x+0)^d+a_1(x+1)^d+\\dots +a_d(x+d)^d$\n\n\u5c06\u5b83\u5c55\u5f00\uff0c\u518d\u6309 $x$ \u5408\u5e76\u540c\u7c7b\u9879\uff0c\u5f97\uff1a\n\n$x^2=C_d^0(a_0+a_1+\\dots +a_d)x^d+$\n\n$C_d^1(a_0\\times0^1+a_1\\times1^1+\\dots a_d\\times d^1)x^{d-1}+$\n\n$\\dots$\n\n$C_d^d(a_0\\times0^d+a_1\\times1^d+\\dots +a_d\\times d^d)x^0$\n\n\u663e\u7136\u6211\u4eec\u8981\u6c42 $x^2$ \u9879\u7684\u7cfb\u6570\u4e3a 1\uff0c\u5176\u4f59\u4e3a 0\u3002\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u5217\u51fa\u7ebf\u6027\u65b9\u7a0b\u7ec4\uff0c\u901a\u8fc7\u9ad8\u65af\u6d88\u5143\u6c42\u51fa $a_0,a_1,\\dots ,a_d$\u3002\n\n```cpp\nc[1][1]=1;\nfor(int i=1;i<=d+1;i++){\n    for(int j=1;j<=i;j++){\n        if(i==1&&j==1)continue;\n        c[i][j]=c[i-1][j]+c[i-1][j-1];\n    }\n}\nfor(int i=0;i<=d;i++){\n    int q=1;\n    for(int j=0;j<=d;j++){\n        a[j][i]=c[d+1][j+1]*q%p;\n        q*=i;\n        q%=p;\n    }\n}\na[d-2][d+1]=1;\nfor(int i=0;i<=d;i++){\n    bool ok=false;\n    int j=0;\n    for(;j<=d;j++){\n        if(a[j][i]&&!u[j]){\n            ok=true;\n            u[j]=true;\n            break;\n        }\n    }\n    double orz=a[j][i];\n    for(int k=0;k<=d+1;k++){\n        a[j][k]*=getinv(orz,1,p);\n        a[j][k]%=p;\n    }\n    for(int k=0;k<=d;k++){\n        if(k==j)continue;\n        orz=a[k][i]*=getinv(a[j][i],1,p);\n        for(int l=0;l<=d+1;l++){\n            a[k][l]-=orz*a[j][l];\n            a[k][l]=(a[k][l]%p+p)%p;\n        }\n    }\n}\n```\n\u5b9e\u9645\u6c42\u7684\u65f6\u5019\uff0c\u53ea\u9700\u8981\u7528\u516c\u5f0f $x^2=a_0(x+0)^d+a_1(x+1)^d+\\dots +a_d(x+d)^d$ \u8010\u5fc3\u7b97\u5c31\u53ef\u4ee5\u4e86\u3002\n\n```cpp\nint getpow2(int x){\n    int q=++tot;\n    cout<<\"+ \"<<x<<\" \"<<zero<<\" \"<<q<<endl;\n    int sum=++tot;\n    cout<<\"+ \"<<zero<<\" \"<<zero<<\" \"<<sum<<endl;\n    int po=++tot;\n    int mul=++tot;\n    for(int i=0;i<=d;i++){\n        cout<<\"^ \"<<q<<\" \"<<po<<endl;\n        getmulti(po,a[i][d+1],mul);\n        cout<<\"+ \"<<mul<<\" \"<<sum<<\" \"<<sum<<endl;\n        cout<<\"+ \"<<q<<\" \"<<4997<<\" \"<<q<<endl;\n    }\n    return sum;\n}\n```\n\n\u6700\u540e\u5c31\u5c06\u8fd9\u4e9b simple \u7684\u64cd\u4f5c\u8054\u5408\u8d77\u6765\uff1a\n\n```cpp\nint x2=getpow2(1);\nint y2=getpow2(2);\nint q=jian(xysum2,x2);\njian(q,y2);\nint ans=getmulti(tot,getinv(2,1,p));\ncout<<\"f \"<<ans<<endl;\n```\n\n\u5b8c\u6574\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nint getint(){\n    int ans=0,f=1;\n    char c=getchar();\n    while(c>'9'||c<'0'){\n        if(c=='-')f=-1;\n        c=getchar();\n    }\n    while(c>='0'&&c<='9'){\n        ans=ans*10+c-'0';\n        c=getchar();\n    }\n    return ans*f;\n}\n\nconst int inf=19260817;\nint extgcd(int a,int b,int& x,int& y){\n    if(b){\n        int r=extgcd(b,a%b,y,x);\n        y-=x*(a/b); return r;\n    } else { x=1; y=0; return a; }\n}\nint getinv(int a,int b,int M){\n    int x,y,r=extgcd(a,M,x,y);\n    if(b%r) return -1; else x=(x+M)%M*b/r;\n    return x%(M/r);\n} \n\nint tot=2,zero=4999;\nint d,p;\nint getinv(int x){\n    int inv=getinv(d,p-2,p);\n    ++tot;\n    cout<<\"^ \"<<x<<\" \"<<tot<<endl;\n    for(int i=0;i<inv-1;i++){\n        cout<<\"^ \"<<tot<<\" \"<<tot<<endl;\n    }\n    return tot;\n}\n\nint a[20][20],c[20][20];\n\nint getpow2(int x);\nint getmulti(int a,int b,int q=0);\nint jian(int a,int b);\n\nint getpow2(int x){\n    int q=++tot;\n    cout<<\"+ \"<<x<<\" \"<<zero<<\" \"<<q<<endl;\n    int sum=++tot;\n    cout<<\"+ \"<<zero<<\" \"<<zero<<\" \"<<sum<<endl;\n    int po=++tot;\n    int mul=++tot;\n    for(int i=0;i<=d;i++){\n        cout<<\"^ \"<<q<<\" \"<<po<<endl;\n        getmulti(po,a[i][d+1],mul);\n        cout<<\"+ \"<<mul<<\" \"<<sum<<\" \"<<sum<<endl;\n        cout<<\"+ \"<<q<<\" \"<<4997<<\" \"<<q<<endl;\n    }\n    return sum;\n}\n\nint getmulti(int a,int b,int q){\n    b=(b%p+p)%p;\n    int ans=(q?q:++tot);\n    cout<<\"+ \"<<zero<<\" \"<<zero<<\" \"<<ans<<endl;\n    int x=++tot;\n    cout<<\"+ \"<<zero<<\" \"<<a<<\" \"<<x<<endl;\n    while(b){\n        if(b&1ll){\n            cout<<\"+ \"<<x<<\" \"<<ans<<\" \"<<ans<<endl;\n        }\n        cout<<\"+ \"<<x<<\" \"<<x<<\" \"<<x<<endl;\n        b/=2;\n    }\n    return ans;\n}\n\nint jian(int a,int b){\n    b=getmulti(b,p-1);\n    ++tot;\n    cout<<\"+ \"<<a<<\" \"<<b<<\" \"<<tot<<endl;\n    return tot;\n}\nbool u[20];\nsigned main(){\n    d=getint(),p=getint();\n\n    c[1][1]=1;\n    for(int i=1;i<=d+1;i++){\n        for(int j=1;j<=i;j++){\n            if(i==1&&j==1)continue;\n            c[i][j]=c[i-1][j]+c[i-1][j-1];\n        }\n    }\n\n    for(int i=0;i<=d;i++){\n        int q=1;\n        for(int j=0;j<=d;j++){\n            a[j][i]=c[d+1][j+1]*q%p;\n            q*=i;\n            q%=p;\n        }\n    }\n    a[d-2][d+1]=1;\n    for(int i=0;i<=d;i++){\n        bool ok=false;\n        int j=0;\n        for(;j<=d;j++){\n            if(a[j][i]&&!u[j]){\n                ok=true;\n                u[j]=true;\n                break;\n            }\n        }\n        double orz=a[j][i];\n        for(int k=0;k<=d+1;k++){\n            a[j][k]*=getinv(orz,1,p);\n            a[j][k]%=p;\n        }\n        for(int k=0;k<=d;k++){\n            if(k==j)continue;\n            orz=a[k][i]*=getinv(a[j][i],1,p);\n            for(int l=0;l<=d+1;l++){\n                a[k][l]-=orz*a[j][l];\n                a[k][l]=(a[k][l]%p+p)%p;\n            }\n        }\n    }\n    int f=p-1;\n    while(f){\n        if(f&1ll){\n            cout<<\"+ \"<<4998<<\" \"<<zero<<\" \"<<zero<<endl;\n        }\n        cout<<\"+ \"<<4998<<\" \"<<4998<<\" \"<<4998<<endl;\n        f/=2;\n    }\n    cout<<\"+ \"<<1<<\" \"<<2<<\" \"<<(++tot)<<endl;\n    int xysum2=getpow2(tot);\n    \n    int x2=getpow2(1);\n    int y2=getpow2(2);\n    int q=jian(xysum2,x2);\n    jian(q,y2);\n    int ans=getmulti(tot,getinv(2,1,p));\n    cout<<\"f \"<<ans<<endl;\n\n    return 0;\n}\n```",
        "postTime": 1541164489,
        "uid": 37676,
        "name": "\u7834\u58c1\u4eba\u4e94\u53f7",
        "ccfLevel": 9,
        "title": "\u3010\u9898\u89e3\u3011CF1060H Sophisticated Device"
    },
    {
        "content": "# CF1060H Sophisticated Device \n## \u524d\u8a00\n\u4e3b\u4f53\u601d\u8def\u501f\u9274\u4e8e[@\u7834\u58c1\u4eba\u4e94\u53f7](https://www.luogu.com.cn/user/37676)\u7684\u9898\u89e3\uff0c\u83dc\u9e21\u5728\u6b64\u4e4b\u4e0a\u505a\u4e86\u4e00\u4e9b\u5c0f\u6539\u52a8\u548c\u4f18\u5316\uff08\uff1f\uff09\uff0c\u5e76\u4e14\u611f\u8c22\u540c\u673a\u623f\u5927\u4f6c[@Surround_By_Gugugu](https://www.luogu.com.cn/user/154970)\u63d0\u4f9b\u7684\u4f18\u5316\u601d\u8def\u3002%%%%%%%\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF1060H)\n\n\n## Step 1 \u8f6c\u5316\n\n\u6211\u4eec\u53ea\u80fd\u8fdb\u884c\u4e24\u4e2a\u64cd\u4f5c\uff1a\u52a0\u6cd5\u548c $d$ \u6b21\u5e42\u3002\u800c\u6211\u4eec\u8981\u6c42\u7684\u662f $xy(mod\\ p)$\u3002\u6211\u4eec\u81ea\u7136\u800c\u7136\u5730\u60f3\u5230**\u9f9f\u901f\u4e58**\uff0c\u4f46\u663e\u7136\u9f9f\u901f\u4e58\u65e0\u6cd5\u9002\u7528\u4e8e\u4e24\u4e2a\u672a\u77e5\u91cf\u76f8\u4e58\u3002\u4f3c\u4e4e\u5df2\u7ecf\u65e0\u5904\u4e0b\u624b\u4e86\u3002\n\n\u6211\u4eec\u518d\u6765\u770b\u770b\u6211\u4eec\u8981\u6c42\u7684\u5f0f\u5b50\uff0c\u9762\u5bf9\u5982\u6b64\u719f\u6089\u7684\u5f0f\u5b50\uff0c\u5f88\u81ea\u7136\u6211\u4eec\u5c31\u80fd\u60f3\u5230\u5b83\u80fd\u8f6c\u5316\u6210 $\\frac{(x + y) ^ 2 - x^2 - y^2}{2}$ \uff0c\u5e76\u4e14\u8fd9\u4e2a\u5f0f\u5b50\u6ee1\u8db3\u5bf9\u79f0\u6027\uff0c\u6240\u4ee5\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a\u4e86\u5982\u4f55\u6784\u9020\u6307\u4ee4\uff0c\u4f7f\u5f97 $\\frac{(x + y) ^ 2 - x^2 - y^2}{2}$ \u51fa\u73b0\u5728\u5176\u4e2d\u4e00\u4e2a\u683c\u5b50\u91cc\u3002\n\n## Step 2 \u4e58\u6cd5\n\u9f9f\u901f\u4e58\u3002\n\n## Step 3 \u51cf\u6cd5\n$a +(p-1)b \u2261 a-b(mod\\ p)$\n\n## Step 4 \u9664\u6cd5\n\u4e58\u6cd5\u9006\u5143\u3002\u697c\u4e0a\u7528\u7684\u662f\u6269\u6b27\u6c42\u9006\u5143\uff0c\u4f46 $p$ \u7ed9\u5b9a\u7684\u662f\u8d28\u6570\uff0c\u663e\u7136\u53ef\u4ee5\u7528\u8d39\u9a6c\u5c0f\u5b9a\u7406\u6c42\u9006\u5143\u3002\n\n## Step 5 \u5e73\u65b9\n\u601d\u8def\u6765\u81ea\u4e8e[@\u7834\u58c1\u4eba\u4e94\u53f7](https://www.luogu.com.cn/user/37676)\u3002\n\n\u5f53\u65e0\u6cd5\u76f4\u63a5\u6c42\u51fa\u4e00\u4e2a\u6570\u7684\u5e42\u65f6\uff0c\u6211\u4eec\u8003\u8651\u6784\u9020\u4e00\u4e2a\u591a\u9879\u5f0f\u6765\u6c42\u89e3\u3002~~\u4e5f\u5c31\u662f\u778e\u51d1~~\n\n\u6211\u4eec\u5c06 $x^2$ \u7528 $\\Sigma^d_{i=0} a_i(x+i)^{d - i}$ \u6765\u8868\u793a\uff0c\u5c55\u5f00\u540e\u5373\u4e3a\n$$x^2=\\Sigma^d_{i=0} C(d,i)x^{d-i}\\Sigma^d_{j = 0}a_jj^i$$\n\u663e\u7136\uff0c\u5bf9\u4e8e $x^i(i \\ne 2)$ \u9879\u65f6\uff0c\u6211\u4eec\u8981\u4f7f $C(d,i)\\Sigma^d_{j = 0}a_jj^i$ \u4e3a 0\uff08\u6b64\u65f6\u53ef\u4ee5\u987a\u4fbf\u628a $C(d,i)$ \u7ea6\u6389\uff09\uff0c\u800c\u5bf9\u4e8e\u4e8c\u6b21\u9879\u65f6\u4e3a1\u3002\u6211\u4eec\u4fbf\u53ef\u4ee5\u63a8\u51fa\u4e00\u4e2a $d+1$ \u9879\u7ebf\u6027\u65b9\u7a0b\u7ec4\uff0c\u7528\u9ad8\u65af\u6d88\u5143\u6c42\u89e3\u5373\u53ef\u3002\n\n## Step 6 \u201c0\u201d\n\u5176\u5b9e\u4e0d\u7528\u975e\u8981\u6c420\uff0c\u4f46\u662f\u6c420\u540e\u53ef\u4ee5\u66f4\u5feb\u5e76\u4e14\u66f4\u6e05\u6670\u5730\u6784\u9020\u4ee3\u7801\u3002\n\n\u52a0 $p-1$ \u6b211\u5373\u53ef\u3002\n\n## AC Code\n\n```cpp\n//CF1060H\n//\u6784\u9020+\u9ad8\u65af\u6d88\u5143+\u9006\u5143 \n#include <bits/stdc++.h>\n#define ll long long\n#define re register\nusing namespace std;\ninline ll read(){//\u5feb\u8bfb \n\tll s = 0, w = 1;\n\tchar ch = getchar();\n\twhile(ch < '0' || ch > '9'){if(ch == '-') w = -1; ch = getchar();}\n\twhile(ch >= '0' && ch <= '9'){s = (s << 1) + (s << 3) + (ch ^ 48); ch = getchar();}\n\treturn s * w;\n}\nll d, p, a[15][15], tot = 2, m[15];\nvoid zero(){\t//\u57285000\u4f4d\u5b580 \n\tll b = p - 1;\n\twhile(b){\n\t\tif(b & 1)\tprintf(\"+ 5000 4999 5000\\n\");\n\t\tprintf(\"+ 4999 4999 4999\\n\");\n\t\tb >>= 1;\n\t}\n}\nll quickpow(ll x, ll y){\t//\u5feb\u901f\u5e42\n\tll ans = 1;\n\twhile(y){\n\t\tif(y & 1)\tans = ans * x % p;\n\t\tx = x * x % p;\n\t\ty >>= 1;\n\t}\n\treturn ans % p;\n}\nvoid guass(){ //\u9ad8\u65af-\u7ea6\u65e6\u6d88\u5143 \n//\u7ea6\u65e6\u6d88\u5143\u5bf9\u4e8e\u9ad8\u65af\u6d88\u5143\u7684\u4f18\u70b9\u5728\u4e8e\u4e0d\u7528\u56de\u5e26\u3002\u9ad8\u65af\u6d88\u5143\u89e3\u5b8c\u540e\u4e3a\u4e00\u4e2a\u4e0a\u4e09\u89d2\u884c\u5217\u5f0f\uff0c\u7ea6\u65e6\u6d88\u5143\u89e3\u5b8c\u540e\u4e3a\u5bf9\u89d2\u578b\u884c\u5217\u5f0f\u3002\n\tfor(re ll i = 0; i <= d; i++){\n\t\tfor(re ll j = 0; j <= d; j++){\n            a[i][j] = quickpow(j, i);\n            if(i == d - 2)\ta[i][j] = a[i][j] * d  * (d - 1) / 2 % p;\n        }       \n\t\tif(i == d - 2)\ta[i][d + 1] = 1;\n\t\telse\ta[i][d + 1] = 0;\n\t}\n\tfor(re ll i = 0; i <= d; i++){\n\t\tll mmax = i;\n\t\tfor(re ll j = i + 1; j <= d; j++)\tif(fabs(a[j][i]) > fabs(a[mmax][i]))\tmmax = j;\n\t\tfor(re ll j = 0; j <= d + 1; j++)\tswap(a[i][j], a[mmax][j]);\n\t\tfor(re ll j = 0; j <= d; j++){\n\t\t\tif(j == i)\tcontinue;\n\t\t\tdouble b = a[j][i] * quickpow(a[i][i], p - 2) % p;\n\t\t\tfor(ll k = 0; k <= d + 1; k++){\n\t\t\t\ta[j][k] -= a[i][k] * b;\n\t\t\t\ta[j][k] = (a[j][k] % p + p) % p;\n\t\t\t}\n\t\t}\n\t}\n\tfor(re ll i = 0; i <= d; i++)\tm[i + 1] = a[i][d + 1] * quickpow(a[i][i], p - 2) % p;//\u5c06\u89e3\u5b58\u5165\u6570\u7ec4\n}\nll multi(ll x, ll y){//\u4e58\u6cd5 \n\tll b = y % p;\t\n\tll a = ++tot;\n\tll ans = ++tot;\n\tprintf(\"+ 5000 5000 %lld\\n\", ans);\n\tprintf(\"+ 5000 %lld %lld\\n\", x, a);\n\twhile(b){\n\t\tif(b & 1)\tprintf(\"+ %lld %lld %lld\\n\", a, ans, ans);\n\t\tprintf(\"+ %lld %lld %lld\\n\", a, a, a);\n\t\tb >>= 1;\n\t}\n\treturn ans;\n} \nll getpow(ll x){//\u5e73\u65b9 \n\tll a = ++tot;\n\tll b = ++tot;\n\tll ans = ++tot;\n\tprintf(\"+ 5000 %lld %lld\\n\", x, a);\n\tprintf(\"+ 5000 5000 %lld\\n\", b);\n\tprintf(\"+ 5000 5000 %lld\\n\", ans);\n\tfor(re ll i = 1; i <= d + 1; i++){\n\t\tprintf(\"+ %lld %lld %lld\\n\", a, b, ++tot);\n\t\tprintf(\"^ %lld %lld\\n\", tot, tot + 1);\n\t\ttot++;\n\t\tll tmp = multi(tot, m[i]);\n\t\tprintf(\"+ 4998 %lld %lld\\n\", b, b);\n\t\tprintf(\"+ %lld %lld %lld\\n\", ans, tmp, ans);\n\t}\n\treturn ans;\n}\nll Minus(ll a, ll b){//\u51cf\u6cd5 \n\tb = multi(b, p - 1);\n\tll ans = ++tot;\n\tprintf(\"+ %lld %lld %lld\\n\", a, b, ans);\n\treturn ans;\n}\nint main(){\n\td = read(), p = read();\n\tzero();\tguass();\t\n\tprintf(\"+ 1 2 %lld\\n\", ++tot);\n\tll xplusy2 = getpow(tot), x2 = getpow(1), y2 = getpow(2);\n\tll fz = Minus(Minus(xplusy2, x2), y2);\n\tll ans = multi(fz, quickpow(2, p - 2));\n\tprintf(\"f %lld\", ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1633958829,
        "uid": 140694,
        "name": "T_E_I_O_",
        "ccfLevel": 5,
        "title": "Solution: CF1060H Sophisticated Device"
    }
]
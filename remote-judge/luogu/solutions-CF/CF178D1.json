[
    {
        "content": "\u56e0\u4e3a\u6570\u636e\u8303\u56f4\u662f $1\\le n \\le 4$ \u6240\u4ee5\u91c7\u7528 DFS \u3002\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O((n^2)! \\times n)$\uff08\u540e\u9762\u7684 $n$ \u662f check \u51fd\u6570\u7684\uff09,\u80af\u5b9a\u8d85\u65f6\u3002\u6240\u4ee5\u5fc5\u987b\u8981\u526a\u679d\u4f18\u5316\u3002\n\u53ef\u4ee5\u505a\u4e00\u4e0b\u526a\u679d\uff1a\n- \u53d1\u73b0\u5728\u6bcf\u6b21\u4e00\u884c/\u5217\u7b97\u5b8c\u540e\uff0c\u53ef\u4ee5\u526a\u679d\u56e0\u4e3a\u5982\u679c\u8fd9\u4e00\u884c/\u5217\u662f\u9519\u7684\uff0c\u7ee7\u7eed\u641c\u4e0b\u53bb\u7684\u8bdd\u80af\u5b9a\u662f\u9519\u7684\u3002\n- \u5947\u5e7b\u6b63\u65b9\u5f62\u7684\u6bcf\u884c,\u6bcf\u5217\u548c\u4e3b\u5bf9\u89d2\u7ebf\u7684\u6570\u4e4b\u548c $s$ \u80af\u5b9a\u662f $ \\frac{\\sum a_i}{n}$ , \u56e0\u4e3a\u6bcf\u4e00\u884c\u662f\u4e00\u6837\u7684\u3002\n- \u5728 dfs \u4e2d\uff0c\u53ef\u4ee5\u628a\u6bcf\u884c/\u5217\u7684\u548c\u52a0\u5728\u4e00\u8d77\uff0c\u4e0d\u7528\u6bcf\u6b21\u7b97\u4e00\u904d\u3002\n\n\u53ef\u4ee5\u6309\u7167\u5168\u6392\u5217\u53bb\u5199\uff0c\u4e00\u5b9a\u4e00\u5b9a\u8981\u6ce8\u610f\u4f18\u5316\u3002\n\ncode\n```cpp\n#include <iostream>\n#include <climits>\n#include <cmath>\n#include <map>\n#include <stack>\n#include <queue>\n#define int long long\nusing namespace std;\nconst int N = 100;\nconst int M = 5;\nint n, m;\nint arr[N];\nint mp[M][M];\nbool vis[N];\nint sumh[M];\nint suml[M];\nbool check() {\n\tfor (int i = 1; i <= n; i++) {\n\t\tif (sumh[i] != m)\n\t\t\treturn 0;\n\t\tif (suml[i] != m)\n\t\t\treturn 0;\n\t}\n\tint sum1 = 0, sum2 = 0;\n\tfor (int i = 1; i <= n; i++) {\n\t\tsum1 += mp[i][i];\n\t\tsum2 += mp[i][n - i + 1];\n\t}\n\tif (sum1 != m || sum2 != m)\n\t\treturn 0;\n\treturn 1;\n}\nvoid dfs(int x) {\n\tif (x > n * n) {\n\t\tif (check()) {\n\t\t\tcout << m << endl;\n\t\t\tfor (int i = 1; i <= n; i++) {\n\t\t\t\tfor (int j = 1; j <= n; j++)\n\t\t\t\t\tcout << mp[i][j] << ' ';\n\t\t\t\tcout << endl;\n\t\t\t}\n\t\t\texit(0);\n\t\t}\n\t\treturn;\n\t}\n\tint nx = (x - 1) / n + 1, ny = (x - 1) % n + 1;\n\tfor (int i = 1; i <= n * n; i++) {\n\t\tif (!vis[i]) {\n\t\t\tif (nx == n) {\n\t\t\t\tif (suml[ny] + arr[i] != m) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (ny == n) {\n\t\t\t\tif (sumh[nx] + arr[i] != m) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tsumh[nx] += arr[i], suml[ny] += arr[i], vis[i] = 1, mp[nx][ny] = arr[i];\n\t\t\tdfs(x + 1);\n\t\t\tsumh[nx] -= arr[i], suml[ny] -= arr[i], vis[i] = 0;\n\t\t}\n\t}\n}\nsigned main() {\n\tcin >> n;\n\tfor (int i = 1; i <= n * n; i++)\n\t\tcin >> arr[i], m += arr[i];\n\tm /= n;\n\tdfs(1);\n\treturn 0;\n}\n```",
        "postTime": 1678528422,
        "uid": 637788,
        "name": "kimi0705",
        "ccfLevel": 4,
        "title": "Magic Squares\u9898\u89e3"
    }
]
[
    {
        "content": "# 1.\u6838\u5fc3\u90e8\u5206\uff1a\u5404\u9879\u7684\u6307\u6570\n\u55ef\uff0c\u8fd9\u9898\u7684\u5173\u952e\u5c31\u662f\u627e\u51fa\u6bcf\u4e00\u9879\u7684\u6307\u6570\u3002\n\n\u53ef\u662f\u600e\u4e48\u627e\u5462\uff1f\u62ff\u51fa\u7eb8\u548c\u7b14\u63a8\u4e00\u4e0b $n=4, m=5$ \u65f6\u60c5\u51b5\uff1a\n```\n1  1  1  1\n2  2  2  1\n4  4  3  1\n8  7  4  1\n15 11 5  1\n```\n\u8fd9\u4e2a\u7279\u70b9\u4e0d\u592a\u660e\u663e\uff0c\uff08\u770b\u51fa\u5b83\uff0c\u5176\u5b83\u5c31\u662f code \u600e\u4e48\u5199\u7684\u4e8b\uff09\uff0c\u4f46\u6211\u4e00\u773c\u5c31\u77aa\u4e86\u51fa\u6765\uff08\u522b\u95ee\u6211\u600e\u4e48\u77aa\uff09\uff0c\u7b2c $i+1$ \u884c\u7b2c $j+1$ \u5217\uff08\u5217\u4ece\u53f3\u5f80\u5de6\u6570\uff0c\u8bb0\u4e3a $a_{ij}$\uff09\u7684\u6570\u662f\n$$\\sum_{k=0}^j\\text{C}_i^k = \\text{C}_i^0 + \\text{C}_i^1 + \\cdots + \\text{C}_i^j$$\n\u6211\u4eec\u5c1d\u8bd5\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5\u53bb\u8bc1\u660e\u5b83\uff0c\u663e\u7136\u5f53 $i = 1$ \u6216 $j = 1$ \u65f6\u6210\u7acb\uff0c\u4e0b\u8bc1 \n$$a_{i,j} = a_{i-1,j} + a_{i-1,j-1}$$\n\u9996\u5148\uff0c\u6709\u7b49\u5f0f\n$$\\text{C}_a^b=\\text{C}_{a-1}^b + \\text{C}_{a-1}^{b-1}$$\n\u8fd9\u4e2a\u7b49\u5f0f\u4e0d\u96be\u7528\u7b97\u4e24\u6b21\u8bc1\u660e\uff1a $n$ \u4e2a\u4eba\u4e2d\u9009 $m$ \u4e2a\u4eba\u6709 $\\text{C}_a^b$ \u79cd\u65b9\u6cd5\uff0c\u8003\u8651\u4e00\u4e2a\u4eba\u9009\u6216\u4e0d\u9009\u5206\u522b\u6709 $\\text{C}_{a-1}^b , \\text{C}_{a-1}^{b-1}$ \u79cd\u9009\u6cd5\uff0c\u8bc1\u6bd5\u3002\n$$\\begin{aligned}\na_{i,j} & = \\text{C}_i^0 + \\text{C}_i^1 + \\cdots + \\text{C}_i^j \\\\ & = \\text{C}_{i-1}^0 + (\\text{C}_{i-1}^0+\\text{C}_{i-1}^1) + (\\text{C}_{i-1}^1 + \\text{C}_{i-1}^2) + \\cdots + (\\text{C}_{i-1}^{j-1}+\\text{C}_{i-1}^j) \\\\ & = (\\text{C}_{i-1}^0 + \\text{C}_{i-1}^1 + \\cdots + \\text{C}_{i-1}^{j-1}) + (\\text{C}_{i-1}^0 + \\text{C}_{i-1}^1 + \\cdots + \\text{C}_{i-1}^j) \\\\ &= a_{i-1,j} + a_{i-1,j-1}\n\\end{aligned}$$\n\u8bc1\u6bd5\u3002\n\n\u7ed3\u675f\u4e86\uff1f\u6ca1\u6709\uff0c\u56e0\u4e3a\u53ea\u662f\u89e3\u51b3\u4e86\u6307\u6570\u95ee\u9898\uff0c\u7136\u540e\u8fd8\u6709\u8bb8\u591a(\u89c1\u7b2c\u4e8c\u90e8\u5206)\u3002\n# 2.\u4e58\u6cd5\u9636\u4e0e\u7ec4\u5408\u6570\n\u4e58\u6cd5\u9636\uff1a $a^x \\equiv 1 \\pmod{p}$\uff0c\u600e\u4e48\u6c42 $x$\uff1f\u539f\u9898\u4e2d\u4fdd\u8bc1 $x \\le 10^6$\uff0c\u679a\u4e3e\u5373\u53ef\u3002\n\n\u6c42\u7ec4\u5408\u6570\uff1a$\\text{C}_i^0 , \\text{C}_i^1 , \\cdots , \\text{C}_i^j \\mod{x}, \\text{C}_k^l=\\frac{k!}{(k-l)!l!}$\uff0c\u5206\u522b\u6c42\u51fa $1!,2!,\\cdots,i!\\mod{x}$ \u53ca\u5176\u6a21 $x$ \u7684\u9006\u5143\uff0c\u539f\u9898\u4e2d\u5df2\u63d0\u5230 $x$ \u4e3a\u8d28\u6570\uff0c\u6545\u5fc5\u7136\u5b58\u5728\u9006\u5143\u3002\n# 3.talk is cheap, show me the code\n```cpp\n#include<bits/stdc++.h>\n#define II inline int\n#define int long long \nusing namespace std;\n\nconst int N = 1e6 + 200;\n\nint phiq, x[N], y[N], out[N];\n\nII phi(int a, int q)\n{\n\tint cnt=0, i=1;\n\twhile(cnt==0||i!=1)\n\t{\n\t\ti = i * a % q;\n\t\tcnt++;\n\t}\n\treturn cnt;\n}\n\nII power(int a, int b, int p)//a^b%p\n{\n\tint c=b, d=1, e=a;\n\twhile(c)\n\t{\n\t\tif(c&1) d = (d * e) % p;\n\t\tc >>= 1;\n\t\te = (e * e) % p;\n\t}\n\treturn d;\n}\n\nII C(int a, int b)\n{\n\treturn x[a] * y[a-b] % phiq * y[b] % phiq;\n}\n\nsigned main()\n{\n\tint n, m, a, q, i, sum=0;\n\tscanf(\"%lld%lld%lld%lld\", &n, &m, &a, &q);\n\tphiq = phi(a,q);\n\tx[0] = y[0] = 1;\n\tfor(i=1;i<=m;i++)\n\t{\n\t\tx[i] = (x[i-1] * i) % phiq;\n\t\ty[i] = power(x[i],phiq-2,phiq);\n\t}\n\tfor(i=0;i<n;i++)\n\t{\n\t\tsum = (sum + C(m,i)) % phiq;\n\t\tout[i] = power(a,sum,q);\n\t}\n\tfor(i=n-1;~i;i--) printf(\"%lld \", out[i]);\n\treturn 0;\n}\n``",
        "postTime": 1654054468,
        "uid": 316358,
        "name": "\u4e0d\u77e5\u540d\u7528\u6237",
        "ccfLevel": 0,
        "title": "CF852F"
    },
    {
        "content": "\u9898\u610f\uff1a\n\n\u6709\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6570\u7ec4\u5168\u90e8\u5143\u7d20\u90fd\u662f $a$ \u3002\n\n\u73b0\u5728\u8fdb\u884c $m$ \u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u64cd\u4f5c\u5c06 $A[i]$ \u53d8\u4e3a $A[i]*A[i+1]$ \uff0c\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u4e0d\u53d8\u3002\n\n\u73b0\u7ed9\u51fa $n,m,a,Q$\uff0c\u8f93\u51fa $m$ \u6b21\u64cd\u4f5c\u540e\u7684 $A$ \u6570\u7ec4\uff0c\u6bcf\u4e2a\u5143\u7d20\u5bf9 $Q$ \u53d6\u6a21\u3002\n\n$n,m\\leq 10^6+123$ \u3002\n\n----\n\n\n\u8fd9\u4e2a\u9898\u7684\u64cd\u4f5c\u4e0d\u7b97\u590d\u6742\uff0c\u800c\u4e14\u7ed9\u51fa\u7684\u521d\u59cb\u6570\u7ec4\u5143\u7d20\u79cd\u90fd\u662f $a$ \uff0c\u53ef\u4ee5\u770b\u51fa\u6765\u662f\u8ba9\u6211\u4eec\u76f4\u63a5\u8ba1\u7b97\u51fa\u6bcf\u4e00\u4f4d\u7684\u503c\n\n$ a^1 \\ a^1 \\ a^1 \\ a^1 \\ a^1 \\ a^1 \\ a^1$\n\n$a^2 \\ a^2 \\ a^2 \\ a^2 \\ a^2 \\ a^2 \\ a^1$\n\n$a^4 \\ a^4 \\ a^4 \\ a^4 \\ a^4 \\ a^3 \\ a^1$\n\n$a^8 \\ a^8 \\ a^8 \\ a^8 \\ a^7 \\ a^4 \\ a^1$\n\n$a^{16} \\ a^{16} \\ a^{16} \\ a^{15} \\ a^{11} \\ a^5 \\ a^1$\n\n$\u2026$\n\n\u5982\u679c\u4e0d\u662f\u6700\u540e\u4e00\u4e2a\u6570\u7684\u201c\u5e72\u6270\u201d $m$ \u6b21\u8fc7\u540e\u5e94\u8be5\u4f1a\u53d8\u6210 $a^{(2^{m-1})}$\uff0c\u4f46\u662f\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u59cb\u7ec8\u662f $a$ \uff0c\u6240\u4ee5\u6211\u4eec\u63d0\u53d6\u51fa\u6bcf\u4e00\u4f4d\u6570\u7684\u6307\u6570\u4e0e ${2^{m-1}}$ \u7684\u5dee\u503c\uff0c\u4e3a\u4e86\u65b9\u4fbf\u627e\u89c4\u5f8b\uff0c\u6211\u4eec\u518d\u628a\u5e8f\u5217\u53cd\u8f6c\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n\n$0 \\ 0\\ 0\\ 0\\ 0\\ 0 \\ 0\u2026$\n\n\n$1 \\ 0\\ 0\\ 0\\ 0\\ 0 \\ 0\u2026$\n\n\n$3 \\ 1\\ 0\\ 0\\ 0\\ 0 \\ 0\u2026$\n\n\n$7 \\ 4\\ 1\\ 0\\ 0\\ 0 \\ 0\u2026$\n\n\n$15 \\ 11\\ 5\\ 1\\ 0\\ 0 \\ 0 \u2026$\n\n\n\n$31  \\ 26\\ 16\\ 6\\ 1\\  0 \\ 0 \u2026$\n\n\n$61 \\ 57\\ 42\\ 22\\ 7\\ 1\\ 0 \u2026$\n\n$\u2026$\n\n\u53ef\u4ee5\u770b\u51fa\u6765\u662f\u7c7b\u4f3c\u6768\u8f89\u4e09\u89d2\u5f62\u5f0f\u7684\uff0c\u4e00\u4e2a\u6570\u662f\u4e0a\u9762\u76f8\u90bb\u4e24\u6570\u4e4b\u548c\uff0c\u6bcf\u884c\u7b2c\u4e00\u4e2a\u6570\u662f $2^{i-1}-1$ \uff0c\u6bcf\u884c\u6700\u540e\u4e00\u4e2a\u4e0d\u662f\u96f6\u7684\u6570\u662f $1$ \u3002\n\n\u7531\u4e8e $n,m$ \u662f $10^6$ \u7ea7\u522b\u7684\uff0c\u6240\u4ee5\u4e0d\u80fd\u7206\u7b97\u6bcf\u4e00\u4f4d\u7684\u503c\uff0c\u9700\u8981\u627e\u5230\u6377\u5f84\u3002\n\n\u518d\u5bf9\u8fd9\u4e2a\u6570\u5217\u53d6\u4e00\u4e2a\u5dee\u5206\uff08\u5c31\u662f\u540e\u9762\u7684\u4e00\u4f4d\u51cf\u53bb\u524d\u9762\u7684\u4e00\u4f4d\uff09\uff0c\u5f97\u5230\u5982\u4e0b\u7684\u4e1c\u897f\u3002\n\n$0 \\ 0\\ 0\\ 0\\ 0\\ 0 \\ 0\u2026$\n\n\n$1 \\ 0\\ 0\\ 0\\ 0\\ 0 \\ 0\u2026$\n\n\n$2 \\ 1\\ 0\\ 0\\ 0\\ 0 \\ 0\u2026$\n\n\n$3 \\ 3\\ 1\\ 0\\ 0\\ 0 \\ 0\u2026$\n\n\n$4 \\ 6\\ 4\\ 1\\ 0\\ 0 \\ 0 \u2026$\n\n\n\n$5  \\ 10\\ 10\\ 5\\ 1\\  0 \\ 0 \u2026$\n\n\n$6 \\ 15\\ 20\\ 15\\ 6\\ 1\\ 0 \u2026$\n\n$\u2026$\n\n\u8fd9\u5c31\u5341\u5206\u7684\u773c\u719f\u4e86\uff0c\u7b2c $i$ \u884c \u7b2c $j$ \u5217\u7adf\u662f $\\tbinom{i-1}{j}$\u3002\n\n\u4f46\u8fd8\u6709\u4e2a\u95ee\u9898\uff1a\u8fd9\u91cc\u6211\u4eec\u6c42\u7684\u662f\u6307\u6570\u4e0a\u7684\u6570\uff0c\u8fd9\u4e2a\u95ee\u9898\u7684\u6570\u89c4\u6a21\u4f1a\u5f88\u5927\uff0c\u8981\u7528\u4e3a\u6307\u6570\u53d6\u6a21\uff0c\u8fd9\u91cc\u4e0d\u5fc5\u7528\u5230[\u6b27\u62c9\u5b9a\u7406](https://www.luogu.com.cn/problem/P5091)\uff0c\u53ea\u8981\u679a\u4e3e\u51fa $a^i \\mod Q=1$ \u7684 $i$ \u5373\u53ef\uff0c\u7531\u9898\u610f\u5f97\uff0c\u8fd9\u4e2a $i$ \u4e5f\u662f $10^6$ \u7ea7\u522b\u7684\uff0c\u7136\u540e\u6307\u6570\u90fd\u5bf9\u8fd9\u4e2a $i$ \u53d6\u6a21\u5373\u53ef\u3002\n\n---\n\n\u6838\u5fc3\u4ee3\u7801\uff1a\n\n```cpp\nint main(){\n\tscanf(\"%d%d%d%d\",&n,&m,&A,&Q);\n\tint i;\n\tfor (i=A%Q,mod=1; i!=1; mod++) \n\t\ti=(ll)i*A%Q;fac[0]=1;\n\tfor (i=1; i<mod; i++) \n\t\tfac[i]=(ll)fac[i-1]*i%mod;f[0]=1;\n\tfor (i=1; i<=m; i++)\n    \tf[i]=(f[i-1]+(ll)fac[m]*inv(fac[i])%mod*inv(fac[m-i]))%mod;\n\tfor (i=m+1;i<=n; i++) \n\t\tf[i]=f[i-1];\n\tfor (i=n; i; i--)\n\t\tprintf(\"%d%c\",ksm(A,f[i-1],Q),(i>1)?' ':'\\n');\n}\n```\n\n",
        "postTime": 1614174268,
        "uid": 288460,
        "name": "xzggzh1",
        "ccfLevel": 0,
        "title": "CF852F"
    }
]
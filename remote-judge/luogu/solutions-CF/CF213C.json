[
    {
        "content": "\u4e00\u9053\u4e2a\u4eba\u8ba4\u4e3a\u6bd4\u8f83\u5999\u7684 DP \u597d\u9898\u3002\n\n[\u4e00\u500d](https://www.luogu.com.cn/problem/CF213C) [\u4e24\u500d](https://www.luogu.com.cn/problem/P1006) [\u4e09\u500d](https://www.luogu.com.cn/problem/P1004) \u7ecf\u9a8c\u3002\n\n### Problem\n\n\u9898\u76ee\u5927\u610f\uff1a\u7ed9\u5b9a\u4e00\u4e2a $n \\times n$ \u7684\u7f51\u683c\uff0c\u6bcf\u4e2a\u683c\u5b50\u6709\u4e00\u4e2a\u4ef7\u503c\uff0c\u4f60\u9700\u8981\u4ece $(1,1)$ \u5411\u53f3\u6216\u5411\u4e0b\u8d70\u5230 $(n,n)$\uff0c\u518d\u4ece $(n,n)$ \u5411\u4e0a\u6216\u5411\u5de6\u8d70\u5230 $(1,1)$\uff0c\u6c42\u4f60\u4e24\u6761\u8def\u5f84\u4e0a\u6240\u6709\u6743\u503c\u4e0d\u91cd\u590d\u8ba1\u7b97\u7684\u6700\u5c0f\u503c\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a $n \\leq 300$\u3002\n\n### Solution\n\n\u4e00\u6765\u4e00\u56de\u592a\u9ebb\u70e6\u4e86\uff0c\u4e0d\u59a8\u6539\u53d8\u4e00\u4e0b\u9898\u610f\uff1a\u4ece $(1,1)$ \u8d70\u4e24\u6761\u8def\u5f84\u5230 $(n,n)$\u3002\n\n\u72b6\u6001\u662f\u5f88\u5bb9\u6613\u60f3\u5230\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe $dp_{a,b,c,d}$ \u4e3a\u4e00\u4e2a\u4eba\u5728 $(a,b)$\uff0c\u53e6\u4e00\u4e2a\u4eba\u5728 $(c,d)$ \u7684\u6700\u5927\u4e0d\u91cd\u590d\u8ba1\u7b97\u6743\u503c\u548c\u3002\u4f46\u662f\u5f88\u660e\u663e\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^4)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $O(n^4)$ \u663e\u7136\u90fd\u4f1a\u70b8\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u8003\u8651\u4f18\u5316\u3002\n\n\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4e24\u4e2a\u4eba\u4e00\u8d77\u8d70\uff0c\u6bcf\u6b21\u6bcf\u4eba\u90fd\u4e00\u8d77\u8d70\u4e00\u6b65\uff0c\u4fdd\u8bc1\u4e24\u4e2a\u4eba\u7684\u6b65\u6570\u76f8\u540c\u3002\u800c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u5f53\u4e00\u4e2a\u4eba\u8d70\u7684\u6b65\u6570\u56fa\u5b9a\u65f6\uff0c\u56e0\u4e3a\u53ea\u80fd\u5411\u53f3\u6216\u5411\u4e0b\u8d70\uff0c\u6240\u4ee5\u4ed6\u7684\u6a2a\u7eb5\u5750\u6807\u4e4b\u548c\u4e5f\u56fa\u5b9a\u4e86\u3002\u7531\u6b64\uff0c\u72b6\u6001\u5c31\u5bb9\u6613\u8bbe\u4e86\uff0c\u6211\u4eec\u8bbe $dp_{dep,i,j}$ \u8868\u793a\u8d70\u4e86 $dep-2$ \u6b65\u540e\uff08\u540e\u9762\u6709\u89e3\u91ca\uff09\uff0c\u7b2c\u4e00\u4e2a\u4eba\u7eb5\u5750\u6807\u4e3a $i$\uff0c\u7b2c\u4e8c\u4e2a\u4eba\u7eb5\u5750\u6807\u4e3a $j$\uff0c\u7684\u6700\u5927\u4e0d\u91cd\u590d\u8ba1\u7b97\u6743\u503c\u548c\u3002\u4e5f\u5c31\u662f\u7b2c\u4e00\u4e2a\u4eba\u5750\u6807\u4e3a $(dep-i,i)$\uff0c\u7b2c\u4e8c\u4e2a\u4eba\u5750\u6807\u4e3a $(dep-j,j)$\u3002\u8f6c\u79fb\u4e5f\u5341\u5206\u663e\u7136\uff1a\n\n$$dp_{dep,i,j}=\\max(dp_{dep-1,i,j},dp_{dep-1,i-1,j},dp_{dep-1,i,j-1},dp_{dep-1,i-1,j-1})+a_{dep-i,i}+a_{dep-j,j}$$\n\n\u4e3a\u4e86\u8ba1\u7b97\u65b9\u4fbf\uff0c\u6211\u4eec\u7684 $dep$ \u4ece $3$ \u5f00\u59cb\uff0c $dep$ \u4e0d\u518d\u662f\u8d70\u7684\u6b65\u6570\uff0c\u800c\u662f\u8d70\u7684\u6b65\u6570 $+2$\uff0c\u4e24\u4e2a\u4eba\u7684\u6a2a\u7eb5\u5750\u6807\u4e4b\u548c\u3002\n\n\u4e3a\u4e86\u4e0d\u8ba1\u7b97\u91cd\u590d\uff0c\u6240\u4ee5\u6211\u4eec\u4fdd\u8bc1 $i \\leq j$ \u7684\u72b6\u6001\u624d\u5408\u6cd5\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u7b2c\u4e8c\u4e2a\u4eba\u8981\u4e48\u548c\u7b2c\u4e00\u4e2a\u4eba\u91cd\u5408\uff0c\u8981\u4e48\u5728\u7b2c\u4e00\u4e2a\u4eba\u53f3\u8fb9\u7684\u72b6\u6001\u624d\u662f\u5408\u6cd5\u7684\u3002\n\n\u4f46\u662f\u6211\u4eec\u8fd8\u8981\u8003\u8651\u4e00\u70b9\uff0c\u56e0\u4e3a\u8d70\u540c\u4e00\u4e2a\u70b9\u6743\u503c\u662f\u4e0d\u4f1a\u8ba1\u7b97\u4e24\u904d\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u5224\u65ad\u4e00\u4e0b\uff0c\u5982\u679c $i=j$\uff0c\u90a3\u4e48\u53ea\u52a0\u4e0a $a_{dep-i,i}$ \u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u521d\u59cb\u5168\u662f $-inf$\uff0c\u521d\u59cb\u72b6\u6001 $dp_{2,1,1}=a_{1,1}$\uff0c\u6700\u7ec8 $dp_{2n,n,n}$ \u5c31\u662f\u7b54\u6848\uff0c\u8bb0\u5f97\u7b2c\u4e00\u7ef4\u8981\u5f00\u6210 $2n$\u3002\n\n### Code\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int inf=1e9+7;\nint n,a[301][301];\nint f[601][301][301];\nint mx(int x,int y){return x>y?x:y;}\nint main()\n{\n\tscanf(\"%d\",&n);\n    for(int i=1;i<=n;i++)\n    for(int j=1;j<=n;j++) scanf(\"%d\",&a[i][j]);\n    for(int i=0;i<=2*n;i++)\n    for(int j=0;j<=n;j++)\n    for(int k=0;k<=n;k++) f[i][j][k]=-inf;\n    f[2][1][1]=a[1][1];\n    for(int i=3;i<=(n<<1);i++)\n    for(int j=1;j<=n&&j<i;j++)\n    for(int k=j;k<=n&&k<i;k++)\n    {\n        if(j==k) f[i][j][k]=mx(mx(f[i-1][j-1][k],f[i-1][j][k-1]),mx(f[i-1][j-1][k-1],f[i-1][j][k]))+a[i-j][j];\n        else\n        {\n            f[i][j][k]=mx(f[i][j][k],f[i-1][j][k]+a[i-j][j]+a[i-k][k]);\n            f[i][j][k]=mx(f[i][j][k],f[i-1][j-1][k]+a[i-j][j]+a[i-k][k]);\n            f[i][j][k]=mx(f[i][j][k],f[i-1][j][k-1]+a[i-j][j]+a[i-k][k]);\n            f[i][j][k]=mx(f[i][j][k],f[i-1][j-1][k-1]+a[i-j][j]+a[i-k][k]);\n        }\n    }\n    printf(\"%d\\n\",f[n<<1][n][n]);\n}\n```\n",
        "postTime": 1668585006,
        "uid": 478885,
        "name": "lenlen",
        "ccfLevel": 6,
        "title": "CF213C Relay Race \u9898\u89e3"
    },
    {
        "content": "\u9898\u610f\uff1a\n\n\u8f93\u5165\u4e00\u4e2a$n*n$\u7684\u77e9\u5f62\uff0c$a_{i,j}$ \u662f\u8fd9\u4e2a\u4f4d\u7f6e\u7684\u4ef7\u503c\u3002\u73b0\u5728\u8981\u4ece\u5de6\u4e0a\u89d2\u8d70\u5230\u53f3\u4e0b\u89d2\u518d\u8fd4\u56de\uff0c\u6bcf\u4e2a\u4ef7\u503c\u53ea\u88ab\u8ba1\u7b97\u4e00\u6b21\uff0c\u6c42\u6700\u5927\u4ef7\u503c\u548c\n\n\u89e3\u6cd5\uff1a\n\n\u9898\u76ee\u53ef\u4ee5\u8f6c\u5316\u4e3a\u4e24\u4eba\u540c\u65f6\u4ece\u5de6\u4e0a\u89d2\u8d70\u5230\u53f3\u4e0b\u89d2\n\n\u5f88\u5bb9\u6613\u60f3\u5230\u8bbe$f[i][j][k][l]$\u8868\u793a\u7b2c\u4e00\u4e2a\u4eba\u5728$i,j$\u7b2c\u4e8c\u4e2a\u4eba\u5728$k,l$\u80fd\u5f97\u5230\u7684\u6700\u5927\u503c\u3002\n\n\u8f6c\u79fb\u65b9\u7a0b\u5f88\u5bb9\u6613\u5f97\u5230\uff0c\u4f46\u662f\u5185\u5b58\u663e\u7136\u4e0d\u591f\u3002\n\n\u6211\u4eec\u8003\u8651\u51cf\u5c11\u4e00\u7ef4\uff0c\u8bbe$f[i][j][k]$\u8868\u793a\u4e24\u4e2a\u4eba\u90fd\u8d70\u4e86$i$\u6b65\uff0c\u7b2c\u4e00\u4e2a\u4eba\u5728\u7b2c$j$\u884c\uff0c\u7b2c\u4e8c\u4e2a\u4eba\u5728\u7b2c$k$\u884c\u7684\u6700\u5927\u503c\u3002\u6211\u4eec\u53d1\u73b0\u6b64\u65f6\u4e24\u4eba\u7684\u7eb5\u5750\u6807\u662f\u53ef\u4ee5\u7b97\u51fa\u6765\u7684\uff01\n\u7b2c\u4e00\u4e2a\u4eba\u7684\u5217\u4e3a$i-j+1$\uff0c\u7b2c\u4e8c\u4e2a\u662f$i-k+1$\u3002\n\n\u8fd9\u6837\u5c31\u505a\u5b8c\u4e86\n\n### \u5b8c\u6574\u4ee3\u7801\u5949\u4e0a\uff1a\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<ctype.h>\n#include<cstring>\nusing namespace std;\ninline int read(){\n\tint x=0,f=0;char ch=getchar();\n\twhile(!isdigit(ch))f|=ch=='-',ch=getchar();\n\twhile(isdigit(ch))x=x*10+(ch^48),ch=getchar();\n\treturn f?-x:x;\n}\nint f[607][307][307];\nint a[307][307];\nint main(){\n\tint n=read();\n\tfor(int i=1;i<=n;++i)for(int j=1;j<=n;++j)a[i][j]=read();\n\tmemset(f,-0x3f,sizeof f);\n\tf[1][1][1]=a[1][1];\n\tfor(int i=2;i<=n+n-1;++i)\n\t\tfor(int j=1;j<=n;++j)if(i-j+1>=1 && i-j+1<=n)\n\t\t\tfor(int k=1;k<=n;++k)if(i-k+1>=1 && i-k+1<=n){\n\t\t\t\tint t;\n\t\t\t\tif(j!=k)t=a[j][i-j+1]+a[k][i-k+1];\n\t\t\t\telse t=a[j][i-j+1];\n\t\t\t\tf[i][j][k]=max(f[i][j][k],f[i-1][j][k]+t);\n\t\t\t\tf[i][j][k]=max(f[i][j][k],f[i-1][j-1][k-1]+t);\n\t\t\t\tf[i][j][k]=max(f[i][j][k],f[i-1][j-1][k]+t);\n\t\t\t\tf[i][j][k]=max(f[i][j][k],f[i-1][j][k-1]+t);\n\t\t\t}\n\tprintf(\"%d\\n\",f[n+n-1][n][n]);\n\treturn 0;\n}\n```\n",
        "postTime": 1569657539,
        "uid": 56653,
        "name": "\u73c5\u8090",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF213C \u3010Relay Race\u3011"
    },
    {
        "content": "# \u524d\u7f6e\u5185\u5bb9\n\n\u8fd9\u4e00\u9053\u9898\u662f\u4e00\u9053\u5f88\u7ecf\u5178\u7684\u9898\uff0c~~\u672c\u4eba\u5361\u4e86\u597d\u4e45\u624d\u8fc7~~\uff0c\u6545\u53d1\u7bc7\u9898\u89e3\u7eaa\u5ff5\u4e00\u4e0b\u3002\n\n\u5efa\u8bae\u5728\u505a\u4e4b\u524d\u505a\u4e00\u4e0b\uff1a\n[P1002\u8fc7\u6cb3\u5352](https://www.luogu.com.cn/problem/P1002#submit)\n[P1004\u65b9\u683c\u53d6\u6570](https://www.luogu.com.cn/problem/P1004)\uff08\u672c\u9898\u5f31\u5316\uff09\n[P1006\u4f20\u7eb8\u6761](https://www.luogu.com.cn/problem/P1006)\uff08\u672c\u9898\u5f31\u5316\uff09\n\n- \u6ce8\uff1aP1004\u4e0eP1006\u76f8\u540c\n\n------------\n\n# \u601d\u8def\n\n\u6211\u4eec\u53d1\u73b0\u672c\u9898\u4e2d\uff0c\u56de\u6765\u518d\u8d70\u4e00\u904d\u4e0e\u76f4\u63a5\u8d70\u4e24\u904d**\u7b49\u4ef7**\u3002\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u7528\u6570\u7ec4 $ans_{i, j, k, l}$ \u6765\u8bb0\u5f55\u5f53\u524d\u4e00\u4e2a\u8d70\u5230 $(i, j)$ \uff0c\u4e00\u4e2a\u8d70\u5230 $(k, l)$ \u7684**\u6700\u4f18\u7b54\u6848**\uff0c\u4e5f\u5c31\u662f**\u6700\u5927\u503c**\u3002\n\n\u5206\u6790\u4e4b\u540e\uff0c\u6211\u4eec\u5f88\u5feb\u5c31\u53ef\u4ee5\u53d1\u73b0\uff1a\u96be\u9053\u8fd9\u9898\u548c P1004 \u4ee5\u53ca P1006 \u4e00\u6837\uff01\uff1f\u5f53\u7136\u4e0d\u662f\uff01\u8fd9\u9898\u662f\u5b83\u4eec\u4e24\u9898\u7684**\u5f3a\u5316\u7248**\u3002 $n$ \u7684**\u6570\u636e\u8303\u56f4**\u8981\u5927\u7684\u5f88\u591a\uff0c\u5bfc\u81f4 $O(n ^ 4)$ **\u7a7a\u95f4\u590d\u6742\u5ea6**\u7b97\u6cd5\u70b9\u540d\u88ab\u5361\u3002\n\n\u65e2\u7136 $ans$ \u6570\u7ec4\u6570\u636e\u91cf\u592a\u5927\uff0c\u5c31\u8981\u60f3\u529e\u6cd5**\u964d\u7ef4**\u3002\u53ef\u4ee5\u53d1\u73b0 $\\max(i + j - 1)=\\max(k + l - 1) = 2 * n + 1$\uff0c\u4f55\u5fc5**\u518d\u82b1\u4e00\u7ef4\u6765\u50a8\u5b58**\u5462\uff1f\u4e8e\u662f\u53ef\u4ee5\u60f3\u51fa $O(n ^ 3)$ **\u7a7a\u95f4\u590d\u6742\u5ea6**\u7b97\u6cd5\u2014\u2014\u7528\u6570\u7ec4 $ans_(i, j, k)$ \u6765\u8bb0\u5f55\u8d70\u4e86 $i$ \u6b65\uff0c\u4e00\u4e2a\u8d70\u5230\u7b2c $j$ \u884c\uff0c\u4e00\u4e2a\u8d70\u5230\u7b2c $k$ \u884c\u3002\n\n\u5b8c\u7ed3\u6492\u82b1\uff01 (\u3003\uffe3\ufe36\uffe3)\u4eba(\uffe3\ufe36\uffe3\u3003) \n\n------------\n\n# \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=305;\nint n,a[N][N],f[2*N][N][N];//\u6211\u5c31\u662f\u5728\u5b9a\u4e49\u6570\u7ec4\u4e0a\u6302\u4e86\u2026\u2026\nint main(){\n    cin>>n;\n    for(int i=1;i<=n;i++)\n        for(int j=1;j<=n;j++)\n            cin>>a[i][j];\n    memset(f,-0x3f,sizeof(f));//\u6570\u636e\u8303\u56f4\u4e2d\u58f0\u660e a \u53ef\u80fd\u4e3a\u8d1f\n    f[1][1][1]=a[1][1];\n    //------\u9884\u5907\u2014\u2014\u2014\u2014\u8d70\uff01------//\n\tfor(int i=2;i<=2*n-1;i++)\n\t\tfor(int j=1;j<=n;j++)\n            if(i-j+1>=1&&i-j+1<=n)//\u9632\u6b62\u8d8a\u754c\n\t\t\t    for(int k=1;k<=n;k++)\n                    if(i-k+1>=1&&i-k+1<=n){//\u9632\u6b62\u8d8a\u754c\n                        int t;//\u4e24\u4e2a\u540c\u65f6\u53d6\u5728\u4e00\u4e2a\u5730\u65b9\u53ea\u52a0\u4e00\u6b21\n        \t\t\t\tif(j!=k)t=a[j][i-j+1]+a[k][i-k+1];\n        \t\t\t\telse t=a[j][i-j+1];\n        \t\t\t\tf[i][j][k]=max(f[i][j][k],f[i-1][j][k]+t);\n        \t\t\t\tf[i][j][k]=max(f[i][j][k],f[i-1][j-1][k-1]+t);\n        \t\t\t\tf[i][j][k]=max(f[i][j][k],f[i-1][j-1][k]+t);\n        \t\t\t\tf[i][j][k]=max(f[i][j][k],f[i-1][j][k-1]+t);\n                    }\n    cout<<f[2*n-1][n][n]<<endl;\n    return 0;//\u529f\u5fb7\u5706\u6ee1\n}//Fgx\u51fa\u54c1\uff0c\u52ff\u6284\n```\n\n\u5343\u5c71\u4e07\u6c34\u603b\u662f\u60c5\uff0c\u7ed9\u4e2a\u70b9\u8d5e\u884c\u4e0d\u884c~~",
        "postTime": 1654941664,
        "uid": 531746,
        "name": "fengguangxi",
        "ccfLevel": 0,
        "title": "CF213C Relay Race \u9898\u89e3"
    },
    {
        "content": "\u5176\u5b9e\u5c31\u662f\u5347\u7ea7\u7248 [\u65b9\u683c\u53d6\u6570](https://www.luogu.com.cn/problem/P1004)\u3002\n\n- \u5206\u6790\n\n\u5148\u8003\u8651\u6734\u7d20\u505a\u6cd5\uff0c\u8bbe $f_{i, j, p, q}$\uff0c\u4e3a\u4e24\u4eba\u5728 $(i, j)$\uff0c$(p, q)$ \u7684\u6700\u5927\u503c\uff0c\u65f6\u7a7a\u590d\u6742\u5ea6 $O(n^4)$\u3002\n\n\u600e\u6837\u7f29\u5c0f\u8fd9\u4e2a\u503c\u5462\uff1f\n\n\u89c2\u5bdf\u5230\u53ef\u4ee5\u8003\u8651\u8ba9\u8fde\u4e2a\u4eba\u4e00\u8d77\u8d70\uff0c\u540c\u65f6\u53d6\uff0c\u5373\u53ef\u7701\u4e0b\u4e00\u7ef4\u3002\n\n\u5373\u8bbe $f_{i,j,p}$ \u4e3a\u4e24\u4eba\u5728 $(i, j)$\uff0c$(p, i + j - q)$ \u7684\u6700\u5927\u503c\u3002\n\n$$f_{i, j, p} = \\max(f_{i-1,j,p},f_{i-1,j,p-1},f_{i,j-1,p},f_{i,j-1,p-1})+a_{i,j}+a_{p,i+j-p}$$\n\n\u6ce8\u610f\u5982\u679c $i$ \u548c $p$ \u76f8\u7b49\uff0c\u5373\u8d70\u5230\u540c\u4e00\u683c\uff0c\u5c31\u8981\u51cf\u53bb $a_{i,j}$\u3002\n\n\u521d\u59cb\u503c\u8d4b\u6210\u4e24\u500d $a_{1, 1}$\uff0c\u6765\u62b5\u6d88\u7b2c\u4e00\u6b21\u7684\u6548\u679c\u3002\n\n- code\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nnamespace IO {\n\tchar ibuf[(1 << 20) + 1], *iS, *iT;\n#if ONLINE_JUDGE\n#define gh() (iS == iT ? iT = (iS = ibuf) + fread(ibuf, 1, (1 << 20) + 1, stdin), (iS == iT ? EOF : *iS++) : *iS++)\n#else\n#define gh() getchar()\n#endif\n#define reg register\n\tinline long long read () {\n\t\treg char ch = gh();\n\t\treg long long x = 0;\n\t\treg char t = 0;\n\t\twhile (ch < '0' || ch > '9')   t |= ch == '-', ch = gh();\n\t\twhile (ch >= '0' && ch <= '9') x = x * 10 + (ch ^ 48), ch = gh();\n\t\treturn t ? -x : x;\n\t}\n\tinline void write(long long x) {\n\t\tif (x < 0) {\n\t\t\tx = ~(x - 1);\n\t\t\tputchar('-');\n\t\t}\n\t\tif (x > 9)\n\t\t\twrite(x / 10);\n\t\tputchar(x % 10 + '0');\n\t}\n}\n\nusing IO::read;\nusing IO::write;\n\nconst int maxn = 350, inf = 1e9;\nint n, a[maxn][maxn], f[maxn][maxn][maxn];\n\nint main () {\n\tn = read();\n\tfor (int i = 1; i <= n; i++) {\n\t\tfor (int j = 1; j <= n; j++) {\n\t\t\ta[i][j] = read();\n\t\t}\n\t}\n\tfor (int i = 1; i <= n; i++) for (int j = 1; j <= n; j++) for (int k = 1; k <= n; k++) f[i][j][k] = -inf;//\u53ef\u80fd\u6709\u8d1f\u6570\n\tf[1][1][1] = a[1][1] << 1;\n\tfor (int i = 1; i <= n; i++) {\n\t\tfor (int j = 1; j <= n; j++) {\n\t\t\tfor (int p = 1; p <= n; p++) {\n\t\t\t\tint q = i + j - p;\n\t\t\t\tif (q <= 0) break;\n\t\t\t\tif (i > 1 && p > 1) f[i][j][p] = max(f[i][j][p], f[i - 1][j][p - 1] + a[i][j] + a[p][q]);\n\t\t\t\tif (i > 1 && q > 1) f[i][j][p] = max(f[i][j][p], f[i - 1][j][p] + a[i][j] + a[p][q]);\n\t\t\t\tif (j > 1 && p > 1) f[i][j][p] = max(f[i][j][p], f[i][j - 1][p - 1] + a[i][j] + a[p][q]);\n\t\t\t\tif (j > 1 && q > 1) f[i][j][p] = max(f[i][j][p], f[i][j - 1][p] + a[i][j] + a[p][q]);//\u8bb0\u5f97\u5224\u8d8a\u754c\n\t\t\t\t\n\t\t\t\tif (i == p) f[i][j][p] -= a[i][j];//\u8d70\u5230\u540c\u4e00\u683c\n\t\t\t}\n\t\t}\n\t}\n\twrite(f[n][n][n]);\n}\n```",
        "postTime": 1653726963,
        "uid": 317495,
        "name": "JWRuixi",
        "ccfLevel": 7,
        "title": "Solution CF213C"
    },
    {
        "content": "\u8fd9\u662f\u4e00\u9053\u597d\u9898\u3002\n\n[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/CF213C)\n## \u601d\u8def\n\u6211\u539f\u672c\u7684\u601d\u8def\u662f\u628a\u4e24\u6761\u8def\u5f84\u5206\u5f00\u8003\u8651\uff0c\u4f7f\u7528\u4e00\u4e2a\u56db\u7ef4\u6570\u7ec4 $f_{i,j,k,l}$ \u8868\u793a\u7b2c\u4e00\u6761\u4ece ${1,1}$ \u5230 ${i,j}$ \u7684\u8def\u5f84\uff0c\u7b2c\u4e8c\u6761\u4ece ${1,1}$ \u5230 ${k,l}$ \u7684\u8def\u5f84\u53ef\u4ee5\u53d6\u5230\u7684\u6700\u5927\u503c\u3002\n\n\u4f46\u8fd9\u4e48\u505a\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u663e\u7136\u662f $O(n^4)$ \u7684\uff0c\u5bf9\u4e8e $n=300$ \u7684\u6570\u636e\uff0c$300^4=8.1 \\times 10^9$\uff0c\u867d\u7136 $\\verb!CF!$ \u7684\u795e\u673a\u4e5f\u8bb8\u53ef\u4ee5\u8dd1\u8fc7\uff0c\u4f46\u7a7a\u95f4\u590d\u6742\u5ea6 $O(n^4)$ \u663e\u7136\u70b8\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u4f18\u5316\u7a7a\u95f4\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u4e24\u6761\u8def\u5f84\u540c\u65f6\u8003\u8651\uff0c\u8fd9\u6837\u6211\u4eec\u53ea\u8981\u8bb0\u5f55\u4ed6\u4eec\u4e24\u4e2a\u4eba\u5171\u540c\u8d70\u8fc7\u7684\u6b65\u6570\u5c31\u597d\u4e86\uff0c\u8fd9\u6837\u6211\u4eec\u7684\u72b6\u6001\u5c31\u9700\u8981\u7a0d\u5fae\u53d8\u5316\u4e00\u4e0b\uff0c\u53d8\u6210 $f_{i,j,k}$ \u8868\u793a\u8d70 $i$ \u6b65\uff0c\u7b2c\u4e00\u6761\u8def\u5f84\u8d70\u5230\u4e86\u7b2c $j$ \u884c\uff0c\u7b2c\u4e8c\u6761\u8def\u5f84\u8d70\u5230\u4e86\u7b2c $k$ \u884c\uff0c\u6211\u4eec\u60ca\u5947\u5730\u53d1\u73b0\u8fd9\u65f6\u4e24\u6761\u8def\u5f84\u7ed3\u5c3e\u7684\u7eb5\u5750\u6807\u662f\u663e\u7136\u53ef\u4ee5\u8868\u793a\u51fa\u6765\u7684\uff0c\u4e5f\u5c31\u662f\u5bf9\u5e94\u4e86\u6211\u4eec\u539f\u6765\u72b6\u6001\u7684 $f_{j,i-j+1,k,i-k+1}$\u3002\u8fd9\u6837\u6211\u4eec\u5c31\u6210\u529f\u5730\u628a\u7a7a\u95f4\u590d\u6742\u5ea6\u964d\u5230\u4e86 $O(n^3)$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e5f\u987a\u4fbf\u964d\u5230\u4e86 $O(n^3)$\uff0c\u663e\u7136\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n#define rint register int\nusing namespace std;\nint const N=3e2+10;\nint a[N][N],f[N<<1][N][N];//\u8fd9\u91cc\u5343\u4e07\u4e0d\u80fd\u5f00 long long\uff0c\u4e0d\u7136\u4f1a MLE\nsigned main(){\n\tios::sync_with_stdio(false);\n    cin.tie(0),cout.tie(0);\n    int n;cin>>n;\n    for (rint i=1;i<=n;++i)\n        for (rint j=1;j<=n;++j)\n            cin>>a[i][j];\n    memset(f,-0x3f,sizeof(f));\n    f[1][1][1]=a[1][1];\n    int maxn=(n<<1)-1;\n    for (rint i=2;i<=maxn;++i)\n        for (rint j=1;j<=n;++j){\n            if (i-j+1<1 || i-j+1>n) continue;\n            for (rint k=1;k<=n;++k){\n                if (i-k+1<1 || i-k+1>n) continue;\n                int sj=i-j+1,sk=i-k+1;//\u628a\u4e24\u6761\u8def\u5f84\u7684\u7ec8\u70b9\u5750\u6807\u7b97\u51fa\u6765\n                int p=a[j][sj];\n                if (sj!=sk && j!=k) p+=a[k][sk];\n                f[i][j][k]=max(f[i][j][k],\n                           max(f[i-1][j][k]+p,\n                           max(f[i-1][j-1][k-1]+p,\n                           max(f[i-1][j-1][k]+p,\n                               f[i-1][j][k-1]+p))));//\u8f6c\u79fb\n            }\n        }\n    cout<<f[maxn][n][n]<<'\\n';\n    return 0;\n}\n```\n",
        "postTime": 1660993658,
        "uid": 253608,
        "name": "Tx_Lcy",
        "ccfLevel": 7,
        "title": "CF213C Relay Race"
    },
    {
        "content": "\u8003\u8651\u6734\u7d20 DP\u3002\u5b9a\u4e49 $f_{i,j,i2,j2}$ \u8868\u793a\u4e24\u4e2a\u4eba\u5206\u522b\u5728 $(i,j),(i2,j2)$ \u65f6\u83b7\u5f97\u7684\u6700\u5927\u6536\u76ca\u3002\u590d\u6742\u5ea6 $O(n^4)$\uff0c\u4e0d\u884c\u3002\n\n\u6211\u4eec\u6362\u79cd\u65b9\u6cd5\uff0c\u5b9a\u4e49 $f_{st,x,y}$ \u8868\u793a\u4e24\u4eba\u540c\u65f6\u8d70\u4e86 $st$ \u6b65\uff0c\u5206\u522b\u5411\u53f3\u8d70\u4e86 $x,y$ \u6b65\u3002\u663e\u7136\u5982\u679c\u5411\u53f3\u7684\u6b65\u6570\u786e\u5b9a\u4e86\uff0c\u5411\u4e0b\u7684\u4e5f\u786e\u5b9a\u4e86\u3002\n\n\u8f6c\u79fb\u65b9\u7a0b\u5982\u4e0b\uff1a\n\n$$f_{st,x,y}=\\max(f_{st-1,x,y},f_{st-1,x-1,y},f_{st-1,x,y-1},f_{st-1,x-1,y-1})+a_{i,j}+a_{i2,j2}-(x==y)\\cdot a_{i,j}$$\n\n\u590d\u6742\u5ea6 $O(n^3)$\u3002\u6ce8\u610f\u8fb9\u754c\u3002\n\ncode\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=50+5;\nint n,m,f[N*2][N][N],a[N][N];\nint main(){\n  ios::sync_with_stdio(false);cin.tie(0);cout.tie(0);\n  cin>>m>>n;\n  for(int i=1;i<=m;++i){\n    for(int j=1;j<=n;++j){\n      cin>>a[i][j];\n    }\n  }\n  memset(f,~0x3f,sizeof(f));\n  f[0][0][0]=a[1][1];\n  for(int st=1;st<=n+m-2;++st){\n    for(int x=max(st-m+1,0);x<=min(n-1,st);++x){\n      for(int y=max(st-m+1,0);y<=min(n-1,st);++y){\n        int i=st-x+1,j=x+1,i2=st-y+1,j2=y+1;\n        f[st][x][y]=f[st-1][x][y];\n        if(x)f[st][x][y]=max(f[st][x][y],f[st-1][x-1][y]);\n        if(y)f[st][x][y]=max(f[st][x][y],f[st-1][x][y-1]);\n        if(x&&y)f[st][x][y]=max(f[st][x][y],f[st-1][x-1][y-1]);\n        f[st][x][y]+=a[i][j]+a[i2][j2];\n        if(x==y)f[st][x][y]-=a[i][j];\n      }\n    }\n  }\n  cout<<f[n+m-2][n-1][n-1]<<endl;\n  return 0;\n}\n\n```\n",
        "postTime": 1684378881,
        "uid": 173864,
        "name": "EstasTonne",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF213C"
    },
    {
        "content": "\u9996\u5148\uff0c\u53d1\u73b0\u95ee\u9898\u7b49\u4ef7\u4e8e\u7ef4\u62a4\u4e24\u4e2a\u70b9\u4ece\u5de6\u4e0a\u89d2\u8d70\u5230\u53f3\u4e0b\u89d2\u7684\u8def\u5f84\u5e76\u7684\u4ef7\u503c\u548c\uff0c\u8003\u8651\u66b4\u529b dp\uff0c\u8bbe $f_{i,j,k,l}$ \u8868\u793a\u7b2c\u4e00\u4e2a\u70b9\u8d70\u5230\u4e86 $(i,j)$\uff0c\u7b2c\u4e8c\u4e2a\u70b9\u8d70\u5230\u4e86 $(k,l)$\uff0c\u76f4\u63a5\u8fd9\u6837\u505a\u7684\u590d\u6742\u5ea6\u662f $O(n^4)$\uff0c\u4e0d\u96be\u53d1\u73b0\uff0c\u5728\u6ca1\u4e00\u6b65\u65f6\u7684\u72b6\u6001\u6570\u5b9e\u9645\u4e0a\u662f $O(n)$ \u7ea7\u522b\u7684\u4e14\u90fd\u5728\u4e00\u6761\u5bf9\u89d2\u7ebf\u4e0a\uff0c\u90a3\u4e48\uff0c\u8003\u8651\u76f4\u63a5\u679a\u4e3e\u5f53\u524d\u662f\u7b2c\u51e0\u6b65\uff0c\u4e24\u6761\u8def\u7ebf\u5206\u522b\u8d70\u5230\u7684\u4f4d\u7f6e\u7684\u7eb5\u5750\u6807\uff0c\u6a2a\u5750\u6807\u53ef\u4ee5\u76f4\u63a5\u7b97\u51fa\u6765\uff0c\u76f4\u63a5\u8f6c\u79fb\u5373\u53ef\u3002\u53ef\u80fd\u8fb9\u754c\u60c5\u51b5\u6709\u4e9b\u591a\uff0c\u5177\u4f53\u5b9e\u73b0\u53ef\u4ee5\u770b\u4ee3\u7801\u3002\n\n[Code](https://codeforces.com/contest/213/submission/202732748)",
        "postTime": 1681921716,
        "uid": 360977,
        "name": "541forever",
        "ccfLevel": 0,
        "title": "CF213C"
    },
    {
        "content": "~~\uff1f~~\n\n\u4f20\u7eb8\u6761\uff0c\u4f46\u662f $O(n^4)$ \u8fc7\u4e0d\u4e86\u3002\n\n\u8003\u8651 $O(n^4)$ \u505a\u6cd5\u7684\u72b6\u6001\uff1a$f_{i,j,k,l}$ \u8868\u793a\u4e24\u4e2a\u4eba\u5206\u522b\u8d70\u5230 $(i,j),(k,l)$ \u65f6\u7684\u6700\u4f18\u65b9\u6848\u3002\n\n\u5f88\u663e\u7136\u4e24\u4e2a\u4eba\u8d70\u7684\u6b65\u6570\u90fd\u76f8\u540c\uff0c\u6240\u4ee5 $i+j=k+l$\u3002\u6240\u4ee5\u56db\u7ef4\u5b9e\u9645\u4e0a\u6709\u4e00\u7ef4\u53ef\u4ee5\u53bb\u6389\u3002\n\n\u90a3\u65e2\u7136\u53bb\u6389\u4e00\u7ef4\uff0c\u90a3\u5c31\u518d\u5b9a\u4e49\u7684\u597d\u770b\u4e00\u70b9\uff1a$f_{i,j,k}$ \u8868\u793a\u4e24\u4e2a\u4eba\u8d70\u5230\u79bb $(1,1)$ \u70b9\u8ddd\u79bb $i$\uff0c\u6a2a\u5750\u6807\u5206\u522b\u4e3a $j,k$ \u7684\u6700\u4f18\u65b9\u6848\u3002\u8ddd\u79bb\u8868\u793a\u4e24\u4e2a\u65b9\u683c\u6700\u77ed\u8def\u4e0a\u65b9\u683c\u6570 $+1$\uff0c\u8fd9\u91cc $+1$ \u53ef\u4ee5\u66f4\u65b9\u4fbf\u7684\u5904\u7406\u5750\u6807\u7684\u95ee\u9898\u3002\n\n\u8f6c\u79fb\uff1a\n\n$$\nf_{i,j,k}=\\max(f_{i-1,j,k},f_{i-1,j,k-1},f_{i-1,j-1,k},f_{i-1,j-1,k-1})+\n\\begin{cases}\na_{j,i-j}&if&j=k\\\\\na_{j,i-j}+a_{k,i-k}&if&j\\neq k\n\\end{cases}\n$$\n\n\u521d\u59cb $f_{2,1,1}=a_{1,1}$\uff0c\u5176\u4ed6\u5730\u65b9\u90fd\u4e3a $-\\inf$\u3002\u7b54\u6848\u53d6 $f_{2n,n,n}$\u3002\n\n```cpp\n//CF213C\n#include <bits/stdc++.h>\nusing namespace std;\n\nconst int N = 310;\nint n, a[N][N], f[N*2][N][N];\n\nint main(){\n\tscanf(\"%d\", &n);\n\tfor(int i = 1; i <= n; ++ i){\n\t\tfor(int j = 1; j <= n; ++ j){\n\t\t\tscanf(\"%d\", &a[i][j]);\n\t\t}\n\t}\n\tmemset(f, 0xcf, sizeof(f));\n\tf[2][1][1] = a[1][1];\n\tfor(int i = 3; i <= n + n; ++ i){\n\t\tfor(int j = 1; j <= n; ++ j){\n\t\t\tfor(int k = 1; k <= n; ++ k){\n\t\t\t\tif(j == k){\n\t\t\t\t\tf[i][j][k] = max(max(f[i-1][j][k], f[i-1][j-1][k-1]), \n\t\t\t\t\t\t\t\t\t max(f[i-1][j-1][k], f[i-1][j][k-1])) + a[j][i-j];\n\t\t\t\t} else {\n\t\t\t\t\tf[i][j][k] = max(max(f[i-1][j][k], f[i-1][j-1][k-1]), \n\t\t\t\t\t\t\t\t\t max(f[i-1][j-1][k], f[i-1][j][k-1])) + a[j][i-j] + a[k][i-k];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\", f[n+n][n][n]);\n\treturn 0;\n}\n```",
        "postTime": 1679899454,
        "uid": 390770,
        "name": "AiRC0S",
        "ccfLevel": 0,
        "title": "\u63a5\u529b\u8d5b \u661f\u53f7 \u4e24\u5343\u4e00"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://codeforces.com/problemset/problem/213/C)\n## \u9898\u610f\n\u8f93\u5165\u4e00\u4e2a $n\\times n$ \u7684\u77e9\u5f62\uff0c\u6bcf\u4e2a $a_{i,j}$ \u662f\u8fd9\u4e2a\u4f4d\u7f6e\u7684\u4ef7\u503c\uff0c\u73b0\u4ece\u5de6\u4e0a\u89d2\u8d70\u5230\u53f3\u4e0b\u89d2\u518d\u8fd4\u56de\uff0c\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u503c\u53ea\u80fd\u8ba1\u7b97\u4e00\u6b21\uff0c\u6c42\u6700\u5927\u4ef7\u503c\u548c\u3002\n## \u601d\u8def\n\u8ddf\u65b9\u683c\u53d6\u6570\u5dee\u4e0d\u591a\uff0c\u4ece\u5de6\u4e0a\u89d2\u8d70\u5230\u53f3\u4e0b\u89d2\u518d\u8fd4\u56de\u548c\u4ece\u5de6\u4e0a\u89d2\u8d70\u5230\u53f3\u4e0b\u89d2\u4e24\u6b21\u662f\u7b49\u4ef7\u7684\u3002\u8fd9\u9898\u660e\u663e\u662f\u4e00\u4e2a dp\uff0c\u6700\u66b4\u529b\u7684\u505a\u6cd5\u662f\u56db\u91cd\u5faa\u73af\u679a\u4e3e\u7b2c\u4e00\u6b21\u8d70\u7684 $i,j$ \u548c\u7b2c\u4e8c\u6b21\u8d70\u7684 $i,j$\u3002\u4f46\u662f $n \\leq 300$\uff0c\u65f6\u95f4\u548c\u7a7a\u95f4\u90fd\u4e0d\u5141\u8bb8\uff0c\u4e8e\u662f\u8003\u8651\u4f18\u5316\u3002\n\n\u8bbe $dp_{l,i,j}$ \u8868\u793a\u6a2a\u5750\u6807\u548c\u7eb5\u5750\u6807\u4e4b\u548c\u4e3a $l$\uff0c\u4e5f\u5c31\u662f\u8d70\u4e86 $l-1$ \u4e2a\u683c\u5b50\uff0c\u7b2c\u4e00\u6b21\u7684\u6a2a\u5750\u6807\u4e3a $i_1$\uff0c\u7b2c\u4e8c\u6b21\u7684\u6a2a\u5750\u6807\u4e3a $i_2$\uff0c\u4e24\u6b21\u7684\u7eb5\u5750\u6807 $j_1,j_2$ \u5206\u522b\u4e3a $l-i_1$ \u548c $l-i_2$\u3002\u7136\u540e\u5c31\u53ef\u4ee5\u8fdb\u884c\u8f6c\u79fb\u4e86\uff0c\u6bcf\u6b21\u53ea\u80fd\u5411\u53f3\u6216\u5411\u4e0b\u8d70\u4e00\u683c\uff0c\u6240\u4ee5\u8f6c\u79fb\u65b9\u7a0b\u5c31\u4e3a\n$$dp_{i1,i2}=\\max(dp_{l-1,i_1-1,i_2},dp_{l-1,i_1,i_2-1},dp_{l-1,i_1-1,i_2-1},dp_{l-1,i_1,i_2})+a_{i_1,l-i_1}+a_{i_2,l-i_2}$$\n\u6700\u540e\u6ce8\u610f\u4e24\u6b21\u8d70\u5230\u540c\u4e00\u4e2a\u683c\u5b50\u4e0a\u65f6\u8fd9\u4e2a\u683c\u5b50\u7684\u4ef7\u503c\u53ea\u80fd\u8ba1\u7b97\u4e00\u6b21\uff0c\u7279\u5224\u4e00\u4e0b\u5c31\u597d\u4e86\u3002\n## AC\u4ee3\u7801\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\ninline int read(){\n\tint f=1,sum=0;\n\tchar ch=getchar();\n\twhile(!isdigit(ch)){\n\t\tif(ch=='-') f=-1;\n\t\tch=getchar();\n\t}\n\twhile(isdigit(ch)){\n\t\tsum=sum*10+ch-'0';\n\t\tch=getchar();\n\t}\n\treturn f*sum;\n}\ninline void write(int x){\n\tif(x<0){\n\t\tputchar('-');\n\t\tx=-x;\n\t}\n\tif(x>9) write(x/10);\n\tputchar(x%10+'0');\n}\nint n,mp[304][304],dp[604][304][304];\nint cal(int l,int i1,int j1,int i2,int j2){//\u8f6c\u79fb\n\tint _1=dp[l-1][i1-1][i2-1];\n\tint _2=dp[l-1][i1-1][i2];\n\tint _3=dp[l-1][i1][i2-1];\n\tint _4=dp[l-1][i1][i2];\n\tif(i1==i2&&j1==j2) return max(_1,max(_2,max(_3,_4)))+mp[i1][j1];\n\treturn max(_1,max(_2,max(_3,_4)))+mp[i1][j1]+mp[i2][j2];\n}\nint main(){\n\tn=read();\n\tmemset(dp,-0x3f,sizeof(dp));//\u56e0\u4e3a\u6709\u8d1f\u6570\u6240\u4ee5\u8981\u521d\u59cb\u5316\u4e3a\u8d1f\u65e0\u7a77\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tmp[i][j]=read();\n\t\t}\n\t}\n\tdp[1][0][0]=dp[1][1][0]=dp[1][0][1]=dp[1][1][1]=0;//\u521d\u59cb\u5316\n\tfor(int l=1;l<=2*n;l++){\n\t\tfor(int i1=1;i1<=n;i1++){\n\t\t\tfor(int i2=1;i2<=n;i2++){\n\t\t\t\tint j1=l-i1,j2=l-i2;\n\t\t\t\tif(j1<=0||j2<=0) break;\n\t\t\t\tdp[l][i1][i2]=max(dp[l][i1][i2],cal(l,i1,j1,i2,j2));\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\",dp[2*n][n][n]);\n\treturn 0;\n}\n```\n",
        "postTime": 1674720669,
        "uid": 372040,
        "name": "Fhr123456",
        "ccfLevel": 0,
        "title": "CF213C Relay Race\u9898\u89e3"
    },
    {
        "content": "\u9898\u76ee\u4e2d\u8bf4 Furik \u548c Rubik \u8d70\u7684\u662f\u76f8\u53cd\u7684\u9053\u8def\u3002\u5176\u5b9e\u6211\u4eec\u5927\u4e0d\u5fc5\u8fd9\u4e48\u590d\u6742\uff0c\u56e0\u4e3a\u5982\u679c Rukik \u662f\u4ece $1,1$ \u8d70\u5230 $n,n$ \u90a3\u4e5f\u4e00\u6837\u3002\u6240\u4ee5\u4e24\u4e2a\u4eba\u76f8\u5f53\u4e8e\u540c\u65f6\u4ece $1,1$ \u8d70\u5230 $n,n$\u3002\n\n\u4e00\u4e2a\u5f88\u663e\u7136\u7684\u53d1\u73b0\uff1a\u4e24\u4eba\u540c\u65f6\u8d70\u5230\u4e00\u4e2a\u683c\u5b50\u53ea\u4f1a\u5728\u4e24\u4eba\u6b65\u6570\u76f8\u540c\u65f6\u53d1\u751f\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u91c7\u7528 [\u4f20\u7eb8\u6761](https://www.luogu.com.cn/problem/P1006) \u8fd9\u9898\u540c\u6837\u7684\u5957\u8def\uff0c\u5199\u51fa\u72b6\u6001 $f(k,i,j)$ \u8868\u793a\u4e24\u4eba\u8d70\u4e86 $k$ \u6b65\uff0c\u7b2c\u4e00\u4e2a\u4eba\u8d70\u5230\u4e86\u7b2c $i$ \u884c\uff0c\u7b2c\u4e8c\u4e2a\u4eba\u8d70\u5230\u4e86\u7b2c $j$ \u884c\u7684\u6700\u5927\u4ef7\u503c\u548c\u3002\u5f88\u660e\u663e\uff0c\u8fd9\u65f6\uff0c\u7b2c\u4e00\u4e2a\u4eba\u5728 $(i,j-i)$\uff0c\u7b2c\u4e8c\u4e2a\u4eba\u5728 $(j,k-j)$\uff0c\u4e8e\u662f\u6211\u4eec\u770b\u4e00\u4e0b\u662f\u5426\u7b26\u5408\u8981\u6c42\uff0c\u7136\u540e\u8ba1\u7b97\u4e00\u4e0b\u4ef7\u503c\u5373\u53ef\u3002\u51b3\u7b56\u4e3a\u679a\u4e3e\u4e0b\u4e00\u6b65\u4e24\u4eba\u5f80\u54ea\u91cc\u8d70\u3002\n\n$f(k,i,j)\\to f(k+1,i+1,j), f(k+1,i,j+1),f(k+1,i,j),f(k+1,i+1,j+1)$\u3002\n\n\uff08\u4e3a\u4e86\u65b9\u4fbf\uff0c\u7a0b\u5e8f\u4e2d\u5b9a\u4e49\u4e3a\u8d70\u5230\u8fd9\u4e24\u4e2a\u70b9\uff0c\u4e0d\u7b97\u4e0a\u8fd9\u4e24\u4e2a\u70b9\u6240\u83b7\u5f97\u7684\u4ef7\u503c\u7684\u6700\u5927\u503c\uff09\n\n```cpp\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(register int i=(a);i<=(b);i++)\n#define per(i,a,b) for(register int i=(a);i>=(b);i--)\nusing namespace std;\nconst int N=309;\n\ninline int read() {\n    register int x=0, f=1; register char c=getchar();\n    while(c<'0'||c>'9') {if(c=='-') f=-1; c=getchar();}\n    while(c>='0'&&c<='9') {x=(x<<3)+(x<<1)+c-48,c=getchar();}\n    return x*f;\n}\n\nint n,a[N][N],f[N<<1][N][N];\n\nvoid upd(int &x,int y) {x=max(x,y);}\n\nint main() {\n\tn=read();\n\trep(i,1,n) rep(j,1,n) a[i][j]=read();\n\tmemset(f,-0x3f,sizeof(f));\n\tf[1][1][1]=0;\n\trep(k,1,2*n-1) {\n\t\trep(i,max(1,1+k-n),min(k,n)) {\n\t\t\trep(j,max(1,1+k-n),min(k,n)) {\n\t\t\t\tint val=(i==j?a[i][k-i+1]:a[i][k-i+1]+a[j][k-j+1])+f[k][i][j];\n\t\t\t\tupd(f[k+1][i][j],val),\n\t\t\t\tupd(f[k+1][i+1][j],val),\n\t\t\t\tupd(f[k+1][i][j+1],val),\n\t\t\t\tupd(f[k+1][i+1][j+1],val);\n\t\t\t}\n\t\t}\n\t}\n\tprintf(\"%d\\n\",f[2*n-1][n][n]+a[n][n]);\n\treturn 0;\n} \n```",
        "postTime": 1606728431,
        "uid": 180652,
        "name": "_lgswdn",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF213C \u3010Relay Race\u3011"
    },
    {
        "content": "Relay Race\n\n\u9ad8\u7ea7\u7248\u7684\u65b9\u683c\u53d6\u6570\uff0c\u591a\u4e86\u8d1f\u6570\u7684\u5904\u7406\u4ee5\u53ca\u66f4\u5927\u7684\u6570\u636e\u3002\n\n\u53ef\u4ee5\u770b\u505a\u4ece\u8d77\u70b9\u5f00\u59cb\u8d70\u4e24\u6b21\u5230\u7ec8\u70b9\u3002\n\n\u6700\u66b4\u529b\u7684\u65b9\u6cd5\u662f\u5b9a\u4e49\u72b6\u6001 $f_i,_j,_p,_q$ \u8868\u793a\u7b2c\u4e00\u6b21\u8d70\u5230 $(i,j)$ \u7b2c\u4e8c\u6b21\u8d70\u5230 $(p,q)$ \u7684\u6700\u5927\u5f97\u5206\u3002\n\n\u6613\u5f97\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$f_i,_j,_p,_q=\\max\\begin{cases}f_{i-1},_j,_{p-1},_q\\\\f_{i-1},_j,_p,_{q-1}\\\\f_i,_{j-1},_{p-1},_q\\\\f_i,_{j-1},_p,_{q-1}\\end{cases}+a_i,_j+a_p,_q$$\n\n\u5982\u679c $(i,j)$ \u548c $(p,q)$ \u91cd\u5408\u7684\u8bdd\u53ea\u8ba1\u7b97\u4e00\u6b21\u3002\n\n\u5f53\u7136\u6211\u4e5f\u6ca1\u8bd5\u8fd9\u79cd\u65b9\u6cd5\uff0c\u7b2c\u4e00\u5b83\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^4)$ \uff0c\u7b2c\u4e8c\u5b83\u7684\u5185\u5b58\u76f4\u63a5\u7206\u4e86(\u672c\u673a\u8fd0\u884c\u90fd\u5f00\u4e0d\u4e868.1e9\u4e2along long) \u3002\n\n\u6240\u4ee5\u6211\u4eec\u4f18\u5316\u4e00\u4e0b\u72b6\u6001\uff0c\u5f88\u5bb9\u6613\u53d1\u73b0\u5982\u679c\u4e24\u6b21\u8d70\u4e86\u76f8\u540c\u7684\u6b65\u6570\uff0c\u90a3\u4e48\u5230\u8fbe\u5750\u6807\u7684\u6a2a\u7eb5\u5750\u6807\u4e4b\u548c\u76f8\u7b49\u3002\n\n\u90a3\u4e48\u5b9a\u4e49\u72b6\u6001 $f_i,_j,_k$ \u8868\u793a\u7b2c\u4e00\u6b21\u8d70\u5230 $(i,j)$ \uff0c\u7b2c\u4e8c\u6b21\u8d70\u5230\u7b2c $k$ \u884c\u7684\u6700\u5927\u5f97\u5206\u3002\n\n\u663e\u7136\u7b2c\u4e8c\u6b21\u8d70\u7684\u7eb5\u5750\u6807\u5c31\u662f $i+j-k$ \u3002\n\n\u90a3\u4e48\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$f_i,_j,_k=\\max\\begin{cases}f_{i-1},_j,_k\\\\f_{i-1},_j,_{k-1}\\\\f_i,_{j-1},_k\\\\f_i,_{j-1},_{k-1}\\end{cases}+a_i,_j+a_k,_{i+j-k}$$\n\n\u540c\u6837\uff0c\u5982\u679c $(i,j)$ \u548c $(k,i+j-k)$ \u91cd\u5408\u5219\u53ea\u8ba1\u7b97\u4e00\u6b21\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3)$ \u3002\n\n\u5f53\u7136\u6709\u4e00\u4e9b\u66f4\u52a0\u4f18\u79c0\u7684\u505a\u6cd5\uff0c\u4e0d\u8fc7\u5495\u5495\u5495\u5495\u5495\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\n#include<queue>\n#include<stack>\n#include<cstring>\n#include<vector>\n#include<bitset>\n#define ll long long\nusing namespace std;\n\nll n;\n\nll a[305][305],f[305][305][305];\n\ninline ll read() {\n\tll ret=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9') {if(ch=='-') f=-f;ch=getchar();}\n\twhile(ch>='0'&&ch<='9') {ret=(ret<<3)+(ret<<1)+ch-'0';ch=getchar();}\n\treturn ret*f;\n}\n\nvoid write(ll x) {\n\tif(x<0) {x=-x;putchar('-');}\n\tif(x>9) write(x/10);\n\tputchar(x%10+48);\n}\n\nint main() {\n\t\n\tn=read();\n\t\n\tfor(int i=1;i<=n;i++) {\n\t\tfor(int j=1;j<=n;j++) {\n\t\t\ta[i][j]=read();\n\t\t}\n\t}\n\t\n\tmemset(f,-0x3f,sizeof(f));f[1][1][1]=a[1][1]+a[1][1];\n\t\n\tfor(int i=1;i<=n;i++) {\n\t\tfor(int j=1;j<=n;j++) {\n\t\t\tfor(int k=1;k<=n&&k<=i+j-1;k++) {\n\t\t\t\tif(i-1>=1&&k-1>=1) f[i][j][k]=max(f[i][j][k],f[i-1][j][k-1]+a[i][j]+a[k][i+j-k]);\n\t\t\t\tif(i-1>=1&&i+j-k-1>=1) f[i][j][k]=max(f[i][j][k],f[i-1][j][k]+a[i][j]+a[k][i+j-k]);\n\t\t\t\tif(j-1>=1&&k-1>=1) f[i][j][k]=max(f[i][j][k],f[i][j-1][k-1]+a[i][j]+a[k][i+j-k]);\n\t\t\t\tif(j-1>=1&&i+j-k-1>=1) f[i][j][k]=max(f[i][j][k],f[i][j-1][k]+a[i][j]+a[k][i+j-k]);\n\t\t\t\tif(i==k&&j==i+j-k) f[i][j][k]-=a[i][j];\n\t\t\t}\n\t\t}\n\t}\n\t\n\twrite(f[n][n][n]);\n\t\n\treturn 0;\n}\n```\n",
        "postTime": 1602850371,
        "uid": 154279,
        "name": "Apolynth",
        "ccfLevel": 0,
        "title": "CF213C"
    }
]
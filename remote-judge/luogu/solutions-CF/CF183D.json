[
    {
        "content": "## \u4e00\u3001\u9898\u76ee\n![](https://imgconvert.csdnimg.cn/aHR0cHM6Ly9jZG4ubHVvZ3Uub3JnL3VwbG9hZC9waWMvNzQ0NzcucG5n?x-oss-process=image/format,png)\n\n## \u4e8c\u3001\u89e3\u6cd5\n\u7f51\u4e0a\u7684\u9898\u89e3\u8c8c\u4f3c\u5b66\u5f97\u4e0d\u662f\u5f88\u6e05\u695a\uff08\u53cd\u6b63\u849f\u84bb\u4f5c\u8005\u662f\u5f88\u96be\u770b\u61c2\u7684\uff09\uff0c\u6211\u5c31\u6765\u8865\u4e00\u53d1\u8be6\u7ec6\u9898\u89e3\u5427\u3002\n\n**0x01 \u66b4\u529bdp**\n\n~~\u671f\u671b\u7684\u9898\u597d\u50cf\u66b4\u529b\u90fd\u5f88\u96be\u5199~~ \u3002\n\n\u8bbe$f[i][j][k]$\u8868\u793a\u524d$i$\u4e2a\u4eba\uff0c\u6709$j$\u4e2a\u4eba\u559c\u6b22\u7b2c$k$\u4ef6\u8863\u670d\u7684\u6982\u7387\uff0c\u5219\u6709\u8f6c\u79fb\uff1a\n\n$f[i][j][k]=f[i-1][j-1][k]*p[i][k]+f[i-1][j][k]*(1-p[i][k])$\n\n$p[i][k]$\u8868\u793a\u7b2c$i$\u4e2a\u4eba\u559c\u6b22\u7b2c$k$\u4ef6\u8863\u670d\u7684\u6982\u7387\u3002\n\n\u8bbe$g[i][k]$\u8868\u793a\u51c6\u5907\u4e86$i$\u4ef6\u7b2c$k$\u79cd\u8863\u670d\uff0c\u9001\u51fa\u8863\u670d\u7684\u671f\u671b\uff0c\u90a3\u4e48\uff1a\n\n$g[i][k]=\\sum_{j=0}^{i} j*f[n][j][k]+i*\\sum_{j=i+1}^{n} f[n][j][k]$\n\u7136\u540e\u5bf9$g$\u6570\u7ec4\u8fdb\u884c\u80cc\u5305\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6$O(n^{2}m)$\u3002\n\n**0x02 \u4f18\u5316**\n\n\u9996\u5148\u6709\u4e00\u4e2a\u5f0f\u5b50\uff1a\n\n$\\sum_{i=0}^{n} f[n][i][k]=1$\uff08\u4f3c\u4e4e\u5f88\u663e\u7136\uff0c\u4f46\u540e\u9762\u7684\u53d8\u5316\u8981\u7528\u5230\uff09\n\n\u89c2\u5bdf$g$\u6570\u7ec4\uff0c\u5bf9\u5b83\u505a\u5dee\uff1a\n\n$g[i+1][k]-g[i][k]=\\sum_{j=i+1}^{n} f[n][j][k]=1-\\sum_{j=1}^{i}f[n][j][k]$\n\n\u53d1\u73b0$g$\u6570\u7ec4\u662f\u5355\u8c03\u9012\u589e\u7684\uff0c\u4e14\u968f\u7740$i$\u7684\u589e\u5927\uff0c\u4ed6\u4eec\u7684\u5dee\u5355\u8c03\u53d8\u5c0f\u3002\n\n\u8fd9\u5c31\u7ed9\u4e86\u6211\u4eec\u8d2a\u5fc3\u7684\u4f9d\u636e\uff0c\u6211\u4eec\u53ea\u9700\u8981\u9009\u5dee\u6700\u5927\u7684$g$\uff0c\u628a\u5b83\u52a0\u5165\u7b54\u6848\u5373\u53ef\u3002\n\n\u4f46\u662f\u6211\u4eec\u4ecd\u9700\u5bf9$f$\u6570\u7ec4\u8fdb\u884c\u4f18\u5316\uff0c\u7531\u4e8e\u671f\u671b\u7684\u7ebf\u6027\u6027\uff0c\u4e0d\u540c\u7684\u7269\u54c1\u662f\u4e92\u4e0d\u76f8\u5173\u7684\uff08\u770b$dp$\u5f0f\u4e5f\u770b\u5f97\u51fa\u6765\uff09\uff0c\u6709\u4e00\u4e9b\u4e0d\u4f18\u7684\u7269\u54c1\u5c31\u4e0d\u9700\u8981\u628a\u5b83\u7684$dp$\u5168\u90e8\u5904\u7406\u51fa\u6765\uff08\u7528\u591a\u5c11\u7b97\u591a\u5c11\uff09\u3002\n\n\u4e8e\u662f\u6211\u4eec\u91cd\u65b0\u5b9a\u4e49$dp$\uff0c\u8bbe$f[i][j]$\u4e3a\u5bf9\u4e8e\u7b2c$i$\u4ef6\u8863\u670d\uff0c\u524d$j$\u4eba\u6709$cnt[i]$\u4e2a\u4eba\u559c\u6b22\u7684\u6982\u7387\uff08\u8f6c\u79fb\u7528\u6eda\u52a8\u6570\u7ec4\uff09\uff0c$g[i]$\u4e3a\u51c6\u5907\u4e86$cnt[i]$\u4ef6\u7b2c$i$\u79cd\u8863\u670d\uff0c\u9001\u51fa\u7684\u671f\u671b\uff0c\u8f6c\u79fb\u662f\u6ce8\u610f\u7528\u524d\u7f00\u548c\u4f18\u5316\u4e00\u4e0b\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n^{2}+nm)$\n\n```cpp\n#include <cstdio>\n#include <cstring>\nconst int MAXN = 3005;\nint read()\n{\n    int num=0,flag=1;char c;\n    while((c=getchar())<'0'||c>'9')if(c=='-')flag=-1;\n    while(c>='0'&&c<='9')num=(num<<3)+(num<<1)+(c^48),c=getchar();\n    return num*flag;\n}\nint n,m,cnt[MAXN];\ndouble ans,p[MAXN][305],dp[305][MAXN];\ndouble delt[MAXN],sv[MAXN],siv[MAXN],val[MAXN];\nvoid updata(int c)\n{\n\tdouble g[MAXN]={};\n\tmemcpy(g,dp[c],sizeof g);\n\tdp[c][0]=0;\n\tfor(int i=1;i<=n;i++)\n\t\tdp[c][i]=dp[c][i-1]*(1-p[i][c])+g[i-1]*p[i][c];\n\tcnt[c]++;\n\tsiv[c]+=cnt[c]*dp[c][n];sv[c]+=dp[c][n];\n\tdouble e=siv[c]+cnt[c]*(1-sv[c]);\n\tdelt[c]=e-val[c];\n\tval[c]=e;\n}\nint main()\n{\n\tn=read();m=read();\n\tfor(int i=1;i<=n;i++)\n\t\tfor(int j=1;j<=m;j++)\n\t\t{\n\t\t\tscanf(\"%lf\",&p[i][j]);\n\t\t\tp[i][j]/=1000.0;\n\t\t}\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tdp[i][0]=1.0;\n\t\tfor(int j=1;j<=n;j++)\n\t\t\tdp[i][j]=dp[i][j-1]*(1-p[j][i]);\n\t\tsv[i]=dp[i][n];\n\t\tupdata(i);\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint Max=0;\n\t\tfor(int j=1;j<=m;j++)\n\t\t\tif(delt[Max]<delt[j])\n\t\t\t\tMax=j;\n\t\tif(!Max) break;\n\t\tans+=delt[Max];\n\t\tupdata(Max);\n\t}\n\tprintf(\"%.12lf\",ans);\n}\n```\n\n",
        "postTime": 1566615211,
        "uid": 128239,
        "name": "C20203030",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF183D \u3010T-shirt\u3011"
    },
    {
        "content": "\u5514...\u597d\u9898...\u5c31\u662f\u6211\u6709\u70b9\u8822\uff1a\u56e0\u4e3a\u6bcf\u4e2a\u4eba\u53ea\u80fd\u9009\u4e00\u79cd\u5927\u5c0f\uff0c\u6240\u4ee5\u6211\u4ee5\u4e3a\u989c\u8272\u4e4b\u95f4\u7684\u8d21\u732e\u4e0d\u662f\u72ec\u7acb\u7684\uff08\u6bd5\u7adf\u9009\u4e86\u4e00\u79cd\u5c31\u4e0d\u80fd\u9009\u53e6\u4e00\u79cd\u4e86\uff09\uff0c\u540e\u6765\u53d1\u73b0\u8fd9\u4e2a\u60f3\u6cd5\u662f\u591a\u4f59\u7684\uff0c\u76f4\u63a5\u6b7b\u6263\u671f\u671b\u7684\u7ebf\u6027\u6027\u5c31\u884c\u3002\n\n\u7136\u540e\u8003\u8651\u7b2ci\u79cd\u8863\u670d\u5e26j\u4ef6\u7684\u8d21\u732e\u3002\u6211\u4eec\u53ef\u4ee5DP\u7b97\u51fa\u7b2ci\u79cd\u8863\u670d\u9700\u8981j\u4ef6\u7684\u6982\u7387\uff0c\u4ece\u800c\u8ba1\u7b97\u51fa\u5e26j\u4ef6\u7684\u8d21\u732e\uff0c\u7136\u540e\u8dd1\u5206\u7ec4\u80cc\u5305\u5373\u53ef\u3002\n\nDP\u72b6\u6001\u662f3\u7ef4\u7684\uff1a$f[w][i][j]$\u8868\u793a\u7b2cw\u79cd\uff0c\u8003\u8651\u524di\u4e2a\u4eba\uff0c\u9700\u8981j\u4e2a\u7684\u6982\u7387\u3002\n\n$$f[i][j]=f[i-1][j-1]p+f[i-1][j](1-p)$$\n\n\u76f4\u63a5DP\u662f$O(mn^2)$\u7684\uff0c\u4f46\u662f\u6211\u4eec\u4e0d\u9700\u8981\u628a\u6240\u6709\u7684\u90fdDP\u51fa\u6765\u3002\u6211\u4eec\u8863\u670d\u662f\u4e00\u4ef6\u4ef6\u9009\u7684\uff0c\u6bcf\u6b21\u9009\u6743\u503c\u6700\u5927\u7684\uff0c\u9009\u5b8c\u4e86\u4e4b\u540e\u6211\u4eec\u628aj\u5f80\u4e0a\u63a8\u4e00\u7ef4\u5373\u53ef\uff0c\u590d\u6742\u5ea6$O(n(n+m))$\n\n\u6b63\u786e\u6027\u662f\u56e0\u4e3a\u8fd9\u4e2aDP\u662f\u51f8\u7684\n\n```cpp\nconst int N=3005,M=305;\nint n,m;\ndouble p[N][M];\ndouble f[M][N];\ndouble sv[M],siv[M],val[M],dt[M];\nint cnt[M];\nvoid upd(int c)\n{\n\tstatic double g[N];\n\tmemcpy(g,f[c],sizeof(g));\n\tf[c][0]=0;\n\tfor(ri i=1;i<=n;++i)\n\t\tf[c][i]=f[c][i-1]*(1-p[i][c])+g[i-1]*p[i][c];\n\t++cnt[c];\n\tsv[c]+=f[c][n],siv[c]+=cnt[c]*f[c][n];\n\tdouble nv=siv[c]+cnt[c]*(1-sv[c]);\n\tdt[c]=nv-val[c];\n\tval[c]=nv;\n}\nsigned main()\n{\n#ifdef M207\n\tfreopen(\"in.in\",\"r\",stdin);\n#endif\n\tin(n),in(m);\n\tfor(ri i=1,t;i<=n;++i)\n\t\tfor(ri j=1;j<=m;++j)\n\t\t{\n\t\t\tin(t);\n\t\t\tp[i][j]=t/1000.0;\n\t\t}\n\tfor(ri i=1;i<=m;++i) \n\t{\n\t\tf[i][0]=1;\n\t\tfor(ri j=1;j<=n;++j) f[i][j]=f[i][j-1]*(1-p[j][i]);\n\t\tsv[i]=f[i][n];\n\t\tupd(i);\n\t}\n\tdouble ans=0;\n\tfor(ri o=1;o<=n;++o)\n\t{\n\t\tdouble mx=-1; int mxk=0;\n\t\tfor(ri i=1;i<=m;++i)\n\t\t\tif(mx<dt[i]) mx=dt[i],mxk=i;\n\t\tif(!mxk) break;\n\t\tans+=dt[mxk];\n\t\tupd(mxk);\n\t}\n\tprintf(\"%.10f\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1561549827,
        "uid": 58302,
        "name": "i207M",
        "ccfLevel": 0,
        "title": "\u671f\u671bDP\u597d\u9898-CF183D T-shirt-\u89e3\u9898\u62a5\u544a"
    },
    {
        "content": "## dp\n\n### \u76f4\u63a5dp\n\n\u6613\u77e5\u4e0d\u540cT\u6064\u4e4b\u95f4\u4e92\u76f8\u72ec\u7acb\u5219\n\u5b9a\u4e49dp[i][j][h]\u4e3a\u7b2ci\u79cdT\u6064\u524dj\u4e2a\u4eba\u91cc\u9001\u51fah\u4e2a\u7684\u6982\u7387\n\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e3a:\n$$dp[i][j][h] = dp[i][j - 1][h - 1] * p[j][i] + dp[i][j - 1][h] * (1 - p[j][i])$$\n\u5b9a\u4e49E[i][j]\u4e3a\u7b2ci\u79cdT\u6064\u5e26j\u79cd\u5bf9\u7b54\u6848\u8d21\u732e\u7684\u671f\u671b\n\u5219\u7531\u5168\u671f\u671b\u516c\u5f0f\u5f97\uff1a\n$$E[i][j] = \\sum_{h = 1}^j(h * dp[i][n][h]) + \\sum_{h = j + 1}^n(j * dp[i][n][h])$$\n\u7136\u540e\u95ee\u9898\u8f6c\u5316\u4e3a\u5206\u7ec4\u80cc\u5305\u6c42\u89e3\n\u65f6\u95f4\u590d\u6742\u5ea6O($n^2m$)\n\n### \u4f18\u5316\n\u89c2\u5bdfE\u6570\u7ec4\uff0c\u53d1\u73b0\u5176\u6ee1\u8db3\u4e0a\u51f9\u51fd\u6570\u6027\u8d28\u4e14\uff1a\n$$E[i][j + 1] - E[i][j] = \\sum_{h = j + 1}^ndp[i][n][h] = 1 - \\sum_{h = 1}^jdp[i][n][h]$$\n\u5219\u5b9a\u4e49delt[i]\u4e3a\u5f53\u524d\u72b6\u6001\u4e0b\u591a\u5e26\u4e00\u4ef6i\u79cdT\u6064\u5bf9\u7b54\u6848\u7684\u8d21\u732e\n\u7701\u7565dp\u6570\u7ec4\u7b2c3\u7ef4\u521d\u59cb\u5316\u4e3a\u4e00\u4ef6\u4e0d\u5e26\u7684\u60c5\u51b5\u5e76\u66f4\u65b0delt\u6570\u7ec4\n\u7136\u540e\u4f9d\u6b21\u8d2a\u5fc3\u9009\u53d6\u5f53\u524d\u6240\u5e26T\u6064x\u5e76\u66f4\u65b0delt[x]\u4e0edp[x]\u6570\u7ec4\u5373\u53ef\n\u65f6\u95f4\u590d\u6742\u5ea6O($nm + n^2$)\n\n## \u4ee3\u7801\n\n```language_cpp\n#include<cstdio>\n#include<cstring>\n#include<iomanip>\n#include<iostream>\nusing namespace std;\ntypedef long double ld;\nconst int MAXN = 3000, MAXM = 300;\nint n, m;\nld last[MAXN + 5], delt[MAXM + 5], dp[MAXM + 5][MAXN + 5], p[MAXN + 5][MAXM + 5];\n\ninline void DynamicProgramming(void) {\n\tregister int i, j;\n\t\n\tmemset(delt, 0, sizeof(delt));\n\tmemset(dp, 0, sizeof(dp));\n\tfor(i = 1; i <= m; ++i) {\n\t\tdp[i][0] = 1.;\n\t\tfor(j = 1; j <= n; ++j) {\n\t\t\tdp[i][j] = dp[i][j - 1] * (1. - p[j][i]);\n\t\t}\n\t\tdelt[i] = 1. - dp[i][n];\n\t}\n}\n\ninline void updata(int x) {\n\tregister int i;\n\t\n\tfor(i = 0; i <= n; ++i) {\n\t\tlast[i] = dp[x][i];\n\t} \n\tdp[x][0] = 0.;\n\tfor(i = 1; i <= n; ++i) {\n\t\tdp[x][i] = dp[x][i - 1] * (1. - p[i][x]) + last[i - 1] * p[i][x];  \n\t}\n\tdelt[x] -= dp[x][n];\n}\n\nint main(int argc, char *argv[]) {\n\tregister int i, j;\n\tdouble ans;\n\t\n\twhile( ~scanf(\"%d%d\", &n, &m) ) {\n\t\tans = 0;\n\t\tfor(i = 1; i <= n; ++i) {\n\t\t\tfor(j = 1; j <= m; ++j) {\n\t\t\t\tint tmp;\n\t\t\t\t\n\t\t\t\tscanf(\"%d\", &tmp);\n\t\t\t\t\n\t\t\t\tp[i][j] = (ld)tmp / 1000.;\n\t\t\t}\n\t\t}\n\t\tDynamicProgramming();\n\t\tfor(i = 1; i <= n; ++i) {\n\t\t\tint tmp = 0;\n\t\t\t\n\t\t\tfor(j = 1; j <= m; ++j) {\n\t\t\t\tif(delt[j] > delt[tmp]) {\n\t\t\t\t\ttmp = j;\n\t\t\t\t} \n\t\t\t}\n\t\t\tans += delt[tmp];\n\t\t\tupdata(tmp);\n\t\t}\n\t\t\n\t\tcout << fixed << setprecision(12) << ans << endl; \n\t}\n\t\n\treturn 0;\n}\n```",
        "postTime": 1519896085,
        "uid": 23820,
        "name": "LJZ_C",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF183D \u3010T-shirt\u3011"
    },
    {
        "content": "# \u9898\u76ee\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[\u70b9\u8fd9\u91cc](https://www.luogu.org/problem/CF183D)\u770b\u9898\u76ee\u3002\n# \u5206\u6790\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u4e00\u770b\u5c31\u4e0d\u77e5\u9053\u5982\u4f55\u5165\u624b......  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u597d\u5427~~\u770b\u4e86\u9898\u89e3\u5c31\u77e5\u9053\u4e86~~\uff0c\u8fd9\u662f\u9053$DP$\u9898\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u9996\u5148\u6211\u4eec\u6709\u4e00\u4e2a\u66b4\u529b\u505a\u6cd5\uff0c\u8bbe$f(k,i,j)$\u4e3a\u524d$i$\u4e2a\u4eba\u4e2d\u559c\u6b22\u7b2c$k$\u4ef6\u886c\u886b\u7684\u6709$j$\u4e2a\u4eba\u7684\u6982\u7387\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u5219$f$\u7684\u8f6c\u79fb\u4e3a$f(k,i,j)=p_if(k,i-1,j-1)+(1-p_i)f(k,i-1,j)$\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u518d\u8bbe$g(k,i)$\u8868\u793a\u51c6\u5907$i$\u4ef6\u7b2c$k$\u79cd\u886c\u886b\u7684\u671f\u671b\u9001\u51fa\u6570\u91cf\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u5219$g(k,i)=\\sum_{j=0}^ij\\times f(k,n,j)+i\\times\\sum_{j=i+1}^nf(k,n,j)$  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u8fd9\u4e2a\u65b9\u7a0b\u7684\u610f\u4e49\u662f\uff0c\u5982\u679c\u9001\u51fa\u7684\u6570\u91cf\u5c11\u4e8e\u51c6\u5907\u7684\u6570\u91cf\uff0c\u5219\u6bcf\u79cd\u9001\u51fa\u7684\u6570\u91cf\u7684\u8d21\u732e\u5747\u4e3a\u5176\u9001\u51fa\u6570\u91cf\uff1b\u5426\u5219\uff0c\u5982\u679c\u8863\u670d\u88ab\u9001\u5b8c\u4e86\uff0c\u5219\u8d21\u732e\u4ec5\u4e3a\u51c6\u5907\u7684\u6570\u91cf\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u6b64\u65f6\uff0c\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u7528$g$\u51fd\u6570\u6765\u8dd1\u80cc\u5305\u9a97\u5206\u4e86\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u4e0d\u8fc7\uff0c\u5982\u679c\u4f60\u8ffd\u6c42\u6ee1\u5206\u7684\u8bdd\uff0c\u53ef\u4ee5\u7ee7\u7eed\u770b\u4e0b\u53bb\uff1a  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u6211\u4eec\u5c1d\u8bd5\u5bf9$g$\u7684\u76f8\u90bb\u4e24\u9879\u505a\u5dee\uff1a  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$g(k,i+1)-g(k,i)=\\sum_{j=i+1}^nf(k,n,j)=1-\\sum_{j=0}^if(k,n,j)$  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u7136\u540e\u6211\u4eec\u53d1\u73b0$\\lim_{i\\rightarrow n}\\Delta g=0$\uff0c\u6240\u4ee5\u51fd\u6570$g$\u7684\u589e\u957f\u662f\u9012\u51cf\u7684\u3002  \n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\u7136\u540e\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8d2a\u5fc3\u5730\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff1a\u6bcf\u6b21\u9009\u62e9\u4e00\u79cd\u4f1a\u4f7f\u7b54\u6848\u589e\u957f\u6700\u591a\u7684\u8863\u670d\uff0c\u653e\u5165\u7b54\u6848\u96c6\u5408\u4e2d\uff0c\u540c\u65f6\u6211\u4eec\u53ef\u4ee5\u63a8\u51fa\u8fd9\u79cd\u8863\u670d\u7684$i+1$\u7684\u589e\u957f\u7387\u3002\u91cd\u590d\u76f4\u5230\u51d1\u5b8c$n$\u4ef6\u8863\u670d\u3002\u800c$f$\u548c$g$\u4e5f\u4e0d\u9700\u8981\u5168\u90e8\u9884\u5904\u7406\u4e86\uff0c\u8fb9\u8d2a\u8fb9\u6253\u8868\u3002  \n# \u4ee3\u7801\n```cpp\n#include <cstdio>\n\nconst int MAXN = 3005, MAXM = 305;\n\ntemplate<typename _T>\nvoid read( _T &x )\n{\n    x = 0;char s = getchar();int f = 1;\n    while( s > '9' || s < '0' ){if( s == '-' ) f = -1; s = getchar();}\n    while( s >= '0' && s <= '9' ){x = ( x << 3 ) + ( x << 1 ) + ( s - '0' ), s = getchar();}\n    x *= f;\n}\n\ntemplate<typename _T>\nvoid write( _T x )\n{\n    if( x < 0 ){ putchar( '-' ); x = ( ~ x ) + 1; }\n    if( 9 < x ){ write( x / 10 ); }\n    putchar( x % 10 + '0' );\n}\n\ndouble p[MAXN][MAXM];\ndouble f[MAXM][MAXN], delta[MAXM], tmp[MAXN];\nint times[MAXM] = {};\nint N, M;\n\nvoid prepare()\n{\n\tfor( int i = 1 ; i <= M ; i ++ ) f[i][0] = 1.0;\n\tfor( int i = 1 ; i <= M ; i ++ )\n\t{\n\t\tfor( int j = 1 ; j <= N ; j ++ ) f[i][j] = f[i][j - 1] * ( 1.0 - p[j][i] );\n\t\tdelta[i] = 1.0 - f[i][N];\n\t}\n}\n\nvoid upt( const int indx )\n{\n\ttimes[indx] ++;\n\tif( times[indx] >= N )\n\t{\n\t\tdelta[indx] = 0;\n\t\treturn;\n\t}\n\tfor( int i = 0 ; i <= N ; i ++ ) tmp[i] = f[indx][i];\n\tf[indx][0] = 0.0;\n\tfor( int i = 1 ; i <= N ; i ++ )\n\t\tf[indx][i] = f[indx][i - 1] * ( 1.0 - p[i][indx] ) + tmp[i - 1] * p[i][indx];\n\tdelta[indx] -= f[indx][N];\n}\n\nint main()\n{\n\tread( N ), read( M );\n\tfor( int i = 1 ; i <= N ; i ++ )\n\t{\n\t\tfor( int j = 1 ; j <= M ; j ++ )\n\t\t{\n\t\t\tscanf( \"%lf\", &p[i][j] );\n\t\t\tp[i][j] /= 1000.0;\n\t\t}\n\t}\n\tprepare();\n\tdouble maxVal, res = 0;\n\tint maxIndx;\n\tfor( int i = 1 ; i <= N ; i ++ )\n\t{\n\t\tmaxVal = 0, maxIndx = -1;\n\t\tfor( int j = 1 ; j <= M ; j ++ )\n\t\t{\n\t\t\tif( maxVal < delta[j] )\n\t\t\t{\n\t\t\t\tmaxVal = delta[j];\n\t\t\t\tmaxIndx = j;\n\t\t\t}\n\t\t}\n\t\tres += maxVal;\n\t\tif( maxIndx == -1 ) return 0;\n\t\tupt( maxIndx );\n\t}\n\tprintf( \"%.12lf\\n\", res );\n\treturn 0;\n}\n```",
        "postTime": 1566733995,
        "uid": 123809,
        "name": "crashed",
        "ccfLevel": 0,
        "title": "[CF183D]T-shirt"
    }
]
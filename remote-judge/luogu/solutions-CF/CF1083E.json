[
    {
        "content": "### \u89e3\u9898\u601d\u8def\n\n\u56e0\u4e3a\u77e9\u5f62\u4e92\u4e0d\u5305\u542b\uff0c\u6240\u6709\u7ed9\u77e9\u5f62\u6392\u4e2a\u5e8f\uff0c\u6ee1\u8db3 $x_i$ \u5355\u8c03\u9012\u589e\uff0c$y_i$ \u5355\u8c03\u9012\u51cf\u3002\n\n\u9996\u5148\u6709\u4e2a $\\mathrm{dp}$ \u7684\u82d7\u5934\uff1a\u8bbe\u505a\u5230\u6392\u5e8f\u540e\u7684\u7b2c $i$ \u4e2a\u77e9\u5f62\u4e86\uff0c\u9009\u62e9\u8fd9\u4e2a\u77e9\u5f62\uff0c\u9762\u79ef\u5e76\u51cf\u53bb\u6743\u503c\u548c\u7684\u6700\u5927\u503c\u4e3a $f_i$\u3002\n\n\u5f88\u660e\u663e\u4ece\u4e0a\u4e00\u4e2a\u9009\u62e9\u7684\u7b2c $j$ \u7684\u77e9\u5f62\u8f6c\u79fb\u8fc7\u6765\uff0c\u5219\uff1a\n\n$$f_i = \\max_{j\\in [0,\\,i-1]}\\{f_j + S_i-a_i-S_i \\cap S_j\\}$$\n\n\u5176\u5b9e\u4e0d\u8fc7\u662f\u76f4\u63a5\u52a0\u4e0a\u8be5\u77e9\u5f62\u7684\u8d21\u732e\uff0c\u53c8\u56e0\u4e3a\u9762\u79ef\u6709\u91cd\u5408\uff0c\u51cf\u6389\u800c\u5df2\u3002\u7531\u4e8e $x_i,\\,y_i$ \u7684\u5355\u8c03\u6027\uff0c\u914d\u5408\u4e0b\u56fe\uff0c\u4e00\u5b9a\u6709\uff1a\n\n$$S_i = x_iy_i,\\ S_i \\cap S_j = x_jy_i$$\n\n![](https://i.loli.net/2019/01/11/5c384953e1f20.png)\n\n\u4f46\u66b4\u529b\u8f6c\u79fb\u662f\u4e00\u5b9a\u4e0d\u884c\u7684\uff0c\u6211\u4eec\u601d\u8003\u8f6c\u79fb\u5f0f\u6709\u4ec0\u4e48\u4f18\u7f8e\u7684\u6027\u8d28\u3002\n\n$$f_i = \\max_{j\\in [0,\\,i-1]}\\{f_j +x_iy_i-x_jy_i - a_i\\}$$\n\n\u8bbe\u5b83\u7684\u51b3\u7b56\u70b9\u5c31\u662f $j$\uff1a\n\n$$f_i = f_j +x_iy_i-x_jy_i - a_i$$\n\n\u79fb\u9879\u53ef\u5f97\uff1a\n\n$$\\underline{f_j}_{\\ y} = \\underline{y_i}_{\\ k}\\underline{x_j}_{\\ x} + \\underline{f_i - x_iy_i + a_i}_{\\ b}$$\n\n\u6ce8\u610f\u5230 $y_i$ \u5355\u8c03\u9012\u51cf\uff0c\u53ef\u4f5c\u4e3a\u659c\u7387\uff0c\u7528**\u659c\u7387\u4f18\u5316**\u7ef4\u62a4\u597d\u4e0a\u5f0f\u5373\u53ef\u3002\n\n---\n\n### \u4ee3\u7801\u5b9e\u73b0\n\n\u5f53\u65f6\u8bfb\u4f18\u6ca1\u5f00 $\\mathrm{long\\ long\\ WA}$ \u4e86\u4e00\u53d1\u3002\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <algorithm>\n\ninline long long read() {\n    char c = getchar(); long long x = 0;\n    while (c < '0' || c > '9') { c = getchar(); }\n    while (c >= '0' && c <= '9') { x = (x << 1) + (x << 3) + (c & 15); c = getchar(); }\n    return x;\n}\n\ntypedef long long lol;\n\nconst int maxN = 2000005;\nconst double eps = 1e-10;\n\nint n, l, r, q[maxN];\nlong long ans, f[maxN];\n\nstruct Square { lol x, y, w; } s[maxN];\n\nbool operator <(Square x, Square y) { return x.y > y.y; }\n\ninline double getX(int u) { return s[u].x; }\ninline double getY(int u) { return f[u]; }\ninline double getSlope(int u, int v) { return std::abs(getX(v) - getX(u)) < eps ? 1e10 : (getY(v) - getY(u)) / (getX(v) - getX(u)); }\n\nint main() {\n    n = read();\n    for (int i = 1; i <= n; i++) { s[i].x = read(); s[i].y = read(); s[i].w = read() ;}\n    std::sort(s + 1, s + n + 1);\n    for (int i = 1; i <= n; i++) {\n        while (l < r && getSlope(q[l], q[l + 1]) >= s[i].y) { l++; }\n        f[i] = s[i].x * s[i].y - s[i].w;\n        if (l <= r) { f[i] = std::max(f[i], f[q[l]] + (s[i].x - s[q[l]].x) * s[i].y - s[i].w); }\n        ans = std::max(ans, f[i]);\n        while (l < r && getSlope(q[r - 1], q[r]) <= getSlope(q[r], i)) { r--; } q[++r] = i;\n    }\n    printf(\"%I64d\\n\", ans);\n    return 0;\n}\n```",
        "postTime": 1547193539,
        "uid": 26673,
        "name": "Sooke",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1083E \u3010The Fair Nut and Rectangles\u3011"
    },
    {
        "content": "\u56e0\u4e3a\u4efb\u610f\u4e24\u4e2a\u77e9\u5f62\u4e0d\u5305\u542b\uff0c\u6240\u4ee5\u4e0d\u5b58\u5728 $x_i \\leq x_j \\& y_i \\leq y_j$\u3002\n\n\u6309 $x_i$ \u6392\u5e8f\u3002\n\n\u4ee4 $f_j$ \u4e3a $j$ \u662f\u6700\u53f3\u8fb9\u7684\u90a3\u4e2a\u77e9\u5f62\u6700\u591a\u7684\u8d21\u732e\u3002\n\u5bb9\u6613\u5f97\u5230\u3002\n\n$f_i = \\max\\{f_j + (x_i - x_j) \\times y_i\\} - a_i$\n\n\u8bbe\u4e24\u4e2a\u51b3\u7b56\u70b9 $x, y$\n\n\u4f7f\u5f97 $j$ \u4f18\u4e8e $k$\u3002\n\n$f_j + (x_i - x_j) \\times y_i \\geq f_k + (x_i - x_k) \\times y_i$\n\n\u5373 $f_j + x_iy_i - x_jy_i \\geq f_k + x_iy_i - x_ky_i$\n\n$f_j - f_k \\geq (x_j - x_k)y_i$ $\\to$ $\\frac{f_j-f_k}{x_j-x_k} \\geq y_i$\n\n```cpp\n#include <bits/stdc++.h>\nconst int B = 2 << 20;\nstruct streambufcin {\n\tstd::streambuf *in;\n\tstreambufcin() {\n\t\tstd::ios::sync_with_stdio(false);\n\t\tstd::cin.tie(NULL);\n\t\tin = std::cin.rdbuf();\n\t\tbg = ed = NULL;\n//\t\tfreopen(\"testdata.txt\", \"r\", stdin);\n\t}\n\tchar buf[B], *bg, *ed, ch;\n\tchar gc() { return bg == ed ? ed = buf + in -> sgetn(bg = buf, B), (bg == ed ? -1 : *bg++) : *bg++; }\n\ttemplate<class T>\n\tstreambufcin &operator >> (T &x) {\n\t\tbool neg = false;\n\t\tfor (ch = gc(); !isdigit(ch); ch = gc());\n\t\tif (ch == '-')\n\t\t\tneg = true;\n\t\tfor (x = 0; isdigit(ch); ch = gc())\n\t\t\tx = x * 10 + ch - 48;\n\t\tif (neg)\n\t\t\tx = -x;\n\t\treturn *this;\n\t}\n\tstreambufcin &operator >> (char c) {\n\t\twhile (isspace(ch))\n\t\t\tch = gc();\n\t\tc = ch;\n\t\treturn *this;\n\t}\n} cin;\n\nstruct streambufcout {\n\tstd::streambuf *out = std::cout.rdbuf();\n\tchar buf[B], *optr = buf;\n\tstreambufcout() { out = std::cout.rdbuf(); }\n\t~streambufcout() { flush(); }\n\tvoid flush() { out -> sputn(buf, optr - buf); optr = buf; }\n\tvoid pc(char c) {\n\t\tif (optr == buf + B)\n\t\t\tflush();\n\t\t*optr++ = c;\n\t}\n\ttemplate<class T>\n\tstreambufcout &operator << (T x) {\n\t\tstatic int st[233], top;\n\t\tdo {\n\t\t\tst[++top] = x % 10;\n\t\t\tx /= 10;\n\t\t} while (x);\n\t\twhile (top)\n\t\t\tpc(st[top--] ^ 48);\n\t\treturn *this;\n\t}\n\tstreambufcout &operator << (char c) { pc(c); return *this; }\n} cout;\n\nint n;\nconst int N = 1e6 + 1;\nint l, r, q[N];\nconst double eps = 1e-10;\nstruct Square { long long x, y, w; bool operator <(const Square &rhs) const { return y > rhs.y; } } s[N];\nlong long f[N];\ndouble getX(int u) { return s[u].x; } \ndouble getY(int u) { return f[u]; }\ndouble getslope(int u, int v) { return std::abs(getX(v) - getX(u)) < eps ? 1e10 : (getY(v) - getY(u)) / (getX(v) - getX(u)); }\n\nint main() {\n\tcin >> n;\n\tfor (int i = 1; i <= n; i++) { cin >> s[i].x >> s[i].y >> s[i].w; }\n\tstd::sort(s + 1, s + n + 1); q[l = r = 0] = 0;\n\tlong long answer = 0;\n\tfor (int i = 1; i <= n; i++) {\n\t\twhile (l < r && getslope(q[l], q[l + 1]) >= s[i].y) { ++l; } \n\t\tf[i] = 1ll * s[i].x * s[i].y - s[i].w;\n\t\tif (l <= r) { int j = q[l]; f[i] = std::max(f[i], f[j] + 1ll * (s[i].x - s[j].x) * s[i].y - s[i].w); }\n\t\tanswer = std::max(answer, f[i]);\n\t\twhile (l < r && getslope(q[r - 1], q[r]) <= getslope(q[r], i)) { --r; } q[++r] = i;\n\t}\n\tcout << answer << '\\n';\n\treturn 0;\n}\n```",
        "postTime": 1596525075,
        "uid": 96580,
        "name": "SXNhdW5veWE",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1083E \u3010The Fair Nut and Rectangles\u3011"
    },
    {
        "content": "## CF1083E \u9898\u89e3\n\n##### $\\text{Description}$\n\n\u7ed9\u5b9a $n$ \u4e2a\u5de6\u4e0b\u89d2\u5728 $(0,0)$\uff0c\u56db\u8fb9\u4e0e $x,y$ \u8f74\u5e73\u884c\u7684\u77e9\u5f62\uff08\u4ee5\u53f3\u4e0a\u89d2\u9876\u70b9\u7684\u5f62\u5f0f\u7ed9\u51fa\uff09\uff0c\u4fdd\u8bc1\u4e24\u4e24\u4e0d\u5305\u542b\uff0c\u6bcf\u4e2a\u77e9\u5f62\u6709\u4e00\u4e2a\u6743\u503c $a_i$\uff0c\u8bd5\u9009\u51fa\u82e5\u5e72\u4e2a\u77e9\u5f62\uff0c\u4f7f\u5f97\u5176\u9762\u79ef\u5e76\u51cf\u53bb\u6743\u503c\u548c\u6700\u5927\u3002\n\n$1\\le n\\le 10^6,1\\le x_i,y_i\\le 10^9,0\\le a_i\\le x_iy_i$\n\n##### $\\text{Solution}$\n\n\u8003\u8651\u4e24\u4e24\u4e0d\u5305\u542b\u7684\u542b\u4e49\uff0c\u5373\u6211\u4eec\u5c06\u8fd9\u4e9b\u9876\u70b9\u6309\u6a2a\u5750\u6807\u5347\u5e8f\u6392\u5217\u540e\uff0c\u5176\u7eb5\u5750\u6807\u5355\u8c03\u9012\u51cf\u3002\n\n\u90a3\u4e48\uff0c\u6211\u4eec\u6309\u5982\u4e0a\u987a\u5e8f\u5c06\u77e9\u5f62\u52a0\u5165\u51b3\u7b56\u96c6\uff0c\u53ef\u4ee5\u53d1\u73b0\u5176\u589e\u52a0\u7684\u9762\u79ef\u53ea\u4e0e\u4e0a\u4e00\u4e2a\u52a0\u5165\u51b3\u7b56\u96c6\u7684\u77e9\u5f62\u76f8\u5173\uff0c\u56e0\u6b64\u53ef\u4ee5\u52a8\u6001\u89c4\u5212\u3002\n\n\u8bbe $f_i$ \u8868\u793a\u6700\u540e\u4e00\u4e2a\u9009\u53d6\u4e86\u7b2c $i$ \u4e2a\u77e9\u5f62\u7684\u51b3\u7b56\u96c6\u4e2d\u6700\u5927\u7684\u7b54\u6848\uff0c\u5219\u6709\n$$\nf_i =\\max_{0\\le j<i}\\{f_j+y_i(x_i-x_j)-a_i\\}=x_iy_i-a_i+\\max_{0\\le j<i}\\{f_j-y_ix_j\\}\n$$\n\u6ce8\u610f\u5230\u540e\u8005\u662f\u4e24\u53d8\u91cf\u7684\u4e58\u79ef\u9879\uff0c\u6240\u4ee5\u8003\u8651\u659c\u7387\u4f18\u5316\uff0c\u8003\u8651\u7528 $j$ \u8f6c\u79fb $i$ \u65f6\uff0c\u6709\uff1a\n$$\nf_i-x_iy_i+a_i+x_jy_i=f_j\n$$\n\u5c06 $f_j$ \u770b\u4f5c $y$\uff0c\u5c06 $x_j$ \u770b\u4f5c $x$\uff0c\u5219 $y_i$ \u4e3a\u659c\u7387\uff0c\u6211\u4eec\u8981\u6700\u5927\u5316\u622a\u8ddd\u3002\n\n\u56e0\u6b64\uff0c\u6211\u4eec\u8003\u8651\u7ef4\u62a4\u4e00\u4e2a\u4e0a\u51f8\u58f3\uff0c\u4e5f\u5373\u76f8\u90bb\u4e24\u70b9\u8fde\u7ebf\u659c\u7387\u5355\u8c03\u9012\u51cf\uff0c\u90a3\u4e48\u5957\u8def\u6027\u5730\uff0c\u6211\u4eec\u9700\u8981\u627e\u5230\u4e0e\u4e0b\u4e00\u70b9\u8fde\u7ebf\u7684\u659c\u7387\u6700\u5927\u4f46\u5c0f\u4e8e $y_i$ \u7684\u70b9\uff0c\u8be5\u70b9\u5373\u6700\u4f18\u51b3\u7b56\u70b9\u3002\n\n\u56de\u5230\u95ee\u9898\u672c\u8eab\uff0c\u6ce8\u610f\u5230 $y_i$ \u5355\u8c03\u9012\u51cf\uff0c\u5219\u53ef\u7528\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u4e0a\u51f8\u58f3\uff0c\u6bcf\u6b21\u8f6c\u79fb\u65f6\u5148\u4ece\u961f\u9996\u5f39\u51fa\u4e0e\u4e0b\u4e00\u70b9\u8fde\u7ebf\u7684\u659c\u7387\u6bd4 $y_i$ \u5927\u7684\u70b9\uff0c\u7136\u540e\u53d6\u961f\u9996\u4f5c\u4e3a\u51b3\u7b56\u70b9\uff0c\u6700\u540e\u5728\u63d2\u5165\u8be5\u70b9\u65f6\u5220\u53bb\u4e0d\u7b26\u5408\u6761\u4ef6\u7684\u51b3\u7b56\u70b9\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n\\log n)$\uff0c\u74f6\u9888\u5728\u4e8e\u6392\u5e8f\u3002\n\n##### $\\text{Code}$\n\n```cpp\n#include<bits/stdc++.h>\n#define REG register\nusing namespace std;\ntypedef long long ll;\ntypedef double D;\ninline void read(int& x){\n\tstatic char c;\n\twhile(!isdigit(c=getchar()));x=c^48;\n\twhile(isdigit(c=getchar()))x=(x*10)+(c^48);\n}\ninline void read(ll& x){\n\tstatic char c;\n\twhile(!isdigit(c=getchar()));x=c^48;\n\twhile(isdigit(c=getchar()))x=(x*10)+(c^48);\n}\n\nconst int N=1000005;\n\nint n;\n\nstruct Rec{ll x,y,a;}rec[N];\ninline bool cmp(Rec u,Rec v){return u.x<v.x;}\n\nll F[N];\ninline ll Calc(int i,int j){return F[j]+rec[i].y*(rec[i].x-rec[j].x)-rec[i].a;}\ninline D Slp(int i,int j){return 1.0*(F[i]-F[j])/(rec[i].x-rec[j].x);}\n\nint Q[N],head=1,tail;\n\ninline void Work(){\n\tread(n);\n\tfor(REG int i=1;i<=n;++i)\n    \tread(rec[i].x),read(rec[i].y),read(rec[i].a);\n\tsort(rec+1,rec+n+1,cmp);\n\tF[1]=rec[1].x*rec[1].y-rec[1].a;\n\tQ[++tail]=0;\n\tfor(REG int i=1;i<=n;++i){\n    \twhile(head<tail&&Slp(Q[head],Q[head+1])>=rec[i].y) ++head;\n    \tF[i]=Calc(i,Q[head]);\n    \twhile(head<tail&&Slp(Q[tail-1],Q[tail])<Slp(Q[tail],i)) --tail;\n    \tQ[++tail]=i;\n    }\n\tll Mx=0;\n\tfor(REG int i=1;i<=n;++i) Mx=max(Mx,F[i]);\n\tprintf(\"%lld\\n\",Mx);\n}\n\nint main(){Work();}\n```\n\n",
        "postTime": 1605097069,
        "uid": 83547,
        "name": "LCuter",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1083E \u3010The Fair Nut and Rectangles\u3011"
    },
    {
        "content": "### \u9898\u610f\n\n> \u5e73\u9762\u4e0a\u6709 $n$ \u4e2a\u4ee5 $(0,0)$ \u4e3a\u5de6\u4e0b\u89d2\u7684\u77e9\u5f62\uff0c\u6bcf\u4e2a\u77e9\u5f62\u62e5\u6709\u6743\u503c $a_i$\uff0c\u4fdd\u8bc1\u77e9\u5f62\u4e4b\u95f4\u4e92\u4e0d\u5305\u542b\u3002\u73b0\u5728\u8981\u6c42\u9009\u62e9\u82e5\u5e72\u4e2a\u77e9\u5f62\uff0c\u4f7f\u5f97\u77e9\u5f62\u7684\u9762\u79ef\u5e76\u51cf\u53bb\u77e9\u5f62\u6743\u503c\u548c\u5c3d\u53ef\u80fd\u5927\u3002$1\\le n\\le 10^6$\u3002\n\n### \u9898\u89e3\n\n\u5148\u5c06\u77e9\u5f62\u6309 $x$ \u5750\u6807\u6392\u5e8f\u3002\u90a3\u4e48\u7531\u4e8e\u77e9\u5f62\u4e92\u4e0d\u5305\u542b\uff0c\u6240\u4ee5 $y$ \u5750\u6807\u9012\u51cf\u3002\n\n\u5bb9\u6613\u8bbe\u8ba1 $dp_i$ \u8868\u793a\u8003\u8651\u4e86\u7b2c $1$ \u5230 $i$ \u4e2a\u77e9\u5f62\uff0c\u4e14\u5fc5\u987b\u9009\u62e9\u7b2c $i$ \u4e2a\u65f6\u6700\u5927\u7684\u7b54\u6848\u3002\u6709\u8f6c\u79fb\uff1a\n\n$$dp_i=\\max_{1\\le j<i}dp_j+(x_i-x_j)y_i-a_i$$\n\n\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u659c\u7387\u4f18\u5316\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u6211\u4eec\u628a\u5f0f\u5b50\u8f6c\u5316\u6210\uff1a\n\n$$dp_j=x_jy_i+(dp_i-x_iy_i+a_i)$$\n\n\u6211\u4eec\u628a $(x_j,dp_j)$ \u770b\u6210\u4e00\u4e2a\u70b9\uff0c\u90a3\u4e48\u8f6c\u79fb\u5230 $i$ \u65f6\u76f8\u5f53\u4e8e\u8be2\u95ee\u4e00\u6761\u659c\u7387\u4e3a $y_i$ \u7684\u76f4\u7ebf\u7ecf\u8fc7\u54ea\u4e2a\u70b9\u65f6\u622a\u8ddd\u6700\u5927\u3002\n\n\u7531\u4e8e $y_i$ \u9012\u51cf\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7528\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u4e0a\u51f8\u58f3\u5373\u53ef\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nint n;\nstruct node{\n    ll x,y,val;\n    bool operator <(const node &b)const{return x<b.x;}\n}a[1000005];\nint que[1000005],head,tail;\nll dp[1000005];\nll read(){\n    ll x=0;char c=getchar();\n    while(c<'0'||c>'9')c=getchar();\n    while(c>='0'&&c<='9')x=x*10+(c^'0'),c=getchar();\n    return x;\n}\nint main(){\n    n=read();\n    for(int i=1;i<=n;i++)a[i].x=read(),a[i].y=read(),a[i].val=read();\n    sort(a+1,a+n+1);\n    head=1,tail=0;\n    ll ans=0;\n    for(int i=1;i<=n;i++){\n        while(head<tail&&1.0*(dp[que[head+1]]-dp[que[head]])/(a[que[head+1]].x-a[que[head]].x)>=a[i].y)head++;\n        dp[i]=a[i].x*a[i].y-a[i].val;\n        if(head<=tail)dp[i]=max(dp[i],dp[que[head]]-a[i].y*a[que[head]].x+a[i].y*a[i].x-a[i].val);\n        ans=max(ans,dp[i]);\n        while(head<tail&&1.0*(dp[que[tail]]-dp[que[tail-1]])/(a[que[tail]].x-a[que[tail-1]].x)<=1.0*(dp[i]-dp[que[tail]])/(a[i].x-a[que[tail]].x))tail--;\n        que[++tail]=i;\n    }\n    printf(\"%lld\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1671843724,
        "uid": 233462,
        "name": "Umbrella_Leaf",
        "ccfLevel": 8,
        "title": "\u9898\u89e3CF1083E The Fair Nut and Rectangles"
    },
    {
        "content": "\u56e0\u4e3a\u77e9\u5f62\u4e92\u4e0d\u5305\u542b\uff0c\u6240\u4ee5\u53ef\u4ee5\u6392\u4e2a\u5e8f\uff0c\u4f7f $x$ \u5355\u589e\uff0c$y$ \u5355\u51cf\u3002  \n\u4e8e\u662f\u4e0d\u59a8\u8bbe $f_i$ \u4e3a\u5df2\u7ecf\u8003\u8651\u5b8c\u524d $i-1$ \u4e2a\u77e9\u5f62\u5e76\u9009\u62e9 $i$ \u7684\u6743\u503c\uff0c\u5f88\u5bb9\u6613\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u8f6c\u79fb\u65b9\u7a0b\uff1a\n$$f_i=\\max_{j=1}^{i-1}\\{f_j+S_i-a_i-S_i\\cap S_j\\}$$\n\n\u53c8\u6839\u636e\u5bb9\u65a5\u6613\u5f97\n\n$$S_i\\cap S_j=x_j\\times y_i$$\n\n\u4e8e\u662f\u53ef\u4ee5\u5199\u51fa\u6700\u7ec8\u7684\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$f_i=\\max_{j=1}^{i-1}\\{f_j+x_i\\times y_i-x_j\\times y_i-a_i\\}$$\n\n\u6b64\u65f6\u5f00\u59cb\u659c\u7387\u4f18\u5316\u6807\u51c6\u6d41\u7a0b\uff0c\u8003\u8651 $j$ \u6bd4 $k$ \u66f4\u4f18\uff0c\u6709\n\n$$f_j+x_i\\times y_i-x_j\\times y_i-a_i\\ge f_k+x_i\\times y_i-x_k\\times y_i-a_i$$\n\n\u79fb\u9879\uff0c\u628a\u542b\u6709 $i$ \u7684\u79fb\u5230\u4e00\u8fb9\n\n$$f_j-f_k\\ge(x_j-x_k)\\times y_i$$\n\n\u9664\u8fc7\u53bb\uff0c\u5f97\u5230\n\n$$y_i\\leq\\frac{f_j-f_k}{x_j-x_k}=k$$\n\n\u4e3a\u4e86\u5f97\u5230\u8ba1\u7b97\u5f0f\u518d\u79fb\u4e00\u6b21\u9879\n\n$$f_j=x_j\\times y_i-x_i\\times y_i+a_i+f_i$$\n\n\u7a0d\u52a0\u601d\u7d22\u5f97\n\n$$y=f_j,k=y_i,x=x_j,b=f_i+a_i-x_i\\times y_i$$\n\n\u53c8 $k=y_i$ \u5355\u51cf\uff0c\u56e0\u6b64\u662f\u4e2a\u4e0a\u51f8\u58f3\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u5feb\u4e50\u7ef4\u62a4\u4e86\n\n```cpp\n#include<bits/stdc++.h>\n#define N 1000000\n#define reg register\n#define inl inline\n#define int long long\n#define inf 1e18\nusing namespace std;\nstruct Node\n{\n\tint x,y,val;\n\tfriend bool operator < (const Node &x,const Node &y)\n\t{\n\t\treturn x.y>y.y;\n\t}\n}a[N+5];\nint n,f[N+5];\nint q[N*2+5],head,tail;\ninl double Calc(reg int x,reg int y)\n{\n\treturn a[x].x==a[y].x?inf:((double)(f[y]-f[x])/(double)(a[y].x-a[x].x));\n}\nsigned main()\n{\n\tscanf(\"%lld\",&n);\n\tfor(reg int i=1;i<=n;i++) scanf(\"%lld %lld %lld\",&a[i].x,&a[i].y,&a[i].val);\n\tsort(a+1,a+n+1);\n\thead=1;\n\treg int ans=0;\n\tfor(reg int i=1;i<=n;i++)\n\t{\n\t\twhile(head<tail && Calc(q[head],q[head+1])>=a[i].y) head++;\n\t\tf[i]=a[i].x*a[i].y-a[i].val;\n\t\tif(head<=tail) f[i]=max(f[i],f[q[head]]+(a[i].x-a[q[head]].x)*a[i].y-a[i].val);\n\t\tans=max(ans,f[i]);\n\t\twhile(head<tail && Calc(q[tail-1],q[tail])<=Calc(q[tail],i)) tail--;\n\t\tq[++tail]=i;\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\t",
        "postTime": 1601041476,
        "uid": 23243,
        "name": "VenusM1nT",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1083E \u3010The Fair Nut and Rectangles\u3011"
    },
    {
        "content": "[\u535a\u5ba2\u98df\u7528\u6548\u679c\u66f4\u4f73](https://www.cnblogs.com/lxy-2022/p/CF1083E-Solution.html)\n#### \u9898\u610f\n\n\u4e00\u4e2a\u5750\u6807\u7cfb\u4e2d $n$ \u4e2a\u77e9\u5f62\uff0c\u6bcf\u4e2a\u77e9\u5f62\u5de6\u4e0b\u89d2\u5728 $(0,0)$\uff0c\u53f3\u4e0a\u89d2\u5728 $(x_i,y_i)$\uff0c\u6709\u6743\u503c $a_i$\uff0c\u4fdd\u8bc1\u4efb\u610f\u4e24\u4e2a\u77e9\u5f62\u4e0d\u51fa\u73b0\u5305\u542b\u5173\u7cfb\uff0c\u8ba9\u9009\u51fa\u82e5\u5e72\u4e2a\u77e9\u5f62\uff0c\u6c42\u77e9\u5f62\u9762\u79ef\u5e76\u51cf\u6743\u503c\u548c\u7684\u6700\u5927\u503c\u3002\n\n#### \u5206\u6790\n\n\u7531\u4e8e\u4fdd\u8bc1\u4e0d\u51fa\u73b0\u5305\u542b\u5173\u7cfb\uff0c\u56e0\u6b64\u5c06\u77e9\u5f62\u6309\u5de6\u53f3\u8ddd\u4ece\u5c0f\u5230\u5927\u6392\uff0c\u53d1\u73b0\u5982\u679c\u4e00\u4e2a\u77e9\u5f62\u7684\u4e0a\u4e0b\u8ddd\u4e0d\u6bd4\u524d\u9762\u7684\u6240\u6709\u77e9\u5f62\u4e0a\u4e0b\u8ddd\u957f\uff0c\u800c\u5b83\u5de6\u53f3\u8ddd\u4e5f\u4e00\u5b9a\u6bd4\u524d\u9762\u7684\u6240\u6709\u5de6\u53f3\u8ddd\u77ed\uff0c\u90a3\u4e48\u524d\u9762\u4e00\u5b9a\u5b58\u5728\u4e00\u4e2a\u77e9\u5f62\u5b8c\u5168\u5305\u542b\u5b83\uff0c\u4e0e\u9898\u610f\u77db\u76fe\u3002\u56e0\u6b64\u77e9\u5f62\u7684\u4e0a\u4e0b\u8ddd\u4e00\u5b9a\u5355\u8c03\u9012\u589e\u3002\n\n\u8bbe $dp_i$ \u8868\u793a\u4ee5 $i$ \u4e3a\u7ed3\u5c3e\u7684\u77e9\u5f62\u5e8f\u5217\u9762\u79ef\u5e76\u51cf\u6743\u503c\u548c\u7684\u6700\u5927\u503c\u3002\u4ece $dp_j$ \u8f6c\u79fb\u591a\u51fa\u6765\u7684\u9762\u79ef\u5e76\u662f $(y_i-y_j)x_i$\uff0c\u56e0\u6b64\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\n$$\ndp_i=dp_j+(y_i-y_j)x_i-w_i\n$$\n\u659c\u7387\u4f18\u5316\u5373\u53ef\u3002\n\n#### \u6838\u5fc3\u4ee3\u7801\n\n```cpp\nstruct node{\n    int x,y,w;\n    bool operator < (const node &o)const{return y<o.y;}\n}a[MAXN];\ndouble gety(int i){return dp[i];}double getx(int i){return a[i].y;}\ndouble slope(int i,int j){return (gety(j)-gety(i))/(getx(j)-getx(i));}\nsigned main(){\n    qread(n);int i,j;for(i=1;i<=n;i++) qread(a[i].x,a[i].y,a[i].w);sort(a+1,a+1+n);h=t=1;\n    for(i=1;i<=n;i++){\n        while(h<t&&slope(q[h],q[h+1])>=a[i].x) h++;\n        int j=q[h];dp[i]=dp[j]+(a[i].y-a[j].y)*a[i].x-a[i].w;\n        while(h<t&&slope(q[t-1],q[t])<=slope(q[t],i)) t--;q[++t]=i;\n        ans=qmax(ans,dp[i]);    \n    }printf(\"%lld\\n\",ans);\n    return 0;\n}\n```\n\n[record](https://codeforc.es/problemset/submission/1083/172005955)\n\n",
        "postTime": 1663058234,
        "uid": 225991,
        "name": "_lxy_",
        "ccfLevel": 6,
        "title": "CF1083E The Fair Nut and Rectangles \u9898\u89e3"
    }
]
[
    {
        "content": "\u4e0b\u6587\u4e2d\u5927\u5199 $K$ \u8868\u793a\u8f93\u5165\u7684\u53d8\u91cf\uff0c\u5c0f\u5199 $k$ \u8868\u793a\u679a\u4e3e\u7684\u53d8\u91cf\u3002\n\n\u5047\u8bbe\u6709 $tot_5$ \u4e2a $50\\mathrm{kg}$ \u7684\u4eba\uff0c$tot_1$ \u4e2a $100\\mathrm{kg}$ \u7684\u4eba\uff0c$f(pos,j,k)$ \u8868\u793a\u8fd9\u4e00\u8f6e\u7ed3\u675f\u540e\u8239\u5728 $pos$ \u5cb8\uff08$0$ \u4e3a\u51fa\u53d1\u5cb8\uff0c$1$ \u4e3a\u5bf9\u5cb8\uff09\uff0c\u5bf9\u5cb8 $50\\mathrm{kg}$ \u7684\u6709 $j$ \u4e2a\uff0c$100\\mathrm{kg}$ \u7684\u6709 $k$ \u4e2a\uff0c\u65b9\u6848\u6570\u662f\u591a\u5c11\u3002\u90a3\u4e48\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\n\nI. $pos=0$\uff1a\n$$\nf(1,j+c_5,k+c_1)\\gets f(1,j+c_5,k+c_1)+\\binom{tot_5-j}{c_t}\\binom{tot_1-k}{c_1}f(0,j,k)\n$$\n\u5176\u4e2d $c_5,c_1$ \u662f\u679a\u4e3e\u7684\u53d8\u91cf\uff0c\u6ee1\u8db3 $0\\le c_5\\le tot_5-j$\uff0c$0\\le c_1\\le tot_1-k$\uff0c$0< 50c_5+100c_1\\le K$\u3002\n\nII. $pos=1$\uff1a\n$$\nf(0,j-c_5,k-c_1)\\gets f(0,j-c_5,k-c_1)+\\binom{j}{c_5}\\binom{k}{c_1}f(1,j,k)\n$$\n\u540c\u7406\uff0c$0\\le c_5\\le j$\uff0c$0\\le c_1\\le k$\uff0c$0<50c_5+100c_1\\le K$\u3002\n\n\u521d\u59cb\u503c\u4e3a $f(0,0,0)=1$\uff0c\u5176\u4f59\u4e3a $0$\u3002\u679a\u4e3e\u8f6e\u6570\uff08\u4e00\u6765\u4e00\u56de\u7b97\u4e24\u8f6e\uff09$i$\uff0c$i$ \u5bf9\u5e94\u7684 $pos$ \u5c31\u662f $i\\bmod 2$\u3002\u5f53 $f(i\\bmod 2,n,n)\\not= 0\\;(i\\bmod 2=1)$ \u65f6\u5219\u6700\u5c0f\u503c\u4e3a $i$\u3002\u5982\u679c $i>4n$ \u65f6\u8fd8\u6ca1\u6709\u7b54\u6848\uff0c\u90a3\u4e48\u4e00\u5b9a\u65e0\u89e3\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ninline int read()\n{\n\tint x=0,f=1;char c=getchar();\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9'){x=(x<<1)+(x<<3)+(c^48);c=getchar();}\n\treturn x*f;\n}\nconst int mod=1e9+7,N=310;\ninline int qpow(int a,int n)\n{\n\tint ans=1;\n\twhile(n)\n\t{\n\t\tif(n&1)ans=(long long)ans*a%mod;\n\t\ta=(long long)a*a%mod;\n\t\tn>>=1;\n\t}\n\treturn ans;\n}\nint inv[N],p[N];\nint binom(int n,int m){return (long long)p[n]*inv[n-m]%mod*inv[m]%mod;}\nint f[2][60][60];\nint main()\n{\n\tp[0]=inv[0]=1;\n\tfor(int i=1;i<=50;i++)p[i]=(long long)p[i-1]*i%mod,inv[i]=qpow(p[i],mod-2);\n\tint n=read(),K=read(),tot5=0,tot1=0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tint x=read();\n\t\ttot5+=(x==50);\n\t\ttot1+=(x==100);\n\t}\n\tf[0][0][0]=1;\n\tfor(int i=1;i<=4*n;i++)\n\t{\n\t\tfor(int j=0;j<=tot5;j++)\n\t\t\tfor(int k=0;k<=tot1;k++)\n\t\t\t\tf[i&1][j][k]=0;\n\t\tfor(int j=0;j<=tot5;j++)\n\t\t{\n\t\t\tfor(int k=0;k<=tot1;k++)\n\t\t\t{\n\t\t\t\tif(i&1)\n\t\t\t\t{\n\t\t\t\t\tfor(int c5=0;c5<=tot5-j;c5++)\n\t\t\t\t\t{\n\t\t\t\t\t\tfor(int c1=0;c1<=tot1-k;c1++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif(!c5&&!c1)continue;\n\t\t\t\t\t\t\tif(50*c5+100*c1>K) continue;\n\t\t\t\t\t\t\tf[1][j+c5][k+c1]+=(long long)binom(tot5-j,c5)*binom(tot1-k,c1)%mod*f[0][j][k]%mod;\n\t\t\t\t\t\t\tf[1][j+c5][k+c1]%=mod;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tfor(int c5=0;c5<=j;c5++)\n\t\t\t\t\t{\n\t\t\t\t\t\tfor(int c1=0;c1<=k;c1++)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif(!c5&&!c1)continue;\n\t\t\t\t\t\t\tif(50*c5+100*c1>K) continue;\n\t\t\t\t\t\t\tf[0][j-c5][k-c1]+=(long long)binom(j,c5)*binom(k,c1)%mod*f[1][j][k]%mod;\n\t\t\t\t\t\t\tf[0][j-c5][k-c1]%=mod;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(f[i&1][tot5][tot1])\n\t\t{\n\t\t\tprintf(\"%d\\n%d\",i,f[i&1][tot5][tot1]);\n\t\t\treturn 0;\n\t\t}\n\t}\n\tprintf(\"-1\\n0\");\n\treturn 0;\n}\n```\n\n",
        "postTime": 1620979228,
        "uid": 125913,
        "name": "zztqwq",
        "ccfLevel": 8,
        "title": "CF295C Greg and Friends"
    },
    {
        "content": "### \u9996\u5148\n\u6211\u4eec\u8003\u8651\u6bcf\u6b21\u8239\u6765\u56de\u8fd0\u4eba\u65f6\u90fd\u53ef\u4ee5\u770b\u6210\u4e00\u79cddp\u72b6\u6001\n\n\u53c8\u56e0\u4e3a\u4eba\u7684\u4f53\u91cd\u53ea\u670950kg\u548c100kg\u4e24\u79cd\uff0c\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5f00\u4e00\u4e2a\u4e09\u7ef4\u6570\u7ec4dp[i][j][k],\u7b2c1\u7ef4\u8868\u793a\u5728\u51fa\u53d1\u5cb850kg\u6709i\u4e2a,\u7b2c2\u7ef4\u8868\u793a\u5728\u51fa\u53d1\u5cb8100kg\u6709j\u4e2a\uff0c\u7b2c3\u7ef4\u8868\u793a\u8239\u5728\u54ea\u4e00\u5cb8\n\n\u53c8\u8003\u8651\u5230\u6bcf\u4e00\u4e2a\u4eba\u90fd\u662f\u4e0d\u540c\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u5bf9\u5728\u8239\u5cb8\u7684\u8fd9\u4e00\u8fb9\u7684\u4eba\u6570\u548c\u4e0a\u8239\u7684\u4eba\u6570\u53bb\u7ec4\u5408\u6570,\u53ef\u4ee5\u6253\u4e00\u4e2a\u6768\u8f89\u4e09\u89d2\u7684\u8868b[i][j],\u7528\u6765\u5feb\u901f\u67e5\u8be2\u7ec4\u5408\u6570\n\n\u6240\u4ee5\u72b6\u6001\u8f6c\u79fb\u5c31\u53ef\u4ee5\u679a\u4e3e\u5728\u6b64\u5cb8\u4e0a\u823950kg\u548c100kg\u7684\u4eba\u6570\u5e76\u53d6\u7ec4\u5408\u6570\u4e58\u4e0a\u81ea\u5df1\u7684\u539f\u503c\uff08\u4e58\u6cd5\u539f\u7406\uff09\n### \u5176\u6b21\n\u672c\u9898\u8fd8\u8981\u6c42\u6c42\u6700\u77ed\u8fd0\u9001\u6b21\u6570\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u5e7f\u641c\u6765\u904d\u5386\u679a\u4e3e\u7b54\u6848\n\n\u540c\u7406dp\u7684\u72b6\u6001\u8f6c\u79fb\u4e5f\u53ef\u4ee5\u5728\u5e7f\u641c\u4e2d\u4e00\u8d77\u5b8c\u6210\n```\n#include <bits/stdc++.h>\n#define ll long long\nusing namespace std;\nstruct kk\n{\n\tll i,j,k;\n}sh[1000001];//\u6570\u7ec4\u6a21\u62df\u961f\u5217 \nll n,w,step[100][100][3],dp[100][100][3];\nll a[100],t50,t100,b[1000][1000],mod;\nvoid bfs(ll i1,ll j1,ll wh)\n{\n\tll l,r;\n\tl=0;r=0;\n\tsh[l].i=i1;\n\tsh[l].j=j1;\n\tsh[l].k=wh;\n\tr++;\n\twhile (l<r)\n\t{\n\t\tll nowi,nowj,nowh;\n\t\tnowi=sh[l].i;\n\t\tnowj=sh[l].j;\n\t\tnowh=sh[l].k;\n\t\tl++;\n\t\tif (nowh==1)//\u679a\u4e3e\u51fa\u53d1\u5cb8 \n\t\tfor (ll x=0;x<=nowi;x++)\n\t\t{\n\t\t\tfor (ll y=0;y<=nowj;y++)\n\t\t\t{\n\t\t\t\tif (50*x+100*y>w || (x==0 && y==0))\n\t\t\t\t  continue;//\u5224\u65ad\u4f53\u91cd\u662f\u5426\u8d85\u8fc7\u8239\u8f7d\u91cd \n\t\t\t\tll xi,xj,xwh;\n\t\t\t\txi=nowi-x;\n\t\t\t\txj=nowj-y;\n\t\t\t\txwh=1-nowh;\n\t\t\t\tif (step[xi][xj][xwh]!=0)//\u91cd\u70b9\uff0c\u6b64\u5904\u4e0e\u4e00\u822c\u7684\u5e7f\u641c\u4e0d\u540c\uff0c\u5f53\u4e00\u79cd\u72b6\u6001\u88ab\u904d\u5386\u8fc7\u4e86\u4e0d\u80fd\u76f4\u63a5\u6807\u8bb0\u6389\uff0c\u8fd8\u8981\u53d6\u6700\u4f18\u60c5\u51b5 \n\t\t\t\t{\n\t\t\t\t\tif (step[nowi][nowj][nowh]+1<step[xi][xj][xwh])\n\t\t\t\t\t  step[xi][xj][xwh]=step[nowi][nowj][nowh]+1;\n\t\t\t\t\tif (step[nowi][nowj][nowh]+1==step[xi][xj][xwh])//\u6b65\u6570\u76f8\u540c\u65f6\uff0c\u66f4\u65b0dp\u503c \n\t\t\t\t\t{\n\t\t\t\t\t\tdp[xi][xj][xwh]+=(b[nowi+1][x+1]%mod)*(b[nowj+1][y+1]%mod)*(dp[nowi][nowj][nowh]%mod);\n\t\t\t\t    \tdp[xi][xj][xwh]%=mod;\n\t\t\t\t\t}\n\t\t    \t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdp[xi][xj][xwh]=(b[nowi+1][x+1]%mod)*(b[nowj+1][y+1]%mod)*(dp[nowi][nowj][nowh]%mod);\n\t\t\t\t\tdp[xi][xj][xwh]%=mod;\n\t\t\t\t\tstep[xi][xj][xwh]=step[nowi][nowj][nowh]+1;\n\t\t\t\t\tsh[r].i=xi;\n\t\t\t\t\tsh[r].j=xj;\n\t\t\t\t\tsh[r].k=xwh;\n\t\t\t\t\tr++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (nowh==0)//\u679a\u4e3e\u5bf9\u5cb8 \n\t\tfor (ll x=0;x<=t50-nowi;x++)\n\t\t{\n\t\t\tfor (ll y=0;y<=t100-nowj;y++)\n\t\t\t{\n\t\t\t\tif (50*x+100*y>w || (x==0 && y==0))\n\t\t\t\t  continue;\n\t\t\t\tll xi,xj,xwh;\n\t\t\t\txi=nowi+x;\n\t\t\t\txj=nowj+y;\n\t\t\t\txwh=1-nowh;\n\t\t\t\tif (step[xi][xj][xwh]!=0)\n\t\t\t\t{\n\t\t\t\t\tif (step[nowi][nowj][nowh]+1<step[xi][xj][xwh])\n\t\t\t\t\t  step[xi][xj][xwh]=step[nowi][nowj][nowh]+1;\n\t\t\t\t\tif (step[nowi][nowj][nowh]+1==step[xi][xj][xwh])\n\t\t\t\t\t{\n\t\t\t\t\t\tdp[xi][xj][xwh]+=(b[t50-nowi+1][x+1]%mod)*(b[t100-nowj+1][y+1]%mod)*(dp[nowi][nowj][nowh]%mod);\n\t\t\t\t\t    dp[xi][xj][xwh]%=mod;\n\t\t\t\t\t}\n\t\t    \t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdp[xi][xj][xwh]=(b[t50-nowi+1][x+1]%mod)*(b[t100-nowj+1][y+1]%mod)*(dp[nowi][nowj][nowh]%mod);\n\t\t\t\t\tdp[xi][xj][xwh]%=mod;\n\t\t\t\t\tstep[xi][xj][xwh]=step[nowi][nowj][nowh]+1;\n\t\t\t\t\tsh[r].i=xi;\n\t\t\t\t\tsh[r].j=xj;\n\t\t\t\t\tsh[r].k=xwh;\n\t\t\t\t\tr++;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\nint main()\n{\n\tscanf(\"%lld%lld\",&n,&w);\n\tfor (ll x=1;x<=n;x++)\n\t  scanf(\"%lld\",&a[x]);\n\tmemset(dp,0,sizeof(dp));\n\tmemset(step,0,sizeof(step));\n\tfor (ll x=1;x<=n;x++)\n\t{\n\t\tif (a[x]==50)\n\t\t  t50++;\n\t\tif (a[x]==100)\n\t\t  t100++;\n\t}\n\tb[1][1]=1;\n\tfor (ll x=2;x<=50;x++)\n\t{\n\t\tfor (ll y=1;y<=x;y++)\n\t\t  b[x][y]=b[x-1][y]+b[x-1][y-1];//\u6768\u8f89\u4e09\u89d2\n\t}\n\tmod=1000000007;\n\tdp[t50][t100][1]=1;//\u4ee41\u8868\u793a\u51fa\u53d1\u5cb8\uff0c0\u8868\u793a\u5230\u8fbe\u5cb8\n\tstep[t50][t100][1]=0;//\u521d\u59cb\u5316\n\tbfs(t50,t100,1);//\u5e7f\u641c\u51fd\u6570 \n\tif (step[0][0][0]==0)//\u5982\u4f55\u5230\u8fbe\u7684\u6b65\u6570\u4e3a0\u5c31\u4e0d\u80fd\u5230\u8fbe\n\t{\n\t\tprintf(\"-1\\n\");\n\t\tprintf(\"0\\n\");\n\t}\n\telse\n\t{\n\t\tprintf(\"%lld\\n\",step[0][0][0]);//\u7b54\u6848\u5373\u4e3a\u51fa\u53d1\u5cb8\u65e0\u4eba\u4e14\u8239\u5728\u5bf9\u5cb8\u7684\u60c5\u51b5\n\t\tprintf(\"%lld\\n\",dp[0][0][0]);\n\t}\n} \n```",
        "postTime": 1532782478,
        "uid": 67998,
        "name": "SevenDawns",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF295C \u3010Greg and Friends\u3011"
    },
    {
        "content": "### \u4e09\u7ef4DP\n\n```\ndp[i][j][k]\u8868\u793a\u7b2ci\u6b21\u8fd0\u9001\u540e\u5bf9\u5cb8\u6709j\u4e2a50kg\uff0ck\u4e2a100kg\u7684\u65b9\u6848\u6570\n\u82e5\u7ecf\u8fc72*n\u6b21\u8fd0\u9001\u540e\u5219\u5fc5\u4e3a\u65e0\u89e3\uff08\u539f\u56e0\u81ea\u5df1\u60f3\uff09\n```\n\n\u9898\u610f:\n\n\u6709\u4e00\u4e2a\u8239\u6700\u591a\u80fd\u8f7dK\u5343\u514b, \u73b0\u5728\u6709n\u4e2a\u4eba\u8981\u8fc7\u6cb3, \u8239\u53ea\u6709\u4e00\u6761,\u6bcf\u4e2a\u4eba\u8981\u4e48\u662f50\u5343\u514b,\u8981\u4e48\u662f100\u5343\u514b,\u95ee\u6709\u591a\u5c11\u79cd\u65b9\u6848\u53ef\u4ee5\u5230\u8fbe\u6cb3\u5bf9\u5cb8,\u4e14\u6765\u56de\u6b21\u6570\u6700\u5c11?\n\u5148\u8f93\u51fa\u6700\u5c11\u6765\u56de\u6b21\u6570,\u518d\u8f93\u51fa\u65b9\u6848\u6570,\u7ed3\u679c\u5bf910^9+7\u53d6\u6a21\n\u65e0\u89e3\u8f93\u51fa\n-1 \n0\n```\n#include <bits/stdc++.h>\nusing namespace std;\nconst int MOD = 1e9 + 7;\nlong long n, k;\nlong long a[55];\nlong long c[55][55];\nlong long dp[105][55][55];\n/*int\u4f1a\u70b8\uff01\uff01\uff01\uff01\uff01*/\nlong long num_50, num_100;\nlong long old, now;\nbool ok;\nint main() {\n    for(int i = 0; i < 50; i++) {\n        c[i][0] = 1;\n        for(int j = 1; j <= i; j++) \n            c[i][j] = (c[i - 1][j] + c[i - 1][j - 1]) % MOD;\n    }\n    scanf(\"%lld%lld\", &n, &k);\n    k /= 50;\n    for(int i = 1; i <= n; i++) {\n        scanf(\"%lld\", &a[i]);\n        if(a[i] == 50)\n            num_50++;\n        else\n            num_100++;\n    }\n    old = 1;\n    now = 0;\n    dp[0][num_50][num_100] = 1;\n    for(int l = 0; l < 2 * n; l++) {\n    \t/*\u4ece\u8fd9\u5cb8\u5230\u90a3\u5cb8*/\n        swap(now, old);\n        memset(dp[now], 0, sizeof(dp[now]));\n        for(int i = 0; i <= num_50; i++) {\n            for(int j = 0; j <= num_100; j++) {\n                if(i + j * 2 && (i + j * 2) <= k) {\n                    for(int x = i; x <= num_50; x++) {\n                        for(int y = j; y <= num_100; y++) {\n                            dp[now][num_50 - x + i][num_100 - y + j] += dp[old][x][y] * c[x][i] % MOD * c[y][j] % MOD;\n                        }\n                    }\n                }\n            }\n        }\n        if(dp[now][num_50][num_100]) {\n            printf(\"%d\\n\", l * 2 + 1);\n            printf(\"%lld\\n\", dp[now][num_50][num_100] % MOD);\n            ok = 1;\n            break;\n            //\u8f93\u51fa\u89e3\n        }\n        /*\u4ece\u90a3\u5cb8\u56de\u6765*/\n        swap(now, old);\n        memset(dp[now], 0, sizeof(dp[now]));\n        for(int i = 0; i <= num_50; i++) {\n            for(int j = 0; j <= num_100; j++) {\n                if(i + j * 2 && (i + j * 2) <= k) {\n                    for(int x = i; x <= num_50; x++) {\n                        for(int y = j; y <= num_100; y++) {\n                            dp[now][num_50 - x + i][num_100 - y + j] += dp[old][x][y] * c[x][i] % MOD * c[y][j] % MOD;\n                        }\n                    }\n                }\n            }\n        }\n    }\n    if(ok == 0)\n        printf(\"-1\\n0\");\n       //\u65e0\u89e3\n    return 0;\n}\n```",
        "postTime": 1532749275,
        "uid": 106778,
        "name": "hello_world2005",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF295C \u3010Greg and Friends\u3011"
    }
]
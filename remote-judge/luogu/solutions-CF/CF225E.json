[
    {
        "content": "[Link](https://www.luogu.com.cn/problem/CF225E)\n----------------\n\n### \u9898\u76ee\u63cf\u8ff0\n\u6c42\u6240\u6709\u4f7f\u65b9\u7a0b\n$$z=\\lfloor\\frac{x}{2}\\rfloor+y+xy$$\n\u4e0d\u5b58\u5728\u6b63\u6574\u6570\u89e3 $(x,y)$ \u7684 $z$ \u4e2d\uff0c\u7b2c $n$ \u5c0f\u7684 $z$ \uff0c\u7ed3\u679c\u5bf9 $10^9+7$ \u53d6\u6a21\n\n### \u89e3\u6cd5\n\u5411\u4e0b\u53d6\u6574\u4e0d\u597d\u641e\uff0c\u6240\u4ee5\u60f3\u5230\u5206\u5947\u5076\u8ba8\u8bba\u628a\u5411\u4e0b\u53d6\u6574\u53bb\u6389\u3002\n\n1. \u82e5 $x$ \u662f\u5947\u6570\uff0c\u4ee4 $x=2k+1$\u3002\u5219\n$$z=k+2y+2ky$$\n\u8bd5\u56fe\u5316\u7b80\n$$z+1=(k+1)(2y+1)$$\n\u5176\u4e2d\uff0c$k$ \u53d6\u904d\u81ea\u7136\u6570\uff0c$y$ \u53d6\u904d\u6b63\u6574\u6570\uff0c\u90a3\u4e48 $k+1$ \u53d6\u904d\u6240\u6709\u5927\u4e8e\u7b49\u4e8e $1$ \u7684\u6b63\u6574\u6570\uff0c$2y+1$ \u53d6\u904d\u6240\u6709\u5927\u4e8e\u7b49\u4e8e $3$ \u7684\u5947\u6570\u3002\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u8bf4\u660e\u4e86\u82e5 $z+1$ \u80fd\u5206\u89e3\u51fa\u4e00\u4e2a\u5927\u4e8e $1$ \u7684\u5947\u6570\uff0c\u90a3\u4e48 $z$ \u5c31\u80af\u5b9a\u4e0d\u6ee1\u8db3\u6761\u4ef6\u3002\u6240\u4ee5 $z+1$ \u53ea\u80fd\u662f\u4e00\u4e2a $2$ \u7684\u6b21\u5e42\u3002\u6211\u4eec\u8868\u793a\u4e3a\n$$z+1=2^r$$\n\u5176\u4e2d $r$ \u4e3a\u67d0\u4e2a\u6b63\u6574\u6570\u3002\n2. \u82e5 $x$ \u662f\u5076\u6570\uff0c\u4ee4$x=2k$\u3002\u5219\n$$z=k+y+2ky$$\n\u540c\u4e0a\uff0c\u5206\u89e3\u56e0\u5f0f\n$$2z+1=(2k+1)(2y+1)=(x+1)(2y+1)$$\n\u5176\u4e2d $x+1$ \u548c $2y+1$ \u5747\u4e3a\u5927\u4e8e\u7b49\u4e8e $3$ \u7684\u5947\u6570\u3002\u4e0a\u8ff0\u5f0f\u5b50\u8bf4\u660e\u4e86\u5982\u679c $2z+1$ \u80fd\u5199\u6210\u4e24\u4e2a\u5927\u4e8e\u7b49\u4e8e $3$ \u7684\u5947\u6570\uff0c\u90a3\u4e48 $2z+1$ \u5c31\u4e0d\u7b26\u5408\u6761\u4ef6\u3002\u800c $2z+1$ \u672c\u6765\u5c31\u4e3a\u4e00\u4e2a\u5947\u6570\uff0c\u82e5\u53ef\u4ee5\u5206\u89e3\u90a3\u4e48\u4e00\u5b9a\u662f\u4e24\u4e2a\u5947\u6570\u76f8\u4e58\u3002\u7efc\u4e0a $2z+1$ \u4e00\u5b9a\u4e3a\u4e00\u4e2a\u5947\u7d20\u6570\u3002\u8868\u793a\u4e3a\n$$2z+1=p$$\n\n\u7efc\u5408\u4e0a\u8ff0\u4e24\u6761\n$$\\begin{cases}\nz+1=2^r \\\\\n2z+1=p\n\\end{cases}$$\n\u5408\u5e76\u5f97\n$$2z+1=2^{r+1}-1=p$$\n\n\u90a3\u4e48\u53ef\u4ee5\u770b\u51fa\uff0c$z$ \u4fbf\u662f\u6240\u6709 $2z+1$ \u662f\u6885\u68ee\u7d20\u6570\u65f6\u7684\u503c\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u4ece\u67d0 OEIS \u590d\u5236\u4e00\u4e0b\u6570\u5217\uff0c\u7136\u540e\u6253\u8868\u8f93\u51fa\u3002",
        "postTime": 1605272343,
        "uid": 83337,
        "name": "wwlw",
        "ccfLevel": 7,
        "title": "CF225E Unsolvable"
    },
    {
        "content": " \u8981\u6c42\u51fa$ z_n $,\u53ef\u4ee5\u5148\u53d8\u5f62\u9898\u76ee\u7ed9\u51fa\u7684\u5f0f\u5b50: $z=\\left[\\frac{x}{2}\\right]+y+xy$  \n \u6ce8\u610f\u5230\u6709\u53d6\u6574\u6570\u90e8\u5206\u7b26\u53f7\uff0c\u6211\u4eec\u5c1d\u8bd5\u628a\u5b83\u53bb\u6389\u7136\u540e\u5bf9$x$\u5206\u7c7b\u8ba8\u8bba\uff1a  \n \n \u82e5$x$\u4e3a\u5947\u6570\uff0c\u8bbe$x=2k+1$\u5219$z=k+y+(2k+1)y$  \n \u7531\u4e8e\u8fd9\u662f\u4e00\u4e2a\u5173\u4e8e$k,y$\u7684\u4e8c\u6b21\u65b9\u7a0b\uff0c\u56e0\u5f0f\u5206\u89e3\u5f97  \n $z+1=k+y+2ky+1=(2y+1)(k+1)$  \n \u53ea\u6709\u5f53$z+1$\u4e3a$2^t$\u5373$z=2^t-1$\u65f6\uff0c\u65b9\u7a0b\u6ca1\u6709\u6b63\u6574\u6570\u89e3\n \n \u82e5$x$\u4e3a\u5076\u6570,\u8bbe$x=2k$\u5219$z=k+y+2ky$  \n \u7c7b\u4f3c\u5730\uff0c\u56e0\u5f0f\u5206\u89e3\u5f97\uff1a  \n $2z+1=2k+2y+4ky+1=(2k+1)(2y+1)=(x+1)(2y+1)$  \n \u53ea\u6709\u5f53$2z+1$\u5373$z=2^{t-1}-1$\u4e3a\u8d28\u6570\u65f6\uff0c\u65b9\u7a0b\u6ca1\u6709\u6b63\u6574\u6570\u89e3  \n \n \u7efc\u4e0a\u6240\u8ff0\uff0c$z$\u4e3a\u6885\u68ee\u7d20\u6570  \n \u6211\u4eec\u4e0aOEIS\u67e5\u5230\u524d40\u4e2a$t$\u7684\u503c\uff0c\u6253\u8868+\u5feb\u901f\u5e42\u5373\u53ef\n \n ```cpp\n#include<cstdio>\nconst int mod=1e9+7;\nint n,pr[41]={\n    0,2,3,5,7,13,17,19,31,61,89,107,127,521,607,1279,2203,2281,3217,4253,\n    4423,9689,9941,11213,19937,21701,23209,44497,86243,110503,132049,216091,\n    756839,859433,1257787,1398269,2976221,3021377,6972593,13466917,20996011\n    };\n\nint pow(int x) {\n    long long ans=1,base=2;\n    for(;x;x>>=1) {\n        if(x&1)ans=ans*base%mod;\n        base=base*base%mod;\n    }\n    return (int)ans;\n}\n\nint main() {\n    scanf(\"%d\",&n);\n    printf(\"%d\",pow(pr[n]-1)-1);\n    return 0;\n}\n```",
        "postTime": 1538559739,
        "uid": 61369,
        "name": "Polarnova",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF225E \u3010Unsolvable\u3011"
    },
    {
        "content": "# \u9898\u610f\n\n\u7ed9\u5b9a $n$\uff0c\u6c42\u7b2c $n$ \u5c0f\u7684 $z$ \u4f7f\u5f97 $\\lfloor\\dfrac{x}{2}\\rfloor+y+xy=z$ \u6ca1\u6709\u6b63\u6574\u6570\u89e3\u3002\u7b54\u6848 $\\bmod\\ 10^9+7$\u3002\n\n# \u89e3\u9898\u601d\u8def\n\n\u6211\u4eec\u5148\u627e\u201c$\\lfloor\\dfrac{x}{2}\\rfloor+y+xy=z$ \u6ca1\u6709\u6b63\u6574\u6570\u89e3\u201d\u7684\u5145\u8981\u6761\u4ef6\uff0c\u518d\u89e3\u51b3\u201c\u7b2c $n$ \u5c0f\u201d\u3002\n\n\u9996\u5148\u8003\u8651\u53bb\u6389\u4e0b\u53d6\u6574\u7b26\u53f7\u3002\u6211\u4eec\u8ba8\u8bba $x$ \u7684\u5947\u5076\u6027\u3002\n\n\u82e5 $x$ \u662f\u5076\u6570\uff0c\u8bbe $x=2k$ \u5176\u4e2d $k$ \u662f\u6b63\u6574\u6570\u3002\n\n\u5219\u6709\n\n$$\\begin{aligned}\n\\lfloor\\dfrac{x}{2}\\rfloor+y+xy&=z\\\\\n\\lfloor\\dfrac{2k}{2}\\rfloor+y+2ky&=z&\\text{\uff08\u7b49\u91cf\u4ee3\u6362\uff09}\\\\\nk+y+2ky&=z&\\text{\uff08\u53bb\u6389\u4e0b\u53d6\u6574\uff09}\\\\\n2k+2y+4ky&=2z\\\\\n1+2k+2y+4ky&=1+2z\\\\\n(1+2k)(1+2y)&=1+2z&\\text{\uff08\u56e0\u5f0f\u5206\u89e3\uff09}\\\\\n\\end{aligned}$$\n\n\u5373 $(1+2k)(1+2y)=1+2z$ \u65e0\u6b63\u6574\u6570\u89e3\u3002\n\n\u6ce8\u610f $1+2k,1+2y$ \u53ef\u4ee5\u53d6\u5230\uff08\u5927\u4e8e $1$ \u7684\uff09\u4efb\u610f\u5947\u6570\uff0c$1+2z$ \u4e5f\u662f\u5947\u6570\u3002\n\n\u56e0\u6b64 $1+2z$ \u4e0d\u80fd\u5206\u89e3\u4e3a\u4e24\u4e2a\u5927\u4e8e $1$ \u7684\u5947\u6570\u4e4b\u79ef\uff0c\u5373 **$2z+1$ \u662f\u7d20\u6570**\u3002\n\n\u82e5 $x$ \u662f\u5947\u6570\uff0c\u8bbe $x=2k-1$ \u5176\u4e2d $k$ \u662f\u6b63\u6574\u6570\u3002\n\n\u5219\u6709\n\n$$\\begin{aligned}\n\\lfloor\\dfrac{x}{2}\\rfloor+y+xy&=z\\\\\n\\lfloor\\dfrac{2k-1}{2}\\rfloor+y+(2k-1)y&=z&\\text{\uff08\u7b49\u91cf\u4ee3\u6362\uff09}\\\\\nk-1+2ky&=z&\\text{\uff08\u53bb\u6389\u4e0b\u53d6\u6574\uff09}\\\\\nk+2ky&=z+1\\\\\nk(1+2y)&=z+1&\\text{\uff08\u56e0\u5f0f\u5206\u89e3\uff09}\\\\\n\\end{aligned}$$\n\n\u5373 $k(1+2y)=z+1$ \u65e0\u6b63\u6574\u6570\u89e3\u3002\n\n\u6ce8\u610f $1+2y$ \u53ef\u4ee5\u53d6\u5230\uff08\u5927\u4e8e $1$ \u7684\uff09\u4efb\u610f\u5947\u6570\u3002\n\n\u56e0\u6b64 $z+1$ \u6ca1\u6709\u5947\u56e0\u5b50\uff0c\u5373 **$z+1$ \u662f $2$ \u7684\u5e42**\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ea\u8981\u6c42\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u7684\u7b2c $k$ \u5c0f\u7684\u6b63\u6574\u6570 $z$\uff1a\n- $2z+1$ \u662f\u7d20\u6570\n- $z+1$ \u662f $2$ \u7684\u5e42\n\n\u8bbe $z+1=2^x$\uff0c\u5219 $2z+1=2^{x+1}-1$ \u662f\u7d20\u6570\u3002\n\n\u8fd9\u4e0d\u7981\u8ba9\u6211\u4eec\u60f3\u5230\u4e86 [\u6885\u68ee\u7d20\u6570](https://oeis.org/A000043)\uff1a\u6240\u6709\u5f62\u5982 $2^p-1$ \u7684\u7d20\u6570\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5148\u6253\u4e00\u4e2a\u6885\u68ee\u7d20\u6570\u7684\u6307\u6570\u8868\uff08\u89c1\u4e0a\u7f51\u5740\uff09\uff0c\u5bf9\u4e8e\u6885\u68ee\u7d20\u6570 $2z+1=2^{x+1}-1$ \u7528\u5feb\u901f\u5e42\u6c42\u51fa $z=2^x-1\\bmod 10^9+7$ \u5373\u53ef\u3002\n# \u4ee3\u7801\n```cpp\n#include<iostream>\n#include<cstdio>\n#define int long long\n#define M 1000000007\nusing namespace std;\nint mp[42]={0,2,3,5,7,13,17,19,31,61,89,107,127,521,607,1279,2203,2281,3217,4253,4423,9689,9941,11213,19937,21701,23209,44497,86243,110503,132049,216091,756839,859433,1257787,1398269,2976221,3021377,6972593,13466917,20996011,24036583};\ninline int P(int y)\n{\n\tif(y==0) return 1;\n\tif(y&1) return 2*P(y^1)%M;\n\tint tmp=P(y>>1);\n\treturn tmp*tmp%M;\n}\nsigned main()\n{\n\tint n;\n\tcin>>n;\n\tcout<<P(mp[n]-1)-1;\n\treturn 0;\n}\n```",
        "postTime": 1662442574,
        "uid": 340940,
        "name": "IAKIOI2357",
        "ccfLevel": 0,
        "title": "CF225E Unsolvable \u9898\u89e3"
    },
    {
        "content": "## CF225E Unsolvable \u9898\u89e3\n\n### \u9898\u76ee\u4f20\u9001\u95e8\uff1a\n\n[Codeforces](https://codeforces.com/contest/225/problem/E) | [Codeforces on Luogu](https://www.luogu.com.cn/problem/CF225E)\n### \u9898\u610f\uff1a\n\n\u6c42\u6240\u6709\u4f7f\u65b9\u7a0b $z = \\left\\lfloor\\dfrac x2\\right\\rfloor + y + xy$ \u4e0d\u5b58\u5728\u6b63\u6574\u6570\u89e3 $(x, y)$ \u7684 $z$ \u4e2d\uff0c\u7b2c $n$ \u5c0f\u7684 $z$\uff0c\u7ed3\u679c\u5bf9 $10^9+7$ \u53d6\u6a21\u3002\n\n$1\\le n\\le40$\u3002\n\n### \u601d\u8def\uff1a\n\n\u5c06\u539f\u5f0f\u4e2d\u7684\u5411\u4e0b\u53d6\u6574\u5206\u7c7b\u8ba8\u8bba\u5f97\n$$\n\\left\\{\n    \\begin{aligned}\n        z &= k + y + 2ky, &x &= 2k; &(k \\in \\mathbb N, y \\in \\mathbb N_+) \\\\\n        z &= k + y + (2k + 1)\\cdot y, &x &= 2k + 1. &(k \\in \\mathbb N, y \\in \\mathbb{N}_+)\n    \\end{aligned}\n\\right.\n$$\n\u8fdb\u4e00\u6b65\u8f6c\u5316\u5f97\n$$\n\\left\\{\n    \\begin{aligned}\n        z + 1 &= (k + 1)(2y + 1), && (1) \\\\\n        2z + 1 &= (2k + 1)(2y + 1). && (2)\n    \\end{aligned}\n\\right.\n$$\n\u4e8e\u662f\u95ee\u9898\u8f6c\u5316\u4e3a\u6c42\u7b2c $n$ \u5c0f\u7684 $z$ \u6ee1\u8db3 \u201c$\\forall\\, k \\in \\mathbb N, y \\in \\mathbb{N}_+,\\;(1)(2)$\u5f0f\u5747\u4e0d\u6210\u7acb\u201d\u3002\u6700\u7ec8 $z$ \u7684\u8303\u56f4\u5373\u4e3a\u4e24\u79cd\u60c5\u51b5\u4e2d $z$ \u7684\u8303\u56f4\u7684\u4ea4\u96c6\u3002\n\n\u7531\u4e8e $k + 1$ \u53ef\u4ee5\u53d6\u904d\u6240\u6709\u6b63\u6574\u6570\uff0c$2y + 1$ \u53ef\u4ee5\u53d6\u904d\u6240\u6709\u5927\u4e8e $1$ \u7684\u5947\u6570\uff0c\u6240\u4ee5 $(k + 1)(2y + 1)$ \u6052\u4e0d\u7b49\u4e8e $2^i(i\\geqslant 1,i\\in\\mathbb N)$\uff08\u56e0\u4e3a $2^i$ \u6ca1\u6709\u5947\u56e0\u6570\uff09\u3002\n\n\u56e0\u6b64\u53ea\u9700\u4f7f $z = 2^i - 1$ \u5c31\u53ef\u4ee5\u4f7f $(1)$ \u5f0f\u6052\u4e0d\u6210\u7acb\u3002\n\n\u540c\u7406\uff0c$2k + 1$ \u53ef\u4ee5\u53d6\u904d\u5927\u4e8e\u7b49\u4e8e $1$ \u7684\u5947\u6570\uff0c$2y + 1$ \u53ef\u4ee5\u53d6\u904d\u5927\u4e8e $1$ \u7684\u5947\u6570\uff0c\u6240\u4ee5 $(2k + 1)(2y + 1)$ \u53d6\u4e0d\u5230\u5076\u6570\u3001\u5947\u7d20\u6570\u548c $1$\u3002\n\n\u7531\u4e8e $2z + 1 = 2(2^i - 1) + 1 = 2^{i + 1} - 1$ \u4e3a\u5927\u4e8e\u7b49\u4e8e $3$ \u7684\u5947\u6570\uff0c\u6240\u4ee5\u5f53 $2^{i + 1} - 1$ \u4e3a\u7d20\u6570\u65f6\u6ee1\u8db3 $(1)(2)$ \u5f0f\u5747\u4e0d\u6210\u7acb\u3002\n\n\u5f62\u5982 $2^a - 1$ \u7684\u7d20\u6570\u79f0\u4e3a **\u6885\u68ee\u7d20\u6570** ([\u6885\u68ee\u7d20\u6570_\u767e\u5ea6\u767e\u79d1](https://baike.baidu.com/item/%E6%A2%85%E6%A3%AE%E7%B4%A0%E6%95%B0/816141#3))\u3002\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u4ece [OEIS](https://oeis.org/A000043) \u4e0a\u590d\u5236\u4e00\u6ce2\u6885\u68ee\u7d20\u6570\u7684\u6307\u6570 $a_1..a_{40}$ \u5230\u6570\u7ec4\u4e2d\u3002\u7b54\u6848\u5373\u4e3a $z = (2^{a_n-1} - 1) \\bmod (10^9 + 7)$\u3002\n\n### \u53c2\u8003\u4ee3\u7801\uff1a\n```cpp\n#include <iostream>\nusing namespace std;\ntypedef long long ll;\nll const MOD = 1e9 + 7;\nll const t[50] = {0, 2, 3, 5, 7, 13, 17, 19, 31, 61, 89, 107, 127, 521, 607, 1279, 2203, 2281, 3217, 4253, 4423, 9689, 9941, 11213, 19937, 21701, 23209, 44497, 86243, 110503, 132049, 216091, 756839, 859433, 1257787, 1398269, 2976221, 3021377, 6972593, 13466917, 20996011}; //\u6885\u68ee\u7d20\u6570\u7684\u6307\u6570\u8868\nll n;\n\ninline ll qpow2(ll b, ll a = 2) {\n\tll res = 1;\n\twhile (b) {\n\t\tif (b & 1) res = res * a % MOD;\n\t\ta = a * a % MOD;\n\t\tb >>= 1;\n\t}\n\treturn res;\n}\n\nsigned main() {\n\n\tcin >> n;\n\tcout << (qpow2(t[n] - 1) - 1) % MOD << '\\n';\n\n\treturn 0;\n}\n```",
        "postTime": 1662421164,
        "uid": 375425,
        "name": "f2021ljh",
        "ccfLevel": 0,
        "title": "CF225E \u9898\u89e3"
    }
]
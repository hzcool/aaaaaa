[
    {
        "content": "\u7ffb\u4e86\u4e0b\u5b98\u65b9\u9898\u89e3\u53d1\u73b0\u4e00\u4e2a\u8d85 nb \u7684\u505a\u6cd5\u3002\n\n\u5206\u522b\u5bf9\u6bcf\u4e2a\u8d77\u59cb\u70b9 $x$ \u6c42\u5176\u80fd\u5230\u8fbe\u7684\u5de6\u53f3\u8fb9\u754c\u8fd9\u4e2a\u8d2a\u5fc3\u6211\u5c31\u4e0d\u591a\u8bf4\u4e86\uff0c\u4e3b\u8981\u600e\u4e48\u6c42\u8fb9\u754c\u3002\n\n\u601d\u8def\u5927\u6982\u5c31\u662f\u641e\u5f20 $(m+1)\\times n$ \u7684\u56fe \uff0c\u8868\u793a\u7b2c $i$ \u4e2a\u64cd\u4f5c\u7684\u65f6\u523b\uff0c$(i,a_i)$ \u662f\u4e0d\u80fd\u8d70\u7684\u3002\n\n\u7136\u540e\u6bcf\u4e2a\u64cd\u4f5c\u7684\u65f6\u523b\uff0c\u53ea\u80fd\u9009\u62e9\u5411\u4e0b\u3001\u5411\u5de6\u4e0b\u3001\u5411\u53f3\u4e0b\u8d70\u3002\n\n$m=3,a=\\{2,2,2\\}$ \u7684\u56fe\u5927\u6982\u957f\u8fd9\u6837\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/xkr59dg3.png)\n\n\u8fd9\u91cc\u4ee5\u5de6\u8fb9\u754c\u4e3a\u4f8b\uff0c\u80af\u5b9a\u662f\u80fd\u5f80\u5de6\u8d70\u5c31\u5f80\u5de6\u8d70\uff0c\u4e3b\u8981\u770b\u53f3\u8fb9\u90a3 3\u30014\u30015\u3002\n\n\u8bbe $f(i,j)$ \u8868\u793a\u7b2c $i$ \u6b21\u64cd\u4f5c\uff0c\u8d77\u59cb\u70b9\u4e3a $(0,j)$ \uff0c\u4e00\u76f4\u8d2a\u5fc3\u5f80\u5de6\u8fb9\u754c\u8d70\uff0c\u9700\u8981\u201c\u78b0\u201d\u591a\u5c11\u6b21\u58c1\uff08\u4e5f\u5c31\u662f\u53ea\u80fd\u5f80\u4e0b\u8d70\uff09\uff0c\u6211\u4eec\u8003\u8651\u8fd9\u4e2a $(3,2)$ \u4ea7\u751f\u4e86\u4ec0\u4e48\u5f71\u54cd\uff0c\u4e00\u662f\u8ba9\u8d77\u59cb\u70b9\u4e3a $(0,5)$ \u7684\u201c\u78b0\u201d\u4e86\u4e00\u6b21\u58c1\uff0c\u4e8c\u662f\u8ba9\u8d77\u59cb\u70b9\u4e3a $(0,5)$ \u7684\u548c\u8d77\u59cb\u70b9\u4e3a $(0,6)$ \u7684\u5728 $i$ \u4e4b\u540e\u7684\u8def\u7ebf\u91cd\u5408\uff0c\u4e5f\u5c31\u662f\u8bf4\u540e\u9762 $(0,6)$ \u600e\u4e48\u8d70 $(0,5)$ \u5c31\u600e\u4e48\u8d70\uff0c\u6240\u4ee5\u53ef\u4ee5\u63a8\u5bfc\u51fa\u4e00\u4e2a\u9012\u63a8\u67ff\u5b50\uff1a$f(i,a_i+i)=f(i+1,a_i+i+1)+1$ \uff0c\u5176\u4f59\u76f4\u63a5\u4ece $i+1$ \u7ee7\u627f\u8fc7\u6765\u3002\u53ef\u4ee5\u53d1\u73b0\uff0c\u7b2c\u4e00\u7ef4\u6ca1\u7528\uff0c\u76f4\u63a5\u5012\u7740\u8f6c\u79fb\u5373\u53ef\u3002\n\n\u65f6\u7a7a\u590d\u6742\u5ea6 $\\mathcal O(n+m)$\u3002\n\n```cpp\n// This code wrote by chtholly_micromaker(Myukiyomekya)\n#include <bits/stdc++.h>\nconst int MaxN=1e5+50;\nint f[MaxN<<1],a[MaxN],n,m;\nsigned main(void)\n{\n\tstd::scanf(\"%d%d\",&n,&m);\n\tif(n==1)return std::puts(\"0\"),0;\n\tfor(int i=1;i<=m;++i)std::scanf(\"%d\",&a[i]);\n\tint N=std::max(n,m);\n\tfor(int i=m;i;--i)f[a[i]+i]=f[a[i]+i+1]+1;\n\tlong long ans=0;\n\tfor(int i=1;i<=n;++i)ans+=std::min(i,m+2-f[i]);\n\tstd::memset(f,0,sizeof(f));\n\tfor(int i=m;i;--i)f[a[i]-i+N]=f[a[i]-i-1+N]+1;\n\tfor(int i=1;i<=n;++i)ans+=std::min(n-i+1,m+2-f[i+N]);\n\tstd::printf(\"%lld\\n\",ans-n);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1630931812,
        "uid": 51376,
        "name": "MyukiyoMekya",
        "ccfLevel": 9,
        "title": "CF1236E Alice and the Unfair Game \u9898\u89e3"
    },
    {
        "content": "\u8003\u8651\u679a\u4e3e\u8d77\u70b9 $x$\uff0c\u90a3\u4e48\u6700\u540e\u5408\u6cd5\u7684 $y$ \u663e\u7136\u5e94\u8be5\u662f\u8fde\u7eed\u7684\u4e00\u6bb5 $l\\cdots r$\n\n\u5982\u679c\u6ca1\u6709\u8be2\u95ee\u7684\u8bdd\uff0c\u663e\u7136\u5e94\u8be5\u662f $[x-m-1,x+m+1]$\n\n\u8003\u8651\u6709\u8be2\u95ee\u7684\u65f6\u5019\uff0c\u6211\u4eec\u6709\u53ef\u80fd\u4f1a\u5728\u4e00\u4e2a\u5730\u65b9\u5361\u4f4f\n\n\u7528 $(t,i)$ \u8868\u793a\u65f6\u95f4 $t$ \u5728 $i$ \u8fd9\u4e2a\u70b9\n\n\u90a3\u4e48\u5982\u679c\u5f80\u53f3\u8d70\uff0c $(t,i)$ \u4f1a\u5728\u6700\u5c0f\u7684 $(t^\\prime,j),t^\\prime-j=t-i$ \u5361\u4f4f\n\n\u5f80\u5de6\u8d70\u4e5f\u662f\u540c\u7406\u7684\n\n\u53d1\u73b0\u5bf9\u4e8e\u4e00\u4e2a\u8be2\u95ee $a_i$\uff0c\u6211\u4eec\u8981\u4e48\u5361\u5728\u5de6\u8fb9\uff0c\u8981\u4e48\u5361\u5728\u53f3\u8fb9\n\n\u6240\u4ee5\u6211\u4eec\u628a\u4ed6\u62c6\u6210\u4e24\u4e2a\u70b9 $i$ \u548c $i+m$\n\n\u76f8\u5e94\u7684\u6211\u4eec\u53ef\u4ee5\u4e8c\u5206\u627e\u5230\u8fde\u8fb9\u7684\u70b9\uff0c\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u5efa\u51fa\u6765\u4e00\u5f20\u6709\u5411\u56fe\n\n\u53d1\u73b0\u8fd9\u5f20\u56fe\u4e0a\u8fde\u8fb9\u90fd\u662f\u4ece\u65f6\u95f4\u5c0f\u7684\u5f80\u65f6\u95f4\u5927\u7684\u8fde\uff0c\u6240\u4ee5\u662f\u4e00\u5f20 DAG\n\n\u6211\u4eec\u5728 DAG \u4e0a\u7ef4\u62a4\u4e00\u4e0b\u6bcf\u4e2a\u4f4d\u7f6e\u6700\u5c0f\u80fd\u8d70\u5230\u54ea\u91cc\uff0c\u6700\u5927\u80fd\u8d70\u5230\u54ea\u91cc\n\n\u67e5\u8be2 $x$ \u4e3a\u8d77\u70b9\u7684\u7b54\u6848\u7684\u65f6\u5019\u6211\u4eec\u9996\u5148\u627e\u5230\u4ed6\u7b2c\u4e00\u6b21\u88ab\u5361\u4f4f\u7684\u4f4d\u7f6e\uff0c\u7136\u540e\u76f4\u63a5\u67e5\u8be2\u7b54\u6848\u5373\u53ef\uff0c\u5982\u679c\u6ca1\u88ab\u5361\u4f4f\u5c31\u662f $[x-m-1,x+m+1]$\n\n\u6ce8\u610f $n=1$ \u7684\u60c5\u51b5\u9700\u8981\u7279\u5224\u4e00\u4e0b\u3002\u3002\u3002\n\n$\\mathcal O(n\\log n)$\n\n\u5f53\u7136\u8fd9\u9053\u9898\u53ea\u9700\u8981\u5f00\u4e2a\u6307\u9488\u6b63\u53cd\u626b\u4e00\u904d\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a $\\mathcal O(n)$ \u7684\u505a\u6cd5\uff0c\u7136\u800c\u5199\u5b8c\u624d\u53d1\u73b0\uff08\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n# define Rep(i,a,b) for(int i=a;i<=b;i++)\n# define _Rep(i,a,b) for(int i=a;i>=b;i--)\n# define RepG(i,u) for(int i=head[u];~i;i=e[i].next)\n\ntypedef long long ll;\n\nconst int N=1e5+5;\n\ntemplate<typename T> void read(T &x){\n   x=0;int f=1;\n   char c=getchar();\n   for(;!isdigit(c);c=getchar())if(c=='-')f=-1;\n   for(;isdigit(c);c=getchar())x=(x<<1)+(x<<3)+c-'0';\n    x*=f;\n}\n\nint n,m;\nint a[N]; \nint head[N<<1],cnt;\nint L[N<<1],R[N<<1];\nint inde[N<<1],tpx[N<<1],tpxu;\n// i \u88ab\u5361\u5728\u7b2c i \u4e2a\u8be2\u95ee\u7684\u5de6\u8fb9\n// i+m \u88ab\u5361\u5728\u7b2c i \u4e2a\u8be2\u95ee\u7684\u53f3\u8fb9 \nvector<int> T1[N<<1],T2[N<<1];\nll ans;\n\nstruct Edge{\n\tint to,next;\t\n}e[N<<2];\n\nvoid add(int x,int y){\n\tinde[y]++;\n\te[++cnt]=(Edge){y,head[x]},head[x]=cnt;\t\n}\n\nint main()\n{\n\tmemset(L,0x3f,sizeof(L));\n\tmemset(head,-1,sizeof(head));\n\tread(n),read(m);\n\tRep(i,1,m){\n\t\tread(a[i]);\t\n\t\tT1[a[i]-i+n].push_back(i);\n\t\tT2[a[i]+i].push_back(i);\n\t}\n\tif(n==1)return puts(\"0\"),0;\n\tRep(i,1,m){\n\t\tint realpos=a[i]-1;\n\t\tif(!realpos)continue;\n\t\tint x=realpos-i+n;\n\t\tint pos=upper_bound(T1[x].begin(),T1[x].end(),i)-T1[x].begin();\n\t\tif(pos<T1[x].size())add(i,T1[x][pos]);\n\t\tx=realpos+i;\n\t\tpos=upper_bound(T2[x].begin(),T2[x].end(),i)-T2[x].begin();\n\t\tif(pos<T2[x].size())add(i,T2[x][pos]+m);\n\t}\n\tRep(i,1,m){\n\t\tint realpos=a[i]+1;\n\t\tif(realpos>n)continue;\n\t\tint x=realpos-i+n;\n\t\tint pos=upper_bound(T1[x].begin(),T1[x].end(),i)-T1[x].begin();\n\t\tif(pos<T1[x].size())add(i+m,T1[x][pos]);\n\t\tx=realpos+i;\n\t\tpos=upper_bound(T2[x].begin(),T2[x].end(),i)-T2[x].begin();\n\t\tif(pos<T2[x].size())add(i+m,T2[x][pos]+m);\t\n\t}\n\tqueue<int> q;\n\tRep(i,1,2*m)if(!inde[i])q.push(i);\n\twhile(!q.empty()){\n\t\tint u=q.front();q.pop();\n\t\ttpx[++tpxu]=u;\n\t\tRepG(i,u){\n\t\t\tint v=e[i].to;\n\t\t\tinde[v]--;\n\t\t\tif(!inde[v])q.push(v);\n\t\t}\n\t}\n\t_Rep(i,tpxu,1){\n\t\tint u=tpx[i];\n\t\tRepG(i,u){\n\t\t\tint v=e[i].to;\n\t\t\tif(v<=m)R[u]=max(R[u],R[v]);\n\t\t\telse L[u]=min(L[u],L[v]);\n\t\t}\n\t\tif(L[u]>n)\n\t\t\tif(u<=m)L[u]=max(a[u]-1-(m-u),1);\n\t\t\telse L[u]=max(a[u-m]+1-(m-(u-m)),1);\n\t\tif(!R[u])\n\t\t\tif(u<=m)R[u]=min(a[u]-1+(m-u),n);\n\t\t\telse R[u]=min(a[u-m]+1+(m-(u-m)),n);\t\n\t}\n\tRep(i,1,n){\n\t\tint x=i+n;\n\t\tint ansl=i,ansr=i;\n\t\tif(T1[x].size()){\n\t\t\tint pos=T1[x][0];\n\t\t\tansr=min(R[pos]+1,n);\n\t\t}\n\t\telse ansr=min(i+m+1,n);\n\t\tx=i;\n\t\tif(T2[x].size()){\n\t\t\tint pos=T2[x][0];\n\t\t\tansl=max(L[pos+m]-1,1);\t\n\t\t}\n\t\telse ansl=max(i-m-1,1);\n\t\tans+=ansr-ansl+1;\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1616071900,
        "uid": 97344,
        "name": "devout",
        "ccfLevel": 9,
        "title": "CF1236E Alice and the Unfair Game"
    }
]
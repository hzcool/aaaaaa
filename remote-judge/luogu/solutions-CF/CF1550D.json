[
    {
        "content": "> \u5b9a\u4e49\u957f\u4e3a $n$ \u7684\u6574\u6570\u5e8f\u5217 $a$ \u662f\u597d\u7684\uff0c\u5f53\u4e14\u4ec5\u5f53 $a_i \\neq i$\u3002\u8bbe $F(a)$ \u4e3a\u6ee1\u8db3 $a_i + a_j =i+j$ \u7684 $(i,j)$ \u5bf9\u6570\u3002  \n\u5b9a\u4e49\u957f\u4e3a $n$ \u7684\u6574\u6570\u5e8f\u5217 $a$ \u662f\u6781\u597d\u7684\uff0c\u5f53\u4e14\u4ec5\u5f53\uff1a$a$ \u662f\u597d\u7684\u3001$a_i \\in [l,r]$\u3001$F(a)$ \u5728\u6240\u6709\u957f\u5ea6\u4e3a $n$ \u7684\u597d\u5e8f\u5217\u4e2d\u6700\u5927\u3002  \n\u7ed9\u5b9a $n,l,r$\uff0c\u6c42\u6781\u597d\u5e8f\u5217\u4e2a\u6570\uff0c\u7b54\u6848\u5bf9 $10^9+7$ \u53d6\u6a21\u3002  \n$n \\le 2 \\times 10^5, -10^9 \\le l \\le 1 \\le n \\le r \\le 10^9$\uff0c2s\u3002\n\n\u63d0\u4f9b\u4e00\u79cd\u975e\u5e38\u731b\u7684\u505a\u6cd5\u3002\n\n\u6ce8\u610f\u5230 $a_i+a_j=i+j$ \u53ef\u4ee5\u5316\u4e3a $a_i-i = -(a_j-j)$\uff0c\u8003\u8651\u7ed9\u9898\u76ee\u6362\u4e00\u79cd\u523b\u753b\u65b9\u5f0f\u3002\n\n\u8bbe $x_i=a_i-i$\uff0c\u5219\u539f\u9898\u7b49\u4ef7\u4e8e\u7edf\u8ba1 $x_i=-x_j$ \u7684\u5bf9\u6570\uff0c\u9650\u5236\u4e5f\u53d8\u4e3a $x_i \\neq 0,x_i \\in [l-i,r-i]$\u3002\n\n\u6211\u4eec\u5c06\u9898\u76ee\u9650\u5236\u753b\u6210\u56fe\uff0c$x_i$ \u7684\u8303\u56f4\u5f88\u663e\u7136\u5c31\u662f\u82e5\u5e72\u4e2a\u5de6\u7aef\u70b9\u4e0d\u65ad\u5de6\u79fb\u7684\u957f\u5ea6\u76f8\u540c\u7684\u533a\u95f4\u3002$F(a)$ \u6700\u5927\u7684\u9650\u5236\u76f8\u5f53\u4e8e\u9009\u4e00\u4e9b $x \\ge 0$\uff0c\u8ba9\u4e00\u4e9b\u6570\u53d6 $-x$\uff0c\u4e00\u4e9b\u6570\u53d6 $x$\uff0c\u4f7f $F(a)=\\sum_x (\\sum [x_i=-x]) \\times (\\sum [x_i=x])$\u3002\uff08\u4e0b\u56fe\u9ec4\u8272\u6846\u6846\u4f4f\u7684\u5373\u53ef\u4ee5\u53d6\u5230 $x$ \u6216 $-x$ \u7684 $x_i$\uff09\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ifmfgulj.png)\n\n\u5982\u679c\u5c31\u8fd9\u6837\u5565\u6027\u8d28\u6ca1\u6709\u7684\u8bdd\uff0c\u6784\u9020\u51fa $x$ \u5e8f\u5217\u662f\u5f88\u96be\u7684\u3002\n\n\u7136\u800c\uff0c\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u9898\u76ee\u4fdd\u8bc1\u4e86 $l \\le 1 \\le n \\le r$\u3002\u56e0\u6b64\uff0c\u5f88\u5bb9\u6613\u60f3\u5230\uff0c\u4e3a\u4e86\u8ba9\u4e58\u79ef\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5c3d\u91cf\u5927\uff0c\u6700\u7ec8\u7684 $x$ \u53ea\u4f1a\u6709 $1$ \u4e2a\uff0c\u6781\u597d\u7684\u5e8f\u5217\u5bf9\u5e94\u7684 $x$ \u5e8f\u5217\u5fc5\u7136\u662f $\\lfloor \\frac{n}{2} \\rfloor$ \u4e2a\u6570\u53d6 $-x$\u3001$\\lceil \\frac{n}{2} \\rceil$ \u4e2a\u6570\u53d6 $x$\uff0c\u6216\u8005\u53cd\u8fc7\u6765\u3002\n\n\u90a3\u4e48\u73b0\u5728\u6211\u4eec\u5c31\u6709\u4e86\u4e00\u4e2a\u66b4\u529b\u505a\u6cd5\uff1a\u679a\u4e3e $x$\uff0c\u7136\u540e\u66b4\u529b\u8ba1\u7b97\u53ea\u80fd\u53d6 $x$ \u7684 $x_i$ \u7684\u4e2a\u6570 $s_1$\u3001\u53ef\u4ee5\u540c\u65f6\u53d6 $x,-x$ \u7684 $x_i$ \u7684\u4e2a\u6570 $s_2$\uff0c\u53ea\u80fd\u53d6 $-x$ \u7684 $x_i$ \u7684\u4e2a\u6570 $s_3$\uff08\u6ce8\u610f\u4e0d\u80fd\u51fa\u73b0\u4e24\u4e2a\u90fd\u4e0d\u80fd\u53d6\u7684 $x_i$\uff09\u3002  \n\u82e5 $n$ \u4e3a\u5947\u6570\uff0c\u5219\u7b54\u6848\u52a0\u4e0a ${s_2 \\choose \\lceil \\frac{n}{2} \\rceil-s_1}+ {s_2 \\choose \\lfloor \\frac{n}{2} \\rfloor-s_1}$\uff0c\u5426\u5219\u52a0\u4e0a ${s_2 \\choose \\frac{n}{2}-s_1}$\u3002\n\n\u73b0\u5728\u6211\u4eec\u8003\u8651\u600e\u4e48\u4f18\u5316\u8fd9\u4e00\u8fc7\u7a0b\u3002\u9996\u5148\u8fd9\u6837\u9700\u8981\u679a\u4e3e $x$ \u7684\u4e2a\u6570\u662f $10^9$ \u7ea7\u522b\u7684\uff0c\u4e8b\u5b9e\u4e0a\u6211\u4eec\u6ce8\u610f\u5230\u7b54\u6848\u662f\u4e00\u4e2a\u5206\u6bb5\u51fd\u6570\u7684\u5f62\u5f0f\uff0c\u4e2d\u95f4\u6709\u4e00\u5927\u6bb5\u76f8\u7b49\u7684\u5e73\u53f0\u3002\u800c\u65ad\u70b9\u663e\u7136\u662f $\\mathcal O(n)$ \u7ea7\u522b\u7684\uff0c\u5b83\u4eec\u4e0e $l-i,r-i$ \u7684\u8ddd\u79bb\u90fd\u4e0d\u8d85\u8fc7 $1$\uff0c\u4e3a\u4e86\u907f\u514d\u5206\u7c7b\u8ba8\u8bba\uff0c\u5168\u5f53\u4f5c\u65ad\u70b9\u5c31\u597d\u4e86\u3002\n\n\u73b0\u5728\u6211\u4eec\u679a\u4e3e $x$ \u7684\u590d\u6742\u5ea6\u5df2\u7ecf\u53d8\u4e3a $\\mathcal O(n)$ \u4e86\u3002\u552f\u4e00\u7684\u74f6\u9888\u5c31\u662f\u66b4\u529b\u8ba1\u7b97 $s_1,s_2,s_3$ \u7684\u8fc7\u7a0b\u3002\u5bb9\u6613\u60f3\u5230\u5b83\u4eec\u90fd\u53ef\u4ee5\u901a\u8fc7\u6570\u5b66\u63a8\u5bfc\u5f97\u5230\uff0c\u8fd9\u91cc\u5199\u51fa $s_1$ \u7684\u8ba1\u7b97\u65b9\u6cd5\uff0c$s_2,s_3$ \u540c\u7406\u3002\n\n\u6709\n\n$$s_1=\\sum _{i=1}^n [x \\in [l-i,r-i]] [ -x \\in (- \\infty,l-i) \\cup (r-i,\\infty)]$$\n\n\u76f8\u5f53\u4e8e\u7edf\u8ba1 $1 \\le i \\le n, l-x \\le i \\le r-x, i<l+x,i>r+x$ \u7684 $i$ \u7684\u4e2a\u6570\uff0c\u8fd9\u5c31\u662f\u4e2a\u7b80\u5355\u7684\u533a\u95f4\u6c42\u5e76\uff0c\u5b9e\u73b0\u53ef\u4ee5\u53c2\u8003\u4ee3\u7801\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n \\log n)$\uff0c\u5e26 $\\log$ \u662f\u56e0\u4e3a\u7ed9\u65ad\u70b9\u6392\u4e86\u4e2a\u5e8f\u3002\n\n```cpp\nconst int N=3e6+5,mo=1e9+7;\nint T,n,l,r,tn,o[N],fc[N],ifc[N];\nint qpow(int x,int y=mo-2){\n\tif(x==1)return 1;\n\tint mu=1;\n\tfor(;y;y>>=1,x=x*x%mo)if(y&1)mu=mu*x%mo;\n\treturn mu;\n}\nvoid init(int n){\n\tfc[0]=1;for(int i=1;i<=n;i++)fc[i]=fc[i-1]*i%mo;\n\tifc[n]=qpow(fc[n]);for(int i=n-1;i>=0;i--)ifc[i]=ifc[i+1]*(i+1)%mo;\n}\nint C(int n,int m){\n\tif(n<m||n<0||m<0)return 0;\n\treturn fc[n]*ifc[m]%mo*ifc[n-m]%mo;\n}\nvoid slv(){\n\tcin>>n>>l>>r;\n\tfor(int i=1;i<=n;i++){\n\t\to[++tn]=abs(l-i),o[++tn]=abs(i-l),o[++tn]=abs(r-i+1),o[++tn]=abs(i-r-1);\n\t\to[++tn]=abs(l-i-1),o[++tn]=abs(i-l-1),o[++tn]=abs(r-i+1-1),o[++tn]=abs(i-r-1-1);\n\t\to[++tn]=abs(l-i+1),o[++tn]=abs(i-l+1),o[++tn]=abs(r-i+1+1),o[++tn]=abs(i-r-1+1);\n\t}\n\to[++tn]=0;\n\tfor(int i=1;i<=tn;i++)o[i]=-o[i];\n\tsort(o+1,o+tn+1);\n\ttn=unq(o+1,o+tn+1)-o-1;\n\tint sm=0;\n\tfor(int i=1;i<tn;i++){\n\t\tint x=o[i];\n\t\tint nl=max(1ll,l-x),nr=min(n,r-x);\n\t\tint s1;\n\t\tif(nl>nr)s1=0;\n\t\telse{\n\t\t\tint kl=l+x-1,kr=r+x+1;\n\t\t\tif(kl>nr)kl=nr;\n\t\t\tif(kr<nl)kr=nl;\n\t\t\tif(kl>=kr)s1=nr-nl+1;\n\t\t\telse s1=max(0ll,kl-nl+1)+max(0ll,nr-kr+1);\n\t\t}\n\t\tint s2=max(0ll,min(min(r-x,r+x),n)-max(max(l-x,l+x),1ll)+1);\n\t\tint s3;\n\t\tnl=max(1ll,l+x),nr=min(n,r+x);\n\t\tif(nl>nr)s3=0;\n\t\telse{\n\t\t\tint kl=l-x-1,kr=r-x+1;\n\t\t\tif(kl>nr)kl=nr;\n\t\t\tif(kr<nl)kr=nl;\n\t\t\tif(kl>=kr)s3=nr-nl+1;\n\t\t\telse s3=max(0ll,kl-nl+1)+max(0ll,nr-kr+1);\n\t\t}\n\t\tif(s1+s2+s3!=n)continue;\n\t\tint as=0;\n\t\tif(n&1)mad(as,mpl(C(s2,n/2+1-s1),C(s2,n/2-s1)));\n\t\telse mad(as,C(s2,n/2-s1));\n\t\tmad(sm,as*(o[i+1]-o[i])%mo);\n\t}\n\tcout<<sm<<endl;\n}\nvoid mms(){\n\tfor(int i=1;i<=n*12+2;i++)o[i]=0;\n\ttn=0;\n}\nsigned main(){\n\tinit(N-5);\n\tcin>>T;\n\twhile(T--)slv(),mms();\n\treturn 0;\n}\n```\n",
        "postTime": 1676688325,
        "uid": 283913,
        "name": "ZillionX",
        "ccfLevel": 6,
        "title": "\u3010\u6784\u9020\uff0c\u5206\u6bb5\u51fd\u6570\uff0c\u7ec4\u5408\u6570\u5b66\u3011CF1550D Excellent Arrays"
    },
    {
        "content": "\u63d0\u4f9b\u4e00\u4e2a\u4e0e\u5b98\u65b9\u9898\u89e3\u4e0d\u540c\u7684\uff0c\u601d\u8def\u7b80\u5355\u4e0d\u7528\u63a8\u7ed3\u8bba\uff0c~~\u4f46\u662f\u7801\u91cf\u66f4\u5927~~\u3002\n\n\u9996\u5148\u4e00\u4e2a Good Array \u662f $a_i=i$ \u5e8f\u5217\u7684\u6bcf\u4e00\u4f4d\u52a0\u4e00\u4e2a\u504f\u79fb\u91cf\uff08\u53ef\u6b63\u53ef\u8d1f\uff09\u6784\u6210\u7684\u3002\n\n\u8003\u8651\u9650\u5236\u6700\u5927\u7684\u7b2c\u4e09\u4e2a\u6761\u4ef6\uff0c\u4e00\u4e2a Excellent Array \u5fc5\u987b\u662f\u76f8\u540c\u957f\u5ea6\u7684 Good Array \u4e2d\u6ee1\u8db3 $a_i+a_j=i+j$ \u5bf9\u6570\u6700\u591a\u7684\u3002\n\n\u5bf9\u4e8e\u4e00\u5bf9 $(i,j)$ \u4e0d\u59a8\u8bbe $a_i=i+x$ \u90a3\u4e48 $a_j=j-x$ \u5219\u6240\u6709\u504f\u79fb\u91cf\u4e92\u4e3a\u76f8\u53cd\u6570\u90fd\u53ef\u7ec4\u6210\u4e00\u5bf9\u6ee1\u8db3\u6761\u4ef6\u7684 $(i,j)$\u3002\n\n\u6784\u9020 $(i,j)$ \u5bf9\u6570\u6700\u591a\u7684 Excellent Array \u7684\u65b9\u6848\u5c31\u975e\u5e38\u663e\u7136\u4e86\uff1a\u5c06\u6240\u6709 $|x|$ \u8bbe\u4e3a\u76f8\u540c\u503c\uff0c\u540c\u65f6\u6ee1\u8db3 $x>0$ \u4e0e $x<0$ \u7684\u6570\u5404\u5360\u4e00\u534a\uff08\u6ce8\u610f $n$ \u4e3a\u5947\u6570\u65f6\u8981\u4e48\u6b63\u7684\u4e3a $n/2+1$ \u8981\u4e48\u4e3a $n/2$ \u6709\u4e24\u79cd\u4e0d\u540c\u60c5\u51b5\uff09\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5c06 $a_i$ \u9884\u8bbe\u4e3a $i$\uff0c\u518d\u9884\u5904\u7406\u51fa\u6bcf\u4e00\u4e2a\u6570\u5728 $l,r$ \u9650\u5236\u4e0b\u7684\u6700\u5927\u6b63\u504f\u79fb\u91cf\u4e0e\u6700\u5c0f\u8d1f\u504f\u79fb\u91cf\u3002\n\n\u6ee1\u8db3\u4e00\u5143\u7d20\u67d0\u4e00\u504f\u79fb\u91cf\u80fd\u591f\u53d6\u5230 $x_i$ \u5373\u6ee1\u8db3 $|x|\\le|x_i|$\uff0c\u8003\u8651\u679a\u4e3e\u504f\u79fb\u91cf\u7684\u7edd\u5bf9\u503c $|x|$\uff0c\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a\u786e\u5b9a\u7684 $|x|$\uff0c\u8bbe\u53ea\u6ee1\u8db3\u8d1f\u504f\u79fb\u91cf\u7684\u5143\u7d20\u6570\u91cf\u4e3a $mi$\uff0c\u53ea\u6ee1\u8db3\u6b63\u504f\u79fb\u91cf\u7684\u5143\u7d20\u6570\u91cf\u4e3a $ad$\uff0c\u6b63\u8d1f\u504f\u79fb\u91cf\u90fd\u6ee1\u8db3\u7684\u5143\u7d20\u6570\u91cf\u4e3a $ok$\uff0c\u6211\u4eec\u5f97\u5230\uff1a\n```cpp\nif(mi+ad+ok==n&&mi+ok>=n/2&&ad+ok>=n/2){//\u6ee1\u8db3\u80fd\u591f\u6784\u9020\u51faExcellent Array\u6761\u4ef6\n\tif(n&1){\n\t\tif(mi+ok>=n/2+1) ans+=C(ok,n/2+1-mi);\n\t\tif(ad+ok>=n/2+1) ans+=C(ok,n/2-mi);\n   \t}else ans+=C(ok,n/2-mi);\n}//C(n,m)\u4e3a\u7ec4\u5408\u6570\n```\n\u611f\u6027\u7406\u89e3\u4e00\u4e0b\uff1a\u6240\u6709\u5143\u7d20\u504f\u79fb\u91cf\u975e\u8d1f\u5373\u6b63\uff0c\u5bf9\u4e8e\u53ea\u6ee1\u8db3\u4e86\u6b63\u6216\u8d1f\u7684\u663e\u7136\u53ea\u6709\u4e00\u79cd\u60c5\u51b5\uff0c\u800c $ok$ \u53ef\u4ee5\u901a\u914d\uff0c\u90a3\u4e48\u5728 $ok$ \u4e2d\u9009\u5b9a\u8d1f\u504f\u79fb\u91cf\u8fd8\u5dee\u7684\uff0c\u53e6\u5916\u4e00\u90e8\u5206\u81ea\u7136\u8865\u7ed9\u6b63\u504f\u79fb\u91cf\u3002\u5177\u4f53\u7ec6\u8282\u6309\u7167 $n$ \u7684\u5947\u5076\u6027\u8ba8\u8bba\u3002\n\n$|x|$ \u7684\u503c\u57df\u5f88\u5927\uff0c\u6bcf\u4e2a\u679a\u4e3e\u5fc5\u7136\u4e0d\u80fd\u901a\u8fc7\uff0c\u4f46\u662f\u6ce8\u610f\u5230\u5728 $mi$\uff0c$ad$\uff0c$ok$ \u4e0d\u66f4\u65b0\u65f6\u6bcf\u6b21\u7b97\u51fa\u7684\u7b54\u6848\u662f\u4e00\u6837\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u5206\u6bb5\u8ba1\u7b97\u8d21\u732e\uff0c\u53ea\u8981\u9009\u62e9\u6bcf\u4e2a\u6570\u7684\u504f\u79fb\u91cf\u4f5c\u4e3a\u6807\u8bb0\u70b9\uff0c\u4e24\u4e2a\u6807\u8bb0\u70b9\u4e2d\u95f4\u7684\u6bb5 $mi$\uff0c$ad$\uff0c$ok$ \u59cb\u7ec8\u4e0d\u53d8\uff0c\u8ba1\u7b97\u7b54\u6848\u76f8\u540c\uff0c\u90fd\u53ef\u4ee5\u4e00\u8d77\u5904\u7406\u3002\u6807\u8bb0\u70b9\u7684\u6570\u91cf\u4e0e $n$ \u540c\u9636\uff0c\u6bcf\u4e00\u6bb5\u9884\u5904\u7406\u9636\u4e58\u9006\u5143\u540e\u53ef\u4ee5 $O(1)$ \u8ba1\u7b97\u3002\n\n```cpp\n#define ll long long\nconst int maxn=200005,mod=1e9+7;\nint t,n,L,R,cnt;\nlong long co[maxn],op[maxn];\nll qpow(ll b,ll k) {\n    if (k==0) return 1;\n    long long ans=1;\n    while(k){\n        if (k&1) ans=ans*b%mod;\n        k>>=1,b=(b*b)%mod;\n    }\n    return ans;\n}\nvoid init(){\n\tco[0]=1,op[0]=1;\n\tfor(int i=1;i<=200000;++i){\n\t\tco[i]=(co[i-1]*i)%mod;\n\t\top[i]=(op[i-1]*qpow(i,mod-2))%mod;//\u9636\u4e58\u9006\u5143 \n\t}\n}\nstruct node{\n\tint id,x,ty;\n}p[maxn<<1];\nbool cmp(node a,node b){\n\treturn a.x<b.x;\n}\nbool fl[maxn][2];//\u5206\u522b\u8bb0\u5f55\u6b63\u8d1f\u504f\u79fb\u91cf\u9650\u5236\u662f\u5426\u6ee1\u8db3\nint mi,ok,ad,bon;\nvoid insert(int num){//\u66f4\u65b0\u5355\u4e2a\u6807\u8bb0\n\tif(p[num].ty==0){//L\n\t\tfl[p[num].id][0]=1;\n\t\tif(fl[p[num].id][1]) ++ok,--ad;\n\t\telse ++mi;\n\t}else{//R\n\t\tfl[p[num].id][1]=1;\n\t\tif(fl[p[num].id][0]) ++ok,--mi;\n\t\telse ++ad;\n\t}\n}\nvoid In(int &now){//\u540c\u65f6\u5c06\u4e00\u7ec4|x|\u76f8\u540c\u7684\u6807\u8bb0\u66f4\u65b0\n\twhile(p[now].x==p[now-1].x)\n\t\tinsert(now),--now;\n\tinsert(now);\n}\nlong long C(int a,int b){\n\treturn ((co[a]*op[a-b])%mod)*op[b]%mod;\n}\nlong long cal(int l,int r){//\u7edf\u8ba1l<=|x|<=r\u533a\u95f4\u7684\u7b54\u6848\n\tlong long len=r-l+1,ans=0;\n\tif(n&1){\n\t\tif(mi+ok>=n/2+1) ans+=C(ok,n/2+1-mi);\n\t\tif(ad+ok>=n/2+1) ans+=C(ok,n/2-mi);\n   \t}else ans+=C(ok,n/2-mi);\n\tans%=mod;\n\treturn (ans*len)%mod;\n}\nint main(){\n\tinit();\n\tt=read();\n\twhile(t--){\n\t\tcnt=0;\n\t\tmemset(fl,0,sizeof(fl));\n\t\tmi=0,ad=0,ok=0;\n\t\tn=read(),L=read(),R=read();\n\t\tlong long ans=0;\n\t\tfor(int i=1;i<=n;++i){\n\t\t\tint l=i-L,r=R-i;//\u5982\u679c\u504f\u79fb\u91cf\u4e3a0\u5219\u6ca1\u6709\u610f\u4e49\uff08\u4e0d\u6ee1\u8db3good array\uff09\n\t\t\tif(l!=0)p[++cnt].id=i,p[cnt].x=l,p[cnt].ty=0;\n\t\t\tif(r!=0)p[++cnt].id=i,p[cnt].x=r,p[cnt].ty=1;\n\t\t}\n\t\tp[++cnt].id=0,p[cnt].x=0,p[cnt].ty=2;//\u63d2\u5165\u4e00\u4e2a\u672b\u7aef\uff0c\u4fbf\u4e8e\u7edf\u8ba1\n\t\tsort(p+1,p+1+cnt,cmp);\n\t\tint now=cnt;\n\t\twhile(now>1){\n\t\t\tIn(now);\n\t\t\tif(mi+ad+ok==n&&mi+ok>=n/2&&ad+ok>=n/2){\n\t\t\t\tint l=p[now-1].x+1,r=p[now].x;\n\t\t\t\tans=(ans+cal(l,r))%mod;\n\t\t\t}\n\t\t\t--now;\n\t\t}\n\t\tprintf(\"%lld\\n\",(ans+mod)%mod);\n\t}\n\treturn 0;\n}\n",
        "postTime": 1626315830,
        "uid": 215604,
        "name": "dztlb",
        "ccfLevel": 0,
        "title": "CF1550D Excellent Arrays"
    },
    {
        "content": "## \u524d\u8a00\n\u8003\u573a\u6ca1\u8c03\u5b8c\u8fb9\u754c\u3002\n\n## \u9898\u76ee\u5206\u6790\n\u9898\u76ee\u63cf\u8ff0\u4e0d\u5141\u8bb8 $i=a_i$\uff0c\u4e8e\u662f\u4ece $i=a_i$ \u4e0e $i\\not= a_i$ \u7684\u5dee\u5f02\u601d\u8003\u3002\u53ef\u4ee5\u53d1\u73b0\u82e5 $a_1'-a_1=x$\uff0c\u90a3\u4e48\u5176\u4f59\u7684 $|a_i'-a_i|=x$\uff0c\u4e14\u5dee\u4e3a\u6b63\u8d1f\u7684\u5404\u5360\u4e00\u534a\u3002\u8fd9\u662f\u7531\u4e8e\u82e5 $a_i'+a_j'=i+j$\uff0c\u5219 $a_i'-a_i=a_j-a_j'$\uff0c\u4e8e\u662f\u6700\u4f18\u7684\u60c5\u51b5\u4e0b\u5fc5\u5b9a\u6709\u6240\u6709\u7684\u504f\u79fb\u91cf $x$ \u7edd\u5bf9\u503c\u5747\u76f8\u7b49\u3002\u8003\u8651\u504f\u79fb\u91cf\u4e3a\u6b63\u7684\u5171 $k$ \u4e2a\uff0c\u5219\u603b\u5bf9\u6570\u4e3a $\\dfrac{(n-k)k}{2}$\uff0c\u53d6 $k=\\dfrac{n}{2}$ \u6700\u5927\u3002$n$ \u4e3a\u5947\u6570\u60c5\u51b5\u4e0b\uff0c\u5219\u4e0a\u4e0b\u53d6\u6574\u5747\u53ef\u6700\u4f18\u3002\n\n\u5148\u8003\u8651\u5076\u6570\u60c5\u51b5\u3002\u7531\u4e8e $a_i'$ \u6709\u754c\uff0c$a_i$ \u4e0d\u4e00\u5b9a\u80fd\u591f\u4efb\u610f\u504f\u79fb\u3002\u8003\u8651\u4ece\u5927\u5230\u5c0f\u679a\u4e3e\u504f\u79fb\u91cf\u7edd\u5bf9\u503c\uff0c\u521d\u59cb\u65f6 $a_i$ \u6b63\u8d1f\u504f\u79fb\u5747\u53ef\uff0c\u56fa\u5b9a $\\dfrac{n}{2}$ \u4e2a\u6b63\u504f\u79fb\uff0c\u5219\u65b9\u6848\u6570\u4e3a $C_n^{\\frac{n}{2}}$\u3002\u8be5\u60c5\u51b5\u5bf9\u6bcf\u4e2a\u504f\u79fb\u91cf\u65b9\u6848\u6570\u76f8\u540c\uff0c\u53ef $\\operatorname{O}(1)$ \u8ba1\u7b97\u3002\n\n\u504f\u79fb\u91cf\u8fbe\u5230\u4e00\u5b9a\u5927\u5c0f\u540e\uff0c\u4e00\u4fa7\u7684\u504f\u79fb\u4f1a\u53d7\u9650\u5236\uff0c\u6b64\u65f6\u504f\u79fb\u91cf\u6bcf\u589e\u52a0 $1$\uff0c\u53ea\u80fd\u5411\u4e00\u4fa7\u504f\u79fb\u7684\u5143\u7d20\u4e5f\u589e\u52a0 $1$\uff0c\u6545\u65b9\u6848\u6570\u4e3a $C_{n-i}^{\\frac{n}{2}-i}$\uff0c\u5176\u4e2d $i$ \u4e3a\u76f8\u6bd4\u4e0a\u4e00\u60c5\u51b5\u589e\u52a0\u7684\u504f\u79fb\u91cf\u3002\u76f4\u5230\u6240\u6709\u7684\u5143\u7d20\u5747\u53ea\u80fd\u5411\u4e00\u4fa7\u504f\u79fb\uff0c\u679a\u4e3e\u7ed3\u675f\u3002\n\n\u6709\u65f6\u5728\u4e0a\u4e00\u79cd\u60c5\u51b5\u7684\u57fa\u7840\u4e0a\uff0c\u504f\u79fb\u91cf\u518d\u589e\u52a0\u5230\u4e00\u5b9a\u5927\u5c0f\u65f6\uff0c\u6b63\u8d1f\u7684\u504f\u79fb\u5747\u4f1a\u53d7\u9650\uff0c\u6bcf\u589e\u52a0 $1$ \u504f\u79fb\u91cf\u5c06\u589e\u52a0 $2$ \u56fa\u5b9a\u5143\uff0c\u6545\u65b9\u6848\u6570\u4e3a $C_{n-i-2j}^{\\frac{n}{2}-i-j}$\uff0c\u5176\u4e2d $i$ \u4e3a\u4e0a\u4e00\u60c5\u51b5\u7684\u603b\u504f\u79fb\u91cf\uff0c$j$ \u4e3a\u6309\u6b64\u60c5\u51b5\u7684\u504f\u79fb\u91cf\u3002\n\n\u5404\u60c5\u51b5\u7684\u5206\u754c\u53ef\u7531 $[1,n]$ \u4e0e $[l,r]$ \u7684\u5173\u7cfb\u6c42\u5f97\u3002\n\n\u5728\u5947\u6570\u7684\u60c5\u51b5\u4e0b\uff0c$\\dfrac{n}{2}$ \u4e0a\u4e0b\u53d6\u6574\u5747\u53ef\u4f5c\u4e3a\u6b63\u504f\u79fb\u539f\u59cb\u91cf\uff0c\u6545\u6bcf\u4e00\u504f\u79fb\u91cf\u7684\u65b9\u6848\u6570\u5747\u4e3a\u4e24\u60c5\u51b5\u4e4b\u548c\u3002\n## \u4ee3\u7801\n```cpp\n#include<algorithm>\n#include<cstdio>\nusing namespace std;\n#define int long long\nconst int maxn=2e5,mod=1e9+7;\nint T,n,l,r,ans,factorial[maxn+1],inv[maxn+1];\nint power(int base,int exponent)\n{\n\tint res=1;\n\twhile(exponent)\n\t{\n\t\tif(exponent&1)\n\t\t\tres=res*base%mod;\n\t\tbase=base*base%mod;\n\t\texponent>>=1;\n\t}\n\treturn res;\n}\nint C(int x,int y)\n{\n\tif(y<0||x<y)\n\t\treturn 0;\n\treturn factorial[x]*inv[y]%mod*inv[x-y]%mod;\n}\nsigned main()\n{\n\tscanf(\"%lld\",&T);\n\tfactorial[0]=1;\n\tfor(int i=1;i<=maxn;++i)\n\t\tfactorial[i]=factorial[i-1]*i%mod;\n\tinv[maxn]=power(factorial[maxn],mod-2);\n\tfor(int i=maxn-1;~i;--i)\n\t\tinv[i]=inv[i+1]*(i+1)%mod;bool check=(T==1000);\n\twhile(T--)\n\t{\n\t\tscanf(\"%lld%lld%lld\",&n,&l,&r);\n\t\tans=0;\n\t\tint any=min(1-l,r-n),pos=max(1-l,r-n)-any;\n\t\tif(n&1)\n\t\t\tans=any*(C(n,n>>1)+C(n,(n+1)>>1))%mod;\n\t\telse ans=any*C(n,n>>1)%mod;\n\t\tif(n&1)\n\t\t{\n\t\t\tfor(int i=1;i<=pos&&((n+1)>>1)-i>=0;++i)\n\t\t\t\tans=((ans+C(n-i,(n>>1)-i))%mod+C(n-i,((n+1)>>1)-i))%mod;\n\t\t\tfor(int i=1;((n+1)>>1)-pos-i>=0;++i)\n\t\t\t\tans=((ans+C(n-(i<<1)-pos,(n>>1)-pos-i))%mod+C(n-(i<<1)-pos,((n+1)>>1)-pos-i))%mod;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor(int i=1;i<=pos&&(n>>1)-i>=0;++i)\n\t\t\t\tans=(ans+C(n-i,(n>>1)-i))%mod;\n\t\t\tfor(int i=1;(n>>1)-pos-i>=0;++i)\n\t\t\t\tans=(ans+C(n-(i<<1)-pos,(n>>1)-pos-i))%mod;\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\treturn 0;\n}\n//n/2 add x,n-n/2 minus x\n```",
        "postTime": 1626783400,
        "uid": 67952,
        "name": "\u767d\u9c9f",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1550D Excellent Arrays"
    },
    {
        "content": "## CF1550D:\n\n~~\u683c\u5f0f\u8981\u6c42\u597d\u4e25\u554a\uff0c\u6700\u540e\u4e00\u6b21\u4e13\u95e8\u6539\u683c\u5f0f\u4e86\u3002~~\n\n\u9898\u610f\u7701\u7565\u3002\n\n\u5148\u89c2\u5bdf\uff0c\u663e\u7136\u8fd9\u9053\u9898\u5e94\u8be5\u4ece $F(x)$ \u5165\u624b\uff0c\u6211\u4eec\u8003\u8651\u6784\u9020\u4e00\u4e2a\u6570\u5217\uff0c\u4e0d\u7ba1 $[l,r]$ \u7684\u9650\u5236\u7684\u60c5\u51b5\u4e0b\uff0c$F(x)$ \u7684\u6700\u5927\u503c\u3002\n\n\u663e\u7136\u5e94\u8be5\u662f\u5947\u6570\u4f4d\u7f6e $i+d$\uff0c\u5076\u6570\u4f4d\u7f6e $i-d$\uff0c\u5176\u5b83\u4efb\u4f55\u60c5\u51b5\u90fd\u4e0d\u53ef\u80fd\u6bd4\u8fd9\u79cd\u60c5\u51b5\u66f4\u5927\u3002\u56e0\u4e3a\uff0c\u8bbe\u5927\u4e8e $i$ \u7684\u6709 $x$ \u4e2a\uff0c\u5c0f\u4e8e $i$ \u7684\u6709 $y$ \u4e2a\uff0c\u7136\u540e\u7b54\u6848\u4e0a\u754c\u5c31\u662f $x * y$\uff0c\u53c8\u6709\u9650\u5236 $x + y = n$\uff0c\u663e\u7136\u6700\u5927\u503c\u5728 $x = \\lfloor \\dfrac{n}{2}\\rfloor$ \u65f6\u53d6\u5230\u3002\n\n\u800c\u4e14\u53d1\u73b0\uff0c\u5982\u679c\u60f3\u53d6\u5230\u6700\u5927\uff0c\u90a3\u4e48\u6bcf\u4e00\u4e2a\u6570 $a_i$ \u90fd\u5fc5\u987b\u662f $i+d$ \u7684\u5f62\u5f0f\uff0c\u5e76\u4e14 $i+d$ \u6216 $i-d$ \u7684\u4e2a\u6570 $x$ \u7b49\u4e8e $\\lfloor \\dfrac{n}{2}\\rfloor$\u3002\u8bc1\u660e\u662f\u7c7b\u4f3c\u7684\u3002\n\n \u73b0\u5728\u8003\u8651\u52a0\u5165 $[l,r]$ \u7684\u9650\u5236\u3002\u611f\u6027\u7406\u89e3\u4e00\u4e0b\uff0c\u5f53 $d$ \u5f88\u5c0f\u7684\u65f6\u5019\uff0c\u5176\u5b9e\u6bcf\u4e00\u4e2a\u6570\u65e0\u8bba\u600e\u4e48\u53d6\uff0c\u90fd\u662f\u53ef\u4ee5\u7684\uff0c\u53ea\u8981\u6700\u540e\u7684\u4e2a\u6570\u4e00\u6837\u5c31\u53ef\u4ee5\u4e86\u3002\u6240\u4ee5\uff0c\u6392\u9664\u600e\u4e48\u9009\u90fd\u53ef\u4ee5\u7684\u60c5\u51b5\uff0c\u7136\u540e $[l,r]$ \u4f1a\u9020\u6210\u9650\u5236\u7684\u60c5\u51b5\u4f1a\u6bd4\u8f83\u5c11\u3002\n\n\u6211\u4eec\u5148\u63a8\u4e00\u4e0b\u5f0f\u5b50\uff0c\u7136\u540e\u753b\u51e0\u5f20\u3002\n\n\u53ef\u4ee5\u9009\u62e9 $i+d$ \u7684\u6761\u4ef6\uff1a$i+d\\leq r$\uff0c\u5373 $1\\leq i\\leq r-d$\n\n\u53ef\u4ee5\u9009\u62e9 $i-d$ \u7684\u6761\u4ef6\uff1a$i+d\\leq r$\uff0c\u5373 $d+l\\leq i\\leq n$\n\n\u4e00\u5b9a\u4e0d\u5408\u6cd5\u7684\u6761\u4ef6\uff1a\n$$\nr-d < 1 \\ | \\ | \\ n<d+l\n$$\n\u4e5f\u5c31\u662f\uff1a\n$$\n\\max(r-1,n-l) < d \n$$\n\n\n\u5176\u5b9e\u8fb9\u754c\u5e94\u8be5\u66f4\u4e25\u683c\u4e00\u4e9b\uff0c\u4f46\u662f\u4e3a\u4e86\u65b9\u4fbf\u8fb9\u754c\u4e0d\u9700\u8981\u90a3\u4e48\u4e25\u683c\u3002\n\n\u6211\u4eec\u8003\u8651\u4f1a\u4e0d\u80fd\u4efb\u610f\u9009\uff0c\u4f46\u53c8\u5408\u6cd5\u7684\u65b9\u6848\u3002\n\n\u53ef\u4ee5\u753b\u51fa\u8fd9\u6837\u4e00\u5f20\u56fe\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/g9b36l8f.png)\n\n\u7ea2\u8272\u6846\u6846\u91cc\u7684\uff0c\u662f\u53ef\u4ee5\u9009\u62e9 $i+d$ \u7684\uff0c\u7eff\u8272\u6846\u6846\u91cc\u7684\u662f\u53ef\u4ee5\u9009\u62e9 $i-d$ \u7684\uff0c\u6bcf\u6b21 $d$ \u7684\u79fb\u52a8\uff0c\u90fd\u4f1a\u8ba9\u65b9\u6846\u7684\u8fb9\u754c\u79fb\u52a8\uff0c\u4ece\u5168\u90e8\u4e0d\u5728\u91cc\u9762\u79fb\u52a8\u5230\u5168\u90e8\u5305\u542b\u7684\u6b21\u6570\u4e00\u5b9a\u4e0d\u4f1a\u8d85\u8fc7 $O(n)$\n\n\u6240\u4ee5\u53ef\u4ee5\u653e\u5fc3\u5927\u80c6\u7684\u679a\u4e3e $d$ \u7edf\u8ba1\u7b54\u6848\uff0c\u7edf\u8ba1\u7b54\u6848\u7684\u65f6\u5019\u8003\u8651\u9009\u62e9\u53ef\u9009\u533a\u95f4\u8f83\u5927\u7684\u90a3\u4e00\u4e2a\uff0c\u53e6\u4e00\u4e2a\u4e0d\u80fd\u9009\u7684\u5b83\u4e00\u5b9a\u8981\u9009\uff0c\u9009\u5b8c\u4e4b\u540e\u8fd8\u8981\u9009\u4e00\u4e9b\u91cd\u5408\u7684\u5730\u65b9\u8865\u4e0a\u53bb\uff0c\u7b2c\u4e8c\u4e2a\u8fc7\u7a0b\u76f4\u63a5\u7ec4\u5408\u6570\u3002\n\n\u7136\u540e\u662f\u4e24\u4e2a\u90fd\u80fd\u9009\u7684\u90e8\u5206\uff0c\u7edf\u8ba1\u51fa\u53c8\u591a\u5c11\u4e2a $d$ \uff0c\u7136\u540e\u7ec4\u5408\u4e00\u4e0b\u3002\n\n\u7b80\u5355\u8bc1\u660e\u4e00\u4e0b\u8fd9\u6837\u662f\u4e0d\u91cd\u4e0d\u6f0f\u7684\u3002\n\n\u7b2c\u4e00\uff0c\u6bcf\u4e00\u6b21\u679a\u4e3e $d$ \u7684\u65f6\u5019\uff0c\u7edf\u8ba1\u90fd\u662f\u4e0d\u91cd\u4e0d\u6f0f\u7684\u3002~~\u4f60\u5728\u8d28\u7591\u7ec4\u5408\u6570\uff1f\uff1f~~\n\n\u7136\u540e\u5b83\u663e\u7136\u662f\u4e0d\u6f0f\u7684\u3002\n\n\u81f3\u4e8e\u4e0d\u91cd\uff0c\u5206\u4e24\u79cd\u60c5\u51b5\u8ba8\u8bba\u3002\n\n\u5947\u6570\u7684\u65f6\u5019\u663e\u7136\u662f\u4e0d\u91cd\u7684\uff0c\u56e0\u4e3a\u5b83\u4eec\u7684\u548c\u6bcf\u4e00\u6b21\u679a\u4e3e $d$ \u7684\u65f6\u5019\u90fd\u662f\u4e0d\u4e00\u6837\u7684\u3002\n\n\u5076\u6570\u7684\u60c5\u51b5\uff0c\u5047\u8bbe\u51fa\u73b0\u91cd\u590d\uff0c\u90a3\u4e48\u5fc5\u7136\u662f\u4e00\u4e2a\u7684 $+d$ \u548c\u53e6\u4e00\u4e2a\u7684 $-d$ \u7ed9\u5339\u914d\u4e0a\u4e86\uff0c\u4e00\u4e2a\u4e2a\u8ffd\u6eaf\u4e0b\u53bb\uff0c\u6700\u540e\u53d1\u73b0\u4e00\u5b9a\u6709\u4e00\u4e2a\u5339\u914d\u4e0d\u4e0a\uff0c\u77db\u76fe\u3002\n\n\u6240\u4ee5\u5b83\u662f\u4e0d\u91cd\u4e0d\u6f0f\u7684\u3002\n\n### \u53c2\u8003\u4ee3\u7801\uff1a\n\n```c++\n#include<bits/stdc++.h>\n#define y1 y3647\n#define earse erase\n#define INF 1000000000\n#define LL long long\nusing namespace std;\ninline void read(int &x)\n{\n\tx=0;int f=1;\n\tchar ch=getchar();\n\twhile(ch!=45&&(ch>'9'||ch<'0'))ch=getchar();\n\tif(ch==45){f=-1,ch=getchar();}\n\twhile(ch<='9'&&ch>='0'){x=x*10+ch-48;ch=getchar();}\n\tx*=f;\n}\nvoid cmin(int &a,int b)\n{\n\ta=min(a,b);\n}\nvoid cmax(int &a,int b)\n{\n\ta=max(a,b);\n}\n/*\n\n\n\n*/\nconst int N=1e6+10,mod=1e9+7;\nint i,j,k,n,s,t,m;\nint f[N]={1},inv[N]={1};\nint quick(int a,int s)\n{\n\tint ret=1;\n\twhile(s)\n\t{\n\t\tif(s&1)\n\t\tret=1ll*ret*a%mod;\n\t\ta=1ll*a*a%mod;\n\t\ts>>=1;\n\t}\n\treturn ret;\n}\nint C(int n,int m)\n{\n\tif(m<0)return 0;\n\tif(m>n)return 0;\n\treturn 1ll*f[n]*inv[m]%mod*inv[n-m]%mod;\n}\nsigned main()\n{\n\tfor(i=1;i<N;i++)\n\tf[i]=1ll*i*f[i-1]%mod,inv[i]=quick(f[i],mod-2);\n\tread(t);\n\twhile(t--) \n\t{\n\t\tint l,r,ans=0,d;\n\t\tread(n),read(l),read(r);\n\t\tfor(d=min(r-1,n-l);d>=1;d--)\n\t\t{\n\t\t\tint c1=min(max(0,r-d),n),c2=min(max(0,n-d-l+1),n);\n\t\t\tif(c1==n&&c2==n)break;\n\t\t\tif(c2>c1)swap(c1,c2);\n\t\t\tif(n%2)\n\t\t\t{\n\t\t\t\tans+=C(c1+c2-n,n/2-(n-c1));\n\t\t\t\tans%=mod;\n\t\t\t\tans+=C(c1+c2-n,n/2+1-(n-c1));\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tans+=C(c1+c2-n,n/2-(n-c1));\n\t\t\t}\n\t\t\tans%=mod;\n\t\t}\n\t\tif(n%2)\n\t\tans+=2ll*d*C(n,n/2)%mod;\n\t\telse\n\t\tans+=1ll*d*C(n,n/2)%mod;\n\t\t\n\t\tans%=mod;\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}\n\n```\n\n\n\n## ",
        "postTime": 1626516732,
        "uid": 177535,
        "name": "CDFLS_mao_zx",
        "ccfLevel": 7,
        "title": "\u3010\u9898\u89e3\u3011CF1550D"
    },
    {
        "content": "\u53c8\u662f\u9898\u53f7\u6253\u9519\u627e\u5230\u7684\u4e00\u9053\u6c34\u9898\u3002\n\n$a_i+a_j=i+j$ \u7a0d\u4f5c\u53d8\u5f62 $a_i-i=j-a_j$\u3002\n\n\u7136\u540e\u53d1\u73b0\u6309\u7167 $a_i-i$ \u5206\u7c7b\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f $\\sum (\\sum [a_i-i=v])\\times (\\sum [i-a_i=v])~~(v\\ge 1)$\u3002 \n\n\u7b54\u6848\u6700\u5927\u65f6\uff0c$|a_i-i|$ \u4e3a\u540c\u4e00\u4e2a\u503c\u3002\u4e14\u4e3a $+$ \u548c $-$ \u7684\u4e2a\u6570\u4e3a $\\lfloor \\frac{n}{2}\\rfloor$ \u548c $\\lceil \\frac{n}{2}\\rceil$\u3002\uff08\u4e3a\u4e86\u65b9\u4fbf\u63cf\u8ff0\uff0c $+$ \u548c $-$ \u8868\u793a $a_i-i$ \u7684\u7b26\u53f7\uff09\u3002\n\n\u6b63\u786e\u6027\u663e\u7136\uff08\u82e5 $|a_i-i|=1$ \u65f6\u4e00\u5b9a\u6210\u7acb\uff09\u3002\n\n\u66b4\u529b\uff1a\u679a\u4e3e $|a_i-i|$ \u6c42\u89e3\uff0c\u5b58\u5728\u4e09\u7c7b\u6570\uff1a\u53ea\u80fd $+$\uff1b\u53ea\u80fd $-$\uff1b$+$ \u548c $-$ \u7686\u53ef\u3002\u5982\u679c\u5b58\u5728 $+$ \u548c $-$ \u90fd\u4e0d\u884c\u7684\u4f4d\u7f6e\u90a3\u4e48\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e3a $0$\u3002\u7ec4\u5408\u4e00\u4e0b\u5c31\u53ef\u4ee5\u6c42\u51fa\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u3002\n\n\u5982\u4f55\u4f18\u5316\uff1f\u53d1\u73b0\u5bf9\u4e8e\u591a\u4e2a\u8fde\u7eed $|a_i-i|$ \u5bf9\u7b54\u6848\u7684\u8d21\u732e\u662f\u76f8\u540c\uff0c\u800c\u8fd9\u6837\u51fa\u73b0\u8d21\u732e\u7a81\u53d8\u7684\u62d0\u70b9\u4e2a\u6570\u53ea\u6709 $2\\times n$ \u4e2a\u3002\u62d0\u70b9\u4e3a $\\{ i-l+1\\}$ \u548c $\\{ r+1-i\\}$\u3002\u76f4\u63a5\u7c7b\u4f3c\u5f52\u5e76\u6c42\u89e3\u5373\u53ef\u3002\u6c42\u89e3\u65f6\u6ce8\u610f\u4e00\u4e0b $n$ \u4e3a\u5947\u6570\u7684\u60c5\u51b5\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\sum n)$\u3002\u7ec6\u8282\u770b\u4ee3\u7801\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define GC c=getchar()\n#define IG isdigit(c)\ntemplate<class T=int>T frd(T x=0,char GC,bool f=1)\n{\n\tfor(;!IG;GC)f=c!='-';for(;IG;GC)x=x*10+(c^48);return f?x:-x;\n}\nusing namespace std;\nconst int N(2e5+5),P(1e9+7);\nint t,n,l,r,_n,a[N+5],ans,fac[N+5],ifac[N+5];\ninline int fpw(int a,int b)\n{\n\tint t(1);\n\tfor(;b;b>>=1,a=1ll*a*a%P) if(b&1) t=1ll*t*a%P;\n\treturn t;\n}\ninline int C(int a,int b)\n{\n\treturn (b<0||a<b)?0:1ll*fac[a]*ifac[b]%P*ifac[a-b]%P;\n}\nsigned main()\n{\n\tfac[0]=1;\n\tfor(int i(1);i<=N;++i) fac[i]=1ll*fac[i-1]*i%P;\n\tifac[N]=fpw(fac[N],P-2);\n\tfor(int i(N);i;--i) ifac[i-1]=1ll*ifac[i]*i%P;\n\tfor(t=frd();t--;)\n\t{\n\t\tn=frd(),l=frd()-1,r=frd()+1,_n=n>>1;\n\t\tans=1ll*(min(1-l,r-n)-1)*(C(n,_n)+((n&1)?(C(n,_n+1)):0))%P;\n\t\tfor(int i(1),j(n);i<=j;)\n\t\t{\n\t\t\tint I(i-l),J(r-j),T(j-i);\n\t\t\tif(I<J) ans=(1ll*(min(i-l+1,r-j)-I)*(C(T,_n-i)+((n&1)?C(T,_n+1-i):0))%P+ans)%P,++i;\n\t\t\telse ans=(1ll*(min(i-l,r-j+1)-J)*(C(T,_n-i+1)+((n&1)?C(T,_n-i+2):0))%P+ans)%P,--j;\n\t\t}\n\t\tprintf(\"%d\\n\",ans);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1663075513,
        "uid": 312306,
        "name": "LJ07",
        "ccfLevel": 0,
        "title": "[Solution]CF1550D"
    },
    {
        "content": "[\u4f20\u9001\u95e8](https://codeforces.com/contest/1550/problem/D)\n\n\u8fd9\u662f\u6211\u79bb Master \u6700\u8fd1\u7684\u4e00\u573a\u6bd4\u8d5b\uff0c\u53ef\u60dc\u88ab C \u9898\u5361\u592a\u4e45+\u5199\u9519\u4e00\u4e2a\u53d8\u91cf\u540d\u6ca1\u770b\u51fa\u6765\u3002\n\n##### \u9898\u610f\uff1a\n\n\u5bf9\u4e8e\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6574\u6570\u5e8f\u5217\u79f0\u5176\u4e3a good \u5f53\u4e14\u4ec5\u5f53 $\\forall i,a_i \\neq i$.\uff08\u6ce8\u610f $a_i$ \u53ef\u4e3a\u8d1f\u6570\uff09\n\n\u5b9a\u4e49 $f(a)=\\sum_{i=1}^n \\sum_{j=i+1}^n[a_i+a_j=i+j]$\n\n\u5b9a\u4e49 $g(n)$ \u4e3a\u957f\u5ea6\u4e3a $n$ \u7684 good \u5e8f\u5217\u6240\u80fd\u53d6\u5230\u7684\u6700\u5927\u7684 $f$ \u7684\u503c\u3002\n\n\u8bd5\u6c42\u6ee1\u8db3\u6761\u4ef6\u7684\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217 $a$ \u7684\u4e2a\u6570\uff0c\u6ee1\u8db3 $\\forall i,l \\le a_i \\le r$ \u4e14 $f(a)=g(n)$.\n\nData Range\uff1a$2 \\le n \\le 2\\,\\times 10^5,-10^9 \\le l \\le 1,n \\le r \\le 10^9$.\n\n##### \u5206\u6790\uff1a\n\n\u8003\u8651\u7814\u7a76\u4ee4 $f$ \u53d6\u5f97\u6700\u5927\u503c\u7684 $a$ \u7684\u6761\u4ef6\u3002\u5bb9\u6613\u6784\u9020\u51fa\u4e00\u7ec4\u89e3\uff1a$1-x,2+x,3-x,...,n+(-1)^nx$. \u8bf4\u4eba\u8bdd\uff0c\u5c31\u662f\u4e00\u534a\u52a0\u4e0a\u4e00\u4e2a\u4e0d\u53d8\u7684\u5e38\u6570\uff0c\u5269\u4e0b\u4e00\u534a\u51cf\u53bb\u4e00\u4e2a\u4e0d\u53d8\u7684\u5e38\u6570\u3002\uff08\u6211\u4eec\u79f0\u8fd9\u4e2a\u5e38\u6570\u4e3a\u201c\u5dee\u201d\uff09\u3002\n\n\u7531\u6837\u4f8b $1$ \u7684\u89e3\u91ca\u53ef\u5f97\uff0c\u6211\u4eec\u53ea\u8981\u6c42\u6709\u4e00\u534a\u662f\u52a0\u4e0a\u56fa\u5b9a\u5e38\u6570\uff0c\u53e6\u4e00\u534a\u662f\u51cf\u53bb\u56fa\u5b9a\u5e38\u6570\uff0c\u800c**\u5e76\u4e0d\u5bf9\u52a0\u4e0a\u548c\u51cf\u53bb\u7684\u4f4d\u7f6e\u505a\u8981\u6c42**\u3002\u6bd4\u5982\u8bf4 $1+1,2-1,3+1$ \u53ef\u4ee5\u4ee4 $f$ \u53d6\u5230\u6700\u5927\u503c\uff0c\u540c\u6837 $1-1,2+1,3+1$ \u4e5f\u80fd\u8ba9 $f$ \u53d6\u5230\u6700\u5927\u503c\u3002\n\n\u65b9\u4fbf\u8d77\u89c1\uff0c\u6211\u4eec\u8bbe $llim_i$ \u662f $i$ \u6700\u5927\u51cf\u53bb\u591a\u5c11\u53ef\u4ee5\u4fdd\u8bc1\u4f9d\u65e7 $\\ge l$\uff1b\u7c7b\u4f3c\u5730\u5b9a\u4e49 $rlim_i$ \u662f $i$ \u6700\u5927\u52a0\u4e0a\u591a\u5c11\u53ef\u4ee5\u4fdd\u8bc1 $\\le r$.\n\n\u5bb9\u6613\u53d1\u73b0 $llim$ \u548c $rlim$ \u5206\u522b\u5f62\u5982\uff1a\n$$\nllim_1,llim_1+1,llim_1+2,...,llim_1+n-1\n$$\n\n$$\nrlim_1,rlim_1-1,rlim_1-2,...,rlim_1-n+1\n$$\n\n\u90a3\u4e48\u201c\u52a0\u201d\u5c31\u7b49\u4ef7\u4e8e\u5728 $rlim$ \u4e2d\u51cf\uff0c\u201c\u51cf\u201d\u5c31\u7b49\u4ef7\u4e8e\u5728 $llim$ \u4e2d\u51cf\u3002\u6240\u4ee5\u6211\u4eec\u7edf\u4e00\u6210\u4e86\u51cf\u6cd5\u3002\u540c\u65f6\u8981\u6c42 $llim$ \u548c $rlim$ \u4e2d\u6700\u540e\u4e0d\u80fd\u6709\u8d1f\u6570\u3002\n\n\u540c\u65f6\u6211\u4eec\u8003\u8651\u679a\u4e3e\u5dee $x$\uff08\u7531 $l,r$ \u51b3\u5b9a\u4e0a\u754c\uff0c\u4e0b\u754c\u4e3a $1$).  \u770b\u4e0a\u53bb $x$ \u662f $10^9$ \u7ea7\u522b\u7684\u3002\u663e\u7136\u66b4\u6bd9\u3002\n\n\u4f46\u662f\u6ce8\u610f\u5230\uff0c\u5bf9\u4e8e\u7edd\u5927\u591a\u6570\u7684 $x$\uff0c\u5bf9\u6bcf\u4e2a\u4f4d\u7f6e $i$ \u6765\u8bf4\uff0c$llim_i$ \u548c $rlim_i$ \u90fd\u662f\u5927\u4e8e\u7b49\u4e8e $x$ \u7684\u3002\u5f62\u5f0f\u5316\u5730\uff0c\u5728 $x \\le \\min\\{llim_1,rlim_n\\}$ \u7684\u65f6\u5019\uff0c\u5bf9\u4efb\u610f\u7684 $i$\uff0c\u4e0d\u7ba1\u5b83\u6700\u540e\u52a0 $x$ \u8fd8\u662f\u51cf $x$ \u90fd\u662f\u5728 $[l,r]$ \u8303\u56f4\u5185\u7684\u3002\n\n\u663e\u7136\u53ef\u4ee5\u6c42\u51fa\u8fd9\u6837\u7684 $x$ \u7684\u4e2a\u6570\u3002\u8bb0\u4f5c $cnt$ \u3002\u90a3\u4e48\u7b54\u6848\u5c31\u5e94\u8be5\u52a0\u4e0a\n$$\n\\begin{cases} cnt \\cdot \\dbinom{n}{n/2} ,2 \\mid n \\\\\n2cnt \\cdot \\dbinom{n}{(n+1)/2},otherwise\\end{cases}\n$$\n\uff08\u56e0\u4e3a\u5982\u679c $n$ \u4e3a\u5947\u6570\uff0c\u6bd4\u5982\u8bf4 $n=5$\uff0c\u65e2\u53ef\u4ee5\u662f $2$ \u4e2a\u52a0 $3$ \u4e2a\u51cf\u4e5f\u53ef\u4ee5\u662f $3$ \u4e2a\u52a0 $2$ \u4e2a\u51cf\uff0c\u6240\u4ee5\u5947\u5076\u9700\u8981\u5206\u7c7b\u8ba8\u8bba\uff09\u3002\n\n\u540c\u65f6\u5e94\u8be5\u6ce8\u610f\u5230\uff0c\u5bf9\u4e8e\u4e00\u4e2a $x$\u3002\u5982\u679c $llim_n<x$ \u6216\u8005 $rlim_1<x$ \u90a3\u4e48 $x$ \u672c\u8eab\u548c\u518d\u5927\u7684 $x$ \u90fd\u4e0d\u518d\u5408\u6cd5\u3002\n\n\u90a3\u4e48\u5bb9\u6613\u53d1\u73b0\uff0c\u8fd8\u4f1a\u5269\u4e0b\u4e00\u4e9b $x$ \u4f7f\u5f97\u5bf9\u4e8e\u67d0\u4e9b\u4f4d\u7f6e $i$\uff0c\u8981\u4e48\u8fd9\u4e2a\u4f4d\u7f6e\u53ea\u80fd\u52a0 $x$ \u8981\u4e48\u8fd9\u4e2a\u4f4d\u7f6e\u53ea\u80fd\u9009\u62e9\u51cf $x$. \u503c\u5f97\u6ce8\u610f\u7684\u662f\u8fd9\u6837\u7684 $x$ \u4e2a\u6570\u662f $O(n)$ \u7ea7\u522b\u7684\u3002\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4e2a\u7b80\u77ed\u7684\u8bf4\u660e\uff1a\n\n\u8fd8\u8bb0\u5f97\u4e0a\u6587\u91cc\u7684 $x \\le \\min\\{llim_1,rlim_1\\}$ \u5417\uff1f\u6211\u4eec\u4e0d\u59a8\u8bbe\u8fd9\u4e2a $\\min$ \u7684\u503c\u7b49\u4e8e $llim_1$. \u8fd9\u610f\u5473\u7740 $x>llim_1$ \u7684\u65f6\u5019 $1$ \u5904\u53ea\u80fd\u9009\u62e9\u52a0 $x$ \u4e0d\u80fd\u9009\u62e9\u51cf $x$. \u540c\u65f6\u6ce8\u610f\u5230 $x$ \u6709\u610f\u4e49\u7684\u8bdd\u5fc5\u987b\u4e0d\u8d85\u8fc7 $llim_n$ . \u4e5f\u5c31\u662f\u8bf4\u6b64\u65f6 \n$$\nllim_1 \\lt x \\le llim_n\n$$\n\u53c8\u56e0\u4e3a $llim_n=llim+n-1$\uff0c\u663e\u7136\u8fd9\u79cd\u60c5\u51b5\u7684 $x$ \u662f $O(n)$ \u7ea7\u522b\u7684\u3002\n\n\u540c\u7406\uff0c$\\min$ \u503c\u7b49\u4e8e $rlim_n$ \u7684\u65f6\u5019\u610f\u5473\u7740 $rlim_n \\le x \\le rlim_1$ \u4e5f\u662f $O(n)$ \u7ea7\u522b\u7684\u3002\n\n\u8003\u8651\u5bf9\u4e8e\u66b4\u529b\u679a\u4e3e\u7684 $x$ \u600e\u4e48\u7edf\u8ba1\u3002\u663e\u7136\u5728 $llim$ \u4e0a\u4e8c\u5206\u53ef\u4ee5\u6c42\u51fa\u53ea\u80fd\u9009\u62e9\u52a0 $x$ \u7684\u4e2a\u6570\uff0c\u56e0\u4e3a\u662f\u5728 $llim$ \u4e0a\u4e8c\u5206\u6211\u8bb0\u4f5c $lcnt$\uff1b\u540c\u7406 $rlim$ \u4e0a\u4e8c\u5206\u6c42\u51fa\u53ea\u80fd\u9009\u62e9\u51cf $x$ \u7684\u4e2a\u6570\uff0c\u8bb0\u4f5c $rcnt$. \u90a3\u4e48\u7b54\u6848\u6b64\u65f6\u52a0\u4e0a\n$$\n\\begin{cases}\\dbinom{n-lcnt-rcnt}{n/2-rcnt},2 \\mid n \\\\\n\\dbinom{n-lcnt-rcnt}{(n+1)/2-rcnt}+\\dbinom{n-lcnt-rcnt}{(n-1)/2-rcnt},otherwise\n\\end{cases}\n$$\n\u9884\u5904\u7406\u9636\u4e58\u9006\u5143\uff0c\u603b\u590d\u6742\u5ea6\u5373\u6210\u4e3a $O(n \\log n)$. \u8db3\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\n\n\u4e0d\u8fc7\u6ce8\u610f\u5230 $lcnt$ \u548c $rcnt$ \u5e94\u8be5\u662f\u6bcf\u6b21 $+1$ \u7684\u6ca1\u5fc5\u8981\u4e8c\u5206\u3002\u4f46\u662f\u9636\u4e58\u9006\u5143\u7684\u74f6\u9888\u6211\u4e0d\u592a\u4f1a\u4f18\u5316\u5230\u7ebf\u6027 qwq\n\n```c++\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(ll i=(a);i<=(b);i++)\n#define per(i,a,b) for(ll i=(a);i>=(b);i--)\n#define op(x) ((x&1)?x+1:x-1)\n#define odd(x) (x&1)\n#define even(x) (!odd(x))\n#define lc(x) (x<<1)\n#define rc(x) (lc(x)|1)\n#define lowbit(x) (x&-x)\n#define Max(a,b) (a>b?a:b)\n#define Min(a,b) (a<b?a:b)\n#define next Cry_For_theMoon\n#define il inline\n#define pb(x) push_back(x)\n#define is(x) insert(x)\n#define sit set<int>::iterator\n#define mapit map<int,int>::iterator\n#define pi pair<int,int>\n#define ppi pair<int,pi>\n#define pp pair<pi,pi>\n#define fr first\n#define se second\n#define vit vector<int>::iterator\n#define mp(x,y) make_pair(x,y)\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef unsigned int uint;\ntypedef double db;\nusing namespace std;\nconst int MAXN=2e5+10,mod=1e9+7;\nll t,n,l,r,ans;\nll llim[MAXN],rlim[MAXN],fact[MAXN],inv[MAXN];\nll rtmp[MAXN];\nll power(ll a,ll n){\n\tif(!n)return 1;\n\tll tmp=power(a,n/2);tmp=tmp*tmp%mod;\n\tif(n&1)tmp=tmp*a%mod;\n\treturn tmp; \n}\nll C(ll n,ll m){\n\tif(n<0 || m<0)return 0; \n\tif(m>n)return 0;\n\treturn fact[n]*inv[m]%mod*inv[n-m]%mod;\n}\nint main(){\n\tfact[0]=1;\n\trep(i,1,2e5)fact[i]=fact[i-1]*i%mod;\n\trep(i,0,2e5)inv[i]=power(fact[i],mod-2);\n\tcin>>t;\n\twhile(t--){\n\t\tcin>>n>>l>>r;\n\t\trep(i,1,n){\n\t\t\tllim[i]=i-l;\n\t\t\trlim[i]=r-i;\n\t\t}\n\t\trep(i,1,n){\n\t\t\trtmp[i]=rlim[n-i+1];\n\t\t}\n\t\tans=0;\n\t\tll L=1,R=Min(llim[n],rlim[1]);\n\t\tif(L>R){\n\t\t\tprintf(\"0\\n\");continue;\n\t\t}\n\t\t//\u5dee\u5728[L,R]\u4e4b\u95f4\n\t\tll lim=Min(llim[1],rlim[n]); //\u6700\u5927\u9009\u5230lim\u90fd\u6ca1\u6709\u9650\u5236 \n\t\tif(lim>=L){\n\t\t\tans=(ans+(lim-L+1)*C(n,(n+1)/2)*(1+odd(n))%mod)%mod;\n\t\t} \n\t\trep(j,Max(L,lim+1),R){\n\t\t\t//\u8003\u8651\u66b4\u529b\u8ba1\u7b97\u5408\u6cd5\u65b9\u6848\u4e2a\u6570\n\t\t//\tprintf(\"\u5dee\u4e3a%d\\n\",j);\n\t\t\tint lcnt=lower_bound(llim+1,llim+1+n,j)-llim-1; //\u524dlcnt\u4e2a\u53ea\u80fd\u9009r\n\t\t\tint rcnt=lower_bound(rtmp+1,rtmp+1+n,j)-rtmp-1; //\u540ercnt\u4e2a\u53ea\u80fd\u9009l\n\t\t//\tprintf(\"lcnt:%d rcnt:%d\\n\",lcnt,rcnt);\n\t\t//\tprintf(\"%d %d\\n\",(n+1)/2,n-(n+1)/2);\n\t\t\tif(lcnt+rcnt>n)break;\n\t\t\tans=(ans+C(n-lcnt-rcnt,(n+1)/2-rcnt))%mod;\n\t\t\tif(odd(n))ans=(ans+C(n-lcnt-rcnt,n-(n+1)/2-rcnt))%mod; \n\t\t//\tprintf(\"ans:%d\\n\",ans);\n\t\t}\n\t\tprintf(\"%lld\\n\",ans);\n\t}\n\n\treturn 0;\n}\n```\n\n",
        "postTime": 1626499396,
        "uid": 340632,
        "name": "Cry_For_theMoon",
        "ccfLevel": 8,
        "title": "\u3010CF1550D\u3011Excellent Arrays"
    },
    {
        "content": "### $\\text{Difficulty : 2300}$\n---\n### \u89e3\u9898\u601d\u8def\uff1a\n\n$F(a)$ \u548c $a_i$\uff0c$a_j$\uff0c$i$ \u548c $j$ \u90fd\u6709\u5173\u7cfb\uff0c\u4e0d\u597d\u5904\u7406\uff0c\u8003\u8651\u901a\u8fc7\u5c06 $a$ \u53d8\u5316\u4e3a $b_i=a_i-i$ \u6765\u8f6c\u5316\u95ee\u9898\u3002\n\n\u90a3\u4e48\u539f\u6765\u7684 $a_i+a_j=i+j$ \u4e5f\u5c31\u88ab\u8f6c\u5316\u4e3a\u4e86 $b_i+b_j=0$\u3002\u7531\u6b64\u8f7b\u677e\u5f97\u51fa\u8981 $F(a)$ \u6700\u5927\u5c31\u662f\u8981 $b_i$ \u4e2d\u6709\u4e00\u534a\u662f $-x$ \u4e00\u534a\u662f $x$\uff0c\u5982\u679c\u957f\u5ea6\u4e3a\u5947\u6570\uff0c\u53ef\u4ee5\u5dee\u4e00\u4e2a\u3002\u800c\u4e14 $b$ \u4e2d\u4e0d\u5b58\u5728 $0$\uff0c\u4e5f\u5c31\u662f\u6ee1\u8db3 $a_i\\neq i$\u3002\n\n\u7136\u540e\u8003\u8651\u6570\u503c\u7684\u8303\u56f4 $[l,r]$\uff0c\u4e0d\u59a8\u8bbe\u5f53\u524d\u7684 $|b_i|=u$\uff0c$u$ \u548c $-u$ \u90fd\u80fd\u53d6\u5230\u7684\u6709 $x$ \u4e2a\uff0c\u53ea\u80fd\u53d6\u5230\u6b63\u7684\u6709 $y$ \u4e2a\uff0c\u53ea\u80fd\u53d6\u5230\u8d1f\u7684\u6709 $z$ \u4e2a\u3002\u5982\u679c\u6709\u6570\u4e24\u4e2a\u90fd\u4e0d\u80fd\u53d6\u5230\uff0c\u90a3\u4e48\u603b\u65b9\u6848\u6570\u4e3a $0$\u3002\u5f53 $x+z\\le \\dfrac{x+y+z}{2}$ \u6216\u8005 $x+y\\le\\dfrac{x+y+z}{2}$ \u7684\u65f6\u5019\u4e5f\u6ca1\u6709\u89e3\u3002\n\n\u6b64\u65f6\u9700\u8981\u5206\u60c5\u51b5\u8ba8\u8bba\uff1a\n\n1. \u5982\u679c $n$ \u662f\u5076\u6570\uff0c\u90a3\u4e48\u80fd\u53d6\u5230\u65b9\u6848\u6570\u6709\uff1a$C(x,\\dfrac{(x-y+z)}{2})$\uff0c\u6216\u8005 $C(x,\\dfrac{(x+y-z)}{2})$\uff0c\u4e24\u8005\u663e\u7136\u76f8\u7b49\u3002\n\n2. \u5426\u5219\u5c31\u9700\u8981\u77e5\u9053\u662f\u6b63\u7684\u591a\u4e00\u70b9\u8fd8\u662f\u8d1f\u7684\u591a\u4e00\u70b9\u4e86\u3002\u518d\u5206\u60c5\u51b5\u8ba8\u8bba\uff0c\u5f53 $x+y\\ge \\dfrac{x+y+z}{2}+1$\uff0c\u4e5f\u5c31\u662f\u6709\u53ef\u80fd\u6b63\u7684\u591a\uff0c\u5c31\u6709 $C(x,\\dfrac{x+y+z}{2}-y+1)$\u3002\u53e6\u4e00\u79cd\u5c31\u662f\u5f53 $x+z\\ge\\dfrac{x+y+z}{2}+1$ \u65f6\uff0c\u80fd\u591f\u4ea7\u751f $C(x,\\dfrac{x+y+z}{2}-z+1)$ \u7684\u65b9\u6848\u6570\u3002\n\n---\n\n\u4ec5\u4ec5\u8fd9\u6837\u662f\u4e0d\u80fd\u901a\u8fc7\u8fd9\u9053\u9898\u7684\uff0c\u6570\u636e\u8303\u56f4\u5f88\u5927\uff0c\u76f4\u63a5\u679a\u4e3e\u590d\u6742\u5ea6\u663e\u7136\u7206\u70b8\u3002\n\n\u4f46\u662f\u53ef\u4ee5\u53d1\u73b0\u53ea\u8981 $x$\uff0c$y$ \u548c $z$ \u662f\u76f8\u7b49\u7684\uff0c\u8ba1\u7b97\u51fa\u6765\u7684\u7ed3\u679c\u4e5f\u5c31\u662f\u4e00\u6837\u7684\uff0c\u53ef\u4ee5\u8003\u8651\u4e2d\u95f4\u8df3\u8fc7\u5927\u6bb5\u7684\u8ba1\u7b97\u8fc7\u7a0b\uff0c\u76f4\u63a5\u6839\u636e\u6709\u503c\u53d8\u5316\u7684\u70b9\u8ba1\u7b97\u7ed3\u679c\u3002\n\n\u90a3\u4e48\u5c31\u8ba1\u7b97\u51fa\u6bcf\u4e00\u4e2a\u70b9\u7684\u53d8\u5316\u8303\u56f4 $[l,r]$\uff0c\u7136\u540e\u5c06\u6bcf\u4e00\u4e2a $l$ \u6216\u8005 $r$ \u8bbe\u7f6e\u4e3a\u53ef\u80fd\u7684\u53d8\u5316\u70b9\uff0c\u6392\u5e8f\u5e76\u8bb0\u5f55\u4e0b\u5f53\u524d\u4e09\u4e2a\u53d8\u91cf\u7684\u503c\u5c31\u597d\u4e86\u3002\n\n---\n### \u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\n#define int long long\nconst int MAXN=400005,MOD=1000000007;\nint F[MAXN],F_[MAXN],n,l,r,T,f[MAXN][2],cnt,x,y,z,ans;\nstruct str{\n\tint id,x,type;\n\tbool operator < (str a){\n\t\treturn x<a.x;\n\t}\n}num[MAXN];\nint pow(int a,int b){\n\tint ans=1;\n\twhile(b){\n\t\tif(b&1)ans=(ans*a)%MOD;\n\t\ta=(a*a)%MOD;\n\t\tb=b>>1;\n\t}\n\treturn ans;\n}\nvoid init(){\n\tF[0]=1;F_[0]=1;\n\tfor(int i=1;i<=200000;i++)F[i]=(F[i-1]*i)%MOD;\n\tfor(int i=1;i<=200000;i++)F_[i]=pow(F[i],MOD-2)%MOD;\n}\nint C(int n,int m){return (F[n]*F_[n-m]%MOD)*(F_[m])%MOD;}\nvoid calc(int len){\n\tif(x+y+z==n&&x+y>=n/2&&x+z>=n/2){\n\t\tif(n%2==0)ans=(ans+C(x,n/2-y)*len)%MOD;\n\t\telse{\n\t\t\tif(x+y>=n/2+1)ans=(ans+C(x,n/2-y+1)*len)%MOD;\n\t\t\tif(x+z>=n/2+1)ans=(ans+C(x,n/2-z+1)*len)%MOD;\n\t\t}\n\t}\n}\nvoid fit(int p){\n\tif(num[p].type==1){\n\t\tf[num[p].id][1]=1;\n\t\tif(f[num[p].id][0]==1)x++,z--;\n\t\telse y++;\n\t}\n\tif(num[p].type==2){\n\t\tf[num[p].id][0]=1;\n\t\tif(f[num[p].id][1]==1)x++,y--;\n\t\telse z++;\n\t}\n}\nsigned main(){\n\tinit();\n\tscanf(\"%I64d\",&T);\n\twhile(T--){\n\t\tscanf(\"%I64d%I64d%I64d\",&n,&l,&r);\n\t\tcnt=1;num[1].type=114514;\n\t\tmemset(f,0,sizeof(f));\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tint L=abs(i-l),R=abs(r-i);\n\t\t\tif(L!=0){\n\t\t\t\tnum[++cnt].id=i;\n\t\t\t\tnum[cnt].type=1;\n\t\t\t\tnum[cnt].x=L;\n\t\t\t}\n\t\t\tif(R!=0){\n\t\t\t\tnum[++cnt].id=i;\n\t\t\t\tnum[cnt].type=2;\n\t\t\t\tnum[cnt].x=R;\n\t\t\t}\n\t\t}\n\t\tsort(num+1,num+cnt+1);\n\t\tx=0;y=0;z=0;ans=0;\n\t\tfor(int i=cnt;i>1;i--){\n\t\t\twhile(num[i-1].x==num[i].x)fit(i),i--;\n\t\t\tfit(i);\n\t\t\tcalc(num[i].x-num[i-1].x);\n\t\t}\n\t\tprintf(\"%I64d\\n\",ans);\n\t}\n\treturn 0;\n}\n/*\n\n1\n2 -2 5\n\n*/\n```\n\n",
        "postTime": 1647526346,
        "uid": 223559,
        "name": "qxp101",
        "ccfLevel": 6,
        "title": "CF1550D Excellent Arrays \u9898\u89e3"
    }
]
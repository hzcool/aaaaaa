[
    {
        "content": "\u9996\u5148\u5982\u679c $\\sum_{i=1}^na_i \\neq \\sum_{i=1}^nb_i$\uff0c\u663e\u7136\u65e0\u89e3\u3002  \n\u63a5\u4e0b\u6765\u8003\u8651\u4f9d\u6b21\u6ee1\u8db3\u6240\u6709\u6c34\u6876\u7684\u8981\u6c42\u3002\u4efb\u53d6\u4e24\u4e2a\u6c34\u6876 $s,t$ \u6ee1\u8db3 $a_s>b_s,a_t<b_t$\uff0c\u5219\u53ef\u4ee5\u8fd0\u8f93 $\\min(a_s-b_s,b_t-a_t)$ \u7684\u6c34\u3002\u7528\u4e00\u4e2a\u9012\u5f52\u51fd\u6570 `f(s, t, d)` \u8868\u793a\u4ece $s$ \u5411 $t$ \u8fd0\u8f93 $d$ \u7684\u6c34\u7684\u8fc7\u7a0b\u3002\u8bbe $t^\\prime$ \u4e3a $s \\rightarrow t$ \u8def\u5f84\u4e0a $t$ \u4e4b\u524d\u7684\u90a3\u4e2a\u70b9\uff0c\u5219\u5148\u5c3d\u91cf\u591a\u7684\u4ece $t^\\prime$ \u5411 $t$ \u8fd0\u8f93\u6c34\uff0c\u63a5\u7740\u8fd0\u884c `f(s, t', d)`\u3002\u5982\u679c\u7b2c\u4e00\u6b21\u6c34\u4e0d\u591f\u7528\uff0c\u518d\u8865\u8db3\u4e0d\u8db3\u7684\u6c34\u3002\u8fd9\u6837\u4e00\u6b21\u8fd0\u8f93\u8fc7\u7a0b\u6700\u591a\u4f7f\u7528 $2n$ \u6b21\u64cd\u4f5c\uff0c\u56e0\u6b64\u603b\u6b21\u6570\u4e0d\u8d85\u8fc7 $2n^2$\u3002  \n\u7531\u4e8e $n$ \u5f88\u5c0f\uff0c\u53ef\u4ee5\u66b4\u529b\u5b58\u50a8\u6240\u6709\u7684\u8def\u5f84\uff0c\u56e0\u6b64\u5b9e\u73b0\u8f83\u4e3a\u7b80\u5355\u3002\u6ce8\u610f\u7279\u5224\u4e24\u70b9\u4e0d\u8fde\u901a\u7684\u60c5\u51b5\u3002\n```cpp\n#include <algorithm>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\n#include <numeric>\n#include <tuple>\n#include <vector>\nchar Gc() {\n  static char now[1 << 20], *S, *T;\n  if (T == S) {\n    T = (S = now) + std::fread(now, 1, 1 << 20, stdin);\n    if (T == S) return EOF;\n  }\n  return *S++;\n}\ntemplate <typename T>\nvoid Read(T &x) {\n  x = 0;\n  int f = 1;\n  char c;\n  while ((c = Gc()) < '0' || c > '9')\n    if (c == '-') f = -1;\n  x = c - '0';\n  while ((c = Gc()) >= '0' && c <= '9') x = x * 10 + (c - '0');\n  x *= f;\n}\ntemplate <typename T, typename... Args>\nvoid Read(T &x, Args &...args) {\n  Read(x);\n  Read(args...);\n}\ntemplate <typename T>\nvoid checkmax(T &x, T y) {\n  if (x < y) x = y;\n}\ntemplate <typename T>\nvoid checkmin(T &x, T y) {\n  if (x > y) x = y;\n}\nstruct Edge {\n  int to, nxt;\n} e[100001];\nint n, v, m, E, head[301], a[301], b[301], s;\nstd::vector<int> v1, v2, g[301][301], tmp;\nstd::vector<std::tuple<int, int, int>> ans;\nbool vis[301];\nvoid Add(int f, int t) {\n  e[E].to = t;\n  e[E].nxt = head[f];\n  head[f] = E++;\n}\nvoid Dfs(int u) {\n  g[s][u] = tmp;\n  for (int i = head[u]; i != -1; i = e[i].nxt) {\n    int v = e[i].to;\n    if (vis[v]) continue;\n    tmp.emplace_back(v);\n    vis[v] = true;\n    Dfs(v);\n    tmp.pop_back();\n  }\n}\nvoid Transfer(int s, int t, int d) {\n  if (s == t || g[s][t].empty()) return;\n  int pre = g[s][t][g[s][t].size() - 2], cnt = std::min(a[pre], d);\n  ans.emplace_back(pre, t, cnt);\n  a[pre] -= cnt;\n  a[t] += cnt;\n  Transfer(s, pre, d);\n  if (cnt < d) {\n    ans.emplace_back(pre, t, d - cnt);\n    a[pre] -= d - cnt;\n    a[t] += d - cnt;\n  }\n}\nint main(int argc, char const *argv[]) {\n  std::memset(head, -1, sizeof(head));\n  Read(n, v, m);\n  for (int i = 1; i <= n; i++) Read(a[i]);\n  for (int i = 1; i <= n; i++) Read(b[i]);\n  if (std::accumulate(a + 1, a + n + 1, 0LL) !=\n      std::accumulate(b + 1, b + n + 1, 0LL)) {\n    std::printf(\"NO\");\n    return 0;\n  }\n  for (int i = 1; i <= m; i++) {\n    int u, v;\n    Read(u, v);\n    Add(u, v);\n    Add(v, u);\n  }\n  for (int i = 1; i <= n; i++)\n    if (a[i] > b[i])\n      v1.emplace_back(i);\n    else if (a[i] < b[i])\n      v2.emplace_back(i);\n  for (s = 1; s <= n; s++) {\n    std::memset(vis, false, sizeof(vis));\n    tmp.emplace_back(s);\n    vis[s] = true;\n    Dfs(s);\n    tmp.pop_back();\n  }\n  std::size_t p1 = 0, p2 = 0;\n  while (p1 < v1.size() && p2 < v2.size())\n    if (a[v1[p1]] - b[v1[p1]] == b[v2[p2]] - a[v2[p2]]) {\n      int d = a[v1[p1]] - b[v1[p1]];\n      Transfer(v1[p1++], v2[p2++], d);\n    } else if (a[v1[p1]] - b[v1[p1]] < b[v2[p2]] - a[v2[p2]]) {\n      int d = a[v1[p1]] - b[v1[p1]];\n      Transfer(v1[p1++], v2[p2], d);\n    } else {\n      int d = b[v2[p2]] - a[v2[p2]];\n      Transfer(v1[p1], v2[p2++], d);\n    }\n  for (int i = 1; i <= n; i++)\n    if (a[i] != b[i]) {\n      std::printf(\"NO\");\n      return 0;\n    }\n  std::printf(\"%d\\n\", static_cast<int>(ans.size()));\n  for (auto &&i : ans)\n    std::printf(\"%d %d %d\\n\", std::get<0>(i), std::get<1>(i), std::get<2>(i));\n  return 0;\n}\n```",
        "postTime": 1620218859,
        "uid": 68273,
        "name": "xyf007",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF317C \u3010Balance\u3011"
    },
    {
        "content": "\u90a3\u4e48\u9996\u5148\u660e\u786e\uff0c$a_i<b_i$ \u7684\u70b9\u662f\u9700\u8981\u522b\u7684\u70b9\u5f15\u5165\u7684\uff0c\u800c $a_i>b_i$ \u7684\u70b9\u662f\u9700\u8981\u4f9b\u7ed9\u7ed9\u522b\u7684\u70b9\u7684\u3002\u9996\u5148\u5bf9\u4e8e\u6bcf\u4e2a\u8fde\u901a\u5757 $\\sum a_i\\ne \\sum b_i$ \u5219\u4e00\u5b9a\u65e0\u89e3\u3002\u90a3\u4e48\u6211\u4eec\u4fbf\u53ef\u4ee5\u5c06\u95ee\u9898\u653e\u5728\u751f\u6210\u6811\u4e0a\u8003\u8651\uff0c\u56e0\u4e3a $O(n^2)$ \u7684\u64cd\u4f5c\u6b21\u6570\u8fd8\u662f\u6bd4\u8f83\u677e\u7684\u3002\n\n\u90a3\u4e48\u6709\u4e00\u4e2a\u6700\u6734\u7d20\u7684\u601d\u8def\u5c31\u662f\u679a\u4e3e\u8fd9\u4e9b $a_i < b_i$ \u7684\u70b9\uff0c\u7136\u540e\u8ba9\u540c\u4e00\u8fde\u901a\u5757\u5185\u7684 $a_i > b_i$ \u70b9\u5bf9\u5176\u8fdb\u884c\u4f9b\u7ed9\uff0c\u7531\u4e8e\u6709 $v$ \u7684\u9650\u5236\uff0c\u6700\u591a\u9700\u8981\u8fdb\u884c $2(n-1)$ \u6b21\uff08\u4e00\u6b21\u4e0d\u884c\u54b1\u5c31\u4e24\u6b21\uff09\u3002\n\n\u4f46\u540c\u65f6\u6211\u4eec\u4e5f\u6709\u66f4\u4f18\u7684\u601d\u8def\uff1a\u4ece\u53f6\u5b50\u8282\u70b9\u5f00\u59cb\uff0c\u82e5\u5176\u6ee1\u8db3 $a_i < b_i$\uff0c\u5219\u4ece\u5176\u90bb\u8fd1\u8282\u70b9\u201c\u5438\u8840\u201d\u4ee5\u6ee1\u8db3\u81ea\u5df1\u7684\u6761\u4ef6\uff0c\u82e5\u90bb\u8fd1\u8282\u70b9\u4e0d\u591f\u5c31\u9012\u5f52\u7ee7\u7eed\u5438\uff0c\u7136\u540e\u6ee1\u8db3\u4e86\u8fd9\u4e2a\u53f6\u5b50\u8282\u70b9\u7684\u9650\u5236\u540e\uff0c\u5220\u6389\u8fd9\u4e2a\u53f6\u5b50\u8282\u70b9\u3002\u95ee\u9898\u4fbf\u53d8\u6210\u4e86\u89c4\u6a21 $-1$ \u7684\u5b50\u95ee\u9898\uff08\u5f53\u7136\u524d\u63d0\u662f\u6709\u89e3\uff09\uff0c\u800c\u4e00\u6b21\u8fd9\u6837\u7684\u8c03\u6574\u6700\u591a\u9700\u8981 $n-1$ \u6b21\u64cd\u4f5c\uff0c\u6240\u4ee5\u8fd9\u6837\u505a\u4e0a\u754c\u5c31\u662f $n^2$ \u7684\u4e86\uff08\u800c\u4e14\u611f\u89c9\u6bd4\u8f83\u677e\uff09\u3002\u5bf9\u4e8e $a_i > b_i$ \u7684\u70b9\u5c31\u9012\u5f52\u91ca\u653e\u5373\u53ef\uff0c\u601d\u8def\u7c7b\u4f3c\u3002\n\n\u4ee3\u7801\u7ec6\u8282\u7a0d\u5fae\u6709\u4e00\u70b9\u5c0f\u591a\uff0c\u9700\u8981\u597d\u597d\u5b9e\u73b0\u4e00\u4e0b\u3002\n\n\n```cpp\n#include <bits/stdc++.h>\n#define FOR(i, a, b) for (int i = (a); i <= (b); ++i)\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n\nusing namespace std;\nconst int maxn = 305;\nint n, V, m, a[maxn], b[maxn];\nvector<int> G[maxn], T[maxn];\nint vis[maxn], deg[maxn];\nlong long suma, sumb;\nqueue<int> q;\n\nstruct Op {\n    int x, y, d;\n    Op(int _x = 0, int _y = 0, int _d = 0) : x(_x), y(_y), d(_d) {}\n};\nvector<Op> ans;\n\nvoid dfs0(int u) {\n    vis[u] = 1;\n    suma += a[u], sumb += b[u];\n    for (auto &v : G[u]) if (!vis[v]) {\n        T[u].push_back(v), T[v].push_back(u);\n        ++deg[u], ++deg[v];\n        dfs0(v);\n    }\n    if (deg[u] == 1) q.push(u);\n    return;\n}\n\nint dfs1(int u, int fa, int in) { // \u8fd4\u56de\u6d88\u5316\u4e86\u7684\u6d41\u91cf\n    int ta = a[u] + in, orga = a[u], out = 0;\n    if (ta >= 0 && ta <= V) {\n        a[u] = ta;\n        if (in >= 0) ans.push_back(Op(fa, u, in));\n        else ans.push_back(Op(u, fa, -in));\n        return in;\n    } else if (ta < 0) { // in < 0 fa \u5438\u8840 u\n        for (auto &v : T[u]) if (v != fa && vis[v] != 2) {\n            int cur = dfs1(v, u, ta);\n            ta -= cur, out += cur;\n            if (ta >= 0) break;\n        }\n        a[u] = max(0, ta);\n        ans.push_back(Op(u, fa, orga - a[u] - out));\n        return a[u] - orga + out;\n    } else if (ta > V) {\n        for (auto &v : T[u]) if (v != fa && vis[v] != 2) {\n            int cur = dfs1(v, u, ta - V);\n            ta -= cur, out += cur;\n            if (ta <= V) break;\n        }\n        a[u] = min(V, ta);\n        ans.push_back(Op(fa, u, a[u] - orga + out));\n        return a[u] - orga + out;\n    }\n    return 0;\n}\n\nint main() {\n    cin >> n >> V >> m;\n    FOR(i, 1, n) cin >> a[i];\n    FOR(i, 1, n) cin >> b[i];\n    FOR(i, 1, m) {\n        int u, v;\n        cin >> u >> v;\n        G[u].push_back(v), G[v].push_back(u);\n    }\n    FOR(i, 1, n) if (!vis[i]) {\n        suma = sumb = 0;\n        dfs0(i);\n        if (suma != sumb) return puts(\"NO\"), 0;\n        while (!q.empty()) {\n            int u = q.front(); q.pop();\n            int v = -1;\n            for (auto &vv : T[u]) if (vis[vv] != 2) {\n                v = vv;\n                break;\n            }\n            if (v == -1) continue;\n            dfs1(v, u, a[u] - b[u]);\n            a[u] = b[u];\n            vis[u] = 2;\n            if (--deg[v] == 1) q.push(v);\n        }\n    }\n    cout << ans.size() << endl;\n    for (auto &o : ans) cout << o.x << ' ' << o.y << ' ' << o.d << '\\n';\n    return 0;\n}\n```\n\n",
        "postTime": 1656939050,
        "uid": 212488,
        "name": "\u6e05\u70db",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF317C Balance"
    },
    {
        "content": "[\u9898\u4f20](https://www.luogu.com.cn/problem/CF317C)\n\n\u663e\u7136\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8fde\u901a\u5757\u82e5 $\\sum_{i=1}^{|S|}a_{S_i}\\ne\\sum_{i=1}^{|S|}b_{S_i}$ \u65e0\u89e3\uff0c\u5426\u5219\u6211\u4eec\u5fc5\u7136\u73c2\u4ee5\u6784\u9020\u51fa\u4e00\u7ec4\u89e3\uff08\u4e0d\u8003\u8651\u6b65\u6570\u9650\u5236\uff09\u3002\n\n\u4e0a\u9762\u6700\u540e\u4e00\u53e5\u8bdd\u5f15\u5bfc\u6211\u4eec\u60f3\u5230\u56fe\u7684\u8fde\u901a\u6027\u662f\u89e3\u9898\u8981\u70b9\uff0c\u5197\u4f59\u7684\u8fb9\u6ca1\u7528\uff0c\u5c06\u56fe\u7f29\u5c0f\u5230\u6811\uff0c\u5373\u968f\u4fbf\u6c42\u4e00\u68f5\u539f\u56fe\u7684\u751f\u6210\u68ee\u6797\uff0c\u5728\u4e0a\u9762\u6c42\u89e3\u3002\n\n\u5f53\u4e00\u4e2a\u70b9\u6ee1\u8db3\u4e86 $a_i=b_i$\uff0c\u6211\u4eec\u79f0\u5176\u662f\u9501\u5b9a\u7684\uff0c\u73b0\u5728\u8003\u8651\u4e00\u4e2a\u975e\u5e38\u66b4\u529b\u5730\u505a\u6cd5\u3002\n\n\u5bf9\u4e8e\u4e00\u68f5\u5b50\u6811\uff0c\u5047\u8bbe\u5176\u9664\u4e86\u6839\u8282\u70b9\u5916\u7684\u70b9\u90fd\u5df2\u7ecf\u9501\u5b9a\uff0c\u90a3\u4e48\u6211\u4eec\u4e0d\u518d\u4f7f\u7528\u513f\u5b50\u53d6\u6ee1\u8db3\u6839\u7684\u6761\u4ef6\uff0c\u800c\u662f\u7528\u5b50\u6811\u5916\u6240\u6709\u672a\u9501\u5b9a\u7684\u70b9\uff08\u5f53\u6211\u4eec\u53ea\u505a\u4e86\u5b50\u6811\u7684\u65f6\u5019\uff0c\u8fd9\u4e9b\u70b9\u663e\u7136\u8fd8\u662f\u80fd\u6784\u6210\u4e00\u4e2a\u8fde\u901a\u5757\uff09\u53bb\u6ee1\u8db3\uff0c\u8fd9\u91cc\u5047\u8bbe\u6839\u7684\u73b0\u72b6\u662f $a>b$ \uff08\u5c0f\u4e8e\u540c\u7406\uff09\uff0c\u5177\u4f53\u64cd\u4f5c\u5982\u4e0b\uff1a\n\n1. \u4ece\u5f53\u524d\u6839\u51fa\u53d1\u8fdb\u884c\u5411\u5916\u7684 dfs\uff0c\u8bbe\u9012\u5f52\u5230 $x$\n\n1. \u6bcf\u5f53\u9012\u5f52\u5b8c $x$ \u7684\u4e00\u4e2a\u540e\u7ee7\u7ed3\u70b9 $y$ \u4e4b\u540e\uff0c\u5c06 $x$ \u5185\u7684\u503c\u5c3d\u53ef\u80fd\u5730\u63a8\u5411 $y$\u3002\n\n1. \u56de\u6eaf\u3002\n\n\u7279\u522b\u7684\uff0c\u5f53\u7b2c\u4e8c\u5e03\u4e2d $x$ \u4e3a\u5b50\u6811\u7684\u6839\u65f6\uff0c\u6211\u4eec\u5c06 $x$ \u9700\u8981\u51cf\u5c0f\u5230\u7684\u4e0b\u754c\u4ece $0$ \u8c03\u5230 $b$\u3002\n\n\u5176\u5b9e\u8fd9\u5c31\u7c7b\u4f3c\u4e8e\u8ba9\u6240\u6709\u975e\u9501\u5b9a\u7ed3\u70b9\uff08\u76f8\u5bf9\u4e8e\u6839\u7684\u4f4d\u7f6e\uff09\u5c3d\u91cf\u5f80\u540e\u9762\u632a\uff0c\u817e\u51fa\u4f4d\u7f6e\u628a $a-b$ \u7684\u6c34\u6392\u51fa\u6765\u3002\uff08\u5c0f\u4e8e\u5c31\u76f8\u5f53\u4e8e\u628a\u6240\u6709\u7684\u6c34\u5f80\u6839\u805a\u62e2\uff09\u3002\n\n\u5206\u6790\uff1a\u6bcf\u6b21\u90fd\u81f3\u5c11\u4f1a\u8ba9\u5f53\u524d\u5b50\u6811\u7684\u6839\u9501\u5b9a\uff0c\u5728\u4e00\u8f6e\u4e2d\u6bcf\u4e2a\u70b9\u53ea\u4f1a\u4e0e\u81ea\u5df1\u7684\u7236\u4eb2\u4ea7\u751f\u4e00\u6b21\u4ea4\u6362\uff0c\u56e0\u6b64\u4ea4\u6362\u6b21\u6570\uff08\u5e94\u8be5\u662f\uff09\u6700\u591a\u53ea\u6709 $O(n(n-1))$ \u6b21\u7684\uff0c\u5341\u5206\u5bbd\u88d5\u3002\n\n\u590d\u6742\u5ea6 $O(n^2+m)$\u3002\n\n[$Code$](https://codeforces.com/problemset/submission/317/158742684)",
        "postTime": 1653757951,
        "uid": 341102,
        "name": "ReKoJ",
        "ccfLevel": 0,
        "title": "qifan AK IOI"
    }
]
[
    {
        "content": "## \u524d\u8a00\n\n\u8fd9\u573a\u7684 C \u628a\u6211\u84dd\u540d\u641e\u6ca1\u4e86\uff0c\u8fd9\u4e48\u7b80\u5355\u7684 D1 \u5c45\u7136\u6ca1\u770b\u2026\u2026\n\n## \u89e3\u6cd5\n\n\u5982\u679c $k=1$ \u6216 $k=3$\uff0c\u90a3\u4e48\u201c\u597d\u5c9b\u201d\u53ea\u53ef\u80fd\u6709\u4e14\u4ec5\u6709 $1$ \u4e2a\uff1a$k=1$ \u663e\u7136\u201c\u597d\u5c9b\u201d\u5c31\u662f\u9009\u5b9a\u7684\u90a3\u4e2a\u5c9b\uff1b$k=3$ \u65f6\uff0c\u82e5 $3$ \u4e2a\u5c9b\u5728\u540c\u4e00\u6761\u94fe\u4e0a\uff0c\u201c\u597d\u5c9b\u201d\u5c31\u662f\u4e2d\u95f4\u7684\u90a3\u4e2a\u5c9b\uff0c\u5426\u5219 $3$ \u4e2a\u5c9b\u4e2d\u95f4\u56f4\u4f4f\u7684\u90e8\u5206\u5f62\u6210\u4e86\u4e00\u4e2a\u201c\u4eba\u201d\u5b57\u5f62\uff0c\u201c\u597d\u5c9b\u201d\u5373\u4e3a\u201c\u4eba\u201d\u5b57\u4e2d\u7684\u90a3\u4e2a\u5206\u53c9\u5904\u7684\u5c9b\u3002\n\n\u73b0\u5728\u8003\u8651 $k=2$ \u7684\u60c5\u51b5\uff1a\n\n\u9996\u5148\u6709\u4e2a\u6027\u8d28\uff0c\u8fde\u63a5\u9009\u5b9a\u7684 $2$ \u4e2a\u5c9b\u7684\u7b80\u5355\u8def\u5f84\u4e0a\u7684\u6240\u6709\u5c9b\u80af\u5b9a\u90fd\u662f\u201c\u597d\u5c9b\u201d\u3002\n\n\u8003\u8651\u5982\u4f55\u501f\u52a9\u8fd9\u4e2a\u6027\u8d28\u89e3\u9898\uff1b\u5c1d\u8bd5\u5bf9\u4e8e\u6bcf\u4e2a\u5c9b\u5904\u7406\uff0c\u5982\u679c\u4ee4\u8fd9\u4e2a\u5c9b\uff08\u8bbe\u4e3a $x$\uff09\u4e3a\u6839\u7ed3\u70b9\u4e0a\u7684\u5c9b\uff0c\u8bbe $x$ \u6709 $s$ \u4e2a\u513f\u5b50\uff0c\u90a3\u4e48\u4ece\u8fd9 $s$ \u4e2a\u513f\u5b50\u7ed3\u70b9\u6240\u7ba1\u8f96\u7684 $s$ \u68f5\u5b50\u6811\u4e2d\u9009\u62e9\u4e24\u68f5\u5b50\u6811\uff0c\u518d\u4ece\u4e24\u68f5\u5b50\u6811\u4e2d\u5404\u9009\u62e9 $1$ \u4e2a\u5c9b\uff0c\u8fd9\u4e24\u4e2a\u5c9b\u7684\u7b80\u5355\u8def\u5f84\u5fc5\u8fc7 $x$\u3002\u5f53\u7136\uff0c\u8fd8\u6709\u53ef\u80fd $x$ \u5728\u90a3\u6761\u94fe\u7684\u4e00\u7aef\uff0c\u6700\u540e\u8f93\u51fa\u7684\u65f6\u5019\u52a0\u4e0a\u5bf9\u5e94\u7684\u8d21\u732e\u5373\u53ef\u3002\n\n\u90a3\u4e48\uff0c\u95ee\u9898\u6765\u4e86\uff1a\u5982\u679c**\u4e0d\u8003\u8651 $x$ \u5728\u94fe\u7684\u4e00\u7aef\u7684\u60c5\u51b5**\uff0c\u5982\u4f55\u8ba1\u7b97\u4ee5 $x$ \u4e3a\u6839\u65f6\u7684\u9009\u62e9\u513f\u5b50\u65b9\u6848\u6570\uff1f\u663e\u7136\u7684\uff0c\u4ee4 $x$ \u7684 $s$ \u4e2a\u513f\u5b50\u6240\u7ba1\u8f96\u7684\u5b50\u6811\u5927\u5c0f\u4e3a $e_1,e_2,\\ldots,e_s$\uff0c\u7b54\u6848\u5373\u4e3a\uff1a\n\n$$\n\\begin{aligned}\n\\sum\\limits_{i=1}^{s-1}\\sum\\limits_{j=i+1}^se_ie_j=\\dfrac{\\left(\\sum\\limits_{i=1}^se_i\\right)^2-\\left(\\sum\\limits_{i=1}^se_i^2\\right)}{2}\n\\end{aligned}\n$$\n\n\u663e\u7136\u7684\uff0c$\\left(\\sum\\limits_{i=1}^se_i\\right)^2$ \u5373\u4e3a $(n-1)^2$\uff0c\u81f3\u4e8e\u5e73\u65b9\u548c\uff08\u5373\u7b2c\u4e8c\u4e2a $\\sum$\uff09\u53ef\u4ee5\u7528\u4e00\u904d dfs \u4fbf\u6377\u5730\u7b97\u51fa\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log m)$\uff0c\u8fd9\u91cc $m=10^9+7$\uff08\u6a21\u6570\uff09\uff0c$\\log m$ \u4e3a\u8ba1\u7b97\u9006\u5143\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002\n\n\u653e\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int mod=1e9+7;\nint qpow(int a,int b){\n  int r=1;\n  while(b){\n    if(b&1)r=r%mod*a%mod;\n    a=a%mod*a%mod; b>>=1;\n  }\n  return r;\n} // \u5feb\u901f\u5e42\uff0c\u6c42\u9006\u5143\u7528\nvector<int> g[200001];\nint n,e[200001],w[200001];\n// e[i] \u4e3a\u5b50\u6811\u5927\u5c0f\uff0cw[i] \u5373\u4e3a\u5e73\u65b9\u548c\nvoid dfs(int u,int r){\n  e[u]=1;\n  for(int i:g[u])\n    if(i!=r){\n      dfs(i,u),e[u]+=e[i];\n      (w[u]+=e[i]*e[i]%mod)%=mod;\n    }\n  (w[u]+=(n-e[u])*(n-e[u])%mod)%=mod;\n  // \u8ba1\u7b97\u51fa w[i]\n}\nmain(){\n  ios::sync_with_stdio(false);\n  cin.tie(0); cout.tie(0);\n  int k,c=0; cin>>n>>k;\n  if(k&1)cout<<\"1\\n\"; // \u7b54\u6848\u5fc5\u4e3a 1\n  else{\n    for(int i=1;i<n;i++){\n      int u,v; cin>>u>>v;\n      g[u].emplace_back(v);\n      g[v].emplace_back(u);\n    }\n    dfs(1,0); // \u4e00\u904d dfs\n    for(int i=1;i<=n;i++)\n      (c+=((n-1)*(n-1)%mod-w[i]+mod)%mod*qpow(2,mod-2)%mod)%=mod; // \u7b97\u6982\u7387\n    cout<<(c%mod*qpow(n*(n-1)/2%mod,mod-2)%mod+2)%mod<<endl;\n    // \u8bb0\u5f97\u52a0\u4e0a 2 \u7684\u8d21\u732e\uff08\u5373 x \u5728\u94fe\u7684\u4e00\u7aef\u7684\u65f6\u5019\u7684\u8d21\u732e\uff09\n  }\n  return 0;\n}\n```",
        "postTime": 1683633050,
        "uid": 556366,
        "name": "zyc212303",
        "ccfLevel": 5,
        "title": "CF1824B1 LuoTianyi and the Floating Islands (Easy Ver.) \u9898\u89e3"
    },
    {
        "content": "\u8fd9\u9053\u9898\u8fd8\u662f\u5f88\u6709\u610f\u601d\u7684\uff0c\u6bd4\u8d5b\u65f6 KonjacHZX \u4e00\u76f4\u5728\u8bf4\u5f88\u6c34\u8ba9\u6211\u4eec\u53bb\u60f3\uff0c\u4f46\u662f\u82f1\u8bed\u4e0d\u597d\u61d2\u5f97\u770b\u3002\n\n\u8fd9\u4e2a\u9898\u91cd\u70b9\u5728\u4e8e $k\\leq 3$\u3002\n\n\u9996\u5148\u5728 $k=1$ \u6216 $k=3$ \u65f6\uff0c\u4e0d\u96be\u53d1\u73b0\u6bcf\u4e2a\u70b9\u6536\u5230\u7684\u8d21\u732e\u90fd\u4e0d\u4e00\u6837\uff0c\u6240\u4ee5\u53ea\u6709\u4e00\u4e2a\u70b9\u662f\u6700\u4f18\u7684\u3002\n\n$k=2$ \u65f6\uff0c\u6211\u4eec\u53d1\u73b0\u6700\u4f18\u70b9\u5c31\u662f\u968f\u673a\u62bd\u7684\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u70b9\uff0c\u8fd9\u4e2a\u662f\u663e\u7136\u7684\u3002\n\n\u6211\u4eec\u90fd\u77e5\u9053\u671f\u671b\u53ef\u4ee5\u7406\u89e3\u4e3a\u6240\u6709\u60c5\u51b5\u7684\u5e73\u5747\u503c\uff0c\u4e5f\u5c31\u662f\u603b\u503c\u9664\u4e8e\u60c5\u51b5\u6570\uff0c\u60c5\u51b5\u6570\u81ea\u7136\u662f $\\dfrac 1 2 n(n-1)$\u3002\n\n\u7136\u540e\u603b\u503c\u5f53\u7136\u5c31\u662f\u6811\u4e0a\u6240\u6709\u8ddd\u79bb\u4e4b\u548c\u5566\u3002\n\n\u4e8e\u662f\u6211\u4eec\u7edf\u8ba1\u51fa\u6811\u4e0a\u6240\u6709\u8ddd\u79bb\u4e4b\u548c\uff0c\u518d\u4e00\u4e2a\u9006\u5143\u4ee3\u66ff\u9664\u6cd5\u7b97\u51fa\u7b54\u6848\u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define LL long long \nusing namespace std;\nconst LL N=2e6+5;\nconst LL mod=1e9+7;\nLL n,k,x,y,sz[N],ans;\nvector<LL>v[N];\nLL ksm(LL x,LL y)\n{\n\tLL ans=1;\n\twhile(y)\n\t{\n\t\tif(y&1)ans=ans*x%mod;\n\t\tx=x*x%mod,y>>=1; \n\t}\n\treturn ans;\n}\nvoid dfs(LL x,LL fa)\n{\n\tsz[x]=1;\n\tfor(LL i:v[x])\n\t{\n\t\tif(i==fa)continue;\n\t\tdfs(i,x),sz[x]+=sz[i];\n\t\tans=(ans+sz[i]*(n-sz[i])%mod)%mod;\n\t}\n}\nint main()\n{\n\tcin>>n>>k;\n\tif(k&1)\n\t{\n\t\tputs(\"1\");\n\t\treturn 0;\n\t}\n\tfor(int i=1;i<=n-1;i++)\n\t{\n\t\tcin>>x>>y;\n\t\tv[x].push_back(y);\n\t\tv[y].push_back(x);\n\t}\n\tdfs(1,0);\n\tcout<<(ans*ksm(n*(n-1)/2%mod,mod-2)%mod+1)%mod<<endl;\n}\n```",
        "postTime": 1683637821,
        "uid": 501947,
        "name": "DengDuck",
        "ccfLevel": 6,
        "title": "LuoTianyi and the Floating Islands (Easy Version) \u9898\u89e3"
    },
    {
        "content": "\u8d5b\u65f6\u770b\u5230\u671f\u671b\u5c31\u6ca1\u53bb\u60f3\uff08\u60b2\uff09\u3002\n\n\u9996\u5148\u7531\u4e8e $k \\le 3$\uff0c\u6211\u4eec\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n\u5f53 $k = 1$ \u65f6\uff0c\u663e\u7136 good island \u53ea\u80fd\u662f\u6709\u4eba\u7684\u90a3\u4e2a\u70b9\uff0c\u6240\u4ee5\u671f\u671b\u4e2a\u6570\u5c31\u662f $1$\u3002\n\n\u5f53 $k = 2$ \u65f6\uff0cgood island \u53ea\u80fd\u5728\u4e24\u4e2a\u6709\u4eba\u7684\u70b9\u4e4b\u95f4\u7684\u8def\u5f84\u4e0a\uff0c\u56e0\u4e3a\u5f80\u522b\u7684\u5730\u65b9\u8d70\u4f1a\u540c\u65f6\u589e\u52a0\u548c\u4e24\u4e2a\u4eba\u7684\u8ddd\u79bb\u3002\n\n\u5f53 $k = 3$ \u65f6\uff0c\u4e5f\u53ea\u6709\u4e00\u4e2a\u53ef\u80fd\u7684 good island\uff0c\u5373\u6240\u6709\u4e24\u4e2a\u4eba\u4e4b\u95f4\u7684\u8def\u5f84\u7684\u516c\u5171\u70b9\uff0c\u5f80\u522b\u7684\u5730\u65b9\u8d70\u6700\u591a\u4f7f\u4e0e\u4e00\u4e2a\u70b9\u7684\u8ddd\u79bb\u51cf\u4e00\uff0c\u81f3\u5c11\u4f7f\u4e0e\u4e24\u4e2a\u70b9\u7684\u8ddd\u79bb\u52a0\u4e00\uff0c\u6240\u4ee5\u4e00\u5b9a\u4e0d\u662f good island\u3002\n\n\u73b0\u5728\u6211\u4eec\u4e3b\u8981\u9700\u8981\u8003\u8651\u7684\u5c31\u662f $k = 2$ \u65f6\u7684\u671f\u671b\u4e2a\u6570\u3002\n\n\u7531\u4e8e\u671f\u671b\u4e2a\u6570\u7b49\u4e8e\u6240\u6709\u60c5\u51b5\u7684\u4e2a\u6570\u4e4b\u548c\u9664\u4ee5\u603b\u60c5\u51b5\u6570\uff0c\u603b\u60c5\u51b5\u6570\u5c31\u662f $\\frac{1}{2} n(n-1)$\u3002\n\n\u800c\u6240\u6709\u60c5\u51b5\u7684\u4e2a\u6570\u4e4b\u548c\u4e0d\u592a\u597d\u6c42\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u6bcf\u4e2a\u70b9\u5bf9\u7b54\u6848\u7684\u8d21\u732e\uff0c\u5f53\u70b9\u662f LCA \u65f6\u6240\u6709\u70b9\u7684\u603b\u8d21\u732e\u662f $\\frac{1}{2} n(n-1)$\uff0c\u800c\u975e LCA \u65f6\u4e00\u4e2a\u70b9\u7684\u8d21\u732e\u5c31\u662f\u5728\u5b50\u6811\u5185\u7684\u70b9\u7684\u6570\u91cf\u4e58\u4e0a\u4e0d\u5728\u5b50\u6811\u5185\u7684\u70b9\u7684\u6570\u91cf\uff08\u4e0b\u9762\u9009\u4e00\u4e2a\uff0c\u4e0a\u9762\u9009\u4e00\u4e2a\uff09\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/6f2rqfrn.png)\n\n\u4e24\u4e2a\u90fd\u6c42\u51fa\u6765\u9664\u4e00\u4e0b\u5c31\u884c\u4e86\uff0c\u7531\u4e8e\u8981\u6a21 $10^9+7$\uff0c\u5c31\u628a\u9664\u6539\u6210\u4e58\u4e0a\u9006\u5143\uff0c\u53ef\u4ee5\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u7b97\u6cd5\u6216\u8005\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n+\\log M)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nusing ll = long long;\nusing ull = unsigned long long;\nconst int maxn = 2e5+5;\nconst int mod = 1e9+7;\nint n,k,u,v;\nvector<int> G[maxn];\nint exgcd(int a,int b,int &x,int &y){\n    if(!b){\n        x=1;\n        y=0;\n        return a;\n    }\n    int d=exgcd(b,a%b,y,x);\n    y-=a/b*x;\n    return d;\n}\nint inv(int a){\n    int x,y;\n    exgcd(a,mod,x,y);\n    return (x%mod+mod)%mod;\n}\nint sz[maxn],ans,all;\nvoid dfs(int u,int fa){\n    sz[u]=1;\n    for(auto v:G[u]){\n        if(v==fa)continue;\n        dfs(v,u);\n        sz[u]+=sz[v];\n    }\n    ans=(ans+1ll*sz[u]*(n-sz[u]))%mod;\n}\nint main(){\n    ios::sync_with_stdio(false);\n    cin.tie(nullptr);\n    cout.tie(nullptr);\n    cin>>n>>k;\n    all=ans=(1ll*n*(n-1)/2)%mod;\n    for(int i=1;i<n;++i){\n        cin>>u>>v;\n        G[u].push_back(v);\n        G[v].push_back(u);\n    }\n    if(k&1){\n        cout<<1;\n        return 0;\n    }\n    dfs(1,0);\n    ans=1ll*ans*inv(all)%mod;\n    cout<<ans;\n    return 0;\n}\n```\n",
        "postTime": 1683723842,
        "uid": 460457,
        "name": "KnownError_",
        "ccfLevel": 4,
        "title": "CF1824B1 LuoTianyi and the Floating Islands (Easy Version) \u9898\u89e3"
    },
    {
        "content": "\u8fd9\u6b21\u524d\u56db\u9898\u5168\u662f\u5206\u7c7b\u8ba8\u8bba\u3002\u5bf9\u4e8e\u6211\u8fd9\u79cd\u8001\u662f\u7ec6\u8282\u5199\u9519\u7684\u5e9f\u7269\u592a\u4e0d\u53cb\u597d\u4e86\u3002\n\n\u7136\u540e\u6211\u8fd9\u91cc\u7ed9\u51fa\u4e00\u79cd\u5f88**\u8822**\u7684\u505a\u6cd5\u3002\u8c28\u614e\u89c2\u770b\u3002\n\n\u9898\u610f\u7b80\u5316\uff1a\u968f\u673a\u9009\u53d6 $k$ \u4e2a\u70b9\uff0c\u6c42 good \u70b9\u7684\u671f\u671b\u4e2a\u6570\u3002\n\n\u5148\u8003\u8651\u671f\u671b\u7684\u6c42\u6cd5\u3002\n\n\u8fd9\u91cc\u5f88\u5bb9\u6613\u5730\u9009\u62e9 $\\dfrac{s}{S}$\uff08 $s$ \u8868\u793a\u603b\u4e2a\u6570\uff0c$S$ \u8868\u793a\u603b\u65b9\u6848\u6570\uff09 \u7684\u65b9\u5f0f\u6c42\u671f\u671b\u3002\n\n$S=C_n^k$\uff0c\u7528\u6c42\u7ec4\u5408\u6570\u516c\u5f0f\u5bb9\u6613\u5f97\u5230\u3002\n\n\u4f46\u662f $s$ \u4e0d\u662f\u5f88\u597d\u8003\u8651\u3002\u9274\u4e8e $k\u22643$\uff0c\u5bb9\u6613\u60f3\u5230\u5206\u7c7b\u8ba8\u8bba\u3002\n\n- $k=1$\uff0cgood \u70b9\u53ea\u80fd\u662f\u9009\u62e9\u7684\u70b9\u672c\u8eab\u3002\n- $k=2$\uff0cgood \u70b9\u53ea\u80fd\u662f\u6811\u4e0a\u8def\u5f84 $(u,v)$ \u4e0a\u7684\u70b9\u3002\n- $k=3$\uff0c\u6839\u636e\u70b9\u4e4b\u95f4\u7684\u5206\u5e03\u5173\u7cfb\u53c8\u53ef\u4ee5\u5206\u6210 $2$ \u7c7b\u3002\n\n$3$ \u70b9\u5171\u7ebf\uff1b$3$ \u70b9\u4e0d\u5171\u7ebf\u3002\n\n- $3$ \u70b9\u5171\u7ebf\u65f6\uff0cgood \u70b9\u53ea\u80fd\u53d6\u4f4d\u4e8e\u4e2d\u95f4\u7684\u90a3\u4e00\u4e2a\u70b9\u3002\n\n- $3$ \u70b9\u4e0d\u5171\u7ebf\u65f6\uff0c\u53c8\u53ef\u4ee5\u5206\u6210 $2$ \u5c0f\u7c7b\uff1a\n\n$3$ \u70b9\u5b58\u5728 $1$ \u70b9\u662f\u53e6\u5916 $2$ \u70b9\u7684\u7956\u5148\u8282\u70b9\uff1b$3$ \u70b9\u4e0d\u5b58\u5728 $1$ \u70b9\u662f\u53e6\u5916 $2$ \u70b9\u7684\u7956\u5148\u8282\u70b9\u3002\n\n- $3$ \u70b9\u5b58\u5728 $1$ \u70b9\u662f\u53e6\u5916 $2$ \u70b9\u7684\u7956\u5148\u8282\u70b9\u3002good \u70b9\u53ea\u80fd\u53d6\u53e6\u5916 $2$ \u70b9\u7684 Lca\u3002\n\n- $3$ \u70b9\u4e0d\u5b58\u5728 $1$ \u70b9\u662f\u53e6\u5916 $2$ \u70b9\u7684\u7956\u5148\u8282\u70b9\u3002good \u70b9\u53ea\u80fd\u53d6 $3$ \u70b9\u7684 Lca\u3002\n\n\n\u6b64\u65f6\uff0c\u7ec6\u5fc3\u5730\u4eba\u4f1a\u53d1\u73b0\uff1a $k=3$ \u65f6\u5bf9\u4e8e\u4efb\u610f\u9009\u6cd5\u4e00\u5b9a\u6709\u4e14\u4ec5\u6709\u4e00\u4e2a good \u70b9\u3002\u6240\u4ee5 $s=C_n^k$\u3002\n\n\u4f46\u662f\u5982\u679c\u4e0d\u591f\u7ec6\u5fc3\u600e\u4e48\u529e\u5462\uff1f\u6ca1\u4e8b\uff0c\u8fd8\u6709\u529e\u6cd5\u3002\n\n$3$ \u70b9\u5171\u7ebf\u65f6\uff0c\u82e5\u5047\u5b9a\u4e86\u5176\u4e24\u7aef\u70b9\uff0c\u90a3\u4e48\u7b2c $3$ \u4e2a\u70b9\u7684\u53d6\u6cd5\u79cd\u6570\u5c31\u76f8\u5f53\u4e8e $(u,v)$ \u8def\u5f84\u7684\u957f\u5ea6 $-1$\u3002\u6240\u4ee5\u6b64\u65f6\u65b9\u6848\u6570 $=$ \u6811\u4e0a\u7684\u6240\u6709\u8def\u5f84\u957f\u5ea6\u4e4b\u548c $-$ \u8def\u5f84\u79cd\u6570\u3002\n\n$3$ \u70b9\u4e0d\u5171\u7ebf\u65f6\uff0c\u53ef\u4ee5\u679a\u4e3e\u9009\u53d6\u7684 Lca\uff0c\u7136\u540e $3$ \u70b9\u5c31\u76f8\u5f53\u4e8e\u5728\u4ee5\u6b64\u70b9\u4e3a\u6839\u7684 $3$ \u4e2a\u4e0d\u540c\u5b50\u6811\u4e2d\u5404\u53d6 $1$ \u70b9\u7684\u65b9\u6848\u6570\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u901a\u8fc7\u5bb9\u65a5\u5f97\u5230\u3002\n\n\u4ee5\u4e0a\u4e24\u8005\u52a0\u8d77\u6765\u5c31\u662f $s$\u3002\n\n\u73b0\u5728\u91cd\u70b9\u662f\u6c42\u6811\u4e0a\u7684\u6240\u6709\u8def\u5f84\u957f\u5ea6\u4e4b\u548c $-$ \u8def\u5f84\u79cd\u6570\u3002\n\n\u8def\u5f84\u79cd\u6570\u5bb9\u6613\u6c42\uff0c\u5c31\u662f\u9009\u62e9\u7aef\u70b9\u7684\u65b9\u6848\u6570\uff0c$C_n^2$\u3002\n\n\u6811\u4e0a\u7684\u6240\u6709\u8def\u5f84\u957f\u5ea6\u4e4b\u548c\u3002\u5982\u679c\u7a0d\u5fae\u806a\u660e\u4e00\u70b9\uff0c\u4ece\u8d21\u732e\u7684\u89d2\u5ea6\u51fa\u53d1\uff0c\u76f4\u63a5\u679a\u4e3e\u8fb9\uff0c\u7136\u540e\u8003\u8651\u8fb9\u4e24\u7aef\u7684\u8054\u901a\u5757\u5927\u5c0f\uff0c\u4e58\u8d77\u6765\u5c31\u662f\u6b64\u8fb9\u5bf9\u7b54\u6848\u7684\u8d21\u732e\uff0c\u53ef\u4ee5\u505a\u5230 $O(n)$\u3002\u4f46\u662f\u4e0d\u90a3\u4e48\u806a\u660e\u600e\u4e48\u529e\uff1f\n\n\u6ca1\u4e8b\uff0c\u6c42\u6811\u4e0a\u7684\u6240\u6709\u8def\u5f84\u957f\u5ea6\u4e4b\u548c\uff0c\u76f4\u63a5\u4f7f\u7528\u70b9\u5206\u6cbb\u5373\u53ef\u3002\n\n\u81f3\u6b64\uff0c$k=3$ \u7684\u60c5\u51b5\u6211\u4eec\u5c31\u89e3\u51b3\u4e86\u3002\n\n\u56de\u770b $k=2$\uff0c\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u662f\u6811\u4e0a\u7684\u6240\u6709\u8def\u5f84\u957f\u5ea6\u4e4b\u548c $+$ \u8def\u5f84\u79cd\u6570\uff08\u56e0\u4e3a\u8fd8\u53ef\u4ee5\u53d6\u4e24\u4e2a\u7aef\u70b9\uff09\uff0c\u800c\u8fd9\u4e2a\u5f0f\u5b50\u5728 $k=3$ \u4e2d\u6c42\u8fc7\u4e86\u3002\u5373\u5df2\u89e3\u51b3\u3002\n\n$k=1$\uff0c$s=C_n^1$\u3002\n\n\u7efc\u4e0a\u6240\u8ff0\uff0c\u95ee\u9898\u5168\u90e8\u89e3\u51b3\u3002\n\n\u4e0b\u9762\u7ed9\u51fa\u4f7f\u7528\u70b9\u5206\u6cbb\u548c\u5bb9\u65a5\u7684\u4ee3\u7801\u3002\n\nCode:\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define mp make_pair\n#define fi first\n#define se second\n#define pr printf\n#define ps puts\n#define pb push_back\n#define For(i,a,b) for(i=a;i<=b;i++)\n#define FOR(i,a,b) for(i=a;i>=b;i--)\nusing namespace std;\nconst int N=2e5+10,mod=1e9+7;\nint n,k;\nint dep[N],fa[N],sz[N];\nvector<int> p[N],sta;\nint q[N],Q[N];\nbool vis[N];\nvoid add(int u,int v){\n\tp[u].pb(v);\n}\nint qz(int x,int y){\n\tint res=1;\n\tfor(;y;y>>=1){\n\t\tif(y&1) res=(res*x)%mod;\n\t\tx=(x*x)%mod;\n\t}\n\treturn res;\n}\nint C(int x,int y){\n\tint i,res=1;\n\tFOR(i,x,x-y+1) res=(res*i)%mod;\n\tFor(i,1,y) res=(res*qz(i,mod-2))%mod;\n\treturn res;\n}\nvoid dfs(int x,int y){\n\tdep[x]=dep[y]+1,fa[x]=y,sz[x]=1;\n\tfor(auto v:p[x]) if(v!=y){\n\t\tdfs(v,x);\n\t\tsz[x]+=sz[v];\n\t}\n}\nint get_size(int x,int fa){\n\tif(vis[x]) return 0;\n\tint res=1;\n\tfor(auto v:p[x]) if(v!=fa) res+=get_size(v,x);\n\treturn res;\n}\nint get_wc(int x,int fa,int tot,int &wc){\n\tif(vis[x]) return 0;\n\tint sum=1,maxs=0,t;\n\tfor(auto v:p[x]){\n\t\tif(v==fa) continue;\n\t\tt=get_wc(v,x,tot,wc);\n\t\tmaxs=max(maxs,t);\n\t\tsum+=t;\n\t}\n\tmaxs=max(maxs,tot-sum);\n\tif(maxs<=tot/2) wc=x;\n\treturn sum;\n}\nvoid get_dist(int x,int fa,int w,int &qt){\n\tif(vis[x]) return ;\n\tq[++qt]=w;\n\tfor(auto v:p[x]) if(v!=fa) get_dist(v,x,w+1,qt);\n}\nint calc(int x){\n\tif(vis[x]) return 0;\n\tget_wc(x,0,get_size(x,0),x);\n\tvis[x]=1;\n\tint i,qt=0,Qt=0,res=0,sum;\n\tfor(auto v:p[x]){\n\t\tqt=0;\n\t\tget_dist(v,x,1,qt);\n\t\tsum=0;\n\t\tFor(i,1,qt) sum+=q[i];\n\t\tFor(i,1,qt) res=(res-((qt-1)*q[i]%mod+(sum-q[i])+(qt-1)))%mod;\n\t\tFor(i,1,qt) Q[++Qt]=q[i];\n\t}\n\tsum=0;\n\tFor(i,1,Qt) sum+=Q[i];\n\tFor(i,1,Qt) res=(res+(Qt-1)*Q[i]%mod+(sum-Q[i])+(Qt-1))%mod;\n\tres=(res*qz(2,mod-2))%mod;\n\tFor(i,1,Qt) res=(res+Q[i]+1)%mod;\n\tfor(auto v:p[x]) res=(res+calc(v))%mod;\n\treturn res;\n}\nint Calc(){\n\tint i;\n\tint res=0,sum,temp;\n\tFor(i,1,n){\n\t\tsta.clear();\n\t\tif(p[i].size()<3) continue;\n\t\tfor(auto v:p[i]){\n\t\t\tif(v==fa[i]) sta.pb(sz[1]-sz[i]);\n\t\t\telse sta.pb(sz[v]);\n\t\t}\n\t\tsum=0;\n\t\tfor(auto u:sta) sum=(sum+u)%mod;\n\t\tint len=sta.size();\n\t\ttemp=C(sum,3);\n\t\tfor(auto u:sta) temp=(temp-C(u,2)*(sum-u)%mod+mod)%mod;\n\t\tfor(auto u:sta) temp=(temp-C(u,3))%mod;\n\t\tres=(res+temp)%mod;\n\t}\n\treturn res;\n}\nvoid solve(){\n\tint res;\n\tif(k==1) res=n;\n\tif(k==2) res=calc(1);\n\tif(k==3){\n\t\tres=Calc();\n\t\tint temp=calc(1);\n\t\tres=(res+temp-2*C(n,2)%mod)%mod;\n\t}\n\tcout<<res*qz(C(n,k),mod-2)%mod;\n}\nsigned main(){\n    ios::sync_with_stdio(0);\n    cin.tie(0),cout.tie(0);\n\tint i,u,v;\n\tcin>>n>>k;\n\tFor(i,1,n-1){\n\t\tcin>>u>>v;\n\t\tadd(u,v),add(v,u);\n\t}\n\tdfs(1,0);\n\tsolve();\n\treturn 0;\n}\n\u00a0\n```\n",
        "postTime": 1683684578,
        "uid": 225100,
        "name": "ice_in_sky",
        "ccfLevel": 0,
        "title": "LuoTianyi and the Floating Islands (Easy Version)"
    },
    {
        "content": "## \u524d\u8a00\n\n\u5176\u5b9e $D1$ \u5c31\u662f\u4e2a\u7b80\u5355\u9898\uff0c\u6bd5\u7adf $k\\leq 3$\n\n## \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u9897\u6811\uff0c\u968f\u673a $k$ \u4e2a\u70b9\uff0c\u5b9a\u4e49\u4e00\u4e2a\u70b9\u662f\u597d\u70b9\u5f53\u4e14\u4ec5\u5f53\u8fd9 $k$ \u4e2a\u70b9\u5230 $u$ \u7684\u8ddd\u79bb\u4e3a\u6811\u4e2d\u6700\u5c0f\uff0c\u6c42\u597d\u70b9\u6570\u91cf\u7684\u671f\u671b\u3002\n\n## \u9898\u89e3\n\n\u5206\u7c7b\u8ba8\u8bba\u4e00\u4e0b\n\n\u8003\u8651 $k=1$ \u7684\u65f6\u5019\uff0c\u53ea\u6709\u88ab\u9009\u5230\u7684\u70b9\u662f\u597d\u70b9\uff0c\u671f\u671b\u4e3a $1$\n\n$k=3$ \u65f6\uff0c\u5f53\u4e09\u4e2a\u70b9\u5728\u4e00\u6761\u94fe\u4e0a\u65f6\uff0c\u6211\u4eec\u5bb9\u6613\u53d1\u73b0\u4e2d\u95f4\u7684\u8282\u70b9\u662f\u552f\u4e00\u7684\uff08\u5982\u679c\u4e0d\u662f\uff0c\u90a3\u4e48\u4f1a\u6709\u591a\u7684\u91cd\u590d\u6bb5\uff0c\u4f1a\u591a\u8d70\uff09\u3002\u5f53\u4e09\u4e2a\u70b9\u4e0d\u5728\u4e00\u6761\u94fe\u4e0a\u65f6\uff0c\u90a3\u4e48\u8fd9\u4e09\u4e2a\u8282\u70b9\u8fde\u63a5\u7684\u4ea4\u70b9\u662f\u6700\u4f18\u7684\uff08\u548c\u4e0a\u9762\u4e00\u6837\uff0c\u9009\u522b\u7684\u4f1a\u591a\u8d70\uff09\n\n\u90a3\u4e48\u5c31\u53ea\u6709 $k=2$ \u65f6\u9700\u8981\u8003\u8651\n\n\u5bb9\u6613\u53d1\u73b0\uff0c$k=2$ \u65f6\uff0c\u4e24\u4e2a\u70b9\u5728\u6811\u4e0a\u5f62\u6210\u4e00\u6761\u94fe\uff0c\u94fe\u4e0a\u6240\u6709\u70b9\u90fd\u5bf9\u7b54\u6848\u6709\u8d21\u732e\u3002\u56e0\u6b64\uff0c\u5bb9\u6613\u60f3\u5230\u7edf\u8ba1\u6240\u6709\u94fe\u7684\u957f\u5ea6\u3002\u4f46\u662f\u8fd9\u4e2a\u597d\u50cf\u4e0d\u592a\u597d\u641e\uff0c\u6211\u4eec\u628a\u5b83\u641e\u5230\u70b9\u4e0a\uff0c\u7edf\u8bb0\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\uff0c\u7ecf\u8fc7\u8fd9\u4e2a\u70b9\u7684\u94fe\u6709\u591a\u5c11\u6761\n\n\u4f46\u662f\u6211\u4eec\u53d1\u73b0\uff0c\u6b63\u9762\u641e\u8981\u7b97\u5b50\u6811\u5185\u7684\u8d21\u732e\u548c\u5b50\u6811+\u7956\u5148\u7684\u8d21\u732e\uff0c\u4e0d\u592a\u597d\u7b97\u3002\u8003\u8651\u6b63\u96be\u5219\u53cd\uff0c\u7edf\u8ba1\u4e0d\u5408\u6cd5\u7684\u6570\u91cf\u3002\u7b80\u800c\u8a00\u4e4b\u5c31\u662f\u7edf\u8ba1\u51fa\u5728\u540c\u4e00\u5b50\u6811\u5185\u9009\uff08\u4e0d\u4f1a\u7ecf\u8fc7 $u$\uff09\u4ee5\u53ca\u5728\u7956\u5148\u9009\u94fe\uff08\u4e5f\u4e0d\u4f1a\u7ecf\u8fc7\u70b9 $u$\uff09\u7684\u503c\u3002\u6211\u4eec\u679a\u4e3e $(u,v) \\in |E|$\uff0c\u5982\u679c $v$ \u662f\u7236\u4eb2\u8282\u70b9\uff0c\u5c31\u8bbe\u503c $w=n-siz_u$\uff0c\u975e\u6cd5\u7b54\u6848\u662f $\\binom {w} {k}$\u3002\u5982\u679c\u662f\u5b50\u8282\u70b9\uff0c\u90a3\u4e48 $w=siz_v$\uff0c\u90a3\u4e48\u975e\u6cd5\u7684\u7b54\u6848\u5c31\u662f $\\binom {w} {k}$\uff0c\u6700\u540e\u6bcf\u4e2a\u70b9\u7684\u8d21\u732e\u662f $\\binom {n} {k}- \\binom {w} {k}$\n\n\u6700\u540e\u7b80\u5355\u7edf\u8ba1\u4e00\u4e0b\u548c\uff0c\u518d\u4e58\u4ee5 $\\binom {n} {k} \\bmod 10^9+7$ \u4e0b\u7684\u9006\u5143\u5c31\u53ef\u4ee5\u4e86\n\n\u4ee3\u7801\u5b9e\u73b0\uff1a\n\n```c++\n#include<iostream>\n#include<cstdio>\n#include<algorithm>\n#include<cstdlib>\n#include<cstring>\n#include<vector>\n#include<queue>\n#include<stack>\n#include<cmath>\n#include<bitset>\n#include<map>\n#include<set>\n#define yl sb\n#define int long long\nusing namespace std;\ntypedef long long ll;\nconst int N=2e5+5;\nconst int mod=1e9+7;\nstruct Edge{\n    int v,next;\n}edge[N<<1];\nint n,k,tot=1,ans=0;\nint head[N],fac[N],siz[N],f[N];\ninline void add(int u,int v){\n    edge[++tot]=(Edge){v,head[u]},head[u]=tot;\n}  \ninline int read(){\n    int s=0,f=1;char ch=getchar();\n    while(!isdigit(ch)) {if(ch=='-') {f=-1;} ch=getchar();}\n    while(isdigit(ch)) {s=(s<<1)+(s<<3)+ch-'0'; ch=getchar();}\n    return s*f;\n}\ninline void write(int x){\n    int top=0,sta[35];\n    while(x) {sta[top++]=x%10,x/=10;}\n    while(top) {putchar(sta[--top]+'0');}\n}\ninline int ksm(int a,int b)\n{\n    int res=1;\n    while (b)\n    {\n        if (b&1)\n            res=res*a%mod;\n        a=a*a%mod;\n        b>>=1;\n    }\n    return res;\n}\ninline int C(int n,int m)\n{\n    if (n<m) return 0;\n    if (n==0 || m==0) return 1;\n    return fac[n]%mod*ksm(fac[m],mod-2)%mod*ksm(fac[n-m],mod-2)%mod;\n}\ninline void dfs(int u,int fa)\n{\n    siz[u]=1;f[u]=fa;\n    for (int i=head[u];i;i=edge[i].next)\n    {\n        int v=edge[i].v;\n        if (v==fa) continue;\n        dfs(v,u);siz[u]+=siz[v];\n    }\n}\nsigned main()\n{\n    n=read(),k=read();fac[0]=1;\n    if (k&1) {puts(\"1\");return 0;}\n    for (int i=1;i<=n;i++) fac[i]=fac[i-1]*i%mod;\n    for (int i=1;i<=n-1;i++)\n    {\n        int u=read(),v=read();\n        add(u,v);add(v,u);\n    }\n    dfs(1,1);\n    for (int i=1;i<=n;i++)\n    {\n        int res=0;\n        for (int j=head[i];j;j=edge[j].next)\n        {\n            int v=edge[j].v,w;\n            if (v==f[i]) w=n-siz[i];\n            else w=siz[v];\n            res=(res+C(w,k)%mod)%mod;\n        }\n        ans=(ans+(C(n,k)%mod-res%mod+mod)%mod)%mod;\n    }\n    printf(\"%lld\\n\",ans%mod*ksm(C(n,k),mod-2)%mod);\n    return 0;\n}\n```\n\n",
        "postTime": 1683644920,
        "uid": 227723,
        "name": "syysongyuyang",
        "ccfLevel": 0,
        "title": "Codeforces Round 872 CF1824B1\u9898\u89e3"
    },
    {
        "content": "\u5bf9\u4e8e $k$ \u4e3a\u5947\u6570\u7684\u60c5\u51b5\uff0c\u9996\u5148\u597d\u70b9\u5fc5\u5b9a\u5b58\u5728\uff0c\u6bcf\u6b21\u4ece\u597d\u70b9\u79fb\u52a8\u4e00\u683c\uff0c\u90fd\u4f1a\u81f3\u5c11\u8ba9\u8def\u5f84\u957f\u5ea6\u589e\u52a0 $\\left\\lfloor\\dfrac k2\\right\\rfloor+1-\\left\\lfloor\\dfrac k2\\right\\rfloor=1$\uff0c\u56e0\u6b64\u597d\u70b9\u53ea\u6709\u4e00\u4e2a\u3002\u76f4\u63a5\u8f93\u51fa $1$\u3002\r\n\r\n\u5bf9\u4e8e $k=2$ \u7684\u60c5\u51b5\uff0c\u5bb9\u6613\u53d1\u73b0\u5728\u8fd9\u4e24\u70b9\u95f4\u7684\u5168\u662f\u597d\u70b9\uff0c\u6240\u4ee5\u76f4\u63a5\u5c06\u6811\u4e0a\u6240\u6709\u8def\u5f84\u957f\u5ea6\u548c\u7b97\u51fa\u6765\uff0c\u9664\u4ee5\u603b\u65b9\u6848\u6570\u5c31\u80fd\u7b97\u51fa\u671f\u671b\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$\u3002\r\n\r\n\u5982\u4f55\u8ba1\u7b97\u8def\u5f84\u957f\u5ea6\u4e4b\u548c\uff1f\u8003\u8651\u8ba1\u7b97\u6bcf\u6761\u8fb9\u7684\u8d21\u732e\uff0c\u5c31\u662f\u4e24\u7aef\u7684\u5b50\u6811\u4e2d\u5404\u9009\u4e00\u4e2a\u70b9\uff0c\u76f4\u63a5\u8ba1\u7b97\u5373\u53ef\u3002\u6ce8\u610f\u8fd9\u91cc\u7684\u8def\u5f84\u957f\u5ea6\u8fd8\u8981\u52a0\u4e0a $1$\uff0c\u4e0d\u8fc7\u53ef\u4ee5\u5728\u671f\u671b\u4e2d\u518d\u52a0\u4e0a\u3002\r\n\r\n# AC \u4ee3\u7801\r\n\r\n```cpp\r\n#include <bits/stdc++.h>\r\n\r\nusing namespace std;\r\n\r\ntypedef long long ll;\r\n\r\nconst int MAXN = 2e5 + 10;\r\nconst int mod = 1e9 + 7;\r\n\r\ninline \r\nll qpow(ll b, ll p) {\r\n\tll res = 1;\r\n\tfor (; p; b = b * b % mod, p >>= 1) if (p & 1) res = res * b % mod;\r\n\treturn res;\r\n}\r\n\r\nstruct node {\r\n\tint v, nxt;\r\n} e[MAXN << 1];\r\n\r\nint head[MAXN], tot;\r\n\r\ninline \r\nvoid add(int u, int v) {\r\n\te[++tot] = { v, head[u] }, head[u] = tot;\r\n}\r\n\r\nint n, k, s[MAXN]; ll ans;\r\n\r\nvoid dfs(int u, int f) {\r\n\ts[u] = 1;\r\n\tfor (int i = head[u], v; i; i = e[i].nxt) {\r\n\t\tv = e[i].v;\r\n\t\tif (v == f) continue; dfs(v, u), s[u] += s[v];\r\n\t\tans = (ans + (ll)s[v] * (n - s[v]) % mod) % mod;\r\n\t}\r\n}\r\n\r\nint main() {\r\n\tscanf(\"%d%d\", &n, &k);\r\n\tif (k & 1) return puts(\"1\"), 0;\r\n\tfor (int i = 1, u, v; i < n; i++) scanf(\"%d%d\", &u, &v), add(u, v), add(v, u);\r\n\tdfs(1, 0), printf(\"%lld\", (ans * qpow((ll)n * (n - 1) / 2 % mod, mod - 2) % mod + 1) % mod);\r\n}\r\n```",
        "postTime": 1683629473,
        "uid": 406941,
        "name": "Register_int",
        "ccfLevel": 6,
        "title": "CF1824B1 \u9898\u89e3"
    },
    {
        "content": " **\u8fd9\u662f\u4e00\u7bc7\u53ea\u9488\u5bf9 B1 \u7684\u9898\u89e3\uff0c\u82e5\u60f3\u4e86\u89e3 B2 \u505a\u6cd5\u8bf7\u89c1 [link](https://www.luogu.com.cn/blog/Kato-Megumi/cf1824b2-post)\u3002**\n\n\u9996\u5148\u53d1\u73b0 $k=1$ \u65f6\uff0c\u7b54\u6848\u4e00\u5b9a\u4e3a $1$\u3002\u90a3 $k=3$ \u65f6\u5462\uff1f\u8fd9\u65f6\u60f3\u5230 [P4281](https://www.luogu.com.cn/problem/P4281)\u3002~~\u53d1\u73b0\u8fd9\u9898\u6ca1\u6709 spj\uff0c\u6545\u7b54\u6848\u4e5f\u4e3a $1$\u3002~~\u5b9e\u9645\u4e0a\uff0c\u5bb9\u6613\u53d1\u73b0\u53ea\u6709\u4e00\u4e2a\u70b9\u6ee1\u8db3\u6761\u4ef6\u3002\u5177\u4f53\u8bc1\u660e\u89c1 [link](https://www.luogu.com.cn/blog/Kato-Megumi/cf1824b2-post)\u3002\n\n\u5f53 $k=2$ \u65f6\uff0c\u82e5\u4e24\u4e2a\u70b9\u5206\u522b\u4e3a $x$ \u548c $y$\uff0c\u5bb9\u6613\u53d1\u73b0\u4ee5\u8fd9\u4e24\u70b9\u4e3a\u9876\u70b9\u7684\u94fe\u4e0a\u7684\u6240\u6709\u70b9\u5747\u6ee1\u8db3\u6761\u4ef6\u3002\u56e0\u4e3a\u662f\u6c42\u671f\u671b\uff0c\u6240\u4ee5\u7b54\u6848\u5373\u4e3a $\\dfrac{\\sum\\limits_i\\sum\\limits _{j\\not=i} (dist(i,j)+1)}{n\\times (n-1)}$\uff08\u6240\u6709\u60c5\u51b5\u7b54\u6848\u548c\u9664\u4ee5\u60c5\u51b5\u6570\u91cf\uff09\u3002\u4e5f\u53ef\u4ee5\u5199\u6210 $\\dfrac{\\sum\\limits_i\\sum\\limits _{j\\not=i} dist(i,j)+n\\times(n-1)}{n\\times (n-1)}$\u3002\n\n\u8fd9\u4e2a\u7b54\u6848\u5982\u4f55\u8ba1\u7b97\u5462\uff1f\u53ef\u4ee5\u5bf9\u6bcf\u4e00\u6761\u8fb9\u8ba1\u7b97\u5b83\u5bf9\u591a\u5c11\u5bf9\u70b9\u4ea7\u751f\u4e86\u8d21\u732e\uff0c\u5373\u4e3a $siz_v\\times(n-siz_v)$\u3002\u5176\u4e2d $siz_i$ \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u5927\u5c0f\uff0c$v$ \u4e3a\u8fd9\u6761\u8fb9\u8fde\u63a5\u7684\u6df1\u5ea6\u66f4\u5927\u7684\u70b9\u3002\n\ncode\uff1a\n\n```cpp\nint n,m;\nll sum=0;\nint tot,head[N];\nstruct node{\n\tint to,nxt;\n}e[N<<1];\ninline void add(int u,int v){\n\te[++tot]={v,head[u]};\n\thead[u]=tot;\n}\ninline int qpow(int x,int y){\n\tint ret=1;\n\twhile(y){\n\t\tif(y&1)\n\t\t\tret=1ll*ret*x%mod;\n\t\tx=1ll*x*x%mod;\n\t\ty>>=1;\n\t}\n\treturn ret;\n}\nint siz[N];\nvoid dfs(int u,int f){\n\tsiz[u]=1;\n\tfor(int i=head[u];i;i=e[i].nxt){\n\t\tint v=e[i].to;\n\t\tif(v==f)\n\t\t\tcontinue;\n\t\tdfs(v,u);\n\t\tsiz[u]+=siz[v];\n\t\tsum+=1ll*siz[v]*(n-siz[v]);\n\t}\n}\nvoid solve(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1,u,v;i<n;i++){\n\t\tscanf(\"%d%d\",&u,&v);\n\t\tadd(u,v);\n\t\tadd(v,u);\n\t}\n\tif(m==1||m==3){\n\t\tputs(\"1\");\n\t\treturn;\n\t}\n\tdfs(1,0);\n\tint k=1ll*n*(n-1)/2%mod;\n\tprintf(\"%lld\\n\",1ll*(sum+k)%mod*qpow(k,mod-2)%mod);\n}\nsigned main(){\n\tint t=1;\n\t//\tscanf(\"%d\",&t);\n\twhile(t--)\n\t\tYorushika::solve();\n}\n```",
        "postTime": 1683624153,
        "uid": 740322,
        "name": "_Ritsu_",
        "ccfLevel": 0,
        "title": "CF1824B1"
    },
    {
        "content": "## \u9898\u610f\n- \u6709\u4e00\u4e2a\u6709 $n$ \u4e2a\u7ed3\u70b9\u7684\u65e0\u6839\u6811\uff0c\u5176\u4e2d\u6709\u7b49\u6982\u7387\u968f\u673a $k$ \u4e2a\u4e0d\u540c\u7ed3\u70b9\u4e3a\u9ed1\u8272\u3002\n- \u6c42\u51fa**\u4e0e\u6240\u6709\u9ed1\u70b9\u8ddd\u79bb\u4e4b\u548c\u6700\u5c0f\u7684\u70b9**\u7684\u671f\u671b\u6570\u91cf\uff08\u4e3a\u65b9\u4fbf\u53d9\u8ff0\u79f0\u4e4b\u4e3a\u6700\u4f18\u70b9\uff09\u3002\n- $1\\le n \\le 2\\cdot 10^5,1\\le k \\le 3$\uff0c\u7b54\u6848\u5bf9 $10^9+7$ \u53d6\u6a21\u3002\n\n## \u9898\u89e3\n\n\u9996\u5148\u5bb9\u6613\u53d1\u73b0 $k$ \u5f88\u5c0f\uff0c\u8003\u8651\u5206\u4e09\u79cd\u60c5\u51b5\u5904\u7406\u3002\n\n\u6b64\u5916\uff0c\u867d\u7136\u9898\u76ee\u80cc\u666f\u4e2d\u6240\u6709\u6709\u4eba\u7684\u70b9\u5e76\u4e0d\u7b49\u4ef7\uff0c\u4f46\u662f\u5bb9\u6613\u53d1\u73b0\u5176\u5b9e\u54ea\u4e2a\u4eba\u5728\u54ea\u4e2a\u70b9\u5e76\u4e0d\u5f71\u54cd\u671f\u671b\uff0c\u5f53\u6210\u7b49\u4ef7\u7684\u5373\u53ef\u3002\n\n- $k=1$\n\n\u5f88\u663e\u7136\uff0c\u6240\u6709\u60c5\u51b5\u7684\u6700\u4f18\u70b9\u90fd\u53ea\u6709\u4e00\u4e2a\uff0c\u6240\u4ee5\u671f\u671b\u4e3a $1$\u3002\n\n- $k=3$\n\n\u6b64\u65f6\u6240\u6709\u60c5\u51b5\u6700\u4f18\u70b9\u7684\u4e2a\u6570\u4e5f\u662f $1$\u3002\u53ef\u4ee5\u7b80\u5355\u5206\u60c5\u51b5\u8ba8\u8bba\u4e00\u4e0b\u3002\n\n- \u5047\u5982\u4e09\u4e2a\u9ed1\u70b9\u5728\u4e00\u6761\u94fe\u4e0a\uff0c\u80af\u5b9a\u53ea\u6709\u4e2d\u95f4\u90a3\u4e2a\u662f\u6700\u4f18\u70b9\u3002\n- \u5047\u5982\u4e0d\u5728\u4e00\u6761\u94fe\u4e0a\uff0c\u6211\u4eec\u53d1\u73b0\u53ea\u6709\u4e09\u6761\u94fe\u7684\u4ea4\u6c47\u70b9\u662f\u6700\u4f18\u70b9\uff08\u5982\u56fe\uff09\u3002\n\n![\u56fe\u793a](https://cdn.luogu.com.cn/upload/image_hosting/vitjadt4.png)\n\n\u6bd4\u5982\u8fd9\u5f20\u56fe\u4e2d\uff0c\u5f88\u663e\u7136\u53ea\u6709\u70b9 $2$ \u662f\u6700\u4f18\u70b9\uff0c\u56e0\u4e3a\u9009\u5176\u5b83\u4efb\u610f\u70b9\u90fd\u4f1a\u5bfc\u81f4\u8d70\u4e86\u4e0d\u8be5\u8d70\u7684\u8fb9\u6216\u8005\u4e00\u6761\u8fb9\u88ab\u7b97\u4e24\u6b21\u3002\n\n\u6240\u4ee5 $k=3$ \u65f6\u671f\u671b\u4e5f\u662f $1$\u3002\n\n- $k=2$\n\n\u53c2\u8003 $k=3$ \u7684\u601d\u8def\uff0c\u5bb9\u6613\u53d1\u73b0 $k=2$ \u65f6\u4e24\u9ed1\u70b9\u4e4b\u95f4\u94fe\u4e0a\u6bcf\u4e2a\u70b9\u90fd\u662f\u6700\u4f18\u70b9\uff08\u5305\u62ec\u4e24\u9ed1\u70b9\uff09\u3002\n\n\u6240\u4ee5\u8f6c\u5316\u4e3a\u6c42\u6811\u4e0a\u968f\u673a\u94fe\u7684\u671f\u671b\u957f\u5ea6\u3002\u53e6\u5916\u53d1\u73b0\u6811\u4e0a\u94fe\u7684\u603b\u6570\u975e\u5e38\u597d\u6c42\uff08\u5c31\u662f $\\frac{n\\cdot(n-1)}{2}$\uff09\uff0c\u60f3\u5230\u6c42\u51fa\u6240\u6709\u94fe\u957f\u5ea6\u4e4b\u548c\u9664\u4ee5\u94fe\u7684\u6570\u91cf\u3002\u8003\u8651\u6811\u5f62 DP\u3002\n\n\u8bbe $dp_i$ \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u7ed3\u70b9\u7684\u5b50\u6811\u4e2d\u6240\u6709\u4ee5\u6839\u4e3a\u7aef\u70b9\u7684\u94fe\u7684\u957f\u5ea6\u4e4b\u548c\uff0c\u9700\u8981\u6ce8\u610f\u5728\u539f\u95ee\u9898\u4e2d\u94fe\u7684\u7aef\u70b9\u4e5f\u662f\u6700\u4f18\u70b9\uff0c\u6545\u8fd9\u91cc\u7684\u957f\u5ea6\u6307\u94fe\u4e0a\u70b9\u7684\u4e2a\u6570\uff08\u5305\u62ec\u7aef\u70b9\uff09\uff0c\u540c\u7406\uff0c\u5728\u6b64\u5904\u5355\u4e2a\u70b9\u4e5f\u7b97\u4f5c\u94fe\u3002\u53c8\u8bbe $f_i$ \u8868\u793a\u5b50\u6811\u5185\u70b9\u7684\u4e2a\u6570\uff0c\u6613\u5f97\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$f_i=1+\\sum\\limits_{j \\in childen(i)}f_j$$\n\n$$dp_i=1+\\sum\\limits_{j \\in childen(i)}dp_j+f_j$$\n\n$f_i$ \u7684\u65b9\u7a0b\u5f88\u597d\u7406\u89e3\uff0c\u5173\u4e8e $dp_i$ \u7684\u65b9\u7a0b\uff0c\u9996\u5148\u6bcf\u4e2a\u7ed3\u70b9\u81ea\u5df1\u4f1a\u7b97\u4e00\u6b21\uff0c\u7136\u540e\u4ee5\u6240\u6709\u5b50\u8282\u70b9\u4e3a\u7aef\u70b9\u7684\u94fe\u90fd\u4f1a\u52a0\u4e0a\u70b9 $i$ \u800c\u4ea7\u751f \u539f\u957f\u5ea6 $+1$ \u7684\u8d21\u732e\uff0c\u5176\u4e2d\uff0c\u6bcf\u4e2a\u5b50\u6811\u5185\u4ee5\u6839\u4e3a\u7aef\u70b9\u7684\u94fe\u7684\u6570\u91cf\u663e\u7136\u7b49\u4e8e $f_i$\uff0c\u6545\u5f97\u6b64\u5f0f\u3002\n\n\u6c42\u51fa $dp$ \u548c $f$ \u5c31\u5f88\u597d\u7edf\u8ba1\u603b\u957f\u5ea6\u4e86\uff0c\u5047\u5982\u6211\u4eec\u8981\u628a\u4ee5 $u,v$ \u4e3a\u6839\u4e24\u68f5\u5b50\u6811\u5408\u5e76\u5230\u4e00\u8d77\uff0c\u5bb9\u6613\u53d1\u73b0\u4e24\u68f5\u5b50\u6811\u4e2d\u4efb\u9009\u4e24\u6761\u4ee5\u6839\u4e3a\u7aef\u70b9\u7684\u94fe\u8fde\u63a5\u8d77\u6765\u90fd\u4f1a\u4ea7\u751f\u4e00\u6761\u65b0\u7684\u94fe\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u4f1a\u5bf9\u6700\u7ec8\u7b54\u6848\u4ea7\u751f $f_u\\times dp_v+f_v\\times dp_u$ \u7684\u8d21\u732e\uff08\u5c31\u662f\u6bcf\u4e00\u5957\u94fe\u90fd\u4f1a\u4f7f\u53e6\u4e00\u8fb9\u4ea7\u751f\u7b49\u540c\u4e8e $dp$ \u7684\u503c\u7684\u8d21\u732e\uff09\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u5728\u6c42 $dp,f$ \u7684\u65f6\u5019\u4e00\u8d77\u7edf\u8ba1\uff0c\u5177\u4f53\u6765\u8bb2\u5c31\u662f\u6700\u5f00\u59cb\u628a\u6bcf\u4e2a\u70b9\u5f53\u6210\u53ea\u6709\u4e00\u4e2a\u70b9\u7684\u6811\uff0c\u6bcf\u6b21\u548c\u6240\u6709\u5b50\u6811\u5408\u5e76\u3002\u53e6\u5916\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u6ca1\u6709\u7edf\u8ba1\u5355\u4e2a\u70b9\u7684\u201c\u94fe\u201d\uff0c\u56e0\u4e3a\u9898\u76ee\u8981\u6c42\u6240\u6709\u9ed1\u70b9\u4e24\u4e24\u4e0d\u540c\u3002\n\n\u590d\u6742\u5ea6 $O(n)$\uff08\u5982\u679c $k=2$\uff0c\u5f53\u7136 $k=1,3$ \u7684\u65f6\u5019\u662f $O(1)$ \u7684\uff0c\u4f46\u6211\u89c9\u5f97\u6ca1\u5fc5\u8981\u5206\u90a3\u4e48\u7ec6\uff09\u3002\n\n## code\n```cpp\n#include<bits/stdc++.h>\n#define mem(a,b) memset(a,b,sizeof(a))\n#define forup(i,s,e) for(register int i=(s);i<=(e);i++)\n#define fordown(i,s,e) for(register int i=(s);i>=(e);i--)\nusing namespace std;\n#define gc getchar()\ninline int read(){//\u5feb\u8bfb\n    int x=0,f=1;char c;\n    while(!isdigit(c=gc)) if(c=='-') f=-1;\n    while(isdigit(c)){x=(x<<3)+(x<<1)+(c^48);c=gc;}\n    return x*f;\n}\n#undef gc\nconst int N=2e5+5,inf=0x3f3f3f3f,mod=1e9+7;\nint n,k,dp[N],pd[N],ans;//\u8fd9\u91cc\u7684 pd \u5c31\u662f\u4e0a\u9762\u8bb2\u7684 f\nvector<int> e[N];//\u90bb\u63a5\u8868\u5b58\u56fe\nvoid dfs(int x,int fa){\n\tpd[x]=1;dp[x]=1;\n\tfor(auto i:e[x]){\n\t\tif(i==fa) continue;\n\t\tdfs(i,x);//dfs \u7684\u65f6\u5019\u76f4\u63a5\u7edf\u8ba1\u7b54\u6848\n\t\tans=(ans+1ll*pd[i]*dp[x]%mod+1ll*pd[x]*dp[i]%mod)%mod;\n\t\t(pd[x]+=pd[i])%=mod;\n\t\tdp[x]=((dp[x]+dp[i])%mod+pd[i])%mod;\n\t}\n}\nint ksm(int a,int b){//\u5feb\u901f\u5e42\uff0c\u7528\u6765\u6c42\u9006\u5143\n\tint c=1;\n\twhile(b){\n\t\tif(b&1) c=1ll*c*a%mod;\n\t\ta=1ll*a*a%mod;\n\t\tb>>=1;\n\t}\n\treturn c;\n}\nsigned main(){\n\tn=read();k=read();\n\tforup(i,1,n-1){\n\t\tint u=read(),v=read();\n\t\te[u].push_back(v);e[v].push_back(u);\n\t}\n\tif(k==1||k==3){//\u7279\u5224\n\t\tputs(\"1\");\n\t\treturn 0;\n\t}\n\tdfs(1,0);\n\tprintf(\"%lld\",1ll*ans*ksm(1ll*n*(n-1)/2%mod,mod-2)%mod);\n}\n```",
        "postTime": 1683554855,
        "uid": 537230,
        "name": "\u516d\u697c\u6e9c\u5218",
        "ccfLevel": 5,
        "title": "CF1824B1 LuoTianyi and the Floating Islands (Easy Version) \u9898\u89e3"
    }
]
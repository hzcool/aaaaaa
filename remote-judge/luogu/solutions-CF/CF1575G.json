[
    {
        "content": "/kk \u8001\u5e74\u4eba\u505a\u4e2a 2200 \u90fd\u89c9\u5f97\u5f88\u5f00\u5fc3\u4e86\u5c5e\u4e8e\u662f\n\n\n$\\sum \\sum \\gcd(i, j) \\times \\gcd (a_i, a_j)$\n\n\n$\\gcd(i,j) = \\sum_{d|\\gcd(i,j)}\\varphi(d)$\n\n\n$\\sum_{d} \\varphi(d) \\sum_{i|d} \\sum_{j|d} \\gcd(a_i,a_j)$\n\n\u7136\u540e\u5173\u952e\u5728 $\\sum_{i|d} \\sum_{j|d} \\gcd(a_i,a_j)$ \u4e0a\u3002\n\n\u4ee4 $b = [a_{kd}], k \\in Z$\u3002\n\n\u8fd9\u6837\u7684\u8bdd\uff0c\u8981\u505a\u7684\u5c31\u662f $\\gcd(b_i, b_j)$\u3002\n\n$k = \\sum_{d|k} \\varphi(d)$\u3002\n\n\u7136\u540e\u6211\u4eec\u53ea\u9700\u8981\u505a\u4e00\u4e2a\u9ad8\u7ef4\u524d\u7f00\u548c\uff08\u6216\u8005\u666e\u901a\u7684 $n \\ln n$ \u641e\u4e00\u4e0b\uff09\u3002\n\n\u5c31\u53ef\u4ee5\u7b97\u51fa\u6765 $c_i = \\sum_{i|j} cnt_{j}$\u3002\n\n\u6240\u6c42\u7684 $\\gcd = ik$ \u7684\u4e2a\u6570\u7684\u5bf9\u6570\u521a\u597d\u662f $c_i^2 $\uff0c\u7136\u540e\u4e58\u4e0a\u7cfb\u6570 $\\varphi(d)$ \u5c31\u53ef\u4ee5\u4e86\u3002\n\n\n```cpp\n\n#include <bits/stdc++.h>\nusing namespace std;\nconst int B = 400;\nconst int P = 1e9 + 7;\nint main() {\n ios::sync_with_stdio(false);\n cin.tie(nullptr);\n int n;\n cin >> n;\n vector<int> a(n + 1, 0);\n for (int i = 1; i <= n; i++) {\n  cin >> a[i];\n }\n vector<int> phi(100000 + 1, 0);\n iota(phi.begin(), phi.end(), 0);\n for (int i = 2; i <= 100000; i++) {\n  if (phi[i] == i) {\n   for (int j = i; j <= 100000; j += i) {\n    phi[j] = phi[j] / i * (i - 1);\n   }\n  }\n }\n vector<int> primes;\n for (int i = 2; i <= 100000; i++) {\n  if (phi[i] == i - 1) {\n   primes.push_back(i);\n  }\n }\n vector<int> cnt(100000 + 1, 0);\n int ans = 0;\n for (int d = 1; d <= n; d++) {\n  int cur = 0;\n  if (d < B) {\n   for (int i = 1; i <= 100000; i++) {\n    cnt[i] = 0;\n   }\n   for (int i = d; i <= n; i += d) {\n    cnt[a[i]]++;\n   }\n   for (auto p : primes) {\n    for (int j = 100000 / p; j >= 1; j--) {\n     cnt[j] += cnt[j * p];\n     if (cnt[j] >= P) {\n      cnt[j] -= P;\n     }\n    }\n   }\n   for (int i = 1; i <= 100000; i++) {\n    cur += (long long) cnt[i] * cnt[i] % P * phi[i] % P;\n    if (cur >= P) {\n     cur -= P;\n    }\n   }\n  } else {\n   for (int i = d; i <= n; i += d) {\n    for (int j = d; j <= n; j += d) {\n     cur += __gcd(a[i], a[j]);\n     if (cur >= P) {\n      cur -= P;\n     }\n    }\n   }\n  }\n  ans += (long long) cur * phi[d] % P;\n  if (ans >= P) {\n   ans -= P;\n  }\n }\n cout << ans << \"\\n\";\n return 0;\n}\n\n```",
        "postTime": 1636256867,
        "uid": 96580,
        "name": "SXNhdW5veWE",
        "ccfLevel": 7,
        "title": "CF1575G GCD Festival"
    },
    {
        "content": "\u8fd0\u7528\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\u7684\u4e00\u4e9b\u6280\u5de7\uff08\u6216\u8005\u8bf4\u6b27\u62c9\u51fd\u6570\u7684\u77e5\u8bc6\uff09\uff0c\u6211\u4eec\u77e5\u9053\n\n$$\nx=\\sum_{d|x}\\varphi(d)\n$$\n\n\u6545\u539f\u5f0f\n\n$=\\sum_{i=1}^n\\sum_{j=1}^n\\gcd(a_i,a_j)\\sum_{d|\\gcd (i,j)}\\varphi(d)$\n\n$=\\sum_d \\varphi(d) \\sum_{d|i}\\sum_{d|j}\\gcd(a_i,a_j)$\n\n\u4e0b\u9762\u7684\u590d\u6742\u5ea6\u5206\u6790\u4e2d\u6211\u4eec\u8bb0 $M=\\max \\{a_1,...,a_n\\}$\u3002\n\n\u8bb0 $F(d)=\\sum_{d|i}\\sum_{d|j}\\gcd(a_i,a_j)$\u3002\u9996\u5148\u6211\u4eec\u77e5\u9053\uff0c\u6ee1\u8db3 $d|i$ \u7684 $i$ \u4e0d\u8d85\u8fc7 $\\dfrac{n}{d}$\uff0c\u5982\u679c\u6211\u4eec\u66b4\u529b\u679a\u4e3e $i,j$ \u6765\u8ba1\u7b97 $\\gcd(a_i,a_j)$\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(\\dfrac{n^2}{d^2}\\log M)$\u3002\u8fd9\u4e2a\u590d\u6742\u5ea6\u5728 $d$ \u6bd4\u8f83\u5927\u662f\u4f18\u79c0\u7684\uff0c\u4f46 $d$ \u5c0f\u65f6\u5f88\u52a3\uff0c\u6211\u4eec\u9700\u8981\u53e6\u5916\u7684\u505a\u6cd5\u3002\n\n\u518d\u5957\u7528\u5f00\u5934\u7684\u516c\u5f0f\uff0c\u6211\u4eec\u77e5\u9053 $F(d)=\\sum_x \\varphi(x)\\sum_{d|i,x|a_i}\\sum_{d|i,x|a_j}1$\u3002\u5982\u679c\u6211\u4eec\u80fd\u7b97\u51fa\u5bf9\u6bcf\u4e2a $x$\uff0c\u6ee1\u8db3 $d|i,x|a_i$ \u7684 $i$ \u7684\u4e2a\u6570 $c_{d,x}$\uff0c\u90a3\u4e48 $F(d)=\\sum_{i=1}^M\\varphi(i)c_{d,i}^2$\u3002\u800c\u8ba1\u7b97 $c$ \u53ef\u4ee5\u5728\u7b5b\u51fa\u6240\u6709\u7d20\u6570\u540e\uff0c\u505a\u9ad8\u7ef4\u524d\u7f00\u548c\uff08\u53ef\u4ee5\u53c2\u89c1\u6d1b\u8c37\u4e0a\u72c4\u5229\u514b\u96f7\u524d\u7f00\u548c\u6a21\u677f\u9898\uff09\uff0c\u505a\u5230 $O(M\\log \\log M)$ \u7684\u590d\u6742\u5ea6\u3002\n\n\u6211\u4eec\u53d6\u4e00\u4e2a\u9608\u503c $T$\uff0c\u5bf9 $T > d$ \u7528\u524d\u4e00\u4e2a\u7b97\u6cd5\uff0c$T \\leq d$ \u7528\u540e\u4e00\u4e2a\u7b97\u6cd5\u3002\u90a3\u4e48\u540e\u4e00\u90e8\u5206\u590d\u6742\u5ea6 $O(TM\\log \\log M)$\uff0c\u800c\u524d\u4e00\u90e8\u5206\u8ba1\u7b97 $\\gcd$ \u6b21\u6570 $\\leq n^2\\sum_{i=T+1}^n\\dfrac{1}{i^2}\\leq n^2\\int_{T}^n\\dfrac{1}{x^2}\\mathrm{d}x=n^2(\\dfrac{1}{T}-\\dfrac{1}{n})<\\dfrac{n^2}{T}$\uff0c\u603b\u590d\u6742\u5ea6 $O(\\dfrac{n^2}{T}\\log M)$\u3002\u5047\u5b9a $n,M$ \u540c\u9636\uff0c\u53ef\u4ee5\u505a\u5230 $O(n^{1.5}(\\log n\\log \\log n)^{0.5})$ \u7684\u590d\u6742\u5ea6\uff08\u867d\u7136\u8fd9\u4e2a\u5206\u6790\u66f4\u591a\u662f\u7406\u8bba\u610f\u4e49\u4e0a\u7684\uff0c\u5b9e\u9645\u4e0a\u548c $O(n^{1.5}\\log n)$ \u505a\u6cd5\u5e94\u8be5\u65e0\u592a\u5927\u533a\u522b\uff09\u3002\n\n```cpp\n#include<cstdio>\n#include<cstring>\n \nusing namespace std;\nconst long long MOD=1e9+7;\nint add(int x,int y){return x+y>=MOD?x+y-MOD:x+y;}\nint sub(int x,int y){return x>=y?x-y:x+MOD-y;}\n \nint gcd(int x,int y){return y?gcd(y,x%y):x;}\n \nlong long fast_pow(long long b,long long p)\n{\n\tlong long ans=1;while(p){if(p&1)ans=ans*b%MOD;b=b*b%MOD;p>>=1;}\n\treturn ans;\n}\nlong long INV(long long x){return fast_pow(x,MOD-2);}\n \n \nconst int B=400;\n \nbool prm[200000];int prm_lst[200000],pcnt;long long phi[200000];\n \nvoid init_mu(int n)\n{\n\tfor(int i=2;i<=n;i++)prm[i]=1;phi[1]=1;\n\tfor(int i=2;i<=n;i++)\n\t{\n\t\tif(prm[i])prm_lst[++pcnt]=i,phi[i]=i-1;\n\t\tfor(int j=1;j<=pcnt&&prm_lst[j]*i<=n;j++)\n\t\t{\n\t\t\tprm[prm_lst[j]*i]=0;\n\t\t\tif(i%prm_lst[j]==0){phi[i*prm_lst[j]]=phi[i]*prm_lst[j];break;;}\n\t\t\tphi[i*prm_lst[j]]=phi[i]*(prm_lst[j]-1);\n\t\t}\n\t}\n}\n \nint a[200000];\nlong long cnt[200000];\n \nint main()\n{\n\tinit_mu(100000);//for(int i=1;i<=10;i++)printf(\"%d\\n\",phi[i]);\n\tint n=0;scanf(\"%d\",&n);for(int i=1;i<=n;i++)scanf(\"%d\",&a[i]);\n\tlong long ans=0;\n\tfor(int d=1;d<=n;d++)\n\t{\n\t\tlong long cur=0;\n\t\tif(d<=B)\n\t\t{\n\t\t\tmemset(cnt,0,sizeof(cnt));\n\t\t\tfor(int j=1;j*d<=n;j++)cnt[a[j*d]]++;\n\t\t\tfor(int i=1;i<=pcnt;i++)\n\t\t\t{\n\t\t\t\tfor(int j=100000/prm_lst[i];j>=1;j--)cnt[j]=add(cnt[j],cnt[j*prm_lst[i]]);\n\t\t\t}\n\t\t\tfor(int i=1;i<=100000;i++)cur=add(cur,cnt[i]*cnt[i]%MOD*phi[i]%MOD);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tfor(int j=1;j*d<=n;j++)for(int k=1;k*d<=n;k++)cur=add(cur,gcd(a[j*d],a[k*d]));\n\t\t}\n\t\t//printf(\"%lld\\n\",cur);\n\t\tans=add(ans,cur*phi[d]%MOD);\n\t}\n\tprintf(\"%lld\",ans);\n}\n```",
        "postTime": 1633251774,
        "uid": 112794,
        "name": "\u5468\u5b50\u8861",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1575G\u3010GCD Festival\u3011"
    },
    {
        "content": "\u8bc8\u9a97\u9898\u5c5e\u4e8e\u662f\u3002\n\n$\\sum\\limits_{i}\\sum\\limits_{j} \\gcd(i,j)\\gcd(a_i,a_j)=\\sum\\limits_{d} \\varphi(d)\\sum\\limits_{i}\\sum\\limits_{j} \\gcd(a_{di},a_{dj})$\n\n$=\\sum\\limits_{d} \\varphi(d)\\sum\\limits_{t} \\varphi(t) (\\sum\\limits_{i}[t|a_{id}])^2$\n\n\u81f3\u6b64\uff0c\u8fd8\u60f3\u4f18\u5316\uff0c\u53d1\u73b0\u5341\u5206\u56f0\u96be\u3002\n\n\u4ed4\u7ec6\u89c2\u5bdf\uff0c\u53d1\u73b0\u679a\u4e3e $d$ \uff0c\u679a\u4e3e $id$\uff0c\u590d\u6742\u5ea6\u4e3a $n\\ln n$\uff0c\u540e\u9762\u679a\u4e3e\u56e0\u5b50\uff0c\u590d\u6742\u5ea6 $d(n)$\uff0c\u53d1\u73b0\u53ea\u6709\u4e24\u4e2a\u4ebf\uff0c\u7a33\u8fc7\u3002\n\n\u7801\u98ce\u4e11\u964b\uff0c\u6055\u4e0d\u5949\u4e0a\u3002",
        "postTime": 1635775017,
        "uid": 140876,
        "name": "syzf2222",
        "ccfLevel": 9,
        "title": "CF1575G"
    },
    {
        "content": "\u524d\u7f6e\u77e5\u8bc6\uff1a\u72c4\u5229\u514b\u96f7\u524d\u7f00\u548c\u3002\n\n\u7ed9\u5b9a\u6570\u5217 $a_i$ \uff0c\u6c42\u6570\u5217 $b_i=\\sum_{j|i}a_j$ \u3002\n\n\u4ee3\u7801 \uff1a\n \n ```cpp\nconst int N=100005;\nint n,a[N],b[N];\nscanf(\"%d\",&n);\nfor(int i=1;i<=n;++i) scanf(\"%d\",&a[i]),b[i]=a[i];\nfor(int j=1;j<=cnt;++j) \n\tfor(int k=1;k*p[j]<=n;++k)\n\t\tb[k*p[j]]+=b[k];\nfor(int i=1;i<=n;++i) printf(\"%d \",b[i]);\n```\n\u7c7b\u4f3c FMT \u3002\n\n\u53d8\u5f0f\uff1a\n\n\u7ed9\u5b9a\u6570\u5217 $a_i$ \uff0c\u6c42\u6570\u5217 $b_i=\\sum_{i|j}a_j$ \u3002\n\n\u4ee3\u7801\uff1a\n\n ```cpp\n\nconst int N=100005;\nint n,a[N],b[N];\nscanf(\"%d\",&n);\nfor(int i=1;i<=n;++i) scanf(\"%d\",&a[i]),b[i]=a[i];\nfor(int j=1;j<=cnt;++j) \n\tfor(int k=n/p[j];k>=1;--k)\n    \tb[k]+=b[k*p[j]];\nfor(int i=1;i<=n;++i) printf(\"%d \",b[i]);\n```\n\u5e94\u7528 \uff1aCF1575G\n\n\u9898\u610f \uff1a\u7ed9\u5b9a\u6570\u5217 $a_i$ \uff0c\u6c42 $\\sum_{i=1}^n\\sum_{j=1}^n \\gcd(i,j)\\cdot \\gcd(a_i,a_j)$ \u3002\n\n\u6570\u636e\u8303\u56f4\uff1a $n,a_i\\in [1,10^5]$ \u3002\n\n\u5173\u4e8e $\\phi(x)$ \uff08\u6b27\u62c9\u51fd\u6570\uff09\u7684\u6027\u8d28\uff1a\n\n\u5bf9\u4e8e\u6b63\u6574\u6570 $x$ \uff0c\u6709 $x=\\sum_{i|x}\\phi(i)$ \uff0c\u8bc1\u660e\u7565\u3002\n\n\u5bf9\u539f\u5f0f\u8fdb\u884c\u53d8\u5f62\u3002\n\n$\\sum_{i=1}^n\\sum_{j=1}^n \\gcd(i,j)\\cdot \\gcd(a_i,a_j)$\n\n$=\\sum_{i=1}^n\\sum_{j=1}^n \\sum_{x|i}\\sum_{x|j}\\phi(x)\\cdot \\gcd(a_i,a_j)$\n\n$=\\sum \\phi(x)\\sum_{i=1}^{n/x}\\sum_{j=1}^{n/x}\\gcd(a_{ix},a_{jx})$\n\n\u8003\u8651\u7c7b\u6839\u53f7\u5206\u6cbb\u3002\n\n\u6ce8\u610f\u5230\u5f53 $x$ \u6bd4\u8f83\u5927\u7684\u65f6\u5019\uff0c\u6211\u4eec\u76f4\u63a5\u679a\u4e3e $i,j$ \u8ba1\u7b97\uff0c\u5355\u6b21\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2 \\log n/x^2)$ \u3002\n\n\u5f53 $x$ \u6bd4\u8f83\u5c0f\u7684\u65f6\u5019\u5c31\u4e0d\u80fd\u5f3a\u884c\u679a\u4e3e\u4e86\u3002\u8fd9\u65f6\uff0c\u53d6\u51fa\u6211\u4eec\u9700\u8981\u8003\u8651\u7684\u6570\u5b57\u3002\u8fd9\u4e9b\u6570\u5b57\u5e94\u8be5\u662f $a_x,a_{2x}\\dots a_{(n/x)x}$ \u3002\u8bb0 $b_i=a_{ix},m=(n/x)$ \uff0c\u663e\u7136\u6570\u5217 $b_i$ \u6709 $m$ \u9879\u3002\n\n\u90a3\u4e48\u6211\u4eec\u9700\u8981\u6c42\u7684\u5c31\u662f\uff1a $\\sum_{i=1}^m \\sum_{j=1}^m \\gcd(b_i,b_j)$ \u3002\n\n\u7ee7\u7eed\u53d8\u5f62 \uff1a\n\n$\\sum_{i=1}^m \\sum_{j=1}^m \\gcd(b_i,b_j)$ \n\n$=\\sum_{i=1}^m \\sum_{j=1}^m \\sum_{x|b_i}\\sum_{x|b_j} \\phi(x)$\n\n$=\\sum_{x=1}^{N}\\phi(x)\\cdot (\\sum_{i=1}^{n}[x|b_i])^2$\n\n\u90a3\u4e48\uff0c\u6211\u4eec\u5c31\u628a\u7528\u4e4b\u524d\u53d6\u51fa\u7684\u6570\u5b57\u505a Dirichlet \u524d\u7f00\u548c\u5c31\u597d\u4e86\u3002\u7528\u7684\u662f\u53d8\u5f0f\u7684\u5f62\u5f0f\u3002\n\n\u590d\u6742\u5ea6\u5206\u6790\uff1a\n\n\u8bb0\u9608\u503c\u4e3a $B$ \uff0c\u5927\u4e8e $B$ \u65f6\u6211\u4eec\u7528\u65b9\u6cd5 $1$ \uff0c\u5426\u5219\u7528\u65b9\u6cd5 $2$ \u3002\n\n\u65b9\u6cd5 $1$ \u7684\u603b\u8017\u65f6 \n\n$T_1=\\sum_{x=B}^n n^2\\log n/x^2=n^2\\log n\\sum_{x=B}^n 1/x^2$ \n\n$=n^2\\log n(1/B-1/n)=n^2\\log n/B$ \u3002\n\n\u65b9\u6cd5 $2$ \u7684\u603b\u8017\u65f6\n\n$T_2=n\\log n \\log n$ \u3002\n\n\u4ee4 $T_1=T_2$ \uff0c\u5219 $B=\\sqrt{n\\log n/\\log \\log n}$\n\n\u518d\u4ee4 $n=10^5$ \uff0c\u53ef\u5f97 $B=651.92$ \u3002\n\n\u540e\u8005\u5e38\u6570\u8fc7\u5927\uff0c\u7406\u8bba\u4e0a $B$ \u5e94\u8be5\u66f4\u5c0f\u4e9b\uff1f\u4e0d\u8fc7\u5b9e\u6d4b $B$ \u4ece $400$ \u4e00\u76f4\u5347\u5230 $700$ \u7684\u8fc7\u7a0b\u4e2d\u7528\u65f6\u5355\u8c03\u9012\u51cf\uff0c\u8fd9\u5c31\u5f88\u5947\u602a\u4e86\u3002\n\n\u672c\u7bc7\u535a\u5ba2\u53c2\u8003\u4e86 @\u5468\u5b50\u8861 \u7684\u9898\u89e3\uff0c\u5728\u6b64\u7279\u522b\u611f\u8c22\u3002",
        "postTime": 1651725070,
        "uid": 131591,
        "name": "\u849f\u84bb\u541bHJT",
        "ccfLevel": 7,
        "title": "\u72c4\u5229\u514b\u96f7\u524d\u7f00\u548c"
    }
]
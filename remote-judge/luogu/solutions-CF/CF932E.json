[
    {
        "content": "~~\u55ef\uff0c\u4f60\u770b\u8fd9\u7fa4\u4eba\uff0c\u624d\u63a8\u51fa $\\Theta(k \\log k)$ \u5c31\u4e0d\u5f80\u4e0b\u4e86\uff0c\u771f\u662f\u592a\u900a\u4e86~~\r\n\r\n\u63d0\u4f9b\u4e00\u79cd\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(k)$ \u7684\u505a\u6cd5\u3002\r\n\r\n$$\\sum_{i=0}^n \\binom ni i^k$$\r\n\u5c06 $i^k$ \u7528\u7b2c\u4e8c\u7c7b Stirling \u6570\u5c55\u5f00\r\n$$=\\sum_{i=0}^n \\binom ni \\sum_{j=1}^k \\begin{Bmatrix} k \\\\ j \\end{Bmatrix}i^{\\underline j}$$\r\n$$=\\sum_{j=1}^k \\begin{Bmatrix} k \\\\ j \\end{Bmatrix}j! \\sum_{i=0}^n \\binom ni \\binom ij$$\r\n$$=\\sum_{j=1}^k \\begin{Bmatrix} k \\\\ j \\end{Bmatrix}j! \\sum_{i=0}^n \\binom nj \\binom{n-j}{i-j}$$\r\n$$=\\sum_{j=1}^k \\begin{Bmatrix} k \\\\ j \\end{Bmatrix}j! \\binom nj \\sum_{i=0}^{n-j} \\binom{n-j}{i}$$\r\n$$=\\sum_{j=1}^k \\begin{Bmatrix} k \\\\ j \\end{Bmatrix} j! \\binom{n}{j} 2^{n-j}$$\r\n\u5f88\u591a\u4eba\u63a8\u5230\u8fd9\u91cc\u5c31\u505c\u4e86\uff0c\u56e0\u4e3a\u4e00\u884c\u7b2c\u4e8c\u7c7b Stirling \u6570\u53ef\u4ee5\u5f88\u5bb9\u6613\u7684\u7528\u4e00\u6b21\u5377\u79ef\u8ba1\u7b97\uff1b\u4f46\u5c06\u5176\u8fdb\u4e00\u6b65\u5c55\u5f00\uff0c\u5c31\u53ef\u4ee5\u505a\u5230\u66f4\u4f18\u7684\u590d\u6742\u5ea6\u3002\r\n\r\n\u5728 $n > k$ \u7684\u65f6\u5019\uff0c\u539f\u5f0f\u7b49\u4e8e\r\n$$\\sum_{j=1}^k \\binom nj 2^{n-j} \\sum_{i=1}^j \\binom jii^k(-1)^{j-i}$$\r\n~~\u4f7f\u7528\u9b54\u6cd5~~ \u4ea4\u6362\u4e00\u4e0b\u6c42\u548c\u987a\u5e8f\r\n$$=\\sum_{i=1}^k i^k\\sum_{j=i}^k \\binom nj\\binom ji 2^{n-j}(-1)^{j-i}$$\r\n$$=\\sum_{i=1}^k i^k\\binom ni \\sum_{j=i}^k  \\binom{n-i}{j-i}2^{n-j}(-1)^{j-i}$$\r\n$$=\\sum_{i=1}^k \\binom ni i^k 2^{n-i}\\sum_{j=0}^{k-i} \\binom{n-i}{j} \\left( - \\frac 12\\right)^j$$\r\n\u8bbe $f_i$ \u4e3a\u540e\u9762\u90a3\u4e2a\u548c\u5f0f\u7684\u503c\uff0c\u8003\u8651\u9012\u63a8\uff1a  \r\n\uff08\u4e3a\u4e86\u65b9\u4fbf\u4e0b\u9762\u8868\u793a\uff0c\u8bbe $w=-0.5$\uff09\r\n\r\n$$f_{i}-f_{i+1}$$\r\n$$= \\left(\\sum_{j=0}^{k-i} \\binom{n-i}{j} w^j \\right)-\\left( \\sum_{j=0}^{k-i-1} \\binom{n-i-1}{j}w^j\\right)$$\r\n\u628a\u524d\u4e00\u4e2a\u548c\u5f0f\u4e2d $j=k-i$ \u7684\u9879\u63d0\u51fa\u6765\uff0c\u5176\u4ed6\u7684\u5e76\u8fdb\u53bb\r\n$$= \\binom{n-i}{k-i}w^{k-i}+ \\sum_{j=0}^{k-i-1} \\left( \\binom{n-i}{j} - \\binom{n-i-1}{j}\\right) w^j$$\r\n$$=\\binom{n-i}{k-i}w^{k-i}+\\sum_{j=0}^{k-i-1} \\binom{n-i-1}{j-1} w^j$$\r\n$$= \\binom{n-i}{k-i}w^{k-i}+w\\sum_{j=0}^{k-i-2} \\binom{n-i-1}{j}w^j$$\r\n\u518d\u628a\u90a3\u4e2a\u548c\u5f0f\u6700\u540e\u7f3a\u7684\u4e00\u9879\u8865\u56de\u6765\r\n$$=\\binom{n-i}{k-i} w^{k-i}+w \\left( f_{i+1}-\\binom{n-i-1}{k-i-1}w^{k-i-1}\\right)$$\r\n$$=\\binom{n-i}{k-i} w^{k-i}+wf_{i+1}-\\binom{n-i-1}{k-i-1}w^{k-i}$$\r\n$$= \\binom{n-i-1}{k-i}w^{k-i}+wf_{i+1}$$\r\n\u4e8e\u662f\u5f97\u5230\u9012\u63a8\u5f0f\r\n$$f_i=(w+1)f_{i+1} + \\binom{n-i-1}{k-i}w^{k-i}$$\r\n\u9012\u63a8\u5904\u7406\u7ec4\u5408\u6570\uff0c\u518d\u7ebf\u6027\u7b5b\u51fa $i^k$\uff0c\u5c31\u53ef\u4ee5\u505a\u5230\u4e25\u683c\u7684 $\\Theta(k)$ \u4e86\u3002\r\n\r\n```cpp\r\n#pragma GCC optimize (\"unroll-loops\")\r\n#pragma GCC optimize (2)\r\n#include<cstdio>\r\n#include<iostream>\r\n#include<algorithm>\r\n#include<cstring>\r\n#include<cmath>\r\n#define N 5007\r\n#define ll long long\r\n#define p 1000000007\r\n#define reg register\r\nusing namespace std;\r\n \r\ninline int power(int a,int t){\r\n    int res = 1;\r\n    while(t){\r\n        if(t&1) res = (ll)res*a%p;\r\n        a = (ll)a*a%p;\r\n        t >>= 1;\r\n    }\r\n    return res;\r\n}\r\n \r\nint n,m,k,cnt;\r\nint f[N],inv[N],pw[N],pr[N>>1],c[N];\r\n \r\nint solve1(){\r\n    int res = 0;\r\n    for(reg int i=1;i<=n;++i) res = (res+(ll)c[i]*pw[i])%p;\r\n    return res;\r\n}\r\n \r\nconst int w = 500000003;\r\n \r\nint solve2(){\r\n    int c2,mul,res = 0;\r\n    mul = c2 = f[k] = 1;\r\n    for(reg int i=k-1;i;--i){\r\n        c2 = (ll)c2*(n-i-1)%p*inv[k-i]%p;\r\n        mul = (ll)mul*w%p;\r\n        f[i] = ((ll)c2*mul+(ll)(w+1)*f[i+1])%p;\r\n    }\r\n    mul = p-w;\r\n    for(reg int i=1;i<=k;++i){\r\n        res = (res+(ll)pw[i]*c[i]%p*mul%p*f[i])%p;\r\n        mul = (ll)mul*(p-w)%p;\r\n    }\r\n    res = (ll)res*power(2,n)%p;\r\n    return res;\r\n}\r\n \r\nint main(){\r\n    scanf(\"%d%d%d\",&n,&k);\r\n    c[0] = inv[1] = pw[1] = 1;\r\n    c[1] = n;\r\n    for(reg int i=2;i<=k+1;++i){\r\n        inv[i] = (ll)(p-p/i)*inv[p%i]%p;\r\n        c[i] = (ll)c[i-1]*inv[i]%p*(n-i+1)%p;\r\n        if(!pw[i]){\r\n            pr[++cnt] = i;\r\n            pw[i] = power(i,k);\r\n        }\r\n        for(reg int j=1;j<=cnt&&i*pr[j]<=k;++j){\r\n            pw[i*pr[j]] = (ll)pw[i]*pw[pr[j]]%p;\r\n            if(i%pr[j]==0) break;\r\n        }\r\n    }\r\n    if(n<=k+1) printf(\"%d\",solve1());\r\n    else printf(\"%d\",solve2());\r\n    return 0;\t\r\n}\r\n```\r\n\r\n~~CF1278F \u548c\u8fd9\u9898\u5176\u5b9e\u662f\u4e00\u4e2a\u505a\u6cd5\uff0c\u53cc\u500d\u7ecf\u9a8c~~",
        "postTime": 1588335690,
        "uid": 115864,
        "name": "NaCly_Fish",
        "ccfLevel": 6,
        "title": "CF932E solution"
    },
    {
        "content": "\u6570\u8bba\u63a8\u5f0f\u5b50\u3002\n\n$\\sum\\limits_{i=1}^nC(n,i)i^k$\n\n$=\\sum\\limits_{i=0}^nC(n,i)i^k$\n\n$=\\sum\\limits_{i=0}^n\\frac{n!}{i!(n-i)!}\\sum\\limits_{j=0}^kS(k,j)C(i,j)j!$\n\n$=\\sum\\limits_{i=0}^n\\frac{n!}{(n-i)!}\\sum\\limits_{j=0}^kS(k,j)\\frac{1}{(i-j)!}$\n\n$=\\sum\\limits_{i=0}^n\\sum\\limits_{j=0}^kS(k,j)\\frac{n!}{(n-i)!(i-j)!}$\n\n$=\\sum\\limits_{j=0}^kS(k,j)\\sum\\limits_{i=0}^n\\frac{(n-j)!}{(n-i)!(i-j)!}*\\frac{n!}{(n-j)!}$\n\n$=\\sum\\limits_{j=0}^kS(k,j)\\frac{n!}{(n-j)!}\\sum\\limits_{i=0}^n C(n-j,n-i)$\n\n$=\\sum\\limits_{j=0}^kS(k,j)\\frac{n!}{(n-j)!}2^{n-j}$\n\n(\u5176\u4e2d$S(i,j)$\u8868\u793a\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570)\n\n\u6b64\u65f6\u5373\u53ef$O(k^2)$\u9884\u5904\u7406\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\uff0c\u5728$O(k)$\u8ba1\u7b97\u5373\u53ef\u3002\n\n\u6ce8\u610f\u7b2c1\u6b65\u3002\u5f53k=0\u65f6\uff0c\u6839\u636e\u540e\u9762\u7684\u8ba1\u7b97\uff0c$0^0$\u88ab\u7b97\u4e3a1\uff0c\u9700\u8981\u5728\u6700\u540e\u51cf\u53bb\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\n#include<ext/pb_ds/assoc_container.hpp>\n#define Rep(i,a,b) for(register int i=(a),i##end=(b);i<=i##end;++i)\n#define Repe(i,a,b) for(register int i=(a),i##end=(b);i>=i##end;--i)\n#define For(i,a,b) for(i=(a),i<=(b);++i)\n#define Forward(i,a,b) for(i=(a),i>=(b);--i)\ntemplate<typename T>inline void read(T &x)\n{\n\tT f=1;x=0;char c;\n\tfor(c=getchar();!isdigit(c);c=getchar())if(c=='-')f=-1;\n\tfor(;isdigit(c);c=getchar())x=x*10+(c^48);\n\tx*=f;\n}\nusing namespace std;\nvoid file()\n{\n#ifndef ONLINE_JUDGE\n\tfreopen(\"dt.in\",\"r\",stdin);\n\tfreopen(\"dt.out\",\"w\",stdout);\n#endif\n}\nstatic int n,k;\nconst int mod=1e9+7;\nconst int MAXN=5e3+7;\nstatic int S[MAXN][MAXN];\ninline void predone(int lim)\n{\n\tS[0][0]=1;\n\tRep(i,1,lim)Rep(j,1,i)\n\t\tS[i][j]=(S[i-1][j-1]+1ll*S[i-1][j]*j%mod)%mod;\n}\nstatic int ans;\ninline int power(int a,int b)\n{\n\tstatic int sum;\n\tfor(sum=1;b;b>>=1,a=1ll*a*a%mod)if(b&1)\n\t\tsum=1ll*sum*a%mod;\n\treturn sum;\n}\nint main()\n{\n\tfile();\n\tread(n);read(k);\n\tpredone(k);\n\tstatic int lag=1,p2=power(2,n),inv2=power(2,mod-2);\n\tRep(i,0,k)\n\t{\n\t\tans=(ans+1ll*lag*S[k][i]%mod*p2%mod)%mod;\n\t\tlag=1ll*lag*(n-i)%mod;\n\t\tp2=1ll*p2*inv2%mod;\n\t}\n\tif(!k)--ans;\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n\n\n```",
        "postTime": 1520147332,
        "uid": 7035,
        "name": "Great_Influence",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF932E \u3010Team Work\u3011"
    },
    {
        "content": "### \u6b63\u6587\r\n\r\n\u9898\u76ee\u60f3\u8981\u6c42\u51fa\u5982\u4e0b\u5f0f\u5b50\uff1a\r\n\r\n$$ \\sum_{i=1}^n\\binom n i \\times i^k $$\r\n\r\n\u6211\u4eec\u53d1\u73b0\u8fd9\u5f88\u50cf\u4e8c\u9879\u5f0f\u5b9a\u7406\u7684\u5206\u652f\uff1a\r\n\r\n$$ (x+1)^n=\\sum_{i=0}^n\\binom n i  x^i $$\r\n\r\n\u5bf9\u4e8e\u4e0a\u9762\u7684\u5f0f\u5b50\uff0c\u4f3c\u4e4e\u53ea\u9700\u8981\u53cd\u590d\u6c42\u5bfc\u63d0\u51fa $ i $ \u5373\u53ef\uff0c\u4e8e\u662f\u6211\u4eec\u6765\u8bd5\u4e00\u8bd5\uff1a\r\n\r\n$$ n(x+1)^{n-1}=\\sum_{i=0}^n\\binom n i i\\times x^{i-1}  $$\r\n\r\n\u4e24\u8fb9\u540c\u65f6\u4e58\u4e0a $ x $\u3002\r\n\r\n$$ nx(x+1)^{n-1}=\\sum_{i=0}^n\\binom n i i\\times x^i $$\r\n\r\n\u518d\u6b21\u8fdb\u884c\u6c42\u5bfc\uff1a\r\n\r\n$$ n(x+1)^{n-1}+n(n-1)x(x+1)^{n-2}=\\sum_{i=0}^n\\binom n i i^2\\times x^{i-1} $$\r\n\r\n\u6709\u70b9\u89c4\u5f8b\uff0c\u91cd\u590d\u4e0a\u9762\u7684\u64cd\u4f5c\uff1a\r\n\r\n$$ LHS=n(x+1)^{n-1}+n(n-1)x(x+1)^{n-2}+2n(n-1)x(x+1)^{n-2}+n(n-1)(n-2)x^2(x+1)^{n-2} $$\r\n\r\n$$ LHS=n(x+1)^{n-1}+3n(n-1)x(x+1)^{n-2}+n(n-1)(n-2)x^2(x+1)^{n-2} $$\r\n\r\n$$ RHS=\\sum_{i=0}^n\\binom n i i^3\\times x^{i-1} $$\r\n\r\n\u6211\u4eec\u53d1\u73b0\u6bcf\u6b21\u6c42\u5bfc\u540e\uff0c\u5de6\u5f0f\u4f1a\u589e\u52a0\u4e00\u4e2a\u591a\u9879\u5f0f\uff0c\u800c\u8fd9\u4e00\u8f6e\u4e2d\u7684\u5de6\u5f0f\u663e\u7136\u5b58\u5728\u89c4\u5f8b\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8ba1\u7b97\u597d\u7cfb\u6570\u5373\u53ef\u3002\r\n\r\n\u5047\u8bbe\u7ecf\u8fc7 $ k $ \u6b21\u6c42\u5bfc\u540e\u5de6\u5f0f\u4e3a $ \\sum_{i=1}^k a_i\\times n^{\\underline{i}}\\times x^{i-1}\\times (x+1)^{n-i} $\r\n\r\n\u4e58\u4e0a $ x $ \u540e\u5f97 $ \\sum_{i=1}^k a_i\\times n^{\\underline{i}}\\times x^i\\times (x+1)^{n-i} $\r\n\r\n\u6211\u4eec\u60f3\u8981\u63a8\u5230\u81f3 $ k+1 $ \u7684\u5de6\u5f0f $ \\sum_{i=1}^{k+1} b_i\\times n^{\\underline{i}}\\times x^{i-1}\\times (x+1)^{n-i} $\r\n\r\n\u5bb9\u6613\u53d1\u73b0\u6b64\u65f6\u7b2c $ i $ \u9879\u6c42\u5bfc\u4f1a\u53d8\u4e3a $ a_i\\times i\\times n^{\\underline{i}}\\times x^{i-1}\\times (x+1)^{n-i}+a_i\\times n^{\\underline{i+1}}\\times x^i\\times (x+1)^{n-i-1} $\r\n\r\n\u6240\u4ee5\u63a8\u51fa $ b $ \u6570\u7ec4\u5173\u4e8e $ a $ \u6570\u7ec4\u7684\u9012\u63a8\u5f0f\uff1a$ b_i=a_i\\times i+a_{i-1} $\u3002\r\n\r\n\u6240\u4ee5\u7cfb\u6570\u95ee\u9898\u6211\u4eec\u4e5f\u89e3\u51b3\u4e86\u3002\r\n\r\n\u6700\u540e\u4e00\u6b65\uff0c\u4ee3\u5165 $ x=1 $\uff0c\u53d1\u73b0\u53f3\u5f0f\u4e3a $ \\sum_{i=0}^n\\binom n i i^k $\u3002\r\n\r\n\u53d1\u73b0\u8fd9\u4e2a\u5f0f\u5b50\u5728 $ i=0 $ \u662f\u7b54\u6848\u4e3a $ 0 $\uff0c\u6240\u4ee5\u5373\u4e3a\u9898\u76ee\u6240\u6c42\u5f0f\u3002\r\n\r\n\u90a3\u4e48\u7b54\u6848\u5373\u4e3a $ \\sum_{i=1}^k a_i\\times n^{\\underline{i}}\\times 2^{n-i} $\u3002\r\n\r\n\u4ee3\u7801\u5982\u4e0b\uff1a\r\n\r\n```cpp\r\n#include<iostream>\r\n#include<iomanip>\r\n#include<cmath>\r\n#include<cstring>\r\n#include<cstdio>\r\n#include<algorithm>\r\n#include<queue>\r\nusing namespace std;\r\n#define int long long\r\n#define md(a) a=(a%mod+mod)%mod\r\n#define file(a) freopen(#a\".in\",\"r\",stdin);freopen(#a\".out\",\"w\",stdout)\r\nconst int N=5005,mod=1e9+7;\r\nint n,ned,a[N],b[N],fac[N],inv[N],upd,ans,mul=1;\r\nint qp(int a,int n)\r\n{\r\n\tif(n==0)return 1;int p=qp(a,n/2);p=p*p%mod;\r\n\tif(n&1)return p*a%mod;return p;\r\n}\r\nvoid init()\r\n{\r\n\tfac[0]=1,upd=5000;\r\n\tfor(int i=1;i<=upd;i++)fac[i]=fac[i-1]*i%mod;\r\n\tinv[upd]=qp(fac[upd],mod-2);\r\n\tfor(int i=upd-1;i>=0;i--)inv[i]=inv[i+1]*(i+1)%mod;\r\n}\r\nint C(int n,int m){if(n<m)return 0;return fac[n]*inv[m]%mod*inv[n-m]%mod;}\r\nvoid pl(int x)\r\n{\r\n\tfor(int i=1;i<=x;i++)b[i]=a[i-1]%mod+i*a[i]%mod,b[i]%=mod;\r\n\tfor(int i=1;i<=x;i++)a[i]=b[i];\r\n}\r\nsigned main()\r\n{\r\n\tcin>>n>>ned,init(),a[1]=1;\r\n\tfor(int i=2;i<=ned;i++)pl(i);\r\n\tfor(int i=1;i<=ned;i++)\r\n\t{\r\n\t\tmul*=n-i+1,mul%=mod;\r\n\t\tans+=a[i]*mul%mod*qp(2,n-i)%mod,ans%=mod;\r\n\t}\r\n\tcout<<ans;\r\n\treturn 0;\r\n}\r\n```\r\n",
        "postTime": 1668004901,
        "uid": 556042,
        "name": "Iratis",
        "ccfLevel": 7,
        "title": "CF932E-Team Work"
    },
    {
        "content": "\u9996\u5148\u6839\u636e\u89c2\u5bdf\u53ef\u4ee5\u77e5\u9053\r\n$$\\dfrac1{2^{n-k}}\\sum_{i=0}^n\\dbinom nii^k$$\r\n\u662f\u5173\u4e8e $n$ \u7684 $k$ \u6b21\u591a\u9879\u5f0f .\r\n\r\n\u8bc1\u660e\u5982\u4e0b\uff1a\r\n\r\n\u7b54\u6848\u80af\u5b9a\u662f\u5173\u4e8e $n$ \u7684\u591a\u9879\u5f0f\uff0c\u4e0b\u9762\u5206\u6790\u6b21\u6570 .\r\n\r\n\u6839\u636e\u7ecf\u5178\u601d\u8def\uff0c\u4ee4 $\\displaystyle f_{k,n}(z)=\\sum_{i=1}^n\\dbinom nii^kz^i=g_{k,n}(z)\\cdot(z+1)^{n-k}$\uff0c\u5176\u4e2d $g_{k,n}$ \u662f\u4e00\u5173\u4e8e $n$ \u7684\u591a\u9879\u5f0f .\r\n$$\\begin{aligned}\\dfrac{\\mathrm d}{\\mathrm dz}(f_{k,n}(z)z)&=f_{k,n}(z)+zf'_{k,n}(z)\\\\&=g_{k,n}(z)\\cdot(z+1)^{n-k}+z(g_{k,n}'(z)\\cdot(z+1)^{n-k}+(n-k)g_{k,n}(z)\\cdot(z+1)^{n-k-1})\\\\&=g_{k,n}(2)2^{n-k}+2(g'_{k,n}(z)2^{n-k}+(n-k)g_{k,n}(2)2^{n-k-1})\\\\&=(n-k+1)g_{k,n}(2)2^{n-k}+2g'_{k,n}(2)2^{n-k}\\\\&=2^{n-k}((n-k+1)g_{k,n}(2) + 2g'_{k,n}(2))\\end{aligned}$$\r\n\u7b2c\u4e09\u4e2a\u7b49\u53f7\u5904\u4ee3\u5165 $z=1$ .\r\n\r\n\u5f52\u7eb3\u5373\u53ef\u5f97\u5230\u4e3a $k$ \u6b21 .\r\n\r\n***\r\n\r\n\u4e8e\u662f\u66b4\u529b $\\Theta(k^2)$ \u6c42\u70b9\u503c\u540e Lagrange \u63d2\u503c\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(k^2)$ .",
        "postTime": 1675422398,
        "uid": 227514,
        "name": "jijidawang",
        "ccfLevel": 0,
        "title": "CF932E"
    },
    {
        "content": "### $\\sum_{i=1}^nC_n^i\\times i^k$\n\n\u5c31\u662f\u6c42\u8fd9\u4e2a\u5f0f\u5b50\n\n\u597d\u50cf\u6709\u70b9\u6bd2\u7624\n\n\u6211\u4eec\u8003\u8651\u5982\u4f55\u5feb\u901f\u6c42$i^k$\n\n\u6709\u4e00\u4e2a\u4e1c\u897f\u53eb\u505a\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\n\n\u5982\u679c\u4f60\u4e0d\u77e5\u5230\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\uff0c\u53ef\u4ee5\u770b\u770b\u6211\u7684[\u7ec4\u5408\u6570\u5b66\u7684\u4e00\u4e9b\u5c0f\u77e5\u8bc6\u603b\u7ed3](https://www.luogu.org/blog/wohaocaia/zu-ge-shuo-xue-di-yi-suo-xiao-zhi-shi-zong-jie-wei-wan-post)\u624d\u521a\u5f00\u59cb\u5199\uff0c\u672a\u5b8c\u5f85\u7eed\uff0c\u5927\u4f6c\u8f7b\u55b7\u3002\n\n\u6709\u4e00\u6761\u6027\u8d28\u5c31\u662f\u8fd9\u4e2a\u4e1c\u897f\n\n$$i^k=\\sum_{j=0}^kS_k^j\u00d7j!\u00d7C_i^j$$\n\n\u76f4\u63a5\u6254\u8fdb\u53bb\n\n$$=\\sum_{i=1}^nC_n^i\\sum_{j=0}^kS_k^j\u00d7j!\u00d7C_i^j$$\n\n$$=\\sum_{i=1}^n\\sum_{j=0}^kC_n^i\\times S_k^j\u00d7j!\u00d7C_i^j$$\n\n\u6362\u4e00\u4e2a\u4f4d\u7f6e\n\n$$=\\sum_{j=0}^k\\sum_{i=1}^nC_n^i\\times S_k^j\u00d7j!\u00d7C_i^j$$\n\n$$=\\sum_{j=0}^kS_k^j\u00d7j!\\sum_{i=1}^nC_n^i\u00d7C_i^j$$\n\n$$=\\sum_{j=0}^kS_k^j\u00d7j!\\sum_{i=1}^n(\\frac {n!}{i!(n-i)!}\\cdot\\frac{i!}{(i-j)!(j)!})$$\n\n$$=\\sum_{j=0}^kS_k^j\u00d7j!\\sum_{i=1}^n(\\frac {n!}{(n-i)!(i-j)!(j)!})$$\n\n$$=\\sum_{j=0}^kS_k^j\\sum_{i=1}^n(\\frac {n!}{(n-i)!(i-j)!})$$\n\n~~\u6d88\u6d88\u4e50~~\n\n\u7136\u540e\u6ce8\u610f\u5230$n-i+i-j=n-j$\n\n\u6240\u4ee5\u51d1\u4e00\u51d1\n\n$$=\\sum_{j=0}^kS_k^j\\sum_{i=1}^n[\\frac {(n-j)!(n!)}{(n-i)!(i-j)!(n-j)!}]$$\n\n$$=\\sum_{j=0}^kS_k^j\\sum_{i=1}^n\\frac {n!}{(n-j)!}[\\frac {(n-j)!}{(n-i)!(i-j)!}]$$\n\n$$=\\sum_{j=0}^kS_k^j\\frac {n!}{(n-j)!}\\sum_{i=1}^nC_{n-j}^{n-i}$$\n\n\u6ce8\u610f\u5230$\\sum_{i=0}^mC_{m}^{i}=2^m$\n\n$$\\sum_{j=0}^kS_k^j\\frac {n!}{(n-j)!}\\sum_{i=1}^nC_{n-j}^{n-i}$$\n\n\u8fd9\u91cc\u597d\u50cf\u540e\u9762\u7684\u4e1c\u897f\u8fd8\u52a0\u591a\u4e86\u2026\u2026\n\n$$=\\sum_{j=0}^kS_k^j\\frac {n!}{(n-j)!}2^{n-j}$$\n\n\u66b4\u529b\u9012\u63a8\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u5c31\u53ef\u4ee5\u505a\u5230$O(k^2)$\n\n\u4f46\u662f\u5982\u679c$k,$\u5f88$,$\u5927$,$\u600e\u4e48\u529e\uff1f\n\n\u6709\u4e00\u4e2a\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u901a\u9879\u516c\u5f0f\n\n$$S_k^n=\\sum_ {i=0}^n \\frac {(-1)^{i}}{i!}\\times \\frac{(n-i)^k}{(n-i)!}$$\n\n\u5728$k$\u56fa\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u8bbe$S_k^n=h(n)$\n\n$$\\frac {(-1)^{i}}{i!}=f(i)$$\n\n$$\\frac{i^k}{i!}=g(i)$$\n\n\u8fd9\u91cc\u663e\u7136\u662f\u4e00\u4e2a\u5377\u79ef\u7684\u5f62\u5f0f\n\n\u5373\n\n$$h(n)=f(i)\\times g(n-i)$$\n\n\u6240\u4ee5$NTT$\u5c31\u53ef\u4ee5\u4f18\u5316\u5230$O(klog_2k)$\u5566\uff01\n\n\u7b54\u6848 $=\\sum_{j=0}^kS_k^j\\frac {n!}{(n-j)!}2^{n-j}$\n\n$\\frac {n!}{(n-j)!}$\u6709\u4e00\u70b9\u6076\u5fc3\u554a\uff0c$n$\u662f$10^9!!!$\n\n\u90a3\u5c55\u5f00\u4e00\u4e0b\u5c31\u662f$\\ n\\cdot (n-1)\\cdot (n-2)\\cdot...\\ \\cdot(n-j+1)$\n\n\u5faa\u73af\u7684\u65f6\u5019\u7b97\u6389\u5c31\u597d\u5566\uff01\n\n\u7531\u4e8e\u592a\u6bd2\u7624\u4e86\uff0c\u6a21\u6570\u4e0d\u662f$998244353$\uff0c\u6240\u4ee5\u6211\u7528\u4e86\u4e09\u6a21\u6570\n\n\u7136\u540e\u5de8\u6162\uff0c\u53ea\u6709$rank\\ 4$\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n```\n#include<bits/stdc++.h>\n#define ijc 1000000007\n#define int long long\n#define ll long long\nusing namespace std;\nint n,m,k,r[400006],lim;\nll f[44001],ans[3][44001],h[44001],w[44001],_a[44001],_b[44001],g[44001];\nll P[3]={998244353,1004535809,469762049};\ninline ll fast_pow(ll a,ll b,ll p){\n    ll t=1;a%=p;\n    while (b){\n        if (b&1) t=t*a%p;\n        b>>=1;a=a*a%p;\n    }\n    return t;\n}\ninline void NTT(ll f[],int lim,int id,ll ljc){\n    for (int i=0;i<lim;i++){\n        if (i<r[i]) swap(f[r[i]],f[i]);\n    }\n    w[0]=1;\n    for (int len=1;len<lim;len<<=1){\n    \tll gen=fast_pow(3,(ljc-1)/(len<<1)*id+ljc-1,ljc);\n    \tfor (int i=1;i<lim;i++) w[i]=w[i-1]*gen%ljc;\n        for (int i=0;i<lim;i+=len<<1){\n            ll *f1=f+i,*f2=f1+len;\n            for (int j=0;j<len;j++){\n                ll x=f1[j]%ljc,y=f2[j]*w[j]%ljc;\n                f1[j]=(x+y)%ljc;f2[j]=(x-y+ljc)%ljc;\n            }\n        }\n    }\n    if (id==1) return;\n    ll Inv=fast_pow(lim,ljc-2,ljc);\n    for (int i=0;i<lim;i++) f[i]=f[i]*Inv%ljc;\n}\ninline void mul(ll Ans[],int lim,ll p){\n    memcpy(_a,f,sizeof(f)),memcpy(_b,g,sizeof(g));\n    NTT(_a,lim,1,p);NTT(_b,lim,1,p);\n    for (int i=0;i<=lim;i++) Ans[i]=(ll)_a[i]*_b[i]%p;\n    NTT(Ans,lim,-1,p);\n}\ninline ll Gets(ll A,ll B,ll C,ll inv1,ll inv2,ll p12){\n    ll t=(B-A+P[1])%P[1]*inv1%P[1]*P[0]+A;\n    return ((C-t%P[2]+P[2])%P[2]*inv2%P[2]*(p12%ijc)%ijc+t)%ijc;\n}\nsigned main(){\n    cin>>n>>k;\n    f[0]=1;g[0]=0;g[1]=1;\n    ll fac=1;\n    for (int i=2;i<=k;i++){\n        fac=1LL*fac*i%ijc;\n        ll Iv=fast_pow(fac,ijc-2,ijc);\n        g[i]=fast_pow(i,k,ijc)*Iv%ijc;\n    }\n    fac=1;\n    for (int i=1;i<=k;i++){\n        fac=fac*i%ijc;\n        f[i]=(ijc+(i%2?-1:1)*fast_pow(fac,ijc-2,ijc)%ijc)%ijc;\n    }\n    ll lim=1,len=0;\n    while (lim<=(k<<1)) lim<<=1,len++;\n    for (int i=0;i<lim;i++){\n        r[i]=(r[i>>1]>>1)|((i&1)<<(len-1));\n    }\n    for (int i=0;i<3;i++) mul(ans[i],lim,P[i]);\n    ll p12=1LL*P[0]*P[1],inv1=fast_pow(P[0],P[1]-2,P[1]),inv2=fast_pow(p12,P[2]-2,P[2]);\n    for (int i=0;i<=k;i++) h[i]=Gets(ans[0][i],ans[1][i],ans[2][i],inv1,inv2,p12);\n    fac=1;ll anss=0,two=fast_pow(2,n,ijc);inv2=fast_pow(2,ijc-2,ijc);//\u524d\u9762\u5168\u662f\u4e09\u6a21\u6570NTT\n    for (int j=0;j<=k;j++){\n        anss=(anss+1LL*fac*h[j]%ijc*two%ijc)%ijc;\n        fac=1LL*fac*(n-j)%ijc;\n        two=two*inv2%ijc;\n    }\n    cout<<anss<<endl;\n}\n```",
        "postTime": 1547444481,
        "uid": 20309,
        "name": "Fading",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF932E \u3010Team Work\u3011"
    },
    {
        "content": "\u5c06\u539f\u9898\u770b\u4f5c\uff1a\u6709$n$\u4e2a\u7bb1\u5b50\uff0c\u4ece\u4e2d\u9009\u51fa$i$\u4e2a\u7bb1\u5b50\uff0c\u7136\u540e\u628a$k$\u4e2a\u4e0d\u540c\u7684\u7403\u88c5\u5728\u8fd9$i$\u4e2a\u7bb1\u5b50\u4e2d\uff0c\u6c42\u65b9\u6848\u6570\u3002\n\n\u53d1\u73b0$k$\u4e2a\u7403\u6700\u591a\u88c5\u5728$k$\u4e2a\u7bb1\u5b50\u91cc\uff0c\u4f1a\u6709\u5f88\u591a\u7a7a\u7bb1\uff0c\u6240\u4ee5\u8bbe$f(i,j)$\u8868\u793a$i$\u4e2a\u7403\u88c5\u5728$j$\u4e2a\u7bb1\u5b50\u91cc\uff0c\u6ca1\u6709\u7a7a\u7bb1\u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u7b54\u6848\u4f1a\u53d8\u6210\uff1a\n$$\\sum_{i=1}^k f(k,i)2^{n-i}$$\n\n\u8fd9\u6837\u4e00\u4e2a$f(i,j)$\u8ba9\u6211\u4eec\u60f3\u8d77\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u3002\u5f53\u7136\uff0c\u9009\u62e9\u54ea$j$\u4e2a\u7bb1\u5b50\u8fd8\u6709\u5f85\u786e\u5b9a\uff0c\u6240\u4ee5\u7b54\u6848\u5c31\u662f\uff1a\n$$\\sum_{i=1}^k S(k,i)\\frac{n!}{(n-k)!} 2^{n-i}$$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define RI register int\nconst int mod=1000000007;\nint n,K,ans;\nint S[5005][5005];\nint ksm(int x,int y) {\n\tint re=1;\n\tfor(;y;y>>=1,x=1LL*x*x%mod) if(y&1) re=1LL*re*x%mod;\n\treturn re;\n}\nvoid prework() {\n\tS[0][0]=1;\n\tfor(RI i=1;i<=K;++i)\n\t\tfor(RI j=1;j<=i;++j)\n\t\t\tS[i][j]=(S[i-1][j-1]+1LL*j*S[i-1][j]%mod)%mod;\n}\nint main()\n{\n\tscanf(\"%d%d\",&n,&K),prework();\n\tfor(RI i=1;i<=n&&i<=K;++i) {\n\t\tint kl=1LL*S[K][i]*ksm(2,n-i)%mod;\n\t\tfor(RI j=n-i+1;j<=n;++j) kl=1LL*kl*j%mod;\n\t\tans=(ans+kl)%mod;\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1529366905,
        "uid": 20604,
        "name": "litble",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF932E \u3010Team Work\u3011"
    },
    {
        "content": "\u770b\u5230\u67d0 lmpp \u5728\u7fa4\u91cc\u8bf4\u4e86\u8fd9\u9053\u9898\uff0c\u7acb\u523b\u8dd1\u8fc7\u6765\u770b\u4e00\u773c\u3002  \r\n\u8fd9\u4e0d\u5c31 Binomial Sum \u5417\uff1f\r\n\r\n\u8003\u5bdf\r\n$$\r\n\\begin{aligned}\r\n\\sum\\limits_{i=0}^n \\binom ni i^k\r\n&= \\left[\\frac{z^k}{k!}\\right] \\sum\\limits_{i=0}^n \\binom ni \\mathrm e^{iz} \\\\\r\n&= \\left[\\frac{z^k}{k!}\\right] (1 + \\mathrm e^z)^n\r\n\\end{aligned}\r\n$$\r\n\r\n\u6ce8\u610f\r\n$$\r\n\\left[\\frac{z^k}{k!}\\right] \\mathrm e^{iz} = i^k\r\n$$\r\n\r\n\u5219\u4ee4 $F(z) = (1+z)^n$\uff0c\u5176\u6ee1\u8db3 ODE\r\n$$\r\n(1+z)F'(z)-nF(z) = 0\r\n$$\r\n\r\n\u4ee4 $\\mathscr F(z+1) = F(z+1) \\bmod z^{k+1}$\uff0c\u6ce8\u610f\r\n$$\r\n(2+z)F'(z+1) - nF(z+1) = 0\r\n$$\r\n\r\n\u624b\u7b97\u4e00\u4e0b\u53ef\u77e5\r\n$$\r\n(2+z)\\mathscr F'(z+1) - n\\mathscr F(z+1) = (k-n)\\binom nk z^k 2^{n-k}\r\n$$\r\n\r\n\u63d0\u53d6\u7cfb\u6570\uff0c\u53ef\u4ee5\u9012\u63a8\u3002\r\n\r\n\u901a\u8fc7 [EI \u79d1\u6280](https://www.luogu.com.cn/blog/EntropyIncreaser/zai-tan-binomial-sum-duo-xiang-shi-fu-ge-cha-zhi-yu-tai-lei-zhan-kai) \u53ef\u77e5 $\\left[\\frac{z^k}{k!}\\right] F(\\mathrm e^z) = \\left[\\frac{z^k}{k!}\\right] \\mathscr F(\\mathrm e^z)$\uff0c\u800c\r\n$$\r\n\\begin{aligned}\r\n\\left[\\frac{z^k}{k!}\\right] \\mathscr F(\\mathrm e^z)\r\n&= \\left[\\frac{z^k}{k!}\\right] \\sum\\limits_{i=0}^k \\mathrm e^{iz} [z^i]\\mathscr F(z) \\\\\r\n&= \\sum\\limits_{i=0}^k i^k [z^i]\\mathscr F(z)\r\n\\end{aligned}\r\n$$\r\n\r\n\u901a\u8fc7\u7ebf\u6027\u7b5b\u8ba1\u7b97 $k$ \u6b21\u5e42\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(k)$\u3002",
        "postTime": 1625841521,
        "uid": 75840,
        "name": "deserter",
        "ccfLevel": 0,
        "title": "CF932E"
    },
    {
        "content": "\u522b\u7684\u9898\u89e3\u592a\u5f3a\u4e86\uff0c\u6211\u90fd\u4e0d\u4f1a\u3002\u3002\u3002\n\n\u5176\u5b9e\uff0c\u4f1a\u505a CF1278F \u5c31\u4f1a\u505a\u8fd9\u9053\u9898\u4e86\u3002\u5982\u679c\u628a $m$ \u8bbe\u6210 $2$\uff0c\u90a3\u4e48\u5c31\u53d8\u6210\u6bcf\u4e00\u4e2a\u4eba\u53ef\u4ee5\u9009\uff08Joker\uff09\u6216\u8005\u53ef\u4ee5\u4e0d\u9009\uff08\u53e6\u5916\u4e00\u4e2a\u724c\uff09\u3002\u5e94\u4e3a\u671f\u671b=\u6240\u6709\u53ef\u80fd\u7ed3\u679c\u6743\u503c\u4e4b\u548c\u9664\u4ee5\u7ed3\u679c\u4e2a\u6570\uff0c\u628a\u671f\u671b\u4e58 $2^n$ \u5f97\u5230\u7b54\u6848\u3002\n\n\u56e0\u6b64\uff0cCF1278F \u548c\u8fd9\u9053\u9898\u7684\u552f\u4e00\u533a\u522b\u662f $m=2$ \u5e76\u4e14\u8981\u628a\u7b54\u6848\u4e58\u4ee5\u4e00\u4e2a $2^n$ \u6765\u628a\u671f\u671b\u8f6c\u6362\u6210\u603b\u5171\u7684\u548c\u3002\n\n[\u6765\u770b CF1278F \u7684\u9898\u89e3](https://www.luogu.com.cn/blog/220037/solution-cf1278f)\n\n\u4e3b\u8981\u4ee3\u7801\uff1a\n\n```cpp\nconst int MOD = 1000000007;\n\nint dp[5005][5005];\n\nint qpow(const int&b, const int&e) {\n\tif(!e) return 1;\n\tif(!(e&1)) return qpow(1ll*b*b%MOD,e>>1);\n\treturn 1ll*b*qpow(b,e-1)%MOD;\n}\n\nsigned main() {\n    ios_base::sync_with_stdio(false); cin.tie(0);\n    int n, m, k; gi(n), m = 2, gi(k);\n\tdp[0][0] = 1;\n\trep(len, k+1)\n\t\trep(distinct, min(k,n)+1) {\n\t\t\tdp[len+1][distinct+1] = (1ll*(n-distinct)*dp[len][distinct]+dp[len+1][distinct+1])%MOD;\n\t\t\tdp[len+1][distinct] = (1ll*distinct*dp[len][distinct]+dp[len+1][distinct])%MOD;\n\t\t}\n\tm = qpow(m, MOD-2);\n\tint ans = 0, cm = qpow(2, n);\n\trep(distinct, min(k,n)+1) {\n\t\tans = (ans+1ll*cm*dp[k][distinct])%MOD;\n\t\tcm = 1ll*cm*m%MOD;\n\t}\n\tcout << ans << endl;\n}\n\n```",
        "postTime": 1585365816,
        "uid": 220037,
        "name": "w33z8kqrqk8zzzx33",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF932E"
    },
    {
        "content": "\u535a\u5ba2\u56ed\u94fe\u63a5\uff1a[my blog](https://www.cnblogs.com/AThousandMoons/p/10553952.html)\n\n\u8fd9\u9053\u9898\u5c31\u662f\u5b8c\u5168\u7684\u6a21\u677f\u4e86\n\n$$ans=\\sum_{i=1}^nC_n^i\\sum_{d=0}^kd!S(k,d)C_i^d$$\n\n$$=\\sum_{d=0}^kd!S(k,d)\\sum_{i=1}^nC_n^iC_i^d$$\n\n$$=\\sum_{d=0}^kd!S(k,d)C_n^d\\sum_{i=d}^nC_{n-d}^{i-d}$$\n\n$$=\\sum_{d=0}^kd!S(k,d)C_n^d2^{n-d}$$\n\n\u81f3\u4e8e\u90a3\u4e2a\u7b49\u5f0f\n\n$$C_n^iC_i^d=C_n^dC_{n-d}^{i-d}$$\n\n\u53ea\u8981\u6839\u636e\u7ec4\u5408\u6570\u7684\u5b9a\u4e49\u62c6\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\u3002\n\n```cpp\n#include<cstdio>\n#define Rint register int\nusing namespace std;\ntypedef long long LL;\nconst int N = 5003, mod = 1e9 + 7;\nint n, k, S[N][N], ans;\ninline int kasumi(int a, int b){\n\tint res = 1;\n\twhile(b){\n\t\tif(b & 1) res = (LL) res * a % mod;\n\t\ta = (LL) a * a % mod;\n\t\tb >>= 1;\n\t}\n\treturn res;\n}\nint main(){\n\tscanf(\"%d%d\", &n, &k);\n\tS[0][0] = 1;\n\tfor(Rint i = 1;i <= k;i ++)\n\t\tfor(Rint j = 1;j <= i;j ++)\n\t\t\tS[i][j] = ((LL) S[i - 1][j] * j + S[i - 1][j - 1]) % mod;\n\tint fac = 1, cho = 1;\n\tfor(Rint i = 1;i <= k && i <= n;i ++){\n\t\tcho = (LL) cho * (n - i + 1) % mod * kasumi(i, mod - 2) % mod;\n\t\tfac = (LL) fac * i % mod;\n\t\tans = (ans + (LL) fac * cho % mod * kasumi(2, n - i) % mod * S[k][i] % mod) % mod;\n\t}\n\tprintf(\"%d\", ans);\n}\n```",
        "postTime": 1552904773,
        "uid": 68148,
        "name": "watermoon",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF932E \u3010Team Work\u3011"
    },
    {
        "content": "\u65af\u7279\u6797\u6570\u597d\u9898\uff1a\n\n\u6c42$\\sum_{i=1}^{n}C_{n}^{i}i^{k}$\n\n\u9996\u5148\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u6709\u4e00\u4e2a\u6027\u8d28\uff1a\n\n$x^{n}=\\sum_{i=0}^{n}S_{2}(n,k)C_{x}^{k}k!$\n\n\u90a3\u4e48\u6211\u4eec\u5c55\u5f00\u539f\u6765\u7684\u8868\u8fbe\u5f0f\uff0c\u5f97\u5230\uff1a\n\n$\\sum_{i=1}^{n}C_{n}^{i}i^{k}$=$\\sum_{i=0}^{n}C_{n}^{i}i^{k}$=$\\sum_{i=0}^{n}C_{n}^{i}\\sum_{j=0}^{k}S_{2}(k,j)C_{i}^{j}j!$\n\n\u6574\u7406\u4e00\u4e0b\u540e\u9762\u7684\u5f0f\u5b50\uff0c\u987a\u4fbf\u5c55\u5f00\u7ec4\u5408\u6570\uff0c\u5f97\u5230\uff1a\n\n$\\sum_{i=0}^{n}\\frac{n!}{i!(n-i)!}\\sum_{j=0}^{k}S_{2}(k,j)\\frac{i!}{j!(i-j)!}j!$\n\n\u7acb\u523b\u80fd\u7ee7\u7eed\u6574\u7406\uff1a\n\n$\\sum_{i=0}^{n}\\frac{n!}{(n-i)!}\\sum_{j=0}^{k}S_{2}(k,j)\\frac{1}{(i-j)!}$\n\n\u8c03\u6574\u4e00\u4e0b\u679a\u4e3e\u987a\u5e8f\uff1a\n\n$\\sum_{j=0}^{k}S_{2}(k,j)\\sum_{i=0}^{n}\\frac{n!}{(n-i)!(i-j)!}$\n\n\u518d\u8865\u4e00\u9879\uff1a\n\n$\\sum_{j=0}^{k}S_{2}(k,j)\\sum_{i=0}^{n}\\frac{n!}{(n-i)!(i-j)!}\\frac{(n-j)!}{(n-j)!}$\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u6574\u7406\u51fa\u4e00\u4e2a\u7ec4\u5408\u6570\uff1a\n\n$\\sum_{j=0}^{k}S_{2}(k,j)\\sum_{i=0}^{n}\\frac{n!}{(n-j)!}\\frac{(n-j)!}{(n-i)!(i-j)!}$\n\n\u4e5f\u5c31\u662f\uff1a\n\n$\\sum_{j=0}^{k}S_{2}(k,j)\\sum_{i=0}^{n}\\frac{n!}{(n-j)!}C_{n-j}^{n-i}$\n\n\u518d\u63d0\u4e00\u9879\u51fa\u6765\uff1a\n\n$\\sum_{j=0}^{k}S_{2}(k,j)\\frac{n!}{(n-j)!}\\sum_{i=0}^{n}C_{n-j}^{n-i}$\n\n\u540e\u9762\u90a3\u4e2a\u6c42\u548c\u5f0f\u53d1\u73b0\u662f\u5bf9\u6768\u8f89\u4e09\u89d2\u7684\u67d0\u4e00\u884c\u6c42\u548c\uff0c\u6839\u636e\u7ed3\u8bba\uff0c\u6709\uff1a\n\n$\\sum_{j=0}^{k}S_{2}(k,j)\\frac{n!}{(n-j)!}2^{n-j}$\n\n\u8fd9\u5c31\u53ef\u4ee5\u7b97\u4e86\n\n\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u9012\u63a8\u5f0f\uff1a$S_{2}(i,j)=S_{2}(i-1,j-1)+jS_{2}(i-1,j)$\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <cstdio>\n#include <cmath>\n#include <cstring>\n#include <cstdlib>\n#include <iostream>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#define ll long long\nusing namespace std;\nconst ll mode=1000000007;\nll S[5005][5005];\nint n,k;\nll pow_mul(ll x,ll y)\n{\n    ll ret=1;\n    while(y)\n    {\n        if(y&1)ret=ret*x%mode;\n        x=x*x%mode,y>>=1;\n    }\n    return ret;\n}\nint main()\n{\n    scanf(\"%d%d\",&n,&k);\n    S[0][0]=1;\n    for(int i=1;i<=k;i++)for(int j=1;j<=i;j++)S[i][j]=(j*S[i-1][j]+S[i-1][j-1])%mode;\n    ll las=1,mul=pow_mul(2,n),inv=(mode+1)>>1;\n    ll ans=0;\n    for(int i=0;i<=k;i++)\n    {\n        ans=(ans+S[k][i]*las%mode*mul%mode)%mode;\n        las=las*(n-i)%mode;\n        mul=mul*inv%mode;\n    }\n    printf(\"%lld\\n\",ans);\n    return 0;\n} \n \n```\n",
        "postTime": 1561291593,
        "uid": 66905,
        "name": "leozhang",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF932E \u3010Team Work\u3011"
    },
    {
        "content": "\u5728\u6211\u7684\u535a\u5ba2\u56ed\u770b\u6548\u679c\u66f4\u4f73\uff1a[\u70b9\u8fd9\u91cc](https://www.cnblogs.com/1000Suns/p/10544194.html)\n\n**upd\uff1a\u611f\u8c22@sermoon\u6307\u51fa\u7b26\u53f7\u51fa\u9519\u4e86\u2026\u2026\u5df2\u4fee\u6539\u3002**\n\n\u5f88\u6c34\u7684\u4e00\u9053\u9898\u3002\n\n\u6839\u636e\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u7684\u6027\u8d28\uff1a\n\n$$n^k=\\sum^k_{i=1}\\begin{Bmatrix}k\\\\i\\end{Bmatrix}i!\\dbinom{n}{i}$$\n\n\u90a3\u4e48\u76f4\u63a5\u5957\u8fdb\u53bb\uff1a\n\n$$\\sum\\limits^n_{i=1}\\dbinom{n}{i}\\sum^k_{j=1}\\begin{Bmatrix}k\\\\j\\end{Bmatrix}j!\\dbinom{i}{j}$$\n\n$$\\sum^k_{j=1}\\begin{Bmatrix}k\\\\j\\end{Bmatrix}j!\\sum\\limits^n_{i=j}\\dbinom{n}{i}\\dbinom{i}{j}$$\n\n$$\\sum^k_{j=1}\\begin{Bmatrix}k\\\\j\\end{Bmatrix}j!\\sum\\limits^n_{i=j}\\dfrac{n!}{i!(n-i)!}\\dfrac{i!}{j!(i-j)!}$$\n\n$$\\sum^k_{j=1}\\begin{Bmatrix}k\\\\j\\end{Bmatrix}j!\\sum\\limits^n_{i=j}\\dfrac{n!}{(n-i)!}\\dfrac{1}{j!(i-j)!}$$\n\n$$\\sum^k_{j=1}\\begin{Bmatrix}k\\\\j\\end{Bmatrix}j!\\sum\\limits^n_{i=j}\\dfrac{n!}{j!(n-j)!}\\dfrac{(n-j)!}{(n-i)!(i-j)!}$$\n\n$$\\sum^k_{j=1}\\begin{Bmatrix}k\\\\j\\end{Bmatrix}j!\\sum\\limits^n_{i=j}\\dbinom{n}{j}\\dbinom{n-j}{i-j}$$\n\n$$\\sum^k_{j=1}\\begin{Bmatrix}k\\\\j\\end{Bmatrix}j!\\dbinom{n}{j}\\sum\\limits^n_{i=j}\\dbinom{n-j}{i-j}$$\n\n$$\\sum^k_{j=1}\\begin{Bmatrix}k\\\\j\\end{Bmatrix}j!\\dbinom{n}{j}\\sum\\limits^{n-j}_{i=0}\\dbinom{n-j}{i}$$\n\n$$\\sum^k_{j=1}\\begin{Bmatrix}k\\\\j\\end{Bmatrix}j!\\dbinom{n}{j}2^{n-j}$$\n\n\u5982\u679c\u6211\u4eec\u77e5\u9053\u4e86\u6240\u6709\u7684 $\\begin{Bmatrix}k\\\\j\\end{Bmatrix}$ \u90a3\u4e48\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u505a\u5230 $O(k\\log n)$\u3002\n\n\u7531\u4e8e\u672c\u9898 $k^2$ \u5df2\u7ecf\u8db3\u591f\uff0c\u800c\u4e14\u6a21\u6570\u4e0d\u53cb\u597d\uff0c\u76f4\u63a5\u9012\u63a8\u5c31\u597d\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(k^2+k\\log n)$\u3002\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int mod=1000000007;\n#define FOR(i,a,b) for(int i=(a);i<=(b);i++)\n#define ROF(i,a,b) for(int i=(a);i>=(b);i--)\n#define MEM(x,v) memset(x,v,sizeof(x))\ninline int read(){\n    int x=0,f=0;char ch=getchar();\n    while(ch<'0' || ch>'9') f|=ch=='-',ch=getchar();\n    while(ch>='0' && ch<='9') x=x*10+ch-'0',ch=getchar();\n    return f?-x:x;\n}\nint n,k,S[5050][5050];\ninline int qpow(int a,int b){\n    int ans=1;\n    for(;b;b>>=1,a=1ll*a*a%mod) if(b&1) ans=1ll*ans*a%mod;\n    return ans; \n}\nint main(){\n    n=read();k=read();\n    S[0][0]=1;\n    FOR(i,1,k) FOR(j,1,i) S[i][j]=(S[i-1][j-1]+1ll*S[i-1][j]*j)%mod;\n    int c=1,f=1,ans=0;\n    FOR(i,1,min(n,k)){\n        c=1ll*c*(n-i+1)%mod*qpow(i,mod-2)%mod;\n        f=1ll*f*i%mod;\n        ans=(ans+1ll*c*S[k][i]%mod*f%mod*qpow(2,n-i))%mod;\n    }\n    printf(\"%d\\n\",ans);\n}\n```",
        "postTime": 1552904311,
        "uid": 72118,
        "name": "AThousandSuns",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF932E \u3010Team Work\u3011"
    },
    {
        "content": "* [\u849f\u84bb\u535a\u5ba2][1]\n* [CodeForces][2]\n\n---\n# Solution\n~~\u8fd9\u9898\u5199\u5f97\u6211\u8111\u58f3\u75bc\uff0c\u6211\u597d\u83dc\u554a~~\n\n.\n\n\u663e\u7136\uff0c\u8fd9\u9898\u8ba9\u6211\u4eec\u6c42$\\sum_{i=1}^{n}C_n^i\\times i^k$\n\n\u8fd9\u4e2a$i^k$\u8ba9\u4eba\u6d51\u8eab\u96be\u53d7\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u628a\u5b83\u641e\u6389\uff0c\u80fd\u641e\u6389\u67d0\u4e2a\u6570\u7684\u5e42\u6b21\u65b9\u7684\u6709\u5565\uff1f\u672c\u849f\u84bb\u53ea\u4f1a\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u3002\n\n.\n\n\u6240\u4ee5\u8bf4\u6211\u4eec\u65e0\u8111\u628a\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u5e26\u8fdb\u53bb\u518d\u8bf4\uff1a\n\n$\\sum_{i=1}^{n}C_n^i\\times \\sum_{j=0}^{i}S(k,j)*j!*C_i^j$\n\n.\n\n\u7136\u540e\u628a\u7ec4\u5408\u6570\u5c55\u5f00\uff1a\n\n$\\sum_{i=1}^{n}\\frac{n!}{i!(n-i)!}\\times \\sum_{j=0}^{i}S(k,j)*j!*\\frac{i!}{j!(i-j)!}$\n\n.\n\n\u56e0\u4e3a\u524d\u9762\u90a3\u4e00\u9879\u4e0ej\u65e0\u5173\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u653e\u5230\u540e\u9762\u53bb\n\n$\\sum_{i=1}^{n} \\sum_{j=0}^{i} \\frac{n!}{i!(n-i)!} * S(k,j)*j!*\\frac{i!}{j!(i-j)!}$\n\n.\n\n\u7ea6\u5206\u5f97\uff1a\n\n$\\sum_{i=1}^{n} \\sum_{j=0}^{i} \\frac{n!}{(n-i)!} * S(k,j)*\\frac{1}{(i-j)!}$\n\n.\n\n\u56e0\u4e3a$k$\u5f88\u5c0f\uff0c$j$\u5f88\u5927\uff0c\u800c\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u7684\u5b9a\u4e49\u544a\u8bc9\u6211\u4eec\uff0c\u5f53$j>k$\u65f6\uff0c$S(k,j)=0$\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u628a$S(k,j)$\u653e\u5230\u5916\u9762\u6765\u5904\u7406\uff0c\u6839\u636e[\u4ea4\u6362\u548c\u53f7][3]\u7684\u539f\u5219\uff0c\u6211\u4eec\u53ef\u4ee5\u5904\u7406\u524d\u9762\u4e24\u4e2a$\\sum$\u6765\u65b9\u4fbf\u628a$S(k,j)$\u63d0\u5230\u5916\u9762\u6765\u3002\n\n\u4ea4\u6362\u548c\u53f7\u540e\u5f97\uff1a\n\n$\\sum_{j=0}^{n} \\sum_{i=j}^{n} \\frac{n!}{(n-i)!} * S(k,j)*\\frac{1}{(i-j)!}$\n\n.\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u628a$S(k,j)$\u63d0\u5230\u5916\u9762\u6765\u4e86\uff1a\n\n$\\sum_{j=0}^{n} S(k,j) \\times \\sum_{i=j}^{n} \\frac{n!}{(n-i)!}*\\frac{1}{(i-j)!}$\n\n.\n\n\u8003\u8651\u5230\u4e00\u70b9\uff0c\u5f53\u6211\u4eec\u7684$j>k$\u7684\u65f6\u5019\uff0c$S(k,j)=0$\uff0c\u56e0\u6b64\uff0c\u6211\u4eec\u524d\u9762$j$\u7684\u679a\u4e3e\u8303\u56f4\u53ef\u4ee5\u7f29\u5c0f\u4e3a$min(k,n)$\n\n$\\sum_{j=0}^{min(n,k)} S(k,j) \\times \\sum_{i=j}^{n} \\frac{n!}{(n-i)!}*\\frac{1}{(i-j)!}$\n\n.\n\n\u8fd9\u65f6\u5019\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff1a\u540e\u9762\u90a3\u4e2a\u5faa\u73af\u957f\u5f97\u975e\u5e38\u50cf\u7ec4\u5408\u6570\uff0c\u8003\u8651\u4e0a\u4e0b\u540c\u65f6\u4e58\u4ee5$(n-j)!$\u8ba9\u5b83\u53d8\u6210\u7ec4\u5408\u6570:\n\n$\\sum_{j=0}^{min(n,k)} S(k,j) \\times \\sum_{i=j}^{n} \\frac{n!}{(n-j)!}*\\frac{(n-j)!}{(n-i)!*(i-j)!}$\n\n$\\sum_{j=0}^{min(n,k)} S(k,j) \\times \\sum_{i=j}^{n} \\frac{n!}{(n-j)!}*C_{(n-j)}^{(n-i)}$\n\n.\n\n\u540c\u7406\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u540e\u9762\u90a3\u4e2a\u9636\u4e58\u63d0\u5230\u524d\u9762\u53bb\n\n$\\sum_{j=0}^{min(n,k)} S(k,j)*\\frac{n!}{(n-j)!} \\times \\sum_{i=j}^{n} C_{(n-j)}^{(n-i)}$\n\n.\n\n\u6211\u4eec\u8fd8\u53ef\u4ee5\u6ce8\u610f\u5230\uff0c\u540e\u9762\u90a3\u4e2a\u5faa\u73af\uff1a\u5f53$i<j$\u7684\u65f6\u5019\uff0c\u7b97\u51fa\u6765\u7684\u4e1c\u897f\u662f\u6ca1\u6709\u610f\u4e49\u7684\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u6539\u53d8\u5faa\u73af\u8303\u56f4\u4e3a$i=0$ \u6765\u65b9\u4fbf\u628a\u90a3\u4e2a\u96be\u4ee5\u8ba1\u7b97\u7684$\\sum$\u53d8\u4e3a\u65b9\u4fbf\u8ba1\u7b97\u7684$2^x$\u7684\u5f62\u5f0f\n\n$\\sum_{j=0}^{min(n,k)} S(k,j)*\\frac{n!}{(n-j)!} \\times \\sum_{i=0}^{n} C_{(n-j)}^{(n-i)}$\n\n.\n\n$\\sum_{j=0}^{min(n,k)} S(k,j)*\\frac{n!}{(n-j)!} \\times 2^{(n-j)}$\n\n.\n\n\u641e\u5b9a\uff0c\u5230\u76ee\u524d\u4e3a\u6b62\uff0c\u8fd9\u91cc\u91cc\u9762\u7684\u6240\u6709\u4e1c\u897f\u90fd\u53ef\u4ee5\u65b9\u4fbf\u7684\u6c42\u51fa\u6765\u4e86\uff1a\n\n$S(k,j)$\u53ef\u4ee5\u7528$k^2$\u7684\u9012\u63a8\u66b4\u529b\u6c42\u7b97~~\u795e\u7287\u4eec\u5927\u53ef\u7528FFT\u6216NTT\u5feb\u901f\u8ba1\u7b97\uff0c\u53ef\u60dc\u6211\u592a\u83dc\u4e86\u5e76\u4e0d\u4f1a~~\n\n$\\frac{n!}{(n-j)!}$\u53ef\u4ee5\u7528\u4e00\u4e2a$O(k)$\u7684\u66b4\u529b\u9012\u63a8\u7b97\u5373\u53ef\n\n$2^{(n-j)}$........\u5982\u679c\u4e0d\u4f1a\u7b97\u7684\u8bdd\u8bf7\u81ea\u884c\u53f3\u4e0a\u89d2\n\n.\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(n^2)$\n\n\u9171\u7d2b\uff0c\u8fd9\u9898\u5c31\u88ab\u6211\u4eecA\u6389\u5566~\n\n\u6492\u82b1\u30fe(\u25cf\u00b4\u2200\uff40\u25cf) \n\n.\n\n---\n# Code\n```cpp\n//CF932E Team Work\n//Jan,15th,2019\n//\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u7684\u5e94\u7528+\u5947\u5947\u602a\u602a\u7684\u63a8\u516c\u5f0f\n#include<iostream>\n#include<cstdio>\nusing namespace std;\nconst int poi=1000000007;\nlong long FastPow(long long A,long long B)\n{\n\tif(B==0) return 1;\n\tlong long t_ans=FastPow(A,B/2);\n\tt_ans=t_ans*t_ans%poi;\n\tif(B%2==1) t_ans=t_ans*A%poi;\n\treturn t_ans;\n}\nconst int N=5000+100;\nlong long S[N][N],jc[N];\nint n,K;\nint main()\n{\n\tscanf(\"%d%d\",&n,&K);\n\t\n\tS[1][1]=1;\n\tfor(int i=2;i<=K;i++)\n\t\tfor(int j=1;j<=i;j++)\n\t\t\tS[i][j]=(S[i-1][j-1]+j*S[i-1][j])%poi;\n\tjc[0]=1;\n\tfor(int i=1;i<=K;i++)\n\t\tjc[i]=jc[i-1]*(n-i+1)%poi;\n\t\n\tlong long ans=0;\n\tint t=min(n,K);\n\tfor(int i=0;i<=t;i++)\n\t\tans+=S[K][i]*jc[i]%poi*FastPow(2,n-i),ans%=poi;\n\t\t\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n\n```\n\n\n\n\n[1]:https://www.cnblogs.com/GoldenPotato/p/10275604.html\n[2]:http://codeforces.com/problemset/problem/932/E\n[3]:https://blog.csdn.net/github_35736728/article/details/80933891",
        "postTime": 1547605733,
        "uid": 52563,
        "name": "GoldenPotato137",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF932E \u3010Team Work\u3011"
    },
    {
        "content": "\u7ed9\u4e2a\u597d\u7406\u89e3\u4e00\u70b9\u7684\u8fc7\u7a0b\u3002\n\n\u9996\u5148\u4f60\u8981\u77e5\u9053$m^n=\\sum\\limits_{i=0}^mC_m^i\\cdot S(n,i)\\cdot i!$\u3002\u8fd9\u91cc\u7684$S(\\,)$\u662f\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u5927\u529b\u63a8\u5f0f\u5b50\uff1a\n\n$\\quad\\sum\\limits_{i=1}^nC_n^i\\cdot i^k$\n\n$=\\sum\\limits_{i=1}^nC_n^i\\sum\\limits_{j=0}^iC_i^j\\cdot S(k,j)\\cdot j!\\qquad\\text{\uff08\u6309\u4e0a\u9762\u7684\u5f0f\u5b50\u5c55\u5f00\uff09}$\n\n$=\\sum\\limits_{i=1}^n\\frac{n!}{i!(n-i)!}\\sum\\limits_{j=0}^i\\frac{i!}{j!(i-j)!}\\cdot S(k,j)\\cdot j!\\qquad\\text{\uff08\u62c6\u7ec4\u5408\u6570\uff09}$\n\n$=\\sum\\limits_{i=1}^n\\frac{n!}{(n-i)!}\\sum\\limits_{j=0}^i\\frac{S(k,j)}{(i-j)!}\\qquad\\text{\uff08\u7ea6\u5206\uff09}$\n\n$=\\sum\\limits_{j=0}^nS(k,j)\\sum\\limits_{i=j}^n\\frac{n!}{(n-i)!}\\cdot\\frac{1}{(i-j)!}\\qquad\\text{\uff08\u6362\u4e2a\u4f4d\u7f6e\uff09}$\n\n$=\\sum\\limits_{j=0}^{\\min(n,k)}S(k,j)\\sum\\limits_{i=j}^n\\frac{n!}{(n-i)!}\\cdot\\frac{1}{(i-j)!}\\qquad\\text{\uff08j>k\u65f6S(k,j)\u4e3a0\uff09}$\n\n$=\\sum\\limits_{j=0}^{\\min(n,k)}S(k,j)\\sum\\limits_{i=0}^n\\frac{n!}{(n-j)!}\\cdot\\frac{(n-j)!}{(n-i)!(i-j)!}\\qquad\\text{\uff08\u5206\u5f0f\u4e0a\u4e0b\u540c\u4e58(n-j)!\u518d\u79fb\u4e00\u4e0b\uff09}$\n\n$=\\sum\\limits_{j=0}^{k}S(k,j)\\frac{n!}{(n-j)!}\\sum\\limits_{i=0}^nC_{n-j}^{i-j}\\qquad\\text{\uff08\u79fb\u4e00\u4e0b+\u8fd8\u539f\u7ec4\u5408\u6570\uff09}$\n\n$=\\sum\\limits_{j=0}^{k}S(k,j)\\frac{n!}{(n-j)!}2^{n-j}\\qquad\\text{\uff08\u7ec4\u5408\u6570\u7684\u6027\u8d28\uff1f\uff09}$\n\n$O(k^2)$\u9884\u5904\u7406$S(\\,)$\u5c31\u884c\u4e86\u3002\n\n\u4ee3\u7801\u89c1[blog](http://m-sea-blog.com/archives/1564/)\u3002",
        "postTime": 1546819755,
        "uid": 38370,
        "name": "M_sea",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF932E \u3010Team Work\u3011"
    },
    {
        "content": "[\u5e7f\u544a](https://www.cnblogs.com/hbxblog/p/10198947.html)\n#### \u9898\u76ee\u94fe\u63a5\n[\u6233\u6211](https://www.luogu.org/problemnew/show/CF932E)\n#### \u9898\u610f\n\u6709$n$\u4e2a\u7bb1\u5b50\uff0c\u4ece\u4e2d\u9009\u51fa$i$\u4e2a\u7bb1\u5b50\uff0c\u7136\u540e\u628a$k$\u4e2a\u4e0d\u540c\u7684\u7403\u88c5\u5728\u8fd9$i$\u4e2a\u7bb1\u5b50\u4e2d\uff0c\u6c42\u65b9\u6848\u6570\u3002\n\n\u5b9e\u9645\u4e0a\u8fd9\u9898\u5c31\u662f\u6c42:\n$$ \\sum_{i=1}^nc_n^i*i^k$$\n\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u7ffb\u8bd1\u76f4\u63a5\u628a\u8fd9\u4e2a\u5199\u51fa\u6765\u4e86\uff0c\u83ab\u540d\u5176\u5999\u3002\n\n\u76f4\u63a5\u6c42\u8fd9\u4e2a\u5f0f\u5b50\u80af\u5b9a\u4e0d\u884c\uff0c$n$\u5f88\u5927\u4f1a\u8d85\u65f6\uff0c\u6240\u4ee5\u6211\u4eec\u5e94\u8be5\u5316\u7b80\u5f0f\u5b50\n$$\\sum_{i=1}^nc_n^i*i^k$$\n$$=\\sum_{i=0}^nc_n^i*i^k$$\n\u6839\u636e\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u7684\u6027\u8d28\uff1a\n$$n^k=\\sum_{i=0}^nS(k,i)*i!*C(n,i)$$\n\u6240\u4ee5\u5f0f\u5b50\u53ef\u4ee5\u7ee7\u7eed\u5316\u7b80\uff1a\n$$=\\sum_{i=0}^nc_n^i*\\sum_{j=0}^kS(k,j)*j!*C(i,j)$$\n$$=\\sum_{i=0}^nc_n^i*\\sum_{j=0}^kS(k,j)*j!*\\frac{i!}{j!*(i-j)!}$$\n$$=\\sum_{i=0}^nc_n^i*\\sum_{j=0}^kS(k,j)*\\frac{i!}{(i-j)!}$$\n$$=\\sum_{i=0}^n\\frac{n!}{i!(n-i)!}*\\sum_{j=0}^kS(k,j)*\\frac{i!}{(i-j)!}$$\n$$=\\sum_{i=0}^n\\sum_{j=0}^kS(k,j)*\\frac{i!}{(i-j)!}*\\frac{n!}{i!(n-i)!}$$\n$$=\\sum_{i=0}^n\\sum_{j=0}^kS(k,j)*\\frac{n!}{(i-j)!*(n-i)!}$$\n$$=\\sum_{i=0}^nS(k,j)\\sum_{j=0}^k\\frac{(n-j)!}{(i-j)!*(n-i)!}*\\frac{n!}{(n-j)!}$$\n$$=\\sum_{i=0}^nS(k,j)\\sum_{j=0}^kC(n-j,n-i)*\\frac{n!}{(n-j)!}$$\n$$=\\sum_{i=0}^nS(k,j)*\\frac{n!}{(n-j)!}\\sum_{j=0}^kC(n-j,n-i)$$\n$$=\\sum_{i=0}^nS(k,j)*\\frac{n!}{(n-j)!}*2^{n-j}$$\n\n\u6240\u4ee5\u8fd9\u5c31\u53ef\u4ee5\u76f4\u63a5\u505a\u4e86\n\n#### code\n\n```cpp\n#include<cstdio>\n#define rg register\n#define file(x) freopen(x\".in\",\"r\",stdin);freopen(x\".out\",\"w\",stdout);\nusing namespace std;\ntypedef long long ll;\nconst int mod=1e9+7;\ninline int read(){\n    int x=0,f=1;\n    char c=getchar();\n    while(c<'0'||c>'9') f=(c=='-')?-1:1,c=getchar();\n    while(c>='0'&&c<='9') x=x*10+c-48,c=getchar();\n    return f*x;\n}\nll s[5011][5011];\nint n,k;\ninline void init(){\n    s[0][0]=1;\n    for(rg int i=1;i<=k;i++)\n        for(rg int j=1;j<=i;j++)\n            s[i][j]=(s[i-1][j-1]+j*s[i-1][j])%mod;\n}\ninline ll ksm(int b){\n    ll ans=1,a=2;\n    while(b){\n        if(b&1)\n            ans=ans*a%mod;\n        a=a*a%mod;\n        b>>=1;\n    }\n    return ans%mod;\n}\nmain(){\n    n=read(),k=read();\n    init();\n    ll p=ksm(n),ans=0,js=1,inv=ksm(mod-2);\n    for(rg int i=0;i<=k;i++){\n        ans+=s[k][i]*p%mod*js,p*=inv,p%=mod;\n        ans%=mod;\n        js=js*(n-i)%mod;\n    }\n    printf(\"%lld\",ans);\n    return 0;\n}\n```",
        "postTime": 1546142098,
        "uid": 19805,
        "name": "\u64a4\u4e91",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF932E \u3010Team Work\u3011"
    }
]
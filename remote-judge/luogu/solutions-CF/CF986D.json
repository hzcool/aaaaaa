[
    {
        "content": "\u5148\u7ed9\u51fa\u4e00\u4e2a\u7ed3\u8bba\uff0c\u5c3d\u91cf\u9009\u62e9\u6700\u63a5\u8fd1 $e$ \u7684\u81ea\u7136\u6570\uff0c\u7136\u540e\u5728\u5269\u4e0b\u7684\u51b3\u5b9a\u9009 $2,4$ \u4e4b\u7c7b\u7684\u3002\u72b6\u6001\u6570\u53ef\u4ee5\u641e\u5230 $O(1)$\u3002\n\n\u5177\u4f53\u662f\u8003\u8651 $f(x) = x^{\\frac{n}{x}}$ \u7684\u6781\u503c\u70b9\uff0c\u901a\u8fc7\u51fd\u6570\u753b\u56fe\u53d1\u73b0\u6781\u503c\u70b9\u5728 $(e,e^{\\frac{n}{e}})$\u3002\n\n\u6ce8\u610f\u5230\u6c42 $f(x)=x^{\\frac{n}{x}}$ \u7684\u6781\u503c\u70b9\u7b49\u4ef7\u4e8e\u6c42 $g(x)  = x^{\\frac{1}{x}}$ \u7684\u6781\u503c\u70b9\u3002\u56e0\u4e3a $\\ln$ \u51fd\u6570\u5355\u8c03\u4e24\u8fb9\u53d6 $\\ln$ \u540e\u6781\u503c\u70b9\u4e0d\u53d8\u3002\n\n$\\ln(g(x)) = h(x) = \\dfrac{\\ln x}{x}$\uff0c\u7136\u540e\u518d\u5bf9 $h(x)$ \u6c42\u5bfc\u5f97\u5230 $h'(x) = \\dfrac{1-\\ln x}{x^2}$\uff0c\u53d1\u73b0 $h'(x)$ \u5728 $x=e$ \u65f6\u503c\u4e3a $0$\uff0c\u8fdb\u800c\u5f97\u5230 $f(x)$ \u5728 $x=e$ \u53d6\u5f97\u6781\u503c\u3002\n\n\u8fd9\u4e2a\u9898\u5e73\u8861\u4e00\u4e0b\u4e4b\u540e\u53d1\u73b0\u4e00\u5b9a\u4f1a\u9009 $3$\uff0c\u6709\u4e00\u4e9b\u5c0f case\uff0c\u6bd4\u5982\u9009 $2,4$ \u4e4b\u7c7b\u7684\u5224\u65ad\u4e00\u4e0b\u5c31\u597d\uff0c\u72b6\u6001\u6570\u662f $O(1)$ \u7684\u3002\n\n\u4e0b\u9762\u84af\u6389\u4e86\u96e8\u5154\u5154\u7684 Pascal \u4ee3\u7801\u3002\n\n```cpp\nuses gmp;\nvar\nch, c3: string;\nn, b, pw: MPInteger;\nln: Integer;\n\nbegin\n    readln(ch);\n    n:=ch;\n    if ch='1' then begin writeln(1); end\n    else begin\n        b:=3;\n        c3:=z_get_str(3,n);\n        ln:=length(c3);\n        pw:=z_pow_ui(b,ln-1);\n\n        if pw>=n then begin writeln((ln-1)*3); end\n        else if pw*4>=n*3 then begin writeln((ln-2)*3+4); end\n        else if pw*2>=n then begin writeln((ln-1)*3+2); end\n        else begin writeln(ln*3); end\n    end\nend.\n```",
        "postTime": 1655379753,
        "uid": 184977,
        "name": "pomelo_nene",
        "ccfLevel": 9,
        "title": "\u9b54\u6cd5\u554a\uff0c\u6709\u70b9\u795e\u5947"
    },
    {
        "content": "[\u9898\u9762\u4f20\u9001\u95e8](https://codeforces.ml/contest/986/problem/D)\n\n\u9898\u610f\uff1a\u7ed9\u51fa $n$\uff0c\u6784\u9020\u51fa\u5e8f\u5217 $b_1,b_2,\\dots,b_m$ \u4f7f\u5f97 $\\prod\\limits_{i=1}^mb_i\\geq n$\uff0c\u6c42 $\\sum\\limits_{i=1}^mb_i$ \u7684\u6700\u5c0f\u503c\u3002$\\lg n\\leq 1.5\\times 10^6$\n\n~~\u88ab hb \u53eb\u6765\u5199\u8fd9\u9898\u7684\u9898\u89e3~~\n\nu1s1 \u8fd9\u9898\u5b9e\u5728\u662f\u592a\u6050\u6016\u4e86\uff0c\u4ee5\u4e0b\u662f\u6211\u7684\u5168\u90e8\u975e AC \u63d0\u4ea4\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/j23wvvzv.png)\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/vkfj58qz.png)\n\n\u9996\u5148\u76f4\u63a5\u505a\u80af\u5b9a\u662f\u4e0d\u592a\u5bb9\u6613\u7684\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u7b54\u6848\u5177\u6709\u5355\u8c03\u6027\uff0c\u6545\u53ef\u4ee5\u4e8c\u5206\u7b54\u6848\uff0c\u672c\u9898\u8f6c\u5316\u4e3a\u4e00\u4e2a\u5224\u5b9a\u6027\u95ee\u9898\u3002\n\n\u6211\u4eec\u8981\u6c42\uff1a\u548c\u4e3a $k$ \u7684\u82e5\u5e72\u4e2a\u6570\u7684\u6700\u5927\u4e58\u79ef $f(k)$ \u662f\u591a\u5c11\u3002\n\n\u7a0d\u5fae\u624b\u73a9\u51e0\u4e2a\u6570\u5c31\u80fd\u53d1\u73b0\uff0c\u6700\u4f18\u65b9\u6848\u662f\u62c6\u51fa\u5148\u82e5\u5e72\u4e2a $3$\uff0c\u540e\u9762\u96f6\u5934\u90e8\u5206\u6839\u636e $k$ \u6a21 $3$ \u7684\u60c5\u51b5\u62c6 $0$ \u6216 $1$ \u6216 $2$ \u4e2a $2$\u3002\n\n\u5177\u4f53\u6765\u8bf4\uff1a\n\n- $f(k)=3^{k/3}(k\\equiv 0\\pmod{3})$\n- $f(k)=2\\times 3^{(k-2)/3}(k\\equiv 1\\pmod{3})$\n- $f(k)=4\\times 3^{(k-4)/3}(k\\equiv 2\\pmod{3})$\n\n\u6545\u6211\u4eec\u53ea\u9700\u8ba1\u7b97\u51fa $f(k)$ \u7684\u503c\uff0c\u4e0e $n$ \u76f8\u6bd4\u8f83\u5c31\u884c\u4e86\u3002\n\n\u6ce8\u610f\u5230\u672c\u9898 $\\lg n$ \u662f $10^6$ \u7ea7\u522b\u7684\uff0c\u6240\u4ee5\u9ad8\u7cbe\u4e58\u6cd5\u8981\u7528 FFT \u4f18\u5316\u3002\n\n\u7136\u540e\u5c31\u5230\u4e86\u6109\u5feb\u7684\u5361\u5e38\u65f6\u95f4\u4e86\uff0c\u8fd9\u9898\u5361\u5e38\u7684\u7ecf\u5386\u53ef\u8c13\u662f\u4e00\u6ce2\u4e09\u6298\u554a\uff1a\n\n\u9996\u5148\u5982\u679c\u4f60\u76f4\u63a5\u4e0a\u4e2a\u4e8c\u5206\uff0c\u90a3\u4e48\u4e8c\u5206\u4e2d FFT \u590d\u6742\u5ea6\u4e3a $n\\log n$\uff0c\u5916\u9762\u4e8c\u5206\u8fd8\u6709\u4e2a $\\log$\uff0c\u4f60\u5c31\u5f97\u5230\u4e86 $n\\log^2n$ \u7684\u4f18\u79c0\u590d\u6742\u5ea6\uff0c\u90a3\u80af\u5b9a\u662f\u5fc5 T \u65e0\u7591\u4e86\u3002\n\n\u8003\u8651\u4e00\u4e2a\u4f18\u5316\u65b9\u6848\uff1a\u6ce8\u610f\u5230\u7b54\u6848\u5728 $3\\times\\log_3n$ \u9644\u8fd1\uff0c\u6240\u4ee5\u4ece $3\\times\\log_3n$ \u5f00\u59cb\u66b4\u529b\u679a\u4e3e\u7b54\u6848\u3002\u6211\u8bd5\u4e86\u4e00\u4e0b\uff0c\u8fd9\u6837\u679a\u4e3e\u6b21\u6570\u5927\u7ea6\u5728 $6$ \u6b21\u9644\u8fd1\uff0c\u8fd9\u6837\u590d\u6742\u5ea6\u5c31\u964d\u4e86\u4e00\u4e2a $\\log$\u3002\n\n\u4f46\u4ec5\u4ec5\u505a\u8fd9\u4e00\u4e2a\u4f18\u5316\u662f\u8fdc\u8fdc\u4e0d\u591f\u7684\u3002\u6211\u6700\u4e00\u5f00\u59cb\u7801\u4e86\u4e2a\u5b9a\u957f\u7684 FFT\uff0c\u4e5f\u5c31\u662f\u6bcf\u6b21 FFT \u7684\u957f\u5ea6\u90fd\u662f $> \\lg n$ \u7684\u6700\u5c0f $2$ \u7684\u6574\u6570\u6b21\u5e42\uff0c\u4f46\u663e\u7136\u8fd9\u6837\u6ca1\u6709\u5fc5\u8981\u3002\u4e8b\u5b9e\u4e5f\u7684\u786e\u5982\u6b64\uff0c\u8fd9\u4e2a\u7a0b\u5e8f\u5728 #13 \u5c31 TLE \u4e86\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi first\n#define se second\n#define fz(i,a,b) for(int i=a;i<=b;i++)\n#define fd(i,a,b) for(int i=a;i>=b;i--)\n#define ffe(it,v) for(__typeof(v.begin()) it=v.begin();it!=v.end();it++)\n#define fill0(a) memset(a,0,sizeof(a))\n#define fill1(a) memset(a,-1,sizeof(a))\n#define fillbig(a) memset(a,63,sizeof(a))\n#define pb push_back\n#define ppb pop_back\n#define mp make_pair\ntemplate<typename T1,typename T2> void chkmin(T1 &x,T2 y){if(x>y) x=y;}\ntemplate<typename T1,typename T2> void chkmax(T1 &x,T2 y){if(x<y) x=y;}\ntypedef pair<int,int> pii;\ntypedef long long ll;\ntemplate<typename T> void read(T &x){\n\tx=0;char c=getchar();T neg=1;\n\twhile(!isdigit(c)){if(c=='-') neg=-1;c=getchar();}\n\twhile(isdigit(c)) x=x*10+c-'0',c=getchar();\n\tx*=neg;\n}\nconst int MAXN=1.5e6;\nconst int MAXP=1<<22;\nconst double LOG310=log(10)/log(3);\nconst double Pi=acos(-1);\nint n,LEN=1,LOG=0;\nstruct comp{\n\tdouble x,y;//(real,imag)\n\tcomp(){x=y=0;}\n\tcomp(double _x,double _y){x=_x;y=_y;}\n\tfriend comp operator +(comp lhs,comp rhs){return comp(lhs.x+rhs.x,lhs.y+rhs.y);}\n\tfriend comp operator -(comp lhs,comp rhs){return comp(lhs.x-rhs.x,lhs.y-rhs.y);}\n\tfriend comp operator *(comp lhs,comp rhs){return comp(lhs.x*rhs.x-lhs.y*rhs.y,lhs.x*rhs.y+lhs.y*rhs.x);}\n} A[MAXP+5],B[MAXP+5];\nchar s[MAXN+5];int x[MAXP+5];\nint rev[MAXP+5];\nvoid FFT(comp *a,int len,int type){\n\tint lg=log2(len);\n\tfor(int i=0;i<len;i++) rev[i]=(rev[i>>1]>>1)|((i&1)<<(lg-1));\n\tfor(int i=0;i<len;i++) if(i<rev[i]) swap(a[i],a[rev[i]]);\n\tfor(int i=2;i<=len;i<<=1){\n\t\tcomp W=comp(cos(2*Pi/i),type*sin(2*Pi/i));\n\t\tfor(int j=0;j<len;j+=i){\n\t\t\tcomp w=comp(1,0);\n\t\t\tfor(int k=0;k<(i>>1);k++,w=w*W){\n\t\t\t\tcomp X=a[j+k],Y=a[(i>>1)+j+k]*w;\n\t\t\t\ta[j+k]=X+Y;a[(i>>1)+j+k]=X-Y;\n\t\t\t}\n\t\t}\n\t}\n\tif(type==-1) for(int i=0;i<len;i++) a[i].x=(int)(a[i].x/len+0.5);\n}\nvoid polymul(int *a,int *b,int *c){\n\tfor(int i=0;i<LEN;i++) A[i]=comp(a[i],0),B[i]=comp(b[i],0);\n\tFFT(A,LEN,1);FFT(B,LEN,1);for(int i=0;i<LEN;i++) A[i]=A[i]*B[i];FFT(A,LEN,-1);\n\tfor(int i=0;i<LEN;i++) c[i]=0;\n\tfor(int i=0;i<LEN+10;i++){\n\t\tc[i]+=(int)A[i].x;\n\t\tif(c[i]>=10) c[i+1]+=c[i]/10,c[i]%=10;\n\t}\n}\nint a[MAXP+15],b[MAXP+15];\nvoid ksm3(int k){\n\tfor(int i=0;i<LEN;i++) a[i]=b[i]=0;\n\ta[0]=1;b[0]=3;\n\tfor(;k;k>>=1,polymul(b,b,b)) if(k&1) polymul(a,b,a);\n//\tfor(int i=LEN;~i;i--) printf(\"%d\",a[i]);printf(\"\\n\");\n}\nvoid mul2(int *a){\n\tfor(int i=0;i<LEN;i++) a[i]<<=1;\n\tfor(int i=0;i<LEN;i++) if(a[i]>=10) a[i]-=10,a[i+1]++;\n}\nbool check(int mid){\n\tif(mid==0) return 0;\n\tif(mid==1){return (n==1&&s[1]=='1');}\n\tint m2=0;\n\tif(mid%3==1) m2=2,mid-=4;\n\tif(mid%3==2) m2=1,mid-=2;\n\tksm3(mid/3);for(int i=1;i<=m2;i++) mul2(a);\n//\tfor(int i=LEN;~i;i--) printf(\"%d\",a[i]);printf(\"\\n\");\n\tfor(int i=LEN;~i;i--){\n\t\tif(a[i]<x[i]) return 0;\n\t\tif(a[i]>x[i]) return 1;\n\t} return 1;\n}\nint main(){\n\tscanf(\"%s\",s+1);n=strlen(s+1);\n\tfor(int i=0;i<n;i++) x[i]=s[n-i]^48;\n\tint mn=(int)(3.0*LOG310*(n-1));\n\twhile(LEN<=n+n) LEN<<=1,LOG++;\n//\tprintf(\"%d\\n\",mn);\n\tfor(int i=mn;;i++) if(check(i)){printf(\"%d\\n\",i);return 0;}\n\treturn 0;\n}\n```\n\n\u4e8e\u662f\u6211\u6539\u7528 vector \u5b58\u50a8\u5927\u6570\uff0c\u5728\u6c42\u4e24\u4e2a\u5927\u6570 $a,b$ \u7684\u4e58\u79ef\u7684\u65f6\u5019\uff0cFFT \u7684\u957f\u5ea6\u53d6 $>\\lg a+\\lg b$ \u7684\u6700\u5c0f $2$ \u7684\u6574\u6570\u6b21\u5e42\uff0c\u8fd9\u6837\u53ef\u4ee5\u7701\u53bb\u4e0d\u5c11\u65e0\u7528\u7684\u64cd\u4f5c\u3002\n\n\u7ecf\u8fc7\u8fd9\u4e2a\u5c0f\u5c0f\u7684\u6539\u52a8\uff0c#13 \u5012\u662f\u8dd1\u8fc7\u53bb\u4e86\uff0c\u4f46 #15 \u53c8 T \u4e86\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi first\n#define se second\n#define fz(i,a,b) for(int i=a;i<=b;i++)\n#define fd(i,a,b) for(int i=a;i>=b;i--)\n#define ffe(it,v) for(__typeof(v.begin()) it=v.begin();it!=v.end();it++)\n#define fill0(a) memset(a,0,sizeof(a))\n#define fill1(a) memset(a,-1,sizeof(a))\n#define fillbig(a) memset(a,63,sizeof(a))\n#define pb push_back\n#define ppb pop_back\n#define mp make_pair\ntemplate<typename T1,typename T2> void chkmin(T1 &x,T2 y){if(x>y) x=y;}\ntemplate<typename T1,typename T2> void chkmax(T1 &x,T2 y){if(x<y) x=y;}\ntypedef pair<int,int> pii;\ntypedef long long ll;\ntemplate<typename T> void read(T &x){\n\tx=0;char c=getchar();T neg=1;\n\twhile(!isdigit(c)){if(c=='-') neg=-1;c=getchar();}\n\twhile(isdigit(c)) x=x*10+c-'0',c=getchar();\n\tx*=neg;\n}\nconst int MAXN=1.5e6;\nconst int MAXP=1<<22;\nconst double LOG310=log(10)/log(3);\nconst double Pi=acos(-1);\nint n,LEN=1,LOG=0;\nstruct comp{\n\tdouble x,y;//(real,imag)\n\tcomp(){x=y=0;}\n\tcomp(double _x,double _y){x=_x;y=_y;}\n\tfriend comp operator +(comp lhs,comp rhs){return comp(lhs.x+rhs.x,lhs.y+rhs.y);}\n\tfriend comp operator -(comp lhs,comp rhs){return comp(lhs.x-rhs.x,lhs.y-rhs.y);}\n\tfriend comp operator *(comp lhs,comp rhs){return comp(lhs.x*rhs.x-lhs.y*rhs.y,lhs.x*rhs.y+lhs.y*rhs.x);}\n} A[MAXP+5],B[MAXP+5];\nchar s[MAXN+5];vector<int> x;\nint rev[MAXP+5];\nvoid FFT(comp *a,int len,int type){\n\tint lg=log2(len);\n\tfor(int i=0;i<len;i++) rev[i]=(rev[i>>1]>>1)|((i&1)<<(lg-1));\n\tfor(int i=0;i<len;i++) if(i<rev[i]) swap(a[i],a[rev[i]]);\n\tfor(int i=2;i<=len;i<<=1){\n\t\tcomp W=comp(cos(2*Pi/i),type*sin(2*Pi/i));\n\t\tfor(int j=0;j<len;j+=i){\n\t\t\tcomp w=comp(1,0);\n\t\t\tfor(int k=0;k<(i>>1);k++,w=w*W){\n\t\t\t\tcomp X=a[j+k],Y=a[(i>>1)+j+k]*w;\n\t\t\t\ta[j+k]=X+Y;a[(i>>1)+j+k]=X-Y;\n\t\t\t}\n\t\t}\n\t}\n\tif(type==-1) for(int i=0;i<len;i++) a[i].x=(int)(a[i].x/len+0.5);\n}\nvector<int> polymul(vector<int> a,vector<int> b){\n\tint len=1;\n\twhile(len<=a.size()+b.size()) len<<=1;\n\tfor(int i=0;i<len;i++) A[i]=B[i]=comp(0,0);\n\tfor(int i=0;i<a.size();i++) A[i]=comp(a[i],0);\n\tfor(int i=0;i<b.size();i++) B[i]=comp(b[i],0);\n\tFFT(A,len,1);FFT(B,len,1);\n\tfor(int i=0;i<len;i++) A[i]=A[i]*B[i];\n\tFFT(A,len,-1);\n\tvector<int> c(a.size()+b.size(),0);\n\tfor(int i=0;i<c.size();i++){\n\t\tc[i]+=(int)A[i].x;\n\t\tif(c[i]>=10) c[i+1]+=c[i]/10,c[i]%=10;\n\t} if(c.back()==0) c.pop_back();\n\treturn c;\n}\nvector<int> ksm3(int k){\n\tvector<int> a,b;a.pb(1);b.pb(3);\n\tfor(;k;k>>=1,b=polymul(b,b)) if(k&1) a=polymul(a,b);\n//\tfor(int i=LEN;~i;i--) printf(\"%d\",a[i]);printf(\"\\n\");\n\treturn a;\n}\nvector<int> mul2(vector<int> a){\n\tfor(int i=0;i<a.size();i++) a[i]<<=1;\n\tfor(int i=0;i<(int)(a.size()-1);i++) if(a[i]>=10) a[i]-=10,a[i+1]++;\n\tif(a[a.size()-1]>=10) a[a.size()-1]-=10,a.pb(1);\n\treturn a;\n}\nbool check(int mid){\n\tif(mid==0) return 0;\n\tif(mid==1){return (n==1&&s[1]=='1');}\n\tint m2=0;\n\tif(mid%3==1) m2=2,mid-=4;\n\tif(mid%3==2) m2=1,mid-=2;\n\tvector<int> a=ksm3(mid/3);for(int i=1;i<=m2;i++) a=mul2(a);\n//\tfor(int i=(int)(a.size()-1);~i;i--) printf(\"%d\",a[i]);printf(\"\\n\");\n\tif(a.size()<x.size()) return 0;\n\tif(a.size()>x.size()) return 1;\n\tfor(int i=(int)(a.size()-1);~i;i--){\n\t\tif(a[i]<x[i]) return 0;\n\t\tif(a[i]>x[i]) return 1;\n\t} return 1;\n}\nint main(){\n\tscanf(\"%s\",s+1);n=strlen(s+1);\n\tfor(int i=n;i;i--) x.pb(s[i]^48);\n\tint mn=(int)(3.0*LOG310*(n-1));\n//\tprintf(\"%d\\n\",mn);\n\tfor(int i=mn;;i++) if(check(i)){printf(\"%d\\n\",i);return 0;}\n\treturn 0;\n}\n```\n\n\u7ee7\u7eed\u5361\uff0c\u5728\u5feb\u901f\u5e42\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u8981\u5bf9 $x$ \u8fdb\u884c\u81ea\u4e58\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5e76\u4e0d\u7528\u505a 2 \u6b21 DFT+1 \u6b21 IDFT\uff0c\u53ef\u4ee5 1 \u6b21 DFT+1 \u6b21 IDFT \u641e\u5b9a\uff08\u4e8b\u5b9e\u4e0a\uff0c\u666e\u901a\u7684\u591a\u9879\u5f0f\u4e58\u6cd5 1 \u6b21 DFT+1 \u6b21 IDFT \u4e5f\u53ef\u4ee5\u641e\u5b9a\uff0c\u4e0d\u8fc7\u6211\u8fd8\u4e0d\u4f1a\uff09\uff0c\u6709\u4e00\u5b9a\u6548\u679c\uff0c\u4e0d\u8fc7\u8fd8\u662f\u6ca1\u80fd\u6446\u8131 TLE \u7684\u547d\u8fd0\u3002\n\n\u5f88\u660e\u663e\uff0c\u6bcf\u6b21\u6c42 $f(k)$ \u7684\u8fc7\u7a0b\u4e2d\u6307\u6570\u4e0a\u90a3\u4e2a\u4e1c\u897f\u76f8\u5dee\u90fd\u4e0d\u592a\u5927\uff0c\u90fd\u5728 $\\log_3n$ \u5de6\u53f3\uff0c\u8fd9\u610f\u5473\u7740\u4f60\u5e76\u4e0d\u7528\u6bcf\u6b21\u6c42 $f(k)$ \u90fd\u8dd1\u4e00\u904d\u5feb\u901f\u5e42\uff0c\u53ef\u4ee5\u5728\u679a\u4e3e\u7b54\u6848\u524d\u5148\u9884\u5904\u7406 $p=3^{\\lfloor\\log_3n\\rfloor}$\uff0c\u6bcf\u6b21\u6c42 $f(k)$ \u90fd\u5728 $p$ \u7684\u57fa\u7840\u4e0a\u4e58\u51e0\u4e2a $3$ \u6216\u4e58\u51e0\u4e2a $2$\u3002\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5927\u6570\u4e58\u4e00\u4e2a\u4e00\u4f4d\u6570\u662f $\\mathcal O(n)$ \u7ea7\u522b\u7684\uff0c\u4e8e\u662f\u6bcf\u6b21\u6c42 $f(k)$ \u7684\u590d\u6742\u5ea6\u4e5f\u964d\u4e86\u4e0b\u6765\uff0c\u8fbe\u5230\u4e86 $\\mathcal O(\\lg n)$ \u3002\n\n\u8dd1\u5f97\u5feb\u4e86\u4ebf\u70b9\u70b9\uff0c#14 \u4ece\u539f\u6765 717ms \u964d\u5230\u4e86 140ms\u3002\u4e0d\u8fc7\u624b\u9020\u4e86\u7ec4 $1.5\\times 10^6$ \u7684\u6570\u636e\u672c\u5730\u8dd1\u4e86 4s\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi first\n#define se second\n#define fz(i,a,b) for(int i=a;i<=b;i++)\n#define fd(i,a,b) for(int i=a;i>=b;i--)\n#define ffe(it,v) for(__typeof(v.begin()) it=v.begin();it!=v.end();it++)\n#define fill0(a) memset(a,0,sizeof(a))\n#define fill1(a) memset(a,-1,sizeof(a))\n#define fillbig(a) memset(a,63,sizeof(a))\n#define pb push_back\n#define ppb pop_back\n#define mp make_pair\ntemplate<typename T1,typename T2> void chkmin(T1 &x,T2 y){if(x>y) x=y;}\ntemplate<typename T1,typename T2> void chkmax(T1 &x,T2 y){if(x<y) x=y;}\ntypedef pair<int,int> pii;\ntypedef long long ll;\ntemplate<typename T> void read(T &x){\n\tx=0;char c=getchar();T neg=1;\n\twhile(!isdigit(c)){if(c=='-') neg=-1;c=getchar();}\n\twhile(isdigit(c)) x=x*10+c-'0',c=getchar();\n\tx*=neg;\n}\nconst int MAXN=1.5e6;\nconst int MAXP=1<<22;\nconst double LOG310=log(10)/log(3);\nconst double Pi=acos(-1);\nint n,LEN=1,LOG=0;\nstruct comp{\n\tdouble x,y;//(real,imag)\n\tcomp(){x=y=0;}\n\tcomp(double _x,double _y){x=_x;y=_y;}\n\tfriend comp operator +(comp lhs,comp rhs){return comp(lhs.x+rhs.x,lhs.y+rhs.y);}\n\tfriend comp operator -(comp lhs,comp rhs){return comp(lhs.x-rhs.x,lhs.y-rhs.y);}\n\tfriend comp operator *(comp lhs,comp rhs){return comp(lhs.x*rhs.x-lhs.y*rhs.y,lhs.x*rhs.y+lhs.y*rhs.x);}\n} A[MAXP+5],B[MAXP+5];\nchar s[MAXN+5];vector<int> x;\nint rev[MAXP+5];\nvector<int> pp;int lv;\nvoid FFT(comp *a,int len,int type){\n\tint lg=log2(len);\n\tfor(int i=0;i<len;i++) rev[i]=(rev[i>>1]>>1)|((i&1)<<(lg-1));\n\tfor(int i=0;i<len;i++) if(i<rev[i]) swap(a[i],a[rev[i]]);\n\tfor(int i=2;i<=len;i<<=1){\n\t\tcomp W=comp(cos(2*Pi/i),type*sin(2*Pi/i));\n\t\tfor(int j=0;j<len;j+=i){\n\t\t\tcomp w=comp(1,0);\n\t\t\tfor(int k=0;k<(i>>1);k++,w=w*W){\n\t\t\t\tcomp X=a[j+k],Y=a[(i>>1)+j+k]*w;\n\t\t\t\ta[j+k]=X+Y;a[(i>>1)+j+k]=X-Y;\n\t\t\t}\n\t\t}\n\t}\n\tif(type==-1) for(int i=0;i<len;i++) a[i].x=(int)(a[i].x/len+0.5);\n}\nvector<int> polymul(vector<int> a,vector<int> b){\n\tint len=1;\n\twhile(len<=a.size()+b.size()) len<<=1;\n    if(len>MAXP) return a;\n\tfor(int i=0;i<len;i++) A[i]=B[i]=comp(0,0);\n\tfor(int i=0;i<a.size();i++) A[i]=comp(a[i],0);\n\tfor(int i=0;i<b.size();i++) B[i]=comp(b[i],0);\n\tFFT(A,len,1);FFT(B,len,1);\n\tfor(int i=0;i<len;i++) A[i]=A[i]*B[i];\n\tFFT(A,len,-1);\n\tvector<int> c(a.size()+b.size(),0);\n\tfor(int i=0;i<c.size();i++){\n\t\tc[i]+=(int)A[i].x;\n\t\tif(c[i]>=10) c[i+1]+=c[i]/10,c[i]%=10;\n\t} if(c.back()==0) c.pop_back();\n\treturn c;\n}\nvector<int> ksm3(int k){\n\tvector<int> a,b;a.pb(1);b.pb(3);\n\tfor(;k;k>>=1,b=polymul(b,b)) if(k&1) a=polymul(a,b);\n//\tfor(int i=LEN;~i;i--) printf(\"%d\",a[i]);printf(\"\\n\");\n\treturn a;\n}\nvector<int> mul(vector<int> a,int t){\n\tfor(int i=0;i<a.size();i++) a[i]*=t;\n\tfor(int i=0;i<(int)(a.size()-1);i++) if(a[i]>=10) a[i+1]+=a[i]/10,a[i]%=10;\n\tif(a[a.size()-1]>=10) a.pb(a[a.size()-1]/10),a[a.size()-2]%=10;\n\treturn a;\n}\nbool check(int mid){\n\tif(mid==0) return 0;\n\tif(mid==1){return (n==1&&s[1]=='1');}\n\tint m2=0;\n\tif(mid%3==1) m2=2,mid-=4;\n\tif(mid%3==2) m2=1,mid-=2;\n\tvector<int> a=pp;\n\tfor(int i=1;i<=mid/3-lv;i++) a=mul(a,3);\n\tfor(int i=1;i<=m2;i++) a=mul(a,2);\n//\tfor(int i=(int)(a.size()-1);~i;i--) printf(\"%d\",a[i]);printf(\"\\n\");\n\tif(a.size()<x.size()) return 0;\n\tif(a.size()>x.size()) return 1;\n\tfor(int i=(int)(a.size()-1);~i;i--){\n\t\tif(a[i]<x[i]) return 0;\n\t\tif(a[i]>x[i]) return 1;\n\t} return 1;\n}\nint main(){\n//\tfreopen(\"in.txt\",\"r\",stdin); \n\tscanf(\"%s\",s+1);n=strlen(s+1);\n\tfor(int i=n;i;i--) x.pb(s[i]^48);\n\tint mn=(int)(3.0*LOG310*(n-1));\n\tlv=max(mn/3-3,0);pp=ksm3(lv);\n//\tprintf(\"%d\\n\",mn);\n\tfor(int i=mn;;i++) if(check(i)){printf(\"%d\\n\",i);return 0;}\n\treturn 0;\n}\n```\n\n\u4e8e\u662f\u6211\u5f00\u59cb\u641c\u5404\u79cd FFT \u5361\u5e38\u6280\u5de7\uff0c\u611f\u89c9\u535a\u5ba2\u91cc\u6240\u8c13\u7684\u201c\u5361\u5e38\u6280\u5de7\u201d\uff0c\u5927\u591a\u6570\u90fd\u6ca1\u5565\u7528\uff0c\u552f\u72ec\u4e00\u6761\u611f\u89c9\u6709\u70b9\u7528\uff0c\u90a3\u5c31\u662f\uff1a\n\n```cpp\ncomp operator +(const comp rhs){return comp(x+rhs.x,y+rhs.y);}\n```\n\n\u5728\u53c2\u6570\u91cc\u9762\u52a0\u4e2a\u4f20\u5f15\u7528\uff1a\n\n```cpp\ncomp operator +(const comp &rhs){return comp(x+rhs.x,y+rhs.y);}\n```\n\n\u539f\u56e0\u672a\u77e5\uff0c\u4e0d\u8fc7\u7684\u786e\u5feb\u4e86\u4e00\u70b9\u70b9\uff0c140ms \u53d8\u6210\u4e86 109ms\uff0c\u624b\u9020\u7684\u6570\u636e\u4e5f\u53d8\u6210\u4e86 3.3s\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi first\n#define se second\n#define fz(i,a,b) for(int i=a;i<=b;i++)\n#define fd(i,a,b) for(int i=a;i>=b;i--)\n#define ffe(it,v) for(__typeof(v.begin()) it=v.begin();it!=v.end();it++)\n#define fill0(a) memset(a,0,sizeof(a))\n#define fill1(a) memset(a,-1,sizeof(a))\n#define fillbig(a) memset(a,63,sizeof(a))\n#define pb push_back\n#define ppb pop_back\n#define mp make_pair\ntemplate<typename T1,typename T2> void chkmin(T1 &x,T2 y){if(x>y) x=y;}\ntemplate<typename T1,typename T2> void chkmax(T1 &x,T2 y){if(x<y) x=y;}\ntypedef pair<int,int> pii;\ntypedef long long ll;\ntemplate<typename T> void read(T &x){\n\tx=0;char c=getchar();T neg=1;\n\twhile(!isdigit(c)){if(c=='-') neg=-1;c=getchar();}\n\twhile(isdigit(c)) x=x*10+c-'0',c=getchar();\n\tx*=neg;\n}\nconst int MAXN=1.5e6;\nconst int MAXP=1<<22;\nconst double LOG310=log(10)/log(3);\nconst double Pi=acos(-1);\nint n,LEN=1,LOG=0;\nstruct comp{\n\tdouble x,y;//(real,imag)\n\tcomp(){x=y=0;}\n\tcomp(double _x,double _y){x=_x;y=_y;}\n\tcomp operator +(const comp &rhs){return comp(x+rhs.x,y+rhs.y);}\n\tcomp operator -(const comp &rhs){return comp(x-rhs.x,y-rhs.y);}\n\tcomp operator *(const comp &rhs){return comp(x*rhs.x-y*rhs.y,x*rhs.y+y*rhs.x);}\n} A[MAXP+5],B[MAXP+5];\nchar s[MAXN+5];vector<int> x;\nint rev[MAXP+5];\nvector<int> pp;int lv;\nvoid FFT(comp *a,int len,int type){\n\tint lg=log2(len);\n\tfor(int i=0;i<len;i++) rev[i]=(rev[i>>1]>>1)|((i&1)<<(lg-1));\n\tfor(int i=0;i<len;i++) if(i<rev[i]) swap(a[i],a[rev[i]]);\n\tfor(int i=2;i<=len;i<<=1){\n\t\tcomp W=comp(cos(2*Pi/i),type*sin(2*Pi/i));\n\t\tfor(int j=0;j<len;j+=i){\n\t\t\tcomp w=comp(1,0);\n\t\t\tfor(int k=0;k<(i>>1);k++,w=w*W){\n\t\t\t\tcomp X=a[j+k],Y=a[(i>>1)+j+k]*w;\n\t\t\t\ta[j+k]=X+Y;a[(i>>1)+j+k]=X-Y;\n\t\t\t}\n\t\t}\n\t}\n\tif(type==-1) for(int i=0;i<len;i++) a[i].x=(int)(a[i].x/len+0.5);\n}\nvector<int> polymul(vector<int> a,vector<int> b){\n\tint len=1;\n\twhile(len<=a.size()+b.size()) len<<=1;\n\tfor(int i=0;i<len;i++) A[i]=B[i]=comp(0,0);\n\tfor(int i=0;i<a.size();i++) A[i]=comp(a[i],0);\n\tfor(int i=0;i<b.size();i++) B[i]=comp(b[i],0);\n\tFFT(A,len,1);FFT(B,len,1);\n\tfor(int i=0;i<len;i++) A[i]=A[i]*B[i];\n\tFFT(A,len,-1);\n\tvector<int> c(a.size()+b.size());\n\tfor(int i=0;i<c.size();i++){\n\t\tc[i]+=(int)A[i].x;\n\t\tif(c[i]>=10) c[i+1]+=c[i]/10,c[i]%=10;\n\t} if(c.back()==0) c.pop_back();\n\treturn c;\n}\nvector<int> ksm3(int k){\n\tvector<int> a,b;a.pb(1);b.pb(3);\n\tfor(;k;k>>=1){\n\t\tif(k&1) a=polymul(a,b);\n\t\tint len=1;\n\t\twhile(len<=b.size()*2) len<<=1;\n    \tif(len>MAXP) break;\n\t\tfor(int i=0;i<len;i++) A[i]=comp(0,0);\n\t\tfor(int i=0;i<b.size();i++) A[i]=comp(b[i],0);\n\t\tFFT(A,len,1);\n\t\tfor(int i=0;i<len;i++) A[i]=A[i]*A[i];\n\t\tFFT(A,len,-1);\n\t\tvector<int> c(b.size()*2,0);\n\t\tfor(int i=0;i<c.size();i++){\n\t\t\tc[i]+=(int)A[i].x;\n\t\t\tif(c[i]>=10) c[i+1]+=c[i]/10,c[i]%=10;\n\t\t} if(c.back()==0) c.pop_back();b=c;\n\t}\n//\tfor(int i=LEN;~i;i--) printf(\"%d\",a[i]);printf(\"\\n\");\n\treturn a;\n}\nvector<int> mul(vector<int> a,int t){\n\tfor(int i=0;i<a.size();i++) a[i]*=t;\n\tfor(int i=0;i<(int)(a.size()-1);i++) if(a[i]>=10) a[i+1]+=a[i]/10,a[i]%=10;\n\tif(a[a.size()-1]>=10) a.pb(a[a.size()-1]/10),a[a.size()-2]%=10;\n\treturn a;\n}\nbool check(int mid){\n\tif(mid==0) return 0;\n\tif(mid==1){return (n==1&&s[1]=='1');}\n\tint m2=0;\n\tif(mid%3==1) m2=2,mid-=4;\n\tif(mid%3==2) m2=1,mid-=2;\n\tvector<int> a=pp;\n\tfor(int i=1;i<=mid/3-lv;i++) a=mul(a,3);\n\tfor(int i=1;i<=m2;i++) a=mul(a,2);\n//\tfor(int i=(int)(a.size()-1);~i;i--) printf(\"%d\",a[i]);printf(\"\\n\");\n\tif(a.size()<x.size()) return 0;\n\tif(a.size()>x.size()) return 1;\n\tfor(int i=(int)(a.size()-1);~i;i--){\n\t\tif(a[i]<x[i]) return 0;\n\t\tif(a[i]>x[i]) return 1;\n\t} return 1;\n}\nint main(){\n//\tfreopen(\"in.txt\",\"r\",stdin); \n\tscanf(\"%s\",s+1);n=strlen(s+1);\n\tfor(int i=n;i;i--) x.pb(s[i]^48);\n\tint mn=(int)(3.0*LOG310*(n-1));\n\tlv=max(mn/3-2,0);pp=ksm3(lv);\n//\tprintf(\"%d\\n\",mn);\n\tfor(int i=mn;;i++) if(check(i)){printf(\"%d\\n\",i);return 0;}\n\treturn 0;\n}\n```\n\n\u611f\u89c9\u6ca1\u4ec0\u4e48\u5730\u65b9\u53ef\u5361\u4e86\u3002\u7136\u540e\u5c31\u5f7b\u5e95\u81ea\u95ed\u4e86\uff0c\u5f00\u59cb\u7ede\u52b2\u8111\u6c41\u60f3\u5982\u4f55\u8fdb\u4e00\u6b65\u5361\u5e38\u3002\u60f3\u4e86\u597d\u4e45\u7ec8\u4e8e\u60f3\u51fa\u4e86\u4e00\u79cd\u65b9\u6cd5\uff0c\u90a3\u5c31\u662f\u5bf9\u9ad8\u7cbe\u8fdb\u884c\u538b\u4f4d\uff0c\u4e24\u4f4d\u538b\u6210\u4e00\u4f4d\uff0c\u8fd9\u6837 FFT \u7684\u65f6\u5019\u6570\u7ec4\u957f\u5ea6\u53ef\u4ee5\u51cf\u5c11\u4e00\u534a\uff0c\u5e38\u6570\u4e5f\u53d8\u6210\u539f\u6765\u7684\u4e00\u534a\u4e86\u3002\n\n\u7ecf\u8fc7\u8fd9\u6837\u7684\u6539\u52a8\uff0c\u6781\u9650\u6570\u636e\u7531 3.3s \u53d8\u6210\u4e86 2s\uff0c\u4e5f\u5c31 AC \u4e86\u8fd9\u9053\u9898\u3002\n\n\u5927\u529f\u544a\u6210\u3002\n\n\u6700\u540e\u662f AC \u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi first\n#define se second\n#define fz(i,a,b) for(int i=a;i<=b;i++)\n#define fd(i,a,b) for(int i=a;i>=b;i--)\n#define ffe(it,v) for(__typeof(v.begin()) it=v.begin();it!=v.end();it++)\n#define fill0(a) memset(a,0,sizeof(a))\n#define fill1(a) memset(a,-1,sizeof(a))\n#define fillbig(a) memset(a,63,sizeof(a))\n#define pb push_back\n#define ppb pop_back\n#define mp make_pair\ntemplate<typename T1,typename T2> void chkmin(T1 &x,T2 y){if(x>y) x=y;}\ntemplate<typename T1,typename T2> void chkmax(T1 &x,T2 y){if(x<y) x=y;}\ntypedef pair<int,int> pii;\ntypedef long long ll;\ntemplate<typename T> void read(T &x){\n\tx=0;char c=getchar();T neg=1;\n\twhile(!isdigit(c)){if(c=='-') neg=-1;c=getchar();}\n\twhile(isdigit(c)) x=x*10+c-'0',c=getchar();\n\tx*=neg;\n}\nconst int MAXN=1.5e6;\nconst int MAXP=1<<21;\nconst int WIDTH=100;\nconst double LOG310=log(10)/log(3);\nconst double Pi=acos(-1);\nint n,LEN=1,LOG=0;\nstruct comp{\n\tdouble x,y;//(real,imag)\n\tcomp(){x=y=0;}\n\tcomp(double _x,double _y){x=_x;y=_y;}\n\tcomp operator +(const comp &rhs){return comp(x+rhs.x,y+rhs.y);}\n\tcomp operator -(const comp &rhs){return comp(x-rhs.x,y-rhs.y);}\n\tcomp operator *(const comp &rhs){return comp(x*rhs.x-y*rhs.y,x*rhs.y+y*rhs.x);}\n} A[MAXP+5],B[MAXP+5];\nchar s[MAXN+5];vector<int> x;\nint rev[MAXP+5];\nvector<int> pp;int lv;\nvoid FFT(comp *a,int len,int type){\n\tint lg=log2(len);\n\tfor(int i=0;i<len;i++) rev[i]=(rev[i>>1]>>1)|((i&1)<<(lg-1));\n\tfor(int i=0;i<len;i++) if(i<rev[i]) swap(a[i],a[rev[i]]);\n\tfor(int i=2;i<=len;i<<=1){\n\t\tcomp W=comp(cos(2*Pi/i),type*sin(2*Pi/i));\n\t\tfor(int j=0;j<len;j+=i){\n\t\t\tcomp w=comp(1,0);\n\t\t\tfor(int k=0;k<(i>>1);k++,w=w*W){\n\t\t\t\tcomp X=a[j+k],Y=a[(i>>1)+j+k]*w;\n\t\t\t\ta[j+k]=X+Y;a[(i>>1)+j+k]=X-Y;\n\t\t\t}\n\t\t}\n\t}\n\tif(type==-1) for(int i=0;i<len;i++) a[i].x=(int)(a[i].x/len+0.5);\n}\nvector<int> polymul(vector<int> a,vector<int> b){\n\tint len=1;\n\twhile(len<=a.size()+b.size()) len<<=1;\n\tfor(int i=0;i<len;i++) A[i]=B[i]=comp(0,0);\n\tfor(int i=0;i<a.size();i++) A[i]=comp(a[i],0);\n\tfor(int i=0;i<b.size();i++) B[i]=comp(b[i],0);\n\tFFT(A,len,1);FFT(B,len,1);\n\tfor(int i=0;i<len;i++) A[i]=A[i]*B[i];\n\tFFT(A,len,-1);\n\tvector<int> c(a.size()+b.size());\n\tfor(int i=0;i<c.size();i++){\n\t\tc[i]+=(int)A[i].x;\n\t\tif(c[i]>=WIDTH) c[i+1]+=c[i]/WIDTH,c[i]%=WIDTH;\n\t} if(c.back()==0) c.pop_back();\n\treturn c;\n}\nvector<int> ksm3(int k){\n\tvector<int> a,b;a.pb(1);b.pb(3);\n\tfor(;k;k>>=1){\n\t\tif(k&1) a=polymul(a,b);\n\t\tint len=1;\n\t\twhile(len<=b.size()*2) len<<=1;\n    \tif(len>MAXP) break;\n\t\tfor(int i=0;i<len;i++) A[i]=comp(0,0);\n\t\tfor(int i=0;i<b.size();i++) A[i]=comp(b[i],0);\n\t\tFFT(A,len,1);\n\t\tfor(int i=0;i<len;i++) A[i]=A[i]*A[i];\n\t\tFFT(A,len,-1);\n\t\tvector<int> c(b.size()*2,0);\n\t\tfor(int i=0;i<c.size();i++){\n\t\t\tc[i]+=(int)A[i].x;\n\t\t\tif(c[i]>=WIDTH) c[i+1]+=c[i]/WIDTH,c[i]%=WIDTH;\n\t\t} if(c.back()==0) c.pop_back();b=c;\n\t}\n//\tfor(int i=LEN;~i;i--) printf(\"%d\",a[i]);printf(\"\\n\");\n\treturn a;\n}\nvector<int> mul(vector<int> a,int t){\n\tfor(int i=0;i<a.size();i++) a[i]*=t;\n\tfor(int i=0;i<(int)(a.size()-1);i++) if(a[i]>=WIDTH) a[i+1]+=a[i]/WIDTH,a[i]%=WIDTH;\n\tif(a[a.size()-1]>=WIDTH) a.pb(a[a.size()-1]/WIDTH),a[a.size()-2]%=WIDTH;\n\treturn a;\n}\nbool check(int mid){\n\tif(mid==0) return 0;\n\tif(mid==1){return (n==1&&s[1]=='1');}\n\tint m2=0;\n\tif(mid%3==1) m2=2,mid-=4;\n\tif(mid%3==2) m2=1,mid-=2;\n\tvector<int> a=pp;\n\tfor(int i=1;i<=mid/3-lv;i++) a=mul(a,3);\n\tfor(int i=1;i<=m2;i++) a=mul(a,2);\n\tvector<int> b;\n\tfor(int i=0;i<a.size();i++){b.pb(a[i]%10);b.pb(a[i]/10);}\n\tif(b.back()==0) b.pop_back();\n//\tfor(int i=(int)(a.size()-1);~i;i--) printf(\"%d\",a[i]);printf(\"\\n\");\n\tif(b.size()<x.size()) return 0;\n\tif(b.size()>x.size()) return 1;\n\tfor(int i=(int)(b.size()-1);~i;i--){\n\t\tif(b[i]<x[i]) return 0;\n\t\tif(b[i]>x[i]) return 1;\n\t} return 1;\n}\nint main(){\n//\tfreopen(\"in.txt\",\"r\",stdin); \n\tscanf(\"%s\",s+1);n=strlen(s+1);\n\tfor(int i=n;i;i--) x.pb(s[i]^48);\n\tint mn=(int)(3.0*LOG310*(n-1));\n\tlv=max(mn/3-2,0);pp=ksm3(lv);\n//\tprintf(\"%d\\n\",mn);\n\tfor(int i=mn;;i++) if(check(i)){printf(\"%d\\n\",i);return 0;}\n\treturn 0;\n}\n```\n\n\u4f60\u53ef\u80fd\u4f1a\u8bf4\uff0cNTT \u4e0d\u662f\u6bd4 FFT \u5feb\u5417\uff1f\u5982\u679c\u6539\u6210 NTT \u4f1a\u600e\u4e48\u6837\u5462\uff1f\n\n\u90a3\u6211\u8981\u544a\u8bc9\u4f60\uff1a**\u4e0d\u5f00 O2 NTT \u6bd4 FFT \u5feb\uff0c\u5f00 O2 FFT \u6bd4 NTT \u5feb**\n\n\u7ffb\u4e86\u4e0b\u524d\u51e0\u540d\u7684\u4ee3\u7801\uff0c\u53d1\u73b0\u4ed6\u4eec\u4e5f\u90fd\u662f\u7528 vector \u5b58\u50a8\u5927\u6570\uff0c\u5e76\u9884\u5904\u7406 $p=3^{\\lfloor\\log_3n\\rfloor}$\uff0c\u7136\u540e\u4ece $3\\log_3n$ \u5904\u66b4\u529b\u679a\u4e3e\u7b54\u6848\u7684\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u4ed6\u4eec\u8fd8\u7528\u4e86\u4e00\u4e9b\u522b\u7684\u5361\u5e38\u6280\u5de7\uff0c\u5982 tourist \u7528\u4e86 1 \u6b21 DFT+1 \u6b21 IDFT\u7684\u591a\u9879\u5f0f\u4e58\u6cd5\uff0cdyh \u4e5f\u5728\u53c2\u6570\u91cc\u9762\u52a0\u4e86\u4e2a\u4f20\u5f15\u7528\uff0cLHiC \u4e5f\u662f\u5728\u81ea\u4e58\u90a3\u4e2a\u5730\u65b9\u624b\u5199\u4e86\u4e00\u4e2a\u51fd\u6570 ```mult2``` \u7b49\u7b49\uff0c\u8fd9\u4e00\u7c7b\u7684\u5361\u5e38\u6280\u5de7\u5728\u78b0\u5230 dl \u5361\u5e38\u9898\u7684\u65f6\u5019\u4e5f\u90fd\u662f\u80fd\u6d3e\u4e0a\u7528\u573a\u7684\u3002\n\n~~\u8bdd\u8bf4\u8fd9\u573a\u7684 E \u6211\u662f\u4e0d\u662f\u505a\u8fc7\u554a\uff0c\u5f53\u5e74\u6211\u4e5f\u5361\u4e86\u4e00\u5929\u7684\u5e38\u6765\u7740\u7684\uff1f~~",
        "postTime": 1610788270,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF986D \u3010Perfect Encoding\u3011"
    },
    {
        "content": "\u9898\u610f\u5c31\u662f\u6784\u9020\u5e8f\u5217 $\\{b_m\\}$ \uff0c\u4f7f $\\prod\\limits_{i = 1}^m {{b_i}} \\ge n$ \u4e14 $k=\\sum\\limits_{i = 1}^m {{b_i}}$ \u6700\u5c0f\u3002\n\n\u5047\u8bbe $k$ \u786e\u5b9a\u4e14 $b_i$ \u7684\u8303\u56f4\u4e3a\u6b63\u5b9e\u6570\uff0c\u90a3\u4e48\u627e\u627e\u89c4\u5f8b\u5c31\u53d1\u73b0\u53d6 $b=e,m=\\frac{k}{e}$ \u65f6 $n$ \u6700\u5927\u3002\u7136\u540e 3 \u662f\u6700\u63a5\u8fd1 $e$ \u7684\u6574\u6570\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u8fd9\u6837\u6784\u9020 $b$\uff1a\n- \u82e5 $k\\equiv 0(\\mod 3)$\uff0c\u5219\u6240\u6709 $b_i$ \u90fd\u4e3a 3\uff1b\n- \u82e5 $k\\equiv 1(\\mod 3)$\uff0c\u5219\u6700\u540e\u4e00\u4e2a $b_i$ \u4e3a 4\uff0c\u5176\u4ed6\u90fd\u4e3a 3\uff1b\n- \u82e5 $k\\equiv 2(\\mod 3)$\uff0c\u5219\u6700\u540e\u4e00\u4e2a $b_i$ \u4e3a 2\uff0c\u5176\u4ed6\u90fd\u4e3a 3\u3002\n\n\u8fd9\u6837\uff0c\u5728\u77e5\u9053 $k$ \u7684\u60c5\u51b5\u4e0b\uff0c\u7528 FFT \u505a\u9ad8\u7cbe\u5feb\u901f\u5e42\u5c31\u53ef\u4ee5\u7b97 $f(k) = \\max \\prod\\limits_i {{b_i}}$ \u4e86\u3002\n\n\u90a3\u4e48\u600e\u4e48\u77e5\u9053\u6700\u5c0f\u7684\u5408\u6cd5\u7684 $k$ \u5462\uff1f\u4e8c\u5206\u662f\u4e00\u4e2a\u529e\u6cd5\uff0c\u4f46\u592a\u6162\u3002\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0 $f(k)$ \u5728\u6307\u6570\u610f\u4e49\u4e0a\u662f\u7565\u5c0f\u4e8e\uff08\u7b49\u4e8e\uff09$3^{\\frac{k}{3}}$ \u7684\u3002\u89e3\u4e2a\u65b9\u7a0b\u53ef\u4ee5\u5f97\u5230 $k\\geq 3\\log_3 n$\u3002\u7136\u540e\u53ef\u80fd\u6709\u4e00\u70b9\u504f\u5dee\uff0c\u4ece\u8fd9\u4e2a\u4e0b\u754c\u5f00\u59cb\u5f80\u4e0a\u679a\u4e3e\u5e38\u6570\u6b21\u5c31\u53ef\u4ee5\u5f97\u5230\u7b54\u6848\u3002\n\n\u6700\u540e\u4e00\u4e2a\u95ee\u9898\u662f\u600e\u4e48\u7b97 $\\log_3 n$\uff08\u5927\u81f4\u7cbe\u786e\u5230\u6574\u6570\uff09\u3002\u6211\u4eec\u77e5\u9053\u8fd9\u4e2a\u503c\u4e0e $n$ \u5728\u5341\u8fdb\u5236\u4e0b\u7684\u4f4d\u6570\u8fd8\u6709\u5b83\u7684\u9996\u51e0\u4f4d\u5173\u7cfb\u6700\u5927\u3002\u4e8e\u662f\u6211\u4eec\u53ea\u8003\u8651\u8fd9\u4e9b\u56e0\u7d20\u5c31\u53ef\u4ee5\u5f97\u51fa\u4e00\u4e2a\u8fd1\u4f3c\u7684\u7b54\u6848\u3002\n\n\u5f00\u59cb\u5199\u7684\u65f6\u5019\u6ca1\u8003\u8651\u4e0a\u9762\u8fd9\u4e48\u591a\uff0c\u5c31\u8dd1\u5f97\u5f88\u6162\u3002\u6700\u540e\u628a\u5e38\u6570\u5361\u5230\u7b2c\u4e00\u6b21\u4ea4\u7684 1/13 \u624d\u8fc7\uff08\n\n\u4e0b\u9762\u662f\u4e00\u4e9b\uff08\u6211\u7528\u7684\uff09\u5361\u5e38\u6280\u5de7\uff1a\n- \u4e0d\u8981\u6bcf\u6b21\u8dd1\u90fd\u7528 FFT \u5feb\u901f\u5e42\u7b97 3 \u7684\u5e42\u6b21\uff0c\u5b9e\u9645\u4e0a\u53ea\u7528\u5728\u5f00\u59cb\u65f6\u7b97\u4e00\u6b21\uff0c\u540e\u9762\u4f1a\u7528\u7684\u6307\u6570\u90fd\u5dee\u4e0d\u591a\uff0c\u53ea\u9700\u8981\u5728\u6b64\u57fa\u7840\u4e0a\u4e58\u4e2a\u5e38\u6570\u3002\n- \u5feb\u901f\u5e42\u7684\u4e58\u65b9\u64cd\u4f5c\u4e0d\u8981\u76f4\u63a5\u7528\u4e24\u6570\u76f8\u4e58\u7684\u677f\u5b50\uff0c\u5355\u72ec\u5199\u53ef\u4ee5\u7701\u4e00\u6b21 DFT\u3002\n- \u5feb\u901f\u5e42\u4e0d\u8981\u6bcf\u6b21\u500d\u589e\u90fd\u628a\u4e58\u6cd5\u7684\u957f\u5ea6\u53d6\u4e3a $\\lg n$ \uff0c\u5426\u5219\u590d\u6742\u5ea6\u4f1a\u591a\u4e2a $\\log$\u3002\n- \u9ad8\u7cbe\u538b\u4f4d\u3002\n- \u5982\u679c\u8fd8\u662f\u4e0d\u884c\uff0c\u8bf7\u6ce8\u610f\u4ee3\u7801\u7684\u5e95\u5c42\u4f18\u5316\u3002\n\n\u8fd9\u6837\u505a\u7684\u590d\u6742\u5ea6\u5c31\u662f $O(\\lg n\\log \\lg n)$\u3002\u4ee3\u7801\uff1a\n```cpp\n#include <cstdio>\n#include <cmath>\n#include <iostream>\n#include <vector>\nusing namespace std;\nconst int MAXN=2200000;\nconst int P=998244353;\nconst int G=3, GI=332748118;\nint qpow(int n, int k)\n{\n\tint r=1;\n\twhile (k)\n\t{\n\t\tif (k&1) r=1ll*r*n%P;\n\t\tn=1ll*n*n%P; k>>=1;\n\t}\n\treturn r;\n}\nint l, r[MAXN];\nvoid getl(int n)\n{\n\tl=1, r[0]=0; int d=0;\n\twhile (l<=n) l<<=1, d++;\n\tfor (int i=1; i<l; i++)\n\t\tr[i]=r[i>>1]>>1|(i&1)<<d-1;\n}\nvoid ntt(int* a, int ty)\n{\n\tfor (int i=0; i<l; i++)\n\t\tif (i<r[i]) swap(a[i], a[r[i]]);\n\tfor (int k=1; k<l; k<<=1)\n\t{\n\t\tint wn=qpow(ty==1?G:GI, (P-1)/(k<<1));\n\t\tfor (int i=0; i<l; i+=k<<1)\n\t\t\tfor (int j=0, w=1; j<k; j++, w=1ll*w*wn%P)\n\t\t\t{\n\t\t\t\tint x=a[i+j], y=1ll*w*a[i+k+j]%P;\n\t\t\t\ta[i+j]=(x+y)%P, a[i+k+j]=(x-y+P)%P;\n\t\t\t}\n\t}\n\tif (ty==-1)\n\t{\n\t\tint li=qpow(l, P-2);\n\t\tfor (int i=0; i<l; i++) a[i]=1ll*a[i]*li%P;\n\t}\n}\nint f[MAXN], g[MAXN];\nstruct BigInt\n{\n\tstatic const int BASE=100;\n\tstatic const int WIDTH=2;\n\tvector<int> s;\n\tBigInt(int num=0)\n\t{\n\t\ts.clear();\n    \tdo s.push_back(num%BASE), num/=BASE;\n\t\twhile (num>0);\n\t}\n    BigInt(string str)\n    {\n    \ts.clear();\n    \tint x, len=(str.length()-1)/WIDTH+1;\n    \tfor (int i=0; i<len; i++)\n    \t{\n    \t\tint cl=str.length()-i*WIDTH;\n    \t\tint op=max(0, cl-WIDTH);\n    \t\tsscanf(str.substr(op, cl-op).c_str(), \"%d\", &x);\n    \t\ts.push_back(x);\n\t\t}\n\t\tclean();\n\t}\n\tvoid clean()\n\t{\n\t\twhile(s.size()>1&&!s.back()) s.pop_back();\n\t}\n\tBigInt operator * (int b) const\n\t{\n\t\tBigInt c; c.s.clear();\n\t\tint l=s.size()+3;\n\t\tfor (int i=0; i<l; i++) f[i]=0;\n\t\tfor (int i=0; i<s.size(); i++) f[i]=s[i]*b;\n\t\tfor (int i=0; i<l; i++)\n\t\t{\n\t\t\tif (f[i]>=BASE) f[i+1]+=f[i]/BASE, f[i]%=BASE;\n\t\t\tc.s.push_back(f[i]);\n\t\t}\n\t\tc.clean();\n\t\treturn c;\n\t}\n\tvoid operator *= (const BigInt& b)\n\t{\n\t\tgetl(s.size()+b.s.size());\n\t\tfor (int i=0; i<l; i++) f[i]=g[i]=0;\n\t\tfor (int i=0; i<s.size(); i++) f[i]=s[i];\n\t\tfor (int i=0; i<b.s.size(); i++) g[i]=b.s[i];\n\t\tntt(f, 1); ntt(g, 1);\n\t\tfor (int i=0; i<l; i++) f[i]=1ll*f[i]*g[i]%P;\n\t\tntt(f, -1);\n\t\ts.clear();\n\t\tfor (int i=0; i<l; i++)\n\t\t{\n\t\t\tif (f[i]>=BASE) f[i+1]+=f[i]/BASE, f[i]%=BASE;\n\t\t\ts.push_back(f[i]);\n\t\t}\n\t\tclean();\n\t}\n\tvoid sqr()\n\t{\n\t\tgetl(2*s.size());\n\t\tfor (int i=0; i<l; i++) f[i]=0;\n\t\tfor (int i=0; i<s.size(); i++) f[i]=s[i];\n\t\tntt(f, 1);\n\t\tfor (int i=0; i<l; i++) f[i]=1ll*f[i]*f[i]%P;\n\t\tntt(f, -1);\n\t\ts.clear();\n\t\tfor (int i=0; i<l; i++)\n\t\t{\n\t\t\tif (f[i]>=BASE) f[i+1]+=f[i]/BASE, f[i]%=BASE;\n\t\t\ts.push_back(f[i]);\n\t\t}\n\t\tclean();\n\t}\n\tbool operator <= (const BigInt& b) const\n\t{\n\t\tif (s.size()!=b.s.size()) return s.size()<b.s.size();\n\t\tfor (int i=s.size()-1; i>=0; i--)\n\t\t\tif (s[i]!=b.s[i]) return s[i]<b.s[i];\n\t\treturn 1;\n\t}\n};\nconst double LOG3=log(3);\nconst double LOG3_10=log(10)/LOG3;\nint p; BigInt pow3p;\nint pw[]={1, 3, 9, 27, 81, 243};\nBigInt pow3(int k)\n{\n\tBigInt s=1, t=3;\n\twhile (k)\n\t{\n\t\tif (k&1) s*=t;\n\t\tt.sqr(); k>>=1;\n\t}\n\treturn s;\n}\nBigInt calc(int k)\n{\n\tif (k<=2) return k;\n\tif (k%3==0) return pow3p*pw[k/3-p];\n\tif (k%3==1) return pow3p*(pw[k/3-1-p]*4);\n\treturn pow3p*(pw[k/3-p]*2);\n}\nint main()\n{\n//\tfreopen(\"D.in\", \"r\", stdin);\n//\tfreopen(\"D.out\", \"w\", stdout);\n\tstring s; cin>>s;\n\tBigInt n=s;\n\tint l=3*((s.size()-1)*LOG3_10+log(s.front()-'0')/LOG3);\n\tp=max(0, l/3-1); pow3p=pow3(p);\n\tfor (int i=l; ; i++)\n\t\tif (n<=calc(i))\n\t\t{\n\t\t\tprintf(\"%d\\n\", i);\n\t\t\tbreak;\n\t\t}\n\treturn 0;\n}\n```",
        "postTime": 1580445398,
        "uid": 43064,
        "name": "\u6500\u5ca9\u9ad8\u624b",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF986D \u3010Perfect Encoding\u3011"
    }
]
[
    {
        "content": "[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/CF356D)\n\n\u5206\u6790\uff1a\n\n\u5bf9\u4e8e\u67d0\u4e2a\u8282\u70b9 $u$\uff0c\u8bbe\u4ed6\u7684\u5b50\u8282\u70b9\u4e3a $v$\uff0c\u5219 $c_{u}=a_{u}-a_{v}$\u3002\n\n\u7279\u4f8b\uff1a\n\n$\\exists 1 \\leq i \\leq n$,$a_{i} \\geq S$\n\n\u53d1\u73b0\u5982\u679c $a_{i} > S$ \u5219\u65e0\u89e3\uff0c$a_{i} = S$ \u65f6 $i$ \u4f5c\u4e3a\u6811\u7684\u6839\u8282\u70b9\u3002\n\n\u6240\u4ee5\u6211\u4eec\u5bf9 $a_{i}$ \u5347\u5e8f\u6392\u5e8f\uff0c\u7136\u540e $x+1$ \u5411 $x$ \u8fde\u8fb9\u5373\u53ef\u3002\n\n\u6b63\u89e3\uff1a\n\n\u6240\u6709\u7684 $i$ \u6784\u6210\u4e00\u4e2a\u68ee\u6797\u3002\n\n\u6bcf\u4e2a\u8282\u70b9\u5411\u5b83\u7684\u7236\u4eb2\u8282\u70b9\u8fde\u8fb9\u5373\u53ef\u3002\n\n\u663e\u7136\uff0c\u5bf9\u4e8e\u68ee\u6797\u4e2d\u7684\u6bcf\u68f5\u6811\uff0c\u90fd\u80fd\u7528**\u7279\u4f8b**\u7684\u65b9\u6cd5\u91cd\u6784\u6210\u5408\u6cd5\u65b9\u6848\u3002\n\n\u6ce8\u610f\u5230 $a$ \u6700\u5927\u7684 $i$ \u4e0d\u4f1a\u88ab\u4f5c\u4e3a\u53f6\u5b50\u8282\u70b9\uff08\u8bb0\u5b83\u7684\u7f16\u53f7\u4e3a $p$\uff09\uff0c\u6240\u4ee5\u5176\u4ed6\u8282\u70b9\u7684\u6743\u503c\u4e4b\u548c\u4e3a $S-a_{p}$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u5728\u5176\u5b83\u6ca1\u88ab\u8fde\u4e3a\u5b50\u8282\u70b9\u7684\u8282\u70b9\u4e2d\u9009\u51fa\u5b50\u96c6 $T$ \u6ee1\u8db3 $\\sum_{i\\in T} a_{i} =S-a_{p}$\uff0c\u8fd9\u662f\u4e00\u4e2a\u7ecf\u5178\u7684\u80cc\u5305\u95ee\u9898\u3002\n\n\u8bbe $dp_{i,j}$ \u8868\u793a\u8003\u8651\u5230\u7b2c $i$ \u4e2a\u8282\u70b9\uff0c$a_{i}$ \u7684\u548c\u4e3a $j$ \u65f6\u662f\u5426\u6709\u89e3\uff0c\u76f4\u63a5\u8dd101\u80cc\u5305\u65f6\u95f4\u590d\u6742\u5ea6 $O(nS)$\u3002\n\n\u7136\u800c\u5bf9\u4e8e\u9898\u76ee\u7684 $1 \\leq n,S \\leq 70000$ \u663e\u7136\u4f1aTLE\u3002\n\n\u4f18\u5316\uff1a\n\n\u80cc\u5305\u8f6c\u79fb\u7528 ```bitset``` \u4f18\u5316\uff0c\u53ef\u4ee5\u505a\u5230 $O(\\frac{nS}{\\omega})$ \u7684\u590d\u6742\u5ea6\u3002\n\n\u81f3\u4e8e\u65b9\u6848\u7684\u6784\u9020\uff0c\u8003\u8651\u4e00\u4e2a\u8f6c\u79fb $f_{i,j}\\leftarrow f_{i-1,j-a_{i}}$\uff0c\u82e5\u4e4b\u524d\u90fd\u6ca1\u6709\u548c\u4e3a $j$ \u7684\u65b9\u6848\uff0c\u6211\u4eec\u8bb0 $nxt_j=i$\uff0c\u8868\u793a $i$ \u63d0\u4f9b\u4e86\u7b2c\u4e00\u6761\u5411 $j$ \u7684\u8f6c\u79fb\u8fb9\uff0c\u4e4b\u540e\u53ef\u4ee5\u901a\u8fc7\u5c06 $s$\uff08\u521d\u503c\u4e3a $S-a_{p}$ \uff09\u4e0d\u65ad\u51cf\u53bb $a_{nxt_{s}}$ \u76f4\u5230 ```0``` \u6765\u627e\u51fa\u96c6\u5408 $T$\u3002\n\n\u8fd9\u6837\uff0c\u590d\u6742\u5ea6\u74f6\u9888\u4fbf\u53d8\u4e3a\u5982\u4f55\u5feb\u901f\u627e\u51fa\u6bcf\u6b21\u66f4\u65b0\u4e86\u54ea\u4e9b\u4f4d\u7f6e\uff08\u5f02\u6216\u76f8\u90bb\u7684\u72b6\u6001\u5373\u53ef\uff09\u3002\u53ef\u4ee5\u624b\u5199 ```bitset```\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 ```bitset``` \u5185\u7f6e\u7684 ```_Find_first``` \u548c ```_Find_next``` \u51fd\u6570\uff08NOI Linux \u4e0b\u53ef\u7528\uff09\u3002\n\n\u904d\u5386\u65b9\u6cd5\uff08\u8bb0 $t$ \u662f\u4e00\u4e2a\u957f\u5ea6 $len$ \u7684 ```bitset``` \uff09\uff1a\n\n```cpp\nfor (int i=t._Find_first();i<len;i=t._Find_next(i)){ \n\t// \u904d\u5386 t \u4e2d\u6240\u6709\u4e3a 1 \u7684\u4f4d\u7f6e \n}\n```\n\u8bb0 $t$ \u4e2d\u6709 $c$ \u4e2a ```1```\uff0c\u5219\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(c+\\frac{len}{\\omega})$\u3002\n\n\u7531\u4e8e\u6bcf\u4e2a\u4f4d\u7f6e\u53ea\u4f1a\u5728\u7b2c\u4e00\u6b21\u5230\u8fbe\u65f6\u88ab\u66f4\u65b0\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n+S+\\frac{nS}{\\omega})$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $O(n+S)$\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int Maxn=1e5+10;\nconst int mod=1e9+7;\ntypedef long long ll;\nnamespace io{\n\tconst int _SIZE=(1<<21)+1;\n\tchar ibuf[_SIZE],*iS,*iT,c,stk[40];int tot;\n#define gc()(iS==iT?(iT=(iS=ibuf)+fread(ibuf,1,_SIZE,stdin),(iS==iT ?EOF:*iS++)):*iS++)\n\ttemplate<class I>\n\tinline void read(I &_x){\n\t\tI fl=1;\n\t\tfor(c=gc();c<'0'||c>'9';c=gc()) if(c=='-') fl=-1;\n\t\tfor(_x=0;c>='0'&&c<='9';c=gc()) _x=(_x<<3)+(_x<<1)+(c&15);\n\t\t_x*=fl;\n\t}\n\ttemplate<class I>\n\tinline void prt(I _x,char ch='\\0'){\n\t\ttot=0;\n\t\tif(_x<0) putchar('-'),_x*=-1;\n\t\tdo{\n\t\t\tstk[tot++]=_x%10|48;_x/=10;\n\t\t}while(_x);\n\t\tdo{\n\t\t\tputchar(stk[--tot]);\n\t\t}while(tot);\n\t\tif(ch)putchar(ch);\n\t}\n}\nusing io::read;\nusing io::prt;\nint n,s;\nstruct node{\n\tint l,id;\n}a[Maxn];\nbool cmp1(node x,node y){return x.l>y.l;}\nbool cmp2(node x,node y){return x.id<y.id;}\nint link[Maxn],nxt[Maxn],cnt,son[Maxn],c[Maxn],l[Maxn],idx[Maxn];\nbitset<Maxn>dp,t;\nbool done[Maxn];\nint main(){\n\tread(n),read(s);\n\tfor(int i=1;i<=n;i++){\n\t\tread(a[i].l),a[i].id=i;\n\t\tif(a[i].l>s){\n\t\t\tputs(\"-1\");\n\t\t\treturn 0;\n\t\t}\n\t}\n\tsort(a+1,a+1+n,cmp1);\n\ts-=a[1].l;\n\tdp[0]=1;\n\tfor(int i=2;i<=n;i++){\n\t\tt=dp;\n\t\tdp|=dp<<a[i].l;\n\t\tt^=dp;\n\t\tfor(int j=t._Find_first();j<Maxn;j=t._Find_next(j)) nxt[j]=i;\n\t}\n\tif(dp[s]==false){\n\t\tputs(\"-1\");\n\t\treturn 0;\n\t}\n\tint pos=s;\n\twhile(pos){\n\t\tdone[nxt[pos]]=true;\n\t\tc[a[nxt[pos]].id]=a[nxt[pos]].l;\n\t\tpos-=a[nxt[pos]].l;\n\t}\n\tfor(int i=1;i<=n;i++) if(!done[i]) link[++cnt]=a[i].id;\n\tsort(a+1,a+1+n,cmp2);\t\n\tfor(int i=2;i<=cnt;i++){\n\t\tc[link[i-1]]=a[link[i-1]].l-a[link[i]].l;\n\t\tson[link[i-1]]=link[i];\n\t}\n\tc[link[cnt]]=a[link[cnt]].l;\t\n\tfor(int i=1;i<=n;i++){\n\t\tprt(c[i],' ');\n\t\tif(son[i]) prt(1,' '),prt(son[i],'\\n');\n\t\telse puts(\"0\");\n\t}\n\treturn 0;\n}\n\n```\n",
        "postTime": 1636417328,
        "uid": 395493,
        "name": "\u767d\u4f9d\u5c18_\u8f69\u5b50\u58a8",
        "ccfLevel": 0,
        "title": "CF356D [Bags and Coins]"
    },
    {
        "content": "\u6ce8\u610f\u5230\u5b50\u6811\u6700\u5927\u7684\u7ed3\u70b9\u5fc5\u4e3a\u6839\u3002\n\n\u5bf9\u5269\u4e0b\u7684\u7ed3\u70b9\u8003\u8651 $s^2$ \u80cc\u5305dp\uff0c\u8bbe $dp[i][j]$ \u8868\u793a\u524d $i$ \u4e2a\u7ed3\u70b9\u4e2d\u662f\u5426\u5b58\u5728\u82e5\u5e72\u7ed3\u70b9\u4f7f\u5176\u548c\u4e3a $j$\uff0c\u8fd9\u4e9b\u7ed3\u70b9\u4f5c\u4e3a\u68ee\u6797\u7684\u6839\u3002\n\n\u53ef\u4ee5\u538b\u6389 $i$ \u8fd9\u4e00\u7ef4\uff0c\u5e76\u8bb0\u5f55\u662f\u4ece\u54ea\u91cc\u8f6c\u79fb\u7684\uff0c\u5c31\u53ef\u4ee5\u83b7\u5f97\u65b9\u6848\u3002\n\n\u8003\u8651\u6784\u9020\u65b9\u6848\uff0c\u628a\u975e\u6839\u7ed3\u70b9\u6309\u5b50\u6811\u5927\u5c0f\u4ece\u5927\u5230\u5c0f\u585e\u5230\u5b50\u6811\u6700\u5927\u7684\u7ed3\u70b9\u4e3a\u6839\u7684\u6811\u91cc\u5f62\u6210\u4e00\u6761\u94fe\u3002\n\n\u7528bitset\u4f18\u5316\u4e00\u4e0b\u5c31\u80fd\u8fc7\u4e86\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int BUF_SIZ(1<<20);\nchar ibuf[BUF_SIZ],*ip1(ibuf),*ip2(ibuf);\n#define getchar() (ip1==ip2&&(ip2=(ip1=ibuf)+fread(ibuf,1,BUF_SIZ,stdin),ip1==ip2)?EOF:*ip1++)\nvoid read(int& x)\n{\n\tstatic char c;\n\tregister int f=1;\n\twhile(!isdigit(c=getchar()))if(c=='-')f=-1;\n\tx=c&15;\n\twhile(isdigit(c=getchar()))x*=10,x+=c&15;\n\tx*=f;\n}\nvoid read(ll& x)\n{\n\tstatic char c;\n\tregister ll f=1;\n\twhile(!isdigit(c=getchar()))if(c=='-')f=-1;\n\tx=c&15;\n\twhile(isdigit(c=getchar()))x*=10,x+=c&15;\n\tx*=f;\n}\nvoid write(ll x)\n{\n\tif(x<0)return putchar('-'),write(-x);\n\tif(x>9)write(x/10);\n\tputchar(x%10|'0');\n}\nint n,s;\npair<int,int> l[100001];\nbitset<100001>b,t;\nint la[100001];\nint maxx;\nbool hv[100001];\nvector<int>to[100001],fr[100001];\nint in[100001];\nint ans[100001];\n\nint main()\n{\n\tread(n),read(s);\n\tb[0]=1;\n\tfor(int i=1;i<=n;i++)read(l[i].first),l[i].second=i;\n\tsort(l+1,l+n+1);\n\tfor(int i=1;i<n;i++)\n\t{\n\t\tt=b;\n\t\tb|=(b<<l[i].first);\n\t\tt^=b;\n\t\tfor(int j=t._Find_first();j<=s-l[n].first;j=t._Find_next(j))la[j]=l[i].second;\n\t}\n\tif(s-l[n].first<0)\n\t{\n\t\tputs(\"-1\");\n\t\treturn 0;\n\t}\n\tif(b[s-l[n].first])\n\t{\n\t\tint ad=l[n].second;\n\t\tla[s]=l[n].second;\n\t\tfor(int i=1;i<=n;i++)swap(l[i].first,l[i].second);\n\t\tsort(l+1,l+n+1);\n\t\tint t=s;\n\t\twhile(t)\n\t\t{\n\t\t\thv[la[t]]=1;\n\t\t\tt-=l[la[t]].second;\n\t\t}\n\t\tfor(int i=1;i<=n;i++)swap(l[i].first,l[i].second);\n\t\tsort(l+1,l+n+1);\n\t\tfor(int i=n;i>0;i--)\n\t\t{\n\t\t\tif(hv[l[i].second])continue;\n\t\t\tto[l[i].second].push_back(ad);\n\t\t\tfr[ad].push_back(l[i].second);\n\t\t\tin[ad]++;\n\t\t\tad=l[i].second;\n\t\t}\n\t\tfor(int i=1;i<=n;i++)swap(l[i].first,l[i].second);\n\t\tsort(l+1,l+n+1);\n\t\tqueue<int>que;\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tans[i]=l[i].second;\n\t\t\tif(!in[i])\n\t\t\t{\n\t\t\t\tque.push(i);\n\t\t\t}\n\t\t}\n\t\twhile(!que.empty())\n\t\t{\n\t\t\tint x=que.front();\n\t\t\tque.pop();\n\t\t\tint len=to[x].size();\n\t\t\tfor(int i=0;i<len;i++)\n\t\t\t{\n\t\t\t\tans[to[x][i]]-=l[x].second;\n\t\t\t\tin[to[x][i]]--;\n\t\t\t\tif(!in[to[x][i]])que.push(to[x][i]);\n\t\t\t}\n\t\t}\n\t\tfor(int i=1;i<=n;i++)\n\t\t{\n\t\t\tint len=fr[i].size();\n\t\t\twrite(ans[i]),putchar(' ');\n\t\t\twrite(len),putchar(' ');\n\t\t\tfor(int j=0;j<len;j++)\n\t\t\t{\n\t\t\t\twrite(fr[i][j]),putchar(' ');\n\t\t\t}\n\t\t\tputchar('\\n');\n\t\t}\n\t}\n\telse\n\t{\n\t\tputs(\"-1\");\n\t\treturn 0;\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1636343139,
        "uid": 363687,
        "name": "hytmnt",
        "ccfLevel": 7,
        "title": "CF356D\u9898\u89e3"
    }
]
[
    {
        "content": "\u6ca1\u4eba\u53d1\u9898\u89e3\uff1f\n\n\u8fd9\u91cc\u7684\u96c6\u5408\u662f\u4e0d\u53ef\u91cd\u96c6\u5408\u3002\n\n\u9996\u5148\u770b\u5230\u8fd9\u79cd\u9009\u4e00\u4e2a\u4e0d\u80fd\u9009\u53e6\u5916\u4e00\u4e2a\u7684\uff0c\u80af\u5b9a\u662f\u8fde\u56fe\u3002\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\uff0c\u6211\u4eec\u5982\u679c\u628a\u4e24\u4e2a\u76f8\u4f3c\u7684\u8fdb\u884c\u8fde\u8fb9\u8fde\u51fa\u6765\u7684\u5fc5\u7136\u662f\u4e2a\u6811\u3002\n\n\u5177\u4f53\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u4e00\u6bb5\u5b57\u7b26\u4e32\u662f\u4e00\u6bb5\u5b57\u7b26\u4e32\u53bb\u6389\u5934\u4e4b\u540e\u76f8\u7b49\uff0c\u90a3\u4e48\u957f\u5ea6\u5fc5\u7136\u5dee\u4e00\uff0c\u5e76\u4e14\u8fd9\u4e24\u6bb5\u5b57\u7b26\u662f\u552f\u4e00\u786e\u5b9a\u7684\u3002\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u6211\u4eec\u5bf9\u4e8e `aaa` \uff0c\u90a3\u4e48\u5b83\u5728\u800c\u4e0d\u80fd\u5728\u7684\uff0c\u5e76\u4e14\u957f\u5ea6\u6bd4\u5b83\u5c0f\u7684\u5b57\u7b26\u4e32\u6709 `aa`\uff0c\u540c\u65f6\u4e5f\u53ea\u6709 `aa`\u3002\n\n\u8fd9\u5c31\u610f\u5473\u7740\u6bcf\u4e2a\u5b57\u7b26\u4e32\u6709\u4e2a\u552f\u4e00\u786e\u5b9a\u7684\u957f\u5ea6\u6bd4\u5b83\u5c0f\u7684\u4e0d\u80fd\u8fde\u7684\u5b57\u7b26\u4e32\u3002\n\n\u90a3\u4e48\u8fde\u6210\u4e00\u68f5\u6811\u4e4b\u540e\u8dd1\u72ec\u7acb\u96c6\u5c31\u53ef\u4ee5\u4e86\u3002\u8fd9\u4e1c\u897f\u53ef\u4ee5 DP\u3002\n\n\u8bbe $f_{x,0/1}$ \u8868\u793a\u4ed6\u9009\u8fd8\u662f\u4e0d\u9009\uff0c\u5c31\u662f\u6ca1\u6709\u4e0a\u53f8\u7684\u821e\u4f1a\u3002\n\n\u76f8\u4fe1\u6765\u505a\u8fd9\u9898\u7684\u90fd\u4f1a\u8fd9\u4e2a\u57fa\u7840 DP\u3002\n\n\u7136\u540e\u786e\u5b9a\u90a3\u4e2a\u7236\u4eb2\u5c31\u7528\u54c8\u5e0c\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u6ce8\u610f\u5230\u8fd9\u91cc\u54c8\u5e0c\u51b2\u7a81\u6982\u7387\u8f83\u9ad8\uff0c\u7528\u5927\u4e00\u70b9\u7684\u6a21\u6570\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n \\log n)$\u3002\n\n```cpp\n// LUOGU_RID: 96844422\n#include <bits/stdc++.h>\n#define int __int128\n#define pb push_back \n#define ll long long \nusing namespace std;\nconst int INF=2e6+5;\nconst int INFN=2e6+5;\nconst int Mod=10000000000000061;\nconst int base=233;\nint n,p[INFN],M[INFN];\nstring s1[INF];\nstruct _node_edge{\n\tint to_,next_; \n}edge[INF<<1];\nint tot,head[INF],f[INF][5],vis[INF];\nvoid add_edge(int x,int y) {\n//\tcout<<x<<\" \"<<y<<\" edge\\n\";\n\tedge[++tot]={y,head[x]};\n\thead[x]=tot;\n}\nvector <int> cnt;\nint Get(int x) {return lower_bound(cnt.begin(),cnt.end(),x)-cnt.begin()+1;}\nvoid DFS(int x,int fa) {\n\tf[x][1]=1;vis[x]=1;f[x][0]=0;\n\tfor (int i=head[x];i;i=edge[i].next_) {\n\t\tint v=edge[i].to_;\n\t\tif (v==fa) continue;\n\t\tDFS(v,x);\n\t\tf[x][0]+=max(f[v][1],f[v][0]);\n\t\tf[x][1]+=f[v][0];\n\t}\n\treturn ;\n}\nint fl=0;\nvoid solve() {\n\tll nn=n;cin>>nn;\n\tn=nn;cnt.clear();\n\tfor (int i=1;i<=n;i++) cin>>s1[i];\n\tfor (int i=1;i<=n;i++) {\n\t\tint len=s1[i].size(),ha=0;\n\t\tfor (int j=0;j<len;j++) {\n\t\t\tha=(ha*base+s1[i][j])%Mod;\n\t\t\tcnt.pb(ha);\n\t\t}\n\t}\n\t\n//\tfor (int i=1;i<=n;i++) {\n//\t\tint len=s1[i].size(),ha=0;\n//\t\tfor (int j=1;j<len;j++) {\n//\t\t\tha=(ha*base+s1[i][j])%Mod;\n//\t\t\tcnt.pb(ha);\n//\t\t}\n//\t}\n\t\n\tsort(cnt.begin(),cnt.end());\n\tcnt.erase(unique(cnt.begin(),cnt.end()),cnt.end());\n\t\n\tint len=cnt.size();\n\tfor (int j=0;j<=len;j++) p[j]=M[j]=vis[j]=0;\n//\tcout<<cnt[0]<<\" qwe\\n\";\n//\tfor (int i=1;i<=n;i++) {\n//\t\tint len=s1[i].size(),ha=0;\n//\t\tfor (int j=0;j<len;j++) {\n//\t\t\tha=(ha*base+s1[i][j])%Mod;\n//\t\t\tp[Get(ha)]=i;\n//\t\t}\n//\t}\n\n\tfor (int i=1;i<=n;i++) {\n\t\tint len=s1[i].size(),ha=0,ha1=0;\n\t\tfor (int j=0;j<len;j++) {\n\t\t\tha=(ha*base+s1[i][j])%Mod;\n\t\t\tif (j) ha1=(ha1*base+s1[i][j])%Mod;\n\t\t\tif (M[Get(ha)]) continue;\n\t\t\tM[Get(ha)]=1;\n//\t\t\tcout<<i<<\" \"<<j<<\" \"<<Get(ha1)<<\" \"<<Get(ha)<<\" \"<<ha1<<\" kewwq\\n\";\n\t\t\tint it=Get(ha1),it1=Get(ha);\n\t\t\tif (!j || !it) continue;\n\t\t\tif (cnt[it-1]!=ha1) continue;\n\t\t\tadd_edge(it,it1);\n\t\t\tadd_edge(it1,it);\n\t\t}\n\t}\n\tint res=0;\n\tfor (int i=1;i<=cnt.size();i++)\n\t\tif (!vis[i]) {DFS(i,0);res+=max(f[i][0],f[i][1]);}\n\tll ans=res;\n\tcout<<ans<<\"\\n\";\n\tfor (int i=1;i<=tot;i++) edge[i]={0,0};\n\tfor (int i=0;i<=cnt.size()+5;i++) head[i]=0;\n\ttot=0;\n\treturn ;\n}\nsigned main()\n{\n//\tfreopen(\"data.in\",\"r\",stdin);\n\tios::sync_with_stdio(false);\n\tint t=0;ll tt=0;cin>>tt;t=tt;\n\twhile (t--) {\n\t\tsolve();\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1670501213,
        "uid": 208653,
        "name": "_edge_",
        "ccfLevel": 0,
        "title": "CF856B"
    }
]
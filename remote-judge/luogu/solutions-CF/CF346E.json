[
    {
        "content": "\u672c\u849f\u84bb\u8003\u573a\u4e0a\u7684$nlog^21e9$\u7684\u505a\u6cd5\uff08\u5b98\u65b9\u6b63\u89e3\u662f$nlog$\u7684\uff0c\u4e0d\u8fc7\u601d\u8def\u5927\u81f4\u76f8\u540c\uff09\n\n\n\n\u5148\u753b\u4e00\u753b\u8df3\u7684\u8fc7\u7a0b\uff08\u6216\u8005\u5199\u4e2a\u7a0b\u5e8f\uff09\u6bd4\u5982$a=7,p=26$\n> 7 14 21 2 9 16 23 4 11 18 25 6 13 20 1 8 15 22 3 10 17 24 5 12 19 \n\n\u4f1a\u53d1\u73b0\u8def\u5f84\u4e00\u5b9a\u53ef\u4ee5\u5206\u6210\u51e0\u6bb5\uff0c\u6bcf\u4e00\u6bb5\u90fd\u662f\u4e00\u4e2a\u516c\u5dee\u4e3aa\u7684\u7b49\u5dee\u6570\u5217\n\n- 7 14 21\n- 2 9 16 23\n- 4 11 18 25\n- 6 13 20\n- 1 8 15 22\n- 3 10 17 24\n- 5 12 19\n\n\u7136\u540e\u518d\u4ed4\u7ec6\u4e00\u70b9\u8fd8\u80fd\u53d1\u73b0\u9996\u9879\u8fde\u8d77\u6765\u4e5f\u662f\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\uff0c\u516c\u5dee\u4e3a$-p\\%a$\uff0c\u6a21\u6570\u4e3a$a$\n\n\u8003\u8651\u5c06\u4f4d\u7f6e\u6bcf$a$\u4e2a\u5206\u6210\u4e00\u7ec4\uff0c\u7528$(i/a,i\\%a)$\u8868\u793a\u4f4d\u7f6e$i$\u90a3\u4e48\u8df3\u8dc3\u8def\u5f84\u5c31\u662f\uff1a\n\n- (0,7)(1,7)(2,7)\n- (0,2)(1,2)(2,2)(3,2)\n- (0,4)(1,4)(2,4)(3,4)\n- (0,6)(1,6)(2,6)\n- $\\cdots$\n\n\u7136\u540e\u53c8\u80fd\u770b\u51fa\u4e00\u4e9b\u6027\u8d28\uff1a\n\n- \u5982\u679c\u4e00\u6bb5\u8def\u5f84\u4e0d\u8db3$\\frac pa$\u4e2a\u70b9\uff0c\u5c31\u76f4\u63a5\u5ffd\u7565(\u663e\u7136\u53ea\u53ef\u80fd\u662f\u6700\u540e\u4e00\u6bb5)\n\n\u5047\u8bbe\u8fd9\u4e2a\u8def\u5f84\u53ea\u6709$k$\u4e2a\u70b9\uff0c\u90a3\u4e48\u8fd9\u6761\u8def\u5f84\u5e76\u4e0d\u4f1a\u5f71\u54cd$k+1$\u4ee5\u540e\u7684\u7ec4\u5185$dismax$\uff0c\u6240\u4ee5\u65e0\u6cd5\u7f29\u5c0f$dismax$\uff0c\u76f4\u63a5\u5ffd\u7565\n\n- \u7b2c$\\frac pa+1$\u6bb5\u7684\u5143\u7d20\u662f\u4e0d\u7528\u8003\u8651\u7684\uff08\u8fd9\u91cc\u5047\u8bbe$an>p$\uff09\n\n\u6700\u540e\u4e00\u4e2a\u7ec4\u662f\u4e0d\u5b8c\u6574\u7684(\u53ea\u6709$p\\%a$\u4e2a)\uff0c\u6240\u4ee5$dismax$\u662f\u5c0f\u4e8e\u7b49\u4e8e\u524d\u9762\u7684\u6bb5\u7684$dismax$\n\n\u6709\u4e86\u8fd9\u4e24\u4e2a\u6027\u8d28\uff0c\u4e0d\u96be\u53d1\u73b0\u6bcf\u4e00\u7ec4\u5185\u7684\u70b9\u662f\u4e00\u6a21\u4e00\u6837\u7684\uff0c\u6240\u4ee5\u53ea\u7528\u8003\u8651\u7b2c\u4e00\u7ec4\u662f\u5426\u6ee1\u8db3\u6761\u4ef6\n\n\u7531\u4e8e\u4e4b\u524d\u53d1\u73b0\u4e86\u9996\u9879\u662f\u4e00\u4e2a\u516c\u5dee\u4e3a$-p\\%a$\uff0c\u6a21$a$\u610f\u4e49\u4e0b\u7684\u7b49\u5dee\u6570\u5217\uff0c\u6240\u4ee5\u5c31\u8f6c\u5316\u6210\u4e86\u4e00\u4e2a\u6c42\u7684\u4e1c\u897f\u76f8\u540c\u800c\u89c4\u6a21\u66f4\u5c0f\u7684\u95ee\u9898\n\n$a'=a-p\\%a,p'=a$\uff0c\u95ee\u9898\u5728\u4e8e$n'$\uff0c\u5373\u8df3\u8dc3\u8def\u5f84\u5305\u542b\u51e0\u6bb5\u7b49\u5dee\u6570\u5217\n\n\u9996\u5148\u5982\u679c\u6211\u4eec\u77e5\u9053\u5305\u542b$k$\u6bb5\uff0c\u90a3\u4e48\u5143\u7d20\u603b\u4e2a\u6570=$\\frac pa\\cdot k+\\frac{(p\\%a)\\cdot k}a$\uff0c\u7b2c\u4e00\u9879\u662f\u7b97\u5927\u4f53\u8d21\u732e\uff0c\u7b2c\u4e8c\u9879\u662f\u67d0\u4e9b\u6bb5\u4f1a\u591a\u51fa\u4e00\u9879\n\n\u7136\u540e\u4e8c\u5206\u4e00\u4e0b\u5c31\u597d\u4e86\uff08\u96fe\uff09\n\n\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u5b8c\u6210\u4e86$f(a,p)\\to f(a-p\\%a,a)$\uff0c\u7136\u800c\u7c7b\u6b27\u51e0\u91cc\u5f97\u51fd\u6570\u5e94\u8be5\u662f$f(a,p)\\to f(p\\%a,a)$\uff0c~~\u4ece\u590d\u6742\u5ea6\u51fa\u53d1\u5012\u56de\u53bb\u60f3\u7684\u8bdd~~\uff0c\u628a\u8df3\u8dc3\u8fc7\u7a0b\u5012\u7740\u8df3\u56de\u6765\u548c\u539f\u95ee\u9898\u662f\u7b49\u4ef7\u7684\uff0c\u6240\u4ee5\u5b9e\u9645\u4e0a\u5c31\u662f$f(a,p)\\to f(min(a-p\\%a,p\\%a),a)$\uff0c\u590d\u6742\u5ea6\u4e3a\u7c7b\u6b27\u51fd\u6570\u7684$log1e9$\uff0c\u7136\u540e\u6211\u6bd4\u6b63\u89e3\u591a\u4e00\u4e2a\u4e8c\u5206\u7684$log$\n\n\u8fb9\u754c\u60c5\u51b5\u5c31\u662f$a\\cdot n< p$\uff0c\u5224\u4e00\u4e0b$h\\geq a$\n\n### \u4e00\u4e9b\u7ec6\u8282\n\u7531\u4e8e\u6211\u4eec\u7f29\u5c0f\u95ee\u9898\u89c4\u6a21\u548c\u8f6c\u5316\u4e3a\u5012\u7740\u8df3\u7684\u65f6\u5019\uff0c\u5b9e\u9645\u4e0a\u5728\u8fb9\u754c\u5916\u9762\u662f\u6709\u4e00\u4e2a\u70b9\u7684\uff0c\u6240\u4ee5\u8fd8\u8981\u5224$h\\geq p-a\\cdot n$\uff08\u6ce8\u610f\u539f\u95ee\u9898\u4e0d\u7528\u5224\uff0c$fst$\u53d8\u91cf\u8868\u793a\u662f\u5426\u662f\u539f\u95ee\u9898\uff09\n\n\n```cpp\nchar solve(int a, int n, int p, int h, char fst){\n    a %= p;\n    if(p-a<a) return solve(p-a,n,p,h,false); //\u5012\u7740\u8df3\n    if(1ll*n*a<p) if(!fst) return h>=a and h>=p-n*a; else return h>=a;\n\n    int A = p%a, head=1, tail=p;\n    while(head<tail){\n        int mid = head+tail >> 1;\n        ll cnt = 1ll*(p/a)*mid+(1ll*A*(mid-1))/a;\n        if(cnt<=n) head = mid+1;\n        else tail = mid;\n    }\n    return solve(a-p%a,head-2,a,h,false);\n}\n```",
        "postTime": 1611314313,
        "uid": 56825,
        "name": "oisdoaiu",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF346E \u3010Doodle Jump\u3011"
    },
    {
        "content": "\u901f\u7ffb\u4e00\u4e0b\u5b98\u65b9\u9898\u89e3\u3002\uff08\u5b57\u6bcd\u5747\u662f\u9898\u9762\u4e2d\u7684\uff0c\u4f18\u6307\u76f8\u90bb\u8ddd\u79bb\u8d8a\u5927\uff09\r\n\r\n\u6211\u4eec\u8003\u8651\u5c06\u6570\u5217\u4ee5\u8fde\u7eed\u7684\u4e0d\u8d85\u8fc7 $p$ \u7684\u6570\u5b57\u5212\u5206\uff1a\uff08\u5982 $a=5,p=23$\uff0c\u4ee5\u4e0b\u6807 $0$ \u5f00\u59cb\uff09\r\n\r\n```\r\n0  5  10  15  20\r\n2  7  12  17  22\r\n4  9  14  19\r\n1  6  11  16  21\r\n3  8  13  18\r\n```\r\n\r\n\u53ef\u4ee5\u53d1\u73b0\u65e0\u8bba\u54ea\u4e00\u884c\u8fd9\u4e00\u5217\u4e0e\u524d\u4e00\u5217\u4e4b\u95f4\u90fd\u662f\u7b49\u5dee\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u7c7b\u6bd4\u5206\u6790\u3002\u8fd8\u89c2\u5bdf\u5230\u4e24\u5217\u4e4b\u95f4\u7684\u4e0d\u540c\u884c\u603b\u662f\u5728\u8fd9\u4e24\u5217\u7b2c\u4e00\u884c\u7684\u6570\u4e4b\u95f4\u7684\uff0c\u589e\u52a0\u4e00\u884c\u76f8\u5f53\u4e8e\u5728\u533a\u95f4\u91cc\u9762\u52a0\u4e0d\u540c\u7684\u70b9\uff0c\u76f8\u90bb\u70b9\u7684\u8ddd\u79bb\u4e5f\u4f1a\u66f4\u5c0f\u3002\r\n\r\n\u89c2\u5bdf\u6700\u540e\u4e00\u5217\uff0c\u53d1\u73b0\u6570\u503c\u6bd4\u7b2c\u4e00\u884c\u6700\u540e\u4e00\u5217\u66f4\u5927\u7684\u6570\u4e00\u5b9a\u4e0d\u4f1a\u4f7f\u8ddd\u79bb\u66f4\u5927\uff08\u5373\u4e0a\u8ff0\u4f8b\u5b50 $\\ge 20$ \u4e0d\u662f\u6700\u4f18\uff09\u3002\u4f60\u53ef\u4ee5\u7406\u89e3\u4e3a\uff1a\u6700\u540e\u4e00\u5217\u4e4b\u540e\u7684\u533a\u95f4\u662f\u4ece\u524d\u9762\u51e0\u5217\u4e00\u6837\u7684\u5b8c\u6574\u533a\u95f4\u88ab\u622a\u6389\u4e86\u4e00\u90e8\u5206\uff0c\u90a3\u4e48\u60c5\u51b5\u4e00\u5b9a\u88ab\u5b8c\u6574\u533a\u95f4\u7684\u60c5\u51b5\u5305\u542b\u3002\r\n\r\n\u53c8\u56e0\u4e3a\u76f8\u5bf9\u6765\u8bf4\u884c\u8d8a\u5c11\u8d8a\u4f18\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u8003\u8651\u5012\u6570\u7b2c\u4e8c\u884c\u5230\u5012\u6570\u7b2c\u4e00\u884c\u4e4b\u95f4\u7684\u70b9\uff08$[15,20]$\uff09\u3002\u6839\u636e\u4e0a\u8ff0\u7684\u7c7b\u6bd4\u5206\u6790\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u4e24\u884c\u7b49\u4ef7\u8f6c\u5230\u7b2c\u4e00\u884c\u548c\u7b2c\u4e8c\u884c\u5904\u7406\uff08$[0,5]$\uff09\uff0c\u4f46\u662f\u8981\u6ce8\u610f\uff0c\u6700\u540e\u4e00\u4e2a\u70b9\u53ef\u80fd\u4f1a\u6b8b\u7f3a\uff08\u5982\u6700\u540e\u4e00\u4e2a\u6570\u53d6\u5230 $13$ \u5219 $18$ \u5c31\u4f1a\u6b8b\u7f3a\uff09\uff0c\u5982\u679c\u6b8b\u7f3a\u8981\u51cf\u53bb\u3002\r\n\r\n\u89c2\u5bdf\u7b2c\u4e00\u5217\uff0c\u8bbe\u7b2c $i$ \u884c\u7b2c\u4e00\u5217\u4e3a $b_i$\uff0c\u5b58\u5728\u4e00\u4e2a $b_i=(b_{i-1}+\\Delta)\\bmod a$ \u7684\u5173\u7cfb\uff0c\u56e0\u4e3a $b_1=0$\uff0c\u6240\u4ee5\u6709 $\\Delta = b_2= \\lceil \\frac{p}{a}\\rceil \\cdot a - p$\uff08\u8003\u8651\u7b2c\u4e8c\u884c\u7b2c\u4e00\u5217\u7684\u503c\u603b\u662f\u7b2c\u4e00\u884c\u6700\u540e\u4e00\u5217\u7684\u503c $+a$ \u6ea2\u51fa\u5f97\u6765\u7684\uff09\u3002\r\n\r\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a\u539f\u5148\u6570\u5217\u7684\u6700\u52a3\u60c5\u51b5\u7b49\u4ef7\u8f6c\u6210\u4ee5 $a'=\\Delta,p'=a$ \u7684\u6570\u5217\uff0c\u6709\u524d $n'=\\lfloor\\frac{a\\times n}{p}\\rfloor-[\u6700\u540e\u4e00\u4e2a\u4e0d\u80fd\u53d6\u5230]$ \u9879\uff08\u8fd9\u662f\u56e0\u4e3a\u8003\u8651\u6bcf\u4e00\u884c\u90fd\u53ea\u5bf9\u5e94\u4e00\u4e2a $p$ \u7684\u500d\u6570\uff0c\u5f53\u7136\u8fd8\u8981\u7279\u5224\u51cf\u53bb\u6700\u540e\u4e00\u4e2a\u6570\u6b8b\u7f3a\u7684\u60c5\u51b5\uff09\u7684\u5b50\u95ee\u9898\uff0c\u4f46\u662f\u53d1\u73b0\u4f1a\u591a\u51fa\u73b0\u7b2c\u4e00\u884c\u7b2c\u4e8c\u5217\u7684\u4e00\u4e2a $a$\u3002\u8003\u8651\u5f53 $a'\\times n<p'$ \u65f6\uff0c\u6570\u5217\u53ea\u6709\u4e00\u884c\u53ef\u4ee5\u76f4\u63a5\u7b97\u8d21\u732e\uff0c\u9664\u4e86\u57fa\u672c\u7684 $a'$ \u7684\u8d21\u732e\uff0c\u8fd9\u4e2a $a$ \u8fd8\u53ef\u80fd\u4f1a\u8d21\u732e $a-a'\\times n=p'-a'\\times n$\uff0c\u4e24\u8005\u53d6\u6700\u5927\u5373\u53ef\uff1b\u5f53 $a'\\times n\\ge p'$ \u65f6\uff0c\u6b64\u65f6\u6570\u5217\u6709\u591a\u884c\uff0c$a$ \u4e0d\u662f\u6700\u4f18\u3002\r\n\r\n\u8003\u8651\u65b0\u6570\u5217\u7b2c\u4e00\u884c\u6700\u540e\u4e00\u4e2a\u6570\u4e3a $x$\uff0c\u5219\u7b2c\u4e8c\u884c\u7b2c\u4e00\u4e2a\u6570\u4e3a $b=x+a'-p' \\Rightarrow b-a'=x-p'$\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5c06 $[x,p']$ \u7684\u60c5\u51b5\u7b49\u4ef7\u8f6c\u5230 $[b,a']$ \u4e0a\uff0c\u6545 $a=p'$ \u4e0d\u662f\u6700\u4f18\u7684\u3002\r\n\r\n\u4f46\u662f\u6709\u4e9b\u65f6\u5019 $a$ \u51cf\u5c11\u7684\u8fd8\u4e0d\u591f\u591a\uff0c\u8003\u8651\u6574\u4e2a\u6570\u5217\u540c\u65f6\u51cf\u53bb\u4e00\u4e2a\u6570\uff0c\u7b54\u6848\u662f\u4e0d\u53d8\u7684\u3002\u6240\u4ee5\u5982\u679c $\\Delta> \\frac{a}{2}$\uff0c\u5bf9\u6574\u4e2a\u65b0\u6570\u5217\u540c\u65f6\u51cf\u53bb\u4e00\u4e2a $p$\uff0c\u5219\u5f97\u5230 $a'=p-\\lfloor \\frac{p}{a} \\rfloor \\cdot a= p \\bmod a$\uff0c\u6b64\u65f6\u5c31\u4f1a $\\le \\frac{a}{2}$\u3002\u5f53 $a$ \u5f88\u5c0f\u65f6\uff0c\u5f88\u5bb9\u6613\u5c31\u80fd\u53d6\u5230\u7b54\u6848\uff0c\u6240\u4ee5\u590d\u6742\u5ea6\u4e3a $O(\\log_2a)$\u3002\r\n\r\n```cpp\r\n#include<bits/stdc++.h>\r\n#define int long long\r\nusing namespace std;\r\nint a,n,p,h;\r\nint f(int a,int n,int p){\r\n    if(a*n<p) return max(a,p-a*n);\r\n    int nn=a*n/p-(a*n%p<p/a*a-a);\r\n    return f(min((p+a-1)/a*a-p,p%a),nn,a);\r\n}\r\nvoid solve(){\r\n    cin>>a>>n>>p>>h;\r\n    a%=p;\r\n    if(a<=h||(a*n>p&&f(a,n,p)<=h)) cout<<\"YES\\n\";\r\n    else cout<<\"NO\\n\";\r\n}\r\nsigned main(){\r\n    ios::sync_with_stdio(0); cin.tie(0);\r\n    int t; cin>>t;\r\n    while(t--) solve();\r\n    return 0;\r\n}\r\n```\r\n\r\n\u9898\u5916\uff1a\u4f46\u662f CF \u4e0a\u6570\u636e\u4e0d\u52a0 $p \\bmod a $ \u4e5f\u80fd\u8fc7\uff0c\u5355\u7528 $\\Delta = a- p\\bmod a$ \u8dd1\u51fa\u6765\u8c8c\u4f3c\u6ca1\u6709 $\\lceil \\frac{p}{a}\\rceil \\cdot a - p$ \u6548\u679c\u597d\uff0c\u6211\u7528\u540e\u8005\u8fc7\u4e86\u539f\u672c\u5361 $p \\bmod a$ \u7684\u70b9\uff0c\u4e0d\u77e5\u9053\u662f\u4e0d\u662f\u6709\u4ec0\u4e48\u539f\u7406\u3002\r\n",
        "postTime": 1665793746,
        "uid": 186045,
        "name": "itisover",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF346E Doodle Jump"
    }
]
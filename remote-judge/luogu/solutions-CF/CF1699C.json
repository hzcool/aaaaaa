[
    {
        "content": "\u597d\u4e45\u6ca1\u6709\u6253 cf \u4e86\uff0c\u5199\u7bc7\u9898\u89e3\u3002  \r\n\r\n\u6c42\u8fc7\uff0c\u6539\u4e86\u597d\u591a\u904d\u3002\u849f\u84bb\u9898\u89e3\u5199\u7684\u5c11\uff0c\u5f88\u591a\u683c\u5f0f\u8fd8\u638c\u63e1\u4e0d\u900f\u5f7b\uff0c\u671b\u7ba1\u7406\u5458\u539f\u8c05\u3002\r\n\r\n#### \u9898\u76ee\u5927\u610f:\r\n\r\n\u7ed9\u5b9a\u4e00\u4e2a\u521d\u59cb\u5e8f\u5217\uff0c\u5305\u542b $0\\sim n-1$ \u8fd9 $n$ \u4e2a\u6570\u5b57\uff0c\u5bfb\u627e\u5b83\u7684**\u76f8\u4f3c\u5e8f\u5217**(\u540c\u6837\u5305\u542b $0\\sim n-1$ \u8fd9 $n$ \u4e2a\u6570\u5b57)\uff0c\u5b9a\u4e49\u4e24\u4e2a\u76f8\u4f3c\u5e8f\u5217\u6ee1\u8db3**\u4efb\u610f\u76f8\u540c\u533a\u95f4**\u7684**\u8865\u96c6**\u4e2d\u7684**\u6700\u5c0f\u975e\u8d1f\u6574\u6570**\u76f8\u540c\uff0c\u5373\uff1a  \r\n$$\\operatorname{mex}\\{a_l,a_{l+1}\\cdots a_r\\}=\\operatorname{mex}\\{b_l,b_{l+1}\\cdots b_r\\}$$  \r\n~~\u8be6\u60c5\u89c1 [OI_Wiki\u535a\u5f08\u8bba](https://oi-wiki.org/math/game-theory/impartial-game/)~~\u3002  \r\n\r\n\u6c42\u521d\u59cb\u5e8f\u5217\u7684\u76f8\u4f3c\u5e8f\u5217\u7684\u65b9\u6848\u6570\u3002\r\n\r\n\u9047\u5230\u9898\u76ee\uff0c\u5148\u60f3\u7b97\u6cd5\uff0c\u518d\u60f3\u7279\u6b8a\u6027\u8d28\u3002\u8fd9\u91cc\u6ca1\u6709\u660e\u663e\u7b97\u6cd5\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u6027\u8d28\u3002  \r\n\r\n**\u6027\u8d28\uff1a**\r\n\r\n- \u5f53\u4e00\u4e2a\u5e8f\u5217\u7684\u533a\u95f4 $\\begin{bmatrix}l,r\\end{bmatrix}$ \u4e2d\u542b $0\\sim k$ \u7684\u6240\u6709\u6570\u5b57\u65f6\uff0c\u53e6\u4e00\u4e2a\u5e8f\u5217\u7684\u533a\u95f4 $\\begin{bmatrix}l,r\\end{bmatrix}$ \u4e5f**\u5fc5\u987b**\u542b\u6709 $0\\sim k$ \u7684\u6240\u6709\u6570\u5b57\u3002\r\n\r\n\u8bc1\u660e\uff1a\r\n\r\n\u5f53\u4e00\u4e2a\u5e8f\u5217\u7684\u533a\u95f4 $\\begin{bmatrix}l,r\\end{bmatrix}$ \u4e2d\u542b $0\\sim k$ \u7684\u6240\u6709\u6570\u5b57\u65f6\uff08\u4ee5 $a$ \u6570\u7ec4\u6682\u4e14\u8868\u793a\u8fd9\u4e2a\u5e8f\u5217\uff09\uff0c$\\operatorname{mex}\\{a_l,a_{l+1}\\dots a_r\\}=k+1$\uff0c\u8981\u4f7f\u53e6\u4e00\u4e2a\u5e8f\u5217\u76f8\u540c\u533a\u95f4 $\\operatorname{mex}$ \u503c\u76f8\u540c\uff0c\u5fc5\u987b\u4e5f\u542b\u6709 $0$ \u5230 $k$ \u7684\u6240\u6709\u6570\u5b57\u3002  \r\n\r\n\u6839\u636e\u8fd9\u4e2a\u6027\u8d28\uff0c\u6211\u4eec\u7ee7\u7eed\u5f80\u4e0b\u63a8\u3002  \r\n\r\n\u6211\u4eec\u901a\u8fc7\u6784\u9020\u76f8\u4f3c\u5e8f\u5217\u6c42\u65b9\u6848\u6570\uff0c\u7ef4\u62a4\u76f8\u4f3c\u5e8f\u5217\u4e00\u4e2a\u533a\u95f4\u7684\u4e24\u4e2a\u7aef\u70b9 $l$ \u548c $r$\uff0c\u8fd9\u4e2a\u533a\u95f4\u5305\u542b $0\\sim k$ \u4e14\u4e24\u7aef\u4e3a $0\\sim k$ \u4e2d\u7684\u6570\u5b57\u3002  \r\n\r\n\u6211\u4eec\u627e\u5230\u521d\u59cb\u5e8f\u5217\u7684 $k+1$ \u7684\u4f4d\u7f6e\uff1a \r\n\r\n- \u5176\u4f4d\u7f6e\u82e5\u5728\u533a\u95f4\u5185\uff0c\u90a3\u4e48\u5176\u76f8\u4f3c\u5e8f\u5217\u7684 $k+1$ \u4e5f\u5728\u6b64\u533a\u95f4\u5185\uff0c\u4e14\u586b\u7684\u4f4d\u7f6e\u7684\u65b9\u6848\u6570\u4e3a\u533a\u95f4\u957f\u5ea6\u51cf\u53bb\u5df2\u7ecf\u586b\u7684\u6570\u5b57\u4e2a\u6570 $((r-l+1)-(k+1))$\u3002\r\n- \u5176\u4f4d\u7f6e\u82e5\u4e0d\u5728\u533a\u95f4\u5185\uff0c\u90a3\u4e48\u4e24\u4e2a\u5e8f\u5217\u7684 $k+1$ \u4f4d\u7f6e\u76f8\u540c\uff0c\u5e76\u6269\u5927\u7ef4\u62a4\u7684\u533a\u95f4\u5230 $k+1$ \u7684\u4f4d\u7f6e\u3002\r\n\r\n\u7b2c\u4e00\u4e2a\u5c31\u662f\u6211\u4eec\u7684\u6027\u8d28\uff0c\u7b2c\u4e8c\u4e2a\u5c0f\u8bc1\u4e00\u4e0b\uff0c\u82e5\u4e24\u4e2a\u4f4d\u7f6e\u4e0d\u540c\uff0c\u6211\u4eec\u540c\u65f6\u6309\u7167\u4e0a\u8ff0\u65b9\u5f0f\u6269\u5927\u4e24\u4e2a\u5e8f\u5217\u7684\u533a\u95f4\uff0c\u5fc5\u6709\u4e00\u4e2a\u533a\u95f4\u76f8\u8f83\u8f83\u5c0f\uff0c\u90a3\u4e48\u5c0f\u533a\u95f4\u4e0e\u5bf9\u5e94\u7684\u53e6\u4e00\u4e2a\u5e8f\u5217\u76f8\u540c\u7684\u533a\u95f4\u4e0d\u6ee1\u8db3**\u6027\u8d28**\uff0c\u6545\u4e0d\u53ef\u5b58\u5728\u3002 \r\n\r\n\u6240\u4ee5\u6211\u4eec $O(n)$ \u626b\u4e00\u904d\uff0c\u6bcf\u6b21\u4e58\u4ee5\u7b2c\u4e00\u79cd\u60c5\u51b5\u7684\u65b9\u6848\u6570\uff0c\u5373\u4e3a\u7b54\u6848\u3002\r\n\r\n```cpp\r\n#include<bits/stdc++.h>\r\n#define int long long\r\nusing namespace std;\r\nconst int maxn=1e5+1e10;\r\nconst int mod=1e9+7;\r\n \r\ninline int read()\r\n{\r\n\tint res=0,f=1;char c;\r\n\tfor(;!isdigit(c);c=getchar()) if(c=='-') f=-1;\r\n\tfor(;isdigit(c);c=getchar()) res=(res<<1)+(res<<3)+(c^48);\r\n\treturn res*f;\r\n}\r\n \r\nint T,n;\r\n \r\nsigned main()\r\n{\r\n\tT=read();\r\n\twhile(T--)\r\n\t{\r\n\t\tn=read();\r\n\t\tint a[100010],ans=1;\r\n\t\tfor(int i=1;i<=n;i++)\r\n\t\t{\r\n\t\t\tint x=read();\r\n\t\t\ta[x]=i;//\u8bb0\u5f55\u6bcf\u4e2a\u6570\u5b57\u4f4d\u7f6e\r\n\t\t}\r\n\t\tint l=min(a[0],a[1]),r=max(a[1],a[0]);\r\n\t\tfor(int i=2;i<n-1;i++)\r\n\t\t{\r\n            //\u5206\u60c5\u51b5\u8ba8\u8bba\r\n\t\t\tif(l<a[i]&&a[i]<r) ans=(ans*(r-l+1-i))%mod;\r\n\t\t\telse r=max(r,a[i]),l=min(l,a[i]);\r\n\t\t\t//cout<<l<<r<<ans<<endl;\r\n\t\t}\r\n\t\tprintf(\"%d\\n\",ans);\r\n\t}\r\n\treturn 0;\r\n}\r\n\r\n```\r\n**\u849f\u84bb\u62d9\u89c1\uff0c\u8bf7\u6307\u6559\u3002**",
        "postTime": 1656985989,
        "uid": 557385,
        "name": "cjlak1o1",
        "ccfLevel": 0,
        "title": "CF1699C The Third Problem"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF1699C)\n\n2C \u5361\u534a\u5929\uff0c\u5c0f\u4e11\u7adf\u662f\u6211\u81ea\u5df1\u3002\n\n\u9996\u5148\u8fd9\u9898\u6709\u660e\u663e\u7684\u66b4\u529b DS \u505a\u6cd5\uff0c\u53ef\u4ee5 AC\u3002\n\n\u7136\u540e\u8003\u8651\u6b63\u5e38\u505a\u6cd5\u3002\n\n\u968f\u4fbf\u89c2\u5bdf\u4e00\u4e0b\uff0c\u4f1a\u53d1\u73b0\u539f\u5e8f\u5217 $0$ \u548c $1$ \u7684\u4f4d\u7f6e\u52a8\u4e0d\u4e86\uff0c\u6613\u8bc1\u3002\n\n\u7136\u540e\u8003\u8651\u7ee7\u7eed\u5f80\u8fd9\u4e2a\u5e8f\u5217\u91cc\u653e\u6570\uff0c\u53d1\u73b0\u5047\u5982\u539f\u5e8f\u5217\u4e2d $2$ \u5939\u5728 $0$ \u548c $1$ \u4e2d\u95f4\uff0c\u90a3\u4e48\u653e\u5728\u4e2d\u95f4\u4efb\u4f55\u4f4d\u7f6e\u90fd\u53ef\u4ee5\uff0c\u8bc1\u660e\u76f4\u89c2\u3002\n\n\u5982\u679c\u4e0d\u5728 $0$ \u548c $1$ \u4e2d\u95f4\uff0c\u90a3\u5c31\u53ea\u80fd\u653e\u5728\u539f\u5e8f\u5217 $2$ \u7684\u4f4d\u7f6e\uff0c\u8bc1\u660e\u65b9\u6cd5\u8ddf\u8bc1 $0$ \u548c $1$ \u662f\u4e00\u6837\u7684\uff0c\u53ea\u9700\u5c06\u533a\u95f4 $[0,1]$ \u62bd\u8c61\u4e3a\u539f\u6765\u7684\u70b9 $0$\uff0c\u6b64\u65f6\u7684\u70b9 $2$ \u5c31\u662f\u539f\u6765\u7684\u70b9 $1$\uff0c\u5373\u53ef\u8bc1\u660e\u3002\n\n\u901a\u8fc7\u8fd9\u79cd\u62bd\u8c61\u533a\u95f4\u7684\u65b9\u5f0f\uff0c\u53ef\u4ee5\u53d1\u73b0\u5047\u5982\u524d $i-1$ \u4e2a\u70b9\u90fd\u88ab\u62bd\u8c61\u4e3a\u539f\u6765\u7684\u70b9 $0$\uff0c\u90a3\u4e48\u7b2c $i$ \u4e2a\u70b9\u5982\u679c\u5728\u533a\u95f4\u5185\u90e8\u5219\u53ef\u4ee5\u968f\u4fbf\u653e\uff0c\u5426\u5219\u53ea\u80fd\u6309\u539f\u5e8f\u5217\u653e\u3002\n\n\u7136\u540e\u8003\u8651\u8fd9\u4e2a\u533a\u95f4\u662f\u5565\u3002\u8bb0 $pos_i$ \u8868\u793a $i$ \u5728\u539f\u5e8f\u5217\u4e2d\u7684\u4f4d\u7f6e\uff0c\u800c\u5bf9\u4e8e\u5f53\u524d\u6570 $i$\uff0c\u53ea\u8981\u4e24\u8fb9\u90fd\u6709\u4e00\u4e2a\u6570\u6bd4\u5b83\u5c0f\u5c31\u53ef\u4ee5\u4e86\uff0c\u90a3\u4e48\u5bf9\u4e8e\u70b9 $i$\uff0c\u8fd9\u4e2a\u533a\u95f4\u5c31\u662f $[\\min(pos_0,pos_1,...,pos_{i-1}),\\max(pos_0,pos_1,...,pos_{i-1})]$\uff0c\u8bb0\u5f55\u8fd9\u4e2a\u533a\u95f4\u4e3a $[l_i,r_i]$\uff0c\u5982\u679c $pos_i$ \u5728\u8fd9\u4e2a\u533a\u95f4\u91cc\uff0c\u90a3\u5b83\u53ef\u653e\u7684\u4f4d\u7f6e\u5c31\u662f\u8fd9\u4e2a\u533a\u95f4\u51cf\u53bb\u524d $i-1$ \u4e2a\u5df2\u7ecf\u653e\u8fc7\u7684\u6570\uff0c\u6240\u4ee5\u5c31\u662f $r_i-l_i+1-(i-1)$\u3002\n\n\u7ebf\u6027\u6c42\u4e00\u4e0b $l_i,r_i$\uff0c\u679a\u4e3e\u6bcf\u4e2a $i$ \u6c42\u7b54\u6848\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$\u3002",
        "postTime": 1657266482,
        "uid": 93266,
        "name": "\u65ad\u6e05\u79cb",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011CF1699C The Third Problem"
    },
    {
        "content": "\u9898\u76ee\u94fe\u63a5[\uff08CF](https://codeforces.com/problemset/problem/1699/C)\uff0c[\u6d1b\u8c37\uff09](https://www.luogu.com.cn/problem/CF1699C) | \u5f3a\u70c8\u63a8\u8350[\u535a\u5ba2](https://ttzytt.com/2022/07/CF1699C/)\u4e2d\u89c2\u770b\u3002\n\n\n\u8fd9\u9898\u662f\u771f\u7684\u96be\u60f3\uff0c\u6211 cf \u7684\u9898\u89e3\u770b\u4e86\u597d\u4e45\u624d\u641e\u660e\u767d\uff08\u6211\u592a\u83dc\u4e86\uff09\u3002\n\n# \u9898\u610f\uff1a\n\u7ed9\u4f60\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u6392\u5217 $a$\uff0c\u8bf7\u4f60\u627e\u51fa\u6709\u591a\u5c11\u4e2a\u76f8\u540c\u957f\u5ea6\u7684\u6392\u5217 $b$ \u548c $a$ \u76f8\u4f3c\u3002\n\n\u5982\u679c\u5bf9\u4e8e\u6240\u6709\u533a\u95f4 $[l, r] (1 \\le l \\le r \\le n)$\uff0c\u4e0b\u9762\u7684\u6761\u4ef6\u6ee1\u8db3\uff1a\n\n$$\n\\operatorname{MEX}(a_l, a_{l + 1}, \\ldots , a_r) = \\operatorname{MEX}(b_l, b_{l + 1}, \\ldots , b_r)\n$$\n\n\u6211\u4eec\u5c31\u79f0\u6392\u5217 $a$ \u548c $b$ \u662f\u76f8\u4f3c\u7684\u3002\n\n\u5176\u4e2d $\\operatorname{MEX}$ \u5bf9\u4e8e\u6570\u7ec4 $c$ \u7684\u5b9a\u4e49\u662f\uff1a\u6700\u5c0f\u7684\uff0c\u6ca1\u6709\u51fa\u73b0\u5728 $c$ \u4e2d\u7684\u975e\u8d1f\u6574\u6570 $x$\u3002\n\n\u4f8b\u5982 $\\operatorname{MEX}([1,2,3,4,5]) = 0 \\ \\operatorname{MEX}([0,1,2,4,5]) = 3$\u3002 \n\n\u7531\u4e8e\u7b54\u6848\u53ef\u80fd\u4f1a\u5f88\u5927\uff0c\u6240\u4ee5\u8f93\u51fa\u65f6\u9700\u8981\u6253\u5370\u7b54\u6848\u6a21 $10^9 + 7$ \u7684\u7ed3\u679c\u3002\n\n# \u601d\u8def\n\u76f4\u63a5\u60f3\u7b54\u6848\u53ef\u80fd\u6bd4\u8f83\u96be\uff0c\u53ef\u4ee5\u5148\u6a21\u62df\u4e00\u4e0b\u7ed9\u51fa\u7684\u6837\u4f8b\uff0c\u5c1d\u8bd5\u6784\u9020\u51fa\u4e00\u4e9b $b$\u3002\n\n$a = [1, 3, 7, 2, 5, 0, 6, 4]$\n\n\u6211\u4eec\u4ece $0$ \u8fd9\u4e2a\u6570\u5b57\u5f00\u59cb\u8003\u8651\u6837\u4f8b\u3002\u53ef\u4ee5\u53d1\u73b0\u5728 $b$ \u4e2d\uff0c$0$ \u7684\u4f4d\u7f6e\u4e00\u5b9a\u548c $a$ \u4e2d\u7684 $0$ \u7684\u4f4d\u7f6e\u76f8\u7b49\u3002\n\n\u4e3a\u4ec0\u4e48\u5462\uff1f\u6211\u4eec\u5b9a\u4e49**\u5728 $a$ \u4e2d**\u6570\u5b57 $i$ \u51fa\u73b0\u7684\u4f4d\u7f6e\u4e3a $\\text{pos}_i$\uff0c\u6bd4\u5982 $\\text{pos}_0 = 6$ \uff08\u4e0b\u6807\u4ece $1$ \u5f00\u59cb\uff09\u3002\n\n\u8fd9\u65f6\uff0c\u9009\u62e9 $[\\text{pos}_0, \\text{pos}_0]$ \u7684\u533a\u95f4\u5bf9\u6bd4 $a$ \u548c $b$ \u7684 $\\operatorname{MEX}$ \u662f\u5426\u76f8\u7b49\uff0c\u9996\u5148\uff0c\u5728 $a$ \u4e2d\uff0c\u56e0\u4e3a $a[\\text{pos}_0] = 0$\uff0c$a$ \u7684 $\\operatorname{MEX}([\\text{pos}_0])$ \u4e00\u5b9a\u7b49\u4e8e $1$\u3002\n\n\u5982\u679c $b$ \u7684 $0$ \u7684\u4f4d\u7f6e\u88ab\u6539\u53d8\u4e86\uff0c\u90a3\u4e48\u5728 $b$ \u4e2d\uff0c\u56e0\u4e3a $a[\\text{pos}_0] > 0$\uff0c$\\operatorname{MEX}([\\text{pos}_0])$\uff0c\u5c31\u4e00\u5b9a\u7b49\u4e8e $0$ \u4e86\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u63a8\u65ad\u51fa $0$ \u7684\u4f4d\u7f6e\u662f\u4e0d\u80fd\u53d8\u7684\u3002\n\n\u6211\u4eec\u8fd8\u80fd\u63a8\u51fa\uff0c$1$ \u7684\u4f4d\u7f6e\u4e5f\u662f\u4e0d\u80fd\u6539\u53d8\u7684\u3002\n\n\u53ef\u4ee5\u8003\u8651\u4e2d $[\\text{pos}_1(1), \\text{pos}_0(6)] (1\\ 3\\ 7\\ 2\\ 5\\ 0)$ \u548c $[\\text{pos}_1 + 1, \\text{pos}_0](3\\ 7\\ 2\\ 5\\ 0)$ \u8fd9\u4e24\u4e2a\u533a\u95f4\u7684 $\\operatorname{MEX}$ \u503c\u3002\n\n\u56e0\u4e3a $1$ \u7684\u5b58\u5728\uff0c $\\operatorname{MEX}([\\text{pos}_1, \\text{pos}_0])$ \u4e00\u5b9a\u5927\u4e8e $1$\uff0c\u800c\u56e0\u4e3a\u6709 $0$ \u5e76\u4e14\u6ca1\u6709 $1$ $\\operatorname{MEX}([\\text{pos}_1 + 1, \\text{pos}_0])$ \u4e00\u5b9a\u7b49\u4e8e $1$\u3002\n\n\u67b6\u8bbe\u6211\u4eec\u5728 $b$ \u4e2d\u6539\u53d8\u4e86 $1$ \u7684\u4f4d\u7f6e\uff0c\u6bd4\u5982\u6539\u5230\u4e86 $2$\uff0c\u90a3\u4e48\u5728 $b$ \u4e2d\uff0c $\\operatorname{MEX}([\\text{pos}_1 + 1, \\text{pos}_0](1\\ 7\\ 2\\ 5\\ 0))$ \u5c31\u5927\u4e8e $1$ \u4e86\uff0c\u4e0d\u7b26\u5408 $a$ \u4e2d\u7b49\u4e8e $1$ \u7684\u60c5\u51b5\u3002\n\n---\n\n\u73b0\u5728\u8003\u8651\u80fd\u5408\u6cd5\u653e\u7f6e $2$ \u7684\u4f4d\u7f6e\u3002\u6211\u4eec\u53ef\u4ee5\u63a8\u65ad\u51fa\uff0c\u5982\u679c\u5728 $a$ \u4e2d $2 \\in (\\text{pos}_1, \\text{pos}_0)$\uff0c\u90a3\u4e48\u5728 $b$ \u4e2d\uff0c $2$ \u5c31\u53ef\u4ee5\u88ab\u653e\u5728 $(\\text{pos}_1, \\text{pos}_0)$ \u8fd9\u4e2a\u533a\u95f4\u7684\u4efb\u610f\u4f4d\u7f6e\u3002\n\n\u4e3a\u5565\u5462\uff1f\u6211\u4eec\u8bbe\u533a\u95f4 $[l, r]$ \u5728 $a$ \u4e2d\u5305\u542b $0$ \u548c $1$\uff0c\u4e5f\u5c31\u662f $l \\le \\text{pos}_1, \\text{pos}_0 \\le r$\u3002\n\n\u90a3\u56e0\u4e3a\u5728 $a$ \u4e2d $2 \\in (\\text{pos}_1, \\text{pos}_0)$\uff0ca \u4e2d\u6240\u6709 $[l, r]$ \u7684 $\\operatorname{MEX}$ \u4e00\u5b9a\u5927\u4e8e $2$ \uff08\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728 $a$ \u4e2d\uff0c\u4e00\u4e2a\u533a\u95f4\u5982\u679c\u540c\u65f6\u5305\u542b $0$ \u548c $1$\uff0c\u5c31\u4e00\u5b9a\u4f1a\u5305\u542b $2$\uff09\u3002\n\n\u540c\u65f6\uff0c\u5728 $a$ \u4e2d\uff0c\u4e0d\u7b26\u5408 $l \\le \\text{pos}_1, \\text{pos}_0 \\le r$ \u7684\u5176\u4ed6\u6240\u6709\u533a\u95f4\u7684 $\\operatorname{MEX}$ \u6700\u5927\u53ea\u6709 $1$\uff0c\uff08\u8fd9\u6837\u7684\u533a\u95f4\u6700\u591a\u5305\u542b\u4e00\u4e2a $0$\uff0c\u90a3\u4e48 $\\operatorname{MEX}$ \u5c31\u662f $1$ \u4e86\uff09\u3002\n\n\u90a3\u4e48\u5728 $b$ \u4e2d\uff0c\u53ea\u8981 $2 \\in (\\text{pos}_1, \\text{pos}_0)$\uff0c\u5c31\u80fd\u7b26\u5408 $\\operatorname{MEX}([l, r]) > 2$\u3002\u5e76\u4e14\u7b26\u5408\u5728\u4e0d\u52a8\u5176\u4ed6\u6570\u5b57\u7684\u4f4d\u7f6e\u7684\u60c5\u51b5\u4e0b $a$ \u548c $b$ \u76f8\u4f3c\u3002\n\n\u7b26\u5408\u8fd9\u6837\u7684\u4f4d\u7f6e\u4e00\u5171\u6709 $(\\text{pos}_0 - \\text{pos}_1 + 1) - 2$ \u4e2a\uff08$-2$ \u662f\u56e0\u4e3a $0$ \u548c $1$ \u5360\u7528\u4e86\u533a\u95f4\u5185\u7684\u4e24\u4e2a\u4f4d\u7f6e\uff09\u3002\n\n---\n\n\u90a3\u4e48\u5982\u679c\u5728 $a$ \u4e2d\uff0c$2 \\notin (\\text{pos}_1, \\text{pos}_0)$ \u5462\uff1f\n\n\u6bd4\u5982 $a = [1, 3, 7, 6, 0, 5, 2, 4]$\n\n\u6211\u4eec\u53ef\u4ee5\u63a8\u65ad\u51fa\uff0c\u548c\u524d\u9762\u8bb2\u7684 $0$ \u548c $1$ \u4e00\u6837\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6211\u4eec\u9700\u8981\u5728 $b$ \u4e2d\u628a $2$ \u653e\u5230\u76f8\u540c\u7684\u4f4d\u7f6e\u4e0a\u3002\n\n\u8003\u8651 $[\\text{pos}_1, \\text{pos}_2]$ \u8fd9\u4e2a\u533a\u95f4\uff0c\u5176 $\\operatorname{MEX}$ \u4e00\u5b9a\u5927\u4e8e $2$\u3002\u800c $[\\text{pos}_1, \\text{pos}_2 - 1]$ \u8fd9\u4e2a\u533a\u95f4\u7684 $\\operatorname{MEX}$ \u5c31\u4e00\u5b9a\u7b49\u4e8e $2$\uff08\u5305\u542b $0$\uff0c$1$\uff09\u3002\n\n\u5047\u8bbe\u6211\u4eec\u628a $2$ \u653e\u5230 $\\text{pos}_2 - 1$ \u4e0a\uff0c\u90a3\u4e48 $[\\text{pos}_1, \\text{pos}_2 - 1]$ \u7684 $\\operatorname{MEX}$ \u5c31\u5927\u4e8e $2$ \u4e86\u3002\n\n\u5728 $a = [1, 3, 7, 6, 5, 0, 2, 4]$ \u7684\u60c5\u51b5\u4e0b\u3002\n\n\n\u6211\u4eec\u53ef\u4ee5\u628a $3$ \u653e\u5728 $(\\text{pos}_1, \\text{pos}_2)$ \u7684\u533a\u95f4\u5185\u3002\u56e0\u4e3a\u53ea\u6709\u8fd9\u6837\uff0c\u624d\u80fd\u6ee1\u8db3\u6240\u6709\u7684 $\\operatorname{MEX}{[l, r]} > 3$\uff0c\u5176\u4e2d\uff0c$l \\le\\text{pos}_0, \\text{pos}_1, \\text{pos}_2 \\le r$\uff0c\u5e76\u4e14\u9664 $[l, r]$ \u4e4b\u5916\u7684\u6240\u6709\u533a\u95f4\uff0c$\\operatorname{MEX}$ \u90fd\u5c0f\u4e8e $3$\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728 $a$ \u4e2d\uff0c\u5982\u679c\u4e00\u4e2a\u533a\u95f4\u5305\u542b\u4e86\u6240\u6709\u6bd4 $3$ \u5c0f\u7684\u6570\uff0c\u5c31\u4e00\u5b9a\u4f1a\u5305\u542b $3$\u3002\u6216\u8005\u8bf4\uff0c\u5728 $a$ \u4e2d\uff0c\u4e0d\u53ef\u80fd\u4f1a\u6709\u4e00\u4e2a\u533a\u95f4\u7684 $\\operatorname{MEX}$ \u7b49\u4e8e $3$\uff0c\u800c\u4e3a\u4e86\u6ee1\u8db3\u8fd9\u4e00\u70b9\uff0c\u6211\u4eec\u9700\u8981\u8ba9 $3 \\in (\\text{pos}_1, \\text{pos}_2)$\u3002\n\n\u6211\u4eec\u8bbe $x$ \u4e3a $\\min{[\\text{pos}_0 \\ldots \\text{pos}_3]}$, $y$ \u4e3a $\\max{[\\text{pos}_0 \\ldots \\text{pos}_3]}$\u3002\u7b26\u5408\u4e0a\u9762 $3 \\in (\\text{pos}_1, \\text{pos}_2)$ \u6761\u4ef6\u7684\u4f4d\u7f6e\u5c31\u6709 $(y - x + 1) - 3$ \u4e2a\uff08$-3$ \u662f\u56e0\u4e3a\u533a\u95f4\u4e2d\u5df2\u7ecf\u6709 $0 \\sim 2$ \u4e86\uff09\u3002\n\n---\n\n\u73b0\u5728\u6211\u4eec\u53ef\u4ee5\u4ece\u521a\u521a\u7684\u89c2\u5bdf\u4e2d\u63a8\u5e7f\u4e00\u4e0b\u3002\u6211\u4eec\u521a\u521a\u53d1\u73b0\u5982\u679c\u5728 $a$ \u4e2d\uff0c\u4e00\u4e2a\u6570\u5728\u6240\u6709\u6bd4\u4ed6\u5c0f\u7684\u6570\u7684\u4e2d\u95f4\uff0c\u90a3\u8fd9\u4e2a\u6570\u5c31\u6709\u5f88\u591a\u4f4d\u7f6e\u53ef\u4ee5\u653e\uff0c\u76f8\u53cd\uff0c\u5982\u679c\u5728\u6240\u6709\u6bd4\u4ed6\u5c0f\u7684\u6570\u7684\u5916\u9762\uff0c\u90a3\u5c31\u53ea\u80fd\u653e\u5728\u4e00\u4e2a\u4f4d\u7f6e\u3002\n\n\u6211\u4eec\u8bbe\u6b63\u5728\u8003\u8651\u7684\u6570\u4e3a $k$\uff0c$x$ \u4e3a $\\min{[\\text{pos}_0 \\ldots \\text{pos}_k]}$\uff0c$y$ \u4e3a $\\max{[\\text{pos}_0 \\ldots \\text{pos}_k]}$\uff0c\u5982\u679c $k$ \u5728 $[x, y]$ \u8fd9\u4e2a\u533a\u95f4\u5916\u9762\uff0c\u90a3\u4e48 $k$ \u5c31\u53ea\u80fd\u653e\u5728 $\\text{pos}_k$ \u4e0a\uff0c\u5426\u5219\uff0c\u53ef\u4ee5\u9009\u62e9 $[x, y]$ \u4e2d\u4efb\u610f\u4e00\u4e2a\u6ca1\u88ab\u5360\u7528\u7684\u5730\u65b9\u653e\u7f6e\u3002\n\n\u6211\u4eec\u8bbe\u6bcf\u4e2a\u6570\u80fd\u9009\u7684\u4f4d\u7f6e\u7684\u6570\u91cf\u4e3a $d_i$\uff0c\u90a3\u4e48\u6700\u7ec8\u7684\u7b54\u6848\u5c31\u662f\u6240\u6709\u7684 $d$ \u4e58\u8d77\u6765\uff0c\u4e5f\u5c31\u662f $\\prod_{i = 0}^{n - 1}$\n# \u4ee3\u7801\n\u5728\u5177\u4f53\u5b9e\u73b0\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4ece $0$ \u5f00\u59cb~~\u4e00\u4e2a\u4e00\u4e2a~~\u7684\u8003\u8651\uff0c\u8fd9\u6837\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u786e\u5b9a\u524d\u9762\u63d0\u5230\u7684 $x$ \u548c $y$\uff0c\u4ee5\u53ca $[x,y]$ \u533a\u95f4\u5185\uff0c\u88ab\u5360\u7528\u7684\u4f4d\u7f6e\u7684\u6570\u91cf\u3002\n\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define ll long long\n// keywords:\nconst int MOD = 1e9 + 7;\nint main() {\n    int t;\n    cin >> t;\n\n    while (t--) {\n        int n;\n        cin >> n;\n        int a[n + 1];\n        int pos[n + 1];\n        for (int i = 0; i < n; i++) {\n            cin >> a[i];\n            pos[a[i]] = i;\n        }\n        ll l = pos[0], r = pos[0];\n        ll ans = 1;\n        for (int i = 1; i < n; i++) {\n            // l \u548c r \u5c31\u662f\u4e4b\u524d\u8bb2\u7684 x, y\n            if (pos[i] < l)\n                l = pos[i];\n            else if (pos[i] > r)\n                r = pos[i];\n                //\u5982\u679c\u5728 x, y \u7684\u5916\u9762\n            else\n                ans = ans * (r - l + 1 - i) % MOD;\n        }\n        cout << ans << endl;\n    }\n}\n```\n\n\u6700\u540e\uff0c\u5e0c\u671b\u8fd9\u7bc7\u9898\u89e3\u5bf9\u4f60\u6709\u5e2e\u52a9\uff0c\u5982\u679c\u6709\u95ee\u9898\u53ef\u4ee5\u901a\u8fc7\u8bc4\u8bba\u533a\u6216\u8005\u79c1\u4fe1\u8054\u7cfb\u6211\u3002",
        "postTime": 1657170103,
        "uid": 394488,
        "name": "tzyt",
        "ccfLevel": 0,
        "title": "CF1699C\u9898\u89e3"
    },
    {
        "content": "[\u957f\u6587~~\u771f\u5fc3~~\u5efa\u8bae\u524d\u5f80 blog \u4f7f\u7528](https://by505244.github.io/oi_blogs/2022/07/07/CF1699C\u9898\u89e3)\n\n### \u9898\u610f\n\n\u4f60\u73b0\u5728\u6709\u4e00\u4e2a\u5e8f\u5217 $a_1,a_2\\ldots a_n$\uff0c\u6bcf\u4e2a\u5e8f\u5217\u7684\u503c\u5747\u4e3a $0$ \u5230 $n-1$\uff08\u4e0d\u91cd\u4e0d\u6f0f\uff09\u3002\n\u6211\u4eec\u8981\u627e\u5230\u4e00\u5171\u6709\u591a\u5c11\u4e2a\u5e8f\u5217 $b_1,b_2\\ldots b_n$ \uff08$b$ \u5e8f\u5217\u6570\u503c\u8303\u56f4\u4e0e $a$ \u4e00\u81f4\uff09\u4e0e $a$ \u5e8f\u5217\u76f8\u4f3c\u3002\n\n\u76f8\u4f3c\u7684\u5b9a\u4e49\uff1a\n\n\u4ee4 $\\text{MEX}$ \u4e3a\u5176\u4e2d\u6ca1\u6709\u51fa\u73b0\u8fc7\u7684\u6700\u5c0f\u975e\u8d1f\u6574\u6570\uff08\u5982 $\\text{MEX}([1,2,3,4,5]=0,\\text{MEX}([0,1,2,4,5])=3)$\uff09\uff0c\u5219\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a $l,r(1\\le l\\le r\\le n)$ \u6ee1\u8db3\uff1a\n\n$$\\text{MEX}([{a_l,a_{l+1}\\cdots,a_r}])=\\text{MEX}([b_l,b_{l+1}\\cdots,b_r]) $$\n\n\u5219\u79f0 $a$ \u4e0e $b$ \u76f8\u4f3c\u3002\n\n\u5bf9\u7b54\u6848\u8fdb\u884c $10^9+7$ \u53d6\u6a21\u3002\n\n### \u601d\u8def\n\n\u9898\u76ee\u8bf4\u767d\u4e86\u5c31\u662f\u6c42\u5c06 $a$ \u4ea4\u6362\u4e00\u5b9a\u4e2a\u6570\u4f7f\u5f97\u4ea4\u6362\u540e\u4e0e\u4ea4\u6362\u524d\u7684\u5e8f\u5217\u76f8\u4f3c\uff08\u56e0\u4e3a\u6570\u5b57\u90fd\u4e00\u6837\uff09\u3002\n\n\u8bbe $path_x$ \u4e3a $x$ \u5728 $a_i$ \u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\u3002\n\n\uff08\u5982 $a=\\{1,3,2\\}$\uff0c$path_1=1,path_2=3,path_3=2$\uff09\n\n\u4ee4 $lp=\\min_{i=0}^{x-1}path_i,rp=\\max_{i=0}^{x-1}path_i$ \n\n\u82e5\n$$\n1\\le l\\le lp\\le path_2\\le rp\\le r\\le n\n$$\n\u56e0\u4e3a $l$ \u5230 $r$ \u7ecf\u8fc7 $0$ \u5230 $x$ \uff08\u524d\u9762\u7684\u5b9a\u4e49\u548c\u5047\u8bbe\uff01\uff09\uff0c\u6240\u4ee5\uff1a\n$$\n\\text{MEX}([a_l,a_{l+1}\\cdots,a_r])\\ge x+1\n$$\n~~\u7136\u540e\u5c31\u6ca1\u4e86~~\n\n---\n\n\u7279\u522b\u7684\uff0c\u82e5 $l>lp$ \u6216 $r<rp$\uff0c\u5219\u56e0\u4e3a $l$ \u5230 $r$ \u8fd9\u6761\u7ebf\u6bb5\u4e00\u5b9a\u672a\u8986\u76d6\u5230 $0$ \u5230 $x-1$ \u4e2d\u5176\u4e2d\u4e00\u4e2a\u6570 \uff08\u56e0\u4e3a $lp,rp$ \u5b9a\u4e49\u6446\u5728\u90a3\uff09\uff0c\u6240\u4ee5 $\\text{MEX}([a_l,a_{l+1}\\cdots a_r])\\le x$\uff0c\u5bfc\u81f4 $x$ \u7684\u4f4d\u7f6e\u53ef\u4ee5\u81ea\u7531\u79fb\u52a8\u800c\u4e0d\u5f71\u54cd $\\text{MEX}$ \u7684\u53d6\u503c\uff08\u5f53\u7136\u662f\u5728 $l>lp$ \u6216 $r<rp$ \u7684\u60c5\u51b5\u4e0b\u7684\uff09\u3002\u6240\u4ee5\u6211\u4eec\u91cd\u70b9\u8ba8\u8bba $1\\le l\\le lp\\le rp\\le r\\le n$ \u7684\u60c5\u51b5\u3002\u5373\u63a5\u4e0b\u6765 $l$ \u4e0e $r$ \u7684\u8303\u56f4\u65e0\u7279\u6b8a\u8bf4\u660e\uff0c\u9ed8\u8ba4\u662f $1\\le l\\le lq\\le rq\\le r\\le n$\u3002\n\n---\n\n\u8bbe $path_x$ \u79fb\u52a8\u540e\u7684\u6240\u5230\u8fbe\u7684\u4f4d\u7f6e\u4e3a $p$\u3002\uff08$path_x$ \u4e3a\u79fb\u52a8\u524d\u7684\u4f4d\u7f6e\uff09\n\n##### \u5f53 $lp\\le path_x\\le rp$ \u65f6\uff1a\n\n~~\u8fd9\u79cd\u5e94\u8be5\u662f\u8981\u653e\u5728\u4e2d\u95f4\u8bb2\u7684\uff0c\u4f46\u4f5c\u4e3a\u5173\u952e\u6b65\u9aa4\u63d0\u524d\u4e86\u3002~~\n\n\u7ed3\u5408\u4e0a\u5f00\u5934\u7684\u8ba8\u8bba\u3002\u53ef\u4ee5\u63a8\u5bfc\u51fa\u5982\u679c $lp\\le p\\le rp$\uff0c\u90a3\u4e48\u79fb\u52a8\u540e\u7684\u5e8f\u5217\u4e00\u5b9a\u4e0e\u79fb\u52a8\u524d\u7684\u5e8f\u5217\u76f8\u4f3c\u3002\n\n\u53cd\u4e4b\uff0c$p<lp$ \u6216 $p>rp$\uff0c\u4ea4\u6362\u540e\u7684 $\\text{MEX}([a_{lp},a_{lp+1}\\cdots a_{rp}])$ \u4e00\u5b9a\u4e0d\u7b49\u4e8e\u4ea4\u6362\u524d\u7684\u3002\n\n\u56e0\u4e3a $lp$ \u5230 $rp$ \u8986\u76d6\u5230\u4e86 $0$ \u5230 $x-1$\uff0c$x$ \u79fb\u8d70\u4e86\u4e00\u5b9a\u4f1a\u4f7f\u5f97 $\\text{MEX}$ \u503c\u53d8\u4e3a $x$\uff0c\u800c\u539f\u6765\u5f00\u5934\u7ed9\u51fa\u7684\u7ed3\u8bba\u79fb\u8d70\u524d $\\text{MEX}([a_{lp},a_{lp+1}\\cdots a_{rp}])\\ge x+1$ \u4e0d\u7b26\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e\u6bcf\u4e2a\u5728 $lp$ \u5230 $rp$ \u4e4b\u95f4\u7684\u6570\u4e00\u5171\u6709 $rp-lp+1-x$ \u79cd\u4ea4\u6362\u65b9\u6848\uff0c\u56e0\u4e3a\u5728 $lp$ \u5230 $rp$ \u4e4b\u95f4\u5df2\u7ecf\u6709 $x$ \u4e2a\u5176\u4ed6\u6570\u4e86\uff0c\u800c\u8fd9\u4e9b\u5176\u4ed6\u6570\u4e5f\u5360\u4e86\u4e00\u4e2a\u7a7a\u95f4\uff0c\u6240\u4ee5\u51cf\u53bb\u3002\n\n\u6240\u4ee5\u7b54\u6848\u518d\u4e58 $rp-lp+1-x$ \u5c31\u7ed3\u675f\u5566\uff01\n\n##### \u5f53 $path_x<lp$ \u65f6\uff1a\n\n\u4efb\u4f55\u5411\u5de6\u5411\u53f3\u7684\u79fb\u52a8\u90fd\u662f\u4e0d\u88ab\u5141\u8bb8\u7684\uff0c\u56e0\u4e3a\u90a3\u6837\u4f1a\u6539\u53d8 $\\text{MEX}$ \u7684\u53d6\u503c\u3002\n\n\u5219 $\\text{MEX}([path_x,path_x+1\\cdots n])$ \u4f1a\u5728 $p<path_x$ \u65f6\u6539\u53d8\u3002\uff08\u5373\u5de6\u79fb\uff0c$x$ \u5de6\u79fb\u8d70\u4e86\u6700\u5c0f\u975e\u8d1f\u6574\u6570\u81ea\u7136\u4e5f\u5c31\u51cf\u5c11\u4e86\uff09\n\n $\\text{MEX}([path_x+1,path_x+2\\cdots n])$ \u4f1a\u5728 $p>path_x$ \u65f6\u6539\u53d8\u3002\uff08\u5373\u53f3\u79fb\uff0c\u539f\u6765\u91cc\u9762\u6ca1\u6709 $x$\uff0c\u79fb\u8fdb\u6765\u4e86\uff0c~~\u5c31\u6709\u4e86 x~~\uff0c\u518d\u52a0\u4e0a\u91cc\u9762\u672c\u6765\u5c31\u6709 $0$ \u5230 $x-1$\uff0c\u6700\u5c0f\u975e\u8d1f\u6574\u6570\u5c31\u589e\u52a0\u4e86\uff09\n\n\u5982\u8868 \u4e24\u884c\u5206\u522b\u4ee3\u8868\u5de6\u79fb\u548c\u53f3\u79fb\uff0c\u5176\u4e2d $x=2$\u3002~~\u8868\u4ec5\u4f5c\u7ed3\u5408\u4e0a\u6587\u7406\u89e3\uff0c\u7531\u4e8e\u7bc7\u5e45\u6240\u9650\uff08\u66f4\u591a\u662f\u61d2\uff09\u4e0d\u518d\u8be6\u7ec6\u89e3\u91ca\u3002~~\n\n|      \u72b6\u6001      |      |      |      |      |      |      | $\\text{MEX}([path_x,path_x+1\\cdots n])$ | $\\text{MEX}([path_x+1,path_x+2\\cdots n])$ |\n| :------------: | :--: | :--: | :--: | :--: | :--: | :--: | :-------------------------------------: | :---------------------------------------: |\n|      \u5148\u524d      | $5$  | $2$  | $3$  | $1$  | $0$  | $4$  |                   $4$                   |                    $2$                    |\n| \u79fb\u52a8\u540e\uff08\u5de6\u79fb\uff09 | $2$  | $5$  | $3$  | $1$  | $0$  | $4$  |                   $2$                   |                    $2$                    |\n| \u79fb\u52a8\u540e\uff08\u53f3\u79fb\uff09 | $5$  | $4$  | $3$  | $1$  | $0$  | $2$  |                   $4$                   |                    $4$                    |\n\n\n\n##### \u5f53 $path_x>rp$ \u65f6\uff1a\n\n\u7c7b\u4f3c\u4e8e $path_x<lp$\uff0c\u4efb\u4f55\u5411\u5de6\u79fb\u53f3\u79fb\u90fd\u662f\u4e0d\u88ab\u5141\u8bb8\u7684\u3002~~\uff08\u8ddf\u4e0a\u9762\u63a8\u5bfc\u8fc7\u7a0b\u5f88\u50cf\u5e94\u8be5\u4e0d\u7528\u5199\u4e86\u5427\uff09~~\n\n### \u4ee3\u7801\n\n~~\u7b80\u6d01\u660e\u4e86\uff0c\u4e0e\u524d\u9762\u683c\u683c\u4e0d\u5165~~\n\n```cpp\n#define DEBUG puts(\"sto shs orz\")//\u7a81\u7136\u53d1\u73b0\u8fd9\u633a\u5bf9\u79f0\uff08\u4e0d\u662f \nconst int mod = 1e9+7;\nvoid solve(){\n\tint n;\n\tread(n);\n\tfor(int i=1;i<=n;i++){\n\t\tint x;\n\t\tread(x);\n\t\tpast[x]=i;\n\t}\n\tll ans=1;\n\tint l=0x7fffffff,r=-1;\n\tfor(int i=0;i<n;i++){\n\t\tif(past[i]>l&past[i]<r)ans=ans*(r-l+1-i)%mod;\n\t\tl=min(l,past[i]),r=max(r,past[i]);\n\t}\n\tprintf(\"%lld\\n\",ans);\n}\n```\n\n$\\text{finish}$",
        "postTime": 1657178395,
        "uid": 505244,
        "name": "linyuhuai",
        "ccfLevel": 0,
        "title": "solution-cf1699c"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF1699C)\u3002\n\n\u540c\u6b65\u53d1\u8868\u4e8e\u6211\u7684 [$\\text{cnblogs}$](https://www.cnblogs.com/UperFicial/p/16716496.html)\u3002\n\n~~\u5168\u7a0b\u624b\u73a9\u5373\u53ef\u3002~~\n\n\u89c2\u5bdf\u6837\u4f8b\uff0c\u6216\u8005\u624b\u73a9\u4e00\u4e0b\u4f1a\u53d1\u73b0\uff0c\u663e\u7136 $0$ \u548c $1$ \u7684\u4f4d\u7f6e\u662f\u56fa\u5b9a\u7684\u3002\n\n\u8003\u8651 $2$ \u53ef\u653e\u5165\u7684\u4f4d\u7f6e\uff0c\u5982\u679c\u5728\u5e8f\u5217 $a$ \u4e2d $2$ \u4f4d\u4e8e $0$ \u548c $1$ \u4e4b\u95f4\uff0c\u90a3\u4e48 $2$ \u662f\u53ef\u4ee5\u968f\u4fbf\u79fb\u52a8\u7684\uff0c\u5426\u5219 $2$ \u7684\u4f4d\u7f6e\u4f1a\u88ab\u56fa\u5b9a\u3002\u8fd9\u4e2a\u624b\u73a9\u5373\u53ef\u3002\n\n\u8fd9\u4e2a\u663e\u7136\u662f\u53ef\u4ee5\u63a8\u5e7f\u5230 $k$ \u4e2a\u6570\u7684\u3002 \n\n\u8003\u8651\u7b2c $k$ \u4e2a\u6570\uff0c\u4ee5\u53ca\u6211\u4eec\u5df2\u7ecf\u52a0\u5165\u8fc7\u5f97\u6570 $0,\\cdots,(k-1)$\uff0c\u8bbe\u5b83\u4eec\u5728\u539f\u5e8f\u5217\u7684\u4f4d\u7f6e\u5206\u522b\u4e3a $c_0,c_1,\\cdots,c_{k-1}$\uff0c\u5982\u679c $k$ \u5728\u539f\u5e8f\u5217\u4f4d\u7f6e $p\\in[\\min_{0\\le i<k} \\{c_i\\},\\max_{0\\le i<k} \\{c_i\\}]$\uff0c\u90a3\u4e48 $k$ \u662f\u53ef\u4ee5\u968f\u4fbf\u79fb\u52a8\u7684\uff0c\u5982\u679c\u5728\u5916\u9762\u7684\u8bdd\uff0c$k$ \u7684\u4f4d\u7f6e\u5c31\u88ab\u56fa\u5b9a\u4e86\u3002\n\n\u8fd9\u4e2a\u8bc1\u660e\u663e\u7136\uff0c\u5982\u679c $k$ \u5728\u5916\u9762\u7684\u8bdd\uff0c\u82e5 $k$ \u79fb\u52a8\u5230 $\\left(\\max_{0\\le i<k} \\{c_i\\}+1\\right)$ \u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u90a3\u4e48 $[\\min_{0\\le i<k} \\{c_i\\},\\max_{0\\le i<k} \\{c_i\\}+1]$ \u8fd9\u4e2a\u533a\u95f4\u7684 $\\operatorname{mex}$ \u4e3a $(k+1)$\uff0c\u5b9e\u9645\u4e0a\u5e94\u8be5\u662f $k$\u3002\n\n\u4ee3\u7801\u5b9e\u73b0\u4e5f\u5f88\u7b80\u5355\uff0c\u6211\u4eec\u53ea\u9700\u8981\u8bb0\u5f55\u4e00\u4e0b\u586b\u8fc7\u7684\u6570\u7684\u6700\u5de6\u7aef\u4f4d\u7f6e $l$\uff0c\u4ee5\u53ca\u6700\u53f3\u7aef\u4f4d\u7f6e $r$\uff0c\u5982\u679c\u76ee\u524d\u586b\u7684\u6570 $i$ \u6ee1\u8db3 $l<i<r$\uff0c\u90a3\u4e48 $i$ \u5728\u8fd9\u4e2a\u533a\u95f4\u53ef\u4ee5\u968f\u610f\u79fb\u52a8\uff0c\u4f46\u662f\u5176\u4e2d\u6709\u6211\u4eec\u586b\u8fc7\u7684 $(i-1)$ \u662f\u4e0d\u80fd\u79fb\u52a8\u7684\uff0c\u6240\u4ee5\u65b9\u6848\u6570\u4e3a $(r-l-i+1)$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n)$\u3002\n\n[\u4ee3\u7801](https://codeforces.com/contest/1699/submission/172923386)\u3002\n",
        "postTime": 1663753215,
        "uid": 360511,
        "name": "UperFicial",
        "ccfLevel": 0,
        "title": "\u9898\u89e3\u3010CF1699C The Third Problem\u3011"
    },
    {
        "content": "\u53d1\u73b0\u4e00\u4e2a\u6570\u4e0d\u662f\u56fa\u5b9a\u7684\uff0c\u5f53\u4e14\u4ec5\u5f53\u5176\u5de6\u53f3\u4e24\u8fb9\u90fd\u5b58\u5728\u6bd4\u5b83\u5c0f\u7684\u6570\u3002\n\n\u8fdb\u4e00\u6b65\u7684\uff0c\u8bb0 $i$ \u7684\u4f4d\u7f6e\u4e3a $pos_i$\uff0c\u90a3\u4e48 $i$ \u53ef\u80fd\u79fb\u52a8\u5230\u7684\u4f4d\u7f6e\u4e3a $\\min\u2061\\{pos_1,\\cdots,pos_{i\u22121}\\}+1$ \u5230 $\\max\u2061\\{pos_1,\\cdots,pos_{i\u22121}\\}-1$ \u4e2d\u6240\u6709\u4e0d\u56fa\u5b9a\u7684\u4f4d\u7f6e\uff0c\u8bb0\u4e3a $d_i$\u3002\n\n\u7136\u540e\u53d1\u73b0\u7b2c $1$ \u4e2a\u4e0d\u56fa\u5b9a\u7684\u6570\u53ef\u4ee5\u653e\u5728 $d_i$ \u4e2a\u4f4d\u7f6e\u4e0a\uff0c\u7b2c $2$ \u4e2a\u53ef\u4ee5\u653e\u5728 $d_i$ \u4e2a\u4f4d\u7f6e\u4e0a\uff08\u5bb9\u6613\u53d1\u73b0\u8fd9\u4e2a\u4f4d\u7f6e\u662f\u5305\u542b\u5173\u7cfb\uff0c\u56e0\u6b64\u6613\u8bc1\uff09\uff0c\u7b49\u7b49\u3002\n\n\u56e0\u6b64\u7b54\u6848\u5373\u4e3a $\\prod_{i=1}^{m}d_i-(i-1)$\uff0c$m$ \u4e3a\u4e0d\u56fa\u5b9a\u7684\u6570\u7684\u4e2a\u6570\u3002\n\n[code](https://codeforces.com/contest/1699/submission/162778049)",
        "postTime": 1657208675,
        "uid": 236862,
        "name": "DitaMirika",
        "ccfLevel": 7,
        "title": "CF1699C"
    },
    {
        "content": "\u524d\u6392\u63d0\u9192\uff1a\u8fd9\u662f\u672c\u9898\u6700\u70c2\u7684\u505a\u6cd5\uff0c\u4ee3\u7801\u957f\u8fbe 91 \u884c\u3002\n\n\u7531\u4e8e\u9898\u91cc\u63d0\u5230\u4e86 $\\operatorname{MEX}$\uff0c\u6240\u4ee5\u8003\u8651\u8be5\u600e\u4e48\u6c42 $\\operatorname{MEX}$\u3002\n\n\u6211\u4eec\u4f7f\u7528[\u4e3b\u5e2d\u6811](https://oi-wiki.org/ds/persistent-seg/)\u3002\u7531\u4e8e\u4e3b\u5e2d\u6811\u96be\u4ee5\u76f4\u63a5\u5904\u7406\u4e0b\u6807\u4e3a $0$ \u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u7ed9\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u503c\u90fd\u52a0\u4e0a\u4e00\u4e2a\u504f\u79fb\u91cf $1$\uff0c\u540c\u65f6\u4e0b\u6587\u63d0\u5230\u7684 $\\operatorname{MEX}$ \u4e5f\u90fd\u662f\u9898\u76ee\u91cc\u5b9a\u4e49\u7684 $\\operatorname{MEX}+1$\u3002\n\n\u4e3b\u5e2d\u6811\u8bb0\u4e0b\u533a\u95f4\u5185\u5143\u7d20\u51fa\u73b0\u7684\u6b21\u6570\u540e\uff0c\u5728\u6811\u4e0a\u5bf9\u503c\u57df\u4e8c\u5206\u3002\u5982\u679c\u5de6\u513f\u5b50\u4e2d\u5404\u5143\u7d20\u51fa\u73b0\u7684\u6b21\u6570\u5c0f\u4e8e\u5de6\u513f\u5b50\u4ee3\u8868\u7684\u503c\u57df\u533a\u95f4\u7684\u957f\u5ea6\uff0c\u5219\u8bf4\u660e\u5de6\u8fb9\u81f3\u5c11\u6709\u4e00\u4e2a\u5143\u7d20\u6ca1\u6709\u51fa\u73b0\uff0c\u56e0\u6b64 $\\operatorname{MEX}$ \u4e00\u5b9a\u5728\u5de6\u513f\u5b50\u7684\u533a\u95f4\uff0c\u5411\u5de6\u9012\u5f52\u67e5\u627e\uff0c\u5426\u5219\u5411\u53f3\u9012\u5f52\u67e5\u627e\u3002\n\n\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u4e00\u4e2a\u957f\u4e3a $len$ \u7684\u533a\u95f4 $\\operatorname{MEX}$ \u53ef\u80fd\u4e3a $len+1$ \uff0c\u9700\u8981\u8fdb\u884c\u7279\u5224\u3002\n\n\u8fd9\u662f\u4e3b\u5e2d\u6811\u90e8\u5206\u7684\u4ee3\u7801\uff1a\n```cpp\nstruct node {\n    int l, r, cnt, ls, rs;\n    int mid() { return (l + r) / 2; }\n    int len() { return r - l + 1;}\n}nd[N * 24];//N\u662f\u6570\u636e\u8303\u56f4\nint rt[N], tot;\nint build(int l, int r) {\n    int p = ++tot;\n    nd[p].l = l, nd[p].r = r;\n    if(l == r) return p;\n    int mid = (l + r) / 2;\n    nd[p].ls = build(l, mid);\n    nd[p].rs = build(mid + 1, r);\n    return p;\n}\nvoid insert(int& p, int ori, int loc) {\n    p = ++tot;\n    nd[p] = nd[ori];\n    nd[p].cnt++;\n    if(nd[p].l == nd[p].r) return;\n    if(loc <= nd[p].mid()) insert(nd[p].ls, nd[ori].ls, loc);\n    else insert(nd[p].rs, nd[ori].rs, loc);\n}\nint mex(int lp, int rp) {\n    if(nd[lp].l == nd[lp].r) {\n        if(nd[rp].cnt - nd[lp].cnt) return nd[lp].l + 1;\n        else return nd[lp].l;\n    }\n    if(nd[nd[rp].ls].cnt - nd[nd[lp].ls].cnt < nd[nd[lp].ls].len()) \n        return mex(nd[lp].ls, nd[rp].ls);\n    else \n        return mex(nd[lp].rs, nd[rp].rs);\n}\n```\n\u8fd9\u6837\uff0c\u901a\u8fc7\u8c03\u7528 `mex(rt[l-1],rt[r])` \u5c31\u53ef\u4ee5\u6c42\u51fa $\\operatorname{MEX}([a_l,a_{l+1}\\ldots a_{r-1},a_r])$ \u8fa3\uff01\n\n\u63a5\u4e0b\u6765\u8fdb\u5165\u6838\u5fc3\u505a\u6cd5\u90e8\u5206\uff1a\n\n\u9996\u5148 $1$ \u6240\u5728\u4f4d\u7f6e\u4e00\u5b9a\u4e0d\u53d8\uff0c\u5426\u5219 $b$ \u4e2d\u957f\u4e3a $1$ \u7684\u533a\u95f4\u7684 $\\operatorname{MEX}$ \u4f1a\u548c\u539f\u6392\u5217\u4e0d\u5b8c\u5168\u76f8\u540c\u3002\n\n\u5bf9\u4e8e $a$ \u4e2d\u4efb\u610f\u4e00\u4e2a\u533a\u95f4 $[l,r]$\uff0c\u5c0f\u4e8e\u5176 $\\operatorname{MEX}$ \u503c\u7684\u6240\u6709\u6570\u5b57\u90fd\u53ea\u80fd\u5728\u8be5\u533a\u95f4\u5185\u968f\u610f\u6392\u5217\u3002\u5426\u5219\u5f97\u5230\u7684\u65b0\u533a\u95f4\u7684 $\\operatorname{MEX}$ \u4f1a\u6bd4\u539f\u533a\u95f4\u5c0f\uff0c\u4e0d\u7b26\u5408\u9898\u610f\u3002\n\n\u6211\u4eec\u9501\u5b9a\u4e00\u4e2a\u533a\u95f4\uff0c\u8bbe\u5f53\u524d\u533a\u95f4\u4e3a $[l,r]$\uff0c\u5e76\u4e14\u53ea\u80fd\u5728\u5f53\u524d\u533a\u95f4\u5185\u6392\u5217\u7684\u6570\u5b57\u6240\u8d21\u732e\u7684\u65b9\u6848\u6570\u90fd\u5df2\u7ecf\u8ba1\u7b97\u5b8c\u3002\n\n\u8bbe\u5f53\u524d\u533a\u95f4\u7684 $\\operatorname{MEX}$ \u503c\u4e3a $m$\uff0c\u5bfb\u627e $m$ \u5728 $a$ \u4e2d\u7684\u4f4d\u7f6e $p$\uff0c\u82e5 $p<l$ \u5219\u5c06\u533a\u95f4 $[l,r]$ \u6269\u5f20\u5230 $[p,r]$\uff0c\u5426\u5219\u6269\u5f20\u5230 $[l,p]$\u3002\u8bbe\u65b0\u533a\u95f4\u662f $[l',r']$\u3002\n\n\u5bf9\u4e8e\u6269\u5f20\u7684\u65b0\u533a\u95f4\uff0c\u8bbe\u5b83\u7684 $\\operatorname{MEX}$ \u503c\u4e3a $m'$\uff0c\u90a3\u4e48\u5c0f\u4e8e $m'$ \u7684\u6240\u6709\u6570\u5b57\u90fd\u53ea\u80fd\u5728\u8fd9\u4e2a\u533a\u95f4\u5185\u6392\u5217\u3002\u533a\u95f4\u957f\u4e3a $r'-l'+1$\uff0c\u5176\u4e2d\u539f\u533a\u95f4 $[l,r]$ \u5df2\u7ecf\u786e\u5b9a\u4e86 $m-1$ \u4e2a\u6570\u5b57\u7684\u4f4d\u7f6e\uff0c\u53c8\u56e0\u4e3a\u6570\u5b57 $m$ \u7684\u4f4d\u7f6e\u4e0d\u80fd\u6539\u53d8\uff0c\u5219\u5bf9\u7b54\u6848\u6709\u8d21\u732e\u7684\u6570\u5b57\u5171\u6709 $m'-m-1$ \u4e2a\uff0c\u8fd9\u4e9b\u6570\u5b57\u53ef\u4ee5\u968f\u610f\u6392\u5217\u7684\u7a7a\u4f4d\u5171\u6709 $r'-l'+1-m$ \u4e2a\uff0c\u56e0\u6b64\u8fd9\u4e9b\u6570\u5b57\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e3a $P_{r'-l'+1-m}^{m'-m-1}$\uff0c\u4e58\u5230\u7b54\u6848\u4e0a\u5373\u53ef\u3002\n\n\u533a\u95f4\u6269\u5f20\u4e3a\u6574\u4e2a\u6392\u5217\u540e\u5c31\u4e0d\u80fd\u518d\u7ee7\u7eed\u4e86\uff0c\u56e0\u6b64\u8fd9\u662f\u8fed\u4ee3\u51fa\u53e3\u3002\n\n\u6b63\u786e\u6027\u53ef\u4ee5\u8fd9\u6837\u7406\u89e3\uff1a\u5982\u679c\u9009\u62e9\u5176\u4ed6\u533a\u95f4\uff0c\u5f88\u96be\u5f97\u51fa\u5173\u4e8e\u6570\u5b57\u4f4d\u7f6e\u7684\u4fe1\u606f\uff0c\u4e5f\u5c31\u96be\u4ee5\u8ba1\u7b97\u3002\u56e0\u6b64\u9009\u62e9\u4e0a\u8ff0\u6269\u5f20\u533a\u95f4\u7684\u65b9\u5f0f\uff0c\u53ef\u4ee5\u627e\u5230\u6240\u6709\u80fd\u591f\u786e\u5b9a\u4e00\u4e9b\u6570\u5b57\u7684\u4f4d\u7f6e\u7684\u533a\u95f4\uff0c\u8fdb\u800c\u8fdb\u884c\u8ba1\u7b97\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n\u6838\u5fc3\u4ee3\u7801\uff1a\n```cpp\n//P(m,n)\u7684\u4f5c\u7528\u662f\u6c42\u51fam!/(m-n)!\uff0c\u5373\u6392\u5217\u6570\n//loc[i]\u4ee3\u8868\u5143\u7d20i\u5728\u539f\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\n//mod\u5c31\u662f\u9898\u91cc\u7ed9\u7684\u6a21\u65701e9+7\n//oldmex\u5373\u4e0a\u6587\u7684m\uff0cnewmex\u5373\u4e0a\u6587\u7684m'\nll ans = 1;\nint l = loc[1], r = loc[1], oldmex = 2;\nwhile(r - l + 1 < n) {\n    if(loc[oldmex] < l) l = loc[oldmex];\n    else r = loc[oldmex];\n    int newmex = mex(rt[l - 1], rt[r]);\n    ans = ans * P(r - l + 1 - oldmex, newmex - oldmex - 1) % mod;\n    oldmex = newmex;\n}\ncout << ans << endl;\n```\n\n\u8c22\u8c22\u5927\u5bb6\u80fd\u8010\u5fc3\u770b\u5b8c\u6211\u7684\u70c2\u505a\u6cd5\uff0c\u4ee5\u4e0b\u662f\u5b8c\u6574\u4ee3\u7801\uff1a\uff08$91$ \u884c\uff09\n```cpp\n#include<bits/stdc++.h>\n#define endl '\\n'\nusing namespace std;\ntypedef long long ll;\nconstexpr int N = 1e5 + 5;\nconstexpr ll mod = 1e9 + 7;\nint n, loc[N], rt[N], tot;\nll fact[N];\nll qp(ll a, ll b) { // \u5feb\u901f\u5e42\n    ll ans = 1;\n    for(; b; b >>= 1, a = a * a % mod)\n        if(b & 1) ans = ans * a % mod;\n    return ans;\n}\nll P(ll m, ll n) { // \u6392\u5217\u6570\uff0cfact[i]\u5373i!\n    return fact[m] * qp(fact[m - n], mod - 2) % mod;\n}\nstruct node {\n    int l, r, cnt, ls, rs;\n    int mid() { return (l + r) / 2; }\n    int len() { return r - l + 1;}\n}nd[N * 24];\nint build(int l, int r) {\n    int p = ++tot;\n    nd[p].l = l, nd[p].r = r;\n    if(l == r) return p;\n    int mid = (l + r) / 2;\n    nd[p].ls = build(l, mid);\n    nd[p].rs = build(mid + 1, r);\n    return p;\n}\nvoid insert(int& p, int ori, int loc) {\n    p = ++tot;\n    nd[p] = nd[ori];\n    nd[p].cnt++;\n    if(nd[p].l == nd[p].r) return;\n    if(loc <= nd[p].mid()) insert(nd[p].ls, nd[ori].ls, loc);\n    else insert(nd[p].rs, nd[ori].rs, loc);\n}\nint mex(int lp, int rp) {\n    if(nd[lp].l == nd[lp].r) {\n        if(nd[rp].cnt - nd[lp].cnt) return nd[lp].l + 1;\n        else return nd[lp].l;\n    }\n    if(nd[nd[rp].ls].cnt - nd[nd[lp].ls].cnt < nd[nd[lp].ls].len()) \n        return mex(nd[lp].ls, nd[rp].ls);\n    else \n        return mex(nd[lp].rs, nd[rp].rs);\n}\nvoid solve() {\n    cin >> n;\n    rt[0] = build(1, n);\n    for(int i = 1; i <= n; ++i) {\n        int x; cin >> x;\n        loc[x + 1] = i;\n        insert(rt[i], rt[i - 1], x + 1);\n    }\n    if(n == 1) {\n        cout << 1 << endl;\n        return;\n    }\n    ll ans = 1;\n    int l = loc[1], r = loc[1], oldmex = 2;\n    while(r - l + 1 < n) {\n        if(loc[oldmex] < l) l = loc[oldmex];\n        else r = loc[oldmex];\n        int newmex = mex(rt[l - 1], rt[r]);\n        ans = ans * P(r - l + 1 - oldmex, newmex - oldmex - 1) % mod;\n        oldmex = newmex;\n    }\n    cout << ans << endl;\n}\nvoid clear() { // \u591a\u6d4b\u4e0d\u6e05\u7a7a\uff0c\u7206\u96f6\u4e24\u884c\u6cea\n    memset(loc + 1, 0, n * sizeof(int));\n    memset(rt, 0, (n + 1) * sizeof(int));\n    memset(nd + 1, 0, tot * sizeof(node));\n    tot = 0;\n}\nint main() {\n    ios::sync_with_stdio(0);\n    cin.tie(0), cout.tie(0);\n    fact[0] = 1;\n    for(int i = 1; i < N; ++i)\n        fact[i] = fact[i - 1] * i % mod;\n    int t; cin >> t;\n    while(t--) {\n        solve();\n        clear();\n    }\n    return 0;\n}\n```",
        "postTime": 1657175155,
        "uid": 393767,
        "name": "Untitled0",
        "ccfLevel": 5,
        "title": "CF1699C \u9898\u89e3"
    }
]
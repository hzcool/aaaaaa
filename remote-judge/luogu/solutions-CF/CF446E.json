[
    {
        "content": "@CE_WA_TLE \u628a\u8fd9\u9898\u52a0\u5f3a\u642c\u5230\u4e86\u6821\u5185\u6a21\u62df\u8d5b\u5e76\u4e14\u7528\u4e86\u4e00\u4e2a\u4e2a\u4eba\u611f\u89c9\u5f88 nb \u7684 FWT \u505a\u6cd5\uff0c\u770b\u7740\u6ca1\u4eba\u53d1\u9898\u89e3\u5c31\u6765\u5199\u4e00\u4e0b\uff0c\u5982\u6709\u9519\u8bef\u8bf7\u6307\u51fa\u3002\n\n\u9898\u610f\u5c31\u662f\u7ed9\u51fa $s_i(1\\le i \\le n)$ \u548c $t_i$ \u4ee5\u53ca $A_i(0\\le i<2^n)$\uff0c\u5176\u4e2d\u8fd9\u9898\u539f\u9898\u7684 $t_i=2^i$ \uff0c$s_i=0$\uff0c\u8fd9\u4e2a\u505a\u6cd5\u4e0d\u57fa\u4e8e\u6b64\u6761\u4ef6\u3002\n\n\u8003\u8651\u641e\u51fa\u8f6c\u79fb\u7cfb\u6570 $B_i(0\\le i < 2^n)$\u3002\n\n$s_i$ \u7684\u8d21\u732e\uff1a$B_i=B_{i\\oplus \\operatorname{lowbit(i)}}-s_{\\log_2\\operatorname{lowbit}(i)}(i>0),B_0=\\sum s_i$\u3002\n\n$t_i$ \u7684\u8d21\u732e\uff1a$B_i=\\sum_{j=0}^{\\log_2\\operatorname{lowbit}(i)}t_j$\u3002\n\n\u9898\u76ee\u5c31\u662f\u8981\u6c42 $A\\times B^d$ \u7684\u5404\u9879\u7cfb\u6570 \uff0c\u5176\u4e2d $\\times $ \u4e3a\u5f02\u6216\u5377\u79ef\uff0c\u76f4\u63a5 $\\operatorname {FWT}$ \u4e3a $\\mathcal O(n2^n)$ \u7684\uff0cTLE\u3002\n\n\u53ef\u4ee5\u89c2\u5bdf\u51fa $B_i$ \u6709\u4e00\u4e9b\u4f18\u79c0\u6027\u8d28\uff1a\n\n\u6211\u4eec\u628a\u6700\u9ad8\u4f4d\u4e3a $0$ \uff0c\u5176\u4ed6\u4f4d\u6309\u987a\u5e8f\u7684 $i$ \u5bf9\u5e94\u7684 $B_i$ \u63d0\u53d6\u51fa\u6765\u7684\u5e8f\u5217\u79f0\u4e3a $\\mathcal B_0$\uff0c$\\mathcal B_1$ \u540c\u7406\u3002\n\n\u53ef\u4ee5\u53d1\u73b0 $\\mathcal B_0-\\mathcal B_1$ \u603b\u662f\u4e3a $(x,y,y,\\cdots , y)$ \u8fd9\u79cd\u5f62\u5f0f\u3002\uff08 $s_i,t_i$ \u5bfc\u81f4\uff09\n\n\u800c\u4e14\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u5982\u679c\u5c06 $\\mathcal B_0 +\\mathcal B_1$ \u4f5c\u4e3a\u65b0\u7684 $B'$ \uff0c\u90a3\u4e48 $\\mathcal B'_0-\\mathcal B'_1$ \u4e5f\u6709\u8fd9\u4e2a\u6027\u8d28\u3002\n\n\u8bc1\u660e\u8003\u8651 $\\mathcal B'_0-\\mathcal B'_1$ \u5c31\u662f\u4e24\u4e2a $(x,y,y,\\cdots ,y)$ \u76f8\u51cf\uff0c\u90a3\u8fd8\u662f\u8fd9\u4e2a\u5f62\u5f0f\u3002\n\n\u8003\u8651\u600e\u4e48\u7b97 $A\\times B^d$\uff0c\u8003\u8651 $\\operatorname{IFWT}(\\operatorname{FWT(A)\\cdot \\operatorname{FWT(B^d)}})$ \u7684\u8fc7\u7a0b\u3002\uff08\u6b64\u5904 $\\mathcal A_0,A_1$ \u5b9a\u4e49\u4e0e $\\mathcal B_0,\\mathcal B_1$ \u7c7b\u4f3c\uff09\n$$\nA\\times B^d=(\\mathcal A_0,\\mathcal A_1)\\times (\\mathcal B_0,\\mathcal B_1)^d\\\\\n=(\\dfrac {(\\mathcal A_0+\\mathcal A_1)\\times (\\mathcal B_0+\\mathcal B_1)^d+(\\mathcal A_0-\\mathcal A_1)\\times (\\mathcal B_0-\\mathcal B_1)^d}2,\\dfrac {(\\mathcal A_0+\\mathcal A_1)\\times (\\mathcal B_0+\\mathcal B_1)^d-(\\mathcal A_0-\\mathcal A_1)\\times (\\mathcal B_0-\\mathcal B_1)^d}2)\n$$\n\u8fd9\u91cc\u9762 $(B^d)_0+(B^d)_1=(\\mathcal B_0+\\mathcal B_1)^d$ \u53ef\u4ee5 $\\operatorname{FWT}$ \u8bc1\uff0c\u51cf\u6cd5\u540c\u7406\u3002\n\n\u5176\u4e2d $(\\mathcal A_0+\\mathcal A_1)\\times (\\mathcal B_0+\\mathcal B_1)^d$ \u6bd4\u8f83\u9ebb\u70e6\uff0c\u6211\u4eec\u8003\u8651\u76f4\u63a5\u50cf\u6b63\u5e38 $\\operatorname{FWT}$ \u4e00\u6837\u9012\u5f52\u4e0b\u53bb\u7b97\u51fa\u6765\u3002\n\n\u89c2\u5bdf  $(\\mathcal A_0-\\mathcal A_1)\\times (\\mathcal B_0-\\mathcal B_1)^d$  \uff0c\u524d\u9762\u90a3\u4e2a\u5148\u76f4\u63a5 $\\mathcal O(2^k)$ \u641e\u51fa\u6765\uff0c\u8bb0\u4e3a $\\mathcal A$\u3002\uff08 $k$ \u662f\u5f53\u524d\u8fd8\u5269\u7684\u4f4d\u6570\uff09\n\n\u540e\u9762\u90a3\u4e2a\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u662f $(x,y,y,\\cdots ,y)^d$ \u8fd9\u4e2a\u6837\u5b50\u4e86\uff0c\u4f46\u662f\u8fd9\u4e2a\u975e\u5e38\u96be\u641e\uff0c\u8003\u8651\u501f\u52a9 $\\operatorname{FWT}$ \u6765\u63a8\u5012\u3002\n\n\u90a3\u4e48\u6839\u636e $A\\times B=A\\times (B+C)$ \u4ee5\u53ca $\\operatorname{FWT}(A+B)=\\operatorname{FWT}(A)+\\operatorname{FWT}(B)$ \uff0c\u6240\u4ee5\u53ef\u4ee5\u628a $(x,y,\\cdots ,y)^d$ \u62c6\u6210 $\\operatorname{IFWT}((\\operatorname{FWT}((x-y,0,\\cdots ,0))+\\operatorname{FWT}((y,y,\\cdots y)))^d)$\u3002\uff08\u6ce8\u610f\u8fd9\u91cc\u7684 $d$ \u6b21\u65b9\u662f\u70b9\u4e58\uff09\n\n\u7531\u5b9a\u4e49\u5f0f $\\operatorname{FWT}(A)_i=\\sum _j(-1)^{\\operatorname {popcount(i\\and j)}} A_j$ \u53ef\u5f97 $\\operatorname{FWT}((a,0,\\cdots ,0))=(a,a,\\cdots a)$\uff0c$\\operatorname{FWT}((a,a,\\dots a))=(2^ka,0,\\cdots ,0)$\uff0c$\\operatorname{IFWT}$ \u4e5f\u53ef\u4ee5\u63a8\u51fa\u7c7b\u4f3c\u7684\u5f0f\u5b50\u3002\n\n\u6240\u4ee5 \uff08\u6ce8\u610f\u8fd9\u4e00\u6bb5\u7684 $d$ \u6b21\u5e42\u53ef\u80fd\u6709\u70b9\u4e58\u548c\u5377\u79ef\u7684\u6df7\u6dc6\uff0c\u8bf7\u4ed4\u7ec6\u8fa8\u522b\uff09\n$$\n(x,y,\\cdots ,y)^d\\\\\n=\\operatorname{IFWT}(\\operatorname{FWT}((x,y,\\cdots ,y))^d)\\\\\n\\operatorname{FWT}((x,y,\\cdots ,y))^d=((2^ky+x-y)^d,(x-y)^d,\\cdots ,(x-y)^d)\\\\\nX=(2^ky+x-y)^d,Y=(x-y)^d\\\\\n(x,y,\\cdots ,y)^d=\\operatorname{IFWT}(X,Y,\\cdots Y)\\\\\n=\\operatorname{IFWT}(X-Y,0,\\cdots 0)+\\operatorname{IFWT}(Y,Y,\\cdots Y)\\\\\n=(2^{-k}(X-Y),2^{-k}(X-Y),\\cdots ,2^{-k}(X-Y))+(Y,0,\\cdots ,0)\\\\\n$$\n\u7136\u540e\u8fd9\u4e24\u4e2a\u4e1c\u897f\u7684\u5f02\u6216\u5377\u79ef\u76f8\u4fe1\u5927\u5bb6\u90fd\u4f1a\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5728 $\\mathcal O(2^k)$ \u590d\u6742\u5ea6\u91cc\u641e\u51fa $(\\mathcal A_0-\\mathcal A_1)\\times (\\mathcal B_0-\\mathcal B_1)$\u3002\n\n\u8ba1\u7b97\u4e00\u4e0b\u590d\u6742\u5ea6 $T(N)=T(\\dfrac N2)+\\mathcal O(N)$\uff0c\u5f97 $T(N)=\\mathcal O(N)$\u3002$N=2^n$\u3002\n\n\u6ce8\u610f $B_0$ \u5b9e\u9645\u4e0a\u5e94\u8be5\u662f $1$ \u800c\u8fd9\u91cc\u591a\u52a0\u4e86 $\\sum s_i$ \uff0c\u6240\u4ee5\u6700\u540e\u7b97\u5b8c\u7b54\u6848\u540e $\\mathcal O(N)$ \u5904\u7406\u4e00\u4e0b\u3002\uff08\u5f53\u7136\u8fd9\u9898\u539f\u9898\u4e0d\u9700\u8981\uff09\t\n\n```cpp\n// This code wrote by relatorpunch\n#include <bits/stdc++.h>\n#define rep(i,a,b) for(int i=(a);i<=(b);++i)\n#define per(i,b,a) for(int i=(b);i>=(a);--i)\ntemplate <class t> inline void read(t &s){s=0;\nsigned f=1;char c=getchar();while(!isdigit(c)){if(c=='-')f=-1;c=getchar();}\nwhile(isdigit(c))s=(s<<3)+(s<<1)+(c^48),c=getchar();;s*=f;}\ninline int lowbit(int x){return x&(-x);}\nconst int p=1051131; // Attention p = 3 * 350377\nconst int inv2=525566;\nconst int phi=700752;\nint S[30],T[30],a[1<<25],b[1<<25],n;long long D;\ninline int mylog(int x){return 31-__builtin_clz(x);}\ninline int fpow(int a,int b)\n{\n\tint ret=1;\n\tfor(;b;b>>=1,a=1LL*a*a%p)if(b&1)ret=1LL*ret*a%p;\n\treturn ret;\n}\ninline void readin()\n{\n\tint s;read(n),read(D),read(s);\n\tif(D>=phi)D=D%phi+phi;\n\tT[0]=1;\n\trep(i,1,n)T[i]=((1<<i)-(1<<~-i))%p;\n\trep(i,0,n-1)(b[0]+=S[i])>=p&&(b[0]-=p);\n\trep(i,1,(1<<n)-1)(b[i]+=b[i^lowbit(i)]+p-S[mylog(lowbit(i))])>=p&&(b[i]-=p);\n\tb[0]=1;\n\trep(i,1,n-1)(T[i]+=T[i-1])>=p&&(T[i]-=p);\n\trep(i,1,(1<<n)-1)(b[i]+=T[mylog(lowbit(i))])>=p&&(b[i]-=p);\n\trep(i,0,s-1)read(a[i]);\n\trep(i,s,(1<<n)-1)a[i]=(101LL*a[i-s]+10007)%p;\n}\ninline void fwt(int n)\n{\n\tif(n==1)return a[0]=1LL*a[0]*fpow(b[0],D)%p,void();\n\tint w=n>>1,x,y,X,Y,S=0;\n\trep(i,0,w-1)\n\t\tx=a[i],y=a[i+w],(a[i]=x+y)>=p&&(a[i]-=p),(a[i+w]=x+p-y)>=p&&(a[i+w]-=p),\n\t\tx=b[i],y=b[i+w],(b[i]=x+y)>=p&&(b[i]-=p),(b[i+w]=x+p-y)>=p&&(b[i+w]-=p);\n\tfwt(w);\n\tx=b[w],y=b[w+1],X=fpow((1LL*w*y+x-y+p)%p,D),Y=fpow((x+p-y)%p,D);\n\t(X+=p-Y)>=p&&(X-=p),X=1LL*X*fpow(inv2,mylog(w))%p;\n\trep(i,0,w-1)(S+=a[i+w])>=p&&(S-=p);\n\trep(i,0,w-1)a[i+w]=(1LL*a[i+w]*Y+1LL*S*X)%p;\n\trep(i,0,w-1)x=a[i],y=a[i+w],a[i]=1LL*(x+y)*inv2%p,a[i+w]=1LL*(x+p-y)*inv2%p;\n}\nsigned main(void)\n{\n\treadin();\n\tfwt(1<<n);\n\tunsigned int ans=0;\n\trep(i,0,(1<<n)-1)ans^=a[i];\n\tstd::printf(\"%u\\n\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1647352843,
        "uid": 51376,
        "name": "MyukiyoMekya",
        "ccfLevel": 9,
        "title": "CF446E DZY Loves Bridges \u9898\u89e3"
    }
]
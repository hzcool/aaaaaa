[
    {
        "content": "\u5f88\u5947\u602a\u7684\u4e00\u9053\u9898\uff01\n\n\u770b\u4e86\u82f1\u6587\u9898\u9762\u7136\u540e\u505a\u9519\u4e86\u3002\u3002\u3002\n\n\u82f1\u6587\u9898\u9762\u8bf4\n$\\text{If this position is not unique, he chooses the leftmost one.}$\n\n\u9009\u62e9\u6a2a\u5750\u6807\u6700\u5c0f\u7684\u70b9\u3002\n\n\u4f46\u662f\u5e94\u8be5\u4f18\u5148\u9009\u7eb5\u5750\u6807\u6700\u5c0f\uff0c\u5982\u679c\u7eb5\u5750\u6807\u76f8\u540c\u518d\u9009\u6a2a\u5750\u6807\u6700\u5c0f\u7684\u70b9\u3002\u3002\u3002\n\n\u8fd9\u662f\u4e3a\u4ec0\u4e48\u5462\uff1f\uff1f\uff1f\uff1f\uff1f\uff1f\n\n\u597d\u5427\u6b63\u786e\u601d\u8def\u5e94\u8be5\u6bd4\u8f83\u597d\u60f3\uff1a\n\n\u5148\u6c42\u51fa\u4ee5\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u4e3a\u5de6\u4e0a\u89d2\u7684\u77e9\u9635\u7684\u82b1\u8d39\uff0c\u7136\u540e\u4f7f\u7528\u4f18\u5148\u961f\u5217\u6216\u5806\uff0c\u6bcf\u4e00\u6b21\u53d6\u51fa\u82b1\u8d39\u6700\u5c0f\u7684\u70b9\u5c31\u597d\u4e86\u3002\n\n\u4f46\u662f\u5efa\u7b51\u7269\u4e0d\u53ef\u4ee5\u5efa\u5728\u5efa\u7b51\u7269\u4e0a\uff08\u5e9f\u8bdd\uff01\uff09\n\n\u6240\u4ee5\u6211\u4eec\u6bcf\u4e00\u6b21\u53d6\u51fa\u70b9$(pos_x,pos_y),$\u5c31\u7ed9\u4ee5\n\n$$(max(1,pos_x-a+1),max(1,pos_y-b+1))$$\n\n\u4e3a\u5de6\u4e0a\u89d2\u7684\u548c\u4ee5\n\n$$(pos_x+a-1,pos_y+b-1)$$\n\n\u4e3a\u53f3\u4e0b\u89d2\u7684\u77e9\u9635\u4e2d\u6bcf\u4e00\u4e2a\u70b9\u90fd\u6253\u4e0a\u4e00\u4e2a\u6807\u8bb0\u3002\u5982\u679c\u4ee5\u540e\u4ece\u5806\u4e2d\u53d6\u51fa\u7684\u70b9\u88ab\u6253\u4e0a\u4e86\u6807\u8bb0\uff0c\u5c31\u4e0d\u53ef\u4ee5\u5efa\u9020\u4e86\uff08\u5426\u5219\u4f1a\u91cd\u53e0\uff09\uff0c\u76f4\u63a5\u5f39\u51fa\u3002\uff08\u53ef\u4ee5\u753b\u753b\u56fe\u60f3\u60f3\u4e3a\u4ec0\u4e48\uff09\n\n\u5173\u4e8e\u6253\u6807\u8bb0\uff0c\u6211\u4e00\u5f00\u59cb\u60f3\u7684\u662f\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\uff0c\u4f46\u662f\u540e\u6765\u53d1\u73b0\u6bcf\u4e00\u4e2a\u70b9\u5982\u679c\u6309\u7167\u4e0a\u8ff0\u65b9\u5f0f\u64cd\u4f5c\uff0c\u6700\u591a\u53ea\u4f1a\u88ab\u6253\u4e0a\u4e24\u6b21\u6807\u8bb0\uff0c\u6240\u4ee5\u66b4\u529b\u8d4b\u503c\u5c31\u53ef\u4ee5\u4e86\u3002\n\n$AC$\u540e\u53d1\u73b0\u4e0d\u9700\u8981\u7528\u5806\uff0c\u76f4\u63a5\u6392\u4e2a\u5e8f\u5c31\u53ef\u4ee5\u4e86\u3002\u3002\u3002\u4e0d\u8fc7\u4eff\u4f5b\u5806\u8fd8\u597d\u5199\u4e00\u70b9\uff1f\uff1f\uff1f\n\n\u4f60\u95ee\u5982\u4f55\u6c42\u51fa\u6bcf\u4e00\u4e2a\u5b50\u77e9\u9635\u7684\u82b1\u8d39\uff1f\n\n\u8bbe$M$\u4e3a\u77e9\u9635\u4e2d\u6700\u5c0f\u7684\u6570\uff0c$S$\u4e3a\u77e9\u9635\u4e2d\u6240\u6709\u6570\u7684\u548c\uff0c\u53ef\u4ee5\u53d1\u73b0\u82b1\u8d39\u5c31\u7b49\u4e8e\n\n$$S-(M\\times a\\times b)$$\n\n$S$\u53ef\u4ee5\u7528\u4e8c\u7ef4\u524d\u7f00\u548c\u6c42\u51fa\uff0c$M$\u7528\u5355\u8c03\u961f\u5217[\u5c31\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u6765](https://www.luogu.org/problemnew/show/P2216)\u3002\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5$AC$\u4e86\n\n\u6211\u7684\u5b9e\u73b0\u975e\u5e38\u5947\u602a\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define ffd(x) memset(x,0,sizeof(x))\nusing namespace std;\nint a,b,n,m,xmin[1004][1004],cnt,ymin[1004][1004],hmin,tmin,dlmin[1004];\nll ans[1000003][3],aa[1004][1004];\nstruct sum{\n\tll sum[1222][1222];\n\tvoid init(int n,int m){\n\t\tfor (int i=1;i<=n;i++){\n\t\t\tfor (int j=1;j<=m;j++){\n\t\t\t\tsum[i][j]=sum[i-1][j]+sum[i][j-1]-sum[i-1][j-1]+aa[i][j];\n\t\t\t}\n\t\t}\n\t}\n\tinline ll query(int nn,int mm,int n,int m){\n\t\treturn sum[n][m]-sum[nn-1][m]-sum[n][mm-1]+sum[nn-1][mm-1];\n\t}\n}S;\ninline void check(int pos){\n    while (hmin<=tmin&&dlmin[hmin]<=pos) hmin++;\n}\ninline void addmin(int z,int xx){\n    while (hmin<=tmin&&aa[z][dlmin[tmin]]>aa[z][xx]) tmin--;\n    dlmin[++tmin]=xx;\n}\ninline ll read(){\n    ll x=0;char ch=getchar();ll f=1;\n    while (!isdigit(ch)){if (ch=='-') f=-1;ch=getchar();}\n    while (isdigit(ch)){x=(x<<1)+(x<<3)+ch-'0';ch=getchar();}\n    return x*f;\n}\npriority_queue<pair<ll,pair<ll,ll> > > dl;\n//\u5b9e\u73b0\u91c7\u7528\u4f18\u5148\u961f\u5217+pair\uff0c\u4e3b\u8981\u662f\u56e0\u4e3a\u6bd4\u8f83\u61d2\n//\u6211\u4eec\u8981\u5c0f\u6839\u5806\uff0c\u6240\u4ee5\u6211\u628a\u91cc\u9762\u6240\u6709\u7684\u6570\u90fd\u5b58\u4e86\u8d1f\u503c\nbool vis[1201][1201];\nint main(){\n    scanf(\"%d%d%d%d\",&n,&m,&a,&b);\n    for (int i=1;i<=n;i++){\n        for (int j=1;j<=m;j++){\n            aa[i][j]=read();\n        }\n    }\n    for (int i=1;i<=n\n    ;i++){\n        hmin=1;tmin=0;ffd(dlmin);\n        for (int j=1;j<=m;j++){\n            addmin(i,j);\n            if (j>=b){\n                check(j-b);\n                xmin[i][j-b+1]=aa[i][dlmin[hmin]];\n            }\n        }\n    }\n    for (int j=1;j<=m-b+1;j++){\n        hmin=1;tmin=0;ffd(dlmin);\n        for (int i=1;i<=n;i++){\n            while (hmin<=tmin&&xmin[dlmin[tmin]][j]>xmin[i][j]) tmin--;\n            dlmin[++tmin]=i;\n            if (i>=a){\n                while (hmin<=tmin&&dlmin[hmin]<=i-a) hmin++;\n                ymin[i-a+1][j]=xmin[dlmin[hmin]][j];\n            }\n        }\n    }//\u524d\u9762\u5168\u90fd\u662f\u5355\u8c03\u961f\u5217\u6c42\u6700\u5c0f\u503c\uff0c\u4e0d\u4f1a\u7684\u53ef\u4ee5\u70b9\u4e0a\u4e2a\u94fe\u63a5\n    S.init(n,m);\n    for (int i=1;i<=n-a+1;i++){\n    \tfor (int j=1;j<=m-b+1;j++){\n    \t\t//cout<<(S.query(i,j,i+a-1,j+b-1)-1LL*a*b*ymin[i][j])<<\" \"<<i<<\" \"<<j<<endl;\n    \t\tdl.push(make_pair(-(S.query(i,j,i+a-1,j+b-1)-1LL*a*b*ymin[i][j]),make_pair(-i,-j)));\n//\u6211\u4eec\u8981\u5c0f\u6839\u5806\uff0c\u6240\u4ee5\u6211\u628a\u91cc\u9762\u6240\u6709\u7684\u6570\u90fd\u5b58\u4e86\u8d1f\u503c\n\t\t}\n\t}\n\twhile (!dl.empty()){\n\t\tll ANS=-dl.top().first,posx=-dl.top().second.first,posy=-dl.top().second.second;\n\t\tdl.pop();\n\t\tif (vis[posx][posy]) continue;\n\t\tans[++cnt][0]=ANS,ans[cnt][1]=posx,ans[cnt][2]=posy;\n\t\tfor (int i=max(1LL,posx-a+1);i<=posx+a-1;i++){\n\t\t\tfor (int j=max(1LL,posy-b+1);j<=posy+b-1;j++){\n\t\t\t\tvis[i][j]=1;//\u6253\u6807\u8bb0\n\t\t\t}\t\n\t\t}\n\t}\n\tprintf(\"%d\\n\",cnt);\n\tfor (int i=1;i<=cnt;i++){\n\t\tprintf(\"%lld %lld %lld\\n\",ans[i][1],ans[i][2],ans[i][0]);\n\t}\n}\n```\n",
        "postTime": 1557310166,
        "uid": 20309,
        "name": "Fading",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF15D \u3010Map\u3011"
    },
    {
        "content": "\u5361\u5e38\u5783\u573e\u9898\u3002\n\n### \u505a\u6cd5\n\n\u7b80\u5355\u3002\n\n\u5148\u5bf9\u4e8e\u6bcf\u4e2a $(i,j)$\uff0c\u5904\u7406\u51fa $(i,j),(i,j+1)\\dots (i,j+b-1)$ \u7684 $\\min$ \u548c $\\operatorname{sum}$\u3002\u8fd9\u4e2a\u53ef\u4ee5\u7528\u5355\u8c03\u961f\u5217\uff0c\u4e5f\u53ef\u4ee5\u50cf\u6211\u4e00\u6837\u7528 `std::set` \u5e26\u4e00\u4e2a $\\log$ \u89e3\u51b3\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a $(i,j)$\uff0c\u5904\u7406\u51fa\u4ee5\u5b83\u4e3a\u5de6\u4e0a\u89d2\u7684 $a\\cdot b$ \u7684\u77e9\u5f62\u7684 $\\min$ \u548c $\\operatorname{sum}$\u3002\u5904\u7406\u65b9\u5f0f\u540c\u4e0a\u3002\n\n\u5bf9\u4e8e\u6240\u6709\u77e9\u5f62\u6392\u5e8f\uff0c\u6ce8\u610f\u6743\u503c\u76f8\u7b49\u65f6\uff0c\u8fd8\u8981\u6bd4\u8f83\u5750\u6807\u3002\u7136\u540e\u6309\u7167\u4ece\u5c0f\u5230\u5927\u987a\u5e8f\u8003\u8651\u662f\u5426\u80fd\u9009\u3002\u5047\u8bbe\u6211\u4eec\u73b0\u5728\u9009\u4e86\u4ee5 $(i,j)$ \u4e3a\u5de6\u4e0a\u89d2\u7684\u77e9\u5f62\uff0c\u90a3\u4e48\u5982\u679c\u4e00\u4e2a\u77e9\u5f62\u7684\u5de6\u4e0a\u89d2 $(i_0,j_0)$ \u6ee1\u8db3 $i-a+1\\le i_0 \\le i+a-1$ \u4e14 $j-b+1 \\le j_0 \\le j+b-1$\uff0c\u90a3\u4e48\u8fd9\u4e2a\u77e9\u9635\u5c31\u88ab\u6392\u9664\u6389\u4e86\u3002\n\n\u8fd9\u6837\u505a\u590d\u6742\u5ea6\u662f\u4e0d\u4f1a\u8d85\u7684\uff0c\u56e0\u4e3a\u6700\u591a\u53ea\u80fd\u9009 $\\frac{nm}{ab}$ \u4e2a\u77e9\u5f62\uff0c\u6bcf\u4e2a\u7528 $O(ab)$ \u7684\u65f6\u95f4\u5224\u65ad\uff0c\u6240\u4ee5\u603b\u7684\u590d\u6742\u5ea6\u662f $O(nm)$ \u7684\u3002\n\n### \u5361\u5e38\n\n\u672c\u4eba\u8ba4\u4e3a\u8fd9\u9898 2500 \u4e3b\u8981\u5728\u4e8e\u5361\u5e38\u3002\n\n$nm$ \u53ea\u6709 $10^6$\uff0c\u4f46\u662f\u8fd8\u662f\u4f1a\u88ab\u5361\u3002\n\n\u5b9e\u5728\u6ca1\u529e\u6cd5\u53ef\u4ee5\u8bd5\u8bd5\u628a `endl` \u6539\u6210 `'\\n'`\u3002\n\n\u5982\u679c\u4f60\u53ea TLE#38\uff0c\u53ef\u4ee5\u5bf9\u4e8e $a=b=1$ \u7684\u60c5\u51b5\u7279\u5224\uff1a\u76f4\u63a5\u6309\u7167 $(i,j)$ \u7684\u5347\u5e8f\u8f93\u51fa\uff0c\u6bcf\u4e2a\u4ee3\u4ef7\u90fd\u662f $0$\uff08\u56e0\u4e3a\u53ea\u6709\u4e00\u683c\uff09\u3002\n\n\u4e3a\u5565 `scanf/printf` \u8fc7\u4e0d\u4e86\u554a\uff08\u6320\u5934\n\n###Code\n\n```cpp\n/* Code by FGgirl */\n/* \u2665 FGgirl loves Frank \u2665 */\n#pragma GCC optimize(3)\n#include <bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define forr(i,a,n) for(int i=a;i<=n;++i)\n#define rep(i,n) forr(i,0,n-1)\n#define repp(i,n) forr(i,1,n)\n#define pb push_back\n#define mp make_pair\n#define init(a,i) memset(a,i,sizeof(a))\n#define fi first\n#define se second\n#define mod 1000000007\n#define MOD 998244353\n#define MAXN 0x3f3f3f3f\nint T_, case_;\nint n, m, a, b;\nll h[1010][1010];\nll mn0[1010][1010], mn[1010][1010], sum0[1010][1010], sum[1010][1010];\nvector<pair<int, int>>v, ans;\nbool cmp(pair<int, int>x, pair<int, int>y) {\n    ll c1 = sum[x.fi][x.se] - mn[x.fi][x.se] * a * b, c2 = sum[y.fi][y.se] - mn[y.fi][y.se] * a * b;\n    if (c1 != c2)return c1 < c2;\n    if (x.fi != y.fi)return x.fi < y.fi;\n    return x.se < y.se;\n}\nbool f[1010][1010];\nint x, y;\nmultiset<ll>s;\nvoid solve() {\n    cin >> n >> m >> a >> b;\n    rep(i, n)rep(j, m)cin >> h[i][j];\n    // if (a == 1 && b == 1) {\n        // cout << n * m << '\\n';\n        // rep(i, n)rep(j, m)cout << i + 1 << ' ' << j + 1 << ' ' << 0 << '\\n';\n        // return;\n    // }\n    rep(i, n) {\n        rep(j, b)sum0[i][0] += h[i][j];\n        forr(j, 1, m - b) sum0[i][j] = sum0[i][j - 1] - h[i][j - 1] + h[i][j + b - 1];\n        s.clear();\n        rep(j, b)s.insert(h[i][j]);\n        mn0[i][0] = *s.begin();\n        forr(j, 1, m - b) {\n            s.erase(s.find(h[i][j - 1]));\n            s.insert(h[i][j + b - 1]);\n            mn0[i][j] = *s.begin();\n        }\n    }\n    rep(j, m - b + 1) {\n        rep(i, a)sum[0][j] += sum0[i][j];\n        forr(i, 1, n - a) sum[i][j] = sum[i - 1][j] - sum0[i - 1][j] + sum0[i + a - 1][j];\n        s.clear();\n        rep(i, a)s.insert(mn0[i][j]);\n        mn[0][j] = *s.begin();\n        forr(i, 1, n - a) {\n            s.erase(s.find(mn0[i - 1][j]));\n            s.insert(mn0[i + a - 1][j]);\n            mn[i][j] = *s.begin();\n        }\n    }\n    rep(i, n - a + 1)rep(j, m - b + 1)v.pb(mp(i, j));\n    sort(v.begin(), v.end(), cmp);\n    rep(i, v.size()) {\n        x = v[i].fi, y = v[i].se;\n        if (f[x][y])continue;\n        ans.pb(mp(x, y));\n        forr(xx, x - a + 1, x + a - 1)forr(yy, y - b + 1, y + b - 1) {\n            if (xx >= 0 && xx < n && yy >= 0 && yy < m) {\n                f[xx][yy] = 1;\n            }\n        }\n    }\n    cout << ans.size() << '\\n';\n    rep(i, ans.size()) {\n        x = ans[i].fi, y = ans[i].se;\n        cout << x + 1 << ' ' << y + 1 << ' ' << sum[x][y] - mn[x][y] * a * b << '\\n';\n    }\n}\nint main() {\n    ios::sync_with_stdio(0);\n    cin.tie(0), cout.tie(0);\n    T_ = 1;\n\n    for (case_ = 1;case_ <= T_;case_++)solve();\n    return 0;\n}\n```",
        "postTime": 1651239835,
        "uid": 407564,
        "name": "Rushroom",
        "ccfLevel": 7,
        "title": "\u3010\u5361\u5e38\u3011CF15D Map"
    },
    {
        "content": "### $\\text{Difficulty : 2500}$\n---\n\u53d6\u683c\u5b50\u7684\u987a\u5e8f\u5e94\u8be5\u662f\u4ece\u4e0a\u5f80\u4e0b\uff0c\u4ece\u5de6\u5f80\u53f3\u3002\n\n---\n### \u89e3\u9898\u601d\u8def\uff1a\n\n\u9020\u623f\u5b50\u7684\u683c\u5b50\u662f\u56fa\u5b9a\u7684\uff0c\u6240\u4ee5\u76f4\u63a5\u9884\u5904\u7406\u51fa\u4ee5\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u4e3a\u5de6\u4e0a\u89d2\u7684\u4ee3\u4ef7\uff0c\u6392\u5e8f\u5e76\u6309\u7167\u987a\u5e8f\u5f80\u4e0b\u53d6\u5c31\u884c\u4e86\uff0c\u6ce8\u610f\u5728\u53d6\u5b8c\u8fdb\u884c\u8986\u76d6\uff0c\u4e0d\u8981\u91cd\u590d\u53d6\u5230\u540c\u4e00\u4e2a\u4f4d\u7f6e\u3002\n\n\u5bf9\u4e8e\u4ee3\u4ef7\u7684\u8ba1\u7b97\u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff0c\u603b\u548c\u548c\u6700\u5c0f\u503c\u3002\u603b\u548c\u76f4\u63a5\u7528\u4e8c\u7ef4\u524d\u7f00\u548c\u5c31\u80fd\u505a\u51fa\u6765\u4e86\uff0c\u6700\u5c0f\u503c\u5219\u76f8\u5bf9\u590d\u6742\u4e00\u70b9\u3002\n\n\u8003\u8651\u5148\u5bf9\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u7528\u5355\u8c03\u6808\u5904\u7406\u51fa\u5f53\u524d\u4f4d\u7f6e\u5230\u8fd9\u4e2a\u4f4d\u7f6e\u53f3\u8fb9 $b$ \u4e2a\u4f4d\u7f6e\u4e0a\u7684\u6700\u5c0f\u503c\uff0c\u7136\u540e\u5728\u5bf9\u5904\u7406\u4e4b\u540e\u7684\u6570\u7ec4\u518d\u8fdb\u884c\u7c7b\u4f3c\u7684\u64cd\u4f5c\uff0c\u4e5f\u5c31\u662f\u7528\u5355\u8c03\u6808\u5904\u7406\u51fa\u8fd9\u4e2a\u4f4d\u7f6e\u5728\u7b2c\u4e00\u6b21\u5904\u7406\u8fc7\u7684\u6570\u7ec4\u4e0b\u7684\u4e0b\u9762\u7684 $a$ \u4e2a\u4f4d\u7f6e\u7684\u7684\u6700\u5c0f\u503c\uff0c\u8fd9\u6837\u4e5f\u5c31\u5904\u7406\u51fa\u4e86\u53f3\u4e0b $a\\times b$ \u8303\u56f4\u4e4b\u5185\u7684\u6700\u5c0f\u503c\u3002\n\n\u6392\u5e8f\u7684\u590d\u6742\u5ea6\u662f $O(nm\\log(nm))$ \u7684\u3002\n\n\u6700\u540e\u662f\u8986\u76d6\u7684\u95ee\u9898\uff0c\u5982\u679c\u76f4\u63a5\u8986\u76d6\u548c\u67e5\u8be2\u590d\u6742\u5ea6\u7206\u70b8\uff0c\u7136\u540e\u53ef\u4ee5\u7528\u6570\u636e\u7ed3\u6784\u4f18\u5316\u4e00\u4e0b\uff08\u7ebf\u6bb5\u6811\u6216\u8005\u6811\u72b6\u6570\u7ec4\u5e94\u8be5\u90fd\u53ef\u4ee5\uff09\uff0c\u4f46\u662f\u5f88\u9ebb\u70e6\u3002\u8003\u8651\u518d\u6b21\u5229\u7528\u77e9\u9635\u56fa\u5b9a\u7684\u6027\u8d28\uff0c\u76f4\u63a5\u5c06\u6240\u6709\u7684\u4e0d\u80fd\u518d\u6b21\u4f5c\u4e3a\u5de6\u4e0a\u89d2\u7684\u70b9\u5168\u90fd\u8986\u76d6\u4e3a $1$\uff0c\u66f4\u5177\u4f53\u5730\uff0c\u4f4d\u7f6e\u662f $([x-a+1,x+a-1],[y-a+1,y+a-1])$\uff0c\u8fd9\u6837\u53ea\u8981\u53d6\u5230\u80fd\u76f4\u63a5\u5224\u65ad\uff0c\u800c\u4e14\u6bcf\u4e00\u4e2a\u70b9\u6700\u591a\u88ab\u8986\u76d6\u548c\u67e5\u8be2\u5404\u4e00\u6b21\uff0c\u8fd9\u4e00\u6b65\u7684\u590d\u6742\u5ea6\u662f $O(nm)$ \u7684\u3002\n\n---\n### \u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\n#define int long long\nstruct str{\n\tint x,y,sum;\n\tbool operator <(str a){\n\t\tif(sum==a.sum){\n\t\t\tif(x==a.x)return y<a.y;\n\t\t\treturn x<a.x;\n\t\t}\n\t\treturn sum<a.sum;\n\t}\n}p[1005*1005],ans[1005*1005];\nint n,m,a,b,h[1005][1005],l,r,q[1005],x[1005][1005],y[1005][1005],sum[1005][1005],cnt,book[1005][1005],tot;\nsigned main(){\n\tscanf(\"%I64d%I64d%I64d%I64d\",&n,&m,&a,&b);\n\tfor(int i=1;i<=n;i++)\n\tfor(int j=1;j<=m;j++)\n\tscanf(\"%I64d\",&h[i][j]);\n\tfor(int i=1;i<=n;i++){\n\t\tl=1;r=0;\n\t\tfor(int j=1;j<=m;j++){\n\t\t\twhile(h[i][q[r]]>h[i][j]&&r>=l)r--;\n\t\t\tq[++r]=j;if(j-q[l]>=b)l++;\n\t\t\tif(j>=b)x[i][j-b+1]=h[i][q[l]];\n\t\t}\n\t}\n\tfor(int j=1;j<=m;j++){\n\t\tl=1;r=0;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\twhile(x[q[r]][j]>x[i][j]&&r>=l)r--;\n\t\t\tq[++r]=i;if(i-q[l]>=a)l++;\n\t\t\tif(i>=a)y[i-a+1][j]=x[q[l]][j];\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)\n\tfor(int j=1;j<=m;j++)\n\tsum[i][j]=sum[i-1][j]+sum[i][j-1]-sum[i-1][j-1]+h[i][j];\n\t\n\tfor(int i=1;i<=n-a+1;i++)\n\tfor(int j=1;j<=m-b+1;j++){\n\t\tp[++cnt].x=i;p[cnt].y=j;\n\t\tp[cnt].sum=sum[i+a-1][j+b-1]-sum[i-1][j+b-1]-sum[i+a-1][j-1]+sum[i-1][j-1]-(a*b)*y[i][j];\n\t}\n\tsort(p+1,p+cnt+1);\n\tfor(int I=1;I<=cnt;I++){\n\t\tif(book[p[I].x][p[I].y]==1)continue;\n\t\tans[++tot]=p[I];\n\t\tfor(int i=max(1ll,p[I].x-a+1);i<=min(n,p[I].x+a-1);i++)\n\t\tfor(int j=max(1ll,p[I].y-b+1);j<=min(m,p[I].y+b-1);j++)\n\t\tbook[i][j]=1;\n\t}\n\tprintf(\"%I64d\\n\",tot);\n\tfor(int i=1;i<=tot;i++){\t\t\n\t\tprintf(\"%I64d %I64d %I64d\\n\",ans[i].x,ans[i].y,ans[i].sum);\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1648084149,
        "uid": 223559,
        "name": "qxp101",
        "ccfLevel": 6,
        "title": "CF15D Map \u9898\u89e3"
    },
    {
        "content": ">### [\u6d1b\u8c37\u9898\u76ee\u9875\u9762\u4f20\u9001\u95e8](https://www.luogu.org/problem/CF15D) & [CodeForces\u9898\u76ee\u9875\u9762\u4f20\u9001\u95e8](https://codeforces.com/contest/15/problem/D)\n\n>\u9898\u610f\u89c1\u6d1b\u8c37\u91cc\u7684\u7ffb\u8bd1\u3002\uff08\u6ce8\u610f\u7ffb\u8bd1\u91cc\u6709\u9519\u8bef\uff0c\u5e94\u8be5\u662f\u4f18\u5148\u9009\u4e0a\u9762\u7684\u77e9\u9635\uff0c\u5728\u540c\u4e00\u884c\u7684\u4f18\u5148\u9009\u5de6\u8fb9\u7684\u77e9\u9635\uff09\n\n~~\u8fd9\u9898\u4e00\u770b\u5c31\u4f1a\u505a\u554a~~\n\n\uff08\u4ee5\u4e0b\u8bbe\u5927\u77e9\u9635\u662f$n\\times m$\uff0c\u5c0f\u77e9\u9635\u662f$n0\\times m0$\uff0c\u7b2c$i$\u884c\u7b2c$j$\u5217\u9ad8\u5ea6\u4e3a$a_{i,j}$\uff09\n\n\u4e0d\u96be\u60f3\u5230\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u4e8c\u7ef4\u524d\u7f00\u548c\u6570\u7ec4$Sum$\uff0c\u540e\u9762\u5c31\u53ef\u4ee5$\\mathrm{O}(1)$\u6c42\u51fa\u4e00\u4e2a\u5c0f\u77e9\u9635\u7684\u548c\uff1b\u7136\u540e\u8dd1$2$\u904d\u5355\u8c03\u961f\u5217\uff0c\u7b2c$1$\u6b21\u6c42\u51fa$\\forall i\\in[1,n],\\forall j\\in[1,m-m0+1],mn1_{i,j}=\\min\\limits_{k=j}^{j+m0-1}\\{a_{i,k}\\}$\uff0c\u7b2c\u4e8c\u6b21\u6c42\u51fa$\\forall i\\in[1,n-n0+1],\\forall j\\in[1,m-m0+1],mn2_{i,j}=\\min\\limits_{k=i}^{k+n0-1}\\left\\{\\min\\limits_{o=j}^{j+m0-1}\\{a_{k,o}\\}\\right\\}=\\min\\limits_{k=i}^{k+n0-1}\\{mn1_{k,j}\\}$\u3002\u90a3\u4e48\u4e00\u4e2a\u5de6\u4e0a\u89d2\u5728$(i,j)$\u7684\u5c0f\u77e9\u9635\u7684\u82b1\u8d39~~\u663e\u7136~~\u662f$Sum_{i+n0-1,j+m0-1}-Sum_{i-1,j+m0-1}-Sum_{i+n0-1,j-1}+Sum_{i-1,j-1}-n0\\times m0\\times mn2_{i,j}$\u4e86\u3002\u7136\u540e\u628a\u6240\u6709\u5c0f\u77e9\u9635\u6392\u4e2a\u5e8f\uff0c\u4ece\u5934\u5230\u5c3e\u626b\u4e00\u904d\uff0c\u5982\u679c\u4e00\u4e2a\u5c0f\u77e9\u9635\u4e2d\u6709\u5df2\u7ecf\u88ab\u6807\u8bb0\u7684\u683c\u5b50\u4e86\uff0c\u5c31\u4e0d\u9009\uff1b\u5426\u5219\u5c31\u9009\uff0c\u5e76\u4e14\u628a\u5b83\u6240\u8986\u76d6\u7684\u683c\u5b50\u90fd\u6807\u8bb0\u4e00\u4e0b\u3002\u4f46\u8fd9\u6837\u4f1aTLE\u3002~~\u4e0d\u96be\u60f3\u5230\uff0c~~\u5224\u4e00\u4e2a\u5c0f\u77e9\u9635\u6709\u6ca1\u6709\u88ab\u6807\u8bb0\u8fc7\u7684\u683c\u5b50\uff0c\u53ea\u9700\u8981\u5224\u56db\u4e2a\u89d2\u5c31\u53ef\u4ee5\u4e86\uff0c\u8fd9\u6837\u5224\u7684\u65f6\u95f4\u603b\u5171\u5c31\u662f$\\mathrm{O}(nm)$\u4e86\uff1b\u800c\u6bcf\u4e2a\u683c\u5b50\u6700\u591a\u4f1a\u88ab\u6807\u8bb0\u4e00\u6b21\uff0c\u6240\u4ee5\u6807\u8bb0\u603b\u5171\u4e5f\u662f$\\mathrm{O}(nm)$\uff0c\u8fd9\u6837\u5c31\u4e0d\u4f1aTLE\u4e86\u3002~~\uff08\u6216\u8005\u4f60\u7528\u6811\u72b6\u6570\u7ec4\u3001\u7ebf\u6bb5\u6811\u6216\u5176\u4ed6\u4e00\u4e9b\u66f4\u9ad8\u7ea7\u7684\u6570\u636e\u7ed3\u6784\u6211\u4e5f\u4e0d\u62e6\u4f60\uff09~~\n\n\u5bf9\u4e86\uff0c\u8fd9\u9898\u975e\u5e38\u7684\u5361\u5e38\u3002\u6211\u7b2c\u4e00\u6b21\u4ea4\uff0cT\u4e86\u3002\u7136\u540e\u52a0\u4e86\u4e2a\u5feb\u8bfb\uff0c\u8fd8\u662fT\u4e86\u3002\u7136\u540e\u628a\u6240\u6709`int`\u6539\u6210`register int`\uff0c\u8fd8\u662fT\u4e86\u3002\u6700\u540e\u6211\u53d1\u73b0\uff0c\u539f\u6765\u8ba1\u7b97\u4e00\u4e2a\u5c0f\u77e9\u9635\u7684\u82b1\u8d39\u867d\u7136$\\mathrm{O}(1)$\uff0c\u4f46\u662f\u5e38\u6570\u7565\u5927\uff0c\u800c\u6211\u5374\u628a\u5b83\u653e\u5728`sort`\u7684`cmp`\u91cc\u8ba1\u7b97\uff0c\u7b49\u4e8e\u5728\u6269\u5927\u8ba1\u7b97\u82b1\u8d39\u7684\u5e38\u6570~~\uff08\u4f17\u6240\u5468\u77e5\uff0c\u5feb\u6392\u91cc\u4e00\u4e2a\u5143\u7d20\u53ef\u80fd\u548c\u591a\u4e2a\u5143\u7d20\u6bd4\u8f83\uff09~~\u3002\u4e8e\u662f\u6211\u4e8b\u5148\u8ba1\u7b97\u6240\u6709\u5c0f\u77e9\u9635\u7684\u82b1\u8d39\uff0c\u7136\u540e\u5b58\u4e0b\u6765\uff0c`cmp`\u7684\u65f6\u5019\u76f4\u63a5\u8c03\u7528\uff0c\u7136\u540e\u5c31AC\u4e86\u3002\n\n\u4e0b\u9762\u8d34\u4e0a\u849f\u84bb~~\u53c8\u957f\u53c8\u4e11\u7684~~\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define pb push_back\n#define mp make_pair\n#define X first\n#define Y second\n#define ri register int//\u5475\u5475 \nvoid read(int &x){//\u5feb\u8bfb \n\tx=0;char c=getchar();\n\twhile(!isdigit(c))c=getchar();\n\twhile(isdigit(c))x=(x<<3)+(x<<1)+(c^48),c=getchar();\n}\nconst int N=1000,M=1000;\nint n,m/*\u5927\u77e9\u9635\u7684\u5c3a\u5bf8*/,n0,m0/*\u5c0f\u77e9\u9635\u7684\u5c3a\u5bf8*/;\nint a[N+1][M+1];//\u9ad8\u5ea6 \nint Sum[N+1][M+1];//\u4e8c\u7ef4\u524d\u7f00\u548c \nint q[N],head,tail;//\u5355\u8c03\u961f\u5217 \nint mn1[N+1][M+1]/*\u4e00\u7ef4\u6700\u5c0f\u503c*/,mn2[N+1][M+1]/*\u4e8c\u7ef4\u6700\u5c0f\u503c*/;\nvector<pair<int,int> > ord;//\u5c0f\u77e9\u9635\u8bbf\u95ee\u987a\u5e8f \nint cst[N+1][M+1];//\u5c0f\u77e9\u9635\u7684\u82b1\u8d39 \nint calc_cst(int x,int y){//\u8ba1\u7b97\u5de6\u4e0a\u89d2\u5728(x,y)\u7684\u5c0f\u77e9\u9635\u7684\u82b1\u8d39 \n\treturn Sum[x+n0-1][y+m0-1]-Sum[x-1][y+m0-1]-Sum[x+n0-1][y-1]+Sum[x-1][y-1]-n0*m0*mn2[x][y];\n}\nbool cmp(pair<int,int> x,pair<int,int> y){//\u6392\u5e8f\u65b9\u5f0f\uff0c\u4ee5\u82b1\u8d39\u4e3a\u7b2c\u4e00\u5173\u952e\u5b57\u4ece\u5c0f\u5230\u5927\u3001\u884c\u6570\u4e3a\u7b2c\u4e8c\u5173\u952e\u5b57\u4ece\u5c0f\u5230\u5927\u3001\u5217\u6570\u4e3a\u7b2c\u4e09\u5173\u952e\u5b57\u4ece\u5c0f\u5230\u5927\u6392\u5e8f \n\treturn cst[x.X][x.Y]!=cst[y.X][y.Y]?cst[x.X][x.Y]<cst[y.X][y.Y]:x.X!=y.X?x.X<y.X:x.Y<y.Y;\n}\nbool vis[N+1][M+1];//\u6807\u8bb0 \nsigned main(){\n//\tfreopen(\"C:\\\\Users\\\\chenx\\\\OneDrive\\\\\u684c\u9762\\\\data.in\",\"r\",stdin);\n\tread(n);read(m);read(n0);read(m0);\n\tfor(ri i=1;i<=n;i++)for(ri j=1;j<=m;j++){\n\t\tread(a[i][j]);\n\t\tSum[i][j]=Sum[i-1][j]+Sum[i][j-1]-Sum[i-1][j-1]+a[i][j];//\u9884\u5904\u7406\u4e8c\u7ef4\u524d\u7f00\u548c \n\t}\n\tfor(ri i=1;i<=n;i++){//\u7b2c\u4e00\u6b21\u5355\u8c03\u961f\u5217\uff0c\u7b97mn1 \n\t\thead=tail=0;\n\t\tfor(ri j=1;j<m0;j++){\n\t\t\twhile(head<tail&&a[i][q[tail-1]]>=a[i][j])tail--;\n\t\t\tq[tail++]=j;\n\t\t}\n\t\tfor(ri j=1;j+m0-1<=m;j++){\n\t\t\twhile(head<tail&&q[head]<j)head++;\n\t\t\twhile(head<tail&&a[i][q[tail-1]]>=a[i][j+m0-1])tail--;\n\t\t\tq[tail++]=j+m0-1;\n\t\t\tmn1[i][j]=a[i][q[head]];\n\t\t}\n\t}\n//\tfor(ri i=1;i<=n;i++){for(ri j=1;j+m0-1<=m;j++)cout<<mn1[i][j]<<\" \";puts(\"\");}puts(\"\");\n\tfor(ri j=1;j+m0-1<=m;j++){//\u7b2c\u4e8c\u6b21\u5355\u8c03\u961f\u5217\uff0c\u7b97mn2 \n\t\thead=tail=0;\n\t\tfor(ri i=1;i<n0;i++){\n\t\t\twhile(head<tail&&mn1[q[tail-1]][j]>=mn1[i][j])tail--;\n\t\t\tq[tail++]=i;\n\t\t}\n\t\tfor(ri i=1;i+n0-1<=n;i++){\n\t\t\twhile(head<tail&&q[head]<i)head++;\n\t\t\twhile(head<tail&&mn1[q[tail-1]][j]>=mn1[i+n0-1][j])tail--;\n\t\t\tq[tail++]=i+n0-1;\n\t\t\tmn2[i][j]=mn1[q[head]][j];\n\t\t}\n\t}\n//\tfor(ri i=1;i+n0-1<=n;i++){for(ri j=1;j+m0-1<=m;j++)cout<<mn2[i][j]<<\" \";puts(\"\");} \n\tfor(ri i=1;i+n0-1<=n;i++)for(ri j=1;j+m0-1<=m;j++)cst[i][j]=calc_cst(i,j)/*\u5b58\u82b1\u8d39*/,ord.pb(mp(i,j));\n\tsort(ord.begin(),ord.end(),cmp);//\u6392\u5e8f \n\tvector<pair<int,int> > ans;//\u7b54\u6848\u5e8f\u5217 \n\tfor(ri i=0;i<ord.size();i++){\n\t\tint x=ord[i].X,y=ord[i].Y;\n\t\tif(vis[x][y]||vis[x][y+m0-1]||vis[x+n0-1][y]||vis[x+n0-1][y+m0-1])continue;//\u5224\u56db\u4e2a\u89d2 \n\t\tans.pb(ord[i]);//\u653e\u5230\u7b54\u6848\u5e8f\u5217\u91cc \n\t\tfor(ri j=x;j<=x+n0-1;j++)for(ri k=y;k<=y+m0-1;k++)vis[j][k]=true;//\u6807\u8bb0 \n\t}\n\tcout<<ans.size()<<\"\\n\";//\u8f93\u51fa\u9009\u7684\u5c0f\u77e9\u9635\u7684\u4e2a\u6570 \n\tfor(ri i=0;i<ans.size();i++)printf(\"%lld %lld %lld\\n\",ans[i].X,ans[i].Y,cst[ans[i].X][ans[i].Y]);//\u8f93\u51fa\u9009\u7684\u5c0f\u77e9\u9635 \n\treturn 0;\n}\n```",
        "postTime": 1565664881,
        "uid": 138400,
        "name": "chenxia25",
        "ccfLevel": 9,
        "title": "CodeForces 15D - Map"
    },
    {
        "content": "[$$\\huge\\texttt{\u5728\u672c\u4ebablog\u98df\u7528\u66f4\u4f73}$$](https://dilute.xyz/2019/05/08/Solutions/Solution-CF15D/)\n\n\n## $set$\u778e\u641e\n\n\u9996\u5148\u975e\u5e38\u663e\u7136\uff0c\u4e00\u4e2a\u77e9\u5f62$(x1, y1, x2, y2)$\u7684\u4ee3\u4ef7\u5c31\u662f$\\displaystyle\\sum_{i = x1}^{x2}\\sum_{j = y1}^{y2} h[i][j] - \\min_{x1 \\le i \\le x2, y1 \\le j \\le y2} h[i][j]$\uff0c\u6211\u4eec\u7528$f[i][j]$\u8868\u793a\u4ee5$(i, j)$\u4e3a\u5de6\u4e0a\u89d2\u7684\u77e9\u5f62\u7684\u4ee3\u4ef7\u3002\u5373\u77e9\u5f62$(i, j, i + a - 1, j + b - 1)$\u7684\u4ee3\u4ef7\u3002\n\n\u6211\u4eec\u9996\u5148\u8003\u8651\u5982\u4f55\u6c42\u51fa$f[i][j]$\u3002\n\n\u524d\u9762\u7684\u6c42\u548c\u53ef\u4ee5\u4e00\u4e2a\u4e8c\u7ef4\u524d\u7f00\u548c\u7b80\u5355\u89e3\u51b3\uff0c\u5173\u952e\u5728\u4e8e\u540e\u9762\u7684$\\min$\u3002\n\n\u6211\u4eec\u5bf9\u6bcf\u884c\u90fd\u5efa\u4e00\u4e2a$st$\u8868\uff0c\u8003\u8651\u6211\u4eec\u628a\u5f53\u524d\u6211\u4eec\u8981\u6c42\u7684\u533a\u95f4\u91cc\u7684$h[i][j]$\u90fd\u4e22\u8fdb\u4e00\u4e2a$set$\u4e2d\u3002\n\n\u6211\u4eec\u8003\u8651\u6bcf\u6b21\u628a\u77e9\u5f62\u5f80\u4e0b\u79fb\u52a8\u3002\n\n\u53d1\u73b0\u5176\u5b9e\u5bf9\u4e8e\u6bcf\u4e00\u884c\uff0c\u53ea\u6709\u5b83\u7684\u5728\u8303\u56f4\u5185\u7684\u6700\u5c0f\u503c\u624d\u6709\u8d21\u732e\uff0c\u6240$set$\u4e2d\u53ea\u9700\u8981\u653e\u6bcf\u884c\u7684\u6700\u5c0f\u503c\uff08\u53ef\u4ee5\u7528$st$\u8868\u5feb\u901f\u67e5\u8be2\uff09\u3002\n\n\u6211\u4eec\u518d\u8003\u8651\u5982\u4e0b\u56fe\u6240\u793a\u3002\n\n![](https://dilute.xyz/images/3.png)\n\n\u7136\u540e\u5982\u679c\u6211\u4eec\u8981\u4ece\u84dd\u8272\u77e9\u5f62\u79fb\u52a8\u5230\u9ed1\u8272\u77e9\u5f62\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u5728$set$\u4e2d\u5220\u53bb\u7070\u8272\u90e8\u5206\u7684\u6700\u5c0f\u503c\uff0c\u518d\u52a0\u5165\u6d45\u84dd\u8272\u90e8\u5206\u7684\u6700\u5c0f\u503c\u5373\u53ef\u3002\n\n\u6c42\u51fa\u4e86$f[i][j]$\u4e4b\u540e\u5c31\u53ef\u4ee5\u6309\u9898\u610f\u6a21\u62df\u4e86w\n\n\u6bcf\u6b21\u6211\u4eec\u53ef\u4ee5\u627e\u51fa$f[i][j]$\u7684\u6700\u5c0f\u503c\uff0c\u8fd9\u4e2a\u6392\u904d\u5e8f\u8f7b\u677e\u89e3\u51b3\uff08~~\u6211\u4e4b\u524d\u4f5c\u6b7b\u7528set\u88ab\u5361\u5e38\u4e86~~\uff09\u7136\u540e\u7ed9\u6240\u6709\u56e0\u4e3a\u8fd9\u4e2a\u77e9\u5f62\u88ab\u53d6\u5230\u4e86\u5bfc\u81f4\u4e0d\u80fd\u53d6\u7684\u6253\u4e0a\u6807\u8bb0\uff0c\u8fd9\u6837\u5b50\u65f6\u95f4\u590d\u6742\u5ea6\u662f\u6b63\u786e\u7684\uff0c\u6700\u591a\u53ea\u4f1a\u88ab\u53d6\u5230$\\frac{n m}{ab}$\u4e2a\u77e9\u5f62\uff0c\u7136\u540e\u6bcf\u6b21\u6253\u6807\u8bb0\u662f$O(a * b)$\u7684\uff0c\u6700\u540e\u590d\u6742\u5ea6\u5c31\u662f$O(\\frac{n m}{a b} a b) = O(n m)$\u7684\u3002\n\n\u590d\u6742\u5ea6$O(n m \\log n)$\uff0c\u8f7b\u5fae\u5361\u5e38w\n\n## \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n\n#define ll long long\n#define INF 2147483647\n\nint inp(){\n    char c = getchar();\n    while(c < '0' || c > '9')\n        c = getchar();\n    int sum = 0;\n    while(c >= '0' && c <= '9'){\n        sum = sum * 10 + c - '0';\n        c = getchar();\n    }\n    return sum;\n}\n\nint f[1010][1010][12];\nstd::multiset<ll> s2;\nint ans1[1000010], ans2[1000010], h[1010][1010];\nll ans3[1000010], sum[1010][1010], val[1010][1010];\nbool used[1010][1010];\nstd::pair<int, int> s[1000010];\n\nll query(int x, int l, int r){\n    int lg = log2(r - l + 1);\n    return std::min(f[x][l][lg], f[x][r - (1 << lg) + 1][lg]);\n}\n\nbool cmp(std::pair<int, int> a, std::pair<int, int> b){\n    if(val[a.first][a.second] == val[b.first][b.second])\n        return a < b;\n    return val[a.first][a.second] < val[b.first][b.second];\n}\n\nint main(){\n    int n = inp();\n    int m = inp();\n    int a = inp();\n    int b = inp();\n    for(int i = 1; i <= n; i++)\n        for(int j = 1; j <= m; j++)\n            f[i][j][0] = h[i][j] = inp();\n    for(int i = 1; i <= n; i++)\n        for(int u = 1; u <= 10; u++)\n            for(int j = 1; j <= m; j++)\n                if(j + (1 << u) - 1 <= m)\n                    f[i][j][u] = std::min(f[i][j][u - 1], f[i][j + (1 << (u - 1))][u - 1]);\n    for(int i = 1; i <= n; i++)\n        for(int j = 1; j <= m; j++)\n            sum[i][j] = sum[i - 1][j] + sum[i][j - 1] - sum[i - 1][j - 1] + h[i][j];\n    for(int j = 1; j <= m - b + 1; j++){\n        s2.clear();\n        for(int i = 1; i <= a; i++)\n            s2.insert(query(i, j, j + b - 1));\n        for(int i = 1; i <= n - a + 1; i++){\n            val[i][j] = sum[i + a - 1][j + b - 1] + sum[i - 1][j - 1] - sum[i + a - 1][j - 1] - sum[i - 1][j + b - 1] - (*(s2.begin())) * (a * b);\n            s2.erase(s2.find(query(i, j, j + b - 1)));\n            if(i + a <= n)\n                s2.insert(query(i + a, j, j + b - 1));\n        }\n    }\n    int cc = 0;\n    for(int i = 1; i <= n - a + 1; i++)\n        for(int j = 1; j <= m - b + 1; j++)\n            s[++cc] = std::make_pair(i, j);\n    std::sort(s + 1, s + cc + 1, cmp);\n    int cnt = 0;\n    for(int u = 1; u <= cc; u++){\n        if(used[s[u].first][s[u].second])\n            continue;\n        cnt++;\n        ans1[cnt] = s[u].first;\n        ans2[cnt] = s[u].second;\n        ans3[cnt] = val[s[u].first][s[u].second];\n        for(int i = ans1[cnt] - a + 1; i <= ans1[cnt] + a - 1; i++)\n            for(int j = ans2[cnt] - b + 1; j <= ans2[cnt] + b - 1; j++)\n                if(i > 0 && j > 0 && !used[i][j] && i <= n - a + 1 && j <= m - b + 1)\n                    used[i][j] = true;\n    }\n    printf(\"%d\\n\", cnt);\n    for(int i = 1; i <= cnt; i++)\n        printf(\"%d %d %I64d\\n\", ans1[i], ans2[i], ans3[i]);\n}\n```\n\n",
        "postTime": 1557286219,
        "uid": 36362,
        "name": "Dilute",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF15D \u3010Map\u3011"
    }
]
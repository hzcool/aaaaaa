[
    {
        "content": "\u6ce8\u610f\u5230 $n\\le70$ \uff0c\u6240\u4ee5\u4f60\u53ef\u4ee5\u76f4\u63a5 $n^3$ \u4fdd\u5b58\u8def\u5f84\n\n\u8bbe $p[p_1][p_2][p_3].num$ \u8868\u793a\u53d1\u751f\u53d1\u751f\u53d8\u52a8\u7684\u662f\u54ea\u4e2a\u77f3\u5934\n\n$p[p_1][p_2][p_3].from$ \u53d1\u751f\u53d8\u52a8\u7684\u77f3\u5934\u539f\u6765\u7684\u4f4d\u7f6e\n\n$p[p_1][p_2][p_3].res$ \u8868\u793a\u8981\u8fbe\u5230\u8fd9\u4e2a\u72b6\u6001\u7684\u6b65\u6570\n\n\u6700\u77ed\u8def\u5f84\u7528bfs\u67e5\u627e\uff0c\u6bcf\u6b21\u5206\u522b\u5c1d\u8bd5\u6269\u5c55\u4e09\u4e2a\u77f3\u5934\u3002\u82e5\u5f53\u524d\u51c6\u5907\u6269\u5c55\u7684\u77f3\u5934\u548c\u76ee\u6807\u7684\u8fb9\u7684\u989c\u8272\u548c\u53e6\u5916\u4e24\u4e2a\u77f3\u5934\u4e4b\u95f4\u8fb9\u7684\u989c\u8272\u4e0d\u540c\u5c31\u4e0d\u8fdb\u884c\u6269\u5c55\uff0c\u5982\u679c\u8fd9\u4e2a\u72b6\u6001\u5df2\u7ecf\u6709\u7b54\u6848\u4e86\u4e5f\u4e0d\u8fdb\u884c\u6269\u5c55\u3002\n\n\u5728\u8f93\u51fa\u8def\u5f84\u7684\u65f6\u5019\u4ece $1,2,3$ \u4e09\u4e2a\u70b9\u4e2d\u7b54\u6848\u6700\u5927\u7684\u5f00\u59cb\u6cbf\u7740 $p[p_1][p_2][p_3].from$ \u5f80\u56de\u9012\u5f52\uff0c\u76f4\u5230\u9012\u5f52\u56de\u521d\u59cb\u72b6\u6001\u540e\u518d\u8f93\u51fa\uff0c\u5177\u4f53\u7ec6\u8282\u5c31\u770b\u4ee3\u7801\u5427\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nstruct Stone_Pos\n{\n\tint p1,p2,p3,res;\n};\nstruct Path\n{\n\tint res,num,from;\n}p[80][80][80];\nqueue<Stone_Pos> q;\nint mp[80][80],n;\nvoid bfs()\n{\n\tint i;\n\twhile(!q.empty())\n\t{\n\t\tStone_Pos u=q.front();q.pop();\n\t\tint u1=u.p1,u2=u.p2,u3=u.p3;\n//\t\tprintf(\"%d %d %d\\n\",u1,u2,u3);\n\t\tfor(i=1;i<=n;i++)\n\t\t{\n\t\t\tif(i==u1 || i==u2 || i==u3) continue;\n\t\t\t//~x\u8868\u793a\u5c06x\u7684\u4e8c\u8fdb\u5236\u5168\u90e8\u53d6\u53cd\uff0c~x=0\u8868\u793ax=-1\n\t\t\tif(mp[u1][i]==mp[u2][u3] && !(~p[i][u2][u3].res))\n\t\t\t{\n\t\t\t\tp[i][u2][u3].res=u.res+1;//\u6b65\u6570+1\n\t\t\t\tp[i][u2][u3].from=u1;//\u7b2c\u4e00\u4e2a\u77f3\u5934\u662f\u4eceu1\u8d70\u5230i\u7684\n\t\t\t\tp[i][u2][u3].num=1;//\u53d1\u751f\u53d8\u52a8\u7684\u77f3\u5934\u662f\u7b2c\u4e00\u4e2a\n\t\t\t\t//\u4e0b\u9762\u4e24\u4e2a\u540c\u7406\n\t\t\t\tq.push((Stone_Pos){i,u2,u3,u.res+1});\n\t\t\t}\n\t\t\tif(mp[u2][i]==mp[u1][u3] && !(~p[u1][i][u3].res))\n\t\t\t{\n\t\t\t\tp[u1][i][u3].res=u.res+1;\n\t\t\t\tp[u1][i][u3].from=u2;\n\t\t\t\tp[u1][i][u3].num=2;\n\t\t\t\tq.push((Stone_Pos){u1,i,u3,u.res+1});\n\t\t\t}\n\t\t\tif(mp[u3][i]==mp[u1][u2] && !(~p[u1][u2][i].res))\n\t\t\t{\n\t\t\t\tp[u1][u2][i].res=u.res+1;\n\t\t\t\tp[u1][u2][i].from=u3;\n\t\t\t\tp[u1][u2][i].num=3;\n\t\t\t\tq.push((Stone_Pos){u1,u2,i,u.res+1});\n\t\t\t}\n\t\t}\n\t}\n\treturn;\n}\nvoid Print(int p1,int p2,int p3)\n{\n\tif(!p[p1][p2][p3].res) return;//\u8d70\u5230\u521d\u59cb\u60c5\u51b5\u4e86\n\tswitch(p[p1][p2][p3].num)//\u6765\u770b\u8fd9\u4e2a\u70b9\u662f\u6539\u53d8\u54ea\u4e2a\u77f3\u5934\u5f97\u5230\u7684\n\t{\n\t\tcase 1:\n\t\t{\n\t\t\tPrint(p[p1][p2][p3].from,p2,p3);\n\t\t\tprintf(\"%d %d\\n\",p[p1][p2][p3].from,p1);\n\t\t\tbreak;\n\t\t}\n\t\tcase 2:\n\t\t{\n\t\t\tPrint(p1,p[p1][p2][p3].from,p3);\n\t\t\tprintf(\"%d %d\\n\",p[p1][p2][p3].from,p2);\n\t\t\tbreak;\n\t\t}\n\t\tcase 3:\n\t\t{\n\t\t\tPrint(p1,p2,p[p1][p2][p3].from);\n\t\t\tprintf(\"%d %d\\n\",p[p1][p2][p3].from,p3);\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn;\n}\nint main()\n{\n\tint i,j,s1,s2,s3;\n\tchar c;\n\tscanf(\"%d\",&n);\n\tscanf(\"%d %d %d\",&s1,&s2,&s3);\n\tmemset(p,-1,sizeof(p));\n\tp[s1][s2][s3].res=0;\n\tfor(i=1;i<=n;i++)\n\t{\n\t\tfor(j=1;j<=n;j++)\n\t\t{\n\t\t\tcin>>c;\n\t\t\tif(c=='*') mp[i][j]=0;\n\t\t\telse mp[i][j]=c-'a'+1;\n\t\t}\n\t}\n\tq.push((Stone_Pos){s1,s2,s3,0});//\u521d\u59cb\u72b6\u6001\u5165\u961f\n\tbfs();\n\tint res=1145141919+810*24,e1,e2,e3;\n\t//\u627e\u4e00\u4e0b\u6b65\u6570\u6700\u5c0f\u7684\u90a3\u4e2a\u72b6\u6001\uff0c\u5e76\u4f5c\u4e3a\u9012\u5f52\u8f93\u51fa\u7684\u8d77\u70b9\n\tif(~p[1][2][3].res && p[1][2][3].res<res)\n\t{\n\t\tres=p[1][2][3].res;\n\t\te1=1;e2=2;e3=3;\n\t}\n\tif(~p[1][3][2].res && p[1][3][2].res<res)\n\t{\n\t\tres=p[1][3][2].res;\n\t\te1=1;e2=3;e3=2;\n\t}\n\tif(~p[2][1][3].res && p[2][1][3].res<res)\n\t{\n\t\tres=p[2][1][3].res;\n\t\te1=2;e2=1;e3=3;\n\t}\n\tif(~p[2][3][1].res && p[2][3][1].res<res)\n\t{\n\t\tres=p[2][3][1].res;\n\t\te1=2;e2=3;e3=1;\n\t}\n\tif(~p[3][1][2].res && p[3][1][2].res<res)\n\t{\n\t\tres=p[3][1][2].res;\n\t\te1=3;e2=1;e3=2;\n\t}\n\tif(~p[3][2][1].res && p[3][2][1].res<res)\n\t{\n\t\tres=p[3][2][1].res;\n\t\te1=3;e2=2;e3=1;\n\t}\n\tif(res>1919810)//\u65e0\u6cd5\u8d70\u5230\u4efb\u4f55\u4e00\u79cd\u53ef\u80fd\u7684\u7ed3\u675f\u72b6\u6001\n\t{\n\t\tprintf(\"-1\");\n\t\treturn 0;\n\t}\n\tprintf(\"%d\\n\",res);\n\tPrint(e1,e2,e3);//\u9012\u5f52\u8f93\u51fa\u8def\u5f84\n\treturn 0;\n}\n```\n",
        "postTime": 1620626709,
        "uid": 84773,
        "name": "minecraft_herobrine",
        "ccfLevel": 0,
        "title": "CF386D\u9898\u89e3"
    },
    {
        "content": "\u6211\u4eec\u5148\u6765\u5206\u6790\u4e00\u4e0b\u9898\u76ee\u7684\u6761\u4ef6\uff0c\u53d1\u73b0\u8fd9\u4e2a\u64cd\u4f5c\u5e76\u4e0d\u597d\u641e\uff0c\u518d\u770b\u4e00\u773c\u6570\u636e\u8303\u56f4 $n \\le 70$\uff0c\u90a3\u663e\u7136\u662f\u8981\u4f9d\u8d56\u4e8e $O(n^3)$ \u6216\u8005 $O(n^4)$ \u7684\u3002\n\n\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u77f3\u5934\u7684\u4f4d\u7f6e\u5982\u679c\u56fa\u5b9a\uff0c\u90a3\u7b54\u6848\u4e5f\u662f\u56fa\u5b9a\u7684\u3002\n\n\u6240\u4ee5\u53ef\u4ee5\u5c1d\u8bd5\u5c06\u77f3\u5934\u7684\u4f4d\u7f6e\u90fd\u538b\u8fdb\u72b6\u6001\u91cc\u9762\uff0c\u503c\u5f97\u4e00\u63d0\u7684\u662f\uff0c\u8fd9\u4e2a\u770b\u8d77\u6765\u662f DP \u5b9e\u9645\u4e0a\u4f1a\u4ea7\u751f\u540e\u6548\u6027\u3002\n\n\u53ef\u4ee5\u628a\u72b6\u6001\u770b\u6210\u51e0\u4e2a\u70b9\uff0c\u7136\u540e\u5982\u679c\u80fd\u8f6c\u79fb\u5c31\u770b\u6210\u4e00\u6761\u8fb9\uff0c\u5f88\u5bb9\u6613\u53d1\u73b0\u5b83\u662f\u4e00\u4e2a\u8fb9\u6743\u4e3a $1$ \u7684\u6700\u77ed\u8def\u95ee\u9898\u3002\n\n\u8fb9\u6743\u4e3a $1$ \u7684\u6700\u77ed\u8def\u95ee\u9898\u53ef\u4ee5\u7528 BFS \u5feb\u901f\u89e3\u51b3\u3002\n\n\u90a3\u4e48\u5982\u4f55\u786e\u5b9a\u6e90\u70b9\u4ee5\u53ca\u6c47\u70b9\u5462\uff1f\u76f8\u4fe1\u5f88\u591a\u4eba\u90fd\u4f1a\u62ff\u8d77\u70b9\u4f5c\u4e3a\u6e90\u70b9\uff0c\u4f46\u662f\u90a3\u6837\u7684\u8bdd\u5c31\u4e0d\u592a\u7b26\u5408 BFS \u7684\u5f62\u5f0f\uff0c\u6240\u4ee5\u5c31\u8981\u62ff\u6700\u7ec8\u72b6\u6001\u4f5c\u4e3a\u6e90\u70b9\u3002\n\n\u590d\u6742\u5ea6 $O(n^4)$\u3002\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <queue>\nusing namespace std;\nconst int INF=75;\nstruct _node_data{\n\tint a,b,c;\n};\nqueue <_node_data> q;\nint n,f[INF][INF][INF],f1[INF][INF][INF][5];\nchar Map[INF][INF];\nvoid print(int a,int b,int c) {\n\tif (f1[a][b][c][0]==0 || f1[a][b][c][1]==0 || f1[a][b][c][2]==0) return ;\n\tif (f1[a][b][c][0]!=a) cout<<a<<\" \"<<f1[a][b][c][0]<<\"\\n\";\n\tif (f1[a][b][c][1]!=b) cout<<b<<\" \"<<f1[a][b][c][1]<<\"\\n\";\n\tif (f1[a][b][c][2]!=c) cout<<c<<\" \"<<f1[a][b][c][2]<<\"\\n\";\n\tprint(f1[a][b][c][0],f1[a][b][c][1],f1[a][b][c][2]);\n}\nsigned main()\n{\n\tmemset(f,63,sizeof f);\n\tios::sync_with_stdio(false);\n\tcin>>n;int a=0,b=0,c=0;\n\tcin>>a>>b>>c;\n\tfor (int i=1;i<=n;i++)\n\t\tfor (int j=1;j<=n;j++)\n\t\t\tcin>>Map[i][j];\n\tf[1][2][3]=f[1][3][2]=f[2][1][3]=f[2][3][1]=f[3][1][2]=f[3][2][1]=0;\n\tq.push((_node_data){1,2,3});\n\tq.push((_node_data){1,3,2});\n\tq.push((_node_data){2,1,3});\n\tq.push((_node_data){2,3,1});\n\tq.push((_node_data){3,1,2});\n\tq.push((_node_data){3,2,1});\n\twhile (q.size()) {\n\t\t_node_data xx=q.front();q.pop();\n//\t\tcout<<xx.a<<\" \"<<xx.b<<\" \"<<xx.c<<\" \"<<f[xx.a][xx.b][xx.c]<<\" ???????\\n\"; \n\t\tfor (int i=1;i<=n;i++) {\n\t\t\tif (i==xx.a || i==xx.b || i==xx.c) continue;\n\t\t\tif (Map[xx.b][xx.c]==Map[xx.a][i]) {\n\t\t\t\tif (!(f[i][xx.b][xx.c]<f[xx.a][xx.b][xx.c]+1)) {\n\t\t\t\t\tf[i][xx.b][xx.c]=f[xx.a][xx.b][xx.c]+1;\n\t\t\t\t\tf1[i][xx.b][xx.c][0]=xx.a;\n\t\t\t\t\tf1[i][xx.b][xx.c][1]=xx.b;\n\t\t\t\t\tf1[i][xx.b][xx.c][2]=xx.c;\n\t\t\t\t\tq.push((_node_data){i,xx.b,xx.c});\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (Map[xx.b][xx.a]==Map[xx.c][i]) {\n\t\t\t\tif (!(f[xx.a][xx.b][i]<f[xx.a][xx.b][xx.c]+1)) {\n\t\t\t\t\tf[xx.a][xx.b][i]=f[xx.a][xx.b][xx.c]+1;\n\t\t\t\t\tf1[xx.a][xx.b][i][0]=xx.a;\n\t\t\t\t\tf1[xx.a][xx.b][i][1]=xx.b;\n\t\t\t\t\tf1[xx.a][xx.b][i][2]=xx.c;\n\t\t\t\t\tq.push((_node_data){xx.a,xx.b,i});\n\t\t\t\t}\n\t\t\t}\n//\t\t\tif (i==3) cout<<xx.a<<\" \"<<xx.b<<\" \"<<xx.c<<\" \"<<Map[xx.a][xx.c]<<\" \"<<Map[xx.b][i]<<\" endl\\n\";\n\t\t\tif (Map[xx.a][xx.c]==Map[xx.b][i]) {\n\t\t\t\tif (f[xx.a][i][xx.c]<f[xx.a][xx.b][xx.c]+1) continue;\n\t\t\t\tf[xx.a][i][xx.c]=f[xx.a][xx.b][xx.c]+1;\n\t\t\t\tf1[xx.a][i][xx.c][0]=xx.a;\n\t\t\t\tf1[xx.a][i][xx.c][1]=xx.b;\n\t\t\t\tf1[xx.a][i][xx.c][2]=xx.c;\n\t\t\t\tq.push((_node_data){xx.a,i,xx.c});\n\t\t\t}\n\t\t}\n\t}\n//\tcout<<f[6][3][2]<<\" ???\\n\";\n\tint xx=f[a][b][c];\n\tif (xx<1e9) cout<<xx<<\"\\n\";\n\telse {cout<<\"-1\\n\";return 0;}\n\tprint(a,b,c);\n\treturn 0;\n}\n```\n",
        "postTime": 1660277727,
        "uid": 208653,
        "name": "_edge_",
        "ccfLevel": 0,
        "title": "CF386D"
    }
]
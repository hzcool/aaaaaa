[
    {
        "content": "### Solution\uff1a\n\n\u3000\u3000\u672c\u9898\u6c34\u8003\u7684T3\uff0c\u4e00\u9053\u601d\u7ef4\u9898\u3002\n\n\u3000\u3000\u56e0\u4e3a$a_i$\u53ea\u6709$1,2$\u4e24\u79cd\u53ef\u80fd\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u786e\u5b9a\u7684\u662f\u7b54\u6848\u4e00\u5b9a\u662f\uff1a$[1,1,1,\u2026]\\;[2,2,2\u2026]\\;[1,1,1\u2026]\\;[2,2,2\u2026]$\u8fd9\u6837\u7684\u56db\u6bb5\u5b50\u5e8f\u5217\uff08\u6bcf\u4e00\u6bb5\u90fd\u5141\u8bb8\u4e3a\u7a7a\uff09\uff0c\u4f7f\u5f97\u7b2c\u4e8c\u3001\u4e09\u6bb5\u6240\u5728\u533a\u95f4\u7ffb\u8f6c\u5f97\u5230\u7b54\u6848\uff08\u4e0d\u7ffb\u8f6c\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e8c\u3001\u4e09\u6bb5\u4e3a\u7a7a\u5e8f\u5217\uff09\u3002\n\n\u3000\u3000**\u89e3\u6cd5\u4e00\uff1a**\n\n\u3000\u3000\u3000\u3000\u6211\u4eec\u53ef\u4ee5\u4ece\u5de6\u5f80\u53f3\u505a\u524d\u7f00\u548c$ct1[i]$\u8868\u793a$[1,i]$\u51fa\u73b0\u7684$1$\u7684\u4e2a\u6570\uff0c\u540c\u7406\u505a\u51fa\u540e\u7f00\u548c$ct2[i]$\u8868\u793a$[i,n]$\u51fa\u73b0\u7684$2$\u7684\u4e2a\u6570\u3002\u7136\u540e\u6211\u4eec\u679a\u4e3e\u65ad\u70b9$k,k\\in[1,n+1]$\uff08\u5373\u4e8c\u3001\u4e09\u6bb5\u7684\u5206\u754c\u70b9\uff09\uff0c\u8bbe\u4e00\u3001\u4e8c\u6bb5\u7684\u5206\u754c\u70b9\u4e3a$p,p\\in[1,k]$\uff0c\u4e09\u3001\u56db\u6bb5\u7684\u5206\u754c\u70b9\u4e3a$q,q\\in[k,n+1]$\uff0c\u90a3\u4e48\u663e\u7136\u7b54\u6848\u4e3a$(ct1[p-1])+(ct2[p]-ct2[k])+(ct1[q-1]-ct1[k])+(ct2[q])$\uff0c\u5f0f\u5b50\u4e2d\u62ec\u53f7\u62ec\u8d77\u6765\u7684\u4e3a\u4e00\u6bb5\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u5316\u4e3a$(ct1[p-1]+ct2[p]+ct1[q-1]+ct2[q])-(ct1[k]+ct2[k]),p\\in[1,k],q\\in[k,n+1]$\uff0c\u6ce8\u610f\u5230\u5bf9\u4e8e\u4e00\u4e2a\u786e\u5b9a\u7684$k$\uff0c\u6211\u4eec\u8981\u6700\u5927\u5316\u524d\u9762\u62ec\u53f7\u7684\u5f0f\u5b50\uff0c\u800c\u524d\u8005\u53ef\u4ee5\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u4e0b$ct1[i-1]+ct2[i]$\uff0c\u90a3\u4e48\u53ea\u7528\u679a\u4e3e$k$\uff0c\u518d\u4e24\u6b21\u533a\u95f4\u6700\u5927\u503c\u67e5\u8be2\uff0c\u66f4\u65b0\u7b54\u6848\u5c31\u597d\u4e86\u3002\n\n\u3000\u3000\u3000\u3000\u65f6\u95f4\u590d\u6742\u5ea6$O(n\\log n)$\u3002\n\n\u3000\u3000**\u4ee3\u7801\uff1a**\n  ```cpp\n/*Code by 520 -- 10.20*/\n#include<bits/stdc++.h>\n#define il inline\n#define ll long long\n#define RE register\n#define For(i,a,b) for(RE int (i)=(a);(i)<=(b);(i)++)\n#define Bor(i,a,b) for(RE int (i)=(b);(i)>=(a);(i)--)\n#define lson l,m,rt<<1\n#define rson m+1,r,rt<<1|1\nusing namespace std;\nconst int N=1000005;\nint n,ans,ct1[N],ct2[N],a[N],ppx[N];\nstruct SGT{\n    int maxn[N<<2];\n    il void pushup(int rt){maxn[rt]=max(maxn[rt<<1],maxn[rt<<1|1]);}\n    void build(int l,int r,int rt){\n        if(l==r) {maxn[rt]=ppx[l];return;}\n        int m=l+r>>1;\n        build(lson),build(rson);\n        pushup(rt);\n    }\n    int query(int L,int R,int l,int r,int rt){\n        if(L<=l&&R>=r) return maxn[rt];\n        int m=l+r>>1,res=0;\n        if(L<=m) res=max(res,query(L,R,lson));\n        if(R>m) res=max(res,query(L,R,rson));\n        return res;\n    }\n}T;\n\nint main(){\n    scanf(\"%d\",&n); int t1,t2;\n    For(i,1,n) scanf(\"%d\",a+i),ct1[i]=ct1[i-1]+(a[i]==1);\n    Bor(i,1,n) ct2[i]=ct2[i+1]+(a[i]==2);\n    For(i,1,n+1) ppx[i]=ct1[i-1]+ct2[i];\n    T.build(1,n+1,1);\n    For(k,1,n+1) {\n        t1=T.query(1,k,1,n+1,1),t2=T.query(k,n+1,1,n+1,1);\n        ans=max(ans,t1+t2-ct1[k-1]-ct2[k]);\n    }\n    cout<<ans;\n    return 0;\n}\n```\n$\\quad\\;\\;$**\u89e3\u6cd5\u4e8c\uff1a**\n\n\u3000\u3000\u3000\u3000\u6211\u4eec~~\u663e\u7136\uff08\u4e8b\u5b9e\u4e0a\u8003\u8bd5\u53ea\u60f3\u51fa\u4e86\u89e3\u6cd5\u4e00\uff09~~\u53ef\u4ee5\u7528DP\u6765\u7ef4\u62a4\u6bcf\u6bb5\u7684\u6700\u5927\u503c\u3002\n\n\u3000\u3000\u3000\u3000\u5b9a\u4e49\u72b6\u6001$f[i][1]$\u8868\u793a\u524d$i$\u4e2a\u6570\u4e2d\u524d\u4e00\u6bb5\u7684\u7b54\u6848\uff0c$f[i][2]$\u8868\u793a\u524d$i$\u4e2a\u6570\u4e2d\u524d\u4e24\u6bb5\u7684\u7b54\u6848\uff0c$f[i][3]$\u8868\u793a\u524d$i$\u4e2a\u6570\u4e2d\u524d\u4e09\u6bb5\u7684\u7b54\u6848\uff0c$f[i][4]$\u8868\u793a\u524d$i$\u4e2a\u6570\u4e2d\u524d\u56db\u6bb5\u7684\u7b54\u6848\u3002\n\n\u3000\u3000\u3000\u3000\u90a3\u4e48\u4e0d\u96be\u5f97\u5230\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n\u3000\u3000\u3000\u3000$f[i][1]=f[i-1][1]+(a_i==1)$\n\n\u3000\u3000\u3000\u3000$f[i][2]=max(f[i-1][1],f[i-1][2]+(a_i==2))$\n\n\u3000\u3000\u3000\u3000$f[i][3]=max(f[i-1][2],f[i-1][3]+(a_i==1))$\n\n\u3000\u3000\u3000\u3000$f[i][4]=max(f[i-1][3],f[i-1][4]+(a_i==2))$\n\n\u3000\u3000\u3000\u3000\u663e\u7136\u7b2c\u4e00\u7ef4\u662f\u53ef\u4ee5\u538b\u6389\u7684,\u65f6\u95f4\u590d\u6742\u5ea6$O(n)$\u3002\n\n\u3000\u3000**\u4ee3\u7801\uff1a**\n  \n  ```cpp\n/*Code by 520 -- 10.20*/\n#include<bits/stdc++.h>\n#define RE register\n#define For(i,a,b) for(RE int (i)=(a);(i)<=(b);(i)++)\nusing namespace std;\nint n,x,f[5];\n\nint main(){\n    scanf(\"%d\",&n);\n    For(i,1,n) \n        scanf(\"%d\",&x),\n        f[1]+=(x==1),\n        f[2]=max(f[1],f[2]+(x==2)),\n        f[3]=max(f[2],f[3]+(x==1)),\n        f[4]=max(f[3],f[4]+(x==2));\n    cout<<f[4];\n    return 0;\n}\n```\n$\\quad\\;\\;$\u6b22\u8fce\u6765\u8e29\u535a\u5ba2\uff1a[five20](https://www.cnblogs.com/five20/p/9862456.html)\uff08\u849f\u84bb\u5199\u9898\u89e3\u4e0d\u6613\uff0c\u8f6c\u8f7d\u8bf7\u6ce8\u660e\u51fa\u5904\uff0c\u4e07\u5206\u611f\u8c22\uff01\uff5e\uff09\n  ",
        "postTime": 1540633314,
        "uid": 44000,
        "name": "\u6d45\u8272\u8c03",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF933A \u3010A Twisty Movement\u3011"
    },
    {
        "content": "\u8fd9\u9898\u53c8\u5f00\u9614\u4e86\u6211\u7684\u773c\u754c\n\n\u4e0d\u8003\u8651\u7ffb\u8f6c\u8fd9\u4e2a\u6761\u4ef6\uff0ca[i]\u53ea\u67091\u548c2\u65f6\uff0c\u5c31\u5f88\u662f\u5feb\u4e50\n\n\u6700\u957f\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\u80af\u5b9a\u957f\u8fd9\u6837\n\n$11\u2026\u202622\u2026\u2026$\n\n\u6211\u4eec\u5904\u7406\u4e00\u4e0b\uff0c\u628a1\u548c2\u653e\u5728\u4e24\u7ec4\u4e2d\n\n$[11\u2026\u2026][22\u2026\u2026]$\n\n\u5b9a\u4e49 $f[i][j]$ (j\u4e3a1\u62162)\u4e3a\u524di\u4e2a\u70b9\uff0c\u7b2ci\u4e2a\u70b9\u5c5e\u4e8e\u7b2cj\u7ec4\n$$f[i][1]=f[i-1][j]+(a[i]==1)$$\n$$f[i][2]=max(f[i-1][1],f[i-1][2]+(a[i]==2))$$\n\u8003\u8651\u4e00\u4e0b\u7ffb\u8f6c,\u6bd4\u5982\n\n$1112212211212222$\n\n\u5b83\u7ffb\u8f6c\u540e\u7684\u6700\u957f\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\u662f\n\n$11111122222222$\n\n\uff08\u7ffb\u8f6c\u533a\u95f4 $4\u300112$\uff09\n\u8981\u662f\u6211\u4eec\u7ffb\u8f6c\u56de\u6765\uff0c\u8fd9\u4e2a\u5e8f\u5217\u5c31\u53d8\u6210\u4e86\n\n$11122221112222$\n\n\u53d1\u73b0\u5b83\u53ef\u4ee5\u5206\u4e3a4\u7ec4\n$[111][2222][111][2222]$ (\u6bd5\u7adf\u8fd9\u6837\u7684\u8bdd\u4ea4\u636223\u533a\u95f4\u5c31\u53d8\u6210\u4e86\u4e0a\u9762\u7684\u60c5\u51b5\u4e86)\n\n\u6240\u4ee5\u5c31\u53ef\u4ee5\u5217\u51fa\u65b9\u7a0b\n$$f[i][1]=f[i-1][1]+(a[i]==1)$$\n$$f[i][2]=max(f[i-1][1],f[i-1][2]+(a[i]==2)$$\n$$f[i][3]=max(f[i-1][2],f[i-1][3]+(a[i]==1)$$\n$$f[i][4]=max(f[i-1][3],f[i-1][4]+(a[i]==2)$$\n\n\u7136\u540e\u6211\u4eec\u538b\u6389\u7b2c\u4e00\u7ef4\u5c31\u53ef\n\n\u63d0\u4f9b\u4e00\u4e2a\u7406\u89e3\u601d\u8def\uff08\u4ee5 $f[i][2]$ \u4e3a\u4f8b\uff09\n\n1.\u4ece $f[i-1][1]$ \u8f6c\u79fb\uff1a\u5f00\u542f\u4e00\u4e2a\u65b0\u7684\u7ec4\n\n2.\u4ece $f[i-][2]$ \u8f6c\u79fb\uff1a\u5f80\u5df2\u7ecf\u5f00\u542f\u7684\u7ec4\u6dfb\u52a0\u4e00\u4e2a\u6570\n```\n#include<iostream>\n#include<cstdio>\n#define ll long long\nusing namespace std;\nll n,m,f[10],ans;\n\nint main(){\n\tscanf(\"%lld\",&n);\n\tfor(ll i=1;i<=n;i++){\n\t\tll a1;\n\t\tscanf(\"%lld\",&a1);\n\t\tf[1]+=(a1==1);\n\t\tf[2]=max(f[1],f[2]+(a1==2));\n\t\tf[3]=max(f[2],f[3]+(a1==1));\n\t\tf[4]=max(f[3],f[4]+(a1==2));\n\t}\n\tcout<<f[4];\n}\n```\n",
        "postTime": 1596902957,
        "uid": 251882,
        "name": "\u849f\u84bb\u4e01",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF933A \u3010A Twisty Movement\u3011"
    },
    {
        "content": "### \u9898\u610f\n\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u4e14\u53ea\u5305\u542b $1$ \u6216 $2$ \u7684\u5e8f\u5217 $a$\uff0c\u4f60\u53ef\u4ee5\u7ffb\u8f6c\u4e00\u6b21\u5e8f\u5217\u7684\u67d0\u4e2a\u533a\u95f4\uff0c\u6c42\u7ffb\u8f6c\u540e\u6700\u957f\u4e0d\u964d\u5b50\u5e8f\u5217\u7684\u957f\u5ea6\u3002\n\n$\\texttt{Data Range:}n\\leq 2000$\n\n### \u9898\u89e3\n\n\u8fd9\u9898\u5e94\u8be5\u968f\u4fbf\u5199\u5427\uff0c$n$ \u5f00\u5230 $2\\times 10^6$ \u90fd\u65e0\u6240\u8c13\u4e86\uff0c\u505a\u5b8c\u4e4b\u540e\u770b\u4e86\u770b\u9898\u89e3\u533a\u53d1\u73b0\u6ca1\u4eba\u601d\u8def\u8ddf\u6211\u4e00\u6837\uff0c\u6240\u4ee5\u6765\u5199\u4e00\u4e0b\u3002\n\n\u8003\u8651\u6700\u7ec8\u7684\u5e8f\u5217\u53ea\u53ef\u80fd\u5206\u6210\u56db\u6bb5\u533a\u95f4\uff0c\u7b2c\u4e00\u6bb5\u9009 $1$\uff0c\u7b2c\u4e8c\u6bb5\u9009 $2$\uff0c\u7b2c\u4e09\u6bb5\u9009 $1$\uff0c\u7b2c\u56db\u6bb5\u9009 $2$\uff0c\u7136\u540e\u7ffb\u8f6c\u4e2d\u95f4\u4e24\u6bb5\u3002\u6ce8\u610f\u8fd9\u56db\u6bb5\u4e2d\u4efb\u4f55\u4e00\u6bb5\u90fd\u53ef\u4ee5\u4e3a\u7a7a\u3002\n\n\u7136\u540e\u8003\u8651\u679a\u4e3e\u7b2c\u4e8c\u6bb5\u548c\u7b2c\u4e09\u6bb5\u7684\u5206\u754c\u7ebf\uff0c\u8fd9\u6837\u4e24\u8fb9\u90fd\u662f\u5148\u9009\u4e00\u4e9b $1$ \u518d\u9009\u4e00\u4e9b $2$\u3002\n\n\u8003\u8651 DP\u3002\u501f\u7528 P6009 \u7684\u601d\u8def\uff0c\u8bbe $f_{i,j}$ \u8868\u793a $1\\sim i$ \u4e2d\u6700\u540e\u4e00\u6bb5\u9009 $j$ \u7684\u6700\u957f\u4e0d\u964d\u5b50\u5e8f\u5217\u957f\u5ea6\uff0c$g_{i,j}$ \u8868\u793a $i\\sim n$ \u4e2d\u6700\u540e\u4e00\u6bb5\u9009 $j$ \u7684\u6700\u957f\u4e0d\u964d\u5b50\u5e8f\u5217\u957f\u5ea6\uff0c\u4e8e\u662f\u6709\u5982\u4e0b\u8f6c\u79fb\uff1a\n\n$$f_{i,j}=\\begin{cases}f_{i-1,j}&,a_i\\neq j\\\\f_{i-1,1}+1&,a_i=j=1\\\\\\max(f_{i-1,1},f_{i-1,2}+1)&,a_i=j=2\\end{cases}$$\n\n\u4ee5\u53ca\n\n$$g_{i,j}=\\begin{cases}g_{i+1,j}&,a_i\\neq j\\\\\\max(g_{i+1,1},g_{i+1,2})+1&,a_i=j=1\\\\g_{i+1,2}+1&,a_i=j=2\\end{cases}$$\n\n\u6700\u540e\u679a\u4e3e\u4e00\u4e0b\u5206\u754c\u7ebf\uff0c\u7b54\u6848\u4e3a $\\max(f_{i,2}+g_{i+1,1})$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$\u3002\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u8fd9\u4e2a\u9898\u6253\u4e86\u4e00\u4e2a\u7ebf\u6bb5\u6811\u7684 tag\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef int ll;\ntypedef long long int li;\nconst ll MAXN=2e5+51; \nll n,res;\nll x[MAXN],f[MAXN][3],g[MAXN][3];\ninline ll read()\n{\n    register ll num=0,neg=1;\n    register char ch=getchar();\n    while(!isdigit(ch)&&ch!='-')\n    {\n        ch=getchar();\n    }\n    if(ch=='-')\n    {\n        neg=-1;\n        ch=getchar();\n    }\n    while(isdigit(ch))\n    {\n        num=(num<<3)+(num<<1)+(ch-'0');\n        ch=getchar();\n    }\n    return num*neg;\n}\nint main()\n{\n\tn=read();\n\tfor(register int i=1;i<=n;i++)\n\t{\n\t\tx[i]=read();\n\t}\n\tfor(register int i=1;i<=n;i++)\n\t{\n\t\tf[i][1]=f[i-1][1],f[i][2]=f[i-1][2];\n\t\tx[i]==1?f[i][1]++:f[i][2]=max(f[i][1],f[i][2])+1;\n\t}\n\tfor(register int i=n;i;i--)\n\t{\n\t\tg[i][1]=g[i+1][1],g[i][2]=g[i+1][2];\n\t\tx[i]==2?g[i][2]++:g[i][1]=max(g[i][1],g[i][2])+1;\n\t}\n\tfor(register int i=0;i<=n;i++)\n\t{\n\t\tres=max(res,f[i][2]+g[i+1][1]);\n\t}\n\tprintf(\"%d\\n\",res);\n}\n```",
        "postTime": 1597846274,
        "uid": 60990,
        "name": "Karry5307",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF933A \u3010A Twisty Movement\u3011"
    },
    {
        "content": "\u9898\u76ee\u4f20\u9001\u95e8\uff1a[CF933A](https://www.luogu.com.cn/problem/CF933A)\u3002\n# \u601d\u8def\n\u8fd9\u9053\u9898\u4e00\u770b\u5c31\u662f**\u7ebf\u6027 dp**\u3002\n\n\u7531\u4e8e\u8fd9\u9053\u9898 $1 \\le a_i \\le 2$ \u6240\u4ee5\uff0c\u6211\u4eec\u53d1\u73b0\u6700\u957f\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\u4e00\u5b9a\u662f $[1,1,1,...,1,2,2,2,...2]$ \u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a\u4ed6\u5206\u6210\u56db\u6bb5\uff1a$[1,1,1,...][2,2,2,...][1,1,1,...][2,2,2,...]$ \u7136\u540e\u7528 $0$ $1$ $2$ $3$ \u8868\u793a\uff0c\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5 dp \u4e86\u3002\n\n**\u72b6\u6001\u8868\u793a**\uff1a $f_{i,j}$ \u8868\u793a\u73b0\u5728\u5230\u4e86\u7b2c $i$ \u4e2a\u6570\uff0c\u4e14\u73b0\u5728\u662f\u7b2c $j$ \u6bb5\uff0c\u4e14 $1\\le i\\le n $ $0\\le j\\le 3$\u3002\n\n**\u72b6\u6001\u8f6c\u79fb**\uff1a\n\n$f_{i,0}$\n\n\u7531\u4e8e\u662f\u7b2c $0$ \u6bb5\uff0c\u6240\u4ee5\u53ea\u80fd\u4ece\u524d\u4e00\u9879\u8f6c\u79fb\u5373 $f_{i-1,0}$ \u6700\u540e\u52a0\u4e0a\u5224\u65ad $a_i$ \u662f\u5426\u662f $1$ \u5373\u53ef\u3002\n\n\u6240\u4ee5\u8f6c\u79fb\u65b9\u7a0b\u662f\uff1a$f_{i,0}=f_{i-1,0}+(a_i=1)$\u3002\n\n$f_{i,1}$\n\n\u7531\u4e8e\u662f\u7b2c $1$ \u6bb5\uff0c\u6240\u4ee5\u53ef\u4ee5\u4ece $f_{i,0}$ \u8fdb\u884c\u8f6c\u79fb\uff0c\u6700\u540e\u4e0e\u81ea\u5df1\u524d\u4e00\u9879\u8f6c\u79fb\u52a0\u4e0a\u5224\u65ad $a_i$ \u662f\u5426\u662f $2$ \u53d6\u6700\u5927\u503c\u3002\n\n\u6240\u4ee5\u8f6c\u79fb\u65b9\u7a0b\u662f\uff1a$f_{i,1}=\\max(f_{i,0},f_{i-1,1}+(a_i=2))$\u3002\n\n$f_{i,2}$\n\n\u7531\u4e8e\u662f\u7b2c $2$ \u6bb5\uff0c\u6240\u4ee5\u53ef\u4ee5\u4ece $f_{i,1}$ \u8fdb\u884c\u8f6c\u79fb\uff0c\u6700\u540e\u4e0e\u81ea\u5df1\u524d\u4e00\u9879\u8f6c\u79fb\u52a0\u4e0a\u5224\u65ad $a_i$ \u662f\u5426\u662f $1$ \u53d6\u6700\u5927\u503c\u3002\n\n\u6240\u4ee5\u8f6c\u79fb\u65b9\u7a0b\u662f\uff1a$f_{i,2}=\\max(f_{i,1},f_{i-1,2}+(a_i=1))$\u3002\n\n$f_{i,3}$\n\n\u7531\u4e8e\u662f\u7b2c $3$ \u6bb5\uff0c\u6240\u4ee5\u53ef\u4ee5\u4ece $f_{i,2}$ \u8fdb\u884c\u8f6c\u79fb\uff0c\u6700\u540e\u4e0e\u81ea\u5df1\u524d\u4e00\u9879\u8f6c\u79fb\u52a0\u4e0a\u5224\u65ad $a_i$ \u662f\u5426\u662f $2$ \u53d6\u6700\u5927\u503c\u3002\n\n\u6240\u4ee5\u8f6c\u79fb\u65b9\u7a0b\u662f\uff1a$f_{i,3}=\\max(f_{i,2},f_{i-1,3}+(a_i=2))$\u3002\n\n\u6700\u540e\u7b54\u6848\u5c31\u662f\u6700\u540e\u4e00\u9879\u7684\u7b2c $3$ \u6bb5\u5373\u4e3a $f_{n,3}$\u3002\n\n# \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nint f[2001][4],a[1234567]; \nmain(){\n\tint n;\n\tcin>>n;\n\tfor (int i=1;i<=n;i++) cin>>a[i];\n\tfor (int i=1;i<=n;i++){//\u8f6c\u79fb\u65b9\u7a0b\n\t\tf[i][0]=f[i-1][0]+(a[i]==1);\n\t\tf[i][1]=max(f[i][0],f[i-1][1]+(a[i]==2));\n\t\tf[i][2]=max(f[i][1],f[i-1][2]+(a[i]==1));\n\t\tf[i][3]=max(f[i][2],f[i-1][3]+(a[i]==2));\n\t}\n\tcout <<f[n][3];\n    return 0;\n}\n```",
        "postTime": 1672117646,
        "uid": 658198,
        "name": "gesong",
        "ccfLevel": 4,
        "title": "CF933A \u9898\u89e3"
    },
    {
        "content": "$\\color{blue}{\\texttt{Difficulty : 1800}}$\n\nDP\u3002\n\n$f_{i,1/2/3/4}$ \u8868\u793a $1\\sim i$ \u533a\u95f4\u91cc\u524d $1/2/3/4$ \u6bb5\u7684\u6700\u957f\u957f\u5ea6\u3002\n\n\u90a3\u4e48\u6709\uff1a\n\n\u5982\u679c $a_i=1$\uff0c\u90a3\u4e48 $f_{i,1}=f_{i-1,1}+1$\uff0c$f_{i,3}=\\max(f_{i-1,3}+1, f_{i-1,2})$\u3002\n\n\u5426\u5219\uff0c$f_{i,2}=\\max(f_{i-1,2}+1,f_{i-1,1})$\uff0c$f_{i,4}=\\max(f_{i-1,4}+1,f_{i-1,3})$\u3002\n\n\u5176\u4ed6\u60c5\u51b5 $f_{i,1/2/3/4}$ \u4e0d\u53d8\u3002\n\n\u7b54\u6848\u662f $\\max f_{i,4}$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint f[5];\nint main(){\n  int n;\n  cin>>n;\n  for(int i=1;i<=n;i++){\n    int x;\n    cin>>x;\n    if(x==1){\n      f[1]=f[1]+1;\n      f[2]=max(f[1],f[2]);\n      f[3]=max(f[2],f[3]+1);\n      f[4]=max(f[3],f[4]);\n    }\n    else{\n      f[1]=f[1];\n      f[2]=max(f[2]+1,f[1]);\n      f[3]=max(f[3],f[2]);\n      f[4]=max(f[4]+1,f[3]);\n    }\n  }\n  cout<<f[4]<<'\\n';\n}\n```\n\n",
        "postTime": 1665799894,
        "uid": 674901,
        "name": "liuxuanxi",
        "ccfLevel": 0,
        "title": "CF933A"
    },
    {
        "content": "#### \u9898\u76ee\u5206\u6790\n\u8fd9\u9898\u4e4d\u4e00\u770b\u4e0d\u597d\u60f3\uff0c\u4f46\u662f\u770b\u5230 $1 \\leq a_i \\leq 2$ \u65f6\uff0c\u4fbf\u53d1\u73b0\u6709\u7384\u673a\u3002\n\n\u53ef\u5f97\u77e5\u6700\u7ec8\u7b54\u6848\u662f\u5728 $[1,1,1,...][2,2,2,...][1,1,1,...][2,2,2,...]$ \u8fd9\u6837\u7684\u5e8f\u5217\u4e2d\uff0c\u901a\u8fc7\u7ffb\u8f6c\u7b2c $2$\uff0c$3$ \u4e2a\u5e8f\u5217\u4e4b\u540e\u5f97\u51fa\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u52a8\u6001\u89c4\u5212\u6765\u7ef4\u62a4\u6bcf\u4e00\u6bb5\u7684\u6700\u5927\u503c\u3002\n\n\u5b9a\u4e49 $f[i][j]$ \u4e3a\u524d $i$ \u4e2a\u6570\u4e2d\u524d $j$ \u6bb5\u7684\u7b54\u6848\u3002\n\n\u5bf9\u4e8e\u5e8f\u5217\n\n$111112222$\n\n\u53ef\u4ee5\u5c06\u5176\u6309\u4e0a\u9762\u5206\u6210\u4e24\u7ec4\u3002\n\n\u5408\u7406\u8fd0\u7528\u4e00\u4e0b\u5224\u7b49\uff0c\n\n\u5219\u6709\n\n$$\nf[i][1]=f[i-1][j]+(a[i]==1)\n$$\n\n$$\nf[i][2]=max(f[i\u22121][1],f[i\u22121][2]+(a[i]==2))\n$$\n\n\u5bf9\u4e8e\u5e8f\u5217\n\n$12212211212$\n\n\u5f97\u5230\u6700\u7ec8\u7b54\u6848\u65f6\u7684\u6700\u957f\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\u662f\uff1a\n\n$111122222$\n\n\u5728\u6b64\u57fa\u7840\u4e0a\u7ffb\u8f6c\u56de\u53bb\uff0c\u5219\u4e3a\uff1a\n\n$122221112$\n\n\u53d1\u73b0\u5b83\u7b26\u5408\u4e0a\u9762\u7684\u6309 $4$ \u4e2a\u7ec4\u7684\u5206\u7ec4\u5f62\u5f0f\u3002\n\n\u5219\u6709\n\n$$\nf[i][3]=max(f[i\u22121][2],f[i\u22121][3]+(a[i]==1)\n$$\n\n$$\nf[i][4]=max(f[i\u22121][3],f[i\u22121][4]+(a[i]==2)\n$$\n\n\u89c2\u5bdf\uff0c\u53d1\u73b0\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u53ef\u4ee5\u538b\u6389\u7b2c\u4e00\u7ef4\u3002\n\n#### \u6838\u5fc3\u4ee3\u7801\n```cpp\nll n,ans,f[12];\nint main()\n{\n    n=read();\n    for (ll i = 1; i <= n; i++)\n    {\n        ll tmp;\n        scanf(\"%lld\", &tmp);\n        f[1] += (tmp == 1);\n        f[2] = max(f[1], f[2] + (tmp == 2));\n        f[3] = max(f[2], f[3] + (tmp == 1));\n        f[4] = max(f[3], f[4] + (tmp == 2));\n    }\n    printf(\"%lld\\n\",f[4]);\n    return 0;\n}\n```\n",
        "postTime": 1619185643,
        "uid": 355844,
        "name": "EdisonBa",
        "ccfLevel": 4,
        "title": "CF933A \u9898\u89e3"
    },
    {
        "content": "## Description\n\n[\u9898\u5e93\u94fe\u63a5](http://codeforces.com/problemset/problem/933/A)\n\n\u7ed9\u4f60\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u53ea\u542b\u6709 $1,2$ \u7684\u5e8f\u5217\u3002\u4f60\u53ef\u4ee5\u9009\u62e9\u5176\u4e2d\u7684\u4e00\u6bb5 $[l,r]$ \uff0c\u5c06\u533a\u95f4\u7ffb\u8f6c\uff0c\u7ffb\u8f6c\u540e\u4f7f\u5f97\u5355\u8c03\u4e0d\u4e0b\u964d\u5e8f\u5217\u6700\u957f\u3002\u6c42\u6700\u957f\u957f\u5ea6\u3002\n\n$1\\leq n\\leq 2000$\n\n## Solution\n\n\u8003\u8651\u7ebf\u6bb5\u6811\u7ef4\u62a4\u4e00\u7cfb\u5217\u77e9\u9635\uff0c\u5206\u522b\u8868\u793a\u533a\u95f4\u5185\u6240\u9009\u7684\u6570\u5b57\u7531 $1\\rightarrow 1,1\\rightarrow 2,2\\rightarrow 1,2\\rightarrow 2$ \u53d8\u5316\u7684\u6700\u957f\u4e0d\u4e0b\u964d\u5e8f\u5217\u7684\u957f\u5ea6\u3002\n\n\u6211\u4eec\u679a\u4e3e\u7ffb\u8f6c\u533a\u95f4\u7684\u5de6\u53f3\u7aef\u70b9\uff0c\u7ebf\u6bb5\u6811\u4e0a\u5206\u4e09\u6bb5\u67e5\u8be2\u3002\u518d\u5728\u4e09\u6bb5\u533a\u95f4\u95f4\u8ba8\u8bba\u5373\u53ef\u3002\n\n## Code\n\n```cpp\n//It is made by Awson on 2018.2.14\n#include <bits/stdc++.h>\n#define LL long long\n#define dob complex<double>\n#define Abs(a) ((a) < 0 ? (-(a)) : (a))\n#define Max(a, b) ((a) > (b) ? (a) : (b))\n#define Min(a, b) ((a) < (b) ? (a) : (b))\n#define Swap(a, b) ((a) ^= (b), (b) ^= (a), (a) ^= (b))\n#define writeln(x) (write(x), putchar('\\n'))\n#define lowbit(x) ((x)&(-(x)))\nusing namespace std;\nconst int N = 2000;\nvoid read(int &x) {\n    char ch; bool flag = 0;\n    for (ch = getchar(); !isdigit(ch) && ((flag |= (ch == '-')) || 1); ch = getchar());\n    for (x = 0; isdigit(ch); x = (x<<1)+(x<<3)+ch-48, ch = getchar());\n    x *= 1-2*flag;\n}\nvoid print(int x) {if (x > 9) print(x/10); putchar(x%10+48); }\nvoid write(int x) {if (x < 0) putchar('-'); print(Abs(x)); }\n\nint n, a[N+5], sum2, ans;\nstruct mat {\n\tint a[2][2];\n\tmat() {a[0][0] = a[0][1] = a[1][0] = a[1][1] = 0; }\n\tmat operator * (const mat &b) const {\n\t\tmat ans;\n\t\tans.a[0][0] = a[0][0]+b.a[0][0];\n\t\tans.a[0][1] = Max(a[0][0]+b.a[0][1], a[0][1]+b.a[1][1]);\n\t\tans.a[1][0] = Max(a[1][1]+b.a[1][0], a[1][0]+b.a[0][0]);\n\t\tans.a[1][1] = a[1][1]+b.a[1][1];\n\t\treturn ans;\n\t}\n};\nstruct Segment_Tree {\n\tmat sgm[(N<<2)+5];\n\t#define lr(o) (o<<1)\n\t#define rr(o) (o<<1|1)\n\tvoid build(int o, int l, int r) {\n\t\tif (l == r) {\n\t\t\tif (a[l] == 1) sgm[o].a[0][0] = sgm[o].a[1][0] = 1;\n\t\t\telse sgm[o].a[0][1] = sgm[o].a[1][1] = 1;\n\t\t\treturn;\n\t\t}\n\t\tint mid = (l+r)>>1;\n\t\tbuild(lr(o), l, mid), build(rr(o), mid+1, r);\n\t\tsgm[o] = sgm[lr(o)]*sgm[rr(o)];\n\t}\n\tmat query(int o, int l, int r, int a, int b) {\n\t\tif (a <= l && r <= b) return sgm[o];\n\t\tint mid = (l+r)>>1;\n\t\tif (b <= mid) return query(lr(o), l, mid, a, b);\n\t\tif (a > mid) return query(rr(o), mid+1, r, a, b);\n\t\treturn query(lr(o), l, mid, a, b)*query(rr(o), mid+1, r, a, b);\n\t}\n}T1;\n\nvoid work() {\n\tread(n);\n\tfor (int i = 1; i <= n; i++) read(a[i]), sum2 += (a[i] == 2);\n\tif (sum2 == n || sum2 == 0) {writeln(n); return; }\n\tT1.build(1, 1, n); ans = Max(T1.sgm[1].a[0][0], T1.sgm[1].a[0][1]); ans = Max(ans, T1.sgm[1].a[1][1]);\n\tfor (int l = 1; l <= n; l++) for (int r = l+1; r <= n; r++) {\n\t\tmat a, b, c;\n\t\tif (l != 1) a = T1.query(1, 1, n, 1, l-1);\n\t\tb = T1.query(1, 1, n, l, r);\n\t\tif (r != n) c = T1.query(1, 1, n, r+1, n);\n\t\tans = Max(ans, a.a[0][1]+b.a[1][1]+c.a[1][1]);\n\t\tans = Max(ans, a.a[0][0]+b.a[1][0]+c.a[1][1]);\n\t\tans = Max(ans, a.a[0][0]+b.a[0][0]+c.a[0][1]);\n\t}\n\twriteln(ans);\n}\nint main() {\n\twork(); return 0;\n}\n```",
        "postTime": 1519305075,
        "uid": 11773,
        "name": "NaVi_Awson",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF933A \u3010A Twisty Movement\u3011"
    }
]
[
    {
        "content": "\u8003\u8651\u4ec0\u4e48\u6837\u7684 $a_i$ \u80fd\u591f\u51fa\u73b0\u5728\u6240\u9009\u7684\u6570\u5217\u4e2d\u3002\u663e\u7136\u5176\u9700\u8981\u6ee1\u8db3\uff1a\n$$a_i \\geq a_{(ks+i)\\%n}$$\n\n\u5176\u4e2d $k$ \u662f\u4e00\u4e2a\u5927\u4e8e $0$ \u7684\u6574\u6570\u3002\u800c $(ks+i)\\%n$ \u53ef\u4ee5\u8868\u793a\u6210 $ks+tn+i$ \u7684\u5f62\u5f0f\uff0c\u5176\u4e2d $t$ \u662f\u4e00\u4e2a\u5927\u4e8e\u7b49\u4e8e $0$ \u7684\u6574\u6570\u3002\u901a\u8fc7\u5c0f\u5b66\u5965\u6570\u77e5\u8bc6\u53ef\u4ee5\u77e5\u9053\uff0c $ks+tn$ \u53ef\u4ee5\u8868\u793a\u6210 $l \\gcd(s, n)$ \u7684\u5f62\u5f0f\uff08\u5176\u4e2d $l$ \u4e3a\u4efb\u610f\u6b63\u6574\u6570\uff09\uff0c\u56e0\u6b64 $a_i$ \u9700\u8981\u6ee1\u8db3\u7684\u6761\u4ef6\u5373\u4e3a\uff1a\n\n$$a_i \\geq a_{l\\gcd(s,n)+i}$$\n\n\u8003\u8651\u628a\u539f\u6570\u5217\u6309\u7167\u95f4\u9694 $gcd(s,n)$ \u4e2a\u6570\u5206\u6210\u82e5\u5e72\u7ec4\uff0c\u90a3\u4e48 $a_i$ \u80fd\u591f\u51fa\u73b0\u5728\u6240\u9009\u7684\u6570\u5217\u4e2d\u5f53\u4e14\u6743\u5f53 $a_i$ \u662f\u8fd9\u4e00\u7ec4\u6570\u4e2d\u6700\u5927\u7684\u4e00\u4e2a\u3002\u8003\u8651\u679a\u4e3e $gcd(s,n)$\uff0c\u8bbe\u8fd9\u4e2a\u6570\u4e3a $d$\uff0c\u663e\u7136 $d|n$\u3002\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $a_i$\uff0c\u82e5\u5b83\u662f\u5b83\u6240\u5728\u7684\u7ec4\u4e2d\u6700\u5927\u7684\u6570\uff0c\u5c31\u5c06\u5176\u8bbe\u4e3a $1$\uff0c\u5426\u5219\u5c06\u5176\u8bbe\u4e3a $0$\uff0c\u5982\u6b64\u5904\u7406\u540e\u6211\u4eec\u5c31\u5f97\u5230\u4e86\u4e00\u4e2a $01$ \u6570\u5217\u3002\n\n\u7136\u540e\u8bbe $f_i$ \u4e3a\u4ee5 $i$ \u4e3a\u7ed3\u5c3e\u7684\u6700\u957f $1$ \u8fde\u7eed\u6bb5\u7684\u957f\u5ea6\uff0c\u8fd9\u4e2a\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2a\u5341\u5206\u7b80\u5355\u7684 dp \u6c42\u51fa\u3002\u7136\u540e\u679a\u4e3e\u957f\u5ea6\uff0c\u8bbe $cnt_i$ \u4e3a $[1,i]$ \u4e2d\u6709\u591a\u5c11\u4e2a $s$ \u6ee1\u8db3 $gcd(s,n)$ \u7b49\u4e8e\u6240\u679a\u4e3e\u7684 $d$\uff08\u5373\u4e3a\u5408\u6cd5\u7684\u957f\u5ea6\u4e2a\u6570\uff09\uff0c\u90a3\u4e48\u5bf9\u4e8e\u4e00\u4e2a $f_i$\uff0c\u5176\u5bf9\u4e8e\u7b54\u6848\u7684\u8d21\u732e\u5373\u4e3a $cnt_{f_i}$\u3002\n\n\u7136\u800c\u76f4\u63a5\u7b97\u7684\u8bdd\u53d1\u73b0\u662f\u4f1a\u8d85\u65f6\u7684\uff0c\u8fd9\u4e5f\u662f\u8fd9\u4e2a\u9898\u6700\u9b54\u6cd5\u7684\u5730\u65b9\uff0c\u56e0\u4e3a\u6c42 $\\gcd$ \u7684\u65f6\u5019\u5e26\u4e00\u4e2a $\\log$\uff0c\u5982\u679c\u6c42 $\\gcd$ \u7684\u6b21\u6570\u8fc7\u591a\u6216\u8005\u6570\u8fc7\u5927\u7684\u8bdd\u5c31\u4f1a\u8d85\u65f6\u3002\u53ef\u4ee5\u9884\u5904\u7406 $\\gcd$\uff0c\u6216\u8005\u4e5f\u53ef\u4ee5\u628a\u679a\u4e3e $s$ \u6539\u4e3a\u679a\u4e3e $\\lfloor \\frac{s}{d} \\rfloor$\uff0c\u7136\u540e\u5224\u65ad $gcd(\\lfloor \\frac{s}{d} \\rfloor,\\lfloor \\frac{n}{d} \\rfloor)$ \u662f\u5426\u7b49\u4e8e $1$\uff0c\u8fd9\u6837\u5c31\u51cf\u5c0f\u4e86\u6c42 $\\gcd$ \u7684\u6570\u7684\u8303\u56f4\u3002\u8fd8\u8981\u6ce8\u610f\u56e0\u4e3a\u5b83\u662f\u4e00\u4e2a\u5faa\u73af\u6570\u7ec4\uff0c\u56e0\u6b64\u8ba1\u7b97\u65f6\u8981\u5c06 $a$ \u62c9\u6210\u4e24\u500d\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $(d(n)\\times n)$\uff0c\u5176\u4e2d $d(n)$ \u8868\u793a $n$ \u7684\u56e0\u6570\u4e2a\u6570\u3002\n\n```cpp\n#include <set>\n#include <cmath>\n#include <vector>\n#include <cstdio>\n#include <cstddef>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\n#define pii pair<int, int>\n#define mp make_pair\n#define int long long\nusing namespace std;\n \ninline int read() {\n\tint x = 0, w = 1;char ch = getchar();\n\twhile (ch > '9' || ch < '0') { if (ch == '-')w = -1;ch = getchar(); }\n\twhile (ch >= '0' && ch <= '9')x = x * 10 + ch - '0', ch = getchar();\n\treturn x * w;\n}\ninline void write(int x) {\n    if (x < 0) putchar('-'), x = -x;\n    if (x > 9) write(x / 10);\n    putchar(x % 10 + '0');\n}\n \nconst int maxn = 1e6 + 5;\nconst int mod = 998244353;\nconst int inf = 0x3f3f3f3f3f3f3f;\n \ninline int min(int x, int y) { return x < y ? x : y; }\ninline int max(int x, int y) { return x > y ? x : y; }\n\nint n, ans, a[maxn], f[maxn], g[maxn], cnt[maxn];\nbool buc[maxn];\n\ninline int gcd(int a, int b) {\n    return !b ? a : gcd(b, a % b);\n}\n\nsigned main(void) {\n    n = read();\n    for (int i = 1;i <= n;i++) a[i] = read(), a[i + n] = a[i];\n    for (int d = 1;d < n;d++) {\n        if (n % d == 0) {\n            memset(buc, 0, sizeof(buc));\n            for (int k = 0;k < d;k++) {\n                g[k] = 0;\n                for (int i = k;i < (n << 1);i += d) g[k] = max(g[k], a[i]);\n                for (int i = k;i < (n << 1);i += d) if (g[k] == a[i]) buc[i] = 1;\n            }\n            f[0] = buc[0];\n            for (int i = 1;i < (n << 1);i++) {\n                if (buc[i]) f[i] = f[i - 1] + 1; else f[i] = 0;\n                f[i] = min(f[i], n - 1);\n            }\n            cnt[0] = 0;\n            for (int i = 1;i < (n / d);i++) cnt[i] = cnt[i - 1] + (gcd(i, n / d) == 1);\n            for (int i = n;i < (n << 1);i++) ans += cnt[f[i] / d];\n        }\n    }\n    printf(\"%lld\\n\", ans);\n    return 0;\n}\n```\n",
        "postTime": 1617985841,
        "uid": 246019,
        "name": "_came11ia_",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF582C\u3010Superior Periodic Subarrays\u3011"
    }
]
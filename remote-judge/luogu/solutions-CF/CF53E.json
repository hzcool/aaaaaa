[
    {
        "content": "### Update\n* 2022-02-10 \u4fee\u6539\u4e86\u67ff\u5b50\u4e2d\u7684\u51e0\u5904\u5c0f\u9519\u8bef\uff0c\u5e76\u589e\u52a0\u90e8\u5206\u8bf4\u660e\u3002\n\n---\n### \u524d\u8a00\n\n\u6821\u5185\u6a21\u62df\u8d5b\u505a\u5230\u8fd9\u9898\uff0c\u6211\u5199\u4e86\u4e00\u4e2a $O^* (2^n)$ \u7684\u505a\u6cd5\uff0c\u7ed3\u679c\u53d1\u73b0\u65c1\u8fb9\u540c\u5b66\u5168\u662f\u72b6\u538b dp \u7684 $O^* (3^n)$ \u751a\u81f3\u4e0d\u77e5\u9053\u548b\u4e48\u6765\u7684 $O^* (4^n)$ \u505a\u6cd5\u2026\u2026\n\n\u90a3\u4e48\u6211\u662f\u548b\u505a\u7684\u5462\uff1f**\u5bb9\u65a5 + \u77e9\u9635\u6811\u5b9a\u7406**\u3002\n\n---\n### \u9898\u610f\u7b80\u8ff0\n\n\u7ed9\u4e00\u4e2a\u8282\u70b9\u4e2a\u6570\u4e0d\u8d85\u8fc7 $10$ \u7684\u7b80\u5355\u65e0\u5411\u56fe\uff0c\u95ee\u6709\u591a\u5c11\u68f5\u751f\u6210\u6811\uff08\u6709\u6807\u53f7\uff09\u4f7f\u5f97\u5b83\u7684\u53f6\u7ed3\u70b9\u4e2a\u6570\u4e3a $k$\u3002\n\n---\n### \u601d\u8def\n\n\u5206\u7c7b\u8ba8\u8bba\u3002\n\n\u7279\u5224\u6389 $n=1,2$ \u7684\u60c5\u51b5\uff0c\u8fd9\u4e2a\u5f88\u597d\u5904\u7406\u3002\n\n\u4e0b\u9762\u8003\u8651 $n\\ge3$ \u7684\u60c5\u51b5\uff0c\u6b64\u65f6\u53f6\u7ed3\u70b9\u4e2a\u6570\u4e25\u683c\u5c0f\u4e8e $n$\u3002\n\n---\n\u770b\u5230**\u751f\u6210\u6811\u8ba1\u6570**\u5c31\u60f3\u5230\u77e9\u9635\u6811\u5b9a\u7406\u3002\n\n\u4f46\u662f\u8fd9\u6709\u4e00\u4e2a $k$ \u4e2a\u53f6\u5b50\u7684\u8981\u6c42\uff0c\u90a3\u548b\u505a\u54e9\uff1f\n\n\u8003\u8651**\u5bb9\u65a5**\u3002\n\n\u6211\u4eec\u5047\u8bbe\u5df2\u7ecf\u94a6\u5b9a\u4e86**\u67d0** $\\omega\\ \\ (\\omega<n)$ \u4e2a\u53f6\u7ed3\u70b9\u7ec4\u5408 $a_1,a_2,\\dots,a_\\omega$\u3002\n\n\u90a3\u4e48**\u8fd9\u4e9b\u53f6\u7ed3\u70b9\u4e00\u5b9a\u548c\u672a\u88ab\u94a6\u5b9a\u7684\u7ed3\u70b9\u76f8\u8fde**\uff0c\u6bcf\u4e2a\u88ab\u94a6\u5b9a\u7684\u53f6\u7ed3\u70b9\u6709**\u4e00\u5b9a\u6570\u91cf\u7684\u9009\u6cd5**\u3002\n\n\u5bf9**\u672a\u88ab\u94a6\u5b9a\u7684\u7ed3\u70b9**\u8dd1**\u77e9\u9635\u6811**\u3002\n\n\u7531\u4e58\u6cd5\u539f\u7406\uff0c\u628a\u8fd9\u4e9b\u6570**\u4e58\u8d77\u6765**\uff0c\u5373\u662f\u5bf9\u8fd9 $\\omega$ \u4e2a\u7ed3\u70b9\u94a6\u5b9a\u65f6\u7684\u65b9\u6848\u6570 $f_{\\{a_\\omega\\}}$\u3002\n\n\u6211\u4eec\u5047\u8bbe\u5bb9\u65a5\u7cfb\u6570\u662f $S_{\\{a_\\omega\\}}$\n\n\u8003\u8651\u6bcf\u4e2a**\u771f\u6b63\u7684\u53f6\u7ed3\u70b9\u65b9\u6848** $A$ \u5728**\u54ea\u4e9b\u94a6\u5b9a** $\\{a_\\omega\\}$ \u65f6\u88ab\u679a\u4e3e\u5230\uff0c\u6709\uff1a\n\n$$\\sum_\\omega\\sum_{\\{a_\\omega\\}\\subseteq A}S_{\\{a_\\omega\\}}=[|A|=k]$$\n\n\u6211\u4eec\u4e0d\u96be\u60f3\u5230**\u5bf9\u4e8e\u540c\u6837\u7684 $\\omega$\uff0c\u5176\u5bb9\u65a5\u7cfb\u6570\u76f8\u540c**\uff0c\u5373 $S_\\omega$\u3002\uff08\u53ef\u4ee5\u6570\u5b66\u5f52\u7eb3\u6cd5\u8bc1\u660e\uff09\n\n\u90a3\u4e48\u4e0a\u5f0f\u5373\uff1a\n\n$$\\sum_\\omega\\binom{|A|}{\\omega}S_\\omega=[|A|=k]$$\n\n\u8fd9\u4e2a\u4e1c\u897f\u662f\u4e00\u4e2a\u4e8c\u9879\u5f0f\u53cd\u6f14\u7684\u5f62\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u7acb\u5373\u5f97\u5230\uff1a\n\n$$S_\\omega=(-1)^{\\omega-k}\\binom\\omega k$$\n\n\u4e8e\u662f\u7b54\u6848\u5373\uff1a\n\n$$\\sum_{k\\le|\\{a\\}|<n}(-1)^{|\\{a\\}|-k}\\binom{|\\{a\\}|}kf_{\\{a\\}}$$\n\n\u679a\u4e3e\u6240\u6709\u8fd9\u6837\u7684 $\\{a\\}$ \u5c31\u597d\u4e86\u3002\n\n\u603b\u590d\u6742\u5ea6 $O(n^32^n)$\uff0c\u5373 $O^* (2^n)$\u3002\n\n---\n### Code\n\n```cpp\n// 10^8 < 998244353\n// \u76f4\u63a5\u5728\u6a21 998244353 \u7684\u5269\u4f59\u7cfb\u4e0b\u64cd\u4f5c\n// \u94a6\u5b9a\u53f6\u5b50\uff0c\u5bb9\u65a5 + \u77e9\u9635\u6811\u5373\u53ef\n// \u5bb9\u65a5\u7cfb\u6570\u53ef\u4ee5\u4e8c\u9879\u5f0f\u53cd\u6f14\n// O*(2^n)\n// \u53ef\u4ee5\u901a\u8fc7\n\n#include <algorithm>\n#include <stdio.h>\n#include <vector>\ntypedef long long llt;\ntypedef unsigned uint;typedef unsigned long long ullt;\ntypedef bool bol;typedef char chr;typedef void voi;\ntypedef double dbl;\ntemplate<typename T>bol _max(T&a,T b){return(a<b)?a=b,true:false;}\ntemplate<typename T>bol _min(T&a,T b){return(b<a)?a=b,true:false;}\ntemplate<typename T>T power(T base,T index,T mod){return((index<=1)?(index?base:1):(power(base*base%mod,index>>1,mod)*power(base,index&1,mod)))%mod;}\ntemplate<typename T>T lowbit(T n){return n&-n;}\ntemplate<typename T>T gcd(T a,T b){return b?gcd(b,a%b):a;}\ntemplate<typename T>T lcm(T a,T b){return(a!=0||b!=0)?a/gcd(a,b)*b:(T)0;}\ntemplate<typename T>T exgcd(T a,T b,T&x,T&y){if(!b)return y=0,x=1,a;T ans=exgcd(b,a%b,y,x);y-=a/b*x;return ans;}\ntemplate<const ullt p=998244353>\nclass mod_ullt\n{\n    private:\n        ullt v;\n        inline ullt chg(ullt w){return(w<p)?w:w-p;}\n        inline mod_ullt _chg(ullt w){mod_ullt ans;ans.v=(w<p)?w:w-p;return ans;}\n    public:\n        mod_ullt():v(0){}\n        mod_ullt(ullt v):v(v%p){}\n        bol empty(){return!v;}\n        inline ullt val(){return v;}\n        friend bol operator<(mod_ullt a,mod_ullt b){return a.v<b.v;}\n        friend bol operator>(mod_ullt a,mod_ullt b){return a.v>b.v;}\n        friend bol operator<=(mod_ullt a,mod_ullt b){return a.v<=b.v;}\n        friend bol operator>=(mod_ullt a,mod_ullt b){return a.v>=b.v;}\n        friend bol operator==(mod_ullt a,mod_ullt b){return a.v==b.v;}\n        friend bol operator!=(mod_ullt a,mod_ullt b){return a.v!=b.v;}\n        inline friend mod_ullt operator+(mod_ullt a,mod_ullt b){return a._chg(a.v+b.v);}\n        inline friend mod_ullt operator-(mod_ullt a,mod_ullt b){return a._chg(a.v+a.chg(p-b.v));}\n        inline friend mod_ullt operator*(mod_ullt a,mod_ullt b){return a.v*b.v;}\n        friend mod_ullt operator/(mod_ullt a,mod_ullt b){return b._power(p-2)*a.v;}\n        inline mod_ullt operator-(){return _chg(p-v);}\n        mod_ullt sqrt()\n        {\n            if(power(v,(p-1)>>1,p)!=1)return 0;\n            mod_ullt b=1;do b++;while(b._power((p-1)>>1)==1);\n            ullt t=p-1,s=0,k=1;while(!(t&1))s++,t>>=1;\n            mod_ullt x=_power((t+1)>>1),e=_power(t);\n            while(k<s)\n            {\n                if(e._power(1llu<<(s-k-1))!=1)x*=b._power((1llu<<(k-1))*t);\n                e=_power(p-2)*x*x,k++;\n            }\n            return _min(x,-x),x;\n        }\n        mod_ullt inv(){return _power(p-2);}\n        mod_ullt _power(ullt index){mod_ullt ans(1),w(v);while(index){if(index&1)ans*=w;w*=w,index>>=1;}return ans;}\n        voi read(){v=0;chr c;do c=getchar();while(c>'9'||c<'0');do v=(c-'0'+v*10)%p,c=getchar();while(c>='0'&&c<='9');v%=p;}\n        voi print()\n        {\n        \tstatic chr C[20];uint tp=0;\n        \tullt w=v;do C[tp++]=w%10+'0',w/=10;while(w);\n        \twhile(tp--)putchar(C[tp]);\n        }\n        voi println(){print(),putchar('\\n');}\n        mod_ullt operator++(int){mod_ullt ans=*this;return v=chg(v+1),ans;}\n    public:\n        inline ullt&operator()(){return v;}\n        inline mod_ullt&operator+=(mod_ullt b){return*this=_chg(v+b.v);}\n        inline mod_ullt&operator-=(mod_ullt b){return*this=_chg(v+chg(p-b.v));}\n        inline mod_ullt&operator*=(mod_ullt b){return*this=v*b.v;}\n        mod_ullt&operator/=(mod_ullt b){return*this=b._power(p-2)*v;}\n        mod_ullt&operator++(){return v=chg(v+1),*this;}\n};\nconst ullt Mod=998244353;\ntypedef mod_ullt<Mod>modint;\nconst uint Siz=35;\nstruct Mat\n{\n    modint M[Siz][Siz];uint n;\n    Mat():n(0){}\n    Mat(uint n):n(n){}\n    modint*operator[](uint n){return M[n];}\n    voi bzr(){resize(0);}\n    voi resize(uint s)\n    {\n        for(uint i=s;i<n;i++)for(uint j=0;j<n;j++)M[i][j]=M[j][i]=0;\n        n=s;\n    }\n    modint det()\n    {\n        Mat A=*this;\n        modint ans(1);\n        for(uint i=0;i<n;i++)\n        {\n            {\n                uint j;for(j=i;j<n&&!A[j][i]();j++);\n                if(j==n)return 0;\n                if(i!=j)\n                {\n                    ans=-ans;\n                    for(uint k=0;k<n;k++)std::swap(A[i][k],A[j][k]);\n                }\n            }\n            modint qaq=A[i][i];\n            ans*=qaq;qaq=qaq.inv();\n            for(uint j=0;j<n;j++)A[i][j]*=qaq;\n            for(uint j=0;j<n;j++)if(A[j][i]()&&i!=j)\n            {\n                qaq=A[j][i];\n                for(uint k=0;k<n;k++)A[j][k]-=A[i][k]*qaq;\n            }\n        }\n        for(uint i=0;i<n;i++)ans*=A[i][i];\n        return ans;\n    }\n};\ntypedef std::pair<uint,uint>Pair;\nstd::vector<Pair>E;\nMat M;\nmodint P[35],Q[35];\nmodint binom(uint n,uint m){return P[n]*Q[m]*Q[n-m];}\nint main()\n{\n\tP[0]=1;for(uint i=1;i<=30;i++)P[i]=P[i-1]*i;\n\tQ[30]=P[30].inv();for(uint i=30;i;i--)Q[i-1]=Q[i]*i;\n\tuint n,m,k;\n\tscanf(\"%u%u%u\",&n,&m,&k);\n\tif(n==1)puts(k==1?\"1\":\"0\");\n\telse if(n==2)puts(m==1&&k==2?\"1\":\"0\");\n\telse\n\t{\n\t\tif(!k||k>=n)return puts(\"0\"),0;\n\t\tuint u,v;while(m--)scanf(\"%u%u\",&u,&v),E.push_back(Pair(u-1,v-1));\n\t\tmodint ans;\n\t\tfor(uint i=0;i<(1u<<n)-1;i++)if(__builtin_popcount(i)>=k)\n\t\t{\n\t\t\tmodint now;\n\t\t\tstd::vector<uint>Leaf,Any,Back(n);\n\t\t\tfor(uint j=0;j<n;j++)\n\t\t\t\tif(i>>j&1)Back[j]=Leaf.size(),Leaf.push_back(j);\n\t\t\t\telse Back[j]=Any.size(),Any.push_back(j);\n\t\t\tstd::vector<modint>Time(Leaf.size());\n\t\t\tM.bzr();\n\t\t\tM.resize(Any.size());\n\t\t\tfor(auto e:E)\n\t\t\t{\n\t\t\t\tif((i>>e.first&1)&&!(i>>e.second&1))\n\t\t\t\t\tTime[Back[e.first]]++;\n\t\t\t\telse if(!(i>>e.first&1)&&(i>>e.second&1))\n\t\t\t\t\tTime[Back[e.second]]++;\n\t\t\t\telse if(!(i>>e.first&1)&&!(i>>e.second&1))\n\t\t\t\t{\n\t\t\t\t\tu=Back[e.first],v=Back[e.second];\n\t\t\t\t\tM[u][u]+=1,M[v][v]+=1,\n\t\t\t\t\tM[u][v]-=1,M[v][u]-=1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tM.resize(Any.size()-1);\n\t\t\tnow=M.det();\n\t\t\tfor(auto t:Time)now*=t;\n\t\t\tuint w=__builtin_popcount(i);\n\t\t\tans+=((w-k)&1)?-binom(w,k)*now:binom(w,k)*now;\n\t\t}\n\t\tans.println();\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1644383090,
        "uid": 105050,
        "name": "myee",
        "ccfLevel": 7,
        "title": "53E"
    },
    {
        "content": "### \u9898\u610f\uff1a\n\u3000\u3000\u7ed9\u4e00\u4e2an(n<=10)\u4e2a\u8282\u70b9\u7684\u65e0\u5411\u56fe,\u56fe\u91cc\u9762\u6709m\u6761\u8fb9\uff0c\u4ee5\u8fd9m\u6761\u8fb9\u6784\u5efa\u751f\u6210\u6811\uff0c\u6c42\u6240\u6709\u751f\u6210\u6811\u4e2d\u53ea\u542b\u6709k\u4e2a\u5ea6\u6570\u4e3a1\u7684\u70b9\u7684\u65b9\u6848\u6570\u3002\n\n### \u9898\u89e3\uff1a\n\u3000\u3000\u770b\u89c1\u8fd9\u4e2a\u6570\u91cf\u7ea7\u5c31\u4e00\u5b9a\u4f1a\u60f3\u5230\u72b6\u6001\u538b\u7f29dp...\n  \n   \u90a3\u8ba9\u6211\u4eec\u8bbe\u8ba1\u4e00\u4e0b\u72b6\u6001\uff1a\n   \n   **dp[i][j]**  \u8868\u793a\u751f\u6210\u6811\u7684\u72b6\u6001\u4e3ai\u65f6\uff0c\u6240\u542b\u7684\u5ea6\u6570\u4e3a1\u7684\u70b9\u7684\u72b6\u6001j\u7684\u65b9\u6848\u6570\u3002\n\n\u3000\u3000\u90a3\u4e48\u5c31\u53ef\u4ee5\u8fdb\u884c\u72b6\u6001\u8f6c\u79fb\u4e86\uff0c\u6bcf\u6b21\u6709\u4e24\u79cd\u66f4\u65b0\u65b9\u5f0f\uff1a\n  \n   **1\uff1a\u52a0\u5165\u4e00\u6761\u8fb9(\u4e5f\u5c31\u662f\u4e00\u4e2a\u65b0\u70b9)\u5230\u539f\u6765\u5ea6\u6570\u4e3a1\u7684\u70b9\uff0c\u76f8\u5f53\u4e8e\u66ff\u6362\u4e86\u3002**\n   \n   **2\uff1a\u628a\u8fb9\u52a0\u5230\u4e00\u4e2a\u5ea6\u6570\u4e0d\u4e3a1\u7684\u8282\u70b9\u4e0a\u3002**\n   \n### \u65f6\u95f4\u590d\u6742\u5ea6\uff1a\n    \n   ~~**O\uff08\u80fd\u8fc7\uff09**~~\n   \n##    \u5e9f\u8bdd\u5c11\u8bf4\u4e0a\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxs=(1<<11)+10;\nvector<int> mapp[20];\nint dp[maxs][maxs],cnt1[maxs];\nint n,m,k;\nvoid init(){\n\tfor(int i=1;i<=maxs;i++)\n\t    for(int k=0;k<+15;k++)\n\t        if(i&(1<<k))\n\t           cnt1[i]++;\n}\nint main(){\n\tinit();\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tint x,y;\n\tfor(int i=1;i<=m;i++){\n\t\tscanf(\"%d%d\",&x,&y); x--;y--;\n\t\tmapp[x].push_back(y);mapp[y].push_back(x);\n\t}\n\tfor(int i=1;i<=(1<<n)-1;i<<=1) dp[i][i]=1;\n\tfor(int i=1;i<=(1<<n)-1;i++)\n\t\tfor(int j=i;j;--j&=i)\n\t\t\tif(dp[i][j])\n\t\t\t\tfor(int e=0;e<n;e++)\n\t\t\t\t\tif(i&(1<<e))\n\t\t\t\t\t\tfor(int r=0;r<mapp[e].size();r++){\n\t\t\t\t\t\t\tint to=mapp[e][r],now;\n\t\t\t\t\t\t\tif(~i&(1<<to)){\n\t\t\t\t\t\t\t\tif(cnt1[i]==1) now=i|(1<<to);\n                                else now=j&~(1<<e)|(1<<to);\n                                if(!(now>>to+1)) dp[i|(1<<to)][now]+=dp[i][j];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\tlong long ans=0;\n\tfor(int i=0;i<=(1<<n)-1;i++) \n\t    if(cnt1[i]==k)\n\t       ans+=dp[(1<<n)-1][i];\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1570360629,
        "uid": 66416,
        "name": "\u4f18\u5c11",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF53E \u3010Dead Ends\u3011"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF53E)\n\n---\n\n\u4e0d\u9519\u4e00\u9898\uff0c\u5c31\u662f\u6709\u4e9b\u5751\u70b9\u3002\n\n\u770b\u6570\u636e\u8303\u56f4\uff0c\u53ef\u4ee5\u5224\u65ad\u51fa\u662f\u72b6\u538b $\\text{dp}$\u3002\n\n\u5b9a\u4e49 $dp_{i,j}$\uff0c$i$ \u662f\u5df2\u7ecf\u8fde\u4e86\u7684\u8fb9\uff0c$j$ \u662f\u6ee1\u8db3\u5ea6\u4e3a\u4e00\u7684\u3002\n\n\u4f46\u662f\uff0c\u4f60\u76f4\u63a5\u6253\u72b6\u538b\uff0c\u4f60\u4f1a\u5feb\u4e50\u5f00\u5fc3\u7684\u53d1\u73b0\uff0c\u4f60\u8fc7\u4e0d\u4e86\u6837\u4f8b\u3002\n\n\u4e00\u5f00\u59cb\u7684 $dp$\uff1a\n\n```cpp\nfor (int s = 0 ; s < cnt ; ++ s) if (Count(s) >= 2) {\n\tfor (int t = 0 ; t < cnt ; ++ t) if (Count(s) >= 2 && (s & t) == t && dp[s][t]) {\n\t\tfor (int j = 0 ; j < n ; ++ j) if (s & (1 << j)) {\n\t\t\tfor (int k = 0 ; k < n ; ++ k) if (!(s & (1 << k)) && g[j][k] && j != k) {\n\t\t\t\tint now = (t & (1 << j)) ? t ^ (1 << j) ^ (1 << k) : t ^ (1 << k);\n\t\t\t\tdp[s | (1 << k)][now] += dp[s][t];\n\t\t\t}\n\t\t}\n\t}\n}\n```\n\n\u5979\u6bd4\u7b54\u6848\u5927\u4e86\u8bb8\u591a\u2026\u2026\n\n\u8fd9\u662f\u4e3a\u4ec0\u4e48\u554a\uff1f\uff1f\uff1f\n\n\u8fd9\u662f\u56e0\u4e3a\u91cd\u590d\u8ba1\u7b97\u3002\n\n\u4f8b\u5982\u6837\u4f8b\u4e00\uff1a\n\n```in\n3 3 2\n1 2\n2 3\n1 3\n```\n\n\u4f60\u5148\u8fde $\\text{1,2}$ \u518d\u8fde $1,3$\uff0c\u53f6\u5b50\u8282\u70b9\u662f $1,2$\n\n\u4f60\u5148\u8fde $\\text{1,3}$ \u518d\u8fde $1,2$\uff0c\u53f6\u5b50\u8282\u70b9\u4e5f\u662f $1,2$\n\n\u7136\u800c\uff0c$\\operatorname {dp}$ \u7684\u72b6\u6001\u662f\u4e00\u6837\u7684\uff0c\u5c31\u4f1a\u91cd\u590d\u4e86\u3002\n\n\u6240\u4ee5\u6211\u4eec\u4eba\u4e3a\u63a7\u5236\u987a\u5e8f\uff0c\u4f7f\u5f97\u4e0d\u4f1a\u91cd\u590d\u8ba1\u7b97\u3002\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <cctype>\n#include <cstring>\n#include <iostream>\n#include <algorithm>\nusing namespace std;\n\ntemplate<typename T>void read(T &x) {\n\tx = 0;T f = 1;char ch = getchar();\n\twhile (!isdigit(ch)) {if (ch == '-') f = -1;ch = getchar();}\n\twhile (isdigit(ch)) {x = (x << 3) + (x << 1) + ch - '0';ch = getchar();}\n\tx *= f;\n}\ntemplate<typename T>void print(T x) {\n\tif (x < 0) putchar('-'),x = -x;\n\tif (x > 9) print(x / 10);\n\tputchar(x % 10 + '0');\n}\ntemplate<typename T>T Min(T x,T y) {return x < y ? x : y;}\ntemplate<typename T>T Max(T x,T y) {return x > y ? x : y;}\ntemplate<typename T>T Abs(T x) {return x < 0 ? -x : x;}\n\nint n,m,k,g[11][11];\nint dp[1 << 10][1 << 10];\n\nint Count(int x) {\n\tx = (x & 0x55555555) + ((x >> 1) & 0x55555555);\n\tx = (x & 0x33333333) + ((x >> 2) & 0x33333333);\n\tx = (x & 0x0f0f0f0f) + ((x >> 4) & 0x0f0f0f0f);\n\tx = (x & 0x00ff00ff) + ((x >> 8) & 0x00ff00ff);\n\tx = (x & 0x0000ffff) + ((x >> 16) & 0x0000ffff);\n\treturn x;\n}\n\nvoid Print(int x) {\n\tfor (int i = n - 1 ; ~i ; -- i) {\n\t\tprint((x >> i) & 1);\n\t}\n\tputs(\"\");\n}\n\nint main() {\n\tread(n);read(m);read(k);\n\tint x,y;\n\tfor (int i = 1 ; i <= m ; ++ i) {\n\t\tread(x);read(y);\n\t\tx --,y --;\n\t\tg[x][y] = g[y][x] = 1;\n\t}\n\tfor (int i = 0 ; i < n ; ++ i)\n\t\tfor (int j = 0 ; j < n ; ++ j)\n\t\t\tif (g[i][j]) dp[(1 << i) | (1 << j)][(1 << i) | (1 << j)] = 1;\n\tint cnt = 1 << n;\n\tfor (int s = 0 ; s < cnt ; ++ s) if (Count(s) >= 2) {\n\t\tfor (int t = 0 ; t < cnt ; ++ t) if (Count(s) >= 2 && (s & t) == t && dp[s][t]) {\n\t\t\tfor (int j = 0 ; j < n ; ++ j) if (s & (1 << j)) {\n\t\t\t\tfor (int k = 0 ; k < n ; ++ k) if (!(s & (1 << k)) && g[j][k] && j != k) {\n\t\t\t\t\tint now = (t & (1 << j)) ? t ^ (1 << j) ^ (1 << k) : t ^ (1 << k);\n\t\t\t\t\tif (!((now >> k) ^ 1)) dp[s | (1 << k)][now] += dp[s][t];\t\t//\u63a7\u5236\u4e0d\u91cd\u590d\u8ba1\u7b97\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint ans = 0;\n\tfor (int i = 0 ; i < cnt ; ++ i) {\n\t\tif (Count(i) == k) ans += dp[cnt - 1][i];\n\t}\n\tprint(ans);\n\treturn 0;\n}\n```",
        "postTime": 1599654254,
        "uid": 163516,
        "name": "Strelitzia",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF53E \u3010Dead Ends\u3011"
    },
    {
        "content": "\u6765\u4e00\u4e2a\u590d\u6742\u5ea6\u66f4\u4f18\u79c0\u7684\u505a\u6cd5\u3002\n\n\u9996\u5148\uff0c\uff08\u53ef\u80fd\u4e0d\u662f\uff09\u4f17\u6240\u5468\u77e5\u7684\u662f\uff0c\u7ed9\u5b9a\u4efb\u610f\u65e0\u5411\u56fe\uff0c\u6c42\u5176\u751f\u6210\u6811\u4e2a\u6570\uff0c\u53ef\u4ee5\u7528\u77e9\u9635\u6811\u5b9a\u7406\u6765\u5b9e\u73b0\u3002\n\n\uff08\u4ec0\u4e48\u4f60\u4e0d\u4f1a\u77e9\u9635\u6811\u5b9a\u7406\uff1f\u51fa\u95e8\u53f3\u8f6c\u767e\u5ea6\u4e00\u4e0b\uff09\n\n\u4f46\u662f\u8fd9\u4e2a\u9898\u8fd8\u6709\u4e00\u4e2a\u53f6\u5b50\u6570\u9650\u5236\u600e\u4e48\u529e\u5462\uff1f\n\n\u4e0d\u59a8\u8003\u8651\u679a\u4e3e\u54ea\u4e9b\u70b9\u4e00\u5b9a\u6210\u4e3a\u53f6\u5b50\uff0c\u7136\u540e\u4ece\u56fe\u4e2d\u5220\u53bb\u8fd9\u4e9b\u70b9\uff0c\u5bf9\u4e8e\u5269\u4e0b\u7684\u70b9\u8dd1\u4e00\u6b21\u751f\u6210\u6811\u8ba1\u6570\u3002\n\n\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u53f6\u5b50\u8282\u70b9\uff0c\u5b83\u53ef\u4ee5\u4ece\u8fde\u5411\u975e\u53f6\u5b50\u8282\u70b9\u7684\u51fa\u8fb9\u4e2d\u4efb\u9009\u4e00\u6761\u6302\u4e0a\u53bb\u3002\n\n\u4f46\u662f\u4ec5\u4ec5\u8fd9\u6837\u8fd8\u4e0d\u591f\uff0c\u56e0\u4e3a\u6211\u4eec\u53ea\u662f\u5f3a\u5236\u8ba9\u4e00\u90e8\u5206\u70b9\u6210\u4e3a\u53f6\u5b50\uff0c\u4f46\u53e6\u4e00\u90e8\u5206\u70b9\u5374\u5e76\u6ca1\u6709\u4fdd\u8bc1\u8ba9\u5b83\u4eec\u4e0d\u662f\u53f6\u5b50\u3002\n\n\u6362\u53e5\u8bdd\u8bf4\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u96c6\u5408s\u7684\u70b9\uff0c\u6211\u4eec\u80fd\u6c42\u51fafs\u8868\u793a\u6700\u540e\u7684\u53f6\u5b50\u8282\u70b9\u96c6\u5408\u5305\u542bs\u7684\u65b9\u6848\u6570\u3002\n\n\u90a3\u600e\u4e48\u5f97\u5230\u6070\u597d\u4e3as\u7684\u65b9\u6848\u6570\uff08\u4e0d\u59a8\u8bb0\u4f5cgs\uff09\u5462\uff1f\u6ce8\u610f\u5230\u5982\u679c\u628af\u548cg\u770b\u505an\u7ef4\u3001\u6bcf\u4e00\u7ef4\u5927\u5c0f\u4e3a2\u7684\u6570\u7ec4\uff0c\u90a3\u4e48f\u5c31\u662fg\u7684\u9ad8\u7ef4\u540e\u7f00\u548c\uff0c\u56e0\u6b64\u505a\u4e00\u6b21\u9ad8\u7ef4\u5dee\u5206\u5c31\u53ef\u4ee5\u4e86\u3002\uff08\u5176\u5b9e\u8fd9\u4e5f\u662fand\u8fd0\u7b97\u4e0b\u7684ifwt\u8fc7\u7a0b\uff09\n\n\u590d\u6742\u5ea6O(2^n\u00d7n^3)\uff0c\u7406\u8bba\u4e0a\u8bf4\u8dd1n=17\u4e0d\u6210\u95ee\u9898\u3002\n\n(\u6ce8\uff1a\u7531\u4e8e\u672c\u4eba\u592a\u61d2\uff0c\u76f4\u63a5\u7c98\u4e86\u4e2a\u6a21\u610f\u4e49\u4e0b\u7684\u9ad8\u65af\u6d88\u5143\uff0c\u4e0d\u8fc7\u7b54\u6848\u663e\u7136\u4e0d\u4f1a\u8d85\u8fc71e8\u56e0\u6b64\u4e5f\u65e0\u6240\u8c13\u5566)\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#define li long long\n#define gc getchar()\n#define pc putchar\ninline li read(){\n\tli x = 0,y = 0,c = gc;\n\twhile(!isdigit(c)) y = c,c = gc;\n\twhile(isdigit(c)) x = x * 10 + (c ^ '0'),c = gc;\n\treturn y == '-' ? -x : x;\n}\ninline void print(li x){\n\tif(x < 0) pc('-'),x = -x;\n\tif(x >= 10) print(x / 10);\n\tpc(x % 10 + '0');\n}\nint n,m,p,ed[20][20],wei[150010],mx,dy[20];\nli jz[20][20],as[150010];\nconst int mo = 1000000007;\ninline li ksm(li q,li w){\n\tli as = 1;\n\twhile(w){\n\t\tif(w & 1) as = as * q % mo;\n\t\tq = q * q % mo;\n\t\tw >>= 1;\n\t}\n\treturn as;\n} \ninline li wk(int cnt){\n\tregister int i,j,k;\n\tli as = 1,tmp;\n\tfor(i = 1;i <= cnt;++i){\n\t\tif(!jz[i][i]){\n\t\t\tint fg = 0;\n\t\t\tfor(j = i + 1;j <= cnt;++j) if(jz[j][i]){\n\t\t\t\tfg = j;break;\n\t\t\t}\n\t\t\tif(!fg) return 0;\n\t\t\tfor(j = i;j <= cnt;++j) std::swap(jz[i][j],jz[fg][j]);\n\t\t}\n\t\t(as *= jz[i][i]) %= mo;\n\t\ttmp = ksm(jz[i][i],mo - 2);\n\t\tfor(j = i;j <= cnt;++j) (jz[i][j] *= tmp) %= mo;\n\t\tfor(j = i + 1;j <= cnt;++j){\n\t\t\tfor(k = cnt;k >= i;--k) (jz[j][k] += mo - (jz[i][k] * jz[j][i]) % mo) %= mo;\n\t\t}\n\t}\n\treturn as;\n}\nint main(){\n\tint i,j,k,l,u,v;\n\tn = read();m = read();p = read();\n\tfor(i = 1;i <= m;++i){\n\t\tu = read();v = read();ed[u][v] = ed[v][u] = 1;\n\t}\n\tmx = 1 << n;\n\tfor(i = 0;i < mx;++i){\n\t\twei[i] = wei[i >> 1] + (i & 1);\n\t\tfor(j = 1;j <= n;++j) for(k = 1;k <= n;++k) jz[j][k] = 0;\n\t\tint cnt = 0;\n\t\tfor(j = 1;j <= n;++j) if(!(i & (1 << j - 1))) dy[++cnt] = j;\n\t\tfor(j = 1;j < cnt;++j) for(k = j + 1;k <= cnt;++k) if(ed[dy[j]][dy[k]]) jz[j][k] = jz[k][j] = mo - 1,++jz[j][j],++jz[k][k];\n\t\tas[i] = wk(cnt - 1);\n\t\tfor(j = 1;j <= n;++j) if(i & (1 << j - 1)){\n\t\t\tint tmp = 0;\n\t\t\tfor(k = 1;k <= n;++k) if(ed[j][k] && !(i & (1 << k - 1))) ++tmp;\n\t\t\tas[i] *= tmp;\n\t\t}\n\t}\n\tfor(i = 1;i < mx;i <<= 1) for(j = 0;j < mx;j += (i << 1)) for(k = j;k < j + i;++k) as[k] -= as[k + i];\n\tli ans = 0;\n\tfor(i = 0;i < mx;++i) if(wei[i] == p) ans += as[i];\n\tprint(ans);  \n\treturn 0;\n}\n```",
        "postTime": 1551624995,
        "uid": 45775,
        "name": "liuzhangfeiabc",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF53E \u3010Dead Ends\u3011"
    },
    {
        "content": "# Description\n\n\u7ed9\u5b9a\u4e00\u5f20 $n$ \u4e2a\u8282\u70b9\u548c $m$ \u4e2a\u8fb9\u7684\u65e0\u5411\u8fde\u901a\u56fe\uff0c\u6c42\u6709 $k$ \u4e2a\u53f6\u5b50\u7ed3\u70b9\u7684\u751f\u6210\u6811\u4e2a\u6570\u3002\n\n$n,k \\le 10, m \\le \\dbinom{n}{2}$\uff0c\u65f6\u9650 5s\u3002\n\n# Solution\n\n\u6ca1\u6709\u523b\u610f\u5361\u5e38\u7adf\u7136\u4e00\u53d1\u8dd1\u5230\u4e86[\u6700\u4f18\u89e3](https://www.luogu.com.cn/record/list?pid=CF53E&orderBy=1&status=&page=1)\u2026\u2026\n\n------------\n\n\u751f\u6210\u6811\u8ba1\u6570\u95ee\u9898\u663e\u7136\u8003\u8651 Matrix Tree \u5b9a\u7406\uff0c\u4f46\u662f\u9898\u76ee\u4e2d\u52a0\u4ee5\u4e86\u5bf9\u53f6\u5b50\u4e2a\u6570\u7684\u9650\u5236\uff0c\u6ca1\u6709\u529e\u6cd5\u5f88\u597d\u5730\u5e94\u7528\u7ed3\u8bba\u3002\n\n\u4e0d\u59a8\u94a6\u5b9a\u4e00\u4e9b\u70b9\u6210\u4e3a\u53f6\u5b50\uff0c\u7136\u540e\u5bf9\u5269\u4e0b\u7684\u70b9\u8dd1\u4e00\u904d Matrix Tree\uff0c\u7b97\u51fa\u5176\u751f\u6210\u6811\u4e2a\u6570\uff0c\u7136\u540e\u518d\u628a\u94a6\u5b9a\u7684\u70b9\u8fde\u4e0a\u53bb\uff0c\u65b9\u6848\u6570\u4e58\u8d77\u6765\u5373\u53ef\u3002\n\n\u8fd9\u6837\u8ba1\u6570\u663e\u7136\u4f1a\u6709\u91cd\u590d\uff0c\u56e0\u4e3a\u672a\u94a6\u5b9a\u7684\u70b9\u4e5f\u6709\u53ef\u80fd\u6210\u4e3a\u53f6\u5b50\u3002\n\n\u5047\u8bbe\u6211\u4eec\u73b0\u5728\u5df2\u7ecf\u5f97\u5230\u4e86\u94a6\u5b9a\u96c6\u5408 $S$ \u6210\u4e3a\u53f6\u5b50\u7684\u65b9\u6848\u6570 $f_S$\uff0c\u8003\u8651\u600e\u6837\u5f97\u5230\u6070\u597d\u53f6\u5b50\u96c6\u5408\u662f $S$ \u7684\u65b9\u6848\u6570 $g_S$\u3002\u4e0d\u96be\u53d1\u73b0\uff0c\u6709\n\n$$f_S=\\sum_{T\\&S=S} g_T$$\n\n\u8fd9\u662f FWT \u7684\u5f62\u5f0f\uff0c\u5bf9 $f_S$ \u8dd1\u4e00\u904d and \u7684 IFWT \u5373\u53ef\u3002\n\n\u81f3\u6b64\u6211\u4eec\u5728 $\\mathcal O(n^32^n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e0b\u89e3\u51b3\u4e86\u672c\u9898\uff0c\u6bd4\u679a\u4e3e\u5b50\u96c6\u7684 $\\mathcal O(n^23^n)$ \u72b6\u538b DP \u4e0d\u77e5\u9053\u9ad8\u5230\u54ea\u91cc\u53bb\u4e86\u3002\n\n# Code\n\n```cpp\ntypedef long long LL;\n\nconst int N=15,S=(1<<10)+5;\nconst LL mod=998244353;\n\nint n,m,q,c[S];\nbitset<N> g[N];\nLL f[N][N],u[S],Ans;\nvector<int> v;\n\nLL Gas(int n,LL f[N][N]) {\n\tLL x=1;\n\tfor (int i=2;i<=n;i++)\n\t\tfor (int j=i+1;j<=n;j++) {\n\t\t\twhile (f[i][i]) {\n\t\t\t\tLL v=f[j][i]/f[i][i];\n\t\t\t\tfor (int k=i;k<=n;k++) f[j][k]=(f[j][k]-f[i][k]*v%mod+mod)%mod;\n\t\t\t\tswap(f[i],f[j]),x=-x;\n\t\t\t}\n\t\t\tswap(f[i],f[j]),x=-x;\n\t\t}\n\tfor (int i=2;i<=n;i++) x=x*f[i][i]%mod;\n\treturn (x+mod)%mod;\n}\n\nint main() {\n\tscanf(\"%d%d%d\",&n,&m,&q);\n\tif (n<=2) {\n\t\tprintf(\"0\");\n\t\treturn 0;\n\t}\n\t\n\tfor (int i=1;i<=m;i++) {\n\t\tint u,v;\n\t\tscanf(\"%d%d\",&u,&v);\n\t\tg[u][v]=1,g[v][u]=1;\n\t}\n\tfor (int i=0;i<(1<<n);i++) c[i]=c[i>>1]+(i&1);\n\tfor (int i=0;i<(1<<n);i++) {\n\t\tv.clear();\n\t\tfor (int j=1;j<=n;j++)\n\t\t\tif (!(i&(1<<(j-1))))\n\t\t\t\tv.push_back(j);\n\t\tmemset(f,0,sizeof(f));\n\t\tfor (int j=0;j<v.size();j++)\n\t\t\tfor (int k=j+1;k<v.size();k++)\n\t\t\t\tif (g[v[j]][v[k]])\n\t\t\t\t\tf[j+1][j+1]++,f[k+1][k+1]++,\n\t\t\t\t\tf[j+1][k+1]=f[k+1][j+1]=mod-1;\n\t\tu[i]=Gas(v.size(),f);\n\t\tfor (int j=1;j<=n;j++)\n\t\t\tif (i&(1<<(j-1))) {\n\t\t\t\tint cnt=0;\n\t\t\t\tfor (int k=1;k<=n;k++)\n\t\t\t\t\tif (g[j][k] && !(i&(1<<(k-1))))\n\t\t\t\t\t\tcnt++;\n\t\t\t\tu[i]*=cnt;\n\t\t\t}\n\t}\n\t\n\tfor (int i=2,j=1;i<=(1<<n);i<<=1,j<<=1)\n\t\tfor (int k=0;k<(1<<n);k+=i)\n\t\t\tfor (int l=0;l<j;l++)\n\t\t\t\tu[k+l]-=u[j+k+l];\n\t\n\tfor (int i=0;i<(1<<n);i++)\n\t\tif (c[i]==q) Ans+=u[i];\n\t\n\tprintf(\"%lld\",Ans);\n\t\n\treturn 0;\n}\n```\n",
        "postTime": 1644565165,
        "uid": 283913,
        "name": "ZillionX",
        "ccfLevel": 6,
        "title": "\u300c\u9898\u89e3\u300dCF53E Dead Ends"
    },
    {
        "content": "~~(\u7eaa\u5ff5\u5728\u6a21\u62df\u8d5b\u91cc\u573a\u5207\u7684\u4e00\u9053 2500)~~\n\n\u4e0e\u5176\u4ed6\u72b6\u538b\u7684\u505a\u6cd5\u4e00\u6837\uff0c\u4f46\u662f\u8fd9\u7bc7\u9898\u89e3\u4e3b\u8981\u8bb2\u8ff0\u53e6\u4e00\u79cd**\u53bb\u91cd**\u7684\u65b9\u6cd5\u3002\n\n\u6211\u4eec\u53d1\u73b0\u4f1a\u91cd\u590d\u7684\u4e3b\u8981\u539f\u56e0\u662f\u540c\u4e00\u68f5\u6811\u4f1a\u88ab\u8f6c\u79fb\u5230\u591a\u6b21\u3002\n\n\u6bd4\u5982\u4e0b\u9762\u8fd9\u68f5\u6811\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ybw9hlsn.png)\n\n\u5b83\u5e94\u8be5\u88ab $dp[(111111)_2][(111001)_2]$ \u7b97\u5230\u4e00\u6b21\uff08\u4e0b\u6587\u4e8c\u8fdb\u5236\u5747\u7b80\u5199\uff09\u3002\n\n\u4f46\u662f\u5b9e\u9645\u4e0a\u5982\u679c\u6211\u4eec\u66b4\u529b\u8f6c\u79fb\uff0c\u8fd9\u68f5\u6811\u4f1a\u88ab $dp[111110][111000]$\uff08\u52a0\u5165\u53f6\u5b50 1\uff09\u3001$dp[110111][110001]$\uff08\u52a0\u5165\u53f6\u5b50 4\uff09\u3001$dp[101111][101001]$\uff08\u52a0\u5165\u53f6\u5b50 5\uff09\u3001$dp[011111][011001]$\uff08\u52a0\u5165\u53f6\u5b50 6\uff09\u8f6c\u79fb\u5230\u3002\u4e00\u5171 4 \u6b21\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u8fd9\u68f5\u6811\u6709\u51e0\u4e2a\u53f6\u5b50\uff0c\u5c31\u4f1a\u88ab\u91cd\u590d\u8f6c\u79fb\u5230\u51e0\u6b21\u3002\n\n\u6240\u4ee5\u5728\u8ba1\u7b97\u65f6\u5c06 $dp[i][j]$ \u9664\u4ee5 $popcount(j)$ \u5c31\u884c\u4e86\u3002",
        "postTime": 1644388889,
        "uid": 90706,
        "name": "_jimmywang_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF53E Dead Ends"
    },
    {
        "content": "\u8003\u8651\u679a\u4e3e\u4e00\u4e2a\u70b9\u96c6 $S$\uff0c\u8868\u793a\u94a6\u5b9a $V\\setminus S$ \u7684\u70b9\u4e3a\u53f6\u5b50\uff0c\u8ba1\u7b97\u51fa\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f\u5bf9\u5176\u6267\u884c IFMT \u7684\u7ed3\u679c\u3002\n\n\u8981\u8ba1\u7b97\u8fd9\u4e2a\uff0c\u53ef\u77e5\u53ea\u9700\u7b97\u51fa $S$ \u7684\u5bfc\u51fa\u5b50\u56fe\u7684\u751f\u6210\u6811\u4e2a\u6570\uff0c\u7136\u540e\u4e3a\u6bcf\u4e2a $V\\setminus S$ \u4e2d\u7684\u70b9\u9009\u62e9\u4e00\u6761\u8fde\u5411 $S$ \u4e2d\u7684\u8fb9\u5373\u53ef\u3002  \n\u540e\u8005\u53ea\u9700 $O(n 2^n)$\uff0c\u73b0\u5728\u6211\u4eec\u6765\u8bf4\u660e\u524d\u8005\u53ef\u4ee5\u505a\u5230 $O(n^2 2^n)$\u3002\n\n\u8003\u8651\u679a\u4e3e $k=1,\\dots,n$\uff0c\u4f9d\u6b21\u8ba1\u7b97\u6240\u6709 $S \\subseteq \\{1,\\dots,k\\}$ \u7684\u7b54\u6848\u3002  \n\u8003\u8651\u6bcf\u6b21\u52a0\u5165\u4e00\u4e2a\u70b9 $k+1$\uff0c\u5bf9\u4e8e $S \\subseteq \\{1,\\dots,k\\}$\uff0c\u6211\u4eec\u8003\u8651\u5982\u4f55\u5728\u5176\u4e2d\u52a0\u5165 $k+1$\u3002  \n\u81ea\u7136\u53ea\u9700\u679a\u4e3e\u65ad\u5f00 $k+1$ \u540e\u4f1a\u6784\u6210\u54ea\u4e9b\u8fde\u901a\u5757\uff0c\u4e0d\u96be\u53d1\u73b0\u8fd9\u5c31\u662f\u4e00\u4e2a\u96c6\u5408\u5e42\u7ea7\u6570\u7684 exp \u64cd\u4f5c\u3002\n\n\u6838\u5fc3\u4ee3\u7801\uff08\u6267\u884c\u5b8c\u540e $f_S$ \u4e3a $S$ \u5bfc\u51fa\u5b50\u56fe\u7684\u751f\u6210\u6811\u4e2a\u6570\uff0c$e_u$ \u4e3a\u90bb\u63a5\u77e9\u9635\uff0c$\\exp$ \u8868\u793a\u5c06 $f_{2^k,\\dots,2^{k+1}-1}$ \u539f\u5730 $\\exp$\uff09\uff1a\n```cpp\nf[0] = 1;\nfor (int k = 0; k < lg; ++k) {\n  for (int i = 0; i < (1 << k); ++i) f[i + (1 << k)] = (ll)f[i] * popcnt(e[k] & i) % mod;\n  Set::exp(f + (1 << k), f + (1 << k), k);\n}\n```\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u7531 $T(n) = T(n-1) + O(n^2 2^n)$ \u5f97\u5230\uff0c\u4e3a $O(n^2 2^n)$\u3002  \n\u4ece\u800c\u8fd9\u4e5f\u53eb\u505a**\u9010\u70b9\u725b\u987f\u8fed\u4ee3\u6cd5**\u3002",
        "postTime": 1666916242,
        "uid": 75840,
        "name": "deserter",
        "ccfLevel": 0,
        "title": "\u96c6\u5408\u5e42\u7ea7\u6570\u79d1\u6280\u6a21\u677f\u9898"
    },
    {
        "content": "\n## \u9898\u89e3\uff1a\n\n[\u535a\u5ba2\u98df\u7528\u53e3\u5473\u66f4\u4f73](https://www.cnblogs.com/fusiwei/p/11851987.html)\n\n~~2019.11.13CSP-S\u6a21\u62df\u8d5b\u6ee1\u5206\u573a~~\n\n#### \u5199\u5728\u524d\u9762\n\n\u4f17\u6240\u5468\u77e5\uff0c~~NOIP~~CSP-S\u6a21\u62df\u8d5b\u662f\u4e00\u79cd\u5947\u5999\u7684\u8d5b\u4e8b\uff0c\u5343\u4e07\u4e0d\u8981\u88ab\u5b83\u7684\u540d\u5b57\u8ff7\u60d1\u3002\u5b83\u5c5e\u4e8e\u4e00\u79cd\u7c7b\u578b\u548c\u6027\u8d28\u672a\u77e5\u7684\u6bd4\u8d5b\u3002\u5728\u8fd9\u79cd\u5947\u5999\u7684\u6bd4\u8d5b\u91cc\uff0c200\u884c\u7684\u6811\u94fe\u5256\u5206\u975e\u6a21\u677f\u9898\u53ef\u4ee5\u88ab\u51fa\u9898\u4eba\u5f53\u4f5c$D1\\,\\,T1$\u7684\u6c34\u9898\u6765\u4f7f\u7528\u3002$T3$\u5982\u679c\u4e0d\u7528\u9ed1\u9898\uff0c\u90a3\u4e48\u8fd9\u573a\u6bd4\u8d5b\u5c31\u4f1a\u88ab\u6210\u7fa4\u7684\u5927\u4f6c\u5410\u69fd\u8fc7\u6c34\u3002\u4e3a\u4e86\u6269\u5bbd\u9009\u624b\u4eec\u7684\u773c\u754c\uff0c\u8fd9\u79cd\u8d5b\u4e8b~~\u5927\u91cf~~\u9002\u5f53\u5730\u6dfb\u52a0\u4e86\u4e9b\u8bb8\u8d85\u8fc7\u8054\u8d5b\u8303\u56f4\u7684\u77e5\u8bc6\u70b9\u3002\u5177\u4f53\u53ef\u80fd\u4e3a\u540e\u7f00\u81ea\u52a8\u673a\uff0cNTT\u7b97\u6cd5\uff0cLCT\u7b49\u7b49......\n\n\u603b\u4e4b\uff0c\u849f\u84bb\u88ab\u4e00\u987f\u60e8\u8650\uff0c\u5728\u4e00\u4e2a\u6708\u7684\u714e\u71ac\u548c\u745f\u745f\u53d1\u6296\u540e\uff0c\u849f\u84bb\u7ec8\u4e8e\u8fce\u6765\u4e86\u5728\u8003\u573a\u4e0a\u5207\u6389\u7684\u4e3a\u6570\u4e0d\u591a\u7684\u51e0\u9053\u9898...\n\n#### \u9898\u89e3\uff1a\n\n\u770b\u8fd9\u4e2a\u6570\u636e\u8303\u56f4\uff0c\u5e94\u8be5\u80fd\u60f3\u5230\u72b6\u538bDP\uff0c\u4f46\u662f\u8fd9\u4e2a\u72b6\u6001\u7684\u8bbe\u7f6e\u6bd4\u8f83\u4f24\u8111\u7b4b\u3002\u6211\u4eec\u505a\u72b6\u6001\u538b\u7f29\u7684\u65f6\u5019\u5f88\u5c11\u89c1\u5230\u8fc7\u8fd9\u79cd\u9898\u76ee\u3002\u4f46\u662f\u6839\u636e\u52a8\u6001\u89c4\u5212\u7684\u4e00\u822c\u601d\u8def\uff0c\u6211\u4eec\u53ef\u4ee5\u786e\u5b9a\u52a8\u6001\u89c4\u5212\u72b6\u6001\u7684\u8bbe\u7f6e\u662f\u57fa\u4e8e\u95ee\u9898\u8fb9\u754c\u7684\u57fa\u7840\u4e0a\u7684\u3002\u4e8e\u662f\u6211\u4eec\u4ed4\u7ec6\u5206\u6790\u8fd9\u9053\u9898\u7684\u95ee\u9898\u8fb9\u754c\u3002\u5047\u5982\u6211\u4eec\u8981\u679a\u4e3e\u7684\u8bdd\uff0c\u9996\u5148\u8981\u679a\u4e3e\u5f53\u524d\u56fe\u6240\u6709\u7684\u751f\u6210\u6811\uff0c\u5176\u6b21\u8981\u679a\u4e3e\u5ea6\u4e3a1\u7684\u8282\u70b9\u3002\u90a3\u4e48\u5c31\u8bbe\u7f6e\u4e24\u7ef4\u6570\u7ec4\uff0c\u7b2c\u4e00\u7ef4\u5ea6\u5b58\u6811\u7684\u72b6\u6001\uff0c\u7b2c\u4e8c\u7ef4\u5ea6\u5b58\u53f6\u5b50\u8282\u70b9\u7684\u72b6\u6001\u3002\n\n\u90a3\u4e48\u8f6c\u79fb\u7684\u65f6\u5019\u4f1a\u6709\u4e24\u79cd\u66f4\u65b0\u7684\u65b9\u5f0f\uff1a\u7b2c\u4e00\u79cd\uff1a\u628a\u67d0\u4e2a\u70b9\u52a0\u5230\u4e00\u4e2a\u53f6\u5b50\u8282\u70b9\u4e0a\uff0c\u8fd9\u4e2a\u65f6\u5019\u8fd9\u4e2a\u65b0\u8282\u70b9\u5c31\u6210\u4e3a\u4e86\u53f6\u5b50\u8282\u70b9\uff0c\u53f6\u5b50\u8282\u70b9\u7684\u6570\u76ee\u662f\u6ca1\u6709\u53d8\u5316\u7684\u3002\u53ea\u662f\u88ab\u66ff\u6362\u4e86\u800c\u5df2\u3002\u7b2c\u4e8c\u79cd\uff1a\u628a\u67d0\u4e2a\u70b9\u52a0\u5230\u975e\u53f6\u5b50\u8282\u70b9\u4e0a\u3002\u8fd9\u4e2a\u65f6\u5019\u65b0\u8282\u70b9\u53d8\u6210\u53f6\u5b50\u8282\u70b9\uff0c\u53f6\u5b50\u8282\u70b9\u7684\u603b\u6570\u589e\u52a0\u4e861.\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#include<vector>\n#define int long long\nusing namespace std;\nconst int maxs=(1<<11)+10;\nvector<int> map[20];\nint dp[maxs][maxs],cnt[maxs];\n//dp[i][j]\u8868\u793a\u751f\u6210\u6811\u72b6\u6001\u4e3ai\uff0c\u5ea6\u6570\u4e3a1\u7684\u70b9\u72b6\u6001\u4e3aj\u7684\u65b9\u6848\u6570\nint n,m,k,ans;\nsigned main()\n{\n    for(int i=1;i<=maxs;i++)\n        for(int j=0;j<15;j++)\n            if(i&(1<<j))\n               cnt[i]++;\n    scanf(\"%lld%lld%lld\",&n,&m,&k);\n    for(int i=1;i<=m;i++)\n    {\n        int x,y;\n        scanf(\"%lld%lld\",&x,&y); \n        x--;y--;\n        map[x].push_back(y);\n        map[y].push_back(x);\n    }\n    for(int i=1;i<(1<<n);i<<=1) \n        dp[i][i]=1;\n    for(int i=1;i<(1<<n);i++)\n        for(int j=i;j;j--,j&=i)\n            if(dp[i][j])\n                for(int k=0;k<n;k++)\n                    if(i&(1<<k))\n                        for(int l=0;l<map[k].size();l++)\n                        {\n                            int to=map[k][l];\n                            int now;\n                            if(~i&(1<<to))\n                            {\n                                if(cnt[i]==1) \n                                    now=i|(1<<to);\n                                else\n                                    now=j&~(1<<k)|(1<<to);\n                                if(!(now>>to+1)) \n                                    dp[i|(1<<to)][now]+=dp[i][j];\n                            }\n                        }\n    for(int i=0;i<(1<<n);i++) \n        if(cnt[i]==k)\n           ans+=dp[(1<<n)-1][i];\n    printf(\"%lld\",ans);\n    return 0;\n}\n```\n\n",
        "postTime": 1573643961,
        "uid": 175131,
        "name": "\u5085\u601d\u7ef4666",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF53E \u3010Dead Ends\u3011"
    },
    {
        "content": "\u9898\u610f\u5728\u8bc4\u8bba\u533a\u6709\uff0c\u8fd9\u91cc\u5c31\u4e0d\u8d58\u8ff0\u4e86\u3002\n\n\u8fd9\u9898\u5999\u554a\uff0c\u4f46\u6211\u4e5f\u4e0d\u662f\u592a\u61c2\uff0c\u770b\u522b\u4eba\u7684\u65b9\u6cd5\u5b66\u4e60\u4e86\u4e00\u6ce2\u3002\n\n\u9996\u5148\u5fc5\u5b9a\u8003\u8651DP\uff0c\u5176\u6b21\u89c2\u5bdf\u6570\u636e\u5927\u5c0f\u8003\u8651\u72b6\u538bDP\uff0c\u518d\u770b\u5230\u7b54\u6848\u6c42\u65b9\u6848\u6570\u8003\u8651\u5bb9\u65a5\u3002\n\nDP\u6570\u7ec4$f[i][j]$\u8868\u793a\u5f53\u524d\u5df2\u7ecf\u8003\u8651\u5230$i$\u4e2a\u70b9\uff0c$j$\u4e2a\u70b9\u4e3a\u6b7b\u80e1\u540c\uff0c\u7b54\u6848\u5373\u4e3a\n\n$ans=\\sum f[(1<<n)-1][i]$\n\n\u7531\u4e8e\u56fe\u5f88\u5c0f\uff0c\u4f7f\u7528\u90bb\u63a5\u77e9\u9635$g[i][j]$\u5b58\u56fe\u3002\n\n\u5173\u4e8e\u65b9\u7a0b\u5c31\u5224\u5b9a\u751f\u6210\u662f\u5426\u5408\u6cd5\u5373\u53ef\uff08\u6240\u4ee5\u8ddf\u5bb9\u65a5\u6709\u6bdb\u5173\u7cfb\uff09\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<cstdio>\nusing namespace std;\nint n,m,k,x,y;\nint g[20][20];//\u5b58\u56fe\nint f[1050][1050];//\u8003\u8651\u4e86i\u4e2a\u70b9\uff0cj\u4e2a\u70b9\u4e3a\u6b7b\u80e1\u540c\nlong long ans;\nint cal(int x)\n{\n\tint cnt=0;\n\twhile(x) cnt++,x-=x&(-x);\n\treturn cnt;\n}//\u6c42\u4e8c\u8fdb\u5236\u4e0b\u201c1\u201d\u7684\u4e2a\u6570 \nint q(int x) { return (1<<x); }\nint main()\n{\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tfor(int i=0;i<m;i++)\n\t{\n\t\tscanf(\"%d%d\",&x,&y);x--;y--;int u=(1<<x)|(1<<y);\n\t\tg[x][y]=g[y][x]=1;f[u][u]=1;\n\t}\n\tfor(int i=0;i<q(n);i++)\n\tfor(int j=0;j<q(n);j++)\n\tif ((i&j)==j&&f[i][j])//j\u4e3ai\u7684\u5b50\u96c6\u4e14\u5176\u6709\u8fb9\n\tfor(int k=0;k<n;k++)\n\tfor(int w=0;w<n;w++)\n\tif (g[k][w]&&(i&q(k))&&(~i&q(w))&&(!(((j&(~q(k)))|q(w))>>(w+1))))\n\t//\u5224\u5b9a\u5408\u6cd5\u6761\u4ef6\u6709\u4e09\uff1a \n\t//1.\u6b64\u8fb9\u5b58\u5728\n\t//2.\u6b64\u8fb9\u672a\u88ab\u5165\u9009\u4f46\u4e0e\u56fe\u8fde\u901a\uff08\u53ef\u80fd\u6210\u4e3a\u6b7b\u80e1\u540c\uff09\n\t//3.((j&(~q(k)))|q(w))\u8868\u793a\u9009\u62e9\u7684\u8fb9\u91cc\u662f\u5426\u5305\u542b\u8fd9\u6761\u8fb9\uff0c\u53f3\u79fb\u5224\u5b9a\u5176\u662f\u5426\u88ab\u9009 \n\tf[i|q(w)][(j&(~q(k)))|(q(w))]+=f[i][j];//\u8fb9(k,w)\u5df2\u7ecf\u88ab\u8003\u8651\uff0c\u5c06f[i][j]\u7684\u7b54\u6848\u8f6c\u79fb \n\tfor(int i=0;i<q(n);i++)//\u7b54\u6848\u4e3af[q(n)-1][i]\n\tif (cal(i)==k) ans+=f[q(n)-1][i];//\u5f53\u4e14\u4ec5\u5f53i\u6ee1\u8db3cal(i)==k\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1535636352,
        "uid": 32942,
        "name": "kkkk0369",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF53E \u3010Dead Ends\u3011"
    }
]
[
    {
        "content": "[Codeforces \u9898\u9762\u4f20\u9001\u95e8](https://codeforces.ml/contest/1264/problem/F) & [\u6d1b\u8c37\u9898\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF1264F)\n\n\u4e00\u9053\u540d\u526f\u5176\u5b9e\uff08beautiful\uff09\u7684\u7ed3\u8bba\u9898\u3002\n\n\u9996\u5148\u770b\u5230\u8fd9\u9053\u8bbe\u95ee\u65b9\u5f0f\u6211\u4eec\u53ef\u4ee5\u5f88\u81ea\u7136\u5730\u60f3\u5230\u5957\u7528\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u6052\u7b49\u5f0f\uff0c\u6ce8\u610f\u5230\u8fd9\u91cc\u6d89\u53ca\u5230 $F_{a+id}$\uff0c\u56e0\u6b64\u8003\u8651\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7ec4\u5408\u6052\u7b49\u5f0f $F_{m+n+1}=F_mF_{n}+F_{m+1}F_{n+1}$\uff0c\u5177\u4f53\u8bc1\u660e[\u6233\u8fd9\u91cc](https://www.cnblogs.com/ET2006/p/fibonacci.html)\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u8d58\u8ff0\u4e86\u3002\n\n\u6ce8\u610f\u5230\u6b64\u9898\u8fd8\u6d89\u53ca\u540e $18$ \u4f4d\uff0c\u4e5f\u5c31\u662f\u8981\u5c06\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u5404\u79cd\u8fd0\u7b97\u653e\u5230\u6a21 $10^{18}$ \u610f\u4e49\u4e0b\u8fdb\u884c\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u627e\u4e00\u4e0b\u6590\u6ce2\u90a3\u5951\u6570\u5217\u5728\u6a21 $10^{18}$ \u610f\u4e49\u4e0b\u7684\u5faa\u73af\u8282\uff0c\u6253\u4e2a\u8868\u53ef\u4ee5\u53d1\u73b0\u6590\u6ce2\u90a3\u5951\u6570\u5217\u5728\u6a21 $10,100,1000,10000,100000,\\cdots$ \u610f\u4e49\u4e0b\u7684\u5faa\u73af\u8282\u6070\u597d\u662f $60,300,1500,15000,150000$\uff0c\u540e\u9762\u4f9d\u6b21\u4e58 $10$\uff08From my \u9898\u89e3 of [Codeforces 193E](https://www.cnblogs.com/ET2006/p/Codeforces-193E.html)\uff09\u56e0\u6b64\u6590\u6ce2\u90a3\u5951\u6570\u5217\u5728\u6a21 $10^k(k\\ge 3)$ \u610f\u4e49\u4e0b\u7684\u5faa\u73af\u8282\u4e3a $1.5\\times 10^k$\uff0c\u4e5f\u5c31\u662f\u8bf4\u4e00\u5b9a\u6709 $F_{1.5\\times 10^k\u00b7i}\\equiv 0\\pmod{10^k}$\uff0c\u6211\u4eec\u5728\u4e0b\u6587\u4e2d\u4ee4 $N=12\\times 10^k$\uff08\u5b98\u65b9\u9898\u89e3\u662f $12\\times 10^k$\uff0c\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u8fd9\u4e48\u505a\u6211\u4e5f\u4e0d\u77e5\u9053\uff0c\u53cd\u6b63\u5bf9\u4e8e\u6211\u8fd9\u79cd\u83dc\u9e21\u800c\u8a00\uff0c\u8fd9\u79cd\u96be\u5ea6\u7684\u9898\u6211\u53ea\u80fd\u642c\u5b98\u65b9\u9898\u89e3/ll/wq\uff09\uff0c\u90a3\u4e48\u663e\u7136 $1.5\\times 10^k\\mid N$\uff0c\u56e0\u6b64\u53ef\u4ee5\u5f97\u5230\u7b2c\u4e00\u4e2a\u975e\u5e38 trivial \u7684\u7ed3\u8bba\uff1a\n\n> Observation $1$. $F_{Ni}\\equiv 0\\pmod{10^k}(i\\in\\mathbb{N}_+)$\u3002\n\n\u63a5\u4e0b\u6765\u6211\u4eec\u8003\u8651\u518d\u6765\u89c2\u5bdf\u4e00\u4e9b\u6027\u8d28\uff0c\u53ef\u4ee5\u6ce8\u610f\u5230 $F_{2N+1}=F_{N+1}^2+F_N^2\\equiv F_{N+1}^2\\pmod{10^{2k}}$\uff0c$F_{3N+1}=F_{2N+1}F_{N+1}+F_{2N}F_N\\equiv F_{2N+1}F_{N+1}\\equiv F_{N+1}^3\\pmod{10^{2k}}$\uff0c\u5982\u6b64\u5f52\u7eb3\u4e0b\u53bb\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u666e\u904d\u6027\u7684\u7ed3\u8bba\uff1a\n\n> Observation $2$. $F_{xN+1}\\equiv F_{N+1}^x\\pmod{10^{2k}},x\\in\\mathbb{N}_+$\n\n\u63a5\u4e0b\u6765\u8003\u8651\u63a2\u7a76\u4e00\u4e0b\u8fd9\u4e2a $F_{N+1}$ \u53c8\u6709\u4ec0\u4e48\u6027\u8d28\uff0c\u6709\u4e00\u4e2a\u6211\u4e5f\u4e0d\u77e5\u9053\u600e\u4e48\u63a8\u51fa\u6765\uff08\u6709\u54ea\u4f4d\u597d\u5fc3\u7684\u9e3d\u9e3d\u6559\u6559\u849f\u84bb\u8fd9\u4e1c\u897f\u600e\u4e48\u8bc1\u660e\u554a qwq/kel\uff09\u7684\u6027\u8d28\uff1a\n\n> Observation $3$. $F_{N+1}$ \u53ef\u4ee5\u5199\u6210 $8\\times 10^k\u00b7t+1$ \u7684\u5f62\u5f0f\uff0c\u5176\u4e2d $t\\perp 10$\n\n~~\u8bc1\u660e\u4e0d\u4f1a~~\n\n\u56e0\u6b64\u6211\u4eec\u6709 $F_{xN+1}=F_{N+1}^x=(8\\times 10^k\u00b7t+1)^x$\uff0c\u800c\u6211\u4eec\u66b4\u529b\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c06\u8fd9\u4e1c\u897f\u5c55\u5f00\u5c31\u4f1a\u53d1\u73b0\u5e73\u65b9\u9879\u4ee5\u4e0a\u6a21 $10^{2k}$ \u90fd\u7b49\u4e8e $0$\uff0c\u56e0\u6b64\u6211\u4eec\u53ea\u7528\u4fdd\u7559 $1$ \u6b21\u9879\u548c $0$ \u6b21\u9879\u5373\u53ef\uff0c\u5373\n\n> Observation $4$. $F_{xN+1}\\equiv 8\\times 10^k\u00b7t\u00b7x+1\\pmod{10^{2k}}$\n\n\u63a5\u4e0b\u6765\u56de\u5230\u539f\u95ee\u9898\uff0c\u6211\u4eec\u663e\u7136\u5e0c\u671b\u5bf9\u6bcf\u4e2a $v=a+ix,i\\in\\mathbb{Z}\\cap[0,n)$ \u627e\u5230\u4e00\u4e2a $p$ \u6ee1\u8db3 $F_p\\equiv v\u00b710^u+q\\pmod{10^{18}}$\uff0c\u5176\u4e2d $u\\le 12,q<10^{u}$\uff0c\u8fd9\u6837\u539f\u95ee\u9898\u663e\u7136\u5c31\u505a\u5b8c\u4e86\uff0c\u56e0\u4e3a\u8fd9\u6837\u4ece $10^u$ \u4f4d\u5f00\u59cb\u5f80\u540e\u6570\u4e00\u5b9a\u53ef\u4ee5\u5f97\u5230 $v$\u3002\u7531\u4e8e\u6211\u4eec\u8fd9\u4e9b\u64cd\u4f5c\u8981\u653e\u5728\u6a21 $10^{18}$ \u610f\u4e49\u4e0b\u8fdb\u884c\uff0c\u56e0\u6b64\u6211\u4eec\u53d6 $k=9$\uff0c\u6b64\u65f6 $N=1.2\\times 10^{10}$\uff0c\u6211\u4eec\u8003\u8651\u4ee4 $X=125\u00b7t^{-1}\u00b7a\\bmod{10^9},Y=125\u00b7t^{-1}\u00b7d\\bmod{10^9}$\uff0c\u5176\u4e2d $t^{-1}$ \u8868\u793a $t$ \u5728\u6a21 $10^9$ \u610f\u4e49\u4e0b\u7684\u9006\u5143\uff0c\u90a3\u4e48\u6211\u4eec\u6784\u9020 $b=XN+1,e=YN$ \u7b26\u5408\u9898\u610f\uff0c\u56e0\u4e3a\uff1a\n$$\n\\begin{aligned}\n&F_{b+ie}\\\\\n=&F_{(X+iY)N+1}\\\\\n\\equiv&8\u00b710^9\u00b7t\u00b7(X+iY)+1\\\\\n\\equiv&8\u00b710^9\u00b7t\u00b7125\u00b7t^{-1}(a+id)+1\\\\\n=&10^{12}\u00b7(10^9k+1)\u00b7(a+id)+1\\\\\n\\equiv&10^{12}\u00b7(a+id)+1\\pmod{10^{18}}\n\\end{aligned}\n$$\n\u7b26\u5408\u6211\u4eec\u521a\u624d\u7684\u6784\u9020\u3002\n\n\u4e00\u53e5\u8bdd\u6765\u8bf4\u5c31\u662f $b=(368131125a\\bmod 10^9)\u00b71.2\\times 10^{10}+1,e=(368131125d\\bmod 10^9)+1.2\\times 10^{10}$\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u505a\u5b8c\u4e86\u8fd9\u4e2a\u96be\u5ea6 3.5k \u7684\u9898\uff08\n\n\u4ee3\u7801\uff08\u53ea\u6709\u77ed\u77ed\u7684 8 \u884c\uff09\uff1a\n\n```cpp\n#include <cstdio>\nint n,a,d;\nunsigned long long m=368131125,mod=1e9,x=1.2e10;\nint main(){\n\tscanf(\"%d%d%d\",&n,&a,&d);\n\tprintf(\"%llu %llu\\n\",m*a%mod*x+1,m*d%mod*x);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1626526467,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1264F Beautiful Fibonacci Problem"
    },
    {
        "content": "## \u9898\u610f\n\n\u7ed9\u51fa $n,a,d$\uff0c\u6784\u9020 $b,e$ \u4f7f\u5f97 $\\forall i\\in[0,n),f_{b+ei}$ \u7684\u540e $18$ \u4f4d\u5305\u542b $a+id$\u3002\n\n$0<b,e<2^{64},a+(n-1)d<10^6$\n\n## \u9898\u89e3\n\n~~\u4e3a\u4ec0\u4e48CF\u9898\u89e3\u662f 8\\pi(10^9) \u6d1b\u8c37\u4e0a\u7684\u9898\u89e3\u4e5f\u5168\u90e8\u90fd\u662f\u8fd9\u4e2a\u6570\u554a~~\n\n\u9996\u5148\u6211\u4eec\u77e5\u9053 $f_{n+m+1}=f_nf_m+f_{n+1}f_{m+1}$\n\n\u8bc1\u660e\uff08\uff1f\uff09\uff1a\n\n```\nIn[1]:= F[n_]=1/\\[Sqrt]5 (((1+\\[Sqrt]5)/2)^n-((1-\\[Sqrt]5)/2)^n)\nOut[1]= (-(1/2 (1-Sqrt[5]))^n+(1/2 (1+Sqrt[5]))^n)/Sqrt[5]\nIn[2]:= Simplify[F[n] F[m]+F[n+1]F[m+1]-F[n+m+1]]\nOut[2]= 0\n```\n\n~~\u65e2\u7136\u673a\u5668\u80fd\u7b97\u90a3\u4e48\u4eba\u7c7b\u4e5f\u80fd\u7b97\u5427\uff0c\u6240\u4ee5\u8fd9\u91cc\u5c31\u4e0d\u5177\u4f53\u8ba1\u7b97\u4e86\uff08\u9003~~\n\n\u7136\u540e\u6211\u4eec\u77e5\u9053 $\\pi(10^9)=1.5\\times 10^9$\u3002\u6211\u4eec\u8bb0 $N$ \u4e3a\u8fd9\u4e2a\u503c\u3002\u7136\u540e\u6709\u4e00\u4e9b\u7ed3\u8bba\uff1a\n\n- $f_{xN}\\equiv 0\\pmod{10^9}$ \u3002\u8bc1\u660e\u7565\u3002\n- $f_{N+1}\\equiv 1\\pmod {10^9}$\u3002\u53ef\u4ee5\u6253\u8868\u9a8c\u8bc1 $f_{N+1}=t\\times 10^9+1$\uff0c\u5176\u4e2d $t\\perp10$\u3002\u53ef\u4ee5\u5f97\u5230 $t\\equiv 584177449\\pmod{10^9}$ \u5373 $f_{N+1}\\equiv t\n  \\times 10^9+1\\pmod{10^{18}}$\n- $f_{2N+1}\\equiv f_N^2+f_{N+1}^2\\equiv f_{N+1}^2\\equiv 10^9\\times 2t+1 \\pmod {10^{18}}$\u3002\u5f52\u7eb3\u4e00\u4e0b\u4e0d\u96be\u5f97\u5230 $f_{xN+1}=10^9\\times xt+1\\pmod {10^{18}}$\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u5c31\u5f88\u6709\u610f\u601d\u4e86\uff0c\u5b9e\u9645\u4e0a\u5c31\u63d0\u4f9b\u4e86\u4e00\u79cd\u7ebf\u6027\u53d8\u6362\uff0c\u5e26\u5165\u4e00\u4e2a $x$ \u5f97\u5230\u7684\u662f\u5173\u4e8e $x$ \u7ebf\u6027\u7684\u3002\u90a3\u4e48\u5982\u679c $xt\\equiv a+id \\pmod {10^9}$ \u5c31\u505a\u5b8c\u4e86\u3002\u4e5f\u5c31\u662f $x\\equiv t^{-1}a+i\\times t^{-1}d \\pmod{10^9}$\u3002\u90a3\u4e48 $xN+1=(N(t^{-1}a)+1)+i\\times (N(t^{-1}d))$\u3002\u5230\u8fd9\u4e00\u6b65\u6784\u9020\u5c31\u6bd4\u8f83\u663e\u7136\u4e86\uff0c\u76f4\u63a5\u4ee4 $b=N(t^{-1}a\\bmod 10^9)+1,e=N(t^{-1}d\\bmod 10^9)$ \u5373\u53ef\u3002$t\\perp10$ \u6240\u4ee5\u6c42\u9006\u76f4\u63a5 $\\rm exgcd$ \u5c31\u597d\u4e86\u3002\n\n\u7136\u540e $3500$ \u5c31\u505a\u5b8c\u4e86\uff1f\n\n\u611f\u89c9\u6bd4\u8f83\u79bb\u8c31\uff0c\u662f\u4e0d\u662f $a+(n-1)d$ \u53ef\u4ee5\u5230 $10^9$ \u554a\u3002\n\n\u4e0d\u77e5\u9053\u6709\u6ca1\u6709\u9519\u8bef\uff0c\u5982\u679c\u6709\u9519\u8bef\u8bf7\u8054\u7cfb\u83dc\u72d7\uff0c\u83dc\u72d7\u611f\u6fc0\u4e0d\u5c3d\uff01\uff01\n\n## \u4ee3\u7801\n\n\u8ba1\u7b97\u6590\u6ce2\u90a3\u5951\u6570\u5217\u6570\u5217\n\n```cpp\n#include<bits/stdc++.h>\n#define mp make_pair\n#define pb push_back\n#define pc putchar\n#define chkmx(a,b) (a)=max((a),(b))\n#define chkmn(a,b) (a)=min((a),(b))\n#define fi first\n#define se second\nusing namespace std;\ntemplate<class T>\nvoid read(T&x){x=0;char c=getchar();bool f=0;for(;!isdigit(c);c=getchar())f^=c=='-';for(;isdigit(c);c=getchar())x=x*10+c-'0';if(f)x=-x;}\ntemplate<class T,class ...ARK>void read(T&x,ARK&...ark){read(x);read(ark...);}\ntemplate<class T>void write(T x){if(x<0)pc('-'),x=-x;if(x>=10)write(x/10);pc(x%10+'0');}\ntemplate<class T,class ...ARK>void write(T x,ARK...ark){write(x);pc(' ');write(ark...);}\ntemplate<class ...ARK>void writeln(ARK...ark){write(ark...);pc('\\n');}\ntypedef long long ll;\ntypedef __int128 lll;\n#define lowbit(x) ((x)&-(x))\nconst lll mod=1e18;\nstruct mint{\n\tlll x;\n\tmint(unsigned o=0){x=o;}\n\tmint operator+=(mint a){return(x+=a.x)%=mod,*this;}\n\tmint operator*=(mint a){return(x=x*a.x%mod),*this;}\n\tfriend mint operator+(mint a,mint b){return a+=b;}\n\tfriend mint operator*(mint a,mint b){return a*=b;}\n};\nstruct mat{\n\tmint a[2][2];\n\tmint*operator[](int x){return a[x];}\n\tmat operator*(mat&b){\n\t\tmat c;memset(c.a,0,sizeof c.a);\n\t\tfor(int i=0;i<2;i++)\n\t\t\tfor(int j=0;j<2;j++)\n\t\t\t\tfor(int k=0;k<2;k++)\n\t\t\t\t\tc[i][k]+=a[i][j]*b[j][k];\n\t\treturn c;\n\t}\n};\nmint Fib(lll n){\n\tmat c,res;\n\tc[1][1]=c[0][1]=c[1][0]=1;c[0][0]=0;\n\tres[0][0]=res[1][1]=1;res[0][1]=res[1][0]=0;\n\twhile(n){\n\t\tif(n&1)\n\t\t\tres=res*c;\n\t\tc=c*c;n/=2;\n\t}\n\treturn res[0][1];\n}\nsigned main(){\n\twhile(1){\n\t\tlll x;\n\t\tread(x);\n\t\twrite(Fib(x).x);pc('\\n');\n\t}\n}\n```\n\n\u6c42\u9006\u5927\u5bb6\u90fd\u4f1a\u5c31\u4e0d\u8d34\u4e86\u3002\n\n\u6700\u540e\u662f\u6838\u5fc3\u4ee3\u7801\n\n```cpp\nint N=1.5e9,mod=1e9;\nread(n,a,b);\nll x=(614945049ll*a)%mod,y=(614945049ll*b)%mod;\nwriteln(x*N+1,y*N);\n```",
        "postTime": 1638862382,
        "uid": 174304,
        "name": "jun\u5934\u5409\u5409",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1264F \u3010Beautiful Fibonacci Problem\u3011"
    },
    {
        "content": "\u809d\u4e86\u4e00\u5e74.jpg  \n\u4e3a\u5565\u6211\u8981\u5f00\u8fd9\u9898\u554a\u9760\n\n\n## CF1264F\n\n### \u9898\u610f\n\n  \u7ed9\u5b9a\u5e8f\u5217 $\\{A_n\\}$, \u5176\u4e2d $A_n = a + (n-1) d$.\n\n  \u8bd5\u6784\u9020\u5e8f\u5217 $\\{B_n\\}$, \u5176\u4e2d $B_n = b + (n-1)e$, \u6ee1\u8db3 $b, e \\in (0, 2^{64})\\cap \\mathbb N$, \u4e14 $\\forall i\\in [0, n)\\cap \\mathbb N$, $A_n$ \u662f $F_{B_n}$ \u7684\u540e 18 \u4f4d\u7684\u5b50\u4e32.\n\n### \u89e3\u6cd5\n\n\u672c\u9898\u89e3\u5728\u4e3b\u8981\u505a\u6cd5\u65b9\u9762\u53c2\u7167[\u5b98\u65b9\u9898\u89e3](https://codeforces.com/blog/entry/71995).\n\n\u5728\u8fd9\u91cc\u989d\u5916\u63d0\u4f9b[\u4e00\u79cd\u505a\u6cd5](https://codeforces.com/blog/entry/71995?#comment-562936), \u7b49\u6709\u4eba\u6765\u50ac\u5c31\u770b\u7740\u66f4, \u5e94\u8be5\u4f1a\u5f00\u65b0\u7684\u4e00\u7bc7, \u4e0d\u7136\u8fd9\u7bc7 latex \u5c31\u592a\u591a\u4e86 /wq\n\n\u4e0d\u59a8\u7ea6\u5b9a $T=12\\times 10^k$, \u5176\u4e2d $k=9$.\n\n\u5f15\u7406 1 : $F_{n+m} = F_mF_{n+1} + F_{m-1}F_n$\n\n\u8bc1\u660e :\n\n\u539f\u547d\u9898\u7b49\u4ef7\u4e8e $F_n = F_{n-k}F_{k+1} + F_{n-k-1}F_{k} (n-k-1\\ge 0, k\\ge 0)$  \n\u4e0d\u59a8\u5bf9 $k$ \u7528\u6570\u5b66\u5f52\u7eb3\u6cd5. k = 0 \u65f6\u547d\u9898\u663e\u7136.  \n\u5047\u8bbe\u547d\u9898\u5bf9 $k\\leq m$ \u90fd\u6210\u7acb, \u6211\u65ad\u8a00\u547d\u9898\u5bf9 $k=m+1$ \u4e5f\u6210\u7acb. \u8fd9\u662f\u56e0\u4e3a\n\n$\\begin{aligned} F_n &= F_{n-m}F_{m+1} + F_{n-m-1} F_{m} \\\\ &= (F_{n-m-1}+F_{n-m-2})F_{m+1} + F_{n-m-1}F_m \\\\ &= F_{n-(m+1)} (F_m+F_{m+1}) + F_{n-(m+1)-1} F_m \\\\ &=F_{n-(m+1)} F_{(m+1)+1} + F_{n-(m+1)-1}F_{(m+1)} \\end{aligned} $\n\n\u5f15\u7406 2 : $F_{12 i\\times 10^k} \\equiv 0\\pmod{10^k}$\n\n\u8bc1\u660e :\n\n\u8003\u8651\u8bbe $\\{F_n\\} \\bmod k$ \u7684\u5faa\u73af\u8282\u957f\u5ea6\u4e3a $\\pi (k)$, \u7531 [wiki](https://zh.wikipedia.org/wiki/\u76ae\u8428\u8bfa\u5468\u671f) \u77e5 $\\pi(10^k) = \\pi(2^k5^k) = \\mathbb{lcm} (\\pi(2^k), \\pi(5^k)) = 6\\times 10^k$. \u6240\u4ee5\u6709 $F_{12i\\times10^k} \\equiv 0\\pmod{10^k}$\n\n\u5f15\u7406 3 : $F_{uT+1} \\equiv F_{T+1}^u\\pmod{10^{2k}}$, $u\\ge 2$\n\n\u8bc1\u660e : \n\n\u91c7\u7528\u6570\u5b66\u5f52\u7eb3\u6cd5. $u=2$ \u65f6\u7531 $F_{2T+1} = F^2_{T+1} + F^2_n \\equiv F^2_{n+1}\\pmod{10^{2k}}$ \u547d\u9898\u663e\u7136\u6210\u7acb.\n\n\u5047\u8bbe\u547d\u9898\u5bf9 $u\\leq m$ \u90fd\u6210\u7acb, \u6211\u65ad\u8a00\u547d\u9898\u5bf9 $u=m+1$ \u4e5f\u6210\u7acb. \u8fd9\u662f\u56e0\u4e3a\n$F_{(m+1)T+1} = F_{mT+1}F_{T+1} + F_{mT}F_{T} \\equiv F_{mT+1}F_{T+1}\\pmod{10^{2k}}$, \u53c8\u56e0\u4e3a\u547d\u9898\u5728 $u=m$ \u65f6\u6210\u7acb, \u6240\u4ee5 $F_{(m+1)T+1} \\equiv F_{T+1}^{m+1}\\pmod{10^{2k}}$.\n\n\u6211\u65ad\u8a00 $F_{T+1} = 8\\times 10^k t+1$, \u5e76\u4e14 $\\gcd(t, 10) = 1$. \u8003\u8651\u5230 $\\pi(2^x)=3\\times 2^{x-1}$. \u6240\u4ee5 $\\pi(2^{(3+k)}) = 3\\times 2^{k+2} | T$, \u800c $\\pi(2^{(4+k)}) \\not| T$. \u6240\u4ee5 $F_{T+1} \\equiv F_1 \\pmod{2^{3+k}}$, $F_{T+1} \\not\\equiv 1 \\pmod{2^{4+k}}$. \u6240\u4ee5 $\\gcd(2, t) = 1$, \u540c\u7406\u53ef\u4ee5\u8bc1 $\\gcd(5, t)=1$, \u6240\u4ee5 $\\gcd(10, t)=1$.\n\n\u7531\u6b64, $F_{uT+1} = (8\\times 10^kt+1)^u \\equiv 8\\times10^kut+1 \\pmod{10^{2k}}$ (\u76f4\u63a5\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c55\u5f00\u5373\u53ef.)\n\n\u8003\u8651\u6784\u9020 $b, e$ \u4f7f\u5f97 $F_{b+ke} \\equiv 10^{X} (a+kd) + Y$. \u5bb9\u6613\u60f3\u5230\u4ee4 $b+ke = (A+Bk)T+1$, $At \\equiv 125a\\pmod{10^{k}}, Bt\\equiv 125d\\pmod{10^{k}}$(\u8fd9\u91cc\u4e0d\u662f $10^{2k}$ \u7684\u539f\u56e0\u662f $T$ \u4e2d\u6709 $10^9$), \u4e8e\u662f$F_{b+ke}=10^{k+3}(a+kd)+1$, \u53c8\u56e0\u4e3a $a+kd < 10^6$, \u6240\u4ee5\u6784\u9020\u6210\u7acb. \u5176\u4e2d $b=125at^{-1}T+1$, $e=125dt^{-1}T$.\n\n\u6574\u7406\u4e00\u4e0b\u4e3b\u8981\u601d\u8def: \u5e0c\u671b\u6784\u9020 $F_{b+ke} \\equiv 10^{X} (a+kd) + Y \\pmod{10^{18}}$, \u4e8e\u662f\u60f3\u5230\u6784\u9020 $F_{ax+b} = \\lambda10^ka+1\\pmod{10^{2k}}$, \u56e0\u4e3a\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u901a\u8fc7\u4e8c\u9879\u5f0f\u5b9a\u7406\u5316\u7b80\u4e3a $(\\lambda'10^k+1)^a$ \u7684\u5f62\u5f0f, \u4e0d\u96be\u60f3\u5230\u4ee4 $\\pi(10^k)|T$, \u53d6 $F_{T+1}$ \u5373\u53ef\u6ee1\u8db3 $F_{T+1}$ \u80fd\u8868\u793a\u4e3a $\\lambda'10^k+1$ \u7684\u5f62\u5f0f. \u8003\u8651\u6784\u9020 $F_{x_u} \\equiv F_{T+1}^u \\pmod{10^{2k}}$, \u53d1\u73b0 $F_{x_u} \\equiv {F_{x_{u-1}}} F_{T+1}\\equiv F_{x_{u-1}}F_{T+1} + F_{x_{u-1}-1}F_{T}\\equiv F_{x_{u-1}+T} \\pmod {10^{2k}}$, \u5728 $10^k|F_{x_u-1}$ \u5bf9\u6240\u6709 $x_u$ \u6210\u7acb\u65f6\u6210\u7acb. \u7531\u6b64, \u4e0d\u59a8\u53d6 $x_u = uT+1$.\n\n\u8fd8\u5269\u4e0b\u4e00\u4e2a\u95ee\u9898 : \u5982\u4f55\u6c42 $t \\bmod 10^9$, \u6211\u4eec\u53d1\u73b0 $t = \\frac{F_{T+1}-1}{8\\times 10^9}$, \u6240\u4ee5 $t \\bmod 10^9 = \\frac{(F_{T+1}-1) \\bmod (10^9\\times 8\\times 10^9)}{8\\times 10^9}$, \u76f4\u63a5\u6c42\u51fa\u5373\u53ef. (\u8fd9\u4e00\u6b65\u6765\u81ea @GuidingStar)\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define f(i,x,y) for(int i=x, i##end=y; i<=i##end; ++i)\n#define d(i,x,y) for(int i=y, i##end=x; i>=i##end; --i)\n#define ll unsigned long long\n#define pir pair<int, int>\n#define fir first\n#define sec second\n#define mp make_pair\nchar ch;\nint rd() {\n  int f=1, x=0; ch=getchar();\n  while(!isdigit(ch)) { f=((ch=='-')?-1:f); ch=getchar(); }\n  while(isdigit(ch)) { x=x*10+ch-'0'; ch=getchar(); }\n  return x*f;\n}\nvoid rd(int& x) { x=rd(); }\nusing namespace std;\n// ll f0=0LL, f1=1LL;\n// ll target = 12e9+1, mod = 8e18, md=1e9;\nvoid output(ll x) {\n  if(!x) return ;\n  output(x/10);\n  putchar(x%10 + '0');\n}\nll mul(ll a, ll b, ll mod) {\n  ll res=(ll)0; for(; b; a=a+a, a=(a>=mod)?(a-mod):a, b>>=(ll)1) if(b&(ll)1) res+=a, res=(res>=mod)?res-mod:res;\n  return res;\n}\nll qpow(ll a, ll b, ll mod) {\n  ll res=(ll)1; for(; b; a=mul(a, a, mod), b>>=(ll)1) { if(b&(ll)1) res=mul(res, a, mod); }return res;\n}\nll getinv(ll x, ll y) {\n  return qpow(x, 4e8-1, y);\n}\nconst ll mod=1e9;\nint main() {\n  // output(mod); putchar('\\n');\n  // mod=mod*md;\n  // output(mod); putchar('\\n');\n  /*for(ll i=2LL; i<=target; ++i) {\n    ll ftmp = (f1+f0) ; ftmp = ftmp >= mod ? ftmp - mod : ftmp;\n    f0=f1; f1=ftmp;\n  }\n  output((ll)((f1-1)/8e9)); putchar('\\n');\n  f1 = 84177449;\n  // f1 = 29450496\n  cout<< getinv(f1, (ll)1e9) * 125 % (ll)(1e9) << '\\n'; */\n  ll n, a, d; cin>>n>>a>>d;\n  cout<<368131125*a % mod * 12 * mod + 1<< ' ' << 368131125*d % mod * 12 * mod << \"\\n\" ;\n  return 0;\n}\n```\n\n\u5b98\u65b9 python \u4ee3\u7801:\n\n```python\nn,a,d=map(int,input().split())\nprint(368131125*a%10**9*12*10**9+1,368131125*d%10**9*12*10**9)\n```",
        "postTime": 1624373559,
        "uid": 133345,
        "name": "lightup37",
        "ccfLevel": 6,
        "title": "CF1264F \u9898\u89e3"
    },
    {
        "content": "~~\u4ea4\u9519\u9898\u4e24\u6b21\u4e86\uff0c\u5bc4~~\n\n[\u9898\u76ee\u94fe\u63a5](https://www.luogu.com.cn/problem/CF1264F)\n\n\u8bb2\u4e00\u4e2a\u4e0d\u662f\u5b98\u65b9\u9898\u89e3\u7684\u505a\u6cd5\u3002\u8be5\u505a\u6cd5\u6765\u81ea [\u8bc4\u8bba\u533a](https://codeforces.com/blog/entry/71995?#comment-562936)\u3002\n\n\u9898\u76ee\u8981\u6c42\u6784\u9020 $a+id$ \u4e3a $F_{b+ie} \\bmod 10^{18}$ \u7684\u4e00\u4e2a\u5b50\u4e32\u3002\u81ea\u7136\u8003\u8651\u628a\u8fd9\u4e2a\u5b50\u4e32\u5728\u4e00\u4e2a\u56fa\u5b9a\u7684\u4f4d\u7f6e\u6784\u9020\u3002\u4f46\u662f\u6253\u4e2a\u5c0f\u4e00\u70b9\u7684\u8868\u5bb9\u6613\u53d1\u73b0\u6700\u540e\u51e0\u4f4d\u662f\u65e0\u6cd5\u6784\u9020\u51fa\u6240\u6709\u6570\u5b57\u7684\u3002\n\n\u53d1\u73b0 $a+id\\le10^6$\uff0c\u4e5f\u5c31\u662f\u8bf4 $a+id$ \u6700\u591a $6$ \u4f4d\u3002\u8003\u8651\u7a7a\u5f00 $F_{b+ie}$ \u7684\u6700\u540e $6$ \u4f4d\uff0c\u5728\u5012\u6570 $7\\sim12$ \u4f4d\u6784\u9020\uff0c\u5373\u4f7f\u5f97 $a+id=F_{b+ie}/10^6\\bmod10^6$\u3002\n\n\u4ee4 $p$ \u4e3a\u6590\u6ce2\u90a3\u5951\u6570\u5217 $\\bmod 10^6$ \u7684\u5faa\u73af\u5468\u671f\uff08$p=1.5\\times10^6$\uff09\u3002\u601d\u8003\u4e00\u4e0b $F_{kp+1}/10^6\\bmod10^6$ \u4f1a\u5f62\u6210\u4ec0\u4e48\u3002\n\n> Lemma: $F_{n+m+1}=F_nF_m+F_{n+1}F_{m+1}$ \n\n\u8fd9\u662f\u4e00\u4e2a\u7ecf\u5178\u7ed3\u8bba\uff0c\u8bc1\u660e\u7f51\u4e0a\u5e94\u8be5\u5f88\u591a\uff0c\u8fd9\u91cc\u5c31\u4e0d\u8d58\u8ff0\u4e86\u3002\u4ee4 $n=kp,m=p$ \u5219\u53ef\u4ee5\u5f97\u5230\uff1a $F_{(k+1)p+1}\\equiv F_{kp}F_p+F_{kp+1}F_{p+1}$\u3002\u7531 $p$ \u7684\u5b9a\u4e49\u53ef\u5f97\u7b49\u5f0f\u53f3\u8fb9\u7684\u7b2c\u4e00\u9879\u4e0d\u5f71\u54cd\u7ed3\u679c\uff08$F_{kp}\\equiv F_p\\equiv 0\\pmod {10^6}\\Rightarrow F_{kp}F_p\\equiv 0\\pmod{10^{12}}$\uff0c\u6240\u4ee5\u5012\u6570 $7\\sim12$ \u4f4d\u5747\u4e3a $0$\uff09\u3002\n\n\u56e0\u6b64\u6211\u4eec\u5f97\u5230 $F_{(k+1)p+1}/10^6\\bmod10^6=(F_{kp+1}F_{p+1})/10^6\\bmod10^6$\u3002\u628a $F_i$ \u5206\u6210\u4e09\u5757\u8003\u8651\uff1a$A_i=F_i/10^{12}$\uff0c$B_i=F_i/10^6\\bmod10^6$\uff0c$C_i=F_i\\bmod10^6$\u3002\u663e\u7136 $C_{kp+1}=C_{p+1}=1$\u3002\u6309\u7167\u8fd9\u4e2a\u65b9\u5f0f\u628a $F_{kp+1}F_{p+1}$ \u5c55\u5f00\uff1a\n\n$$\n\\begin{aligned}\nF_{kp+1}F_{p+1}=&\\ (A_{kp+1}\\times10^{12}+B_{kp+1}\\times10^6+1)(A_{p+1}\\times10^{12}+B_{p+1}\\times10^6+1)\\\\\n=&\\ A_{kp+1}A_{p+1}\\times10^{24}+(A_{kp+1}B_{p+1}+A_{p+1}B_{kp+1})\\times10^{18}+\\\\\n&(A_{kp+1}+A_{p+1}+B_{kp+1}B_{p+1})\\times10^{12}+(B_{kp+1}+B_{p+1})\\times10^6+1\\\\\n=&\\ \\text{sth.}\\times10^{12}+(B_{kp+1}+B_{p+1})\\times10^6+1\n\\end{aligned}\n$$\n\n\u4e8e\u662f\u53ef\u4ee5\u5f97\u5230 $B_{(k+1)p+1}\\equiv B_{kp+1}+B_{p+1}\\pmod{10^6}$\uff0c\u5373\u6211\u4eec\u60f3\u8981\u6784\u9020\u51fa\u7b49\u5dee\u6570\u5217\u7684\u5730\u65b9\u6ee1\u8db3\u8fd9\u4e2a\u7ed3\u8bba\u3002\u8003\u8651\u5230\u8fd9\u4e2a\u7ed3\u8bba\u4e2d\u7684 $p$ \u53ef\u4ee5\u968f\u4fbf\u4e58\u4e0a\u4e00\u4e2a\u6574\u6570\uff08\u53ea\u8981\u662f\u5468\u671f\u957f\u5ea6\u5c31\u884c\uff09\uff0c\u6211\u4eec\u53ef\u4ee5\u60f3\u529e\u6cd5\u5f04\u51fa\u4e00\u4e2a $B_{xp+1}=1$\uff0c\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u6784\u9020 $b=a\\cdot x\\cdot p + 1$\uff0c$e=d\\cdot x\\cdot p$\u3002\n\n\u8ba1\u7b97\u5f97\u5230 $B_{p+1}=677449$\uff0c\u90a3\u4e48\u6709 $B_{xp+1}\\equiv 677449x\\pmod{10^6}$\u3002\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u627e\u5230 $677449$ \u5728 $\\bmod 10^6$ \u610f\u4e49\u4e0b\u7684\u9006\u5143\u3002\u8ba1\u7b97\u51fa\u6765 $x=445049$\u3002\n\ncode\uff1a\n\n```cpp\n#include <cstdio>\n\ntypedef unsigned long long ull;\nconst ull k = 445049,p = 1.5e6;\n\null n,a,d,b,e;\n\nint main() {\n    scanf(\"%llu%llu%llu\",&n,&a,&d);\n    b = a * k * p + 1,e = d * k * p;\n    printf(\"%llu %llu\\n\",b,e);\n    return 0;\n}\n```",
        "postTime": 1658910115,
        "uid": 114082,
        "name": "Sya_Resory",
        "ccfLevel": 5,
        "title": "\u3010\u9898\u89e3\u3011CF1264F"
    }
]
[
    {
        "content": "\u8d5b\u540e\u53d1\u73b0\u6ca1\u5f00 `long long`\uff0c\u75db\u5931\u4e00\u5343\u591a\u5206\uff0c\u545c\u545c\u545c\u3002\n\n\u5148\u628a\u8be2\u95ee\u5dee\u5206\u3002\n\n\u6211\u4eec\u5b9a\u4e49 $f(l, r, x) = \\sum_{i =l}^r \\sum_{j=1}^y g(i, j)$\u3002\n\n\u6211\u4eec\u5148\u8003\u8651\u5bf9\u4e8e\u540c\u4e00\u4e2a $r$\uff0c\u5982\u4f55\u5feb\u901f\u8ba1\u7b97 $\\sum_{l=x}^y g(l, r)$\uff0c\u6211\u4eec\u8003\u8651\u626b\u63cf\u7ebf\uff0c\u6bcf\u6b21\u628a\u5f53\u524d\u4f4d\u7f6e\u6233\u6210 $1$\uff0c\u628a\u4e0a\u4e00\u4e2a\u548c\u8be5\u5143\u7d20\u76f8\u540c\u7684\u4f4d\u7f6e\u6233\u6210 $0$\uff0c\u7136\u540e $g(i, r)$ \u5c31\u7b49\u4e8e $i$ \u53ca\u4ee5\u540e\u7b2c\u4e00\u4e2a $1$ \u7684\u4f4d\u7f6e\uff0c\u4e8e\u662f\u95ee\u9898\u53d8\u4e3a\u533a\u95f4\u8986\u76d6\u533a\u95f4\u548c\u3002\n\n\u5f53\u7136\u4f60\u53ef\u4ee5\u8bb0 $dis_i$ \u7b49\u4e8e $i$ \u4e0b\u4e00\u4e2a $1$ \u7684\u4f4d\u7f6e\u51cf\u53bb $i$\uff0c\u8fd9\u6837\u5c31\u53d8\u4e3a\u4e86\u533a\u95f4\u52a0\u533a\u95f4\u548c\u3002\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u6c42\u89e3 $f$ \u53d8\u4e3a\u4e86\u524d $x$ \u4e2a\u7248\u672c\u4e2d\u7684\u533a\u95f4\u548c\uff0c\u53ef\u4ee5\u76f4\u63a5\u62c9\u4e00\u4e2a\u5386\u53f2\u7248\u672c\u548c\u7ebf\u6bb5\u6811\u3002\n\n\u8fd9\u6837\u662f\u4e0d\u4f1a\u5f88\u5361\u5e38\u7684\uff1a\uff09\u3002",
        "postTime": 1683593733,
        "uid": 615348,
        "name": "zhouershan",
        "ccfLevel": 7,
        "title": "CF1824D LuoTianyi and the Function sol"
    },
    {
        "content": "\u5c06\u8be2\u95ee\u5dee\u5206\uff0c\u8f6c\u6210\u524d\u7f00\u548c\u3002\n\n\u8003\u8651\u626b\u63cf\u7ebf\u7ef4\u62a4\uff0c\u5c06\u53f3\u7aef\u70b9\u7f6e\u4e3a $1$\uff0c\u5b83\u7684 $lst$ \u8bbe\u4e3a $0$\uff0c\u5219 $g(i,r)$ \u4e3a $i$ \u4e4b\u540e\u7b2c\u4e00\u4e2a $1$\uff0c\u4e8e\u662f\u533a\u95f4\u8986\u76d6\u533a\u95f4\u67e5\u8be2\u5373\u53ef\u3002\n\n\u7ef4\u62a4\u4e0b\u4e00\u4e2a $1$ \u4e0e\u5f53\u524d $i$ \u7684\u5dee\u503c\uff0c\u95ee\u9898\u8f6c\u5316\u4e3a\u533a\u95f4\u52a0\u533a\u95f4\u67e5\u8be2\u3002\n\n\u539f\u95ee\u9898\u7b54\u6848\u5373\u4e3a\uff0c\u524d\u7f00\u7248\u672c\u5386\u53f2\u548c\uff0c\u5957\u4e00\u68f5\u533a\u95f4\u4ef7\u5386\u53f2\u533a\u95f4\u548c\u7ebf\u6bb5\u6811\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n\\log n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\ntypedef pair<int, int> pii;\n#define F(i, a, b) for(int i = a; i <= (b); ++i)\n#define F2(i, a, b) for(int i = a; i < (b); ++i)\n#define dF(i, a, b) for(int i = a; i >= (b); --i)\n#define debug(...) fprintf(stderr, __VA_ARGS__)\n#define Debug debug(\"Passing [%s] in LINS %d\\n\", __FUNCTION__, __LINE__)\n#define pb push_back\n#define fi first\n#define se second\ntypedef long long ll;\n//namespace Fread {const int SIZE = 1 << 17; char buf[SIZE], *S, *T; inline char getchar() {if (S == T) {T = (S = buf) + fread(buf, 1, SIZE, stdin); if (S == T) return '\\n';} return *S++;}}\n//namespace Fwrite {const int SIZE = 1 << 17; char buf[SIZE], *S = buf, *T = buf + SIZE; inline void flush() {fwrite(buf, 1, S - buf, stdout), S = buf;} inline void putchar(char c) {*S++ = c;if (S == T) flush();} struct NTR {~NTR() {flush();}} ztr;}\n//#ifdef ONLINE_JUDGE\n//#define getchar Fread::getchar\n//#define putchar Fwrite::putchar\n//#endif\ninline int ri() {\n\tint x = 0, f = 1;\n\tchar c = getchar();\n\twhile (c < '0' || c > '9') {\n\t\tif (c == '-') f = -1;\n\t\tc = getchar();\n\t}\n\twhile (c >= '0' && c <= '9') x = (x << 3) + (x << 1) + (c ^ 48), c = getchar();\n\treturn x * f;\n}\ninline void wi(int x) {\n\tif (x < 0) {\n\t\tputchar('-'), x = -x;\n\t}\n\tif (x > 9) wi(x / 10);\n\tputchar(x % 10 + 48);\n}\ninline void wi(int x, char s) {\n\twi(x), putchar(s);\n}\nconst int mod = 998244353;\nconst int inf = 0x3f3f3f3f;\nconst ll infll = 0x3f3f3f3f3f3f3f3f;\nconst int _ = 1e6 + 5;\nint n, q;\nstruct node {\n\tint len, u, tg, mtg, s, ms;\n\tvoid add(int _tg, int _mtg, int _u) {\n\t\tms += _u * s + _mtg * len;\n\t\tmtg += _u * tg + _mtg;\n\t\ttg += _tg;\n\t\ts += _tg * len;\n\t\tu += _u;\n\t}\n} tr[_ << 2];\nvoid up(int o) {\n\ttr[o].s = tr[o << 1].s + tr[o << 1 | 1].s;\n}\nvoid build(int o, int l, int r) {\n\ttr[o].len = r - l + 1;\n\tif (l == r) return void();\n\tint mid = (l + r) >> 1;\n\tbuild(o << 1, l, mid), build(o << 1 | 1, mid + 1, r);\n\tup(o);\n}\nvoid pd(int o) {\n\tif(tr[o].tg || tr[o].mtg || tr[o].u) {\n\t\ttr[o << 1].add(tr[o].tg, tr[o].mtg, tr[o].u);\n\t\ttr[o << 1 | 1].add(tr[o].tg, tr[o].mtg, tr[o].u);\n\t\ttr[o].tg = tr[o].mtg = tr[o].u = 0;\n\t}\n}\nvoid add(int o, int l, int r, int L, int R, int c) {\n\tif (L <= l && r <= R) return tr[o].add(c, 0, 0), void();\n\tint mid = (l + r) >> 1;\n\tpd(o);\n\tif (L <= mid) add(o << 1, l, mid, L, R, c);\n\tif (R > mid) add(o << 1 | 1, mid + 1, r, L, R, c);\n\tup(o);\n}\nint qry(int o, int l, int r, int L, int R) {\n\tif (L <= l && r <= R) return tr[o].ms;\n\tint mid = (l + r) >> 1, res = 0;\n\tpd(o);\n\tif (L <= mid) res = qry(o << 1, l, mid, L, R);\n\tif (R > mid) res += qry(o << 1 | 1, mid + 1, r, L, R);\n\treturn res;\n}\nint lst[_], t[_], l[_], r[_], ans[_];\nvector<pair<pair<int, int>, int>> qy[_];\nsigned main() {\n\tn = ri(), q = ri();\n\tint x;\n\tF(i, 1, n) x = ri(), lst[i] = t[x], t[x] = i;\n\tint y;\n\tF(i, 1, q) {\n\t\tint l, r;\n\t\tx = ri(), y = ri(), l = ri(), r = ri();\n\t\tqy[r].pb(make_pair(make_pair(x, y), i));\n\t\tqy[l - 1].pb(make_pair(make_pair(x, y), -i));\n\t}\n\tbuild(1, 1, n);\n\tF(i, 1, n) {\n\t\tx = lst[i], l[i] = i - 1, r[i] = i + 1;\n\t\t// delete lst[i]\n\t\tif(x) {\n\t\t\t// [l[x] + 1, x] += r[x] - x\n\t\t\tadd(1, 1, n, l[x] + 1, x, r[x] - x);\n\t\t\tl[r[x]] = l[x], r[l[x]] = r[x];\n\t\t}\n\t\t// add i\n\t\tadd(1, 1, n, i, i, i);\n\t\ttr[1].add(0, 0, 1);\n\t\tfor(auto v : qy[i]) {\n\t\t\tint k = 1;\n\t\t\tif(v.se < 0) v.se = -v.se, k = -1;\n\t\t\t// calculate [x, y] [1, i]\n\t\t\tans[v.se] += k * qry(1, 1, n, v.fi.fi, v.fi.se);\n\t\t}\n\t}\n\tF(i, 1, q) printf(\"%lld\\n\", ans[i]);\n\treturn 0;\n}\n```",
        "postTime": 1684501199,
        "uid": 257146,
        "name": "orz_z",
        "ccfLevel": 0,
        "title": "CF1824D LuoTianyi and the Function \u9898\u89e3"
    }
]
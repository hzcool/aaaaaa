[
    {
        "content": "# \u9898\u89e3 - $\\mathrm{CF650C}$\n\n## \u9898\u76ee\u610f\u601d\n\n* [\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF650C)\n\n## $\\mathrm{Sol}$\n\n* **\u5e76\u67e5\u96c6+\u62d3\u6251**\n\n* \u9996\u5148\u6211\u4eec\u8003\u8651\u5173\u7cfb\u56fe\u5f88\u80fd\u60f3\u5230\u62d3\u6251\u6392\u5e8f\u5bf9\u5427\uff01\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u628a\u4e00\u884c\u4e2d\u6743\u503c\u76f8\u540c\u7684\u70b9\u5408\u6210\u4e00\u4e2a\u8054\u901a\u5757\u3002\n\n* \u4e8e\u662f\u5c31\u91cd\u65b0\u5efa\u56fe\uff08\u53ca\u4e0d\u540c\u8054\u901a\u5757\u4e4b\u95f4\u8fde\u8fb9\uff09\n\n* \u8fd8\u6709\u6211\u4eec\u4e0d\u597d\u627e\u8d77\u70b9\u4e8e\u662f\u5c31\u968f\u610f\u5b9a\u4e2a\u865a\u70b9\u4ee5\u5176\u4e3a\u8d77\u70b9\u8dd1\u6709\u5411\u56fe\u4e0a\u7684\u6700\u957f\u8def\u5373\u53ef\u3002\n\n* \u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(n\\times m \\log (n\\times m))$\n\n## $\\mathrm{Code}$\n\n```cpp\n#include <bits/stdc++.h>\n#define For(i,a,b) for ( int i=(a);i<=(b);i++ )\n#define Dow(i,b,a) for ( int i=(b);i>=(a);i-- )\n#define GO(i,x) for ( int i=head[x];i;i=e[i].nex )\n#define mem(x,s) memset(x,s,sizeof(x))\n#define cpy(x,s) memcpy(x,s,sizeof(x))\n#define YES return puts(\"YES\"),0\n#define NO return puts(\"NO\"),0\n#define GG return puts(\"-1\"),0\n#define pb push_back\n#define lowbit(x) x&(-x)\nusing namespace std;\n\ninline int read()\n{\n\tint sum=0,ff=1; char ch=getchar();\n\twhile(!isdigit(ch))\n\t{\n\t\tif(ch=='-') ff=-1;\n\t\tch=getchar();\n\t}\n\twhile(isdigit(ch))\n\t\tsum=sum*10+(ch^48),ch=getchar();\n\treturn sum*ff;\n}\n\nconst int mod=1e9+7;\nconst int mo=998244353;\nconst int N=1e6+5;\n\nint n,m,fa[N],in[N],d[N],id;\n\ninline int ID(int x,int y) {return (x-1)*m+y;}\ninline int min(int x,int y) {if(x<y) return x; return y;}\ninline int max(int x,int y) {if(x>y) return x; return y;}\n\ninline int find(int x)\n{\n\tif(x==fa[x]) return x;\n\treturn fa[x]=find(fa[x]);\n}\n\nstruct Node\n{\n\tint x,id;\n\tinline bool friend operator < (const Node&a,const Node&b)\n\t{\n\t\treturn a.x<b.x;\n\t}\n};\nvector<Node> a[N],b[N];\nvector<int> G[N];\n\nint main()\n{\n\tn=read();\n\tm=read();\n\tFor(i,1,n) For(j,1,m) \n\t{\n\t\tint x=read();\n\t\t++id;fa[id]=id;\n\t\ta[i].pb((Node){x,ID(i,j)});\n\t\tb[j].pb((Node){x,ID(i,j)});\n\t}\n\tFor(i,1,n) \n\t{\n\t\tsort(a[i].begin(),a[i].end());\n\t\tFor(j,0,m-2) \n\t\t{\n\t\t\tNode A=a[i][j],B=a[i][j+1];\n\t\t\tif(A.x==B.x) fa[find(A.id)]=find(B.id);\n\t\t}\n\t}\n\tFor(i,1,m) \n\t{\n\t\tsort(b[i].begin(),b[i].end());\n\t\tFor(j,0,n-2)\n\t\t{\n\t\t\tNode A=b[i][j],B=b[i][j+1];\n\t\t\tif(A.x==B.x) fa[find(A.id)]=find(B.id);\n\t\t}\n\t}\n\tFor(i,1,n*m) if(find(i)==i) G[0].pb(i),in[i]++;\n\tFor(i,1,n) For(j,0,m-2)\n\t{\n\t\tNode A=a[i][j],B=a[i][j+1];\n\t\tint x=find(A.id),y=find(B.id);\n\t\tif(x!=y) G[x].pb(y),in[y]++;\n\t}\n\tFor(i,1,m) For(j,0,n-2)\n\t{\n\t\tNode A=b[i][j],B=b[i][j+1];\n\t\tint x=find(A.id),y=find(B.id);\n\t\tif(x!=y) G[x].pb(y),in[y]++;\n\t}\n\tqueue<int> q;\n\tq.push(0);\n\twhile(q.size())\n\t{\n\t\tint u=q.front();q.pop();\n\t\tFor(i,0,(int)G[u].size()-1) \n\t\t{\n\t\t\tint v=G[u][i];\n\t\t\td[v]=max(d[u]+1,d[v]);\n\t\t\tif(!(--in[v])) q.push(v);\n\t\t}\n\t}\n\tFor(i,1,n) \n\t{\n\t\tFor(j,1,m) printf(\"%d \",d[find(ID(i,j))]);\n\t\tputs(\"\");\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1593761814,
        "uid": 308464,
        "name": "\u5947\u7c73",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF650C \u3010Table Compression\u3011"
    },
    {
        "content": "\u6700\u8fd1\u6709\u70b9\u70b9\u80cc\u8fc7\u5934\u4e86\uff0c\u5fc5\u987b\u5f97\u6da8\u6da8\u4eba\u54c1\u4e86\uff0c\u5bb3\u6015\u53bb\u6625\u6d4b\u7684\u8def\u4e0a\u88ab\u96f7\u5288\u6b7b\u3002\n\n\u9898\u89e3\u533a\u5168\u662f\u5e76\u67e5\u96c6\u7f29\u70b9\u4e4b\u540e\u8dd1\u62d3\u6251\u6700\u957f\u8def\uff0c\u5f88\u957f\uff0c\u4e0d\u4f18\u96c5\uff0c\u7ed9\u4e00\u79cd\u4f18\u96c5\u7684\u3002\n\n\u6211\u4eec\u5982\u679c\u5c06\u5f53\u524d\u6240\u6709\u7684\u70b9\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u6309\u7167\u8fd9\u4e2a\u987a\u5e8f\u586b\u6570\uff0c\u586b\u8fdb\u53bb\u80af\u5b9a\u662f\u5355\u8c03\u4e0d\u51cf\u7684\uff0c\u8d77\u7801\u586b\u540e\u73b0\u5728\u8fd9\u4e2a\u6570\u7edd\u5bf9\u4e0d\u4f1a\u6bd4\u4e0a\u4e2a\u6570\u5c0f\u3002\n\n\u518d\u8003\u8651\u90a3\u4e2a\u5927\u5c0f\u7ea6\u675f\uff0c\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u6a2a\u5411\u7684\u548c\u7eb5\u5411\u7684\u6700\u5927\u503c\u6240\u5904\u4f4d\u7f6e\uff0c\u5982\u679c\u6211\u4eec\u7684 $a > a_{\\max}$\uff0c\u538b\u7f29\u540e\u7684\u7b54\u6848\u81f3\u5c11\u8981\u6bd4\u6700\u5927\u7684\u90a3\u4e2a\u8fd8\u8981\u5927 $1$\uff1b\u7b49\u4e8e\u7684\u60c5\u51b5\u9664\u5916\uff0c\u6b64\u65f6\u6211\u4eec\u5408\u5e76\u5e76\u67e5\u96c6\u5c31\u53ef\u4ee5\u4e86\uff0c\u6b64\u65f6\u6211\u4eec\u5f97\u5230\u7684\u7b54\u6848\u4e00\u5b9a\u662f\u6b64\u65f6\u6a2a\u5411\u548c\u7eb5\u5411\u6700\u5927\u503c\u7684\u4f4d\u7f6e\uff0c\u66f4\u65b0\u4e00\u4e0b\u3002\n\n### Code.\n\n```cpp\n#include<bits/stdc++.h>\n#define id(x,y) ((x-1)*m+y)\nint read()\n{\n\tint x=0; bool f=0; char ch=getchar();\n\twhile(ch < '0' || ch > '9') f|=(ch == '-'),ch=getchar();\n\twhile(ch >= '0' && ch <= '9') x=x*10+(ch^48),ch=getchar();\n\treturn f ? -x : x;\n}\nusing namespace std;\nconst int N=1e6+10;\nint a[N],n,m,f[N],ans[N],px[N],py[N];\nint find(int x) {if(f[x] != x) f[x]=find(f[x]); return f[x];}\nstruct node\n{\n\tint x,y,pos;\n\tbool operator < (const node &o) const {\n\t\treturn a[pos] < a[o.pos];\n\t}\n} pl[N];\nint main()\n{\n\tn=read(); m=read(); for(int i=1;i<=n*m;i++) f[i]=i;\n\tfor(int i=1;i<=n;i++) for(int j=1;j<=m;j++) {int p=id(i,j); pl[p]=node{i,j,p}; a[p]=read();}\n\tstable_sort(pl+1,pl+1+n*m);\n\tfor(int i=1;i<=n*m;i++)\n\t{\n\t\tint fx=find(px[pl[i].x]),fy=find(py[pl[i].y]),p=find(pl[i].pos);\n\t\tif(a[p] == a[fx]) f[fx]=p; if(a[p] == a[fy]) f[fy]=p; px[pl[i].x]=py[pl[i].y]=p;\n\t\tans[p]=max(ans[fx]+(a[p] != a[fx]),ans[fy]+(a[p] != a[fy]));\n\t}\n\tfor(int i=1;i<=n;i++) for(int j=1;j<=m;j++) printf(\"%d%c\",ans[find(id(i,j))],\" \\n\"[j == m]);\n\treturn 0;\n}\n```",
        "postTime": 1677474860,
        "uid": 230865,
        "name": "EastPorridge",
        "ccfLevel": 0,
        "title": "CF650C Table Compression \u9898\u89e3"
    },
    {
        "content": "\u9996\u5148\uff0c\u5c06\u6240\u6709**\u540c\u4e00\u884c\u6216\u540c\u4e00\u5217**\u5e76\u4e14\u503c\u76f8\u7b49\u7684\u70b9\u7528\u5e76\u67e5\u96c6\u7f29\u70b9\u3002\n\n\u4e4b\u540e\uff0c\u5c06\u6bcf\u884c\u6bcf\u5217\u7684\u70b9\u6392\u5e8f\uff0c\u5c06\u6392\u5e8f\u540e\u76f8\u90bb\u7684\u70b9\u8fde\u8fb9\u3002\n\n\u6ce8\u610f\u6b64\u65f6\u56fe\u4e0d\u4e00\u5b9a\u8fde\u901a\uff0c\u56e0\u6b64\u518d\u5efa\u4e00\u4e2a\u8d85\u7ea7\u6e90\u70b9\u50cf\u6240\u6709\u70b9\u8fde\u8fb9\u3002\n\n\u6700\u540e\u7528\u62d3\u6251\u6392\u5e8f\u6c42\u6bcf\u4e2a\u70b9\u5230\u6e90\u70b9\u7684\u6700\u957f\u8def\uff0c\u5373\u4e3a\u7b54\u6848\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(nm\\log nm)$ \u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1e6+5;\nvector<int>e[N];\nvector<pair<int,int> >a[N],b[N];\nint d[N],g[N],q[N],f[N];\nint getf(int x){return f[x]==x?x:f[x]=getf(f[x]);}\nint main(){\n\tint id=0,i,j,k,l,n,m,h=0,t=1;\n\tscanf(\"%d%d\",&n,&m);\n\tfor(i=1;i<=n;++i){\n\t\tfor(j=1;j<=m;++j){\n\t\t\tscanf(\"%d\",&k),++id,f[id]=id;\n\t\t\ta[i].push_back({k,id}),b[j].push_back({k,id});\n\t\t}\n\t}\n\tfor(i=1;i<=n;++i){\n\t\tsort(a[i].begin(),a[i].end());\n\t\tfor(j=a[i].size(),k=1;k<j;++k){\n\t\t\tif(a[i][k].first==a[i][k-1].first)f[getf(a[i][k].second)]=getf(a[i][k-1].second);\n\t\t}\n\t}\n\tfor(i=1;i<=m;++i){\n\t\tsort(b[i].begin(),b[i].end());\n\t\tfor(j=b[i].size(),k=1;k<j;++k){\n\t\t\tif(b[i][k].first==b[i][k-1].first)f[getf(b[i][k].second)]=getf(b[i][k-1].second);\n\t\t}\n\t}//\u6392\u5e8f\uff0c\u5e76\u67e5\u96c6\u7f29\u70b9\n\tfor(i=1;i<=id;++i)if(f[i]==i)e[0].push_back(i),g[i]=1;//\u6e90\u70b9\u8fde\u8fb9\n\tfor(i=1;i<=n;++i){\n\t\tfor(j=a[i].size(),k=1;k<j;++k){\n\t\t\tif(a[i][k].first!=a[i][k-1].first)l=getf(a[i][k].second),e[getf(a[i][k-1].second)].push_back(l),++g[l];\n\t\t}\n\t}\n\tfor(i=1;i<=m;++i){\n\t\tfor(j=b[i].size(),k=1;k<j;++k){\n\t\t\tif(b[i][k].first!=b[i][k-1].first)l=getf(b[i][k].second),e[getf(b[i][k-1].second)].push_back(l),++g[l];\n\t\t}\n\t}//\u76f8\u90bb\u70b9\u8fde\u8fb9\n\tq[1]=0;\n\twhile(h<t){\n\t\ti=q[++h];\n\t\tfor(auto j:e[i]){\n\t\t\t--g[j];\n\t\t\tif(!g[j])q[++t]=j,d[j]=d[i]+1;\n\t\t}\n\t}//\u62d3\u6251\u6392\u5e8f\n\tfor(i=1,id=0;i<=n;++i){\n\t\tfor(j=0;j<m;++j)printf(\"%d \",d[getf(++id)]); \n\t\tputs(\"\");\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1583898227,
        "uid": 221955,
        "name": "panyf",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF650C \u3010Table Compression\u3011"
    }
]
[
    {
        "content": "### \u89e3\u9898\u601d\u8def\n\n\u5148\u60f3\u6700\u7b80\u5355\u7684\u60c5\u51b5 $k = 0$\uff0c\u8fd9\u6b63\u662f\u6700\u7ecf\u5178\u7684[\u5b57\u7b26\u4e32\u5339\u914d](https://www.luogu.org/problemnew/show/P3375)\u95ee\u9898\uff0c\u53ef\u7528 $KMP$ \u7b49\u7b97\u6cd5 $O(n)$ \u89e3\u51b3\u3002\n\n\u4f46\u54b1\u4eca\u5929\u7684\u4e3b\u89d2\uff0c\u662f\u591a\u9879\u5f0f\u4e58\u6cd5\uff0c\u6211\u4eec\u5c1d\u8bd5\u7528\u5b83\u89e3\u51b3\u8fd9\u4e00\u60c5\u51b5\u3002\n\n\u8003\u8651\u6210\u529f\u5339\u914d\u65f6\u7684\u6027\u8d28\uff0c\u6a21\u5f0f\u4e32\u4e0a\u7684\u6bcf\u4e2a\u5b57\u7b26\uff0c\u4e0e\u5339\u914d\u7684\u5bf9\u5e94\u5b57\u7b26\uff0c\u4f4d\u7f6e\u7684**\u5dee**\u662f\u76f8\u7b49\u7684\u3002\n\n\u8003\u8651\u591a\u9879\u5f0f\u4e58\u6cd5\u7684\u6027\u8d28\uff0c\u901a\u8fc7\u5377\u79ef\u5f97\u5230\u7684\u65b0\u591a\u9879\u5f0f\uff0c\u6bcf\u4e00\u9879\u7684\u7cfb\u6570\u4e0e\u539f\u591a\u9879\u5f0f\u4e24\u4e2a\u6b21\u6570\u4e4b**\u548c**\u76f8\u7b49\u7684\u9879\u6709\u5173\u3002\n\n\u6027\u8d28\u90fd\u5f88\u660e\u663e\uff0c\u600e\u4e48\u8054\u7cfb\u4e0a\u5462\uff1f\n\n\u5f88\u7b80\u5355\uff0c\u53ea\u9700\u7ed9\u6a21\u5f0f\u4e32\u7ffb\u4e2a\u8f6c\u513f\uff0c\u4e0d\u5c31\u548c\u5377\u79ef\u662f\u4e00\u6837\u7684\u4e1c\u897f\u4e86\uff1f\n\n\u8bbe\u7b54\u6848\u591a\u9879\u5f0f $A(x) = \\sum\\limits_{i=m-1}^{n} x^i\\sum\\limits_{j=0}^{m-1}(s_{i-j}-t_{j})^2$\u3002\n\n\u610f\u4e49\u5e94\u8be5\u4e0d\u96be\u770b\u51fa\uff0c$i$ \u662f\u5339\u914d\u7684\u8d77\u59cb\u4f4d\u7f6e\uff0c$j$ \u662f\u5f53\u524d\u5df2\u7ecf\u5339\u914d\u7684\u5b57\u7b26\u6570\u91cf\u3002\u800c\u8fd9\u4e2a\u5e73\u65b9\uff0c\u5c31\u662f\u8ba9\u6bcf\u4e00\u9879\u7684\u7cfb\u6570\u975e\u8d1f\uff0c\u53ea\u6709\u7cfb\u6570 $= 0$ \u65f6\uff0c\u624d\u8868\u793a\u6210\u529f\u5339\u914d\u3002\n\n$$A(x) = \\sum_{i=m-1}^{n} x^i\\sum_{j=0}^{m-1}s_{i-j}^2 + t_{j}^ 2 - 2s_{i-j}t_{j}$$\n\n\u5176\u4e2d\uff0c\u53ea\u8ddf $i-j$ \u6216 $j$ \u6709\u5173\u7684\u9879\uff0c\u53ef\u4ee5\u63d0\u53d6\u51fa\u6765\u5355\u72ec\u8ba1\u7b97\uff0c\u5176\u4ed6\u7684\uff0c\u6b63\u662f\u5377\u79ef\u5f62\u5f0f\u4e86\uff0c$FFT$\u3001$NTT$ \u968f\u4fbf\u4e0a\u3002\u6574\u4f53\u590d\u6742\u5ea6\u662f $O(n \\log n)$ \u7684\uff0c\u7a0d\u900a $KMP$\uff0c\u4f46\u597d\u5904\u5728\u4e8e\uff0c\u5b83\u80fd\u63a8\u5e7f\u5230 $k > 0$ \u7684\u4e00\u822c\u60c5\u51b5\uff0c\u751a\u81f3\u80fd\u5e94\u5bf9\u51fa\u9898\u4eba\u7684\u66f4\u591a\u6bd2\u7624\u53d8\u5e7b\u3002\n\n---\n\n\u56de\u5230 $k > 0$ \u7684\u4e00\u822c\u60c5\u51b5\uff0c\u53d1\u73b0\u9898\u76ee\u8fd8\u6709\u4e00\u4e2a\u6027\u8d28\uff0c\u5b57\u6bcd\u53ea\u6709 $4$ \u79cd\u3002\n\n\u8fd9\u5176\u5b9e\u6697\u793a\u7740\u6211\u4eec\u53ef\u4ee5\u6309\u7167\u5b57\u6bcd\u79cd\u7c7b\u5206 $4$ \u79cd\u60c5\u51b5\u5206\u522b\u5904\u7406\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u53ef\u4ee5\u5bf9\u4e8e\u6bcf\u79cd\u5b57\u6bcd\u5904\u7406\u5176\u6210\u529f\u5339\u914d\u7684\u6570\u91cf\uff0c\u6700\u540e\u52a0\u5728\u4e00\u8d77\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff1a\n\n$$S=\"AACCATGTA\"$$\n\n$$T=\"ACCA\"$$\n\n\u5047\u5982\u6211\u4eec\u6b63\u5728\u505a $A$ \u8fd9\u4e2a\u5b57\u6bcd\uff0c\u6211\u4eec\u53ef\u4ee5\u5047\u88c5\u66ff\u6362\u4e86\u5176\u4ed6\u5b57\u6bcd\uff1a\n\n$$S=\"AA\\#\\#\\#\\#\\#\\#A\"$$\n\n$$T=\"A\\%\\%A\"$$\n\n\u8c8c\u4f3c $k$ \u8fd8\u6ca1\u7528\u4e0a\uff1f\u5176\u5b9e\u6211\u4eec\u53ef\u4ee5\u628a $k$ \u7406\u89e3\u4e3a $S$ \u4e32\u4e2d\u7684\u5b57\u6bcd\u5411\u4e24\u8fb9\u6269\u6563\u7684\u8ddd\u79bb\uff0c\u5373 $k = 1$ \u65f6\uff1a\n\n$$S=\"AAA\\#\\#\\#\\#AA\"$$\n\n$$T=\"A\\%\\%A\"$$\n\n\u4ee5\u4e0a\u53ea\u8981\u987a\u7740\u626b\u4e00\u904d\uff0c\u518d\u9006\u7740\u626b\u4e00\u904d\uff0c\u5c31\u53ef\u4ee5\u505a\u5230\u3002\n\n\u6700\u540e\uff0c\u4ecd\u7136\u662f\u6784\u9020\u591a\u9879\u5f0f\uff0c\u56e0\u4e3a\u6bcf\u6b21\u88ab\u5339\u914d\u7684\u5b57\u6bcd\u53ea\u6709\u4e00\u79cd\uff0c\u6784\u9020\u53ef\u4ee5\u7b80\u5316\u3002\n\n\u7531\u4e8e\u53ea\u6709\u4e24\u8fb9\u90fd\u662f\u5f53\u524d\u5339\u914d\u7684\u5b57\u6bcd\u65f6\uff0c\u624d\u5bf9\u7b54\u6848\u591a\u9879\u5f0f\u67d0\u4e00\u9879\u7684\u7cfb\u6570\u6709 $1$ \u7684\u8d21\u732e\uff0c\u5426\u5219\u8d21\u732e\u4e3a $0$\u3002\n\n$$A \\times A = 1,\\ \\# \\times A = 0,\\ A \\times \\% = 0,\\ \\# \\times \\% = 0$$\n\n\u663e\u7136\uff0c\u5c06 $S$ \u4e32\u6269\u6563\u64cd\u4f5c\u540e\uff0c\u6784\u9020 $F(x) = \\sum\\limits_{i=0}^{n}x^i[S_{i} \\text{\u662f\u5f53\u524d\u5339\u914d\u7684\u5b57\u6bcd}]$\uff0c\u5c06 $T$ \u4e32\u7ffb\u8f6c\u64cd\u4f5c\u540e\uff0c$G(x) = \\sum\\limits_{i=0}^{n}x^i[T_i\\text{\u662f\u5f53\u524d\u5339\u914d\u7684\u5b57\u6bcd}]$\uff0c\u5229\u7528\u521a\u624d\u8bb2\u7684\u5377\u79ef\u7684\u6027\u8d28\uff0c\u4ee4 $A(x)\\ \\text{+=}\\ F(x)\\ast G(x)$\n\u5373\u53ef\u3002\n\n\u6700\u540e\u7684\u6700\u540e\uff0c\u5bf9\u4e8e\u5f97\u51fa\u6765\u7684 $A(x)$\uff0c\u56e0\u4e3a\u53ea\u6709\u5168\u90e8 $m$ \u4e2a\u5b57\u6bcd\u5339\u914d\u624d\u884c\uff0c\u6bcf\u4e2a\u7cfb\u6570\u4e3a $m$ \u7684\u9879\u5bf9\u7b54\u6848\u6709 $1$ \u7684\u8d21\u732e\u3002\n\n---\n\n### \u4ee3\u7801\u5b9e\u73b0\n\n\u4e0b\u9762\u7528\u7684\u662f $NTT$\uff0c\u5f53\u7136 $FFT$ \u4e5f\u662f\u53ef\u505a\u7684\u3002\u6211\u53ef\u80fd\u5199\u5f97\u6bd4\u8f83\u4e11\u2026\u2026\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <algorithm>\n#include <iostream>\n\ninline int power(int x, int y, int p) { int res = 1; for (; y; y >>= 1, x = 1ll * x * x % p) { if (y & 1) { res = 1ll * res * x % p; } } return res; }\n\nconst int maxN = 530000;\n\nstruct Poly {\n    int n, p, g, invG, a[maxN];\n\n    Poly() { p = 119 << 23 | 1; g = 3; invG = (p + 1) / g; }\n    void ntt(int lim, int rev[], int sgn) {\n        for (int i = 0; i < lim; i++) { if (i < rev[i]) { std::swap(a[i], a[rev[i]]); } }\n        for (int len = 1, logLen = 1; len < lim; len <<= 1, logLen++) {\n            int uni = power(sgn == 1 ? g : invG, (p + 1) >> logLen, p);\n            for (int i = 0, w = 1; i < lim; i += len << 1, w = 1) {\n                for (int j = 0; j < len; j++, w = 1ll * w * uni % p) { int x = 1ll * a[i + j + len] * w % p; a[i + j + len] = (a[i + j] + p - x) % p; (a[i + j] += x) %= p; }\n            }\n        }\n        if (!~sgn) { for (int i = 0, invLim = power(lim, p - 2, p); i < lim; i++) { a[i] = 1ll * a[i] * invLim % p; } }\n    }\n} tmp1, tmp2, tmp3; int rev[maxN];\nvoid mul(const Poly &f, const Poly &g, Poly &res) {\n    int lim = 1, cnt = 0; while (lim <= f.n + g.n - 2) { lim <<= 1; cnt++; }\n    for (int i = 1; i < lim; i++) { rev[i] = rev[i >> 1] >> 1 | (i & 1) << cnt - 1; }\n    tmp1.n = f.n; memcpy(tmp1.a, f.a, sizeof(int) * lim); tmp1.ntt(lim, rev, 1);\n    tmp2.n = g.n; memcpy(tmp2.a, g.a, sizeof(int) * lim); tmp2.ntt(lim, rev, 1);\n    for (int i = 0; i < lim; i++) { res.a[i] = 1ll * tmp1.a[i] * tmp2.a[i] % f.p; }\n    res.n = f.n + g.n - 1; res.ntt(lim, rev, -1);\n}\nPoly operator *(const Poly &f, const Poly &g) { memset(tmp3.a, 0, sizeof(tmp3.a)); mul(f, g, tmp3); return tmp3; }\n\n// ------------------------------------- \u4e0a\u9762\u90fd\u662f\u677f\u5b50 ------------------------------------- //\n\nint n, m, k, ans, cnt[maxN];\nstd::string s, t;\nPoly f, g;\n\nvoid solve(char c) {\n    f.n = n; g.n = m; memset(f.a, 0, sizeof(f.a)); memset(g.a, 0, sizeof(g.a)); // \u5148\u6e05\u7a7a, \u9632\u6b62\u51fa\u9505.\n    // --------------------------------- \u5904\u7406\u591a\u9879\u5f0f f ------------------------------------- //\n    for (int i = 0, lst = -1e9; i < n; i++) {\n        if (s[i] == c) { lst = i; } // \u627e\u5de6\u8fb9\u6700\u8fd1\u7684\u5f53\u524d\u5b57\u6bcd c.\n        if (i - lst <= k) { f.a[i] = 1; } // \u5982\u679c\u8ddd\u79bb\u5408\u6cd5, \u5219\u8bbe 1.\n    }\n    for (int i = n - 1, lst = 1e9; ~i; i--) {\n        if (s[i] == c) { lst = i; } // \u627e\u53f3\u8fb9\u6700\u8fd1\u7684\u5f53\u524d\u5b57\u6bcd c.\n        if (lst - i <= k) { f.a[i] = 1; } // \u5982\u679c\u8ddd\u79bb\u5408\u6cd5, \u5219\u8bbe 1.\n    }\n    // --------------------------------- \u5904\u7406\u591a\u9879\u5f0f g ------------------------------------- //\n    for (int i = 0; i < m; i++) { g.a[i] = t[m - 1 - i] == c; } // \u7ffb\u8f6c\u4e00\u4e0b\u6a21\u5f0f\u4e32\u5c31\u597d\u4e86.\n    // --------------------------------- \u5377\u79ef\u7d2f\u52a0\u8d21\u732e ------------------------------------- //\n    f = f * g; for (int i = 0; i < f.n; i++) { cnt[i] += f.a[i]; }\n}\n\nint main() {\n    std::cin >> n >> m >> k >> s >> t;\n    for (int i = 0; i <= 3; i++) { solve(\"ACTG\"[i]); } // \u5206\u522b\u8ba1\u7b97\u6bcf\u4e2a\u5b57\u6bcd\u5bf9\u5339\u914d\u7684\u8d21\u732e.\n    for (int i = 0; i <= n + m - 2; i++) { ans += cnt[i] == m; } // \u5168\u5339\u914d m \u4e2a\u5b57\u6bcd.\n    std::cout << ans << std::endl;\n    return 0;\n}\n```",
        "postTime": 1543909128,
        "uid": 26673,
        "name": "Sooke",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF528D \u3010Fuzzy Search\u3011"
    },
    {
        "content": "\u6807\u7b97FFT?\u4e0d\u4f1aFFT\u7684\u849f\u84bb\u6765\u8bb2\u4e00\u79cd\u6bd4\u8f83\u66b4\u529b\u7684\u65b9\u6cd5\u3002\n\n\u9996\u5148\uff0c\u5bf9\u4e8e\u56db\u79cd\u5b57\u6bcd\u5904\u7406\u51fa\u53ef\u4ee5\u5339\u914d\u5230\u7684\u8303\u56f4,\u5373i-k\u81f3i+k,\u4f7f\u7528\u5dee\u5206\u53ef\u4ee5\u5728O(n)\u4e4b\u5185\u6c42\u51fa\u6765\u3002\u7136\u540e\uff0c\u6211\u4eec\u5c31\u5f97\u5230\u4e864\u4e2a\u957f\u5ea6\u4e3an\u768401\u4e32\uff0c\u5bf9\u4e8e\u5339\u914d\u4e32\u7684i\u4f4d\u53f3\u79fbi\u4f4d\u540e\u5168\u90e8&\u8d77\u6765\uff0c\u6700\u540e1\u7684\u4e2a\u6570\u5373\u4e3a\u7b54\u6848\u3002\n\n\u542c\u4e0a\u53bb\u662f\u4e2a\u4e0d\u9519\u7684\u6ce8\u610f\uff0c\u4f46\u662f\u65f6\u95f4\u590d\u6742\u5ea6O(nm)\uff0c4*10^10\uff0c\u5f88\u660e\u663e\u4f1aTLE\u3002\n\n\u6ca1\u4e8b\uff0c\u4f7f\u7528bitset\u8ba9\u65f6\u95f4/32\u5373\u53ef\u901a\u8fc7\u672c\u9898\u3002\n\ncode:\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=200005;\nint mp[200],a[N][4];\nbitset<N> bs[4],ans;\nint main()\n{\n\tios::sync_with_stdio(false);\n\tint n,m,k;\n\tstring s,t;\n\tcin>>n>>m>>k>>s>>t;\n\tmp['A']=0,mp['C']=1,mp['G']=2,mp['T']=3;\n\tfor(int i=0;i<n;i++)\n\t{\n\t\ta[max(0,i-k)][mp[s[i]]]++;\n\t\ta[min(n,i+k+1)][mp[s[i]]]--;\n\t}\n\tfor(int i=0;i<n;i++)\n\t{\n\t\tans[i]=1;\n\t\tfor(int j=0;j<4;j++)\n\t\t{\n\t\t\tif(i)\n\t\t\t\ta[i][j]+=a[i-1][j];\n\t\t\tif(a[i][j])\t\n\t\t\t\tbs[j][i]=1;\n\t\t\telse\n\t\t\t\tbs[j][i]=0;\n\t\t}\n\t}\n\tfor(int i=0;i<m;i++)\n\t\tans&=(bs[mp[t[i]]]>>i);\n\tint sum=0;\n\tfor(int i=0;i<n;i++)\n\t\tsum+=(ans[i]==1);\n\tprintf(\"%d\\n\",sum);\n\treturn 0;\n}\n\n```\n",
        "postTime": 1552812469,
        "uid": 183821,
        "name": "Vn_nV",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF528D \u3010Fuzzy Search\u3011"
    },
    {
        "content": "## \u524d\u8a00\n\n\u8fd9\u4e2a\u65b9\u6cd5\u4e0d\u5bf9\u52b2\uff0c\u4f46\u662f\u662f\u5bf9\u7684qwq\u3002\n\n\u6211\u4e00\u76f4\u5728\u60f3\u4e3a\u4ec0\u4e48\u662f `A,C,G,T` \u56db\u4e2a\u5b57\u7b26\u3002\u73b0\u5728\u6211\u60f3\u901a\u4e86\u3002\u8fd9\u573a CF \u5927\u6982\u662f ATcoder \u7684 AGC \u51fa\u9898\u4eba\u51fa\u7684\uff08\u5927\u96fe\uff09\n\n## \u89e3\u6cd5\n\n\u9996\u5148\u6211\u4eec\u8981\u8003\u8651 $k=0$ \u7684\u65f6\u5019\u600e\u4e48\u505a\u3002\u76f4\u63a5 KMP \u5373\u53ef\u3002\n\n\u4f46\u662f\u8fd9\u6837\u6211\u4eec\u6ca1\u6cd5\u505a $k>0$ \u7684\u60c5\u51b5\u3002\u6211\u4eec\u8003\u8651\u7528 `FFT/NTT`\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u9898\u4e2d\u53ea\u6709 $4$ \u4e2d\u5b57\u7b26\u3002\u6211\u4eec\u8003\u8651\u4e00\u4e2a\u4e00\u4e2a\u5904\u7406\u3002\u5047\u8bbe\u5bf9\u4e8e\u6837\u4f8b\uff0c\u6211\u4eec\u5148\u5904\u7406 `A` \u5b57\u7b26\u3002\n\n\u90a3\u4e48\u6211\u4eec\u6709\uff1a\n\n$$S=A**AA***A*\\\\T=A*A*$$\n\n\u5176\u4e2d `*` \u662f\u901a\u914d\u7b26\uff0c\u53ef\u4ee5\u4e3a\u4efb\u610f\u5b57\u7b26\u3002\n\n\u90a3\u4e48\u600e\u4e48\u5904\u7406 $k$ \u5462\uff1f\n\n\u6211\u4eec\u5bb9\u6613\u60f3\u5230\uff0c\u53ef\u4ee5\u628a\u4e00\u4e2a\u539f\u6765\u662f `A` \u7684\u4f4d\u7f6e\u5f80\u4e24\u65c1\u5ef6\u4f38 $k$ \u4e2a\u4f4d\u7f6e\uff0c\u628a\u5b83\u4eec\u90fd\u7f6e\u4e3a `A`\u3002\u8fd9\u6837 $k$ \u5c31\u6ca1\u6709\u5f71\u54cd\u5566\u3002\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5bf9\u4e8e\u6837\u4f8b\u6211\u4eec\u5c31\u6709\uff1a\n\n$$S'=AAAAAA*AAA\\\\T=A*A*$$\n\n\u4e3a\u4e86\u65b9\u4fbf\u8ba1\u7b97\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\uff1a\n\n$$S'=1111110111\\\\T=1010$$\n\n\u628a $S'$ \u548c $T$ \u8f6c\u5316\u4e3a\u591a\u9879\u5f0f $f,g$\uff0c\u90a3\u4e48\u4ec0\u4e48\u60c5\u51b5\u4e0b\u5728 $i$ \u7684\u4f4d\u7f6e\u73c2\u4ee5\u6210\u529f\u5339\u914d\u5462\uff1f\n\n\u5982\u679c\u6211\u4eec\u6709\uff1a\n\n$$h_i=\\sum\\limits_{j=1}^{|T|} g_j\\cdot(f_{i+j}-g_{j})^2$$\n\n\u5f53 $h_i$ \u4e3a $0$ \u65f6\uff0c\u5728 $i$ \u4e0a\u53ef\u4ee5\u5339\u914d\u3002\n\n\u600e\u6837\u5feb\u901f\u6c42\u51fa $h_i$ \u5462\uff1f\u5c55\u5f00\u5f97\uff1a\n\n$$h_i=\\sum\\limits_{j=1}^{|T|} g_j\\cdot {f_{i+j}}^2+{g_j}^3-2\\cdot {g_j}^2\\cdot f_{i+j}$$\n\n\u6211\u7684\u7b2c\u4e00\u53cd\u5e94\u662f\uff1a\u5b8c\u4e86\uff0c\u5904\u7406\u4e0d\u4e86\u3002\n\n\u4ed4\u7ec6\u4e00\u60f3\uff0c\u5176\u5b9e\u662f\u5bf9\u7684\u3002\n\n\u7531\u4e8e $g,f$ \u6bcf\u4e00\u9879\u7684\u53d6\u503c\u4e3a $0$ \u6216 $1$\uff0c\u6240\u4ee5\u6bcf\u4e2a\u5e73\u65b9\u6216\u8005\u4e09\u6b21\u65b9\u9879\u90fd\u53ef\u4ee5\u6d88\u6210\u4e00\u6b21\u9879\uff0c\u4e0d\u5f71\u54cd\u8ba1\u7b97\uff0c\u56e0\u6b64\u8f6c\u5316\u4e3a:\n\n$$h_i=\\sum\\limits_{j=1}^{|T|} g_j\\cdot {f_{i+j}}+{g_j}-2\\cdot {g_j}\\cdot f_{i+j}\\\\h_i=\\sum\\limits_{j=1}^{|T|} {g_j}-{g_j}\\cdot f_{i+j}$$\n\n\u5c06 $g$ \u7ffb\u8f6c\u5c31\u53ef\u4ee5\u6c42\u5377\u79ef\u4e86\u3002\n\n\u6700\u540e\u56db\u4e2a\u5b57\u7b26\u5206\u522b\u5904\u7406\u5bf9\u5e94\u7684 $h_i$\uff0c\u90fd\u4e3a $0$ \u5219\u8fd9\u4e2a\u4f4d\u7f6e\u53ef\u4ee5\u5339\u914d\u3002\n\n## \u4ee3\u7801\n\n```cpp\n//Don't act like a loser.\n//This code is written by huayucaiji\n//You can only use the code for studying or finding mistakes\n//Or,you'll be punished by Sakyamuni!!!\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\n\nint read() {\n\tchar ch=getchar();\n\tint f=1,x=0;\n\twhile(ch<'0'||ch>'9') {\n\t\tif(ch=='-')\n\t\t\tf=-1;\n\t\tch=getchar();\n\t}\n\twhile(ch>='0'&&ch<='9') {\n\t\tx=x*10+ch-'0';\n\t\tch=getchar();\n\t}\n\treturn f*x;\n}\n\nconst int MAXN=4e6+10;\nconst int G=3;\nconst int MOD=998244353;\n\nint n,m,k;\nint d=1,bit=0;\nshort index[30];\nint s[MAXN],t[MAXN],f[MAXN],g[MAXN],r[MAXN],ans[MAXN];\n\nint qpow(int x,int y) {\n\tint ret=1;\n\twhile(y) {\n\t\tif(y&1) {\n\t\t\tret=x*ret%MOD;\n\t\t}\n\t\ty>>=1;\n\t\tx=x*x%MOD;\n\t}\n\treturn ret;\n}\n\nvoid NTT(int A[],int d,int inv) {\n\tfor(int i=0;i<d;i++) {\n\t\tif(i<r[i]) {\n\t\t\tswap(A[i],A[r[i]]);\n\t\t}\n\t}\n\t\n\tfor(int len=1;len<d;len<<=1) {\n\t\tint gn=qpow(G,(MOD-1)/(len*2));\n\t\tfor(int i=0;i<d;i+=len<<1) {\n\t\t\tint g=1;\n\t\t\tfor(int k=0;k<len;k++,g=g*gn%MOD) {\n\t\t\t\tint x=A[i+k];\n\t\t\t\tint y=g*A[i+k+len]%MOD;\n\t\t\t\tA[i+k]=(x+y)%MOD;\n\t\t\t\tA[i+k+len]=(x-y+MOD)%MOD;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tif(inv==-1) {\n\t\treverse(A+1,A+d);\n\t\tint g=qpow(d,MOD-2);\n\t\tfor(int i=0;i<d;i++) {\n\t\t\tA[i]=A[i]*g%MOD;\n\t\t}\n\t}\n}\n\nvoid FFT_KMP() {\n\tint cst=0;\n\tfor(int i=0;i<m;i++) {\n\t\tcst+=g[i];\n\t}\n\treverse(g,g+m);\n\tNTT(f,d,1);\n\tNTT(g,d,1);\n\tfor(int i=0;i<d;i++) {\n\t\tf[i]=f[i]*g[i]%MOD;\n\t}\n\tNTT(f,d,-1);\n\tfor(int i=0;i<n;i++) {\n\t\tans[i]+=f[m+i-1]+cst-2*f[m+i-1];\n\t}\n}\n\nsigned main() {\n\tindex['A'-'A']=1;index['C'-'A']=2;index['G'-'A']=3;index['T'-'A']=4;\n\tn=read();m=read();k=read();\n\t\n\tfor(int i=0;i<n;i++) {\n\t\tchar c;\n\t\tcin>>c;\n\t\ts[i]=index[c-'A'];\n\t}\n\tfor(int i=0;i<m;i++) {\n\t\tchar c;\n\t\tcin>>c;\n\t\tt[i]=index[c-'A'];\n\t}\n\t\n\twhile(d<=n+m) {\n\t\td<<=1;\n\t\tbit++;\n\t}\n\tfor(int i=0;i<d;i++) {\n\t\tr[i]=(r[i>>1]>>1)|((i&1)<<(bit-1));\n\t}\n\t\n\tfor(int j=1;j<=4;j++) {\n\t\tfill(f,f+d,0);\n\t\tfill(g,g+d,0);\n\t\tint p=0;\n\t\tfor(int i=0;i<n;i++) {\n\t\t\tif(s[i]==j) {\n\t\t\t\tp=k+1;\n\t\t\t}\n\t\t\tif(p) {\n\t\t\t\tf[i]=1;\n\t\t\t\tp--;\n\t\t\t}\n\t\t}\n\t\tfor(int i=n-1;i>=0;i--) {\n\t\t\tif(s[i]==j) {\n\t\t\t\tp=k+1;\n\t\t\t}\n\t\t\tif(p) {\n\t\t\t\tf[i]=1;\n\t\t\t\tp--;\n\t\t\t}\n\t\t}\n\t\tfor(int i=0;i<m;i++) {\n\t\t\tif(t[i]==j) {\n\t\t\t\tg[i]=1;\n\t\t\t}\n\t\t}\n\t\tFFT_KMP();\n\t}\n\t\n\tint tot=0;\n\tfor(int i=0;i<n;i++) {\n\t\ttot+=(ans[i]==0? 1:0);\n\t}\n\tcout<<tot<<endl;\n\t\n\treturn 0;\n}\n```",
        "postTime": 1617516815,
        "uid": 132976,
        "name": "huayucaiji",
        "ccfLevel": 6,
        "title": "CF528D Fuzzy Search"
    },
    {
        "content": "$FFT$\n\n\u9996\u5148\uff0c\u6211\u4eec\u9884\u5904\u7406\u51fa\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u4e0a\u662f\u5426\u53ef\u4ee5\u653e\u5b57\u7b26 $c$\uff0c\u8bb0\u4e3a $b_{j,c}$\u3002\u8fd9\u4e2a\u968f\u4fbf\u4e71\u641e\u90fd\u53ef\u4ee5\u5b9e\u73b0\uff0c\u8fd9\u91cc\u5c31\u4e0d\u8d58\u8ff0\u4e86\u3002\n\n\u6309\u7167\u8001\u5957\u8def\uff0c\u6211\u4eec\u8fd8\u662f\u628a $s$ \u770b\u6210\u4e00\u4e2a\u591a\u9879\u5f0f $\\sum_{i=0}^{n-1}s(i) \\times x^i$\uff0c\u628a $t$ \u4e5f\u770b\u6210\u4e00\u4e2a\u591a\u9879\u5f0f $\\sum_{i=0}^{m-1}t(i) \\times x^i$\u6211\u4eec\u5b9a\u4e49 $P(x)$ \u4e3a $s$ \u4e2d\u4ee5 $x$ \u7ed3\u5c3e\u7684\u957f\u5ea6\u4e3a $m$ \u7684\u5b57\u7b26\u4e32\u4e0e $t$ \u6210\u529f\u5339\u914d\u7684\u5b57\u7b26\u6570\u91cf\u3002\u5982\u679c $P(x)=m$ \u90a3\u4e48\u4ee3\u8868\u6210\u529f\u5339\u914d\u3002\u5199\u51fa $P(x)$ \u7684\u8868\u8fbe\u5f0f\uff1a$P(x)=\\sum_{t_i=A}b_{x-m+i+1,A}+\\sum_{t_i=C}b_{x-m+i+1,C}+\\sum_{t_i=G}b_{x-m+i+1,G}+\\sum_{t_i=T}b_{x-m+i+1,T}+$\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u56db\u9879\u5f62\u5f0f\u76f8\u540c\uff0c\u6c42\u7684\u65b9\u5f0f\u80af\u5b9a\u4e5f\u76f8\u540c\uff0c\u5c31\u4ee5\u7b2c\u4e00\u9879\u4e3a\u4f8b\u3002\u63a5\u4e0b\u6765\u4e00\u6b65\u662f\u5173\u952e\uff1a\u6211\u4eec\u5efa\u7acb\u4e00\u4e2a $d$ \u6570\u7ec4\uff0c\u5c06\u5b57\u7b26\u4e32 $t$ \u4e2d\u6240\u6709 $t_i=A$ \u7684\u5730\u65b9\u90fd\u8d4b\u4e0a $d_i=1$\uff0c\u5176\u5b83\u5730\u65b9\u8d4b\u4e0a $d_i=0$\uff0c\u90a3\u4e48\u539f\u6765\u90a3\u4e2a\u5f0f\u5b50\u7684\u7b2c\u4e00\u9879\u53c8\u53ef\u4ee5\u6539\u6210 $\\sum_{i=0}^{m-1}b_{x-m+i+1,A} \\times d_i$\u3002\u6211\u4eec\u5c06 $t$ \u5b57\u7b26\u4e32\u7ffb\u8f6c\u4e00\u4e0b\uff0c\u90a3\u4e48\u539f\u6765\u7684 $d_i$ \u5c31\u53d8\u4e3a\u4e86 $d_{m-1-i}$\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u53c8\u53d8\u4e3a\u4e86 $\\sum_{i=0}^{m-1}b_{x-m+i+1,A} \\times d_{m-1-i}$\uff0c\u7531\u4e8e $(m-1-i)+(x-m+i+1)=x$\uff0c\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u6539\u5199\u6210\u5377\u79ef\u7684\u5f62\u5f0f $\\sum_{i+j=x}b_{i,A} \\times d_j$\uff0c\u7528 $FFT$ \u6c42\u51fa\u6765\u5c31\u884c\u4e86\u3002\u53e6\u5916\u4e09\u9879\u4e5f\u540c\u7406\u3002\u6700\u540e\u5224\u65ad\u662f\u5426\u7b49\u4e8e $m$\u3002\n\n```cpp\n/*\n\u6570\u636e\u4e0d\u6e05\u7a7a\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u591a\u6d4b\u4e0d\u8bfb\u5b8c\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8fb9\u754c\u4e0d\u7279\u5224\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8d2a\u5fc3\u4e0d\u8bc1\u660e\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\nD P \u987a\u5e8f\u9519\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u5927\u5c0f\u5c11\u7b49\u53f7\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u53d8\u91cf\u4e0d\u7edf\u4e00\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8d8a\u754c\u4e0d\u5224\u65ad\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u8c03\u8bd5\u4e0d\u6ce8\u91ca\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n\u6ea2\u51fa\u4e0d l l\uff0c\u7206\u96f6\u4e24\u884c\u6cea\u3002\n*/\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi\t\t\tfirst\n#define se\t\t\tsecond\n#define fz(i,a,b)\tfor(int i=a;i<=b;i++)\n#define fd(i,a,b)\tfor(int i=a;i>=b;i--)\n#define foreach(it,v) for(__typeof(v.begin()) it=v.begin();it!=v.end();it++)\n#define put(x)\t\tputchar(x)\n#define eoln        put('\\n')\n#define space\t\tput(' ')\ninline int read(){\n\tint x=0,neg=1;char c=getchar();\n\twhile(!isdigit(c)){\n\t\tif(c=='-')\tneg=-1;\n\t\tc=getchar();\n\t}\n\twhile(isdigit(c))\tx=x*10+c-'0',c=getchar();\n\treturn x*neg;\n}\ninline void print(int x){\n\tif(x<0){\n\t\tputchar('-');\n\t\tprint(abs(x));\n\t\treturn;\n\t}\n\tif(x<=9)\tputchar(x+'0');\n\telse{\n\t\tprint(x/10);\n\t\tputchar(x%10+'0');\n\t}\n}\nconst double Pi=acos(-1.0);\nstruct comp{\n\tdouble x,y;\n\tcomp(){x=y=0;}\n\tcomp(double a,double b){x=a;y=b;}\n\tinline comp operator +(comp c){return comp(x+c.x,y+c.y);}\n\tinline comp operator -(comp c){return comp(x-c.x,y-c.y);}\n\tinline comp operator *(comp c){return comp(x*c.x-y*c.y,x*c.y+y*c.x);}\n} a[1<<20],b[1<<20],p[1<<20];\nint rev[1<<20];\ninline void FFT(int len,comp* a,int type){\n\tfor(int i=0;i<len;i++){\n\t\tif(i<rev[i])\tswap(a[i],a[rev[i]]);\n\t}\n\tfor(int mid=1;mid<len;mid<<=1){\n\t\tcomp W(cos(Pi/mid),type*sin(Pi/mid));\n\t\tfor(int j=0;j<len;j+=mid<<1){\n\t\t\tcomp w(1,0);\n\t\t\tfor(int k=0;k<mid;k++){\n\t\t\t\tcomp x=a[j+k],y=w*a[j+mid+k];\n\t\t\t\ta[j+k]=x+y;\n\t\t\t\ta[j+mid+k]=x-y;\n\t\t\t\tw=w*W;\n\t\t\t}\n\t\t}\n\t}\n}\nint N=1,n=read(),m=read(),k=read();\nchar s[200005],t[200005];\nint cnt[1<<20];\ninline void go(char c){\n\tint lst=-1e9;\n\tfor(int i=0;i<N;i++)\ta[i]=comp(0,0),b[i]=comp(0,0);\n\tfz(i,0,n-1){\n\t\tif(s[i]==c)\tlst=i;\n\t\tif((i-lst)<=k)\ta[i]=comp(1,0);\n\t}\n\tlst=1e9;\n\tfd(i,n-1,0){\n\t\tif(s[i]==c)\tlst=i;\n\t\tif((lst-i)<=k)\ta[i]=comp(1,0);\n\t}\n\tfz(i,0,m-1){\n\t\tif(t[i]==c){\n\t\t\tb[m-i-1]=comp(1,0);\n\t\t}\n\t}\n\tFFT(N,a,1);\n\tFFT(N,b,1);\n\tfor(int i=0;i<N;i++)\ta[i]=a[i]*b[i];\n\tFFT(N,a,-1);\n\tfor(int i=0;i<n;i++)\tcnt[i]+=int(a[i].x/N+0.5);\n}\nint main(){\n\tcin>>s>>t;\n\tint num=0;\n\twhile(N<=n+m)\tN<<=1,num++;\n\tfor(int i=0;i<N;i++)\trev[i]=(rev[i>>1]>>1)|((i&1)<<(num-1));\n\tint ans=0;\n\tgo('A');go('C');go('G');go('T');\n\tfz(i,0,n-1)\tif(cnt[i]==m)\tans++;\n\tprint(ans);\n\treturn 0;\n}\n```",
        "postTime": 1581152142,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF528D \u3010Fuzzy Search\u3011"
    },
    {
        "content": "\u56e0\u4e3aFFT\u53ef\u4ee5\u5904\u7406\u542b\u6709\u901a\u914d\u7b26\u7684\u5b57\u7b26\u4e32\u5339\u914d\u95ee\u9898\uff08[P4173](https://www.luogu.org/problemnew/show/P4173)\uff09\uff0c\u53ef\u4ee5\u8003\u8651\u7528FFT\u505a\u8fd9\u4e00\u9898\u3002\n\n\u56e0\u4e3a\u5b57\u6bcd\u4e2a\u6570\u53ea\u67094\uff0c\u8003\u8651\u6bcf\u4e2a\u5b57\u6bcd\u5206\u5f00\u505a\uff0c\u4ee4\u5f53\u4e14\u8003\u8651\u7684\u5b57\u6bcd\u4e3ach\u3002\u5982\u679c\u5bf9\u4e8e\u67d0\u4e2a\u4f4d\u7f6e\uff0c\u56db\u4e2a\u5b57\u6bcd\u90fd\u80fd\u5339\u914d\uff0c\u90a3\u7b54\u6848+1\u3002\n\n\u5b57\u7b26\u4e32T\u653e\u5728S\u7684\u67d0\u4e2a\u4f4d\u7f6e\u5339\u914d\u4e0d\u4e0a\u5f53\u4e14\u4ec5\u5f53\uff0c\u5b58\u5728\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u8fd9\u4e2a\u4f4d\u7f6e\u4e0aT\u4e3ach\uff0c\u800cS\u524d\u540ek\u4e2a\u90fd\u4e0d\u4e3ach\uff08\u8fd9\u4e2a\u600e\u4e48\u5224\u90fd\u884c\uff0c\u6211\u7528\u7684\u662f\u8bb0\u5f55\u524di\u4e2a\u6709\u591a\u5c11\u4e2ach\uff0c\u76f8\u5f53\u4e8e\u524d\u7f00\u548c\uff09\u3002\n\n\u90a3\u4e48\u6211\u4eec\u8bb0g\\[i]=\\[T\\[i]==ch]\uff0cf\\[i]=\\[S\\[i]\u524d\u540ek\u4e2a\u90fd\u4e0d\u4e3ach]\n\n\u62ff\u6837\u4f8b\u4e3e\u4e2a\u4f8b\u5b50\u3002\u5047\u8bbech='C'\uff0c\u5219\n```\nf = 1 0 0 0 1 1 0 0 0 1\ng = 0 1 0 0\n```\n\u628aT\u7684\u6700\u5de6\u8fb9\u653e\u5230S\u7684\u7b2cp\u4e2a\u662f\u53ef\u4ee5\u7684\uff0c\u5f53\u4e14\u4ec5\u5f53$\\sum\\limits_{i=0}^{m-1}f[i+p]g[i]=0$\uff0c\u4e5f\u5c31\u662f\u6ca1\u6709\u4e00\u4e2a\u4f4d\u7f6e\u6ee1\u8db3\u524d\u9762\u8bf4\u7684\u8fd9\u4e24\u4e2a\u6761\u4ef6\u3002\u7136\u540e\u628ag\u53cd\u8fc7\u6765\u5c31\u662f\u5377\u79ef\u7684\u5f62\u5f0f\u4e86\u3002\n\n\uff08\u8bf4\u4e2a\u5c0f\u6280\u5de7\uff0c\u628ag\u53cd\u8fc7\u6765\u540e\u53ef\u4ee5\u653e\u6700\u540e\uff0c\u5c31\u662f\u8bf4\u82e5FFT\u7684\u957f\u5ea6\u662fl\uff0c\u5219\u53cd\u8f6c\u524d\u7684\u7b2ci\u4e2a\u653e\u5230\u7b2cl-i-1\u4e2a\uff0c\u5f53\u4f5c\u7b2c-i\u9879\uff0c\u8fd9\u6837\u5377\u79ef\u540e\u5c31\u80fd\u65b9\u4fbf\u70b9\u77e5\u9053\u5377\u5230\u54ea\u4e86\uff09\n\n\uff08\u518d\u63d0\u4e00\u70b9\uff0c\u542b\u6709\u901a\u914d\u7b26\u7684\u5b57\u7b26\u4e32\u5339\u914d\u95ee\u9898\u5c31\u662f\u6784\u9020$(a-b)^2ab$\u7684\u5f62\u5f0f\uff0c\u628a\u901a\u914d\u7b26\u5f53\u4f5c0\uff0c\u5176\u4f59\u5b57\u7b26\u5f53\u4f5c\u5b83-'a'+1\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u5f0f\u5b50\u662f\u975e\u8d1f\u7684\uff0c\u53ef\u4ee5\u770b\u5377\u79ef\u540e\u662f\u4e0d\u662f0\uff09\n\n\u4ee3\u7801\u8fd8\u7b97\u6bd4\u8f83\u597d\u5199\uff1a\n``` cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int maxlogn=19;\nconst int maxn=(1<<maxlogn)|1;\nconst int kcz=998244353;\ntypedef long long ll;\nnamespace polynomial\n{\n    ll G[2][23+1];\n    int rev[maxn];\n    inline ll qpow(ll a,int k)\n    {\n        ll res=1;\n        while(k)\n        {\n            if(k&1) res=res*a%kcz;\n            k>>=1;\n            if(k) a=a*a%kcz;\n        }\n        return res;\n    }\n    #define inv(x) qpow(x,kcz-2)\n    void init()\n    {\n        int i;\n        G[1][23]=inv(G[0][23]=qpow(3,(kcz-1)>>23));\n        assert(G[0][23]*G[1][23]%kcz==1);\n        for(i=23-1;i>=0;i--)\n        {\n            G[0][i]=G[0][i+1]*G[0][i+1]%kcz;\n            G[1][i]=G[1][i+1]*G[1][i+1]%kcz;\n        }\n        assert(G[0][0]==1),assert(G[1][0]==1);\n        assert(G[0][1]==kcz-1),assert(G[1][1]==kcz-1);\n    }\n    inline void calcrev(int logn)\n    {\n        register int i;\n        rev[0]=0;\n        for(i=1;i<(1<<logn);i++)\n            rev[i]=(rev[i>>1]>>1)|((i&1)<<(logn-1));\n    }\n    inline void DFT(ll *a,int logn,int flag) // O(nlogn)\n    {\n        register int i,j,k,mid;\n        register ll t1,t2,t;\n        for(i=0;i<(1<<logn);i++)\n            if(rev[i]<i)\n                swap(a[rev[i]],a[i]);\n        for(i=1;i<=logn;i++)\n            for(mid=1<<(i-1),j=0;j<(1<<logn);j+=1<<i)\n                for(k=0,t=1;k<mid;k++,t=t*G[flag][i]%kcz)\n                {\n                    t1=a[j|k],t2=t*a[j|k|mid];\n                    a[j|k]=(t1+t2)%kcz,a[j|k|mid]=(t1-t2)%kcz;\n                }\n    }\n}\n\nusing polynomial::init;\nusing polynomial::calcrev;\nusing polynomial::DFT;\nusing polynomial::qpow;\nconst char *temp=\"ATGC\";\nll f[maxn],g[maxn];\nint n,m,k,pre[maxn],tot,logn;\nchar s[maxn],t[maxn];\nbool ans[maxn];\ninline void solve(char ch)\n{\n    int i;\n    for(pre[0]=0,i=1;i<=n;i++)\n        pre[i]=pre[i-1]+(s[i]==ch);\n    memset(f,0,sizeof(ll)<<logn);\n    memset(g,0,sizeof(ll)<<logn);\n    for(i=0;i<m;i++)\n        g[(1<<logn)-1-i]=t[i]==ch;\n    for(i=1;i<=n;i++)\n        f[i]=pre[min(i+k,n)]-pre[max(i-k-1,0)]==0;\n    DFT(f,logn,0),DFT(g,logn,0);\n    for(i=0;i<(1<<logn);i++) f[i]=f[i]*g[i]%kcz;\n    DFT(f,logn,1);\n    for(i=0;i<n-m+1;i++)\n        ans[i]&=!f[i]; //\u56e0\u4e3a\u53ea\u7528\u5224\u65ad\u662f\u4e0d\u662f0\uff0c\u672c\u6765\u8fd8\u8981\u96642^logn\u7684\uff0c\u5077\u61d2\u4e86\n}\nint main()\n{\n    int i;\n    init();\n    scanf(\"%d%d%d%s%s\",&n,&m,&k,s+1,t);\n    for(logn=0;(1<<logn)<=n+m;logn++);\n    calcrev(logn);\n    for(i=0;i<n-m+1;i++)\n        ans[i]=1;\n    for(i=0;temp[i];i++)\n        solve(temp[i]);\n    for(tot=0,i=0;i<n-m+1;i++)\n        tot+=ans[i];\n    printf(\"%d\\n\",tot);\n    return 0;\n}\n```",
        "postTime": 1549515898,
        "uid": 36998,
        "name": "ljc1301",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF528D \u3010Fuzzy Search\u3011"
    },
    {
        "content": "\u5bf9\u4e8e\u6bcf\u4e2a\u5b57\u7b26$c$,\u4ee4$a[i]=[S_i$\u80fd\u5339\u914d$c]$\uff0c$b[i]=[T_i == c]$  ,\n\u8d21\u732e$f[j]=\\sum_{i=0}^{m-1}a[j+i]*b[i]$\uff0c\u5f53\u603b\u8d21\u732e\u4e3a$m$\u65f6$j$\u4f4d\u7f6e\u4e3a\u5339\u914d\u4f4d\u7f6e\n\n\u4ee4$d[i]=b[m-i-1]$,\u5373$d[m-i-1]=b[i]$,\n\u5219$$f[j]=\\sum_{i=0}^{m-1}a[j+i]*d[m-i-1]=(a*d)(j+m-1)$$\n$FFT$\u8ba1\u7b97\u5377\u79ef\u5c31\u597d\n```cpp\nchar s[Maxn], t[Maxn];\nint q[Maxn], head, tail, tot[Maxn];\nvoid cal(char c){\n\tmemset(f, 0, sizeof(f)); memset(g, 0, sizeof(g));\n\thead=1, tail=0;\n\tfor(int i=0; i < n; i++){\n\t\tif(s[i] == c) q[++tail]=i;\n\t\twhile(head <= tail && q[head]+k < i) head++;\n\t\tif(head <= tail) f[i].a=1;\n\t}head=1, tail=0;\n\tfor(int i=n-1; i >= 0; i--) {\n\t\tif(s[i] == c) q[++tail]=i;\n\t\twhile(head <= tail && q[head] > i+k) head++;\n\t\tif(head <= tail) f[i].a=1;\n\t}\n\tfor(int i=0; i < m; i++) if(t[i] == c) g[m-i-1].a=1;\n\tFFT(f, 1); FFT(g, 1); for(int i=0; i < lim; i++) f[i]=f[i]*g[i]; FFT(f, -1);\n\tfor(int i=0; i < n; i++) tot[i]+=floor(f[i+m-1].a/lim+0.5);\n}\n\nvoid solve(){\n\tn=read(), m=read(), k=read(); scanf(\"%s\", s); scanf(\"%s\", t);\n\twhile(lim <= n+m-2) lim<<=1, l++;\n\tfor(int i=0; i < lim; i++) r[i]=r[i>>1]>>1|((i&1)<<l-1);\n\tcal('A'); cal('G'); cal('C'); cal('T'); int ans=0;\n\tfor(int i=0; i < n; i++) if(tot[i] >= m) ans++;\n\tprintf(\"%d\", ans);\n}\n```\n",
        "postTime": 1531554781,
        "uid": 32945,
        "name": "zerolt",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF528D \u3010Fuzzy Search\u3011"
    },
    {
        "content": "- $\\text{CF528D Fuzzy Search}$\n   - \u7b97\u6cd5\uff1a$\\text{FFT}$\n\n### \u9898\u76ee\uff1a\n\n\u6709\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u4e32 $S$\uff0c\u4ee5\u53ca\u957f\u5ea6\u4e3a $m$ \u7684\u4e32 $T$\u3002\n\n\u73b0\u7ed9\u5b9a\u4e00\u4e2a\u6570 $k$ \uff0c\u6211\u4eec\u8bf4 $T$ \u5728 $S$ \u7684\u4f4d\u7f6e $i$ \u5339\u914d\u4e0a\uff0c\u5f53\u4e14\u4ec5\u5f53\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $1\\le a\\le m$ \uff0c\u90fd\u6709\u4e00\u4e2a\u4f4d\u7f6e $1\\le b\\le n$ \u6ee1\u8db3 $|(i+a-1)-b|\\le k$ \uff0c\u4e14 $S_b=T_a$ \u3002\n  \n\u8bf7\u56de\u7b54 $T$ \u5728 $S$ \u4e2d\u5339\u914d\u4e0a\u4e86\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u4f4d\u7f6e\u3002\n  \n$n,m,k\\le2*10^5$\n\n### \u9898\u89e3\uff1a\n\n\u8bb0 $p_{i,ch}$ \u8868\u793a\u4f4d\u7f6e $i$ \u4e0a\u653e\u4e0a\u5b57\u7b26 $ch$ \u662f\u5426\u5408\u6cd5\u3002$p_{i,ch}=1$ \u5f53\u4e14\u4ec5\u5f53\u5b58\u5728 $s_j=ch$ \u4e14 $|i-j|\\leq k$\u3002\n\n\u6c42 $p_{i,ch}$ \uff0c\u5bf9\u4e8e $s_i=c$ \u5c06 $p_{i-k,ch},p_{i-k+1,ch},\\dots,p_{i+k-1,ch},p_{i+k,ch}$ \u8bbe\u4e3a $1$\uff0c\u5dee\u5206\u5c31\u884c\u4e86\u3002\n\n\u8bbe $f_i$ \u8868\u793a\u4ee5 $i$ \u5f00\u5934\u7684\u957f\u5ea6\u4e3a $|T|$ \u5b57\u7b26\u4e32\u80fd\u4e0e $T$ \u6210\u529f\u5339\u914d\u591a\u5c11\u4f4d\u3002\n\n$$f_i=\\sum\\limits_{j=1}^{|T|}p_{i+j-1,t_j}$$\n\n\u679a\u4e3e\u6bcf\u4e2a\u5b57\u7b26 $ch\\in\\{\\text{ACTG}\\}$\uff0c\u8bbe $flag_j$ \u8868\u793a $T_j$ \u662f\u5426\u7b49\u4e8e $ch$\u3002\u90a3\u4e48\u5b57\u7b26 $ch$ \u7ed9 $f_i$ \u5e26\u6765\u7684\u8d21\u732e\u5c31\u662f \n\n$$f_i=\\sum\\limits_{j=1}^{|T|}p_{i+j-1,ch}\\times flag_j$$\n\n\u90a3\u4e48\u539f\u5f0f\u5373\u4e3a\n\n$$ans=\\sum\\limits_{x-y=i}f_xflag_y$$\n\n\u5c06 $S$ \u7ffb\u8f6c\u4e00\u4e0b\uff0c\u5f97\n\n$$ans=\\sum\\limits_{x+y=i}f_xflag_y$$\n\n\u7528 $\\text{FFT}$ \u4e00\u5377\u5373\u53ef\u3002\n\n",
        "postTime": 1622962511,
        "uid": 327935,
        "name": "trsins",
        "ccfLevel": 0,
        "title": "\u3010\u505a\u9898\u8bb0\u5f55\u3011CF528D Fuzzy Search"
    },
    {
        "content": "[\u9898\u9762](https://www.luogu.com.cn/problem/CF528D)\n\n\u8003\u8651\u5230\u5b57\u7b26\u96c6\u5927\u5c0f\u5c0f\u4e8e\u7b49\u4e8e $4$ \uff0c\u5bf9\u6bcf\u4e00\u79cd\u5b57\u6bcd\u5355\u72ec\u8003\u8651\u3002\n\n\u6837\u4f8b\uff1a\n\n$ S = \\texttt{AGCAATTCAT}\\ \\ \\  T = \\texttt{ACAT}\\ \\ \\  k=1$\n\n\u4e0d\u59a8\u5148\u8003\u8651\u5b57\u6bcd $\\texttt{C}$ \uff0c\u5c06 $S$ \u548c $T$ \u4e2d\u4e3a $\\texttt{C}$ \u7684\u4f4d\u7f6e\u53d8\u4e3a $1$ \uff0c\u4e0d\u4e3a $\\texttt{C}$ \u7684\u4f4d\u7f6e\u53d8\u4e3a $0$ \u518d\u8fdb\u884c\u5339\u914d\u3002\n\n\u5219\uff1a\n\n$ S = \\texttt{0010000100}\\ \\  \\  T = \\texttt{0100}$\n\n\u56e0\u4e3a $k=1$ \uff0c$S$ \u548c $T$ \u5339\u914d\u53ef\u4ee5\u6709 $1$ \u7684\u8ddd\u79bb\u3002\u8fd9\u5c31\u610f\u5473\u7740\u6211\u4eec\u628a $S$ \u4e2d\u6bcf\u4e2a\u8ddd\u79bb $1$ \u5c0f\u4e8e $k$ \u7684\u4f4d\u7f6e\u53d8\u4e3a $1$ \u540e\u518d\u6b63\u5e38\u5339\u914d\u7684\u7b54\u6848\u548c\u539f\u7b54\u6848\u76f8\u7b49\u3002\n\n\u90a3\u4e48\u5c31\u6709\uff1a\n\n$ S = \\texttt{0111001110}\\ \\ \\  T = \\texttt{0100}$\n\n### **\u91cd\u70b9\uff1a**\n\n\u6709\uff1a\n\n\u5bf9\u4e8e $S$ \u4e2d\u7684\u6bcf\u4e2a\u4f4d\u7f6e $k$\uff0c\u8bbe $sum$ $=$ $T$ \u4e2d $1$ \u7684\u4e2a\u6570 \u82e5\u6ee1\u8db3\n\n$$\\sum\\limits^{m-1}_{i=0}S_{i+k}T_i = sum$$\n\n\u5219 $T$ \u80fd\u5728 $S$ \u7684 $k$ \u53f7\u4f4d\u7f6e\u4e0a\u5f97\u5230\u5339\u914d\u3002\uff08**\u6b64\u5904\u7684\u5339\u914d\u53ea\u6307\u5f53\u524d\u9009\u5b9a\u7684\u5b57\u6bcd\u90fd\u80fd\u5f97\u5230\u5339\u914d**\uff09\n\n\u8bc1\u660e\uff1a\n\n\u56e0\u4e3a $T$ \u4e2d\u53ea\u6709 $sum$ \u4e2a $1$\uff0c\u5176\u4ed6\u4f4d\u7f6e\u4e0a\u90fd\u662f $0$ \uff0c\u800c $0$ \u4e58\u4efb\u4f55\u5176\u4ed6\u6570\u90fd\u662f $0$ .\u6240\u4ee5\u5982\u679c\u4e0a\u5f0f\u6210\u7acb\uff0c\u90a3\u4e48\u6bcf\u4e00\u4e2a $T$ \u4e2d\u7684 $1$ \u90fd\u5bf9\u5e94\u4e86\u4e00\u4e2a $S$ \u4e2d\u7684 $1$ \u3002\u56e0\u6b64\u53ef\u4ee5\u5f97\u5230\u5339\u914d\u3002\n\n\u5bf9\u4e8e\u4e0a\u5f0f\uff0c\u770b\u4e0a\u53bb\u5c31\u5f88\u50cfFFT\u3002\u90a3\u4e48\u6784\u9020\u4e00\u4e2a\u5e8f\u5217 $A$ \u4f7f\u5f97 $A_{m-i-1}=T_i$\n\n\u90a3\u4e48\u4e0a\u5f0f\u5c31\u8f6c\u5316\u6210\uff1a\n\n$$\\sum\\limits^{m-1}_{i=0}S_{i+k}A_{m-i-1} = sum$$\n\n$$\\sum\\limits_{i+j=m+k-1}S_iA_j = sum$$\n\n\u7136\u540e FFT \u4e00\u4e0b\u53ef\u4ee5\u5f88\u5feb\u7684\u5904\u7406\u51fa\u4e0a\u5f0f\u3002\n\n\u56e0\u4e3a\u6709\u56db\u4e2a\u5b57\u6bcd\u6240\u4ee5\u8981\u5bf9\u6bcf\u4e2a\u5b57\u6bcd\u8dd1\u4e00\u8fb9\uff0c\u7136\u540e\u53d6\u4ea4\u96c6\u3002\n\n\u5b9e\u73b0\u8d77\u6765\u4e5f\u4e0d\u662f\u5f88\u590d\u6742\uff0c\u4e5f\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u662f\u9ed1\u9898\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\ninline int read(){\n\tchar c=getchar();int x=0,f=1;\n    while(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n    while(c>='0'&&c<='9'){x=x*10+c-'0';c=getchar();}\n    return x*f;\n}\nconst int maxn=400010;\nint i,j,k,n,m;\nstring s,t;\nint a[maxn*2],b[maxn*2];\nchar C[4]={'A','C','T','G'};\n\nconst double Pi=acos(-1.0);\nstruct Complex{\n\tdouble x,y;\n};\nComplex operator+(Complex a,Complex b){return (Complex){a.x+b.x,a.y+b.y};}\nComplex operator-(Complex a,Complex b){return (Complex){a.x-b.x,a.y-b.y};}\nComplex operator*(Complex a,Complex b){return (Complex){a.x*b.x-a.y*b.y,a.x*b.y+a.y*b.x};}\nComplex Get_w(int k,int len,bool op){\n\tint T=1;if(!op)T=-1;\n\treturn (Complex){cos(2*k*Pi/len),T*sin(2*k*Pi/len)};\n}\n\nComplex A[maxn*2],B[maxn*2],tmp[maxn*2];\nint R[maxn*2],Ans[maxn*2];\nvoid FFT(int len,Complex *a,bool op){\n\tfor(int i=0;i<len;i++)\n\t\tif(i<R[i])swap(a[i],a[R[i]]);\n\tfor(int i=1;i<len;i<<=1)\n\t\tfor(int j=0;j<len;j+=i*2){\n\t\t\tComplex w=(Complex){1,0},Wn=Get_w(1,2*i,op);\n\t\t\tfor(int k=0;k<i;k++,w=w*Wn){\n\t\t\t\tint K=k+j;\n\t\t\t\tComplex S1=a[K],S2=w*a[K+i];\n\t\t\t\ta[K]=S1+S2;\n\t\t\t\ta[K+i]=S1-S2;\n\t\t\t}\n\t\t}\n}\n\nint main(){\n\tcin>>n>>m>>k; \n\tcin>>s>>t;\n\t\n\tint len=1,L=0;\n\twhile(len<=n+m)len<<=1,++L;\n\tfor(j=0;j<=len;j++)\n\t\tR[j]=R[j/2]/2+(j%2)*(1<<L-1);\n\t\n\tfor(i=0;i<4;i++){\n\t\tint last=-1e9,ans=0;\n\t\tfor(j=0;j<n;j++)\n\t\t\tif(s[j]==C[i])a[j]=2;\n\t\t\telse a[j]=0;\n\t\tfor(j=0;j<m;j++){\n\t\t\tif(t[j]==C[i])b[j]=1;\n\t\t\telse b[j]=0;\n\t\t\tans+=b[j];\n\t\t}\n\t\tfor(j=0;j<n;j++){\n\t\t\tif(a[j]==2)last=j;\n\t\t\tif(last+k>=j)a[j]=max(a[j],1);\n\t\t}last=1e9;\n\t\tfor(j=n-1;j>=0;j--){\n\t\t\tif(a[j]==2)last=j;\n\t\t\tif(last-k<=j)a[j]=max(a[j],1);\n\t\t}\n\t\tfor(j=0;j<n;j++)if(a[j])a[j]=1;\n\t\t\n\t\tfor(j=0;j<len;j++)A[j]=(Complex){a[j],0};\n\t\tfor(j=0;j<len;j++)B[j]=(Complex){b[j],0};\n\t\tfor(j=0;j<m;j++)tmp[m-j-1]=B[j];\n\t\tfor(j=0;j<m;j++)B[j]=tmp[j];\n\t\t\n\t\tFFT(len,A,1);FFT(len,B,1);\n\t\tfor(j=0;j<=len;j++)A[j]=A[j]*B[j];\n\t\tFFT(len,A,0);\n\t\tfor(j=0;j<=len;j++)A[j].x=(int)(A[j].x/len+0.5);\n\t\tfor(j=0;j<=n-m;j++)\n\t\t\tif(((int)(A[m+j-1].x))==ans)\n\t\t\t\tAns[j]++;\n\t}\n\tint ANS=0;\n\tfor(j=0;j<=n-m;j++)\n\t\tif(Ans[j]==4)++ANS;\n\tcout<<ANS<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1582384691,
        "uid": 35891,
        "name": "huangzirui",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF528D \u3010Fuzzy Search\u3011"
    },
    {
        "content": "\u662f\u4e00\u9053\u6cd5\u6cd5\u5854\u5339\u914d\u5b57\u7b26\u4e32\u7684\u7ecf\u5178\u5957\u8def\u9898\n\n\u6211\u4eec\u9996\u5148\u77e5\u9053\u6211\u4eec\u53ef\u4ee5\u628a\u4e24\u4e2a\u5b57\u7b26\u4e32\u5148$01$\u5316\u3002\u5c06$b$\u4e32\u7ffb\u8f6c\u7136\u540e\u8ddf$a$\u4e32\u505a\u5377\u79ef\u5c31\u80fd\u5f04\u51fa\u4e00\u4e2a\u4f4d\u7f6e\u7684\u5339\u914d\u6570\n\n\u53ef\u662f\u8fd9\u9898\u8fd8\u6709\u4e00\u4e2a$k$\uff0c\u548b\u641e\u5462\uff1f\n\n\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff0c\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a$a[i]=1$\uff0c\u6211\u4eec\u53ef\u4ee5\u4ee4$a[i-k$\u5230$i+k]=1$\uff0c\u663e\u7136\u8fd9\u6837\u4e0e$b$\u5377\u79ef\u5c31\u89e3\u51b3\u4e86$k$\u7684\u9650\u5b9a\u3002\n\n\u7136\u540e\u7528\u4e00\u4e2a$lf[i]$\u8868\u793a\u524d\u9762\u4e00\u4e2a$1$\u7684\u4f4d\u7f6e\u79bb\u5f53\u524d\u4f4d\u7f6e$i$\u7684\u8ddd\u79bb\uff0c$rf[i]$\u8868\u793a\u540e\u9762\u4e00\u4e2a$1$\u7684\u4f4d\u7f6e\u79bb\u5f53\u524d\u4f4d\u7f6e$i$\u7684\u8ddd\u79bb\uff0c\u7136\u540e$O(n)$\u9884\u5904\u7406\u4e00\u4e0b\u5c31\u884c\u4e86\u3002\n\n\u603b\u590d\u6742\u5ea6$O(4nlogn)$\n\n```cpp\n#include<bits/stdc++.h>\n#define N 600005\n#define fo(i, a, b) for (R int i = (a); i <= (b); ++i)\n#define fd(i, a, b) for (R int i = (a); i >= (b); --i)\n#define in inline\n#define R register\nconst double pi = acos(-1);\nint a[N], b[N], len, n, m;\nstruct complex{\n    double real, imag;\n    in void conj ()\n    {\n        imag = -imag;\n    }\n    friend in complex operator * (const complex &x, const complex &y)\n    {\n        return (complex) {x.real * y.real - x.imag * y.imag, x.real * y.imag + x.imag * y.real};\n    }\n    friend in complex operator + (const complex &x, const complex &y)\n    {\n        return (complex) {x.real + y.real, x.imag + y.imag};\n    }\n    friend in complex operator - (const complex &x, const complex &y)\n    {\n        return (complex) {x.real - y.real, x.imag - y.imag};\n    }\n}c1[N], c2[N], omega[N], c3[N];\nin void dft(complex *c, int len)\n{\n    int k = 0;\n    while ((1 << k) < len) ++k;\n    --k;\n    fo (i, 0, len)\n    {\n        int g = 0;\n        fo (j, 0, k)\n            if ((1 << j) & i) g |= (1 << k - j);\n        if (i < g) std::swap(c[i], c[g]);\n    }\n    for (int l = 2; l <= len; l <<= 1)\n    {\n        int mid = l >> 1;\n        for (complex *p = c; p != c + len; p += l)\n            for (int i = 0; i < mid; ++i)\n            {\n                complex tmp = omega[len / l * i] * p[mid + i];\n                p[mid + i] = p[i] - tmp;\n                p[i] = p[i] + tmp;\n            }\n    }\n}\nint mp[5], k, lf[N], rf[N];\nchar s1[N], s2[N];\nint main()\n{\n    scanf(\"%d %d %d\", &n, &m, &k);\n    mp[1] = 'A';\n    mp[2] = 'C';\n    mp[3] = 'G';\n    mp[4] = 'T';\n    scanf(\"%s\", s1);\n    scanf(\"%s\", s2);\n    int ans = 0;\n    memset(c3, 0, sizeof c3);\n    fo (l, 1, 4)\n    {\n        for (int i = 0; i < n; ++i) a[i] = (mp[l] == s1[i]);\n        for (int i = 0; i < m; ++i) b[i] = (mp[l] == s2[i]);\n        std::reverse(b, b + m);\n        \n        memset(lf, 0, sizeof lf); memset(rf, 0, sizeof rf);\n        int sta = 0;\n        while (sta < n && !a[sta]) lf[sta++] = 23333333;\n        lf[sta] = 0;\n        fo (i, sta + 1, n - 1)\n            lf[i] = (a[i]) ? 0 : lf[i - 1] + 1;\n        sta = n - 1;\n        while (sta >= 0 && !a[sta]) rf[sta--] = 23333333;\n        rf[sta] = 0;\n        fd (i, sta - 1, 0)\n            rf[i] = (a[i]) ? 0 : rf[i + 1] + 1;\n        fo (i, 0, n - 1)\n            if (std::min(lf[i], rf[i]) <= k) a[i] = 1;\n        \n        int len = 1;\n        while (len <= n + m) len = len << 1;\n        fo (i, 0, len) c1[i].real = c2[i].real = c1[i].imag = c2[i].imag = 0;\n        for (int i = 0; i < n; ++i) c1[i].real = a[i];\n        for (int i = 0; i < m; ++i) c2[i].real = b[i];\n        fo (i, 0, len)\n            omega[i] = (complex) {cos(2 * pi * i / len), sin(2 * pi * i / len)};\n        dft(c1, len);\n        dft(c2, len);\n        fo (i, 0, len)\n            c1[i] = c1[i] * c2[i];\n        fo (i, 0, len)\n            omega[i].conj();\n        dft(c1, len);\n        fo (i, 0, len)\n            c3[i].real += c1[i].real / len;\n    }\n    fo (i, 0, n + m) a[i] = (int) (c3[i].real + 0.5);\n    fo (i, m - 1, n - 1) if (a[i] == m) ++ans;\n    printf(\"%d\\n\", ans);\n    \n}\n```",
        "postTime": 1551275828,
        "uid": 13137,
        "name": "HomuraCat",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF528D \u3010Fuzzy Search\u3011"
    },
    {
        "content": "\u53ef\u4ee5\u7528\u7c7b\u4f3c\u6ed1\u52a8\u7a97\u53e3\u7684\u65b9\u5f0f\u8ba1\u7b97\u51fa\u67d0\u4e2a\u4f4d\u7f6e\u662f\u5426\u80fd\u5339\u914d\u4e00\u4e2a\u5b57\u6bcd\u3002\n\n\u518d\u5c31\u662f\u5e38\u89c1\u5957\u8def\u628a\u6a21\u5f0f\u4e32\u7ffb\u8f6c\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u5b57\u6bcd\u505afft\uff0c\u8ba1\u7b97\u8d21\u732e\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cmath>\n#include<cstring>\n#include<complex>\nusing namespace std;\ninline int read(){int x=0,f=1,ch=getchar(); while(ch<'0'||ch>'9'){if(ch=='-') f=-1; ch=getchar();} while(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();} return x*f;}\ninline void write(int x){if (x<0) putchar('-'),x=-x; if (x>=10) write(x/10); putchar(x%10+'0');}\ninline void writeln(int x){write(x); puts(\"\");}\ntypedef complex<double> E;\nconst double pi=acos(-1.0);\nconst int N=530005;\nint ans,ton[N],n,m,k,lim,L,rev[N];\nchar s[N],t[N];\nE a[N],b[N];\ninline void init(){\n\tn=read(); m=read(); k=read();\n\tscanf(\"%s\",s); scanf(\"%s\",t);\n}\ninline void FFT(E *A,int opt){\n\tfor (int i=0;i<lim;i++) if (i>rev[i]) swap(A[i],A[rev[i]]);\n\tfor (int s=1;s<lim;s<<=1){\n\t\tE Wn(cos(pi/s),opt*sin(pi/s));\n\t\tfor (int i=0;i<lim;i+=(s<<1)){\n\t\t\tE w(1,0);\n\t\t\tfor (int j=0;j<s;j++,w=w*Wn){\n\t\t\t\tE x=A[i+j],y=w*A[i+j+s];\n\t\t\t\tA[i+j]=x+y; A[i+j+s]=x-y;\n\t\t\t}\n\t\t}\n\t}\n\tif (opt==-1) for (int i=0;i<lim;i++) A[i]/=lim;\n}\ninline void calc(char c){\n\tmemset(a,0,sizeof a); memset(b,0,sizeof b);\n\tint cnt=0;\n\tfor (int i=0;i<k;i++) cnt+=s[i]==c;\n\tfor (int i=0;i<n;i++){\n\t\tif (i+k<n) cnt+=s[i+k]==c;\n\t\tif (i-k-1>=0) cnt-=s[i-k-1]==c;\n\t\ta[i]=cnt>0?1:0;\n\t} \n\tfor (int i=0;i<m;i++) b[i]=t[i]==c?1:0;\n\tFFT(a,1); FFT(b,1);\n\tfor (int i=0;i<lim;i++) a[i]*=b[i];\n\tFFT(a,-1);\n\tfor (int i=0;i<=n-m;i++) ton[i]+=(int)(a[i+m-1].real()+0.5);\n}\ninline void solve(){\n\tfor (lim=1;lim<=n+m-2;lim<<=1,L++);\n\tfor (int i=0;i<lim;i++) rev[i]=(rev[i>>1]>>1)|((i&1)<<(L-1));\n\treverse(t,t+m);\n\tcalc('A'); calc('G'); calc('C'); calc('T');\n\tfor (int i=0;i<=n-m;i++) if (ton[i]==m) ans++;\n\twriteln(ans);\n}\nint main(){\n\tinit(); solve();\n\treturn 0;\n}\n```",
        "postTime": 1545356102,
        "uid": 34444,
        "name": "\u5927\u83dc\u9e21fks",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF528D \u3010Fuzzy Search\u3011"
    },
    {
        "content": "Shift-And \u5b57\u7b26\u4e32\u5339\u914d\u3002\n\n\u9884\u5904\u7406\u51fa\u6bcf\u79cd\u5b57\u7b26\u53ef\u4ee5\u5339\u914d\u54ea\u4e9b\u4f4d\u7f6e\uff0c\u5373\u9884\u5904\u7406 $p_{i,j}$ \u8868\u793a\u662f\u5426\u5b58\u5728 $S_x=i$ \u4e14 $|j-x|\\le k$\u3002\n\n$S_x=i$ \u4f7f\u5f97 $p_{i,j}=1|j\\in[\\max(x-k,0),\\min(x+k,n-1)]$\uff0c\u5dee\u5206\u7ef4\u62a4\u5373\u53ef\u3002\n\n\u4f9d\u6b21\u5339\u914d $T$ \u7684\u6bcf\u4e00\u4f4d\uff0c\u7ef4\u62a4 $v_i$ \u8868\u793a $T$ \u7684\u5f53\u524d\u8fd9\u4e00\u4f4d\u662f\u5426\u53ef\u80fd\u5339\u914d $S$ \u7684\u7b2c $i$ \u4f4d\u3002\n\n\u8003\u8651\u8f6c\u79fb\uff0c\u5339\u914d $T$ \u7684\u7b2c $x$ \u4f4d\u65f6 $v_i\\gets v_{i-1}$\uff0c\u7136\u540e $v_i\\gets v_i\\operatorname{and}p_{T_x,i}$ \u5373\u53ef\u3002\n\n\u9700\u8981\u7ef4\u62a4 $v$ \u7684 Shift \u548c And\uff0c\u4e0a `bitset` \u5373\u53ef\u3002\n\n```cpp\n#include <bitset>\n#include <cstdio>\n#include <iostream>\nusing namespace std;\nint n, m, k, t[250], o[4][200050];char a[200050], b[200050];\nbitset<200000> v, p[4];\nint main()\n{\n\tt['A'] = 0;t['G'] = 1;t['C'] = 2;t['T'] = 3;\n\tscanf(\"%d%d%d%s%s\", &n, &m, &k, a, b);for(int i = 0;i < n;++i)\n\t\tv.set(), ++o[t[a[i]]][max(i - k, 0)], --o[t[a[i]]][min(i + k + 1, n)];\n\tfor(int i = 0;i < 4;++i) for(int j = 0;j < n;++j)\t\n\t\tp[i][j] = o[i][j] += o[i][j - 1];\n\tv = p[t[b[0]]];for(int i = 1;i < m;++i) v = v << 1 & p[t[b[i]]];\n\tprintf(\"%d\", v.count());\n\treturn 0;\n}\n```\n",
        "postTime": 1684834042,
        "uid": 388651,
        "name": "5k_sync_closer",
        "ccfLevel": 7,
        "title": "CF528D Fuzzy Search \u9898\u89e3"
    },
    {
        "content": "$\\textbf{FFT}$.  \n\u5e38\u7528\u5957\u8def\uff0c\u8003\u8651\u5230\u8be5\u9898\u53ea\u6709 `ATGC` \u56db\u79cd\u5b57\u7b26\uff0c\u53ef\u4ee5\u5206\u522b\u8003\u8651\uff0c\u5047\u8bbe\u5f53\u524d\u5728\u8003\u8651 `A`\uff0c\u5219\u53ef\u4ee5\u4ee4 $f_i=[S_i=$ `A` $]$\uff0c$g_i=[T_i=$ `A` $]$\uff0c\u7136\u540e\u505a\u5377\u79ef\uff0c\u4ee4 $h=f* f+g* g$\uff0c\u5bf9\u4e8e\u5176\u4ed6\u4e09\u4e2a\u5b57\u7b26\u4e5f\u8fd9\u6837\u5904\u7406\uff0c\u6700\u540e\u5c31\u53ef\u4ee5\u7edf\u8ba1\u7b54\u6848\u3002\u663e\u7136\u8fd9\u662f\u9488\u5bf9 $k=0$ \u7684\u60c5\u51b5\u7684\uff0c\u8003\u8651 $k\\neq0$ \u65f6\u600e\u4e48\u5904\u7406\uff0c$g$ \u4e0d\u7528\u4fee\u6539\uff0c\u4ee4 $f_i=[\\exists\\ S_j=$ `A` $,|i-j|\\leq k]$\uff0c\u4e5f\u5c31\u662f\u79bb\u5f53\u524d\u4f4d\u7f6e\u6700\u8fd1\u7684 `A` \u7684\u8ddd\u79bb\u4e0d\u8d85\u8fc7 $k$ \u5373\u4e3a\u5408\u6cd5\uff0c\u7136\u540e\u518d\u505a\u5377\u79ef\uff0c\u6700\u540e\u5c31\u53ef\u4ee5\u7edf\u8ba1\u4e86\u3002\n```cpp\n#include<bits/stdc++.h>\n#define MAXN 1000005\n#define reg register\n#define inl inline\n#define db double\nusing namespace std;\nconst db Pi=acos(-1.0);\nint n,m,K,lim=1,maxn,rev[MAXN],h[MAXN],s[MAXN],pos[MAXN],ans;\nchar S[MAXN],T[MAXN];\nstruct Complex\n{\n\tdb x,y;\n\tfriend Complex operator + (const Complex &a,const Complex &b)\n\t{\n\t\treturn ((Complex){a.x+b.x,a.y+b.y});\n\t}\n\tfriend Complex operator - (const Complex &a,const Complex &b)\n\t{\n\t\treturn ((Complex){a.x-b.x,a.y-b.y});\n\t}\n\tfriend Complex operator * (const Complex &a,const Complex &b)\n\t{\n\t\treturn ((Complex){a.x*b.x-a.y*b.y,a.x*b.y+a.y*b.x});\n\t}\n}f[MAXN],g[MAXN];\ninl void Init(reg Complex *A)\n{\n\tfor(reg int i=0;i<lim;i++) A[i].x=A[i].y=0;\n}\ninl void FFT(reg Complex *A,reg int opt)\n{\n\tfor(reg int i=0;i<lim;i++) if(i<rev[i]) swap(A[i],A[rev[i]]);\n\tfor(reg int mid=1;mid<lim;mid<<=1)\n\t{\n\t\treg Complex Wn=((Complex){cos(Pi/(db)mid),(db)opt*sin(Pi/(db)mid)});\n\t\tfor(reg int j=0;j<lim;j+=(mid<<1))\n\t\t{\n\t\t\treg Complex W=((Complex){1,0});\n\t\t\tfor(reg int k=0;k<mid;k++,W=W*Wn)\n\t\t\t{\n\t\t\t\treg Complex x=A[j+k],y=W*A[j+k+mid];\n\t\t\t\tA[j+k]=x+y;\n\t\t\t\tA[j+k+mid]=x-y;\n\t\t\t}\n\t\t}\n\t}\n\tif(opt==1) return;\n\tfor(reg int i=0;i<lim;i++) A[i].x=(int)(A[i].x/(db)lim+0.5);\n}\ninl void Modify(reg char ch)\n{\n\tInit(f);\n\tInit(g);\n\treg int pre=-1e9;\n\tfor(reg int i=0;i<n;i++)\n\t{\n\t\tif(S[i]==ch) pre=i;\n\t\tif(i-pre<=K) f[i].x=1.0;\n\t}\n\tpre=1e9;\n\tfor(reg int i=n-1;i>=0;i--)\n\t{\n\t\tif(S[i]==ch) pre=i;\n\t\tif(pre-i<=K) f[i].x=1.0;\n\t}\n\tfor(reg int i=0;i<m;i++) if(T[m-i-1]==ch) g[i].x=1.0;\n\tFFT(f,1); FFT(g,1);\n\tfor(reg int i=0;i<lim;i++) f[i]=f[i]*g[i];\n\tFFT(f,-1);\n\tfor(reg int i=0;i<lim;i++) h[i]+=(int)f[i].x;\n}\nint main()\n{\n\tscanf(\"%d %d %d\",&n,&m,&K);\n\tscanf(\"%s\",S);\n\tscanf(\"%s\",T);\n\twhile(lim<=(n<<1))\n\t{\n\t\tlim<<=1;\n\t\tmaxn++;\n\t}\n\tfor(reg int i=0;i<=lim;i++) rev[i]=((rev[i>>1]>>1)|((i&1)<<(maxn-1)));\n\tModify('A');\n\tModify('G');\n\tModify('T');\n\tModify('C');\n\tfor(reg int i=0;i<lim;i++) if(h[i]==m) ans++;\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1575528193,
        "uid": 23243,
        "name": "VenusM1nT",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF528D \u3010Fuzzy Search\u3011"
    },
    {
        "content": "\u5206\u522b\u4ec5\u8003\u8651 $A,C,G,T$\uff0c\u628a\u5339\u914d\u6210\u529f\u7684\u4f4d\u7f6e\u53d6\u4e2a\u4ea4\u96c6\u5c31\u53ef\u4ee5\u3002\n\n\u4f7f\u7528 FFT \u6765\u5b8c\u6210\u5b57\u7b26\u4e32\u5339\u914d\u3002\n\n\u73b0\u5728\u4ec5\u8003\u8651 $A$\uff0c\u628a $S$ \u4e2d\u4e0d\u4f1a\u548c $A$ \u5339\u914d\u4e0a\u7684\u4f4d\u7f6e\u4e0a\u7684\u5b57\u7b26\u8bbe\u4e3a $o$\uff0c\u628a $T$ \u4e2d\u4e0d\u662f $A$ \u7684\u5b57\u7b26\u8bbe\u4e3a $\\#$\uff0c\u5219\u5339\u914d\u51fd\u6570 $C(x,y)$ \uff08\u5176\u4e2d $x$ \u6765\u81ea $S$\uff0c$y$ \u6765\u81ea $T$\uff09\u8981\u6ee1\u8db3\uff1a\n\n- $=0,x=A,y=A$\uff1b\n- $=0,x=A,y=\\#$\uff1b\n- $>0,x=o,y=A$\uff1b\n- $=0,x=o,y=\\#$\uff0e\n\n\u8fd9\u6837\u7684 $C$ \u624d\u80fd\u6ee1\u8db3\u5339\u914d\u6210\u529f\u503c\u4e3a $0$\uff0c\u5426\u5219\u5927\u4e8e $0$\uff0e\n\n\u8bbe\uff1a\n\n- $S$ \u4e2d\u7684 $A$ \u503c\u4e3a $0$\uff0c$o$ \u503c\u4e3a $1$\uff1b\n\n- $T$ \u4e2d\u7684 $A$ \u503c\u4e3a $1$\uff0c$\\#$ \u503c\u4e3a $0$\uff1b\n\n- $C(x,y)=xy$\uff0e\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u5b57\u7b26\u53ea\u9700\u8981\u4e00\u6b21 FFT \u5c31\u53ef\u4ee5\u4e86\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<cstring>\n#include<algorithm>\ntypedef long long ll;\ntypedef double ld;\ninline int Max(int x, int y) { return x > y ? x : y; }\ninline int Min(int x, int y) { return x < y ? x : y; }\nconst int N = 800010;\nconst ld pi = acos(-1.0);\nstruct cpx {\n\tld x, y;\n\tcpx(ld xx = 0, ld yy = 0) { x = xx; y = yy; }\n};\ncpx operator + (cpx a, cpx b) { return cpx(a.x + b.x, a.y + b.y); }\ncpx operator - (cpx a, cpx b) { return cpx(a.x - b.x, a.y - b.y); }\ncpx operator * (cpx a, cpx b) { return cpx(a.x * b.x - a.y * b.y, a.x * b.y + a.y * b.x); }\ncpx *getw(int n, int type) {\n\tstatic cpx w[N/2];\n\tw[0] = cpx(1, 0); w[1] = cpx(cos(2 * pi / n), sin(2 * pi / n) * type);\n\tfor(int i = 2; i < n/2; ++i) w[i] = w[i-1] * w[1];\n\treturn w;\n}\nint p[N];\nvoid FFT(cpx *a, int n, int type) {\n\tfor(int i = 0; i < n; ++i) if(i < p[i]) std::swap(a[i], a[p[i]]);\n\tfor(int i = 1; i < n; i <<= 1) {\n\t\tcpx *w = getw(i << 1, type);\n\t\tfor(int j = 0; j < n; j += i << 1) {\n\t\t\tcpx *b = a + j, *c = b + i;\n\t\t\tfor(int k = 0; k < i; ++k) {\n\t\t\t\tcpx v = w[k] * c[k];\n\t\t\t\tc[k] = b[k] - v;\n\t\t\t\tb[k] = b[k] + v;\n\t\t\t}\n\t\t}\n\t}\n\tif(type == -1) for(int i = 0; i < n; ++i) a[i].x /= n;\n}\nvoid mul(int *a, int *b, int *c, int n, int m) {\n\tstatic cpx f[N], g[N];\n\tint len = 1, ct = 0;\n\twhile(len <= n + m) len <<= 1, ++ct;\n\tfor(int i = 0; i < len; ++i) p[i] = (p[i>>1]>>1) | ((i&1) << (ct-1));\n\tfor(int i = 0; i < len; ++i) f[i] = g[i] = cpx(0, 0);\n\tfor(int i = 0; i < n; ++i) f[i] = cpx(a[i], 0);\n\tfor(int i = 0; i < m; ++i) g[i] = cpx(b[i], 0);\n\tFFT(f, len, 1);\n\tFFT(g, len, 1);\n\tfor(int i = 0; i < len; ++i) f[i] = f[i] * g[i];\n\tFFT(f, len, -1);\n\tfor(int i = 0; i < len; ++i) c[i] = (int)(f[i].x+0.5);\n}\nint n, m, k;\nint id[300], c[4][N], A[4][N];\nchar s[N], t[N];\nint f[N], g[N];\nsigned main() {\n\tscanf(\"%d%d%d\", &n, &m, &k);\n\tid['A'] = 0, id['G'] = 1, id['C'] = 2, id['T'] = 3;\n\tscanf(\"%s\", s); scanf(\"%s\", t);\n\tfor(int i = 0; i < n; ++i) {\n\t\ts[i] = id[(int)s[i]]; t[i] = id[(int)t[i]];\n\t\t++c[(int)s[i]][Max(i-k, 0)];\n\t\t--c[(int)s[i]][Min(i+k+1, n)];\n\t}\n\tfor(int i = 1; i < n; ++i) for(int j = 0; j < 4; ++j) c[j][i] += c[j][i-1];\n\tfor(int o = 0; o < 4; ++o) {\n\t\tfor(int i = 0; i < n; ++i)\n\t\t\tf[i] = c[o][i] ? 0 : 1;\n\t\tfor(int i = 0; i < m; ++i)\n\t\t\tg[i] = t[i] == o ? 1 : 0;\n\t\tstd::reverse(g, g + m);\n\t\tmul(f, g, A[o], n, m);\n\t}\n\tint ans = 0;\n\tfor(int i = m-1; i < n; ++i)\n\t\tif(!A[0][i] && !A[1][i] && !A[2][i] && !A[3][i])\n\t\t\t++ans;\n\tprintf(\"%d\\n\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1632396914,
        "uid": 223298,
        "name": "do_while_true",
        "ccfLevel": 8,
        "title": "\u300c\u9898\u89e3\u300dCodeforces 528D Fuzzy Search"
    },
    {
        "content": "# Problem\n\n## Description\n\n\u4f60\u6709\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u4e32 $S$\uff0c\u4ee5\u53ca\u957f\u5ea6\u4e3a $m$ \u7684\u4e32 $T$\u3002\n\n\u73b0\u7ed9\u5b9a\u4e00\u4e2a\u6570 $k$ \uff0c\u6211\u4eec\u8bf4 $T$ \u5728 $S$ \u7684\u4f4d\u7f6e $i$ \u5339\u914d\u4e0a\uff0c\u5f53\u4e14\u4ec5\u5f53\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $1\\le a\\le m$ \uff0c\u90fd\u6709\u4e00\u4e2a\u4f4d\u7f6e $1\\le b\\le n$ \u6ee1\u8db3 $|(i+a-1)-b|\\le k$ \uff0c\u4e14 $S_b=T_a$ \u3002\n\n\u8bf7\u56de\u7b54 $T$ \u5728 $S$ \u4e2d\u5339\u914d\u4e0a\u4e86\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u4f4d\u7f6e\u3002\n\n## Range\n\n$n,m,k\\le2*10^5$\n\n# Algorithm\n\n$FFT$\n\n# Mentality\n\n\u601d\u8def\u5f88\u5999\u7684\u8bf4\u3002\n\n\u5148\u8003\u8651 $k=0$ \u7684\u60c5\u51b5\u3002\u4e0d\u96be\u53d1\u73b0\uff0c\u5f53 $T$ \u4e0e $S$ \u5339\u914d\u4e0a\u65f6\uff0c$T$ \u4e2d\u7684\u6bcf\u4e2a\u5b57\u7b26\u4e0e $S$ \u4e2d\u5bf9\u5e94\u5339\u914d\u5b57\u7b26\u7684 **\u4f4d\u7f6e\u7684\u5dee** \u662f\u76f8\u7b49\u7684\u3002\n\n\u540c\u65f6\u8003\u8651\u5728\u591a\u9879\u5f0f\u4e58\u6cd5\u4e2d\uff0c\u82e5\u8bb8\u591a\u5bf9\u9879\u6700\u540e\u4f1a\u8d21\u732e\u5728\u540c\u4e00\u4e2a\u4f4d\u7f6e\u4e0a\uff0c\u90a3\u4e48\u5b83\u4eec\u7684 **\u6b21\u65b9\u7684\u548c** \u662f\u76f8\u7b49\u7684\u3002\n\n\u5219\u8003\u8651\u5012\u8f6c\u539f\u4e32\uff0c\u5f97\u5230 $T'$ \u3002\n\n\u7531\u4e8e\u5b57\u7b26\u96c6\u5927\u5c0f\u4ec5\u4ec5\u4e3a $4$ \uff0c\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u4e00\u4e0b\u5206\u5f00\u8003\u8651\u6bcf\u79cd\u4e0d\u540c\u7684\u5b57\u7b26\u3002\n\n\u5bf9\u4e8e\u5f53\u524d\u5b57\u7b26 $c$\uff0c\u8003\u8651\u8bbe $f_i=[S_i==c]*x^i$\uff0c$g_i=[T'_i==c]*x^i$\u3002\n\n\u5219\u5bf9\u4e8e\u5f97\u5230\u7684 $F(x)=f(x)*g(x)$ \u800c\u8a00\uff0c\u6211\u4eec\u53d1\u73b0\u5bf9\u4e8e\u539f\u4e32\u4e2d\u7684\u5b57\u7b26 $S_i=T_j=c$ \uff0c\u5b83\u4eec\u5728 $f$ \u4e0e $g$ \u4e2d\u5bf9\u5e94\u9879\u7684\u4e58\u79ef\u4e3a $1$ \uff0c\u4e14\u5bf9\u4f4d\u7f6e $m-j+1+i$ \u4ea7\u751f\u4e86 $1$ \u7684\u8d21\u732e\u3002\n\n\u5bf9\u4e8e\u4e0b\u4e00\u79cd\u5b57\u7b26 $p$ \u800c\u8a00\uff0c\u82e5\u6709 $S_{i+1}=T_{j+1}=p$\uff0c\u5219\u4f1a\u5bf9 $m-(j+1)+1+(i+1)=m-j+1+i$ \u6709 $1$ \u7684\u8d21\u732e\u3002\n\n\u6362\u53e5\u8bdd\u8bf4\uff0c\u82e5\u6709 $T$ \u5728 $S$ \u7684\u4f4d\u7f6e $i$ \u5339\u914d\u4e0a\u4e86\uff0c\u90a3\u4e48\u5fc5\u5b9a\u6709\uff1a$T_1=S_i,T_2=S_{i+1}\\dots T_m=S{i+m-1}$ \uff0c\u4e5f\u5c31\u5fc5\u5b9a\u4f1a\u5728\u5bf9\u56db\u79cd\u5b57\u7b26\u7684\u5377\u79ef\u91cc\u5bf9 $m-j+1+i$ \u8fd9\u4e00\u9879\u603b\u5171\u4ea7\u751f $m$ \u7684\u8d21\u732e\u3002\n\n\u5c06\u56db\u6b21\u5377\u79ef\u7684\u7ed3\u679c\u76f8\u52a0\uff0c\u5219\u6700\u540e\u7684\u7b54\u6848\u4e3a\uff1a\u7cfb\u6570\u4e3a $m$ \u7684\u9879\u7684\u4e2a\u6570\u3002\n\n\u63a5\u7740\u8003\u8651 $k>0$ \u7684\u60c5\u51b5\uff0c\u6211\u4eec\u4f1a\u53d1\u73b0\u548c $k=0$ \u7684\u601d\u8def\u51e0\u4e4e\u4e00\u81f4\uff0c\u5bf9\u4e8e\u8fd9\u4e2a $k$ \uff0c\u60f3\u60f3\u5b83\u7684\u610f\u4e49\uff1a\u6211\u4eec\u5728\u5904\u7406\u6bcf\u79cd\u4e0d\u540c\u7684\u5b57\u7b26\u7684\u65f6\u5019\uff0c\u82e5\u5f53\u524d\u5b57\u7b26\u4e3a $c$ \uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u4e3a $c$ \u7684\u4f4d\u7f6e\uff0c\u5b83\u5f80\u5de6\u53f3\u4e24\u8fb9 $k$ \u4f4d\u4e5f\u90fd\u662f\u53ef\u4ee5\u5339\u914d\u7684\u4f4d\u7f6e\u3002\n\n\u90a3\u6211\u4eec\u76f4\u63a5\u5c06\u6bcf\u4e2a $c$ \u7684\u5de6\u53f3 $k$ \u4f4d\u4e5f\u90fd\u8bbe\u6210 $c$ \u4e0d\u5c31\u597d\u4e86\u561b\uff1f\n\n\u90a3\u4e48\u601d\u8def\u5c31\u5f88\u6e05\u6670\u4e86\uff1a\u56db\u79cd\u5b57\u7b26\u5206\u522b\u7edf\u8ba1\uff0c\u7136\u540e\u5bf9\u4e8e\u6bcf\u79cd\u5f53\u524d\u7edf\u8ba1\u7684\u5b57\u7b26\uff0c\u5c06\u5de6\u53f3 $k$ \u4f4d\u8bbe\u4e3a\u540c\u6837\u7684\u5b57\u7b26\uff0c\u5f97\u5230 $f,g$ \u4e24\u4e2a\u591a\u9879\u5f0f\uff0c\u5e76\u5c06\u5176\u5377\u79ef\u5f97\u5230 $F(x)=f(x)*g(x)$ \uff0c\u5c06\u56db\u4e2a $F(x)$ \u76f8\u52a0\uff0c\u7edf\u8ba1\u7cfb\u6570\u4e3a $m$ \u7684\u9879\u6570\u3002\n\n\u5b8c\u6bd5\u3002\n\n# Code\n\n```cpp\n#include <cmath>\n#include <cstdio>\n#include <cstring>\n#include <iostream>\nusing namespace std;\n#define LL long long\n#define go(x, i, v) for (int i = hd[x], v = to[i]; i; v = to[i = nx[i]])\n#define inline __inline__ __attribute__((always_inline))\nLL read() {\n  long long x = 0, w = 1;\n  char ch = getchar();\n  while (!isdigit(ch)) w = ch == '-' ? -1 : 1, ch = getchar();\n  while (isdigit(ch)) {\n    x = (x << 3) + (x << 1) + ch - '0';\n    ch = getchar();\n  }\n  return x * w;\n}\nconst int Max_n = 2e5 + 5, mod = 998244353, G = 3;\nint n, m, K, ans;\nint f[Max_n << 2], g[Max_n << 2], A[Max_n << 2];\nint lim, bit, rev[Max_n << 2];\nchar S[Max_n], T[Max_n];\ninline void Convert(char &c) {\n  if (c == 'A') c = 'a';\n  if (c == 'C') c = 'b';\n  if (c == 'G') c = 'c';\n  if (c == 'T') c = 'd';\n}\ninline int ksm(int a, int b) {\n  int res = 1;\n  for (; b; b >>= 1, a = 1ll * a * a % mod)\n    if (b & 1) res = 1ll * res * a % mod;\n  return res;\n}\nnamespace NTT {\ninline void dft(int *f, bool t) {\n  for (int i = 0; i < lim; i++)\n    if (rev[i] > i) swap(f[i], f[rev[i]]);\n  for (int len = 1; len < lim; len <<= 1) {\n    int Wn = ksm(G, (mod - 1) / (len << 1));\n    if (t) Wn = ksm(Wn, mod - 2);\n    for (int i = 0; i < lim; i += len << 1) {\n      int Wnk = 1;\n      for (int k = i; k < i + len; k++, Wnk = 1ll * Wnk * Wn % mod) {\n        int x = f[k], y = 1ll * f[k + len] * Wnk % mod;\n        f[k] = (x + y) % mod, f[k + len] = (x - y + mod) % mod;\n      }\n    }\n  }\n}\n}  // namespace NTT\ninline void ntt(int *f, int *g) {\n  NTT::dft(f, 0), NTT::dft(g, 0);\n  for (int i = 0; i < lim; i++) f[i] = 1ll * f[i] * g[i] % mod;\n  NTT::dft(f, 1);\n  int Inv = ksm(lim, mod - 2);\n  for (int i = 0; i < lim; i++) f[i] = 1ll * f[i] * Inv % mod;\n}\nint main() {\n#ifndef ONLINE_JUDGE\n  freopen(\"D.in\", \"r\", stdin);\n  freopen(\"D.out\", \"w\", stdout);\n#endif\n  n = read(), m = read(), K = read();\n  scanf(\" %s\", S + 1), scanf(\"%s\", T + 1);\n  for (int i = 1; i <= n; i++) Convert(S[i]);\n  for (int i = 1; i <= m; i++) Convert(T[i]);\n  for (int i = 1; i <= m / 2; i++) swap(T[i], T[m - i + 1]);\n  bit = log2(n + m) + 1, lim = 1 << bit;\n  for (int i = 0; i < lim; i++)\n    rev[i] = rev[i >> 1] >> 1 | ((i & 1) << (bit - 1));\n  for (int k = 'a'; k <= 'd'; k++) {\n    memset(f, 0, sizeof(f)), memset(g, 0, sizeof(g));\n    for (int i = 1, cnt = 0; i <= n; i++) {\n      if (S[i] == k)\n        cnt = K, f[i] = 1;\n      else if (cnt)\n        cnt--, f[i] = 1;\n    }\n    for (int i = n, cnt = 0; i >= 1; i--) {\n      if (S[i] == k)\n        cnt = K, f[i] = 1;\n      else if (cnt)\n        cnt--, f[i] = 1;\n    }\n    for (int i = 1; i <= m; i++) g[i] = T[i] == k;\n    ntt(f, g);\n    for (int i = 0; i < lim; i++) A[i] += f[i];\n  }\n  for (int i = 0; i < lim; i++)\n    ans += A[i] == m;\n  cout << ans;\n}\n```\n",
        "postTime": 1567926575,
        "uid": 39954,
        "name": "\u6d1b\u6c34\u00b7\u9526\u4f9d\u536b",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF528D \u3010Fuzzy Search\u3011"
    }
]
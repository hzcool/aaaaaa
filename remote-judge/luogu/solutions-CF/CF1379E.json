[
    {
        "content": "# \u9898\u76ee\n[\u70b9\u8fd9\u91cc](https://www.luogu.com.cn/problem/CF1379E)\u770b\u9898\u76ee\u3002   \n# \u5206\u6790\n\u5bf9\u4e8e\u8fd9\u79cd\u6784\u9020\u9898\u76ee\uff0c\u6211\u4eec\u9996\u5148\u8003\u8651**\u8fb9\u754c\u60c5\u51b5**\u3002\u6bd4\u5982\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba1\u7b97\u4e0d\u5e73\u8861\u70b9\u7684\u4e0a\u754c\uff0c\u5e76\u4e14\u627e\u5230\u5bf9\u5e94\u7684\u6784\u9020\u65b9\u6848\uff0c\u7136\u540e\u6784\u9020\u51fa\u6765\u3002   \n   \n\u8fd9\u4e2a\u4e0a\u754c\u53ef\u4ee5\u5982\u4e0b\u6784\u9020\uff1a   \n   \n```\n          o\n         / \\\n        o   o\n       / \\\n      o   o\n     /\n   ...\n   /\n  o\n / \\\no   o\n```     \n\n\u4e5f\u5c31\u662f\uff0c\u9996\u5148\u6784\u9020\u4e00\u6761\u94fe\uff0c\u957f\u5ea6\u4e3a $\\frac{n+1}{2}$\uff08\u663e\u7136\uff0c\u6709\u89e3\u7684 $n$ \u4e00\u5b9a\u662f**\u5947\u6570**\uff09\u3002\u63a5\u7740\uff0c\u6211\u4eec\u7ed9\u94fe\u4e0a\u7684\u9664**\u4efb\u4e00\u7aef\u70b9**\u4ee5\u5916\u7684\u6240\u6709\u70b9\u52a0\u4e0a\u4e00\u4e2a\u513f\u5b50\u3002\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u4e00\u68f5\u6709 $\\frac{n-3}{2}$ \u4e2a\u4e0d\u5e73\u8861\u70b9\u7684\u6811\u3002\u53ef\u4ee5\u53d1\u73b0\u8fd9\u5c31\u662f\u6784\u9020\u7684\u4e0a\u754c\u3002    \n    \n\u73b0\u5728\uff0c\u6211\u4eec\u79f0 $T_k$ \u4e3a\u957f\u6210\u8fd9\u4e2a\u6837\u5b50\u7684\u6811\uff1a   \n   \n```\n          1\n         / \\\n        2   o\n       / \\\n      3   o\n     / \\\n   ...  o\n   /\n  k\n   \\\n    o\n```    \n   \n\u6b64\u65f6\u53ea\u8981\u8282\u70b9 $k$ \u7684\u5de6\u513f\u5b50\u5927\u5c0f\u5927\u4e8e 1\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u83b7\u5f97 $k$ \u4e2a\u4e0d\u5e73\u8861\u70b9\u7684\u8d21\u732e\uff08\u5426\u5219\u4e5f\u4f1a\u6709 $k-1$ \u4e2a\u7684\u8d21\u732e\uff09\u3002\u53ef\u4ee5\u53d1\u73b0\u6211\u4eec\u521a\u521a\u6784\u9020\u7684\u4e0a\u754c\u5c31\u662f\u8fd9\u6837\u6784\u9020\u51fa\u6765\u7684\u3002\n   \n\u63a5\u7740\u8003\u8651\u4e0d\u5e73\u8861\u70b9\u7684\u4e0b\u754c\u3002\u663e\u7136\uff0c\u5982\u679c $n=2^k-1(k>0)$\uff0c\u90a3\u4e48\u5b83\u5c31\u53ef\u4ee5\u6784\u9020\u51fa\u6ca1\u6709\u4e0d\u5e73\u8861\u70b9\u7684\u6811\u3002\u5426\u5219\uff0c\u6700\u5c11\u53ea\u80fd\u6784\u9020\u51fa\u6709\u4e00\u4e2a\u4e0d\u5e73\u8861\u70b9\u7684\u6811\u3002\u8fd9\u4e24\u79cd\u60c5\u51b5\u7684\u6784\u9020\u65b9\u6cd5\u662f\u4e00\u6837\u7684\uff0c\u90fd\u662f\u6784\u9020\u6210\u5b8c\u5168\u4e8c\u53c9\u6811\u7684\u6837\u5b50\u3002   \n\n\u5c06\u4e24\u4e2a\u6781\u7aef\u7ed3\u5408\u8d77\u6765\u2014\u2014\u5982\u679c $k<2$\uff0c\u6211\u4eec\u53ef\u4ee5\u5224\u65ad\u5e76\u6784\u9020\u3002\u5426\u5219\uff0c\u6211\u4eec\u53ef\u4ee5\u9996\u5148\u6784\u9020\u51fa $T_{k-1}$ \u3002\u7136\u540e\u6784\u9020\u51fa\u5e26\u6765 1 \u7684\u8d21\u732e\u7684\u6811\uff0c\u5e76\u4e14\u63a5\u5230 $T_{k-1}$ \u4e0b\u9762\u53bb\u3002   \n   \n\u5982\u679c $n-2(k-1)$ \u4e0d\u80fd\u6784\u6210\u6ee1\u4e8c\u53c9\u6811\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u6784\u9020\u6210\u5b8c\u5168\u4e8c\u53c9\u6811\u5e76\u4e14\u63a5\u5230 $T_{k-1}$ \u4e0b\u9762\u53bb\u3002    \n    \n\u5426\u5219\uff0c\u8003\u8651\u4e22\u6389\u6ee1\u4e8c\u53c9\u6811\u7684\u51e0\u4e2a\u70b9\uff0c\u4f7f\u5f97\u5b83\u4e0d\u6ee1\uff0c\u7136\u540e\u63a5\u5230 $T_{k-1}$ \u4e0b\u9762\u3002\u63a5\u7740\uff0c\u6211\u4eec\u53ea\u9700\u8981\u7ed9\u63d0\u51fa\u6765\u7684\u70b9\u627e\u4f4d\u7f6e\u5c31\u597d\u4e86\u3002    \n    \n\u4e0d\u96be\u60f3\u5230\u6784\u9020 $n-2$ \u5927\u5c0f\u7684\u6811\uff0c\u63a5\u5230 $T_{k-1}$ \u4e0b\u9762\uff0c\u7136\u540e\u5c06 2 \u4e2a\u70b9\u63a5\u5230 1 \u7684\u53f3\u513f\u5b50\u4e0a\u3002\u6b64\u65f6\uff0c\u53ea\u8981 1 \u7684\u5de6\u513f\u5b50\u8db3\u591f\u5927\uff0c1 \u8fd8\u662f\u53ef\u4ee5\u6210\u4e3a\u4e0d\u5e73\u8861\u70b9\u3002   \n   \n\u8fd9\u6837\u7684\u6784\u9020\u65b9\u6cd5\u53ea\u4f1a\u6709\u4e00\u4e2a\u53cd\u4f8b\uff1a```n=9,k=2```\u3002\u800c\u7ecf\u8fc7\u679a\u4e3e\u53ef\u4ee5\u53d1\u73b0\u5b83\u662f\u771f\u7684\u65e0\u89e3\u3002     \n   \n\u4e8e\u662f\u95ee\u9898\u5c31\u89e3\u51b3\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n)$\u3002\n\n# \u4ee3\u7801\n```cpp\n#include <cstdio>\n\nconst int MAXN = 1e5 + 5, MAXLOG = 50;\n\ntemplate<typename _T>\nvoid read( _T &x )\n{\n    x = 0;char s = getchar();int f = 1;\n    while( s > '9' || s < '0' ){if( s == '-' ) f = -1; s = getchar();}\n    while( s >= '0' && s <= '9' ){x = ( x << 3 ) + ( x << 1 ) + ( s - '0' ), s = getchar();}\n    x *= f;\n}\n\ntemplate<typename _T>\nvoid write( _T x )\n{\n    if( x < 0 ){ putchar( '-' ); x = ( ~ x ) + 1; }\n    if( 9 < x ){ write( x / 10 ); }\n    putchar( x % 10 + '0' );\n}\n\ntemplate<typename _T>\nvoid swapp( _T &x, _T &y )\n{\n    _T t = x; x = y, y = t;\n}\n\ntemplate<typename _T>\n_T MIN( const _T a, const _T b )\n{\n    return a < b ? a : b;\n}\n\ntemplate<typename _T>\n_T MAX( const _T a, const _T b )\n{\n    return a > b ? a : b;\n}\n\nint ance[MAXN];\nint N, M, K;\n\nint Lowbit( const int x ) { return x & ( -x ); }\nbool Chk( int x ) { return x - Lowbit( x ) == 0; }\n\nint main()\n{\n    read( N ), read( K );\n    int lim = MAX( ( N - 3 ) / 2, 0 );\n    if( K > lim ) return puts( \"NO\" ), 0;\n    if( N % 2 == 0 ) return puts( \"NO\" ), 0;\n    if( N == 9 && K == 2 ) return puts( \"NO\" ), 0;\n    if( Chk( N + 1 ) && K == 1 ) return puts( \"NO\" ), 0;\n    if( ! Chk( N + 1 ) && K == 0 ) return puts( \"NO\" ), 0;\n    \n    puts( \"YES\" );\n    int base = 2 * MAX( 0, K - 1 ); \n    for( int i = 1 ; i < base ; i += 2 )\n        ance[i + 1] = i, ance[i] = MAX( 0, i - 2 );\n    for( int i = 1 ; i <= N - base ; i ++ )\n    {\n        if( i == 1 ) ance[i + base] = MAX( 0, base - 1 );\n        else ance[i + base] = ( i >> 1 ) + base;\n    }   \n    if( Chk( N - base + 1 ) && K ) ance[N - 1] = ance[N] = 2;\n    for( int i = 1 ; i <= N ; i ++ ) write( ance[i] ), putchar( i == N ? '\\n' : ' ' );\n    return 0;\n}\n```",
        "postTime": 1600847369,
        "uid": 123809,
        "name": "crashed",
        "ccfLevel": 0,
        "title": "[CF1379E]Inverse Genealogy"
    },
    {
        "content": "\u4e00\u9053\u8bc4\u5206\u865a\u9ad8\u7684\u6784\u9020\u9898\u3002\n\n\u9996\u5148\u8003\u8651\u5728\u603b\u70b9\u6570\u56fa\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u5982\u4f55\u6784\u9020\u51fa\u6700\u591a\u7684\u975e\u5e73\u8861\u70b9\u3002\u5bb9\u6613\u53d1\u73b0\u6784\u9020\u65b9\u5f0f\u5982\u4e0b\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/nd0omut1.png?x-oss-process=image/resize,m_lfit,h_170,w_225)\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u82e5 $n<2m+3$\uff0c\u90a3\u4e48\u4e00\u5b9a\u65e0\u89e3\u3002\n\n\u8003\u8651\u5148\u6309\u7167\u5982\u4e0b\u65b9\u5f0f\u6784\u9020\u51fa\u4e00\u68f5\u4e8c\u53c9\u6811\uff0c\u7528\u53bb $(2m+3)$ \u4e2a\u8282\u70b9\uff0c\u7136\u540e\u518d\u5f80\u6811\u91cc\u9762\u52a0\u4e0a\u5269\u4f59\u7684 $(n-(2m+3))$ \u4e2a\u8282\u70b9\u3002\n\n\u90a3\u4e48\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a\u4e86\u5982\u4f55\u5728\u603b\u70b9\u6570\u56fa\u5b9a\u7684\u60c5\u51b5\u4e0b\uff0c\u6784\u9020\u51fa\u6700\u5c11\u7684\u5e73\u8861\u70b9\uff0c\u90a3\u4e48\u663e\u7136\u662f\u6784\u9020\u51fa\u4e00\u68f5\u5b8c\u5168\u4e8c\u53c9\u6811\u3002\u53c8\u4e3a\u4e86\u4e0d\u989d\u5916\u589e\u52a0\u975e\u5e73\u8861\u70b9\uff0c\u8003\u8651\u5f80\u6df1\u5ea6\u6700\u6df1\u7684\u975e\u5e73\u8861\u70b9\u7684\u53f3\u513f\u5b50\u4e0b\u6302\u5b8c\u5168\u4e8c\u53c9\u6811\uff0c\u5927\u81f4\u662f\u8fd9\u6837\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/wegfq2il.png?x-oss-process=image/resize,m_lfit,h_170,w_225)\n\n\u4f46\u662f\u8fd9\u4e2a\u65f6\u5019\u53c8\u4f1a\u6709\u65b0\u7684\u95ee\u9898\u51fa\u73b0\uff0c\u5373\u5982\u679c\u6302\u7684\u5b8c\u5168\u4e8c\u53c9\u6811\u5e76\u4e0d\u662f\u6ee1\u4e8c\u53c9\u6811\uff0c\u90a3\u4e48\u4ecd\u7136\u4f1a\u591a\u589e\u52a0\u4e00\u4e2a\u975e\u5e73\u8861\u70b9\u3002\u6240\u4ee5\u6211\u4eec\u8fd8\u9700\u8981\u628a\u8282\u70b9 $1,2$\uff08\u4e0a\u56fe\u7684\u6839\u8282\u70b9\u4e0e\u5176\u5de6\u513f\u5b50\uff09\u62c6\u4e0b\u6765\u6302\u5230\u5176\u4ed6\u7684\u5730\u65b9\uff0c\u5e76\u4e14\u4fdd\u8bc1\u65b0\u6302\u5230\u7684\u5730\u65b9\u4e0d\u80fd\u65b0\u589e\u975e\u5e73\u8861\u70b9\u3002\n\n\u89c2\u5bdf\u6b64\u65f6\u7684\u6811\uff0c\u5b9e\u9645\u4e0a\u53ea\u6709\u4e24\u4e2a\u4f4d\u7f6e\u53ef\u4ee5\u6302\uff0c\u5373\u6240\u6709\u975e\u5e73\u8861\u70b9\u7684\u5de6\u513f\u5b50\u5e95\u4e0b\u4ee5\u53ca\u5b8c\u5168\u4e8c\u53c9\u6811\u4e0b\u3002\u53ea\u9700\u8981\u5224\u65ad\u662f\u5426\u80fd\u6302\u5728\u8fd9\u4e24\u79cd\u4f4d\u7f6e\u4e0a\uff0c\u5982\u679c\u80fd\u6302\u5219\u53ef\u6784\u9020\uff0c\u4e0d\u80fd\u6302\u5219\u4e0d\u53ef\u6784\u9020\u3002\n\n- \u975e\u5e73\u8861\u70b9\u7684\u5de6\u513f\u5b50\u5e95\u4e0b\n\n  \u9996\u5148\u8981\u6ee1\u8db3 $m>1$\uff0c\u5426\u5219\u6ca1\u5730\u65b9\u6302\u3002\n\n  \u5982\u679c\u6302\u5728\u8fd9\u79cd\u4f4d\u7f6e\u4e0b\u662f\u5408\u6cd5\u7684\uff0c\u90a3\u4e48\u5fc5\u987b\u4fdd\u8bc1\u8be5\u975e\u5e73\u8861\u70b9\u7684\u53f3\u5b50\u6811 $>6$\uff08\u5426\u5219\u4f1a\u5c11\u4e00\u4e2a\u975e\u5e73\u8861\u70b9\uff09\u3002\u90a3\u4e48\u663e\u7136\u6302\u5728\u6df1\u5ea6\u6700\u6d45\u7684\u975e\u5e73\u8861\u70b9\u4e0b\u6700\u4f18\u3002\u800c\u8be5\u975e\u5e73\u8861\u70b9\u7684\u53f3\u5b50\u6811\u6709 $(n-4)$ \u4e2a\u70b9\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u5224\u65ad $n-4>6$ \u662f\u5426\u6210\u7acb\u5373\u53ef\u3002\n\n  \u7efc\u4e0a\uff0c$m>1$ \u4e14 $n>10$\u3002\n\n- \u5b8c\u5168\u4e8c\u53c9\u6811\u4e0b\n\n  \u4e0a\u6587\u8bf4\u5230\uff0c\u5b8c\u5168\u4e8c\u53c9\u6811\u53ea\u6709\u5728\u6ee1\u4e8c\u53c9\u6811\u5f62\u6001\u4e0b\u624d\u4e0d\u4f1a\u8d21\u732e\u975e\u5e73\u8861\u70b9\u3002\u5982\u679c\u65b0\u589e\u4e24\u4e2a\u8282\u70b9\u540e\uff0c\u5b8c\u5168\u4e8c\u53c9\u6811\u53d8\u6210\u4e86\u6ee1\u4e8c\u53c9\u6811\uff0c\u90a3\u4e48\u975e\u5e73\u8861\u70b9\u603b\u6570\u5c31\u4f1a\u51cf\u5c11 $1$\u3002\u9664\u6b64\u4ee5\u5916\u7684\u60c5\u51b5\u90fd\u53ef\u4ee5\u3002\n\n  \u7efc\u4e0a\uff0c$(n-2m+3)+2$ \u4e2a\u8282\u70b9\u4e0d\u80fd\u6784\u9020\u51fa\u6ee1\u4e8c\u53c9\u6811\u3002\n\n\u603b\u7ed3\u4e00\u4e0b\uff0c\u5148\u6784\u9020\u51fa\u975e\u5e73\u8861\u70b9\u6700\u591a\u7684\u6811\u7684\u5f62\u6001\uff0c\u7136\u540e\u628a\u5269\u4f59\u7684\u70b9\u4ee5\u5b8c\u5168\u4e8c\u53c9\u6811\u7684\u5f62\u6001\u6302\u5230\u6811\u7684\u6700\u6df1\u5c42\u3002\u5982\u679c\u975e\u5e73\u8861\u70b9\u591a\u4e86 $1$\uff0c\u5c31\u628a $1,2$ \u8282\u70b9\u53d6\u4e0b\u6765\uff0c\u5224\u65ad\u662f\u5426\u6709\u5730\u65b9\u6302\uff0c\u5982\u679c\u6709\uff0c\u5219\u53ef\u6784\u9020\uff0c\u6ca1\u6709\u5219\u4e0d\u53ef\u6784\u9020\u3002\n\n\u6ce8\u610f\u5224\u65ad $n$ \u4e3a\u5947\u6570\u7684\u60c5\u51b5\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define il inline\nusing namespace std;\nconst int maxn=200010;\nint n,m,N,cnt,fa[maxn];\nvoid build1(int i,int beg=0){\n\tif(i>N) return ;\n\tfa[(i-beg<<1)+beg]=fa[(i-beg<<1|1)+beg]=i;\n\tbuild1((i-beg<<1)+beg,beg);\n\tbuild1((i-beg<<1|1)+beg,beg);\n}//\u5efa\u4ee5 (Beg+1) \u4e3a\u6839\u7684\u5b8c\u5168\u4e8c\u53c9\u6811\nvoid build2(int i){\n\tif(cnt==m) return ;\n\tfa[i+1]=fa[i+2]=i,cnt++;\n\tbuild2(i+2);\n}//\u5efa\u975e\u5e73\u8861\u70b9\u6700\u591a\u7684\u4e8c\u53c9\u6811\nint Print(){\n\tprintf(\"YES\\n\");\n\tfor(int i=1;i<=N;i++)\n\t\tprintf(\"%d \",fa[i]);\n\treturn printf(\"\\n\"),0;\n}\nint main(){\n\tscanf(\"%d%d\",&n,&m),N=n;\n\tif(n&1^1) return printf(\"NO\\n\"),0;\n\tif(m==0){\n        //m=0\u76f4\u63a5\u770b\u662f\u4e0d\u662f\u6ee1\u4e8c\u53c9\u6811\n\t\tif((1<<((int)log2(n+1)))!=n+1)\n\t\t\treturn printf(\"NO\\n\"),0;\n\t\tbuild1(1);return Print();\n\t}\n\tif(m*2+3>n) return printf(\"NO\\n\"),0;\n    //\u5224\u65adm\u4e0a\u754c\n\tbuild2(1),n-=m*2+3;\n\tbuild1(2*m+1,2*m);\n    //\u975e\u5e73\u8861\u70b9\u6700\u591a\u7684\u4e8c\u53c9\u6811\u4e0b\u6302\u5b8c\u5168\u4e8c\u53c9\u6811\n\tif((1<<((int)log2(n+4)))==n+4) return Print();//\u5982\u679c\u6070\u597d\u662f\u6ee1\u4e8c\u53c9\u6811\u5219\u8f93\u51fa\n\tif((N-4)>6&&m>1){\n        //1,2\u6302\u975e\u5e73\u8861\u70b9\u4e0b\n\t\tfa[3]=0,fa[1]=fa[2]=4;\n\t\treturn Print();\n\t}\n\tif((1<<(int)log2(n+6))!=n+6){\n        //1,2\u6302\u5b8c\u5168\u4e8c\u53c9\u6811\u4e0b\n\t\tfa[3]=0,fa[1]=fa[2]=(N+1-2*m>>1)+2*m; \n\t\treturn Print();\n\t}printf(\"NO\\n\");\n\treturn 0;\n}\n```\n\n\u5176\u4ed6\u9898\u89e3\u91cc\u63d0\u5230\u7684\u7279\u5224\uff0c\u5176\u5b9e\u5c31\u662f $1,2$ \u8282\u70b9\u65e0\u5904\u53ef\u6302\u7684\u60c5\u51b5\u3002\u4f46\u5176\u5b9e\u4e0d\u9700\u8981\u7279\u5224\u4e5f\u662f\u53ef\u4ee5\u6709\u5b8c\u6574\u7684\u6784\u9020\u65b9\u5f0f\u7684\u3002",
        "postTime": 1668155655,
        "uid": 288716,
        "name": "lzqy_",
        "ccfLevel": 7,
        "title": "Inverse Genealogy \u9898\u89e3"
    }
]
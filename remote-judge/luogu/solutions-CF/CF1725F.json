[
    {
        "content": "\u663e\u7136\u7b54\u6848\u53ea\u4e0e $W$ \u7684 lowbit \u6709\u5173\u3002\n\n\u7531\u4e8e\u4e00\u6761\u5f88\u957f\uff0c\u524d\u9762\u7684\u4f4d\u968f\u4fbf\u64cd\u4f5c\uff0c\u6211\u4eec\u603b\u53ef\u4ee5\u64cd\u4f5c\u82e5\u5e72\u6b21 lowbit \u4f7f\u4e4b\u56de\u5230\u521d\u59cb\u4f4d\u7f6e\u3002\n\n\u800c\u6211\u4eec\u4e5f\u53ef\u4ee5\u901a\u8fc7\u82e5\u5e72\u6b21\u64cd\u4f5c lowbit \u4f7f\u5f97\u6a21 lowbit \u540c\u4f59\u7684\u4f4d\u5bf9\u9f50\u3002\n\n\u4e8e\u662f\u95ee\u9898\u8f6c\u5316\u4e3a\u627e\u5230\u51fa\u73b0\u6b21\u6570\u6700\u591a\u7684\u6a21 lowbit \u540c\u4f59\u7684\u4f4d\u3002\n\n\u8fd9\u4e2a\u95ee\u9898\u6211\u4eec\u628a\u6bcf\u884c\u7684\u5de6\u53f3\u7aef\u70b9\u79bb\u6563\u5316\u4e0b\u6765\u505a\u4e00\u904d\u524d\u7f00\u548c\u5c31\u597d\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log^2 n)$\u3002\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define inf 1e9\nconst int maxn=2e5+10;\nconst int mod=1e9+7;\ninline int read(){\n\tint x=0,f=1;char c=getchar();\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9'){x=(x<<1)+(x<<3)+c-'0';c=getchar();}\n\treturn x*f;\n}\nint n,m,L[maxn],R[maxn],Ans[maxn],S[maxn],a[maxn];\nint main(){\n\tn=read();\n\tfor(int i=1;i<=n;i++)\n\t\tL[i]=read(),R[i]=read();\n\tfor(int k=0;k<=30;k++){\n\t\tint tag=0,len=(1<<k),top=0;\n\t\tfor(int i=1;i<=n;i++)a[++top]=L[i]%len,a[++top]=R[i]%len+1;\n\t\tsort(a+1,a+1+top);\n\t\ttop=unique(a+1,a+1+top)-a-1;\n\t\tfor(int i=0;i<=top;i++)S[i]=0;\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tint l=L[i]%len,r=R[i]%len;\n\t\t\tif(R[i]-L[i]>=len){++tag;continue;}\n\t\t\tif(l>r)++tag;\n\t\t\tl=lower_bound(a+1,a+1+top,l)-a;\n\t\t\tr=lower_bound(a+1,a+1+top,r+1)-a;\n\t\t\t++S[l],--S[r];\n\t\t}int Mx=0;\n\t\tfor(int i=1;i<=top;i++)S[i]+=S[i-1];\n\t\tfor(int i=0;i<=top;i++)Mx=max(Mx,S[i]);\n\t\tAns[k]=Mx+tag;\n\t}m=read();\n\tfor(int i=1,x;i<=m;i++){\n\t\tx=read();\n\t\tprintf(\"%d\\n\",Ans[__lg(x&(-x))]);\n\t}\n    return 0;\n}\n```\n\n\u8fd8\u662f\u86ee\u641e\u7b11\u7684\uff0c\u4f46\u6211\u4e5f\u53ea\u6709\u8bf4 2100 \u641e\u7b11\u7684\u6c34\u5e73\u4e86\u3002",
        "postTime": 1663231392,
        "uid": 409469,
        "name": "Mariposa",
        "ccfLevel": 0,
        "title": "CF1725F Field Photography"
    }
]
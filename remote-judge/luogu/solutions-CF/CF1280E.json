[
    {
        "content": "\u6765\u6c34\u9898\u89e3\u5566\uff01\n\n\u9996\u5148\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u5b8c\u6210\u4e86\u8f93\u5165\u5904\u7406\u7684\u90e8\u5206......\n\n\u9996\u5148\u6211\u4eec\u4e0d\u96be\u53d1\u73b0\u4e00\u4e2a\u7b80\u5355\u7684\u7ed3\u8bba\uff1a\n\n\u8003\u8651\u4e00\u4e2a\u7535\u963b\u7f51\u7edc$G$\uff0c\u4e0d\u59a8\u8bbe\u5f53$G$\u7684\u7b49\u6548\u7535\u963b\u4e3a$x$\u65f6$G$\u4e2d\u7535\u963b\u603b\u548c\u7684\u6700\u5c0f\u503c\u4e3a$f_G(x)$\uff0c\u5219\u5b58\u5728\u4ec5\u4e0e$G$\u76f8\u5173\u7684\u5e38\u6570$k_G$\uff0c\u4f7f\u5f97$f_G(x)=xk_G$\u3002\n\n\u7535\u963b\u7f51\u7edc\u53ef\u4ee5\u9012\u5f52\u5730\u7406\u89e3\uff1a\u4e00\u4e2a\u7535\u963b\u7f51\u7edc$G$\u662f\u7531$m$\u4e2a\u5b50\u7535\u963b\u7f51\u7edc$G_1,G_2,\\dots G_m$\u76f4\u63a5\u5e76\u8054\u6216\u4e32\u8054\u7ec4\u6210\u7684\u3002\u9996\u5148\u8003\u8651\u5982\u4f55\u6c42\u51fa$k_G$\uff1a\n\n\u4ee4$x$\u4e3a$G$\u7684\u7b49\u6548\u7535\u963b\uff0c$x_1,x_2,x_3,\\dots x_m$\u5206\u522b\u4e3a$G_1,G_2,\\dots G_m$\u7684\u7b49\u6548\u7535\u963b\uff0c$S=\\sum f_{G_i}(x_i)=\\sum x_ik_{G_i}$\u3002\n- \u82e5$G$\u7531\u4e32\u8054\u7ec4\u6210\uff0c\n\u5219\u6709$x=\\sum x_i$\u3002\u4e0d\u59a8\u4ee4$k_{G_1}\\le k_{G_2}\\le\\dots\\le k_{G_m}$\uff0c\u5219\u53d6$x_1=x,x_2=x_3=\\dots=x_m=0$\u65f6$S$\u53d6\u6700\u5c0f\u503c$xk_{G_1}$, \u5373$k_G=k_{G_1}$\u3002\u7531\u8c03\u6574\u6cd5\u663e\u7136\u53ef\u8bc1\u3002\n\n- \u82e5$G$\u7531\u5e76\u8054\u7ec4\u6210\uff0c\n\u5219\u6709$\\frac{1}{x}=\\sum \\frac{1}{x_i}$\u3002\u8003\u8651\u5982\u4e0b\u8f6c\u5316\uff1a\n$$S=x(\\sum \\frac{1}{x_i})(\\sum x_ik_{G_i})$$\n\n\u518d\u7531\u67ef\u897f\u4e0d\u7b49\u5f0f\u6709\uff1a\n$$x(\\sum \\frac{1}{x_i})(\\sum x_ik_{G_i})\\ge x(\\sum \\sqrt{k_{G_i}})^2$$\n\n\u5373\uff0c$k_G=(\\sum \\sqrt{k_{G_i}})^2$\u3002\n\n\u7531\u67ef\u897f\u4e0d\u7b49\u5f0f\u7684\u53d6\u7b49\u6761\u4ef6\uff0c\u4e0a\u8ff0\u4e0d\u7b49\u5f0f\u53d6\u7b49\u53f7\u5f53\u4e14\u4ec5\u5f53\uff1a\u5b58\u5728$\\lambda\\in\\mathbb{R}$\uff0c\u4f7f\u5f97\u5bf9\u4e8e\u6240\u6709$i$\uff0c$\\sqrt{x_ik_{G_i}}=\\frac{\\lambda}{\\sqrt{x_i}}$\u3002\u8fd9\u610f\u5473\u7740\uff0c\u5bf9\u6240\u6709$i$\uff0c$x_i\\propto \\frac{1}{\\sqrt{k_{G_i}}}$\u3002\n\n\u53c8\u7531$S=x(\\sum \\sqrt{k_{G_i}})^2$\uff0c\u6700\u7ec8\u6211\u4eec\u4e0d\u96be\u5f97\u5230\uff1a\n$$x_i=\\frac{x\\sum \\sqrt{k_{G_i}}}{\\sqrt{k_{G_i}}}$$\n\n\u8fd9\u6837\uff0c\u5bf9\u4e8e$G$\u7684\u6240\u6709\u5b50\u7535\u963b\u7f51\u7edc$G'$\uff0c\u9012\u5f52\u5730\u8ba1\u7b97\u51fa$k_{G'}$\uff0c\u518d\u6839\u636e\u4e0a\u8ff0\u4e0d\u7b49\u5f0f\u7684\u53d6\u7b49\u6761\u4ef6\u6784\u9020\u51fa\u6bcf\u4e00\u4e2a\u7535\u963b\u5bf9\u5e94\u7684\u7535\u963b\u3002\n\n\u53ef\u4ee5\u7528long double\u50a8\u5b58\u53d8\u91cf\uff0c\u6700\u540e\u8bbe\u5b9a$eps$\u6765\u5224\u65ad\u662f\u5426\u6bcf\u4e2a\u7535\u963b\u7684\u963b\u503c\u90fd\u662f\u6574\u6570\u5373\u53ef\u3002\u5982\u679cWA\u4e86\u53ef\u4ee5\u8c03\u8c03$eps$\u7684\u503c\u3002\u3001\n\n\u7ec6\u8282\u4e0a\uff0c\u4e2a\u4eba\u5efa\u8bae\u5728\u8f93\u5165\u5b57\u7b26\u4e32\u7684\u6bcf\u4e2a\u5355\u72ec\u7684*\u524d\u540e\u52a0\u5165(\u548c\uff09\uff0c\u5904\u7406\u65f6\u7ec6\u8282\u4f1a\u7565\u5c11\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <algorithm>\n#include <vector>\n#include <cmath>\n#define inf (1ll<<62)\n#define eps 1e-6\n\nusing namespace std;\ntypedef long long ll;\ntypedef long double ld;\nconst int MAXN = 1000005;\nchar str[MAXN];\nint n,tr,num[MAXN],pi[MAXN],stack[MAXN],nxt[MAXN],top,cnt;\nll rat[MAXN];\nld ans[MAXN];\nbool check;\ninline ll solve(int l, int r)\n{\n\tif(r-l==2)\n\t    return 1;\n\tbool now = str[pi[l+1]+1]=='S';\n\tvector<ll> tmp;\n\tint pos = l+1;\n\twhile(pos!=r)\n\t{\n\t\trat[pos] = solve(pos,pi[pos]);\n        tmp.push_back(rat[pos]);\n\t    pos = nxt[pi[pos]+1];\n\t}\n\tll sum = 0, mina = inf;\n\tfor(int i = 0; i<tmp.size(); i++)\n\t    sum += floor(sqrt(tmp[i])), mina = min(mina,tmp[i]);\n\treturn now?mina:(sum*sum);\n}\ninline void construct(int l, int r, ld rr)\n{\n\tif(rr<eps&&rr>-eps)\n\t    return;\n\tif(r-l==2)\n\t{\n\t    ans[num[l+1]] = rr;\n\t    return;\n\t}\n\tbool now = str[pi[l+1]+1]=='S';\n\tint pos = l+1;\n\tvector<ll> tmp;\n\twhile(pos!=r)\n\t{\n        tmp.push_back(pos);\n        pos = nxt[pi[pos]+1];\n    }\n    ll sum = 0, mina = inf, minpos = 0;\n    for(int i = 0; i<tmp.size(); i++)\n    {\n        sum += floor(sqrt(rat[tmp[i]]));\n        if(rat[tmp[i]]<mina)\n            mina = rat[tmp[i]], minpos = tmp[i];\n\t}\n\tif(now)\n\t{\n        for(int i = 0; i<tmp.size(); i++)\n            construct(tmp[i],pi[tmp[i]],rr*(tmp[i]==minpos));\n    }\n\telse\n        for(int i = 0; i<tmp.size(); i++)\n            construct(tmp[i],pi[tmp[i]],rr*sum/floor(sqrt(rat[tmp[i]])));\n}\n\nint main()\n{\n    int T;\n    cin >> T;\n    while(T--)\n    {\n        scanf(\"%d\",&tr);\t\n        char c = 0;\n        n = cnt = 0;\n\t\twhile(1)\n\t    {\n\t        c = getchar();\n\t        if(c=='\\r'||c=='\\n')\n\t            break;\n\t        if(c==' ')\n\t            continue;\n\t        if(c=='*')\n\t\t\t    str[++cnt] = '(', str[++cnt] = c, str[++cnt] = ')';\n\t\t\telse\n\t\t\t    str[++cnt] = c;\n\t\t}\n\t\tfor(int i = 1; i<=cnt; i++)\n\t\t{\n\t        if(str[i]=='(')\n\t\t\t    stack[++top] = i;\n\t\t\tif(str[i]==')')\n\t\t\t    pi[stack[top--]] = i;\n\t\t\tif(str[i]=='*')\n\t\t\t    num[i] = ++n;\n\t\t}\n\t\tnxt[cnt+1] = cnt+1;\n\t\tfor(int i = cnt; i>=1; i--)\n\t\t    nxt[i] = (str[i]==')'||str[i]=='(')?i:nxt[i+1];\n\t\tcheck = true;\n\t\tsolve(1,cnt), construct(1,cnt,tr);\n\t\tfor(int i = 1; i<=n; i++)\n\t\t{\n\t        ll tmp = (ll)(ans[i]+0.5);\n\t        if(ans[i]<tmp-eps||ans[i]>tmp+eps)\n\t            check = false;\n\t\t}\n\t\tif(check)\n\t\t{\n\t\t    printf(\"REVOLTING \");\n\t\t    for(int i = 1; i<=n; i++)\n\t            printf(\"%lld \",(ll)(ans[i]+eps));\n\t        printf(\"\\n\");\n\t\t}\n\t\telse\n\t\t    printf(\"LOSS\\n\");\n\t\tfor(int i = 1; i<=n; i++)\n\t\t    ans[i] = 0;\n\t}  \n\treturn 0;\n}\n```\n",
        "postTime": 1579873959,
        "uid": 31098,
        "name": "Caro23333",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1280E \u3010Kirchhoff's Current Loss\u3011"
    },
    {
        "content": "\u6211\u4eec\u5148\u5c06\u6bcf\u4e2a\u7535\u963b\u7684\u963b\u503c\u7684\u9650\u5236\u6269\u5927\u5230**\u975e\u8d1f\u5b9e\u6570**\u3002\n\n\u90a3\u4e48\u6b64\u65f6\u5c31\u5bb9\u6613\u8bc1\u660e\u7b54\u6848 $f(R)$ \u662f\u5173\u4e8e $R$ \u7684\u7ebf\u6027\u51fd\u6570\uff0c\u5373\u5b58\u5728 $c$ \u4f7f\u5f97 $f(R)=cR$\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e\u4e00\u4e2a\u4e32\u8054\u7535\u963b\uff0c\u5b83\u76f8\u5f53\u4e8e\u9650\u5b9a $R=\\sum R_i$\uff0c\u6c42 $\\sum c_iR_i$ \u7684\u6700\u5c0f\u503c\u3002\u90a3\u6211\u4eec\u80af\u5b9a\u4f1a\u9009\u62e9 $c_i$ \u6700\u5c0f\u7684 $i$ \u8ba9\u5b83\u627f\u62c5\u6240\u6709\u7684\u7535\u963b\u3002\u6240\u4ee5\u6211\u4eec\u8fd9\u91cc\u5f97\u51fa\u7684\u7ed3\u8bba\u662f\u4e32\u8054\u7535\u963b\u65f6\u4f1a\u9009\u62e9\u5176\u4e2d\u4e00\u5757\u627f\u62c5\u6240\u6709\u7535\u963b\uff0c\u5176\u5b83\u7684\u5730\u65b9\u90fd\u662f $0$\u3002\n\n\u56e0\u6b64\uff0c\u6700\u540e\u7684\u6700\u4f18\u89e3\u4e00\u5b9a\u53ef\u4ee5\u7b49\u6548\u6210\u90fd\u662f\u5e76\u8054\u7684\u7535\u963b\u3002\u800c\u6211\u4eec\u53d1\u73b0\u5e76\u8054\u7684\u5f62\u5f0f\u53ea\u4e0e $R_i^{-1}$ \u6709\u5173\uff0c\u7b80\u5355\u63a8\u5bfc\u4e00\u4e0b\u5c31\u53ef\u4ee5\u53d1\u73b0\u8fd9\u53ef\u4ee5\u770b\u6210\u6240\u6709\u7535\u963b\u90fd\u5e76\u8054\u5728\u4e00\u8d77\u3002\u90a3\u4e48\u6b64\u65f6\u5c31\u662f $R^{-1}=\\sum R_i^{-1}$\uff0c\u6c42 $\\sum R_i$ \u7684\u6700\u5c0f\u503c\uff0c\u7531\u67ef\u897f\u4e0d\u7b49\u5f0f\u5bb9\u6613\u5f97\u5230 $R_i$ \u662f\u5168\u90e8\u76f8\u7b49\u7684\uff0c\u4e14\u7b49\u4e8e\u53c2\u4e0e\u8ba1\u7b97\u7684\u7535\u963b\u6570\u3002**\u6211\u4eec\u6ce8\u610f\u5230\u6b64\u65f6 $R_i$ \u90fd\u662f\u975e\u8d1f\u6574\u6570**\u3002\n\n\u6240\u4ee5\u505a\u4e00\u4e2a\u6811\u5f62 DP \u5c31\u597d\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$\u3002\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<map>\n#include<set>\n#include<queue>\nusing namespace std;\n\ntypedef long long ll;\nconst int MAXN=5e5+5;\n\ntemplate<typename T> void chkmax(T& x,T y){if(y>x)x=y;}\ntemplate<typename T> void chkmin(T& x,T y){if(y<x)x=y;}\n\nint T,R,stk[MAXN],slen,Tlen,typ[MAXN];\nstruct node{int v,next;}E[MAXN];int head[MAXN],Elen;\nvoid add(int u,int v){\n\t++Elen,E[Elen].v=v,E[Elen].next=head[u],head[u]=Elen;\n}\nint siz[MAXN],wson[MAXN];\nvoid dfs(int u){\n\tif(typ[u]==-2){\n\t\twson[u]=0;\n\t\tfor(int i=head[u];i;i=E[i].next){\n\t\t\tdfs(E[i].v);\n\t\t\tif(!wson[u]||siz[E[i].v]<siz[wson[u]])wson[u]=E[i].v;\n\t\t}\n\t\tsiz[u]=siz[wson[u]];\n\t}else if(typ[u]==-3){\n\t\tsiz[u]=0;\n\t\tfor(int i=head[u];i;i=E[i].next)dfs(E[i].v),siz[u]+=siz[E[i].v];\n\t}else siz[u]=1;\n}\nvoid dfs2(int u,bool flag){\n\tif(typ[u]==0)printf(\" %lld\",flag?1ll*siz[Tlen]*R:0);\n\telse if(typ[u]==-2)for(int i=head[u];i;i=E[i].next)dfs2(E[i].v,flag&(E[i].v==wson[u]));\n\telse for(int i=head[u];i;i=E[i].next)dfs2(E[i].v,flag);\n}\nint main(){\n\tscanf(\"%d\",&T);\n\twhile(T--){\n\t\tscanf(\"%d\",&R);\n\t\tslen=0;Tlen=0;\n\t\tchar c;\n\t\tdo{\n\t\t\tc=getchar();\n\t\t\tif(c=='(')stk[++slen]=-1;\n\t\t\telse if(c=='*')stk[++slen]=++Tlen;\n\t\t\telse if(c=='S')stk[++slen]=-2;\n\t\t\telse if(c=='P')stk[++slen]=-3;\n\t\t\telse if(c==')'){\n\t\t\t\tint tp=0;vector<int> V;\n\t\t\t\twhile(stk[slen]!=-1){\n\t\t\t\t\tif(stk[slen]>0)V.push_back(stk[slen]);\n\t\t\t\t\telse tp=stk[slen];\n\t\t\t\t\t--slen;\n\t\t\t\t}\n\t\t\t\t++Tlen;for(int i=0;i<V.size();++i)add(Tlen,V[i]);\n\t\t\t\ttyp[Tlen]=tp;\n\t\t\t\t--slen,stk[++slen]=Tlen;\n\t\t\t}else continue;\n\t\t}while(c!='\\n'&&c!=EOF);\n\t\tdfs(Tlen);\n\t\tprintf(\"REVOLTING\");\n\t\tdfs2(Tlen,1);\n\t\tputchar('\\n');\n\t\tElen=0;for(int i=1;i<=Tlen;++i)head[i]=typ[i]=0;\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1631259487,
        "uid": 62308,
        "name": "Mr_Wu",
        "ccfLevel": 10,
        "title": "CF1280E Kirchhoff's Current Loss"
    },
    {
        "content": "[My Blog](https://www.cnblogs.com/whx666/p/607-div1.html#e)\n\n\u5bf9\u4e8e\u4e00\u4e2a\u5f62\u6001\u56fa\u5b9a\u7684\u7535\u963b\u7f51\u7edc\uff0c\u8bbe $g(R)$ \u8868\u793a\u7535\u8def\u963b\u503c\u4e3a $R$ \u65f6\u5404\u4e2a\u7535\u963b\u963b\u503c\u548c\u7684\u6700\u5c0f\u503c\u3002\u628a\u8fd9\u4e2a\u5e26\u62ec\u53f7\u7684\u5e8f\u5217\u5bf9\u5e94\u5230\u6811\u4e0a\uff0c\u8981\u6c42\u7684\u5c31\u662f\u6839\u8282\u70b9\u7684 $g$ \u51fd\u6570\u5173\u7cfb\u5f0f\u3002\u66f4\u8fdb\u4e00\u6b65\uff0c\u4e0d\u96be\u53d1\u73b0 $g$ \u5176\u5b9e\u662f\u4e00\u4e2a\u6b63\u6bd4\u4f8b\u51fd\u6570\uff0c\u8bbe $f(x)$ \u4e3a\u8282\u70b9 $x$ \u5904\u7684 $g$ \u51fd\u6570\u7cfb\u6570\u3002\u5982\u679c\u6ca1\u6709\u6574\u6570\u7684\u9650\u5236\uff0c\u8003\u8651\u5982\u4f55\u6c42\u5f97 $f$\u3002\n\n1\u3001\u5982\u679c $x$ \u8282\u70b9\u7684\u513f\u5b50\u662f\u4e32\u8054\u5173\u7cfb\uff0c\u663e\u7136\uff0c\u6700\u4f18\u7684\u529e\u6cd5\u662f\u628a\u6240\u6709\u7684\u7535\u963b\u90fd\u52a0\u5728 $f$ \u6700\u5c0f\u7684\u90a3\u4e2a\u513f\u5b50\u4e0a\uff0c\u5176\u4ed6\u653e\u7a7a\u3002**\u5373 $f_x=min(f_y)$**\n\n2\u3001\u5982\u679c\u662f\u4e32\u8054\uff0c\u5217\u51fa\u4e24\u4e2a\u5f0f\u5b50\uff0c$\\frac{1}{R_x}=\\sum\\frac{1}{R_y}\uff0csum=\\sum f_yR_y\uff0cy\\in son(x)$\uff0c\u7531\u7b2c\u4e00\u4e2a\u5f0f\u5b50\u53ef\u5f97 $R_x\\sum\\frac{1}{R_y}=1$\uff0c\u8054\u60f3\u5230\u201c1\u201d\u7684\u5999\u7528\uff0c\u628a\u8fd9\u4e2a\u4e1c\u897f\u653e\u5165\u7b2c\u4e8c\u4e2a\u5f0f\u5b50\uff1a$sum=R_x\\sum\\frac{1}{R_y}\\sum f_yR_y=R_x\\sum(\\frac{1}{\\sqrt{R_y}})^2\\sum \\sqrt{f_yR_y}^2$\u3002\u5957\u7528\u67ef\u897f\u4e0d\u7b49\u5f0f\u7684\u53d6\u7b49\u6761\u4ef6\uff0c\u5f53\u53d6\u503c\u6700\u5c0f\u65f6\u6709 $\\frac{1}{\\sqrt{f_yR_y^2}}=m$\uff08$m$ \u4e3a\u5b9a\u503c\uff09\u3002\u90a3\u4e48 $\\frac{1}{R_y}\\propto \\sqrt{f_y}$\uff0c\u800c $\\sum\\frac{1}{R_y}$ \u4e3a\u5b9a\u503c\uff0c\u90a3\u4e48 $\\frac{1}{R_y}$ \u6309\u7167\u6bd4\u4f8b\u5206\u914d\u3002\u53ef\u5f97 $R_y=R_x\\frac{\\sum\\sqrt{f_z}}{\\sqrt{f_y}}$\u3002**\u5e26\u5165\u53ef\u5f97 $\\sqrt{f_x}=\\sum\\sqrt{f_y}$**\n\n\u518d\u56de\u6765\u770b\u6574\u6570\u7684\u9650\u5236\n\n1\u3001\u5bf9\u4e8e\u53f6\u5b50\u8282\u70b9\u6709 $f_x=1$\uff0c\u662f\u5b8c\u5168\u5e73\u65b9\u6570\n\n2\u3001\u5bf9\u4e8e\u7b2c\u4e00\u79cd\u8f6c\u79fb\uff0c\u5982\u679c $f_y$ \u5168\u662f\u5b8c\u5168\u5e73\u65b9\u6570\u90a3\u4e48 $f_x$ \u4e5f\u4e00\u5b9a\u662f\n\n3\u3001\u5bf9\u4e8e\u7b2c\u4e8c\u79cd\u8f6c\u79fb\uff0c$f_y$ \u662f\u5b8c\u5168\u5e73\u65b9\u6570\uff0c$\\sqrt{f_y}$ \u662f\u6574\u6570\uff0c$\\sqrt{f_x}$ \u662f\u6574\u6570\uff0c$f_x$ \u4f9d\u7136\u662f\u4e00\u4e2a\u5b8c\u5168\u5e73\u65b9\u6570\n\n\u90a3\u4e48\uff0c\u6574\u6570\u7684\u9650\u5236\u4f5c\u5e9f\u4e86\n\n\u8ba1\u7b97\u5177\u4f53\u963b\u503c\u7684\u65f6\u5019\u53ef\u4ee5\u6309\u7167\u6784\u9020\u65b9\u6cd5\u5f80\u91cc\u9762\u5e26\uff0c\u66f4\u7b80\u6d01\u7684\u505a\u6cd5\uff1a\u60c5\u51b5 $1$ \u7684\u6784\u9020\u65b9\u6cd5\u610f\u5473\u7740\u591a\u4e2a\u4e32\u8054\u7684\u7535\u963b\u4e2d\u53ea\u4f1a\u9009\u4e00\u4e2a\u3002\u6839\u636e\u7535\u8def\u5206\u6790\u7684\u57fa\u7840\u77e5\u8bc6\u53ef\u4ee5\u53d1\u73b0\uff0c\u6700\u540e\u9009\u51fa\u7684\u7535\u963b\u90fd\u53ef\u4ee5\u770b\u4f5c\u5e76\u8054\u5173\u7cfb\uff0c\u90a3\u4e48\u770b\u4e00\u4e0b\u6709\u51e0\u4e2a\u7535\u963b\u7528\u5230\u5c31\u53ef\u4ee5\u76f4\u63a5\u7b97\u4e86\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\nvoid read (int &x) {\n    char ch = getchar(); x = 0; while (!isdigit(ch)) ch = getchar();\n    while (isdigit(ch)) x = x * 10 + ch - 48, ch = getchar();\n} const int N = 2e5 + 5, M = 5e5 + 5;\nint n, dfn, st[N], tag[N], to[N], f[N], vis[N], id[N];\nchar a[M]; vector<int> g[N];\n#define pb push_back\nvoid build () {\n    int num = 0, tp = 0;\n    for (int i = 1; i <= n; ++i) {\n        if (a[i] == '(') {\n            g[++num].clear();\n            if (tp) g[st[tp]].pb (num);\n            st[++tp] = num;\n            to[num] = vis[num] = f[num] = 0;\n        } else if (a[i] == '*') {\n            g[++num].clear();\n            if (tp) g[st[tp]].pb (num);\n            to[num] = vis[num] = f[num] = 0;\n        }\n        else if (a[i] == 'S') tag[st[tp]] = 0;\n        else if (a[i] == 'P') tag[st[tp]] = 1;\n        else if (a[i] == ')') --tp;\n    }\n}\nvoid dfs (int u) {\n    if (!g[u].size()) { f[u] = 1, id[u] = ++dfn; return; }\n    for (int v : g[u]) dfs (v);\n    if (tag[u] == 0) { // \u4e32\u8054\u76f4\u63a5\u627e\u7cfb\u6570\u6700\u5c0f\u7684\n        int mn = 0;\n        for (int v : g[u]) if (f[mn] > f[v]) mn = v;\n        to[u] = mn, f[u] = f[mn];\n    } else { // \u4e32\u8054\u76f4\u63a5\u52a0\u548c\n        for (int v : g[u]) f[u] += f[v];\n    }\n} int cnt;\nvoid getcnt (int u) {\n    if (!g[u].size()) { vis[id[u]] = 1, ++cnt; return; }\n    if (!tag[u] && to[u]) getcnt (to[u]);\n    else for (int v : g[u]) getcnt (v);\n}\nsigned main() {\n    int T; read (T);\n    while (T--) {\n        int R; scanf (\"%lld\", &R);\n        cin.getline (a, 5e5); n = strlen (a + 1);\n        build (); f[0] = 2e9;\n        dfn = 0, dfs (1);\n        cnt = 0; getcnt (1);\n        printf (\"REVOLTING \");\n        for (int i = 1; i <= dfn; ++i)\n            printf (\"%lld \", vis[i] ? cnt * R : 0ll);\n        putchar ('\\n');\n    }\n    return 0;\n}\n```",
        "postTime": 1620219096,
        "uid": 84619,
        "name": "\u6e05\u5c18",
        "ccfLevel": 0,
        "title": "CF1280E Kirchhoff's Current Loss"
    },
    {
        "content": "\u521d\u4e2d\u7269\u7406\u96be\u5ea6233\n\n\u8003\u8651\u4e00\u4e2a $n$ \u4e2a\u7535\u963b\u5e76\u8054\u7684\u7ed3\u6784\uff0c\u82e5\u8981\u8ba9\u5176\u963b\u503c\u4e3a $R$ \u4e14\u548c\u6700\u5c0f\uff0c\u5f88\u5bb9\u6613\u731c\u6d4b\u5f97\u6bcf\u4e2a\u7535\u963b\u963b\u503c\u4e3a $nR$\u3002\n\n\u8bc1\u660e\u5982\u4e0b\uff1a\n\n\u5f52\u7eb3\u3002$n=1$ \u65f6\u6210\u7acb\u3002\n\n$n>1$ \u65f6\uff0c\u8bbe\u4e00\u4e2a\u7535\u963b\u7684\u963b\u503c\u4e3a $r$\uff0c\u5176\u4f59\u7684\u963b\u503c\u4e4b\u548c\u5e94\u4e3a $\\dfrac {rR(n-1)^2} {r-R}$\uff0c\u548c\u4e3a $\\dfrac {rR(n-1)^2} {r-R}+r$ \u5373 \n\n\u8bbe $t=r-R$\uff0c\u5219\u4e3a\n\n$$R(n+1)^2+\\dfrac {R^2(n-1)^2} t+t+R$$\n\n\u5f88\u660e\u663e $t$ \u53d6 $R(n-1)$ \u65f6\u4e0a\u5f0f\u6700\u5c0f\uff0c\u5373\u5f53 $r=nR$ \u65f6\u7535\u963b\u603b\u548c\u6700\u5c0f\u3002\u8bc1\u6bd5\u3002\n\n\u7136\u540e\u5f88\u660e\u663e\u6bcf\u4e2a\u7535\u8def\u90fd\u7b49\u6548\u4e8e\u4e00\u4e2a\u4e0a\u8ff0\u7ed3\u6784\uff0c\u7528\u5f52\u7eb3\u7684\u601d\u60f3\u5c31\u662f\uff1a\n\n* \u5982\u679c\u5c06\u82e5\u5e72\u4e2a\u4e0a\u8ff0\u7535\u8def\u5e76\u8054\uff0c\u663e\u7136\u7b49\u4ef7\u4e8e\u4e00\u4e2a\u5927\u7684\u4e0a\u8ff0\u7535\u8def\n* \u5982\u679c\u5c06\u82e5\u5e72\u4e2a\u4e0a\u8ff0\u7535\u8def\u4e32\u8054\uff0c\u4e00\u4e2a\u89c4\u6a21\u4e3a $n$ \u7684\u4e0a\u8ff0\u7535\u8def\u4ee3\u4ef7\u4e3a $n^2R$\uff0c\u663e\u7136\u53ea\u4fdd\u7559\u6700\u5c0f\u7684\u90a3\u4e2a\u5c31\u884c\n\n\u62ec\u53f7\u5339\u914d\u3002",
        "postTime": 1682071521,
        "uid": 203623,
        "name": "Ntokisq",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1280E Kirchhoff's Current Loss"
    }
]
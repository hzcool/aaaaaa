[
    {
        "content": "\u8003\u8651\u6734\u7d20\u7684 dp\u3002\n\n\u8bbe $f_i$ \u8868\u793a\u5230\u6839\u8282\u70b9\u8ddd\u79bb\u6070\u597d\u4e3a $i$ \u7684\u70b9\u7684\u4e2a\u6570\u3002\n\n\u663e\u7136\u6709 $f_i=\\sum\\limits_{j=1}^n f_{i-d_j}$\uff0c\u8f6c\u79fb\u4e4b\u540e\u7d2f\u52a0\u4e00\u4e0b\u5373\u4e3a\u7b54\u6848\u3002\n\n\u518d\u8003\u8651\u4f18\u5316\u8fd9\u4e2a\u4e1c\u897f\u3002\n\n\u56e0\u4e3a $1\\leq d_i\\leq 100$\uff0c\u6240\u4ee5\u5f88\u591a $f_{i-d_j}$ \u90fd\u4f1a\u88ab\u91cd\u590d\u8ba1\u7b97\u3002\n\n\u4e8e\u662f\u53ef\u4ee5\u8003\u8651\u5c06 $d$ \u6570\u7ec4\u79bb\u6563\u5316\uff0c\u5b58\u5230\u4e00\u4e2a\u6876\u91cc\u3002\n\n\u4e8e\u662f\u8f6c\u79fb\u65b9\u7a0b\u5c31\u53d8\u6210\u4e86 $f_i=\\sum\\limits_{j=1}^{100} t_j\\times f_{i-j}$\u3002\n\n\u5176\u4e2d $t_j$ \u8868\u793a  $d_i=j$ \u7684\u4e2a\u6570\u3002\n\n\u7136\u540e\u8fd9\u4e2a\u67ff\u5b50\u663e\u7136\u5c31\u6bd4\u4e4b\u524d\u7684\u90a3\u4e2a\u4f18\u7f8e\u591a\u4e86\uff0c\u53ef\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\u3002\n\n\u8bb0 $sum_i=\\sum\\limits_{j=1}^i f_j$\u3002\n\n\u5219\u6709\u4e0b\u9762\u7684\u8fd9\u4e2a\u8f6c\u79fb\u77e9\u9635\uff1a\n$$\n\\begin{bmatrix}1&t_1&t_2&t_3&t_4&\\cdots&t_{100}\\\\0&t_1&t_2&t_3&t_4&\\cdots&t_{100}\\\\0&1&0&0&0&\\cdots&0\\\\0&0&1&0&0&\\cdots&0\\\\0&0&0&1&0&\\cdots&0\\\\\\vdots&\\ddots&\\ddots&\\ddots&\\ddots&\\ddots&\\vdots\\\\0&\\cdots&0&0&0&1&0\\end{bmatrix}\\times\\begin{bmatrix}sum_{i-1}\\\\f_{i-1}\\\\f_{i-2}\\\\f_{i-3}\\\\f_{i-4}\\\\\\vdots\\\\f_{i-100}\\end{bmatrix}=\\begin{bmatrix}sum_{i}\\\\f_{i}\\\\f_{i-1}\\\\f_{i-2}\\\\f_{i-3}\\\\\\vdots\\\\f_{i-99}\\end{bmatrix}\n$$\n\u5176\u4e2d\u77e9\u9635\u4ece\u7b2c 3 \u884c\u5f00\u59cb\u5230\u7b2c 101 \u884c\u662f\u4e2a\u50cf\u5355\u4f4d\u77e9\u9635\u4e00\u6837\u7684\u4e1c\u897f\uff0c\u4e5f\u5c31\u662f\u659c\u7740\u7684\u4e00\u6392 $1$\u3002\uff08\u53ef\u80fd\u6211\u6587\u5b57\u8868\u8ff0\u4e0d\u662f\u5f88\u6e05\u6670\uff0c\u53ef\u4ee5\u7ed3\u5408\u4ee3\u7801\u4e2d\u7684\u6784\u9020\u65b9\u6cd5\u7406\u89e3\uff09\n\n\u6784\u9020\u65b9\u6cd5\u662f\u633a\u6a21\u677f\u7684\u4e00\u4e2a\u4e1c\u897f\uff0c\u56e0\u6b64\u5728\u8fd9\u91cc\u5c31\u4e0d\u8d58\u8ff0\u4e86\u3002\n\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\uff0c\u77e9\u9635\u5feb\u901f\u5e42\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(100^3\\log x)$\u3002\n\n~~PS\uff1avp \u65f6\u6253\u7684\u4ee3\u7801\uff0c\u65f6\u95f4\u7d27\u5f20\uff0c\u5199\u5f97\u6709\u70b9\u4e71\uff0c\u5927\u5bb6\u51d1\u5408\u7740\u770b\u5427\uff08~~\n\n$\\texttt{Code Below}$\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int N=1e2+5;\nconst ll p=1e9+7;\n\ninline int read()\n{\n\tregister int s=0;\n\tregister char c=getchar(),lc='+';\n\twhile (c<'0'||'9'<c) lc=c,c=getchar();\n\twhile ('0'<=c&&c<='9') s=s*10+c-'0',c=getchar();\n\treturn lc=='-'?-s:s;\n}\nvoid write(register int x)\n{\n\tif (x<0)\n\t{\n\t\tputchar('-');\n\t\tx=-x;\n\t}\n\tif (x<10) putchar(x+'0');\n\telse\n\t{\n\t\twrite(x/10);\n\t\tputchar(x%10+'0');\n\t}\n}\ninline void print(const register int x,const register char c='\\n')\n{\n\twrite(x);\n\tputchar(c);\n}\nstruct node\n{\n\tll m[N][N];\n}a;\nstruct node2\n{\n\tll m[N];\n}ans;\nnode operator *(node a,node b)\n{\n\tnode ans;\n\tfor (int i=0;i<=100;i++)\n\tfor (int j=0;j<=100;j++) ans.m[i][j]=0;\n\tfor (int i=0;i<=100;i++)\n\tfor (int j=0;j<=100;j++)\n\tfor (int k=0;k<=100;k++) ans.m[i][j]=(ans.m[i][j]+a.m[i][k]*b.m[k][j]%p)%p;\n\treturn ans;\n}\nnode2 operator *(node2 a,node b)\n{\n\tnode2 ans;\n\tfor (int i=0;i<=100;i++) ans.m[i]=0;\n\tfor (int i=0;i<=100;i++)\n\tfor (int k=0;k<=100;k++) ans.m[i]=(ans.m[i]+b.m[i][k]*a.m[k]%p)%p;\n\treturn ans;\n}\nint t[101];\n\nint main()\n{\n\tmemset(t,0,sizeof(t));\n\tmemset(a.m,0,sizeof(a.m));\n\tmemset(ans.m,0,sizeof(ans.m));\n\tint n=read(),k=read();\n\tfor (int i=1;i<=n;i++)\n\t{\n\t\tint x=read();\n\t\tt[x]++;\n\t}\n\ta.m[0][0]=1;\n\tfor (int i=1;i<=100;i++) a.m[0][i]=a.m[1][i]=t[i];\n\tfor (int i=2;i<=100;i++) a.m[i][i-1]=1;\n\tans.m[0]=1;//sum[0]=1\n\tans.m[1]=1;//f[0]=1\n\twhile (k)\n\t{\n\t\tif (k&1) ans=ans*a;\n\t\ta=a*a;\n\t\tk/=2;\n\t}\n\tprint(ans.m[0]);\n\n    return 0;\n}\n```\n\n",
        "postTime": 1602554183,
        "uid": 61120,
        "name": "QwQcOrZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF514E \u3010Darth Vader and Tree\u3011"
    },
    {
        "content": "\u77e9\u9635\u52a0\u901f\u4f18\u5316 DP\n\n\u7b2c\u4e8c\u9053\u72ec\u7acb\u81ea\u4e3b\u5199\u51fa\u6765\u7684\u9ed1\u9898\uff01\n\n\u9996\u5148\u63a8\u6734\u7d20 DP \u7684\u65b9\u7a0b\uff1a\n\n\u8bbe $dp_i$ \u4e3a\u5230\u6839\u8282\u70b9\u8ddd\u79bb\u4e3a $i$ \u7684\u70b9\uff1a\n\n\u663e\u7136\uff0c\u65b9\u7a0b\u5c31\u662f\u7d2f\u52a0\u5230\u4ed6\u8ddd\u79bb\u4e3a $d_i$ \u7684\u70b9\u7684 $dp$ \u503c\uff1a\n\n$$dp_i=\\sum_{j=1}^{n}dp_{i-d_j}$$\n\n\u7136\u540e\u5bf9\u5176\u8fdb\u884c\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\uff0c$O(n^3\\log x)$ \u76f4\u63a5 $T$ \u98de\u3002\n\n\u89c2\u5bdf\u6570\u636e\u8303\u56f4\u53d1\u73b0 $d_i$ \u7684\u503c\u5f88\u5c0f\uff0c\u4e8e\u662f\u8003\u8651\u5bf9\u5176\u5f00\u4e00\u4e2a\u6876\u8fdb\u884c\u7edf\u8ba1\uff0c\u6876\u8bb0\u4e3a $tmp$ \u6570\u7ec4\uff1a\n\n$$dp_i=\\sum_{j=1}^{100}tmp_j\\times dp_{i-j}$$\n\n\u6700\u540e\u5bf9\u5176\u6c42\u524d\u7f00\u548c\uff0c\u5219\u6709\uff1a\n\n$$S_i=\\sum_{i=1}^{x}dp_i$$\n\n\u4e8e\u662f\u8fdb\u884c\u77e9\u9635\u52a0\u901f\u4f18\u5316\uff0c\u73c2\u63a8\u5f97\uff1a\n\n$$\n\\begin{bmatrix} \n\t1 & tmp_1 & tmp_2 &\u2026\u2026 & tmp_{100}\n\\\\\t0 & tmp_1 & tmp_2 &\u2026\u2026 & tmp_{100}\n\\\\  0 & 1 & 0 & \u2026\u2026 & 0\n \\\\ \u2026\u2026 & \u2026\u2026 & \u2026\u2026 & \u2026\u2026 & \u2026\u2026\n \\\\ 0 & \u2026\u2026 & 1 & 0 & 0\n \\\\\t0 & 0 & \u2026\u2026 & 1 & 0\n\\end{bmatrix}\\quad\n\\times\n\\begin{bmatrix} \n\tS_{i-1}\n\\\\\tdp_{i-1}\n\\\\  dp_{i-2}\n \\\\ dp_{i-3}\n \\\\ \u2026\u2026\n \\\\\tdp_{i-101}\n\\end{bmatrix}\\quad\n\n=\n\n\\begin{bmatrix} \n\tS_{i}\n\\\\\tdp_{i}\n\\\\  dp_{i-1}\n \\\\ dp_{i-2}\n \\\\ \u2026\u2026\n \\\\\tdp_{i-100}\n\\end{bmatrix}\\quad\n$$\n\n\u5bf9\u4e8e\u524d $100$ \u6570\uff0c\u76f4\u63a5\u66b4\u529b DP \u9884\u5904\u7406\u51fa\u7ed3\u679c\u5373\u53ef\u3002\n\n\u8fd9\u662f\u66b4\u529b DP \u7684\u9884\u5904\u7406\uff1a\n```cpp\ndp[0]=1;\ns[0]=1;\nfor(int i=1;i<=100;i++){\n\tfor(int j=1;j<=i;j++)dp[i]=(dp[i]+dp[i-j]*tmp[j]%p)%p;\n\ts[i]=(s[i-1]+dp[i])%p;\n}\n```\n\n\u8fd9\u662f\u6784\u9020\u77e9\u9635\u7684\u5173\u952e\u4ee3\u7801\uff08\u6211\u628a\u77e9\u9635\u5305\u88c5\u5728\u4e86\u7ed3\u6784\u4f53\u91cc\uff0c\u6240\u4ee5\u7565\u663e\u602a\u5f02\uff09\uff1a\n\n```cpp\nstruct matrix{\n\tint m[105][105];\n\tmatrix(){memset(m,0,sizeof(m));}\n\tvoid csh(){for(int i=1;i<=101;i++)m[i][i]=1;}\n\tvoid set1(){\n\t\tmemset(m,0,sizeof(m));\n\t\tm[1][1]=1;\n\t\tfor(int i=2;i<=101;i++)m[1][i]=m[2][i]=tmp[i-1];\n\t\tfor(int i=3;i<=101;i++)m[i][i-1]=1;\n\t}\n\tvoid set2(){\n\t\tm[1][1]=s[100];\n\t\tfor(int i=2;i<=101;i++)m[i][1]=dp[102-i];\n\t}\n\tmatrix operator*(const matrix &a)const{\n\t\tmatrix ans;\n\t\tfor(int k=1;k<=101;k++){\n\t\t\tfor(int i=1;i<=101;i++){\n\t\t\t\tfor(int j=1;j<=101;j++){\n\t\t\t\t\tans.m[i][j]=(ans.m[i][j]+(m[i][k]*a.m[k][j])%p)%p;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn ans;\n\t}\n\tmatrix operator^(int b){\n\t\tmatrix res,a=*this;res.csh(); \n\t\twhile(b){\n\t\t\tif(b&1)res=res*a;\n\t\t\ta=a*a;\n\t\t\tb>>=1;\n\t\t}\n\t\treturn res;\n\t}\n\tvoid print(int n){\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tfor(int j=1;j<=n;j++){\n\t\t\t\tprintf(\"%d \",m[i][j]);\n\t\t\t}\n\t\t\tputs(\"\");\n\t\t}\n\t}\n};\n```\n\n\u5b8c\u7ed3\u6492\u82b1\uff01\n\n",
        "postTime": 1664715413,
        "uid": 285617,
        "name": "\u9ed1\u5f71\u6d1e\u4eba",
        "ccfLevel": 5,
        "title": "CF514E Darth Vader and Tree \u9898\u89e3"
    },
    {
        "content": "## $\\texttt{description}$\n\n\u7ed9\u5b9a\u4e00\u68f5\u65e0\u9650\u5927\u7684 $n$ \u53c9\u6811\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u975e\u6839\u8282\u70b9\u7684\u8282\u70b9\uff0c\u5b83\u5230\u7236\u8282\u70b9\u7684\u8ddd\u79bb\u4e3a $d_i$\uff0c\u5176\u4e2d\uff0c$i$ \u8868\u793a\u5b83\u662f\u7b2c\u51e0\u4e2a\u5b50\u8282\u70b9\u3002\n\n\u73b0\u5728\u95ee\u4e00\u5171\u6709\u591a\u5c11\u8282\u70b9\u5230\u6839\u8282\u70b9\u7684\u8ddd\u79bb\u5c0f\u4e8e\u7b49\u4e8e $x$\uff0c\u5176\u4e2d\uff0c$n {\\color{red} {} \\le {}} 10^5$\uff0c$x {\\color{red} {} \\le {}} 10^9$\uff0c$d_i {\\color{red} {} \\le {}} 100$\u3002\n\n## $\\texttt{Solution}$\n\n\u524d\u7f6e\u77e5\u8bc6\uff1a\u7b80\u5355 DP \u548c\u77e9\u9635\u5feb\u901f\u5e42\u3002\n\n\u8bbe $f_x$ \u8868\u793a \u6709\u591a\u5c11\u4e2a\u8282\u70b9\u8ddd\u79bb\u6839\u8282\u70b9**\u6b63\u597d\u4e3a** $x$\uff0c$t_x$ \u8868\u793a\u6709\u591a\u5c11\u4e2a $d_i$ \u7b49\u4e8e $x$\u3002\n\n\u7531\u4e8e $d$ \u90fd\u5728 $100$ \u4e4b\u5185\uff0c\u6240\u4ee5\u6709\uff1a\n$$\nf_x = \\sum\\limits_{y = 1}^{100}t_y \\times f_{x - y}\n$$\n\u6ce8\u610f\u8fb9\u754c\uff0c$f_0 = 1$\uff0c\u9700\u8981\u6c42\u7684\u5c31\u662f $\\sum\\limits_{i= 1}^x f_i$\u3002\n\n\u53ef\u4ee5\u7528 $s$ \u6570\u7ec4\u8868\u793a $f$ \u7684\u524d\u7f00\u548c\u3002\n\n$f$ \u7684\u524d\u4e00\u767e\u4e2a\u5143\u7d20\u53ef\u4ee5\u6734\u7d20 DP \u6c42\u51fa\u3002\u770b\u5230 $x {\\color{red} {} \\le {}} 10^9$\uff0c\u4e0d\u96be\u8054\u60f3\u5230\u77e9\u9635\u5feb\u901f\u5e42\u3002\n\n\u4e8e\u662f\u6784\u9020\u4e00\u4e2a $101 \\times 101$ \u7684\u77e9\u9635\uff0c\u6709\uff1a\n$$\n\\begin{bmatrix}\n1&t_1&t_2&t_3&t_4&\\cdots&t_{100}\\\\\n0&t_1&t_2&t_3&t_4&\\cdots&t_{100}\\\\\n0&1&0&0&0&\\cdots&0\\\\0&0&1&0&0&\\cdots&0\\\\\n0&0&0&1&0&\\cdots&0\\\\\n0&0&0&0&1&\\cdots&0\\\\\n\\vdots&\\vdots&\\vdots&\\vdots&\\vdots&\\ddots&\\vdots\\\\\n0&\\cdots&0&0&0&1&0\n\\end{bmatrix}\n\n\\times\n\n\\begin{bmatrix}\ns_{i-1}\\\\\nf_{i-1}\\\\\nf_{i-2}\\\\\nf_{i-3}\\\\\nf_{i-4}\\\\\nf_{i-5}\\\\\n\\vdots\\\\f_{i-100}\n\\end{bmatrix}\n\n=\n\n\\begin{bmatrix}\ns_{i}\\\\\nf_{i}\\\\\nf_{i-1}\\\\\nf_{i-2}\\\\\nf_{i-3}\\\\\nf_{i-4}\\\\\n\\vdots\\\\\nf_{i-99}\n\\end{bmatrix}\n$$\n\u5176\u5b9e\u6a2a\u7740\u5199\u53ef\u80fd\u66f4\u5bb9\u6613\u7406\u89e3\uff0c\u4f46\u662f\u6d1b\u8c37\u7684\u663e\u793a\u533a\u592a\u7a84\u4e86\uff0c\u6a2a\u7740\u5199\u5e94\u8be5\u4f1a\u8d85\u51fa\u663e\u793a\u8303\u56f4\u3002\n\n\u540e\u9762\u5c31\u662f\u677f\u5b50\u9898\u4e86\uff0c\u5982\u679c\u8fd8\u4e0d\u4f1a\u8be6\u89c1 [P3390 \u3010\u6a21\u677f\u3011\u77e9\u9635\u5feb\u901f\u5e42](https://www.luogu.com.cn/problem/P3390)\u3002\n\n\u5b8c\u6574\u4ee3\u7801\uff1a\n\n```cpp\n#include <iostream>\n#include <cstring>\n\n#define int long long\nusing namespace std;\n\nconst int N = 110;\nconst int M = 100010;\nconst int mod = 1000000007;\n\nstruct array {\n    int n, m;\n    int a[N][N];\n    array(int x = 0, int y = 0) {\n        n = x, m = y;\n        memset(a, 0, sizeof(a));\n    }\n};\n\nint n, x;\nint t[N];\nint d[M], f[M], sum[M];\n\narray operator * (array x, array y) {\n    array ans(x.n, y.m);\n    for (int i = 1; i <= x.n; i++)\n        for (int j = 1; j <= y.m; j++)\n            for (int k = 1; k <= x.m; k++)\n                ans.a[i][j] = (ans.a[i][j] + (x.a[i][k] * y.a[k][j]) % mod) % mod;\n    return ans;\n}\n\narray power(array a, int b) {\n    array ans(a.n, a.m);\n    for (int i = 1; i <= ans.n; i++) ans.a[i][i] = 1;\n    for (; b; b >>= 1) {\n        if (b & 1) ans = ans * a;\n        a = a * a;\n    }\n    return ans;\n}\n\nsigned main() {\n    cin >> n >> x;\n    for (int i = 1; i <= n; i++) cin >> d[i], t[d[i]]++;\n    f[0] = sum[0] = 1;\n    for (int i = 1; i <= 101; i++) {\n        for (int j = 1; j <= i; j++) f[i] = (f[i] + t[j] * f[i - j]) % mod;\n        sum[i] = (sum[i - 1] + f[i]) % mod;\n    }\n    if (x <= 101) { cout << sum[x] << endl; return 0; }\n    array ans(101, 1);\n    ans.a[1][1] = sum[100];\n    for (int i = 2; i <= 101; i++) ans.a[i][1] = f[101 - (i - 1)];\n    array Ans(ans.n, ans.n);\n    Ans.a[1][1] = 1, Ans.a[2][1] = 0;\n    for (int i = 2; i <= Ans.n; i++) Ans.a[1][i] = Ans.a[2][i] = t[i - 1];\n    for (int i = 3; i <= Ans.m; i++) Ans.a[i][i - 1] = 1;\n    cout << (power(Ans, x - 100) * ans).a[1][1] << endl;\n    return 0;\n}\n```\n\n\n\n",
        "postTime": 1662856080,
        "uid": 574944,
        "name": "Micnation_AFO",
        "ccfLevel": 4,
        "title": "CF514E Darth Vader and Tree \u9898\u89e3"
    },
    {
        "content": "\u4e00\u4e2adp+\u77e9\u9635\u5feb\u901f\u5e42\u7684\u9898\u76ee\u3002  \n\u9898\u610f\uff1a\u7ed9\u51fa\u4e00\u4e2a\u6bcf\u4e2a\u8282\u70b9\u6709 $n$ \u4e2a\u5b69\u5b50\u7684\u591a\u53c9\u6811\uff0c\u7236\u4eb2\u5230\u7b2c $i$ \u4e2a\u5b69\u5b50\u6709\u56fa\u5b9a\u7684\u957f\u5ea6\uff0c\u95ee\u5230\u6839\u8282\u70b9\u7684\u8ddd\u79bb\u4e0d\u8d85\u8fc7 $x$ \u7684\u8282\u70b9\u7684\u6570\u76ee\u3002\n\n\u5f88\u5bb9\u6613\u770b\u51fa\u5f53 $x \\le 100$ \u65f6\uff0c\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a\n\n$dp_i=\\sum_{j=1}^{100}dp_{i-j}\\times cnt_j$\n\n$ans=\\sum_{j=0}^{x}dp_{i}$\n\n\u90a3\u4e48\u56e0\u4e3a\u8fd9\u662f\u7ebf\u6027\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u9884\u5904\u7406\u51fa $100$ \u4ee5\u5185\u7684\u7136\u540e\u7528\u77e9\u9635\u5feb\u901f\u5e42\u52a0\u901f\uff0c\u7136\u540e\u5c31\u505a\u5b8c\u5566\u3002  \n _Code_\n ```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define mod 1000000007\nusing namespace std;\nstruct matrix{\n\tll x,y,a[110][110];\n\tmatrix(){};\n\tmatrix(ll xx,ll yy):x(xx),y(yy){memset(a,0,sizeof(a));}\n}s;\nll n,x,cnt[120],sum[120],dp[120];\ninline ll read(){\n\tregister ll x=0,f=0,ch=getchar();\n\twhile('0'>ch||ch>'9')f^=ch=='-',ch=getchar();\n\twhile('0'<=ch&&ch<='9')x=(x<<1)+(x<<3)+(ch^'0'),ch=getchar();\n\treturn f?-x:x;\n}\ninline matrix mul(matrix A,matrix B){\n\tmatrix C=(matrix){A.x,B.y};\n\tfor(int i=1;i<=A.x;i++)\n\t\tfor(int j=1;j<=B.y;j++)\n\t\t\tfor(int k=1;k<=B.x;k++)\n\t\t\t\tC.a[i][j]=(C.a[i][j]+A.a[i][k]*B.a[k][j])%mod;\n\treturn C;\n}\ninline void init() {\n\tn=read(),x=read();\n\tfor(int i=1;i<=n;i++)\n\t\tcnt[read()]++;\n\tdp[0]=1,sum[0]=1;\n\tfor(int i=1;i<=100;i++) {\n\t\tfor(int j=1;j<=i;j++)\n\t\t\tdp[i]=(dp[i]+dp[i-j]*cnt[j])%mod;\n\t\tsum[i]=(sum[i-1]+dp[i])%mod;\n\t}\n\ts.x=101,s.y=101;\n\tfor(int i=1;i<=99;i++)\n\t\ts.a[i+1][i]=1,s.a[i][100]=cnt[101-i],s.a[i][101]=cnt[101-i];\n\ts.a[100][100]=s.a[100][101]=cnt[1],s.a[101][101]=1;\n}\nmatrix qpow(matrix s,ll b){\n\tmatrix C=(matrix){s.x,s.y};\n\tfor(int i=1;i<=101;i++) C.a[i][i]=1;\n\twhile(b){\n\t\tif(b&1) C=mul(C,s);\n\t\tb>>=1;\n\t\ts=mul(s,s);\n\t}\n\treturn C;\n}\nint main(){\n\tinit();\n\tmatrix A=(matrix){1,101};\n\tfor(int i=1;i<=100;i++)\n\t\tA.a[1][i]=dp[i];\n\tA.a[1][101]=sum[100];\n\tif(x<=100){\n\t\tprintf(\"%lld\\n\",sum[x]);\n\t\treturn 0;\n\t}\n\tA=mul(A,qpow(s,x-100));\n\tprintf(\"%lld\\n\",A.a[1][101]%mod);\n\treturn 0;\n}\n ```",
        "postTime": 1598740144,
        "uid": 181506,
        "name": "Jay142753869",
        "ccfLevel": 5,
        "title": "CF514E Darth Vader and Tree\u9898\u89e3"
    }
]
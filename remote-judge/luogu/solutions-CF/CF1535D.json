[
    {
        "content": "\u770b\u5230\u7b80\u6d01\u7684\u5408\u5e76\u64cd\u4f5c\uff0c\u4e0d\u96be\u60f3\u5230\u7ebf\u6bb5\u6811\u6c42\u89e3\u3002\n\n\u8bb0 $f_i$ \u4e3a\u7b2c $i$ \u5c40\u53ef\u80fd\u7684\u83b7\u80dc\u8005\u4e2a\u6570\u3002\n\n\u5bf9\u4e8e**\u540c\u4e00\u5c42**\u7684\u7b2c $i,j \\ (i<j)$ \u5c40\u6bd4\u8d5b\uff0c\u5047\u8bbe\u4e24\u573a\u6bd4\u8d5b\u7684\u80dc\u5229\u8005\u4f1a\u5728**\u4e0b\u4e00\u8f6e**\u7b2c $k$ \u5c40\u6bd4\u8d5b\u76f8\u9047\uff0c\u90a3\u4e48\u53ef\u4ee5\u5f97\u5230\u5982\u4e0b\u7ed3\u8bba\uff1a\n\n- \u82e5 $s_k=0$\uff0c\u7531\u4e8e\u7b2c $i$ \u5c40\u7684\u80dc\u5229\u8005\u7f16\u53f7\u4e00\u5b9a\u5c0f\u4e8e\u7b2c $j$ \u5c40\u7684\u80dc\u5229\u8005\uff0c\u6240\u4ee5 $f_k=f_i$\u3002\n- \u82e5 $s_k=1$ \u5219\u548c\u4e0a\u9762\u7684\u7ed3\u8bba\u76f8\u53cd\uff0c$f_k=f_j$\u3002\n- \u82e5 $s_k=$ `?`\uff0c\u90a3\u4e48\u4e24\u8fb9\u7684\u53c2\u8d5b\u8005\u90fd\u53ef\u80fd\u83b7\u80dc\uff0c\u6709 $f_k=f_i+f_j$\u3002\n\n\u800c\u6bd4\u8d5b\u7684\u664b\u7ea7\u89c4\u5219\u6bcf\u6b21\u90fd\u662f\u4e8c\u9009\u4e00\uff0c\u6240\u4ee5\u5f88\u9002\u5408\u7528\u7ebf\u6bb5\u6811\u6765\u5408\u5e76\u4fe1\u606f\u3002\n\n----\n\n\u4e0d\u8fc7\u6211\u4eec\u53d1\u73b0\u8fd9\u9898\u7684\u6bd4\u8d5b\u7f16\u53f7\u548c\u7ebf\u6bb5\u6811\u7684\u8282\u70b9\u5b58\u50a8\u7f16\u53f7\u7684\u65b9\u5f0f\u4e0d\u540c\uff0c\u6839\u8282\u70b9\u7f16\u53f7\u6700\u5927\uff0c\u53f6\u5b50\u7ed3\u70b9\u6700\u5c0f\u3002\n\n\u8fd9\u4e2a\u65f6\u5019\uff0c\u6211\u4eec\u53ef\u4ee5\u6539\u53d8\u5b58\u50a8\u6bd4\u8d5b\u7f16\u53f7\u7684\u65b9\u5f0f\u3002\u4f7f\u5f97\u5176\u80fd\u591f\u88ab\u7ebf\u6bb5\u6811\u7ed3\u6784\u5b58\u50a8\uff0c\u5982\u4e0b\u56fe\uff08\u4ece\u8fd9\u91cc\u5f00\u59cb\uff0c\u51e1\u662f\u6570\u5b57\u5916\u6709\u5706\u62ec\u53f7\u7684\u7f16\u53f7\u5747\u4e3a**\u65b0\u7f16\u53f7**\uff09\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/dgjf0mpx.png)\n\n\u8fd9\u6837\u5b58\u50a8\u7684\u4f18\u70b9\u662f\uff0c\u6bcf\u4e00\u5c40\u7684\u9009\u62d4\u89c4\u5219\u4e0e\u539f\u6765\u76f8\u540c\uff0c\u7b2c $(i)$ \u5c40\u7684\u80dc\u5229\u8005\u4e0e\u7b2c $(2i),(2i+1)$ \u5c40\u7684\u80dc\u5229\u8005\u76f8\u5173\u3002\n\n\u4e0d\u8fc7\u7f3a\u70b9\u4e5f\u6709\uff0c\u5c31\u662f\u7ed9\u6bd4\u8d5b\u7f16\u53f7\u6bd4\u8f83\u9ebb\u70e6\u3002\u5982\u679c\u80fd\u6709\u4e00\u79cd\u529e\u6cd5\u80fd\u5feb\u901f\u7f16\u53f7\u5c31\u597d\u4e86\u3002\n\n\u5982\u679c\u6211\u4eec\u8bd5\u7740\u5728**\u540c\u4e00\u5c42**\u66f4\u6362\u7f16\u53f7\u7684\u987a\u5e8f\uff0c\u5f97\u5230\u5982\u4e0b\u7f16\u53f7\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/88sorcjt.png)\n\n\u6613\u53d1\u73b0\uff0c`Game x` \u6240\u66ff\u4ee3\u7684\u7f16\u53f7\u521a\u597d\u662f $(2^k-x)$\u3002\u540c\u65f6\u7b2c $(i)$ \u5c40\u7684\u4fe1\u606f\u4e5f\u4e0e\u7b2c $(2i),(2i+1)$ \u5c40\u76f8\u5173\u3002\n\n\u4e0d\u8fc7\u9700\u8981\u6ce8\u610f\uff0c\u8fd9\u6837\u7f16\u53f7\u7684\u5408\u5e76\u64cd\u4f5c\u6709\u6240\u4e0d\u540c\uff1a\n\n- \u4ee5\u4e0a\u56fe\u4e3a\u4f8b\uff0c`Game 7` \u7684\u9009\u62d4\u89c4\u5219\u5982\u679c\u662f\u5b57\u7b26 `0`\uff0c\u90a3\u4e48\u4ee3\u8868\u80dc\u5229\u8005\u4e3a\u7f16\u53f7\u5c0f\u7684\u53c2\u8d5b\u8005\uff0c\u5373 $f_7=f_5$\u3002\n- \u800c `Game 7` \u4ee3\u66ff\u7684\u70b9 $(1)$ \u9700\u8981\u5408\u5e76\u70b9 $(2),(3)$ \u7684\u4fe1\u606f\uff0c\u5982\u679c\u4ee5\u76f8\u540c\u89c4\u5219\u5408\u5e76\uff0c\u90a3\u4e48\u7531\u4e8e $(2)<(3)$\uff0c`Game 7` \u7684\u80dc\u5229\u8005\u5c31\u548c `Game 6` \u7684\u80dc\u5229\u8005\u76f8\u540c\uff0c\u5373 $f_7=f_6$\uff0c\u4e0e $f_7=f_5$ \u4e0d\u540c\u3002\n\n\u6240\u4ee5\uff0c\u5982\u679c\u9009\u62d4\u89c4\u5219\u4ee5 `0` \u8868\u793a\uff0c\u90a3\u4e48\u5e94\u8be5\u662f $f_{(i)}=f_{(2i+1)}$\uff1b\u5982\u679c\u4ee5 `1` \u8868\u793a\uff0c\u90a3\u4e48 $f_{(i)}=f_{(2i)}$\u3002\n\n\u6bcf\u6b21\u64cd\u4f5c\u540e\uff0c$f_{(1)}$ \u5c31\u662f\u5f53\u524d\u7b54\u6848\u3002 \n\n**\u4ee3\u7801**\n\n```cpp\n#include <cstdio>\n#define INF 1e9\n#define eps 1e-6\ntypedef long long ll;\n\nint k, q, ans[1000010], n;\nchar s[1000010], c[1000010], ss[2];\n\nvoid build(int i, int l, int r){\n\t// \u53ea\u6709\u4e00\u4e2a team \u65f6\u8d4b\u521d\u503c 1\n\tif(l == r){\n\t\tans[i] = 1;\n\t\treturn;\n\t}\n\tint mid = (l + r) >> 1;\n\tbuild(i << 1, l, mid), build(i << 1 | 1, mid + 1, r);\n\t// \u63a5\u4e0b\u6765\u662f\u5408\u5e76\u64cd\u4f5c\n\tif(s[i] == '0') ans[i] = ans[i << 1 | 1];\n\tif(s[i] == '1') ans[i] = ans[i << 1];\n\tif(s[i] == '?') ans[i] = ans[i << 1] + ans[i << 1 |1];\n}\n\nint main(){\n\n\tscanf(\"%d%s\", &k, c + 1), n = (1 << k);\n\tfor(int i = 1; i < n; i++)\t// \u7ffb\u8f6c\u5b57\u7b26\u4e32\u5c31\u53ef\u4ee5\u5f97\u5230\u65b0\u7684\u7f16\u53f7\n\t\ts[i] = c[n - i];\n\tscanf(\"%d\", &q);\n\tbuild(1, 1, n);\n\tfor(int i = 1, u; i <= q; i++){\n\t\t// \u6ce8\u610f\u6bcf\u6b21\u64cd\u4f5c\u5bf9\u540e\u9762\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u6709\u5f71\u54cd\uff0c\u6240\u4ee5\u539f\u4e32\u4e5f\u8981\u4fee\u6539\n\t\tscanf(\"%d%s\", &u, ss + 1), u = n - u, s[u] = ss[1];\n\t\twhile(u){\t\t\t\t// \u8fd9\u91cc\u5408\u5e76\u64cd\u4f5c\u6ca1\u6709\u5199\u9012\u5f52\n\t\t\tif(s[u] == '0') ans[u] = ans[u << 1 | 1];\n\t\t\tif(s[u] == '1') ans[u] = ans[u << 1];\n\t\t\tif(s[u] == '?') ans[u] = ans[u << 1] + ans[u << 1 | 1];\n\t\t\tu >>= 1;\n\t\t}\n\t\tprintf(\"%d\\n\", ans[1]);\n\t}\n\n\treturn 0;\n}\n```",
        "postTime": 1622889065,
        "uid": 87573,
        "name": "HoshizoraZ",
        "ccfLevel": 7,
        "title": "\u3010CF1535D\u3011Playoff Tournament \u9898\u89e3"
    },
    {
        "content": "\u9996\u5148\u91cd\u6807\u53f7\uff0c\u6211\u4eec\u5c06\u6240\u6709\u7684\u6807\u53f7\u53cd\u8f6c\u4e00\u4e0b\u5c31\u4f1a\u53d1\u73b0 $i$ \u7684\u513f\u5b50\u662f $i\\times 2$ \u548c $i\\times 2+1$ \u3002\n\n\n\u8bbe $dp[i][0/1]$ \u4e3a\u7b2c $i$ \u573a\u6bd4\u8d5b\u9009 $0$ \u6216 $1$ \u7684\u8d62\u5bb6\u4e2a\u6570\u3002\n\n\n\u5bb9\u6613\u53d1\u73b0\u82e5\u9009 $0$ \u7684\u8bdd\u5fc5\u7136\u662f\u5c0f\u7684\u513f\u5b50\u8d62\uff0c\u5426\u5219\u6bd4\u867d\u7136\u662f\u5927\u7684\u513f\u5b50\u8d62\u3002\u4e5f\u5c31\u662f $dp[i][0]=dp[i\\times 2 +1][0]+dp[i\\times 2 +1][1],dp[i][1]=dp[i\\times 2 ][0]+dp[i\\times 2 ][1]$ \u3002\u7531\u4e8e\u91cd\u6807\u53f7\u4e86\u6240\u4ee5\u6807\u53f7\u5927\u7684\u539f\u6765\u53cd\u800c\u5c0f\uff0c\u7f16\u53f7\u5c0f\u7684\u539f\u6765\u53cd\u800c\u5927\u3002\n\n\u4fee\u6539\u64cd\u4f5c\u5bb9\u6613\u53d1\u73b0\u53ea\u5bf9\u5f53\u524d\u8282\u70b9\u5230\u6839\u7684\u94fe\u7684\u7b54\u6848\u6709\u5f71\u54cd\uff0c\u8fd9\u6761\u94fe\u6700\u957f\u4e3a $k$ \u3002\n\n\u6240\u4ee5\u8fd9\u9053\u9898\u5c31\u505a\u5b8c\u4e86 $O(qk)$",
        "postTime": 1622876516,
        "uid": 120911,
        "name": "Lynkcat",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1535D Playoff Tournament"
    },
    {
        "content": "\u5148\u628a\u6807\u53f7\u91cd\u65b0\u6392\u5e8f\uff08\u6839\u8282\u70b9\u4e3a $0$\uff09\uff1a\n\n```cpp\nint cur = s.size(), lst;\nrep(i, n)\n{\n\tlst = cur;\n\tcur -= 1 << i;\n\tfor (int j = cur; j < lst; j++)\n\t{\n\t\tto[j] = t.size();\n\t\tt += s[j];\n\t}\n}\ns = t;\n```\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u8282\u70b9 $k$ \u7684\u7236\u4eb2\u662f $(k-1)/2$ \uff0c\u513f\u5b50\u662f $k\\times2+1$ \u548c $k\\times2+2$  \n\n\u8bbe $f_i$ \u4e3a\u7b2c $i$ \u573a\u6bd4\u8d5b\u83b7\u80dc\u961f\u4f0d\u6709\u51e0\u79cd\u53ef\u80fd\uff0c\u5f88\u5bb9\u6613\u770b\u51fa\uff1a\n\n- \u5982\u679c $s_i$ \u4e3a $0$\uff0c\u5219 $f_i=f_{i\\times2+1}$ ;\n\n- \u5982\u679c $s_i$ \u4e3a $1$\uff0c\u5219 $f_i=f_{i\\times2+2}$ ;\n\n- \u5982\u679c $s_i$ \u4e3a $?$\uff0c\u5219 $f_i=f_{i\\times2+1}+f_{i\\times2+2}$ \u3002\n\n\u5c31\u53ef\u4ee5\u987a\u5229\u901a\u8fc7\u4e86\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define db double\n#define ld long double\n#define forr(i, a, n) for (int i = a; i < n; i++)\n#define rep(i, n) forr(i, 0, n)\n#define repp(i, n) forr(i, 1, n + 1)\n#define foreach(it, t) for (__typeof(t.begin()) it = t.begin(); it != t.end(); it++)\n#define pb push_back\n#define mp make_pair\n#define all(a) a.begin(), a.end()\n#define init(a, i) memset(a, i, sizeof(a))\n#define pii pair<int, int>\n#define vvi vector<vector<int>>\n#define MAXN 0x3f3f3f3f\nint n, q, a;\nchar b;\nstring s, t;\nint to[1000006]; //\u8bb0\u5f55\u7f16\u53f7\u7684\u5bf9\u5e94\u5173\u7cfb\nint f[1000006];\nvoid solve()\n{\n    cin >> n >> s >> q;\n    int cur = s.size(), lst;\n    rep(i, n)\n    {\n        lst = cur;\n        cur -= 1 << i;\n        for (int j = cur; j < lst; j++)\n        {\n            to[j] = t.size();\n            t += s[j];\n        }\n    }\n    s = t;\n    rep(i, 1 << n + 1) f[i] = 1;\n    rep(i, (1 << n) - 1)\n    {\n        a = to[i];\n        if (s[a] == '0')\n            f[a] = f[a * 2 + 1];\n        if (s[a] == '1')\n            f[a] = f[a * 2 + 2];\n        if (s[a] == '?')\n            f[a] = f[a * 2 + 1] + f[a * 2 + 2];\n    }\n    while (q--)\n    {\n        cin >> a >> b;\n        a = to[a - 1];\n        s[a] = b;\n        while (1)\n        {\n            if (s[a] == '0')\n                f[a] = f[a * 2 + 1];\n            if (s[a] == '1')\n                f[a] = f[a * 2 + 2];\n            if (s[a] == '?')\n                f[a] = f[a * 2 + 1] + f[a * 2 + 2];\n            if (!a)\n                break;\n            a = (a - 1) / 2;\n        }\n        cout << f[0] << endl;\n    }\n}\nint main()\n{\n    int T;\n    T = 1;\n    //cin>>T;\n    while (T--)\n        solve();\n    return 0;\n}\n```\n",
        "postTime": 1622948885,
        "uid": 407564,
        "name": "Rushroom",
        "ccfLevel": 7,
        "title": "CF1535D Playoff Tournament"
    },
    {
        "content": "(\u6ce8\uff1a\u672c\u6587\u4e2d\u7684 $n$ \u6307\u7684\u662f\u539f\u9898\u4e2d\u7684 $2^k-1$)\n\n\u7b80\u8ff0\u4e00\u4e0b\u5982\u4f55\u8f6c\u6362\u6a21\u578b\uff1a\u5c06\u7ed9\u5b9a\u7684\u5b57\u7b26\u4e32\u5012\u7740\u6309bfs\u5e8f\u5efa\u6811\uff0c$n$ \u53f7\u8282\u70b9\u4e3a\u6839\uff0c\u975e\u53f6\u5b50\u8282\u70b9\u5bf9\u5e94\u7684\u5b57\u7b26\u4e3a `0` \u5219\u5411\u5de6\u513f\u5b50\u8fde\u8fb9\uff0c \u4e3a `1` \u5219\u5411\u53f3\u513f\u5b50\u8fde\u8fb9\uff0c\u4e3a `?` \u5219\u540c\u65f6\u5411\u4e24\u4e2a\u513f\u5b50\u8fde\u8fb9\uff0c\u53f6\u5b50\u8282\u70b9\u5bf9\u5e94\u7684\u5b57\u7b26\u4e3a `0` \u6216 `1` \u5219\u5927\u5c0f\u8bbe\u4e3a 1\uff0c\u4e3a `?` \u5219\u5927\u5c0f\u8bbe\u4e3a 2\u3002\u7b54\u6848\u5c31\u662f $n$ \u53f7\u8282\u70b9\u7684\u5b50\u6811\u5927\u5c0f\u3002\u5efa\u6811\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n)$\u3002\n\n\u4fee\u6539\u64cd\u4f5c\u53ea\u9700\u5c06\u5f53\u524d\u8282\u70b9\u5bf9\u5e94\u8fde\u8fb9\u8fdb\u884c\u4fee\u6539\uff0c\u5e76\u66f4\u65b0\u81ea\u5df1\u5230\u6839\u8282\u70b9\u7684\u8def\u5f84\u4e0a\u6240\u6709\u70b9\u7684\u5b50\u6811\u5927\u5c0f\u5373\u53ef\uff0c\u7531\u4e8e\u8fd9\u662f\u4e00\u68f5\u6df1\u5ea6\u4e3a $k$ \u7684\u5b8c\u5168\u4e8c\u53c9\u6811\uff0c\u6240\u4ee5\u4e00\u6b21\u4fee\u6539\u64cd\u4f5c\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(k)$\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n+qk)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n\u7ec6\u8282\u5b9e\u73b0\u5c31\u770b\u4ee3\u7801\u5427\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ri register int\n#define DEBUG(k...) fprintf(stderr,k)\ntypedef long long ll;\ntemplate<class T>inline bool chmax(T &x,const T &y){return x<y?x=y,true:false;}\ntemplate<class T>inline bool chmin(T &x,const T &y){return x>y?x=y,true:false;}\nconst int maxn=3e5+10;\nint siz[maxn],f[maxn],l[maxn],r[maxn],m,n,t_case;\nchar s[maxn],op[maxn];\nll ans;\nqueue<int>q;\ninline void build1(){\n\tq.push(n);\n\tri cnt1=n,cnt2=n;\n\twhile(q.size()){\n\t\tri p=q.front();q.pop();\n\t\top[p]=s[cnt2--];\n\t\tif(cnt1)r[p]=--cnt1,q.push(cnt1);\n\t\tif(cnt1)l[p]=--cnt1,q.push(cnt1);\n\t}\n}\ninline void update(int p){\n\tif(!l[p]&&!r[p]){\n\t\tif(op[p]=='?')siz[p]=2;\n\t\telse siz[p]=1;\n\t\treturn;\n\t}\n\tif(op[p]=='?')siz[p]=siz[l[p]]+siz[r[p]];\n\telse{\n\t\tif(op[p]=='0')siz[p]=siz[l[p]];\n\t\tif(op[p]=='1')siz[p]=siz[r[p]];\n\t}\n}\ninline void build2(int p){\n\tif(!l[p]&&!r[p]){\n\t\tif(op[p]=='?')siz[p]=2;\n\t\telse siz[p]=1;\n\t\treturn;\n\t}\n\tf[l[p]]=p;\n\tbuild2(l[p]);\n\tf[r[p]]=p;\n\tbuild2(r[p]);\n\tupdate(p);\n}\ninline void modify(int pos,char x){\n\top[pos]=x;\n\tupdate(pos);\n\twhile(f[pos])pos=f[pos],update(pos);\n}\nint main(){\n\tscanf(\"%d%s\",&n,s+1);\n\tn=(1<<n)-1;\n\tbuild1();\n\tbuild2(n);\n\tscanf(\"%d\",&m);\n\twhile(m--){\n\t\tri pos;\n\t\tchar x[5];\n\t\tscanf(\"%d%s\",&pos,x);\n\t\tmodify(pos,*x);\n\t\tprintf(\"%d\\n\",siz[n]);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1622883302,
        "uid": 67942,
        "name": "meyi",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF1535D \u3010Playoff Tournament\u3011"
    }
]
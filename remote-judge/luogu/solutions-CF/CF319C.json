[
    {
        "content": "\u4e00\u4e2a\u8f83\u4e3a\u666e\u901a\u7684\u659c\u7387\u4f18\u5316\uff1f\u4e0d\u8fc7\u8f6c\u6362\u95ee\u9898\u8fd8\u662f\u6709\u70b9\u5de7\u7684\u3002\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF319C)\n\n### $Solution:$\n\n\u7531\u4e8e $b_n=0$ \u4e14 $n$ \u4e3a\u8fd9\u4e9b\u70b9\u7f16\u53f7\u7684\u6700\u5927\u503c\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u628a\u95ee\u9898\u8f6c\u6362\u4e3a\u780d\u5012\u7b2c $n$ \u68f5\u6811\u7684\u6700\u5c0f\u6210\u672c\u3002\n\n\u8003\u8651\u5b9a\u4e49 $f_i$ \u4e3a\u780d\u5012\u7b2c $i$ \u68f5\u6811\u7684\u6700\u5c0f\u6210\u672c\uff0c\u679a\u4e3e\u4e00\u4e2a\u5c0f\u4e8e $i$ \u7684 $j$\uff0c\u94a6\u5b9a $j$ \u4e3a\u6b21\u5927\u7f16\u53f7\u503c\uff0c\u4e8e\u662f\u53ef\u4ee5\u5217\u51fa\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$f_i = \\min_{j=1}^{i-1}\\{f_j+b_j\\times a_i\\}$$\n\n\u5f88\u663e\u7136\u5355\u7eaf\u66b4\u529b\u662f $O(n^2)$ \u7684\uff0c\u4e0d\u8db3\u4ee5\u901a\u8fc7\u6b64\u9898\uff0c\u4e8e\u662f\u8003\u8651\u4f18\u5316\uff0c\u8fd9\u91cc\u8fd0\u7528\u7684\u662f\u659c\u7387\u4f18\u5316\u3002\n\n\u82e5\u6709 $k < j$ \u4e14 $k$ \u6bd4 $j$ \u66f4\u4f18\uff0c\u90a3\u4e48\u6709\u4e0d\u7b49\u5f0f\uff1a\n\n$$f_k + b_k\\times a_i < f_j + b_j\\times a_i$$\n\n\u7136\u540e\u6574\u7406\u4e0d\u7b49\u5f0f\uff1a\n\n$$\\dfrac{f_j - f_k}{b_k - b_j} > a_i$$\n\n\u8fd9\u5df2\u7ecf\u662f\u4e00\u4e2a\u6807\u51c6\u7684\u659c\u7387\u4f18\u5316\u5f0f\u4e86\u3002\n\n\u56e0\u4e3a\u8fd9\u91cc $a_i$ \u662f\u5355\u8c03\u9012\u589e\u7684\uff0c\u6240\u4ee5\u7ef4\u62a4\u4e00\u4e2a\u659c\u7387\u503c\u5355\u8c03\u9012\u589e\u7684\u5355\u8c03\u961f\u5217\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n)$\u3002\n\n### $Code:$\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n#include <queue>\n#include <vector>\n#include <cmath>\nusing namespace std;\n#define ll long long\n#define x1 x_csyakioi_1\n#define x2 x_csyakioi_2\n#define y1 y_csyakioi_1\n#define y2 y_csyakioi_2\n#define y0 y_csyakioi_0\n#define dingyi int mid = l + r >> 1, ls = p << 1, rs = p << 1 | 1\ninline int read(){\n\tint x = 0, f = 1; char ch = getchar();\n\twhile(ch < '0' || ch > '9'){ if(ch == '-') f = -1; ch = getchar(); }\n\twhile(ch >= '0' && ch <= '9'){ x = x * 10 + (ch ^ 48); ch = getchar(); }\n\treturn x * f;\n}\nconst int N = 100010;\nint n, a[N], b[N], q[N], head, tail; ll f[N];\ninline double calc(int x, int y){ return 1.0 * (f[y] - f[x]) / (b[x] - b[y]); } // x < y \nint main(){\n\tn = read();\n\tfor(int i = 1; i <= n; ++i) a[i] = read();\n\tfor(int i = 1; i <= n; ++i) b[i] = read();\n\tq[head = tail = 1] = 1;\n\tfor(int i = 2; i <= n; ++i){\n\t\twhile(head < tail && calc(q[head], q[head + 1]) < a[i]) ++head;//\u8fd9\u91cc\u8fd0\u7528\u4e86 a_i \u5355\u8c03\u9012\u589e\u7684\u6027\u8d28\n\t\tf[i] = f[q[head]] + 1ll * a[i] * b[q[head]];\n\t\twhile(head < tail && calc(q[tail], i) < calc(q[tail - 1], q[tail])) --tail;\n\t\tq[++tail] = i;\n\t}\n\tprintf(\"%lld\", f[n]);\n\treturn 0;\n}\n```\n",
        "postTime": 1603774117,
        "uid": 147999,
        "name": "Warriors_Cat",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF319C \u3010Kalila and Dimna in the Logging Industry\u3011"
    },
    {
        "content": "[CF319C Kalila and Dimna in the Logging Industry](https://www.luogu.com.cn/problem/CF319C)\u89e3\u9898\u62a5\u544a\uff1a\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://zybuluo.com/xiaoziyao/note/1750042)\n\n## \u9898\u610f\n- \u7ed9\u5b9a$n$\u68f5\u6811\uff0c\u9ad8\u5ea6\u4e3a$a_1$\u5230$a_n$\uff0c\u6743\u503c\u4e3a$b_1$\u5230$b_n$\uff0c\u5f53\u4e00\u9897\u6811\u7684$a$\u4e3a$0$\u65f6\u5c31\u8bf4\u5b83\u88ab\u780d\u5012\u4e86\uff1b\n- \u6709\u4e00\u4e2a\u7535\u952f\uff0c\u6bcf\u4e00\u6b21\u780d\u4f10\u6811\u4f1a\u8ba9\u4e00\u68f5\u6811\u7684\u9ad8\u5ea6$-1$\uff1b\n- \u780d\u4f10\u7684\u8d39\u7528\u4e3a\u5f53\u524d\u780d\u5012\u7684\u7f16\u53f7\u7684\u6700\u5927\u7684\u6811\u7684$b$\uff0c\u7b2c\u4e00\u6b21\u780d\u4f10\u4e0d\u9700\u8981\u8d39\u7528\uff1b\n- \u4fdd\u8bc1$a_i<a_{i+1},b_i>b_{i+1},a_1=1,b_n=0$\uff0c\u6c42\u780d\u5012\u6240\u6709\u6811\u7684\u6700\u5c0f\u8d39\u7528\u3002\n- \u6570\u636e\u8303\u56f4\uff1a$1\\leqslant n\\leqslant 10^5$\u3002\n\n## \u5206\u6790\n\u5f88\u663e\u7136\uff0c\u6211\u4eec\u7b2c\u4e00\u6b21\u780d\u7684\u4e00\u5b9a\u662f\u7b2c\u4e00\u68f5\u6811\uff0c\u4e14\u780d\u5012\u6700\u540e\u4e00\u68f5\u6811\u4ee5\u540e\u5c31\u4e0d\u9700\u8981\u4efb\u4f55\u8d39\u7528\u4e86\uff0c\u8fd9\u6837\uff0c\u9898\u610f\u5c31\u8f6c\u5316\u4e3a\u5982\u4f55\u82b1\u8d39\u6700\u5c0f\u7684\u8d39\u7528\u780d\u5012\u7b2c$n$\u68f5\u6811\u3002\n\n\u6709\u4e00\u4e2a\u5f88\u663e\u7136\u7684\u8d2a\u5fc3\u601d\u60f3\uff0c\u6211\u4eec\u780d\u6811\u4e00\u5b9a\u4ece\u524d\u5f80\u540e\u780d\uff08\u4e2d\u95f4\u53ef\u4ee5\u8df3\u8fc7\u4e00\u4e9b\u6811\uff09\uff0c\u56e0\u4e3a\u6211\u4eec\u780d\u8fd9\u68f5\u6811\u4e00\u5b9a\u65e0\u6cd5\u66f4\u65b0\u780d\u6811\u7684\u8d39\u7528\u3002\n\n\u8bbe$f_i$\u4e3a\u780d\u5012\u7b2c$i$\u68f5\u6811\u7684\u8d39\u7528\uff0c\u90a3\u4e48\u53ef\u4ee5\u5217\u51fa\u8f6c\u79fb\u65b9\u7a0b$f_i=\\min_{j=1}^{i-1}\\{f_j+b_j\\cdot a_i\\}$\u3002\n\n\u8fd9\u4e2a$O(n^2)$\u4e00\u5b9a\u65e0\u6cd5\u901a\u8fc7\u9898\u76ee\uff0c\u56e0\u6b64\u9700\u8981\u4f18\u5316\u3002\n\n\u8003\u8651\u659c\u7387\u4f18\u5316\uff1a\u8bbe$j,k$\u4e24\u4e2a$i$\u7684\u51b3\u7b56\u70b9\u6ee1\u8db3$k<j<i$\uff0c\u4e14$j$\u6bd4$k$\u66f4\u4f18\uff0c\u90a3\u4e48\u6709\uff1a\n\n$$f_j+b_j\\cdot a_i\\leqslant f_k+b_k\\cdot a_i$$\n\n\u53d8\u4e00\u4e0b\u5f62\u5f0f\uff1a$f_j+b_j\\cdot a_i\\leqslant f_k+b_k\\cdot a_i$ $\\Rightarrow f_j-f_k\\leqslant a_i\\cdot(b_k-b_j)$ $\\Rightarrow \\frac{f_j-f_k}{b_k-b_j}\\leqslant a_i$ $\\Rightarrow -\\frac{f_j-f_k}{b_j-b_k}\\leqslant a_i$ $\\Rightarrow\\frac{f_j-f_k}{b_j-b_k}\\geqslant -a_i$\u3002\n\n\u5316\u6210\u659c\u7387\u5f0f\u4e4b\u540e\uff0c\u7531\u4e8e$a$\u662f\u9012\u589e\u7684\uff0c\u56e0\u6b64\u7528\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u4e00\u4e2a\u4e0a\u51f8\u58f3\u5c31\u597d\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\uff1a$O(n)$\u3002\n\n## \u4ee3\u7801\n\u8bb0\u5f97\u5f00$\\text{long long}$\uff0c$inf$\u5f00\u5927\u4e00\u70b9\u3002\n```\n#include<stdio.h>\n#include<string.h>\n#define int long long\n#define inf 1000000000000000000\nconst int maxn=100005;\nint n,l,r;\nint a[maxn],b[maxn],f[maxn],q[maxn];\ninline int min(int a,int b){\n\treturn a<b? a:b;\n}\ninline int x(int p){\n\treturn b[p];\n}\ninline int y(int p){\n\treturn f[p];\n}\ninline double slope(int a,int b){\n\tif(x(a)==x(b))\n\t\treturn y(a)>y(b)? inf:-inf;\n\treturn 1.0*(y(a)-y(b))/(x(a)-x(b));\n}\nsigned main(){\n\tscanf(\"%lld\",&n);\n\tfor(int i=1;i<=n;i++)\n\t\tscanf(\"%lld\",&a[i]);\n\tfor(int i=1;i<=n;i++)\n\t\tscanf(\"%lld\",&b[i]);\n\tfor(int i=1;i<=n;i++)\n\t\tf[i]=inf;\n\tf[1]=b[1],q[++r]=0;\n\tfor(int i=1;i<=n;i++){\n\t\twhile(l<r&&slope(q[l+1],q[l])>=-a[i])\n\t\t\tl++;\n\t\tf[i]=f[q[l]]+b[q[l]]*a[i];\n\t\twhile(l<r&&slope(q[r-1],i)>=slope(q[r],q[r-1]))\n\t\t\tr--;\n\t\tq[++r]=i;\n\t}\n\tprintf(\"%lld\\n\",f[n]);\n \treturn 0;\n}\n```",
        "postTime": 1603095895,
        "uid": 35754,
        "name": "Verdandi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF319C \u3010Kalila and Dimna in the Logging Industry\u3011"
    },
    {
        "content": "## \u601d\u8def\u5206\u4eab\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u6211\u4eec\u53ea\u8981\u780d\u5012\u4e86\u7b2c $n$ \u68f5\u6811\uff0c\u5c31\u53ef\u4ee5\u514d\u8d39\u780d\u5b8c\u5176\u4ed6\u6240\u6709\u7684\u6811\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u95ee\u9898\u8f6c\u5316\u4e3a\uff0c\u6c42\u5982\u4f55\u4ee5\u6700\u5c0f\u7684\u4ee3\u4ef7\u780d\u5b8c\u7b2c $n$ \u68f5\u6811\u3002\n\n\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff0c\u7531\u4e8e $b_i$ \u5355\u8c03\u4e0b\u964d\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u780d\u5b8c\u7b2c $n$ \u68f5\u6811\u524d\u80af\u5b9a\u4e0d\u4f1a\u5f80\u56de\u780d\uff0c\u56e0\u4e3a\u8fd9\u6837\u5bf9\u5f53\u524d\u7684\u5145\u7535\u4ef7\u683c\u6ca1\u6709\u4efb\u4f55\u8d21\u732e\u3002\n\n\u8fdb\u4e00\u6b65\u601d\u8003\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u53ea\u8981\u6211\u4eec\u5f00\u59cb\u780d\u4e00\u68f5\u6811\u4e86\uff0c\u5c31\u8981\u5c06\u8fd9\u68f5\u6811\u780d\u5b8c\uff0c\u4e0d\u7136\u5bf9\u5f53\u524d\u5145\u7535\u4ef7\u683c\u4e5f\u6ca1\u6709\u4efb\u4f55\u8d21\u732e\u3002\n\n\u4e8e\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u8bbe $dp_i$ \u8868\u793a\u780d\u5012\u7b2c $i$ \u68f5\u6811\u6240\u9700\u7684\u6700\u5c0f\u6210\u672c\u3002\n\n\u7ecf\u8fc7\u601d\u8003\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5217\u51fa\u52a8\u6001\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$$\ndp_i=\\max\\left(dp_i,dp_j+a_i \\times b_j\\right)\\left|\\right.j\\in \\left[ 1,i \\right)\n$$\n\n\u4f46\u662f\u8fd9\u6837\u8f6c\u79fb\u662f $\\Theta\\left( n^2 \\right)$ \u7684\uff0c\u4f1a\u59a5\u59a5\u5730 $TLE$\uff0c\u6545\u6211\u4eec\u9700\u8981\u4f18\u5316\u3002\n\n\u6211\u4eec\u8bbe $j,k$ \u4f7f\u5f97 $k < j < i$\u3002\n\n\u7136\u540e\u6211\u4eec\u5047\u8bbe\uff1a\n\n$$\ndp_j+a_i \\times b_j \\geqslant dp_k+a_i \\times b_k\n$$\n\n\u7ee7\u7eed\u7b80\u5316\uff0c\u5219\u6709\uff1a\n\n$$\ndp_j-dp_k \\geqslant a_i \\times \\left( b_k-b_j \\right)\n$$\n\n\u518d\u7b80\u5316\u65f6\uff0c\u9700\u8981\u6ce8\u610f\uff0c\u56e0\u4e3a $b$ \u5355\u8c03\u9012\u51cf\uff0c\u6240\u4ee5 $b_k-b_j < 0$\uff0c\u6240\u4ee5\u6709\uff1a\n\n$$\n\\dfrac{dp_j-dp_k}{b_k-b_j} \\leqslant a_i\n$$\n\n\u4e3a\u4e86\u66f4\u597d\u770b\uff0c\u4e24\u8fb9\u540c\u65f6\u4e58\u4e0a $-1$\n\n$$\n\\dfrac{dp_j-dp_k}{b_j-b_k} \\geqslant -a_i\n$$\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u4f7f\u7528\u659c\u7387\u4f18\u5316\u4e86\u3002\n\n## \u4ee3\u7801\u5c55\u793a\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int maxn=100100,inf=200000000000000;//inf\u9700\u8981\u5f00\u52301e14\nint n,a[maxn],b[maxn],dp[maxn],dque[maxn],l,r;\nint cal(int x,int y){//\u8ba1\u7b97\u524d\u6587\u7684\u516c\u5f0f\n\tif(dp[x]==dp[y]){\n\t\treturn (x<y?-inf:inf);\n\t}\n\treturn 1.*(dp[x]-dp[y])/(b[x]-b[y]);\n}\nsigned main(){\n\tcin>>n;\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%lld\",&a[i]);\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%lld\",&b[i]);\n\t}\n\t//\u8fd9\u91cc\u6211\u6ca1\u6709\u7ed9dp\u8d4b\u521d\u503c\uff0c\u56e0\u4e3a\u6211\u4eec\u5728\u540e\u9762\u4e0d\u9700\u8981\u53d6min\u6216max\n   //\u4f46\u662f\u4f17\u6240\u5468\u77e5\uff0cmemset\u8dd1\u5f97\u5de8\u6162\n   l=0,r=1;\n\tdque[r]=1;//\u5148\u5c061\u52a0\u5165\u961f\u5217\n\tfor(int i=2;i<=n;i++){\n\t\twhile(l<r&&cal(dque[l+1],dque[l])>=-a[i]){//\u5904\u7406\u7b26\u5408\u6761\u4ef6\u7684j\n\t\t\tl++;//\u7531\u4e8ea\u5355\u8c03\u4e0a\u5347\uff0c\u6240\u4ee5\u8fd9\u91cc\u65f6\u6709\u5355\u8c03\u6027\u7684\n\t\t}\n\t\tint j=dque[l];\n\t\tdp[i]=dp[j]+b[j]*a[i];\n\t\twhile(l<=r&&cal(i,dque[r-1])>=cal(dque[r],dque[r-1])){\n\t\t\tr--;//\u6ce8\u610f\u8fd9\u91cc\u8981l<=r\uff0c\u56e0\u4e3a\u4f60\u662f\u53ef\u4ee5\u5c06\u6574\u4e2a\u961f\u5217\u5220\u5b8c\u7684\n\t\t}\n\t\tr++;\n\t\tdque[r]=i;\n\t}\n\tcout<<dp[n];\n\treturn 0;\n}\n```\n",
        "postTime": 1603809582,
        "uid": 90176,
        "name": "xixiup",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF319C \u3010Kalila and Dimna in the Logging Industry\u3011"
    },
    {
        "content": "\u9898\u89e3\u533a\u5168\u662f\u659c\u7387\u4f18\u5316\uff0c\u4ea4\u4e2a\u8d85\u54e5\u6811\u4e0a\u6765\u3002\n\n\u8003\u8651 $a_i$ \u9012\u589e\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u4e00\u6b21\u6027\u780d\u6389\u4e00\u6bb5\u7684\u6811\uff0c\u7136\u540e\u6211\u4eec\u5c31\u53ef\u4ee5\u6709\u5982\u4e0b\u65b9\u7a0b \uff1a\n\n$$f_i = f_j + b_i\\times a_j$$\n\n\u8003\u8651\u8fd9\u4e2a\u770b\u6210\u659c\u7387\u4e3a $a_j$ \u7684\u76f4\u7ebf\uff0c\u622a\u8ddd\u4e3a $f_j$\uff0c\u7136\u540e\u5355\u70b9\u6c42\u4e00\u6b21\u51fd\u6570\u6700\u5c0f\u503c\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 \uff1a$n\\log_2 n$\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long \n#define ls u << 1\n#define rs u << 1 | 1\n\nusing namespace std;\n\nconst int N = 2e5 + 5, MOD = 998244353, INF = 1e15;\n\nint n, tot, a[N], b[N], c[N], f[N];\n\nstruct line {\n\tint k, b;\n\tline (int k = 0, int b = 1e15) : k(k), b(b) {}\n\tinline int val (int pos) { return k * pos + b; }\n} t[N * 4], p;\n\t\ninline void insert (int u, int l, int r, line x) {\n\tint mid = (l + r) >> 1;\n\tif (l == r) { if (x.val(c[l]) < t[u].val(c[l])) t[u] = x; return ; }\n\tif (x.val(c[mid]) < t[u].val(c[mid])) swap(t[u], x);\n\tif (x.val(c[l]) < t[u].val(c[l])) insert(ls, l, mid, x);\n\tif (x.val(c[r]) < t[u].val(c[r])) insert(rs, mid + 1, r, x);\n}\t\ninline int query (int u, int l, int r, int pos) {\n\tif (l == r) return t[u].val(c[pos]);\n\tint mid = (l + r) >> 1;\n\tif (pos <= mid) return min(t[u].val(c[pos]), query(ls, l, mid, pos));\n\telse return min(t[u].val(c[pos]), query(rs, mid + 1, r, pos));\n}\n                  \n// \u674e\u8d85\u6811\n                  \nsigned main () {\n\tios :: sync_with_stdio(0);\n\tcin >> n;\n\tfor (int i = 1; i <= n; i ++) cin >> a[i], c[++ tot] = a[i];\n\tfor (int i = 1; i <= n; i ++) cin >> b[i], c[++ tot] = b[i];\n\tsort(c + 1, c + 1 + tot), tot = unique(c + 1, c + 1 + tot) - (c + 1);\n\tfor (int i = 1; i <= n; i ++) {\n\t\ta[i] = upper_bound(c + 1, c + 1 + tot, a[i]) - (c + 1), b[i] = upper_bound(c + 1, c + 1 + tot, b[i]) - (c + 1);\n \t}\n\tinsert(1, 1, tot, line(c[b[1]], 0));\n\tfor (int i = 2; i <= n; i ++) {\n\t\tf[i] = query(1, 1, tot, a[i]);\n\t\tinsert(1, 1, tot, line(c[b[i]], f[i]));\n\t}\n\tcout << f[n];\n\treturn 0;\n}\n\n```\n\n\u6ce8\u610f\u79bb\u6563\u5316\u7684\u4f7f\u7528\u3002",
        "postTime": 1679921633,
        "uid": 307535,
        "name": "Cust10",
        "ccfLevel": 6,
        "title": "Kalila and Dimna in the Logging Industry"
    },
    {
        "content": "#### \u9898\u76ee\u5206\u6790\n\u56e0\u4e3a\u6709 $ b[n] = 0 $ \uff0c\u6240\u4ee5\u5f53\u780d\u6389\u7b2c$ n $\u68f5\u6811\u65f6\u5c31\u4e0d\u9700\u8981\u82b1\u94b1\u4e86\u3002\n\n\u4ece\u8fd9\u4e2a\u89d2\u5ea6\u5165\u624b\uff0c\u53ef\u4ee5\u8003\u8651\u5b9a\u4e49 $ dp[i] $ \u4e3a\u780d\u7b2c$i$\u68f5\u6811\u7684\u82b1\u8d39\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u8f7b\u677e\u7684\u5f97\u5230\u4e00\u4e2a $ O(n^2) $ \u7684\u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u5f0f\uff1a\n\n$ dp[i] = min(dp[i], dp[j] + a[i]*b[j]),\\ j < i $\n\n\u4f46\u662f\u4e00\u770b\u6570\u636e\u8303\u56f4  $ n \\le 1e5 $\uff0c\u6734\u7d20\u7684 $dp$ \u660e\u663e\u884c\u4e0d\u901a\n\n\u6211\u4eec\u518d\u6765\u770b\u8fd9\u4e2a\u8f6c\u79fb\u5f0f\uff0c\u56e0\u4e3a\u6bcf\u6b21\u8f6c\u79fb\u53ea\u8ddf $ i,j $ \u6709\u5173\uff0c\u6211\u4eec\u8003\u8651\u4f7f\u7528\u659c\u7387\u4f18\u5316\n\n\u5047\u8bbe\u6709\uff1a$j < k$ \u4e14 $j$ \u6bd4 $k$ \u4f18\n\n\u90a3\u4e48\u6709\uff1a\n$ dp[j] +a[i]*b[j]<dp[k]+a[i]*b[k] $\n\n\u79fb\u9879\u8fc7\u540e\u5c31\u662f\uff1a\n$ \\frac{dp[k]-dp[j]}{b[j]-b[k]}>a[i] $\n\n\u8fd9\u4e2a\u5c31\u662f\u6211\u4eec\u7684\u659c\u7387\u5f0f\u4e86\n\n\u7ef4\u62a4\u4e00\u4e2a\u961f\u5217\u5c31\u53ef\u4ee5\u4f7f\u590d\u6742\u5ea6\u964d\u4f4e\u5230 $ O(n) $\n####  \u4ee3\u7801\n\u5177\u4f53\u5b9e\u73b0\u8bf7\u770b\u4ee3\u7801\n~~~cpp\nconst int N = 1e5 + 5;\nll dp[N];\nint n, a[N], b[N], q[N], head, tail;\ndouble getk(int x, int y)\n{\n    return 1.0 * (dp[y] - dp[x]) / (b[x] - b[y]);\n}//\u8ba1\u7b97\u659c\u7387\nint main()\n{\n    ios :: sync_with_stdio(0);\n    cin >> n;\n    for (int i = 1; i <= n; i++)\n        cin >> a[i];\n    for (int i = 1; i <= n; i++)\n        cin >> b[i];\n    q[++tail] = 1;\n    head = 1;\n    for (int i = 2; i <= n; i++)\n    {\n        while (head < tail && getk(q[head], q[head + 1]) < a[i])\n            head++;\n        dp[i] = dp[q[head]] + 1ll * a[i] * b[q[head]];\n        while (head < tail && getk(q[tail], i) <= getk(q[tail - 1], q[tail]))\n            tail--;\n        q[++tail] = i;\n    }\n    cout << dp[n];\n    return 0;\n}\n~~~",
        "postTime": 1597200525,
        "uid": 212040,
        "name": "smoothset",
        "ccfLevel": 5,
        "title": "\u9898\u89e3 CF319C \u3010Kalila and Dimna in the Logging Industry\u3011"
    }
]
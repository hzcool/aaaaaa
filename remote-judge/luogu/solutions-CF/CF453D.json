[
    {
        "content": "# \u9898\u76ee\n&emsp;&emsp;[\u70b9\u8fd9\u91cc](http://codeforces.com/problemset/problem/453/D)\u770b\u9898\u76ee\u3002  \n# \u5206\u6790  \n&emsp;&emsp;\u8bbe$count(x)$\u4e3a$x$\u7684\u4e8c\u8fdb\u5236\u4e2d$1$\u7684\u4e2a\u6570\u3002\u56e0\u6b64$f(u,v)=count(u\\oplus v)$  \n&emsp;&emsp;\u770b\u4e00\u770b\u6bcf\u6b21\u8f6c\u79fb\uff0c\u6211\u4eec\u53d1\u73b0\u6700\u4e0d\u53cb\u597d\u7684\u4e1c\u897f\u5c31\u662f$f(u,v)$\uff0c\u56e0\u6b64\u6211\u4eec\u5f97\u60f3\u529e\u6cd5\u628a\u5b83\u4ece\u6211\u4eec\u7684\u8ba1\u7b97\u4e2d\u4e22\u6389\u3002  \n&emsp;&emsp;\u53d1\u73b0\u5bf9\u4e8e$[0,n)$\u4e2d\u7684\u6240\u6709\u6570\uff0c\u4e24\u4e24\u5f02\u6216\u4e4b\u540e\u4e0d\u4f1a\u8d85\u8fc7$n$\u3002\u5e76\u4e14\u5bf9\u4e8e\u4e00\u4e2a\u56fa\u5b9a\u7684\u6570$x$\uff0c\u5176$count(x)$\u662f\u4e0d\u4f1a\u53d8\u7684\u3002\u56e0\u6b64\u6211\u4eec\u8003\u8651\u5c06$b$\u6570\u7ec4\u8f6c\u5b58\u51fa\u6765\uff1a    \n$$a[i]=b[count(i)]$$  \n&emsp;&emsp;\u56e0\u6b64\u6709\uff1a \n$$e[u]=\\sum_v a[u\\oplus v]e[v]$$  \n&emsp;&emsp;\u8003\u8651\u6539\u53d8\u679a\u4e3e\u987a\u5e8f\uff1a  \n$$e[u]=\\sum_{v} a[u\\oplus v]e[v]$$\n$$=\\sum_{i=0}^{m}a[i]\\sum_{u\\oplus v=i}e[v]$$\n$$=\\sum_{i=0}^{m}a[i]\\sum_{v\\oplus i=u}e[v]$$\n$$=\\sum_{v\\oplus i=u}a[i]e[v]$$   \n&emsp;&emsp;\u56e0\u6b64\u6bcf\u6b21\u8f6c\u79fb\u90fd\u662f\u4e00\u4e2a\u5f02\u6216\u5377\u79ef\u7684\u5f62\u5f0f\uff0c\u53ef\u4ee5\u7528 FWT \u4f18\u5316\u4e00\u53d1\u3002\u7531\u4e8e\u9700\u8981\u8f6c\u79fb$t$\u6b21\uff0c\u8fd8\u53ef\u7528\u5feb\u901f\u5e42\u3002 FWT \u53ea\u9700\u8981\u5728\u521d\u59cb\u548c\u6700\u540e\u505a\uff0c\u4e2d\u9014\u5feb\u901f\u5e42\u4e0d\u9700\u8981\u3002\u65f6\u95f4\u662f$O(mn + n\\log_2t)$\u3002  \n&emsp;&emsp;\u8fd9\u91cc\u8fd8\u6709\u4e00\u95ee\u9898\u3002\u7531\u4e8e\u672c\u9898\u7ed9\u7684\u662f\u4efb\u610f\u6a21\u6570\uff0c\u53ef\u80fd\u4e0d\u5b58\u5728$2$\u9006\u5143\u3002  \n&emsp;&emsp;~~\u4f17\u6240\u5468\u77e5\uff0c~~ \u5f02\u6216 FWT \u8fd8\u6709\u4e00\u79cd\u7248\u672c\uff0c\u4e5f\u5c31\u662f\u50cf FFT \u4e00\u6837\uff0c\u6b63\u53d8\u6362\u548c\u9006\u53d8\u6362\u5927\u90e8\u5206\u4e00\u6837\uff0c\u4f46\u662f\u9006\u53d8\u6362\u4f1a\u5728\u6700\u540e\u9664\u6389\u5411\u91cf\u957f\u5ea6\uff08\u4e8b\u5b9e\u4e0a FWT \u548c FFT \u6709\u5f88\u591a\u76f8\u4f3c\u5904\uff0c\u53ef\u4ee5\u5728 [K \u8fdb\u5236 FWT](https://www.cnblogs.com/reverymoon/p/10197711.html) \u4e2d\u4e86\u89e3\u5230\uff09    \n&emsp;&emsp;\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e0a\u8ff0\u7684 FWT \u3002\u4f46\u662f\u8fd9\u91cc\u8fd8\u6709\u95ee\u9898\uff0c$p$\u53ef\u80fd\u4e5f\u6ca1\u6709$n$\u7684\u9006\u5143\u3002\u6839\u636e\u540c\u4f59\u57fa\u672c\u6027\u8d28\uff1a\n$$a\\equiv b\\pmod p\\Leftrightarrow \\frac a d\\equiv \\frac b d\\pmod {\\frac p d}(d|\\gcd\\{a,b,m\\})$$    \n&emsp;&emsp;\u6211\u4eec\u628a$p$\u6269\u5927$n$\u500d\u4e4b\u540e\u5c31\u53ef\u4ee5\u76f4\u63a5\u9664\u5f97\u6b63\u786e\u7b54\u6848\u4e86\u3002  \n&emsp;&emsp;\u6700\u540e\u4e00\u4e2a\u95ee\u9898\uff0c$n\\times p$\u662f$10^{15}$\u7684\uff0c\u5982\u679c\u76f4\u63a5\u4e58\u6cd5\u4f1a\u6ea2\u51fa\uff08\u4ec0\u4e48\uff1f __int128 \uff1f\uff09\u3002\u56e0\u6b64\u6211\u4eec\u9700\u8981\u7528 long double \u6765\u6a21\u62df\u53d6\u6a21\uff08\u9f9f\u901f\u4e58\u592a\u6162\u4e86\uff09\u3002    \n# \u4ee3\u7801\n```cpp\n#include <cstdio>\n\ntypedef long long LL;\ntypedef long double LB;\n\nconst int MAXM = 25, MAXN = 1.5e6 + 5;\n\ntemplate<typename _T>\nvoid read( _T &x )\n{\n\tx = 0;char s = getchar();int f = 1;\n\twhile( s > '9' || s < '0' ){if( s == '-' ) f = -1; s = getchar();}\n\twhile( s >= '0' && s <= '9' ){x = ( x << 3 ) + ( x << 1 ) + ( s - '0' ), s = getchar();}\n\tx *= f;\n}\n\ntemplate<typename _T>\nvoid write( _T x )\n{\n\tif( x < 0 ){ putchar( '-' ); x = ( ~ x ) + 1; }\n\tif( 9 < x ){ write( x / 10 ); }\n\tputchar( x % 10 + '0' );\n}\n\nLL E[MAXN], C[MAXN];\nint B[MAXM];\nLL T, mod;\nint N, M;\n\nint lowbit( const int &x ) { return x & ( -x ); }\nLL fix( const LL a ) { return ( a % mod + mod ) % mod; }\nint count( int x ) { int ret = 0; while( x ) ret ++, x -= lowbit( x ); return ret; }\n\nLL mul( const LL a, const LL b ) { return fix( a * b - ( LL ) ( ( LB ) a / mod * b ) * mod ); }\n\nvoid FWT( LL *f, const int mode )\n{\n\tLL t1, t2;\n\tfor( int s = 2 ; s <= N ; s <<= 1 )\n\t\tfor( int i = 0, t = s >> 1 ; i < N ; i += s )\n\t\t\tfor( int j = i ; j < i + t ; j ++ )\n\t\t\t{\n\t\t\t\tt1 = f[j], t2 = f[j + t];\n\t\t\t\tf[j] = ( t1 + t2 ) % mod, f[j + t] = fix( t1 - t2 );\n\t\t\t}\n\tif( ~ mode ) return ;\n\tfor( int i = 0 ; i < N ; i ++ ) f[i] /= N;\n}\n\nvoid mul( LL *ret, LL *mult )\n{\n\tfor( int i = 0 ; i < N ; i ++ ) \n\t\tret[i] = mul( ret[i], mult[i] );\n}\n\nint main()\n{\n\tread( M ), read( T ), read( mod );\n\tN = 1 << M, mod *= N;\n\tfor( int i = 0 ; i < N ; i ++ ) read( E[i] );\n\tfor( int i = 0 ; i <= M ; i ++ ) read( B[i] );\n\tfor( int i = 0 ; i < N ; i ++ ) C[i] = B[count( i )];\n\tFWT( E, 1 ), FWT( C, 1 );\n\twhile( T )\n\t{\n\t\tif( T & 1 ) mul( E, C );\n\t\tmul( C, C ), T >>= 1;\n\t}\n\tFWT( E, -1 );\n\tfor( int i = 0 ; i < N ; i ++ ) write( E[i] ), puts( \"\" );\n\treturn 0;\n}\n```\n&emsp;&emsp;~~\u4e0d\u8981\u8138\u7684\u5c0f\u5e7f\u544a\uff1a~~ \u672c\u6587\u8f6c\u8f7d\u81ea[\u6211\u7684\u535a\u5ba2](https://blog.csdn.net/crashed/article/details/105095932)\uff0c\u6b22\u8fce\u5927\u5bb6\u524d\u6765\u9605\u8bfb\uff01",
        "postTime": 1585124134,
        "uid": 123809,
        "name": "crashed",
        "ccfLevel": 0,
        "title": "[CF453D]Little Pony and Elements of Harmony"
    }
]
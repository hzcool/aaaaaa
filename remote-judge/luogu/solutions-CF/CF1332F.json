[
    {
        "content": "# \u9898\u89e3-Independent Set\n\n## [\u535a\u5ba2\u4e2d\u9605\u8bfb](https://www.cnblogs.com/Wendigo/p/12611937.html#F)\n\n> [Independent Set](https://codeforces.com/contest/1332/problem/F)\n\n> \u7ed9\u5b9a\u6811 $G=(V,E)$\uff0c$n$ \u4e2a\u70b9\u3002\u4ee4 $E'\\in E$\uff0c\u6c42\u6240\u6709 $E'$ \u6240\u6709\u8fb9\u4e0a\u7684\u8282\u70b9\u7684\u72ec\u7acb\u96c6\u6570\u91cf\u4e4b\u548c $\\bmod 998244353$\uff08\u72ec\u7acb\u96c6\u5927\u5c0f\u53ef\u4ee5\u4e3a $0$\uff0c$E'\\neq\\varnothing$\uff09\u3002\n\n> \u6570\u636e\u8303\u56f4\uff1a$2\\le n\\le 3\\times10^5$\u3002\n\n\u8fd9\u4e48\u7b80\u5355\u7684\u6811\u5f62 $\\texttt{dp}$ \u6211\u7adf\u7136\u4e0d\u4f1a\uff0c\u800c\u4e14\u60f3\u4e86\u597d\u4e45\uff0c\u6211\u592a\u84bb\u4e86\u3002\n\n**\u8bbe $f_{o,i}$ \u8868\u793a\uff1a**\n\n1. \u5982\u679c $o=0$\uff1a$i$ \u70b9**\u9009\u6216\u4e0d\u9009\u90fd\u53ef\u4ee5**\uff0c\u4f46\u662f\u8fde\u63a5 $i$ \u53f7\u70b9\u4e0e\u7236\u4eb2\u8282\u70b9\u7684\u8fb9**\u4e0d\u5b58\u5728**\u7684 $i$ \u7684\u5b50\u6811\u4e2d\u7684\u7b54\u6848\u3002\n2. \u5982\u679c $o=1$\uff1a$i$ \u70b9**\u4e0d\u9009**\uff0c\u8fde\u63a5 $i$ \u53f7\u70b9\u4e0e\u7236\u4eb2\u8282\u70b9\u7684\u8fb9**\u5b58\u5728**\u7684 $i$ \u7684\u5b50\u6811\u4e2d\u7684\u7b54\u6848\u3002\n3. \u5982\u679c $o=2$\uff1a$i$ \u70b9**\u9009**\uff0c\u8fde\u63a5 $i$ \u53f7\u70b9\u4e0e\u7236\u4eb2\u8282\u70b9\u7684\u8fb9**\u5b58\u5728**\u7684 $i$ \u7684\u5b50\u6811\u4e2d\u7684\u7b54\u6848\u3002\n\n> \u4ee5\u4e0a\u201c\u7b54\u6848\u201d\u5747\u5305\u62ec\u9009\u7684\u8fb9\u4e3a\u7a7a\u7684\u60c5\u51b5\u3002\n\n\u5982\u679c\u8be5\u8282\u70b9**\u9009**\uff0c\u5b50\u8282\u70b9\u4e0d\u4e0e\u8be5\u8282\u70b9\u8fde\u8fb9\u6216\u8005\u4e0d\u9009\u662f\u5141\u8bb8\u7684\uff1a\n\n$$f_{2,i}=\\prod_{to\\in i's~sons}(f_{0,to}+f_{1,to})$$\n\n\u5982\u679c\u8be5\u8282\u70b9**\u4e0d\u9009**\uff0c\u5b50\u8282\u70b9\u600e\u4e48\u6837\u90fd\u662f\u5141\u8bb8\u7684\uff1a\n\n$$f_{1,i}=\\prod_{to\\in i's~sons}(f_{0,to}+f_{1,to}+f_{2,to})$$\n\n\u5982\u679c\u8be5\u8282\u70b9\u4e0d\u4e0e\u7236\u4eb2\u8282\u70b9\u8fde\u8fb9\uff0c\u5305\u62ec**\u9009\u6216\u4e0d\u9009\u7684\u60c5\u51b5**\uff0c\u4f46\u662f\u8981\u6392\u9664\u6240\u6709\u5b50\u8282\u70b9\u90fd\u4e0d\u4e0e\u8be5\u8282\u70b9\u8fde\u8fb9\u7684\u60c5\u51b5\uff08\u8981\u4e0d\u7136\u8282\u70b9\u5b64\u7acb\uff0c\u5c31\u4e0d\u662f\u8fb9\u4e24\u7aef\u7684\u70b9\u4e86\uff09\uff1a\n\n$$f_{0,i}=f_{1,i}+f_{2,i}-\\prod_{to\\in i's~sons}f_{0,to}$$\n\n\u56e0\u4e3a\u7b54\u6848\u4e0d\u5e94\u5305\u62ec\u9009\u7684\u8fb9\u4e3a\u7a7a\u7684\u60c5\u51b5\uff0c\u800c\u4e14\u6839\u8282\u70b9\u4e0d\u4e0e\u7236\u4eb2\u8282\u70b9\u8fde\u8fb9\uff08\u6839\u8282\u70b9\u7684\u7236\u4eb2\u8282\u70b9\u4e0d\u5b58\u5728\uff09\uff0c\u6240\u4ee5\u6700\u7ec8\u7b54\u6848\u4e3a $f_{0,1}-1$\u3002\n\n**\u4ee3\u7801\uff1a**\n\n```cpp\n//Data\nconst int N=300000,m=998244353;\nint n;\nvector<lng> f[3];\nvector<vector<int> > e;\n\n//Dfs\nil void Dfs(re int x,re int fa){\n\tf[0][x]=f[1][x]=f[2][x]=1;\n\tfor(re int to:e[x])if(to!=fa){\n\t\tDfs(to,x);\n\t\t(f[0][x]*=f[0][to])%=m;\n\t\t(f[1][x]*=(f[0][to]+f[1][to]+f[2][to]))%=m;\n\t\t(f[2][x]*=(f[0][to]+f[1][to]))%=m;\n\t}\n\tf[0][x]=(f[1][x]+f[2][x]-f[0][x]+m)%m;\n}\n\n//Main\nint main(){\n\tscanf(\"%d\",&n);\n\te.resize(n+7);\n\tfor(re int i=0;i<3;i++) f[i].resize(n+7);\n\tfor(re int i=1,u,v;i<n;i++)\n\t\tscanf(\"%d%d\",&u,&v),e[u].pb(v),e[v].pb(u);\n\tDfs(1,0);\n\tprintf(\"%lld\\n\",(f[0][1]+m-1)%m);\n\treturn 0;\n}\n```\n\n---\n\n**\u795d\u5927\u5bb6\u5b66\u4e60\u6109\u5feb\uff01**",
        "postTime": 1585827211,
        "uid": 118365,
        "name": "George1123",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1332F \u3010Independent Set\u3011"
    },
    {
        "content": "[\u5ba3\u4f20 blog](https://autumnkite.github.io/)\uff08Github Pages \u4e0a\u4e0d\u53bb\u53ef\u4ee5\u7528 [Gitee \u4e0a\u7684\u955c\u50cf](https://autumnkite.gitee.io/)\uff09\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://codeforces.com/contest/1332/problem/F)\n\n### \u9898\u610f\n\n\u5bf9\u4e8e\u4e00\u4e2a\u65e0\u5411\u56fe $G=(V,E)$\uff0c\u4e00\u4e2a**\u72ec\u7acb\u96c6**\u662f\u4e00\u4e2a $V$ \u7684\u5b50\u96c6 $V'$\uff0c\u6ee1\u8db3\u5bf9\u4e8e\u6240\u6709 $u,v\\in V'$\uff0c\u6709 $(u,v)\\not\\in E$\u3002\n\n\u4e00\u4e2a**\u8fb9\u5bfc\u51fa\u5b50\u56fe**\u662f\u7531\u8fb9\u96c6 $E$ \u7684\u4e00\u4e2a\u5b50\u96c6 $E'$ \u4ee5\u53ca\u6240\u6709\u5728 $E'$ \u7684\u8fb9\u4e2d\u51fa\u73b0\u81f3\u5c11\u4e00\u6b21\u7684\u70b9\u7ec4\u6210\u7684\u3002\n\n\u7ed9\u5b9a\u4e00\u68f5\u6811 $G=(V,E)$\uff0c\u6211\u4eec\u5b9a\u4e49 $G[E']$ \u8868\u793a\u8fb9\u96c6\u4e3a $E'$ \u65f6 $G$ \u7684\u8fb9\u5bfc\u51fa\u5b50\u56fe\uff0c$w(G)$ \u8868\u793a\u56fe $G$ \u7684\u72ec\u7acb\u96c6\u6570\u91cf\u3002\u6c42\n$$\\sum_{E'\\subset E, E'\\ne \\varnothing} w(G[E'])$$\n\n$n\\le 3\\times 10^5$\uff0c\u7b54\u6848\u5bf9 $998\\,244\\,353$ \u53d6\u6a21\u3002\n\n### \u9898\u89e3\n\n\u5bf9\u4e8e\u4e00\u68f5\u6811\u6c42\u72ec\u7acb\u96c6\u6570\u91cf\uff0c\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u7528\u7b80\u5355\u7684 DP \u89e3\u51b3\u3002\n\n\u5728\u8fd9\u4e2a\u95ee\u9898\u4e2d\uff0c\u65e0\u975e\u5c31\u662f\u591a\u4e86\u53e6\u5916\u4e00\u4e2a\u51b3\u7b56\u2014\u2014\u65ad\u8fb9\u3002\u6211\u4eec\u4ecd\u7136\u8003\u8651\u4f7f\u7528 DP \u53bb\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002\u9996\u5148\u6211\u4eec\u5f3a\u5236\u4ee5 $1$ \u4e3a\u6839\u3002\n\n\u8bbe $f_{u,0/1,0/1}$ \u8868\u793a\u4ee5 $u$ \u4e3a\u6839\u7684\u5b50\u6811\uff0c$u$ \u4e0e\u7236\u4eb2\u7684\u8fb9\u5728/\u4e0d\u5728\u8fb9\u5bfc\u51fa\u5b50\u56fe\u5185\uff0c$u$ \u5728/\u4e0d\u5728\u72ec\u7acb\u96c6\u5185\u65f6\u7684\u65b9\u6848\u6570\u3002\u8f6c\u79fb\u5982\u4e0b\uff1a\n$$\n\\begin{aligned}\nf_{u,1,1} &= \\prod_{v\\in \\operatorname{son}(u)} (f_{v,0,0}+f_{v,0,1}+f_{v,1,0}) \\\\\nf_{u,1,0} &= \\prod_{v\\in \\operatorname{son}(u)} (f_{v,0,0}+f_{v,0,1}+f_{v,1,0}+f_{v,1,1}) \\\\\nf_{u,0,1} &= \\prod_{v\\in \\operatorname{son}(u)} (f_{v,0,0}+f_{v,0,1}+f_{v,1,0}) - \\prod_{v\\in \\operatorname{son}(u)} (f_{v,0,0}+f_{v,0,1})\\\\\nf_{u,0,0} &= \\prod_{v\\in \\operatorname{son}(u)} (f_{v,0,0}+f_{v,0,1}+f_{v,1,0}+f_{v,1,1})\n\\end{aligned}\n$$\n\n\u5f53 $u$ \u7684\u8fde\u8fb9\u90fd\u4e0d\u5728\u8fb9\u5bfc\u51fa\u5b50\u56fe\u5185\u65f6\u4e5f\u662f\u5408\u6cd5\u7684\uff0c\u4f46\u662f\u6b64\u65f6 $u$ \u4e0d\u80fd\u9009\u5728\u72ec\u7acb\u96c6\u5185\uff0c\u6240\u4ee5 $f_{u,0,1}$ \u7684\u8f6c\u79fb\u9700\u8981\u51cf\u53bb\u6240\u6709\u4e0e\u513f\u5b50\u7684\u8fb9\u90fd\u4e0d\u5728\u5b50\u56fe\u5185\u7684\u60c5\u51b5\uff0c\u800c $f_{u,0,0}$ \u4e0d\u9700\u8981\u51cf\u3002\n\n\u6700\u540e\u7b54\u6848\u5373\u4e3a $f_{1,0,0}+f_{1,0,1}-1$\uff08\u51cf $1$ \u662f\u51cf\u53bb\u8fb9\u96c6\u4e3a\u7a7a\u7684\u60c5\u51b5\uff09\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$\u3002\n\n### \u4ee3\u7801\n\n```cpp\nconst int N = 300005, P = 998244353;\nint n;\nstd::vector<int> E[N];\nint f[N][2][2];\nvoid dfs(int u, int fa = 0){\n\tint mul = 1;\n\tf[u][1][0] = f[u][1][1] = 1;\n\tfor (int v : E[u])\n\t\tif (v != fa){\n\t\t\tdfs(v, u);\n\t\t\tf[u][1][0] = 1ll * f[u][1][0] * (0ll + f[v][0][0] + f[v][0][1] + f[v][1][0] + f[v][1][1]) % P;\n\t\t\tf[u][1][1] = 1ll * f[u][1][1] * (0ll + f[v][0][0] + f[v][0][1] + f[v][1][0]) % P;\n\t\t\tmul = 1ll * mul * (0ll + f[v][0][0] + f[v][0][1]) % P;\n\t\t}\n\tf[u][0][1] = (f[u][1][1] - mul + P) % P;\n\tf[u][0][0] = f[u][1][0];\n}\nvoid solve(){\n\tread(n);\n\tfor (register int i = 1; i <= n; ++i) E[i].clear();\n\tfor (register int i = 1, u, v; i < n; ++i)\n\t\tread(u), read(v), E[u].push_back(v), E[v].push_back(u);\n\tdfs(1);\n\tprint((0ll + f[1][0][0] + f[1][0][1] + P - 1) % P);\n}\n```\n",
        "postTime": 1585881474,
        "uid": 20561,
        "name": "AutumnKite",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1332F \u3010Independent Set\u3011"
    },
    {
        "content": "### \u9898\u610f\n\n\u7ed9\u51fa\u4e00\u68f5 $n ~ (2 \\le n \\le 3 \\cdot 10 ^ 5)$ \u7684\u6811\uff0c\u6c42\u5176\u6240\u6709 $2 ^ {n  - 1} - 1$ \u79cd\u975e\u7a7a\u7684\u8fb9\u5bfc\u51fa\u5b50\u56fe\u4e2d\uff0c\u70b9\u72ec\u7acb\u96c6\u4e2a\u6570\u4e4b\u548c\u3002\u5bf9 $998\\ 244\\ 353$ \u53d6\u6a21\u3002\n\n### \u9898\u89e3\n\n\u6211\u5199\u7684\u4f3c\u4e4e\u662f\u4e00\u79cd\u5f88\u5947\u602a\u7684\u505a\u6cd5\uff0c\u8f6c\u79fb\u975e\u5e38\u5197\u6742\u3002\n\n\u9996\u5148\u8003\u8651\u5982\u679c\u6240\u6709\u8fb9\u90fd\u4fdd\u7559\uff0c\u70b9\u72ec\u7acb\u96c6\u4e2a\u6570\u5982\u4f55\u6c42\u3002\n\n\u8fd9\u662f\u4e00\u4e2a\u6811\u4e0a DP\uff0c\u7c7b\u4f3c [\u6ca1\u6709\u4e0a\u53f8\u7684\u821e\u4f1a](https://www.luogu.com.cn/problem/P1352)\u3002\u4ee5 $1$ \u53f7\u70b9\u4e3a\u6839\u8f6c\u6210\u6709\u6839\u6811\uff0c\u8bbe $f_{u, 0 / 1}$ \u8868\u793a\u5904\u7406\u5b8c\u4e86 $u$ \u5b50\u6811\u5185\uff0c$u$ \u662f\u5426\u9009\u62e9\u7684\u65b9\u6848\u6570\u3002\u679a\u4e3e\u513f\u5b50\u662f\u5426\u9009\u62e9\u8fdb\u884c\u8f6c\u79fb\uff0c\u628a\u90a3\u9898\u7684\u53d6 $\\max$ \u6539\u6210\u6c42\u548c\u5c31\u597d\u4e86\u3002\n\n\u8003\u8651\u5f53\u8fb9\u53ef\u4ee5\u65ad\u5f00\u65f6\uff0c\u4f1a\u53d1\u751f\u4ec0\u4e48\u6837\u7684\u53d8\u5316\u3002\n\n- \u76f8\u90bb\u7684\u4e24\u4e2a\u70b9\u53ef\u4ee5\u90fd\u8fdb\u884c\u9009\u62e9\uff0c\u53ea\u8981\u65ad\u5f00\u4e2d\u95f4\u7684\u90a3\u6761\u8fb9\u3002\n- \u5f53\u4e00\u4e2a\u70b9\u5468\u56f4\u7684\u6240\u6709\u8fb9\u90fd\u88ab\u65ad\u5f00\u65f6\uff0c\u8fd9\u4e2a\u70b9\u4f1a\u5728\u56fe\u4e2d\u88ab\u5220\u9664\uff0c\u76f8\u5f53\u4e8e\u5fc5\u987b\u4e0d\u9009\u62e9\u3002\n\n\u6211\u4eec\u518d\u589e\u52a0\u4e00\u7ef4\uff0c$f_{u, 0/1, 0/1}$ \u8868\u793a\u5904\u7406\u5b8c\u4e86 $u$ \u5b50\u6811\u5185\uff0c$u$ \u662f\u5426\u9009\u62e9\uff0c$u$ \u4ece\u513f\u5b50\u4e0a\u6765\u7684\u8fb9\u662f\u5426\u5168\u90e8\u65ad\u5f00\u3002\n\n\u63a5\u4e0b\u6765\u8ba8\u8bba\u5f53\u513f\u5b50 $v$ \u7684\u7b54\u6848\u52a0\u5165 $u$ \u65f6\uff0c\u600e\u6837\u8fdb\u884c\u8f6c\u79fb\u3002\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u8bbe\u52a0\u5165\u524d $u$ \u7684 DP \u6570\u7ec4\u4e3a $g_{0/1, 0/1}$\u3002\n\n---\n\n$f_{u, 0, 0}$ \u8868\u793a\u4e0d\u9009\u62e9 $u$\uff0c\u4e14\u4ece\u513f\u5b50\u4e0a\u6765\u7684\u8fb9\u6ca1\u6709\u5168\u90e8\u88ab\u65ad\u5f00\u3002\u9996\u5148\u5206\u539f\u6765\u60c5\u51b5\u5982\u4f55\u8fdb\u884c\u8ba8\u8bba\uff0c\u518d\u5206 $v$ \u7684\u60c5\u51b5\u8fdb\u884c\u8ba8\u8bba\uff1a\n  - $g_{0, 0}$\uff1a\u539f\u6765 $u$ \u5c31\u6709\u4ece\u513f\u5b50\u4e0a\u6765\u7684\u8fb9\uff0c\u90a3\u4e48\u6b64\u65f6 $u - v$ \u7684\u8fb9\u5220\u4e0d\u5220\u65e0\u6240\u8c13\uff0c\u65e0\u5f3a\u5236\u6027\u8981\u6c42\u3002\n    - $f_{v, 0, 0}$\uff1a\u4e0d\u9009\u62e9 $v$ \u4e14 $v$ \u80af\u5b9a\u4e0d\u4f1a\u6210\u4e3a\u5b64\u7acb\u70b9\u3002\u90a3\u4e48\u6b64\u65f6 $u - v$ \u8fd9\u6761\u8fb9\u9009\u4e0d\u9009\u90fd\u662f\u53ef\u884c\u7684\u3002\u56e0\u6b64\u5bf9 $f_{u, 0, 0}$ \u8d21\u732e\u4e3a $2 \\times f_{v, 0, 0} \\times g_{0, 0}$\u3002\n    - $f_{v, 0, 1}$\uff1a\u4e0d\u9009\u62e9 $v$ \u4e14 $v$ \u53ef\u80fd\u6210\u4e3a\u5b64\u7acb\u70b9\u3002\u9009\u62e9 $u - v$ \u8fd9\u6761\u8fb9\u663e\u7136\u6ca1\u95ee\u9898\uff1b\u82e5\u4e0d\u9009\u62e9\u8fd9\u6761\u8fb9\uff0c\u76f8\u5f53\u4e8e\u8ba9 $v$ \u6210\u4e3a\u5b64\u7acb\u70b9\uff0c\u4e5f\u5c31\u662f $v$ \u5f3a\u5236\u4e0d\u9009\u62e9\uff0c\u8fd9\u4e0e DP \u72b6\u6001\u4e2d \u201c\u4e0d\u9009\u62e9 $v$\u201d \u76f8\u7b26\uff0c\u6240\u4ee5\u4e5f\u662f\u53ef\u4ee5\u8f6c\u79fb\u7684\u3002\u56e0\u6b64\u5bf9 $f_{u, 0, 0}$ \u8d21\u732e\u4e3a $2 \\times f_{v, 0, 1} \\times g_{0, 0}$\u3002\n    - $f_{v, 1, 0}$\uff1a\u9009\u62e9 $v$ \u4e14 $v$ \u80af\u5b9a\u4e0d\u4f1a\u6210\u4e3a\u5b64\u7acb\u70b9\u3002\u90a3\u4e48\u6b64\u65f6 $u - v$ \u8fd9\u6761\u8fb9\u9009\u4e0d\u9009\u90fd\u662f\u53ef\u884c\u7684\u3002\u56e0\u6b64\u5bf9 $f_{u, 0, 0}$ \u8d21\u732e\u4e3a $2 \\times f_{v, 1, 0} \\times g_{0, 0}$\u3002\n    - $f_{v, 1, 1}$\uff1a\u9009\u62e9 $v$ \u4e14 $v$ \u80af\u5b9a\u4e0d\u53ef\u80fd\u6210\u4e3a\u5b64\u7acb\u70b9\u3002\u6b64\u65f6\u53ea\u6709\u9009\u62e9 $u - v$ \u8fd9\u6761\u8fb9\u662f\u53ef\u884c\u7684\uff0c\u82e5\u4e0d\u9009\u62e9\uff0c\u5219\u4f1a\u4e0e\u72b6\u6001\u77db\u76fe\uff08\u539f\u56e0\u89c1\u4e0a\u6587 $f_{v, 0, 1}$ \u8f6c\u79fb\u90e8\u5206\uff09\u3002\u56e0\u6b64\u5bf9 $f_{u, 0, 0}$ \u8d21\u732e\u4e3a $f_{v, 1, 1} \\times g_{0, 0}$\u3002\n  - $g_{0, 1}$\uff1a\u539f\u6765 $u$ \u6ca1\u6709\u4ece\u513f\u5b50\u4e0a\u6765\u7684\u8fb9\uff0c\u6b64\u65f6\u6709\u4e86\uff0c\u8bf4\u660e $u - v$ \u8fd9\u6761\u8fb9\u4e00\u5b9a\u9009\u62e9\u3002\n    - $f_{v, 0, 0}$\uff1a\u4e0d\u9009\u62e9 $v$ \u4e14 $v$ \u80af\u5b9a\u4e0d\u4f1a\u6210\u4e3a\u5b64\u7acb\u70b9\u3002\u663e\u7136\u9009\u62e9 $u - v$ \u8fd9\u6761\u8fb9\u53ef\u884c\u3002\u56e0\u6b64\u5bf9 $f_{u, 0, 0}$ \u8d21\u732e\u4e3a $f_{v, 0, 0} \\times g_{0, 1}$\u3002\n    - \u5269\u4e0b\u4e09\u79cd\u72b6\u6001\u7c7b\u4f3c\uff0c\u90fd\u5728\u5bf9 $g_{0, 0}$ \u8f6c\u79fb\u5206\u6790\u4e2d\u8ba4\u4e3a\u53ef\u884c\uff0c\u5bf9\u7b54\u6848\u90fd\u6709\u7cfb\u6570\u4e3a $1$ \u7684\u8d21\u732e\u3002\u91cd\u590d\u7684\u5206\u6790\u7701\u7565\u3002\n\n---\n\n$f_{u, 0, 1}$ \u8868\u793a\u4e0d\u9009\u62e9 $u$\uff0c\u4e14\u4ece\u513f\u5b50\u4e0a\u6765\u7684\u8fb9\u5168\u90e8\u88ab\u65ad\u5f00\u3002\u7c7b\u4f3c\u7684\u8fdb\u884c\u5206\u7c7b\u8ba8\u8bba\u5206\u6790\uff1a\n  - $g_{0, 0}$\uff1a\u539f\u6765 $u$ \u6709\u4ece\u513f\u5b50\u4e0a\u6765\u7684\u8fb9\uff0c\u4f46\u6b64\u65f6\u8981\u6c42\u6ca1\u6709\u4ece\u513f\u5b50\u4e0a\u6765\u7684\u8fb9\uff0c\u6761\u4ef6\u4e0d\u7b26\u5408\u3002\u8fd9\u4e00\u5927\u7c7b\u76f4\u63a5\u88ab\u526a\u53bb\u3002\n  - $g_{0, 1}$\uff1a\u539f\u6765 $u$ \u5c31\u65ad\u5f00\u4e86\u6240\u6709\u513f\u5b50\u4e0a\u6765\u7684\u8fb9\uff0c\u90a3\u4e48\u6b64\u65f6 $u - v$ \u7684\u8fb9\u540c\u6837\u9700\u8981\u65ad\u5f00\u3002\n    - $f_{v, 0, 0}$\uff1a\u4e0d\u9009\u62e9 $v$ \u4e14 $v$ \u80af\u5b9a\u4e0d\u4f1a\u6210\u4e3a\u5b64\u7acb\u70b9\u3002\u663e\u7136\u9009\u62e9 $u - v$ \u8fd9\u6761\u8fb9\u53ef\u884c\u3002\u56e0\u6b64\u5bf9 $f_{u, 0, 1}$ \u8d21\u732e\u4e3a $f_{v, 0, 0} \\times g_{0, 1}$\u3002\n    - \u4ed4\u7ec6\u89c2\u5bdf\uff0c\u53d1\u73b0\u8fd9\u6bb5\u548c $f_{u, 0, 0}$ \u5185 $g_{0, 1}$ \u7684\u8f6c\u79fb\u662f\u5b8c\u5168\u4e00\u6837\u7684\uff0c\u6545\u8fd9\u91cc\u4e5f\u7565\u8fc7\u3002\n\n---\n\n$f_{u, 1, 0}$\uff1a\u8868\u793a\u9009\u62e9 $u$\uff0c\u4e14\u4ece\u513f\u5b50\u4e0a\u6765\u7684\u8fb9\u6ca1\u6709\u5168\u90e8\u88ab\u65ad\u5f00\u3002\u5206\u7c7b\u8ba8\u8bba\u5982\u4e0b\uff1a\n  - $g_{1, 0}$\uff1a\u539f\u6765 $u$ \u5c31\u6709\u4ece\u513f\u5b50\u4e0a\u6765\u7684\u8fb9\uff0c\u90a3\u4e48\u6b64\u65f6 $u - v$ \u7684\u8fb9\u5220\u4e0d\u5220\u65e0\u6240\u8c13\uff0c\u65e0\u5f3a\u5236\u6027\u8981\u6c42\u3002\n    - $f_{v, 0, 0}$\uff1a\u4e0d\u9009\u62e9 $v$ \u4e14 $v$ \u80af\u5b9a\u4e0d\u4f1a\u6210\u4e3a\u5b64\u7acb\u70b9\u3002\u90a3\u4e48\u6b64\u65f6 $u - v$ \u8fd9\u6761\u8fb9\u9009\u4e0d\u9009\u90fd\u662f\u53ef\u884c\u7684\u3002\u56e0\u6b64\u5bf9 $f_{u, 1, 0}$ \u8d21\u732e\u4e3a $2 \\times f_{v, 0, 0} \\times g_{1, 0}$\u3002\n    - $f_{v, 0, 1}$\uff1a\u4e0d\u9009\u62e9 $v$ \u4e14 $v$ \u53ef\u80fd\u6210\u4e3a\u5b64\u7acb\u70b9\u3002\u6839\u636e\u4e0a\u6587\u5206\u6790 $u - v$ \u8fd9\u6761\u8fb9\u9009\u4e0d\u9009\u90fd\u662f\u53ef\u884c\u7684\u3002\u56e0\u6b64\u5bf9 $f_{u, 1, 0}$ \u8d21\u732e\u4e3a $2 \\times f_{v, 0, 1} \\times g_{1, 0}$\u3002\n    - $f_{v, 1, 0}$\uff1a\u9009\u62e9 $v$ \u4e14 $v$ \u80af\u5b9a\u4e0d\u4f1a\u6210\u4e3a\u5b64\u7acb\u70b9\u3002\u6b64\u65f6\u7531\u4e8e\u70b9\u72ec\u7acb\u96c6\u7684\u9650\u5236\uff0c\u8fd9\u6761\u8fb9\u5fc5\u987b\u65ad\u5f00\u3002\u56e0\u6b64\u5bf9 $f_{u, 1, 0}$ \u8d21\u732e\u4e3a $f_{v, 1, 0} \\times g_{1, 0}$\u3002\n    - $f_{v, 1, 1}$\uff1a\u9009\u62e9 $v$ \u4e14 $v$ \u53ef\u80fd\u6210\u4e3a\u5b64\u7acb\u70b9\u3002\u82e5\u4e0d\u65ad\u5f00\u8fb9\uff0c\u4f1a\u8fdd\u53cd\u70b9\u72ec\u7acb\u96c6\u7684\u9650\u5236\uff1b\u82e5\u65ad\u5f00\u8fb9\uff0c\u4f1a\u8fdd\u53cd\u5b64\u7acb\u70b9\u7684\u9650\u5236\u3002\u56e0\u6b64\u8fd9\u91cc\u65e0\u6cd5\u8fdb\u884c\u8f6c\u79fb\u3002\n  - $g_{1, 1}$\uff1a\u539f\u6765 $u$ \u6ca1\u6709\u4ece\u513f\u5b50\u4e0a\u6765\u7684\u8fb9\uff0c\u6b64\u65f6\u6709\u4e86\uff0c\u8bf4\u660e $u - v$ \u8fd9\u6761\u8fb9\u4e00\u5b9a\u9009\u62e9\u3002\n    - $f_{v, 0, 0}$\uff1a\u4e0d\u9009\u62e9 $v$ \u4e14 $v$ \u80af\u5b9a\u4e0d\u4f1a\u6210\u4e3a\u5b64\u7acb\u70b9\u3002\u663e\u7136\u9009\u62e9 $u - v$ \u8fd9\u6761\u8fb9\u53ef\u884c\u3002\u56e0\u6b64\u5bf9 $f_{u, 1, 0}$ \u8d21\u732e\u4e3a $f_{v, 0, 0} \\times g_{1, 1}$\u3002\n    - $f_{v, 0, 1}$\uff1a\u4e0d\u9009\u62e9 $v$ \u4e14 $v$ \u53ef\u80fd\u6210\u4e3a\u5b64\u7acb\u70b9\u3002\u663e\u7136\u9009\u62e9 $u - v$ \u8fd9\u6761\u8fb9\u53ef\u884c\u3002\u56e0\u6b64\u5bf9 $f_{u, 1, 0}$ \u8d21\u732e\u4e3a $f_{v, 0, 1} \\times g_{1, 1}$\u3002\n    - \u4e0a\u4e0b\u4e24\u79cd\u72b6\u6001\u7531\u4e8e\u70b9\u72ec\u7acb\u96c6\u7684\u9650\u5236\uff0c\u90fd\u4e0d\u6ee1\u8db3\u6761\u4ef6\uff0c\u65e0\u6cd5\u8fdb\u884c\u8f6c\u79fb\u3002\n\n---\n\n$f_{u, 1, 1}$\uff1a\u8868\u793a\u9009\u62e9 $u$\uff0c\u4e14\u4ece\u513f\u5b50\u4e0a\u6765\u7684\u8fb9\u5168\u90e8\u88ab\u65ad\u5f00\u3002\n  - $g_{1, 0}$\uff1a\u539f\u6765 $u$ \u6709\u4ece\u513f\u5b50\u4e0a\u6765\u7684\u8fb9\uff0c\u4f46\u6b64\u65f6\u8981\u6c42\u6ca1\u6709\u4ece\u513f\u5b50\u4e0a\u6765\u7684\u8fb9\uff0c\u6761\u4ef6\u4e0d\u7b26\u5408\u3002\u8fd9\u4e00\u5927\u7c7b\u76f4\u63a5\u88ab\u526a\u53bb\u3002\n  - $g_{1, 1}$\uff1a\u539f\u6765 $u$ \u5c31\u65ad\u5f00\u4e86\u6240\u6709\u513f\u5b50\u4e0a\u6765\u7684\u8fb9\uff0c\u90a3\u4e48\u6b64\u65f6 $u - v$ \u7684\u8fb9\u540c\u6837\u9700\u8981\u65ad\u5f00\u3002\n    - $f_{v, 0, 0}$\uff1a\u4e0d\u9009\u62e9 $v$ \u4e14 $v$ \u80af\u5b9a\u4e0d\u4f1a\u6210\u4e3a\u5b64\u7acb\u70b9\u3002\u663e\u7136\u65ad\u5f00 $u - v$ \u8fd9\u6761\u8fb9\u53ef\u884c\u3002\u56e0\u6b64\u5bf9 $f_{u, 1, 1}$ \u7684\u8d21\u732e\u4e3a $f_{v, 0, 0} \\times g_{1, 1}$\u3002\n    - $f_{v, 0, 1}$\uff1a\u4e0d\u9009\u62e9 $v$ \u4e14 $v$ \u53ef\u80fd\u6210\u4e3a\u5b64\u7acb\u70b9\u3002\u65ad\u5f00 $u - v$ \u8fd9\u6761\u8fb9\u53ef\u884c\u3002\u56e0\u6b64\u5bf9 $f_{u, 1, 1}$ \u7684\u8d21\u732e\u4e3a $f_{v, 0, 1} \\times g_{1, 1}$\u3002\n    - $f_{v, 1, 0}$\uff1a\u9009\u62e9 $v$ \u4e14 $v$ \u80af\u5b9a\u4e0d\u4f1a\u6210\u4e3a\u5b64\u7acb\u70b9\u3002\u65ad\u5f00 $u - v$ \u8fd9\u6761\u8fb9\u53ef\u884c\u3002\u56e0\u6b64\u5bf9 $f_{u, 1, 1}$ \u7684\u8d21\u732e\u4e3a $f_{v, 1, 0} \\times g_{1, 1}$\u3002\n    - $f_{v, 1, 1}$\uff1a\u9009\u62e9 $v$ \u4e14 $v$ \u53ef\u80fd\u6210\u4e3a\u5b64\u7acb\u70b9\u3002\u56e0\u4e3a\u5fc5\u987b\u65ad\u5f00\u8fd9\u6761\u8fb9\uff0c\u8fd9\u5c31\u4e0d\u6ee1\u8db3\u5b64\u7acb\u70b9\u7684\u9650\u5236\u3002\u56e0\u6b64\u8fd9\u91cc\u65e0\u6cd5\u8fdb\u884c\u8f6c\u79fb\u3002\n\n\u4e8e\u662f\u5c31\u8ba8\u8bba\u5b8c\u4e86\uff0c\u7801\u5c31\u5b8c\u4e8b\u4e86\u3002\u6700\u540e\u7684\u7b54\u6848\u4e3a $f_{1, 0, 0} + f_{1, 0, 1} + f_{1, 1, 0} - 1$\uff08\u56e0\u4e3a\u6709\u51cf\u53bb\u7a7a\u96c6\u7684\u60c5\u51b5\uff0c\u800c\u4e14 $f_{1, 1, 1}$ \u5b58\u5728 $1$ \u53f7\u70b9\u4f5c\u4e3a\u5b64\u7acb\u70b9\u5374\u88ab\u9009\u62e9\u6240\u4ee5\u4e0d\u5408\u6cd5\uff09\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n)$\u3002\n  \n\u4ee3\u7801\uff1a\n\n```cpp\n#include <algorithm>\n#include <bitset>\n#include <cassert>\n#include <climits>\n#include <cmath>\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <ctime>\n#include <functional>\n#include <iostream>\n#include <queue>\n#include <string>\n#include <utility>\n#include <vector>\n \nconst int MaxN = 300000;\nconst int Mod = 998244353;\n \nstruct Graph {\n  int cnte;\n  int Head[MaxN + 5], To[MaxN * 2 + 5], Next[MaxN * 2 + 5];\n \n  inline void addEdge(int from, int to) {\n    cnte++; To[cnte] = to;\n    Next[cnte] = Head[from]; Head[from] = cnte;\n  }\n};\n \nint N;\nint Fa[MaxN + 5], F[MaxN + 5][2][2];\nGraph Gr;\n \ninline int add(int x, int y) { return (x += y) >= Mod ? x - Mod : x; }\ninline int sub(int x, int y) { return (x -= y) < 0 ? x + Mod : x; }\ninline int mul(int x, int y) { return 1LL * x * y % Mod; }\ninline int pw(int x, int y) { int z = 1; for (; y; y >>= 1, x = mul(x, x)) if (y & 1) z = mul(z, x); return z; }\ninline int inv(int x) { return pw(x, Mod - 2); }\ninline int sep(int x, int y) { return mul(x, inv(y)); }\ninline void inc(int &x, int y = 1) { x = add(x, y); }\ninline void dec(int &x, int y = 1) { x = sub(x, y); }\n \nvoid init() {\n  scanf(\"%d\", &N);\n  for (int i = 1; i < N; ++i) {\n    int u, v;\n    scanf(\"%d %d\", &u, &v);\n    Gr.addEdge(u, v);\n    Gr.addEdge(v, u);\n  }\n}\n \nvoid dfs(int u) {\n  F[u][0][1] = F[u][1][1] = 1;\n  for (int i = Gr.Head[u]; i; i = Gr.Next[i]) {\n    int v = Gr.To[i];\n    if (v == Fa[u]) continue;\n    Fa[v] = u;\n    dfs(v);\n    int f[2][2];\n    f[0][0] = F[u][0][0], f[0][1] = F[u][0][1], f[1][0] = F[u][1][0], f[1][1] = F[u][1][1];\n    F[u][0][0] = add(mul(f[0][0], add(add(mul(F[v][0][0], 2), mul(F[v][0][1], 2)), add(mul(F[v][1][0], 2), F[v][1][1]))), mul(f[0][1], add(add(F[v][0][0], F[v][0][1]), add(F[v][1][0], F[v][1][1]))));\n    F[u][0][1] = mul(f[0][1], add(add(F[v][0][0], F[v][1][0]), F[v][0][1]));\n    F[u][1][0] = add(mul(f[1][0], add(add(mul(F[v][0][0], 2), mul(F[v][0][1], 2)), F[v][1][0])), mul(f[1][1], add(F[v][0][0], F[v][0][1])));\n    F[u][1][1] = mul(f[1][1], add(add(F[v][0][0], F[v][1][0]), F[v][0][1]));\n  }\n  // printf(\"f[%d] = (%d, %d, %d, %d)\\n\", u, F[u][0][0], F[u][0][1], F[u][1][0], F[u][1][1]);\n}\n \nvoid solve() {\n  dfs(1);\n  printf(\"%d\\n\", sub(add(add(F[1][0][0], F[1][1][0]), F[1][0][1]), 1));\n}\n \nint main() {\n  init();\n  solve();\n  return 0;\n}\n```",
        "postTime": 1585822020,
        "uid": 48843,
        "name": "Tweetuzki",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1332F \u3010Independent Set\u3011"
    },
    {
        "content": "\u7b80\u5355\u6811\u5f62 dp\u3002\n\n\u8bbe\u72b6\u6001 $dp_{i,0/1/2}$ \u5206\u522b\u8868\u793a\uff1a\n\n$dp_{i,0}$ \u8868\u793a\u7b2c $i$ \u4e2a\u70b9\u9009\u5165\u4e86\u5bfc\u51fa\u5b50\u56fe\u4e2d\u4f46\u4e0d\u9009\u5165\u72ec\u7acb\u96c6\u65f6 $i$ \u5b50\u6811\u5185\u7684\u65b9\u6848\u6570\n\n$dp_{i,1}$ \u8868\u793a\u7b2c $i$ \u4e2a\u70b9\u9009\u5165\u4e86\u5bfc\u51fa\u5b50\u56fe\u4e2d\u5e76\u9009\u5165\u72ec\u7acb\u96c6\u65f6 $i$ \u5b50\u6811\u5185\u7684\u65b9\u6848\u6570\u3002\n\n$dp_{i,2}$ \u8868\u793a\u7b2c $i$ \u4e2a\u70b9\u662f\u5426\u9009\u5165\u5bfc\u51fa\u5b50\u56fe\u9700\u8981\u5176\u7236\u4eb2\u8fde\u5411\u5176\u7684\u90a3\u6761\u8fb9\u786e\u5b9a\u65f6\u5b50\u6811\u5185\u7684\u65b9\u6848\u6570\u3002\n\n\u5bf9\u4e8e $dp_{i,0}$ \uff0c\u5f53\u6709\u4e00\u4e2a\u65b0\u5b50\u6811 $u$ \u52a0\u5165\u65f6\uff0c\u66f4\u65b0\u8fc7\u7a0b\u662f\n\n$$dp_{i,0}=dp_{i,0}\\times (dp_{u,0}+dp_{u,1}+dp_{u,2})+dp_{i,0}\\times(dp_{u,0}+dp_{u,1}+dp_{u,2}\\times 2)$$\n\n\u524d\u9762\u4e00\u90e8\u5206\u662f $i$ \u4e0d\u4e0e $u$ \u8fde\u8fb9\u7684\u60c5\u51b5\uff0c\u540e\u9762\u53cd\u4e4b\u3002\n\n\u5bf9\u4e8e $dp_{i,1}$ \uff0c\u5f53\u6709\u4e00\u4e2a\u65b0\u5b50\u6811 $u$ \u52a0\u5165\u65f6\uff0c\u66f4\u65b0\u8fc7\u7a0b\u662f\n\n$$dp_{i,1}=dp_{i,1}\\times (dp_{u,0}+dp_{u,1}+dp_{u,2})+dp_{i,1}\\times(dp_{u,0}+dp_{u,2})$$\n\n\u524d\u9762\u4e00\u90e8\u5206\u662f $i$ \u4e0d\u4e0e $u$ \u8fde\u8fb9\u7684\u60c5\u51b5\uff0c\u540e\u9762\u53cd\u4e4b\u3002\n\n\u5bf9\u4e8e $dp_{i,2}$ \uff0c\u5f53\u6709\u4e00\u4e2a\u65b0\u5b50\u6811 $u$ \u52a0\u5165\u65f6\uff0c\u66f4\u65b0\u8fc7\u7a0b\u662f\n\n$$dp_{i,2}=dp_{i,2}\\times (dp_{u,0}+dp_{u,1}+dp_{u,2})$$\n\n\u6ce8\u610f\u8fd9\u91cc\u7b97 $dp_{i,0}$ \u548c $dp_{i,1}$ \u7684\u65f6\u5019\u4e5f\u628a $dp_{i,2}$ \u7684\u60c5\u51b5\u5305\u62ec\u8fdb\u53bb\u4e86\uff0c\u6240\u4ee5 $dp_{i,0}-=dp_{i,2},dp_{i,1}-=dp_{i,2}$\u3002\n\t\n\u6700\u540e\u7b54\u6848\u4e3a $dp_{1,0}+dp_{1,1}+dp_{1,2}-1$\uff0c\u8981\u51cf\u53bb\u6bcf\u4e2a\u70b9\u90fd\u4e0d\u9009\u5165\u5bfc\u51fa\u5b50\u56fe\u7684\u60c5\u51b5\u3002\n```\n//QwQcOrZ yyds!!!\n#include<bits/stdc++.h>\n#define ll long long\n#define foor(i,a,b) for (int i=(a);i<=(b);i++)\n#define door(i,a,b) for (int i=(a);i>=(b);i--)\n#define go(i,x) for (int i=head[x];i;i=e[i].nx)\n#define IOS ios::sync_with_stdio(false)\n#define mp make_pair\n#define pb push_back\n#define pa pair < int,int >\n#define fi first\n#define se second\n#define re register\n#define be begin()\n#define en end()\n#define sqr(x) ((x)*(x))\n#define ret return puts(\"-1\"),0;\n#define put putchar('\\n')\n#define inf 1000000005\n#define mod 998244353\n#define int ll\n#define N 300005\nusing namespace std;\ninline char gc(){static char buf[1000000],*p1=buf,*p2=buf;return p1==p2&&(p2=(p1=buf)+fread(buf,1,1000000,stdin),p1==p2)?EOF:*p1++;}\n#define gc getchar\ninline ll read(){char c=gc();ll su=0,f=1;for (;c<'0'||c>'9';c=gc()) if (c=='-') f=-1;for (;c>='0'&&c<='9';c=gc()) su=su*10+c-'0';return su*f;}\ninline void write(ll x){if (x<0){putchar('-');write(-x);return;}if (x>=10) write(x/10);putchar(x%10+'0');}\ninline void writesp(ll x){write(x),putchar(' ');}\ninline void writeln(ll x){write(x);putchar('\\n');}\nint n,dp[N][5];\nint ans;\nvector<int>G[N];\nvoid ad(int x,int y)\n{\n\tG[x].push_back(y);\n}\nvoid dfs(int k,int fa)\n{\n\tdp[k][0]=1;\n\tdp[k][1]=1;\n\tdp[k][2]=1;\n\tfor (auto u:G[k])\n\t{\n\t\tif (u==fa) continue;\n\t\tdfs(u,k);\n\t\tdp[k][0]=(dp[k][0]*(dp[u][0]+dp[u][1]+dp[u][2])%mod+dp[k][0]*(dp[u][0]+dp[u][1]+dp[u][2]*2)%mod)%mod;\n\t\tdp[k][1]=(dp[k][1]*(dp[u][0]+dp[u][1]+dp[u][2])%mod+dp[k][1]*(dp[u][0]+dp[u][2])%mod)%mod;\n\t\tdp[k][2]=(dp[k][2]*(dp[u][0]+dp[u][1]+dp[u][2])%mod);\n\t}\n\tdp[k][0]=(dp[k][0]-dp[k][2]+mod)%mod;\n\tdp[k][1]=(dp[k][1]-dp[k][2]+mod)%mod;\n}\nsigned main()\n{\n\tn=read();\n\tfor (int i=1;i<n;i++)\n\t{\n\t\tint u=read(),v=read();\n\t\tad(u,v);\n\t\tad(v,u);\n\t}\n\tdfs(1,0);\n\twriteln(((dp[1][0]+dp[1][1]+dp[1][2])%mod-1+mod)%mod);\n}\n/*\n\n*/\n```\n\n",
        "postTime": 1632826379,
        "uid": 120911,
        "name": "Lynkcat",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1332F Independent Set"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](http://lycltb.top/post/solution-cf1332f/)\n\n\u7eaa\u5ff5\u7b2c\u4e00\u9053\u81ea\u5df1\u5199\u51fa\u6765\u7684 *2500\n\n\u4e0d\u59a8\u5047\u8bbe\u6839\u8282\u70b9\u4e3a $1$\u3002\n\n\u8003\u8651 $dp$\uff1a\u8bbe $dp_{i,x,y}$ ( $x,y \\in [0,1]$ ) \u8868\u793a\u4ee5 $i$ \u4e3a\u6839\u7684\u5b50\u6811\u5185\uff0c\u662f\u5426\u9009 $i$ \u4e0a\u9762\u7684\u8fb9 ( $x$ )\uff0c\u662f\u5426\u9009\u8282\u70b9 $i$ ( $y$ ) \u7684\u7b54\u6848\u3002\n\n\u201c\u662f\u5426\u9009 $i$ \u4e0a\u9762\u7684\u8fb9\u201d\u7684\u610f\u601d\u662f \u8fde\u63a5 $i$ \u4e0e $i$ \u7684\u7236\u8282\u70b9\u7684\u8fb9 \u662f\u5426\u5305\u62ec\u5728\u5f53\u524d\u8fd9\u4e2a\u8fb9\u5bfc\u51fa\u5b50\u56fe\u4e2d\u3002\n\n\u201c\u662f\u5426\u9009\u8282\u70b9 $i$\u201d\u7684\u610f\u601d\u662f\u8282\u70b9 $i$ \u662f\u5426\u5305\u62ec\u5728\u5f53\u524d\u8fd9\u4e2a\u70b9\u72ec\u7acb\u96c6\u4e2d\u3002\n\n\u8003\u8651\u8f6c\u79fb\uff1a\n$$\ndp_{i,0,0}=\\prod\\limits_{j\\in son_i} dp_{j,0,0}+dp_{j,0,1}+dp_{j,1,0}+dp_{j,1,1}\n$$\n$$\ndp_{i,1,0}=\\prod\\limits_{j\\in son_i} dp_{j,0,0}+dp_{j,0,1}+dp_{j,1,0}+dp_{j,1,1}\n$$\n$$\ndp_{i,1,1}=\\prod\\limits_{j\\in son_i} dp_{j,0,0}+dp_{j,0,1}+dp_{j,1,0}\n$$\n$dp_{i,0,1}$ \u7684\u8f6c\u79fb\u7a0d\u5fae\u590d\u6742\u4e00\u70b9\uff1a\n$$\ndp_{i,0,1}=\\left(\\prod\\limits_{j\\in son_i} dp_{j,0,0}+dp_{j,0,1}+dp_{j,1,0}\\right)\n-\n\\left( \\prod\\limits_{j\\in son_i} dp_{j,0,1}+dp_{j,0,0} \\right)\n$$\n\u5982\u679c\u8282\u70b9 $i$ \u5728\u5b50\u56fe\u4e2d\uff0c\u800c\u8fd9\u4e2a\u70b9 $i$ \u4e0a\u65b9\u7684\u8fb9\u53c8\u4e0d\u5728\u5b50\u56fe\u4e2d\uff0c\u90a3\u4e48\u9700\u8981\u5b83\u7684\u4e00\u4e2a\u5b50\u8282\u70b9\u63d0\u4f9b\u4e00\u6761\u8fb9\u4f7f\u5f97\u5b83\u5728\u5b50\u56fe\u4e2d\u3002\u4e8e\u662f\u8003\u8651\u8865\u96c6\u8f6c\u5316\uff0c\u7528\u603b\u65b9\u6848\u6570\u51cf\u53bb\u6ca1\u6709\u8fb9\u8fde\u5411\u8282\u70b9 $i$ \u7684\u65b9\u6848\u6570\uff0c\u5373\u5f97\u5230\u4e0a\u5f0f\u3002\n\n\u6ce8\u610f\u9898\u76ee\u4e2d\u7ed9\u51fa\u7684\u662f **\u975e\u7a7a** \u8fb9\u5bfc\u51fa\u5b50\u56fe\uff0c\u6700\u540e\u7b54\u6848\u8981\u51cf\u4e00\u3002\n\n```cpp\n// 2020.11.22\n// Code by LTb\n#include <bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define debug puts(\"QwQ\");\ninline int read(){\n    int x=0,f=1;\n    char ch;\n    while(ch<'0'||ch>'9') {if(ch=='-')f=-1;ch=getchar();}\n    while(ch>='0'&&ch<='9') {x=x*10+ch-'0';ch=getchar();}\n    return f*x;\n}\n\nconst int MAXN=300005;\nconst int MOD=998244353;\nint n;\nvector<int> v[MAXN];\nint dp[MAXN][2][2];\n//          \u8fb9\u3000\u70b9\nbool vis[MAXN];\n\nvoid dfs(int p){\n\t// \u9009\u70b9\u9009\u8fb9\uff1a\u9009\u70b9\u4e0d\u9009\u8fb9 / \u9009\u8fb9\u4e0d\u9009\u70b9 / \u4e0d\u9009\u8fb9\u4e0d\u9009\u70b9\n\t// \u4e0d\u9009\u70b9\u9009\u8fb9\uff1a\u9009\u70b9\u4e0d\u9009\u8fb9 / \u9009\u8fb9\u4e0d\u9009\u70b9 / \u4e0d\u9009\u8fb9\u4e0d\u9009\u70b9 / \u9009\u70b9\u9009\u8fb9\n\t// \u4e0d\u9009\u70b9\u4e0d\u9009\u8fb9\uff1a\u9009\u70b9\u4e0d\u9009\u8fb9 / \u9009\u8fb9\u4e0d\u9009\u70b9 / \u4e0d\u9009\u8fb9\u4e0d\u9009\u70b9 / \u9009\u70b9\u9009\u8fb9\n\t// \u9009\u70b9\u4e0d\u9009\u8fb9\uff1a\u9009\u70b9\u4e0d\u9009\u8fb9 / \u9009\u8fb9\u4e0d\u9009\u70b9 / \u4e0d\u9009\u8fb9\u4e0d\u9009\u70b9 - \u9009\u70b9\u4e0d\u9009\u8fb9 / \u4e0d\u9009\u8fb9\u4e0d\u9009\u70b9\n\tvis[p]=true;\n\tint cnt1=1,cnt2=1,cnt0=1;\n\tfor (int i:v[p]){\n\t\tif (vis[i]) continue;\n\t\tdfs(i);\n\t\tcnt1=cnt1*(dp[i][0][1]+dp[i][0][0]+dp[i][1][0])%MOD;\n\t\tcnt2=cnt2*(dp[i][0][1]+dp[i][0][0]+dp[i][1][0]+dp[i][1][1])%MOD;\n\t\tcnt0=cnt0*(dp[i][0][1]+dp[i][0][0])%MOD;\n\t}\n\n\tdp[p][1][0]=dp[p][0][0]=cnt2;\n\tdp[p][1][1]=cnt1;\n\tdp[p][0][1]=(cnt1-cnt0+MOD)%MOD;\n}\n\nsigned main()\n\n{\n\tn=read();\n\tfor (int i=1;i<n;i++){\n\t\tint x=read(),y=read();\n\t\tv[x].push_back(y);\n\t\tv[y].push_back(x);\n\t}\n\n\tdfs(1);\n\tcout<<((dp[1][0][1]+dp[1][0][0]+MOD-1)%MOD)<<endl;\n\treturn 0;\n}\n```\n\n",
        "postTime": 1606043954,
        "uid": 48981,
        "name": "LTb_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1332F \u3010Independent Set\u3011"
    }
]
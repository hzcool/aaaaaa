[
    {
        "content": "> CF1584G. [Eligible Segments](https://codeforces.ml/problemset/problem/1584/G) *3200\n\n\u6211\u8d85\uff0c\u8da3\u9898\uff0c\u597d\u795e\uff01\n\n\u6211\u4eec\u53ea\u9700\u8981\u8fdb\u884c\u8fd9\u6837\u4e00\u6b65\u8f6c\u5316\uff1a\u770b\u5230\u9898\u76ee\uff0c\u6211\u9996\u5148\u60f3\u5230\u7684\u662f\u6c42\u4e00\u4e2a\u4f20\u9001\u5e26\u56fe\u5f62\u662f\u5426\u8986\u76d6\u6240\u6709\u70b9\uff0c\u8fd9\u662f\u4e0d\u597d\u505a\u7684\u3002\u4f46\u662f\uff0c\u4e00\u4e2a\u70b9 $p$ \u8ddd\u79bb\u7ebf\u6bb5 $AB$ \u7684\u957f\u5ea6\u4e3a $R$ \u53ef\u4ee5\u770b\u505a\u7ebf\u6bb5 $AB$ \u7ecf\u8fc7\u4ee5 $p$ \u4e3a\u5706\u5fc3\uff0c$R$ \u4e3a\u534a\u5f84\u7684\u5706\uff01\u8fd9\u6837\u5c31\u6e05\u6670\u8bb8\u591a\u4e86\uff1a\u679a\u4e3e\u7ebf\u6bb5\u7684\u4e00\u7aef $p_i$\uff0c\u90a3\u4e48\u5408\u6cd5\u7684 $p_j$ \u4e00\u5b9a\u843d\u5728\u4ee5\u6240\u6709 $p_k$ \u4e3a\u5706\u5fc3\uff0c$R$ \u4e3a\u534a\u5f84\u4f5c\u5706\uff0c$p_i$ \u4e0e\u6bcf\u4e2a\u5706\u7684\u4e24\u6761\u5207\u7ebf\u5f62\u6210\u7684\u5939\u89d2\u7684\u4ea4\u8fd9\u4e00\u8303\u56f4\u91cc\u3002\u662f\u5145\u8981\u6761\u4ef6\u5417\uff1f\u4e0d\uff0c\u53cd\u8fc7\u6765\u4e5f\u8981\u6ee1\u8db3 $p_i$ \u843d\u5728 $p_j$ \u4e0e\u6bcf\u4e2a\u5706\u7684\u5939\u89d2\u7684\u4ea4\u8303\u56f4\u5185\u3002\u8fd9\u662f\u56e0\u4e3a $p$ \u4e0e\u7ebf\u6bb5 $AB$ \u7684\u8ddd\u79bb\u7b49\u4e8e $p$ \u4e0e\u5c04\u7ebf $AB$ \u548c\u5c04\u7ebf $BA$ \u7684\u8ddd\u79bb\u6700\u5927\u503c\u3002\n\n\u8fd9\u5c31\u505a\u5b8c\u4e86\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u70b9\u6c42\u5939\u89d2\u4ea4\u662f\u7ebf\u6027\u7684\uff08\u9700\u8981\u4e00\u70b9\u6570\u5b66\u57fa\u7840\uff09\uff0c\u68c0\u67e5\u4e5f\u662f\u7ebf\u6027\u7684\uff0c\u56e0\u6b64\u603b\u590d\u6742\u5ea6\u5e73\u65b9\u3002\u6ce8\u610f\u7cbe\u5ea6\u3002\n\n\u9644\uff1a\u5f53\u7136\uff0c\u4e00\u4e2a\u5173\u952e\u6027\u8d28\u662f\u5939\u89d2\u5927\u5c0f $\\leq \\pi$\uff0c\u5426\u5219\u957f\u5ea6\u4e3a $2\\pi$ \u7684\u73af\u4e0a\u533a\u95f4\u4ea4\u4f1a\u5206\u88c2\u51fa\u5f88\u591a\u5b50\u533a\u95f4\uff0c\u5c31\u4e0d\u53ef\u505a\u4e86\u3002\n\n**\u542f\u793a\uff1a\u8ba1\u7b97\u51e0\u4f55\u9898\u76ee\u8574\u542b\u4e86\u56fe\u5f62\u7684\u76f8\u5bf9\u6027\uff0c\u505a\u9898\u65f6\u5c1d\u8bd5\u4ece\u8fd9\u79cd\u76f8\u5bf9\u6027\u5165\u624b**\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define double long double\nconst int N = 3e3 + 5;\nconst double PI = acos(-1);\nconst double eps = 1e-9;\n\nint n, R, x[N], y[N], ans; bool ban[N][N];\ndouble sq(double x) {return x * x;}\ndouble dis(int i, int j) {return sqrt(sq(x[i] - x[j]) + sq(y[i] - y[j]));}\ndouble Arg(int i, int j) {\n\tif(x[i] == x[j]) return y[j] > y[i] ? PI / 2 : PI * 3 / 2;\n\tif(y[i] == y[j]) return x[j] > x[i] ? 0 : PI;\n\tdouble T = atan2(abs(y[j] - y[i]), abs(x[j] - x[i]));\n\tif(x[i] < x[j] && y[i] < y[j]) return T;\n\tif(x[i] > x[j] && y[i] < y[j]) return PI - T;\n\tif(x[i] > x[j] && y[i] > y[j]) return PI + T;\n\tif(x[i] < x[j] && y[i] > y[j]) return 2 * PI - T;\n} // \u6c42 p_i \u5411 p_j \u7684\u5939\u89d2\n\nstruct Interval {\n\tdouble l, r;\n\tInterval(double _l, double _r) {l = _l, r = _r;}\n\tInterval shift(double del) {return Interval(l + del, r + del);}\n\tbool In(double x) {return l - eps <= x && x <= r + eps;}\n}; Interval Intersect(Interval x, Interval y) {return Interval(max(x.l, y.l), min(x.r, y.r));}\n\nint main(){\n\tcin >> n >> R;\n\tfor(int i = 1; i <= n; i++) cin >> x[i] >> y[i];\n\tfor(int i = 1; i <= n; i++) {\n\t\tInterval seq(0, 2 * PI); bool split = 0; // split \u8868\u793a\u662f\u5426\u8986\u76d6 x \u8f74\u6b63\u534a\u8f74\uff0c\u82e5\u8986\u76d6\u5219\u7528 [l, r] \u8868\u793a\u5176\u4e2d l < 0 < r\u3002\n\t\tfor(int j = 1; j <= n && seq.l - eps < seq.r; j++) {\n\t\t\tdouble d = dis(i, j);\n\t\t\tif(d <= R) continue;\n\t\t\tdouble alpha = Arg(i, j), theta = asin(R / d);\n\t\t\tInterval cur(alpha - theta - eps, alpha + theta + eps); // \u6ce8\u610f\u7cbe\u5ea6\uff0c\u4ee5\u53ca\u6d6e\u70b9\u6570\u6bd4\u8f83\u65f6\u7684\u8bef\u5dee\n\t\t\tif(cur.r > 2 * PI) cur = cur.shift(-2 * PI);\n\t\t\tInterval nw = Intersect(seq, cur);\n\t\t\tif(cur.l < 0) { // \u8986\u76d6 x \u8f74\u6b63\u534a\u8f74\n\t\t\t\tif(split) seq = nw;\n\t\t\t\telse {\n\t\t\t\t\tif(seq.l == 0 && seq.r == 2 * PI) seq = cur;\n\t\t\t\t\telse if(nw.l - eps < nw.r) seq = nw;\n\t\t\t\t\telse seq = Intersect(seq.shift(-2 * PI), cur);\n\t\t\t\t\tsplit = 1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif(split) {\n\t\t\t\t\tif(nw.l - eps < nw.r) seq = nw;\n\t\t\t\t\telse seq = Intersect(seq, cur.shift(-2 * PI));\n\t\t\t\t} else seq = nw;\n\t\t\t}\n\t\t}\n\t\tif(seq.l - eps > seq.r) {\n\t\t\tfor(int j = 1; j <= n; j++) ban[i][j] = 1;\n\t\t\tcontinue;\n\t\t} \n\t\tfor(int j = 1; j <= n; j++) {\n\t\t\tif(i == j) continue;\n\t\t\tdouble alpha = Arg(i, j);\n\t\t\tban[i][j] |= !seq.In(alpha) && !seq.shift(2 * PI).In(alpha);\n\t\t}\n\t}\n\tfor(int i = 1; i <= n; i++)\n\t\tfor(int j = i + 1; j <= n; j++)\n\t\t\tans += !ban[i][j] && !ban[j][i];\n\tcout << ans << endl;\n\treturn 0;\n}\n```",
        "postTime": 1638152572,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "CF1584G Eligible Segments"
    }
]
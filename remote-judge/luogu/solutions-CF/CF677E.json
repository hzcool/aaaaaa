[
    {
        "content": "\u601d\u7ef4\u96be\u5ea6\u975e\u5e38\u4f4e\uff0c\u4f46\u662f\u5199\u8d77\u6765\u6709\u70b9\u641e\u4eba\u7684 $2300$\u3002\n\n\u6211\u4eec\u5148\u679a\u4e3e\u90a3\u4e2a\u5341\u5b57\u4e2d\u5fc3\u3002\n\n\u90a3\u4e48\u679a\u4e3e\u8fd9\u4e2a\u4e2d\u5fc3\u4e4b\u540e\u4e00\u5b9a\u662f\u5c3d\u53ef\u80fd\u6269\u5c55\uff0c\u4f46\u662f\u4e0d\u80fd\u6269\u5c55\u5230 $0$ \u70b9\u3002\n\n\u7136\u540e\u8fd9\u4e1c\u897f\u53ef\u4ee5\u968f\u624b\u4e8c\u5206\u957f\u5ea6\uff0c\u7edf\u8ba1\u5bf9\u89d2\u7ebf\u4e4b\u7c7b\u7684\u53ef\u4ee5\u7528\u524d\u7f00\u548c\u3002\n\n\u8fd9\u65f6\u5019\u6211\u4eec\u53d1\u73b0\uff0c\u4ed6\u7684\u4e58\u79ef\u7a0d\u5fae\u6709\u70b9\u5927\uff0c\u6ca1\u529e\u6cd5\u5feb\u901f\u6bd4\u8f83\u5927\u5c0f\u3002\n\n\u6211\u4eec\u53d1\u73b0\u6240\u6709\u7684\u4e58\u79ef\u90fd\u662f $2^x \\times 3^y$\u3002\n\n\u52a0\u5165\u8bf4\u6211\u4eec\u6bd4\u8f83 $2^a \\times 3^b$ \u548c $2^x \\times 3^y$\uff0c\u90a3\u4e48\u5fc5\u7136\u662f\u4f5c\u5546\u6bd4\u8f83\uff0c\u7136\u540e\u53ef\u4ee5\u7ea6\u5230\u4e00\u4e9b\u6570\u53d8\u6210\u4e86 $2^c$ \u548c $3^z$ \u8fdb\u884c\u6bd4\u8f83\uff0c\u53d6\u4e2a\u5bf9\u6570\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u5177\u4f53\u7684\uff0c\u53ef\u4ee5\u4e24\u8fb9\u540c\u65f6\u8fdb\u884c $\\log_2$\uff0c\u53d8\u6210\u4e86 $c$ \u548c $z \\times \\log_{2}^3$ \u8fdb\u884c\u6bd4\u8f83\u5927\u5c0f\u3002\n\n\u7136\u540e\u7edf\u8ba1\u4e00\u4e0b\u6700\u5927\u503c\u5373\u53ef\u3002\n\n\u81ea\u8ba4\u4e3a\u5b9e\u73b0\u7684\u8fd8\u7b97\u597d\u5199\u7ed9\u53c2\u8003\u4e00\u4e0b\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long \n#define pii pair<int,int>\n#define fi first\n#define se second\nusing namespace std;\nconst int INF=1e3+5;\nconst int Mod=1e9+7;\nint n;\nchar Map[INF][INF];\nnamespace S0{\n\tint sum[INF][INF],sum1[INF][INF],sum2[INF][INF],sum3[INF][INF];\n\tvoid init() {\n\t\tfor (int i=1;i<=n;i++) {\n\t\t\tfor (int j=1;j<=n;j++) \n\t\t\t\tsum[i][j]=sum[i-1][j]+(Map[i][j]=='0');\n\t\t}\n\t\t\n\t\tfor (int i=1;i<=n;i++) {\n\t\t\tfor (int j=1;j<=n;j++)\n\t\t\t\tsum1[i][j]=sum1[i][j-1]+(Map[i][j]=='0');\n\t\t}\n\t\t\n\t\tfor (int i=1;i<=n;i++)\n\t\t\tfor (int j=1;j<=n;j++)\n\t\t\t\tsum2[i][j]=sum2[i-1][j-1]+(Map[i][j]=='0');\n\t\t\n\t\tfor (int i=1;i<=n;i++)\n\t\t\tfor (int j=n;j>=1;j--)\n\t\t\t\tsum3[i][j]=sum3[i-1][j+1]+(Map[i][j]=='0');\n\t}\n};\nnamespace S2{\n\tint sum[INF][INF],sum1[INF][INF],sum2[INF][INF],sum3[INF][INF];\n\tvoid init() {\n\t\tfor (int i=1;i<=n;i++) {\n\t\t\tfor (int j=1;j<=n;j++) \n\t\t\t\tsum[i][j]=sum[i-1][j]+(Map[i][j]=='2');\n\t\t}\n\t\t\n\t\tfor (int i=1;i<=n;i++) {\n\t\t\tfor (int j=1;j<=n;j++)\n\t\t\t\tsum1[i][j]=sum1[i][j-1]+(Map[i][j]=='2');\n\t\t}\n\t\t\n\t\tfor (int i=1;i<=n;i++)\n\t\t\tfor (int j=1;j<=n;j++)\n\t\t\t\tsum2[i][j]=sum2[i-1][j-1]+(Map[i][j]=='2');\n\t\t\n\t\tfor (int i=1;i<=n;i++)\n\t\t\tfor (int j=n;j>=1;j--)\n\t\t\t\tsum3[i][j]=sum3[i-1][j+1]+(Map[i][j]=='2');\n\t}\n};\nnamespace S3{\n\tint sum[INF][INF],sum1[INF][INF],sum2[INF][INF],sum3[INF][INF];\n\tvoid init() {\n\t\tfor (int i=1;i<=n;i++) {\n\t\t\tfor (int j=1;j<=n;j++) \n\t\t\t\tsum[i][j]=sum[i-1][j]+(Map[i][j]=='3');\n\t\t}\n\t\t\n\t\tfor (int i=1;i<=n;i++) {\n\t\t\tfor (int j=1;j<=n;j++)\n\t\t\t\tsum1[i][j]=sum1[i][j-1]+(Map[i][j]=='3');\n\t\t}\n\t\t\n\t\tfor (int i=1;i<=n;i++)\n\t\t\tfor (int j=1;j<=n;j++)\n\t\t\t\tsum2[i][j]=sum2[i-1][j-1]+(Map[i][j]=='3');\n\t\t\n\t\tfor (int i=1;i<=n;i++)\n\t\t\tfor (int j=n;j>=1;j--)\n\t\t\t\tsum3[i][j]=sum3[i-1][j+1]+(Map[i][j]=='3');\n\t}\n};\n\nint check(int x,int y,int l) {\n\tif (x-l+1<=0 || x+l-1>n) return 0;\n\tif (y-l+1<=0 || y+l-1>n) return 0;\n\tif (S0::sum[x+l-1][y]-S0::sum[x-l][y]>0) return 0;\n\tif (S0::sum1[x][y+l-1]-S0::sum1[x][y-l]>0) return 0;\n\treturn 1;\n}\n\nint check1(int x,int y,int l) {\n\tif (x-l+1<=0 || x+l-1>n) return 0;\n\tif (y-l+1<=0 || y+l-1>n) return 0;\n\treturn S2::sum[x+l-1][y]-S2::sum[x-l][y]+S2::sum1[x][y+l-1]-S2::sum1[x][y-l];\n}\n\nint check2(int x,int y,int l) {\n\tif (x-l+1<=0 || x+l-1>n) return 0;\n\tif (y-l+1<=0 || y+l-1>n) return 0;\n\treturn S3::sum[x+l-1][y]-S3::sum[x-l][y]+S3::sum1[x][y+l-1]-S3::sum1[x][y-l];\n}\n\npii ans1;\nint com(pii x,pii y) {\n//\tcout<<x.fi<<\" \"<<x.se<<\" \"<<y.fi<<\" \"<<y.se<<\" endl\\n\";\n\tif (x.fi>=y.fi) x.fi-=y.fi,y.fi=0;\n\telse y.fi-=x.fi,x.fi=0;\n\t\n\tif (x.se>=y.se) x.se-=y.se,y.se=0;\n\telse y.se-=x.se,x.se=0;\n\t\n\tif (x.fi==0 && x.se==0) return 1;\n\tif (y.fi==0 && y.se==0) return 0;\n\tif (x.fi && y.se) {\n\t\tlong double xx=x.fi,yy=y.se*log2(3);\n\t\tif (xx<yy) return 1;\n\t\treturn 0;\n\t}\n\tif (x.se && y.fi) {\n\t\tlong double xx=x.se*log2(3),yy=y.fi;\n\t\tif (xx<yy) return 1;\n\t\treturn 0;\n\t}\n\treturn 0;\n}\nint ksm(int x,int y) {\n\tint ba=x%Mod,ans=1;\n\twhile (y) {\n\t\tif (y&1) ans=(ans*ba)%Mod;\n\t\tba=(ba*ba)%Mod;y>>=1;\n\t}\n\treturn ans;\n}\nnamespace Sub {\n\tint check(int x,int y,int l) {\n\t\tif (x-l+1<=0 || x+l-1>n) return 0;\n\t\tif (y-l+1<=0 || y+l-1>n) return 0;\n\t\tif (S0::sum2[x+l-1][y+l-1]-S0::sum2[x-l][y-l]>0) return 0;\n//\t\tcout<<S0::sum3[3][2]<<\" qwe\\n\";\n\t\tif (S0::sum3[x+l-1][y-l+1]-S0::sum3[x-l][y+l]>0) return 0;\n\t\treturn 1;\n\t}\n\tint check1(int x,int y,int l) {\n\t\treturn S2::sum2[x+l-1][y+l-1]-S2::sum2[x-l][y-l]+S2::sum3[x+l-1][y-l+1]-S2::sum3[x-l][y+l];\n\t}\n\tint check2(int x,int y,int l) {\n\t\treturn S3::sum2[x+l-1][y+l-1]-S3::sum2[x-l][y-l]+S3::sum3[x+l-1][y-l+1]-S3::sum3[x-l][y+l];\n\t}\n\tvoid solve() {\n\t\tfor (int i=1;i<=n;i++)\n\t\t\tfor (int j=1;j<=n;j++) {\n\t\t\t\tint l=0,r=1e9,ans=-1;\n\t\t\t\twhile (l<=r) {\n\t\t\t\t\tint Mid=(l+r)>>1;\n\t\t\t\t\tif (check(i,j,Mid)) l=(ans=Mid)+1;\n\t\t\t\t\telse r=Mid-1;\n\t\t\t\t}\n\t\t\t\tif (ans==-1) continue;\n//\t\t\t\tcout<<i<<\" \"<<j<<\" \"<<ans<<\" kel\\n\";\n\t\t\t\tpii xx={check1(i,j,ans),check2(i,j,ans)};\n\t\t\t\tif (Map[i][j]=='2') xx.fi--;\n\t\t\t\tif (Map[i][j]=='3') xx.se--;\n//\t\t\t\tcout<<xx.fi<<\" \"<<xx.se<<\" \"<<ans1.fi<<\" \"<<check1(3,3,2)<<\" qwe\\n\";\n\t\t\t\tif (com(ans1,xx)) ans1=xx;\n\t\t\t}\n\t}\n}\nsigned main()\n{\n\tios::sync_with_stdio(false);\n\tcin>>n;\n\tint fl=0;\n\tfor (int i=1;i<=n;i++)\n\t\tfor (int j=1;j<=n;j++) {\n\t\t\tcin>>Map[i][j];\n\t\t\tif (Map[i][j]!='0') fl=1;\n\t\t}\n\tif (!fl) {cout<<\"0\\n\";return 0;}\n\t\t\n\tS0::init();S3::init();S2::init();\n//\tcout<<check(1,1,1)<<\" qwe\\n\";\n//\tcout<<com({0,2},{2,2})<<\" qwe\\n\";\n\tfor (int i=1;i<=n;i++)\n\t\tfor (int j=1;j<=n;j++) {\n\t\t\tint l=0,r=1e9,ans=-1;\n\t\t\twhile (l<=r) {\n\t\t\t\tint Mid=(l+r)>>1;\n\t\t\t\tif (check(i,j,Mid)) l=(ans=Mid)+1;\n\t\t\t\telse r=Mid-1;\n\t\t\t}\n\t\t\t\n\t\t\tif (ans==-1) continue;\n\t\t\tpii xx={check1(i,j,ans),check2(i,j,ans)};\n\t\t\tif (Map[i][j]=='2') xx.fi--;\n\t\t\tif (Map[i][j]=='3') xx.se--;\n\t\t\tif (com(ans1,xx)) ans1=xx;\n\t\t}\n\t\n\tSub::solve();\n\t\n\tint res=ksm(2,ans1.fi)*ksm(3,ans1.se)%Mod;\n\tcout<<res<<\"\\n\";\n\treturn 0;\n}\n```\n",
        "postTime": 1670291787,
        "uid": 208653,
        "name": "_edge_",
        "ccfLevel": 0,
        "title": "CF677E"
    },
    {
        "content": "CF677E \u3010Vanya and Balloons\u3011\n\n\u9898\u610f\uff1a\n\n\u6709\u4e00\u4e2a\u77e9\u9635\uff0c\u77e9\u9635\u91cc\u53ea\u6709 $0\uff0c1\uff0c2\uff0c3$ ,\u6c42\u4e00\u4e2a\u4e58\u79ef\u6700\u5927\u7684\u5341\u5b57\u5f62\uff08\u53ef\u4ee5\u6a2a\u7740\u6446\uff0c\u53ef\u4ee5\u7ad6\u7740\u6446\u653e\uff09\u3002\n\n---\n\n\u770b\u5230\u90a3\u4e48\u591a\u6570\u7684\u4e58\u79ef\uff0c\u5982\u679c\u76f4\u63a5\u7eaa\u5f55\u56e0\u5b50 $2$ \u548c $3$ \u7684\u4e2a\u6570\uff0c\u5f88\u96be\u6bd4\u8f83\u4e24\u4e2a\u6570\u7684\u5927\u5c0f\uff0c\u56e0\u4e3a $n$ \u6700\u5927\u53ef\u4ee5\u6709 $10^3$ \uff0c\u76f4\u63a5\u7b97\u51fa\u7b54\u6848\u663e\u7136\u4e0d\u662f\u6b63\u786e\u505a\u6cd5\u3002\n\n\u90a3\u4e48\u8003\u8651\u6362\u4e00\u79cd\u65b9\u5f0f\u6bd4\u8f83\u6bcf\u4e2a\u4e58\u79ef\u503c\u7684\u5927\u5c0f\u3002\n\n\u5176\u5b9e\u5f88\u591a\u4eba\u770b\u5230\u8fde\u4e58\u5c31\u4f1a\u60f3\u5230\u53d6\u5bf9\u6570\uff0c\u7531\u5bf9\u6570\u7684\u8fd0\u7b97\u6cd5\u5219\u53ef\u4ee5\u628a\u8bb8\u591a\u6570\u7684\u4e58\u79ef\u201c\u6253\u4e0b\u6765\u201d\uff0c\u53d8\u6210\u8bb8\u591a\u6570\u7684\u6c42\u548c\u3002\u663e\u7136\u5730\uff0c\u5bf9\u6570\u51fd\u6570\u5728\u5176\u5b9a\u4e49\u57df\u4e0a\u5355\u8c03\u9012\u589e\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a\u6570\u7684\u5bf9\u6570\u503c\u6765\u4ee3\u66ff\u5176\u539f\u503c\u4ee5\u65b9\u4fbf\u6bd4\u8f83\u5927\u5c0f\u3002\n\n\u90a3\u4e48\u8fd9\u4e2a\u95ee\u9898\u5c31\u53ef\u4ee5\u7b80\u5316\u4e86\uff0c\u628a\u6bcf\u4e2a\u6570\u53d6\u5bf9\uff0c\u7136\u540e\u4e58\u79ef\u53d8\u6210\u548c\uff0c\u627e\u5230\u6700\u5927\u548c\u7684\u53d6\u6cd5\uff0c\u8ba1\u7b97\u7b54\u6848\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int MAXN = 1E3 + 10;\nconst int MOD = 1E9 + 7;\nchar s[MAXN][MAXN];\ndouble p[4][MAXN][MAXN];\nint n, a[8][MAXN][MAXN];\nint main() {\n    cin >> n;\n    for (int i = 1; i <= n; ++i) scanf(\"%s\", s[i] + 1);\n    double val[4] = { 0., 0., log(2.), log(3.) };\n    for (int i = 1; i <= n; ++i)\n        for (int j = 1; j <= n; ++j) {\n            s[i][j] -= '0';\n            p[0][i][j] = p[0][i][j - 1] + val[s[i][j]];\n            p[1][i][j] = p[1][i - 1][j - 1] + val[s[i][j]];\n            p[2][i][j] = p[2][i - 1][j] + val[s[i][j]];\n            p[3][i][j] = p[3][i - 1][j + 1] + val[s[i][j]];\n        }\n    for (int i = 1; i <= n; ++i)\n        for (int j = 1; j <= n; ++j)\n            if (s[i][j]) {\n                a[0][i][j] = a[0][i][j - 1] + 1;\n                a[1][i][j] = a[1][i - 1][j - 1] + 1;\n                a[2][i][j] = a[2][i - 1][j] + 1;\n                a[3][i][j] = a[3][i - 1][j + 1] + 1;\n            } else\n                a[0][i][j] = a[1][i][j] = a[2][i][j] = a[3][i][j] = 0;\n    for (int i = n; i >= 1; --i)\n        for (int j = n; j >= 1; --j)\n            if (s[i][j]) {\n                a[4][i][j] = a[4][i][j + 1] + 1;\n                a[5][i][j] = a[5][i + 1][j + 1] + 1;\n                a[6][i][j] = a[6][i + 1][j] + 1;\n                a[7][i][j] = a[7][i + 1][j - 1] + 1;\n            } else\n                a[4][i][j] = a[5][i][j] = a[6][i][j] = a[7][i][j] = 0;\n    double ans = -1.0;\n    int x = 0, y = 0, z = 0;\n    for (int i = 1; i <= n; ++i)\n        for (int j = 1; j <= n; ++j) {\n            if (!s[i][j])\n                continue;\n\n            int l = min(min(a[0][i][j], a[2][i][j]), min(a[4][i][j], a[6][i][j]));\n            double res =\n                p[0][i][j + l - 1] - p[0][i][j - l] + p[2][i + l - 1][j] - p[2][i - l][j] - val[s[i][j]];\n            if (ans < res)\n                ans = res, x = i, y = j, z = l;\n            l = min(min(a[1][i][j], a[3][i][j]), min(a[5][i][j], a[7][i][j]));\n            res = p[1][i + l - 1][j + l - 1] - p[1][i - l][j - l] + p[3][i + l - 1][j - l + 1] -\n                  p[3][i - l][j + l] - val[s[i][j]];\n            if (ans < res)\n                ans = res, x = i, y = j, z = -l;\n        }\n    if (ans < 0.)\n        puts(\"0\");\n    else if (z > 0) {\n        unsigned ans = s[x][y];\n        for (int i = -z + 1; i < z; ++i)\n            if (i) {\n                ans = ans * s[x][y + i] % MOD;\n                ans = ans * s[x + i][y] % MOD;\n            }\n        printf(\"%u\\n\", ans);\n    } else {\n        unsigned ans = s[x][y];\n        for (int i = -z - 1; i > z; --i)\n            if (i) {\n                ans = ans * s[x + i][y + i] % MOD;\n                ans = ans * s[x + i][y - i] % MOD;\n            }\n        printf(\"%u\\n\", ans);\n    }\n    return 0;\n}\n```",
        "postTime": 1602498272,
        "uid": 288460,
        "name": "xzggzh1",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF677E \u3010Vanya and Balloons\u3011"
    }
]
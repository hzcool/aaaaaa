[
    {
        "content": "\u5bf9\u6240\u6709\u7ed9\u5b9a\u4e32\u9996\u5c3e\u76f8\u8fde\uff08\u4e2d\u95f4\u7528\u5206\u9694\u7b26\u9694\u5f00\uff09\u5efa\u540e\u7f00\u6570\u7ec4\u3002\u7136\u540e\u8be2\u95ee\u7ed9\u7684\u4e32\u5728\u540e\u7f00\u6570\u7ec4\u4e0a\u4e8c\u5206\u5339\u914d\u3002\n\n\u4e8c\u5206+ST\u8868\u5f97\u51fa\u8fd9\u4e2a\u4e32\u5728\u540e\u7f00\u6570\u7ec4\u4e0a\u7684\u533a\u95f4\uff0c\u5219\u8f6c\u5316\u4e3a\u533a\u95f4\u6570\u989c\u8272\u95ee\u9898\u3002\n\n\u79bb\u7ebf\u83ab\u961f\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O((L+q)\\log L+L\\sqrt q)$\u3002\n\n## Code\uff1a\n```cpp\n#include<cstdio>\n#include<algorithm>\n#include<cstring>\n#include<cmath>\n#define N 188888\n#define log2(x)(31-__builtin_clz(x))\nint siz;\nstruct que{\n\tint l,r,id;\n\tinline bool operator<(const que&rhs)const{\n\t\treturn(l/siz!=rhs.l/siz)?(l<rhs.l):(r<rhs.r);\n\t}\n}q[N];\nchar S[10005][10],t[10];\nint s[N],n,m,fx=127,ys[N],x[N],y[N],c[N],sa[N],height[N],p[N],st[18][N],Q,len;\nint ans1[N],ans2[N];\nvoid sort(){\n\tint m=fx;\n\tfor(int i=0;i<=m;++i)c[i]=0;\n\tfor(int i=1;i<=n;++i)++c[x[i]=s[i]];\n\tfor(int i=1;i<=m;++i)c[i]+=c[i-1];\n\tfor(int i=n;i;--i)sa[c[x[i]]--]=i;\n\tfor(int k=1;k<=n;k<<=1){\n\t\tint p=0;\n\t\tfor(int i=n-k+1;i<=n;++i)y[++p]=i;\n\t\tfor(int i=1;i<=n;++i)if(sa[i]-k>0)y[++p]=sa[i]-k;\n\t\tfor(int i=0;i<=m;++i)c[i]=0;\n\t\tfor(int i=1;i<=n;++i)++c[x[i]];\n\t\tfor(int i=1;i<=m;++i)c[i]+=c[i-1];\n\t\tfor(int i=n;i;--i)sa[c[x[y[i]]]--]=y[i];\n\t\tstd::swap(x,y);\n\t\tx[sa[1]]=p=1;\n\t\tfor(int i=2;i<=n;++i)\n\t\tx[sa[i]]=(y[sa[i]]==y[sa[i-1]]&&y[sa[i]+k]==y[sa[i-1]+k])?p:++p;\n\t\tif(p==n)break;\n\t\tm=p;\n\t}\n\tfor(int i=1,k=0;i<=n;++i)\n\tif(x[i]!=1){\n\t\tk-=!!k;\n\t\tint j=sa[x[i]-1];\n\t\twhile(s[i+k]==s[j+k])++k;\n\t\theight[x[i]]=k;\n\t}\n}\nvoid init(){\n\tfor(int i=1;i<=n;++i)\n\tp[i]=ys[sa[i]];\n\tfor(int i=1;i<=n;++i)st[0][i]=height[i];\n\tfor(int i=0;i<17;++i)\n\tfor(int j=1;(1<<i)+j<=n;++j)\n\tst[i+1][j]=std::min(st[i][j],st[i][j+(1<<i)]);\n}\ninline int ask(int l,int r){\n\tint lg=log2(r-l+1);\n\treturn std::min(st[lg][l],st[lg][r-(1<<lg)+1]);\n}\nbool chk(int w){\n\tfor(int i=0;i<len;++i)\n\tif(s[w+i]!=t[i])return s[w+i]<t[i];\n\treturn 1;\n}\nint findl(int wz,int len){\n\tint l=1,r=wz-1,ans=wz;\n\twhile(l<=r){\n\t\tconst int mid=l+r>>1;\n\t\tif(ask(mid+1,wz)>=len)r=(ans=mid)-1;else l=mid+1;\n\t}\n\treturn ans;\n}\nint findr(int wz,int len){\n\tint l=wz+1,r=n,ans=wz;\n\twhile(l<=r){\n\t\tconst int mid=l+r>>1;\n\t\tif(ask(wz+1,mid)>=len)l=(ans=mid)+1;else r=mid-1;\n\t}\n\treturn ans;\n}\nvoid MD(){\n\tif(m==0)return;\n\tsiz=n/sqrt(m);\n\tstd::sort(q+1,q+Q+1);\n\tstatic int vis[N];\n\tfor(int i=1,l=1,r=0,nw=0;i<=Q;++i){\n\t\twhile(r<q[i].r)\n\t\tif(!vis[p[++r]]++)++nw;\n\t\twhile(l>q[i].l)\n\t\tif(!vis[p[--l]]++)++nw;\n\t\twhile(l<q[i].l)\n\t\tif(!--vis[p[l++]])--nw;\n\t\twhile(r>q[i].r)\n\t\tif(!--vis[p[r--]])--nw;\n\t\tans1[q[i].id]=nw;\n\t}\n}\nint main(){\n\tscanf(\"%d\",&m);\n\tfor(int i=1;i<=m;++i){\n\t\tscanf(\"%s\",S[i]);\n\t\tfor(int j=0;S[i][j];++j)s[++n]=S[i][j],ys[n]=i;\n\t\ts[++n]=fx++;\n\t}\n\tsort();\n\tinit();\n\tscanf(\"%d\",&Q);\n\tfor(int i=1;i<=Q;++i){\n\t\tscanf(\"%s\",t);\n\t\tlen=strlen(t);\n\t\tint l=1,r=n,as=n+1;\n\t\twhile(l<=r){\n\t\t\tconst int mid=l+r>>1;\n\t\t\tif(chk(sa[mid]))l=(as=mid)+1;else r=mid-1;\n\t\t}\n\t\tbool ok=1;\n\t\tfor(int i=0;i<len;++i)\n\t\tif(s[sa[as]+i]!=t[i])ok=0;\n\t\tif(!ok)q[i]=(que){1,0,i};else{\n\t\t\tint L=findl(as,len),R=findr(as,len);\n\t\t\tq[i]=(que){L,R,i};\n\t\t\tans2[i]=p[as];\n\t\t}\n\t}\n\tMD();\n\tfor(int i=1;i<=Q;++i){\n\t\tif(ans1[i])\n\t\tprintf(\"%d %s\\n\",ans1[i],S[ans2[i]]);else\n\t\tputs(\"0 -\");\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1549288414,
        "uid": 6813,
        "name": "mrsrz",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1070H \u3010BerOS File Suggestion\u3011"
    },
    {
        "content": "\u8fd9\u9898\u53ef\u4ee5\u7528 $\\verb!map!$ \u6c34\u8fc7\u3002\n## \u601d\u8def\n\u6211\u4eec\u6ce8\u610f\u5230 $\\verb!len!$ \u5c45\u7136\u53ea\u6709 $\\verb!8!$\uff0c\u8fd9\u5c31\u610f\u5473\u7740\u4e00\u4e2a\u5b57\u7b26\u4e32\u6240\u6709\u7684\u5b57\u4e32\u6570\u91cf\u53ea\u6709\u51e0\u5341\u4e2a\uff0c\u518d\u51cf\u53bb\u91cd\u590d\u7684\u5b57\u4e32\uff0c\u6bcf\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u5b57\u4e32\u6570\u53ef\u80fd\u5e73\u5747\u53ea\u6709 $\\verb!20!$ \u5de6\u53f3\u3002\u4e00\u5171\u6709\u4e00\u4e07\u4e2a\u5b57\u7b26\u4e32\uff0c\u6211\u4eec\u663e\u7136\u53ef\u4ee5\u5f00\u4e00\u4e2a $\\verb!map!$ \u628a\u6240\u6709\u5b57\u4e32\u8bb0\u5f55\u4e0b\u6765\uff0c\u7136\u540e\u76f4\u63a5\u67e5\u8be2\u5373\u53ef\u3002\n## \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define rint register int\nmap< string,vector<string> >mp;//\u8868\u793a\u6bcf\u79cd\u5b50\u4e32\u5206\u522b\u5305\u542b\u4e8e\u54ea\u51e0\u4e2a\u4e32\nsigned main(){\n\tios::sync_with_stdio(false);\n\tcin.tie(0),cout.tie(0);\n\tint n;cin>>n;\n\tfor (rint i=1;i<=n;++i){\n\t\tstring s;cin>>s;\n\t    int len=s.length();\n\t    map<string,int>mpp;//\u8bb0\u5f55\u5f53\u524d\u662f\u5426\u8bb0\u5f55\u4e86\u91cd\u590d\u7684\u5b50\u4e32\n\t    for (rint j=0;j<len;++j)\n\t        for (rint k=j;k<len;++k){\n\t        \tstring s1=s.substr(j,k-j+1);\n\t\t\t\tif (mpp[s1]==0) mpp[s1]=1,mp[s1].push_back(s);\n\t\t\t}\n\t}\n\tint q;cin>>q;\n\twhile (q--){\n\t\tstring t;cin>>t;\n\t\tif (mp[t].size()==0) cout<<\"0 -\\n\";\n\t\telse cout<<(int)(mp[t].size())<<' '<<mp[t][0]<<'\\n';\n\t}\n    return 0;\n}\n```\n",
        "postTime": 1658984475,
        "uid": 253608,
        "name": "Tx_Lcy",
        "ccfLevel": 7,
        "title": "CF1070H BerOS File Suggestion"
    },
    {
        "content": "\u5bf9\u4e8e\u4e00\u5f00\u59cb\u7ed9\u5b9a\u7684 $n$ \u4e2a\u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u628a\u5b83\u4eec\u7684\u6240\u6709\u540e\u7f00\u53bb\u91cd\u540e\u90fd\u63d2\u5165\u5230 $trie$ \u4e2d\n\n\u8fd9\u6837\u5728\u5339\u914d\u7684\u65f6\u5019\u6700\u540e\u8bbf\u95ee\u7684\u70b9\u5c31\u662f\u6240\u6709\u5339\u914d\u7684\u5b57\u7b26\u4e32\u4e86\n\n``` cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N = 10010 * 215 + 10;\nchar str[30];\nint n, m;\nint cnt[N], tot = 1;\nmap<int, int> ch[N];\nvector<int> nds;\nstring val[N];\n\nvoid ins(int fro) {\n    int x = 1;\n    for(int j = fro ; str[j] ; ++ j) {\n        int c = str[j] - 'a';\n        if(!ch[x][c]) ch[x][c] = ++ tot;\n        x = ch[x][c];\n        nds.push_back(x);\n    }\n}\n\nint main() {\n    scanf(\"%d\", &n);\n    for(int i = 1 ; i <= n ; ++ i) {\n        scanf(\"%s\", str + 1);\n        nds.clear();\n        for(int j = 1 ; str[j] ; ++ j) {\n            ins(j);\n        }\n        sort(nds.begin(), nds.end());\n        nds.erase(unique(nds.begin(), nds.end()), nds.end());\n        for(int j = 0 ; j < nds.size() ; ++ j) {\n            ++ cnt[nds[j]];\n            val[nds[j]] = string(str + 1);\n        }\n    }\n    scanf(\"%d\", &m);\n    for(int i = 1 ; i <= m ; ++ i) {\n        scanf(\"%s\", str + 1);\n        int x = 1;\n        for(int j = 1 ; str[j] ; ++ j) {\n            int c = str[j] - 'a';\n            x = ch[x][c];\n        }\n        if(cnt[x])\n            printf(\"%d %s\\n\", cnt[x], val[x].c_str());\n        else puts(\"0 -\");\n    }\n}\n```",
        "postTime": 1540438497,
        "uid": 47111,
        "name": "nekko",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1070H \u3010BerOS File Suggestion\u3011"
    },
    {
        "content": "\u5bf9\u4e8e\u8fd9\u9898\uff0c\u770b\u5230\u5b57\u7b26\u4e32\u5339\u914d\uff0c\u7b2c\u4e00\u53cd\u5e94\u60f3\u5230\u5b57\u7b26\u4e32hash\uff0c\u540c\u65f6\u770b\u5230$len \\leq 8 $ \uff0c\u8003\u8651\u5bf9\u4e8e\u5148\u7ed9\u51fa\u7684$n$\u4e2a\u5b57\u7b26\u4e32\uff0c$O(len^2)$\u679a\u4e3e\u5b83\u7684\u5b50\u4e32\uff0c\u5c06\u5176\u52a0\u5165$map$\u4e2d\uff0c\u4f46\u662f\u8981\u6ce8\u610f\u5982\u679c\u4e00\u4e2a\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e2a\u5b57\u7b26\u4e32\uff0c\u6211\u4eec\u90fd\u7edf\u8ba1\u4e00\u4e0b\u5b83\u6700\u540e\u4e00\u6b21\u51fa\u73b0\u5728\u54ea\u91cc\uff08\u4e8e\u662f\u5c31\u53ef\u4ee5\u987a\u4fbf\u5224\u4e00\u4e0b\u91cd\uff09\n\n\n\u7136\u540e\u6211\u4eec\u5728\u8be2\u95ee\u7684\u65f6\u5019\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u8f93\u51fa\u8fd9\u4e2a\u5b57\u7b26\u4e32\u5bf9\u5e94\u7684\u51fa\u73b0\u6b21\u6570\u4ee5\u53ca\u6700\u540e\u4e00\u5904\u51fa\u73b0\u7684\u4f4d\u7f6e\u5566QwQ\n\n```cpp\n// Sooke bless me.\n// LJC00118 bless me.\n#include<bits/stdc++.h>\n\n#define INF 2147483647\n#define ll long long\n\nint Inp(){\n\tchar c = getchar();\n\tint Neg = 1;\n\twhile(c < '0' || c > '9'){\n\t\tif(c == '-')\n\t\t\tNeg = -1;\n\t\tc = getchar();\n\t}\n\tint Sum = 0;\n\twhile(c >= '0' && c <= '9'){\n\t\tSum = ((Sum << 3) + (Sum << 1)) + c - '0';\n\t\tc = getchar();\n\t}\n\treturn Neg * Sum;\n}\n\nstd::map <std::string, int> Cnt; // \u51fa\u73b0\u6b21\u6570\nstd::map <std::string, int> Ans; // \u6700\u540e\u4e00\u6b21\u51fa\u73b0\u4f4d\u7f6e\nstd::string s[10010];\n\nint main(){\n\tint n = Inp();\n\tfor(int i = 1; i <= n; i++){\n\t\tstd::cin >> s[i];\n\t\tint Len = s[i].size();\n\t\tfor(int j = 1; j <= Len; j++)\n\t\t\tfor(int u = 0; u <= Len - j; u++){\n\t\t\t\tif(Ans[s[i].substr(u, j)] != i){\n\t\t\t\t\tCnt[s[i].substr(u, j)]++;\n\t\t\t\t\tAns[s[i].substr(u, j)] = i;\n\t\t\t\t}\n\t\t\t}\n\t}\n\tint m = Inp();\n\tfor(int i = 1; i <= m; i++){\n\t\tstd::string str;\n\t\tstd::cin >> str;\n\t\tprintf(\"%d \", Cnt[str]);\n\t\tif(Cnt[str] == 0)\n\t\t\tprintf(\"-\\n\"); \n\t\telse\n\t\t\tstd::cout << s[Ans[str]] << std::endl;\n\t}\n}\n```",
        "postTime": 1542605536,
        "uid": 36362,
        "name": "Dilute",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1070H \u3010BerOS File Suggestion\u3011"
    }
]
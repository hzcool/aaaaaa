[
    {
        "content": "\u6211\u4eec\u77e5\u9053 $a+b \\ge a\\oplus b$\u3002\u6240\u4ee5\u5728\u533a\u95f4\u6269\u5f20\u7684\u65f6\u5019\uff0c\u5b83\u7684\u7b54\u6848\u4e00\u5b9a\u4e0d\u4f1a\u53d8\u52a3\u3002\n\n\u5f62\u5f0f\u5316\u7684\u6765\u8bb2\uff0c\u5c31\u662f $\\forall l \\leq l' \\leq r' \\leq r$\uff0c$f(l,r) \\ge f(l',r')$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u7684\u95ee\u9898\u8f6c\u5316\u6210\u4e86\u627e\u5230\u6700\u5c0f\u7684 $l',r'$ \u4f7f\u5f97 $f(l',r')=f(l,r)$\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u7b49\u4ef7\u4e8e\u5728\u533a\u95f4\u4e24\u4fa7\u5220\u6570\u3002\n\n\u663e\u7136\u7684\uff0c\u5bf9\u4e8e\u90a3\u4e9b\u88ab\u6211\u4eec\u5220\u6389\u7684\u6570 $x$\uff0c\u4e00\u5b9a\u6ee1\u8db3 $\\sum x = \\oplus x$\u3002\n\n\u82e5\u8981\u6ee1\u8db3\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u5219 $x$ \u7684\u6240\u6709\u4e8c\u8fdb\u5236\u4f4d\u4e0a\u7684 $1$ \u90fd\u4e0d\u540c\u3002\n\n\u6ce8\u610f\u5230 $x < 2^{30}$\uff0c\u6240\u4ee5\u6211\u4eec\u6700\u591a\u4ece\u4e24\u4fa7\u5220\u9664 $30$ \u4e2a\u6570\uff0c\u679a\u4e3e\u4e00\u4e0b\u5373\u53ef\u3002\n\n\u4f46\u662f\u76f4\u63a5\u8fd9\u4e48\u505a\u662f\u9519\u7684\u3002\u56e0\u4e3a\u6709\u53ef\u80fd\u6709 $0$ \u5b58\u5728\uff0c\u8fd9\u6837\u5220\u9664\u7684\u533a\u95f4\u957f\u5ea6\u5c31\u53ef\u80fd $>30$\uff0c\u6240\u4ee5\u9700\u8981\u5c06 $0$ \u5220\u53bb\u518d\u505a\u3002\n\n \n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define int long long\n#define vi vector<int>\n#define pii pair<int,int>\n#define pb(x) push_back(x)\n#define lowbit(x) x&-x\nusing namespace std;\nconst int N=1e5+10;\nll ans;\nint n,m,T,a[N],l,r,b[N],c[N],d[N],bel[N],rbel[N];\ninline int read(){\n\tint s=0,f=0;\n\tchar ch=getchar();\n\twhile(ch>'9'||ch<'0') f|=(ch=='-'),ch=getchar();\n\twhile(ch<='9'&&ch>='0') s=(s<<3)+(s<<1)+(ch^48),ch=getchar();\n\treturn f?-s:s;\n}\ninline int calc(int l,int r){return b[r]-b[l-1]-(c[r]^c[l-1]);}\nsigned main(){\n\tT=read();\n\twhile(T--){\n\t\tn=read(),m=read();\n\t\tint nn=0;\n\t\tfor(register int i=1;i<=n;++i){\n\t\t\ta[i]=read();\n\t\t\tif(a[i]>0) d[++nn]=i;\n\t\t}\n\t\tn=nn;\n\t\tfor(register int i=1;i<=n;++i) b[i]=b[i-1]+a[d[i]];\n\t\tfor(register int i=1;i<=n;++i) c[i]=c[i-1]^a[d[i]];\n\t\twhile(m--){\n\t\t\tint l=read(),r=read();\n\t\t\tint p=l; \n\t\t\tl=lower_bound(d+1,d+n+1,l)-d;\n\t\t\tr=upper_bound(d+1,d+n+1,r)-d-1;\n\t\t\tif(l>r||!n){\n\t\t\t\tprintf(\"%lld %lld\\n\",p,p);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tint res=0,L=l,R=r;\n\t\t\tfor(register int i=l;i<=l+30;++i){\n\t\t\t\tfor(register int j=r-30;j<=r;++j){\n\t\t\t\t\tif(i<=j&&calc(l,r)==calc(i,j)&&d[j]-d[i]<d[R]-d[L]){\n\t\t\t\t\t\tL=i,R=j;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tprintf(\"%lld %lld\\n\",d[L],d[R]);\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1666664910,
        "uid": 428089,
        "name": "HMZHMZHMZ",
        "ccfLevel": 7,
        "title": "CF1732C"
    },
    {
        "content": "\n## C1(easy version)\n\n#### \u9898\u610f\n\n\u5b9a\u4e49 $sum(l,r) = \\sum\\limits_{i=l}^r a_i$\uff0c$xor(l,r) = \\bigoplus_{i=l}^r a_i$\uff0c$f(l,r) = sum(l,r) - xor(l,r)$\u3002\n\nq \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u7ed9\u51fa\u4e00\u7ec4 $L,R$\uff0c\u6c42\u51fa\u4e00\u7ec4 $ L \\leq l \\leq r\\leq R $\uff0c\u4f7f\u5f97 $f(l,r)$ \u6700\u5927\u4e14 $r-l+1$ \u6700\u5c0f\u3002\n\n\u4fdd\u8bc1 $q=1,L_1=1,R_1=n$\u3002 \n\n$t$ \u7ec4\u6570\u636e\u3002\n\n#### \u601d\u8def\n\n\u66b4\u529b\u5f88\u597d\u60f3\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u6b21\u8be2\u95ee\uff0c\u66b4\u529b\u679a\u4e3e $l$ \u548c $r$ \u5373\u53ef\u3002\n\n\u8003\u8651\u6b63\u89e3\u3002\n\n\u8003\u8651 $f$ \u7684\u503c\u662f\u600e\u4e48\u53d8\u5316\u7684\u3002\n\n\u663e\u7136 $\\forall x,y$\uff0c\u6709 $x+y \\geq x \\oplus y$ \uff0c\u90a3\u4e48\u6709 $xor(l-1,r) - xor(l,r) \\leq a_{l-1} ,sum(l-1,r) - sum(l,r) = a_{l-1} $\uff0c\u6240\u4ee5 $ f(l-1,r) = sum(l-1,r) - xor(l-1,r) \\geq sum(l,r) + a_{l-1} - xor(l,r) -a_{l-1} $\uff0c\u6240\u4ee5 $ f(l-1,r) \\geq f(l,r) $\uff0c\u90a3\u4e48\u5f53 $ r $ \u786e\u5b9a\u65f6\uff0c$ f $ \u7684\u503c\u5b58\u5728\u5355\u8c03\u6027\uff0c\u5176\u56fe\u50cf\u753b\u51fa\u6765\u5c31\u957f\u6210\u4e0b\u9762\u8fd9\u6837\uff1a\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ege1cee4.png)\n\n\u90a3\u4e48\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $r$ \u7684\u7b54\u6848\u5c31\u662f\u56fe\u4e2d $A$ \u70b9\u3002\u56e0\u4e3a\u6ee1\u8db3\u5355\u8c03\u6027\uff0c\u53ef\u4ee5\u4e8c\u5206\u6c42\u5f97\u3002\u90a3\u5c31\u53ea\u9700\u679a\u4e3e $r$ \u5728\u6bd4\u8f83\u5c31\u884c\u4e86\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n \\log n)$\u3002\n\n\u4ee3\u7801\u653e\u6700\u540e\u4e86\u3002\n\n## C2(hard version)\n\n#### \u9898\u610f \n\n\u5c06 C1 \u7684\u4fdd\u8bc1 $q=1$ \u6539\u4e3a\u4e86\u4fdd\u8bc1 $q=n$\u3002\n\n#### \u601d\u8def\n\n\u90a3\u4e48\u539f\u672c\u7684\u4e8c\u5206\u5c31\u4e0d\u884c\u4e86\uff0c\u7531\u4e8e\u5355\u8c03\u6027\u4f9d\u65e7\u5b58\u5728\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u6362\u4e00\u79cd\u601d\u8def\uff0c\u8003\u8651\u4ec0\u4e48\u65f6\u5019 $f$ \u7684\u503c\u4f1a\u53d8\u5c0f\u3002\n\n\u82e5\u5f53\u524d\u5f02\u6216\u548c\u4e2d $x$ \u7684\u6240\u67091\u4f4d\u90fd\u4e3a\u96f6\uff0c\u5219 $x$ \u7684\u503c\u4e00\u5b9a\u4f1a\u589e\u5927\u5f02\u6216\u548c\uff0c\u90a3\u4e48 $f$ \u7684\u503c\u5c31\u53d8\u5c0f\u4e86\u3002\n\n\u5229\u7528\u8fd9\u4e2a\u6027\u8d28\u53ef\u4ee5\u5c06\u539f\u672c\u7684\u66b4\u529b\u4f18\u5316\u5f88\u591a\uff0c\u8003\u8651\u4e00\u4e0b\u4f18\u5316\u540e\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u3002\n\n\u81f3\u591a\u679a\u4e3e $\\log V$ \u4e2a\u6570 $f$ \u7684\u503c\u5c31\u4f1a\u51cf\u5c0f\uff08$V$ \u662f\u503c\u57df\uff09\uff0c\u56e0\u4e3a\u628a $V$ \u7684\u4e8c\u8fdb\u5236\u4e3a\u5168\u6bcf\u679a\u4e00\u904d\u4e00\u5b9a\u4f1a\u9047\u5230\u4e00\u4e2a\u6570\u4f7f\u5f97 $f$ \u51cf\u5c0f\u3002\n\n\u90a3\u4e48 $l$ \u81f3\u591a $\\log V$ \u4e2a\uff0c$r$ \u81f3\u591a $\\log V$ \u4e2a\uff0c\u52a0\u4e0a $q$ \u6b21\u8be2\u95ee\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f $O(n \\log^2 V)$\uff0c\u53ef\u4ee5\u8fc7\u6389\u8fd9\u9898\u3002\n\n\u4f46\u5176\u5b9e\u8fd8\u6709\u4e00\u4e2a\u5751\uff0c\u5c31\u662f\u5f53 $a$ \u6570\u7ec4\u4e2d\u6709 $0$ \u65f6\uff0c\u4f1a\u53d8\u6210\u6050\u6016\u7684 $O(n^3)$\uff0c\u4f46 $0$ \u663e\u7136\u4e0d\u4f1a\u5f71\u54cd\u7b54\u6848\uff0c\u53ef\u4ee5\u76f4\u63a5\u4e0d\u7406\u5b83\uff0c\u90a3\u518d\u641e\u4e2a\u94fe\u8868\u5c31\u884c\u4e86\u3002\n\n## \u4ee3\u7801\n\ntalking is cheap,show me your code.\n\n### C1\n\n```cpp\n#include <bits/stdc++.h>\n#define il inline\n#define int long long\nusing namespace std;\nconst int N=1e5+5,inf=1e15+7;\nint n,a[N],sum[N],xr[N],ans,ansl,ansr,l,r;\nil int calc(int l,int r) {return sum[r]-sum[l-1]-(xr[r]^xr[l-1]);}\nil void work(){\n\tscanf(\"%lld%*lld\",&n);\n\tfor(int i=1;i<=n;++i) scanf(\"%lld\",a+i),sum[i]=sum[i-1]+a[i],xr[i]=(xr[i-1]^a[i]);\n\tscanf(\"%*lld%*lld\"),ans=calc(1,n),ansl=l=1,ansr=r=n;\n    int mn=inf;\n    for (int i=l;i<=r;++i){\n        int ll=i,rr=r,pos=r;\n        while(ll<=rr){\n            int mid=(ll+rr)>>1;\n            if(calc(i,mid)<ans) ll=mid+1;\n            else rr=mid-1,pos=mid;\n        }\n        if(calc(i,pos)<ans) ++pos;\n        if(pos==r+1) continue;\n        if(mn>pos-i+1) mn=pos-i+1,ansl=i,ansr=pos;\n    }\n    printf(\"%lld %lld\\n\",ansl,ansr);\n}\nsigned main(){\n\tint T;\n\tscanf(\"%lld\",&T);\n\twhile(T--) work();\n\treturn 0;\n}\n```\n\n### C2\n\n```cpp\n#include <bits/stdc++.h>\n#define il inline\nusing namespace std;\nconst int N=1e5+5;\nil int read(){\n\tint x(0);\n\tchar ch(getchar());\n\twhile(!isdigit(ch)) ch=getchar();\n\twhile(isdigit(ch)) x=(x<<3)+(x<<1)+(ch&15),ch=getchar();\n\treturn x;\n}\nint a[N],sum[N],xr[N],nxt[N],lst[N],ans,ansl,ansr;\nil void work(){\n\tint L,R,ln0=0;\n\tint n=read(),Q=read();\n\tfor(int i=1;i<=n;++i){\n\t\ta[i]=read(),sum[i]=sum[i-1]+a[i],xr[i]=(xr[i-1]^a[i]);\n\t\tif(a[i]) lst[i]=ln0,nxt[ln0]=i,ln0=i;\n\t\telse lst[i]=ln0;\n\t}\n\tnxt[n]=ln0=n+1;\n\tfor(int i=n;i;--i){\n\t\tif(a[i]) ln0=i;\n\t\telse nxt[i]=ln0;\n\t}\n\twhile(Q--){\n\t\tint L=read(),R=read(),ans=(xr[R]^xr[L-1]),ansl=L,ansr=R;\n\t\tif(L==R){\n\t\t\tprintf(\"%d %d\\n\",L,L);\n\t\t\tcontinue;\n\t\t}\n\t\tif(nxt[L]>R&&!a[L]){\n\t\t\tprintf(\"%d %d\\n\",L,L);\n\t\t\tcontinue;\n\t\t}\n\t\tif(!a[L]) L=nxt[L]; if(!a[R]) R=lst[R];\n\t\tfor(int l=L;l<=R;l=nxt[l]){\n\t\t\tint r=R,now=ans;\n\t\t\twhile(l<=lst[r]&&(now|a[r])==now) now^=a[r],r=lst[r];\n\t\t\tif(r-l<ansr-ansl) ansl=l,ansr=r;\n\t\t\tif((ans|a[l])>ans) break;\n\t\t\tans^=a[l];\n\t\t}\n\t\tprintf(\"%d %d\\n\",ansl,ansr);\n\t}\n}\nint main(){\n\tint T;\n\tscanf(\"%d\",&T);\n\twhile(T--) work();\n\treturn 0;\n}\n```\n\n\u4e0d\u4f1a\u6709\u4eba\u4e0d\u77e5\u9053 C2 \u7684\u4ee3\u7801\u53ef\u4ee5\u628a C1 \u8fc7\u4e86\u5427\u3002\n\n\u5199\u5b8c\u529bqwq\u3002\n\n",
        "postTime": 1666609827,
        "uid": 429403,
        "name": "c202201",
        "ccfLevel": 5,
        "title": "CF1732C"
    },
    {
        "content": "#### \u601d\u8def\u5206\u6790\n\n\u5c06\u5f02\u6216\u7406\u89e3\u4e3a\u4e0d\u8fdb\u4f4d\u52a0\u6cd5\u3002\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u663e\u7136\u7684\u7ed3\u8bba\uff1a$a+b\\ge a\\operatorname{xor} b$\u3002\n\n\u56e0\u6b64\uff0c\u533a\u95f4\u8d8a\u5927\u8d8a\u597d\uff0c\u5373 $f(l,r)$ \u6700\u5927\u3002\u6b64\u9898\u5373\u4e3a\u6c42 $f(p,q)$ \u4f7f\u5f97 $f(p,q)=f(l,r)$ \u7684\u540c\u65f6 $q-p$ \u6700\u5c0f\u3002\n\n\u8003\u8651\u5230 $a+b=a\\operatorname{xor} b$ \u7684\u5fc5\u8981\u6761\u4ef6\u662f $a$ \u4e0e $b$ \u4e8c\u8fdb\u5236\u4e0a\u7684\u4f4d\u4e0d\u76f8\u540c\u3002\u4e8e\u662f\u6709\u8d77\u59cb\u65f6 $p=l,q=r$\uff0c\u4e24\u8fb9\u6700\u591a\u7f29\u5c0f $30$ \u6b21\uff0c\u6700\u591a\u679a\u4e3e $900$ \u6b21\u3002\u8db3\u591f\u901a\u8fc7\u6b64\u9898\u3002\n\n\u5751\u70b9\uff1a\u8981\u5c06\u5e8f\u5217\u4e2d\u7684 $0$ \u53bb\u6389\u3002\n\n#### \u9898\u89e3\u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\n\nusing namespace std;\n\nstruct ios {\n    inline char read() {\n        static const int inlen = 1 << 18 | 1;\n        static char buf[inlen], *s, *t;\n        return (s == t) && (t = (s = buf) + fread(buf, 1, inlen, stdin)), s == t ? -1 : *s++;\n    }\n    template<typename T> inline ios& operator>> (T &x) {\n        static char c11, boo;\n        for (c11 = read(), boo = 0; !isdigit(c11); c11 = read()) {\n            if (c11 == -1) return *this;\n            boo |= c11 == '-';\n        }\n        for (x = 0; isdigit(c11); c11 = read()) x = x * 10 + (c11 ^ '0');\n        boo && (x = -x);\n        return *this;\n    }\n} fin;\n\nstruct exios {\n    template<typename _CharT, typename _Traits = char_traits<_CharT>>\n    struct typ {\n        typedef basic_ostream<_CharT, _Traits>& (* end) (basic_ostream<_CharT, _Traits>&);\n    };\n\n    template<typename T> friend exios &operator<<(exios &out, T num) {\n        if (num < 0) putchar('-'), num = -num;\n        if (num >= 10) out << num / 10;\n        putchar(num % 10 + '0');\n        return out;\n    }\n\n    friend exios &operator<<(exios &out, const char * s) { printf(\"%s\", s); return out; }\n    friend exios &operator<<(exios &out, string s) { cout << s; return out; }\n    friend exios &operator<<(exios &out, typ<char>::end e) { puts(\"\"); return out; }\n} fout;\n\nconst int maxn = 1e5 + 10;\ntypedef pair<int, int> pii;\n\nint t, n, q;\nint a[maxn];\nint b[maxn];\nint c[maxn];\n\nint f(int l, int r) {\n    return (a[r] - a[l - 1]) - (b[r] ^ b[l - 1]);\n}\n\nsigned main() {\n    fin >> t;\n    while (t--) {\n        fin >> n >> q;\n        int cnt = 0;\n        for (int i = 1, x; i <= n; i++) {\n            fin >> x;\n            a[i] = b[i] = x;\n            if (x != 0) {\n                c[++cnt] = i;\n            }\n        }\n        for (int i = 1; i <= n; i++) {\n            a[i] += a[i - 1];\n            b[i] ^= b[i - 1];\n        }\n        while (q--) {\n            int l, r;\n            fin >> l >> r;\n            int m = f(l, r);\n            int ansl = l, ansr = r;\n            int posl = lower_bound(c + 1, c + 1 + cnt, l) - c;\n            int posr = upper_bound(c + 1, c + 1 + cnt, r) - c - 1;\n            if (posl > posr || !cnt) {\n                fout << l << \" \" << l << endl;\n                continue;\n            }\n            // cout << posl << \" \" << posr << \" \";\n            for (int i = posl; i <= min(cnt, posl + 30); i++) {\n                for (int j = posr; j >= max(1ll, posr - 30); j--) {\n                    if (i > j) continue;\n                    if (f(c[i], c[j]) == m && c[j] - c[i] < ansr - ansl) {\n                        ansl = c[i];\n                        ansr = c[j];\n                    }\n                }\n            }\n            fout << ansl << \" \" << ansr << endl;\n        }\n    }\n    return 0;\n}\n```",
        "postTime": 1682725153,
        "uid": 167507,
        "name": "LHQing",
        "ccfLevel": 9,
        "title": "CF1732C2 Sheikh (Hard Version) \u9898\u89e3"
    },
    {
        "content": "## \u9898\u610f\n\u7ed9\u4f60\u4e00\u4e2a $N (1 \\le N \\le 10^5)$ \u7684\u975e\u8d1f\u6570\u7ec4 $a$\u3002\u5b9a\u4e49 $sum_{i,j}= a_i + a_{i+1}+\\cdots +a_j,xor_{i,j}=a_i \\oplus a_{i+1} \\oplus \\cdots \\oplus a_j$\u3002 \u5b9a\u4e49 $f(i,j)= sum_{i,j}-xor_{i,j}$\u3002\u8fdb\u884c $N$ \u6b21\u8be2\u95ee\uff0c\u7ed9\u5b9a $l,r$\uff0c\u6c42\u533a\u95f4 $[l,r]$ \u7684\u6240\u6709\u5b50\u533a\u95f4 $[l_1,r_1]$ \u4e2d\uff0c$f(l_1,r_1)$ \u6700\u5927\u7684\u524d\u63d0\u4e0b\u957f\u5ea6\u6700\u77ed\u7684\u90a3\u4e00\u4e2a\u3002\n\n## \u5206\u6790\n\n\u53d1\u73b0\u5bf9\u4e8e\u533a\u95f4 $[l,r]$\uff0c$f(l,r+1) \\ge f(l,r)$\u3002\n\n**\u8bc1\u660e**\n\n$f(l,r+1)-f(l,r)$\n\n$=sum_{l,r+1}-xor{l,r+1}-sum_{l,r}+xor_{l,r}$\n\n$=a_{r+1}- xor_{l,r+1}+ xor_{l,r}$\u3002\n\n\u56e0\u4e3a $ xor_{l,r+1}- xor_{l,r} \\le a_{r+1}$ (\u56e0\u4e3a\u5f02\u6216\u662f\u4e0d\u8fdb\u4f4d\u52a0\u6cd5)\n\n\u6240\u4ee5\u5f97\u5230 $f(l,r+1)-f(l,r) \\ge 0$\u3002\u540c\u7406\u53ef\u8bc1 $f(l-1,r) \\ge  f(l,r)$\u3002\n\n\u8fd9\u8bf4\u660e\uff1a**\u7b54\u6848\u533a\u95f4\u7684 $f$ \u503c\u4e00\u5b9a\u4e0e\u8be2\u95ee\u533a\u95f4\u7684 $f$ \u503c\u76f8\u7b49\uff1b\u5f53\u533a\u95f4\u7684\u4e00\u7aef\u70b9\u56fa\u5b9a\uff0c\u5f53\u5b83\u7684\u53e6\u4e00\u7aef\u70b9\u5411\u8fdc\u79fb\u52a8\u65f6\uff0c$f$ \u503c\u662f\u5355\u8c03\u4e0d\u51cf\u7684**\u3002\n\n\u8fd9\u542f\u793a\u6211\u4eec**\u5728\u8be2\u95ee\u533a\u95f4\u7684\u57fa\u7840\u4e0a\u8fdb\u884c\u5220\u51cf**\u3002\n\n\u5982\u4f55\u5224\u65ad\u4e00\u4e2a\u5143\u7d20\u88ab\u5220\u6389\u4e4b\u540e\uff0c\u539f\u6765\u533a\u95f4\u7684 $f$ \u4e0d\u4f1a\u53d8\u5c0f\uff1f\n\n\u9996\u5148\uff0c\u5982\u679c\u5b83\u662f $0$\uff0c\u968f\u4fbf\u5220\uff1b\n\n\u5176\u6b21\uff0c\u5982\u679c\u8fd9\u4e2a\u6570\u5728\u52a0\u548c\u65b9\u9762\u7684\u8d21\u732e\u548c\u5728\u5f02\u6216\u548c\u65b9\u9762\u7684\u8d21\u732e\u76f8\u540c\uff0c\u53ef\u4ee5\u5220\u3002\n\n\u5177\u4f53\u5730\uff0c\u5982\u679c**\u52a0\u4e0a\u8fd9\u4e2a\u6570\u4e0d\u4f1a\u9020\u6210\u52a0\u6cd5\u8fdb\u4f4d\uff0c\u4e5f\u5c31\u662f\u8fd9\u4e2a\u6570\u4e0a\u7684\u6bcf\u4e00\u4e2a $1$ \u5bf9\u5e94\u7684\u4f4d\u7f6e\u539f\u6765\u90fd\u662f $0$**\uff0c\u90a3\u4e48\u8fd9\u65f6\u5f02\u6216\u5b83\u548c\u52a0\u5b83\u7684\u7ed3\u679c\u76f8\u540c\uff0c\u53ef\u4ee5\u5220\u9664\u3002\u90a3\u4e48\u6709\u591a\u5c11\u4e2a\u8fd9\u6837\u7684\u6570\uff1f\u56e0\u4e3a\u52a0\u4e0a\u8fd9\u4e2a\u6570\u4e4b\u540e\u81f3\u5c11\u6709\u4e00\u4e2a\u539f\u6765\u7684 $0$ \u4f4d\u53d8\u6210\u4e86 $1$\uff0c\u6240\u4ee5\u8bf4\u4e8c\u8fdb\u5236\u4e0b $f(l,r)$ \u6709\u591a\u5c11\u4e2a $1$\uff0c\u8fd9\u6837\u7684\u6570\u5c31\u6700\u591a\u6709\u591a\u5c11\u4e2a\u3002\u53ef\u4ee5\u53d1\u73b0\u6570\u91cf\u662f $\\log$ \u7ea7\u522b\u3002\n\n\u6545\u6211\u4eec\u5148**\u5220\u9664\u6240\u6709\u662f $0$ \u7684\u6570**\uff0c\u4e4b\u540e\u679a\u4e3e\u5220\u6389\u4e00\u4e9b\u6570\u4e4b\u540e\u7684\u5de6\u53f3\u7aef\u70b9\u5373\u53ef\u3002\u5355\u6b21\u8be2\u95ee\u590d\u6742\u5ea6 $O(\\log^2 N)$\u3002\n\n### AC CODE\n\n```cpp\n// LUOGU_RID: 97435153\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int MAXN=1e5+5;\nint Read()\n{\n\tint f=1,x=0;\n\tchar ch=getchar();\n\twhile(!isdigit(ch))\n\t{\n\t\tif(ch=='-') f=-1;\n\t\tch=getchar();\n \t}\n \twhile(isdigit(ch))\n \t{\n \t\tx=(x<<1)+(x<<3)+(ch^48);\n \t\tch=getchar();\n\t}\n\treturn f*x;\n}\nint T,N,Q;\nlong long psum[MAXN],pxor[MAXN];\nint a[MAXN];\nint b[MAXN];\nlong long Func(int l,int r)\n{\n\treturn psum[r]-psum[l-1]-(pxor[r]^pxor[l-1]);\n}\nsigned main()\n{\n\tT=Read();\n\twhile(T--)\n\t{\n\t\tN=Read(),Q=Read();\n\t\tint M=0;\n\t\tfor(int i=1;i<=N;i++) \n\t\t{\n\t\t\ta[i]=Read();\n\t\t\tif(a[i]) b[++M]=i;//b \u4e3a\u53bb\u96640 \u540e\u7684\u6570\u7ec4\n\t\t}\n\t\tfor(int i=1;i<=M;i++)\n\t\t{\n\t\t\tpsum[i]=psum[i-1]+a[b[i]];\n\t\t\tpxor[i]=pxor[i-1]^a[b[i]];\n\t\t}\n\t\twhile(Q--)\n\t\t{\n\t\t\tint l=Read(),r=Read();\n\t\t\tint x=l;\n\t\t\tl=lower_bound(b+1,b+M+1,l)-b;\n\t\t\tr=upper_bound(b+1,b+M+1,r)-b-1;\n\t\t\tlong long goal=Func(l,r);\n\t\t\tint ansl=l,ansr=r;\n          //\u8fd9\u91cc\u5176\u5b9e\u662f\u53bb\u96640\u5de5\u4f5c\n\t//\t\tprintf(\"RANGE%lld %lld\\n\",l,r);\n\t\t\tif(l>r||M==0)\n\t\t\t{\n\t\t\t\tprintf(\"%lld %lld\\n\",x,x);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tfor(int i=l;i<=min(l+30,r);i++)//\u5de6\n\t\t\t{\n\t\t\t\tfor(int j=max(r-30,l);j<=r;j++)//\u53f3\n\t\t\t\t{\n\t\t\t\t\tif(i<=j&&Func(i,j)==goal&&b[j]-b[i]+1<b[ansr]-b[ansl]+1) \n\t\t\t\t\t{\n\t\t\t\t\t\tansl=i;\n\t\t\t\t\t\tansr=j;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tprintf(\"%lld %lld\\n\",b[ansl],b[ansr]);\n\t\t}\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1671198028,
        "uid": 378706,
        "name": "MoyunAllgorithm",
        "ccfLevel": 0,
        "title": "CF1732C2 Sheikh(Hard\uff09\u9898\u89e3"
    },
    {
        "content": "## CF1732C2 Sheikh (Hard Version)\n\u60f3\u8981\u66f4\u4f18\u8d28\u7684\u9605\u8bfb\u4f53\u9a8c\uff0c\u5c31\u6765[\u8fd9\u91cc](https://www.cnblogs.com/linyihdfj/p/16893607.html)\u5427\u3002\n### \u9898\u76ee\u5206\u6790\uff1a\n\u8fd9\u79cd\u9898\u4e00\u822c\u90fd\u4f1a\u8003\u8651\u8fd9\u6837\u7684\u4e00\u4e2a\u6027\u8d28\uff1a$a + b \\ge a \\oplus b$\n\u56e0\u4e3a\u5f02\u6216\u672c\u8d28\u4e0a\u662f\u4e0d\u8fdb\u4f4d\u52a0\u6cd5\uff0c\u663e\u7136\u4e0d\u53ef\u80fd\u8fdb\u4f4d\u52a0\u6cd5\u5927\u3002\n\n\u6211\u4eec\u663e\u7136\u53ef\u4ee5\u8003\u8651\u524d\u7f00\u548c\u4ee5\u53ca\u524d\u7f00\u5f02\u6216\uff0c\u8bbe $sum_i$ \u4e3a $[1,i]$ \u7684\u548c\uff0c$xor_i$ \u4e3a $[1,i]$ \u7684\u5f02\u6216\u3002\n\n\u90a3\u4e48\u533a\u95f4 $[l,r]$ \u7684\u4ef7\u503c\u5c31\u662f $sum_r - sum_{l-1} - xor_r \\oplus xor_{l-1}$\uff0c\u8003\u8651\u5047\u8bbe\u6211\u4eec\u65b0\u6dfb\u52a0\u4e86\u4e00\u4e9b\u6570\uff0c\u6ee1\u8db3\u8fd9\u4e9b\u6570\u7684\u548c\u4e3a $x$\uff0c\u5f02\u6216\u4e3a $y$\uff0c\u90a3\u4e48\u65b0\u533a\u95f4\u7684\u4ef7\u503c\u5c31\u662f\uff1a$sum_r - sum_{l-1} + x - xor_r \\oplus xor_{l-1} \\oplus y$\u3002\n\u6839\u636e\u4e0a\u9762\u7684\u6027\u8d28\u5e26\u5165\u4e00\u4e0b\u4f1a\u53d1\u73b0\uff0c\u65b0\u533a\u95f4\u7684\u4ef7\u503c\u4e00\u5b9a\u5927\u4e8e\u7b49\u4e8e\u539f\u533a\u95f4\u7684\u4ef7\u503c\u3002\n\n\u6240\u4ee5\u5176\u5b9e\u5bf9\u4e8e\u4e00\u4e2a\u8be2\u95ee $[L,R]$\uff0c\u6700\u5927\u7684\u4ef7\u503c\u4e00\u5b9a\u7b49\u4e8e $[L,R]$ \u5bf9\u5e94\u7684\u533a\u95f4\u7684\u4ef7\u503c\u3002\n\n\u90a3\u4e48\u5c31\u662f\u627e\u5230\u4e00\u4e2a\u5c3d\u53ef\u80fd\u77ed\u7684\u533a\u95f4\u4f7f\u5f97\u4ef7\u503c\u4e0e $[L,R]$ \u76f8\u7b49\u4e86\u3002\n\u4e0d\u8fdb\u4f4d\u52a0\u6cd5\u4e0e\u666e\u901a\u52a0\u6cd5\u76f8\u6bd4\u5c31\u662f\u8fdb\u4f4d\u7684\u4e0d\u540c\u554a\uff0c\u6240\u4ee5\u53ea\u8981\u4e0d\u8fdb\u4f4d\u5c31\u4e00\u5b9a\u662f\u5408\u6cd5\u7684\uff0c\u6211\u4eec\u6700\u591a\u53ea\u6709 $30$ \u4f4d\uff0c\u6240\u4ee5\u6839\u636e\u9e3d\u5de2\u539f\u7406\u6211\u4eec\u80fd\u9009\u62e9\u7684\u6570\u4e00\u5b9a\u4e0d\u8d85\u8fc7 $30$ \u4e2a\u3002\n\n\u6240\u4ee5\u5c31\u662f\u76f4\u63a5\u679a\u4e3e\u5de6\u8fb9\u5220\u591a\u5c11\u4e2a\u53f3\u8fb9\u5220\u591a\u5c11\u4e2a\uff0c\u7b97\u4e00\u4e0b\u65b0\u533a\u95f4\u7684\u7b54\u6848\u5c31\u597d\u4e86\u3002\n\n\u4f46\u662f\u9700\u8981\u6ce8\u610f\u7684\u662f\u6211\u4eec\u5220 $30$ \u4e2a\u662f\u6307\u7684\u6bcf\u4e00\u4e2a\u81f3\u5c11\u542b\u6709\u4e00\u4e2a $1$ \u7684\u60c5\u51b5\u4e0b\uff0c\u6240\u4ee5\u5e94\u8be5\u5148\u628a $0$ \u5168\u90e8\u53bb\u6389\u518d\u505a\u3002\n\n### \u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int N = 5e6+5;\nint sum[N],xo[N],b[N],a[N];\nint calc(int l,int r){return sum[r] - sum[l-1] - (xo[r] ^ xo[l-1]);}\nsigned main(){\n\tint t;\n\tscanf(\"%lld\",&t);\n\twhile(t--){\n\t\tint tot = 0;\n\t\tint n,q;scanf(\"%lld%lld\",&n,&q);\n\t\tfor(int i=1; i<=n; i++){\n\t\t\tscanf(\"%lld\",&a[i]);\n\t\t\tif(a[i] != 0) \tb[++tot] = i;\n\t\t}\n\t\tn = tot;   //\u76f4\u63a5\u628a\u96f6\u53bb\u6389 \n\t\tfor(int i=1; i<=n; i++)\tsum[i] = sum[i-1] + a[b[i]];\n\t\tfor(int i=1; i<=n; i++)\txo[i] = xo[i-1] ^ a[b[i]];\n\t\twhile(q--){\n\t\t\tint l,r;scanf(\"%lld%lld\",&l,&r);int tmp = l;\n\t\t\tl = lower_bound(b+1,b+n+1,l) - b;\n\t\t\tr = upper_bound(b+1,b+n+1,r) - b - 1;\n\t\t\tif(l > r || n == 0){  //\u90fd\u662f\u96f6\u5c31\u65e0\u6240\u8c13\u4e86 \n\t\t\t\tprintf(\"%lld %lld\\n\",tmp,tmp);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tint ansl = l,ansr = r;\n\t\t\tfor(int i=l; i<=min(l+30,r); i++){  //\u6700\u591a\u4e00\u8fb9\u5220\u4e09\u5341\u4e2a \n\t\t\t\tfor(int j=r; j>=max(r-30,l); j--){\n\t\t\t\t\tif(i <= j && calc(l,r) == calc(i,j) && b[j] - b[i] < b[ansr] - b[ansl]){\n\t\t\t\t\t\tansl = i,ansr = j;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tprintf(\"%lld %lld\\n\",b[ansl],b[ansr]);\n\t\t}\n\t}\n}\n```",
        "postTime": 1669099467,
        "uid": 544860,
        "name": "linyihdfj",
        "ccfLevel": 5,
        "title": "\u3010\u9898\u89e3\u3011CF1732C2 Sheikh (Hard Version)"
    },
    {
        "content": "\u4e00\u9053\u6bd4\u8f83\u597d\u7684\u9898\u76ee\u3002\n\n\u9996\u5148\u6709\u4e00\u4e2a\u7ed3\u8bba\uff0c\u5982\u679c\u4e0d\u9650\u5236\u957f\u5ea6\u7684\u8bdd\uff0c\u90a3\u4e48\u628a\u7ed9\u5b9a\u7684\u533a\u95f4\u9009\u6ee1\u80af\u5b9a\u662f\u66f4\u4f18\u7684\u3002\u53ef\u4ee5\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u6709\u4e00\u4e2a\u5f02\u6216\u548c\u662f $x$ \u7684\u6570\u5217\uff0c\u52a0\u8fdb\u53bb\u4e00\u4e2a\u5143\u7d20 $a$\uff0c\u90a3\u4e48\u8fd9\u4e2a\u6570\u5217\u7684\u4ef7\u503c\u53d8\u5316\u91cf\u5e94\u8be5\u5c31\u662f $a+x-(x\\oplus a)$\u3002\u663e\u7136\u8fd9\u4e2a\u4e1c\u897f\u662f\u975e\u8d1f\u7684\uff0c\u6240\u4ee5\u6700\u4f18\u5e8f\u5217\u7684\u503c\u662f\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97\u5f97\u5230\u7684\uff0c\u6240\u4ee5\u5bf9\u4e8e C1 \u53ef\u4ee5\u8003\u8651\u679a\u4e3e\u5de6\u7aef\u70b9\uff0c\u7136\u540e\u4e8c\u5206\u53f3\u7aef\u70b9\uff0c\u627e\u5230\u7b2c\u4e00\u4e2a\u53f3\u7aef\u70b9\u4f7f\u5f97\u8fd9\u4e2a\u533a\u95f4\u7684\u7b54\u6848\u7b49\u4e8e\u8ba1\u7b97\u7684\u6700\u4f18\u7b54\u6848\uff0c\u66f4\u65b0\u5373\u53ef\u3002\n\n\u800c\u5bf9\u4e8e C2 \u800c\u8a00\u5c31\u9700\u8981\u66f4\u5177\u8c61\u5316\u7684\u67ff\u5b50\u4e86\u3002\u8003\u8651\u4e0a\u9762\u90a3\u4e2a\u67ff\u5b50\uff0c\u663e\u7136\u53ef\u4ee5\u6309\u4f4d\u8003\u8651\uff0c\u5206\u7c7b\u8ba8\u8bba\u4e4b\u540e\u53d1\u73b0\u5bf9\u4e8e\u67d0\u4e00\u4f4d\u800c\u8a00\uff0c\u5f53 $x$ \u548c $a$ \u7684\u8fd9\u4e00\u4f4d\u540c\u65f6\u4e3a $1$ \u65f6\uff0c\u8d21\u732e\u662f\u8fd9\u4e00\u4f4d\u7684\u4e24\u500d\uff1b\u5bf9\u4e8e\u5176\u5b83\u60c5\u51b5\u8fd9\u4e00\u4f4d\u90fd\u662f\u6ca1\u6709\u8d21\u732e\u7684\uff08\u5c31\u62ff $1,0$ \u4e3e\u4f8b\uff0c$a+x$ \u8fd9\u4e00\u4f4d\u662f $1$\uff0c$a\\oplus x$ \u8fd9\u4e00\u4f4d\u4e5f\u662f\uff0c\u4e00\u51cf\u5c31\u6ca1\u4e86\uff09\u3002\u7136\u540e\u53ef\u4ee5\u63a8\u51fa\u5047\u5982\u4e00\u4e2a\u5e8f\u5217\u67d0\u4e00\u4f4d\u4e0a $1$ \u7684\u4e2a\u6570\u662f $t$\uff0c\u90a3\u4e48\u8fd9\u4e00\u4f4d\u7684\u8d21\u732e\u5e94\u8be5\u662f $\\lfloor\\frac{t}{2}\\rfloor\\times 2$ \u4e2a\u8be5\u4f4d\u5bf9\u5e94\u7684\u6743\u503c\uff08\u56e0\u4e3a\u53ea\u6709\u7b2c\u5076\u6570\u6b21\u51fa\u73b0\u624d\u4f1a\u6709\u8d21\u732e\uff0c\u800c\u6bcf\u6b21\u8d21\u732e\u4f1a\u8d21\u732e\u4e24\u4e2a\u6743\u503c\uff0c\u6240\u4ee5\u6709\u8fd9\u4e2a\u67ff\u5b50\uff09\u3002\n\n\u4e8e\u662f\u53ef\u4ee5\u5bf9\u533a\u95f4\u5185\u6bcf\u4e00\u4f4d $1$ \u7684\u6570\u91cf\u5206\u7c7b\u8ba8\u8bba\uff0c\u5982\u679c\u662f\u5076\u6570\u7684\u8bdd\u5c31\u5f88\u7b80\u5355\uff0c\u7b2c\u4e00\u4e2a $1$ \u5230\u6700\u540e\u4e00\u4e2a $1$ \u4e4b\u5185\u7684\u6570\u90fd\u5fc5\u987b\u9009\uff0c\u8fd9\u663e\u7136\u662f\u6700\u4f18\u4e14\u552f\u4e00\u7684\u65b9\u6848\u3002\u5982\u679c\u662f\u5947\u6570\u7684\u8bdd\uff0c\u4e3a\u4e86\u7f29\u77ed\u957f\u5ea6\u6211\u4eec\u53ef\u4ee5\u53bb\u6389\u7b2c\u4e00\u4e2a\u6216\u8005\u6700\u540e\u4e00\u4e2a $1$\u3002\u6700\u7ec8\u9009\u62e9\u7684\u533a\u95f4\u662f\u8fd9\u4e9b\u4f4d\u5bf9\u5e94\u7684\u51b3\u7b56\u533a\u95f4\u7684\u5e76\u3002\n\n\u4e8e\u662f\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u6709\u5f88\u591a\u4e2a\u533a\u95f4\uff0c\u6709\u4e9b\u533a\u95f4\u5fc5\u987b\u9009\uff0c\u6709\u4e9b\u533a\u95f4\u4e24\u4e24\u914d\u5bf9\u9700\u8981\u81f3\u5c11\u9009\u4e00\u4e2a\uff0c\u5e0c\u671b\u6700\u5c0f\u5316\u8fd9\u4e9b\u533a\u95f4\u5e76\u7684\u5927\u5c0f\u3002\u8003\u8651\u5230\u533a\u95f4\u6570\u91cf\u662f\u5f88\u5c11\u7684\uff0c\u6240\u4ee5\u53ef\u4ee5\u679a\u4e3e\u7b54\u6848\u533a\u95f4\u7684\u5de6\u7aef\u70b9\uff0c\u7136\u540e\u5bf9\u4e8e\u5269\u4e0b\u7684\u533a\u95f4\u8d2a\u5fc3\u5373\u53ef\u3002\u8bbe\u503c\u57df\u4e3a $[1,S]$\uff0c\u590d\u6742\u5ea6\u5373\u662f $O(N\\log^2S)$\u3002\u4ee3\u7801\u6bd4\u8f83\u597d\u5199\u3002\n\n```cpp\n#include<bits/stdc++.h>\n//#define feyn\nconst int N=100010; \nusing namespace std;\ninline void read(int &wh){\n    wh=0;char w=getchar();int f=1;\n    while(w<'0'||w>'9'){if(w=='-')f=-1;w=getchar();}\n    while(w<='9'&&w>='0'){wh=wh*10+w-'0';w=getchar();}\n    wh*=f;return;\n}\n     \nint m,a[N],q,sum[N][32],plB[N][32],plA[N][32];\n     \nstruct node{int l,r;}s[50],ll[50],rr[50];\nint x,y;//x-s y-ll&rr\n     \nint ans,al,ar;\ninline void check(int l){\n    int mxr=0;\n    for(int i=1;i<=x;i++)if(s[i].l<l)return;else mxr=max(mxr,s[i].r);\n    for(int i=1;i<=y;i++){\n    \tif(ll[i].l<l){\n    \t\tif(rr[i].l<l)return;\n    \t\telse mxr=max(mxr,rr[i].r);\n    \t}\n    \telse mxr=max(mxr,ll[i].r);\n    }\n    if(ans<=mxr-l+1)return;\n    ans=mxr-l+1;al=l,ar=mxr;\n}\ninline void work(){\n    x=0;y=0;int l,r;read(l);read(r);ans=1e9;\n    for(int i=0;i<=31;i++){\n    \tint nowSum=sum[r][i]-sum[l-1][i];\n    \tif(nowSum<=1)continue;\n    \tint aa=plA[l][i],bb=plB[r][i];\n    \tif(nowSum&1){\n    \t\tint aaa=plA[aa+1][i],bbb=plB[bb-1][i];\n    \t\ty++;rr[y]=(node){aaa,bb};ll[y]=(node){aa,bbb};\n    \t}\n    \telse s[++x]=(node){aa,bb};\n    }\n    if(x==0&&y==0)return printf(\"%d %d\\n\",l,l),void();\n    for(int i=1;i<=x;i++)check(s[i].l);\n    for(int i=1;i<=y;i++)check(ll[i].l),check(rr[i].l);\n    return printf(\"%d %d\\n\",al,ar),void();\n}\nvoid solve(){\n    read(m);read(q);\n    for(int i=1;i<=m;i++)for(int j=0;j<=31;j++)sum[i][j]=plB[i][j]=plA[i][j]=0;\n    for(int i=1;i<=m;i++){read(a[i]);for(int j=0;j<=31;j++)sum[i][j]=sum[i-1][j]+(((1<<j)&a[i])>0);}\n    for(int i=1;i<=m;i++)for(int j=0;j<=31;j++)if((1<<j)&a[i])plB[i][j]=plA[i][j]=i;\n    for(int i=1;i<=m;i++)for(int j=0;j<=31;j++)if(plB[i][j]==0)plB[i][j]=plB[i-1][j];\n    for(int i=m;i>=1;i--)for(int j=0;j<=31;j++)if(plA[i][j]==0)plA[i][j]=plA[i+1][j];\n    while(q--)work();\n}\n     \nsigned main(){\n\t\n    #ifdef feyn\n    freopen(\"in.txt\",\"r\",stdin);\n    #endif\n    \t\n    int test;read(test);\n  \twhile(test--)solve();\n\n   \treturn 0;\n}\n```",
        "postTime": 1666531883,
        "uid": 302383,
        "name": "Feyn",
        "ccfLevel": 0,
        "title": "CF1732C2"
    },
    {
        "content": "## \u9898\u610f\n\n\u5b9a\u4e49\u4e00\u4e2a\u5e8f\u5217\u7684\u4ef7\u503c\u4e3a\u5176\u5143\u7d20\u7684\u548c\u51cf\u53bb\u5f02\u6216\u548c\u3002\u7ed9\u51fa\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217\u548c $q=n$ \u4e2a\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee $[l,r]$ \u4e2d\u4ef7\u503c\u6700\u5927\u7684\u524d\u63d0\u4e0b\u957f\u5ea6\u6700\u77ed\u7684\u5b50\u6bb5\u3002\n\n## \u5206\u6790\n\n\u9996\u5148\u56e0\u4e3a\u5f02\u6216\u8fd0\u7b97\u662f\u4e0d\u8fdb\u4f4d\u52a0\u6cd5\uff0c\u6709 $x \\oplus y \\leq x+y$\uff0c\u6240\u4ee5$x_1+y -(x_2 \\oplus y) \\geq x_1-x_2$\uff0c\u5373\u5411\u4e00\u4e2a\u5e8f\u5217\u4e2d\u52a0\u5165\u4e00\u4e2a\u6570\uff0c\u4ef7\u503c\u4e0d\u964d\uff0c\u6240\u4ee5\u9009\u53d6\u6574\u4e2a\u533a\u95f4\u7684\u4ef7\u503c\u5c31\u662f\u6700\u5927\u7684\u3002\n\n\u8003\u8651\u6c42\u51fa\u957f\u5ea6\u6700\u5c0f\u7684\u533a\u95f4\uff0c\u6309\u4f4d\u8003\u8651\uff1a\u5047\u5982\u539f\u6765\u7684\u5f02\u6216\u548c\u4e3a $1$\uff0c\u52a0\u5165 $1$\uff0c\u4f1a\u4ea7\u751f $2$ \u7684\u4ef7\u503c\uff0c\u4f7f\u5f02\u6216\u548c\u53d8\u4e3a $0$\uff1b\u5047\u5982\u539f\u6765\u7684\u5f02\u6216\u548c\u4e3a $0$\uff0c\u52a0\u5165 $1$\uff0c\u4f1a\u4ea7\u751f $0$ \u7684\u4ef7\u503c\uff0c\u4f7f\u5f02\u6216\u548c\u53d8\u4e3a $1$\uff1b\u800c\u52a0\u5165 $0$ \u4e0d\u4f1a\u5bf9\u4ef7\u503c\u548c\u5f02\u6216\u548c\u4ea7\u751f\u5f71\u54cd\u3002\u53ef\u4ee5\u53d1\u73b0\uff0c\u53ea\u6709\u4e00\u4e2a $1$ \u524d\u9762\u6709\u5947\u6570\u4e2a $1$ \u65f6\u624d\u4f1a\u4ea7\u751f $2$ \u7684\u8d21\u732e\u3002\u56e0\u6b64\u4e00\u4e2a\u542b\u6709 $x$ \u4e2a $1$ \u7684\u5e8f\u5217\u5bf9\u4ef7\u503c\u7684\u8d21\u732e\u4e3a $2\\lfloor \\frac{x}{2} \\rfloor$\uff0c\u53c8\u8981\u4fdd\u8bc1\u8fd9\u4e2a\u4ef7\u503c\u521a\u597d\u7b49\u4e8e\u6574\u4e2a\u5e8f\u5217\u7684\u4ef7\u503c\uff0c\u6240\u4ee5\u6bcf\u4e00\u4f4d\u7684\u8d21\u732e\u90fd\u5fc5\u987b\u76f8\u540c\uff0c\u6240\u4ee5\u5f53\u6574\u4e2a\u5e8f\u5217\u67d0\u4e00\u4f4d\u7684\u4ef7\u503c $x$ \u4e3a\u5076\u6570\u65f6\uff0c$x' = x$\uff1b\u5426\u5219 $x' = x,x-1$\u3002\u5373\u957f\u5ea6\u4e3a\u5076\u6570\u65f6\u5305\u542b\u7684 $1$ \u7684\u4e2a\u6570\u548c\u603b\u5171\u7684\u4e2a\u6570\u76f8\u7b49\uff0c\u5426\u5219\u53ef\u4ee5\u53bb\u6389\u6700\u5de6\u8fb9\u6216\u6700\u53f3\u8fb9\u7684 $1$\u3002\n\n\u73b0\u5728\u6211\u4eec\u6709\u4e86 $\\log$ \u5bf9\u533a\u95f4\uff0c\u6bcf\u4e00\u5bf9\u4e2d\u5fc5\u987b\u9009\u62e9\u4e00\u4e2a\uff0c\u4f7f\u5f97\u6240\u6709\u533a\u95f4\u5e76\u8d77\u6765\u6700\u5c0f\uff0c\u663e\u7136\u6700\u540e\u5e76\u8d77\u6765\u7684\u5de6\u7aef\u70b9\u4e00\u5b9a\u662f\u67d0\u4e00\u4e2a\u533a\u95f4\u5de6\u7aef\u70b9\uff0c\u800c\u533a\u95f4\u4e2a\u6570\u662f $\\log$ \u7ea7\u522b\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u5de6\u7aef\u70b9\uff0c\u5982\u679c\u5c3d\u91cf\u9009\u9760\u5de6\u7684\u533a\u95f4\uff0c\u4f46\u8981\u4fdd\u8bc1\u6240\u6709\u533a\u95f4\u7684\u5de6\u7aef\u70b9\u4e0d\u8d85\u8fc7\u94a6\u5b9a\u7684\u5de6\u7aef\u70b9\uff0c\u7136\u540e\u5f97\u5230\u7684\u53f3\u7aef\u70b9\u6700\u5c0f\u5373\u53ef\u3002\n\n## code\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nconst int N=200001,M=32;\nint n,m,a[N],b[N][M][2],c[N][M];\nstruct str\n{\n    int l,r;\n}d[M][2];\nint check(int x)\n{\n    int s=x;\n    for(int i=0;i<=30;++i)\n    {\n        if(d[i][0].l==-1) continue;\n        if(d[i][0].l>=x) s=max(s,d[i][0].r);\n        else if(d[i][1].l>=x) s=max(s,d[i][1].r);\n        else return 1e9;\n    }\n    return s;\n}\nvoid abc()\n{\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n;++i)\n    {\n        scanf(\"%d\",&a[i]);\n        for(int j=0;j<=30;++j)\n        {\n            c[i][j]=c[i-1][j]+((a[i]&(1<<j))!=0);\n        }\n    }\n    for(int i=0;i<=n+1;++i)\n    {\n        for(int j=0;j<=30;++j) b[i][j][0]=b[i][j][1]=0;\n    }\n    for(int i=n;i>=1;--i)\n    {\n        for(int j=0;j<=30;++j)\n        {\n            if((a[i]&(1<<j))!=0) b[i][j][0]=i;\n            else b[i][j][0]=b[i+1][j][0];\n        }\n    }\n    for(int i=1;i<=n;++i)\n    {\n        for(int j=0;j<=30;++j)\n        {\n            if((a[i]&(1<<j))!=0) b[i][j][1]=i;\n            else b[i][j][1]=b[i-1][j][1];\n        }\n    }\n    for(int i=1;i<=m;++i)\n    {\n        int x,y;\n        scanf(\"%d%d\",&x,&y);\n        for(int j=0;j<=30;++j)\n        {\n            if(c[y][j]-c[x-1][j]<=1)\n            {\n                d[j][0]=d[j][1]=(str){-1,-1};\n                continue;\n            }\n            if((c[y][j]-c[x-1][j])%2!=0)\n            {\n                d[j][0]=(str){b[x][j][0],b[b[y][j][1]-1][j][1]};\n                d[j][1]=(str){b[b[x][j][0]+1][j][0],b[y][j][1]};\n            }\n            else\n            {\n                d[j][0]=d[j][1]=(str){b[x][j][0],b[y][j][1]};\n            }\n        }\n        int s=check(x)-x+1,q=x;\n        for(int j=0;j<=30;++j)\n        {\n            if(d[j][0].l==-1) continue;\n            int z=check(d[j][0].l)-d[j][0].l+1;\n            if(z<s) s=z,q=d[j][0].l;\n            z=check(d[j][1].l)-d[j][1].l+1;\n            if(z<s) s=z,q=d[j][1].l;\n        }\n        printf(\"%d %d\\n\",q,q+s-1);\n    }\n}\nint main()\n{\n    int T;\n    scanf(\"%d\",&T);\n    while(T--) abc();\n    return 0;\n}\n```",
        "postTime": 1666618419,
        "uid": 291248,
        "name": "\u8d75\u60a6\u5c91",
        "ccfLevel": 7,
        "title": "CF1732C2 Sheikh (Hard Version) \u9898\u89e3"
    },
    {
        "content": "## \u9898\u610f\n\u7ed9\u51fa\u4e00\u4e2a\u6570\u5217 $A$\uff0c\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a\u533a\u95f4 $[l,r]$ \u7684\u4ef7\u503c\u4e3a ${\\sum_{i=l}^rA_i}-{\\bigoplus_{i=l}^{r}A_i}$\uff0c\u73b0\u5728\u7ed9\u51fa $Q$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u4f1a\u7ed9\u51fa\u4e00\u4e2a\u533a\u95f4 $[L,R]$\uff0c\u4f60\u8981\u6c42\u51fa\u8be5\u533a\u95f4\u7684\u6240\u6709\u5b50\u533a\u95f4\u4e2d\u4ef7\u503c\u6700\u5927\u7684\u90a3\u4e2a\u533a\u95f4\u5e76\u8f93\u51fa\uff0c\u82e5\u6709\u591a\u4e2a\u4ef7\u503c\u76f8\u540c\u4e14\u6700\u5c0f\u7684\u533a\u95f4\uff0c\u6211\u4eec\u5e94\u8f93\u51fa\u5176\u4e2d\u533a\u95f4\u957f\u5ea6\uff08\u5373 $l-r+1$\uff09\u6700\u77ed\u7684\u90a3\u4e2a\u3002\n\n## \u601d\u8def\n\u5148\u601d\u8003\u4ef7\u503c\u7684\u5b9e\u9645\u542b\u4e49\uff0c\u770b\u5230\u5f02\u6216\uff0c\u6211\u4eec\u4f1a\u60f3\u5230\u4e0d\u8fdb\u4f4d\u52a0\u6cd5\uff0c\u4e5f\u5c31\u662f\u8bf4\u5b83\u4e0e\u771f\u6b63\u7684\u52a0\u6cd5\u7684\u5dee\u522b\u5728\u4e8e\u4e0d\u8fdb\u4f4d\uff0c\u51b3\u5b9a\u533a\u95f4\u4ef7\u503c\u7684\u5b9e\u9645\u4e0a\u662f\u533a\u95f4\u5f02\u6216\u65f6\u88ab\u4e0d\u8fdb\u4f4d\u5361\u6389\u7684\u503c\u7684\u548c\u3002\u663e\u7136\u5730\uff0c\u6211\u4eec\u53d1\u73b0\uff0c\u5bf9\u4e8e\u4efb\u610f\u4e00\u4e2a\u53ef\u4ee5\u5de6\u53f3\u6269\u5c55\u7684\u533a\u95f4 $[l,r]$\uff0c\u5b83\u7684\u8d21\u732e\u4e00\u5b9a\u5c0f\u4e8e\u7b49\u4e8e $[l-1,r]$ \u548c $[l,r+1]$\uff08\u56e0\u4e3a\u53ef\u4ee5\u5bfc\u81f4\u66f4\u591a\u53ef\u80fd\u7684\u8fdb\u4f4d\u88ab\u5361\u6389\uff09\u3002\u4e8e\u662f\u6211\u4eec\u77e5\u9053\u533a\u95f4 $[L,R]$ \u5b83\u672c\u8eab\u5c31\u4e00\u5b9a\u662f\u4ef7\u503c\u6700\u5927\u7684\u5b50\u533a\u95f4\u4e4b\u4e00\u3002\u8fd9\u65f6\u6211\u4eec\u5982\u679c\u6211\u4eec\u5c1d\u8bd5\u5220\u53bb\u533a\u95f4\u4e2d\u6ca1\u6709\u8d21\u732e\u7684\u6570\u7684\u8bdd\uff0c\u6211\u4eec\u5c31\u80fd\u6c42\u5230\u66f4\u77ed\u7684\u90a3\u4e2a\u533a\u95f4\u3002\n\n\u90a3\u4e48\u90a3\u4e9b\u6570\u6ca1\u6709\u8d21\u732e\uff0c\u5047\u8bbe\u5f53\u524d\u533a\u95f4\u7684\u5f02\u6216\u548c\u4e3a $now$\uff0c\u800c\u6211\u4eec\u5224\u65ad\u80fd\u4e0d\u80fd\u5220\u7684\u7aef\u70b9\u7684\u503c\u4e3a $x$\uff0c\u4e8e\u662f\u6211\u4eec\u53d1\u73b0\u53ea\u8981 $x$ \u5f53\u524d\u80fd\u8ba9\u533a\u95f4\u7684\u5f02\u6216\u548c\u8fdb\u4f4d\uff0c\u90a3\u4e48\u5b83\u5c31\u5bf9\u4ef7\u503c\u6709\u8d21\u732e\uff0c\u5c31\u4e0d\u80fd\u5220\uff0c\u5426\u5219\u5c31\u53ef\u4ee5\u5220\u3002\u5f02\u6216\u91cc\u9762\u8fdb\u4e86\u4f4d\u7684\u4f4d\u6570\u4e3a $0$\uff0c\u53ea\u8981 $now$ \u548c\u4e0e $x$ \u5728\u4e8c\u8fdb\u5236\u4e0b\u7684\u67d0\u4e00\u4f4d\u4f7f\u5f97 $x$ \u4e0a\u662f $1$\uff0c\u800c $now$ \u4e0a\u4e0d\u662f\uff0c\u5219\u8bf4\u660e\u6709\u8d21\u732e\uff0c\u4e0d\u80fd\u5220\u3002\u90a3\u4e0d\u5c31\u8981\u4fdd\u8bc1 $x$ \u4e0a\u5bf9\u5e94\u7684\u4f4d\u6570\u662f $1$ \u561b\uff0c\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u7b80\u5355\u5730\u628a\u5224\u65ad\u662f\u5426\u80fd\u5220\u5199\u6210\u8fd9\u6837\u7684\u5f0f\u5b50 $[now|x>=now]$\u3002\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u6211\u4eec\u53d1\u73b0\u6bcf\u5f53\u6211\u4eec\u5220\u6389\u4e00\u4e2a\u6570\uff08$0$ \u9664\u5916\uff09\u65f6\uff0c\u4e00\u5b9a\u4f1a\u51cf\u5c11\u5f02\u6216\u548c\u5728\u4e8c\u8fdb\u5236\u4e0b\u4e3a $1$ \u7684\u4f4d\u6570\uff0c\u4e8e\u662f\u5f88\u5bb9\u6613\u53d1\u73b0\u6700\u591a\u4f1a\u5220\u6389 $\\log_2now$\uff08\u5373\u6bcf\u4e00\u4f4d $1$ \u90fd\u8981\u82b1\u8d39\u4e00\u4e2a\u6570\u53bb\u5220\uff09\u6b21\u3002\n\n\u73b0\u5728\u7ef4\u62a4\u5220\u6570\uff0c\u53d1\u73b0\u533a\u95f4\u5de6\u53f3\u4e24\u8fb9\u90fd\u80fd\u5220\uff0c\u800c\u4e14\u53ef\u80fd\u4e0d\u80fd\u8d2a\u5fc3\u5730\u9009\uff0c\u90a3\u5c31\u8003\u8651\u56fa\u5b9a\u533a\u95f4\u5de6\u7aef\u70b9\u4e0d\u53d8\uff0c\u4ece\u6700\u53f3\u7aef\u5f00\u59cb\u5220\u53f3\u7aef\u70b9\uff0c\u66b4\u529b\u5224\u65ad\u662f\u5426\u80fd\u5220\uff0c\u5220\u5b8c\u540e\u5224\u65ad\u662f\u5426\u4e3a\u66f4\u4f18\u7684\u7b54\u6848\uff0c\u8fd9\u6837\u505a\u5c31\u53ef\u4ee5\u505a\u5230 $\\Theta(n+q\\log_2^2V)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u5176\u4e2d $V={\\bigoplus _2{\\max_{i=L}^{i=R}{A_i}}})$\n\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a $O(n)$\uff0c\u5df2\u7ecf\u53ef\u4ee5\u8fc7\u4e86~~\u6ca1\u60f3\u5230CF\u7adf\u7136\u6ca1\u903c\u6211\u4f18\u5316~~\u3002\n\n\u7279\u6b8a\u5730\uff0c\u56e0\u4e3a $0$ \u4e0d\u4f1a\u53bb\u9664\u4efb\u4f55\u4e00\u4f4d\u7684 $1$\uff0c\u6240\u4ee5\u6211\u4eec\u5728\u5220\u6570\u65f6\u53ef\u4ee5\u76f4\u63a5\u7701\u7565\u6389\uff0c\u53ef\u4ee5\u76f4\u63a5\u7ef4\u62a4\u4e00\u4e2a\u94fe\u8868\uff0c\u4fdd\u8bc1\u94fe\u8868\u4e0a\u6ca1\u6709 $0$\uff0c\u7136\u540e\u5728\u94fe\u8868\u4e0a\u6761\u5c31\u884c\u4e86\u3002\n## Code\n```cpp\n//\u79c1\u4eba\u6240\u6709\uff0c\u7981\u6b62\u6284\u88ad\n//PS:log\u65b9\u7684\u5199\u6cd5\n#include<bits/stdc++.h>\nusing namespace std;\ninline int read(){\n\tint num=0;\n\tchar ch=getchar();\n\twhile(!isdigit(ch))ch=getchar();\n\twhile(isdigit(ch))num=(num<<1)+(num<<3)+(ch&15),ch=getchar();\n\treturn num;\n}\nint a[100010],las[100010],nxt[100010],xorsum[100010];\nint main(){\n\tint T=read()+1;\n\twhile(--T){\n\t\tint n=read(),Q=read()+1,syc=0;\n\t\t//syc\u4e3a\u4e0a\u4e00\u4e2a\u975e0\u7684\u6570\n\t\tfor(int i=1;i<=n;++i){\n\t\t\ta[i]=read();\n\t\t\txorsum[i]=xorsum[i-1]^a[i];\n\t\t\tif(a[i])las[i]=syc,nxt[syc]=i,syc=i;\n\t\t\telse las[i]=syc;\n\t\t\t//\u4e3a\u4e86\u65b9\u4fbf\u8df3\uff0c\u8ba90\u5355\u5411\u5730\u52a0\u5165\u94fe\u8868\n\t\t}\n\t\tsyc=n+1;\n\t\tfor(int i=n;i>0;--i){\n\t\t\tif(a[i])syc=i;\n\t\t\telse nxt[i]=syc;\n\t\t}\n\t\twhile(--Q){\n\t\t\tint l=read(),r=read();\n\t\t\tif(l==r){\n\t\t\t\tprintf(\"%d %d\\n\",l,r);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t//\u8fd9\u91cc\u5b9e\u9645\u4e0a\u662f\u7279\u5224\u533a\u95f4\u5168\u4e3a0\u7684\u60c5\u51b5\n\t\t\tif(nxt[l]>r&&!a[l]){\n\t\t\t\tprintf(\"%d %d\\n\",l,l);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(!a[l])l=nxt[l];if(!a[r])r=las[r];\n\t\t\tint maxn=xorsum[r]^xorsum[l-1],prel=l,prer=r,ansl=l,ansr=r;\n\t\t\t//\u7ef4\u62a4\u5de6\u7aef\u70b9\uff0c\u5220\u53f3\u7aef\u70b9\n\t\t\twhile(prel<=r){\n\t\t\t\tint now=maxn;\n\t\t\t\tprer=r;\n\t\t\t\twhile(las[prer]>=prel&&(now|a[prer])<=now)now^=a[prer],prer=las[prer];\n\t\t\t\tif(ansr-ansl>prer-prel)ansl=prel,ansr=prer;//\u5224\u65ad\u7b54\u6848\u662f\u5426\u66f4\u4f18\n\t\t\t\tif(nxt[prel]<=r&&(maxn|a[prel])<=maxn)maxn^=a[prel],prel=nxt[prel];\n\t\t\t\telse break;\n\t\t\t}\n\t\t\tprintf(\"%d %d\\n\",ansl,ansr);\n\t\t}\n\t}\n\treturn 0;\n}\n//(\u3002\u30fb\u2200\u30fb)\u30ce\n```\n## Another Solution\n\u5728\u6b64\u57fa\u7840\u4e0a\uff0c\u6211\u4eec\u662f\u5426\u80fd\u5c1d\u8bd5\u4f18\u5316\u8fd9\u6837\u7684\u505a\u6cd5\uff0c\u6211\u4eec\u53d1\u73b0\u5f53\u5de6\u7aef\u70b9\u53f3\u79fb\u65f6\uff0c\u80fd\u5230\u8fbe\u7684\u6700\u5de6\u7684\u53f3\u7aef\u70b9\u4e5f\u4f1a\u53f3\u79fb\uff0c\uff08\u5de6\u8fb9\u5220\u5f97\u5c11\u65f6\uff0c\u53f3\u8fb9\u4f1a\u5220\u5f97\u53ef\u80fd\u66f4\u591a\uff09\uff0c\u90a3\u76f4\u63a5\u5199\u4e2a\u53cc\u6307\u9488\uff0c\u5de6\u6307\u9488\u6307\u5411\u5de6\u7aef\u70b9\uff0c\u53f3\u6307\u9488\u6307\u5411\u53f3\u7aef\u70b9\uff0c\u7136\u540e\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u53d8\u4e3a\u4e86 $\\Theta(n+q\\log_2V)$\u3002\u8fd9\u662f\u4e00\u4e2a\u4f18\u79c0\u7684\u89e3\u6cd5~~\u4f46\u6211\u6ca1\u53bb\u5199~~\uff01\n\n~~\u8fd9\u90e8\u5206\u662f\u540e\u9762\u540e\u5934\u8865\u7684\uff0c\u56e0\u4e3a\u6709\u4e00\u4e2a\u6211\u6559\u7684\u4eba\u4ea4\u4e86\u53d1\u8ddf\u6211\u4ee3\u7801\u5f88\u50cf\u7684\u9898\u89e3\uff0c\u5fc3\u91cc\u4e0d\u592a\u8e0f\u5b9e\u3002~~\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u4e86\u8fd9\u4e2a\u89e3\u6cd5\u7684\u4e0d\u8db3\u4e4b\u5904\uff0c\u6211\u4eec\u5f97\u5148\u5728\u4e0d\u5220\u5de6\u7aef\u70b9\u65f6\uff0c\u8dd1\u4e00\u904d\u53f3\u7aef\u70b9\u6700\u8fdc\u8dd1\u54ea\uff0c\u7136\u540e\u8fd8\u53d1\u73b0\u5728\u7ef4\u62a4\u53f3\u6307\u9488\u53f3\u79fb\u65f6\u975e\u5e38\u9ebb\u70e6\uff0c\u56e0\u4e3a\u53f3\u79fb\u5de6\u6307\u9488\u65f6\u8981\u5c06\u6240\u6709\u53ef\u80fd\u66f4\u6539\u7684\u53f3\u6307\u9488\u7684\u4f4d\u7f6e\u90fd\u7b97\u4e0a\u4e00\u904d\uff0c\u663e\u7136\u6240\u6709\u5220\u9664\u7684\u5de6\u7aef\u70b9\u6700\u591a\u4f1a\u5e26\u6765 $\\log_2 V$ \u4e2a\u8fd9\u6837\u7684\u4f4d\u7f6e\uff08\u56e0\u4e3a\u53f3\u7aef\u70b9\u73b0\u5728\u662f\u52a0\u56de\u6765\uff0c\u5982\u679c\u5728\u5de6\u53f3\u4e24\u8fb9\u540c\u65f6\u5220\u9664\u4e86\u8fd9\u4e2a\u4f4d\u7f6e\u4e0a\u7684 $1$\uff0c\u663e\u7136\u53f3\u8fb9\u7684\u4f4d\u7f6e\u5c31\u4e0d\u5408\u6cd5\u4e86\uff0c\u90a3\u5fc5\u987b\u4fdd\u8bc1\u8fd9\u4e2a\u4f4d\u7f6e\u5728\u533a\u95f4\u4e2d\uff09\uff0c\u56e0\u4e3a\u6bcf\u4e00\u4f4d\u7684 $1$ \u5728\u7b2c\u4e00\u6b21\u53ea\u5220\u53f3\u7aef\u70b9\u7684\u8fc7\u7a0b\u4e2d\u53ea\u4f1a\u88ab\u4e00\u4e2a $A_i$ \u5220\u6389\uff0c\u6211\u4eec\u53ef\u4ee5\u8bb0\u5f55\u4e0b\u6765\uff0c\u7136\u540e\u56de\u5934\u770b\u81ea\u5df1\u4f1a\u52a0\u56de\u54ea\u4e2a\u4f4d\u7f6e\uff0c\u5c31\u628a\u5b83\u4eec\u52a0\u56de\u6765\uff0c\u53ef\u4ee5\u4e8b\u5148\u8bb0\u5f55\u6bcf\u4e00\u4e2a $A_i$ \u4e8c\u8fdb\u5236\u4e0b\u4f1a\u6539\u53d8\u54ea\u4e2a\u4f4d\u7f6e\u3002\n\n\u4f46\u662f\u8fd9\u4e2a\u505a\u6cd5\u5e38\u6570\u6bd4\u524d\u9762\u7684\u5927\u5f88\u591a\uff0cCF\u4e0a\u5b9e\u6d4b\u8f83\u6162\uff0c\u4e8b\u5b9e\u4e0a\u524d\u9762\u7684\u505a\u6cd5\u5f88\u96be\u8dd1\u904d\u5168\u90e8\u7684 $A_i$ \u7684\u4e8c\u8fdb\u5236\u4e0a\u6709\u5565\uff0c~~\u4e3b\u8981\u662f\u51fa\u9898\u4eba\u6bcf\u7ec4\u6570\u636e\u90fd\u8fd9\u4e48\u5361\u6ca1\u610f\u601d~~\uff0c\u5728\u9884\u5904\u7406\u65f6\u4f1a\u6162\u5f88\u591a\uff0c\u4f46\u662f\u5728\u8be2\u95ee\u5f88\u5927\u65f6\u53ef\u80fd\u4f1a\u66f4\u5feb\u3002\n## Another Code\n```cpp\n//\u79c1\u4eba\u6240\u6709\uff0c\u7981\u6b62\u6284\u88ad\n//PS:log\u7684\u5199\u6cd5\n#include<bits/stdc++.h>\nusing namespace std;\ninline int read(){\n\tint num=0;\n\tchar ch=getchar();\n\twhile(!isdigit(ch))ch=getchar();\n\twhile(isdigit(ch))num=(num<<1)+(num<<3)+(ch&15),ch=getchar();\n\treturn num;\n}\ninline int Max(const int& x,const int& y){return x<y?y:x;}\nint a[100010],las[100010],nxt[100010],xorsum[100010],bit[40];\nvector<int>A[100010];\nint main(){\n\tint T=read()+1;\n\twhile(--T){\n\t\tint n=read(),Q=read()+1,syc=0;\n\t\t//syc\u4e3a\u4e0a\u4e00\u4e2a\u975e0\u7684\u6570\n\t\tfor(int i=1;i<=n;++i){\n\t\t\ta[i]=read();\n\t\t\txorsum[i]=xorsum[i-1]^a[i];\n\t\t\tif(a[i])las[i] = syc,nxt[syc] = i,syc = i;\n\t\t\telse las[i] = syc;\n\t\t\tA[i].clear();\n\t\t\t//\u4e3a\u4e86\u65b9\u4fbf\u8df3\uff0c\u8ba90\u5355\u5411\u5730\u52a0\u5165\u94fe\u8868\n\t\t}\n\t\tnxt[syc]=n+1;\n\t\tsyc=n+1;\n\t\tfor(int i=n;i>0;--i){\n\t\t\tif(a[i])syc=i;\n\t\t\telse nxt[i]=syc;\n\t\t}\n\t\t\n\t\t//\u9884\u5904\u7406\u6bcf\u4e2aA_i\u4e8c\u8fdb\u5236\u4e0a\u6709\u5565\n\t\tfor(int k=1,ch=1;k<=30;++k,ch<<=1){\n\t\t\tfor(int i=1;i<=n;++i){\n\t\t\t\tif(a[i]&ch) A[i].push_back(k);\n\t\t\t}\n\t\t}\n\t\twhile(--Q){\n\t\t\tint l=read(),r=read();\n\t\t\tif(l==r){\n\t\t\t\tprintf(\"%d %d\\n\",l,r);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t//\u8fd9\u91cc\u5b9e\u9645\u4e0a\u662f\u7279\u5224\u533a\u95f4\u5168\u4e3a0\u7684\u60c5\u51b5\n\t\t\tif(nxt[l]>r&&!a[l]){\n\t\t\t\tprintf(\"%d %d\\n\",l,l);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(!a[l])l=nxt[l];if(!a[r])r=las[r];\n\t\t\tint maxn=xorsum[r]^xorsum[l-1],prel=l,prer=r,ansl,ansr,now=maxn;\n\t\t\tfor(int i=1;i<=30;++i)bit[i]=l;\n\t\t\t//\u5148\u8dd1\u4e00\u904d\u6700\u8fdc\u8dd1\u591a\u8fdc\n\t\t\twhile(las[prer]>=l&&(now|a[prer])<=now){\n\t\t\t\tfor(int i=0;i<A[prer].size();++i){\n\t\t\t\t\tbit[A[prer][i]]=prer;\n\t\t\t\t}\n\t\t\t\tnow^=a[prer],prer=las[prer];\n\t\t\t}\n\t\t\tansl=l,ansr=prer;\n\t\t\tnow=maxn;\n\t\t\t//\u7ef4\u62a4\u5de6\u7aef\u70b9\uff0c\u5220\u53f3\u7aef\u70b9\n\t\t\tif(nxt[l]<=r&&(now|a[prel])==now){\n\t\t\t\tnow^=a[prel];\n\t\t\t\tfor(int i=0;i<A[prel].size();++i){\n\t\t\t\t\tprer=Max(prer,bit[A[prel][i]]);\n\t\t\t\t\t//\u53d6\u6700\u53f3\u8fb9\u7684\u8be5\u52a0\u5165\u533a\u95f4\u7684\u4f4d\u7f6e\n\t\t\t\t}\n\t\t\t\tprel=nxt[prel];\n\t\t\t\twhile(prel<=r){\n\t\t\t\t\tif(prer<=prel){\n\t\t\t\t\t\tansl=l,ansr=l;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(ansr-ansl>prer-prel)ansl=prel,ansr=prer;//\u5224\u65ad\u7b54\u6848\u662f\u5426\u66f4\u4f18\n\t\t\t\t\tif(nxt[prel]<=r&&(now|a[prel])==now){\n\t\t\t\t\t\tfor(int i=0;i<A[prel].size();++i){\n\t\t\t\t\t\t\tprer=Max(prer,bit[A[prel][i]]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tnow^=a[prel],prel=nxt[prel];\n\t\t\t\t\t}\n\t\t\t\t\telse break;\n\t\t\t\t}\n\t\t\t}\n\t\t\tprintf(\"%d %d\\n\",ansl,ansr);\n\t\t}\n\t}\n\treturn 0;\n}\n//(\u3002\u30fb\u2200\u30fb)\u30ce\n```\n",
        "postTime": 1666609390,
        "uid": 310439,
        "name": "\u661f\u661f\u4e0e\u8fb0",
        "ccfLevel": 0,
        "title": "CF1732C2\u9898\u89e3"
    }
]
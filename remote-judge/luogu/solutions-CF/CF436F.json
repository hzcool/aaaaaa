[
    {
        "content": "> [CF436F Banners](https://www.luogu.com.cn/problem/CF436F)\n\n\u8003\u8651\u56fa\u5b9a $c$\uff0c\u6c42\u4f7f\u5f97\u6536\u76ca\u6700\u5927\u7684 $p$\u3002\u56e0\u4e3a\u6bcf\u4e2a\u4eba\u6839\u636e\u5e7f\u544a\u6570\u91cf\u4f18\u5148\u9009\u62e9\u514d\u8d39\u7248\u672c\uff0c\u6240\u4ee5\u6b64\u65f6\u7528\u514d\u8d39\u7248\u672c\u7684\u4eba\u5df2\u7ecf\u786e\u5b9a\uff0c\u5373\u4f7f\u5f97 $b_i \\geq c$ \u7684 $i$ \u7684\u6570\u91cf\u3002\u5269\u4e0b\u6765 $b_i < c$ \u8981\u4e48\u7528\u4ed8\u8d39\u7248\u672c\uff0c\u8981\u4e48\u4e0d\u7528\uff0c\u5219\u95ee\u9898\u76f8\u5f53\u4e8e\u627e\u5230 $p$ \u6700\u5927\u5316 $p\\sum\\limits_{i = 1} ^ n [b_i < c \\land a_i < p]$\u3002\n\n\u5bf9\u4e8e $b_i < c$ \u7684\u9650\u5236\uff0c\u6211\u4eec\u6309 $c$ \u4ece\u5c0f\u5230\u5927\u626b\u63cf\u7ebf\uff0c\u6bcf\u6b21 $c$ \u589e\u5927\u4e3a $c + 1$ \u65f6\u52a0\u5165\u6240\u6709 $b_i = c$ \u7684 $i$\u3002\u53ea\u5269 $a_i < p$ \u7684\u9650\u5236\uff0c\u8003\u8651\u5b9e\u65f6\u7ef4\u62a4\u9009\u62e9\u6bcf\u4e2a $p$ \u7684\u6536\u76ca $v_p$\uff0c\u5219\u52a0\u5165 $(a_i, b_i)$ \u76f8\u5f53\u4e8e\u4e3a\u6240\u6709 $p\\in [0, a_i]$ \u7684 $v_p$ \u52a0\u4e0a $p$\u3002\n\n\u533a\u95f4\u52a0\u516c\u5dee\u4e3a $1$ \u7b49\u5dee\u6570\u5217\uff0c\u6574\u4f53\u6700\u5927\u503c\uff0c\u4e00\u770b\u5c31\u4e0d\u592a\u80fd\u7528 $\\log$ \u6570\u636e\u7ed3\u6784\u7ef4\u62a4\uff08\u53ef\u4ee5\u7528 KTT \u505a\u5230 $n\\log ^ 2 n$\uff09\u3002\u5b9e\u9645\u4e0a\u8fd9\u662f\u7ecf\u5178\u5206\u5757\u51f8\u5305\u95ee\u9898\u3002\u5177\u4f53\u5730\uff0c\u5c06 $v_p$ \u5206\u5757\uff0c\u5b9e\u65f6\u7ef4\u62a4\u6bcf\u5757 $v_l\\sim v_r$ \u7684\u51f8\u5305\u3002\u4fee\u6539\u65f6\u6563\u5757\u91cd\u6784\u4e0a\u51f8\u5305\uff0c\u6574\u5757\u6253\u6807\u8bb0\uff0c\u4fee\u6539\u5b8c\u6bd5\u540e\u67e5\u8be2 $v_p + laz\\times p$ \u7684\u6700\u5927\u503c\uff0c\u76f8\u5f53\u4e8e\u7528\u659c\u7387\u4e3a $-laz$ \u7684\u76f4\u7ebf\u622a\u51f8\u5305\u3002\u56e0\u4e3a $-laz$ \u5355\u8c03\u51cf\u5c0f\uff0c\u6240\u4ee5\u53ef\u53cc\u7aef\u961f\u5217\u7ef4\u62a4\uff0c\u4e0d\u65ad\u5f39\u51fa\u961f\u9996\u76f4\u5230\u51f8\u5305\u4ec5\u5269\u4e00\u4e2a\u70b9\u6216\u961f\u9996\u4e0e\u540e\u7ee7\u7684\u8fde\u7ebf\u659c\u7387\u5c0f\u4e8e $-laz$\u3002\u7c7b\u4f3c\u659c\u7387\u4f18\u5316\u7406\u89e3\u3002\n\n\u4e0a\u8ff0\u505a\u6cd5\u53ef\u4ee5\u652f\u6301\u6c42\u533a\u95f4\u6700\u503c\uff0c\u4f46\u4e0d\u5fc5\u8981\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n\\sqrt b)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi first\n#define se second\n#define TIME 1e3 * clock() / CLOCKS_PER_SEC\nusing ll = long long;\nusing pii = pair<int, int>;\nusing pll = pair<ll, ll>;\nusing ull = unsigned long long;\ninline ll read() {\n  ll x = 0, sgn = 0;\n  char s = getchar();\n  while(!isdigit(s)) sgn |= s == '-', s = getchar();\n  while(isdigit(s)) x = x * 10 + s - '0', s = getchar();\n  return sgn ? -x : x;\n}\ninline void print(int x) {\n  if(x < 0) return putchar('-'), print(-x);\n  if(x >= 10) print(x / 10);\n  putchar(x % 10 + '0');\n}\nbool Mbe;\nconstexpr int N = 1e5 + 5;\nconstexpr int B = 320;\nint n, w, blk[N];\nvector<int> buc[N];\nstruct blocker {\n  int dt, hd, tl, d[B];\n  ll a[B], laz;\n  ll cross(int i, int j, int k) {return (j - i) * (a[k] - a[j]) - (k - j) * (a[j] - a[i]);}\n  void rebuild() {\n    hd = 0, tl = -1;\n    for(int i = 0; i < B; i++) {\n      while(hd < tl && cross(d[tl - 1], d[tl], i) >= 0) tl--;\n      d[++tl] = i;\n    }\n  }\n  pll modify(int sz) {\n    if(sz == B) laz++;\n    else {\n      for(int i = 0; i < sz; i++) a[i] += dt + i;\n      for(int i = 0; i < B; i++) a[i] += laz * (dt + i);\n      laz = 0, rebuild();\n    }\n    while(hd < tl && a[d[hd]] + laz * d[hd] <= a[d[hd + 1]] + laz * d[hd + 1]) hd++;\n    return {a[d[hd]] + laz * (d[hd] + dt), d[hd] + dt};\n  }\n} b[B];\nbool Med;\nint main() {\n  fprintf(stderr, \"%.3lf MB\\n\", (&Mbe - &Med) / 1048576.0);\n  #ifdef ALEX_WEI\n    FILE* IN = freopen(\"1.in\", \"r\", stdin);\n    FILE* OUT = freopen(\"1.out\", \"w\", stdout);\n  #endif\n  cin >> n >> w;\n  for(int i = 0; i < N; i++) blk[i] = i / B;\n  for(int i = 0; i < B; i++) b[i].d[0] = B - 1, b[i].dt = i * B;\n  int num = n, mxb = 0;\n  for(int i = 1, a, b; i <= n; i++) {\n    a = read(), b = read();\n    mxb = max(mxb, b);\n    buc[b].push_back(a);\n  }\n  pll ans = {0, 0};\n  for(int i = 0; i <= mxb + 1; i++) {\n    cout << ans.first + 1ll * num * i * w << \" \" << ans.second << \"\\n\";\n    for(int it : buc[i]) {\n      int c = blk[it];\n      for(int i = 0; i < c; i++) ans = max(ans, b[i].modify(B));\n      ans = max(ans, b[c].modify(it - c * B + 1)), num--;\n    }\n  }\n  cerr << TIME << \" ms\\n\";\n  return 0;\n}\n/*\n2022/9/17\nauthor: Alex_Wei\nstart coding at 12:24\nfinish debugging at 13:45\n*/\n```",
        "postTime": 1663395606,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "CF436F Banners"
    },
    {
        "content": "\u597d\u4e45\u6ca1\u5199\u9898\u89e3\u4e86QAQ  \n\u4eca\u5929\u4e0a\u5348\u521a\u521a\u8003\u5b8c\u671f\u672b\uff0c\u5199\u4e00\u7bc7\u8fc7\u8fc7\u763eqwq\n- - - \n\u95ee\u9898\u7b80\u8ff0\uff1a  \n\u4f60\u8981\u5f00\u53d1\u4e00\u4e2aAPP\uff0c\u6709\u4ed8\u8d39\u548c\u514d\u8d39\u4e24\u4e2a\u7248\u672c\u3002\u4ed8\u8d39\u7248\u4ef7\u683c\u4e3a$p$\uff0c\u514d\u8d39\u7248\u5219\u5fc5\u987b\u770b$c$\u4e2a\u5e7f\u544a\u3002\u4f60\u6709$N$\u4e2a\u7528\u6237\uff0c\u6bcf\u4e2a\u7528\u6237\u6709\u4e24\u4e2a\u5c5e\u6027$a$\u548c$b$\u3002\u4ed6\u4eec\u4f1a\u6309\u7167\u5982\u4e0b\u89c4\u5219\u4f7f\u7528\u4f60\u7684APP\uff1a\n\n- \u82e5$b \\geq c$\uff0c\u7528\u6237\u4f1a\u4f7f\u7528\u514d\u8d39\u7248\n- \u5426\u5219\u82e5$a \\geq p$\uff0c\u7528\u6237\u4f1a\u4f7f\u7528\u4ed8\u8d39\u7248\n- \u5426\u5219\u7528\u6237\u4e0d\u4f1a\u4f7f\u7528\u4f60\u7684APP  \n\n\u5bf9\u4e8e\u6bcf\u4e2a\u4f7f\u7528\u4e86\u4ed8\u8d39\u7248APP\u7684\u7528\u6237\uff0c\u4f60\u5c06\u83b7\u5229$p$\u3002\u5bf9\u4e8e\u6bcf\u4e2a\u4f7f\u7528\u4e86\u514d\u8d39\u7248\u7684\u7528\u6237\uff0c\u4f60\u5c06\u83b7\u5229$cw$\uff0c$w$\u662f\u4e00\u4e2a\u5e38\u6570\u3002  \n\u5bf9\u4e8e$[0,\\text{max}\\:b_i+1]$\u4e2d\u7684\u6bcf\u4e2a$c$\u7684\u53d6\u503c\uff0c\u4f60\u9700\u8981\u627e\u5230\u4e00\u4e2a$p$\uff0c\u4f7f\u5f97\u83b7\u5229\u6700\u5927\u3002  \n- - - \ntutorial:  \n\u6211\u4eec\u8003\u8651\u679a\u4e3e$c$\uff0c\u540c\u65f6\u7528\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u7ef4\u62a4$p$\u7684\u6bcf\u4e00\u4e2a\u53d6\u503c\u5bf9\u5e94\u7684\u4ed8\u8d39\u7248\u7684\u603b\u6536\u76ca\u3002  \n\u663e\u7136\uff0c\u6211\u4eec\u9700\u8981\u628a\u7528\u6237\u6309\u7167$b$\u503c\u6392\u5e8f\u3002\u968f\u7740$c$\u5355\u8c03\u9012\u589e\uff0c\u4f1a\u6709\u8d8a\u6765\u8d8a\u591a\u7684\u7528\u6237\u653e\u5f03\u514d\u8d39\u7248\uff0c\u6211\u4eec\u53ea\u9700\u8981\u628a\u7528\u6237\u4e00\u4e2a\u4e2a\u52a0\u5165\u6570\u636e\u7ed3\u6784\u5373\u53ef\u3002  \n\u8bbe$p$\u53d6\u503c\u4e3a$i$\u65f6\uff0c\u4ed8\u8d39\u7248\u7684\u603b\u6536\u76ca\u4e3a$P_i$\u3002\u6211\u4eec\u53d1\u73b0\uff0c\u52a0\u5165\u7b2c$j$\u4e2a\u7528\u6237\u4f1a\u5bfc\u81f4$[0,a_j]$\u4e2d\u7684$P$\u53d1\u751f\u6539\u53d8\uff0c\u5176\u4e2d$P_i$\u589e\u52a0$i$\u3002  \n\u4e8e\u662f\u95ee\u9898\u53d8\u6210\u4e86\uff1a\u533a\u95f4\u52a0\u8fde\u7eed\u81ea\u7136\u6570\uff0c\u7ef4\u62a4\u6700\u5927\u503c\u3002\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u4f7f\u7528\u5206\u5757\u51f8\u5305\u6765\u89e3\u51b3\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$\\text{O}(n\\sqrt{n})$\u3002  \n\n- - -\n\u4ee3\u7801\uff1a  \n```\n#include <cstdlib>\n#include <iostream>\n#include <cstdio>\n#include <math.h>\n#include <cstring>\n#include <time.h>\n#include <complex>\n#include <algorithm>\n#include <queue>\n#include <stack>\n#include <set>\n#include <map>\n#include <bitset>\n\n#pragma warning(disable:4996)\n\ntemplate<typename T> T min(T x, T y)\n{\n    return x < y ? x : y;\n}\ntemplate<typename T> T max(T x, T y)\n{\n    return x > y ? x : y;\n}\n\nconst long long MAXN = 100005;\nconst long long B = 500;\n\nstruct line{\n\tdouble k;\n\tdouble b;\n\tline(double K = 0, double B = 0)\n\t{\n\t\tk = K;\n\t\tb = B;\n\t}\n\tdouble calc(double x)\n\t{\n\t\treturn k*x + b;\n\t}\n};\ndouble cross(line x, line y)\n{\n\treturn (y.b - x.b) / (x.k - y.k);\n}\n\nstruct hull{\n\tstd::vector<line> L;\n\tstd::vector<line> Q;\n\tlong long add, cur;\n\t\n\tvoid build()\n\t{\n\t\tQ.clear();\n\t\tQ.push_back(L[0]);\n\t\tfor(long long i = 1; i < L.size(); i++)\n\t\t{\n\t\t\tline t = L[i];\n\t\t\twhile(Q.size() >= 2 && cross(t, Q[Q.size() - 2]) < cross(Q[Q.size() - 1], Q[Q.size() - 2]))\n\t\t\t\tQ.pop_back();\n\t\t\tQ.push_back(t);\n\t\t}\n\t\tadd = cur = 0;\n\t\twhile(cur + 1 < Q.size() && Q[cur + 1].calc(add) > Q[cur].calc(add))\n\t\t\tcur++;\n\t}\n\tvoid ADD(long long x)\n\t{\n\t\tadd += x;\n\t\twhile(cur + 1 < Q.size() && Q[cur + 1].calc(add) > Q[cur].calc(add))\n\t\t\tcur++;\n\t}\n\tvoid update(long long l, long long r, long long x)\n\t{\n\t\tfor(long long i = 0; i < L.size(); i++)\n\t\t\tL[i].b += add*L[i].k + (i >= l && i <= r) * x * L[i].k;\n\t\tbuild();\n\t}\n\tstd::pair<double, double> maximum()\n\t{\n\t\treturn std::make_pair(Q[cur].calc(add), Q[cur].k);\n\t}\n};\n\nstruct user{\n\tlong long a;\n\tlong long b;\n\tbool operator < (user x) const\n\t{\n\t\treturn b < x.b;\n\t}\n};\n\nlong long N, W;\nuser u[MAXN];\nlong long mxa, mxb;\nlong long l[MAXN], r[MAXN], tot;\nhull H[B];\n\nvoid operate(long long L, long long R)\n{\n\tfor(long long i = 1; i <= tot; i++)\n\t{\n\t\tif(l[i] >= L && r[i] <= R)\n\t\t\tH[i].ADD(1);\n\t\telse if(L >= l[i] && R <= r[i])\n\t\t\tH[i].update(L - l[i], R - l[i], 1);\n\t\telse if(L >= l[i] && L <= r[i] || R >= l[i] && R <= r[i])\n\t\t\tH[i].update(max(L, l[i]) - l[i], min(R, r[i]) - l[i], 1);\n\t}\n}\nstd::pair<double, double> query()\n{\n\tstd::pair<double, double> t(0, 0);\n\tfor(long long i = 1; i <= tot; i++)\n\t\tt = std::max(t, H[i].maximum());\n\treturn t;\n}\n\nvoid init()\n{\n\tscanf(\"%I64d %I64d\", &N, &W);\n\tfor(long long i = 1; i <= N; i++)\n\t{\n\t\tscanf(\"%I64d %I64d\", &u[i].a, &u[i].b);\n\t\tmxa = max(mxa, u[i].a);\n\t\tmxb = max(mxb, u[i].b);\n\t}\n\tstd::sort(u + 1, u + N + 1);\n\t\n\tfor(long long x = 0, y; x <= mxa; x = y + 1)\n\t{\n\t\ty = min(x + B - 1, mxa);\n\t\ttot++;\n\t\tl[tot] = x, r[tot] = y;\n\t}\n\tfor(long long i = 1; i <= tot; i++)\n\t{\n\t\tfor(long long j = l[i]; j <= r[i]; j++)\n\t\t\tH[i].L.push_back(line(j, 0));\n\t\tH[i].build();\n\t}\n}\n\nvoid solve()\n{\n\tlong long cur = 1;\n\tfor(long long i = 0; i <= mxb + 1; i++)\n\t{\n\t\twhile(cur <= N && u[cur].b < i)\n\t\t\toperate(0, u[cur].a), cur++;\n\t\tstd::pair<double, double> t = query();\n\t\tprintf(\"%I64d %I64d\\n\", (N - cur + 1)*W*i + (long long)t.first, (long long)t.second);\n\t}\n}\n\nint main()\n{\n\tinit();\n\tsolve();\n\t\n\treturn 0;\n}\n```",
        "postTime": 1562229674,
        "uid": 64366,
        "name": "ddwqwq",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF436F \u3010Banners\u3011"
    },
    {
        "content": "\u8fd9\u9898\u7b2c\u4e00\u6b65\u5e94\u8be5\u5f88\u597d\u60f3\uff0c\u5bf9\u4e8e $b_i$ \u6392\u4e2a\u5e8f\uff0c\u7136\u540e\u4e00\u4e2a\u4e00\u4e2a\u52a0\u4eba\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u5e76\u7ef4\u62a4\u6700\u5927\u8d21\u732e\u3002\n\n~~\u7136\u540e\u4f60\u4f1a\u53d1\u73b0\uff0c\u4f60\u9996\u5148\u60f3\u6743\u503c\u7ebf\u6bb5\u6811\uff0c\u7136\u540e\u53d1\u73b0\u4e0d\u884c\uff0c\u7136\u540e\u60f3\u5e73\u8861\u6811\uff0c\u7136\u540e\u53c8\u53d1\u73b0\u4e0d\u884c\uff08\u6211\u8fd8\u60f3\u4e86\u4e00\u4e2a\u5e73\u8861\u6811\u7684\u4f46\u662f\u5047\u7684\u5f88\u60e8\uff09\u7136\u540e\u4f60\u60f3\u5c1d\u8bd5\u6811\u5957\u6811\u53d1\u73b0\u4e0d\u80fd\u533a\u95f4\u4fee\u6539\uff0c\u7136\u540e\u4f60\u81ea\u95ed\u4e86\u3002~~\n\n\u8fd9\u9898\u6211\u4eec\u8981\u7528\u5206\u5757\u5e76\u7ef4\u62a4\u51f8\u5305\u3002\n\n\u5176\u5b9e\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u7684\u96be\u70b9\u5176\u5b9e\u662f\u6c42\u4ed8\u8d39\u7248\u7684\u8d21\u732e\uff0c\u6211\u4eec\u8003\u8651 $p$ \u4e3a\u4ed8\u8d39\u7248\u7684\u5b9a\u4ef7\uff0c$c$ \u4e3a\u5f53\u524d\u679a\u4e3e\u5230\u7684\u514d\u8d39\u7248\u5e7f\u544a\u6761\u6570\uff0c\u90a3\u4e48\u5b9e\u9645\u4e0a\u4ed8\u8d39\u7248\u7684\u8d21\u732e\u662f\uff1a\n\n$$p\\times \\sum_{i=1}^n [b_i<c][p\\leq a_i]$$\n\n\u7136\u540e\u6211\u4eec\u5b9a\u4e49\u4e00\u4e2a $A_i$ \u8868\u793a\u5982\u679c\u5b9a\u4ef7\u8bbe\u4e3a $a_i$\uff08\u5176\u5b9e\u5c31\u662f\u79bb\u6563\u5316\u4e4b\u540e\u7684 $i$\uff09\uff0c\u6709\u51e0\u4e2a\u4eba\u4f1a\u9009\u62e9\u8fd9\u4e2a\u4ed8\u8d39\u7248\u3002\n\n\u90a3\u4e48\u4ed8\u8d39\u7248\u7684\u8d21\u732e\u5c31\u662f\uff1a\n\n$$\\max_{i=1}^n (A_i\\times i)$$\n\n\u6240\u4ee5\u6211\u4eec\u5982\u679c\u8981\u66b4\u529b\u7ef4\u62a4 $A_i$\uff08\u4e5f\u5c31\u662f\u6bcf\u4e00\u6b21\u5982\u679c\u8981\u52a0\u4eba\u4e00\u4e2a $a_i$\uff0c\u5c31\u628a $A_1,A_2...A_{a_i}$ \u90fd\u52a0\u4e0a $1$\uff09\u3002\u603b\u590d\u6742\u5ea6\u662f $n^2$ \u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u5206\u5757\u3002\n\n\u6211\u4eec\u4ec5\u8003\u8651 $1$ \u4e2a\u5757\uff0c\u56e0\u4e3a\u5176\u4ed6\u7684\u90fd\u662f\u4e00\u6837\u7684\u3002\n\n\u8bbe\u8fd9\u4e2a\u5757\u603b\u4f53\u88ab\u52a0\u4e86 $k$ \u6b21\uff0c\u5e76\u4e14\u8fd9\u4e2a\u5757\u4e2d\u7b2c $i$ \u4e2a\u5143\u7d20\u81ea\u5df1\u7684\u8d21\u732e\u662f $d_i$\uff08\u4e5f\u5c31\u662f\u6bcf\u4e00\u6b21\u904d\u5386\u5230 $i$ \u5143\u7d20\u65f6\uff0c\u5c31\u628a $d_i$ \u52a0\u4e0a\u4e00\u4e2a $i$\uff09\u3002\n\n\u7136\u540e\u5728\u4e00\u4e2a\u5757\u4e2d\uff0c\u5982\u679c\u51b3\u7b56\u70b9\u662f\u7b2c $i$ \u4e2a\u5143\u7d20\u6bd4\u662f\u7b2c $j$ \u4e2a\u70b9\u8981\u4f18\u79c0\uff0c\u90a3\u5fc5\u987b\u6ee1\u8db3\uff1a\n\n$$d_i+k\\times i<d_j+k\\times j$$\n\n\u79fb\u9879\u53ef\u5f97\n\n$$d_i-d_j<k\\times (j-i)$$\n\n$$\\frac{d_i-d_j}{j-i}<k$$\n\n\u7528\u51f8\u5305\u7ef4\u62a4\u8fd9\u4e2a\u67ff\u5b50\u5373\u53ef\u3002\n\n\u7531\u4e8e $k$ \u662f\u5355\u8c03\u4e0d\u964d\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u9700\u8981\u4e8c\u5206\uff0c\u53ea\u9700\u8981\u961f\u9996\u5373\u53ef\u3002\n\n\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#include<queue>\n#include<iostream>\n#define int long long \nusing namespace std;\nconst int NR=1e5+10;\nconst int MR=505;\nvoid Max(int &x,int y){x=max(x,y);}\nvoid Min(int &x,int y){x=min(x,y);}\nint n,m,w,mx,all,kc;\nstruct Fk{int l,r,k;}p[MR];\nstruct Nd{int a,b;bool operator<(const Nd& A)const{return b<A.b;}}t[NR];\nint cal(int x,int pos){return x*(n-pos+1);}\nint d[NR];\nint cnt[NR];\nint q[MR][MR];\nint L[MR],R[MR];\ndouble slope(int id1,int id2){return 1.*(d[id1]-d[id2])*1./(id2-id1);}\nvoid doit(int id,int x){while(L[id]<R[id]&&slope(q[id][L[id]],q[id][L[id]+1])<=x)L[id]++;}\nvoid rebuild(int id)\n{\n\tL[id]=1,R[id]=0;\n\tfor(int i=p[id].l;i<=p[id].r;i++)\n\t{\n\t\twhile(L[id]<R[id]&&slope(q[id][R[id]],i)<slope(q[id][R[id]-1],q[id][R[id]]))\n\t\t\tR[id]--;\n\t\tq[id][++R[id]]=i;\n\t}\n\tdoit(id,0); \n}\nint Num(int x){return (x-1)/kc+1;}\nvoid add(int x)\n{\n\tif(x<=0)return;int len=Num(x);\n\tfor(int i=1;i<len;i++)doit(i,++cnt[i]);\n\tfor(int i=p[len].l;i<=p[len].r;i++)d[i]+=cnt[len]*i;\n\tfor(int i=p[len].l;i<=x;i++)d[i]+=i;cnt[len]=0;rebuild(len);\n}\nint read()\n{\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+(ch^48);ch=getchar();}\n\treturn x*f;\n}\nsigned main()\n{\n//\tfreopen(\".in\",\"r\",stdin);\n//\tfreopen(\"1.out\",\"w\",stdout);\n\tn=read(),w=read();\n\tfor(int i=1;i<=n;i++)t[i].a=read(),t[i].b=read(),Max(mx,t[i].b),Max(all,t[i].a);\n\tsort(t+1,t+n+1);kc=sqrt(all);int now=1;\n\tfor(int i=1;i<=all;i+=kc)p[++m].l=i,p[m].r=min(all,i+kc-1),p[m].k=0;\n\tfor(int c=0;c<=mx+1;c++)\n\t{\n\t\twhile(t[now].b<c&&now<=n)add(t[now].a),now++;\n\t\tint ans=-1,pos=0;\n\t\tfor(int i=1;i<=m;i++)\n\t\t{\n\t\t\tint x=q[i][L[i]];\n\t\t\tif(d[x]+x*cnt[i]>=ans)ans=d[x]+x*cnt[i],pos=x;\n\t\t}\n\t\tprintf(\"%lld %lld\\n\",ans+w*c*(n-now+1),pos);\n\t}\n\treturn 0;\n}\n\n\n\n\n\n\n\n",
        "postTime": 1610705665,
        "uid": 97136,
        "name": "chenzida",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF436F \u3010Banners\u3011"
    },
    {
        "content": "#### CF436F Banners\n\n\u6570\u636e\u7ed3\u6784\u795e\u9898\u3002\n\n\u8003\u8651\u5148\u5bf9\u6bcf\u4e2a\u4eba\u6309\u5176\u53ef\u4ee5\u5fcd\u53d7\u7684\u5e7f\u544a\u6570\u91cf\u6392\u5e8f\uff0c\u90a3\u4e48\u53ef\u4ee5\u65b9\u4fbf\u5730\u6c42\u51fa\u5e7f\u544a\u7684\u6536\u5165\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u7ef4\u62a4\u4ed8\u8d39\u7684\u6536\u5165\u3002\n\n\u8003\u8651\u8bbe$A_i$\u8868\u793a\u5f53\u524d\u7684\u5e7f\u544a\u6570\u91cf\uff0c\u5982\u679c\u5b9a\u4ef7\u4e3a$i$\uff0c\u5c06\u4f1a\u6709\u591a\u5c11\u4eba\u4ed8\u8d39\uff0c\u90a3\u4e48\u7b54\u6848\u5373\u4e3a$\\max_{i\\leq MAXN}{a[i]\\times i}$\n\n\u90a3\u8003\u8651\u52a0\u5e7f\u544a\u7684\u8fc7\u7a0b\uff0c\u5b9e\u9645\u4e0a\u8d2d\u4e70\u514d\u8d39\u7248\u672c\u7684\u4eba\u6570\u662f\u5355\u8c03\u4e0d\u589e\u7684\uff0c\u4e70\u4ed8\u8d39\u7684\u4eba\u6570\u662f\u4f1a\u5355\u8c03\u4e0d\u51cf\u7684\u3002\n\n\u56e0\u6b64\u8003\u8651\u65b0\u52a0\u8fdb\u6765\u4e00\u4e2a\u4eba\uff0c\u4ed6\u6700\u5927\u80fd\u5fcd\u53d7\u5230\u7684\u8d39\u7528\u662f$p$\uff0c\u90a3\u4e48\u5b9e\u9645\u4e0a\u6211\u4eec\u8981\u652f\u6301\u524d\u7f00\u6bcf\u4e2a\u6570$+1$\uff0c\u56e0\u4e3a\u4ece$1\\to p$\uff0c\u6bcf\u4e2a\u8d39\u7528\u8d2d\u4e70\u4eba\u6570\u90fd\u4f1a\u52a0$1$\u3002\n\n\u800c\u8fd9\u4e2a\u4e1c\u897f\u7528\u7ebf\u6bb5\u6811\u3001\u5e73\u8861\u6811\u7b49$\\log$\u7ea7\u6570\u636e\u7ed3\u6784\u662f\u65e0\u6cd5\u7ef4\u62a4\u7684\u3002\n\n\u8003\u8651\u5206\u5757\uff0c\u5bf9\u4e8e\u6574\u5757\u7684\uff0c\u8bb0\u5f55\u5176\u6807\u8bb0$k$\uff0c\u5bf9\u4e8e\u6563\u70b9\uff0c\u6211\u4eec\u5bf9\u6bcf\u4e2a\u4f4d\u7f6e\u7ef4\u62a4\u4e00\u4e2a\u503c$d_i$\uff0c\u8868\u793a$i$\u5355\u72ec\u7684\u8d21\u732e\u3002\n\n\u90a3\u4e48\u8003\u8651\u540c\u4e00\u4e2a\u5757\u7684\u6700\u4f18\u503c\uff0c\u8003\u8651\u8fd9\u4e2a\u5757\u91cc\u4e24\u4e2a\u4f4d\u7f6e$i,j(i<j)$,\u5b9e\u9645\u4e0a\u6211\u4eec\u9700\u8981\u6bd4\u8f83\u7684\u662f$d_i+k\\times i$\u548c$d_j+k\\times j$\u3002\u800c\u8fd9\u4e2a\u4e1c\u897f\u7ecf\u8fc7\u6574\u7406\u3001\u79fb\u9879\uff0c\u5b83\u662f\u7b49\u4ef7\u4e8e\u6bd4\u8f83$\\frac{d_i-d_j}{j-i}$\u548c$k$\u7684\u5927\u5c0f\uff0c\u800c\u5de6\u8fb9\u8fd9\u4e2a\u5f0f\u5b50\u53ef\u4ee5\u8054\u60f3\u5230\u662f\u4ee5$(i,d_i)$\u548c$(j,d_j)$\u4e4b\u95f4\u7684\u4e00\u6b21\u51fd\u6570\u7684\u659c\u7387\u7684\u76f8\u53cd\u6570\uff0c\u56e0\u6b64\u53ef\u4ee5\u7528\u51f8\u5305\u7ef4\u62a4\u3002\n\n\u800c\u6211\u4eec\u53ef\u4ee5\u5bf9\u4e8e\u6bcf\u4e2a\u5757\u7ef4\u62a4\u4e00\u4e2a\u51f8\u5305\uff0c\u6ce8\u610f\u5230\u5bf9\u4e8e\u6563\u70b9\u52a0\u8d21\u732e\u4e4b\u540e\u5c31\u4e0d\u6ee1\u8db3\u51f8\u5305\u6027\u8d28\u4e86\uff0c\u4f46\u7531\u4e8e\u5757\u4e0e\u5757\u4e4b\u95f4\u662f\u76f8\u4e92\u72ec\u7acb\u7684\uff0c\u800c\u4e00\u4e2a\u5757\u7684\u5927\u5c0f\u662f$\\sqrt n$\u7ea7\u522b\u7684\uff0c\u56e0\u6b64\u8003\u8651\u5bf9\u6563\u70b9\u6240\u5728\u7684\u5757\u91cd\u6784\u51f8\u5305\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6$n\\sqrt n$\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<cmath>\n#include<algorithm>\n#define N 1000005\n#define int long long\n#define MAXN 100010ll\nusing namespace std;\nint read()\n{\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+(ch^48);ch=getchar();}\n\treturn x*f;\n}\nstruct node{int a,b;}p[N];\nint cmpp(node a,node b)\n{\n\treturn a.b<b.b;\n}\nint n,w,blo,siz[N],col[N],sum,head[N],tail[N],d[N],q[405][405],cnt[N];\ndouble slope(int a,int b)\n{\n\treturn double(1.0*((double)d[a]-d[b])/(b-a));\n\t//(d[a]-d[b])/1.0*(b-a);\n}\nint cmp(int a,int b,int c)\n{\n\treturn (slope(a,b)>=slope(b,c));\n}\nvoid calc(int x)\n{\n\twhile(head[x]<tail[x]&&slope(q[x][head[x]],q[x][head[x]+1])<=cnt[x])++head[x];\n}\nvoid rebuild(int x)\n{\n\thead[x]=1;tail[x]=0;int l=(x-1)*blo+1,r=min(MAXN,blo*x);\n\tfor(int i=l;i<=r;i++)\n\t{\n\t\twhile(head[x]<tail[x]&&cmp(q[x][tail[x]-1],q[x][tail[x]],i))--tail[x];\n\t\tq[x][++tail[x]]=i;\n\t}\n\tcnt[x]=0;\n\tcalc(x);\n}\nvoid insert(int x)\n{\n\tif(!x)return;\n\tfor(int i=1;i<col[x];i++)cnt[i]++,calc(i);\n\tint l=(col[x]-1)*blo+1,r=min(MAXN,col[x]*blo);\n\tfor(int i=l;i<=r;i++)d[i]+=cnt[col[x]]*i;\n\tfor(int i=l;i<=x;i++)d[i]+=i;\n\tcnt[col[x]]=0;\n\trebuild(col[x]);\n}\nsigned main()\t\t\n{\n\tn=read();w=read();\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tp[i].a=read();\n\t\tp[i].b=read();\n\t}\n\tsort(p+1,p+1+n,cmpp);\n\tblo=sqrt(MAXN);\n\tint pos=1;\n\tfor(int i=1;i<=MAXN;i++)col[i]=(i-1)/blo+1;\n\tsum=col[MAXN];\n\tfor(int i=1;i<=sum;i++)rebuild(i);\n\tfor(int c=0;c<=p[n].b+1;c++)\n\t{\n\t\twhile(pos<=n&&p[pos].b<c)insert(p[pos].a),++pos;\n\t\tint ans1=0,ans2=MAXN+1;\n\t\tfor(int i=1;i<=sum;i++)\n\t\t{\n\t\t\tint x=q[i][head[i]];\n\t\t\tif(d[x]+cnt[i]*x*1ll>ans1)ans1=d[x]+cnt[i]*x*1ll,ans2=x;\n\t\t\t//cout<<c<<\" \"<<i<<\" \"<<x<<\" \"<<d[x]+cnt[i]*x<<endl;\n\t\t}\n\t\tprintf(\"%lld %lld\\n\",ans1+1ll*w*c*(n-pos+1),ans2);\n\t}\n}\n```\n\n",
        "postTime": 1610704934,
        "uid": 179600,
        "name": "shao0320",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF436F \u3010Banners\u3011"
    }
]
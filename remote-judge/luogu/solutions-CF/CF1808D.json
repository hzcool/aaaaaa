[
    {
        "content": "\u6211\u4eec\u8003\u8651\u8ba1\u7b97\u6709\u51e0\u4e2a\u4e8c\u5143\u7ec4 $(i,j)$ \u5bf9\u7b54\u6848\u6709\u8d21\u732e $(1\\leq i< j\\leq n)$\u3002\n\n\u7531\u4e8e $k$ \u4e3a\u5947\u6570\uff0c\u6240\u4ee5 $i,j$ \u7684\u5947\u5076\u6027\u76f8\u540c\u3002\n\n\u7531\u4e8e\u533a\u95f4\u957f\u5ea6\u4e3a $k$ \u4e14 $i\\not=j$\uff0c\u5f97\u5230\uff1a $i+2\\leq j\\leq i+k-1$\n\n\u7531\u4e8e $(i,j)$ \u5bf9\u5e94\u7684\u56de\u6587\u533a\u95f4\u4e0d\u80fd\u8d85\u51fa\u8fb9\u754c\uff0c\u5f0f\u5b50\u7528\u56de\u6587\u533a\u95f4\u4e2d\u5fc3\u70b9\u7684\u8303\u56f4\u6765\u5199\uff1a\n\n$\\dfrac{k+1}{2}\\leq \\dfrac{i+j}{2}\\leq n-\\dfrac{k-1}{2}$\n\n\u5316\u7b80\u5f97\uff1a $k-i+1\\leq j\\leq2n+1-k-i$\n\n\u6240\u4ee5\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e2a $i$\uff0c\u8981\u8ba1\u7b97\u7684 $j$ \u7684\u533a\u95f4\u4e3a\uff1a\n\n$[\\max\\{i+2,k-i+1\\},\\min\\{n,i+k-1,2n+1-k-i\\}]$\n\n\u8fd8\u6709 $i,j$ \u7684\u5947\u5076\u6027\u76f8\u540c\uff0c $a_i\\not=a_j$ \u7684\u9650\u5236\u3002\n\n\u91c7\u7528\u7c7b\u4f3c\u83ab\u961f\u7684\u8ba1\u7b97\u65b9\u5f0f\uff0c\u53ef\u4ee5\u53d1\u73b0\uff0c$l$ \u6307\u9488\u5148\u51cf\u5c0f\u4e00\u6bb5\u4e4b\u540e\u589e\u5927\uff0c$r$ \u6307\u9488\u5148\u589e\u5927\u4e00\u6bb5\u4e4b\u540e\u51cf\u5c0f\u3002\n\n\u6240\u4ee5\u603b\u79fb\u52a8\u6b21\u6570\u662f $O(n)$ \u7ea7\u522b\u7684\uff0c\u6545\u65f6\u7a7a\u590d\u6742\u5ea6\u4e3a $O(n)$\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int MAXN=200005;\ninline int read() {\n\tstatic int x=0,c=getchar(),f=1;\n\tfor(f=1; c<=47||c>=58; c=getchar())f=f&&c^45;\n\tfor(x=0; c>=48&&c<=57; c=getchar())x=(x<<3)+(x<<1)+(c&15);\n\treturn f?x:-x;\n} \nint n,k,a[MAXN],cnt[MAXN],l,r;\ninline int calc(int L,int R,int x) {\n\tif((L&1)!=(x&1)) ++L;\n\tif((R&1)!=(x&1)) --R;\n\tif(L>R)return 0;\n\twhile(l>L) --l,cnt[a[l]]+=(l&1)==(x&1);\n\twhile(r<R) ++r,cnt[a[r]]+=(r&1)==(x&1);\n\twhile(l<L) cnt[a[l]]-=(l&1)==(x&1),++l;\n\twhile(r>R) cnt[a[r]]-=(r&1)==(x&1),--r;\n\treturn (R-L+2)/2-cnt[a[x]];\n}\nint main() {\n\tn=read(),k=read(),l=1,r=0;\n\tfor(int i=1; i<=n; ++i) a[i]=read();\n\tll ans=0;\n\tfor(int i=1; i<=n; i+=2)\n\t\tans+=calc(max(i+2,k-i+1),min(n,min(i+k-1,n+n-k+1-i)),i);\n\tmemset(cnt,0,sizeof(cnt));\n\tl=1,r=0;\n\tfor(int i=2; i<=n; i+=2)\n\t\tans+=calc(max(i+2,k-i+1),min(n,min(i+k-1,n+n-k+1-i)),i);\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1680421191,
        "uid": 279646,
        "name": "mod998244353",
        "ccfLevel": 7,
        "title": "CF1808D \u9898\u89e3"
    },
    {
        "content": "## \u5206\u6790\n\n\u6b64\u9898\u6700\u91cd\u8981\u7684\u6027\u8d28\u662f\u5728\u4e8e $k$ \u7684\u8303\u56f4\uff1a**\u4fdd\u8bc1\u662f\u5947\u6570**\u3002$k$ \u662f\u5947\u6570\uff0c\u90a3\u4e48\u6240\u6709\u957f\u5ea6\u4e3a $k$ \u7684\u533a\u95f4\u5f53\u4e2d\u7684\u6240\n\u6709\u5143\u7d20\uff0c\u8f74\u5bf9\u79f0\u7684\u4f4d\u7f6e\u4e0e\u5176\u672c\u8eab\u7684\u4f4d\u7f6e **\u5947\u5076\u6027\u4fdd\u6301\u4e00\u81f4**\u3002\u56e0\u4e3a\u5047\u8bbe\u5bf9\u79f0\u8f74\u5750\u6807\u662f\u6574\u6570 $m$\uff0c\u90a3\u4e48\u5bf9\u79f0\u8f74\u5de6\u4fa7\u4f4d\u7f6e\u4e3a $m-i$ \u7684\u5143\u7d20\uff0c\u5bf9\u79f0\u4e4b\u540e\u5c31\u5230\u4e86 $m+i$ \u7684\u4f4d\u7f6e\uff0c\u800c $(m+i) - (m-i) = 2i$ \u662f\u5076\u6570\u3002\n\n\u5bf9\u4e8e\u6b64\u7c7b\u8ba1\u6570\u95ee\u9898\uff0c\u53ef\u4ee5\u4ece\u5de6\u5230\u53f3\uff0c\u4f9d\u6b21\u626b\u63cf\u6bcf\u4e2a\u5143\u7d20\uff0c\u8ba1\u7b97\u6709\u591a\u5c11\u5143\u7d20\u53ef\u4ee5\u4e0e\u4e4b\u914d\u5bf9\u3002\u4e3a\u4e86\u907f\u514d\u91cd\u590d\uff0c\u5bf9\u4e8e\u7b2c $p$ \u4e2a\u5143\u7d20\uff0c\u6211\u4eec\u53ea\u4ece $[1, p-1]$ \u8303\u56f4\u5185\uff08\u5373 **\u5b83\u7684\u5de6\u4fa7**\uff09\u8fdb\u884c\u8ba1\u6570\u3002\n\n\u957f\u5ea6\u4e3a $n$ \u7684\u5e8f\u5217\u6700\u591a\u6709 $n-k+1$ \u4e2a\u957f\u5ea6\u4e3a $k$ \u7684\u5b50\u533a\u95f4\uff0c\u6bcf\u4e2a\u5b50\u533a\u95f4\u6700\u591a\u8d21\u732e $\\frac{k+1}{2}$ \u7684\u7b54\u6848\uff08\u8981\u8bb0\u5f97 $k$ \u662f\u5947\u6570\uff09\uff0c\u56e0\u6b64\u7b54\u6848\u7684\u6700\u5927\u503c\u662f $(n-k+1) \\times \\frac{k+1}{2}$\u3002\n\n\u5047\u8bbe\u5bf9\u4e8e\u7b2c $p$ \u4e2a\u5143\u7d20\uff0c\u5b83\u5de6\u4fa7\u53ef\u80fd\u5b58\u5728\u4e0e\u4e4b\u914d\u5bf9\uff08\u5bf9\u79f0\u5e76\u76f8\u7b49\uff09\u7684\u5143\u7d20\u7684\u8303\u56f4\u662f $[l, r]$\uff0c\u90a3\u4e48\u53ea\u8981\u63d0\u524d\u5206\u5947\u5076\u628a\u6240\u6709\u6570\u5b57\u51fa\u73b0\u7684\u4f4d\u7f6e\u5b58\u4e0b\u6765\uff0c\u4f7f\u7528 `std::upper_bound` \u548c `std::lower_bound` \u5c31\u53ef\u4ee5\u5feb\u901f\u8ba1\u7b97\u51fa\u8fd9\u4e2a\u8303\u56f4\u5185\u6709\u591a\u5c11\u4e2a\u3002\u7b54\u6848\u7684\u6700\u5927\u503c\u51cf\u53bb\u6240\u6709\u7684\u914d\u5bf9\u4e2a\u6570\uff0c\u5c31\u662f\u6700\u7ec8\u7b54\u6848\u3002\n\n\u90a3\u4e48\u63a5\u4e0b\u6765\u7684\u4e3b\u8981\u95ee\u9898\uff0c\u5c31\u662f\u8ba1\u7b97 $[l, r]$\u3002\n\n### \u5bf9\u4e8e $l$\n\n- \u9996\u5148\u8981\u4fdd\u8bc1 $l$ \u5230 $p$ \u7684\u8ddd\u79bb\u5728 $k$ \u4ee5\u5185\uff0c\u5373 $p-l+1 \\leq k$\uff0c\u5316\u7b80\u5f97\u5230 $l \\geq p-k+1$\u3002\n- $l$ \u4e0e $p$ \u4e4b\u95f4\u5bf9\u79f0\u8f74\u7684\u4f4d\u7f6e\u662f $m=\\frac{l+p}{2}$\uff0c\u8981\u4fdd\u8bc1\u5bf9\u79f0\u8f74\u5de6\u8fb9\u8fd8\u6709\u8db3\u591f\u7684\u4f4d\u7f6e\u6765\u5bb9\u7eb3\u8fd9\u4e2a\u957f\u5ea6\u4e3a $k$ \u7684\u533a\u95f4\uff0c\u5f97\u5230 $\\frac{l+p}{2} - \\frac{k+1}{2} \\geq 1$\uff0c\u5316\u7b80\u5f97\u5230 $l \\geq k+2-p-1$\u3002\n\n### \u5bf9\u4e8e $r$\n\n- \u4e3a\u4e86\u907f\u514d\u91cd\u590d\u8ba1\u7b97\uff0c\u6211\u4eec\u53ea\u8003\u8651\u5728 $p$ \u5de6\u8fb9\u7684\u53ef\u80fd\u7684\u4f4d\u7f6e\u3002$r$ \u7684\u6700\u5927\u503c\u5728\u5bf9\u79f0\u8f74\u4f4d\u4e8e $m=p-1$ \u7684\u65f6\u5019\u53d6\u5230\uff0c\u6b64\u65f6 $r=p-2$\u3002\u56e0\u6b64\uff1a$r \\leq p - 2$\u3002\n- $r$ \u4e0e $p$ \u4e4b\u95f4\u5bf9\u79f0\u8f74\u7684\u4f4d\u7f6e\u662f $m = \\frac{r+p}{2}$\uff0c\u4e0e\u521a\u624d\u7c7b\u4f3c\uff0c\u73b0\u5728\u8981\u4fdd\u8bc1\u5bf9\u79f0\u8f74\u53f3\u8fb9\uff08\u5230\u6570\u7ec4\u5c3d\u5934\uff09\u8fd8\u6709\u8db3\u591f\u7684\u4f4d\u7f6e\u6765\u5bb9\u7eb3\u8fd9\u4e2a\u957f\u5ea6\u4e3a $k$ \u7684\u533a\u95f4\uff0c\u5373 $\\frac{r+p}{2} + \\frac{k+1}{2} <= n$\uff0c\u5316\u7b80\u5f97\u5230 $r \\leq 2n - p - k + 1$\u3002\n\n### \u6574\u7406\u5f0f\u5b50\n\n\u6839\u636e\u4e0a\u8ff0\u8ba1\u7b97\uff0c\u6709 $$\\begin{aligned} l &= \\max(p-k+1, k-p+1) \\\\ r &= \\min(p-2, 2n-p-k+1) \\end{aligned}$$\n\u8981\u6ce8\u610f\u6709\u53ef\u80fd\u8ba1\u7b97\u5f97\u5230 $l > r$\uff0c\u8fd9\u79cd\u60c5\u51b5\u5e94\u5f53\u4e88\u4ee5\u5ffd\u7565\u3002\n\n## \u4ee3\u7801\n\n```cpp\nvoid solution() {\n  int n, k;\n  std::cin >> n >> k;\n  assert(k & 1);\n  std::vector<int> a(n + 1);\n  for (int i = 1; i <= n; ++i) std::cin >> a[i];\n  std::vector<std::vector<int>> odd(200001), even(200001);\n  for (int i = 1; i <= n; ++i)\n    i & 1 ? odd[a[i]].push_back(i) : even[a[i]].push_back(i);\n  ll ans = 1ll * (k / 2) * (n - k + 1);\n  auto solve = [&](auto& pos) {\n    for (int x = 1; x <= 200000; ++x) {\n      for (auto p : pos[x]) {\n        int l = std::max(p - k + 1, k - p + 1);\n        int r = std::min(p - 2, 2 * n - p - k + 1);\n        auto it1 = std::lower_bound(pos[x].begin(), pos[x].end(), l);\n        auto it2 = std::upper_bound(pos[x].begin(), pos[x].end(), r);\n        auto sub = std::distance(it1, it2);\n        ans -= sub <= 0 ? 0 : sub;\n      }\n    }\n  };\n  solve(odd);\n  solve(even);\n  std::cout << ans << \"\\n\";\n}\n```",
        "postTime": 1680436969,
        "uid": 53062,
        "name": "Anguei",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF1808D\u3010Petya, Petya, Petr, and Palindromes\u3011"
    }
]
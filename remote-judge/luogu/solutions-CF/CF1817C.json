[
    {
        "content": "## \u9898\u76ee\u94fe\u63a5\n\n[CF1817C Similar Polynomials](https://codeforces.com/problemset/problem/1817/C)\n\n## \u9898\u89e3\n\n\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4e2a\u6bd4\u8f83\u5bfb\u7684\u505a\u6cd5\u3002\n\n\u6211\u4eec\u8003\u8651\u5df2\u77e5 $d$ \u6b21\u591a\u9879\u5f0f\u7684 $d + 1$ \u4e2a\u70b9\u503c\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u8fd9\u4e2a\u591a\u9879\u5f0f\u63d2\u503c\u51fa\u6765\uff0c\u4f46\u662f\u76f4\u63a5\u505a\u662f $\\Theta(d \\log ^ 2 d)$\uff0c\u6240\u4ee5\u65e0\u6cd5\u901a\u8fc7\u3002\n\n\u7136\u540e\u8003\u8651\u591a\u9879\u5f0f $A$ \u548c $B$ \u4e4b\u95f4\u7684\u5173\u7cfb\uff0c\u8bbe\uff1a\n\n$$A = \\sum_{i = 0} ^ d a_i x ^ i, B = \\sum_{i = 0} ^ d b_i x ^ i$$\n\n\u663e\u7136\u6709\uff1a\n\n$$B = \\sum_{i = 0} ^ d b_i x ^ i = \\sum_{i = 0} ^ d a_i (x + s) ^ i$$\n\n\u7136\u540e\u63a8\u4e00\u4e0b\u5f0f\u5b50\uff1a\n\n$$\\sum_{i = 0} ^ d a_i (x + s) ^ i = \\sum_{i = 0} ^ d a_i \\times \\sum_{j = 0} ^ i \\binom{i}{j} x ^ j \\cdot s ^ {i - j}$$\n\n$$= \\sum_{j = 0} ^ d \\sum_{i = j} ^ d \\binom{i}{j} a_i \\cdot s ^ {i - j} x ^ j$$\n\n\u7136\u540e\u6211\u4eec\u5c31\u6709\uff1a\n\n$$b_i = \\sum_{j = i} ^ d \\binom{j}{i} a_j \\cdot s ^ {j - i}$$\n\n\u8003\u8651\u4e00\u4e2a\u7279\u6b8a\u60c5\u51b5\uff0c\u5f53 $i$ \u53d6\u5230 $d - 1$ \u65f6\uff1a\n\n$$b_{d - 1} = a_{d - 1} \\times s + a_d \\times d$$\n\n$$s = \\dfrac{b_{d - 1} - a_d \\times d}{a_{d - 1}}$$\n\n\u6240\u4ee5\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u77e5\u9053\u591a\u9879\u5f0f $A$ \u548c $B$ \u7684\u6240\u6709\u7cfb\u6570\uff0c\u53ea\u9700\u8981\u77e5\u9053 $x ^ {d - 1}$ \u9879\u548c $x^d$ \u9879\u7684\u7cfb\u6570\u3002\n\n\u7136\u540e\u8003\u8651\u62c9\u683c\u6717\u65e5\u63d2\u503c\uff0c\u5047\u5982\u5df2\u77e5\u591a\u9879\u5f0f $F$ \u7ecf\u8fc7 $d + 1$ \u4e2a\u70b9 $(x_0, y_0), (x_1, y_1), \\cdots, (x_d, y_d)$\uff1a\n\n$$F(x) = \\sum_{i = 0} ^ d y_i \\times \\prod_{j \\neq i} \\dfrac{x - x_j}{x_i - x_j}$$\n\n\u6240\u4ee5\u591a\u9879\u5f0f $F$ \u5c31\u662f\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u7136\u540e\u8003\u8651\u53d8\u5f62\u4e00\u4e0b\uff1a\n\n$$F(x) = \\sum_{i = 0} ^ d \\dfrac{y_i}{\\prod\\limits_{j \\neq i} (x_i - x_j)} \\times \\prod_{j \\neq i} (x - x_j)$$\n\n\u7136\u540e\u6c42 $x ^ d$ \u9879\u7cfb\u6570\u5c31\u662f\uff1a\n\n$$[x ^ d] F(x) = \\sum_{i = 0} ^ d \\dfrac{y_i}{\\prod\\limits_{j \\neq i} (x_i - x_j)}$$\n\n\u53ef\u4ee5\u7406\u89e3\u6210\u5bf9\u4e8e\u6bcf\u4e2a $i$\uff0c\u524d\u9762\u7684\u7cfb\u6570\u662f\u56fa\u5b9a\u7684\uff0c\u7136\u540e\u8003\u8651\u540e\u9762 $\\prod\\limits_{j \\neq i} (x - x_j)$\uff0c\u53ea\u6709\u5728\u6bcf\u4e00\u9879\u90fd\u53d6 $x$ \u65f6\u624d\u80fd\u591f\u8fbe\u5230 $x ^ d$\uff0c\u6240\u4ee5\u8fd9\u90e8\u5206\u7684\u8d21\u732e\u5c31\u662f $1$\uff0c\u7136\u540e\u5c31\u52a0\u8d77\u6765\u5c31\u884c\u4e86\u3002\n\n\u6c42 $x ^ {d - 1}$ \u9879\u7cfb\u6570\u4e5f\u7c7b\u4f3c\uff1a\n\n$$[x ^ {d - 1}] F(x) = \\sum_{i = 0} ^ d \\dfrac{y_i}{\\prod\\limits_{j \\neq i} (x_i - x_j)} \\times \\sum\\limits_{j \\neq i} (-x_j)$$\n\n\u8ddf\u4e0a\u9762\u7c7b\u4f3c\uff0c\u524d\u9762\u7cfb\u6570\u56fa\u5b9a\uff0c\u540e\u9762\u5982\u679c\u8981\u53d6\u5230 $x ^ {d - 1}$ \u5c31\u5fc5\u987b\u6070\u597d\u6709\u4e00\u5904\u662f\u53d6\u5230\u5f62\u5982 $-x_k$\uff0c\u5176\u4f59\u5168\u90e8\u53d6\u5230 $x$\uff0c\u6240\u4ee5\u8d21\u732e\u5c31\u662f $\\sum\\limits_{j \\neq i} (-x_j)$\uff0c\u7136\u540e\u76f8\u4e58\u540e\u76f8\u52a0\u5c31\u884c\u4e86\u3002\n\n\u81f3\u6b64\uff0c\u53ea\u9700\u8981\u9884\u5904\u7406\u51fa\u9636\u4e58\u9006\u5143\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(d)$\u3002\n\n## \u4ee3\u7801\u94fe\u63a5\n\n<https://codeforces.com/contest/1817/submission/203954733>",
        "postTime": 1683288105,
        "uid": 355448,
        "name": "Fido_Puppy",
        "ccfLevel": 0,
        "title": "Similar Polynomials"
    },
    {
        "content": "#### [CF1817C Similar Polynomials](https://www.luogu.com.cn/problem/CF1817C)\n\n\u591a\u9879\u5f0f\u6b21\u6570\u592a\u9ad8\u4e86\uff0c\u4e0d\u597d\u5904\u7406\u3002\u8003\u8651 \u201c\u6c42\u5bfc\u201d \u964d\u6b21\u3002\u79bb\u6563\u610f\u4e49\u4e0b\u5c31\u662f\u5dee\u5206\u3002\n\n\u6211\u4eec\u77e5\u9053\uff0c\u5bf9\u51fd\u6570\u505a\u5f62\u5982 $f'(x) \\gets f(x + 1) - f(x)$ \u7684\u5dee\u5206\uff0c\u5219 $\\deg f' = \\deg f - 1$\u3002\u6240\u4ee5\u5c06 $d + 1$ \u4e2a\u70b9\u503c\u5dee\u5206 $d - 1$ \u6b21\uff0c$A$ \u4ece $d$ \u6b21\u53d8\u6210 $1$ \u6b21\uff0c\u4e5f\u5c31\u662f\u76f4\u7ebf $A' = kx + b$\u3002\n\n$A(0\\sim d)$ \u7684 $d - 1$ \u9636\u5dee\u5206 $a_0, a_1$ \u5206\u522b\u7b49\u4e8e $A'(0), A'(1)$\uff0c\u76f8\u5f53\u4e8e $kx + b$ \u5728 $x = 0$ \u548c $x = 1$ \u5904\u7684\u70b9\u503c\u3002\n\n$B(0\\sim d)$ \u5373 $A(s\\sim s + d)$ \u7684 $d - 1$ \u9636\u5dee\u5206 $b_0, b_1$ \u5206\u522b\u7b49\u4e8e $A'(s), A'(s + 1)$\uff0c\u76f8\u5f53\u4e8e $kx + b$ \u5728 $x = s$ \u548c $x = s + 1$ \u5904\u7684\u70b9\u503c\u3002\n\n\u663e\u7136\uff0c\u6839\u636e $a_0$ \u548c $a_1$ \u53ef\u4ee5\u76f4\u63a5\u786e\u5b9a\u76f4\u7ebf\uff0c\u518d\u4ee3\u5165 $(s, b_0)$ \u6216 $(s + 1, b_1)$ \u5373\u53ef\u3002\u7b54\u6848\u5373 $\\frac {b_1 - a_1} {a_1 - a_0}$ \u6216 $\\frac {b_0 - a_0} {a_1 - a_0}$\u3002\n\n\u81f3\u4e8e $k$ \u9636\u5dee\u5206\u600e\u4e48\u6c42\uff1a\n$$\n\\Delta ^ k f(x) = \\sum_{i = 0} ^ k \\binom k i(-1) ^ {k - i} f(x +i)\n$$\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(d)$\u3002[\u4ee3\u7801](https://codeforces.com/contest/1817/submission/204387186)\u3002",
        "postTime": 1683261361,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "CF1817C Similar Polynomials"
    },
    {
        "content": "\u4e0d\u96be\u60f3\u5230\u505a\u6cd5\u5c31\u662f\u5c06\u591a\u9879\u5f0f\u5dee\u5206 $d-1$ \u6b21\u540e\u5bf9\u4e24\u4e2a\u4e00\u6b21\u51fd\u6570\u7684\u6a2a\u622a\u8ddd\u4f5c\u5dee\u3002\n\n\u6240\u8c13\u5bf9\u591a\u9879\u5f0f\u5dee\u5206\uff0c\u5c31\u662f\u6bcf\u6b21\u5bf9 $y_0,y_1,\\dots,y_d$ \u8fd9\u4e9b\u70b9\u503c\u6c42\u5dee\u5206\uff0c\u7136\u540e\u4e22\u6389\u9996\u9879\u3002\n\n\u5982\u679c\u4f60\u8bb0\u5f97\u751f\u6210\u51fd\u6570\u7684\u8bdd\uff0c\u5c31\u4f1a\u77e5\u9053\u5bf9\u4e00\u4e2a\u6570\u7ec4 $a_0,a_1,\\dots,a_n$ \u4f5c $k$ \u6b21\u5dee\u5206\u5f97\u5230\u7684\u6570\u7ec4\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u591a\u9879\u5f0f\u7684\u5404\u9879\u7cfb\u6570\u8868\u793a\uff1a$f^k(x)=(a_0x^0+a_1x^1+a_2x^2+\\dots+a_nx^{n})\\cdot (1-x)^k$\u3002\n\n\u6211\u4eec\u5c31\u662f\u8981 $f^{d-1}(x)$ \u7684\u7b2c $d$ \u9879\u548c\u7b2c $d-1$ \u9879\u7cfb\u6570\u3002\n\n\u4e8e\u662f\u53ea\u9700\u8981\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c55\u5f00 $(1-x)^k$ \u8ba1\u7b97\u5404 $a_i$ \u5bf9 \u8fd9\u4e24\u9879\u7684\u8d21\u732e\u5373\u53ef\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N=2.5e6+5,mod=1e9+7;\nint n,a[N],b[N],jc[N],ijc[N];\ninline int C(int n,int m){\n\treturn (ll)jc[n]*ijc[m]%mod*ijc[n-m]%mod;\n}\ninline int qp(int a,int b){\n\tint c=1;for(;b;b>>=1,a=(ll)a*a%mod)if(b&1)c=(ll)c*a%mod;\n\treturn c;\n}\nint work(int a[N]){\n\tint ret=0;\n\tfor(int i=0;i<n;i++)ret+=(i&1?1ll:mod-1ll)*C(n-1,i)%mod*a[n-1-i]%mod,ret>=mod&&(ret-=mod);\n\tint ret2=0;\n\tfor(int i=0;i<n;i++)ret2+=(i&1?1ll:mod-1ll)*C(n-1,i)%mod*a[n-i]%mod,ret2>=mod&&(ret2-=mod);\n\treturn mod-(ll)ret2*qp(ret2-ret+mod,mod-2)%mod;\n\t//y1=kx1+b y2=kx2+b (ret2-ret)=k  b=(y1-kx1)  x1-y1/k  \n}\nint main(){\n\tios::sync_with_stdio(0);\n\tcin>>n;\n\tjc[0]=ijc[0]=1;for(int i=1;i<=n;i++)jc[i]=jc[i-1]*(ll)i%mod;\n\tijc[n]=qp(jc[n],mod-2);for(int i=n-1;i;i--)ijc[i]=(i+1ll)*ijc[i+1]%mod;\n\tfor(int i=0;i<=n;i++)cin>>a[i];\n\tfor(int i=0;i<=n;i++)cin>>b[i];\n\tcout<<(work(a)-work(b)+mod)%mod<<'\\n';\n}\n/*\n(1-x)^{n-1}\n\\sum_{i=0}^{n-1} (-1)^{i}x^{i}C(n-1,i)\n*/\n```",
        "postTime": 1683294264,
        "uid": 300078,
        "name": "pengyule",
        "ccfLevel": 7,
        "title": "1817C"
    },
    {
        "content": "[\u53ef\u80fd\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/jiangtaizhe001/p/17367904.html)\n\n[\u9898\u76ee\u4f20\u9001\u95e8](https://codeforces.com/contest/1817/problem/C)\n\nDiv.1 C \u62c9\u683c\u6717\u65e5\u5dee\u503c\uff0c\u8d5b\u65f6\u5f00\u9999\u69df\u3002\n\nUPD\uff1a\u6709\u4e2a\u5730\u65b9\u6253\u9519\u4e86\uff0c\u5df2\u7ecf\u66f4\u6b63\u3002\n\n### \u9898\u76ee\u5927\u610f\n\u7ed9\u5b9a $d$ \u6b21\u4e24\u4e2a\u591a\u9879\u5f0f $A(x),B(x)$\u3002\u6c42 $s$\uff0c\u4f7f\u5f97 $B(x)\\equiv A(x+s) \\pmod {10^9+7}$ \uff0c\u4fdd\u8bc1 $s$ \u5b58\u5728\u3002  \n\u7ed9\u51fa\u591a\u9879\u5f0f\u7684\u5f62\u5f0f\u4e3a\u7ed9\u51fa $x=0,1,\\cdots,d$ \u6a21 $10^9+7$ \u7684\u503c\u3002  \n$d\\le 2.5 \\times 10^7$\u3002\n### \u9898\u76ee\u89e3\u6790\n\u8003\u8651 $A(x)\\equiv B(x-s) \\pmod {10^9+7}$\uff0c\u5c55\u5f00 $B(x-s)$\u3002  \n\u53d1\u73b0 $A(x)$ \u548c $B(x)$ \u6700\u9ad8\u4f4d\u7cfb\u6570\u76f8\u540c\uff08\u8bb0\u4f4d $k$\uff09\uff0c\u5e76\u4e14\u53ea\u8981\u77e5\u9053\u7b2c\u4e8c\u9ad8\u4f4d $k_1,k_2$\uff0c\u90a3\u4e48\u5c31\u6709  \n$k_1\\equiv k_2-2 s k_1\\pmod {10^9+7}$\u3002  \n\u6240\u4ee5\u5173\u952e\u5728\u4e8e\u6c42\u8fd9\u4e09\u4e2a\u6570\u5b57\u3002  \n\n\u8003\u8651\u62c9\u683c\u6717\u65e5\u63d2\u503c\uff08\u8003\u8651 $x_i=i$\uff0c\u8fd9\u91cc\u76f4\u63a5\u5e26\u5165\uff09\n$$f(x)=\\sum_{i=0}^{d}y_i\\prod_{j=1,j\\not=i}^{n}\\dfrac{x-j}{i-j}$$\n\u6700\u9ad8\u9879\u7cfb\u6570\u4e3a\n$$\\sum\\limits_{i=0}^d\\dfrac{y_i}{(-1)^{d-i} i! (d-i)!}$$\n\u7b2c\u4e8c\u9ad8\u9879\u7cfb\u6570\u4e3a\n$$-\\sum\\limits_{i=0}^d \\dfrac{y_i }{ (-1)^{d-i} i! (d-i)!} \\left(\\dfrac{d(d+1)}{2}-i\\right)$$\n\n\u9884\u5904\u7406 $i!$ \u9006\u5143\u5373\u53ef\uff0c$\\Theta(n)$\u3002\n\n```cpp\nint n; ll a[maxn],b[maxn],fact[maxn],inv[maxn],k,k1,k2;\nll fpow(ll x,ll y){\n\tll tmp=x,res=1;\n\twhile(y){\n\t\tif(y&1) res=res*tmp%MOD;\n\t\ty>>=1; tmp=tmp*tmp%MOD;\n\t} return res;\n}\nll getk(int d,ll *p){\n\tll ans=0; int i;\n\tfor(i=0;i<=d;i++){\n\t\tll t=p[i]*inv[i]%MOD*inv[d-i]%MOD; if((d-i)&1) t=MOD-t;\n\t\tans=(ans+t)%MOD;\n\t} return ans;\t\n}\nll getk2(int d,ll *p){\n\tll ans=0; int i;\n\tfor(i=0;i<=d;i++){\n\t\tll t=(1ll*d*(d+1)/2-i)%MOD*p[i]%MOD*inv[i]%MOD*inv[d-i]%MOD; if((d-i)&1) t=MOD-t;\n\t\tans=(ans+t)%MOD;\n\t} return MOD-ans;\n}\nint main(){\n#ifdef LOCAL\n\tfreopen(\"1.in\",\"r\",stdin);\n#endif\n\tn=read(); int i; for(i=0;i<=n;i++) a[i]=read(); for(i=0;i<=n;i++) b[i]=read();\n\tfact[0]=1; for(i=1;i<=n;i++) fact[i]=fact[i-1]*i%MOD;\n\tinv[n]=fpow(fact[n],MOD-2); for(i=n-1;i>=0;i--) inv[i]=inv[i+1]*(i+1)%MOD;\n\tk=getk(n,a); k1=getk2(n,a); k2=getk2(n,b);\n\tprint((k2-k1+MOD)%MOD*fpow(k*n%MOD,MOD-2)%MOD);\n\treturn 0;\n}\n```",
        "postTime": 1683029688,
        "uid": 215042,
        "name": "jiangtaizhe001",
        "ccfLevel": 7,
        "title": "CF1817C Similar Polynomials \u9898\u89e3"
    },
    {
        "content": "\u6700\u540e 5min \u624d\u4f1a\uff0c\u7136\u540e\u6ca1\u5199\u5b8c\u3002\n\n$$B(x)= \\sum_{i=0}^dx^i\\cdot b_i$$\n\n$$A(x+s)= \\sum_{i=0}^d(x+s)^i\\cdot a_i=\\sum_{i=0}^dx^i\\sum_{j=i}^da_js^{j-i}\\binom ji$$\n\n\u6bcf\u9879\u7cfb\u6570\u76f8\u7b49\uff0c\u53ef\u5f97\n\n$$\\forall i,\\ b_i=\\sum_{j=i}^da_js^{j-i}\\binom ji$$\n\n\u63a8\u5230\u8fd9\u4e00\u6b65\u4e4b\u540e\u6211\u5361\u4e86 40min\u3002\u7136\u800c\u76f4\u63a5\u4ee3\u503c\u8fdb\u53bb\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u4ee4 $i=d-1$\uff0c\u4ee3\u5165\u5f97\u5230\uff1a\n\n$$b_{d-1}=d\\cdot a_d\\cdot s+a_{d-1}$$\n\n\u7528\u7ec4\u5408\u6570\u7b97\u51fa $a_{d-1},b_{d-1},a_d$ \u5373\u53ef\u8ba1\u7b97 $s$\u3002",
        "postTime": 1682826836,
        "uid": 151475,
        "name": "Little09",
        "ccfLevel": 8,
        "title": "CF1817C"
    }
]
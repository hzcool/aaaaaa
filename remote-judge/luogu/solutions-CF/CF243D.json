[
    {
        "content": "\u9996\u5148\u6211\u4eec\u901a\u8fc7\u7ffb\u8f6c\u5750\u6807\u7cfb\u5f3a\u5236\u8981\u6c42\u5149\u7684\u65b9\u5411\u662f\u6b63\u65b9\u5411\u3002\u7ffb\u8f6c\u5750\u6807\u7cfb\u5c31\u7ffb\u8f6c\u77e9\u9635\u7684\u5bf9\u5e94\u7ef4\u5ea6\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\uff0c\u5982\u679c\u4e0d\u8003\u8651\u906e\u6321\u5173\u7cfb\uff0c\u53ea\u8003\u8651\u5e73\u9762\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u65b9\u5757\u800c\u8a00\uff0c\u80fd\u7167\u5230\u5b83\u7684\u5149\u662f\u4e00\u6bb5\u533a\u95f4\u3002\u5c31\u662f\u80fd\u7167\u5230 $(i-1,j)$ \u548c\u80fd\u627e\u5230 $(i,j-1)$ \u7684\u5149\u3002\n\n\u6211\u4eec\u8003\u8651\u628a\u5149\u6620\u5c04\u5230\u5149\u6240\u5728\u76f4\u7ebf\u5728 $y$ \u8f74\u4e0a\u7684\u6295\u5f71\u3002\u90a3\u4e48\u7ecf\u8fc7\u70b9 $(x,y)$ \u7684\u5149\u5c31\u6620\u5c04\u5230 $y-\\dfrac{v_yx}{v_x}$\uff0c\u6211\u4eec\u5c31\u6620\u5c04\u5230\u4e86 $y$ \u8f74\u7684\u4e00\u4e2a\u533a\u95f4 $[l_{x,y},r_{x,y}]$\uff0c\u53ea\u8981\u8fd9\u4e2a\u533a\u95f4\u91cc\u6709\u5149\uff0c\u5f53\u524d\u4f4d\u7f6e\u5c31\u80fd\u88ab\u7167\u5230\u3002\n\n\u540c\u65f6\u6211\u4eec\u5bb9\u6613\u53d1\u73b0\uff0c\u6bcf\u4e2a\u65b9\u5757\u6240\u5bf9\u5e94\u7684\u533a\u95f4\u662f\u7b49\u957f\u7684\u3002\u4e0d\u8fc7\u8fd9\u4e0d\u91cd\u8981\u3002\n\n\u6211\u4eec\u628a\u6240\u6709\u7684\u5149\u533a\u95f4\u7aef\u70b9\u79bb\u6563\u5316\u4e0b\u6765\u3002\u7136\u540e\u5bf9\u4e8e $(x,y)$ \u7684\u4f4d\u7f6e\u6765\u8bf4\uff0c\u53ea\u8981\u5728\u5f53\u524d\u9ad8\u5ea6 $[l_{x,y},r_{x,y}]$ \u4e0a\u4efb\u610f\u7684\u70b9\u6709\u5149\u5c31\u53ef\u4ee5\u3002\u800c\u5bf9\u4e8e\u9ad8\u5ea6\u800c\u8a00\u6709\u6ca1\u6709\u5149\u663e\u7136\u662f\u5b58\u5728\u5355\u8c03\u6027\u7684\u3002\n\n\u540c\u65f6\u906e\u6321\u5173\u7cfb\u4e5f\u662f\u5b58\u5728\u5355\u8c03\u6027\u7684\u3002__\u5904\u5728\u5f53\u524d\u70b9\u53f3\u8fb9\u6216\u8005\u4e0a\u65b9\u7684\u70b9\u4e00\u5b9a\u906e\u6321\u4e0d\u4e86\u5f53\u524d\u7684\u70b9\u3002__ \u90a3\u4e48\u6211\u4eec\u8003\u8651\u4ece\u5de6\u4e0b\u89d2\u4e00\u884c\u4e00\u884c\u626b\uff0c\u5f00\u4e00\u68f5\u7ebf\u6bb5\u6811\u8bb0\u5f55\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u5149\u533a\u95f4\uff0c\u6709\u591a\u5c11\u9ad8\u5ea6\u5df2\u7ecf\u5b8c\u5168\u6ca1\u6709\u5149\u4e86\u3002\n\n\u8fd9\u6837\uff0c\u6211\u4eec\u6bcf\u6b21\u5728\u7ebf\u6bb5\u6811\u4e0a\u67e5\u8be2\u533a\u95f4\u6700\u5c0f\u503c\uff08\u53ea\u8981\u6709\u5373\u53ef\uff09\uff0c\u627e\u5230\u5f53\u524d\u7684\u4f4d\u7f6e\u6709\u591a\u5c11\u65b9\u5757\u88ab\u6321\u4f4f\u4e86\uff0c\u7528 $a_{i,j}$ \u51cf\u5f97\u5230\u6ca1\u6321\u4f4f\u7684\u3002\u7136\u540e\u533a\u95f4\u4fee\u6539\uff0c\u81ea\u5df1\u533a\u95f4\u4e0a\u7684\u6240\u6709\u6570\u5bf9 $a_{i,j}$ \u53d6 $\\max$\uff08\u8fd9\u4e9b\u5149\u90fd\u88ab\u906e\u6321\u4e86\uff09\u3002\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ea\u8981\u5b9e\u73b0\u7ebf\u6bb5\u6811\u533a\u95f4\u53d6 $\\max$\uff0c\u67e5\u8be2\u533a\u95f4\u6700\u5c0f\u503c\uff0c\u8fd9\u662f\u5bb9\u6613\u7684\u3002\n\n\u540c\u65f6\u6ce8\u610f\uff0c\u8fd9\u9898\u5361\u7cbe\u5ea6\uff0c\u6211\u7684\u65b9\u6cd5\u662f\u5b9e\u73b0\u4e86\u4e00\u4e2a `struct`\uff0c\u7136\u540e\u91cd\u8f7d\u4e86\u5c0f\u4e8e\u53f7\uff0c\u8fd9\u6837\u7684\u597d\u5904\u662f\u4f9d\u65e7\u53ef\u4ee5\u4f7f\u7528 `sort` \u548c `lower_bound` \u800c\u4e0d\u6389\u7cbe\u5ea6\u3002\u79bb\u6563\u5316\u7684\u65f6\u5019\u8981 `unique`\uff0c\u5426\u5219\u7ebf\u6bb5\u6811\u533a\u95f4\u4f1a\u51fa\u95ee\u9898\uff0c\u8fd9\u4e2a\u529f\u80fd\u6211\u4e0d\u77e5\u9053\u8981\u91cd\u8f7d\u4ec0\u4e48\uff0c\u4f46\u662f\u53ef\u4ee5\u76f4\u63a5\u81ea\u5df1\u624b\u5199\u3002\n\n\u590d\u6742\u5ea6 $O(n^2\\log n)$\n\n```cpp\nconst ld eps=1e-6;\nint n,a[1005][1005],vx,vy,m; \nint l[1005][1005],r[1005][1005];\nstruct mydouble{\n\tld x;\n\tbool operator ==(const mydouble b)const{\n\t\treturn fabs(x-b.x)<=eps;\n\t}\n\tbool operator <(const mydouble b)const{\n\t\treturn b.x>x&&!(fabs(b.x-x)<=eps);\n\t}\n};\nmydouble L[1005][1005],R[1005][1005],x[2000005],y[2000005];\nstruct node{\n\tint l,r,m,tg;\n}sg[8000005];\ninline void init(int i,int l,int r){\n\tsg[i].l=l,sg[i].r=r,sg[i].m=0,sg[i].tg=0;\n\tif(l==r)return;\n\tinit(i<<1,l,(l+r)>>1);\n\tinit(i<<1|1,((l+r)>>1)+1,r);\n}\ninline void push(int i){\n\tif(!sg[i].tg)return;\n\tsg[i].m=max(sg[i].m,sg[i].tg);\n\tif(sg[i].l!=sg[i].r){\n\t\tsg[i<<1].tg=max(sg[i<<1].tg,sg[i].tg);\n\t\tsg[i<<1|1].tg=max(sg[i<<1|1].tg,sg[i].tg);\n\t}sg[i].tg=0;\n}\ninline void modify(int i,int l,int r,int x){\n\tpush(i);\n\tif(sg[i].l>r||sg[i].r<l)return;\n\tif(sg[i].l>=l&&sg[i].r<=r){\n\t\tsg[i].tg=max(sg[i].tg,x);\n\t\treturn push(i);\n\t}modify(i<<1,l,r,x);\n\tmodify(i<<1|1,l,r,x);\n\tsg[i].m=min(sg[i<<1].m,sg[i<<1|1].m);\n}\ninline int qry(int i,int l,int r){\n\tpush(i);\n\tif(sg[i].l>r||sg[i].r<l)return 1e9;\n\tif(sg[i].l>=l&&sg[i].r<=r)return sg[i].m;\n\tint res=min(qry(i<<1,l,r),qry(i<<1|1,l,r));\n\tsg[i].m=min(sg[i<<1].m,sg[i<<1|1].m);\n\treturn res;\n}\ninline void chdir(){\n\tif(vx<0){\n\t\trep(j,1,n)rep(i,1,n/2)swap(a[i][j],a[n-i+1][j]);\n\t\tvx=-vx;\n\t}\n\tif(vy<0){\n\t\trep(i,1,n)rep(j,1,n/2)swap(a[i][j],a[i][n-j+1]);\n\t\tvy=-vy;\n\t}\n}\ninline ld calc(int x,int y){\n\treturn y-1.0*x*vy/vx;\n}\ninline void calclr(){\n\trp(i,n)rp(j,n){\n\t\tif(vx!=0){\n\t\t\tL[i][j].x=calc(i,j-1);\n\t\t\tR[i][j].x=calc(i-1,j);\n\t\t\tx[++m]=L[i][j];\n\t\t\tx[++m]=R[i][j];\n\t\t}else{\n\t\t\tL[i][j].x=i-1,R[i][j].x=i;\n\t\t\tx[++m].x=i-1,x[++m].x=i;\n\t\t}\n\t}\n\tsort(x+1,x+1+m);\n\tint cnt=1;y[cnt]=x[1];\n\trep(i,2,m)if(!(x[i-1]==x[i]))y[++cnt]=x[i];\n\tm=cnt;\n\trep(i,2,m)x[i]=y[i];\n\trp(i,n)rp(j,n){\n\t\tl[i][j]=lower_bound(x+1,x+1+m,L[i][j])-x;\n\t\tr[i][j]=lower_bound(x+1,x+1+m,R[i][j])-x-1;\n\t}init(1,1,m);\n}\nsigned main(){\n\tios::sync_with_stdio(false);\n\tcin.tie(0);\n\tcin>>n>>vx>>vy;\n\trp(i,n)rp(j,n)cin>>a[i][j];\n\tchdir();\n\tcalclr();\n\tll ans=0;\n\trp(i,n)rp(j,n)if(a[i][j]){\n\t\tans+=max(0,a[i][j]-qry(1,l[i][j],r[i][j]));\n\t\tmodify(1,l[i][j],r[i][j],a[i][j]);\n\t}cout<<ans<<endl;\n\treturn 0;\n}\n//Crayan_r\n```\n",
        "postTime": 1684157056,
        "uid": 304222,
        "name": "jucason_xu",
        "ccfLevel": 0,
        "title": "CF243D"
    }
]
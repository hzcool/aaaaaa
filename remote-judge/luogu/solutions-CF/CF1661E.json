[
    {
        "content": "\u8fd9\u91cc\u63d0\u4f9b\u4e00\u79cd\u7ebf\u6027\u590d\u6742\u5ea6\u7684\u505a\u6cd5\u3002\n\n\u9996\u5148\u5148\u6c42\u51fa\u6240\u6709\u8fde\u901a\u5757\uff0c\u4ee5\u53ca\u8bb0\u5f55\u4e00\u4e0b\u5b83\u7684\u5de6\u53f3\u8fb9\u754c\uff0c\u7136\u540e\u9884\u5904\u7406\u51fa $sl$ \u548c $sr$ \u6570\u7ec4\uff0c\u5206\u522b\u8868\u793a\u4ece $1$ \u5230 $i$ \u548c\u4ece $i$ \u5230 $n$ \u4e2d**\u5168\u90e8**\u5728\u8be5\u8303\u56f4\u5185\u7684\u8fde\u901a\u5757\u4e2a\u6570\u3002\n\n\u540c\u65f6\u5904\u7406\u51fa $nstl$ \u4e0e $nstr$\uff0c\u5206\u522b\u8868\u793a\u5f53\u524d\u5217\u5411\u53f3\u548c\u5411\u5de6\u7b2c\u4e00\u4e2a\u4e0d\u4e3a ```101``` \u7ec4\u5408\u7684\u5217\u7f16\u53f7\u3002\n\n![1](https://cdn.luogu.com.cn/upload/image_hosting/tspb3hvh.png)\n\n\u89c2\u5bdf\u4e00\u4e0b\u8fd9\u4e2a\u4f8b\u5b50\uff0c\u5bb9\u6613\u53d1\u73b0\u82e5\u4e0d\u8003\u8651\u5207\u65ad\u540e\u65e0\u6cd5\u8fde\u901a\u7684\u5757\uff0c$ans=$ \u603b\u6570 $-sr[l-1]-sl[r+1]$\u3002\n\n\u4f46\u5f53\u65ad\u70b9\u5217\u4e3a ```101```\uff0c\u4e14\u7b2c $1$ \u884c\u4e0e\u7b2c $3$ \u884c\u5728\u540c\u4e00\u8fde\u901a\u5757\u4e2d\u65f6\uff0c\u6709\u53ef\u80fd\u589e\u52a0\u4e00\u4e2a\u5757\u3002\u4ece\u65ad\u70b9\u51fa\u53d1\u5411\u67e5\u8be2\u533a\u95f4\u5185\u627e\u5230\u7b2c\u4e00\u4e2a\u4e0d\u4e3a ```101``` \u7684\u5217\uff0c\u53ea\u8981\u8fd9\u4e2a\u5217\u4e2d\u6709\u4e00\u4e2a $0$\uff0c\u90a3\u4e48\u8fd9\u4e2a\u5757\u5c31\u5fc5\u7136\u8981\u65ad\u5f00\u4e86\u3002\u6240\u4ee5\u6b64\u65f6 ```ans++```\u3002\n\n\u7279\u522b\u7684\uff0c\u5982\u679c\u67e5\u8be2\u533a\u95f4\u5185\u7684\u5217\u5168\u90e8\u4e3a ```101```\uff0c\u5219\u7b54\u6848\u5c31\u4e3a $2$\u3002\n\n\u5de6\u53f3\u65ad\u70b9 $l$ \u548c $r$ \u90fd\u9700\u8981\u5224\u65ad\u4e00\u904d\u3002\n\n\u7efc\u5408\u590d\u6742\u5ea6 $O(n+q)$\u3002\n\n```cpp\n#include <iostream>\nusing namespace std;\n \nconst int N=510000,INF=3*N-1;\nint n,q;\nchar s[5][N];\nint l,r;\nint ltk[3*N][3];//0:\u5de6\u8fb9\u754c 1 \u53f3\u8fb9\u754c \nint sl[N],sr[N];\nint vis[4][N],cnt=1;\nint nstl[N],nstr[N];\nbool state=0;\n \nbool dfs(int x,int y){\n\tif(x==0 || y==0 || x>3 || y>n || s[x][y]=='0' || vis[x][y])\n\t\treturn state;\n\tvis[x][y]=cnt,state=1;\n\tltk[cnt][0]=min(ltk[cnt][0],y);\n\tltk[cnt][1]=max(ltk[cnt][1],y);\n\tdfs(x+1,y);\n\tdfs(x,y+1);\n\tdfs(x-1,y);\n\tdfs(x,y-1);\n\treturn state;\n}\n \nvoid solve(){\n\tint ans=cnt-1-sr[l-1]-sl[r+1];\n\tif(s[1][l]=='1' && s[2][l]=='0' && s[3][l]=='1' && vis[1][l]==vis[3][l]){\n\t\tint t=nstl[l];\n\t\tif(t>r)\n\t\t\tans=2;\n\t\telse if(s[1][t]=='0' || s[3][t]=='0')\n\t\t\tans++;\n\t}\n\tif(s[1][r]=='1' && s[2][r]=='0' && s[3][r]=='1' && vis[1][r]==vis[3][r]){\n\t\tint t=nstr[r];\n\t\tif(t>=l && (s[1][t]=='0'|| s[3][t]=='0'))\n\t\t\tans++;\n\t}\n\tcout<<ans<<endl;\n}\n \nint main(){\n\tcin>>n;\n\tfor(int i=0;i<=4;++i)\n\t\tfor(int j=0;j<=n+1;++j)\n\t\t\ts[i][j]='0';\n\tfor(int i=0;i<=3*n+1;++i)\n\t\tltk[i][0]=INF;\n\tfor(int i=1;i<=3;++i)\n\t\tfor(int j=1;j<=n;++j)\n\t\t\tcin>>s[i][j];\n\tfor(int i=1;i<=n;++i){\n\t\tstate=0;\n\t\tcnt+=dfs(1,i);\n\t\tstate=0;\n\t\tcnt+=dfs(2,i);\n\t\tstate=0;\n\t\tcnt+=dfs(3,i);\n\t}\n\tint t=n+1;\n\tfor(int i=n;i>=1;--i){\n\t\tif(!(s[1][i]=='1' && s[2][i]=='0' && s[3][i]=='1'))\n\t\t\tt=i;\n\t\tnstl[i]=t;\n\t}\n\tt=0;\n\tfor(int i=1;i<=n;++i){\n\t\tif(!(s[1][i]=='1' && s[2][i]=='0' && s[3][i]=='1'))\n\t\t\tt=i;\n\t\tnstr[i]=t;\n\t}\n\tfor(int i=1;i<cnt;++i){\n\t\tsl[ltk[i][0]]++;\n\t\tsr[ltk[i][1]]++;\n\t}\n\tfor(int i=1;i<=n;++i)\n\t\tsr[i]+=sr[i-1];\n\tfor(int i=n-1;i>=1;--i)\n\t\tsl[i]+=sl[i+1];\n\tcin>>q;\n\twhile(q--){\n\t\tcin>>l>>r;\n\t\tsolve();\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1651500611,
        "uid": 183954,
        "name": "MC\u5c0f\u840c\u65b0",
        "ccfLevel": 6,
        "title": "\u9898\u89e3CF1661E"
    },
    {
        "content": "\u4ee5\u4e0b\u5185\u5bb9\u6765\u81ea yzy1\uff1a\n\n> \u8d5b\u65f6\u7b2c\u4e00\u773c\uff1a\u8fd9\u4e0d SB \u9898\u5417\uff1f\u76f4\u63a5\u83ab\u961f\uff0c\u4e00\u6b21\u52a0\u5165\u6216\u8005\u5220\u9664\u4e00\u5217\u7684\u8d21\u732e\u53ea\u548c\u5b83\u5de6\u8fb9\u6216\u8005\u53f3\u8fb9\u7684\u4e00\u5217\u6709\u5173\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u9884\u5904\u7406\u51fa $64$ \u4e2d\u60c5\u51b5\uff0c\u7136\u540e\u83ab\u961f\u5c31\u884c\u3002\n>\n>\u6253\u4e86\u4e2a\u83ab\u961f\u4ea4\u4e0a\u53bb\u7ed3\u679c WA on test 1\uff0c\u53d1\u73b0\u83ab\u961f\u505a\u6cd5\u4e2d\u300c\u4e00\u5217\u7684\u8d21\u732e\u53ea\u548c\u5b83\u5de6\u8fb9\u6216\u8005\u53f3\u8fb9\u7684\u4e00\u5217\u6709\u5173\u300d\u662f\u5047\u7684\uff0c\u8003\u8651\u8fd9\u6837\u4e00\u79cd\u60c5\u51b5\uff1a\n>\n>```\n>111\n>001\n>111\n>```\n>\u5047\u8bbe\u6211\u4eec\u8be2\u95ee $[1,3]$\uff0c\u5219\u83ab\u961f\u53f3\u7aef\u70b9\u626b\u5230 $3$ \u7684\u65f6\u5019\uff0c\u521a\u624d\u7684\u7b97\u6cd5\u4f1a\u8ba1\u7b97 `101` \u548c `111` \u7ed3\u5408\uff0c\u65b0\u6210 $0$ \u4e2a\u8fde\u901a\u5757\u3002\u4e8b\u5b9e\u4e0a\uff0c\u52a0\u5165 $4$ \u540e\u4f1a\u628a\u4e0a\u4e0b\u4e24\u8fb9\u7684\u8fde\u901a\u5757\u5408\u5e76\uff0c\u5bf9\u7b54\u6848\u8d21\u732e\u4e3a $\u22121$\u3002\n\n\u8003\u8651\u4e3a\u4ec0\u4e48\u4f1a\u6709\u8fd9\u4e2a\u95ee\u9898\u3002\n\n\u6211\u4eec\u5145\u5206\u53d1\u626c\u4eba\u7c7b\u667a\u6167\uff08\u672c\u6587\u4e0b\u6807\u5747\u4ece $1$ \u5f00\u59cb\uff09\uff1a\n\n\u5bf9\u4e8e\u4e00\u6bb5 $\\begin{bmatrix}1\\\\0\\\\1\\end{bmatrix}$\uff0c\u6211\u4eec\u5728\u540e\u9762\u63a5\u5165 $\\begin{bmatrix}1\\\\1\\\\1\\end{bmatrix}$\uff0c\u7edf\u8ba1\u8d21\u732e\u65f6\uff0c\u4e0d\u80fd\u786e\u5b9a\u539f\u6765\u7684 $\\begin{bmatrix}1\\\\0\\\\1\\end{bmatrix}$ \u4e0a\u4e0b\u662f\u5426\u8054\u901a\u3002\u6240\u4ee5\u5f00\u4e24\u4e2a\u6570\u7ec4 $lf$ \u548c $rt$\uff0c$lf_i$ \u8868\u793a\u53e6\u7b2c $i$ \u5217\u7684 $\\begin{bmatrix}1\\\\0\\\\1\\end{bmatrix}$ \u4e0a\u4e0b\u8054\u901a\uff0c\u9700\u8981\u7684 $\\begin{bmatrix}\n1\\\\1\\\\1\\end{bmatrix}$ \u6700\u9760\u53f3\u7684\u4e0b\u6807\uff0c\u82e5\u4e0d\u5b58\u5728\uff0c$lf_i = 0$\u3002\n\n\u62ff\u4eba\u8bdd\u8bb2\uff0c\u5c31\u662f\u5982\u679c\u7b2c $i$ \u5217\u662f $\\begin{bmatrix}1\\\\0\\\\1\\end{bmatrix}$\uff0c\u90a3 $lf_i$ \u5c31\u662f $i$ \u5de6\u8fb9\u6700\u8fd1\u7684 $\\begin{bmatrix}1\\\\1\\\\1\\end{bmatrix}$\uff0c\u4e14 $lf_i + 1$ \u5217\u5230 $i$ \u5217\u5fc5\u987b\u90fd\u662f $\\begin{bmatrix}1\\\\0\\\\1\\end{bmatrix}$\uff0c\u5426\u5219 $lf_i = 0$\u3002\n\n$rt$ \u6570\u7ec4\u540c\u7406\u3002\n\n\u4e0b\u9762\u7ed9\u51fa $lf$ \u4e0e $rt$ \u7684\u6c42\u6cd5\u3002\n\n```cpp\nlf[0] = 0;\nfor (register int i = 1; i <= n; i++) {\n    if (a[1][i] && a[2][i] && a[3][i]) {\n        lf[i] = i;\n    } else if (a[1][i] && !a[2][i] && a[3][i]) {\n        lf[i] = lf[i - 1];\n    } else {\n        lf[i] = 0;\n    }\n}\nrt[n + 1] = n + 1;\nfor (register int i = n; i >= 1; i--) {\n    if (a[1][i] && a[2][i] && a[3][i]) {\n        rt[i] = i;\n    } else if (a[1][i] && !a[2][i] && a[3][i]) {\n        rt[i] = rt[i + 1];\n    } else {\n        rt[i] = n + 1;\n    }\n}\n```\n\n\u63a5\u4e0b\u6765\uff0c\u8003\u8651\u5982\u4f55\u5728\u79fb\u52a8\u5de6\u53f3\u6307\u9488\u65f6\u66f4\u65b0\u7b54\u6848\u3002\n\n\u901a\u8fc7\u51e0\u4e2a\u4f8b\u5b50\u6765\u8bf4\u660e\u3002\n\n1. \u5728 $\\vec{v_1} = \\begin{bmatrix}1\\\\1\\\\0\\end{bmatrix}$ \u540e\u52a0\u4e00\u6bb5 $\\vec{v_2} \\begin{bmatrix}0\\\\1\\\\1\\end{bmatrix}$\uff0c\u5f97\u5230 $\\begin{bmatrix}1 & 0  \\\\1 & 1 \\\\0 & 1 \\\\\\end{bmatrix}$\uff0c\u6b64\u65f6\u8054\u901a\u5757\u6570\u91cf\u4e0d\u53d8\uff0c\u5bf9\u7b54\u6848\u65e0\u8d21\u732e\u3002\n\n2. \u5728 $\\vec{v_1} = \\begin{bmatrix}1\\\\1\\\\0\\end{bmatrix}$ \u540e\u52a0\u4e00\u6bb5 $\\vec{v_2} \\begin{bmatrix}0\\\\0\\\\1\\end{bmatrix}$\uff0c\u5f97\u5230 $\\begin{bmatrix}1 & 0  \\\\1 & 0 \\\\0 & 1 \\\\\\end{bmatrix}$\uff0c\u6b64\u65f6\u539f\u6709\u8054\u901a\u5757\u4e00\u4e2a\uff0c\u73b0\u5728\u6709\u4e24\u4e2a\uff0c\u7b54\u6848\u52a0\u4e00\u3002\n\n2. \u5728 $\\vec{v_1} = \\begin{bmatrix}1\\\\0\\\\1\\end{bmatrix}$ \u540e\u52a0\u4e00\u6bb5 $\\vec{v_2} \\begin{bmatrix}0\\\\1\\\\1\\end{bmatrix}$\uff0c\u5f97\u5230 $\\begin{bmatrix}1 & 0  \\\\0 & 1 \\\\1 & 1 \\\\\\end{bmatrix}$\uff0c\u6b64\u65f6\u539f\u6709\u8054\u901a\u5757\u4e24\u4e2a\uff0c\u73b0\u5728\u6709\u4e24\u4e2a\uff0c\u5bf9\u7b54\u6848\u65e0\u8d21\u732e\u3002\n\n\u6240\u4ee5\uff0c\u5bf9\u4e8e\u6240\u6709 $\\vec{v_i}$\uff0c\u5904\u7406\u51fa\u5b83\u7684\u8054\u901a\u5757\u4e2a\u6570\uff0c\u8bb0\u4e3a $con1_i$\uff0c\u540c\u65f6\u5bf9\u4e8e\u6240\u6709\u77e9\u9635$\\begin{bmatrix} \\vec{v_i} & \\vec{v_{i+1}} \\\\\\end{bmatrix}$\uff0c\u5904\u7406\u51fa\u5b83\u7684\u8054\u901a\u5757\u4e2a\u6570\uff0c\u8bb0\u4e3a $con2_i$\u3002\n\n\u4e0b\u9762\u7ed9\u51fa $con1$ \u548c $con2$ \u7684\u6c42\u6cd5\u3002\n\n\u4e3a\u4e86\u51cf\u5c0f\u5e38\u6570\uff0c\u4f7f\u7528\u6253\u8868\u5b9e\u73b0\u3002\n\n[\u4ee3\u7801\u8fc7\u957f\uff0c\u653e\u5728\u526a\u8d34\u677f\u91cc](https://www.luogu.com.cn/paste/7jxrh3ns)\n\n\u6839\u636e\u6570\u5b66\u76f4\u89c9\uff0c\u5728\u4e0d\u8003\u8651 $\\begin{bmatrix}1 & 1  \\\\0 & 1 \\\\1 & 1 \\\\\\end{bmatrix}$ \u7684\u60c5\u51b5\u65f6\uff0c\u8981\u628a $r$ \u52a0\u4e00\uff0c\u7b54\u6848\u5c31\u589e\u52a0 $con2_r - con1_r$\uff08$r$ \u6b64\u65f6\u8fd8\u6ca1\u589e\u52a0\uff09\uff0c\u82e5 $\\begin{bmatrix} \\vec{v_r} & \\vec{v_{r+1}} \\\\\\end{bmatrix} = \\begin{bmatrix}1 & 1  \\\\0 & 1 \\\\1 & 1 \\\\\\end{bmatrix}$\uff0c\u5219\u5206\u7c7b\u8ba8\u8bba $lf_r$\uff0c\u82e5 $lf_r \\geq l$\uff0c\u5219\u8bf4\u660e\u5b58\u5728\u4e00\u4e2a\u4e0b\u6807 $lf_r$\uff0c\u6709 $\\vec{v_i} = \\begin{bmatrix}1\\\\1\\\\1\\end{bmatrix}$\uff0c\u4e14 $lf_r$ \u5230 $r$ \u90fd\u4e3a $\\begin{bmatrix}1\\\\0\\\\1\\end{bmatrix}$\uff0c\u4e5f\u5c31\u662f\u8bf4 $\\vec{r}$ \u4e0a\u4e0b\u4e24\u8fb9\u5df2\u7ecf\u8054\u901a\u4e86\uff0c\u6b64\u65f6 $\\vec{r + 1}$ \u5bf9\u7b54\u6848\u65e0\u8d21\u732e\uff0c\u5426\u5219\u7b54\u6848 $- 1$\u3002\n\n\u4e0b\u9762\u7ed9\u51fa\u79fb\u52a8\u6307\u9488\u7684\u4ee3\u7801\u3002\n\n```cpp\nvoid addl() {\n    if (f(l, 1, 1, 1, 1, 0, 1) && rt[l + 1] <= r) {\n        // do nothing\n    } else {\n        cnt -= con2[l];\n        cnt += con1[l + 1];\n    }\n    l++;\n}\n\nvoid addr() {\n    if (f(r, 1, 0, 1, 1, 1, 1) && lf[r] >= l) {\n        // do nothing\n    } else {\n        cnt -= con1[r];\n        cnt += con2[r];\n    }\n    r++;\n}\n\nvoid minl() {\n    if (f(l - 1, 1, 1, 1, 1, 0, 1) && rt[l] <= r) {\n        // do nothing\n    } else {\n        cnt -= con1[l];\n        cnt += con2[l - 1];\n    }\n    l--;\n}\n\nvoid minr() {\n    if (f(r - 1, 1, 0, 1, 1, 1, 1) && lf[r - 1] >= l) {\n        // do nothing\n    } else {\n        cnt -= con2[r - 1];\n        cnt += con1[r - 1];\n    }\n    r--;\n}\n```\n\n\u5269\u4e0b\u7684\u5c31\u662f\u83ab\u961f\u7684\u57fa\u672c\u64cd\u4f5c\u4e86\u3002\n\n\u7531\u4e8e\u6570\u636e\u8303\u56f4\u8f83\u5927\uff0c\u8fd9\u91cc\u8bb2\u4e00\u4e9b\u5361\u5e38\u6280\u5de7\u3002\n\n1. \u83ab\u961f\u5947\u5076\u4f18\u5316\u3002\n\n```cpp\nstruct Query {\n    int l, r, id, ans;\n    bool operator < (const Query &q) const {\n        if (belong[l] != belong[q.l]) {\n            return belong[l] < belong[q.l];\n        } else {\n            if (belong[l] & 1) return r < q.r;\n            else return r > q.r;\n        }\n    }\n} q[M];\n```\n\n2. \u4f7f\u7528\u5feb\u901f IO\u3002\n\n3. \u5728\u83ab\u961f\u5206\u5757\u65f6\uff0c\u5c3d\u53ef\u80fd\u5c11\u5730\u4f7f\u7528\u5f00\u65b9\u4e0e\u9664\u6cd5\u3002\n\n```cpp\nvoid init() {\n    int block = sqrt(n);\n    int cnt = 0;\n    for (register int i = 1; i <= n; i++) {\n        cnt++;\n        belong[i] = belong[i - 1];\n        if (cnt == block) {\n            belong[i]++;\n            cnt = 0;\n        }\n    }\n}\n```\n\n4. \u5f00\u706b\u8f66\u5934\u3002\n\n[\u6700\u7ec8\u4ee3\u7801](https://www.luogu.com.cn/paste/3rsq6py6)\u3002\n\n\u8fd9\u6837\u901f\u5ea6\u5feb\u5f97\u98de\u8d77\uff0c\u5728 $m = 300000$ \u65f6\u90fd\u4ee5\u5728 1809ms \u5185\u5361\u8fc7\u3002",
        "postTime": 1650681925,
        "uid": 224978,
        "name": "optimize_2",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF1661E Narrow Components"
    },
    {
        "content": "\u9898\u76ee\u5927\u610f\uff1a\u7ed9\u51fa\u4e00\u4e2a $3$ \u884c $n$ \u5217\u7684 $0/1$ \u77e9\u9635\uff0c $q$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u6b21\u8be2\u95ee\u6c42\u51fa $l$ \u5230 $r$ \u5217\u5168\u4e3a1\u7684\u56db\u8054\u901a\u5757\u7684\u6570\u91cf\u3002\n\n\u7ed9\u51fa\u4e00\u4e2a\u5206\u6cbb\u601d\u8def\u3002\n\n\u9996\u5148\u6709\u4e00\u4e2a $qn\u03b1(n)$ \u7684\u601d\u8def\u5373\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5217\uff0c\u7528\u5e76\u67e5\u96c6\u5408\u5e76\u3002\u8003\u8651\u4e00\u5217\u4e00\u5217\u5408\u5e76\u7684\u8fc7\u7a0b\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u53bb\u4f18\u5316\u6210\u5206\u6cbb\u540e\u6574\u4f53\u5408\u5e76\u7684\u8fc7\u7a0b\u3002\n\n\u663e\u7136\u6211\u4eec\u53ef\u4ee5\u626b\u4e00\u904d\u6c42\u51fa\u4ece $mid$ \u5217\u5408\u5e76\u5230\u4efb\u610f\u4e00\u4e2a $i(i<=mid)$ \u5217\u7684\u7b54\u6848\u4e3a $ans_i$ \u662f\u591a\u5c11\uff0c\u4ee5\u53ca $mid+1$ \u5408\u5e76\u5230\u4efb\u610f\u4e00\u4e2a $i(i>mid)$ \u884c\u7684\u7b54\u6848 $ans_i$ \u662f\u591a\u5c11\u3002\n\n\u8003\u8651\u4e00\u4e2a $l<=mid,r>mid$ \u7684\u8be2\u95ee\u7b54\u6848\u76f8\u6bd4 $ans_l+ans_r$ \u6709\u4ec0\u4e48\u6539\u53d8\uff0c\u53ef\u4ee5\u53d1\u73b0\u6211\u4eec\u53ea\u662f\u7701\u53bb\u4e86\u5408\u5e76 $mid$ \u5217\u548c $mid+1$ \u5217\u7684\u8fc7\u7a0b\uff0c\u53c8\u56e0\u4e3a\u6211\u4eec\u7684\u5408\u5e76\u53ea\u6709\u5173\u5408\u5e76\u5230 $l$ \u65f6\u7b2c $mid$ \u5217\u7684 $fa$ \u6709\u5173\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u6bcf\u6b21\u5408\u5e76\u5230 $i$ \u65f6 $mid$ \u6216 $mid+1$ \u5217\u6240\u6709\u503c\u7684 $fa$ \u8bb0\u5f55\u4e0b\u6765\uff0c\u7136\u540e\u6a21\u62df\u4e00\u6b21\u5408\u5e76\u5373\u53ef\uff0c\u8be2\u95ee\u603b\u7684\u590d\u6742\u5ea6\u662f $q\u03b1(n)$ \u7684\u3002\n\n\u603b\u7684\u590d\u6742\u5ea6\u662f\u5206\u6cbb\u7684\u590d\u6742\u5ea6\u52a0\u8be2\u95ee\u5373 $nlogn+q\u03b1(n)$\n\n\u8fd9\u79cd\u505a\u6cd5\u62d3\u5c55\u5230$n*m$\u7684\u77e9\u9635\u8303\u56f4\u590d\u6742\u5ea6\u53ef\u4ee5\u505a\u5230 $nmlogn+qn\u03b1(n)$ \uff0c\u7136\u540e\u6700\u521d\u7684\u66b4\u529b\u5b58\u4e00\u4e0b\u6240\u6709\u7b54\u6848\u7684\u503c\u53ef\u4ee5\u505a\u5230 $m^2\u03b1(n)+q$ \u3002\u56e0\u6b64\u5bf9\u4e8e $nm<=1e5$ \u7684\u77e9\u9635\u53ef\u4ee5\u6839\u53f7\u5206\u6cbb\u4e00\u4e0b\u4e5f\u80fd\u6c42\u89e3\u3002\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N=1.6e6+10;\nint fa[N],ans[N],f[4][N],n,L[N],R[N];char s[4][N];\nstruct Q\n{\n\tint x,y,pos;\n};vector<Q>g[N];\nint id(int x,int y){return (x-1)*n+y;}\nint find(int x)\n{\n\tif(x==fa[x]) return x;\n\treturn fa[x]=find(fa[x]);\n}\nint merge(int u,int v)\n{\n\tu=find(u),v=find(v);\n\tif(u==v) return 0;\n\treturn fa[u]=v,1;\n}\nvoid add(int p,int l,int r,int ll,int rr,int pos)\n{\n\tint mid=l+r>>1;\n\tif(ll<=mid&&rr>mid||l==r)\n\t{\n\t\tg[p].push_back((Q){ll,rr,pos});\n\t\treturn;\n\t}\n\tif(ll<=mid) add(p<<1,l,mid,ll,rr,pos);\n\telse add(p<<1|1,mid+1,r,ll,rr,pos);\n}\nvoid solve(int p,int l,int r)\n{\n\tif(l==r)\n\t{\n\t\tint sum=0;\n\t\tfor(int i=1;i<=3;i++)\n\t\t{\n\t\t\tif(s[i][l]=='1') sum++;\n\t\t\tif(s[i][l]=='1'&&s[i-1][l]=='1') sum--;\n\t\t}\n\t\tfor(int i=0;i<g[p].size();i++)\n\t\t\tans[g[p][i].pos]=sum;\n\t\treturn;\n\t}\n\tint mid=l+r>>1;L[mid+1]=R[mid]=0;\n\tfor(int i=mid;i>=l;i--)\n\t{\n\t\tL[i]=L[i+1];\n\t\tfor(int j=1;j<=3;j++)\n\t\t\tif(s[j][i]=='1')\n\t\t\t\tL[i]++,fa[id(j,i)]=id(j,i);\n\t\tfor(int j=1;j<=2;j++)\n\t\t\tif(s[j][i]=='1'&&s[j+1][i]=='1')\n\t\t\t\tL[i]-=merge(id(j,i),id(j+1,i));\n\t\tif(i<mid)\n\t\t\tfor(int j=1;j<=3;j++)\n\t\t\t\tif(s[j][i]=='1'&&s[j][i+1]=='1')\n\t\t\t\t\tL[i]-=merge(id(j,i),id(j,i+1));\n\t\tfor(int j=1;j<=3;j++)\n\t\t\tf[j][i]=find(id(j,mid));\n\t}\n\tfor(int i=mid+1;i<=r;i++)\n\t{\n\t\tR[i]=R[i-1];\n\t\tfor(int j=1;j<=3;j++)\n\t\t\tif(s[j][i]=='1')\n\t\t\t\tR[i]++,fa[id(j,i)]=id(j,i);\n\t\tfor(int j=1;j<=2;j++)\n\t\t\tif(s[j][i]=='1'&&s[j+1][i]=='1')\n\t\t\t\tR[i]-=merge(id(j,i),id(j+1,i));\n\t\tif(i>mid+1)\n\t\t\tfor(int j=1;j<=3;j++)\n\t\t\t\tif(s[j][i]=='1'&&s[j][i-1]=='1')\n\t\t\t\t\tR[i]-=merge(id(j,i),id(j,i-1));\n\t\tfor(int j=1;j<=3;j++)\n\t\t\tf[j][i]=find(id(j,mid+1));\n\t}\n\tfor(int i=0;i<g[p].size();i++)\n\t{\n\t\tint u=g[p][i].x,v=g[p][i].y;\n\t\tans[g[p][i].pos]=L[u]+R[v];\n\t\tfor(int j=1;j<=3;j++) fa[f[j][u]]=f[j][u],fa[f[j][v]]=f[j][v];\n\t\tfor(int j=1;j<=3;j++)\n\t\t\tif(s[j][mid]=='1'&&s[j][mid+1]=='1')\n\t\t\t\tans[g[p][i].pos]-=merge(f[j][u],f[j][v]);\n\t}\n\tsolve(p<<1,l,mid);\n\tsolve(p<<1|1,mid+1,r);\n}\nint main()\n{\n\tint q;\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=3;i++)\n\t\tscanf(\"%s\",s[i]+1);\n\tscanf(\"%d\",&q);\n\tfor(int i=1,l,r;i<=q;i++)\n\t{\n\t\tscanf(\"%d %d\",&l,&r);\n\t\tadd(1,1,n,l,r,i);\n\t}\n\tsolve(1,1,n);\n\tfor(int i=1;i<=q;i++)\n\t\tprintf(\"%d\\n\",ans[i]);\n}\n",
        "postTime": 1649944333,
        "uid": 80296,
        "name": "\u53ea\u9e45\u70e7\u70e4\u4e8c\u5ea6",
        "ccfLevel": 0,
        "title": "CF1661E Narrow Components"
    },
    {
        "content": "### $\\text{Difficulty : 2500}$\n---\n### \u89e3\u9898\u601d\u8def\uff1a\n\u8003\u8651\u6bcf\u4e00\u4e2a\u8054\u901a\u5757\u7684\u751f\u6210\u6811\uff0c\u6bcf\u6709\u4e00\u6761\u8fb9\u5c31\u53ef\u4ee5\u51cf\u5c11\u4e00\u4e2a\u8054\u901a\u5757\uff0c\u5982\u679c\u53ef\u4ee5\u7edf\u8ba1\u51fa\u533a\u95f4\u5185\u751f\u6210\u6811\u68ee\u6797\u7684\u8fb9\u7684\u6570\u91cf\uff0c\u518d\u7ed3\u5408\u7528\u524d\u7f00\u548c\u7edf\u8ba1\u51fa\u7684\u70b9\u7684\u6570\u91cf\u5c31\u80fd\u5feb\u901f\u8ba1\u7b97\u51fa\u8054\u901a\u5757\u7684\u6570\u91cf\u3002\u8fd9\u79cd\u601d\u8def\u4e4d\u4e00\u770b\u5b8c\u5168\u4e0d\u53ef\u884c\uff0c\u4f46\u7531\u4e8e\u662f $\\text{Educational Round}$\uff0c\u88ab\u6559\u80b2\u4e86\u4e00\u79cd\u5168\u65b0\u7684\u601d\u8def\u634f\u3002\n\n\u5982\u679c\u4f18\u5148\u52a0\u5165\u884c\u4e0e\u884c\u4e4b\u95f4\u6709\u516c\u5171\u8fb9\u7684\uff0c\u7136\u540e\u518d\u52a0\u5165\u5217\u4e0e\u5217\u4e4b\u95f4\u7684\u80fd\u591f\u51cf\u5c11\u8054\u901a\u5757\u7684\u8fb9\uff0c\u5c31\u80fd\u5f88\u597d\u5730\u9002\u5e94\u5bf9\u4e8e\u6574\u5217\u5230\u6574\u5217\u7684\u67e5\u8be2\u8981\u6c42\u4e86\u3002\n\n\u4f46\u662f\u8fd9\u6837\u5e76\u4e0d\u80fd\u5e94\u5bf9\u4ece\u4e0a\u5f80\u4e0b\u4e3a $101$ \u7684\u60c5\u51b5\uff0c\u7531\u4e8e\u8fd9\u79cd\u60c5\u51b5\u4e0b\u5982\u679c\u4e4b\u524d\u5df2\u7ecf\u88ab\u8fde\u63a5\u8fc7\uff0c\u5219\u5728\u540e\u9762\u7684\u53ef\u80fd\u7684\u94fe\u63a5\u4e2d\u5c31\u4e0d\u4f1a\u88ab\u8ba1\u7b97\u3002\u4f46\u662f\u540c\u65f6\u4e5f\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e5f\u662f\u552f\u4e00\u7684\u53ef\u80fd\u51fa\u73b0\u7684\u9519\u8bef\uff0c\u4e5f\u5c31\u662f\u53ea\u6709\u6700\u5de6\u7aef\u51fa\u73b0\u8fd9\u6837\u7684\u60c5\u51b5\u7684\u65f6\u5019\u53ef\u80fd\u4f1a\u51fa\u5dee\u9519\u3002\u90a3\u5c31\u76f4\u63a5\u5bf9\u4e8e\u6700\u5de6\u8fb9\u4e3a $101$ \u7684\u8be2\u95ee\u5206\u60c5\u51b5\u8ba8\u8bba\u4e00\u4e0b\u524d\u9762\u7684\u4e00\u957f\u4e32 $101$ \u4f1a\u989d\u5916\u4ea7\u751f\u591a\u5c11\u8054\u901a\u5757\u5c31\u884c\u4e86\u3002\n\n\u8bb0\u5f55\u4e0b\u6bcf\u4e00\u4e2a\u4f4d\u7f6e\u7684\u4e0b\u4e00\u4e2a\u4e0d\u662f $101$ \u7684\u4f4d\u7f6e\uff0c\u4e0d\u59a8\u8bb0\u4e3a $next$\u3002\u90a3\u4e48\u6709\u5177\u4f53\u7684\u60c5\u51b5\uff1a\n\n1. $next$ \u8d85\u8fc7\u7684\u6700\u53f3\u7aef\uff0c\u4e5f\u5c31\u662f\u6574\u4e2a\u533a\u95f4\u90fd\u662f $101$\uff0c\u663e\u7136\u6574\u4e2a\u533a\u95f4\u4e0a\u53ea\u6709 $2$ \u4e2a\u8054\u901a\u5757\u3002\u8ba8\u8bba\u8fd9\u79cd\u60c5\u51b5\u662f\u56e0\u4e3a\u4e0b\u4e00\u4e2a\u4f4d\u7f6e\u4e0d\u5728\u533a\u95f4\u5185\u5e76\u4e0d\u65b9\u4fbf\u653e\u5728\u4e0b\u9762\u7684\u4e09\u79cd\u4e00\u822c\u7684\u60c5\u51b5\u4e2d\u8ba8\u8bba\u3002\n2. $next$ \u4e3a $000$ \u6216\u8005 $010$\uff0c\u6b64\u65f6\u4ea7\u751f\u4e24\u4e2a\u8054\u901a\u5757\u3002\n3. $next$ \u4e3a $111$\uff0c\u6b64\u65f6\u524d\u9762\u7684 $101$ \u5b8c\u5168\u5e76\u5165\u540e\u9762\uff0c\u4e0d\u4ea7\u751f\u65b0\u7684\u8054\u901a\u5757\u3002\n4. $next$ \u4e3a $110$ \u6216\u8005 $011$\uff0c\u6b64\u65f6\u4ea7\u751f\u4e00\u4e2a\u989d\u5916\u8054\u901a\u5757\u3002\n\n\u603b\u590d\u6742\u5ea6 $O(n\\log n)$\uff0c\u9700\u8981\u4f7f\u7528\u5e76\u67e5\u96c6\u3002\n\n---\n### \u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\nusing namespace std;\nconst int MAXN=1500005;\nint num[5][MAXN],fa[MAXN],sum[MAXN],H[MAXN],V[MAXN],Q,x,y,NXT[MAXN],nxt,ans,n;\nint find(int now){\n\tif(fa[now]==now)return now;\n\treturn fa[now]=find(fa[now]);\n}\nbool merge(int x,int y){\n\tif(find(x)!=find(y)){\n\t\tfa[find(x)]=find(y);\n\t\treturn 1;\n\t}\n\treturn 0;\n}\nint NUM(int x,int y){\n\treturn n*(x-1)+y;\n}\nvoid READ(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=3;i++)\n\tfor(int j=1;j<=n;j++)\n\tscanf(\"%1d\",&num[i][j]);\n}\nvoid INIT(){\n\tfor(int i=1;i<=3*n;i++)fa[i]=i;\n\t\n\tfor(int i=1;i<=n;i++)\n\tfor(int j=1;j<=3;j++)\n\tsum[i]+=num[j][i];\n\tfor(int i=1;i<=n;i++)\n\tsum[i]+=sum[i-1];\n\t\n\tfor(int i=1;i<=2;i++)\n\tfor(int j=1;j<=n;j++)\n\tif(num[i][j]==1&&num[i+1][j]==1)\n\tH[j]+=merge(NUM(i,j),NUM(i+1,j));\n\tfor(int i=1;i<=n;i++)\n\tH[i]+=H[i-1];\n\t\n\tfor(int i=1;i<=3;i++)\n\tfor(int j=2;j<=n;j++)\n\tif(num[i][j]==1&&num[i][j-1]==1)\n\tV[j]+=merge(NUM(i,j),NUM(i,j-1));\n\tfor(int i=1;i<=n;i++)\n\tV[i]+=V[i-1];\n\t\n\tfor(int i=n;i>=1;i--){\n\t\tif(num[1][i]==1&&num[2][i]==0&&num[3][i]==1)NXT[i]=NXT[i+1]+1;\n\t\telse NXT[i]=0;\n\t}\n}\nint work(int l,int r){\n\tnxt=l+NXT[x];\n\tif(nxt>y)return 2;\n\tans=sum[r]-sum[nxt-1]-H[r]+H[nxt-1]-V[r]+V[nxt];\n\tif(nxt!=l){\n\t\tif(num[1][nxt]==1&&num[2][nxt]==1&&num[3][nxt]==1);\n\t\telse if(num[1][nxt]==0&&num[3][nxt]==0)ans+=2;\n\t\telse ans++;\n\t}\n\treturn ans;\n}\nint main(){\n\tREAD();\n\tINIT();\n\tscanf(\"%d\",&Q);\n\twhile(Q--){\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tprintf(\"%d\\n\",work(x,y));\n\t}\n\treturn 0;\n}\n```\n",
        "postTime": 1649671323,
        "uid": 223559,
        "name": "qxp101",
        "ccfLevel": 6,
        "title": "CF1661E Narrow Components \u9898\u89e3"
    },
    {
        "content": "\u79bb\u7ebf\uff0c\u626b\u63cf\u7ebf\u626b\u63cf\u53f3\u7aef\u70b9\uff0c\u7528\u6570\u636e\u7ed3\u6784\u7ef4\u62a4\u6bcf\u4e2a\u5de6\u7aef\u70b9\u7684\u7b54\u6848\u3002\n\n\u6bcf\u884c\u7684\u516b\u79cd\u72b6\u6001\u91cc\u9762\uff0c\u53ea\u6709\u4e00\u79cd\u72b6\u6001\u4f1a\u8ba9\u8fde\u901a\u5757\u6570\u91cf\u51cf\u5c11\uff0c\u5176\u4ed6\u4e0d\u4f1a\u51cf\u5c11\u7684\u60c5\u51b5\u8981\u4e48\u662f\u5355\u70b9 $+1/+2$\uff0c\u8981\u4e48\u662f\u524d\u7f00 $+1/+2$\uff0c\u5bb9\u6613\u7ef4\u62a4\u3002\n\n\u8003\u8651\u552f\u4e00\u4e00\u79cd\u8fde\u901a\u5757\u6570\u91cf\u51cf\u5c11\u7684\u60c5\u51b5\uff1a\n\n```\n...1111....\n...0001....\n...0111....\n```\n\n\u8fd9\u6837\u6211\u4eec\u5728\u626b\u63cf\u7ebf\u7684\u65f6\u5019\u4f1a\u5408\u5e76\u4e0a\u4e0b\u4e24\u5217\uff0c\u8fde\u901a\u5757\u6570\u91cf\u4f1a\u51cf\u5c11 $1$\u3002\n\n\u6240\u4ee5\u5e94\u8be5\u524d\u7f00 $-1$ \u5417\uff1f\n\n\u8003\u8651\u8fd9\u79cd\u60c5\u51b5\uff1a\n\n```\n11111\n01001\n01111\n```\n\n\u626b\u63cf\u5230\u7b2c\u4e94\u5217\u7684\u65f6\u5019\uff0c\u53ea\u6709\u7b2c $3\\sim 5$ \u5217\u8fde\u901a\u5757\u6570\u91cf\u51cf\u5c11\u4e86 $1$\uff0c\u56e0\u4e3a\u7b2c\u4e00\u5217\u548c\u7b2c\u4e8c\u5217\u5728\u524d\u9762\u5c31\u5df2\u7ecf\u8fde\u8d77\u6765\u4e86\u3002\n\n\u6240\u4ee5\u9700\u8981\u989d\u5916\u8bb0\u5f55\u4e00\u4e2a\u53d8\u91cf $lst$ \u8868\u793a\u5f53\u524d\u8fde\u901a\u5757\u4e0a\u4e00\u6b21\u67d0\u4e00\u5217\u51fa\u73b0 ```111``` \u662f\u4ec0\u4e48\u65f6\u5019\uff08\u6ca1\u6709\u8bbe\u7f6e\u6210 $0$\uff09\uff0c\u626b\u63cf\u5230\u7b2c $i$ \u5217\u5408\u5e76\u7684\u65f6\u5019\u7ed9 $[lst+1,i-1]$ \u8fd9\u4e2a\u533a\u95f4\u8fde\u901a\u5757\u6570\u91cf $-1$ \u5373\u53ef\u3002\n\n\u6570\u636e\u7ed3\u6784\u64cd\u4f5c\u53ea\u6709\u533a\u95f4\u4fee\u6539\u5355\u70b9\u67e5\u8be2\uff0c\u76f4\u63a5\u4f7f\u7528\u6811\u72b6\u6570\u7ec4\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n)$\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<string>\n#include<vector>\nusing namespace std;\nstring s;\nint n,m,a[500001][3],lst,sum[500001],ans[500001];\nvector<pair<int,int> > v[500001];\ninline int read()\n{\n    int x=0;\n    char c=getchar();\n    while(c<'0'||c>'9')\n        c=getchar();\n    while(c>='0'&&c<='9')\n    {\n        x=(x<<1)+(x<<3)+(c^48);\n        c=getchar();\n    }\n    return x;\n}\ninline int lowbit(int x)\n{\n    return x&-x;\n}\ninline void update(int x,int val)\n{\n    for(;x<=n;x+=lowbit(x))\n        sum[x]+=val;\n}\ninline int query(int x)\n{\n    int res=0;\n    for(;x;x-=lowbit(x))\n        res+=sum[x];\n    return res;\n}\nint main()\n{\n    n=read();\n    for(int i=0;i<3;++i)\n    {\n        cin>>s;\n        s=\" \"+s;\n        for(int j=1;j<=n;++j)\n            a[j][i]=s[j]-'0';\n    }\n    m=read();\n    for(int i=1;i<=m;++i)\n    {\n        int l=read(),r=read();\n        v[r].emplace_back(l,i);\n    }\n    for(int i=1;i<=n;++i)\n    {\n        if(!a[i][0]&&!a[i][1]&&!a[i][2])\n            lst=0;\n        if(a[i][0]&&!a[i][1]&&!a[i][2])\n        {\n            update(i,1);\n            update(i+1,-1);\n            if(!a[i-1][0])\n            {\n                lst=0;\n                update(1,1);\n                update(i,-1);\n            }\n        }\n        if(!a[i][0]&&a[i][1]&&!a[i][2])\n        {\n            update(i,1);\n            update(i+1,-1);\n            if(!a[i-1][1])\n            {\n                lst=0;\n                update(1,1);\n                update(i,-1);\n            }\n        }\n        if(!a[i][0]&&!a[i][1]&&a[i][2])\n        {\n            update(i,1);\n            update(i+1,-1);\n            if(!a[i-1][2])\n            {\n                lst=0;\n                update(1,1);\n                update(i,-1);\n            }\n        }\n        if(a[i][0]&&a[i][1]&&!a[i][2])\n        {\n            update(i,1);\n            update(i+1,-1);\n            if(!a[i-1][0]&&!a[i-1][1])\n            {\n                lst=0;\n                update(1,1);\n                update(i,-1);\n            }\n        }\n        if(a[i][0]&&!a[i][1]&&a[i][2])\n        {\n            update(i,2);\n            update(i+1,-2);\n            if(!a[i-1][0])\n            {\n                lst=0;\n                update(1,1);\n                update(i,-1);\n            }\n            if(!a[i-1][2])\n            {\n                lst=0;\n                update(1,1);\n                update(i,-1);\n            }\n        }\n        if(!a[i][0]&&a[i][1]&&a[i][2])\n        {\n            update(i,1);\n            update(i+1,-1);\n            if(!a[i-1][1]&&!a[i-1][2])\n            {\n                lst=0;\n                update(1,1);\n                update(i,-1);\n            }\n        }\n        if(a[i][0]&&a[i][1]&&a[i][2])\n        {\n            update(i,1);\n            update(i+1,-1);\n            if(!a[i-1][0]&&!a[i-1][1]&&!a[i-1][2])\n            {\n                update(1,1);\n                update(i,-1);\n            }\n            else if(a[i-1][0]&&!a[i-1][1]&&a[i-1][2])\n            {\n                update(lst+1,-1);\n                update(i,1);\n            }\n            lst=i;\n        }\n        for(auto j:v[i])\n            ans[j.second]=query(j.first);\n    }\n    for(int i=1;i<=m;++i)\n        cout<<ans[i]<<'\\n';\n    return 0;\n}\n```",
        "postTime": 1661741165,
        "uid": 85682,
        "name": "\u7edd\u9876\u6211\u4e3a\u5cf0",
        "ccfLevel": 8,
        "title": "CF1661E Narrow Components \u9898\u89e3"
    },
    {
        "content": "## \u9898\u76ee\u5927\u610f\n\n\u7ed9\u51fa\u4e00\u4e2a $n(1 \\le n \\le 5\\times 10^5)$ \u884c $3$ \u5217\u7684 $01$ \u77e9\u9635\uff0c$m(1\\le m \\le 3\\times 10^5)$ \u6b21\u8be2\u95ee\u7b2c $l$ \u5217\u5230\u7b2c $r$ \u5217\u7684\u5b50\u77e9\u9635\u4e2d\u6709\u591a\u5c11\u4e2a $1$ \u7684\u8fde\u901a\u5757\u3002\n\n## \u7b80\u8981\u505a\u6cd5\n\n\u8d5b\u65f6\u7b2c\u4e00\u773c\uff1a\u8fd9\u4e0d SB \u9898\u5417\uff1f\u76f4\u63a5\u83ab\u961f\uff0c\u4e00\u6b21\u52a0\u5165\u6216\u8005\u5220\u9664\u4e00\u5217\u7684\u8d21\u732e\u53ea\u548c\u5b83\u5de6\u8fb9\u6216\u8005\u53f3\u8fb9\u7684\u4e00\u5217\u6709\u5173\uff0c\u6240\u4ee5\u53ea\u9700\u8981\u9884\u5904\u7406\u51fa $64$ \u4e2d\u60c5\u51b5\uff0c\u7136\u540e\u83ab\u961f\u5c31\u884c\u3002\n\n\u6253\u4e86\u4e2a\u83ab\u961f\u4ea4\u4e0a\u53bb\u7ed3\u679c WA on test 1\uff0c\u53d1\u73b0\u83ab\u961f\u505a\u6cd5\u4e2d\u300c\u4e00\u5217\u7684\u8d21\u732e\u53ea\u548c\u5b83\u5de6\u8fb9\u6216\u8005\u53f3\u8fb9\u7684\u4e00\u5217\u6709\u5173\u300d\u662f\u5047\u7684\uff0c\u8003\u8651\u8fd9\u6837\u4e00\u79cd\u60c5\u51b5\uff1a\n\n```plain\n111\n001\n111\n```\n\n\u5047\u8bbe\u6211\u4eec\u8be2\u95ee $[1,3]$\uff0c\u5219\u83ab\u961f\u53f3\u7aef\u70b9\u626b\u5230 $3$ \u7684\u65f6\u5019\uff0c\u521a\u624d\u7684\u7b97\u6cd5\u4f1a\u8ba1\u7b97 `101` \u548c `111` \u7ed3\u5408\uff0c\u65b0\u6210 $0$ \u4e2a\u8fde\u901a\u5757\u3002\u4e8b\u5b9e\u4e0a\uff0c\u52a0\u5165 $4$ \u540e\u4f1a\u628a\u4e0a\u4e0b\u4e24\u8fb9\u7684\u8fde\u901a\u5757\u5408\u5e76\uff0c\u5bf9\u7b54\u6848\u8d21\u732e\u4e3a $-1$\u3002\n\n\u8003\u8651\u66f4\u6362\u505a\u6cd5\u3002\u770b\u5230\u8fde\u901a\u5757\u4e2a\u6570\uff0c\u60f3\u5230\u4f7f\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u3002\u770b\u5230\u533a\u95f4\u8be2\u95ee\uff0c\u60f3\u5230\u7ebf\u6bb5\u6811\u7ef4\u62a4\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u8ba9\u7ebf\u6bb5\u6811\u91cc\u7684\u4e00\u4e2a\u8282\u70b9\u7ef4\u62a4\u5bf9\u5e94\u5217\u533a\u95f4\u7684\u5e76\u67e5\u96c6\u3002\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u5408\u5e76 $O(\\log n)$ \u4e2a\u5e76\u67e5\u96c6\uff0c\u5f97\u5230\u8fde\u901a\u5757\u4e2a\u6570\u540e\uff0c\u518d\u5c06\u5e76\u67e5\u96c6\u7684\u5408\u5e76\u64a4\u9500\u3002\n\n\u53d1\u73b0\u7ebf\u6bb5\u6811\u6709 $O(n)$ \u4e2a\u8282\u70b9\uff0c\u5982\u679c\u7ed9\u6bcf\u4e2a\u8282\u70b9\u5f00\u4e00\u4e2a\u503c\u57df $O(n)$ \u7684\u5e76\u67e5\u96c6\u5219\u7a7a\u95f4\u4f1a\u7206\u70b8\u3002\u8003\u8651\u540c\u4e00\u6df1\u5ea6\u7684\u7ebf\u6bb5\u6811\u8282\u70b9\u5bf9\u5e94\u7684\u533a\u95f4\u4e92\u76f8\u6ca1\u6709\u4ea4\u96c6\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba9\u8fd9\u4e9b\u8282\u70b9\u7ef4\u62a4\u7684\u5e76\u67e5\u96c6\u5171\u7528\u4e00\u4e2a `fa` \u6570\u7ec4\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6\u4e0b\u964d\u81f3 $O(n\\log n)$\u3002\n\n\u7531\u4e8e\u662f\u53ef\u64a4\u9500\u5e76\u67e5\u96c6\uff0c\u4e0d\u80fd\u6709\u8def\u5f84\u538b\u7f29\uff0c\u6240\u4ee5\u9700\u8981\u6309\u79e9\u5408\u5e76\u6765\u4fdd\u8bc1\u590d\u6742\u5ea6\u3002\n\n\u81f3\u6b64\uff0c\u6211\u4eec\u4ee5 $O(n\\log^2 n)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\uff0c$O(n \\log n)$ \u7684\u7a7a\u95f4\u590d\u6742\u5ea6\u89e3\u51b3\u4e86\u8fd9\u9053\u9898\u76ee\u3002\n\n[\u4ee3\u7801\u53c2\u8003](https://codeforces.com/contest/1661/submission/153521365)",
        "postTime": 1649833468,
        "uid": 207996,
        "name": "yzy1",
        "ccfLevel": 9,
        "title": "CF1661E \u9898\u89e3"
    },
    {
        "content": "## Analysis\n\n\u539f\u9898 [CF811E Vladik and Entertaining Flags](https://www.luogu.com.cn/problem/CF811E)\u3002\u8bf7\u5148\u9605\u8bfb [\u9898\u89e3 CF811E \u3010Vladik and Entertaining Flags\u3011\n](https://www.luogu.com.cn/blog/wsyear/solution-cf811e)\n\n\u4e24\u9898\u552f\u4e00\u7684\u4e0d\u540c\u70b9\u662f CF811F \u4e0d\u540c\u989c\u8272\u7684\u70b9\u90fd\u6709\u8d21\u732e\uff0c\u800c\u6b64\u9898\u53ea\u6709\u6570\u5b57 $1$ \u6709\u8d21\u732e\u3002\u56e0\u6b64\u5c06\u539f\u9898 $val+1$ \u7684\u5730\u65b9\u5168\u90e8\u4fee\u6539\u4e3a $val+a_{i,j}$ \u5373\u53ef\u3002\n\n## Code\n\n**Talk is cheap, show me the code.**\n\n[Codeforces Status](https://codeforces.com/contest/1661/submission/153385286)\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define For(i,j,k) for(int i=(j);i<=(k);i++)\n#define Rof(i,j,k) for(int i=(j);i>=(k);i--)\n#define mid (l+r)/2\nint n,m,q,a[4][500010],tot=0,fa[1500010];\nstruct node{\n\tint l[4],r[4],val;\n}tr[2000010];\nint find(int x){return fa[x]==x?x:fa[x]=find(fa[x]);}\nnode add(node x,node y,int l,int r){\n\tnode res;res.val=x.val+y.val;\n\tFor(i,1,n) res.l[i]=x.l[i],res.r[i]=y.r[i];\n\tFor(i,1,n) fa[x.l[i]]=x.l[i],fa[x.r[i]]=x.r[i];\n\tFor(i,1,n) fa[y.l[i]]=y.l[i],fa[y.r[i]]=y.r[i];\n\tFor(i,1,n) if(a[i][l]==a[i][r]){\n\t\tint fx=find(x.r[i]),fy=find(y.l[i]);\n\t\tif(fx!=fy) res.val-=a[i][l],fa[fx]=fy;\n\t}\n\tFor(i,1,n) res.l[i]=find(res.l[i]),res.r[i]=find(res.r[i]);\n\treturn res;\n}\nvoid build(int c,int l,int r){\n\tif(l==r){\n\t\tFor(i,1,n){\n\t\t\tif(a[i][l]==a[i-1][l]) tr[c].l[i]=tr[c].r[i]=tr[c].l[i-1];\n\t\t\telse tr[c].l[i]=tr[c].r[i]=++tot,tr[c].val+=a[i][l];\n\t\t}\n\t\treturn;\n\t}\n\tbuild(c*2,l,mid),build(c*2+1,mid+1,r);\n\ttr[c]=add(tr[c*2],tr[c*2+1],mid,mid+1);\n}\nnode qry(int c,int l,int r,int x,int y){\n\tif(l==x&&r==y) return tr[c];\n\tif(y<=mid) return qry(c*2,l,mid,x,y);\n\tif(x>mid) return qry(c*2+1,mid+1,r,x,y);\n\telse return add(qry(c*2,l,mid,x,mid),qry(c*2+1,mid+1,r,mid+1,y),mid,mid+1);\n}\nsigned main(){\n\tios::sync_with_stdio(false),cin.tie(0);\n\tscanf(\"%d\",&m);n=3;\n\tFor(i,1,n) For(j,1,m) scanf(\"%1d\",&a[i][j]);\n\tbuild(1,1,m);\n\tscanf(\"%d\",&q);\n\twhile(q--){\n\t\tint l,r;scanf(\"%d%d\",&l,&r);\n\t\tcout<<qry(1,1,m,l,r).val<<'\\n';\n\t}\n}\n```",
        "postTime": 1649686686,
        "uid": 169574,
        "name": "Enucai",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1661E \u3010Narrow Components\u3011"
    },
    {
        "content": "\u6211\u770b\u5927\u5bb6\u7684\u7ebf\u6bb5\u6811\u505a\u6cd5\u90fd\u662f\u7ebf\u6bb5\u6811\u52a0\u5e76\u67e5\u96c6\n\n\u6211\u7ed9\u5927\u5bb6\u5e26\u6765\u7ebf\u6bb5\u6811\u4e0a\u533a\u95f4\u5408\u5e76\u7684\u505a\u6cd5\n\n----\n\n\u6211\u4eec\u8003\u8651\u5408\u5e76\u4e24\u4e2a\u533a\u95f4\n\n$sum = sum_{ls} + sum_{rs} - max(s - 1 ,0)$\n\n$s$ \u662f\u4e2d\u95f4\u5408\u5e76\u8fde\u901a\u5757\u7684\u6570\u91cf\n\n\u6613\u8bc1 $s$ \u53ea\u6709 $0,1,2$ \u4e09\u79cd\u60c5\u51b5\n\n1. $s=0$ \u90fd\u4e0d\u8fde\u901a\n\n2. $s=1$ \u5de6\u8fb9\u4e00\u4e2a\u8fde\u901a\u5757\u548c\u53f3\u8fb9\u4e00\u4e2a\u8fde\u901a\u5757\u8fde\u63a5\n\n3. $s=2$ \u591a\u4e8e\u4e24\u4e2a\u8fde\u901a\u5757\u8054\u901a\n\n\u5176\u4e2d $s=2$ \u7684\u60c5\u51b5\u4e2d\u5de6\u53f3\u63a5\u89e6\u53ea\u6709\u4e09\u79cd\u60c5\u51b5\n\n1. \u5de6\u53f3\u533a\u95f4\u5171\u6709 $4$ \u4e2a\u8fde\u901a\u5757\n\n2. \u5de6\u533a\u95f4\u6709\u4e24\u4e2a\uff0c\u53f3\u533a\u95f4\u6709\u4e00\u4e2a\u4e14\u540c\u65f6\u4e0e\u5de6\u8fb9\u7684\u4e24\u4e2a\u8054\u901a\n\n3. \u540c\u4e0a\uff0c\u53f3\u533a\u95f4\u6709\u4e24\u4e2a\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u7ef4\u62a4\u6bcf\u4e2a\u533a\u95f4\u5de6\u7aef\u70b9\u548c\u53f3\u7aef\u70b9\u7684 $1$ \u7684\u5206\u5e03\u60c5\u51b5\u548c\u8fde\u901a\u5757\u6570\u91cf\n\n\u5176\u4e2d\u60c5\u51b5 $2,3$ \u8fd8\u6709\u5de6\u533a\u95f4\u6216\u53f3\u533a\u95f4\u4e0a\u9762\u4e00\u6392\u548c\u4e0b\u9762\u4e00\u6392\u5168\u662f $1$ \u7684\u60c5\u51b5\n\n\u8fd9\u79cd\u60c5\u51b5\u53d1\u751f\u65f6\u8fd8\u8981\u5c06\u5de6\u7aef\u70b9\u6216\u53f3\u7aef\u70b9\u7684\u8fde\u901a\u5757\u6570\u91cf\u66f4\u65b0\u4e3a $1$\n\n\u4ee3\u7801\u5982\u4e0b\n\n```cpp\n#include <bits/stdc++.h>\ninline int read() {\n\tint x = 0, c = getchar(), f = 1;\n\twhile (c < '0' || c > '9') { if (c == '-') f = -f; c = getchar(); }\n\twhile (c >= '0' && c <= '9') x = (x << 1) + (x << 3) + (c ^ 48), c = getchar();\n\treturn x * f;\n}\n\nconst int N = 5e5 + 100;\nconst int g[] = {0, 1, 1, 1, 1, 2, 1, 1};\nint f[N];\n\nstruct node {\n\tint sum, l, r, lsum, rsum;\n\tnode(int sum = 0, int l = 0, int r = 0, int lsum = 0, int rsum = 0) : sum(sum), l(l), r(r), lsum(lsum), rsum(rsum) {}\n\tfriend node operator + (const node &a, const node &b) {\n\t\tnode c(a.sum + b.sum, a.l, b.r, a.lsum, b.rsum);\n\t\tif (((a.r & b.l) == a.r) && a.rsum == 2) {\n\t\t\tc.sum -= 2;\n\t\t\tif (b.lsum == 1 && a.sum == 2 && a.lsum == 2) c.lsum = 1;\n\t\t} else if (((a.r & b.l) == b.l) && b.lsum == 2) {\n\t\t\tc.sum -= 2;\n\t\t\tif (a.rsum == 1 && b.sum == 2 && b.rsum == 2) c.rsum = 1;\n\t\t} else if (a.r & b.l) c.sum -= 1;\n\t\treturn c;\n\t}\n};\n\nstruct Tree {\n#define mid ((l + r) >> 1)\n\tnode a;\n\tint l, r;\n\tTree *ls, *rs;\n\tTree(int l, int r) : l(l), r(r) {\n\t\tif (l == r) {\n\t\t\ta = node(g[f[l]], f[l], f[r], g[f[l]], g[f[r]]);\n\t\t\treturn;\n\t\t}\n\t\tls = new Tree(l, mid);\n\t\trs = new Tree(mid + 1, r);\n\t\ta = ls->a + rs->a;\n\t}\n\tnode ask(int L, int R) {\n\t\tif (L == l && r == R) return a;\n\t\tif (mid >= R) return ls->ask(L, R);\n\t\tif (mid <  L) return rs->ask(L, R);\n\t\treturn ls->ask(L, mid) + rs->ask(mid + 1, R);\n\t}\n} *rt;\n\nint getc() {\n\tint c = getchar();\n\twhile (c < '0' || c > '9') c = getchar();\n\treturn c ^ 48;\n}\n\nint main() {\n\tint n = read();\n\tfor (int j = 0; j < 3; ++ j) {\n\t\tfor (int i = 1; i <= n; ++ i) f[i] = getc() << j;\n\t}\n\trt = new Tree(1, n);\n\tint q = read();\n\tfor (; q -- > 0; ) {\n\t\tint l = read(), r = read();\n\t\tprintf(\"%d\\n\", rt->ask(l, r).sum);\n\t}\n}\n\n\n```\n\n",
        "postTime": 1659099860,
        "uid": 740289,
        "name": "_wfx",
        "ccfLevel": 0,
        "title": "CF1661E Narrow Components"
    },
    {
        "content": "[\u6709\u70b9\u50cf\u7684\u7ecf\u9a8c](https://www.luogu.com.cn/problem/CF811E)\n## Problem\n\u7ed9\u51fa\u4e00\u4e2a $n\\times3(n\\le5\\times10^5)$ \u7684\u77e9\u9635 $a$\uff0c$q\\le3\\times10^5$ \u6b21\u8be2\u95ee\uff0c\u6bcf\u4e2a\u8be2\u95ee\u4e3a\u4e00\u4e2a\u4e8c\u5143\u7ec4 $l,r$ \u6c42\u51fa\u77e9\u9635 $a[1\\sim3][l,r]$ \u5185\u6570\u5b57 $1$ \u7684\u8054\u901a\u5757\u4e2a\u6570\u3002\n## Solution\n\u770b\u89c1 $n$ \u7684\u8303\u56f4\u548c\u8be2\u95ee\u533a\u95f4\uff0c\u5c31\u53ef\u4ee5\u60f3\u5230 ds\u3002\u8003\u8651\u7ebf\u6bb5\u6811\u505a\u6cd5\uff0c\u6bcf\u6b21\u5408\u5e76\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(q\\log n)$\u3002\n## \u5b9e\u73b0\n\u6bcf\u4e2a\u8282\u70b9\u5b58\u533a\u95f4 $\\left[l,r\\right]$ \u4e2d\u7684\u6700\u5de6\u5217\u548c\u6700\u53f3\u5217\u7684\u8fde\u901a\u60c5\u51b5\uff08\u6211\u987a\u4fbf\u628a $\\left[l,r\\right]$ \u4e2d\u7684\u6570\u5b57\u60c5\u51b5\u4e5f\u8bb0\u4e86\uff0c\u65b9\u4fbf\u5408\u5e76\uff09\u3002\n\n**\u6ce8\u610f**\uff1a\u8fde\u901a\u60c5\u51b5\u53ea\u9700\u8981\u8003\u8651 $1$\u3002\n\n- \u5efa\u7acb\u53f6\u5b50\u8282\u70b9\uff1a\u76f4\u63a5\u5c06\u5de6\u53f3\u4e24\u884c\u90fd\u6539\u6210\u8fd9\u4e00\u5217\u5185\u4e0a\u4e0b\u65b9\u683c\u7684\u8fde\u901a\u60c5\u51b5\u3002\n\n- **\u533a\u95f4\u5408\u5e76**\uff1a\u5bf9\u4e8e\u6bcf\u4e2a\u533a\u95f4\uff0c\u663e\u7136\u53ea\u6709\u4e2d\u95f4\u90e8\u5206\u5408\u5e76\u4f1a\u4f7f\u8fde\u901a\u5757\u7684\u6570\u91cf\u51cf\u5c11\uff0c\u90a3\u4e48\u5c31\u53ea\u7528\u8003\u8651\u5de6\u513f\u5b50\u7684\u53f3\u5e76\u67e5\u96c6\u548c\u53f3\u513f\u5b50\u7684\u5de6\u5e76\u67e5\u96c6\u5c31\u53ef\u4ee5\u4e86\u3002\n\t\n\t\u5982\u56fe\uff1a\uff08\u7ea2\u8272\u4e3a $1$\uff0c\u84dd\u8272\u4e3a $0$\uff09\n\t![](https://cdn.luogu.com.cn/upload/image_hosting/h1oqzeco.png)\n\t\u7136\u540e\u5c31\u6709\u4eba\u8981\u95ee\u4e86\uff0c\u90a3\u4e2d\u95f4\u4e0d\u662f\u76f4\u63a5\u6bd4\u8f83\u5c31\u53ef\u4ee5\u4e86\u5417\uff0c\u4e3a\u4ec0\u4e48\u8981\u5e76\u67e5\u96c6\uff1f\n    \n   \u522b\u6025\uff0c\u770b\u770b\u4e0b\u9762\u8fd9\u79cd\u60c5\u51b5\uff1a\n   ![](https://cdn.luogu.com.cn/upload/image_hosting/8zx2yqu1.png)\n   \u8fd9\u6837\u8054\u901a\u5757\u6570\u91cf\u662f\u4e0d\u662f\u51fa\u95ee\u9898\u4e86\uff0c\u53f3\u8fb9**\u53ef\u80fd**$^1$ \u53ef\u4ee5\u8ba9\u5de6\u8fb9\u4e0d\u8fde\u901a\u7684\u8054\u901a\u5757\u91cd\u65b0\u8fde\u901a\u3002\n\n\n> **\u6ce8\u610f**$^1$\uff1a\u4e0a\u56fe\u5b58\u7684\u53ea\u6709\u8fde\u901a\u5757\u989c\u8272\u60c5\u51b5\uff0c\u5b9e\u9645\u60c5\u51b5\u53ef\u80fd\u56fe\u4e8c\u4e2d\u7684\u5de6\u513f\u5b50\u4e2d\u7ea2\u8272\u672c\u6765\u5c31\u662f\u8fde\u901a\u7684\u3002\u6240\u4ee5\u6709\u5fc5\u8981\u5728\u6bcf\u4e2a\u8282\u70b9\u5b58\u5e76\u67e5\u96c6\u7684\u60c5\u51b5\u3002\n\n------------\n\u8fd8\u6709\u4e00\u4e9b\u6ce8\u610f\u70b9\uff1a\n1. \u53ef\u80fd\u8054\u901a\u5757\u4f1a\u4ece\u6574\u4e2a\u533a\u95f4\u5de6\u8fb9\u4e00\u76f4\u8fde\u63a5\u5230\u53f3\u8fb9\uff0c\u6240\u4ee5\u5de6\u53f3\u4e24\u8fb9\u7684\u5e76\u67e5\u96c6\u7684**\u4fdd\u5b58**\u5efa\u8bae\u4ece $1\\sim6$ \u7f16\u53f7\u800c\u4e0d\u662f\u4e24\u4e2a $1\\sim3$\uff08\u53f6\u5b50\u8282\u70b9\u9664\u5916\uff09\u3002\n\n2. \u540c\u7406**\u5408\u5e76**\u65f6\u5e76\u67e5\u96c6\u7f16\u53f7\u5e94\u4ece $1\\sim12$\u3002\n\n[**Code**](https://www.luogu.com.cn/paste/tjswxc39)",
        "postTime": 1649732272,
        "uid": 262322,
        "name": "panyanppyy",
        "ccfLevel": 5,
        "title": "CF1661E"
    }
]
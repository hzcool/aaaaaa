[
    {
        "content": "\u7531\u4e8e\u8fd9\u9898\u548c\u4e8c\u8fdb\u5236\u6709\u5173\uff0c\u6240\u4ee5\u8003\u8651\u6309\u4f4d\u8ba1\u7b97\u3002\n\n\u5982\u679c\u8fd9\u4e00\u4f4d\u7ed3\u679c\u4e3a $0$\uff0c\u90a3\u4e48\u4e5f\u5c31\u662f\u8bf4 $n$ \u4e2a\u6570\u4e2d\uff0c\u4e0d\u5b58\u5728\u8fde\u7eed\u4e24\u4e2a\u4f4d\u7f6e\uff0c\u4f7f\u5f97\u8fd9\u4e24\u4e2a\u6570\u7684\u8fd9\u4e00\u4f4d\u90fd\u4e3a $1$\u3002\n\n\u4ee4 $f_{i,0}$ \u8868\u793a\u7b2c $i$ \u4e2a\u6570\u4e3a $0$\uff0c\u6ee1\u8db3\u6761\u4ef6\u7684\u4e2a\u6570\uff0c$f_{i,1}$ \u4e3a\u7b2c $i$ \u4e2a\u6570\u4e3a $1$\uff0c\u6ee1\u8db3\u6761\u4ef6\u7684\u4e2a\u6570\uff0c\u5219\u6709\uff1a\n\n- $f_{i,0}=f_{i-1,0}+f_{i-1,1}$\n- $f_{i,1}=f_{i-1,0}$\n\n\u4ee4 $g_i=f_{i,0}$\uff0c\u53ef\u5f97 $g_i=F_{i+2}$\uff0c$F_i$ \u4e3a\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7b2c $i$ \u9879\uff0c\u5229\u7528\u77e9\u9635\u5feb\u901f\u5e42\u6216\u8005\u500d\u589e\u6cd5\u5373\u53ef\u3002\n\n\u8fd9\u91cc\u8bf4\u4e00\u4e0b\u500d\u589e\u6cd5\u5982\u4f55\u6c42\uff1a\n\n- $F_{2k}=F_k\\times(2F_{k+1}-F_k)$\n- $F_{2k+1}=F_{k+1}^2+F_k^2$\n\n\u5e38\u6570\u6bd4\u77e9\u9635\u4e58\u6cd5\u5c0f\u3002\n\n\u81f3\u4e8e\u67d0\u4e00\u4f4d\u4e3a $1$ \u7684\u65b9\u6848\u6570\u5462\uff1f\u65e2\u7136\u603b\u65b9\u6848\u6570\u4e3a $2^n$\uff0c\u4e3a $0$ \u7684\u65b9\u6848\u6570\u4e3a $F_{n+2}$\uff0c\u90a3\u4e48\u4e3a $1$ \u7684\u65b9\u6848\u6570\u5c31\u4e3a $2^n-F_{n+2}$\u3002\n\n\u56e0\u4e3a\u6240\u6709\u4f4d\u90fd\u662f\u72ec\u7acb\u7684\uff0c\u6240\u4ee5\u7528\u4e58\u6cd5\u539f\u7406\u7edf\u8ba1\u7b54\u6848\u5373\u53ef\u3002\n\n\u6ce8\u610f $m$ \u53ef\u4ee5\u7b49\u4e8e $1$\u3002\n\n```cpp\n#include<ctime>\n#include<cstdio>\n#include<cctype>\n#define ll unsigned long long\nusing namespace std;\nll read(){\n\tchar c;\n\tll x=0,f=1;\n\twhile(!isdigit(c=getchar()));\n\twhile(isdigit(c)){\n\t\tx=x*10+(c-48);\n\t\tc=getchar();\n\t}\n\treturn x;\n}\nll n,k,l,m,a,b,res;\nstruct node{\n\tll x,y;\n\tnode(ll a=0,ll b=0){\n\t\tx=a;\n\t\ty=b;\n\t}\n};\nnode fib(ll n){//\u8fd4\u56de\u7684\u662f(F(n),F(n+1))\n\tif(!n)\n\t\treturn node(0,1);\n\tnode t=fib(n>>1);\n\tll a=t.x*(2*t.y-t.x+m)%m;\n\tll b=(t.x*t.x+t.y*t.y)%m;\n\tif(n&1)\n\t\treturn node(b,a+b);\n\treturn node(a,b);\n}\nll p(ll n){\n\tif(!n)\n\t\treturn 1;\n\tll t=p(n>>1);\n\tif(n&1)\n\t\treturn t*t*2%m;\n\treturn t*t%m;\n}\nint main(){\n\tn=read();\n\tk=read();\n\tl=read();\n\tm=read();\n\tres=1%m;\n\ta=fib(n+2).x;\n\tb=(p(n)-a+m)%m;\n\tfor(ll i=0;i<l;++i){\n\t\tif((k>>i)&1)\n\t\t\tres=res*b%m;\n\t\telse\n\t\t\tres=res*a%m;\n\t}\n\tif(l<=63&&k>>l)\n\t\tres=0;\n\tprintf(\"%llu\",res);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1621429289,
        "uid": 181378,
        "name": "Alarm5854",
        "ccfLevel": 7,
        "title": "CF551D\u9898\u89e3"
    },
    {
        "content": "## Solution:\n\n\u6211\u4eec\u5c06 k \u6309\u4e8c\u8fdb\u5236\u4f4d\u8003\u8651\uff1a\n\n\u8bbe$f[i][0]$\u4e3ak\u7684\u4e8c\u8fdb\u5236\u4f4d\u7b2c$i$\u4f4d\u4e3a0\u65f6\u8fd9\u4e00\u4f4d\u7684\u65b9\u6848\u6570\uff0c$f[i][1]$\u4e3ak\u7684\u4e8c\u8fdb\u5236\u4f4d\u7b2c$i$\u4f4d\u4e3a1\u65f6\u8fd9\u4e00\u4f4d\u7684\u65b9\u6848\u6570\n\n\u5bf9\u4e8e k \u7684\u6bcf\u4e00\u4f4d\uff0c\u5982\u679c\u4e3a 0\uff0c\u90a3\u4e48\u6bcf\u4e2a $and$ \u7684\u4e24\u4e2a\u6570\u7684\u4e8c\u8fdb\u5236\u6700\u540e\u4e00\u4f4d\u4e00\u5b9a\u4e0d\u80fd\u5747\u4e3a 1\uff0c\n\u7531\u6b64\u5f97\u51fa\u8f6c\u79fb\u65b9\u7a0b\uff1a\n\n$f [ i ] [ 0 ] = f [ i - 1 ] [ 1 ] + f [ i - 1 ] [ 0 ]$ \n\n$f [ i ] [ 1 ] = f [ i - 1 ] [ 0 ]$\n\n\n\u56e0\u4e3a\u8fd9\u4e24\u4e2a\u5f0f\u5b50\u8054\u7acb,\u6240\u4ee5$f[i][0]$\u663e\u7136\u662f\u6590\u6ce2\u90a3\u5951\u6570\u5217\uff0c\u6240\u4ee5\u5f53 k \u7684\u4e00\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u4e3a 0 \u65f6\uff0c\u53ef\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u6c42\u51fa\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7684\u7b2c n+1 \u9879\uff0c\u5373\u4e3a\u7b54\u6848\n\n\u5982\u679c\u4e3a 1\uff0c\u81f3\u5c11\u6709\u4e00\u4e2a $and$ \u4e2d\u7684\u4e24\u4e2a\u6570\u7684\u4e8c\u8fdb\u5236\u6700\u540e\u4e00\u4f4d\u5747\u4e3a 1, \u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528\u603b\u65b9\u6848\u6570\u51cf\u53bb k \u4f4d\u4e3a 0 \u7684\u60c5\u51b5\u7684\u65b9\u6848\u6570,\u4e5f\u5c31\u662f $2 ^ n - f [ n + 1 ]$\uff0c\u6700\u540e\u4e58\u6cd5\u539f\u7406\u628a\u7ed3\u679c\u4e58\u8d77\u6765\u5373\u53ef\n\n## CODE:\n\n```cpp\n#include<bits/stdc++.h>\n#define int unsigned long long\nusing namespace std;\nint n,k,l,m;\nstruct node{\n\tint a[3][3]={{0,0,0},{0,0,0},{0,0,0}};\n\tnode operator *(const node &t)\n\t{\n\t\tnode tmp;\n\t\tfor(int i=1;i<=2;i++)\n\t\tfor(int j=1;j<=2;j++)\n\t\t{\n\t\t\tfor(int k=1;k<=2;k++)\n\t\t\t{\n\t\t\t\ttmp.a[i][j]+=(a[i][k]*t.a[k][j])%m;\n\t\t\t\ttmp.a[i][j]%=m;\n\t\t\t}\n\t\t}\n\t\treturn tmp;\n\t}\n};\nint fib(int num){\n\t//\u77e9\u9635\u52a0\u901f\u6c42\u6590\u6ce2\u90a3\u5951\u6570\u5217\u7b2cn\u9879\n\tnode m,ans;\n\tm.a[1][1]=1;\n\tm.a[1][2]=1;\n\tm.a[2][1]=1;\n    ans.a[1][1]=1;\n    ans.a[2][2]=1;\n\twhile(num){\n\t\tif(num&1){\n\t\t\tans=ans*m;\n\t\t}\n\t\tm=m*m;\n\t\tnum/=2;\n\t}\n\treturn ans.a[1][1];\n}\nint count_bit(int x) {\n    int bit = 0;\n    if(x == 0) return 1;\n    while(x) {\n        bit++;\n        x >>= 1;\n    }\n    return bit;\n}\nint qpow(int a,int b){\n\tif(b==0)return 1;\n\tint tmp=qpow(a,b/2);\n\treturn b%2?tmp*tmp%m*a%m:tmp*tmp%m;\n}\n\nmain(){\n\tint ans=1,fb,hp;\n\tcin>>n>>k>>l>>m;\n\t\n\tif(l<=62&&k>=(1LL<<l))\n    {\n    //\u5224\u65ad\u7ed3\u679c\u662f\u5426\u4e3a0\uff0c\u8bb0\u5f97\u75281LL\n        puts(\"0\");\n        return 0;\n    }\n    int bit[1000],cnt=0;\n    while(k){\n    \tbit[++cnt]=k%2;\n    \tk>>=1;\n       //\u5206\u89e3\u4e8c\u8fdb\u5236\u4f4d\n\t}\n\tfb=fib(n+1);\n\thp=(qpow(2,n)+m-fib(n+1))%m;\n\tfor(int i=1;i<=l;i++){\n\t\tif(bit[i]==1){\n\t\t\tans*=hp;\n\t\t\tans%=m;\n\t\t}\n\t\telse{\n\t\t\tans*=fb;\n\t\t\tans%=m;\n\t\t}\n\t}\n\tprintf(\"%llu\",ans%m);//\u8bb0\u5f97\u518d%\u4e00\u6b21m,\u4e0d\u7136\u4f1aWA\n\treturn 0;\n}\n```\n",
        "postTime": 1564616971,
        "uid": 183154,
        "name": "swiftc",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF551D \u3010GukiZ and Binary Operations\u3011"
    }
]
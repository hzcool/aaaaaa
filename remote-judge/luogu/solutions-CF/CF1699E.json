[
    {
        "content": "\u5199\u8fd9\u7bc7\u9898\u89e3\u662f\u56e0\u4e3a\u672c\u4eba\u5728\u5199\u9898\u7684\u65f6\u5019\uff0c\u6d1b\u8c37\u7684\u6240\u6709\u9898\u89e3\u548c CF \u7684\u5b98\u65b9\u9898\u89e3\u5168\u90fd\u770b\u4e0d\u61c2\u3002\u8d39\u4e86\u597d\u5927\u52b2\u5168\u90e8\u7406\u89e3\u4e4b\u540e\uff0c\u51b3\u5b9a\u5c1d\u8bd5\u5199\u4e00\u7bc7\u7ec6\u81f4\u7684\u9898\u89e3\u5e2e\u52a9\u540e\u4eba\u3002\n\n\u9996\u5148\u5bf9\u4e8e\u9898\u76ee\u4e2d\u7684\u53ef\u91cd\u96c6\uff0c\u5982\u679c\u6709\u76f8\u540c\u7684\u6570\uff0c\u663e\u7136\u53ef\u4ee5\u5bf9\u5176\u8fdb\u884c\u76f8\u540c\u7684\u5206\u89e3\uff0c\u4f7f\u5f97\u53bb\u91cd\u4e0d\u5f71\u54cd\u7b54\u6848\u3002\n\n\u6211\u4eec\u7684\u76ee\u6807\u662f\u8ba9\u6700\u540e\u7684**\u6781\u5dee\u6700\u5c0f**\uff0c\u5728\u56fa\u5b9a\u4e86\u62c6\u5206\u540e\u6240\u6709\u6570\u5b57\u503c\u57df\u7684\u4e00\u7aef\u540e\uff0c\u503c\u57df\u7684\u53e6\u4e00\u7aef\u968f\u4e4b\u53d8\u5316\u3002\u662f**\u53cc\u6307\u9488**\u3002\n\n\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4e2a\u52a8\u6001\u89c4\u5212 $dp_{i,j}$ \u8868\u793a\u5c06 $j$ \u8fd9\u4e2a\u6570\u62c6\u5206\u540e\uff0c\u5982\u679c\u8981\u6c42\u62c6\u51fa\u6765\u7684\u6570\u90fd\u5927\u4e8e\u7b49\u4e8e $i$\uff0c\u90a3\u4e48\u8fd9\u4e9b\u6570\u7684\u6700\u5927\u503c\u7684\u6700\u5c0f\u503c\u662f\u591a\u5c11\u3002\u9075\u4ece\u4e0a\u9762\u53cc\u6307\u9488\u7684\u601d\u60f3\uff0c$i$ \u5c31\u76f8\u5f53\u4e8e\u56fa\u5b9a\u4e86\u7684\u503c\u57df\u6700\u5c0f\u503c\uff0c\u7b54\u6848\u5373 $\\min\\{ \\max\\{ dp_{i,j} \\}(j\\in A)-i\\}(1\\le i\\le \\min(a_k))$\uff0c\u6ce8\u610f $i$ \u7684\u8303\u56f4\u9650\u5236\u6765\u81ea\u62c6\u5206\u5b8c\u4e4b\u540e\u6700\u5c0f\u7684\u6570\u663e\u7136\u8981\u5c0f\u4e8e\u7b49\u4e8e\u539f\u53ef\u91cd\u96c6\u4e2d\u7684\u6700\u5c0f\u6570\u3002\n\n\u63a5\u7740\u8003\u8651\u8f6c\u79fb\u3002\n\n\u5982\u679c $i\\nmid j$ \u663e\u7136\u6709\n\n$$dp_{i,j}=dp_{i+1,j}$$\n\n\u56e0\u4e3a\u4e0d\u53ef\u80fd\u62c6\u51fa\u6765 $i$\uff0c\u90a3\u4e48\u503c\u57df\u91cc\u542b\u4e0d\u542b $i$ \u6ca1\u6709\u533a\u522b\u3002\n\n\u5982\u679c $i\\mid j$\uff0c\u4e14 $i^2\\le j$ \u6709\n\n$$dp_{i,j}=\\min(dp_{i,j},dp_{i,j/i})$$\n\n\u6ce8\u610f\u8fd9\u91cc\u6709\u6761\u4ef6\uff0c\u539f\u56e0\u662f\u62c6\u51fa\u6765\u4e00\u4e2a $i$ \u4e4b\u540e\u8981\u4fdd\u8bc1\u5269\u4e0b\u7684\u6570\u5b57\u90fd\u5927\u4e8e\u7b49\u4e8e $i$\u3002\n\n\u663e\u7136\u7b2c\u4e00\u7ef4\u5e94\u8be5\u5012\u5e8f\u679a\u4e3e\uff0c\u4f5c\u4e3a\u53cc\u6307\u9488\u4e2d\u7684\u5de6\u7aef\u70b9\u3002\n\n\u5de7\u5999\u7684\u4f18\u5316\u6765\u4e86\uff1a\u8f6c\u79fb\u53ea\u9700\u8981\u7528\u5230\u7b2c\u4e00\u7ef4\u6bd4\u5f53\u524d\u5927 $1$ \u6216\u8005\u76f8\u7b49\u7684\u90e8\u5206\uff0c\u6240\u4ee5\u628a\u7b2c\u4e00\u7ef4\u5220\u53bb\u3002\u53d1\u73b0\u7b2c\u4e00\u79cd\u8f6c\u79fb\u53ef\u4ee5\u5ffd\u7565\uff0c\u7b2c\u4e8c\u79cd\u8f6c\u79fb\u53ea\u4f1a\u5728\u6574\u9664\u65f6\u8fdb\u884c\uff0c\u5373\u4fbf\u4e0d\u8003\u8651\u7b2c\u4e8c\u4e2a\u6761\u4ef6\uff0c\u8f6c\u79fb\u7684\u603b\u6b21\u6570\u4e5f\u662f $m$ \u7684\u8c03\u548c\u7ea7\u6570\u7ea7\u522b\uff0c\u53ef\u4ee5\u63a5\u53d7\u3002\u6b64\u5916\uff0c\u6ce8\u610f\u5230\u7b2c\u4e8c\u79cd\u8f6c\u79fb\u9700\u8981\u7684\u662f\u7b2c\u4e00\u7ef4\u76f8\u540c\uff0c\u800c\u7b2c\u4e8c\u7ef4\u6bd4\u81ea\u5df1\u5c0f\u7684\u4f4d\u7f6e\uff0c\u56e0\u6b64\u9700\u8981\u7b2c\u4e8c\u7ef4\u6bd4\u81ea\u5df1\u5c0f\u7684\u4f4d\u7f6e\u5df2\u7ecf\u88ab\u5f97\u51fa\uff0c\u5728\u5b9e\u73b0\u4e0a\u53ea\u9700\u4ece\u5c0f\u5230\u5927\u679a\u4e3e\u7b2c\u4e8c\u7ef4\u5373\u53ef\u3002\n\n\u53e6\u4e00\u4ef6\u5de7\u5999\u7684\u4e8b\u60c5\u662f\u7531\u4e8e\u52a8\u6001\u89c4\u5212\u7684\u610f\u4e49\uff0c\u7b2c\u4e8c\u7ef4\u76f8\u540c\uff0c\u800c\u7b2c\u4e00\u7ef4\u51cf\u5c0f\u7684\u60c5\u51b5\u4e0b\uff0cdp \u503c\u5c06\u5355\u8c03\u4e0d\u5347\u3002\u90a3\u4e48\u53cc\u6307\u9488\u7684\u53f3\u7aef\u70b9\u53ea\u4f1a\u968f\u5de6\u7aef\u70b9\u4e0b\u964d\u800c\u5355\u8c03\u4e0d\u5347\u3002\u5728\u7ef4\u62a4\u5b83\u7684\u65f6\u5019\u53ef\u4ee5\u7ef4\u62a4\u4e00\u4e2a dp \u503c\u7684\u6876\uff0c\u8ba9\u8fd9\u4e2a\u6307\u9488\u5411\u4e0b\u4e00\u76f4\u626b\u5230\u5b58\u5728\u7684\u4f4d\u7f6e\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(m\\log m)$\n\n\u8be6\u89c1\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n\ninline int read(){\n\tint ret=0,f=1;\n\tchar c=getchar();\n\twhile(c<'0'||'9'<c){\n\t\tif(c=='-') f=-1;\n\t\tc=getchar();\n\t}\n\twhile('0'<=c&&c<='9'){\n\t\tret=(ret<<1)+(ret<<3)+(int)(c-'0');\n\t\tc=getchar();\n\t}\n\treturn ret*f;\n}\n\nconst int NR=1e6+5,MR=5e6+5;\nint a[NR],dp[MR],buc[MR];//buc\u4e3adp\u503c\u7684\u6876\nbool flag[MR];\n\ninline void solve(){\n\tint n,m;\n\tn=read();m=read();\n\tfor(int i=1;i<=m;i++) flag[i]=false,buc[i]=0;\n\tint minn=m;\n\tfor(int i=1;i<=n;i++) a[i]=read(),flag[a[i]]=true,minn=min(minn,a[i]);\n\tfor(int i=1;i<=m;i++){\n\t\tdp[i]=i;\n\t\tif(flag[i]) buc[i]++;//\u5373buc[dp[i]]++\n\t}\n\tint maxx=m,ans=m;//\u53f3\u7aef\u70b9\u548c\u6781\u5dee\n\tfor(int i=m;i>=1;i--){\n\t\tif(1ll*i*i<=m){//\u9700\u8981\u4fdd\u8bc1i*i<=m\u624d\u53ef\u80fd\u4ea7\u751f\u8f6c\u79fb\n\t\t\tfor(int j=i*i;j<=m;j+=i){//m\u8c03\u548c\u7ea7\u6570\n\t\t\t\tif(flag[j]) buc[dp[j]]--;\n\t\t\t\tdp[j]=min(dp[j],dp[j/i]);\n\t\t\t\tif(flag[j]) buc[dp[j]]++;\n\t\t\t}\n\t\t}\n\t\twhile(!buc[maxx]) maxx--;\n\t\tif(i<=minn) ans=min(ans,maxx-i);\n\t}\n\tcout<<ans<<'\\n';\n}\n\nint main(){\n\tint t=read();\n\twhile(t--) solve();\n\treturn 0;\n}\n```\n",
        "postTime": 1657874518,
        "uid": 164580,
        "name": "YGB_XU",
        "ccfLevel": 6,
        "title": "\u3010CF1699E Three Days Grace\u3011\u9898\u89e3"
    },
    {
        "content": "~~\u8fd9\u662f DP \u5417\uff1f\u554a\uff1f~~\n\n\u7531\u4e8e\u6211\u4eec\u8981\u5206\u89e3\u540e**\u6781\u5dee\u6700\u5c0f**\uff0c\u76f8\u5f53\u4e8e**\u56fa\u5b9a\u6700\u5c0f\u503c**\u540e\u6c42**\u6700\u5c0f\u7684\u6700\u5927\u503c**\u3002\n\n\u8bbe\u6211\u4eec\u5f53\u524d\u5b9a\u7684\u6700\u5c0f\u503c\u4e3a $mn$\uff0c$f_x$ \u8868\u793a $x$ \u5206\u89e3\u6210\u4e0d\u5c0f\u4e8e $mn$ \u540e\u6700\u5927\u7684\u56e0\u6570\u7684\u6700\u5c0f\u503c\uff08\u82e5 $x<mn$ \u5219\u65e0\u610f\u4e49\uff09\uff0c\u663e\u7136\u6211\u4eec\u8981\u7684\u662f \n$$\n\\max_{x\\in A}f_x\n$$\n\u6211\u4eec\u5c06 $mn$ \u4ece\u5927\u81f3\u5c0f\u9012\u51cf\uff0c\u6bcf\u4e2a\u7b54\u6848\u53d6\u6700\u5c0f\u503c\u5373\u4e3a\u6700\u540e\u8f93\u51fa\u3002\n\n\u8003\u8651\u5982\u4f55\u5feb\u901f\u5c06 $mn+1$ \u8f6c\u79fb\u5230 $mn$\u3002\u6211\u4eec\u60ca\u5947\u5730\u53d1\u73b0\uff0c\u53ea\u6709 $mn$ \u7684\u500d\u6570\u7684 $f$ \u624d\u4f1a\u6539\u53d8\uff0c\u5373\n$$\nf_x=\\min(f_x,f_{x/mn})\n$$\n\u6ce8\u610f\u8fd9\u91cc $f_{x/mn}$ \u4e3a\u53d8\u6362\u8fc7\u7684\uff0c\u5373\u82e5 $x$ \u4e2d\u542b\u591a\u4e2a $mn$\uff0c\u5219\u5176\u5b9e\u662f\n$$\nf_x=\\min(f_x,f_{x/mn},f_{x/mn^2},f_{x/mn^3},\\dots)\n$$\n\u8fd9\u6837\u6211\u4eec\u5c31\u4ee5\u8c03\u548c\u7ea7\u6570 $O(m\\log m)$ \u7684\u590d\u6742\u5ea6\u89e3\u51b3\u672c\u9898\u3002\n\n```cpp\n//We'll be counting stars.\n#pragma GCC optimize(\"Ofast\")\n#include<bits/stdc++.h>\nusing namespace std;\n#define For(i,j,k) for(int i=(j),i##_=(k);i<=i##_;i++)\n#define Rof(i,j,k) for(int i=(j),i##_=(k);i>=i##_;i--)\n#define N 5000010\nint n,m,f[N],t[N],pos,ans;\nbool a[N];\ninline void upd(int id,int val){\n\tif(a[id]){\n\t\tt[f[id]]--;\n\t\tt[f[id]=val]++;\n\t\twhile(!t[pos]) pos--;\n\t}else{\n\t\tf[id]=val;\n\t}\n}\nvoid work(){\n\tscanf(\"%d%d\",&n,&m); \n\tfill(a+1,a+1+m,0);\n\tfill(f+1,f+1+m,m+1);\n\tfill(t+1,t+2+m,0);\n\tint x;\n\tFor(i,1,n){\n\t\tscanf(\"%d\",&x);\n\t\ta[x]=1;\n\t}\n\tFor(i,1,m) if(a[i]) t[m+1]++;\n\tans=pos=m+1;\n\tRof(i,m,1){\n\t\tupd(i,i);\n\t\tFor(j,i,m/i) if(f[i*j]>f[j]) upd(i*j,f[j]);\n\t\tif(pos<=m) ans=min(ans,pos-i);\n\t}\n\tprintf(\"%d\\n\",ans);\n}\nint main(){\n\tint T;scanf(\"%d\",&T); \n\twhile(T--)work();\nreturn 0;}\n```",
        "postTime": 1657545726,
        "uid": 101868,
        "name": "I_am_Accepted",
        "ccfLevel": 0,
        "title": "CF1699E Three Days Grace"
    },
    {
        "content": "### \u524d\u8a00\n\nCF \u6211\u52c7\u5f80\u76f4\u4e0b\uff0c\u76f4\u64ad\u4e0b\u996d\uff0c\u6210\u529f div.2 \u5feb\u901f\u5207\u5b8c ABC \u540e E \u9898\u5c61\u6b21\u5199\u6302\uff01\n\n### \u601d\u8def\n\n\u4ece\u5927\u5230\u5c0f\u786e\u5b9a $1\\sim m$ \u4e2d\u6bcf\u4e2a\u6570\u672c\u8eab\u800c\u8a00\u5bf9\u6bcf\u4e2a\u5de6\u7aef\u70b9\uff08\u4e0b\u754c\uff09\u5bf9\u5e94\u7684\u6700\u5c0f\u53f3\u7aef\u70b9\uff08\u4e0a\u754c\uff09\u3002\n\n\u8fd9\u663e\u7136\u53ea\u5728\u56e0\u5b50\u4f5c\u4e0b\u754c\u5904\u6539\u53d8\u7b54\u6848\uff08\u4e3a\u4ec0\u4e48\uff1f\u56e0\u4e3a**\u975e\u56e0\u5b50\u4e0d\u53ef\u80fd\u6210\u4e3a\u8fd9\u4e2a\u6570\u7684\u5206\u89e3\u7ed3\u679c**\uff09\uff0c\u6545\u53ef\u4ee5\u8c03\u548c\u7ea7\u6570\u590d\u6742\u5ea6\u679a\u4e3e\uff0c\u7528\u66f4\u5c0f\u90e8\u5206\u7684\u7b54\u6848\u66f4\u65b0\u5b83\u672c\u8eab\u3002\n\n\u4e14\u6700\u5927\u4ece $\\sqrt m+1$ \u5f00\u59cb\u679a\u4e3e\u5373\u53ef\uff0c\u56e0\u4e3a $\\min\\{a,\\frac ba\\}\\le\\sqrt b$\uff0c\u5927\u4e8e $\\sqrt m$ \u7684\u5206\u89e3\u65b9\u6848\u4ec5**\u5206\u89e3\u6210\u672c\u8eab**\u4e00\u79cd\u3002\n\n\u7ef4\u62a4\u53d8\u5316\u53ef\u4ee5\u7528 $O(m)-O(1)-O(\\sqrt m)$ \u7684\u5206\u5757\u6839\u53f7\u5e73\u8861\u4e00\u4e0b\uff0c\u56e0\u4e3a\u4fee\u6539\u4e3a $O(m\\log m)$ \u6b21\uff0c\u800c\u67e5\u8be2\u53ea\u6709 $O(\\sqrt m)$ \u6b21\u3002\n\n\u590d\u6742\u5ea6\u4e3a $O(n+m\\log m)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n\u6ce8\u610f\u7279\u5224\u4e00\u4e0b\u6700\u5c0f\u6570\u5927\u4e8e $\\sqrt m$ \u7684\u60c5\u51b5\u65f6\u7684\u7b54\u6848\u3002\n\n### Code\n\n```cpp\n// Problem: E. Three Days Grace\n// Contest: Codeforces - Codeforces Round #804 (Div. 2)\n// URL: https://codeforces.com/contest/1699/problem/E\n// Memory Limit: 256 MB\n// Time Limit: 4000 ms\n\n#include <bits/stdc++.h>\ntypedef long long llt;\ntypedef unsigned uint;typedef unsigned long long ullt;\ntypedef bool bol;typedef char chr;typedef void voi;\ntypedef double dbl;\ntemplate<typename T>bol _max(T&a,T b){return(a<b)?a=b,true:false;}\ntemplate<typename T>bol _min(T&a,T b){return(b<a)?a=b,true:false;}\ntemplate<typename T>T lowbit(T n){return n&-n;}\ntemplate<typename T>T gcd(T a,T b){return b?gcd(b,a%b):a;}\ntemplate<typename T>T lcm(T a,T b){return(a!=0||b!=0)?a/gcd(a,b)*b:(T)0;}\ntemplate<typename T>T exgcd(T a,T b,T&x,T&y){if(b!=0){T ans=exgcd(b,a%b,y,x);y-=a/b*x;return ans;}else return y=0,x=1,a;}\ntemplate<typename T>T power(T base,T index,T mod)\n{\n    T ans=1%mod;\n    while(index)\n    {\n        if(index&1)ans=ans*base%mod;\n        base=base*base%mod,index>>=1;\n    }\n    return ans;\n}\nuint Ans[5000005];bol S[5000005];\nnamespace S2\n{\n    uint B;\n    uint Sum[6000005],W[5000005];\n    voi build(uint m)\n    {\n        B=sqrt(m)+1;\n        for(uint i=0;i<=B*B;i++)Sum[i]=0;\n        for(uint i=0;i<=B;i++)W[i]=0;\n    }\n    voi add(uint v){Sum[v]++,W[v/B]++;}\n    voi del(uint v){Sum[v]--,W[v/B]--;}\n    uint find()\n    {\n        for(uint i=B;~i;i--)if(W[i])for(uint j=B-1;~j;j--)if(Sum[i*B+j])return i*B+j;\n        return-1;\n    }\n};\nint main()\n{\n    uint t;\n    scanf(\"%u\",&t);\n    while(t--)\n    {\n        uint n,m,x=-1,ans=-1;\n        scanf(\"%u%u\",&n,&m);uint w=sqrt(m)+10;\n        S2::build(m);\n        for(uint i=1;i<=m;i++)Ans[i]=i,S[i]=false;\n        for(uint i=0,v;i<n;i++)scanf(\"%u\",&v),_min(x,v),S[v]=true;\n        for(uint i=1;i<=m;i++)if(S[i])S2::add(Ans[i]);\n        if(x>w)_min(ans,S2::find()-x);\n        for(uint q=w;q;q--)\n        {\n            for(uint i=q*q;i<=m;i+=q)\n            {\n                if(S[i])S2::del(Ans[i]);\n                _min(Ans[i],std::max(q,Ans[i/q]));\n                if(S[i])S2::add(Ans[i]);\n            }\n            if(q<=x)_min(ans,S2::find()-q);\n        }\n        printf(\"%u\\n\",ans);\n    }\n    return 0;\n}\n```\n\n",
        "postTime": 1657517369,
        "uid": 105050,
        "name": "myee",
        "ccfLevel": 7,
        "title": "1699E"
    },
    {
        "content": "- \u5999\u5999 DP \u634f\u3002\u4ee4 $\\mathit{dp}_{i}$ \u8868\u793a\u96c6\u5408\u4e2d\u6570\u5b57 $i$ \u53ef\u4ee5\u53d8\u6210\u54ea\u4e2a\u6570\u3002\n\n- \u662f\u4ee5\u503c\u57df\u4e3a\u57fa\u7840\u8fdb\u884c\u679a\u4e3e\u3002\u56e0\u4e3a\u8981\u4f7f\u6781\u5dee\u6700\u5c0f\uff0c\u4e8e\u662f\u53d1\u73b0\u5e94\u8be5 **\u4ece\u5927\u5230\u5c0f** \u679a\u4e3e\u56e0\u6570\uff0c\u518d\u679a\u4e3e\u8fd9\u662f\u54ea\u4e2a\u6570\u7684\u56e0\u6570\u6765\u8fdb\u884c\u52a8\u6001\u89c4\u5212\u3002\n\n- \u540c\u65f6\u53d1\u73b0\u8d2a\u5fc3\u7684\u6027\u8d28,\u4e00\u4e2a\u6570 $x$ \u62c6\u5206\u6210\u63a5\u8fd1 $\\sqrt{x}$ \u662f\u66f4\u4f18\u7684\u3002\u6ce8\u610f **\u4ece\u5927\u5230\u5c0f\u679a\u4e3e\u503c\u57df\u6839\u53f7\u5185\u7684\u56e0\u6570\u662f\u4e3a\u4e86\u6b63\u786e\u7684\u8f6c\u79fb\u987a\u5e8f** \u3002\u53c8\u56e0\u4e3a\u7b54\u6848\u6240\u6c42 **\u6781\u5dee** \u7684\u6700\u5c0f\u503c\uff0c\u6240\u4ee5\u8f6c\u79fb\u65f6\u5bf9\u4e00\u4e2a\u6570 $x \\geq \\sqrt{x}$ \u7684\u90e8\u5206\u53d6\u6700\u5c0f\u503c \u3002 \n\n- \u679a\u4e3e\u65f6\u5de6\u6307\u9488\u662f\u56e0\u6570\uff0c\u53f3\u6307\u9488\u662f\u96c6\u5408\u4e2d\u6700\u5927\u503c\uff0c\u540c\u65f6\u7528\u4e00\u4e2a\u6570\u7ec4\u7ef4\u62a4\u8fd9\u4e2a\u6570\u6709\u591a\u5c11\u4e2a\uff0c\u6ca1\u6709\u5219\u66f4\u65b0\u53f3\u6307\u9488\u3002\u679a\u4e3e\u5b8c\u6bcf\u4e2a\u56e0\u6570\u6765\u66f4\u65b0\u7b54\u6848\u4e3a\u5de6\u53f3\u6307\u9488\u7684\u503c\u57df\u5dee\u3002\u6ce8\u610f\u521a\u5f00\u59cb\u591a\u91cd\u96c6\u6709\u591a\u4e2a\u53ea\u9700\u8003\u8651\u4e00\u4e2a\u3002\n\n- \u66f4\u8be6\u60c5\u53c2\u89c1\u6ce8\u91ca\u3002\n\n```cpp\n///*****Sellaris*****///\n//#pragma once\n//#pragma GCC optimize(2)\n//#pragma GCC optimize(3)\n#include <bits/stdc++.h>\n//#include <bits/extc++.h>\n#define int long long\nusing namespace std;\n//using namespace __gnu_pbds;\nconst int maxn=5e6+10;\ninline int read(){\n    int ret=0,f=1;char ch=getchar();\n    while(!isdigit(ch)){if(ch=='-')f=-f;ch=getchar();}\n    while(isdigit(ch)){ret=ret*10+ch-'0';ch=getchar();}\n    return ret*f; //x=(x<<1)+(x<<3)+(ch^48);\n}\nint a[maxn]={0};\nint f[maxn];\nint b[maxn];\nint dp[maxn];\nint n;int m;\n    /*\n    n\u4e2a1-m\u7684\u6570 \n    a\u539f\u6570\u7ec4 \n\tf\u6570\u7ec4\u662f\u6709\u6ca1\u6709\u8fd9\u4e2a\u6570\n\tb\u6570\u7ec4\u662f\u73b0\u5728\u8fd9\u4e2ai\u6709\u591a\u5c11\u4e2a \n\tdp\u6570\u7ec4\u662fi\u80fd\u53d8\u6210\u7684\u503c \n\t\n\t*\u521a\u5f00\u59cb\u6709\u591a\u4e2a\u53ea\u9700\u8003\u86511\u4e2a\n\t \n\t*/\ninline void solve(){\n    n=read();m=read();\n    for(int i=1;i<=m;i++) f[i]=b[i]=0,dp[i]=i;\n    int l=LLONG_MAX;\n    int r=LLONG_MIN;\n\tfor(int i=1;i<=n;i++) {\n\t\ta[i]=read();\n\t\tf[a[i]]=b[a[i]]=1;\n\t\tl=min(l,a[i]),r=max(r,a[i]);\n\t}\n\tint res=r-l;//\u6ce8\u610fdp\u679a\u4e3e\u65b9\u5f0f \n\tfor(int i=sqrt(m);i>=1;i--){//\u4ece\u5927\u5230\u5c0f\u679a\u4e3e\u56e0\u6570\n\t\tfor(int j=i;j<=m;j+=i){//\u679a\u4e3e\u662f\u54ea\u4e2a\u6570\u7684\u56e0\u6570 \n\t\t\tif(f[j]) b[dp[j]]--;//\u5982\u679c\u6709\u8fd9\u4e2a\u6570\uff0c\u5206\u89e3 \n\t\t\tif(dp[j/i]>=i) dp[j]=min(dp[j],dp[j/i]);//\u7ef4\u62a4dp[i] \u80fd\u53d8\u6210\u7684\u503c \n\t\t\tif(f[j]) b[dp[j]]++;\n\t\t}\n\t\twhile(b[r]==0) r--;//\u7ef4\u62a4\u53f3\u6307\u9488 \n\t\tres=min(res,r-min(i,l));//\u66f4\u65b0\u7b54\u6848 \n\t}\n\tcout<<res<<\"\\n\";\n}\nsigned main(){\n    //std::ios::sync_with_stdio(false);std::cin.tie(NULL);std::cout.tie(NULL);\n    //freopen(\"in.txt\",\"r\",stdin);\n\t//freopen(\"out.txt\",\"w\",stdout);\n\tint t=read();\n\twhile(t--){\n\t\tsolve();\n\t}\n    return 0;\n}\n\n\n\n\n```\n",
        "postTime": 1657203424,
        "uid": 567739,
        "name": "Sellaris",
        "ccfLevel": 4,
        "title": "CF1699E"
    },
    {
        "content": "## Description\n\n\u7ed9\u51fa\u4e00\u4e2a\u5927\u5c0f\u4e3a $n$ \u7684\u591a\u91cd\u96c6 $S$\uff0c\u73b0\u5bf9\u5176\u8fdb\u884c\u82e5\u5e72\u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u64cd\u4f5c\u53ef\u9009\u62e9\u5176\u4e2d\u4e00\u4e2a\u5143\u7d20 $S_i$\uff0c\u5c06\u5176\u5206\u89e3\u4e3a $p \\times q$ \u7684\u5f62\u5f0f\uff0c\u7136\u540e\u5c06 $S_i$ \u5f39\u51fa\uff0c\u52a0\u5165 $p$ \u548c $q$\u3002\u95ee\u6700\u7ec8\u591a\u91cd\u96c6\u5185\u5143\u7d20\u7684\u6781\u5dee\u7684\u6700\u5c0f\u503c\u3002\uff08$1 \\leq n \\leq 10^6,1 \\leq S_i \\leq m\\leq 5 \\times 10^6$\uff09\n\n## Solution\n\n\u9996\u5148\u6613\u77e5\u591a\u91cd\u96c6\u5185\u7684\u91cd\u590d\u5143\u7d20\u5bf9\u7b54\u6848\u65e0\u5f71\u54cd\uff0c\u53ef\u5148\u53bb\u91cd\u3002\n\n\u7531\u4e8e\u6781\u5dee\u4e0e\u5143\u7d20\u7684\u6700\u5927\u503c\u3001\u6700\u5c0f\u503c\u6709\u5173\uff0c\u6211\u4eec\u6bcf\u6b21\u679a\u4e3e\u6700\u5c0f\u503c\uff0c\u8c03\u6574\u6700\u5927\u503c\u6765\u8fdb\u884c\u8ba1\u7b97\u3002\n\n\u8bbe $f_{minn,i}$ \u8868\u793a\u5f53\u76ee\u524d\u6700\u5c0f\u503c\u4e3a $minn$ \u65f6\u5c06 $i$ \u5206\u89e3\u540e\u53ef\u5f97\u6700\u5927\u56e0\u5b50\u7684\u6700\u5c0f\u503c\uff0c\u4e0d\u96be\u53d1\u73b0\u6211\u4eec\u6700\u7ec8\u7684\u7b54\u6848\u5c31\u662f $\\max\\limits_{minn \\leq m} \\max\\limits_{i \\in S} f_{minn,i}$\u3002\n\n\u6211\u4eec\u5012\u5e8f\u679a\u4e3e $minn$\uff0c\u7136\u540e\u8fdb\u884c\u8f6c\u79fb\u3002\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u5f53\u6211\u4eec\u4ece $minn+1$ \u8f6c\u79fb\u5230 $minn$ \u65f6\uff0c\u5bf9\u4e8e\u6240\u6709\u7684 $f_i$\uff0c\u53ea\u4f1a\u6709\u662f $minn$ \u7684\u500d\u6570\u7684\u4f4d\u7f6e\u53d1\u751f\u6539\u53d8\uff0c\u5373\u6b64\u65f6\u6709 $f'_{minn,i}=\\min\\limits_{minn^x|i}f_{i/minn^x}\\qquad(minn \\mid i)$\u3002\n\n\u6240\u4ee5\u603b\u4f53\u7684\u590d\u6742\u5ea6\u4e3a\u8c03\u548c\u7ea7\u6570 $O(m \\log m)$\u3002\n\n## [code](https://www.luogu.com.cn/paste/4yer74mi)",
        "postTime": 1659017162,
        "uid": 112661,
        "name": "NKL\u4e36",
        "ccfLevel": 0,
        "title": "CF1699E Three Days Grace \u9898\u89e3"
    },
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/LaoMang-no-blog/p/16457670.html)\n\n---\n\n[**CF link**](https://codeforces.com/problemset/problem/1699/E)\n\n[**\u4f60\u8c37 link**](https://www.luogu.com.cn/problem/CF1699E)\n\n\u4e00\u9053\u975e\u5e38\u5de7\u5999\u7684 dp \u9898\uff0c\u4f46\u662f\u987a\u7740\u601d\u8def\u6c34\u5230\u6e20\u6210\u5e76\u4e0d\u662f\u5b8c\u5168\u65e0\u8ff9\u53ef\u5bfb\u3002\n\n\u9996\u5148\u89c2\u5bdf\u5230\u9898\u9762\u4e2d\u7b54\u6848\u7684\u5f62\u5f0f\u662f\u6700\u503c\u76f8\u51cf\uff0c\u63d0\u9192\u6211\u4eec\u4f7f\u7528\u53cc\u6307\u9488\u7684\u601d\u60f3\uff0c\u5373\u679a\u4e3e\u6700\u5c0f\u503c\u7684\u8fc7\u7a0b\u4e2d\u52a8\u6001\u5355\u8c03\u7ef4\u62a4\u6700\u5927\u503c\uff0c\u540c\u65f6\u6ce8\u610f\u5230\u672c\u9898\u4e2d\u7684\u64cd\u4f5c\u7c7b\u578b\u662f\u5c06\u4e00\u4e2a\u6570\u62c6\u6210\u4e24\u4e2a\u6570\u76f8\u4e58\u7684\u5f62\u5f0f\uff0c\u6240\u4ee5\u53ef\u4ee5\u60f3\u5230\u662f\u4ece\u5927\u5230\u5c0f\u679a\u4e3e\uff0c\u4e14\u601d\u8003\u52a0\u5165\u63a7\u5236\u4e86\u6700\u5927\u503c\uff0c\u5219\u8981\u5c06\u6bd4\u6700\u5927\u503c\u5927\u7684\u6570\u62c6\u5f00\uff0c\u4e0d\u662f\u5f88\u597d\u63a7\u5236\u62c6\u6210\u90a3\u4e9b\u6570\uff0c\u62c6\u7684\u6570\u7684\u6570\u91cf\uff0c\u6240\u4ee5\u8003\u8651\u4ece\u5927\u5230\u5c0f\u679a\u4e3e\u6700\u5c0f\u503c\uff0c\u540c\u65f6\u63a7\u5236\u6700\u5927\u503c\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u5982\u4f55\u53bb\u63a7\u5236\u6700\u5927\u503c\uff0c\u5982\u5b57\u9762\u610f\u601d\u4e00\u822c\uff0c\u6211\u4eec\u5e0c\u671b\u8ba9\u6700\u5927\u503c\u5c3d\u91cf\u5c0f\uff0c\u4f46\u662f\u6709\u4e0d\u80fd\u5728\u5206\u89e3\u8fc7\u7a0b\u4e2d\u4ea7\u751f\u6bd4\u6211\u4eec\u786e\u5b9a\u7684\u6700\u5c0f\u503c\u66f4\u5c0f\u7684\u503c\uff0c\u5355\u7eaf\u7684\u7528\u8d2a\u5fc3\u4f3c\u4e4e\u5e76\u4e0d\u9002\u5408\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u4f7f\u7528 dp\u3002\n\n\u672c\u7740\u6c42\u4ec0\u4e48\u8bbe\u4ec0\u4e48\u7684\u539f\u5219\uff0c\u6211\u4eec\u8bbe $f_{i,x}$ \u8868\u793a\u6ee1\u8db3\u80fd\u5c06 $x$ \u5206\u89e3\u6210\u591a\u4e2a\u6570\u76f8\u4e58\u4e14\u6240\u6709\u6570\u90fd\u88ab\u5305\u542b\u5728\u533a\u95f4 $[i,v]$ \u5185\u7684\u6700\u5c0f\u7684 $v$\uff0c\u5728\u5177\u4f53\u5b9e\u73b0\u8fc7\u7a0b\u4e2d\u72b6\u6001\u4e2d\u7684\u7b2c\u4e00\u7ef4 $i$ \u53ef\u4ee5\u538b\u6389\u3002\u63a5\u4e0b\u6765\u8003\u8651\u8f6c\u79fb\uff0c\u9996\u5148\u53ef\u4ee5\u60f3\u5230\u80af\u5b9a\u662f\u4ece\u5927\u5230\u5c0f\u679a\u4e3e $i$\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $i$\uff0c\u4efb\u4f55\u4e00\u4e2a $x$ \u7684\u5206\u89e3\u53ea\u6709\u51e0\u79cd\u53ef\u80fd\uff0c\u8981\u4e48\u6839\u672c\u4e0d\u80fd\u5206\u51fa $i$\uff0c\u8981\u4e48\u5206\u51fa\u51e0\u4e2a $i$\uff0c\u8981\u4e48\u80fd\u5206\u4e0d\u5206\uff0c\u5206\u522b\u8003\u8651\u8f6c\u79fb\uff0c\u524d\u540e\u4e24\u79cd\u8f6c\u79fb\u90fd\u662f\u76f4\u63a5\u7ee7\u627f\u4e0a\u4e00\u6b21\u7684\u7b54\u6848\uff0c$i$ \u90a3\u7ef4\u538b\u6389\u540e\u5373\u4e0d\u53d8\uff0c\u4e2d\u95f4\u7684\u8f6c\u79fb\u8003\u8651\u5230\u4e00\u4e2a\u6570\u4e0d\u4e00\u5b9a\u53ea\u5206\u51fa\u4e00\u4e2a $i$\uff0c\u6240\u4ee5\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u7c7b\u4f3c\u591a\u91cd\u80cc\u5305\u7684\u4f18\u5316\uff0c\u6b63\u5411\u679a\u4e3e\u76f4\u63a5\u8f6c\u79fb\uff0c$f_x=\\min\\{f_x,f_\\frac xi\\}$\u3002\n\n\u7136\u540e\u6211\u4eec\u53d1\u73b0\u4e0a\u9762\u7684\u8f6c\u79fb\u8fc7\u7a0b\u4e2d $f$ \u6570\u7ec4\u968f $i$ \u53d8\u5c0f\u662f\u5355\u8c03\u53d8\u5c0f\u7684\uff0c\u5373\u6700\u5927\u503c\u4e0d\u4f1a\u53d8\u5927\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u8fdb\u884c\u4e0a\u9762\u7684\u53cc\u6307\u9488\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u96c6\u5408\u4e2d\u5b58\u5728\u7684 $x$\uff0c\u6807\u8bb0 $f_x$\uff0c\u7136\u540e\u7528\u4e00\u4e2a\u6307\u9488\u6307\u5411\u6700\u540e\u4e00\u4e2a\u6807\u8bb0\uff0c\u6807\u8bb0\u4f4d\u7f6e\u5355\u8c03\u524d\u79fb\uff0c\u6bcf\u6b21\u8ba1\u7b97\u7b54\u6848\uff0c[\u4ee3\u7801](https://codeforces.com/contest/1699/submission/163163645)\u5b9e\u73b0\u96be\u5ea6\u4e0d\u5927\u3002",
        "postTime": 1657250923,
        "uid": 310525,
        "name": "\u8001\u83bd\u83bd\u7a7f\u4e00\u5207",
        "ccfLevel": 0,
        "title": "[CF1699E] Three Days Grace \u9898\u89e3"
    },
    {
        "content": "[\u4f20\u9001\u95e8](https://codeforces.com/contest/1699/problem/E)\n## \u9898\u76ee\u5927\u610f\n\u6709\u4e00\u4e2a\u5927\u5c0f\u4e3a $n$ \u7684 `multiset`\uff0c\u91cc\u9762\u6bcf\u4e2a\u6570\u90fd\u5728 $1$ \u5230 $m$ \u4e4b\u95f4\u3002\u4f60\u53ef\u4ee5\u505a\u4efb\u610f\u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u5c06\u4e00\u4e2a\u6570 $x$\uff0c\u5206\u89e3\u6210 $p,q>1$\uff0c\u6ee1\u8db3 $x=pq$\uff0c\u7136\u540e\u5c06 $x$ \u4ece `multiset` \u4e2d\u5220\u9664\uff0c\u5c06 $p,q$ \u52a0\u5165 `multiset`\u3002\n\n\u6c42\u64cd\u4f5c\u7ed3\u675f\u540e `multiset` \u4e2d\u6700\u5927\u503c\u548c\u6700\u5c0f\u503c\u4e4b\u5dee\u7684\u6700\u5c0f\u503c\u3002\n## \u601d\u8def\n\u8fd9\u4e2a\u9898\u4e00\u770b\u5c31\u4e0d\u4f1a\u505a\uff0c\u56e0\u4e3a\u5b83\u8981\u6c42 $\\max a_i-\\min a_i$\u3002\u56e0\u4e3a\u5de6\u53f3\u65ad\u70b9\u90fd\u5728\u52a8\uff0c\u6240\u4ee5\u60f3\u8d77\u6765\u5c31\u5f88\u96be\u53d7\u3002\n\n\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u7684\u529e\u6cd5\u5c31\u662f\u679a\u4e3e\u5de6\u7aef\u70b9 $L$\uff0c\u6c42\u6700\u5c0f\u7684\u53f3\u7aef\u70b9 $R$\u3002\u5373\u679a\u4e3e `multiset` \u4e2d\u7684\u6700\u5c0f\u503c\uff0c\u6c42\u6700\u5927\u503c\u7684\u6700\u5c0f\u503c\u3002\n\n\u6b64\u65f6\u53ef\u4ee5\u8bbe $dp(i,j)$ \u8868\u793a\u5c06 $j$ \u62c6\u5206\u56e0\u5b50\u540e\u6700\u5c0f\u56e0\u5b50\u4e3a $i$ \u7684\u60c5\u51b5\u4e0b\u7684\u6700\u5927\u56e0\u5b50\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a $k\\ge i$\uff0c\u4e14 $dp(k,\\frac{j}{i})\\ge i$\uff0c$dp(i,j)$ \u53ef\u4ee5\u7531 $dp(k,\\frac{j}{i})$ \u8f6c\u79fb\u8fc7\u6765\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(m\\log m)$\u3002\n\n[Code](https://www.luogu.com.cn/paste/q6fkcjl0)",
        "postTime": 1657251205,
        "uid": 229669,
        "name": "Jerry__Jiang",
        "ccfLevel": 7,
        "title": "\u3010\u9898\u89e3\u3011CF1699E Three Days Grace"
    }
]
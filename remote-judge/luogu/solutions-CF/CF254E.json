[
    {
        "content": "\u9898\u76ee\u5927\u610f\uff1a\n\n\u6709 $n$ \u5929\uff0c\u7b2c $i$ \u5929\u4f60\u4f1a\u6536\u5230 $a_i$ \u4efd\u98df\u7269\u3002\u98df\u7269\u6709\u4fdd\u8d28\u671f\uff0c\u7b2c $i$ \u5929\u6536\u5230\u7684\u98df\u7269\u53ea\u80fd\u5728\u7b2c $i$ \u5929\u548c\u7b2c $i+1$ \u5929\u98df\u7528\u3002\n\n\u4f60\u8fd8\u6709 $m$ \u4e2a\u670b\u53cb\u3002\u7b2c $i$ \u4e2a\u670b\u53cb\u4f1a\u5728\u7b2c $l_i$ \u81f3 $r_i$ \u5929\u62dc\u8bbf\u4f60\uff0c\u98df\u91cf\u662f $c_i$ \u4efd\u98df\u7269\u3002\n\n\u4f60\u6bcf\u5929\u53ef\u4ee5\u9009\u62e9\u4e00\u4e9b\u670b\u53cb\u4f9b\u5e94\u98df\u7269\uff08\u5fc5\u987b\u4f9b\u7ed9\u6b63\u597d $c_i$ \u4efd\u98df\u7269\uff0c\u4e00\u4e2a\u670b\u53cb\u4e00\u5929\u53ea\u80fd\u4f9b\u7ed9\u4e00\u6b21\uff09\uff0c\u6bcf\u8d21\u732e\u4e00\u4eba\u6b21\u4f60\u7684\u4eba\u6c14\u503c\u5c31\u4f1a $+1$\u3002\n\n\u540c\u65f6\uff0c\u4f60\u6bcf\u5929\u5fc5\u987b\u5403 $v$ \u4efd\u98df\u7269\u3002\n\n\u95ee\u4f60 $n$ \u5929\u540e\u4f60\u7684\u4eba\u6c14\u503c\u6700\u5927\u662f\u591a\u5c11\u3002\n\n\u9898\u89e3\uff1a\n\n\u4ee4 $dp_{i,j}$ \u8868\u793a\u8003\u8651\u5230\u7b2c $i$ \u5929\uff0c\u6628\u5929\u5269\u4e0b\u4e86 $j$ \u4efd\u98df\u7269\u65f6\u4f60\u6700\u5927\u7684\u4eba\u6c14\u503c\u3002\n\n\u8f6c\u79fb\uff1a\n\n\u5f88\u663e\u7136\uff0c\u6211\u4eec\u6bcf\u4e00\u5929\u80af\u5b9a\u4f1a\u5148\u5403\u6628\u5929\u7684\u5269\u996d\uff0c\u4e0d\u591f\u4e86\u518d\u5403\u4eca\u5929\u7684\u996d\u3002\n\n\u7136\u540e\u9009\u62e9\u670b\u53cb\u7684\u8bdd\uff0c\u6211\u4eec\u53ef\u4ee5\u8d2a\u5fc3\u7684\u9009\uff1a\u6309\u7167\u670b\u53cb\u7684\u996d\u91cf\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u9009\u6700\u5c0f\u7684\u524d $k$ \u4e2a\u3002\n\n\u5177\u4f53\u53ef\u4ee5\u53c2\u8003\u4ee3\u7801\n\nCode:\n```cpp\nconst int mxn=444;\nint n,v,m;\nint a[mxn];\nvector<pair<int,int> >c[mxn];\nint dp[mxn][mxn*2],pre[mxn][mxn*2],preg[mxn][mxn*2]; //pre[][]\u8bb0\u5f55\u5269\u996d\u7531\u54ea\u513f\u8f6c\u79fb\u8fc7\u6765\uff0cpreg\u8bb0\u5f55\u4e86\u5f53\u5929\u8bf7\u4e86\u996d\u91cf\u524d\u591a\u5c11\u5c0f\u7684\u670b\u53cb\u5403\u996d\ninline void solve(){\n\tcin>>n>>v;\n\tfor(int i=1;i<=n;++i)cin>>a[i];\n\tcin>>m;\n\tfor(int i=1;i<=m;++i){\n\t\tint l,r,t;cin>>l>>r>>t;\n\t\tfor(int j=l;j<=r;++j)c[j].push_back(mp(t,i));\n\t}\n\tfor(int i=1;i<=n;++i)sort(c[i].begin(),c[i].end());\n\tfor(int i=0;i<mxn;++i)for(int j=0;j<mxn*2;++j)dp[i][j]=-1145141;\n\tdp[1][0]=0;\n\tfor(int i=1;i<=n;++i){\n\t\tfor(int j=0;j<=800;++j){//dp[i][j]\u8868\u793a\u8003\u8651\u5230\u7b2ci\u5929\uff0c\u6628\u5929\u5269\u4e0b\u4e86j\u7684\u98df\u7269\u6240\u80fd\u5f97\u5230\u7684\u6700\u5927\u503c \n\t\t\tif(dp[i][j]<0)continue;\n\t\t\tint yes=j,tod=a[i];    //\u5206\u522b\u4ee3\u8868\u6628\u5929\u7684\u5269\u996d\u548c\u4eca\u5929\u65b0\u589e\u7684\u996d\n\t\t\tif(yes>=v)yes-=v;\n\t\t\telse tod-=(v-yes),yes=0;  //\u5148\u5904\u7406\u4eca\u5929\u81ea\u5df1\u5403\u7684\u996d\n\t\t\tint x=tod+yes;\n\t\t\tif(dp[i][j]>dp[i+1][tod]){\n\t\t\t\tdp[i+1][tod]=dp[i][j];\n\t\t\t\tpre[i+1][tod]=j;\n\t\t\t\tpreg[i+1][tod]=0;\n\t\t\t}\n\t\t\tint sum=0;\n\t\t\tfor(int k=0;k<c[i].size();++k){\n\t\t\t\tsum+=c[i][k].first;\n\t\t\t\tif(sum>x)break;\n\t\t\t\tint rem=min(tod,x-sum);  //\u8fd8\u662f\u5148\u5403\u5269\u996d\uff0c\u7136\u540e\u5904\u7406\u6628\u5929\u4e0d\u80fd\u4fdd\u7559\u5230\u660e\u5929\u7684\u996d\n\t\t\t\tif(dp[i][j]+k+1>dp[i+1][rem]){\n\t\t\t\t\tdp[i+1][rem]=dp[i][j]+k+1;\n\t\t\t\t\tpre[i+1][rem]=j;\n\t\t\t\t\tpreg[i+1][rem]=k+1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tint pos=0;\n\tfor(int i=1;i<=800;++i)if(dp[n+1][i]>dp[n+1][pos])pos=i;\n\tcout<<dp[n+1][pos]<<'\\n';\n\tvector<int>bk;\n\tbk.clear();\n\tint lst=pos;\n\tfor(int i=n+1;i>1;--i){\n\t\tbk.push_back(preg[i][lst]);\n\t\tlst=pre[i][lst];\n\t}\n\tfor(int i=bk.size()-1;~i;--i){\n\t\tcout<<bk[i]<<' ';\n\t\tfor(int j=0;j<bk[i];++j)cout<<c[bk.size()-i][j].second<<' ';\n\t\tcout<<'\\n';\n\t}\n}\nint main(){\n\tfreopen(\"input.txt\",\"r\",stdin);\n\tfreopen(\"output.txt\",\"w\",stdout); \n\tios_base::sync_with_stdio(false);\n\tcin.tie(0),cout.tie(0);\n\tint T=1;\n\t//cin>>T;\n\tfor(;T--;)solve();\n\treturn 0;\n}\n```",
        "postTime": 1645284456,
        "uid": 226760,
        "name": "RedLycoris",
        "ccfLevel": 7,
        "title": "CF254E Dormitory \u9898\u89e3"
    }
]
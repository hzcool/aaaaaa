[
    {
        "content": "\u8bbe$poly_i(i\\in\\{0,1\\})$\u6709$n_i$\u4e2a\u9876\u70b9\uff0c\u6309\u987a\u5e8f\u4e3a$a_{i,0},\\cdots,a_{i,n_i}(a_{i,n_i}=a_{i,0})$\uff0c\u6cd5\u5411\u91cf\u4e3a$\\overrightarrow{p_i}$\uff0c\u6240\u5728\u5e73\u9762\u4e3a$flat_i$\u3002\n\n#### step.1\n\n\u8ba1\u7b97\u51fa$\\overrightarrow x=\\overrightarrow{p_0}\\times\\overrightarrow{p_1}$\uff0c\u8fd9\u662f$l=flat_0\\cap flat_1$\u7684\u65b9\u5411\u3002   \n\u5982\u679c$|\\overrightarrow x|=0$\u90a3\u4e48$flat_0\\parallel flat_1$\u3002\n\n#### step.2\n\n\u8003\u8651\u8ba1\u7b97$poly_0$\u7684\u8fb9\u4e0e$flat_1$\u7684\u4ea4\u70b9\u53ca\u65b9\u5411\u3002   \n\u53ef\u4ee5\u7528$o_{0,i}=\\operatorname{sgn}(\\cos<\\overrightarrow{a_{0,i}-a_{1,0}},\\overrightarrow{p_1}>)=\\operatorname{sgn}(\\overrightarrow{a_{0,i}-a_{1,0}}\\cdot\\overrightarrow{p_1})$\u8868\u793a$a_{0,j}$\u4e0e$flat_1$\u7684\u4f4d\u7f6e\u5173\u7cfb\u3002  \n$o_{0,i}=\\begin{cases}1&\\text{above}\\\\0&\\text{on}\\\\-1&\\text{below}\\end{cases}$  \n\u90a3\u4e48$e_{0,i}=o_{0,i}-o_{0,i+1}$\u5c31\u53ef\u4ee5\u8868\u793a$\\operatorname{seg}(a_{0,i},a_{0,i+1})$\u4e0e$flat_1$\u7684\u4f4d\u7f6e\u5173\u7cfb\u3002  \n$|e_{0,i}|=\\begin{cases}2&\\text{intersect}\\\\1&\\text{tangent}\\\\0&\\text{apart}\\end{cases}$  \n$\\operatorname{sgn}(e_{0,i})=\\begin{cases}1&\\text{down}\\\\0&\\text{apart}\\\\-1&\\text{up}\\end{cases}$  \n\u5bf9\u4e8e$e_{0,i}\\ne0$\uff0c\u8ba1\u7b97\u5f97\u5230$\\operatorname{seg}(a_{0,i},a_{0,i+1})\\cap flat_1=y_{0,i}=a_{0,i}+\\frac{\\overrightarrow{a_{0,i}-a_{1,0}\\cdot}\\overrightarrow{p_1}}{\\overrightarrow{a_{0,i}-a_{1,0}}\\cdot\\overrightarrow{p_1}}\\overrightarrow{a_{0,i+1}-a_{0,i}}$\u3002\n\n\u540c\u7406\u6c42\u51fa\u6240\u6709$e_{1,i},y_{1,i}(e_{1,i}\\ne0)$\u3002\n\n#### step.3\n\n\u5f88\u663e\u7136\u6240\u6709$y_{t,i}$\u90fd\u5728$l$\u4e0a\uff0c\u4e14\u56e0\u4e3a\u76f8\u5207\u7684\u4ea4\u70b9\u8ba1\u7b97\u4e86\u4e24\u6b21\uff0c\u6240\u4ee5\u4e24\u4e2a\u591a\u8fb9\u5f62\u4e0e$l$\u7684\u4ea4\u70b9\u4e2a\u6570\u90fd\u662f\u5076\u6570\u3002     \n\u8ba1\u7b97\u51fa$y_{t,i}$\u6309\u5728$\\overrightarrow x$\u65b9\u5411\u4e0a\u7684\u5750\u6807$pos_{t,i}=\\overrightarrow{y_{t,i}}\\times\\overrightarrow x$\u3002   \n\u90a3\u4e48$[y_{0,i}\\in poly_1]=|\\sum\\limits_{pos_{1,j}<pos_{0,i}}e_{1,j}|$\u3002\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u6210\u529f\u5730\u5224\u65ad\u4e86$y_{0,i}$\u4e0e$poly_1$\u7684\u4f4d\u7f6e\u5173\u7cfb\uff0c\u7ed3\u5408$e_{0,i}$\u5373\u53ef\u7b97\u51fa$poly_0$\u4ece\u4e0a\u5f80\u4e0b\u548c\u4ece\u4e0b\u5f80\u4e0a\u7a7f\u8fc7$poly_1$\u7684\u6b21\u6570\u3002\n\n#### app.\n\u5982\u4f55\u5f97\u5230$y_{t,i}$\u7684\u8ba1\u7b97\u5f0f\uff1f  \n\u8bbe$y_{0,i}=a_{0,i}+k_i\\overrightarrow{a_{0,i+1}-a_{0,i}}$\uff0c\u5219$\\overrightarrow{y_{0,i}-a_{1,0}}=\\overrightarrow{a_{0,i}-a_{1,0}}+k_i\\overrightarrow{a_{0,i+1}-a_{0,i}}$\u3002  \n\u4e24\u8fb9\u540c\u65f6\u5bf9$\\overrightarrow{p_1}$\u70b9\u79ef\u5f97\u5230$k_i=\\frac{\\overrightarrow{a_{0,i}-a_{1,0}\\cdot}\\overrightarrow{p_1}}{\\overrightarrow{a_{0,i}-a_{1,0}}\\cdot\\overrightarrow{p_1}}$\u3002  \n$y_{1,i}$\u540c\u7406\u3002\n\n```c++\n#include<cstdio>\n#include<vector>\n#include<utility>\n#include<algorithm>\nusing std::pair;\nusing db=long double;\nusing i64=long long;\nconst int N=100007;\nstruct vec{i64 x,y,z;}a[2][N],p[2],x;\nvec operator-(const vec&a,const vec&b){return {a.x-b.x,a.y-b.y,a.z-b.z};}\nvec operator*(const vec&a,const vec&b){return {a.y*b.z-a.z*b.y,a.z*b.x-a.x*b.z,a.x*b.y-a.y*b.x};}\ni64 operator^(const vec&a,const vec&b){return a.x*b.x+a.y*b.y+a.z*b.z;}\nint n[2],o[N],s,t;\nstd::vector<pair<db,pair<int,int>>>vec;\nint read(){int x;scanf(\"%d\",&x);return x;}\nint sgn(i64 x){return x<0? -1:x? 1:0;}\nint main()\n{\n    freopen(\"1.in\",\"r\",stdin);\n    for(int t=0;t<2;++t)\n    {\n\tn[t]=read();\n\tfor(int i=0;i<n[t];++i) a[t][i]={read(),read(),read()};\n\ta[t][n[t]]=a[t][0],p[t]=(a[t][1]-a[t][0])*(a[t][2]-a[t][0]);\n    }\n    if(x=p[0]*p[1],!(x^x)) return !puts(\"NO\");\n    for(int t=0;t<2;++t)\n    {\n\tfor(int i=0;i<=n[t];++i) o[i]=sgn((a[t][i]-a[t^1][0])^p[t^1]);\n\tfor(int i=0;i<n[t];++i)\n\t    if(o[i]^o[i+1])\n\t\tvec.push_back({(a[t][i]^x)+((a[t][i+1]-a[t][i])^x)*(db)(p[t^1]^(a[t][i]-a[t^1][0]))/(p[t^1]^(a[t][i]-a[t][i+1])),{t,o[i]-o[i+1]}});\n    }\n    std::sort(vec.begin(),vec.end());\n    for(auto x:vec) x.second.first? s+=t*x.second.second:t+=x.second.second;\n    puts(s? \"YES\":\"NO\");\n}\n```",
        "postTime": 1582529654,
        "uid": 89875,
        "name": "EMT__Mashiro",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF717I \u3010Cowboy Beblop at his computer\u3011"
    }
]
[
    {
        "content": "[Codeforces \u9898\u9762\u4f20\u9001\u95e8](https://codeforces.ml/contest/997/problem/D) & [\u6d1b\u8c37\u9898\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF997D)\n\n\u4e00\u79cd\u6362\u6839 dp \u7684\u505a\u6cd5\u3002\n\n\u9996\u5148\u78b0\u5230\u8fd9\u7c7b\u9898\u76ee\uff0c\u6211\u4eec\u5f88\u660e\u663e\u4e0d\u80fd\u771f\u7684\u628a\u56fe $G$ \u5efa\u51fa\u6765\uff0c\u56e0\u6b64\u6211\u4eec\u9700\u8981\u89c2\u5bdf\u4e00\u4e0b\u56fe $G$ \u6709\u54ea\u4e9b\u6027\u8d28\u3002\u5f88\u660e\u663e\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u770b\u4f5c $T_1,T_2$ \u4e0a\u5206\u522b\u6709\u4e00\u4e2a\u6807\u8bb0\uff0c\u6bcf\u6b21\u53ef\u4ee5\u5c06 $T_1,T_2$ \u4e0a\u7684\u67d0\u4e2a\u6807\u8bb0\u6cbf\u7740\u67d0\u6761\u8fb9\u79fb\u52a8\u4e00\u6b65\uff0c\u95ee $k$ \u6b65\u4e4b\u540e\u6807\u8bb0\u521a\u597d\u56de\u5230\u539f\u4f4d\u7684\u65b9\u6848\u6570\u662f\u591a\u5c11\u3002\n\n\u663e\u7136\u4e24\u68f5\u6811\u662f\u72ec\u7acb\u7684\uff0c\u56e0\u6b64\u53ef\u4ee5\u5206\u5f00\u6765\u8003\u8651\uff0c\u6211\u4eec\u8bb0 $dp1_{i,j}$ \u8868\u793a $T_1$ \u4e2d\u4ece $i$ \u5f00\u59cb\u8d70 $j$ \u6b65\u53c8\u56de\u5230 $i$ \u7684\u65b9\u6848\u6570\uff0c$dp2_{i,j}$ \u4e5f\u540c\u7406\uff0c\u90a3\u4e48\u663e\u7136\u6709 $ans=\\sum\\limits_{x\\in T_1}\\sum\\limits_{y\\in T_2}\\sum\\limits_{i=0}^kdp1_{x,i}dp2_{y,k-i}\\dbinom{k}{i}$\uff0c\u628a\u7ec4\u5408\u6570\u88c2\u5f00\u53ef\u4ee5\u5f97\u5230 $ans=k!\\sum\\limits_{i=0}^k\\sum\\limits_{x\\in T_1}\\dfrac{dp_{x,i}}{i!}\\sum\\limits_{y\\in T_2}\\dfrac{dp_{y,k-i}}{(k-i)!}$\uff0c\u4e24\u90e8\u5206\u5206\u522b\u6c42\u4e2a\u548c\u7136\u540e $\\mathcal O(k)$ \u5408\u5e76\u5373\u53ef\u3002\n\n\u56e0\u6b64\u63a5\u4e0b\u6765\u6211\u4eec\u7684\u4efb\u52a1\u5c31\u662f\u6c42\u51fa $dp1_{i,j}$ \u548c $dp2_{i,j}$\uff0c\u4e24\u90e8\u5206\u662f\u7b49\u4ef7\u7684\uff0c\u56e0\u6b64\u8003\u8651\u600e\u6837\u6c42 $dp1_{i,j}$\uff0c\u5728\u4e0b\u6587\u4e2d\u4e3a\u4e86\u65b9\u4fbf\u8d77\u89c1\uff0c\u6211\u4eec\u7528 $dp_{i,j}$ \u4ee3\u66ff $dp1_{i,j}$\uff0c\u6211\u4eec\u4e0d\u59a8\u4ee5 $1$ \u4e3a\u6839\u505a\u4e00\u904d DFS\uff0c\u8bbe $f_{x,j}$ \u8868\u793a\u4ece $x$ \u5f00\u59cb\uff0c\u53ea\u7ecf\u8fc7 $x$ \u5b50\u6811\u5185\uff0c$j$ \u6b65\u540e\u56de\u5230 $i$ \u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u663e\u7136\u53ef\u4ee5\u679a\u4e3e $i$ \u7b2c\u4e00\u6b65\u5230\u8fbe\u7684\u70b9\u662f\u4ec0\u4e48\uff0c\u7ecf\u8fc7\u591a\u5c11\u6b65\u4e4b\u540e\u7b2c\u4e00\u6b21\u56de\u5230 $x$\uff0c\u90a3\u4e48\u6709 $f_{x,j}=\\sum\\limits_{y\\in\\text{son}(x)}\\sum\\limits_{t=2k,t\\le j,k\\in\\mathbb{Z}^+}f_{y,t-2}f_{x,j-t}$\uff0c\u8fd9\u4e2a\u663e\u7136\u53ef\u4ee5\u4e00\u904d DFS \u5e26\u8d70\uff0c\u6211\u4eec\u518d\u8bbe $out_{x,j}$ \u8868\u793a\u4ece $fa_x$ \u5f00\u59cb\uff0c\u4e0d\u7ecf\u8fc7 $x$ \u5b50\u6811\u5185\u7684\u70b9\uff0c$j$ \u6b65\u56de\u5230 $x$ \u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u6211\u4eec\u8fd8\u662f\u53ef\u4ee5\u679a\u4e3e\u7b2c\u4e00\u6b65\u5230\u8fbe\u7684\u70b9 $y$ \u4ee5\u53ca\u7b2c\u4e00\u6b21\u56de\u5230 $fa_x$ \u7684\u65f6\u95f4 $t$\uff0c\u90a3\u4e48\u8fd9\u79cd\u60c5\u51b5\u5bf9 $out_{x,j}$ \u7684\u8d21\u732e\u5c31\u662f $v_t\\times out_{x,t}$\uff0c\u5176\u4e2d\u5982\u679c $y$ \u662f $fa_x$ \u7684\u7236\u4eb2\uff0c\u90a3\u4e48 $v_t=out_{fa_x,t}$\uff0c\u5426\u5219 $v_t=f_{y,t}$\uff0c\u8fd9\u4e2a\u66b4\u529b\u641e\u662f $\\mathcal O(deg_i^2)$ \u7684\uff0c\u78b0\u5230\u83ca\u82b1\u56fe\u5c31\u51c9\u51c9\u4e86\uff0c\u8003\u8651\u4f18\u5316\uff0c\u6ce8\u610f\u5230\u8fd9\u4e1c\u897f\u53ef\u4ee5\u5199\u6210 $\\sum\\limits_{t}S_t\\times out_{x,t}$ \u7684\u5f62\u5f0f\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u5148\u63d0\u524d\u4e00\u904d\u9884\u5904\u7406\u6c42\u51fa\u6240\u6709\u5b50\u6811\u7684 $f_{y,t}$ \u4e4b\u548c\uff0c\u626b\u5230\u4e00\u4e2a\u5b50\u6811\u65f6\u5c31\u628a\u8be5\u5b50\u6811\u5185\u7684\u8d21\u732e\u64a4\u9500\u6389\uff0c\u56de\u6eaf\u65f6\u518d\u52a0\u4e0a\uff0c\u8fd9\u6837\u590d\u6742\u5ea6\u5c31 ok \u4e86\u3002\u6700\u540e $dp_{x,j}$ \u7684\u8f6c\u79fb\u65b9\u7a0b\u5c31\u6bd4\u8f83\u5bb9\u6613\u4e86\uff0c\u8fd8\u662f\u679a\u4e3e\u7b2c\u4e00\u6b65\u5230\u8fbe\u7684\u70b9 $y$ \u548c\u7b2c\u4e00\u6b21\u56de\u5230 $x$ \u7684\u65f6\u95f4 $t$\uff0c\u90a3\u4e48\u5982\u679c $y$ \u662f $x$ \u7684\u7236\u4eb2\u8d21\u732e\u5c31\u662f $out_{x,t-2}dp_{x,j-t}$\uff0c\u5426\u5219\u662f $f_{y,t-2}dp_{x,j-t}$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(nk^2)$\u3002\n\n\u53ef\u4ee5\u5199\u4e2a\u7c7b\u5c01\u88c5\u4e00\u4e0b\uff0c\u907f\u514d\u5199\u8fc7\u591a\u4e00\u6a21\u4e00\u6837\u7684\u4ee3\u7801\u3002\n\n```cpp\nconst int MAXN=4000;\nconst int MAXK=75;\nconst int MOD=998244353;\nint k,fac[MAXK+5],ifac[MAXK+5];\nvoid init_fac(int n){\n\tfor(int i=(fac[0]=ifac[0]=ifac[1]=1)+1;i<=n;i++) ifac[i]=1ll*ifac[MOD%i]*(MOD-MOD/i)%MOD;\n\tfor(int i=1;i<=n;i++) fac[i]=1ll*fac[i-1]*i%MOD,ifac[i]=1ll*ifac[i-1]*ifac[i]%MOD;\n}\nstruct tree_solver{\n\tint n,hd[MAXN+5],to[MAXN*2+5],nxt[MAXN*2+5],ec=0,sum[MAXK+5];\n\tvoid adde(int u,int v){to[++ec]=v;nxt[ec]=hd[u];hd[u]=ec;}\n\tvoid read(){for(int i=1,u,v;i<n;i++) scanf(\"%d%d\",&u,&v),adde(u,v),adde(v,u);}\n\tint f[MAXN+5][MAXK+5],dp[MAXN+5][MAXK+5],out[MAXN+5][MAXK+5],dep[MAXN+5];\n\tvoid dfs0(int x,int fa){\n\t\tfor(int e=hd[x];e;e=nxt[e]){\n\t\t\tint y=to[e];if(y==fa) continue;\n\t\t\tdep[y]=dep[x]+1;dfs0(y,x);\n\t\t}\n\t}\n\tvoid dfs1(int x,int fa,int t){\n\t\tfor(int e=hd[x];e;e=nxt[e]){\n\t\t\tint y=to[e];if(y==fa) continue;dfs1(y,x,t);\n\t\t\tfor(int i=0;i<t;i+=2) f[x][t]=(f[x][t]+1ll*f[x][i]*f[y][t-i-2])%MOD;\n\t\t}\n\t}\n\tvoid dfs2(int x,int fa,int t){\n\t\tvector<int> s(t+1);\n\t\tfor(int e=hd[x];e;e=nxt[e]){\n\t\t\tint y=to[e];\n\t\t\tif(y==fa) for(int i=0;i<t;i+=2) s[i]=(s[i]+out[x][t-i-2])%MOD;\n\t\t\telse for(int i=0;i<t;i+=2) s[i]=(s[i]+f[y][t-i-2])%MOD;\n\t\t}\n\t\tfor(int e=hd[x];e;e=nxt[e]){\n\t\t\tint y=to[e];if(y==fa) continue;\n\t\t\tfor(int i=0;i<t;i+=2) s[i]=(s[i]-f[y][t-i-2]+MOD)%MOD;\n\t\t\tfor(int i=0;i<t;i+=2) out[y][t]=(out[y][t]+1ll*s[i]*out[y][i])%MOD;\n\t\t\tfor(int i=0;i<t;i+=2) s[i]=(s[i]+f[y][t-i-2])%MOD;\n\t\t\tdfs2(y,x,t);\n\t\t}\n\t}\n\tvoid solve(){\n\t\tdfs0(1,0);\n\t\tfor(int i=1;i<=n;i++) dp[i][0]=f[i][0]=out[i][0]=1;\n\t\tfor(int i=2;i<=k;i+=2){\n\t\t\tdfs1(1,0,i);dfs2(1,0,i);\n//\t\t\tfor(int j=1;j<=n;j++) printf(\"%d %d %d %d\\n\",j,i,f[j][i],out[j][i]);\n\t\t}\n\t\tfor(int i=2;i<=k;i+=2) for(int x=1;x<=n;x++){\n\t\t\tfor(int e=hd[x];e;e=nxt[e]){\n\t\t\t\tint y=to[e];\n\t\t\t\tif(dep[y]>dep[x]){\n\t\t\t\t\tfor(int j=0;j<i;j+=2) dp[x][i]=(dp[x][i]+1ll*dp[x][i-j-2]*f[y][j])%MOD;\n\t\t\t\t} else {\n\t\t\t\t\tfor(int j=0;j<i;j+=2) dp[x][i]=(dp[x][i]+1ll*dp[x][i-j-2]*out[x][j])%MOD;\n\t\t\t\t}\n\t\t\t} //printf(\"%d %d %d\\n\",x,i,dp[x][i]);\n\t\t}\n\t\tfor(int i=0;i<=k;i+=2) for(int x=1;x<=n;x++)\n\t\t\tsum[i]=(sum[i]+1ll*ifac[i]*dp[x][i])%MOD;\n//\t\tfor(int i=0;i<=k;i+=2) printf(\"%d\\n\",sum[i]);\n\t}\n} t1,t2;\nint main(){\n\tscanf(\"%d%d%d\",&t1.n,&t2.n,&k);if(k&1) return puts(\"0\"),0;\n\tt1.read();t2.read();init_fac(k);t1.solve();t2.solve();\n\tint ans=0;for(int i=0;i<=k;i+=2) ans=(ans+1ll*t1.sum[i]*t2.sum[k-i])%MOD;\n\tprintf(\"%d\\n\",1ll*ans*fac[k]%MOD);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1626142282,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF997D Cycles in product"
    },
    {
        "content": "\u9898\u610f\uff1a\u7ed9\u5b9a\u4e24\u68f5\u5927\u5c0f\u5206\u522b\u4e3a$U,V$\u7684\u6811\uff0c\u6839\u636e\u4ee5\u4e0b\u65b9\u6cd5\u6784\u9020\u4e00\u4e2a\u5927\u5c0f\u4e3a$U*V$\u7684\u56fe\uff0c\u95ee\u56fe\u4e2d\u957f\u5ea6\u4e3a$k$\u7684\u73af\u6709\u591a\u5c11\u4e2a\uff0c**\u6ce8\u610f\u4e00\u4e2a\u73af\u4e2d\u4e00\u6761\u8fb9\u548c\u4e00\u4e2a\u70b9\u53ef\u4ee5\u51fa\u73b0\u591a\u6b21**\uff0c\u5bf9$998244353$\u53d6\u6a21\u3002\n\n\u6784\u9020\u65b9\u6cd5\uff1a\u5bf9\u4e8e\u6bcf\u884c\u7684$U$\u4e2a\u70b9\uff0c\u6309\u7167\u5927\u5c0f\u4e3a$U$\u7684\u6811\u7684\u8fde\u63a5\u65b9\u5f0f\u6309\u5bf9\u5e94\u6807\u53f7\u8fde\u63a5\uff0c\u5bf9\u4e8e\u6bcf\u5217\u7684$V$\u4e2a\u70b9\uff0c\u6309\u7167\u5927\u5c0f\u4e3a$V$\u7684\u6811\u7684\u8fde\u63a5\u65b9\u5f0f\u6309\u5bf9\u5e94\u6807\u53f7\u8fde\u63a5\u3002\n\n\u9996\u5148\u6709\u4e00\u4e2a\u7ed3\u8bba\uff1a\u7b2c\u4e00\u68f5\u6811\u4e2d\u4e00\u4e2a\u5927\u5c0f\u4e3a$k_1$\u7684\u73af\u548c\u7b2c\u4e8c\u68f5\u6811\u4e2d\u4e00\u4e2a\u5927\u5c0f\u4e3a$k_2$\u7684\u73af\uff0c\u53ef\u4ee5\u5bf9\u5e94\u6784\u9020\u51fa\u7684\u56fe\u4e2d\u7684$C_{k_1+k_2}^{k_1}$\u4e2a\u73af\u3002\n\n\u56e0\u4e3a\u5728\u56fe\u4e0a\u7ecf\u8fc7\u4e00\u6761\u8fb9\uff0c\u53ef\u4ee5\u770b\u4f5c\u662f\u5728\u4e00\u68f5\u6811\u4e2d\u7ecf\u8fc7\u4e00\u6761\u8fb9\uff0c\u800c\u5728\u53e6\u4e00\u68f5\u6811\u4e2d\u7684\u4f4d\u7f6e\u4e0d\u53d8\u3002\u5982\u679c\u5728\u7b2c\u4e00\u68f5\u6811\u8981\u6309\u987a\u5e8f\u7ecf\u8fc7\u6307\u5b9a\u7684$k_1$\u6761\u8fb9\uff0c\u5728\u7b2c\u4e8c\u68f5\u6811\u4e2d\u8981\u6309\u987a\u5e8f\u7ecf\u8fc7\u6307\u5b9a\u7684$k_2$\u6761\u8fb9\uff0c\u90a3\u4e48\u5728\u6784\u9020\u51fa\u7684\u56fe\u4e2d\u5bf9\u5e94\u7684\u73af\u7684\u6570\u91cf\u53ef\u4ee5\u770b\u6210\u4ece\u4e00\u4e2a$k_1*k_2$\u7684\u7f51\u683c\u56fe\u4e2d\u53ea\u80fd\u5411\u53f3\u6216\u5411\u4e0b\u8d70\u4ece\u5de6\u4e0a\u89d2\u8d70\u5230\u53f3\u4e0b\u89d2\u7684\u65b9\u6848\u6570\uff0c\u800c\u65b9\u6848\u6570\u663e\u7136\u662f$C_{k_1+k_2}^{k_1}$\u3002\n\n\u4e8e\u662f\u53ea\u8981\u6c42\u51fa\u4e24\u68f5\u6811\u4e2d\u957f\u5ea6\u4e3a$0,1,...k$\u7684\u73af\u6570\uff0c$O(k^2)$\u5408\u5e76\u5373\u53ef\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u5728$O(n*k^2)$\u7684\u65f6\u95f4\u5185\u6c42\u51fa\u5728\u4e00\u68f5\u6811\u4e2d\u7ecf\u8fc7\u70b9$V$\u7684\u957f\u5ea6\u4e3a$0,1,...k$\u7684\u73af\u6570\u3002\n\n\u4e00\u6761\u4ece$x$\u5f00\u59cb\u7ecf\u8fc7$V$\u7684\u73af\u8981\u7ecf\u8fc7$V$\uff0c\u518d\u8fd4\u56de$x$\uff0c\u53ea\u8981\u4eceV\u5f00\u59cb$O(nk)$DP\u5373\u53ef\u3002\n\n\u4ee4$f[i][j]$\u8868\u793a\u4ece$i$\u5f00\u59cb\u8d70$j$\u6b65\u7b2c\u4e00\u6b21\u7ecf\u8fc7$V$\u7684\u65b9\u6848\u6570\uff0c$g[i][j]$\u8868\u793a\u4ece$i$\u5f00\u59cb\u8d70$j$\u6b65\u7b2c\u4efb\u610f\u6b21\u5230\u8fbe$V$\u7684\u65b9\u6848\u6570\u3002\n\n\u521d\u59cb\u503c$f[V][0]=g[V][0]=1$\u3002\n\n\u5bf9\u4e8e$g$\u7684\u8f6c\u79fb\uff0c\u53ea\u8981$g[i][j]=\\sum_{(i,k)\\in Edges} g[k][j-1]$\u5373\u53ef\u3002\n\n\u5bf9\u4e8e$f$\u7684\u8f6c\u79fb\uff0c\u5728$g$\u7684\u8f6c\u79fb\u7684\u57fa\u7840\u4e0a\u6309\u7167\u5b9a\u4e49\u52a0\u4e0a\u9650\u5236\u5373\u53ef\u3002\n\n\u63a5\u4e0b\u6765\u5728$O(nk^2)$\u7684\u65f6\u95f4\u5185\u7edf\u8ba1\u51fa\u5bf9\u7b54\u6848\u7684\u8d21\u732e\uff0c\u5bf9\u4e8e\u6bcf\u4e2a\u8282\u70b9$x$\uff0c\u5c06\u957f\u5ea6\u4e3a$len$\u7684\u73af\u6570\u52a0\u4e0a$\\sum_{len_1+len_2=len} f[x][len1]*g[x][len2]$\u5373\u53ef\u3002\u6ce8\u610f\u8282\u70b9$V$\u8981\u7279\u5224\uff0c\u76f4\u63a5\u5c06\u957f\u5ea6\u4e3a$len$\u7684\u73af\u6570\u52a0\u4e0a$g[V][len]$\u3002\n\n\u5c06\u7ecf\u8fc7\u4e00\u4e2a\u8282\u70b9\u7684\u73af\u6570\u7edf\u8ba1\u5b8c\u4ee5\u540e\uff0c\u6211\u4eec\u53ea\u8981\u7edf\u8ba1\u53bb\u6389\u8fd9\u4e2a\u8282\u70b9\u540e\u5269\u4e0b\u7684\u51e0\u4e2a\u5b50\u6811\u5185\u7684\u8d21\u732e\u5373\u53ef\uff0c\u4e0d\u96be\u53d1\u73b0\u53ef\u4ee5\u70b9\u5206\u6cbb\u5728$O(k^2nlogn)$\u7684\u65f6\u95f4\u5185\u89e3\u51b3\u3002\n\n~~\u7801\u98ce\u6709\u70b9\u4e11~~\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=4010,maxk=110,maxc=100100,mod=998244353;\ninline int ksm(int a,int b)\n{\n\tint res=1;\n\tfor(;b;b>>=1,a=1ll*a*a%mod) if(b&1) res=1ll*res*a%mod;\n\treturn res;\n}\ninline void Add(int &a,int b){a=a+b>=mod?a+b-mod:a+b;}\nint fac[maxc],facinv[maxc];int k;\ninline int C(int n,int m){return 1ll*fac[n]*facinv[n-m]%mod*facinv[m]%mod;}\nint n,head[maxn],nxt[maxn<<1],ver[maxn<<1],tot;\ninline void clear(){memset(head,0,sizeof(head));tot=0;}\ninline void addedge(int a,int b)\n{\n\tnxt[++tot]=head[a];ver[tot]=b;head[a]=tot;\n\tnxt[++tot]=head[b];ver[tot]=a;head[b]=tot;\n}\nint tmp[maxk];bool vis[maxn];int size[maxn],ms,rt,allsize;\nvector<int> v;unordered_map<int,int> id;\nint f[maxn][maxk],g[maxn][maxk];\ninline void treedp(int x)\n{\n\tfor(int i=0;i<=k;i++) for(int j=0;j<(int)v.size();j++) f[j][i]=g[j][i]=0;\n\tf[id[x]][0]=g[id[x]][0]=1;\n\tfor(int i=1;i<=k;i++) for(int j=0;j<(int)v.size();j++)\n\t{\n\t\tint now=j;\n\t\tfor(int ppp=head[v[j]];ppp;ppp=nxt[ppp]) if(id.count(ver[ppp]))\n\t\t{\n\t\t\tint lst=id[ver[ppp]];\n\t\t\tif(ver[ppp]!=x||i==1) Add(f[now][i],f[lst][i-1]);\n\t\t\tAdd(g[now][i],g[lst][i-1]);\n\t\t}\n\t}\n\tfor(int i=0;i<=k;i++) Add(tmp[i],g[id[x]][i]);\n\tfor(int tot=0;tot<=k;tot++) for(int a=0;a<=tot;a++)\n\t{\n\t\tint b=tot-a;\n\t\tfor(int i=0;i<(int)v.size();i++) if(v[i]!=x) Add(tmp[tot],1ll*f[i][a]*g[i][b]%mod);\n\t}\n}\ninline void getroot(int x,int fat)\n{\n\tsize[x]=1;int mx=0;\n\tfor(int i=head[x];i;i=nxt[i])\n\t{\n\t\tint y=ver[i];if(y==fat||vis[y]) continue;\n\t\tgetroot(y,x);mx=max(mx,size[y]);size[x]+=size[y];\n\t}\n\tmx=max(mx,allsize-size[x]);\n\tif(mx<ms) ms=mx,rt=x;\n}\ninline void getvector(int x,int fat)\n{\n\tid[x]=v.size();v.push_back(x);\n\tfor(int i=head[x];i;i=nxt[i])\n\t{\n\t\tint y=ver[i];if(y==fat||vis[y]) continue;\n\t\tgetvector(y,x);\n\t}\n}\ninline int getroot(int RT){allsize=v.size();ms=1000000000;rt=0;getroot(RT,0);return rt;}\ninline void dfs(int x)\n{\n\tv.clear();id.clear();getvector(x,0);x=getroot(x);\n\ttreedp(x);vis[x]=1;\n\tfor(int i=head[x];i;i=nxt[i]) if(vis[ver[i]]==0) dfs(ver[i]);\n}\ninline void solve_tree(){memset(vis,0,sizeof(vis));memset(tmp,0,sizeof(tmp));dfs(1);}\nint l1[maxk],l2[maxk];\nint main()\n{\n\tfac[0]=1;for(int i=1;i<maxc;i++) fac[i]=1ll*fac[i-1]*i%mod;\n\tfacinv[maxc-1]=ksm(fac[maxc-1],mod-2);\n\tfor(int i=maxc-2;i>=0;i--) facinv[i]=1ll*facinv[i+1]*(i+1)%mod;\n\tint n1,n2,ans=0;scanf(\"%d%d%d\",&n1,&n2,&k);\n\tfor(int i=1,a,b;i<n1;i++) scanf(\"%d%d\",&a,&b),addedge(a,b);\n\tn=n1;solve_tree();for(int i=0;i<=k;i++) l1[i]=tmp[i];\n\tclear();for(int i=1,a,b;i<n2;i++) scanf(\"%d%d\",&a,&b),addedge(a,b);\n\tn=n2;solve_tree();for(int i=0;i<=k;i++) l2[i]=tmp[i];\n\tfor(int i=0;i<=k;i++) Add(ans,1ll*l1[i]*l2[k-i]%mod*C(k,i)%mod);\n\tprintf(\"%d\",ans);\n}\n```",
        "postTime": 1544086014,
        "uid": 84419,
        "name": "daifucong",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF997D \u3010Cycles in product\u3011"
    },
    {
        "content": "\u8fd9\u91cc\u63d0\u4f9b\u4e00\u79cd\u53ea\u6d3b\u5728\u7406\u8bba\u590d\u6742\u5ea6\u91cc\u7684\u505a\u6cd5\uff08\u4ee5\u53ca\u9488\u5bf9\u5b9e\u9645\u60c5\u51b5\u7684\u4f18\u5316\u65b9\u6848\uff09\u3002\n\n\u548c\u4e0a\u4e00\u7bc7\u9898\u89e3\u4e00\u6837\uff0c\u6211\u4eec\u4f9d\u7136\u9700\u8981\u53d1\u73b0\u4e00\u4e2a\u7ed3\u8bba\uff1a\u82e5$T_1$\u4e2d\u6709$k_x$\u4e2a\u957f\u5ea6\u4e3a$x$\u7684\u73af\uff0c$T_2$\u4e2d\u6709$k_y$\u4e2a\u957f\u5ea6\u4e3a$y$\u7684\u73af\uff0c\u5219\u53ef\u4ee5\u6784\u9020\u51fa$\\binom{k_x+k_y}{k_y}$\u4e2a\u957f\u5ea6\u4e3a$x+y$\u7684\u73af\u3002\u672c\u8d28\u4e0a\u5c31\u662f\u7f51\u683c\u56fe\u7684\u6700\u77ed\u8def\u5f84\u8ba1\u6570\uff0c\u81ea\u8bc1\u4e0d\u96be\u3002\n\n\u6240\u4ee5\u73b0\u5728\u6211\u4eec\u9700\u8981\u5bf9$T_1,T_2$\u5206\u522b\u6c42\u51fa\u6bcf\u79cd\u957f\u5ea6\u7684\u73af\u6709\u591a\u5c11\u4e2a\u3002\u8003\u8651\u9012\u63a8\u8ba1\u7b97\u4ee5\u6bcf\u4e2a\u70b9\u5f00\u59cb\u7684\u73af\u7684\u6570\u91cf\uff0c\u4e0d\u96be\u8bbe\u8ba1\u5982\u4e0b\u72b6\u6001\uff1a$f_{i,j}$\u4ee3\u8868\u5728\u4ee5$i$\u4e3a\u6839\u7684\u5b50\u6811\u4e2d\uff0c\u4ece$i$\u5f00\u59cb\uff0c\u957f\u5ea6\u4e3a$j$\u7684\u73af\u7684\u6570\u91cf\u3002\u6811\u6839\u662f\u4efb\u610f\u6307\u5b9a\u7684\u3002\n\n\u63a5\u4e0b\u6765\u5206\u6790\u8f6c\u79fb\uff1a\u9009\u62e9\u4efb\u610f\u4e00\u4e2a$i$\u7684\u5b50\u8282\u70b9$v$\uff0c\u6211\u4eec\u5c06\u4ece$i$\u8d70\u5230$v$\uff0c\u8d70\u8fc7$v$\u5b50\u6811\u4e2d\u4e00\u4e2a\u4efb\u610f\u5927\u5c0f\u7684\u73af\uff0c\u518d\u4ece$v$\u8d70\u5230$i$\u7684\u8fc7\u7a0b\u79f0\u4e3a\u4e00\u4e2apattern\uff0c\u90a3\u4e48\u53ef\u4ee5\u53d1\u73b0\u5f53\u524d\u9700\u8981\u8ba1\u7b97\u7684\u73af\u90fd\u662f\u7531\u4efb\u610f\u591a\u4e2apattern\u6392\u5217\u800c\u6210\u7684\u3002\n\n\u6211\u4eec\u5c1d\u8bd5\u7528\u751f\u6210\u51fd\u6570\u6765\u8868\u793a\u8fd9\u4e2a\u8fc7\u7a0b\u3002\u8bbe$F_i(z)=\\sum\\limits_{j=0}^k f_{i,j}z^j$\u3002\n\n\u5bf9\u4e8e\u67d0\u4e2a\u5b50\u8282\u70b9$v$\uff0c\u6240\u6709\u7ecf\u8fc7\u4e86$v$\u7684\u5b50\u6811\u7684pattern\u5bf9\u5e94\u7684\u751f\u6210\u51fd\u6570\u5e94\u8be5\u662f$z^2F_v(z)$\uff0c$z^2$\u662f\u56e0\u4e3a\u4f1a\u6709$i\\rightarrow v$\u548c$v\\rightarrow i$\u8fd9\u4e24\u6761\u989d\u5916\u7684\u8fb9\u3002\u8fdb\u4e00\u6b65\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u6240\u6709\u53ef\u80fd\u7684pattern\u5bf9\u5e94\u7684\u751f\u6210\u51fd\u6570\u5e94\u8be5\u662f\n\n$$G(z) = \\sum\\limits_{v\\ \\textrm{is son of}\\ i} z^2F_v(z)$$\n\n\u8868\u793a\u4efb\u610f\u591a\u4e2apattern\u7684\u6392\u5217\u6240\u7ec4\u6210\u7684\u96c6\u5408\u53ef\u4ee5\u901a\u8fc7\u679a\u4e3e\u4e2a\u6570\u6765\u8003\u8651\u3002\u6392\u5217\u4e2d\u6ca1\u6709\u4efb\u4f55\u4e00\u4e2apattern\u7684\u60c5\u51b5\uff0c\u5bf9\u5e94\u4e86$G^0(z)$\uff1b\u6709\u4e00\u4e2a\u7684\u60c5\u51b5\uff0c\u5bf9\u5e94$G^1(z)$\uff1b\u6709\u4e24\u4e2a\u7684\u60c5\u51b5\uff0c\u5bf9\u5e94$G^2(z)$...... \u4efb\u610f\u591a\u79cd\u662f\u6240\u6709\u60c5\u51b5\u7684\u5e76\uff0c\u6240\u4ee5\u53ea\u8981\u5c06\u5b83\u4eec\u90fd\u52a0\u8d77\u6765\u5c31\u597d\u4e86\u3002\u4e8e\u662f\u6839\u636e\u5f62\u5f0f\u5e42\u7ea7\u6570\u7684\u57fa\u672c\u77e5\u8bc6\u5f97\u5230\uff1a\n\n$$F_i(z)=\\sum_{j=0}^{+\\infty} G^j(z)=\\frac{1}{1-G(z)}$$\n\n\u90a3\u4e48\u6211\u4eec\u53ea\u8981\u8fd0\u7528\u591a\u9879\u5f0f\u6c42\u9006\uff0c\u5c31\u53ef\u4ee5\u5728\u6811\u6839\u786e\u5b9a\u7684\u60c5\u51b5\u4e0b\u6c42\u51fa\u6240\u6709$f_{i,j}$\uff0c\u590d\u6742\u5ea6\u4e3a$O(nk\\log k)$\u3002\u5047\u8bbe\u5f53\u524d\u6811\u6839\u4e3a$r$\uff0c\u90a3\u4e48$f_{r,k}$\u5c31\u662f\u4ece$r$\u5f00\u59cb\u7684\u73af\u7684\u6570\u91cf\u3002\n\n\u4f46\u662f\u8fd9\u53ea\u6c42\u4e86\u5355\u72ec\u7684\u4e00\u4e2a$r$\uff0c\u6211\u4eec\u9700\u8981\u5bf9\u6bcf\u4e00\u4e2a\u70b9\u4e3a\u6839\u7684\u60c5\u51b5\u8ba1\u7b97\u4e00\u904d\u3002\n\n\u8003\u8651\u6362\u6839\u64cd\u4f5c\uff1a\u5047\u8bbe\u5f53\u524d\u7684\u6839\u662f$r$\uff0c\u8981\u6cbf\u67d0\u6761\u8fb9\u628a\u6839\u79fb\u5230$w$\u3002\u4e0d\u96be\u53d1\u73b0\uff0c\u8fd9\u53ef\u4ee5\u770b\u4f5c\u4e24\u4e2a\u64cd\u4f5c\uff1a\u5c06\u6839\u4e3a$r$\u65f6\uff0c\u6574\u68f5\u6811\u9664\u53bb$w$\u7684\u5b50\u6811\u4e4b\u5916\u7684\u90e8\u5206\u52a0\u5165w\u7684\u5b50\u6811\u96c6\u5408\uff0c\u5c06w\u7684\u5b50\u6811\u4ece$r$\u7684\u5b50\u6811\u96c6\u5408\u4e2d\u79fb\u9664\u3002\n\n\u4ece\u751f\u6210\u51fd\u6570\u7684\u76f8\u4e92\u8d21\u732e\u4e0a\u6765\u770b\uff0c\u53ef\u4ee5\u5199\u4f5c\u5982\u4e0b\u4f2a\u4ee3\u7801\uff1a\n\n$$F_r(z)\\leftarrow \\frac{1}{F_r(z)+z^2F_w(z)}$$\n\n$$F_w(z)\\leftarrow \\frac{1}{F_w(z)-z^2F_r(z)}$$\n\n\u53ef\u4ee5\u901a\u8fc7\u591a\u9879\u5f0f\u6c42\u9006\u5728$O(k\\log k)$\u65f6\u95f4\u5185\u5b8c\u6210\u5355\u6b21\u6362\u6839\u64cd\u4f5c\u3002\n\n\u5bf9\u4e24\u68f5\u90fd\u505a\u4e00\u904d\u4e0a\u8ff0\u90a3\u4e00\u5806\u4e1c\u897f\uff0c\u5373\u53ef\u5728$O(nk\\log k)$\u65f6\u95f4\u5185\u6c42\u51fa\u6bcf\u79cd\u73af\u957f\u5ea6\u51fa\u73b0\u7684\u6b21\u6570\uff0c\u8fdb\u800c\u6c42\u51fa\u7b54\u6848\u3002\n\n#### _\u201c\u4f60\u600e\u4e48\u4e0d\u5199\u4ee3\u7801\uff1f\u201d_\n\n#### _\u201c\u6211\u5199\u4e86\uff0c\u4e00\u53d1T\u4e86\uff0c\u6709\u4ec0\u4e48\u597d\u8bf4\u7684\u201d_\n\n\u8981\u4e0d\u7136\u600e\u4e48\u8bf4\u662f\u53ea\u6d3b\u5728\u7406\u8bba\u590d\u6742\u5ea6\u91cc\u5462......\n\n\u5f88\u660e\u663e\uff0c\u56e0\u4e3a\u591a\u9879\u5f0f\u6c42\u9006\u7684\u89c4\u6a21\u662f$k$\uff0c\u800c$k$\u5341\u5206\u5c0f\uff0c\u6240\u4ee5\u76f8\u5bf9\u6765\u8bb2\u5e38\u6570\u662f\u5341\u5206\u5e9e\u5927\u7684\u3002\u4e8e\u662f\u8fd9\u91cc\u628a\u6c42\u9006\u6539\u6210$O(k^2)$\u66b4\u529b\u6c42\u9006\uff0c\u5c31\u53ef\u4ee5\u7528\u8f83\u5c0f\u7684\u5e38\u6570\uff0c\u5728$O(nk^2)$\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e0b\u901a\u8fc7\u6b64\u9898\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <cstdlib>\n#include <algorithm>\n#include <vector>\n#define mod 998244353\n\nusing namespace std;\ntypedef long long ll;\nconst int MAXN = 4005;\ninline int readint()\n{\n\tint res = 0, f = 1;\n\tchar c = 0;\n\twhile(!isdigit(c))\n\t{\n\t\tc = getchar();\n\t\tif(c=='-')\n\t\t\tf = -1;\n\t}\n\twhile(isdigit(c))\n\t\tres = res*10+c-'0', c = getchar();\n\treturn res*f;\n}\nint n1,n2,k;\nstruct Node\n{\n\tint u,v;\n\tNode *next;\n}*h[2][MAXN],pool[MAXN<<2];\nint tot = 0;\ninline void addEdge(int id, int u, int v)\n{\n\tNode *p = &pool[++tot], *q = &pool[++tot];\n\tp->v = v; p->next = h[id][u]; h[id][u] = p;\n\tq->v = u; q->next = h[id][v]; h[id][v] = q;\n}\nstruct Poly\n{\n    vector<ll> a;\n\tint deg;\n\tPoly(int n = 0, int pos = 0, int x = 1)\n\t{\n        a.clear();\n        for(int i = 0; i<=n; i++)\n        \ta.push_back((i==pos)*x);\n\t    deg = n;\n\t}\n\tinline Poly resize(int n)\n\t{\n        if(deg>n)\n            while(a.size()>n+1)\n                a.pop_back();\n        if(deg<n)\n            while(a.size()<n+1)\n                a.push_back(0);\n        deg = n;\n        return *this;\n\t}\n\tPoly operator*(Poly t)\n\t{ \n        int tn = deg, tm = t.deg;\n        tm += tn;\n        Poly res(tm,0,0);\n        for(int i = 0; i<=deg; i++)\n            for(int j = 0; j<=t.deg; j++)\n\t\t\t\tres.a[i+j] = (res.a[i+j]+a[i]*t.a[j])%mod;\n\t\treturn res;\n\t}\n\tPoly operator*(ll t)\n\t{\n        Poly res(deg);\n        for(int i = 0; i<=deg; i++)\n            res.a[i] = a[i]*t%mod;\n        return res;\n\t}\n\tPoly operator+(Poly t)\n\t{\n        Poly res(max(deg,t.deg));\n        for(int i = 0; i<=res.deg; i++)\n        {\n            res.a[i] = (i<=deg?a[i]:0)+(i<=t.deg?t.a[i]:0);\n\t        res.a[i] -= res.a[i]>=mod?mod:0;\n\t\t}\n\t\treturn res;\n\t}\n\tPoly operator-(Poly t)\n\t\t{ return (*this)+t*(mod-1); }\n\tinline Poly inv()\n\t{\n\t    Poly res(deg,0,1);\n\t    for(int i = 1; i<=deg; i++)\n\t    {\n\t        ll sum = 0;\n\t        for(int j = 1; j<=i; j++)\n\t            sum = (sum+a[j]*res.a[i-j])%mod;\n\t        res.a[i] = mod-sum;\n\t\t}\n\t\treturn res;\n\t}\n};\nPoly f[2][MAXN];\ninline void initDfs(int id, int u, int fa)\n{\n    f[id][u] = Poly(k,0,0);\n    for(Node *p = h[id][u]; p; p=p->next)\n        if(p->v!=fa)\n        {\n            initDfs(id,p->v,u);\n           \tf[id][u] = (f[id][u]+Poly(2,2,1)*f[id][p->v]).resize(k);\n\t\t}\n\tf[id][u] = (Poly(0,0,1)-f[id][u]).inv();\n}\nll res[2][105];\ninline void trans(int id, int u, int v)\n{\n\tf[id][u] = (f[id][u].inv()+Poly(2,2,1)*f[id][v]).resize(k).inv();\n\tf[id][v] = (f[id][v].inv()-Poly(2,2,1)*f[id][u]).resize(k).inv();\n}\ninline void dfs(int id, int u, int fa)\n{\n\tfor(int i = 0; i<=k; i++)\n\t\tres[id][i] = (res[id][i]+f[id][u].a[i])%mod;\n\tfor(Node *p = h[id][u]; p; p=p->next)\n\t    if(p->v!=fa)\n\t    {\n\t        trans(id,u,p->v);\n\t        dfs(id,p->v,u);\n\t        trans(id,p->v,u);\n\t\t}\n}\nll c[105][105];\n\nint main()\n{\n\tn1 = readint(), n2 = readint(), k = readint();\n\tfor(int i = 1; i<n1; i++)\n\t    addEdge(0,readint(),readint());\n\tfor(int i = 1; i<n2; i++)\n\t    addEdge(1,readint(),readint());\n\tfor(int i = 0; i<2; i++)\n\t    initDfs(i,1,0), dfs(i,1,0);\n\tfor(int i = 0; i<=k; i++)\n\t    c[i][0] = c[i][i] = 1;\n\tfor(int i = 2; i<=k; i++)\n\t    for(int j = 1; j<i; j++)\n\t        c[i][j] = (c[i-1][j-1]+c[i-1][j])%mod;\n\tll ans = 0;\n\tfor(int i = 0; i<=k; i++)\n\t    ans = (ans+res[0][i]*res[1][k-i]%mod*c[k][i]%mod)%mod;\n\tcout << ans << endl;\n\treturn 0;\n}\n\n```\n",
        "postTime": 1584549525,
        "uid": 31098,
        "name": "Caro23333",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF997D \u3010Cycles in product\u3011"
    },
    {
        "content": "\u597d\u9898\u3002\n\n\u7b2c\u4e00\u6b65\uff0c\u4e5f\u662f\u6700\u5173\u952e\u7684\u4e00\u6b65\uff0c\u6211\u4eec\u53d1\u73b0\u8fd9\u4e2a\u70b9\u5728\u56fe\u4e0a\u79fb\u52a8\u65f6\uff0c\u8d70\u4e24\u68f5\u6811\u7684\u8fb9\u662f\u6ca1\u6709\u5173\u8054\u7684\u3002\u5c31\u662f\u8bf4\uff0c\u5728\u4e00\u68f5\u6811\u4e0a\u8d70\u82e5\u5e72\u6b65\u540e\uff0c\u5728\u7b2c\u4e8c\u68f5\u6811\u5176\u5b9e\u8fd8\u662f\u4f4d\u4e8e\u540c\u4e00\u4e2a\u70b9\u3002\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u5c06\u6bcf\u68f5\u6811\u7684\u7b54\u6848\u5206\u522b\u6c42\u51fa\uff0c\u518d\u5408\u8d77\u6765\u3002\u5177\u4f53\u5730\n\n$$ans=\\sum_{x=1}^n\\sum_{y=1}^m\\sum_{i=0}^kdp1_{x,i}\\times dp2_{y,k-i}\\times\\dbinom{k}{i}$$\n$$=\\sum_{i=0}^k\\dbinom{k}{i}\\sum_{x=1}^ndp1_{x,i}\\sum_{y=1}^mdp2_{y,k-i}$$\n\n\u5176\u4e2d $dp_{i,j}$ \u8868\u793a\u4ece $i$ \u51fa\u53d1\uff0c\u8d70 $j$ \u6b65\u5230\u8fbe $i$ \u7684\u65b9\u6848\u6570\u3002\n\n\u73b0\u5728\u8003\u8651\u6c42\u4e00\u68f5\u6811\u7684\u7b54\u6848\uff0c\u8003\u8651\u6362\u6839 DP\u3002\u8bbe $f_{i,j}$ \u8868\u793a\u4ece $i$ \u51fa\u53d1\uff0c\u5728 $i$ \u5b50\u6811\u5185\u8d70 $j$ \u6b65\u5230\u8fbe $i$ \u7684\u65b9\u6848\u6570\u3002\u8fd9\u4e2a\u8003\u8651\u679a\u4e3e\u7b2c\u4e00\u6b21\u8fd4\u56de $i$ \u7684\u65f6\u95f4\uff0c\u5c31\u53ef\u4ee5 $O(nk)$ \u8f6c\u79fb\uff08\u7c7b\u4f3c\u6811\u5f62\u80cc\u5305\uff09\u3002\n\n\u4e4b\u540e\u7b2c\u4e8c\u6b21 DP\uff0c\u8003\u8651 $dp_{i,j}=\\sum_{l=2}^jdp_{i,j-l}\\times f2_{i,l-2}+\\sum_{v\\in son_i}\\sum_{l=2}^jdp_{i,j-l}\\times f_{v,l-2}$\n\n\u5373\u8003\u8651\u679a\u4e3e\u7b2c\u4e00\u6b21\u56de\u5230 $i$ \u65f6\u7684\u65f6\u95f4 $l$\uff0c\u5bf9\u4e8e\u5230 $i$ \u7684\u513f\u5b50\u5c31\u662f $f_{v,l}$\uff0c\u5230 $i$ \u7684\u7236\u4eb2\u5c31\u662f $f2_{fa_i,l-2}$\uff0c\u5176\u4e2d $f2_{i,j}$ \u8868\u793a\u4ece $fa_i$ \u5f00\u59cb\uff0c\u8d70\u4e0d\u5728 $i$ \u5b50\u6811\u5185\u7684\u70b9 $j$ \u6b65\u56de\u5230 $i$ \u7684\u65b9\u6848\u6570\u3002\u8003\u8651\u7ee7\u7eed\u8df3 $fa$ \u8fd8\u662f\u53bb $fa_i$ \u5176\u4ed6\u7684\u513f\u5b50\uff0c\u4e4b\u540e\u679a\u4e3e\u7b2c\u4e00\u6b21\u56de\u5230 $fa_i$ \u7684\u65f6\u95f4\uff0c\u4e0e\u4e0a\u9762 $dp$ \u6570\u7ec4\u7684\u8f6c\u79fb\u7c7b\u4f3c\uff0c\u8bbe $fa_i=y$\uff0c\u5219\uff1a $f2_{i,j}=\\sum_{l=2}^jf2_{i,j-l}\\times f2_{y,l-2}+\\sum_{v\\in son_y\\&v\\neq i}\\sum_{l=2}^jf2_{i,j-l}\\times f_{v,l-2}$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u6709\u4e00\u4e2a\u5ea6\u6570\u7684\u5e73\u65b9\uff0c\u8fd8\u8981\u7ee7\u7eed\u4f18\u5316\u3002\n\n$$\\sum_{v\\in son_y\\&v\\neq i}\\sum_{l=2}^jf2_{i,j-l}\\times f_{v,l-2}$$\n$$=\\sum_{l=2}^jf2_{i,j-l}\\sum_{v\\in son_y\\&v\\neq i}f_{v,l-2}$$\n\n\u7ef4\u62a4 $\\sum_{v\\in son_y\\&v\\neq i}f_{v,l-2}$ \u5373\u53ef\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(nk^2)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int inf = 2e9;\ninline int read() {\n\tint s = 0,f = 1;char ch = getchar();\n\twhile (!isdigit(ch)) f = ch == '-' ? -1 : 1, ch = getchar();\n\twhile (isdigit(ch)) s = (s << 3) + (s << 1) + ch - '0', ch = getchar();\n\treturn s*f;\n}\nint n,m,K,head[4010],cnt,tmp[80],sum[4010];\nstruct edge {\n\tint v,nxt;\n}ed[8010];\nvoid add(int u,int v) {\n\ted[++cnt] = {v,head[u]};\n\thead[u] = cnt;\n}\nconst int mod = 998244353;\nint d,dp[2][4010][80],f[2][4010][80],f2[2][4010][80],fa[4010];\nvoid dfs(int x,int ft) {\n\tf[d][x][0] = 1;\n\tfa[x] = ft;\n\tfor (int i = head[x];i;i = ed[i].nxt) {\n\t\tint v = ed[i].v;\n\t\tif (v == ft) continue; \n\t\tdfs(v,x);\n\t}\n\tfor (int j = 2;j <= K;j += 2)\n\t\tfor (int i = head[x];i;i = ed[i].nxt) {\n\t\t\tint v = ed[i].v;\n\t\t\tif (v == ft) continue;\n\t\t\tfor (int k = 2;k <= j;k += 2)\n\t\t\t\tf[d][x][j] = (f[d][x][j] + 1ll * f[d][x][j - k] * f[d][v][k - 2]) % mod;\n\t\t}\n//\tcout << \"qwq:\" << d << ' ' << x << endl;\n//\tfor (int i = 0;i <= K;i ++ ) cout << f[d][x][i] << ' ';\n//\tputs(\"\");\n}\nvoid dfs2(int x) {\n\tif (x != 1) f2[d][x][0] = 1;\n\tdp[d][x][0] = 1;\n//\tfor (int i = 2;i <= K;i += 2) {\n//\t\tfor (int j = 2;j <= i;j += 2) {\n//\t\t\tf2[d][x][i] = (f2[d][x][i] + 1ll * f2[d][x][i - j] * f2[d][fa[x]][j - 2]) % mod;\n//\t\t}\n//\t\tfor (int j = head[fa[x]];j;j = ed[j].nxt) {\n//\t\t\tint v = ed[j].v;\n//\t\t\tif (v == x || v == fa[fa[x]]) continue;\n//\t\t\tfor (int k = 2;k <= i;k += 2)\n//\t\t\t\tf2[d][x][i] = (f2[d][x][i] + 1ll * f2[d][x][i - k] * f[d][v][k - 2]) % mod;\n//\t\t}\n//\t}\n//\tcout << \"qwq:\" << d << ' ' << x << endl;\n//\tfor (int i = 0;i <= K;i ++ ) cout << f2[d][x][i] << ' ';\n//\tputs(\"\");\n\tfor (int j = 2;j <= K;j += 2) sum[j] = 0;\n\tfor (int i = head[x];i;i = ed[i].nxt) {\n\t\tint v = ed[i].v;\n\t\tif (v == fa[x]) continue;\n\t\tf2[d][v][0] = 1;\n\t\tfor (int j = 2;j <= K;j += 2) sum[j] = (sum[j] + f[d][v][j - 2]) % mod;\n\t}\n\tfor (int j = 2;j <= K;j += 2) {\n\t\tfor (int i = head[x];i;i = ed[i].nxt) {\n\t\t\tint v = ed[i].v;\n\t\t\tif (v == fa[x]) continue;\n\t\t\tfor (int k = 2;k <= j;k += 2) {\n\t\t\t\tf2[d][v][j] = (f2[d][v][j] + 1ll * f2[d][v][j - k] * f2[d][x][k - 2]) % mod;\n\t\t\t}\n\t\t\tfor (int k = 2;k <= j;k += 2) {\n\t\t\t\tf2[d][v][j] = (f2[d][v][j] + 1ll * f2[d][v][j - k] * (sum[k] - f[d][v][k - 2] + mod) % mod) % mod;\n\t\t\t}\n\t\t}\n\t}\n\tfor (int i = head[x];i;i = ed[i].nxt) {\n\t\tint v = ed[i].v;\n\t\tif (v == fa[x]) continue;\n\t\tdfs2(v);\n\t}\n\tfor (int i = 2;i <= K;i += 2) {\n\t\tfor (int j = 2;j <= i;j += 2) {\n\t\t\tdp[d][x][i] = (dp[d][x][i] + 1ll * dp[d][x][i - j] * f2[d][x][j - 2]) % mod;\n\t\t}\n\t\tfor (int k = head[x];k;k = ed[k].nxt) {\n\t\t\tint v = ed[k].v;\n\t\t\tif (v == fa[x]) continue;\n\t\t\tfor (int j = 2;j <= i;j += 2) {\n\t\t\t\tdp[d][x][i] = (dp[d][x][i] + 1ll * dp[d][x][i - j] * f[d][v][j - 2]) % mod;\n\t\t\t}\n\t\t}\n\t}\n}\nint C[80][80];\nint main() {\n\tn = read(), m = read(), K = read();\n\tfor (int i = 1;i < n;i ++ ) {\n\t\tint u = read(),v = read();\n\t\tadd(u,v), add(v,u);\n\t}\n\tdfs(1,0), dfs2(1);\n\td = 1;\n\tmemset(head,0,sizeof head), cnt = 0;\n\tmemset(fa,0,sizeof fa);\n\tfor (int i = 1;i < m;i ++ ) {\n\t\tint u = read(),v = read();\n\t\tadd(u,v), add(v,u);\n\t}\n\tdfs(1,0), dfs2(1);\n\tC[0][0] = 1;\n\tfor (int i = 1;i <= K;i ++ ) {\n\t\tC[i][0] = 1;\n\t\tfor (int j = 1;j <= i;j ++ ) C[i][j] = (C[i - 1][j] + C[i - 1][j - 1]) % mod;\n\t}\n\tint ans = 0;\n\tfor (int i = 0;i <= K;i += 2) {\n\t\tint s0 = 0,s1 = 0;\n\t\tfor (int j = 1;j <= n;j ++ ) s0 = (s0 + dp[0][j][i]) % mod;\n\t\tfor (int j = 1;j <= m;j ++ ) s1 = (s1 + dp[1][j][K - i]) % mod;\n\t\tans = (ans + 1ll * s0 * s1 % mod * C[K][i]) % mod;\n\t}\n\tcout << ans;\n\treturn 0;\n}\n```\n",
        "postTime": 1681822445,
        "uid": 94777,
        "name": "Jsxts_",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 Cycles in product"
    },
    {
        "content": "## \u601d\u8def\n\n\u4e0d\u96be\u53d1\u73b0\u4e24\u68f5\u6811\u7684\u72ec\u7acb\u6027\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5206\u522b\u8ba1\u7b97\u4ece\u4e24\u68f5\u6811\u7684\u67d0\u4e2a\u70b9 $i$ \u8d70 $l\\leq k$ \u6b65\u56de\u5230\u8fd9\u4e2a\u70b9\u7684\u65b9\u6848\u6570\uff0c\u8bb0\u5176\u4e3a $f_{i,l,1/2}$\uff0c\u6700\u540e\u4e00\u7ef4\u8868\u793a\u54ea\u68f5\u6811\u3002\u7b54\u6848\u5373\u4e3a $\\sum_{i=1}^{n_1}\\sum_{j=1}^{n_2}\\sum_{l=0}^kf_{i,l,1}\\times f_{j,k-l,2}$\u3002\u901a\u8fc7\u7b80\u5355\u4f18\u5316\u53ef\u4ee5\u505a\u5230 $O(nk)$\u3002\n\n\u8003\u8651\u5982\u4f55\u8ba1\u7b97 $f_{i,l}$\u3002\u8bb0 $dp_{i,l}$ \u4e3a\u5728 $i$ \u5b50\u6811\u5185\u8d70 $l$ \u6b65\u5e76\u56de\u5230\u6839\u7684\u65b9\u6848\u6570\u3002\u5982\u4f55\u8f6c\u79fb\u5230\u7236\u4eb2\u8282\u70b9\uff1f\u8003\u8651\u9012\u63a8\u3002\u5bf9\u4e8e\u6bcf\u4e2a $dp_{i,l}$ \u53ef\u4ee5\u9009\u62e9\u67d0\u4e2a\u513f\u5b50 $v$ \u8d70\u4e86 $l'$ \u6b65\u5e76\u4ee5 $dp_{v,l'}$ \u7684\u7cfb\u6570\u8f6c\u79fb\u5230 $dp_{i,l+l'+2}$\u3002\u8fd9\u6837\u8ba1\u7b97\u662f $O(nk^2)$ \u7684\u3002\n\n\u6b64\u65f6\u6211\u4eec\u5df2\u7ecf\u53ef\u4ee5\u8ba1\u7b97\u51fa $f_{1,l}$ \u4e86\u3002\u5269\u4e0b\u7684\u4e0d\u96be\u60f3\u5230\u6362\u6839\u3002\n\n\u7136\u800c\u8fd9\u9898\u6709\u7279\u6b8a\u70b9\uff0c\u4ed6\u4e0d\u80fd\u76f4\u63a5\u7ef4\u62a4\u524d\u540e\u7f00\u5408\u5e76\u7136\u540e\u8f6c\u79fb\u5230\u67d0\u5b50\u6811\u3002\u5982\u679c\u91cd\u6784\u590d\u6742\u5ea6\u53ef\u80fd\u9ad8\u8fbe $O(n^2k^2)$\u3002\u5982\u4f55\u4f18\u5316\uff1f\u8bb0 $coef_{i,l}$ \u8868\u793a $\\sum_{(v,i)\\in edge}dp_{v,l}$\uff08\u6362\u6839\u65f6\u7ef4\u62a4\uff09\uff0c\u6b64\u65f6\u6211\u4eec\u91cd\u6784 $dp_{i,l}$ \u4e0d\u9700\u8981\u5728\u4f9d\u8d56\u4e8e\u5468\u56f4\u8282\u70b9\u4e2a\u6570\u3002\u6bcf\u6b21\u8f6c\u79fb\u53bb\u6389\u6216\u52a0\u4e0a\u67d0\u5b50\u6811\u53ea\u9700\u8981\u4fee\u6539 $coef_{i,l}$ \u5e76\u91cd\u65b0\u4ee5 $O(k^2)$ \u7684\u65f6\u95f4\u590d\u6742\u5ea6\u8ba1\u7b97 $dp_{i,l}$ \u5373\u53ef\u3002\u6b64\u65f6\u6362\u6839\u590d\u6742\u5ea6\u4e3a $O(nk^2)$\uff0c\u5373\u53ef\u901a\u8fc7\u3002\u5177\u4f53\u53ef\u89c1\u4ee3\u7801\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#pragma GCC optimize(2,3,\"Ofast\",\"inline\")\n#define int long long\n#define double long double\nusing namespace std;\nconst int mod=998244353;\nint qp(int a,int b){\n\tif(b<0){\n\t\treturn qp(qp(a,mod-2),-b);\n\t}\n\tint ans=1;\n\twhile(b){\n\t\tif(b&1) (ans*=a)%=mod;\n\t\t(a*=a)%=mod;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\nint fac[3000005],inv[3000005];\nvoid init(){\n\tfac[0]=1; for(int i=1;i<=3000000;i++) fac[i]=fac[i-1]*i%mod;\n\tinv[3000000]=qp(fac[3000000],mod-2); for(int i=2999999;i>=0;i--) inv[i]=inv[i+1]*(i+1)%mod;\n}\nint C(int i,int j){\n\tif(i<0||j<0||i<j) return 0;\n\treturn fac[i]*inv[j]%mod*inv[i-j]%mod;\n}\nint dp[4005][80],xs[4005][80];\nint f1[4005][80],f2[4005][80];\nvector<int> vc1[4005],vc2[4005];\nvoid make(int now){\n\tmemset(dp[now],0,sizeof(dp[now]));\n\tdp[now][0]=1; \n\tfor(int i=0;i<=75;i++) for(int j=1;j+i<=75;j++) (dp[now][i+j]+=dp[now][i]*xs[now][j])%=mod;\n}\nvoid dfs1(int now,int fa){\n\tfor(auto v:vc1[now]){\n\t\tif(v==fa) continue;\n\t\tdfs1(v,now);\n\t\tfor(int i=0;i<=75;i++){\n\t\t\t(xs[now][i+2]+=dp[v][i])%=mod;\n\t\t}\n\t}\n\tmake(now);\n}\nvoid adfs1(int now,int fa){\n\tfor(int i=0;i<=75;i++) (xs[now][i+2]+=dp[fa][i])%=mod;\n\tmake(now);\n\tfor(int i=0;i<=75;i++) f1[now][i]=dp[now][i];\n\tfor(auto v:vc1[now]){\n\t\tif(v==fa) continue;\n\t\tfor(int i=0;i<=75;i++) (xs[now][i+2]+=mod-dp[v][i])%=mod;\n\t\tmake(now);\n\t\tadfs1(v,now);\n\t\tfor(int i=0;i<=75;i++) (xs[now][i+2]+=dp[v][i])%=mod;\n\t\tmake(now);\n\t}\n\tfor(int i=0;i<=75;i++) (xs[now][i+2]+=mod-dp[fa][i])%=mod;\n\tmake(now);\n}\nvoid dfs2(int now,int fa){\n\tfor(auto v:vc2[now]){\n\t\tif(v==fa) continue;\n\t\tdfs2(v,now);\n\t\tfor(int i=0;i<=75;i++){\n\t\t\t(xs[now][i+2]+=dp[v][i])%=mod;\n\t\t}\n\t}\n\tmake(now);\n}\nvoid adfs2(int now,int fa){\n\tfor(int i=0;i<=75;i++) (xs[now][i+2]+=dp[fa][i])%=mod;\n\tmake(now);\n\tfor(int i=0;i<=75;i++) f2[now][i]=dp[now][i];\n\tfor(auto v:vc2[now]){\n\t\tif(v==fa) continue;\n\t\tfor(int i=0;i<=75;i++) (xs[now][i+2]+=mod-dp[v][i])%=mod;\n\t\tmake(now);\n\t\tadfs2(v,now);\n\t\tfor(int i=0;i<=75;i++) (xs[now][i+2]+=dp[v][i])%=mod;\n\t\tmake(now);\n\t}\n\tfor(int i=0;i<=75;i++) (xs[now][i+2]+=mod-dp[fa][i])%=mod;\n\tmake(now);\n}\nsigned main(){\n\tinit();\n\tint n1,n2,k; cin>>n1>>n2>>k;\n\tfor(int i=1;i<n1;i++){\n\t\tint u,v; cin>>u>>v;\n\t\tvc1[u].push_back(v);\n\t\tvc1[v].push_back(u);\n\t}\n\tfor(int i=1;i<n2;i++){\n\t\tint u,v; cin>>u>>v;\n\t\tvc2[u].push_back(v);\n\t\tvc2[v].push_back(u);\n\t}\n\tmemset(dp,0,sizeof(dp));\n\tmemset(xs,0,sizeof(xs));\n\tdfs1(1,0); adfs1(1,0);\n\tmemset(dp,0,sizeof(dp));\n\tmemset(xs,0,sizeof(xs));\n\tdfs2(1,0); adfs2(1,0);\n\tint ans=0;\n\tint tot1[k+1],tot2[k+1];\n\tfor(int t=0;t<=k;t++) tot1[t]=tot2[t]=0;\n\tfor(int i=1;i<=n1;i++) for(int t=0;t<=k;t++) (tot1[t]+=f1[i][t])%=mod;\n\tfor(int i=1;i<=n2;i++) for(int t=0;t<=k;t++) (tot2[t]+=f2[i][t])%=mod;\n\tfor(int t=0;t<=k;t+=2) (ans+=tot1[t]*tot2[k-t]%mod*C(k,t))%=mod;\n\tcout<<ans;\n\treturn 0;\n}\n```",
        "postTime": 1678198077,
        "uid": 116664,
        "name": "Daniel_lele",
        "ccfLevel": 8,
        "title": "CF997D \u9898\u89e3"
    },
    {
        "content": "#### CF997D Cycles in product\n\n\u56fe\u8bba\u597d\u9898\u3002\n\n\u663e\u7136\u4e00\u4e2a\u6bd4\u8f83\u66b4\u529b\u7684\u601d\u8def\u5c31\u662f\u5efa\u51fa\u56fe\u6765\u5e76\u6c42\u53ef\u4ee5\u91cd\u590d\u70b9\u7684$k$\u5143\u73af\u8ba1\u6570\uff0c\u7136\u800c\u8fd9\u4e2a\u4e1c\u897f\u770b\u8d77\u6765\u5341\u5206\u4e0d\u53ef\u505a\u3002\n\n\u90a3\u4e48\u8003\u8651\u8fd9\u4e2a\u56fe\u7684\u7279\u6b8a\u6027\u8d28\uff0c\u5982\u679c\u5c06\u5176\u770b\u6210\u4e00\u4e2a$(T_1,T_2)$\u7684\u8868\u683c\uff0c\u800c\u5728\u6bcf\u4e00\u5217\u4e0a\u8d70\u6cd5\u662f\u76f8\u540c\u7684\uff0c\u6bcf\u4e00\u884c\u4e0a\u8d70\u6cd5\u4e5f\u53ef\u4ee5\u662f\u76f8\u540c\u7684\u3002\n\n\u90a3\u4e48\u8003\u8651\u4e00\u79cd\u5408\u6cd5\u65b9\u6848\u4e00\u5b9a\u662f\u957f\u6210\u8fd9\u4e2a\u6837\u5b50\u7684\uff1a\u4ece$(i,j)$\u51fa\u53d1\u7528\u4e86$k$\u6b21\u6a2a\u7740\u8d70\u5e76\u4e14\u8d70\u56de\u4e86$j$\uff0c\u7528\u4e86$m-k$\u6b21\u7ad6\u7740\u8d70\u8d70\u56de\u4e86$i$\u3002\n\n\u90a3\u4e48\u7b54\u6848\u663e\u7136\u662f\n$$\nans=\\sum_{k=1}^m f_k\\times g_{m-k}\\times C_m^k\n$$\n\u4e58\u4e0a$C_m^k$\u662f\u56e0\u4e3a\u987a\u5e8f\u662f\u4e0d\u4e00\u5b9a\u7684\uff0c\u53ef\u4ee5\u4ece$m$\u4e2d\u53d6$k$\u6b21\u6a2a\u7740\u8d70\u3002\n\n\u5176\u4e2d$f_i$\u8868\u793a\u5728\u7b2c\u4e00\u68f5\u6811\u4e0a\uff0c\u8d70$i$\u6b65\u56de\u5230\u539f\u70b9\u7684\u65b9\u6848\u6570\uff0c$g_i$\u8868\u793a\u5728\u7b2c\u4e8c\u68f5\u6811\u4e0a\uff0c\u8d70$i$\u6b65\u56de\u5230\u539f\u70b9\u7684\u65b9\u6848\u6570\uff0c\n\n\u8003\u8651\u6362\u6839$dp$\uff0c\u8bbe$f(i,j)$\u8868\u793a\u5728\u6811\u4e0a$i$\u53f7\u70b9\u8d70$j$\u6b65\uff0c\u53ea\u5728\u5f00\u59cb\u548c\u7ed3\u675f\u65f6\u56de\u5230$i$\u7684\u65b9\u6848\u6570\uff0c\u800c$g(i,j)$\u8868\u793a\u5728\u6811\u4e0a$i$\u53f7\u70b9\u8d70$j$\u6b65\u56de\u5230$i$\u7684\u65b9\u6848\u6570\uff08\u4e0d\u8003\u8651\u5f80\u7236\u4eb2\u8d70\uff09\u3002\n\n\u5148\u7528\u4e00\u904d$dfs$\u6c42\u51fa$f$\u548c$g$,\u4e4b\u540e\u5927\u529b\u6362\u6839\u6765\u81ea\u7236\u4eb2\u7684\u65b9\u6848\u5373\u53ef\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<vector>\n#define pb push_back\n#define N 4005\n#define K 85\n#define mod 998244353\n#define int long long\nusing namespace std;\nint read()\n{\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=(x<<3)+(x<<1)+(ch^48);ch=getchar();}\n\treturn x*f;\n}\nint m;\nstruct node\n{\n\tint n,f[N][K],g[N][K],h[N][K],ans[K];\n\tvector<int>G[N];\n\tvoid init()\n\t{\n\t\tfor(int i=1;i<n;i++)\n\t\t{\n\t\t\tint x=read(),y=read();\n\t\t\tG[x].pb(y);G[y].pb(x);\n\t\t}\n\t}\n\tint dfs(int x,int fa)\n\t{\n\t\tint siz=G[x].size();\n\t\tfor(int i=0;i<siz;i++)\n\t\t{\n\t\t\tint v=G[x][i];if(v==fa)continue;\n\t\t\tdfs(v,x);\n\t\t\tfor(int j=0;j<=m;j++)f[x][j]+=g[v][j],f[x][j]%=mod;\n\t\t}\n\t\tg[x][0]=1;\n\t\tfor(int i=1;i<=m;i++)\n\t\t{\n\t\t\tfor(int j=0;j<i;j++)\n\t\t\t{\n\t\t\t\tg[x][i]+=(f[x][j]*g[x][i-j-1])%mod;\n\t\t\t\tg[x][i]%=mod;\n\t\t\t}\n\t\t}\n\t}\n\tint dp(int x,int fa)\n\t{\n\t\tint siz=G[x].size();\n\t\tfor(int i=0;i<siz;i++)\n\t\t{\n\t\t\tint v=G[x][i];if(v==fa)continue;\n\t\t\tfor(int j=0;j<=m;j++)f[x][j]=(f[x][j]-g[v][j]+mod)%mod;//\u51cf\u53bb\u513f\u5b50\u8282\u70b9\u7684\u8d21\u732e\uff0c\u4fdd\u7559\u4ece\u7236\u4eb2\u8282\u70b9\u6765\u7684 \n\t\t\tmemset(g[x],0,sizeof(g[x]));g[x][0]=1;\n\t\t\tfor(int j=0;j<=m;j++)\n\t\t\t{\n\t\t\t\tfor(int k=0;k<j;k++)\n\t\t\t\t{\n\t\t\t\t\tg[x][j]+=f[x][k]*g[x][j-k-1]%mod;\n\t\t\t\t\tg[x][j]%=mod;\n\t\t\t\t}\n\t\t\t}//\u4ece\u7236\u4eb2\u8f6c\u79fb\u6765\u7684g[x]\n\t\t\tfor(int j=0;j<=m;j++)f[v][j]=(f[v][j]+g[x][j])%mod;//\u52a0\u4e0a\u4ece\u7236\u4eb2\u8fc7\u6765\u7684 \n\t\t\tfor(int j=0;j<=m;j++)f[x][j]=(f[x][j]+g[v][j])%mod;//\u56de\u6eaf \n\t\t\th[v][0]=1;\n\t\t\tfor(int j=1;j<=m;j++)\n\t\t\t{\n\t\t\t\tfor(int k=0;k<j;k++)\n\t\t\t\t{\n\t\t\t\t\th[v][j]+=f[v][k]*h[v][j-k-1]%mod;\n\t\t\t\t\th[v][j]%=mod;\n\t\t\t\t}\n\t\t\t}\n\t\t\tdp(v,x);\n\t\t}\n\t}\n\tint doit()\n\t{\n\t\tdfs(1,0);\n\t\tmemcpy(h[1],g[1],sizeof(h[1]));\n\t\tdp(1,0);\n\t\tfor(int i=0;i<=m;i++)\n\t\t{\n\t\t\tfor(int j=1;j<=n;j++)\n\t\t\t{\n\t\t\t\tans[i]+=h[j][i];\n\t\t\t\tans[i]%=mod;\n\t\t\t}\n\t\t}\n\t}\n}T1,T2;\nint fac[200005],ifac[200005],inv[200005];\nint C(int x,int y){return fac[x]*ifac[y]%mod*ifac[x-y]%mod;}\nsigned main()\n{\n\tT1.n=read();T2.n=read();\n\tfac[0]=fac[1]=ifac[0]=ifac[1]=inv[1]=1;\n\tfor(int i=2;i<=200000;i++)\n\t{\n\t\tinv[i]=(mod-mod/i)*inv[mod%i]%mod;\n\t\tifac[i]=ifac[i-1]*inv[i]%mod;\n\t\tfac[i]=fac[i-1]*i%mod;\n\t}\n\tm=read();\n\tif(m&1){puts(\"0\");return 0;}\n\tm>>=1;\n\tT1.init();T2.init();\n\tT1.doit();T2.doit();\n\tint ans=0;\n\tfor(int i=0;i<=m;i++)\n\t{\n\t\t//cout<<T1.ans[i]<<\" \"<<T2.ans[i]<<endl;\n\t\tans+=C(m<<1,i<<1)*T1.ans[i]%mod*T2.ans[m-i]%mod;\n\t\tans%=mod;\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1611802496,
        "uid": 179600,
        "name": "shao0320",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF997D \u3010Cycles in product\u3011"
    }
]
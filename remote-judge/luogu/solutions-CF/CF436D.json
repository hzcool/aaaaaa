[
    {
        "content": "\u5b89\u5229\u4e2a\u4eba blog\uff1ahttps://www.cnblogs.com/ET2006/\n\n[Codeforces \u9898\u76ee\u4f20\u9001\u95e8](https://codeforces.com/contest/436/problem/D) & [\u6d1b\u8c37\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/CF436D)\n\nu1s1 \u8fd9\u9898\u6570\u636e\u8303\u56f4\u6709\u70b9\u8ff7\u60d1\u554a\u2026\u2026\u4e4d\u4e00\u770b $\\mathcal O(nm)$ \u8fc7\u4e0d\u53bb\uff0c\u8fd8\u4ee5\u4e3a\u662f\u6b63\u89e3\u662f $\\mathcal O(n+m^2)$ \u5462\u3002\n\n\u8003\u8651 $dp$\uff0c\u8bbe $f_i$ \u8868\u793a\u7528\u524d $i$ \u4e2a\u5e03\u4e01\uff0c\u5e76\u4e14\u7b2c $i$ \u4e2a\u5e03\u4e01\u8981\u4e48\u4e0d\u52a8\uff0c\u8981\u4e48\u5411\u5de6\u79fb\u52a8\u80fd\u591f\u8986\u76d6\u7684\u6700\u591a\u7279\u6b8a\u683c\u5b50\u6570\uff0c\u518d\u8bbe $g_i$ \u8868\u793a\u524d $i$ \u4e2a\u5e03\u4e01\uff0c\u5e76\u4e14\u7b2c $i$ \u4e2a\u5e03\u4e01\u7684\u4f4d\u7f6e\u4e0d\u53d1\u751f\u53d8\u5316\u6240\u80fd\u8986\u76d6\u7684\u6700\u591a\u7279\u6b8a\u683c\u5b50\u6570\u3002\n\n\u60f3\u597d\u4e86 $dp$ \u72b6\u6001\uff0c\u8f6c\u79fb\u5c31\u6c34\u5230\u6e20\u6210\u4e86\uff1a\n\n- \u5bf9\u4e8e $f_i$\uff0c\u8981\u4e48\u7b2c $i$ \u4e2a\u5e03\u4e01\u4e0d\u52a8\uff0c\u5373 $g_i\\rightarrow f_i$\uff0c\u8981\u4e48\u7b2c $i$ \u4e2a\u5e03\u4e01\u5411\u5de6\u79fb\u52a8\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u679a\u4e3e\u4e0a\u4e00\u4e2a\u4e0d\u52a8\u7684\u5e03\u4e01 $j$\uff0c$g_j+sum(a_j+1,a_j+i-j)\\rightarrow f_i$\uff0c\u5176\u4e2d $sum(l,r)$ \u8868\u793a $[l,r]$ \u4e2d\u7279\u6b8a\u683c\u5b50\u7684\u4e2a\u6570\u3002\n- \u5bf9\u4e8e $g_i$\uff0c\u679a\u4e3e\u4e0a\u4e00\u4e2a\u4e0d\u52a8\u6216\u5411\u5de6\u79fb\u52a8\u7684\u5e03\u4e01 $j$\uff0c\u90a3\u4e48\u663e\u7136\u5e03\u4e01 $j+1,j+2,\\dots,i-1$ \u90fd\u4f1a\u5411\u53f3\u79fb\u52a8\u76f4\u5230\u9760\u5230 $i$ \u4e0a\uff0c\u5373 $f_j+sum(a_i-i+j+1,a_i)\\rightarrow g_i$\u3002\n\n\u5f53\u7136\u4e5f\u53ef\u4ee5\u6539\u5199\u6210\u4ee5\u4e0b\u5f62\u5f0f\uff1a\n\n- $f_j+sum(a_i-i+j+1,a_i)\\rightarrow g_i$\n- $g_i+sum(a_i+1,a_i+j)\\rightarrow f_{i+j}$\n- $g_i\\rightarrow f_i$\n\n\u8fd9\u6837\u66b4\u529b $dp$ \u662f\u5e73\u65b9\u7684\uff0c\u663e\u7136\u4f1a\u70b8\uff0c\u4e0d\u8fc7\u6ce8\u610f\u5230\u7279\u6b8a\u683c\u5b50\u6570\u91cf\u5f88\u5c11\uff0c\u8003\u8651\u4ee5\u6b64\u4e3a\u7a81\u7834\u53e3\u4f18\u5316 $dp$ \u8f6c\u79fb\u3002\u6bd4\u65b9\u8bf4\u62ff\u8f6c\u79fb\u65b9\u7a0b $f_j+sum(a_i-i+j+1,a_i)\\rightarrow g_i$ \u4e3e\u4f8b\uff0c\u6ce8\u610f\u5230 $f_i\\leq f_{i+1}$\uff0c\u800c\u5982\u679c $a_i-i+j+1$ \u4e0d\u662f\u7279\u6b8a\u683c\u5b50\uff0c\u90a3\u4e48\u663e\u7136 $sum(a_i-i+j+1,a_i)=sum(a_i-i+j+2,a_i)$\uff0c\u6545 $f_j+sum(a_i-i+j+1,a_i)=f_j+sum(a_i-i+j+2,a_i)\\le f_{j+1}+sum(a_i-i+j+2,a_i)$\uff0c\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u5fc5\u5b9a\u4f1a\u4ece $a_i-i+j+1$ \u4e3a\u7279\u6b8a\u683c\u5b50\u7684 $j$ \u8f6c\u79fb\u6765\uff0c\u6545\u8003\u8651\u8f6c\u800c\u679a\u4e3e\u7279\u6b8a\u683c\u5b50\uff0c\u8fd9\u6837\u8f6c\u79fb\u7684\u590d\u6742\u5ea6\u5c31\u53ef\u964d\u5230 $\\mathcal O(m)$ \u4e86\u3002\n\n\u6700\u540e\uff0c\u4e0a\u8ff0\u8f6c\u79fb\u65b9\u7a0b\u5ffd\u7565\u7684\u201c\u8fde\u7eed\u7684\u5e03\u4e01\u4f1a\u7c98\u5728\u4e00\u8d77\u201d\u8fd9\u4e2a\u6761\u4ef6\uff0c\u5176\u5b9e\u8fd9\u4e5f\u5f02\u5e38\u5bb9\u6613\u89e3\u51b3\uff0c\u8003\u8651\u6c42\u51fa $L_i$ \u8868\u793a\u5e03\u4e01 $i$ \u6240\u5728\u7684\u5e03\u4e01\u5757\u7684\u5de6\u7aef\u70b9\uff0c$R_i$ \u8868\u793a\u5e03\u4e01 $i$ \u6240\u5728\u7684\u5e03\u4e01\u5757\u7684\u53f3\u7aef\u70b9\u2014\u2014\u8fd9\u663e\u7136\u53ef\u4ee5\u7ebf\u6027\u6c42\u51fa\u3002\u7136\u540e\u76f4\u63a5\u4ece\u5bf9\u5e94\u8f6c\u79fb\u4f4d\u7f6e\u7684\u5de6\u53f3\u7aef\u70b9\u8f6c\u79fb\u800c\u6765\u5373\u53ef\u3002\u53ef\u80fd\u8bb2\u5f97\u4e0d\u662f\u7279\u522b\u6e05\u695a\uff0c\u5177\u4f53\u89c1\u4ee3\u7801\u7f62\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define fi first\n#define se second\n#define fill0(a) memset(a,0,sizeof(a))\n#define fill1(a) memset(a,-1,sizeof(a))\n#define fillbig(a) memset(a,63,sizeof(a))\n#define pb push_back\n#define ppb pop_back\n#define mp make_pair\ntemplate<typename T1,typename T2> void chkmin(T1 &x,T2 y){if(x>y) x=y;}\ntemplate<typename T1,typename T2> void chkmax(T1 &x,T2 y){if(x<y) x=y;}\ntypedef pair<int,int> pii;\ntypedef long long ll;\ntypedef unsigned int u32;\ntypedef unsigned long long u64;\nnamespace fastio{\n\t#define FILE_SIZE 1<<23\n\tchar rbuf[FILE_SIZE],*p1=rbuf,*p2=rbuf,wbuf[FILE_SIZE],*p3=wbuf;\n\tinline char getc(){return p1==p2&&(p2=(p1=rbuf)+fread(rbuf,1,FILE_SIZE,stdin),p1==p2)?-1:*p1++;}\n\tinline void putc(char x){(*p3++=x);}\n\ttemplate<typename T> void read(T &x){\n\t\tx=0;char c=getchar();T neg=0;\n\t\twhile(!isdigit(c)) neg|=!(c^'-'),c=getchar();\n\t\twhile(isdigit(c)) x=(x<<3)+(x<<1)+(c^48),c=getchar();\n\t\tif(neg) x=(~x)+1;\n\t}\n\ttemplate<typename T> void recursive_print(T x){if(!x) return;recursive_print(x/10);putc(x%10^48);}\n\ttemplate<typename T> void print(T x){if(!x) putc('0');if(x<0) putc('-'),x=~x+1;recursive_print(x);}\n\tvoid print_final(){fwrite(wbuf,1,p3-wbuf,stdout);}\n}\nconst int MAXN=1e5;\nconst int MAXM=2e3;\nconst int MAXPOS=2e5;\nint n,m,a[MAXN+5],b[MAXM+5],sum[MAXPOS+5];\nint l[MAXN+5],r[MAXN+5],f[MAXN+5],g[MAXN+5];\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&a[i]);sort(a+1,a+n+1);\n\tfor(int i=1;i<=m;i++) scanf(\"%d\",&b[i]),sum[b[i]]++;sort(b+1,b+m+1);\n\tfor(int i=1;i<=MAXPOS;i++) sum[i]+=sum[i-1];\n\ta[0]=-MAXPOS;a[n+1]=MAXPOS+MAXPOS;\n\tfor(int i=1;i<=n;i++) l[i]=(a[i-1]+1==a[i])?l[i-1]:i;\n\tfor(int i=n;i;i--) r[i]=(a[i+1]-1==a[i])?r[i+1]:i;\n\tfor(int i=1;i<=n;i++){\n\t\tf[i]=max(f[i],f[i-1]+sum[a[i]]-sum[a[i]-1]);\n\t\tg[i]=max(g[i],f[i-1]+sum[a[i]]-sum[a[i]-1]);\n\t\tfor(int j=1;j<=m&&b[j]<a[i];j++) if(a[i]-b[j]<i){\n\t\t\tchkmax(g[i],f[l[i-a[i]+b[j]]-1]+sum[a[i]]-sum[b[j]-1]);\n\t\t}\n\t\tchkmax(f[i],g[i]);\n\t\tfor(int j=m;j&&b[j]>=a[i];j--) if(b[j]-a[i]<=n-i){\n\t\t\tchkmax(f[r[i+b[j]-a[i]]],g[i]+sum[b[j]]-sum[a[i]]);\n\t\t}\n\t} printf(\"%d\\n\",f[n]);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1615464004,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF436D\u3010Pudding Monsters\u3011"
    }
]
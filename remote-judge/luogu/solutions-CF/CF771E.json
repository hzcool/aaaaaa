[
    {
        "content": "> [CF771E Bear and Rectangle Strips](https://www.luogu.com.cn/problem/CF771E)\n\n\u8fd9\u9898\u597d\u96be\u554a\u3002\n\n\u9996\u5148\uff0c\u5bb9\u6613\u501f\u52a9 `map` \u6216\u5176\u5b83 STL \u6c42\u51fa $na_i, nb_i, nc_i$ \u5206\u522b\u8868\u793a\u4ece\u7b2c $i + 1$ \u5217\u5f00\u59cb\uff0c\u5408\u6cd5\u5b50\u77e9\u5f62\u7684\u53f3\u8fb9\u754c\u7684\u6700\u5c0f\u503c\uff0c\u4e14\u8be5\u5408\u6cd5\u5b50\u77e9\u5f62\u5360\u7528\u7b2c\u4e00\u884c / \u7b2c\u4e8c\u884c / \u7b2c\u4e00\u3001\u4e8c\u884c\u3002\n\n\u663e\u7136\u6709 naive \u7684 DP\uff1a\u8bbe $f_{i, j}$ \u8868\u793a\u53ea\u8003\u8651\u7b2c\u4e00\u884c\u524d $i$ \u5217\u548c\u7b2c\u4e8c\u884c\u524d $j$ \u5217\u7684\u7b54\u6848\u3002\u8f6c\u79fb\u5373\u4e0d\u9009\u53d6\u5b50\u77e9\u5f62\u8f6c\u79fb\u5230 $f_{i + 1, j}, f_{i, j + 1}$\uff0c\u9009\u5b50\u77e9\u5f62\u8f6c\u79fb\u5230 $f_{na_i, j}, f_{i, nb_j}, f_{nc_{\\max(i, j)}, nc_{\\max(i, j)}}$\u3002\u8fd9\u4e2a DP \u663e\u7136\u4e5f\u662f\u8fc7\u4e0d\u53bb\u7684\u3002\n\n\u5c1d\u8bd5\u51cf\u5c0f\u72b6\u6001\u6570\u5230 $\\mathcal{O}(n)$\u3002\u81ea\u7136\u7684\u60f3\u6cd5\u662f\u8bbe $f_i$ \u8868\u793a\u539f $f_{i, i}$\u3002\n\n\u8003\u8651\u4efb\u610f\u9009\u62e9\u5b50\u77e9\u5f62\u7684\u65b9\u6848\uff0c\u6211\u4eec\u603b\u53ef\u4ee5\u6bcf\u6b21\u9009\u62e9\u5de6\u7aef\u70b9\u6700\u9760\u5de6\u7684\u77e9\u5f62\uff0c\u4e3a\u6bcf\u4e2a\u65b9\u6848\u94a6\u5b9a\u5176\u4e2d\u6240\u6709\u5b50\u77e9\u5f62\u88ab\u8003\u8651\u5230\u7684\u987a\u5e8f\u3002\n\n\u8003\u8651\u539f $f_{i, j}(i\\leq j)$\u3002\u82e5 $f_{i, j} > f_{i, i} + 1$\uff0c\u5219 $f_{i, j}$ \u5bf9\u5e94\u7684\u65b9\u6848\u4e2d\uff0c\u4e00\u5b9a\u5b58\u5728\u4e00\u4e2a\u5b50\u77e9\u5f62\u5360\u7528\u4e86\u7b2c\u4e8c\u884c\u7684\u7b2c $i + 1$ \u5217\uff0c\u4e14\u5176\u53f3\u4fa7\u8fd8\u6709\u4e00\u4e2a\u5b50\u77e9\u5f62\u3002\u5426\u5219\u4e0e $f_{i, i}$ \u7684\u6700\u5927\u6027\u77db\u76fe\u3002\u8bbe\u5012\u6570\u7b2c\u4e8c\u4e2a\u5b50\u77e9\u5f62\u8986\u76d6\u7b2c\u4e8c\u884c\u7684\u7b2c $[p, q]$ \u5217\uff0c\u63a5\u4e0b\u6765\u6211\u4eec\u5c06\u8bf4\u660e $f_{i, j}$ \u662f\u4e0d\u5fc5\u8981\u7684\uff1a\n\n- \u5982\u679c\u7b2c\u4e00\u884c\u7684\u7b2c $[i + 1, q]$ \u5217\u6ca1\u6709\u88ab\u5b50\u77e9\u5f62\u8986\u76d6\uff0c\u5219\u53ef\u4ee5\u5148\u8f6c\u79fb\u5230 $f_{q, q}$\uff0c\u518d\u8f6c\u79fb\u5230 $f_{q, j}$\u3002\n- \u5982\u679c\u7b2c\u4e00\u884c\u7684\u7b2c $[i + 1, q]$ \u5217\u88ab\u5b50\u77e9\u5f62\u8986\u76d6\uff0c\u5219\u8be5\u5b50\u77e9\u5f62\u7684\u5de6\u7aef\u70b9\u5c0f\u4e8e\u7b2c\u4e8c\u884c\u6700\u540e\u4e00\u4e2a\u5b50\u77e9\u5f62\u7684\u5de6\u7aef\u70b9\uff0c\u5b83\u5e94\u8be5\u5148\u88ab\u679a\u4e3e\u5230\uff0c\u6545 $f_{i, j}$ \u4e0d\u5408\u6cd5\u3002\n\n\u63a5\u4e0b\u6765\uff0c\u6839\u636e\u503c\u57df\u5b9a\u4e49\u57df\u4e92\u6362\u7684\u5957\u8def\uff0c\u53ea\u6709\u4f7f\u5f97 $f_{i, j} = f_{i, i} + 1$ \u7684\u6700\u5c0f\u7684 $j$ \u662f\u91cd\u8981\u7684\u3002\u540c\u7406\uff0c\u8fd8\u9700\u8bb0\u5f55\u4f7f\u5f97 $f_{j, i} = f_{i, i} + 1$ \u7684\u6700\u5c0f\u7684 $j$\u3002\u5206\u522b\u8bb0\u5b83\u4eec\u4e3a $g_i$ \u548c $h_i$\u3002\n\n\u9996\u5148\u8981\u786e\u5b9a $f_i$\uff0c\u624d\u80fd\u6c42\u51fa $g_i, h_i$\u3002\u5bf9\u6bcf\u4e2a $i$ \u8bb0\u5f55\u6240\u6709\u8f6c\u79fb\u5230 $f_{i, j}(i\\leq j)$ \u7684 $j$ \u4ee5\u53ca\u5bf9\u5e94\u503c $v$ \u5f62\u6210\u7684\u4e8c\u5143\u7ec4 $(j, v)$ \u5373\u53ef\u3002\n\n\u8fd9\u6837\uff0c\u603b\u5171\u53ea\u9700\u8003\u8651 $\\mathcal{O}(n)$ \u79cd\u72b6\u6001\uff0c\u800c\u6bcf\u79cd\u72b6\u6001\u53ea\u6709 $\\mathcal{O}(1)$ \u4e2a\u540e\u7ee7\u3002\u56e0\u6b64\uff0cDP \u90e8\u5206\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}(n)$\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n\\log n)$\u3002[\u4ee3\u7801](https://codeforces.com/contest/771/submission/189835774)\uff0c\u6ce8\u610f $g, h$ \u7684\u5b9a\u4e49\u662f\u53cd\u7684\u3002\n\n\u53ef\u4ee5\u505a\u5230\u591a\u6b21\u8be2\u95ee $f_{i, j}$\uff0c\u6709\u7a7a\u518d\u8865\u3002",
        "postTime": 1674219106,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "CF771E Bear and Rectangle Strips"
    },
    {
        "content": "### \u4e00\u9053\u8bb0\u641c\u3002\n\n\u9996\u5148\u89c2\u5bdf\u53d1\u73b0\u6570\u636e\u53ea\u6709\u4e24\u884c\uff0c\u8bf4\u660e\u9009\u53d6\u7684\u65b9\u5f0f\u6709\u9650\uff0c\u5373\uff1a\u8f6c\u79fb\u7684\u65b9\u5f0f\u6709\u9650\uff0c\u4e8e\u662f\u8054\u60f3\u5230$DP$\u3002\n\n\u9996\u5148\u8003\u8651\u600e\u4e48\u8f6c\u79fb\uff1a\n\n$1.$  \u9009\u53d6\u4e00\u884c\uff0c\u5373$1*(y-x+1)$ \u7684\u77e9\u5f62 $:[1,x,y]$ \u6216\u8005 $[2,x,y]$ \u3002\u5176\u4e2d$sum[1][y]-sum[1][x-1]=0,sum[2][y]-sum[2][x-1]=0$\n\n$2.$  \u9009\u53d6\u4e24\u884c\uff0c\u5373$2*(y-x+1)$\u7684\u77e9\u5f62 $:$ $[0,x,y]$ \u3002\u5176\u4e2d$sum[0][y]-sum[0][x-1]=0$\n\n\u56e0\u4e3a\u8981\u4f7f$[k,x,y]$ \u7684\u548c\u4e3a$0$ \uff0c\u6240\u4ee5$sum[k][y]-sum[k][x-1]=0 $ ,\u5373$sum[k][y]=sum[k][x-1]$\u3002\u8fd9\u4e2a\u5f00\u4e2a$map$ \u8db3\u4ee5\u89e3\u51b3\u3002\n\n\u7531\u4e8e\u6bcf\u4e00\u884c\u5df2\u7ecf\u8003\u8651\u7684\u5217\u6570\u5bf9\u4e8e\u7b54\u6848\u6709\u5f71\u54cd\uff0c\u6240\u4ee5\u6211\u4eec\u8bbe\u65b9\u7a0b$f[i][j]$\u8868\u793a\u7b2c\u4e00\u884c\u8003\u8651\u5230\u7b2c$i$\u4e2a\uff0c\u7b2c\u4e8c\u884c\u7b2c$j$\u4e2a\u65f6\u6700\u591a\u7684\u77e9\u5f62\u3002\n\n\u8f6c\u79fb\u65b9\u7a0b\u5373$:$ \n\n$1. f[x][y]=max(dfs(x,p[2][y])+1,dfs(p[1][x],y)+1);$\n\n$2. f[x][y]=max(f[x][y],dfs(p[0][min(x,y)],p[0][min(x,y)])+1);$\n\n\u5176\u4e2d $p[k][x]$ \u8868\u793a\u9009\u53d6\u884c\u7684\u72b6\u6001\u4e3a$k$\uff0c\u7b2c$x$\u5217\u6700\u8fd1\u7684\u8f6c\u79fb\u70b9\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define N 300010\n#define int long long\nint n,a[3][N],s[3][N],p[3][N];\nmap<int,int> f[N],v[3];\nint dfs(int x,int y)\n{\n\tif(x<0||y<0) return -1e9;\n\tif(x==0&&y==0) return 0;\n\tif(f[x][y]) return f[x][y];\n\tf[x][y]=0;\n\t//f[x][y]=max(dfs(x-1,y),dfs(x,y-1));\n\tif(p[1][x]>p[2][y]) f[x][y]=max(f[x][y],dfs(p[1][x],y)+1);\n\telse f[x][y]=max(f[x][y],dfs(x,p[2][y])+1);\n\tf[x][y]=max(f[x][y],dfs(p[0][min(x,y)],p[0][min(x,y)])+1);\n\treturn f[x][y];\n}\nsigned main()\n{\n\tcin>>n;\n\tfor(int i=1;i<=2;i++)\n\t  for(int j=1;j<=n;j++) scanf(\"%lld\",&a[i][j]);\n\tmemset(p,-1,sizeof(p));\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\ts[1][i]=s[1][i-1]+a[1][i];\n\t\ts[2][i]=s[2][i-1]+a[2][i];\n\t\ts[0][i]=s[1][i]+s[2][i];\n\t\tif(v[1][s[1][i]]||!s[1][i]) p[1][i]=v[1][s[1][i]];\n\t\tif(v[2][s[2][i]]||!s[2][i]) p[2][i]=v[2][s[2][i]];\n\t\tif(v[0][s[0][i]]||!s[0][i]) p[0][i]=v[0][s[0][i]];\n\t\tp[0][i]=max(p[0][i],p[0][i-1]);\n\t\tp[1][i]=max(p[1][i],p[1][i-1]);\n\t\tp[2][i]=max(p[2][i],p[2][i-1]);\n\t\tv[1][s[1][i]]=i;v[2][s[2][i]]=i;v[0][s[0][i]]=i;\n\t}\n\tcout<<dfs(n,n);//puts(\"nmsl\");\n\treturn 0;\n}\n```\n",
        "postTime": 1605950596,
        "uid": 285069,
        "name": "LSG_waterlyf",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF771E \u3010Bear and Rectangle Strips\u3011"
    }
]
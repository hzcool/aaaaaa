[
    {
        "content": "\u5c06\u70b9\u6309\u7167 $x$ \u5750\u6807\u7684\u5947\u5076\u6027\uff0c$y$ \u5750\u6807\u7684\u5947\u5076\u6027\u5206\u4e3a $4$ \u7c7b\uff0c\u53ef\u4ee5\u53d1\u73b0\u5982\u4e0b\u6027\u8d28\uff1a\n\n1. \u6bcf\u4e00\u4e2a\u4e0d\u6ee1\u8db3\u9898\u610f\u7684\u5e73\u884c\u56db\u8fb9\u5f62\u90fd\u5305\u542b\u4e86 $4$ \u7c7b\u70b9\u6070\u597d\u4e00\u4e2a\u3002\n2. \u6bcf\u4e00\u4e2a\u4e0d\u6ee1\u8db3\u9898\u610f\u7684\u5e73\u884c\u56db\u8fb9\u5f62\u90fd\u53ef\u4ee5\u8868\u793a\u4e3a $\\text{(odd, odd)} \\to \\text{(even, odd)} \\to \\text{(even, even)} \\to \\text{(odd, even)}$ \u7684\u4e00\u6761\u9053\u8def\u3002\n\n![image.png](https://i.loli.net/2021/05/25/28Ve5tqf7HbAyTp.png)\n\n\u4e8e\u662f\u9898\u76ee\u8f6c\u5316\u4e3a\uff0c\u4e22\u6389\u603b\u6743\u503c\u6700\u5c0f\u7684\u70b9\uff0c\u4f7f\u5f97\u4e0d\u5b58\u5728\u8fd9\u6837\u7684\u9053\u8def\uff0c\u8fd9\u662f\u4e00\u4e2a\u6700\u5c0f\u5272\u6a21\u578b\u3002\n\n\u5177\u4f53\u7684\uff0c\u5220\u70b9\u7684\u8bdd\u53ef\u4ee5\u8003\u8651\u62c6\u70b9\uff0c\u5c06\u6bcf\u4e2a\u70b9 $u$ \u8868\u793a\u4e3a $u_{in}, u_{out}$ \u4e24\u4e2a\u70b9\u3002\n\n\u6839\u636e\u8def\u5f84\u7ecf\u8fc7\u7684\u987a\u5e8f\uff0c\u5c06\u4e0a\u9762\u90a3 $4$ \u7c7b\u70b9\u5206\u4e3a $A, B, C, D$\uff0c\u540c\u65f6\u5efa\u7acb\u6e90\u70b9 $S$ \u548c\u6c47\u70b9 $T$\u3002\n\n\u56fe\u4e3a\uff1a\n\n* $u_{in} \\to u_{out}$ \u8fde\u5bb9\u91cf\u4e3a $w_u$ \u7684\u8fb9\u3002\n* $S \\to a_{in}\\ (a \\in A)$ \u8fde\u5bb9\u91cf\u4e3a $+\\infty$ \u7684\u8fb9\u3002\n* $a_{out} \\to b_{in}\\ (a \\in A, b \\in B, \\text{dist}(a, b) = 1)$ \u8fde\u5bb9\u91cf\u4e3a $+\\infty$ \u7684\u8fb9\u3002\n* $b_{out} \\to c_{in}\\ (b \\in B, c \\in C, \\text{dist}(b, c) = 1)$ \u8fde\u5bb9\u91cf\u4e3a $+\\infty$ \u7684\u8fb9\u3002\n* $c_{out} \\to d_{in}\\ (c \\in C, d \\in D, \\text{dist}(c, d) = 1)$ \u8fde\u5bb9\u91cf\u4e3a $+\\infty$ \u7684\u8fb9\u3002\n* $d_{out} \\to T\\ (d \\in D)$ \u8fde\u5bb9\u91cf\u4e3a $+\\infty$ \u7684\u8fb9\u3002\n\n\u6c42\u6700\u5c0f\u5272\u5373\u53ef\uff0c\u8fb9\u6570\u548c\u70b9\u6570\u90fd\u662f $O(n)$ \u7ea7\u522b\u7684\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\n#define Get(x) ((x % 2 + 2) % 2)\nusing namespace std;\nconst int N = 2005, M = 10005;\nstruct edge\n{\n\tint v, w, nxt;\n} e[M << 1];\nint cnt = -1, n, m, s, t, maxflow, h[N], lev[N], cur[N];\ninline void AddEdge(int u, int v, int w)\n{\n\te[++cnt] = (edge){v, w, h[u]}; h[u] = cnt;\n\te[++cnt] = (edge){u, 0, h[v]}; h[v] = cnt;\n}\nint DFS(int u, int canflow)\n{\n\tif(u == t) return canflow;\n\tint resflow = 0;\n\tfor(int& i = cur[u]; ~i; i = e[i].nxt)\n\t{\n\t\tint v = e[i].v;\n\t\tif(lev[v] == lev[u] + 1 && e[i].w > 0)\n\t\t{\n\t\t\tint willflow = DFS(v, min(e[i].w, canflow));\n\t\t\tcanflow -= willflow;\n\t\t\tresflow += willflow;\n\t\t\te[i].w -= willflow;\n\t\t\te[i ^ 1].w += willflow;\n\t\t\tif(!canflow) break;\n\t\t}\n\t}\n\tif(!resflow) lev[u] = -1;\n\treturn resflow;\n}\nbool BFS()\n{\n\tmemset(lev, -1, sizeof lev);\n\tqueue<int> que;\n\tque.push(t);\n\tlev[t] = 998244353;\n\twhile(!que.empty())\n\t{\n\t\tint u = que.front(); que.pop();\n\t\tfor(int i = h[u]; ~i; i = e[i].nxt)\n\t\t{\n\t\t\tint v = e[i].v;\n\t\t\tif(lev[v] != -1 || e[i ^ 1].w <= 0) continue;\n\t\t\tlev[v] = lev[u] - 1;\n\t\t\tif(v == s) return true;\n\t\t\tque.push(v); \n\t\t}\n\t}\n\treturn lev[s] != -1;\n}\nvoid Dinic()\n{\n\twhile(BFS())\n\t{\n\t\tmemcpy(cur, h, sizeof h);\n\t\tmaxflow += DFS(s, INT_MAX);\n\t}\n}\nint x[N], y[N], w[N], type[N], sum;\nsigned main()\n{\n\tios::sync_with_stdio(false);\n\tmemset(h, -1, sizeof h);\n\tcin >> n;\n\tfor(int i = 1; i <= n; i++) { cin >> x[i] >> y[i] >> w[i]; sum += w[i]; }\n\ts = 1; t = n * 2 + 2;\n\tfor(int i = 1; i <= n; i++)\n\t{\n\t\tif(Get(x[i]) == 1 && Get(y[i]) == 1) type[i] = 1;\n\t\tif(Get(x[i]) == 0 && Get(y[i]) == 1) type[i] = 2;\n\t\tif(Get(x[i]) == 0 && Get(y[i]) == 0) type[i] = 3;\n\t\tif(Get(x[i]) == 1 && Get(y[i]) == 0) type[i] = 4;\n\t}\n\tfor(int i = 1; i <= n; i++) AddEdge(i << 1, i << 1 | 1, w[i]);\n\tfor(int i = 1; i <= n; i++) if(type[i] == 1) AddEdge(s, i << 1, LLONG_MAX / 64);\n\tfor(int i = 1; i <= n; i++) if(type[i] == 1)\n\t\tfor(int j = 1; j <= n; j++) if(type[j] == 2)\n\t\t\tif(abs(x[i] - x[j]) + abs(y[i] - y[j]) == 1)\n\t\t\t\tAddEdge(i << 1 | 1, j << 1, LLONG_MAX / 64);\n\tfor(int i = 1; i <= n; i++) if(type[i] == 2)\n\t\tfor(int j = 1; j <= n; j++) if(type[j] == 3)\n\t\t\tif(abs(x[i] - x[j]) + abs(y[i] - y[j]) == 1)\n\t\t\t\tAddEdge(i << 1 | 1, j << 1, LLONG_MAX / 64);\n\tfor(int i = 1; i <= n; i++) if(type[i] == 3)\n\t\tfor(int j = 1; j <= n; j++) if(type[j] == 4)\n\t\t\tif(abs(x[i] - x[j]) + abs(y[i] - y[j]) == 1)\n\t\t\t\tAddEdge(i << 1 | 1, j << 1, LLONG_MAX / 64);\n\tfor(int i = 1; i <= n; i++) if(type[i] == 4) AddEdge(i << 1 | 1, t, LLONG_MAX / 64);\n\tDinic();\n\tcout << sum - maxflow << endl;\n\treturn 0;\n}\n```",
        "postTime": 1621953897,
        "uid": 51971,
        "name": "syksykCCC",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF1517G \u3010Starry Night Camping\u3011"
    },
    {
        "content": "\u5c06\u6240\u6709\u70b9\u6309\u7167\u6a2a\u3001\u7eb5\u5750\u6807\u7684\u5947\u5076\u6027\u5206\u6210 $4$ \u7c7b\uff0c\u5bb9\u6613\u53d1\u73b0\u6240\u6709\u5e73\u884c\u56db\u8fb9\u5f62\u90fd\u80fd\u5c06\u4ed6\u7684\u56db\u4e2a\u70b9\u5199\u6210\u4e00\u6761\u5f62\u5982\u201c\u5947\u5947\uff0c\u5076\u5947\uff0c\u5076\u5076\uff0c\u5947\u5076\u201d\u7684\u8def\u5f84\u3002\u4e8e\u662f\u5efa\u7f51\u7edc\u6d41\uff0c\u628a\u6bcf\u4e2a\u70b9\u62c6\u6210\u5165\u70b9\u548c\u51fa\u70b9\u4e24\u4e2a\u70b9\uff0c\u4e2d\u95f4\u8fde\u4e0a\u8fb9\u6743\u4e3a $a_i$ \u7684\u8fb9\uff0c\u8868\u793a\u5220\u6389\u8fd9\u4e2a\u70b9\u7684\u4ee3\u4ef7\u3002\u4ece\u6e90\u70b9\u5411\u6240\u6709\u7b2c\u4e00\u7c7b\u70b9\u7684\u5165\u70b9\u8fde\u8fb9\u6743\u4e3a $\\inf$ \u7684\u8fb9\uff0c\u4ece\u7b2c $i$ \u7c7b\u70b9\u7684\u51fa\u70b9\u5411\u7b2c $i+1$ \u7c7b\u70b9\u7684\u5165\u70b9\uff08$i<4$ \u4e14\u8fd9\u4e24\u4e2a\u70b9\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u4e3a $1$\uff09\u8fde\u8fb9\u6743\u4e3a $\\inf$ \u7684\u8fb9\uff0c\u4ece\u7b2c\u56db\u7c7b\u70b9\u5411\u6c47\u70b9\u8fde\u8fb9\u6743\u4e3a $\\inf$ \u7684\u8fb9\uff0c\u7136\u540e\u8dd1\u6700\u5c0f\u5272\u5373\u53ef\u3002\u7531\u4e8e\u6211\u4eec\u7ed9\u56fe\u5206\u4e86\u5c42\uff0c\u6bcf\u51fa\u73b0\u56db\u5c42\u5c31\u4f1a\u662f\u4e00\u4e2a\u5e73\u884c\u56db\u8fb9\u5f62\uff0c\u4e8e\u662f\u4e0d\u4f1a\u51fa\u73b0\u4e0d\u540c\u7684\u5e73\u884c\u56db\u8fb9\u5f62\u4e92\u76f8\u5e72\u6270\u7684\u60c5\u51b5\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define N 401001\n#define MAX 2005\nusing namespace std;\ntypedef long long ll;\ntypedef double db;\nconst ll mod=998244353,inf=1e18;\ninline void read(ll &ret)\n{\n\tret=0;char c=getchar();bool pd=false;\n\twhile(!isdigit(c)){pd|=c=='-';c=getchar();}\n\twhile(isdigit(c)){ret=(ret<<1)+(ret<<3)+(c&15);c=getchar();}\n\tret=pd?-ret:ret;\n\treturn;\n}\nll n;\nstruct node\n{\n\tll x,y,v,tag;\n}a[N];\nmap<pair<ll,ll>,ll>mp;\nll head[N],cnt=-1,s,t;\nstruct edge\n{\n\tll from,to,dis,nxt;\n}e[N];\nll now[N];\ninline void add(ll x,ll y,ll z)\n{\n\te[++cnt].from=x;\n\te[cnt].to=y;\n\te[cnt].dis=z;\n\te[cnt].nxt=head[x];\n\thead[x]=cnt;\n\treturn;\n}\nll dep[N];\ninline bool bfs()\n{\n\tmemset(dep,0,(t+1)*sizeof(ll));\n\tdep[s]=2;\n\tqueue<ll>q;\n\tq.push(s);\n\twhile(!q.empty())\n\t{\n\t\tll ver=q.front();\n\t\tq.pop();\n\t\tnow[ver]=head[ver];\n\t\tfor(int i=head[ver];~i;i=e[i].nxt)\n\t\t{\n\t\t\tif(!e[i].dis)\n\t\t\t\tcontinue;\n\t\t\tif(!dep[e[i].to])\n\t\t\t{\n\t\t\t\tdep[e[i].to]=dep[ver]+1;\n\t\t\t\tq.push(e[i].to);\n\t\t\t}\n\t\t}\n\t}\n\treturn dep[t];\n}\ninline ll dfs(ll ver,ll lim)\n{\n\tif(ver==t)\n\t\treturn lim;\n\tll ret=0;\n\tfor(int i=now[ver];(~i)&&lim;i=e[i].nxt)\n\t{\n\t\tnow[ver]=i;\n\t\tif(e[i].dis&&dep[e[i].to]==dep[ver]+1)\n\t\t{\n\t\t\tll tmp=dfs(e[i].to,min(lim,e[i].dis));\n\t\t\te[i].dis-=tmp;\n\t\t\te[i^1].dis+=tmp;\n\t\t\tlim-=tmp;\n\t\t\tret+=tmp;\n\t\t}\n\t}\n\tif(!ret)\n\t\tdep[ver]=0;\n\treturn ret;\n}\ninline ll dinic(ll s,ll t)\n{\n\tll ret=0;\n\twhile(bfs())\n\t\tret+=dfs(s,inf);\n\treturn ret;\n}\nsigned main()\n{\n\tmemset(head,-1,sizeof(head));\n\tread(n);\n\tll ans=0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tread(a[i].x);\n\t\tread(a[i].y);\n\t\tread(a[i].v);\n\t\tif((a[i].x&1)&&(a[i].y&1))\n\t\t\ta[i].tag=1;\n\t\telse if(!(a[i].x&1)&&(a[i].y&1))\n\t\t\ta[i].tag=2;\n\t\telse if(!(a[i].x&1)&&!(a[i].y&1))\n\t\t\ta[i].tag=3;\n\t\telse\n\t\t\ta[i].tag=4;\n\t\tmp[make_pair(a[i].x,a[i].y)]=i;\n\t\tans+=a[i].v;\n\t}\n\ts=0,t=n*2+1;\n\tfor(int i=1;i<=n;i++)\n\t\tadd(i,i+n,a[i].v),add(i+n,i,0);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(a[i].tag==1)\n\t\t{\n\t\t\tadd(s,i,inf),add(i,s,0);\n\t\t\tif(mp[make_pair(a[i].x+1,a[i].y)])\n\t\t\t\tadd(i+n,mp[make_pair(a[i].x+1,a[i].y)],inf),add(mp[make_pair(a[i].x+1,a[i].y)],i+n,0);\n\t\t\tif(mp[make_pair(a[i].x-1,a[i].y)])\n\t\t\t\tadd(i+n,mp[make_pair(a[i].x-1,a[i].y)],inf),add(mp[make_pair(a[i].x-1,a[i].y)],i+n,0);\n\t\t}\n\t\telse if(a[i].tag==2)\n\t\t{\n\t\t\tif(mp[make_pair(a[i].x,a[i].y+1)])\n\t\t\t\tadd(i+n,mp[make_pair(a[i].x,a[i].y+1)],inf),add(mp[make_pair(a[i].x,a[i].y+1)],i+n,0);\n\t\t\tif(mp[make_pair(a[i].x,a[i].y-1)])\n\t\t\t\tadd(i+n,mp[make_pair(a[i].x,a[i].y-1)],inf),add(mp[make_pair(a[i].x,a[i].y-1)],i+n,0);\n\t\t}\n\t\telse if(a[i].tag==3)\n\t\t{\n\t\t\tif(mp[make_pair(a[i].x+1,a[i].y)])\n\t\t\t\tadd(i+n,mp[make_pair(a[i].x+1,a[i].y)],inf),add(mp[make_pair(a[i].x+1,a[i].y)],i+n,0);\n\t\t\tif(mp[make_pair(a[i].x-1,a[i].y)])\n\t\t\t\tadd(i+n,mp[make_pair(a[i].x-1,a[i].y)],inf),add(mp[make_pair(a[i].x-1,a[i].y)],i+n,0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tadd(i+n,t,inf),add(t,i+n,0);\n\t\t\tif(mp[make_pair(a[i].x,a[i].y+1)])\n\t\t\t\tadd(i+n,mp[make_pair(a[i].x,a[i].y+1)],inf),add(mp[make_pair(a[i].x,a[i].y+1)],i+n,0);\n\t\t\tif(mp[make_pair(a[i].x,a[i].y-1)])\n\t\t\t\tadd(i+n,mp[make_pair(a[i].x,a[i].y-1)],inf),add(mp[make_pair(a[i].x,a[i].y-1)],i+n,0);\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",ans-dinic(s,t));\n\texit(0);\n}\n```",
        "postTime": 1668557613,
        "uid": 176990,
        "name": "Celtic",
        "ccfLevel": 9,
        "title": "cf1517g"
    }
]
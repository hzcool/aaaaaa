[
    {
        "content": "\u5176\u5b9e\u548c[\u4f59\u6570\u6c42\u548c](https://www.luogu.org/problemnew/show/P2261)\u662f\u540c\u4e00\u9053\u9898...  \n\u4f46\u662f\u8303\u56f4\u52a0\u5927\u53d6\u6a21\u5c31\u6709\u70b9\u5bb9\u6613\u8f7d\u5751\n\n\u8fd8\u662f\u8bf4\u4e00\u4e0b\u601d\u8def\u5427\n\n\u9996\u5148\u6211\u4eec\u8981\u6c42\u7684\u662f:\n\n$$\\displaystyle\\sum_{i=1}^m n\\ mod \\ i$$\n\n\u5176\u5b9e\u53d6\u6a21\u64cd\u4f5c\u7279\u6b8a\u5728\u6ca1\u6709\u4ec0\u4e48\u7279\u6b8a\u6027  \n\u57fa\u672c\u4e0a\u770b\u5230\u8fd9\u79cd\u5f62\u5f0f\u5c31\u4f1a\u60f3\u5230 $n\\ mod\\ i=n-  \\left\\lfloor\\frac{n}{i}\\right\\rfloor\\times i$\n\n\u4e8e\u662f\u6211\u4eec\u5176\u5b9e\u5c31\u662f\u8981\u6c42\n$$n\\times m-\\displaystyle\\sum_{i=1}^m\\left\\lfloor\\frac{n}{i}\\right\\rfloor\\times i$$\n\n\u5de6\u8fb9\u8fd9\u4e00\u5768\u5f88\u597d\u6c42,\u53f3\u8fb9\u8fd9\u4e00\u5768\u5c31\u8981\u7528\u5230**\u6574\u9664\u5206\u5757**\n\n\u5176\u5b9e\u4e5f\u4e0d\u662f\u4ec0\u4e48\u96be\u7406\u89e3\u7684\u4e1c\u897f,\u5176\u5b9e\u5c31\u662f**\u6574\u9664\u4e2d,\u88ab\u9664\u6570\u4e00\u5b9a\u7684\u60c5\u51b5\u4e0b,\u5546\u968f\u9664\u6570\u7684\u589e\u5927\u800c\u51cf\u5c0f**  \n\u7531\u4e8e\u662f\u6574\u6570,\u6240\u4ee5\u8fd9\u4e2a\u51cf\u5c0f\u662f\u5448\u73b0\u51fa\u9636\u68af\u72b6\u7684.  \n\u4e8e\u662f\u6211\u4eec\u5c31\u60f3\u901a\u8fc7\u5f53\u524d\u7684\u5546,\u6765\u63a8\u51fa\u5f53\u524d\u9636\u68af\u5728\u622a\u6b62(~~\u5728\u54ea\u91cc\u9700\u8981\u51cf\u5c0f~~)\n\n\u542c\u8d77\u6765\u5f88\u96be,\u5176\u5b9e\u7a0d\u5fae\u7406\u89e3\u4e0b\u5c31\u597d(\u4ee5\u4e0b\u4e3a\u975e\u4e25\u8c28\u4f46\u662f\u6613\u4e8e\u7406\u89e3\u7684\u8bc1\u660e)  \n\u9996\u5148\u6211\u4eec\u8bbe $t=\\left\\lfloor\\dfrac{n}{i}\\right\\rfloor$  \n\u8fd9\u4e2a\u5c31\u662f\u6211\u4eec\u5f53\u524d\u9636\u68af\u7684\u9ad8\u5ea6\u4e86  \n$t$ \u7684\u6570\u5b66\u542b\u4e49\u662f, $n$ \u91cc\u9762\u5305\u542b\u4e86\u51e0\u4e2a $i$  \n\u5047\u8bbe\u6211\u4eec\u73b0\u5728\u6bcf\u4e2a\u9636\u68af\u9ad8\u5ea6\u90fd\u662f $t$  \n\u90a3\u4e48\u6700\u591a\u80fd\u7ef4\u6301\u591a\u5c11\u4e2a\u9636\u68af\u5462  \n\u7b54\u6848\u663e\u7136\u662f $\\left\\lfloor\\dfrac{n}{\\left\\lfloor\\frac{n}{i}\\right\\rfloor}\\right\\rfloor$  \u4e2a  \n\u4e8e\u662f\u6211\u4eec\u7684\u53f3\u8fb9\u754c\u5c31\u7b97\u51fa\u6765\u4e86(\u8fd8\u8981\u5bf9\u8fb9\u754c\u53d6min),\u65f6\u95f4\u590d\u6742\u5ea6$O(\\sqrt{N})$\n\n\u597d\u5427\u6211\u627f\u8ba4\u8fd9\u6837\u53ef\u80fd\u66f4\u96be\u7406\u89e3orz\n\n```cpp\n/*\u8981\u7279\u522b\u6ce8\u610f\u8fb9\u754c\u60c5\u51b5*/\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long LL;\nconst LL mod=1e9+7;\nLL n,m,ans,up,sum,r;\nint main(){\n    cin>>n>>m;\n    ans=(n%mod)*(m%mod)%mod;\n    up=min(n,m);\n    sum=0;\n    for(LL i=1;i<=up;++i){\n        r=min(n/(n/i),up);\n        LL a=i+r;\n        LL b=r-i+1;\n        if(a&1)b/=2;\n        else a/=2;\n        sum=(sum+((a%mod)*(b%mod)%mod)*(n/i)%mod)%mod;\n        i=r;\n    }\n    cout<<(ans-sum+mod)%mod<<endl;\n    return 0;\n}\n```\n\u597d\u5427 \u6211\u5c31\u7ed9\u51fa\u4e25\u8c28\u4e00\u70b9\u7684\u8bc1\u660e  \n\u5bf9\u4e8e $x\\in [1,n]$ , \u8bbe $g(x)=\\left\\lfloor\\dfrac{n}{\\left\\lfloor\\frac{n}{x}\\right\\rfloor}\\right\\rfloor$  \n\u8bbe $f(x)=\\dfrac{n}{x}$  \u6ce8\u610f\u8fd9\u91cc\u7684 $n$ \u4e3a\u5e38\u6570  \n\u5bf9 $f(x)$ \u6c42\u5bfc\u5f97\u5230 $f'(x)=-\\dfrac{n}{x^2}$ \u5728 $[1,n]$ \u8861\u5c0f\u4e8e0  \n$f(x)$ \u5728 $[1,n]$ \u5355\u8c03\u9012\u51cf  \n\u800c $g(x)\\ge \\left\\lfloor\\dfrac{n}{\\frac{n}{x}}\\right\\rfloor=x$  \n\u6240\u4ee5 $\\left\\lfloor\\dfrac{n}{x}\\right\\rfloor\\ge \\left\\lfloor\\dfrac{n}{g(x)}\\right\\rfloor$  \n\n\u800c\u4e14, $\\left\\lfloor\\dfrac{n}{g(x)}\\right\\rfloor\\ge \\left\\lfloor\\dfrac{n}{\\dfrac{n}{\\left\\lfloor\\frac{n}{x}\\right\\rfloor}}\\right\\rfloor=\\left\\lfloor\\dfrac{n}{x}\\right\\rfloor$\n\n\u6240\u4ee5 $\\left\\lfloor\\dfrac{n}{x}\\right\\rfloor=\\left\\lfloor\\dfrac{n}{g(x)}\\right\\rfloor$\n\n\u8fd9\u4e2a $x$ \u5c31\u662f\u6211\u4eec\u521a\u521a\u679a\u4e3e\u7684 $i$  \n\u53ef\u4ee5\u6ce8\u610f\u5230,\u6211\u4eec\u6c42\u51fa\u4e86\u4e00\u4e2a $g(x)$ \u80af\u5b9a\u662f\u4e0d\u5c0f\u4e8e $x$ \u4f46\u662f\u5b83\u4eec\u7684\u6574\u9664 $n$ \u7684\u503c\u5374\u662f\u4e00\u6837\u7684,\u4e14\u5b83\u662f\u7b26\u5408\u8981\u6c42\u7684\u6570\u91cc\u9762\u6700\u5927\u7684.",
        "postTime": 1554040455,
        "uid": 61150,
        "name": "\u5192\u6ce1ioa",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 CF616E \u3010Sum of Remainders\u3011"
    },
    {
        "content": "\u9898\u610f\uff1a\u6c42\n\n$$\\sum_{i=1}^{i\\leq m}n\\text{ mod } i$$\n\n\u5316\u7b80\u5f0f\u5b50\uff1a\n\n$$\\sum_{i=1}^{i\\leq m}n-\\lfloor\\frac{n}{i}\\rfloor \\times i$$\n\n$$nm-\\sum_{i=1}^{i\\leq m}\\lfloor\\frac{n}{i}\\rfloor \\times i$$\n\n$$nm-\\sum_{(l,r)}\\lfloor\\frac{n}{i}\\rfloor \\times \\frac{r-l+1}{2}$$\n\n\u7136\u540e\u540e\u9762\u4e00\u5768\u9664\u6cd5\u5206\u5757\u6c42\u4e00\u4e0b\u5373\u53ef\uff0c\u6ce8\u610f $\\frac{1}{2}\\text{ mod }(10^9+7)=5\\times10^8+4$ \u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^{0.5})$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int mod = 1e9 + 7;\nlong long n, k, ans;\nint main() {\n\tcin >> k >> n, ans = (n % mod) * (k % mod) % mod;\n\tfor (long long l = 1, r; l <= n && l <= k; l = r + 1) {\n\t\tr = min(k / (k / l), n);\n\t\tans = (ans - (k / l) % mod * ((l + r) % mod) % mod * ((r - l + 1) % mod) % mod * ((mod + 1) / 2) % mod) % mod;\n\t}\n\tcout << (ans + mod) % mod << '\\n';\n\treturn 0;\n}\n```",
        "postTime": 1657238219,
        "uid": 560516,
        "name": "\u55b5\u4ed4\u725b\u5976",
        "ccfLevel": 0,
        "title": "CF616E Sum of Remainders\u9898\u89e3"
    },
    {
        "content": "# CF616E Sum of Remainders\n\n[link](https://www.luogu.com.cn/problem/CF616E)\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://tony102.xyz/index.php/2020/11/14/cf616e-sum-of-remainders/)\n\n### Sol\n\n\u73b0\u5728\u8ba9\u4f60\u6c42\u7684\u662f \n\n$$\\sum_{i = 1}^{m} n \\ mod \\ i$$\n\n\u6a21\u8fd0\u7b97\u8fd9\u79cd\u4e1c\u897f\u5c31\u662f\u5e26\u4f59\u9664\u6cd5\uff0c\u7136\u540e\u4f60\u53d1\u73b0\u4f59\u6570\u4f60\u4e5f\u5f88\u4e0d\u597d\u7b97\u3002\u5c31\u8003\u8651\u628a\u6a21\u8fd0\u7b97\u6539\u6210\u5e26\u4f59\u9664\u6cd5\u7684\u5f62\u5f0f\n\n\u6211\u4eec\u77e5\u9053: $x \\div i = \\lfloor \\frac{x}{i} \\rfloor + x - (i \\times \\lfloor \\frac{x}{i} \\rfloor)$\n\n\u6240\u4ee5\u73b0\u5728\u8981\u6c42\u7684\u4e1c\u897f\u5c31\u662f\n\n$$\\sum_{i=1}^{m} n - (i \\times \\lfloor \\frac{n}{i} \\rfloor)$$\n\n$$n \\times m - \\sum_{i=1}^{m} i \\times \\lfloor \\frac{n}{i} \\rfloor$$\n\n\u6240\u4ee5\u540e\u9762\u7684\u4e1c\u897f\u6574\u9664\u5206\u5757\u4e00\u4e0b\u5c31\u597d\u4e86\n\n\n\n### Code\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define int long long\n\nconst int mod = 1e9 + 7;\n\nint n, m;\n\nnamespace ae86 {\n\tconst int bufl = 1 << 15;\n\tchar buf[bufl], *s = buf, *t = buf;\n\tinline int fetch() {\n\t\tif (s == t) { t = (s = buf) + fread(buf, 1, bufl, stdin); if (s == t) return EOF; }\n\t\treturn *s++;\n\t}\n\tinline int read() {\n\t\tint a = 0, b = 1, c = fetch();\n\t\twhile (!isdigit(c))b ^= c == '-', c = fetch();\n\t\twhile (isdigit(c)) a = a * 10 + c - 48, c = fetch();\n\t\treturn b ? a : -a;\n\t}\n}\nusing ae86::read;\n\ninline int qPow(int a, int b)\n{\n\tint ans = 1;\n\twhile (b) {\n\t\tif (b & 1) ans = ans * a % mod;\n\t\tb >>= 1, a = a * a % mod;\n\t}\n\treturn ans % mod;\n}\n\ninline int minux(int a, int b) { return (a - b + 10 * mod) % mod; }\n\nsigned main()\n{\n\t// freopen(\"code.in\", \"r\", stdin);\n\t// freopen(\"code.out\", \"w\", stdout);\n\tn = read(), m = read();\n\tint ans = (n % mod) * (m % mod) % mod, mul = qPow(2, mod - 2);\n\tfor (int l = 1, r = 0; l <= m; l = r + 1) {\n\t\tif (n / l == 0) r = m;\n\t\telse r = std::min(m, (n / (n / l)));\n\t\tans = (ans - 1ll * (n / l) % mod * ((l + r) % mod) % mod * ((r - l + 1ll) % mod) % mod * mul % mod + 10ll * mod) % mod;\n\t}\n\tprintf(\"%lld\\n\", ans % mod);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1605318152,
        "uid": 230933,
        "name": "Tony102",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF616E \u3010Sum of Remainders\u3011"
    },
    {
        "content": "## \u5206\u6790\n\n\u6574\u9664\u5206\u5757\u677f\u5b50\u9898\uff08\u51e0\u4e4e\u4e0e [P2261](https://www.luogu.com.cn/problem/P2261) \u5b8c\u5168\u76f8\u540c\uff09\n\n\u9996\u5148\uff0c\u6211\u4eec\u6765\u63a8\u4e00\u6ce2\u5f0f\u5b50\n\n$$\n\\begin{aligned}\n\\sum \\limits_{i = 1}^m n \\bmod i &= \\sum \\limits_{i = 1}^m(n - \\lfloor\\dfrac n i \\rfloor i)\\\\\n&= nm - \\sum \\limits_{i = 1}^m\\lfloor\\dfrac n i \\rfloor i\\\\\n\\end{aligned}\n$$\n\n\u6211\u4eec\u53d1\u73b0\uff0c$\\sum \\limits_{i = 1}^m\\lfloor\\dfrac n i \\rfloor i$ \u53ef\u4ee5\u901a\u8fc7\u679a\u4e3e\u4e0d\u540c\u7684 $\\lfloor\\dfrac n i \\rfloor$ \u5904\u7406\uff0c\u800c\u8fd9\u4e2a\u679a\u4e3e\u53ef\u4ee5\u901a\u8fc7\u6574\u9664\u5206\u5757\u6765\u5b9e\u73b0\u3002\n\n\u4e0d\u96be\u53d1\u73b0\u4e0d\u540c\u7684 $\\lfloor\\dfrac n i \\rfloor$ \u4ec5\u6709 $O(\\sqrt n)$ \u4e2a\uff0c\u901a\u8fc7\u6574\u9664\u5206\u5757\u679a\u4e3e\u4e00\u904d\u662f $O(\\sqrt n)$ \u590d\u6742\u5ea6\n\n## \u4ee3\u7801\n\n```cpp\n#include <stdio.h>\ntemplate<class T>\ninline T min(const T &x, const T &y) { return x < y ? x : y; }\ntemplate<class T>\ninline T max(const T &x, const T &y) { return x < y ? y : x; }\n#define lld long long\nconst lld mod = 1e9 + 7;\nlld n, m;\nlld l, r;\nlld ans;\nint main() {\n\tscanf(\"%lld%lld\", &m, &n);\n\tans = (n % mod) * (m % mod);\n\tlld inv2 = (mod + 1) >> 1;\n\tfor (l = 1; l <= n && l <= m; l = r + 1) {\n\t\tr = min(m / (m / l), n);\n\t\tans = (ans - (m / l) % mod * ((l + r) % mod) % mod * ((r - l + 1) % mod) % mod * inv2 % mod) % mod; // \u8bb0\u5f97\u53d6\u6a21\n\t} // \u6574\u9664\u5206\u5757\n\tprintf(\"%lld\\n\", (ans + mod) % mod);\n}\n```",
        "postTime": 1652782500,
        "uid": 228486,
        "name": "SunsetSamsara",
        "ccfLevel": 7,
        "title": "CF616E Sum of Remainders \u9898\u89e3"
    },
    {
        "content": "[\u53cc\u500d\u7ecf\u9a8c](https://www.luogu.com.cn/problem/P2261)\n\n# \u9898\u610f\u7b80\u8ff0\n\n\u7ed9\u5b9a $n,m$\uff0c\u6c42\n\n$$\\left(\\sum_{i=1}^mn\\bmod i\\right)\\bmod (10^9+7)$$\n\n# \u524d\u7f6e\u77e5\u8bc6\n\n[\u6574\u9664\u5206\u5757](https://www.luogu.com.cn/blog/340940/shuo-lun-han-shuo-di-shi-jie)\uff0c\u4e00\u5b9a\u7684\u6570\u5b66\u63a8\u5bfc\u80fd\u529b\u3002\n\n# \u89e3\u6cd5\n\n\u9996\u5148\u770b\u5230 $\\bmod$ \u6211\u4eec\u5c31\u60f3\u5230\u53ef\u80fd\u8981\u7528\u7c7b\u4f3c\u4e8e\u6574\u9664\u5206\u5757\u7684\u65b9\u6cd5\u505a\u3002\u8003\u8651\u5229\u7528\u5982\u4e0b\u5f0f\u5b50\uff1a\n\n$$a\\bmod b=a-b\\times \\lfloor\\dfrac{a}{b}\\rfloor$$\n\n\uff08\u5c31\u662f\u5c0f\u5b66\u5b66\u8fc7\u7684\uff0c\u4f59\u6570 $=$ \u88ab\u9664\u6570 $-$ \u9664\u6570 $\\times$ \u5546\uff09\u3002\n\n\u539f\u5f0f\u5316\u4e3a\n\n$$\\begin{aligned}\n\t &\\sum_{i=1}^m n\\bmod i\\\\\n   =&\\sum_{i=1}^m (n-i\\times \\lfloor\\dfrac{n}{i}\\rfloor)&\\text{\uff08\u53bb\u6389 mod\uff09}\\\\\n   =&\\left(\\sum_{i=1}^m n\\right)-\\left(\\sum_{i=1}^m i\\times\\lfloor\\dfrac{n}{i}\\rfloor\\right)&\\text{\uff08\u51cf\u6cd5\u6027\u8d28\uff09}\\\\\n   =&\\ mn-\\left(\\sum_{i=1}^m i\\times\\lfloor\\dfrac{n}{i}\\rfloor\\right)&\\text{\uff08\u5316\u7b80\u524d\u534a\u90e8\u5206\uff09}\n\\end{aligned}$$\n\n\u63a5\u4e0b\u6765\u7528\u6574\u9664\u5206\u5757\u8ba1\u7b97\u540e\u534a\u90e8\u5206\uff0c\u8003\u8651\u628a\u6240\u6709 $\\lfloor\\dfrac{n}{i}\\rfloor$ \u76f8\u7b49\u7684 $i$ \u7684\u53d6\u503c\u5206\u6210\u4e00\u4e2a\u4e2a\u533a\u95f4\u3002\n\n\u5047\u8bbe $\\lfloor\\dfrac{n}{i}\\rfloor$ \u5728 $i\\in[l,r]$ \u4e0a\u7684\u503c\u5747\u4e3a $\\lfloor\\dfrac{n}{l}\\rfloor$\uff08\u5f53\u7136\u4e5f\u4e3a $\\lfloor\\dfrac{n}{r}\\rfloor$\uff0c\u6bd5\u7adf\u90fd\u76f8\u7b49\uff09\u3002\u90a3\u4e48\u6211\u4eec\u6709 \n\n$$\\begin{aligned}\n\t &\\sum_{i=1}^m i\\times\\lfloor\\dfrac{n}{i}\\rfloor\\\\\n   =&\\sum_{l,r}\\sum_{i=l}^r i\\times\\lfloor\\dfrac{n}{i}\\rfloor&\\text{\uff08\u53d8\u6210\u6574\u9664\u5206\u5757\u7684\u5f62\u5f0f\uff09}\\\\\n   =&\\sum_{l,r}\\lfloor\\dfrac{n}{l}\\rfloor\\sum_{i=l}^r i&\\text{\uff08}\\lfloor\\dfrac{n}{i}\\rfloor\\text{\u4e3a\u5e38\u6570\u63d0\u5230\u524d\u9762\u6765\uff09}\\\\\n   =&\\sum_{l,r}\\lfloor\\dfrac{n}{l}\\rfloor\\times(l+r)\\times(r-l+1)\\times\\dfrac{1}{2}&\\text{\uff08\u7b49\u5dee\u6570\u5217\u6c42\u548c\uff09}\n\\end{aligned}$$\n\n\u81f3\u6b64\u6570\u5b66\u63a8\u5bfc\u5b8c\u6210\u3002\n\n# \u5751\u70b9\uff1a\u5173\u4e8e\u53d6\u6a21\n\n1. \u5982\u679c\u4f60\u662f\u505a\u5b8c\u4e86 [P2261](https://www.luogu.com.cn/problem/P2261) \u624d\u8fc7\u6765\u7684\uff0c\u90a3\u4e48\uff0c\u8bf7\u8bb0\u5f97\u53d6\u6a21\u3002\n2. \u4e00\u5b9a\u8981\u6b65\u6b65\u53d6\u6a21\uff0c\u751a\u81f3\u8ba1\u7b97 $mn$ \u65f6\uff0c\u8981\u5148\u5bf9 $n$ \u548c $m$ \u5206\u522b\u53d6\u6a21\uff0c\u4e58\u8d77\u6765\u540e\u518d\u6a21\u4e00\u6b21\u3002\u5177\u4f53\u89c1\u4ee3\u7801\u3002\n3. \u5f0f\u5b50\u91cc\u9762\u6700\u540e\u90a3\u4e2a $\\dfrac{1}{2}$ \u5728\u8ba1\u7b97\u8fc7\u7a0b\u4e2d\u4e0d\u80fd\u76f4\u63a5\u9664\u4ee5 $2$\uff0c\u8981\u4e58\u4e0a $2$ \u5bf9\u6a21 $10^9+7$ \u7684[\u9006\u5143](https://www.luogu.com.cn/problem/P3811)\u3002\n4. C++ \u6709\u4e00\u4e2a\u7279\u6027\uff1a\u8d1f\u6570\u9664\u4ee5\u6b63\u6570\u7684\u4f59\u6570\u4ecd\u7136\u662f\u8d1f\u6570\u3002\u56e0\u6b64\uff0c\u5982\u679c\u60f3\u8981\u5f97\u5230\u4f59\u6570\u7684\u6b63\u6570\u503c\uff0c\u8bf7\u4e0d\u8981\u4f7f\u7528 `x%y`\uff0c\u800c\u662f\u4f7f\u7528 `(x%y+y)%y`\u3002\n\n# \u4ee3\u7801\n```cpp\n#include<iostream>\n#include<cstdio>\n#define int long long\n#define M 1000000007\n#define i2 500000004\nusing namespace std;\nint m,n,ans; \nsigned main()\n{\n\tcin>>m>>n;\n\tans=(n%M)*(m%M)%M;\n\tint r=1;\n\tfor(int l=1;l<=min(n,m);l=r+1)\n\t\tr=min(m/(m/l),n),\n\t\tans=(ans-(m/l)%M*((l+r)%M)%M*((r-l+1)%M)%M*i2%M)%M;\n\tcout<<(ans+M)%M;\n\treturn 0;\n}\n```",
        "postTime": 1650864764,
        "uid": 340940,
        "name": "IAKIOI2357",
        "ccfLevel": 0,
        "title": "CF616E Sum of Remainders \u9898\u89e3"
    },
    {
        "content": "[\u66f4\u7cdf\u7684\u9605\u8bfb\u4f53\u9a8c](https://blog.csdn.net/BUG_Creater_jie/article/details/122254012)\n## $\\text{Descripion}$\n\u8ba1\u7b97\u4ee5\u4e0b\u5f0f\u5b50\u7684\u548c\uff1a$n \\bmod 1 + n \\bmod 2 + n \\bmod 3 + \\dots + n \\bmod m$\u3002\u7531\u4e8e\u7ed3\u679c\u53ef\u80fd\u5f88\u5927\uff0c\u4f60\u9700\u8981\u8f93\u51fa\u5176\u5bf9 $10^9+7$ \u53d6\u6a21\u7684\u7ed3\u679c\u3002\n$n,m\\le 10^{13}$\n## $\\text{Solution}$\n\u5f0f\u5b50\u53ef\u4ee5\u5199\u6210\uff1a\n$$\\sum_{i=1}^mn-\\lfloor\\frac{n}{i}\\rfloor\\times i$$\n\u76f4\u63a5\u4e0a\u6574\u9664\u5206\u5757\u5373\u53ef\u3002\n## $\\text{Code}$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define ull unsigned long long\n#define debug(...) fprintf(stderr,__VA_ARGS__)\ninline ll read(){\n  ll x(0),f(1);char c=getchar();\n  while(!isdigit(c)){if(c=='-')f=-1;c=getchar();}\n  while(isdigit(c)){x=(x<<1)+(x<<3)+c-'0';c=getchar();}\n  return x*f;\n}\n\nconst int N=1e6+100;\nconst int mod=1e9+7;\n\nll n,m,ans;\nll ksm(ll x,ll k){\n  ll res(1);\n  while(k){\n    if(k&1) res=res*x%mod;\n    x=x*x%mod;\n    k>>=1;\n  }\n  return res;\n}\n\ninline ll calc(ll l,ll r){return ((l+r)%mod)*((r-l+1)%mod)%mod*500000004%mod;}\nsigned main(){\n#ifndef ONLINE_JUDGE\n  freopen(\"a.in\",\"r\",stdin);\n  freopen(\"a.out\",\"w\",stdout);\n#endif\n  n=read();m=read();\n  ans=(m%mod)*(n%mod)%mod;\n  for(ll l=1,r;l<=min(n,m);l=r+1){\n    r=min(m,n/(n/l));\n    ll o=n/l%mod;\n    ans=(ans+mod-o*calc(l,r)%mod)%mod;\n    //printf(\"(%lld %lld) o=%lld\\n\",l,r,o);\n  }\n  printf(\"%lld\\n\",ans);\n  return 0;\n}\n/*\n */\n\n```\n",
        "postTime": 1640931868,
        "uid": 449265,
        "name": "wind_whisper",
        "ccfLevel": 10,
        "title": "CF616E Sum of Remainders"
    },
    {
        "content": "$n,m \\leq 10 ^ {13}$ \u662f\u53ef\u4ee5 $\\sqrt n$ \u7ea7\u522b\u8fc7\u6389\u7684\uff0c\u8003\u8651\u6574\u9664\u5206\u5757\u3002       \n\n\u5047\u8bbe\u5bf9\u4e8e $m$ \u7684\u4e00\u6bb5\u53d6\u503c $[l,r]$\uff0c\u6ee1\u8db3 $x \\in [l,r] , \\lfloor \\frac{n}{x}\\rfloor = k$\u3002        \n\n\u5c06 $l$ \u5199\u6210 $l \\times k + sim_1 = n$ \u7684\u5f62\u5f0f\uff0c\u90a3\u4e48\u5bf9\u4e8e $(l + 1) \\times k + sim_2 = n,(l + 2) \\times k + sim_3 = n......$ \u800c\u8a00\uff0c\u4f59\u6570 $sim_i$ \u6bcf\u6b21\u9488\u5bf9\u4e8e\u4e0a\u4e00\u9879 $sim_{i - 1}$ \u4f1a\u51cf\u5c11 $k$\uff0c\u8fd9\u662f\u4e00\u4e2a\u7ecf\u5178\u7684\u7b49\u5dee\u6570\u5217\u6c42\u548c\u95ee\u9898\u53ef\u4ee5 $O(1)$ \u7b97\u3002             \n\n\u5bf9\u4e8e $m > n$ \u7684\u90e8\u5206\u76f4\u63a5\u52a0\u4e0a $(m - n) \\times n$ \u5373\u53ef\u3002          \n\n\u90a3\u4e48\u7b54\u6848\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u662f\u5f62\u5982 $i \\in [1,n], \\lfloor \\frac{n}{i} \\rfloor$ \u7684\u79cd\u7c7b\u4e2a\u6570\uff0c\u8fd9\u4e2a\u7528\u6574\u9664\u5206\u5757\u53ef\u4ee5\u8bc1\u660e\u6570\u91cf\u7ea7\u662f $O(\\sqrt n)$ \u7684\u3002\n\n```cpp\n/*\n\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u6bd4\u5982\u8bf4\u5bf9\u4e8en / x\u800c\u8a00\n\u5982\u8fc7x\\in[l,r]\u65f6\uff0cceil(n/x)\u503c\u76f8\u7b49\u4e3ak\n\u90a3\u4e48\u5c31\u662fl * k + sim1,(l+1) * k + sim2,(l + 2) * k + sim3\n\u7136\u540e\u4f60\u53d1\u73b0sim\u662f\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\uff0c\u76f4\u63a5\u7b97\u5c31\u597d\u4e86 \n*/\n#include \"bits/stdc++.h\"\nusing namespace std;\nconst long long MOD = 1e9 + 7;\nlong long n,m,res,Inv2;\nlong long qpow(long long a,long long b)\n{\n\tlong long res = 1;\n\twhile(b)\n\t{\n\t\tif(b & 1) res = res * a % MOD;\n\t\tb = b >> 1;\n\t\ta = a * a % MOD;\n\t}\n\treturn res;\n}\nlong long Fac(long long st,long long ed,long long len)\n{\n\tlong long s1 = (st + ed) , s2 = len;\n\treturn (s1 % MOD) * (s2 % MOD) % MOD * Inv2 % MOD;\n} \nsigned main()\n{\n\tscanf(\"%lld %lld\",&n,&m);\n\tInv2 = qpow(2 , MOD - 2);\n\tfor(long long l = 1 , r ; l <= min(n , m) ; l = r + 1)\n\t{\n\t\tlong long K = n / l;\n\t\tr = min(n / K , min(m , n));\n\t\tlong long ST = n - (l * K) , ED = n - (r * K) , LEN = (ST - ED) / K + 1; \n\t\tres += Fac(ST , ED , LEN);\n\t\tres %= MOD;\n\t} \n\tif(m > n) res += (m - n) % MOD * (n % MOD) % MOD , res %= MOD;\n\tprintf(\"%lld\\n\",res);\n\treturn 0;\n}\n```",
        "postTime": 1634024905,
        "uid": 132533,
        "name": "Hakuoro",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF616E Sum of Remainders"
    },
    {
        "content": "\u8bf4\u5230\u5e95\u662f\u4e00\u9053\u7b80\u5355\u9898\uff0c\u53ea\u4e0d\u8fc7\u4e0d\u77e5\u9053\u4e3a\u5565\u662f\u7d2b\u9898\uff1f\n\n\u8003\u8651\u6574\u9664\u5206\u5757\uff0c\u628a $\\bmod$ \u53f7\u540e\u9762\u7684\u6570\u5206\u6210\u4e09\u6bb5\uff1a$[1,\\sqrt n],[\\sqrt n,n],[n+1,m]$\u3002\u7b2c\u4e00\u6bb5\u663e\u7136\u5c31\u66b4\u529b\u5c31\u53ef\u4ee5\u4e86\uff0c\u7b2c\u4e09\u6bb5\u7684\u503c\u90fd\u662f $n$ \u4e58\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\u3002\u91cd\u70b9\u5728\u7b2c\u4e8c\u6bb5\u3002\n\n\u6211\u4eec\u679a\u4e3e $\\left\\lfloor\\dfrac ni\\right\\rfloor$ \u7684\u503c\uff0c\u7136\u540e\u7531 $\\left\\lfloor\\dfrac ni\\right\\rfloor=x$ \u6709 $x\\leq \\dfrac ni<x+1$\uff0c\u5373 $\\dfrac n{x+1}<i\\leq \\dfrac nx$\u3002\u7136\u540e\u7b97\u51fa\u5de6\u53f3\u7aef\u70b9\u4e4b\u540e\u628a $\\bmod$ \u62c6\u5f00\uff1a$\\sum\\limits_{i=l}^rn\\bmod i=\\sum\\limits_{i=1}^r\\left(n-i\\left\\lfloor\\dfrac ni\\right\\rfloor\\right)$\uff0c\u7b49\u5dee\u6570\u5217\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u6ce8\u610f\u6709\u51e0\u4e2a\u5c0f\u5751\u70b9\uff0c\u5bb9\u6613 WA\uff0c1A \u7684\uff08\u5982 tzc\uff09\u90fd\u662f\u795e\u4ed9\u3002",
        "postTime": 1608558592,
        "uid": 138400,
        "name": "chenxia25",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 CF616E \u3010Sum of Remainders\u3011"
    }
]
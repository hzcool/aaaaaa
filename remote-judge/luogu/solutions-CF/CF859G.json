[
    {
        "content": "[CF859G Circle of Numbers](https://www.luogu.com.cn/problem/CF859G) \u89e3\u9898\u62a5\u544a\uff1a\n\n[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/xiaoziyao/p/16782444.html)\n\n## \u9898\u610f\n\n\u6709\u4e00\u4e2a\u957f\u5ea6\u4e3a $n$ \u7684\u5706\u73af\uff0c\u6bcf\u4e2a\u6574\u70b9\u4f4d\u7f6e\u90fd\u6709\u4e00\u4e2a\u6574\u6570 $\\in\\{0,1\\}$\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9\u4e00\u4e2a $c\\mid n$ \u4ee5\u53ca\u4e00\u4e2a $d<c$\uff0c\u5c06\u6240\u6709 $kc+d$ \u4f4d\u7f6e\u7684\u6570\u540c\u65f6\u52a0\u3001\u51cf\u4e00\u4e2a\u5b9e\u6570 $r$\uff0c\u6c42\u662f\u5426\u53ef\u4ee5\u5c06\u6240\u6709\u6570\u5b57\u5f52\u96f6\u3002\n\n$1\\leqslant n\\leqslant 10^5$\u3002\n\n## \u5206\u6790\n\n\u6ca1\u505a\u8fc7\u8fd9\u79cd\u7c7b\u578b\u7684\u9898\u3002\u3002\u3002\u4e5f\u4e0d\u592a\u4f1a\u5206\u5706\u591a\u9879\u5f0f\u90a3\u4e00\u5957\u7406\u8bba\u3002\n\n\u9996\u5148\u5c06\u5706\u73af\u7684\u72b6\u6001\uff08\u4ece $0$ \u5f00\u59cb\uff09\u5199\u6210\u751f\u6210\u51fd\u6570 $F(x)$\uff0c\u90a3\u4e48\u4e00\u6b21\u64cd\u4f5c\u5c31\u662f\u5c06 $F(x)$ \u52a0\u4e0a $fx^c\\frac{1-x^n}{1-x^d}$\u3002\n\n\u8003\u8651\u591a\u9879\u5f0f\u73af\u4e0a\u7684\u88f4\u8700\u5b9a\u7406\uff0c\u90a3\u4e48\u5408\u6cd5\u5f53\u4e14\u4ec5\u5f53 $\\gcd_{d\\mid n}\\{\\frac{1-x^n}{1-x^d}\\}\\mid F(x)$\u3002\n\n\u5229\u7528\u5355\u4f4d\u6839\u5c55\u5f00\uff1a\n\n$$\\frac{1-x^n}{1-x^d}=\\frac{\\prod_{k=0}^{n-1}(x-\\omega_n^k)}{\\prod_{k=0}^{d-1}(x-\\omega_d^k)}=\\prod_{k=0}^{n-1}[\\frac{n}{d}\\not\\mid k](x-\\omega_n^k)$$\n\n$$P(x)=\\gcd_{d\\mid n}\\{\\frac{1-x^n}{1-x^d}\\}=\\prod_{k=0}^{n-1}[\\gcd(k,n)=1](x-\\omega_n^k)$$\n\n\u4e92\u7d20\u7684\u6761\u4ef6\u5f88\u96be\u5904\u7406\uff0c\u4e8e\u662f\u8003\u8651\u5176\u8865\uff1a$Q(x)=\\prod_{k=0}^{n-1}[\\gcd(k,n)>1](x-\\omega_n^k)$\uff0c\u7531\u4e8e $P(x)Q(x)=x^n-1$\uff0c\u6240\u4ee5\u82e5 $P(x)\\mid F(x)$ \u5219\u6709 $x^n-1\\mid F(x)Q(x)$\uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a\u5faa\u73af\u5377\u79ef\u3002\n\n\u4e0e $Q(x)$ \u5377\u79ef\u4ecd\u7136\u5f88\u9ebb\u70e6\uff0c\u4f46\u6211\u4eec\u53ea\u9700\u5229\u7528 $Q(x)$ \u4e0d\u5305\u542b $[\\gcd(k,n)=1](x-\\omega_n^k)$ \u7684\u6027\u8d28\uff0c\u5199\u51fa $R(x)=\\prod_{p\\in\\text{Prime},p\\mid n}(x^{\\frac np}-1)$\u3002\u5224\u522b\u65b9\u5f0f\u4e0d\u53d8\uff0c\u800c\u5377\u79ef\u590d\u6742\u5ea6\u964d\u81f3 $O(n\\omega(n))$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include<stdio.h>\n#include<iostream>\nusing namespace std;\nconst int maxn=100005;\nint n,ans;\nint f[maxn],g[maxn];\nstring s;\nint main(){\n\tscanf(\"%d\",&n),cin>>s;\n\tfor(int i=0;i<n;i++)\n\t\tf[i]=s[i]-48;\n\tfor(int v=n,p=2;p<=v;p++)\n\t\tif(v%p==0){\n\t\t\twhile(v%p==0)\n\t\t\t\tv/=p;\n\t\t\tfor(int i=0;i<n;i++)\n\t\t\t\tg[i]=f[(i-n/p+n)%n]-f[i];\n\t\t\tfor(int i=0;i<n;i++)\n\t\t\t\tf[i]=g[i];\n\t\t}\n\tfor(int i=0;i<n;i++)\n\t\tans|=f[i];\n\tputs(ans==0? \"YES\":\"NO\");\n\treturn 0;\n}\n```",
        "postTime": 1665491313,
        "uid": 35754,
        "name": "Verdandi",
        "ccfLevel": 0,
        "title": "\u9898\u89e3  CF859G\u3010Circle of Numbers\u3011"
    },
    {
        "content": "\u6bd4\u8f83\u5389\u5bb3\u7684\u6570\u5b66\u9898\u3002\n\n\u8003\u8651\u5e8f\u5217\u7684\u751f\u6210\u51fd\u6570 $A(x)=\\sum\\limits_{i=0}^{n-1}a_ix^i$\u3002\n\n\u5bf9\u4e8e\u6bcf\u6b21\u64cd\u4f5c\uff0c\u5047\u8bbe\u64cd\u4f5c\u4e2d\u7b2c\u4e00\u4e2a\u6570\u4e3a $c$\uff0c\u76f8\u90bb\u4e24\u4e2a\u6570\u7684\u95f4\u9694\u4e3a $d$\uff0c\u90a3\u4e48\u8fd9\u6b21\u64cd\u4f5c\u76f8\u5f53\u4e8e $A(x)\\leftarrow A(x)+x^c\\dfrac{1-x^n}{1-x^d}$\u3002\n\n\u8bbe $F_{c,d}(x)=x^c\\dfrac{1-x^n}{1-x^d}$\u3002\n\n\u6839\u636e Bezout \u5b9a\u7406\uff0c$A(x)$ \u80fd\u88ab\u6240\u6709 $F_{c,d}(x)$ \u7ebf\u6027\u8868\u793a\u5f53\u4e14\u4ec5\u5f53 $\\gcd\\{F_{c,d}(x)\\}|A(x)$\u3002\u8bbe $G(x)=\\gcd\\{F_{c,d}(x)\\}$\u3002\n\n\u7531\u4e8e $F_{0,d}(x)|F_{c,d}(x)$\uff0c\u6240\u4ee5 $c>0$ \u7684 $F_{c,d}(x)$ \u5bf9 $\\gcd$ \u6ca1\u6709\u8d21\u732e\u3002\n\n\u6211\u4eec\u5229\u7528\u5355\u4f4d\u6839\u5c06 $F_{0,d}$ \u62c6\u5f00\u3002\n\n$$x^n-1=\\prod\\limits_{i=0}^{n-1} (x-\\omega_n^i)$$\n\n$$F_{0,d}(x)=\\dfrac{x^n-1}{x^d-1}$$\n\n$$=\\dfrac{\\prod\\limits_{i=0}^{n-1}(x-\\omega_n^i)}{\\prod\\limits_{i=0}^{d-1}(x-\\omega_d^i)}$$\n\n$$=\\dfrac{\\prod\\limits_{i=0}^{n-1}(x-\\omega_n^i)}{\\prod\\limits_{i=0}^{d-1}(x-\\omega_n^{\\frac{ni}{d}})}$$\n\n$$=\\prod\\limits_{i=0}^{n-1}[\\dfrac{n}{d}\\nmid i](x-\\omega^i)$$\n\n\u8fdb\u4e00\u6b65\u5f97\u5230\n\n$$G(x)=\\prod\\limits_{i=0}^{n-1}[\\gcd(i,n)=1](x-\\omega^i)$$\n\n\u9700\u8981\u5224\u65ad\u7684\u4e8b\u60c5\u53d8\u4e3a\u4e86 $G(x)|A(x)$ \u662f\u5426\u6210\u7acb\u3002\n\n\u8003\u8651 $H(x)=\\prod\\limits_{i\\in\\operatorname{Prime},i|n}(x^{\\frac{n}{i}}-1)$\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u7684\u6070\u597d\u5305\u542b\u4e86\u6240\u6709\u6ee1\u8db3 $\\gcd(i,n)>1$ \u7684 $(x-\\omega^i)$\u3002\n\n\u5373 $\\gcd(G(x),H(x))=1$ \u4e14 $\\dfrac{x^n-1}{G(x)}|H(x)$\u3002\n\n\u56e0\u6b64 $G(x)|A(x)$ \u7b49\u4ef7\u4e8e $x^n-1|A(x)H(x)$\u3002\n\n\u8fd9\u5c31\u662f\u5bf9 $A(x)$ \u548c $H(x)$ \u505a\u957f\u5ea6\u4e3a $n$ \u7684\u5faa\u73af\u5377\u79ef\u3002\n\n\u800c $H(x)$ \u662f $O(\\omega(n))$ \u4e2a\u5f62\u5982 $x^k-1$ \u7684\u4e58\u79ef\uff0c\u56e0\u6b64\u53ea\u9700\u8981\u628a\u5b83\u4eec\u4f9d\u6b21\u66b4\u529b\u4e58\u5230 $A(x)$ \u4e0a\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\omega(n))$\u3002\u4ee3\u7801\u975e\u5e38\u597d\u5199\u3002\n\n\u53c2\u8003\u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define N 100005\nint n,m,t,a[N],b[N];char a1[N];\nvoid mul(int x)\n{\n\tfor(int i=0;i<n;++i) b[(i+x)%n]=a[i];\n\tfor(int i=0;i<n;++i) a[i]=b[i]-a[i];\n}\nint main()\n{\n\tscanf(\"%d %s\",&n,a1);m=t=n;\n\tfor(int i=0;i<n;++i) a[i]=a1[i]-48;\n\tfor(int i=2;i<=t;++i) if(!(t%i))\n\t{while(!(t%i)) t/=i;mul(n/i);}\n\tfor(int i=0;i<n;++i) if(a[i])\n\t{printf(\"NO\\n\");return 0;}\n\tprintf(\"YES\\n\");return 0;\n}\n```",
        "postTime": 1655530704,
        "uid": 119621,
        "name": "Kubic",
        "ccfLevel": 10,
        "title": "CF859G Circle of Numbers"
    }
]
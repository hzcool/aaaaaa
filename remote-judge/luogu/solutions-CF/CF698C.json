[
    {
        "content": "~~\u4e00\u9053\u975e\u5e38\u610f\u8bc6\u6d41\u7684\u72b6\u538b\u6982\u7387dp\u9898()~~\n\n\u6709  $n$ \u79cd\u7269\u54c1\u548c\u4e00\u4e2a\u5927\u5c0f\u4e3a  $k$ \u7684\u961f\u5217\uff0c\u6709  $p_i$ \u7684\u6982\u7387\u4f1a\u9009\u62e9\u7b2c  $i$ \u79cd\u7269\u54c1\u653e\u5165\u961f\u5217\uff0c\u5982\u679c\u961f\u5217\u5df2\u7ecf\u6709  $i$ \u5219\u5c06\u961f\u5217\u4e2d\u7684  $i$ \u79fb\u5230\u961f\u5c3e\u3002\n\n\u5982\u679c\u961f\u5217\u4e2d\u5143\u7d20\u4e2a\u6570\u8d85\u8fc7  $k$ \u5219\u5f39\u51fa\u961f\u9996\u3002\n\n\u6c42  $10^{100}$ \u6b21\u64cd\u4f5c\u540e\u6bcf\u79cd\u7269\u54c1\u7559\u5728\u961f\u5217\u7684\u6982\u7387\u3002\n\n $n,k \\le 20$\n \n ### translate by yijan(\u65a4\u8001\u5e08yyds)\n \n \u9996\u5148\u8003\u8651\u5982\u679c\u6ca1\u6709\u8d85\u8fc7k\u5f39\u51fa\u961f\u9996\u7684\u9650\u5236\u600e\u4e48\u505a,\u8bbedp[s]\u4e3a\u5f53\u524d\u961f\u5217\u72b6\u6001\u51fa\u73b0\u7684\u6982\u7387,\u90a3\u4e48\u8f6c\u79fb\u65b9\u7a0b\u6bd4\u8f83\u663e\u7136.\n \n$$\ndp[s]=\\sum_{i=1}^ndp[s-1<<(i-1)]/(1-\\sum_{i=1}^np[i])(s\\&1<<(i-1)) \n$$\n\n\u5c31\u76f4\u63a5\u4ece\u4e4b\u524d\u72b6\u6001\u8f6c\u79fb\u5728\u9664\u4e0a\u8f6c\u79fb\u5230\u81ea\u5df1\u7684\u6982\u7387\u5c31\u884c\u4e86.\n\n\u8003\u8651\u5982\u679c\u6709k\u7684\u9650\u5236\u600e\u4e48\u529e,\u6211\u4eec\u8003\u8651\u5012\u7740\u770b\u8fd9\u4e2a\u5e8f\u5217,\u53d1\u73b0\u53ea\u6709\u6700\u540ek\u4e2a\u503c\u662f\u6709\u7528\u7684,\u56e0\u4e3a\u6bcf\u5f97\u5230\u4e00\u4e2a\u6570\u5c31\u4f1a\u76f4\u63a5\u628a\u4ed6\u653e\u5230\u961f\u5c3e,\u4e5f\u5c31\u662f\u8bf4\u4e00\u65e6\u5012\u7740\u7ecf\u8fc7k\u79cd\u6570,\u90a3\u4e48\u6700\u540e\u961f\u5217\u91cc\u5c31\u662f\u8fd9k\u4e2a\u6570.\n\n\u6240\u4ee5\u76f8\u5f53\u4e8e\u64cd\u4f5c\u6570\u5176\u5b9e\u6ca1\u6709\u4ec0\u4e48\u592a\u5927\u5f71\u54cd,\u90a3\u4e48\u76f4\u63a5\u5957\u7528\u524d\u9762\u7684dp\u8f6c\u79fb\u65b9\u7a0b\u5c31\u884c\u4e86.\n\n\u8fd8\u6709\u4e00\u79cd\u6bd4\u8f83\u611f\u6027\u7684\u8bc1\u660e,\u5c31\u662f\u4f60\u5047\u5982 \u961f\u5217\u4e2d\u961f\u9996\u4e3a3\u5269\u4e0b\u7684\u4e24\u4e2a\u65701,2.\n\u90a3\u5176\u5b9e\u4f603,1,2 \u4e0e3,2,1 \u51fa\u73b0\u7684\u6bd4\u4f8b\u4e0e1,2\u548c2,1\u662f\u76f8\u540c\u7684,\u4e5f\u5c31\u662f\u8bf4\u4f60\u5f39\u51fa\u961f\u9996\u540e\u5176\u5b9e\u5c31\u662f\u4e4b\u524dk-1\u7684\u60c5\u51b5,\u800c\u8fd9\u79cd\u60c5\u51b5\u5728\u524d\u9762\u5df2\u7ecf\u8f6c\u79fb\u8fc7\u4e86,\u6240\u4ee5\u4e0d\u9700\u8981\u7b97k\u4e0ek\u4e4b\u95f4\u7684\u8f6c\u79fb.\n\n(\u5176\u5b9e\u8003\u573a\u4e0a\u4f60\u731c\u731c\u7ed3\u8bba\u5c31\u597d\u4e86 \u96fe)\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define db double\nconst int N=(1<<21);\nconst db eps=1e-12;\ndb f[N],p[N],as[N];\nint n,k,tp;\nint ct(int x){int k=0;\n\twhile(x)k++,x-=x&(-x);return k;\n}\nint main(){\n\tscanf(\"%d%d\",&n,&k);f[0]=1;\n\tfor(int i=1;i<=n;i++)scanf(\"%lf\",&p[i]),tp+=(p[i]>=eps);\n\tif(tp<=k){\n\t\tfor(int i=1;i<=n;i++)if(p[i]>=eps)printf(\"1.00 \");else printf(\"0.00 \");exit(0);\n\t}for(int i=0;i<(1<<n);i++){if(ct(i)>k)continue;\n\t\tif(ct(i)==k){\n\t\t\tfor(int j=0;j<n;j++)if(i&(1<<j))as[j+1]+=f[i];\n\t\t\tcontinue;\n\t\t}db tp=0;\n\t\tfor(int j=0;j<n;j++)if(i&(1<<j))tp+=p[j+1];\n\t\tf[i]/=(1-tp);\n\t\tfor(int j=0;j<n;j++)if(~i&(1<<j))f[i|(1<<j)]+=f[i]*p[j+1];\n\t} for(int i=1;i<=n;i++)printf(\"%.10lf \",as[i]);\n}\n```\n",
        "postTime": 1616756261,
        "uid": 53852,
        "name": "\u5f26\u5dfb\u3053\u3053\u308d",
        "ccfLevel": 0,
        "title": "CF698CLRU"
    },
    {
        "content": "\u770b\u5230\u8fd9\u9898\u6ca1\u9898\u89e3\uff0c\u5413\u5f97\u6211\u8d76\u7d27\u6765\u6c34\u4e00\u53d1\n\n\u56e0\u4e3a$10^{100}$\u7070\u5e38\u5927\uff0c\u6240\u4ee5\u6700\u540e\u8fd8\u6ca1\u6709\u586b\u6ee1k\u4e2a\u7684\u6982\u7387\u5f88\u5c0f\uff08\u5f53\u7136\u6982\u7387\u4e0d\u4e3a0\u7684\u6570\u7684\u4e2a\u6570$<=k$\u7684\u60c5\u51b5\u9664\u5916\uff09\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u5f3a\u884c\u5728\u4e0a\u9762\u8dd1\u6982\u7387dp\u5373\u53ef\uff0c\u6ce8\u610f\u5728\u5bf9\u4e8e\u4e00\u4e2a\u5df2\u9009\u96c6\u5408$S$\uff0c\u8fd8\u662f\u7531\u4e8e$10^{100}$\u662f\u4e00\u4e2a\u6781\u5927\u503c\uff0c\u6240\u4ee5\u5f3a\u5236\u5176\u5411\u540e\u8f6c\u79fb\uff0c\u6240\u4ee5\u8981\u5bf9$dp[S]$\u8fdb\u884c$dp[S]=dp[S]/\\sum_{i\\notin S} p[i]$\n\n$p.s.\\ $\u9644\u4e0a\u63d0\u9192\uff1a\u6b64\u9898\u7cbe\u5ea6\u8981\u6c42\u8f83\u9ad8\uff0c$eps$\u8981\u5c0f\u4e00\u70b9\n\n$Code:$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst double eps = 1e-12;\nint n, k;\ndouble dp[1<<20], p[21], ans[21];\ninline int count1(int x){\n\tint tmp = 0;\n\twhile(x)x-=(x&(-x)), ++tmp;\n\treturn tmp;\n}\nint main(){\n\tint tmp = 0;\n\tscanf(\"%d%d\", &n, &k);\n\tfor(int i = 1; i <= n; ++ i)scanf(\"%lf\", &p[i]), tmp += (p[i] >= eps);\n\tif(tmp <= k){\n\t\tfor(int i = 1; i <= n; ++ i)printf(p[i] >= eps ? \"1 \" : \"0 \");\n\t\treturn 0;\n\t}\n\tdp[0] = 1;\n\tfor(int i = 0; i < (1 << n); ++ i){\n\t\tif(count1(i)==k){\n\t\t\tfor(int j = 0; j < n; ++ j)\n\t\t\t\tif(i&(1<<j)) ans[j+1] += dp[i];\n\t\t\tcontinue;\n\t\t}\n\t\tif(dp[i]<eps) continue;\n\t\tdouble tmp = 0;\n\t\tfor(int j = 0; j < n; ++ j)if(i&(1<<j))tmp+=p[j+1];\n\t\tdp[i]/=(1-tmp);\n\t\tfor(int j = 0; j < n; ++ j)if(~i&(1<<j))dp[i|(1<<j)]+=dp[i]*p[j+1];\n\t}\n\tfor(int i = 1; i <= n; ++ i)\n\t\tprintf(\"%.8lf \", ans[i]);\n\treturn 0;\n}\n```",
        "postTime": 1565181943,
        "uid": 29519,
        "name": "qianfujia",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF698C \u3010LRU\u3011"
    },
    {
        "content": "[\u6d1b\u8c37\u7684 latex \u4e0d\u884c\uff0c\u8bf7\u52a1\u5fc5\u524d\u5f80\u6211\u7684\u535a\u5ba2\u56ed\u67e5\u770b\uff01](https://www.cnblogs.com/dysyn1314/p/14297318.html)\n\n# CF698C LRU\n\n## \u9898\u76ee\u5927\u610f\n\n[\u9898\u76ee\u94fe\u63a5](https://codeforces.com/contest/698/problem/C)\n\n\u6709\u4e00\u4e2a\u521d\u59cb\u4e3a\u7a7a\u7684\u961f\u5217\uff0c\u5bb9\u91cf\u4e3a $k$\u3002\u6709 $n$ \u79cd\u7269\u54c1\u3002\n\n\u63a5\u4e0b\u6765\u4f1a\u8fdb\u884c $10^{100}$ \u6b21\u64cd\u4f5c\u3002\u6bcf\u6b21\u9009\u62e9\u4e00\u4e2a\u7269\u54c1\uff0c\u7269\u54c1 $i$ \u6709 $p_i$ \u7684\u6982\u7387\u88ab\u9009\u4e2d\u3002\u5982\u679c\u88ab\u9009\u4e2d\u7684\u7269\u54c1\u4e0d\u5728\u961f\u5217\u4e2d\uff0c\u5219\u5c06\u5b83\u52a0\u5165\u961f\u5217\u3002\u6b64\u65f6\u5982\u679c\u961f\u5217\u957f\u5ea6\u5927\u4e8e $k$\uff0c\u5219\u5f39\u51fa\u201c\u4e0a\u4e00\u6b21\u88ab\u9009\u4e2d\u7684\u65f6\u95f4\u201d\u6700\u65e9\u7684\u7269\u54c1\u3002\n\n\u95ee\u6240\u6709\u64cd\u4f5c\u7ed3\u675f\u540e\uff0c\u6bcf\u4e2a\u7269\u54c1\u4ecd\u5728\u961f\u5217\u4e2d\u7684\u6982\u7387\u3002\u4fdd\u7559 $6$ \u4f4d\u5c0f\u6570\u3002\n\n\u6570\u636e\u8303\u56f4\uff1a$1\\leq k\\leq n\\leq 20$\uff0c$0\\leq p_i\\leq 1$\uff0c$\\sum p_i = 1$\u3002\n\n## \u672c\u9898\u9898\u89e3\n\n\u8003\u8651\u5bf9\u6bcf\u4e2a\u7269\u54c1\u5206\u522b\u6c42\u7b54\u6848\u3002\u90a3\u4e48\u6709\u4e24\u79cd\u60c5\u51b5\uff1a\n\n1. \u64cd\u4f5c\u7ed3\u675f\u65f6\uff0c\u961f\u5217\u5185\u4e0d\u5230 $k$ \u79cd\u7269\u54c1\u3002\n2. \u64cd\u4f5c\u7ed3\u675f\u65f6\uff0c\u961f\u5217\u5185\u6709 $k$ \u79cd\u7269\u54c1\uff08\u662f\u6ee1\u7684\uff09\u3002\n\n\u5982\u679c $p_i \\neq 0$ \u7684\u7269\u54c1\u6570 $< k$\uff0c\u663e\u7136\u53ea\u80fd\u662f\u60c5\u51b5 1\u3002\u56e0\u4e3a\u64cd\u4f5c\u6b21\u6570\u6781\u5927\uff0c\u800c\u4e14\u4e0d\u53d1\u751f\u5f39\u51fa\uff0c\u6240\u4ee5\u6240\u6709 $p_i\\neq 0$ \u7684\u7269\u54c1\u7b54\u6848\u90fd\u662f $1$\u3002\n\n\u5426\u5219\uff0c\u5728\u7ecf\u8fc7\u4e86 $10^{100}$ \u6b21\u64cd\u4f5c\u540e\uff0c\u60c5\u51b5 1 \u51fa\u73b0\u7684\u6982\u7387\u53ef\u4ee5\u8fd1\u4f3c\u89c6\u4e3a $0$\u3002\u6545\u4ee5\u4e0b\u53ea\u8003\u8651\u60c5\u51b5 2\u3002\n\n\u8003\u8651\u6700\u7ec8\u7684\u961f\u5217\u91cc\u6709\u54ea\u4e9b\u7269\u54c1\u3002\u53d1\u73b0\u5c31\u662f\u6700\u540e\u52a0\u5165\u7684 $k$ **\u79cd**\u7269\u54c1\u3002\u4f8b\u5982\uff0c$k = 3$\uff0c\u82e5\u64cd\u4f5c\u5e8f\u5217\uff08\u6bcf\u6b21\u9009\u62e9\u7684\u7269\u54c1\uff09\u4e3a\uff1a$\\dots ,2,2,1,5,1,3,3,4$\uff0c\u5219\u6700\u7ec8\u961f\u5217\u91cc\u5c31\u662f\uff1a$\\{1,3,4\\}$\u3002\n\n\u8003\u8651\u72b6\u538b DP\u3002\u8bbe $\\text{dp}(s)$ \u8868\u793a\u64cd\u4f5c\u5e8f\u5217\u7684\u4e00\u4e2a**\u540e\u7f00**\u91cc\uff0c\u7269\u54c1\u96c6\u5408\u4e3a $s$ \u7684\u6982\u7387\u3002$s$ \u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u72b6\u538b\u3002\n\n\u8f6c\u79fb\u65f6\uff0c\u679a\u4e3e\u4e0b\u4e00\u4e2a\u8fd8\u672a\u5728 $s$ \u5185\u51fa\u73b0\u8fc7\u7684\u7269\u54c1\uff0c\u8bb0\u4e3a\u7269\u54c1 $u$\uff08\u5176\u5b9e\u662f\u64cd\u4f5c\u5e8f\u5217\u66f4\u524d\u9762\u7684\u7269\u54c1\uff0c\u56e0\u4e3a\u6839\u636e\u72b6\u6001\u8bbe\u8ba1\uff0c\u6211\u4eec\u662f\u4ece\u540e\u5f80\u524d DP \u7684\uff09\u3002\u8bbe $\\text{sum}(s) = \\sum_{v\\in s}p_v$\u3002\u5219\uff1a\n$$\n\\forall u\\notin s, p_u\\neq 0: \\quad \\text{dp}(s)\\cdot (p_u + \\text{sum}(s)\\cdot p_u + \\text{sum}(s)^2\\cdot p_u + \\dots) \\to \\text{dp}(s \\cup \\{u\\})\n$$\n\u62ec\u53f7\u91cc\u7684\u5f0f\u5b50\uff0c\u8868\u793a\uff1a\u3010\u4e0b\u4e00\u6b21\u5c31\u9009\u4e2d $u$ \u7684\u6982\u7387\u3011 $+$ \u3010\u5148\u9009\u4e2d\u4e00\u4e2a\u5df2\u6709\u7684\u6570\uff0c\u518d\u4e0b\u6b21\u624d\u9009\u4e2d $u$ \u7684\u6982\u7387\u3011 $+$ \u3010\u4e0b\u4e0b\u4e0b\u6b21\u624d\u9009\u4e2d $u$ \u7684\u6982\u7387\u3011 $\\dots$\u3002\u56e0\u4e3a\u64cd\u4f5c\u6b21\u6570\u6781\u5927\uff0c\u6240\u4ee5\u6709\uff1a\n$$\n\\begin{align}\n&\\text{dp}(s) \\cdot \\sum_{i = 0}^{\\infty} \\text{sum}(s)^i \\cdot p_u\\\\\n=& \\text{dp}(s)\\cdot p_u\\cdot \\sum_{i = 0}^{\\infty} \\text{sum}(s)^i\\\\\n=& \\text{dp}(s)\\cdot p_u\\cdot \\frac{1}{1 - \\text{sum}(s)}\n\\end{align}\n$$\n\u4e5f\u53ef\u4ee5\u8fd9\u6837\u7406\u89e3\u4e0a\u8ff0\u7684\u8f6c\u79fb\u5f0f\uff1a\u53ea\u8981\u9009\u5230 $s$ \u91cc\u7684\u6570\uff0c\u6211\u4eec\u5c31**\u5047\u88c5\u65e0\u4e8b\u53d1\u751f\uff0c\u518d\u9009\u4e00\u6b21**\u3002\u6d6a\u8d39\u7684\u8fd9\u4e00\u6b21\u64cd\u4f5c\u5bf9\u7b54\u6848\u6ca1\u6709\u5f71\u54cd\uff0c\u56e0\u4e3a\u603b\u64cd\u4f5c\u6b21\u6570\u8fd1\u4f3c\u65e0\u7a77\u5927\u3002\u6240\u4ee5\u8fd9\u5c31\u7b49\u4ef7\u4e8e\uff0c\u6211\u4eec**\u5f3a\u884c\u628a $s$ \u96c6\u5408\u91cc\u5df2\u6709\u7684\u6570\uff0c\u88ab\u62bd\u5230\u7684\u6982\u7387\u89c6\u4e3a $0$**\u3002\u5269\u4e0b\u7684\u6570\u6982\u7387\u5bf9\u5e94\u5730\u53d8\u4e3a\uff1a$\\displaystyle p_u' = \\frac{p_u}{\\sum_{v\\notin s}p_v} = \\frac{p_u}{1 - \\text{sum}(s)}$\u3002\n\n\u4e8e\u662f\u5c31\u53ef\u4ee5\u8f6c\u79fb\u4e86\u3002\n\n\u8fb9\u754c\u662f\uff1a$\\text{dp}(0) = 1$\u3002\u7269\u54c1 $i$ \u7684\u7b54\u6848\u5c31\u662f $\\displaystyle \\sum_{i\\in s, |s| = k}\\text{dp}(s)$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(2^nn)$\u3002\n\n## \u53c2\u8003\u4ee3\u7801\n\n```cpp\n// problem: CF698C\n#include <bits/stdc++.h>\nusing namespace std;\n\n#define mk make_pair\n#define fi first\n#define se second\n#define SZ(x) ((int)(x).size())\n\ntypedef unsigned int uint;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int, int> pii;\n\ntemplate<typename T> inline void ckmax(T& x, T y) { x = (y > x ? y : x); }\ntemplate<typename T> inline void ckmin(T& x, T y) { x = (y < x ? y : x); }\n\nconst int MAXN = 20;\n\nint n, K;\nint hibit[1 << MAXN], bitcnt[1 << MAXN];\ndouble p[MAXN + 5], sum[1 << MAXN];\ndouble f[1 << MAXN];\n\nint main() {\n\tcin >> n >> K;\n\tint cnt = 0;\n\tfor (int i = 1; i <= n; ++i) {\n\t\tcin >> p[i];\n\t\tcnt += (p[i] != 0);\n\t}\n\tif (cnt < K) {\n\t\tfor (int i = 1; i <= n; ++i) {\n\t\t\tcout << (p[i] == 0 ? 0 : 1) << \".00000000\" << \" \\n\"[i == n];\n\t\t}\n\t\treturn 0;\n\t}\n\t\n\tfor (int i = 1; i <= n; ++i) {\n\t\thibit[1 << (i - 1)] = i;\n\t}\n\tfor (int i = 1; i < (1 << n); ++i) {\n\t\tbitcnt[i] = bitcnt[i - (i & (-i))] + 1;\n\t\tsum[i] = sum[i - (i & (-i))] + p[hibit[i & (-i)]];\n\t}\n\t\n\tf[0] = 1;\n\tfor (int i = 1; i < (1 << n); ++i) {\n\t\tif (bitcnt[i] > K)\n\t\t\tcontinue;\n\t\tfor (int _j = i; _j; _j -= (_j & (-_j))) {\n\t\t\tint j = hibit[_j & (-_j)];\n\t\t\t\n\t\t\tassert((1 << (j - 1)) == (_j & (-_j)));\n\t\t\t\n\t\t\tif (p[j] == 0)\n\t\t\t\tcontinue;\n\t\t\t\n\t\t\tf[i] += f[i ^ (1 << (j - 1))] * (p[j] / sum[((1 << n) - 1) ^ i ^ (1 << (j - 1))]);\n\t\t}\n\t}\n\tcout << setiosflags(ios :: fixed) << setprecision(10);\n\t\n\tfor (int i = 1; i <= n; ++i) {\n\t\t/*\n\t\tdouble ans = pow(1.0 - p[i], 100000000); // \u6ca1\u51fa\u73b0\u8fc7 \n\t\tfor (int s = 0; s < (1 << n); ++s) {\n\t\t\tif (((s >> (i - 1)) & 1) == 0 && bitcnt[s] >= K) {\n\t\t\t\tans += p[i] / sum[((1 << n) - 1) ^ s] * f[s]; // \u51fa\u73b0\u4e86\u4f46\u88ab\u4ee3\u66ff \n\t\t\t}\n\t\t}\n\t\tans = 1.0 - ans;\n\t\tcout << ans << \" \\n\"[i == n];\n\t\t*/\n\t\t\n\t\tdouble ans = 0;\n\t\tfor (int s = 0; s < (1 << n); ++s) {\n\t\t\tif (((s >> (i - 1)) & 1) && bitcnt[s] == K) {\n\t\t\t\tans += f[s];\n\t\t\t}\n\t\t}\n\t\tcout << ans << \" \\n\"[i == n];\n\t}\n\treturn 0;\n}\n```\n\n\n\n\n\n\n\n\n\n",
        "postTime": 1611031845,
        "uid": 100674,
        "name": "duyi",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 CF698C \u3010LRU\u3011"
    },
    {
        "content": "\u770b\u89c1\u8fd9\u79cd $10^{100}$ \u7684\uff0c\u4e00\u822c\u5f53\u4f5c $\\infty$ \u6765\u505a\u5c31\u884c\u3002\n\n\u6240\u4ee5\u4e00\u4e2a\u5143\u7d20\u5df2\u7ecf\u5728\u961f\u5217\u5185\uff0c\u5c31\u53ef\u4ee5\u628a\u5b83\u7684\u6982\u7387\u5f53\u4f5c$0$\uff0c\u5e76\u6309\u6bd4\u4f8b\u63d0\u9ad8\u5176\u4ed6\u5143\u7d20\u7684\u6982\u7387\u3002\n\n\u8003\u8651\u4e00\u4e2a\u5143\u7d20\u5728\u961f\u5217\u5185\u8981\u6ee1\u8db3\u4ec0\u4e48\u60c5\u51b5\u3002\n\n\u7565\u52a0\u601d\u8003\u5c31\u4f1a\u53d1\u73b0\u4e00\u4e2a\u5143\u7d20\u5728\u961f\u5217\u5185\uff0c\u5f53\u4e14\u4ec5\u5f53\u6700\u540e $k$ \u6b21\u5165\u961f\u64cd\u4f5c\u91cc\u6709\u51fa\u73b0\u8fd9\u4e2a\u5143\u7d20\u3002\n\n\u4e8e\u662f\u6211\u4eec\u7684\u76ee\u6807\u5c31\u662f\u6c42\u51fa\u6240\u6709 $A_n^k$ \u79cd\u961f\u5217\u65b9\u6848\u7684\u6982\u7387\u3002\n\n\u5047\u5982\u5df2\u77e5\u4e00\u4e2a\u72b6\u6001\u4e0b\u7684\u6982\u7387\uff0c\u90a3\u4e48\u8fd9\u4e2a\u72b6\u6001\u518d\u52a0\u4e00\u4e2a\u7269\u54c1\u7684\u6982\u7387\u662f\u5f88\u597d\u6c42\u7684\u3002\n\n\u4f46\u662f\u8fd9\u4e2a\u72b6\u6001\u592a\u591a\u4e86\uff0c\u6709 $A_n^k$ \u4e2a\uff0c\u8003\u8651\u7b80\u5316\u72b6\u6001\u3002\n\n\u53d1\u73b0\u987a\u5e8f\u662f\u53ef\u4ee5\u4e0d\u7528\u8003\u8651\u7684\u3002\n\n\u8bbe $dp_S$ \u8868\u793a\u72b6\u6001\u4e3a $S$ \u65f6\u7684\u6982\u7387\uff08\u4e0d\u8003\u8651\u987a\u5e8f\uff0c\u4e5f\u5c31\u662f\u8bf4\u6bcf\u79cd\u987a\u5e8f\u90fd\u8981\u7b97\uff09\u3002\n\n\u8bbe $T$ \u8868\u793a\u4ece $S$ \u4e2d\u53bb\u6389\u4e00\u4e2a\u5143\u7d20\u7684\u72b6\u6001\uff0c\u5e76\u4e14\u90a3\u4e2a\u5143\u7d20\u7684\u4e0b\u6807\u4e3a $i$\u3002\n\n\u90a3\u4e48 $dp_S=\\sum dp_T\\times P(i,T)$\n\n\u8fd9\u91cc $P(i,T)$ \u8868\u793a\u5728 $T$ \u8fd9\u4e2a\u72b6\u6001\u4e0b\u9009\u5230 $i$ \u7684\u6982\u7387\u3002\n\n\u7b54\u6848 $ans_i$ \u5c31\u7b49\u4e8e\u6bcf\u4e2a\u5305\u542b $k$ \u4e2a\u5143\u7d20\u4e14\u5305\u542b $i$ \u5143\u7d20\u7684\u72b6\u6001\u7684\u6982\u7387\u4e4b\u548c\u3002\n\n\u6ce8\u610f\uff1a\n\n1.\u7a7a\u95f4\uff0c\u522b\u5f00 $long\\ double$\n\n2.\u5047\u5982\u6982\u7387\u5927\u4e8e $0$ \u7684\u5143\u7d20\u4e0d\u8db3 $k$ \u4e2a\uff0c\u5047\u8bbe\u6709 $cnt$ \u4e2a\uff0c\u8981\u628a $k$ \u8d4b\u503c\u6210 $cnt$\u3002\n\n3.\u679a\u4e3e\u72b6\u6001\u4e0d\u80fd\u6309\u7167\u666e\u901a\u7684\u72b6\u538b $dp$\uff0c \u8981\u6309\u6bcf\u4e2a\u72b6\u6001\u4e2d\u7684\u5143\u7d20\u4e2a\u6570\u6392\u5e8f\u540e\u679a\u4e3e\u3002\n\n\u590d\u6742\u5ea6\uff1a$O(n\\times 2^k)$\n\n$Code:$\n\n```cpp\n#include <bits/stdc++.h>\n#define ld long double\n \nusing std::cin;\nusing std::cout;\n \nconst int N = 21, maxn = 7 + (1 << 20);\n \nstruct node{\n\tint id, val;\n\tbool operator < (const node &a)const {\n\t\tif (val == a.val) return id < a.id;\n\t\telse\n\t\treturn val < a.val;\n\t}\n}q[maxn];\n \nint n, k;\ndouble a[N], p[N][maxn], dp[maxn], ans[N];\nbool vis[N];\n \nint main() {\n\tstd::ios::sync_with_stdio(0);\n\tcin >> n >> k;\n\tfor (int i = 0; i < n; ++ i) cin >> a[i];\n\tint res = 0;\n\tfor (int i = 0; i < n; ++ i) res += (a[i] > 0);\n\tk = std::min(k, res);\n\tfor (int S = 0; S < (1 << n); ++ S) {\n\t\tmemset(vis, 0, sizeof(vis));\n\t\tdouble sum = 0;\n\t\tfor (int i = 0; i < n; ++ i) {\n\t\t\tif (S & (1 << i)) continue;\n\t\t\tvis[i] = 1;\n\t\t\tsum += a[i];\n\t\t}\n\t\tfor (int i = 0; i < n; ++ i) {\n\t\t\tif (!vis[i]) {\n\t\t\t\tp[i][S] = 0;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (sum == 0) p[i][S] = 0;\n\t\t\telse p[i][S] = a[i] / sum;\n\t\t}\n\t}\n\tint cnt = 0;\n\tfor (int S = 0; S < (1 << n); ++ S) {\n\t\tq[++ cnt].id = S;\n\t\tq[cnt].val = __builtin_popcount(S);//\u7528STL\u7b97\u5143\u7d20\u4e2a\u6570\n\t}\n\tstd::sort(q + 1, q + 1 + cnt);\n\tdp[0] = 1.0;\n\tfor (int i = 2; i <= cnt; ++ i) {\n\t\tint S = q[i].id;\n\t\tfor (int j = 0; j < n; ++ j) {\n\t\t\tif (!(S & (1 << j))) continue;\n\t\t\tint T = S ^ (1 << j);\n\t\t\tdp[S] += dp[T] * p[j][T];\n\t\t}\n\t\tif (i == cnt) break;\n\t\tif (q[i + 1].val > k) break;\n\t}\n\tfor (int S = 0; S < (1 << n); ++ S) {\n\t\tif (__builtin_popcount(S) != k) continue;\n\t\tfor (int i = 0; i < n; ++ i) {\n\t\t\tif (!(S & (1 << i))) continue;\n\t\t\tans[i] += dp[S];\n\t\t}\n\t}\n\tfor (int i = 0; i < n; ++ i) cout << std::setprecision(10) << ans[i] << ' ';\n\treturn 0;\n} \n```\n\n",
        "postTime": 1601283826,
        "uid": 93286,
        "name": "Yuno",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 CF698C \u3010LRU\u3011"
    },
    {
        "content": "\u6700\u540e\u7559\u4e0b\u4e86k\u4e2a\u7684\u6982\u7387\u5176\u5b9e\u76f8\u5f53\u4e8e\u4e00\u5f00\u59cbk\u4e2a\u7684\u6982\u7387\uff08\u5373\u5c06\u6240\u6709\u64cd\u4f5c\u5012\u7740\u6765\u8003\u8651\uff09\u3002\n\n\u53d1\u73b0$n$\u53ea\u670920\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u72b6\u6001\u538b\u7f29\u6765\u4fdd\u5b58\u961f\u5217\u4e2d\u7684\u72b6\u6001\u3002\u5047\u5982\u5f53\u524d\u72b6\u6001\u4e3a$dp_i$\uff0c\u63a5\u4e0b\u6765\u8981\u63d2\u5165$p_j$\u6982\u7387\u8fd9\u4e2a\u7269\u4f53\uff0c$w_i$\u4ee3\u8868\u961f\u5217\u4e2d\u7684\u6570\u7684\u6982\u7387\u548c\u3002\u90a3\u4e48\u63d2\u5165\u8fd9\u4e2a\u7269\u54c1\u7684\u6982\u7387\u5373\u4e3a$p_j$\uff08\u7b2c\u4e00\u8f6e\u5c31\u9009\u5230\uff09+$p_j*w_j$\uff08\u524d\u4e00\u8f6e\u53ea\u9009\u5230\u961f\u5217\u4e2d\u7684\u6570\uff0c\u8fd9\u4e00\u8f6e\u9009\u5230\uff09+$p_j*w_j^2$\uff08\u524d\u4e24\u8f6e\u53ea\u9009\u5230\u961f\u5217\u4e2d\u7684\u6570\uff0c\u8fd9\u4e00\u8f6e\u9009\u5230\uff09\u2026\u2026\n\n\u4e5f\u5c31\u662f\uff1a\n\n$\\sum\\limits_{k=0}p_j*w_i^k = p_j / (1 - w_j)$\n\n\uff08\u7531\u4e8e\u64cd\u4f5c\u6b21\u6570\u5f88\u5927\u6240\u4ee5\u89c6\u4e3a\u65e0\u7a77\u5927\uff09\n\n\u800c\u64cd\u4f5c\u6b21\u6570\u5f88\u5927\u6240\u4ee5\u53ea\u8981\u80fd\u53d6\u5f97\u7269\u54c1\u8d85\u8fc7k\u961f\u5217\u5c31\u4e00\u5b9a\u4f1a\u6ee1\uff0c\u6bcf\u4e2a\u7269\u4f53\u51fa\u73b0\u6982\u7387\u5373\u4e3a\u6bcf\u4e2a\u5305\u542b\u5b83\u6ee1\u961f\u5217\u7684\u72b6\u6001\u7684\u6982\u7387\u4e4b\u548c\n\n\u82e5\u80fd\u53d6\u7269\u54c1\u4e0d\u8d85\u8fc7k\u90a3\u4e48\u6240\u6709\u80fd\u53d6\u5f97\u7269\u54c1\u5fc5\u7136\u4f1a\u51fa\u73b0\u5728\u961f\u5217\u91cc\n\n```\n#include <iostream>\n#include <cstdio>\nusing namespace std;\nint n, k, tot, num[1 << 21];\ndouble p[30], dp[1 << 21], z[1 << 21], a[30];\nint cnt(int o)\n{\n\tint ans = 0;\n\twhile(o > 0)\n\t{\n\t\t++ ans;\n\t\to -= (o & (-o));\n\t}\n\treturn ans;\n}\nint main()\n{\n\tscanf(\"%d%d\", &n, &k);\n\tfor (int i = 1; i <= n; ++ i)\n\t{\n\t\tscanf(\"%lf\", &p[i]);\n\t\tif(p[i] > 0)\n\t\t++ tot;\n\t\tnum[(1 << (i - 1))] = i;\n\t}\n\tif(tot <= k)\n\t{\n\t\tfor (int i = 1; i <= n; ++ i)\n\t\t{\n\t\t\tprintf(\"%d \", p[i] > 0 ? 1 : 0);\n\t\t}\n\t\treturn 0;\n\t}\n\tfor (int i = 1; i < (1 << n); ++ i)\n\t{\n\t\tz[i] = z[i - (i & (-i))] + p[num[i & (-i)]];\n\t}\n\tdp[0] = 1;\n\tfor (int i = 0; i < (1 << n); ++ i)\n\t{\n\t\tint c = cnt(i);\n\t\tif(c >= k)\n\t\t{\n\t\t\tif(c == k)\n\t\t\t{\n\t\t\t\tfor (int j = 1; j <= n; ++ j)\n\t\t\t\t{\n\t\t\t\t\tif(i & (1 << (j - 1)))\n\t\t\t\t\ta[j] += dp[i];\n\t\t\t\t}\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\t\tfor (int j = 1; j <= n; ++ j)\n\t\t{\n\t\t\tif(i & (1 << (j - 1)))continue;\n\t\t\tdp[i | (1 << (j - 1))] += dp[i] * p[j] / (1.0 - z[i]);\n\t\t}\n\t}\n\tfor (int i = 1; i <= n; ++ i)\n\t{\n\t\tprintf(\"%.10lf \", a[i]);\n\t}\n}\n```\n",
        "postTime": 1601206311,
        "uid": 111728,
        "name": "\u5e7b\u5f71\u661f\u575a\u5f3a",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF698C \u3010LRU\u3011"
    },
    {
        "content": "~~\u770b\u52301e100\u7684\u7b2c\u4e00\u773c\u662f\u61f5\u903c\u7684~~\n\n\u4f46\u6211\u4eec\u7a0d\u52a0\u63a8\u7406\u540e\u53d1\u73b0\uff0c\u7ecf\u8fc71e100\u6b21\u8ba1\u7b97\u540e\uff0c\u53ea\u6709\u4e24\u79cd\u60c5\u51b5\uff0c\n\n- \u961f\u5217\u672a\u586b\u6ee1\n- \u961f\u5217\u5df2\u6ee1\n\n\n------------\n\n\n\u5bf9\u4e8e\u60c5\u51b5\u4e00\n,\u5f88\u660e\u663e\u7684\u662f\uff0c\u5982\u679c\u6982\u7387\u5927\u4e8e0\u7684\u7269\u54c1\u4ef6\u6570 \u2264 k ,\u961f\u5217\u5c31\u4e0d\u53ef\u80fd\u88ab\u586b\u6ee1\uff0c\u6982\u7387\u5927\u4e8e0\u7684\u7269\u54c1\u4e00\u5b9a\u4f1a\u88ab\u9009\u4e2d\uff0c\u5373\n$$\\sum_{i=1}^n sgn(p_i) \\leq k$$\n\u90a3\u4e48\u5f88\u663e\u7136\u7269\u54c1i\u7684\u6982\u7387\u4e3a\n$$sgn(p_i)$$\nsgn()\u7684\u7684\u5b9a\u4e49[\u6233](https://baike.so.com/doc/6702853-6916804.html)\n\n\n\n\n------------\n\n\n\u60c5\u51b5\u4e8c\u5c31\u8981\u5f00\u59cb~~\u4e71\u641e~~\u4e25\u8c28dp\u4e86\n\n\u57281e100\u6b21\u64cd\u4f5c\u540e\uff0c\u67d0\u6837\u7269\u54c1\u7684\u6982\u7387\u5341\u5206\u63a5\u8fd1\u4e8e\u6b64\u7269\u54c1\u961f\u5217\u5df2\u6ee1\u60c5\u51b5\u4e0b\u6982\u7387\uff0c\u6211\u4eec\u53ef\u4ee5\u8ba4\u4e3a\u4e24\u6570\u76f8\u7b49\n\n\u7528\u96c6\u5408A\u8868\u793a\u5f53\u524d\u961f\u5217\u7684\u72b6\u6001,\u96c6\u5408B\u8868\u793a\u672a\u9009\u7684\u96c6\u5408\uff0c\u90a3\u4e48\u5f88\u5bb9\u6613\u63a8\u51fa\uff0c\u9009\u5230x(x\u2208B)\u7684\u6982\u7387\u4e3a\n$$\\frac{p_x}{\\sum_{i\u2208B}pi} $$\n\n\u90a3\u4e48\u5982\u679c\u7528f(A)\u8868\u793aA\u72b6\u6001\u7684\u6982\u7387\uff0c\u90a3\u4e48\u5b83\u5bf9f(A\u222a{x})\u7684\u8d21\u732e\u5c31\u4e3a\n$$f_A*\\frac{p_x}{\\sum_{i\u2208B}pi}$$\n\u90a3\u4e48\u6700\u7ec8\u7684\u7b54\u6848\u5c31\u662f\n$$ans_i=\\sum_{i\u2208A,|A|=k}f_A$$\n\n\u7136\u540e\u6211\u4eec\u53ea\u5269\u4e0b\u4e86\u6700\u540e\u4e00\u4e2a\u95ee\u9898\uff0c\u5982\u4f55\u5728C++\u91cc\u8868\u793a\u96c6\u5408\n\n\u7531\u4e8e\u8fd9\u9053\u9898\u7684n\u5f88\u5c0f\uff0c\u5b8c\u5168\u53ef\u4ee5\u7528\u72b6\u538b\uff0c\u7528\u4e00\u4e2a\u6570\u6765\u8868\u793a\u67d0\u4e2a\u72b6\u6001\uff0c\u7136\u540e\u5c31\u53ef\u4ee5\u6109\u5feb\u7684dp\u4e86\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=21;\nint n,k;\nlong double p[maxn],f[1<<maxn];\nlong double ans[maxn];\n/*\nf[x]\u8868\u793a S\u72b6\u6001\u7684\u6982\u7387\nx=\u03a32^Si  \u72b6\u538b\n\u82e5a\u4e0d\u5728\u96c6\u5408S\u4e2d\nf[x|(2^a)]= f[x]*(Pa/\u03a3Pa)\n*/\n//#define debug 1\nvoid dp(int x){\n\t//\u5904\u7406x\u72b6\u6001\n\tint cnt=0;\n\tlong double tot=0;\n\tfor(int i=1;i<=n;i++){\n#ifdef debug\n\t\tcout<<i<<\" \"<<(x&(1<<(i-1)))<<endl;\n#endif\n\t\tif((x&(1<<(i-1)))==0)\n\t\t\ttot+=p[i];\n\t\telse\n\t\t\tcnt++;\n\t}\n#ifdef debug\n\tcout<<x<<\" \"<<tot<<\" \"<<cnt<<endl;\n#endif\n\tif(cnt>k)\n\t\treturn;\n\telse if(cnt==k)\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tif(x&(1<<(i-1)))\n\t\t\t\tans[i]+=f[x];\n\t\t}\n\telse\n\t\tfor(int i=1;i<=n;i++)\n\t\t\tif((x&(1<<(i-1)))==0)\n\t\t\t\tf[x|(1<<(i-1))]+=f[x]*(p[i]/tot);\n}\nsigned main(){\n\tf[0]=1;int __tmp__=0;\n\tcin>>n>>k; \n\tfor(int i=1;i<=n;i++){\n\t\tcin>>p[i];\n\t\tif(p[i]>1e-8)__tmp__++;\n\t\t//cout<<p[i]<<endl;\n\t} \n\tif(__tmp__<=k){//\u4e0d\u53ef\u80fd\u586b\u6ee1 \n\t\t//printf (\"No way to fill\\n\");\n\t\tfor(int i=1;i<=n;i++){\n\t\t\tif(p[i]>1e-8)\n\t\t\t\tprintf(\"1 \");\n\t\t\telse\n\t\t\t\tprintf(\"0 \");\n\t\t}\n\t\treturn 0;\n\t}\n\t//\u4e00\u5b9a\u80fd\u586b\u6ee1\n\tfor(int i=0;i<(1<<n);i++)\n\t \tdp(i);//\u5904\u7406i\u72b6\u6001\n\tfor(int i=1;i<=n;i++)\n\t\tcout<<ans[i]<<\" \"; \n} \n```",
        "postTime": 1587912639,
        "uid": 174304,
        "name": "jun\u5934\u5409\u5409",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF698C \u3010LRU\u3011"
    },
    {
        "content": "\u56e0\u4e3a $10^{100}$ \u76f8\u5bf9\u4e8e\u8fd9\u9053\u9898\u8981\u6c42\u7684\u7cbe\u5ea6\u662f\u4e00\u4e2a\u5f88\u5927\u7684\u6570\uff0c\u6240\u4ee5\u6bcf\u4e2a\u6570\u6700\u7ec8\u5728\u961f\u5217\u4e2d\u7684\u6982\u7387\u4f1a\u8d8b\u8fd1\u4e8e\u4e00\u4e2a\u56fa\u5b9a\u7684\u503c\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u8981\u6c42\u7684\u7b54\u6848\u3002\u8bbe $g(i,S)$ \u8868\u793a\u8fdb\u884c $i$ \u6b21\u64cd\u4f5c\u540e\uff0c\u961f\u5217\u4e2d\u5143\u7d20\u4e3a\u96c6\u5408 $S$ \u7684\u6982\u7387\u3002\u90a3\u4e48\u5f53 $i$ \u8d8b\u8fd1\u65e0\u7a77\u5927\u65f6\uff0c$g(i,S)=g(i+1,S)$\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u5173\u7cfb\u5217\u51fa\u4e00\u7ec4\u7ebf\u6027\u65b9\u7a0b\u6765\u89e3\u51fa\u5b83\u4eec\u3002\u4f46\u662f\u8fd9\u4e2a\u72b6\u6001\u662f\u6709\u540e\u6548\u6027\u7684\uff0c\u800c\u9ad8\u65af\u6d88\u5143\u7684\u590d\u6742\u5ea6\u65e0\u6cd5\u627f\u53d7\u3002\u6240\u4ee5\u6211\u4eec\u6539\u8bbe\u72b6\u6001\u4e3a $f(S)$ \u8868\u793a\u7ecf\u8fc7\u8db3\u591f\u591a\u6b21\u64cd\u4f5c\u540e\uff0c\u961f\u5217\u4e2d\u5143\u7d20**\u5305\u542b\u5b50\u96c6 $S$** \u7684\u6982\u7387\u3002\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5 DP \u6c42\u89e3\u4e86\uff1a\u53ea\u7528\u8003\u8651\u4e0d\u5728\u8fd9\u4e2a\u5b50\u96c6\u5185\u7684\u5143\u7d20\uff0c\u6bcf\u6b21\u8f6c\u79fb\u65f6\u679a\u4e3e\u8fd9\u4e9b\u5143\u7d20\u5e76\u5c06\u5b83\u4eec\u52a0\u5165\u5373\u53ef\u3002\n\n\u6ce8\u610f\u9700\u8981\u7279\u5224\u6982\u7387\u4e0d\u4e3a $0$ \u7684\u5143\u7d20\u4e0d\u8db3 $k$ \u4e2a\u7684\u60c5\u51b5\u3002\n\n```cpp\n#include <cstdio>\nconst int MAXN=22;\nconst int MAXS=1100000;\ndouble p[MAXN], f[MAXS], ans[MAXN];\nint main()\n{\n//\tfreopen(\"C.in\", \"r\", stdin);\n//\tfreopen(\"C.out\", \"w\", stdout);\n\tint n, k, cnt=0;\n\tscanf(\"%d%d\", &n, &k);\n\tfor (int i=0; i<n; i++)\n\t{\n\t\tscanf(\"%lf\", &p[i]);\n\t\tif (p[i]>0) cnt++;\n\t}\n\tif (cnt<=k)\n\t{\n\t\tfor (int i=0; i<n; i++) printf(\"%d \", p[i]>0);\n\t\tputchar('\\n');\n\t\treturn 0;\n\t}\n\tf[0]=1;\n\tfor (int s=0; s<1<<n; s++)\n\t{\n\t\tif (__builtin_popcount(s)==k)\n\t\t\tfor (int i=0; i<n; i++)\n\t\t\t\tif (s&1<<i) ans[i]+=f[s];\n\t\tdouble tmp=0;\n\t\tfor (int i=0; i<n; i++)\n\t\t\tif (~s&1<<i) tmp+=p[i];\n\t\ttmp=f[s]/tmp;\n\t\tfor (int i=0; i<n; i++)\n\t\t\tif (~s&1<<i) f[s|1<<i]+=tmp*p[i];\n\t}\n\tfor (int i=0; i<n; i++) printf(\"%.7lf \", ans[i]);\n\tputchar('\\n');\n\treturn 0;\n}\n```\n",
        "postTime": 1585896767,
        "uid": 152449,
        "name": "\u7075\u68a6",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF698C \u3010LRU\u3011"
    },
    {
        "content": "\u4e3a\u4ec0\u4e48 $ n,k \\leq 20 $\uff1f\n\n\u6211\u8fd8\u4ee5\u4e3a\u662f\u4ec0\u4e48 $ n,k \\leq 10^6 $ \u7684\u5389\u5bb3\u9898/qd\n\n\u770b\u5230\u8fd9\u4e2a\u961f\u5217\u64cd\u4f5c\u5f88\u8ff7\u60d1\uff0c\u4f46\u662f\u4ed4\u7ec6\u770b\u770b\u8981\u64cd\u4f5c $ 10^{100} $ \u904d\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u5c06\u8fd9\u4e2a\u9898\u610f\u7406\u89e3\u6210\u5728 $ n $ \u4e2a\u6570\u91cc\u9762\u9009 $ k $ \u4e2a\u6570\u7684\u6982\u7387\u3002\n\n\u8fd9\u5c31\u5f88\u7b80\u5355\u4e86\uff0c\u56e0\u4e3a $ n \\leq 20 $\uff0c\u6240\u4ee5\u6211\u4eec\u76f4\u63a5\u5927\u529b\u679a\u4e3e\u5305\u542b $ i $ \u7684\u5b50\u96c6\uff0c\u7136\u540e\u8ba1\u7b97\u9009\u5230\u8fd9\u4e2a\u5b50\u96c6\u7684\u6982\u7387\uff0c\u7136\u540e\u5c31\u6ca1\u4e86\u3002\n\n\u8fd9\u4e2a\u4e1c\u897f\u5f88\u5bb9\u6613\u7528\u5b50\u96c6 dp \u6765\u8f6c\u79fb\uff0c\u5b50\u96c6\u7684\u6982\u7387\u4e4b\u548c\u4e5f\u53ef\u4ee5\u4f7f\u7528 FWT \u6765\u8ba1\u7b97\u3002\n\n\u8bb0\u5f97\u7279\u5224\u67d0\u4e9b\u60c5\u51b5\u4f1a\u8f93\u51fa `nan`\u3002\n```cpp\n#include<cstdio>\n#include<cmath>\nint n,x,S,cnt,siz[1<<20];double ans[20],s[1<<20],P[1<<20];\nsigned main(){\n\tint i,k,len;\n\tscanf(\"%d%d\",&n,&x);S=1<<n;s[0]=1;\n\tfor(i=0;i^n;++i)scanf(\"%lf\",P+(1<<i)),cnt+=P[1<<i]!=0;if(cnt<x)x=cnt;\n\tfor(len=1;len^S;len<<=1)for(k=0;k^S;k+=len<<1)for(i=0;i^len;++i)P[i|k|len]+=P[i|k];\n\tfor(i=0;i^S;++i){\n\t\tsiz[i]=siz[i>>1]+(i&1);\n\t\tfor(k=0;k^n;++k)if(i>>k&1)s[i]+=s[i^1<<k]*P[1<<k]/P[S-1^i^1<<k];\n\t\tif(siz[i]==x)for(k=0;k^n;++k)if(i>>k&1)ans[k]+=s[i];\n\t}\n\tfor(i=0;i^n;++i)printf(\"%.9lf \",ans[i]);\n}\n```",
        "postTime": 1638867833,
        "uid": 160839,
        "name": "Prean",
        "ccfLevel": 7,
        "title": "FWT \u671f\u671b CF698C\u9898\u89e3"
    }
]
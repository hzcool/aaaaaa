[
    {
        "content": "## Solution\n- \u53ef\u4ee5\u53d1\u73b0\uff0c\u4e00\u4e2a\u6b27\u62c9\u5e8f $a$ \u5408\u6cd5\u5f53\u4e14\u4ec5\u5f53\uff1a\n  1. $\\forall 1 \\le i \\le 2n - 1, 1 \\le a_i \\le n$\uff1b \n  2. $a_1 = a_{2n - 1}$\uff1b\n  3. $\\forall a_l = a_r$\uff0c$r - l$ \u4e3a\u5076\u6570\u4e14 $[l,r]$ \u5185\u51fa\u73b0\u4e86\u6070\u597d $\\dfrac{r - l}{2} + 1$ \u79cd\u4e0d\u540c\u7684\u6743\u503c\uff1b\n  4. \u6240\u6709\u6ee1\u8db3 $a_l = a_r$ \u7684\u533a\u95f4 $[l,r]$ \u53ea\u6709\u5305\u542b\u5173\u7cfb\u3002\n\n- \u8bbe\u5f53\u524d\u533a\u95f4\u4e3a $[l,r]$\uff0c\u56e0\u4e3a\u6ee1\u8db3 $a_l' = a_r'$ \u7684\u533a\u95f4 $[l',r']$ \u4e00\u5b9a\u4ee3\u8868\u4e00\u68f5\u5b50\u6811\uff0c\u53ef\u4ee5\u9012\u5f52\u5904\u7406 $(l',r')$\uff0c\u7136\u540e\u5c06 $[l',r']$ \u7f29\u6210\u4e00\u4e2a\u70b9 $a_{l'}$\u3002\n\n- \u5bf9\u4e8e\u6bcf\u4e2a $i$ \u9884\u5904\u7406\u4e0b\u4e00\u4e2a\u548c\u5b83\u6743\u503c\u76f8\u540c\u7684\u4f4d\u7f6e\uff0c\u5c31\u53ef\u4ee5\u5728\u7f29\u70b9\u65f6\u987a\u4fbf\u5224\u65ad\u4e00\u4e0b\u6761\u4ef6 $4$\u3002\n\n- \u73b0\u5728 $[l,r]$ \u4e2d\u5c31\u4e0d\u5b58\u5728\u6743\u503c\u76f8\u540c\u7684\u70b9\uff0c\u5982\u679c\u533a\u95f4\u4e2d\u51fa\u73b0\u4e86\u5c11\u4e8e $\\frac{r - l}{2} + 1$ \u79cd\u6743\u503c\uff0c\u5c31\u5c06\u8fd8\u672a\u51fa\u73b0\u7684\u6743\u503c\u586b\u5728\u533a\u95f4\u7684\u6700\u524d\u9762\uff08\u82e5\u6743\u503c\u79cd\u7c7b\u6570\u5df2\u7ecf\u8d85\u8fc7 $\\frac{r - l}{2} + 1$ \u5219\u65e0\u89e3\uff09\uff0c \u4e4b\u540e\u4ece\u5de6\u5f80\u53f3\u8003\u8651 $[l,r]$ \u4e2d\u6bcf\u4e2a\u957f\u5ea6\u4e3a $3$ \u7684\u533a\u95f4\uff0c\u82e5\u5b58\u5728\u4e00\u4e2a\u957f\u5ea6\u4e3a $3$ \u7684\u533a\u95f4\u4e3a `xy0` \u6216 `0yx` \u7684\u5f62\u5f0f\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u5176\u8865\u6210 `xyx`\uff0c\u7136\u540e\u518d\u7f29\u6210\u4e00\u4e2a\u70b9 `x`\u3002\n\n- \u5c06\u6240\u6709\u80fd\u591f\u7f29\u7684\u533a\u95f4\u7f29\u5b8c\u4e4b\u540e\u53ef\u80fd\u8fd8\u4f1a\u6709\u4f4d\u7f6e\u4e3a $0$\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5269\u4e0b\u7684\u4f4d\u7f6e\u90fd\u586b\u6210\u8fd9\u68f5\u5b50\u6811\u7684\u6839\u3002\n\n- \u8003\u8651\u8fd9\u6837\u505a\u7684\u6b63\u786e\u6027\uff1a\n\n  1. \u82e5\u4e0d\u5b58\u5728\u4e24\u4e2a\u4e0d\u4e3a $0$ \u7684\u4f4d\u7f6e\u76f8\u90bb\uff0c\u533a\u95f4\u7684\u9996\u5c3e\u4e00\u5b9a\u5df2\u7ecf\u586b\u5165\u6570\u5b57\u4e14\u76f8\u90bb\u7684\u4e24\u4e2a\u5df2\u7ecf\u586b\u5165\u6570\u5b57\u7684\u4f4d\u7f6e\u4e2d\u6070\u597d\u9694\u7740\u4e00\u4e2a $0$\uff0c\u6b64\u65f6\u5c06\u5269\u4e0b\u7684\u4f4d\u7f6e\u586b\u6210\u8fd9\u68f5\u5b50\u6811\u7684\u6839\u663e\u7136\u6b63\u786e\uff1b\n  2. \u82e5\u5b58\u5728\u4e24\u4e2a\u4e0d\u4e3a $0$ \u7684\u4f4d\u7f6e\u76f8\u90bb\uff0c\u7f29\u70b9\u4e4b\u540e\u4e0d\u4e3a $0$ \u7684\u4f4d\u7f6e\u51cf\u5c11\u4e86 $1$\uff0c\u4e3a $0$ \u7684\u4f4d\u7f6e\u4e5f\u51cf\u5c11\u4e86 $1$\uff0c\u4e24\u8005\u7684\u5dee\u4e0d\u53d8\uff0c\u56e0\u6b64\u53ef\u4ee5\u770b\u505a\u662f\u9012\u5f52\u4e0b\u53bb\uff0c\u76f4\u5230\u51fa\u73b0\u7b2c $1$ \u79cd\u60c5\u51b5\u3002\n\n- \u7279\u522b\u5730\uff0c\u5bf9\u4e8e $[1, 2n - 1]$ \u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u9996\u5c3e\u76f8\u540c\uff0c\u8fdb\u884c\u4e00\u4e9b\u7b80\u5355\u7684\u8ba8\u8bba\uff1a\n\n  1. \u82e5 $a_1, a_{2n - 1} > 0$ \u4e14 $a_1 \\neq a_{2n - 1}$\uff0c\u65e0\u89e3\uff1b\n  2. \u82e5 $a_1, a_{2n - 1} > 0$ \u4e14 $a_1 = a_{2n - 1}$\uff0c\u9012\u5f52\u533a\u95f4 $(1, 2n - 1)$\uff1b\n  3. \u82e5 $a_1 > 0$ \u6216 $a_{2n - 1} > 0$\uff0c\u5c06\u4e24\u4e2a\u6570\u586b\u6210\u76f8\u540c\u7684\uff0c\u9012\u5f52\u533a\u95f4 $(1, 2n - 1)$\uff1b \n  4. \u82e5 $a_1 = a_{2n - 1} = 0$\uff0c\u76f4\u63a5\u6309\u4e4b\u524d\u7b97\u6cd5\u5904\u7406\u5373\u53ef\uff0c\u4ece\u5de6\u5230\u53f3\u5408\u5e76\u80fd\u4fdd\u8bc1\u6700\u540e\u9996\u5c3e\u76f8\u540c\u4e14\u6ca1\u6709\u5269\u4f59\u4f4d\u7f6e\u4e3a $0$\u3002\n\n- \u53ef\u4ee5\u7528\u94fe\u8868\u5b9e\u73b0\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n)$\u3002\n\n## Code\n\n```cpp\n#include <bits/stdc++.h>\n\ntemplate <class T>\ninline void read(T &res)\n{\n\tchar ch;\n\twhile (ch = getchar(), !isdigit(ch));\n\tres = ch ^ 48;\n\twhile (ch = getchar(), isdigit(ch))\n\t\tres = res * 10 + ch - 48;\n}\n\ntemplate <class T>\ninline void put(T x)\n{\n\tif (x > 9)\n\t\tput(x / 10);\n\tputchar(x % 10 + 48);\n}\n\nconst int N = 1e6 + 5;\nint a[N], vis[N], nxt[N], pre[N], suf[N];\nint n, m, now = 1;\n\ninline void Fail()\n{\n\tputs(\"no\");\t\n\texit(0);\n}\n\ninline int Get()\n{\n\twhile (vis[now])\n\t\t++now;\n\tif (now > n)\n\t\tFail();\n\tvis[now] = 1;\n\treturn now;\n}\n\ninline void Delete(int l, int r)\n{\n\tint tl = pre[l], tr = suf[r];\n\tsuf[tl] = tr, pre[tr] = tl;\n}\n\ninline void Merge(int l, int r, int &x)\n{\n\twhile (x > l && suf[suf[x]] && suf[suf[x]] <= r && !a[x] && a[suf[x]] && a[suf[suf[x]]])\n\t{\n\t\ta[x] = a[suf[suf[x]]];\n\t\tDelete(suf[x], suf[suf[x]]);\n\t\tx = pre[pre[x]];\n\t}\n\twhile (x > l && suf[suf[x]] && suf[suf[x]] <= r && a[x] && a[suf[x]] && !a[suf[suf[x]]])\n\t{\n\t\ta[suf[suf[x]]] = a[x];\n\t\tDelete(suf[x], suf[suf[x]]);\n\t\tx = pre[pre[x]];\n\t}\n}\n\ninline void solve(int l, int r)\n{\n\tif (r - l & 1)\n\t\tFail();\n\tfor (int i = l; i <= r; i = suf[i])\n\t\twhile (nxt[i])\n\t\t{\n\t\t\tif (nxt[i] > r)\n\t\t\t\tFail();\n\t\t\tsolve(suf[i], pre[nxt[i]]);\n\t\t\tDelete(suf[i], nxt[i]);\n\t\t\tnxt[i] = nxt[nxt[i]];\n\t\t}\n\tint num1 = 0, num2 = 0, rt = a[pre[l]];\n\tfor (int i = l; i <= r; i = suf[i])\n\t\tnum1 += a[i] > 0, ++num2;\n\tnum2 = (num2 >> 1) + 1;\n\tif (num1 > num2)\n\t\tFail();\n\tnum2 -= num1; \n\tfor (int i = l; num2 && i <= r; i = suf[i])\n\t\tif (!a[i])\n\t\t\ta[i] = Get(), --num2;\t\n\tfor (int i = l; i <= r; i = suf[i])\n\t\tMerge(l - 1, r, i);\n\tfor (int i = l; i <= r; i = suf[i])\n\t\tif (!a[i])\n\t\t\ta[i] = rt;\n\t\n}\n\nint main()\n{\n\tread(n); \n\tif (n == 1)\n\t\treturn puts(\"yes\\n1\"), 0;\n\tm = (n << 1) - 1;\n\tfor (int i = 1; i <= m; ++i)\n\t\tread(a[i]);\n\tfor (int i = 2; i <= m; ++i)\n\t\tif (a[i] && a[i - 1] && a[i] == a[i - 1])\n\t\t\tFail();\n\tif (a[1] && a[m] && a[1] != a[m])\n\t\tFail();\n\ta[1] = a[m] = a[1] | a[m];\n\tfor (int i = 0; i <= m + 1; ++i)\n\t\tpre[i] = i - 1, suf[i] = i + 1;\n\tpre[0] = 0;\n\tfor (int i = m; i >= 1; --i)\n\t\tif (a[i])\n\t\t{\n\t\t\tnxt[i] = vis[a[i]];\n\t\t\tvis[a[i]] = i;\n\t\t}\n\tsolve(1, m);\n\tputs(\"yes\");\n\tfor (int i = 1; i <= m; ++i)\n\t\tput(a[i]), putchar(' ');\n\treturn 0;\n}\n\n```",
        "postTime": 1588405164,
        "uid": 17952,
        "name": "Log_x",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF1053E \u3010Euler tour\u3011"
    },
    {
        "content": "## \u9898\u610f  \n\n\u7ed9\u4f60\u4e00\u6761\u6811\u4e0a\u6b27\u62c9\u56de\u8def\u7684\u4e00\u90e8\u5206\uff0c\u4f60\u9700\u8981\u5c06\u4ed6\u8fd8\u539f\uff0c\u6216\u8005\u8bf4\u660e\u4e0d\u5b58\u5728\u8fd9\u6837\u7684\u6b27\u62c9\u56de\u8def\u3002  \n\n## \u9898\u89e3  \n\n\u5b8c\u5168\u4e0d\u4f1a\uff0c\u53ea\u80fd\u770b\u9898\u89e3\u3002\n\n\u9996\u5148\u8003\u8651\u4e00\u4e2a\u6811\u4e0a\u6b27\u62c9\u56de\u8def\u9700\u8981\u6ee1\u8db3\u7684\u6027\u8d28\u3002  \n\n- $a_1 = a_{2n-1}$\u3002  \n- $\\not \\exists \\ i_1<i_2<i_3<i_4,s.t.\\ a_{i_1}=a_{i_3} \\not = a_{i_2}=a_{i_4}$\u3002  \n- \u6240\u6709\u76f8\u540c\u7684\u6570\u51fa\u73b0\u4f4d\u7f6e\u7684\u5947\u5076\u6027\u76f8\u540c\u3002  \n- \u5728\u8ddd\u79bb\u4e3a $2k$ \u7684\u4e24\u4e2a\u76f8\u540c\u5143\u7d20\u5185\u6070\u597d\u6709 $k$ \u79cd\u4e0d\u540c\u5143\u7d20\u3002  \n\n\u5982\u679c\u5c06\u8fd9\u4e9b\u6027\u8d28\u5168\u90e8\u6ee1\u8db3\uff0c\u90a3\u4e48\u4e00\u5b9a\u662f\u4e00\u6761\u6811\u4e0a\u6b27\u62c9\u56de\u8def\u3002\u8bc1\u660e\u65b9\u5f0f\u5c31\u7528\u7c7b\u4f3c\u4e0b\u9762\u6784\u9020\u7684\u7f29\u70b9\u65b9\u5f0f\uff0c\u6700\u540e\u7f29\u6210\u4e00\u4e2a\u70b9\u4e86\uff0c\u8bf4\u660e\u662f\u4e00\u6761\u6811\u4e0a\u6b27\u62c9\u56de\u8def\u3002\n\n-------------\n\n\u73b0\u5728\u6211\u4eec\u5bf9 $a_l = a_r$ \u7684\u533a\u95f4 $[l,r]$ \u8fdb\u884c\u9012\u5f52\u6784\u9020\u3002\u7136\u540e $[l,r]$ \u5c31\u53ef\u4ee5\u7f29\u6210\u4e00\u4e2a\u70b9\u6765\u770b\u5f85\u4e86\u3002  \n\n\u5bf9\u4e8e\u6bcf\u4e2a $i$ \u9884\u5904\u7406\u4e0b\u4e00\u4e2a\u548c\u5b83\u6743\u503c\u76f8\u540c\u7684\u4f4d\u7f6e\uff0c\u5c31\u53ef\u4ee5\u5728\u7f29\u70b9\u65f6\u987a\u4fbf\u5224\u65ad\u4e00\u4e0b\u6761\u4ef6 $2$\u3002  \n\n\u73b0\u5728 $[l,r]$ \u4e2d\u5c31\u4e0d\u5b58\u5728\u6743\u503c\u76f8\u540c\u7684\u70b9\uff08\u5982\u679c\u6709\u5c31\u88ab\u7f29\u6389\u4e86\uff09\u3002\u8bbe\u533a\u95f4\u4e2d\u5df2\u7ecf\u51fa\u73b0\u4e86 $k$ \u79cd\u6743\u503c\u3002  \n- \u5982\u679c $k<\\dfrac{r-l}{2}+1$ \u5c31\u5c06\u8fd8\u672a\u51fa\u73b0\u7684\u6743\u503c\u586b\u5728\u533a\u95f4\u7684\u6700\u524d\u9762\u3002  \n- \u5982\u679c $k>\\dfrac{r-l}{2}+1$ \u5219\u65e0\u89e3\u3002  \n\n---------\n\n\u7136\u540e\u518d\u8003\u8651\u6bcf\u4e00\u4e2a\u957f\u5ea6\u4e3a $3$ \u7684\u533a\u95f4\uff0c\u5982\u679c\u662f `ab0` \u6216\u8005 `0ba` \u7684\u5f62\u5f0f\uff0c\u5c31\u628a\u5b83\u53d8\u6210 `aba` \u7136\u540e\u518d\u53d8\u6210\u4e00\u4e2a\u70b9\uff0c\u7136\u540e\u8fd9\u4e48\u4e0d\u505c\u5730\u7f29\u4e0b\u53bb\uff0c\u7f29\u70b9\u7684\u8fc7\u7a0b\u53ef\u4ee5\u7528\u53cc\u5411\u94fe\u8868\u6765\u7ef4\u62a4\u3002\n\n\u6700\u540e\u5c06\u5269\u4e0b\u7684 $0$ \u5168\u90e8\u8865\u6210\u5b50\u6811\u7684\u6839\u3002  \n\n\u8003\u8651\u8fd9\u6837\u505a\u7684\u6b63\u786e\u6027\uff1a\n\n-  \u82e5\u4e0d\u5b58\u5728\u4e24\u4e2a\u4e0d\u4e3a $0$ \u7684\u4f4d\u7f6e\u76f8\u90bb\uff0c\u8003\u8651 $0$ \u7684\u4e2a\u6570\u4e0d\u8d85\u8fc7\u4e00\u534a\uff0c\u533a\u95f4\u7684\u9996\u5c3e\u4e00\u5b9a\u5df2\u7ecf\u586b\u5165\u6570\u5b57\uff0c\u4e14\u76f8\u90bb\u7684\u4e24\u4e2a\u5df2\u7ecf\u586b\u5165\u6570\u5b57\u7684\u4f4d\u7f6e\u4e2d\u6070\u597d\u9694\u7740\u4e00\u4e2a $0$\uff0c\u6b64\u65f6\u76f8\u5f53\u4e8e\u8fd9\u4e9b\u6570\u662f\u6839\u513f\u5b50\uff0c\u53ef\u4ee5\u586b\u5165 root \u663e\u7136\u6ca1\u95ee\u9898\u3002  \n- \u82e5\u5b58\u5728\u4e24\u4e2a\u4e0d\u4e3a $0$ \u7684\u4f4d\u7f6e\u76f8\u90bb\uff0c\u8fdb\u884c\u4e00\u6b21\u7f29\u70b9\u4e4b\u540e\u4e0d\u4e3a $0$ \u7684\u4f4d\u7f6e\u548c\u4e3a $0$ \u7684\u4f4d\u7f6e\u90fd\u5c11\u4e86 $1$\uff0c\u6700\u7ec8\u4e00\u5b9a\u4f1a\u89c4\u7ea6\u5230\u7b2c\u4e00\u79cd\u60c5\u51b5\u3002\n\n\n## \u4ee3\u7801  \n\n```cpp\nint n,m,p=1;\nint a[N],pre[N],suf[N],vis[N],nxt[N];\nvoid del(int l,int r){suf[pre[l]]=suf[r];pre[suf[r]]=pre[l];}//\u53cc\u5411\u94fe\u8868\u5220\u70b9\nint get(){while (vis[p]) p++;if (p>n) {puts(\"no\");exit(0);}vis[p]=-1;return p;}\n//get \u51fd\u6570\u7528\u6765\u627e\u5230\u4e0b\u4e00\u4e2a\u6ca1\u6709\u51fa\u73b0\u8fc7\u7684\u6570\nvoid solve(int l,int r)\n{\n    if ((r-l)&1) {puts(\"no\");exit(0);}\n    for (int i=l;i<=r;i=suf[i]) while (nxt[i])\n    {\n        if (nxt[i]>r) {puts(\"no\");exit(0);}//\u9700\u8981\u6ee1\u8db3\u6761\u4ef6 2\n        solve(suf[i],pre[nxt[i]]);//\u9012\u5f52\u5904\u7406\n        del(suf[i],nxt[i]);\n        nxt[i]=nxt[nxt[i]];//\u7f29\u70b9\n    }\n    int sum=0,cnt=0,rt=a[pre[l]];\n    for (int i=l;i<=r;i=suf[i]) sum++,cnt+=a[i]>0;\n    sum=(sum+1)/2;\n    if (cnt>sum) {puts(\"no\");exit(0);};//2k \u957f\u5ea6\u7684\u533a\u95f4\u5185\u51fa\u73b0\u7684\u4e0d\u540c\u7684\u6570\u4e0d\u80fd\u8d85\u8fc7 k\n    for (int i=suf[l];i<=r;i=suf[i]) if (!a[i] && cnt<sum) a[i]=get(),cnt++;//\u5982\u679c\u4e0d\u8db3 k \u5c31\u7528\u672a\u51fa\u73b0\u8fc7\u7684\u6570\u5c06 0 \u8865\u5145\u4e00\u4e9b\n    if (sum==1 && cnt==0) a[l]=get();\n    for (int i=l;suf[i]<=r;i=suf[i])\n    {\n        while (i>l && suf[i]<=r && a[pre[i]]==0 && a[i]!=0 && a[suf[i]]!=0) a[pre[i]]=a[suf[i]],del(i,suf[i]),i=pre[pre[i]];\n        while (i>=l && suf[suf[i]]<=r && a[i]!=0 && a[suf[i]]!=0 && a[suf[suf[i]]]==0) a[suf[suf[i]]]=a[i],del(suf[i],suf[suf[i]]),i=pre[i];\n        //\u7f29\u70b9\u8fc7\u7a0b\n    }\n    for (int i=l;i<=r;i=suf[i]) if (!a[i]) a[i]=rt;//\u586b\u6210\u5b50\u6811\u7684 root\n}\nsigned main()\n{\n    rd(n);m=2*n-1;for (int i=1;i<=m;i++) rd(a[i]);\n    if (a[1]!=0 && a[m]!=0 && a[1]!=a[m]) {puts(\"no\");exit(0);}\n    a[1]=a[m]=a[1]|a[m];\n    for (int i=0;i<=m;i++) pre[i]=i-1,suf[i]=i+1;\n    for (int i=m;i;i--) if (a[i]) nxt[i]=vis[a[i]],vis[a[i]]=i;\n    solve(1,m);puts(\"yes\");for (int i=1;i<=m;i++) cout<<a[i]<<\" \";cout<<endl;\n}\n```",
        "postTime": 1630821583,
        "uid": 70132,
        "name": "AsunderSquall",
        "ccfLevel": 7,
        "title": "CF1053E"
    }
]
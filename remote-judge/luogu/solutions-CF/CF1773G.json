[
    {
        "content": "\u968f\u7740\u6e38\u620f\u8fdb\u884c\uff0c\u7559\u5728\u573a\u4e0a\u7684\u4eba\u4f1a\u8d8a\u6765\u8d8a\u5c11\uff0c\u8fd9\u63d0\u4f9b\u4e86\u81ea\u7136\u7684 DP \u8f6c\u79fb\u65b9\u5411\uff1a**\u679a\u4e3e\u5b50\u96c6**\u3002\n\n\u8bbe $f_S$ \u8868\u793a\u4efb\u610f\u65f6\u523b\u6070\u6709\u96c6\u5408 $S$ \u7684\u4eba\u7559\u5728\u573a\u4e0a\u7684\u6982\u7387\u3002\u5bf9\u4e8e\u6bcf\u9053\u9898\u76ee $s_i$\uff0c\u5047\u8bbe\u5b83\u53ef\u4ee5\u7b2c\u4e8c\u6b21\u88ab\u62bd\u5230\uff0c\u6211\u4eec\u53d1\u73b0\u5b83\u4e0d\u4ea7\u751f\u4efb\u4f55\u5f71\u54cd\u3002\u56e0\u6b64\uff0c\u8f6c\u79fb\u65f6\uff0c\u6c42\u51fa $c$ \u8868\u793a\u4f7f\u5f97 $S$ \u6539\u53d8\u7684\u9898\u76ee\u6570\u91cf\uff0c\u5373\u6240\u6709\u4f7f\u5f97 $s_i\\cap S\\neq \\varnothing, S$ \u7684 $s_i$\uff0c\u5219\u8fd9\u4e9b\u9898\u76ee\u5728\u53d8\u6210 $S$ \u4e4b\u524d\u4e00\u5b9a\u6ca1\u6709\u88ab\u62bd\u5230\u8fc7\uff0c\u5426\u5219\u5269\u4e0b\u7684\u4eba\u5c31\u4e0d\u662f $S$ \u4e86\u3002\n\n\u82e5 $c = 0$\uff0c\u5219 $f_S$ \u8868\u793a\u6700\u7ec8\u7ed3\u679c\u6709 $f_S$ \u7684\u6982\u7387\u662f $S$\u3002\u5426\u5219 $S$ \u4e00\u5b9a\u4f1a\u53d8\u5f97\u66f4\u5c0f\uff1a\u679a\u4e3e\u7b2c\u4e00\u4e2a\u4f7f\u5f97 $S$ \u51cf\u5c0f\u7684 $s_j$\uff0c\u56e0\u4e3a\u5b83\u5728\u6240\u6709 $s_i$ \u4e2d\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u6982\u7387\u4e3a $\\frac 1 c$\uff0c\u6240\u4ee5 $\\frac {f_S} {c}\\to f_{S\\cap S_i}$\u3002\n\n\u6ce8\u610f $s_j$ \u662f\u6ca1\u6709 $S$ \u7684\u5b50\u96c6\u9650\u5236\u7684\uff0c\u6240\u4ee5\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\mathcal{O}(4 ^ n)$\uff0c\u65e0\u6cd5\u63a5\u53d7\u3002\n\n\u8bbe $g_{S, T}$ \u8868\u793a\u4f7f\u5f97 $s_i\\cap S = T$ \u7684 $s_i$ \u7684\u6570\u91cf\uff0c\u5219\u6709\u8f6c\u79fb $g_{S, T} = g_{S \\cup \\{p\\}, T} + g_{S\\cup \\{p\\}, T\\cup \\{p\\}}$\uff0c\u5176\u4e2d $p$ \u662f\u4efb\u610f\u4e0d\u5728 $S$ \u4e2d\u7684\u5143\u7d20\u3002\u5728 $\\mathcal{O}(3 ^ n)$ \u7684\u65f6\u95f4\u5185\u6c42\u51fa\u6240\u6709 $g_{S, T}$\u3002\n\n\u6613\u77e5 $c = \\sum_{T\\neq \\varnothing, S} g_{S, T}$\uff0c\u8f6c\u79fb\u65f6\u76f4\u63a5\u679a\u4e3e $T\\neq \\varnothing, S$\uff0c\u5219 $\\frac {f_S g_{S, T}} {c}\\to f_T$\u3002\n\n\u7efc\u4e0a\uff0c\u65f6\u7a7a\u590d\u6742\u5ea6\u5747\u4e3a $\\mathcal{O}(3 ^ n)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n\nconstexpr int N = 1 << 17;\nint n, m, c[N], p[17], lab[N], K[N];\ndouble f[N], ans;\nvector<int> s[N];\n\nint main() {\n  ios::sync_with_stdio(0), cin.tie(0), cout.tie(0);\n  #ifdef ALEX_WEI\n    FILE* IN = freopen(\"1.in\", \"r\", stdin);\n    FILE* OUT = freopen(\"1.out\", \"w\", stdout);\n  #endif\n  cin >> n >> m;\n  for(int i = 1; i <= n; i++) {\n    int S = 0;\n    for(int j = 0; j < m; j++) {\n      char s;\n      cin >> s;\n      if(s == '1') S |= 1 << j;\n    }\n    c[S]++;\n  }\n\n  f[(1 << m) - 1] = 1;\n  for(int i = (1 << m) - 1; i; i--) {\n    if(i & 1 ^ 1) continue;\n\n    int ppc = 0;\n    for(int j = 0; j < m; j++) if(i >> j & 1) p[j] = ppc++;\n    s[i].resize(1 << ppc), lab[0] = 0;\n    for(int _ = (i - 1) & i; ; _ = (_ - 1) & i) {\n      int S = i ^ _, low = 31 - __builtin_clz(S & -S);\n      lab[S] = lab[S ^ (1 << low)] | (1 << p[low]);\n      K[lab[S]] = S;\n      if(!_) break;\n    }\n\n    int low = 31 - __builtin_clz((~i) & -(~i));\n    int _i = i ^ (1 << low);\n    for(int j = 0; j < 1 << ppc; j++) {\n      if(i + 1 == (1 << m)) {\n        s[i][j] = c[j];\n        continue;\n      }\n      int T = (j & ((1 << low) - 1)) | ((j >> low) << low + 1);\n      s[i][j] = s[_i][T] + s[_i][T | (1 << low)];\n    }\n\n    int sum = 0;\n    for(int j = 1; j + 1 < 1 << ppc; j++) sum += s[i][j];\n    if(!sum) ans += f[i];\n    else {\n      double pro = f[i] / sum;\n      for(int j = 1; j + 1 < 1 << ppc; j++) f[K[j]] += s[i][j] * pro;\n    }\n  }\n  printf(\"%.12lf\\n\", ans);\n  return 0;\n}\n/*\ng++ G.cpp -o G -std=c++14 -O2 -DALEX_WEI\n*/\n```",
        "postTime": 1670924362,
        "uid": 123294,
        "name": "Alex_Wei",
        "ccfLevel": 10,
        "title": "CF1773G Game of Questions"
    }
]
[
    {
        "content": "\u5728\u6211\u7684\u535a\u5ba2\u56ed\u770b\u6548\u679c\u66f4\u4f73\uff1a[\u70b9\u8fd9\u91cc](https://www.cnblogs.com/1000Suns/p/11422919.html)\n\n\u8bf4\u8d77\u6765\uff0c\u8fd9\u9898\u597d\u50cf\u4e5f\u4e0d\u96be\u2026\u2026\n\n\u5148\u8003\u8651 F1 \u600e\u4e48\u505a\u3002\n\n~~\u65e2\u7136\u522b\u7684\u65b9\u6cd5\u90fd\u4e0d\u884c\u4e0d\u5982\u8bd5\u8bd5~~$f_{i,j}$  \u8868\u793a\u5728\u521a\u521a\u51c6\u5907\u5f00\u59cb\u6d82 $[i,j]$ \u4e2d\u6700\u5c0f\u7f16\u53f7\u7684\u989c\u8272\u4e4b\u524d\uff0c\u6574\u4e2a\u533a\u95f4\u662f\u540c\u8272\u7684\uff0c\u4e14\u6700\u540e\u80fd\u505a\u5230 $[i,j]$ \u53d8\u6210\u8981\u6c42\u7684\u989c\u8272\uff0c\u4e14\u6240\u6709\u8fde\u7eed\u989c\u8272\u6bb5\u8981\u4e48\u5b8c\u5168\u5728 $[i,j]$ \u5185\uff0c\u8981\u4e48\u5b8c\u5168\u5728 $[i,j]$ \u5916\u7684\u65b9\u6848\u6570\u3002\uff08\u6709\u70b9\u7ed5\uff0c\u597d\u597d\u7406\u89e3\u4e00\u4e0b\uff09\n\n\u90a3\u4e48\u5148\u627e\u5230\u533a\u95f4 $[i,j]$ \u4e2d\u7684\u6700\u5c0f\u503c $c$\uff0c\u4e0b\u4e00\u6b65\u67d3\u8272\u7684\u533a\u95f4 $[l,r]$ \u4e00\u5b9a\u8981\u6ee1\u8db3 $i\\le l\\le r\\le j$ \u4e14\u5305\u62ec $p_c$\uff0c\u5176\u4e2d $p_c$ \u662f $c$ \u51fa\u73b0\u7684\u4f4d\u7f6e\u3002\n\n\u7531\u4e8e\u67d3\u8272\u540e\uff0c$[l,r]$ \u5185\u540c\u8272\u4e14\u4e0e\u4e0d\u5728 $[l,r]$ \u5185\u7684\u5f02\u8272\uff0c\u90a3\u4e48\u6574\u4e2a\u5e26\u5b50\u53d8\u6210\u4e86\u56db\u5757\u3002\uff08\u56fe\u7247\u6765\u6e90\uff1a\u5b98\u65b9\u9898\u89e3\uff09\n\n![](https://codeforc.es/predownloaded/a7/a5/a7a5c89d580aa0dee52d4edffc9d316209f7d736.png)\n\n\u8fd9\u662f\u56e0\u4e3a\uff0c$p_c$ \u6c38\u8fdc\u4e0d\u80fd\u88ab\u91cd\u65b0\u67d3\u8272\uff0c\u5c31\u628a\u4e24\u8fb9\u5206\u5f00\u4e86\uff1b$[l,r]$ \u5185\u548c $[l,r]$ \u5916\u7684\u5df2\u7ecf\u4e0d\u540c\u8272\uff0c\u540e\u9762\u4e5f\u4e0d\u53ef\u80fd\u53d8\u5f97\u540c\u8272\u3002\n\n\u90a3\u4e48\u8fd9\u56db\u90e8\u5206\u53ef\u4ee5\u5355\u72ec\u5904\u7406\u3002\n\n\u5c31\u6709\u8f6c\u79fb\u65b9\u7a0b\uff1a$f_{i,j}=\\sum\\limits_{l=i}^{p_c}\\sum\\limits_{r=p_c}^jf[i][l-1]f[l][p_c-1]f[p_c+1][r]f[r+1][j]$\u3002\u8fd9\u91cc\u7531\u4e8e\u4e00\u4e9b\u8fb9\u754c\u539f\u56e0\uff0c\u4e0d\u59a8\u8bbe $f_{i+1,i}=1$\u3002\n\n\u8fd9\u662f\u4e00\u4e2a $O(n^4)$ \u505a\u6cd5\uff08\u5728 F1 \u4e2d $n=m$\uff09\u3002\u4f18\u5316\u7684\u8bdd\uff0c\u53d1\u73b0 $l$ \u548c $r$ \u5728\u8f6c\u79fb\u4e2d\u72ec\u7acb\u3002\u53ef\u4ee5\u91cd\u5199\uff1a$f_{i,j}=(\\sum\\limits_{l=i}^{p_c}f[i][l-1]f[l][p_c-1])(\\sum\\limits_{r=p_c}^jf[p_c+1][r]f[r+1][j])$\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3)$\u3002\u8fd8\u6709\u4e2a\u5927\u6982 $\\frac{1}{6}$ \u7684\u5e38\u6570\u3002\n\n\u63a5\u4e0b\u6765\u770b\u770b F2\u3002\n\n\u9996\u5148\u8fd9\u4e2a $m$ \u592a\u5927\u4e86\uff0c\u65e0\u8bba\u5982\u4f55\u90fd\u4e0d\u80fd\u76f4\u63a5\u533a\u95f4 DP\u3002\n\n\u627e\u627e\u6027\u8d28\uff1a\n\n**\u6027\u8d28 1\uff1a**\u5982\u679c\u4e24\u4e2a\u65b9\u683c\u67d0\u4e2a\u65f6\u523b\u5f00\u59cb\u4e0d\u540c\u8272\uff0c\u90a3\u4e48\u5b83\u4eec\u4f1a\u4e00\u76f4\u4e0d\u540c\u8272\u3002\u53cd\u8fc7\u6765\uff0c\u5982\u679c\u4e24\u4e2a\u65b9\u683c\u6700\u540e\u540c\u8272\uff0c\u90a3\u4e48\u5b83\u4eec\u59cb\u7ec8\u540c\u8272\u3002\n\n\u6240\u4ee5\uff0c\u4e0d\u59a8\u628a\u8fde\u7eed\u4e00\u6bb5\u76f8\u7b49\u7684\u538b\u6210\u4e00\u4e2a\uff0c\u4e0d\u5f71\u54cd\u7b54\u6848\u3002\n\n**\u6027\u8d28 2\uff1a**\u628a $c_i\\ne c_{i+1}$ \u7684 $i$ \u53eb\u505a\u8f6c\u6298\u70b9\u3002\u90a3\u4e48\u4e00\u6b21\u67d3\u8272\u6700\u591a\u589e\u52a0\u4e24\u4e2a\u8f6c\u6298\u70b9\u3002\n\n\u6240\u4ee5\uff0c\u538b\u7f29\u540e\u5982\u679c $m>2n$\uff0c\u8fd9\u4e00\u5b9a\u662f\u4e0d\u53ef\u80fd\u505a\u5230\u7684\uff0c\u76f4\u63a5\u8f93\u51fa $0$\u3002\n\n\u90a3\u4e48\u63a5\u4e0b\u6765 $m\\le 2n$\uff0c\u57fa\u672c\u4e0a\u53ef\u4ee5\u6309\u4e0a\u9762\u7684\u65b9\u6cd5\u6765\u505a\u3002\u4e0d\u8fc7\u8981\u7a0d\u5fae\u4fee\u6539\u4e00\u4e0b\u3002\n\n\u6bd4\u5982\u8003\u8651\u5e8f\u5217 2,1,2\uff0c\u7b54\u6848\u660e\u663e\u662f $0$\u3002\u4f46\u662f\u6211\u4eec\u4e0a\u9762\u7684\u505a\u6cd5\u4f1a\u7528 1 \u628a\u4e24\u8fb9\u5206\u5f00\u5355\u72ec\u8003\u8651\u3002\n\n\u4e3a\u4ec0\u4e48\u4f1a\u9519\u5462\uff1f\u56e0\u4e3a\u6b64\u65f6\u4e24\u8fb9\u4e0d\u72ec\u7acb\u3002\n\n\u5176\u5b9e\u89e3\u51b3\u65b9\u6cd5\u4e5f\u5f88\u7b80\u5355\uff0c\u6bcf\u6b21\u5224\u4e00\u4e0b\u662f\u4e0d\u662f\u5e8f\u5217\u4e2d\u6240\u6709 $c$ \u90fd\u5728\u8fd9\u4e2a\u533a\u95f4\u4e2d\u3002\u5982\u679c\u4e0d\u662f\u7684\u8bdd\uff0c\u7ed9\u8fd9\u4e2a\u533a\u95f4\u67d3\u8272\u540e\u4e0d\u53ef\u80fd\u505a\u5230\u91cc\u9762\u662f $c$\uff0c\u5916\u9762\u4e5f\u662f $c$\u3002\n\n\u540c\u65f6\uff0c\u6b64\u65f6\u8fd9\u4e2a\u533a\u95f4\u4e5f\u5206\u6210\u4e86\u4e0d\u6b62\u56db\u6bb5\u3002\u4e0d\u8fc7\u95ee\u9898\u4e0d\u5927\uff0c\u524d\u540e\u56db\u6bb5\u8fd8\u662f\u901a\u8fc7\u4e0a\u9762\u7684\u65b9\u6cd5\u8f6c\u79fb\uff0c\u4e2d\u95f4\u51e0\u6bb5\u662f\u4e00\u5b9a\u53d6\u6ee1\u7684\uff0c\u76f4\u63a5\u4e58\u4e0a\u53bb\u5c31\u597d\u4e86\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^3+m)$\uff0c\u6709\u4e2a\u5927\u6982 $\\frac{4}{3}$ \u7684\u5e38\u6570\u3002\u5728 CF \u795e\u673a+ 6s \u65f6\u9650\u4e0b\u5b8c\u5168\u4e0d\u7528\u6015\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\ntypedef pair<int,int> PII;\nconst int maxn=1111,mod=998244353;\n#define MP make_pair\n#define PB push_back\n#define lson o<<1,l,mid\n#define rson o<<1|1,mid+1,r\n#define FOR(i,a,b) for(int i=(a);i<=(b);i++)\n#define ROF(i,a,b) for(int i=(a);i>=(b);i--)\n#define MEM(x,v) memset(x,v,sizeof(x))\ninline ll read(){\n\tchar ch=getchar();ll x=0,f=0;\n\twhile(ch<'0' || ch>'9') f|=ch=='-',ch=getchar();\n\twhile(ch>='0' && ch<='9') x=x*10+ch-'0',ch=getchar();\n\treturn f?-x:x;\n}\nint n,m,m_,a[1111111],lft[maxn],rig[maxn],f[maxn][maxn];\nint main(){\n\tn=read();m_=read();\n\twhile(m_--){\n\t\tint x=read();\n\t\tif(x!=a[m]) a[++m]=x;\n\t}\n\tif(m>2*n) return puts(\"0\"),0;\n\tMEM(lft,0x3f);\n\tFOR(i,1,m) lft[a[i]]=min(lft[a[i]],i),rig[a[i]]=max(rig[a[i]],i);\n\tFOR(i,1,m) if(lft[a[i]]==i && rig[a[i]]==i) f[i][i]=1;\n\tFOR(i,0,m) f[i+1][i]=1;\n\tFOR(l,2,m) FOR(i,1,m-l+1){\n\t\tint j=i+l-1,mn=i;\n\t\tFOR(k,i+1,j) if(a[k]<a[mn]) mn=k;\n\t\tint x=lft[a[mn]],y=rig[a[mn]],s1=0,s2=0,pre=0;\n\t\tif(x<i || y>j) continue;\n\t\tFOR(k,i,x) s1=(s1+1ll*f[i][k-1]*f[k][x-1])%mod;\n\t\tFOR(k,y,j) s2=(s2+1ll*f[y+1][k]*f[k+1][j])%mod;\n\t\tf[i][j]=1ll*s1*s2%mod;\n\t\tFOR(k,i,j) if(a[k]==a[mn]){\n\t\t\tif(pre) f[i][j]=1ll*f[i][j]*f[pre+1][k-1]%mod;\n\t\t\tpre=k;\n\t\t}\n\t}\n\tprintf(\"%d\\n\",f[1][m]);\n}\n```",
        "postTime": 1566963344,
        "uid": 72118,
        "name": "AThousandSuns",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1178F2 \u3010Long Colorful Strip\u3011"
    }
]
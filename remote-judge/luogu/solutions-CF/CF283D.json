[
    {
        "content": "\u6211\u4eec\u9996\u5148\u8003\u8651\u5bf9\u4e8e $(x,y)$ \u5b83\u4eec\u5408\u6cd5\u7684\u6761\u4ef6\u662f\u4ec0\u4e48\n\n\u8bbe $t$ \u4e3a\u8fde\u7eed\u6570\u7684\u5f00\u5934\uff0c\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5199\u51fa $x=\\frac{y(y-1)}{2}+ty$ \n\n\u79fb\u9879\uff0c\u5f97\u5230 $\\frac{2x-y^2}{y}=2t-1$ \uff0c\u5373\u6211\u4eec\u8981\u6c42 $\\frac{2x}{y}-y$ \u4e3a **\u5947\u6570** \n\n\u8003\u8651\u5c06\u6bcf\u4e2a\u6570\u5185\u7684 2 \u7684\u6b21\u5e42\u5206\u79bb\u51fa\u6765\uff0c\u8bbe $v(x)$ \u8868\u793a $x$ \u4e2d 2\u7684\u6307\u6570\uff0c$p(x)$ \u4e3a $x$ \u4e2d\u6700\u5927\u7684\u5947\u6570\u56e0\u5b50\uff0c\u5373\u6bcf\u4e2a $x$ \u90fd\u53ef\u4ee5\u88ab\u5199\u6210 $2^{v(x)}\\cdot p(x)$ \n\n\u90a3\u4e48\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u539f\u5f0f\u5199\u6210 $2^{v(x)-v(y)+1}\\cdot \\frac{p(x)}{p(y)} -2^{v(y)}\\cdot p(y)$   \uff0c\u4e0d\u96be\u53d1\u73b0\u6211\u4eec\u9996\u5148\u8981\u6ee1\u8db3\u7684\u6761\u4ef6\u5c31\u662f $p(y)|p(x)$  \uff0c\u5269\u4e0b\u7684\u9650\u5236\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n1. $y$ \u4e3a\u5947\u6570\uff0c\u5373 $v(y)=0$ \uff0c\u90a3\u4e48\u6211\u4eec\u8981\u6c42\u524d\u9762\u4e00\u9879\u4e3a\u5076\u6570\uff0c\u6240\u4ee5 $v(x)-v(y)+1\\geq 0$ \uff0c\u5f97\u5230 $v(x)\\geq -1$ \uff0c\u5373 $v(x)$ \u4efb\u53d6\n2. $y$ \u4e3a\u5076\u6570\uff0c\u90a3\u4e48\u8981\u6c42\u524d\u9762\u4e00\u9879\u4e3a\u5947\u6570\uff0c\u6240\u4ee5 $v(x)-v(y)+1=0$ \uff0c\u5f97\u5230 $v(y)=v(x)+1$ \n\n\u7efc\u4e0a\u6240\u8ff0\uff0c $(x,y)$ \u5408\u6cd5\u5f53\u4e14\u4ec5\u5f53 $p(y)|p(x)$ \u5e76\u4e14 $v(y)=0$ \u4e0e $v(y)=v(x)+1$ \u4e2d\u6709\u4e00\u4e2a\u6761\u4ef6\u88ab\u6ee1\u8db3\n\n\u90a3\u4e48\u6211\u4eec\u8bbe $f(i)$ \u8868\u793a\u4ee5 $i$ \u4e3a\u7ed3\u5c3e\u4e14 $[1,i]$ \u4e2d\u7684\u6570\u90fd\u53d8\u597d\u7684\u6700\u5c0f\u4fee\u6539\u6b21\u6570\uff0c\u6bcf\u6b21\u8f6c\u79fb\u679a\u4e3e\u4e00\u4e2a $j$ \uff0c\u6211\u4eec\u5c31\u9700\u8981 $\\text{check}$ \u4e00\u4e0b $[j,i]$ \u4e2d\uff0c\u80fd\u5426\u4e0d\u4fee\u6539 $a_j,a_i$ \u4e14\u4fee\u6539 $[j+1,i-1]$ \u4e2d\u5168\u90e8\u7684\u6570\u5f97\u5230\u5408\u6cd5\u5e8f\u5217\uff0c\u6211\u4eec\u6839\u636e\u524d\u9762\u5f97\u5230\u7684\u6027\u8d28\u53ef\u4ee5\u63a8\u51fa\u8be5\u533a\u95f4\u9996\u5148\u6ee1\u8db3 $p(a_i)|p(a_j)$\uff0c\n\u5176\u6b21\u8fd8\u9700\u8981\u6ee1\u8db3 $v(a_i)\\leq j-i+1$ \u6216 $v(a_i)-v(a_j)=i-j$ \uff0c\u8fd9\u4e2a\u63a8\u5bfc\u5c31\u5f88\u5bb9\u6613\u4e86\u3002\n\n",
        "postTime": 1632312502,
        "uid": 382470,
        "name": "newbiewzs",
        "ccfLevel": 9,
        "title": "CF283D"
    },
    {
        "content": "> [\u9898\u76ee\u94fe\u63a5\uff08\u6d1b\u8c37\uff09](https://www.luogu.com.cn/problem/CF283D) [\u9898\u76ee\u94fe\u63a5\uff08CF\uff09](https://codeforces.com/problemset/problem/283/D)\n>\n> \u7ed9\u4f60\u4e00\u4e2a\u957f\u4e3a $n$ \u7684\u5e8f\u5217 $A$\uff0c\u4f60\u53ef\u4ee5\u4fee\u6539 $A$ \u4e2d\u67d0\u4e9b\u4f4d\u7f6e\u4e0a\u7684\u6570\uff0c\u4f7f\u5f97 $\\forall i \\in [1,n)$\uff0c$A_i$ \u53ef\u4ee5\u88ab\u8868\u793a\u4e3a $A_{i+1}$ \u4e2a\u8fde\u7eed\u7684\u6574\u6570\u7684\u548c\uff08\u53ef\u4ee5\u5305\u62ec\u8d1f\u6570\uff09\uff0c\u6c42\u6700\u5c11\u7684\u4fee\u6539\u6b21\u6570\u3002\n>\n> $n \\le 5000,a_i \\le 10^{15}$\n\n$\\and$ \u662f\u903b\u8f91\u4e0e\uff0c$\\or$ \u662f\u903b\u8f91\u6216\u3002\n\n\u6839\u636e\u5404\u4f4d~~\u5c0f\u5b66\u4e8c\u5e74\u7ea7~~\u5b66\u8fc7\u7684\u77e5\u8bc6\uff0c\u8fde\u7eed\u7684\u6574\u6570\u7684\u548c\u5c31\u7b49\u4e8e\u8fd9\u4e9b\u6570\u7684\u5e73\u5747\u503c\u4e58\u4e0a\u6570\u7684\u603b\u6570\uff0c\u90a3\u4e48\u5bf9\u4e8e $A_i$ \u548c $A_{i+1}$ \u800c\u8a00\uff1a\n\n- \u5982\u679c $A_{i+1}$ \u662f\u5947\u6570\uff0c\u8981\u6ee1\u8db3\u6761\u4ef6\uff0c\u90a3\u4e48 $A_{i+1}|A_i$\u3002\n\n- \u5982\u679c $A_{i+1}$ \u662f\u5076\u6570\uff0c\u90a3\u4e48\u8fd9\u4e9b\u8fde\u7eed\u7684\u6570\u7684\u5e73\u5747\u6570\u5c31\u662f\u4e00\u4e2a\u5c0f\u6570 $x.5$\uff0c\u8fd9\u4e2a\u5c0f\u6570\u4e58\u4e0a $A_{i+1}$ \u662f $A_i$\uff0c\n\n  \u90a3\u4e48 $A_i \\equiv \\frac {A_{i+1}}2 \\pmod {A_{i+1}}$ \uff0c\u4e5f\u5c31\u662f $A_{i+1} \\not |\\ A_i \\and A_{i+1}|2A_i$\u3002\n\n\u6211\u4eec\u8bbe $A_i = c \\cdot2 ^ {k_1},A_{i+1} = d \\cdot 2 ^ {k_2}$\uff0c\uff08\u5176\u4e2d\u7684 $c$ \u548c $d$ \u90fd\u662f\u5947\u6570\uff09\u3002\n\n- \u5982\u679c\u6ee1\u8db3\u7b2c\u4e00\u4e2a\u6761\u4ef6\uff1a$d \\cdot 2 ^ {k2}$ \u662f\u5947\u6570\u4e14 $(d \\cdot 2 ^ {k_2}) | (c \\cdot 2^{k_1})$\uff0c\u53ef\u77e5 $d | c \\and k2 = 0$\u3002\n\n- \u5982\u679c\u6ee1\u8db3\u7b2c\u4e8c\u4e2a\u6761\u4ef6\uff1a\n  $$\n  (d \\cdot 2 ^ {k_2}) \\not |\\ (c \\cdot2 ^ {k_1}),(1)\\\\(d \\cdot 2 ^ {k_2}) | (c \\cdot2 ^ {k_1+1}),(2)\n  $$\n  \u53ef\u77e5 $d | c \\and k2 = k1 + 1$\uff0c\u56e0\u4e3a $k_2$ \u591a\u4e86\u4f1a\u4e0d\u6ee1\u8db3 $(2)$ \u5f0f\uff0c\u5c11\u4e86\u4f1a\u4e0d\u6ee1\u8db3 $(1)$ \u5f0f\u3002\n\n\u6574\u7406\u53ef\u5f97 \uff0c\u5982\u679c $A_i = c \\cdot 2^{k_1}$\uff0c\u90a3\u4e48 $A_{i+1}$ \u53ea\u80fd\u662f $d$ \u6216 $d \\cdot 2^{k_1+1}$\uff08$d$ \u662f $c$ \u7684\u7ea6\u6570\uff0c\u4e0b\u540c\uff09\u3002\n\n\u4e8e\u662f\u6211\u4eec\u53d1\u73b0 $A_{i+1}$ \u6700\u5927\u4e3a $2A_i$\u3002\n\n\u73b0\u5728\u6211\u4eec\u8003\u8651\u5728\u786e\u5b9a $A_i$ \u548c $A_j$ \uff08$j < i$\uff09\u65f6\uff0c\u7ed9 $A_{i+1},A_{i+2},\\cdots,A_{j-1}$ \u8d4b\u503c\uff0c\u80fd\u591f\u6709\u54ea\u4e9b\u5408\u6cd5\u6784\u9020\u3002\n\n\u8bbe $A_i = c \\cdot2 ^ {k_1},A_{i+1} = d \\cdot 2 ^ {k_2}$\u3002\n\n\u9996\u5148\uff0c\u6839\u636e\u6211\u4eec\u521a\u521a\u63a8\u51fa\u7684\u7ed3\u8bba\u53ef\u5f97 $d | c$\u3002\n\n\u8003\u8651\u4ece $A_k$ \u5230 $A_{k+1}$ \uff0c$2$ \u7684\u6307\u6570\u8981\u4e48 $+1$\uff0c\u8981\u4e48\u53d8\u6210 $0$\u3002\n\n\u6240\u4ee5 $A_j$ \u4e2d $2$ \u7684\u6307\u6570 $k_2$\uff0c\u53ea\u80fd\u901a\u8fc7\u6307\u6570\u9010\u6b21 $+1$ \u5f97\u5230\uff08\u9664\u975e\u5b83\u662f0\uff09\uff0c\u90a3\u4e48\u6211\u4eec\u53d1\u73b0\uff0c\u8981\u4e48\u4ece $A_i$ \u5f00\u59cb\uff0c\u5f80\u540e\u6bcf\u4e00\u9879 $2$ \u7684\u6307\u6570\u90fd $+1$\uff0c\u7136\u540e\u5230 $j$ \u65f6\u521a\u597d\u4e3a $k_2$\uff0c\u8981\u4e48\u4ece $A_i$ \u5f00\u59cb $2$ \u7684\u6307\u6570\u968f\u4fbf\u53d8\u5316\uff08$+1$ \u6216\u8005\u6e05\u96f6\uff09\uff0c\u76f4\u5230\u4e2d\u95f4\u67d0\u5904 $k$\uff0c\u6b64\u65f6\u5b83\u7684\u6307\u6570\u4e3a $0$\uff0c\u4e4b\u540e\u518d\u4ece $0$ \u589e\u52a0\u5230 $k_2$\uff0c\u53ef\u4ee5\u8bc1\u660e\u53ea\u6709\u8fd9\u4e24\u79cd\u60c5\u51b5\u662f\u5408\u6cd5\u7684\u3002\n\n\u8bbe $x$ \u8868\u793a\u8981\u7ed9\u591a\u5c11\u4e2a\u6570\u8d4b\u503c\uff0c\u663e\u7136 $x = i - j - 1$\u3002\n\n\u5c31\u662f\u8bf4\u5982\u679c $i$ \u548c $j$ \u4e4b\u95f4\u6709\u5408\u6cd5\u7684\u6784\u9020\uff0c\u90a3\u4e48\u5145\u8981\u6761\u4ef6\u662f\n$$\nd | c\\\\ k2 - k1 = x + 1 \\or k2 \\le x\n$$\n\u4e8e\u662f\u6211\u4eec\u5b9a\u4e49 ```dp``` \u72b6\u6001 $f[i]$ \u8868\u793a $1-i$ \u90fd\u5408\u6cd5\u7684\u6700\u5c0f\u4fee\u6539\u6b21\u6570\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728 $1-i-1$ \u4e2d\u627e\u5230\u4e00\u4e2a $j$ \u6ee1\u8db3\u4e0a\u8ff0\u6761\u4ef6\uff0c\u7136\u540e\u5047\u5b9a $[i+1,j-1]$ \u7684\u4f4d\u7f6e\u90fd\u4e0d\u5408\u6cd5\uff0c\u6765\u8ba1\u7b97 $f[j]$ \u5bf9 $f[i]$ \u7684\u8d21\u732e\u5c31\u884c\u4e86\u3002\n\n## \u7ec6\u8282\n\n\u6211\u4eec\u4f1a\u53d1\u73b0\u6709\u65f6\u4e00\u4e2a $i$ \u6839\u672c\u627e\u4e0d\u5230\u6211\u4eec\u60f3\u8981\u7684 $j$\uff0c\u90a3\u4e48\u521d\u59cb\u5316 $f[i]=i-1$ \u5373\u53ef\u3002\n\n\u6709\u65f6\u6700\u4f18\u65b9\u6848\u662f\u4ece\u67d0\u5904\u5f00\u59cb\u5230 $n$ \u4f4d\u7f6e\u5168\u90e8\u4fee\u6539\uff0c\u8fd9\u79cd\u60c5\u51b5\u53ea\u9700\u8981\u4ece $1$ \u5230 $n$ \u626b\u4e00\u904d\uff0c\u53d6 $f[i]+n-i$ \u7684\u6700\u5c0f\u503c\u4f5c\u4e3a\u7b54\u6848\u3002\n\n## \u53c2\u8003\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std ;\n#define ll long long\n#define rep(i,l,r) for(ll i=(l);i<=(r);++i)\n#define req(i,r,l) for(ll i=(r);i>=(l);--i)\n#define wif while\nconst ll inf = INT_MAX , df = 5005 ;\ninline ll read()\t{\n\tll x = 0 , y = 1 ; char ch = getchar() ;\n\twif( ch > '9' || ch < '0' ) y = (ch=='-') ? -1 : 1 , ch = getchar() ;\n\twif( ch >= '0' && ch <= '9' ) x = (x<<3) + (x<<1) + ch - '0' , ch = getchar() ;\n\treturn x * y ;\t}\nll i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,a[df],b[df],f[df],c[df];\nint main()\t{\n\tn = read() ;\n\trep(i,1,n)\ta[i] = read() ;\n\trep(i,1,n)\t{\n\t\tb[i] = 0 ;\n\t\twif( ! ( a[i] & 1 ) )\ta[i] >>= 1 , b[i] ++ ;\n\t}\n\tf[0] = f[1] = 0 ;\n\trep(i,2,n)\tf[i] = i - 1 ;\n\trep(i,2,n)\t{\n\t\treq(j,i-1,1)\t{\n \t\t\tll x = i - j - 1 ;\n\t\t\tif ( a[j] % a[i] == 0 && ( b[i] - b[j] == x + 1 || b[i] <= x ) )\t{\n\t\t\t\tf[i] = min( f[i] , f[j] + x ) ;\n\t\t\t}\n\t\t}\n\t}\n\tll ans = inf ;\n\trep(i,1,n)\tans = min( ans , f[i] + ( n - i ) ) ;\n\treturn printf( \"%lld\\n\" , ans ) , 0 ;\n}\n```",
        "postTime": 1616550111,
        "uid": 181164,
        "name": "CLZY",
        "ccfLevel": 0,
        "title": "CF283D Cows and Cool Sequences \u9898\u89e3"
    }
]
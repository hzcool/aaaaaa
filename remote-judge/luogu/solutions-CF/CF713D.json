[
    {
        "content": "\u9996\u5148\u5148\u5bf9\u4e8e$(i,j)$\uff0c\u9884\u5904\u7406\u51fa\u4ee5\u5b83\u4e3a\u53f3\u4e0b\u89d2\u7684\u6700\u5927\u51681\u6b63\u65b9\u5f62\u7684\u8fb9\u957f$p_{i,j}$\u3002\n\n\u8bbe$u_{i,j}$\u8868\u793a\u4ece$(i,j)$\u5411\u4e0a\uff0c\u6700\u957f\u7684\u4e00\u67611\u3002\u90a3\u4e48\u6b63\u65b9\u5f62\u8fb9\u957f\u4e3a$l$\u5f53\u4e14\u4ec5\u5f53$\\min\\limits_{k=j-l+1}^j{u_{i,k}}\\ge l$\uff0c\u5bf9$u$\u7684\u6bcf\u4e00\u884c\u5f00st\u8868\u5e76\u4e8c\u5206\u8ba1\u7b97\u5373\u53ef\u3002\n\n\u90a3\u4e48\u5c31\u53ef\u4ee5\u5904\u7406\u8be2\u95ee\u4e86\uff0c\u6b63\u65b9\u5f62\u8fb9\u957f\u4e3a$l$\u5f53\u4e14\u4ec5\u5f53$\\max\\limits_{c=x_1+l-1}^{x_2}\\max\\limits_{d=y_1+l-1}^{y_2}p_{c,d}\\ge l$\uff0c\u5f00\u4e2a\u4e8c\u7ef4st\u8868\u5e76\u4e8c\u5206\u8ba1\u7b97\u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define Rint register int\nusing namespace std;\nconst int N = 1003, M = 4400003;\nint n, m, q, up[10][N][N], lg2[N], pre[10][10][N][N], a[N][N];\nchar buffer[M], *s, *t, obuf[M], *O = obuf;\ninline int Getchar(){\n\tif(s == t){\n\t\tt = (s = buffer) + fread(buffer, 1, M, stdin);\n\t\tif(s == t)\n\t\t\treturn EOF;\n\t}\n\treturn *s ++;\n}\ntemplate<typename T> \ninline void read(T &x){\n\tint ch = Getchar(); x = 0;\n\tbool flag = false;\n\twhile(ch < '0' || ch > '9') ch = Getchar();\n\twhile(ch >= '0' && ch <= '9'){\n\t\tx = x * 10 + ch - '0';\n\t\tch = Getchar();\n\t}\n\tif(flag) x = -x;\n}\nvoid write(int x) {\n    if(x > 9) write(x / 10);\n    *O++ = x % 10 + '0';\n}\ninline int calc1(int x, int y, int yy){\n\tint k = lg2[yy - y + 1];\n\treturn min(up[k][x][y], up[k][x][yy - (1 << k) + 1]);\n}\ninline int calc2(int x, int y, int xx, int yy){\n\tint k1 = lg2[xx - x + 1], k2 = lg2[yy - y + 1];\n\treturn max(max(pre[k1][k2][x][y], pre[k1][k2][xx - (1 << k1) + 1][y]), max(pre[k1][k2][x][yy - (1 << k2) + 1], pre[k1][k2][xx - (1 << k1) + 1][yy - (1 << k2) + 1]));\n}\nint main(){\n\tread(n); read(m);\n\tfor(Rint i = 2;i <= n || i <= m;i ++) lg2[i] = lg2[i >> 1] + 1;\n\tfor(Rint i = 1;i <= n;i ++)\n\t\tfor(Rint j = 1;j <= m;j ++){\n\t\t\tread(a[i][j]);\n\t\t\tup[0][i][j] = a[i][j] * (up[0][i - 1][j] + 1);\n\t\t}\n\tfor(Rint k = 1;k <= 9;k ++)\n\t\tfor(Rint i = 1;i <= n;i ++)\n\t\t\tfor(Rint j = 1;j <= m - (1 << k) + 1;j ++)\n\t\t\t\tup[k][i][j] = min(up[k - 1][i][j], up[k - 1][i][j + (1 << k - 1)]);\n\tfor(Rint i = 1;i <= n;i ++)\n\t\tfor(Rint j = 1;j <= m;j ++){\n\t\t\tint l = 1, r = min(i, j), mid, ans = 0;\n\t\t\twhile(l <= r){\n\t\t\t\tmid = l + r >> 1;\n\t\t\t\tif(calc1(i, j - mid + 1, j) >= mid) ans = mid, l = mid + 1;\n\t\t\t\telse r = mid - 1;\n\t\t\t}\n\t\t\tpre[0][0][i][j] = ans;\n\t\t}\n\tfor(Rint k = 1;k <= 9;k ++){\n\t\tfor(Rint i = 1;i <= n;i ++)\n\t\t\tfor(Rint j = 1;j <= m - (1 << k) + 1;j ++)\n\t\t\t\tpre[0][k][i][j] = max(pre[0][k - 1][i][j], pre[0][k - 1][i][j + (1 << k - 1)]);\n\t\tfor(Rint i = 1;i <= n - (1 << k) + 1;i ++)\n\t\t\tfor(Rint j = 1;j <= m;j ++)\n\t\t\t\tpre[k][0][i][j] = max(pre[k - 1][0][i][j], pre[k - 1][0][i + (1 << k - 1)][j]);\n\t}\n\tfor(Rint k1 = 1;k1 <= 9;k1 ++)\n\t\tfor(Rint k2 = 1;k2 <= 9;k2 ++)\n\t\t\tfor(Rint i = 1;i <= n - (1 << k1) + 1;i ++)\n\t\t\t\tfor(Rint j = 1;j <= m - (1 << k2) + 1;j ++)\n\t\t\t\t\tpre[k1][k2][i][j] = max(pre[k1][k2 - 1][i][j], pre[k1][k2 - 1][i][j + (1 << k2 - 1)]);\n\tread(q);\n\twhile(q --){\n\t\tint x, y, xx, yy;\n\t\tread(x); read(y); read(xx); read(yy);\n\t\tint l = 1, r = min(xx - x + 1, yy - y + 1), mid, ans = 0;\n\t\twhile(l <= r){\n\t\t\tmid = l + r >> 1;\n\t\t\tif(calc2(x + mid - 1, y + mid - 1, xx, yy) >= mid) ans = mid, l = mid + 1;\n\t\t\telse r = mid - 1;\n\t\t}\n\t\twrite(ans); *O++ = '\\n';\n\t}\n\tfwrite(obuf, O - obuf, 1, stdout);\n}\n```",
        "postTime": 1572862148,
        "uid": 68148,
        "name": "watermoon",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF713D \u3010Animals and Puzzle\u3011"
    }
]
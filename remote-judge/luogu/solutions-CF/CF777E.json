[
    {
        "content": "#### [\u9898\u9762](https://www.luogu.org/problem/show?pid=CF777E)\n\n\n------------\n\n### \u5927\u81f4\u9898\u610f\uff1a\n\n\u6709 $n$ \u4e2a\u73af\uff0c\u6bcf\u4e2a\u73af\u6709\u5185\u5f84 $a_i$ , \u5916\u5f84 $b_i$ , \u4ee5\u53ca\u9ad8\u5ea6 $h_i$.\n\n\u5f53\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u65f6\uff0c\u53ef\u4ee5\u5c06\u4e00\u4e2a\u73af\u653e\u5728\u53e6\u4e00\u4e2a\u73af\u7684\u4e0a\u9762\uff08\u8bb0\u4e0a\u9762\u7684\u73af\u7684\u7f16\u53f7\u4e3a $i$\uff0c\u4e0b\u9762\u7684\u73af\u7684\u7f16\u53f7\u4e3a $j$\uff09:\n\n* **$b_i$ $\\leq$ $b_j$ **\n* **$b_i$ $ >  $ $a_j$ **\n\n\u8981\u6c42\u6c42\u51fa\u6240\u80fd\u53e0\u653e\u5230\u7684\u6700\u9ad8\u9ad8\u5ea6\n\n\n------------\n\n### \u5148\u8bb2\u8bb2\u66b4\u529b\n\n\u66b4\u529b\u4e00\u70b9\u90fd\u4e0d\u96be\u60f3\uff1a\n\n\u7528 $f_i$ \u8868\u793a\u4ee5\u7f16\u53f7\u4e3ai\u7684\u73af\u4e3a\u6700\u4e0a\u9762\u7684\u73af\u6240\u80fd\u8fbe\u5230\u7684\u6700\u9ad8\u9ad8\u5ea6\n\n\u6211\u4eec\u53ef\u4ee5\u5148\u5c06\u8fd9 $n$ \u4e2a\u73af\u6309\u5916\u5f84\u4ece\u5927\u5230\u5c0f\u6392\u4e00\u904d\u5e8f,\u8fd9\u6837\u8f6c\u79fb\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u4fdd\u8bc1 $b_i$ $\\leq$ $b_j$\u3002**\u6ce8\u610f\u6392\u5e8f\u7684\u65f6\u5019\u4e5f\u6709\u4e00\u4e9b\u5c0f\u7ec6\u8282\uff0c\u6211\u4f1a\u5728\u540e\u9762\u8bf4\u7684\u3002**\n\n\u90a3\u4e48\u5c31\u6709 $f_i= Max \\lbrace f_j \\rbrace (1\u2264j<i)+h_i$ \uff0c\u8f6c\u79fb\u6761\u4ef6\uff1a$b_i > a_j$\n\n\u6700\u540e\u5728\u6240\u6709\u7684 $f_i$ \u91cc\u53d6\u4e2a\u6700\u5927\u503c\u5c31\u597d\u4e86\n\n\n\n#### \u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;//\u6ce8\u610f\u8981\u5f00 long long\nll f[100005],n,ans;\nstruct tzg{ll a,b,h;}a[100005];\nbool cmp(tzg x,tzg y){\n\tif(x.b==y.b)return x.a>y.a;\n\treturn x.b>y.b;\n}//\u8fd9\u4e2a\u6392\u5e8f\u5728\u540e\u9762\u7684AC\u4ee3\u7801\u4e2d\u89e3\u91ca\u7684 \nint main(){\n\tscanf(\"%lld\",&n);\n\tfor(ll i=1;i<=n;++i)scanf(\"%lld%lld%lld\",&a[i].a,&a[i].b,&a[i].h);\n\tsort(a+1,a+n+1,cmp);\n\tfor(ll i=1;i<=n;++i){\n\t\tfor(ll j=0;j<i;++j){//\u56e0\u4e3a\u7b2ci\u4e2a\u73af\u4e0b\u9762\u4e5f\u6709\u53ef\u80fd\u6ca1\u6709\u73af\uff0c\u6240\u4ee5j\u4ece0\u5f00\u59cb\u5faa\u73af\n\t\t\tif(a[i].b>a[j].a)//\u5982\u679c\u53ef\u4ee5\u8f6c\u79fb \n\t\t\t\tf[i]=max(f[i],f[j]+a[i].h);\n\t\t}\n\t\tans=max(ans,f[i]);//\u66f4\u65b0ans \n\t}\n\tcout<<ans;\n\treturn 0;\n}\n\n```\n\n\n------------\n\n### \u6b63\u89e3\n\n\u66b4\u529b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u662f $O(n^2)$ \uff0c\u80af\u5b9a\u662f\u8fc7\u4e0d\u4e86\u7684\uff0c\u6211\u4eec\u60f3\u60f3\u600e\u4e48\u4f18\u5316\u3002\n\n\u5f88\u660e\u663e\uff0c\u53ea\u6709 $f_j$ \u548c $j$ \u6709\u5173\uff0c\u8ba9\u6211\u4eec\u60f3\u60f3\u600e\u4e48\u53bb\u628a\u8fd9\u4e00\u7ef4\u7ed9\u4f18\u5316\u6389\n\n\u6bcf\u6b21\u90fd\u8981\u627e\u6700\u5927\u503c\uff0c\u8003\u8651\u7528\u5927\u6839\u5806\u6765\u5b9e\u73b0\u3002\u4f46\u662f\u6709\u4e00\u4e2a\u8f6c\u79fb\u6761\u4ef6 $b_i>a_j$\uff0c\u6bcf\u6b21\u53d6\u5806\u5934\u662f\u90fd\u8981\u5224\u65ad\u4e00\u4e0b\u8fd9\u4e2a\u8f6c\u79fb\u662f\u5426\u5408\u6cd5\uff0c\u5982\u679c\u4e0d\u5408\u6cd5\u5c31\u628a\u5806\u9876\u5f39\u6389\u3002\n\n\u8fd9\u6837\u4f1a\u4e0d\u4f1a\u628a\u5bf9\u4e4b\u540e\u66f4\u65b0\u6709\u5f71\u54cd\u7684\u5143\u7d20\u5f39\u6389\u5462\uff1f\n\n\u5176\u5b9e\u662f\u4e0d\u4f1a\u7684\uff0c\u8ba9\u6211\u4eec\u6765\u770b\u4e00\u4e0b\uff1a\n\n\u8bb0\u5806\u9876\u5143\u7d20\u4e3a $tp$ , \u8be5\u72b6\u6001\u4f4d\u4e8e\u6700\u4e0a\u9762\u7684\u73af\u7684\u5185\u5f84\u4e3a $tp.w$ \uff0c\u6b64\u65f6\u5bf9\u5e94\u7684\u9ad8\u5ea6\u4e3a $tp.h$\n\n\u5bf9\u4e8e\u5f53\u524d\u7684 $i$ , \u5982\u679c\u8f6c\u79fb\u662f\u975e\u6cd5\u7684\uff0c\u5373 $b_i \\leq tp.w$ \uff0c\u90a3\u4e48\u53ef\u4ee5\u5f97\u51fa $b_{i+1} \\leq tp.w $ \uff08\u56e0\u4e3a\u662f\u6309\u5916\u5f84\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\u7684\uff09\uff0c\u6240\u4ee5\u8bf4\u628a\u5806\u9876\u5143\u7d20\u5f39\u6389\u4e0d\u4f1a\u5f71\u54cd\u4e4b\u540e\u7684\u72b6\u6001\n\n\u90a3\u4e48\u5c31\u597d\u529e\u4e86\uff0c\u7528\u4e00\u4e2a\u5806\u7ef4\u62a4\u6700\u5927\u503c\u5c31\u884c\u4e86\n\n#### \u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nll f[100005],n,ans;\nstruct tzg{ll a,b,h;}a[100005];\nbool cmp(tzg x,tzg y){\n\tif(x.b==y.b)return x.a>y.a;//\u5f53\u4e24\u4e2a\u73af\u5916\u5f84\u76f8\u7b49\u65f6,\u8981\u5c06\u5185\u5f84\u5c0f\u7684\u73af\u653e\u5728\u4e0a\u9762\uff0c\u8fd9\u6837\u53ef\u4ee5\u66f4\u65b9\u4fbf\u5bf9\u4e8e\u540e\u9762\u5916\u5f84\u6bd4\u8fd9\u4e2a\u73af\u5c0f\u7684\u72b6\u6001\u7684\u8f6c\u79fb \n\treturn x.b>y.b;\n}\nstruct node{\n\tll w,h;\n\tbool operator<(const node &rhs)const{\n\t\treturn h<rhs.h;\n\t}\n};\npriority_queue<node> q;\nint main(){\n\tscanf(\"%lld\",&n);\n\tfor(ll i=1;i<=n;++i)scanf(\"%lld%lld%lld\",&a[i].a,&a[i].b,&a[i].h);\n\tsort(a+1,a+n+1,cmp);\n\tq.push((node){0,0});//\u53ef\u4ee5\u76f4\u63a5\u4ece\u4e0b\u9762\u6ca1\u6709\u73af\u7684\u72b6\u6001\u8f6c\u79fb\u8fc7\u6765 \n\tfor(ll i=1;i<=n;++i){\n\t\twhile(q.top().w>=a[i].b)q.pop();\n\t\tf[i]=q.top().h+a[i].h;//\u5176\u5b9e\u8fd9\u4e2af\u6570\u7ec4\u6ca1\u6709\u5fc5\u8981\u5f00 \n\t\tq.push((node){a[i].a,q.top().h+a[i].h});\n\t\tans=max(ans,f[i]);\n\t}\n\tcout<<ans;\n\treturn 0;\n}\n```\n",
        "postTime": 1540815205,
        "uid": 41834,
        "name": "Aryzec",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF777E Hanoi Factory"
    },
    {
        "content": "\u8003\u8651$i$\u80fd\u653e\u5728$j$\u4e0a\u9762\uff0c\u7531\u9898\u76ee\u53ef\u77e5\uff0c\u6b64\u65f6$a_j<b_i \\le b_j$\n\n\u6211\u4eec\u5148\u6309\u7167$b$\u6392\u5e8f\uff0c\u4fdd\u8bc1$b$\u662f\u964d\u5e8f\u6392\u5217\u7684\uff0c\u5c31\u80fd\u591f\u5199\u51fa\u4e00\u4e2a\u5f88\u66b4\u529b\u7684dp:\u8bbe$f_i$\u8868\u793a\u53ea\u8003\u8651\u524d$i$\u4e2a\u4e14$i$\u653e\u5728\u6700\u4e0a\u9762\u7684\u6700\u4f18\u65b9\u6848\uff0c\u5219\uff1a\n\n$$f_i=\\max_{j<i,a_j<b_i} f_j+h_i$$\n\n\u7531\u4e8e\u5df2\u7ecf\u6309$b$\u6392\u8fc7\u5e8f\uff0c\u5c31\u4e0d\u7528\u8003\u8651\u4e0b\u9762\u7684\u6bd4\u4e0a\u9762\u7684\u5916\u5f84\u5c0f\u8fd9\u79cd\u60c5\u51b5\u3002\n\n\u76f4\u63a5\u66b4\u529bdp\u662f$O(n^2)$\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u8bb2$a_i,b_i$\u79bb\u6563\u5316\u540e\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u524d\u7f00\u6700\u5927\u503c\u5373\u53ef\uff0c\u7ec6\u8282\u89c1\u4ee3\u7801\u3002\n\n~~\u6240\u4ee5\u4e3a\u4ec0\u4e48\u795e\u4ed9\u628a\u8fd9\u9898\u653e\u5230\u5355\u8c03\u6808\u7684\u9898\u91cc\u9762\u554a~~\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <algorithm>\n#include <cstring>\n\ntypedef long long ll;\n\nusing namespace std;\n\nconst int N = 100005;\n\nint n, a[N];\nll tree[N];\n\n#define lowbit(x) ((x)&(-(x)))\n\ninline ll max_(ll a, ll b) {\n\treturn a > b ? a : b;\n}\n\ninline void add(int x, ll a) {\n\tfor (int i = x; i < N; i += lowbit(i)) tree[i] = max_(tree[i], a); \n}\n\ninline ll qmax(int x) {\n\tll ret = 0;\n\tfor (int i = x; i; i -= lowbit(i)) ret = max_(ret, tree[i]);\n\treturn ret;\n}\n\nstruct Cycle {\n\tint a, b, h;\n}cy[N];\n\ninline bool cmp(Cycle a, Cycle b) {\n\tif (a.b == b.b) return a.a > b.a;\n\treturn a.b > b.b;\n}\n\nll f[N], ans = 0;\n\nint main() {\n\tscanf(\"%d\", &n);\n\tfor (int i = 1; i <= n; ++i) {\n\t\tscanf(\"%d%d%d\", &cy[i].a, &cy[i].b, &cy[i].h);\n\t\ta[i] = cy[i].a;\n\t} sort(a + 1, a + n + 1);\n\tfor (int i = 1; i <= n; ++i)\n\t\tcy[i].a = lower_bound(a + 1, a + n + 1, cy[i].a) - a;\n\tsort(cy + 1, cy + n + 1, cmp);\n\tans = cy[1].h; f[1] = cy[1].h;\n\tadd(cy[1].a, f[1]);\n\tfor (int i = 2; i <= n; ++i) {\n\t\tf[i] = qmax(lower_bound(a + 1, a + n + 1, cy[i].b) - a - 1);\n\t\tf[i] += cy[i].h;\n\t\tadd(cy[i].a, f[i]);\n\t\tans = max_(f[i], ans);\n\t} printf(\"%lld\", ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1607737963,
        "uid": 98096,
        "name": "Smallbasic",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 CF777E \u3010Hanoi Factory\u3011"
    },
    {
        "content": "\u601d\u8def\uff1a\u6808+\u8d2a\u5fc3\n\n\u770b\u4e86\u4e24\u4f4d\u5927\u4f6c\u7684dp\u548c\u5806\u7684\u9898\u89e3\uff0c\u672c\u849f\u84bb\u6765\u5199\u4e00\u4e2a\u6808\u7684\u505a\u6cd5\n\n\u9996\u5148\u80af\u5b9a\u8fd8\u662f\u8981\u6839\u636e\u5916\u5f84\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\u7684\uff0c\u8fd9\u6837\u5b50\u6211\u4eec\u5728\u904d\u53861~n\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u5916\u5f84\u5df2\u7ecf\u6709\u5e8f\n\n\u7136\u540e\u7ef4\u62a4\u4e00\u4e2a\u6808\uff0c\u6bcf\u6b21\u64cd\u4f5c\u4e4b\u5148\u7ef4\u62a4\u6808\u9876\n\u5177\u4f53\u6765\u8bf4\uff0c\u5982\u679c\u4e0d\u80fd\u653e\u4e86\uff08\u4e5f\u5c31\u662f\u5f53\u524d\u7684\u5185\u5f84\u8981\u5c0f\u4e8e\u7b49\u4e8e\u6808\u9876\u7684\u65f6\u5019\uff09\u5c31\u628a\u6808\u9876\u5f39\u51fa\n\n\u7136\u540e\u518d\u5c06\u5f53\u524d\u8282\u70b9\u5165\u6808\uff0c\u6ce8\u610f\u8981\u5b9e\u65f6\u8bb0\u5f55\u7b54\u6848\u7684\u6700\u5927\u503c\uff0c\u8fd9\u6837\u624d\u80fd\u4fdd\u8bc1\u6700\u540e\u7684\u7b54\u6848\u662f\u6b63\u786e\u7684\n\nAC\u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int M=1e5+5;\ntypedef long long ll;\nll n,ans,sum;\nll f[M];\nstruct node\n{\n\tll a,b,h;\n}p[M];\nstack<int> stk;\nbool cmp(node x,node y)\n{\n    if(x.b!=y.b) return x.b>y.b; \n    return x.a>y.a;\n}\nint main()\n{\n    scanf(\"%d\",&n);\n    for(int i=1; i<=n; i++)\n    {\n    \tint a,b,c; scanf(\"%d%d%d\",&a,&b,&c);\n    \tp[i]={a,b,c};\n\t}\n    sort(p+1,p+1+n,cmp);\n    ans=sum=p[1].h;\n    stk.push(1);\n    for(int i=2; i<=n; i++)\n    {\n    \twhile(!stk.empty() && p[stk.top()].a>=p[i].b)\n    \t{\n    \t\tsum-=p[stk.top()].h;\n    \t\tstk.pop();\n\t\t}\n\t\tsum+=p[i].h;\n\t\tstk.push(i);\n\t\tans=max(ans,sum);\n\t}\n\tprintf(\"%lld\",ans);\n    return 0;\n}\n```\n",
        "postTime": 1583243178,
        "uid": 91375,
        "name": "crh1272336175",
        "ccfLevel": 4,
        "title": "\u9898\u89e3 CF777E \u3010Hanoi Factory\u3011"
    },
    {
        "content": "### \u9996\u5148\u60f3\u5230\u7684\u662f DP\n\u5148\u5c06 $n$ \u4e2a\u73af\u6309\u7167\u5916\u5f84\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\uff0c\u82e5\u5916\u5f84\u76f8\u540c\uff0c\u518d\u6309\u7167\u5185\u5f84\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\u3002\n\n- \u8bbe $f_i$ \u8868\u793a\u4ee5\u7f16\u53f7\u4e3a $i$ \u7684\u73af\u4e3a\u6700\u4e0a\u9762\u7684\u73af\u6240\u80fd\u5230\u8fbe\u7684\u6700\u9ad8\u9ad8\u5ea6\u3002\n\n- \u72b6\u6001\u8f6c\u79fb\u65b9\u7a0b\u4e3a\uff1a$f_i=\\max{f_j}+h_i (1\\le j<i,b_i>a_j)$\u3002\n\n- \u6700\u540e\u5728\u6240\u6709\u7684 $f_i$ \u4e2d\u53d6\u6700\u5927\u503c\u3002\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^2)$\u3002\n\n### \u5173\u952e\u4ee3\u7801\n```cpp\nsort(a+1,a+n+1,cmp);\nfor(int i=1;i<=n;i++){\n\tfor(int j=0;j<i;j++){\n\t\tif(a[i].b>a[j].a)\n\t\t\tf[i]=max(f[i],f[j]+a[i].h);\n\t}\n\tans=max(ans,f[i]);\n}\n```\n------------\n### \u7136\u800c\u76f4\u63a5\u8fdb\u884c DP \u663e\u7136\u65f6\u95f4\u590d\u6742\u5ea6\u8fc7\u9ad8\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u5806\u4f18\u5316\u3002\n\u8bb0\u5806\u9876\u5143\u7d20\u4e3a $L$\uff0c\u8be5\u72b6\u6001\u4f4d\u4e8e\u6700\u4e0a\u9762\u7684\u73af\u7684\u5185\u5f84\u4e3a $L.w$\uff0c\u6b64\u65f6\u5bf9\u5e94\u7684\u9ad8\u5ea6\u4e3a $L.h$\u3002\n\n\u56e0\u4e3a\u5728DP\u8f6c\u79fb\u7684\u8fc7\u7a0b\u4e2d\u8981\u6c42 $b_i>a_j$\uff0c\u6bcf\u6b21\u53d6\u5806\u5934\u662f\u90fd\u8981\u5224\u65ad\u4e00\u4e0b\u8fd9\u4e2a\u8f6c\u79fb\u662f\u5426\u5408\u6cd5\uff0c\u5982\u679c\u4e0d\u5408\u6cd5\u5c31\u628a\u5806\u9876\u5f39\u6389\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n\\log n)$\u3002\n\n### \u4ee3\u7801\n```cpp\n#include <iostream>\n#include <algorithm>\n#include <stack>\nusing namespace std;\nint n;\nstruct L{\n\tint a,b,h;\n}p[100010];\nbool cmp(L x,L y){\n\treturn x.b>y.b||(x.b==y.b&&x.a>y.a);\n}\nstack<L>q;\nlong long ans,now;\nsigned main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++) scanf(\"%d%d%d\",&p[i].a,&p[i].b,&p[i].h);\n\tsort(p+1,p+n+1,cmp);\n\tfor(int i=1;i<=n;i++){\n\t\tif(q.empty()||p[i].b==q.top().b){\n\t\t\tq.push(p[i]);\n\t\t\tnow+=p[i].h;\n\t\t}\n\t\telse{\n\t\t\twhile(!q.empty()&&p[i].b<=q.top().a){\n\t\t\t\tans=max(ans,now);\n\t\t\t\tnow-=q.top().h;\n\t\t\t\tq.pop();\n\t\t\t}\n\t\t\tq.push(p[i]);\n\t\t\tnow+=p[i].h;\n\t\t\tans=max(ans,now);\n\t\t}\n\t}\n\tans=max(ans,now);\n\tcout<<ans;\n\treturn 0;\n}\n```\n",
        "postTime": 1665808524,
        "uid": 190931,
        "name": "cannotdp",
        "ccfLevel": 4,
        "title": "CF777E Hanoi Factory \u9898\u89e3"
    },
    {
        "content": "[Link](https://www.luogu.com.cn/problem/CF777E)\n----------\n\n### Solution\n\u5bb9\u6613\u60f3\u5230\u7528 $f_i$ \u8868\u793a\u9876\u90e8\u5706\u73af\u662f $i$ \u65f6\u7684\u5854\u7684\u6700\u5927\u9ad8\u5ea6\u3002\u8003\u8651\u5982\u4f55\u8f6c\u79fb\uff0c\u4e00\u4e2a\u5706\u73af $i$ \u80fd\u653e\u5728\u53e6\u4e00\u4e2a\u5706\u73af $j$ \u4e0a\uff0c\u5fc5\u6709 $b_i\\leq b_j$\uff0c\u6240\u4ee5\u5bb9\u6613\u60f3\u5230\u6309\u7167 $b$ \u964d\u5e8f\u6392\u5e8f\uff0c\u90a3\u4e48 $f_i$ \u53ea\u9700\u8981\u4ece $j \\ (j<i)$ \u8f6c\u79fb\uff0c\u5c31\u6ca1\u6709\u540e\u6548\u6027\u3002\u5bb9\u6613\u5199\u51fa\u8f6c\u79fb\u65b9\u7a0b\n$$f_i=\\max \\limits_{a_j<b_i} \\{f_j\\}+h_i \\quad j\\in[1,i)$$\n\u5f62\u8c61\u5730\u8bf4\u5c31\u662f\u5728\u524d $i-1$ \u4e2a\u5706\u73af\u4e2d\uff0c\u627e\u5230 $a$ \u503c\u5c0f\u4e8e\u4e00\u4e2a\u503c\u7684\u6240\u6709 $f$ \u7684\u6700\u5927\u503c\u3002\u663e\u7136\u53ef\u4ee5\u79bb\u6563\u5316 $a$ \u548c $b$ \u540e\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u3002\n\n```cpp\n#include<stdio.h>\n#include<algorithm>\nusing namespace std;\n#define N 100007\n#define ll long long\n\ninline int read(){\n    int x=0,flag=1; char c=getchar();\n    while(c<'0'||c>'9'){if(c=='-') flag=0;c=getchar();}\n    while(c>='0'&&c<='9'){x=(x<<1)+(x<<3)+c-48;c=getchar();}\n    return flag? x:-x;\n}\n\nstruct Node{\n    int a,b; ll h;\n    bool operator <(const Node &x) const{\n        return b!=x.b? b>x.b:a>x.a;\n    }\n}t[N];\n\nint n,X[N<<1],sz;\nll f[N],c[N<<1];\n\ninline int lowbit(int x){return -x&x;}\ninline void add(int x,ll v){while(x<=sz)c[x]=max(c[x],v),x+=lowbit(x);}\ninline ll query(int x){ll ret=0;while(x)ret=max(ret,c[x]),x-=lowbit(x);return ret;}\n\nint main(){\n    n=read();\n    for(int i=1;i<=n;i++){\n        t[i].a=read(),t[i].b=read(),t[i].h=read();\n        X[(i<<1)-1]=t[i].a,X[i<<1]=t[i].b;\n    }\n    sort(t+1,t+1+n),sort(X+1,X+1+2*n);\n    sz=unique(X+1,X+1+2*n)-(X+1);\n    for(int i=1;i<=n;i++){\n        t[i].a=lower_bound(X+1,X+1+sz,t[i].a)-X;\n        t[i].b=lower_bound(X+1,X+1+sz,t[i].b)-X;\n    }\n    ll ans=0;\n    for(int i=1;i<=n;i++){\n        f[i]=query(t[i].b-1)+t[i].h;\n        add(t[i].a,f[i]);\n        ans=max(ans,f[i]);\n    }\n    printf(\"%lld\",ans);\n}\n```\n\n----------\n\n\u540e\u9762\u53d1\u73b0\u5e76\u4e0d\u9700\u8981\u6811\u72b6\u6570\u7ec4\uff0c\u89c2\u5bdf\u8fd9\u53e5\u8bdd\uff1a\n```cpp\nf[i]=query(t[i].b-1)+t[i].h;\n```\n\u56e0\u4e3a $b$ \u662f\u5355\u8c03\u4e0d\u589e\u7684\uff0c\u6240\u4ee5\u51b3\u7b56\u96c6\u5408\u4e00\u76f4\u5728\u51cf\u5c0f\u3002\u5bf9\u4e8e\u4e09\u4e2a\u5706\u73af $j$ \u3001$i$ \u548c $k$\uff0c\u4e14\u6709 $j<i<k$\uff0c\u5982\u679c $i$ \u4e0d\u80fd\u4ece $j$ \u8f6c\u79fb\u8fc7\u6765\uff0c\u90a3\u4e48 $k$ \u4e5f\u4e00\u5b9a\u4e0d\u80fd\u4ece $j$ \u8f6c\u79fb\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7ef4\u62a4\u8fd9\u4e2a\u51b3\u7b56\u96c6\u5408\uff0c\u5982\u679c $j$ \u4e0d\u5408\u6cd5\u5c31\u76f4\u63a5\u5220\u6389\u800c\u4e0d\u4f1a\u5bf9\u540e\u9762\u9020\u6210\u5f71\u54cd\u3002\u518d\u6b21\u89c2\u5bdf\u8f6c\u79fb\u65b9\u7a0b\uff0c\u6bcf\u6b21\u6211\u4eec\u53d6\u4e86\u51b3\u7b56\u96c6\u5408\u91cc\u9762\u7684\u6700\u5927\u503c\uff0c\u4e4b\u540e\u53c8\u52a0\u4e0a\u4e86\u4e00\u4e2a\u6b63\u6574\u6570 $h$\uff0c\u6240\u4ee5\u518d\u628a\u73b0\u5728\u66f4\u65b0\u51fa\u6765\u7684 $f_i$ \u52a0\u5165\u51b3\u7b56\u96c6\u5408\uff0c$f_i$ \u5c31\u4f1a\u6210\u4e3a\u51b3\u7b56\u96c6\u5408\u91cc\u9762\u7684\u6700\u5927\u503c\uff0c\u6240\u4ee5\u51b3\u7b56\u96c6\u5408\u91cc\u7684 $f$ \u4e5f\u5177\u6709\u5355\u8c03\u6027\uff0c\u4e14\u662f\u5355\u589e\u7684\u3002\u90a3\u4e48\u5269\u4e0b\u7684\u5c31\u53ef\u4ee5\u7528\u5355\u8c03\u6808\u6765\u7ef4\u62a4\u4e86\u3002\u5355\u8c03\u6808\u590d\u6742\u5ea6 $O(n)$\n\n```cpp\n#include<stdio.h>\n#include<algorithm>\nusing namespace std;\n#define N 100007\n#define ll long long\n\ninline int read(){\n    int x=0,flag=1; char c=getchar();\n    while(c<'0'||c>'9'){if(c=='-') flag=0;c=getchar();}\n    while(c>='0'&&c<='9'){x=(x<<1)+(x<<3)+c-48;c=getchar();}\n    return flag? x:-x;\n}\n\nstruct Node{\n    int a,b; ll h;\n    bool operator <(const Node &x) const{\n        return b!=x.b? b>x.b:a>x.a;\n    }\n}t[N],sta[N];\n\nint n,top=0;\nll f[N];\n\ninline ll max(ll x,ll y){return x>y? x:y;}\nint main(){\n    n=read();\n    for(int i=1;i<=n;i++)\n        t[i].a=read(),t[i].b=read(),t[i].h=read();\n    sort(t+1,t+1+n);\n    ll ans=0;\n    for(int i=1;i<=n;i++){\n        while(top&&t[i].b<=sta[top].a) top--;\n        sta[++top]=t[i];\n        sta[top].h+=sta[top-1].h;\n        ans=max(ans,sta[top].h);\n    }\n    printf(\"%lld\",ans);\n}\n```\n\n\u53d1\u73b0\u4e0d\u9700\u8981\u79bb\u6563\u5316\u4e86\uff0c\u74f6\u9888\u5728\u4e8e\u6392\u5e8f\u3002\u5982\u679c\u518d\u628a\u5feb\u6392\u6362\u6210\u57fa\u6570\u6392\u5e8f\uff0c\u90a3\u4e48\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u5927\u6982\u5c31\u662f $O(n)$\u3002\n\n### Tips\n\u5bf9\u4e8e $b_i=b_j$\uff0c\u8981\u6309\u7167 $a$ \u964d\u5e8f\u6392\u5e8f\uff0c\u56e0\u4e3a\u9876\u90e8\u7684\u5185\u5f84\u8d8a\u5c0f\u8d8a\u597d\uff0c\u5bf9\u540e\u9762\u7684\u8f6c\u79fb\u6709\u6b63\u7684\u5f71\u54cd\u3002",
        "postTime": 1607763419,
        "uid": 83337,
        "name": "wwlw",
        "ccfLevel": 7,
        "title": "CF777E Hanoi Factory"
    },
    {
        "content": "\u76f4\u63a5\u4ee3\u7801\u3002\n\n\n```cpp\n#include<algorithm>\n#include<iostream>\n#include<cstring>\n#include<vector>\n#include<cstdio>\n#include<cmath>\n#include<queue>\n#define P make_pair\n#define ll long long\nusing namespace std;\nconst int M=1e6+100;\nconst int inf=1e9;\ninline int read(){\n\tint x=0,f=1; char c=getchar();\n\tfor(;!isdigit(c);c=getchar()) if(c=='-') f=-1;\n\tfor(;isdigit(c);c=getchar()) x=x*10+c-'0';\n\treturn x*f;\n}\nint n,head=1,tail;\npriority_queue< pair<ll,ll> > q; //\u5927\u6839\u5806,make_pair\nll res=-inf;\nstruct Node{\n\tll a,b,h;\n\tfriend bool operator < (const Node& x,const Node& y){\n\t\treturn x.b!=y.b ? x.b>y.b : x.a>y.a; //b\u76f8\u540c\u5219a\u5927\u7684\u653e\u524d\u9762\uff08\u601d\u8003\u4e3a\u4f55\uff09\n\t}\n}p[M];\n\nint main(){\n\tn=read();\n\tfor(int i=0;i<n;++i)\n\t\tp[i].a=read(),\n\t\tp[i].b=read(),\n\t\tp[i].h=read();\n\tsort(p , p+n);\n\t//\u6b64\u65f6p\u6570\u7ec4\u5df2\u6309b\u503c\u964d\u5e8f\u6392\u5e8f\n\tfor(int i=0;i<n;++i){\n\t\tll tmp=p[i].h;\n\t\twhile(!q.empty() && q.top().second>=p[i].b)\n\t\t\tq.pop(); //pop\u51faval\u503c\u6700\u5927\u7684\u4f46\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684pair\n            \t\t\t//\u89e3\u91ca\u4e00\u4e0b,\u5728i\u4e4b\u540e\u7684\u6c49\u8bfa\u5757\u7684\u5916\u5f84b\u80af\u5b9a\u5c0f\u4e8e\u5f53\u524d\u5757p[i]\u7684\u5916\u5f84b,\u73b0\u5728\u5c31\u4e0d\u6ee1\u8db3\u6761\u4ef6\u7684\u4e4b\u540e\u80af\u5b9a\u4e5f\u4e0d\u4f1a\u6ee1\u8db3\u6761\u4ef6\n\t\tif(!q.empty()) tmp+=q.top().first; //\u5982\u679c\u961f\u91cc\u8fd8\u6709\u6ee1\u8db3\u6761\u4ef6\u7684\u6c49\u8bfa\u5757\u5219\u52a0\u4e0aval\n\t\tq.push(P(tmp,p[i].a)); //\u5165\u961f\n\t\tres=max(res , tmp); //\u66f4\u65b0res\n\t}\n\tcout<<res<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1530108662,
        "uid": 38576,
        "name": "J\u03bcdge",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF777E \u3010Hanoi Factory\u3011"
    }
]
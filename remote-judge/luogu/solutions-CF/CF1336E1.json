[
    {
        "content": "\u636eEA\u8bf4\u8fd9\u9898\u662f\u72b6\u538b\uff1f\n\n\u665a\u4e0a\u521aCF\u60f3\u5230\u4e86\u6b63\u89e3\uff0c\u4f46\u662f\u6ca1\u5199\u5b8c\u545c\u545c\u545c\uff0c\u7b2c\u4e8c\u5929\u65e9\u4e0a20min\u5c31AC\u4e86\u3002\n\n**\u5f53 \u573a \u53bb \u4e16**\n\n---\n\n\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e2a\u6bd4\u8f83\u201c\u66b4\u529b\u201d\u7684\u505a\u6cd5\uff1a**\u7ebf\u6027\u57fa+\u6298\u534a\u641c\u7d22+FWT**\n\n\u9996\u5148\u6784\u9020\u51fa $a_i$ \u7684\u7ebf\u6027\u57fa $\\mathfrak{B}$\uff0c\u5173\u4e8e\u7ebf\u6027\u57fa\u6709\u4e2a\u5f88\u597d\u7684\u7ed3\u8bba\uff0c\u6709\u5174\u8da3\u53ef\u4ee5\u770b\u770b\u8fd9\u9053\u9898\uff1a[P4869 albus\u5c31\u662f\u8981\u7b2c\u4e00\u4e2a\u51fa\u573a](https://www.luogu.com.cn/problem/P4869)\n\n> \u7ebf\u6027\u57fa\u4e2d\u7ec4\u5408\u6210\u7684 $2^{|\\mathfrak{B}|}$ \u79cd\u5f02\u6216\u548c\u51fa\u73b0\u7684\u6b21\u6570\u4e00\u6837\u4e14\u6bcf\u4e2a\u6570\u51fa\u73b0\u7684\u6b21\u6570\u90fd\u4e3a $2^{n-|\\mathfrak{B}|}$\n\n\u5177\u4f53\u8bc1\u660e\u53ef\u4ee5\u53bb\u770b\u90a3\u9053\u9898\u76ee\u7684\u9898\u89e3\u3002\n\n\u73b0\u5728\u6211\u4eec\u628a\u6570\u636e\u89c4\u6a21\u4ece $2^n$ \u7f29\u5c0f\u5230 $2^m$ \u4e86\uff0c\u6700\u7ec8\u7684\u7b54\u6848\u5c31\u662f\u53ea\u8003\u8651\u7ebf\u6027\u57fa\u4e2d\u7684\u6570\u7684\u7b54\u6848\u518d\u4e58\u4e0a $2^{n-|\\mathfrak{B}|}$\u3002\n\n\u770b\u4e00\u770b\u8fd9\u4e2a $m$\uff0c\u6709\u6728\u6709\u4ec0\u4e48\u60f3\u6cd5\uff1f\u5bf9\u4e86\uff0c**\u6298\u534a\u641c\u7d22\uff01**\n\n\u4ee4 $mid=\\left\\lfloor\\frac{m+1}{2}\\right\\rfloor$\n\n\u6211\u4eec\u628a\u7ebf\u6027\u57fa\u5288\u6210\u4e24\u534a\u5206\u6210\u201c\u9ad8\u4f4d\" $(mid+1\\sim m)$ \u548c\u201c\u4f4e\u4f4d\u201d $(1\\sim mid)$ \u5206\u522b\u66b4\u529b\u679a\u4e3e\u3002\n\n\u4f4e\u4f4d\u597d\u529e\uff0c\u76f4\u63a5\u7edf\u8ba1\u5373\u53ef\u3002\u9ad8\u4f4d\u7531\u4e8e\u8fd8\u6709\u8d85\u51fa $2^{mid}$ \u7684\u90e8\u5206\u6240\u4ee5\u8fd8\u8981\u8bb0\u5f55\u4e00\u4e0b $\\mathrm{popcount}$\u3002\n\n\u8fd9\u4e00\u90e8\u5206\u590d\u6742\u5ea6\u662f $\\mathcal{O}(2^{mid})$ \n\n\u4e0b\u9762\u5c31\u662f\u5408\u5e76\u4e86\u3002\n\n\u7531\u4e8e $\\mathrm{popcount}$ \u53ea\u6709 $1\\sim m-mid+1$ \u6240\u4ee5\u628a\u8fd9 $m-mid+1$ \u79cd\u5206\u522b\u5408\u5e76\u5373\u53ef\u3002\n\n\u4ee4\u9ad8\u4f4d\u6784\u6210\u7684\u5e8f\u5217\u662f $f$ \uff0c\u4f4e\u4f4d\u6784\u6210\u7684\u5e8f\u5217\u662f $g$ \uff0c\u7ebf\u6027\u57fa\u6574\u4f53\u6784\u6210\u7684\u5e8f\u5217\u662f $h$ \u3002\uff08\u663e\u7136\u957f\u5ea6\u90fd\u4e3a $2^{mid}$ \uff09\n\n\n\u90a3\u4e48\u663e\u7136\uff1a$h$ \u662f $f$ \u4e2a $g$ \u7684 $\\operatorname{xor}$ \u5377\u79ef\u3002\n\n\u5373\uff1a\n\n$$h_i=\\sum\\limits_{j\\operatorname{xor}k=i}f_j\\times g_k$$\n\n\u8fd9\u4e2a\u76f4\u63a5\u7528 $\\mathrm{FWT}$ \u8ba1\u7b97\u5373\u53ef\u3002\n\n\u6bcf\u4e2a $h_i$ \u4f1a\u5bf9 $\\mathrm{popcount}(i)+c$ \u7684\u7b54\u6848\u4ea7\u751f\u8d21\u732e\u3002\uff08$c$ \u662f\u679a\u4e3e\u7684\u9ad8\u4f4d\u7684\u8d85\u51fa $2^{mid}$ \u7684\u90e8\u5206 $\\mathrm{popcount}$ \uff09\n\n\u8fd9\u90e8\u5206\u590d\u6742\u5ea6\u662f $\\mathcal{O}(2^{mid}\\times m^2)$ \n\n\u590d\u6742\u5ea6\u89e3\u91ca\uff1a$2^{mid}\\times m$ \u662f $\\mathrm{FWT}$ \u7684\u590d\u6742\u5ea6\uff0c\u5269\u4e0b\u7684\u4e00\u4e2a $m$ \u662f\u679a\u4e3e\u9ad8\u4f4d\u7684\u8d85\u51fa $2^{mid}$ \u7684\u90e8\u5206 $\\mathrm{popcount}$\u3002\n\n\u7b97\u4e00\u4e0b\u4e5f\u5c31 $10^8$ \u5de6\u53f3\uff0c\u65f6\u9650\u5f00\u4e86 $3s$ \uff0c\u53ef\u4ee5\u8f7b\u677e\u901a\u8fc7\u3002\n\n*code\uff1a*\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\nusing namespace std;\n#define N 400020\ntypedef long long ll;\nconst ll mod=998244353;\nint n,m,cnt,mid;\nll a[N],d[N],f[28][N],g[N],pcnt[N<<1],ans[N],tmp[N]; \nvoid Insert(ll x){             //\u52a0\u5230\u7ebf\u6027\u57fa\u91cc\n\tfor(int i=m-1;i>=0;--i){\n\t\tif((x>>i)&1){\n\t\t\tif(!d[i]){\n\t\t\t\td[i]=x,++cnt;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tx^=d[i];\n\t\t\t}\n\t\t}\n\t}\n}\nvoid dfs1(int u,ll num){\n\tif(u==mid-1){\n\t\tf[pcnt[num>>mid]][num&((1<<mid)-1)]++;\n\t\t\n\t\treturn;\n\t}\n\tdfs1(u-1,num);\n\tif(d[u]){\n\t\tdfs1(u-1,num^d[u]);\n\t}\n}\nvoid dfs2(int u,ll num){\n\tif(u==mid){\n\t\tg[num]++;\n\t\treturn;\n\t}\n\tdfs2(u+1,num);\n\tif(d[u]){\n\t\tdfs2(u+1,num^d[u]);\n\t}\n}\nll qpow(ll a,ll b){\n\tll ans=1;\n\twhile(b){\n\t\tif(b&1)ans=ans*a%mod;\n\t\ta=a*a%mod;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\nvoid XOR(ll *f,ll x,int n){  //FWT_XOR\n\tfor(int p=2;p<=n;p<<=1){\n\t\tint len=(p>>1);\n\t\tfor(int k=0;k<n;k+=p){\n\t\t\tfor(int i=k;i<k+len;++i){\n\t\t\t\tll t1=f[i]+f[i+len],t2=f[i]-f[i+len];\n\t\t\t\tf[i]=t1*x%mod,f[i+len]=t2*x%mod;\n\t\t\t}\n\t\t}\n\t}\n}\nint main(){\n\tn=read(),m=read();\n\tfor(int i=1;i<=n;++i){\n\t\ta[i]=read();\n\t\tInsert(a[i]);\n\t}\n\tmid=(m+1)>>1;\n\tfor(int i=1;i<=300000;++i){\n\t\tpcnt[i]=pcnt[i>>1]+(i&1);\n\t}\n\tdfs1(m-1,0);  //\u9ad8\u4f4e\u4f4d\u5206\u522b\u6298\u534a\u641c\u7d22\n\tdfs2(0,0);\n\tmemcpy(tmp,g,sizeof(g));\n\tfor(int i=0;i<=m-mid;++i){    //\u679a\u4e3e\u9ad8\u4f4d\u8d85\u51fa2^mid\u90e8\u5206\u7684popcount\n\t\tmemcpy(g,tmp,sizeof(g));\n\t\tXOR(f[i],1,1<<mid);\n\t\tXOR(g,1,1<<mid);\n\t\tfor(int j=0;j<(1<<mid);++j){\n\t\t\tf[i][j]=f[i][j]*g[j]%mod;\n\t\t}\n\t\tXOR(f[i],qpow(2LL,mod-2),1<<mid);\n\t\tfor(int j=0;j<(1<<mid);++j){\n\t\t\tans[i+pcnt[j]]=(ans[i+pcnt[j]]+f[i][j])%mod;\n\t\t}\n\t}\n\tfor(int i=0;i<=m;++i){\n\t\tprintf(\"%lld \",ans[i]*qpow(2LL,n-cnt)%mod);  //cnt\u662f\u7ebf\u6027\u57fa\u7684\u5927\u5c0f\uff0c\u522b\u5fd8\u4e86\u6700\u540e\u4e58 2^{n-cnt}\n\t}\n\treturn 0;\n}\n\n```\n\n[*Froggy's blog*](https://www.luogu.org/blog/1445353309froggy/)\n\n#### \u5471!!\n\n\n",
        "postTime": 1587002158,
        "uid": 100285,
        "name": "Froggy",
        "ccfLevel": 10,
        "title": "\u9898\u89e3 CF1336E1 \u3010Chiori and Doll Picking (easy version)\u3011"
    },
    {
        "content": "## CF1336E1 \u9898\u89e3\n\n#### \u9898\u610f\u8fd9\u91cc\u4e0d\u518d\u8d58\u8ff0\u5566\n\n[CF1336E1 Chiori and Doll Picking (easy version)](https://www.luogu.com.cn/record/58983495)\n\n#### \u6574\u4f53\u601d\u8def\n\n\u5f02\u6216\u8fd9\u79cd\u4e1c\u897f\u770b\u8d77\u6765\u5c31\u5f88\u50cf\u662f\u8981\u7528\u7ebf\u6027\u57fa\u641e\uff0c\u7136\u540e\u6211\u4eec\u53d1\u73b0\u5b83\u786e\u5b9e\u53ef\u4ee5\u7528\u7ebf\u6027\u57fa\u641e\u3002\n\n\u6211\u4eec\u77e5\u9053\u7ebf\u6027\u57fa\u4e92\u76f8\u5f02\u6216\u80fd\u5f97\u5230\u539f\u6765\u8fd9\u4e9b\u6570\u4e92\u76f8\u5f02\u6216\u7684\u6240\u6709\u7ed3\u679c\uff0c\u4f46\u95ee\u9898\u662f\u8fd9\u91cc\u9762 $0$ \u662f\u4e0d\u4f1a\u51fa\u73b0\u7684\u3002\u6bcf\u6b21\u52a0\u5143\u7d20\u540e\u6ca1\u80fd\u6210\u529f\u52a0\u5165\u8bf4\u660e\u6709\u5143\u7d20\u4e92\u76f8\u5f02\u6216\u80fd\u5f97\u5230\u5b83\uff0c\u90a3\u5b83\u5c31\u4f1a\u6210\u4e3a\u4e00\u4e2a\u201c\u81ea\u7531\u5143\u201d\u3002\n\n\u5bf9\u4e8e\u7ebf\u6027\u57fa\u4e2d\u4efb\u4f55\u4e00\u4e2a\u80fd\u5f02\u6216\u51fa\u7684\u5143\u7d20\uff0c\u90fd\u6709 $2^{fr}$ \u79cd\u65b9\u6848\u80fd\u7ed9\u5b83\u5f02\u6216\u51fa\u6765\uff0c\u5176\u4e2d $fr$ \u4ee3\u8868\u81ea\u7531\u5143\u4e2a\u6570\u3002\n\n\u5982\u4f55\u8bc1\u660e\uff1f\u8003\u8651\u9996\u5148\u7528\u7ebf\u6027\u57fa\u5f02\u6216\u51fa\u6765\u5b83\uff0c\u7136\u540e\u5728\u81ea\u7531\u5143\u91cc\u9762\u4efb\u53d6\u4e00\u4e9b\u5143\u7d20\u5f02\u6216\u8fdb\u53bb\uff0c\u518d\u7528\u7ebf\u6027\u57fa\u5185\u7684\u5143\u7d20\u7ed9\u8fd9\u4e9b\u81ea\u7531\u5143\u5f02\u6216\u7ed3\u679c\u5f02\u6216\u6210 $0$ \u90a3\u4e48\u5c31\u8fd8\u662f\u539f\u6765\u7684\u6570\u3002**\u6ce8\u610f\u8fd9\u91cc\u7ebf\u6027\u57fa\u5f02\u6216\u65f6\u76f4\u63a5\u770b\u6210\u53d6\u4efb\u610f\u4e2a\u5747\u53ef\u4ee5\u5c31\u53ef\u4ee5\u4e86**\uff0c\u56e0\u4e3a\u5f02\u6216\u5947\u6570\u4e2a\u5c31\u662f\u5f02\u6216\uff0c\u5076\u6570\u4e2a\u5c31\u662f\u4e0d\u5f02\u6216\uff0c\u6240\u4ee5\u4e0d\u5b58\u5728\u95ee\u9898\u3002\n\n#### DP \u601d\u8def\n\n\u7136\u540e\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u8f6c\u5316\u4e3a DP \u95ee\u9898\u3002\u6ce8\u610f\u7ebf\u6027\u57fa\u7684\u4f18\u79c0\u6027\u8d28\uff1a**\u4f4e\u4f4d\u7684\u5411\u91cf\u5728\u9ad8\u4f4d\u662f\u6ca1\u6709\u53d6\u503c\u7684**\uff0c\u90a3\u5047\u8bbe\u6211\u4eec**\u4ece\u9ad8\u5230\u4f4e\u4e00\u4f4d\u4e00\u4f4d\u8003\u8651\u57fa\u5e95**\uff0c\u6bcf\u6b21\u5f02\u6216\u4f4e\u4f4d\u7684\u57fa\u5e95\u65f6\u9ad8\u4f4d\u90a3\u4e9b\u4e0d\u4f1a\u53d1\u751f\u6539\u53d8\uff0c\u8fd9\u5c31\u4e3a DP \u63d0\u4f9b\u4e86\u65b9\u4fbf\u3002\n\n\u90a3\u8003\u8651**\u4ec0\u4e48\u4fe1\u606f\u662f\u6211\u4eec\u9700\u8981\u7684**\uff0c\u5047\u8bbe\u73b0\u5728\u8003\u8651\u5230\u4e86\u7b2c $i$ \u4f4d\u7684\u57fa\u5e95\uff0c\u90a3\u6211\u4eec\u53ea\u9700\u8981\u77e5\u9053\uff1a\u5927\u4e8e\u7b49\u4e8e $i$ \u4f4d\u5171\u6709\u591a\u5c11\u4e2a $1$\uff0c\u4f4e\u4e8e $i$ \u4f4d\u662f\u4e2a\u4ec0\u4e48\u72b6\u6001\u3002\n\n\u5927\u4e8e\u7b49\u4e8e $i$ \u4f4d\u8fd9\u4e9b\u5728\u63a5\u4e0b\u6765\u7684\u8f6c\u79fb\u91cc\u9762\u90fd\u4e0d\u4f1a\u53d1\u751f\u6539\u53d8\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u6765\u7edf\u8ba1\u6743\u503c\u3002\u5c0f\u4e8e $i$ \u4f4d\u7684\u7528\u4e8e\u66f4\u4f4e\u4f4d\u5f02\u6216\u7684\u8fd0\u7b97\u3002\u6211\u4eec\u53d1\u73b0\u8fd9\u4e24\u4e2a\u4fe1\u606f\u5f88\u597d\u7ef4\u62a4\u3002\n\n\u90a3\u53ef\u4ee5\u8bbe $f_{i,j,s}$ \u8868\u793a\u8003\u8651\u5230\u7b2c $i$ \u4f4d\u7684\u57fa\u5e95\uff0c\u5927\u4e8e\u7b49\u4e8e $i$ \u4f4d\u7684\u6709 $j$ \u4e2a $1$\uff0c\u5c0f\u4e8e $i$ \u4f4d\u7684\u72b6\u6001\u4e3a $s$ \u65f6\u7684\u65b9\u6848\u603b\u6570\uff0c\u6bcf\u5230\u4e00\u4f4d\u5206\u6210\u4e24\u79cd\u60c5\u51b5\u5f02\u6216\u5f53\u524d\u57fa\u5e95\u548c\u4e0d\u5f02\u6216\u5f53\u524d\u57fa\u5e95\u8ba8\u8bba\u5373\u53ef\u3002\n\n#### \u590d\u6742\u5ea6\u5206\u6790\n\n\u6734\u7d20\u5730\u770b\u72b6\u6001\u6570\u662f $O(2^mm^2)$ \u7684\uff0c\u4f46\u5176\u5b9e\u7b2c\u4e00\u7ef4\u53ef\u4ee5\u6eda\u52a8\u6389\uff0c\u4f46\u8fd9\u4e0d\u5f71\u54cd\u65f6\u95f4\u590d\u6742\u5ea6\u3002\n\n\u5bf9\u4e8e\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u6211\u4eec\u53d1\u73b0\u5bf9\u4e8e\u5927\u4e8e $\\frac{m}{2}$ \u7684\u4f4d\u7f6e\uff0c\u72b6\u6001\u6570\u88ab\u57fa\u5e95\u6570\u91cf\u9650\u5236\uff0c\u4e5f\u5c31\u662f\u72b6\u6001\u4e0d\u8d85\u8fc7 $O(2^{\\frac{m}{2}})$\uff0c\u800c\u5bf9\u4e8e\u5c0f\u4e8e $\\frac{m}{2}$ \u7684\u4f4d\u7f6e\uff0c\u72b6\u6001\u6570\u88ab\u4f4d\u6570\u9650\u5236\uff0c\u72b6\u6001\u4e5f\u662f\u4e0d\u8d85\u8fc7 $O(2^{\\frac{m}{2}})$ \u7684\u3002\n\n\u5206\u6790\u4e0b\u6765\u5f97\u5230\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(2^{\\frac{m}{2}}m^2)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a $O(2^{\\frac{m}{2}}m)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n#### \u5b9e\u73b0\u7ec6\u8282\n\n\u770b\u524d\u9762\u5927\u4f6c\u7684\u9898\u89e3\u662f\u9884\u5904\u7406\u4e86\u6240\u6709\u4f4e\u4f4d\u7684\u72b6\u6001\u7684\u7b54\u6848\u3002\u8fd9\u91cc\u6211\u76f4\u63a5\u4e00\u8d77\u7b97\uff0c\u7528 unordered_map \u5b58\u6389\u6700\u540e\u4e00\u7ef4\u3002\u540c\u65f6\u7528 queue \u6765\u5b58\u4e0b\u4e0a\u4e00\u4f4d\u6709\u503c\u7684\u72b6\u6001\u6765\u8f6c\u79fb\u5373\u53ef\u3002\n\n\u6ce8\u610f\u53ef\u80fd\u6709\u4e9b\u57fa\u5e95\u503c\u662f $0$\uff0c\u4e00\u6982\u800c\u8bba\u4f1a\u5bfc\u81f4\u7b54\u6848 $\\times 2$\uff0c\u8fd9\u91cc\u6211\u6bd4\u8f83\u61d2\uff0c\u76f4\u63a5\u7279\u5224\u7136\u540e\u628a\u7b54\u6848\u7cfb\u6570 $fr$ \u9664 $2$\u3002\n\n#### \u8d34\u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define lint long long\nusing namespace std;\ninline lint read(){\n\tchar c;lint f=1,res=0;\n\twhile(c=getchar(),!isdigit(c))if(c=='-')f*=-1;\n\twhile(isdigit(c))res=res*10+c-'0',c=getchar();\n\treturn res*f;\n}\nconst lint B=36,md=998244353;\nlint b[B+1],fr=1,n,m,ans[B+1]={0},iv2;\nlint qpow(lint x,lint y){\n\tlint r=1;\n\twhile(y){\n\t\tif(y&1)r=r*x%md;\n\t\tx=x*x%md;y>>=1;\n\t}return r;\n}\nvoid inst(lint x){\n\tfor(int i=B;i>=0;--i){\n\t\tif(!((x>>i)&1))continue;\n\t\tif(b[i])x^=b[i];\n\t\telse{b[i]=x;return;}\n\t}\n\tfr=fr*2%md;\n}\nstruct st{lint w,s;};\n//w\u4e3a1\u7684\u4e2a\u6570 s\u4e3a\u72b6\u6001 \nunordered_map<lint,lint> f[2][B];\n//f[0/1][i][j]\u8868\u793a\u5728\u5927\u4e8e\u7b49\u4e8e\u5f53\u524d\u4f4d\u7684\u4f4d\u7f6e\u6709i\u4e2a1 \n//\u5c0f\u4e8e\u5f53\u524d\u4f4d\u7684\u4f4d\u7f6e\u72b6\u6001\u4e3aj\u7684\u65b9\u6848\u603b\u6570 \nqueue<st> q[2];//\u4e0a\u4e00\u4f4d\u6709\u503c\u7684\u72b6\u6001 \nint main(){\n\tn=read();m=read();\n\tfor(int i=1;i<=n;++i)\n\t\tinst(read());\n\tint cu=1,pr=0;iv2=qpow(2,md-2);\n\tq[cu].push(st{0,0});f[cu][0][0]=1;\n\tfor(int i=m;i>=0;--i){\n\t\tif(!b[i])fr=fr*iv2%md;\n\t\t//\u5f53\u524d\u4f4d\u6ca1\u6709\u5c31\u9664\u4e2a2,\u56e0\u4e3a\u76f4\u63a5\u7b97\u7b54\u6848\u4f1a\u7ffb\u500d \n\t\tcu^=1;pr^=1;\n\t\twhile(!q[pr].empty()){\n\t\t\t//\u679a\u4e3e\u524d\u9762\u88ab\u8f6c\u79fb\u7684\u72b6\u6001\n\t\t\tst u=q[pr].front();q[pr].pop();\n\t\t\tif(!f[pr][u.w][u.s])continue;//\u9632\u6b62\u91cd\u590d\u8f6c\u79fb \n\t\t\tst v;lint t;//\u65b0\u72b6\u6001 \n\t\t\t//\u4e0d\u5f02\u6216\u5f53\u524d\u503c\n\t\t\tt=u.s;\n\t\t\tv.w=u.w+((t>>i)&1);//\u52a0\u4e0a\u7b2ci\u4f4d\u8d21\u732e \n\t\t\tv.s=t&((1LL<<i)-1);//\u53bb\u6389\u7b2ci\u4f4d \n\t\t\tf[cu][v.w][v.s]+=f[pr][u.w][u.s];\n\t\t\tf[cu][v.w][v.s]%=md;\n\t\t\tq[cu].push(v);\n\t\t\t//\u5f02\u6216\u5f53\u524d\u503c \n\t\t\tt=u.s^b[i];\n\t\t\tv.w=u.w+((t>>i)&1);//\u52a0\u4e0a\u7b2ci\u4f4d\u8d21\u732e \n\t\t\tv.s=t&((1LL<<i)-1);//\u53bb\u6389\u7b2ci\u4f4d\n\t\t\tf[cu][v.w][v.s]+=f[pr][u.w][u.s];\n\t\t\tf[cu][v.w][v.s]%=md;\n\t\t\tq[cu].push(v); \n\t\t\t//\u8f6c\u79fb\u4e4b\u540e\u53d8\u4e3a0\u9632\u6b62\u91cd\u590d\u8d21\u732e \n\t\t\tf[pr][u.w][u.s]=0;\n\t\t}\n\t}\n\t//\u5f53\u7b2c0\u4f4d\u8f6c\u79fb\u7ed3\u675f\u4e4b\u540e\u7edf\u8ba1\u7b54\u6848 \n\twhile(!q[cu].empty()){\n\t\tst u=q[cu].front();\n\t\tq[cu].pop();\n\t\tans[u.w]=(ans[u.w]+f[cu][u.w][u.s])%md;\n\t\tf[cu][u.w][u.s]=0;\n\t}\n\tfor(int i=0;i<=m;++i)\n\t\tprintf(\"%lld \",fr*ans[i]%md);\n\treturn 0;\n}\n```",
        "postTime": 1633314765,
        "uid": 206258,
        "name": "SDNetFriend",
        "ccfLevel": 7,
        "title": "CF1336E1 Chiori and Doll Picking (easy version) \u9898\u89e3"
    },
    {
        "content": "\u662f\u7684,\u8fd9\u9898\u662f\u72b6\u538b\n\n## Part0\n\n\u5bf9\u4e8e\u7ebf\u6027\u57fa\u91cc\u4efb\u610f\u53ef\u8868\u793a\u51fa\u7684\u503cw,\u90fd\u6709$2^{\\text{\u81ea\u7531\u5143}}$\u79cd\u65b9\u6848\u6765\u51d1\u51fa\n\n\u8bc1\u660e\u8003\u8651\u5bf9\u4e8e\u7ebf\u6027\u57fa\u5185\u90e8\u51d1\u9f50\u4ed6\u7684\u65b9\u6848\u6570\u663e\u7136\u552f\u4e00,\u540c\u65f6\u5728\u8003\u8651\u4efb\u610f\u9009\u53d6\u5916\u90e8\u5143\u7d20\u65f6,\u56e0\u4e3a\u7ebf\u6027\u57fa\u53ef\u4ee5\u5c06\u5916\u90e8\u5143\u7d20\u6d88\u4e3a0,\u56e0\u6b64\u4efb\u610f\u4e00\u79cd\u9009\u53d6\u65b9\u6848\u90fd\u5408\u6cd5,\u5373\u8fbe\u5230\u4e86\u8fd9\u4e2a\u4e0a\u754c\n\n\u4e8e\u662f\u73b0\u5728\u95ee\u9898\u5c31\u53d8\u6210\u4e86\u8ba1\u7b97\u8fd9\u4e2a\u7ebf\u6027\u57fa\u5185\u90e8\u8868\u793a\u51fa\u7684\u6240\u6709\u503c\u7684\u6743\u503c\u4e86\n\n\u6211\u4eec\u5c31\u6709\u4e86\u4e00\u4e2a$O(2^m*m)$\u7684\u597d\u505a\u6cd5\n\n## Part1\n\n\u8003\u8651\u600e\u4e48\u4f18\u5316\u8fd9\u4e2a\u4e8b\u60c5\n\n\u7b2c\u4e00\u4e2a\u601d\u8def\u662f\u8003\u8651\u4e0d\u9700\u8981\u4e00\u8d77\u679a\u4e3e\u6240\u6709\u6570\u768401\u9009\u53d6\u7ed3\u679c,\u800c\u662f\u5c06\u4ed6\u4eec\u5206\u5f00\u679a\u4e3e,\u7136\u540e\u60f3\u529e\u6cd5\u5408\u5e76\n\n\u505a\u6cd5\u5c31\u662f\u6298\u534a\u641c\u7d22,\u5148\u5f97\u5230\u524d$2^{mid}$\u548c\u540e$2^{mid}$\u9009\u53d6\u7684\u7ed3\u679c,\u7136\u540e\u5229\u7528FWT\u5408\u5e76\u5373\u53ef$O(2^{mid}*m^2)$\n\n## Part2\n\n\u53e6\u4e00\u4e2a\u60f3\u6cd5\u5c31\u662f\u72b6\u538bDP,\u6211\u4eec\u6ce8\u610f\u5230\u7ebf\u6027\u57fa\u6709\u4e00\u4e2a\u5f88\u4f18\u79c0\u7684\u6027\u8d28,**\u4f4e\u4f4d\u7684\u5411\u91cf\u5728\u9ad8\u4f4d\u5904\u662f\u6ca1\u6709\u53d6\u503c\u7684**,\u5373\u5bf9\u4e8e$j<i$\u5904\u7684\u5411\u91cfj\u5728i\u5904\u7684\u53d6\u503c\u4e00\u5b9a\u662f0,\u8fd9\u6837\u5c31\u4fdd\u8bc1\u4e86\u6211\u4eec\u7684\u65e0\u540e\u6548\u6027\n\n$dp_{i,j,S}$\u8868\u793a\u524di\u4e2a\u5411\u91cf,\u7136\u540e\u5bf9\u4e8e\u5927\u4e8e\u7b49\u4e8ei\u7684\u4f4d\u7f6e\u6211\u4eec\u6709j\u4e2a\u4f4d\u6570\u4e3a1,\u7136\u540e\u5269\u4e0b\u4f4e\u4e8ei\u4f4d\u7684\u5f53\u524d\u5f02\u6216\u548c\u4e3aS\u7684\u65b9\u6848\u6570\u662f\u4ec0\u4e48\n\n\u8fd9\u4e2a\u72b6\u6001\u6709\u4e2a\u5f62\u8c61\u7684\u89e3\u91ca\n\n![tupian](https://cdn.luogu.com.cn/upload/image_hosting/7rdldtyh.png)\n\n\u4e8e\u662f\u6211\u4eec\u679a\u4e3e\u7b2ci+1\u4e2a\u5411\u91cf\u662f\u5426\u9009\u62e9,\u5bf9\u5e94\u7684\u53ef\u4ee5\u786e\u5b9a\u7b2ci\u4f4d\u662f0\u6216\u80051,\u8d21\u732e\u5230j\u72b6\u6001\u91cc,\u5e76\u4e14\u9012\u5f52\u5230\u5269\u4f59S\u96c6\u5408\u66f4\u5c0f\u7684\u72b6\u6001\u5373\u53ef\n\n\u4f46\u662f\u663e\u7136\u76f4\u63a5dp\u7684\u590d\u6742\u5ea6\u662f$O(2^m*m^2)$...\n\n\u4e0d\u8fc7\u4f60\u9700\u8981\u601d\u8003\u6211\u4eec\u72b6\u6001\u6570\u53ef\u80fd\u8fbe\u5230$2^m$\u8fd9\u4e2a\u4e0a\u754c\u5417?\n\n\u663e\u7136\u4e0d\u53ef\u80fd!\u56e0\u4e3a\u6bcf\u4e2a\u6570\u53ea\u4f1a\u6709\u9009\u62e9\u6216\u8005\u4e0d\u9009\u62e9\u8fd9\u4e24\u4e2a\u9009\u9879,\u56e0\u6b64\u5728mid\u6b21\u51b3\u7b56\u4e2d,\u6211\u4eec\u672c\u8d28\u4e0d\u540c\u7684\u72b6\u6001\u81f3\u591a$2^{mid}$\u79cd\n\n\u540c\u65f6\u5728\u540emid\u6b21\u51b3\u7b56\u4e2d,\u56e0\u4e3aS\u96c6\u5408\u5927\u5c0f\u7531$m-i$\u51b3\u5b9a,\u56e0\u6b64\u4e5f\u4e0d\u4f1a\u8d85\u8fc7$2^{mid}$\n\n\u56e0\u6b64\u6211\u4eec\u53ea\u9700\u8981\u679a\u4e3e\u6709\u7528\u7684\u72b6\u6001\u5373\u53ef,\u4e0d\u8fc7\u5b9e\u73b0\u8d77\u6765\u53ea\u9700\u8981\u5411\u66b4\u529b\u524dmid\u4e2a\u6570,\u7136\u540e\u4f5c\u4e3a\u521d\u59cb\u5316\u72b6\u6001\u7ed9\u540emid\u4e2a\u6570dp\u7528\u5373\u53ef\n\n\u590d\u6742\u5ea6\u8fd8\u662f$O(2^{mid}m^2)$\n\n```cpp\n\n\n#include<bits/stdc++.h>\n#define int long long\n#define ll long long\nusing namespace std;\nconst int MAXN = 2e5 + 7;\nconst int P = 998244353;\n\nint B = 35;\nint n, m, a[MAXN], b[MAXN], cnt;\n\ninline int ksm(int x, int y) {\n\tint ans = 1;\n\twhile(y) {\n\t\tif(y & 1)ans = ans * x % P;\n\t\tx = x * x % P;\n\t\ty >>= 1;\n\t}\n\treturn ans;\n}\n\ninline int add(int x, int y) {\n\tx += y;\n\tif(x >= P)x -= P;\n\treturn x;\n}\n\ninline void ins(int x) {\n\tfor(int i = B; i >= 0; --i) {\n\t\tif(x >> i & 1) {\n\t\t\tif(!b[i]) {\n\t\t\t\tb[i] = x;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tx ^= b[i];\n\t\t}\n\t}\n\treturn;\n}\n\nint f[36][MAXN], g[36][MAXN];\n\ninline void init() {\n\tint t = m - m / 2;\n\tint mS = (1 << t) - 1;\n\tint qS = (1 << ((m / 2))) - 1;\n\tfor(int S = 0; S <= mS; ++S) {\n\t\tll p = 0;\n\t\tbool flg = 1;\n\t\tfor(int j = 0; j < t; ++j)\n\t\t\tif(S >> j & 1) {\n\t\t\t\tif(!b[j + m / 2]) {\n\t\t\t\t\tflg = 0;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tp ^= b[j + m / 2];\n\t\t\t}\n\t\tif(!flg)continue;\n\t\tint tmp = 0;\n\t\tfor(int j = m / 2; j <= B; ++j)\n\t\t\tif(p >> j & 1)\n\t\t\t\ttmp++;\n\t\tf[tmp][p & qS]++;\n\t}\n\treturn ;\n}\n\ninline void solve() {//\u6740\u6b7b\u5730\u7cbe!\n\tinit();\n\tint t = m / 2 - 1;\n\tint mS = (1 << (t + 1)) - 1;\n\tfor(int i = t + 1; i >= 1; --i) {\n\t\tmS = (1 << i) - 1; //\u53ea\u6709\u8fd9\u4e9b\u81ea\u7531\u4f4d\u4e86\n\t\tfor(int k = 0; k <= m - i; ++k) {//\u679a\u4e3e\u9ad8\u4f4d\u6302\u6389\u4e86\u51e0\u4e2a,\u522b\u592a\u591a\u4e86\u5427?\n\t\t\tfor(int S = 0; S <= mS; ++S) {//\u8bd5\u770b\u770b!\n\t\t\t\tif(S >> (i - 1) & 1) {\n\t\t\t\t\tg[k + 1][S ^ (1 << (i - 1))] = add(g[k + 1][S ^ (1 << (i - 1))], f[k][S]); //\u76f4\u63a5\u505a!\n\t\t\t\t\tif(b[i - 1])\n\t\t\t\t\t\tg[k][S ^ b[i - 1]] = add(g[k][S ^ b[i - 1]], f[k][S]);\n\t\t\t\t} else {\n\t\t\t\t\tg[k][S] = add(g[k][S], f[k][S]); //\u76f4\u63a5\u505a!\n\t\t\t\t\tif(b[i - 1])\n\t\t\t\t\t\tg[k + 1][S ^ b[i - 1] ^ (1 << (i - 1))] =\n\t\t\t\t\t\t\tadd(f[k][S], g[k + 1][S ^ b[i - 1] ^ (1 << (i - 1))]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tmS = (1 << i) - 1;\n\t\tfor(int k = 0; k <= m - i + 1; ++k) {\n\t\t\tfor(int S = 0; S <= mS; ++S) {\n\t\t\t\tf[k][S] = g[k][S];\n\t\t\t\tg[k][S] = 0;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i = 0; i <= m; ++i) {\n\t\tprintf(\"%lld \", 1ll * f[i][0] * cnt % P);\n\t}\n\tputs(\"\");\n\treturn;\n}\n\nsigned main() {\n\tscanf(\"%lld%lld\", &n, &m);\n\tfor(int i = 1; i <= n; ++i) {\n\t\tscanf(\"%lld\", &a[i]);\n\t\tins(a[i]);\n\t}\n\tcnt = 0;\n\tfor(int i = 0; i <= m; ++i) {\n\t\tif(b[i]) {\n\t\t\tcnt++;\n\t\t\tB = i;\n\t\t}\n\t}\n\tcnt = n - cnt;\n\tcnt = ksm(2, cnt);\n\tsolve();\n\treturn 0;\n}\n\n\n```",
        "postTime": 1616803986,
        "uid": 76990,
        "name": "loveJY",
        "ccfLevel": 9,
        "title": "CF1336E1 Chiori and Doll Picking (easy version)"
    }
]
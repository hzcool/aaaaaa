[
    {
        "content": "\u5f88\u597d\u7684\u4e00\u9053\u77e9\u9635\u52a0\u901f\u9898\u3002\n\n\u9898\u76ee\u5927\u610f:\u7ed9\u5b9a\u96c6\u5408$A$\uff0c\u4e00\u957f\u4e3a$k$\u7684\u6570\u7ec4$B$\u4e2d\u6ee1\u8db3\uff1a\n\n$\n\\begin{cases}\n\\forall i,b_i \\in A\\\\\n\\forall 1\\leq i < k,\\operatorname{popcount}(b_i \\oplus b_{i+1})|3 \\\\\n\\end{cases}\n$\n\n\n\n\u6c42\u65b9\u6848\u6570\u3002\n\n\u8fd9\u9898\u8fd8\u662f\u82b1\u4e86\u70b9\u65f6\u95f4\u7684\u3002\u4f17\u6240\u5468\u77e5$CF$\u4e0d\u4f1a\u7ed9\u90e8\u5206\u5206\u6570\u636e\u8303\u56f4\uff0c\u4f46\u662f\u7ffb\u8bd1\u8005\u6bd4\u8f83\u826f\u5fc3\uff0c\u987a\u5e26\u7ed9\u4e86\u4e2a\u5bf9\u4e8e$40\\%$\u7684\u6570\u636e$k\\leq 10^4$\uff08~~\u54b1\u4e5f\u4e0d\u77e5\u9053\u662f\u4e0d\u662f\u771f\u7684~~\uff09\u3002\u8fd9\u4e2a\u6570\u636e\u7ed9\u4e86\u6211\u4eec\u63d0\u793a\u2014\u2014\u53ef\u4ee5\u5148\u60f3\u5c0f\u8303\u56f4\u7136\u540e\u4f18\u5316\u3002\n\n\u8003\u8651\u5230\u6bcf\u4e2a\u5143\u7d20\u7684\u9009\u53d6\u6761\u4ef6\u53ea\u4e0e\u4ed6\u76f8\u90bb\u7684\u6709\u5173\uff0c\u6240\u4ee5\u8003\u8651\u4e00\u4e0b$DP$\n\n\u6211\u4eec\u8bbe$dp_{i,j}$\u8868\u793a$B$\u6570\u7ec4\u957f\u5ea6$i$\uff0c\u7b2c$i$\u4e2a\u5143\u7d20\u662f$a_j$\u7684\u65f6\u5019\u7684\u65b9\u6848\u6570\u3002\n\n\u56e0\u4e3a\u53ea\u6709\u76f8\u90bb\u7684\u4f1a\u9650\u5236\u6761\u4ef6\uff0c\u6211\u4eec\u8003\u8651\u7528\u540e\u9762\u7684\u9650\u5236\u524d\u9762\u7684\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u6570\u5b57$a_j$\u653e\u5728$b_i$\u8fd9\u4e2a\u4f4d\u7f6e\u4e0a\u5408\u6cd5\u5f53\u4e14\u4ec5\u5f53$\\operatorname{popcount}(a_j\\oplus b_i)\\ |\\ 3$\n\n\u6240\u4ee5\u6211\u4eec\u6709\u9012\u63a8\u5f0f$dp_{i,j}=\\sum\\limits_{k=1}^{n}dp_{i-1,k}\\times [\\operatorname{popcount}(a_k\\oplus a_j\\ | \\ 3)]$\u3002\n\n\u8fb9\u754c\u5c31\u662f\u5f53$i=1$\u65f6\uff0c$dp_{i,j}=1$\n\n\u6700\u540e\u7684\u7b54\u6848\u81ea\u7136\u5c31\u662f$\\sum \\limits_{i=1}^{n} dp[k][i]$\n\n\u8fd9\u4e2a\u65b9\u6cd5\u7684\u590d\u6742\u5ea6\u662f$O(nklog_2a)$\uff08\u679a\u4e3e\u4f4d\u7f6e+\u679a\u4e3e\u5143\u7d20+\u8ba1\u7b97$\\operatorname{popcount}$\uff09\n\n\u5230\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u5f00\u59cb\u4f18\u5316\u4e86\u3002\n\n\u5404\u4f4d\u770b\u5b98\u6709\u6ca1\u6709\u53d1\u73b0\u4ec0\u4e48\uff1f\n\n\u6211\u4eec\u7684$DP$\u5f0f\u5b50\u957f\u8fd9\u6837\n\n$dp_{i,j}=\\sum\\limits_{k=1}^{n}dp_{i-1,k}\\times [\\operatorname{popcount}(a_k\\oplus a_j\\ | \\ 3)]$\u3002\n\n\u5728\u6bcf\u4e00\u6b21\u8fc7\u7a0b\u4e2d\uff0c\u5bf9\u4e8e\u76f8\u540c\u7684$j$\uff0c\u4e0d\u8bba$i$\u7684\u53d6\u503c\uff0c\u80fd\u591f\u8f6c\u79fb\u5230$j$\u4e0a\u7684$k$\u662f\u4e0d\u53d8\u7684\u3002\n\n\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u53ef\u4ee5\u8003\u8651\u4e00\u4e0b\u77e9\u9635\u52a0\u901f\u4e86\u3002\n\n\u6211\u4eec\u77e5\u9053\u6211\u4eec\u7684\u77e9\u9635$C$\u5e94\u8be5\u6ee1\u8db3\uff1a\n\n$\\begin{bmatrix}\ndp_{i,1}&dp_{i,2}\\cdots dp_{i,n}\n\\end{bmatrix}\n\\times \\begin{bmatrix}\nC_{1,1}&\\cdots&C_{1,n}\\\\\n\\vdots&\\ddots&\\vdots\\\\\nC_{n,1}&\\cdots&C_{n,n}\n\\end{bmatrix}\n=\\begin{bmatrix}\ndp_{i+1,1}&dp_{i+1,2}\\cdots dp_{i+1,n}\n\\end{bmatrix}$\n\n\u7ed3\u5408\u9012\u63a8\u5f0f\uff0c\u6211\u4eec\u53d1\u73b0$C_{i,j}\\in{\\{0,1\\}}$\n\n\u7ed3\u5408\u77e9\u9635\u4e58\u6cd5\u7684\u65b9\u6cd5\u6211\u4eec\u6709$dp_{i+1,j}=\\sum\\limits_{k=1}^{n}dp_{i,k}\\times C_{k,j}=\\sum\\limits_{k=1}^{n}dp_{i,k}\\times [\\operatorname{popcount}(a_k\\oplus a_j\\ | \\ 3)]$\n\n\u4e8e\u662f\u6211\u4eec\u53d1\u73b0$C_{k,j}=[\\operatorname{popcount}(a_k\\oplus a_j\\ | \\ 3)]$\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u6109\u5feb\u7684\u6c42\u51fa\u8f6c\u79fb\u77e9\u9635\u5566\u3002\n\n\u76f4\u63a5\u77e9\u9635\u5feb\u901f\u5e42\u52a0\u901f\u5373\u53ef\u3002\n\n\u634e\u5e26$AC$\u4ee3\u7801\u4e00\u4efd\uff1a\n\n```\n#include <bits/stdc++.h>\nusing namespace std;\ninlind re(int &x) {\n    x=0;\n    bool f=0;\n    int w=getchar();\n    while(w<'0'||w>'9'){if(w=='-')f = 1;w=getchar();}\n    while(w<='9'&&w>='0')x=(x<<3)+(x<<1)+w-'0',w=getchar();\n    if(f)x=-x;\n}\n\ninlint poc(int x){\n    int res=0;\n    while(x)res+=x&1,x>>=1;\n    return res;\n}\nconst int M=1e9+7;\nint a[110];\nint ok[110][110];\nstruct mat{\n    int n,m;\n    int t[110][110];\n    mat operator *(const mat x){\n        mat c;\n        c.n=n;\n        c.m=x.m;\n        mem0(c.t);\n        if(m!=x.n) return c;\n        for(int i=1;i<=n;i++)\n            for(int j=1;j<=x.m;j++)\n                for(int k=1;k<=m;k++)\n                    c.t[i][j]=(c.t[i][j]+t[i][k]*x.t[k][j]%M)%M;\n        return c;\n    }\n    mat unit(){\n        mat c;\n        c.n=n;\n        c.m=n;\n        mem0(c.t);\n        for(int i=1;i<=n;i++)c.t[i][i]=1;\n        return c;\n    }\n};\nmat m_qp(mat a,int x){\n    mat ans=a.unit();\n    while(x){\n        if(x&1)ans=ans*a;\n        a=a*a;\n        x>>=1;\n    }\n    return ans;\n}\nint n,k;\nsigned main(){\n    re(n);\n    re(k);\n    mat y;\n    y.n=y.m=n;\n    mem0(y.t);\n    mat o;\n    o.n=1;\n    o.m=n;\n    mem0(o.t);\n    for(int i=1;i<=n;i++)re(a[i]);\n    for(int i=1;i<=n;i++)\n        for(int j=1;j<=n;j++)\n            if(poc(a[i]^a[j])%3==0)y.t[i][j]=1;\n          \n    for(int i=1;i<=n;i++)o.t[1][i]=1;\n    mat op=m_qp(y,k-1);\n    o=o*op;\n\n    int ans=0;\n    for(int i=1;i<=n;i++)ans+=o.t[1][i],ans%=M;\n    cout<<ans;\n    return 0;\n}\n```\n",
        "postTime": 1640267872,
        "uid": 455490,
        "name": "Jocker_CW",
        "ccfLevel": 8,
        "title": "CF691E\tXor-sequences \u9898\u89e3"
    },
    {
        "content": "### CF691E Xor-sequences\n\n\u6709\u4e00\u79cd\u601d\u8def\uff0c\u8003\u8651\u5230 $n$ \u5176\u5b9e\u5f88\u5c0f\uff0c\u6240\u4ee5\u53ef\u4ee5\u628a\u5f02\u6216\u540e\u7684\u6570\u4e8c\u8fdb\u5236\u4e0b\u53ea\u6709 3 \u7684\u500d\u6570\u4e2a 1 \u7684\u6570\u5b57\u4e4b\u95f4\u8fde\u4e00\u6761\u8fb9\u3002\n\n\u7b54\u6848\u5c31\u662f\u5728\u5efa\u51fa\u6765\u7684\u56fe\u4e0a\u95ee\u6709\u591a\u5c11\u6761\u7ecf\u8fc7\u70b9\u6570\u4e3a $k$ \u7684\u4e0d\u540c\u8def\u5f84\u3002\n\n\u6839\u636e\u9898\u610f\uff0c\u82e5 $\\exists i \\in [1,k]$ \uff0c\u4f7f\u5f97\u7b2c $x,y$ \u4e24\u6761\u8def\u5f84\u4e2d\uff0c\u7b2c $i$ \u4e2a\u7ecf\u8fc7\u7684\u70b9\u4e0d\u540c\uff0c\u5219\u79f0 $x,y$ \u8fd9\u4e24\u6761\u8def\u5f84\u4e0d\u540c\u3002\n\n\u6ca1\u6709\u89c1\u8fc7\u7c7b\u4f3c\u7684\u9898\u76ee\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5 yy \u4e00\u6ce2\u3002\n\n\u5148\u7b80\u5355\u5199\u4e2a\u65b9\u7a0b\uff1a\n\n$dp_{i,u}$ \u8868\u793a\u7b2c\u4ee5\u7b2c $u$ \u4e2a\u70b9\u4e3a\u7ec8\u70b9\u8def\u5f84\u957f\u5ea6\u4e3a $i$ \u7684\u8def\u5f84\u6709\u591a\u5c11\u6761\u3002\n\n$dp_{i,u}=\\Sigma_{v|(u,v)\\in E}dp_{i-1,v}$\u3002\n\n\u6539\u4e0b\u5f0f\u5b50\uff0c\u5c31\u662f\uff1a\n\n$dp_{i,u}=M_{u,v}*dp_{i-1,v}$\n\n\u6709\u77e9\u9635\u5feb\u901f\u5e42\u7684\u5473\u9053\u4e86\u3002\n\n\u90a3\u4e48 $dp_{i}=M*dp_{i-1}$ \uff0c\u5176\u4e2d $M$ \u662f\u4e00\u4e2a $n*n$ \u7684\u77e9\u9635\uff0c\u4e5f\u5c31\u662f\u7528\u90bb\u63a5\u8868\u5b58\u50a8\u7684\u56fe\u3002\n\n\u73b0\u5728\u8fd9\u9053\u9898\u5c31\u505a\u5b8c\u4e86\u3002\u3002\u3002\n\n\u4ee3\u7801\uff1a\n\n```c++\ntypedef long long ll;\nconst int N=105,mo=1e9+7;\nint n;\nll K,a[N],ans=0;\nstruct Matrix_M{\n\tll x[N][N];\n\tMatrix_M(){memset(x,0,sizeof(x));}\n\tvoid pre(){\n\t\tmemset(x,0,sizeof(x));\n\t\tfor(int i=1;i<=n;++i)\n\t\t\tx[i][i]=1;\n\t}\n\tfriend Matrix_M operator*(Matrix_M a,Matrix_M b){\n\t\tMatrix_M c;\n\t\tfor(int i=1;i<=n;++i)\n\t\tfor(int j=1;j<=n;++j)\n\t\tfor(int k=1;k<=n;++k)\n\t\t\tc.x[i][j]=(c.x[i][j]+a.x[i][k]*b.x[k][j])%mo;\n\t\treturn c;\n\t}\n\tvoid ksm(ll b){\n\t\tMatrix_M p;p.pre();\n\t\twhile(b){\n\t\t\tif(b&1)p=p*(*this);\n\t\t\t(*this)=(*this)*(*this);b>>=1;\n\t\t}\n\t\t*this=p;\n\t}\n}m;\nstruct Matrix_G{\n\tll x[N];\n\tMatrix_G(){memset(x,0,sizeof(x));}\n\tll & operator[](const int k){return x[k];}\n\tfriend Matrix_G operator*(Matrix_M a,Matrix_G b){\n\t\tMatrix_G c;\n\t\tfor(int i=1;i<=n;++i)\n\t\tfor(int k=1;k<=n;++k)\n\t\t\tc[i]=(c[i]+a.x[i][k]*b[k])%mo;\n\t\treturn c;\n\t}\n}g;\nbool ck(ll x){\n\tint res=0;\n\twhile(x){\n\t\tres++;\n\t\tx-=(x&(-x));\n\t}\n\treturn res%3==0;\n}\nint main(){\n\tread(n,K);\n\tfor(int i=1;i<=n;++i){\n\t\tg[i]=1;m.x[i][i]=1;\n\t\tread(a[i]);\n\t}\n\tfor(int i=1;i<=n;++i)\n\t\tfor(int j=i+1;j<=n;++j)\n\t\t\tif(ck(a[i]^a[j])){\n\t\t\t\tm.x[i][j]=1;\n\t\t\t\tm.x[j][i]=1;\n\t\t\t}\n\tm.ksm(K-1);\n\tg=m*g;\n\tfor(int i=1;i<=n;++i)\n\t\tans=(ans+g[i])%mo;\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1640406741,
        "uid": 137176,
        "name": "lazytag",
        "ccfLevel": 7,
        "title": "CF691E Xor-sequences \u9898\u89e3"
    },
    {
        "content": "## \u524d\u7f6e\u77e5\u8bc6\n\n- [\u77e9\u9635\u4e58\u6cd5](https://oi-wiki.org/math/matrix/#_5)\n\n## \u601d\u8def\n\n\u9898\u76ee\u6c42\u6784\u9020\u4e00\u4e2a\u957f\u5ea6\u4e3a $k$ \u7684\u5e8f\u5217\u7684\u65b9\u6848\u6570\uff0c\u9996\u5148\u60f3\u5230 DP\u3002\u8bbe $f_{len,i}$ \u8868\u793a\u957f\u5ea6\u4e3a $len$\uff0c\u6700\u540e\u4e00\u4e2a\u6570\u4e3a $a_i$ \u65f6\u7684\u65b9\u6848\u6570\u3002\n\n### 40 \u5206\u89e3\u6cd5\n\n\u53ef\u4ee5\u5faa\u73af\u9012\u63a8\u51fa\u7b54\u6848 $\\sum_{i=1}^n f_{k,i}$\uff0c\u66b4\u529b\u9012\u63a8\u5982\u4e0b\uff1a\n\n```cpp\nfor(int len=1;len<=k;len++){\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tint t=a[i]^a[j],cnt=0;\n\t\t\twhile(t){\n\t\t\t\tcnt++;\n\t\t\t\tt&=(t-1);\n\t\t\t}\n\t\t\tif(cnt%3==0){//\u5224\u65ad\n            \tf[len%2][i]+=f[(len-1)%2][j];//\u6eda\u52a8\u6570\u7ec4\n\t\t\t}\n\t\t}\n\t}\n}\n```\n\n### 100 \u5206\u89e3\u6cd5\n\n$k \\leq 10^{18}$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u663e\u7136\u7206\u70b8\uff0c\u4e8e\u662f\u8003\u8651\u4f18\u5316\u65b9\u5f0f\u3002\u770b\u5230\n$n$ \u5f88\u5c0f\uff0c$k$ \u5f88\u5927\uff0c\u5bb9\u6613\u60f3\u5230\u7528\u77e9\u9635\u4f18\u5316 DP\u3002  \n- \u6784\u9020\u4e00\u4e2a base \u77e9\u9635\u3002  \n\u7531\u4e8e\u6bcf\u4e00\u4e2a\u72b6\u6001 $f_{len,i}$ \u53ea\u4e0e\u5176\u4f59 $n$ \u4e2a\u72b6\u6001 $f_{len-1,j(1 \\leq j \\leq n)}$ \u6709\u5173\uff0c**\u56e0\u6b64 base \u77e9\u9635\u5927\u5c0f\u4e3a $n \\times n$\u3002**  \n\u7531\u4e8e\u53ea\u6709\u5f53 $a_i \\operatorname{xor} a_j$ \u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e2d 1 \u7684\u4e2a\u6570\u4e3a 3 \u7684\u500d\u6570\u65f6\uff0c\u9012\u63a8\u5f0f\u624d\u4f1a\u6210\u7acb\uff0c**\u56e0\u6b64\u5f53 $a_i \\operatorname{xor} a_j$ \u7684\u7ed3\u679c\u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e2d $1$ \u7684\u4e2a\u6570\u4e3a $3$ \u7684\u500d\u6570\u65f6\uff0c\u6211\u4eec\u4ee4 $base_{i,j}=base_{j,i}=1$\uff0c\u8fd9\u6837\u4fbf\u5f97\u5230\u4e86 base \u77e9\u9635\u3002**  \n- \u7136\u540e\u6784\u9020\u521d\u59cb\u65f6\u7684 f \u77e9\u9635 \n$\n\\begin{pmatrix}\n  1&0&\\cdots&0&0\\\\\n  1&0&\\cdots&0&0\\\\\n  \\vdots&\\vdots&\\ddots&\\vdots&\\vdots\\\\\n  1&0&\\cdots&0&0\\\\\n  1&0&\\cdots&0&0\n\\end{pmatrix}\n$\u3002  \n- \u5f97\u5230\u4e24\u4e2a\u77e9\u9635\u540e\uff0c\u8fd9\u9053\u9898\u5c31\u548c\u5176\u5b83\u77e9\u9635\u4e58\u6cd5\u9898\u76ee\u6ca1\u6709\u533a\u522b\u4e86\uff0c\u76f4\u63a5\u5199\u677f\u5b50\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int N=1e2+5;\nconst int mod=1e9+7;\nstruct mat{\n\tll f[N][N];\n}base,f;\nll n,k,a[N],ans;\nmat mat_mul(mat a,mat b){\n\tmat res;\n\tmemset(res.f,0,sizeof(res.f));\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tfor(int k=1;k<=n;k++){\n\t\t\t\tres.f[i][j]=(res.f[i][j]+(a.f[i][k]*b.f[k][j])%mod)%mod;\n\t\t\t}\n\t\t}\n\t}\n\treturn res;\n}\nmat mat_pow(mat a,ll p){\n\tmat res;\n\tmemset(res.f,0,sizeof(res.f));\n\tfor(int i=1;i<=n;i++){\n\t\tres.f[i][i]=1;\n\t}\n\twhile(p){\n\t\tif(p%2==1){\n\t\t\tres=mat_mul(res,a);\n\t\t}\n\t\ta=mat_mul(a,a);\n\t\tp/=2;\n\t}\n\treturn res;\n}\nint main(){\n\tscanf(\"%lld%lld\",&n,&k);\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%lld\",&a[i]);\n\t\tf.f[i][1]=1;//\u6784\u9020f\u77e9\u9635\n\t}\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=i;j<=n;j++){\n\t\t\tll t=a[i]^a[j],cnt=0;\n\t\t\twhile(t){\n\t\t\t\tcnt++;\n\t\t\t\tt&=(t-1);\n\t\t\t}\n\t\t\tif(cnt%3==0){\n\t\t\t\tbase.f[i][j]=base.f[j][i]=1;\n\t\t\t}\n\t\t}\n\t}//\u6784\u9020base\u77e9\u9635\n\tf=mat_mul(mat_pow(base,k-1),f);//\u77e9\u9635\u5feb\u901f\u5e42\n\tfor(int i=1;i<=n;i++){\n\t\tans=(ans+f.f[i][1])%mod;\n\t}\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1640600536,
        "uid": 344354,
        "name": "yanghanyv",
        "ccfLevel": 0,
        "title": "CF691E Xor-sequences \u9898\u89e3"
    },
    {
        "content": "\u77e9\u9635\u4f18\u5316dp\n\n\u56e0\u4e3a$n$\u7684\u8303\u56f4\u53ea\u6709$100$\uff0c\u6240\u4ee5\u5f88\u96be\u786e\u5b9a\u9009\u4ec0\u4e48\u6837\u7684\u7b97\u6cd5\uff08\u4f46\u662f\u6bd4\u8f83\u5927\u7684\u53ef\u80fd\u662f$O(n^3)$\u7684\uff09\n\n\u8fd9\u65f6\u5019\u7684\u601d\u8def\u5f88\u53ef\u80fd\u4f1a\u6bd4\u8f83\u6df7\u4e71\n\n\u4f3c\u4e4e\u6bd4\u8f83\u5bb9\u6613\u60f3\u5230\u56fe\u8bba\uff0c\u6216\u8005\u662f\u6309\u4e8c\u8fdb\u5236\u4f4d\u52a8\u6001\u89c4\u5212\uff0c\u4f46\u662f\u4ed4\u7ec6\u60f3\u60f3\u53c8\u4e0d\u884c\n\n**\u6ca1\u6709\u601d\u8def\u7684\u65f6\u5019\u53ef\u4ee5\u5148\u8003\u8651\u201c\u6709\u76ee\u7684\u201d\u7684\u66b4\u529b**\n\n\u8003\u8651\u66b4\u529bdp\n\n\u65e0\u975e\u662f\uff0c\u8bbe$f_{i,j}$\u4e3a\u957f\u5ea6\u662f$i$\uff0c\u4ee5$a_j$\u7ed3\u5c3e\u7684\u4e32\u7684\u6570\u91cf\n\n\u4f46\u662f\u53d1\u73b0$i$\u7684\u503c\u5e76\u4e0d\u91cd\u8981\uff0c\u91cd\u8981\u7684\u662f**\u8f6c\u79fb\u7684\u8fc7\u7a0b**\uff0c\u800c\u4e14\u8fd9\u4e00\u8fc7\u7a0b**\u4fdd\u6301\u4e0d\u53d8**\n\n**\u5982\u679c\u8f6c\u79fb\u8fc7\u7a0b\u662f\u4e0d\u53d8\u7684\uff0c\u53ef\u4ee5\u8003\u8651\u77e9\u9635\u4f18\u5316dp**\n\n$M_{i.j}$\u8868\u793a$a_i$\u4e0e$a_j$\u662f\u5426\u53ef\u4ee5\u76f8\u90bb\uff081=\u53ef\u4ee5\uff1b0=\u4e0d\u53ef\u4ee5\uff09\n\n\u628a$f$\u8003\u8651\u6210\u5411\u91cf\n\n\u4e8e\u662f$f_i=Mf_{i-1}$\n\n_\u60f3\u4e00\u60f3\uff0c\u4e3a\u4ec0\u4e48_\n\n\u8fb9\u754c\u60c5\u51b5\u662f$f_{1,j}=1$\uff0c\u7136\u540e\u8ba1\u7b97$M^{k-1}f_1$\u5373\u53ef\n\n\u7528\u5feb\u901f\u5e42\u8ba1\u7b97\uff0c\u590d\u6742\u5ea6$O(n^3 \\log k)$\n\n\u5176\u5b9e\u4e00\u5f00\u59cb\u7528\u56fe\u8bba\u60f3\u4e5f\u884c\uff0c\u601d\u8def\u7c7b\u4f3c\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<iostream>\ntypedef long long ll;\nconst int MAXN = 100 + 5;\nconst int mod = 1e9 + 7;\nusing namespace std;\n\nint n;\nll a[MAXN];\n\nstruct Matrix\n{\n\tll g[MAXN][MAXN];\n\tMatrix(){ memset(g,0,sizeof(g));}\n\tinline void mul(Matrix &b)\n\t{\n\t\tMatrix c;\n\t\tfor(int k=1; k<=n; ++k)\n\t\t\tfor(int i=1; i<=n; ++i)\n\t\t\t\tfor(int j=1; j<=n; ++j)\n\t\t\t\t\tc.g[i][j] += g[i][k]*b.g[k][j] %mod;\n\t\tfor(int i=1; i<=n; ++i)\n\t\t\tfor(int j=1; j<=n; ++j)\n\t\t\t\tc.g[i][j]%=mod;\n\t\t*this=c;\n\t}\n}t,ans;\n\ninline void pw(ll b)\n{\n\tfor(int i=1; i<=n; ++i) ans.g[i][i]=1;\n\t\n\twhile(b)\n\t{\n\t\tif(b&1) ans.mul(t);\n\t\tt.mul(t);\n\t\tb>>=1;\n\t}\n}\n\n#define lowbit(x) ((x)&-(x))\ninline int count(ll x)\n{\n\tint res=0;\n\twhile(x)\n\t\tx^=lowbit(x), ++res;\n\treturn res;\n}\n\nint main(void)\n{\n\tll k;\n\tcin>>n>>k;\n\tfor(int i=1; i<=n; ++i) cin>>a[i];\n\t\n\tfor(int i=1; i<=n; ++i)\n\t\tfor(int j=1; j<=n; ++j)\n\t\t\tt.g[i][j] = (count(a[i]^a[j])%3 == 0);\n\t\n\tpw(k-1);\n\tint res=0;\n\tfor(int i=1; i<=n; ++i)\n\t\tfor(int j=1; j<=n; ++j)\n\t\t\tres = (res+ans.g[i][j]) %mod;\n\t\n\tcout<<res;\n\treturn 0;\n}\n```\n",
        "postTime": 1568803460,
        "uid": 73687,
        "name": "He_Ren",
        "ccfLevel": 10,
        "title": "\u89e3\u9898\u62a5\u544a CF691E \u3010Xor-sequences\u3011"
    },
    {
        "content": "\u53ef\u4ee5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u89e3\u51b3\n\n\u7531\u4e8ek\u5f88\u591a\uff0c\u4f46\u662f\u6211\u4eec\u5206\u6790\u53ef\u4ee5\u770b\u51fa\uff0cdp[k]=dp[k-1] * a(dp[k]\u548ca\u90fd\u662f\u77e9\u9635)\n\n(a[i][j]\u5373a[i]^a[j]\u4e2d\u4e8c\u8fdb\u52361\u7684\u683c\u5f0f\u6a213\u662f\u5426\u7b49\u4e8e0)\n\ndp[1]\u662f\u4ec0\u4e48\u81ea\u5df1\u60f3\u4e00\u60f3\n\n\u6700\u540e\u6c42dp[k]\u7684\u5143\u7d20\u4e4b\u548c\u5373\u53ef\n\n```\n#include <cstdio>\n#include <iostream>\n#include <cstring>\n#define MOD 1000000007\n#define MAXN 105\nusing namespace std;\nlong long n,k,ans;\n//\u5feb\u8bfb\u5feb\u5199\ninline long long read(){\n\tchar ch;\n\tlong long f=1,x=0;\n\tch=getchar();\n\twhile (ch>'9'||ch<'0'){\n\t\tif (ch=='-'){\n\t\t\tf=-1;\n\t\t}\n\t\tch=getchar();\n\t}\n\twhile (ch<='9'&&ch>='0'){\n\t\tx=x*10+ch-'0';\n\t\tch=getchar();\n\t}\n\treturn f*x;\n}\ninline void print(long long x){\n\tif (x<0) x=-x,putchar('-');\n\tif (x>9) print(x/10);\n\tputchar(x%10+'0');\n}\n\nstruct binary{\n\tbool num[65];\n\tlong long len;\n\tvoid clear(){\n\t\tmemset(num,0,sizeof(num));\n\t}\n\tvoid convert(long long a){\n\t\tlong long i=0;\n\t\twhile (a>0){\n\t\t\tnum[i++]=a&1;\n\t\t\ta>>=1;\n\t\t}\n\t\tlen=i;\n\t}\n\tlong long SumTrue(){\n\t\tlong long sum=0;\n\t\tfor (long long j=0;j<len;j++){\n\t\t\tsum+=num[j];\n\t\t}\n\t\treturn sum;\n\t}\n}a[MAXN];\nbinary operator ^ (const binary &a,const binary &b){\n\tbinary c;\n\tlong long maxlen=max(a.len,b.len);\n\tfor (long long i=0;i<maxlen;i++){\n\t\tc.num[i]=a.num[i] xor b.num[i];\n\t}\n\tc.len=maxlen;\n\treturn c;\n}\n\nstruct matrix{\n\tlong long v[MAXN][MAXN];\n\tvoid clear(){\n\t\tmemset(v,0,sizeof(v));\n\t}\n\tvoid YPYlovesDYF(){\n\t\tfor (long long i=0;i<n;i++){\n\t\t\tfor (long long j=0;j<n;j++){\n\t\t\t    binary c=a[i]^a[j];\n\t\t\t    v[i][j]=(c.SumTrue()%3==0);\n\t\t\t}\n\t\t}\n\t}\n};\nmatrix operator *(const matrix &a,const matrix &b){\n\tmatrix ans;\n\tans.clear();\n\tfor (long long i=0;i<n;i++){\n\t\tfor (long long j=0;j<n;j++){\n\t\t\tfor (long long k=0;k<n;k++){\n\t\t\t\tans.v[i][j]=(ans.v[i][j]+a.v[i][k]*b.v[k][j])%MOD;\n\t\t\t}\n\t\t}\n\t}\n\treturn ans;\n}\n\n//\u77e9\u9635\u5feb\u901f\u5e42\nmatrix ksm(matrix a,long long pows){\n\tmatrix ans;\n\tans.clear();\n\tfor (long long i=0;i<n;i++){\n\t    ans.v[i][i]=1;\n\t}\n\twhile (pows>0){\n\t\tif (pows&1){\n\t\t\tans=ans*a;\n\t\t}\n\t\ta=a*a;\n\t\tpows>>=1;\n\t}\n\treturn ans;\n}\nint main(){\n\tn=read();\n\tk=read();\n\tlong long temp;\n\tfor (long long i=0;i<n;i++){\n\t\ttemp=read();\n\t\ta[i].clear();\n\t\ta[i].convert(temp);\n\t}\n\tmatrix ans;\n\tans.YPYlovesDYF();\n\tans=ksm(ans,k-1);\n\tlong long ret=0;\n\tfor (long long i=0;i<n;i++){\n\t    for (long long j=0;j<n;j++){\n\t        ret=(ret+ans.v[i][j])%MOD;\n\t    }\n\t}\n\tprint(ret);\n\treturn 0;\n}\n```\n\n\u53d1\u73b0\u81ea\u5df1\u592a\u5f31\u4e86,\u5176\u5b9e\u4e0d\u7528\u6a21\u62df\u4e8c\u8fdb\u5236,\u7528\u4f4d\u8fd0\u7b97\u6765\u8ba1\u7b971\u7684\u4e2a\u6570\u4e5f\u53ef\u4ee5\n\n```\nint count(ll a)\n{\n    int ans = 0;\n    while(a){\n        if(a & 1) ans++;\n        a >>= 1;\n    }\n    return ans;\n}\n```",
        "postTime": 1525687742,
        "uid": 45109,
        "name": "Steven_Meng",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF691E \u3010Xor-sequences\u3011"
    },
    {
        "content": "\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316 DP \u7ecf\u5178\u9898\u3002\n\n## \u601d\u8def\n\n\u4f9d\u7136\u8003\u8651 $dp_{i,j}$ \u8868\u793a\u770b\u5230\u7b2c $i$ \u4f4d\u6700\u540e\u4e00\u4e2a\u9009\u7684\u662f $a_j$\uff0c\u8f6c\u79fb\u8981\u6c42\u662f $\\operatorname{popcount}(a_j\\oplus a_k)\\bmod{3}$ \u662f $0$\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u6bcf\u6b21\u8f6c\u79fb\u662f\u4e00\u6837\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u5148 $\\Theta(n^2)$ \u9884\u5904\u7406\u51fa\u54ea\u4e9b $(i,j)$ \u53ef\u4ee5\u8f6c\u79fb\u5373\u53ef\u3002\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u76f4\u63a5\u7528\u77e9\u9635\u5feb\u901f\u5e42\u4f18\u5316\u5373\u53ef\uff0c\u590d\u6742\u5ea6 $\\Theta(n^3\\log k)$\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\n#define double long double\n#define mid ((l+r)>>1)\nusing namespace std;\nconst int mod=1e9+7;\nstruct mtx{\n\tint a[105][105];\n};\nmtx mul(mtx x,mtx y){\n\tmtx z;\n\tfor(int i=1;i<=100;i++) for(int j=1;j<=100;j++) z.a[i][j]=0;\n\tfor(int k=1;k<=100;k++) for(int i=1;i<=100;i++) for(int j=1;j<=100;j++) z.a[i][j]=(z.a[i][j]+x.a[i][k]*y.a[k][j])%mod;\n\treturn z;\n}\nmtx add(mtx x,mtx y){\n\tmtx z;\n\tfor(int i=1;i<=100;i++) for(int j=1;j<=100;j++) z.a[i][j]=(x.a[i][j]+y.a[i][j])%mod;\n\treturn z;\n}\nmtx qp(mtx a,int b){\n\tmtx ans;\n\tfor(int i=1;i<=100;i++) for(int j=1;j<=100;j++) ans.a[i][j]=(i==j);\n\twhile(b){\n\t\tif(b&1) ans=mul(ans,a);\n\t\ta=mul(a,a);\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\nint __bulitin_popcount(int i){\n\tint cnt=0;\n\twhile(i){\n\t\tcnt+=(i&1);\n\t\ti>>=1;\n\t}\n\treturn cnt;\n}\nmtx base,ori;\nsigned main(){\n\tint n,k;\n\tcin>>n>>k;\n\tint a[n+1];\n\tfor(int i=1;i<=n;i++) cin>>a[i];\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=1;j<=n;j++){\n\t\t\tif(__bulitin_popcount(a[i]^a[j])%3==0){\n\t\t\t\tbase.a[i][j]=1;\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++) ori.a[1][i]=1;\n\tori=mul(ori,qp(base,k-1));\n\tint ans=0;\n\tfor(int i=1;i<=n;i++) ans=(ans+ori.a[1][i])%mod;\n\tcout<<ans; \n\treturn 0;\n}\n```",
        "postTime": 1656256044,
        "uid": 116664,
        "name": "Daniel_lele",
        "ccfLevel": 8,
        "title": "CF691E\u9898\u89e3"
    },
    {
        "content": "\u8003\u8651\u66b4\u529b $O(n ^ 2 \\log a)$ \u8fde\u8fb9\uff0c\u4ee4 $dp_{i,k}$ \u8868\u793a\u957f\u4e3a $k$ \u7684 $b$ \u6570\u7ec4\u672b\u5c3e\u4e3a\u7b2c $i$ \u4e2a\u503c\u65f6\u7684\u65b9\u6848\u6570\u53ef\u5f97\uff1a        \n\n$dp_{i,k + 1} = \\sum_{(i,j) \\in Edge} dp_{j,k}$ \n\n\u8fd9\u4e2a dp \u7684\u542b\u4e49\u5c31\u662f\u76f8\u5f53\u4e8e\u4ece\u957f\u5ea6\u6bd4\u5f53\u524d\u72b6\u6001\u5c11 $1$ \u7684 \u5408\u6cd5\u72b6\u6001\u4e2d\uff0c\u627e\u5230\u672b\u5c3e\u53ef\u4ee5\u62fc\u5728\u4e00\u8d77\u7684\u72b6\u6001\u8f6c\u79fb\u8fc7\u6765\u3002\n\n\u89c2\u5bdf\u5230\u6bcf\u6b21\u53ea\u5229\u7528\u5230\u4e86 $k - 1$ \u7684\u72b6\u6001\u5c31\u80fd\u8f6c\u79fb\u5230 $k$ \u7684\u72b6\u6001\u8003\u8651\u77e9\u9635\u52a0\u901f $dp$ \u8f6c\u79fb\uff0c\u5c06\u7cfb\u6570\u586b\u5165\u77e9\u9635\u4e2d\u5373\u53ef\u8fdb\u884c\u77e9\u9635\u5feb\u901f\u5e42\u5373\u53ef\u3002          \n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n ^ 3 \\log k)$\u3002\n\n```cpp\n#include \"bits/stdc++.h\"\nusing namespace std;\nconst int Len = 1e2 + 5 , mod = 1e9 + 7;\nlong long n,m;\nstruct node\n{\n\tlong long a[Len][Len];\n\tnode(){memset(a , 0 , sizeof a);}\n\tinline void build(){for(int i = 1 ; i <= n ; i ++) a[i][i] = 1;}\n}Ans,K,smr;\nnode operator * (const node &x,const node &y)\n{\n\tnode z;\n\tfor(int i = 1 ; i <= n ; i ++)\t\n\t\tfor(int j = 1 ; j <= n ; j ++)\n\t\t\tfor(int k = 1 ; k <= n ; k ++) z.a[i][j] = (z.a[i][j] + x.a[i][k] * y.a[k][j] % mod) % mod;\n\treturn z;\n}\nnode mul(node x,node y)\n{\n\tnode z;\n\tfor(int i = 1 ; i <= n ; i ++)\n\t\tfor(int j = 1 ; j <= n ; j ++) z.a[1][i] = (z.a[1][i] + x.a[1][j] * y.a[j][i] % mod) % mod;\n\treturn z;\n}\nlong long val[Len];\nbool count(long long x)\n{\n\tint res = 0;\n\tfor(int i = 62 ; i >= 0 ; i --) if((x >> i) & 1) res ++;\n\treturn res % 3 == 0;\n}\nint main()\n{\n\tscanf(\"%lld %lld\",&n,&m);\n\tfor(int i = 1 ; i <= n ; i ++) scanf(\"%lld\",&val[i]);\n\tfor(int i = 1 ; i <= n ; i ++)\n\t\tfor(int j = 1 ; j <= n ; j ++) if(count(val[i] ^ val[j])) K.a[i][j] = 1;\n\tm --;\n\tfor(int i = 1 ; i <= n ; i ++) Ans.a[1][i] = 1;\n\tsmr.build();\n\twhile(m)\n\t{\n\t\tif(m & 1) smr = smr * K;\n\t\tK = K * K;\n\t\tm = m >> 1;\n\t}\n\tAns = mul(Ans , smr);long long res = 0;\n\tfor(int i = 1 ; i <= n ; i ++) res += Ans.a[1][i] , res %= mod;\n\tprintf(\"%lld\\n\",res);\n \treturn 0;\n}\n```",
        "postTime": 1633333462,
        "uid": 132533,
        "name": "Hakuoro",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 CF691E Xor-sequences"
    }
]
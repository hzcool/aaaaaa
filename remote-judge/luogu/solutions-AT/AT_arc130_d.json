[
    {
        "content": "[\u53ef\u80fd\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/FireAspect/p/17298350.html) \n\n[\u9898\u76ee\u94fe\u63a5](https://atcoder.jp/contests/arc130/tasks/arc130_d)    \n\u8003\u8651\u8fd9\u68f5\u6811\u5728\u6ee1\u8db3\u6761\u4ef6\u4e0b\u662f\u4ec0\u4e48\u6837\u5b50\u7684\uff1f   \n\n![Picture 1](https://s1.imagehub.cc/images/2023/04/08/d2a100629edb24c1cbcbea5d72b103ea.png)  \n\n\u6211\u4eec\u53d1\u73b0\u5982\u679c\u5bf9\u4e8e\u4e00\u68f5\u6811\u9ed1\u767d\u67d3\u8272\uff0c\u767d\u8272\u8868\u793a\u5468\u56f4\u7684\u70b9\u5927\u4e8e\u81ea\u8eab\uff0c\u9ed1\u8272\u7684\u70b9\u53cd\u4e4b\uff0c\u662f\u6ee1\u8db3\u6761\u4ef6\u7684\u3002\u540c\u65f6\uff0c\u5c06\u9ed1\u767d\u70b9\u53cd\u8272\u4e5f\u662f\u6ee1\u8db3\u6761\u4ef6\u7684\u3002\n\n\u6211\u4eec\u8003\u8651\u8fdb\u884c $\\text{dp}$\uff0c\u8bbe $dp_{i,j,0/1}$ \u8868\u793a\u4ee5\u70b9 $i$ \u4e3a\u6839\u7684\u5b50\u6811\uff0c$i$ \u70b9\u6743\u503c\u7684\u6392\u540d\u662f $j$\uff0c\u4e14 $i$ \u70b9\u989c\u8272\u662f\u9ed1\u6216\u767d\u7684\u65b9\u6848\u6570\u3002\n\n![Picture 2](https://s1.imagehub.cc/images/2023/04/08/ab52705e986b4044a6c4340f287a55f8.png)\n\n\u4ee5 $x$ \u70b9\u4e3a\u767d\u70b9\u4e3a\u4f8b\uff0c\u8003\u8651\u5c06\u5b50\u6811 $v$ \u5408\u5e76\u5230 $x$ \u7684\u8fc7\u7a0b\u4e2d\u524d $t$ \u4e2a\u70b9\u63d2\u5165\u5230\u4e86 $x$ \u524d\uff0c\u5269\u4f59\u7684 $sz[v] - t$ \u4e2a\u70b9\u5728 $x$ \u540e\u3002\u90a3\u4e48\u6b64\u65f6\u8f6c\u79fb\u4e3a   \n$$dp[x][i+t][1] += \\binom{i-1+t}{t} \\binom{sz[x]-i+sz[v]-t}{sz[v]-t} \\times dp[x][i][1] \\times dp[v][j][0](t \\geq j)$$    \n\u5bf9\u4e8e $x$ \u70b9\u662f\u9ed1\u70b9\u7684\u8f6c\u79fb\u540c\u7406\u4e3a\n$$dp[x][i+t][0] += \\binom{i-1+t}{t} \\binom{sz[x]-i+sz[v]-t}{sz[v]-t} \\times dp[x][i][0] \\times dp[v][j][1] (t \\leq j-1)$$   \n\u6b64\u65f6 $dp$ \u7684\u8f6c\u79fb\u590d\u6742\u5ea6\u4e3a $O(n^3)$\uff0c\u65e0\u6cd5\u901a\u8fc7\u3002\n\n\u8003\u8651\u679a\u4e3e $t$ \u7b97\u6240\u6709\u80fd\u8f6c\u79fb\u5230 $t$ \u7684 $j$ \u7684\u8d21\u732e\uff0c\u5f0f\u5b50\u6539\u5199\u4e3a  \n$$dp[x][i+j][1] += \\binom{i-1+j}{j} \\binom{sz[x]-i+sz[v]-j}{sz[v]-j} \\times dp[x][i][1] \\times pre[j] $$  \n$$dp[x][i+j][0] += \\binom{i-1+j}{j} \\binom{sz[x]-i+sz[v]-j}{sz[v]-j} \\times dp[x][i][0] \\times suc[j+1] $$   \n\u5176\u4e2d \n$$pre[j]= \\sum_{k=1}^{j} dp[v][k][0]$$  \n$$suc[j]= \\sum_{k=j+1}^{sz[v]} dp[v][k][1]$$   \n\u590d\u6742\u5ea6\u4e3a $O(n^2)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<string>\n#include<cstring>\n#include<vector>\n#include<algorithm>\nusing namespace std;\ntypedef long long ll;\nconst int mod=998244353;\nconst int N=3005;\nstruct node{\n\tint nxt;int to;\n}e[N*2];\nint head[N],tot;\nint n,rx,ry;\nint fa[N],sz[N];\nint dp[N][N][2],pre[N],suc[N];\nint g[N][2],ans;\nint fac[N],ifac[N];\ninline void read(int &x) \n{\n\tint f=1;char c;\n\tfor(x=0,c=getchar();c<'0'||c>'9';c=getchar()) if(c=='-') f=-1;\n\tfor(;c>='0'&&c<='9';c=getchar()) x=(x<<1)+(x<<3)+(c^48); x*=f;\n} \ninline int mn(int _x,int _y){return _x<_y?_x:_y;}\ninline int mx(int _x,int _y){return _x>_y?_x:_y;}\ninline int ab(int _x){return _x<0?-_x:_x;}\ninline void add(int from,int to){\n\te[++tot].to=to;e[tot].nxt=head[from];head[from]=tot;\n}\ninline int C(int n,int m){\n\tif(n<m) return 0;\n\treturn 1ll*fac[n]*ifac[m]%mod*ifac[n-m]%mod;\n}\ninline int qpow(int base,int cnt){\n\tint rest=1;\n\twhile(cnt){\n\t\tif(cnt&1) rest=1ll*rest*base%mod;\n\t\tbase=1ll*base*base%mod;\n\t\tcnt>>=1;\n\t}\n\treturn rest;\n}\ninline void dfs(int x){\n\tsz[x]=1;\n\tdp[x][1][0]=dp[x][1][1]=1;\n\tfor(int ei=head[x];ei;ei=e[ei].nxt){\n\t\tint v=e[ei].to;\n\t\tif(v==fa[x]) continue;\n\t\tfa[v]=x;dfs(v);\n\t\tfor(int j=0;j<=sz[v]+1;j++) pre[j]=suc[j]=0;\n\t\tfor(int j=1;j<=sz[v];j++) pre[j]=(pre[j-1]+dp[v][j][0])%mod;\n\t\tfor(int j=sz[v];j>=1;j--) suc[j]=(suc[j+1]+dp[v][j][1])%mod;\n\t\tfor(int i=1;i<=sz[x];i++){\n\t\t\tfor(int j=0;j<=sz[v];j++){\n            \t//dp\n\t\t\t\tg[i+j][0]=(g[i+j][0]+1ll*C(i-1+j,j)*C(sz[x]-i+sz[v]-j,sz[v]-j)%mod*dp[x][i][0]%mod*suc[j+1]%mod)%mod;\n\t\t\t\tg[i+j][1]=(g[i+j][1]+1ll*C(i-1+j,j)*C(sz[x]-i+sz[v]-j,sz[v]-j)%mod*dp[x][i][1]%mod*pre[j]%mod)%mod;\n\t\t\t}\n\t\t}\n\t\tsz[x]+=sz[v];\n\t\tfor(int i=0;i<=sz[x];i++){\n\t\t\tdp[x][i][0]=g[i][0];dp[x][i][1]=g[i][1];\n\t\t\tg[i][0]=g[i][1]=0;\n\t\t}\n\t}\n//\tfor(int i=1;i<=sz[x];i++) printf(\"dp[%d][%d] [0]=%d [1]=%d\\n\",x,i,dp[x][i][0],dp[x][i][1]);\n\treturn ;\n}\nint main()\n{\n\tread(n);\n\tfor(int i=1;i<n;i++){\n\t\tread(rx);read(ry);\n\t\tadd(rx,ry);add(ry,rx);\n\t}\n\tfac[0]=1;for(int i=1;i<=n+1;i++) fac[i]=1ll*i*fac[i-1]%mod;\n\tifac[n+1]=qpow(fac[n+1],mod-2);\n\tfor(int i=n;i>=0;i--) ifac[i]=1ll*(i+1)*ifac[i+1]%mod;\n\n\tdfs(1);\n\tfor(int i=1;i<=n;i++){//\u679a\u4e3e\u6839\u8282\u70b9\u7684\u6392\u540d\u5e76\u7d2f\u52a0\u7b54\u6848\n\t\tans=(ans+dp[1][i][0])%mod;\n\t\tans=(ans+dp[1][i][1])%mod;\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}  \n```\n",
        "postTime": 1681207993,
        "uid": 219198,
        "name": "Minecraft\u4e07\u5c81",
        "ccfLevel": 6,
        "title": "ARC130D ZigZag Tree \u9898\u89e3"
    }
]
[
    {
        "content": "# [[AGC061A] Long Shuffle](https://www.luogu.com.cn/problem/AT_agc061_a)\n\u8003\u8651\u8fdb\u884c `shuffle(1,2n)` \u540e\uff0c\u4e00\u5b9a\u6709\u4e14\u53ea\u6709\u67d0\u4e9b $a_{2i-1},a_{2i}$ \u4e92\u6362\u3002\n\n\u8bc1\u660e\uff1a\u8003\u8651\u5c06 `shuffle(1,2n)` \u62c6\u6210 `shuffle(1,2n-2)`\u3001`shuffle(2,2n-1)`\u3001`shuffle(2,2n-1)`\u3001`shuffle(3,2n)`\u3002\u8003\u8651\u5f52\u7eb3\uff0c\u8bbe `shuffle(1,2n-2)` \u65f6\u53ea\u4f1a\u5bf9\u67d0\u4e9b $a_{2i-1},a_{2i}$ \u4e92\u6362\uff0c\u5219\u4e2d\u95f4\u4e24\u4e2a `shuffle(2,2n-1)` \u53ef\u4ee5\u62b5\u6d88\uff0c\u800c `shuffle(1,2n-2)` \u548c `shuffle(3,2n)` \u5747\u53ea\u4f1a\u5c06\u67d0\u4e9b $a_{2i-1},a_{2i}$ \u4e92\u6362\uff1b\u4e14 `n=1` \u65f6\u53ea\u4f1a\u4ea4\u6362 $a_1,a_2$\uff1b\u6240\u4ee5\u8be5\u547d\u9898\u6210\u7acb\u3002\n\n\u6b64\u65f6\u8bbe $P_{i,j}$ \u4e3a `shuffle(1,2i)` \u65f6 $a_{2j-1}$ \u548c $a_{2j}$ \u662f\u5426\u4e92\u6362\uff0c\u5219\u6709 $P_{i,j}=P_{i-1,j}\\oplus P_{i-1,j-1}$\uff08\u975e\u6cd5 $P$ \u503c\u53ef\u4ee5\u8bbe\u4e3a $0$\uff09\uff0c\u521d\u503c\u6709 $P_{1,1}=1$\u3002\u6b64\u65f6\u53ef\u4ee5\u53d1\u73b0\u9012\u63a8\u65b9\u5f0f\u7c7b\u4f3c\u7ec4\u5408\u6570\uff08\u5176\u5b9e $P_{i,j}$ \u5c31\u662f $\\binom{i-1}{j-1}\\bmod 2$ \u7684\u503c\uff09\uff0c\u5c31\u5f88\u597d\u5904\u7406\u4e86\u3002\u7136\u540e $n$ \u4e3a\u5947\u6570\u65f6\u53ef\u4ee5\u62c6\u6210 `shuffle(1,n-1)` \u548c `shuffle(2,n)` \u4e5f\u5f88\u597d\u5904\u7406\u3002\n### \u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define ll long long\nint t; ll n,k,a;\ninline bool P(ll i,ll j){\n\tll si=0,sj=0,k=i-j;\n\twhile(i>>=1) si+=i;\n\twhile(j>>=1) sj+=j;\n\twhile(k>>=1) sj+=k;\n\treturn si==sj;\n}\ninline ll S(ll i,ll j){\n\treturn ((j-1)^P((i-1)>>1,(j-1)>>1))+1;\n}\nint main(){\n\tscanf(\"%d\",&t);\n\twhile(t--){\n\t\tscanf(\"%lld%lld\",&n,&k);\n\t\tif(n&1){\n\t\t\tif(k!=n) a=S(n-1,k);\n\t\t\tif(k!=1&&S(n-1,k-1)!=k-1){\n\t\t\t\tif((k^=1)!=n) a=S(n-1,k);\n\t\t\t\telse a=n;\n\t\t\t}\n\t\t}\n\t\telse a=S(n,k); printf(\"%lld\\n\",a);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1676504895,
        "uid": 546086,
        "name": "Francais_Drake",
        "ccfLevel": 7,
        "title": "AGC061A \u9898\u89e3"
    },
    {
        "content": "~~\u5feb\u4e50\u6253\u8868\u627e\u89c4\u5f8b\u9898\u3002~~\n\n\u6253\u8868\u53ef\u4ee5\u53d1\u73b0\uff1a\n\n- $n$ \u4e3a\u5076\u6570\u65f6 $|a_k - k| \\leq 1$\u3002\n- $n$ \u4e3a\u5947\u6570\u65f6 $|a_k - k| \\leq 2$\u3002\n\n\u800c $n$ \u4e3a\u5947\u6570\u65f6\u6211\u4eec\u53ea\u9700\u8981\u5c06\u5176\u62c6\u5206\u4e3a\u4e24\u4e2a\u5076\u6570\u7684\u60c5\u51b5\uff0c\u4e0b\u9762\u8ba8\u8bba $n$ \u4e3a\u5076\u6570\u7684\u60c5\u51b5\u3002\n\n\u5bf9 `shuffle` \u6267\u884c\u8fc7\u7a0b\u4e2d\u76f8\u90bb\u9879\u4ea4\u6362\u7684\u60c5\u51b5\u8fdb\u884c\u5206\u6790\uff1a\n\n- \u73b0\u5728\u6267\u884c `shuffle(l, l + 2k - 1)`\u3002\n- \u7b2c\u4e00\u6b65 `shuffle(l, l + 2k - 2)`\uff0c\u5373\u5148 `shuffle(l, l + 2k - 3)`\u3001\u518d `shuffle(l + 1, l + 2k - 2)`\u3002\n- \u7b2c\u4e8c\u6b65 `shuffle(l + 1, l + 2k - 1)`\uff0c\u5373\u5148 `shuffle(l + 1, l + 2k - 2)`\u3001\u518d `shuffle(l + 2, l + 2k - 1)`\u3002\n\n\u6ce8\u610f\u5230\u4e2d\u95f4\u6709\u4e24\u6b65\u662f\u4e00\u6a21\u4e00\u6837\u7684\u3002\u7ecf\u5f52\u7eb3\uff0c\u6211\u4eec\u53d1\u73b0\u53ef\u4ee5\u8fd9\u4e24\u6b65\u53ef\u4ee5**\u62b5\u6d88**\uff0c\u4e14\u5b9e\u9645**\u53ef\u80fd**\u6709\u6548\u7684\u4ea4\u6362\u64cd\u4f5c\u90fd\u53d1\u751f\u5728\u67d0\u4e9b $l + 2i - 2, l + 2i - 1$ \u4e4b\u95f4\uff0c\u4e14\u4ea4\u6362\u6b21\u6570\u4e3a $C_{k - 1}^{i - 1}$\u3002\n\n\u4e8e\u662f\u6211\u4eec\u5224\u65ad\u8fd9\u4e2a\u7ec4\u5408\u6570\u7684\u5947\u5076\u6027\u5373\u53ef\u3002\u5947\u5076\u6027\u7684\u5224\u65ad\u53ef\u4ee5\u5224\u65ad\u5b50\u96c6\u5173\u7cfb\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <iostream>\n\nusing namespace std;\n\ntypedef long long ll;\n\nint a[7];\n\nint main(){\n\tint t;\n\tcin >> t;\n\tfor (int i = 1; i <= t; i++){\n\t\tll n, k;\n\t\tcin >> n >> k;\n\t\tif (n % 2 == 0){\n\t\t\tll x = (k - 1) / 2;\n\t\t\tif (((n / 2 - 1) & x) != x){\n\t\t\t\tcout << k << endl;\n\t\t\t} else if (k % 2 == 0){\n\t\t\t\tcout << k - 1 << endl;\n\t\t\t} else {\n\t\t\t\tcout << k + 1 << endl;\n\t\t\t}\n\t\t} else if (k == 1){\n\t\t\tcout << 2 << endl;\n\t\t} else if (k == n){\n\t\t\tcout << n - 2 << endl;\n\t\t} else {\n\t\t\tll x = (n - 1) / 2 - 1;\n\t\t\ta[1] = -2;\n\t\t\ta[2] = -1;\n\t\t\ta[3] = 0;\n\t\t\ta[4] = 1;\n\t\t\ta[5] = 2;\n\t\t\tif (k % 2 == 0){\n\t\t\t\tll y = k / 2 - 1, z = y + 1;\n\t\t\t\tif ((x & y) == y) swap(a[2], a[3]);\n\t\t\t\tif ((x & z) == z) swap(a[4], a[5]);\n\t\t\t\tif ((x & y) == y) swap(a[3], a[4]);\n\t\t\t} else {\n\t\t\t\tll y = (k - 1) / 2, z = y - 1;\n\t\t\t\tif ((x & z) == z) swap(a[1], a[2]);\n\t\t\t\tif ((x & y) == y) swap(a[3], a[4]);\n\t\t\t\tif ((x & z) == z) swap(a[2], a[3]);\n\t\t\t}\n\t\t\tcout << k + a[3] << endl;\n\t\t}\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1676249913,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 [ARC061A] Long Shuffle"
    }
]
[
    {
        "content": "## \u9898\u610f\n\n\u6709\u4e00\u4e2a $ N $ \u4e2a\u70b9 $ M $ \u6761\u8fb9\u7684\u65e0\u5411\u56fe\u3002\u7b2c $ i $ \u6761\u8fb9\u8fde\u63a5 $ A_i $ \u548c $ B_i $\uff0c\u8fb9\u6743\u4e3a $ C_i $\uff0c\u4fdd\u8bc1 $ C_i $ \u4e92\u4e0d\u76f8\u540c\u3002\n\n\u73b0\u5728\u6709 $ K $ \u4e2a\u4eba\uff0c\u4f9d\u6b21\u4ece $ 1 $ \u5230 $ K $ \u7f16\u53f7\u3002\u7b2c $ 1 $ \u4e2a\u4eba\u5148\u64cd\u4f5c\uff0c\u4f1a\u5220\u6389\u56fe\u91cc\u4e00\u4e2a\u8fb9\u6743\u548c\u6700\u5927\u751f\u6210\u68ee\u6797\u3002\u7136\u540e\u662f\u7b2c $ 2 $ \u4e2a\u4eba\uff0c\u4f1a\u5220\u6389\u5269\u4e0b\u56fe\u91cc\u4e00\u4e2a\u8fb9\u6743\u548c\u6700\u5927\u751f\u6210\u68ee\u6797\u3002\u4f9d\u6b21\u7c7b\u63a8\uff0c\u63a5\u4e0b\u6765\u662f\u7b2c $ 3 $ \u4e2a\u4eba\uff0c\u7b2c $ 4 $ \u4e2a\u4eba\uff0c\u2026\u2026\uff0c\u76f4\u5230\u7b2c $ K $ \u4e2a\u4eba\u3002\u5bf9\u4e8e\u6bcf\u6761\u8fb9\uff0c\u4f60\u9700\u8981\u6c42\u51fa\u5b83\u662f\u88ab\u54ea\u4e2a\u4eba\u5220\u6389\u7684\u3002\n\n## \u601d\u8def\n\n\u9996\u5148\u5c06\u6240\u6709\u8fb9\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\uff0c\u5e76\u4e14\u7ef4\u62a4 $K$ \u4e2a\u5e76\u67e5\u96c6\uff0c\u4ee3\u8868\u7b2c $i$ \u4e2a\u4eba\u9009\u7684\u751f\u6210\u68ee\u6797\u3002\u7136\u540e\u904d\u5386\u6392\u5e8f\u540e\u7684\u8fb9\uff0c\u8bb0\u4e3a $(u,v)$\u3002\u663e\u7136\u628a\u8fd9\u6761\u8fb9\u5220\u6389\u7684\u4eba\u7684\u7f16\u53f7\u5c31\u662f\u6ee1\u8db3 $(u,v)$ \u5728\u7b2c $i$ \u4e2a\u5e76\u67e5\u96c6\u4e0d\u8fde\u901a\u7684\u6700\u5c0f $i$\u3002\n\n\u76f4\u63a5\u505a\u662f $O(MK \\log n)$ \u7684\uff08\u5e76\u67e5\u96c6\u5e26\u4e00\u4e2a $\\log$\uff09\uff0c\u8003\u8651\u4f18\u5316\u3002\n\n\u53ef\u4ee5\u8bc1\u660e $(u,v)$ \u5728\u7f16\u53f7\u4e3a $1 \\sim K$ \u7684\u5e76\u67e5\u96c6\u4e2d\u7684\u8fde\u901a\u60c5\u51b5\u5177\u6709\u5355\u8c03\u6027\uff0c\u5373\u6709\u4e00\u6bb5\u662f\u8fde\u901a\u7684\uff0c\u6709\u4e00\u6bb5\u662f\u4e0d\u8fde\u901a\u7684\u3002\u56e0\u6b64\u53ef\u4ee5\u76f4\u63a5\u4e8c\u5206\uff0c\u627e\u5230 $(u,v)$ \u4e0d\u8fde\u901a\u7684\u6700\u5c0f\u7f16\u53f7\uff0c\u7136\u540e\u8fde\u8fb9\u5373\u53ef\u3002\u65f6\u7a7a\u590d\u6742\u5ea6\u4e0e\u7ebf\u6bb5\u6811\u65b9\u6cd5\u76f8\u540c\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(NK + M \\log N \\log K)$\uff0c\u7a7a\u95f4\u590d\u6742\u5ea6 $O(NK)$\u3002\n\n## \u4ee3\u7801\n\n[code](https://atcoder.jp/contests/joisc2015/submissions/32583809)",
        "postTime": 1655613464,
        "uid": 275273,
        "name": "zltqwq",
        "ccfLevel": 0,
        "title": "AT1259 \u9898\u89e3"
    }
]
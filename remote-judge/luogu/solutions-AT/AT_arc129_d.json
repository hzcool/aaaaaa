[
    {
        "content": "\u725b\u903c\u63a8\u5f0f\u5b50\u9898\uff01\n\n\u9996\u5148\uff0c\u5f53 $\\sum a\\not=0$ \u65f6\u663e\u7136\u65e0\u89e3\u3002\n\n\u8bbe $x_i$ \u8868\u793a $i$ \u88ab\u9009\u62e9\u7684\u6b21\u6570\uff0c\u90a3\u4e48\u6839\u636e\u9898\u610f\u6709\n\n$$2\\times x_i-x_{i-1}-x_{i+1}+a_i=0$$\n\n\u8bbe $d_i=x_i-x_{i-1}$\uff0c\u4e0a\u8ff0\u5f0f\u5b50\u53ef\u5199\u6210\n\n$$d_{i+1}-d_i=a_i$$\n\n\u6240\u4ee5\n\n$$d_i-d_1=\\sum_{j=1}^{i-1}(d_{j+1}-d_j)=\\sum_{j=1}^{i-1} a_j$$\n\n\u56e0\u6b64\n\n$$\\sum_{i=1}^n(d_i-d_1)=\\sum_{i=1}^n\\sum_{j=1}^{i-1}a_j=\\sum_{i=1}^n (n-i)\\times a_i$$\n\n$$\\sum_{i=1}^nd_i=n\\times d_1+\\sum_{i=1}^n (n-i)\\times a_i$$\n\n\u53e6\u4e00\u65b9\u9762\uff0c$\\sum d_i=\\sum (x_i-x_{i-1})=0$\uff0c\u6240\u4ee5\n\n$$d_1=-\\dfrac{\\sum\\limits_{i=1}^n (n-i)\\times a_i}{n}$$\n\n\u5982\u679c\u6c42\u51fa\u6765 $d_1$ \u4e0d\u662f\u6574\u6570\uff0c\u90a3\u4e48\u65e0\u89e3\uff1b\u5426\u5219\u5c31\u53ef\u4ee5\u6c42\u51fa\u6240\u6709\u7684 $d$\u3002\n\n\u6839\u636e\u5b9a\u4e49\uff0c$x_i=x_{i-1}+d_i$\uff0c\u6240\u4ee5\n\n$$x_i=x_1+\\sum_{j=2}^i d_j\\ge 0$$\n\n\u6211\u4eec\u9700\u8981\u6784\u9020\u51fa\u4e00\u7ec4\u65b9\u6848\u4f7f\u5f97 $\\sum x$ \u6700\u5c0f\uff0c\u76f8\u5f53\u4e8e\u8981\u8ba9 $x_1$ \u6700\u5c0f\u3002\u6839\u636e\u4e0a\u9762\u7684\u8fd9\u4e2a\u9650\u5236\u6c42\u51fa\u5176\u6700\u5c0f\u503c\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n)$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int maxn = 200005;\nint n;\nint a[maxn];\nint d[maxn];\nint x[maxn];\nint sum;\nint res;\nint ans;\nsigned main() {\n    cin >> n;\n    for (int i = 1; i <= n; i++) cin >> a[i], sum += a[i];\n    if (sum != 0) {cout << -1 << endl; return 0;}\n    for (int i = 1; i < n; i++) res += a[i] * (n - i);\n    if (res % n) {cout << -1 << endl; return 0;}\n    d[1] = -res / n;\n    for (int i = 2; i <= n; i++) d[i] = d[i - 1] + a[i - 1];\n    res = 0;\n    for (int i = 2; i <= n; i++) {\n        res += d[i];\n        x[1] = max(x[1], -res);\n    }\n    for (int i = 2; i <= n; i++) x[i] = x[i - 1] + d[i];\n    for (int i = 1; i <= n; i++) ans += x[i];\n    cout << ans << endl;\n    return 0;\n}\n```\n",
        "postTime": 1679903200,
        "uid": 305027,
        "name": "Tarantula",
        "ccfLevel": 6,
        "title": "[ARC129D] -1+2-1 \u9898\u89e3"
    },
    {
        "content": "\u633a\u6709\u8da3\u7684\u9898\u3002\u81ea\u5df1\u63a8\u51fa\u6765\u611f\u89c9\u633a\u6709\u610f\u601d\u7684\u3002\n\n\u9996\u5148\u663e\u7136\u82e5 $\\sum\\limits_{i=0}^{n-1} a_i \\ne 0$ \u5c31\u65e0\u89e3\u3002\n\n\u8bbe $b_i$ \u4e3a $i$ \u7684\u64cd\u4f5c\u6b21\u6570\u3002\u53ef\u5f97\uff1a\n\n$$-b_{i-1} + 2b_i - b_{i+1} = a_i$$\n\n\u6574\u7406\u5f97\uff1a\n\n$$b_i = \\frac{b_{i-1} + b_{i+1} - a_i}{2}$$\n\n\u53d1\u73b0\u56e0\u4e3a\u6709 $i - 1$ \u548c $i + 1$ \u4e0d\u597d\u5904\u7406\u3002\u8003\u8651\u4e00\u4e2a\u901a\u7528\u5957\u8def\u5c31\u662f\u8bbe $b_i = x_i b_{i-1} + c_i$\uff0c\u5f97\uff1a\n\n$$b_i = \\frac{b_{i-1} + x_{i+1} b_{i} + c_{i+1} - a_i}{2}$$\n\n\u6574\u7406\u5f97\uff1a\n\n$$b_i = \\frac{1}{2 - x_{i+1}} b_{i-1} + \\frac{1}{2 - x_{i+1}} (c_{i+1} - a_i)$$\n\n\u90a3\u4e48 $x_i = \\frac{1}{2 - x_{i+1}}$\uff0c\u89e3\u5f97 $\\forall i \\in [1, n], x_i = 1$\u3002\u90a3\u4e48\uff1a\n\n$$b_i = b_{i-1} + c_{i+1} - a_i$$\n\n\u5f97\u5230\uff1a\n\n$$c_i = c_{i+1} - a_i$$\n\n\u53d1\u73b0 $b_i$ \u662f\u4e00\u4e2a\u7c7b\u4f3c\u524d\u7f00\u548c\u7684\u5f62\u5f0f\uff0c$b_n - b_0 = \\sum\\limits_{i=0}^{n-1} c_i - \\sum\\limits_{i=0}^{n-1} a_i = 0$\uff0c\u6240\u4ee5 $\\sum\\limits_{i=0}^{n-1} c_i = 0$\u3002\n\n\u8bbe $c_0 = c_n = t$\uff0c\u90a3\u4e48 $i \\in [1, n - 1], c_i = t - \\sum\\limits_{j=i}^{n-1} a_j$\uff0c$c_0 = t$\u3002\u56e0\u4e3a $\\sum\\limits_{i=0}^{n-1} c_i = 0$\uff0c\u6240\u4ee5 $t$ \u53ef\u4ee5\u89e3\u51fa\u6765\uff0c\u5982\u679c $t$ \u662f\u5c0f\u6570\u5c31\u65e0\u89e3\u3002\n\n\u90a3\u6211\u4eec\u73b0\u5728\u5f97\u5230\u4e86\u6bcf\u4e2a $c_i$\uff0c\u5269\u4e0b\u7684\u5c31\u662f\u6c42 $\\sum\\limits_{i=0}^{n-1} b_i$ \u7684\u6700\u5c0f\u503c\uff0c\u5e76\u8981\u6c42 $b_i = b_{i-1} + c_i, \\forall i \\in [0, n - 1], b_i \\ge 0$\u3002\n\n\u8bbe $b_0 = k$\uff0c\u90a3 $b_i$ \u548c $\\sum\\limits_{i=0}^{n-1} b_i$ \u662f\u5173\u4e8e $k$ \u7684\u4e00\u6b21\u51fd\u6570\uff0c\u5e76\u4e14\u659c\u7387\u90fd\u4e3a\u6b63\u3002\u56e0\u6b64\u6211\u4eec\u4e8c\u5206\u6700\u5c0f\u7684 $k$ \u4f7f\u5f97 $\\forall i \\in [0, n - 1], b_i \\ge 0$\uff0c\u5f97\u5230 $k$ \u540e\u4e00\u904d\u9012\u63a8\u5373\u53ef\u6c42\u51fa\u7b54\u6848\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n \\log V)$\uff0c$V$ \u4e3a\u503c\u57df\u3002\n\n[code](https://atcoder.jp/contests/arc129/submissions/41326577)",
        "postTime": 1683900693,
        "uid": 275273,
        "name": "zltqwq",
        "ccfLevel": 0,
        "title": "ARC129D \u9898\u89e3"
    },
    {
        "content": "\u4e0d\u662f\u5f88\u61c2\u4e3a\u5565\u8fd9\u9898\u6709 2300.jpg\r\n\r\n\u9996\u5148\u663e\u7136\u5728\u7ecf\u8fc7\u4e00\u6b21\u64cd\u4f5c\u540e $\\displaystyle\\sum_{i=1}^na_i$ \u4e0d\u53d8\uff0c\u6240\u4ee5\u6709\u89e3\u7684\u5145\u5206\u6761\u4ef6\u4e3a $\\displaystyle\\sum_{i=1}^na_i=0$\u3002\r\n\r\n\u6211\u4eec\u8bbe $x_i$ \u8868\u793a\u6211\u4eec\u5bf9\u4e0b\u6807 $i$ \u8fdb\u884c\u4e86 $x_i$ \u6b21\u8fd9\u6837\u7684\u64cd\u4f5c\uff0c\u90a3\u4e48\u6211\u4eec\u6709\u4e00\u7cfb\u5217\u65b9\u7a0b\uff0c\u5176\u4e2d\u6bcf\u4e2a\u65b9\u7a0b\u90fd\u5f62\u5982 $a_i-x_{i-1}-x_{i+1}+2x_i=0$\u3002\u8003\u8651\u901a\u8fc7 $x_1,x_2$ \u63a8\u51fa\u540e\u7eed\u7684\u6570\uff0c\u6211\u4eec\u6709\uff1a\r\n\r\n$$\r\nx_i=a_{i-1}-x_{i-2}+2x_{i-1}\r\n$$\r\n\r\n\u4e8e\u662f\u53ef\u4ee5\u5f97\u5230\uff1a\r\n\r\n$$\r\n\\begin{aligned}\r\n  x_1&=x_1\\\\\r\n  x_2&=x_2\\\\\r\n  x_3&=a_2-x_1+2x_2\\\\\r\n  x_4&=a_3-x_2+2x_3&=a_3+2a_2-2x_1+3x_2\\\\\r\n  &\\vdots\r\n\\end{aligned}\r\n$$\r\n\r\n\u5b9a\u7406 1\uff1a\u5bf9\u6240\u6709 $i\\ge 2$\uff0c$x_i$ \u5fc5\u5b9a\u53ef\u4ee5\u8868\u793a\u4e3a $v_i-(i-2)x_1+(i-1)x_2$ \u7684\u5f62\u5f0f\uff0c\u4e14 $v_i=a_{i-1}-v_{i-2}+2v_{i-1}$\u3002\r\n\r\n\u8bc1\u660e\uff1a\r\n\r\n\u8003\u8651\u5f52\u7eb3\u3002\u6211\u4eec\u5728\u4e0a\u9762\u5217\u51fa\u7684\u65b9\u7a0b\u4e2d\u5df2\u7ecf\u8bc1\u660e\u4e86\u5bf9 $i=2,3$ \u6765\u8bf4\u5b9a\u7406 1 \u6210\u7acb\uff0c\u5bf9 $i\\ge 4$\uff0c\u6211\u4eec\u6709\uff1a\r\n\r\n$$\r\n\\begin{aligned}\r\n  x_i\r\n  &=a_{i-1}-x_{i-2}+2x_{i-1}\\\\\r\n  &=a_{i-1}-(v_{i-2}-(i-4)x_1+(i-3)x_2)+2(v_{i-1}-(i-3)x_1+(i-2)x_2)\\\\\r\n  &=a_{i-1}-v_{i-2}+(i-4)x_1-(i-3)x_2+2v_{i-1}-2(i-3)x_1+2(i-2)x_2\\\\\r\n  &=(a_{i-1}-v_{i-2}+2v_{i-1})+[i-4-2(i-3)]x_1+[-(i-3)+2(i-2)]x_2\\\\\r\n  &=v_i-(i-2)x_1+(i-1)x_2\\\\\r\n\\end{aligned}\r\n$$\r\n\r\n\u6545\u5f97\u8bc1\u3002\r\n\r\n\u8003\u8651 $x_{n+1}$\uff0c\u6211\u4eec\u77e5\u9053\u5b83\u7b49\u4e8e $v_{n+1}-(n-1)x_1+nx_2$\uff0c\u4f46\u540c\u65f6\u7531\u4e8e $a_i$ \u7684\u5faa\u73af\u6027\uff0c\u5b83\u4e5f\u7b49\u4e8e $x_1$\u3002\u4e8e\u662f\u6709 $x_1-x_2=\\dfrac{v_{n+1}}{n}$\uff0c\u56e0\u4e3a $x_1,x_2$ \u90fd\u4e3a\u6574\u6570\uff0c\u6240\u4ee5\u6709\u89e3\u7684\u5145\u8981\u6761\u4ef6\u662f $n\\mid v_{n+1}$\u3002\u4ee5\u4e0b\u8bbe $d=\\dfrac{v_{n+1}}{n}=x_1-x_2$\u3002\r\n\r\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 $x_1$ \u548c $d$ \u5f97\u51fa\u5269\u4e0b\u6240\u6709 $x_i$\u3002\u5177\u4f53\u7684\uff0c\u6211\u4eec\u6709\uff1a\r\n\r\n$$\r\n\\begin{aligned}\r\n  x_i\r\n  &=v_i-(i-2)x_1+(i-1)x_2\\\\\r\n  &=v_i-(i-2)x_1+(i-1)(x_1-d)\\\\\r\n  &=v_i-(i-1)d+x_1\\\\\r\n\\end{aligned}\r\n$$\r\n\r\n\u56e0\u4e3a\u6211\u4eec\u8981\u6c42 $x_i\\ge 0$ \u7684\u540c\u65f6\u4f7f\u5f97 $\\displaystyle\\sum_{i=1}^nx_i$ \u7684\u503c\u6700\u5c0f\uff0c\u4e14 $x_i$ \u90fd\u4e3a $x_1$ \u52a0\u4e0a\u4e00\u4e2a\u6570\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u8ba9 $x_1$ \u6700\u5c0f\uff0c\u56e0\u6b64\u6709\uff1a\r\n\r\n$$\r\nx_i=v_i-(i-1)d+x_1\\ge 0\\\\\r\nx_1\\ge (i-1)d-v_i\\\\\r\nx_1=\\max((i-1)d-v_i)\r\n$$\r\n\r\n\u6ce8\u610f\u5230 $x_1\\ge 0$\uff0c\u6240\u4ee5\u6700\u540e $x_1$ \u8fd8\u8981\u548c $0$ \u53d6 $\\max$\u3002\u7136\u540e\u76f4\u63a5\u7b97\u51fa\u5269\u4e0b\u7684 $x_i$\uff0c\u7d2f\u52a0\u7b54\u6848\u5373\u53ef\u3002\r\n\r\n```cpp\r\n#include <numeric>\r\n#include <iostream>\r\n\r\nusing namespace std;\r\nusing LL = long long;\r\n\r\nconst int kN = 2e5 + 2;\r\n\r\nint n, a[kN];\r\nLL v[kN], x1, ans;\r\n\r\nint main() {\r\n  ios_base::sync_with_stdio(0), cin.tie(0);\r\n  cin >> n;\r\n  for (int i = 1; i <= n; ++i) {\r\n    cin >> a[i];\r\n  }\r\n  if (accumulate(a + 1, a + n + 1, 0) != 0) {\r\n    cout << \"-1\";\r\n    return 0;\r\n  }\r\n  for (int i = 3; i <= n + 1; ++i) {\r\n    v[i] = a[i - 1] - v[i - 2] + 2 * v[i - 1];\r\n  }\r\n  if (v[n + 1] % n != 0) {\r\n    cout << \"-1\";\r\n    return 0;\r\n  }\r\n  LL d = v[n + 1] / n;\r\n  for (int i = 2; i <= n; ++i) {\r\n    x1 = max(x1, (i - 1) * d - v[i]);\r\n  }\r\n  for (int i = 1; i <= n; ++i) {\r\n    ans += x1 - (i - 1) * d + v[i];\r\n  }\r\n  cout << ans;\r\n  return 0;\r\n}\r\n```\r\n",
        "postTime": 1680159468,
        "uid": 376161,
        "name": "wsfxk",
        "ccfLevel": 6,
        "title": "[ARC129D] -1+2-1 \u9898\u89e3"
    }
]
[
    {
        "content": "[\u6d1b\u8c37\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT_abc132_f) && [AT \u4f20\u9001\u95e8](https://atcoder.jp/contests/abc132/tasks/abc132_f)\n\n\u5947\u5999\u7684\u6839\u53f7\u4f18\u5316 $\\text{dp}$\u3002\n\n# \u601d\u8def\n\n## $\\text{Step 1}$\n\n\u8981\u6c42\u76f8\u90bb\u4e58\u79ef\u4e0d\u8d85\u8fc7 $n$ \u7684\u5e8f\u5217\u603b\u6570\uff0c\u597d\u50cf\u5173\u7cfb\u5230\u4e00\u70b9\u6392\u5217\u7ec4\u5408\u3002\u65e2\u7136\u7b54\u6848\u662f\u7d2f\u52a0\u7684\uff0c\u90a3\u4e48\u5f88\u5bb9\u6613\u60f3\u5230\u9012\u63a8\u3002\n\n\u7136\u540e\u518d\u60f3\u60f3\u3002\u4f3c\u4e4e\u6709\u4e00\u4e2a\u4e1c\u897f\uff1a\u5bf9\u4e8e\u4e00\u5b9a\u7684 $n$\uff0c\u5982\u679c\u524d\u9762\u4e00\u4e2a\u6570\u586b\u7684\u662f $x(x \\le n)$\uff0c\u90a3\u4e48\u586b\u7684\u4e0b\u4e00\u4e2a\u6570\u5fc5\u7136 $\\le \\dfrac{n}{x}$\u3002\u663e\u7136\uff0c\u5bf9\u4e8e $k$ \u4e2a\u6570\uff0c\u7b54\u6848\u662f\u7d2f\u52a0\u7684\u3002\n\n\n\u8bbe $f_{i,j}$ \u8868\u793a\u7b2c $i$ \u4e2a\u6570\u586b $j$ \u7684\u65b9\u6848\u603b\u6570\uff0c$\\text{dp} $ \u5f0f\u5b50\u5982\u4e0b\uff1a\n\n$$ f_{i,j} = \\sum^{\\lfloor \\frac{n}{j} \\rfloor}_{x = 1}f_{i - 1,x}$$\n\n## $\\text{Step 2}$\n\n\u4e0a\u9762\u7684 $\\text{dp} $ \u5f0f\u5b50\u590d\u6742\u5ea6\u660e\u663e\u4f1a\u8d85\u65f6\u3002\n\n\u8003\u8651\u4f18\u5316\u3002\n\n\u770b\u7740\u5f0f\u5b50\u7684 $x$ \u548c $\\lfloor \\dfrac{n}{j} \\rfloor$\uff0c\u597d\u50cf\u53ef\u4ee5\u4f18\u5316\u70b9\u4ec0\u4e48\u4e1c\u897f\u3002\n\n\u5982\u679c\u662f\u4e0b\u53d6\u6574\u7684\u8bdd\uff0c\u90a3\u5c31\u4f1a\u51fa\u73b0\u6709\u597d\u591a\u4e2a\u6570\u4e58\u4e0a\u540c\u4e00\u4e2a\u6570\u7b26\u5408\u8981\u6c42\u3002\u4f8b\u5982\uff0c\u8bbe $n = 100,j=2$\uff0c\u90a3\u4e48 $x$ \u7684\u53d6\u503c\u53ef\u4ee5\u662f\u4ece $34$ \u4e00\u76f4\u5230 $50$\u3002\u4e00\u4e2a\u6570\u5217\u91cc\u5fc5\u5b9a\u4f1a\u6709\u8bb8\u591a\u5982\u6b64\u7684\u201c\u5757\u201d\uff0c\u6211\u4eec\u53ef\u4ee5\u63d0\u524d\u9884\u5904\u7406\u51fa\u6765\uff0c$\\text{dp} $ \u7684\u65f6\u5019\u590d\u6742\u5ea6\u5c31\u80fd\u8fbe\u5230 $O(\\sqrt n k)$\uff0c\u8db3\u591f\u901a\u8fc7\u6b64\u9898\u3002\n\n\u641e\u51fa\u4e86\u4f18\u5316\u65b9\u6cd5\uff0c\u8fd8\u8981\u6539\u4e00\u4e0b $\\text{dp} $ \u5f0f\u5b50\u3002\u8bbe $cnt$ \u4e3a\u4e0a\u8ff0\u9884\u5904\u7406\u51fa\u6765\u7684\u201c\u5757\u201d\u7684\u4e2a\u6570\uff0c$len_i$ \u8868\u793a\u6bcf\u4e2a\u201c\u5757\u201d\u7684\u957f\u5ea6\uff08\u5373\u4e00\u4e2a\u56e0\u6570\u76f8\u7b49\uff0c\u7b26\u5408\u8981\u6c42\u7684\u53e6\u4e00\u4e2a\u6570\u7684\u4e2a\u6570\uff09\uff0c\u5219\n\n$$f_{i,j} = \\sum^{cnt}_{x = 1}f_{i - 1,\\texttt{\u6240\u5728\u5757\u7684\u4e0b\u6807}} \\times len_x$$\n\n# $\\text{AC Code}$\n\n\u4e0d\u8981\u5fd8\u4e86\u53d6\u6a21\u3002\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define ll long long\nconst int p = 1e9 + 7;\nint n, cnt, k, a[100010], len[100010];\nll f[110][100010];\nmap < int, int > b;\nint main() {\n\tscanf(\"%d %d\", &n, &k);\n\tfor (int l = 1, r; l <= n; l = r + 1) {\n\t\tr = min(n / (n / l), n);\n\t\ta[++cnt] = r, b[r] = cnt; // a[i] \u8868\u793a\u7b2c i \u5757\u7684\u56e0\u6570  b[i] \u662f\u88c5\u4e0b\u6807\u7684\u6876 \n\t\tlen[cnt] = r - l + 1;\n\t}\n\tfor (int i = 1; i <= cnt; ++i) f[0][i] = 1;\n\tfor (int i = 1; i <= k; ++i) \n\t\tfor (int j = 1; j <= cnt; ++j) \n\t\t\tf[i][j] = (f[i][j - 1] + (ll)len[j] * f[i - 1][b[n / a[j]]] % p) % p;\n\tprintf(\"%lld\", f[k][cnt]);\n\treturn 0;\n}\n```\n",
        "postTime": 1669649834,
        "uid": 365825,
        "name": "Orange_qwq",
        "ccfLevel": 0,
        "title": "[ABC132F] Small Products \u9898\u89e3"
    },
    {
        "content": "\u4ee4$dp[i][x]$\uff0c\u8868\u793a\u7b2c$i$\u4e2a\u4f4d\u7f6e\u586b$x$\u7684\u65b9\u6848\u6570\u3002\n\n\u663e\u7136\u6709$dp[i+1][x]=\\sum_{z=1} ^ {\\lfloor \\frac{N}{x} \\rfloor} dp[i][z]$\n\n\u4f7f\u7528\u524d\u7f00\u548c\u4f18\u5316\uff0c\u4f46\u8fd9\u6837\u590d\u6742\u5ea6\u4ecd\u7136\u662f\u662f$O(n)\\times O(k)=O(nk)$\u7684\uff0c\u7531\u4e8e$k<=100,n<=10^9$ \uff0c\u663e\u7136\u8fc7\u4e0d\u4e86\u3002\n\n\u8003\u8651\u8fdb\u884c\u4f18\u5316\u3002\n\n\u5047\u8bbe\u6709\u4e24\u4e2a\u6b63\u6574\u6570$x$,$y$\u6ee1\u8db3$\\lfloor \\frac{n}{x} \\rfloor =\\lfloor \\frac{n}{y} \\rfloor = t$ \u53ef\u4ee5\u53d1\u73b0$dp[i+1][x]=dp[i+1][y]$ \u3002\n\n\u8fd9\u91cc\u4ecb\u7ecd\u4e00\u4e0b**\u6570\u8bba\u5206\u5757** (\u6765\u81ea[oi-wiki](https://oi-wiki.org/math/mobius/#_3))\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/ct3ut44w.png)\n\n\u5982\u8ba1\u7b97$\\sum_{i=1}^n \\lfloor \\frac{n}{i} \\rfloor$\n\n\u4ee3\u7801\n\n```c++\nfor(int l=1,r;l<=n;l=r+1)\n{\n\tr=n/(n/l);\n\tans+=(r-l+1)*(n/l);\n}\n```\n\n\u4f8b\u9898[[CQOI2007]\u4f59\u6570\u6c42\u548c](https://www.luogu.com.cn/problem/P2261)\n\n\u90a3\u4e48\u5bf9\u4e8e\u672c\u9898\u6211\u4eec\u53ea\u9700\u8981\u8ba1\u7b97$\\sqrt n$\u4e2a\u72b6\u6001\uff0c\u590d\u6742\u5ea6\u964d\u4e3a$O(k\\sqrt n)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u672c\u9898\u3002\n\n",
        "postTime": 1611122066,
        "uid": 115779,
        "name": "\u6781\u5bd2\u795e\u51b0",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 AT4817 \u3010[ABC132F] Small Products\u3011"
    },
    {
        "content": "- [AT4817 [ABC132F] Small Products](https://www.luogu.com.cn/problem/AT4817)\n\n### \u9898\u76ee\u63cf\u8ff0\n\n\u7ed9\u5b9a $N$, $K$\uff0c\u95ee\u6709\u591a\u5c11\u4e2a\u957f\u5ea6\u4e3a $K$ \u7684\u6b63\u6574\u6570\u5e8f\u5217\u6ee1\u8db3\u76f8\u90bb\u5143\u7d20\u7684\u4e58\u79ef\u4e0d\u8d85\u8fc7 $N$\u3002\n\n### \u6b63\u89e3\n\n\u8003\u8651\u9012\u63a8\uff0c\u8bbe $f_{i,j}$ \u8868\u793a\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u586b $j$ \u7684\u65b9\u6848\u6570\u3002\n\n\u7136\u800c\u503c\u57df\u5b9e\u5728\u592a\u5927\uff0c\u8981\u5c06\u6240\u6709\u6570\u5b58\u4e0b\u6765\u5b9e\u5728\u4e0d\u592a\u53ef\u884c\u3002\n\n\u8003\u8651\u6709\u54ea\u4e9b\u72b6\u6001\u672c\u8d28\u4e0a\u662f\u76f8\u540c\u7684\u3002\n\n\u5e8f\u5217\u4e2d\u4e00\u4e2a\u5143\u7d20 $a_i$\uff0c\u53ef\u4ee5\u8f6c\u79fb\u5230\u4e0b\u4e00\u4e2a\u4f4d\u7f6e $a_{i + 1} \\leq \\lfloor N / a_i \\rfloor$\uff0c\u53d1\u73b0 $\\lfloor N / a_i \\rfloor$ \u53ea\u6709 $\\sqrt N$ \u79cd\u53d6\u503c\uff0c\u53ef\u4ee5\u76f4\u63a5\u8bb0\u5f55\u4e0b\u6765\u3002\n\n\u90a3\u4e48\u5c06 $a_i \\le \\sqrt N$\uff0c$a_i > \\sqrt N$ \u5206\u522b\u8bb0\u5f55\u5373\u53ef\u3002\n\n\u8f6c\u79fb\u8981\u7528\u524d\u7f00\u548c\u4f18\u5316\u4e00\u4e0b\uff0c\u5b9e\u73b0\u7684\u65f6\u5019\u53ef\u4ee5\u4ece\u5927\u5f80\u5c0f\u679a\u4e3e\u8bb0\u5f55\u524d\u7f00\u548c / \u540e\u7f00\u548c\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(K \\sqrt N)$\n\n$\\color{DeepSkyBlue} {Code :}$\n\n```cpp\n#include <bits/stdc++.h>\n#define N 105\n#define V 31627\n\nusing namespace std;\n\nconst int mod = 1e9 + 7;\n\nint n, K;\nint f[N][V], g[N][V];\nint cnt[V];\n\nint main() {\n\tscanf(\"%d %d\", &K, &n); /* \u628a n, k \u7684\u5b9a\u4e49\u53cd\u4e86\u4e00\u4e0b*/\n\t\n\tint p = sqrt(K);\n\t\n\tfor(int i = 1; i < p; ++i)\n\t\tcnt[i] = K / i - K / (i + 1);\n\tcnt[p] = K / p - p;\n\t\n\tfor(int i = 1; i <= p; ++i) {\n\t\tf[1][i] = 1;\n\t\tg[1][i] = cnt[i];\n\t}\n\t\n\tfor(int i = 1; i <= n; ++i) {\n\t\tint sum = 0;\n\t\tfor(int j = 1; j <= p; ++j) {\n\t\t\tsum = (sum + f[i][j]) % mod;\n\t\t\tg[i + 1][j] = 1LL * sum * cnt[j] % mod;\n\t\t}\n\t\tfor(int j = p; j >= 1; --j) {\n\t\t\tsum = (sum + g[i][j]) % mod;\n\t\t\tf[i + 1][j] = sum;\n\t\t}\n\t}\n\t\n\tprintf(\"%d\\n\", f[n + 1][1]);\n\treturn 0;\n}\n```",
        "postTime": 1585048311,
        "uid": 88471,
        "name": "Lskkkno1",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 [ABC132F] Small Products"
    },
    {
        "content": "#### \u9898\u76ee\u5927\u610f\n\n\n------------\n\u6c42\u6709\u591a\u5c11\u957f\u5ea6\u4e3a $k$ \u7684\u6b63\u6574\u6570\u5e8f\u5217\u6ee1\u8db3\u4efb\u610f\u76f8\u90bb\u4e24\u6570\u4e58\u79ef\u4e0d\u5927\u4e8e $n$\u3002\n\n\n\n------------\n\u6700\u66b4\u529b\u7684\u89e3\u6cd5\u662f\u8bbe\u8ba1\u72b6\u6001 $f_{i,j}$ \u8868\u793a\u7b2c $i$ \u4e2a\u6570\u4e3a $j$ \u7684\u65b9\u6848\u6570\u3002\n\n$f_{i,j} = \\sum_{k=1}^{\\left \\lfloor \\frac{n}{j} \\right \\rfloor } f_{i-1,k}$\n\n\u4e00\u4e2a\u663e\u7136\u7684\u4f18\u5316\u662f\u8bb0\u5f55\u524d\u7f00\u548c\u5c06\u590d\u6742\u5ea6\u964d\u81f3 $\\Theta(nk)$\uff0c\u4f46\u8fd9\u8fd8\u8fdc\u4e0d\u8db3\u4ee5\u901a\u8fc7\u6b64\u9898\u3002\n\n\u8003\u8651\u5408\u5e76\u672c\u8d28\u76f8\u540c\u7684\u72b6\u6001\u4ee5\u964d\u4f4e\u590d\u6742\u5ea6\u3002\n\n\u4e0d\u96be\u53d1\u73b0\u7531\u4e8e $n$ \u662f\u56fa\u5b9a\u7684\uff0c\u5047\u8bbe\u5b58\u5728\u4e24\u4e0d\u540c\u6b63\u6574\u6570 $a,b$ \u6ee1\u8db3 $\\left \\lfloor \\frac{n}{a} \\right \\rfloor = \\left \\lfloor \\frac{n}{b} \\right \\rfloor $ \u5219\u4e00\u5b9a\u6709 $f_{i,a} = f_{i,b}$\uff0c\u8fd9\u5c31\u662f\u672c\u8d28\u76f8\u540c\u7684\u72b6\u6001\u3002\n\n\u8003\u8651\u5c06\u6240\u6709 $\\left \\lfloor \\frac{n}{i} \\right \\rfloor$ \u76f8\u540c\u7684\u72b6\u6001\u5408\u5e76\uff0c\u56e0\u4e3a\u5b83\u4eec\u90fd\u53ef\u4ee5\u7531\u540c\u6837\u7684\u72b6\u6001\u8f6c\u79fb\u3002\n\n\u9996\u5148\u8003\u8651\u5982\u4f55\u627e\u51fa\u8fd9\u4e9b\u72b6\u6001\uff0c\u8fd9\u91cc\u63d0\u4f9b\u4e00\u79cd\u5bb9\u6613\u7406\u89e3\u7684[\u6570\u8bba\u5206\u5757](https://oi-wiki.org/math/number-theory/sqrt-decomposition/)\u65b9\u6cd5\uff1a\n\n\u4e00\u4e2a\u663e\u7136\u7684\u7ed3\u8bba\u662f\u6240\u6709\u6ee1\u8db3 $\\left \\lfloor \\frac{n}{i} \\right \\rfloor = k$ \u7684 $i$ \u4e00\u5b9a\u662f\u8fde\u7eed\u7684\uff0c\u8003\u8651\u627e\u51fa\u4e00\u6bb5\u533a\u95f4\u4f7f\u5f97\u8fd9\u6bb5\u533a\u95f4\u4e2d\u7684\u6570\u90fd\u6ee1\u8db3 $\\left \\lfloor \\frac{n}{i} \\right \\rfloor=k$\u3002\n\n\u5047\u8bbe\u5df2\u77e5 $\\left \\lfloor \\frac{n}{i} \\right \\rfloor=k$\uff0c\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a\u6c42\u6700\u5927\u7684\u6ee1\u8db3 $\\left \\lfloor \\frac{n}{i} \\right \\rfloor=k$ \u7684 $i$\u3002\n\n\u8bbe $j$ \u5373\u4e3a\u6ee1\u8db3\u9898\u8bbe\u7684\u6700\u5927 $i$\uff0c\u53ef\u77e5 $\\left \\lfloor \\frac{n}{i} \\right \\rfloor = \\left | \\frac{n}{j} \\right | $ \u5373 $j$ \u4e3a\u6574\u9664 $n$ \u7684\u6570\u3002\n\n\u4ee4 $n = pi+q \\Rightarrow p = \\left | \\frac{n}{j} \\right | \\Rightarrow j = \\frac{n}{p}=\\frac{n}{\\left \\lfloor \\frac{n}{i} \\right \\rfloor}$\u3002\n\n\u81f3\u6b64\uff0c\u5c31\u53ef\u4ee5\u6c42\u51fa\u8fd9\u6bb5\u533a\u95f4\u7684\u5de6\u53f3\u8fb9\u754c\uff0c\u53ef\u77e5 $n$ \u6700\u591a\u5b58\u5728 $2\\sqrt{n}$ \u4e2a\u533a\u95f4\u3002\n\n\u6240\u4ee5\u53ea\u9700\u5c06\u72b6\u6001 $f_{i,j}$ \u66f4\u6539\u4e3a\u7b2c $i$ \u4e2a\u6570\u5728\u7b2c $j$ \u4e2a\u533a\u95f4\u7684\u65b9\u6848\u6570\uff0c\u8bb0 $cnt$ \u4e3a\u533a\u95f4\u603b\u6570\uff0c\u5219 $f_{i,j}=\\sum_{1}^{cnt-k+1}f_{i,k}$\uff0c\u524d\u7f00\u548c\u4f18\u5316\u4e00\u4e0b\u5c31\u53ef\u4ee5\u901a\u8fc7\u6b64\u9898,\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(\\sqrt{n}k)$\u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#include<cstring>\n#include<algorithm>\n#include<cstdlib>\n#include<cmath>\n#include<queue>\n#include<map>\n#include<vector>\n#define int long long\nusing namespace std;\nconst int INF = 0x3f3f3f3f;\nconst int mod = 1e9 + 7;\nconst int N = 1e5 + 10;\nconst int M = 1e3 + 10;\ninline int read(){\n\tint x=0,f=1;char ch=getchar();\n\tfor(;!isdigit(ch);ch=getchar()) if(ch=='-') f=-1;\n\tfor(; isdigit(ch);ch=getchar()) x=(x<<3)+(x<<1)+ch-'0';\n\treturn x*f;\n}\nint f[110][N],pre[110][N];\nint siz[N],idx;\nsigned main(){\n\tint n = read() , k = read();\n\tint l=1,r=0;\n\twhile(l <= n){\n\t\tr = n / (n / l);\n\t\tsiz[++idx] = r - l + 1;\n\t\tl = r + 1;\n\t}\n\tfor(int i=1;i<=idx;i++){\n\t\tf[1][i] = siz[i] % mod, pre[1][i] = (pre[1][i-1] + f[1][i]) % mod;\n\t}\n\tfor(int i=2;i<=k;i++){\n\t\tfor(int j=1;j<=idx;j++){\n\t\t\tf[i][j] = (siz[j] * pre[i-1][idx-j+1]) % mod;\n\t\t\tpre[i][j] = (pre[i][j-1] + f[i][j]) % mod;\n\t\t}\n\t}\n\tcout<<pre[k][idx]<<\"\\n\";\n\treturn 0;\n}\n\n/*\n314159265 35\n\n457397712\n*/\n```\n",
        "postTime": 1666786692,
        "uid": 689321,
        "name": "tour1st",
        "ccfLevel": 0,
        "title": "ABC132F"
    },
    {
        "content": "\u770b\u5230\u4e58\u79ef\uff0c\u4e0d\u96be\u60f3\u5230\u5148\u628a $n$ \u5f00\u6839\uff0c\u5206\u6210 $\\le \\sqrt{n}$ \u548c $> \\sqrt{n}$ \u4e24\u90e8\u5206\u3002\n\n\u7531\u4e8e\u4e0d\u4f1a\u540c\u65f6\u53d6\u4e24\u4e2a $> \\sqrt{n}$ \u7684\u6570\uff0c\u4e0d\u59a8\u679a\u4e3e $\\le \\sqrt{n}$ \u9009\u54ea\u4e9b\u6570\uff0c\u7136\u540e\u627e\u5230 $> \\sqrt{n}$ \u4e2d\u7684\u53d6\u503c\u8303\u56f4\u3002\n\n\u4e0d\u96be\u53d1\u73b0\uff0c\u53d6\u503c\u8303\u56f4\u662f\u5355\u8c03\u7684\uff0c\u5982\u4e0b\u56fe\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/5vdk642i.png)\n\n\u4e0d\u59a8\u628a\u53d6\u503c\u5206\u6210\u51e0\u6bb5\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/py0yqyet.png)\n\n\u8fd9\u6837\u5c31\u6709\u4e00\u4e2a\u6027\u8d28\uff1a\u7f16\u53f7\u5927\u4e8e\u7b49\u4e8e\u5b83\u7684\u6bb5\u5168\u90e8\u53ef\u4ee5\u53d6\u3002\n\n\u4e0b\u9762\u8003\u8651 $\\texttt{DP}$\u3002\n\n\u8bbe $f_{i,j}$ \u8868\u793a\u5230\u4e86\u7b2c $i$ \u4e2a\u4f4d\u7f6e\uff0c\u53d6\u4e86 $\\le \\sqrt{n}$ \u4e2d\u7684 $j$ \u7684\u65b9\u6848\u6570\u3002\n\n$g_{i,j}$ \u8868\u793a\u5230\u4e86\u7b2c $i$ \u4e2a\u4f4d\u7f6e\uff0c\u53d6\u4e86 $> \\sqrt{n}$ \u4e2d\u5904\u4e8e\u7b2c $j$ \u6bb5\u7684\u65b9\u6848\u6570\u3002\n\n\u8fd9\u6837\u5c31\u6709\uff08 $cnt_i$ \u8868\u793a\u7b2c $i$ \u4e2a\u6bb5\u7684\u6570\u7684\u4e2a\u6570\uff09\uff1a\n\n$$f_{i,j}=\\sum\\limits_{k=1}^{\\sqrt{n}} f_{i-1,k}+\\sum\\limits_{k=j}^{\\sqrt{n}} g_{i-1,k}$$\n\n$$g_{i,j}= \\sum\\limits_{k=1}^j (f_{i-1,k}\\times cnt_j)$$\n\n\u524d\u7f00\u548c\u4f18\u5316\u5373\u53ef\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\n\nint n, k, f[34000], g[34000], _1[34000], _2[34000], _[34000], mx[34000];\n\nconst int mod = 1e9 + 7;\n\nsigned main()\n{\n    cin >> n >> k;\n    int B = sqrt(n);\n    for (int i = 1;i <= B;i++)\n    {\n        mx[i] = n / i;\n    }\n    mx[B + 1] = B;\n    for (int i = 1;i <= B;i++)\n    {\n        _[i] = max(mx[i] - mx[i + 1], 0ll);\n    }\n    for (int i = 1;i <= B;i++)\n    {\n        _1[i] = i;\n    }\n    for (int i = B;i >= 1;i--)\n    {\n        _2[i] = (_2[i + 1] + _[i]) % mod;\n    }\n    for (int i = 2;i <= k;i++)\n    {\n        for (int j = 1;j <= B;j++)\n        {\n            f[j] = g[j] = 0;\n        }\n        for (int j = 1;j <= B;j++)\n        {\n            f[j] = (_1[B] + _2[j]) % mod;\n        }\n        for (int j = 1;j <= B;j++)\n        {\n            g[j] = _1[j] * _[j] % mod;\n        }\n        for (int j = 1;j <= B;j++)\n        {\n            _1[j] = _2[j] = 0;\n        }\n        for (int j = 1;j <= B;j++)\n        {\n            _1[j] = (_1[j - 1] + f[j]) % mod;\n        }\n        for (int j = B;j >= 1;j--)\n        {\n            _2[j] = (_2[j + 1] + g[j]) % mod;\n        }\n    }\n    cout << (_1[B] + _2[1]) % mod;\n}\n```",
        "postTime": 1677830338,
        "uid": 173424,
        "name": "Hovery",
        "ccfLevel": 6,
        "title": "ABC132F"
    },
    {
        "content": "\u9006\u5929\u9898\uff0c\u8c03\u4e86\u4e00\u4e0b\u5348\u3002\u3002\u3002  \n\u4e3a\u4ec0\u4e48\u6211\u4f1a [[CQOI2007]\u4f59\u6570\u6c42\u548c](https://www.luogu.com.cn/problem/P2261) \u4f46\u662f\u4e0d\u4f1a\u8fd9\u4e2a\u5462\uff0c\u56e0\u4e3a\u6211\u662f\u50bb\u903c\u3002  \n\n\n------------\n\u7b2c\u4e00\u773c\uff0c\u53ef\u4ee5\u4e00\u773c\u770b\u51fa\u4e00\u4e2a dp\uff0c\u8bbe $f_{i,j}$ \u8868\u793a\u7b2c i \u4e2a\u6570\u586b j\uff0c\u90a3\u4e48\u53ef\u4ee5\u8f6c\u79fb $f_{i,j}=\\sum\\limits_{k=1}^{\\lfloor \\frac{n}{j} \\rfloor}f_{i-1,k}$\uff0c\u4f46\u662f\u4f60\u53d1\u73b0\u5f53 $j$ \u5de8\u5c0f\u7684\u65f6\u5019\u4f60\u7684 $\\lfloor \\frac{n}{j} \\rfloor$ \u5de8\u5927\uff0c\u65e0\u8bba\u662f\u7a7a\u95f4\u8fd8\u662f\u65f6\u95f4\u90fd\u65e0\u6cd5\u5b8c\u6210\u3002  \n\u7136\u540e\u4f60\u624b\u6413\u4e00\u904d\u53d1\u73b0 $i$ \u4e00\u5b9a\u7684\u65f6\u5019\uff0c$j$ \u589e\u5927\uff0c\u4f1a\u91cd\u590d\u7b97\u5f88\u591a\u6b21 $f_{i-1,k}$\u3002\u90a3\u4e48\u5982\u4f55\u907f\u514d\u8fc7\u591a\u7684\u8ba1\u7b97\u5462\uff0c\u8003\u8651\u6574\u9664\u5206\u5757\u3002  \n\u5bf9\u4e8e\u6574\u9664\u5206\u5757\uff0c\u5b9a\u4e49\u5c31\u5df2\u7ecf\u8bb2\u5f97\u5f88\u6e05\u695a\u4e86\uff0c\u53ef\u4ee5\u652f\u6301\u8fd9\u79cd\u64cd\u4f5c\uff0c\u5177\u4f53\u53ef\u4ee5\u770b [OI Wiki \u6570\u8bba\u5206\u5757](https://oi-wiki.org/math/number-theory/sqrt-decomposition/)\u3002  \n\u90a3\u4e48\u53ef\u4ee5\u6574\u5757\u6574\u5757\u7684\u5904\u7406\u4e86\uff0c\u5c31\u5f88\u7b80\u5355\u4e86\uff0c\u9884\u5904\u7406\u4e00\u4e0b\u6bcf\u5757\u7684\u5757\u957f\uff0c\u53ef\u4ee5\u5f97\u5230\u8fd9\u4e2a\u5f0f\u5b50 $f_{i,j}$ \u8868\u793a i \u4e2a\u6570\uff0c\u548c\u5f53\u524d\u5728 j \u5757\uff0c\u90a3\u4e48\u5c31\u6709 $f_{i,j}=\\sum\\limits_{k=1}^{num}f_{i-1,x}\\times len_x$  \n\u524d\u7f00\u548c\u4f18\u5316\u4e00\u4e0b\u4e0a\u4e00\u6b21\u5c31\u884c\uff0c\u751a\u81f3\u53ef\u4ee5\u4f18\u5316\u6210\u4e00\u7ef4\uff0c\u56e0\u4e3a\uff0c\u4e4b\u548c\u524d\u4e00\u5c42\u6709\u5173\uff0c\u4f46\u662f\u65e0\u6240\u8c13\u4e86\uff0c\u8fd9\u9898\u6ca1\u6709\u5361\u7a7a\u95f4\u3002  \n\u4ee3\u7801\u5982\u4e0b\uff1a  \n```\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int mod=1e9+7;\nconst int INF=0x3f3f3f3f;\n\ninline int read()\n{\n\tint x=0,f=1;char c=getchar();\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9'){x=(x<<3)+(x<<1)+c-'0',c=getchar();}\n\treturn x*f;\n}\nconst int M=1e5+10,N=110;\nll f[N][M];\nll len[M],num;\nint main()\n{\n\tint n=read(),k=read();\n\tfor(ll l=1,r;l<=n;l=r+1)\n\t{\n\t\tr=n/(n/l);\n\t\tlen[++num]=r-l+1;\n\t}\n\tfor(int i=1;i<=num;i++)f[0][i]=1;\n\tfor(int i=1;i<=k;i++)\n\t{\n\t\tfor(int j=1;j<=num;j++)\n\t\t\tf[i][j]=(f[i][j]+len[j]*f[i-1][num-j+1]%mod)%mod;\n\t\tfor(int j=1;j<=num;j++)\n\t\t\tf[i][j]=(f[i][j]+f[i][j-1])%mod;\n\t}\n\tcout<<f[k][num]<<endl;\n\treturn 0;\n}\n\n\n```\n",
        "postTime": 1673861498,
        "uid": 247269,
        "name": "MSqwq",
        "ccfLevel": 0,
        "title": "[ABC132F] Small Products"
    },
    {
        "content": "\u6839\u53f7\u5206\u6cbb+dp\u3002\n\n## \u601d\u8def\n\n\u8003\u8651 $dp_{i,j}$ \u8868\u793a\u586b\u5230 $a_i$\uff0c$a_i=j$ \u7684\u65b9\u6848\u6570\u3002\u8f6c\u79fb\u65f6\u53ef\u4ee5\u679a\u4e3e\u4e00\u4e2a $k$\uff0c\u5224\u65ad $j\\times k\\leq n$ \u7136\u540e\u8f6c\u79fb\uff0c\u8fd9\u6837\u590d\u6742\u5ea6\u662f $O(n^2k)$ \u7684\u3002\n\n\u8003\u8651\u8f6c\u79fb\u7b26\u5408\u8981\u6c42\u7684 $k$ \u662f\u8fde\u7eed\u7684\u4e00\u6bb5\u533a\u95f4\uff0c\u53ef\u4ee5\u524d\u7f00\u548c\u4f18\u5316\uff0c\u590d\u6742\u5ea6 $O(nk)$\u3002\n\n\u518d\u8003\u8651\u5bf9\u4e8e\u6240\u6709 $\\lfloor\\dfrac{n}{j_1}\\rfloor=\\lfloor\\dfrac{n}{j_2}\\rfloor$\uff0c$j_1$ \u548c $j_2$ \u53ef\u8f6c\u79fb\u533a\u95f4\u5b8c\u5168\u76f8\u540c\uff0c\u6545\u53ef\u4ee5\u5408\u5e76\uff0c\u5bb9\u6613\u53d1\u73b0\u6700\u591a\u53ea\u6709 $O(\\sqrt{n})$ \u4e2a\uff0c\u52a0\u4e0a\u524d\u7f00\u548c\u4f18\u5316\u5373\u53ef\u505a\u5230 $O(\\sqrt{n}k)$\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\n#define double long double\n#define mid ((l+r)>>1)\nusing namespace std;\nconst int mod=1e9+7;\nint qp(int a,int b){\n\tint ans=1;\n\twhile(b){\n\t\tif(b&1) ans=(ans*a)%mod;\n\t\ta=(a*a)%mod;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\nint fac[10000005],inv[10000005];\nvoid init(){\n\tfac[0]=1;\n\tfor(int i=1;i<=10000000;i++) fac[i]=fac[i-1]*i%mod;\n\tinv[10000000]=qp(fac[10000000],mod-2);\n\tfor(int i=9999999;i>=0;i--) inv[i]=inv[i+1]*(i+1)%mod;\n}\nint C(int i,int j){\n\tif(i<0||j<0||i<j) return 0;\n\treturn fac[i]*inv[i-j]%mod*inv[j]%mod;\n}\nint dp[100005][105];\nint sz[100005];\nsigned main(){\n\tinit();\n\tint n,k;\n\tcin>>n>>k;\n\tint tot=0;\n\tfor(int i=1;i*i<n;i++){\n\t\ttot++;\n\t\tsz[tot]=1;\n\t}\n\ttot++;\n\tsz[tot]=n/(int)sqrt(n)-(int)sqrt(n)+((int)sqrt(n)*(int)sqrt(n)==n);\n\tfor(int i=sqrt(n)-1;i>=1;i--){\n\t\ttot++;\n\t\tsz[tot]=n/i-n/(i+1); \n\t}\n\tdp[1][0]=1;\n\tfor(int i=1;i<=k;i++){\n\t\tint sum=0;\n\t\tfor(int j=1;j<=tot;j++){\n\t\t\tsum+=dp[j][i-1];\n\t\t\tsum%=mod;\n\t\t\tdp[tot-j+1][i]=sum*sz[tot-j+1]%mod;\n\t\t}\n\t}\n\tint ans=0;\n\tfor(int i=1;i<=tot;i++) ans=(ans+dp[i][k])%mod;\n\tcout<<ans;\n\treturn 0;\n}\n```",
        "postTime": 1666359245,
        "uid": 116664,
        "name": "Daniel_lele",
        "ccfLevel": 8,
        "title": "ABC132F \u9898\u89e3"
    }
]
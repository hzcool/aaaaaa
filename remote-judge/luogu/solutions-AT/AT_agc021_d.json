[
    {
        "content": "## Description\n\n[\u9898\u5e93\u94fe\u63a5](https://agc021.contest.atcoder.jp/tasks/agc021_d)\n\n\u5728\u6539\u53d8\u539f\u4e32 $S$ \u6700\u591a $K$ \u4e2a\u5b57\u6bcd\u7684\u524d\u63d0\u4e0b\uff0c\u4f7f\u5f97 $S$ \u548c $S$ \u7684\u53cd\u4e32\u7684 $LCS$ \u5c3d\u91cf\u957f\uff0c\u95ee\u6700\u957f\u957f\u5ea6\u3002\n\n$1\\leq K\\leq |S|\\leq 300$\n\n## Solution\n\n\u4e00\u4e2a\u7ed3\u8bba\u662f\u5b57\u7b26\u4e32\u7684\u6700\u957f\u56de\u6587\u5b50\u5e8f\u5217\uff08 $lps$ \uff09\u957f\u5ea6\u7b49\u4e8e\u5176\u81ea\u8eab\u4e0e\u53cd\u8f6c\u7684\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\uff08 $lcs$ \uff09\u957f\u5ea6\u3002\n\n\u8bc1\u660e\u53ef\u89c1 [\u67d0\u4e4e](https://www.zhihu.com/question/34580085) \u3002\n\n\u90a3\u4e48\u663e\u7136\u53ef\u4ee5\u7528\u533a\u95f4 $DP$ \u5b9e\u73b0\u4e86\u3002\u8bb0 $f_{l,r,k}$ \u8868\u793a\u533a\u95f4 $[l,r]$ \u5185\u4fee\u6539\u4e86 $k$ \u4e2a\u5b57\u6bcd\u7684 $lps$ \u957f\u5ea6\u3002\n\n\u8f6c\u79fb\u53ea\u8981\u8003\u8651\u662f\u5426\u66ff\u6362\u4e24\u7aef\u7684\u5b57\u6bcd\u5373\u53ef\u3002\n\n## Code\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int N = 300;\n\nchar ch[N+5]; int f[N+5][N+5][N+5], k, n;\n\nvoid work() {\n    scanf(\"%s%d\", ch+1, &k); n = strlen(ch+1);\n    for (int i = 1; i <= n; i++) f[i][i][0] = 1;\n    for (int l = 1; l <= n; l++)\n\tfor (int i = 1; i+l <= n; i++)\n\t    for (int p = 0, j = i+l; p <= k; p++) {\n\t\tf[i][j][p] = max(f[i+1][j][p], f[i][j-1][p]);\n\t\tif (ch[i] == ch[j]) f[i][j][p] = max(f[i][j][p], f[i+1][j-1][p]+2);\n\t\tif (p) f[i][j][p] = max(f[i][j][p], f[i+1][j-1][p-1]+2);\n\t    }\n    int ans = 0;\n    for (int i = 0; i <= k; i++) ans = max(ans, f[1][n][i]);\n    printf(\"%d\\n\", ans);\n}\nint main() {work(); return 0; }\n```",
        "postTime": 1523521104,
        "uid": 11773,
        "name": "NaVi_Awson",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 AT3870 \u3010Reversed LCS\u3011"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT_agc021_d)\n[\u9898\u89e3\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/solution/AT_agc021_d)\n[\u66f4\u597d\u7684\u98df\u7528](https://www.luogu.com.cn/blog/sinius/)\n\n### \u9898\u76ee\u5927\u610f ###\n\n\u539f\u610f\uff1a\u6700\u5927\u5316\u4fee\u6539\u4e86 $k$ \u4e2a\u5b57\u7b26\u540e $T$ \u4e0e $T'$ \u7684\u6700\u957f\u516c\u5171\u5b50\u5e8f\u5217\uff0c\u5176\u4e2d $T'$ \u662f $\\operatorname{reverse}(T)$\u3002\n\n\u5b9e\u610f\uff1a\u6700\u5927\u5316\u4fee\u6539\u4e86 $k$ \u4e2a\u5b57\u7b26\u540e $T$ \u7684\u6700\u957f\u56de\u6587\u5b50\u5e8f\u5217\uff0c\u6ce8\u610f\u662f\u5b50\u5e8f\u5217\uff0c\u4e0d\u662f\u5b50\u4e32\uff0c\u5982\u679c\u662f\u5b50\u4e32\uff0c\u90a3\u5c31\u57fa\u672c\u505a\u4e0d\u4e86\u4e86\u3002\n\n### \u9898\u76ee\u601d\u8def ###\n\n\u7b80\u5355\u7684\u533a\u95f4 DP\uff0c\u7528 $dp_{i,j,k}$ \u8868\u793a $s_i \\sim s_j$ \u8fd9\u4e00\u6bb5\u4fee\u6539 $k$ \u4e2a\u5b57\u7b26\u540e\u5f97\u5230\u7684\u7b54\u6848\u3002\n\n\u9996\u5148\u521d\u59cb\u5316\uff1a\n\n\u521d\u59cb\u5316\u4e2d\uff0c$k$ \u663e\u7136\u662f $0$\uff0c\u5982\u679c $k>0$ \u5219\u5fc5\u987b\u7531\u53e6\u4e00\u4e2a\u72b6\u6001\u8f6c\u8fc7\u6765\uff0c\u90a3\u4e48 $i$ \u548c $j$ \u663e\u7136\u5c31\u662f $1\\sim 1$ \u8fd9\u4e00\u6bb5\u533a\u95f4\u4e86\u3002\n\n\u7136\u540e\u8003\u8651\u8f93\u51fa\u4ec0\u4e48\uff1a\n\n\u8fd9\u4e2a\u5f88\u7b80\u5355\uff0c$dp_{1,|s|,k}$\u3002\n\n\u8f6c\u79fb\u65f6\u5219\u6709\u4e09\u79cd\u60c5\u51b5\uff1a\n\n1. \u4e0d\u7528\u4fee\u6539\uff0c\u6700\u666e\u901a\u7684\u60c5\u51b5\u3002\u53ea\u9700\u8981\u4ece $dp_{i+1,j-1,k}$ \u8f6c\u79fb\u3002\n\n2. \u4e0d\u7528\u4fee\u6539\uff0c\u4e24\u8fb9\u76f8\u7b49\uff08\u6709\u70b9\u50cf[\u4e2d\u5fc3\u62d3\u5c55\u7b97\u6cd5](https://www.luogu.com.cn/problem/P3805)\uff09\u3002\u76f4\u63a5\u4ece $dp_{i+1,j-1,k}$ \u8f6c\u79fb\uff0c\u7136\u540e\u56de\u6587\u5ef6\u7eed\uff0c\u957f\u5ea6\u52a0 $2$\u3002\n\n3. \u9700\u8981\u4fee\u6539\uff0c\u540c\u7b2c\u4e8c\u79cd\uff0c\u53ea\u4e0d\u8fc7\u9700\u8981\u8017\u8d39\u4e00\u6b21\u4fee\u6539\uff0c\u6240\u4ee5\u662f $k-1$ \u800c\u975e $k$\u3002\n\n### \u53c2\u8003\u4ee3\u7801 ###\n\n```cpp\n#include<bits/stdc++.h>\n#define yhx int\nusing namespace std;\nstring s;\nyhx kk,dp[333][333][333],ma;\nchar c[333];\nsigned main(int argc,char* argv[])\n{\n\tcin>>s;\n\tcin>>kk;\n\tfor(yhx i=1;i<=s.length();i++)c[i]=s[i-1];\n\tfor(yhx i=1;i<=s.length();i++)dp[i][i][0]=1;\n\tfor(yhx l=2;l<=s.length();l++)\n\t{\n\t\tfor(yhx i=1;i+l-1<=s.length();i++)\n\t\t{\n\t\t\tyhx j=i+l-1;\n\t\t\tfor(yhx k=0;k<=kk;k++)\n\t\t\t{\n\t\t\t\tdp[i][j][k]=max(dp[i+1][j][k],dp[i][j-1][k]);\n\t\t\t\tif(c[i]==c[j])dp[i][j][k]=max(dp[i][j][k],dp[i+1][j-1][k]+2);\n\t\t\t\tif(k!=0)dp[i][j][k]=max(dp[i][j][k],dp[i+1][j-1][k-1]+2);\n\t\t\t}\n\t\t}\n\t}\n\tfor(yhx i=0;i<=kk;i++)ma=max(ma,dp[1][s.length()][i]);\n\tcout<<ma;\n    return 0;\n}\n/*\n\u6ce8\u610f\u7279\u5224k!=0 \n\u6ce8\u610fl\u5728\u5916\u5c42 \n*/\n```\n",
        "postTime": 1684749652,
        "uid": 1006159,
        "name": "Antiluna",
        "ccfLevel": 0,
        "title": "AT_agc021_d \u9898\u89e3"
    },
    {
        "content": "## \u6570\u636e\u8303\u56f4\n\n- $1\\leq|S|\\leq300$\n- $0\\leq k \\leq |S|$\n\n## \u63d0\u793a\n\n\u56e0\u4e3a\u8fd9\u4e2a\u6570\u636e\u8303\u56f4\u51fa\u4e4e\u610f\u6599\u7684\u5c0f\uff0c\u6240\u4ee5 $O(n^3)$ \u505a\u6cd5\u53ef\u4ee5\u901a\u8fc7\u3002\n\n\u4e0d\u59a8\u8bbe\u539f\u4e32 $S$ \u7684\u957f\u5ea6\u4e3a $n$\uff0c\u5bf9\u4e8e\u6839\u636e\u9898\u610f\u53ef\u4ee5\u5f97\u5230\u5176\u9006\u4e32 $S'$\u3002\n\n\u663e\u7136 $T+T'=S+S'$\u3002\u95ee\u9898\u8f6c\u5316\u4e3a\u66ff\u6362\u6389\u5b57\u7b26\u4e32\u4e2d\u81f3\u591a $k$ \u4e2a\u5b57\u7b26\u4f7f\u5176\u4ea7\u751f\u6700\u957f\u56de\u6587\u5b50\u5e8f\u5217\u3002\n\n\u8fd9\u68f5\u6811\u7684\u53f6\u5b50\u8282\u70b9\u5c31\u662f\u6240\u6709\u539f\u4e32\u548c\u9006\u4e32\u7684\u6bcf\u4e2a\u4f4d\u7f6e\uff0c\u540c\u65f6\u6211\u4eec\u5b9a\u4e49\u63d2\u5165\u5728\u8fd9\u4e2a\u4f4d\u7f6e\u540e\u5e8f\u5217\u7684\u5de6\u7aef\u6216\u53f3\u7aef\u6240\u9700\u6539\u53d8\u7684\u4ee3\u4ef7\u4e3a$1$\uff0c\u53f3\u5de6\u7aef\u70b9\u53ef\u4ee5\u5bf9\u5e94\u4fee\u6539\u73b0\u5728\u4f4d\u7f6e\u7684\u5de6\u53f3\u7aef\u70b9\u3002\u8fd9\u6837\u4e00\u6765\uff0c\u5c06\u56de\u6587\u4e32\u4e0a\u6bcf\u4e2a\u4e0b\u6807\u7684\u503c\u53d6\u53cd\uff0c\u90a3\u4e48\u8be5\u56de\u6587\u4e32\u4e3a\u56de\u6587\u7684\u5145\u8981\u6761\u4ef6\u662f $S+\\#$ \u4e0a\u8be5\u56de\u6587\u5b50\u5e8f\u5217\u4e2d\u7684\u70b9\u8986\u76d6\u8303\u56f4\u5305\u542b $\\lfloor\\frac k2\\rfloor+|S|$ \u6bb5\uff0c\u5176\u4e2d $\\lfloor\\frac k2\\rfloor$ \u4ee3\u8868\u5de6\u53f3\u8fd8\u53ef\u4e92\u76f8\u4e2d\u5fc3\u5bf9\u9f50\u7684\u4ee3\u4ef7\uff0c$|S|$ \u4ee3\u8868\u975e\u76f8\u4ea4\u7684\u8f6c\u79fb\u8fb9\u9700\u8981\u7684\u4ee3\u4ef7\u3002\n\n\u8003\u8651\u4e00\u4e2a\u975e\u5e38\u66b4\u529b\u7684 DP\uff0c\u8bbe $f[i][j][k][\\varepsilon]$ \u8868\u793a\u626b\u8fc7\u4e86 $S[1\u2026i]$ \u548c $T[1\u2026j]$\uff0c$T$ \u4e2d\u6700\u957f\u56de\u6587\u5b50\u5e8f\u5217\u5de6\u7aef\u70b9\u5728 $p_1$ \u53f3\u4fa7\uff0c\u53f3\u7aef\u70b9\u5728 $p_2$ \u5de6\u4fa7\uff08\u4e0d\u5305\u542b $p_1,p_2$\uff09\uff0c\u4e14\u524d\u9762\u4e00\u5171\u5df2\u7ecf\u6539\u53d8\u4e86 $k(\\varepsilon)$ \u6b21\u7684\u4ee3\u4ef7\u3002\u8bb0 $g[i][j][k][\\varepsilon]$ \u4e3a\u5728 $i, j$ \u72b6\u6001\u4e0b\uff0c\u5728\u9650\u5236\u4e3a $\\varepsilon$ \u7684\u60c5\u51b5\u4e0b\u6240\u80fd\u4ea7\u751f\u7684\u6700\u5c0f\u4ee3\u4ef7\uff0c\u5219\u6211\u4eec\u6309\u7167 $p_1$ \u548c $p_2$ \u7684\u72b6\u6001\u5206\u6210\u56db\u7c7b\u8ba8\u8bba\u8f6c\u79fb\u5373\u53ef\u3002\n\n## \u6838\u8165\u4ee3\u7801\n```python\ndp=[[-1]*310 for i in range(0,310)]\ndef solve(l,r,k):\n    if k<0:return -1e9\n    if r-l<1:return r-l+1\n    if dp[l][r][k]!=-1:return dp[l][r][k]\n    dp[l][r][k]=max(max(solve(l+1,r,k),solve(l,r-1,k)),2+solve(l+1,r-1,k-(s[l]!=s[r])))\n    return dp[l][r][k]\n\n```\n## \u4ee3\u7801\u89e3\u6790\n\u8fd9\u4e2a\u7b97\u6cd5\u662f\u4e00\u4e2a\u5e26\u6709\u8bb0\u5fc6\u5316\u641c\u7d22\u4f18\u5316\u7684\u9012\u5f52\u7b97\u6cd5\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u53ef\u4ee5\u901a\u8fc7\u753b\u51fa\u7a7a\u95f4\u72b6\u6001\u6811\u6765\u5206\u6790\u3002\n\n\u6bcf\u4e2a\u72b6\u6001\u67093\u4e2a\u53ef\u53d8\u53c2\u6570\uff0c\u6240\u4ee5\u72b6\u6001\u6811\u7684\u6bcf\u4e00\u5c42\u6700\u591a\u67096\u68f5\u5b50\u6811\uff0c\u5176\u4e2d4\u68f5\u5b50\u6811\u8868\u793a\u5de6\u8fb9\u9009\u62e9\u548c\u53f3\u8fb9\u9009\u62e9\uff0c\u8fd8\u67092\u68f5\u5b50\u6811\u8868\u793a\u5de6\u53f3\u4e24\u8fb9\u90fd\u9009\u3002\u6811\u7684\u6df1\u5ea6\u4e3a $O(n)$ \uff0c\u56e0\u6b64\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^3)$ \u3002\n\n\u540c\u65f6\uff0c\u7531\u4e8e\u7701\u7565\u4e86\u90a3\u4e9b\u6df7\u86cb\u7684\u72b6\u6001\uff0c\u72b6\u6001\u6570\u4f1a\u53d8\u5f97\u66f4\u5c0f\uff0c\u8fd9\u53ef\u4ee5\u901a\u8fc7\u9012\u5f52\u7684\u6700\u7b54\u8fa9\u306e\u60c5\u51b5\uff0c\u5373\u5b8c\u6574\u5904\u7406\u6240\u6709\u72b6\u6001\u3002\n\n\u53e6\u4e00\u65b9\u9762\uff0c\u8003\u8651\u5176\u7a7a\u95f4\u590d\u6742\u5ea6\uff1a\u5b83\u9700\u8981\u5b58\u50a8$O(n^2k)$\u4e2a $int$ \u503c\uff0c\u56e0\u6b64\u7a7a\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^2k)$\u3002\n\n## \u672c\u8d28\u4fee\u6b63\n**\u9a6c\u62c9\u8f66**\u7b97\u6cd5\u662f\u4e00\u79cd\u7528\u4e8e\u67e5\u627e\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2d\u6700\u957f\u56de\u6587\u5b50\u4e32\u7684\u7ebf\u6027\u65f6\u95f4\u590d\u6742\u5ea6\u7b97\u6cd5\uff0c\u7531 Manacher \u5728 1975 \u5e74\u53d1\u660e\uff0c\u5e76\u88ab\u6539\u8fdb\u3002\u5b83\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n)$\uff0c\u5176\u4e2d $n$ \u662f\u5b57\u7b26\u4e32\u957f\u5ea6\u3002\n\n\u8be5\u7b97\u6cd5\u57fa\u4e8e\u4ee5\u4e0b\u89c2\u5bdf\uff1a\u5bf9\u4e8e\u4e00\u4e2a\u56de\u6587\u4e32 $s$ \u6765\u8bf4\uff0c$s$ \u7684\u4e2d\u5fc3\u53ef\u4ee5\u662f\u4e00\u4e2a\u5b57\u7b26\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e24\u4e2a\u76f8\u90bb\u5b57\u7b26\u7684\u4e2d\u95f4\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u6bcf\u4e2a\u53ef\u80fd\u6210\u4e3a\u56de\u6587\u4e32\u4e2d\u5fc3\u7684\u4f4d\u7f6e\uff0c\u4ece\u800c\u627e\u5230\u6700\u957f\u7684\u56de\u6587\u5b50\u4e32\u3002\n\n\u9a6c\u62c9\u8f66\u7b97\u6cd5\u901a\u8fc7\u7ef4\u62a4\u4e00\u4e2a\u8f85\u52a9\u6570\u7ec4 $P$\uff0c\u6765\u907f\u514d\u91cd\u590d\u8ba1\u7b97\u3002 $P[i]$ \u8868\u793a\u4ee5\u4f4d\u7f6e $i$ \u4e3a\u4e2d\u5fc3\u7684\u6700\u957f\u56de\u6587\u534a\u5f84\u3002\u56de\u6587\u4e2d\u5fc3\u53ef\u80fd\u662f\u4e00\u4e2a\u5b57\u7b26\u6216\u4e24\u4e2a\u76f8\u90bb\u5b57\u7b26\u7684\u4e2d\u95f4\u3002\u7136\u540e\uff0c\u6211\u4eec\u4f7f\u7528 $C$ \u548c $R$ \u5206\u522b\u8868\u793a\u5f53\u524d\u5df2\u77e5\u7684\u6700\u53f3\u56de\u6587\u534a\u5f84\u6240\u6db5\u76d6\u7684\u6700\u9760\u53f3\u7684\u4f4d\u7f6e\u548c\u5bf9\u5e94\u7684\u56de\u6587\u534a\u5f84\u3002\u7136\u540e\u4ece\u5de6\u5230\u53f3\u904d\u5386\u6574\u4e2a\u5b57\u7b26\u4e32\uff0c\u5728\u4e0d\u65ad\u66f4\u65b0 $C$ \u548c $R$ \u7684\u8fc7\u7a0b\u4e2d\u66f4\u65b0\u6570\u7ec4 $P$ \u7684\u503c\u3002\u5728\u904d\u5386\u8fc7\u7a0b\u4e2d\u7ef4\u62a4\u7684 $C$ \u548c $R$ \u4f7f\u5f97\u7b97\u6cd5\u53ef\u4ee5\u8df3\u8fc7\u8bb8\u591a\u65e0\u9700\u68c0\u67e5\u7684\u4f4d\u7f6e\uff0c\u4ece\u800c\u8fbe\u5230\u7ebf\u6027\u65f6\u95f4\u590d\u6742\u5ea6\u3002\n```cpp\nstring preprocess(string s) {\n    string t = \"#\";\n    for (int i = 0; i < s.size(); i++) {\n        t += s[i];\n        t += \"#\";\n    }\n    return t;\n}\n\nstring manacher(string s) {\n    s = preprocess(s);\n    int n = s.size();\n    vector<int> p(n, 0); // \u8bb0\u5f55\u4ee5\u6bcf\u4e2a\u4f4d\u7f6e\u4e3a\u4e2d\u5fc3\u7684\u56de\u6587\u534a\u5f84\n    int id = 0, mx = 0; // id: \u5f53\u524d\u5df2\u77e5\u6700\u53f3\u56de\u6587\u534a\u5f84\u6240\u6db5\u76d6\u7684\u6700\u9760\u5de6\u7684\u4f4d\u7f6e\uff0cmx: \u5bf9\u5e94\u7684\u56de\u6587\u534a\u5f84\n    for (int i = 0; i < n; i++) {\n        if (i < mx) p[i] = min(mx - i, p[2 * id - i]);\n        // \u5982\u679c i \u5728 mx \u7684\u5de6\u8fb9\uff0c\u90a3\u4e48\u53ef\u4ee5\u5229\u7528\u4e4b\u524d\u8ba1\u7b97\u8fc7\u7684\u56de\u6587\u534a\u5f84\uff0c\u51cf\u5c11\u4e2d\u5fc3\u6269\u6563\u7684\u65f6\u95f4\n        while (i - p[i] - 1 >= 0 && i + p[i] + 1 < n &&\n            s[i - p[i] - 1] == s[i + p[i] + 1]) {\n            p[i]++;\n        }\n        // \u6269\u5c55\u56de\u6587\u534a\u5f84\n        if (i + p[i] > mx) { // \u5982\u679c\u5f53\u524d\u56de\u6587\u5b50\u4e32\u7684\u53f3\u8fb9\u754c\u8d85\u8fc7\u4e86 mx\uff0c\u90a3\u4e48\u66f4\u65b0 mx \u548c id\n            mx = i + p[i];\n            id = i;\n        }\n    }\n    int center = max_element(p.begin(), p.end()) - p.begin(); // \u627e\u5230\u4ee5\u54ea\u4e2a\u4f4d\u7f6e\u4e3a\u4e2d\u5fc3\u7684\u56de\u6587\u534a\u5f84\u6700\u957f\n    int radius = p[center]; // \u5bf9\u5e94\u7684\u56de\u6587\u534a\u5f84\n    return s.substr(center - radius + 1, radius * 2 - 1).erase(0, 1).erase(radius * 2 - 2); // \u8fd4\u56de\u539f\u5b57\u7b26\u4e32\u4e2d\u7684\u6700\u957f\u56de\u6587\u5b50\u4e32\n}\n\n```\n\n",
        "postTime": 1681191695,
        "uid": 576150,
        "name": "isjwanglongLuoGU",
        "ccfLevel": 0,
        "title": "AT_agc021_d"
    },
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT_agc021_d)\n\n\u521a\u5f00\u59cb\u628a\u5b50\u5e8f\u5217\u770b\u6210\u5b57\u4e32\uff0c\u7ed3\u679c\u60f3\u4e86\u597d\u4e45\uff0c\u89c9\u5f97\u8fd9\u65e0\u89e3\u5427\uff0c\u7136\u540e\u53d1\u73b0\u662f\u5b50\u5e8f\u5217\uff0c\u54e6\u90a3\u6ca1\u5565\u4e86\u3002\n\n\u9996\u5148\u9700\u8981\u5c06\u9898\u76ee\u4e2d\u7ed9\u51fa\u7684\u6240\u8c13\u201c\u5b57\u7b26\u4e32\u7684\u503c\u201d\u8f6c\u6362\u4e00\u4e0b\uff1a\n\n\u56e0\u4e3a $T'$ \u662f $T$ \u7684\u76f8\u53cd\u4e32\uff0c\u800c\u6211\u4eec\u77e5\u9053\uff0c\u5224\u65ad\u4e00\u4e2a\u5b57\u7b26\u4e32\u662f\u5426\u56de\u6587\u5c31\u662f\u5224\u65ad\u76f8\u53cd\u4e32\u548c\u5b83\u662f\u5426\u76f8\u540c\uff0c\u5f97\u51fa\u76f8\u53cd\u4e32\u76f8\u540c\u5373\u56de\u6587\uff0c\u90a3\u4e48\uff0c\u5b50\u5e8f\u5217\u76f8\u53cd\u4e32\u76f8\u540c\u5373\u5b58\u5728\u76f8\u540c\u7684\u5b50\u5e8f\u5217\uff0c\u6362\u53e5\u8bdd\u8bf4\uff0c\u5c31\u662f\u516c\u5171\u5b50\u5e8f\u5217\u4e86\uff0c\u56e0\u6b64\u6211\u4eec\u80fd\u5f97\u51fa\u8fd9\u9898\u662f\u6c42\u4fee\u6539 $1\\sim k$ \u6b21\u540e\u7684\u6700\u957f\u56de\u6587\u5b50\u5e8f\u5217\u7684\u957f\u5ea6\u3002\n\n\u6211\u4eec\u8003\u8651\u533a\u95f4 DP\uff0c\u8bbe $dp(i,j,k)$ \u4e3a $i\\sim j$ \u4fee\u6539 $k$ \u6b21\u540e\u7684\u6700\u957f\u56de\u6587\u5b50\u5e8f\u5217\u957f\u5ea6\uff0c\u663e\u7136\uff0c\u6211\u4eec\u8981\u6c42 $max(dp(1,|s|,k)$\u3002\n\n\u5bf9\u4e8e $dp(i,i,0)$\uff0c\u663e\u7136\u7b49\u4e8e 1\u3002\n\n\u7136\u540e\u5c31\u8981\u8003\u8651\u5bf9\u4e8e\u4efb\u610f\u7684 $dp(i,j,k)$\uff0c\u5982\u4f55\u7ee7\u627f\u5176\u5b83\u7684\u89e3\u3002\n\n$s_{i+1}$ \u5230 $s_j$ \u548c $s_i$ \u5230 $s_{j-1}$ \u7684\u89e3\u663e\u7136\u662f\u53ef\u4ee5\u7ee7\u627f\u5230 $dp(i,j,k)$ \u7684\u3002\n\n\u63a5\u7740\u6211\u4eec\u5c31\u60f3\u4e00\u60f3\uff0c\u5bf9\u4e8e\u56de\u6587\u4e32\u7684 DP \u9898\uff0c\u4e00\u822c\u4f1a\u5b58\u5728 $s_i=s_j$ \u7684\u60c5\u51b5\uff0c\u90a3\u4e48\uff0c\u8fd9\u610f\u5473\u7740 $dp(i+1,j-1,k)$ \u662f\u53ef\u4ee5\u7ee7\u627f\u4e0a\u6765\u7684\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5728\u5176\u57fa\u7840\u4e0a\u52a0\u4e0a 2\uff0c\u4e5f\u5c31\u662f $s_i$ \u548c $s_j$ \u7684\u957f\u5ea6\u3002\n\n\u90a3\u4e48\uff0c$s_i \\neq s_j$ \u65f6\uff0c\u5c31\u53ea\u80fd\u6309\u7167\u4e0a\u9762\u7684\u65b9\u5f0f\u7ee7\u627f\u4e86\u5417\uff1f\u663e\u7136\uff0c\u6211\u4eec\u8fd8\u6ca1\u6709\u8003\u8651\u4ee5 $k$ \u4e3a\u7ee7\u627f\u7126\u70b9\u7684\u65b9\u5f0f\uff0c\u6211\u4eec\u53ef\u4ee5\u8bd5\u7740\u4fee\u6539\uff0c\u90a3\u4e48\uff0c\u589e\u52a0 $s_j$\uff0c\u4f1a\u589e\u52a0\u591a\u5c11\u4fee\u6539\u91cf\u5462\uff1f\u7b54\u6848\u662f $j-i+2$\uff0c\u6240\u4ee5\u6211\u4eec\u6362\u4e00\u79cd\uff0c\u589e\u52a0 $s_i$ \u548c $s_j$\uff0c\u8fd9\u6837\u53ea\u9700\u8981\u628a $s_j$ \u6216 $s_i$ \u4fee\u6539\uff0c\u5f97\u51fa $dp(i,j,k)=dp(i+1,j-1,k-1)+2$\u3002\n\n\u90a3\u4e48\uff0c\u4e0a\u8ff0\u8f6c\u79fb\u65b9\u7a0b\u662f\u6b63\u786e\u7684\u5417\uff1f\u6211\u4eec\u8fd9\u6837\u60f3\uff0c$s_{i+1}$ \u5230 $s_{j-1}$ \u7684\u8fd9\u4e00\u6bb5\u4e2d\u7684\u5b50\u5e8f\u5217\u52a0\u4e0a\u4e86\u65c1\u8fb9\u4e24\u6bb5\u76f8\u540c\u7684\u540e\uff0c\u4f9d\u7136\u56de\u6587\uff0c\u6240\u4ee5\u662f\u6b63\u786e\u7684\u3002\n\n\u6700\u540e\u8d34\u4ee3\u7801\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint main()\n{\n\tstring s;\n\tstatic int k,dp[333][333][333],c[333],ma;\n\tcin>>s;cin>>k;\n\tfor(int i=0;i<s.length();i++)c[i+1]=s[i];\n\tfor(int i=1;i<=s.length();i++)dp[i][i][0]=1;\n\tfor(int l=2;l<=s.length();l++)\n\t{\n\t\tfor(int i=1;i+l-1<=s.length();i++)\n\t\t{\n\t\t\tint j=i+l-1;\n\t\t\tfor(int q=0;q<=k;q++)\n\t\t\t{\n\t\t\t\tdp[i][j][q]=max(dp[i+1][j][q],dp[i][j-1][q]);\n\t\t\t\tif(c[i]==c[j])dp[i][j][q]=max(dp[i][j][q],dp[i+1][j-1][q]+2);\n\t\t\t\tif(q!=0)dp[i][j][q]=max(dp[i][j][q],dp[i+1][j-1][q-1]+2);\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=0;i<=k;i++)ma=max(ma,dp[1][s.length()][i]);//\u6ce8\u610f\u4e0d\u80fd\u8f93\u51fadp[1][s.length()][k]\n\tcout<<ma;\n\treturn 0;\n} \n```\n",
        "postTime": 1681106881,
        "uid": 451825,
        "name": "JDuru",
        "ccfLevel": 0,
        "title": "AT_agc021_d \u9898\u89e3"
    },
    {
        "content": "## AGC021 D\n**[\u9898\u76ee\u94fe\u63a5](https://atcoder.jp/contests/agc021/tasks/agc021_d)**\n___\n**\u9898\u76ee\u5927\u610f**  \n\u7ed9\u4e00\u4e2a\u5b57\u7b26\u4e32 $s$\uff0c\u53ef\u4ee5\u5c06 $s$ \u4e2d\u6700\u591a $K$ \u4e2a\u5b57\u7b26\u66f4\u6539\u4e3a\u4efb\u4f55\u5176\u4ed6\u5b57\u7b26\uff0c\u4f7f $s$ \u548c $s$ \u7684\u53cd\u4e32 $s'$ \u7684\u6700\u957f\u516c\u5171\u5b50\u533a\u95f4\u957f\u5ea6\u6700\u5927\uff0c\u8f93\u51fa\u8fd9\u4e2a\u957f\u5ea6\u3002\n___\n**\u9898\u89e3**  \n\u95ee\u9898\u53ef\u4ee5\u8f6c\u5316\u4e3a\u6c42\u66f4\u6539\u540e\u7684 $s$ \u7684\u6700\u957f\u56de\u6587\u5b50\u5e8f\u5217\u957f\u5ea6\u3002\n\u8bbe $dp(i,j,k)$ \u8868\u793a\u533a\u95f4 $[i,j]$ \u5df2\u7ecf\u4fee\u6539\u4e86 $k$ \u4e2a\u5b57\u7b26\u7684\u6700\u957f\u56de\u6587\u5b50\u5e8f\u5217\u957f\u5ea6\u3002  \n\u521d\u59cb\u5316 $dp(i,i,0)\\gets1$\u3002\n\n$$\ndp(i,j,k)\\gets\\max(dp(i+1,j,k),dp(i,j-1,k))\n$$\n\n\u5f53 $s(i)=s(j)$ \u65f6\uff1a\n$$\ndp(i,j,k)\\gets\\max(dp(i,j,k),dp(i+1,j-1,k)+2)\n$$\n\u5f53 $k\\neq0$ \u65f6\uff1a\n$$\ndp(i,j,k)\\gets\\max(dp(i,j,k),dp(i+1,j-1,k-1)+2)\n$$\n\n___\n**\u4ee3\u7801**\n```cpp\n#include <iostream>\n#include <cstring>\n#include <algorithm>\n#include <cstdio>\nusing namespace std;\nconst int MAXN = 305;\nchar s[MAXN];\nint K, dp[MAXN][MAXN][MAXN], ans;\nint main()\n{\n    scanf(\"%s%d\", s + 1, &K);\n    int n = strlen(s + 1);\n    for (int i = 1; i <= n; i++)\n    {\n        dp[i][i][0]=1;\n    }\n    for (int m = 1; m <= n; m++)\n    {\n        for (int i = 1; i + m <= n; i++)\n        {\n            int j = i + m;\n            for (int k = 0; k <= K; k++)\n            {\n                dp[i][j][k] = max(dp[i + 1][j][k], dp[i][j - 1][k]);\n                if (s[i] == s[j])\n                {\n                    dp[i][j][k] = max(dp[i][j][k], dp[i + 1][j - 1][k] + 2);\n                }\n                if (k != 0)\n                {\n                    dp[i][j][k] = max(dp[i][j][k], dp[i + 1][j - 1][k - 1] + 2);\n                }\n            }\n        }\n    }\n    for (int i = 0; i <= K; i++)\n    {\n        ans = max(ans, dp[1][n][i]);\n    }\n    cout << ans;\n    return 0;\n}\n```",
        "postTime": 1612094287,
        "uid": 236006,
        "name": "cymrain07",
        "ccfLevel": 7,
        "title": "AT3870\uff08AGC021D\uff09"
    }
]
[
    {
        "content": "# [ABC267Ex] Odd Sum \u9898\u89e3\n\n\u6ca1\u6709\u9898\u89e3\u6240\u4ee5\u5199\u4e00\u4e2a\uff0c\u672c\u8d28\u4e0a\u8fd9\u9053\u9898\u601d\u7ef4\u4e0a\u5e76\u4e0d\u56f0\u96be\u3002\n\n\u8981\u6c42\u5947\u6570\uff0c\u80af\u5b9a\u548c\u5076\u6570\u8131\u4e0d\u4e86\u5e72\u7cfb\u3002\u5e38\u89c4\u7684 01 \u80cc\u5305\u64cd\u4f5c\u662f $O(nm)$ \u7684\uff0c\u4e0d\u80fd\u901a\u8fc7\u672c\u9898\u3002\n\n\u4e00\u822c\u7684 01 \u80cc\u5305\u95ee\u9898\u90fd\u662f\u6709\u591a\u9879\u5f0f\u610f\u4e49\u7684\uff0c\u6bd4\u5982\u7ed9\u5b9a $n$ \u4e2a\u7269\u54c1\u91cd\u91cf\u5206\u522b\u4e3a $A_1,A_2,\\dots,A_n$\uff0c\u5219 $[x^k]\\prod (1+x^{A_i})$ \u5373\u4e3a\u51d1\u51fa\u91cd\u91cf\u4e3a $k$ \u7684\u65b9\u6848\u6570\u3002\n\n## \u89e3\u6cd5 1\n\n\u4e00\u822c\u60c5\u51b5\u4e0b\u66b4\u529b\u4e58\u8fd8\u662f $O(nm)$ \u7684\uff0c\u6ce8\u610f\u5230\u503c\u57df\u975e\u5e38\u7684\u5c0f\uff0c\u6240\u4ee5\u5bf9\u4e8e\u91cd\u91cf\u76f8\u540c\u7684\u7269\u54c1\u53ef\u4ee5\u770b\u4f5c\u77ed\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u3002\n\n\u77ed\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u662f\u53ef\u4ee5\u5728 $O(m)$ \u7684\u65f6\u95f4\u5185\u6c42\u89e3\u7684\uff0c\u6c42\u89e3\u51fa\u6765\u4e4b\u540e\u53ef\u4ee5\u628a\u591a\u9879\u5f0f\u7cfb\u6570\u62c6\u5206\u4e3a $\\displaystyle\\sum_{i\\equiv 0\\pmod {2A_i}}a_ix^i$ \u548c $\\displaystyle\\sum_{i\\equiv A_i\\pmod {2A_i}}a_ix^i$ \u7684\u4e24\u4e2a\u591a\u9879\u5f0f\uff0c\u5206\u522b\u8868\u793a\u9009\u5076\u6570\u4e2a\u7269\u54c1\u548c\u5947\u6570\u4e2a\u7269\u54c1\uff08\u4e0d\u8fc7\u6211\u66f4\u5efa\u8bae\u76f4\u63a5\u7ec4\u5408\u610f\u4e49\uff09\uff0c\u4e0d\u59a8\u8bbe\u4e3a $F$ \u548c $G$\u3002\u5408\u5e76\u65f6\uff0c\u6709 $F'=F_1F_2+G_1G_2, G'=F_1G_2+G_1F_2$\u3002\n\n\u597d\u6d88\u606f\u662f\u6a21\u6570\u662f $998\\,244\\,353$\uff0c\u8fd9\u4e00\u90e8\u5206\u9664\u4e86 NTT \u6211\u4e5f\u6ca1\u60f3\u5230\u5176\u5b83\u89e3\u6cd5\u3002\n\n\u6240\u4ee5\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(\\lvert A_i \\rvert m\\log m)$\uff0c\u5f53\u7136\u8fd9\u91cc $\\lvert A_i \\rvert$ \u8868\u793a\u503c\u57df\u3002\n\n\u5982\u679c\u8fd8\u4e0d\u4f1a $O(m)$ \u6c42\u77ed\u591a\u9879\u5f0f\u5feb\u901f\u5e42\u7684\u53ef\u4ee5\u770b[\u8fd9\u91cc](https://280800.blog.luogu.org/solution-at2180)\u3002\n\n~~\u660e\u660e\u7406\u8bba\u65f6\u95f4\u590d\u6742\u5ea6\u5f88\u4f18\u5374\u8dd1\u4e0d\u8fc7\u522b\u4eba\u7684[\u63d0\u4ea4\u8bb0\u5f55](https://atcoder.jp/contests/abc267/submissions/37068398)\u3002~~\n\n## \u89e3\u6cd5 2\n\n\u76f4\u63a5\u6298\u534a\uff0c\u5bf9\u5de6\u53f3\u5206\u6cbb\u6c42\u89e3\uff0c\u6700\u540e\u76f4\u63a5\u6309\u89e3\u6cd5 1 \u4e2d\u7684\u89c4\u5219\u5408\u5e76\u80cc\u5305\u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $T(n)=2T(n/2)+O(10n\\log 10n)\\approx O(m\\log m\\log n)$\u3002\n\n\u5b98\u65b9\u9898\u89e3\u662f\u7c7b\u4f3c\u54c8\u592b\u66fc\u6811\uff0c\u5dee\u4e0d\u591a\u4e5f\u662f\u8fd9\u4e2a\u590d\u6742\u5ea6\u3002\n\n---\n\n\u9898\u5916\u8bdd\uff1a[zhoukangyang](https://atcoder.jp/users/zhoukangyang) \u6709\u4e2a\u795e\u79d8\u7684[\u7ec4\u5408\uff08\u7c7b\u4f3c\uff1f\uff09\u505a\u6cd5](https://atcoder.jp/contests/abc267/submissions/34808890)\u3002",
        "postTime": 1670376851,
        "uid": 280800,
        "name": "lingfunny",
        "ccfLevel": 7,
        "title": "[ABC267Ex] Odd Sum \u9898\u89e3"
    },
    {
        "content": "\u76f4\u63a5\u66b4\u529b\u8dd1\u80cc\u5305\u7684\u590d\u6742\u5ea6\u592a\u9ad8\u4e86\uff0c\u8003\u8651\u4f18\u5316\u3002\n\n\u53d1\u73b0\u503c\u57df\u5f88\u5c0f\uff0c\u5bf9\u503c\u57df\u4ece\u5c0f\u5230\u5927\u8dd1\u80cc\u5305\u3002\u8bbe $f_i$ \u4e3a\u7528\u5947\u6570\u4e2a\u6570\u51d1\u51fa\u548c\u4e3a $i$ \u7684\u65b9\u6848\u6570\uff0c\u76f8\u5bf9\u5730 $g_i$ \u662f\u7528\u5076\u6570\u4e2a\u6570\u3002\u8bbe\u5f53\u524d\u679a\u4e3e\u5230\u7684\u503c\u4e3a $x$\uff0c\u6570\u91cf\u4e3a $c_x$\uff0c\u90a3\u4e48\u6211\u4eec\u8981\u505a\u7684\u5c31\u662f\uff1a\n\n- $f_i \\times \\binom{c_x}{d} \\to f_{i + dx}, d \\mid 2$\uff1b\n- $f_i \\times \\binom{c_x}{d} \\to g_{i + dx}, d \\nmid 2$\uff1b\n- $g_i \\times \\binom{c_x}{d} \\to f_{i + dx}, d \\nmid 2$\uff1b\n- $g_i \\times \\binom{c_x}{d} \\to g_{i + dx}, d \\mid 2$\u3002\n\n\u81f3\u6b64\u53ef\u4ee5\u89c2\u5bdf\u51fa\u5377\u79ef\u5f62\u5f0f\uff0cNTT \u4f18\u5316\u3002\n\n\u6bcf\u6b21\u679a\u4e3e $x$\uff0c\u5b9e\u9645\u4e0a\u8981\u505a $4$ \u6b21\u5377\u79ef\uff0c$12$ \u6b21 NTT\u3002\u76f4\u63a5\u8dd1\u662f $O(120 m \\log m)$ \u7684\uff0c\u8fd8\u662f\u8fc7\u4e0d\u53bb\u3002\u8003\u8651\u505a\u4e00\u4e9b\u4e0a\u754c\u7684\u4f18\u5316\uff0c$f_i, g_i$ \u7684\u4e0b\u6807\u4e0a\u754c\u8bbe\u7f6e\u4e3a $\\sum\\limits_{j=1}^x j \\times c_j$\uff0c\u5c31\u53ef\u4ee5\u901a\u8fc7\u4e86\u3002\n\n[code](https://atcoder.jp/contests/abc267/submissions/41672549)",
        "postTime": 1684936442,
        "uid": 275273,
        "name": "zltqwq",
        "ccfLevel": 0,
        "title": "ABC267Ex \u9898\u89e3"
    },
    {
        "content": "\u8003\u8651\u4e8c\u5143 OGF\uff0c\u663e\u7136\u4e3a\uff1a\n$$\n\\prod_{i=1}^n (1+x^{a_i} y)\n$$\n\u3002\u8003\u8651\u6211\u4eec\u53ea\u9700\u8981\u7ef4\u62a4\u5bf9 $y^2 - 1$ \u7684\u5546\u73af\uff0c\u8003\u8651 $\\mathbb R[x]/(x^2-1) \\sim \\mathbb R^2$\uff0c\u5219\u8003\u8651\u5206\u6210\u4e24\u4e2a\u591a\u9879\u5f0f $O,E$\u3002\u5219\u6709\uff1a\n$$\n\\begin{aligned}\nO(a \\sqcup b) = O(a)E(b) + O(b)E(a) \\\\\nE(a \\sqcup b) = O(a)O(b) + E(a)E(b)\n\\end{aligned}\n$$\n\uff0c\u5206\u6cbb\u7ef4\u62a4\u5373\u53ef\u3002",
        "postTime": 1675936490,
        "uid": 360265,
        "name": "lhx1048576",
        "ccfLevel": 6,
        "title": "Orz"
    },
    {
        "content": "# Perface\n\u4e5f\u8bb8\u662f\u56e0\u4e3a\u7f51\u4e0a\u6284\u7684 $\\mathtt{NTT}$ \u677f\u5b50\uff0c\u8dd1\u5230\u4e86\u6700\u4f18\u89e3 rank 2\uff0c\u90a3\u5c31\u6765\u4e00\u7bc7\u65b0\u624b\u5411\u9898\u89e3\u5427\u3002\n# Analysis\n\u8bb0 $\\text{od}_i$ \u4e3a\u9009\u5947\u6570\u4e2a\u6570\uff0c\u548c\u4e3a $i$ \u7684\u65b9\u6848\u6570\uff0c$\\text{ev}_i$ \u4e3a\u9009\u5076\u6570\u4e2a\u6570\uff0c\u548c\u4e3a $i$ \u7684\u65b9\u6848\u6570\u3002\n\n\u7136\u540e\u8bbe\u5f62\u5f0f\u5e42\u7ea7\u6570 $O(x)=\\sum \\text{od}_i x^i,E(x)=\\sum \\text{ev}_i x^i$\u3002\n\n\u9996\u5148\uff0c$F(x)=E(x)+O(x)=\\prod\\limits_{i=1}^{n}(1+x^{a_i})$\uff0c\u5373\u5bf9 $a$ \u505a\u8ba1\u6570\u80cc\u5305\u3002\n\n\u53d7\u5230\u548c\u5dee\u5bf9\u5076\u5173\u7cfb\u7684\u542f\u53d1\uff0c\u6211\u4eec\u4e0d\u59a8\u7814\u7a76\u4e00\u4e0b $G(x)=\\prod\\limits_{i=1}^{n}(1-x^{a_i})$ \u4ee3\u8868\u7740\u4ec0\u4e48\u3002\n\n\u8bb0 $\\text{coef}=[x^i]G(x)$\u3002\n\n\u82e5\u6709 $\\sum\\limits_{j=1}^m a_{p_j}=i$\uff1a\n\n+ $m$ \u4e3a\u5947\u6570\n\n$\\text{coef}\\gets\\text{coef}-1$\n\n+ $m$ \u4e3a\u5076\u6570\n\n$\\text{coef}\\gets\\text{coef}+1$\n\n\u6240\u4ee5 $[x^i]G(x)=\\text{coef}=\\text{ev}_i-\\text{od}_i$\u3002\n\n\u5373 $G(x) = E(x) - O(x)$\u3002\n\n\u7efc\u4e0a\uff0c$O(x)=\\dfrac{1}{2}(F(x)-G(x))$\u3002\n\n\u6211\u4eec\u6709\u4e00\u4e2a\u5c0f\u4f18\u5316\uff0c\u89c2\u5bdf\u5230\u6570\u636e\u8303\u56f4\u4e2d $x \\leq 10$\uff0c\u6211\u4eec\u8bb0 $\\text{cnt}_i$ \u4e3a $i$ \u7684\u51fa\u73b0\u6b21\u6570\u3002\n\n\u90a3\u4e48 $F(x)=\\prod\\limits_{i=1}^{10}(1+x^{i})^{\\text{cnt}_i}$\u3002\n\n$G$ \u540c\u7406\u3002\n\n\u7528\u4e8c\u9879\u5f0f\u5b9a\u7406\u5c55\u5f00\u4e2d\u95f4\u7684\u9879\uff0c\u7136\u540e\u5206\u6cbb $\\mathtt{NTT}$ \u4e58\u8d77\u6765\u5c31\u597d\u4e86\u3002\n\n**[code](https://atcoder.jp/contests/abc267/submissions/37602386)**",
        "postTime": 1672236675,
        "uid": 551375,
        "name": "junxis",
        "ccfLevel": 5,
        "title": "[ABC267Ex] Odd Sum"
    },
    {
        "content": "\u4e00\u4e2a\u5f88\u663e\u7136\u7684\u601d\u8def\u5c31\u662f\u8bbe $f[i][j][o]$ \u8868\u793a\u76ee\u524d\u5230\u4e86\u7b2c $i$ \u4e2a\u6570\uff0c\u548c\u4e3a $j$\u3001\u9009\u4e86 $o$ \u4e2a\u6570\u7684\u65b9\u6848\u6570\u7136\u540e dp\u3002$o$ \u662f\u7528\u6765\u5224\u65ad\u5947\u5076\u6027\u7684\uff0c\u53d6\u503c\u53ea\u9700\u8981\u662f $1$ \u6216 $0$\u3002\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal O(nm)$ \u7684\u3002\n\n\n0-1 \u80cc\u5305\u7ec4\u5408\u95ee\u9898\u662f\u6709\u591a\u9879\u5f0f\u610f\u4e49\u7684\u3002\u8bb0\u7b2c $i$ \u4e2a\u6570 $a_i$\uff0c\u5219 $\\prod _{i=1}^{n}(1+x^{a_i})$ \u7684 $x^v$ \u9879\u7684\u7cfb\u6570\u5c31\u662f\u51d1\u6210 $v$ \u7684\u65b9\u6848\u6570\u3002**\u8fd9\u662f\u4e2a\u7ed3\u8bba**\u3002\n\n\u7ed9\u4e2a\u7b80\u5355\u7684\u8bc1\u660e\u3002\u627e\u89c4\u5f8b\uff1a\n\n- $2$ \u4e2a\u7269\u54c1\u80fd\u51d1\u51fa\u7684\u65b9\u6848\u6570\u4e3a $\\{0,a_1,a_2,a_1+a_2\\}$\uff1b\n- $3$ \u4e2a\u7269\u54c1\u80fd\u51d1\u51fa\u7684\u65b9\u6848\u6570\u4e3a $\\{0,a_1,a_2,a_3,a_1+a_2,a_1+a_3,a_2+a_3,a_1+a_2+a_3\\}$\uff1b\n- \u2026\u2026\n\n\u975e\u5e38\u50cf\u5b50\u96c6\u679a\u4e3e\u3002\u4f46\u662f\u8981\u628a**\u503c\u76f8\u540c**\u7684\u9879\u5408\u5e76\u8d77\u6765\uff0c\u4e0d\u592a\u597d\u5904\u7406\u3002\u5176\u5b9e\u52a0\u6cd5\u53ef\u4ee5\u901a\u8fc7\u6307\u6570\u8f6c\u5316\u6210\u4e58\u6cd5\uff0c\u5373\u8fdb\u884c $a_1+a_2 \\rightarrow x^{a_1+a_2}$ \u7684\u8f6c\u5316\u3002\u800c\u8fd9\u53ef\u4ee5\u5316\u6210\u591a\u4e2a\u591a\u9879\u5f0f\u76f8\u4e58\u7684\u5f62\u5f0f\uff1a\u5373 $\\prod _{i=1}^{n}(1+x^{a_i})$\u3002\n\n\u56e0\u4e3a\u9650\u5236\u7684\u662f\u5947\u6570\u4e2a\uff0c\u601d\u8003\u600e\u4e48\u5bb9\u65a5\u6389\u9009\u4e86\u5076\u6570\u4e2a\u7684\u65b9\u6848\u6570\u3002\u9700\u8981\u627e\u5230\u67d0\u4e2a\u6570\uff0c\u4e58\u4ee5\u5947\u6570\u6b21\u548c\u4e58\u4ee5\u5076\u6570\u6b21\u7684\u7ed3\u679c\u4e0d\u540c\u3002\u5f88\u663e\u7136 $-1$ \u5c31\u6ee1\u8db3\u8981\u6c42\u3002\n\n\u56e0\u6b64\uff0c$a_i$ \u9879\u7684\u7cfb\u6570\u5c31\u662f $-1$\u3002$\\prod _{i=1}^{n}(1-x^{a_i})$ \u5c31\u662f\u7b26\u5408\u8981\u6c42\u7684\u591a\u9879\u5f0f\u3002\u611f\u6027\u7406\u89e3\u4e0b\uff0c\u5947\u6570\u4e2a $x^{a_i}$ \u4e58\u8d77\u6765\u662f\u8d1f\u6570\uff0c\u800c\u5076\u6570\u4e2a\u4e58\u8d77\u6765\u662f\u6b63\u6570\u3002\u4e25\u683c\u8bc1\u660e\u4e5f\u4e0d\u96be\uff0c\u5c31\u4e0d\u5199\u4e86\u3002\n\n\u4ee4 $F=\\prod _{i=1}^{n}(1+x^{a_i}),G=\\prod _{i=1}^{n}(1-x^{a_i})$\u3002\u8bb0 $P[i]$ \u8868\u793a $x^i$ \u7684\u7cfb\u6570\uff0c\u90a3\u4e48 $F[m]$ \u5c31\u662f**\u4e0d\u8003\u8651\u5947\u5076**\u7684\u65b9\u6848\u6570\uff0c$G[m]$ \u5c31\u662f**\u5076\u6570\u65b9\u6848\u6570\u51cf\u53bb\u5947\u6570\u65b9\u6848\u6570**\u3002\n\n\u6700\u7ec8\u7b54\u6848\u5c31\u662f $\\frac{F[m]-G[m]}{2}$\u3002\u8bb0\u5f97\u9664\u4ee5\u4e8c\uff0c\u56e0\u4e3a\u5947\u6570\u88ab\u7b97\u4e86\u4e24\u6b21\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal(m\\log m \\log n)$\uff0c\u80fd\u8fc7\u3002\u5173\u952e\u4ee3\u7801\u5982\u4e0b\uff1a\n\n```cpp\nconst int mod=998244353,maxn=500000+5;\npoly F[maxn],G[maxn];//poly \u677f\u5b50\u5c31\u4e0d\u653e\u4e86\nint main(){\n    int n,m;cin>>n>>m;\n    for(int i=1;i<=n;i++)cin>>a[i];\n    for(int i=1;i<=n;i++)F[i][0]=G[i][0]=1,F[i][a[i]]=1,G[i][a[i]]=mod-1;\n    for(int i=2;i<=n;i++)F[i]=F[i-1]*F[i],G[i]=G[i-1]*G[i];\n    cout<<1ll*((1ll*F[n][m]-G[n][m])%mod+mod)%mod*qpow(2,mod-2)%mod;\n}\n```\n\nLingfunny \u6709\u66f4\u4f18\u7684[\u89e3\u6cd5](https://280800.blog.luogu.org/solution-at-abc267-h)\uff0c\u662f $\\mathcal O(m\\log mV)$ \u7684\u3002\n\n~~\u4f46\u662f\u6ca1\u6211\u5feb~~\n\n",
        "postTime": 1670839552,
        "uid": 188950,
        "name": "UruhaRushia",
        "ccfLevel": 6,
        "title": "ABC267Ex"
    }
]
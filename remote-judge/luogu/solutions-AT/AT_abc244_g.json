[
    {
        "content": "\u5c45\u7136\u6ca1\u4eba\u5199\u9898\u89e3\u3002\n\n\u9996\u5148\u8003\u8651\u5728\u4e00\u6761\u94fe\u4e0a\u600e\u4e48\u505a\u3002\u4ece\u94fe\u7684\u4e00\u4e2a\u9876\u70b9\u5f00\u59cb\uff0c\u5f80\u5b83\u7684\u540e\u7ee7\u8d70\u3002\u5982\u679c\u4e00\u4e2a\u70b9\u7684\u524d\u9a71\u4e0d\u6ee1\u8db3\u8981\u6c42\uff0c\u5c31\u8d70\u53bb\u524d\u9a71\u518d\u8d70\u56de\u6765\u3002\u79f0\u4e4b\u4e3a\u8c03\u6574\u64cd\u4f5c\u3002\n\n\u8fd9\u65f6\u5019\u5c31\u4f1a\u6709\u4e00\u4e2a\u95ee\u9898\uff1a\u5982\u679c\u6700\u540e\u4e00\u4e2a\u70b9\u6ca1\u6709\u529e\u6cd5\u8c03\u6574\u600e\u4e48\u529e\uff1f\n\n\u4e8b\u5b9e\u4e0a\uff0c\u6700\u540e\u4e00\u6b65\u4f1a\u8d70\u5230\u6700\u540e\u4e00\u4e2a\u70b9\uff0c\u800c\u8fd9\u6700\u540e\u4e00\u6b65\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u8d70\u6216\u4e0d\u8d70\uff0c\u8fd9\u6837\u5224\u65ad\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u6700\u540e\u4e00\u4e2a\u70b9\u6ee1\u8db3\u6761\u4ef6\u4e86\u3002\n\n\u63a5\u4e0b\u6765\u63a8\u5e7f\u5230\u4e00\u68f5\u6811\u7684\u60c5\u51b5\u3002\u5176\u5b9e\u6ca1\u5565\u533a\u522b\u3002\u5224\u65ad\u4e00\u4e0b\u8d70\u4e86\u8fd9\u4e2a\u70b9\u4e4b\u540e\u8981\u4e0d\u8981\u56de\u6eaf\uff0c\u5206\u8ba8\u4e00\u4e0b\u5373\u53ef\u3002\u5177\u4f53\u53ef\u4ee5\u53c2\u8003\u4ee3\u7801\u5b9e\u73b0\u3002\n\n\u5728\u56fe\u4e0a\u8dd1\u51fa\u4e00\u68f5\u751f\u6210\u6811\uff0c\u8fdb\u884c\u4ee5\u4e0a\u64cd\u4f5c\u5373\u53ef\u3002\n\n\u8fd9\u6837\u7684\u8def\u5f84\u957f\u5ea6\u4e00\u5b9a\u4e0d\u8d85\u8fc7 $4N$ \u5417\uff1f\n\n\u5982\u679c\u6ca1\u6709\u8c03\u6574\u64cd\u4f5c\uff0c\u56e0\u4e3a\u6709\u56de\u6eaf\u7684\u5b58\u5728\uff0c\u8def\u5f84\u6700\u957f $2N$\u3002\u6bcf\u6b21\u8c03\u6574\u4f1a\u6709 $2$ \u6b65\uff0c\u6bcf\u4e2a\u70b9\u6700\u591a\u8c03\u6574\u4e00\u6b21\uff0c\u6240\u4ee5\u6700\u540e\u957f\u5ea6\u4e0d\u4f1a\u8d85\u8fc7 $4N$\u3002\n\ncode\uff1a\n\n```cpp\nint n,m;\nint tot,head[N];\nchar s[N];\nbool vis[N];\nstruct node{\n\tint to,nxt,cw;\n}e[M<<1];\nvector<int> ans;\ninline void add(int u,int v){\n\te[++tot]={v,head[u],0};\n\thead[u]=tot;\n}\nint siz[N],son[N];\nvoid init(int u,int f){\n\tsiz[u]=1;\n\tvis[u]=true;\n\tfor(int i=head[u];i;i=e[i].nxt){\n\t\tint v=e[i].to;\n\t\tif(vis[v]){\n\t\t\tcontinue;\n\t\t}\n\t\te[i].cw=1;\n\t\tinit(v,u);\n\t\tsiz[u]+=siz[v];\n\t\tif(siz[v]>siz[son[u]]){\n\t\t\tson[u]=v;\n\t\t}//\u8fd9\u91cc\u4e0d\u4e00\u5b9a\u8981\u627e\u91cd\u513f\u5b50\uff0c\u53ea\u662f\u5c3d\u91cf\u4f7f\u8def\u5f84\u957f\u5ea6\u77ed\u800c\u5df2\uff0c\u4e8b\u5b9e\u4e0a\u968f\u610f\u627e\u4e00\u4e2a\u513f\u5b50\u5373\u53ef\n\t}\n}\nint cnt[N];\nvoid dfs(int u,int f,bool rt){//rt\u8bb0\u5f55\u662f\u5426\u8981\u56de\u6eaf\n\tcnt[u]++;\n\tvis[u]=true;\n\tans.push_back(u);\n\tfor(int i=head[u];i;i=e[i].nxt){\n\t\tint v=e[i].to;\n\t\tif(!e[i].cw||vis[v]||(!rt&&v==son[u])){\n\t\t\tcontinue;\n\t\t}\n\t\tdfs(v,u,1);\n\t\tans.push_back(u);\n\t\tcnt[u]++;\n\t}\n\tif(rt){\n\t\tif((cnt[u]&1)!=s[u]-'0'){\n\t\t\tans.push_back(f);\n\t\t\tans.push_back(u);\n\t\t\tcnt[f]++;\n\t\t\tcnt[u]++;\n\t\t}//\u8c03\u6574\n\t}else{\n\t\tif(!son[u]){\n\t\t\treturn;\n\t\t}\n\t\tif((cnt[u]&1)!=s[u]-'0'){\n\t\t\tans.push_back(son[u]);\n\t\t\tans.push_back(u);\n\t\t\tcnt[son[u]]++;\n\t\t\tcnt[u]++;\n\t\t}//\u8c03\u6574\n\t\tdfs(son[u],u,0);\n\t}\n}\nvoid solve(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1,u,v;i<=m;i++){\n\t\tscanf(\"%d%d\",&u,&v);\n\t\tadd(u,v);\n\t\tadd(v,u);\n\t}\n\tscanf(\"%s\",s+1);\n\tinit(1,0);\n\tmems(vis,false);\n\tdfs(1,0,0);\n\tif((cnt[ans.back()]&1)!=s[ans.back()]-'0'){\n\t\tans.pop_back();\n\t}//\u5224\u65ad\u6700\u540e\u4e00\u6b65\u8d70\u4e0d\u8d70\u4ee5\u8c03\u6574\u6700\u540e\u4e00\u4e2a\u70b9\n\tprintf(\"%d\\n\",(int)ans.size());\n\tfor(int i:ans){\n\t\tprintf(\"%d \",i);\n\t}\n}\nsigned main(){\n\tint t=1;\n\t//\tscanf(\"%d\",&t);\n\twhile(t--)solve();\n}\n```",
        "postTime": 1682407531,
        "uid": 740322,
        "name": "_Ritsu_",
        "ccfLevel": 0,
        "title": "ABC244G"
    }
]
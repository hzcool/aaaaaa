[
    {
        "content": "\u663e\u7136\u4e0d\u80fd\u66b4\u529b\u7b97\u4e24\u4e24\u7684\u4e58\u79ef\uff0c\u800c\u79ef\u53d6\u6a21\u800c\u7ed3\u679c\u4e0d\u53d6\u6a21\u63d0\u793a\u6211\u4eec\u6a21\u6570\u80af\u5b9a\u6709\u7528\u3002\n\n\u6240\u6709\u4e3a $0$ \u7684 $a_i$ \u5bf9\u7b54\u6848\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u8d21\u732e\uff0c\u53ef\u4ee5\u76f4\u63a5\u5220\u9664\uff0c\u4e0b\u6587\u4e0d\u518d\u8003\u8651\u8fd9\u79cd\u60c5\u51b5\u3002\u540c\u65f6\u6211\u4eec\u7ea6\u5b9a\uff0c\u4e0b\u6587\u7684\u8fd0\u7b97\uff08\u9664\u7279\u6b8a\u8bf4\u660e\u5916\uff09\u5747\u4e3a\u6a21 $P$ \u610f\u4e49\u4e0b\u7684\u7ed3\u679c\u3002\n\n\u8bbe $g$ \u4e3a $P$ \u7684\u539f\u6839\uff0c\u5219\u6bcf\u4e2a $a_i$ \u90fd\u53ef\u4ee5\u8868\u793a\u4e3a $g^{c_i}$ \u7684\u5f62\u5f0f\uff0c\u800c $a_ia_j=g^{c_i+c_j}$\u3002\u56e0\u6b64\u8bbe $a$ \u4e2d\u7b49\u4e8e $g^{i}$ \u7684\u6570\u6709 $A_i$ \u4e2a\uff0c\u5219\u4e58\u79ef\u4e3a $g^k$ \u7684\u6709\u5e8f\u6570\u5bf9\u6709 $\\sum\\limits_{i+j=k}A_iA_j$ \u4e2a\uff0c\u662f\u5377\u79ef\u5f62\u5f0f\uff0c\u7528 FFT \u4f18\u5316\u4e4b\u3002\n\n\u6ce8\u610f\u6839\u636e\u9898\u610f\uff0c\u7b54\u6848\u9700\u8981\u53bb\u6389\u6240\u6709 $a_i^2$ \u7684\u8d21\u732e\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $\\Theta(P\\log P)$\u3002\n\n\u6211\u7684\u4ee3\u7801\u4e2d $g=114513$\uff0c\u5f53\u7136\u4f60\u4e5f\u53ef\u4ee5\u7528 $2$ \u6216\u8005\u5176\u4ed6\u539f\u6839\u3002\n\n```cpp\n// Problem: C - Product Modulo\n// Contest: AtCoder - AtCoder Grand Contest 047\n// URL: https://atcoder.jp/contests/agc047/tasks/agc047_c\n// Memory Limit: 1024 MB\n// Time Limit: 2000 ms\n// \n// Powered by CP Editor (https://cpeditor.org)\n\n//By: OIer rui_er\n#include <bits/stdc++.h>\n#define rep(x,y,z) for(ll x=(y);x<=(z);x++)\n#define per(x,y,z) for(ll x=(y);x>=(z);x--)\n#define debug(format...) fprintf(stderr, format)\n#define fileIO(s) do{freopen(s\".in\",\"r\",stdin);freopen(s\".out\",\"w\",stdout);}while(false)\nusing namespace std;\ntypedef long long ll;\ntypedef complex<double> cp;\nconst ll N = 2e6+5, P = 200003, g = 114513;\nconst double pi = acos(-1);\n\nll n, a[N], pw[N], pos[N], cnt[N], rev[N], ans;\ncp A[N];\ntemplate<typename T> void chkmin(T& x, T y) {if(x > y) x = y;}\ntemplate<typename T> void chkmax(T& x, T y) {if(x < y) x = y;}\nvoid change(cp* a, ll n) {\n\trep(i, 0, n-1) {\n\t\trev[i] = rev[i >> 1] >> 1;\n\t\tif(i & 1) rev[i] |= n >> 1;\n\t}\n\trep(i, 0, n-1) if(i < rev[i]) swap(a[i], a[rev[i]]);\n}\nvoid FFT(cp* a, ll n, ll sgn) {\n\tchange(a, n);\n\tfor(ll l = 2, o = 1; l <= n; l <<= 1, o <<= 1) {\n\t\tcp w(cos(2.0*pi/l), sgn*sin(2.0*pi/l));\n\t\tfor(ll i = 0; i < n; i += l) {\n\t\t\tcp now = 1;\n\t\t\trep(j, i, i+o-1) {\n\t\t\t\tcp u = a[j], v = a[j + o];\n\t\t\t\ta[j] = u + v * now;\n\t\t\t\ta[j + o] = u - v * now;\n\t\t\t\tnow *= w;\n\t\t\t}\n\t\t}\n\t}\n\tif(sgn == -1) rep(i, 0, n-1) a[i] /= n;\n}\n\nint main() {\n\tpw[0] = 1;\n\tpos[1] = 0;\n\trep(i, 1, P-2) {\n\t\tpw[i] = g * pw[i-1] % P;\n\t\tpos[pw[i]] = i;\n\t}\n\tscanf(\"%lld\", &n);\n\trep(i, 1, n) scanf(\"%lld\", &a[i]);\n\trep(i, 1, n) if(a[i]) ++cnt[pos[a[i]]];\n\trep(i, 0, P-2) A[i] = cnt[i];\n\tll m = 1;\n\tfor(; m <= P + P; m <<= 1);\n\tFFT(A, m, 1);\n\trep(i, 0, m-1) A[i] *= A[i];\n\tFFT(A, m, -1);\n\trep(i, 0, 2*(P-2)) ans += (ll)(A[i].real() + .5) * pw[i%(P-1)];\n\trep(i, 0, P-2) ans -= cnt[i] * pw[2*i%(P-1)];\n\tprintf(\"%lld\\n\", ans / 2);\n\treturn 0;\n}\n```",
        "postTime": 1670217006,
        "uid": 122461,
        "name": "rui_er",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 [AGC047C] Product Modulo"
    }
]
[
    {
        "content": "# [[ABC257F] Teleporter Setting](https://www.luogu.com.cn/problem/AT_abc257_f) Solution\n\n[TOC]\n\n## [\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c\u6233\u6b64\u8fdb\u5165](http://blog.tsawke.com?t=ABC257F)\n\n## \u9898\u9762\n\n\u5b58\u5728 $ n $ \u4e2a\u5c0f\u9547\uff0c$ m $ \u6761\u4f20\u9001\u901a\u9053\uff0c\u7b2c $ i $ \u6761\u53cc\u5411\u8fde\u7ed3 $ u_i, v_i $ \u4e24\u4e2a\u5c0f\u9547\uff0c\u7ecf\u8fc7\u6bcf\u4e2a\u4f20\u9001\u901a\u9053\u9700\u8981\u82b1\u8d39 $ 1 $ \u5206\u949f\u3002\u7279\u522b\u5730\uff0c\u53ef\u80fd\u5b58\u5728 $ u_i = 0 $\uff0c\u8868\u793a\u8be5\u6761\u4f20\u9001\u901a\u9053\u53ea\u89c4\u5b9a\u4e86\u4e00\u7aef\uff0c\u53e6\u4e00\u7aef\u5f85\u5b9a\u3002\u5b58\u5728 $ n $ \u4e2a\u72ec\u7acb\u8be2\u95ee\uff0c\u5bf9\u4e8e $ i = 1, 2, \\cdots, n $\uff0c\u94a6\u5b9a\u6240\u6709\u672a\u786e\u5b9a\u7684 $ u_i $ \u5747\u4e3a $ i $\uff0c\u6c42\u4ece\u5c0f\u9547 $ 1 $ \u5230\u5c0f\u9547 $ n $ \u6700\u5c0f\u8017\u8d39\u7684\u65f6\u95f4\u3002\u82e5\u65e0\u6cd5\u5230\u8fbe\u8f93\u51fa $ -1 $\u3002\n\n## Solution\n\n\u7b97\u662f\u4e00\u9053\u633a\u597d\u7684\u9898\u3002\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u8fdb\u884c\u5982\u4e0b\u8f6c\u5316\uff0c\u5bf9\u4e8e\u6240\u6709 $ u_i = 0 $ \u7684\u8fb9\uff0c\u6211\u4eec\u5c06\u5176\u8fde\u7ed3\u5230\u4e00\u4e2a\u8d85\u7ea7\u6e90\u70b9 $ S $ \u4e0a\uff0c\u4e0d\u5931\u4e00\u822c\u6027\uff0c\u8bbe $ S = 0 $\uff0c\u6b64\u65f6\u5bf9\u4e8e\u6bcf\u6b21\u8be2\u95ee\uff0c\u6211\u4eec\u4ec5\u9700\u8981\u5bf9 $ S \\rightarrow i $ \u8fde\u8fb9\u5373\u53ef\u3002\u5f53\u7136\u6211\u4eec\u80af\u5b9a\u4e0d\u80fd\u6bcf\u6b21\u90fd\u7b97\u4e00\u904d\uff0c\u4e8e\u662f\u8003\u8651\u53d1\u73b0\uff0c\u5bf9\u4e8e $ 1 \\rightarrow n $ \u7684\u8def\u5f84\uff0c\u4e00\u5171\u4ec5\u53ef\u80fd\u5b58\u5728\u5982\u4e0b\u51e0\u79cd\u8d21\u732e\uff1a$ 1 \\rightarrow n $\uff0c$ 1 \\rightarrow S \\rightarrow i \\rightarrow n $\uff0c$ 1 \\rightarrow i \\rightarrow S \\rightarrow n $\uff0c\u540c\u65f6\u6ce8\u610f\u6211\u4eec\u8fd9\u91cc\u7684\u7bad\u5934\u4e0d\u662f\u8868\u793a\u76f4\u63a5\u5230\u8fbe\uff0c\u800c\u662f\u8868\u793a\u6700\u77ed\u8def\u3002\u6240\u4ee5\u4ee5\u6b64\u4e0d\u96be\u53d1\u73b0\uff0c\u6211\u4eec\u6240\u9700\u8981\u7ef4\u62a4\u7684\u5c31\u53ea\u6709 $ 1 $ \u548c $ n $ \u4e3a\u6e90\u70b9\u7684\u5355\u6e90\u6700\u77ed\u8def\uff0c\u5373\u53ef\u8868\u793a\u51fa\u6765\u6bcf\u6b21\u7684\u503c\u3002\u7136\u540e\u6bcf\u6b21\u5728\u8fd9\u4e9b\u91cc\u53d6 $ \\min $ \u5373\u53ef\uff0c\u8bb0\u5f97\u5224\u4e00\u4e0b\u65e0\u89e3\u3002\n\n## Code\n\n```cpp\n#define _USE_MATH_DEFINES\n#include <bits/stdc++.h>\n\n#define PI M_PI\n#define E M_E\n#define npt nullptr\n#define SON i->to\n#define OPNEW void* operator new(size_t)\n#define ROPNEW(arr) void* Edge::operator new(size_t){static Edge* P = arr; return P++;}\n\nusing namespace std;\n\nmt19937 rnd(random_device{}());\nint rndd(int l, int r){return rnd() % (r - l + 1) + l;}\nbool rnddd(int x){return rndd(1, 100) <= x;}\n\ntypedef unsigned int uint;\ntypedef unsigned long long unll;\ntypedef long long ll;\ntypedef long double ld;\n\ntemplate < typename T = int >\ninline T read(void);\n\nstruct Edge{\n    Edge* nxt;\n    int to;\n    OPNEW;\n}ed[610000];\nROPNEW(ed);\nEdge* head[310000];\n\nint N, M;\nint dis1[310000], disn[310000];\n\nvoid bfs1(void){\n    memset(dis1, 0x3f, sizeof dis1);\n    bitset < 310000 > vis; vis.reset();\n    queue < int > cur; cur.push(1), vis[1] = true, dis1[1] = 0;\n    while(!cur.empty()){\n        int p = cur.front(); cur.pop();\n        for(auto i = head[p]; i; i = i->nxt)\n            if(!vis[SON])\n                vis[SON] = true, dis1[SON] = dis1[p] + 1, cur.push(SON);\n    }\n}\nvoid bfsn(void){\n    memset(disn, 0x3f, sizeof disn);\n    bitset < 310000 > vis; vis.reset();\n    queue < int > cur; cur.push(N), vis[N] = true, disn[N] = 0;\n    while(!cur.empty()){\n        int p = cur.front(); cur.pop();\n        for(auto i = head[p]; i; i = i->nxt)\n            if(!vis[SON])\n                vis[SON] = true, disn[SON] = disn[p] + 1, cur.push(SON);\n    }\n}\n\nint main(){\n    N = read(), M = read();\n    for(int i = 1; i <= M; ++i){\n        int s = read(), t = read();\n        head[s] = new Edge{head[s], t};\n        head[t] = new Edge{head[t], s};\n    }bfs1(), bfsn();\n    for(int i = 1; i <= N; ++i){\n        int ans = min({dis1[N], dis1[0] + disn[i], dis1[i] + disn[0]});\n        printf(\"%d%c\", ans >= 0x3f3f3f3f ? -1 : ans, i == N ? '\\n' : ' ');\n    }\n    fprintf(stderr, \"Time: %.6lf\\n\", (double)clock() / CLOCKS_PER_SEC);\n    return 0;\n}\n\ntemplate < typename T >\ninline T read(void){\n    T ret(0);\n    int flag(1);\n    char c = getchar();\n    while(c != '-' && !isdigit(c))c = getchar();\n    if(c == '-')flag = -1, c = getchar();\n    while(isdigit(c)){\n        ret *= 10;\n        ret += int(c - '0');\n        c = getchar();\n    }\n    ret *= flag;\n    return ret;\n}\n```\n\n## UPD\n\nupdate-2022_12_09 \u521d\u7a3f",
        "postTime": 1670570061,
        "uid": 362938,
        "name": "Tsawke",
        "ccfLevel": 6,
        "title": "[ABC257F] Teleporter Setting \u9898\u89e3"
    }
]
[
    {
        "content": "[\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT_abc127_e)\n\n\u6211\u975e\u5e38\u5bb3\u6015\uff0c\u597d\u50cf\u53ea\u6709\u6211\u7528\u4e86\u8303\u5fb7\u8499\u5fb7\u5377\u79ef\u3002\n\n## \u601d\u8def\n\n\u9996\u5148\u8003\u8651\u628a\u8fd9\u4e2a $\\large \\sum \\sum$ $|x_i-x_j|+|y_i-y_j|$ \u62c6\u5f00\u6765\uff0c\u53d8\u6210 $\\large \\sum \\sum$ $|x_i-x_j|+$ $\\large \\sum \\sum$ $|y_i-y_j|$\u3002\n\n\u8fd9\u4e24\u4e2a $\\large \\sum \\sum$ \u5b9e\u9645\u4e0a\u662f\u7b49\u4ef7\u7684\uff0c\u6211\u4eec\u505a\u5b8c\u7b2c\u4e00\u4e2a $\\large \\sum \\sum$ \u540e\u628a $n,m$ \u4ea4\u6362\u4e00\u4e0b\u5c31\u53ef\u4ee5\u5f97\u5230\u7b2c\u4e8c\u4e2a $\\large \\sum \\sum$\u3002\n\n\u7136\u540e\u8003\u8651\u62c6\u7edd\u5bf9\u503c\uff0c\u5bb9\u6613\u53d1\u73b0\u82e5 $x_i>x_j$\uff0c\u90a3\u4e48 $|x_i-x_j|=x_i-x_j$\uff0c\u5426\u5219 $|x_i-x_j|=x_j-x_i$\uff0c\u7136\u540e\u5206\u79bb\u8d21\u732e\uff0c\u53d1\u73b0 $x_i$ \u7684\u8d21\u732e\u5c31\u662f\u6570\u5217\u4e2d $< x_i$ \u7684\u6570\u7684\u4e2a\u6570\u51cf\u53bb $>x_i$ \u7684\u6570\u7684\u4e2a\u6570\uff08\u76f8\u7b49\u53cd\u6b63\u662f $0$\uff0c\u4e0d\u8003\u8651\uff09\u3002\n\n\u7136\u540e\u8003\u8651\u5982\u4f55\u8ba1\u6570\u8fd9\u4e2a\u4e1c\u897f\u3002\n\n\u6211\u4eec\u679a\u4e3e\u4e00\u4e2a\u6a2a\u5750\u6807 $i$\uff0c\u7136\u540e\u679a\u4e3e\u4e00\u4e2a $j$\uff0c\u8868\u793a\u8fd9\u4e2a\u6a2a\u5750\u6807 $j$ \u9009\u4e86\u51e0\u4e2a\uff0c\u5982\u679c\u6211\u4eec\u53ef\u4ee5 $\\mathcal O(1)$ \u8ba1\u7b97\u5b83\u7684\u8d21\u732e\uff0c\u90a3\u4e48\u5c31\u8fc7\u4e86\u3002\n\n\u8003\u8651\u5217\u51fa\u6b64\u8d21\u732e\u7684\u67ff\u5b50\uff1a\u679a\u4e3e\u6211\u4eec\u9009\u4e86 $p$ \u4e2a\u6a2a\u5750\u6807 $<i$ \u7684\u70b9\uff0c\u90a3\u4e48\u6211\u4eec\u9009\u4e86 $q=k-p-j$ \u4e2a\u6a2a\u5750\u6807 $>i$ \u7684\u70b9\u3002\n\n\u8bbe $s=(i-1) \\times m$\uff0c$t=(n-i) \\times m$\u3002\u90a3\u4e48\u6211\u4eec\u9009\u51fa $p$ \u4e2a\u70b9\u548c $q$ \u4e2a\u70b9\u7684\u65b9\u6848\u6570\u5c31\u662f $\\dbinom{s}{p} \\times \\dbinom{t}{q}$\u3002\n\n\u7136\u540e\u8003\u8651\u5f53\u524d\u6a2a\u5750\u6807\u7684\u8d21\u732e\uff0c\u524d\u9762\u6709 $p$ \u4e2a\u6bd4\u5b83\u5c0f\u7684\uff0c\u540e\u9762\u6709 $q$ \u4e2a\u6bd4\u5b83\u5927\u7684\uff0c\u8d21\u732e\u5c31\u662f $p-q$\uff0c\u7136\u540e\u4e58\u4e0a\u5f53\u524d\u6a2a\u5750\u6807 $i$\uff0c\u4e58\u6a2a\u5750\u6807\u4e2a\u6570 $j$\uff0c\u6240\u4ee5\u6700\u7ec8\u6211\u4eec\u8981\u6c42\u7684\u67ff\u5b50\u5c31\u662f $\\large \\sum$ $\\dbinom{s}{p} \\times \\dbinom{t}{q} \\times i \\times j \\times (p-q)$\u3002\n\n\u628a $q=k-p-j$ \u5e26\u5165\uff0c\u5f97\u5230\uff1a\n\n$$\\dbinom{s}{p} \\times \\dbinom{t}{q} \\times i \\times j \\times (2 \\times p-k-j)$$\n\n$$=\\dbinom{s}{p} \\times \\dbinom{t}{q} \\times i \\times j \\times (-k-j) + \\dbinom{s}{p} \\times \\dbinom{t}{q} \\times 2 \\times p$$\n\n\u6ce8\u610f\u5230\u5de6\u8fb9\u8fd9\u4e00\u9879\u5b9e\u9645\u4e0a\u662f $\\large \\sum$ $\\dbinom{s}{p} \\times \\dbinom{t}{q}$ \u4e58\u4e00\u4e2a\u5e38\u6570\u7684\u5f62\u5f0f\uff0c\u6240\u4ee5\u5de6\u8fb9\u6c42\u548c\uff0c\u8303\u5fb7\u8499\u5fb7\u5377\u79ef\u4e00\u4e0b\u5c31\u662f $\\dbinom{s+t}{p+q}$ \u4e58\u4e00\u4e2a\u5e38\u6570\u3002\n\n\u8003\u8651\u53f3\u8fb9 $\\large \\sum $ $\\dbinom{s}{p} \\times \\dbinom{t}{q} \\times 2 \\times p$\uff0c\u600e\u4e48\u505a\u3002\n\n\u9996\u5148\u628a $2$ \u63d0\u51fa\uff0c\u53d8\u6210 $\\large \\sum $ $\\dbinom{s}{p} \\times \\dbinom{t}{q} \\times p$\uff0c\u8003\u8651\u5b83\u7684\u7ec4\u5408\u610f\u4e49\uff1a\u5728 $s+t$ \u4e2a\u6570\u91cc\u9009\u51fa $p+q$ \u4e2a\u6570\uff0c\u7136\u540e\u518d\u4ece\u524d $p$ \u4e2a\u6570\u91cc\u9009\u51fa\u4e00\u4e2a\u7279\u6b8a\u70b9\u3002\n\n\u800c\u5b83\u7684\u7ec4\u5408\u610f\u4e49\u7b49\u4ef7\u4e8e\u8fd9\u4e2a\u67ff\u5b50\uff1a$\\dbinom{s+t-1}{p+q-1} \\times p$\u3002\n\n\u6240\u4ee5\u4e5f\u53ef\u4ee5 $\\mathcal O(1)$ \u7b97\u51fa\u6765\uff0c\u8fd9\u9898\u5c31\u89e3\u51b3\u4e86\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(nm)$\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nint const N=1e6+10;\nint const mod=1e9+7;\nint fac[N],inv[N];\nint qpow(int a,int b){int res=1;while (b){if (b&1) res*=a,res%=mod;a*=a,a%=mod,b>>=1;}return res;}\nint C(int n,int m){\n    if (n<m) return 0;\n    return fac[n]*inv[m]%mod*inv[n-m]%mod;\n}\nsigned main(){\n    ios::sync_with_stdio(false);\n    cin.tie(0),cout.tie(0);\n    int n,m,k;cin>>n>>m>>k;\n    fac[0]=1;\n    for (int i=1;i<N;++i) fac[i]=fac[i-1]*i%mod;\n    inv[N-1]=qpow(fac[N-1],mod-2);\n    for (int i=N-2;~i;--i) inv[i]=inv[i+1]*(i+1)%mod;\n    int ans=0;\n    for (int i=1;i<=n;++i){\n        for (int j=1;j<=min(m,k);++j){\n            //\u8ba1\u7b97 i \u9009 j \u4e2a\u7684\u8d21\u732e\n            int res=0;\n            int p=(i-1)*m,q=(n-i)*m,s=k-j;\n            res=C(p+q-1,s-1)*p%mod;\n            res*=2,res%=mod;\n            res+=(j-k)*C(p+q,s)%mod;\n            res*=(i*j)%mod,res%=mod;\n            res*=C(m,j),res%=mod;\n            ans+=res,ans%=mod;\n        }\n    }\n    swap(n,m);\n    for (int i=1;i<=n;++i){\n        for (int j=1;j<=min(k,m);++j){\n            //\u8ba1\u7b97 i \u9009 j \u4e2a\u7684\u8d21\u732e\n            int res=0;\n            int p=(i-1)*m,q=(n-i)*m,s=k-j;\n            res=C(p+q-1,s-1)*p%mod;\n            res*=2,res%=mod;\n            res+=(j-k)*C(p+q,s)%mod;\n            res*=(i*j)%mod,res%=mod;\n            res*=C(m,j),res%=mod;\n            ans+=res,ans%=mod;\n        }\n    }\n    cout<<(ans+mod)%mod<<'\\n';\n    return 0;\n}\n```",
        "postTime": 1685931866,
        "uid": 253608,
        "name": "Tx_Lcy",
        "ccfLevel": 7,
        "title": "[ABC127E] Cell Distance"
    },
    {
        "content": "# [\u9898\u76ee\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT_abc127_e)\n\n## \u9898\u610f\n\n\u6c42\u51fa\u6240\u6709\u53ef\u80fd\u7684\u9009\u51fa $k$ \u4e2a\u4f4d\u7f6e\u7684\u65b9\u6848\u7684\u6743\u503c\u4e4b\u548c\uff0c\u7b54\u6848\u5bf9 $1000000007$ \u53d6\u6a21\u3002\n\n## \u601d\u8def\n\n\u8003\u8651\u4e24\u4e2a\u4e4b\u95f4\u884c\u8ddd\u4e3a $i$ \u90fd\u53ef\u4ee5\u968f\u4fbf\u9009\u62e9\u4e00\u5217\uff0c\u4ece $n-i$ \u4e2a\u884c\u8ddd\u4e3a $i$ \u7684\u884c\u7ec4\u5408\u4e2d\u6311\u9009\u4e00\u4e2a\uff0c\u7136\u540e\u518d\u9009\u62e9\u5269\u4f59\u7684 $k-2$ \u4e2a\uff0c\u90a3\u4e48\u53ef\u4ee5\u63a8\u51fa\u65b9\u6848\u6570\u4e3a $i\u00d7(n-i)\u00d7m\u00d7m$ \u518d\u4e58\u4e00\u4e2a $nm-2$ \u548c $k-2$ \u7684\u6392\u5217\u7ec4\u5408\u5c31\u884c\u4e86\u3002\n\n### \u4ee3\u7801\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst long long M=1000000007;\nlong long n,m,k,ret;\nlong long a(long long x,long long y){\n    long long ret=1;\n    while(y)\n    {\n        if(y&1)ret=ret*x%M;\n\tx=x*x%M;\n        y>>=1;\n    }\n    return ret;\n}\nlong long b(long long x,long long y){//\u6392\u5217\u7ec4\u5408\n    long long sum=1,num=1;\n    for(int i=x;i>=x-y+1;i--)sum=sum*i%M;\n    for(int i=1;i<=y;i++)num=num*i%M;\n    return sum*a(num,mod-2)%M;\n}\nint main(){\n    cin>>n>>m>>k;\n    for(int i=1;i<n;i++)ret=(ret+i*(n-i)%M*m%M*m%M)%M;//\u5957\u516c\u5f0f\n    for(int i=1;i<m;i++)ret=(ret+i*(m-i)%M*n%M*n%M)%M;//\u5957\u516c\u5f0f\n    ret=ret*b(n*m-2,k-2)%M;//\u5728\u4e58\u4e0anm-2\u548ck-2\u7684\u6392\u5217\u7ec4\u5408\n    cout<<ret<<endl;\n    return 0;\n}\n```",
        "postTime": 1685365292,
        "uid": 760708,
        "name": "qwerty12346",
        "ccfLevel": 0,
        "title": "AT_abc127_e [ABC127E] Cell Distance"
    },
    {
        "content": "# [ABC127E] Cell Distance\n\n[link](https://atcoder.jp/contests/abc127/tasks/abc127_e)\n\n## \u5206\u6790\n\n\u8f6c\u6362\u4e00\u4e0b\uff0c\u5148\u8003\u8651 $x$ \u5750\u6807\u7684\u8d21\u732e\u3002\n\n\u8003\u8651\u4e24\u4e2a\u70b9\u95f4 $x$ \u5750\u6807\u76f8\u5dee\u4e3a $d\\ ( 1\\le d\\le n-1)$ \u65f6\u7684\u8d21\u732e\uff08 $d=0$ \u7684\u65f6\u5019\u6ca1\u6709\u8d21\u732e\u6240\u4ee5\u8fd9\u91cc\u4e0d\u8003\u8651\uff09\u3002\u8bbe\u8fd9\u4e24\u4e2a\u70b9\u7684\u5750\u6807\u4e3a $(x_1,y_1),(x_2,y_2)$\uff0c\u90a3\u4e48\u5c31\u6709 $x_1-x_2=d,1\\le x_1,x_2\\le n,1\\le y_1,y_2\\le m$\u3002\n\n\u5219\u53ef\u884c\u7684 $x_1,x_2$ \u6709 $n-d$ \u5bf9\uff08$(1,d+1),(2,d+2),\\cdots,(n-d,n)$\uff09\uff0c$y_1,y_2$ \u5404\u6709 $m$ \u79cd\u53d6\u6cd5\u3002\u6240\u4ee5\u50cf\u8fd9\u6837\u7684\u70b9\u5bf9\u5171\u6709 $(n-d)\\times m^2$ \u5bf9\uff0c\u6bcf\u4e00\u5bf9\u7684\u8d21\u732e\u4e3a $d$\uff0c\u603b\u7684\u8d21\u732e\u5c31\u662f $d\\times (n-d)\\times m^2$\u3002\n\n\u6bcf\u4e00\u4e2a\u70b9\u5bf9\u51fa\u73b0\u5728\u9009\u51fa\u7684 $k$ \u4e2a\u70b9\u4e2d\u7684\u65b9\u6848\u6570\u5171\u6709 $C_{n\\times m-2}^{k-2}$ \uff08\u9664\u53bb\u8fd9\u4e24\u4e2a\u70b9\u4e4b\u5916\uff0c\u5269\u4e0b $n\\times m-2$ \u4e2a\u70b9\u4e2d\uff0c\u9009\u51fa $k-2$ \u4e2a\u70b9\uff0c\u4e0e\u8fd9\u4e24\u4e2a\u70b9\u7ec4\u6210\u8981\u9009\u51fa\u7684 $k$ \u4e2a\u70b9\uff09\uff0c\u90a3\u4e48\u603b\u7684\u8d21\u732e\u5c31\u662f $d\\times (n-d)\\times m^2 \\times C_{n\\times m-2}^{k-2}$\u3002\n\n\u540c\u7406\u53ef\u4ee5\u8ba1\u7b97 $y$ \u5750\u6807\u7684\u8d21\u732e\uff0c\u5f97\u5230\u6700\u7ec8\u7b54\u6848\u4e3a\uff1a\n\n$$(\\sum_{d=1}^{n-1} d\\times (n-d)\\times m^2+\\sum_{d=1}^{m-1} d\\times (m-d)\\times n^2)\\times C_{n\\times m-2}^{k-2}$$\n\n\u90a3\u4e48\u5c31\u505a\u5b8c\u4e86\u3002\n\n## \u4ee3\u7801\n\n~~~cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int mod=1e9+7;\nint n,m,k;\nint ans;\nint ksm(int u,int v)\n{\n\tint res=1;\n\twhile(v)\n\t{\n\t\tif(v&1) res=1ll*res*u%mod;\n\t\tu=1ll*u*u%mod; v>>=1;\n\t}\n\treturn res;\n}\nint C(int p,int q)\n{\n\tint s=1,t=1; //s\uff1a\u5206\u5b50\uff0ct\uff1a\u5206\u6bcd \n\tfor(int i=p;i>=p-q+1;i--)\n\t\ts=1ll*s*i%mod;\n\tfor(int i=1;i<=q;i++)\n\t\tt=1ll*t*i%mod;\n\treturn 1ll*s*ksm(t,mod-2)%mod;\n}\nint main()\n{\n\tscanf(\"%d%d%d\",&n,&m,&k);\n\tfor(int d=1;d<n;d++)\n\t\tans=(ans+1ll*d*(n-d)%mod*m%mod*m%mod)%mod;\n\tfor(int d=1;d<m;d++)\n\t\tans=(ans+1ll*d*(m-d)%mod*n%mod*n%mod)%mod;\n\tans=1ll*ans*C(n*m-2,k-2)%mod;\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n~~~\n\n[AC\u8bb0\u5f55](https://atcoder.jp/contests/abc127/submissions/37918668)\n\n## \u5199\u5728\u6700\u540e\n\n\u849f\u84bb\u5f88\u83dc\uff0c\u5982\u679c\u5199\u7684\u6709\u4e0d\u6e05\u695a\u6216\u4e0d\u5bf9\u7684\u5730\u65b9\u671b\u8bfb\u8005\u79c1\u4fe1\u6211\u6307\u51fa\uff0c\u6211\u4f1a\u53ca\u65f6\u4fee\u6b63\u3002",
        "postTime": 1673330913,
        "uid": 355970,
        "name": "__lyx",
        "ccfLevel": 0,
        "title": "[ABC127E] Cell Distance"
    },
    {
        "content": "## \u9898\u89e3\n\u6211\u4eec\u5148\u4ece\u5c0f\u7684\u5f00\u59cb\uff0c\u5373\u4ece $2$ \u4e2a\u70b9\u5f00\u59cb\u8003\u8651\uff1a\u90a3\u4e48\u4e24\u4e2a\u70b9\u4e4b\u95f4 $x$ \u7684\u8d21\u732e\u5c31\u662f $| x_1-x_2 |$\uff0c\u8bbe $d$ \u4e3a\u8fd9\u4e2a\u6570\uff0c\u90a3\u4e48\u6bcf\u884c\u5c31\u6709 $(n-d)$ \u4e2a\uff0c\u4e5f\u5c31\u662f\u6574\u4e2a\u56fe\u6709 $(n-d) \\times m^2$ \u4e2a\uff0c\u8d21\u732e\u4e5f\u5c31\u662f $(n-d)\\times m^2\\times d$ \u4e2a\uff1b\u4e24\u4e2a\u70b9\u4e4b\u95f4 $y$ \u7684\u8d21\u732e\u5c31\u662f $|y_1-y_2|$\uff0c\u4e5f\u662f\u8bbe\u8fd9\u4e2a\u6570\u4e3a $d$\uff0c\u90a3\u4e48\u6bcf\u5217\u5c31\u6709 $(m-d)$ \u4e2a\uff0c\u6574\u4e2a\u56fe\u5c31\u6709 $(m-d) \\times n^2$ \u4e2a\uff0c\u8d21\u732e\u4e5f\u5c31\u662f $(m-d)\\times n^2\\times d$\u3002\n\n\u6c42\u51fa\u4e86\u4e24\u4e2a\u70b9\u7684\u5bf9\u6574\u4e2a\u56fe\u7684\u8d21\u732e\uff0c\u5c31\u4e0b\u6765\u5c31\u8981\u8003\u8651\u91cd\u590d\u7684\u60c5\u51b5\u4e86\uff0c\u5373\uff1a\n$C_{n\\times m-2}^{k-2}$\n\n\u540e\u9762\u6c42\u51fa\u6765\u8fd9\u4e2a\u6570\u5c31\u53ef\u4ee5\u76f4\u63a5\u4e58\u4e0a\u5b83\u5c31\u80fd\u6c42\u51fa\u8d21\u732e\uff01\n\n\u4f46\u662f\uff0c\u53c8\u6709\u4e00\u4e2a\u95ee\u9898\uff1a\u9664\u6570\u592a\u5927\u4e86\uff01\uff01\uff01\u8fd9\u65f6\u5019\u9006\u5143\u5c31\u767b\u573a\u4e86\uff01\n## \u9006\u5143\n\u53d6\u6a21\u7684\u89c4\u5f8b\u5982\u4e0b\uff1a\n- $(a+b)\\bmod p=(a\\bmod p+b\\bmod p)\\bmod p$\n- $(a-b)\\bmod p=(a\\bmod p-b\\bmod p)\\bmod p$\n- $(a\\times b)\\bmod p=(a\\bmod p\\times b\\bmod p)\\bmod p$\n\n\u90a3\u4e48\u9664\u6cd5\u600e\u4e48\u529e\u5462\uff1f\n\n\u8fd9\u65f6\u8981\u60f3\u5230\u4ed6\u7684\u9006\u5143\u4e86\uff1a\n\n\u6839\u636e\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff0c\u53ef\u5f97\u51fa\uff1a\n$\\frac{a}{b}\\bmod{p}=(a\\times b^{p-2})\\bmod{p}$\u3002\n\n\u6240\u4ee5\u5728\u9006\u5143\u4e0b\uff0c\u7528\u4e2a\u5feb\u901f\u5e42\u5c31\u80fd\u8f7b\u677e\u641e\u5b9a\u8fd9\u4e00\u4e2a\u9898\u3002\n\n## Code\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst ll mod=1000000007;\nll n,m,k,ans=0;\nll qpow(ll a,ll b){\n\tll sum = 1;\n\twhile(b){\n\t\tif(b & 1) sum = (sum * a) % mod;\n\t\ta = (a * a) % mod;\n\t\tb >>= 1;\n\t} \n\treturn sum % mod;\n}\nll C(ll a,ll b){//C(n,m)=C(n*m-2,k-2)\n\tif(a==b||b==0) return 1;\n\tif(a<b) return 0;\n\tll fz=1;\n\tfor(ll i=1;i<=a;i++)fz*=i,fz%=mod;\n\tll fm=1;\n\tfor(ll i=1;i<=b;i++)fm*=i,fm%=mod;\n\tll other=1;\n\tfor(ll i=1;i<=a-b;i++)other*=i,other%=mod;\n\tfm=(fm*other)%mod;\n\tfm=qpow(fm,mod-2)%mod;\n\treturn (fz*fm)%mod;\n}\nint main(){//\n\tcin>>n>>m>>k;\n\tfor(ll i=1;i<n;i++)\n\t\tans += ((n-i)*i*m*m)%mod;\n\tfor(ll j=1;j<m;j++)\n\t\tans += ((m-j)*j*n*n)%mod;\n\tans %= mod;\n\tans=(ans*C(n*m-2,k-2))%mod;\n\tcout<<ans;\n\treturn 0;\n}\n```",
        "postTime": 1669717548,
        "uid": 701202,
        "name": "high_sky",
        "ccfLevel": 0,
        "title": "AT_abc127_e [ABC127E] Cell Distance \u9898\u89e3"
    },
    {
        "content": "## \u9898\u610f\uff1a\n\n\u7ed9\u4f60\u4e00\u4e2a $n \\times m$ \u5927\u5c0f\u7684\u77e9\u9635\uff0c\u5b9a\u4e49\u4e00\u4e2a\u9009\u51fa$k$\u4e2a\u4f4d\u7f6e\u7684\u65b9\u6848\u7684\u6743\u503c\u4e3a     $\\textstyle \\sum_{i=1}^{k-1}\\sum_{j=i+1}^{k}(|x_{i}-x_{j}|+|y_{i}-y_{j}|)$ \uff0c\u95ee\u4f60\u4ece\u91cc\u9762\u9009\u51fa\u6240\u6709\u53ef\u80fd\u7684 $k$ \u4e2a\u4f4d\u7f6e\u7684\u65b9\u6848\u7684\u6743\u503c\u4e4b\u548c\uff0c\u7b54\u6848\u5bf9 $1000000007$ \u53d6\u6a21\u3002\n\n## \u89e3\u9898\u601d\u8def\uff1a\n\n\u9996\u5148\uff0c\u4e0d\u8981\u88ab $\\bmod1000000007$ \u6240\u8ff7\u60d1\uff0c\u8fd9\u9898\u4e0d\u662f\u5730\u63a8\u3002\u4f46\u662f\u4e00\u770b\u8fd9$\\bmod       1000000007$ \u5c31\u77e5\u9053\u8fd9\u9898\u80af\u5b9a\u4e0d\u80fd\u66b4\u529b\uff0c\u90a3\u600e\u4e48\u529e\u5462\uff1f\uff08~~\u6211\u771f\u662f\u5e9f\u8bdd\u8fde\u7bc7\u554a~~\uff09\u6211\u4eec\u53ef\u4ee5\u628a\u8fd9\u9053\u9898\u5f53\u4f5c\u4e00\u9053\u6570\u5b66\u9898\u6765\u89e3\u3002\n\n### \u7b2c\u4e00\u6b65\uff1a\n\n\u6211\u4eec\u4e0d\u59a8\u5148\u9009\u5b9a\u4e24\u4e2a\u70b9\uff0c\u770b\u5b83\u4eec\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u6709\u591a\u5c11\uff0c\u7136\u540e\u6c42\u8fd9 $k$ \u4e2a\u70b9\u7684\u6240\u6709\u7ec4\u5408\uff0c\u5728\u4e58\u8fd9\u4e2a\u8d21\u732e\u503c\uff0c\u5c31\u80fd\u6c42\u51fa\u7b54\u6848\u3002\u90a3\u4e48\u7b2c\u4e00\u6b65\u5b8c\u6210\u3002\n\n### \u7b2c\u4e8c\u6b65\uff1a\n\n\u4f46\u8fd9\u4e24\u4e2a\u70b9\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u6709\u591a\u5c11\u5462\uff1f\u96be\u4e0d\u6210\u8981\u66b4\u529b\u5417\uff1f\u606d\u559c\u4f60\uff0c\u7b54\u5bf9\u4e86\u3002\u9996\u5148\uff0c\u770b\u5b83\u4eec\u5bf9\u6bcf\u4e00\u5217\u7684\u8d21\u732e\u6709\u591a\u5c11\uff0c\u8003\u8651\u5b83\u4eec\u4e4b\u95f4\u7684\u884c\u7684\u8ddd\u79bb\u4e3a $i$ \uff0c\u90a3\u4e48\u884c\u8ddd\u4e3a $i$ \u7684\u90a3\u4e00\u5217\u4e0a\u7684\u70b9\u90fd\u53ef\u4ee5\u968f\u4fbf\u9009\uff0c\u6240\u4ee5\u53ef\u4ee5\u63a8\u51fa\u4ee5\u4e0b\u4ee3\u7801\uff1a\n\n```\nint sum=0;\nfor(int i=1;i<=n;i++)\n{\n\tsum+=(n-i)*i*m*m;\n}\n```\n\u800c\u8fd9\u4e2a $sum$ \u5c31\u662f\u8fd9\u4e24\u4e2a\u70b9\u7684\u5217\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u3002\n\n\u800c\u884c\u4e5f\u662f\u540c\u7406\uff1a\n\n```\nfor(int i=1;i<=m;i++)\n{\n\tsum+=(m-i)*i*n*n;\n}\n```\n\u6700\u540e\u7684 $sum$ \u503c\u5c31\u662f\u4e24\u4e2a\u70b9\u5bf9\u4e8e\u7b54\u6848\u7684\u8d21\u732e\u3002\n\n\u4f46\u6c42\u51fa\u6765 $sum$ \u7684\u503c\u540e\u600e\u4e48\u529e\uff1f\u6211\u4eec\u77e5\u9053\u4e00\u5171\u80fd\u9009 $n \\times m$ \u4e2a\u70b9\uff0c\u4e00\u5171\u8981\u9009 $k$ \u4e2a\u70b9\uff0c\u4f46\u662f\u5df2\u7ecf\u9009\u62e9\u4e86\u4e24\u4e2a\u70b9\uff0c\u6240\u4ee5\u8fd8\u8981\u7efc\u4e0a\u6240\u8ff0\uff0c\u6211\u4eec\u8981\u6c42\u7684\u7b54\u6848\u5c31\u662f\uff1a\n\n## $sum \\times C_{n \\times m-2}^{k-2}$\n\n### \u7b2c\u4e09\u6b65\uff1a\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u4ee3\u7801\u5b9e\u73b0\uff1a\n\n#### \u5b9a\u4e49\u90e8\u5206\uff1a\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nconst ll mod=1000000000+7;\nll n,m,k,ans;\n//\u6ca1\u6709\u4ec0\u4e48\u597d\u8bb2\u7684......\n\n```\n\n#### \u8f93\u5165+\u6c42 $sum$ \u503c\uff1a\n\n```\nscanf(\"%lld%lld%lld\",&n,&m,&k);\nll sum=0;\nfor(int i=1;i<=n;i++) //\u5bf9\u6bcf\u4e00\u5217\u5bf9\u7b54\u6848\u7684\u8d21\u732e\n{\n\tsum+=(n-i)*i*m*m;\n\tsum%=mod;\n}\nfor(int i=1;i<=m;i++) //\u5bf9\u6bcf\u4e00\u884c\u5bf9\u7b54\u6848\u7684\u8d21\u732e\n{\n\tsum+=(m-i)*i*n*n;\n\tsum%=mod;\n}\n```\n\n#### \u5168\u6392\u5217\uff1a\n\n```\nll qpow(ll a,ll b) //\u5feb\u901f\u5e42\uff08\u7528\u4e8e\u5904\u7406\u9006\u5143\uff09\n{\n\tll sum=1;\n\twhile(b)\n\t{\n\t\tif(b&1)\n\t\t{\n\t\t\tsum=(sum*a)%mod;\n\t\t}\n\t\ta=(a*a)%mod;\n\t\tb>>=1;\n\t}\n\treturn sum;\n}\nll A(ll n,ll m) //\u6c42\u7ec4\u5408\u6570\n{\n\tll ns=1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tns*=i;\n\t\tns%=mod;\n\t}\n\tll ms=1;\n\tfor(int i=1;i<=(n-m);i++)\n\t{\n\t\tms*=i;\n\t\tms%=mod;\n\t}\n\treturn ((ns%mod)*(qpow(ms,mod-2)%mod))%mod; //\u91cc\u9762\u8fd0\u7528\u4e86\u8d39\u9a6c\u5c0f\u5b9a\u7406\uff0c\u4e0d\u61c2\u5f97\u53ef\u4ee5\u53bb\u67e5\u4e00\u67e5\n}\nll C(ll n,ll m) //\u6c42\u7ec4\u5408\n{\n\tif(n<m)\n\t{\n\t\treturn 0;\n\t}\n\tif(n==m)\n\t{\n\t\treturn 1;\n\t}\n\tll sum=1;\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tsum*=i;\n\t\tsum%=mod;\n\t}\n\treturn ((A(n,m)%mod)*(qpow(sum,mod-2)%mod))%mod;\n}\n```\n\n#### \u8f93\u51fa\u7b54\u6848\uff1a\n\n```\nans=(sum*C(n*m-2,k-2))%mod; //\u5982\u7b2c\u4e8c\u6b65\u7684\nprintf(\"%lld\",ans%mod);\nreturn 0; //\u5b8c\u7f8e\u7ed3\u675f\n```\n\n## \u5b8c\u6574\u7684Code\n\n\u63a5\u4e0b\u6765\u662f\u4e0d\u52a0\u6ce8\u91ca\u7684\u5b8c\u6574\u4ee3\u7801\uff08~~\u77e5\u9053\u4f60\u4eec\u5c31\u662f\u51b2\u7740\u8fd9\u4e2a\u6765\u7684~~\uff09\uff1a\n\n```\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nconst ll mod=1000000000+7;\nll n,m,k,ans;\nll qpow(ll a,ll b)\n{\n\tll sum=1;\n\twhile(b)\n\t{\n\t\tif(b&1)\n\t\t{\n\t\t\tsum=(sum*a)%mod;\n\t\t}\n\t\ta=(a*a)%mod;\n\t\tb>>=1;\n\t}\n\treturn sum;\n}\nll A(ll n,ll m)\n{\n\tll ns=1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tns*=i;\n\t\tns%=mod;\n\t}\n\tll ms=1;\n\tfor(int i=1;i<=(n-m);i++)\n\t{\n\t\tms*=i;\n\t\tms%=mod;\n\t}\n\treturn ((ns%mod)*(qpow(ms,mod-2)%mod))%mod;\n}\nll C(ll n,ll m)\n{\n\tif(n<m)\n\t{\n\t\treturn 0;\n\t}\n\tif(n==m)\n\t{\n\t\treturn 1;\n\t}\n\tll sum=1;\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tsum*=i;\n\t\tsum%=mod;\n\t}\n\treturn ((A(n,m)%mod)*(qpow(sum,mod-2)%mod))%mod;\n}\nint main()\n{\n\tscanf(\"%lld%lld%lld\",&n,&m,&k);\n\tll sum=0;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tsum+=(n-i)*i*m*m;\n\t\tsum%=mod;\n\t}\n\tfor(int i=1;i<=m;i++)\n\t{\n\t\tsum+=(m-i)*i*n*n;\n\t\tsum%=mod;\n\t}\n\tans=(sum*C(n*m-2,k-2))%mod;\n\tprintf(\"%lld\",ans%mod);\n\treturn 0;\n}\n```\n\n## \u540e\u8bb0\uff1a\n\n\u5199\u4e86\u8fd9\u7bc7\u9898\u89e3\u4ee5\u540e\uff0c\u4e00\u770b\u65f6\u95f4\u53d1\u73b0\u5df2\u7ecf5\u70b9\u591a\u4e86\uff0c\u53d1\u4e2a\u9898\u89e3\u53ef\u771f\u96be\u554a\uff01\uff01\uff01\n\n#### qwq",
        "postTime": 1669715349,
        "uid": 781352,
        "name": "Killer_Jerry",
        "ccfLevel": 0,
        "title": "\u300a\u3010ABC127E\u3011Cell Distance\u300b\u9898\u89e3"
    },
    {
        "content": "## \u601d\u8def\n\n\u8f6c\u5316\u4e00\u4e0b\uff0c\u5206\u79bb\u884c\u5217\uff0c\u9488\u5bf9**\u6bcf\u4e00\u5bf9**\u53bb\u8ba1\u7b97\u65b9\u6848\u3002\n\n\u4ee5\u4e0b\u4ee5\u884c\u4e3a\u4f8b\u5b50\u3002\n\n\u8003\u8651\u4e24\u4e2a\u4e4b\u95f4\u884c\u8ddd\u4e3a $i$\uff0c\u90fd\u53ef\u4ee5\u968f\u4fbf\u9009\u62e9\u4e00\u5217\uff0c\u4ece $n-i$ \u4e2a\u884c\u8ddd\u4e3a $i$ \u7684\u884c\u7ec4\u5408\u4e2d\u6311\u9009\u4e00\u4e2a\uff0c\u7136\u540e\u518d\u9009\u62e9\u5269\u4f59 $k-2$ \u4e2a\uff0c\u65b9\u6848\u6570\u5c31\u662f $i\\times (n-i)\\times m^2\\times \\dbinom{nm-2}{k-2}$\u3002\n\n\u52a0\u8d77\u6765\u5373\u53ef\uff0c\u590d\u6742\u5ea6 $O(n+m)$\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\n#define double long double\n#define mid ((l+r)>>1)\nusing namespace std;\nconst int mod=1e9+7;\nint qp(int a,int b){\n\tint ans=1;\n\twhile(b){\n\t\tif(b&1) ans=(ans*a)%mod;\n\t\ta=(a*a)%mod;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\nint fac[10000005],inv[10000005];\nvoid init(){\n\tfac[0]=1;\n\tfor(int i=1;i<=10000000;i++) fac[i]=fac[i-1]*i%mod;\n\tinv[10000000]=qp(fac[10000000],mod-2);\n\tfor(int i=9999999;i>=0;i--) inv[i]=inv[i+1]*(i+1)%mod;\n}\nint C(int i,int j){\n\tif(i<0||j<0||i<j) return 0;\n\treturn fac[i]*inv[i-j]%mod*inv[j]%mod;\n}\nsigned main(){\n\tinit();\n\tint n,m,k,ans=0;\n\tcin>>n>>m>>k;\n\tfor(int i=1;i<n;i++){\n\t\tans=(ans+(i*m%mod)*((n-i)*m%mod)%mod*C(n*m-2,k-2)%mod)%mod;\n\t}\n\tfor(int i=1;i<m;i++){\n\t\tans=(ans+(i*n%mod)*((m-i)*n%mod)%mod*C(n*m-2,k-2)%mod)%mod;\n\t}\n\tcout<<ans;\n\treturn 0;\n}\n```",
        "postTime": 1666360767,
        "uid": 116664,
        "name": "Daniel_lele",
        "ccfLevel": 8,
        "title": "ABC127E \u9898\u89e3"
    },
    {
        "content": "## \u5206\u6790\n\u9996\u5148\u8fd9\u662f\u4e00\u4e2a\u5e73\u9762\uff0c\u76f4\u63a5\u5728\u5e73\u9762\u4e0a\u505a\u7684\u8bdd\u592a\u9ebb\u70e6\u4e86\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4e00\u4e2a\u5e73\u9762\u56fe\u62c6\u6210\u4e24\u5217\uff0c\u4e00\u5217\u662f\u6a2a\u8f74\uff0c\u4e00\u5217\u662f\u7ad6\u8f74\u3002\u7136\u540e\u6211\u4eec\u53ef\u4ee5\u60ca\u5947\u7684\u53d1\u73b0\uff0c\u8fd9\u4e24\u5217\u662f\u5bf9\u79f0\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u7528\u5904\u7406\u4e00\u4e2a\uff0c\u53e6\u4e00\u4e2a\u76f4\u63a5\u7167\u642c\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u800c\u5728\u4e00\u5217\u4e0a\uff0c\u6211\u4eec\u7edf\u8ba1\u8d21\u732e\u65f6\uff0c\u53ef\u4ee5\u5148\u7b97\u51fa\u4e24\u4e2a\u70b9\u7684\u8d21\u732e\uff0c\u7136\u540e\u5728\u8ba1\u7b97\u51fa\u8fd9\u4e00\u6bb5\u5728\u591a\u5c11\u79cd\u65b9\u6848\u91cc\u9762\u6709\u8d21\u732e\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u679a\u4e3e\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb $d$\uff0c\u7531\u4e8e\u8fd9\u4e24\u4e2a\u7aef\u70b9\u53ef\u4ee5\u79fb\u52a8\uff0c\u6240\u4ee5\u8fd8\u8981\u4e58\u4e0a $(n-d)$\uff0c\u800c\u4e14\u56e0\u4e3a\u8fd9\u53ea\u662f\u4e00\u5217\uff0c\u6240\u4ee5\u6211\u4eec\u8fd8\u8981\u5206\u522b\u4e58\u4e0am\uff0c\u4e5f\u5c31\u662f\u4e00\u8d77 $m^2$\u3002\u53c8\u56e0\u4e3a\u6709 $k$ \u4e2a\u4f4d\u7f6e\uff0c\u5e76\u4e14\u662f\u65e0\u5e8f\u7684\uff0c\u6240\u4ee5\u518d\u4e58\u4e0a $C^k_{mn}$\u3002\u63a5\u7740\uff0c\u518d\u5904\u7406\u4e00\u4e0b $m$\uff08\u4e0e $n$ \u7684\u5904\u7406\u65b9\u6cd5\u4e00\u6837\uff09\uff0c\u7136\u540e\u628a\u6240\u6709\u7684\u52a0\u8d77\u6765\u3002\n\n\u4e5f\u5c31\u662f\uff1a\n$$ \nsum= \\sum_{d = 1}^{n}(n-d)m^2C^k_{mn}\n$$\n\u6700\u540e\uff0c\u56e0\u4e3a\u5728 $C^k_{mn}$ \u4e2d\u6709\u9664\u6cd5\uff0c\u6240\u4ee5\u5728\u53d6\u6a21\u7684\u65f6\u5019\u8981\u52a0\u4e0a\u4e00\u4e2a\u9006\u5143\u3002\\\n\u9644\u56fe\u4e00\u5f20:![](https://cdn.luogu.com.cn/upload/image_hosting/5t3bnjil.png)\n\n\n",
        "postTime": 1673429574,
        "uid": 754919,
        "name": "Populus_euphratica",
        "ccfLevel": 0,
        "title": "AT_abc127_e\u9898\u89e3"
    },
    {
        "content": "## Solution\n\n\u8fd0\u7528\u51e0\u4e2a\u7ecf\u5178 trick \u5373\u53ef .\n\n- \u5ffd\u7565\u5176\u4ed6\n\n\u6211\u4eec\u7814\u7a76\u95ee\u9898 , \u603b\u662f\u8d8a\u5c11\u8d8a\u597d\u7814\u7a76 . \u6bd4\u5982\u8fd9\u9898 , \u8ba9\u6211\u4eec\u76f4\u63a5\u7814\u7a76 $n$ \u4e2a\u6570\u672a\u514d\u8fc7\u4e8e\u9ebb\u70e6 , \u90a3\u6211\u4eec\u628a\u6bcf\u4e00\u5bf9\u7d66\u62c6\u5f00 . \u6240\u4ee5\u6211\u4eec\u5176\u5b9e\u5c31\u662f\u7814\u7a76\u5f88\u591a\u4e8c\u5143\u6570\u5bf9\u7684\u548c . \u6ce8\u610f\u4e00\u4e2a\u4e8c\u5143\u6570\u5bf9\u4f1a\u7ed9\u7b54\u6848\u8d21\u732e $C_{nm-2}^{k-2}$ \u6b21 , \u6240\u4ee5\u6ce8\u610f\u4e58\u4e0a\u7cfb\u6570 .\n\n- \u7701\u53bb\u4e00\u7ef4\n\n\u4e8c\u5143\u7684\u4e1c\u897f\u4e5f\u6bd4\u8f83\u9ebb\u70e6 , \u53ef\u80fd\u65e0\u6cd5\u76f4\u63a5\u5168\u90e8\u6c42\u51fa . \u8fd9\u65f6\u5019\u6211\u4eec\u5e94\u679a\u4e3e\u4e00\u7ef4 , \u7136\u540e\u5feb\u901f\u8ba1\u7b97\u7b2c\u4e8c\u7ef4 .\n\n\u5bf9\u4e8e\u8fd9\u4e00\u9898  , \u6211\u4eec\u7ed9\u4e86\u4e00\u4e2a\u683c\u5b50 $(x_1,y_1)$ , \u9700\u8981\u5feb\u901f\u6c42\u51fa\u5b83\u5230\u5176\u4ed6\u683c\u5b50\u7684\u8ddd\u79bb\u603b\u548c . \u989d , \u5982\u679c\u76f4\u63a5\u6c42\u8ddd\u79bb\u548c , \u6709\u70b9\u56f0\u96be . \u4e8e\u662f\u7528\u7b2c\u4e09\u4e2a trick\n\n- \u5206\u5f00\u8003\u8651\n\n\u521a\u624d\u90a3\u4e2a\u8ddd\u79bb\u548c\u7531\u4e8e\u662f\u7eb5\u5411\u4e0e\u6a2a\u5411\u7684\u52a0 , \u4e0d\u662f\u5f88\u6709\u89c4\u5f8b , \u6240\u4ee5\u6211\u4eec\u8003\u8651\u628a\u7eb5\u5411\u8ddd\u79bb\u548c\u6a2a\u5411\u8ddd\u79bb\u5206\u5f00\u8ba1\u7b97 . \u8fd9\u6837 , \u5355\u72ec\u8003\u8651\u4e00\u7ef4\u7684\u65f6\u5019 , \u8fd9\u4e2a\u70b9\u5230\u5176\u4ed6\u70b9\u7684\u8ddd\u79bb\u90fd\u662f\u4e00\u884c\u4e00\u884c\u6216\u4e00\u5217\u4e00\u5217\u5168\u90e8\u76f8\u7b49\u7684 , \u53ef\u4f7f\u7528\u7b49\u5dee\u6570\u5217 .\n\n- \u9664\u5e8f\n\n\u6b38\u7b49\u7b49 , \u600e\u4e48\u6837\u4f8b 1 \u8f93\u51fa 16 \u554a ! \u56e0\u4e3a\u6211\u4eec\u4e00\u5bf9\u6570\u6b63\u53cd\u90fd\u8ba1\u7b97\u4e86\u4e00\u6b21 , \u8fd9\u65f6\u5019\u6211\u4eec\u8981\u9664\u5e8f . \n\n\u4e00\u822c\u9664\u5e8f\u7684\u65f6\u5019 , \u8981\u8003\u8651\u81ea\u5df1\u5bf9\u81ea\u5df1\u5176\u5b9e\u53ea\u6709\u4e00\u6b21 , \u4e0d\u80fd\u76f4\u63a5\u9664\u4ee5 $2$ . \u4e0d\u8fc7\u8fd9\u9053\u9898\u81ea\u5df1\u5bf9\u81ea\u5df1\u662f $0$ , \u6240\u4ee5\u76f4\u63a5\u9664\u4ee5 $2$ \u4e5f\u6ca1\u95ee\u9898 .\n\n\u6240\u4ee5\u5c31\u505a\u5b8c\u4e86 ?\n\ncode :\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define ffor(i,a,b) for(int i=(a);i<=(b);i++)\n#define roff(i,a,b) for(int i=(a);i>=(b);i--)\nusing namespace std;\nconst int MAXN=200000+10,MOD=1e9+7;\nint n,m,k;\nint get_sum(int u,int v) {\n\tif(v==0) return 0;\n\tint x=u+v,y=v-u+1;\n\tif(x%2==0) x/=2;else y/=2;\n\treturn x*y%MOD;\n}\nint qpow(int base,int p) {\n\tint ans=1;\n\twhile(p) {\n\t\tif(p&1) ans*=base,ans%=MOD;\n\t\tbase*=base,base%=MOD,p>>=1;\n\t}\n\treturn ans;\n}\nint fuc(int u) {\n\tint ans=1;ffor(i,1,u) ans*=i,ans%=MOD;\n\treturn ans;\n}\nsigned main() {\n\tios::sync_with_stdio(false),cin.tie(0),cout.tie(0);\n\tcin>>n>>m>>k;\n\tint ans=0;\n\tffor(i,1,n) ffor(j,1,m) {\n\t\tint tot1=get_sum(1,i-1)+get_sum(1,n-i),tot2=get_sum(1,j-1)+get_sum(1,m-j);\n\t\ttot1%=MOD,tot2%=MOD;\n\t\tans+=tot1*m%MOD,ans+=tot2*n%MOD;ans%=MOD;\n\t}\n\tcout<<ans*fuc(n*m-2)%MOD*qpow(fuc(n*m-k),MOD-2)%MOD*qpow(fuc(k-2),MOD-2)%MOD*qpow(2,MOD-2)%MOD;\n\treturn 0;\n}\n```",
        "postTime": 1656640020,
        "uid": 120947,
        "name": "Purslane",
        "ccfLevel": 7,
        "title": "AT4757"
    },
    {
        "content": "\u7b80\u5355\u63a8\u67ff\u5b50\u9898\uff0c\u8fd8\u6ca1\u6709\u9898\u89e3\u5c31\u6765\u4ea4\u4e00\u53d1\u3002\n\n\u9996\u5148\u5206\u5f00\u8003\u8651\u6bcf\u5bf9\u7684\u8d21\u732e\uff0c\u6700\u540e\u7b54\u6848\u4e58\u4e00\u4e2a $n\\times m-2 \\choose k-2$ \u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u4e3a\u4e86\u907f\u514d\u91cd\u590d\uff0c\u6211\u4eec\u53ef\u4ee5\u89c4\u5b9a\u4e00\u4e2a\u65b9\u5411\uff0c\u6bd4\u5982\u8bf4\u5411\u53f3\u4e0b\u65b9\uff0c\u4f46\u662f\u8fd9\u6837\u5de6\u4e0b\u548c\u53f3\u4e0a\u7684\u8d21\u732e\u5c31\u6ca1\u6709\u8003\u8651\u5230\u4e86\uff0c\u4e0d\u8fc7\u7531\u4e8e\u5f62\u5f0f\u662f\u76f8\u540c\u7684\uff0c\u6240\u4ee5\u5728\u8f6c\u8fc7\u6765\u8dd1\u4e00\u904d\u5c31\u53ef\u4ee5\u4e86\u3002   \n\u8fd9\u91cc\u53ea\u8003\u8651\u53f3\u4e0b\u3002\n\n\u4ee4 $n = N-x+1, m = M-y$\uff0c\u70b9 $(x, y)$ \u548c\u540e\u6bcf\u6240\u6709\u70b9\u7684\u66fc\u54c8\u987f\u8ddd\u79bb\u548c\u662f\n\n$$\n\\sum_{i=0}^{n-1} \\sum_{j=i}^{m+i}j\n$$\n\n\u7b49\u5dee\u6570\u5217\u6c42\u548c\u5f97\n\n$$\n\\text{\u539f\u5f0f}=\\frac{1}{2} \\sum_{i=0}^{n-1} 2im + 2i + m^2 + m\n$$\n\n\u62c6\u5f00\n\n\n$$\n= m\\sum_{i=0}^{n-i} i + \\sum_{i=0}^{n-1}i + \\frac{1}{2} n (m^2+m)\n$$\n\n\u7136\u540e\u53d1\u73b0\u8fd9\u91cc\u9762\u7684\u548c\u5f0f\u90fd\u53ef\u4ee5\u7528\u7b49\u5dee\u6570\u5217\u6c42\u548c\u4ee3\u66ff\u3002  \n\u57fa\u672c\u4e0a\u5c31\u505a\u5b8c\u4e86\u3002\n\n\u6ce8\u610f\u4e3a\u4e86\u907f\u514d\u91cd\u590d\u8ba1\u7b97\u5de6\u4e0b\u548c\u53f3\u4e0a\u8d21\u732e\u7684\u65f6\u5019\u8981\u628a\u5f53\u524d\u884c\u5217\u90fd\u51cf\u6389\u3002\n\n\u4ee3\u7801\u3002\n\n```cpp\nvoid add(int &a, int b) { a = (a + b) % P; }\nint get(int n, int m) {\n    if (n <= 0 || m < 0) return 0;\n    int sum = (0+n-1) * n / 2 % P;\n    return ((sum*m%P + sum)%P + n*(m*m+m)/2%P) % P; \n}\nint fix(int a, int b) {\n    int an1 = (1+a) * a / 2 % P;\n    int an2 = (1+b) * b / 2 % P;\n    return (an1 + an2) % P;\n}\nsigned main() {\n    std::cin >> n >> m >> k;\n    for (int i = 1; i <= n; i++) \n        for (int j = 1; j <= m; j++)\n            add(ans, (get(n-i+1, m-j) + get(i, m-j) - fix(i-1, m-j)) % P);\n    ans = ans * C(n*m-2, k-2) % P;\n    std::cout << ans;\n}\n```",
        "postTime": 1627542843,
        "uid": 40318,
        "name": "Acfboy",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 [ABC127E] Cell Distance"
    }
]
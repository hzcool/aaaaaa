[
    {
        "content": "\u8003\u8651\u968f\u4fbf\u9009\u7684\u65f6\u5019\uff08\u5373\u6ca1\u6709 $B_i$ \u8fd9\u4e2a\u7ea6\u675f\uff09\u7b54\u6848\u662f\u5565\uff0c\u53d1\u73b0\u662f\n$$\n[x^M]\\prod_{i=1}^N(1+A_ix+A_i^2x^2+\\cdots)=[x^M]\\prod_{i=1}^N\\dfrac{1}{1-A_ix}\n$$\n\u8fd9\u4e1c\u897f......\u603b\u4e4b\u53ef\u4ee5\u66b4\u529b\u7b97\u51fa $F(x)=\\prod(1-A_ix)$\uff0c\u7136\u540e\u6c42\u9006\u3002\n\n\u6211\u4e0d\u4f1a\u591a\u9879\u5f0f\u79d1\u6280\u600e\u4e48\u529e\uff01\u53ea\u4f1a\u66b4\u529b\u5199\u6c42\u9006\u9012\u63a8\u5f0f\u7136\u540e\u77e9\u9635\u5feb\u901f\u5e42 $O(N^3\\log M)$ \u554a\uff0c\u81ea\u95ed\u4e86\u3002\n\n\u8003\u8651\u62c6\u4e00\u624b\uff0c\u5f85\u5b9a\u7cfb\u6570\n$$\n\\begin{aligned}\\prod_{i=1}^N\\dfrac{1}{1-A_ix}&=\\sum_{i=1}^N\\dfrac{c_i}{1-A_ix}\\\\1&=\\sum_{i=1}^Nc_i\\prod_{j\\neq i}(1-A_jx)\\end{aligned}\n$$\n\u4f9d\u6b21\u53d6 $x=A_1^{-1},A_2^{-1},\\cdots,A_N^{-1}$\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\n$$\nc_i\\prod_{j\\neq i}(1-A_jA_i^{-1})=1\\qquad(1\\le i\\le N)\n$$\n\u8fd9\u6837\u5c31\u53ef\u4ee5 $O(N^2)$ \u65f6\u95f4\u5185\u89e3\u51fa $c_i$ \u7684\u503c\u3002\u63a5\u4e0b\u6765\u5c31\u6709\n$$\n[x^M]\\prod_{i=1}^N\\dfrac{1}{1-A_ix}=\\sum_{i=1}^Nc_iA_i^M\n$$\n\u7136\u540e\u8003\u8651\u5bb9\u65a5\uff0c\u94a6\u5b9a $S$ \u4ee5\u5185\u7206\u9650\u5236\uff0c\u53d1\u73b0\u53ea\u9700\u8981\u628a $M$ \u51cf\u53bb $\\sum_{i\\in S}B_i$ \u7136\u540e\u4e58\u4e0a $\\prod_{i\\in S}A_i^{B_i}$ \u5c31\u884c\u4e86\u3002\n\n\u603b\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(2^N\\times N\\log P)$\u3002\n\n>\u5b9e\u9645\u4e0a\u4f60\u53ef\u4ee5\u53d1\u73b0\u5bb9\u65a5\u5e72\u7684\u4e8b\u60c5\u65e0\u975e\u662f\u628a\u539f\u7b54\u6848\u7684\u591a\u9879\u5f0f\n>$$\n[x^M]\\prod_{i=1}^N\\dfrac{1-A_i^{B_i+1}x^{B_i+1}}{1-A_ix}\n$$\n>\u7684\u5206\u5b50\u5c55\u5f00\u4e86\u800c\u5df2\uff01\u548c\u751f\u6210\u51fd\u6570\u505a\u6cd5\u6ca1\u5565\u533a\u522b\u7684\uff01\uff01\n\n<https://atcoder.jp/contests/abc241/submissions/41307325>",
        "postTime": 1683807332,
        "uid": 307453,
        "name": "\u4e91\u6d45\u77e5\u5904",
        "ccfLevel": 6,
        "title": "Card Deck Score"
    },
    {
        "content": "\u770b\u5230\u62c6\u5206 DNA \u53c8\u52a8\u4e86\uff0c\u4e8e\u662f\u5927\u529b\u751f\u6210\u51fd\u6570\uff0c\u5f97\u5230\u7b54\u6848\uff1a\n\n$$\n\\begin{aligned}\n&[x^m]\\prod^n_{i=1}\\sum^{B_i}_j(a_ix)^j\\\\\n=&[x^m]\\prod^n_{i=1}\\dfrac{1-(a_ix)^{b_i+1}}{1-a_ix}\\\\\n=&[x^m]\\prod^n_{i=1}(1-(a_ix)^{b_i+1})\\times\\left(\\prod^n_{i=1}\\dfrac1{1-a_ix}\\right)\n\\end{aligned}\n$$\n\n\u7531\u4e8e $n$ \u975e\u5e38\u5c0f\uff0c\u6240\u4ee5\u524d\u534a\u90e8\u5206\u76f4\u63a5\u66b4\u529b\u7b97\u5c31\u884c\u4e86\u3002\u8003\u8651\u540e\u534a\u6bb5\u600e\u4e48\u7b97\uff0c\u7a0d\u5fae\u90e8\u5206\u5206\u5f0f\u5c55\u5f00\u4e00\u4e0b\uff1a\n\n$$\n\\begin{aligned}\n\\prod^n_{i=1}\\dfrac1{1-a_ix}&=\\sum^n_{i=1}\\dfrac{t_i}{1-a_ix}\\\\\n\\sum^n_{i=1}\\dfrac{t_i}{1-a_ix}\\prod^n_{j=1}(1-a_jx)&=1\\\\\n\\sum^n_{i=1}t_i\\prod^n_{j=1,j\\not=i}(1-a_jx)&=1\\\\\n\\end{aligned}\n$$\n\n\u8fd9\u91cc\u8981\u8fd0\u7528 $x$ \u7684\u4efb\u610f\u6027\uff0c\u8ba9\u524d\u9762\u7684\u548c\u5f0f\u5728 $i\\not=k$ \u65f6\u90fd\u4e3a $0$\u3002\u5bb9\u6613\u60f3\u5230\u8bbe $x=\\dfrac{a_j}{a_k}$\uff0c\u5219\u6709\uff1a\n\n$$\n\\begin{aligned}\nt_k\\prod^n_{j=1,j\\not=k}(1-\\dfrac{a_j}{a_k})&=1\\\\\nt_i&=\\left(\\prod^n_{j=1,j\\not=k}(1-\\dfrac{a_j}{a_k})\\right)^{-1}\\\\\n\\end{aligned}\n$$\n\n$t_i$ \u5373\u53ef $O(n^2)$ \u7b97\u51fa\u3002\u518d\u6839\u636e $\\dfrac1{1-ax}=\\sum_ia^ix^i$\uff0c\u5373\u53ef $O(n)$ \u5355\u70b9\u8ba1\u7b97\u5206\u6bcd\u90e8\u5206\u7684\u7cfb\u6570\u3002\u518d\u6839\u636e\u5206\u5b50\u90e8\u5206\u5927\u529b\u4e58\u51fa\u6765\u4e5f\u9876\u591a\u53ea\u6709 $2^n$ \u4e2a\u9879\u7cfb\u6570\u4e0d\u4e3a $0$\uff0c\u6240\u4ee5\u53ef\u4ee5 $O(n2^n)$ \u5927\u529b\u786c\u4e58\u4e58\u51fa\u7cfb\u6570\uff0c\u603b\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^2+n2^n)$\uff0c\u5b8c\u7ed3\u6492\u82b1\u3002\n\n# AC \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n\nusing namespace std;\n\ntypedef long long ll;\n\nconst int MAXN = 1 << 16;\nconst int mod = 998244353;\n\ninline \nll qpow(ll b, ll p) {\n\tll res = 1;\n\twhile (p) {\n\t\tif (p & 1) res = res * b % mod;\n\t\tb = b * b % mod, p >>= 1;\n\t}\n\treturn res;\n}\n\nint n; ll a[16], b[16], c[16], m;\n\nll f[MAXN], p[MAXN], t[16], x, ans;\n\nint main() {\n\tscanf(\"%d%lld\", &n, &m);\n\tfor (int i = 0; i < n; i++) scanf(\"%d%lld\", &a[i], &b[i]), c[i] = mod - qpow(a[i], ++b[i]);\n\tfor (int s = 0; s < 1 << n; s++) {\n\t\tf[s] = 1, p[s] = 0;\n\t\tfor (int i = 0; i < n; i++) if (s >> i & 1) f[s] = f[s] * c[i] % mod, p[s] += b[i];\n\t}\n\tfor (int i = 0; i < n; i++) {\n\t\tx = qpow(a[i], mod - 2), t[i] = 1;\n\t\tfor (int j = 0; j < n; j++) if (i != j) t[i] = t[i] * (mod + 1 - a[j] * x % mod) % mod;\n\t\tt[i] = qpow(t[i], mod - 2);\n\t}\n\tfor (int s = 0; s < 1 << n; s++) {\n\t\tif (p[s] > m) continue;\n\t\tfor (int i = 0; i < n; i++) ans = (ans + f[s] * t[i] % mod * qpow(a[i], m - p[s]) % mod) % mod;\n\t}\n\tprintf(\"%lld\", ans);\n}\n```",
        "postTime": 1678010578,
        "uid": 406941,
        "name": "Register_int",
        "ccfLevel": 6,
        "title": "ABC241Ex \u9898\u89e3"
    },
    {
        "content": "Update 2023.05.12 \u901a\u8fc7\u4ee3\u7801\u6302\u9519\u4e86\uff0c\u73b0\u5df2\u4fee\u6539\u3002\n\n\u5bb9\u65a5\u662f\u5e73\u51e1\u7684\uff0c\u6bcf\u79cd\u6392\u5747\u9009\u5c0f\u4e8e\u7b49\u4e8e $b_i$ \u5f20\u663e\u7136\u4e0d\u597d\u7b97\uff0c\u4e0d\u5982\u94a6\u5b9a\u67d0\u4e9b\u6392\u5f3a\u5236\u5927\u4e8e $b_i$\u3002\n\n\u63a5\u4e0b\u6765\u5c31\u662f\u7b97\u628a $x$ \u5206\u6210 $\\sum_{i=1}^nx_i$ \u5f0f\u5b50 $\\prod_{i=1}^na_i^{x_i}$ \u4e4b\u548c\u3002\n\n\u4e0d\u4f1a\u751f\u6210\u51fd\u6570\uff0c\u8003\u8651\u5148\u6734\u7d20 $dp_{i,j}$ \u8868\u793a\u76ee\u524d\u8003\u8651\u4e86 $1\\sim i$ \u7684 $x_i$\uff0c\u5176\u548c\u4e3a $j$ \u7684\u6743\u503c\u548c\u3002\u4e0d\u96be\u53d1\u73b0\u8f6c\u79fb\u53ef\u4ee5\u8003\u8651\u5728 $x_k$ \u4e0a\u52a0\u4e00\u6ee1\u8db3 $k\\ge i$\u3002\n\n\u4e0d\u96be\u53d1\u73b0\u8f6c\u79fb\u5bb9\u6613\u5199\u6210\u77e9\u9635\u5f62\u5f0f\u3002\u590d\u6742\u5ea6 $O(2^nn^3\\log m)$ \u5927\u7ea6\u4e3a $1.7\\times10^{10}$\u3002\u7a0d\u5fae\u5361\u5e38\uff0c\u5bf9\u77e9\u9635\u5feb\u901f\u5e42\u90e8\u5206\u8fdb\u884c\u7b80\u5355\u9884\u5904\u7406\uff0c\u589e\u52a0\u8bbf\u95ee\u8fde\u7eed\uff0c\u907f\u514d\u8fc7\u591a\u53d6\u6a21\u5373\u53ef\u901a\u8fc7\u3002\uff08\u5b9e\u9645\u4e0a\u662f $\\frac{1}{12}$ \u7684\u5e38\u6570\uff09\n\n[\u901a\u8fc7\u4ee3\u7801\u3002](https://atcoder.jp/contests/abc241/submissions/39472506)",
        "postTime": 1671887226,
        "uid": 116664,
        "name": "Daniel_lele",
        "ccfLevel": 8,
        "title": "ABC241Ex \u9898\u89e3"
    }
]
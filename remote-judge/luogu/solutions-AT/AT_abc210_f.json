[
    {
        "content": "\u770b\u5230\u8fd9\u79cd\u4e24\u9762\u6027\u7684\u95ee\u9898\u663e\u7136\u60f3\u5230 2-SAT\uff0c\u4e0d\u4f1a 2-SAT \u7684\u5148\u53bb\u505a[\u8fd9\u9898](https://www.luogu.com.cn/problem/P4782)\u3002\n\n\u5177\u4f53\u5730\uff0c\u6211\u4eec\u7ed9\u6bcf\u4e2a\u8d28\u6570\u8bbe\u7f6e\u4e00\u4e2a\u96c6\u5408\uff0c\u5148\u628a\u6bcf\u4e00\u4e2a\u6570\u5b57\u90fd\u8d28\u56e0\u6570\u5206\u89e3\uff0c\u5982\u679c\u67d0\u4e2a\u6570\u6709\u8d28\u56e0\u6570 $p_i$\uff0c\u5c31\u628a\u8fd9\u4e2a\u6570\u7684\u4f4d\u7f6e\u3001\u662f\u6b63\u9762\u8fd8\u662f\u53cd\u9762\uff0c\u52a0\u5165 $p_i$ \u5bf9\u5e94\u7684\u96c6\u5408\u4e2d\u3002\u663e\u7136\uff0c\u5bf9\u4e8e\u67d0\u4e2a\u6570 $x$ \u81f3\u591a\u6709 $\\log x$ \u7ea7\u522b\u7684\u4e0d\u540c\u8d28\u56e0\u6570\u3002\n\n\u8fd9\u6837\u4e00\u6765\u4e00\u4e2a\u96c6\u5408\u4e2d\u7684\u6570\u90fd\u4e0d\u80fd\u540c\u65f6\u5171\u5b58\uff0c\u4e24\u4e24\u8fde\u8fb9\uff08\u82e5$x$ \u5219 $\\neg y$\uff09\u3002\n\u4f46\u662f\u8fd9\u6837\u4e00\u6765\u5c31\u8981\u8fde $O(n^2)$ \u6761\u8fb9\uff0c\u663e\u7136\u65f6\u7a7a\u90fd\u7206\u70b8\uff0c\u4e8e\u662f\u6211\u4eec\u60f3\u5230\u524d\u540e\u7f00\u4f18\u5316\u8fde\u8fb9\u3002\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u96c6\u5408\uff0c\u6211\u4eec\u4ee4 $x_i$ \u4e3a\u7b2c $i$ \u4e2a\u5143\u7d20\uff0c$P_i$ \u4e3a\u524d\u7f00\u7684\u53cd\u9762\u201c$\\neg$\u201d\u8fde\u8fb9\u548c\uff0c$Q_i$ \u4e3a\u540e\u7f00\u7684\u53cd\u9762\u201c$\\neg$\u201d\u8fde\u8fb9\u548c\u3002\u5c06 $P_i$ \u548c $P_{i-1}$\u3001$P_i$ \u548c $\\neg x_i$\u3001$Q_i$ \u548c $Q_{i+1}$\u3001$Q_i$ \u548c $\\neg x_i$ \u8fde\u8fb9\u3002\n\u5219\u5bf9\u4e8e $x_i$\uff0c\u5411 $P_{i-1}$ \u548c $Q_{i+1}$ \u8fde\u8fb9\uff0c\u8fd9\u6837\u6bcf\u4e2a\u96c6\u5408\u53ea\u7528\u8fde $O(n)$ \u6761\u8fb9\u4e86\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n \\log w)$\uff0c\u5176\u4e2d $w = \\max(a_i,b_i)$\u3002\u6ce8\u610f\u70b9\u548c\u8fb9\u7684\u6570\u76ee\u6bd4\u8f83\u5927\uff0c\u6570\u7ec4\u5c3d\u91cf\u5f00\u5927\u70b9\u3002\n\n## \u53c2\u8003\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nstruct node{\n\tint nxt,v,val;\n}e[3000005];\nint n,d[60005],idx;\nint p[200005],cntp,minp[2000005],qp[2000005];\nbool f[2000005];\nvector<int> t[2000005];\nint cntg,h[1000005];\nint dfn[1000005],low[1000005],cnt,s[1000005],sf[1000005],tp,scc[1000005],sc;\nint fd(int w){return w > n ? w - n : w + n;}\nvoid euler(int s)\n{\n\tfor(int i = 2;i <= s;i++)\n\t{\n\t    if(!f[i])\n\t        p[++cntp] = i,qp[i] = cntp,minp[i] = i;\n\t    for(int j = 1;j <= cntp && i * p[j] <= s;j++)\n\t    {\n\t    \tf[i * p[j]] = true,minp[i * p[j]] = p[j];\n\t    \tif(i % p[j] == 0)\n\t    \t    break;\n\t\t}\n\t}\n}\nvoid addedge(int u,int v)\n{\n\te[cntg] = {h[u],v},h[u] = cntg++;\n}\nvoid tarjan(int u)\n{\n    low[u] = dfn[u] = ++cnt,s[++tp] = u,sf[u] = 1;\n    for(int i = h[u];i;i = e[i].nxt)\n\t{\n        if (!dfn[e[i].v])\n            tarjan(e[i].v),low[u] = min(low[u],low[e[i].v]);\n\t\telse if(sf[e[i].v])\n            low[u] = min(low[u],dfn[e[i].v]);\n    }\n    if(dfn[u] == low[u])\n\t{\n        sc++;\n        while(s[tp] != u)\n            scc[s[tp]] = sc,sf[s[tp--]] = 0;\n        scc[s[tp]] = sc,sf[s[tp--]] = 0;\n    }\n}\nint main()\n{\n\teuler(2000000);\n\tscanf(\"%d\",&n),idx = n * 2;\n\tfor(int i = 1;i <= n;i++)\n\t    scanf(\"%d%d\",&d[i],&d[i + n]);\n\tfor(int i = 1;i <= n * 2;i++)\n\t{\n\t\tint tmp = d[i];\n\t\twhile(tmp > 1)\n\t\t{\n\t\t\twhile(tmp / minp[tmp] % minp[tmp] == 0)\n\t\t\t    tmp /= minp[tmp];\n\t\t\tt[qp[minp[tmp]]].push_back(i),tmp /= minp[tmp];\n\t\t}\n\t}\n\tfor(int i = 1;i <= cntp;i++)\n\t{\n\t    if(t[i].empty())\n\t        continue;\n\t    addedge(++idx,fd(t[i][0]));\n\t\tfor(int j = 1;j < t[i].size();j++)\n\t\t\taddedge(t[i][j],idx++),addedge(idx,idx - 1),addedge(idx,fd(t[i][j]));\n\t    addedge(++idx,fd(t[i][t[i].size() - 1]));\n\t\tfor(int j = t[i].size() - 2;j >= 0;j--)\n\t\t\taddedge(t[i][j],idx++),addedge(idx,idx - 1),addedge(idx,fd(t[i][j]));\n\t}\n\tfor(int i = 1;i <= idx;i++)\n\t    if(!dfn[i])\n\t        tarjan(i);\n\tfor(int i = 1;i <= n;i++)\n        if(scc[i] == scc[i + n])\n            printf(\"No\"),exit(0);\n    printf(\"Yes\");\n\treturn 0;\n}\n```",
        "postTime": 1677853532,
        "uid": 684131,
        "name": "EmpError",
        "ccfLevel": 5,
        "title": "[ABC210F] Coprime Solitaire"
    },
    {
        "content": "### [[ABC210F] Coprime Solitaire](https://www.luogu.com.cn/problem/AT_abc210_f)\n\n\u8003\u8651\u5bf9\u4e8e\u503c\u57df\u8303\u56f4\u5185\u7684\u6bcf\u4e00\u4e2a\u8d28\u6570 $p$\u3002\n\n\u5c06\u6240\u6709 $a_i/b_i$ \u80fd\u88ab\u5f53\u524d\u8d28\u6570\u6574\u9664\u7684\u90fd\u627e\u51fa\u6765\uff1a\n\n- \u5982\u679c $a_i$ \u80fd\u88ab $p$ \u6574\u9664\uff0c\u90a3\u4e48\u6211\u4eec\u5c06 $i$ \u653e\u5165\u3002\n\n- \u5982\u679c $b_i$ \u80fd\u88ab $p$ \u6574\u9664\uff0c\u90a3\u4e48\u6211\u4eec\u5c06 $i+n$ \u653e\u5165\u3002\n\n\u90a3\u4e48\u6211\u4eec\u5bf9\u4e8e\u5f53\u524d\u7684\u6574\u4e2a\u6570\u7ec4 $c$ \uff0c\u5982\u679c $c_i$ \u9009\u4e86\uff0c\u90a3\u4e48 $\\forall_{1\\le j\\le n\\&j\\ne i}\\ \\ c_j$ \u8fd9\u4e9b\u5c31\u5fc5\u987b\u4e0d\u80fd\u9009\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e\u67d0\u4e00\u4e2a\u70b9 $i$ \u6211\u4eec\u8981\u5411\u6240\u6709\u7684 $\\neg c_j$ \u8fde\u8fb9\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u8fd9\u6837\u7684\u590d\u6742\u5ea6\u662f $n^2$ \u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8003\u8651\u6362\u4e00\u79cd\u8fde\u8fb9\u65b9\u5f0f\uff0c\u6211\u4eec\u591a\u6dfb\u52a0 $n$ \u4e2a\u70b9 $f_{1\\sim n}$\u3002\n\n\u5176\u4e2d $f_i$ \u5411 $f_{i-1}$ \u548c $\\neg c_i$ \u8fde\u8fb9\uff0c\u7279\u6b8a\u7684 $f_1$ \u53ea\u5411 $\\neg c_1$ \u8fde\u8fb9\u3002\n\n\u7136\u540e\u5bf9\u4e8e $c_i$ \u6211\u4eec\u8fde\u8fb9\u5411 $f_{i-1}$\u3002\n\n\u5bb9\u6613\u53d1\u73b0\u6211\u4eec\u7684 $c_i$ \u5c31\u53ef\u4ee5\u95f4\u63a5\u6307\u5411 $\\forall_{1\\le j< i}\\ \\neg c_j$\u3002\n\n\u8fd9\u5c31\u662f\u524d\u7f00\u4f18\u5316\u5efa\u8fb9\uff0c\u540c\u7406\u6211\u4eec\u53ef\u4ee5\u641e\u51fa\u540e\u7f00\u4f18\u5316\u5efa\u8fb9\uff0c\u6240\u4ee5\u6211\u4eec\u5c31\u53ef\u4ee5\u5728 $O(n)$ \u7684\u590d\u6742\u5ea6\u91cc\u9762\u8fde\u51fa\u6548\u679c\u76f8\u540c\u7684\u8fb9\u3002\n\n\u5bb9\u6613\u53d1\u73b0\uff0c\u6211\u4eec\u76f4\u63a5\u7b5b\u51fa\u6240\u6709\u8d28\u6570\u662f\u884c\u4e0d\u901a\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u8981\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u6570\u8fdb\u884c\u8d28\u56e0\u6570\u5206\u89e3\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u8d28\u56e0\u6570\uff0c\u6211\u4eec\u9700\u8981\u5c06\u4ed6\u653e\u5165\u5bf9\u5e94\u8d28\u56e0\u6570\u7684 `vector` \u91cc\u9762\u3002\n\n\u7ec6\u8282\u6781\u591a\uff0c\u9700\u8981\u4ed4\u7ec6\u68c0\u67e5\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define M 2000005\n#define int long long\nusing namespace std;\ninline int read()\n{\n\tint x=0,f=1;char ch=getchar();\n\twhile (ch<'0'||ch>'9'){if (ch=='-') f=-1;ch=getchar();}\n\twhile (ch>='0'&&ch<='9'){x=x*10+ch-48;ch=getchar();}\n\treturn x*f;\n}\nint n,cnt,mx,qwq,r[M],f[M],t[M],l[M],a[M],p[M],b[M],cwc,awa,low[M],dep,dfn[M],id[M];\nstack<int> s;\nvector<int> v[M];\nbool lt[M],vis[M],pos[M];\nstruct fig\n{\n\tint to,next;\n}k[M*10];int tot,head[M];\nvoid add(int from,int to)\n{\n\tk[++tot].to=to;\n\tk[tot].next=head[from];\n\thead[from]=tot;\n}\nint xp(int x)\n{\n\tif(x<=n)return x+n;\n\telse return x-n;\n}\nvoid tarjan(int now)\n{\n\ts.push(now);\n\tdfn[now]=++dep;\n\tlow[now]=dep;\n\tvis[now]=1;\n\tfor(int i=head[now],to;i;i=k[i].next)\n\t{\n\t\tto=k[i].to;\n\t\tif(!dfn[to])tarjan(to);\n\t\tif(vis[to])low[now]=min(low[now],low[to]);\n\t}\n\tif(dfn[now]==low[now])\n\t{\n\t\tid[now]=now;\n\t\tvis[now]=0;\n\t\tint to=s.top();\n\t\ts.pop();\n\t\twhile(to!=now)\n\t\t{\n\t\t\tvis[to]=0;\n\t\t\tid[to]=now;\n\t\t\tto=s.top();\n\t\t\ts.pop();\n\t\t}\n\t}\n}\nsigned main()\n{\n\tn=read();qwq=n*2;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\ta[i]=read();\n\t\tb[i]=read();\n\t\tmx=max({mx,a[i],b[i]});\n\t}\n\tmemset(lt,1,sizeof(lt));\n\tlt[1]=0;\n\tfor(int i=1;i<=mx;i++)\n\t{\n\t\tif(lt[i]==1)l[++cnt]=i;\n\t\tfor(int j=1;j<=cnt&&i*l[j]<=mx;j++)\n\t\t{\n\t\t\tlt[i*l[j]]=0;\n\t\t\tif(i%l[j]==0)break;\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tfor(int j=1,con=sqrt(a[i]);j<=con;j++)\n\t\t{\n\t\t\tif(a[i]%j==0)\n\t\t\t{\n\t\t\t\tif(lt[j]==1)v[j].push_back(i);\n\t\t\t\telse if(lt[a[i]/j])v[a[i]/j].push_back(i);//\u4e00\u5b9a\u8981\u52a0 else\n\t\t\t}\n\t\t}\n\t\tfor(int j=1,con=sqrt(b[i]);j<=con;j++)\n\t\t{\n\t\t\tif(b[i]%j==0)\n\t\t\t{\n\t\t\t\tif(lt[j]==1)v[j].push_back(i+n);\n\t\t\t\telse if(lt[b[i]/j])v[b[i]/j].push_back(i+n);\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i=1;i<=mx;i++)if(pos[i])p[++cwc]=i;\n\tfor(int i=1;i<=cnt;i++)\n\t{\n\t\tawa=v[l[i]].size();\n\t\tif(!awa)continue;\n\t\tf[1]=++qwq;add(f[1],xp(v[l[i]][0]));\n\t\tfor(int j=2;j<=awa;j++)\n\t\t{\n\t\t\tf[j]=++qwq;\n\t\t\tadd(f[j],f[j-1]);\n\t\t\tadd(f[j],xp(v[l[i]][j-1]));\n\t\t\tadd(v[l[i]][j-1],f[j-1]);\n\t\t}\n\t\tt[awa]=++qwq;add(t[awa],xp(v[l[i]][awa-1]));\n\t\tfor(int j=awa-1;j>=1;j--)\n\t\t{\n\t\t\tt[j]=++qwq;\n\t\t\tadd(t[j],t[j+1]);\n\t\t\tadd(t[j],xp(v[l[i]][j-1]));\n\t\t\tadd(v[l[i]][j-1],t[j+1]);\n\t\t}\n\t}\n\tfor(int i=1;i<=qwq;i++)if(!dfn[i])tarjan(i);\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tif(id[i]==id[i+n])\n\t\t{\n\t\t\tcout<<\"No\\n\";\n\t\t\treturn 0;\n\t\t}\n\t}\n\tcout<<\"Yes\\n\";\n\treturn 0;\n}\n\n```",
        "postTime": 1677652519,
        "uid": 331947,
        "name": "hegm",
        "ccfLevel": 0,
        "title": "[ABC210F] Coprime Solitaire \u9898\u89e3"
    }
]
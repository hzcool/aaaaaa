[
    {
        "content": "\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e8c\u8fdb\u5236\u641c\u7d22\u6765\u627e\u5230\u7b54\u6848.\u5728\u6bcf\u6b21\u8fed\u4ee3\u4e2d,\u6211\u4eec\u89e3\u51b3\u4ee5\u4e0b\u5b50\u95ee\u9898:\n\n> \u4e8c\u7ef4\u5e73\u9762\u4e0a\u6709$N$\u884c.\u5176\u4e2d\u4e24\u4e2a\u7559\u7f6e\u6743\u7684\u4ea4\u70b9\u6709\u591a\u5c11\u5728$x^2+y^2=r^2?$\n\n\u4e8c\u8fdb\u5236\u641c\u7d22\u9700\u8981\u89e3\u7684\u4e0a\u754c.\u89e3\u51b3\u65b9\u6848\u5982\u4e0b:\n\n$$\n\\begin{cases}\nax+by+c = 0\\\\\ndx+ey+f =0\n\\end{cases}\n$$\n\n\u662f$x=\\frac{bf-ce}{ae-bd} ,y=\\frac{cd-af}{ae-bd}$.\u56e0\u4e3a$|bf-ce|,|cd-af|\u22642\u00d710^6,|ae-bd|\u22651$,\u89e3\u51b3\u65b9\u6848\u6700\u591a\u662f$\\sqrt[2]{2} \\times 10^6$\n\n\u73b0\u5728\u6211\u4eec\u8003\u8651\u5b50\u95ee\u9898.\n\n\u627e\u5230\u6bcf\u4e2a\u8fde\u7ebf\u7684$x^2+y^2=r^2$\u548c$ax+by+c=0$\u7684\u4ea4\u96c6\uff0c\u5e76\u6309\u65b9\u4f4d\u89d2\u6392\u5e8f\uff0c\u5219\u5b50\u95ee\u9898\u7b49\u4ef7\u4e8e\uff1a\n\n> \u5728\u4e8c\u7ef4\u5e73\u9762\u4e0a\u6709\u4e00\u4e2a\u5706.\u7ed9\u60a8\u4e00\u4e9b\u7aef\u70b9\u4f4d\u4e8e\u5706\u4e0a\u7684\u7ebf\u6bb5.\u6c42\u51fa\u8fd9\u4e9b\u7ebf\u6bb5\u7684\u4ea4\u70b9\u6570.\n\n\u6211\u4eec\u53ef\u4ee5\u5728\u67d0\u4e2a\u70b9\u4e0a\u5207\u5272\u5706\u5708,\u5c06\u95ee\u9898\u91cd\u65b0\u8868\u8ff0\u5982\u4e0b:\n\n> \u7ed9\u60a8$N$\u6bb5,\u7b2c$i$\u6bb5\u662f$[L_i,R_i]$.\u627e\u5230\u5bf9$(i,j)$\u7684\u6570\u91cf,\u4f7f$1\u2264i,j\u2264N$\u548c$L_i<L_j<R_i<R_j$.\n\n\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u89e3\u51b3.\n\n>- \u7ef4\u62a4\u4e00\u4e2a\u957f\u5ea6\u4e3a$\\max R$\u7684\u6570\u7ec4\uff0c\u6bcf\u4e2a\u5143\u7d20\u521d\u59cb\u5316\u4e3a$0$.\n>- \u6309$R_i$\u7684\u5347\u5e8f\u5bf9\u6bb5\u8fdb\u884c\u6392\u5e8f.\u6309\u6392\u5e8f\u987a\u5e8f\u5904\u7406\u6bcf\u4e2a\u6bb5:\n>>- \u5c06\u6570\u7ec4\u7684$L_i$\u503c\u6dfb\u52a0\u5230\u7b54\u6848\u4e2d.\n>>- \u5c06$+1$\u6dfb\u52a0\u5230\u7b2c$(L_i+1)$\u5230$(R_i-1)$\u6570\u7ec4\u7684\u7b2c\u51e0\u4e2a\u5143\u7d20\n\n\u65f6\u95f4\u590d\u6742\u5ea6$O(N \\log N)$\n\n\u65f6\u95f4\u603b\u590d\u6742\u5ea6$O(N \\log N \\log P)$,\u5176\u4e2d$P$\u662f\u7cbe\u5ea6.",
        "postTime": 1669940945,
        "uid": 742845,
        "name": "Minecraft11lbs",
        "ccfLevel": 0,
        "title": "[ABC263Ex] Intersection 2 \u9898\u89e3"
    },
    {
        "content": "\u5443\u5443\uff0c\u89e3\u6790\u51e0\u4f55\u3002\n\n\u4e8c\u5206\u7b54\u6848\uff0c\u7136\u540e\u95ee\u9898\u8f6c\u5316\u4e3a\u4e86\u6c42\u4e00\u4e2a\u5706\u5185\u90e8\u76f8\u4ea4\u7684\u5f26\u7684\u5bf9\u6570\u3002\n\n\u5148\u8054\u7acb\u6c42\u4ea4\u70b9\uff0c\u53ef\u5f97 $x=\\frac{-2ac\\pm\\sqrt{4a^2c^2-4(c^2-b^2r^2)(a^2+b^2)}}{2(a^2+b^2)}$\uff0c\u8fd9\u4e2a\u516c\u5f0f\u9700\u8981\u7279\u5224 $b=0$ \u7684\u60c5\u51b5\u3002\n\n\u7b97\u51fa\u4ea4\u70b9 $(x,y)$ \u4e4b\u540e\u628a\u6240\u6709\u4ea4\u70b9\u6781\u89d2\u6392\u5e8f\u79bb\u6563\u5316\uff0c\u7136\u540e\u518d\u628a\u6bcf\u6761\u5f26\u6309\u7167\u5de6\u7aef\u70b9\u5927\u5c0f\u6392\u5e8f\uff0c\u626b\u8fc7\u53bb\u7684\u65f6\u5019\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u4e00\u4e0b\u533a\u95f4\u5185\u53f3\u7aef\u70b9\u7684\u4e2a\u6570\u5c31\u662f\u76f8\u4ea4\u7684\u5f26\u6570\u91cf\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n\\log n\\log V)$\u3002\n\n```cpp\n#pragma GCC optimize(\"Ofast\")\n#include<iostream>\n#include<cstdio>\n#include<cmath>\n#include<algorithm>\n#include<vector>\nusing namespace std;\nint n,m,cnt,sum[100001];\nbool tag[50001];\ndouble a[50001],b[50001],c[50001];\npair<int,int> p[50001];\nvector<pair<pair<double,double>,int> > q;\ninline int lowbit(int x)\n{\n    return x&-x;\n}\ninline void update(int x)\n{\n    for(;x<=cnt;x+=lowbit(x))\n        ++sum[x];\n}\ninline int query(int x)\n{\n    int res=0;\n    for(;x;x-=lowbit(x))\n        res+=sum[x];\n    return res;\n}\ninline bool calc(double a,double b,double c,double r,pair<double,double> &x,pair<double,double> &y)\n{\n    if(!b)\n    {\n        double val=-c/a;\n        if(val>=-r&&val<=r)\n        {\n            x={val,-sqrt(r*r-val*val)};\n            y={val,sqrt(r*r-val*val)};\n            return 1;\n        }\n        return 0;\n    }\n    double d=4*a*a*c*c-4*(c*c-b*b*r*r)*(a*a+b*b);\n    if(d<=0)\n        return 0;\n    double val1=(-2*a*c-sqrt(d))/(2*(a*a+b*b)),val2=(-2*a*c+sqrt(d))/(2*(a*a+b*b));\n    x={val1,-(a*val1+c)/b};\n    y={val2,-(a*val2+c)/b};\n    return 1;\n}\ninline bool check(double r)\n{\n    q.clear();\n    cnt=0;\n    for(int i=1;i<=n;++i)\n    {\n        tag[i]=p[i].first=p[i].second=0;\n        pair<double,double> x,y;\n        if(calc(a[i],b[i],c[i],r,x,y))\n        {\n            q.emplace_back(x,i);\n            q.emplace_back(y,i);\n        }\n    }\n    int res=0;\n    sort(q.begin(),q.end(),[&](auto x,auto y){return atan2(x.first.second,x.first.first)<atan2(y.first.second,y.first.first);});\n    for(auto i:q)\n        if(!p[i.second].first)\n            p[i.second].first=++cnt;\n        else\n            p[i.second].second=++cnt;\n    sort(q.begin(),q.end(),[&](auto x,auto y){return p[x.second].first<p[y.second].first;});\n    for(auto i:q)\n        if(tag[i.second])\n        {\n            res+=query(p[i.second].second-1)-query(p[i.second].first);\n            update(p[i.second].second);\n        }\n        else\n            tag[i.second]=1;\n    for(int i=1;i<=cnt;++i)\n        sum[i]=0;\n    //cout<<r<<\" \"<<res<<'\\n';\n    return res>=m;\n}\nint main()\n{\n    cin>>n>>m;\n    for(int i=1;i<=n;++i)\n        cin>>a[i]>>b[i]>>c[i];\n    double l=0,r=1e7,mid,ans=1e18;\n    if(!check(r))\n        return 1;\n    for(int i=1;i<=50;++i)\n    {\n        mid=(l+r)/2;\n        if(check(mid))\n        {\n            ans=mid;\n            r=mid;\n        }\n        else\n            l=mid;\n    }\n    printf(\"%.10lf\\n\",ans);\n    return 0;\n}\n```",
        "postTime": 1659796945,
        "uid": 85682,
        "name": "\u7edd\u9876\u6211\u4e3a\u5cf0",
        "ccfLevel": 8,
        "title": "ABC263 Ex \u9898\u89e3"
    }
]
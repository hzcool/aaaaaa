[
    {
        "content": "\u9996\u5148\u8fd9\u9898\u4e0d\u77e5\u4e3a\u4ec0\u4e48\uff0c\u6d1b\u8c37\u6bd4Atcoder\u5c11\u4e86\u4e00\u7ec4\u6837\u4f8b\uff1a\n\nSample Input 3\n```pascal\n1 0\n5\n```\nSample Output 3\n```pascal\n0\n```\n\n\u5e0c\u671b\u7ba1\u7406\u5458\u52a0\u4e0a\uff0c\u8c22\u8c22\n\n**\u601d\u8def\uff1a\u5e76\u67e5\u96c6+\u8d2a\u5fc3**\n\n\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u8fde\u901a\u5757\uff0c\u7136\u540e\u8d2a\u5fc3\n\n\u8bbe\u6709tot\u4e2a\u8fde\u901a\u5757\uff0c\u6240\u4ee5\u8981\u9009$2(tot-1)$\u4e2a\u70b9\u3002\n\n\u5728\u6bcf\u4e2a\u8054\u901a\u5757\u91cc\u627e\u5230\u4e00\u4e2a\u6743\u503c\u6700\u5c0f\u7684\u70b9\uff0c\u5269\u4e0b\u7684\u70b9\u6309\u6743\u503c\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u9009\u524d$tot\u22122$\u4e2a\u3002\n\n\u5982\u679c\u5269\u4e0b\u7684\u70b9\u4e0d\u8db3$tot-2$\u4e2a\uff0c\u76f4\u63a5Impossible\uff0c\u5426\u5219\u8f93\u51fa\u7b54\u6848\n\n\u6ce8\u610f\u5982\u679c\u539f\u56fe\u5df2\u7ecf\u8054\u901a\u65f6\u8981\u76f4\u63a5\u8f93\u51fa0\uff0c\u8fd9\u4e2a\u5728\u6ca1\u6709\u722c\u7684\u4e00\u7ec4\u6837\u4f8b\u91cc\u9762\u8bf4\u660e\u7684\u5f88\u660e\u663e\u3002~~\u8981\u4e0d\u662f\u53bb\u4e86\u4e00\u8d9fAT\u6211\u4f30\u8ba1\u4e0d\u4f1a\u60f3\u5230\u8fd8\u6709\u8fd9\u4e2a\u95ee\u9898~~\n\n\u4ee3\u7801\uff1a\n```cpp\n#include<bits/stdc++.h>\n#include<iostream>\n#include<cstdio>\n#define ll long long\n#define N 100010\nusing namespace std;\n\nll n,m,tot,ans,a[N],father[N],cnt[N];\n//tot\u8868\u793a\u8fde\u901a\u5757\u4e2a\u6570\n//a\u8868\u793a\u6bcf\u4e2a\u70b9\u7684\u6743\u503c\n//father\u8868\u793a\u5e76\u67e5\u96c6\u7684\u7236\u8282\u70b9\n//cnt\u8868\u793a\u8fde\u901a\u5757i\u5bf9\u5e94\u7684q\u662f\u54ea\u4e2a\nvector<ll> t,q[N];\n//t\u8868\u793a\u524dtot\u4e2a\u70b9\u9009\u5b8c\u4e4b\u540e\u5269\u4e0b\u7684\n//q[i]\u8868\u793a\u7b2ci\u4e2a\u8fde\u901a\u5757\u91cc\u7684\u70b9\u7684\u6743\u503c\n\ninline ll read(){//\u8bfb\u5165\u4f18\u5316\n\tll x=0,tmp=1;\n\tchar ch=getchar();\n\twhile(!isdigit(ch)){\n\t\tif(ch=='-') tmp=-1;\n\t\tch=getchar();\n\t}\n\twhile(isdigit(ch)){\n\t\tx=(x<<3)+(x<<1)+(ch^48);\n\t\tch=getchar();\n\t}\n\treturn tmp*x;\n}\n\nll searchfather(ll v){//\u5e76\u67e5\u96c6\n\tif(father[v]==v) return father[v];\n\treturn father[v]=searchfather(father[v]);\n}\n\nint main(){\n\tn=read(); m=read();\n\tfor(ll i=1; i<=n; i++){\n\t\ta[i]=read();\n\t\tfather[i]=i;\n\t}\n\twhile(m--){\n\t\tll x=read()+1,y=read()+1;\n\t\tll f1=searchfather(x),f2=searchfather(y);\n\t\tif(father[f1]!=f2) father[f1]=f2;\n\t}\n\tfor(ll i=1; i<=n; i++){\n\t\tfather[i]=searchfather(i);\n\t\tif(!cnt[father[i]]) cnt[father[i]]=++tot;//\u5f53\u524d\u8fde\u901a\u5757\u6ca1\u6709\u88ab\u7edf\u8ba1\n\t\tq[cnt[father[i]]].push_back(a[i]);//\u52a0\u5165\u6743\u503c\n\t}\n\tif(tot==1) return printf(\"0\\n\")&0;//\u56fe\u5df2\u7ecf\u8054\u901a\u4e86\n\tfor(ll i=1; i<=tot; i++) sort(q[i].begin(),q[i].end());//\u6392\u5e8f\n\tfor(ll i=1; i<=tot; i++) ans+=q[i][0];//\u53d6\u8d70\u7b2c\u4e00\u4e2a\n\tfor(ll i=1; i<=tot; i++){\n\t\tfor(ll j=1; j<q[i].size(); j++) t.push_back(q[i][j]);//\u4ece\u7b2c\u4e8c\u4e2a\u5f00\u59cb\u5f80\u540e\u53d6\n\t}\n\tsort(t.begin(),t.end());\n\tif(t.size()<tot-2) return printf(\"Impossible\\n\")&0;//\u4e0d\u591f\n\tfor(ll i=0; i<tot-2; i++) ans+=t[i];\n\tcout<<ans<<endl;\n\treturn 0;\n}\n```",
        "postTime": 1565245098,
        "uid": 27924,
        "name": "xukuan",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 AT3911 \u3010Forest\u3011"
    },
    {
        "content": "#### \u9898\u610f\u7b80\u8ff0\r\n\r\n\u7ed9\u5b9a\u4e00\u7247\u7531 $N$ \u4e2a\u70b9\u548c $M$ \u6761\u8fb9\u7ec4\u6210\u7684\u68ee\u6797 $G$\uff0c\u6bcf\u4e2a\u70b9\u6709\u70b9\u6743\uff0c\u5176\u4e2d\u7b2c $i$ \u4e2a\u70b9\u7684\u70b9\u6743\u4e3a $a_i$\uff0c\u73b0\u5728\u9700\u8981\u52a0\u4e0a\u82e5\u5e72\u6761\u8fb9\uff0c\u5176\u4e2d\u8fde\u63a5\u7b2c $i$ \u4e2a\u70b9\u4e0e\u7b2c $j$ \u4e2a\u70b9\u7684\u82b1\u8d39\u4e3a $a_i+a_j$\uff0c\u4efb\u610f\u65b0\u52a0\u7684\u4e24\u6761\u8fb9\u4e4b\u95f4\u4e0d\u80fd\u6709\u516c\u5171\u7aef\u70b9\uff0c\u6c42\u5c06\u8fd9\u7247\u68ee\u6797\u8fde\u901a\u7684\u6700\u5c0f\u82b1\u8d39\u6216\u8f93\u51fa\u65e0\u6cd5\u8054\u901a\u8fd9\u7247\u68ee\u6797\u3002\r\n\r\n\u5bf9\u4e8e\u5168\u90e8\u6570\u636e\uff0c$N\\le10^5$\u3002\r\n\r\n#### \u9898\u76ee\u89e3\u6cd5\r\n\r\n\u663e\u7136\u53ef\u4ee5**\u628a\u8d21\u732e\u62c6\u5230\u70b9\u6743**\u4e0a\u53bb\uff0c\u8bb0\u7b2c $i$ \u4e2a\u70b9\u88ab\u8ba1\u5165\u4e86\u7b54\u6848 $c_i\\small(c_i\\in\\{0,1\\})$ \u6b21\uff0c\u5219\u6700\u7ec8\u82b1\u8d39\u5373\u4e3a $\\sum\\limits_{i=1}^{N}a_ic_i$\uff0c\u8fd9\u6307\u5bfc\u7740\u6211\u4eec**\u8003\u8651\u4e00\u4e2a\u7ed9\u5b9a\u7684 $c$ \u662f\u5426\u53ef\u884c**\uff0c\u56e0\u4e3a\u5bf9\u4e8e\u76f8\u540c\u7684 $c$\uff0c\u6240\u5bf9\u5e94\u7684\u82b1\u8d39\u662f\u4e00\u6837\u7684\u3002\r\n\r\n\u6211\u4eec\u663e\u7136\u6709 $\\sum\\limits_{i=1}^{N}c_i=N-1-M$ \u4e14\u5bf9\u4e8e\u6bcf\u4e2a\u8fde\u901a\u5757\uff0c\u5176\u4e2d\u6240\u6709\u7684\u70b9\u7684 $c_i$ \u7684\u548c\u4e0d\u4e3a $0$\uff0c\u6211\u4eec\u731c\u6d4b**\u5176\u4e3a\u5145\u8981\u6761\u4ef6**\u3002\r\n\r\n\u5b9e\u9645\u4e0a\uff0c\u8fd9\u76f8\u5f53\u4e8e\u7ed9\u5b9a\u4e00\u68f5\u6709 $N$ \u4e2a\u70b9\u7684\u6811\u6bcf\u4e2a\u70b9\u7684\u5ea6\u6570\uff0c\u4fdd\u8bc1\u6bcf\u4e2a\u70b9\u7684\u5ea6\u6570 $d_i$ \u5747\u4e3a\u6b63\u6574\u6570\u4e14\u603b\u548c\u4e3a $2(N-1)$\uff0c\u53ef\u4ee5\u901a\u8fc7\u6570\u5b66\u5f52\u7eb3\u6cd5\u6765\u8bc1\u660e\u5bf9\u4efb\u610f\u6ee1\u8db3\u4ee5\u4e0a\u6761\u4ef6\u7684 $d$\uff0c\u5747\u5b58\u5728\u4e00\u79cd\u65b9\u6848\u5c06\u5b83\u4eec\u8fde\u6210\u4e00\u68f5\u6811\uff1a\r\n\r\n- \u5f53 $N\\le2$\uff0c\u539f\u547d\u9898\u663e\u7136\u6210\u7acb\uff1b\r\n- \u5f53 $N=x-1$ \u5b58\u5728\u65b9\u6848\u65f6\uff0c\u4e0b\u9762\u6765\u8bc1\u660e $N=x$ \u65f6\u4e00\u5b9a\u6709\u89e3\uff1a \r\n  \u7531\u4e8e $\\sum\\limits_{i=1}^{N}d_i=N-1$ \u4e14 $d$ \u5747\u4e3a\u6b63\u6574\u6570\uff0c\u6240\u4ee5\u5fc5\u7136\u5b58\u5728 $d_i=1$ \u4ee5\u53ca $d_j>1$\uff0c\u5c06 $i$ \u4e0e $j$ \u8fde\u8fb9\uff0c\u5219\u539f\u547d\u9898\u8f6c\u5316\u4e3a $N=x-1$ \u65f6\u7684\u547d\u9898\uff0c\u6545\u5bf9\u4e8e\u4efb\u610f\u6b63\u6574\u6570 $N$ \u4ee5\u53ca $d$\uff0c\u5747\u5b58\u5728\u4e00\u79cd\u65b9\u6848\u5c06\u5b83\u4eec\u8fde\u6210\u4e00\u68f5\u6811\u3002\r\n\r\n\u6240\u4ee5\u53ef\u4ee5\u91c7\u7528**\u8d2a\u5fc3**\u7684\u65b9\u6cd5\uff0c\u5148\u5c06\u6bcf\u4e2a\u8fde\u901a\u5757\u5185\u6700\u5c0f\u7684 $a_i$ \u9009\u51fa\u6765\uff0c\u628a\u8fd9\u4e9b\u70b9\u53bb\u6389\u540e\u9009\u53d6\u5269\u4f59\u6570\u4e2d\u6700\u5c0f\u7684 $N-2$ \u4e2a $a_i$ \u5373\u53ef\uff08\u5982\u679c\u4e0d\u8db3\u90a3\u4e48\u8f93\u51fa\u65e0\u89e3\uff09\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal{O}(n\\log n)$\u3002\r\n\r\n#### \u603b\u7ed3\r\n\r\n\u5c06\u8fb9\u6743\u8f6c\u5316\u4e3a\u70b9\u6743\u5bf9\u82b1\u8d39\u7684\u8d21\u732e\uff0c\u518d\u5bf9\u82b1\u8d39\u76f8\u540c\u7684\u65b9\u6848\u8fdb\u884c\u7b80\u5316\u5904\u7406\uff0c\u7136\u540e\u5927\u80c6\u731c\u60f3\u5145\u8981\u6761\u4ef6\uff0c\u6700\u540e\u8d2a\u5fc3\u8ba1\u7b97\u5373\u53ef\u3002",
        "postTime": 1680947388,
        "uid": 183609,
        "name": "hhoppitree",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 APC001D"
    },
    {
        "content": "# Forest\n\n\u76f4\u63a5\u8d2a\u5fc3\u3002\n\n\u8bbe\u6709k\u4e2a\u8054\u901a\u5757\u3002\n\n\u7531\u4e8e\u6bcf\u4e2a\u70b9\u53ea\u80fd\u9009\u4e00\u6b21\uff0c\u6240\u6709\u7684\u8054\u901a\u5757\u5f62\u6210\u4e00\u4e2a\u6811\uff0c\u6240\u4ee5\u4e00\u5171\u8981\u9009$2(k-1)$\u4e2a\u70b9\n\n\u5728\u6bcf\u4e2a\u8054\u901a\u5757\u91cc\u627e\u5230\u4e00\u4e2a\u6743\u503c\u6700\u5c0f\u7684\u70b9\uff0c\u5171k\u4e2a\u70b9\uff0c\u4ee5\u4fdd\u8bc1\u6700\u7ec8\u6bcf\u4e2a\u5757\u90fd\u88ab\u9009\u4e86\u3002\n\n\u5269\u4e0b\u7684\u70b9\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u9009\u524d$k-2$\u4e2a\u3002",
        "postTime": 1551785675,
        "uid": 66048,
        "name": "jiangbojun",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 AT3911 \u3010Forest\u3011"
    }
]
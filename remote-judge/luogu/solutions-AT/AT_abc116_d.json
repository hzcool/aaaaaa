[
    {
        "content": "### \u5927\u610f\n\n\u6709 $ n $ \u4e2a\u7269\u54c1\uff0c\u6bcf\u4e2a\u7269\u54c1\u6709\u79cd\u7c7b\u548c\u4ef7\u503c\u3002\n\n\u8981\u9009\u62e9 $ k $ \u4e2a\u7269\u54c1\uff0c\u4f7f\u5f97\u4ef7\u503c\u548c\u52a0\u4e0a\u4e0d\u540c\u7269\u54c1\u4e2a\u6570\u548c\u7684\u5e73\u65b9\u6700\u5927\u3002\n\n\u5373\u5982\u679c\u7684\u7269\u54c1\u4ef7\u503c\u548c\u4e3a $ x $ \uff0c\u6709 $ y $ \u4e2a\u4e0d\u540c\u79cd\u7c7b\u7684\u7269\u54c1\uff0c\u8d21\u732e\u4e3a $ x + y^2 $ \u3002\n\n### \u601d\u8def\n\n\u6309\u4ef7\u503c\u964d\u5e8f\uff0c\u679a\u4e3e\u9009 $ i $ \u4e2a\u79cd\u7c7b\u4e0d\u540c\u7684\u7269\u54c1\uff0c\u8d8a\u9760\u524d\u8d8a\u597d\uff0c\u518d\u4ece\u524d\u5f80\u540e\u9009\u62e9 $ k - i $ \u4e2a\u672a\u9009\u62e9\u7684\u3002\n\n\u7531\u4e8e\u4ef7\u503c\u964d\u5e8f\uff0c\u5219\u4e00\u5b9a\u5728\u9009 $ i $ \u4e2a\u79cd\u7c7b\u4e0d\u540c\u7684\u7269\u54c1\u4e2d\u6700\u4f18\u3002\n\n\u4f7f\u7528\u6570\u7ec4\u6a21\u62df\u53ef\u4ee5\u505a\u5230\u7ebf\u6027\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $ O(n \\log_{2}n) $ \u3002\n\n### \u4ee3\u7801\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,m,s,l;\n#define f(i,j,k) for(register int i=j;i<=k;++i)\n#define g(i,j,k) for(register int i=j;i>=k;--i)\n#define ii pair<int,int>\nii a[101010];\nint t[101010];\nint v[101010];\nlong long p,q;\nint main(){\n    cin>>n>>m;\n    f(i,1,n){\n        scanf(\"%d %d\",&s,&l);\n        a[i]=(ii){-l,s};\n    }\n    sort(a+1,a+n+1);\n    s=1;l=0;\n    f(i,1,m)q-=a[i].first;\n    p=q;\n    f(i,1,n){\n        while(s<=n && v[a[s].second])++s;\n        if(n<s)break;\n        t[s]=v[a[s].second]=1;\n        if(m<s){\n            while(t[m] && m)--m;\n            if(!m)break;\n            q+=a[m--].first;\n            q-=a[s++].first;\n        }\n        p=max(p,q+1ll*i*i);\n    }\n    printf(\"%lld\\n\",p);\n    return 0;\n}\n```",
        "postTime": 1638795796,
        "uid": 218376,
        "name": "IloveSurtr",
        "ccfLevel": 7,
        "title": "AT4285"
    },
    {
        "content": "### Explanation\n\n\u6709 $N$ \u4e2a\u5bff\u53f8\uff0c\u9009 $K$ \u4e2a\u4f7f\u5f97\u6ee1\u8db3\u6700\u5927\u503c\u3002\n\n### Solution\n\n#### Solution 1\n\n$N$ \u4e2a\u9009 $K$ \u4e2a\uff0c\u4e4d\u4e00\u770b\u5c31\u89c9\u5f97\u662f\u80cc\u5305 DP\u3002\n\n\u6309\u7167\u80cc\u5305 DP \u89e3\u6cd5\uff0c\n\n\u7528 $f[i]$ \u8868\u793a\u5728\u8fd9 $N$ \u4e2a\u5bff\u53f8\u9009 $i$ \u4e2a\u5bff\u53f8\u6240\u4ea7\u751f\u7684\u6700\u5927\u6ee1\u8db3\u3002\n\n\u4e00\u5f00\u59cb\u5148\u5bf9\u6240\u6709\u5bff\u53f8\u6309\u7167\u7c7b\u578b\u6392\u4e2a\u5e8f\uff0c\u4ee5\u4fbf\u4e8e\u7b97\u79cd\u7c7b\u6570\u3002\n\n\u7136\u540e\u6309\u7167\u6bcf\u4e2a\u7269\u54c1\u7684\u91cd\u91cf\u4e3a $1$ \u76f4\u63a5\u5f80\u4e0a\u5957 01DP \u6a21\u677f\u3001\u7279\u5224\u4e00\u4e0b\u5bff\u53f8\u79cd\u7c7b\u5373\u53ef\u3002\n\n\u7531\u4e8e\u4f1a\u7206 $int$\uff0c\u8bb0\u5f97\u5f00 $long \\ long$\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nlong long n, k, f[100005], val[100005];\nstruct node\n{\n    long long t, d;\n    bool operator<(const node &x) const\n    {\n        if (t == x.t)\n            return d > x.d;\n        return t < x.t;\n    }\n} a[100005];\nint main()\n{\n    scanf(\"%lld%lld\", &n, &k);\n    for (int i(1); i <= n; ++i)\n        scanf(\"%lld%lld\", &a[i].t, &a[i].d);\n    sort(a + 1, a + n + 1);\n    for (int i(1); i <= n; ++i)\n    {\n        if (a[i].t != a[i - 1].t) //\u7279\u5224\u5bff\u53f8\u79cd\u7c7b\n            for (int j(k); j; --j)\n            {\n                if (f[j - 1] + a[i].d + (val[j - 1] + 1) * (val[j - 1] + 1) - (val[j - 1] * val[j - 1]) > f[j]) //dp\n                    f[j] = f[j - 1] + a[i].d + (val[j - 1] + 1) * (val[j - 1] + 1) - (val[j - 1] * val[j - 1]), val[j] = val[j - 1] + 1;\n            }\n        else\n            for (int j(k); j; --j)\n            {\n                if (f[j - 1] + a[i].d > f[j]) //dp\n                    f[j] = f[j - 1] + a[i].d, val[j] = val[j - 1];\n            }\n    }\n\n    printf(\"%lld\\n\", f[k]);\n    return 0;\n}\n```\n\n\u7136\u540e\u56e0\u4e3a $N \\leq 10 ^ 5$\uff0c\u6240\u4ee5\u6211\u4eec\u7684 $O(n ^ 2)$ \u6210\u529f\u5730 T \u98de\u4e86 /kk\n\n#### Solution 2\n\n\u8003\u8651\u4e00\u4e0b\u6211\u4eec\u7684 DP \u54ea\u91cc\u6700\u8017\u65f6\u95f4\u3002\n\n\u5bf9\u4e8e\u67d0\u4e9b\u5bff\u53f8\uff0c\u52a0\u5230\u5df2\u7ecf\u6709\u7684\u5bff\u53f8\u961f\u5217\u91cc\u4e0d\u4f1a\u5bf9\u5bff\u53f8\u79cd\u7c7b\u6570\u4ea7\u751f\u5f71\u54cd\uff0c\u5e76\u4e14\u4ed6\u7684\u4ef7\u503c\u6bd4\u961f\u5217\u91cc\u7684\u6240\u6709\u5bff\u53f8\u90fd\u4f4e\u3002\n\n\u6240\u4ee5\u5bf9\u4e8e\u8fd9\u79cd\u5bff\u53f8\uff0c\u6211\u4eec\u8981\u575a\u51b3\u963b\u6b62\u3002\n\n\u6240\u4ee5\u6211\u4eec**\u5c0f\u5c0f\u8d2a\u5fc3\u4e00\u4e0b\uff0c\u5148\u6311\u51fa\u6765 $k$ \u4e2a\u4ef7\u503c\u6700\u9ad8\u7684\u5bff\u53f8\uff0c\u7136\u540e\u53bb\u5224\u5bff\u53f8\u79cd\u7c7b\u5bf9\u7ed3\u679c\u4ea7\u751f\u7684\u5f71\u54cd**\n\n\u597d\u7684\u6211\u4eec\u5f00\u59cb\u3002\n\n1. \u627e\u51fa\u6765\u524d $k$ \u4e2a\u4ef7\u503c\u6700\u9ad8\u7684\u5bff\u53f8\n\n\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u7528\u4e00\u4e2a\u4f18\u5148\u961f\u5217\u6765\u627e\u51fa\u8fd9\u4e9b\u5bff\u53f8\u3002\n\n\u5728\u90e8\u5206\u4ee3\u7801\u73af\u8282\uff0c\u6211\u4eec\u4e0d\u59a8\u7528 $tmp$ \u6765\u8868\u793a\u5bff\u53f8\u3002\n\n\u7528 $q$ \u5927\u6839\u5806\u5b58\u50a8\u6240\u6709\u5bff\u53f8\uff0c\u7528 $rev$ \u5c0f\u6839\u5806\u5b58\u50a8 $k$ \u4e2a\u5bff\u53f8\uff0c\u4ee5\u5907\u540e\u7528\n\n\u4f2a\u4ee3\u7801\u5982\u4e0b\n\n```\nstruct Sushi\n{\n  long long t,d;\n  bool operator<(const node &x) const\n    return d < x.d;\n} tmp;\n\npriority_queue<Sushi> q;\n\npriority_queue<Sushi, vector<Sushi>, greater<Sushi> > rev;\n\nwhile (input tmp)\n  q.push(tmp)\n\nfor i from 1 to k\n  rev.push(q.top())\n  q.pop()\n```\n\n2. \u5728\u5b58 $k$ \u4e2a\u5bff\u53f8\u7684\u540c\u65f6\uff0c\u8bb0\u5f55\u4e00\u4e0b\u76ee\u524d\u5bff\u53f8\u7684\u79cd\u7c7b\u548c\u603b\u6ee1\u8db3\n\n\u7531\u4e8e $1 \\leq t_i \\leq N$ \u6240\u4ee5\u8fd9\u91cc\u6211\u7528\u4e00\u4e2a $num$ \u6570\u7ec4\u6765\u8bb0\u5f55\u6bcf\u4e2d\u5bff\u53f8 $t$ \u7684\u6570\u91cf\uff0c\u7528\u4e00\u4e2a $cnt$ \u8bb0\u5f55\u603b\u7684\u5bff\u53f8\u79cd\u7c7b\u6570\uff0c\u7528 $sum$ \u8bb0\u5f55\u4e00\u4e0b\u603b\u6ee1\u8db3\n\n\u4f2a\u4ee3\u7801\u5982\u4e0b\n\n```\nwhile rev.push(q.top())\n\n    if num[q.top().t] == 0\n        cnt++\n\n    num[q.top().t]++\n    sum += q.top().d\n\n```\n\n3. \u8ba1\u7b97\u4e00\u4e0b\u5f53\u524d\u7684\u603b\u6ee1\u8db3\n\n\u8fd9\u91cc\u6211\u7528\u4e00\u4e2a $ans$ \u8bb0\u5f55\n\n\u4f2a\u4ee3\u7801\u5982\u4e0b\n\n```\nans = sum + cnt * cnt\n```\n\n4. \u5f00\u59cb\u5224\u65ad\u5bff\u53f8\u79cd\u7c7b\n\n\u9996\u5148\u4ec0\u4e48\u6837\u7684\u5bff\u53f8\u5bf9\u6211\u4eec\u7684\u7b54\u6848\u53ef\u80fd\u6709\u8d21\u732e\u5462\uff1f\n\n##### \u8fd9\u4e2a\u5bff\u53f8\u5e26\u6765\u7684 \u201c\u591a\u6837\u6027\u52a0\u6210\u201d \u7684\u6536\u76ca\u5927\u4e8e \u201c\u57fa\u7840\u7f8e\u5473\u7a0b\u5ea6\u603b\u548c\u201d \u7684\u635f\u5931\u3002\n\n\u6240\u4ee5\u6211\u4eec\u7684\u76ee\u6807\u5c31\u5f88\u660e\u786e\u4e86\u3002\n\n\u5bf9\u4e8e\u5e26\u4e0d\u6765 \u201c\u591a\u6837\u6027\u52a0\u6210\u201d \u7684\u5bff\u53f8\uff0c\u6211\u4eec\u76f4\u63a5\u6254\u6389\u3002\n\n\u5bf9\u4e8e\u5e26\u7684\u6765 \u201c\u591a\u6837\u6027\u52a0\u6210\u201d \u7684\u5bff\u53f8\uff0c\u6211\u4eec\u53bb\u627e\u5230\u73b0\u6709\u7684 $k$ \u4e2a\u5bff\u53f8\u4e2d **\u53bb\u6389\u4e0d\u4f1a\u5bf9\u73b0\u6709\u79cd\u7c7b\u9020\u6210\u5f71\u54cd\u4e14\u4ef7\u503c\u6700\u5c0f\u7684** \u5bff\u53f8\uff0c\u5c06\u4e24\u5bff\u53f8\u4ea4\u6362\u3002\n\n\u4f2a\u4ee3\u7801\u5982\u4e0b\n\n```\nwhile q.size() && rev.size()\n    if num[q.top().t] != 0 // \u5bff\u53f8\u6ca1\u6709\u5e26\u6765 \u201c\u591a\u6837\u6027\u52a0\u6210\u201d\uff0c\u4e0d\u80fd\u8981\uff0c\u53bb\u6389\n        q.pop()\n        continue\n    if num[rev.top().t] == 1 // \u53bb\u6389\u8be5\u5bff\u53f8\u4f1a\u5bf9\u73b0\u6709\u79cd\u7c7b\u9020\u6210\u5f71\u54cd\uff0c\u4e0d\u80fd\u53bb\uff0c\u627e\u5f53\u524d\u7684\u4e0b\u4e00\u4e2a\u5bff\u53f8\n        rev.pop()\n        continue\n// \u8fd9\u6837\u53ef\u4ee5\u627e\u5230\u7b26\u5408\u8981\u6c42\u7684\u4e24\u4e2a\u5bff\u53f8\u4ea4\u6362\n```\n\n\u627e\u5230\u4e86\u4ee5\u540e\uff0c\u6211\u4eec\u8fdb\u884c\u4ea4\u6362\uff0c\u8ba1\u7b97\u4ea4\u6362\u540e\u662f\u5426\u6ee1\u8db3\n\n>_\u8fd9\u4e2a\u5bff\u53f8\u5e26\u6765\u7684 \u201c\u591a\u6837\u6027\u52a0\u6210\u201d \u7684\u6536\u76ca\u5927\u4e8e \u201c\u57fa\u7840\u7f8e\u5473\u7a0b\u5ea6\u603b\u548c\u201d \u7684\u635f\u5931\u3002_\n\n\u4e14\u8ba1\u7b97\u65b0\u7684\u603b\u6ee1\u8db3\uff0c\u548c\u539f\u6765\u7684\u6bd4\u8f83\u3002\n\n\u4f2a\u4ee3\u7801\u5982\u4e0b\n\n```\n    num[rev.top().t] --\n    num[q.top().t] ++\n    cnt ++\n    sum -= rev.top().d\n    sum += q.top().d\n    ans = max (ans, sum + cnt * cnt)\n```\n\n\u6700\u7ec8\u627e\u5230\u6700\u5927\u7684\u603b\u6ee1\u8db3\uff0c\u5f97\u5230\u6b63\u89e3\u3002\n\n### AC Code\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nlong long n, k, ans, cnt, num[100005], sum;\n\nstruct node\n{\n    long long t, d;\n    bool operator<(const node &x) const\n    { return d < x.d; }\n    bool operator>(const node &x) const\n    { return d > x.d; }\n} tmp;\n\npriority_queue<node> q;\npriority_queue<node, vector<node>, greater<node>> rev;\n\nint main()\n{\n    scanf(\"%lld%lld\", &n, &k);\n    for (int i(1); i <= n; ++i)\n    {\n        scanf(\"%lld%lld\", &tmp.t, &tmp.d);\n        q.push(tmp);\n    }\n    for (int i(1); i <= k; ++i)\n    {\n        if (num[q.top().t]++ == 0)\n            cnt++;\n        sum += q.top().d;\n        rev.push(q.top());\n        q.pop();\n    }\n    ans = sum + cnt * cnt;\n    while (q.size() && rev.size())\n    {\n        if (num[q.top().t] != 0)\n        {\n            q.pop();\n            continue;\n        }\n        if (num[rev.top().t] == 1)\n        {\n            rev.pop();\n            continue;\n        }\n        num[rev.top().t]--;\n        num[q.top().t]++;\n        cnt++;\n        sum -= rev.top().d;\n        sum += q.top().d;\n        rev.pop();\n        q.pop();\n        ans = sum + cnt * cnt > ans ? sum + cnt * cnt : ans;\n    }\n    printf(\"%lld\\n\", ans);\n    return 0;\n}\n```\n",
        "postTime": 1606914299,
        "uid": 274993,
        "name": "Maxmilite",
        "ccfLevel": 6,
        "title": "\u9898\u89e3 AT4285 \u3010[ABC116D] Various Sushi\u3011"
    }
]
[
    {
        "content": "\u6ca1\u641c\u5230\u4e2d\u6587\u9898\u89e3\uff0c\u6545\u5199\u4e00\u53d1\u3002\u53ef\u80fd\u6bd4 std \u66f4\u52a0\u9ebb\u70e6\u3002\n\n[\u9898\u76ee\u4f20\u9001\u95e8](/problem/AT_arc050_d)\n\n#### \u524d\u7f6e\u77e5\u8bc6\uff1a\n\n\u540e\u7f00\u6570\u7ec4\u3002\n\n#### \u9898\u610f\uff1a\n\n- \u7ed9\u5b9a\u957f\u4e3a $n$ \u7684\u5b57\u7b26\u4e32 $S$\uff0c\u5c06\u6240\u6709 $S$ \u7684\u540e\u7f00\u6309\u4efb\u610f\u987a\u5e8f\u6392\u5217\uff0c\u5e76\u9996\u5c3e\u76f8\u8fde\uff0c\u5f62\u6210\u4e00\u4e2a\u65b0\u5b57\u7b26\u4e32 $T$\u3002\u6c42\u4f7f $T$ \u5b57\u5178\u5e8f\u6700\u5c0f\u7684\u6392\u5217\u65b9\u6848\u5e76\u8f93\u51fa\u3002\n- $n\\le10^5$\u3002\n\n#### \u5206\u6790\uff1a\n\n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u6211\u4eec\u8bb0\u5c06\u5b57\u7b26\u4e32 $A,B$ \u9996\u4f4d\u76f8\u63a5\u5f62\u6210\u7684\u65b0\u5b57\u7b26\u4e32\u4e3a $A+B$\uff1b\u7528 $nA$ \u6765\u8868\u793a\u5c06 $n$ \u4e2a $A$ \u9996\u5c3e\u76f8\u8fde\u5f62\u6210\u7684\u5b57\u7b26\u4e32\uff1b\u7528 $A\\le B$ \u6765\u8868\u793a $A$ \u7684\u5b57\u5178\u5e8f\u4e0d\u5927\u4e8e $B$\uff0c\u7528 $A>B$ \u8868\u793a $A$ \u7684\u5b57\u5178\u5e8f\u5927\u4e8e $B$\u3002\n\n\u8003\u8651\u66b4\u529b\u3002\u8bb0\u957f\u5ea6\u4e3a $i$ \u7684\u540e\u7f00\u4e3a $s_i$\uff08\u6ce8\u610f\uff0c\u4e0e\u9898\u9762\u7684\u8bb0\u53f7\u5e76\u4e0d\u76f8\u540c\uff01\uff09\uff0c\u5e76\u8bb0\u6700\u7ec8\u7684\u6392\u5217 $s_{p_1},s_{p_2},\\dots,s_{p_n}$\uff0c\u5219\u5bf9\u4e8e $\\forall i\\in[1,n)$\uff0c\u6709 $s_{p_i}+s_{p_{i+1}}\\le s_{p_{i+1}}+s_{p_i}$\u3002\u8bc1\u660e\u53ef\u4ee5\u8003\u8651\u5fae\u6270\uff0c\u5373\uff0c\u82e5\u5b58\u5728 $i$ \u4f7f\u5f97\u8be5\u5173\u7cfb\u4e0d\u6210\u7acb\uff0c\u5219\u6211\u4eec\u4ea4\u6362 $p_i,p_{i+1}$\uff0c\u5b57\u5178\u5e8f\u4e00\u5b9a\u4f1a\u53d8\u5c0f\uff0c\u4e0e\u6700\u7ec8\u7684\u6392\u5217\u6700\u4f18\u77db\u76fe\u3002\n\n\u5e76\u4e14\uff0c\u8be5\u5173\u7cfb\u5177\u6709\u4f20\u9012\u6027\uff0c\u5373 $A+B\\le B+A,\\,B+C\\le C+B\\Rightarrow A+C\\le C+A$\u3002\u4e0b\u9762\u7ed9\u51fa\u8bc1\u660e\u3002\u5982\u679c\u4f1a\u8bc1\u53ef\u4ee5\u8df3\u5230\u5206\u9694\u7ebf\u4e4b\u540e\u3002\n\n> \u5f15\u7406\uff1a$\\forall a\\in\\mathbb N^+,\\,A+B\\le B+A\\Leftrightarrow aA+B\\le B+aA$\u3002\n\n\u8003\u8651\u5f52\u7eb3\u3002\n\n\u5f53 $a=1$ \u65f6\uff0c\u4e24\u6761\u4ef6\u5b8c\u5168\u76f8\u540c\u3002\n\n\u5f53 $a>1$ \u65f6\uff0c\u82e5\u547d\u9898\u5bf9 $a-1$ \u4e0e $1$ \u6210\u7acb\uff0c\u5219\u6709\uff1a\n$$\nA+B\\le B+A\n\\Rightarrow\n\\begin{aligned}\n&aA+B\\\\\n=&A+(a-1)A+B\\\\\n\\le&A+B+(a-1)A\\\\\n\\le&B+A+(a-1)A\\\\\n=&B+aA\n\\end{aligned}\n$$\n\u540c\u7406\uff0c$A+B>B+A\\Rightarrow aA+B>B+aA$\u3002\u5373 $A+B\\le B+A\\Leftrightarrow aA+B\\le B+aA$\uff0c\u547d\u9898\u5f97\u8bc1\u3002\n\n\u540c\u7406\uff0c\u8fd8\u6709 $\\forall b\\in\\mathbb Z^+,\\,A+B\\le B+A\\Leftrightarrow A+bB\\le bB+A$\u3002\u5373 $\\forall a,b\\in\\mathbb Z^+,\\,A+B\\le B+A\\Leftrightarrow aA+bB\\le bB+aA$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u653e\u7f29\u9002\u5f53\u7684\u500d\u6570\u4f7f\u5f97 $A,B$ \u957f\u5ea6\u76f8\u7b49\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u6bd4\u8f83\u5927\u5c0f\u3002\u5177\u4f53\u5730\uff0c\u6709\uff1a\n$$\n\\begin{aligned}\n&A+B\\le B+A\\\\\n\\Rightarrow&|B||C|A+|A||C|B\\le|A||C|B+|B||C|A\\\\\n\\Rightarrow&|B||C|A\\le|A||C|B\\\\\n&B+C\\le C+B\\\\\n\\Rightarrow&|A||C|B\\le|A||B|C\\\\\n&|B||C|A\\le |A||C|B\\le|A||B|C\\\\\n\\Rightarrow&|B||C|A+|A||B|C\\le|A||B|C+|B||C|A\\\\\n\\Rightarrow&A+C\\le C+A\n\\end{aligned}\n$$\n\n---\n\n\u4f20\u9012\u6027\u8868\u660e\u5bf9\u6700\u7ec8\u7684\u6392\u5217\uff0c$\\forall i<j$\uff0c$s_{p_i}+s_{p_j}\\le s_{p_j}+s_{p_i}$\u3002\u6545\u53ef\u4ee5\u6309\u7167\u8fd9\u4e2a\u987a\u5e8f\u6392\u5e8f\uff0c\u5f97\u5230\u7684\u4e32\u5c31\u662f\u7b54\u6848\u3002\n\n\u73b0\u5728\u8003\u8651\u5bf9\u4e8e\u4e24\u4e2a\u540e\u7f00 $s_i,s_j\\ (i<j)$\uff0c\u5982\u4f55\u6bd4\u8f83 $s_i+s_j$ \u4e0e $s_j+s_i$\u3002\u53ef\u4ee5\u5148\u6c42\u51fa $s_i$ \u4e0e $s_j$ \u7684 LCP\uff0c\u82e5 LCP \u957f\u5ea6 $<i$\uff0c\u5219\u76f4\u63a5\u6bd4\u8f83 LCP \u7684\u540e\u4e00\u4e2a\u5b57\u7b26\u5373\u53ef\uff1b\u5426\u5219\uff0c\u5219\u9700\u8981\u6bd4\u8f83 $s_i+s_j$ \u7684\u540e $j$ \u4f4d\u5b57\u7b26\u4e0e $s_j+s_i$ \u7684\u540e $j$ \u4f4d\u5b57\u7b26\uff0c\u5373 $s_j$ \u4e0e $s_{j-i}+s_i$\u3002\u540c\u7406\uff0c\u518d\u6c42\u51fa $s_j$ \u4e0e $s_{j-i}$ \u7684 LCP\uff0c\u82e5\u957f\u5ea6 $<j-i$ \u76f4\u63a5\u6bd4\u8f83\uff0c\u5426\u5219\u6bd4\u8f83\u4e24\u8005\u7684\u540e $i$ \u4f4d\uff0c\u5373 $s_i$ \u4e0e $s_i$\uff0c\u65e0\u9700\u6bd4\u8f83\u4e86\u3002\n\n\u7528 SA+ST \u8868\u6c42 LCP\uff0c\u4e00\u6b21\u6bd4\u8f83 $\\mathcal O(1)$\uff0c\u590d\u6742\u5ea6 $\\mathcal O(n\\log n)$\u3002\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i, l, r) for(int i=l, _=r; i<=_; ++i)\nusing namespace std;\ntypedef long long ll;\n\nconst int mN=1e5+9, mD=18;\n\nint n, ans[mN];\nchar s[mN];\n\nint sa[mN], rk[mN*2], lcp[mN], lg[mN], st[mN][mD];\nvoid init_sa(char *s, int n) {\n\tstatic int ork, oldrk[mN*2], id[mN], buc[mN];\n\tauto cmp=[](int i, int j, int w) {\n\t\treturn oldrk[i]==oldrk[j] && oldrk[i+w]==oldrk[j+w];\n\t};\n\trep(i, 1, n) ++buc[rk[i]=s[i]^96];\n\trep(i, 1, ork=26) buc[i]+=buc[i-1];\n\trep(i, 1, n) sa[buc[rk[i]]--]=i;\n\tfor(int w=1, m; w<n; w<<=1) {\n\t\trep(i, 1, m=w) id[i]=n-i+1;\n\t\trep(i, 1, n) if(sa[i]>w) id[++m]=sa[i]-w;\n\n\t\tmemset(buc, 0, (ork+1)*4);\n\t\trep(i, 1, n) ++buc[rk[i]];\n\t\trep(i, 1, ork) buc[i]+=buc[i-1];\n\t\tfor(int i=n; i>=1; --i) sa[buc[rk[id[i]]]--]=id[i];\n\n\t\tork=0, memcpy(oldrk, rk, sizeof oldrk);\n\t\trep(i, 1, n) rk[sa[i]]=ork+=!cmp(sa[i], sa[i-1], w);\n\t}\n\trep(i, 1, n) {\n\t\tint &j=lcp[rk[i]]=max(lcp[rk[i-1]]-1, 0);\n\t\twhile(s[i+j]==s[sa[rk[i]+1]+j]) ++j;\n\t}\n\tlg[0]=-1;\n\trep(i, 1, n) lg[i]=lg[i>>1]+1;\n\trep(i, 1, n) st[i][0]=lcp[i];\n\trep(d, 1, lg[n]) rep(i, 1, n-(1<<d)+1) {\n\t\tst[i][d]=min(st[i][d-1], st[i+(1<<d-1)][d-1]);\n\t}\n}\ninline int cal_lcp(int i, int j) {\n\ti=rk[i], j=rk[j];\n\tif(i>j) swap(i, j);\n\tint d=lg[j-i];\n\treturn min(st[i][d], st[j-(1<<d)][d]);\n}\ninline int cmp_suf(int i, int j) { \n\tconst int lcp=cal_lcp(n-i+1, n-j+1);\n\tif(lcp==i || lcp==j) return 0;\t//\u8fd4\u56de 0 \u8868\u793a\u4e24\u4e32\u76f8\u7b49\n\treturn s[n-i+1+lcp]-s[n-j+1+lcp];\t//\u8fd4\u56de\u6b63\u6570\u8868\u793a si>sj\uff0c\u8d1f\u6570\u8868\u793a si<sj \n}\ninline bool cmp(int i, int j) {\n\tint res=cmp_suf(i, j);\n\tif(res) return res<0;\n\tif(i<j) return cmp_suf(j, j-i)<0;\n\telse return cmp_suf(i-j, i)<0;\n}\n\n\nint main() {\n\n\tscanf(\"%d\\n%s\", &n, s+1);\n\tinit_sa(s, n);\n\trep(i, 1, n) ans[i]=i;\n\tsort(ans+1, ans+n+1, cmp);\n\trep(i, 1, n) {\n\t\tprintf(\"%d\\n\", n-ans[i]+1);\n\t}\n\treturn 0;\n}\n```",
        "postTime": 1668496509,
        "uid": 364963,
        "name": "\u963f\u4e11",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 [ARC050D] Suffix Concat"
    }
]
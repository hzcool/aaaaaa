[
    {
        "content": "### \u9898\u610f\n\u6709 $n$ \u4e2a\u70b9\uff0c\u7b2c $i$ \u4e2a\u70b9\u7684\u6a2a\u7eb5\u5750\u6807\u4e3a $(x_i,y_i)$\u3002\u6bcf\u4e00\u6b65\u53ef\u4ee5\u5411\u4e0a/\u4e0b/\u5de6/\u53f3\u8d70\u4e00\u6b65\u3002\u8bbe $f(i)$ \u4e3a\u4ece\u539f\u70b9\u5f00\u59cb\u8d70 $T$ \u6b65\u521a\u597d\u80fd\u5230\u8fbe $(x_i,y_i)$ \u7684\u65b9\u6848\u6570\uff0c\u6c42 $\\prod_{i=1}^n f(i)\\bmod mod$\u3002$1\\le mod\\le 10^9+7;n,T\\le 10^5;|x_i|,|y_i|\\le 10^6$\u3002\n### \u89e3\u6cd5\n\u5982\u679c\u8003\u8651\u5728 $x/y$ \u8f74\u65b9\u5411\u6b63\u5411/\u53cd\u5411\u8d70\u4e86\u591a\u5c11\u6b65\u7684\u60c5\u51b5\uff0c\u5219\u548c\u5f0f\u96be\u4ee5\u5316\u7b80\u3002\uff08\u867d\u7136\u4e5f\u53ef\u4ee5\u63a8\u51fa\u6b63\u786e\u7684\u7ed3\u8bba\uff09\n\n\u8003\u8651\u5c06\u6574\u4e2a\u5750\u6807\u7cfb\u9006\u65f6\u9488\u65cb\u8f6c 45 \u5ea6\uff0c\u5c06\u67d0\u4e2a\u70b9 $(x,y)$ \u5bf9\u5e94\u5230\u65b0\u5750\u6807\u7cfb\u4e0a\u7684 $(y+x,y-x)$\uff0c\u5219\u5728\u539f\u56fe\u4e0a\u5411\u5de6/\u4e0a/\u53f3/\u4e0b\u8d70\u4e00\u6b65\u5bf9\u5e94\u4e86\u5728\u65b0\u7684\u5750\u6807\u7cfb\u4e0a\u5411\u5de6\u4e0a/\u53f3\u4e0a/\u53f3\u4e0b/\u5de6\u4e0b\u8d70\u4e00\u6b65\uff0c\u65b0\u7684\u5750\u6807\u7cfb\u4e0a\u6bcf\u6b21\u53ef\u4ee5\u4ece\u67d0\u4e2a\u70b9 $(x,y)$ \u8d70\u5230 $(x\\pm 1,y\\pm 1)$ \u7684\u4f4d\u7f6e\u3002\u6b64\u65f6\u6bcf\u8d70\u4e00\u6b65\u5bf9\u6a2a\u7eb5\u5750\u6807\u7684\u8d21\u732e\u4e92\u4e0d\u5f71\u54cd\uff0c\u6240\u4ee5\u53ef\u4ee5\u628a\u6a2a\u7eb5\u5750\u6807\u7684\u53d8\u5316\u5206\u522b\u72ec\u7acb\u51fa\u6765\u770b\uff0c\u5219\u8d70 $T$ \u6b65\u5230\u65b0\u5750\u6807\u7cfb\u4e0a\u7684\u70b9 $(X,Y)$ \uff08\u4ee4 $X,Y\\ge 0$\uff09\u7684\u65b9\u6848\u6570\u4e3a $\\binom{T}{\\frac{T-X}2}\\binom{T}{\\frac{T-Y}2}$\u3002\n\n![](https://cdn.luogu.com.cn/upload/image_hosting/c4cegtkd.png)\n\n\u6ce8\u610f\u6a21\u6570\u4e0d\u4e00\u5b9a\u4e3a\u8d28\u6570\uff0c\u8003\u8651\u5c06\u6700\u540e\u7684\u7b54\u6848\u5199\u6210 $\\prod_{i=2}i^{c_i}$ \u7684\u5f62\u5f0f\uff0c\u5219\u4e0a\u9762\u7684\u7ec4\u5408\u6570\u53ef\u4ee5\u62c6\u6210\u67d0\u4e2a\u9636\u4e58\u9664\u4ee5\u67d0\u4e2a\u9636\u4e58\u7684\u5f62\u5f0f\uff0c\u4e58/\u9664\u67d0\u4e2a\u9636\u4e58\u7b49\u6548\u4e8e\u5bf9 $c$ \u524d\u7f00\u52a0/\u524d\u7f00\u51cf\uff0c\u6700\u540e\u5904\u7406\u6574\u4e2a\u7b54\u6848\u65f6\u5c06\u6bcf\u4e2a $i$ \u5206\u89e3\u8d28\u56e0\u6570\u4ee5\u5feb\u901f\u8ba1\u7b97 $\\prod i^{c_i}$\u3002\n### \u4ee3\u7801\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int maxn=1000010;\nint n,m,i,j,t,x,y,u,w,a=1;\nint v[maxn],p[maxn],d[maxn];\nlong long pw[maxn];\ninline int Pow(int d,long long z){\n\tint r=1;\n\tdo{\n\t\tif(z&1) r=(1LL*r*d)%m;\n\t\td=(1LL*d*d)%m;\n\t}while(z>>=1);\n\treturn r;\n} \nint main(){\n\tfor(i=2;i<maxn;++i){\n\t\tif(!v[i]) v[i]=p[++t]=i; \n\t\tfor(j=1;j<=t;++j){\n\t\t\tu=p[j];\n\t\t\tif(v[i]<u||i*u>=maxn) break;\n\t\t\tv[i*u]=u;\n\t\t}\n\t} \n\tscanf(\"%d%d%d\",&n,&t,&m);\n\twhile(n--){\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tu=x+y; w=x-y;\n\t\tif(u<0) u=-u;\n\t\tif(w<0) w=-w;\n\t\tif(u<w) swap(u,w); \n\t\tif(t<u||(u^t)&1){\n\t\t\tprintf(\"0\\n\");\n\t\t\treturn 0;\n\t\t}\n\t\tx=(t-u)>>1; y=(t-w)>>1;\n\t\td[t]+=2; --d[x]; --d[y];\n\t\t--d[t-x]; --d[t-y];\n\t}\n\tx=0;\n\tfor(i=maxn-1;i;--i){\n\t\tif(!(x+=d[i])) continue;\n\t\tfor(u=i;u!=1;){\n\t\t\tw=v[u]; y=0;\n\t\t\twhile(v[u]==w) ++y,u/=w;\n\t\t\tpw[w]+=1LL*y*x;\n\t\t}\n\t}\n\tfor(i=2;i<maxn;++i){\n\t\tif(!(u=pw[i])) continue;\n\t\ta=(1LL*a*Pow(i,u))%m;\n\t}\n\tprintf(\"%d\\n\",a);\n\treturn 0;\n}\n```",
        "postTime": 1673743293,
        "uid": 546086,
        "name": "Francais_Drake",
        "ccfLevel": 7,
        "title": "ARC012D \u9898\u89e3"
    }
]
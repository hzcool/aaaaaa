[
    {
        "content": "\u4e00\u4e2a\u66b4\u529b\u7684\u63a8\u6cd5\uff08\n\n\u9996\u5148\u6709\u4e00\u4e2a\u663e\u7136\u7684 dp\uff1a\u8bb0 $f_{i,j}$ \u8868\u793a\u548c\u4e3a $i$\uff0c\u6700\u540e\u4e00\u4e2a\u9009\u7684\u6570\u662f $j$ \u7684\u6240\u6709\u5e8f\u5217\u957f\u5ea6\u548c\uff0c$g_{i,j}$ \u8868\u793a\u548c\u4e3a $i$\uff0c\u6700\u540e\u4e00\u4e2a\u9009\u7684\u6570\u662f $j$ \u7684\u5e8f\u5217\u4e2a\u6570\u3002\n\n\u90a3\u4e48\u6709\u8f6c\u79fb\uff1a$f_{i,j}=\\sum f_{i-j,k}+g_{i-j,k},g_{i,j}=\\sum g_{i-j,k}$\uff0c\u7b54\u6848\u5373\u4e3a $\\sum f_{n,i}$\u3002\n\n\u9996\u5148\u8003\u8651\u5feb\u901f\u8ba1\u7b97 $g$\uff0c\u8bb0 $G_j(x)=\\sum g_{i,j}x^i,S(x)=1+\\sum G_j(x)$\u3002\n\n\u90a3\u4e48\u6839\u636e\u8f6c\u79fb\u5f0f\u6709 $G_j(x)=x^j\\sum_{k\\not=j} G_k(x)=x^j(S(x)-G_j(x))$\uff0c\u79fb\u9879\u53ef\u5f97 $G_j(x)=\\frac{x^j}{1+x^j}S(x)$\u3002\n\n\u8003\u8651\u628a\u6240\u6709 $j=1\\dots n$ \u7684\u5f0f\u5b50\u52a0\u8d77\u6765\uff0c\u53ef\u5f97 $S(x)=1+S(x)\\sum\\frac{x^i}{1+x^i}\\Leftrightarrow S(x)=\\frac 1{1-\\sum\\frac {x^i}{1+x^i}}$\u3002\n\n\u7531\u4e8e $\\frac{x^i}{1+x^i}=-\\sum (-x^i)^j$\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528 $\\mathcal O(n\\ln n)$ \u7684\u65f6\u95f4\u66b4\u529b\u5904\u7406\u51fa $1-\\sum\\frac{x^i}{1+x^i}$\uff0c\u4e4b\u540e\u591a\u9879\u5f0f\u6c42\u9006\u5373\u53ef\u6c42\u51fa $S(x)$\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u8ba1\u7b97 $f$\uff0c\u8bb0 $F_j(x)=\\sum f_{i,j}x^i,T(x)=\\sum F_j(x)$\u3002\n\n\u540c\u6837\u6839\u636e\u8f6c\u79fb\u5f0f\u6709 $F_j(x)=x^j\\sum_{k\\not=j}(F_k(x)+G_k(x))=x^j(S(x)+T(x)-F_j(x)-G_j(x))$\uff0c\u79fb\u9879\u53ef\u5f97 $F_j(x)=\\frac{x^j}{1+x^j}(S(x)+T(x)-G_j(x))$\u3002\n\n\u628a $G_j(x)=\\frac{x^j}{1+x^j}S(x)$ \u5e26\u5165\u4e0a\u5f0f\uff0c\u6709 $F_j(x)=\\frac{x^j}{1+x^j}(\\frac1{1+x^j}S(x)+T(x))$\u3002\n\n\u628a\u6240\u6709 $j=1\\dots n$ \u7684\u5f0f\u5b50\u52a0\u8d77\u6765\uff0c\u53ef\u5f97 $T(x)=T(x)\\sum\\frac{x^i}{1+x^i}+S(x)\\sum\\frac{x^i}{(1+x^i)^2}$\uff0c\u5316\u7b80\u53ef\u5f97 $T(x)=S^2(x)\\sum\\frac{x^i}{(1+x^i)^2}$\u3002\n\n\u8bb0 $z=x^i$\uff0c\u5219 $\\frac{x^i}{(1+x^i)^2}=z(\\sum(-z)^i)^2$\uff0c\u4e8e\u662f\u53ef\u4ee5\u5148\u9884\u5904\u7406\u51fa $(\\sum(-z)^i)^2$ \u4e4b\u540e\u5c31\u53ef\u4ee5\u7528 $\\mathcal O(n\\ln n)$ \u7684\u65f6\u95f4\u66b4\u529b\u5904\u7406\u51fa $\\sum\\frac{x^i}{(1+x^i)^2}$ \u4e86\u3002\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u76f4\u63a5\u5377\u79ef\u5f97\u5230 $T(x)$\uff0c\u6700\u540e\u7b54\u6848\u5373\u4e3a $[x^n]T(x)$\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(n\\log n)$\u3002",
        "postTime": 1681049217,
        "uid": 65681,
        "name": "UltiMadow",
        "ccfLevel": 7,
        "title": "[\u9898\u89e3] ABC297Ex"
    },
    {
        "content": "~~\u636e\u8bf4\u73b0\u5728\u53d1\u9898\u89e3\u79d2\u8fc7\uff0c\u90a3\u6211\u6765\u6c34\u7bc7\u9898\u89e3~~\n\n\u9898\u76ee\u4e00\u773c\u770b\u4e0a\u53bb\u5c31\u5f88\u751f\u6210\u51fd\u6570\u3002\u5148\u4e0d\u7ba1\u957f\u5ea6\u603b\u548c\uff0c\u5148\u8003\u8651\u6c42\u65b9\u6848\u6570\u3002\u8fd9\u4e2a\u9650\u5236\u770b\u8d77\u6765\u5c31\u5f88\u5bb9\u65a5\uff0c\u6211\u4eec\u94a6\u5b9a\u591a\u5c11\u5bf9\u6570\u76f8\u7b49\uff0c\u5176\u5b83\u4efb\u610f\u586b\u3002\u90a3\u4e48\u7b54\u6848\u7684\u751f\u6210\u51fd\u6570\u5c31\u662f\uff1a\n\n$$F(x) = \\frac{1}{1 - G(x)}, G(x) = \\sum_{i=1}^{\\infty} \\frac{x^i}{1 + x^i}$$\n\n\u4e0a\u8ff0\u5f0f\u5b50\u5c31\u662f\u5c06\u94a6\u5b9a\u76f8\u7b49\u7684\u8fde\u7eed\u6bb5\u5408\u8d77\u6765\u8ba1\u7b97\uff0c\u5bb9\u65a5\u7cfb\u6570\u4e3a $(-1)^{j - 1}$\u3002\n\n\u8003\u8651\u957f\u5ea6\u3002\u6c42 $\\sum i f_i$ \u5f88\u81ea\u7136\u80fd\u60f3\u5230\u591a\u9879\u5f0f\u6c42\u5bfc\uff0c\u90a3\u4e48\u6211\u4eec\u5f15\u5165\u7b2c\u4e8c\u4e2a\u5143 $y$ \u4e3a\u5e8f\u5217\u957f\u5ea6\uff0c\u90a3\u4e48\u4e0a\u5f0f\u5b50\u6539\u5199\u4e3a\uff1a\n\n$$F(x, y) = \\frac{1}{1 - G(x, y)}, G(x, y) = \\sum_{i=1}^{\\infty} \\frac{x^iy}{1 + x^iy}$$\n\n\u5bf9 $y$ \u6c42\u5bfc\uff0c\u53ef\u5f97\uff1a\n\n$$\\frac{\\partial}{\\partial y}F(x, y) = \\frac{\\frac{\\partial}{\\partial y} (G(x, y) - 1)}{(1-G(x, y))^2}, \\frac{\\partial}{\\partial y} G(x, y) = \\sum_{i=1}^{\\infty} \\frac{x^i}{(1 + x^iy)^2}$$\n\n\u6211\u4eec\u4e0d\u5173\u5fc3 $y$\uff0c\u6240\u4ee5\u76f4\u63a5\u5e26\u5165 $y=1$\uff0c\u90a3\u4e48\u6700\u540e\u6211\u4eec\u8981\u6c42\u7684\u7b54\u6848 $H(x)$ \u5c31\u662f\uff1a\n\n$$H(x) = \\frac{\\displaystyle \\sum_{i=1}^{\\infty} \\frac{x^{i}}{(1+x^i)^2}}{\\left(1-\\displaystyle \\sum_{i=1}^{\\infty} \\frac{x^i}{1+x^i}\\right)^2}$$\n\n\u5206\u5b50\u5206\u6bcd\u90fd\u53ef\u4ee5\u66b4\u529b\u62c6\u5f00\u8ba1\u7b97\uff08\u8c03\u548c\u7ea7\u6570\uff0c\u5171 $O(n \\log n)$ \u9879\uff09\uff0c\u4e8e\u662f\u518d\u52a0\u4e0a\u591a\u9879\u5f0f\u6c42\u9006\u5c31\u505a\u5b8c\u4e86\u3002\n\n```cpp\nint main() {\n    scanf(\"%d\", &n);\n    f.set(n), g.set(n);\n    for (int i = 1; i <= n; i++) {\n        for (int j = 1; i * j <= n; j++) {\n            f[i * j] = (f[i * j] + ((j & 1) ? 1ll : P - 1ll) * j) % P;\n            g[i * j] = (g[i * j] + ((j & 1) ? 1ll : P - 1ll)) % P;\n        }\n    }\n    h = f * ((g * (-1) + 1) * (g * (-1) + 1)).inv(n + 1);\n    printf(\"%d\\n\", h[n]);\n    return 0;\n}\n```",
        "postTime": 1681802424,
        "uid": 279652,
        "name": "APJifengc",
        "ccfLevel": 9,
        "title": "\u300c\u89e3\u9898\u62a5\u544a\u300dABC297Ex Diff Adjacent"
    }
]
[
    {
        "content": "\u57fa\u672c\u7b97\u5bb9\u65a5\u677f\u5b50\u3002\n\n## \u601d\u8def\n\n\u4ee4 $f(i)$ \u4e3a\u94a6\u5b9a $i$ \u4e2a\u8fde\u7eed\u7684 `rg` \u5176\u4f59\u968f\u4fbf\u9009\u7684\u65b9\u6848\u6570\uff0c\u6211\u4eec\u7684\u76ee\u6807\u662f\u6b63\u597d $k$ \u4e2a\u7684\u65b9\u6848\u3002\n\n\u9996\u5148\u4e0d\u96be\u53d1\u73b0 $f(i)$ \u53ef\u4ee5\u5148\u4ece $n$ \u4e2a\u4f4d\u7f6e\u4e2d\u9009\u51fa $i$ \u7ec4\u653e `rg`\uff0c\u7136\u540e\u518d\u9009\u62e9 $r-i,g-i$ \u4e2a\u653e `r` \u548c `g` \u5373\u53ef\uff0c\u6bd4\u8f83\u5bb9\u6613\u8ba1\u7b97\uff0c\u7b54\u6848\u4e3a $\\binom{n-i}{i}\\times\\binom{n-i\\times 2}{r-i}\\times \\binom{n-i-r}{g-i}$\u3002\n\n\u7136\u540e\u663e\u7136\u6b63\u597d $k$ \u7684\u65b9\u6848\u53ef\u4ee5\u4f7f\u7528\u4e8c\u9879\u5f0f\u53cd\u6f14\u5f97\u5230\uff0c\u5373\u4ee4 $g(i)$ \u4e3a\u6b63\u597d $i$ \u4e2a\u7684\u65b9\u6848\uff0c$g(i)=\\sum_{j=i}^nf(j)\\times \\binom{j}{i}\\times (-1)^{j-i}$\u3002\n\n\u6c42 $g(k)$ \u5c31\u53ef\u4ee5\u5728 $\\Theta(n)$ \u65f6\u95f4\u590d\u6742\u5ea6\u5185\u8ba1\u7b97\u3002\n\n## \u4ee3\u7801\n\n```cpp\n#include <bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int mod=998244353;\nint qp(int a,int b){\n\tint ans=1;\n\twhile(b){\n\t\tif(b&1) ans=(ans*a)%mod;\n\t\ta=(a*a)%mod;\n\t\tb>>=1;\n\t}\n\treturn ans;\n}\nint fac[10000005],inv[10000005];\nvoid init(){\n\tfac[0]=1;\n\tfor(int i=1;i<=10000000;i++) fac[i]=fac[i-1]*i%mod;\n\tinv[10000000]=qp(fac[10000000],mod-2);\n\tfor(int i=9999999;i>=0;i--) inv[i]=inv[i+1]*(i+1)%mod;\n}\nint C(int i,int j){\n\tif(i<0||j<0||i<j) return 0;\n\treturn fac[i]*inv[i-j]%mod*inv[j]%mod;\n}\nint ans[10000005];\nsigned main(){\n\tinit();\n\tint r,g,b,k;\n\tcin>>r>>g>>b>>k;\n\tint n=r+g+b;\n\tfor(int i=0;i<=min(r,g);i++){\n\t\tans[i]=C(n-i,i)*C(n-i*2,r-i)%mod*C(n-i-r,g-i)%mod;\n\t}\n\tint tot=0;\n\tfor(int i=k;i<=min(r,g);i++){\n\t\tif((i-k)%2==0){\n\t\t\ttot=(tot+ans[i]*C(i,k))%mod;\n\t\t}\n\t\telse{\n\t\t\ttot=(tot+mod-ans[i]*C(i,k)%mod)%mod;\n\t\t}\n\t}\n\tcout<<tot;\n\treturn 0;\n} \n```",
        "postTime": 1660802802,
        "uid": 116664,
        "name": "Daniel_lele",
        "ccfLevel": 8,
        "title": "ABC266G \u9898\u89e3"
    },
    {
        "content": "\u9898\u89e3\u5168\u662f\u53cd\u6f14\uff1f\u6211\u6765\u4e00\u53d1\u7ec4\u5408\u610f\u4e49\u7684\u9898\u89e3\u5427\u3002\n\n\u9996\u5148\u6211\u4eec\u8003\u8651\u628a $\\texttt{rg}$ \u7b97\u6210\u5b57\u7b26 $\\texttt{\\#}$\u3002\n\n\u9898\u9762\u5373\u53d8\u4e3a\uff1a**\u6c42 $R - k$ \u4e2a $\\texttt{r}$\uff0c$G-k$ \u4e2a $\\texttt{g}$\uff0c$B$ \u4e2a $\\texttt{b}$\uff0c$k$ \u4e2a $\\texttt{\\#}$ \u7ec4\u6210\u4e0d\u542b $\\texttt{rg}$ \u7684\u5e8f\u5217\u7684\u65b9\u6848\u6570\u3002**\n\n\u6b64\u65f6\uff0c\u6211\u4eec\u5148\u628a $\\texttt{g},\\texttt{b}$ \u548c $\\texttt{\\#}$ \u6392\u597d\uff0c\u65b9\u6848\u5373\u4e3a $C_{G-k +B+k}^{G-k} \\times C_{B+k}^k$\u3002\n\n\u518d\u8003\u8651\u628a $R-k$ \u4e2a $\\texttt{r}$ \u52a0\u5165\uff0c\u6b64\u65f6\u4e0d\u80fd\u5c06 $\\texttt{r}$ \u653e\u5728 $\\texttt{g}$ \u524d\u9762\uff0c\u6240\u4ee5\u8fd9\u4e00\u6b65\u6709 $C_{R-k+B+k}^{R-k}$ \u79cd\u65b9\u6848\u3002\n\n\u6545\u5171\u6709 $C_{G+B}^{G-k} \\times C_{B+k}^k \\times C_{R+B}^{R-k}$ \u79cd\u65b9\u6848\u3002\n\n\u8d34\u4e00\u4e0b\u4ee3\u7801\uff08\u672c\u4eba\u5728\u5b9e\u73b0\u4e2d\u5148\u5c06 $R$ \u548c $G$ \u51cf\u53bb\u4e86 $k$ \uff0c\u4f46\u5316\u7b80\u540e\u4e0e\u6587\u5b57\u53d9\u8ff0\u4e2d\u7684\u5f0f\u5b50\u76f8\u540c\uff09\uff1a\n```cpp\n#include<bits/stdc++.h>\n#define int long long\n#define mod 998244353\nusing namespace std;\nint a,b,c,d,ans;\nint ksm(int x,int y)\n{\n\tint ret=1;\n\twhile(y)\n\t{\n\t\tif(y%2) ret*=x,ret%=mod;\n\t\tx*=x,x%=mod,y/=2;\n\t}\n\treturn ret;\n}\nint C(int n,int m)\n{\n\tif(m>n/2) m=n-m;\n\tif(m==0) return 1;\n\tint ret=1;\n\tfor(int i=n;i>=n-m+1;i--)\n\t\tret*=i,ret%=mod;\n\tfor(int j=1;j<=m;j++)\n\t\tret*=ksm(j,mod-2),ret%=mod;\n\treturn ret;\n}\nsigned main()\n{\n\tscanf(\"%lld%lld%lld%lld\",&a,&b,&c,&d);\n\ta-=d,b-=d;\n\tans=C(c+d+b,b)*C(d+c,d)%mod*C(c+d+a,a)%mod;\n\tprintf(\"%lld\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1678710553,
        "uid": 516369,
        "name": "\u542c\u53d6T\u58f0\u4e00\u7247",
        "ccfLevel": 0,
        "title": "[ABC266G] Yet Another RGB Sequence\u9898\u89e3"
    },
    {
        "content": "## ABC266G\n\n*2045\n\n\n### \u9898\u610f\n\n\u7ed9\u4f60\u56db\u4e2a\u6574\u6570 $R,G,B,K$\u3002\n\n\u4f60\u9700\u8981\u6c42\u51fa\u6709\u591a\u5c11\u4e2a\u7531 `R`\uff0c`G`\uff0c`B` \u7ec4\u6210\u7684\u5b57\u7b26\u4e32\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a\n\n1. `R`\uff0c`G`\uff0c`B` \u7684\u4e2a\u6570\u6070\u597d\u5206\u522b\u4e3a $R,G,B$\u3002\n\n2. \u5b50\u4e32 `RG` \u7684\u51fa\u73b0\u6b21\u6570\u6070\u597d\u4e3a $K$\u3002\n\n\u7b54\u6848\u5bf9 $998244353$ \u53d6\u6a21\u3002\n\n$R,G,B \\le 10^6,K \\le \\min(R,G)$\n\n\n### \u9898\u89e3\n\n\u770b\u5230 \u201c\u51fa\u73b0\u6b21\u6570\u6070\u597d\u4e3a $K$\u201d\uff0c\u8003\u8651\u4e8c\u9879\u5f0f\u53cd\u6f14\u3002\n\n\u8bbe $f(x)$ \u8868\u793a\u201c\u94a6\u5b9a\u5b50\u4e32 `RG` \u51fa\u73b0\u4e86 $x$ \u6b21\u7684\u65b9\u6848\u6570\u201d\uff0c$g(x)$ \u8868\u793a\u201c\u6070\u597d\u5b50\u4e32 `RG` \u51fa\u73b0\u4e86 $x$ \u6b21\u7684\u65b9\u6848\u6570\u201d\u3002\n\n\u90a3\u4e48 $f(x)$ \u662f\u5f88\u597d\u8ba1\u7b97\u7684\uff0c\u5c06 `RG` \u770b\u505a\u7b2c\u56db\u4e2a\u5b57\u7b26\u7136\u540e\u8ba1\u7b97\u6392\u5217\u6700\u540e\u5bf9\u56db\u4e2a\u5b57\u7b26\u6d88\u5e8f\u5373\u53ef\u3002\n\n\u5373\uff1a\u8bbe $n=R+G+B$ \uff0c\u5219\n$$\nf(x)=\\frac{n!}{x!\\ \u00b7 \\ (R-x)!\\ \u00b7\\ (G-x)!\\ \u00b7 \\ B!}\n$$\n\u7136\u800c $g(x)$ \u5c31\u4e0d\u90a3\u4e48\u4fbf\u4e8e\u76f4\u63a5\u8ba1\u7b97\u4e86\uff0c\u9700\u8981\u901a\u8fc7 $f(x)$ \u8ba1\u7b97\u3002\n\n\u9996\u5148\u8003\u8651 $f,g$ \u7684\u5173\u7cfb\u3002\n\n\u7531\u4e8e\u4e00\u4e2a\u662f \u201c\u94a6\u5b9a\uff08\u81f3\u5c11\uff09\u201d\uff0c\u4e00\u4e2a\u662f \u201c\u6070\u597d\u201d\uff0c\u6240\u4ee5\u5bf9\u4e8e\u4efb\u610f\u7684 $n \\le i$\uff0c$g(i)$ \u5728 $f(n)$ \u4e2d\u88ab\u8ba1\u7b97\u4e86 $\\binom{i}{n}$ \u6b21\u3002\n\n\u4e5f\u5c31\u662f $f(x)=\\sum_{i=x}^{lim}\\binom{i}{x}g(i)$\uff0c\u5176\u4e2d $lim=\\min(R,G)$\u3002\n\n\u8fd0\u7528 [\u4e8c\u9879\u5f0f\u53cd\u6f14](https://www.cnblogs.com/GXZlegend/p/11407185.html) \u7684\u5e38\u7528\u5f62\u5f0f\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n\n\uff08\u2191\u4e0a\u9762\u8fd9\u4e2a\u535a\u5ba2\u8bb2\u5f97\u8d85\u7ea7\u597d\u8bf6\uff0c\u771f\u7684\u4e0d\u53bb\u770b\u770b\u561b\uff09\n$$\ng(x)=\\sum_{i=x}^{lim}(-1)^{i-x}\\binom{i}{n}f(i)\n$$\n\u7528\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u53ef\u4ee5\u8ba1\u7b97\u51fa $g(k)$ \u4e5f\u5c31\u662f\u7b54\u6848\u5566~\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u53ef\u4ee5\u505a\u5230 $O(N)$\uff0c\u6211\u7684\u4ee3\u7801\u5728\u9884\u5904\u7406\u73af\u8282\u6ca1\u6709\u9009\u62e9\u7ebf\u6027\u505a\uff0c\u6240\u4ee5\u662f $O(N \\log V)$ \u7684\uff0c\u5176\u4e2d $V$ \u4e3a\u6a21\u6570\u3002\n\n### \u4ee3\u7801\n\n```cpp\nconst ll maxn=3e6+5,mod=998244353;\nll ksm(ll x,ll k){ll res=1;for(;k;k>>=1,x=x*x%mod)if(k&1)res=res*x%mod;return res;}\nll a,b,c,k;\nll fac[maxn],inv[maxn];\nll n;\nll C(ll x,ll y){return fac[x]*inv[y]%mod*inv[x-y]%mod;}\nvoid init(){\n\tn=a+b+c;\n\tfac[0]=inv[0]=1;\n\tfor(ll i=1;i<=n;i++){\n\t\tfac[i]=fac[i-1]*i%mod;\n\t\tinv[i]=ksm(fac[i],mod-2);\n\t}\n}\nll f[maxn],g[maxn];\nvoid solve(){\n\ta=R,b=R,c=R,k=R;\n\tinit();\n\tll lim=min(a,b);\n\tfor(ll i=k;i<=lim;i++){\n\t\tf[i]=fac[n-i]*inv[i]%mod*inv[a-i]%mod*inv[b-i]%mod*inv[c]%mod;\n\t}\n\tll ans=0;\n\tfor(ll i=k;i<=lim;i++){\n\t\tans=(ans+((i-k)%2==1?mod-1:1)*C(i,k)%mod*f[i]%mod)%mod;\n\t}\n\twe(ans);\n\treturn ;\n}\n```\n\n",
        "postTime": 1668563522,
        "uid": 93707,
        "name": "Rnfmabj",
        "ccfLevel": 7,
        "title": "[ABC266G] Yet Another RGB Sequence"
    },
    {
        "content": "**\u8fd9\u91cc\u662f uid=443664 \u7684\u5c0f\u53f7\uff0c\u5979\u60f3\u4fdd\u6301\u6a59\u4f46\u60f3\u4e3a\u8fd9\u9898\u5199\u9898\u89e3\uff0c\u6709\u95ee\u9898\u8bf7\u76f4\u63a5\u627e\u5927\u53f7\u8054\u7cfb\u3002**\n\n\u80fd\u8bc4\u5230\u7a7a\u5fc3\u9ec4\u662f\u4e0d\u662f\u53ea\u662f\u56e0\u4e3a\u4f4d\u7f6e\u539f\u56e0\u554a\u3002\n\n\u771f\u5fc3\u53ea\u6709 *1800 \u5de6\u53f3\u7f62\u3002\n\n--------\n\n\u9898\u610f\uff1a\u5bf9\u6ee1\u8db3\u4ee5\u4e0b\u8981\u6c42\u7684\u5e8f\u5217\u8ba1\u6570\uff1a\n-  \u7531 `R`,`G`,`B` \u7ec4\u6210\uff0c\u5176\u4e2d\u6070 $R$ \u4e2a `R`\uff0c$G$ \u4e2a `G`\uff0c$B$ \u4e2a `B`\u3002\n- \u8fde\u7eed\u7684 `RG` \u4f5c\u4e3a\u5b50\u4e32\u6070\u51fa\u73b0 $K$ \u6b21\u201d \u3002\n- \u819c $998244353$ \u8f93\u51fa\u3002\n\n--------------\n\n\u8fd9\u91cc\u7684\u8fde\u7eed `RG` \u597d\u7a81\u5140\u554a\uff0c\u80fd\u4e0d\u80fd\u76f4\u63a5\u679a\u4e3e\uff1f\n\n\u4f46\u662f\u6070\u597d\u600e\u4e48\u505a\uff0c\u53cd\u6f14\u8fd8\u662f\u5bb9\u65a5\uff1f\n\n\u5148\u60f3\u60f3\u94a6\u5b9a $k$ \u4e2a `RG` \u600e\u4e48\u505a\u7f62\uff1a\u628a `RG` \u548c `B` \u5206\u522b\u770b\u6210\u5206\u9694\u7b26\uff0c\u7136\u540e\u8bd5\u7740\u5f80\u91cc\u63d2\u5269\u4f59 `R`\uff0c`G`\u3002\n\n\u4ee4 $n=R-K,m=G-K,k=C+K$\uff0c\u5219\u6211\u4eec\u8981\u7edf\u8ba1 $n$ \u4e2a `R` $m$ \u4e2a `G` \u5206\u6210 $k+1$ \u6bb5\u7684\u65b9\u6848\u6570\u3002\u65e0\u91cd\u590d\u81ea\u7136\u6700\u597d\uff0c\u6709\u91cd\u590d\u518d\u60f3\u65b9\u6cd5\u3002\n\n\u4e0d\u80fd\u5f62\u6210\u8fde\u7eed `RG`\uff0c\u4e00\u4e2a\u88ab\u5206\u9694\u7b26\u5206\u9694\u7684\u533a\u95f4\u5fc5\u987b\u662f\u524d\u9762\u4e00\u6bb5 `R` \u8fde\u540e\u9762\u4e00\u6bb5 `G` \u7684\u5f62\u5f0f\u3002\n\n\u90a3\u4e48\uff0c\u53ea\u8981\u77e5\u9053\u4e00\u4e2a\u533a\u95f4\u5185 `R` \u548c `G` \u7684\u4e2a\u6570\uff0c\u5c31\u80fd\u552f\u4e00\u786e\u5b9a\u533a\u95f4\u7684\u6392\u5217\u65b9\u5f0f\u3002\n\n\u5bf9 `R` \u548c `G` \u5206\u522b\u8ba1\u7b97\uff0c\u8fd9\u4e0d\u5c31\u662f\u4e00\u4e2a\u5c0f\u7ec4\u5408\u95ee\u9898\u3002\n\n\u8fd9\u65f6\u770b\u56de\u8981\u6c42\uff0c\u5f00\u5934\u7684 `R` \u663e\u7136\u4e0d\u4f1a\u53c2\u4e0e\u4e0e\u5206\u9694\u7b26\u51d1\u6210 `RG`\uff0c\u7b49\u7b49\u7ed3\u5c3e\u7684 `G` \u597d\u50cf\u4e5f\u4e0d\u4f1a\uff1f\n\n\u6bcf\u4e2a\u7b26\u5408\u8981\u6c42\u7684\u5e8f\u5217\u5ffd\u7565\u5206\u9694\u7b26\u6392\u5217\u540e\u90fd\u80fd\u552f\u4e00\u5bf9\u5e94\u5230 `R` \u548c `G` \u5206\u914d\u5230\u4e0d\u540c\u533a\u95f4\u7684\u4e2a\u6570\uff0c\u800c\u540e\u8005\u4e00\u5b9a\u5408\u6cd5\uff0c\u90a3\u4e48\u524d\u540e\u4e00\u4e00\u5bf9\u5e94\uff0c\u76f4\u63a5\u8ba1\u4e0d\u5c31\u5b8c\u4e86\uff01\n\n\u5206\u9694\u7b26\u6709 $\\binom{k}{C}$ \u79cd\u6392\u6cd5\uff0c`R` \u6709 $\\binom{n+k}{k}$ \u79cd\u6392\u6cd5\uff0c`G` \u6709 $\\binom{m+k}{k}$ \u79cd\u6392\u6cd5\uff0c\u4e58\u4e00\u8d77\u5c31\u662f\u7b54\u6848\u3002\n\n\u4ee3\u7801\u4e0d\u7ed9\u4e86\uff0c\u5f88\u597d\u5199\u3002\u6ce8\u610f\u7ec4\u5408\u6570\u9884\u5904\u7406\u8981\u5904\u7406\u4e24\u500d\u6570\u636e\u8303\u56f4\u3002\n\n\u4e8b\u5b9e\u4e0a\uff0c\u524d\u9762\u90a3\u53e5\u201c\u5148\u60f3\u60f3\u94a6\u5b9a $k$ \u4e2a `RG` \u600e\u4e48\u505a\u201d\u7684\u7f18\u7531\u662f\u6211\u5f00\u59cb\u5f80\u4e8c\u9879\u5f0f\u53cd\u6f14\u60f3\u4e86\u4e00\u6bb5\u3002",
        "postTime": 1666785791,
        "uid": 649485,
        "name": "purple_vine",
        "ccfLevel": 0,
        "title": "abc266G \u9898\u89e3"
    }
]
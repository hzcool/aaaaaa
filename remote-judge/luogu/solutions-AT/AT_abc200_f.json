[
    {
        "content": "## \u9898\u610f\u7b80\u8ff0\uff1a\n\n\u7ed9\u5b9a\u4e00\u4e2a\u5b57\u7b26\u4e32 $S$ ($ 1\\ \\le\\ |S|\\ \\le\\ 10^5 $)\uff0c $S$ \u4ec5\u5305\u542b $0$ , $1$ , $?$\u3002\u5c06\u8be5\u5b57\u7b26\u4e32\u590d\u5236 $K$ ($ 1\\ \\le\\ |K|\\ \\le\\ 10^9 $) \u904d\uff0c\u5f97\u5230\u5b57\u7b26\u4e32 $S'$\uff0c$S'$ \u4e2d\u7684 $?$ \u53ef\u968f\u610f\u66ff\u6362\u6210 $0$ \u6216 $1$\uff0c\u5bf9\u4e8e $S'$ \u53ef\u80fd\u5f97\u5230\u7684\u6bcf\u4e00\u79cd\u60c5\u51b5\uff0c\u6c42\u89e3\u5b50\u95ee\u9898\uff1a\n\n>\u7ed9\u5b9a $01$ \u4e32\uff0c\u6bcf\u6b21\u64cd\u4f5c\u53ef\u4efb\u9009\u4e00\u4e2a\u533a\u95f4\u5e76\u5bf9\u5176\u8fdb\u884c $01$ \u53cd\u8f6c\uff08$0$ \u53d8 $1$,$1$ \u53d8 $0$\uff09\uff0c\u95ee\u628a\u8be5 $01$ \u4e32\u6240\u6709\u5143\u7d20\u5747\u53d8\u4e3a $0$ \u6216 $1$ \u7684\u6700\u5c0f\u64cd\u4f5c\u6b21\u6570\u3002\n\n\u8f93\u51fa\u5b50\u95ee\u9898\u7b54\u6848\u548c\u3002\n\n## Hint\uff1a\n\n\u9996\u5148\u8003\u8651 $K=1$\uff0c\u4e14\u5b57\u7b26\u4e32\u4e2d\u6ca1\u6709 $?$ \u7684\u60c5\u51b5\uff0c\u4e5f\u5c31\u662f\u5148\u8003\u8651\u5b50\u95ee\u9898\u3002\n\n\u8003\u8651\u64cd\u4f5c\u7b56\u7565\uff0c\u7531\u4e8e\u6700\u7ec8\u76ee\u6807\u662f\u628a\u6240\u6709\u5143\u7d20\u5747\u53d8\u4e3a $0$ \u6216 $1$\uff0c\u6240\u4ee5\u4e00\u6b21\u64cd\u4f5c\u5e94\u5c3d\u91cf\u51cf\u5c11 $01$ \u6bb5\u7684\u6570\u91cf\u3002\u5982\u679c\u6bcf\u6b21\u64cd\u4f5c\u7684\u533a\u95f4\u5305\u542b\u7684\u5e76\u4e0d\u90fd\u662f $0$ \u6216 $1$ \u7684\u6574\u6bb5\uff0c\u6bd4\u5982\uff1a\n\n>01101100\n\n>\u64cd\u4f5c\u533a\u95f4\uff1a$[3, 7]$\n\n>01010010\n\n\u90a3\u4e48\u64cd\u4f5c\u5b8c\u6210\u540e $01$ \u6bb5\u7684\u6570\u91cf\u4f1a\u53d8\u591a\uff0c\u6240\u4ee5\u64cd\u4f5c\u533a\u95f4\u8986\u76d6\u7684\u4e00\u5b9a\u662f\u5b8c\u6574\u7684 $01$ \u6bb5\u3002\u7136\u540e\u6211\u4eec\u53d1\u73b0\u6bcf\u6b21\u8fd9\u6837\u7684\u64cd\u4f5c\u6700\u591a\u80fd\u51cf\u5c11 $2$ \u4e2a $01$ \u6bb5\uff0c\u8bbe\u521d\u59cb\u5171\u6709 $\\text{x}$ \u4e2a $01$ \u6bb5\uff0c\u90a3\u4e48\u6700\u5c11\u64cd\u4f5c\u6b21\u6570\u4e3a $\\left \\lfloor \\frac{x}{2}  \\right \\rfloor$\u3002\n\n## Solution\uff1a\n\n\u7136\u540e\u8003\u8651\u5982\u679c $K=1$\uff0c\u4e14\u5b57\u7b26\u4e32\u4e2d\u6709 $?$ \u7684\u60c5\u51b5\u3002\n\n\u663e\u7136\u8fd9\u4e2a\u95ee\u9898\u53ef\u4ee5\u901a\u8fc7 $\\text{dp}$ \u6c42\u89e3\u3002\u8bbe $dp_{i,0/1,0/1}$ \u8868\u793a\u8003\u8651\u5230\u7b2c $i$ \u4e2a\u4f4d\u7f6e\uff0c\u7b2c $1$ \u4e2a\u4f4d\u7f6e\u4e3a $0/1$\uff0c\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u4e3a $0/1$ \u7684**\u603b\u7b54\u6848**\u3002\u8bbe $cnt_i$ \u8868\u793a\u786e\u5b9a\u7b2c $1$ \u4e2a\u548c\u7b2c $i$ \u4e2a\u4f4d\u7f6e\u540e\uff0c\u4e0b\u6807\u5c0f\u4e8e\u7b49\u4e8e $i$ \u7684\u524d\u7f00\u5b57\u7b26\u4e32\u7684\u5408\u6cd5\u6570\u91cf\u3002\u5f97\u5230\u5982\u4e0b\u8f6c\u79fb\uff1a\n\n$$\n\\begin{aligned}\n&dp_{i,0,0}=dp_{i-1,0,0}+dp_{i-1,0,1}\\\\\n&dp_{i,0,1}=dp_{i-1,0,0}+dp_{i-1,0,1}+cnt_{i-1}\\times [S_{1}\\ne 1]\\times [S_{i-1}\\ne 1]\\\\\n&dp_{i,1,0}=dp_{i-1,1,1}+dp_{i-1,1,0}+cnt_{i-1}\\times [S_{1}\\ne 0]\\times [S_{i-1}\\ne 0]\\\\\n&dp_{i,1,1}=dp_{i-1,1,1}+dp_{i-1,1,0}\\\\\n\\end{aligned}\n$$\n\n\u6ce8\u610f\u5982\u679c $dp_{i,j,k}$ \u4e0d\u5408\u6cd5\uff0c\u90a3\u4e48 $dp_{i,j,k}=0$\u3002\n\n\u6700\u540e\u8003\u8651 $K\\ne1$ \u7684\u60c5\u51b5\uff0c\u8003\u8651\u4f7f\u7528\u77e9\u9635\u4e58\u6cd5\u4f18\u5316\u4e0a\u9762\u7684 $\\text{dp}$\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(5^3\\cdot(n + \\log K))$\u3002\n\n\u6700\u540e\u7684\u6700\u540e\uff0c\u5f53 $|S|=1$ \u65f6\u8981\u7279\u5224\u3002 ",
        "postTime": 1679315735,
        "uid": 271096,
        "name": "Semorius",
        "ccfLevel": 7,
        "title": "[ABC200F] Minflip Summation"
    },
    {
        "content": "# [ABC200F  Minflip Summation](https://www.luogu.com.cn/problem/AT_abc200_f)\n\u51e0\u5929\u524d VP \u4e86\u8fd9\u573a ABC \u5e76\u7ed9\u540e\u56db\u9053\u9898\u8d21\u4e86[\u7ffb\u8bd1](https://www.luogu.com.cn/paste/u6wq1sma)\u3002\u5982\u60a8\u53d1\u73b0\u7ffb\u8bd1\u4e2d\u6709\u7455\u75b5\u6216\u6709\u7406\u89e3\u969c\u788d\uff0c\u6b22\u8fce\u79c1\u4fe1\u6211\u6216\u7ba1\u7406\u83b7\u5f97\u51c6\u786e\u610f\u601d\u5e76\u4fee\u6539\u3002  \n\u6240\u4ee5\u9898\u610f\u5c31\u4e0d\u518d\u653e\u4e86\u3002\n\n## \u9898\u76ee\u5206\u6790  \n\u6211\u4eec\u628a `0` \u548c `1` \u770b\u6210\u989c\u8272\u3002  \n\u9996\u5148\u4e0d\u7ba1\u662f\u624b\u6a21\u6837\u4f8b\u8fd8\u662f\u7406\u6027\u63a8\u5bfc\u90fd\u80fd\u53d1\u73b0\u4e00\u4e2a\u5173\u952e\u7ed3\u8bba\uff1a\u5bf9\u4e8e\u4e00\u4e2a\u5b57\u7b26\u4e32 $S$\uff0c\u5c06\u5176\u989c\u8272\u7edf\u4e00\u6240\u9700\u7684\u6700\u5c0f\u64cd\u4f5c\u6570\u5373\u4e3a\u989c\u8272\u6bb5\u7684\u4e2a\u6570\u9664\u4ee5 $2$ \u4e0b\u53d6\u6574\u3002\u8bbe\u4e0d\u540c\u989c\u8272\u6bb5\u7684\u8fb9\u754c\u6570\u4e3a $b$\uff0c\u4e0a\u9762\u7684\u7ed3\u679c\u540c\u6837\u53ef\u4ee5\u7528 $\\lceil \\frac{b}{2} \\rceil$ \u6765\u8868\u793a\u3002\n\n\u57fa\u4e8e\u989c\u8272\u6bb5\u7684\u6570\u91cf\u611f\u6027\u8bc1\u660e\u4e00\u4e0b\uff1a\u53ef\u4ee5\u8003\u8651\u6bcf\u6b21\u9009\u53d6\u5904\u4e8e\u5f53\u524d\u672a\u5904\u7406\u4e32\u7684\u5de6\u53f3\u4e24\u4e2a\u7aef\u70b9\uff0c\u5c06\u5176\u7ffb\u8f6c\u540e\u989c\u8272\u6bb5\u6570\u4f1a\u51cf\u5c11 $2$\u3002\u8fd9\u4e0e\u6bcf\u9022\u4e00\u4e2a\u989c\u8272\u6bb5\u5c31\u505a\u4e00\u6b21\u7ffb\u8f6c\u64cd\u4f5c\u662f\u540c\u4e00\u4e2a\u6548\u679c\u3002\n```\n10000110000110000001   \u989c\u8272\u6bb5\u6570\u4e3a 7\n11111001111001111111   \u7ffb\u8f6c [2, 19]\n11111110000111111111   \u7ffb\u8f6c [6, 13]\n11111111111111111111   \u7ffb\u8f6c [8, 11]\n```\n\u76f8\u5bf9\u4e8e\u989c\u8272\u6bb5\u6570\uff0c\u8fb9\u754c\u6570\u66f4\u5bb9\u6613\u8ba8\u8bba\u3002\u6545\u6211\u4eec\u4e4b\u540e\u53ea\u8ba8\u8bba\u989c\u8272\u6bb5\u8fb9\u754c\u76f8\u5173\u5185\u5bb9\u3002  \n\u4e0a\u53d6\u6574\u7684\u95ee\u9898\u7559\u5230\u6700\u540e\u3002\uff08\u867d\u7136\u8c8c\u4f3c\u7559\u7740\u8fd9\u4e2a\u95ee\u9898\u540e\u60a3\u5f88\u5927\uff09\n\n\u5148\u6765\u8003\u8651\u95ee\u53f7\u5982\u4f55\u5904\u7406\u3002\u7531\u4e8e\u9898\u76ee\u4e2d\u8981\u6c42\u6211\u4eec\u6c42\u51fa\u6240\u6709\u53ef\u80fd\u7684\u4e32\u7684\u548c\uff0c\u6211\u4eec\u53ef\u4ee5\u4eff\u7167\u8ba1\u7b97\u671f\u671b\u7684\u65b9\u5f0f\uff0c\u5c06 `?` \u7684\u8d21\u732e\u8bbe\u7f6e\u597d\uff0c\u6c42\u51fa\u5355\u4e2a\u4e32\u7684\u8d21\u732e\u540e\u4e58\u4ee5 $2^{Kq}$ \u7edf\u4e00\u8ba1\u7b97\u3002  \n\u4e3a\u4e86\u65b9\u4fbf\uff0c\u63a5\u4e0b\u6765\u7684\u8ba1\u7b97\u4e2d $\\frac {1}{2}$ \u5747\u4f7f\u7528 $2$ \u5728\u6a21 $10 ^ 9 + 7$ \u610f\u4e49\u4e0b\u7684\u9006\u5143 $inv$ \u4ee3\u66ff\u3002\n\n\u6b64\u65f6\u989c\u8272\u6bb5\u8fb9\u754c\u6570\u5df2\u7ecf\u53ef\u4ee5\u8f7b\u677e\u7b97\u51fa\u3002\u8003\u8651\u524d\u540e\u4e24\u4e2a\u5b57\u7b26\uff0c\u8bb0 $calc(S_i,S_j)$ \u8868\u793a\u8fd9\u4e24\u4e2a\u4f4d\u7f6e\u7684\u5b57\u7b26\u5bf9\u8fb9\u754c\u6570\u505a\u51fa\u7684\u8d21\u732e\uff1a\n\n$$\ncalc(S_i, S_j) = \\begin{cases}\n  1 & S_i = S_j \\\\\n  0 & S_i \\not= S_j \\\\\n  inv & S_i = \\space \\texttt? \\space \\lor \\space S_j = \\space \\texttt?\n\\end{cases}\n$$\n\uff08\u4e3a\u4e86\u6e05\u6670\u548c\u7f8e\u89c2\u6539\u6210\u4e86\u4e0a\u9762\u7684\u6837\u5b50\u3002\u7b2c\u4e09\u79cd\u60c5\u51b5\u4e2d\uff0c\u7531\u4e8e `?` \u5373\u53ef\u586b `0` \u53c8\u53ef\u586b `1`\uff0c\u56e0\u6b64\u53ea\u8981\u5de6\u53f3\u81f3\u5c11\u6709\u4e00\u4e2a\u5b57\u7b26\u4e3a `?`\uff0c\u5176\u90fd\u4f1a\u5bf9\u7ed3\u679c\u505a\u51fa $\\frac{1}{2}$ \u7684\u8d21\u732e\u3002\uff09\n\n\u7136\u540e\u518d\u8003\u8651\u5982\u4f55\u8ba1\u7b97\u62fc\u63a5\u8d77\u6765\u7684 $T$ \u7684\u603b\u8d21\u732e\u3002  \n\u8bb0 $n=|S|$\u3002  \n\u663e\u7136\u6bcf\u4e2a $S$ \u5185\u7684\u8d21\u732e\u76f8\u540c\uff0c\u4f46\u76f8\u90bb\u4e24\u4e2a $S$ \u4e4b\u95f4\u9700\u8981\u5904\u7406\u3002\u8fd9\u7b49\u4ef7\u4e8e\u7d2f\u52a0 $(K-1) \\cdot calc(S_1,S_n)$ \u5230\u8d21\u732e\u4e4b\u4e2d\u3002\n\n\u4e8e\u662f\u6211\u4eec\u7edf\u8ba1\u51fa\u4e86\u6240\u6709\u8fb9\u754c\u7684\u4e2a\u6570\u3002\u73b0\u5728\u6211\u4eec\u4e89\u53d6\u5e72\u6389\u90a3\u4e2a\u4e0a\u53d6\u6574\u3002  \n\u53ea\u9700\u8981\u8ba9\u5076\u6570\u4e0d\u53d8\uff0c\u5947\u6570\u53d8\u4e3a\u5076\u6570\uff0c\u5c31\u53ef\u4ee5\u76f4\u63a5\u4e58\u4e0a\u9006\u5143\u800c\u4e0d\u7528\u62c5\u5fc3\u8fd9\u4e2a\u95ee\u9898\u4e86\u3002  \n\u90a3\u5982\u4f55\u53ea\u5bf9\u8fb9\u754c\u6570\u4e3a\u5947\u6570\u7684\u60c5\u51b5\u589e\u52a0\u8d21\u732e\u5462\uff1f  \n\u8003\u8651\u4e0b\u9762\u4e24\u4e2a\u4e32\uff1a\n```\n101010  b = 5\n1010101 b = 4\n```\n\u7b2c\u4e00\u4e2a\u4e32\u8fb9\u754c\u6570\u4e3a\u5947\u6570\uff0c\u9996\u5c3e\u989c\u8272\u4e0d\u540c\uff1b  \n\u7b2c\u4e8c\u4e2a\u8fb9\u754c\u6570\u4e3a\u5076\u6570\uff0c\u9996\u5c3e\u989c\u8272\u76f8\u540c\u3002  \n\u6839\u636e\u201c\u53ea\u6709\u9996\u5c3e\u989c\u8272\u4e0d\u540c\u7684\u4e32\u8fb9\u754c\u6570\u4e3a\u5947\u6570\u201d\u8fd9\u4e2a\u6027\u8d28\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728\u6700\u7ec8\u8d21\u732e\u4e2d\u518d\u7d2f\u52a0\u4e0a $calc(S_1, S_n)$\uff0c\u4e8e\u662f\u6211\u4eec\u7684\u76ee\u7684\u5c31\u8fbe\u5230\u4e86\u3002\n\n\u540c\u65f6\uff0c\u8fd9\u6837\u64cd\u4f5c\u8fd8\u6709\u4e00\u4e2a\u597d\u5904\uff1a\u6ce8\u610f\u5230 $calc(S_1, S_n)$ \u6700\u7ec8\u540c\u6837\u4e5f\u88ab\u8ba1\u7b97\u4e86 $K$ \u6b21\uff0c\u53ef\u4ee5\u4e0e $S$ \u5185\u90e8\u7684\u8d21\u732e\u7edf\u4e00\u8ba1\u7b97\u3002  \n\u6545\u6700\u540e\u7684\u7b54\u6848\u4e3a $inv \\cdot 2^{Kq} \\cdot K \\cdot \\displaystyle \\sum_{i=1}^{n} calc(S_i, S_{i\\%n+1})$\u3002  \n\n\u53e6\u5916\uff0c\u4f7f\u7528\u6b64\u79cd\u89e3\u6cd5\u9700\u6ce8\u610f\u5bf9 $|S| = 1$ \u7684\u7279\u5224\u3002\n\n\u6700\u540e\u4e0b\u53d6\u6574\u5904\u7684\u8f6c\u5316\u53c2\u8003\u4e86[\u8fd9\u7bc7\u9898\u89e3](https://atcoder.jp/contests/abc200/editorial/1248)\u7684\u601d\u8def\u3002\n\n## Code\n```cpp\n#include <cstdio>\n#include <cctype>\n#include <cstring>\nusing namespace std;\n\ninline int read()\n{\n\tint x = 0; char c;\n\twhile(!isdigit(c = getchar()));\n\tdo{\n\t\tx = (x << 1) + (x << 3) + (c ^ 48);\n\t}while(isdigit(c = getchar()));\n\treturn x;\n}\n\nint top = 0, stk[20];\ninline void write(int x)\n{\n\tdo{\n\t\tstk[++top] = x % 10;\n\t\tx /= 10;\n\t}while(x);\n\tfor(register int i = top; i; --i)\n\t\tputchar(stk[i] | 48);\n\tputchar('\\n'); top = 0;\n\treturn ;\n}\n\nchar s[100010];\nconst int mod = 1e9 + 7;\nconst int inv = 5e8 + 4;\nint n, k, q, ans = 0;\n\ninline int qpow(int a, long long b)\n{\n\tint res = 1;\n\tfor(register long long i = b; i; i >>= 1)\n\t{\n\t\tif(i & 1) res = (long long)res * a % mod;\n\t\ta = (long long)a * a % mod;\n\t}\n\treturn res;\n}\n\ninline int calc(int i, int j)\n{\n\tif(s[i] == '?' || s[j] == '?') return inv;\n\treturn s[i] != s[j];\n}\n\nint main()\n{\n\tscanf(\"%s\", s + 1);\n\tk = read(); n = strlen(s + 1);\n\tif(n == 1 && (k == 1 || s[1] != '?')) return write(0), 0;\n\tfor(register int i = 1; i <= n; ++i)\n\t\tq += s[i] == '?';\n\tq = (long long)qpow(2, (long long)k * q) * k % mod;\n\tfor(register int i = 1; i < n; ++i)\n\t\tans = (long long)(ans + calc(i, i + 1)) % mod;\n\tans = (long long)(ans + calc(1, n)) % mod;\n\twrite((long long)ans * q % mod * inv % mod);\n\treturn 0;\n}\n```",
        "postTime": 1669030337,
        "uid": 632868,
        "name": "Clover_BY",
        "ccfLevel": 0,
        "title": "ABC200F  Minflip Summation"
    },
    {
        "content": "\u663e\u7136\u7684\u7b56\u7565\uff1a\u9009\u62e9\u5168\u90e8 $0$ \u6bb5\u53d8\u6210 $1$\uff0c\u6216\u9009\u62e9\u5168\u90e8 $1$ \u6bb5\u53d8\u6210 $0$\u3002\n\n\u5f52\u7eb3\u53ef\u5f97\u4e00\u822c\u6027\u7684\u7ed3\u8bba\uff1a\u8bbe\u5b57\u7b26\u4e32\u4e2d $s_i \\ne s_{i+1}$ \u7684\u4f4d\u7f6e\u6570\u4e3a $k$\uff0c\u7b54\u6848\u4e3a $\\left\\lceil\\frac{k}{2}\\right\\rceil$\u3002\n\n\u56e0\u4e3a\u5728\u6a21\u610f\u4e49\u4e0b\u4e0d\u80fd\u4e0a\u53d6\u6574\uff0c\u8003\u8651\u8bb0 $k$ \u7684\u5947\u5076\u6027\uff08\u8fd9\u6837\u7edf\u8ba1\u7b54\u6848\u7684\u65f6\u5019\u5c31\u77e5\u9053\u7b54\u6848\u662f $\\frac{k}{2}$ \u8fd8\u662f $\\frac{k+1}{2}$\uff09\uff0c\u7136\u540e dp\u3002\u8bbe $f_{i,0/1,0/1}$ \u4e3a\u524d $i$ \u4e2a\u5b57\u7b26\u4e2d\uff0c$k$ \u7684\u5947\u5076\u6027\uff0c$s_i$ \u586b\u7684\u6570\uff0c$k$ \u7684\u603b\u548c\u3002\u7c7b\u4f3c\u5730\u8bbe $g_{i,0/1,0/1}$ \u8868\u793a\u65b9\u6848\u6570\u3002\u8f6c\u79fb\u662f trivial \u7684\u3002\n\n\u56e0\u4e3a $K \\le 10^9$\uff0c\u8003\u8651\u628a\u8f6c\u79fb\u5199\u6210 $8 \\times 8$ \u7684\u77e9\u9635\u4e58\u6cd5\u5f62\u5f0f\uff0c\u9884\u5904\u7406\u7b2c\u4e00\u4e2a copy \u7684 dp \u503c\uff0c\u505a\u4e00\u904d\u77e9\u9635\u5feb\u901f\u5e42\u5c31\u884c\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(8^3 (n + \\log K))$\u3002\n\n[code](https://atcoder.jp/contests/abc200/submissions/41472734)",
        "postTime": 1684300220,
        "uid": 275273,
        "name": "zltqwq",
        "ccfLevel": 0,
        "title": "ABC200F \u9898\u89e3"
    }
]
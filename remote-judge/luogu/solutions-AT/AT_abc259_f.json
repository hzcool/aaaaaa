[
    {
        "content": "[\u66f4\u597d\u7684\u9605\u8bfb\u4f53\u9a8c](https://www.cnblogs.com/dd-d/p/16823696.html)\n## Sol  \n\u8003\u8651 dp\u3002  \n\u8bb0 $dp_{u,0/1}$ \u8868\u793a $u$ \u70b9\u662f\u5426\u5411\u4e0a\u8fde\u8fb9\u7684\u6700\u5927\u503c\u3002  \n\u8f6c\u79fb\u7684\u8bdd\u76f8\u5f53\u4e8e\u662f\u627e\u82e5\u5e72\u4e2a $dp_{v,1}+w(u,v)$ \u8fdb\u884c\u8f6c\u79fb\u3002  \n\u5176\u4e2d $w(u,v)$ \u8868\u793a $(u,v)$ \u8fd9\u6761\u8fb9\u7684\u6743\u503c\u3002  \n\u90a3\u4e48\u6bcf\u6b21\u5f00\u4e2a vector \u628a $dp_{v,1}+w(u,v)$ \u5b58\u4e0b\u6765\u7136\u540e\u6392\u4e2a\u5e8f\uff0c\u627e\u6700\u5927\u7684 $d_u$ \u4e2a\u8282\u70b9\u5373\u53ef\u3002  \n\u65f6\u95f4\u590d\u6742\u5ea6 $O(n \\log n)$\u3002  \n## Code  \n```cpp\n//LYC_music yyds!\n#include<bits/stdc++.h>\n#define IOS ios::sync_with_stdio(0)\n#define lowbit(x) (x&(-x))\n#define int long long\nusing namespace std;\ninline char gc()\n{\n\tstatic char buf[1000000],*p1=buf,*p2=buf;\n\treturn p1==p2&&(p2=(p1=buf)+fread(buf,1,1000000,stdin),p1==p2)?EOF:*p1++;\n}\nint read()\n{\n\tint pos=1,num=0;\n\tchar ch=getchar();\n\twhile (!isdigit(ch))\n\t{\n\t\tif (ch=='-') pos=-1;\n\t\tch=getchar();\n\t}\n\twhile (isdigit(ch))\n\t{\n\t\tnum=num*10+(int)(ch-'0');\n\t\tch=getchar();\n\t}\n\treturn pos*num;\n}\nvoid write(int x)\n{\n\tif (x<0)\n\t{\n\t\tputchar('-');\n\t\twrite(-x);\n\t\treturn;\n\t}\n\tif (x>=10) write(x/10);\n\tputchar(x%10+'0');\n}\nvoid writesp(int x)\n{\n\twrite(x);\n\tputchar(' ');\n}\nvoid writeln(int x)\n{\n\twrite(x);\n\tputchar('\\n');\n}\nconst int N=3e5+10;\nvector<pair<int,int> > G[N];\nint n,a[N],dp[N][2];\nvoid dfs(int u,int fa)\n{\n\tint s=0; vector<int> g;\n\tfor (auto [v,w]:G[u])\n\t{\n\t\tif (v==fa) continue;\n\t\tdfs(v,u); s+=dp[v][0];\n\t\tg.emplace_back(dp[v][1]-dp[v][0]+w);\n\t}\n\tsort(g.begin(),g.end(),greater<int>());\n\tfor (int i=0;i<min((int)g.size(),a[u]-1);i++)\n\t\ts+=max(0ll,g[i]);\n\tdp[u][0]=s+(g.size()>a[u]-1?max(0ll,g[a[u]-1]):0);\n\tif (!a[u]) dp[u][1]=-0x3f3f3f3f3f3f3f3f;\n\telse dp[u][1]=s;\n}\nsigned main()\n{\n\tn=read();\n\tfor (int i=1;i<=n;i++)\n\t\ta[i]=read();\n\tfor (int i=1;i<n;i++)\n\t{\n\t\tint u=read(),v=read(),w=read();\n\t\tG[u].emplace_back(v,w); G[v].emplace_back(u,w);\n\t}\n\tdfs(1,0);\n\twriteln(max(dp[1][0],dp[1][1]));\n}\n\n\n\n\n\n```",
        "postTime": 1666654020,
        "uid": 167999,
        "name": "dd_d",
        "ccfLevel": 6,
        "title": "\u3010\u9898\u89e3\u3011ABC259F Select Edges"
    }
]
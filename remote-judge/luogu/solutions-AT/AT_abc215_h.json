[
    {
        "content": "\u4e0d\u96be\u7684\u9898\u3002\r\n\r\n---\r\n\r\n\u8003\u8651\u80fd\u5339\u914d\u7684\u6761\u4ef6\uff0c\u6709\u970d\u5c14\u5b9a\u7406\u3002\u8bbe $A_S$ \u4e3a\u96c6\u5408 $S$ \u91cc\u6240\u6709\u5143\u7d20 $A$ \u7684\u548c\uff0c$C_S$ \u4e3a\u6240\u6709\u8fde\u8fb9\u4e3a $S$ \u7684\u5b50\u96c6\u7684 $B$ \u7684\u548c\uff0c\u5219\u5145\u8981\u6761\u4ef6\u4e3a $\\forall S,A_S\\geqslant C_S$\u3002\r\n\r\n\u6240\u4ee5\u7b2c\u4e00\u95ee\u7684\u7b54\u6848\u5c31\u662f $M=\\min\\{A_S-C_S|C_S>0\\}+1$\u3002\r\n\r\n\u8ba1\u7b97\u6bcf\u4e2a\u96c6\u5408\u51cf\u5c0f $M$ \u7684\u7b54\u6848 $f_S$\uff0c\u8fd9\u5c31\u662f\u4e2a\u63d2\u677f\uff0c\u6ce8\u610f\u5230 $\\max A_S\\leqslant 2\\times 10^6$\uff0c\u662f\u53ef\u4ee5\u76f4\u63a5\u9884\u5904\u7406\u9636\u4e58\u7684\u3002\u4e00\u4e2a\u96c6\u5408 $S$ \u53ef\u4ee5\u8d21\u732e\uff0c\u5f53\u4e14\u4ec5\u5f53\u5b58\u5728\u4e00\u4e2a\u5b83\u7684\u8d85\u96c6 $T$ \u6ee1\u8db3 $A_T-M<C_T$\u3002\r\n\r\n\u8fd9\u91cc\u9762\u6240\u6709\u7684\u64cd\u4f5c\u90fd\u53ef\u4ee5 FWT \u5b8c\u6210\u3002\u65f6\u95f4\u590d\u6742\u5ea6 $O(2^nn)$\u3002\r\n\r\n```cpp\r\n#include<bits/stdc++.h>\r\nusing namespace std;\r\nconst int maxn=2e5+10;\r\nconst int mod=998244353;\r\n#define inf 2e9\r\ninline int read(){\r\n\tint x=0,f=1;char c=getchar();\r\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\r\n\twhile(c>='0'&&c<='9'){x=(x<<1)+(x<<3)+c-'0';c=getchar();}\r\n\treturn x*f;\r\n}\r\nconst int N=20,M=2e6;\r\nint n,m,A[1<<N],B[maxn],S[maxn],C[1<<N],D[1<<N],ans,tg[1<<N];\r\nint fac[M+5],inv[M+5],ifc[M+5];\r\ninline int com(int x,int y){\r\n\tif(x<0||y<0||x<y)return 0;\r\n\treturn 1ll*fac[x]*ifc[y]%mod*ifc[x-y]%mod;\r\n}\r\nint main(){\r\n\tinv[1]=fac[0]=ifc[0]=1;\r\n\tfor(int i=2;i<=M;i++)inv[i]=1ll*(mod-mod/i)*inv[mod%i]%mod;\r\n\tfor(int i=1;i<=M;i++)fac[i]=1ll*fac[i-1]*i%mod;\r\n\tfor(int i=1;i<=M;i++)ifc[i]=1ll*ifc[i-1]*inv[i]%mod;\r\n\tn=read(),m=read();\r\n\tfor(int i=0;i<n;i++)A[1<<i]=read();\r\n\tfor(int i=1;i<(1<<n);i++)\r\n\t\tA[i]=A[i&(i-1)]+A[i&(-i)];\r\n\tfor(int i=1;i<=m;i++)B[i]=read();\r\n\tfor(int i=0;i<n;i++)\r\n\t\tfor(int j=1;j<=m;j++)S[j]|=(read()<<i);\r\n\tfor(int i=1;i<=m;i++)C[S[i]]+=B[i];\r\n\tfor(int i=0;i<n;i++)\r\n\t\tfor(int j=0;j<(1<<n);j++)\r\n\t\t\tif(j>>i&1)C[j]+=C[j^(1<<i)];\r\n\tint Mn=inf;\r\n\tfor(int i=0;i<(1<<n);i++)\r\n\t\tif(C[i])Mn=min(Mn,A[i]-C[i]);\r\n\tif(Mn<0)return puts(\"0 1\")&0;\r\n\tprintf(\"%d \",Mn+1);\r\n\tfor(int i=0;i<(1<<n);i++)D[i]=com(A[i],Mn+1);\r\n\tfor(int i=0;i<(1<<n);i++)\r\n\t\tif(C[i]>0&&(A[i]-C[i]==Mn))tg[i]=1;\r\n\tfor(int i=(1<<n)-1;~i;--i)\r\n\t\tfor(int j=0;j<n;j++)\r\n\t\t\tif(!(i>>j&1))tg[i]|=tg[i^(1<<j)];\r\n\tfor(int i=0;i<n;i++)\r\n\t\tfor(int j=(1<<n)-1;~j;--j)\r\n\t\t\tif(j>>i&1)D[j]=(D[j]-D[j^(1<<i)]+mod)%mod;\r\n\tfor(int i=0;i<(1<<n);i++)\r\n\t\tif(tg[i])ans=(ans+D[i])%mod;\r\n\tprintf(\"%d\\n\",ans);\r\n\treturn 0;\r\n}\r\n```\r\n\r\n\u6df1\u6df1\u5730\u611f\u5230\u81ea\u5df1\u7684\u5f31\u5c0f\u3002",
        "postTime": 1677655095,
        "uid": 140876,
        "name": "syzf2222",
        "ccfLevel": 9,
        "title": "ABC215H Cabbage Master"
    }
]
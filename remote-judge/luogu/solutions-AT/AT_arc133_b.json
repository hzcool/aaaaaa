[
    {
        "content": "## problem\n\u957f\u4e3a $n$ \u7684\u6392\u5217 $A,B$\u3002\n\n\u63d0\u53d6\u4e24\u4e2a\u53ef\u4ee5\u4e0d\u8fde\u7eed\u7684\u5b50\u5e8f\u5217 $a\\subseteq A,b\\subseteq B$\uff0c\u6ee1\u8db3\uff1a\n\n- $|a|=|b|.$\n- $\\forall i\\in[1,n],a_i|b_i.$\n\n\u6c42 $\\max |a|$\u3002$n\\leq 10^5$\u3002\n\n## solution 1\n\u8003\u8651\u62ce\u51fa\u6240\u6709\u7684 $(i,j),s.t.,a_i|b_j$\uff0c\u56e0\u4e3a\u662f\u6392\u5217\uff0c\u6240\u4ee5\u662f\u8c03\u548c\u7ea7\u6570\uff0c \u53ea\u6709 $O(n\\log n)$ \u5bf9\u3002\n\n\u90a3\u4e48\u6211\u4eec\u8981\u9009\u51fa\u82e5\u5e72\u5bf9 $(i,j)$ \u4f7f\u5f97 $i,j$ \u5206\u522b\u5355\u8c03\uff0c\u4e14\u4e0d\u91cd\u590d\u3002\n\n\u5ffd\u7565\u91cd\u590d\u7684\u9650\u5236\uff0c\u6211\u4eec\u53ef\u4ee5\u5148\u5bf9\u7740 $j$ \u6392\u5e8f\uff0c\u518d\u5bf9 $i$ \u505a\u6700\u957f\u4e0a\u5347\u5b50\u5e8f\u5217\uff0c\u540c\u65f6\u6ee1\u8db3\u4e86\u4e24\u4e2a\u9650\u5236\u3002\n\n\u4e3a\u4e86\u907f\u514d\u9009\u5230\u76f8\u540c\u7684 $j$\uff0c\u5bf9\u4e8e $(i_1,j),(i_2,j)$\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06 $i$ \u5012\u5e8f\u6392\u5e8f\uff0c\u4e5f\u5c31\u662f\u4f7f $i_1>i_2$\u3002\u7531\u4e8e\u662f\u4e0a\u5347\u5b50\u5e8f\u5217\uff0c\u56e0\u6b64\u4e0d\u4f1a\u9009\u5230\u76f8\u540c\u7684 $j$ \u4e86\u3002\n## code\n```cpp\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\nusing namespace std;\ntypedef long long LL;\nint n,cnt,a[200010],p[200010],c[200010<<4];\npair<int,int> b[200010<<4];\nint main(){\n\tscanf(\"%d\",&n);\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",&a[i]);\n\tfor(int i=1,x;i<=n;i++) scanf(\"%d\",&x),p[x]=i;\n\tfor(int i=1;i<=n;i++){\n\t\tfor(int j=a[i];j<=n;j+=a[i]){\n\t\t\tb[++cnt]={i,p[j]};\n\t\t}\n\t}\n\tsort(b+1,b+cnt+1,[](pair<int,int> a,pair<int,int> b){\n\t\treturn a.second!=b.second?a.second<b.second:a.first>b.first;\n\t});\n\tint top=0;\n\tfor(int i=1;i<=cnt;i++){\n\t\tif(!top||c[top]<b[i].first) c[++top]=b[i].first;\n\t\telse *lower_bound(c+1,c+top+1,b[i].first)=b[i].first;\n\t}\n\tprintf(\"%d\\n\",top);\n\treturn 0;\n}\n\n\n```\n## solution 2\n\u8003\u8651\u66b4\u529b DP\u3002\n\n$$f_{i,j}=\\max(f_{i',j'}+1)\\quad(a_i|b_j).$$\n\n\u4f18\u5316\u4e4b\u3002\u6eda\u6389 $j$\uff0c\u9010\u4e2a\u52a0\u5165 $b_j$\uff0c\u7528 $b_j$ \u66f4\u65b0 $f$\uff1a\n\n$$f_i=\\max(f_i,1+\\max_{k<i} f_{k})\\quad(a_i|b_j).$$\n\n\u7531\u4e8e\u6ee1\u8db3 $a_i|b_j$ \u7684\u6570\u91cf\u662f\u8c03\u548c\u7ea7\u6570\uff0c\u56e0\u6b64\u53ea\u6709 $O(n\\log n)$ \u7684\u679a\u4e3e\u91cf\u3002\n\n\u5bf9\u4e8e $\\max_{k<i} f_{k}$\uff0c\u7ebf\u6bb5\u6811\u7ef4\u62a4\u4e4b\u3002\u603b\u7684\u590d\u6742\u5ea6 $O(n\\log^2 n)$\u3002",
        "postTime": 1665743840,
        "uid": 509229,
        "name": "yukimianyan",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 ARC133B\u3010Dividing Subsequence\u3011"
    }
]
[
    {
        "content": "\u5982\u679c\u679a\u4e3e $A_i$ \u51fa\u73b0\u7684\u6b21\u6570 $c_i$\uff0c\u90a3\u4e48\u7b54\u6848\u53ef\u4ee5\u5199\u6210\u5982\u4e0b\u5f0f\u5b50\uff1a\n\n$\\operatorname{xor}_{\\sum c_i=k}(\\begin{pmatrix}k\\\\c_1,c_2,\\cdots,c_n\\end{pmatrix}\\bmod2)\\sum\\limits_{i=1}^n A_ic_i$\n\n$\\begin{pmatrix}k\\\\c_1,c_2,\\cdots,c_n\\end{pmatrix}\\equiv1\\pmod2$ \u65f6\u624d\u4f1a\u5bf9\u7b54\u6848\u6709\u8d21\u732e\u3002\n\n$\\begin{pmatrix}k\\\\c_1,c_2,\\cdots,c_n\\end{pmatrix}$ \u5176\u5b9e\u53ef\u4ee5\u5199\u6210\u7ec4\u5408\u6570\u7684\u5f62\u5f0f\uff1a\n\n$\\begin{pmatrix}k\\\\c_1,c_2,\\cdots,c_n\\end{pmatrix}=\\prod\\limits_{i=1}^n\\begin{pmatrix}k-\\sum\\limits_{j=1}^{i-1}c_i\\\\c_i\\end{pmatrix}$\n\n\u8bbe $n$ \u5728\u4e8c\u8fdb\u5236\u4e0b\u7b2c $i$ \u4f4d\u4e3a $n_{2,i}$\n\n\u6839\u636e\u5362\u5361\u65af\u5b9a\u7406\uff0c$\\begin{pmatrix}n\\\\m\\end{pmatrix}\\equiv\\prod\\limits_{i=0}^{\\infty}\\begin{pmatrix}n_{2,i}\\\\m_{2,i}\\end{pmatrix}\\pmod2$\n\n\u800c $\\begin{pmatrix}0\\\\0\\end{pmatrix}=\\begin{pmatrix}1\\\\0\\end{pmatrix}=\\begin{pmatrix}1\\\\1\\end{pmatrix}=1,\\begin{pmatrix}0\\\\1\\end{pmatrix}=0$\n\n\u6240\u4ee5 $\\exists i,n_{2,i}=0,m_{2,i}=1$ \u548c $\\begin{pmatrix}n\\\\m\\end{pmatrix}\\equiv0\\pmod2$ \u4e92\u4e3a\u5145\u5206\u5fc5\u8981\u6761\u4ef6\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u5982\u679c\u628a $n,m$ \u770b\u505a\u662f\u96c6\u5408\u5728\u4e8c\u8fdb\u5236\u4e0b\u7684\u72b6\u6001\u538b\u7f29\uff0c\u90a3\u4e48 $m$ \u662f $n$ \u7684\u5b50\u96c6\u624d\u4f1a\u6ee1\u8db3 $\\begin{pmatrix}n\\\\m\\end{pmatrix}\\equiv1\\pmod2$\n\n\u6240\u4ee5 $\\begin{pmatrix}k\\\\c_1,c_2,\\cdots,c_n\\end{pmatrix}\\equiv1\\pmod2$ \u65f6\uff0c$c_1,c_2,\\cdots,c_n$ \u662f\u96c6\u5408 $k$ \u7684\u4e00\u79cd\u5212\u5206\u3002\n\n\u7531\u4e8e $\\lfloor\\log_2 k\\rfloor<40$\uff0c$c_1,c_2,\\cdots,c_n$ \u4e2d\u6700\u591a $40$ \u4e2a\u6570\u975e $0$\u3002\n\n\u6240\u4ee5\u6211\u4eec\u8003\u8651\u6570\u4f4d dp\uff1a\n\n\u8bbe $f_{i,S}$ \u8868\u793a\u672b $i-1$ \u4f4d\u5df2\u7ecf\u786e\u5b9a\uff0c\u7b2c $[i,i+10]$ \u4f4d\u76ee\u524d\u503c\u662f $S$ \u7684\u6240\u6709\u65b9\u6848\u7684\u7b54\u6848\uff0c$g_{i,S}$ \u8868\u793a\u672b $i-1$ \u4f4d\u5df2\u7ecf\u786e\u5b9a\uff0c\u7b2c $ [i,i+10] $ \u4f4d\u76ee\u524d\u503c\u662f $S$ \u65f6\u7684\u65b9\u6848\u6570\u5bf9 $2$ \u53d6\u6a21\u3002\n\n\u521d\u59cb\u72b6\u6001\u4e3a $f_{0,0}=0,g_{0,0}=1$\u3002\n\n\u663e\u7136\u7531 $i$ \u8f6c\u79fb\u5230 $i+1$\uff0c\u6839\u636e\u7b2c $i$ \u4f4d\u662f\u4e0d\u662f $1$ \u6765\u8f6c\u79fb\uff1a\uff08\u7528 $a\\leftarrow b$ \u8868\u793a\u72b6\u6001 $b$ \u8981\u8f6c\u79fb\u5230\u72b6\u6001 $a$\uff09\n\n\u5f53 $k_{2,i}=0$ \u65f6\uff0c$f_{i+1,\\lfloor\\frac{S}{2}\\rfloor}\\leftarrow f_{i,S},g_{i+1,\\lfloor\\frac{S}{2}\\rfloor}\\leftarrow g_{i,S}$\n\n\u5f53 $k_{2,i}=1$ \u65f6\uff0c\u679a\u4e3e $j$ \u8868\u793a\u5c06 $i$ \u5212\u5206\u7ed9 $c_j$\uff1a$f_{i+1,a_j+\\lfloor\\frac{S}{2}\\rfloor}\\leftarrow f_{i,S},g_{i+1,a_j+\\lfloor\\frac{S}{2}\\rfloor}\\leftarrow g_{i,S}$\n\n\u5177\u4f53\u7684\u8f6c\u79fb\u7ec6\u8282\u770b\u4ee3\u7801\u5427\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n(\\max{a_i})\\log k)$\uff1a\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int MAXN=2048,N=51;\nint n,a[MAXN];\nll k,f[N+1][MAXN],g[N+1][MAXN];\nbool vis[N+1][MAXN];//vis\u6570\u7ec4\u8868\u793a\u8fd9\u4e2a\u72b6\u6001\u7684\u65b9\u6848\u6570\u662f\u5426\u5927\u4e8e0\nint main() {\n    scanf(\"%d%lld\",&n,&k);\n    for(int i=1; i<=n; ++i) scanf(\"%d\",&a[i]);\n    g[0][0]=vis[0][0]=1;\n    for(int i=0; i<N; ++i)\n        for(int j=0; j<MAXN; ++j)\n            if(vis[i][j]) {//\u72b6\u6001\u8981\u65b9\u6848\u6570\u5927\u4e8e0\n                if((k>>i)&1) {\n                    for(int y=1,x; y<=n; ++y) {//\u679a\u4e3e\u5212\u5206\u7684a\n                        x=a[y]+(j>>1);\n                        g[i+1][x]^=g[i][j];\n                        f[i+1][x]^=f[i][j];\n                        vis[i+1][x]=true;\n                        if(g[i][j]&j&1) f[i+1][x]^=(1ll<<i-1);//\u65b9\u6848\u6570\u4e3a\u5947\u6570\u4e14\u90a3\u4e00\u4f4d\u4e3a1\n                    }\n                } else {\n                \tvis[i+1][j>>1]=true;\n                \tf[i+1][j>>1]^=f[i][j];\n                \tif(g[i][j]&j&1) f[i+1][j>>1]^=(1ll<<i-1);\n                \tg[i+1][j>>1]^=g[i][j];\n\t\t\t\t}\n            }\n    printf(\"%lld\\n\",f[N][0]);\n    return 0;\n}\n```",
        "postTime": 1676737044,
        "uid": 279646,
        "name": "mod998244353",
        "ccfLevel": 7,
        "title": "ARC156D\u9898\u89e3"
    },
    {
        "content": "\u9898\u76ee\u94fe\u63a5\uff1a[D - Xor Sum 5](https://atcoder.jp/contests/arc156/tasks/arc156_d)\n\n\u9898\u76ee\u5927\u610f\uff1a\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $N(1\\le N\\le 1000)$ \u7684\u6570\u7ec4 $A(0\\le A_i\\le 1000)$\uff0c\u4ee5\u53ca\u4e00\u4e2a\u6b63\u6574\u6570 $K(1\\le K\\le 10^{12})$\u3002\u73b0\u5728\u8981\u5728\u8fd9 $N$ \u4e2a\u6570\u5b57\u91cc\u6311\u4e00\u4e2a $A_i$ \u51fa\u6765\uff0c\u5e76\u91cd\u590d $K$ \u6b21\u8fd9\u6837\u7684\u64cd\u4f5c\uff0c\u5bf9\u5e94\u7684\u5f97\u5206\u5c31\u662f\u6311\u51fa\u6765\u7684 $A_i$ \u4e4b\u548c\u3002\u4e00\u5171\u6709 $N^K$ \u79cd\u6311\u9009\u65b9\u6848\uff0c\u6c42\u6240\u6709\u6311\u9009\u65b9\u6848\u5bf9\u5e94\u5f97\u5206\u7684\u5f02\u6216\u548c\u3002\n\n### \u7b80\u5316\u95ee\u9898\n\n\u5c06\u95ee\u9898\u8f6c\u5316\u6210\u751f\u6210\u51fd\u6570\u6765\u8868\u793a\uff0c\u90a3\u5c31\u662f\u4ee4 $P(x)=(x^{A_1}+x^{A_2}+...+x^{A_N})^K$\uff0c\u5e76\u6c42\u6240\u6709\u7cfb\u6570\u4e3a\u5947\u6570\u5bf9\u5e94\u9879\u7684\u6307\u6570\u4e4b\u548c\u3002\u90a3\u4e48\u8003\u8651\u6a21 $2$ \u610f\u4e49\u4e0b\u7684\u591a\u9879\u5f0f\u8fd0\u7b97\uff0c\u5c31\u662f\u6c42\u6ee1\u8db3 $[x^S](x^{A_1}+x^{A_2}+...+x^{A_N})^K$ \u7684\u503c\u4e3a $1$ \u5bf9\u5e94\u7684\u6240\u6709 $S$ \u7684\u5f02\u6216\u548c\u3002\n\n\u63a5\u7740\u8003\u8651\u6a21 $2$ \u610f\u4e49\u4e0b\u7684\u4e00\u4e2a\u7ecf\u5178\u5f0f\u5b50\uff1a\n\n$$(x_1+x_2+...+x_n)^2\\equiv x_1^2+x_2^2+...+x_n^2+2\\sum_{i<j}x_ix_j\\equiv x_1^2+x_2^2+...+x_n^2$$\n\n\u53cd\u590d\u5957\u7528\u5bf9\u5e94\u5f0f\u5b50\uff0c\u6211\u4eec\u5f97\u5230\uff1a\n\n$$(x_1+x_2+...+x_n)^{2^k}\\equiv x_1^{2^k}+x_2^{2^k}+...+x_n^{2^k}$$\n\n\u5176\u5b9e\u5bf9\u4e8e\u8fd9\u4e2a\u5f0f\u5b50\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528 $\\texttt{Lucas}$ \u5b9a\u7406\u7684\u63a8\u8bba\u6765\u8bc1\u660e\uff1a\n\n- \u7ecf\u5178\u63a8\u8bba\uff1a$(x+y)^P\\equiv x^P+y^P\\pmod P$\uff0c\u5176\u4e2d $P$ \u4e3a\u8d28\u6570\uff08\u8003\u8651 $\\binom{P}{i}$ \u4e0d\u4e3a $P$ \u7684\u500d\u6570\u5f53\u4e14\u4ec5\u5f53 $i=0$ \u6216 $P$\uff09\n- \u5bf9 $P=2$\uff0c\u5f97\u51fa $(x+y)^2\\equiv x^2+y^2 \\pmod 2$\n- \u53cd\u590d\u5957\u7528\u8be5\u5f0f\uff0c\u5f97\u51fa $(\\sum_{i=1}^n x_i)^2\\equiv (\\sum_{i=1}^{n-1} x_i)^2+x_n^2\\equiv ...\\equiv \\sum_{i=1}^n x_i^2$\n\n\u56de\u5230\u539f\u95ee\u9898\uff0c\u8003\u8651 $K$ \u7684\u4e8c\u8fdb\u5236\u8868\u8fbe $K=\\sum_{i=1}^{M}2^{k_i}$\uff0c\u90a3\u4e48\u5c31\u6709\uff1a\n\n$$[x^S](x^{A_1}+x^{A_2}+...+x^{A_N})^K\\equiv [x^S]\\prod_{i=1}^M(x^{A_1\\times 2^{k_i}}+x^{A_2\\times 2^{k_i}}+...+x^{A_N\\times 2^{k_i}})$$\n\n\u8bb0\u7b2c $i$ \u6b21\u9009\u62e9\u7684\u6570\u5b57\u4e0b\u6807\u4e3a $X_i$\uff0c\u4e8e\u662f\u95ee\u9898\u5c31\u7531\u6c42 $\\sum_{i=1}^K A_{X_i}$ \u7684\u5f02\u6216\u548c\u53d8\u6210\u4e86\u6c42 $\\sum_{m=1}^M A_{X_m}\\times 2^{k_m}=S$ \u7684\u5f02\u6216\u548c\u3002\n\n### \u7ec4\u5408\u8ba1\u6570\n\n\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u4e00\u95ee\u9898\u8f6c\u5316\u4e3a\u4e00\u9053\u7ec4\u5408\u8ba1\u6570\u95ee\u9898\uff1a\u5bf9\u6bcf\u4e2a\u7ed3\u679c $S$\uff0c\u786e\u5b9a $\\sum_{m=1}^M A_{X_m}\\times 2^{k_m}=S$ \u7684\u65b9\u6848\u6570\u3002\u7531\u4e8e\u6211\u4eec\u6700\u540e\u6c42\u7684\u662f\u5f02\u6216\u548c\uff0c\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u7edf\u8ba1\u65b9\u6848\u6570\u4e3a\u5947\u6570\u7684\u7b54\u6848\u5373\u53ef\uff0c\u8fdb\u4e00\u6b65\u5730\uff0c\u6211\u4eec\u8003\u8651\u6c42\u548c\u7ed3\u679c\u5728\u4e8c\u8fdb\u5236\u7684\u67d0\u4e00\u4f4d\u4e0a\u4e3a $1$ \u7684\u65b9\u6848\u6570\u3002\n\n\u8003\u8651\u52a8\u6001\u7ef4\u62a4\u6240\u6709\u6ee1\u8db3\u65b9\u6848\u6570\u4e3a\u5947\u6570\u7684 $S$ \u7ec4\u6210\u7684\u96c6\u5408\u3002\u8bbe\u5f53\u524d\u8003\u8651\u7684\u662f\u4e8c\u8fdb\u5236\u7b2c $i$ \u4f4d\u4e0a\u7684\u7b54\u6848\uff0c\u663e\u7136\u66f4\u4f4e\u4f4d\u7684\u4fe1\u606f\u6211\u4eec\u662f\u4e0d\u9700\u8981\u7684\uff0c\u6240\u4ee5\u6211\u4eec\u52a8\u6001\u7ef4\u62a4\u6240\u6709\u7684 $\\lfloor\\frac{S}{2^i}\\rfloor$\u3002\u53c8\u56e0\u4e3a\u5f53 $k_m>i$ \u65f6\uff0c$A_{X_m}\\times 2^{k_m}$ \u5bf9\u7b54\u6848\u7684\u7b2c $i$ \u4f4d\u4e0d\u4ea7\u751f\u8d21\u732e\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7b49\u5230 $i=k_m$ \u65f6\u518d\u8003\u8651\u5bf9\u5e94 $A_{X_m}\\times 2^{k_m}$ \u7684\u9009\u62e9\u3002\n\n\u4e8e\u662f\u5728\u8fc7\u7a0b\u4e2d\uff0c\u5f53\u6211\u4eec\u8003\u8651\u5230\u7b2c $i$ \u4f4d\u65f6\uff0c\u96c6\u5408\u4e2d\u7684\u5143\u7d20\u4e2a\u6570\u3002\u53ef\u4ee5\u4f30\u7b97\u5f97\u51fa\uff0c\u96c6\u5408\u4e2d\u5143\u7d20\u7684\u6700\u5927\u503c\u5bf9\u5e94\u4e0a\u754c\u4e3a\uff1a\n\n$$\\sum_{j=0}^{i} \\lfloor\\frac{\\max(A)\\times2^j}{2^i}\\rfloor \\le \\sum_{j=0}^{i}\\frac{\\max(A)\\times2^j}{2^i}=\\max(A)\\times \\sum_{j=0}^{i} 2^{-j}\\le 2\\max (A)$$\n\n\u6240\u4ee5\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\uff0c\u96c6\u5408\u7684\u5927\u5c0f\u59cb\u7ec8\u662f\u4e0d\u8d85\u8fc7 $2\\max (A)$ \u7684\u3002\u4e8e\u662f\u6211\u4eec\u76f4\u63a5\u66b4\u529b\u7ef4\u62a4\u96c6\u5408\u5373\u53ef\u5728 $O(N^2\\log K)$ \u7684\u590d\u6742\u5ea6\u5185\u89e3\u51b3\u95ee\u9898\uff0c\u6bcf\u6b21\u7edf\u8ba1\u7b54\u6848\u65f6\u53ea\u9700\u8981\u7edf\u8ba1\u96c6\u5408\u5185\u6709\u591a\u5c11\u4e2a\u5947\u6570\u5373\u53ef\u3002\u4f7f\u7528 $\\texttt{bitset}$ \u53ef\u4ee5\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u5e38\u6570\u4f18\u5316\u3002\n\n\u8981\u6ce8\u610f\u7684\u662f\uff0c\u7531\u4e8e\u5728\u8003\u8651\u524d\u9762\u51e0\u4f4d\u7684\u7b54\u6848\u65f6\uff0c\u5bf9\u4e8e $k_m>i$ \u5bf9\u5e94\u7684 $A_{X_m}\\times 2^{k_m}$ \u9009\u62e9\u65b9\u6848\u6570\u8fd8\u6ca1\u6709\u88ab\u7edf\u8ba1\u8fdb\u6765\uff0c\u6240\u4ee5\u5b9e\u9645\u4e0a\u8fd9\u65f6\u5bf9\u5e94\u7684\u65b9\u6848\u6570\u8fd8\u8981\u4e58\u4e0a\u4e00\u4e2a $N$ \u7684\u82e5\u5e72\u6b21\u65b9 $N^{\\text{\u963f\u5df4\u963f\u5df4}}$\u3002\u56e0\u6b64\u5f53\u8fd8\u5b58\u5728 $k_m>i$ \u65f6\uff0c\u6211\u4eec\u8fd8\u9700\u8981\u6839\u636e $N$ \u7684\u5947\u5076\u6027\u6765\u5224\u65ad\u5f53\u524d\u4f4d\u7f6e\u662f\u5426\u53ef\u80fd\u6709\u503c\u3002\u6b64\u5916\u5f53 $i=k_M$ \u65f6\u6211\u4eec\u4e5f\u53ef\u4ee5\u76f4\u63a5\u8ba1\u7b97\u6700\u7ec8\u7b54\u6848\uff0c\u5177\u4f53\u5b9e\u73b0\u89c1\u4ee3\u7801\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define N 2048\nint n;\nbitset<N>a,s,t;\nlong long k,ans;\nint main()\n{\n\tscanf(\"%d%lld\",&n,&k);\n\tfor(int i=1;i<=n;i++){\n\t\tint x;\n\t\tscanf(\"%d\",&x);\n\t\ta.flip(x);\n\t}\n\ts[0]=1;\n\tfor(int i=0;i<=40;i++){\n\t\tfor(int j=0;j<N;j++)if(s[j])\n\t\t\ts.flip(j/2),s.flip(j);\n\t\tif(k>>i&1){\n\t\t\tt.reset();\n\t\t\tk^=(1ll<<i);\n\t\t\tfor(int x=0;x<N/2;x++)if(a[x])\n\t\t\t\tt=t^(s<<x);\n\t\t\ts=t;\n\t\t}\n\t\tif(k==0){\n\t\t\tlong long res=0;\n\t\t\tfor(int j=0;j<N;j++)if(s[j])res^=j;\n\t\t\tans+=res<<i;\n\t\t\treturn printf(\"%lld\\n\",ans),0;\n\t\t}\n\t\tif(n&1){\n\t\t\tlong long o=0;\n\t\t\tfor(int j=1;j<N;j+=2)if(s[j])o^=1;\n\t\t\tans+=o<<i;\n\t\t}\n\t}\n}\n```\n",
        "postTime": 1676867798,
        "uid": 4672,
        "name": "DeaphetS",
        "ccfLevel": 3,
        "title": "[AtCoder Regular Contest 156][D. Xor Sum 5]"
    },
    {
        "content": "### Part1 \u95ee\u9898\u9648\u8ff0\n\u9898\u610f\u7ed9\u5b9a $N,K,a_{1\\sim N}$\uff0c\u6c42 $\\sum\\limits_{i=1}^Ka_{X_i}$ \u7684\u5f02\u6216\u548c\uff0c\u5176\u4e2d $X_i$ \u4f1a\u904d\u5386 $N^K$ \u79cd\u60c5\u51b5\uff0c$N,a_i\\le1000,K\\le10^{12}$\u3002\n\n### Part2 \u8f6c\u5316\n\n\u770b\u4f3c\u8fd9\u9898\u5f88\u53ef\u505a\uff0c\u4f46\u53c8\u4e0d\u4f1a\u8f6c\u5316\u3002\n\n\u8003\u8651 $K$ \u4e00\u822c\u5f88\u5927\uff0c\u6240\u4ee5\u8bb8\u591a $X_i$ \u4f1a\u91cd\u590d\u5f88\u591a\u6b21\uff0c\u800c\u4e14\u7b49\u4ef7\u96c6\u5408 $\\{X_i\\}$ \u4e5f\u4f1a\u51fa\u73b0\u5f88\u591a\u6b21\u3002\n\n\u8981\u662f $\\{X_i\\}$ \u7684\u51fa\u73b0\u6b21\u6570\u4e3a\u5076\u6570\u5c31\u597d\u4e86\uff0c\u90a3\u6837\u5c31\u53ef\u4ee5\u62b5\u6d88\u6389\u8d21\u732e\u4e86\u3002\n\n\u4f8b\u5982\uff0c$N=4$ \u65f6\uff0c$\\{1,1,1,2\\}$ \u8fd9\u4e2a\u96c6\u5408\u4f1a\u51fa\u73b0 $\\dbinom 4 3=4$ \u6b21\uff0c\u6240\u4ee5\u4e0d\u4f1a\u4ea7\u751f\u8d21\u732e\uff0c$N=5$ \u65f6\uff0c$\\{1,1,1,2,2\\}$ \u8fd9\u4e2a\u96c6\u5408\u4f1a\u51fa\u73b0 $\\dbinom 5 3=10$ \u6b21\uff0c\u4e5f\u4e0d\u4f1a\u4ea7\u751f\u8d21\u732e\uff0c\u4e8e\u662f\u6211\u5c31\u83ab\u540d\u5176\u5999\u7684\u626f\u5230\u7ec4\u5408\u6570\u4e0a\u53bb\u4e86\u3002\n\n\u4e8b\u5b9e\u4e0a\uff0c\u4e00\u4e2a\u7531 $a$ \u4e2a $X_1$ \u548c $b$ \u4e2a $X_2$ \u4e8c\u5143\u53ef\u91cd\u96c6\u4f1a\u4ea7\u751f\u8d21\u732e\u5f53\u4e14\u4ec5\u5f53 $\\dbinom{a+b}a\\bmod2=1$\uff0c\u8fd9\u5c31\u662f\u7ec4\u5408\u6570\u5947\u5076\u6027\uff0c\u7b49\u4ef7\u4e8e $a|(a+b)=a+b$\u3002\n\n### Part3 \u591a\u91cd\u96c6\u7ec4\u5408\u6570\u5947\u5076\u6027\n\u6211\u4eec\u731c\u6d4b\u591a\u91cd\u96c6\u7ec4\u5408\u6570 $\\dbinom{a_1+\\dots+a_n}{a_1,\\dots,a_n}=\\dfrac{(\\sum\\limits_{i=1}^na_i)!}{\\prod\\limits_{i=1}^na_i!}\\bmod2=1$ \u5f53\u4e14\u4ec5\u5f53 $a_1|\\dots|a_n=a_1+\\dots+a_n$\uff0c\u4e8b\u5b9e\u4e0a\u8fd9\u662f\u6b63\u786e\u7684\u3002\n\n\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u9010\u6b65 choose \u7684\u65b9\u6cd5\u6765\u8bc1\u660e\uff0c\u5373 $\\dbinom{a_1+\\dots+a_n}{a_1,\\dots,a_n}=\\prod\\limits_{i=1}^n\\dbinom{\\sum\\limits_{j=1}^ia_j}{a_i}$\uff0c\u4e8e\u662f\u6211\u4eec\u9700\u8981\u8fd9\u4e9b\u7ec4\u5408\u6570\u5168\u90e8\u90fd\u662f\u5947\u6570\uff0c\u8fd9\u53ea\u8981\u5f52\u7eb3\u9012\u63a8\u56de\u53bb\u5c31\u884c\u4e86\u3002\n\n\u6240\u4ee5\uff0c\u539f\u95ee\u9898\u53ea\u6709 $K$ \u7684\u6bcf\u4e00\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u5747\u88ab\u4e00\u4e2a\u6570\u5b57\u4f7f\u7528\u65f6\u624d\u4f1a\u4ea7\u751f\u8d21\u732e\u3002\n\n### Part4 \u4f7f\u7528\u9012\u63a8\u5b9e\u73b0\n\n\u597d\u50cf\u4e0d\u80fd\u79f0\u4e4b\u4e3a\u52a8\u6001\u89c4\u5212\u5427\uff0c\u53d1\u73b0\u6211\u4eec\u53ef\u4ee5\u5bf9\u6bcf\u4e00\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u5355\u72ec\u8003\u8651\uff0c\u8bbe $f_{i,j}$ \u8868\u793a\u8fd8\u6ca1\u6709\u4f7f\u7528 $K$ \u7684\u7b2c $2^i$ \u4f4d\uff0c\u5f53\u524d\u6570\u5b57\u6574\u9664 $2^{i-1}$ \u7684\u503c\u4e3a $j$\uff0c\u8fd9\u90e8\u5206\u56e0\u4e3a\u4e4b\u524d\u6700\u5927\u7684\u548c\u4e0d\u8d85\u8fc7 $1000\\times2^i$\uff0c\u6240\u4ee5\u7b2c\u4e8c\u7ef4\u6700\u591a\u53ea\u8981 $2048$ \u5c31\u597d\u4e86\uff0c\u66b4\u529b\u8f6c\u79fb\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $na\\log K$\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n### Part5 \u540e\u8bb0\n\n\u8fd9\u6837\u7684\u9898\u76ee\u8fd8\u662f\u7ed9\u4e2a\u4ee3\u7801\u5427\uff0c\u5176\u5b9e\u8fd8\u662f\u6709\u70b9\u610f\u601d\u7684\uff1a\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nconst int N=1e6+6,M=998244353;\nusing ll=long long;\nll f[59][2122],K,ans;\nint n,a[N];\nint main(){\n\tios::sync_with_stdio(false);\n\tint i,j,k,l,r,x,y;\n\tcin>>n>>K;\n\tfor(x=1;x<=n;++x)cin>>a[x];\n\tf[0][0]=1;\n\tfor(x=0;x<=53;++x)\n\t\tif((K>>x)&1){\n\t\t\tfor(y=1;y<=n;++y)\n\t\t\t\tfor(k=0;k<2048;++k){\n\t\t\t\t\tf[x+1][a[y]+(k>>1)]^=f[x][k];\n\t\t\t\t}\n\t\t}else{\n\t\t\tfor(k=0;k<2048;++k)\n\t\t\t\tf[x+1][k>>1]^=f[x][k];\n\t\t}\n\tfor(x=1;x<=54;++x)\n\t\tif((n&1)||!(K>>x-1)){\n\t\t\tfor(l=k=0;k<2048;++k)\n\t\t\t\tif(k&1)l^=f[x][k];\n\t\t\tif(l)ans|=1ll<<x-1;\n\t\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n}\n```",
        "postTime": 1676951615,
        "uid": 502410,
        "name": "EnofTaiPeople",
        "ccfLevel": 0,
        "title": "\u591a\u91cd\u96c6\u7ec4\u5408\u6570\u5947\u5076\u6027\u4e0e\u4e8c\u8fdb\u5236\u5305\u542b\u5173\u7cfb"
    },
    {
        "content": "\u8003\u8651\u8bb0\u5f55\u6bcf\u4e2a\u4e0b\u6807\u5728 $X$ \u4e2d\u51fa\u73b0\u7684\u6b21\u6570\uff0c\u5206\u522b\u4e3a $c_1,c_2,\\cdots c_n$\uff0c\u90a3\u4e48\uff1a\n\n- \u548c\u4e3a $\\sum_{i=1}^nc_ia_i$\uff0c\u65b9\u6848\u6570\u4e3a $\\dbinom{K}{c_1,c_2,\\cdots ,c_n}$\u3002\n\n\u5f53\u540e\u9762\u8fd9\u4e2a\u7ec4\u5408\u6570\u4e3a\u5076\u6570\u65f6\uff0c\u8fd9\u79cd $c$ \u5e8f\u5217\u662f\u6ca1\u6709\u8d21\u732e\u7684\uff0c\u8003\u8651\u4ec0\u4e48\u65f6\u5019\u8fd9\u4e2a\u7ec4\u5408\u6570\u662f\u5947\u6570\u3002\n\n> \u7531 Lucas \u5b9a\u7406\u7684\u63a8\u8bba\uff0c\u8fd9\u4e2a\u7ec4\u5408\u6570\u662f\u5947\u6570\u5f53\u4e14\u4ec5\u5f53\u5728\u4e8c\u8fdb\u5236\u4e0b $c_1,c_2,\\cdots ,c_n$ \u5f62\u6210\u4e86\u5bf9 $K$ \u7684\u5212\u5206\u3002\n\n\u56e0\u6b64\uff0c$K$ \u7684\u4e8c\u8fdb\u5236\u8868\u793a\u4e2d\u7684\u6bcf\u4e00\u4e2a $1$ \u90fd\u662f\u7edf\u4e00\u8d21\u732e\u5230\u4e00\u4e2a $c_i$ \u4e0a\u7684\u3002\n\n\u4e8e\u662f\u5c31\u53ef\u4ee5\u8bbe\u8ba1\u6570\u4f4d dp \u4e86\uff0c\u8bbe $dp[i][j]$ \u8868\u793a\u8003\u8651 $K$ \u7684\u524d $i$ \u4e2a\u4e8c\u8fdb\u5236\u4f4d\uff0c\u7b2c $i$ \u4f4d\u53ca\u4ee5\u4e0a\u7684\u8fdb\u4f4d\u4e3a $j$ \u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u7b2c\u4e00\u4f4d\u7684\u5927\u5c0f\u4e3a $O(\\log (K\\cdot a_i))$\uff0c\u53d6 $50$\uff0c\u7b2c\u4e8c\u7ef4\u7684\u5927\u5c0f\u4e3a $O(a_i)$\uff0c\u6709\u4e24\u500d\u5e38\u6570\uff0c\u53d6 $2048$\u3002\n\n\u8f6c\u79fb\u5206\u4e24\u7c7b\uff0c\u5982\u679c $K$ \u7684\u7b2c $i$ \u4f4d\u4e3a $0$\uff0c\u90a3\u4e48\u8fd9\u4e00\u4f4d\u4e0d\u4ea7\u751f\u8d21\u732e\uff0c\u8f6c\u79fb\uff08\u8d21\u732e\u65b9\u5f0f\u4e3a\u5f02\u6216\uff09\u4e3a\uff1a\n$$\ndp[i-1][j]\\rightarrow dp[i][\\lfloor j/2\\rfloor]\n$$\n\u5982\u679c $K$ \u7684\u7b2c $i$ \u4f4d\u4e3a $1$\uff0c\u679a\u4e3e\u8fd9\u4f4d\u5206\u7ed9\u4e86\u54ea\u4e2a $a_t$\uff0c\u6709\u8f6c\u79fb\uff1a\n$$\ndp[i-1][j]\\rightarrow dp[i][\\lfloor j/2\\rfloor+a_t]\n$$\n\u6700\u4f4e\u4f4d\u5728 dp \u521d\u59cb\u5316\u65f6\u9700\u8981\u989d\u5916\u8ba8\u8bba\u4e00\u4e0b\uff0c\u662f\u5bb9\u6613\u7684\u3002\n\n\u600e\u4e48\u8ba1\u7b97\u7b54\u6848\uff1f\u5bf9\u7b2c $i$ \u4e2a\u4e8c\u8fdb\u5236\u4f4d\uff0c\u770b\u6709\u591a\u5c11\u79cd\u52a0\u548c\u7684\u65b9\u6848\u4f7f\u548c\u4e2d\u7684\u7b2c $i$ \u4f4d\u4e3a $1$\uff0c\u5982\u679c\u65b9\u6848\u6570\u662f\u5947\u6570\u90a3\u4e48\u5c31\u4f1a\u6709\u8d21\u732e\uff0c\u5229\u7528 $dp[i][]$ \u7684\u8fdb\u4f4d\u4fe1\u606f\u4e0d\u96be\u8fdb\u884c\u8ba1\u7b97\uff0c\u6ce8\u610f\u9700\u8981\u5f02\u6216\u4e0a\u66f4\u9ad8\u4f4d\u7684\u9009\u62e9\uff08\u56e0\u4e3a $dp[i][]$ \u53ea\u51b3\u7b56\u5230\u4e86\u524d $i$ \u4f4d\uff0c$K$ \u4e2d\u540e\u9762\u7684 $1$\uff0c\u6bcf\u4e2a\u8fd8\u662f\u4f1a\u6709 $n$ \u79cd\u5206\u6cd5\u7684\uff09\u3002\n\n\u603b\u590d\u6742\u5ea6\u4e3a $O(n\\cdot a_i\\cdot \\log(K\\cdot a_i))$\uff0c\u5e38\u6570\u8f83\u5c0f\u3002\n\n\u8003\u573a\u4ee3\u7801\uff0c\u7565\u4e11\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst int B=2048,L=50;\n#define F first\n#define S second\nint dp[55][2050],a[1005];\nint n; ll k,ans;\nvoid calc(int i){\n\tint c=1;\n\tfor (int j=i+1; j<L; j++)\n\t\tif ((k>>j)&1) c=c*n%2;\n\tif (!c) return;\n\tfor (int j=0; j<B; j++)\n\t\tif (j%2==1 && dp[i][j]) ans^=1ll<<i;\n}\nint main(){\n\tscanf(\"%d%lld\",&n,&k);\n\tfor (int i=1; i<=n; i++) scanf(\"%d\",&a[i]);\n\tif (k&1){\n\t\tfor (int i=1; i<=n; i++) dp[0][a[i]]^=1;\n\t} else dp[0][0]=1;\n\tcalc(0);\n\tfor (int i=1; i<L; i++){\n\t\tif (!((k>>i)&1)){\n\t\t\tfor (int j=0; j<B; j++) dp[i][j/2]^=dp[i-1][j];\n\t\t} else {\n\t\t\tfor (int j=0; j<B; j++)\n\t\t\t\tfor (int t=1; t<=n; t++) dp[i][j/2+a[t]]^=dp[i-1][j];\n\t\t}\n\t\tcalc(i);\n\t}\n\tprintf(\"%lld\\n\",ans);\n}\n```",
        "postTime": 1677067896,
        "uid": 44599,
        "name": "wishapig",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 ARC156D Xor Sum 5"
    },
    {
        "content": "\u5f02\u6216\u6709\u5f88\u597d\u7684\u6027\u8d28\uff0c\u76f8\u540c\u76f4\u63a5\u62b5\u6d88\u3002\u90a3\u8003\u8651\u6309\u7167\u5c06 $X$ \u770b\u6210\u591a\u91cd\u96c6\u6765\u5212\u5206\u7b49\u4ef7\u7c7b\uff0c\u4ec5\u5927\u5c0f\u4e3a\u5947\u6570\u7684\u7b49\u4ef7\u7c7b\u8d21\u732e\u7b54\u6848\u3002\u8003\u8651\u8fd9\u4e2a\u591a\u91cd\u96c6\u7684\u5f62\u6001\uff0c\u5047\u8bbe\u4e0b\u6807 $i$ \u51fa\u73b0\u4e86 $c_i$ \u6b21\uff0c\u90a3\u4e48\u603b\u7684\u51fa\u73b0\u6b21\u6570\u5c31\u662f\uff1a$\\binom{K}{c_1,c_2,\\cdots,c_n}$\uff08\u591a\u91cd\u96c6\u7684\u6392\u5217\u6570\uff09\n\n\u6b32\u6c42\u5176\u51fa\u73b0\u6b21\u6570\u5947\u5076\u6027\uff0c\u8003\u5bdf\u5176 $2$ \u7684\u6b21\u5e42\u662f\u5426\u4e3a $0$\uff0c\u4eff\u7167 Kummer \u5b9a\u7406\uff0c\u5bb9\u6613\u731c\u51fa $2$ \u7684\u6b21\u5e42\u4e3a $c_1+c_2+\\cdots+c_n$ \u5728\u4e8c\u8fdb\u5236\u4e0b\u7684\u8fdb\u4f4d\u6b21\u6570\uff0c\u800c\u8bc1\u660e\u4e0e Kummer \u5b9a\u7406\u8bc1\u660e\u51e0\u4e4e\u4e00\u81f4\u6545\u7565\u53bb\u3002\u90a3\u4e48\u73b0\u5728 $\\binom{K}{c_1,c_2,\\cdots,c_n}$ \u4e3a\u5947\u6570\u5f53\u4e14\u4ec5\u5f53 $c_1,c_2,\\cdots,c_n$ \u4e24\u4e24\u65e0\u4ea4\u3002\uff08 Lucas \u5b9a\u7406\uff1f\uff09\n\n\u4e5f\u5c31\u662f\u5c06 $K$ \u4e8c\u8fdb\u5236\u5206\u89e3\uff0c\u6bcf\u4e2a\u4e8c\u8fdb\u5236\u4f4d\u5206\u914d\u7ed9\u4e00\u4e2a $c_i$\uff0c\u8fd9\u6837\u5f97\u51fa\u6765\u7684 $c$ \u624d\u662f\u4f1a\u7ed9\u7b54\u6848\u4ea7\u751f\u8d21\u732e\u7684\u3002\n\n\u90a3\u4e48\u601d\u8def\u5c31\u8f6c\u5230\u5728\u6570\u4f4d\u4e0a\u8003\u8651\uff0c\u89c2\u5bdf\u5230 $N,A$ \u90fd\u6bd4\u8f83\u5c0f\uff0c\u6240\u4ee5\u60f3\u5230\u8bbe\u6570\u4f4d dp $f_{i,j}$ \u8868\u793a\u4ece\u4f4e\u5230\u9ad8\u8003\u8651\u5230\u7b2c $i$ \u4f4d\uff0c\u603b\u548c\u5728\u7b2c $i$ \u4f4d\u8fd9\u91cc\u8fdb\u7684\u4f4d\u662f $j$\uff0c\u6240\u6709\u65b9\u6848\u7684\u5f02\u6216\u662f\u591a\u5c11\u3002\u5982\u679c\u8fd9\u4e00\u4f4d\u662f 1 \u8f6c\u79fb\u5c31\u679a\u4e3e\u8fd9\u4e2a 1 \u5206\u914d\u7ed9\u54ea\u4e2a $A$\uff0c\u7136\u540e\u4e3a\u4e86 $f$ \u80fd\u591f\u8f6c\u79fb\u8fd8\u8981\u8bb0\u4e00\u4e0b\u6a21 2 \u4e0b\u7684\u65b9\u6848\u6570 $g$\uff0e\n\n\u6ce8\u610f\u5230 $j$ \u7684\u4e0a\u754c\u662f $\\sum_{i\\geq 1} \\lfloor\\frac{A}{2^i}\\rfloor=\\mathcal{O}(A)$\uff0c\u90a3\u4e48\u65f6\u95f4\u590d\u6742\u5ea6\u662f $\\mathcal{O}(NA\\log K)$\uff0e\n\n\u8865\u4e00\u4e0b\u4e2d\u95f4\u90a3\u4e2a\u8bc1\u660e\uff1a\n\n$v_2(n!)=\\sum_{i\\geq 1}\\lfloor\\frac{n}{2^i}\\rfloor$\uff0c\u4ee4 $\\lfloor\\frac{n}{2^i}\\rfloor=S_i(n)$\uff0e\n\n$v_2(\\frac{n!}{c_1!c_2!\\cdots})=\\sum_{i\\geq 1}S_i(n)-S_i(c_1)-S_i(c_2)-\\cdots$\uff0e\n\n\u90a3\u4e48 $S_i(n)$ \u5b9e\u9645\u610f\u4e49\u4e3a $n$ \u622a\u53d6\u6700\u5e95 $i$ \u4e2a\u4e8c\u8fdb\u5236\u4f4d\u4e4b\u540e\u7684\u503c\u3002\n\n$\\sum_{j}S_i(c_j)$ \u5b9e\u9645\u4e3a\u6240\u6709 $c$ \u4ec5\u770b\u9664\u53bb\u6700\u5e95 $i$ \u4e2a\u4e8c\u8fdb\u5236\u4f4d\u4e4b\u540e\u7684\u503c\u518d\u6c42\u548c\u3002\n\n$n=\\sum_j c_j$\uff0c\u90a3\u4e48 $S_i(n)-\\sum_{j}S_i(c_j)$ \u5373\u4e3a\u201c\u6240\u6709 $c$ \u4ec5\u770b\u6700\u5e95 $i$ \u4e2a\u4e8c\u8fdb\u5236\u4f4d\u6c42\u548c\u540e\u518d\u622a\u6389\u6700\u5e95 $i$ \u4f4d\u201d\uff0c\u4e5f\u5c31\u662f\u5728\u7b2c $i$ \u4f4d\u8fdb\u4e86\u591a\u5c11\u4f4d\u3002\n\n```cpp\n#include<cstdio>\n#include<vector>\n#include<queue>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\n#include<ctime>\n#include<random>\n#include<assert.h>\n#define pb emplace_back\n#define mp make_pair\n#define fi first\n#define se second\n#define dbg(x) cerr<<\"In Line \"<< __LINE__<<\" the \"<<#x<<\" = \"<<x<<'\\n';\n#define dpi(x,y) cerr<<\"In Line \"<<__LINE__<<\" the \"<<#x<<\" = \"<<x<<\" ; \"<<\"the \"<<#y<<\" = \"<<y<<'\\n';\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int>pii;\ntypedef pair<ll,int>pli;\ntypedef pair<ll,ll>pll;\ntypedef pair<int,ll>pil;\ntypedef vector<int>vi;\ntypedef vector<ll>vll;\ntypedef vector<pii>vpii;\ntypedef vector<pil>vpil;\ntemplate<typename T>T cmax(T &x, T y){return x=x>y?x:y;}\ntemplate<typename T>T cmin(T &x, T y){return x=x<y?x:y;}\ntemplate<typename T>\nT &read(T &r){\n\tr=0;bool w=0;char ch=getchar();\n\twhile(ch<'0'||ch>'9')w=ch=='-'?1:0,ch=getchar();\n\twhile(ch>='0'&&ch<='9')r=r*10+(ch^48),ch=getchar();\n\treturn r=w?-r:r;\n}\ntemplate<typename T1,typename... T2>\nvoid read(T1 &x,T2& ...y){read(x);read(y...);}\nconst int mod=998244353;\ninline void cadd(int &x,int y){x=(x+y>=mod)?(x+y-mod):(x+y);}\ninline void cdel(int &x,int y){x=(x-y<0)?(x-y+mod):(x-y);}\ninline int add(int x,int y){return (x+y>=mod)?(x+y-mod):(x+y);}\ninline int del(int x,int y){return (x-y<0)?(x-y+mod):(x-y);}\nint qpow(int x,int y){\n\tint s=1;\n\twhile(y){\n\t\tif(y&1)s=1ll*s*x%mod;\n\t\tx=1ll*x*x%mod;\n\t\ty>>=1;\n\t}\n\treturn s;\n}\nll bit(int x){\n\treturn 1ll<<x;\n}\nconst int N=1010;\nint n;\nll k,a[N];\nll f[41][N];\nint g[41][N];\nsigned main(){\n\t#ifdef do_while_true\n//\t\tassert(freopen(\"data.in\",\"r\",stdin));\n//\t\tassert(freopen(\"data.out\",\"w\",stdout));\n\t#endif\n\tread(n,k);\n\tfor(int i=1;i<=n;i++)read(a[i]);\n\tg[0][0]=1;\n\tfor(int i=0;i<40;i++)\n\t\tfor(int j=0;j<=1000;j++)\n\t\t\tif(f[i][j]||g[i][j]){\n\t\t\t\tauto zy=[&](int v){\n\t\t\t\t\tf[i+1][v/2]^=f[i][j];\n\t\t\t\t\tg[i+1][v/2]^=g[i][j];\n\t\t\t\t\tif((v&1) && g[i][j])\n\t\t\t\t\t\tf[i+1][v/2]^=bit(i);\n\t\t\t\t};\n\t\t\t\tif(bit(i)&k){\n\t\t\t\t\tfor(int o=1;o<=n;o++)\n\t\t\t\t\t\tzy(j+a[o]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tzy(j);\n\t\t\t}\n\tll ans=0;\n\tfor(int j=0;j<=1000;j++){\n\t\tans^=f[40][j];\n\t\tif(g[40][j])\n\t\t\tans^=(1ll*j)<<40;\n\t}\n\tcout << ans << '\\n';\n    #ifdef do_while_true\n\t\tcerr<<'\\n'<<\"Time:\"<<1.0*clock()/CLOCKS_PER_SEC*1000<<\" ms\"<<'\\n';\n\t#endif\n\treturn 0;\n}\n```",
        "postTime": 1680005145,
        "uid": 223298,
        "name": "do_while_true",
        "ccfLevel": 8,
        "title": "\u300c\u9898\u89e3\u300dARC156D Xor Sum 5"
    },
    {
        "content": "### \u9898\u610f\u7b80\u8ff0\n\n\u7ed9\u5b9a $N$ \u4e2a\u6570\u7684\u6570\u5217 $A$ \u548c\u4e00\u4e2a\u6574\u6570 $K$\u3002\n\n\u5bf9\u4e8e\u6240\u6709\u957f\u5ea6\u4e3a $K$\uff0c\u503c\u57df\u4e3a $[1,N]$ \u7684\u6570\u5217 $p$\uff0c\u6c42\u51fa $\\sum _{i=1}^{K} a_{p_i}$ \u7684\u5f02\u6216\u548c\u3002\n\n- $ 1\\ \\leq\\ N\\ \\leq\\ 1000 $\n- $ 1\\ \\leq\\ K\\ \\leq\\ 10^{12} $\n- $ 0\\ \\leq\\ a_i\\ \\leq\\ 1000 $\n\n### \u601d\u8def\u5206\u6790\n\u501f\u52a9\u751f\u6210\u51fd\u6570\u63cf\u8ff0\u9898\u610f\uff0c\u5373\u6211\u4eec\u9700\u8981\u6c42\u51fa $\\bigoplus S$ \uff0c\u5176\u4e2d $[x^S](x^{a_1}+x^{a_2}+\u2026+x^{a_n})^K \\bmod 2=1$\u3002\u8bbe $K$ \u5728\u4e8c\u8fdb\u5236\u4e0b\u5206\u89e3\u4e3a $M$ \u4f4d\uff0c\u5373 $K=\\sum_{i=1}^{M} 2^{k_i}$\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5f0f\u5b50\u6539\u5199\u6210\uff1a\n$$\n[x^S]\\prod_{m=1}^{M} (x^{a_1}+x^{a_2}+\u2026+x^{a_n})^{2^{k_m}} \\bmod 2 =1\n$$\n\n\u518d\u8003\u8651\u4e00\u4e2a\u7ecf\u5178\u5f0f\u5b50\uff1a\n$$\n(x_1+x_2+\u2026+x_n)^2\\equiv x_1^2+x_2^2+\u2026+x_n^2 (\\bmod 2)\n$$\n\n\u53cd\u590d\u5957\u7528\u8fd9\u4e00\u5f0f\u5b50\uff0c\u6211\u4eec\u5f97\u5230\uff1a\n\n$$\n(x_1+x_2+\u2026+x_n)^{2^t} \\equiv x_1^{2^t}+x_2^{2^t}+\u2026+x_n^{2^t} (\\bmod 2)\n$$\n\n\u6240\u4ee5\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u4e0a\u8ff0\u5f0f\u5b50\u5316\u4e3a\uff1a\n\n$$[x^S]\\prod_{m=1}^{M} (x^{a_1 2^{k_m}}+x^{a_2 2^{k_m}}+\u2026+x^{a_n 2^{k_m}}) \\bmod 2 =1$$\n\n\u518d\u5c06\u8fd9\u4e00\u5f0f\u5b50\u7684\u542b\u4e49\u8fdb\u884c\u7ffb\u8bd1\uff0c\u8fd9\u76f8\u5f53\u4e8e\u6211\u4eec\u8fdb\u884c $M$ \u6b21\u9009\u62e9\uff0c\u6bcf\u6b21\u9009\u62e9 $a$ \u4e2d\u7684\u4e00\u4e2a\u6570\uff0c\u8bbe\u7b2c $i$ \u6b21\u9009\u62e9 $a_{X_i}$\uff0c\u90a3\u4e48\u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u6709\u5947\u6570\u79cd\u9009\u62e9\u5e8f\u5217\u4f7f\u5f97 $\\sum_{m=1}^M a_{X_m}2^{k_m}=S$\uff0c\u6b64\u65f6 $S$ \u662f\u4e00\u4e2a\u6709\u6548\u7684\u7ed3\u679c\uff0c\u518d\u5c06\u6240\u6709\u7684\u6709\u6548\u7b54\u6848\u5f02\u6216\u8d77\u6765\u5373\u4e3a\u7b54\u6848\u3002\n\n\u8003\u8651\u600e\u4e48\u5b8c\u6210\u6709\u6548\u7b54\u6848\u5f02\u6216\u7684\u8fc7\u7a0b\uff0c\u6211\u4eec\u8003\u5bdf\u5bf9\u4e8e\u6bcf\u4e00\u4f4d\uff0c\u6709\u591a\u5c11\u79cd\u9009\u62e9\u5e8f\u5217\u4f7f\u5f97\u5176\u6700\u7ec8\u7684 $S$ \u5728\u8fd9\u4e00\u4f4d\u4e3a $1$\u3002\u90a3\u4e48\uff0c\u5982\u679c\u6709\u5947\u6570\u79cd\uff0c\u90a3\u4e48\u6700\u7ec8\u7b54\u6848\u5728\u8fd9\u4e00\u4f4d\u4e0a\u5c31\u662f $1$\u3002\u6211\u4eec\u4ece\u5c0f\u5230\u5927\u8003\u5bdf\u6bcf\u4e00\u4f4d $i$\uff0c\u52a8\u6001\u7edf\u8ba1\u5bf9\u4e8e\u54ea\u4e9b $S$\uff0c\u6784\u6210\u5b83\u4eec\u7684\u9009\u62e9\u5e8f\u5217\u79cd\u6570\u5728\u8fd9\u4e00\u4f4d\u4e0a\u662f $1$\u3002\u6211\u4eec\u76f4\u63a5\u5c06 $S$ \u62b9\u53bb\u540e $i$ \u4f4d\u7684\u7ed3\u679c\u5b58\u5728\u4e00\u4e2a\u96c6\u5408\u4e2d\uff0c\u6bcf\u632a\u52a8\u4e00\u4f4d\u5c06\u96c6\u5408\u5185\u6240\u6709\u6570\u53f3\u79fb\u4e00\u4f4d\uff0c\u5bf9\u4e8e\u6bcf\u4e00\u6b21\u9009\u62e9\uff0c\u6211\u4eec\u76f4\u63a5\u66b4\u529b\u679a\u4e3e\u5bf9\u4e8e\u6bcf\u4e00\u4e2a\u5b58\u5728\u4e8e\u96c6\u5408\u4e2d\u7684 $S$\uff0c\u5176\u5728\u8fd9\u4e00\u8f6e\u9009\u62e9\u4e86\u54ea\u4e00\u4e2a\u6570\uff0c\u7136\u540e\u66f4\u65b0\u96c6\u5408\u3002\u5728\u8fd9\u91cc\uff0c\u5982\u679c\u67d0\u4e2a $S$ \u7684\u9009\u62e9\u5e8f\u5217\u79cd\u6570\u4e3a\u5076\u6570\uff0c\u663e\u7136\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u89c6\u4e3a\u8fd9\u4e00\u4e2a $S$ \u5b8c\u5168\u6ca1\u6709\u51fa\u73b0\u8fc7\uff0c\u8fd9\u662f\u56e0\u4e3a\u5b83\u4eec\u5bf9\u4e8e\u540e\u7eed\u7b54\u6848\u4ea7\u751f\u7684\u8d21\u732e\u4e00\u5b9a\u4e3a $0$\u3002\u540c\u65f6\u8fd8\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5982\u679c\u5728\u8003\u5bdf\u5230\u67d0\u4e00\u6b21\u9009\u62e9\u4e4b\u540e\uff0c\u67d0\u4e00\u4f4d\u4e0a\u662f $1$\uff0c\u867d\u7136\u540e\u7eed\u9009\u62e9\u90fd\u4e0d\u4f1a\u6539\u53d8\u6bcf\u4e00\u4e2a\u64cd\u4f5c\u5e8f\u5217\u5bfc\u51fa\u7684 $S$ \u5728\u8fd9\u4e00\u4f4d\u4e0a\u7684\u503c\uff0c\u4f46\u662f\u4e0d\u80fd\u5fd8\u8bb0\u6bcf\u4e00\u4e2a\u64cd\u4f5c\u5e8f\u5217\u90fd\u8fd8\u4f1a\u5206\u88c2\u6210\u8bb8\u8bb8\u591a\u591a\u4e2a\u4e0d\u540c\u7684\u64cd\u4f5c\u5e8f\u5217\u3002\u8bbe\u8fd8\u9700\u7ecf\u8fc7 $T$ \u8f6e\uff0c\u90a3\u4e48\u6700\u540e\u5b83\u4f1a\u53d8\u6210 $N^T$ \u79cd\u9009\u62e9\u5e8f\u5217\u3002\u56e0\u6b64\uff0c\u7b54\u6848\u67d0\u4e00\u4f4d\u662f $1$ \u7684\u5145\u8981\u6761\u4ef6\u5176\u5b9e\u5305\u542b\u4e24\u70b9\uff1a1\uff09\u6709\u5947\u6570\u79cd\u9009\u62e9\u5e8f\u5217\u4f7f\u5f97\u5176\u5f53\u524d $S$ \u5728\u8fd9\u4e00\u4f4d\u4e3a $1$\u30022\uff09 $N^T$ \u662f\u5947\u6570\u3002\n\n\u5173\u4e8e\u96c6\u5408\u5927\u5c0f\uff0c\u5bb9\u6613\u53d1\u73b0\u6bcf\u6b21\u66f4\u65b0\u65f6\u53ea\u4f1a\u5c06\u96c6\u5408\u5185\u5df2\u7ecf\u5b58\u5728\u7684\u5143\u7d20\u52a0\u4e0a\u4e00\u4e2a $a_i$\uff0c\u800c\u6bcf\u632a\u52a8\u4e00\u4f4d\uff0c\u96c6\u5408\u91cc\u6240\u6709\u6570\u90fd\u4f1a\u51cf\u534a\u3002\u8fd9\u4e2a\u8fc7\u7a0b\u4fdd\u8bc1\u96c6\u5408\u5185\u6700\u5927\u503c\u4e0d\u4f1a\u8d85\u8fc7 $a$ \u4e2d\u6700\u5927\u503c\u7684\u4e24\u500d\u3002\u56e0\u6b64\uff0c\u96c6\u5408\u5927\u5c0f\u4e0e $N$ \u540c\u9636\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(N^2\\log K)$\uff0c\u501f\u52a9 bitset \u4f18\u5316\u53ef\u4ee5\u964d\u4f4e\u5e38\u6570\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nbitset<3000>A,S,T;\nsigned main(){\n\tint n,k,a;\n\tcin>>n>>k;\n\tfor(int i=1;i<=n;i++){\n\t\tscanf(\"%lld\",&a);\n\t\tA.flip(a);\n\t}\n\tint ans=0;\n\tS[0]=1;\n\tfor(int i=0;i<=60;i++){\n\t\tT.reset();\n\t\tfor(int j=0;j<=2000;j++) if(S[j]) T.flip(j>>1); \n\t\tS=T;\n\t\tif(k&1){\n\t\t\tT.reset();\n\t\t\tfor(int j=0;j<=2000;j++) if(S[j]) T^=A<<j;\n\t\t\tS=T;\n\t\t}\n\t\tk>>=1;\n\t\tint c=0;\n\t\tfor(int j=1;j<=2000;j+=2) if(S[j]) c^=1;\n\t\tif(c&&((n&1)||(!k))) ans^=1ll<<i;\n\t}\n\tcout<<ans;\n\treturn 0;\n}\n\n```",
        "postTime": 1684155019,
        "uid": 455093,
        "name": "Schi2oid",
        "ccfLevel": 7,
        "title": "Xor Sum 5 \u9898\u89e3"
    }
]
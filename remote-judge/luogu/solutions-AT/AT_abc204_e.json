[
    {
        "content": "[Rush Hour 2](https://www.luogu.com.cn/problem/AT_abc204_e)\n\n### \u9898\u76ee\u5927\u610f\n\n\u7ed9\u5b9a\u4e00\u5f20\u65e0\u5411\u56fe\uff0c\u8fb9\u5e26\u4e24\u4e2a\u53c2\u6570 $c_i,d_i$\uff0c\u5728 $t$ \u65f6\u95f4\u65f6\u7ecf\u8fc7\u7b2c $i$ \u6761\u8fb9\u6240\u9700\u7684\u65f6\u95f4\u662f $c_i+\\lfloor\\frac{d_i}{t+1}\\rfloor$\uff0c\u6c42\u5728\u65f6\u95f4 $0$ \u65f6\u51fa\u53d1\uff0c\u5728\u6bcf\u4e2a\u70b9\u53ef\u4ee5\u505c\u7559\u975e\u8d1f\u6574\u6570\u65f6\u95f4\uff0c\u4ece\u70b9 $1$ \u5230\u70b9 $n$ \u6240\u9700\u7684\u6700\u77ed\u65f6\u95f4\u3002\n\n### \u601d\u8def\u5206\u6790\n\n\u9996\u5148\uff0c\u5bb9\u6613\u53d1\u73b0\u5728\u65f6\u95f4 $t$ \u65f6\u7ecf\u8fc7\u7b2c $i$ \u6761\u8fb9\u540e\u7684\u603b\u65f6\u95f4\u662f\uff1a$t+c_i+\\lfloor\\frac{d_i}{t+1}\\rfloor$\u3002\n\n\u90a3\u4e48\u4e0d\u59a8\u8bbe\u51fd\u6570 $f(t)=t+c_i+\\lfloor\\frac{d_i}{t+1}\\rfloor$\uff0c\u7531\u5747\u503c\u4e0d\u7b49\u5f0f\u5bb9\u6613\u5f97 $f(t)_{\\min}=f(\\sqrt{d_i}-1)$\u3002\n\n\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53\u6211\u4eec\u60f3\u7ecf\u8fc7\u67d0\u4e00\u6761\u8fb9\u65f6\uff0c\u5982\u679c\u5f53\u524d\u65f6\u95f4\u5927\u4e8e $\\sqrt {d_i}-1$\uff0c\u90a3\u4e48\u4e0d\u7528\u7b49\u5f85\u76f4\u63a5\u901a\u8fc7\uff0c\u5426\u5219\u7b49\u5230 $\\sqrt{d_i}-1$ \u65f6\u518d\u901a\u8fc7\u3002\n\n\u90a3\u4e48\u5c31\u53ef\u4ee5\u4f7f\u7528\u666e\u901a\u7684 Dijkstra \u89e3\u51b3\u4e86\u3002\n\n### \u4ee3\u7801\n\n```\n#include <iostream>\n#include <cmath>\n#include <cstring>\n#include <algorithm>\n#include <queue>\n\nusing namespace std;\n#define int long long\nconst int N=200100;\n\nint n,m,idx=1,in1,in2,in3,in4;\nint to[N],nxt[N],head[N];\nint fa[N],vis[N];\nint dis[N],c[N],d[N];\n\nint find(int x){return fa[x]==x?x:fa[x]=find(fa[x]);}\n\nvoid add(int u,int v,int x,int y){\n    idx++;to[idx]=v;nxt[idx]=head[u];head[u]=idx;c[idx]=x;d[idx]=y;\n}\n\nstruct Node{\n    int x,time;\n    bool operator < (const Node &b) const{\n        return time>b.time;\n    }\n}now;\n\npriority_queue <Node> q;\n\nvoid Dijkstra(){\n    memset(dis,0x3f,sizeof dis);\n    dis[1]=0;q.push(Node{1,0});\n    while(!q.empty()){\n        now=q.top();q.pop();\n        if(vis[now.x]) continue;\n        vis[now.x]=1;\n        for(int i=head[now.x];i;i=nxt[i]){\n            int v=to[i],t;\n            if(now.time<=round(sqrt(d[i]))-1) t=round(sqrt(d[i]))-1;\n            else t=now.time; //\u5224\u65ad\u901a\u8fc7\u65f6\u95f4\n            if(dis[v]>t+c[i]+d[i]/(t+1)){\n                dis[v]=t+c[i]+d[i]/(t+1);\n                q.push(Node{v,dis[v]});\n            }\n        }\n    }\n}\n\nsigned main(){\n    scanf(\"%lld%lld\",&n,&m);\n    for(int i=1;i<=n;i++) fa[i]=i;\n    for(int i=1;i<=m;i++){\n        scanf(\"%lld%lld%lld%lld\",&in1,&in2,&in3,&in4);\n        add(in1,in2,in3,in4);add(in2,in1,in3,in4);\n        fa[find(in1)]=find(in2);\n    }\n    if(find(1)!=find(n)){cout<<\"-1\\n\";return 0;}//\u5e76\u67e5\u96c6\u5224\u8fde\u901a\n    Dijkstra();\n    cout<<dis[n]<<'\\n';\n    return 0;\n}\n```",
        "postTime": 1685361742,
        "uid": 986683,
        "name": "_Ponder_",
        "ccfLevel": 0,
        "title": "[ABC204E] Rush Hour 2 \u9898\u89e3"
    },
    {
        "content": "\u9996\u5148\u8003\u8651\u53ea\u6709\u4e00\u6761\u8fb9\u7684\u60c5\u51b5\u600e\u4e48\u505a\u3002\n\n\u8bbe\u5230\u8fbe $ b $ \u7684\u65f6\u523b\u4e3a $ x $\uff0c\u4e0d\u96be\u53d1\u73b0\u7b54\u6848\u4e3a $ f(x)=c+x+\\frac{d}{x+1} $\uff0c\u5176\u4e2d $ c $ \u4e3a\u5e38\u6570\u4e0d\u5f71\u54cd\u7b54\u6848\u3002\n\n\u4e8e\u662f\u95ee\u9898\u8f6c\u5316\u4e3a\u6700\u5927\u5316 $ x+\\frac{d}{x+1} $\uff0c\u8fd9\u662f\u7ecf\u5178\u7684\u57fa\u672c\u4e0d\u7b49\u5f0f\uff0c\u663e\u7136\u539f\u5f0f\u7b49\u4ef7\u4e8e $ (x+1)+\\frac{d}{x+1}-1 $\uff0c$ -1 $ \u662f\u5e38\u6570\u5ffd\u7565\uff0c\u6240\u4ee5\u6700\u5927\u5316 $ (x+1)+\\frac{d}{x+1} $ \u7684\u503c\u3002\u8bbe $ y=x+1 $\uff0c\u5219\u6709\u539f\u5f0f\u7b49\u4e8e $ y+\\frac{d}{y} $\uff0c\u7531\u57fa\u672c\u4e0d\u7b49\u5f0f\u53ef\u5f97 $ y^2=d,y=\\sqrt{d},x=\\sqrt{d}-1 $\u3002\n\n\u4e8e\u662f\u6211\u4eec\u91c7\u53d6\u7684\u7b56\u7565\u662f\uff1a\u5f53\u5230\u8fbe\u70b9 $ a $ \u7684\u65f6\u5019\u8981\u4e48\u7b49\u5230 $ \\sqrt{d}-1 $ \u7684\u65f6\u5019\u518d\u51fa\u53d1\uff0c\u8981\u4e48\u76f4\u63a5\u8dd1\u8def\u3002\n\n\u4e8e\u662f\u95ee\u9898\u8f6c\u5316\u4e3a\u5e73\u51e1\u7684\u6700\u77ed\u8def\uff0c\u53ea\u8981\u5728 Dijkstra \u8f6c\u79fb\u7684\u65f6\u5019\u5224\u4e00\u4e0b dis \u5373\u53ef\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $ \\mathcal{O}(m\\log{m}) $\uff0c\u53ef\u4ee5\u901a\u8fc7\u3002\n\n\u4ee3\u7801\uff1a\n\n```cpp\n#include <bits/stdc++.h>\n#define rep(i,n) for(ll i=0;i<n;i++)\nusing namespace std;\n#define all(a) a.begin(),a.end()\ntypedef long long ll;\ntypedef pair<ll,ll> P;\ntypedef pair<P,ll>PP;\nconstexpr ll inf=1e17;\nconstexpr ll mod=998244353;\nstruct edge\n{\n\tll to,c,d;\n};\nll dist[100005];\nvector<edge>G[100005];\nint main()\n{\n\tint n,m;\n\tcin>>n>>m;\n\trep(i,m)\n\t{\n\t\tll a,b,c,d;cin>>a>>b>>c>>d;\n\t\ta--;b--;\n\t\tG[a].push_back({b,c,d});\n\t\tG[b].push_back({a,c,d});\n\t}\n\tpriority_queue<P,vector<P>,greater<P>>Q;\n\tQ.push(P(0,0));\n\trep(i,n)\n\tdist[i]=inf;\n\tdist[0]=0;\n\twhile(Q.size())\n\t{\n\t\tP p=Q.top();\n\t\tQ.pop();\n\t\tint v=p.second;\n\t\tif(dist[v]<p.first)\n\t\tcontinue;\n\t\tfor(auto e:G[v])\n\t\t{\n\t\t\tll w=(sqrt(e.d)-(dist[v]+1));\n\t\t\tif(w<0)\n\t\t\tw=0;\n\t\t\trep(i,2)\n\t\t\t{\n\t\t\t\tll nc=dist[v]+e.c+e.d/(dist[v]+w+1)+w;\n\t\t\t\tif(dist[e.to]>nc)\n\t\t\t\t{\n\t\t\t\t\tdist[e.to]=nc;\n\t\t\t\t\tQ.push(P(nc,e.to));\n\t\t\t\t}\n\t\t\t\tw++;\n\t\t\t}\n\t\t}\n\t}\n\tif(dist[n-1]==inf)\n\tcout<<-1;\n\telse \n\tcout<<dist[n-1];\n}\n```\n",
        "postTime": 1672228934,
        "uid": 714821,
        "name": "loser_seele",
        "ccfLevel": 4,
        "title": "ABC204E\u9898\u89e3"
    }
]
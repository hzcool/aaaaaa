[
    {
        "content": "\u8003\u8651\u5bb9\u65a5\u3002\n\n\u8bbe $F(i)$ \u8868\u793a\u81f3\u5c11\u6709 $i$ \u4e2a\u6570\u7684\u51fa\u73b0\u6b21\u6570\u4e0d\u591a\u4e8e $1$ \u6b21\u3002\n\n\u5219\u7b54\u6848\u4e3a\uff1a\n$$\\sum\\limits_{i=0}^n(-1)^iF(i)$$\n\u679a\u4e3e $j$,\u8868\u793a\u5c06\u8fd9 $i$ \u4e2a\u6570\u5212\u5206\u5230 $j$ \u4e2a\u975e\u7a7a\u96c6\u5408\u4e2d\u3002\u4f46\u662f\u7531\u4e8e\u9650\u5236\u662f\u4e0d\u591a\u4e8e\u4e00\u6b21\uff0c\u610f\u5473\u7740\u53ef\u80fd\u5b58\u5728\u4e00\u4e9b\u6570\u6ca1\u6709\u51fa\u73b0\u8fc7\u3002\n\n\u5982\u4f55\u89e3\u51b3\u5462\uff1f\u6211\u4eec\u8003\u8651\u65b0\u52a0\u5165\u4e00\u4e2a\u96c6\u5408\u5f53\u505a\u201c\u5783\u573e\u5806\u201d\uff0c\u8be5\u96c6\u5408\u4e2d\u7684\u6570\u5373\u4e3a\u6ca1\u6709\u51fa\u73b0\u7684\u6570\u3002\u4f46\u662f\u8fd8\u6709\u4e00\u4e2a\u95ee\u9898\uff1a\u201c\u5783\u573e\u5806\u201d\u53ef\u80fd\u4e3a\u7a7a\u3002\u6240\u4ee5\u6211\u4eec\u65b0\u52a0\u5165\u4e00\u4e2a\u6570\u5b57 $0$\uff0c$0$ \u6240\u5728\u96c6\u5408\u5373\u4e3a\u5783\u573e\u5806\u3002\n\n\u4e8e\u662f\u5c06 $i$ \u4e2a\u6570\u5212\u5206\u5230 $j$ \u4e2a\u975e\u7a7a\u96c6\u5408\u7684\u65b9\u6848\u6570\u4e3a $\\begin{Bmatrix}\ni+1\\\\j+1\n\\end{Bmatrix}$\u3002\n\n\u7136\u540e\u8003\u8651\u5269\u4e0b\u6765\u7684 $n-i$ \u4e2a\u6570\u53ef\u4ee5\u5f62\u6210 $2^{n-i}$ \u4e2a\u96c6\u5408\u3002\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u8fd9\u4e9b\u96c6\u5408\u6709\u6ca1\u6709\u88ab\u9009\u62e9\uff0c\u90a3\u4e48\u65b9\u6848\u6570\u5c31\u662f $2^{2^{n-i}}$\u3002\u6700\u540e\uff0c\u5269\u4e0b\u7684 $n-i$ \u4e2a\u6570\u8fd8\u53ef\u4ee5\u5f80\u4e4b\u524d\u7684 $j$ \u4e2a\u96c6\u5408\u91cc\u9762\u653e\uff0c\u6240\u4ee5\u518d\u4e58\u4e0a $(2^{n-i})^j$\u3002\n\n\u4e8e\u662f\u7b54\u6848\u4e3a\uff1a\n$$\\sum\\limits_{i=0}^n(-1)^iF(i)$$\n$$=\\sum\\limits_{i=0}^n(-1)^i\\begin{pmatrix}n\\\\i\\end{pmatrix}\\sum\\limits_{j=0}^i\\begin{Bmatrix}i+1\\\\j+1\\end{Bmatrix}\\cdot 2^{2^{n-i}}\\cdot (2^{n-i})^j$$\n$$=\\sum\\limits_{i=0}^n(-1)^i\\cdot 2^{2^{n-i}}\\begin{pmatrix}n\\\\i\\end{pmatrix}\\sum\\limits_{j=0}^i\\begin{Bmatrix}i+1\\\\j+1\\end{Bmatrix}\\cdot (2^{n-i})^j$$\n\n```cpp\n#include<cctype>\n#include<cstdio>\nusing namespace std;\n#define getchar() (SS == TT && (TT = (SS = BB) + fread(BB,1,1 << 15,stdin),TT == SS) ? EOF : *SS++)\nchar BB[1 << 15],*SS = BB,*TT = BB;\ninline int read()\n{\n\tregister int x = 0;\n\tregister char ch = getchar();\n\tfor(;!isdigit(ch);ch = getchar());\n\tfor(;isdigit(ch);ch = getchar())\n\t\tx = x * 10 + (ch ^ 48);\n\treturn x;\n}\ninline void print(int x)\n{\n\tchar ch = x % 10 + '0';\n\tif(x > 9)\n\t\tprint(x / 10);\n\tputchar(ch);\n}\n\nint mod;\ninline int add(int a,int b)\n{\n\ta += b;\n\treturn a >= mod ? a - mod : a;\n}\ninline int qpow(long long a,int b,int p = mod)\n{\n\tregister long long ans = 1;\n\twhile(b)\n\t{\n\t\tif(b & 1) ans = ans * a % p;\n\t\ta = a * a % p,b >>= 1;\n\t}\n\treturn ans;\n}\n\nconst int N = 3010;\nint n;\nlong long s[N][N],c[N][N],ans;\n\ninline void init()\n{\n\tc[0][0] = s[0][0] = 1;\n\tfor(register int i = 1;i <= n + 1;i++)\n\t{\n\t\tc[i][0] = 1;\n\t\tfor(register int j = 1;j <= i;j++)\n\t\t\ts[i][j] = (s[i - 1][j - 1] + s[i - 1][j] * j) % mod,\n\t\t\tc[i][j] = add(c[i - 1][j - 1],c[i - 1][j]);\n\t}\n}\n\nint main()\n{\n\tn = read(),mod = read();\n\tinit();\n\n\tfor(register int i = 0;i <= n;i++)\n\t{\n\t\tregister long long _2 = qpow(2,n - i);\n\n\t\tlong long mul = i & 1 ? mod - 1 : 1,res = 0;\n\t\tmul = mul * c[n][i] % mod * qpow(2,qpow(2,n - i,mod - 1)) % mod;\n\n\t\tregister long long _2j = 1;\n\t\tfor(register int j = 0;j <= i;j++)\n\t\t\tres = (res + s[i + 1][j + 1] * _2j) % mod,\n\t\t\t_2j = _2j * _2 % mod;\n\n\t\tans = (ans + res * mul) % mod;\n\t}\n\tprint(ans);\n}\n```",
        "postTime": 1582016621,
        "uid": 53994,
        "name": "81179332_",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 AT4119 \u3010[ARC096C] Everything on It\u3011"
    },
    {
        "content": "\u5ba3\u4f20\u4e00\u6ce2 [blog](https://www.cnblogs.com/maoyiting/)~\n\n### Solution\n\n\u5bb9\u65a5\uff0c\u94a6\u5b9a $i$ \u4e2a\u6570 $\\leq 1$ \u6b21\u3002\n$$\nAns=\\sum_{i=0}^n (-1)^i\\binom{n}{i}F(i)\n$$\n\u5176\u4e2d $F(i)$ \u8868\u793a\u6709 $i$ \u4e2a\u6570\u7684\u51fa\u73b0\u6b21\u6570 $\\leq 1$ \u6b21\uff0c\u5269\u4f59 $n-i$ \u4e2a\u6570\u968f\u610f\u7684\u65b9\u6848\u6570\u3002\n\n\u65b9\u4fbf\u8d77\u89c1\uff0c\u4e0d\u59a8\u8bbe\u8fd9 $i$ \u4e2a\u6570\u4e3a $1,2,\\cdots,i$\u3002\u53ef\u4ee5\u628a\u6240\u6709\u5b50\u96c6\u65cf\u4e2d\u7684\u5b50\u96c6\u5206\u6210\u4e24\u7c7b\uff1a\n\n1. \u542b\u6709 $1,2,\\cdots,i$ \u4e2d\u81f3\u5c11\u4e00\u4e2a\n2. \u4e0d\u542b\n\n\u5148\u8003\u8651\u7b2c $2$ \u7c7b\u3002\u6ca1\u6709\u4efb\u4f55\u9650\u5236\u6761\u4ef6\uff0c\u5269\u4f59\u7684 $n-i$ \u4e2a\u6570\u968f\u4fbf\u9009\uff0c\u6784\u6210 $2^{n-i}$ \u4e2a\u5b50\u96c6\uff0c\u6bcf\u4e2a\u5b50\u96c6\u8981\u4e48\u9009\u8981\u4e48\u4e0d\u9009\uff0c\u90a3\u4e48\u6709 $2^{2^{n-i}}$ \u4e2a\u5b50\u96c6\u65cf\u3002\n\n\u518d\u6765\u8003\u8651\u7b2c\u4e00\u7c7b\u3002\u679a\u4e3e $k$\uff0c\u8868\u793a\u7b2c\u4e00\u7c7b\u96c6\u5408\u7684\u4e2a\u6570\u3002$1,2,\\cdots,i$ \u8fd9 $i$ \u4e2a\u6570\u8981\u4e48\u4e0d\u51fa\u73b0\u8981\u4e48\u53ea\u51fa\u73b0\u4e00\u6b21\uff0c\u76f8\u5f53\u4e8e\u6709 $i$ \u4e2a\u6570\uff0c\u5206\u5165 $k$ \u4e2a\u96c6\u5408\uff0c\u6709\u4e9b\u6570\u53ef\u4ee5\u4e0d\u5206\u3002\u8003\u8651\u518d\u52a0\u4e00\u4e2a\u96c6\u5408\uff08\u201c\u5783\u573e\u5806\u201d\uff09\uff0c\u628a\u4e0d\u5206\u7684\u90a3\u4e9b\u6570\uff08\u5373\u6ca1\u6709\u51fa\u73b0\u7684\u6570\uff09\u4e22\u8fdb\u53bb\u3002\u6709\u4e24\u79cd\u60f3\u6cd5\uff0c\u7ed3\u679c\u662f\u4e00\u6837\u7684\uff1a\n\n- \u5206\u201c\u5783\u573e\u5806\u201d\u662f\u5426\u975e\u7a7a\u8ba8\u8bba\uff0c\u65b9\u6848\u6570\u4e3a $\\begin{Bmatrix}i\\\\k\\end{Bmatrix}+(k+1)\\begin{Bmatrix}i\\\\k+1\\end{Bmatrix}$\uff08\u524d\u9762\u662f\u6240\u6709\u6570\u90fd\u5206\u5165\u96c6\u5408\u4e86\u7684\u65b9\u6848\u6570\uff0c\u540e\u9762\u662f\u6709\u4e9b\u6570\u6ca1\u6709\u5206\uff0c\u4e58\u4ee5 $(k+1)$ \u662f\u56e0\u4e3a\u4e0d\u77e5\u9053\u54ea\u4e2a\u96c6\u5408\u662f\u201c\u5783\u573e\u5806\u201d\uff09\u3002\u53d1\u73b0\u8fd9\u5c31\u662f\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u7684\u9012\u63a8\u5f0f\uff0c\u56e0\u6b64\u65b9\u6848\u6570\u4e3a $\\begin{Bmatrix}i+1\\\\k+1\\end{Bmatrix}$\u3002\n- \u518d\u52a0\u5165\u4e00\u4e2a $0$ \u4e22\u5230\u201c\u5783\u573e\u5806\u201d\uff0c\u4ece\u800c\u4f7f\u5783\u573e\u5806\u975e\u7a7a\uff0c\u4e14 $0$ \u6240\u5728\u7684\u5c31\u662f\u5783\u573e\u5806\u3002\u65b9\u6848\u6570\u4e3a $\\begin{Bmatrix}i+1\\\\k+1\\end{Bmatrix}$\u3002\n\n\u5bf9\u4e8e\u7b2c\u4e00\u7c7b\u7684\u6bcf\u4e2a\u96c6\u5408\u800c\u8a00\uff0c$>i$ \u7684 $n-i$ \u4e2a\u6570\u53ef\u51fa\u73b0\u53ef\u4e0d\u51fa\u73b0\u3002\u56e0\u6b64\u65b9\u6848\u6570\u4e3a $\\begin{Bmatrix}i+1\\\\k+1\\end{Bmatrix}\\cdot (2^{n-i})^k$\u3002\n\n\u5f97\u5230\uff1a\n$$\nF(i)=\\sum_{k=0}^i \\begin{Bmatrix}i+1\\\\k+1\\end{Bmatrix}\\cdot 2^{(n-i)k}\\cdot 2^{2^{n-i}}\n$$\n\uff08\u679a\u4e3e\u7684 $k$ \u662f\u7b2c\u4e00\u7c7b\u96c6\u5408\u7684\u4e2a\u6570\uff09\n\n\u7efc\u4e0a\uff1a\n$$\nAns=\\sum_{i=0}^n (-1)^i\\binom{n}{i}\\times \\sum_{k=0}^i \\begin{Bmatrix}i+1\\\\k+1\\end{Bmatrix}\\cdot 2^{(n-i)k}\\cdot 2^{2^{n-i}}\n$$\n\n\u6ce8\u610f\uff0c$2^{2^{n-i}}\\equiv 2^{2^{n-i}\\bmod (p-1)}\\pmod p$\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define int long long\nusing namespace std;\nconst int N=3e3+5;\nint n,mod,s[N][N],c[N][N],ans;\nint mul(int x,int n,int mod){\n\tint ans=mod!=1;\n\tfor(x%=mod;n;n>>=1,x=x*x%mod)\n\t\tif(n&1) ans=ans*x%mod;\n\treturn ans;\n}\nsigned main(){\n\tscanf(\"%lld%lld\",&n,&mod);\n\tc[0][0]=1,s[0][0]=1;\n\tfor(int i=1;i<=n+1;i++){ \n\t\tc[i][0]=1;\n\t\tfor(int j=1;j<=i;j++){ \n\t\t\tc[i][j]=(c[i-1][j]+c[i-1][j-1])%mod;\n\t\t\ts[i][j]=(s[i-1][j]*j%mod+s[i-1][j-1])%mod;\n\t\t} \n\t} \n\tfor(int i=0;i<=n;i++){\n\t\tint sum=0,p=mul(2,mul(2,n-i,mod-1),mod);\n\t\tfor(int k=0;k<=i;k++)\n\t\t\tsum=(sum+s[i+1][k+1]*mul(2,(n-i)*k,mod)%mod*p)%mod;\n\t\tans=(ans+(i&1?mod-1:1)*c[n][i]%mod*sum%mod)%mod;\n\t}\n\tprintf(\"%lld\\n\",ans);\n\treturn 0;\n} \n```",
        "postTime": 1625284704,
        "uid": 171807,
        "name": "maoyiting",
        "ccfLevel": 7,
        "title": "\u300cARC096C\u300dEverything on It\uff08\u5bb9\u65a5\uff09"
    },
    {
        "content": "\u53d1\u73b0\u8fd9\u4e2a\u6240\u6709\u6570\u51fa\u73b0\u6b21\u6570\u90fd\u5927\u4e8e\u7b49\u4e8e $2$ \u975e\u5e38\u7684\u4e0d\u597d\u641e\u3002\n\n\u8003\u8651\u5bb9\u65a5\uff0c\u8bbe $f_i$ \u8868\u793a\u94a6\u5b9a $i$ \u4e2a\u6570\u51fa\u73b0\u6b21\u6570\u4e0d\u5927\u4e8e $1$ \uff0c\u5176\u4ed6\u6570\u968f\u610f\u7684\u65b9\u6848\u6570\u3002\n\n\u90a3\u4e48\u7b54\u6848\u5c31\u662f $\\sum_{i=0}^{n} (-1)^{i} f_i$\u3002\n\n\u8003\u8651 $f_i$ \u600e\u4e48\u6c42\uff0c\u9996\u5148\u662f\u9009\u51fa $i$ \u4e2a\u6570\u7684\u65b9\u6848\u6570 $\\binom n i $\u3002\n\n\u7136\u540e\u53ef\u4ee5\u53d1\u73b0\u53ea\u6709\u5176\u4ed6\u6570\u7684\u96c6\u5408\u7684\u65b9\u6848\u975e\u5e38\u7b97\uff0c\u5c31\u662f $2^{2^{n-i}}$ \uff0c\u8fd9\u4e2a\u8003\u8651 $n-i$ \u4e2a\u6570\u5f62\u6210\u7684\u96c6\u5408\u4e00\u5171\u6709 $2^{n-i}$ \u4e2a\uff0c\u6bcf\u4e2a\u96c6\u5408\u6709\u51fa\u73b0\u548c\u4e0d\u51fa\u73b0\u4e24\u79cd\u72b6\u6001\uff0c\u4e58\u6cd5\u539f\u7406\u5f88\u5bb9\u6613\u5f97\u51fa\u3002\n\n\u8003\u8651\u600e\u4e48\u8ba1\u7b97\u5305\u542b\u88ab\u94a6\u5b9a\u7684\u6570\u7684\u96c6\u5408\u7684\u65b9\u6848\u6570\uff0c\u53d1\u73b0\u5047\u5982\u6240\u6709\u6570\u90fd\u5fc5\u987b\u51fa\u73b0\u5c31\u662f\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\uff0c\u6240\u4ee5\u53ef\u4ee5\u8003\u8651\u7c7b\u4f3c\u4e8e\u65af\u7279\u6797\u6570\u7684 DP \u3002\n\n\u5177\u4f53\u5c31\u662f\u8bbe $g_{i,j}$ \u8868\u793a $i$ \u4e2a\u6700\u591a\u51fa\u73b0 $1$ \u6b21\u7684\u6570\u653e\u5165\u6070\u597d $j$ \u4e2a\u96c6\u5408\uff08\u4e0d\u80fd\u4e3a\u7a7a\uff09\u7684\u65b9\u6848\u6570\u3002\n\n\u6709\u8f6c\u79fb\u65b9\u7a0b $g_{i,j}=g_{i-1,j-1}+(j+1)g_{i-1,j}$ \uff08\u5176\u5b9e\u5c31\u662f\u6bcf\u4e2a\u6570\u6bd4\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u591a\u4e00\u79cd\u60c5\u51b5\u5c31\u662f\u4e0d\u653e\u5230\u4efb\u4f55\u96c6\u5408\uff0c\u76f4\u63a5\u52a0\u4e0a\u4e00\u4e2a $g_{i-1,j}$ \u5373\u53ef\uff09\u3002\n\n\u7136\u540e\u5c31\u80fd\u5f97\u51fa $f_i=\\sum_{j=0}^{i} 2^{j(n-i)}g_{i,j}$\uff0c\u5176\u4e2d $2^{j(n-i)}$ \u8868\u793a\u8fd9 $j$ \u4e2a\u96c6\u5408\u4e2d\u8fd8\u53ef\u4ee5\u6709\u6ca1\u88ab\u94a6\u5b9a\u7684\u6570\uff0c\u6bcf\u4e2a\u6709 $2^{n-i}$ \u79cd\u9009\u62e9\u3002\n\n\u9884\u5904\u7406 $2^k$ \uff0c\u590d\u6742\u5ea6 $O(n^2)$\u3002\n\n\u6ce8\u610f $2^{2^{n-i}}$ \u8981\u7528\u6b27\u62c9\u5b9a\u7406\u6c42\u3002\n\n$\\sf{Code}$\n\n```cpp\n#include<bits/stdc++.h>\n#define N 2001001\n#define MAX 5005\n#define infe 1e18\nusing namespace std;\ntypedef long long ll;\ntypedef double db;\ninline void read(ll &ret)\n{\n    ret=0;char c=getchar();bool pd=false;\n    while(!isdigit(c)){pd|=c=='-';c=getchar();}\n    while(isdigit(c)){ret=(ret<<1)+(ret<<3)+(c&15);c=getchar();}\n    ret=pd?-ret:ret;\n    return;\n}\nll n,g[MAX][MAX],f[MAX],val1[N],val[N],c[MAX][MAX],ans;\nint p;\ninline ll qpow(ll a,ll b)\n{\n\tll ret=1;\n\twhile(b)\n\t{\n\t\tif(b&1)\n\t\t\tret*=a,ret%=p;\n\t\tb>>=1;\n\t\ta*=a;\n\t\ta%=p;\n\t}\n\treturn ret;\n}\nsigned main()\n{\n\tread(n);\n\tcin>>p;\n\tval1[0]=val[0]=1;\n\tc[0][0]=1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tc[i][0]=1;\n\t\tfor(int j=1;j<=i;j++)\n\t\t{\n\t\t\tc[i][j]=c[i-1][j-1]+c[i-1][j];\n\t\t\tif(c[i][j]>=p)\n\t\t\t\tc[i][j]-=p;\n\t\t}\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tval1[i]=val1[i-1]<<1;\n\t\tif(val1[i]>=p-1)\n\t\t\tval1[i]-=p-1;\n\t}\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tval[i]=val[i-1]<<1;\n\t\tif(val[i]>=p)\n\t\t\tval[i]-=p;\n\t}\n\tg[0][0]=1;\n\tf[0]=1;\n\tfor(int i=1;i<=n;i++)\n\t{\n\t\tg[i][0]=f[i]=1;\n\t\tll now=val[n-i];\n\t\tfor(int j=1;j<=n;j++)\n\t\t{\n\t\t\tg[i][j]=g[i-1][j-1]+g[i-1][j]*(j+1)%p;\n\t\t\tif(g[i][j]>=p)\n\t\t\t\tg[i][j]-=p;\n\t\t\tf[i]+=g[i][j]*now%p;\n\t\t\tif(f[i]>=p)\n\t\t\t\tf[i]-=p;\n\t\t\tnow*=val[n-i];\n\t\t\tnow%=p;\n\t\t}\n\t}\n\t\t\n\tfor(int i=0;i<=n;i++)\n\t{\n\t\tif(i&1)\n\t\t{\n\t\t\tans-=f[i]*qpow(2,val1[n-i])%p*c[n][i]%p;\n\t\t\tif(ans<0)\n\t\t\t\tans+=p;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tans+=f[i]*qpow(2,val1[n-i])%p*c[n][i]%p;\n\t\t\tif(ans>=p)\n\t\t\t\tans-=p;\n\t\t}\n\t}\n\tprintf(\"%lld\\n\",ans);\n\texit(0);\n}\n```",
        "postTime": 1640156452,
        "uid": 176990,
        "name": "Celtic",
        "ccfLevel": 9,
        "title": "[ARC096C] Everything on It \u9898\u89e3"
    },
    {
        "content": "\n\u770b\u5230\u8fd9\u79cd\u8ba1\u6570\u9898\uff0c\u89c9\u5f97\u5f88\u96be\u6b63\u63a8\u7684\uff0c\u591a\u534a\u662f\u53cd\u63a8\uff0c\u8fd8\u591a\u534a\u6cbe\u70b9\u5bb9\u65a5\u3002\n\n***\n\n\u6211\u4eec\u8003\u8651 $dp_i$ \u8868\u793a\u6709\u5df2\u786e\u5b9a\u7684 $i$ \u79cd\u5143\u7d20\u4e0d\u5408\u6cd5\uff0c\u5176\u5b83 $n-i$ \u79cd\u5143\u7d20\u4e0d\u786e\u5b9a\uff08\u4efb\u610f\uff09\u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u53ef\u4ee5\u5bb9\u65a5\u4e00\u4e0b\uff0c\u7b54\u6848\u5373\u4e3a\uff1a\n\n$$ans = \\sum\\limits_{i = 0}^{n}(-1)^n \\times \\binom{n}{i} \\times dp_i$$\n\n\u5176\u4e2d $\\binom{n}{i}$ \u5c31\u8868\u793a\u4ece $n$ \u7897\u9762\u4e2d\u9009\u62e9\u4e86 $i$ \u79cd\u3002\n\n***\n\n\u65e2\u7136 $dp_i$ \u4e2d\u7684\u5143\u7d20\u88ab\u9c9c\u660e\u5730\u5206\u4e3a\u4e86\u4e24\u7c7b\uff0c\u8bbe $f_i$ \u8868\u793a\u786e\u5b9a\u7684 $i$ \u79cd\u4e0d\u5408\u6cd5\u5143\u7d20\u7684\u65b9\u6848\u6570\uff0c\u5219\u6709\uff1a\n\n$$dp_i = f_i \\times 2^{2^{n-i}}$$\n\n\u5176\u4e2d $2^{2^{n-i}}$ \u610f\u5373\uff1a$n-i$ \u79cd\u5143\u7d20\u6784\u6210\u4e86 $2^{n-i}$ \u4e2a\u96c6\u5408\uff0c\u800c\u8fd9\u4e9b\u96c6\u5408\u53c8\u4f5c\u4e3a\u5143\u7d20\u6784\u6210\u4e86 $2^{2^{n-i}}$ \u4e2a\u96c6\u5408\u3002\n\n\u6ce8\u610f\u4e00\u4e0b\u6c42\u89e3 $2^{2^{n-i}}\\bmod p$ \u8bf7\u7528\u6b27\u62c9\u5b9a\u7406\uff0c\u53d8\u4e3a\u6c42\u89e3 $2^{2^{n-i}\\bmod \\varphi(p)}\\bmod p$\u3002\n\n***\n\n\u538b\u529b\u6765\u5230\u4e86\u6c42 $f_i$ \u4e0a\u3002\u6211\u4eec\u8003\u8651\u8fd9 $i$ \u4e2a\u5143\u7d20\u5206\u522b\u653e\u5230\u4e86\u54ea\u4e9b\u96c6\u5408\u91cc\uff0c\u8bbe $g_{i,j}$ \u8868\u793a $i$ \u4e2a\u5143\u7d20\u653e\u5230\u4e86 $j$ \u4e2a\u96c6\u5408\u91cc\u7684\u65b9\u6848\u6570\uff0c\u5219\u53c8\u6709\uff1a\n\n$$f_i = \\sum\\limits_{j = 0}^{n}\\left(2^{n-i}\\right)^{j}\\times g_{i,j}$$\n\n\u5373\u5148\u679a\u4e3e\u8fd9 $i$ \u4e2a\u5143\u7d20\u653e\u5230\u54ea\u4e9b\u96c6\u5408\u91cc\u3002\n\n***\n\n\u600e\u4e48\u6c42 $g_{i,j}$\uff1f\u53ef\u4ee5\u8003\u8651\u9012\u63a8\uff1a\n\n$$g_{i,j} = g_{i-1,j-1}+(j+1)\\times g_{i-1,j}$$\n\n1. \u4ece $g_{i-1,j-1}$ \u8f6c\u79fb\uff1a\u5269\u4e0b\u7684\u4e00\u79cd\u5143\u7d20\u5fc5\u987b\u52a0\u5230\u4e00\u4e2a\u65b0\u7684\u96c6\u5408\u91cc\uff1b\n\n2. \u4ece $g_{i-1,j}$ \u8f6c\u79fb\uff1a\u65e0\u8bba\u628a\u8fd9\u79cd\u5143\u7d20\u52a0\u5230\u90a3\u4e2a\u96c6\u5408\u91cc\u3001\u751a\u81f3\u4e0d\u52a0\u5165\u4efb\u4e00\u4e2a\u96c6\u5408\u90fd\u53ef\u4ee5\u3002\n\n\u4f3c\u4e4e\u63a8\u7ec4\u5408\u6570\u3001\u65af\u7279\u6797\u6570\u65f6\u4e5f\u6709\u7c7b\u4f3c\u7684\u5f0f\u5b50\uff0c\u4e5f\u53ef\u4ee5\u8bf4\u662f\u9012\u63a8\u7684\u4e00\u4e2a\u6280\u5de7\u5427\u3002\n\n***\n\n\u90a3\u5c31\u5f00\u59cb\u7801\u4ee3\u7801\u5427\u3002\n\n```cpp\n#include <iostream>\nconst int N = 3005;\nint n, mod;\nint C[N][N], g[N][N], ans;\nint quick_pow(int _a,int _n,int _p = mod) {\n\tint _res = 1;\n\twhile(_n) {\n\t\tif(_n&1) \n\t\t\t_res = 1ll*_res*_a%_p;\n\t\t_a = 1ll*_a*_a%_p;\n\t\t_n >>= 1;\n\t}\n\treturn _res;\n}\nint main() {\n\tscanf(\"%d %d\",&n,&mod);\n\tfor(int i = 0;i <= n;++i) {\n\t\tg[i][0] = C[i][0] = 1;\n\t\tfor(int j = 1;j <= i;++j) {\n\t\t\tg[i][j] = (g[i-1][j-1]+(j+1LL)*g[i-1][j])%mod;\n\t\t\tC[i][j] = (C[i-1][j]+C[i-1][j-1])%mod;\n\t\t}\n\t}\n\tfor(int i = 0;i <= n;++i) {\n\t\tint f = 0, pass = 1;\n\t\tint t_n = quick_pow(2,n-i);\n\t\tfor(int j = 0;j <= i;++j) {\n\t\t\tf = (f+1ll*g[i][j]*pass)%mod;\n\t\t\tpass = 1ll*pass*t_n%mod;\n\t\t}\n\t\tans = (ans+1ll*f*(i&1 ? mod-C[n][i] : C[n][i])%mod*quick_pow(2,quick_pow(2,n-i,mod-1)))%mod;\n\t}\n\tprintf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n",
        "postTime": 1666182649,
        "uid": 663579,
        "name": "bikuhiku",
        "ccfLevel": 0,
        "title": "\u3010\u9898\u89e3\u3011AtCoder [ARC096C] Everything on it"
    },
    {
        "content": "[Atcoder \u9898\u9762\u4f20\u9001\u95e8](https://atcoder.jp/contests/arc096/tasks/arc096_c) & [\u6d1b\u8c37\u9898\u9762\u4f20\u9001\u95e8](https://www.luogu.com.cn/problem/AT4119)\n\n\u7b80\u5355\u9898\uff0c\u7531\u4e8e\u8fd9\u573a arc \u7684 F \u662f jxd \u4f5c\u4e1a\u800c\u6211\u4e0d\u4f1a\u505a\uff0c\u6240\u4ee5\u53ea\u597d\u6765\u628a\u8fd9\u573a\u7684 E ~~\u6c34~~\u6389\u4e86\u3002\n\n\u6211\u4eec\u8bb0 $f(i)$ \u4e3a\u94a6\u5b9a $i$ \u4e2a\u5143\u7d20\u51fa\u73b0\u6b21\u6570\u4e0d\u8d85\u8fc7\u4e00\u6b21\uff0c\u5269\u4f59\u653e\u4efb\u81ea\u6d41\uff08cmd_blk \u5185\u5473\uff09\u7684\u65b9\u6848\u6570\uff0c\u518d\u8bb0 $g(i)$ \u4e3a\u6070\u597d $i$ \u4e2a\u5143\u7d20\u51fa\u73b0\u6b21\u6570\u4e0d\u8d85\u8fc7\u4e00\u6b21\u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u6709 $f(i)=\\sum\\limits_{j=i}^ng(j)\\dbinom{j}{i}$\uff0c\u4e8c\u9879\u5f0f\u53cd\u6f14\u4e00\u4e0b\u53ef\u5f97 $g(i)=\\sum\\limits_{j=i}^nf(j)\\dbinom{j}{i}(-1)^{j-i}$\uff0c\u6211\u4eec\u8981\u6c42\u7684\u7b54\u6848\u5373\u4e3a $g(0)=\\sum\\limits_{i=0}^n(-1)^if(i)$\u3002\n\n\u8003\u8651\u600e\u6837\u6c42 $f(i)$\uff0c\u9996\u5148\u6211\u4eec\u9700\u94a6\u5b9a $i$ \u4e2a\u5143\u7d20\u51fa\u73b0\u4e0d\u8d85\u8fc7\u4e00\u6b21\uff0c\u65b9\u6848\u6570\u4e3a $\\dbinom{n}{i}$\uff0c\u6211\u4eec\u679a\u4e3e\u8fd9 $i$ \u4e2a\u5143\u7d20\u5212\u5206\u5165\u591a\u5c11\u4e2a\u96c6\u5408\uff0c\u8bbe\u4e3a $j$\uff0c\u6839\u636e\u7ec4\u5408\u610f\u4e49\uff0c\u53ef\u80fd\u4f1a\u6709\u4e00\u4e9b\u5143\u7d20\u51fa\u73b0\u4e86\u4e00\u6b21\uff0c\u90a3\u6211\u4eec\u5c31\u65b0\u5efa\u4e00\u4e2a\u96c6\u5408 $S_0$ \u8868\u793a\u51fa\u73b0 $0$ \u6b21\u7684\u6570\u7684\u96c6\u5408\uff0c\u5e76\u65b0\u5efa\u4e00\u4e2a $0$ \u53f7\u5143\u7d20\uff0c\u5f3a\u5236\u4ee4 $0\\in S_0$\uff0c\u8fd9\u6837\u7b49\u4ef7\u4e8e\u5c06 $i+1$ \u4e2a\u5143\u7d20\u653e\u5165 $j+1$ \u4e2a\u975e\u7a7a\u96c6\u5408\uff0c\u5176\u4e2d\u4e0e $0$ \u53f7\u5143\u7d20\u88ab\u5212\u5206\u5728\u4e00\u4e2a\u96c6\u5408\u7684\u5143\u7d20\u5c31\u662f\u51fa\u73b0\u4e00\u6b21\u7684\u5143\u7d20\uff0c\u8fd9\u6837\u53ef\u5f97\u65b9\u6848\u6570\u4e3a $\\begin{Bmatrix}i+1\\\\j+1\\end{Bmatrix}$\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u5269\u4e0b $n-i$ \u4e2a\u5143\u7d20\uff0c\u5b83\u4eec\u53ef\u4ee5\u5f62\u6210 $2^{n-i}$ \u4e2a\u96c6\u5408\uff0c\u7531\u4e8e\u5269\u4e0b\u7684\u5143\u7d20\u653e\u4efb\u81ea\u6d41\uff0c\u8fd9 $2^{n-i}$ \u4e2a\u96c6\u5408\u6bcf\u4e2a\u53c8\u6709\u9009\u6216\u8005\u4e0d\u9009\u4e24\u79cd\u65b9\u6848\uff0c\u65b9\u6848\u6570\u4e3a $2^{2^{n-i}}$\uff0c\u53e6\u5916\u5269\u4f59 $n-i$ \u4e2a\u5143\u7d20\u6bcf\u4e2a\u53c8\u53ef\u4ee5\u653e\u5165\u539f\u6765 $j$ \u4e2a\u975e\u7a7a\u96c6\u5408\u4e2d\uff0c\u6bcf\u4e2a\u5143\u7d20\u662f\u5426\u653e\u5165\u6bcf\u4e2a\u96c6\u5408\u90fd\u6709 $2$ \u79cd\u9009\u62e9\uff0c\u56e0\u6b64\u6bcf\u4e2a\u5143\u7d20\u53ef\u9009\u62e9\u7684\u65b9\u6848\u6570\u4e3a $2^j$\uff0c\u603b\u8d21\u732e\u4e3a $2^{j\\times(n-i)}$\u3002\n\n\u56e0\u6b64 $f(i)=\\sum\\limits_{j=0}^i\\dbinom{n}{i}\\begin{Bmatrix}i+1\\\\j+1\\end{Bmatrix}\u00b72^{2^{n-i}}\u00b72^{j\\times(n-i)}$\uff0c\u7b80\u5355\u7b97\u4e00\u4e0b\u5c31\u597d\u4e86\uff0c$n^2\\log n$ \u7684\u505a\u6cd5\u663e\u7136\uff0c\u4e0d\u8fc7\u4f3c\u4e4e\u8fc7\u4e0d\u53bb\uff1f\u7a0d\u5fae\u6709\u70b9\u8111\u5b50\u7684\u4eba\u4e5f\u80fd\u4f18\u5316\u5230 $n^2$ \u7f62\u2026\u2026\n\n```cpp\nconst int MAXN=3e3;\nint n,mod,s[MAXN+5][MAXN+5],c[MAXN+5][MAXN+5];\nvoid init(int n){\n\ts[0][0]=c[0][0]=1;\n\tfor(int i=1;i<=n;i++){\n\t\tc[i][0]=1;\n\t\tfor(int j=1;j<=i;j++){\n\t\t\tc[i][j]=(c[i-1][j-1]+c[i-1][j])%mod;\n\t\t\ts[i][j]=(s[i-1][j-1]+1ll*s[i-1][j]*j)%mod;\n\t\t}\n\t}\n}\nint qpow(int x,int e,int mod){\n\tint ret=1;\n\tfor(;e;e>>=1,x=1ll*x*x%mod) if(e&1) ret=1ll*ret*x%mod;\n\treturn ret;\n}\nint main(){\n\tscanf(\"%d%d\",&n,&mod);init(n+1);int ans=0;\n\tfor(int i=0;i<=n;i++){\n\t\tint sum=0,pww=qpow(2,qpow(2,n-i,mod-1),mod),bs=qpow(2,n-i,mod),pw=1;\n\t\tfor(int j=0;j<=i;j++,pw=1ll*pw*bs%mod){\n\t\t\tsum=(sum+1ll*s[i+1][j+1]*c[n][i]%mod*pww%mod*pw%mod)%mod;\n\t\t}\n\t\tif(i&1) ans=(ans-sum+mod)%mod;\n\t\telse ans=(ans+sum)%mod;\n\t} printf(\"%d\\n\",ans);\n\treturn 0;\n}\n```\n\n",
        "postTime": 1616941028,
        "uid": 115194,
        "name": "lTgMFePRoeZ",
        "ccfLevel": 9,
        "title": "\u9898\u89e3 AT4119 [ARC096C] Everything on It"
    },
    {
        "content": "\u4e3a\u5565\u56e0\u4e3a\u8fd9\u573a ARC \u6ca1\u6709 AB \u6d1b\u8c37\u5c31\u76f4\u63a5\u5e73\u79fb\u8fd9\u9898\u642c\u6210 C \u4e86\u554a\u3002\n\n\u7b2c\u4e00\u53cd\u5e94\u662f\u76f4\u63a5\u4e0a dp \uff0c\u7136\u540e\u53d1\u73b0\u5047\u4e86\u3002\n\n\u7b2c\u4e00\u4e2a\u9650\u5236\u548c\u6ca1\u6709\u4e00\u6837\uff0c\u76f4\u63a5\u5ffd\u7565\uff0c\u8003\u8651\u600e\u4e48\u5904\u7406\u7b2c\u4e8c\u4e2a\u9650\u5236\u3002\n\n\u8003\u8651\u5bb9\u65a5\uff0c\u8bbe\u81f3\u5c11\u6709 $i$ \u4e2a\u6570\u51fa\u73b0\u4e86\u5c11\u4e8e 2 \u6b21\u7684\u65b9\u6848\u6570\u4e3a $g_i$ \uff0c\u5219\u7b54\u6848\u4e3a $\\sum\\limits_{i=0}^n(-1)^ig_i$ \uff0c\u8003\u8651\u600e\u4e48\u6c42 $g_i$ \u3002\n\n\u5bf9\u4e8e\u8fd9 $i$ \u4e2a\u6570\u4ee5\u5916\u7684 $n-i$ \u4e2a\u6570\u6240\u6784\u6210\u7684 $2^{n-i}$ \u4e2a\u96c6\u5408\u53ef\u4ee5\u968f\u610f\u9009\u6216\u4e0d\u9009\uff0c\u6240\u4ee5\u8fd9\u90e8\u5206\u7684\u8d21\u732e\u4e3a $2^{2^{n-i}}$ \uff0c\u4e00\u4e2a\u7ec6\u8282\u662f\u5e42\u7684\u5e42\u8981\u7528\u8d39\u9a6c\u5c0f\u5b9a\u7406\u89e3\u51b3\u3002\u9009 $i$ \u4e2a\u6570\u7684\u65b9\u6848\u4e3a $\\binom{n}{i}$ \u3002\n\n\u8bbe $f_{i,j}$ \u8868\u793a\u628a $i$ \u4e2a\u4e0d\u540c\u7684\u6570\u5206\u6210 $j$ \u7ec4\uff0c\u540c\u65f6\u6709\u7684\u6570\u53ef\u4ee5\u6254\u6389\u7684\u65b9\u6848\u6570\uff0c\u7136\u540e\u5bf9\u4e8e\u6bcf\u4e00\u7ec4\uff0c\u53ef\u4ee5\u968f\u610f\u52a0\u51cf\u5176\u4ed6\u7684 $n-i$ \u4e2a\u6570\uff0c\u6240\u4ee5\u8fd9\u90e8\u5206\u7684\u8d21\u732e\u4e3a $\\sum\\limits_{j=0}^if_{i,j}\\times(2^{n-i})^j$ \u3002\u95ee\u9898\u53d8\u6210\u4e86\u6c42 $f_{i,j}$ \u3002\n\n\u8fd9\u4e2a $f_{i,j}$ \u8fd8\u662f\u86ee\u597d\u6c42\u7684\uff0c\u6709\u70b9\u50cf\u65af\u7279\u6797\u6570\uff0c~~\u54ea\u4e00\u7c7b\u6211\u5fd8\u4e86\u3002~~\n\n\u8003\u8651\u5982\u4f55\u4ece $f_{i-1}$ \u8f6c\u79fb\uff0c\u4e00\u79cd\u662f\u7b2c $i$ \u4e2a\u6570\u81ea\u5df1\u65b0\u5f00\u4e00\u7ec4\uff0c\u6240\u4ee5 $f_{i,j}\\leftarrow f_{i-1,j-1}$ \u3002\n\n\u4e00\u79cd\u662f\u628a\u7b2c $i$ \u4e2a\u6570\u76f4\u63a5\u6254\u6389\uff0c\u4e5f\u5c31\u662f\u4e00\u4e2a\u90fd\u4e0d\u9009\uff0c\u6240\u4ee5 $f_{i,j}\\leftarrow f_{i-1,j}$ \u3002\n\n\u8fd8\u6709\u4e00\u79cd\u662f\u628a\u7b2c $i$ \u4e2a\u6570\u5728\u4e4b\u524d\u7684\u7ec4\u91cc\u4ecd\u9009\u4e00\u4e2a\u653e\u8fdb\u53bb\uff0c\u6240\u4ee5 $f_{i,j}\\leftarrow f_{i-1,j}\\times j$ \u3002\n\n\u7136\u540e\u5c31\u505a\u5b8c\u4e86\u3002\n\nhttps://atcoder.jp/contests/arc096/submissions/32318901",
        "postTime": 1654678822,
        "uid": 115936,
        "name": "\u6cf7\u6cfd\u4e09\u6708",
        "ccfLevel": 0,
        "title": "ARC096E"
    },
    {
        "content": "~~\u4e3a\u5565\u8fd9ARC\u8fd9\u4e48\u6bd2\u7624\u3002~~\n\n\u9898\u76ee\u7b54\u6848\u65e0\u6cd5\u7b80\u5355\u7edf\u8ba1\uff0c\u4e8e\u662f\u8003\u8651\u5bb9\u65a5\uff0c\u4ee4 $f(x)$ \u4e3a $x$ \u4e2a\u6570\u4e0d\u5408\u6cd5\u7684\u65b9\u6848\u6570\uff0c\u90a3\u4e48\u7b54\u6848\u5c31\u662f $\\sum\\limits_{x=0}^{n}(-1)^xf(x)$\u3002\n\n\u63a5\u4e0b\u6765\u8ba1\u7b97 $f(x)$\uff1a\n\n\u9996\u5148\u9009\u51fa\u8fd9 $x$ \u4e2a\u4e0d\u5408\u6cd5\u7684\u6570\uff0c\u603b\u5171 $\\dbinom{n}{x}$ \u79cd\u65b9\u6848\u3002\n\n\u7136\u540e\u8bbe\u628a\u8fd9\u4e9b\u6570\u9009\u51fa\u6765\u540e\u6254\u5230 $y$ \u4e2a\u96c6\u5408\u91cc\uff0c\u56e0\u4e3a\u4e0d\u5408\u6cd5\uff0c\u6240\u4ee5\u6bcf\u4e2a $x$ \u81f3\u591a\u51fa\u73b0\u4e00\u6b21\u3002\u6bcf\u4e2a\u96c6\u5408\u4e92\u4e0d\u76f8\u540c\uff0c\u4e0d\u96be\u60f3\u5230**\u65af\u7279\u6797\u6570**\u3002\n\n\u4f46\u662f\u65af\u7279\u6797\u6570\u662f\u5fc5\u987b\u6254\u8fdb $y$ \u96c6\u5408\uff0c\u800c\u6839\u636e\u521a\u521a\u7684\u5206\u6790\uff0c\u5bf9\u4e8e\u6bcf\u4e2a $x$\uff0c\u6211\u4eec\u53ef\u4ee5\u9009\u62e9\u6254\u6216\u4e0d\u6254\u3002\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u96c6\u5408 $y+1$ \u8868\u793a\u6240\u6709\u4e0d\u6254\u5230 $1$ \u5230 $y$ \u96c6\u5408\u7684 $x$\uff0c\u8fd9\u6837\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $x$\uff0c\u90fd\u5fc5\u987b\u6254\u5230 $1$ \u5230 $y+1$ \u4e2d\u3002\u53c8\u56e0\u4e3a\u65af\u7279\u6797\u6570\u8981\u6c42\u96c6\u5408\u975e\u7a7a\uff0c\u6240\u4ee5\u5bf9\u5e94\u5730\u521b\u5efa\u4e00\u4e2a $x+1$ \u7684\u6570\u6254\u8fdb\u96c6\u5408 $y+1$ \u4e2d\u3002\n\n\u4e8e\u662f\u7531\u65af\u7279\u6797\u6570\u7684\u7ec4\u5408\u610f\u4e49\u6211\u4eec\u77e5\u9053 **$x$ \u4e2a\u6570\uff0c\u6254\u8fdb $y$ \u4e2a\u96c6\u5408\uff0c\u6bcf\u4e2a $x$ \u81f3\u591a\u51fa\u73b0\u4e00\u6b21\uff0c\u6bcf\u4e2a\u96c6\u5408\u4e92\u4e0d\u76f8\u540c**\u7684\u65b9\u6848\u6570\u5373 $\\begin{Bmatrix}x+1\\\\y+1\\end{Bmatrix}$ \u79cd\u3002\n\n\u5269\u4e0b $n-x$ \u4e2a\u6570\uff0c\u6bcf\u4e2a\u6570\u9009\u6216\u4e0d\u9009\u53ef\u4ee5\u7ec4\u6210 $2^{n-x}$ \u4e2a\u96c6\u5408\uff0c\u5f80\u524d\u9762\u7684 $y$ \u4e2a\u96c6\u5408\u52a0\u6709 ${(2^{n-k})}^y$ \u79cd\u65b9\u6848\uff0c\u6bcf\u4e2a\u96c6\u5408\u51fa\u4e0d\u51fa\u73b0\u53c8\u53ef\u4ee5\u6709 $2^{2^{n-x}}$ \u79cd\u65b9\u6848\u3002\n\n\u6240\u4ee5 $f(x)=\\dbinom{n}{x}2^{2^{n-x}}\\sum\\limits_{y=0}^{i}(2^{n-x})^y\\begin{Bmatrix}x+1\\\\y+1\\end{Bmatrix}$\u3002\n\n\u5e26\u5165\u6700\u521d\u7684\u5f0f\u5b50\uff0c\u5f97\u5230\uff1a\n$$ans=\\sum\\limits_{x=0}^{n}(-1)^x\\dbinom{n}{x}2^{2^{n-x}}\\sum\\limits_{y=0}^{i}(2^{n-x})^y\\begin{Bmatrix}x+1\\\\y+1\\end{Bmatrix}$$\n\n$O(n^2)$ \u9884\u5904\u7406 $\\mathtt{Stirling\\ Number}$\uff0c$O(n)$ \u9884\u5904\u7406\u9636\u4e58\u3001\u9006\u5143\u3001\u9636\u4e58\u9006\u5143\uff0c\u7136\u540e\u5c31\u53ef\u4ee5 $O(n^2)$ \u8ba1\u7b97\u7b54\u6848\u5566\uff01\n\n```cpp\n// fac\u4e3a\u9636\u4e58\uff0cinv\u4e3a\u9006\u5143\uff0cifac\u4e3a\u9636\u4e58\u7684\u9006\u5143\uff0cs\u4e3a\u65af\u7279\u6797\u6570\nvoid init(int lim) {\n\tfac[0] = inv[1] = ifac[0] = s[0][0] = 1;\n\tfor (int i = 2; i <= lim; i++) inv[i] = (mod - mod / i) * inv[mod % i] % mod;\n\tfor (int i = 1; i <= lim; i++) fac[i] = fac[i - 1] * i % mod, ifac[i] = ifac[i - 1] * inv[i] % mod;\n\tfor (int i = 1; i <= lim; i++) {\n\t\tfor (int j = 1; j <= i; j++) {\n\t\t\ts[i][j] = (s[i - 1][j - 1] + j * s[i - 1][j]) % mod;\n\t\t}\n\t}\n}\n// \u6c42\u7ec4\u5408\u6570\nint C(int n, int m) { return fac[n] * ifac[m] % mod * ifac[n - m] % mod; }\n// \u5feb\u901f\u5e42\nint ksm(int p, int q, int m) {\n\tint res = 1;\n\twhile (q) {\n\t\tif (q & 1) res = res * p % m;\n\t\tp = p * p % m;\n\t\tq >>= 1;\n\t}\n\treturn res;\n}\n\nsigned main() {\n\tn = read(), mod = read();\n\tinit(n + 1);\n\tfor (int x = 0; x <= n; x++) {\n\t\tint tp = 0, pw = 1, p = ksm(2, n - x, mod);\n\t\tfor (int y = 0; y <= x; y++) {\n\t\t\ttp = (tp + s[x + 1][y + 1] * pw % mod) % mod;\n\t\t\tpw = pw * p % mod;\n\t\t}\n\t\tres = ((res + ksm(-1, x, mod) * C(n, x) % mod * ksm(2, ksm(2, n - x, mod - 1), mod) % mod * tp % mod) % mod + mod) % mod;\n\t}\n\twrite(res);\n\treturn 0;\n}\n```\n\nP.S:\u8c01\u8bf4 $O(n^2\\log n)$ \u8fc7\u4e0d\u53bb...\u5bb3\u5f97\u6211\u6253\u4e86\u4e00\u904d $O(n^2)$\u3002\u6253\u5b8c\u624d\u53d1\u73b0\u7adf\u7136\u80fd\u8fc7\u3002\n\n[$\\mathtt{Code\\ O(n^2\\log n)}$](https://www.luogu.com.cn/paste/isdroq26)",
        "postTime": 1642994696,
        "uid": 306573,
        "name": "Ender32k",
        "ccfLevel": 0,
        "title": "ARC096C Everything on It \u9898\u89e3"
    },
    {
        "content": "\u524d\u7f6e\u829d\u58eb\uff1a[\u65af\u7279\u6797\u6570](https://oi-wiki.org/math/combinatorics/stirling/)\u3001[\u6b27\u62c9\u5b9a\u7406](https://oi-wiki.org/math/number-theory/fermat/#_3)\n\n\u521a\u521a\u590d\u4e60\u65f6\u770b\u5230\u4e86\u8fd9\u9053\u9898\uff0c\u5c31\u987a\u4fbf\u6765\u5199\u4e00\u7bc7\u9898\u89e3\u3002\n\n\u76f4\u63a5\u7b97 $\\geq 2$ \u6bd4\u8f83\u56f0\u96be\uff0c\u8003\u8651\u5bb9\u65a5\u540e\u5c06\u5176\u8f6c\u4e3a $\\leq 1$\u3002\n\n\u8003\u8651\u94a6\u5b9a $i$ \u4e2a\u5143\u7d20\u4e0d\u5408\u6cd5\uff0c\u9996\u5148\u6709\u5bb9\u65a5\u7cfb\u6570 $(-1)^i C_n^i 2^{2^{n - i}}$\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u628a\u8fd9 $i$ \u4e2a\u4e0d\u5408\u6cd5\u7684\u5143\u7d20\u6254\u5230 $j$ \u4e2a\u96c6\u5408\u91cc\u53bb\u3002\u9996\u5148\uff0c\u7531\u4e8e\u53e6\u5916 $n - i$ \u4e2a\u5143\u7d20\u5df2\u7ecf\u88ab\u653e\u4efb\u81ea\u6d41\uff0c\u6211\u4eec\u53ef\u4ee5\u628a\u5b83\u4eec\u7684\u5b50\u96c6\u6254\u5230\u4efb\u610f\u4e00\u4e2a\u96c6\u5408\u4e2d\uff0c\u5373 $(2^{n - i})^j$\uff1b\u5176\u6b21\uff0c\u7531\u4e8e\u6211\u4eec\u8981\u505a\u96c6\u5408\u5212\u5206\uff0c\u5bb9\u6613\u60f3\u5230\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\uff0c\u6ce8\u610f\u5230\u53ef\u4ee5\u6709\u5143\u7d20\u4e0d\u88ab\u9009\u62e9\uff0c\u6211\u4eec\u5c06\u5176\u6254\u5230\u4e00\u4e2a\u4e13\u7528\u7684\u96c6\u5408\u4e2d\u5373\u53ef\uff0c\u5373 $\\{^{i + 1}_{j + 1}\\}$\uff08$i + 1$ \u662f\u56e0\u4e3a\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\u8981\u6c42\u96c6\u5408\u975e\u7a7a\uff09\u3002\n\n\u7efc\u4e0a\uff0c\u7b54\u6848\u4e3a $\\displaystyle\\sum_{i = 0}^n (-1)^i C_n^i 2^{2^{n - i}} \\sum_{j = 1}^i (2^{n - i})^j \\{^{i + 1}_{j + 1}\\}$\u3002\n\n\u6ce8\u610f $2^{2^{n - i}}$ \u9700\u8981\u4f7f\u7528\u6b27\u62c9\u5b9a\u7406\u3002\n\n\u4ee3\u7801\uff1a\n```cpp\n#include <stdio.h>\n\ntypedef long long ll;\n\nint c[3007][3007];\nll s2[3007][3007];\n\ninline void init(int n, int mod){\n\tc[0][0] = 1;\n\tfor (register int i = 1; i <= n; i++){\n\t\tc[i][0] = 1;\n\t\tfor (register int j = 1; j <= i; j++){\n\t\t\tc[i][j] = (c[i - 1][j] + c[i - 1][j - 1]) % mod;\n\t\t}\n\t}\n\ts2[0][0] = 1;\n\tfor (register int i = 1; i <= n; i++){;\n\t\tfor (register int j = 1; j <= i; j++){\n\t\t\ts2[i][j] = (s2[i - 1][j - 1] + j * s2[i - 1][j] % mod) % mod;\n\t\t}\n\t}\n}\n\ninline ll quick_pow(ll x, ll p, ll mod){\n\tll ans = 1;\n\twhile (p){\n\t\tif (p & 1) ans = ans * x % mod;\n\t\tx = x * x % mod;\n\t\tp >>= 1;\n\t}\n\treturn ans;\n}\n\nint main(){\n\tint n, m;\n\tll ans = 0;\n\tscanf(\"%d %d\", &n, &m);\n\tinit(n + 1, m);\n\tfor (register int i = 0; i <= n; i++){\n\t\tint j = 0;\n\t\tll x = 0, y = quick_pow(2, n - i, m);\n\t\tfor (register ll k = 1; j <= i; j++, k = k * y % m){\n\t\t\tx = (x + k * s2[i + 1][j + 1] % m) % m;\n\t\t}\n\t\tans = ((ans + (ll)(i % 2 == 0 ? 1 : -1) * x % m * c[n][i] % m * quick_pow(2, quick_pow(2, n - i, m - 1), m) % m) % m + m) % m;\n\t}\n\tprintf(\"%lld\", ans);\n\treturn 0;\n}\n```",
        "postTime": 1642404386,
        "uid": 201007,
        "name": "Leasier",
        "ccfLevel": 8,
        "title": "\u9898\u89e3 AT4119 \u3010[ARC096C] Everything on It\u3011"
    },
    {
        "content": "\u8003\u8651\u5c06\u7b2c\u4e8c\u4e2a\u5bb9\u65a5\u6389\uff0c\u679a\u4e3e\u6709 $1\\sim i$ \u51fa\u73b0\u6b21\u6570 $\\leq 1$ \u6b21\uff0c\u5269\u4f59\u7684\u65e0\u9650\u5236\uff0c\u5047\u8bbe\u5176\u65b9\u6848\u4e3a $f(i)$\uff0e\n\n\u90a3\u4e48\u7b54\u6848\u5c31\u662f $\\sum f(i)(-1)^i\\binom{n}{i}$\uff0e\n\n\u8003\u8651 $f(x)$ \u600e\u4e48\u7b97\uff0c\u4ee4 $y=n-x$\uff0c\u9996\u5148\u8003\u8651\u4e0d\u5305\u542b $1\\sim x$ \u7684\u5b50\u96c6\u4e00\u5171\u6709 $2^{2^y}$ \u4e2a\uff0c\u7136\u540e\u518d\u8003\u8651\u5305\u542b $1\\sim x$ \u7684\u5b50\u96c6\uff0c\u76f8\u5f53\u4e8e\u5c06 $1\\sim x$ \u5206\u6210\u82e5\u5e72\u4e2a\u4e0d\u540c\u7684\u96c6\u5408\uff0c\u6bcf\u4e2a\u96c6\u5408\u4ece $2^y$ \u4e2a\u96c6\u5408\u4e2d\u627e\u4e00\u4e2a\u96c6\u5408\uff0c\u4e0e\u5176\u7684\u5e76\u96c6\u6784\u6210\u4e00\u4e2a\u65b0\u7684\u96c6\u5408\u3002\n\n\u4ee4 $s_{i,j}$ \u4e3a\u5c06 $1\\sim i$ \u5206\u6210\u82e5 $j$ \u4e2a\u4e0d\u540c\u7684\u96c6\u5408\u7684\u65b9\u6848\u6570\uff08\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\uff09\uff0c\u679a\u4e3e\u6709 $1\\sim x$ \u4e2d\u51fa\u73b0\u4e86\u7684\u6709 $i$ \u4e2a\uff0c\u4e00\u5171\u5206\u6210 $j$ \u4e2a\u96c6\u5408\uff0c\u90a3\u4e48\u5c31\u6709\uff1a\n\n$$\n\\begin{aligned}\nf(x)&=\\sum_i\\sum_j s_{i,j}({2^y})^j2^{2^y}\\binom{x}{i}\n\\\\\n&=2^{2^y}\\sum_j (2^y)^j\\sum_i \\binom{x}{i}s_{i,j}\n\\end{aligned}\n$$\n\n\u8003\u8651\u540e\u9762\u90a3\u4e2a\u6c42\u548c\u53f7\u7684\u7ec4\u5408\u610f\u4e49\uff0c\u5c31\u662f\u4ece $x$ \u4e2a\u5143\u7d20\u4e2d\u9009\u51fa $i$ \u4e2a\u5143\u7d20\uff0c\u518d\u5c06\u8fd9 $i$ \u4e2a\u5143\u7d20\u5212\u5206\u6210 $j$ \u4e2a\u96c6\u5408\u3002\u5982\u679c\u628a\u6ca1\u6709\u9009\u51fa\u7684\u5143\u7d20\u4e5f\u770b\u6210\u4e00\u4e2a\u96c6\u5408\uff0c\u90a3\u4e48\u5176\u5c31\u662f $x$ \u4e2a\u5143\u7d20\u5212\u5206\u6210 $(j+1)$ \u4e2a\u96c6\u5408\uff0c\u5176\u4e2d\u6709\u4e00\u4e2a\u96c6\u5408\u6709\u6807\u53f7\u4e14\u53ef\u7a7a\u3002\u6240\u4ee5\uff1a\n\n$$\nf(x)=2^{2^y}\\sum_j (2^y)^j((j+1)s_{x,j+1}+s_{x,j})\n$$\n\n\u8981\u6ce8\u610f $2^{2^y}$ \u8ba1\u7b97\u65f6\u8981\u5c06\u6307\u6570\u6a21 $M-1$\uff0e\n\n```cpp\n#include<cstdio>\n#include<vector>\n#include<queue>\n#include<cstring>\n#include<iostream>\n#include<algorithm>\n#include<ctime>\n#include<random>\n#include<assert.h>\n#define pb emplace_back\n#define mp make_pair\n#define fi first\n#define se second\n#define dbg(x) cerr<<\"In Line \"<< __LINE__<<\" the \"<<#x<<\" = \"<<x<<'\\n';\n#define dpi(x,y) cerr<<\"In Line \"<<__LINE__<<\" the \"<<#x<<\" = \"<<x<<\" ; \"<<\"the \"<<#y<<\" = \"<<y<<'\\n';\nusing namespace std;\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef pair<int,int>pii;\ntypedef pair<ll,int>pli;\ntypedef pair<ll,ll>pll;\ntypedef pair<int,ll>pil;\ntypedef vector<int>vi;\ntypedef vector<ll>vll;\ntypedef vector<pii>vpii;\ntypedef vector<pil>vpil;\ntemplate<typename T>T cmax(T &x, T y){return x=x>y?x:y;}\ntemplate<typename T>T cmin(T &x, T y){return x=x<y?x:y;}\ntemplate<typename T>\nT &read(T &r){\n\tr=0;bool w=0;char ch=getchar();\n\twhile(ch<'0'||ch>'9')w=ch=='-'?1:0,ch=getchar();\n\twhile(ch>='0'&&ch<='9')r=r*10+(ch^48),ch=getchar();\n\treturn r=w?-r:r;\n}\ntemplate<typename T1,typename... T2>\nvoid read(T1 &x,T2& ...y){read(x);read(y...);}\nint mod;\ninline void cadd(int &x,int y){x=(x+y>=mod)?(x+y-mod):(x+y);}\ninline void cdel(int &x,int y){x=(x-y<0)?(x-y+mod):(x-y);}\ninline int add(int x,int y){return (x+y>=mod)?(x+y-mod):(x+y);}\ninline int del(int x,int y){return (x-y<0)?(x-y+mod):(x-y);}\nint qpow(int x,int y,int mod=mod){\n\tint s=1;\n\twhile(y){\n\t\tif(y&1)s=1ll*s*x%mod;\n\t\tx=1ll*x*x%mod;\n\t\ty>>=1;\n\t}\n\treturn s;\n}\nconst int N=3010;\nint n;\nint S[N][N],C[N][N];\nint solve(int x){\n\tint y=n-x,t=qpow(2,y),tmp=1;\n\tint s=0;\n\tfor(int j=0;j<=x;j++){\n\t\tcadd(s,1ll*tmp*add(1ll*(j+1)*S[x][j+1]%mod,S[x][j])%mod);\n\t\ttmp=1ll*tmp*t%mod;\n\t}\n\treturn 1ll*s*qpow(2,qpow(2,y,mod-1))%mod;\n}\nsigned main(){\n\t#ifdef do_while_true\n//\t\tassert(freopen(\"data.in\",\"r\",stdin));\n//\t\tassert(freopen(\"data.out\",\"w\",stdout));\n\t#endif\n\tread(n,mod);\n\tS[0][0]=C[0][0]=1;\n\tfor(int i=1;i<=n+1;i++){\n\t\tC[i][0]=1;\n\t\tfor(int j=1;j<=i;j++){\n\t\t\tC[i][j]=add(C[i-1][j-1],C[i-1][j]);\n\t\t\tS[i][j]=add(S[i-1][j-1],1ll*j*S[i-1][j]%mod);\n\t\t}\n\t}\n\tint ans=0;\n\tfor(int i=0;i<=n;i++){\n\t\tif(i&1)cdel(ans,1ll*C[n][i]*solve(i)%mod);\n\t\telse cadd(ans,1ll*C[n][i]*solve(i)%mod);\n\t}\n\tcout << ans << '\\n';\n    #ifdef do_while_true\n\t\tcerr<<'\\n'<<\"Time:\"<<1.0*clock()/CLOCKS_PER_SEC*1000<<\" ms\"<<'\\n';\n\t#endif\n\treturn 0;\n}\n```",
        "postTime": 1663397083,
        "uid": 223298,
        "name": "do_while_true",
        "ccfLevel": 8,
        "title": "\u300c\u9898\u89e3\u300dARC096E Everything on It"
    }
]
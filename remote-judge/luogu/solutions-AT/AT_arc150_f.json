[
    {
        "content": "\u5b9a\u4e49 $\\mathrm{nxt}(i,x)$ \u4e3a\u6700\u5c0f\u7684 $j$ \u6ee1\u8db3 $a_j = x$ \u4e14 $j > i$\uff0c$\\mathrm{pre}(i,x)$ \u4e3a\u6700\u5927\u7684 $j$ \u6ee1\u8db3 $a_j = x$ \u4e14 $j < i$\u3002\n\n\u6709\u4e86\u4e0a\u9762\u7684\u5b9a\u4e49\u540e\uff0c\u8003\u8651 dp\u3002\u8bbe $f_s$ \u8868\u793a\u6700\u5c0f\u7684 $i$\uff0c\u6ee1\u8db3\u6240\u6709\u548c\u4e3a $s$ \u7684\u6b63\u6574\u6570\u5e8f\u5217\u90fd\u662f $a_1,a_2,...,a_i$ \u7684\u5b50\u5e8f\u5217\u3002\u5219\u7b54\u6848\u4e3a $f_S$\uff08\u6b64\u5904\u7684 $S$ \u4e3a\u539f\u9898\u9762\u4e2d\u7684 $S$\uff09\uff0c\u521d\u503c $f_0 = 0$\u3002\n\n\u8003\u8651\u5982\u4f55\u8f6c\u79fb\u3002\u679a\u4e3e\u4e00\u4e2a\u6570 $x$\uff0c\u90a3\u4e48\u6240\u6709\u548c\u4e3a $s-x$ \u7684\u5e8f\u5217\u90fd\u53ef\u4ee5\u5728\u672b\u5c3e\u63a5\u4e0a\u4e00\u4e2a $x$ \u5f97\u5230\uff0c\u6240\u4ee5 $f_s \\ge \\mathrm{nxt}(f_{s-x},x)$\u3002\u53ef\u5f97 $f_s = \\max\\limits_{x=1}^s \\mathrm{nxt}(f_{s-x},x)$\u3002\u5982\u679c\u4f7f\u7528\u5237\u8868\u6cd5\uff0c\u5219 $f_s$ \u5df2\u77e5\uff0c$f_{s+x} \\gets \\max(f_{s+x},\\mathrm{nxt}(f_s,x))$\u3002\u8fd9\u6837\u6734\u7d20\u8f6c\u79fb\u662f $O(S^2 \\log n + n)$ \u7684\u3002\n\n\u8003\u8651\u5206\u6cbb\u4f18\u5316\u3002\u8bbe\u5f53\u524d\u533a\u95f4\u4e3a $[l,r]$\uff0c\u4ee4 $mid = \\left\\lfloor\\frac{l+r}{2}\\right\\rfloor$\u3002\u5148\u8ba1\u7b97 $[l,mid]$\uff0c\u518d\u8003\u8651 $[l,mid]$ \u5bf9 $[mid+1,r]$ \u7684\u8d21\u732e\u3002\u8fd8\u662f\u5148\u679a\u4e3e\u4e00\u4e2a $x$\uff0c\u7531 $f$ \u7684\u8f6c\u79fb\u5f0f\u53ef\u5f97 $f$ \u6709\u5355\u8c03\u6027\uff0c\u5219 $\\forall i \\in [mid+1,r],f_i > f_{mid}$\u3002\u5219\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651\u53ef\u80fd\u5bf9\u53f3\u533a\u95f4\u6709\u8d21\u732e\u7684 $s$\uff0c\u5373 $s$ \u6ee1\u8db3 $\\mathrm{nxt}(f_s,x) = \\mathrm{nxt}(f_{mid},x)$\u3002\u8fd9\u4e9b $s$ \u5f62\u6210\u4e86\u4e00\u6bb5\u533a\u95f4\uff0c\u800c\u8fd9\u4e2a\u533a\u95f4\u7684\u5de6\u7aef\u70b9\u5c31\u662f\u6700\u5c0f\u7684 $i$ \u6ee1\u8db3 $f_i \\ge \\mathrm{pre}(f_{mid},x)$\u3002\u4e8e\u662f\u5bf9\u8fd9\u6bb5\u533a\u95f4\u5185\u7684 $s$\uff0c\u4ee4 $f_{s+x} \\gets \\max(f_{s+x},\\mathrm{nxt}(f_{mid},x))$\u3002\u5219\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u533a\u95f4\u53d6 $\\max$\uff0c\u5355\u70b9\u67e5\u8be2\u7684\u6570\u636e\u7ed3\u6784\u3002\u53ef\u4ee5\u7528\u6807\u8bb0\u6c38\u4e45\u5316\u7684\u7ebf\u6bb5\u6811\u5b9e\u73b0\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(n + S \\log S(\\log S + \\log n))$\u3002\n\n[code](https://atcoder.jp/contests/arc150/submissions/37267910)",
        "postTime": 1671014635,
        "uid": 275273,
        "name": "zltqwq",
        "ccfLevel": 0,
        "title": "ARC150F \u9898\u89e3"
    }
]
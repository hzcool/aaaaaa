[
    {
        "content": "\u672c\u9898\u540c\u6b65\u6536\u5f55\u5728 [Atcoder \u9898\u76ee\u8865\u5168\u8ba1\u5212](https://www.luogu.com.cn/training/256520) \u4e2d\uff0c\u6b22\u8fce\u652f\u6301\u3002\n\n### \u9898\u76ee\u5206\u6790\uff1a\n\n\u6709\u65f6\u5019\u505a\u9898\u8bb2\u7a76\u4e2a\u773c\u7f18\u5427\uff0c\u6ca1\u7ffb\u8bd1\u7684\u65f6\u5019\u5c31\u89c9\u5f97\u5b83\u50cf\u5206\u5c42\u56fe\u6700\u77ed\u8defww\uff0c\u505a\u5b8c\u4e86\u8fd8\u771f\u662f\u3002\n\n\u4e00\u4e2a\u5f88\u6709\u7528\u7684\u6027\u8d28\uff0c$n,k \\le 1000$\uff0c\u6211\u4eec\u76f4\u63a5\u6309\u5df2\u7ecf\u8d2d\u4e70\u7684\u82b1\u7684\u6570\u91cf\u5206\u5c42\uff0c\u6a2a\u5411\u5148\u628a\u6bcf\u4e00\u5c42\u7684\u56fe\u5efa\u5168\uff0c\u7eb5\u5411\u6bcf\u4e2a\u70b9 $y_i$ \u7684\u4ee3\u4ef7\u8d2d\u4e70 $x_i$ \u6735\u82b1\uff0c\u5c31\u76f4\u63a5\u7b2c $i$ \u5c42\u7684\u70b9\u5411\u7b2c $i+x_i$ \u5c42\u6240\u5bf9\u5e94\u7684\u70b9\u8fde\u4e00\u6761\u4ee3\u4ef7\u4e3a $y_i$ \u7684\u8fb9\uff0c\u7528\u4ee3\u7801\u8868\u793a\u5c31\u662f `add(i+(j-1)*n,i+min(j-1+x,k)*n,y)`\uff0c\u5982\u679c\u8d2d\u4e70\u82b1\u7684\u6570\u91cf\u8d85\u8fc7 $k$\uff0c\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u771f\u7684\u77e5\u9053\u4e70\u4e86\u591a\u5c11\uff0c\u6240\u4ee5\u76f4\u63a5\u8fde\u5230\u7b2c $k+1$ \u5c42\u5bf9\u5e94\u7684\u70b9\u5c31\u53ef\u4ee5\u4e86\uff0c\u7136\u540e\u4ece\u7b2c $1$ \u5c42\u5411\u7b2c $k+1$ \u5c42\u8dd1\u6700\u77ed\u8def\u5373\u53ef\u3002\n\n\u5206\u6790\u590d\u6742\u5ea6\uff0c\u603b\u5171\u7684\u70b9\u6570\u4e3a $n \\times (k+1)$\uff0c\u8fb9\u6570\u6700\u591a\u5728 $4 \\times 10^6$ \u6761\u5de6\u53f3\uff0c\u6240\u4ee5 Dijkstra \u8dd1\u7684\u98de\u5feb\uff0c\u9690\u5f0f\u5efa\u56fe\u7684\u8bdd\u8dd1\u7684\u66f4\u5feb\u3002\n\n### Code.\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int N=3e6+10; bitset<N> st; \nint n,m,k,h[N],ne[N<<1],e[N<<1],idx; ll d[N],w[N<<1];\nvoid add(int u,int v,int c) {ne[++idx]=h[u],e[idx]=v,w[idx]=c,h[u]=idx;}\nvoid jk()\n{\n\tmemset(d,0x7f,sizeof d);\n\tpriority_queue<pair<ll,int>,vector<pair<ll,int> >,greater<pair<ll,int> > > q;\n\tq.emplace(make_pair(0ll,1)); d[1]=0;\n\twhile(! q.empty())\n\t{\n\t\tint u=q.top().second; q.pop(); if(st[u]) continue ; st[u]=1;\n\t\tfor(int i=h[u];~i;i=ne[i])\n\t\t{\n\t\t\tint j=e[i];\n\t\t\tif(d[j] > d[u] + w[i])\n\t\t\t{\n\t\t\t\td[j]=d[u]+w[i];\n\t\t\t\tif(! st[j]) q.emplace(make_pair(d[j],j));\n\t\t\t}\n\t\t}\n\t}\n}\nint main()\n{\n\tmemset(h,-1,sizeof h); scanf(\"%d%d%d\",&n,&m,&k);\n\tfor(int i=1,u,v,c;i<=m;i++)\n\t{\n\t\tscanf(\"%d%d%d\",&u,&v,&c);\n\t\tfor(int j=1;j<=k+1;j++) \n\t\t\tadd(u+(j-1)*n,v+(j-1)*n,c),add(v+(j-1)*n,u+(j-1)*n,c);\n\t}\n\tfor(int i=1,x,y;i<=n;i++)\n\t{\n\t\tscanf(\"%d%d\",&x,&y);\n\t\tfor(int j=1;j<=k;j++) \n\t\t\tadd(i+(j-1)*n,i+min(j-1+x,k)*n,y);\n\t}\n\tjk();\n\td[n*(k+1)] == d[n*(k+1)+1] ? puts(\"-1\") : printf(\"%lld\\n\",d[n*(k+1)]);\n\treturn 0;\n}\n```",
        "postTime": 1669782607,
        "uid": 897035,
        "name": "Shiina_Mahiru",
        "ccfLevel": 0,
        "title": "[IROHA2019D2 G] \u901a\u5b66\u8def \u9898\u89e3"
    }
]
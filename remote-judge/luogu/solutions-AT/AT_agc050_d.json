[
    {
        "content": "\u4e00\u5e74\u524d\u89c9\u5f97\u4e0d\u592a\u53ef\u505a\u7684\u9898\u3002\n\n\u6211\u4eec\u8981\u7b97\u4ec0\u4e48\uff1f\u6bcf\u4e2a\u4eba\u80fd\u62ff\u7269\u54c1\u7684\u6982\u7387\uff0c\u6240\u4ee5 dp \u7684\u72b6\u6001\u503c\u80af\u5b9a\u662f\u67d0\u79cd\u6982\u7387\u3002\n\n\u4e8b\u5b9e\u4e0a\uff0c\u5982\u679c\u4e00\u4e2a\u4eba\u9886\u5230\u4e86\u7269\u54c1\uff0c\u6211\u4eec\u76f4\u63a5\u5f53\u6210\u628a\u4ed6\u5220\u6389\uff0c\u663e\u7136\u4e0d\u5f71\u54cd\u7b54\u6848\u3002\n\n\u8003\u8651\u6ca1\u6709\u9886\u5230\u7684\u7269\u54c1\u7684\u4eba\uff0c\u4ee4\u5f53\u524d\u662f\u7b2c $x$ \u8f6e\uff0c\u663e\u7136\u4ed6\u8bd5\u8fc7 $x-1$ \u4e2a\u7269\u54c1\uff0c\u90a3\u4e48\u5c31\u662f\u5728 $k-(x-1)$ \u4e2a\u7269\u54c1\u91cc\u968f\u673a\u9009\u3002\n\n\u6211\u4eec\u4ee4\u73b0\u5728\u5269\u4e0b $m$ \u4e2a\u4eba\uff0c\u90a3\u4e48\u5c31\u53ea\u6709 $k-m$ \u4e2a\u7269\u54c1\u662f\u672a\u9009\u7684\uff0c\u5f53\u524d\u8fd9\u4e2a\u4eba\u80fd\u9886\u5230\u7269\u54c1\u7684\u6982\u7387\u5c31\u662f $(k-m)/(k-x+1)$ \u3002\n\n\u6211\u4eec\u5c31\u9488\u5bf9\u4e00\u4e2a\u4eba\u80fd\u9009\u5230\u7684\u6982\u7387\u8bbe\u8ba1 $dp$ \uff1a\n\n\n$dp_{x,y,z,w}$ \u8868\u793a\"\u5c0f\u660e\"\u5de6\u8fb9\u6709 $x$ \u4e2a\u4eba\uff0c\u53f3\u8fb9\u6709 $y$ \u4e2a\u4eba\uff0c\u7136\u540e\u6e38\u620f\u8fdb\u884c\u5230\u4e86 $x+y+1$ \u4e2a\u4eba\u4e2d\u7684\u7b2c $z$ \u4e2a\u4eba\uff0c\u5f53\u524d\u662f\u7b2c $w$ \u8f6e\uff0c\"\u5c0f\u660e\"\u80fd\u62ff\u5230\u7269\u54c1\u7684\u6982\u7387\u3002\n\n\u8f6c\u79fb\u7b80\u5355\uff0c\u590d\u6742\u5ea6 $O(n^4)$ \u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,m,inv[60];\nconst int mod=998244353;\nint dp[50][50][50][50];\nint dfs(int x,int y,int z,int w){\n\tif(dp[x][y][z][w]!=-1)return dp[x][y][z][w];\n\tif(w>m||n-(x+y+1)>=m)return 0;\n\tint I=inv[m-w+1],p=1ll*(m-n+x+y+1)*I%mod;\n\tint as;\n\tif(z==x+1)\n\t\tas=(p+1ll*(1-p)*(y?dfs(x,y,z+1,w):dfs(x,y,1,w+1))%mod)%mod;\n\telse if(z<=x)as=(1ll*p*dfs(x-1,y,z,w)%mod+1ll*(1-p)*dfs(x,y,z+1,w)%mod)%mod;\n\telse{\n\t\tif(z==x+y+1)as=(1ll*p*dfs(x,y-1,1,w+1)%mod+1ll*(1-p)*dfs(x,y,1,w+1)%mod)%mod;\n\t\telse as=(1ll*p*dfs(x,y-1,z,w)%mod+1ll*(1-p)*dfs(x,y,z+1,w)%mod)%mod;\n\t}\n\treturn dp[x][y][z][w]=(as+mod)%mod;\n}\nint main(){\n\tinv[1]=1;\n\tfor(int i=2;i<=55;i++)inv[i]=mod-1ll*(mod/i)*inv[mod%i]%mod;\n\tcin>>n>>m;\n\tmemset(dp,-1,sizeof(dp));\n\tfor(int i=1;i<=n;i++)\n\t\tprintf(\"%d\\n\",dfs(i-1,n-i,1,1));\n\treturn 0;\n}\n```\n",
        "postTime": 1666694643,
        "uid": 223624,
        "name": "Apollo13",
        "ccfLevel": 8,
        "title": "AGC050D"
    },
    {
        "content": "### solution\n\n\u8003\u8651\u7ecf\u8fc7 $i$ \u8f6e\u4e14\u5df2\u6709 $j$ \u4e2a\u4eba\u83b7\u80dc\uff0c\u90a3\u4e48\u5269\u4e0b\u6240\u6709\u4eba\u624b\u4e2d\u7684\u724c\u6570\u548c\u6ca1\u88ab\u522b\u4eba\u9009\u8fc7\u7684\u724c\u6570\u90fd\u662f\u56fa\u5b9a\u7684\uff0c\u5206\u522b\u662f $k-i$ \u548c $k-j$\u3002\u5b9e\u9645\u4e0a\u4e00\u4e2a\u5c40\u9762\u53ef\u4ee5\u7531\u5f53\u524d\u662f\u7b2c\u51e0\u8f6e\u3001\u8fd8\u6709\u51e0\u4e2a\u6ca1\u83b7\u80dc\u7684\u4eba\u3001\u5f53\u524d\u8f6e\u5230\u6ca1\u83b7\u80dc\u7684\u4eba\u4e2d\u7684\u7b2c\u51e0\u4e2a\u4eba\u64cd\u4f5c\u4e09\u4e2a\u53c2\u6570\u786e\u5b9a\uff0c\u518d\u52a0\u4e0a\u6211\u4eec\u60f3\u77e5\u9053\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $x$\uff0c\u7b2c $x$ \u4e2a\u4eba\u7684\u83b7\u80dc\u6982\u7387\uff0c\u52a0\u4e0a\u8fd9\u4e2a $x$\uff0c\u4e00\u5171\u56db\u4e2a\u53c2\u6570\u5373\u53ef\u786e\u5b9a\u72b6\u6001\u3002\n\n\u8bbe $f_{i,p,a,b}$ \u8868\u793a\u5f53\u524d\u5df2\u7ecf\u5b8c\u6210\u4e86 $i$ \u8f6e\uff08\u7b2c $i+1$ \u8f6e\u6b63\u5728\u8fdb\u884c\uff09\uff0c\u8f6e\u5230\u4e86\u5269\u4e0b\u7684\u4eba\u4e2d\u7684\u7b2c $p$ \u4e2a\u4eba\uff0c\u6211\u4eec\u671f\u671b\u77e5\u9053\u83b7\u80dc\u6982\u7387\u7684\u4eba\u524d\u9762\u5269 $a$ \u4e2a\u4eba\uff0c\u540e\u9762\u5269 $b$ \u4e2a\u4eba\uff08\u4e00\u5171\u5269 $len=a+b+1$ \u4e2a\u4eba\uff09\u7684\u60c5\u51b5\u4e0b\uff0c\u540e\u9762\uff08\u5305\u62ec\u5f53\u524d\uff09\u8fdb\u884c\u82e5\u5e72\u6b21\u64cd\u4f5c\u540e\u8fd9\u4e2a\u671f\u671b\u7684\u4eba\u7684\u83b7\u80dc\u6982\u7387\u3002\n\n\u5206\u60c5\u51b5\u8ba8\u8bba\u8f6c\u79fb\u5373\u53ef\uff08\u8bbe\u5f53\u524d\u4eba\u83b7\u80dc\u6982\u7387\u4e3a $A=\\dfrac{k-(n-len)}{k-i}$\uff0c\u5931\u8d25\u6982\u7387\u4e3a $B=1-A$\uff09\uff1a\n\n* \u5f53\u524d\u7684\u4eba\u5c31\u662f\u671f\u671b\u7684\u4eba\u3002$A$ \u7684\u6982\u7387\u76f4\u63a5\u83b7\u80dc\uff0c\u5426\u5219 $B\\times f_{i+\\lfloor\\frac{p}{len}\\rfloor,p\\bmod len+1,a,b}$ \u7684\u6982\u7387\u5728\u540e\u9762\u83b7\u80dc\u3002\n* \u5f53\u524d\u7684\u4eba\u5728\u671f\u671b\u7684\u4eba\u524d\u9762\u3002$A$ \u7684\u6982\u7387\u5f53\u524d\u4eba\u80dc\uff0c\u7136\u540e\u671f\u671b\u7684\u4eba $A\\times f_{i+\\lfloor\\frac{p}{len}\\rfloor,(p-1)\\bmod (len-1)+1,a-1,b}$ \u6982\u7387\u5728\u540e\u9762\u83b7\u80dc\uff1b$B$ \u6982\u7387\u5f53\u524d\u7684\u4eba\u8d25\uff0c\u7136\u540e\u671f\u671b\u7684\u4eba $B\\times f_{i+\\lfloor\\frac{p}{len}\\rfloor,p\\bmod len+1,a,b}$ \u7684\u6982\u7387\u5728\u540e\u9762\u83b7\u80dc\u3002\n* \u5f53\u524d\u7684\u4eba\u5728\u671f\u671b\u7684\u4eba\u540e\u9762\u3002$A$ \u7684\u6982\u7387\u5f53\u524d\u4eba\u80dc\uff0c\u7136\u540e\u671f\u671b\u7684\u4eba $A\\times f_{i+\\lfloor\\frac{p}{len}\\rfloor,(p-1)\\bmod (len-1)+1,a,b-1}$ \u6982\u7387\u5728\u540e\u9762\u83b7\u80dc\uff1b$B$ \u6982\u7387\u5f53\u524d\u7684\u4eba\u8d25\uff0c\u7136\u540e\u671f\u671b\u7684\u4eba $B\\times f_{i+\\lfloor\\frac{p}{len}\\rfloor,p\\bmod len+1,a,b}$ \u7684\u6982\u7387\u5728\u540e\u9762\u83b7\u80dc\u3002\n\n\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a $O(n^4)$\u3002\uff08\u5047\u8bbe $n,k$ \u540c\u9636\uff09\n\n### code\n```cpp\nint n,k,inv[45];\nint F[41][41][41][41];\nint f(int i,int p,int a,int b){\n\tif(~F[i][p][a][b]) return F[i][p][a][b];\n\tif(i==k) return F[i][p][a][b]=0;\n\tif(n-a-b-1==k) return F[i][p][a][b]=0;\n\tconst int len=a+b+1,A=1ll*(k-(n-len))*inv[k-i]%djq,B=(1-A+djq)%djq;\n\tif(p==a+1) return F[i][p][a][b]=add(1ll*f(i+p/len,p%len+1,a,b)*B%djq,A);\n\tif(p>a+1) return F[i][p][a][b]=add(1ll*f(i+p/len,p%len+1,a,b)*B%djq,1ll*f(i+p/len,(p-1)%(len-1)+1,a,b-1)*A%djq);\n\tif(p<a+1) return F[i][p][a][b]=add(1ll*f(i,p+1,a,b)*B%djq,1ll*f(i,p,a-1,b)*A%djq);\n\tassert(0);\n\treturn 0;\n}\nsigned main(){\n\t//file(); \n\tn=read(),k=read(); memset(F,-1,sizeof(F));\n\trep(i,n) inv[i]=ksm(i,djq-2);\n\trep(i,n) printf(\"%d\\n\",f(0,1,i-1,n-i));\n\treturn 0;\n}\n```",
        "postTime": 1666656081,
        "uid": 241977,
        "name": "Legitimity",
        "ccfLevel": 8,
        "title": "AGC050D"
    }
]
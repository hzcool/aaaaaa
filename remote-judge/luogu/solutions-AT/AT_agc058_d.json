[
    {
        "content": "# D - Yet Another ABC String\n\u9996\u5148\u57fa\u7840\u7684\u5bb9\u65a5\u662f\u8003\u8651**\u4e0d\u5408\u6cd5\u4f4d\u7f6e\u8d77\u70b9\u96c6\u5408** $\\{p_1, p_2, \\dots, p_k\\}$\uff0c\u8868\u793a $s_{p_i}s_{p_i + 1}s_{p_i + 2}\\in\\{\\texttt{ABC},\\texttt{BCA},\\texttt{CAB}\\}$\u3002\u5bb9\u65a5\u7cfb\u6570\u5c31\u662f $-1^{k}$\u3002\n\n\u4f46\u8fd9\u5e76\u4e0d\u597d\u7b97\uff0c\u56e0\u4e3a\u4e0d\u5408\u6cd5\u4f4d\u7f6e\u53ef\u80fd\u91cd\u5408\uff0c\u8fd9\u65f6\u5019\u662f\u6bd4\u8f83\u96be\u8ba1\u6570\u7684\uff08\u8fd8\u8981\u679a\u4e3e\u91cd\u53e0\u60c5\u51b5\u8fdb\u884c\u62fc\u63a5\uff09\u3002\n\n\u4e8e\u662f\u8f6c\u800c\u8003\u8651\u76f4\u63a5\u5bb9\u65a5**\u4e0d\u5408\u6cd5\u7ebf\u6bb5**\uff1a\u7528\u5e8f\u5217 $L=(L_1, L_2, \\dots, L_k)$ \u8868\u793a\u6709\u957f\u5ea6\u4e3a $L_1, L_2, \\dots, L_k$ \u7684**\u4e0d\u5408\u6cd5\u7ebf\u6bb5**\uff0c\u8fd9\u65f6\u5019\u662f\u6bd4\u8f83\u597d\u8ba1\u6570\u7684\uff0c\u4f46\u662f\u5bb9\u65a5\u7cfb\u6570\u9700\u8981\u6413\u4e00\u4e0b\u3002\n\n\u5bf9\u4e8e\u4e00\u4e2a\u957f\u5ea6\u4e3a $L_i$ \u7684**\u4e0d\u5408\u6cd5\u7ebf\u6bb5**\uff0c\u7528\u4e0a\u9762\u7684**\u4e0d\u5408\u6cd5\u4f4d\u7f6e\u8d77\u70b9\u96c6\u5408**\u7684\u5bb9\u65a5\u7cfb\u6570\u8ba1\u7b97\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n$$\n\\begin{aligned}\nF_3 &= -1 & \\{\\{1\\}\\}\\\\\nF_4 &= 1 & \\{\\{1, 2\\}\\}\\\\\nF_5 &= 0 & \\{\\{1,2,3\\},\\{1,3\\}\\}\\\\\nF_6 &= -1 & \\{\\{1,2,3,4\\},\\{1,2,4\\},\\{1,3,4\\}\\}\n\\end{aligned}\n$$\n\u518d\u5f80\u4e0b\u5c31\u4e0d\u5217\u4e3e\u4e86\uff0c\u5176\u5b9e\u53ef\u4ee5\u5f97\u5230\u9012\u63a8\u5f0f\uff0c$F_k=-F_{k-1} - F_{k - 2}$\uff0c\u4ece\u5728\u672b\u5c3e\u6dfb\u52a0\u70b9\u7684\u89d2\u5ea6\u8003\u8651\u4e0d\u96be\u7406\u89e3\u8be5\u5f0f\u3002\n\n\u901a\u8fc7\u4e0a\u8ff0\u5f0f\u5b50\uff0c\u53ef\u4ee5\u627e\u89c4\u5f8b\u5e76\u5f52\u7eb3\u8bc1\u660e\uff1a\n$$\nF_i=\n\\begin{cases}\n-1&i\\equiv0\\pmod 3\\\\\n1&i\\equiv1\\pmod3\\\\\n0&i\\equiv2\\pmod3\n\\end{cases}\n$$\n\u5f97\u5230\u5bb9\u65a5\u7cfb\u6570\u4e4b\u540e\uff0c\u8003\u8651\u600e\u4e48\u7b97\u51fa\u6240\u6709\u5e8f\u5217 $L$ \u7684\u8d21\u732e\u3002\n\n\u9996\u5148\u53ea\u9700\u8981\u8003\u8651 $L_i=3m$ \u548c $L_i=3m+1$ \u7684\u60c5\u51b5\uff0c\u524d\u8005\u662f\u76f4\u63a5\u586b `ABC` \u5404\u4e00\u4e2a\u4e0a\u53bb\uff0c\u540e\u8005\u662f\u8fd8\u8981\u591a\u586b\u4e00\u4e2a\u5355\u72ec\u5b57\u7b26\u3002\n\n\u90a3\u4e48\u53ef\u4ee5\u8bbe\u8ba1\u4e00\u4e2a dp\uff0c\u8bb0 $f_{i, j}$ \u8868\u793a\u5df2\u7ecf\u6784\u9020\u4e86\u957f\u5ea6\u4e3a $i$ \u7684\u5b57\u7b26\u4e32\uff0c\u591a\u586b\u4e86 $j$ \u4e2a\u5355\u72ec\u5b57\u7b26\u7684\u5bb9\u65a5\u7cfb\u6570\u3002\n$$\nf_{i, j}=f_{i-1, j-1}+\\sum_{k = 3}^{i}[k\\equiv1\\pmod3]f_{i-k, j - 1}-3[k\\equiv0\\pmod3]f_{i-k,j}\n$$\n\u524d\u9762\u7684 $f_{i-1,j -1}$ \u662f\u6307\u968f\u4fbf\u586b\u4e00\u4e2a\u5b57\u7b26\uff0c\u4e0d\u7ec4\u6210**\u4e0d\u5408\u6cd5\u7ebf\u6bb5**\u3002\n\n\u6700\u540e\u628a\u8ba1\u6570\u4e00\u5e76\u52a0\u4e0a\u53bb\uff1a\n$$\n\\mathrm{Ans}=\\sum_{i=0}^{\\min(a,b,c)}\\binom{n-3i}{a-i,b-i,c-i}f_{n,n-3i}\n$$\n\u5f97\u5230\u4e86\u4e00\u4e2a $O(n^3)$ \u7684\u505a\u6cd5\uff0c\u74f6\u9888\u5728\u4e8e dp \u592a\u6162\u4e86\u3002\n\n\u6ce8\u610f\u8d77\u70b9\u662f $f_{0, 0}=1$\uff0c\u8f6c\u79fb\u7cfb\u6570\u56fa\u5b9a\uff0c\u751f\u6210\u51fd\u6570\u975e\u5e38\u9002\u5408\u3002\n\n\u8bbe $G(x,y)$ \u4e3a $f_{x, y}$ \u7684\u751f\u6210\u51fd\u6570\uff0c\u53ef\u4ee5\u5f97\u5230\uff1a\n$$\n\\begin{aligned}\nF& = xy+\\sum_{i\\ge1}x^{3i+1}y-3\\sum_{i\\ge1}x^{3i}=\\sum_{i\\ge0}x^{3i+1}y-3\\sum_{i\\ge1}x^{3i}\\\\\nG& = \\sum_{i\\ge0}F^i\n\\end{aligned}\n$$\n\u7ecf\u5178\u9519\u9879\u51cf\u4e00\u51cf\u5c31\u53ef\u4ee5\u641e\u51fa\u6765\u8fa3\uff1a\n$$\n\\begin{aligned}\n&x^3F=\\sum_{i\\ge1}x^{3i+1}y-3\\sum_{i\\ge2}x^{3i}\\\\\n&(1-x^3)F=xy-3x^3\\\\\n&F=\\frac{xy-3x^3}{1-x^3}\\\\\n&G=\\frac{1}{1-F}=\\frac{1-x^3}{1-xy+2x^3}\n\\end{aligned}\n$$\n\u60f3\u641e $[x^ny^m]G$\uff0c\u5148\u62c6\u6210 $G'=\\frac{1}{1-xy+2x^3}$\uff0c\u5219 $[x^ny^m]G=[x^ny^m]G'-[x^{n-3}y^m]G'$\u3002\n\n\u95ee\u9898\u53d8\u6210\u600e\u4e48\u8ba1\u7b97 $[x^ny^m]G'$\uff1a\u8fd9\u4e1c\u897f\u53ef\u4ee5\u62c6\u6210 $G'=\\displaystyle\\sum_{i\\ge0}(xy-2x^3)^i$\uff0c\u597d\u6d88\u606f\u662f\u53ef\u4ee5\u76f4\u63a5\u89e3\u65b9\u7a0b\u3002\n\n\u8bbe\u5de6\u8fb9\u8d21\u732e $p$ \u6b21\uff0c\u53f3\u8fb9\u8d21\u732e $q$ \u6b21\uff0c\u6709 $\\begin{cases}p+3q=n\\\\q=m\\end{cases}$\uff0c\u89e3\u51fa $p, q$ \u540e\u4e0d\u96be\u5f97\u5230 $[x^ny^m]G'=\\binom{p+q}{p}(-2)^{q}$\u3002\n\n\u76f4\u63a5\u679a\u4e3e $[x^ny^{n-3i}]G$ \u5373\u53ef\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $\\Theta(n)$\u3002\n",
        "postTime": 1669868803,
        "uid": 280800,
        "name": "lingfunny",
        "ccfLevel": 7,
        "title": "AGC058D \u9898\u89e3"
    },
    {
        "content": "> \u7ed9\u51fa $a,b,c$\uff0c\u6c42\u7531 $a$ \u4e2a A\uff0c$b$ \u4e2a B\uff0c$c$ \u4e2a C \u6784\u6210\u7684\u5b57\u7b26\u4e32\u6570\u91cf\uff0c\u4f7f\u5f97\u4e0d\u5b58\u5728\u5b50\u4e32 `ABC`\uff0c`BCA` \u548c `CAB`\u3002$1 \\leq a,b,c \\leq 10^6$\n\n\u573a\u4e0a\u7684\u60f3\u6cd5\uff1a\u80af\u5b9a\u662f\u5bb9\u65a5\uff0c\u94a6\u5b9a\u4e00\u4e9b\u4f4d\u7f6e\u662f\u8fd9\u4e09\u7c7b\u4e32\u540e\u94a6\u5b9a\u7684\u90e8\u5206\u6784\u6210\u4e86\u4e00\u4e9b\u8fde\u901a\u5b50\u6bb5\uff0c\u5bb9\u65a5\u7cfb\u6570\u662f $(-1)$ \u7684\u94a6\u5b9a\u603b\u957f\u6b21\u65b9\uff0c\u4f46\u662f\u56e0\u4e3a\u9650\u5236\u4e86 ABC \u7684\u6570\u91cf\u65b9\u6848\u6570\u4e0d\u597d\u8ba1\u7b97\u3002\n\n\u8003\u8651\u4ece\u4e32\u7684\u6574\u4f53\u51fa\u53d1\u7684\u5bb9\u65a5\u65b9\u6cd5\u3002\n\n\u6ce8\u610f\u5230\u8fd9\u4e09\u79cd\u4e32\u90fd\u662f $\\mathtt{ABCABC\\cdots}$ \u7684\u4e00\u90e8\u5206\u3002\u8003\u8651\u628a `AB`\uff0c`BC`\uff0c`CA` \u5408\u8d77\u6765\u540e\u7684\u9694\u677f\uff0c\u4e00\u4e2a\u4e32\u5408\u6cd5\u5f53\u4e14\u4ec5\u5f53\u76f8\u90bb\u9694\u677f\u8ddd\u79bb\u4e0d\u8d85\u8fc72\u3002\n\n\u94a6\u5b9a\u9694\u677f\u7684\u5b50\u96c6\u7136\u540e\u5bb9\u65a5\u3002\u5982\u679c\u6211\u4eec\u8981\u8ba1\u7b97\u9694\u677f\u6070\u597d\u662f $S$ \u7684\u65b9\u6848\u6570 $f_S$\uff0c\u4ee4\u94a6\u5b9a\u662f $T$ \u7684\u65b9\u6848\u6570\u662f $g_T$\uff0c\u90a3\u4e48 $f_S = \\sum_{T \\subseteq S} g_T(-1)^{|S| - |T|}$\u3002\n\n\u6211\u4eec\u8981\u6c42\u5408\u6cd5\u7684 $S$ \u7684 $f$ \u4e4b\u548c\u3002\u4ea4\u6362\u6c42\u548c\u53f7\uff0c\u5bf9\u4e8e\u4e00\u79cd\u94a6\u5b9a\u7684 $T$\uff0c\u6c42\u76f8\u5e94\u5408\u6cd5 $S$ \u7684\u5bb9\u65a5\u7cfb\u6570\u4e4b\u548c\uff0c\u7136\u540e\u4e58\u4e0a $g_T$\u3002\n\n\u8bbe\u94a6\u5b9a\u7684 $T$ \u4e2d\u4e00\u6bb5\u957f\u5ea6\u4e3a $i$ \u7684\u8fde\u7eed\u6bb5\u5404\u79cd\u9009 $S$ \u7684\u65b9\u5f0f\u5bb9\u65a5\u7cfb\u6570\u4e4b\u548c\u4e3a $c_i$\uff0c\u5219 $c_1 = 1, c_2 = 0, c_i(i \\geq 3) = -c_{i-1} - c_{i-2}$\uff0c\u5f97\u5230\n\n$$\nc_i = \\begin{cases}1\\quad (i \\equiv 1 \\pmod 3) \\\\0\\quad (i \\equiv 2 \\pmod 3)\\\\-1\\quad (i \\equiv 0 \\pmod 3)\\end{cases}\n$$\n\n\u7136\u540e\u9700\u8981\u6c42 $g_T$\u3002\u679a\u4e3e $T$ \u4e2d\u6709\u591a\u5c11\u4e2a\u6a213\u4f591\u7684\u6bb5\uff08\u8bb0\u4e3a $x(3|(n-x))$\uff09\uff0c\u5269\u4e0b\u7684\u6bb5\u957f\u5ea6\u90fd\u662f3\u7684\u500d\u6570\uff08\u56e0\u4e3a\u6a213\u4f592\u6ca1\u6709\u8d21\u732e\uff09\uff0c\u8bbe\u6709 $y$ \u4e2a\u3002\u6839\u636e $a,b,c$ \u53ef\u4ee5\u6c42\u51fa\u6bcf\u4e2a\u5b57\u6bcd\u662f\u591a\u5c11\u4e2a\u6a213\u4f591\u7684\u6bb5\u7684\u5f00\u5934\uff0c\u8bb0\u4e3a $c_A,c_B,c_C$\u3002\u5148\u786e\u5b9a\u5f00\u5934\uff08\u957f\u5ea6\u4e3a1\u62163\uff09\u7684\u4f4d\u7f6e\uff0c\u518d\u628a\u5269\u4f59\u7684\u957f\u5ea6\u4e3a3\u7684\u6bb5\u63d2\u8fdb\u53bb\u3002\u90a3\u4e48\u53ea\u9700\u8ba1\u7b97 ${x \\choose c_A \\; c_B \\; c_C}$ \u4e58\u4e0a\n\n$$\n\\sum_y (-3)^y{x+y\\choose x}{{n-x\\over 3}+x-1 \\choose x+y-1}  \\\\\n=\\sum_y(-3)^y[{x+y-1 \\choose x} +{x+y-1 \\choose x-1}]{{n-x\\over 3}+x-1 \\choose x+y-1} \\\\\n=\\sum_y(-3)^y[{{n-x\\over 3}+x-1 \\choose x}{{n-x\\over 3} - 1\\choose y-1}+{{n-x\\over 3}+x-1 \\choose x-1}{{n-x\\over 3} - 1\\choose y}] \\\\\n=-3\\cdot{{n-x\\over 3}+x-1 \\choose x}(-2)^{{n-x\\over 3}-1}[x<n]+{{n-x\\over 3}+x-1 \\choose x-1}(-2)^{n-x\\over 3}[x>0]\n$$\n\n\u5373\u53ef\u3002\uff08\u6ce8\u610f\u7ec4\u5408\u6570\u7684\u89c4\u8303\u5b9a\u4e49\uff0c\u4e0a\u8ff0\u63a8\u5bfc\u4e0d\u9700\u8981\u5bf9\u53d8\u91cf\u7684\u8303\u56f4\u6709\u989d\u5916\u9650\u5236\uff09",
        "postTime": 1667993474,
        "uid": 161577,
        "name": "psoet",
        "ccfLevel": 0,
        "title": "AGC058D"
    },
    {
        "content": "\u611f\u8c22 gyh \u795e\u4ed9\u7684\u601d\u8def\u3002\n\n\u6211\u4eec\u9996\u5148\u53d1\u73b0\u4e0d\u5408\u6cd5\u533a\u95f4\u662f\u53ef\u4ee5\u5408\u5e76\u7684\u3002\u5177\u4f53\u6765\u8bf4\uff0c\u82e5 $[i,i+2]$ \u4e0d\u5408\u6cd5\uff0c$[i+2,i+4]$ \u4e0d\u5408\u6cd5\uff0c\u90a3\u4e48 $[i+1,i+3]$ \u4e5f\u4e0d\u5408\u6cd5\u3002\n\n\u4e8e\u662f\u6211\u4eec\u8003\u8651\u5bb9\u65a5\uff0c\u6211\u4eec\u53ef\u4ee5\u6c42\u51fa\u94a6\u5b9a\u51fa\u73b0\u4e86 $k$ \u4e2a\u8fde\u7eed\u4e0d\u5408\u6cd5\u6bb5\u7684\u65b9\u6848\u6570\uff0c\u5373\u94a6\u5b9a\u5b58\u5728 $k$ \u4e2a\u4f4d\u7f6e\u6ee1\u8db3 $[i,i+2]$ \u975e\u6cd5\u4e14 $[i+1,i+3]$ \u5408\u6cd5\u6216 $i+2$ \u662f\u5e8f\u5217\u7ed3\u5c3e\uff0c\u8fd9\u6837\u94a6\u5b9a\u7684\u6bcf\u4e2a\u4f4d\u7f6e\u8981\u4fdd\u8bc1\u548c\u4e0b\u4e00\u4e2a\u4f4d\u7f6e\u5408\u6cd5\u6709\u4e24\u79cd\u586b\u6cd5\uff0c\u5728\u7b97\u4e0a\u94a6\u5b9a\u5230\u4e86\u7ed3\u5c3e\u7684\u65b9\u6848\u6570\u5373\u53ef\uff0c\u5177\u4f53\u5f0f\u5b50\u53ef\u89c1\u4ee3\u7801\uff0c\u590d\u6742\u5ea6 $O(n)$ \u3002\n\n```cpp\n#include<iostream>\n#include<cstdio>\n#define int long long \nusing namespace std;\nint read(){\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();}\n\treturn x*f;\n}\nconst int N=3000030,mod=998244353;\nint n,a,b,c,jc[N],inv[N],mi[N];\nint ksm(int p,int k){\n\tint x=1;\n\twhile(k){\n\t\tif(k&1)x=x*p%mod;\n\t\tp=p*p%mod;\n\t\tk>>=1;\n\t}\n\treturn x;\n}\nint C(int n,int m){\n\tif(n<m)return 0;\n\treturn jc[n]*inv[m]%mod*inv[n-m]%mod;\n}\nsigned main(){\n\ta=read(),b=read(),c=read();\n\tn=a+b+c,jc[0]=mi[0]=1;\n\tfor(int i=1;i<=n;i++){\n\t\tjc[i]=jc[i-1]*i%mod;\n\t\tmi[i]=mi[i-1]*2%mod;\n\t}\n\tinv[n]=ksm(jc[n],mod-2);\n\tfor(int i=n;i;i--){\n\t\tinv[i-1]=inv[i]*i%mod;\n\t}\n\tint ans=C(n,a)*C(n-a,b)%mod,nw=1;\n\tfor(int i=1;i<=min(min(a,b),c);i++){\n\t\tint m=n-3*i,x=C(m,a-i)*C(m-(a-i),b-i)%mod;nw=-nw;\n\t\t//m\u4e3a\u53bb\u6389\u94a6\u5b9a\u4f4d\u7f6e\u7684\u5e8f\u5217\u957f\u5ea6\uff0cx\u4e3a\u6b64\u65f6\u4efb\u610f\u586b\u7684\u65b9\u6848\u6570\u3002 \n\t\tans=(ans+nw*(x*C(m+i,i)%mod*mi[i]+x*C(m+i-1,i-1)%mod*mi[i-1])%mod+mod)%mod;\n\t\t//\u6ce8\u610f\u5982\u679c\u94a6\u5b9a\u5230\u7ed3\u5c3e\u90a3\u4e48\u7ed3\u5c3e\u6709\u4e09\u79cd\u586b\u6cd5\uff0c\u628a\u5c11\u7b97\u7684\u4e00\u79cd\u52a0\u4e0a\u3002 \n\t}\n\tcout<<ans;\n\treturn 0;\n}\n\n\n```\n",
        "postTime": 1678073401,
        "uid": 116640,
        "name": "Exusiai_",
        "ccfLevel": 0,
        "title": "AGC058D"
    }
]
[
    {
        "content": "\u6253\u8868\uff0c\u53d1\u73b0\u6700\u540e\u4e00\u6bb5\u662f\u7b49\u5dee\u6570\u5217\uff0c\u4e8e\u662f\u5dee\u5206\u4e00\u4e0b\u3002\r\n\r\n\u5dee\u5206\u540e\uff0c\u53d1\u73b0\u5927\u7ea6\u5728 $\\sqrt x$ \u9879\u540e\uff0c\u6570\u5217\u5168\u90e8\u76f8\u7b49\u3002\u89c2\u5bdf\u76f8\u7b49\u524d\u7684\u51e0\u9879\uff0c\u4ecd\u7136\u662f\u7b49\u5dee\u6570\u5217\uff0c\u8003\u8651\u518d\u5dee\u5206\u4e00\u6b21\u3002\r\n\r\n\u5dee\u5206\u540e\uff0c\u53d1\u73b0\u6570\u5217\u53ea\u6709\u5927\u7ea6 $\\sqrt[3]x$ \u6bb5\u3002\u91cd\u65b0\u89c2\u5bdf\u4e00\u9636\u5dee\u5206\uff0c\u53d1\u73b0\u7b49\u5dee\u6570\u5217\u4e00\u76f4\u6301\u7eed\u5230\u5373\u5c06\u53d8\u5f97\u5c0f\u4e8e $0$\uff0c\u6211\u4eec\u53ef\u4ee5\u636e\u6b64\u7b97\u51fa\u4e8c\u9636\u5dee\u5206\u76f8\u540c\u7684\u4e00\u6bb5\u6570\u7684\u957f\u5ea6\u3002\u53ef\u4ee5\u5229\u7528\u4e8c\u6b21\u51fd\u6570\u6c42\u548c\u7684\u65b9\u6cd5 $O(1)$ \u5730\u8ba1\u7b97\u4e8c\u9636\u5dee\u5206\u76f8\u540c\u7684\u4e00\u6bb5\u5bf9\u5e94\u7684\u539f\u6570\u5217\u7684\u548c\u3002\r\n\r\n\u65f6\u95f4\u590d\u6742\u5ea6 $O(T\\sqrt[3]x)$\u3002\r\n",
        "postTime": 1667440055,
        "uid": 79067,
        "name": "dottle",
        "ccfLevel": 10,
        "title": "ARC135E"
    },
    {
        "content": "\u9898\u610f\uff1a\u7ed9\u5b9a $N,X$\uff0c\u6784\u9020\u6570\u5217 $A$\uff0c\u4f7f\u5f97 $A_1=X,i|A_i,A_i<A_{i+1}$\uff0c\u6700\u5c0f\u5316 $\\sum\\limits_{i=1}^n A_i$\n\n\u9898\u89e3\uff1a\u6709 $A_i=i(\\lfloor \\dfrac{A_{i-1}}{i}\\rfloor +1)$\uff0c\u8bbe $B_{i}=\\dfrac {A_i}{i}$\uff0c\u5219 $B_{i+1}=\\lfloor \\dfrac{iB_{i}}{i+1}\\rfloor+1=B_i+1-\\lceil \\dfrac{B_i}{i+1}\\rceil$\u3002\n\n\u6545 $B_{i}-B_{i+1}=\\lceil \\dfrac{B_i}{i+1}\\rceil-1$\uff0c\u6545 $B_i$ \u4e0d\u589e\u3002\u8003\u5bdf\u4e00\u4e2a $A_i$ \u7684\u4e0a\u754c\uff1a\n$$\nA_i\\leqslant X+\\sum_{j=2}^i j<X+\\dfrac 12 i(i+1),B_i<\\dfrac{X}{i}+\\dfrac 12 (i+1)\n$$\n\u6ce8\u610f\u5230\u6570\u636e\u8303\u56f4\u662f $10^{18}$ \u6211\u4eec\u5e0c\u671b\u5f97\u5230\u4e00\u4e2a $X^{\\frac 13}$ \u7684\u505a\u6cd5\uff0c\u8bbe $L=X^{\\frac 13}$\uff0c\u6211\u4eec\u53d1\u73b0\uff1a\n\n- \u5f53 $i<=L$ \u65f6\uff0c$B_i-B_{i+1}$ \u81f3\u591a\u6709 $L$ \u79cd\u53d6\u503c\uff1b\n- \u5f53 $i>L$ \u65f6\uff0c\u7531\u4e8e $B_L-B_{L+1}=\\lceil \\dfrac{B_L}{L+1}\\rceil-1<\\lceil \\dfrac{\\frac XL+\\frac 12(L+1)}{L+1}\\rceil=O(L)$\uff0c\u4e5f\u53ea\u6709 $O(L)$ \u79cd\uff1b\n\n\u4e8e\u662f\u6211\u4eec\u53ea\u7528\u5bf9\u8fd9 $O(X^{\\frac 13})$ \u4e2a\u8fde\u7eed\u6bb5\u8ba1\u7b97\u7b54\u6848\u5373\u53ef\u3002\n\n\u5047\u8bbe\u4e00\u4e2a\u6bb5\u7684\u5f00\u5934\u4e3a $l$\uff0c\u4ee4 $x=\\lceil \\dfrac{B_l}{l+1}\\rceil$\uff0c\u5219 $r$ \u4e3a\u6ee1\u8db3 $x=\\lceil \\frac{B_l-(r-l)(x-1)}{r+1}\\rceil$ \u7684\u6700\u5927\u7684 $r$\u3002\n$$\nx=\\lceil \\frac{B_l-(r-l)(x-1)}{r+1}\\rceil=\\lceil \\frac{B_l+(l+1)(x-1)}{r+1}\\rceil-x+1\n$$\n$$\n2x-1=\\lceil \\frac{B_l+(l+1)(x-1)}{r+1}\\rceil=\\lfloor \\frac{B_l+(l+1)(x-1)-1}{r+1}\\rfloor+1\n$$\n$$\nr+1=\\lfloor \\frac{B_l+(l+1)(x-1)-1}{2x-2}\\rfloor\n$$\n```\n#include<bits/stdc++.h>\nusing namespace std;\nconst int maxn=2e5+10;\nconst int mod=998244353;\nconst int iv6=(mod+1)/6;\nconst int iv2=(mod+1)/2;\n#define int long long\ninline int read(){\n\tint x=0,f=1;char c=getchar();\n\twhile(c<'0'||c>'9'){if(c=='-')f=-1;c=getchar();}\n\twhile(c>='0'&&c<='9'){x=(x<<1)+(x<<3)+c-'0';c=getchar();}\n\treturn x*f;\n}\nint n,X,T;\ninline int S1(int x){x%=mod;return x*(x+1)%mod*iv2%mod;}\ninline int S2(int x){x%=mod;return x*(x+1)%mod*(x+x+1)%mod*iv6%mod;}\ninline int calc(int l,int r,int x,int d){\n\tint SS1=S1(r)-S1(l-1),SS2=S2(r)-S2(l-1);\n\treturn (SS1*(x%mod-(d%mod)*(l%mod)%mod)+(d%mod)*SS2%mod)%mod;\n}\nsigned main(){\n\tT=read();while(T--){\n\t\tn=read(),X=read();int ans=0;\n\t\tfor(int l=1,r;l<=n;l=r){\n\t\t\tint x=(X+l)/(l+1);if(x==1)r=n+1;\n\t\t\telse r=min(n+1,max(l+1,(X+(l+1)*(x-1)-1)/(x+x-2)));\n\t\t\tans+=calc(l,r-1,X,1-x);X-=(r-l)*(x-1);\n\t\t}printf(\"%lld\\n\",(ans%mod+mod)%mod);\n\t}return 0;\n}\n```\n\u6df1\u6df1\u5730\u611f\u5230\u81ea\u5df1\u7684\u5f31\u5c0f\u3002",
        "postTime": 1670229314,
        "uid": 140876,
        "name": "syzf2222",
        "ccfLevel": 9,
        "title": "Sequence of Multiples"
    },
    {
        "content": "\u6280\u5de7\u6027\u6bd4\u8f83\u5f3a\u7684\u9898\uff08\uff1f\n\n\u8bbe $a$ \u4e3a\u6700\u4f18\u89e3\u7684 $A$\uff0c\u5219 $a$ \u53ef\u4ee5\u8d2a\u5fc3\u6784\u9020\uff0c\u5c31\u662f\u6bcf\u4e00\u4f4d\u90fd\u53d6\u5230\u4e0b\u754c\u3002\n\n\u8003\u8651\u8bbe $b_i = \\frac{a_i}{i}$\uff0c\u56e0\u4e3a $i \\times b_i < (i + 1) \\times b_{i+1}$\uff0c\u5219 $b_{i+1} = \\left\\lfloor\\frac{i \\times b_i}{i+1}\\right\\rfloor + 1 = b_i - \\left\\lceil\\frac{b_i}{i+1}\\right\\rceil + 1$\uff0c\u5f97\u5230 $b_i - b_{i+1} = \\left\\lceil\\frac{b_i}{i+1}\\right\\rceil - 1$\uff0c\u6240\u4ee5 $b$ \u4e0d\u589e\u3002\n\n\u8003\u8651 $b_i$ \u4e00\u4e2a\u6bd4\u8f83\u5bbd\u677e\u7684\u4e0a\u754c\uff1a\n\n$$\\because a_i \\le X + \\sum\\limits_{j=2}^i j = X - 1 + \\frac{i(i+1)}{2} < X + i^2$$\n\n$$\\therefore b_i < \\frac{X}{i} + i$$\n\n\u53d1\u73b0 $b_i$ \u7684\u51cf\u5c0f\u901f\u5ea6\u5927\u81f4\u4f1a\u8d8a\u6765\u8d8a\u5e73\u7f13\u3002\u8003\u8651\u7c7b\u6839\u53f7\u5206\u6cbb\uff0c\u89c2\u5bdf $b_i - b_{i+1}$\uff0c\u53d1\u73b0\u5b83\u53ea\u6709 $O(X^{\\frac{1}{3}})$ \u79cd\u53d6\u503c\u3002\u8bc1\u660e\uff1a\n\n- $i \\le X^{\\frac{1}{3}}$\uff0c$b_i - b_{i+1}$ \u6709 $O(X^{\\frac{1}{3}})$ \u79cd\u53d6\u503c\uff1b\n- $i > X^{\\frac{1}{3}}$\uff0c$b_i - b_{i+1} = \\left\\lceil\\frac{b_i}{i+1}\\right\\rceil - 1 < \\left\\lceil\\frac{\\frac{X}{i}+i}{i+1}\\right\\rceil = O(X^{\\frac{1}{3}})$\uff0c\u6709 $O(X^{\\frac{1}{3}})$ \u79cd\u53d6\u503c\u3002\n\n\u8003\u8651\u5bf9\u6781\u957f\u7b49\u5dee\u8fde\u7eed\u6bb5 $[l,r]$ \u8ba1\u7b97\u3002\u8bbe $b_l - b_{l+1} = b_{l+1} - b_{l+2} = \\cdots = b_{r-1} - b_r = k$\uff0c\u6211\u4eec\u5e0c\u671b\u8ba1\u7b97 $\\sum\\limits_{i=l}^r a_i$\u3002\n\n$$\\sum\\limits_{i=l}^r a_i$$\n\n$$= \\sum\\limits_{i=1}^r i \\times b_i$$\n\n$$= \\sum\\limits_{i=l}^r i \\times (b_l + (l - i) \\times k)$$\n\n$$= \\sum\\limits_{i=l}^r i \\times b_l + i \\times (l - i) \\times k$$\n\n$$= \\sum\\limits_{i=l}^r i \\times (b_l + k \\times l) - k \\times i^2$$\n\n\u8bbe $f(x) = \\sum\\limits_{i=1}^x i = \\frac{i(i+1)}{2}$\uff0c$g(x) = \\sum\\limits_{i=1}^x i^2 = \\frac{i(i+1)(2i+1)}{6}$\uff0c\u5f97\u5230\uff1a\n\n$$\\sum\\limits_{i=l}^r i \\times (b_l + k \\times l) - k \\times i^2$$\n\n$$= (b_l + k \\times l) \\times (f(r) - f(l-1)) - k \\times (g(r) - g(l-1))$$\n\n\u81f3\u6b64\u53ef\u4ee5 $O(1)$ \u8ba1\u7b97\u6781\u957f\u7b49\u5dee\u8fde\u7eed\u6bb5\u7684 $\\sum\\limits_{i=l}^r a_i$\u3002\n\n\u73b0\u5728\u95ee\u9898\u662f\u77e5\u9053\u5de6\u7aef\u70b9 $l$\uff0c\u5982\u4f55\u6c42\u6781\u957f\u7b49\u5dee\u8fde\u7eed\u6bb5\u7684\u53f3\u7aef\u70b9 $r$\u3002\u6211\u4eec\u6709 $b_{r-1} - b_r = b_l - b_{l+1}$\uff0c\u5373 $\\left\\lceil\\frac{b_l + (l-r+1)(\\left\\lceil\\frac{b_l}{l+1}\\right\\rceil-1)}{r}\\right\\rceil = \\left\\lceil\\frac{b_l}{l+1}\\right\\rceil$\uff0c\u53ef\u4ee5\u4e8c\u5206\u5f97\u5230 $r$\u3002\n\n\u603b\u65f6\u95f4\u590d\u6742\u5ea6 $O(TX^{\\frac{1}{3}} \\log N)$\uff0c\u4f18\u5316\u4e8c\u5206\u4e0a\u754c\u540e\u53ef\u4ee5\u901a\u8fc7\u3002\n\n[code](https://atcoder.jp/contests/arc135/submissions/41243665)",
        "postTime": 1683525772,
        "uid": 275273,
        "name": "zltqwq",
        "ccfLevel": 0,
        "title": "ARC135E \u9898\u89e3"
    }
]
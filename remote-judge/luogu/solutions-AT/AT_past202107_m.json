[
    {
        "content": "\u672c\u9898\u540c\u6b65\u6536\u5f55\u5728 [Atcoder \u9898\u76ee\u8865\u5168\u8ba1\u5212](https://www.luogu.com.cn/training/256520) \u4e2d\uff0c\u6b22\u8fce\u652f\u6301\u3002\n\n### \u9898\u76ee\u5206\u6790\uff1a\n\n\u6700\u4f18\u7ec4\u5408\u65b9\u5f0f\u7684\u6700\u5c0f\u5316\u95ee\u9898\u548c\u8fd9\u4e2a\u5f88\u5c0f\u7684\u6570\u636e\u8303\u56f4\uff0c\u5e94\u8be5\u53ef\u4ee5\u60f3\u5230\u8d39\u7528\u6d41\u5427\uff0c\u6709\u4e00\u4e2a\u5f88\u667a\u6167\u7684\u5efa\u56fe\u65b9\u6cd5\uff0c\u6240\u4ee5\u4ecb\u7ecd\u7b80\u5355\u7684\u5566\u3002\n\n\u56e0\u4e3a\u5e8f\u5217\u7684\u7ec4\u5408\u4e0d\u9700\u8981\u8fde\u7eed\uff0c\u4e3a\u4e86\u8868\u8fbe\u4e00\u4e2a\u70b9\u662f\u5426\u88ab\u9009\u62e9\uff0c\u53ef\u4ee5\u60f3\u5230\u62c6\u70b9\uff0c\u5bf9\u4e8e\u70b9 $i$ \u7684\u5bf9\u5e94\u70b9 $i'$\uff0c\u5206\u522b\u7f16\u53f7 $i$ \u4e0e $i+n$ \u8868\u793a\uff0c\u5efa\u7acb\u4e00\u4e2a\u865a\u62df\u6e90\u70b9 $s$ \uff0c\u6c47\u70b9 $t$ \u548c\u51b3\u7b56\u70b9 $E$\uff0c\u5efa\u56fe\u65b9\u5f0f\u4e3a\uff1a\n\n- $s \\rightarrow i,i'\\rightarrow t,i \\rightarrow E(1\\le i \\le n)$ \u5206\u522b\u5efa\u4e00\u6761\u6d41\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u4e3a $0$ \u7684\u8fb9\u3002\n\n- $E \\rightarrow t$ \u5efa\u4e00\u6761\u6d41\u91cf\u4e3a $n$\uff0c\u8d39\u7528\u4e3a $c$ \u7684\u8fb9\u3002\n\n- $i \\rightarrow j'(1 \\le i <j \\le n)$ \u5efa\u4e00\u6761\u6d41\u91cf\u4e3a $1$\uff0c\u8d39\u7528\u4e3a $\\lvert a_i - a_j \\rvert$ \u7684\u8fb9\u3002\n\n\u6d45\u8ff0\u4e00\u4e0b\u8fd9\u79cd\u5199\u6cd5\u7684\u6b63\u786e\u6027\uff0c\u9898\u76ee\u8981\u6c42\u6bcf\u4e00\u6bb5\u90fd\u4f1a\u6709\u989d\u5916\u8d39\u7528 $c$\uff0c\u4ece\u6e90\u70b9 $s$ \u6d41\u5230\u6bcf\u4e2a\u70b9\u90fd\u6709\u4e24\u79cd\u51b3\u7b56\uff0c\u6d41\u5411\u865a\u70b9 $j'$ \u6216\u8005\u6d41\u5411\u51b3\u7b56\u70b9 $E$\u3002\u6d41\u5411\u865a\u70b9 $j'$ \u7684\u6d41\u91cf\u4f1a\u628a\u8fd9\u6761\u8def\u5f84 $( s \\rightarrow i \\rightarrow j' \\rightarrow t)$ \u7684\u6240\u6709\u6d41\u91cf\u5360\u6ee1\uff0c\u8868\u793a\u4e3a\u4e86 $i$ \u70b9\u7684\u8d21\u732e\uff1b\u6d41\u5411\u51b3\u7b56\u70b9 $E$\uff0c\u53ef\u4ee5\u8ba4\u4e3a\u524d\u9762\u7684\u51b3\u7b56\u5df2\u7ecf\u6784\u6210\u4e86\u4e00\u4e2a\u5b50\u5e8f\u5217\uff0c$i$ \u4e3a\u8fd9\u4e2a\u5b50\u5e8f\u5217\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20\uff0c\u6ca1\u6709\u5411\u540e\u7684\u5339\u914d\u5bf9\u8c61\uff0c\u6dfb\u52a0\u6574\u6570 $c$ \u7684\u8d21\u732e\u8868\u793a\u7ed3\u675f\u3002\n\n### Code.\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\nusing namespace std;\nconst int N=5e4+10,M=1e5+10,imax=0x3f3f3f3f; bitset<N> st; ll mncost,w[M];\nint h[N],ne[M],e[M],f[M],a[N],n,m,s,t,pl,E,idx,d[N];\nvoid add(int u,int v,int c,int cost)\n{\n\tne[idx]=h[u],e[idx]=v,f[idx]=c,w[idx]=cost,h[u]=idx++;\n\tne[idx]=h[v],e[idx]=u,f[idx]=0,w[idx]=-cost,h[v]=idx++;\n}\nbool spfa()\n{\n\tmemset(d,0x3f,sizeof d); d[s]=0;\n\tdeque<int> q; q.emplace_back(s);\n\twhile(! q.empty())\n\t{\n\t\tint u=q.front(); q.pop_front(); st[u]=0;\n\t\tfor(int i=h[u];~i;i=ne[i])\n\t\t{\n\t\t\tint j=e[i];\n\t\t\tif(d[j] > d[u]+w[i] && f[i])\n\t\t\t{\n\t\t\t\td[j]=d[u]+w[i];\n\t\t\t\tif(! st[j]) \n\t\t\t\t{\n\t\t\t\t\tst[j]=1;\n\t\t\t\t\tif(q.size() && d[j] < d[q.front()]) q.emplace_front(j);\n\t\t\t\t\telse q.emplace_back(j);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn d[t] != imax;\n}\nint find(int u,int fl)\n{\n\tif(u == t) return fl; st[u]=1; int flu=0;\n\tfor(int i=h[u];flu < fl && ~i;i=ne[i])\n\t{\n\t\tint j=e[i];\n\t\tif(d[j] == d[u] + w[i] && f[i] && ! st[j])\n\t\t{\n\t\t\tint res=find(j,min(f[i],fl-flu)); if(! res) d[j]=-1;\n\t\t\tf[i]-=res; f[i^1]+=res; flu+=res; mncost+=res*w[i];\n\t\t}\n\t}\n\tst[u]=0; return flu;\n}\nint main()\n{\n\tmemset(h,-1,sizeof h);\n\tscanf(\"%d%d\",&n,&pl); s=(n<<1)+10; t=s+1; E=t+1;\n\tfor(int i=1;i<=n;i++) scanf(\"%d\",a+i); add(E,t,n,pl);\n\tfor(int i=1;i<=n;i++) add(s,i,1,0),add(i+n,t,1,0),add(i,E,1,0);\n\tfor(int i=1;i<=n;i++) for(int j=i+1;j<=n;j++) add(i,j+n,1,abs(a[i]-a[j]));\n\twhile(spfa()) while(find(s,INT_MAX)) ; printf(\"%lld\\n\",mncost);\n\treturn 0;\n}\n```",
        "postTime": 1669563664,
        "uid": 897035,
        "name": "Shiina_Mahiru",
        "ccfLevel": 0,
        "title": "[7th PAST M] Divide \u9898\u89e3"
    }
]
[
    {
        "content": "\u9996\u5148\u9700\u8981\u660e\u786e\u7684\u662f\uff0c\u6211\u4eec\u8981\u6c42\u7684\u662f\u4e0d\u540c\u7684\u67d3\u8272\u65b9\u6848\u6570\uff01\uff01\uff01\n\n\u7136\u540e\u6211\u4eec\u4e0d\u59a8\u6765\u8003\u8651\u4e00\u4e0b\u4e00\u4e2a\u53ea\u6709\u5411\u53f3\u548c\u5411\u4e0b\u7684\u7279\u6b8a\u60c5\u51b5\u3002\n\n\u7136\u540e\u4f60\u4f1a\u53d1\u73b0\u4ed6\u4e00\u5b9a\u6ee1\u8db3\u6709\u4e00\u4e2a\u5411\u53f3\u4e0b\u5ef6\u4f38\u7684\u989c\u8272\u7684\u5206\u754c\u7ebf\uff0c\u4e3a\u4ec0\u4e48\u5462\uff1f\n\n\u6211\u4eec\u9996\u5148\u6bd4\u8f83\u663e\u7136\u7684\uff0c\u82e5\u56fe\u4e0a\u6709 $n$ \u4e2a\u5411\u53f3\u7684\uff0c $m$ \u4e2a\u5411\u4e0b\u7684\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u5176\u7b80\u5316\u4e3a\u4e00\u4e2a $n\\times m$ \u7684\u77e9\u5f62\u3002\n\n\u7136\u540e\u4f60\u9996\u5148\u5bf9\u4e8e $(1,1)$ \u8fd9\u4e2a\u683c\u5b50\uff0c\u4f60\u53d1\u73b0\u5bf9\u4e8e\u4ed6\u7684\u989c\u8272\uff0c\u5b9e\u9645\u4e0a\u662f\u51b3\u5b9a\u4e86\u662f\u7b2c\u4e00\u884c\u7684\u673a\u5668\u4eba\u5148\u8d70\u8fd8\u662f\u7b2c\u4e00\u5217\u7684\u673a\u5668\u4eba\u5148\u8d70\uff0c\u5982\u679c\u662f\u7b2c\u4e00\u884c\u7684\u5148\u8d70\uff0c\u4f60\u5c31\u53ef\u4ee5\u5f80\u53f3\u4e00\u683c\uff0c\u7ee7\u7eed\u8003\u8651\u662f\u7b2c\u4e00\u884c\u7684\u5148\u8d70\u8fd8\u662f\u7b2c\u4e8c\u5217\u7684\u5148\u8d70\u2026\u2026\u5982\u6b64\u7c7b\u63a8\uff0c\u4f60\u53d1\u73b0\u6700\u7ec8\u7684\u4e00\u79cd\u6d82\u8272\u72b6\u6001\u5fc5\u7136\u5bf9\u5e94\u4e00\u79cd\u7531 $(1,1)$ \u8d70\u5230 $(n+1,m+1)$ \u7684\u65b9\u6848\u3002\n\n\u4e3a\u4ec0\u4e48\u662f $(n+1,m+1)$ \u5462\uff1f\u5b9e\u9645\u4e0a\u6211\u4eec\u989c\u8272\u7684\u6bd4\u8f83\u5230\u8fbe\u7b2c $n+1$ \u884c\u6216\u8005\u7b2c $m+1$ \u5217\u662f\u5c31\u53ef\u4ee5\u7ed3\u675f\u4e86\uff0c\u76f8\u5f53\u4e8e\u662f\u8981\u7edf\u8ba1\u4ece $(1,1)$ \u5230\u7b2c $n+1$ \u884c\u548c\u7b2c $m+1$ \u5217\u7684\u603b\u65b9\u6848\u6570\uff0c\u6b64\u6570\u503c\u6b63\u597d\u7b49\u4e8e\u5230\u8fbe $(n+1,m+1)$ \u7684\u65b9\u6848\u6570\u3002\n\n\u4ee5\u4e0a\uff0c\u6211\u4eec\u76f8\u5f53\u4e8e\u8bc1\u660e\u4e86\u4e00\u4e2a\u53ea\u6709 $n$ \u4e2a\u5411\u53f3\u7684\u548c $m$ \u4e2a\u5411\u4e0b\u7684\u4f4d\u7f6e\u7684\u65b9\u6848\u6570\u4e3a $\\binom{n+m}{n}$ \u3002\n\n\u6211\u4eec\u9700\u8981\u5c06\u8fd9\u4e2a\u4e1c\u897f\u6269\u5c55\u4e00\u4e0b\u3002\u6211\u4eec\u8003\u8651\u518d\u52a0\u4e00\u4e2a\u5411\u4e0a\u7684\u65b9\u5411\u8be5\u5982\u4f55\u8ba1\u7b97\u5462\uff1f\n\n\u6cbf\u7528\u6211\u4eec\u4e0a\u9762\u7684\u601d\u8def\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u4f4d\u7f6e\u6211\u4eec\u53ef\u80fd\u8981\u8003\u8651\u4e09\u4e2a\u65b9\u5411\u7684\u5148\u540e\uff0c\u597d\u50cf\u4e0d\u597d\u529e\u4e86\u3002\n\n\u4f46\u662f\u5982\u679c\u4f60\u53d1\u73b0\u5982\u679c\u5b58\u5728\u4e00\u6761\u6a2a\u7ebf\u5c06\u5176\u6a2a\u5411\u5212\u5206\u5f00\uff0c\u90a3\u4e48\u4ed6\u5c31\u88ab\u8f6c\u5316\u4e3a\u4e86\u6211\u4eec\u4e0a\u8ff0\u7684\u5b50\u95ee\u9898\u4e86\u3002\n\n\u6211\u4eec\u4e0d\u59a8\u8bbe\u5411\u53f3\u7684\u6709 $n$ \u4e2a\uff0c\u5411\u4e0b\u7684\u6709 $m$ \u4e2a\uff0c\u5411\u4e0a\u7684\u6709 $k$ \u4e2a\uff0c\u6211\u4eec\u94a6\u5b9a\u9009\u62e9\u4e00\u4e2a\u6a2a\u5411\u7684\u8fde\u4e0a\uff0c\u7136\u540e\u540c\u65f6\u5f3a\u5236\u4e0a\u534a\u90e8\u5206\u4e0d\u80fd\u540c\u65f6\u51fa\u73b0\u6a2a\u5411\u8fde\u6ee1\u7684\uff0c\u4e0b\u534a\u90e8\u5206\u5374\u53ef\u4ee5\uff0c\u90a3\u4e48\u5f0f\u5b50\u662f\uff1a\n$$\nf(n,m,k)=\\sum_{i=1}^n\\binom{i+m-2}{m-1}\\binom{n-i+k}{k}\\\\\n=\\binom{n+m+k-1}{n-1}\n$$\n\u76ee\u524d\u4e3a\u6b62\uff0c\u6211\u4eec\u5df2\u7ecf\u89e3\u51b3\u4e86\u6709\u4e09\u4e2a\u65b9\u5411\u7684\u95ee\u9898\uff0c\u5f0f\u5b50\u5982\u4e0a\u3002\n\n\u5176\u5b9e\u4f60\u53ef\u4ee5\u5c06\u4e24\u4e2a\u5f0f\u5b50\u5206\u522b\u770b\u6210\u4f60\u8981\u8d70\u7684\u4e24\u4e2a\u65b9\u5411\u7684\u65b9\u6848\u6570\uff0c\u7136\u540e\u8fd9\u4e2a $\\sum$ \u5b9e\u9645\u4e0a\u53ef\u4ee5\u770b\u6210\u662f\u679a\u4e3e\u4f60\u5728\u4ec0\u4e48\u4f4d\u7f6e\u5411\u53f3\uff08\u6216\u5411\u4e0a\uff0c\u603b\u4e4b\u5c31\u662f\u4e0d\u662f\u548c $i$ \u5728\u540c\u4e00\u4e2a\u7ef4\u5ea6\u4e0a\u7684\u65b9\u5411\uff09\u8d70\u4e00\u6b65\uff0c\u7136\u540e\u6574\u4e2a\u5f0f\u5b50\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a\u7ec4\u5408\u6570\u3002\n\n\u7136\u540e\u8003\u8651\u56db\u4e2a\u65b9\u5411\u7684\u600e\u4e48\u529e\uff0c\u6709\u4e00\u79cd\u65b9\u6cd5\u5c31\u662f\u679a\u4e3e\u5982\u4f55\u5c06\u6574\u4e2a\u77e9\u5f62\u5206\u89e3\u6210\u4e09\u4e2a\u65b9\u5411\u7684\uff0c\u590d\u6742\u5ea6\u5e94\u8be5\u662f $O(n^2)$ \u7684\uff0c\u7136\u540e\u4f60\u8003\u8651\u524d\u7f00\u548c\u4f18\u5316\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\u5427\u3002\n\n\u6211\u6765\u8bd5\u4e00\u8bd5\u3002\n\n---\n\n\u7136\u540e\u4f60\u53d1\u73b0\uff0c\u5982\u679c\u8fd9\u4e48\u505a\u7684\u8bdd\u6709\u5f88\u591a\u7684\u6837\u4f8b\u662f\u8fc7\u4e0d\u4e86\u7684\uff0c\u4e00\u4e0b\u6709\u51e0\u4e2a\u9700\u8981\u7279\u5224\u7684\u5730\u65b9\u3002\n\n1. \u5982\u679c\u6ca1\u6709\u673a\u5668\u4eba\uff0c\u8f93\u51fa $1$ \u3002\n2. \u8003\u8651\u6a2a\u7ad6\u4e24\u4e2a\u65b9\u5411\u90fd\u53ef\u4ee5\u5c06\u6574\u4e2a\u77e9\u5f62\u5206\u6210\u4e24\u4e2a\u53ea\u6709\u4e09\u4e2a\u65b9\u5411\u7684\u77e9\u5f62\u3002\n3. \u5728\u8003\u8651\u4e09\u4e2a\u65b9\u5411\u7684\u95ee\u9898\u65f6\uff0c\u5982\u679c $n$ \u662f $0$ \uff0c\u5c31\u4e0d\u80fd\u7528\u516c\u5f0f\u8ba1\u7b97\u4e86\uff0c\u5177\u4f53\u5982\u4f55\u8ba1\u7b97\u53ef\u4ee5\u81ea\u5df1\u601d\u8003\u3002\n\n### \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\nconst int N=1e5+5;\nconst int MOD=998244353;\nint n,m,fac[N<<2],ifac[N<<2];\nint a[N],b[N],c[N],d[N];//r,l,d,u\nint f[N],res=0;\nint ksm(int x,int k){\n\tint res=1;\n\tfor(;k;k>>=1,x=x*x%MOD)\n\tif(k&1) res=res*x%MOD;\n\treturn res;\n}\nint cal(int n,int m){\n\tif(n<0||m<0||n<m) return 1;\n\treturn fac[n]*ifac[m]%MOD*ifac[n-m]%MOD;\n}\nvoid solve(){\n\tmemset(f,0,sizeof(f));\n\tint cnt1=0,cnt2=0,cnt3=0;\n\tfor(int i=1;i<=n;++i) cnt1+=a[i];\n\tfor(int i=1;i<=n;++i) cnt2+=b[i];\n\tif(!cnt1&&!cnt2){\n\t\tfor(int i=1;i<=m;++i) cnt3+=(c[i]&&d[i]);\n\t\tres+=ksm(2,cnt3),res%=MOD;\n\t\treturn ;\n\t}\n\tif(!cnt2){\n\t\tswap(cnt1,cnt2);\n\t\tfor(int i=1;i<=n;++i) swap(a[i],b[i]);\n\t\tfor(int i=1;i<=(m>>1);++i) swap(c[i],c[m-i+1]);\n\t\tfor(int i=1;i<=(m>>1);++i) swap(d[i],d[m-i+1]);\n\t}\n\tif(cnt1){\n\t\tfor(int i=1;i<=m;++i){\n\t\t\tif(c[i]||d[i]) f[i]=cal(cnt1+cnt3-1,cnt1-1);\n\t\t\tcnt3+=c[i]+d[i];\n\t\t}\n\t\tfor(int i=1;i<=m;++i){\n\t\t\tf[i]+=f[i-1],f[i]%=MOD;\n\t\t\tif(c[i]&&d[i]) f[i]<<=1,f[i]%=MOD;\n\t\t}\n\t}\n\telse{\n\t\tfor(int i=1;i<=m;++i){\n\t\t\tcnt3+=(c[i]&&d[i]);\n\t\t\tif(c[i]||d[i]) f[i]=ksm(2,cnt3);\n\t\t}\n\t}\n\tcnt3=0;\n\tfor(int i=m;i>=1;--i){\n\t\tif(c[i]||d[i]) res+=f[i]*cal(cnt2+cnt3-1,cnt2-1)%MOD,res%=MOD;\n\t\tcnt3+=c[i]+d[i];\n\t}\n}\nsigned main(){\n\tcin>>n>>m,fac[0]=ifac[0]=1;\n\tfor(int i=1;i<=n+n+m+m;++i) fac[i]=fac[i-1]*i%MOD;\n\tfor(int i=1;i<=n+n+m+m;++i) ifac[i]=ksm(fac[i],MOD-2);\n\tint cnt=0;\n\tfor(int i=1;i<=n;++i) scanf(\"%1lld\",&a[i]),cnt+=a[i];\n\tfor(int i=1;i<=n;++i) scanf(\"%1lld\",&b[i]),cnt+=b[i];\n\tfor(int i=1;i<=m;++i) scanf(\"%1lld\",&c[i]),cnt+=c[i];\n\tfor(int i=1;i<=m;++i) scanf(\"%1lld\",&d[i]),cnt+=d[i];\n\tif(!cnt) return printf(\"1\"),0;\n\tsolve(),swap(n,m),swap(a,d),swap(a,b),swap(a,c),solve();\n\treturn printf(\"%lld\\n\",res),0;\n}\n```\n\n",
        "postTime": 1614947368,
        "uid": 72468,
        "name": "\u300c\u3000\u300d",
        "ccfLevel": 0,
        "title": "AT3558 Modern Painting"
    }
]
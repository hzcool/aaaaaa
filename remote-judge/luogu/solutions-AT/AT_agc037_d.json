[
    {
        "content": "## [AGC037D](https://atcoder.jp/contests/agc037/tasks/agc037_d)\r\n\r\n### \u57fa\u672c\u8f6c\u5316\r\n\r\n\u4ece $D$ \u53d8\u6210 $C$ \uff0c \u53d1\u73b0\u53ea\u9700\u8981\u4fdd\u8bc1\u6bcf\u884c\u4e2d\u662f\u5b83\u8fd9\u4e00\u884c $D$ \u4e2d\u5143\u7d20\u7684\u6392\u5217\u5373\u53ef\u3002\r\n\r\n\u4ece $C$ \u53d8\u6210 $B$ \uff0c \u53d1\u73b0 $B$ \u9700\u8981 \u5728 $C$ \u4e2d\u662f\u540c\u4e00\u884c\u7684\u5143\u7d20\u8981\u901a\u8fc7\u5217\u4e0a\u7684\u4ea4\u6362\u53d8\u5230\u4e00\u884c\u4e0a\uff0c\u4e5f\u5c31\u662f\u4fdd\u8bc1 $C$ \u4e2d\u540c\u4e00\u884c\u7684\u5143\u7d20\u4e0d\u80fd\u5728\u76f8\u540c\u7684\u5217\u4e0a\u3002\r\n\r\n### sol1 (\u7206\u6807)\r\n\r\n\u95ee\u9898\u8f6c\u5316\u6210\u4e86\uff0c\u7ed9\u5b9a\u4e00\u4e2a $n\\times m$ \u7684\u77e9\u9635 $\\rm A$ \uff0c \u518d\u7ed9\u5b9a $n$ \u4e2a\u5f62\u5982\u4ee5\u4e0b\u7684\u9650\u5236\uff1a\u6307\u5b9a $m$ \u4e2a\u5143\u7d20\uff0c\u8981\u6c42\u4ed6\u4eec\u4e0d\u80fd\u5728\u540c\u4e00\u5217\u4e0a\u3002\r\n\r\n\u4fdd\u8bc1\u6bcf\u4e2a\u5143\u7d20\u88ab\u6307\u5b9a\u4e00\u6b21\uff0c\u8981\u6c42\u4efb\u610f\u6392\u5217\u6bcf\u4e00\u884c\u6ee1\u8db3\u9650\u5236\u3002\r\n\r\n\u7ee7\u7eed\u89c2\u5bdf\u6027\u8d28\uff0c\u53d1\u73b0\u6211\u4eec\u60f3\u8981\u6cdb\u5316\u95ee\u9898\uff0c\u53ef\u4ee5\u628a\u521d\u59cb\u7ed9\u5b9a\u7684\u77e9\u9635\u548c\u64cd\u4f5c\u4e5f\u8f6c\u5316\u6210\u9650\u5236\uff0c\u4e5f\u5c31\u662f\u521d\u59cb\u77e9\u9635\u7ed9\u5b9a\u7684\u6bcf\u4e00\u884c\u5143\u7d20\u4e0d\u80fd\u5728\u540c\u4e00\u5217\u4e0a\u3002\r\n\r\n\u8fd9\u6837\uff0c\u95ee\u9898\u5c31\u53ea\u5269\u4e0b\u4e86 $2\\times n$ \u4e2a\u9650\u5236\uff0c\u9700\u8981\u7ed9\u6bcf\u4e2a\u5143\u7d20\u67d3\u4e0a $m$ \u79cd\u989c\u8272\u4e2d\u7684\u4e00\u79cd\uff0c\u4f7f\u5f97\u6bcf\u4e2a\u9650\u5236\u7684\u96c6\u5408\u5185\u989c\u8272\u4e0d\u540c\u3002\r\n\r\n\u522b\u5fd8\u4e86\u6211\u4eec\u8f6c\u5316\u7684\u8fc7\u7a0b\u4e2d\uff0c\u9650\u5236\u5e76\u4e0d\u4e00\u822c\uff0c\u5177\u6709\u4efb\u610f\u4e00\u4e2a\u5143\u7d20\u51fa\u73b0\u4e14\u4ec5\u51fa\u73b0\u5728\u4e24\u4e2a\u9650\u5236\u5185\uff0c\u4e14\u5b58\u5728 $n$ \u4e2a\u65e0\u4ea4\u7684\u9650\u5236\u7684\u5e76\u96c6\u662f\u5168\u96c6\uff0c\u5e76\u4e14\u8fd9 $n$ \u4e2a\u9650\u5236\u7684\u8865\u96c6\u4e5f\u6ee1\u8db3\u65e0\u4ea4\u4e14\u5e76\u662f\u5168\u96c6\u3002\r\n\r\n\u65e2\u7136\u53ef\u4ee5\u5206\u6210\u4e24\u4e2a\u662f\u5168\u96c6\u7684\u96c6\u5408\uff0c\u8003\u8651\u5efa\u4e00\u5f20\u4e8c\u5206\u56fe\u51fa\u6765\uff0c\u5de6\u53f3\u4e24\u90e8\u5206\u5206\u522b\u662f $n$ \u4e2a\u5e76\u96c6\u662f\u5168\u96c6\u7684\u65e0\u4ea4\u9650\u5236\u3002\r\n\r\n\u6bcf\u4e2a\u5143\u7d20\u51fa\u73b0\u4e14\u4ec5\u51fa\u73b0\u5728\u4e24\u4e2a\u9650\u5236\u5185\uff0c\u5c31\u628a\u4ed6\u4eec\u8fde\u4e00\u6761\u8fb9\u3002\r\n\r\n\u95ee\u9898\u53d8\u6210\u4e86\u7ed9\u5b9a\u4e00\u4e2a\u5de6\u53f3\u5206\u522b\u6709 $n$ \u4e2a\u70b9\u7684\u4e8c\u5206\u56fe\uff0c\u6bcf\u4e2a\u70b9\u6709 $m$ \u6761\u8fb9\uff0c\u8981\u6c42\u7ed9\u6bcf\u6761\u8fb9\u67d3 $1 \\sim m$ \u7684\u8272\uff0c\u4f7f\u5f97\u6bcf\u4e2a\u70b9\u8fde\u51fa\u7684\u8fb9\u4e2d\u6070\u597d\u5305\u542b $m$ \u79cd\u989c\u8272\u3002\r\n\r\n\u8fd9\u4e2a\u95ee\u9898\u662f Vizing \u5b9a\u7406\u7684\u7ecf\u5178\u5f62\u5f0f\uff0c\u76f4\u63a5\u5957\u7528\u5176\u6784\u9020\u6027\u8bc1\u660e\u65b9\u6cd5\uff0c\u5373\u53ef\u505a\u5230 $O(n\\times nm)=O(n^3)$ \uff0c [code](https://atcoder.jp/contests/agc037/submissions/32528777)\r\n\r\n### sol2 (\u6807\u7b97)\r\n\r\n\u8fd8\u6709\u53e6\u5916\u4e00\u79cd\u8f6c\u5316\u7684\u65b9\u5f0f\uff0c\u8003\u8651\u5148\u628a $D$ \u4e2d\u540c\u4e00\u884c\u7684\u5143\u7d20\u67d3\u4e0a\u4e00\u79cd\u8272\u3002\r\n\r\n\u90a3\u4e48\u5c31\u662f\u7ed9\u5b9a\u4e00\u4e2a $n \\times m$ \u7684\u77e9\u9635 $\\rm A$\uff0c\u6bcf\u4e2a\u5143\u7d20\u88ab\u67d3\u4e0a\u4e86\u4e00\u79cd\u989c\u8272\uff0c\u4fdd\u8bc1\u4e00\u5171\u6709 $n$ \u79cd\u989c\u8272\u4e14\u6bcf\u79cd\u51fa\u73b0 $m$ \u4e2a\u3002\r\n\r\n\u8981\u6c42\u6392\u5217\u6bcf\u4e00\u884c\uff0c\u4f7f\u5f97\u6bcf\u5217\u5305\u542b\u6070\u597d $n$ \u79cd\u989c\u8272\u3002\r\n\r\n\u6bcf\u884c\u5efa\u7acb\u4e00\u4e2a\u8282\u70b9\uff0c\u6bcf\u4e2a\u989c\u8272\u5efa\u7acb\u4e00\u4e2a\u8282\u70b9\uff0c\u6bcf\u884c\u5411\u5305\u542b\u7684\u6bcf\u4e2a\u989c\u8272\u8fde\u5305\u542b\u6b21\u6570\u6761\u8fb9\u3002\r\n\r\n\u8fd9\u4e2a\u4e8c\u5206\u56fe\u7684\u4e00\u4e2a\u5b8c\u7f8e\u5339\u914d\u5bf9\u5e94\u4e86\u4e00\u5217\u7684\u65b9\u6848\uff0c\u53ea\u9700\u8981\u8dd1 $m$ \u6b21\u5c31\u53ef\u4ee5\u5f97\u5230 $\\rm B$ \u77e9\u9635\u3002\r\n\r\n\u95ee\u9898\u662f\u600e\u4e48\u8bc1\u660e\u8fd9\u4e2a\u56fe\u4e00\u5b9a\u625b\u5f97\u4f4f $m$ \u4e2a\u5b8c\u7f8e\u5339\u914d\u3002\r\n\r\n\u8fd8\u5269 $k$ \u5217\u6ca1\u9009\u62e9\u7684\u65f6\u5019\uff0c\u8fd9\u5f20\u56fe\u662f\u4e00\u5f20 k-\u6b63\u5219 \u4e8c\u5206\u56fe\uff0c\u6839\u636e Hall \u5b9a\u7406\u7684\u63a8\u8bba\uff0c\u4e00\u5b9a\u5b58\u5728\u5b8c\u7f8e\u5339\u914d\u3002\r\n\r\n> \u4e00\u4e2a\u65e0\u5411\u56fe\uff0c\u6bcf\u4e2a\u70b9\u5ea6\u6570\u90fd\u662f $k$ \uff0c\u5219\u79f0\u8fd9\u4e2a\u56fe\u4e3a k-\u6b63\u5219\u56fe\u3002\r\n\r\n>\u5047\u8bbe\u5b58\u5728\u4e00\u4e2a\u96c6\u5408 $S$, $|N(S)|<|S|$, \u7531\u4e8e $|S|$ \u5411 $|N(S)|$ \u8fde\u4e86 $|S|\\times k$ \u6761\u8fb9\uff0c\u6240\u4ee5 $N(S)$ \u81f3\u5c11\u6709 $|S|\\times k$ \u6761\u8fb9\uff0c\u4f46\u662f $N(S)$ \u53ea\u6709 $N(S)\\times k$ \u6761\u8fb9\uff0c\u4e0e\u5047\u8bbe\u77db\u76fe\uff0c\u6545\u63a8\u8bba\u6210\u7acb\u3002\r\n\r\n\r\n### summary\r\n\r\n\u6211\u4eec\u60ca\u5947\u7684\u53d1\u73b0\uff0c\u867d\u7136\u4ece\u4e24\u79cd\u5b8c\u5168\u4e0d\u540c\u7684\u89d2\u5ea6\u601d\u8003\uff0c\u4f46\u662f\u5efa\u51fa\u6765\u7684\u56fe\u7adf\u7136\u662f\u5b8c\u5168\u4e00\u6837\u7684\uff01\r\n\r\n~~\u4e5f\u5c31\u662f\u4f60\u4eec\u4e0d\u8dd1 $m$ \u6b21\u6700\u5927\u6d41\u800c\u662f\u76f4\u63a5\u8dd1 Vizing \u5b9a\u7406\u4e5f\u53ef\u4ee5\u7206\u6807\u54e6~~~\u3002\r\n\r\n\u540c\u65f6\uff0c\u4e5f\u53ef\u4ee5\u8fd9\u4e48\u53bb\u7406\u89e3 sol1\uff0c\u5728\u8fd9\u4e2a\u56fe\u4e0a\u627e\u4e00\u4e2a\u5b8c\u7f8e\u5339\u914d\uff0c\u7136\u540e\u628a\u4ed6\u4eec\u90fd\u67d3\u4e0a\u4e00\u79cd\u67d3\u8272\uff0c\u7b2c $i$ \u6b21\u67d3\u7b2c $i$ \u79cd\u67d3\u8272\uff0c\u56e0\u4e3a\u662f\u5b8c\u7f8e\u5339\u914d\uff0c\u6240\u4ee5\u6bcf\u4e2a\u70b9\u5728\u8fd9\u79cd\u989c\u8272\u90fd\u6709\u4e14\u4ec5\u6709\u4e00\u6761\u8fb9\u8986\u76d6\u5b83\uff0c\u4e00\u5b9a\u80fd\u4fdd\u8bc1\u6bcf\u4e2a\u70b9\u6070\u597d\u5305\u542b $n$ \u79cd\u989c\u8272\u3002",
        "postTime": 1655532594,
        "uid": 365246,
        "name": "YksKuusiTAlv",
        "ccfLevel": 0,
        "title": "AGC037D \u7b80\u5355\u7206\u6807\u505a\u6cd5"
    },
    {
        "content": "\u6807\u7b7e: \u4e8c\u5206\u56fe\u5339\u914d\n\n#### Part 1\n\n\u8003\u8651\u7528 $D$ \u5411\u524d\u8fd8\u539f\u6210 $C$ . \u663e\u7136\u53ea\u8981\u6bcf\u4e2a\u5143\u7d20\u5728 $C$ \u6307\u5728\u5176\u6240\u5904\u7684\u884c $C$ \u5c31\u662f\u5408\u6cd5\u7684.\n\n\u8003\u8651 $C$ \u8fd8\u539f $B$ , \u6211\u4eec\u5c06\u540c\u4e00\u884c\u7684\u5143\u7d20\u67d3\u6210\u4e00\u79cd\u989c\u8272(\u65b9\u4fbf\u8d77\u89c1\u8bb0 $col_x=\\lfloor \\frac{x-1}m\\rfloor+1)$ ), \u663e\u7136 $B$ \u7684\u6bcf\u4e00\u5217\u6070\u597d\u5305\u542b\u6bcf\u79cd\u989c\u8272\u7684\u5143\u7d20\u6070\u597d\u4e00\u4e2a, \u5e76\u4e14\u8fd9\u6837\u7684 $B$ \u53ef\u4ee5\u5f88\u5bb9\u6613\u5730\u5f97\u5230\u4e00\u4e2a\u5408\u6cd5\u7684 $C$ .\n\n\u90a3\u4e48\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a\u7ed9\u5b9a\u4e00\u4e2a\u77e9\u9635 $A$ , \u6bcf\u4e2a\u5143\u7d20\u6709\u4e00\u4e2a\u989c\u8272\u4e14\u6bcf\u4e2a\u989c\u8272\u6070\u597d\u51fa\u73b0 $m$ \u4e2a, \u8981\u6c42\u4efb\u610f\u6392\u5217\u6bcf\u4e00\u884c\u5730\u5143\u7d20\u540e\u4f7f\u5f97\u6bcf\u4e00\u5217\u6070\u597d\u5305\u542b\u6bcf\u4e00\u79cd\u989c\u8272.\n\n#### Part 2\n\n\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u4e00\u4e2a\u4e8c\u5206\u56fe\u5339\u914d\u7684\u7b97\u6cd5, \u4e3a\u6bcf\u4e00\u884c\u5efa\u7acb\u4e00\u4e2a\u8282\u70b9, \u4e3a\u6bcf\u4e00\u79cd\u989c\u8272\u5efa\u7acb\u4e00\u4e2a\u8282\u70b9, \u884c\u8282\u70b9\u5411\u884c\u5305\u542b\u7684\u989c\u8272\u8fde\u8fb9. \u8fd9\u4e2a\u4e8c\u5206\u56fe\u7684\u4e00\u4e2a**\u5b8c\u7f8e\u5339\u914d**\u7b49\u4ef7\u4e8e\u77e9\u9635 $B$ \u4e00\u5217\u7684\u65b9\u6848, \u90a3\u4e48\u6211\u4eec\u53ea\u8981\u505a $m$ \u6b21\u4e8c\u5206\u56fe\u5339\u914d\u5e76\u53d6\u51fa $m$ \u6b21\u5b8c\u7f8e\u5339\u914d\u5c31\u53ef\u4ee5\u6784\u9020\u4e00\u4e2a\u5408\u6cd5\u7684 $B$ \u4e86.\n\n\u90a3\u4e48\u95ee\u9898\u5c31\u662f\u6211\u4eec\u4efb\u610f\u53d6\u5b8c\u7f8e\u5339\u914d\u662f\u5426\u80fd\u4fdd\u8bc1\u4e4b\u540e\u4e00\u5b9a\u80fd\u53d6\u51fa\u5b8c\u7f8e\u5339\u914d. \u7b54\u6848\u662f\u80af\u5b9a\u7684: \u8003\u8651\u8fd8\u5269 $k$ \u5217\u65b9\u6848\u672a\u51b3\u5b9a, \u6b64\u65f6\u6bcf\u4e2a\u884c\u8282\u70b9\u548c\u989c\u8272\u8282\u70b9\u7684**\u5ea6\u6570**\u90fd\u6070\u597d\u4e3a $k$ , \u6211\u4eec\u5047\u8bbe\u6b64\u65f6\u4e0d\u5b58\u5728\u5b8c\u7f8e\u5339\u914d, \u6839\u636e Hall \u5b9a\u7406, \u5fc5\u7136\u6709\u4e00\u4e2a\u884c\u8282\u70b9\u7684\u96c6\u5408 $S$ , \u4f7f\u5f97 $S$ \u8fde\u5411\u7684\u6240\u6709\u989c\u8272\u8282\u70b9\u7684\u96c6\u5408 $T$ \u6ee1\u8db3 $|S|>|T|$ . \u53c8\u77e5 $S,T$ \u95f4\u7684\u8fb9\u6570\u4e3a $k|S|$ , \u5219 $T$ \u4e2d\u5fc5\u7136\u5b58\u5728\u4e00\u4e2a\u70b9\u7684\u5ea6\u6570\u5927\u4e8e $k$ , \u77db\u76fe.\n\n\u65f6\u95f4\u590d\u6742\u5ea6 $\\mathcal O(nm^2\\sqrt n)$ .\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nint read();\nint n, m;\nint col(int x) { return (x - 1) / m + 1; }\nint a[202][202], b[202][202];\nvector<int> c[202][202];\nvoid pop(int x, int i, int j) { b[i][j] = c[i][x].back(), c[i][x].pop_back(); }\n\nstruct Flow {\n    int s, t;\n    int hd[1003], nx[100005], to[100005], c[100005], cnt;\n    void add(int f, int t, int cap) {\n        nx[++cnt] = hd[f], hd[f] = cnt, to[cnt] = t, c[cnt] = cap;\n    }\n    void fadd(int f, int t) { add(f, t, 1), add(t, f, 0); }\n    void init() { t = (s = (n << 1) + 1) + 1, cnt = 1; }\n\n    queue<int> q;\n    int dep[1003];\n    bool bfs() {\n        for (int i = 1; i <= t; ++i) dep[i] = 0;\n        dep[s] = 1, q.push(s);\n        while (!q.empty()) {\n            int u = q.front();\n            q.pop();\n            for (int i = hd[u], v; i; i = nx[i])\n                if (!dep[v = to[i]] && c[i] > 0) dep[v] = dep[u] + 1, q.push(v);\n        }\n        return dep[t];\n    }\n\n    int iter[1003];\n    int dfs(int u, int dist) {\n        if (u == t) return dist;\n        for (int &i = iter[u], v; i; i = nx[i]) {\n            if (c[i] < 1 || dep[v = to[i]] != dep[u] + 1) continue;\n            int d = dfs(v, min(dist, c[i]));\n            if (d) return c[i] -= d, c[i ^ 1] += d, d;\n        }\n        return 0;\n    }\n\n    void Dinic() {\n        while (bfs()) {\n            for (int i = 1; i <= t; ++i) iter[i] = hd[i];\n            while (dfs(s, 1000)) void();\n        }\n    }\n    void work(int id) {\n        for (int i = 1; i <= n; ++i) fadd(s, i), fadd(i + n, t);\n        Dinic();\n        for (int i = n + 1; i <= n + n; ++i)\n            for (int j = hd[i]; j; j = nx[j])\n                if (c[j]) c[j] = 0, pop(i - n, to[j], id);\n    }\n} flow;\nvoid ins(int i, int x) { c[i][col(x)].push_back(x), flow.fadd(i, n + col(x)); }\n\nint main() {\n    n = read(), m = read(), flow.init();\n    for (int i = 1; i <= n; ++i)\n        for (int j = 1; j <= m; ++j) a[i][j] = read(), ins(i, a[i][j]);\n    for (int i = 1; i <= m; ++i) flow.work(i);\n    for (int i = 1; i <= n; ++i, puts(\"\"))\n        for (int j = 1; j <= m; ++j)\n            printf(\"%d \", a[col(b[i][j])][j] = b[i][j]);\n    for (int i = 1; i <= n; ++i, puts(\"\"))\n        for (int j = 1; j <= m; ++j) printf(\"%d \", a[i][j]);\n    return 0;\n}\nconst int _SIZE = 1 << 22;\nchar ibuf[_SIZE], *iS = ibuf, *iT = ibuf;\n#define gc                                                         \\\n    (iS == iT ? iT = ((iS = ibuf) + fread(ibuf, 1, _SIZE, stdin)), \\\n     (iS == iT ? EOF : *iS++) : *iS++)\nint read() {\n    int x = 0, f = 1;\n    char c = gc;\n    while (!isdigit(c)) f = (c == '-') ? -1 : f, c = gc;\n    while (isdigit(c)) x = x * 10 + c - '0', c = gc;\n    return x * f;\n}\n```",
        "postTime": 1582809388,
        "uid": 51237,
        "name": "Kinandra",
        "ccfLevel": 0,
        "title": "\u9898\u89e3 AT5161 \u3010[AGC037D] Sorting a Grid\u3011"
    },
    {
        "content": "\u4e00\u5e74\u524d\u6211\u8fd8\u5728\u666e\u8f6c\u63d0\u65f6\u671f\u7684\u6a21\u62df\u8d5b\u7684\u9898\uff0c\u90a3\u65f6\u5565\u90fd\u4e0d\u4f1a\uff0c\u53ea\u6709\u4e00\u5806\u666e\u53ca\u77e5\u8bc6\uff0c\u771f\u4f69\u670d\u5f53\u65f6\u7684\u81ea\u5df1\u80fd\u505a\uff08\u4e71\u641e\uff09\u51fa\u8fd9\u9053\u9898\uff0c\u73b0\u5728\u80af\u5b9a\u505a\u4e0d\u51fa\u4e86\uff0c~~\u65f6\u4ee3\u5728\u9000\u6b65\u3002~~ \u73b0\u5728\u53d1\u73b0\u8fd9\u662f\u539f\u9898\uff0c\u4e8e\u662f\u6765\u5199\u4e2a\u9898\u89e3\u3002\n\n\u9996\u5148\u5bf9\u4e8e $A$ \u5230 $B$ \u7684\u8fc7\u7a0b\uff0c\u6211\u4eec\u8981\u8ba9 $D$ \u6bcf\u4e00\u884c\u7684\u6570\u90fd\u5904\u5728\u4e0d\u540c\u5217\u4e0a\uff0c\u4e8e\u662f\u6211\u4eec\u91c7\u7528\u7c7b\u4f3c\u5192\u6ce1\u6392\u5e8f\u7684\u8d2a\u5fc3\u4e71\u641e\u505a\u6cd5\uff0c\u5047\u5982\u67d0\u4e00\u5217\u5b58\u5728\u4e24\u4e2a\u53ca\u4ee5\u4e0a $D$ \u540c\u4e00\u884c\u7684\u6570\uff0c\u90a3\u4e48\u5c31\u8981\u5c06\u8fd9\u4e9b\u5728\u540c\u4e00\u884c\u7684\u6570\u67d0\u4e00\u4e2a\u79fb\u51fa\u53bb\uff0c\u4e8e\u662f\u6211\u4eec\u4fbf\u8d2a\u5fc3\u7684\u5c06\u8fd9\u4e9b\u6570\u90fd\u4e0e\u540c\u884c\u7684\u4e0b\u4e00\u5217\u7684\u6570\u4ea4\u6362\uff0c\u4f46\u8fdb\u884c\u4e00\u6b21\u8fd9\u6837\u7684\u64cd\u4f5c\u663e\u7136\u4e0d\u5bf9\uff0c\u4e8e\u662f\u6211\u4eec\u591a\u8fdb\u884c\u51e0\u6b21\u4ea4\u6362\uff0c\u7136\u540e\u6211\u5c06\u4e0a\u754c\u8bbe\u4e3a $n\\times m$ \u3002\u53d1\u73b0\u6ca1\u6709\u9519\u8bef\uff0c\u6b63\u786e\u6027\u6682\u65f6\u4e0d\u80fd\u8bc1\u660e\uff0c\u5148\u7559\u4e2a\u5751\u3002\n\n\u5bf9\u4e8e $B$ \u5230 $C$ \u7684\u8fc7\u7a0b\uff0c\u56e0\u4e3a\u6211\u4eec\u5df2\u7ecf\u4fdd\u8bc1\u4e86 $D$ \u6bcf\u4e00\u884c\u7684\u6570\u90fd\u5904\u5728\u4e0d\u540c\u5217\u4e0a\uff0c\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u628a\u4ed6\u4eec\u642c\u5230\u5bf9\u5e94\u7684\u884c\u4e0a\u5c31\u884c\u4e86\u3002\n\n\u5bf9\u4e8e $C$ \u5230 $D$ \u7684\u8fc7\u7a0b\uff0c\u56e0\u4e3a\u6211\u4eec\u4fdd\u8bc1 $C$ \u7684\u6bcf\u4e00\u884c\u90fd\u662f\u5bf9\u5e94\u8fd9\u4e00\u884c\u884c $D$ \u91cc\u7684\u6570\uff0c\u6240\u4ee5\u663e\u7136\u53ef\u4ee5\u6362\u51fa\u6765\u3002\n\n\u4e8e\u662f\u6211\u4eec\u4fbf\u7528\u666e\u53ca\u7ec4\u7684\u505a\u6cd5\u8fc7\u4e86\u8fd9\u9053\u9898\uff0c\u65f6\u95f4\u590d\u6742\u5ea6 $O(n^2m^2)$ \uff0c~~\u6b63\u786e\u6027\u4e0d\u80fd\u4fdd\u8bc1\u3002~~\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\nusing namespace std;\nint n, m;\nint a[110][110], b[110][110], c[110][110], ori[110][110];//ori\u4ee3\u8868B\u7684\u67d0\u4e00\u5217\u6709\u591a\u5c11\u4e2aD\u7684\u67d0\u4e00\u884c\u7684\u6570\nint main()\n{\n\tscanf(\"%d%d\", &n, &m);\n\tfor(int i = 1; i <= n; ++ i)\n\t{\n\t\tfor(int j = 1; j <= m; ++ j)\n\t\t{\n\t\t\tscanf(\"%d\", &a[i][j]);\n\t\t\t++ ori[j][(a[i][j] - 1) / m + 1];\n\t\t\tb[i][j] = a[i][j];\n\t\t}\n\t}\n\tfor(int timer = 0; timer < n * m; ++ timer)\n\tfor(int i = 1; i < m; ++ i)\n\t{\n\t\tfor(int j = 1; j <= n; ++ j)\n\t\t{\n\t\t\tif(ori[i][(b[j][i] - 1) / m + 1] > 1)//\u5927\u4e8e1\uff0c\u5c06\u5b83\u548c\u540c\u884c\u7684\u4e0b\u4e00\u5217\u4ea4\u6362\n\t\t\t{\n\t\t\t\t-- ori[i][(b[j][i] - 1) / m + 1];\n\t\t\t\t++ ori[i][(b[j][i + 1] - 1) / m + 1];\n\t\t\t\t++ ori[i + 1][(b[j][i] - 1) / m + 1];\n\t\t\t\t-- ori[i + 1][(b[j][i + 1] - 1) / m + 1];\n\t\t\t\tswap(b[j][i], b[j][i + 1]);\n\t\t\t}\n\t\t}\n\t}\n\tfor(int i = 1; i <= n; ++ i)\n\t{\n\t\tfor(int j = 1; j <= m ; ++ j)\n\t\t{\n\t\t\tc[i][j] = b[i][j];\n\t\t}\n\t}\n\tfor(int timer = 0; timer < n; ++ timer)\n\tfor(int i = 1; i <= n; ++ i)\n\t{\n\t\tfor(int j = 1; j <= m ; ++ j)\n\t\t{\n\t\t\tint gu = c[i][j];\n\t\t\tswap(c[i][j], c[(gu - 1) / m + 1][j]);//\u6362\u5230\u5bf9\u5e94\u884c\n\t\t}\n\t}\n\tfor(int i = 1; i <= n; ++ i)\n\t{\n\t\tfor(int j = 1; j <= m; ++ j)\n\t\t{\n\t\t\tprintf(\"%d \", b[i][j]);\n\t\t}\n\t\tprintf(\"\\n\");\n\t}\n\tfor(int i = 1; i <= n; ++ i)\n\t{\n\t\tfor(int j = 1; j <= m; ++ j)\n\t\t{\n\t\t\tprintf(\"%d \", c[i][j]);\n\t\t}\n\t\tif(i != n)\n\t\tprintf(\"\\n\");\n\t}\n\treturn 0;\n}\n\n```\n",
        "postTime": 1608863700,
        "uid": 111728,
        "name": "\u5e7b\u5f71\u661f\u575a\u5f3a",
        "ccfLevel": 7,
        "title": "\u9898\u89e3 AT5161 \u3010[AGC037D] Sorting a Grid\u3011"
    },
    {
        "content": "\u8003\u8651\u5012\u63a8\uff0c\u4ece\u76ee\u6807\u77e9\u9635\u5f80\u524d\u63a8\u3002\u7ecf\u8fc7\u7b2c\u4e09\u6b65\u548c\u7b2c\u4e8c\u90e8\uff0c\u67d0\u4e2a\u77e9\u9635\u80fd\u88ab\u5f97\u5230\u663e\u7136\u5f53\u4e14\u4ec5\u5f53\u5b83\u7684\u6bcf\u4e00\u5217\u90fd\u6765\u81ea\u4e0d\u540c\u884c\u3002\u7136\u540e\u8003\u8651\u6b63\u8fc7\u6765\uff0c\u4ece\u539f\u59cb\u77e9\u9635\u7ecf\u8fc7\u7b2c\u4e00\u6b65\u8981\u80fd\u5230\u8fbe\u4e0a\u8ff0\u77e9\u9635\uff0c\u4e5f\u5c31\u662f\u8981\u5c06\u6bcf\u4e00\u884c\u91cd\u65b0\u6392\u5217\u4f7f\u5f97\u6bcf\u4e00\u5217\u90fd\u88ab\u5206\u914d\u5230\u6765\u81ea $n$ \u4e2a\u4e0d\u540c\u884c\u7684\u5143\u7d20\u3002\u4e8e\u662f\u53ea\u8981\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u5c31\u53ef\u4ee5\u4e86\uff0c\u5230\u8fd9\u513f\u7684\u5206\u6790\u8fd8\u662f\u5f88\u7b80\u5355\u7684\u3002\n\n\u4e0b\u9762\u8003\u8651\u6784\u9020\u65b9\u6848\u3002\u5148\u5c1d\u8bd5\u6784\u9020\u7b2c\u4e00\u5217\uff0c\u5c31\u662f\u8981\u4ece\u6bcf\u884c\u9009\u4e00\u4e2a\uff0c\u9009\u51fa\u6765\u7684 $n$ \u4e2a\u6765\u81ea\u6700\u7ec8\u4f4d\u7f6e\u7684\u4e0d\u540c\u884c\u3002\u90a3\u5c31\u662f\u4e2a\u4e8c\u5206\u56fe\u5339\u914d\u561b\uff0c\u6ca1\u6709\u66f4\u597d\u7684\u65b9\u6cd5\u4e86\u3002\u90a3\u600e\u4e48\u4fdd\u8bc1\u6700\u5927\u6d41\u8dd1\u51fa\u6765\u7684\u4e00\u7ec4\u89e3\u6267\u884c\u4e4b\u540e\uff0c\u5269\u4e0b\u6765\u7684 $n\\times(m-1)$ \u5b50\u95ee\u9898\u4f9d\u7136\u6709\u89e3\u5462\uff1f\u9898\u9762\u4e2d\u6709\u4e00\u53e5\u8bdd\u300cThe constraints guarantee that it is always possible to achieve the objective.\u300d\u5f88\u5fae\u5999\uff0c\u5b83\u662f\u8bf4\u7ed9\u5b9a\u6570\u636e\u4e00\u5b9a\u6709\u89e3\u8fd8\u662f\u4efb\u610f\u53ef\u80fd\u7684\u6570\u636e\u4e00\u5b9a\u6709\u89e3\u5462\uff1f\u76f4\u63a5\u7ffb\u8bd1\u662f\u524d\u8005\uff0c\u4f46\u662f\u5982\u679c\u6ee1\u8db3\u540e\u8005\uff0c\u6211\u4eec\u5c31\u4e0d\u7528\u62c5\u5fc3\u4e0a\u8ff0\u95ee\u9898\u4e86\uff0c\u968f\u4fbf\u9009\u4e00\u7ec4\u5b8c\u7f8e\u5339\u914d\u5c31\u884c\u4e86\u3002\u4e8b\u5b9e\u4e0a\u540e\u8005\u786e\u5b9e\u662f\u5bf9\u7684\uff0c\u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2a\u8bc1\u660e\u3002\n\n\u663e\u7136\u53ea\u8981\u6bcf\u6b21 $n\\times(m-i)$\u200b\u200b \u5b50\u95ee\u9898\u90fd\u80fd\u627e\u5230\u4e00\u7ec4\u5b8c\u7f8e\u5339\u914d\uff0c\u7531\u6570\u5b66\u5f52\u7eb3\u6cd5\u53ef\u77e5\u539f\u547d\u9898\u6210\u7acb\u3002\u90a3\u770b\u662f\u5426\u6709\u5b8c\u7f8e\u5339\u914d\u8003\u8651\u970d\u5c14\u5b9a\u7406\uff1a\u5bf9\u4efb\u610f $\\{1\\sim n\\}$\u200b\u200b\u200b \u7684\u5b50\u96c6\uff0c\u7528\u5b83\u5185\u90e8\u6240\u6709\u5143\u7d20\u4f5c\u4e3a\u6700\u7ec8\u4f4d\u7f6e\u6240\u5728\u884c\u5b9a\u4f4d\u5230\u5f53\u524d\u77e9\u9635\u4e2d $s(m-i)$\u200b\u200b \u4e2a\u4f4d\u7f6e\uff08\u5176\u4e2d $s$\u200b\u200b \u662f\u5b50\u96c6\u5927\u5c0f\uff09\uff0c\u8981\u662f\u8fd9\u4e9b\u4f4d\u7f6e\u6765\u81ea\u4e0d\u5c11\u4e8e $s$\u200b\u200b \u884c\u5c31\u597d\u4e86\u3002\u8ddf\u636e\u62bd\u5c49\u539f\u7406\uff0c\u8fd9\u662f\u663e\u7136\u7684\u2026\u2026\u2026\u2026\u2026\u2026\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u73a9\u610f\u6784\u51fa\u6765\u7684\u4e8c\u5206\u56fe\u6ee1\u8db3\u6bcf\u4e2a\u70b9\u5ea6\u6570\u76f8\u7b49\uff0c\u90fd\u7b49\u4e8e $m-i$\u200b\uff08\u91cd\u8fb9\u4e5f\u7b97\uff09\uff0c\u5b83\u4e13\u95e8\u6709\u4e2a\u540d\u5b57\u53eb $m-i$\u200b\u200b \u9636\u6b63\u5219\u4e8c\u5206\u56fe\uff0c\u4e0a\u8ff0\u8bc1\u660e\u8bf4\u660e\u4efb\u610f\uff08\u5927\u4e8e\u96f6\u9636\uff09\u6b63\u5219\u4e8c\u5206\u56fe\u90fd\u6709\u5b8c\u7f8e\u5339\u914d\u3002\n\n\u90a3\u5c31\u8dd1 $m$ \u904d\u4e8c\u5206\u56fe\u6700\u5927\u6d41\u5c31\u884c\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define int long long\n#define pb push_back\n#define mp make_pair\n#define X first\n#define Y second\nconst int inf=0x3f3f3f3f3f3f3f3f;\nconst int N=20010;\nint n,m,s,t;\nvector<pair<int,int> > nei[N+1];\nvector<int> rv[N+1];\nvoid ae(int x,int y,int z){\n\tnei[x].pb(mp(y,z)),nei[y].pb(mp(x,0));\n\trv[x].pb(nei[y].size()-1),rv[y].pb(nei[x].size()-1);\n}\nint dep[N+1];\nbool bfs(){\n\tmemset(dep,-1,sizeof(dep));\n\tdep[s]=0;\n\tqueue<int> q;\n\tq.push(s);\n\twhile(q.size()){\n\t\tint x=q.front();\n\t\tq.pop();\n\t\tfor(int i=0;i<nei[x].size();i++){\n\t\t\tint y=nei[x][i].X,c=nei[x][i].Y;\n\t\t\tif(c&&!~dep[y])dep[y]=dep[x]+1,q.push(y);\n\t\t}\n\t}\n\treturn ~dep[t];\n}\nint now[N+1];\nint dfs(int x=s,int flw=inf){\n\tif(x==t||!flw)return flw;\n\tint res=0,tmp;\n\tfor(int &i=now[x];i<nei[x].size();i++){\n\t\tint y=nei[x][i].X,&c=nei[x][i].Y;\n\t\tif(dep[y]==dep[x]+1&&(tmp=dfs(y,min(flw,c)))){\n\t\t\tres+=tmp,flw-=tmp;\n\t\t\tc-=tmp,nei[y][rv[x][i]].Y+=tmp;\n\t\t\tif(!flw)break;\n\t\t}\n\t}\n\treturn res;\n}\nint dinic(){\n\tint res=0;\n\twhile(bfs()){\n\t\tmemset(now,0,sizeof(now));\n\t\tres+=dfs();\n\t}\n\treturn res;\n}\nint a[N/100][N/100];\nint chs[N];\nsigned main(){\n\tcin>>n>>m;\n\tfor(int i=1;i<=n;i++)for(int j=1;j<=m;j++)cin>>a[i][j];\n\tfor(int i=1;i<=m;i++){\n\t\tfor(int j=1;j<=2*n+2;j++)nei[j].clear(),rv[j].clear();\n\t\ts=2*n+1,t=s+1;\n\t\tfor(int j=1;j<=n;j++)ae(s,j,1),ae(j+n,t,1);\n\t\tfor(int j=1;j<=n;j++)for(int k=i;k<=m;k++)ae(j,(a[j][k]+m-1)/m+n,1);\n\t\tdinic();\n\t\tfor(int j=1;j<=n;j++)for(int k=0;k<nei[j].size();k++)if(nei[j][k].X<=2*n&&!nei[j][k].Y)chs[j]=nei[j][k].X-n;\n//\t\tfor(int j=1;j<=n;j++)cout<<chs[j]<<\"!\\n\";\n\t\tfor(int j=1;j<=n;j++)for(int k=i;k<=m;k++)if((a[j][k]+m-1)/m==chs[j]){swap(a[j][i],a[j][k]);break;}\n\t}\n\tfor(int i=1;i<=n;i++)for(int j=1;j<=m;j++)cout<<a[i][j]<<\" \\n\"[j==m];\n\tfor(int j=1;j<=m;j++){\n\t\tvector<int> v;\n\t\tfor(int i=1;i<=n;i++)v.pb(a[i][j]);\n\t\tsort(v.begin(),v.end());\n\t\tfor(int i=1;i<=n;i++)a[i][j]=v[i-1];\n\t}\n\tfor(int i=1;i<=n;i++)for(int j=1;j<=m;j++)cout<<a[i][j]<<\" \\n\"[j==m];\n\treturn 0;\n}\n```",
        "postTime": 1630574133,
        "uid": 138400,
        "name": "chenxia25",
        "ccfLevel": 9,
        "title": "agc037d"
    },
    {
        "content": "[\u4f20\u9001\u95e8](https://atcoder.jp/contests/agc037/tasks/agc037_d)\n\n\u9898\u610f\u6d1b\u8c37\u4e0a\u6bd4\u6211\u89e3\u91ca\u7684\u66f4\u6e05\u695a\uff08\uff09\n\n##### \u5206\u6790\uff1a\n\n\u8fd9\u79cd\u4e71\u4e03\u516b\u7cdf\u7684\u6392\u5e8f\u9898\uff0c\u5bb9\u6613\u60f3\u5230\u5bf9\u5143\u7d20\u5206\u7c7b\u67d3\u8272\u3002\n\n\u8003\u8651\u5bf9\u5143\u7d20\u4ece\u5c0f\u5230\u5927\u5206\u4e3a $n$ \u7c7b\uff0c\u5f62\u5f0f\u5316\u5730\uff0c$a_{i,j}$ \u88ab\u67d3\u4e0a\u989c\u8272 $\\left\\lceil \\frac{a_{i,j}}{m}  \\right\\rceil$\uff0c\u90a3\u4e48\u663e\u7136\u4f1a\u6709 $n$ \u79cd\u989c\u8272\uff0c\u6bcf\u79cd\u989c\u8272\u7684\u5143\u7d20\u90fd\u6070\u6709 $m$ \u4e2a\u3002\n\n\u67d3\u5b8c\u8272\u540e\uff0c\u5bb9\u6613\u53d1\u73b0\uff0c\u5728\u7b2c\u4e00\u8f6e\u884c\u64cd\u4f5c\u540e\uff0c\u5fc5\u987b\u6ee1\u8db3\u6bcf\u4e00\u5217\u91cc\u6bcf\u79cd\u989c\u8272\u7684\u5143\u7d20\u6070\u597d\u51fa\u73b0\u4e00\u6b21\u3002\u7136\u540e\u5c31\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u8fdb\u884c\u5217\u64cd\u4f5c\u3002\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651\u5982\u4f55\u5206\u914d\u6bcf\u4e00\u884c\u7684\u5143\u7d20\u4f4d\u7f6e\uff0c\u4f7f\u5f97\u5206\u914d\u7ed3\u675f\u540e\u6bcf\u79cd\u989c\u8272\u5728\u6bcf\u5217\u91cc\u90fd\u6070\u597d\u51fa\u73b0\u4e00\u6b21\u3002\u8fd9\u4e2a\u4e1c\u897f\u770b\u4e0a\u53bb\u5c31\u6bd4\u6700\u5f00\u59cb\u770b\u5230\u7684\u6392\u5e8f\u53ef\u505a\u591a\u4e86\u3002\n\n\u5148\u8bf4\u4e00\u4e2a\u5bb9\u6613\u505a\u9519\u7684\u60f3\u6cd5\uff08\u6307\u6211\u4e00\u5f00\u59cb\u5199\u7684\u6784\u9020\u65b9\u6848\uff09\uff0c\u5f88\u5feb\u6211\u4eec\u5c31\u4f1a\u53d1\u73b0\u5176\u9519\u8bef\u4e4b\u5904\u5e76\u4e14\u5f97\u5230\u6b63\u786e\u89e3\u6cd5\uff1a\n\n\u8003\u8651\u6211\u4eec\u679a\u4e3e\u989c\u8272 $1\\rightarrow n$\u200b\uff0c\u6bcf\u6b21\u786e\u5b9a\u6240\u6709\u989c\u8272\u4e3a $i$\u200b \u7684\u5143\u7d20\u7684\u4f4d\u7f6e\u3002\u90a3\u4e48\u5bb9\u6613\u60f3\u5230\u4e8c\u5206\u56fe\u5339\u914d\uff1a\u6211\u4eec\u628a\u989c\u8272\u4e3a $i$ \u7684 $m$ \u4e2a\u5143\u7d20\u4f5c\u4e3a\u5de6\u90e8\u70b9\uff0c\u628a $m$ \u4e2a\u5217\u4f5c\u4e3a\u53f3\u90e8\u70b9\u3002\u5bf9\u4e8e\u7b2c $u$ \u4e2a\u989c\u8272\u4e3a $i$ \u7684\u5143\u7d20 $(r,c)$\uff0c\u6211\u4eec\u8fde $L(u) \\rightarrow R(c)$\uff08$L,R$ \u4ee3\u8868\u5de6\u3001\u53f3\u90e8\uff09\u3002\u6c42\u51fa\u8fd9\u4e2a\u56fe\u7684\u4e00\u4e2a\u5b8c\u7f8e\u5339\u914d\uff0c\u505a $n$ \u6b21\u8fd9\u6837\u7684\u64cd\u4f5c\uff0c\u5373\u53ef\u6c42\u51fa\u884c\u64cd\u4f5c\u540e\u7684\u77e9\u9635\u3002\n\n\u770b\u4e0a\u53bb\u8fd9\u662f\u6ca1\u95ee\u9898\u7684\uff0c\u6bd5\u7adf\u9898\u76ee\u8bf4\u4e86\u201d\u4fdd\u8bc1\u4e00\u5b9a\u6709\u89e3\u201c\u3002\u7136\u800c\u5f53\u6211\u4eec\uff08\u5176\u5b9e\u53ea\u6709\u6211\uff09\u4ea4\u4e0a\u53bb\u7684\u65f6\u5019\u4f1a WA 13 \u4e2a\u70b9\uff0c\u52a0\u70b9\u8c03\u8bd5\u4fe1\u606f\u540e\u5f88\u5feb\u5c31\u4f1a\u53d1\u73b0\u5728\u67d0\u4e9b\u8f6e\u5339\u914d\u7684\u65f6\u5019\u662f\u4f1a\u51fa\u73b0\u4e0d\u5b58\u5728\u5b8c\u7f8e\u5339\u914d\u7684\u3002\n\n\u9519\u8bef\u7684\u539f\u56e0\u5f88\u663e\u7136\uff0c\u56e0\u4e3a\u5b8c\u7f8e\u5339\u914d\u6709\u591a\u79cd\u9009\u62e9\uff0c\u6240\u4ee5\u53ef\u80fd\u5f53\u524d\u6211\u4eec\u9009\u7684\u5339\u914d\u65b9\u6848\uff0c\u4f1a\u8ba9\u540e\u9762\u67d0\u4e9b\u65f6\u5019\u4e0d\u80fd\u4ea7\u751f\u5b8c\u7f8e\u5339\u914d\u3002\u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e2a\u89e3\u6cd5\u662f\u6709\u540e\u6548\u6027\u7684\u3002\n\n\u7136\u540e\u53d1\u73b0\u6211\u4eec\u9700\u8981\u89e3\u51b3\u4e00\u4e2a\u95ee\u9898\uff1a\u4e8c\u5206\u56fe\u662f\u5426\u80fd\u4ea7\u751f\u5b8c\u7f8e\u5339\u914d\u3002\u8fd9\u662f Hall \u5b9a\u7406\u6240\u89e3\u51b3\u7684\u95ee\u9898\u3002\u4f46\u662f\u6211\u4eec\u4ecd\u7136\u4e0d\u80fd\u7528 Hall \u5b9a\u7406\u6539\u8fdb\u4e0a\u9762\u7684\u7b97\u6cd5\uff0c\u8fd9\u662f\u56e0\u4e3a\uff0c\u6211\u4eec\u53d1\u73b0\u5176\u5b9e\u5728\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u6709 $n$ \u5f20\u4e8c\u5206\u56fe\uff0c\u4f60\u8981\u5224\u65ad\u540e\u9762\u80fd\u5426\u5408\u6cd5\uff0c\u5c31\u5f97\u5224\u65ad\u540e\u9762\u82e5\u5e72\u5f20\u4e8c\u5206\u56fe\u662f\u5426\u5408\u6cd5\uff0c\u8fd9\u662f\u5f88\u9ebb\u70e6\u7684\uff0c\u540c\u65f6\uff0c\u6ce8\u610f\u5230\uff0c\u8fd9 $n$ \u5f20\u4e8c\u5206\u56fe\u8fd8\u4e0d\u662f\u72ec\u7acb\u7684\uff0c\u5bf9\u4e8e\u7b2c $i$ \u5f20\u4e8c\u5206\u56fe\uff0c\u5c31\u7b97\u4f60\u5f53\u524d\u9009\u7684\u65b9\u6848\u4ee4\u7b2c $i+1 \\sim n$ \u5f20\u4e8c\u5206\u56fe\u90fd\u6709\u5b8c\u7f8e\u5339\u914d\uff0c\u4f46\u662f\u53ef\u80fd\u6b64\u65f6\u7684\u7b2c $i+1$ \u5f20\u4e8c\u5206\u56fe\uff0c\u4e0d\u7ba1\u9009\u4ec0\u4e48\u5b8c\u7f8e\u5339\u914d\uff0c\u90fd\u4f1a\u4ee4\u7b2c $i+2 \\sim n$ \u5f20\u4e8c\u5206\u56fe\u4e2d\u7684\u67d0\u4e2a\u4e0d\u5b58\u5728\u5b8c\u7f8e\u5339\u914d\u3002\u6240\u4ee5\u6309\u7167\u989c\u8272\u6784\u9020\u7684\u65b9\u6848\u88ab\u6211\u4eec\u5426\u51b3\u3002\n\n\u8003\u8651\u6b64\u65f6\u4e00\u4e2a\u65b9\u5411\u662f\uff0c\u6211\u4eec\u7684\u6784\u9020\u65b9\u6848\u8981\u8ba9\u6700\u540e\u5f62\u6210\u7684\u4e8c\u5206\u56fe\u6570\u91cf\u5c3d\u53ef\u80fd\u5c11\uff0c\u5982\u679c\u4e0d\u80fd\u53ea\u6709\u4e00\u5f20\uff0c\u90a3\u4e5f\u5f97\u8ba9\u5b83\u4eec\u72ec\u7acb\u3002\u8003\u8651\u4ece\u5de6\u5f80\u53f3\u4e00\u5217\u4e00\u5217\u6784\u9020\u3002\u7b2c $i$\u200b \u6b21\u6784\u9020\u7b2c $i$\u200b \u5217\u7684\u7ed3\u679c\u3002\u90a3\u663e\u7136\u5171\u6709 $m$\u200b \u5f20\u4e8c\u5206\u56fe\uff0c\u6bcf\u6b21\u6784\u9020\u4e00\u5217\u7684\u65f6\u5019\uff0c\u628a\u884c\u770b\u4f5c\u5de6\u90e8\u70b9\uff0c\u989c\u8272\u770b\u4f5c\u53f3\u90e8\u70b9\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u5143\u7d20 $(r,c)$\u200b\uff0c\u6211\u4eec\u8fde $L(r) \\rightarrow R(color(r,c))$\u200b\u3002\u7136\u540e\u4f9d\u65e7\u53d6\u4e00\u4e2a\u6700\u5927\u5339\u914d\u3002\n\n\u7136\u540e\u8003\u8651\u8bf4\u660e\u6b64\u65f6\u7684\u6b63\u786e\u6027\u3002\u9996\u5148\u53d1\u73b0\u7b2c $1$ \u8f6e\u4e00\u5b9a\u4e0d\u5b58\u5728\u6700\u5927\u5339\u914d\u3002\u7136\u540e\uff0c\u5047\u8bbe $i \\ge 2$\uff0c\u5bb9\u6613\u53d1\u73b0\uff0c\u7b2c $i$ \u8f6e\u7684\u4e8c\u5206\u56fe\u548c\u7b2c $i-1$ \u8f6e\u76f8\u6bd4\u6bcf\u4e2a\u70b9\u7684\u5ea6\u6570\u90fd\u5c11\u4e86 $1$. \u8fdb\u4e00\u6b65\u53d1\u73b0\u7b2c $i$\u200b \u8f6e\u7684\u65f6\u5019\u6bcf\u4e2a\u8282\u70b9\u7684\u5ea6\u6570\u90fd\u4e3a $l=m-i+1$\uff0c\u90a3\u4e48\u4e00\u4e2a\u96c6\u5408 $S$ \u5411\u5916\u5171\u8fde\u51fa $l|S|$ \u6761\u8fb9\uff0c\u5982\u679c\u5206\u914d\u7ed9 $|T|<|S|$ \u4e2a\u53f3\u90e8\u70b9\uff0c\u6839\u636e\u9e3d\u5de2\u539f\u7406\uff0c$T$ \u4e2d\u5fc5\u5b9a\u6709\u4e00\u4e2a\u70b9\u5ea6\u6570 $\\gt l$\u3002\u77db\u76fe\u3002\u6240\u4ee5\u8fd9\u79cd\u6784\u9020\u65b9\u6cd5\u662f\u6210\u7acb\u7684\u3002\n\n```C++\n#include<bits/stdc++.h>\n#define rep(i,a,b) for(ll i=(a);i<=(b);i++)\n#define per(i,a,b) for(ll i=(a);i>=(b);i--)\n#define op(x) ((x&1)?x+1:x-1)\n#define odd(x) (x&1)\n#define even(x) (!odd(x))\n#define lc(x) (x<<1)\n#define rc(x) (lc(x)|1)\n#define lowbit(x) (x&-x)\n#define Max(a,b) (a>b?a:b)\n#define Min(a,b) (a<b?a:b)\n#define next Cry_For_theMoon\n#define il inline\n#define pb(x) push_back(x)\n#define is(x) insert(x)\n#define sit set<int>::iterator\n#define mapit map<int,int>::iterator\n#define pi pair<int,int>\n#define ppi pair<int,pi>\n#define pp pair<pi,pi>\n#define fr first\n#define se second\n#define vit vector<int>::iterator\n#define mp(x,y) make_pair(x,y)\ntypedef long long ll;\ntypedef unsigned long long ull;\ntypedef unsigned int uint;\ntypedef double db;\nusing namespace std;\nconst int MAXN=210,ADD=110;\nint n,m,a[MAXN][MAXN],color[MAXN][MAXN];\nint ret1[MAXN][MAXN],ret2[MAXN][MAXN],vis[MAXN*2],match[MAXN*2],tag[MAXN][MAXN];\nvector<pi>bucket[MAXN];\nstruct Edge{\n\tint u,v;\n}edge[MAXN*MAXN*2];\nint first[MAXN*2],next[MAXN*MAXN*2],tot;\nvoid clear(){\n\ttot=0;\n\tmemset(first,0,sizeof first);\n\tmemset(next,0,sizeof next);\n\tmemset(edge,0,sizeof edge);\n}\nvoid addedge(int u,int v){\n\tedge[++tot]=(Edge){u,v};\n\tnext[tot]=first[u];first[u]=tot;\n}\nint dfs(int u){\n\tfor(int j=first[u];j;j=next[j]){\n\t\tint v=edge[j].v;\n\t\tif(vis[v])continue;\n\t\tvis[v]=1;\n\t\tif(!match[v] || dfs(match[v])){\n\t\t\tmatch[v]=u;\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\nint main(){\n\tcin>>n>>m;\n\trep(i,1,n){\n\t\trep(j,1,m){\n\t\t\tcin>>a[i][j];\n\t\t\tcolor[i][j]=(a[i][j]+m-1)/m;\n\t\t\tbucket[color[i][j]].pb(mp(i,j));\n\t\t}\n\t}\n\t//\u4e00\u5217\u4e00\u5217\u786e\u5b9a\n\trep(i,1,m){\n\t\tclear();\n\t\tmemset(match,0,sizeof match);\n\t\trep(r,1,n){\n\t\t\trep(c,1,m){\n\t\t\t\tif(tag[r][c])continue;\n\t\t\t\taddedge(r,ADD+color[r][c]);\n\t\t\t}\n\t\t}\n\t\trep(j,1,n){\n\t\t\tmemset(vis,0,sizeof vis);\n\t\t\tdfs(j);\n\t\t}\n\t\trep(x,1,n){\n\t\t\tint r=match[x+ADD]; //\u4ece\u7b2cr\u884c\u91cc\u627e\u5230\u4e00\u4e2a\u989c\u8272\u4e3ax\u7684 \n\t\t\trep(c,1,m){if(tag[r][c] || color[r][c]!=x)continue;\n\t\t\t\tret1[r][i]=a[r][c];\n\t\t\t\ttag[r][c]=1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t} \n\t\n\trep(i,1,n){\n\t\trep(j,1,m){\n\t\t\tprintf(\"%d \",ret1[i][j]);\n\t\t}\n\t\tprintf(\"\\n\");\n\t}\n\trep(r,1,n){\n\t\trep(c,1,m){\n\t\t\tret2[(ret1[r][c]+m-1)/m][c]=ret1[r][c];\n\t\t}\n\t}\n\trep(i,1,n){\n\t\trep(j,1,m){\n\t\t\tprintf(\"%d \",ret2[i][j]);\n\t\t}\n\t\tprintf(\"\\n\");\n\t}\n\treturn 0;\n}\n\n```\n\n",
        "postTime": 1627629386,
        "uid": 340632,
        "name": "Cry_For_theMoon",
        "ccfLevel": 8,
        "title": "\u3010AGC037D\u3011Sorting a Grid"
    }
]